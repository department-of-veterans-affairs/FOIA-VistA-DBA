Released XU*8*134 SEQ #128
Extracted from mail message
**KIDS**:XU*8.0*134^

**INSTALL NAME**
XU*8.0*134
"BLD",48,0)
XU*8.0*134^KERNEL^0^3000323^y
"BLD",48,1,0)
^^1^1^3000323^
"BLD",48,1,1,0)
See XU*8.0*134 of the National Patch Module for full documentation.
"BLD",48,4,0)
^9.64PA^20^2
"BLD",48,4,20,0)
20
"BLD",48,4,20,222)
y^y^f^^^^n
"BLD",48,4,200,0)
200
"BLD",48,4,200,2,0)
^9.641^200^1
"BLD",48,4,200,2,200,0)
NEW PERSON  (File-top level)
"BLD",48,4,200,2,200,1,0)
^9.6411^10.6^3
"BLD",48,4,200,2,200,1,.01,0)
NAME
"BLD",48,4,200,2,200,1,10.1,0)
NAME COMPONENTS
"BLD",48,4,200,2,200,1,10.6,0)
DEGREE
"BLD",48,4,200,222)
y^n^p^^^^n
"BLD",48,4,"APDD",200,200)

"BLD",48,4,"APDD",200,200,.01)

"BLD",48,4,"APDD",200,200,10.1)

"BLD",48,4,"APDD",200,200,10.6)

"BLD",48,4,"B",20,20)

"BLD",48,4,"B",200,200)

"BLD",48,"INI")
PRE^XLFNAME
"BLD",48,"INIT")
POST^XLFNAME
"BLD",48,"KRN",0)
^9.67PA^19^15
"BLD",48,"KRN",.4,0)
.4
"BLD",48,"KRN",.401,0)
.401
"BLD",48,"KRN",.402,0)
.402
"BLD",48,"KRN",.402,"NM",0)
^9.68A^3^3
"BLD",48,"KRN",.402,"NM",1,0)
XUEXISTING USER    FILE #200^200^0
"BLD",48,"KRN",.402,"NM",2,0)
XUNEW USER    FILE #200^200^0
"BLD",48,"KRN",.402,"NM",3,0)
XUREACT USER    FILE #200^200^0
"BLD",48,"KRN",.402,"NM","B","XUEXISTING USER    FILE #200",1)

"BLD",48,"KRN",.402,"NM","B","XUNEW USER    FILE #200",2)

"BLD",48,"KRN",.402,"NM","B","XUREACT USER    FILE #200",3)

"BLD",48,"KRN",.403,0)
.403
"BLD",48,"KRN",.403,"NM",0)
^9.68A^3^3
"BLD",48,"KRN",.403,"NM",1,0)
XUEXISTING USER    FILE #200^200^0
"BLD",48,"KRN",.403,"NM",2,0)
XUNEW USER    FILE #200^200^0
"BLD",48,"KRN",.403,"NM",3,0)
XUREACT USER    FILE #200^200^0
"BLD",48,"KRN",.403,"NM","B","XUEXISTING USER    FILE #200",1)

"BLD",48,"KRN",.403,"NM","B","XUNEW USER    FILE #200",2)

"BLD",48,"KRN",.403,"NM","B","XUREACT USER    FILE #200",3)

"BLD",48,"KRN",.5,0)
.5
"BLD",48,"KRN",.5,"NM",0)
^9.68A^1^1
"BLD",48,"KRN",.5,"NM",1,0)
XLFMTNAME^^0
"BLD",48,"KRN",.5,"NM","B","XLFMTNAME",1)

"BLD",48,"KRN",.84,0)
.84
"BLD",48,"KRN",3.6,0)
3.6
"BLD",48,"KRN",3.8,0)
3.8
"BLD",48,"KRN",9.2,0)
9.2
"BLD",48,"KRN",9.8,0)
9.8
"BLD",48,"KRN",9.8,"NM",0)
^9.68A^8^8
"BLD",48,"KRN",9.8,"NM",1,0)
XLFNAME^^0^B42592208
"BLD",48,"KRN",9.8,"NM",2,0)
XLFNAME1^^0^B49389588
"BLD",48,"KRN",9.8,"NM",3,0)
XLFNAME2^^0^B9395828
"BLD",48,"KRN",9.8,"NM",4,0)
XLFNAME3^^0^B28716276
"BLD",48,"KRN",9.8,"NM",5,0)
XLFNAME4^^0^B78659946
"BLD",48,"KRN",9.8,"NM",6,0)
XLFNAME5^^0^B36091048
"BLD",48,"KRN",9.8,"NM",7,0)
XUSERNEW^^0^B13683837
"BLD",48,"KRN",9.8,"NM",8,0)
XLFNAME6^^0^B933328
"BLD",48,"KRN",9.8,"NM","B","XLFNAME",1)

"BLD",48,"KRN",9.8,"NM","B","XLFNAME1",2)

"BLD",48,"KRN",9.8,"NM","B","XLFNAME2",3)

"BLD",48,"KRN",9.8,"NM","B","XLFNAME3",4)

"BLD",48,"KRN",9.8,"NM","B","XLFNAME4",5)

"BLD",48,"KRN",9.8,"NM","B","XLFNAME5",6)

"BLD",48,"KRN",9.8,"NM","B","XLFNAME6",8)

"BLD",48,"KRN",9.8,"NM","B","XUSERNEW",7)

"BLD",48,"KRN",19,0)
19
"BLD",48,"KRN",19.1,0)
19.1
"BLD",48,"KRN",101,0)
101
"BLD",48,"KRN",409.61,0)
409.61
"BLD",48,"KRN",8994,0)
8994
"BLD",48,"KRN","B",.4,.4)

"BLD",48,"KRN","B",.401,.401)

"BLD",48,"KRN","B",.402,.402)

"BLD",48,"KRN","B",.403,.403)

"BLD",48,"KRN","B",.5,.5)

"BLD",48,"KRN","B",.84,.84)

"BLD",48,"KRN","B",3.6,3.6)

"BLD",48,"KRN","B",3.8,3.8)

"BLD",48,"KRN","B",9.2,9.2)

"BLD",48,"KRN","B",9.8,9.8)

"BLD",48,"KRN","B",19,19)

"BLD",48,"KRN","B",19.1,19.1)

"BLD",48,"KRN","B",101,101)

"BLD",48,"KRN","B",409.61,409.61)

"BLD",48,"KRN","B",8994,8994)

"BLD",48,"PRE")
XLFNENV
"BLD",48,"QUES",0)
^9.62^^0
"BLD",48,"REQB",0)
^9.611^11^11
"BLD",48,"REQB",1,0)
A4A7*1.01*11^2
"BLD",48,"REQB",2,0)
DI*22.0*12^2
"BLD",48,"REQB",3,0)
DI*22.0*20^2
"BLD",48,"REQB",4,0)
DI*22.0*1^2
"BLD",48,"REQB",5,0)
DI*22.0*4^2
"BLD",48,"REQB",6,0)
DI*22.0*16^2
"BLD",48,"REQB",7,0)
DI*22.0*17^2
"BLD",48,"REQB",8,0)
DI*22.0*21^2
"BLD",48,"REQB",9,0)
XU*8.0*137^2
"BLD",48,"REQB",10,0)
XU*8.0*135^2
"BLD",48,"REQB",11,0)
DI*22.0*29^2
"BLD",48,"REQB","B","A4A7*1.01*11",1)

"BLD",48,"REQB","B","DI*22.0*1",4)

"BLD",48,"REQB","B","DI*22.0*12",2)

"BLD",48,"REQB","B","DI*22.0*16",6)

"BLD",48,"REQB","B","DI*22.0*17",7)

"BLD",48,"REQB","B","DI*22.0*20",3)

"BLD",48,"REQB","B","DI*22.0*21",8)

"BLD",48,"REQB","B","DI*22.0*29",11)

"BLD",48,"REQB","B","DI*22.0*4",5)

"BLD",48,"REQB","B","XU*8.0*135",10)

"BLD",48,"REQB","B","XU*8.0*137",9)

"FIA",20)
NAME COMPONENTS
"FIA",20,0)
^VA(20,
"FIA",20,0,0)
20IA
"FIA",20,0,1)
y^y^f^^^^n
"FIA",20,0,10)

"FIA",20,0,11)

"FIA",20,0,"RLRO")

"FIA",20,0,"VR")
8.0^XU
"FIA",20,20)
0
"FIA",200)
NEW PERSON
"FIA",200,0)
^VA(200,
"FIA",200,0,0)
200I
"FIA",200,0,1)
y^n^p^^^^n
"FIA",200,0,10)

"FIA",200,0,11)

"FIA",200,0,"RLRO")

"FIA",200,0,"VR")
8.0^XU
"FIA",200,200)
1
"FIA",200,200,.01)

"FIA",200,200,10.1)

"FIA",200,200,10.6)

"INI")
PRE^XLFNAME
"INIT")
POST^XLFNAME
"IX",20,20,"ADEG",0)
20^ADEG^Update the DEGREE field in the New Person file, if necessary.^MU^^R^IR^I^20^^^^^A
"IX",20,20,"ADEG",.1,0)
^^4^4^3000105^^
"IX",20,20,"ADEG",.1,1,0)
If this entry in the Name Components file corresponds to an entry in the
"IX",20,20,"ADEG",.1,2,0)
New Person file, this MUMPS cross-reference updates the DEGREE field in
"IX",20,20,"ADEG",.1,3,0)
the New Person file when the DEGREE field in the Name Components file is
"IX",20,20,"ADEG",.1,4,0)
changed, to ensure that the two fields are in synch.
"IX",20,20,"ADEG",1)
I '$G(XUNODEGT),X(1)=200,X(2)=.01,X2(4)]"" N XUNODEGT,DIERR,FDA,MSG S XUNODEGT=1,FDA(200,X(3),10.6)=X(4) D FILE^DIE("","FDA","MSG")
"IX",20,20,"ADEG",2)
I '$G(XUNODEGT),X(1)=200,X(2)=.01,X2(4)="" N XUNODEGT,DIERR,FDA,MSG S XUNODEGT=1,FDA(200,X(3),10.6)="@" D FILE^DIE("","FDA","MSG")
"IX",20,20,"ADEG",11.1,0)
^.114IA^4^4
"IX",20,20,"ADEG",11.1,1,0)
1^F^20^.01^^^F
"IX",20,20,"ADEG",11.1,2,0)
2^F^20^.02^^^F
"IX",20,20,"ADEG",11.1,3,0)
3^F^20^.03^^^F
"IX",20,20,"ADEG",11.1,4,0)
4^F^20^6^^^F
"IX",20,20,"ANAME",0)
20^ANAME^Update the Name field in the source file when any of the components are edited.^MU^^R^IR^I^20^^^^^A
"IX",20,20,"ANAME",.1,0)
^^8^8^3000322^
"IX",20,20,"ANAME",.1,1,0)
This MUMPS cross-reference keeps the data in the Name Components file in
"IX",20,20,"ANAME",.1,2,0)
synchronization with the corresponding name field in the source file
"IX",20,20,"ANAME",.1,3,0)
(e.g., New Person or Patient file).
"IX",20,20,"ANAME",.1,4,0)
 
"IX",20,20,"ANAME",.1,5,0)
The XUNOTRIG flag controls whether this cross-reference is executed. The
"IX",20,20,"ANAME",.1,6,0)
XUEXISTING USER, XUNEW USER, and XUREACT USER forms all set the XUNOTRIG
"IX",20,20,"ANAME",.1,7,0)
flag, because the forms themselves contain the logic necessary to keep the
"IX",20,20,"ANAME",.1,8,0)
New Persion name and Name Components entry synchronized.
"IX",20,20,"ANAME",1)
I '$G(XUNOTRIG) N XUNOTRIG,XUCOMP S XUNOTRIG=1,XUCOMP("FAMILY")=X(4),XUCOMP("GIVEN")=X(5),XUCOMP("MIDDLE")=X(6),XUCOMP("SUFFIX")=X(7) D UPDNAME^XLFNAME2(X(1),X(2),X(3),.XUCOMP)
"IX",20,20,"ANAME",2)
Q
"IX",20,20,"ANAME",11.1,0)
^.114IA^7^7
"IX",20,20,"ANAME",11.1,1,0)
1^F^20^.01^^^F
"IX",20,20,"ANAME",11.1,2,0)
2^F^20^.03^^^
"IX",20,20,"ANAME",11.1,3,0)
3^F^20^.02^^^
"IX",20,20,"ANAME",11.1,4,0)
4^F^20^1^^^
"IX",20,20,"ANAME",11.1,5,0)
5^F^20^2^^^
"IX",20,20,"ANAME",11.1,6,0)
6^F^20^3^^^
"IX",20,20,"ANAME",11.1,7,0)
7^F^20^5^^^
"IX",20,20,"ASIG",0)
20^ASIG^Update the SIGNATURE BLOCK PRINTED NAME in the New Person file, if necessary.^MU^^R^IR^I^20^^^^^A
"IX",20,20,"ASIG",.1,0)
^^4^4^3000322^
"IX",20,20,"ASIG",.1,1,0)
If this entry in the Name Components file corresponds to an entry in the
"IX",20,20,"ASIG",.1,2,0)
New Person file, this MUMPS cross-reference updates the SIGNATURE BLOCK
"IX",20,20,"ASIG",.1,3,0)
PRINTED NAME field (#20.2) in the New Person file when the Family Name,
"IX",20,20,"ASIG",.1,4,0)
Given Name, Middle Name, and/or Suffix are changed.
"IX",20,20,"ASIG",1)
I '$G(XUNOSIGT),X(1)=200,X(2)=.01 N COMP,DIERR,MSG,SIG,XUNOSIGT S XUNOSIGT=1,COMP("FAMILY")=X(4),COMP("GIVEN")=X(5),COMP("MIDDLE")=X(6),COMP("SUFFIX")=X(7),FDA(200,X(3),20.2)=$$NAMEFMT^XLFNAME(.XUCOMP,"G") D FILE^DIE("","FDA","MSG")
"IX",20,20,"ASIG",2)
Q
"IX",20,20,"ASIG",11.1,0)
^.114IA^7^7
"IX",20,20,"ASIG",11.1,1,0)
1^F^20^.01^^^F
"IX",20,20,"ASIG",11.1,2,0)
2^F^20^.02^^^F
"IX",20,20,"ASIG",11.1,3,0)
3^F^20^.03^^^F
"IX",20,20,"ASIG",11.1,4,0)
4^F^20^1^^^F
"IX",20,20,"ASIG",11.1,5,0)
5^F^20^2^^^F
"IX",20,20,"ASIG",11.1,6,0)
6^F^20^3^^^F
"IX",20,20,"ASIG",11.1,7,0)
7^F^20^5^^^F
"IX",20,20,"BB",0)
20^BB^Uniqueness Index for Key 'A' of File #20^R^^R^IR^I^20^^^^^LS
"IX",20,20,"BB",1)
S ^VA(20,"BB",X(1),X(2),X(3),DA)=""
"IX",20,20,"BB",2)
K ^VA(20,"BB",X(1),X(2),X(3),DA)
"IX",20,20,"BB",2.5)
K ^VA(20,"BB")
"IX",20,20,"BB",11.1,0)
^.114IA^3^3
"IX",20,20,"BB",11.1,1,0)
1^F^20^.01^^1
"IX",20,20,"BB",11.1,2,0)
2^F^20^.02^^2
"IX",20,20,"BB",11.1,3,0)
3^F^20^.03^^3
"IX",20,20,"C",0)
20^C^This index allows looking up entries by FamilyName,GivenName MiddleName Suffix^R^^R^IR^I^20^^^^^LS
"IX",20,20,"C",1)
S ^VA(20,"C",$E(X(5),1,100),DA)=""
"IX",20,20,"C",2)
K ^VA(20,"C",$E(X(5),1,100),DA)
"IX",20,20,"C",2.5)
K ^VA(20,"C")
"IX",20,20,"C",11.1,0)
^.114IA^8^5
"IX",20,20,"C",11.1,4,0)
1^F^20^1^^^F
"IX",20,20,"C",11.1,5,0)
2^F^20^2^^^F
"IX",20,20,"C",11.1,6,0)
3^F^20^3^^^F
"IX",20,20,"C",11.1,7,0)
4^F^20^5^^^F
"IX",20,20,"C",11.1,8,0)
5^C^^^100^1^F^FULL NAME
"IX",20,20,"C",11.1,8,1.5)
N XUN S XUN("FAMILY")=X(1),XUN("GIVEN")=X(2),XUN("MIDDLE")=X(3),XUN("SUFFIX")=X(4) S X=$$NAMEFMT^XLFNAME(.XUN,"F","C")
"IX",200,200,"ADEG",0)
200^ADEG^Update the DEGREE field in the Name Components file.^MU^^F^IR^I^200^^^^^A
"IX",200,200,"ADEG",.1,0)
^^2^2^3000105^^
"IX",200,200,"ADEG",.1,1,0)
This cross-reference keeps the DEGREE field in the New Person file in
"IX",200,200,"ADEG",.1,2,0)
synch with the DEGREE field in the Name Components file.
"IX",200,200,"ADEG",1)
I '$G(XUNODEGT),X2(1)]"" N XUNODEGT,XUPVAL,DIERR,XUFDA,XUMSG S XUPVAL=$P($G(^VA(200,DA,3.1)),U) I XUPVAL S XUNODEGT=1,XUFDA(20,XUPVAL_",",6)=X D FILE^DIE("","XUFDA","XUMSG")
"IX",200,200,"ADEG",2)
I '$G(XUNODEGT),X2(1)="" N XUNODEGT,XUPVAL,DIERR,XUFDA,XUMSG S XUPVAL=$P($G(^VA(200,DA,3.1)),U) I XUPVAL S XUNODEGT=1,XUFDA(20,XUPVAL_",",6)="@" D FILE^DIE("","XUFDA","XUMSG")
"IX",200,200,"ADEG",11.1,0)
^.114IA^1^1
"IX",200,200,"ADEG",11.1,1,0)
1^F^200^10.6^^1^F
"IX",200,200,"ANAME",0)
200^ANAME^Update the corresponding entry in the Name Components file.^MU^^F^IR^I^200^^^^^A
"IX",200,200,"ANAME",.1,0)
^^13^13^2991228^
"IX",200,200,"ANAME",.1,1,0)
This MUMPS cross-reference keeps the Name field in the New Person file in
"IX",200,200,"ANAME",.1,2,0)
synch with the corresponding entry in the Name Components file (#20).
"IX",200,200,"ANAME",.1,3,0)
 
"IX",200,200,"ANAME",.1,4,0)
The XUNOTRIG flag controls whether this cross-reference is executed. The
"IX",200,200,"ANAME",.1,5,0)
form XUEXISTING USER and the XUNEW USER forms both set the XUNOTRIG flag,
"IX",200,200,"ANAME",.1,6,0)
because the forms themselves contain the logic necessary to keep the two
"IX",200,200,"ANAME",.1,7,0)
files in synch.
"IX",200,200,"ANAME",.1,8,0)
 
"IX",200,200,"ANAME",.1,9,0)
XUITNAME is set by the XUEXISTING USER and XUNEW USER forms and is checked
"IX",200,200,"ANAME",.1,10,0)
by the input transform on the .01 field. If XUITNAME is set, the input
"IX",200,200,"ANAME",.1,11,0)
transform returns in the XLFNC array the component parts of the name. This
"IX",200,200,"ANAME",.1,12,0)
MUMPS cross-reference can then get the name components from the XLFNC
"IX",200,200,"ANAME",.1,13,0)
array to populate the Name Components file.
"IX",200,200,"ANAME",1)
I '$G(XUNOTRIG),X2(1)]"" N XUNOTRIG,XUPVAL S XUNOTRIG=1,XUPVAL=$P($G(^VA(200,DA,3.1)),U) K:'$D(XUITNAME) XLFNC S:$D(XLFNC)<2 XLFNC=X2(1) D UPDCOMP^XLFNAME2(200,DA,.01,.XLFNC,10.1,XUPVAL) K XLFNC,XUITNAME
"IX",200,200,"ANAME",2)
I '$G(XUNOTRIG),X2(1)="" N XUNOTRIG S XUNOTRIG=1 D DELCOMP^XLFNAME2(200,DA,.01)
"IX",200,200,"ANAME",11.1,0)
^.114IA^1^1
"IX",200,200,"ANAME",11.1,1,0)
1^F^200^.01^^1^F
"IX",200,200,"B",0)
200^B^Regular "B" index on .01 field with transform, length 35.^R^^F^IR^I^200^^^^^LS
"IX",200,200,"B",1)
S ^VA(200,"B",$E(X,1,35),DA)=""
"IX",200,200,"B",2)
K ^VA(200,"B",$E(X,1,35),DA)
"IX",200,200,"B",2.5)
K ^VA(200,"B")
"IX",200,200,"B",11.1,0)
^.114IA^1^1
"IX",200,200,"B",11.1,1,0)
1^F^200^.01^35^1^F
"IX",200,200,"B",11.1,1,4)
N XLFNAME S XLFNAME=X D STDNAME^XLFNAME(.XLFNAME,"F") S X=XLFNAME
"KEY",20,20,"A",0)
20^A^P^185
"KEY",20,20,"A",2,0)
^.312IA^3^3
"KEY",20,20,"A",2,1,0)
.01^20^1
"KEY",20,20,"A",2,2,0)
.02^20^2
"KEY",20,20,"A",2,3,0)
.03^20^3
"KEYPTR",20,20,"A")
20^BB
"KRN",.402,11,-1)
0^2
"KRN",.402,11,0)
XUNEW USER^2991129.1242^^200^^#^3000320
"KRN",.402,11,"DIAB",1,1,200.02,0)
ALL
"KRN",.402,11,"DIAB",2,0,200,0)
NAME COMPONENTS:
"KRN",.402,11,"DR",1,200)
D CHKPTR^XLFNAME2;^20^VA(20,^^S I(0,0)=D0 S Y(1)=$S($D(^VA(200,D0,3.1)):^(3.1),1:"") S X=$P(Y(1),U,1),X=X S D(0)=+X S X=$S(D(0)>0:D(0),1:"");13;7;9.2;8;9;16;29;28;2.1;11.1;3;201;203;31.3;14;31.1;200.04;200.05;200.06;200.09;200.1;
"KRN",.402,11,"DR",1,200,1)
200.11;15;41;41.2;.131;.132;.135;.136;.137;.138;200.07;8932.1;
"KRN",.402,11,"DR",2,20)
1;2;3;4;5;6;
"KRN",.402,11,"DR",2,200.02)
.01
"KRN",.402,11,"DR",2,200.03)
.01:2;
"KRN",.402,11,"DR",2,200.05)
.01:3;
"KRN",.402,12,-1)
0^1
"KRN",.402,12,0)
XUEXISTING USER^2991129.1128^^200^^#^3000320
"KRN",.402,12,"DIAB",1,1,200.02,0)
ALL
"KRN",.402,12,"DIAB",1,1,200.05,0)
ALL
"KRN",.402,12,"DIAB",6,0,200,0)
NAME COMPONENTS:
"KRN",.402,12,"DR",1,200)
S XUITNAME=1;.01;K XUITNAME;S D0=DA;D CHKPTR^XLFNAME2;^20^VA(20,^^S I(0,0)=D0 S Y(1)=$S($D(^VA(200,D0,3.1)):^(3.1),1:"") S X=$P(Y(1),U,1),X=X S D(0)=+X S X=$S(D(0)>0:D(0),1:"");1;13;7;9.2;8;9;16;29;28;2.1;11.1;3;201;203;31.3;14;
"KRN",.402,12,"DR",1,200,1)
31.1;200.04;200.05;200.06;200.09;200.1;200.11;200.18;15;41;41.2;.131;.132;.135;.136;.137;.138;200.07;8932.1;
"KRN",.402,12,"DR",2,20)
1;2;3;4;5;6;S DIEFIRE="RM";
"KRN",.402,12,"DR",2,200.02)
.01
"KRN",.402,12,"DR",2,200.03)
.01:2;
"KRN",.402,12,"DR",2,200.05)
.01:3
"KRN",.402,14,-1)
0^3
"KRN",.402,14,0)
XUREACT USER^2991230.1104^^200^^^3000113
"KRN",.402,14,"DIAB",1,1,200.02,0)
ALL
"KRN",.402,14,"DIAB",7,0,200,0)
NAME COMPONENTS:
"KRN",.402,14,"DR",1,200)
9.2///@;S XUITNAME=1;.01;K XUITNAME;S D0=DA;D CHKPTR^XLFNAME2;^20^VA(20,^^S I(0,0)=D0 S Y(1)=$S($D(^VA(200,D0,3.1)):^(3.1),1:"") S X=$P(Y(1),U,1),X=X S D(0)=+X S X=$S(D(0)>0:D(0),1:"");1;13;7;9.2;8;9;16;29;28;2.1;11.1;3;201;203;
"KRN",.402,14,"DR",1,200,1)
31.3;14;31.1;200.04;200.05;200.06;200.09;200.1;200.11;15;41;41.2;.131;.132;.135;.136;.137;.138;200.07;8932.1;
"KRN",.402,14,"DR",2,20)
1;2;3;4;5;6;S DIEFIRE="RM";
"KRN",.402,14,"DR",2,200.02)
.01
"KRN",.402,14,"DR",2,200.03)
.01:2;
"KRN",.402,14,"DR",2,200.05)
.01:3;
"KRN",.403,2,-1)
0^1
"KRN",.403,2,0)
XUEXISTING USER^^^^2920804^^^200^0^0^1
"KRN",.403,2,2)
1;33
"KRN",.403,2,11)
S XUNOTRIG=1 D CHKPTR^XLFNAME2
"KRN",.403,2,12)
K XUNOTRIG,XUITNAME
"KRN",.403,2,40,0)
^.4031I^8^6
"KRN",.403,2,40,1,0)
1^^1,1^2
"KRN",.403,2,40,1,1)
Page 1 of 3
"KRN",.403,2,40,1,40,0)
^.4032PI^55^2
"KRN",.403,2,40,1,40,4,0)
XUEXISTING USER 1^2^2,1^e
"KRN",.403,2,40,1,40,55,0)
XUEXISTING USER 0^1^1,1^d
"KRN",.403,2,40,2,0)
2^^1,1^3^1
"KRN",.403,2,40,2,1)
Page 2 of 3
"KRN",.403,2,40,2,15,0)
^^1^1^2941114^
"KRN",.403,2,40,2,15,1,0)
This is Page 2 of the edit existing user.
"KRN",.403,2,40,2,40,0)
^.4032PI^55^2
"KRN",.403,2,40,2,40,5,0)
XUEXISTING USER 2^2^2,1^e
"KRN",.403,2,40,2,40,55,0)
XUEXISTING USER 0^1^1,1^d
"KRN",.403,2,40,3,0)
1.1^^11,9^^^1^17,66^^
"KRN",.403,2,40,3,1)
SECONDARY MENU OPTIONS Subpage
"KRN",.403,2,40,3,40,0)
^.4032PI^6^1
"KRN",.403,2,40,3,40,6,0)
XUEXISTING USER 3^1^2,3^e
"KRN",.403,2,40,4,0)
1.2^^8,16^^^1^13,59^^
"KRN",.403,2,40,4,1)
DIVISION Subpage
"KRN",.403,2,40,4,40,0)
^.4032PI^7^1
"KRN",.403,2,40,4,40,7,0)
XUEXISTING USER 4^1^2,3^e
"KRN",.403,2,40,5,0)
3^^1,1^1^2
"KRN",.403,2,40,5,1)
Page 3
"KRN",.403,2,40,5,40,0)
^.4032PI^184^3
"KRN",.403,2,40,5,40,55,0)
XUEXISTING USER 0^1^1,1^d
"KRN",.403,2,40,5,40,58,0)
XUEXISTING USER 5^2^2,1^e
"KRN",.403,2,40,5,40,184,0)
XU-PERSON CLASS 2^3^13,1^e
"KRN",.403,2,40,5,40,184,2)
4^!IEN^n
"KRN",.403,2,40,8,0)
1.3^^8,12^^^1^17,65
"KRN",.403,2,40,8,1)
Page 1.3^
"KRN",.403,2,40,8,11)

"KRN",.403,2,40,8,12)
D:XLFNEW'=XLFNAME PUT^DDSVAL(200,XLFNDA,.01,XLFNEW,"","I") K XLFNDA,XLFNAME,XLFNEW
"KRN",.403,2,40,8,40,0)
^.4032IP^313^1
"KRN",.403,2,40,8,40,313,0)
XUEXISTING USER NAME COMPONENT^1^1,1^e
"KRN",.403,2,40,8,40,313,1)
10.1
"KRN",.403,30,-1)
0^3
"KRN",.403,30,0)
XUREACT USER^^@^^2950327.1641^^^200^0^0^1
"KRN",.403,30,11)
S XUNOTRIG=1 D CHKPTR^XLFNAME2
"KRN",.403,30,12)
K XUNOTRIG,XUITNAME
"KRN",.403,30,40,0)
^.4031I^6^6
"KRN",.403,30,40,1,0)
1^^1,1^2
"KRN",.403,30,40,1,1)
Page 1
"KRN",.403,30,40,1,11)
N % S %=$$GET^DDSVAL(200,XUN,2) D:$P(%,U,3)="" HLP^DDSUTL("USER has no ACCESS CODE")
"KRN",.403,30,40,1,40,0)
^.4032IP^55^2
"KRN",.403,30,40,1,40,4,0)
XUEXISTING USER 1^2^2,1^e
"KRN",.403,30,40,1,40,4,11)
D PUT^DDSVAL(DIE,.DA,9.2,"@"),PUT^DDSVAL(DIE,.DA,7,"@")
"KRN",.403,30,40,1,40,55,0)
XUEXISTING USER 0^1^1,1^e
"KRN",.403,30,40,2,0)
2^^1,1^3^1
"KRN",.403,30,40,2,1)
Page 2
"KRN",.403,30,40,2,40,0)
^.4032IP^55^2
"KRN",.403,30,40,2,40,5,0)
XUEXISTING USER 2^2^2,1^e
"KRN",.403,30,40,2,40,55,0)
XUEXISTING USER 0^1^1,1^e
"KRN",.403,30,40,3,0)
3^^1,1^1^2
"KRN",.403,30,40,3,1)
Page 3
"KRN",.403,30,40,3,40,0)
^.4032IP^184^3
"KRN",.403,30,40,3,40,55,0)
XUEXISTING USER 0^1^1,1^e
"KRN",.403,30,40,3,40,58,0)
XUEXISTING USER 5^2^2,1^e
"KRN",.403,30,40,3,40,184,0)
XU-PERSON CLASS 2^3^13,1^e
"KRN",.403,30,40,3,40,184,2)
4^!IEN^n
"KRN",.403,30,40,4,0)
1.1^^11,9^^^1^17,66
"KRN",.403,30,40,4,1)
Page 1.1
"KRN",.403,30,40,4,40,0)
^.4032IP^6^1
"KRN",.403,30,40,4,40,6,0)
XUEXISTING USER 3^1^2,3^e
"KRN",.403,30,40,5,0)
1.2^^8,16^^^1^13,59
"KRN",.403,30,40,5,1)
Page 1.2
"KRN",.403,30,40,5,40,0)
^.4032IP^7^1
"KRN",.403,30,40,5,40,7,0)
XUEXISTING USER 4^1^2,2^e
"KRN",.403,30,40,6,0)
1.3^^8,12^^^1^17,65
"KRN",.403,30,40,6,1)
Page 1.3
"KRN",.403,30,40,6,12)
D:XLFNEW'=XLFNAME PUT^DDSVAL(200,XLFNDA,.01,XLFNEW,"","I") K XLFNDA,XLFNAME,XLFNEW
"KRN",.403,30,40,6,40,0)
^.4032IP^313^1
"KRN",.403,30,40,6,40,313,0)
XUEXISTING USER NAME COMPONENT^1^1,1^e
"KRN",.403,30,40,6,40,313,1)
10.1
"KRN",.403,38,-1)
0^2
"KRN",.403,38,0)
XUNEW USER^ ^@^^2960729.0925^^^200^0^0^1
"KRN",.403,38,11)
S (XUNOTRIG,XLFCOMP,XUITNAME)=1
"KRN",.403,38,12)
K XUNOTRIG,XUITNAME
"KRN",.403,38,40,0)
^.4031I^6^6
"KRN",.403,38,40,1,0)
1^^1,1^2^
"KRN",.403,38,40,1,1)
Page 1
"KRN",.403,38,40,1,40,0)
^.4032IP^55^2
"KRN",.403,38,40,1,40,4,0)
XUEXISTING USER 1^2^2,1^e
"KRN",.403,38,40,1,40,55,0)
XUEXISTING USER 0^1^1,1^e
"KRN",.403,38,40,2,0)
2^^1,1^3^1
"KRN",.403,38,40,2,1)
Page 2
"KRN",.403,38,40,2,40,0)
^.4032IP^55^2
"KRN",.403,38,40,2,40,5,0)
XUEXISTING USER 2^2^2,1^e
"KRN",.403,38,40,2,40,55,0)
XUEXISTING USER 0^1^1,1^e
"KRN",.403,38,40,3,0)
3^^1,1^1^2
"KRN",.403,38,40,3,1)
Page 3
"KRN",.403,38,40,3,40,0)
^.4032IP^185^4
"KRN",.403,38,40,3,40,55,0)
XUEXISTING USER 0^2^1,1^e
"KRN",.403,38,40,3,40,58,0)
XUEXISTING USER 5^3^2,1^e
"KRN",.403,38,40,3,40,184,0)
XU-PERSON CLASS 2^4^13,1^e
"KRN",.403,38,40,3,40,184,2)
4^!IEN^n
"KRN",.403,38,40,3,40,185,0)
XUNEW USER^1^1,1^e
"KRN",.403,38,40,4,0)
1.1^^11,9^^^1^17,66
"KRN",.403,38,40,4,1)
Page 1.1
"KRN",.403,38,40,4,40,0)
^.4032IP^6^1
"KRN",.403,38,40,4,40,6,0)
XUEXISTING USER 3^1^2,3^e
"KRN",.403,38,40,5,0)
1.2^^8,16^^^1^13,59
"KRN",.403,38,40,5,1)
Page 1.2
"KRN",.403,38,40,5,40,0)
^.4032IP^7^1
"KRN",.403,38,40,5,40,7,0)
XUEXISTING USER 4^1^2,3^e
"KRN",.403,38,40,6,0)
1.3^^8,12^^^1^17,65
"KRN",.403,38,40,6,1)
Page 1.3
"KRN",.403,38,40,6,12)
D:XLFNEW'=XLFNAME PUT^DDSVAL(200,XLFNDA,.01,XLFNEW,"","I") K XLFNDA,XLFNAME,XLFNEW
"KRN",.403,38,40,6,40,0)
^.4032IP^313^1
"KRN",.403,38,40,6,40,313,0)
XUEXISTING USER NAME COMPONENT^1^1,1^e
"KRN",.403,38,40,6,40,313,1)
10.1
"KRN",.404,4,0)
XUEXISTING USER 1^200^^^
"KRN",.404,4,40,0)
^.4044I^17^16
"KRN",.404,4,40,1,0)
1^NAME...^3
"KRN",.404,4,40,1,1)
.01
"KRN",.404,4,40,1,2)
3,12^35^3,4^1
"KRN",.404,4,40,1,10)
S XLFNDA=DA,XLFNAME=X,DDSBR="GIVEN^^1.3"
"KRN",.404,4,40,1,11)
S XUITNAME=1 D:'$D(XLFCOMP) HLP^DDSUTL(" *** Press <RET> to edit the component parts of this name. ***") I $D(XLFCOMP) S XLFNDA=DA,XLFNAME=X,DDSBR="GIVEN^^1.3" K XLFCOMP
"KRN",.404,4,40,1,13)
S XLFNDA=DA,XLFNAME=X,DDSBR="GIVEN^^1.3",XLFNCHG=1
"KRN",.404,4,40,2,0)
2^TITLE^3
"KRN",.404,4,40,2,1)
8
"KRN",.404,4,40,2,2)
4,12^30^4,5
"KRN",.404,4,40,3,0)
3^INITIAL^3
"KRN",.404,4,40,3,1)
1
"KRN",.404,4,40,3,2)
3,65^5^3,56
"KRN",.404,4,40,4,0)
4^NICK NAME^3
"KRN",.404,4,40,4,1)
13
"KRN",.404,4,40,4,2)
4,65^10^4,54
"KRN",.404,4,40,5,0)
5^PRIMARY MENU OPTION^3^
"KRN",.404,4,40,5,1)
201
"KRN",.404,4,40,5,2)
8,33^30^8,12
"KRN",.404,4,40,6,0)
6^Select SECONDARY MENU OPTIONS^3
"KRN",.404,4,40,6,1)
203
"KRN",.404,4,40,6,2)
9,33^30^9,2
"KRN",.404,4,40,6,7)
^1.1
"KRN",.404,4,40,7,0)
7^Want to edit ACCESS CODE (Y/N)^3
"KRN",.404,4,40,7,1)
2.1
"KRN",.404,4,40,7,2)
11,33^3^11,1
"KRN",.404,4,40,8,0)
8^Want to edit VERIFY CODE (Y/N)^3
"KRN",.404,4,40,8,1)
11.1
"KRN",.404,4,40,8,2)
12,33^3^12,1
"KRN",.404,4,40,9,0)
9^FILE MANAGER ACCESS CODE^3
"KRN",.404,4,40,9,1)
3
"KRN",.404,4,40,9,2)
11,65^15^11,39
"KRN",.404,4,40,11,0)
11^PREFERRED EDITOR^3
"KRN",.404,4,40,11,1)
31.3
"KRN",.404,4,40,11,2)
14,33^30^14,15
"KRN",.404,4,40,12,0)
12^Select DIVISION^3
"KRN",.404,4,40,12,1)
16
"KRN",.404,4,40,12,2)
15,33^30^15,16
"KRN",.404,4,40,12,7)
^1.2
"KRN",.404,4,40,13,0)
13^SERVICE/SECTION^3
"KRN",.404,4,40,13,1)
29
"KRN",.404,4,40,13,2)
16,33^30^16,16
"KRN",.404,4,40,14,0)
4.5^MAIL CODE^3
"KRN",.404,4,40,14,1)
28
"KRN",.404,4,40,14,2)
5,65^10^5,54
"KRN",.404,4,40,15,0)
15^1^1^
"KRN",.404,4,40,15,2)
^^1,74^1
"KRN",.404,4,40,16,0)
2.5^SSN^3
"KRN",.404,4,40,16,1)
9
"KRN",.404,4,40,16,2)
5,12^9^5,7
"KRN",.404,4,40,17,0)
2.6^DEGREE^3
"KRN",.404,4,40,17,1)
10.6
"KRN",.404,4,40,17,2)
6,12^10^6,4
"KRN",.404,5,0)
XUEXISTING USER 2^200^^^
"KRN",.404,5,40,0)
^.4044I^16^15
"KRN",.404,5,40,1,0)
1^TIMED READ (# OF SECONDS)^3
"KRN",.404,5,40,1,1)
200.1
"KRN",.404,5,40,1,2)
4,31^5^4,4
"KRN",.404,5,40,2,0)
2^MULTIPLE SIGN-ON^3
"KRN",.404,5,40,2,1)
200.04
"KRN",.404,5,40,2,2)
6,31^11^6,13
"KRN",.404,5,40,3,0)
3^AUTO MENU^3
"KRN",.404,5,40,3,1)
200.06
"KRN",.404,5,40,3,2)
6,60^20^6,49
"KRN",.404,5,40,4,0)
4^ASK DEVICE TYPE AT SIGN-ON^3
"KRN",.404,5,40,4,1)
200.05
"KRN",.404,5,40,4,2)
7,31^9^7,3
"KRN",.404,5,40,5,0)
5^TYPE-AHEAD^3
"KRN",.404,5,40,5,1)
200.09
"KRN",.404,5,40,5,2)
7,60^11^7,48
"KRN",.404,5,40,6,0)
6^PROHIBITED TIMES FOR SIGN-ON^3
"KRN",.404,5,40,6,1)
15
"KRN",.404,5,40,6,2)
8,31^9^8,1
"KRN",.404,5,40,7,0)
7^ALLOWED TO USE SPOOLER^3
"KRN",.404,5,40,7,1)
41
"KRN",.404,5,40,7,2)
10,31^3^10,7
"KRN",.404,5,40,8,0)
8^CAN MAKE INTO A MAIL MESSAGE^3
"KRN",.404,5,40,8,1)
41.2
"KRN",.404,5,40,8,2)
11,31^3^11,1
"KRN",.404,5,40,10,0)
10^FILE RANGE^3
"KRN",.404,5,40,10,1)
31.1
"KRN",.404,5,40,10,2)
13,31^30^13,19
"KRN",.404,5,40,11,0)
11^TERMINATION DATE^3
"KRN",.404,5,40,11,1)
9.2
"KRN",.404,5,40,11,2)
14,31^11^14,13
"KRN",.404,5,40,12,0)
12^ALWAYS SHOW SECONDARIES^3
"KRN",.404,5,40,12,1)
200.11
"KRN",.404,5,40,12,2)
15,31^3^15,6
"KRN",.404,5,40,13,0)
13^2^1^
"KRN",.404,5,40,13,2)
^^1,74^1
"KRN",.404,5,40,14,0)
14^PAC^3
"KRN",.404,5,40,14,1)
14
"KRN",.404,5,40,14,2)
10,63^8^10,58
"KRN",.404,5,40,15,0)
15^DISUSER^3
"KRN",.404,5,40,15,1)
7
"KRN",.404,5,40,15,2)
11,63^3^11,54
"KRN",.404,5,40,16,0)
6.1^AUTO SIGN-ON^3
"KRN",.404,5,40,16,1)
200.18
"KRN",.404,5,40,16,2)
8,60^3^8,46
"KRN",.404,6,0)
XUEXISTING USER 3^200.03
"KRN",.404,6,40,0)
^.4044I^3^3
"KRN",.404,6,40,1,0)
1^SECONDARY MENU OPTIONS^1^
"KRN",.404,6,40,1,2)
^^1,33^
"KRN",.404,6,40,2,0)
2^SECONDARY MENU OPTIONS^3
"KRN",.404,6,40,2,1)
.01
"KRN",.404,6,40,2,2)
3,25^30^3,1
"KRN",.404,6,40,3,0)
3^SYNONYM^3
"KRN",.404,6,40,3,1)
2
"KRN",.404,6,40,3,2)
4,25^4^4,16
"KRN",.404,7,0)
XUEXISTING USER 4^200.02
"KRN",.404,7,40,0)
^.4044I^2^2
"KRN",.404,7,40,1,0)
1^DIVISION^1^
"KRN",.404,7,40,1,2)
^^1,33^
"KRN",.404,7,40,2,0)
2^DIVISION^3
"KRN",.404,7,40,2,1)
.01
"KRN",.404,7,40,2,2)
3,11^30^3,1
"KRN",.404,55,0)
XUEXISTING USER 0^200^
"KRN",.404,55,40,0)
^.4044I^5^5
"KRN",.404,55,40,1,0)
1^NAME^3
"KRN",.404,55,40,1,1)
.01
"KRN",.404,55,40,1,2)
2,7^30^2,1
"KRN",.404,55,40,1,4)
^^^1
"KRN",.404,55,40,2,0)
3^Edit an Existing User^1^
"KRN",.404,55,40,2,2)
^^1,30^1
"KRN",.404,55,40,3,0)
2^Page^1^
"KRN",.404,55,40,3,2)
^^2,69^1
"KRN",.404,55,40,4,0)
4^_______________________________________________________________________________^1^
"KRN",.404,55,40,4,2)
^^3,1^1
"KRN",.404,55,40,5,0)
5^of 3^1^
"KRN",.404,55,40,5,2)
^^2,76^1
"KRN",.404,58,0)
XUEXISTING USER 5^200
"KRN",.404,58,40,0)
^.4044I^10^10
"KRN",.404,58,40,1,0)
1^3^1^
"KRN",.404,58,40,1,2)
^^1,74^
"KRN",.404,58,40,2,0)
2^PROHIBITED TIMES FOR SIGN-ON^3
"KRN",.404,58,40,2,1)
15
"KRN",.404,58,40,2,2)
3,31^21^3,1
"KRN",.404,58,40,3,0)
3^PHONE^3
"KRN",.404,58,40,3,1)
.131
"KRN",.404,58,40,3,2)
5,19^20^5,12
"KRN",.404,58,40,4,0)
4^OFFICE PHONE^3
"KRN",.404,58,40,4,1)
.132
"KRN",.404,58,40,4,2)
5,56^20^5,42
"KRN",.404,58,40,5,0)
5^VOICE PAGER^3
"KRN",.404,58,40,5,1)
.137
"KRN",.404,58,40,5,2)
7,19^20^7,6
"KRN",.404,58,40,6,0)
6^FAX NUMBER^3
"KRN",.404,58,40,6,1)
.136
"KRN",.404,58,40,6,2)
6,56^20^6,44
"KRN",.404,58,40,7,0)
7^COMMERCIAL PHONE^3
"KRN",.404,58,40,7,1)
.135
"KRN",.404,58,40,7,2)
6,19^20^6,1
"KRN",.404,58,40,8,0)
8^DIGITAL PAGER^3
"KRN",.404,58,40,8,1)
.138
"KRN",.404,58,40,8,2)
7,56^20^7,41
"KRN",.404,58,40,9,0)
9^LANGUAGE^3
"KRN",.404,58,40,9,1)
200.07
"KRN",.404,58,40,9,2)
9,19^10^9,9
"KRN",.404,58,40,10,0)
10^Person Class                                         Effective     Expired^1
"KRN",.404,58,40,10,2)
^^11,2
"KRN",.404,184,0)
XU-PERSON CLASS 2^200.05
"KRN",.404,184,40,0)
^.4044I^3^3
"KRN",.404,184,40,1,0)
1^^3
"KRN",.404,184,40,1,1)
.01
"KRN",.404,184,40,1,2)
1,2^40
"KRN",.404,184,40,1,11)
D DDS1^XUA4A72
"KRN",.404,184,40,1,14)
S:$L(DDSOLD)&(X'=DDSOLD) DDSERROR=1
"KRN",.404,184,40,2,0)
2^^3
"KRN",.404,184,40,2,1)
2
"KRN",.404,184,40,2,2)
1,52^12
"KRN",.404,184,40,2,4)
^^^0
"KRN",.404,184,40,2,12)
D DDS2^XUA4A72
"KRN",.404,184,40,2,14)
D DDS3^XUA4A72(2)
"KRN",.404,184,40,3,0)
3^^3
"KRN",.404,184,40,3,1)
3
"KRN",.404,184,40,3,2)
1,67^12
"KRN",.404,184,40,3,14)
D DDS3^XUA4A72(3)
"KRN",.404,185,0)
XUNEW USER^200
"KRN",.404,313,0)
XUEXISTING USER NAME COMPONENT^20
"KRN",.404,313,11)
I $G(XLFNCHG),$D(XLFNC) N FLD,NC,SUB M NC=XLFNC K XLFNC S (XLFNAME,XLFNEW)=NC K XLFNCHG S FLD=0 F SUB="FAMILY","GIVEN","MIDDLE","","SUFFIX" S FLD=FLD+1 D:SUB]"" PUT^DDSVAL(DIE,DA,FLD,$G(NC(SUB)),"","I")
"KRN",.404,313,40,0)
^.4044I^8^7
"KRN",.404,313,40,1,0)
1^NAME COMPONENTS^1
"KRN",.404,313,40,1,2)
^^2,38
"KRN",.404,313,40,2,0)
5^Family (Last)^3
"KRN",.404,313,40,2,1)
1
"KRN",.404,313,40,2,2)
6,18^35^6,3
"KRN",.404,313,40,3,0)
3^Given (First)^3^^GIVEN
"KRN",.404,313,40,3,1)
2
"KRN",.404,313,40,3,2)
4,18^25^4,3
"KRN",.404,313,40,4,0)
4^Middle^3
"KRN",.404,313,40,4,1)
3
"KRN",.404,313,40,4,2)
5,18^25^5,10
"KRN",.404,313,40,5,0)
2^Prefix^3
"KRN",.404,313,40,5,1)
4
"KRN",.404,313,40,5,2)
3,18^10^3,10
"KRN",.404,313,40,6,0)
6^Suffix^3
"KRN",.404,313,40,6,1)
5
"KRN",.404,313,40,6,2)
7,18^10^7,10
"KRN",.404,313,40,8,0)
8^^4
"KRN",.404,313,40,8,2)
9,3^35
"KRN",.404,313,40,8,30)
N NC S NC("FAMILY")={1},NC("GIVEN")={2},NC("MIDDLE")={3},NC("SUFFIX")={5},(XLFNEW,Y)=$$BLDNAME^XLFNAME(.NC,35)
"KRN",.5,132,-1)
0^1
"KRN",.5,132,0)
XLFMTNAME
"KRN",.5,132,1)
N XUNAME S XUNAME("FILE")=X4,XUNAME("IENS")=X2_$E(",",($E(X2,$L(X2))'=",")),XUNAME("FIELD")=X3 S X=$$NAMEFMT^XLFNAME(.XUNAME,X1,X)
"KRN",.5,132,2)
X
"KRN",.5,132,3)
5
"KRN",.5,132,9)
Format NEW PERSON file name for printing
"KRN",.5,132,10)

"MBREQ")
0
"ORD",4,.5)
.5;4;;;EDEOUT^DIFROMSO(.5,DA,"",XPDA);FPRE^DIFROMSI(.5,"",XPDA);EPRE^DIFROMSI(.5,DA,"",XPDA,"",OLDA);;EPOST^DIFROMSI(.5,DA,"",XPDA)
"ORD",4,.5,0)
FUNCTION
"ORD",7,.402)
.402;7;;;EDEOUT^DIFROMSO(.402,DA,"",XPDA);FPRE^DIFROMSI(.402,"",XPDA);EPRE^DIFROMSI(.402,DA,$E("N",$G(XPDNEW)),XPDA,"",OLDA);;EPOST^DIFROMSI(.402,DA,"",XPDA);DEL^DIFROMSK(.402,"",%)
"ORD",7,.402,0)
INPUT TEMPLATE
"ORD",8,.403)
.403;8;;;EDEOUT^DIFROMSO(.403,DA,"",XPDA);FPRE^DIFROMSI(.403,"",XPDA);EPRE^DIFROMSI(.403,DA,$E("N",$G(XPDNEW)),XPDA,"",OLDA);;EPOST^DIFROMSI(.403,DA,"",XPDA);DEL^DIFROMSK(.403,"",%)
"ORD",8,.403,0)
FORM
"PKG",3,-1)
1^1
"PKG",3,0)
KERNEL^XU^SIGN-ON, SECURITY, MENU DRIVER, DEVICES, TASKMAN^XUDOCV7 NEW FEATURES
"PKG",3,22,0)
^9.49I^1^1
"PKG",3,22,1,0)
8.0^2950703^3000208^4
"PKG",3,22,1,"PAH",1,0)
134^3000323^3
"PKG",3,22,1,"PAH",1,1,0)
^^1^1^3000323
"PKG",3,22,1,"PAH",1,1,1,0)
See XU*8.0*134 of the National Patch Module for full documentation.
"PRE")
XLFNENV
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
9
"RTN","XLFNAME")
0^1^B42592208
"RTN","XLFNAME",1,0)
XLFNAME ;CIOFO-SF/TKW,MKO-Utilities for person name fields ;10:28 AM  10 Mar 2000
"RTN","XLFNAME",2,0)
 ;;8.0;KERNEL;**134**;Jul 10, 1995
"RTN","XLFNAME",3,0)
 ;
"RTN","XLFNAME",4,0)
STDNAME(XUNAME,XUFLAG,XUAUD) ;Standardize name XUNAME
"RTN","XLFNAME",5,0)
 ; XUNAME - In, name to be standardized. Out, standardized name
"RTN","XLFNAME",6,0)
 ; XUFLAG - In, "C" : return components in XUNAME array
"RTN","XLFNAME",7,0)
 ;              "F" : Assume input is in general form
"RTN","XLFNAME",8,0)
 ;                     Family,Given Middle Suffix
"RTN","XLFNAME",9,0)
 ;              "G" : Don't return XUAUD("GIVEN")
"RTN","XLFNAME",10,0)
 ;              "P" : Remove parenthetical text
"RTN","XLFNAME",11,0)
 ;.XUAUD  - Out:
"RTN","XLFNAME",12,0)
 ;           XUAUD = original name passed in
"RTN","XLFNAME",13,0)
 ;           XUAUD(subsc)="" if problems
"RTN","XLFNAME",14,0)
 ;
"RTN","XLFNAME",15,0)
 N I,XUFAM,XUNM,XUOUT,XUREST,XUSP
"RTN","XLFNAME",16,0)
 S XUOUT=$G(XUFLAG)["C"
"RTN","XLFNAME",17,0)
 N:XUOUT XUFAMO,XURESTO
"RTN","XLFNAME",18,0)
 K XUAUD S XUAUD=XUNAME
"RTN","XLFNAME",19,0)
 ;
"RTN","XLFNAME",20,0)
 F I="FAMILY","GIVEN","MIDDLE","SUFFIX" S XUNM(I)="" S:XUOUT XUOUT(I)=""
"RTN","XLFNAME",21,0)
 S:XUNAME?.E1" TEST" XUNAME=$E(XUNAME,1,$L(XUNAME)-5)
"RTN","XLFNAME",22,0)
 ;
"RTN","XLFNAME",23,0)
 I $G(XUFLAG)["P",XUNAME?.E1(1"(",1"[",1"{").E D
"RTN","XLFNAME",24,0)
 . S XUNAME=$$PARENS^XLFNAME1(XUNAME)
"RTN","XLFNAME",25,0)
 . S:XUAUD'=XUNAME XUAUD("STRIP")=""
"RTN","XLFNAME",26,0)
 ;
"RTN","XLFNAME",27,0)
 S:XUNAME?1"EEE".E!(XUNAME?.E1" FEE")!(XUNAME?1A1"-".E) XUAUD("NOTE")=""
"RTN","XLFNAME",28,0)
 ;
"RTN","XLFNAME",29,0)
 ;If no comma, assume given name first
"RTN","XLFNAME",30,0)
 I XUNAME'[",",$G(XUFLAG)'["F" G GIVFRST
"RTN","XLFNAME",31,0)
 ;
"RTN","XLFNAME",32,0)
 ;Standardize Family
"RTN","XLFNAME",33,0)
 ;(don't remove internal spaces or convert suffixes yet)
"RTN","XLFNAME",34,0)
 I $E(XUNAME,1,3)="ST." S XUAUD("FAMILY")=""
"RTN","XLFNAME",35,0)
 S XUFAM=$$CLEANC^XLFNAME1($P(XUNAME,","),"FI",.XUAUD)
"RTN","XLFNAME",36,0)
 S:XUOUT XUFAMO=$$CLEANC^XLFNAME1($P(XUNAME,","),"FO",.XUAUD)
"RTN","XLFNAME",37,0)
 ;
"RTN","XLFNAME",38,0)
 ;Look for suffixes at end of Family
"RTN","XLFNAME",39,0)
 D SUFEND^XLFNAME1(.XUFAM,.XUFAMO,.XUNM,.XUOUT,.XUAUD)
"RTN","XLFNAME",40,0)
 S:XUNM("SUFFIX")]"" XUAUD("SUFFIX")=""
"RTN","XLFNAME",41,0)
 S XUNM("FAMILY")=XUFAM S:XUOUT XUOUT("FAMILY")=XUFAMO
"RTN","XLFNAME",42,0)
 ;
"RTN","XLFNAME",43,0)
 ;Parse rest of name
"RTN","XLFNAME",44,0)
 ;If suffix in 1st comma-piece, move to end
"RTN","XLFNAME",45,0)
 S XUREST=$P(XUNAME,",",2,999)
"RTN","XLFNAME",46,0)
 D:XUREST["," SUF1ST^XLFNAME1(.XUREST,.XUAUD)
"RTN","XLFNAME",47,0)
 ;
"RTN","XLFNAME",48,0)
 S XUSP=XUREST?1" "1.E
"RTN","XLFNAME",49,0)
 S:XUOUT XURESTO=$$CLEANC^XLFNAME1(XUREST,"O",.XUAUD)
"RTN","XLFNAME",50,0)
 S XUREST=$$CLEANC^XLFNAME1(XUREST,"I",.XUAUD)
"RTN","XLFNAME",51,0)
 D N2(XUREST,.XUNM,.XUOUT,$G(XURESTO),.XUAUD)
"RTN","XLFNAME",52,0)
 ;
"RTN","XLFNAME",53,0)
 ;Account for names that look like Family,<sp>Suffixes
"RTN","XLFNAME",54,0)
 I XUSP,XUNM("MIDDLE")="",$$CHKSUF^XLFNAME1(XUNM("GIVEN"))]"" D
"RTN","XLFNAME",55,0)
 . S XUNM("SUFFIX")=$$JOIN(XUNM("GIVEN"),XUNM("SUFFIX"))
"RTN","XLFNAME",56,0)
 . S XUNM("GIVEN")=""
"RTN","XLFNAME",57,0)
 . D:XUOUT
"RTN","XLFNAME",58,0)
 .. S XUOUT("SUFFIX")=$$JOIN(XUOUT("GIVEN"),XUOUT("SUFFIX"))
"RTN","XLFNAME",59,0)
 .. S XUOUT("GIVEN")=""
"RTN","XLFNAME",60,0)
 ;
"RTN","XLFNAME",61,0)
 D BLDSTD(.XUNAME,.XUNM,.XUOUT,.XUAUD)
"RTN","XLFNAME",62,0)
 K:$G(XUFLAG)["G" XUAUD("GIVEN")
"RTN","XLFNAME",63,0)
 Q
"RTN","XLFNAME",64,0)
 ;
"RTN","XLFNAME",65,0)
BLDSTD(XUNAME,XUNM,XUOUT,XUAUD) ;Build standard name in XUNAME
"RTN","XLFNAME",66,0)
 ;Put components in XUNAME array
"RTN","XLFNAME",67,0)
 N I,J
"RTN","XLFNAME",68,0)
 K XUNAME M:XUOUT XUNAME=XUOUT
"RTN","XLFNAME",69,0)
 ;
"RTN","XLFNAME",70,0)
 S XUNAME=XUNM("FAMILY")_","
"RTN","XLFNAME",71,0)
 S:XUNAME[" " XUNAME=$TR(XUNAME," "),XUAUD("SPACE")=""
"RTN","XLFNAME",72,0)
 ;
"RTN","XLFNAME",73,0)
 I XUNM("GIVEN")]"" S XUNAME=XUNAME_XUNM("GIVEN")
"RTN","XLFNAME",74,0)
 E  S XUAUD("GIVEN")=""
"RTN","XLFNAME",75,0)
 S:XUNM("MIDDLE")]"" XUNAME=XUNAME_" "_XUNM("MIDDLE")
"RTN","XLFNAME",76,0)
 S:XUNM("SUFFIX")]"" XUNAME=XUNAME_" "_XUNM("SUFFIX")
"RTN","XLFNAME",77,0)
 S:XUNAME?.E1"," XUNAME=$E(XUNAME,1,$L(XUNAME)-1)
"RTN","XLFNAME",78,0)
 S:XUNAME?.E1N.E XUAUD("NUMBER")=""
"RTN","XLFNAME",79,0)
 ;
"RTN","XLFNAME",80,0)
 ;Remove spaces after periods, and ~ and ^, in name components
"RTN","XLFNAME",81,0)
 I XUOUT S I="" F  S I=$O(XUNAME(I)) Q:I=""  D
"RTN","XLFNAME",82,0)
 . S XUNAME(I)=$TR(XUNAME(I),"`^") Q:XUNAME(I)'[". "
"RTN","XLFNAME",83,0)
 . N J S J=0 F  S J=$F(XUNAME(I),". ",J) Q:'J  S $E(XUNAME(I),J-1)=""
"RTN","XLFNAME",84,0)
 Q
"RTN","XLFNAME",85,0)
 ;
"RTN","XLFNAME",86,0)
GIVFRST ;Come here if name has no comma.
"RTN","XLFNAME",87,0)
 N XUCNT,XUNAM,XUNAMO
"RTN","XLFNAME",88,0)
 ;
"RTN","XLFNAME",89,0)
 ;Do initial standardizing
"RTN","XLFNAME",90,0)
 S XUNAM=$$CLEANC^XLFNAME1(XUNAME,"I",.XUAUD)
"RTN","XLFNAME",91,0)
 S:XUOUT XUNAMO=$$CLEANC^XLFNAME1(XUNAME,"O",.XUAUD)
"RTN","XLFNAME",92,0)
 ;
"RTN","XLFNAME",93,0)
 ;Look for suffixes at end
"RTN","XLFNAME",94,0)
 D SUFEND^XLFNAME1(.XUNAM,.XUNAMO,.XUNM,.XUOUT,.XUAUD)
"RTN","XLFNAME",95,0)
 S XUCNT=$L(XUNAM," ")
"RTN","XLFNAME",96,0)
 ;
"RTN","XLFNAME",97,0)
 ;If name contains only suffixes, make first suffix the Family Name
"RTN","XLFNAME",98,0)
 I XUCNT=0 D  Q
"RTN","XLFNAME",99,0)
 . S XUNM("FAMILY")=$P(XUNM("SUFFIX")," ")
"RTN","XLFNAME",100,0)
 . S XUNM("SUFFIX")=$P(XUNM("SUFFIX")," ",2,999)
"RTN","XLFNAME",101,0)
 . S:$G(XUFLAG)'["G" XUAUD("GIVEN")=""
"RTN","XLFNAME",102,0)
 . D:XUOUT
"RTN","XLFNAME",103,0)
 .. S XUOUT("FAMILY")=$P(XUOUT("SUFFIX")," ")
"RTN","XLFNAME",104,0)
 .. S XUOUT("SUFFIX")=$P(XUOUT("SUFFIX")," ",2,999)
"RTN","XLFNAME",105,0)
 . D BLDSTD(.XUNAME,.XUNM,.XUOUT,.XUAUD)
"RTN","XLFNAME",106,0)
 ;
"RTN","XLFNAME",107,0)
 ;Set Family and rest of name
"RTN","XLFNAME",108,0)
 S XUNM("FAMILY")=$P(XUNAM," ",XUCNT),XUREST=$P(XUNAM," ",1,XUCNT-1)
"RTN","XLFNAME",109,0)
 S:XUOUT XUOUT("FAMILY")=$P(XUNAMO," ",XUCNT),XURESTO=$P(XUNAMO," ",1,XUCNT-1)
"RTN","XLFNAME",110,0)
 ;
"RTN","XLFNAME",111,0)
 ;Process rest of name (don't look for suffixes)
"RTN","XLFNAME",112,0)
 D N2(XUREST,.XUNM,.XUOUT,$G(XURESTO),.XUAUD,"s")
"RTN","XLFNAME",113,0)
 D BLDSTD(.XUNAME,.XUNM,.XUOUT,.XUAUD)
"RTN","XLFNAME",114,0)
 K:$G(XUFLAG)["G" XUAUD("GIVEN")
"RTN","XLFNAME",115,0)
 Q
"RTN","XLFNAME",116,0)
 ;
"RTN","XLFNAME",117,0)
NAMECOMP(XUNM) ;Build components from standard name
"RTN","XLFNAME",118,0)
 S XUNM("FAMILY")=$P(XUNM,",")
"RTN","XLFNAME",119,0)
 D N2($P(XUNM,",",2,999),.XUNM)
"RTN","XLFNAME",120,0)
 Q
"RTN","XLFNAME",121,0)
 ;
"RTN","XLFNAME",122,0)
N2(XUREST,XUNM,XUOUT,XURESTO,XUAUD,XUFLAG) ;Build components from non-family name
"RTN","XLFNAME",123,0)
 N XUCNT,XUGIVEN,XUI,XUMIDDLE,XUSUF,XUSUFFIX,XUX,X
"RTN","XLFNAME",124,0)
 S XUOUT=$G(XUOUT) N:XUOUT XUGIVENO,XUMIDO,XUSUFO,XUXO
"RTN","XLFNAME",125,0)
 S XUCNT=$L(XUREST," ")
"RTN","XLFNAME",126,0)
 ;
"RTN","XLFNAME",127,0)
 ;If 1st space-piece is DR, assume it's a suffix
"RTN","XLFNAME",128,0)
 I $P(XUREST," ")="DR",XUCNT>1 D
"RTN","XLFNAME",129,0)
 . S XUNM("SUFFIX")=$$JOIN(XUNM("SUFFIX"),"DR")
"RTN","XLFNAME",130,0)
 . S XUREST=$P(XUREST," ",2,999)
"RTN","XLFNAME",131,0)
 . D:XUOUT
"RTN","XLFNAME",132,0)
 .. S XUOUT("SUFFIX")=$$JOIN(XUOUT("SUFFIX"),$P(XURESTO," "))
"RTN","XLFNAME",133,0)
 .. S XURESTO=$P(XURESTO," ",2,999)
"RTN","XLFNAME",134,0)
 . S XUCNT=XUCNT-1
"RTN","XLFNAME",135,0)
 ;
"RTN","XLFNAME",136,0)
 ;Get Given from 1st space-piece, quit if only name
"RTN","XLFNAME",137,0)
 S XUNM("GIVEN")=$P(XUREST," ") S:XUOUT XUOUT("GIVEN")=$P(XURESTO," ")
"RTN","XLFNAME",138,0)
 Q:XUCNT<2
"RTN","XLFNAME",139,0)
 ;
"RTN","XLFNAME",140,0)
 S (XUSUF,XUMIDDLE,XUGIVEN)="" S:XUOUT (XUSUFO,XUMIDO,XUGIVENO)=""
"RTN","XLFNAME",141,0)
 ;
"RTN","XLFNAME",142,0)
 F XUI=XUCNT:-1:2 D
"RTN","XLFNAME",143,0)
 . S XUX=$P(XUREST," ",XUI)
"RTN","XLFNAME",144,0)
 . S:XUOUT XUXO=$P(XURESTO," ",XUI)
"RTN","XLFNAME",145,0)
 . ;
"RTN","XLFNAME",146,0)
 . ;If no middle yet, check for suffix
"RTN","XLFNAME",147,0)
 . I XUMIDDLE="",$G(XUFLAG)'["s" D  Q:XUSUFFIX]""
"RTN","XLFNAME",148,0)
 .. S XUSUFFIX=""
"RTN","XLFNAME",149,0)
 .. I XUI=2,"I^V^X"[XUX S XUAUD("SUFFIX")="" Q
"RTN","XLFNAME",150,0)
 .. I XUI>2,XUX="D",$P(XUREST," ",XUI-1)="M" S XUAUD("SUFFIX")="" Q
"RTN","XLFNAME",151,0)
 .. S XUSUFFIX=$$CHKSUF^XLFNAME1(XUX) Q:XUSUFFIX=""
"RTN","XLFNAME",152,0)
 .. S X=XUSUFFIX,XUSUFFIX=$$ROMAN^XLFNAME1(XUSUFFIX)
"RTN","XLFNAME",153,0)
 .. I XUI=2,X=XUSUFFIX S XUAUD("SUFFIX")=""
"RTN","XLFNAME",154,0)
 .. S XUSUF=$$JOIN(XUSUFFIX,XUSUF)
"RTN","XLFNAME",155,0)
 .. S:XUOUT XUSUFO=$$JOIN(XUXO,XUSUFO)
"RTN","XLFNAME",156,0)
 . ;
"RTN","XLFNAME",157,0)
 . ;If not suffix, and no middle, set middle
"RTN","XLFNAME",158,0)
 . I XUMIDDLE="" S XUMIDDLE=XUX S:XUOUT XUMIDO=XUXO Q
"RTN","XLFNAME",159,0)
 . ;
"RTN","XLFNAME",160,0)
 . ;Otherwise, put in Given
"RTN","XLFNAME",161,0)
 . S:XUI=2 XUAUD("MIDDLE")=""
"RTN","XLFNAME",162,0)
 . S XUGIVEN=$$JOIN(XUX,XUGIVEN)
"RTN","XLFNAME",163,0)
 . S:XUOUT XUGIVENO=$$JOIN(XUXO,XUGIVENO)
"RTN","XLFNAME",164,0)
 ;
"RTN","XLFNAME",165,0)
 D:XUSUF]""
"RTN","XLFNAME",166,0)
 . S XUNM("SUFFIX")=$$JOIN($G(XUNM("SUFFIX")),XUSUF)
"RTN","XLFNAME",167,0)
 . S:XUOUT XUOUT("SUFFIX")=$$JOIN($G(XUOUT("SUFFIX")),XUSUFO)
"RTN","XLFNAME",168,0)
 ;
"RTN","XLFNAME",169,0)
 S XUNM("MIDDLE")=XUMIDDLE
"RTN","XLFNAME",170,0)
 S:XUOUT XUOUT("MIDDLE")=XUMIDO
"RTN","XLFNAME",171,0)
 D:"^NMI^NMN^"[(U_XUNM("MIDDLE")_U)
"RTN","XLFNAME",172,0)
 . S XUNM("MIDDLE")="" S:XUOUT XUOUT("MIDDLE")=""
"RTN","XLFNAME",173,0)
 . S XUAUD("NM")=""
"RTN","XLFNAME",174,0)
 ;
"RTN","XLFNAME",175,0)
 D:XUGIVEN]""
"RTN","XLFNAME",176,0)
 . S XUNM("GIVEN")=XUNM("GIVEN")_" "_XUGIVEN
"RTN","XLFNAME",177,0)
 . S:XUOUT XUOUT("GIVEN")=XUOUT("GIVEN")_" "_XUGIVENO
"RTN","XLFNAME",178,0)
 Q
"RTN","XLFNAME",179,0)
 ;
"RTN","XLFNAME",180,0)
JOIN(S1,S2) ;Return S1 joined with S2 (separate by a space)
"RTN","XLFNAME",181,0)
 Q $G(S1)_$E(" ",$G(S1)]""&($G(S2)]""))_$G(S2)
"RTN","XLFNAME",182,0)
 ;
"RTN","XLFNAME",183,0)
NAMEFMT(XUNAME,XUFMT,XUFLAG,XUDLM) ;Name formatting routine
"RTN","XLFNAME",184,0)
 G NAMEFMTX^XLFNAME1
"RTN","XLFNAME",185,0)
 ;
"RTN","XLFNAME",186,0)
CLEANC(XUPART,XUFLAG,XUAUD) ;Component standardization
"RTN","XLFNAME",187,0)
 G CLEANCX^XLFNAME1
"RTN","XLFNAME",188,0)
 ;
"RTN","XLFNAME",189,0)
BLDNAME(XUNC,XUMAX) ;Build standard name from components
"RTN","XLFNAME",190,0)
 Q $$NAMEFMT(.XUNC,"F","CSL"_+$G(XUMAX))
"RTN","XLFNAME",191,0)
 ;
"RTN","XLFNAME",192,0)
HLNAME(XUNAME,XUFLAG,XUDLM) ;Convert name to HL7 format
"RTN","XLFNAME",193,0)
 N XUF
"RTN","XLFNAME",194,0)
 S XUF=$E("S",$G(XUFLAG)["S")
"RTN","XLFNAME",195,0)
 S:$G(XUFLAG)["L" XUF=XUF_"L"_+$P(XUFLAG,"L",2)
"RTN","XLFNAME",196,0)
 Q $$NAMEFMT^XLFNAME(.XUNAME,"H",XUF,$G(XUDLM))
"RTN","XLFNAME",197,0)
 ;
"RTN","XLFNAME",198,0)
FMNAME(XUNAME,XUFLAG,XUDLM) ;Convert HL7 name string to standard name or name components
"RTN","XLFNAME",199,0)
 G F^XLFNAME6
"RTN","XLFNAME",200,0)
 ;
"RTN","XLFNAME",201,0)
PRE ;Pre-install for patch XU*8.0*134
"RTN","XLFNAME",202,0)
 G PRE^XLFNAME3
"RTN","XLFNAME",203,0)
 ;
"RTN","XLFNAME",204,0)
POST ;Post-install for XU*8.0*134 (conversion)
"RTN","XLFNAME",205,0)
 G POST^XLFNAME3
"RTN","XLFNAME",206,0)
 ;
"RTN","XLFNAME",207,0)
GENERATE ;Generate information in ^XTMP about changes that will take
"RTN","XLFNAME",208,0)
 ;place when CONVERT^XLFNAME is run
"RTN","XLFNAME",209,0)
 G GENERATE^XLFNAME5
"RTN","XLFNAME",210,0)
 ;
"RTN","XLFNAME",211,0)
PRINT ;Print the information in ^XTMP
"RTN","XLFNAME",212,0)
 G PRINT^XLFNAME4
"RTN","XLFNAME",213,0)
 ;
"RTN","XLFNAME",214,0)
CONVERT ;Convert the Names in the New Person file
"RTN","XLFNAME",215,0)
 G CONVERT^XLFNAME5
"RTN","XLFNAME1")
0^2^B49389588
"RTN","XLFNAME1",1,0)
XLFNAME1 ;CIOFO-SF/TKW,MKO-Utilities for person name fields ;10:12 AM  10 Mar 2000
"RTN","XLFNAME1",2,0)
 ;;8.0;KERNEL;**134**;Jul 10, 1995
"RTN","XLFNAME1",3,0)
 ;
"RTN","XLFNAME1",4,0)
REMDBL(X,C) ; Remove double C chars, and chars from beg and end
"RTN","XLFNAME1",5,0)
 N I
"RTN","XLFNAME1",6,0)
 F  S I=$F(X,C_C) Q:'I  S $E(X,I-1)=""
"RTN","XLFNAME1",7,0)
 S:$E(X)=C X=$E(X,2,999)
"RTN","XLFNAME1",8,0)
 S:$E(X,$L(X))=C X=$E(X,1,$L(X)-1)
"RTN","XLFNAME1",9,0)
 Q X
"RTN","XLFNAME1",10,0)
 ;
"RTN","XLFNAME1",11,0)
ROMAN(X) ; Replace numeric suffixes to Roman Numeral equivalents
"RTN","XLFNAME1",12,0)
 Q:X'?.E1.N.E X
"RTN","XLFNAME1",13,0)
 N I,J,IN,OUT,S1,S2
"RTN","XLFNAME1",14,0)
 ;
"RTN","XLFNAME1",15,0)
 S IN="^1ST^2ND^3RD^4TH^5TH^6TH^7TH^8TH^9TH^10TH^"
"RTN","XLFNAME1",16,0)
 S OUT="I^II^III^IV^V^VI^VII^VIII^IX^X"
"RTN","XLFNAME1",17,0)
 S:IN[(U_X_U) X=$P(OUT,U,$L($P(IN,U_X_U),U))
"RTN","XLFNAME1",18,0)
 Q X
"RTN","XLFNAME1",19,0)
 ;
"RTN","XLFNAME1",20,0)
CHKSUF(X) ;Return X if it looks like a suffix; otherwise, return null
"RTN","XLFNAME1",21,0)
 N V
"RTN","XLFNAME1",22,0)
 Q:"^I^II^III^IV^V^VI^VII^VIII^IX^X^JR^SR^DR^MD^ESQ^DDS^RN^"[(U_X_U) X
"RTN","XLFNAME1",23,0)
 Q:"^1ST^2ND^3RD^4TH^5TH^6TH^7TH^8TH^9TH^10TH^"[(U_X_U) X
"RTN","XLFNAME1",24,0)
 I $L(X)>1,X'="NMN" D  I V="" S XUAUD("SUFFIX")="" Q X
"RTN","XLFNAME1",25,0)
 . F V="A","E","I","O","U","Y","" Q:X[V
"RTN","XLFNAME1",26,0)
 Q ""
"RTN","XLFNAME1",27,0)
 ;
"RTN","XLFNAME1",28,0)
PERIOD(X) ; Change X so that there is a space after every period
"RTN","XLFNAME1",29,0)
 Q:X'["." X
"RTN","XLFNAME1",30,0)
 N I
"RTN","XLFNAME1",31,0)
 S I=0 F  S I=$F(X,".",I) Q:'I!(I'<$L(X))  D
"RTN","XLFNAME1",32,0)
 . S:$E(X,I)'=" " X=$E(X,1,I-1)_" "_$E(X,I,999)
"RTN","XLFNAME1",33,0)
 Q X
"RTN","XLFNAME1",34,0)
 ;
"RTN","XLFNAME1",35,0)
PARENS(X) ;Strip parenthetical part(s) from X
"RTN","XLFNAME1",36,0)
 N C,DONE,LEV,P,P1,P2
"RTN","XLFNAME1",37,0)
 F  Q:X'?.E1(1"(",1"[",1"{").E  D  Q:'P2
"RTN","XLFNAME1",38,0)
 . S (DONE,LEV,P1,P2)=0
"RTN","XLFNAME1",39,0)
 . F P=1:1:$L(X) D  Q:DONE
"RTN","XLFNAME1",40,0)
 .. S C=$E(X,P)
"RTN","XLFNAME1",41,0)
 .. I C?1(1"(",1"[",1"{") S:'LEV P1=P S LEV=LEV+1
"RTN","XLFNAME1",42,0)
 .. E  I P1,C?1(1")",1"]",1"}") S P2=P,LEV=LEV-1 S:'LEV DONE=1
"RTN","XLFNAME1",43,0)
 . S:P2 X=$E(X,1,P1-1)_$E(X,P2+1,999)
"RTN","XLFNAME1",44,0)
 Q X
"RTN","XLFNAME1",45,0)
 ;
"RTN","XLFNAME1",46,0)
SUFEND(XUN,XUNO,XUNM,XUOUT,XUAUD) ;Look for suffixes at end of XUN
"RTN","XLFNAME1",47,0)
 ;Put in XUNM("SUFFIX")
"RTN","XLFNAME1",48,0)
 ;Remove those suffixes from XUN and XUNO
"RTN","XLFNAME1",49,0)
 N XUI,XUSUF,XUSUFO,XUSUFFIX,XUX
"RTN","XLFNAME1",50,0)
 S XUSUF="" S:XUOUT XUSUFO=""
"RTN","XLFNAME1",51,0)
 ;
"RTN","XLFNAME1",52,0)
 F XUI=$L(XUN," "):-1:2 D  Q:XUSUFFIX=""
"RTN","XLFNAME1",53,0)
 . S XUX=$P(XUN," ",XUI)
"RTN","XLFNAME1",54,0)
 . S XUSUFFIX=$$CHKSUF(XUX) Q:XUSUFFIX=""
"RTN","XLFNAME1",55,0)
 . S XUSUF=$$JOIN($$ROMAN(XUSUFFIX),XUSUF)
"RTN","XLFNAME1",56,0)
 . S XUN=$P(XUN," ",1,XUI-1)
"RTN","XLFNAME1",57,0)
 . D:XUOUT
"RTN","XLFNAME1",58,0)
 .. S XUSUFO=$P(XUNO," ",XUI)_$E(" ",XUSUFO]"")_XUSUFO
"RTN","XLFNAME1",59,0)
 .. S XUNO=$P(XUNO," ",1,XUI-1)
"RTN","XLFNAME1",60,0)
 ;
"RTN","XLFNAME1",61,0)
 I XUSUF]"" S XUNM("SUFFIX")=XUSUF S:XUOUT XUOUT("SUFFIX")=XUSUFO
"RTN","XLFNAME1",62,0)
 Q
"RTN","XLFNAME1",63,0)
 ;
"RTN","XLFNAME1",64,0)
SUF1ST(XUREST,XUAUD) ;If suffix in 1st comma-piece, move to end
"RTN","XLFNAME1",65,0)
 F  Q:XUREST'[","  Q:$$CHKSUF($$CLEANC($P(XUREST,","),"I"))=""  D
"RTN","XLFNAME1",66,0)
 . S XUREST=$P(XUREST,",",2,999)_" "_$P(XUREST,",")
"RTN","XLFNAME1",67,0)
 . S XUAUD("SUFFIX")="",XUAUD("PUNC")=""
"RTN","XLFNAME1",68,0)
 Q
"RTN","XLFNAME1",69,0)
 ;
"RTN","XLFNAME1",70,0)
CLEANC(XUPART,XUFLAG,XUAUD) ; Component standardization
"RTN","XLFNAME1",71,0)
CLEANCX ; Entry point from CLEANC^XLFNAME
"RTN","XLFNAME1",72,0)
 Q:$G(XUPART)="" ""
"RTN","XLFNAME1",73,0)
 N XUX,I
"RTN","XLFNAME1",74,0)
 S XUFLAG=$G(XUFLAG)
"RTN","XLFNAME1",75,0)
 ;
"RTN","XLFNAME1",76,0)
 S:XUPART?.E1.L.E XUPART=$$UP^XLFSTR(XUPART)
"RTN","XLFNAME1",77,0)
 ;
"RTN","XLFNAME1",78,0)
 S XUX=$S(XUFLAG["F":"-",1:" ")
"RTN","XLFNAME1",79,0)
 S I=XUPART,XUPART=$TR(XUPART,",:;",XUX_XUX_XUX)
"RTN","XLFNAME1",80,0)
 S:XUPART'=I XUAUD("PUNC")=""
"RTN","XLFNAME1",81,0)
 ;
"RTN","XLFNAME1",82,0)
 Q:XUFLAG["O" $$REMDBL($$REMDBL($$PERIOD(XUPART)," "),"-")
"RTN","XLFNAME1",83,0)
 ;
"RTN","XLFNAME1",84,0)
 I XUPART["." S XUPART=$TR(XUPART,"."," "),XUAUD("PERIOD")=""
"RTN","XLFNAME1",85,0)
 ;
"RTN","XLFNAME1",86,0)
 I XUFLAG'["I" D
"RTN","XLFNAME1",87,0)
 . F I=1:1:$L(XUPART," ") S $P(XUPART," ",I)=$$ROMAN($P(XUPART," ",I))
"RTN","XLFNAME1",88,0)
 . S:XUPART?.E1N.E XUAUD("NUMBER")=""
"RTN","XLFNAME1",89,0)
 ;
"RTN","XLFNAME1",90,0)
 S I=XUPART,XUPART=$TR(XUPART,"!""#$%&'()*+,./:;<=>?@[\]^_`{|}~")
"RTN","XLFNAME1",91,0)
 S:XUPART'=I XUAUD("PUNC")=""
"RTN","XLFNAME1",92,0)
 ;
"RTN","XLFNAME1",93,0)
 ;Remove all spaces and double hyphens from Family Name
"RTN","XLFNAME1",94,0)
 I XUFLAG["F",XUFLAG'["I" D  Q $$REMDBL(XUPART,"-")
"RTN","XLFNAME1",95,0)
 . S:XUPART?." "1.ANP1." "1.ANP." " XUAUD("SPACE")=""
"RTN","XLFNAME1",96,0)
 . S XUPART=$TR(XUPART," ")
"RTN","XLFNAME1",97,0)
 ;
"RTN","XLFNAME1",98,0)
 Q $$REMDBL($$REMDBL(XUPART," "),"-")
"RTN","XLFNAME1",99,0)
 ;
"RTN","XLFNAME1",100,0)
NAMEFMT(XUNAME,XUFMT,XUFLAG,XUDLM) ; Name formatting routine (extrinsic)
"RTN","XLFNAME1",101,0)
NAMEFMTX ;
"RTN","XLFNAME1",102,0)
 ; XUNAME: Input name components array or Name Components Key fields
"RTN","XLFNAME1",103,0)
 ; XUFMT:  F=Family name first,G=Given name first,H=HL7 (default G)
"RTN","XLFNAME1",104,0)
 ; XUFLAG: P=Include prefix,D=Include degree,S=Standardize components,M=Mixed case
"RTN","XLFNAME1",105,0)
 ; XUDLM:  Delimiter if HL7 message (def = ^)
"RTN","XLFNAME1",106,0)
 N XUBLD,XUI,XULEN,XUN,XUSTEP
"RTN","XLFNAME1",107,0)
 ;
"RTN","XLFNAME1",108,0)
 ;Set defaults
"RTN","XLFNAME1",109,0)
 S XUFMT=$G(XUFMT) S:XUFMT="" XUFMT="G"
"RTN","XLFNAME1",110,0)
 S XUFLAG=$G(XUFLAG)
"RTN","XLFNAME1",111,0)
 S:$G(XUDLM)="" XUDLM=U
"RTN","XLFNAME1",112,0)
 S:XUFLAG["L" XULEN=+$P(XUFLAG,"L",2) S:$G(XULEN)<1 XULEN=256
"RTN","XLFNAME1",113,0)
 ;
"RTN","XLFNAME1",114,0)
 ;Get XUN (name array)
"RTN","XLFNAME1",115,0)
 ;If a name (no array) is passed in
"RTN","XLFNAME1",116,0)
 I $D(XUNAME)<10 D
"RTN","XLFNAME1",117,0)
 . S XUN=$G(XUNAME) Q:XUN=""
"RTN","XLFNAME1",118,0)
 . D STDNAME^XLFNAME(.XUN,"CP")
"RTN","XLFNAME1",119,0)
 ;
"RTN","XLFNAME1",120,0)
 ;Else, if a file, field, iens passed in
"RTN","XLFNAME1",121,0)
 E  I $G(XUNAME("FILE")),$G(XUNAME("FIELD")),$G(XUNAME("IENS"))]"" D
"RTN","XLFNAME1",122,0)
 . N IEN,IENS
"RTN","XLFNAME1",123,0)
 . S IENS=$G(XUNAME("IENS")) S:IENS'?.E1"," IENS=IENS_","
"RTN","XLFNAME1",124,0)
 . S IEN=$O(^VA(20,"BB",+XUNAME("FILE"),+$G(XUNAME("FIELD")),IENS,0))
"RTN","XLFNAME1",125,0)
 . I IEN D
"RTN","XLFNAME1",126,0)
 .. N I
"RTN","XLFNAME1",127,0)
 .. S I=0 F XUI="FAMILY","GIVEN","MIDDLE","PREFIX","SUFFIX","DEGREE" D
"RTN","XLFNAME1",128,0)
 ... S I=I+1,XUN(XUI)=$P($G(^VA(20,IEN,1)),U,I)
"RTN","XLFNAME1",129,0)
 . E  D
"RTN","XLFNAME1",130,0)
 .. N MSG,NAM,DIERR
"RTN","XLFNAME1",131,0)
 .. S NAM=$$GET1^DIQ(+XUNAME("FILE"),IENS,+$G(XUNAME("FIELD")),"I","MSG")
"RTN","XLFNAME1",132,0)
 .. I NAM]"" S XUN=NAM D STDNAME^XLFNAME(.XUN,"CP")
"RTN","XLFNAME1",133,0)
 ;
"RTN","XLFNAME1",134,0)
 ;Else, components passed in
"RTN","XLFNAME1",135,0)
 E  M XUN=XUNAME
"RTN","XLFNAME1",136,0)
 ;
"RTN","XLFNAME1",137,0)
 ;Standardize
"RTN","XLFNAME1",138,0)
 F XUI="FAMILY","GIVEN","MIDDLE","SUFFIX","PREFIX","DEGREE" D
"RTN","XLFNAME1",139,0)
 . S XUN(XUI)=$G(XUN(XUI))
"RTN","XLFNAME1",140,0)
 . I XUFLAG["S",XUN(XUI)]"" S XUN(XUI)=$$CLEANC(XUN(XUI),$E("F",XUI="FAMILY"))
"RTN","XLFNAME1",141,0)
 Q:$G(XUN("FAMILY"))="" ""
"RTN","XLFNAME1",142,0)
 ;
"RTN","XLFNAME1",143,0)
 ; Return in mixed case
"RTN","XLFNAME1",144,0)
 I XUFLAG["M" D
"RTN","XLFNAME1",145,0)
 . N XUCMP,X
"RTN","XLFNAME1",146,0)
 . F XUCMP="FAMILY","GIVEN","MIDDLE","PREFIX" I XUN(XUCMP)]"" S XUN(XUCMP)=$$MIX(XUN(XUCMP))
"RTN","XLFNAME1",147,0)
 . I XUN("DEGREE")]"" S XUN("DEGREE")=$$MIX2(XUN("DEGREE"))
"RTN","XLFNAME1",148,0)
 . I XUN("SUFFIX")]"" S XUN("SUFFIX")=$$MIX2(XUN("SUFFIX"))
"RTN","XLFNAME1",149,0)
 . Q
"RTN","XLFNAME1",150,0)
 ;
"RTN","XLFNAME1",151,0)
 ;Build formatted name, truncate if necessary
"RTN","XLFNAME1",152,0)
 S XUBLD=1 F XUSTEP=0:1 D  Q:$L(XUN)'>XULEN
"RTN","XLFNAME1",153,0)
 . ;Build formatted name
"RTN","XLFNAME1",154,0)
 . I XUBLD S XUBLD=0 D  Q:$L(XUN)'>XULEN
"RTN","XLFNAME1",155,0)
 .. I XUFMT["H" S XUN=$$H(.XUN,XUDLM) Q
"RTN","XLFNAME1",156,0)
 .. I XUFMT["O" S XUN=$$O(.XUN) Q
"RTN","XLFNAME1",157,0)
 .. I XUFMT["G" S XUN=$$G(.XUN,XUFLAG) Q
"RTN","XLFNAME1",158,0)
 .. S XUN=$$F(.XUN,XUFLAG) Q
"RTN","XLFNAME1",159,0)
 . ;
"RTN","XLFNAME1",160,0)
 . ;Truncation steps
"RTN","XLFNAME1",161,0)
 . Q:'XUSTEP
"RTN","XLFNAME1",162,0)
 . I XUSTEP=1 S:XUN("DEGREE")]"" XUN("DEGREE")="",XUBLD=1 Q
"RTN","XLFNAME1",163,0)
 . I XUSTEP=2 S:XUN("PREFIX")]"" XUN("PREFIX")="",XUBLD=1 Q
"RTN","XLFNAME1",164,0)
 . I XUSTEP=3 S:XUN("MIDDLE")]"" XUN("MIDDLE")=$$TRUNC(XUN("MIDDLE"),$L(XUN)-XULEN),XUBLD=1 Q
"RTN","XLFNAME1",165,0)
 . I XUSTEP=4 S:XUN("SUFFIX")]"" XUN("SUFFIX")="",XUBLD=1 Q
"RTN","XLFNAME1",166,0)
 . I XUSTEP=5 S:XUN("GIVEN")]"" XUN("GIVEN")=$$TRUNC(XUN("GIVEN"),$L(XUN)-XULEN),XUBLD=1 Q
"RTN","XLFNAME1",167,0)
 . I XUSTEP=6 S:XUN("FAMILY")]"" XUN("FAMILY")=$$TRUNC(XUN("FAMILY"),$L(XUN)-XULEN),XUBLD=1 Q
"RTN","XLFNAME1",168,0)
 . I XUSTEP=7 S XUN=$E(XUN,1,XULEN) F  Q:XUN'?.E1" "  S XUN=$E(XUN,1,$L(XUN)-1)
"RTN","XLFNAME1",169,0)
 Q XUN
"RTN","XLFNAME1",170,0)
 ;
"RTN","XLFNAME1",171,0)
MIX(X) ; Return name part with only first letter upper-case
"RTN","XLFNAME1",172,0)
 N %,L
"RTN","XLFNAME1",173,0)
 F %=2:1:$L(X) I $E(X,%)?1U,$E(X,%-1)?1A S L=$E(X,%),L=$C($A(L)+32),$E(X,%)=L
"RTN","XLFNAME1",174,0)
 Q X
"RTN","XLFNAME1",175,0)
 ;
"RTN","XLFNAME1",176,0)
MIX2(XUN) ; Properly capitalize suffixes, degrees
"RTN","XLFNAME1",177,0)
 N P,I,L,DIOUT
"RTN","XLFNAME1",178,0)
 F P="DR","PHD","JR","SR","ESQ" S I=$F(XUN,P) I I D
"RTN","XLFNAME1",179,0)
 . Q:$E(XUN,I)?1A
"RTN","XLFNAME1",180,0)
 . I P="PHD" Q:$E(XUN,I-4)?1A  S $E(XUN,I-3,I-1)="PhD" Q
"RTN","XLFNAME1",181,0)
 . S L=$L(P) Q:$E(XUN,I-(L+1))?1A
"RTN","XLFNAME1",182,0)
 . S X=$$MIX($E(XUN,I-L,I-1)),$E(XUN,I-L,I-1)=X
"RTN","XLFNAME1",183,0)
 . Q
"RTN","XLFNAME1",184,0)
 I XUN?.E1.N1.U.E S DIOUT=0 F P=1:1:10 S I=$F(XUN,P) I I D  Q:DIOUT
"RTN","XLFNAME1",185,0)
 . S L=$S(P=1:"ST",P=2:"ND",P=3:"RD",1:"TH")
"RTN","XLFNAME1",186,0)
 . I $E(XUN,I,I+1)'=L Q
"RTN","XLFNAME1",187,0)
 . S $E(XUN,I,I+1)=$S(P=1:"st",P=2:"nd",P=3:"rd",1:"th")
"RTN","XLFNAME1",188,0)
 . S DIOUT=1 Q
"RTN","XLFNAME1",189,0)
 Q XUN
"RTN","XLFNAME1",190,0)
 ;
"RTN","XLFNAME1",191,0)
O(N) ;O format
"RTN","XLFNAME1",192,0)
 Q N("FAMILY")
"RTN","XLFNAME1",193,0)
 ;
"RTN","XLFNAME1",194,0)
F(N,F) ;F format
"RTN","XLFNAME1",195,0)
 N NAM
"RTN","XLFNAME1",196,0)
 S NAM=N("FAMILY")_$S(F["C":",",1:" ")_N("GIVEN")_$E(" ",N("MIDDLE")]"")_N("MIDDLE")
"RTN","XLFNAME1",197,0)
 S NAM=$$SPD(NAM,.N,F)
"RTN","XLFNAME1",198,0)
 S:NAM?.E1(1",",1" ") NAM=$E(NAM,1,$L(NAM)-1)
"RTN","XLFNAME1",199,0)
 Q NAM
"RTN","XLFNAME1",200,0)
 ;
"RTN","XLFNAME1",201,0)
G(N,F) ;G format
"RTN","XLFNAME1",202,0)
 N NAM,I
"RTN","XLFNAME1",203,0)
 S NAM="" F I="GIVEN","MIDDLE","FAMILY" S NAM=$$JOIN(NAM,N(I))
"RTN","XLFNAME1",204,0)
 Q $$SPD(NAM,.N,F)
"RTN","XLFNAME1",205,0)
 ;
"RTN","XLFNAME1",206,0)
H(N,D) ;H format
"RTN","XLFNAME1",207,0)
 N NAM
"RTN","XLFNAME1",208,0)
 S NAM=N("FAMILY")_D_N("GIVEN")_D_N("MIDDLE")_D_N("SUFFIX")_D_N("PREFIX")_D_N("DEGREE")
"RTN","XLFNAME1",209,0)
 F  Q:$E(NAM,$L(NAM))'=D  S NAM=$E(NAM,1,$L(NAM)-1)
"RTN","XLFNAME1",210,0)
 Q NAM
"RTN","XLFNAME1",211,0)
 ;
"RTN","XLFNAME1",212,0)
SPD(NAM,N,F) ;Add Suffix, Prefix, and Degree
"RTN","XLFNAME1",213,0)
 S NAM=$$JOIN(NAM,N("SUFFIX"),$E(",",F["Xc")_" ")
"RTN","XLFNAME1",214,0)
 S:F["P" NAM=$$JOIN(N("PREFIX"),NAM)
"RTN","XLFNAME1",215,0)
 S:F["D" NAM=$$JOIN(NAM,N("DEGREE"),$E(",",F["Dc")_" ")
"RTN","XLFNAME1",216,0)
 Q NAM
"RTN","XLFNAME1",217,0)
 ;
"RTN","XLFNAME1",218,0)
JOIN(S1,S2,D) ;Return S1 joined with S2 (separate by D)
"RTN","XLFNAME1",219,0)
 S:$G(D)="" D=" "
"RTN","XLFNAME1",220,0)
 Q S1_$S($L(S1)&$L(S2):D,1:"")_S2
"RTN","XLFNAME1",221,0)
 ;
"RTN","XLFNAME1",222,0)
TRUNC(NC,OVR) ;Truncate component
"RTN","XLFNAME1",223,0)
 S NC=$E(NC,1,$S($L(NC)>OVR:$L(NC)-OVR,1:1))
"RTN","XLFNAME1",224,0)
 F  Q:NC'?.E1" "  S NC=$E(NC,1,$L(NC)-1)
"RTN","XLFNAME1",225,0)
 Q NC
"RTN","XLFNAME2")
0^3^B9395828
"RTN","XLFNAME2",1,0)
XLFNAME2 ;CIOFO-SF/MKO-UPDATE ENTRY POINTS;12:04 PM  17 Mar 2000
"RTN","XLFNAME2",2,0)
 ;;8.0;KERNEL;**134**;Jul 10, 1995
"RTN","XLFNAME2",3,0)
 ;
"RTN","XLFNAME2",4,0)
UPDNAME(XUFIL,XUREC,XUFLD,XUCOMP,XUOLD) ;Update source name field
"RTN","XLFNAME2",5,0)
 ;Called from "ANAME" MUMPS xref on file #20.
"RTN","XLFNAME2",6,0)
 ;In:
"RTN","XLFNAME2",7,0)
 ;  XUOLD = original value of name; update only if different from new
"RTN","XLFNAME2",8,0)
 ;
"RTN","XLFNAME2",9,0)
 N XUIENS,XUFDA,XUMAX,XUMSG,XUNAME,DIERR
"RTN","XLFNAME2",10,0)
 I '$G(XUNOTRIG) N XUNOTRIG S XUNOTRIG=1
"RTN","XLFNAME2",11,0)
 ;
"RTN","XLFNAME2",12,0)
 ;Get IENS from XUREC
"RTN","XLFNAME2",13,0)
 I $G(XUREC)'["," S XUIENS=$$IENS^DILF(.XUREC)
"RTN","XLFNAME2",14,0)
 E  S XUIENS=XUREC S:XUIENS'?.E1"," XUIENS=XUIENS_","
"RTN","XLFNAME2",15,0)
 ;
"RTN","XLFNAME2",16,0)
 ;Get maximum length of source field
"RTN","XLFNAME2",17,0)
 S XUMAX=+$$GET1^DID(XUFIL,XUFLD,"","FIELD LENGTH","","XUMSG")
"RTN","XLFNAME2",18,0)
 K DIERR,XUMSG
"RTN","XLFNAME2",19,0)
 ;
"RTN","XLFNAME2",20,0)
 ;Get name from components
"RTN","XLFNAME2",21,0)
 S XUNAME=$$NAMEFMT^XLFNAME(.XUCOMP,"F","CSL"_XUMAX)
"RTN","XLFNAME2",22,0)
 I $G(XUOLD)]"",XUNAME=XUOLD Q
"RTN","XLFNAME2",23,0)
 ;
"RTN","XLFNAME2",24,0)
 ;Call Filer to edit entry in source file
"RTN","XLFNAME2",25,0)
 S XUFDA(XUFIL,XUIENS,XUFLD)=XUNAME
"RTN","XLFNAME2",26,0)
 D FILE^DIE("","XUFDA","XUMSG") K DIERR,XUMSG
"RTN","XLFNAME2",27,0)
 Q
"RTN","XLFNAME2",28,0)
 ;
"RTN","XLFNAME2",29,0)
UPDCOMP(XUFIL,XUREC,XUFLD,XUNAME,XUPTR,XUPVAL) ;Update Name Components entry
"RTN","XLFNAME2",30,0)
 ;Called from set logic of "ANAME" MUMPS xref of file #200,
"RTN","XLFNAME2",31,0)
 ;Called from UPDATE^XLFNAME3 to update components during conversion.
"RTN","XLFNAME2",32,0)
 N XUDEG,XUIEN,XUIENS,XUFDA,XUMSG,DIERR
"RTN","XLFNAME2",33,0)
 ;
"RTN","XLFNAME2",34,0)
 ;Get IENS from XUREC
"RTN","XLFNAME2",35,0)
 I $G(XUREC)'["," S XUIENS=$$IENS^DILF(.XUREC)
"RTN","XLFNAME2",36,0)
 E  S XUIENS=XUREC S:XUIENS'?.E1"," XUIENS=XUIENS_","
"RTN","XLFNAME2",37,0)
 ;
"RTN","XLFNAME2",38,0)
 ;Get name components from XUNAME
"RTN","XLFNAME2",39,0)
 D:$D(XUNAME)=1 NAMECOMP^XLFNAME(.XUNAME)
"RTN","XLFNAME2",40,0)
 ;
"RTN","XLFNAME2",41,0)
 ;Call updater to add or edit entry in Name Component file
"RTN","XLFNAME2",42,0)
 S XUFDA(20,"?+1,",.01)=XUFIL
"RTN","XLFNAME2",43,0)
 S XUFDA(20,"?+1,",.02)=XUFLD
"RTN","XLFNAME2",44,0)
 S XUFDA(20,"?+1,",.03)=XUIENS
"RTN","XLFNAME2",45,0)
 S:$D(XUNAME("FAMILY"))#2 XUFDA(20,"?+1,",1)=XUNAME("FAMILY")
"RTN","XLFNAME2",46,0)
 S:$D(XUNAME("GIVEN"))#2 XUFDA(20,"?+1,",2)=XUNAME("GIVEN")
"RTN","XLFNAME2",47,0)
 S:$D(XUNAME("MIDDLE"))#2 XUFDA(20,"?+1,",3)=XUNAME("MIDDLE")
"RTN","XLFNAME2",48,0)
 S:$D(XUNAME("PREFIX"))#2 XUFDA(20,"?+1,",4)=XUNAME("PREFIX")
"RTN","XLFNAME2",49,0)
 S:$D(XUNAME("SUFFIX"))#2 XUFDA(20,"?+1,",5)=XUNAME("SUFFIX")
"RTN","XLFNAME2",50,0)
 S:$D(XUNAME("DEGREE"))#2 XUFDA(20,"?+1,",6)=XUNAME("DEGREE")
"RTN","XLFNAME2",51,0)
 S:$D(XUNAME("NOTES"))#2 XUFDA(20,"?+1,",11)=XUNAME("NOTES")
"RTN","XLFNAME2",52,0)
 D UPDATE^DIE("K","XUFDA","XUIEN","XUMSG") K DIERR,XUMSG
"RTN","XLFNAME2",53,0)
 ;
"RTN","XLFNAME2",54,0)
 ;Update pointer
"RTN","XLFNAME2",55,0)
 I $G(XUPTR),$G(XUIEN(1)),$G(XUIEN(1))'=$G(XUPVAL) D
"RTN","XLFNAME2",56,0)
 . S XUPVAL=XUIEN(1)
"RTN","XLFNAME2",57,0)
 . S XUFDA(XUFIL,XUIENS,XUPTR)=XUPVAL
"RTN","XLFNAME2",58,0)
 . D FILE^DIE("","XUFDA","XUMSG") K DIERR,XUMSG
"RTN","XLFNAME2",59,0)
 Q
"RTN","XLFNAME2",60,0)
 ;
"RTN","XLFNAME2",61,0)
DELCOMP(XUFIL,XUREC,XUFLD,XUPTR) ;Delete Name Components entry
"RTN","XLFNAME2",62,0)
 ;Called from kill logic "ANAME" MUMPS xref of file #200
"RTN","XLFNAME2",63,0)
 N DA,DIK,XUFDA,XUIENS,XUMSG,XUVAL,DIERR
"RTN","XLFNAME2",64,0)
 ;
"RTN","XLFNAME2",65,0)
 ;Get IENS from XUREC
"RTN","XLFNAME2",66,0)
 I $G(XUREC)'["," S XUIENS=$$IENS^DILF(.XUREC)
"RTN","XLFNAME2",67,0)
 E  S XUIENS=XUREC S:XUIENS'?.E1"," XUIENS=XUIENS_","
"RTN","XLFNAME2",68,0)
 ;
"RTN","XLFNAME2",69,0)
 ;Lookup entry in Name Components file
"RTN","XLFNAME2",70,0)
 S XUVAL(1)=XUFIL,XUVAL(2)=XUFLD,XUVAL(3)=XUIENS
"RTN","XLFNAME2",71,0)
 S DA=$$FIND1^DIC(20,"","",.XUVAL,"BB","","XUMSG")
"RTN","XLFNAME2",72,0)
 Q:$G(DIERR)
"RTN","XLFNAME2",73,0)
 ;
"RTN","XLFNAME2",74,0)
 ;Delete entry from Name Components file
"RTN","XLFNAME2",75,0)
 S DIK="^VA(20,"
"RTN","XLFNAME2",76,0)
 D ^DIK
"RTN","XLFNAME2",77,0)
 ;
"RTN","XLFNAME2",78,0)
 ;Delete pointer value
"RTN","XLFNAME2",79,0)
 I $G(XUPTR) D
"RTN","XLFNAME2",80,0)
 . K XUFDA S XUFDA(XUFIL,XUIENS,XUPTR)=""
"RTN","XLFNAME2",81,0)
 . D FILE^DIE("","XUFDA","XUMSG") K XUMSG,DIERR
"RTN","XLFNAME2",82,0)
 Q
"RTN","XLFNAME2",83,0)
 ;
"RTN","XLFNAME2",84,0)
CHKPTR ;Make sure entry contains a valid pointer to Name Components file.
"RTN","XLFNAME2",85,0)
 ;Called from the pre-action on the XUEXISTING USER form.
"RTN","XLFNAME2",86,0)
 N AIEN,DEG,FDA,NAM,PTR,DIERR
"RTN","XLFNAME2",87,0)
 ;
"RTN","XLFNAME2",88,0)
 ;Get current pointer value
"RTN","XLFNAME2",89,0)
 S PTR=+$P($G(^VA(200,DA,3.1)),U)
"RTN","XLFNAME2",90,0)
 ;
"RTN","XLFNAME2",91,0)
 ;If not valid, get standard name, and update the Name Components file
"RTN","XLFNAME2",92,0)
 I 'PTR!($D(^VA(20,PTR,0))[0) D
"RTN","XLFNAME2",93,0)
 . K PTR
"RTN","XLFNAME2",94,0)
 . S NAM=$P($G(^VA(200,DA,0)),U)
"RTN","XLFNAME2",95,0)
 . S DEG=$P($G(^VA(200,DA,3.1)),U,6)
"RTN","XLFNAME2",96,0)
 . D STDNAME^XLFNAME(.NAM,"C")
"RTN","XLFNAME2",97,0)
 . D UPDCOMP(200,DA_",",.01,.NAM,10.1)
"RTN","XLFNAME2",98,0)
 Q
"RTN","XLFNAME3")
0^4^B28716276
"RTN","XLFNAME3",1,0)
XLFNAME3 ;CIOFO-SF/MKO-CONVERSION OF NEW PERSON FILE ENTRIES ;10:39 AM  10 Mar 2000
"RTN","XLFNAME3",2,0)
 ;;8.0;KERNEL;**134**;Jul 10, 1995
"RTN","XLFNAME3",3,0)
 ;
"RTN","XLFNAME3",4,0)
NEWPERS(XUFLAG,XUIEN) ;Convert New Person file names
"RTN","XLFNAME3",5,0)
 ;In: XUFLAG [ "C"  : Update Name Components file (#20) and pointer
"RTN","XLFNAME3",6,0)
 ;           [ "K"  : Kill ^XTMP("XLFNAME") up front
"RTN","XLFNAME3",7,0)
 ;           [ "P"  : Update New Person Names
"RTN","XLFNAME3",8,0)
 ;           [ "R"  : Record changes/problems in ^XTMP
"RTN","XLFNAME3",9,0)
 ;    XUIEN  = ien of last record converted;
"RTN","XLFNAME3",10,0)
 ;             conversion will begin with the next record
"RTN","XLFNAME3",11,0)
 ;
"RTN","XLFNAME3",12,0)
 N XUCNT,XUDEG,XUF,XUIENL,XUIENS,XUMSG,XUNAM,XUNMSP,XUNODEGT,XUNOTRIG
"RTN","XLFNAME3",13,0)
 N XUNOSIGT,XUPVAL,XUSTOP,XPDIDTOT,I
"RTN","XLFNAME3",14,0)
 S XUFLAG=$G(XUFLAG)_"M35"
"RTN","XLFNAME3",15,0)
 S (XUNOTRIG,XUNOSIGT,XUNODEGT)=1
"RTN","XLFNAME3",16,0)
 S XUNMSP="XLFNAME",XUCNT=0
"RTN","XLFNAME3",17,0)
 ;
"RTN","XLFNAME3",18,0)
 K:XUFLAG["K" ^XTMP("XLFNAME")
"RTN","XLFNAME3",19,0)
 S:XUFLAG["R" $P(^XTMP(XUNMSP,0),U,1,2)=$$FMADD^XLFDT(DT,90)_"^"_DT
"RTN","XLFNAME3",20,0)
 ;
"RTN","XLFNAME3",21,0)
 ;Loop through New Person file
"RTN","XLFNAME3",22,0)
 I '$D(ZTQUEUED),'$D(XPDNM) D
"RTN","XLFNAME3",23,0)
 . W !!," NOTE: To cancel this process, type '^' at any time."
"RTN","XLFNAME3",24,0)
 . W !," Please wait..."
"RTN","XLFNAME3",25,0)
 ;
"RTN","XLFNAME3",26,0)
 S XUIEN=+$G(XUIEN)
"RTN","XLFNAME3",27,0)
 ;
"RTN","XLFNAME3",28,0)
 ;Get XPDIDTOT = total number of entries to convert
"RTN","XLFNAME3",29,0)
 I XUFLAG["P" D
"RTN","XLFNAME3",30,0)
 . I 'XUIEN S XPDIDTOT=$P($G(^VA(200,0)),U,4) Q:XPDIDTOT>0
"RTN","XLFNAME3",31,0)
 . S XUMSG="   Obtaining number of entries to convert. Please wait..."
"RTN","XLFNAME3",32,0)
 . I '$D(XPDNM) W !,XUMSG
"RTN","XLFNAME3",33,0)
 . E  D MES^XPDUTL(XUMSG)
"RTN","XLFNAME3",34,0)
 . K XUMSG
"RTN","XLFNAME3",35,0)
 . S I=XUIEN,XPDIDTOT=0
"RTN","XLFNAME3",36,0)
 . F  S I=$O(^VA(200,I)) Q:'I  S:$P($G(^(I,0)),U)]"" XPDIDTOT=XPDIDTOT+1
"RTN","XLFNAME3",37,0)
 . S:'XUIEN $P(^VA(200,0),U,4)=XPDIDTOT
"RTN","XLFNAME3",38,0)
 ;
"RTN","XLFNAME3",39,0)
 S XUMSG="   Converting New Person Names..."
"RTN","XLFNAME3",40,0)
 I '$D(XPDNM) W !,XUMSG
"RTN","XLFNAME3",41,0)
 E  D MES^XPDUTL(XUMSG)
"RTN","XLFNAME3",42,0)
 K XUMSG
"RTN","XLFNAME3",43,0)
 ;
"RTN","XLFNAME3",44,0)
 S XUSTOP=0
"RTN","XLFNAME3",45,0)
 F  S XUIEN=$O(^VA(200,XUIEN)) Q:'XUIEN  D  D STPCHK Q:XUSTOP
"RTN","XLFNAME3",46,0)
 . S XUNAM=$P($G(^VA(200,XUIEN,0)),U)
"RTN","XLFNAME3",47,0)
 . I XUNAM=""!$D(^VA(200,XUIEN,-9))!(XUNAM?1"MERGING INTO".E) Q
"RTN","XLFNAME3",48,0)
 . S XUIENS=XUIEN_","
"RTN","XLFNAME3",49,0)
 . ;
"RTN","XLFNAME3",50,0)
 . S XUPVAL=$P($G(^VA(200,XUIEN,3.1)),U)
"RTN","XLFNAME3",51,0)
 . S XUDEG=$P($G(^VA(200,XUIEN,3.1)),U,6)
"RTN","XLFNAME3",52,0)
 . ;
"RTN","XLFNAME3",53,0)
 . ;Process .01 field of file 200
"RTN","XLFNAME3",54,0)
 . S XUF=$S(XUNAM="POSTMASTER"&(XUIEN=.5):$TR(XUFLAG,"R"),1:XUFLAG)
"RTN","XLFNAME3",55,0)
 . D UPDATE(XUF,200,XUIENS,.01,XUNAM,10.1,XUPVAL,XUNMSP,XUDEG) K XUF
"RTN","XLFNAME3",56,0)
 . ;
"RTN","XLFNAME3",57,0)
 . ;Remember this ien if entries are being converted
"RTN","XLFNAME3",58,0)
 . I XUFLAG["P",XUFLAG["R" S $P(^XTMP(XUNMSP,0),U,4)=XUIEN
"RTN","XLFNAME3",59,0)
 ;
"RTN","XLFNAME3",60,0)
 S XUMSG(1)=$S(XUSTOP:"   Process cancelled.",1:"   DONE!")
"RTN","XLFNAME3",61,0)
 S XUMSG(2)="   Number of records processed: "_XUCNT
"RTN","XLFNAME3",62,0)
 S:XUCNT XUMSG(3)="   Entry number last processed: "_$G(XUIENL)
"RTN","XLFNAME3",63,0)
 I '$D(XPDNM) W ! F I=1:1:3 W:$D(XUMSG(I))#2 !,XUMSG(I)
"RTN","XLFNAME3",64,0)
 E  D MES^XPDUTL(.XUMSG)
"RTN","XLFNAME3",65,0)
 Q
"RTN","XLFNAME3",66,0)
 ;
"RTN","XLFNAME3",67,0)
STPCHK ;Every 200 records, check whether to stop
"RTN","XLFNAME3",68,0)
 S XUCNT=XUCNT+1,XUIENL=XUIEN
"RTN","XLFNAME3",69,0)
 D:'(XUCNT#200)
"RTN","XLFNAME3",70,0)
 . I $D(ZTQUEUED),$$S^%ZTLOAD S (ZTSTOP,XUSTOP)=1 Q
"RTN","XLFNAME3",71,0)
 . I '$D(ZTQUEUED),'$D(XPDNM) W "." I $$STOP S XUSTOP=1 Q
"RTN","XLFNAME3",72,0)
 . I '$D(ZTQUEUED),$D(XPDNM) D UPDATE^XPDID(XUCNT)
"RTN","XLFNAME3",73,0)
 Q
"RTN","XLFNAME3",74,0)
 ;
"RTN","XLFNAME3",75,0)
UPDATE(XUFLAG,XUFIL,XUIENS,XUFLD,XUNAM,XUPTR,XUPVAL,XUNMSP,XUDEG) ;Process name field
"RTN","XLFNAME3",76,0)
 N XUAUD,XUDA,XUFDA,XUMAX,XUMSG,XUORIG,DIERR
"RTN","XLFNAME3",77,0)
 S XUFLAG=$G(XUFLAG)
"RTN","XLFNAME3",78,0)
 I '$G(XUNOTRIG) N XUNOTRIG S XUNOTRIG=1
"RTN","XLFNAME3",79,0)
 ;
"RTN","XLFNAME3",80,0)
 ;Get maximum length of standard name
"RTN","XLFNAME3",81,0)
 S XUMAX=+$P(XUFLAG,"M",2,999)
"RTN","XLFNAME3",82,0)
 ;
"RTN","XLFNAME3",83,0)
 ;Standardize/parse name; Record uncertainties in ^XTMP
"RTN","XLFNAME3",84,0)
 D STDNAME^XLFNAME(.XUNAM,"CP",.XUAUD)
"RTN","XLFNAME3",85,0)
 I XUMAX,$L(XUNAM)>XUMAX D
"RTN","XLFNAME3",86,0)
 . S XUNAM=$$NAMEFMT^XLFNAME(.XUNC,"F","CSL"_+$G(XUMAX))
"RTN","XLFNAME3",87,0)
 . S XUAUD("TRUNC")=""
"RTN","XLFNAME3",88,0)
 S:$D(XUAUD("STRIP")) XUNAM("NOTES")=XUAUD
"RTN","XLFNAME3",89,0)
 S:XUNAM'=XUAUD XUAUD("DIFFERENT")=""
"RTN","XLFNAME3",90,0)
 I $D(XUAUD)>9,XUFLAG["R" D RECORD(XUFIL,XUFLD,XUIENS,.XUNAM,.XUAUD,XUNMSP)
"RTN","XLFNAME3",91,0)
 ;
"RTN","XLFNAME3",92,0)
 ;Update file #20 and pointer to file #20
"RTN","XLFNAME3",93,0)
 I XUFLAG["C" D
"RTN","XLFNAME3",94,0)
 . S:$D(XUDEG)#2 XUNAM("DEGREE")=XUDEG
"RTN","XLFNAME3",95,0)
 . D UPDCOMP^XLFNAME2(XUFIL,XUIENS,XUFLD,.XUNAM,XUPTR,.XUPVAL)
"RTN","XLFNAME3",96,0)
 ;
"RTN","XLFNAME3",97,0)
 ;Update source name if different
"RTN","XLFNAME3",98,0)
 I XUFLAG["P",XUNAM'=XUAUD D
"RTN","XLFNAME3",99,0)
 . S XUFDA(XUFIL,XUIENS,XUFLD)=XUNAM
"RTN","XLFNAME3",100,0)
 . D FILE^DIE("","XUFDA","XUMSG") K DIERR,XUMSG
"RTN","XLFNAME3",101,0)
 Q
"RTN","XLFNAME3",102,0)
 ;
"RTN","XLFNAME3",103,0)
RECORD(XUFIL,XUFLD,XUREC,XUNAM,XUAUD,XUNMSP) ;Record problems in ^XTMP
"RTN","XLFNAME3",104,0)
 N XUIENS,XUINV
"RTN","XLFNAME3",105,0)
 Q:$G(XUNMSP)=""
"RTN","XLFNAME3",106,0)
 ;
"RTN","XLFNAME3",107,0)
 ;Get IENS from XUREC
"RTN","XLFNAME3",108,0)
 I $G(XUREC)'["," S XUIENS=$$IENS^DILF(.XUREC)
"RTN","XLFNAME3",109,0)
 E  S XUIENS=XUREC S:XUIENS'?.E1"," XUIENS=XUIENS_","
"RTN","XLFNAME3",110,0)
 S XUINV=$$INV(XUIENS)
"RTN","XLFNAME3",111,0)
 ;
"RTN","XLFNAME3",112,0)
 ;Record values
"RTN","XLFNAME3",113,0)
 K ^XTMP(XUNMSP,XUFIL,XUFLD,XUINV)
"RTN","XLFNAME3",114,0)
 M ^XTMP(XUNMSP,XUFIL,XUFLD,XUINV)=XUAUD
"RTN","XLFNAME3",115,0)
 S $P(^XTMP(XUNMSP,XUFIL,XUFLD,XUINV),U,2,6)=XUNAM_U_$G(XUNAM("GIVEN"))_U_$G(XUNAM("MIDDLE"))_U_$G(XUNAM("FAMILY"))_U_$G(XUNAM("SUFFIX"))
"RTN","XLFNAME3",116,0)
 Q
"RTN","XLFNAME3",117,0)
 ;
"RTN","XLFNAME3",118,0)
STOP() ;Check whether to stop
"RTN","XLFNAME3",119,0)
 N DIR,DIROUT,DIRUT,DTOUT,DUOUT,X,Y
"RTN","XLFNAME3",120,0)
 R Y#1:0 Q:Y="" 0
"RTN","XLFNAME3",121,0)
 F  R *X:0 E  Q
"RTN","XLFNAME3",122,0)
 Q:Y'=U 0
"RTN","XLFNAME3",123,0)
 S DIR(0)="Y",DIR("A")="Are you sure you want to stop",DIR("B")="NO"
"RTN","XLFNAME3",124,0)
 S:XUFLAG["P" DIR("?")="If you stop a conversion, you can continue later where you left off."
"RTN","XLFNAME3",125,0)
 W ! D ^DIR
"RTN","XLFNAME3",126,0)
 Q Y=1
"RTN","XLFNAME3",127,0)
 ;
"RTN","XLFNAME3",128,0)
INV(IENS) ;Invert the IENS
"RTN","XLFNAME3",129,0)
 N I,X
"RTN","XLFNAME3",130,0)
 Q:IENS?."," ""
"RTN","XLFNAME3",131,0)
 S:IENS'?.E1"," IENS=IENS_","
"RTN","XLFNAME3",132,0)
 S X="" F I=$L(IENS,",")-1:-1:1 S X=X_$P(IENS,",",I)_":"
"RTN","XLFNAME3",133,0)
 S:X?.E1":" X=$E(X,1,$L(X)-1)
"RTN","XLFNAME3",134,0)
 Q X
"RTN","XLFNAME3",135,0)
 ;
"RTN","XLFNAME3",136,0)
PRE ;The Pre-Install entry point
"RTN","XLFNAME3",137,0)
 N XUMSG,DIERR
"RTN","XLFNAME3",138,0)
 ;
"RTN","XLFNAME3",139,0)
 ;Delete the "AF"-xref on 200,.01
"RTN","XLFNAME3",140,0)
 I $P($G(^DD(200,.01,1,3,0)),U,2)="AF" D
"RTN","XLFNAME3",141,0)
 . D DELIX^DDMOD(200,.01,3,"","","XUMSG")
"RTN","XLFNAME3",142,0)
 . I '$G(DIERR),$D(XPDNM) D BMES^XPDUTL("The 'AF' cross-reference on file #200, field #.01 was deleted.")
"RTN","XLFNAME3",143,0)
 ;
"RTN","XLFNAME3",144,0)
 ;Delete the traditional "B" index on 200,.01
"RTN","XLFNAME3",145,0)
 I $P($G(^DD(200,.01,1,1,0)),U,2)="B" D
"RTN","XLFNAME3",146,0)
 . D DELIX^DDMOD(200,.01,1,"","","XUMSG")
"RTN","XLFNAME3",147,0)
 Q
"RTN","XLFNAME3",148,0)
 ;
"RTN","XLFNAME3",149,0)
POST ;The Post-Install entry point (run conversion)
"RTN","XLFNAME3",150,0)
 N XUIEN,XUNMSP
"RTN","XLFNAME3",151,0)
 S XUNMSP="XLFNAME"
"RTN","XLFNAME3",152,0)
 S XUIEN=+$P($G(^XTMP(XUNMSP,0)),U,4)
"RTN","XLFNAME3",153,0)
 D NEWPERS("CPR"_$E("K",'XUIEN),+XUIEN)
"RTN","XLFNAME3",154,0)
 I $D(^XTMP(XUNMSP,0))#2,XUIEN'=+$P(^(0),U,4) S $P(^(0),U,3)="Created by POST~XLFNAME (Post Install Conversion of XU*8.0*134)"
"RTN","XLFNAME3",155,0)
 Q
"RTN","XLFNAME4")
0^5^B78659946
"RTN","XLFNAME4",1,0)
XLFNAME4 ;CIOFO-SF/MKO-PRINT INFORMATION IN ^XTMP ;11:35 AM  23 Mar 2000
"RTN","XLFNAME4",2,0)
 ;;8.0;KERNEL;**134**;Jul 10, 1995
"RTN","XLFNAME4",3,0)
 ;
"RTN","XLFNAME4",4,0)
PRINT N XUCD,XUCDX,XUFD,XUFDTXT,XUFL,XUHLIN,XUPG,XUREC
"RTN","XLFNAME4",5,0)
 N DIROUT,DIRUT,DTOUT,DUOUT,POP,X,Y
"RTN","XLFNAME4",6,0)
 D INTRO
"RTN","XLFNAME4",7,0)
 ;
"RTN","XLFNAME4",8,0)
 ;Get file number
"RTN","XLFNAME4",9,0)
 ;S XUFL=$$READ("Select a file or subfile number","ALL","HLPFIL") Q:XUFL=""
"RTN","XLFNAME4",10,0)
 S XUFL=200
"RTN","XLFNAME4",11,0)
 ;
"RTN","XLFNAME4",12,0)
 ;Get field number
"RTN","XLFNAME4",13,0)
 ;I XUFL="ALL" S XUFD="ALL"
"RTN","XLFNAME4",14,0)
 ;E  S XUFD=$$READ("Select a field number","ALL","HLPFLD") Q:XUFD=""
"RTN","XLFNAME4",15,0)
 S XUFD=.01
"RTN","XLFNAME4",16,0)
 ;
"RTN","XLFNAME4",17,0)
 ;Get list of codes
"RTN","XLFNAME4",18,0)
 S XUCD=$$READ("Enter a list of codes to print","ALL","HLPCOD","Enter a list of codes separated by commas, 'ALL', or '??' for more help.")
"RTN","XLFNAME4",19,0)
 Q:U[XUCD
"RTN","XLFNAME4",20,0)
 S:XUCD="ALL" XUCD=""
"RTN","XLFNAME4",21,0)
 I XUCD]"" S XUCD=$$UP^XLFSTR($TR(XUCD," "))
"RTN","XLFNAME4",22,0)
 ;
"RTN","XLFNAME4",23,0)
 ;Get list of codes to exclude
"RTN","XLFNAME4",24,0)
 S XUCDX=$$READ("Enter a list of codes to exclude","","HLPCODX","Enter a list of codes separated by commas, or '??' for more help.")
"RTN","XLFNAME4",25,0)
 Q:XUCDX=U
"RTN","XLFNAME4",26,0)
 I XUCDX]"" S XUCDX=$$UP^XLFSTR($TR(XUCDX," "))
"RTN","XLFNAME4",27,0)
 ;
"RTN","XLFNAME4",28,0)
 ;Prompt for device
"RTN","XLFNAME4",29,0)
 S %ZIS="Q" W ! D ^%ZIS Q:$G(POP)
"RTN","XLFNAME4",30,0)
 I $D(IO("Q")),$D(^%ZTSK) D QUEUE G END
"RTN","XLFNAME4",31,0)
 U IO
"RTN","XLFNAME4",32,0)
 ;
"RTN","XLFNAME4",33,0)
MAIN ;TaskMan entry point
"RTN","XLFNAME4",34,0)
 D INIT,HDR,CODTAB
"RTN","XLFNAME4",35,0)
 ;
"RTN","XLFNAME4",36,0)
 I XUFL="ALL" D
"RTN","XLFNAME4",37,0)
 . S XUFL=0
"RTN","XLFNAME4",38,0)
 . F  S XUFL=$O(^XTMP("XLFNAME",XUFL)) Q:'XUFL  D PFIL(XUFL,XUCD,XUCDX) Q:$D(DIRUT)
"RTN","XLFNAME4",39,0)
 E  I XUFD="ALL" D
"RTN","XLFNAME4",40,0)
 . D PFIL(XUFL,XUCD,XUCDX)
"RTN","XLFNAME4",41,0)
 E  D PFLD(XUFL,XUFD,XUCD,XUCDX)
"RTN","XLFNAME4",42,0)
 ;
"RTN","XLFNAME4",43,0)
 D END
"RTN","XLFNAME4",44,0)
 Q
"RTN","XLFNAME4",45,0)
 ;
"RTN","XLFNAME4",46,0)
PFIL(XUFL,XUCD,XUCDX) ;Print information for a specific file
"RTN","XLFNAME4",47,0)
 S XUFD=0
"RTN","XLFNAME4",48,0)
 F  S XUFD=$O(^XTMP("XLFNAME",XUFL,XUFD)) Q:'XUFD  D PFLD(XUFL,XUFD,XUCD,XUCDX) Q:$D(DIRUT)
"RTN","XLFNAME4",49,0)
 Q
"RTN","XLFNAME4",50,0)
 ;
"RTN","XLFNAME4",51,0)
PFLD(XUFL,XUFD,XUCD,XUCDX) ;Print info for a specific field
"RTN","XLFNAME4",52,0)
 D HINFO(XUFL,XUFD),EOP Q:$D(DIRUT)  D HDR,SUBHDR
"RTN","XLFNAME4",53,0)
 S XUREC="" F  S XUREC=$O(^XTMP("XLFNAME",XUFL,XUFD,XUREC)) Q:XUREC=""  D PREC(XUFL,XUFD,XUREC,XUCD,XUCDX) Q:$D(DIRUT)
"RTN","XLFNAME4",54,0)
 Q
"RTN","XLFNAME4",55,0)
 ;
"RTN","XLFNAME4",56,0)
PREC(XUFL,XUFD,XUREC,XUCD,XUCDX) ;Print info for a specific record
"RTN","XLFNAME4",57,0)
 N C,I,XUOLD,XUNEW,XUCOD,XULN,XUMAT,XUMATX,XUNC
"RTN","XLFNAME4",58,0)
 ;
"RTN","XLFNAME4",59,0)
 ;Get old and new name, and Name Components ien
"RTN","XLFNAME4",60,0)
 S XULN=^XTMP("XLFNAME",XUFL,XUFD,XUREC)
"RTN","XLFNAME4",61,0)
 S XUOLD=$P(XULN,U),XUNEW=$P(XULN,U,2)
"RTN","XLFNAME4",62,0)
 ;
"RTN","XLFNAME4",63,0)
 ;Get note codes
"RTN","XLFNAME4",64,0)
 S XUCOD="" S XUMAT=$G(XUCD)="",(XUMATX,XUNC)=0
"RTN","XLFNAME4",65,0)
 S I=0 F  S I=$O(^XTMP("XLFNAME",XUFL,XUFD,XUREC,I)) Q:I=""  D  Q:XUMATX
"RTN","XLFNAME4",66,0)
 . I I="MIDDLE"!(I="SUFFIX") S XUNC=1
"RTN","XLFNAME4",67,0)
 . S C=$E(I,1,"NPS"[$E(I)+1)
"RTN","XLFNAME4",68,0)
 . I 'XUMAT,","_XUCD_","[(","_C_",") S XUMAT=1
"RTN","XLFNAME4",69,0)
 . I $G(XUCDX)]"",'XUMATX,","_XUCDX_","[(","_C_",") S XUMATX=1
"RTN","XLFNAME4",70,0)
 . S XUCOD=XUCOD_C_","
"RTN","XLFNAME4",71,0)
 Q:'XUMAT!XUMATX
"RTN","XLFNAME4",72,0)
 S:XUCOD?.E1"," XUCOD=$E(XUCOD,1,$L(XUCOD)-1)
"RTN","XLFNAME4",73,0)
 ;
"RTN","XLFNAME4",74,0)
 D W(XUREC) Q:$D(DIRUT)  W ?15,"Old: "_XUOLD,?60,XUCOD
"RTN","XLFNAME4",75,0)
 D W("New: "_XUNEW,15) Q:$D(DIRUT)
"RTN","XLFNAME4",76,0)
 I XUNC D
"RTN","XLFNAME4",77,0)
 . D W(" Given: "_$P(XULN,U,3),22)
"RTN","XLFNAME4",78,0)
 . D W("Middle: "_$P(XULN,U,4),22)
"RTN","XLFNAME4",79,0)
 . D W("Family: "_$P(XULN,U,5),22)
"RTN","XLFNAME4",80,0)
 . D W("Suffix: "_$P(XULN,U,6),22)
"RTN","XLFNAME4",81,0)
 D W() Q:$D(DIRUT)
"RTN","XLFNAME4",82,0)
 Q
"RTN","XLFNAME4",83,0)
 ;
"RTN","XLFNAME4",84,0)
W(XUSTR,XUCOL,XUFLG) ;Write line feed and string XUSTR in column XUCOL
"RTN","XLFNAME4",85,0)
 I $Y+3'<IOSL D EOP Q:$D(DIRUT)  D HDR D:'$G(XUFLG) SUBHDR
"RTN","XLFNAME4",86,0)
 W !?+$G(XUCOL),$G(XUSTR)
"RTN","XLFNAME4",87,0)
 Q
"RTN","XLFNAME4",88,0)
 ;
"RTN","XLFNAME4",89,0)
EOP ;EOP
"RTN","XLFNAME4",90,0)
 I $E(IOST,1,2)="C-",'$D(ZTQUEUED) D
"RTN","XLFNAME4",91,0)
 . N DIR,X,Y
"RTN","XLFNAME4",92,0)
 . S DIR(0)="E" W ! D ^DIR
"RTN","XLFNAME4",93,0)
 E  I $D(ZTQUEUED),$$S^%ZTLOAD S (ZTSTOP,DIRUT)=1
"RTN","XLFNAME4",94,0)
 W @IOF
"RTN","XLFNAME4",95,0)
 Q
"RTN","XLFNAME4",96,0)
 ;
"RTN","XLFNAME4",97,0)
HDR ;Print header
"RTN","XLFNAME4",98,0)
 S XUPG=$G(XUPG)+1,$X=0
"RTN","XLFNAME4",99,0)
 W "^XTMP(""XLFNAME"") LISTING",?(IOM-$L(XUHLIN)-$L(XUPG)-1),XUHLIN_XUPG
"RTN","XLFNAME4",100,0)
 W !,$TR($J("",IOM-1)," ","-")
"RTN","XLFNAME4",101,0)
 Q
"RTN","XLFNAME4",102,0)
 ;
"RTN","XLFNAME4",103,0)
SUBHDR ;Print subheader
"RTN","XLFNAME4",104,0)
 W !,"File: #"_XUFL,", Field: "_XUFDTXT
"RTN","XLFNAME4",105,0)
 W:XUCD]"" !,"Entries that contain any of the following codes: ",XUCD
"RTN","XLFNAME4",106,0)
 W:XUCDX]"" !,"Excluding entries that contain any of the following codes: ",XUCDX
"RTN","XLFNAME4",107,0)
 W !!,"Record",?15,"Name",?60,"Codes"
"RTN","XLFNAME4",108,0)
 W !,"------",?15,$TR($J("",40)," ","-"),?60,"-----"
"RTN","XLFNAME4",109,0)
 Q
"RTN","XLFNAME4",110,0)
 ;
"RTN","XLFNAME4",111,0)
HINFO(XUFL,XUFD) ;Get XUFDTXT for subheader
"RTN","XLFNAME4",112,0)
 N XULAB
"RTN","XLFNAME4",113,0)
 D FIELD^DID(XUFL,XUFD,"","LABEL","XULAB")
"RTN","XLFNAME4",114,0)
 S XUFDTXT=XULAB("LABEL")_" (#"_XUFD_")"
"RTN","XLFNAME4",115,0)
 Q
"RTN","XLFNAME4",116,0)
 ;
"RTN","XLFNAME4",117,0)
READ(PROMPT,DEF,XHELP,HELP) ;Read X, default is ALL
"RTN","XLFNAME4",118,0)
 N DIR,X,Y,DTOUT,DUOUT,DIRUT,DIROUT
"RTN","XLFNAME4",119,0)
 S DIR(0)="FO^1:30"
"RTN","XLFNAME4",120,0)
 S:$G(PROMPT)]"" DIR("A")=PROMPT
"RTN","XLFNAME4",121,0)
 S DIR("?")=$S($G(HELP)]"":HELP,1:"Enter a number or the word 'ALL'. Enter '??' for more help.")
"RTN","XLFNAME4",122,0)
 S:$G(XHELP)]"" DIR("??")="^D "_XHELP_"^XLFNAME4"
"RTN","XLFNAME4",123,0)
 S:$G(DEF)]"" DIR("B")=DEF
"RTN","XLFNAME4",124,0)
 D ^DIR Q:$D(DUOUT)!$D(DTOUT) U
"RTN","XLFNAME4",125,0)
 Q Y
"RTN","XLFNAME4",126,0)
 ;
"RTN","XLFNAME4",127,0)
HLPFIL ;Execute help for file prompt
"RTN","XLFNAME4",128,0)
 N I
"RTN","XLFNAME4",129,0)
 W !,"Enter 'ALL' to select all files, or select one of the following:",!
"RTN","XLFNAME4",130,0)
 S I=0 F  S I=$O(^XTMP("XLFNAME",I)) Q:'I  W:$X>70 ! W I_"  "_$J("",10-$L(I))
"RTN","XLFNAME4",131,0)
 Q
"RTN","XLFNAME4",132,0)
 ;
"RTN","XLFNAME4",133,0)
HLPFLD ;Execute help for field prompt
"RTN","XLFNAME4",134,0)
 N I
"RTN","XLFNAME4",135,0)
 W !,"Enter 'ALL' to select all fields, or select one of the following:",!
"RTN","XLFNAME4",136,0)
 S I=0 F  S I=$O(^XTMP("XLFNAME",XUFL,I)) Q:'I  W:$X>70 ! W I_"  "_$J("",10-$L(I))
"RTN","XLFNAME4",137,0)
 Q
"RTN","XLFNAME4",138,0)
 ;
"RTN","XLFNAME4",139,0)
HLPCOD ;Executable help for codes prompt
"RTN","XLFNAME4",140,0)
 N I,T
"RTN","XLFNAME4",141,0)
 F I=1:1 S T=$P($T(CODTAB+I),";;",2,999) Q:T="$$END"  W !,T
"RTN","XLFNAME4",142,0)
 W !!,"To include entries with specific codes, enter those codes separated by commas,"
"RTN","XLFNAME4",143,0)
 W !,"or enter 'ALL' to select entries with any code,"
"RTN","XLFNAME4",144,0)
 Q
"RTN","XLFNAME4",145,0)
 ;
"RTN","XLFNAME4",146,0)
HLPCODX ;Executable help for codes prompt
"RTN","XLFNAME4",147,0)
 N I,T
"RTN","XLFNAME4",148,0)
 F I=1:1 S T=$P($T(CODTAB+I),";;",2,999) Q:T="$$END"  W !,T
"RTN","XLFNAME4",149,0)
 W !!,"To exclude entries with specific codes, enter those codes separated by commas,"
"RTN","XLFNAME4",150,0)
 W !,"or press <RET> to exclude no entries."
"RTN","XLFNAME4",151,0)
 W !!,"This list overrides the list of codes to include."
"RTN","XLFNAME4",152,0)
 Q
"RTN","XLFNAME4",153,0)
 ;
"RTN","XLFNAME4",154,0)
QUEUE ;Queue the report
"RTN","XLFNAME4",155,0)
 N I,ZTSK
"RTN","XLFNAME4",156,0)
 ;
"RTN","XLFNAME4",157,0)
 S ZTRTN="MAIN^XLFNAME4"
"RTN","XLFNAME4",158,0)
 S ZTDESC="Report of ^XTMP(""XLFNAME"")"
"RTN","XLFNAME4",159,0)
 F I="XUFL","XUFD","XUCD","XUCDX" S ZTSAVE(I)=""
"RTN","XLFNAME4",160,0)
 D ^%ZTLOAD
"RTN","XLFNAME4",161,0)
 ;
"RTN","XLFNAME4",162,0)
 I $D(ZTSK)#2 W !,"Report queued!",!,"Task number: "_$G(ZTSK),!
"RTN","XLFNAME4",163,0)
 E  W !,"Report canceled!",!
"RTN","XLFNAME4",164,0)
 ;
"RTN","XLFNAME4",165,0)
 D HOME^%ZIS
"RTN","XLFNAME4",166,0)
 Q
"RTN","XLFNAME4",167,0)
 ;
"RTN","XLFNAME4",168,0)
INIT ;Set XUHLIN to Date/time/page for header
"RTN","XLFNAME4",169,0)
 N %,%H,X,Y
"RTN","XLFNAME4",170,0)
 S %H=$H D YX^%DTC
"RTN","XLFNAME4",171,0)
 S XUHLIN=$P(Y,"@")_"  "_$P($P(Y,"@",2),":",1,2)_"    PAGE "
"RTN","XLFNAME4",172,0)
 W:$E(IOST,1,2)="C-" @IOF
"RTN","XLFNAME4",173,0)
 Q
"RTN","XLFNAME4",174,0)
 ;
"RTN","XLFNAME4",175,0)
END ;Finish up
"RTN","XLFNAME4",176,0)
 I $D(ZTQUEUED) S ZTREQ="@"
"RTN","XLFNAME4",177,0)
 E  D ^%ZISC
"RTN","XLFNAME4",178,0)
 Q
"RTN","XLFNAME4",179,0)
 ;
"RTN","XLFNAME4",180,0)
INTRO ;Introductory text
"RTN","XLFNAME4",181,0)
 ;;This entry point prints a report of the information stored in
"RTN","XLFNAME4",182,0)
 ;;^XTMP("XLFNAME").
"RTN","XLFNAME4",183,0)
 ;;
"RTN","XLFNAME4",184,0)
 ;;The New Person Name Standardization conversion is run automatically during
"RTN","XLFNAME4",185,0)
 ;;the installation of patch XU*8.0*134, as part of the POST-INSTALL ROUTINE
"RTN","XLFNAME4",186,0)
 ;;(POST^XLFNAME). The conversion records in ^XTMP("XLFNAME") information
"RTN","XLFNAME4",187,0)
 ;;about each Name that had to be changed to convert it to standard form, or
"RTN","XLFNAME4",188,0)
 ;;for which assumptions had to be made in breaking the Name into its
"RTN","XLFNAME4",189,0)
 ;;component parts for storage in the new NAME COMPONENTS file (#20).
"RTN","XLFNAME4",190,0)
 ;;
"RTN","XLFNAME4",191,0)
 ;;You can use this report to determine whether any names were standardized
"RTN","XLFNAME4",192,0)
 ;;or parsed incorrectly. To correct a name or its component parts, go to the
"RTN","XLFNAME4",193,0)
 ;;"Systems Manager Menu" [EVE], select "User Management" [XUSER], and then
"RTN","XLFNAME4",194,0)
 ;;"Edit an Existing User" [XUSEREDIT]. From there you can edit the NAME
"RTN","XLFNAME4",195,0)
 ;;field (#.01) of the NEW PERSON file (#200), as well as the component parts
"RTN","XLFNAME4",196,0)
 ;;of the Name as they are stored in the NAME COMPONENTS file (#20).
"RTN","XLFNAME4",197,0)
 ;;
"RTN","XLFNAME4",198,0)
 ;;$$END
"RTN","XLFNAME4",199,0)
 N I,T
"RTN","XLFNAME4",200,0)
 F I=1:1 S T=$P($T(INTRO+I),";;",2,999) Q:T="$$END"  W !,T
"RTN","XLFNAME4",201,0)
 Q
"RTN","XLFNAME4",202,0)
 ;
"RTN","XLFNAME4",203,0)
CODTAB ;Code Table
"RTN","XLFNAME4",204,0)
 ;;Explanation of Codes:
"RTN","XLFNAME4",205,0)
 ;;--------------------
"RTN","XLFNAME4",206,0)
 ;;  D  : The standard name is different from the original name.
"RTN","XLFNAME4",207,0)
 ;;  F  : The Family Name starts with ST<period>. The period and
"RTN","XLFNAME4",208,0)
 ;;         following space, if any, were removed.
"RTN","XLFNAME4",209,0)
 ;;  G  : There is no Given Name.
"RTN","XLFNAME4",210,0)
 ;;  M  : Assumption: There is more than one Given and only one Middle Name.
"RTN","XLFNAME4",211,0)
 ;;  NM : NMI or NMN was used as the Middle Name.
"RTN","XLFNAME4",212,0)
 ;;  NU : A name part contains a number.
"RTN","XLFNAME4",213,0)
 ;;  PE : Periods were removed.
"RTN","XLFNAME4",214,0)
 ;;  PU : Punctuation was removed.
"RTN","XLFNAME4",215,0)
 ;;  SP : Spaces were removed from the Family Name.
"RTN","XLFNAME4",216,0)
 ;;  ST : Text in parentheses was stripped from the name.
"RTN","XLFNAME4",217,0)
 ;;  SU : One or more of the following situations was encountered relating
"RTN","XLFNAME4",218,0)
 ;;       to suffixes:
"RTN","XLFNAME4",219,0)
 ;;       - Suffixes were found immediate to left of the first comma.
"RTN","XLFNAME4",220,0)
 ;;       - I, V, or X was interpreted as a Middle Name.
"RTN","XLFNAME4",221,0)
 ;;       - A name part was interpreted as a Suffix, not a Middle Name.
"RTN","XLFNAME4",222,0)
 ;;       - M.D. or M D was NOT interpreted as a Suffix.
"RTN","XLFNAME4",223,0)
 ;;       - A name part with no vowels was interpreted as a Suffix.
"RTN","XLFNAME4",224,0)
 ;;       - A Suffix was found between commas immediately after the Family Name.
"RTN","XLFNAME4",225,0)
 ;;  T  : The standard name was truncated.
"RTN","XLFNAME4",226,0)
 ;;$$END
"RTN","XLFNAME4",227,0)
 N I,T
"RTN","XLFNAME4",228,0)
 F I=1:1 S T=$P($T(CODTAB+I),";;",2,999) Q:T="$$END"  D W(T,0,1)
"RTN","XLFNAME4",229,0)
 Q
"RTN","XLFNAME5")
0^6^B36091048
"RTN","XLFNAME5",1,0)
XLFNAME5 ;SFISC/MKO-INTERACTIVE OPTION TO CONVERT NAMES ;11:32 AM  28 Jan 2000
"RTN","XLFNAME5",2,0)
 ;;8.0;KERNEL;**134**;Jul 10, 1995
"RTN","XLFNAME5",3,0)
CONVERT ;Convert Names
"RTN","XLFNAME5",4,0)
 N DIR,DIROUT,DIRUT,DTOUT,DUOUT,XUIEN,XUNMSP,X,Y
"RTN","XLFNAME5",5,0)
 S XUNMSP="XLFNAME"
"RTN","XLFNAME5",6,0)
 ;
"RTN","XLFNAME5",7,0)
 D CINTRO
"RTN","XLFNAME5",8,0)
 S DIR(0)="YO",DIR("A")="Do you wish to continue"
"RTN","XLFNAME5",9,0)
 S DIR("?",1)="  Enter 'Y' to convert the Names in the New Person file"
"RTN","XLFNAME5",10,0)
 S DIR("?",2)="  to standard form, and to store the component parts of"
"RTN","XLFNAME5",11,0)
 S DIR("?")="  the Names in the new Name Components file."
"RTN","XLFNAME5",12,0)
 W ! D ^DIR K DIR Q:$D(DIRUT)!'Y
"RTN","XLFNAME5",13,0)
 ;
"RTN","XLFNAME5",14,0)
 ;Check if the conversion was already run.
"RTN","XLFNAME5",15,0)
 ;Determine which record to start with.
"RTN","XLFNAME5",16,0)
 S XUIEN=+$P($G(^XTMP(XUNMSP,0)),U,4)
"RTN","XLFNAME5",17,0)
 I XUIEN D  Q:$D(DIRUT)
"RTN","XLFNAME5",18,0)
 . I $O(^VA(200,XUIEN)) D
"RTN","XLFNAME5",19,0)
 .. W !!,"It appears that the conversion has already been performed through"
"RTN","XLFNAME5",20,0)
 .. W !,"record #"_XUIEN_" in the New Person file."
"RTN","XLFNAME5",21,0)
 .. W !!,"Do you want to continue the conversion from after this point"
"RTN","XLFNAME5",22,0)
 .. W !,"or convert the entries from the beginning of the file."
"RTN","XLFNAME5",23,0)
 .. S DIR(0)="S^C:Continue the conversion after record #"_XUIEN_";S:Start again from the beginning of the file"
"RTN","XLFNAME5",24,0)
 .. S DIR("?",1)="  Enter 'C' to start the conversion and parsing process from the"
"RTN","XLFNAME5",25,0)
 .. S DIR("?",2)="  after record #"_XUIEN_" in the New Person file."
"RTN","XLFNAME5",26,0)
 .. S DIR("?",3)=" "
"RTN","XLFNAME5",27,0)
 .. S DIR("?",4)="  Enter 'B' to start the conversion and parsing process from the"
"RTN","XLFNAME5",28,0)
 .. S DIR("?",5)="  the beginning of the New Person file."
"RTN","XLFNAME5",29,0)
 .. S DIR("?",6)=" "
"RTN","XLFNAME5",30,0)
 .. S DIR("?",7)="  NOTE: There is no harm in running the conversion again from the"
"RTN","XLFNAME5",31,0)
 .. S DIR("?",8)="  beginning. However, if the conversion routine previously parsed a name"
"RTN","XLFNAME5",32,0)
 .. S DIR("?",9)="  into its component parts incorrectly, and you corrected those problems"
"RTN","XLFNAME5",33,0)
 .. S DIR("?",10)="  by manually editing the name components, your corrections will be lost"
"RTN","XLFNAME5",34,0)
 .. S DIR("?")="  if you run the conversion again."
"RTN","XLFNAME5",35,0)
 .. D ^DIR K DIR Q:$D(DIRUT)
"RTN","XLFNAME5",36,0)
 .. S:Y="S" XUIEN=0
"RTN","XLFNAME5",37,0)
 . E  D
"RTN","XLFNAME5",38,0)
 .. W !!,"It appears that the conversion has already been performed on all entries"
"RTN","XLFNAME5",39,0)
 .. W !,"in the New person file.",!
"RTN","XLFNAME5",40,0)
 .. S DIR(0)="YO",DIR("A")="Do you want to run the conversion again"
"RTN","XLFNAME5",41,0)
 .. S DIR("?",1)="  Enter 'Y' if you wish to run the New Person Name conversion again."
"RTN","XLFNAME5",42,0)
 .. S DIR("?",2)=" "
"RTN","XLFNAME5",43,0)
 .. S DIR("?",3)="  NOTE: There is no harm in running the conversion again. However, if the"
"RTN","XLFNAME5",44,0)
 .. S DIR("?",4)="  conversion routine previously parsed a name into its component parts"
"RTN","XLFNAME5",45,0)
 .. S DIR("?",5)="  incorrectly, and you corrected those problems by manually editing the"
"RTN","XLFNAME5",46,0)
 .. S DIR("?",6)="  name components, your corrections will be lost if you run the conversion"
"RTN","XLFNAME5",47,0)
 .. S DIR("?")="  again."
"RTN","XLFNAME5",48,0)
 .. D ^DIR K DIR S:'Y DIRUT=1 Q:$D(DIRUT)
"RTN","XLFNAME5",49,0)
 .. S XUIEN=0
"RTN","XLFNAME5",50,0)
 ;
"RTN","XLFNAME5",51,0)
 D NEWPERS^XLFNAME3("CPR"_$E("K",'XUIEN),+XUIEN)
"RTN","XLFNAME5",52,0)
 S:$D(^XTMP(XUNMSP,0))#2 $P(^(0),U,3)="Created by CONVERT~XLFNAME"
"RTN","XLFNAME5",53,0)
 Q
"RTN","XLFNAME5",54,0)
 ;
"RTN","XLFNAME5",55,0)
CINTRO ;Print introductory comments
"RTN","XLFNAME5",56,0)
 ;;This routine will run the New Person Name Standardization conversion. It
"RTN","XLFNAME5",57,0)
 ;;will loop through the entries in the New Person file and:
"RTN","XLFNAME5",58,0)
 ;;
"RTN","XLFNAME5",59,0)
 ;;  1. Convert the Names (field #.01) in the New Person file to standard
"RTN","XLFNAME5",60,0)
 ;;     form.
"RTN","XLFNAME5",61,0)
 ;;
"RTN","XLFNAME5",62,0)
 ;;  2. Parse each Name into its component parts and store those parts
"RTN","XLFNAME5",63,0)
 ;;     in the new Name Components file (#20).
"RTN","XLFNAME5",64,0)
 ;;
"RTN","XLFNAME5",65,0)
 ;;  3. Establish a pointer from each New Person entry to the
"RTN","XLFNAME5",66,0)
 ;;     corresponding entry in the Name Components that contains the
"RTN","XLFNAME5",67,0)
 ;;     Name parts.
"RTN","XLFNAME5",68,0)
 ;;
"RTN","XLFNAME5",69,0)
 ;;  4. Record in ^XTMP all changes that were made, and any problems
"RTN","XLFNAME5",70,0)
 ;;     or questionable assumptions that are encountered in
"RTN","XLFNAME5",71,0)
 ;;     standardizing the name or parsing it into its component parts.
"RTN","XLFNAME5",72,0)
 ;;$$END
"RTN","XLFNAME5",73,0)
 N I,T F I=1:1 S T=$P($T(CINTRO+I),";;",2,999) Q:T="$$END"  W !,T
"RTN","XLFNAME5",74,0)
 Q
"RTN","XLFNAME5",75,0)
 ;
"RTN","XLFNAME5",76,0)
GENERATE ;Generate ^XTMP
"RTN","XLFNAME5",77,0)
 N DIR,DIROUT,DIRUT,DTOUT,DUOUT,XUIEN,XUNMSP,X,Y
"RTN","XLFNAME5",78,0)
 S XUNMSP="XLFNAME"
"RTN","XLFNAME5",79,0)
 ;
"RTN","XLFNAME5",80,0)
 D GINTRO
"RTN","XLFNAME5",81,0)
 S DIR(0)="YO",DIR("A")="Do you wish to continue"
"RTN","XLFNAME5",82,0)
 S DIR("?",1)="  Enter 'Y' to store information in ^XTMP about changes that"
"RTN","XLFNAME5",83,0)
 S DIR("?")="  will take place when the CONVERT^XLFNAME entry point is run."
"RTN","XLFNAME5",84,0)
 W ! D ^DIR K DIR Q:$D(DIRUT)!'Y
"RTN","XLFNAME5",85,0)
 ;
"RTN","XLFNAME5",86,0)
 ;Check if the conversion was already run.
"RTN","XLFNAME5",87,0)
 ;Determine which record to start with.
"RTN","XLFNAME5",88,0)
 I $P($G(^XTMP(XUNMSP,0)),U,4) D  Q:$D(DIRUT)
"RTN","XLFNAME5",89,0)
 . W !!,"It appears that the conversion of New Person Names (routine CONVERT^XLFNAME)"
"RTN","XLFNAME5",90,0)
 . W !,"has already been run. If you continue, the information already stored in"
"RTN","XLFNAME5",91,0)
 . W !,"^XTMP about records that have been converted will be lost.",!
"RTN","XLFNAME5",92,0)
 . S DIR(0)="YO",DIR("A")="Are you sure you wish to continue"
"RTN","XLFNAME5",93,0)
 . S DIR("?")="  Enter 'Y' if you wish to replace the information already in ^XTMP."
"RTN","XLFNAME5",94,0)
 . D ^DIR K DIR S:'Y DIRUT=1
"RTN","XLFNAME5",95,0)
 ;
"RTN","XLFNAME5",96,0)
 D NEWPERS^XLFNAME3("KR")
"RTN","XLFNAME5",97,0)
 S:$D(^XTMP(XUNMSP,0))#2 $P(^(0),U,3)="Created by GENERATE~XLFNAME"
"RTN","XLFNAME5",98,0)
 Q
"RTN","XLFNAME5",99,0)
 ;
"RTN","XLFNAME5",100,0)
GINTRO ;Print introductory comments
"RTN","XLFNAME5",101,0)
 ;;This entry point loops through the records in the New Person file and
"RTN","XLFNAME5",102,0)
 ;;determines the standard form of each Name. It also tries to determine the
"RTN","XLFNAME5",103,0)
 ;;component parts of the name. If the standard form of the name is different
"RTN","XLFNAME5",104,0)
 ;;from the current form, or if any questionable assumptions need to made in
"RTN","XLFNAME5",105,0)
 ;;determining the component parts of the name, information about that name
"RTN","XLFNAME5",106,0)
 ;;is stored in ^XTMP("XLFNAME"). You can later print the information stored
"RTN","XLFNAME5",107,0)
 ;;in ^XTMP via the PRINT^XLFNAME entry point.
"RTN","XLFNAME5",108,0)
 ;;
"RTN","XLFNAME5",109,0)
 ;;NOTE: This entry point makes no changes to the NEW PERSON file or the new
"RTN","XLFNAME5",110,0)
 ;;      NAME COMPONENTS file.
"RTN","XLFNAME5",111,0)
 ;;$$END
"RTN","XLFNAME5",112,0)
 N I,T F I=1:1 S T=$P($T(GINTRO+I),";;",2,999) Q:T="$$END"  W !,T
"RTN","XLFNAME5",113,0)
 Q
"RTN","XLFNAME6")
0^8^B933328
"RTN","XLFNAME6",1,0)
XLFNAME6 ;CIOFO-SF/TKW,MKO-Utilities for person name fields ;11:41 AM  14 Mar 2000
"RTN","XLFNAME6",2,0)
 ;;8.0;KERNEL;**134**;Jul 10, 1995
"RTN","XLFNAME6",3,0)
 ;
"RTN","XLFNAME6",4,0)
FMNAME(XUNAME,XUFLAG,XUDLM) ; Convert HL7 format name to regular name
"RTN","XLFNAME6",5,0)
 ; XUNAME   - HL7 string to be converted
"RTN","XLFNAME6",6,0)
 ; XUDLM  - Delimiter (defaults to "^")
"RTN","XLFNAME6",7,0)
 ; XUFLAG   [ C  : Returns name components
"RTN","XLFNAME6",8,0)
 ;            L# : Truncate to length of #
"RTN","XLFNAME6",9,0)
 ;            M  : Mixed case
"RTN","XLFNAME6",10,0)
 ;            S  : Standardize name
"RTN","XLFNAME6",11,0)
F N I,N,S,XUF
"RTN","XLFNAME6",12,0)
 Q:$G(XUNAME)="" ""
"RTN","XLFNAME6",13,0)
 S:$G(XUDLM)="" XUDLM="^"
"RTN","XLFNAME6",14,0)
 S XUFLAG=$G(XUFLAG)
"RTN","XLFNAME6",15,0)
 I XUFLAG'["C" N X S X=XUNAME N XUNAME S XUNAME=X
"RTN","XLFNAME6",16,0)
 ;
"RTN","XLFNAME6",17,0)
 S I=0 F S="FAMILY","GIVEN","MIDDLE","SUFFIX" S I=I+1 D
"RTN","XLFNAME6",18,0)
 . S XUNAME(S)="",N=$P(XUNAME,XUDLM,I) Q:N=""""""
"RTN","XLFNAME6",19,0)
 . S XUNAME(S)=N Q
"RTN","XLFNAME6",20,0)
 ;
"RTN","XLFNAME6",21,0)
 S XUF="C"_$E("M",XUFLAG["M")_$E("S",XUFLAG["S")
"RTN","XLFNAME6",22,0)
 S:XUFLAG["L" XUF=XUF_"L"_+$P(XUFLAG,"L",2)
"RTN","XLFNAME6",23,0)
 Q $$NAMEFMT^XLFNAME(.XUNAME,"F",XUF)
"RTN","XLFNENV")
0^^B1529640
"RTN","XLFNENV",1,0)
XLFNENV ;SFISC/MKO-ENVIRONMENT CHECK FOR XU*8.0*134 ;10:09 AM  29 Feb 2000
"RTN","XLFNENV",2,0)
 ;;8.0;KERNEL;**134**;Jul 10, 1995
"RTN","XLFNENV",3,0)
ENV ;The Environment check
"RTN","XLFNENV",4,0)
 N XUNAM
"RTN","XLFNENV",5,0)
 Q:'$D(^DD(20))!($P($G(^DIC(20,0)),U)="NAME COMPONENTS")
"RTN","XLFNENV",6,0)
 S XPDQUIT=2
"RTN","XLFNENV",7,0)
 ;
"RTN","XLFNENV",8,0)
 S XUNAM=$P($G(^DIC(20,0)),U) S:XUNAM="" XUNAM=$O(^DD(20,0,"NM",XUNAM))
"RTN","XLFNENV",9,0)
 W !!,"This patch brings in a new NAME COMPONENTS file (#20),"
"RTN","XLFNENV",10,0)
 W !,"but file #20, "_XUNAM_", already exists on this system."
"RTN","XLFNENV",11,0)
 ;
"RTN","XLFNENV",12,0)
 I XUNAM="EMPLOYEE" D
"RTN","XLFNENV",13,0)
 . W !!,"Note that the Big Bang patch A4A7*1.01*11, released 17-Dec-1998,"
"RTN","XLFNENV",14,0)
 . W !,"deletes the DD for file #20, but step 5 of that patch, ""D K^A4A7KILL"","
"RTN","XLFNENV",15,0)
 . W !,"may not have been performed in this account."
"RTN","XLFNENV",16,0)
 Q
"RTN","XUSERNEW")
0^7^B13683837
"RTN","XUSERNEW",1,0)
XUSERNEW ;SF/RWF - ADD NEW USER ;10:48 AM  14 Mar 2000
"RTN","XUSERNEW",2,0)
 ;;8.0;KERNEL;**16,49,134**;Jul 10, 1995
"RTN","XUSERNEW",3,0)
 ;In the call to NEW^XM for new users the variable XMZ must be undef.
"RTN","XUSERNEW",4,0)
 ;on a reactivation XMZ should be set to the current max message number.
"RTN","XUSERNEW",5,0)
EN ;Add
"RTN","XUSERNEW",6,0)
 S Y=$$ADD("","",1) G EXIT:Y'>0,RE:$P(Y,U,3)'=1
"RTN","XUSERNEW",7,0)
 S DR="["_$$GET^XUPARAM("XUNEW USER","N")_"]"
"RTN","XUSERNEW",8,0)
 S XUN=+Y,DIE=200,DA=XUN D XUDIE^XUS5 G:$D(DTOUT) EXIT
"RTN","XUSERNEW",9,0)
 S Y=XUN K XMZ D NEW^XM K XMDT,XMM,XMZ
"RTN","XUSERNEW",10,0)
 ;ACCESS LETTER, Also see XUSERBLK
"RTN","XUSERNEW",11,0)
 W ! D LETTER(XUN,1)
"RTN","XUSERNEW",12,0)
 K DIR,DIWF,XUTEXT
"RTN","XUSERNEW",13,0)
 ;Fall in from above, called from REACT
"RTN","XUSERNEW",14,0)
KEYS S DIR(0)="Y",DIR("B")="NO",DIR("A")="Do you wish to allocate security keys" D ^DIR G:$D(DIRUT) EXIT
"RTN","XUSERNEW",15,0)
 I Y=1 S XQHOLD(XUN)="",XQKEY(0)=0,XQDA=0,XQAL=1,XQ6="",XQFL="" D KEY^XQ6
"RTN","XUSERNEW",16,0)
EXIT K D0,DA,DIE,DIC,DIR,DI,DICR,DIG,DIH,DIU,DIV,DLAYGO,DR,K,I,X,XQHOLD,XQKEY,XUN,XUSOLD,XMB,XMZ,Y,Z,XQ6,XQFL,DTOUT
"RTN","XUSERNEW",17,0)
 Q
"RTN","XUSERNEW",18,0)
RE ;Jump from new user to reactivate
"RTN","XUSERNEW",19,0)
 S XUN=+Y,DIR("A")="This isn't a new user, Want to reactivate?",DIR(0)="Y",DIR("B")="NO" D ^DIR G EXIT:$D(DIRUT)!(Y'=1),RE2
"RTN","XUSERNEW",20,0)
REACT ;SEA/WDE-REACTIVATE A USER
"RTN","XUSERNEW",21,0)
 S XUN=+$$LOOKUP^XUSER G EXIT:XUN<0
"RTN","XUSERNEW",22,0)
RE2 S XUSOLD=^VA(200,XUN,0),$P(^VA(200,XUN,0),U,11)=""
"RTN","XUSERNEW",23,0)
 S DIE=200,DR="["_$$GET^XUPARAM("XUREACT USER","N")_"]",DA=XUN D XUDIE^XUS5 G:$D(DTOUT) EXIT
"RTN","XUSERNEW",24,0)
 I $P(^VA(200,XUN,0),U,3)="" W !!,"No ACCESS CODE has been entered.",$C(7),!
"RTN","XUSERNEW",25,0)
 I $P(^VA(200,XUN,0),U,11)>0,$P(^(0),U,11)'>DT W !!,"User is still TERMINATED.",$C(7),!
"RTN","XUSERNEW",26,0)
 S DIR(0)="Y",DIR("A")="Deny access to old mail messages",DIR("B")="NO",DIR("?")="Enter a 'YES' to restrict access to old mail messages." D ^DIR G:$D(DIRUT) EXIT
"RTN","XUSERNEW",27,0)
 K XMZ S:Y=1 XMZ=+$P(^XMB(3.9,0),"^",3) S Y=XUN D NEW^XM K XMDT,XMM,XMZ
"RTN","XUSERNEW",28,0)
 G KEYS
"RTN","XUSERNEW",29,0)
 Q
"RTN","XUSERNEW",30,0)
ADD(NP1,KEYS,NONC) ;Common point to do DIC call for adding a new person.
"RTN","XUSERNEW",31,0)
 ;NP1 will be added to the default or what comes from the NPI field of the KSP.
"RTN","XUSERNEW",32,0)
 ;KEYS is a list of Keys to give the new person
"RTN","XUSERNEW",33,0)
 N DA,DR,DLAYGO,XUITNAME,XUS1,XUS2,DIC,DIE,DIK,NP2,Y I $G(^XTV(8989.3,1,"NPI"))]"" X ^("NPI") S NP2=DR
"RTN","XUSERNEW",34,0)
 S:'$D(NP2) NP2="1;"_$S($D(^XUSEC("XUSPF200",DUZ)):9,1:"9R~")_";4"
"RTN","XUSERNEW",35,0)
 S DIC="^VA(200,",DIC(0)="AELMQ",DLAYGO=200,DIC("A")="Enter NEW PERSON's name (Family,Given Middle Suffix): ",DIC("DR")="",XUITNAME=1
"RTN","XUSERNEW",36,0)
 D ^DIC S XUS1=Y G AX:(Y'>0)!($P(Y,U,3)'>0)
"RTN","XUSERNEW",37,0)
 S DA=+$G(^VA(200,+XUS1,3.1)) I DA,'$G(NONC) D
"RTN","XUSERNEW",38,0)
 . W !,"Name components."
"RTN","XUSERNEW",39,0)
 . S DIE="^VA(20,",DR="1;2;3;5"
"RTN","XUSERNEW",40,0)
 . L +^VA(20,DA,0):60 D ^DIE L -^VA(20,DA,0)
"RTN","XUSERNEW",41,0)
 . I $D(Y)!$D(DTOUT) S DA=+XUS1,XUS1=-1
"RTN","XUSERNEW",42,0)
 . E  S $P(XUS1,U,2)=$P(^VA(200,+XUS1,0),U)
"RTN","XUSERNEW",43,0)
 D:XUS1>0
"RTN","XUSERNEW",44,0)
 . W !,"Now for the Identifiers."
"RTN","XUSERNEW",45,0)
 . S DA=+XUS1,DIE="^VA(200,",DR=NP2_$S($D(NP1):";"_NP1,1:""),DIE("NO^")="OUTOK"
"RTN","XUSERNEW",46,0)
 . L +^VA(200,DA,0):60 D ^DIE L -^VA(200,DA,0)
"RTN","XUSERNEW",47,0)
 . S:$D(Y)!$D(DTOUT) XUS1=-1
"RTN","XUSERNEW",48,0)
 I XUS1<0 D  S XUS1=-1
"RTN","XUSERNEW",49,0)
 . W !?5,"<'",$P(^VA(200,DA,0),U),"' DELETED>"
"RTN","XUSERNEW",50,0)
 . S DIK="^VA(200," D ^DIK
"RTN","XUSERNEW",51,0)
 . Q:$P($G(^DIC(3,0)),U)'="USER"!'$D(^DD(3,0))
"RTN","XUSERNEW",52,0)
 . S DIK="^DIC(3,",XUS1=$P($G(^DIC(3,DA,0)),U,16) D ^DIK
"RTN","XUSERNEW",53,0)
 . Q:'XUS1!($P($G(^DIC(16,0)),U)'="PERSON")!'$D(^DD(16,0))
"RTN","XUSERNEW",54,0)
 . S DIK="^DIC(16,",DA=XUS1 D ^DIK
"RTN","XUSERNEW",55,0)
 I XUS1>0,$D(KEYS) F XUS2=1:1 S Y=$P(KEYS,",",XUS2) Q:'$L(Y)  S %=$$ADD^XQKEY(XUS1,Y) I '% W !,"Key '",Y,"' not allocated"
"RTN","XUSERNEW",56,0)
AX Q XUS1
"RTN","XUSERNEW",57,0)
REPRINT S DA=+$$LOOKUP^XUSER G EXIT:DA'>0
"RTN","XUSERNEW",58,0)
 D LETTER(DA) G EXIT
"RTN","XUSERNEW",59,0)
LETTER(XUN,ASK) ;Print access letter
"RTN","XUSERNEW",60,0)
 Q:'$G(XUN)  N DIWF,FR,TO,BY,DIR
"RTN","XUSERNEW",61,0)
 S XUTEXT=$$GET^XUPARAM("XUSER COMPUTER ACCOUNT","N"),XUTEXT=$O(^DIC(9.2,"B",XUTEXT,0))
"RTN","XUSERNEW",62,0)
 S DIR(0)="Y",DIR("A")="Print User Account Access Letter"
"RTN","XUSERNEW",63,0)
 I XUTEXT>0 S Y=1 D:$G(ASK) ^DIR I Y=1 D
"RTN","XUSERNEW",64,0)
 . S XUU="________",DIWF="^DIC(9.2,XUTEXT,1,",DIWF(1)=200,FR=XUN,TO=XUN,BY="NUMBER" D EN2^DIWF
"RTN","XUSERNEW",65,0)
 . Q
"RTN","XUSERNEW",66,0)
 K XUTEXT
"RTN","XUSERNEW",67,0)
 Q
"SEC","^DIC",20,20,0,"AUDIT")

"SEC","^DIC",20,20,0,"DD")
@
"SEC","^DIC",20,20,0,"DEL")
#
"SEC","^DIC",20,20,0,"LAYGO")
#
"SEC","^DIC",20,20,0,"RD")
#
"SEC","^DIC",20,20,0,"WR")
#
"VER")
8.0^22.0
"^DD",20,20,0)
FIELD^^11^10
"^DD",20,20,0,"DDA")
N
"^DD",20,20,0,"DT")
3000131
"^DD",20,20,0,"ID","NAME")
N XUN S XUN("FAMILY")=$P($G(^(1)),U),XUN("GIVEN")=$P($G(^(1)),U,2),XUN("MIDDLE")=$P($G(^(1)),U,3),XUN("SUFFIX")=$P($G(^(1)),U,5) D EN^DDIOL($$NAMEFMT^XLFNAME(.XUN,"F","C"),"","?0")
"^DD",20,20,0,"IX","B",20,.01)

"^DD",20,20,0,"NM","NAME COMPONENTS")

"^DD",20,20,0,"PT",200,10.1)

"^DD",20,20,0,"VRPK")
XU
"^DD",20,20,.01,0)
FILE^RNJ20,7I^^0;1^K:+X'=X!(X>999999999999)!(X<0)!(X?.E1"."8N.N) X
"^DD",20,20,.01,1,0)
^.1
"^DD",20,20,.01,1,1,0)
20^B
"^DD",20,20,.01,1,1,1)
S ^VA(20,"B",$E(X,1,30),DA)=""
"^DD",20,20,.01,1,1,2)
K ^VA(20,"B",$E(X,1,30),DA)
"^DD",20,20,.01,3)
Answer must be a number between 0 and 999999999999, with up to 7 decimal digits. Answer '??' for more help.
"^DD",20,20,.01,21,0)
^^2^2^2991008^
"^DD",20,20,.01,21,1,0)
Answer must be the number of the file or subfile that contains the name
"^DD",20,20,.01,21,2,0)
field.
"^DD",20,20,.01,"DT")
3000105
"^DD",20,20,.02,0)
FIELD^RNJ20,7I^^0;2^K:+X'=X!(X>999999999999)!(X<0)!(X?.E1"."8N.N) X
"^DD",20,20,.02,3)
Answer must be a number between 0 and 999999999999, with up to 7 decimal digits. Answer '??' for more help. 
"^DD",20,20,.02,21,0)
^^1^1^2991008^
"^DD",20,20,.02,21,1,0)
Answer must be the number of the field that contains the name.
"^DD",20,20,.02,"DT")
3000105
"^DD",20,20,.03,0)
IENS^RFI^^0;3^K:$L(X)>50!($L(X)<2) X
"^DD",20,20,.03,3)
Answer must be 2-50 characters in length. Answer '??' for more help.
"^DD",20,20,.03,21,0)
^.001^1^1^2991012^^^
"^DD",20,20,.03,21,1,0)
Answer must be the IENS of the entry that contains the name.
"^DD",20,20,.03,"DT")
3000105
"^DD",20,20,1,0)
FAMILY (LAST) NAME^RFX^^1;1^K:$L(X)>35!($L(X)<1)!'(X?1U.UNP)!(X["`") X
"^DD",20,20,1,.1)
LAST NAME
"^DD",20,20,1,3)
Answer must be 1-35 characters in length. Answer '??' for more help.
"^DD",20,20,1,21,0)
^.001^3^3^3000321^^^
"^DD",20,20,1,21,1,0)
Answer with the person's family (last) name. It must begin with an
"^DD",20,20,1,21,2,0)
upper-case letter and can contain only upper-case letters, numbers, and
"^DD",20,20,1,21,3,0)
punctuation, excluding circumflexes (^) and grave accents (`).
"^DD",20,20,1,"DT")
3000303
"^DD",20,20,2,0)
GIVEN (FIRST) NAME^RFX^^1;2^K:$L(X)>25!($L(X)<1)!'(X?1U.UNP)!(X["`") X
"^DD",20,20,2,.1)
FIRST NAME
"^DD",20,20,2,3)
Answer must be 1-25 characters in length. Answer '??' for more help.
"^DD",20,20,2,21,0)
^^3^3^3000321^
"^DD",20,20,2,21,1,0)
Answer with the person's given (first) name. It must begin with an
"^DD",20,20,2,21,2,0)
upper-case letter and can contain only upper-case letters, numbers, and
"^DD",20,20,2,21,3,0)
punctuation, excluding circumflexes (^) and grave accents (`).
"^DD",20,20,2,"DT")
3000303
"^DD",20,20,3,0)
MIDDLE NAME^FX^^1;3^K:$L(X)>25!($L(X)<1)!'(X?1U.UNP)!(X["`")!(X="NMI")!(X="NMN") X
"^DD",20,20,3,3)
Answer must be 1-25 characters in length. Answer '??' for more help.
"^DD",20,20,3,21,0)
^^4^4^3000321^
"^DD",20,20,3,21,1,0)
Answer with the person's middle name. It must begin with an upper-case
"^DD",20,20,3,21,2,0)
letter and can contain only upper-case letters, numbers, and punctuation,
"^DD",20,20,3,21,3,0)
excluding circumflexes (^) and grave accents (`). Middle names of NMI and
"^DD",20,20,3,21,4,0)
NMN are not accepted.
"^DD",20,20,3,"DT")
2991123
"^DD",20,20,4,0)
PREFIX^FX^^1;4^K:$L(X)>10!($L(X)<1)!'(X?1U.UNP)!(X["`") X
"^DD",20,20,4,3)
Answer must be 1-10 characters in length. Answer '??' for more help.
"^DD",20,20,4,21,0)
^^3^3^3000321^
"^DD",20,20,4,21,1,0)
Answer with the name prefix, such as MR or MS. Answer must begin with an
"^DD",20,20,4,21,2,0)
upper-case letter and can contain only upper-case letters, numbers, and
"^DD",20,20,4,21,3,0)
punctuation, excluding circumflexes (^) and grave accents (`).
"^DD",20,20,4,"DT")
2991012
"^DD",20,20,5,0)
SUFFIX^FX^^1;5^K:$L(X)>10!($L(X)<1)!'(X?1UN.UNP)!(X["`") X
"^DD",20,20,5,3)
Answer must be 1-10 characters in length. Answer '??' for more help.
"^DD",20,20,5,21,0)
^^4^4^3000321^
"^DD",20,20,5,21,1,0)
Answer with the name suffix(es), such as JR, SR, II, or III. Answer
"^DD",20,20,5,21,2,0)
must begin with an upper-case letter and can contain only upper-case
"^DD",20,20,5,21,3,0)
letters, numbers, and punctuation, excluding circumflexes (^) and grave
"^DD",20,20,5,21,4,0)
accents (`).
"^DD",20,20,5,"DT")
3000107
"^DD",20,20,6,0)
DEGREE^FX^^1;6^K:$L(X)>10!($L(X)<1)!'(X?1U.UNP)!(X["`") X
"^DD",20,20,6,3)
Answer must be 1-10 characters in length. Answer '??' for more help.
"^DD",20,20,6,21,0)
^^4^4^3000321^
"^DD",20,20,6,21,1,0)
Answer with the person's academic or professional degree, such as BS, BA,
"^DD",20,20,6,21,2,0)
MD, or PHD. It must begin with an upper-case letter and can contain only
"^DD",20,20,6,21,3,0)
upper-case letters, numbers, and punctuation, excluding circumflexes (^)
"^DD",20,20,6,21,4,0)
and grave accents (`).
"^DD",20,20,6,"DT")
3000321
"^DD",20,20,11,0)
NOTES ABOUT NAME^F^^11;1^K:$L(X)>100!($L(X)<3) X
"^DD",20,20,11,3)
Answer must be 3-100 characters in length. Answer '??' for more help.
"^DD",20,20,11,21,0)
^^7^7^3000321^
"^DD",20,20,11,21,1,0)
This field stores notes about the name.
"^DD",20,20,11,21,2,0)
 
"^DD",20,20,11,21,3,0)
During the New Person Name Conversion, which is run as part of the
"^DD",20,20,11,21,4,0)
post-install routine of Patch XU*8.0*134, if a name in the NEW PERSON file
"^DD",20,20,11,21,5,0)
contains text in parentheses (), brackets [], or braces {}, that text is
"^DD",20,20,11,21,6,0)
removed from the name, and the original name with the parenthetical text
"^DD",20,20,11,21,7,0)
is recorded in this field.
"^DD",20,20,11,"DT")
3000131
"^DD",200,200,.01,0)
NAME^RFX^^0;1^K XLFNC K:X[""""!($A(X)=45)!($L(X,",")'=2)!(X'?1.E1","1.E) X I $D(X) S XLFNC=X D STDNAME^XLFNAME(.XLFNC,"C") S X=XLFNC K:$L(X)>35!($L(X)<3) X,XLFNC K:'$G(XUITNAME) XLFNC
"^DD",200,200,.01,.1)

"^DD",200,200,.01,1,0)
^.1^^-3
"^DD",200,200,.01,1,2,0)
200^AE^MUMPS
"^DD",200,200,.01,1,2,1)
S X1=$P($G(^VA(200,DA,1)),"^",8) I X1="" S $P(^VA(200,DA,1),"^",7,8)=DT_"^"_DUZ
"^DD",200,200,.01,1,2,2)
Q
"^DD",200,200,.01,1,2,3)
Stuffing Creator and date
"^DD",200,200,.01,1,2,"%D",0)
^^1^1^2990617^^
"^DD",200,200,.01,1,2,"%D",1,0)
This X-ref stuffs the DATE ENTERED and CREATOR fields on a new entry.
"^DD",200,200,.01,1,2,"DT")
2990617
"^DD",200,200,.01,1,5,0)
200^BS5^MUMPS
"^DD",200,200,.01,1,5,1)
Q:$P($G(^VA(200,DA,1)),U,9)']""  S ^VA(200,"BS5",$E(X,1)_$E($P(^(1),U,9),6,9),DA)=""
"^DD",200,200,.01,1,5,2)
Q:$P($G(^VA(200,DA,1)),U,9)']""  K ^VA(200,"BS5",$E(X,1)_$E($P(^(1),U,9),6,9),DA)
"^DD",200,200,.01,1,5,3)
Special BS5 lookup X-ref
"^DD",200,200,.01,1,5,"%D",0)
^^3^3^2990617^^
"^DD",200,200,.01,1,5,"%D",1,0)
This X-ref builds the 'BS5' X-ref on name changes.
"^DD",200,200,.01,1,5,"%D",2,0)
The BS5 is the first letter of the last name concatinated with the last
"^DD",200,200,.01,1,5,"%D",3,0)
four digits of the SSN.
"^DD",200,200,.01,1,8,0)
200^AG^MUMPS
"^DD",200,200,.01,1,8,1)
F X1=0:0 S X1=$O(^VA(200,"AB",X1)) Q:X1'>0  I $D(^VA(200,"AB",X1,DA)),$S($D(^DIC(19.1,X1,0)):$P(^(0),U,3)["l",1:0) S X2=^(0),^VA(200,"AK."_$P(X2,U),X,DA)=""
"^DD",200,200,.01,1,8,2)
S X1="AK." F X2=0:0 S X1=$O(^VA(200,X1)) Q:$E(X1,3)'="."  K ^VA(200,X1,X,DA)
"^DD",200,200,.01,1,8,3)
Updates the AK.key special lookup X-ref.
"^DD",200,200,.01,1,8,"%D",0)
^^1^1^2920513^
"^DD",200,200,.01,1,8,"%D",1,0)
Builds the AK.key special lookup X-ref when there is a name change.
"^DD",200,200,.01,1,8,"DT")
2890929
"^DD",200,200,.01,1,9,0)
200^ASX^MUMPS
"^DD",200,200,.01,1,9,1)
S ^VA(200,"ASX",$$EN^XUA4A71(X),DA)=""
"^DD",200,200,.01,1,9,2)
K ^VA(200,"ASX",$$EN^XUA4A71(X),DA)
"^DD",200,200,.01,1,9,3)
LAYGO SOUNDEX X-REF
"^DD",200,200,.01,1,9,"%D",0)
^^3^3^2920513^^
"^DD",200,200,.01,1,9,"%D",1,0)
This builds a soundex X-ref so that a check for simular names can be
"^DD",200,200,.01,1,9,"%D",2,0)
done at the time of LAYGOing to the file.
"^DD",200,200,.01,1,9,"%D",3,0)
It calls XUA4A71 to convert X. The LAYGO test calls XUA4A7.
"^DD",200,200,.01,1,9,"DT")
2920117
"^DD",200,200,.01,1,10,0)
^^BULLETIN MESSAGE
"^DD",200,200,.01,1,10,1)
S Y(0)=X,D0=DA S X=Y(0) S Y(1)=$S($D(^VA(200,D0,0)):^(0),1:"") S X=$P(Y(1),U,1) S XMB(1)=X K XMY S XMB="XMNEWUSER" D ^XMB:$D(^XMB(3.6,"B",XMB)) K Y,XMB
"^DD",200,200,.01,1,10,2)
Q
"^DD",200,200,.01,1,10,3)
New user Bulletin
"^DD",200,200,.01,1,10,"%D",0)
^^1^1^2990617^
"^DD",200,200,.01,1,10,"%D",1,0)
This bulletin is sent whenever a new user is added to the New Person file.
"^DD",200,200,.01,1,10,"CREATE PARAMETER #1")
NAME
"^DD",200,200,.01,1,10,"CREATE VALUE")
XMNEWUSER
"^DD",200,200,.01,1,10,"DELETE VALUE")
NO EFFECT
"^DD",200,200,.01,1,10,"DT")
2990617
"^DD",200,200,.01,1,11,0)
^^TRIGGER^46.11^.02
"^DD",200,200,.01,1,11,1)
Q
"^DD",200,200,.01,1,11,2)
K DIV S DIV=X,D0=DA,DIV(0)=D0 S Y(0)=X S X=$P($G(^DG(43,1,"HL7")),U,4)=1 I X S X=DIV X ^DD(200,.01,1,11,89.2) S Y(101)=$S($D(^DGRU(46.11,D0,0)):^(0),1:"") S X=$P(Y(101),U,2) S D0=I(0,0) S DIU=X K Y S X=DIV S X=X X ^DD(200,.01,1,11,2.4)
"^DD",200,200,.01,1,11,2.4)
S DIH=$S($D(^DGRU(46.11,DIV(0),0)):^(0),1:""),DIV=X I $D(^(0)) S $P(^(0),U,2)=DIV,DIH=46.11,DIG=.02 D ^DICR:$O(^DD(DIH,DIG,1,0))>0
"^DD",200,200,.01,1,11,89.2)
S I(0,0)=$S($D(D0):D0,1:""),Y(1)=$S($D(^VA(200,D0,0)):^(0),1:"") S X=$P(Y(1),U,1),X=X S X=X K DIC S DIC="^DGRU(46.11,",DIC(0)="NMFL",X=""""_X_"""" D ^DIC S (D,D0,DIV(0))=+Y
"^DD",200,200,.01,1,11,"%D",0)
^^2^2^2991018^
"^DD",200,200,.01,1,11,"%D",1,0)
Trigger the Name field before it was changed into the RAI MDS MONITOR
"^DD",200,200,.01,1,11,"%D",2,0)
file whenever the Name field of the New Person file is added or changed.
"^DD",200,200,.01,1,11,"CREATE VALUE")
NO EFFECT
"^DD",200,200,.01,1,11,"DELETE CONDITION")
S X=$P($G(^DG(43,1,"HL7")),U,4)=1
"^DD",200,200,.01,1,11,"DELETE VALUE")
OLD NAME
"^DD",200,200,.01,1,11,"DIC")
LOOKUP
"^DD",200,200,.01,1,11,"DT")
2991018
"^DD",200,200,.01,1,11,"FIELD")
NAME:RAI MDS MONITOR:#.02
"^DD",200,200,.01,1,12,0)
^^TRIGGER^46.11^.03
"^DD",200,200,.01,1,12,1)
K DIV S DIV=X,D0=DA,DIV(0)=D0 S Y(0)=X S X=$P($G(^DG(43,1,"HL7")),U,4)=1 I X S X=DIV X ^DD(200,.01,1,12,89.2) S Y(101)=$S($D(^DGRU(46.11,D0,0)):^(0),1:"") S X=$P(Y(101),U,3) S D0=I(0,0) S DIU=X K Y S X=DIV S X=200 X ^DD(200,.01,1,12,1.4)
"^DD",200,200,.01,1,12,1.4)
S DIH=$S($D(^DGRU(46.11,DIV(0),0)):^(0),1:""),DIV=X I $D(^(0)) S $P(^(0),U,3)=DIV,DIH=46.11,DIG=.03 D ^DICR:$O(^DD(DIH,DIG,1,0))>0
"^DD",200,200,.01,1,12,2)
Q
"^DD",200,200,.01,1,12,89.2)
S I(0,0)=$S($D(D0):D0,1:""),Y(1)=$S($D(^VA(200,D0,0)):^(0),1:"") S X=$P(Y(1),U,1),X=X S X=X K DIC S DIC="^DGRU(46.11,",DIC(0)="NMFL" D ^DIC S (D,D0,DIV(0))=+Y
"^DD",200,200,.01,1,12,"%D",0)
^^2^2^2991018^
"^DD",200,200,.01,1,12,"%D",1,0)
Trigger the New Person file number (#200) into the RAI MDS MONITOR
"^DD",200,200,.01,1,12,"%D",2,0)
file whenever the New Person name field is added or changed.
"^DD",200,200,.01,1,12,"CREATE CONDITION")
S X=$P($G(^DG(43,1,"HL7")),U,4)=1
"^DD",200,200,.01,1,12,"CREATE VALUE")
S X=200
"^DD",200,200,.01,1,12,"DELETE VALUE")
NO EFFECT
"^DD",200,200,.01,1,12,"DIC")
LOOKUP
"^DD",200,200,.01,1,12,"DT")
2991018
"^DD",200,200,.01,1,12,"FIELD")
NAME:RAI MDS MONITOR:#.03
"^DD",200,200,.01,1,13,0)
^^TRIGGER^46.11^.04
"^DD",200,200,.01,1,13,1)
K DIV S DIV=X,D0=DA,DIV(0)=D0 S Y(0)=X S X=$P($G(^DG(43,1,"HL7")),U,4)=1 I X S X=DIV X ^DD(200,.01,1,13,89.2) S Y(101)=$S($D(^DGRU(46.11,D0,0)):^(0),1:"") S X=$P(Y(101),U,4) S D0=I(0,0) S DIU=X K Y S X=DIV S X=DA X ^DD(200,.01,1,13,1.4)
"^DD",200,200,.01,1,13,1.4)
S DIH=$S($D(^DGRU(46.11,DIV(0),0)):^(0),1:""),DIV=X I $D(^(0)) S $P(^(0),U,4)=DIV,DIH=46.11,DIG=.04 D ^DICR:$O(^DD(DIH,DIG,1,0))>0
"^DD",200,200,.01,1,13,2)
Q
"^DD",200,200,.01,1,13,89.2)
S I(0,0)=$S($D(D0):D0,1:""),Y(1)=$S($D(^VA(200,D0,0)):^(0),1:"") S X=$P(Y(1),U,1),X=X S X=X K DIC S DIC="^DGRU(46.11,",DIC(0)="NMF" D ^DIC S (D,D0,DIV(0))=+Y
"^DD",200,200,.01,1,13,"%D",0)
^^2^2^2991018^
"^DD",200,200,.01,1,13,"%D",1,0)
Trigger the internal entry number of the entry which was changed or added
"^DD",200,200,.01,1,13,"%D",2,0)
in the New Person file, into the RAI MDS MONITOR file.
"^DD",200,200,.01,1,13,"CREATE CONDITION")
S X=$P($G(^DG(43,1,"HL7")),U,4)=1
"^DD",200,200,.01,1,13,"CREATE VALUE")
S X=DA
"^DD",200,200,.01,1,13,"DELETE VALUE")
NO EFFECT
"^DD",200,200,.01,1,13,"DIC")
LOOKUP
"^DD",200,200,.01,1,13,"DT")
2991018
"^DD",200,200,.01,1,13,"FIELD")
NAME:RAI MDS MONITOR:#.04
"^DD",200,200,.01,3)
Answer must be 3-35 upper-case characters in length, and be in the format Family(Last),Given(First) Middle Suffix. Enter '??' for more help.
"^DD",200,200,.01,21,0)
^^36^36^3000313^
"^DD",200,200,.01,21,1,0)
Enter only data that is actually part of the person's name. Do not include
"^DD",200,200,.01,21,2,0)
extra titles, identification, flags, local information, etc.
"^DD",200,200,.01,21,3,0)
 
"^DD",200,200,.01,21,4,0)
Enter the name in the format:
"^DD",200,200,.01,21,5,0)
 
"^DD",200,200,.01,21,6,0)
   Family_(last)_name,Given_(first)_name(s) Middle_name(s) Suffix(es)
"^DD",200,200,.01,21,7,0)
 
"^DD",200,200,.01,21,8,0)
Example: O'BRIEN-DE LEON,JOHN K. JR.
"^DD",200,200,.01,21,9,0)
 
"^DD",200,200,.01,21,10,0)
Though FileMan standardizes the name you enter and removes most of the
"^DD",200,200,.01,21,11,0)
punctuation before storing it in the name field, the punctuation is
"^DD",200,200,.01,21,12,0)
retained in the Name Components file for use in displaying the name for
"^DD",200,200,.01,21,13,0)
letters, reports. etc. You should, therefore, enter all appropriate
"^DD",200,200,.01,21,14,0)
punctuation in the name.
"^DD",200,200,.01,21,15,0)
 
"^DD",200,200,.01,21,16,0)
For example, the above name is standardized and stored in the Name field
"^DD",200,200,.01,21,17,0)
as:
"^DD",200,200,.01,21,18,0)
 
"^DD",200,200,.01,21,19,0)
        OBRIEN-DELEON,JOHN K JR
"^DD",200,200,.01,21,20,0)
 
"^DD",200,200,.01,21,21,0)
but the individual name components are stored in the Name Components file
"^DD",200,200,.01,21,22,0)
as:
"^DD",200,200,.01,21,23,0)
 
"^DD",200,200,.01,21,24,0)
        Family (last) name: O'BRIEN-DE LEON
"^DD",200,200,.01,21,25,0)
        Given (first) name: JOHN
"^DD",200,200,.01,21,26,0)
               Middle name: K.
"^DD",200,200,.01,21,27,0)
                    Suffix: JR.
"^DD",200,200,.01,21,28,0)
 
"^DD",200,200,.01,21,29,0)
In forming the standard name, colons (:) and semicolons (;) in the Family
"^DD",200,200,.01,21,30,0)
Name part are replaced with hyphens (-), and then all punctuation except
"^DD",200,200,.01,21,31,0)
hyphens are removed, and all spaces are removed. In the other name parts,
"^DD",200,200,.01,21,32,0)
colons, semicolons and periods are replaced with spaces, and then all
"^DD",200,200,.01,21,33,0)
punctuation except for hyphens are removed.
"^DD",200,200,.01,21,34,0)
 
"^DD",200,200,.01,21,35,0)
Birth position indicators entered as Arabic numerals are changed to their
"^DD",200,200,.01,21,36,0)
Roman numeral equivalents. (For example, 3rd is changed to III.)
"^DD",200,200,.01,"AUDIT")
n
"^DD",200,200,.01,"AX")

"^DD",200,200,.01,"DEL",1,0)
I 1 W *7,"  PERSONS CAN'T BE DELETED!!"
"^DD",200,200,.01,"DT")
3000323
"^DD",200,200,.01,"LAYGO",1,0)
D LAYGO^XUA4A7
"^DD",200,200,10.1,0)
NAME COMPONENTS^RP20'I^VA(20,^3.1;1^Q
"^DD",200,200,10.1,3)
Answer '??' for more help.
"^DD",200,200,10.1,21,0)
^^2^2^2991129^
"^DD",200,200,10.1,21,1,0)
Answer with the entry in the NAME COMPONENTS file that contains the
"^DD",200,200,10.1,21,2,0)
components of the person's name.
"^DD",200,200,10.1,"DT")
2991129
"^DD",200,200,10.6,0)
DEGREE^F^^3.1;6^K:$L(X)>10!($L(X)<1) X
"^DD",200,200,10.6,3)
Answer must be 1-10 characters in length.
"^DD",200,200,10.6,21,0)
^^2^2^2991201^
"^DD",200,200,10.6,21,1,0)
This field holds any academic or professional degree that have been earned
"^DD",200,200,10.6,21,2,0)
by the user. This would be things like BS, BA, MD, and PHD.
"^DD",200,200,10.6,"DT")
3000105
"^DIC",20,20,0)
NAME COMPONENTS^20
"^DIC",20,20,0,"GL")
^VA(20,
"^DIC",20,20,"%",0)
^1.005^^0
"^DIC",20,20,"%D",0)
^^25^25^3000321^
"^DIC",20,20,"%D",1,0)
This file, introduced with Name Standardization (Patch XU*8.0*134), holds
"^DIC",20,20,"%D",2,0)
the component parts of a person's name as follows:
"^DIC",20,20,"%D",3,0)
 
"^DIC",20,20,"%D",4,0)
  Family (Last) Name (field #1)
"^DIC",20,20,"%D",5,0)
  Given (First) Name (field #2)
"^DIC",20,20,"%D",6,0)
  Middle Name (field #3) 
"^DIC",20,20,"%D",7,0)
  Prefix (field #4)
"^DIC",20,20,"%D",8,0)
  Suffix (field #5)
"^DIC",20,20,"%D",9,0)
  Degree (field #6)
"^DIC",20,20,"%D",10,0)
 
"^DIC",20,20,"%D",11,0)
The "source name" that has these components is identified by the following
"^DIC",20,20,"%D",12,0)
three fields:
"^DIC",20,20,"%D",13,0)
                                                      
"^DIC",20,20,"%D",14,0)
  File (field #.01)
"^DIC",20,20,"%D",15,0)
  Field (field #.02)
"^DIC",20,20,"%D",16,0)
  IENS (field #.03)
"^DIC",20,20,"%D",17,0)
 
"^DIC",20,20,"%D",18,0)
The "ANAME" cross-reference on the Family (Last) Name, Given (First) Name,
"^DIC",20,20,"%D",19,0)
Middle Name, and Suffix fields keeps each component in synchronization
"^DIC",20,20,"%D",20,0)
with the corresponding source name. In the case of Patch XU*8.0*134, the
"^DIC",20,20,"%D",21,0)
source name is the .01 field (the Name field) of the NEW PERSON file
"^DIC",20,20,"%D",22,0)
(#200).
"^DIC",20,20,"%D",23,0)
 
"^DIC",20,20,"%D",24,0)
The Degree and Prefix fields are not considered part of a standard name,
"^DIC",20,20,"%D",25,0)
but can be used to build formatted names for display.
"^DIC",20,"B","NAME COMPONENTS",20)

**END**
**END**
