$TXT Created by GARCIA,JOSE LUIS JR at NXT.KERNEL.FO-OAKLAND.MED.VA.GOV  (KIDS) on Tuesday, 06/22/04 at 11:32
=============================================================================
Run Date: DEC 09, 2004                     Designation: HL*1.6*117
Package : HL - HEALTH LEVEL SEVEN             Priority: Mandatory
Version : 1.6        SEQ #97                    Status: Released
                  Compliance Date: JAN 09, 2005
=============================================================================

Associated patches: (v)HL*1.6*116  <<= must be installed BEFORE `HL*1.6*117'

Subject: Duplicate Messages and HLL Array

Category: 
  - Routine

Description:
============

 This patch addresses three problems: 1) rejecting duplicate incoming
 messages that have an alphanumeric message control id, 2) missing message
 header when building a commit acknowledgment, and 3) setting of the HLL
 array when building an application acknowledgement.
  
 1) Duplicate Messages:  Before, the HL7 package was able to detect
 duplicate messages only for numeric message control ids provided that the 
 first character(s) is not blank/null, and for alphanumeric message ids:
  
    (a) If the leading character(s) is a zero, followed by another numeric 
        other than zero, the zero/zeroes is not recognized, and the
        alphanumeric message id is considered a duplicate.
    (b) If the leading character(s) is a zero, followed by a non-numeric,
        the zero/zeroes is not recognized, and the alphanumeric message id
        is not considered a duplicate.
    (c) If the leading character is a numeric other than zero, the 
        alphanumeric message id is considered a duplicate.
  
 2) Missing Message Header:  There was the potential that a commit
 acknowledge message be built without a message header if the process
 (listener connection) is terminated abnormally.  The current code changes
 minimize that potential. Another patch, HL*1.6*113, will allow listener
 connections to be terminated more gracefully.
  
 3) HLL Array: The HLL array has been used to build a list of recipients 
 and their logical links (subscribers) of an outgoing message.  The HLL
 array was also used, implicitly, to define the logical link needed to 
 return an application acknowledgement during an enhanced-mode exchange.  
 The HLL definition was performed dynamically by the HL7 package using the 
 value of the incoming messages SENDING FACILITY (dynamic addressing). 
  
 Some Processing Applications have opted to use and define on their own the
 HLL array.  To distinguish and prevent overriding of the HLL array, the
 current code changes allow the Processing Application to define the
 variable HLL("SET FOR APP ACK"), to distinguish that the HLL array is
 being defined by the Processing Routine and should not be overridden using
 dynamic addressing.
  
  
 NOISs Addressed:
 ================
 ISW-0803-21874     DUPLICATE APLL ACK NOT MARKED AS DUPLICATE
 UNY-0604-11331     HL*1.6*116 and routing of Lab application 
  
  
 Test sites:
 ===========
 UPSTATE NEW YORK HCS (VMS/CACHE)
 Bay Pines VAMC (ALPHA/DSM)
 MADISON VAMC ( ALPHA/DSM)
 SALT LAKE CITY VAMC (ALPHA/DSM)
  
  
 Routine Summary: 
 ================
 The following is a list of the routines included in this patch.  The 
 second line of each of these routines now looks like:
  
      <tab>;;1.6;HEALTH LEVEL SEVEN;**[patch list]**;Oct 13, 1995 
  
 Checksums: 
 ==========
                             CHECK^XTSUMBLD results
  Routine name      Before Patch      After Patch     Patch List
  ============      ============      ===========     ==========
  HLTP3              15431631            15874874     19,43,57,58,59,66,69,
                                                      109,115,108,116,117
  HLTP4               7921071             8299267     19,57,59,91,109,
                                                      116,117
  
  Installation Instructions (takes fewer than 10 minutes):
  =========================
    1.  Users are allowed to be on the system during the installation.
  
    2.  VMS SITES: Review your mapped routine set.  If any of the
        routines listed in the ROUTINE SUMMARY section are mapped, they
        should be removed from the mapped set at this time.
  
    3.  Shutdown all Logical Links, incoming and outgoing filers, and
        the Link Manager using the Filer and Link Management options
        listed below:
  
          Stop All Messaging Background Processes [HL STOP ALL]
          TCP Link Manager Start/Stop [HL START/STOP LINK MANAGER]
  
        VMS SITES ONLY: Disable all HL7-related OpenVMS TCPIP services 
        for this installation.
  
    4.  Use the 'INSTALL/CHECK MESSAGE' option on the PackMan menu. This
        option will load the KIDS package onto your system.
  
    5.  This patch is now loaded into a transport global on your
        system. The next step is to use KIDS to install the Transport
        global. To do this, use the 'Installation [XPD INSTALLATION 
        MENU]' menu.  You should use each of the following 'Installation'
        menu options in the order shown below:
  
          Verify Checksums in Transport Global
          Print Transport Global
          Compare Transport Global to Current System
          Backup a Transport Global
          Install Package(s)
  
        When using the 'Install Package(s)' menu option to install 
        the patch build, you will be asked several questions.  The 
        questions asked, and the answers you should supply, are 
        shown below.
  
          INSTALL NAME: <HL*1.6*117>
          Want KIDS to INHIBIT LOGONS during the install?  <NO>
          Want to DISABLE Scheduled Options, Menu Options, and
          Protocols?  <NO>
  
    6.  Start up all Logical Links and incoming and outgoing filers using
        the Filer and Link Management Option's 'Restart/Start All Links
        and Filers [HL TASK RESTART]' menu option.
  
        (Note that links that do not have "autostart" enabled will need
        to be restarted manually.)
  
        VMS Sites:  If you previously disabled an HL7-related TCPIP OpenVMS
        service for this installation, you may enable it now.
  
    7.  VMS Sites:  After the patch has been installed, rebuild your
        map set, if necessary.
  
    8.  Start Link Manager using the 'TCP Link Manager Start/Stop [HL
        START/STOP LINK MANAGER]' menu option. 

Routine Information:
====================

Routine Name:
  - HLTP3


Routine Checksum:

Routine Name:
  - HLTP4


Routine Checksum:

=============================================================================
User Information:
Entered By  : GARCIA,JOSE                   Date Entered  : MAY 14, 2004
Completed By: SINGH,GURBIR                  Date Completed: DEC 09, 2004
Released By : GAYFIELD,LISA                 Date Released : DEC 09, 2004
=============================================================================


Packman Mail Message:
=====================

$END TXT
