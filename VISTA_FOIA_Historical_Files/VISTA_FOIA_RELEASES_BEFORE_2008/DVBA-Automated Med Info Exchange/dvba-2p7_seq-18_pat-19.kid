Released DVBA*2.7*19 SEQ #18
Extracted from mail message
**KIDS**:DVBA*2.7*19^

**INSTALL NAME**
DVBA*2.7*19
"BLD",829,0)
DVBA*2.7*19^AUTOMATED MED INFO EXCHANGE^0^2980323^y
"BLD",829,1,0)
^^1^1^2980323^
"BLD",829,1,1,0)
DVBA*2.7*19
"BLD",829,4,0)
^9.64PA^^
"BLD",829,"ABPKG")
n
"BLD",829,"KRN",0)
^9.67PA^19^18
"BLD",829,"KRN",.4,0)
.4
"BLD",829,"KRN",.401,0)
.401
"BLD",829,"KRN",.402,0)
.402
"BLD",829,"KRN",.403,0)
.403
"BLD",829,"KRN",.5,0)
.5
"BLD",829,"KRN",.84,0)
.84
"BLD",829,"KRN",3.6,0)
3.6
"BLD",829,"KRN",3.8,0)
3.8
"BLD",829,"KRN",9.2,0)
9.2
"BLD",829,"KRN",9.8,0)
9.8
"BLD",829,"KRN",9.8,"NM",0)
^9.68A^6^6
"BLD",829,"KRN",9.8,"NM",1,0)
DVBCADR^^0^B24309942
"BLD",829,"KRN",9.8,"NM",2,0)
DVBCIRP1^^0^B26955639
"BLD",829,"KRN",9.8,"NM",3,0)
DVBCIRPT^^0^B15151300
"BLD",829,"KRN",9.8,"NM",4,0)
DVBCIUTL^^0^B22268963
"BLD",829,"KRN",9.8,"NM",5,0)
DVBCNTSC^^0^B13019940
"BLD",829,"KRN",9.8,"NM",6,0)
DVBCREQ1^^0^B14736469
"BLD",829,"KRN",9.8,"NM","B","DVBCADR",1)

"BLD",829,"KRN",9.8,"NM","B","DVBCIRP1",2)

"BLD",829,"KRN",9.8,"NM","B","DVBCIRPT",3)

"BLD",829,"KRN",9.8,"NM","B","DVBCIUTL",4)

"BLD",829,"KRN",9.8,"NM","B","DVBCNTSC",5)

"BLD",829,"KRN",9.8,"NM","B","DVBCREQ1",6)

"BLD",829,"KRN",19,0)
19
"BLD",829,"KRN",19.1,0)
19.1
"BLD",829,"KRN",101,0)
101
"BLD",829,"KRN",409.61,0)
409.61
"BLD",829,"KRN",771,0)
771
"BLD",829,"KRN",869.2,0)
869.2
"BLD",829,"KRN",870,0)
870
"BLD",829,"KRN",8994,0)
8994
"BLD",829,"KRN","B",.4,.4)

"BLD",829,"KRN","B",.401,.401)

"BLD",829,"KRN","B",.402,.402)

"BLD",829,"KRN","B",.403,.403)

"BLD",829,"KRN","B",.5,.5)

"BLD",829,"KRN","B",.84,.84)

"BLD",829,"KRN","B",3.6,3.6)

"BLD",829,"KRN","B",3.8,3.8)

"BLD",829,"KRN","B",9.2,9.2)

"BLD",829,"KRN","B",9.8,9.8)

"BLD",829,"KRN","B",19,19)

"BLD",829,"KRN","B",19.1,19.1)

"BLD",829,"KRN","B",101,101)

"BLD",829,"KRN","B",409.61,409.61)

"BLD",829,"KRN","B",771,771)

"BLD",829,"KRN","B",869.2,869.2)

"BLD",829,"KRN","B",870,870)

"BLD",829,"KRN","B",8994,8994)

"BLD",829,"QUES",0)
^9.62^^
"BLD",829,"REQB",0)
^9.611^2^2
"BLD",829,"REQB",1,0)
DVBA*2.7*13^2
"BLD",829,"REQB",2,0)
DVBA*2.7*17^2
"BLD",829,"REQB","B","DVBA*2.7*13",1)

"BLD",829,"REQB","B","DVBA*2.7*17",2)

"OER",223,0)
223^DVBA
"OER",223,1,0)
^100.9951PA^5^5
"OER",223,1,1,0)
634
"OER",223,1,1,1,0)
^100.99511PA^1^1
"OER",223,1,1,1,1,0)
1106
"OER",223,1,2,0)
635
"OER",223,1,2,1,0)
^100.99511PA^1^1
"OER",223,1,2,1,1,0)
1106
"OER",223,1,3,0)
644
"OER",223,1,3,1,0)
^100.99511PA^1^1
"OER",223,1,3,1,1,0)
1106
"OER",223,1,4,0)
642
"OER",223,1,4,1,0)
^100.99511PA^2^2
"OER",223,1,4,1,1,0)
1106
"OER",223,1,4,1,2,0)
1303
"OER",223,1,5,0)
1305
"OER",223,1,5,1,0)
^100.99511PA^1^1
"OER",223,1,5,1,1,0)
414
"PKG",223,-1)
1^1
"PKG",223,0)
AUTOMATED MED INFO EXCHANGE^DVBA^The entire AMIE package 7131/2507.
"PKG",223,22,0)
^9.49I^1^1
"PKG",223,22,1,0)
2.7^2950410^2950508
"PKG",223,22,1,"PAH",1,0)
19^2980323
"PKG",223,22,1,"PAH",1,1,0)
^^1^1^2980401
"PKG",223,22,1,"PAH",1,1,1,0)
DVBA*2.7*19
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
6
"RTN","DVBCADR")
0^1^B24309942
"RTN","DVBCADR",1,0)
DVBCADR ;ALB/JLU-editing the address ;1/28/93
"RTN","DVBCADR",2,0)
 ;;2.7;AMIE;**19**;Apr 10, 1995
"RTN","DVBCADR",3,0)
 ;
"RTN","DVBCADR",4,0)
EN ;driver of the program
"RTN","DVBCADR",5,0)
 S DVBCSTP=0
"RTN","DVBCADR",6,0)
 F  DO  Q:DVBCSTP
"RTN","DVBCADR",7,0)
 .D PAT Q:DVBCSTP
"RTN","DVBCADR",8,0)
 .D INIT Q:DVBCSTP
"RTN","DVBCADR",9,0)
 .F  D GUTS Q:DVBCSTP1
"RTN","DVBCADR",10,0)
 .I DVBCMAL D MAIL
"RTN","DVBCADR",11,0)
 D EXIT
"RTN","DVBCADR",12,0)
 Q
"RTN","DVBCADR",13,0)
 ;
"RTN","DVBCADR",14,0)
GUTS ;this is the interloop or guts of the driver
"RTN","DVBCADR",15,0)
 D DISPL
"RTN","DVBCADR",16,0)
 D ASK
"RTN","DVBCADR",17,0)
 I 'Y S DVBCSTP1=1 Q
"RTN","DVBCADR",18,0)
 D QUES^DGRPU1(DVBCDFN,"ADD1")
"RTN","DVBCADR",19,0)
 I DGERR D ERROR Q
"RTN","DVBCADR",20,0)
 I DGCHANGE S DVBCMAL=1
"RTN","DVBCADR",21,0)
 D VDPTP
"RTN","DVBCADR",22,0)
 Q
"RTN","DVBCADR",23,0)
 ;
"RTN","DVBCADR",24,0)
EXIT ;cleans variables
"RTN","DVBCADR",25,0)
 K %H,DFN,DGCHANGE,DGERR,DIC,DIR,DVBC,DVBCDATE,DVBCDFN,DVBCLINE,DVBCMAL,DVBCPATN,DVBCSSN,DVBCSTP,DVBCSTP1,VAERR,VAPA,Y,XMTEXT,XMY,XMB,XMDUZ,XMSUB,DVBCX,DVBCML,DVBCSP,DVBCSP1,ER,J,C,PNAM,SSN,DVBCSSNO
"RTN","DVBCADR",26,0)
 K DVBTMP,XMBTEXT
"RTN","DVBCADR",27,0)
 Q
"RTN","DVBCADR",28,0)
 ;
"RTN","DVBCADR",29,0)
ERROR ;this is an erro printing subroutine
"RTN","DVBCADR",30,0)
 I DGERR W !,*7
"RTN","DVBCADR",31,0)
 Q
"RTN","DVBCADR",32,0)
 ;
"RTN","DVBCADR",33,0)
INIT ;initialize variables
"RTN","DVBCADR",34,0)
 I '$D(IOF) D HOME^%ZIS
"RTN","DVBCADR",35,0)
 K VAPA,DVBTMP,DVBC
"RTN","DVBCADR",36,0)
 S %H=$H
"RTN","DVBCADR",37,0)
 D YX^%DTC
"RTN","DVBCADR",38,0)
 S DVBCDATE=$P(Y,"@",1)
"RTN","DVBCADR",39,0)
 S $P(DVBCLINE,"_",80)=""
"RTN","DVBCADR",40,0)
 S SSN=$P(^DPT(DVBCDFN,0),U,9)
"RTN","DVBCADR",41,0)
 D SSNOUT^DVBCUTIL
"RTN","DVBCADR",42,0)
 S DVBCSSN=DVBCSSNO
"RTN","DVBCADR",43,0)
 D VDPTTMP
"RTN","DVBCADR",44,0)
 I VAERR S DVBCSTP=1 Q
"RTN","DVBCADR",45,0)
 I +VAPA(9) DO
"RTN","DVBCADR",46,0)
 .D STORTMP
"RTN","DVBCADR",47,0)
 .K VAPA
"RTN","DVBCADR",48,0)
 .D VDPTP
"RTN","DVBCADR",49,0)
 I VAERR S DVBCSTP=1 Q
"RTN","DVBCADR",50,0)
 D STORE
"RTN","DVBCADR",51,0)
 S (DVBCSTP1,DVBCMAL)=0
"RTN","DVBCADR",52,0)
 Q
"RTN","DVBCADR",53,0)
 ;
"RTN","DVBCADR",54,0)
PAT ;get the patient
"RTN","DVBCADR",55,0)
 S DIC="^DPT(",DIC(0)="AEMQ"
"RTN","DVBCADR",56,0)
 D ^DIC
"RTN","DVBCADR",57,0)
 I Y<0 S DVBCSTP=1 Q
"RTN","DVBCADR",58,0)
 S DVBCDFN=+Y,(PNAM,DVBCPATN)=$P(Y,U,2)
"RTN","DVBCADR",59,0)
 Q
"RTN","DVBCADR",60,0)
 ;
"RTN","DVBCADR",61,0)
DISPL ;the display subroutine
"RTN","DVBCADR",62,0)
 W @IOF
"RTN","DVBCADR",63,0)
 W "Edit Address Information",?35,$$SITE^DVBCUTL4,?67,DVBCDATE
"RTN","DVBCADR",64,0)
 W !,"Name: ",DVBCPATN,?54,"SSN: ",DVBCSSN
"RTN","DVBCADR",65,0)
 W !,DVBCLINE
"RTN","DVBCADR",66,0)
 W !,?9,"Permanent"
"RTN","DVBCADR",67,0)
 I $D(DVBTMP) DO
"RTN","DVBCADR",68,0)
 .W ?40,"Temporary:  ",$P(DVBTMP(9),U,2)
"RTN","DVBCADR",69,0)
 .I $P(DVBTMP(10),U,2)]"" W " to ",$P(DVBTMP(10),U,2)
"RTN","DVBCADR",70,0)
 W !,"Address: ",$E(VAPA(1),1,29)
"RTN","DVBCADR",71,0)
 I $D(DVBTMP) W ?40,$E(DVBTMP(1),1,29)
"RTN","DVBCADR",72,0)
 W !,?9,$E(VAPA(2),1,29)
"RTN","DVBCADR",73,0)
 I $D(DVBTMP) W ?40,$E(DVBTMP(2),1,29)
"RTN","DVBCADR",74,0)
 W !,?9,$E(VAPA(3),1,29)
"RTN","DVBCADR",75,0)
 I $D(DVBTMP) W ?40,$E(DVBTMP(3),1,29)
"RTN","DVBCADR",76,0)
 W !,"City:",?9,VAPA(4)
"RTN","DVBCADR",77,0)
 I $D(DVBTMP) W ?40,DVBTMP(4)
"RTN","DVBCADR",78,0)
 W !,"State:",?9,$P(VAPA(5),U,2)
"RTN","DVBCADR",79,0)
 I $D(DVBTMP) W ?40,$P(DVBTMP(5),U,2)
"RTN","DVBCADR",80,0)
 W !,"Zip+4:",?9,$S($D(VAPA(11)):$P(VAPA(11),"^",2),1:"")
"RTN","DVBCADR",81,0)
 I $D(DVBTMP) W ?40,DVBTMP(11)
"RTN","DVBCADR",82,0)
 W !,"County:",?9,$P(VAPA(7),U,2)
"RTN","DVBCADR",83,0)
 I $D(DVBTMP) W ?40,$P(DVBTMP(7),U,2)
"RTN","DVBCADR",84,0)
 W !,"Phone:",?9,VAPA(8)
"RTN","DVBCADR",85,0)
 I $D(DVBTMP) W ?40,DVBTMP(8)
"RTN","DVBCADR",86,0)
 W !,"Office:",?9,VAPA(9999)
"RTN","DVBCADR",87,0)
 W !,DVBCLINE
"RTN","DVBCADR",88,0)
 Q
"RTN","DVBCADR",89,0)
 ;
"RTN","DVBCADR",90,0)
ASK ;ask if yes or no
"RTN","DVBCADR",91,0)
 S DIR(0)="Y",DIR("A")="Do you wish to edit this address:",DIR("B")="YES"
"RTN","DVBCADR",92,0)
 D ^DIR
"RTN","DVBCADR",93,0)
 Q
"RTN","DVBCADR",94,0)
 ;
"RTN","DVBCADR",95,0)
STORE ;store original address fro possible bulletin
"RTN","DVBCADR",96,0)
 S DVBC(1)=VAPA(1),DVBC(2)=VAPA(2),DVBC(3)=VAPA(3)
"RTN","DVBCADR",97,0)
 S DVBC(4)=VAPA(4),DVBC(5)=$P(VAPA(5),U,2)
"RTN","DVBCADR",98,0)
 S DVBC(11)=$S($D(VAPA(11)):$P(VAPA(11),"^",2),1:"")
"RTN","DVBCADR",99,0)
 S DVBC(7)=$P(VAPA(7),U,2),DVBC(8)=VAPA(8)
"RTN","DVBCADR",100,0)
 S DVBC(9999)=VAPA(9999)
"RTN","DVBCADR",101,0)
 Q
"RTN","DVBCADR",102,0)
 ;
"RTN","DVBCADR",103,0)
VDPTP ;gets the permanent address
"RTN","DVBCADR",104,0)
 S VAPA("P")=""
"RTN","DVBCADR",105,0)
VDPTTMP ;gets the temporary address if one
"RTN","DVBCADR",106,0)
 S DFN=DVBCDFN
"RTN","DVBCADR",107,0)
 D ADD^VADPT
"RTN","DVBCADR",108,0)
 S VAPA(9999)=$S($D(^DPT(DFN,.13)):$P(^(.13),U,2),1:"")
"RTN","DVBCADR",109,0)
 Q
"RTN","DVBCADR",110,0)
 ;
"RTN","DVBCADR",111,0)
STORTMP ;saves the active temporary address
"RTN","DVBCADR",112,0)
 S DVBTMP(1)=VAPA(1),DVBTMP(2)=VAPA(2),DVBTMP(3)=VAPA(3),DVBTMP(4)=VAPA(4)
"RTN","DVBCADR",113,0)
 S DVBTMP(5)=VAPA(5),DVBTMP(11)=$S($D(VAPA(11)):$P(VAPA(11),"^",2),1:"")
"RTN","DVBCADR",114,0)
 S DVBTMP(7)=VAPA(7),DVBTMP(8)=VAPA(8)
"RTN","DVBCADR",115,0)
 S DVBTMP(9)=VAPA(9),DVBTMP(10)=VAPA(10)
"RTN","DVBCADR",116,0)
 Q
"RTN","DVBCADR",117,0)
 ;
"RTN","DVBCADR",118,0)
MAIL ;to fire a bulletin if necessary
"RTN","DVBCADR",119,0)
 S XMDUZ="AMIE Package",XMSUB="Edit of patient address"
"RTN","DVBCADR",120,0)
 S XMB(1)=DVBCPATN_"   SSN: "_DVBCSSN,XMB(2)=DVBCDATE,XMB(3)=$P(^VA(200,DUZ,0),U,1)
"RTN","DVBCADR",121,0)
 S XMB="DVBA C EDIT ADDRESS"
"RTN","DVBCADR",122,0)
 D XMT
"RTN","DVBCADR",123,0)
 S XMTEXT="DVBCML("
"RTN","DVBCADR",124,0)
 D ^XMB
"RTN","DVBCADR",125,0)
 K XMBTEXT,XMTEXT,XMB,XMSUB
"RTN","DVBCADR",126,0)
 W !!,"A bulletin has been sent to the appropriate mail group regarding this",!,"address change!"
"RTN","DVBCADR",127,0)
 Q
"RTN","DVBCADR",128,0)
 ;
"RTN","DVBCADR",129,0)
XMT ;make the text of the bulletin
"RTN","DVBCADR",130,0)
 S DVBCX=1 D LIN
"RTN","DVBCADR",131,0)
 S DVBCML(1)="ADDR.:  "_DVBC(1)_DVBCSP_VAPA(1)
"RTN","DVBCADR",132,0)
 S DVBCX=2 D LIN
"RTN","DVBCADR",133,0)
 S DVBCML(2)="        "_DVBC(2)_DVBCSP_VAPA(2)
"RTN","DVBCADR",134,0)
 S DVBCX=3 D LIN
"RTN","DVBCADR",135,0)
 S DVBCML(3)="        "_DVBC(3)_DVBCSP_VAPA(3)
"RTN","DVBCADR",136,0)
 S DVBCX=4 D LIN
"RTN","DVBCADR",137,0)
 S DVBCML(4)="City:   "_DVBC(4)_DVBCSP_VAPA(4)
"RTN","DVBCADR",138,0)
 S DVBCX=5 D LIN
"RTN","DVBCADR",139,0)
 S DVBCML(5)="State:  "_DVBC(5)_DVBCSP_$P(VAPA(5),U,2)
"RTN","DVBCADR",140,0)
 S DVBCX=11 D LIN
"RTN","DVBCADR",141,0)
 S DVBCML(6)="Zip+4:  "_DVBC(11)_DVBCSP_$S($D(VAPA(11)):$P(VAPA(11),"^",2),1:"")
"RTN","DVBCADR",142,0)
 S DVBCX=7 D LIN
"RTN","DVBCADR",143,0)
 S DVBCML(7)="County: "_DVBC(7)_DVBCSP_$P(VAPA(7),U,2)
"RTN","DVBCADR",144,0)
 S DVBCX=8 D LIN
"RTN","DVBCADR",145,0)
 S DVBCML(8)="Phone:  "_DVBC(8)_DVBCSP_VAPA(8)
"RTN","DVBCADR",146,0)
 S DVBCX=9999 D LIN
"RTN","DVBCADR",147,0)
 S DVBCML(9)="Office: "_DVBC(9999)_DVBCSP_VAPA(9999)
"RTN","DVBCADR",148,0)
 Q
"RTN","DVBCADR",149,0)
 ;
"RTN","DVBCADR",150,0)
LIN ;makes spaces
"RTN","DVBCADR",151,0)
 K DVBCSP,DVBCSP1
"RTN","DVBCADR",152,0)
 S DVBCSP1=37-$L(DVBC(DVBCX))
"RTN","DVBCADR",153,0)
 S $P(DVBCSP," ",DVBCSP1)=""
"RTN","DVBCADR",154,0)
 Q
"RTN","DVBCIRP1")
0^2^B26955639
"RTN","DVBCIRP1",1,0)
DVBCIRP1 ;ALB/GTS-AMIE INSUFFICIENT 2507 RPT -CONT 1 ; 11/10/94  1:30 PM
"RTN","DVBCIRP1",2,0)
 ;;2.7;AMIE;**13,19**;Apr 10, 1995
"RTN","DVBCIRP1",3,0)
 ;
"RTN","DVBCIRP1",4,0)
 ;** Version Changes
"RTN","DVBCIRP1",5,0)
 ;   2.7 - New routine (Enhc 15)
"RTN","DVBCIRP1",6,0)
 ;
"RTN","DVBCIRP1",7,0)
SUMRPT ;**Output the summary report
"RTN","DVBCIRP1",8,0)
 W:IOST?1"C-".E @IOF
"RTN","DVBCIRP1",9,0)
 D SUMHD
"RTN","DVBCIRP1",10,0)
 ;print request data
"RTN","DVBCIRP1",11,0)
 W !?3,"Total 2507 requests received for date range:",?71,$J(DVBARQCT,5)
"RTN","DVBCIRP1",12,0)
 W !?3,"Total insufficient 2507 requests received for date range:",?71,$J(DVBAINRQ,5)
"RTN","DVBCIRP1",13,0)
 W !?3,"Total insufficient 2507 requests cancelled by RO for date range:",?71,$J(DVBACAN("REQ"),5)
"RTN","DVBCIRP1",14,0)
 I DVBARQCT>0 D
"RTN","DVBCIRP1",15,0)
 .S PERCENT=(DVBAINRQ/DVBARQCT)*100
"RTN","DVBCIRP1",16,0)
 .W !?3,"% of insufficient requests per total requests received:",?71,$J(PERCENT,5,1)_"%"
"RTN","DVBCIRP1",17,0)
 .S PERCENT=((DVBAINRQ-DVBACAN("REQ"))/DVBARQCT)*100
"RTN","DVBCIRP1",18,0)
 .W !?3,"% of uncancelled insufficient requests per total requests received:",?71,$J(PERCENT,5,1)_"%"
"RTN","DVBCIRP1",19,0)
 I DVBARQCT'>0 D
"RTN","DVBCIRP1",20,0)
 .S PERCENT=0
"RTN","DVBCIRP1",21,0)
 .W !?3,"% of insufficient requests per total requests received:",?71,$J(PERCENT,5,1)_"%"
"RTN","DVBCIRP1",22,0)
 .W !?3,"% of uncancelled insufficient requests per total requests received:",?71,$J(PERCENT,5,1)_"%"
"RTN","DVBCIRP1",23,0)
 ;print exam data
"RTN","DVBCIRP1",24,0)
 W !!?3,"Total 2507 exams received for date range:",?71,$J(DVBAXMCT,5)
"RTN","DVBCIRP1",25,0)
 W !?3,"Total insufficient 2507 exams received for date range:",?71,$J(DVBAINXM,5)
"RTN","DVBCIRP1",26,0)
 W !?3,"Total insufficient 2507 exams cancelled by RO for date range:",?71,$J(DVBACAN("EXM"),5)
"RTN","DVBCIRP1",27,0)
 I DVBAXMCT>0 D
"RTN","DVBCIRP1",28,0)
 .S PERCENT=(DVBAINXM/DVBAXMCT)*100
"RTN","DVBCIRP1",29,0)
 .W !?3,"% of insufficient exams per total exams received:",?71,$J(PERCENT,5,1)_"%"
"RTN","DVBCIRP1",30,0)
 .S PERCENT=((DVBAINXM-DVBACAN("EXM"))/DVBAXMCT)*100
"RTN","DVBCIRP1",31,0)
 .W !?3,"% of uncancelled insufficient exams per total exams received:",?71,$J(PERCENT,5,1)_"%"
"RTN","DVBCIRP1",32,0)
 I DVBAXMCT'>0 D
"RTN","DVBCIRP1",33,0)
 .S PERCENT=0
"RTN","DVBCIRP1",34,0)
 .W !?3,"% of insufficient exams per total exams received:",?71,$J(PERCENT,5,1)_"%"
"RTN","DVBCIRP1",35,0)
 .W !?3,"% of uncancelled insufficient exams per total exams received:",?71,$J(PERCENT,5,1)_"%"
"RTN","DVBCIRP1",36,0)
 ;print insufficient reason data
"RTN","DVBCIRP1",37,0)
 I IOST?1"C-".E DO
"RTN","DVBCIRP1",38,0)
 .K DTOUT,DUOUT
"RTN","DVBCIRP1",39,0)
 .W !!
"RTN","DVBCIRP1",40,0)
 .D PAUSE^DVBCUTL4
"RTN","DVBCIRP1",41,0)
 .I '$D(DTOUT),('$D(DUOUT)) DO
"RTN","DVBCIRP1",42,0)
 ..W @IOF
"RTN","DVBCIRP1",43,0)
 ..D SUMHD
"RTN","DVBCIRP1",44,0)
 I '$D(DTOUT),('$D(DUOUT)) DO
"RTN","DVBCIRP1",45,0)
 .W:IOST'?1"C-".E !!
"RTN","DVBCIRP1",46,0)
 .W !?15,"Summary of insufficient exams per Reason",!
"RTN","DVBCIRP1",47,0)
 .W !?3,"Reason",?53,"Num",?59,"Percent"
"RTN","DVBCIRP1",48,0)
 .N DVBARSLP S DVBARSLP=""
"RTN","DVBCIRP1",49,0)
 .F  S DVBARSLP=$O(DVBAINXM(DVBARSLP)) Q:DVBARSLP=""  DO  ;**Reason tot's
"RTN","DVBCIRP1",50,0)
 ..W:+DVBARSLP>0 !?3,$P(^DVB(396.94,DVBARSLP,0),U,3),?53,DVBAINXM(DVBARSLP)
"RTN","DVBCIRP1",51,0)
 ..I +DVBARSLP'>0,(+DVBAINXM(DVBARSLP)>0) W !?3,"Exams without insufficient reason indicated",?53,DVBAINXM(DVBARSLP)
"RTN","DVBCIRP1",52,0)
 ..W:(+DVBAINXM(DVBARSLP)>0&(DVBAINXM>0)) ?59,($P(((DVBAINXM(DVBARSLP)/DVBAINXM)*100),".",1))_$S($E($P(((DVBAINXM(DVBARSLP)/DVBAINXM)*100),".",2),1,1)'="":"."_$E($P(((DVBAINXM(DVBARSLP)/DVBAINXM)*100),".",2),1,1),1:"")_" %"
"RTN","DVBCIRP1",53,0)
 .I IOST?1"C-".E DO
"RTN","DVBCIRP1",54,0)
 ..D CONTMES^DVBCUTL4
"RTN","DVBCIRP1",55,0)
 Q
"RTN","DVBCIRP1",56,0)
 ;
"RTN","DVBCIRP1",57,0)
SUMHD ;** Output Summary Report heading
"RTN","DVBCIRP1",58,0)
 N STRTDT,LSTDT
"RTN","DVBCIRP1",59,0)
 W !?15,"Summary Insufficient Exam Report for ",$$SITE^DVBCUTL4(),!
"RTN","DVBCIRP1",60,0)
 S Y=$P(BEGDT,".",1) X ^DD("DD") S STRTDT=Y K Y
"RTN","DVBCIRP1",61,0)
 S Y=$P(ENDDT,".",1) X ^DD("DD") S LSTDT=Y K Y
"RTN","DVBCIRP1",62,0)
 W !?16,"For Date Range: "_STRTDT_" to "_LSTDT,!
"RTN","DVBCIRP1",63,0)
 Q
"RTN","DVBCIRP1",64,0)
 ;
"RTN","DVBCIRP1",65,0)
DETAIL ;** Output reason, exam type and exam info
"RTN","DVBCIRP1",66,0)
 N STRTDT,LSTDT
"RTN","DVBCIRP1",67,0)
 S Y=$P(BEGDT,".",1) X ^DD("DD") S STRTDT=Y K Y
"RTN","DVBCIRP1",68,0)
 S Y=$P(ENDDT,".",1) X ^DD("DD") S LSTDT=Y K Y
"RTN","DVBCIRP1",69,0)
 U IO
"RTN","DVBCIRP1",70,0)
 S DVBADTLP=BEGDT
"RTN","DVBCIRP1",71,0)
 S DVBAENDL=ENDDT
"RTN","DVBCIRP1",72,0)
 D DETHD^DVBCIUTL
"RTN","DVBCIRP1",73,0)
 S RSDA=""
"RTN","DVBCIRP1",74,0)
 S DVBAPG1=""
"RTN","DVBCIRP1",75,0)
 F  S RSDA=$O(DVBAARY("REASON",RSDA)) Q:(RSDA=""!($D(GETOUT)))  DO
"RTN","DVBCIRP1",76,0)
 .K DVBARSPT
"RTN","DVBCIRP1",77,0)
 .S TPDA=""
"RTN","DVBCIRP1",78,0)
 .F  S TPDA=$O(^TMP($J,"XMTYPE",TPDA)) Q:(TPDA=""!($D(GETOUT)))  DO
"RTN","DVBCIRP1",79,0)
 ..K DVBAXMPT
"RTN","DVBCIRP1",80,0)
 ..S XMDA=""
"RTN","DVBCIRP1",81,0)
 ..F  S XMDA=$O(^DVB(396.4,"AIT",RSDA,TPDA,XMDA)) Q:(XMDA=""!($D(GETOUT)))  DO
"RTN","DVBCIRP1",82,0)
 ...I $P(^DVB(396.3,$P(^DVB(396.4,XMDA,0),U,2),0),U,5)>DVBADTLP,($P(^DVB(396.3,$P(^DVB(396.4,XMDA,0),U,2),0),U,5)<DVBAENDL) D EXMOUT^DVBCIUTL
"RTN","DVBCIRP1",83,0)
 I '$D(GETOUT),(IOST?1"C-".E) D CONTMES^DVBCUTL4
"RTN","DVBCIRP1",84,0)
 D KVARS ;**KILL the variables used by DETAIL
"RTN","DVBCIRP1",85,0)
 I $D(ZTQUEUED) D KVARS^DVBCIRPT,KILL^%ZTLOAD
"RTN","DVBCIRP1",86,0)
 Q
"RTN","DVBCIRP1",87,0)
 ;
"RTN","DVBCIRP1",88,0)
KVARS ;** Final Kill for Detail report
"RTN","DVBCIRP1",89,0)
 K ^TMP($J),DVBAARY,DVBANAME,DVBASSN,DVBACNUM,RSDA,TPDA,XMDA,DVBADTLP
"RTN","DVBCIRP1",90,0)
 K DVBAENDL,DVBARSPT,DVBAXMPT,REQDA,DFN,DVBAORXM,DVBAXMTP,DVBACMND
"RTN","DVBCIRP1",91,0)
 K DVBAORPV,DVBAORP1,DVBADTWK,DVBADTE,DVBAORDT,DVBANAM1,GETOUT
"RTN","DVBCIRP1",92,0)
 K DVBAARY,DVBAPG1,DVBARQDT,DVBAXDT,DVBAXRS
"RTN","DVBCIRP1",93,0)
 Q
"RTN","DVBCIRP1",94,0)
 ;
"RTN","DVBCIRP1",95,0)
DETSEL ;** Select the details to report
"RTN","DVBCIRP1",96,0)
 D RSEL^DVBCIUTL
"RTN","DVBCIRP1",97,0)
 I '$D(DVBAARY("REASON")) S DVBAQTSL=""
"RTN","DVBCIRP1",98,0)
 I $D(DVBAQTSL) DO
"RTN","DVBCIRP1",99,0)
 .S DIR("A",1)="You have not selected Insufficient reasons to report."
"RTN","DVBCIRP1",100,0)
 .S DIR("A",2)="This is required to print the Detailed report."
"RTN","DVBCIRP1",101,0)
 .S DIR("A",3)=" "
"RTN","DVBCIRP1",102,0)
 .S DIR(0)="FAO^1:1",DIR("A")="Hit Return to continue." D ^DIR K DIR,X,Y
"RTN","DVBCIRP1",103,0)
 I '$D(DVBAQTSL) DO
"RTN","DVBCIRP1",104,0)
 .D XMSEL^DVBCIUTL
"RTN","DVBCIRP1",105,0)
 .I '$D(^TMP($J,"XMTYPE")) S DVBAQTSL=""
"RTN","DVBCIRP1",106,0)
 .I $D(DVBAQTSL) DO
"RTN","DVBCIRP1",107,0)
 ..S DIR("A",1)="You have not selected Exams to report."
"RTN","DVBCIRP1",108,0)
 ..S DIR("A",2)="This is required to print the Detailed report."
"RTN","DVBCIRP1",109,0)
 ..S DIR("A",3)=" "
"RTN","DVBCIRP1",110,0)
 ..S DIR(0)="FAO^1:1",DIR("A")="Hit Return to continue." D ^DIR K DIR,X,Y
"RTN","DVBCIRP1",111,0)
 ..K DVBAARY("REASON")
"RTN","DVBCIRP1",112,0)
 Q
"RTN","DVBCIRP1",113,0)
 ;
"RTN","DVBCIRPT")
0^3^B15151300
"RTN","DVBCIRPT",1,0)
DVBCIRPT ;ALB/GTS-AMIE C&P INSUFF EXAM TRACKING RPT ; 11/9/94  2:00 PM
"RTN","DVBCIRPT",2,0)
 ;;2.7;AMIE;**13,19**;Apr 10, 1995
"RTN","DVBCIRPT",3,0)
 ;
"RTN","DVBCIRPT",4,0)
 ;** Version Changes
"RTN","DVBCIRPT",5,0)
 ;   2.7 - New routine (Enhc 15)
"RTN","DVBCIRPT",6,0)
 ;
"RTN","DVBCIRPT",7,0)
MAIN ;**Select Dte Rng & Rpt Type; call report routine
"RTN","DVBCIRPT",8,0)
 F  Q:$D(DVBAOUT)  DO
"RTN","DVBCIRPT",9,0)
 .D HOME^%ZIS
"RTN","DVBCIRPT",10,0)
 .S TVAR(1,0)="0,0,1,2:2,1^Insufficient 2507 Exam Report"
"RTN","DVBCIRPT",11,0)
 .D WR^DVBAUTL4("TVAR")
"RTN","DVBCIRPT",12,0)
 .K TVAR
"RTN","DVBCIRPT",13,0)
 .S RPTTYPE=$$RPTTYPE^DVBCUTA1()
"RTN","DVBCIRPT",14,0)
 .S:((RPTTYPE'="D")&(RPTTYPE'="S")) DVBAOUT=""
"RTN","DVBCIRPT",15,0)
 .W:'$D(DVBAOUT) !!
"RTN","DVBCIRPT",16,0)
 .D:'$D(DVBAOUT) DATE^DVBCUTL4(.BEGDT,.ENDDT)
"RTN","DVBCIRPT",17,0)
 .I $D(ENDDT),(+ENDDT>0) DO
"RTN","DVBCIRPT",18,0)
 ..S ENDDT=ENDDT_".2359"
"RTN","DVBCIRPT",19,0)
 ..I RPTTYPE="S" DO
"RTN","DVBCIRPT",20,0)
 ...D DEVSEL
"RTN","DVBCIRPT",21,0)
 ...I POP D SUMKILL
"RTN","DVBCIRPT",22,0)
 ...I 'POP DO
"RTN","DVBCIRPT",23,0)
 ....I $D(IO("Q")) DO
"RTN","DVBCIRPT",24,0)
 .....N DVBAI
"RTN","DVBCIRPT",25,0)
 .....S ZTRTN="SUM^DVBCIRPT",ZTIO=ION
"RTN","DVBCIRPT",26,0)
 .....S ZTDESC="Summary Insufficient Exam Report"
"RTN","DVBCIRPT",27,0)
 .....F DVBAI="BEGDT","ENDDT" S ZTSAVE(DVBAI)=""
"RTN","DVBCIRPT",28,0)
 .....D ^%ZTLOAD
"RTN","DVBCIRPT",29,0)
 .....I $D(ZTSK) W !!,"Summary Report Queued",!! K ZTSK D CONTMES^DVBCUTL4
"RTN","DVBCIRPT",30,0)
 .....D SUMKILL
"RTN","DVBCIRPT",31,0)
 ....I '$D(IO("Q")) D SUM
"RTN","DVBCIRPT",32,0)
 ...D ^%ZISC
"RTN","DVBCIRPT",33,0)
 ..I RPTTYPE="D" DO
"RTN","DVBCIRPT",34,0)
 ...D DETSEL^DVBCIRP1 ;**Select the Reasons and Exams to report
"RTN","DVBCIRPT",35,0)
 ...I '$D(DVBAQTSL) DO
"RTN","DVBCIRPT",36,0)
 ....D DEVSEL
"RTN","DVBCIRPT",37,0)
 ....I POP D KVARS^DVBCIRP1
"RTN","DVBCIRPT",38,0)
 ....I 'POP DO
"RTN","DVBCIRPT",39,0)
 .....I $D(IO("Q")) DO
"RTN","DVBCIRPT",40,0)
 ......N DVBAI
"RTN","DVBCIRPT",41,0)
 ......S ZTRTN="DETAIL^DVBCIRP1",ZTIO=ION
"RTN","DVBCIRPT",42,0)
 ......S ZTDESC="Detailed Insufficient Exam Report"
"RTN","DVBCIRPT",43,0)
 ......F DVBAI="BEGDT","ENDDT","DVBAARY(""REASON"",","^TMP($J,""XMTYPE""," S ZTSAVE(DVBAI)=""
"RTN","DVBCIRPT",44,0)
 ......D ^%ZTLOAD
"RTN","DVBCIRPT",45,0)
 ......I $D(ZTSK) W !!,"Detail Report Queued",!! K ZTSK D CONTMES^DVBCUTL4
"RTN","DVBCIRPT",46,0)
 ......D KVARS^DVBCIRP1
"RTN","DVBCIRPT",47,0)
 .....I '$D(IO("Q")) W:IOST?1"C-".E @IOF D DETAIL^DVBCIRP1
"RTN","DVBCIRPT",48,0)
 ....D ^%ZISC
"RTN","DVBCIRPT",49,0)
 ...K DVBAQTSL
"RTN","DVBCIRPT",50,0)
 ..D CLEANUP
"RTN","DVBCIRPT",51,0)
 D KVARS
"RTN","DVBCIRPT",52,0)
 Q
"RTN","DVBCIRPT",53,0)
 ;
"RTN","DVBCIRPT",54,0)
KVARS ;** Kill the variables used in report
"RTN","DVBCIRPT",55,0)
 K DVBAOUT,ENDDT,BEGDT,DTOUT,DUOUT,RPTTYPE,DVBACAN,DVBASTAT
"RTN","DVBCIRPT",56,0)
 D CLEANUP
"RTN","DVBCIRPT",57,0)
 Q
"RTN","DVBCIRPT",58,0)
 ;
"RTN","DVBCIRPT",59,0)
CLEANUP ;** Kill the variables used by the device handler
"RTN","DVBCIRPT",60,0)
 K %ZIS,POP,%IS,IOP
"RTN","DVBCIRPT",61,0)
 K IOBS,IOHG,IOPAR,IOUPAR,IOXY,POP,%DT,%YY,%XX,ION,IOPAR
"RTN","DVBCIRPT",62,0)
 Q
"RTN","DVBCIRPT",63,0)
 ;
"RTN","DVBCIRPT",64,0)
DEVSEL ;** Select the device to report to
"RTN","DVBCIRPT",65,0)
 S %ZIS="AEQ"
"RTN","DVBCIRPT",66,0)
 S %ZIS("A")="Output device: "
"RTN","DVBCIRPT",67,0)
 D ^%ZIS
"RTN","DVBCIRPT",68,0)
 Q
"RTN","DVBCIRPT",69,0)
 ;
"RTN","DVBCIRPT",70,0)
SUM ;** Set up reason counter array, count all 2507's received
"RTN","DVBCIRPT",71,0)
 U IO
"RTN","DVBCIRPT",72,0)
 S (DVBARQCT,DVBAINRQ,DVBAXMCT,DVBAINXM)=0
"RTN","DVBCIRPT",73,0)
 S DVBACAN("REQ")=0,DVBACAN("EXM")=0
"RTN","DVBCIRPT",74,0)
 S DVBAENDL=ENDDT
"RTN","DVBCIRPT",75,0)
 ;
"RTN","DVBCIRPT",76,0)
 ;** Initialize reason counter array
"RTN","DVBCIRPT",77,0)
 F DVBARIFN=0:0 S DVBARIFN=$O(^DVB(396.94,DVBARIFN)) Q:+DVBARIFN'>0  DO
"RTN","DVBCIRPT",78,0)
 .S DVBAINXM(DVBARIFN)=0
"RTN","DVBCIRPT",79,0)
 S DVBAINXM("NO REASON")=0
"RTN","DVBCIRPT",80,0)
 ;
"RTN","DVBCIRPT",81,0)
 ;** Count the total and insufficient number of exams and 2507 requests
"RTN","DVBCIRPT",82,0)
 S DVBADTLP=BEGDT-.0001
"RTN","DVBCIRPT",83,0)
 F  S DVBADTLP=$O(^DVB(396.3,"ADP",DVBADTLP)) Q:(DVBADTLP=""!(DVBADTLP>ENDDT))  DO
"RTN","DVBCIRPT",84,0)
 .S DVBAPRIO=""
"RTN","DVBCIRPT",85,0)
 .F  S DVBAPRIO=$O(^DVB(396.3,"ADP",DVBADTLP,DVBAPRIO)) Q:DVBAPRIO=""  DO
"RTN","DVBCIRPT",86,0)
 ..S DVBADALP=""
"RTN","DVBCIRPT",87,0)
 ..F  S DVBADALP=$O(^DVB(396.3,"ADP",DVBADTLP,DVBAPRIO,DVBADALP)) Q:DVBADALP=""  DO
"RTN","DVBCIRPT",88,0)
 ...S DVBARQCT=DVBARQCT+1
"RTN","DVBCIRPT",89,0)
 ...K DVBAINSF
"RTN","DVBCIRPT",90,0)
 ...I DVBAPRIO="E" DO
"RTN","DVBCIRPT",91,0)
 ....S DVBAINRQ=DVBAINRQ+1
"RTN","DVBCIRPT",92,0)
 ....I $P(^DVB(396.3,DVBADALP,0),U,18)="RX" S DVBACAN("REQ")=DVBACAN("REQ")+1
"RTN","DVBCIRPT",93,0)
 ....S DVBAINSF=""
"RTN","DVBCIRPT",94,0)
 ...S DVBAXMDA=""
"RTN","DVBCIRPT",95,0)
 ...F  S DVBAXMDA=$O(^DVB(396.4,"C",DVBADALP,DVBAXMDA)) Q:DVBAXMDA=""  DO
"RTN","DVBCIRPT",96,0)
 ....S DVBAXMCT=DVBAXMCT+1
"RTN","DVBCIRPT",97,0)
 ....I $D(DVBAINSF) DO
"RTN","DVBCIRPT",98,0)
 .....S DVBAINXM=DVBAINXM+1
"RTN","DVBCIRPT",99,0)
 .....S DVBARIFN=$P(^DVB(396.4,DVBAXMDA,0),U,11),DVBASTAT=$P(^(0),U,4)
"RTN","DVBCIRPT",100,0)
 .....S:DVBARIFN="" DVBARIFN="NO REASON"
"RTN","DVBCIRPT",101,0)
 .....S DVBAINXM(DVBARIFN)=DVBAINXM(DVBARIFN)+1
"RTN","DVBCIRPT",102,0)
 .....I DVBASTAT="RX" S DVBACAN("EXM")=DVBACAN("EXM")+1
"RTN","DVBCIRPT",103,0)
 D SUMRPT^DVBCIRP1
"RTN","DVBCIRPT",104,0)
 I $D(ZTQUEUED) D KVARS^DVBCIRPT,KILL^%ZTLOAD
"RTN","DVBCIRPT",105,0)
 D SUMKILL
"RTN","DVBCIRPT",106,0)
 Q
"RTN","DVBCIRPT",107,0)
 ;
"RTN","DVBCIRPT",108,0)
SUMKILL ;** Kill the variables used in the summary report
"RTN","DVBCIRPT",109,0)
 K DVBADTLP,DVBAENDL,DVBARQCT,DVBAINRQ,DVBAXMCT,DVBAINXM
"RTN","DVBCIRPT",110,0)
 K DVBAPRIO,DVBADALP,DVBAXMDA,DVBAINSF,DVBARIFN
"RTN","DVBCIRPT",111,0)
 Q
"RTN","DVBCIUTL")
0^4^B22268963
"RTN","DVBCIUTL",1,0)
DVBCIUTL ;ALB/GTS-AMIE INSUFFICIENT RPT UTILITY RTN ; 11/14/94  9:15 AM
"RTN","DVBCIUTL",2,0)
 ;;2.7;AMIE;**13,17,19**;Apr 10, 1995
"RTN","DVBCIUTL",3,0)
 ;
"RTN","DVBCIUTL",4,0)
 ;** Version Changes
"RTN","DVBCIUTL",5,0)
 ;   2.7 - New routine (Enhc 15)
"RTN","DVBCIUTL",6,0)
 ;
"RTN","DVBCIUTL",7,0)
DETHD ;** Detailed Report header
"RTN","DVBCIUTL",8,0)
 S:'$D(DVBAPG1) TVAR(1,0)="0,15,0,1,0^Detailed Insufficient Exam Report"
"RTN","DVBCIUTL",9,0)
 S:$D(DVBAPG1) TVAR(1,0)="0,15,0,1,1^Detailed Insufficient Exam Report"
"RTN","DVBCIUTL",10,0)
 S TVAR(2,0)="0,11,0,2,0^For Date Range: "_STRTDT_" to "_LSTDT
"RTN","DVBCIUTL",11,0)
 D WR^DVBAUTL4("TVAR")
"RTN","DVBCIUTL",12,0)
 K TVAR
"RTN","DVBCIUTL",13,0)
 Q
"RTN","DVBCIUTL",14,0)
 ;
"RTN","DVBCIUTL",15,0)
EXMOUT ;** Output exam information for reason/type
"RTN","DVBCIUTL",16,0)
 I $Y>(IOSL-9) DO
"RTN","DVBCIUTL",17,0)
 .I IOST?1"C-".E D TERM^DVBCUTL3
"RTN","DVBCIUTL",18,0)
 .I '$D(GETOUT) DO
"RTN","DVBCIUTL",19,0)
 ..D DETHD
"RTN","DVBCIUTL",20,0)
 ..D RESOUT
"RTN","DVBCIUTL",21,0)
 ..W !
"RTN","DVBCIUTL",22,0)
 ..D TYPEOUT
"RTN","DVBCIUTL",23,0)
 ..S (DVBARSPT,DVBAXMPT)=""
"RTN","DVBCIUTL",24,0)
 I '$D(GETOUT) DO
"RTN","DVBCIUTL",25,0)
 .I '$D(DVBARSPT) DO
"RTN","DVBCIUTL",26,0)
 ..D RESOUT
"RTN","DVBCIUTL",27,0)
 ..S DVBARSPT=""
"RTN","DVBCIUTL",28,0)
 .I '$D(DVBAXMPT) DO
"RTN","DVBCIUTL",29,0)
 ..W !
"RTN","DVBCIUTL",30,0)
 ..D TYPEOUT
"RTN","DVBCIUTL",31,0)
 ..S DVBAXMPT="",(DVBARQDT,DVBAXDT,DVBAXRS)=""
"RTN","DVBCIUTL",32,0)
 .S REQDA=$P(^DVB(396.4,XMDA,0),U,2) ;*REQDA of PRIORITY Insuf 2507
"RTN","DVBCIUTL",33,0)
 .I $D(^DVB(396.4,XMDA,"CAN")) D
"RTN","DVBCIUTL",34,0)
 ..S DVBAXDT=$P(^DVB(396.4,XMDA,"CAN"),U,1),DVBAXRS=$P(^("CAN"),U,3)
"RTN","DVBCIUTL",35,0)
 ..I DVBAXDT S DVBAXDT=$$FMTE^XLFDT(DVBAXDT,"5DZ")
"RTN","DVBCIUTL",36,0)
 ..I DVBAXRS S DVBAXRS=$P(^DVB(396.5,DVBAXRS,0),U,1)
"RTN","DVBCIUTL",37,0)
 .I +REQDA>0 DO  ;*Get REQDA of Orig 2507
"RTN","DVBCIUTL",38,0)
 ..S DFN=$P(^DVB(396.3,REQDA,0),U,1),DVBARQDT=$P(^(0),U,2),DVBARQDT=$$FMTE^XLFDT(DVBARQDT,"5DZ")
"RTN","DVBCIUTL",39,0)
 ..I '$D(^DVB(396.3,REQDA,5)) S REQDA=""
"RTN","DVBCIUTL",40,0)
 ..I +REQDA>0,($D(^DVB(396.3,REQDA,5))) S REQDA=$P(^DVB(396.3,REQDA,5),U,1)
"RTN","DVBCIUTL",41,0)
 .S DVBAORXM=""
"RTN","DVBCIUTL",42,0)
 .I +REQDA>0 DO  ;*If link to orig 2507
"RTN","DVBCIUTL",43,0)
 ..S DVBAXMTP=$P(^DVB(396.4,XMDA,0),U,3)
"RTN","DVBCIUTL",44,0)
 ..S DVBACMND="F  S DVBAORXM=$O(^DVB(396.4,""ARQ"_REQDA_""","_DVBAXMTP_",DVBAORXM)) Q:DVBAORXM=""""  Q:$D(^DVB(396.4,""APS"","_DFN_","_DVBAXMTP_",""C"",DVBAORXM))"
"RTN","DVBCIUTL",45,0)
 ..X DVBACMND ;**Return DA of original, insuff exam
"RTN","DVBCIUTL",46,0)
 .S DVBANAME=$P(^DPT(DFN,0),U,1)
"RTN","DVBCIUTL",47,0)
 .S DVBASSN=$P(^DPT(DFN,0),U,9)
"RTN","DVBCIUTL",48,0)
 .S DVBACNUM="" S:$D(^DPT(DFN,.31)) DVBACNUM=$P(^DPT(DFN,.31),U,3)
"RTN","DVBCIUTL",49,0)
 .I DVBAORXM'="",($D(^DVB(396.4,DVBAORXM,0))) S DVBAORDT=$P(^DVB(396.4,DVBAORXM,0),U,6)
"RTN","DVBCIUTL",50,0)
 .I DVBAORXM'="",('$D(^DVB(396.4,DVBAORXM,0))) S (DVBAORDT,DVBADTE)=""
"RTN","DVBCIUTL",51,0)
 .S:DVBAORXM="" (DVBAORDT,DVBADTE)=""
"RTN","DVBCIUTL",52,0)
 .I DVBAORDT'="" DO
"RTN","DVBCIUTL",53,0)
 ..S DVBADTWK=$P(DVBAORDT,".",1)
"RTN","DVBCIUTL",54,0)
 ..S DVBADTE=$$FMTE^XLFDT(DVBADTWK,"5DZ")
"RTN","DVBCIUTL",55,0)
 .S DVBAORPV=$P(^DVB(396.4,XMDA,0),U,12)
"RTN","DVBCIUTL",56,0)
 .S DVBAORP1=$E(DVBAORPV,1,15)
"RTN","DVBCIUTL",57,0)
 .S DVBANAM1=$E(DVBANAME,1,15)
"RTN","DVBCIUTL",58,0)
 .W !,DVBAORP1
"RTN","DVBCIUTL",59,0)
 .W:$L(DVBAORPV)>$L(DVBAORP1) "**" ;**Indicate that Dr.'s Name truncated
"RTN","DVBCIUTL",60,0)
 .W ?20,DVBADTE,?32,DVBANAM1
"RTN","DVBCIUTL",61,0)
 .W:$L(DVBANAME)>$L(DVBANAM1) "**" ;**Indicate that Vet's Name truncated
"RTN","DVBCIUTL",62,0)
 .W ?52,DVBASSN,?66,DVBACNUM
"RTN","DVBCIUTL",63,0)
 .I DVBAXDT]"" D
"RTN","DVBCIUTL",64,0)
 ..W !,"Exam request of "_DVBARQDT_" to correct insufficiency was cancelled on "_DVBAXDT_"."
"RTN","DVBCIUTL",65,0)
 ..W !,"Reason: "_DVBAXRS_"."
"RTN","DVBCIUTL",66,0)
 Q
"RTN","DVBCIUTL",67,0)
 ;
"RTN","DVBCIUTL",68,0)
RESOUT ;** Output the Reason
"RTN","DVBCIUTL",69,0)
 W !!!!!,"Reason: ",$P(^DVB(396.94,$P(^DVB(396.4,XMDA,0),U,11),0),U,3)
"RTN","DVBCIUTL",70,0)
 Q
"RTN","DVBCIUTL",71,0)
 ;
"RTN","DVBCIUTL",72,0)
TYPEOUT ;** Output the Exam
"RTN","DVBCIUTL",73,0)
 W !,"Exam: ",$P(^DVB(396.6,$P(^DVB(396.4,XMDA,0),U,3),0),U,2)
"RTN","DVBCIUTL",74,0)
 W !,"Provider",?20,"Exam Dt",?32,"Patient Name",?52,"SSN",?66,"Claim #"
"RTN","DVBCIUTL",75,0)
 Q
"RTN","DVBCIUTL",76,0)
 ;
"RTN","DVBCIUTL",77,0)
RSEL ;** Select Reasons
"RTN","DVBCIUTL",78,0)
 ;** The selection prompt is defaulted to ALL.  If the user selects
"RTN","DVBCIUTL",79,0)
 ;**  'All', only reasons for exams entered on requests with a
"RTN","DVBCIUTL",80,0)
 ;**  priority of 'Insufficient' will be reported.  Not all reasons.
"RTN","DVBCIUTL",81,0)
 ;
"RTN","DVBCIUTL",82,0)
 W @IOF,!
"RTN","DVBCIUTL",83,0)
 W !,"Insufficient Reason Selection"
"RTN","DVBCIUTL",84,0)
 S DVBCYQ=""
"RTN","DVBCIUTL",85,0)
 N RESANS,DVBAOUT S DVBAOUT="" ;**Pre-read
"RTN","DVBCIUTL",86,0)
 K Y,DTOUT,DUOUT,DVBATSAV
"RTN","DVBCIUTL",87,0)
 F  Q:(DVBAOUT=1!(DVBCYQ=1))  DO
"RTN","DVBCIUTL",88,0)
 .W !!,"  Enter '^' to end Reason Selection"
"RTN","DVBCIUTL",89,0)
 .W !,"  'Return' to select all Insufficient Reasons",!
"RTN","DVBCIUTL",90,0)
 .K DIC,DTOUT,DUOUT,Y
"RTN","DVBCIUTL",91,0)
 .W !,"  Enter Insufficient Reason: ALL//"
"RTN","DVBCIUTL",92,0)
 .R RESANS:DTIME
"RTN","DVBCIUTL",93,0)
 .S:$T DVBATSAV=""
"RTN","DVBCIUTL",94,0)
 .I RESANS=""&($D(DVBATSAV)) S Y=-1 D INREAS^DVBCIUT1
"RTN","DVBCIUTL",95,0)
 .S:('$D(DVBATSAV)!(RESANS["^")) DVBAOUT="1"
"RTN","DVBCIUTL",96,0)
 .I DVBAOUT'=1,('$D(Y)) DO
"RTN","DVBCIUTL",97,0)
 ..I RESANS["?" DO
"RTN","DVBCIUTL",98,0)
 ...N LPDA S LPDA=0
"RTN","DVBCIUTL",99,0)
 ...W !,"CHOOSE FROM:"
"RTN","DVBCIUTL",100,0)
 ...F  S LPDA=$O(^DVB(396.94,LPDA)) Q:+LPDA'>0  DO
"RTN","DVBCIUTL",101,0)
 ....W !,?3,$P(^DVB(396.94,LPDA,0),U,1)
"RTN","DVBCIUTL",102,0)
 ...W !
"RTN","DVBCIUTL",103,0)
 ..I RESANS'["?" DO
"RTN","DVBCIUTL",104,0)
 ...S DIC="^DVB(396.94,"
"RTN","DVBCIUTL",105,0)
 ...S DIC(0)="EMQ"
"RTN","DVBCIUTL",106,0)
 ...S X=RESANS
"RTN","DVBCIUTL",107,0)
 ...D ^DIC
"RTN","DVBCIUTL",108,0)
 ...D:+Y>0 INREAS^DVBCIUT1
"RTN","DVBCIUTL",109,0)
 .I RESANS="",($D(Y)&(+Y=-1)) S DVBCYQ=1
"RTN","DVBCIUTL",110,0)
 K DTOUT,DUOUT,Y,DIC,DVBCYQ,DVBATSAV
"RTN","DVBCIUTL",111,0)
 Q
"RTN","DVBCIUTL",112,0)
 ;
"RTN","DVBCIUTL",113,0)
XMSEL ;** Select Exams
"RTN","DVBCIUTL",114,0)
 ;** The selection prompt is defaulted to ALL.  If the user selects
"RTN","DVBCIUTL",115,0)
 ;**  'All', only exams entered on requests with a priority of 
"RTN","DVBCIUTL",116,0)
 ;**  'Insufficient' will be reported.  Not all exams.
"RTN","DVBCIUTL",117,0)
 ;
"RTN","DVBCIUTL",118,0)
 W @IOF,!
"RTN","DVBCIUTL",119,0)
 W !,"AMIE Exam Selection"
"RTN","DVBCIUTL",120,0)
 S DVBCYQ=""
"RTN","DVBCIUTL",121,0)
 K Y,DTOUT,DUOUT
"RTN","DVBCIUTL",122,0)
 F  Q:($D(DTOUT)!($D(DUOUT)!(DVBCYQ=1)))  DO
"RTN","DVBCIUTL",123,0)
 .W !!,"  Enter '^' to end Exam Selection"
"RTN","DVBCIUTL",124,0)
 .W !,"  'Return' to select all AMIE Exams",!
"RTN","DVBCIUTL",125,0)
 .K DIC,DTOUT,DUOUT
"RTN","DVBCIUTL",126,0)
 .S DIC="^DVB(396.6,"
"RTN","DVBCIUTL",127,0)
 .S DIC(0)="AEMQ"
"RTN","DVBCIUTL",128,0)
 .S DIC("A")="  Enter Exam: ALL//"
"RTN","DVBCIUTL",129,0)
 .;removed screen for inactive exams
"RTN","DVBCIUTL",130,0)
 .D ^DIC
"RTN","DVBCIUTL",131,0)
 .I '$D(DTOUT),('$D(DUOUT)) D EXMTPE^DVBCIUT1
"RTN","DVBCIUTL",132,0)
 .I $D(Y),(+Y=-1) S DVBCYQ=1
"RTN","DVBCIUTL",133,0)
 K DTOUT,DUOUT,Y,DIC,DVBCYQ
"RTN","DVBCIUTL",134,0)
 Q
"RTN","DVBCNTSC")
0^5^B13019940
"RTN","DVBCNTSC",1,0)
DVBCNTSC ;ALB ISC/THM-REQUESTS NOT SCHEDULED IN THREE DAYS ; 9/28/91  8:13 AM
"RTN","DVBCNTSC",2,0)
 ;;2.7;AMIE;**2,19**;Apr 10, 1995
"RTN","DVBCNTSC",3,0)
 ;;
"RTN","DVBCNTSC",4,0)
 D HOME^%ZIS S (PG,TOTAL)=0
"RTN","DVBCNTSC",5,0)
 S Y=DT X ^DD("DD") S DVBCDT(0)=Y D NOW^%DTC S DVBCNOW=% K %
"RTN","DVBCNTSC",6,0)
 G EN
"RTN","DVBCNTSC",7,0)
 ;
"RTN","DVBCNTSC",8,0)
PRINT S DTA=^DVB(396.3,DA,0),DFN=$P(DTA,U,1),DTRPT=$P(DTA,U,5),RQSTAT=$P(DTA,U,18),REQCA=$P(DTA,U,19) Q:(RQSTAT["X"!(REQCA'=""))  ;cancelled requests
"RTN","DVBCNTSC",9,0)
 S Y=DTRPT X ^DD("DD") S DTRPT2=Y,RO=$P(DTA,U,3),RO=$S($D(^DIC(4,+RO,0)):$P(^(0),U,1),1:"Unknown RO"),DTSCH=$P(DTA,U,6),Y=DTSCH X ^DD("DD") S DTSCH2=Y K DTA
"RTN","DVBCNTSC",10,0)
 S DAYS=0 I DTSCH="" S X1=DVBCNOW,X2=DTRPT D ^%DTC Q:X'>3  S DAYS=X
"RTN","DVBCNTSC",11,0)
 I DTSCH]"" S X1=DTSCH,X2=DTRPT D ^%DTC Q:X'>3  S DAYS=X
"RTN","DVBCNTSC",12,0)
 W PNAM,?33,^TMP($J,RQDT,PNAM,DA),?45,DTRPT2,?69,DTSCH2,?93,RO,?119,DAYS,! S TOTAL=TOTAL+1 I $Y>55 D HDR
"RTN","DVBCNTSC",13,0)
 Q
"RTN","DVBCNTSC",14,0)
 ;
"RTN","DVBCNTSC",15,0)
EN W @IOF,"2507 Exams Not Scheduled Within Three Days",!!!
"RTN","DVBCNTSC",16,0)
 S %DT(0)=-DT,%DT="AE",%DT("A")="Enter STARTING DATE REPORTED TO MAS: " D ^%DT G:Y<0 EXIT S SDATE2=Y,SDATE=Y-.5
"RTN","DVBCNTSC",17,0)
 S %DT("A")="    and ENDING DATE REPORTED TO MAS: " D ^%DT G:Y<0 EXIT S EDATE2=Y,EDATE=Y+.2359
"RTN","DVBCNTSC",18,0)
 K %DT S HD="2507 Requests Not Scheduled in Three Days at "_$$SITE^DVBCUTL4,HD2="From " S Y=$E(SDATE2,1,7) X ^DD("DD") S HD2=HD2_Y S Y=$E(EDATE2,1,7) X ^DD("DD") S HD2=HD2_" to "_Y
"RTN","DVBCNTSC",19,0)
 ;
"RTN","DVBCNTSC",20,0)
DEV W !! S %ZIS="AEQ" D ^%ZIS G:POP EXIT
"RTN","DVBCNTSC",21,0)
 I IOM<132 W *7,!!,"A right margin of 132 is required for this output!",!! G DEV
"RTN","DVBCNTSC",22,0)
 I $D(IO("Q")) S ZTIO=ION,ZTRTN="GO^DVBCNTSC",ZTDESC="2507 exams not scheduled in 3 days" F I="TOTAL","PG","SDATE*","EDATE*","HD*","DVBC*" S ZTSAVE(I)=""
"RTN","DVBCNTSC",23,0)
 I  D ^%ZTLOAD W:$D(ZTSK) *7,!!,"Request queued.",!! G EXIT
"RTN","DVBCNTSC",24,0)
 ;
"RTN","DVBCNTSC",25,0)
GO K ^TMP($J) ;S X1=SDATE,X2=-7 D C^%DTC S SDATE=X ;allow for last month since using date reported
"RTN","DVBCNTSC",26,0)
 U IO D HDR F RQDT=SDATE:0 S RQDT=$O(^DVB(396.3,"C",RQDT)) Q:RQDT=""!(RQDT>EDATE)  F DA=0:0 S DA=$O(^DVB(396.3,"C",RQDT,DA)) Q:DA=""  S X=$P(^DVB(396.3,DA,0),U,5) I X'<SDATE,X'>EDATE D GO1
"RTN","DVBCNTSC",27,0)
 S PNAM="" F RQDT=0:0 S RQDT=$O(^TMP($J,RQDT)) Q:RQDT=""  F ZI=0:0 S PNAM=$O(^TMP($J,RQDT,PNAM)) Q:PNAM=""  F DA=0:0 S DA=$O(^TMP($J,RQDT,PNAM,DA)) Q:DA=""  D PRINT
"RTN","DVBCNTSC",28,0)
 W !!,"Total requests: ",TOTAL,!!
"RTN","DVBCNTSC",29,0)
 ;
"RTN","DVBCNTSC",30,0)
EXIT D:$D(ZTQUEUED) KILL^%ZTLOAD K DTRPT,DTRPT2,REQCA G KILL^DVBCUTIL
"RTN","DVBCNTSC",31,0)
 ;
"RTN","DVBCNTSC",32,0)
GO1 ;request can be included only if at least one exam wasn't transferred out
"RTN","DVBCNTSC",33,0)
 S TFIND=0,COUNT=0
"RTN","DVBCNTSC",34,0)
 F XI=0:0 S XI=$O(^DVB(396.4,"C",DA,XI)) Q:XI=""  D
"RTN","DVBCNTSC",35,0)
 .S COUNT=COUNT+1
"RTN","DVBCNTSC",36,0)
 .I $D(^DVB(396.4,XI,"TRAN")) S TFIND=TFIND+1
"RTN","DVBCNTSC",37,0)
 ;if TFIND=COUNT then all exams are transferred, so do not consider for report
"RTN","DVBCNTSC",38,0)
 I TFIND<COUNT D
"RTN","DVBCNTSC",39,0)
 .S DFN=$P(^DVB(396.3,DA,0),U,1)
"RTN","DVBCNTSC",40,0)
 .S NAME=$S($D(^DPT(DFN,0)):$P(^(0),U,1),1:"patient file record missing")
"RTN","DVBCNTSC",41,0)
 .S DVBCSSN=$S($D(^DPT(DFN,0)):$P(^(0),U,9),1:"")
"RTN","DVBCNTSC",42,0)
 .S ^TMP($J,$E(RQDT,1,7),NAME,DA)=DVBCSSN K DVBCSSN,DFN,NAME
"RTN","DVBCNTSC",43,0)
 Q
"RTN","DVBCNTSC",44,0)
 ;
"RTN","DVBCNTSC",45,0)
HDR S PG=PG+1 I (IOST?1"C-".E)!(PG>1) W @IOF
"RTN","DVBCNTSC",46,0)
 W DVBCDT(0),?(IOM-$L(HD)\2),HD,?(IOM-9),"Page: ",PG,!?(IOM-$L(HD2)\2),HD2,!!!
"RTN","DVBCNTSC",47,0)
 W "Veteran name",?33,"SSN",?45,"Date reported-MAS",?69,"Date scheduled",?93,"Requested by",?119,"Days",!
"RTN","DVBCNTSC",48,0)
 F LINE=1:1:IOM W "-"
"RTN","DVBCNTSC",49,0)
 W !! Q
"RTN","DVBCREQ1")
0^6^B14736469
"RTN","DVBCREQ1",1,0)
DVBCREQ1 ;ALB/GTS-557/THM-NEW 2507 REQUEST PRINTING ; 5/25/91  11:36 AM
"RTN","DVBCREQ1",2,0)
 ;;2.7;AMIE;**19**;Apr 10, 1995
"RTN","DVBCREQ1",3,0)
 ;
"RTN","DVBCREQ1",4,0)
START S PGHD="COMPENSATION AND PENSION EXAM REQUEST",ROHD="Requested by "_RONAME,PG=0
"RTN","DVBCREQ1",5,0)
 D HDR
"RTN","DVBCREQ1",6,0)
 D SSNOUT^DVBCUTIL ;** Set the value of DVBCSSNO
"RTN","DVBCREQ1",7,0)
 W !?2,"Name: ",PNAM,?56,"SSN: ",DVBCSSNO,!?51,"C-Number: ",CNUM,!?56,"DOB: " S Y=DOB X ^DD("DD") W Y,!?2,"Address: ",ADR1,! W:ADR2]"" ?11,ADR2,! W:ADR3]"" ?11,ADR3,!!
"RTN","DVBCREQ1",8,0)
 W !?2,"City,State,Zip+4: ",?48,"Res Phone: ",HOMPHON,!?5,CITY,"  ",STATE,"  ",ZIP,?48,"Bus Phone: ",BUSPHON,! I IOST?1"C-".E D CRTBOT G:$D(GETOUT) EXIT
"RTN","DVBCREQ1",9,0)
 W !,"Entered active service: " S Y=EOD X ^DD("DD") S:Y="" Y="Not specified" W Y,?40,"Last rating exam date: ",LREXMDT,! S Y=RAD X ^DD("DD") S:Y="" Y="Not specified" W "Released active service: " W Y,!
"RTN","DVBCREQ1",10,0)
 F LINE=1:1:80 W "="
"RTN","DVBCREQ1",11,0)
 S TVAR(1,0)="0,0,0,2:1,0^** Priority of exam: "_PRIO
"RTN","DVBCREQ1",12,0)
 D WR^DVBAUTL4("TVAR")
"RTN","DVBCREQ1",13,0)
 K TVAR
"RTN","DVBCREQ1",14,0)
 I $D(^DVB(396.3,DA(1),5)),(+$P(^DVB(396.3,DA(1),5),U,1)>0) DO
"RTN","DVBCREQ1",15,0)
 .I $D(DVBAINSF),($D(^DVB(396.3,$P(^DVB(396.3,DA(1),5),U,1),0))) DO
"RTN","DVBCREQ1",16,0)
 ..S Y=$P(^DVB(396.3,$P(^DVB(396.3,DA(1),5),U,1),0),U,5) X ^DD("DD")
"RTN","DVBCREQ1",17,0)
 ..S TVAR(1,0)="0,0,0,0,0^Date original 2507 Reported to MAS: "_Y K Y
"RTN","DVBCREQ1",18,0)
 ..D WR^DVBAUTL4("TVAR")
"RTN","DVBCREQ1",19,0)
 ..K TVAR
"RTN","DVBCREQ1",20,0)
 S TVAR(1,0)="0,0,0,3:2,0^Selected exams: "
"RTN","DVBCREQ1",21,0)
 D WR^DVBAUTL4("TVAR")
"RTN","DVBCREQ1",22,0)
 K TVAR
"RTN","DVBCREQ1",23,0)
 D TST^DVBCUTL3 G:($D(GETOUT)) EXIT
"RTN","DVBCREQ1",24,0)
 W !!!!! I IOST?1"C-".E D CRTBOT G:$D(GETOUT) EXIT
"RTN","DVBCREQ1",25,0)
 W "Current Rated disabilities:",!! D DDIS^DVBCUTL3 G:($D(GETOUT)) EXIT
"RTN","DVBCREQ1",26,0)
 W "Other Disabilities:",!!?2,OTHDIS,!?2,OTHDIS1,!?2,OTHDIS2,!!,"General remarks:",!!
"RTN","DVBCREQ1",27,0)
 K ^UTILITY($J,"W")
"RTN","DVBCREQ1",28,0)
 I IOST?1"C-".E D CRTBOT G:$D(GETOUT) EXIT
"RTN","DVBCREQ1",29,0)
 F LINE=0:0 S LINE=$O(^DVB(396.3,DA(1),2,LINE)) Q:(LINE="")!($D(GETOUT))  S X=^(LINE,0),DIWL=5,DIWR=75,DIWF="W" D ^DIWP I $Y>(IOSL-7),$O(^DVB(396.3,DA(1),2,LINE))]"" D BOT D:'$D(GETOUT) HDR,RMRK
"RTN","DVBCREQ1",30,0)
 D:('$D(GETOUT)) ^DIWW
"RTN","DVBCREQ1",31,0)
 ; **  Exit TAG **
"RTN","DVBCREQ1",32,0)
EXIT D:('$D(GETOUT)) BOT K GETOUT,LPCNT,DVBCDX,DVBCSC,DVBCSSNO Q
"RTN","DVBCREQ1",33,0)
 ;
"RTN","DVBCREQ1",34,0)
HDR S PG=PG+1 I '$D(ONE)!(($D(ONE))&(PG>1))!(IOST?1"C-".E) W @IOF
"RTN","DVBCREQ1",35,0)
 W !,"Date: ",DVBCDT(0),?(80-$L(PGHD)\2),PGHD,?71,"Page: ",PG,! S PRTDIV=$S($D(^DG(40.8,XDIV,0)):$P(^(0),U,1),1:"Unknown division") S PRTDIV="For "_PRTDIV_" Medical Center Division at "_$$SITE^DVBCUTL4
"RTN","DVBCREQ1",36,0)
 W ?(80-$L(PRTDIV)\2),PRTDIV
"RTN","DVBCREQ1",37,0)
 W !! S Y=$P(^DVB(396.3,DA(1),0),U,22) I Y]"" S Z="*** Transferred from ",Z=Z_$S($D(^DIC(4.2,+Y,0)):$P(^(0),U,1),1:"unknown site")_" ***" W ?(80-$L(Z)\2),Z,!
"RTN","DVBCREQ1",38,0)
 W ?(80-$L(ROHD)\2),ROHD,! S RQ="Date Requested: ",Y=DTRQ X ^DD("DD") S RQ=RQ_Y W ?(80-$L(RQ)\2),RQ,! F XLN=1:1:80 W "="
"RTN","DVBCREQ1",39,0)
 K XLN Q
"RTN","DVBCREQ1",40,0)
 ;
"RTN","DVBCREQ1",41,0)
CRTBOT ;  ** Write form number at bottom of CRT **
"RTN","DVBCREQ1",42,0)
 I $P(^DVB(396.3,DA(1),0),U,23)="Y" W !?20,"** Claim folder review will be required **",!
"RTN","DVBCREQ1",43,0)
 F LPCNT=$Y:1:(IOSL-7) W !
"RTN","DVBCREQ1",44,0)
 W !,"VA Form 21-2507"
"RTN","DVBCREQ1",45,0)
 D TERM^DVBCUTL3
"RTN","DVBCREQ1",46,0)
 Q
"RTN","DVBCREQ1",47,0)
 ;
"RTN","DVBCREQ1",48,0)
BOT I $P(^DVB(396.3,DA(1),0),U,23)="Y" W !?20,"** Claim folder review will be required **",!
"RTN","DVBCREQ1",49,0)
 I IOST?1"C-".E F LPCNT=$Y:1:(IOSL-6) W !
"RTN","DVBCREQ1",50,0)
 I IOST'?1"C-".E F LPCNT=$Y:1:(IOSL-4) W !
"RTN","DVBCREQ1",51,0)
 W !,"VA Form 21-2507"
"RTN","DVBCREQ1",52,0)
 I IOST?1"C-".E D TERM^DVBCUTL3
"RTN","DVBCREQ1",53,0)
 Q
"RTN","DVBCREQ1",54,0)
 ;
"RTN","DVBCREQ1",55,0)
RMRK W !?2,"Name: ",PNAM,?56,"SSN: ",DVBCSSNO
"RTN","DVBCREQ1",56,0)
 W ! F XLN=1:1:80 W "="
"RTN","DVBCREQ1",57,0)
 W !!,"General remarks (continued):",!!
"RTN","DVBCREQ1",58,0)
 Q
"VER")
8.0^21.0
**END**
**END**
