Released TIU*1*218 SEQ #199
Extracted from mail message
**KIDS**:TIU*1.0*218^

**INSTALL NAME**
TIU*1.0*218
"BLD",6286,0)
TIU*1.0*218^TEXT INTEGRATION UTILITIES^0^3060726^y
"BLD",6286,1,0)
^^2^2^3060612^^
"BLD",6286,1,1,0)
The description of this patch may be found in the national patch module 
"BLD",6286,1,2,0)
under patch TIU*1.0*218.
"BLD",6286,4,0)
^9.64PA^^
"BLD",6286,6.3)
1
"BLD",6286,"KRN",0)
^9.67PA^8989.52^19
"BLD",6286,"KRN",.4,0)
.4
"BLD",6286,"KRN",.401,0)
.401
"BLD",6286,"KRN",.402,0)
.402
"BLD",6286,"KRN",.403,0)
.403
"BLD",6286,"KRN",.5,0)
.5
"BLD",6286,"KRN",.84,0)
.84
"BLD",6286,"KRN",3.6,0)
3.6
"BLD",6286,"KRN",3.8,0)
3.8
"BLD",6286,"KRN",9.2,0)
9.2
"BLD",6286,"KRN",9.8,0)
9.8
"BLD",6286,"KRN",9.8,"NM",0)
^9.68A^1^1
"BLD",6286,"KRN",9.8,"NM",1,0)
TIUPS209^^0^B67761530
"BLD",6286,"KRN",9.8,"NM","B","TIUPS209",1)

"BLD",6286,"KRN",19,0)
19
"BLD",6286,"KRN",19,"NM",0)
^9.68A^2^2
"BLD",6286,"KRN",19,"NM",1,0)
TIU ACTIVE TITLE CLEANUP^^0
"BLD",6286,"KRN",19,"NM",2,0)
TIU IRM MAINTENANCE MENU^^2
"BLD",6286,"KRN",19,"NM","B","TIU ACTIVE TITLE CLEANUP",1)

"BLD",6286,"KRN",19,"NM","B","TIU IRM MAINTENANCE MENU",2)

"BLD",6286,"KRN",19.1,0)
19.1
"BLD",6286,"KRN",101,0)
101
"BLD",6286,"KRN",409.61,0)
409.61
"BLD",6286,"KRN",771,0)
771
"BLD",6286,"KRN",870,0)
870
"BLD",6286,"KRN",8989.51,0)
8989.51
"BLD",6286,"KRN",8989.52,0)
8989.52
"BLD",6286,"KRN",8994,0)
8994
"BLD",6286,"KRN","B",.4,.4)

"BLD",6286,"KRN","B",.401,.401)

"BLD",6286,"KRN","B",.402,.402)

"BLD",6286,"KRN","B",.403,.403)

"BLD",6286,"KRN","B",.5,.5)

"BLD",6286,"KRN","B",.84,.84)

"BLD",6286,"KRN","B",3.6,3.6)

"BLD",6286,"KRN","B",3.8,3.8)

"BLD",6286,"KRN","B",9.2,9.2)

"BLD",6286,"KRN","B",9.8,9.8)

"BLD",6286,"KRN","B",19,19)

"BLD",6286,"KRN","B",19.1,19.1)

"BLD",6286,"KRN","B",101,101)

"BLD",6286,"KRN","B",409.61,409.61)

"BLD",6286,"KRN","B",771,771)

"BLD",6286,"KRN","B",870,870)

"BLD",6286,"KRN","B",8989.51,8989.51)

"BLD",6286,"KRN","B",8989.52,8989.52)

"BLD",6286,"KRN","B",8994,8994)

"BLD",6286,"QUES",0)
^9.62^^
"BLD",6286,"REQB",0)
^9.611^1^1
"BLD",6286,"REQB",1,0)
TEXT INTEGRATION UTILITIES 1.0^2
"BLD",6286,"REQB","B","TEXT INTEGRATION UTILITIES 1.0",1)

"KRN",19,5287,-1)
2^2
"KRN",19,5287,0)
TIU IRM MAINTENANCE MENU^TIU Maintenance Menu^^M^123456789078^^^^^^^193^y^1^1
"KRN",19,5287,10,0)
^19.01IP^12^12
"KRN",19,5287,10,11,0)
10023^6^6
"KRN",19,5287,10,11,"^")
TIU ACTIVE TITLE CLEANUP
"KRN",19,5287,"U")
TIU MAINTENANCE MENU
"KRN",19,10023,-1)
0^1
"KRN",19,10023,0)
TIU ACTIVE TITLE CLEANUP^Active Title Cleanup Report^^R^^^^^^^^TEXT INTEGRATION UTILITIES
"KRN",19,10023,25)
EN^TIUPS209
"KRN",19,10023,"U")
ACTIVE TITLE CLEANUP REPORT
"MBREQ")
0
"ORD",18,19)
19;18;;;OPT^XPDTA;OPTF1^XPDIA;OPTE1^XPDIA;OPTF2^XPDIA;;OPTDEL^XPDIA
"ORD",18,19,0)
OPTION
"PKG",193,-1)
1^1
"PKG",193,0)
TEXT INTEGRATION UTILITIES^TIU^Text Integration Utilities 
"PKG",193,20,0)
^9.402P^^
"PKG",193,22,0)
^9.49I^1^1
"PKG",193,22,1,0)
1.0^3010321^3010321^11
"PKG",193,22,1,"PAH",1,0)
218^3060726^11
"PKG",193,22,1,"PAH",1,1,0)
^^2^2^3060726
"PKG",193,22,1,"PAH",1,1,1,0)
The description of this patch may be found in the national patch module 
"PKG",193,22,1,"PAH",1,1,2,0)
under patch TIU*1.0*218.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
1
"RTN","TIUPS209")
0^1^B67761530^B52105626
"RTN","TIUPS209",1,0)
TIUPS209 ; SLC/AJB - Active Titles Report & Cleanup v2; 06/01/06 ; 7/26/06 11:46am
"RTN","TIUPS209",2,0)
 ;;1.0;TEXT INTEGRATION UTILITIES;**209,218**;Jun 20, 1997;Build 1
"RTN","TIUPS209",3,0)
 ;
"RTN","TIUPS209",4,0)
 Q
"RTN","TIUPS209",5,0)
EN ; control segment
"RTN","TIUPS209",6,0)
 N ANS,TIUOMIT
"RTN","TIUPS209",7,0)
 W @IOF
"RTN","TIUPS209",8,0)
 D ASKUSER(.ANS,"Inactivate the unused Document Titles at this time") Q:$G(ANS("EXIT"))="YES"
"RTN","TIUPS209",9,0)
 D
"RTN","TIUPS209",10,0)
 .N POP,TIUDESC,TIURTN,TIUSAVE
"RTN","TIUPS209",11,0)
 .S TIUDESC="TIUPS209 Active Title Report & Cleanup",TIURTN="REPORT^TIUPS209",TIUSAVE("*")=""
"RTN","TIUPS209",12,0)
 .W ! D EN^XUTMDEVQ(TIURTN,TIUDESC,.TIUSAVE)
"RTN","TIUPS209",13,0)
 Q
"RTN","TIUPS209",14,0)
REPORT ;
"RTN","TIUPS209",15,0)
 N CNT,ENDDT,ENDTIME,GBL,LINE,LINETXT,STRDT,STRTIME,TIUDA,TMP,TOTTIME,TIUX,TIUY
"RTN","TIUPS209",16,0)
 S STRTIME=$$NOW^XLFDT ; start time of search
"RTN","TIUPS209",17,0)
RESTART ;
"RTN","TIUPS209",18,0)
 S CNT=$NA(CNT) ; counters
"RTN","TIUPS209",19,0)
 S GBL=$NA(^TIU(8925.1,"B")) ; global to be searched
"RTN","TIUPS209",20,0)
 S TMP=$NA(^TMP("TIUPS209",$J)) ; sets temporary storage location
"RTN","TIUPS209",21,0)
 S @CNT@("T#8925.1")=0 ; number of document titles in 8925.1
"RTN","TIUPS209",22,0)
 S (TIUX,TIUY)=0 ; gets all document titles from 8925.1
"RTN","TIUPS209",23,0)
 F  S TIUX=$O(@GBL@(TIUX)) Q:TIUX=""  F  S TIUY=$O(@GBL@(TIUX,TIUY)) Q:'+TIUY  D
"RTN","TIUPS209",24,0)
 . I $P($G(^TIU(8925.1,TIUY,0)),U,4)="DOC" S @TMP@("B",TIUY)=0,@CNT@("T#8925.1")=@CNT@("T#8925.1")+1
"RTN","TIUPS209",25,0)
 S GBL=$NA(^TIU(8925,"F")) ; global to be searched
"RTN","TIUPS209",26,0)
 S STRDT=$P($$FMADD^XLFDT($$NOW^XLFDT,-365),".") ; start date to search
"RTN","TIUPS209",27,0)
 S ENDDT=$P($$NOW^XLFDT,".")_".24" ; end date to search
"RTN","TIUPS209",28,0)
 S @CNT@("T#8925")=0 ; number of documents searched in 8925
"RTN","TIUPS209",29,0)
 S @CNT@("T#M0NODE")=0 ; number of documents with invalid .01 field
"RTN","TIUPS209",30,0)
 S @CNT@("T#WT8925.1")=0 ; number of documents with incorrect .01 field (non title - 8925.1)
"RTN","TIUPS209",31,0)
 S @CNT@("T#ADD8925.1")=0 ; number of document titles added due to wrong type
"RTN","TIUPS209",32,0)
 S @CNT@("T#GDOCS")=0 ; number of documents
"RTN","TIUPS209",33,0)
 S TIUDA=0
"RTN","TIUPS209",34,0)
 F  S STRDT=$O(@GBL@(STRDT)) Q:'+STRDT!(STRDT>ENDDT)  F  S TIUDA=$O(@GBL@(STRDT,TIUDA)) Q:'+TIUDA  D
"RTN","TIUPS209",35,0)
 . S @CNT@("T#8925")=@CNT@("T#8925")+1 ; count of documents searched
"RTN","TIUPS209",36,0)
 . N TIUD0,TIUD12,TIUX S TIUD0=$G(^TIU(8925,TIUDA,0)),TIUD12=$G(^TIU(8925,TIUDA,12))
"RTN","TIUPS209",37,0)
 . I '+TIUD0 S @TMP@("UNK",+TIUDA)="",@CNT@("T#M0NODE")=@CNT@("T#M0NODE")+1 Q  ; track documents with invalid .01 field
"RTN","TIUPS209",38,0)
 . I $P($G(^TIU(8925.1,+TIUD0,0)),U,4)'="DOC" S TIUX=1,@CNT@("T#WT8925.1")=@CNT@("T#WT8925.1")+1,@TMP@("WRT",+TIUD0)=""
"RTN","TIUPS209",39,0)
 . I '+$D(@TMP@("B",+TIUD0)) S @TMP@("B",+TIUD0)=0,@CNT@("T#ADD8925.1")=@CNT@("T#ADD8925.1")+1
"RTN","TIUPS209",40,0)
 . S @TMP@("B",+TIUD0)=(+@TMP@("B",+TIUD0)+1) S:'+$G(TIUX) @CNT@("T#GDOCS")=@CNT@("T#GDOCS")+1
"RTN","TIUPS209",41,0)
 . S @TMP@("B",+TIUD0)=@TMP@("B",+TIUD0)_U_+$P(TIUD12,".")_U_$P(TIUD12,U,2)_U_+TIUD0_U_$P(^TIU(8925.1,+TIUD0,0),U,7)
"RTN","TIUPS209",42,0)
 S @CNT@("T#ERR8925.1")=0 ; number of errorneous document titles
"RTN","TIUPS209",43,0)
 S @CNT@("T#U8925.1")=0 ; number of used document titles
"RTN","TIUPS209",44,0)
 S @CNT@("T#UN8925.1")=0 ; number of unused document titles
"RTN","TIUPS209",45,0)
 S TIUDA=0
"RTN","TIUPS209",46,0)
 F  S TIUDA=$O(@TMP@("B",TIUDA)) Q:'+TIUDA  D
"RTN","TIUPS209",47,0)
 . I +$L($P($G(^TIU(8925.1,TIUDA,0)),U))<3 S @CNT@("T#ERR8925.1")=@CNT@("T#ERR8925.1")+1,@TMP@("B.1",+TIUDA)="" Q
"RTN","TIUPS209",48,0)
 . I +@TMP@("B",TIUDA) S @CNT@("T#U8925.1")=@CNT@("T#U8925.1")+1,@TMP@("RPT","USED",$$GET1^DIQ(8925.1,+TIUDA,.01))=@TMP@("B",+TIUDA) Q
"RTN","TIUPS209",49,0)
 . S @CNT@("T#UN8925.1")=@CNT@("T#UN8925.1")+1,@TMP@("RPT","UNUSED",$$GET1^DIQ(8925.1,+TIUDA,.01))=$$GETLAST(+TIUDA)
"RTN","TIUPS209",50,0)
 S ENDTIME=$$NOW^XLFDT,TOTTIME=$FN($$FMDIFF^XLFDT(STRTIME,ENDTIME,2)/60,"-")
"RTN","TIUPS209",51,0)
 I $G(ANS("INACT"))="YES" D UPDATE K @TMP S ANS("INACT")="" G RESTART
"RTN","TIUPS209",52,0)
 F LINE=1:1 S LINETXT=$P($T(RPT+LINE),";;",2) Q:LINETXT="EOM"  W !,@LINETXT
"RTN","TIUPS209",53,0)
 S TIUX=""
"RTN","TIUPS209",54,0)
 F TIUY="UNUSED","USED" F  S TIUX=$O(@TMP@("RPT",TIUY,TIUX)) Q:TIUX=""  D
"RTN","TIUPS209",55,0)
 . N DATA,DISPLAY,STATUS,TITLE
"RTN","TIUPS209",56,0)
 . S DATA=@TMP@("RPT",TIUY,TIUX)
"RTN","TIUPS209",57,0)
 . I TIUY="UNUSED",$P(DATA,U,5)=13 Q  ; don't print unused/inactive titles
"RTN","TIUPS209",58,0)
 . S STATUS=$S($P(DATA,U,5)=11:"",$P(DATA,U,5)=13:" [Inactive]",1:" [unknown]")
"RTN","TIUPS209",59,0)
 . S TITLE=TIUX_STATUS,TITLE=$$WRAP^TIULS(TITLE,38)
"RTN","TIUPS209",60,0)
 . S DISPLAY=$$SETSTR^VALM1($P(TITLE,"|"),"",1,38)
"RTN","TIUPS209",61,0)
 . S DISPLAY=$$SETSTR^VALM1($$SPACER(+DATA,5,1),DISPLAY,40,5)
"RTN","TIUPS209",62,0)
 . S DISPLAY=$$SETSTR^VALM1($$FMTE^XLFDT($P(DATA,U,2)),DISPLAY,47,12)
"RTN","TIUPS209",63,0)
 . S DISPLAY=$$SETSTR^VALM1($S($P(DATA,U,3)="N/A":"N/A",1:$$GET1^DIQ(200,+$P(DATA,U,3),.01)),DISPLAY,61,18)
"RTN","TIUPS209",64,0)
 . W !,DISPLAY
"RTN","TIUPS209",65,0)
 . I $L(TITLE,"|")>1 F DATA=2:1:$L(TITLE,"|") W !,?2,$P(TITLE,"|",DATA)
"RTN","TIUPS209",66,0)
 I +$D(@TMP@("B.1")) D
"RTN","TIUPS209",67,0)
 . W !!,"The following IENs from File #8925.1 have an invalid #.01 Field.",!
"RTN","TIUPS209",68,0)
 . S TIUDA=0 F  S TIUDA=$O(@TMP@("B.1",TIUDA)) Q:'+TIUDA  W !,TIUDA
"RTN","TIUPS209",69,0)
 I +$D(@TMP@("WRT")) D
"RTN","TIUPS209",70,0)
 . W !!,"The following IENs from File #8925.1 have an incorrect #.04 Field.",!
"RTN","TIUPS209",71,0)
 . S TIUDA=0 F  S TIUDA=$O(@TMP@("WRT",TIUDA)) Q:'+TIUDA  D
"RTN","TIUPS209",72,0)
 . . N DATA,TITLE S TITLE=$$GET1^DIQ(8925.1,TIUDA,.01),TITLE=$$WRAP^TIULS(TITLE,50)
"RTN","TIUPS209",73,0)
 . . W !,$$SPACER(TIUDA,12)_$P(TITLE,"|")_" ["_$$GET1^DIQ(8925.1,TIUDA,.04)_"]"
"RTN","TIUPS209",74,0)
 . . I $L(TITLE,"|")>1 F DATA=2:1:$L(TITLE,"|") W !,?14,$P(TITLE,"|",DATA)
"RTN","TIUPS209",75,0)
 I +$D(@TMP@("UNK")) D
"RTN","TIUPS209",76,0)
 . W !!,"The following DOCUMENT IENs have an incorrect (null or zero) #.01 Field.",!
"RTN","TIUPS209",77,0)
 . S TIUDA=0 F  S TIUDA=$O(@TMP@("UNK",TIUDA)) Q:'+TIUDA  W !,$$SPACER(TIUDA,12) ; I +@TMP@("UNK",TIUDA) W $$GET1^DIQ(8925.1,@TMP@("UNK",TIUDA),.01)
"RTN","TIUPS209",78,0)
 K @TMP
"RTN","TIUPS209",79,0)
 Q
"RTN","TIUPS209",80,0)
RPT ;
"RTN","TIUPS209",81,0)
 ;;"Elapsed Time:    "_(TOTTIME\1)_" minute(s) "_($FN((TOTTIME#1)*60,"-",0))_" second(s)"
"RTN","TIUPS209",82,0)
 ;;""
"RTN","TIUPS209",83,0)
 ;;"                 # of Used Titles  : "_$$SPACER(@CNT@("T#U8925.1"),10,1)
"RTN","TIUPS209",84,0)
 ;;"               # of Unused Titles  : "_$$SPACER(@CNT@("T#UN8925.1"),10,1)
"RTN","TIUPS209",85,0)
 ;;"              # of Invalid Titles  : "_$$SPACER(@CNT@("T#ERR8925.1"),10,1)_$S(+@CNT@("T#ERR8925.1"):" (See End of Report)",1:"")
"RTN","TIUPS209",86,0)
 ;;"                                     ----------"
"RTN","TIUPS209",87,0)
 ;;"                # of Total Titles  : "_$$SPACER((@CNT@("T#8925.1")+@CNT@("T#ADD8925.1")),10,1)
"RTN","TIUPS209",88,0)
 ;;""
"RTN","TIUPS209",89,0)
 ;;"                        # of Docs  : "_$$SPACER(@CNT@("T#GDOCS"),10,1)
"RTN","TIUPS209",90,0)
 ;;"    # of Docs Incorrect .01 Field  : "_$$SPACER(@CNT@("T#WT8925.1"),10,1)_$S(+@CNT@("T#WT8925.1"):" (See End of Report)",1:"")
"RTN","TIUPS209",91,0)
 ;;"    # of Docs Zero/Null .01 Field  : "_$$SPACER(@CNT@("T#M0NODE"),10,1)_$S(+@CNT@("T#M0NODE"):" (See End of Report)",1:"")
"RTN","TIUPS209",92,0)
 ;;"                                     ----------"
"RTN","TIUPS209",93,0)
 ;;"         # of Total Docs Searched  : "_$$SPACER(@CNT@("T#8925"),10,1)
"RTN","TIUPS209",94,0)
 ;;""
"RTN","TIUPS209",95,0)
 ;;"       Current User:  "_($$GET1^DIQ(200,+$G(DUZ),.01))
"RTN","TIUPS209",96,0)
 ;;"       Current Date:  "_($$HTE^XLFDT($H))
"RTN","TIUPS209",97,0)
 ;;"Date range searched:  "_($$FMTE^XLFDT($P($$FMADD^XLFDT($$NOW^XLFDT,-365),"."),"D"))_" - "_($$FMTE^XLFDT(ENDDT,"D"))
"RTN","TIUPS209",98,0)
 ;;""
"RTN","TIUPS209",99,0)
 ;;"                                        # of"
"RTN","TIUPS209",100,0)
 ;;"Document Title                          Docs  Last DT Used  Author/Dictator"
"RTN","TIUPS209",101,0)
 ;;"--------------                          ----  ------------  ---------------"
"RTN","TIUPS209",102,0)
 ;;EOM
"RTN","TIUPS209",103,0)
 Q
"RTN","TIUPS209",104,0)
ASKUSER(ANS,DIR,TIUQUIT) ; ask the user if they want to update titles now
"RTN","TIUPS209",105,0)
 I $G(ANS("EXIT"))="YES"!($G(ANS("INACT"))="NO") Q
"RTN","TIUPS209",106,0)
 N DIRUT,DTOUT,DUOUT,POP,X,Y
"RTN","TIUPS209",107,0)
 S DIR(0)="Y"
"RTN","TIUPS209",108,0)
 S DIR("A")=DIR,DIR("B")="NO"
"RTN","TIUPS209",109,0)
 S DIR("?",1)="Entering 'YES' will inactivate all titles unused in the past year;"
"RTN","TIUPS209",110,0)
 S DIR("?",2)="their STATUS will be changed to INACTIVE.",DIR("?",3)=""
"RTN","TIUPS209",111,0)
 S DIR("?")="Entering 'NO' will create the report without making any changes."
"RTN","TIUPS209",112,0)
 D ^DIR I $D(DUOUT)!($D(DTOUT)) S ANS("EXIT")="YES" Q
"RTN","TIUPS209",113,0)
 S ANS("INACT")=Y(0) Q:+$G(TIUQUIT)
"RTN","TIUPS209",114,0)
 I ANS("INACT")="YES" D
"RTN","TIUPS209",115,0)
 . W !!,"All active titles that have not been used in the previous 365 days"
"RTN","TIUPS209",116,0)
 . W !,"will be set to INACTIVE.",!
"RTN","TIUPS209",117,0)
 . W !,"You may select individual DOCUMENT TITLES that will NOT be set"
"RTN","TIUPS209",118,0)
 . W !,"to INACTIVE by this cleanup.",!
"RTN","TIUPS209",119,0)
 . D ASKUSER(.ANS,"Are you sure you want to change their status to INACTIVE",1)
"RTN","TIUPS209",120,0)
 . I ANS("INACT")="YES" D OMIT
"RTN","TIUPS209",121,0)
 Q
"RTN","TIUPS209",122,0)
GETLAST(TIUDA) ;
"RTN","TIUPS209",123,0)
 N IEN,GBL,ST,TDT,TEMP,TIUY
"RTN","TIUPS209",124,0)
 S GBL=$NA(^TIU(8925,"ALL","ANY",TIUDA))
"RTN","TIUPS209",125,0)
 S TIUY="0^N/A^N/A"_U_TIUDA_U_$P($G(^TIU(8925.1,TIUDA,0)),U,7)
"RTN","TIUPS209",126,0)
 S ST="" F  S ST=$O(@GBL@(ST)) Q:'ST  S TDT="",TDT=$O(@GBL@(+ST,TDT)),IEN="",IEN=$O(@GBL@(+ST,+TDT,IEN)) S TEMP(TDT)=IEN
"RTN","TIUPS209",127,0)
 S TDT="",TDT=$O(TEMP(TDT)) I +$G(TEMP(+TDT)) S IEN=+TEMP(TDT) D
"RTN","TIUPS209",128,0)
 . N TIUD0,TIUD12 S TIUD0=$G(^TIU(8925,IEN,0)),TIUD12=$G(^TIU(8925,IEN,12))
"RTN","TIUPS209",129,0)
 . I '+TIUD0,'$D(@TMP@("UNK",+IEN)) S @TMP@("UNK",+IEN)="",@CNT@("T#M0NODE")=@CNT@("T#M0NODE")+1,@CNT@("T#8925")=@CNT@("T#8925")+1
"RTN","TIUPS209",130,0)
 . S $P(TIUY,U,2)=$P(+TIUD12,"."),$P(TIUY,U,3)=$P(TIUD12,U,2)
"RTN","TIUPS209",131,0)
 Q TIUY
"RTN","TIUPS209",132,0)
OMIT ;
"RTN","TIUPS209",133,0)
 N TIUCONT,TIUQUIT
"RTN","TIUPS209",134,0)
 F  D  Q:$G(TIUQUIT)=1!($G(TIUCONT)=1)
"RTN","TIUPS209",135,0)
 . N DIC,DIR,POP,TIUCNT,X,Y
"RTN","TIUPS209",136,0)
 . W !!,"Enter the DOCUMENT TITLE(S) that will NOT be INACTIVATED",!
"RTN","TIUPS209",137,0)
 . W "during the cleanup process.",!!
"RTN","TIUPS209",138,0)
 . W "Enter RETURN or '^' to finish selections.",!
"RTN","TIUPS209",139,0)
 . S TIUCNT=0,DIC="^TIU(8925.1,",DIC("S")="I $P(^(0),U,4)=""DOC"""
"RTN","TIUPS209",140,0)
 . S DIC(0)="AEMQ",DIC("A")="Enter DOCUMENT TITLE: "
"RTN","TIUPS209",141,0)
 . F  D ^DIC Q:Y=-1  D  Q:$G(TIUQUIT)=1
"RTN","TIUPS209",142,0)
 . . S TIUCNT=TIUCNT+1,TIUOMIT(+Y)="" S:TIUCNT=1 DIC("A")="                 and  "
"RTN","TIUPS209",143,0)
 . Q:$G(TIUQUIT)=1
"RTN","TIUPS209",144,0)
 . I TIUCNT=0 W !!,"No selections made.",! S DIR("A")="Enter RETURN to continue or '^' to exit",DIR(0)="E" D ^DIR S TIUQUIT=1 Q
"RTN","TIUPS209",145,0)
 . W !!,$S(TIUCNT>1:"The following DOCUMENT TITLES will NOT be INACTIVATED: ",1:"The following DOCUMENT TITLE will NOT be INACTIVATED: "),!!
"RTN","TIUPS209",146,0)
 . S X="" F  S X=$O(TIUOMIT(X)) Q:X=""  W ?5,$$GET1^DIQ(8925.1,X_",",.01),!
"RTN","TIUPS209",147,0)
 . S DIR(0)="Y",DIR("A")="Is this correct",DIR("B")="YES"
"RTN","TIUPS209",148,0)
 . D ^DIR I +Y'=1 W !! K TIUOMIT S:Y=U TIUQUIT=1 Q
"RTN","TIUPS209",149,0)
 . S TIUCONT=1
"RTN","TIUPS209",150,0)
 Q
"RTN","TIUPS209",151,0)
SPACER(TEXT,LENGTH,REV) ;
"RTN","TIUPS209",152,0)
 N SPACER
"RTN","TIUPS209",153,0)
 S SPACER=""
"RTN","TIUPS209",154,0)
 S $P(SPACER," ",(LENGTH-$L(TEXT)))=" "
"RTN","TIUPS209",155,0)
 S:'$D(REV) TEXT=TEXT_SPACER
"RTN","TIUPS209",156,0)
 S:$D(REV) TEXT=SPACER_TEXT
"RTN","TIUPS209",157,0)
 Q TEXT
"RTN","TIUPS209",158,0)
UPDATE ; updates status field of TIU Document Title to INACTIVE
"RTN","TIUPS209",159,0)
 N TIUDA,TIUMSG,TIUUPDT
"RTN","TIUPS209",160,0)
 S TIUDA=0 F  S TIUDA=$O(@TMP@("B",TIUDA)) Q:'+TIUDA  I '+@TMP@("B",TIUDA),'$D(TIUOMIT(TIUDA)) S TIUUPDT(8925.1,TIUDA_",",.07)=13 D FILE^DIE("","TIUUPDT","TIUMSG")
"RTN","TIUPS209",161,0)
 Q
"VER")
8.0^22.0
"BLD",6286,6)
^199
**END**
**END**
