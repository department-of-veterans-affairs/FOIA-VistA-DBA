Released LR*5.2*363 SEQ #291
Extracted from mail message
**KIDS**:LR*5.2*363^

**INSTALL NAME**
LR*5.2*363
"BLD",6934,0)
LR*5.2*363^LAB SERVICE^0^3070817^y
"BLD",6934,1,0)
^^2^2^3070817^^^^
"BLD",6934,1,1,0)
This patch corrects a problem whereby a partial AP report is
"BLD",6934,1,2,0)
sent to TIU.
"BLD",6934,4,0)
^9.64PA^^
"BLD",6934,6)
3^
"BLD",6934,6.3)
3
"BLD",6934,"ABPKG")
n
"BLD",6934,"KRN",0)
^9.67PA^8989.52^19
"BLD",6934,"KRN",.4,0)
.4
"BLD",6934,"KRN",.4,"NM",0)
^9.68A^^
"BLD",6934,"KRN",.401,0)
.401
"BLD",6934,"KRN",.402,0)
.402
"BLD",6934,"KRN",.403,0)
.403
"BLD",6934,"KRN",.5,0)
.5
"BLD",6934,"KRN",.84,0)
.84
"BLD",6934,"KRN",3.6,0)
3.6
"BLD",6934,"KRN",3.8,0)
3.8
"BLD",6934,"KRN",9.2,0)
9.2
"BLD",6934,"KRN",9.8,0)
9.8
"BLD",6934,"KRN",9.8,"NM",0)
^9.68A^1^1
"BLD",6934,"KRN",9.8,"NM",1,0)
LRAPBR1^^0^B64502362
"BLD",6934,"KRN",9.8,"NM","B","LRAPBR1",1)

"BLD",6934,"KRN",19,0)
19
"BLD",6934,"KRN",19.1,0)
19.1
"BLD",6934,"KRN",101,0)
101
"BLD",6934,"KRN",409.61,0)
409.61
"BLD",6934,"KRN",771,0)
771
"BLD",6934,"KRN",870,0)
870
"BLD",6934,"KRN",8989.51,0)
8989.51
"BLD",6934,"KRN",8989.52,0)
8989.52
"BLD",6934,"KRN",8994,0)
8994
"BLD",6934,"KRN","B",.4,.4)

"BLD",6934,"KRN","B",.401,.401)

"BLD",6934,"KRN","B",.402,.402)

"BLD",6934,"KRN","B",.403,.403)

"BLD",6934,"KRN","B",.5,.5)

"BLD",6934,"KRN","B",.84,.84)

"BLD",6934,"KRN","B",3.6,3.6)

"BLD",6934,"KRN","B",3.8,3.8)

"BLD",6934,"KRN","B",9.2,9.2)

"BLD",6934,"KRN","B",9.8,9.8)

"BLD",6934,"KRN","B",19,19)

"BLD",6934,"KRN","B",19.1,19.1)

"BLD",6934,"KRN","B",101,101)

"BLD",6934,"KRN","B",409.61,409.61)

"BLD",6934,"KRN","B",771,771)

"BLD",6934,"KRN","B",870,870)

"BLD",6934,"KRN","B",8989.51,8989.51)

"BLD",6934,"KRN","B",8989.52,8989.52)

"BLD",6934,"KRN","B",8994,8994)

"BLD",6934,"QUES",0)
^9.62^^
"BLD",6934,"REQB",0)
^9.611^1^1
"BLD",6934,"REQB",1,0)
LR*5.2*317^2
"BLD",6934,"REQB","B","LR*5.2*317",1)

"MBREQ")
0
"PKG",26,-1)
1^1
"PKG",26,0)
LAB SERVICE^LR^CORE LAB SYSTEM
"PKG",26,20,0)
^9.402P^1^1
"PKG",26,20,1,0)
2^^LRXDRPT
"PKG",26,20,1,1)

"PKG",26,20,"B",2,1)

"PKG",26,22,0)
^9.49I^1^1
"PKG",26,22,1,0)
5.2^2940927^2950304
"PKG",26,22,1,"PAH",1,0)
363^3070817^33308
"PKG",26,22,1,"PAH",1,1,0)
^^2^2^3070817
"PKG",26,22,1,"PAH",1,1,1,0)
This patch corrects a problem whereby a partial AP report is
"PKG",26,22,1,"PAH",1,1,2,0)
sent to TIU.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
1
"RTN","LRAPBR1")
0^1^B64502362^B58834636
"RTN","LRAPBR1",1,0)
LRAPBR1 ;DALOI/WTY/KLL;AP Browser Print Cont.;11/08/01
"RTN","LRAPBR1",2,0)
 ;;5.2;LAB SERVICE;**259,317,363**;Sep 27, 1994;Build 3
"RTN","LRAPBR1",3,0)
 ;
"RTN","LRAPBR1",4,0)
 ;
"RTN","LRAPBR1",5,0)
ENTER ;from LRAPBR
"RTN","LRAPBR1",6,0)
 N LRCNT,LRTMP,LRA1,LRADESC,LRLENG1,LRLENG2,LRFILE,LRAPMD
"RTN","LRAPBR1",7,0)
 N LRFLD,LRV,LRV1,LRV2,LRB1,LRTEXT,LRSPCE,LRIENS,LRAPMR
"RTN","LRAPBR1",8,0)
 Q:'$D(^LR(LRDFN,LRSS,LRI,0))
"RTN","LRAPBR1",9,0)
 S:'LRTIU GROOT="^TMP(""LRAPBR"",$J,"
"RTN","LRAPBR1",10,0)
 S:LRTIU GROOT="^TMP(""TIUP"",$J,"
"RTN","LRAPBR1",11,0)
 D INP^VADPT S LRPRAC=+VAIN(2)
"RTN","LRAPBR1",12,0)
 S:'LRPRAC LRPRAC(1)=""
"RTN","LRAPBR1",13,0)
 I LRPRAC S X=LRPRAC D D^LRUA S LRPRAC(1)=X
"RTN","LRAPBR1",14,0)
 S LRQ=0 D ^LRUA,HEADER
"RTN","LRAPBR1",15,0)
 S LR("F")=1
"RTN","LRAPBR1",16,0)
 D DASH
"RTN","LRAPBR1",17,0)
 D:LRTIU GLENTRY("$TEXT",,1)
"RTN","LRAPBR1",18,0)
 D GLENTRY("Submitted by: "_LRW(5),"",1)
"RTN","LRAPBR1",19,0)
 D GLENTRY("Date obtained: "_LRTK,44)
"RTN","LRAPBR1",20,0)
 D:LRA DASH
"RTN","LRAPBR1",21,0)
MAIN ;
"RTN","LRAPBR1",22,0)
 D SPEC
"RTN","LRAPBR1",23,0)
 D MODCHK
"RTN","LRAPBR1",24,0)
 D SUPBNNR
"RTN","LRAPBR1",25,0)
 D DIAG
"RTN","LRAPBR1",26,0)
 D DOC
"RTN","LRAPBR1",27,0)
 D WPFLD
"RTN","LRAPBR1",28,0)
 D SUPRPT
"RTN","LRAPBR1",29,0)
 D SSJR
"RTN","LRAPBR1",30,0)
 Q
"RTN","LRAPBR1",31,0)
SPEC ;List specimens
"RTN","LRAPBR1",32,0)
 D GLENTRY("Specimen (Received "_LRTK(1)_"):","",1)
"RTN","LRAPBR1",33,0)
 S LRCNT=$P(^LR(LRDFN,LRSS,LRI,.1,0),U,4)
"RTN","LRAPBR1",34,0)
 Q:'LRCNT
"RTN","LRAPBR1",35,0)
 S LRFILE=+$$GET1^DID(LRSF,.012,"","SPECIFIER")
"RTN","LRAPBR1",36,0)
 S LRIENS=LRI_","_LRDFN_","
"RTN","LRAPBR1",37,0)
 S LRCT2=0
"RTN","LRAPBR1",38,0)
 F LRB1=1:1 D  Q:LRCT2=LRCNT
"RTN","LRAPBR1",39,0)
 .D GETS^DIQ(LRFILE,LRB1_","_LRIENS,.01,"","LRTMP("_LRB1_")")
"RTN","LRAPBR1",40,0)
 .I $D(LRTMP(LRB1)) S LRCT2=LRCT2+1
"RTN","LRAPBR1",41,0)
 S LRA1=0 F  S LRA1=$O(LRTMP(LRA1)) Q:'LRA1  D
"RTN","LRAPBR1",42,0)
 .S LRTEXT=LRTMP(LRA1,LRFILE,LRA1_","_LRIENS,.01)
"RTN","LRAPBR1",43,0)
 .D GLENTRY(LRTEXT,"",1)
"RTN","LRAPBR1",44,0)
 Q
"RTN","LRAPBR1",45,0)
MODCHK ;Display modified banner if required
"RTN","LRAPBR1",46,0)
 S LRAPMR=$$GET1^DIQ(LRSF,LRIENS,.17,"I")
"RTN","LRAPBR1",47,0)
 Q:'LRAPMR
"RTN","LRAPBR1",48,0)
 S LRAPMD=$$GET1^DIQ(LRSF,LRIENS,.172,"I")
"RTN","LRAPBR1",49,0)
 D GLENTRY("","",1)
"RTN","LRAPBR1",50,0)
 S LRTEXT=""
"RTN","LRAPBR1",51,0)
 F LRCNT=1:1:$S(LRAPMD:14,1:15) D
"RTN","LRAPBR1",52,0)
 .S LRTEXT=LRTEXT_"*+"
"RTN","LRAPBR1",53,0)
 S LRTEXT=LRTEXT_" MODIFIED "
"RTN","LRAPBR1",54,0)
 S LRTEXT=LRTEXT_$S(LRAPMD:"DIAGNOSIS ",1:"REPORT ")
"RTN","LRAPBR1",55,0)
 F LRCNT=1:1:$S(LRAPMD:14,1:15) D
"RTN","LRAPBR1",56,0)
 .S LRTEXT=LRTEXT_"*+"
"RTN","LRAPBR1",57,0)
 D GLENTRY(LRTEXT,"",1)
"RTN","LRAPBR1",58,0)
 D GLENTRY("","",1)
"RTN","LRAPBR1",59,0)
 Q
"RTN","LRAPBR1",60,0)
SUPBNNR ;Display supplementary report header if one or more has been added
"RTN","LRAPBR1",61,0)
 I $P($G(^LR(LRDFN,LRSS,LRI,1.2,0)),U,4) D
"RTN","LRAPBR1",62,0)
 .S LRTEXT="*+* SUPPLEMENTARY REPORT HAS BEEN ADDED *+*"
"RTN","LRAPBR1",63,0)
 .D GLENTRY($$CJ^XLFSTR(LRTEXT,IOM),"",1)
"RTN","LRAPBR1",64,0)
 .S LRTEXT="*+* REFER TO BOTTOM OF REPORT *+*"
"RTN","LRAPBR1",65,0)
 .D GLENTRY($$CJ^XLFSTR(LRTEXT,IOM),"",1)
"RTN","LRAPBR1",66,0)
 .D GLENTRY("","",1)
"RTN","LRAPBR1",67,0)
 Q
"RTN","LRAPBR1",68,0)
DIAG ;
"RTN","LRAPBR1",69,0)
 ;Display the Brief Clinical History, Preoperative Diagnosis,
"RTN","LRAPBR1",70,0)
 ;Operative Findings, and Postoperative Diagnosis
"RTN","LRAPBR1",71,0)
 S LRFILE=LRSF,LRCNT=0,LRIENS=LRI_","_LRDFN_","
"RTN","LRAPBR1",72,0)
 F LRFLD=.013:.001:.016 D
"RTN","LRAPBR1",73,0)
 .D:LRA DASH
"RTN","LRAPBR1",74,0)
 .S LRCNT=LRCNT+1
"RTN","LRAPBR1",75,0)
 .D GLENTRY($P($T(TEXT1+LRCNT),";",2),"",1)
"RTN","LRAPBR1",76,0)
 .D WP
"RTN","LRAPBR1",77,0)
 Q
"RTN","LRAPBR1",78,0)
DOC ;
"RTN","LRAPBR1",79,0)
 ;Pathologist information
"RTN","LRAPBR1",80,0)
 D GLENTRY("","",1)
"RTN","LRAPBR1",81,0)
 D GLENTRY("Surgeon/physician: "_LRMD,27,1)
"RTN","LRAPBR1",82,0)
 D:LRA GLENTRY(LR("%1"),"",1)
"RTN","LRAPBR1",83,0)
 D DASH
"RTN","LRAPBR1",84,0)
 D HEADER2
"RTN","LRAPBR1",85,0)
 D:LRA DASH
"RTN","LRAPBR1",86,0)
 I LRRC="" D
"RTN","LRAPBR1",87,0)
 .D GLENTRY("+*+* REPORT INCOMPLETE *+*+",20,1)
"RTN","LRAPBR1",88,0)
 .D GLENTRY("","",1)
"RTN","LRAPBR1",89,0)
 D GLENTRY("","",1)
"RTN","LRAPBR1",90,0)
 I LRRMD'="" D
"RTN","LRAPBR1",91,0)
 .S LRCNT=0 F LRA1="SP","CY","EM" D
"RTN","LRAPBR1",92,0)
 ..S LRCNT=LRCNT+1
"RTN","LRAPBR1",93,0)
 ..S LRTMP(LRA1)=$P($T(TEXT2+LRCNT),";",3)
"RTN","LRAPBR1",94,0)
 .S LRTMP=LRTMP(LRSS)
"RTN","LRAPBR1",95,0)
 .D GLENTRY(LRTMP_" "_LRRMD,31)
"RTN","LRAPBR1",96,0)
 Q
"RTN","LRAPBR1",97,0)
WPFLD ;
"RTN","LRAPBR1",98,0)
 ;Display Frozen Section, Gross Description, Microscopic Description
"RTN","LRAPBR1",99,0)
 ;and Surgical Path Diagnosis
"RTN","LRAPBR1",100,0)
 F LRCNT=1:1:4 D
"RTN","LRAPBR1",101,0)
 .S X=$T(FIELDS+LRCNT)
"RTN","LRAPBR1",102,0)
 .S LRV=$P(X,";",2),LRV1=$P(X,";",3),LRV2=$P(X,";",4)
"RTN","LRAPBR1",103,0)
 .D TEXTCHK
"RTN","LRAPBR1",104,0)
 .I $P($G(^LR(LRDFN,LRSS,LRI,LRV,0)),U,4) D
"RTN","LRAPBR1",105,0)
 ..D GLENTRY("","",1),GLENTRY(LR(69.2,LRV1),"",1)
"RTN","LRAPBR1",106,0)
 ..S LRFILE=LRSF,LRIENS=LRI_","_LRDFN_",",LRFLD=LRV
"RTN","LRAPBR1",107,0)
 ..I $P($G(^LR(LRDFN,LRSS,LRI,LRV2,0)),U,4) D
"RTN","LRAPBR1",108,0)
 ...S LRFILE1=+$$GET1^DID(LRSF,LRV2,"","SPECIFIER")
"RTN","LRAPBR1",109,0)
 ...D GLENTRY("*+* MODIFIED REPORT *+*",28,1)
"RTN","LRAPBR1",110,0)
 ...D GLENTRY("(Last modified: ","",1)
"RTN","LRAPBR1",111,0)
 ...S (LRA1,LRB1)=0
"RTN","LRAPBR1",112,0)
 ...F  S LRA1=$O(^LR(LRDFN,LRSS,LRI,LRV2,LRA1)) Q:'LRA1  S LRB1=LRA1
"RTN","LRAPBR1",113,0)
 ...Q:'$D(^LR(LRDFN,LRSS,LRI,LRV2,LRB1,0))
"RTN","LRAPBR1",114,0)
 ...S LRSR1=$$GET1^DIQ(LRFILE1,LRB1_","_LRIENS,.01)
"RTN","LRAPBR1",115,0)
 ...S LRSR2=$$GET1^DIQ(LRFILE1,LRB1_","_LRIENS,.02)
"RTN","LRAPBR1",116,0)
 ...S LRTEXT=LRSR1_" typed by "_LRSR2_")"
"RTN","LRAPBR1",117,0)
 ...D GLENTRY(LRTEXT,BTAB)
"RTN","LRAPBR1",118,0)
 ..D WP
"RTN","LRAPBR1",119,0)
 Q
"RTN","LRAPBR1",120,0)
SUPRPT ;Supplementary Report
"RTN","LRAPBR1",121,0)
 I $P($G(^LR(LRDFN,LRSS,LRI,1.2,0)),U,4) D
"RTN","LRAPBR1",122,0)
 .S LRFILE=+$$GET1^DID(LRSF,1.2,"","SPECIFIER")
"RTN","LRAPBR1",123,0)
 .S LRIENS1=LRI_","_LRDFN_","
"RTN","LRAPBR1",124,0)
 .D GLENTRY("","",1),GLENTRY("SUPPLEMENTARY REPORT(S):","",1)
"RTN","LRAPBR1",125,0)
 .S LRV=0 F  S LRV=$O(^LR(LRDFN,LRSS,LRI,1.2,LRV)) Q:'LRV  D
"RTN","LRAPBR1",126,0)
 ..S LRIENS=LRV_","_LRIENS1
"RTN","LRAPBR1",127,0)
 ..S LRSR1=$$GET1^DIQ(LRFILE,LRIENS,.01)
"RTN","LRAPBR1",128,0)
 ..S LRSR2=+$$GET1^DIQ(LRFILE,LRIENS,.02)
"RTN","LRAPBR1",129,0)
 ..D GLENTRY("Supplementary Report Date: "_LRSR1,3,1)
"RTN","LRAPBR1",130,0)
 ..I $D(LR("R")),'LRSR2 D GLENTRY(" not verified",BTAB) Q
"RTN","LRAPBR1",131,0)
 ..I $P($G(^LR(LRDFN,LRSS,LRI,1.2,LRV,2,0)),U,4) D
"RTN","LRAPBR1",132,0)
 ...S LRTEXT="*+* SUPPLEMENTARY REPORT HAS BEEN ADDED/MODIFIED *+*"
"RTN","LRAPBR1",133,0)
 ...D GLENTRY($$CJ^XLFSTR(LRTEXT,IOM),"",1)
"RTN","LRAPBR1",134,0)
 ...D GLENTRY("(Added/Last","",1)
"RTN","LRAPBR1",135,0)
 ...S (LRA1,LRB1)=0
"RTN","LRAPBR1",136,0)
 ...F  S LRA1=$O(^LR(LRDFN,LRSS,LRI,1.2,LRV,2,LRA1)) Q:'LRA1  D
"RTN","LRAPBR1",137,0)
 ....S LRB1=LRA1
"RTN","LRAPBR1",138,0)
 ...Q:'$D(^LR(LRDFN,LRSS,LRI,1.2,LRV,2,LRB1,0))
"RTN","LRAPBR1",139,0)
 ...S LRA2=^(0),Y=+LRA2,LRA2A=$P(LRA2,"^",2),LRSGN=" Typed by ",LRDSC=" modified: "
"RTN","LRAPBR1",140,0)
 ...I $P(LRA2,"^",3) S LRSGN=" Signed by ",LRDSC=" released: ",LRA2A=$P(LRA2,"^",3),Y=$P(LRA2,"^",4)
"RTN","LRAPBR1",141,0)
 ...S LRA2A=$S($D(^VA(200,LRA2A,0)):$P(^(0),"^"),1:LRA2A)
"RTN","LRAPBR1",142,0)
 ...D D^LRU
"RTN","LRAPBR1",143,0)
 ...D GLENTRY(LRDSC_Y_LRSGN_LRA2A_")",BTAB)
"RTN","LRAPBR1",144,0)
 ..S LRFLD=1 D WP
"RTN","LRAPBR1",145,0)
 ..D GLENTRY("","",1)
"RTN","LRAPBR1",146,0)
 Q
"RTN","LRAPBR1",147,0)
SSJR ;Print special studies/journal references
"RTN","LRAPBR1",148,0)
 D ^LRAPBR3
"RTN","LRAPBR1",149,0)
 S LREFLG=1
"RTN","LRAPBR1",150,0)
 Q
"RTN","LRAPBR1",151,0)
WP ;Display word procesing fields
"RTN","LRAPBR1",152,0)
 K LRTMP,^UTILITY($J,"W")
"RTN","LRAPBR1",153,0)
 N X,DIWR,DIWL,LRINC
"RTN","LRAPBR1",154,0)
 S X=$$GET1^DIQ(LRFILE,LRIENS,LRFLD,"","LRTMP",)
"RTN","LRAPBR1",155,0)
 S DIWR=IOM-5,DIWL=5,DIWF=""
"RTN","LRAPBR1",156,0)
 S X=+$$GET1^DID(LRFILE,LRFLD,"","SPECIFIER")
"RTN","LRAPBR1",157,0)
 I $$GET1^DID(X,.01,"","SPECIFIER")["L" S DIWF="N"
"RTN","LRAPBR1",158,0)
 S LRINC=0
"RTN","LRAPBR1",159,0)
 F  S LRINC=$O(LRTMP(LRINC)) Q:'LRINC  S X=LRTMP(LRINC) D ^DIWP
"RTN","LRAPBR1",160,0)
 S LRINC=0
"RTN","LRAPBR1",161,0)
 F  S LRINC=$O(^UTILITY($J,"W",DIWL,LRINC)) Q:'LRINC  D
"RTN","LRAPBR1",162,0)
 .D GLENTRY(^UTILITY($J,"W",DIWL,LRINC,0),DIWL,1)
"RTN","LRAPBR1",163,0)
 K ^UTILITY($J,"W")
"RTN","LRAPBR1",164,0)
 Q
"RTN","LRAPBR1",165,0)
HEADER ;
"RTN","LRAPBR1",166,0)
 D:LRTIU GLENTRY("$APHDR",,1)
"RTN","LRAPBR1",167,0)
 D GLENTRY("","",1)
"RTN","LRAPBR1",168,0)
 D DASH
"RTN","LRAPBR1",169,0)
 D GLENTRY("MEDICAL RECORD |",5,1)
"RTN","LRAPBR1",170,0)
 D GLENTRY(LRAA1,40)
"RTN","LRAPBR1",171,0)
 D DASH
"RTN","LRAPBR1",172,0)
HEADER2 ;
"RTN","LRAPBR1",173,0)
 S LRADESC="Accession No. "_$S(LRQ(8)]"":LRQ(8)_LRW(1)_" "_LRAC,1:LRAC)
"RTN","LRAPBR1",174,0)
 S LRLENG1=$L(LRQ(1)),LRLENG2=$L(LRADESC),LRSPCE=IOM-LRLENG2-14
"RTN","LRAPBR1",175,0)
 S:LRLENG1>LRSPCE LRQ(1)=$E(LRQ(1),1,LRSPCE)
"RTN","LRAPBR1",176,0)
 D GLENTRY("PATHOLOGY REPORT",30,1)
"RTN","LRAPBR1",177,0)
 D GLENTRY("Laboratory: "_LRQ(1),"",1)
"RTN","LRAPBR1",178,0)
 D GLENTRY(LRADESC,IOM-LRLENG2-1)
"RTN","LRAPBR1",179,0)
 Q
"RTN","LRAPBR1",180,0)
FOOTER ;Footer-called from ^LRAPBR
"RTN","LRAPBR1",181,0)
 D:LRTIU GLENTRY("$FTR",,1)
"RTN","LRAPBR1",182,0)
 D DASH
"RTN","LRAPBR1",183,0)
 S LRTEXT=$S('$D(LR("W")):"",1:"See signed copy in chart")
"RTN","LRAPBR1",184,0)
 D GLENTRY(LRTEXT,"",1)
"RTN","LRAPBR1",185,0)
 S LRTEXT="("_$S($D(LREFLG):"End of report",1:"See next page")_")"
"RTN","LRAPBR1",186,0)
 D GLENTRY(LRTEXT,57)
"RTN","LRAPBR1",187,0)
 D GLENTRY(LRPMD,"",1),GLENTRY(LRW(9),52),GLENTRY("| Date "_LRRC,55)
"RTN","LRAPBR1",188,0)
 D DASH
"RTN","LRAPBR1",189,0)
 D GLENTRY(LRP,"",1)
"RTN","LRAPBR1",190,0)
 S LRTEXT=$S('$D(LR("W")):"STANDARD FORM 515",1:"WORK COPY ONLY !!")
"RTN","LRAPBR1",191,0)
 D GLENTRY(LRTEXT,50)
"RTN","LRAPBR1",192,0)
 D GLENTRY("ID:"_SSN,"",1)
"RTN","LRAPBR1",193,0)
 D GLENTRY("SEX:"_SEX,16),GLENTRY(" DOB:"_DOB,BTAB)
"RTN","LRAPBR1",194,0)
 I AGE D
"RTN","LRAPBR1",195,0)
 .S LRTEXT=$S($G(VADM(6))]"":" AGE AT DEATH: ",1:" AGE: ")_AGE
"RTN","LRAPBR1",196,0)
 .D GLENTRY(LRTEXT,BTAB)
"RTN","LRAPBR1",197,0)
 D GLENTRY(" LOC:"_LRLLOC,BTAB)
"RTN","LRAPBR1",198,0)
 D GLENTRY("","",1)
"RTN","LRAPBR1",199,0)
 D:$L(LRADM) GLENTRY("ADM:"_$P(LRADM,"@"),BTAB)
"RTN","LRAPBR1",200,0)
 D:$L(LRADX) GLENTRY("DX:"_$E(LRADX,1,26),17)
"RTN","LRAPBR1",201,0)
 D GLENTRY("PCP:",46)
"RTN","LRAPBR1",202,0)
 D:$L(LRPRAC) GLENTRY($E(LRPRAC(1),1,28),51)
"RTN","LRAPBR1",203,0)
 Q
"RTN","LRAPBR1",204,0)
ESIGLN ;Write signature block name, title, and date of signature
"RTN","LRAPBR1",205,0)
 D GLENTRY(,,1)
"RTN","LRAPBR1",206,0)
 I $D(^VA(200,DUZ,0)) D
"RTN","LRAPBR1",207,0)
 .S LRFILE=200,LRFLD=20.2,LRFLD2=20.3
"RTN","LRAPBR1",208,0)
 .S X=$$GET1^DIQ(LRFILE,DUZ,LRFLD)
"RTN","LRAPBR1",209,0)
 ;Compare DUZ to pathologist, if different, use proxy signature
"RTN","LRAPBR1",210,0)
 S:LRSS="AU" LRPATH=$$GET1^DIQ(63,LRDFN,13.6,"I")
"RTN","LRAPBR1",211,0)
 I LRSS'="AU" D
"RTN","LRAPBR1",212,0)
 .S LRFL2=$S(LRSS="EM":63.02,LRSS="CY":63.09,LRSS="SP":63.08,1:0)
"RTN","LRAPBR1",213,0)
 .S LRIENS=LRI_","_LRDFN_","
"RTN","LRAPBR1",214,0)
 .S LRPATH=$$GET1^DIQ(LRFL2,LRIENS,.02,"I")
"RTN","LRAPBR1",215,0)
 S LRPATH2=""
"RTN","LRAPBR1",216,0)
 S:LRPATH'=DUZ LRPATH2=" FOR "_$$GET1^DIQ(LRFILE,LRPATH,LRFLD)
"RTN","LRAPBR1",217,0)
 S LRTEXT="/es/ "_X_LRPATH2
"RTN","LRAPBR1",218,0)
 ;S LRTEXT="/es/ "_X
"RTN","LRAPBR1",219,0)
 D GLENTRY(LRTEXT,,1)
"RTN","LRAPBR1",220,0)
 S X=$$GET1^DIQ(LRFILE,DUZ,LRFLD2)
"RTN","LRAPBR1",221,0)
 S LRTEXT=X
"RTN","LRAPBR1",222,0)
 D GLENTRY(LRTEXT,,1)
"RTN","LRAPBR1",223,0)
 S Y=LRNTIME D DD^%DT
"RTN","LRAPBR1",224,0)
 S LRTEXT="Signed "_Y
"RTN","LRAPBR1",225,0)
 D GLENTRY(LRTEXT,,1)
"RTN","LRAPBR1",226,0)
 Q
"RTN","LRAPBR1",227,0)
DASH ;Display a line of dashes
"RTN","LRAPBR1",228,0)
 D GLENTRY(LR("%"),"",1)
"RTN","LRAPBR1",229,0)
 Q
"RTN","LRAPBR1",230,0)
GLENTRY(LRPR1,LRPR2,LRPR3) ;Write to global
"RTN","LRAPBR1",231,0)
 ;LRPR1 = Text to be written to global
"RTN","LRAPBR1",232,0)
 ;LRPR2 = Tab position
"RTN","LRAPBR1",233,0)
 ;LRPR3 = 1 means start a new line.  Othewise, write an current line.
"RTN","LRAPBR1",234,0)
 S LRPR1=$G(LRPR1)
"RTN","LRAPBR1",235,0)
 S LRPR2=+$G(LRPR2)
"RTN","LRAPBR1",236,0)
 S LRPR3=+$G(LRPR3)
"RTN","LRAPBR1",237,0)
 D:LRPR3 NEWLN^LRAPUTL(LRPR1,LRPR2)
"RTN","LRAPBR1",238,0)
 D:'LRPR3 GLBWRT^LRAPUTL(LRPR1,LRPR2)
"RTN","LRAPBR1",239,0)
 Q
"RTN","LRAPBR1",240,0)
TEXT1 ;Text for top of report
"RTN","LRAPBR1",241,0)
 ;BRIEF CLINICAL HISTORY:
"RTN","LRAPBR1",242,0)
 ;PREOPERATIVE DIAGNOSIS:
"RTN","LRAPBR1",243,0)
 ;OPERATIVE FINDINGS:
"RTN","LRAPBR1",244,0)
 ;POSTOPERATIVE DIAGNOSIS:
"RTN","LRAPBR1",245,0)
TEXT2 ;Descriptive text based on section
"RTN","LRAPBR1",246,0)
 ;SP;Pathology Resident:
"RTN","LRAPBR1",247,0)
 ;CY;Screened by:
"RTN","LRAPBR1",248,0)
 ;EM;Prepared by:
"RTN","LRAPBR1",249,0)
FIELDS ;Field numbers for word processing fields
"RTN","LRAPBR1",250,0)
 ;1.3;.13;6
"RTN","LRAPBR1",251,0)
 ;1;.03;7
"RTN","LRAPBR1",252,0)
 ;1.1;.04;4
"RTN","LRAPBR1",253,0)
 ;1.4;.14;5
"RTN","LRAPBR1",254,0)
TEXTCHK ; update text line counter if it is missing (Remedy 116253)
"RTN","LRAPBR1",255,0)
 N I,X,DATA
"RTN","LRAPBR1",256,0)
 S I=0
"RTN","LRAPBR1",257,0)
 K ^TMP("WP",$J)
"RTN","LRAPBR1",258,0)
 S X=$G(^LR(LRDFN,LRSS,LRI,LRV,0))
"RTN","LRAPBR1",259,0)
 I X'="",$L(X,"^")=1 D
"RTN","LRAPBR1",260,0)
 . F  S I=$O(^LR(LRDFN,LRSS,LRI,LRV,I)) Q:I=""  D
"RTN","LRAPBR1",261,0)
 . . S DATA=$G(^LR(LRDFN,LRSS,LRI,LRV,I,0))
"RTN","LRAPBR1",262,0)
 . . S ^TMP("WP",$J,I,0)=DATA
"RTN","LRAPBR1",263,0)
 I $D(^TMP("WP",$J)) D
"RTN","LRAPBR1",264,0)
 . D WP^DIE(63.08,LRI_","_LRDFN_",",LRV,"","^TMP(""WP"",$J)")
"RTN","LRAPBR1",265,0)
 . K ^TMP("WP",$J)
"RTN","LRAPBR1",266,0)
 Q
"VER")
8.0^22.0
"BLD",6934,6)
^291
**END**
**END**
