Released XU*8*288 SEQ #255
Extracted from mail message
**KIDS**:XU*8.0*288^

**INSTALL NAME**
XU*8.0*288
"BLD",668,0)
XU*8.0*288^KERNEL^0^3030220^y
"BLD",668,1,0)
^^2^2^3030220^
"BLD",668,1,1,0)
Please refer to the Description in the FORUM Patch Module for details.
"BLD",668,1,2,0)
See patch XU*8*288 Updated DEA~XUSER API.
"BLD",668,4,0)
^9.64PA^^
"BLD",668,"KRN",0)
^9.67PA^8989.52^19
"BLD",668,"KRN",.4,0)
.4
"BLD",668,"KRN",.401,0)
.401
"BLD",668,"KRN",.402,0)
.402
"BLD",668,"KRN",.403,0)
.403
"BLD",668,"KRN",.5,0)
.5
"BLD",668,"KRN",.84,0)
.84
"BLD",668,"KRN",3.6,0)
3.6
"BLD",668,"KRN",3.8,0)
3.8
"BLD",668,"KRN",9.2,0)
9.2
"BLD",668,"KRN",9.8,0)
9.8
"BLD",668,"KRN",9.8,"NM",0)
^9.68A^1^1
"BLD",668,"KRN",9.8,"NM",1,0)
XUSER^^0^B6045068
"BLD",668,"KRN",9.8,"NM","B","XUSER",1)

"BLD",668,"KRN",19,0)
19
"BLD",668,"KRN",19,"NM",0)
^9.68A^2^2
"BLD",668,"KRN",19,"NM",1,0)
XU-INSTITUTION-DEA^^0
"BLD",668,"KRN",19,"NM",2,0)
XUKERNEL^^2
"BLD",668,"KRN",19,"NM","B","XU-INSTITUTION-DEA",1)

"BLD",668,"KRN",19,"NM","B","XUKERNEL",2)

"BLD",668,"KRN",19.1,0)
19.1
"BLD",668,"KRN",101,0)
101
"BLD",668,"KRN",409.61,0)
409.61
"BLD",668,"KRN",771,0)
771
"BLD",668,"KRN",870,0)
870
"BLD",668,"KRN",8989.51,0)
8989.51
"BLD",668,"KRN",8989.52,0)
8989.52
"BLD",668,"KRN",8994,0)
8994
"BLD",668,"KRN","B",.4,.4)

"BLD",668,"KRN","B",.401,.401)

"BLD",668,"KRN","B",.402,.402)

"BLD",668,"KRN","B",.403,.403)

"BLD",668,"KRN","B",.5,.5)

"BLD",668,"KRN","B",.84,.84)

"BLD",668,"KRN","B",3.6,3.6)

"BLD",668,"KRN","B",3.8,3.8)

"BLD",668,"KRN","B",9.2,9.2)

"BLD",668,"KRN","B",9.8,9.8)

"BLD",668,"KRN","B",19,19)

"BLD",668,"KRN","B",19.1,19.1)

"BLD",668,"KRN","B",101,101)

"BLD",668,"KRN","B",409.61,409.61)

"BLD",668,"KRN","B",771,771)

"BLD",668,"KRN","B",870,870)

"BLD",668,"KRN","B",8989.51,8989.51)

"BLD",668,"KRN","B",8989.52,8989.52)

"BLD",668,"KRN","B",8994,8994)

"BLD",668,"QUES",0)
^9.62^^
"BLD",668,"REQB",0)
^9.611^1^1
"BLD",668,"REQB",1,0)
XU*8.0*267^2
"BLD",668,"REQB","B","XU*8.0*267",1)

"KRN",19,149,-1)
2^2
"KRN",19,149,0)
XUKERNEL^Kernel Management Menu^^M^.5^^^^^^^^y
"KRN",19,149,10,0)
^19.01IP^6^6
"KRN",19,149,10,6,0)
898
"KRN",19,149,10,6,"^")
XU-INSTITUTION-DEA
"KRN",19,149,"U")
KERNEL MANAGEMENT MENU
"KRN",19,898,-1)
0^1
"KRN",19,898,0)
XU-INSTITUTION-DEA^Institution DEA# edit^^E^^XUMGR^^^^^^KERNEL^n
"KRN",19,898,1,0)
^^2^2^3030220^
"KRN",19,898,1,1,0)
This option allows the editing of the Facility DEA number in the 
"KRN",19,898,1,2,0)
Institution file.
"KRN",19,898,30)
DIC(4,
"KRN",19,898,31)
AEMQ
"KRN",19,898,50)
DIC(4,
"KRN",19,898,51)
52
"KRN",19,898,"U")
INSTITUTION DEA# EDIT
"MBREQ")
0
"ORD",18,19)
19;18;;;OPT^XPDTA;OPTF1^XPDIA;OPTE1^XPDIA;OPTF2^XPDIA;;OPTDEL^XPDIA
"ORD",18,19,0)
OPTION
"PKG",3,-1)
1^1
"PKG",3,0)
KERNEL^XU^SIGN-ON, SECURITY, MENU DRIVER, DEVICES, TASKMAN^
"PKG",3,20,0)
^9.402P^^0
"PKG",3,22,0)
^9.49I^1^1
"PKG",3,22,1,0)
8.0^2950703^2970507^.5
"PKG",3,22,1,"PAH",1,0)
288^3030220
"PKG",3,22,1,"PAH",1,1,0)
^^2^2^3030220
"PKG",3,22,1,"PAH",1,1,1,0)
Please refer to the Description in the FORUM Patch Module for details.
"PKG",3,22,1,"PAH",1,1,2,0)
See patch XU*8*288 Updated DEA~XUSER API.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
1
"RTN","XUSER")
0^1^B6045068
"RTN","XUSER",1,0)
XUSER ;SFISC/RWF - A common set of user functions ;02/20/2003  12:47
"RTN","XUSER",2,0)
 ;;8.0;KERNEL;**75,97,99,150,226,267,288**;Jul 10, 1995
"RTN","XUSER",3,0)
 ;Covered under DBIA #2343
"RTN","XUSER",4,0)
 Q
"RTN","XUSER",5,0)
LOOKUP(XUF) ;Do a user lookup
"RTN","XUSER",6,0)
 ;Parameter, "Q" to NOT ask OK.
"RTN","XUSER",7,0)
 ;Parameter, "A" Don't select current users who have a termination
"RTN","XUSER",8,0)
 ;               date prior to today's date
"RTN","XUSER",9,0)
 N DIC,XUDA,DIR,Y
"RTN","XUSER",10,0)
LK1 S DIC="^VA(200,",DIC(0)="AEMQZ" D ^DIC S XUDA=Y G:Y'>0 LKX
"RTN","XUSER",11,0)
 S Y=$P(Y(0),"^",11) I Y>0,Y<DT W !?15,"This user was terminated on ",$$FMTE^XLFDT(Y) I $G(XUF)["A" S XUDA=-1 G LK1
"RTN","XUSER",12,0)
 G:$G(XUF)["Q" LKX
"RTN","XUSER",13,0)
 S DIR(0)="Y",DIR("A")=" Is "_$P(XUDA,U,2)_" the one you want",DIR("B")="YES" D ^DIR
"RTN","XUSER",14,0)
 I Y'=1 S XUDA=-1 G:'$D(DIRUT) LK1
"RTN","XUSER",15,0)
LKX Q XUDA
"RTN","XUSER",16,0)
 ;
"RTN","XUSER",17,0)
ACTIVE(XUDA) ;Get if a user is active.
"RTN","XUSER",18,0)
 N %,X1,X2
"RTN","XUSER",19,0)
 S X1=$G(^VA(200,+$G(XUDA),0)),X2=$S(X1="":"",1:0)
"RTN","XUSER",20,0)
 I $L($P(X1,U,3)) S X2="1^"_$S($L($P($G(^VA(200,XUDA,.1)),U,2)):"ACTIVE",1:"NEW")
"RTN","XUSER",21,0)
 S:$P(X1,U,7)=1 X2="0^DISUSER"
"RTN","XUSER",22,0)
 S:X2["ACTIVE" $P(X2,U,3)=$P($G(^VA(200,XUDA,1.1)),U) ;Return last sign-on
"RTN","XUSER",23,0)
 S %=$P(X1,U,11) I %>0,%<DT S X2="0^TERMINATED^"_%
"RTN","XUSER",24,0)
 Q X2
"RTN","XUSER",25,0)
 ;
"RTN","XUSER",26,0)
PROVIDER(XUDA,XUF) ;See if user qualifies as a CPRS provider
"RTN","XUSER",27,0)
 ;At this time the only test is that the user isn't terminated
"RTN","XUSER",28,0)
 N %,X1,X2
"RTN","XUSER",29,0)
 S X1=$G(^VA(200,+$G(XUDA),0)),X2=$S(X1="":"",1:1)
"RTN","XUSER",30,0)
 S %=$P(X1,U,11) I %>0,%<DT S X2="0^TERMINATED^"_%
"RTN","XUSER",31,0)
 Q X2
"RTN","XUSER",32,0)
 ;
"RTN","XUSER",33,0)
DEA(FG,IEN) ;sr. ef. Return users DEA # or Facility DEA_"-"_user VA# or null
"RTN","XUSER",34,0)
 ;If FG is 1: DEA# or VA#
"RTN","XUSER",35,0)
 N DEA,VA,IN,N,N1,INN
"RTN","XUSER",36,0)
 S IEN=$G(IEN,DUZ),INN=+DUZ(2)
"RTN","XUSER",37,0)
 S N=$G(^VA(200,IEN,"PS")),N1=$G(^VA(200,IEN,"QAR"))
"RTN","XUSER",38,0)
 S DEA=$P(N,U,2),VA=$P(N,U,3)
"RTN","XUSER",39,0)
 I $L(DEA),$S('$L($P(N1,U,9)):1,1:$P(N1,U,9)>DT) Q DEA
"RTN","XUSER",40,0)
 I $G(FG) Q VA
"RTN","XUSER",41,0)
 S IN=$P($G(^DIC(4,INN,"DEA")),U) ;Check signed-in Inst.
"RTN","XUSER",42,0)
 I '$L(IN) D
"RTN","XUSER",43,0)
 . N XU1 D PARENT^XUAF4("XU1","`"_INN,"PARENT FACILITY")
"RTN","XUSER",44,0)
 . S INN=$O(XU1("P","")) I INN S IN=$P($G(^DIC(4,INN,"DEA")),U)
"RTN","XUSER",45,0)
 . Q
"RTN","XUSER",46,0)
 I $L(VA),$L(IN) Q IN_"-"_VA
"RTN","XUSER",47,0)
 Q ""
"RTN","XUSER",48,0)
 ;
"RTN","XUSER",49,0)
DIV4(XUROOT,XUDUZ) ;Return the Divisions that this user is assigned to.
"RTN","XUSER",50,0)
 ;Returns 0 - no institution for user, 1 - institution for user
"RTN","XUSER",51,0)
 ;XUROOT is passed by reference.
"RTN","XUSER",52,0)
 N %,%1 S:$G(XUDUZ)="" XUDUZ=DUZ S (%,%1)=0
"RTN","XUSER",53,0)
 F  S %=$O(^VA(200,XUDUZ,2,%)) Q:%'>0  S XUROOT(%)=$P($G(^(%,0)),U,2),%1=1
"RTN","XUSER",54,0)
 Q %1
"RTN","XUSER",55,0)
 ;
"RTN","XUSER",56,0)
NAME(IEN,FL) ;Return the full name from Name Components file
"RTN","XUSER",57,0)
 N NA S NA("FILE")=200,NA("FIELD")=.01,NA("IENS")=IEN
"RTN","XUSER",58,0)
 S FL=$G(FL,"G") ;Valid are Famly or Given
"RTN","XUSER",59,0)
 S:"FG"'[FL FL="G"
"RTN","XUSER",60,0)
 Q $$NAMEFMT^XLFNAME(.NA,FL,"CMDP")
"RTN","XUSER",61,0)
 ;
"RTN","XUSER",62,0)
HL7(IEN) ;Return a HL7 name from the components file
"RTN","XUSER",63,0)
 N NA S NA("FILE")=200,NA("FIELD")=.01,NA("IENS")=IEN
"RTN","XUSER",64,0)
 Q $$HLNAME^XLFNAME(.NA,"","~")
"VER")
8.0^22.0
**END**
**END**
