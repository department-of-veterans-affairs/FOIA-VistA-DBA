$TXT Created by NAPOLIELLO,GREG at MNTVBB.FO-ALBANY.MED.VA.GOV  (KIDS) on Wednesday, 03/05/03 at 15:24
=============================================================================
Run Date: APR 11, 2003                     Designation: DG*5.3*499
Package : DG - REGISTRATION                    Priority: Mandatory
Version : 5.3       SEQ #439                     Status: Released
                  Compliance Date: MAY 12, 2003
=============================================================================

Associated patches: (v)DG*5.3*433  <<= must be installed BEFORE `DG*5.3*499'

Subject: FIX CLAIM ENTER/EDIT SCREEN ERROR

Category: 
  - Routine

Description: 
============

 This patch will correct an "undefined variable" problem that was observed
 at a site when executing the menu option, Claim Enter/Edit [DGBT BENE
 TRAVEL SCREEN].
  
 Technical Overview:
 ===================
 The error reported seems to only occur for a specific scenario.  The
 scenario is where two variables, DGMTACT and DGMTI, are being used and are
 not defined by the beneficiary travel menu option routines.  One of these
 two variables, DGMTACT, can be left in the memory partition from previous
 use of a means test menu option.  The value of this variable will be equal
 to "VEW" for view a means test and the variable DGMTI will be undefined.
  
 The routine DGMTU3 is called by both Means Test menu options and by the
 beneficiary travel menu options.   The routine  contains a $SELECT test
 whereby, if the variable DGMTACT is equal to "VEW" then it assumes the
 variable DGMTI is populated and accurate.  In this case, it was not
 populated.  The $SELECT calls a lookup API when the value of DGMTACT was
 other than "VEW" to find the ien of the test.  This API needs the DFN of
 the patient and the test type passed as parameters to perform the
 lookup.  If the lookup API is successfully the ien and record of the last
 test for this patient is returned. The routine VAFMON was not passing in
 the Means/Co-pay test ien, in order that the correct type of test could be
 determined.  This was changed to allow the type of test to be determined
 and allow the routine DGMTU3 to call the lookup API to find the ien and
 test record.  Finding the correct ien stops the undefined error from
 occurring.
  
  
  
 This patch addresses the following E3R(s):
 ------------------------------------------
 There are no E3Rs associated with this patch.
  
  
 This patch addresses the following NOIS message(s):
 ---------------------------------------------------
 SBY-0802-30161  $ZE= IAI+10^DGMTU3:1, %DSM-E-UNDEF
  
  
 Overview of NOIS Message(s):
 ---------------------------
 SBY-0802-30161  $ZE= IAI+10^DGMTU3:1, %DSM-E-UNDEF
  
 Problem:
 --------
 Routine VAFMON was not passing in the Means/Co-pay test ien, in order 
 that the correct type of test could be determined. 
  
 Resolution:
 -----------
 This was changed to allow the type of test to be determined and allow the
 routine DGMTU3 changes to call the lookup API to find the ien and test
 record.  Finding the correct ien stops the undefined error from occurring.
  
  
 Test Sites:
 -----------
 Madison VAMC
 Salisbury VAMC
 GLAHS - West LA Campus VAMC
 Fayetteville NC VAMC
  
  
  
         ================INSTALLATION INSTRUCTIONS =================
  
 This patch can be installed with users on the system. 
       
 Install Time - less than 2 minutes.
  
  
   1.   LOAD TRANSPORT GLOBAL 
        ---------------------
        Choose the PackMan message containing this patch and invoke the 
        INSTALL/CHECK MESSAGE PackMan option.  
              
   2.   DISABLE ROUTINE MAPPING   (DSM for Open VMS sites only) 
        -----------------------
        Disable routine mapping on all systems for the routines listed in 
        step 3 below.  
       
        NOTE:  If the routines included in this patch are not currently in 
        your mapped routine set, please skip this step.
   
   3.   COMPONENTS SENT WITH PATCH 
        ------------------------
        The following is a list of the routines included in this patch.  
        The second line of each of these routines now looks like: 
   
           <tab>;;5.3;Registration;**[patch list]**;Aug 13, 1993  
           
                         CHECK^XTSUMBLD results
  
        Routine          Before Patch     After Patch   Patch List 
        -------          ------------     -----------   ----------
        DGMTU3           3824147          3154935       33,45,137,182,
                                                        300,433,499
        VAFMON           5910644          6117812       45,67,499
  
        Total number of routines - 2
   
  
   4.   START UP KIDS 
        -------------
        Start up the Kernel Installation and Distribution System Menu 
        [XPD MAIN]: 
    
             Edits and Distribution ...  
             Utilities ...  
             Installation ...  
    
   Select Kernel Installation & Distribution System Option: INStallation 
                                                            ---
             Load a Distribution 
             Print Transport Global 
             Compare Transport Global to Current System 
             Verify Checksums in Transport Global 
             Install Package(s) 
             Restart Install of Package(s) 
             Unload a Distribution 
             Backup a Transport Global 
    
   Select Installation Option: 
    
   5.   Select Installation Option: 
        --------------------------
        NOTE:  The following are OPTIONAL - (When prompted for the INSTALL
               NAME, enter DG*5.3*499):
       
        a.  Backup a Transport Global - This option will create a backup
            message of any routines exported with this patch. It will not
            backup any other changes such as DD's or templates.
        b.  Compare Transport Global to Current System - This option will
            allow you to view all changes that will be made when this patch
            is installed.  It compares all components of this patch
            (routines, DD's, templates, etc.).
        c.  Verify Checksums in Transport Global - This option will allow
            you to ensure the integrity of the routines that are in the
            transport global.
      
   6.   Select Installation Option: Install Package(s) 
                                    ----------------
        **This is the step to start the installation of this KIDS patch: 
    
        a.  Choose the Install Package(s) option to start the patch
            install.
        b.  When prompted 'Want KIDS to INHIBIT LOGONs during the install?
            YES//' answer NO 
        c.  When prompted 'Want to DISABLE Scheduled Options, Menu 
            Options, and Protocols? YES//' answer NO.
  
   7.   REBUILD MAPPED ROUTINE(S)  (DSM for Open VMS sites only)
        -------------------------
        Optional - Include the routines distributed with this patch
        in the mapped routine set.
      
        NOTE: This step is only necessary if you performed step 2 or 
        if you wish to include the routines in your mapped set.

Routine Information:
====================

Routine Name:
  - VAFMON

 Change this routine to pass the Means/Co-pay test ien on.  Without it 
 assumed always a Means test type of test and caused a variable undefined
 error.
  
 CHANGES:
 ************
 NEW
    34   .;    DG*5.3*499 pass ien of Means/Co-pay test via 5th parameter
    35   .D ALL^DGMTU21(DFN,"VS"_VADX,VADT,"I",+VAMT)
  
 ************
 ORIG
    34   .D ALL^DGMTU21(DFN,"VS"_VADX,VADT,"I")

Routine Checksum:

Routine Name:
  - DGMTU3

 Changed to check for presence of DGMTI an ien passed in by Means Test 
 routines but not by Bene Travel routines.  
  
 changes
 ************
 New
  30   N DFN,I,IEN,INR,MTIEN,LAST,DGDT
  31   S DFN=+$G(^DGPR(408.12,+REL,0)) I 'DFN G IAIQ
  32   ;
  33   ;DG*5.3*499, change to if structure and check for presence of DGMTI
  34   ; it is not defined when coming from Bene travel menus
  35   ;
  36   ; if user selects view option & DGMTI exists, set IEN=DGMTI
  37   I $G(DGMTACT)="VEW",$G(DGMTI) D
  38   . S MTIEN=DGMTI
  39   E  D
  40   . S DGDT=$E(YEAR,1,3)+1_"1231.99"
  41   . S MTIEN=$$LST^DGMTU(DFN,DGDT,$S($G(DGMTYPT):DGMTYPT,1:1))
 ************
 Orig
  30   N DFN,I,IEN,INR,MTIEN,LAST
  31   S DFN=+$G(^DGPR(408.12,+REL,0)) I 'DFN G IAIQ
  32   S MTIEN=$S($G(DGMTACT)'="VEW":$$LST^DGMTU(DFN,$E(YEAR,1,3)+1_
       "1231.99",$S($G(DGMTYPT):DGMTYPT,1:1)),1:DGMTI) ; If user selects
       view option, set IEN=DGMTI

Routine Checksum:

=============================================================================
User Information:                               
Entered By  : NAPOLIELLO,GREG                Date Entered : FEB 19, 2003
Completed By: LANDRY,DANNA                  Date Completed: APR 11, 2003
Released By : GROOMS,ANTHONY E             Date Released : APR 11, 2003
=============================================================================


Packman Mail Message:
=====================

$END TXT
