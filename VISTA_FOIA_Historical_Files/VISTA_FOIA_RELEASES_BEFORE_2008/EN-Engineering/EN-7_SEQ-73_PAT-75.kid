Released EN*7*75 SEQ #73
Extracted from mail message
**KIDS**:EN*7.0*75^

**INSTALL NAME**
EN*7.0*75
"BLD",4657,0)
EN*7.0*75^ENGINEERING^0^3030926^y
"BLD",4657,1,0)
^^1^1^3030403^
"BLD",4657,1,1,0)
DATA CLEANSING REPORTS FOR 6914 FILE
"BLD",4657,4,0)
^9.64PA^^
"BLD",4657,"ABPKG")
n
"BLD",4657,"KRN",0)
^9.67PA^8989.52^19
"BLD",4657,"KRN",.4,0)
.4
"BLD",4657,"KRN",.401,0)
.401
"BLD",4657,"KRN",.402,0)
.402
"BLD",4657,"KRN",.403,0)
.403
"BLD",4657,"KRN",.5,0)
.5
"BLD",4657,"KRN",.84,0)
.84
"BLD",4657,"KRN",3.6,0)
3.6
"BLD",4657,"KRN",3.8,0)
3.8
"BLD",4657,"KRN",9.2,0)
9.2
"BLD",4657,"KRN",9.8,0)
9.8
"BLD",4657,"KRN",9.8,"NM",0)
^9.68A^16^9
"BLD",4657,"KRN",9.8,"NM",1,0)
ENH6914^^0^B39873649
"BLD",4657,"KRN",9.8,"NM",7,0)
ENH6914F^^0^B41294763
"BLD",4657,"KRN",9.8,"NM",8,0)
ENH6914G^^0^B39721560
"BLD",4657,"KRN",9.8,"NM",9,0)
ENH6914I^^0^B63375761
"BLD",4657,"KRN",9.8,"NM",10,0)
ENH6914J^^0^B34141902
"BLD",4657,"KRN",9.8,"NM",13,0)
ENH6914R^^0^B37625991
"BLD",4657,"KRN",9.8,"NM",14,0)
ENH6914S^^0^B33212025
"BLD",4657,"KRN",9.8,"NM",15,0)
ENH6914T^^0^B30714521
"BLD",4657,"KRN",9.8,"NM",16,0)
ENH6914M^^0^B39879624
"BLD",4657,"KRN",9.8,"NM","B","ENH6914",1)

"BLD",4657,"KRN",9.8,"NM","B","ENH6914F",7)

"BLD",4657,"KRN",9.8,"NM","B","ENH6914G",8)

"BLD",4657,"KRN",9.8,"NM","B","ENH6914I",9)

"BLD",4657,"KRN",9.8,"NM","B","ENH6914J",10)

"BLD",4657,"KRN",9.8,"NM","B","ENH6914M",16)

"BLD",4657,"KRN",9.8,"NM","B","ENH6914R",13)

"BLD",4657,"KRN",9.8,"NM","B","ENH6914S",14)

"BLD",4657,"KRN",9.8,"NM","B","ENH6914T",15)

"BLD",4657,"KRN",19,0)
19
"BLD",4657,"KRN",19,"NM",0)
^9.68A^7^7
"BLD",4657,"KRN",19,"NM",1,0)
ENH EQUIPMENT INVENTORY^^0
"BLD",4657,"KRN",19,"NM",2,0)
ENH DATA CLEANSING^^2
"BLD",4657,"KRN",19,"NM",3,0)
ENH 6914 LOOKUP RPT^^0
"BLD",4657,"KRN",19,"NM",4,0)
ENH 6914 REQUIRED RPT^^0
"BLD",4657,"KRN",19,"NM",5,0)
ENH 6914 NON-REQUIRED RPT^^0
"BLD",4657,"KRN",19,"NM",6,0)
ENH 6914 SUMMARY REPORT^^0
"BLD",4657,"KRN",19,"NM",7,0)
ENH 6914 COMPILE^^0
"BLD",4657,"KRN",19,"NM","B","ENH 6914 COMPILE",7)

"BLD",4657,"KRN",19,"NM","B","ENH 6914 LOOKUP RPT",3)

"BLD",4657,"KRN",19,"NM","B","ENH 6914 NON-REQUIRED RPT",5)

"BLD",4657,"KRN",19,"NM","B","ENH 6914 REQUIRED RPT",4)

"BLD",4657,"KRN",19,"NM","B","ENH 6914 SUMMARY REPORT",6)

"BLD",4657,"KRN",19,"NM","B","ENH DATA CLEANSING",2)

"BLD",4657,"KRN",19,"NM","B","ENH EQUIPMENT INVENTORY",1)

"BLD",4657,"KRN",19.1,0)
19.1
"BLD",4657,"KRN",19.1,"NM",0)
^9.68A^^0
"BLD",4657,"KRN",101,0)
101
"BLD",4657,"KRN",409.61,0)
409.61
"BLD",4657,"KRN",771,0)
771
"BLD",4657,"KRN",870,0)
870
"BLD",4657,"KRN",8989.51,0)
8989.51
"BLD",4657,"KRN",8989.52,0)
8989.52
"BLD",4657,"KRN",8994,0)
8994
"BLD",4657,"KRN","B",.4,.4)

"BLD",4657,"KRN","B",.401,.401)

"BLD",4657,"KRN","B",.402,.402)

"BLD",4657,"KRN","B",.403,.403)

"BLD",4657,"KRN","B",.5,.5)

"BLD",4657,"KRN","B",.84,.84)

"BLD",4657,"KRN","B",3.6,3.6)

"BLD",4657,"KRN","B",3.8,3.8)

"BLD",4657,"KRN","B",9.2,9.2)

"BLD",4657,"KRN","B",9.8,9.8)

"BLD",4657,"KRN","B",19,19)

"BLD",4657,"KRN","B",19.1,19.1)

"BLD",4657,"KRN","B",101,101)

"BLD",4657,"KRN","B",409.61,409.61)

"BLD",4657,"KRN","B",771,771)

"BLD",4657,"KRN","B",870,870)

"BLD",4657,"KRN","B",8989.51,8989.51)

"BLD",4657,"KRN","B",8989.52,8989.52)

"BLD",4657,"KRN","B",8994,8994)

"BLD",4657,"QUES",0)
^9.62^^
"BLD",4657,"REQB",0)
^9.611^^0
"KRN",19,11578,-1)
2^2
"KRN",19,11578,0)
ENH DATA CLEANSING^CoreFLS AEMS/MERS Data Cleansing Reports^^M^101009^ENH DATA CLEANSING^^^^^^33
"KRN",19,11578,10,0)
^19.01IP^7^7
"KRN",19,11578,10,2,0)
11580^2^2
"KRN",19,11578,10,2,"^")
ENH EQUIPMENT INVENTORY
"KRN",19,11578,"U")
COREFLS AEMS/MERS DATA CLEANSI
"KRN",19,11580,-1)
0^1
"KRN",19,11580,0)
ENH EQUIPMENT INVENTORY^Equipment Inventory - 6914^^M^^ENH DATA CLEANSING^^^^^^ENGINEERING
"KRN",19,11580,1,0)
^19.06^2^2^3030916^^
"KRN",19,11580,1,1,0)
This menu displays all of the CoreFLS Data Cleansing report options for
"KRN",19,11580,1,2,0)
AEMS/MERS EQUIPMENT INV. (#6914) file.
"KRN",19,11580,10,0)
^19.01IP^5^5
"KRN",19,11580,10,1,0)
11715^2^2
"KRN",19,11580,10,1,"^")
ENH 6914 SUMMARY REPORT
"KRN",19,11580,10,2,0)
11716^3^3
"KRN",19,11580,10,2,"^")
ENH 6914 REQUIRED RPT
"KRN",19,11580,10,3,0)
11717^4^4
"KRN",19,11580,10,3,"^")
ENH 6914 LOOKUP RPT
"KRN",19,11580,10,4,0)
11718^5^5
"KRN",19,11580,10,4,"^")
ENH 6914 NON-REQUIRED RPT
"KRN",19,11580,10,5,0)
11785^1^1
"KRN",19,11580,10,5,"^")
ENH 6914 COMPILE
"KRN",19,11580,25)

"KRN",19,11580,99)
59428,60698
"KRN",19,11580,"U")
EQUIPMENT INVENTORY - 6914
"KRN",19,11715,-1)
0^6
"KRN",19,11715,0)
ENH 6914 SUMMARY REPORT^Summary Report^^R^^^^^^^^ENGINEERING^^1^
"KRN",19,11715,1,0)
^^4^4^3030915^
"KRN",19,11715,1,1,0)
This option prints or displays the CoreFLS Data Cleansing Summary Report
"KRN",19,11715,1,2,0)
for the EQUIPMENT INV. (#6914) file. The report shows the fields being
"KRN",19,11715,1,3,0)
checked and the total number of times that required fields and
"KRN",19,11715,1,4,0)
non-required fields are missing data and lookup fields have invalid data.
"KRN",19,11715,15)

"KRN",19,11715,20)
S ENHRPT=1
"KRN",19,11715,25)
REPTYP^ENH6914
"KRN",19,11715,"U")
SUMMARY REPORT
"KRN",19,11716,-1)
0^4
"KRN",19,11716,0)
ENH 6914 REQUIRED RPT^Required Fields Missing Data Report^^R^^^^^^^^ENGINEERING^^1^
"KRN",19,11716,1,0)
^^3^3^3030915^
"KRN",19,11716,1,1,0)
This option prints or displays the CoreFLS Data Cleansing Required Fields
"KRN",19,11716,1,2,0)
Missing Data Report for the EQUIPMENT INV. (#6914) file. The report lists
"KRN",19,11716,1,3,0)
the required fields that are empty and that you must correct.
"KRN",19,11716,15)

"KRN",19,11716,20)
S ENHRPT=2
"KRN",19,11716,25)
REPTYP^ENH6914
"KRN",19,11716,99)
59337,32484
"KRN",19,11716,"U")
REQUIRED FIELDS MISSING DATA R
"KRN",19,11717,-1)
0^3
"KRN",19,11717,0)
ENH 6914 LOOKUP RPT^Lookup Fields w/ Invalid Data Report^^R^^^^^^^^ENGINEERING^^1^
"KRN",19,11717,1,0)
^^4^4^3030915^
"KRN",19,11717,1,1,0)
This option prints or displays the CoreFLS Data Cleansing Lookup Fields w/
"KRN",19,11717,1,2,0)
Invalid Data Report for the EQUIPMENT INV. (#6914) file. The report lists
"KRN",19,11717,1,3,0)
the lookup fields that contain an invalid value in a pointer field that 
"KRN",19,11717,1,4,0)
you must correct.
"KRN",19,11717,15)

"KRN",19,11717,20)
S ENHRPT=3
"KRN",19,11717,25)
REPTYP^ENH6914
"KRN",19,11717,"U")
LOOKUP FIELDS W/ INVALID DATA 
"KRN",19,11718,-1)
0^5
"KRN",19,11718,0)
ENH 6914 NON-REQUIRED RPT^Non-Required Fields Missing Data Report^^R^^^^^^^^ENGINEERING^^1^
"KRN",19,11718,1,0)
^^3^3^3030915^
"KRN",19,11718,1,1,0)
This option prints or displays the CoreFLS Data Cleansing Non-Required
"KRN",19,11718,1,2,0)
Fields Missing Data Report for the EQUIPMENT INV. (#6914) file. The report
"KRN",19,11718,1,3,0)
lists the non-required fields that are empty and that you should correct.
"KRN",19,11718,15)

"KRN",19,11718,20)
S ENHRPT=4
"KRN",19,11718,25)
REPTYP^ENH6914
"KRN",19,11718,"U")
NON-REQUIRED FIELDS MISSING DA
"KRN",19,11785,-1)
0^7
"KRN",19,11785,0)
ENH 6914 COMPILE^Compile Equipment Inventory List for Reports^^R^^ENH DATA CLEANSING^^^^^^
"KRN",19,11785,1,0)
^^3^3^3030915^
"KRN",19,11785,1,1,0)
This option MUST be run prior to using any of the report options . If you
"KRN",19,11785,1,2,0)
have already compiled an Equipment Inventory list for the reports, you do
"KRN",19,11785,1,3,0)
not need to select this option unless you need a new listing.
"KRN",19,11785,25)
COMPILE^ENH6914
"KRN",19,11785,"U")
COMPILE EQUIPMENT INVENTORY LI
"MBREQ")
0
"ORD",18,19)
19;18;;;OPT^XPDTA;OPTF1^XPDIA;OPTE1^XPDIA;OPTF2^XPDIA;;OPTDEL^XPDIA
"ORD",18,19,0)
OPTION
"PKG",33,-1)
1^1
"PKG",33,0)
ENGINEERING^EN^AUTOMATED ENGINEERING MANAGEMENT SYSTEM
"PKG",33,20,0)
^9.402P^^
"PKG",33,22,0)
^9.49I^1^1
"PKG",33,22,1,0)
7.0^2930817^2960130
"PKG",33,22,1,"PAH",1,0)
75^3030926
"PKG",33,22,1,"PAH",1,1,0)
^^1^1^3030926
"PKG",33,22,1,"PAH",1,1,1,0)
DATA CLEANSING REPORTS FOR 6914 FILE
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
9
"RTN","ENH6914")
0^1^B39873649
"RTN","ENH6914",1,0)
ENH6914 ;WOIFO/TAW/EEN - Equipment Inventory Main Routine- CoreFLS data cleansing ; 09/25/03 9:27
"RTN","ENH6914",2,0)
 ;;7.0;ENGINEERING;**75**;Aug 17, 1993
"RTN","ENH6914",3,0)
 ;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","ENH6914",4,0)
 ;
"RTN","ENH6914",5,0)
 Q  ;this routine is not callable from the top
"RTN","ENH6914",6,0)
 ;
"RTN","ENH6914",7,0)
 ;This routine is called by the 4 report options: Summary, Required,
"RTN","ENH6914",8,0)
 ;  Lookup, and Non-Required.
"RTN","ENH6914",9,0)
 ;
"RTN","ENH6914",10,0)
INIT ;Initialize Variables
"RTN","ENH6914",11,0)
 S (ABORT,ENHQFLG)=0
"RTN","ENH6914",12,0)
 S ENHRTN="ENH6914"
"RTN","ENH6914",13,0)
 Q
"RTN","ENH6914",14,0)
 ;
"RTN","ENH6914",15,0)
REPTYP ;Get which report to run
"RTN","ENH6914",16,0)
 I '$D(DT)!'$D(U) D DT^DICRW
"RTN","ENH6914",17,0)
 D INIT
"RTN","ENH6914",18,0)
 ; Make sure no one else is currently compiling the list of Equipment
"RTN","ENH6914",19,0)
 L +^XTMP("ENH6914"):1 E  D EN^DDIOL("Equipment Inventory compile in progress. Please try again later.",,"!!") G EXIT
"RTN","ENH6914",20,0)
 ; Display date of last compile (if there was one).
"RTN","ENH6914",21,0)
 I $D(^XTMP("ENH6914",0)) D EN^DDIOL("Last Equipment Inventory compile done on "_$$FMTE^XLFDT($P(^XTMP("ENH6914",0),U,2)),,"!!")
"RTN","ENH6914",22,0)
 L -^XTMP("ENH6914")
"RTN","ENH6914",23,0)
 ; Make sure last compile completed successfully.
"RTN","ENH6914",24,0)
 ; Otherwise, do not allow user to print anything.
"RTN","ENH6914",25,0)
 I '$D(^XTMP("ENH6914",0))!('$D(^XTMP("ENH6914R",0))) D EN^DDIOL("*** Warning: Please compile the list of Equipment Inventory first ***",,"!!") G EXIT Q
"RTN","ENH6914",26,0)
 D STATASK I ABORT G EXIT Q
"RTN","ENH6914",27,0)
 D INST^ENH6914I I ABORT G EXIT Q
"RTN","ENH6914",28,0)
 I ENHRPT=1 S PRTRTN="PRTSUM^ENH6914G"
"RTN","ENH6914",29,0)
 I ENHRPT=2 S PRTRTN="VALPRT^ENH6914G"
"RTN","ENH6914",30,0)
 I ENHRPT=3 S PRTRTN="EQUIPRT^ENH6914G"
"RTN","ENH6914",31,0)
 I ENHRPT=4 S PRTRTN="NREQPRT^ENH6914G"
"RTN","ENH6914",32,0)
 D DEVICE I $G(ENHQFLG)!(ABORT) G EXIT Q
"RTN","ENH6914",33,0)
 D @PRTRTN
"RTN","ENH6914",34,0)
 D EXIT
"RTN","ENH6914",35,0)
 Q
"RTN","ENH6914",36,0)
 ;
"RTN","ENH6914",37,0)
COMPILE ; Entry point for compile option
"RTN","ENH6914",38,0)
 I '$D(DT)!'$D(U) D DT^DICRW
"RTN","ENH6914",39,0)
 S ABORT=0
"RTN","ENH6914",40,0)
 D HOME^%ZIS
"RTN","ENH6914",41,0)
 ; Make sure no one else is currently compiling the list of Equipment
"RTN","ENH6914",42,0)
 L +^XTMP("ENH6914"):1 E  D EN^DDIOL("Equipment Inventory compile in progress. Please try again later.",,"!!") G EXIT
"RTN","ENH6914",43,0)
 ; Display date of last compile (if there was one).
"RTN","ENH6914",44,0)
 I $D(^XTMP("ENH6914",0)) D EN^DDIOL("Last Equipment Inventory compile done on "_$$FMTE^XLFDT($P(^XTMP("ENH6914",0),U,2)),,"!!")
"RTN","ENH6914",45,0)
 L -^XTMP("ENH6914")
"RTN","ENH6914",46,0)
 D COMP
"RTN","ENH6914",47,0)
 ; If compile running in background (user selected 'NOW' in TaskMan) then kick the user out of the menu until complete.
"RTN","ENH6914",48,0)
 L +^XTMP("ENH6914"):1 E  G EXIT
"RTN","ENH6914",49,0)
 L -^XTMP("ENH6914")
"RTN","ENH6914",50,0)
 Q
"RTN","ENH6914",51,0)
 ;
"RTN","ENH6914",52,0)
STATASK ;Prompt for Station number
"RTN","ENH6914",53,0)
 K STATNUMS
"RTN","ENH6914",54,0)
 S STAT=""
"RTN","ENH6914",55,0)
 F  S STAT=$O(^XTMP(ENHRTN,"STAT",STAT)) Q:STAT=""  D
"RTN","ENH6914",56,0)
 . I '$D(STATNUMS(STAT)) S STATNUMS(STAT)=""
"RTN","ENH6914",57,0)
 W !!,"This report is sorted by station. You may select a single station number or ALL."
"RTN","ENH6914",58,0)
 S DIR(0)="S^1:ALL",CNT=1,STAT=""
"RTN","ENH6914",59,0)
 F  S STAT=$O(STATNUMS(STAT)) Q:STAT=""  D
"RTN","ENH6914",60,0)
 . S CNT=CNT+1,DIR(0)=DIR(0)_";"_CNT_":"_STAT
"RTN","ENH6914",61,0)
 S DIR("A")="Please select a station (1-"_CNT_")"
"RTN","ENH6914",62,0)
 S DIR("A",1)=" "
"RTN","ENH6914",63,0)
 S DIR("B")=1
"RTN","ENH6914",64,0)
 S DIR("?")=" "
"RTN","ENH6914",65,0)
 S DIR("?",1)=" The list below contains the stations that have been found in the"
"RTN","ENH6914",66,0)
 S DIR("?",2)=" STATION (#60) field in the EQUIPMENT INV. (#6914) file."
"RTN","ENH6914",67,0)
 S DIR("?",3)=" "
"RTN","ENH6914",68,0)
 S DIR("?",4)=" Select ""ZZ no station"" to display the records with no entry in the"
"RTN","ENH6914",69,0)
 S DIR("?",5)=" STATION (#60) field."
"RTN","ENH6914",70,0)
 D ^DIR
"RTN","ENH6914",71,0)
 K DIR,STAT,STATNUMS,CNT
"RTN","ENH6914",72,0)
 I Y[U!(Y="")!$D(DTOUT)!$D(DUOUT) S ABORT=1 Q
"RTN","ENH6914",73,0)
 S STATNUM=Y(0)
"RTN","ENH6914",74,0)
 Q
"RTN","ENH6914",75,0)
 ;
"RTN","ENH6914",76,0)
DEVICE ; Ask the user for a device to print to (queuing is allowed).
"RTN","ENH6914",77,0)
 S %ZIS="Q"
"RTN","ENH6914",78,0)
 D ^%ZIS I POP S ABORT=1 Q
"RTN","ENH6914",79,0)
 ;User has decided to Queue report
"RTN","ENH6914",80,0)
 I $D(IO("Q")) D
"RTN","ENH6914",81,0)
 . S ZTSAVE("ENHINST")="",ZTSAVE("STATNUM")="",ZTSAVE("ENHRPT")="",ZTSAVE("ENHRTN")=""
"RTN","ENH6914",82,0)
 . S ZTRTN=PRTRTN,ZTDESC="CoreFLS Data Cleansing Report (File# 6914 - EQUIPMENT INV.)"
"RTN","ENH6914",83,0)
 . D ^%ZTLOAD,HOME^%ZIS
"RTN","ENH6914",84,0)
 . K ZTSK,ZTSAVE,ZTRTN,ZTDESC
"RTN","ENH6914",85,0)
 . S ENHQFLG=1
"RTN","ENH6914",86,0)
 Q
"RTN","ENH6914",87,0)
 ;
"RTN","ENH6914",88,0)
COMP ; Compile queuing prompt
"RTN","ENH6914",89,0)
 K DIR
"RTN","ENH6914",90,0)
 S DIR(0)="YA",DIR("B")="YES"
"RTN","ENH6914",91,0)
 S DIR("A")="Do you wish to queue the Equipment Inventory compile? "
"RTN","ENH6914",92,0)
 S DIR("A",1)=" "
"RTN","ENH6914",93,0)
 F I=1:1:6 S DIR("A",I+1)=$P($T(LIST+I),";;",2)
"RTN","ENH6914",94,0)
 S DIR("A",I+2)=" "
"RTN","ENH6914",95,0)
 S DIR("?")="Enter 'YES' to queue the Equipment Inventory compile or '^' to abort the compile."
"RTN","ENH6914",96,0)
 D ^DIR K DIR
"RTN","ENH6914",97,0)
 I $D(DTOUT)!$D(DUOUT) D EN^DDIOL("<Equipment Inventory Compile Aborted> ",,"!!?10") G EX
"RTN","ENH6914",98,0)
 I Y D  G EX
"RTN","ENH6914",99,0)
 . S ZTIO="NULL",ZTDESC="CoreFLS Data Cleansing Reports Equipment Inventory List",ZTRTN="TASK^ENH6914"
"RTN","ENH6914",100,0)
 . D ^%ZTLOAD
"RTN","ENH6914",101,0)
 . I $G(ZTSK)]"" D EN^DDIOL("Compile's TaskMan ID is "_ZTSK,"","!!?10")
"RTN","ENH6914",102,0)
 . K ZTSK
"RTN","ENH6914",103,0)
 . Q
"RTN","ENH6914",104,0)
 D EN^DDIOL("Compiling Equipment Inventory list ...",,"!!?10")
"RTN","ENH6914",105,0)
TASK ; Setup an ^XTMP holding area for the Equipment Inventory list
"RTN","ENH6914",106,0)
 L +^XTMP("ENH6914"):5 E  D:'$D(ZTQUEUED) EN^DDIOL("*** Aborted: another Equipment Inventory compile is currently running ***",,"!!?10") G:'$D(ZTQUEUED) EX G EXIT
"RTN","ENH6914",107,0)
 K ^XTMP("ENH6914")
"RTN","ENH6914",108,0)
 K ^XTMP("ENH6914R")
"RTN","ENH6914",109,0)
 ; Start Equipment Inventory compile
"RTN","ENH6914",110,0)
 D SUMMARY^ENH6914S
"RTN","ENH6914",111,0)
 ; Standard header for all ^XTMP globals.
"RTN","ENH6914",112,0)
 S X=$$FMADD^XLFDT(DT,30)
"RTN","ENH6914",113,0)
 S ^XTMP("ENH6914",0)=X_U_DT_U_"CoreFLS Equipment Inventory List by Field"
"RTN","ENH6914",114,0)
 S ^XTMP("ENH6914R",0)=X_U_DT_U_"CoreFLS Equipment Inventory List by Record"
"RTN","ENH6914",115,0)
 L -^XTMP("ENH6914")
"RTN","ENH6914",116,0)
 I $D(ZTQUEUED) S ZTREQ="@"
"RTN","ENH6914",117,0)
 ;
"RTN","ENH6914",118,0)
EX0 K DA,DIR,DIRUT,DTOUT,DUOUT,X,Y,%ZIS
"RTN","ENH6914",119,0)
 Q
"RTN","ENH6914",120,0)
EX K DIR S DIR(0)="E" D ^DIR
"RTN","ENH6914",121,0)
 K DA,DIR,DIRUT,DTOUT,DUOUT,X,Y,%ZIS
"RTN","ENH6914",122,0)
 Q
"RTN","ENH6914",123,0)
 ;
"RTN","ENH6914",124,0)
EXIT ; Make sure all the variables get killed.
"RTN","ENH6914",125,0)
 K %,%Y,%ZIS,DQCT,ENTNUM,ERR,FIELD,I,INVTOT,REQTOT,NREQTOT,INSHDR,INVFLD
"RTN","ENH6914",126,0)
 K INVNAME,MENAME,NREQFLD,NREQFLG,REQFLD,REQFLG,TOTAV,TOTALS,TOTANA
"RTN","ENH6914",127,0)
 K WKPERF,ZTSAVE,ZTDESC,ZTRTN,INVFLG,ENHQFLG,SGL,LOC,MANBY,PSYS,CAT,VEN
"RTN","ENH6914",128,0)
 K ASRC,CSTK,TECH,RESSHOP,PROC,CMR,ENHINST,SPTR,DMET,BOC,FUND,AOFF,ICAT
"RTN","ENH6914",129,0)
 K MULT,MULT2,DATA,DATA1,DATA2,LEV,FREQ,SMON,MSER,MNUM,CRIT,USESTAT,TOE
"RTN","ENH6914",130,0)
 K DDATE,SSTAT,PRTRTN,INVTOT,REQTOT,NREQTOT,STATCNT,STATNUM,TOTFLD,TOTREC
"RTN","ENH6914",131,0)
 K STATOT,STAT,HEAD1,HEADS,INT,INTCNT,NULLFLG,FLAG,POP,ENHQFLG
"RTN","ENH6914",132,0)
 K ENHRTN,ENHDICT,ENHHDR,DIR,DIRUT,DTOUT,DUOUT,X,Y,ABORT,ENHRPT,MULT3
"RTN","ENH6914",133,0)
 Q
"RTN","ENH6914",134,0)
 ;
"RTN","ENH6914",135,0)
LIST    ; Prompt text for Compile option
"RTN","ENH6914",136,0)
 ;;Compile may take 30 minutes or more depending on the size of your database.
"RTN","ENH6914",137,0)
 ;;Answering 'NO' will start the compile immediately in the foreground and your
"RTN","ENH6914",138,0)
 ;;terminal will be unresponsive until it completes. Answering 'YES' will allow
"RTN","ENH6914",139,0)
 ;;you to schedule the compile. Note that once the compile begins you will not
"RTN","ENH6914",140,0)
 ;;be allowed to access these options until it completes.
"RTN","ENH6914",141,0)
 ;;You may also enter '^' to abort the compile.
"RTN","ENH6914F")
0^7^B41294763
"RTN","ENH6914F",1,0)
ENH6914F ;WOIFO/TAW/EEN - Equipment Inventory Reports Instructions - CoreFLS data cleansing ; 09/25/03 9:28
"RTN","ENH6914F",2,0)
 ;;7.0;ENGINEERING;**75**;Aug 17, 1993
"RTN","ENH6914F",3,0)
 ;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","ENH6914F",4,0)
 ;
"RTN","ENH6914F",5,0)
 Q  ;this routine is not callable from the top
"RTN","ENH6914F",6,0)
 ;
"RTN","ENH6914F",7,0)
 ;This routine contains the instructions for the Non-Required Fields
"RTN","ENH6914F",8,0)
 ;Missing Data Report.
"RTN","ENH6914F",9,0)
 ;
"RTN","ENH6914F",10,0)
BOTHINS ;Instructions for the Non-Required Fields with Missing Data Report
"RTN","ENH6914F",11,0)
 U IO
"RTN","ENH6914F",12,0)
 S (P,L,ABORT)=0
"RTN","ENH6914F",13,0)
 S INSHDR="NON-REQUIRED FIELDS MISSING DATA"
"RTN","ENH6914F",14,0)
 D HDR
"RTN","ENH6914F",15,0)
 W !!,"The purpose of this report is to display a list of EQUIPMENT INV. (#6914)"
"RTN","ENH6914F",16,0)
 W !,"items with missing (empty) data for the fields that are not required in"
"RTN","ENH6914F",17,0)
 W !,"the CoreFLS system. If fields appearing on this report are left empty, the"
"RTN","ENH6914F",18,0)
 W !,"conversion will either default to a value or convert the field as empty into"
"RTN","ENH6914F",19,0)
 W !,"the CoreFLS system."
"RTN","ENH6914F",20,0)
 S L=L+6
"RTN","ENH6914F",21,0)
 I L+5>IOSL D HDR Q:ABORT
"RTN","ENH6914F",22,0)
 W !!,"Before you use this report, you may want to run the compile to ensure you"
"RTN","ENH6914F",23,0)
 W !,"are viewing the most recent modifications."
"RTN","ENH6914F",24,0)
 S L=L+3
"RTN","ENH6914F",25,0)
 I L+10>IOSL D HDR Q:ABORT
"RTN","ENH6914F",26,0)
 W !!,"This report examines the following non-required fields:"
"RTN","ENH6914F",27,0)
 W !,"NOTE: Abbreviations for field names used on this report appear in quotes"
"RTN","ENH6914F",28,0)
 W !,"next to the field number"
"RTN","ENH6914F",29,0)
 W !!,"   MODEL (#4)"
"RTN","ENH6914F",30,0)
 W !,"   SERIAL # (#5)"
"RTN","ENH6914F",31,0)
 W !,"   TOTAL ASSET VALUE (#12) - ""Total Asset Val"""
"RTN","ENH6914F",32,0)
 S L=L+8
"RTN","ENH6914F",33,0)
 I L+8>IOSL D HDR Q:ABORT
"RTN","ENH6914F",34,0)
 I $E(IOSL,1,2)'="C-"&(L<5) W ! S L=L+1
"RTN","ENH6914F",35,0)
 W !,"   USE STATUS (#20)"
"RTN","ENH6914F",36,0)
 W !,"   STARTING MONTH (RESPONSIBLE SHOP Multiple) (#6914.04,2)"
"RTN","ENH6914F",37,0)
 W !,"   CRITICALITY (RESPONSIBLE SHOP Multiple) (#6914.04,2.7)"
"RTN","ENH6914F",38,0)
 W !,"   FREQUENCY (RESPONSIBLE SHOP/FREQUENCY Multiple) (#6914.43,.01)"
"RTN","ENH6914F",39,0)
 W !,"   LEVEL (RESPONSIBLE SHOP/FREQUENCY Multiple) (#6914.43,3)"
"RTN","ENH6914F",40,0)
 S L=L+6
"RTN","ENH6914F",41,0)
 I L+9>IOSL D HDR Q:ABORT
"RTN","ENH6914F",42,0)
 I $E(IOSL,1,2)'="C-"&(L<5) W ! S L=L+1
"RTN","ENH6914F",43,0)
 W !,"   PROCEDURE (RESPONSIBLE SHOP/FREQUENCY Multiple) (#6914.43,4)"
"RTN","ENH6914F",44,0)
 W !,"   STANDARD GENERAL LEDGER (#38) - ""SGL"""
"RTN","ENH6914F",45,0)
 W !,"   STATION NUMBER (#60) - ""Station"""
"RTN","ENH6914F",46,0)
 W !,"   BUDGET OBJECT CODE (#61) - ""BOC"""
"RTN","ENH6914F",47,0)
 W !,"   FUND (#62)"
"RTN","ENH6914F",48,0)
 W !,"   ADMINISTRATION/OFFICE (#63) - ""Admin Office"""
"RTN","ENH6914F",49,0)
 S L=L+7
"RTN","ENH6914F",50,0)
 I L+6>IOSL D HDR Q:ABORT
"RTN","ENH6914F",51,0)
 W !!,"The report is sorted by station number.  When printing or viewing this"
"RTN","ENH6914F",52,0)
 W !,"report, you may select a single station number or ALL. Select ""ZZ no station"""
"RTN","ENH6914F",53,0)
 W !,"to display the records with no entry in the STATION (#60) field."
"RTN","ENH6914F",54,0)
 S L=L+4
"RTN","ENH6914F",55,0)
 I L+4>IOSL D HDR Q:ABORT
"RTN","ENH6914F",56,0)
 W !!,"The totals for each station are as follows:"
"RTN","ENH6914F",57,0)
 S L=L+2
"RTN","ENH6914F",58,0)
 I L+5>IOSL D HDR Q:ABORT
"RTN","ENH6914F",59,0)
 W !!,"Total records analyzed - number of records in the EQUIPMENT INV. (#6914)"
"RTN","ENH6914F",60,0)
 W !,"      file assigned to the station"
"RTN","ENH6914F",61,0)
 S L=L+3
"RTN","ENH6914F",62,0)
 I L+5>IOSL D HDR Q:ABORT
"RTN","ENH6914F",63,0)
 W !!,"Total records with Non-Required Fields Missing Data - number of records"
"RTN","ENH6914F",64,0)
 W !,"      that have one or more empty non-required fields"
"RTN","ENH6914F",65,0)
 S L=L+3
"RTN","ENH6914F",66,0)
 I L+5>IOSL D HDR Q:ABORT
"RTN","ENH6914F",67,0)
 W !!,"Total fields with Non-Required Fields Missing Data - number of non-required"
"RTN","ENH6914F",68,0)
 W !,"      fields that are empty"
"RTN","ENH6914F",69,0)
 S L=L+3
"RTN","ENH6914F",70,0)
 I L+5>IOSL D HDR Q:ABORT
"RTN","ENH6914F",71,0)
 W !!,"The report lists each record in order by its internal entry number (IEN)."
"RTN","ENH6914F",72,0)
 W !,"Each row on the report contains the following columns:"
"RTN","ENH6914F",73,0)
 S L=L+3
"RTN","ENH6914F",74,0)
 I L+7>IOSL D HDR Q:ABORT
"RTN","ENH6914F",75,0)
 W !!,"REC IEN - lists the EQUIPMENT INV. (#6914) file internal record number"
"RTN","ENH6914F",76,0)
 W !!,"MFGR. EQUIPMENT NAME - name of the equipment (if there is a value in this"
"RTN","ENH6914F",77,0)
 W !,"     field, you may use it to select the Equipment Inventory item)"
"RTN","ENH6914F",78,0)
 S L=L+5
"RTN","ENH6914F",79,0)
 I L+4>IOSL D HDR Q:ABORT
"RTN","ENH6914F",80,0)
 W !!,"FIELD NAME - name or abbreviation of the non-required field"
"RTN","ENH6914F",81,0)
 S L=L+2
"RTN","ENH6914F",82,0)
 I L+8>IOSL D HDR Q:ABORT
"RTN","ENH6914F",83,0)
 W !!,"MULTIPLE NUMBER - index number of the multiple"
"RTN","ENH6914F",84,0)
 W !,"     (Note: Frequency, Level, and Procedure fields may display a set of two"
"RTN","ENH6914F",85,0)
 W !,"     multiple numbers separated by a comma. The first number represents the"
"RTN","ENH6914F",86,0)
 W !,"     Responsible Shop multiple number. The second number represents the"
"RTN","ENH6914F",87,0)
 W !,"     Frequency multiple number.)"
"RTN","ENH6914F",88,0)
 S L=L+6
"RTN","ENH6914F",89,0)
 I L+5>IOSL D HDR Q:ABORT
"RTN","ENH6914F",90,0)
 W !!,"You should correct every field that appears on this report prior to conversion."
"RTN","ENH6914F",91,0)
 W !,"Use AEMS/MERS to enter a valid value in each empty field listed."
"RTN","ENH6914F",92,0)
 S L=L+3
"RTN","ENH6914F",93,0)
 I L+15>IOSL D HDR Q:ABORT
"RTN","ENH6914F",94,0)
 W !!,"*** Special Note ************************************************"
"RTN","ENH6914F",95,0)
 W !,"The following are multiple-type fields:"
"RTN","ENH6914F",96,0)
 W !,"   STARTING MONTH (#6914.04,2)"
"RTN","ENH6914F",97,0)
 W !,"   CRITICALITY (#6914.04,2.7)"
"RTN","ENH6914F",98,0)
 W !,"   FREQUENCY (#6914.43,.01)"
"RTN","ENH6914F",99,0)
 W !,"   LEVEL (#6914.43,3)"
"RTN","ENH6914F",100,0)
 W !,"   PROCEDURE (#6914.43,4)"
"RTN","ENH6914F",101,0)
 W !,"Multiple fields can occur many times within one EQUIPMENT INV."
"RTN","ENH6914F",102,0)
 W !,"(#6914) file record. All occurrences of these fields are examined."
"RTN","ENH6914F",103,0)
 W !,"The index number of the multiple with missing data is displayed"
"RTN","ENH6914F",104,0)
 W !,"on this report."
"RTN","ENH6914F",105,0)
 W !,"******************************************************************"
"RTN","ENH6914F",106,0)
 S L=L+13
"RTN","ENH6914F",107,0)
 I L+18>IOSL D HDR Q:ABORT
"RTN","ENH6914F",108,0)
 W !!,"*** Conversion Note ***********************************************"
"RTN","ENH6914F",109,0)
 W !,"If the non-required fields are left empty, the following will occur"
"RTN","ENH6914F",110,0)
 W !,"during CoreFLS conversion:"
"RTN","ENH6914F",111,0)
 W !!,"  FREQUENCY (#6914.43,.01) - a PM will not be created for the"
"RTN","ENH6914F",112,0)
 W !,"                             equipment item"
"RTN","ENH6914F",113,0)
 W !!,"  PROCEDURE (#6914.43,4) - the PM description will be defaulted to"
"RTN","ENH6914F",114,0)
 W !,"                           the FREQUENCY (#6914.43,.01) followed by"
"RTN","ENH6914F",115,0)
 W !,"                           a hyphen (dash) and Equipment Category"
"RTN","ENH6914F",116,0)
 W !,"                           NAME (#.01) (ex. Quarterly-Pump)"
"RTN","ENH6914F",117,0)
 W !!,"All other non-required fields will be converted as empty."
"RTN","ENH6914F",118,0)
 W !,"*******************************************************************"
"RTN","ENH6914F",119,0)
 W !!,"<End of Instructions>" I $E(IOST,1,2)="C-" W "  Enter RETURN to continue or '^' to exit: " R Y:DTIME I '$T!(Y[U) S ABORT=1 Q
"RTN","ENH6914F",120,0)
 W @IOF
"RTN","ENH6914F",121,0)
 Q
"RTN","ENH6914F",122,0)
 ;
"RTN","ENH6914F",123,0)
HDR ;Page break for multi page instructions
"RTN","ENH6914F",124,0)
 ; Do not ask 'RETURN' before first page on CRT.
"RTN","ENH6914F",125,0)
 I $E(IOST,1,2)="C-",P R !!,"Enter RETURN to continue or '^' to exit:  ",Y:DTIME I '$T!(Y[U) S ABORT=1 Q
"RTN","ENH6914F",126,0)
 ; Do not print a form feed before first page on printer.  Top of form is set at the end of previous report.
"RTN","ENH6914F",127,0)
 I $E(IOST,1,2)="C-"!P W @IOF
"RTN","ENH6914F",128,0)
 S P=P+1 S L=2
"RTN","ENH6914F",129,0)
 W !,"EQUIPMENT INV. (#6914) - ",INSHDR,?67,"Page: ",$J(P,5,0)
"RTN","ENH6914F",130,0)
 W !,"CoreFLS Data Cleansing Report Instructions",?58,"Printed: ",$$FMTE^XLFDT(DT)
"RTN","ENH6914F",131,0)
 Q
"RTN","ENH6914G")
0^8^B39721560
"RTN","ENH6914G",1,0)
ENH6914G ;WOIFO/TAW/EEN - Equipment Inventory Detail Reports Print - CoreFLS data cleansing ; 09/25/03 9:28
"RTN","ENH6914G",2,0)
 ;;7.0;ENGINEERING;**75**;Aug 17, 1993
"RTN","ENH6914G",3,0)
 ;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","ENH6914G",4,0)
 ;
"RTN","ENH6914G",5,0)
 Q  ;this routine is not callable from the top
"RTN","ENH6914G",6,0)
 ;
"RTN","ENH6914G",7,0)
 ; This routine contains all the printing code for the detailed reports.
"RTN","ENH6914G",8,0)
 ;
"RTN","ENH6914G",9,0)
PRTSUM ;Print Summary Report
"RTN","ENH6914G",10,0)
 U IO
"RTN","ENH6914G",11,0)
 I $G(ENHINST) D SUMINST^ENH6914I Q:ABORT
"RTN","ENH6914G",12,0)
 S (HEADS,STAT)=""
"RTN","ENH6914G",13,0)
 S (P,L,ABORT)=0,ENHHDR="SUMMARY"
"RTN","ENH6914G",14,0)
 I STATNUM="ALL" D
"RTN","ENH6914G",15,0)
 . S STAT=""
"RTN","ENH6914G",16,0)
 . F  S STAT=$O(^XTMP(ENHRTN,"STAT",STAT)) Q:ABORT!(STAT="")  D
"RTN","ENH6914G",17,0)
 .. S ENHDICT=^XTMP(ENHRTN,"STAT",STAT)
"RTN","ENH6914G",18,0)
 .. D L1
"RTN","ENH6914G",19,0)
 I STATNUM'="ALL" D
"RTN","ENH6914G",20,0)
 . S STAT=STATNUM
"RTN","ENH6914G",21,0)
 . S ENHDICT=^XTMP(ENHRTN,"STAT",STAT)
"RTN","ENH6914G",22,0)
 . D L1
"RTN","ENH6914G",23,0)
 D EOR
"RTN","ENH6914G",24,0)
 D CLOSE
"RTN","ENH6914G",25,0)
 Q
"RTN","ENH6914G",26,0)
 ;
"RTN","ENH6914G",27,0)
L1 ; Summary Report printing
"RTN","ENH6914G",28,0)
 S HEADS="" D HDR Q:ABORT
"RTN","ENH6914G",29,0)
 S REQTOT=$P(^XTMP(ENHRTN,ENHDICT,STAT),U,1)
"RTN","ENH6914G",30,0)
 S INVTOT=$P(^XTMP(ENHRTN,ENHDICT,STAT),U,2)
"RTN","ENH6914G",31,0)
 S NREQTOT=$P(^XTMP(ENHRTN,ENHDICT,STAT),U,3)
"RTN","ENH6914G",32,0)
 S STATOT=$P(^XTMP(ENHRTN,ENHDICT,STAT),U,4)
"RTN","ENH6914G",33,0)
 W !!,"Totals for Station ",STAT
"RTN","ENH6914G",34,0)
 W ! F I=1:1:70 W "-"
"RTN","ENH6914G",35,0)
 W !,"Total records analyzed",?55,$J(STATOT,6,0)
"RTN","ENH6914G",36,0)
 W !,"Total records with Required Fields Missing Data"
"RTN","ENH6914G",37,0)
 W ?55,$J(REQTOT,6,0)
"RTN","ENH6914G",38,0)
 W !,"Total records with Lookup Fields w/ Invalid Data"
"RTN","ENH6914G",39,0)
 W ?55,$J(INVTOT,6,0)
"RTN","ENH6914G",40,0)
 W !,"Total records with Non-required Fields Missing Data"
"RTN","ENH6914G",41,0)
 W ?55,$J(NREQTOT,6,0)
"RTN","ENH6914G",42,0)
 S L=L+7
"RTN","ENH6914G",43,0)
 S HEADS=1 D HEADS
"RTN","ENH6914G",44,0)
 S FIELD=0
"RTN","ENH6914G",45,0)
 F  S FIELD=$O(^XTMP(ENHRTN,ENHDICT,STAT,FIELD)) Q:FIELD=""  D  Q:ABORT
"RTN","ENH6914G",46,0)
 . S DATA=^XTMP(ENHRTN,ENHDICT,STAT,FIELD)
"RTN","ENH6914G",47,0)
 . I L+2>IOSL D HDR Q:ABORT
"RTN","ENH6914G",48,0)
 . S REQFLD=$P(DATA,U,1),INVFLD=$P(DATA,U,2),NREQFLD=$P(DATA,U,3)
"RTN","ENH6914G",49,0)
 . S DQCT=$P(DATA,U,4)
"RTN","ENH6914G",50,0)
 . W !,DQCT,?15,FIELD,?33,$J(REQFLD,5),?50,$J(INVFLD,5),?67,$J(NREQFLD,5)
"RTN","ENH6914G",51,0)
 . S L=L+1
"RTN","ENH6914G",52,0)
 Q
"RTN","ENH6914G",53,0)
 ;
"RTN","ENH6914G",54,0)
VALPRT ;Detail Report #1 print
"RTN","ENH6914G",55,0)
 ;D FLDSRT^ENH6914T   ;SORT FIELDS INTO POSITION TO PRINT
"RTN","ENH6914G",56,0)
 U IO
"RTN","ENH6914G",57,0)
 I $G(ENHINST) D FLDINST^ENH6914J Q:ABORT
"RTN","ENH6914G",58,0)
 S ENHHDR="REQUIRED FIELDS MISSING DATA"
"RTN","ENH6914G",59,0)
 S TOTALS="with Required Fields Missing Data"
"RTN","ENH6914G",60,0)
 S (HEAD1,INT,FIELD,MULT,STAT,ERR)="",(P,L,ABORT)=0
"RTN","ENH6914G",61,0)
 S ERROR="REQ",NUM=1
"RTN","ENH6914G",62,0)
 D PRT
"RTN","ENH6914G",63,0)
 D EOR
"RTN","ENH6914G",64,0)
 D CLOSE
"RTN","ENH6914G",65,0)
 K NUM,ERROR
"RTN","ENH6914G",66,0)
 Q
"RTN","ENH6914G",67,0)
 ;
"RTN","ENH6914G",68,0)
EQUIPRT ;Detail Report #2 print
"RTN","ENH6914G",69,0)
 ;D FLDSRT^ENH6914T   ;SORT FIELDS INTO POSITION TO PRINT
"RTN","ENH6914G",70,0)
 U IO
"RTN","ENH6914G",71,0)
 I $G(ENHINST) D ENTINST^ENH6914M Q:ABORT
"RTN","ENH6914G",72,0)
 S ENHHDR="LOOKUP FIELDS W/ INVALID DATA"
"RTN","ENH6914G",73,0)
 S TOTALS="with Lookup Fields w/ Invalid Data"
"RTN","ENH6914G",74,0)
 S (HEAD1,INT,FIELD,MULT,STAT,ERR)="",(P,L,ABORT)=0
"RTN","ENH6914G",75,0)
 S ERROR="INV",NUM=2
"RTN","ENH6914G",76,0)
 D PRT
"RTN","ENH6914G",77,0)
 D EOR
"RTN","ENH6914G",78,0)
 D CLOSE
"RTN","ENH6914G",79,0)
 K NUM,ERROR
"RTN","ENH6914G",80,0)
 Q
"RTN","ENH6914G",81,0)
 ;
"RTN","ENH6914G",82,0)
NREQPRT ;Detail report #3 print
"RTN","ENH6914G",83,0)
 ;D FLDSRT^ENH6914T   ;SORT FIELDS INTO POSITION TO PRINT
"RTN","ENH6914G",84,0)
 U IO
"RTN","ENH6914G",85,0)
 I $G(ENHINST) D BOTHINS^ENH6914F Q:ABORT
"RTN","ENH6914G",86,0)
 S ENHHDR="NON-REQUIRED FIELDS MISSING DATA"
"RTN","ENH6914G",87,0)
 S TOTALS="with Non-Required Fields Missing Data"
"RTN","ENH6914G",88,0)
 S (HEAD1,INT,FIELD,MULT,STAT,ERR)="",(P,L,ABORT)=0
"RTN","ENH6914G",89,0)
 S ERROR="NREQ",NUM=3
"RTN","ENH6914G",90,0)
 D PRT
"RTN","ENH6914G",91,0)
 D EOR
"RTN","ENH6914G",92,0)
 D CLOSE
"RTN","ENH6914G",93,0)
 K NUM,ERROR
"RTN","ENH6914G",94,0)
 Q
"RTN","ENH6914G",95,0)
 ;
"RTN","ENH6914G",96,0)
PRT ; Get the Station(s) to print for reports
"RTN","ENH6914G",97,0)
 I STATNUM="ALL" D
"RTN","ENH6914G",98,0)
 . S STAT=""
"RTN","ENH6914G",99,0)
 . F  S STAT=$O(^XTMP(ENHRTN,"STAT",STAT)) Q:ABORT!(STAT="")  D
"RTN","ENH6914G",100,0)
 .. S ENHDICT=^XTMP(ENHRTN,"STAT",STAT)
"RTN","ENH6914G",101,0)
 .. D LOOP
"RTN","ENH6914G",102,0)
 I STATNUM'="ALL" D
"RTN","ENH6914G",103,0)
 . S STAT=STATNUM
"RTN","ENH6914G",104,0)
 . S ENHDICT=^XTMP(ENHRTN,"STAT",STAT)
"RTN","ENH6914G",105,0)
 . D LOOP
"RTN","ENH6914G",106,0)
 Q
"RTN","ENH6914G",107,0)
 ;
"RTN","ENH6914G",108,0)
LOOP ; Print out the records for each station
"RTN","ENH6914G",109,0)
 S HEAD1="" D HDR Q:ABORT
"RTN","ENH6914G",110,0)
 S TOTANA=$P($G(^XTMP(ENHRTN,ENHDICT,STAT)),U,4)
"RTN","ENH6914G",111,0)
 S TOTREC=$P($G(^XTMP(ENHRTN,ENHDICT,STAT)),U,NUM)
"RTN","ENH6914G",112,0)
 S TOTFLD=$P($G(^XTMP(ENHRTN,ENHDICT,STAT,0)),U,NUM)
"RTN","ENH6914G",113,0)
 W !!,"Totals for Station ",STAT
"RTN","ENH6914G",114,0)
 W ! F I=1:1:70 W "-"
"RTN","ENH6914G",115,0)
 W !,"Total records analyzed",?60,$J(TOTANA,8,0)
"RTN","ENH6914G",116,0)
 W !,"Total records "_TOTALS,?60,$J(TOTREC,8,0)
"RTN","ENH6914G",117,0)
 W !,"Total fields "_TOTALS,?60,$J(TOTFLD,8,0)
"RTN","ENH6914G",118,0)
 S L=L+6
"RTN","ENH6914G",119,0)
 D HEAD1
"RTN","ENH6914G",120,0)
 S HEAD1=1
"RTN","ENH6914G",121,0)
 I TOTFLD<1 D  Q
"RTN","ENH6914G",122,0)
 . W !!,"** NO DATA TO PRINT **"
"RTN","ENH6914G",123,0)
 F  S ERR=$O(^XTMP("ENH6914R",ENHDICT,STAT,ERR)) Q:ABORT!(ERR="")  D
"RTN","ENH6914G",124,0)
 . I ERR'=ERROR Q
"RTN","ENH6914G",125,0)
 . F  S INT=$O(^XTMP("ENH6914R",ENHDICT,STAT,ERR,INT)) Q:ABORT!(INT="")  D
"RTN","ENH6914G",126,0)
 .. F  S FIELD=$O(^XTMP("ENH6914R",ENHDICT,STAT,ERR,INT,FIELD)) Q:ABORT!(FIELD="")  D
"RTN","ENH6914G",127,0)
 ... S INVNAME=$P($G(^ENG(6914,INT,0)),U,2)
"RTN","ENH6914G",128,0)
 ... I FIELD="Procedure"!(FIELD="Frequency")!(FIELD="Level")!(FIELD="Work Performed") D MULTPRT Q
"RTN","ENH6914G",129,0)
 ... I FIELD="Resp Shop"!(FIELD="Technician")!(FIELD="Criticality")!(FIELD="Starting Month") D MULTPRT Q
"RTN","ENH6914G",130,0)
 ... W !,$J(INT,8,0),?10,$E(INVNAME,1,30),?45,FIELD
"RTN","ENH6914G",131,0)
 ... S L=L+1
"RTN","ENH6914G",132,0)
 ... I L+3>IOSL D HDR Q:ABORT
"RTN","ENH6914G",133,0)
 Q
"RTN","ENH6914G",134,0)
 ;
"RTN","ENH6914G",135,0)
MULTPRT ;PRINT ALL ITERATIONS OF MULTIPLE FIELDS
"RTN","ENH6914G",136,0)
 S MULT=""
"RTN","ENH6914G",137,0)
 F  S MULT=$O(^XTMP("ENH6914R",ENHDICT,STAT,ERR,INT,FIELD,MULT)) Q:ABORT!(MULT="")  D
"RTN","ENH6914G",138,0)
 . I FIELD="Frequency"!(FIELD="Level")!(FIELD="Procedure") D MULT2 Q
"RTN","ENH6914G",139,0)
 . W !,$J(INT,8,0),?10,$E(INVNAME,1,30),?45,FIELD,?70
"RTN","ENH6914G",140,0)
 . I FIELD="Work Performed" W MULT
"RTN","ENH6914G",141,0)
 . E  W $J(MULT,5)
"RTN","ENH6914G",142,0)
 . S L=L+1
"RTN","ENH6914G",143,0)
 . I L+3>IOSL D HDR Q:ABORT
"RTN","ENH6914G",144,0)
 Q
"RTN","ENH6914G",145,0)
 ;
"RTN","ENH6914G",146,0)
MULT2 ; For 2 level deep multiples
"RTN","ENH6914G",147,0)
 S MULT2=0
"RTN","ENH6914G",148,0)
 F  S MULT2=$O(^XTMP("ENH6914R",ENHDICT,STAT,ERR,INT,FIELD,MULT,MULT2)) Q:'MULT2!(ABORT)  D
"RTN","ENH6914G",149,0)
 . S MULT3=MULT_","_MULT2
"RTN","ENH6914G",150,0)
 . W !,$J(INT,8,0),?10,$E(INVNAME,1,30),?45,FIELD,?70,$J(MULT3,5)
"RTN","ENH6914G",151,0)
 . S L=L+1
"RTN","ENH6914G",152,0)
 . I L+3>IOSL D HDR Q:ABORT
"RTN","ENH6914G",153,0)
 Q
"RTN","ENH6914G",154,0)
 ;
"RTN","ENH6914G",155,0)
EOR ; Report completed
"RTN","ENH6914G",156,0)
 I 'ABORT W !!,"<End of Report>" I $E(IOST,1,2)="C-" W " Enter RETURN to continue" R Y:DTIME
"RTN","ENH6914G",157,0)
 I ABORT W !!,"<Report Aborted>" D CLOSE
"RTN","ENH6914G",158,0)
 Q
"RTN","ENH6914G",159,0)
 ;
"RTN","ENH6914G",160,0)
CLOSE ;
"RTN","ENH6914G",161,0)
 D ^%ZISC
"RTN","ENH6914G",162,0)
 K L,P,X,Y
"RTN","ENH6914G",163,0)
 I $D(ZTQUEUED) S ZTREQ="@"
"RTN","ENH6914G",164,0)
 Q
"RTN","ENH6914G",165,0)
 ;
"RTN","ENH6914G",166,0)
HDR ; Print the standard report header.
"RTN","ENH6914G",167,0)
 ; Do not ask 'RETURN' before first page on CRT.
"RTN","ENH6914G",168,0)
 I $E(IOST,1,2)="C-",P R !!,"Enter RETURN to continue or '^' to exit: ",Y:DTIME I '$T!(Y[U) S ABORT=1 Q
"RTN","ENH6914G",169,0)
 ; Do not print a form feed before first page on printer. Top of form is set at end of previous report.
"RTN","ENH6914G",170,0)
 I $E(IOST,1,2)="C-"!P W @IOF
"RTN","ENH6914G",171,0)
 S P=P+1,L=4
"RTN","ENH6914G",172,0)
 W !,"EQUIPMENT INV. (#6914) - ",ENHHDR,?67,"Page: ",$J(P,5,0)
"RTN","ENH6914G",173,0)
 W !,"CoreFLS Data Cleansing Report",?58,"Printed: ",$$FMTE^XLFDT(DT)
"RTN","ENH6914G",174,0)
 I $G(HEAD1)]"" D SHDR,HEAD1
"RTN","ENH6914G",175,0)
 I $G(HEADS)]"" D SHDR,HEADS
"RTN","ENH6914G",176,0)
 Q
"RTN","ENH6914G",177,0)
 ;
"RTN","ENH6914G",178,0)
HEAD1 ;Sub-header for Detailed Reports
"RTN","ENH6914G",179,0)
 W !!,"  REC",?10,"MFGR. EQUIPMENT",?45,"FIELD",?70,"MULTIPLE"
"RTN","ENH6914G",180,0)
 W !,"  IEN",?10,"NAME",?45,"NAME",?70,"NUMBER",!
"RTN","ENH6914G",181,0)
 F I=1:1:80 W "="
"RTN","ENH6914G",182,0)
 S L=L+4
"RTN","ENH6914G",183,0)
 Q
"RTN","ENH6914G",184,0)
 ;
"RTN","ENH6914G",185,0)
HEADS ;Sub-header for Summary Report
"RTN","ENH6914G",186,0)
 W !!,"DATA QUALITY",?15,"FIELD",?31,"REQUIRED FIELDS",?48,"LOOKUP FIELDS",?65,"NON-REQ. FIELDS"
"RTN","ENH6914G",187,0)
 W !,"CHECK TYPE",?15,"NAME",?31,"MISSING DATA",?48,"W/INVALID DATA",?65,"MISSING DATA",!
"RTN","ENH6914G",188,0)
 F I=1:1:80 W "="
"RTN","ENH6914G",189,0)
 S L=L+4
"RTN","ENH6914G",190,0)
 Q
"RTN","ENH6914G",191,0)
 ;
"RTN","ENH6914G",192,0)
SHDR ; Station Header
"RTN","ENH6914G",193,0)
 W !!,"For Station ",STAT
"RTN","ENH6914G",194,0)
 W ! F I=1:1:70 W "-"
"RTN","ENH6914G",195,0)
 S L=L+3
"RTN","ENH6914G",196,0)
 Q
"RTN","ENH6914I")
0^9^B63375761
"RTN","ENH6914I",1,0)
ENH6914I ;WOIFO/TAW/EEN - Equipment Inventory Reports Instructions - CoreFLS data cleansing ; 09/26/03 10:58
"RTN","ENH6914I",2,0)
 ;;7.0;ENGINEERING;**75**;Aug 17, 1993
"RTN","ENH6914I",3,0)
 ;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","ENH6914I",4,0)
 ;
"RTN","ENH6914I",5,0)
 Q  ;this routine is not callable from the top
"RTN","ENH6914I",6,0)
 ;
"RTN","ENH6914I",7,0)
 ;This routine should not be run directly.  It should only be called
"RTN","ENH6914I",8,0)
 ;from ENH6914 (AEMS/MERS 6914 Summary or Detail Reports) 
"RTN","ENH6914I",9,0)
 ;on the Program Management menu
"RTN","ENH6914I",10,0)
 ;
"RTN","ENH6914I",11,0)
INST ; Print Instructions for Summary Report
"RTN","ENH6914I",12,0)
 ;
"RTN","ENH6914I",13,0)
 ;  Variables:
"RTN","ENH6914I",14,0)
 ;    ENHRPT = Type of report
"RTN","ENH6914I",15,0)
 ;           1 - Summary Report
"RTN","ENH6914I",16,0)
 ;           2 - Required Fields Missing Data Report
"RTN","ENH6914I",17,0)
 ;           3 - Lookup Fields w/ Invalid Data Report
"RTN","ENH6914I",18,0)
 ;           4 - Non-Required Fields Missing Data Report
"RTN","ENH6914I",19,0)
 ;
"RTN","ENH6914I",20,0)
 D HOME^%ZIS
"RTN","ENH6914I",21,0)
 K DIR
"RTN","ENH6914I",22,0)
 S DIR(0)="Y"
"RTN","ENH6914I",23,0)
 S DIR("A")="Do you wish to print the instructions for this report"
"RTN","ENH6914I",24,0)
 S DIR("A",1)=" "
"RTN","ENH6914I",25,0)
 S DIR("B")="NO"
"RTN","ENH6914I",26,0)
 S DIR("?")="Please enter Y to print the instructions or N to skip the instructions"
"RTN","ENH6914I",27,0)
 D ^DIR K DIR
"RTN","ENH6914I",28,0)
 I Y[U!(Y="")!$D(DTOUT)!$D(DUOUT) S ABORT=1 Q
"RTN","ENH6914I",29,0)
 S ENHINST=Y
"RTN","ENH6914I",30,0)
 Q
"RTN","ENH6914I",31,0)
 ;
"RTN","ENH6914I",32,0)
SUMINST ;Instructions for the Summary Report for the 6914 file
"RTN","ENH6914I",33,0)
 U IO
"RTN","ENH6914I",34,0)
 S (P,L,ABORT)=0
"RTN","ENH6914I",35,0)
 S INSHDR="SUMMARY"
"RTN","ENH6914I",36,0)
 D HDR
"RTN","ENH6914I",37,0)
 W !!,"The purpose of this report is to display the total number of records in the"
"RTN","ENH6914I",38,0)
 W !,"EQUIPMENT INV. (#6914) file that have invalid or missing (empty) values in"
"RTN","ENH6914I",39,0)
 W !,"the fields that are being converted into the CoreFLS system.  The compile"
"RTN","ENH6914I",40,0)
 W !,"examines 30 fields to determine if there is a valid value in each. If there"
"RTN","ENH6914I",41,0)
 W !,"is no value in the field, it is considered to be empty. If there is a value in"
"RTN","ENH6914I",42,0)
 W !,"a lookup-type (a.k.a. pointer) field, the compile examines the value to ensure"
"RTN","ENH6914I",43,0)
 W !,"that it is valid."
"RTN","ENH6914I",44,0)
 S L=L+8
"RTN","ENH6914I",45,0)
 I L+5>IOSL D HDR Q:ABORT
"RTN","ENH6914I",46,0)
 W !!,"Before you use this report, you may want to run the compile to ensure you are"
"RTN","ENH6914I",47,0)
 W !,"viewing the most recent modifications."
"RTN","ENH6914I",48,0)
 S L=L+3
"RTN","ENH6914I",49,0)
 I L+10>IOSL D HDR Q:ABORT
"RTN","ENH6914I",50,0)
 W !!,"This report examines the following fields:"
"RTN","ENH6914I",51,0)
 W !,"NOTE: Abbreviations for field names used on this report appear in quotes next"
"RTN","ENH6914I",52,0)
 W !,"to the field number"
"RTN","ENH6914I",53,0)
 W !!,"   ENTRY NUMBER (#.01)"
"RTN","ENH6914I",54,0)
 W !,"   MANUFACTURER (#1)"
"RTN","ENH6914I",55,0)
 W !,"   PARENT SYSTEM (#2)"
"RTN","ENH6914I",56,0)
 S L=L+8
"RTN","ENH6914I",57,0)
 I L+7>IOSL D HDR Q:ABORT
"RTN","ENH6914I",58,0)
 I $E(IOSL,1,2)'="C-"&(L<5) W ! S L=L+1
"RTN","ENH6914I",59,0)
 W !,"   MFGR. EQUIPMENT NAME (#3) - ""Mfgr Equip Name"""
"RTN","ENH6914I",60,0)
 W !,"   MODEL (#4)"
"RTN","ENH6914I",61,0)
 W !,"   SERIAL # (#5)"
"RTN","ENH6914I",62,0)
 W !,"   EQUIPMENT CATEGORY (#6) - ""Equip Category"""
"RTN","ENH6914I",63,0)
 W !,"   TYPE OF ENTRY (#7)"
"RTN","ENH6914I",64,0)
 S L=L+5
"RTN","ENH6914I",65,0)
 I L+7>IOSL D HDR Q:ABORT
"RTN","ENH6914I",66,0)
 I $E(IOSL,1,2)'="C-"&(L<5) W ! S L=L+1
"RTN","ENH6914I",67,0)
 W !,"   VENDOR POINTER (#10) - ""Vendor"""
"RTN","ENH6914I",68,0)
 W !,"   TOTAL ASSET VALUE (#12) - ""Total Asset Val"""
"RTN","ENH6914I",69,0)
 W !,"   ACQUISITION SOURCE (#13.5) - ""Acq Source"""
"RTN","ENH6914I",70,0)
 W !,"   CATEGORY STOCK NUMBER (#18) - ""Cat Stock Number"""
"RTN","ENH6914I",71,0)
 W !,"   CMR (#19)"
"RTN","ENH6914I",72,0)
 S L=L+5
"RTN","ENH6914I",73,0)
 I L+7>IOSL D HDR Q:ABORT
"RTN","ENH6914I",74,0)
 I $E(IOSL,1,2)'="C-"&(L<5) W ! S L=L+1
"RTN","ENH6914I",75,0)
 W !,"   USE STATUS (#20)"
"RTN","ENH6914I",76,0)
 W !,"   SERVICE POINTER (#21) - ""Service Ptr"""
"RTN","ENH6914I",77,0)
 W !,"   LOCATION (#24)"
"RTN","ENH6914I",78,0)
 W !,"   RESPONSIBLE SHOP (Multiple) (#6914.04,.01) - ""Resp Shop"""
"RTN","ENH6914I",79,0)
 W !,"   TECHNICIAN (RESPONSIBLE SHOP Multiple) (#6914.04,1)"
"RTN","ENH6914I",80,0)
 S L=L+5
"RTN","ENH6914I",81,0)
 I L+7>IOSL D HDR Q:ABORT
"RTN","ENH6914I",82,0)
 I $E(IOSL,1,2)'="C-"&(L<5) W ! S L=L+1
"RTN","ENH6914I",83,0)
 W !,"   STARTING MONTH (RESPONSIBLE SHOP Multiple) (#6914.04,2)"
"RTN","ENH6914I",84,0)
 W !,"   CRITICALITY (RESPONSIBLE SHOP Multiple) (#6914.04,2.7)"
"RTN","ENH6914I",85,0)
 W !,"   FREQUENCY (RESPONSIBLE SHOP/FREQUENCY Multiple) (#6914.43,.01)"
"RTN","ENH6914I",86,0)
 W !,"   LEVEL (RESPONSIBLE SHOP/FREQUENCY Multiple) (#6914.43,3)"
"RTN","ENH6914I",87,0)
 W !,"   PROCEDURE (RESPONSIBLE SHOP/FREQUENCY Multiple) (#6914.43,4)"
"RTN","ENH6914I",88,0)
 S L=L+5
"RTN","ENH6914I",89,0)
 I L+9>IOSL D HDR Q:ABORT
"RTN","ENH6914I",90,0)
 I $E(IOSL,1,2)'="C-"&(L<5) W ! S L=L+1
"RTN","ENH6914I",91,0)
 W !,"   INVESTMENT CATEGORY (#34) - ""Investment Cat"""
"RTN","ENH6914I",92,0)
 W !,"   STANDARD GENERAL LEDGER (#38) - ""SGL"""
"RTN","ENH6914I",93,0)
 W !,"   WORK PERFORMED (EQUIPMENT HISTORY Multiple) (#6914.02,9)"
"RTN","ENH6914I",94,0)
 W !,"   STATION NUMBER (#60) - ""Station"""
"RTN","ENH6914I",95,0)
 W !,"   BUDGET OBJECT CODE (#61) - ""BOC"""
"RTN","ENH6914I",96,0)
 W !,"   FUND (#62)"
"RTN","ENH6914I",97,0)
 W !,"   ADMINISTRATION/OFFICE (#63) - ""Admin Office"""
"RTN","ENH6914I",98,0)
 S L=L+7
"RTN","ENH6914I",99,0)
 I L+7>IOSL D HDR Q:ABORT
"RTN","ENH6914I",100,0)
 W !!,"The report is sorted by station number. When printing or viewing this report,"
"RTN","ENH6914I",101,0)
 W !,"you may select a single station number or ALL. Select ""ZZ no station"" to"
"RTN","ENH6914I",102,0)
 W !,"display the records with no entry in the STATION (#60) field. The report lists"
"RTN","ENH6914I",103,0)
 W !,"the overall count of the number of problem records and fields detected."
"RTN","ENH6914I",104,0)
 S L=L+5
"RTN","ENH6914I",105,0)
 I L+5>IOSL D HDR Q:ABORT
"RTN","ENH6914I",106,0)
 W !!,"The totals for each station are as follows:"
"RTN","ENH6914I",107,0)
 S L=L+2
"RTN","ENH6914I",108,0)
 I L+5>IOSL D HDR Q:ABORT
"RTN","ENH6914I",109,0)
 W !!,"Total records analyzed - number of records in the EQUIPMENT INV. (#6914)"
"RTN","ENH6914I",110,0)
 W !,"     file assigned to the station"
"RTN","ENH6914I",111,0)
 S L=L+3
"RTN","ENH6914I",112,0)
 I L+5>IOSL D HDR Q:ABORT
"RTN","ENH6914I",113,0)
 W !!,"Total records with Required Fields Missing Data - number of records that"
"RTN","ENH6914I",114,0)
 W !,"     have at least one empty required field"
"RTN","ENH6914I",115,0)
 S L=L+3
"RTN","ENH6914I",116,0)
 I L+5>IOSL D HDR Q:ABORT
"RTN","ENH6914I",117,0)
 W !!,"Total records with Lookup Fields w/ Invalid Data - number of records"
"RTN","ENH6914I",118,0)
 W !,"     that have invalid data in any of the lookup fields"
"RTN","ENH6914I",119,0)
 S L=L+3
"RTN","ENH6914I",120,0)
 I L+5>IOSL D HDR Q:ABORT
"RTN","ENH6914I",121,0)
 W !!,"Total records with Non-Required Fields Missing Data - number of records"
"RTN","ENH6914I",122,0)
 W !,"     that have nothing in at least one non-required field"
"RTN","ENH6914I",123,0)
 S L=L+3
"RTN","ENH6914I",124,0)
 I L+5>IOSL D HDR Q:ABORT
"RTN","ENH6914I",125,0)
 W !!,"Next, the report lists the counts for each individual field. The fields are"
"RTN","ENH6914I",126,0)
 W !,"listed in alphabetical order. Each row consists of the following columns:"
"RTN","ENH6914I",127,0)
 S L=L+3
"RTN","ENH6914I",128,0)
 I L+7>IOSL D HDR Q:ABORT
"RTN","ENH6914I",129,0)
 W !!,"DATA QUALITY CHECK TYPE - tells whether the field was examined for:"
"RTN","ENH6914I",130,0)
 W !,"     REQ: required fields missing data"
"RTN","ENH6914I",131,0)
 W !,"     INV: invalid data"
"RTN","ENH6914I",132,0)
 W !,"     NREQ: non-required fields missing data"
"RTN","ENH6914I",133,0)
 S L=L+5
"RTN","ENH6914I",134,0)
 I L+5>IOSL D HDR Q:ABORT
"RTN","ENH6914I",135,0)
 W !!,"FIELD NAME - name or abbreviation of the field from the EQUIPMENT INV."
"RTN","ENH6914I",136,0)
 W !,"     (#6914) file"
"RTN","ENH6914I",137,0)
 S L=L+3
"RTN","ENH6914I",138,0)
 I L+5>IOSL D HDR Q:ABORT
"RTN","ENH6914I",139,0)
 W !!,"REQUIRED FIELDS MISSING DATA - count of the number of empty required fields"
"RTN","ENH6914I",140,0)
 W !,"     (""N/A"" appears in this column if the field is not required by CoreFLS.)"
"RTN","ENH6914I",141,0)
 S L=L+3
"RTN","ENH6914I",142,0)
 I L+6>IOSL D HDR Q:ABORT
"RTN","ENH6914I",143,0)
 W !!,"LOOKUP FIELDS W/ INVALID DATA - count of the number of lookup fields that"
"RTN","ENH6914I",144,0)
 W !,"     contain an invalid value  (""N/A"" appears in this column if the field"
"RTN","ENH6914I",145,0)
 W !,"     is not a lookup field.)"
"RTN","ENH6914I",146,0)
 S L=L+4
"RTN","ENH6914I",147,0)
 I L+6>IOSL D HDR Q:ABORT
"RTN","ENH6914I",148,0)
 W !!,"NON-REQ. FIELDS WITH MISSING DATA - count of the number of empty"
"RTN","ENH6914I",149,0)
 W !,"     non-required fields (""N/A"" appears in this column if non-required"
"RTN","ENH6914I",150,0)
 W !,"     does not apply to this field.)"
"RTN","ENH6914I",151,0)
 S L=L+4
"RTN","ENH6914I",152,0)
 I L+19>IOSL D HDR Q:ABORT
"RTN","ENH6914I",153,0)
 W !!,"**** Special Note ***********************************************"
"RTN","ENH6914I",154,0)
 W !,"The following are multiple-type fields:"
"RTN","ENH6914I",155,0)
 W !,"   RESPONSIBLE SHOP (#6914.04,.01)"
"RTN","ENH6914I",156,0)
 W !,"   TECHNICIAN (#6914.01,1)"
"RTN","ENH6914I",157,0)
 W !,"   STARTING MONTH (#6914.04,2)"
"RTN","ENH6914I",158,0)
 W !,"   CRITICALITY (#6914.04,2.7)"
"RTN","ENH6914I",159,0)
 W !,"   FREQUENCY (#6914.43,.01)"
"RTN","ENH6914I",160,0)
 W !,"   LEVEL (#6914.43,3)"
"RTN","ENH6914I",161,0)
 W !,"   PROCEDURE (#6914.43,4)"
"RTN","ENH6914I",162,0)
 W !,"   WORK PERFORMED (#6914.02,9)"
"RTN","ENH6914I",163,0)
 W !,"Multiple fields can occur many times within one EQUIPMENT INV."
"RTN","ENH6914I",164,0)
 W !,"(#6914) file record. All occurrences of these fields are examined."
"RTN","ENH6914I",165,0)
 W !,"The index number of the multiple with missing or invalid data is"
"RTN","ENH6914I",166,0)
 W !,"displayed on the detail reports."
"RTN","ENH6914I",167,0)
 W !,"*******************************************************************"
"RTN","ENH6914I",168,0)
 W !!,"<End of Instructions>" I $E(IOST,1,2)="C-" W "  Enter RETURN to continue or '^' to exit: " R Y:DTIME I '$T!(Y[U) S ABORT=1 Q
"RTN","ENH6914I",169,0)
 W @IOF
"RTN","ENH6914I",170,0)
 Q
"RTN","ENH6914I",171,0)
 ;
"RTN","ENH6914I",172,0)
HDR ;Page break for multi page instructions
"RTN","ENH6914I",173,0)
 ; Do not ask 'RETURN' before first page on CRT.
"RTN","ENH6914I",174,0)
 I $E(IOST,1,2)="C-",P R !!,"Enter RETURN to continue or '^' to exit:  ",Y:DTIME I '$T!(Y[U) S ABORT=1 Q
"RTN","ENH6914I",175,0)
 ; Do not print a form feed before first page on printer.  Top of form is set at the end of previous report.
"RTN","ENH6914I",176,0)
 I $E(IOST,1,2)="C-"!P W @IOF
"RTN","ENH6914I",177,0)
 S P=P+1 S L=2
"RTN","ENH6914I",178,0)
 W !,"EQUIPMENT INV. (#6914) - ",INSHDR,?67,"Page: ",$J(P,5,0)
"RTN","ENH6914I",179,0)
 W !,"CoreFLS Data Cleansing Report Instructions",?58,"Printed: ",$$FMTE^XLFDT(DT)
"RTN","ENH6914I",180,0)
 Q
"RTN","ENH6914J")
0^10^B34141902
"RTN","ENH6914J",1,0)
ENH6914J ;WOIFO/TAW/EEN - Equipment Inventory Reports Instructions - CoreFLS data cleansing ; 09/25/03 9:28
"RTN","ENH6914J",2,0)
 ;;7.0;ENGINEERING;**75**;Aug 17, 1993
"RTN","ENH6914J",3,0)
 ;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","ENH6914J",4,0)
 ;
"RTN","ENH6914J",5,0)
 Q  ;this routine is not callable from the top
"RTN","ENH6914J",6,0)
 ;
"RTN","ENH6914J",7,0)
 ;This routine should not be run directly.  It should only be called
"RTN","ENH6914J",8,0)
 ;from ENH6914G (AEMS/MERS 6914 Report print).
"RTN","ENH6914J",9,0)
 ;
"RTN","ENH6914J",10,0)
FLDINST ;Instructions for the Required Fields Missing Data Report
"RTN","ENH6914J",11,0)
 U IO
"RTN","ENH6914J",12,0)
 S (P,L,ABORT)=0
"RTN","ENH6914J",13,0)
 S INSHDR="REQUIRED FIELDS MISSING DATA"
"RTN","ENH6914J",14,0)
 D HDR
"RTN","ENH6914J",15,0)
 W !!,"The purpose of this report is to display a list of all EQUIPMENT INV. (#6914)"
"RTN","ENH6914J",16,0)
 W !,"items with missing (empty) data for the fields that are required in the CoreFLS"
"RTN","ENH6914J",17,0)
 W !,"system.  CoreFLS is unable to function when a required field is empty;"
"RTN","ENH6914J",18,0)
 W !,"therefore, you must enter valid data in these fields prior to conversion."
"RTN","ENH6914J",19,0)
 S L=L+6
"RTN","ENH6914J",20,0)
 I L+5>IOSL D HDR Q:ABORT
"RTN","ENH6914J",21,0)
 W !!,"Before you use this report, you may want to run the compile to ensure you are"
"RTN","ENH6914J",22,0)
 W !,"viewing the most recent modifications."
"RTN","ENH6914J",23,0)
 S L=L+3
"RTN","ENH6914J",24,0)
 I L+14>IOSL D HDR Q:ABORT
"RTN","ENH6914J",25,0)
 W !!,"This report examines the following required fields:"
"RTN","ENH6914J",26,0)
 W !,"NOTE: Abbreviations for field names used on this report appear in quotes next"
"RTN","ENH6914J",27,0)
 W !,"to the field number"
"RTN","ENH6914J",28,0)
 W !!,"   ENTRY NUMBER (#.01)"
"RTN","ENH6914J",29,0)
 W !,"   MFGR. EQUIPMENT NAME (#3) - ""Mfr Equip Name"""
"RTN","ENH6914J",30,0)
 W !,"   TYPE OF ENTRY (#7)"
"RTN","ENH6914J",31,0)
 W !,"   CMR (#19)"
"RTN","ENH6914J",32,0)
 W !,"   LOCATION (#24)"
"RTN","ENH6914J",33,0)
 W !,"   INVESTMENT CATEGORY (#34) - ""Investment Cat"""
"RTN","ENH6914J",34,0)
 W !,"   WORK PERFORMED (EQUIPMENT HISTORY Multiple) (#6914.02,9)"
"RTN","ENH6914J",35,0)
 S L=L+12
"RTN","ENH6914J",36,0)
 I L+6>IOSL D HDR Q:ABORT
"RTN","ENH6914J",37,0)
 W !!,"The report is sorted by station number. When printing or viewing this report,"
"RTN","ENH6914J",38,0)
 W !,"you may select a single station number or ALL. Select ""ZZ no station"" to"
"RTN","ENH6914J",39,0)
 W !,"display the records with no entry in the STATION (#60) field."
"RTN","ENH6914J",40,0)
 S L=L+4
"RTN","ENH6914J",41,0)
 I L+4>IOSL D HDR Q:ABORT
"RTN","ENH6914J",42,0)
 W !!,"The totals for each station are as follows:"
"RTN","ENH6914J",43,0)
 S L=L+2
"RTN","ENH6914J",44,0)
 I L+5>IOSL D HDR Q:ABORT
"RTN","ENH6914J",45,0)
 W !!,"Total records analyzed - number of records in the EQUIPMENT INV. (#6914) file"
"RTN","ENH6914J",46,0)
 W !,"     assigned to the station"
"RTN","ENH6914J",47,0)
 S L=L+3
"RTN","ENH6914J",48,0)
 I L+5>IOSL D HDR Q:ABORT
"RTN","ENH6914J",49,0)
 W !!,"Total records with Required Fields Missing Data - number of records that have"
"RTN","ENH6914J",50,0)
 W !,"     one or more empty required fields"
"RTN","ENH6914J",51,0)
 S L=L+3
"RTN","ENH6914J",52,0)
 I L+5>IOSL D HDR Q:ABORT
"RTN","ENH6914J",53,0)
 W !!,"Total fields with Required Fields Missing Data - number of required fields"
"RTN","ENH6914J",54,0)
 W !,"     that are empty"
"RTN","ENH6914J",55,0)
 S L=L+3
"RTN","ENH6914J",56,0)
 I L+5>IOSL D HDR Q:ABORT
"RTN","ENH6914J",57,0)
 W !!,"The report lists each record in order by its internal entry number (IEN)."
"RTN","ENH6914J",58,0)
 W !,"Each row on the report contains the following columns:"
"RTN","ENH6914J",59,0)
 S L=L+3
"RTN","ENH6914J",60,0)
 I L+7>IOSL D HDR Q:ABORT
"RTN","ENH6914J",61,0)
 W !!,"REC IEN - lists the EQUIPMENT INV. (#6914) file internal record number."
"RTN","ENH6914J",62,0)
 W !!,"MFGR. EQUIPMENT NAME - name of the equipment (if there is a value in this"
"RTN","ENH6914J",63,0)
 W !,"     field, you may use it to select the Equipment Inventory item)"
"RTN","ENH6914J",64,0)
 S L=L+5
"RTN","ENH6914J",65,0)
 I L+4>IOSL D HDR Q:ABORT
"RTN","ENH6914J",66,0)
 W !!,"FIELD NAME - name or abbreviation of the required field"
"RTN","ENH6914J",67,0)
 S L=L+2
"RTN","ENH6914J",68,0)
 I L+4>IOSL D HDR Q:ABORT
"RTN","ENH6914J",69,0)
 W !!,"MULTIPLE NUMBER - index number of the multiple"
"RTN","ENH6914J",70,0)
 S L=L+2
"RTN","ENH6914J",71,0)
 I L+5>IOSL D HDR Q:ABORT
"RTN","ENH6914J",72,0)
 W !!,"You must correct every field that appears on this report prior to conversion."
"RTN","ENH6914J",73,0)
 W !,"Use AEMS/MERS to enter a valid value in each empty field listed."
"RTN","ENH6914J",74,0)
 S L=L+3
"RTN","ENH6914J",75,0)
 I L+6>IOSL D HDR Q:ABORT
"RTN","ENH6914J",76,0)
 W !!,"The only two fields that you cannot correct in this manner are the ENTRY"
"RTN","ENH6914J",77,0)
 W !,"NUMBER (#.01) and the WORK PERFORMED (#6914.02,9) fields. To correct these"
"RTN","ENH6914J",78,0)
 W !,"fields, contact the IRM or ADPAC for assistance."
"RTN","ENH6914J",79,0)
 S L=L+4
"RTN","ENH6914J",80,0)
 I L+11>IOSL D HDR Q:ABORT
"RTN","ENH6914J",81,0)
 W !!,"*** Special Note ************************************************"
"RTN","ENH6914J",82,0)
 W !,"The following is a multiple-type field:"
"RTN","ENH6914J",83,0)
 W !,"   WORK PERFORMED (#6914.02,9)"
"RTN","ENH6914J",84,0)
 W !,"Multiple fields can occur many times within one EQUIPMENT INV."
"RTN","ENH6914J",85,0)
 W !,"(#6914) file record. All occurrences of these fields are examined."
"RTN","ENH6914J",86,0)
 W !,"The index number of the multiple with missing data is displayed"
"RTN","ENH6914J",87,0)
 W !,"on this report."
"RTN","ENH6914J",88,0)
 W !,"******************************************************************"
"RTN","ENH6914J",89,0)
 S L=L+9
"RTN","ENH6914J",90,0)
 I L+22>IOSL D HDR Q:ABORT
"RTN","ENH6914J",91,0)
 W !!,"*** Conversion Note *********************************************"
"RTN","ENH6914J",92,0)
 W !,"If the required fields are left empty, the following will occur"
"RTN","ENH6914J",93,0)
 W !,"during CoreFLS conversion:"
"RTN","ENH6914J",94,0)
 W !!,"   ENTRY NUMBER (#.01) - the entire record will not be converted"
"RTN","ENH6914J",95,0)
 W !!,"   MFGR. EQUIPMENT NAME (#3) - the EQUIPMENT CATEGORY (#6) field"
"RTN","ENH6914J",96,0)
 W !,"                               will be used as a default"
"RTN","ENH6914J",97,0)
 W !!,"   CMR (#19) - two dashes (--) will be used as a default"
"RTN","ENH6914J",98,0)
 W !!,"   LOCATION (#24) - the station number will be used as a default"
"RTN","ENH6914J",99,0)
 W !!,"   WORK PERFORMED (#6914.02,9) - the equipment work order will not"
"RTN","ENH6914J",100,0)
 W !,"                                 have a description"
"RTN","ENH6914J",101,0)
 W !!,"All other required fields will be converted as empty."
"RTN","ENH6914J",102,0)
 W !,"******************************************************************"
"RTN","ENH6914J",103,0)
 W !!,"<End of Instructions>" I $E(IOST,1,2)="C-" W "  Enter RETURN to continue or '^' to exit: " R Y:DTIME I '$T!(Y[U) S ABORT=1 Q
"RTN","ENH6914J",104,0)
 W @IOF
"RTN","ENH6914J",105,0)
 Q
"RTN","ENH6914J",106,0)
 ;
"RTN","ENH6914J",107,0)
HDR ;Page break for multi page instructions
"RTN","ENH6914J",108,0)
 ; Do not ask 'RETURN' before first page on CRT.
"RTN","ENH6914J",109,0)
 I $E(IOST,1,2)="C-",P R !!,"Enter RETURN to continue or '^' to exit:  ",Y:DTIME I '$T!(Y[U) S ABORT=1 Q
"RTN","ENH6914J",110,0)
 ; Do not print a form feed before first page on printer.  Top of form is set at the end of previous report.
"RTN","ENH6914J",111,0)
 I $E(IOST,1,2)="C-"!P W @IOF
"RTN","ENH6914J",112,0)
 S P=P+1 S L=2
"RTN","ENH6914J",113,0)
 W !,"EQUIPMENT INV. (#6914) - ",INSHDR,?67,"Page: ",$J(P,5,0)
"RTN","ENH6914J",114,0)
 W !,"CoreFLS Data Cleansing Report Instructions",?58,"Printed: ",$$FMTE^XLFDT(DT)
"RTN","ENH6914J",115,0)
 Q
"RTN","ENH6914M")
0^16^B39879624
"RTN","ENH6914M",1,0)
ENH6914M ;WOIFO/TAW/EEN - Equipment Inventory Reports Instructions - CoreFLS data cleansing ; 09/25/03 9:28
"RTN","ENH6914M",2,0)
 ;;7.0;ENGINEERING;**75**;Aug 17, 1993
"RTN","ENH6914M",3,0)
 ;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","ENH6914M",4,0)
 ;
"RTN","ENH6914M",5,0)
 Q  ;this routine is not callable from the top
"RTN","ENH6914M",6,0)
 ;
"RTN","ENH6914M",7,0)
 ;This routine should not be run directly.  It should only be called
"RTN","ENH6914M",8,0)
 ;from ENH6914G (AEMS/MERS 6914 Report print)
"RTN","ENH6914M",9,0)
 ;
"RTN","ENH6914M",10,0)
ENTINST ;These are the instructions for the Broken Pointers Report
"RTN","ENH6914M",11,0)
 U IO
"RTN","ENH6914M",12,0)
 S (P,L,ABORT)=0
"RTN","ENH6914M",13,0)
 S INSHDR="LOOKUP FIELDS W/ INVALID DATA"
"RTN","ENH6914M",14,0)
 D HDR
"RTN","ENH6914M",15,0)
 W !!,"The purpose of this report is to display a list of fields in the EQUIPMENT"
"RTN","ENH6914M",16,0)
 W !,"INV. (#6914) file that contain an invalid value in a lookup-type or pointer"
"RTN","ENH6914M",17,0)
 W !,"field.  An invalid value is defined as a value that either does not have an"
"RTN","ENH6914M",18,0)
 W !,"entry in the file to which it points, or the entry in the file pointed to has"
"RTN","ENH6914M",19,0)
 W !,"an empty NAME (#.01) field.  An entry and a name must be present in the file to"
"RTN","ENH6914M",20,0)
 W !,"which a field points."
"RTN","ENH6914M",21,0)
 S L=L+7
"RTN","ENH6914M",22,0)
 I L+5>IOSL D HDR Q:ABORT
"RTN","ENH6914M",23,0)
 W !!,"Before you use this report, you may want to run the compile to ensure you are"
"RTN","ENH6914M",24,0)
 W !,"viewing the most recent modifications."
"RTN","ENH6914M",25,0)
 S L=L+3
"RTN","ENH6914M",26,0)
 I L+10>IOSL D HDR Q:ABORT
"RTN","ENH6914M",27,0)
 W !!,"This report examines the following lookup fields:"
"RTN","ENH6914M",28,0)
 W !,"NOTE: Abbreviations for field names used on this report appear in quotes next"
"RTN","ENH6914M",29,0)
 W !,"to the field number"
"RTN","ENH6914M",30,0)
 W !!,"   PARENT SYSTEM (#2)"
"RTN","ENH6914M",31,0)
 W !,"   MANUFACTURER (#1)"
"RTN","ENH6914M",32,0)
 W !,"   EQUIPMENT CATEGORY (#6) - ""Equip Category"""
"RTN","ENH6914M",33,0)
 S L=L+8
"RTN","ENH6914M",34,0)
 I L+8>IOSL D HDR Q:ABORT
"RTN","ENH6914M",35,0)
 I $E(IOSL,1,2)'="C-"&(L<5) W ! S L=L+1
"RTN","ENH6914M",36,0)
 W !,"   VENDOR POINTER (#10) - ""Vendor"""
"RTN","ENH6914M",37,0)
 W !,"   CATEGORY STOCK NUMBER (#18) - ""Cat Stock Number"""
"RTN","ENH6914M",38,0)
 W !,"   CMR (#19)"
"RTN","ENH6914M",39,0)
 W !,"   SERVICE POINTER (#21) - ""Service Ptr"""
"RTN","ENH6914M",40,0)
 W !,"   LOCATION (#24)"
"RTN","ENH6914M",41,0)
 W !,"   RESPONSIBLE SHOP (Multiple) (#6914.04,.01) - ""Resp Shop"""
"RTN","ENH6914M",42,0)
 S L=L+6
"RTN","ENH6914M",43,0)
 I L+9>IOSL D HDR Q:ABORT
"RTN","ENH6914M",44,0)
 I $E(IOSL,1,2)'="C-"&(L<5) W ! S L=L+1
"RTN","ENH6914M",45,0)
 W !,"   TECHNICIAN (RESPONSIBLE SHOP Multiple) (#6914.04,1)"
"RTN","ENH6914M",46,0)
 W !,"   PROCEDURE (RESPONSIBLE SHOP/FREQUENCY Multiple) (#6914.43,4)"
"RTN","ENH6914M",47,0)
 W !,"   ACQUISITION SOURCE (#13.5) - ""Acq Source"""
"RTN","ENH6914M",48,0)
 W !,"   STANDARD GENERAL LEDGER (#38) - ""SGL"""
"RTN","ENH6914M",49,0)
 W !,"   BUDGET OBJECT CODE (#61) - ""BOC"""
"RTN","ENH6914M",50,0)
 W !,"   FUND (#62)"
"RTN","ENH6914M",51,0)
 W !,"   ADMINISTRATION/OFFICE (#63) - ""Admin Office"""
"RTN","ENH6914M",52,0)
 S L=L+7
"RTN","ENH6914M",53,0)
 I L+6>IOSL D HDR Q:ABORT
"RTN","ENH6914M",54,0)
 W !!,"This report is sorted by station number. When printing or viewing this"
"RTN","ENH6914M",55,0)
 W !,"report, you may select a single station number or ALL. Select ""ZZ no station"""
"RTN","ENH6914M",56,0)
 W !,"to display the records with no entry in the STATION (#60) field."
"RTN","ENH6914M",57,0)
 S L=L+4
"RTN","ENH6914M",58,0)
 I L+5>IOSL D HDR Q:ABORT
"RTN","ENH6914M",59,0)
 W !!,"The totals for each station are as follows:"
"RTN","ENH6914M",60,0)
 S L=L+2
"RTN","ENH6914M",61,0)
 I L+5>IOSL D HDR Q:ABORT
"RTN","ENH6914M",62,0)
 W !!,"Total records analyzed - number of records in the EQUIPMENT INV. (#6914)"
"RTN","ENH6914M",63,0)
 W !,"     file assigned to the station."
"RTN","ENH6914M",64,0)
 S L=L+3
"RTN","ENH6914M",65,0)
 I L+5>IOSL D HDR Q:ABORT
"RTN","ENH6914M",66,0)
 W !!,"Total records with Lookup Fields w/ Invalid Data - number of records that"
"RTN","ENH6914M",67,0)
 W !,"     have an invalid value in one or more of the lookup fields"
"RTN","ENH6914M",68,0)
 S L=L+3
"RTN","ENH6914M",69,0)
 I L+5>IOSL D HDR Q:ABORT
"RTN","ENH6914M",70,0)
 W !!,"Total fields with Lookup Fields w/ Invalid Data - number of lookup fields"
"RTN","ENH6914M",71,0)
 W !,"     with invalid data"
"RTN","ENH6914M",72,0)
 S L=L+3
"RTN","ENH6914M",73,0)
 I L+5>IOSL D HDR Q:ABORT
"RTN","ENH6914M",74,0)
 W !!,"The report lists each record in order by its internal entry number (IEN)."
"RTN","ENH6914M",75,0)
 W !,"Each row on the report contains the following columns:"
"RTN","ENH6914M",76,0)
 S L=L+3
"RTN","ENH6914M",77,0)
 I L+7>IOSL D HDR Q:ABORT
"RTN","ENH6914M",78,0)
 W !!,"REC IEN - lists the EQUIPMENT INV. (#6914) file internal record number."
"RTN","ENH6914M",79,0)
 W !!,"MFGR. EQUIPMENT NAME - name of the equipment (if there is a value in this"
"RTN","ENH6914M",80,0)
 W !,"     field, you may use it to select the Equipment Inventory item)"
"RTN","ENH6914M",81,0)
 S L=L+5
"RTN","ENH6914M",82,0)
 I L+4>IOSL D HDR Q:ABORT
"RTN","ENH6914M",83,0)
 W !!,"FIELD NAME - name or abbreviation of the lookup field"
"RTN","ENH6914M",84,0)
 S L=L+2
"RTN","ENH6914M",85,0)
 I L+8>IOSL D HDR Q:ABORT
"RTN","ENH6914M",86,0)
 W !!,"MULTIPLE NUMBER - index number of the multiple"
"RTN","ENH6914M",87,0)
 W !,"     (Note: The Procedure field may display a set of two multiple numbers"
"RTN","ENH6914M",88,0)
 W !,"     separated by a comma. The first number represents the Responsible"
"RTN","ENH6914M",89,0)
 W !,"     Shop multiple number. The second number represents the Frequency"
"RTN","ENH6914M",90,0)
 W !,"     multiple number.)"
"RTN","ENH6914M",91,0)
 S L=L+6
"RTN","ENH6914M",92,0)
 I L+5>IOSL D HDR Q:ABORT
"RTN","ENH6914M",93,0)
 W !!,"You must correct every field that appears on this report prior to conversion."
"RTN","ENH6914M",94,0)
 W !,"Use AEMS/MERS to enter a valid value in each lookup field listed."
"RTN","ENH6914M",95,0)
 S L=L+3
"RTN","ENH6914M",96,0)
 I L+6>IOSL D HDR Q:ABORT
"RTN","ENH6914M",97,0)
 W !!,"The only field that you cannot correct in this manner is the RESPONSIBLE"
"RTN","ENH6914M",98,0)
 W !,"SHOP (#6914.04,.01) field. To correct this field, contact the IRM or ADPAC"
"RTN","ENH6914M",99,0)
 W !,"for assistance."
"RTN","ENH6914M",100,0)
 S L=L+4
"RTN","ENH6914M",101,0)
 I L+13>IOSL D HDR Q:ABORT
"RTN","ENH6914M",102,0)
 W !!,"*** Special Note ************************************************"
"RTN","ENH6914M",103,0)
 W !,"The following are multiple-type fields:"
"RTN","ENH6914M",104,0)
 W !,"   RESPONSIBLE SHOP (#6914.04,.01)"
"RTN","ENH6914M",105,0)
 W !,"   TECHNICIAN (#6914.04,1)"
"RTN","ENH6914M",106,0)
 W !,"   PROCEDURE (#6914.43,4)"
"RTN","ENH6914M",107,0)
 W !,"Multiple fields can occur many times within one EQUIPMENT INV."
"RTN","ENH6914M",108,0)
 W !,"(#6914) file record. All occurrences of these fields are examined."
"RTN","ENH6914M",109,0)
 W !,"The index number of the multiple with invalid data is displayed on"
"RTN","ENH6914M",110,0)
 W !,"this report."
"RTN","ENH6914M",111,0)
 W !,"******************************************************************"
"RTN","ENH6914M",112,0)
 S L=L+11
"RTN","ENH6914M",113,0)
 I L+8>IOSL D HDR Q:ABORT
"RTN","ENH6914M",114,0)
 W !!,"*** Conversion Note *********************************************"
"RTN","ENH6914M",115,0)
 W !,"If any of the lookup fields on this report is left with invalid"
"RTN","ENH6914M",116,0)
 W !,"data, it will be converted as empty into CoreFLS."
"RTN","ENH6914M",117,0)
 W !,"******************************************************************"
"RTN","ENH6914M",118,0)
 W !!,"<End of Instructions>" I $E(IOST,1,2)="C-" W "  Enter RETURN to continue or '^' to exit: " R Y:DTIME I '$T!(Y[U) S ABORT=1 Q
"RTN","ENH6914M",119,0)
 W @IOF
"RTN","ENH6914M",120,0)
 Q
"RTN","ENH6914M",121,0)
 ;
"RTN","ENH6914M",122,0)
HDR ;Page break for multi page instructions
"RTN","ENH6914M",123,0)
 ; Do not ask 'RETURN' before first page on CRT.
"RTN","ENH6914M",124,0)
 I $E(IOST,1,2)="C-",P R !!,"Enter RETURN to continue or '^' to exit:  ",Y:DTIME I '$T!(Y[U) S ABORT=1 Q
"RTN","ENH6914M",125,0)
 ; Do not print a form feed before first page on printer.  Top of form is set at the end of previous report.
"RTN","ENH6914M",126,0)
 I $E(IOST,1,2)="C-"!P W @IOF
"RTN","ENH6914M",127,0)
 S P=P+1 S L=2
"RTN","ENH6914M",128,0)
 W !,"EQUIPMENT INV. (#6914) - ",INSHDR,?67,"Page: ",$J(P,5,0)
"RTN","ENH6914M",129,0)
 W !,"CoreFLS Data Cleansing Report Instructions",?58,"Printed: ",$$FMTE^XLFDT(DT)
"RTN","ENH6914M",130,0)
 Q
"RTN","ENH6914R")
0^13^B37625991
"RTN","ENH6914R",1,0)
ENH6914R ;WOIFO/TAW/EEN - Compile Equipment Inventory Report Sort Part I - CoreFLS data cleansing ; 09/25/03 9:29
"RTN","ENH6914R",2,0)
 ;;7.0;ENGINEERING;**75**;Aug 17, 1993
"RTN","ENH6914R",3,0)
 ;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","ENH6914R",4,0)
 ;
"RTN","ENH6914R",5,0)
 Q  ;this routine is not callable from the top
"RTN","ENH6914R",6,0)
 ;
"RTN","ENH6914R",7,0)
 ;This routine will perform part II of the compile of the Summary Report
"RTN","ENH6914R",8,0)
 ;
"RTN","ENH6914R",9,0)
SUMII ;Compile second half of summary data
"RTN","ENH6914R",10,0)
 S FUND=$P($G(^ENG(6914,INT,9)),U,7)
"RTN","ENH6914R",11,0)
 I FUND="" D
"RTN","ENH6914R",12,0)
 . S X=$P($G(^XTMP(ENHRTN,ENHDICT,STAT,"Fund")),U,3)
"RTN","ENH6914R",13,0)
 . S $P(^XTMP(ENHRTN,ENHDICT,STAT,"Fund"),U,3)=X+1
"RTN","ENH6914R",14,0)
 . S ^XTMP(ENHRTN,ENHDICT,STAT,"Fund","NREQ",INT)=""
"RTN","ENH6914R",15,0)
 . S NREQFLG=1,NREQTOT(STAT)=$G(NREQTOT(STAT))+1
"RTN","ENH6914R",16,0)
 I FUND'="" D
"RTN","ENH6914R",17,0)
 . I '$D(^ENG(6914.6,FUND,0))!($P($G(^ENG(6914.6,FUND,0)),U)="") D
"RTN","ENH6914R",18,0)
 .. S X=$P($G(^XTMP(ENHRTN,ENHDICT,STAT,"Fund")),U,2)
"RTN","ENH6914R",19,0)
 .. S $P(^XTMP(ENHRTN,ENHDICT,STAT,"Fund"),U,2)=X+1
"RTN","ENH6914R",20,0)
 .. S ^XTMP(ENHRTN,ENHDICT,STAT,"Fund","INV",INT)=""
"RTN","ENH6914R",21,0)
 .. S INVFLG=1,INVTOT(STAT)=$G(INVTOT(STAT))+1
"RTN","ENH6914R",22,0)
 S MENAME=$P($G(^ENG(6914,INT,0)),U,2)
"RTN","ENH6914R",23,0)
 I MENAME="" D
"RTN","ENH6914R",24,0)
 . S X=$P($G(^XTMP(ENHRTN,ENHDICT,STAT,"Mfgr Equip Name")),U)
"RTN","ENH6914R",25,0)
 . S $P(^XTMP(ENHRTN,ENHDICT,STAT,"Mfgr Equip Name"),U)=X+1
"RTN","ENH6914R",26,0)
 . S ^XTMP(ENHRTN,ENHDICT,STAT,"Mfgr Equip Name","REQ",INT)=""
"RTN","ENH6914R",27,0)
 . S REQFLG=1,REQTOT(STAT)=$G(REQTOT(STAT))+1
"RTN","ENH6914R",28,0)
 S MNUM=$P($G(^ENG(6914,INT,1)),U,2)
"RTN","ENH6914R",29,0)
 I MNUM="" D
"RTN","ENH6914R",30,0)
 . S X=$P($G(^XTMP(ENHRTN,ENHDICT,STAT,"Model")),U,3)
"RTN","ENH6914R",31,0)
 . S $P(^XTMP(ENHRTN,ENHDICT,STAT,"Model"),U,3)=X+1
"RTN","ENH6914R",32,0)
 . S ^XTMP(ENHRTN,ENHDICT,STAT,"Model","NREQ",INT)=""
"RTN","ENH6914R",33,0)
 . S NREQFLG=1,NREQTOT(STAT)=$G(NREQTOT(STAT))+1
"RTN","ENH6914R",34,0)
 S MSER=$P($G(^ENG(6914,INT,1)),U,3)
"RTN","ENH6914R",35,0)
 I MSER="" D
"RTN","ENH6914R",36,0)
 . S X=$P($G(^XTMP(ENHRTN,ENHDICT,STAT,"Serial #")),U,3)
"RTN","ENH6914R",37,0)
 . S $P(^XTMP(ENHRTN,ENHDICT,STAT,"Serial #"),U,3)=X+1
"RTN","ENH6914R",38,0)
 . S ^XTMP(ENHRTN,ENHDICT,STAT,"Serial #","NREQ",INT)=""
"RTN","ENH6914R",39,0)
 . S NREQFLG=1,NREQTOT(STAT)=$G(NREQTOT(STAT))+1
"RTN","ENH6914R",40,0)
 S SGL=$P($G(^ENG(6914,INT,8)),U,6)
"RTN","ENH6914R",41,0)
 I SGL="" D
"RTN","ENH6914R",42,0)
 . S X=$P($G(^XTMP(ENHRTN,ENHDICT,STAT,"SGL")),U,3)
"RTN","ENH6914R",43,0)
 . S $P(^XTMP(ENHRTN,ENHDICT,STAT,"SGL"),U,3)=X+1
"RTN","ENH6914R",44,0)
 . S ^XTMP(ENHRTN,ENHDICT,STAT,"SGL","NREQ",INT)=""
"RTN","ENH6914R",45,0)
 . S NREQFLG=1,NREQTOT(STAT)=$G(NREQTOT(STAT))+1
"RTN","ENH6914R",46,0)
 I SGL'="" D
"RTN","ENH6914R",47,0)
 . I '$D(^ENG(6914.3,SGL,0))!($P($G(^ENG(6914.3,SGL,0)),U)="") D
"RTN","ENH6914R",48,0)
 .. S X=$P($G(^XTMP(ENHRTN,ENHDICT,STAT,"SGL")),U,2)
"RTN","ENH6914R",49,0)
 .. S $P(^XTMP(ENHRTN,ENHDICT,STAT,"SGL"),U,2)=X+1
"RTN","ENH6914R",50,0)
 .. S ^XTMP(ENHRTN,ENHDICT,STAT,"SGL","INV",INT)=""
"RTN","ENH6914R",51,0)
 .. S INVFLG=1,INVTOT(STAT)=$G(INVTOT(STAT))+1
"RTN","ENH6914R",52,0)
 S BOC=$P($G(^ENG(6914,INT,9)),U,6)
"RTN","ENH6914R",53,0)
 I BOC="" D
"RTN","ENH6914R",54,0)
 . S X=$P($G(^XTMP(ENHRTN,ENHDICT,STAT,"BOC")),U,3)
"RTN","ENH6914R",55,0)
 . S $P(^XTMP(ENHRTN,ENHDICT,STAT,"BOC"),U,3)=X+1
"RTN","ENH6914R",56,0)
 . S ^XTMP(ENHRTN,ENHDICT,STAT,"BOC","NREQ",INT)=""
"RTN","ENH6914R",57,0)
 . S NREQFLG=1,NREQTOT(STAT)=$G(NREQTOT(STAT))+1
"RTN","ENH6914R",58,0)
 I BOC'="" D
"RTN","ENH6914R",59,0)
 . I '$D(^ENG(6914.4,BOC,0))!($P($G(^ENG(6914.4,BOC,0)),U,1)="") D
"RTN","ENH6914R",60,0)
 .. S X=$P($G(^XTMP(ENHRTN,ENHDICT,STAT,"BOC")),U,2)
"RTN","ENH6914R",61,0)
 .. S $P(^XTMP(ENHRTN,ENHDICT,STAT,"BOC"),U,2)=X+1
"RTN","ENH6914R",62,0)
 .. S ^XTMP(ENHRTN,ENHDICT,STAT,"BOC","INV",INT)=""
"RTN","ENH6914R",63,0)
 .. S INVFLG=1,INVTOT(STAT)=$G(INVTOT(STAT))+1
"RTN","ENH6914R",64,0)
 S TOE=$P($G(^ENG(6914,INT,0)),U,4)
"RTN","ENH6914R",65,0)
 I TOE="" D
"RTN","ENH6914R",66,0)
 . S X=$P($G(^XTMP(ENHRTN,ENHDICT,STAT,"Type of Entry")),U)
"RTN","ENH6914R",67,0)
 . S $P(^XTMP(ENHRTN,ENHDICT,STAT,"Type of Entry"),U)=X+1
"RTN","ENH6914R",68,0)
 . S ^XTMP(ENHRTN,ENHDICT,STAT,"Type of Entry","REQ",INT)=""
"RTN","ENH6914R",69,0)
 . S REQFLG=1,REQTOT(STAT)=$G(REQTOT(STAT))+1
"RTN","ENH6914R",70,0)
 S ICAT=$P($G(^ENG(6914,INT,8)),U,2)
"RTN","ENH6914R",71,0)
 I ICAT="" D
"RTN","ENH6914R",72,0)
 . S X=$P($G(^XTMP(ENHRTN,ENHDICT,STAT,"Investment Cat")),U)
"RTN","ENH6914R",73,0)
 . S $P(^XTMP(ENHRTN,ENHDICT,STAT,"Investment Cat"),U)=X+1
"RTN","ENH6914R",74,0)
 . S ^XTMP(ENHRTN,ENHDICT,STAT,"Investment Cat","REQ",INT)=""
"RTN","ENH6914R",75,0)
 . S REQFLG=1,REQTOT(STAT)=$G(REQTOT(STAT))+1
"RTN","ENH6914R",76,0)
 I $D(^ENG(6914,INT,4)) D
"RTN","ENH6914R",77,0)
 . S (MULT,MULT2)=0
"RTN","ENH6914R",78,0)
 . F  S MULT=$O(^ENG(6914,INT,4,MULT)) Q:'MULT  D
"RTN","ENH6914R",79,0)
 .. S DATA1=$G(^ENG(6914,INT,4,MULT,0))
"RTN","ENH6914R",80,0)
 .. S RESSHOP=$P(DATA1,U)
"RTN","ENH6914R",81,0)
 .. S TECH=$P(DATA1,U,2)
"RTN","ENH6914R",82,0)
 .. S CRIT=$P(DATA1,U,4)
"RTN","ENH6914R",83,0)
 .. I RESSHOP="" Q      ;DO NOT WANT ANY ENTRIES IF RESP SHOP IS NULL
"RTN","ENH6914R",84,0)
 .. I RESSHOP'="" D
"RTN","ENH6914R",85,0)
 ... I '$D(^DIC(6922,RESSHOP))!($P($G(^DIC(6922,RESSHOP,0)),U,1)="") D
"RTN","ENH6914R",86,0)
 .... S X=$P($G(^XTMP(ENHRTN,ENHDICT,STAT,"Resp Shop")),U,2)
"RTN","ENH6914R",87,0)
 .... S $P(^XTMP(ENHRTN,ENHDICT,STAT,"Resp Shop"),U,2)=X+1
"RTN","ENH6914R",88,0)
 .... S ^XTMP(ENHRTN,ENHDICT,STAT,"Resp Shop","INV",INT,MULT)=MULT
"RTN","ENH6914R",89,0)
 .... S INVFLG=1,INVTOT(STAT)=$G(INVTOT(STAT))+1
"RTN","ENH6914R",90,0)
 .. I TECH'="" D
"RTN","ENH6914R",91,0)
 ... I '$D(^ENG("EMP",TECH))!($P($G(^ENG("EMP",TECH,0)),U,1)="") D
"RTN","ENH6914R",92,0)
 .... S X=$P($G(^XTMP(ENHRTN,ENHDICT,STAT,"Technician")),U,2)
"RTN","ENH6914R",93,0)
 .... S $P(^XTMP(ENHRTN,ENHDICT,STAT,"Technician"),U,2)=X+1
"RTN","ENH6914R",94,0)
 .... S ^XTMP(ENHRTN,ENHDICT,STAT,"Technician","INV",INT,MULT)=MULT
"RTN","ENH6914R",95,0)
 .... S INVFLG=1,INVTOT(STAT)=$G(INVTOT(STAT))+1
"RTN","ENH6914R",96,0)
 .. I CRIT="" D
"RTN","ENH6914R",97,0)
 ... S X=$P($G(^XTMP(ENHRTN,ENHDICT,STAT,"Criticality")),U,3)
"RTN","ENH6914R",98,0)
 ... S $P(^XTMP(ENHRTN,ENHDICT,STAT,"Criticality"),U,3)=X+1
"RTN","ENH6914R",99,0)
 ... S ^XTMP(ENHRTN,ENHDICT,STAT,"Criticality","NREQ",INT,MULT)=MULT
"RTN","ENH6914R",100,0)
 ... S NREQFLG=1,NREQTOT(STAT)=$G(NREQTOT(STAT))+1
"RTN","ENH6914R",101,0)
 .. S SMON=$P($G(^ENG(6914,INT,4,MULT,1)),U)
"RTN","ENH6914R",102,0)
 .. I SMON="" D
"RTN","ENH6914R",103,0)
 ... S X=$P($G(^XTMP(ENHRTN,ENHDICT,STAT,"Starting Month")),U,3)
"RTN","ENH6914R",104,0)
 ... S $P(^XTMP(ENHRTN,ENHDICT,STAT,"Starting Month"),U,3)=X+1
"RTN","ENH6914R",105,0)
 ... S ^XTMP(ENHRTN,ENHDICT,STAT,"Starting Month","NREQ",INT,MULT)=MULT
"RTN","ENH6914R",106,0)
 ... S NREQFLG=1,NREQTOT(STAT)=$G(NREQTOT(STAT))+1
"RTN","ENH6914R",107,0)
 .. S MULT2=0
"RTN","ENH6914R",108,0)
 .. F  S MULT2=$O(^ENG(6914,INT,4,MULT,2,MULT2)) Q:'MULT2  D
"RTN","ENH6914R",109,0)
 ... S DATA2=$G(^ENG(6914,INT,4,MULT,2,MULT2,0))
"RTN","ENH6914R",110,0)
 ... S FREQ=$P(DATA2,U)
"RTN","ENH6914R",111,0)
 ... S LEV=$P(DATA2,U,4)
"RTN","ENH6914R",112,0)
 ... S PROC=$P(DATA2,U,5)
"RTN","ENH6914R",113,0)
 ... I FREQ="" D
"RTN","ENH6914R",114,0)
 .... S X=$P($G(^XTMP(ENHRTN,ENHDICT,STAT,"Frequency")),U,3)
"RTN","ENH6914R",115,0)
 .... S $P(^XTMP(ENHRTN,ENHDICT,STAT,"Frequency"),U,3)=X+1
"RTN","ENH6914R",116,0)
 .... S ^XTMP(ENHRTN,ENHDICT,STAT,"Frequency","NREQ",INT,MULT,MULT2)=MULT_","_MULT2
"RTN","ENH6914R",117,0)
 .... S NREQFLG=1,NREQTOT(STAT)=$G(NREQTOT(STAT))+1
"RTN","ENH6914R",118,0)
 ... I LEV="" D
"RTN","ENH6914R",119,0)
 .... S X=$P($G(^XTMP(ENHRTN,ENHDICT,STAT,"Level")),U,3)
"RTN","ENH6914R",120,0)
 .... S $P(^XTMP(ENHRTN,ENHDICT,STAT,"Level"),U,3)=X+1
"RTN","ENH6914R",121,0)
 .... S ^XTMP(ENHRTN,ENHDICT,STAT,"Level","NREQ",INT,MULT,MULT2)=MULT_","_MULT2
"RTN","ENH6914R",122,0)
 .... S NREQFLG=1,NREQTOT(STAT)=$G(NREQTOT(STAT))+1
"RTN","ENH6914R",123,0)
 ... I PROC="" D
"RTN","ENH6914R",124,0)
 .... S X=$P($G(^XTMP(ENHRTN,ENHDICT,STAT,"Procedure")),U,3)
"RTN","ENH6914R",125,0)
 .... S $P(^XTMP(ENHRTN,ENHDICT,STAT,"Procedure"),U,3)=X+1
"RTN","ENH6914R",126,0)
 .... S ^XTMP(ENHRTN,ENHDICT,STAT,"Procedure","NREQ",INT,MULT,MULT2)=MULT_","_MULT2
"RTN","ENH6914R",127,0)
 .... S NREQFLG=1,NREQTOT(STAT)=$G(NREQTOT(STAT))+1
"RTN","ENH6914R",128,0)
 ... I PROC'="" D
"RTN","ENH6914R",129,0)
 .... I '$D(^ENG(6914.2,PROC))!($P($G(^ENG(6914.2,PROC,0)),U)="") D
"RTN","ENH6914R",130,0)
 ..... S X=$P($G(^XTMP(ENHRTN,ENHDICT,STAT,"Procedure")),U,2)
"RTN","ENH6914R",131,0)
 ..... S $P(^XTMP(ENHRTN,ENHDICT,STAT,"Procedure"),U,2)=X+1
"RTN","ENH6914R",132,0)
 ..... S ^XTMP(ENHRTN,ENHDICT,STAT,"Procedure","INV",INT,MULT,MULT2)=MULT_","_MULT2
"RTN","ENH6914R",133,0)
 ..... S INVFLG=1,INVTOT(STAT)=$G(INVTOT(STAT))+1
"RTN","ENH6914R",134,0)
 Q
"RTN","ENH6914S")
0^14^B33212025
"RTN","ENH6914S",1,0)
ENH6914S ;WOIFO/TAW/EEN - Compile Equipment Inventory Report Sort Part I - CoreFLS data cleansing ; 09/25/03 9:29
"RTN","ENH6914S",2,0)
 ;;7.0;ENGINEERING;**75**;Aug 17, 1993
"RTN","ENH6914S",3,0)
 ;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","ENH6914S",4,0)
 ;
"RTN","ENH6914S",5,0)
 Q  ;this routine is not callable from the top
"RTN","ENH6914S",6,0)
 ;
"RTN","ENH6914S",7,0)
 ;This routine should not be run directly.  It should only be called
"RTN","ENH6914S",8,0)
 ;from the main routine ENH6914. This routine will perform part I of
"RTN","ENH6914S",9,0)
 ;the compile of the Summary Report. 
"RTN","ENH6914S",10,0)
 ;
"RTN","ENH6914S",11,0)
SUMMARY ;Compile only summary data
"RTN","ENH6914S",12,0)
 S (INTCNT,NULLFLG,FLAG,POP,FIELD)="",(REQTOT,NREQTOT,INVTOT,INT)=0
"RTN","ENH6914S",13,0)
 S ENHRTN="ENH6914",ENHDICT="",CNT=0
"RTN","ENH6914S",14,0)
 K ^XTMP(ENHRTN)
"RTN","ENH6914S",15,0)
 I $E(IOST,1,2)="C-" D WAIT^DICD
"RTN","ENH6914S",16,0)
 F  S INT=$O(^ENG(6914,INT)) Q:'INT  D
"RTN","ENH6914S",17,0)
 . ; Filter out records
"RTN","ENH6914S",18,0)
 . S USESTAT=$P($G(^ENG(6914,INT,3)),U,1)
"RTN","ENH6914S",19,0)
 . S DMET=$P($G(^ENG(6914,INT,3)),U,12)
"RTN","ENH6914S",20,0)
 . S DDATE=$P($G(^ENG(6914,INT,3)),U,11)
"RTN","ENH6914S",21,0)
 . ;S TOE=$P($G(^ENG(6914,INT,0)),U,4)
"RTN","ENH6914S",22,0)
 . I ((DMET'="")&(DDATE'=""))&((USESTAT=4)!(USESTAT=5)) Q  ;DO NOT WANT
"RTN","ENH6914S",23,0)
 . ;I (TOE="BSE")!(TOE="EXP") Q
"RTN","ENH6914S",24,0)
 . ;
"RTN","ENH6914S",25,0)
 . ; Find Station Number and initize nodes in XTMP global
"RTN","ENH6914S",26,0)
 . S STAT=$P($G(^ENG(6914,INT,9)),U,5)
"RTN","ENH6914S",27,0)
 . I STAT="" S STAT="ZZ no station"
"RTN","ENH6914S",28,0)
 . I '$D(^XTMP(ENHRTN,"STAT",STAT)) D  ;Initialize if new station
"RTN","ENH6914S",29,0)
 .. S CNT=CNT+1
"RTN","ENH6914S",30,0)
 .. S ^XTMP(ENHRTN,"STAT",STAT)=CNT
"RTN","ENH6914S",31,0)
 .. S (REQTOT(STAT),NREQTOT(STAT),INVTOT(STAT))=0
"RTN","ENH6914S",32,0)
 .. S ^XTMP(ENHRTN,CNT,STAT)="0^0^0^0"
"RTN","ENH6914S",33,0)
 .. S ^XTMP(ENHRTN,CNT,STAT,0)="0^0^0"
"RTN","ENH6914S",34,0)
 .. S ^XTMP(ENHRTN,CNT,STAT,"Entry Number")="0^N/A^N/A^REQ"
"RTN","ENH6914S",35,0)
 .. S ^XTMP(ENHRTN,CNT,STAT,"Location")="0^0^N/A^REQ, INV"
"RTN","ENH6914S",36,0)
 .. S ^XTMP(ENHRTN,CNT,STAT,"Type of Entry")="0^N/A^N/A^REQ"
"RTN","ENH6914S",37,0)
 .. S ^XTMP(ENHRTN,CNT,STAT,"Mfgr Equip Name")="0^N/A^N/A^REQ"
"RTN","ENH6914S",38,0)
 .. S ^XTMP(ENHRTN,CNT,STAT,"CMR")="0^0^N/A^REQ, INV"
"RTN","ENH6914S",39,0)
 .. S ^XTMP(ENHRTN,CNT,STAT,"Investment Cat")="0^N/A^N/A^REQ"
"RTN","ENH6914S",40,0)
 .. S ^XTMP(ENHRTN,CNT,STAT,"Manufacturer")="N/A^0^N/A^INV"
"RTN","ENH6914S",41,0)
 .. S ^XTMP(ENHRTN,CNT,STAT,"Parent System")="N/A^0^N/A^INV"
"RTN","ENH6914S",42,0)
 .. S ^XTMP(ENHRTN,CNT,STAT,"Model")="N/A^N/A^0^NREQ"
"RTN","ENH6914S",43,0)
 .. S ^XTMP(ENHRTN,CNT,STAT,"Serial #")="N/A^N/A^0^NREQ"
"RTN","ENH6914S",44,0)
 .. S ^XTMP(ENHRTN,CNT,STAT,"Equip Category")="N/A^0^N/A^INV"
"RTN","ENH6914S",45,0)
 .. S ^XTMP(ENHRTN,CNT,STAT,"Vendor")="N/A^0^N/A^INV"
"RTN","ENH6914S",46,0)
 .. S ^XTMP(ENHRTN,CNT,STAT,"Total Asset Val")="N/A^N/A^0^NREQ"
"RTN","ENH6914S",47,0)
 .. S ^XTMP(ENHRTN,CNT,STAT,"Cat Stock Number")="N/A^0^N/A^INV"
"RTN","ENH6914S",48,0)
 .. S ^XTMP(ENHRTN,CNT,STAT,"Use Status")="N/A^N/A^0^NREQ"
"RTN","ENH6914S",49,0)
 .. S ^XTMP(ENHRTN,CNT,STAT,"Service Ptr")="N/A^0^N/A^INV"
"RTN","ENH6914S",50,0)
 .. S ^XTMP(ENHRTN,CNT,STAT,"Resp Shop")="N/A^0^N/A^INV"
"RTN","ENH6914S",51,0)
 .. S ^XTMP(ENHRTN,CNT,STAT,"Technician")="N/A^0^N/A^INV"
"RTN","ENH6914S",52,0)
 .. S ^XTMP(ENHRTN,CNT,STAT,"Starting Month")="N/A^N/A^0^NREQ"
"RTN","ENH6914S",53,0)
 .. S ^XTMP(ENHRTN,CNT,STAT,"Criticality")="N/A^N/A^0^NREQ"
"RTN","ENH6914S",54,0)
 .. S ^XTMP(ENHRTN,CNT,STAT,"Frequency")="N/A^N/A^0^NREQ"
"RTN","ENH6914S",55,0)
 .. S ^XTMP(ENHRTN,CNT,STAT,"Level")="N/A^N/A^0^NREQ"
"RTN","ENH6914S",56,0)
 .. S ^XTMP(ENHRTN,CNT,STAT,"Procedure")="N/A^0^0^INV, NREQ"
"RTN","ENH6914S",57,0)
 .. S ^XTMP(ENHRTN,CNT,STAT,"Acq Source")="N/A^0^N/A^INV"
"RTN","ENH6914S",58,0)
 .. S ^XTMP(ENHRTN,CNT,STAT,"SGL")="N/A^0^0^INV, NREQ"
"RTN","ENH6914S",59,0)
 .. S ^XTMP(ENHRTN,CNT,STAT,"BOC")="N/A^0^0^INV, NREQ"
"RTN","ENH6914S",60,0)
 .. S ^XTMP(ENHRTN,CNT,STAT,"Fund")="N/A^0^0^INV, NREQ"
"RTN","ENH6914S",61,0)
 .. S ^XTMP(ENHRTN,CNT,STAT,"Admin Office")="N/A^0^0^INV, NREQ"
"RTN","ENH6914S",62,0)
 .. S ^XTMP(ENHRTN,CNT,STAT,"Station")="N/A^N/A^0^NREQ"
"RTN","ENH6914S",63,0)
 .. S ^XTMP(ENHRTN,CNT,STAT,"Work Performed")="0^N/A^N/A^REQ"
"RTN","ENH6914S",64,0)
 . S ENHDICT=^XTMP(ENHRTN,"STAT",STAT)
"RTN","ENH6914S",65,0)
 . ;
"RTN","ENH6914S",66,0)
 . S (REQTOT(STAT),INVTOT(STAT),NREQTOT(STAT))=0
"RTN","ENH6914S",67,0)
 . ;
"RTN","ENH6914S",68,0)
 . ;Add to total counter of records analyzed
"RTN","ENH6914S",69,0)
 . S STATCNT=$P($G(^XTMP(ENHRTN,ENHDICT,STAT)),U,4)
"RTN","ENH6914S",70,0)
 . S $P(^XTMP(ENHRTN,ENHDICT,STAT),U,4)=(STATCNT+1)
"RTN","ENH6914S",71,0)
 . ;
"RTN","ENH6914S",72,0)
 . ;Begin analysis of each field
"RTN","ENH6914S",73,0)
 . S (REQFLG,NREQFLG,INVFLG)=0
"RTN","ENH6914S",74,0)
 . S ENTNUM=$P($G(^ENG(6914,INT,0)),U)
"RTN","ENH6914S",75,0)
 . I ENTNUM="" D
"RTN","ENH6914S",76,0)
 .. S X=$P($G(^XTMP(ENHRTN,ENHDICT,STAT,"Entry Number")),U)
"RTN","ENH6914S",77,0)
 .. S $P(^XTMP(ENHRTN,ENHDICT,STAT,"Entry Number"),U)=X+1
"RTN","ENH6914S",78,0)
 .. S ^XTMP(ENHRTN,ENHDICT,STAT,"Entry Number","REQ",INT)=""
"RTN","ENH6914S",79,0)
 .. S REQFLG=1,REQTOT(STAT)=$G(REQTOT(STAT))+1
"RTN","ENH6914S",80,0)
 . I USESTAT="" D
"RTN","ENH6914S",81,0)
 .. S X=$P($G(^XTMP(ENHRTN,ENHDICT,STAT,"Use Status")),U,3)
"RTN","ENH6914S",82,0)
 .. S $P(^XTMP(ENHRTN,ENHDICT,STAT,"Use Status"),U,3)=X+1
"RTN","ENH6914S",83,0)
 .. S ^XTMP(ENHRTN,ENHDICT,STAT,"Use Status","NREQ",INT)=""
"RTN","ENH6914S",84,0)
 .. S NREQFLG=1,NREQTOT(STAT)=$G(NREQTOT(STAT))+1
"RTN","ENH6914S",85,0)
 . S MANBY=$P($G(^ENG(6914,INT,1)),U,4)
"RTN","ENH6914S",86,0)
 . I MANBY'="" D
"RTN","ENH6914S",87,0)
 .. I '$D(^ENG("MFG",MANBY,0))!($P($G(^ENG("MFG",MANBY,0)),U)="") D
"RTN","ENH6914S",88,0)
 ... S X=$P($G(^XTMP(ENHRTN,ENHDICT,STAT,"Manufacturer")),U,2)
"RTN","ENH6914S",89,0)
 ... S $P(^XTMP(ENHRTN,ENHDICT,STAT,"Manufacturer"),U,2)=X+1
"RTN","ENH6914S",90,0)
 ... S ^XTMP(ENHRTN,ENHDICT,STAT,"Manufacturer","INV",INT)=""
"RTN","ENH6914S",91,0)
 ... S INVFLG=1,INVTOT(STAT)=$G(INVTOT(STAT))+1
"RTN","ENH6914S",92,0)
 . S PSYS=$P($G(^ENG(6914,INT,0)),U,3)
"RTN","ENH6914S",93,0)
 . I PSYS'="" D
"RTN","ENH6914S",94,0)
 .. I '$D(^ENG(6914,PSYS,0))!($P($G(^ENG(6914,PSYS,0)),U)="") D
"RTN","ENH6914S",95,0)
 ... S X=$P($G(^XTMP(ENHRTN,ENHDICT,STAT,"Parent System")),U,2)
"RTN","ENH6914S",96,0)
 ... S $P(^XTMP(ENHRTN,ENHDICT,STAT,"Parent System"),U,2)=X+1
"RTN","ENH6914S",97,0)
 ... S ^XTMP(ENHRTN,ENHDICT,STAT,"Parent System","INV",INT)=""
"RTN","ENH6914S",98,0)
 ... S INVFLG=1,INVTOT(STAT)=$G(INVTOT(STAT))+1
"RTN","ENH6914S",99,0)
 . S CAT=$P($G(^ENG(6914,INT,1)),U)
"RTN","ENH6914S",100,0)
 . I CAT'="" D
"RTN","ENH6914S",101,0)
 .. I '$D(^ENG(6911,CAT,0))!($P($G(^ENG(6911,CAT,0)),U)="") D
"RTN","ENH6914S",102,0)
 ... S X=$P($G(^XTMP(ENHRTN,ENHDICT,STAT,"Equip Category")),U,2)
"RTN","ENH6914S",103,0)
 ... S $P(^XTMP(ENHRTN,ENHDICT,STAT,"Equip Category"),U,2)=X+1
"RTN","ENH6914S",104,0)
 ... S ^XTMP(ENHRTN,ENHDICT,STAT,"Equip Category","INV",INT)=""
"RTN","ENH6914S",105,0)
 ... S INVFLG=1,INVTOT(STAT)=$G(INVTOT(STAT))+1
"RTN","ENH6914S",106,0)
 . D SUMII^ENH6914R
"RTN","ENH6914S",107,0)
 . D SUMIII^ENH6914T
"RTN","ENH6914S",108,0)
 . ;Set total counters for each station
"RTN","ENH6914S",109,0)
 . I REQFLG'=0 D
"RTN","ENH6914S",110,0)
 .. S X=$P($G(^XTMP(ENHRTN,ENHDICT,STAT)),U)
"RTN","ENH6914S",111,0)
 .. S $P(^XTMP(ENHRTN,ENHDICT,STAT),U)=X+1
"RTN","ENH6914S",112,0)
 . I INVFLG'=0 D
"RTN","ENH6914S",113,0)
 .. S X=$P($G(^XTMP(ENHRTN,ENHDICT,STAT)),U,2)
"RTN","ENH6914S",114,0)
 .. S $P(^XTMP(ENHRTN,ENHDICT,STAT),U,2)=X+1
"RTN","ENH6914S",115,0)
 . I NREQFLG'=0 D
"RTN","ENH6914S",116,0)
 .. S X=$P($G(^XTMP(ENHRTN,ENHDICT,STAT)),U,3)
"RTN","ENH6914S",117,0)
 .. S $P(^XTMP(ENHRTN,ENHDICT,STAT),U,3)=X+1
"RTN","ENH6914S",118,0)
 . S $P(^XTMP(ENHRTN,ENHDICT,STAT,0),U)=$P(^XTMP(ENHRTN,ENHDICT,STAT,0),U)+REQTOT(STAT)
"RTN","ENH6914S",119,0)
 . S $P(^XTMP(ENHRTN,ENHDICT,STAT,0),U,2)=$P(^XTMP(ENHRTN,ENHDICT,STAT,0),U,2)+INVTOT(STAT)
"RTN","ENH6914S",120,0)
 . S $P(^XTMP(ENHRTN,ENHDICT,STAT,0),U,3)=$P(^XTMP(ENHRTN,ENHDICT,STAT,0),U,3)+NREQTOT(STAT)
"RTN","ENH6914S",121,0)
 K REQTOT,NREQTOT,INVTOT
"RTN","ENH6914S",122,0)
 D FLDSRT^ENH6914T
"RTN","ENH6914S",123,0)
 Q
"RTN","ENH6914T")
0^15^B30714521
"RTN","ENH6914T",1,0)
ENH6914T ;WOIFO/TAW/EEN - Equipment Inventory Report Sort Part III (AEMS/- CoreFLS data cleansing ; 09/25/03 9:29
"RTN","ENH6914T",2,0)
 ;;7.0;ENGINEERING;**75**;Aug 17, 1993
"RTN","ENH6914T",3,0)
 ;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","ENH6914T",4,0)
 ;
"RTN","ENH6914T",5,0)
 Q  ;this routine is not callable from the top
"RTN","ENH6914T",6,0)
 ;
"RTN","ENH6914T",7,0)
 ;This routine should not be run directly.  It should only be called
"RTN","ENH6914T",8,0)
 ;from the routine ENH6914S 
"RTN","ENH6914T",9,0)
 ;
"RTN","ENH6914T",10,0)
SUMIII ;This is the third part of the sort for the Summary Report
"RTN","ENH6914T",11,0)
 S SSTAT=$P($G(^ENG(6914,INT,9)),U,5)
"RTN","ENH6914T",12,0)
 I SSTAT="" D
"RTN","ENH6914T",13,0)
 . S X=$P($G(^XTMP(ENHRTN,ENHDICT,STAT,"Station")),U,3)
"RTN","ENH6914T",14,0)
 . S $P(^XTMP(ENHRTN,ENHDICT,STAT,"Station"),U,3)=X+1
"RTN","ENH6914T",15,0)
 . S ^XTMP(ENHRTN,ENHDICT,STAT,"Station","NREQ",INT)=""
"RTN","ENH6914T",16,0)
 . S NREQFLG=1,NREQTOT(STAT)=$G(NREQTOT(STAT))+1
"RTN","ENH6914T",17,0)
 S TOTAV=$P($G(^ENG(6914,INT,2)),U,3)
"RTN","ENH6914T",18,0)
 I TOTAV="" D
"RTN","ENH6914T",19,0)
 . S X=$P($G(^XTMP(ENHRTN,ENHDICT,STAT,"Total Asset Val")),U,3)
"RTN","ENH6914T",20,0)
 . S $P(^XTMP(ENHRTN,ENHDICT,STAT,"Total Asset Val"),U,3)=X+1
"RTN","ENH6914T",21,0)
 . S ^XTMP(ENHRTN,ENHDICT,STAT,"Total Asset Val","NREQ",INT)=""
"RTN","ENH6914T",22,0)
 . S NREQFLG=1,NREQTOT(STAT)=$G(NREQTOT(STAT))+1
"RTN","ENH6914T",23,0)
 S AOFF=$P($G(^ENG(6914,INT,9)),U,8)
"RTN","ENH6914T",24,0)
 I AOFF="" D
"RTN","ENH6914T",25,0)
 . S X=$P($G(^XTMP(ENHRTN,ENHDICT,STAT,"Admin Office")),U,3)
"RTN","ENH6914T",26,0)
 . S $P(^XTMP(ENHRTN,ENHDICT,STAT,"Admin Office"),U,3)=X+1
"RTN","ENH6914T",27,0)
 . S ^XTMP(ENHRTN,ENHDICT,STAT,"Admin Office","NREQ",INT)=""
"RTN","ENH6914T",28,0)
 . S NREQFLG=1,NREQTOT(STAT)=$G(NREQTOT(STAT))+1
"RTN","ENH6914T",29,0)
 I AOFF'="" D
"RTN","ENH6914T",30,0)
 . I '$D(^ENG(6914.7,AOFF,0))!($P($G(^ENG(6914.7,AOFF,0)),U)="") D
"RTN","ENH6914T",31,0)
 .. S X=$P($G(^XTMP(ENHRTN,ENHDICT,STAT,"Admin Office")),U,2)
"RTN","ENH6914T",32,0)
 .. S $P(^XTMP(ENHRTN,ENHDICT,STAT,"Admin Office"),U,2)=X+1
"RTN","ENH6914T",33,0)
 .. S ^XTMP(ENHRTN,ENHDICT,STAT,"Admin Office","INV",INT)=""
"RTN","ENH6914T",34,0)
 .. S INVFLG=1,INVTOT(STAT)=INVTOT(STAT)+1
"RTN","ENH6914T",35,0)
 S VEN=$P($G(^ENG(6914,INT,2)),U)
"RTN","ENH6914T",36,0)
 I VEN'="" D
"RTN","ENH6914T",37,0)
 . I '$D(^PRC(440,VEN,0))!($P($G(^PRC(440,VEN,0)),U)="") D
"RTN","ENH6914T",38,0)
 .. S X=$P($G(^XTMP(ENHRTN,ENHDICT,STAT,"Vendor")),U,2)
"RTN","ENH6914T",39,0)
 .. S $P(^XTMP(ENHRTN,ENHDICT,STAT,"Vendor"),U,2)=X+1
"RTN","ENH6914T",40,0)
 .. S ^XTMP(ENHRTN,ENHDICT,STAT,"Vendor","INV",INT)=""
"RTN","ENH6914T",41,0)
 .. S INVFLG=1,INVTOT(STAT)=$G(INVTOT(STAT))+1
"RTN","ENH6914T",42,0)
 S ASRC=$P($G(^ENG(6914,INT,2)),U,14)
"RTN","ENH6914T",43,0)
 I ASRC'="" D
"RTN","ENH6914T",44,0)
 . I '$D(^PRCD(420.8,ASRC,0))!($P($G(^PRCD(420.8,ASRC,0)),U)="")!($P($G(^PRCD(420.8,ASRC,0)),U,2)="") D
"RTN","ENH6914T",45,0)
 .. S X=$P($G(^XTMP(ENHRTN,ENHDICT,STAT,"Acq Source")),U,2)
"RTN","ENH6914T",46,0)
 .. S $P(^XTMP(ENHRTN,ENHDICT,STAT,"Acq Source"),U,2)=X+1
"RTN","ENH6914T",47,0)
 .. S ^XTMP(ENHRTN,ENHDICT,STAT,"Acq Source","INV",INT)=""
"RTN","ENH6914T",48,0)
 .. S INVFLG=1,INVTOT(STAT)=$G(INVTOT(STAT))+1
"RTN","ENH6914T",49,0)
 S CSTK=$P($G(^ENG(6914,INT,2)),U,8)
"RTN","ENH6914T",50,0)
 I CSTK'="" D
"RTN","ENH6914T",51,0)
 . I '$D(^ENCSN(6917,CSTK,0))!($P($G(^ENCSN(6917,CSTK,0)),U)="") D
"RTN","ENH6914T",52,0)
 .. S X=$P($G(^XTMP(ENHRTN,ENHDICT,STAT,"Cat Stock Number")),U,2)
"RTN","ENH6914T",53,0)
 .. S $P(^XTMP(ENHRTN,ENHDICT,STAT,"Cat Stock Number"),U,2)=X+1
"RTN","ENH6914T",54,0)
 .. S ^XTMP(ENHRTN,ENHDICT,STAT,"Cat Stock Number","INV",INT)=""
"RTN","ENH6914T",55,0)
 .. S INVFLG=1,INVTOT(STAT)=$G(INVTOT(STAT))+1
"RTN","ENH6914T",56,0)
 S CMR=$P($G(^ENG(6914,INT,2)),U,9)
"RTN","ENH6914T",57,0)
 I CMR="" D
"RTN","ENH6914T",58,0)
 . S X=$P($G(^XTMP(ENHRTN,ENHDICT,STAT,"CMR")),U)
"RTN","ENH6914T",59,0)
 . S $P(^XTMP(ENHRTN,ENHDICT,STAT,"CMR"),U)=X+1
"RTN","ENH6914T",60,0)
 . S ^XTMP(ENHRTN,ENHDICT,STAT,"CMR","REQ",INT)=""
"RTN","ENH6914T",61,0)
 . S REQFLG=1,REQTOT(STAT)=$G(REQTOT(STAT))+1
"RTN","ENH6914T",62,0)
 I CMR'="" D
"RTN","ENH6914T",63,0)
 . I '$D(^ENG(6914.1,CMR,0))!($P($G(^ENG(6914.1,CMR,0)),U)="") D
"RTN","ENH6914T",64,0)
 .. S X=$P($G(^XTMP(ENHRTN,ENHDICT,STAT,"CMR")),U,2)
"RTN","ENH6914T",65,0)
 .. S $P(^XTMP(ENHRTN,ENHDICT,STAT,"CMR"),U,2)=X+1 S INVFLG=1
"RTN","ENH6914T",66,0)
 .. S ^XTMP(ENHRTN,ENHDICT,STAT,"CMR","INV",INT)=""
"RTN","ENH6914T",67,0)
 .. S INVTOT(STAT)=$G(INVTOT(STAT))+1
"RTN","ENH6914T",68,0)
 S SPTR=$P($G(^ENG(6914,INT,3)),U,2)
"RTN","ENH6914T",69,0)
 I SPTR'="" D
"RTN","ENH6914T",70,0)
 . I '$D(^DIC(49,SPTR,0))!($P($G(^DIC(49,SPTR,0)),U)="") D
"RTN","ENH6914T",71,0)
 .. S X=$P($G(^XTMP(ENHRTN,ENHDICT,STAT,"Service Ptr")),U,2)
"RTN","ENH6914T",72,0)
 .. S $P(^XTMP(ENHRTN,ENHDICT,STAT,"Service Ptr"),U,2)=X+1
"RTN","ENH6914T",73,0)
 .. S ^XTMP(ENHRTN,ENHDICT,STAT,"Service Ptr","INV",INT)=""
"RTN","ENH6914T",74,0)
 .. S INVFLG=1,INVTOT(STAT)=$G(INVTOT(STAT))+1
"RTN","ENH6914T",75,0)
 S LOC=$P($G(^ENG(6914,INT,3)),U,5)
"RTN","ENH6914T",76,0)
 I LOC="" D
"RTN","ENH6914T",77,0)
 . S X=$P($G(^XTMP(ENHRTN,ENHDICT,STAT,"Location")),U)
"RTN","ENH6914T",78,0)
 . S $P(^XTMP(ENHRTN,ENHDICT,STAT,"Location"),U)=X+1
"RTN","ENH6914T",79,0)
 . S ^XTMP(ENHRTN,ENHDICT,STAT,"Location","REQ",INT)=""
"RTN","ENH6914T",80,0)
 . S REQFLG=1,REQTOT(STAT)=$G(REQTOT(STAT))+1
"RTN","ENH6914T",81,0)
 I LOC'="" D
"RTN","ENH6914T",82,0)
 . I '$D(^ENG("SP",LOC,0))!($P($G(^ENG("SP",LOC,0)),U)="") D
"RTN","ENH6914T",83,0)
 .. S X=$P($G(^XTMP(ENHRTN,ENHDICT,STAT,"Location")),U,2)
"RTN","ENH6914T",84,0)
 .. S $P(^XTMP(ENHRTN,ENHDICT,STAT,"Location"),U,2)=X+1
"RTN","ENH6914T",85,0)
 .. S ^XTMP(ENHRTN,ENHDICT,STAT,"Location","INV",INT)=""
"RTN","ENH6914T",86,0)
 .. S INVFLG=1,INVTOT(STAT)=$G(INVTOT(STAT))+1
"RTN","ENH6914T",87,0)
 I $D(^ENG(6914,INT,6,0)) D
"RTN","ENH6914T",88,0)
 . S MULT=0
"RTN","ENH6914T",89,0)
 . F  S MULT=$O(^ENG(6914,INT,6,MULT)) Q:'MULT  D
"RTN","ENH6914T",90,0)
 .. S WKPERF=$P(^ENG(6914,INT,6,MULT,0),U,9)
"RTN","ENH6914T",91,0)
 .. I WKPERF="" D
"RTN","ENH6914T",92,0)
 ... S X=$P($G(^XTMP(ENHRTN,ENHDICT,STAT,"Work Performed")),U)
"RTN","ENH6914T",93,0)
 ... S $P(^XTMP(ENHRTN,ENHDICT,STAT,"Work Performed"),U)=X+1
"RTN","ENH6914T",94,0)
 ... S ^XTMP(ENHRTN,ENHDICT,STAT,"Work Performed","REQ",INT,MULT)=MULT
"RTN","ENH6914T",95,0)
 ... S REQFLG=1,REQTOT(STAT)=$G(REQTOT(STAT))+1
"RTN","ENH6914T",96,0)
 Q
"RTN","ENH6914T",97,0)
 ;
"RTN","ENH6914T",98,0)
FLDSRT ;Resort by field for detail reports
"RTN","ENH6914T",99,0)
 K ^XTMP("ENH6914R")
"RTN","ENH6914T",100,0)
 I '$D(^XTMP(ENHRTN)) Q
"RTN","ENH6914T",101,0)
 S (STAT,FIELD,MULT,ERR,INT,ENHDICT)=""
"RTN","ENH6914T",102,0)
 F  S ENHDICT=$O(^XTMP(ENHRTN,ENHDICT)) Q:ENHDICT=""  D
"RTN","ENH6914T",103,0)
 . F  S STAT=$O(^XTMP(ENHRTN,ENHDICT,STAT)) Q:STAT=""  D
"RTN","ENH6914T",104,0)
 .. F  S FIELD=$O(^XTMP(ENHRTN,ENHDICT,STAT,FIELD)) Q:FIELD=""  D
"RTN","ENH6914T",105,0)
 ... F  S ERR=$O(^XTMP(ENHRTN,ENHDICT,STAT,FIELD,ERR)) Q:ERR=""  D
"RTN","ENH6914T",106,0)
 .... F  S INT=$O(^XTMP(ENHRTN,ENHDICT,STAT,FIELD,ERR,INT)) Q:INT=""  D
"RTN","ENH6914T",107,0)
 ..... I FIELD="Resp Shop"!(FIELD="Technician")!(FIELD="Criticality")!(FIELD="Starting Month")!(FIELD="Work Performed") D MULT Q
"RTN","ENH6914T",108,0)
 ..... I FIELD="Frequency"!(FIELD="Procedure")!(FIELD="Level") D MULT Q
"RTN","ENH6914T",109,0)
 ..... S ^XTMP("ENH6914R",ENHDICT,STAT,ERR,INT,FIELD)=""
"RTN","ENH6914T",110,0)
 Q
"RTN","ENH6914T",111,0)
 ;
"RTN","ENH6914T",112,0)
MULT ;SET UP MULTIPLES
"RTN","ENH6914T",113,0)
 S MULT=""
"RTN","ENH6914T",114,0)
 F  S MULT=$O(^XTMP(ENHRTN,ENHDICT,STAT,FIELD,ERR,INT,MULT)) Q:MULT=""  D
"RTN","ENH6914T",115,0)
 . I FIELD="Procedure"!(FIELD="Frequency")!(FIELD="Level") D MULT2 Q
"RTN","ENH6914T",116,0)
 . S ^XTMP("ENH6914R",ENHDICT,STAT,ERR,INT,FIELD,MULT)=MULT
"RTN","ENH6914T",117,0)
 Q
"RTN","ENH6914T",118,0)
 ;
"RTN","ENH6914T",119,0)
MULT2 ; SET UP FOR 2 LEVEL DEEP MULTIPLES
"RTN","ENH6914T",120,0)
 S MULT2=""
"RTN","ENH6914T",121,0)
 F  S MULT2=$O(^XTMP(ENHRTN,ENHDICT,STAT,FIELD,ERR,INT,MULT,MULT2)) Q:MULT2=""  D
"RTN","ENH6914T",122,0)
 . S ^XTMP("ENH6914R",ENHDICT,STAT,ERR,INT,FIELD,MULT,MULT2)=MULT_","_MULT2
"RTN","ENH6914T",123,0)
 Q
"VER")
8.0^22
**END**
**END**
