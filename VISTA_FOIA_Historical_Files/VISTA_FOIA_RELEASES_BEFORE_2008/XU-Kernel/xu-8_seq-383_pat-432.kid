Released XU*8*432 SEQ #383
Extracted from mail message
**KIDS**:XU*8.0*432^

**INSTALL NAME**
XU*8.0*432
"BLD",970,0)
XU*8.0*432^KERNEL^0^3070613^y
"BLD",970,1,0)
^^2^2^3061012^^
"BLD",970,1,1,0)
Please refer to the Description in the FORUM Patch Module for details.
"BLD",970,1,2,0)
XU*8*432  "XUP Clean-up."
"BLD",970,4,0)
^9.64PA^^
"BLD",970,6.3)
3
"BLD",970,"INI")
PRE^XU8P432
"BLD",970,"INID")
^n^n
"BLD",970,"INIT")
POST^XU8P432
"BLD",970,"KRN",0)
^9.67PA^8989.52^19
"BLD",970,"KRN",.4,0)
.4
"BLD",970,"KRN",.401,0)
.401
"BLD",970,"KRN",.402,0)
.402
"BLD",970,"KRN",.403,0)
.403
"BLD",970,"KRN",.5,0)
.5
"BLD",970,"KRN",.84,0)
.84
"BLD",970,"KRN",3.6,0)
3.6
"BLD",970,"KRN",3.8,0)
3.8
"BLD",970,"KRN",9.2,0)
9.2
"BLD",970,"KRN",9.8,0)
9.8
"BLD",970,"KRN",9.8,"NM",0)
^9.68A^1^1
"BLD",970,"KRN",9.8,"NM",1,0)
XUP^^0^B10447312
"BLD",970,"KRN",9.8,"NM","B","XUP",1)

"BLD",970,"KRN",19,0)
19
"BLD",970,"KRN",19.1,0)
19.1
"BLD",970,"KRN",101,0)
101
"BLD",970,"KRN",409.61,0)
409.61
"BLD",970,"KRN",771,0)
771
"BLD",970,"KRN",870,0)
870
"BLD",970,"KRN",8989.51,0)
8989.51
"BLD",970,"KRN",8989.52,0)
8989.52
"BLD",970,"KRN",8994,0)
8994
"BLD",970,"KRN","B",.4,.4)

"BLD",970,"KRN","B",.401,.401)

"BLD",970,"KRN","B",.402,.402)

"BLD",970,"KRN","B",.403,.403)

"BLD",970,"KRN","B",.5,.5)

"BLD",970,"KRN","B",.84,.84)

"BLD",970,"KRN","B",3.6,3.6)

"BLD",970,"KRN","B",3.8,3.8)

"BLD",970,"KRN","B",9.2,9.2)

"BLD",970,"KRN","B",9.8,9.8)

"BLD",970,"KRN","B",19,19)

"BLD",970,"KRN","B",19.1,19.1)

"BLD",970,"KRN","B",101,101)

"BLD",970,"KRN","B",409.61,409.61)

"BLD",970,"KRN","B",771,771)

"BLD",970,"KRN","B",870,870)

"BLD",970,"KRN","B",8989.51,8989.51)

"BLD",970,"KRN","B",8989.52,8989.52)

"BLD",970,"KRN","B",8994,8994)

"BLD",970,"QUES",0)
^9.62^^
"BLD",970,"REQB",0)
^9.611^1^1
"BLD",970,"REQB",1,0)
XU*8.0*284^2
"BLD",970,"REQB","B","XU*8.0*284",1)

"INI")
PRE^XU8P432
"INIT")
POST^XU8P432
"MBREQ")
0
"PKG",3,-1)
1^1
"PKG",3,0)
KERNEL^XU^SIGN-ON, SECURITY, MENU DRIVER, DEVICES, TASKMAN^
"PKG",3,20,0)
^9.402P^^0
"PKG",3,22,0)
^9.49I^1^1
"PKG",3,22,1,0)
8.0^3051215^2970507^.5
"PKG",3,22,1,"PAH",1,0)
432^3070613
"PKG",3,22,1,"PAH",1,1,0)
^^2^2^3070613
"PKG",3,22,1,"PAH",1,1,1,0)
Please refer to the Description in the FORUM Patch Module for details.
"PKG",3,22,1,"PAH",1,1,2,0)
XU*8*432  "XUP Clean-up."
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
2
"RTN","XU8P432")
0^^B1599909^n/a
"RTN","XU8P432",1,0)
XU8P432 ;ISF/RWF - Patch XU*8*432 Post-init ;6/13/07  08:44
"RTN","XU8P432",2,0)
 ;;8.0;KERNEL;**432**;Jul 10, 1995;Build 3
"RTN","XU8P432",3,0)
 QUIT
"RTN","XU8P432",4,0)
 ;
"RTN","XU8P432",5,0)
PRE ;Show if site has any
"RTN","XU8P432",6,0)
 N DA,CT
"RTN","XU8P432",7,0)
 S DA=0,CT=0
"RTN","XU8P432",8,0)
 F  S DA=$O(^VA(200,DA)) Q:DA'>0  D:'$D(^VA(200,DA,0))
"RTN","XU8P432",9,0)
 . W !,"^VA(200,",DA,",0) is missing the zero node."
"RTN","XU8P432",10,0)
 . S CT=CT+1
"RTN","XU8P432",11,0)
 . Q
"RTN","XU8P432",12,0)
 I CT>0 W !!,"There are a total of ",CT," entries without zero nodes.",!,"The Post-Init will clean them up."
"RTN","XU8P432",13,0)
 W !,"Done"
"RTN","XU8P432",14,0)
 Q
"RTN","XU8P432",15,0)
POST ;Clean-up any danging nodes in ^VA(200,DA,1.1) or ^VA(200,DA,203.1)
"RTN","XU8P432",16,0)
 N DA
"RTN","XU8P432",17,0)
 S DA=0
"RTN","XU8P432",18,0)
 F  S DA=$O(^VA(200,DA)) Q:DA'>0  D:'$D(^VA(200,DA,0))
"RTN","XU8P432",19,0)
 . I $D(^VA(200,DA,1.1)) K ^VA(200,DA,1.1) W !,"^VA(200,",DA,",1.1) cleaned"
"RTN","XU8P432",20,0)
 . I $D(^VA(200,DA,203.1)) K ^VA(200,DA,203.1) W !,"^VA(200,",DA,",203.1) cleaned"
"RTN","XU8P432",21,0)
 . Q
"RTN","XUP")
0^1^B10447312^B9213358
"RTN","XUP",1,0)
XUP ;SFISC/RWF - Setup enviroment for programmers ;10/12/06  12:45
"RTN","XUP",2,0)
 ;;8.0;KERNEL;**208,258,284,432**;Jul 10, 1995;Build 3
"RTN","XUP",3,0)
 W !,"Setting up programmer environment"
"RTN","XUP",4,0)
 S U="^",$ECODE="",$ETRAP="" ;Clear error and error trap
"RTN","XUP",5,0)
 X ^%ZOSF("TYPE-AHEAD")
"RTN","XUP",6,0)
 ;Check if Production and report
"RTN","XUP",7,0)
 W !,"This is a "_$S($$PROD^XUPROD(1):"PRODUCTION",1:"TEST")_" account.",!
"RTN","XUP",8,0)
 ;
"RTN","XUP",9,0)
 K ^UTILITY($J),^XUTL("XQ",$J) D KILL1^XUSCLEAN
"RTN","XUP",10,0)
 S U="^",DT=$$DT^XLFDT
"RTN","XUP",11,0)
 S XUEOFF=^%ZOSF("EOFF"),XUEON=^%ZOSF("EON"),U="^",XUTT=0,XUIOP=""
"RTN","XUP",12,0)
 D GETENV^%ZOSV S XUENV=Y,XUVOL=$P(Y,U,2),XUCI=$P(Y,U,1)
"RTN","XUP",13,0)
 ;Reset DUZ if user "Switched Identities".
"RTN","XUP",14,0)
 I $D(DUZ("SAV")) S DUZ=+DUZ("SAV"),DUZ(0)=$P(DUZ("SAV"),U,2) K DUZ("SAV")
"RTN","XUP",15,0)
 ;Get user info
"RTN","XUP",16,0)
 I $G(DUZ)>.5,$D(^VA(200,DUZ,0))[0 K DUZ W !,"DUZ Must point to a real user." G EXIT ;p432
"RTN","XUP",17,0)
 I $G(DUZ)>0 D DUZ(DUZ)
"RTN","XUP",18,0)
 I $G(DUZ)'>0!('$D(DUZ(0))) D ASKDUZ G:Y'>0 EXIT
"RTN","XUP",19,0)
 I '$D(XQUSER) S XQUSER=$S($D(^VA(200,DUZ,20)):$P(^(20),"^",2),1:"Unk")
"RTN","XUP",20,0)
 S DTIME=600 ;Set a temp DTIME
"RTN","XUP",21,0)
 S DILOCKTM=+$G(^DD("DILOCKTM"),1) ;p432
"RTN","XUP",22,0)
 ;Getting Terminal Type
"RTN","XUP",23,0)
ZIS I XUTT D ENQ^XUS1 G:$D(XUIOP(1)) ZIS2 S Y=0 D TT^XUS3 I Y>0 S XUIOP(1)=$P(XUIOP,";",2) G ZIS2
"RTN","XUP",24,0)
 S X="`"_+$G(^VA(200,DUZ,1.2)),DIC="^%ZIS(2,",DIC(0)="MQ"_$S(X]"`0":"",1:"AE") D ^DIC G:Y'>0 EXIT
"RTN","XUP",25,0)
 S XUIOP(1)=$P(Y,U,2) I DIC(0)["A",$G(^VA(200,+DUZ,0))]"" S $P(^VA(200,DUZ,1.2),U,1)=+Y
"RTN","XUP",26,0)
ZIS2 S %ZIS="L",IOP="HOME;"_XUIOP(1) D ^%ZIS G EXIT:POP W !,"Terminal Type set to: ",IOST,!
"RTN","XUP",27,0)
 S DTIME=$$DTIME(DUZ,IOS),DUZ("BUF")=1,XUDEV=IOS
"RTN","XUP",28,0)
 ;Save info, Set last sign-on
"RTN","XUP",29,0)
 D SAVE^XUS1 S $P(^VA(200,DUZ,1.1),"^",1)=$$NOW^XLFDT
"RTN","XUP",30,0)
 ;Check Mail
"RTN","XUP",31,0)
 S Y=$P($G(^XMB(3.7,DUZ,0)),U,6) I Y W !,"You have "_Y_" new message"_$S(Y=1:"",1:"s")_"."
"RTN","XUP",32,0)
 ;Setup error trap
"RTN","XUP",33,0)
 I $$GET^XPAR("USR^SYS","XUS-XUP SET ERROR TRAP",1,"Q") S $ETRAP="D ERR^XUP"
"RTN","XUP",34,0)
 D KILL1^XUSCLEAN S $P(XQXFLG,U,3)="XUP" D ^XQ1
"RTN","XUP",35,0)
EXIT ;Clean-up and exit
"RTN","XUP",36,0)
 D KILL1^XUSCLEAN K XQY,XQY0
"RTN","XUP",37,0)
 I $G(DUZ)>0,$$GET^XPAR("USR^SYS","XUS-XUP VPE",1,"Q"),$D(^%ZVEMS) X ^%ZVEMS ;Run VPE
"RTN","XUP",38,0)
 Q
"RTN","XUP",39,0)
 ;
"RTN","XUP",40,0)
ASKDUZ ;Ask for Access Code
"RTN","XUP",41,0)
 N X
"RTN","XUP",42,0)
 ;X XUEOFF S DIR(0)="FO",DIR("A")="Access Code" D ^DIR W ! X XUEON I $D(DIRUT) S Y=-1 Q
"RTN","XUP",43,0)
 X XUEOFF W !,"Access Code: " S X=$$ACCEPT^XUS() X XUEON
"RTN","XUP",44,0)
 I X["^"!('$L(X)) S Y=-1 Q
"RTN","XUP",45,0)
 S X=$$UP^XLFSTR(X) S:X[":" XUTT=1,X=$P(X,":",1)_$P(X,":",2)
"RTN","XUP",46,0)
 D ^XUSHSH S Y=$O(^VA(200,"A",X,0))
"RTN","XUP",47,0)
 K DUZ D DUZ(+Y)
"RTN","XUP",48,0)
 Q
"RTN","XUP",49,0)
 ;
"RTN","XUP",50,0)
DUZ(DA) ;Build DUZ for a user.  Used by Mailman.
"RTN","XUP",51,0)
 ;(p284) Make the setting of several DUZ parts conditional.
"RTN","XUP",52,0)
 N Y
"RTN","XUP",53,0)
 S Y(0)=$G(^VA(200,+DA,0)),Y("XUS")=$G(^XTV(8989.3,1,"XUS"))
"RTN","XUP",54,0)
 S DUZ=DA
"RTN","XUP",55,0)
 S:$G(DUZ(0))'="@" DUZ(0)=$P(Y(0),"^",4)
"RTN","XUP",56,0)
 S DUZ(1)="",DUZ("AG")=$P($G(^XTV(8989.3,1,0)),"^",8)
"RTN","XUP",57,0)
 S:'$G(DUZ(2)) DUZ(2)=$O(^VA(200,DUZ,2,0))
"RTN","XUP",58,0)
 S:'DUZ(2) DUZ(2)=+$P(Y("XUS"),"^",17)
"RTN","XUP",59,0)
 S:'$L($G(DUZ("LANG"))) DUZ("LANG")=$P(Y("XUS"),"^",7)
"RTN","XUP",60,0)
 Q
"RTN","XUP",61,0)
 ;
"RTN","XUP",62,0)
DTIME(E,D) ;Return DTIME value for user E, device D.
"RTN","XUP",63,0)
 N P
"RTN","XUP",64,0)
 S P=$P($G(^VA(200,+$G(E),200)),"^",10) S:P="" P=$P($G(^%ZIS(1,+$G(D),"XUS")),"^",10) S:P="" P=$P($G(^XTV(8989.3,1,"XUS")),"^",10)
"RTN","XUP",65,0)
 Q $S(P]"":P,1:300)
"RTN","XUP",66,0)
 ;
"RTN","XUP",67,0)
ERR ;
"RTN","XUP",68,0)
 N %XUP U $P
"RTN","XUP",69,0)
 W !,"$ECODE=",$ECODE,"   $STACK=",$STACK
"RTN","XUP",70,0)
 W !,"Location: ",$STACK($STACK-1,"PLACE")
"RTN","XUP",71,0)
 R !!,"Want to record the error: No// ",%XUP:600 I "Yy"[$E(%XUP_"N") D ^%ZTER
"RTN","XUP",72,0)
 D UNWIND^%ZTER ;S:'$ESTACK $ECODE="" S $ETRAP="" Q:$QUIT "" Q
"VER")
8.0^22.0
"BLD",970,6)
^383
**END**
**END**
