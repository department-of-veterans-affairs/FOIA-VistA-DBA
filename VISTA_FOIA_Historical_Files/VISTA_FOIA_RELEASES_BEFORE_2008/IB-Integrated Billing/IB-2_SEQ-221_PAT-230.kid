Released IB*2*230 SEQ #221
Extracted from mail message
**KIDS**:IB*2.0*230^

**INSTALL NAME**
IB*2.0*230
"BLD",4894,0)
IB*2.0*230^INTEGRATED BILLING^0^3031014^y
"BLD",4894,1,0)
^^4^4^3030711^
"BLD",4894,1,1,0)
This patch changes the value in the print preview screen, BILL TOTAL 
"BLD",4894,1,2,0)
field and the TOTAL CHARGE field in the printed form. The value is 
"BLD",4894,1,3,0)
changed from the amount due to the total charges not including any 
"BLD",4894,1,4,0)
offset.   
"BLD",4894,4,0)
^9.64PA^^
"BLD",4894,"KRN",0)
^9.67PA^8989.52^19
"BLD",4894,"KRN",.4,0)
.4
"BLD",4894,"KRN",.401,0)
.401
"BLD",4894,"KRN",.402,0)
.402
"BLD",4894,"KRN",.403,0)
.403
"BLD",4894,"KRN",.5,0)
.5
"BLD",4894,"KRN",.84,0)
.84
"BLD",4894,"KRN",3.6,0)
3.6
"BLD",4894,"KRN",3.8,0)
3.8
"BLD",4894,"KRN",9.2,0)
9.2
"BLD",4894,"KRN",9.8,0)
9.8
"BLD",4894,"KRN",9.8,"NM",0)
^9.68A^2^2
"BLD",4894,"KRN",9.8,"NM",1,0)
IBCSC61^^0^B7687396
"BLD",4894,"KRN",9.8,"NM",2,0)
IBCF33^^0^B32407192
"BLD",4894,"KRN",9.8,"NM","B","IBCF33",2)

"BLD",4894,"KRN",9.8,"NM","B","IBCSC61",1)

"BLD",4894,"KRN",19,0)
19
"BLD",4894,"KRN",19.1,0)
19.1
"BLD",4894,"KRN",101,0)
101
"BLD",4894,"KRN",409.61,0)
409.61
"BLD",4894,"KRN",771,0)
771
"BLD",4894,"KRN",870,0)
870
"BLD",4894,"KRN",8989.51,0)
8989.51
"BLD",4894,"KRN",8989.52,0)
8989.52
"BLD",4894,"KRN",8994,0)
8994
"BLD",4894,"KRN","B",.4,.4)

"BLD",4894,"KRN","B",.401,.401)

"BLD",4894,"KRN","B",.402,.402)

"BLD",4894,"KRN","B",.403,.403)

"BLD",4894,"KRN","B",.5,.5)

"BLD",4894,"KRN","B",.84,.84)

"BLD",4894,"KRN","B",3.6,3.6)

"BLD",4894,"KRN","B",3.8,3.8)

"BLD",4894,"KRN","B",9.2,9.2)

"BLD",4894,"KRN","B",9.8,9.8)

"BLD",4894,"KRN","B",19,19)

"BLD",4894,"KRN","B",19.1,19.1)

"BLD",4894,"KRN","B",101,101)

"BLD",4894,"KRN","B",409.61,409.61)

"BLD",4894,"KRN","B",771,771)

"BLD",4894,"KRN","B",870,870)

"BLD",4894,"KRN","B",8989.51,8989.51)

"BLD",4894,"KRN","B",8989.52,8989.52)

"BLD",4894,"KRN","B",8994,8994)

"BLD",4894,"QUES",0)
^9.62^^
"BLD",4894,"REQB",0)
^9.611^2^2
"BLD",4894,"REQB",1,0)
IB*2.0*51^2
"BLD",4894,"REQB",2,0)
IB*2.0*210^2
"BLD",4894,"REQB","B","IB*2.0*210",2)

"BLD",4894,"REQB","B","IB*2.0*51",1)

"MBREQ")
0
"PKG",200,-1)
1^1
"PKG",200,0)
INTEGRATED BILLING^IB^INTEGRATED BILLING
"PKG",200,20,0)
^9.402P^1^1
"PKG",200,20,1,0)
2^^IBAXDR
"PKG",200,20,1,1)

"PKG",200,20,"B",2,1)

"PKG",200,22,0)
^9.49I^1^1
"PKG",200,22,1,0)
2.0^2940321^2990406^2447
"PKG",200,22,1,"PAH",1,0)
230^3031014
"PKG",200,22,1,"PAH",1,1,0)
^^4^4^3031014
"PKG",200,22,1,"PAH",1,1,1,0)
This patch changes the value in the print preview screen, BILL TOTAL 
"PKG",200,22,1,"PAH",1,1,2,0)
field and the TOTAL CHARGE field in the printed form. The value is 
"PKG",200,22,1,"PAH",1,1,3,0)
changed from the amount due to the total charges not including any 
"PKG",200,22,1,"PAH",1,1,4,0)
offset.   
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
2
"RTN","IBCF33")
0^2^B32407192
"RTN","IBCF33",1,0)
IBCF33 ;ALB/ARH - UB92 HCFA-1450 (GATHER CODES) ;25-AUG-1993
"RTN","IBCF33",2,0)
 ;;2.0;INTEGRATED BILLING;**52,80,109,51,230**;21-MAR-94
"RTN","IBCF33",3,0)
 ;;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","IBCF33",4,0)
 ;
"RTN","IBCF33",5,0)
 ;IBIFN required
"RTN","IBCF33",6,0)
 ;
"RTN","IBCF33",7,0)
 ; Not all free text prints in these blocks as of MRA/EDI - only print
"RTN","IBCF33",8,0)
 ;   REVENUE CODES and associated data, Rx's and prosthetics
"RTN","IBCF33",9,0)
 ;   and last line to indicate multiple pages
"RTN","IBCF33",10,0)
 N IBI,IBJ,IBCBCOMM,IBCU2,IBCOL,IBSTATE,IBCBILL,IBINPAT,IBX,IBY,Z,IBZ,IBLCT,IBLPG
"RTN","IBCF33",11,0)
 S IBLINES=23,IBCBCOMM=$G(^DGCR(399,IBIFN,"U1")),IBCU2=$G(^DGCR(399,IBIFN,"U2")),IBCOL=1,IBNOCOM=0
"RTN","IBCF33",12,0)
 K IBXSAVE("RX-UB92"),IBXSAVE("PROS-UB92")
"RTN","IBCF33",13,0)
 D HOS^IBCEF22(IBIFN)
"RTN","IBCF33",14,0)
 ;
"RTN","IBCF33",15,0)
 I $$TXMT^IBCEF4(IBIFN) S IBNOCOM=1
"RTN","IBCF33",16,0)
 S Z="",IBNOCHG=0
"RTN","IBCF33",17,0)
 ; Add total line as last entry, if not already there
"RTN","IBCF33",18,0)
 S IBLCT=$O(IBXDATA(""),-1)
"RTN","IBCF33",19,0)
 I IBLCT,$P(IBXDATA(IBLCT),U)'="001" S IBXDATA(IBLCT+1)="001"
"RTN","IBCF33",20,0)
 S IBLCT=0
"RTN","IBCF33",21,0)
 S IBLPG=($O(IBXDATA(""),-1)+$O(IBXSAVE("RX-UB92",""),-1)+$O(IBXSAVE("PROS-UB92",""),-1))/23,IBLPG=IBLPG\1+$S($P(IBLPG,".",2):1,1:0)
"RTN","IBCF33",22,0)
 F  S Z=$O(IBXDATA(Z)) Q:'Z  D
"RTN","IBCF33",23,0)
 . N IBZ1
"RTN","IBCF33",24,0)
 . I $P(IBXDATA(Z),U)="001",'$O(IBXDATA(Z)) S IBZ="001",$P(IBZ,U,4)=$P(IBCBCOMM,U,1),IBDA=0 S:IBNOCHG $P(IBZ,U,9)=$G(IBNOCHG) S IBXDATA(Z)=IBZ D SET1 Q
"RTN","IBCF33",25,0)
 . ;Get modifiers
"RTN","IBCF33",26,0)
 . S IBZ1=$G(^DGCR(399,IBIFN,"RC",+$P(IBXDATA(Z),U,8),0)),IBMOD=""
"RTN","IBCF33",27,0)
 . I $P(IBZ1,U,6),$S($P(IBZ1,U,10)=4:$P(IBZ1,U,11),1:'$P(IBZ1,U,10)) S $P(IBXDATA(Z),U,9)=$$MOD(IBZ1,IBIFN)
"RTN","IBCF33",28,0)
 . S IBZ=$P(IBXDATA(Z),U)_U_$P(IBXDATA(Z),U,3,5)_"^^"_$P(IBXDATA(Z),U,2),$P(IBZ,U,9)=$P(IBXDATA(Z),U,6),$P(IBZ,U,13)=$P(IBXDATA(Z),U,7),$P(IBZ,U,10)=$P(IBXDATA(Z),U,9),$P(IBZ,U,14)=$P(IBXDATA(Z),U,10)
"RTN","IBCF33",29,0)
 . I IBZ S IBNOCHG=IBNOCHG+$P(IBXDATA(Z),U,6),IBDA=$P(IBXDATA(Z),U,8) D SET1
"RTN","IBCF33",30,0)
 . S IBLCT=IBLCT+1
"RTN","IBCF33",31,0)
 I $D(IBXSAVE("RX-UB92"))!$D(IBXSAVE("PROS-UB92")) D
"RTN","IBCF33",32,0)
 . N Z
"RTN","IBCF33",33,0)
 . S Z=0 F  S Z=$O(IBXSAVE("RX-UB92",Z)) Q:'Z  S IBZ=IBXSAVE("RX-UB92",Z) D SET2
"RTN","IBCF33",34,0)
 . S Z=0 F  S Z=$O(IBXSAVE("PROS-UB92",Z)) Q:'Z  S IBZ=IBXSAVE("PROS-UB92",Z) D SET2
"RTN","IBCF33",35,0)
 D END
"RTN","IBCF33",36,0)
 Q
"RTN","IBCF33",37,0)
 ;
"RTN","IBCF33",38,0)
RV ;rev codes sorted by bedsection - no longer used as of patch IB*2*51
"RTN","IBCF33",39,0)
 S (IBBSN,IBBS,IBNOCHG)=0 F  S IBBS=$O(^DGCR(399,IBIFN,"RC","ABS",IBBS)) Q:'IBBS  D
"RTN","IBCF33",40,0)
 . S IBRV=0 F  S IBRV=$O(^DGCR(399,IBIFN,"RC","ABS",IBBS,IBRV)) Q:'IBRV  D
"RTN","IBCF33",41,0)
 .. S IBDA=0 F  S IBDA=$O(^DGCR(399,IBIFN,"RC","ABS",IBBS,IBRV,IBDA)) Q:'IBDA  D
"RTN","IBCF33",42,0)
 ... S IBX=$G(^DGCR(399,IBIFN,"RC",IBDA,0))
"RTN","IBCF33",43,0)
 ... S IBZ=$P($G(^DGCR(399.1,+$P(IBX,U,5),0)),U,1) S IBBSN=IBZ,IBZ=IBX,IBNOCHG=IBNOCHG+$P(IBZ,U,9) D SET1
"RTN","IBCF33",44,0)
 ;
"RTN","IBCF33",45,0)
 ;loop through all rev codes, print those with no bedsection
"RTN","IBCF33",46,0)
 S IBDA=0 F  S IBDA=$O(^DGCR(399,IBIFN,"RC",IBDA)) Q:'IBDA  S IBZ=$G(^(IBDA,0)) I +IBZ,$P(IBZ,U,5)="" S IBNOCHG=IBNOCHG+$P(IBZ,U,9) D SET1
"RTN","IBCF33",47,0)
 ;
"RTN","IBCF33",48,0)
TOTAL ;add total
"RTN","IBCF33",49,0)
 ;I +$P(IBCBCOMM,U,2) S IBZ="",$P(IBZ,U,2)="SUBTOTAL",$P(IBZ,U,4)=+$P(IBCBCOMM,U,1) D SET1
"RTN","IBCF33",50,0)
 ;
"RTN","IBCF33",51,0)
 ;S IBX=$S(+$P(IBCBCOMM,U,2):4,1:2) D SPACE
"RTN","IBCF33",52,0)
 S IBX=2 D SPACE
"RTN","IBCF33",53,0)
 ;S IBZ="" D SET2
"RTN","IBCF33",54,0)
 ;S IBJ=0 F IBI=4,5,6 S IBJ=IBJ+$P(IBCU2,U,IBI)
"RTN","IBCF33",55,0)
 ;I +$P(IBCBCOMM,U,2),+$P(IBCBCOMM,U,2)'=IBJ S (IBI,IBZ)="",$P(IBZ,U,2)="LESS "_$P(IBCBCOMM,U,3),$P(IBZ,U,4)=+$P(IBCBCOMM,U,2) D SET1 S IBZ="" D SET2
"RTN","IBCF33",56,0)
 ;
"RTN","IBCF33",57,0)
 ;S IBZ="001",$P(IBZ,U,2)="TOTAL",$P(IBZ,U,4)=IBCBCOMM-$S(IBI="":$P(IBCBCOMM,U,2),1:0) S:IBNOCHG $P(IBZ,U,9)=$G(IBNOCHG) D SET1
"RTN","IBCF33",58,0)
 ;
"RTN","IBCF33",59,0)
 ;
"RTN","IBCF33",60,0)
CPT ;add additional procedures
"RTN","IBCF33",61,0)
 ;G:$G(IBFL(80))'>6 OPV S IBX=+IBFL(80)-4 D SPACE
"RTN","IBCF33",62,0)
 ;S IBZ="" D SET2
"RTN","IBCF33",63,0)
 ;S IBZ="ADDITIONAL PROCEDURE CODES:" D SET2
"RTN","IBCF33",64,0)
 ;S IBI=6 F  S IBI=$O(IBFL(80,IBI)) Q:'IBI  D
"RTN","IBCF33",65,0)
 ;. S IBX=$P(IBFL(80,IBI),U,2),IBZ=$E(IBX,1,2)_"/"_$E(IBX,3,4)_"/"_$E(IBX,5,6)_$J(" ",5)_$P(IBFL(80,IBI),U,1) D SET2
"RTN","IBCF33",66,0)
 ;
"RTN","IBCF33",67,0)
OPV ;add outpatient visit dates
"RTN","IBCF33",68,0)
 ;G:'$O(^DGCR(399,IBIFN,"OP",0)) CONT S (IBX,IBY)=0 F  S IBX=$O(^DGCR(399,IBIFN,"OP",IBX)) Q:'IBX  S IBY=IBY+1
"RTN","IBCF33",69,0)
 ;S IBX=IBY/3,IBX=IBX\1+$S(+$P(IBX,".",2):1,1:0)+1 D SPACE
"RTN","IBCF33",70,0)
 ;S IBZ="" D SET2 S IBZ="OP VISIT DATE(S) BILLED:"_$J(" ",34-24)
"RTN","IBCF33",71,0)
 ;S (IBI,IBJ)=0 F  S IBI=$O(^DGCR(399,IBIFN,"OP",IBI)) Q:'IBI  D
"RTN","IBCF33",72,0)
 ;. S Y=$G(^DGCR(399,IBIFN,"OP",IBI,0)),IBZ=IBZ_$$FMTE^XLFDT(Y,2)_$S($O(^DGCR(399,IBIFN,"OP",IBI)):", ",1:"")
"RTN","IBCF33",73,0)
 ;. S IBJ=IBJ+1 I IBJ>2 D SET2 S IBZ=$J(" ",34),IBJ=0
"RTN","IBCF33",74,0)
 ;I $L(IBZ)>34 D SET2
"RTN","IBCF33",75,0)
 ;
"RTN","IBCF33",76,0)
CONT ;D ^IBCF331 ;More free text - can no longer print on UB-92
"RTN","IBCF33",77,0)
 ;
"RTN","IBCF33",78,0)
 ; fill in rest of page
"RTN","IBCF33",79,0)
END D:'$G(IBNOCOM) FILLPG S $P(^TMP($J,"IBC-RC"),U,2)=0 S IBPG=+$G(^TMP($J,"IBC-RC")),IBX=IBPG/23,IBPG=IBX\1+$S(+$P(IBX,".",2):1,1:0)
"RTN","IBCF33",80,0)
 K IBZ,IBBSN,IBBS,IBRV,IBDA,IBLN,IBCOL,IBLINES,IBARRAY,IBNOCHG,IBNOCOM,IBXSAVE("RX-UB92"),IBXSAVE("PROS-UB92")
"RTN","IBCF33",81,0)
 Q
"RTN","IBCF33",82,0)
 ;
"RTN","IBCF33",83,0)
SPACE ;checks to see if IBX can fit on page, if not starts new page
"RTN","IBCF33",84,0)
 Q:'IBX  N IBLN,IBY S IBLN=+$G(^TMP($J,"IBC-RC")),IBY=IBLN#23 S:IBY=0&(IBLN'=0) IBY=23 I IBX>(IBLINES-IBY) D FILLPG
"RTN","IBCF33",85,0)
 Q
"RTN","IBCF33",86,0)
 ;
"RTN","IBCF33",87,0)
FILLPG ;fill rest of page with blank lines
"RTN","IBCF33",88,0)
 N IBI,IBLN,IBZ S IBFILL=1 F IBI=1:1:23 S IBLN=+$G(^TMP($J,"IBC-RC")) Q:'(IBLN#23)  S IBZ="" D FILLUP Q:IBFILL=2
"RTN","IBCF33",89,0)
 K IBFILL Q
"RTN","IBCF33",90,0)
 ;
"RTN","IBCF33",91,0)
SET1 ; add rev codes to array: rev cd ^ rev cd st abbrev. ^ CPT CODE ^ unit charge ^ units ^ total ^ non-cov charge ^ form locator 49 ^ rev code mult ien ^ cpt modifiers attached to revenue code/procedure (unlinked)^ outpt serv date
"RTN","IBCF33",92,0)
 ;formats for output into specific column blocks 42-48
"RTN","IBCF33",93,0)
 N IBX,IBY,IBLN,IBN,IBMOD
"RTN","IBCF33",94,0)
 D NEXTLN S IBY=""
"RTN","IBCF33",95,0)
 ;set up rev cd item with appropriate output values, non-rev cd entries for old bills should already be in external form
"RTN","IBCF33",96,0)
 S IBN=$P(IBZ,U,9) ;non-covered charges
"RTN","IBCF33",97,0)
 S IBMOD=$P(IBZ,U,10) I IBMOD'="" S IBMOD=$E($TR(IBMOD,",;"),1,4) ; cpt modifiers
"RTN","IBCF33",98,0)
 I +IBZ S IBX=$G(^DGCR(399.2,+IBZ,0)) Q:IBX=""  D
"RTN","IBCF33",99,0)
 . S IBY=$P(IBX,U,1)_U_$P(IBX,U,2)_U_$$PRCD^IBCEF1($P(IBZ,U,6)_";ICPT(")_IBMOD
"RTN","IBCF33",100,0)
 . S IBY=IBY_U_$P(IBZ,U,2)_U_$P(IBZ,U,3)_U_$P(IBZ,U,4)_U_IBN_U_$P(IBZ,U,13)_U_$G(IBDA)_U_U_$$DATE^IBCF2($P(IBZ,U,14),,1)
"RTN","IBCF33",101,0)
 I IBY="" S IBY=$P(IBZ,U,1)_U_$P(IBZ,U,2)_U_U_U_$P(IBZ,U,3)_U_$P(IBZ,U,4)_U_IBN_U_$P(IBZ,U,13)_U_$G(IBDA)_U_U_$$DATE^IBCF2($P(IBZ,U,14),,1)
"RTN","IBCF33",102,0)
 S IBLN=+$G(^TMP($J,"IBC-RC"))+1,^TMP($J,"IBC-RC",IBLN)=1_U_IBY,^TMP($J,"IBC-RC")=IBLN I '(IBLN#23) S IBLINES=23
"RTN","IBCF33",103,0)
 Q
"RTN","IBCF33",104,0)
 ;
"RTN","IBCF33",105,0)
SET2 ;set free text into block 42 array
"RTN","IBCF33",106,0)
 Q:$G(IBNOCOM)  ;No comments wanted
"RTN","IBCF33",107,0)
 N IBLN D NEXTLN S IBCOL=$S('IBCOL:2,1:3)
"RTN","IBCF33",108,0)
 S IBLN=+$G(^TMP($J,"IBC-RC"))+1 I IBLN#23=1,$G(IBFILL) S IBFILL=2 Q
"RTN","IBCF33",109,0)
 S ^TMP($J,"IBC-RC",IBLN)=IBCOL_U_IBZ,^TMP($J,"IBC-RC")=IBLN I '(IBLN#23) S IBLINES=23
"RTN","IBCF33",110,0)
 Q
"RTN","IBCF33",111,0)
 ;
"RTN","IBCF33",112,0)
FILLUP ; Fill block 42 with blank lines
"RTN","IBCF33",113,0)
 N IBLN D NEXTLN S IBCOL=$S('IBCOL:2,1:3)
"RTN","IBCF33",114,0)
 S IBLN=+$G(^TMP($J,"IBC-RC"))+1 I IBLN#23=1,$G(IBFILL) S IBFILL=2 Q
"RTN","IBCF33",115,0)
 S ^TMP($J,"IBC-RC",IBLN)=IBCOL_U_IBZ,^TMP($J,"IBC-RC")=IBLN I '(IBLN#23) S IBLINES=23
"RTN","IBCF33",116,0)
 Q
"RTN","IBCF33",117,0)
 ;
"RTN","IBCF33",118,0)
NEXTLN ;checks counter for next line, resets if necessary,
"RTN","IBCF33",119,0)
 ;ie. if the line # indicated by the next line # var. has already been used then this increments the next line # var.
"RTN","IBCF33",120,0)
 S IBLN=+$G(^TMP($J,"IBC-RC"))+1 I $D(^TMP($J,"IBC-RC",IBLN)) S ^TMP($J,"IBC-RC")=IBLN S:'(IBLN#23) IBLINES=23 G NEXTLN
"RTN","IBCF33",121,0)
 Q
"RTN","IBCF33",122,0)
 ;
"RTN","IBCF33",123,0)
MOD(RCLN,IBIFN) ; return modifier(s) for a directly linked CPT charge or for an indirectly linked one
"RTN","IBCF33",124,0)
 N IBCPTN,IBMOD
"RTN","IBCF33",125,0)
 S IBMOD=""
"RTN","IBCF33",126,0)
 I $P($G(RCLN),U,10)=4 S IBCPTN=+$P(RCLN,U,11) I +IBCPTN S IBMOD=$$GETMOD^IBEFUNC(IBIFN,IBCPTN,1) ;Linked
"RTN","IBCF33",127,0)
 I IBMOD="",$P(RCLN,U,14)'="" S IBMOD=$TR($P(RCLN,U,14),";",",") ; Not linked or linked, but manually entered modifiers only
"RTN","IBCF33",128,0)
MODQ Q IBMOD
"RTN","IBCF33",129,0)
 ;
"RTN","IBCF33",130,0)
DATE45(IBIFN,IBXDATA,IBDATE) ; What prints in the service date box of UB92
"RTN","IBCF33",131,0)
 ; INPUT:
"RTN","IBCF33",132,0)
 ;   IBIFN = ien of bill
"RTN","IBCF33",133,0)
 ;   IBDATE = the default outpt service date
"RTN","IBCF33",134,0)
 ; OUTPUT:
"RTN","IBCF33",135,0)
 ;   IBXDATA = the output formatter array with the service dates
"RTN","IBCF33",136,0)
 ;             (pass by reference)
"RTN","IBCF33",137,0)
 N Z,Z0,IBR,IBIN
"RTN","IBCF33",138,0)
 S IBIN=$$INPAT^IBCEF(IBXIEN,1)
"RTN","IBCF33",139,0)
 F Z=1:1 Q:'$D(^TMP($J,"IBC-RC",Z))  S IBR=^(Z) D
"RTN","IBCF33",140,0)
 . S Z0=$S(+IBR=1&'IBIN&(+$P(IBR,U,2)'=1):$S($P(IBR,U,12):$P(IBR,U,12),1:$G(IBDATE)),+IBR=2:$E($P(IBR,U,2),41,47),1:$E($P(IBR,U,2),36,42))
"RTN","IBCF33",141,0)
 . S:Z'>21 IBXDATA(Z)=Z0 D:Z'<21 CKREV^IBCEF3(Z,Z0)
"RTN","IBCF33",142,0)
 Q
"RTN","IBCF33",143,0)
 ;
"RTN","IBCSC61")
0^1^B7687396
"RTN","IBCSC61",1,0)
IBCSC61 ;ALB/MJB - MCCR SCREEN UTILITY ;20 JUN 88 10:58
"RTN","IBCSC61",2,0)
 ;;2.0;INTEGRATED BILLING;**52,80,106,51,210,230**;21-MAR-94
"RTN","IBCSC61",3,0)
 ;;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","IBCSC61",4,0)
 ;
"RTN","IBCSC61",5,0)
 ;MAP TO IBCSC61
"RTN","IBCSC61",6,0)
 ;
"RTN","IBCSC61",7,0)
REV I I>1 W !?4,"Rev. Code",?16,": "
"RTN","IBCSC61",8,0)
 N IBNAME S IBNAME=$E($$NAME($P(IBREVC(I),U,10),$P(IBREVC(I),U,11)),1,17)
"RTN","IBCSC61",9,0)
 S DGRCD=$S($D(^DGCR(399.2,+IBREVC(I),0)):^(0),1:""),DGRCD=$P(DGRCD,"^",1)_"-"_$S(IBNAME'="":IBNAME,1:$E($P(DGRCD,"^",2),1,17))
"RTN","IBCSC61",10,0)
 I $P(IBREVC(I),"^",6) S DGRCD=DGRCD_$J("",21-$L(DGRCD))_"  "_$P($$CPT^ICPTCOD(+$P(IBREVC(I),"^",6)),U,2)
"RTN","IBCSC61",11,0)
 I '$P(IBREVC(I),U,6),$P(IBREVC,U,11) S DGRCD=DGRCD_$J("",21-$L(DGRCD))_" *"_$P($$CPT^ICPTCOD(+$P(IBREVC(I),"^",11)),U,2)
"RTN","IBCSC61",12,0)
 S DGRCD=DGRCD_$J("",28-$L(DGRCD))
"RTN","IBCSC61",13,0)
 I (+$P(IBREVC(I),"^",3)>1)!($P(IBREVC(I),U,10)'=4) S DGRCD=DGRCD_$J($P(IBREVC(I),"^",3),3)
"RTN","IBCSC61",14,0)
 S X=$S($P(IBREVC(I),"^",4)]"":$P(IBREVC(I),"^",4),1:IBU) I X'=IBU S X2="2$" D COMMA^%DTC
"RTN","IBCSC61",15,0)
 W DGRCD,$J("",32-$L(DGRCD)),X
"RTN","IBCSC61",16,0)
 I $P(IBREVC(I),"^",5)]"",$D(^DGCR(399.1,$P(IBREVC(I),"^",5),0)) W ?60," ",$E($P(^DGCR(399.1,$P(IBREVC(I),"^",5),0),"^"),1,16)
"RTN","IBCSC61",17,0)
 I IBREVC<10,$P(IBREVC(I),U,9)'="",$$FT^IBCEF(IBIFN)=3 S X=$P(IBREVC(I),U,9),X2="2$" D COMMA^%DTC W !,?50,X S IBREVC=IBREVC+1 W ?64,"(Non-Covered)"
"RTN","IBCSC61",18,0)
 Q
"RTN","IBCSC61",19,0)
 ;
"RTN","IBCSC61",20,0)
CHARGE S (IBCH,IBUCH)=0 F I=1:1 Q:'$D(IBREVC(I))  S IBCH=IBCH+($P(IBREVC(I),U,4)),IBUCH=IBUCH+$P(IBREVC(I),U,9)
"RTN","IBCSC61",21,0)
 I IB("U1")]"" S X=$P(IB("U1"),"^",1),X1=$P(IB("U1"),"^",2),IBCH=X
"RTN","IBCSC61",22,0)
 Q
"RTN","IBCSC61",23,0)
 ;
"RTN","IBCSC61",24,0)
OFFSET S IBOFFC="" W !?4,"OFFSET",?16,": " S X=$S(IB("U1")']"":0,1:+$P(IB("U1"),U,2)),X2="2$" S:X IBOFFC=$P(IB("U1"),U,3) D COMMA^%DTC
"RTN","IBCSC61",25,0)
 W X,"  [",$S($L(IBOFFC):IBOFFC,'$P(X,"$",2):"NO OFFSET RECORDED",1:"OFFSET DESCRIPTION UNSPECIFIED"),"]"
"RTN","IBCSC61",26,0)
 D CHARGE W !?4,"BILL TOTAL",?16,": " S X=$S('$D(IBCH):0,1:+IBCH),X2="2$" D COMMA^%DTC W X
"RTN","IBCSC61",27,0)
 K IBOFFC
"RTN","IBCSC61",28,0)
 Q
"RTN","IBCSC61",29,0)
 ;
"RTN","IBCSC61",30,0)
NAME(TYPE,ITEM) ; if rx or pros or DRG or unassociated return name of the item
"RTN","IBCSC61",31,0)
 N IBNAME S IBNAME=""
"RTN","IBCSC61",32,0)
 I $G(TYPE)=3,+$G(ITEM) S IBNAME=$P($G(^PSDRUG(+$P($G(^IBA(362.4,+ITEM,0)),U,4),0)),U,1)
"RTN","IBCSC61",33,0)
 I $G(TYPE)=5,+$G(ITEM) S IBNAME=$P($$PIN^IBCSC5B(+$P($G(^IBA(362.5,+ITEM,0)),U,3)),U,2)
"RTN","IBCSC61",34,0)
 I $G(TYPE)=6,+$G(ITEM) S IBNAME=$P($$DRG^IBACSV(+ITEM),U,1)
"RTN","IBCSC61",35,0)
 I $G(TYPE)=9,+$G(ITEM) S IBNAME=$P($G(^IBA(363.21,+ITEM,0)),U,1)
"RTN","IBCSC61",36,0)
 Q IBNAME
"RTN","IBCSC61",37,0)
 ;IBCSC61
"VER")
8.0^22
**END**
**END**
