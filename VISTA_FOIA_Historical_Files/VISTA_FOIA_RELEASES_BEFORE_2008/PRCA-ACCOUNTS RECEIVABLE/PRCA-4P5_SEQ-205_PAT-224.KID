Released PRCA*4.5*224 SEQ #205
Extracted from mail message
**KIDS**:PRCA*4.5*224^

**INSTALL NAME**
PRCA*4.5*224
"BLD",5882,0)
PRCA*4.5*224^ACCOUNTS RECEIVABLE^0^3050622^y
"BLD",5882,1,0)
^^4^4^3050622^
"BLD",5882,1,1,0)
This patch addresses one issues. The problem is that valid debts in
"BLD",5882,1,2,0)
patient accounts which are not referred to TOP (Treasury Offset Program)
"BLD",5882,1,3,0)
for collection when a repayment plan is established for one or more bills 
"BLD",5882,1,4,0)
but not all bills.
"BLD",5882,4,0)
^9.64PA^^
"BLD",5882,"KRN",0)
^9.67PA^8989.52^19
"BLD",5882,"KRN",.4,0)
.4
"BLD",5882,"KRN",.401,0)
.401
"BLD",5882,"KRN",.402,0)
.402
"BLD",5882,"KRN",.403,0)
.403
"BLD",5882,"KRN",.5,0)
.5
"BLD",5882,"KRN",.84,0)
.84
"BLD",5882,"KRN",3.6,0)
3.6
"BLD",5882,"KRN",3.8,0)
3.8
"BLD",5882,"KRN",9.2,0)
9.2
"BLD",5882,"KRN",9.8,0)
9.8
"BLD",5882,"KRN",9.8,"NM",0)
^9.68A^2^1
"BLD",5882,"KRN",9.8,"NM",2,0)
RCTOPD^^0^B58918951
"BLD",5882,"KRN",9.8,"NM","B","RCTOPD",2)

"BLD",5882,"KRN",19,0)
19
"BLD",5882,"KRN",19.1,0)
19.1
"BLD",5882,"KRN",101,0)
101
"BLD",5882,"KRN",409.61,0)
409.61
"BLD",5882,"KRN",771,0)
771
"BLD",5882,"KRN",870,0)
870
"BLD",5882,"KRN",8989.51,0)
8989.51
"BLD",5882,"KRN",8989.52,0)
8989.52
"BLD",5882,"KRN",8994,0)
8994
"BLD",5882,"KRN","B",.4,.4)

"BLD",5882,"KRN","B",.401,.401)

"BLD",5882,"KRN","B",.402,.402)

"BLD",5882,"KRN","B",.403,.403)

"BLD",5882,"KRN","B",.5,.5)

"BLD",5882,"KRN","B",.84,.84)

"BLD",5882,"KRN","B",3.6,3.6)

"BLD",5882,"KRN","B",3.8,3.8)

"BLD",5882,"KRN","B",9.2,9.2)

"BLD",5882,"KRN","B",9.8,9.8)

"BLD",5882,"KRN","B",19,19)

"BLD",5882,"KRN","B",19.1,19.1)

"BLD",5882,"KRN","B",101,101)

"BLD",5882,"KRN","B",409.61,409.61)

"BLD",5882,"KRN","B",771,771)

"BLD",5882,"KRN","B",870,870)

"BLD",5882,"KRN","B",8989.51,8989.51)

"BLD",5882,"KRN","B",8989.52,8989.52)

"BLD",5882,"KRN","B",8994,8994)

"BLD",5882,"QUES",0)
^9.62^^
"BLD",5882,"REQB",0)
^9.611^3^1
"BLD",5882,"REQB",3,0)
PRCA*4.5*187^2
"BLD",5882,"REQB","B","PRCA*4.5*187",3)

"MBREQ")
0
"PKG",142,-1)
1^1
"PKG",142,0)
ACCOUNTS RECEIVABLE^PRCA^BILL COLLECTIONS
"PKG",142,20,0)
^9.402P^1^1
"PKG",142,20,1,0)
2^^PRCAMRG
"PKG",142,20,1,1)

"PKG",142,20,"B",2,1)

"PKG",142,22,0)
^9.49I^1^1
"PKG",142,22,1,0)
4.5^^2950320
"PKG",142,22,1,"PAH",1,0)
224^3050622
"PKG",142,22,1,"PAH",1,1,0)
^^4^4^3050622
"PKG",142,22,1,"PAH",1,1,1,0)
This patch addresses one issues. The problem is that valid debts in
"PKG",142,22,1,"PAH",1,1,2,0)
patient accounts which are not referred to TOP (Treasury Offset Program)
"PKG",142,22,1,"PAH",1,1,3,0)
for collection when a repayment plan is established for one or more bills 
"PKG",142,22,1,"PAH",1,1,4,0)
but not all bills.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
1
"RTN","RCTOPD")
0^2^B58918951
"RTN","RCTOPD",1,0)
RCTOPD ;WASH IRMFO@ALTOONA,PA/TJK-TOP TRANSMISSION ;2/11/00  3:34 PM
"RTN","RCTOPD",2,0)
V ;;4.5;Accounts Receivable;**141,187,224**;Mar 20, 1995
"RTN","RCTOPD",3,0)
 ;;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","RCTOPD",4,0)
ENTER ;Entry point from nightly process
"RTN","RCTOPD",5,0)
 Q:'$D(RCDOC)
"RTN","RCTOPD",6,0)
 N DEBTOR,BILL,DEBTOR0,B0,B6,B7,P181DT,PRIN,INT,ADMIN,B4
"RTN","RCTOPD",7,0)
 N EFFDT,DFN,CNTR,SITE,LN,FN,MN,DOB,SITE,F60DT,VADM
"RTN","RCTOPD",8,0)
 N PHONE,QUIT,TOTAL,ZIPCODE,FULLNM,RCNT,REPAY,X1,X2
"RTN","RCTOPD",9,0)
 N ERROR,ADDR,CAT,BILLDT,P10YDT,CURRTOT,HOLD,SITECD,RCNEW
"RTN","RCTOPD",10,0)
 ;
"RTN","RCTOPD",11,0)
 ;initialize temporary global, variables
"RTN","RCTOPD",12,0)
 ;
"RTN","RCTOPD",13,0)
 K ^XTMP("RCTOPD") S ^XTMP("RCTOPD",0)=DT_U_DT
"RTN","RCTOPD",14,0)
 S SITE=$E($$SITE^RCMSITE(),1,3),SITECD=$P(^RC(342,1,3),U,5)
"RTN","RCTOPD",15,0)
 S X1=DT,X2=-181 D C^%DTC S (P181DT,EFFDT)=X
"RTN","RCTOPD",16,0)
 S X1=DT,X2=-3650 D C^%DTC S P10YDT=X
"RTN","RCTOPD",17,0)
 S X1=DT,X2=+60 D C^%DTC S F60DT=X
"RTN","RCTOPD",18,0)
 S (CNTR(1),CNTR(2),CNTR(4),DEBTOR,RCNT)=0
"RTN","RCTOPD",19,0)
 ;
"RTN","RCTOPD",20,0)
 ;branch if recertification document
"RTN","RCTOPD",21,0)
 I RCDOC="Y" D RECERT G EXIT
"RTN","RCTOPD",22,0)
 ;
"RTN","RCTOPD",23,0)
 ;branch to do update documents
"RTN","RCTOPD",24,0)
 D UPDATE I RCDOC="U" G EXIT
"RTN","RCTOPD",25,0)
 ;
"RTN","RCTOPD",26,0)
 ;master sheet compilation
"RTN","RCTOPD",27,0)
 ;
"RTN","RCTOPD",28,0)
 F  S DEBTOR=$O(^PRCA(430,"C",DEBTOR)) Q:DEBTOR'?1N.N  D
"RTN","RCTOPD",29,0)
    .Q:$D(^RCD(340,"TOP",DEBTOR))
"RTN","RCTOPD",30,0)
    .; quit if debtor address marked unknown
"RTN","RCTOPD",31,0)
    .Q:$P($G(^RCD(340,+DEBTOR,1)),"^",9)=1
"RTN","RCTOPD",32,0)
    .S DEBTOR6=$G(^RCD(340,DEBTOR,6)),DEBTOR0=$G(^(0)),HOLD=0,RCNEW=1
"RTN","RCTOPD",33,0)
    .I $P(DEBTOR6,U,2),'$P(DEBTOR6,U,3) Q
"RTN","RCTOPD",34,0)
    .S QUIT=1,FILE=$$FILE(DEBTOR0) Q:'FILE
"RTN","RCTOPD",35,0)
    .S EFFDT=P181DT
"RTN","RCTOPD",36,0)
    .D PROC(DEBTOR,.QUIT,FILE,.HOLD,.EFFDT) Q:QUIT
"RTN","RCTOPD",37,0)
    .D EN1^RCTOP2(DEBTOR,"M",FILE)
"RTN","RCTOPD",38,0)
    .D EN1^RCTOP1(DEBTOR,TOTAL,"M",EFFDT,0,FILE)
"RTN","RCTOPD",39,0)
    .;set hold date in file for employee, ex-employee, vendor records
"RTN","RCTOPD",40,0)
    .;Austin holds these for 60 days before transmitting to TOP
"RTN","RCTOPD",41,0)
    .I $G(HOLD) S $P(^RCD(340,DEBTOR,6),U,6)=F60DT
"RTN","RCTOPD",42,0)
    .Q
"RTN","RCTOPD",43,0)
 ;compile documents into mail messages--sets referral date in 430
"RTN","RCTOPD",44,0)
 D COMPILE
"RTN","RCTOPD",45,0)
EXIT K RCDOC,^XTMP("RCTOPD"),^TMP("RCTOPD"),XMDUZ D KVAR^VADPT
"RTN","RCTOPD",46,0)
 Q
"RTN","RCTOPD",47,0)
 ;
"RTN","RCTOPD",48,0)
UPDATE ;weekly update compilation
"RTN","RCTOPD",49,0)
 F  S DEBTOR=$O(^RCD(340,"TOP",DEBTOR)) Q:DEBTOR'?1N.N  D
"RTN","RCTOPD",50,0)
    .S QUIT=1,DEBTOR0=^RCD(340,DEBTOR,0),DEBTOR6=^(6),DEBTOR4=^(4),FILE=$$FILE(DEBTOR0),EFFDT=$P(DEBTOR4,U,6),RCNEW=0
"RTN","RCTOPD",51,0)
    .D EN1^RCTOP2(DEBTOR,"U",FILE)
"RTN","RCTOPD",52,0)
    .D PROC(DEBTOR,.QUIT,FILE,0,.EFFDT) I QUIT D  Q
"RTN","RCTOPD",53,0)
       ..;process type 4 document if necessary
"RTN","RCTOPD",54,0)
       ..S TAXID=$$TAXID^RCTOP1(DEBTOR,FILE),OTAXID=$P(DEBTOR4,U)
"RTN","RCTOPD",55,0)
       ..S NAME=$$NAME^RCTOP1(+DEBTOR0,FILE),ONAME=$P(DEBTOR4,U,2),NAME=$P(NAME,U)
"RTN","RCTOPD",56,0)
       ..I NAME=ONAME,TAXID=OTAXID Q
"RTN","RCTOPD",57,0)
       ..D EN1^RCTOP4(NAME,TAXID,DEBTOR4,DEBTOR,FILE)
"RTN","RCTOPD",58,0)
       ..Q
"RTN","RCTOPD",59,0)
    .D EN1^RCTOP1(DEBTOR,TOTAL,"U",EFFDT,0,FILE)
"RTN","RCTOPD",60,0)
    .Q
"RTN","RCTOPD",61,0)
 ;refund/refund reversal documents
"RTN","RCTOPD",62,0)
 D REFDOC
"RTN","RCTOPD",63,0)
 ;compile documents into mail messages--sets referral date in 430
"RTN","RCTOPD",64,0)
 D:$G(RCDOC)="U" COMPILE
"RTN","RCTOPD",65,0)
 Q
"RTN","RCTOPD",66,0)
 ;
"RTN","RCTOPD",67,0)
RECERT ;send yearly recertification documents
"RTN","RCTOPD",68,0)
 F  S DEBTOR=$O(^RCD(340,"TOP",DEBTOR)) Q:DEBTOR'?1N.N  D
"RTN","RCTOPD",69,0)
    .S DEBTOR4=$G(^RCD(340,DEBTOR,4)),TOTAL=$P(DEBTOR4,U,3),EFFDT=$P(DEBTOR4,U,6),DEBTOR0=$G(^(0)),FILE=$$FILE(DEBTOR0)
"RTN","RCTOPD",70,0)
    .I TOTAL D EN1^RCTOP1(DEBTOR,TOTAL,"Y",EFFDT,0,FILE)
"RTN","RCTOPD",71,0)
    .Q
"RTN","RCTOPD",72,0)
 ;compile documents into mail messages
"RTN","RCTOPD",73,0)
 D COMPILE
"RTN","RCTOPD",74,0)
 Q
"RTN","RCTOPD",75,0)
 ;
"RTN","RCTOPD",76,0)
REFDOC ; refund, refund reversal documents
"RTN","RCTOPD",77,0)
 N CODE,BILL,DEBTOR,TOTAL,EFFDT,FILE,RFCODE
"RTN","RCTOPD",78,0)
 F RFCODE=1,3 S CODE=$S(RFCODE=1:"R",1:"RV") D
"RTN","RCTOPD",79,0)
    .S BILL=0 F  S BILL=$O(^PRCA(430,"TREF",RFCODE,BILL)) Q:'BILL  D
"RTN","RCTOPD",80,0)
       ..S DEBTOR=$P($G(^PRCA(430,BILL,0)),U,9) Q:'DEBTOR
"RTN","RCTOPD",81,0)
       ..S TOTAL=$P($G(^(7)),U,18) Q:'TOTAL  ;NAKED TO LINE ABOVE
"RTN","RCTOPD",82,0)
       ..S EFFDT=$P($G(^RCD(340,+DEBTOR,4)),U,6),FILE=$$FILE(^(0))
"RTN","RCTOPD",83,0)
       ..D EN1^RCTOP1(DEBTOR,TOTAL,CODE,EFFDT,BILL,FILE)
"RTN","RCTOPD",84,0)
      ..Q
"RTN","RCTOPD",85,0)
    .Q
"RTN","RCTOPD",86,0)
 Q
"RTN","RCTOPD",87,0)
 ;
"RTN","RCTOPD",88,0)
COMPILE ;compiles documents into mail messages and transmits them
"RTN","RCTOPD",89,0)
 ;builds message array
"RTN","RCTOPD",90,0)
 N CNT,SEQ,REC,XMDUZ,DOCTYPE,LRTYPE,XMSUB,XMTEXT,XMY,TSEQ,DOCAMT
"RTN","RCTOPD",91,0)
 S (SEQ,TSEQ)=0
"RTN","RCTOPD",92,0)
 F I=1,2,4 S TSEQ=TSEQ+($G(CNTR(I))\150)+$S($G(CNTR(I))#150:1,1:0)
"RTN","RCTOPD",93,0)
 F DOCTYPE=1,2,4 D:$D(^XTMP("RCTOPD",$J,DOCTYPE)) COMPILE1(DOCTYPE,CNTR(DOCTYPE))
"RTN","RCTOPD",94,0)
 D USRMSG
"RTN","RCTOPD",95,0)
 Q
"RTN","RCTOPD",96,0)
COMPILE1(DOCTYPE,CNTR) ; compiles each type of document separately
"RTN","RCTOPD",97,0)
 S RCNT=RCNT+CNTR
"RTN","RCTOPD",98,0)
 I '$G(LRTYPE) F I=1,2,4 S:$D(^XTMP("RCTOPD",$J,I)) LRTYPE=I
"RTN","RCTOPD",99,0)
 F CNT=1:1:CNTR D
"RTN","RCTOPD",100,0)
    .D:CNT#150=1
"RTN","RCTOPD",101,0)
       ..K ^XTMP("RCTOPD",$J,"BUILD") S SEQ=SEQ+1
"RTN","RCTOPD",102,0)
       ..S REC=1,DOCAMT=0
"RTN","RCTOPD",103,0)
       ..Q
"RTN","RCTOPD",104,0)
    .S REC=REC+1,^XTMP("RCTOPD",$J,"BUILD",REC)=^XTMP("RCTOPD",$J,DOCTYPE,CNT)_U S:DOCTYPE=1 DOCAMT=DOCAMT+($E(^(REC),135,146)/100)
"RTN","RCTOPD",105,0)
    .I CNTR=CNT,LRTYPE=DOCTYPE S ^XTMP("RCTOPD",$J,"BUILD",REC+1)="END OF TRANSMISSION FOR SITE# "_SITE_":  TOTAL RECORDS: "_RCNT
"RTN","RCTOPD",106,0)
    .I $S(CNTR=CNT:1,CNT#150=0:1,1:0) D
"RTN","RCTOPD",107,0)
       ..S ^XTMP("RCTOPD",$J,"BUILD",1)=SITE_U_$TR($J(SEQ,2)," ",0)_U_$TR($J(TSEQ,2)," ",0)_U_(REC-1)_U_DOCAMT_U
"RTN","RCTOPD",108,0)
       ..S XMDUZ="AR PACKAGE"
"RTN","RCTOPD",109,0)
       ..S XMY("XXX@Q-TOP.MED.VA.GOV")=""
"RTN","RCTOPD",110,0)
       ..S XMY("G.TOP")=""
"RTN","RCTOPD",111,0)
       ..S XMSUB=SITE_"/TOP TRANSMISSION/SEQ#: "_SEQ_"/"_$$NOW()
"RTN","RCTOPD",112,0)
       ..S XMTEXT="^XTMP(""RCTOPD"","_$J_",""BUILD"","
"RTN","RCTOPD",113,0)
       ..D ^XMD
"RTN","RCTOPD",114,0)
       ..Q
"RTN","RCTOPD",115,0)
    .Q
"RTN","RCTOPD",116,0)
 Q
"RTN","RCTOPD",117,0)
 ;
"RTN","RCTOPD",118,0)
USRMSG ;sends mailman message of documents sent to user
"RTN","RCTOPD",119,0)
 N XMY,XMDUZ,XMSUB,X,RCNT
"RTN","RCTOPD",120,0)
 S XMDUZ="AR PACKAGE",XMY("G.TOP")=""
"RTN","RCTOPD",121,0)
 S XMSUB="TOP "_$S(RCDOC="M":"MASTER/UPDATE",RCDOC="U":"UPDATE",1:"RECERTIFICATION")_" RECORDS SENT ON "_$E(DT,4,5)_"/"_$E(DT,6,7)_"/"_$E(DT,2,3)
"RTN","RCTOPD",122,0)
 S ^XTMP("RCTOPD",$J,"REC1",1)="Name                             TIN        TYPE       AMOUNT"
"RTN","RCTOPD",123,0)
 S ^XTMP("RCTOPD",$J,"REC1",2)="----                             ---        ----       ------"
"RTN","RCTOPD",124,0)
 S X="",RCNT=3 F  S X=$O(^XTMP("RCTOPD",$J,"REC",X)) Q:X=""  S ^XTMP("RCTOPD",$J,"REC1",RCNT)=^(X),RCNT=RCNT+1
"RTN","RCTOPD",125,0)
 S ^XTMP("RCTOPD",$J,"REC1",RCNT)="Total Records: "_(RCNT-3)
"RTN","RCTOPD",126,0)
 S XMTEXT="^XTMP(""RCTOPD"","_$J_",""REC1"","
"RTN","RCTOPD",127,0)
 D ^XMD
"RTN","RCTOPD",128,0)
 ;
"RTN","RCTOPD",129,0)
THIRD ;sends mailman message to user if no third letter found
"RTN","RCTOPD",130,0)
 Q:'$D(^XTMP("RCTOPD",$J,"THIRD"))
"RTN","RCTOPD",131,0)
 K ^XTMP("RCTOPD",$J,"REC1")
"RTN","RCTOPD",132,0)
 S XMDUZ="AR PACKAGE",XMY("G.TOP")=""
"RTN","RCTOPD",133,0)
 N TCT,TDEB,TDEB0,TBIL,TSP,FST
"RTN","RCTOPD",134,0)
 S XMSUB="TOP QUALIFIED/NO 3RD LETTER SENT ON "_$E(DT,4,5)_"/"_$E(DT,6,7)_"/"_$E(DT,2,3)
"RTN","RCTOPD",135,0)
 S ^XTMP("RCTOPD",$J,"REC1",1)="The following list of debtor bills were not sent to TOP."
"RTN","RCTOPD",136,0)
 S ^XTMP("RCTOPD",$J,"REC1",2)="Please review debtor's account to determine why the third"
"RTN","RCTOPD",137,0)
        S ^XTMP("RCTOPD",$J,"REC1",3)="notice letter has not been sent:"
"RTN","RCTOPD",138,0)
 S ^XTMP("RCTOPD",$J,"REC1",4)="Name                               Bill #"
"RTN","RCTOPD",139,0)
 S ^XTMP("RCTOPD",$J,"REC1",5)="----                               ------"
"RTN","RCTOPD",140,0)
 S TCT=6,TSP=0,TDEB=""
"RTN","RCTOPD",141,0)
 F  S TDEB=$O(^XTMP("RCTOPD",$J,"THIRD",TDEB)) Q:TDEB=""  D
"RTN","RCTOPD",142,0)
 .S FST=1,TBIL=""
"RTN","RCTOPD",143,0)
 .I FST,TCT'=6 S ^XTMP("RCTOPD",$J,"REC1",TCT)="",TCT=TCT+1,TSP=TSP+1
"RTN","RCTOPD",144,0)
 .F  S TBIL=$O(^XTMP("RCTOPD",$J,"THIRD",TDEB,TBIL)) Q:TBIL=""  D
"RTN","RCTOPD",145,0)
 ..S TDEB0=$S(FST:TDEB,1:"")
"RTN","RCTOPD",146,0)
 ..S ^XTMP("RCTOPD",$J,"REC1",TCT)=TDEB0_$J(" ",35-$L(TDEB0))_TBIL
"RTN","RCTOPD",147,0)
 ..S TCT=TCT+1,FST=0
"RTN","RCTOPD",148,0)
 S ^XTMP("RCTOPD",$J,"REC1",TCT)="Total records: "_(TCT-(6+TSP))
"RTN","RCTOPD",149,0)
 S XMTEXT="^XTMP(""RCTOPD"","_$J_",""REC1"","
"RTN","RCTOPD",150,0)
 D ^XMD
"RTN","RCTOPD",151,0)
COMPQ Q
"RTN","RCTOPD",152,0)
 ;
"RTN","RCTOPD",153,0)
PROC(DEBTOR,QUIT,FILE,HOLD,EFFDT) ;process bills for a specific debtor
"RTN","RCTOPD",154,0)
 K ^TMP("RCTOPD",$J,"BILL")
"RTN","RCTOPD",155,0)
 S DEBTOR0=$G(^RCD(340,DEBTOR,0))
"RTN","RCTOPD",156,0)
 Q:'FILE
"RTN","RCTOPD",157,0)
 I FILE=2 S DFN=+DEBTOR0 D DEM^VADPT Q:$E(VADM(2),1,5)="00000"
"RTN","RCTOPD",158,0)
 S (BILL,TOTAL,REPAY)=0
"RTN","RCTOPD",159,0)
 I RCNEW,FILE=440 S HOLD=1
"RTN","RCTOPD",160,0)
 I 'RCNEW,$P(^RCD(340,DEBTOR,6),U,2),'$P(^(6),U,3) G TOTAL
"RTN","RCTOPD",161,0)
 I RCNEW,$D(^RCD(340,"DMC",1,DEBTOR)) G TOTAL
"RTN","RCTOPD",162,0)
 F  S BILL=$O(^PRCA(430,"C",DEBTOR,BILL)) Q:BILL'?1N.N  D
"RTN","RCTOPD",163,0)
    .I FILE=2,+VADM(6) S TOTAL=0,REPAY=1 Q
"RTN","RCTOPD",164,0)
    .S B0=$G(^PRCA(430,BILL,0)),B4=$G(^(4)),B6=$G(^(6)),B7=$G(^(7))
"RTN","RCTOPD",165,0)
    .Q:$P(B0,U,8)'=16
"RTN","RCTOPD",166,0)
    .Q:B4
"RTN","RCTOPD",167,0)
    .Q:'$P(B0,U,2)  S CAT=$P($G(^PRCA(430.2,$P(B0,U,2),0)),U,7)
"RTN","RCTOPD",168,0)
    .Q:'CAT  I ",16,17,21,22,23,26,27,33,"[(","_CAT_",") Q
"RTN","RCTOPD",169,0)
    .;check for DOJ referral here
"RTN","RCTOPD",170,0)
    .I $P(B6,U,4),($P(B6,U,5)="DOJ") Q
"RTN","RCTOPD",171,0)
    .S BILLDT=$P(B6,U,21) I (BILLDT<P10YDT)!(BILLDT>P181DT)!(BILLDT<$P(DEBTOR6,U,3)) Q
"RTN","RCTOPD",172,0)
    .I '$P(B6,U,3) D  Q
"RTN","RCTOPD",173,0)
    ..;no 3rd letter being sent 
"RTN","RCTOPD",174,0)
    ..N TDEB,TFIL
"RTN","RCTOPD",175,0)
    ..S TDEB=$G(^RCD(340,DEBTOR,0)),TFIL=$$FILE(TDEB),TDEB=$$NAME^RCTOP1(+TDEB,TFIL),TDEB=$P(TDEB,U,2),^XTMP("RCTOPD",$J,"THIRD",TDEB,$P(B0,U))=""
"RTN","RCTOPD",176,0)
    .I RCNEW,CAT>12,CAT<15 S HOLD=1
"RTN","RCTOPD",177,0)
    .I BILLDT,BILLDT<EFFDT S EFFDT=BILLDT
"RTN","RCTOPD",178,0)
    .S TOTAL=TOTAL+$P(B7,U)+$P(B7,U,2)+$P(B7,U,3)+$P(B7,U,4)+$P(B7,U,5)
"RTN","RCTOPD",179,0)
    .S ^TMP("RCTOPD",$J,"BILL",BILL)=""
"RTN","RCTOPD",180,0)
    .Q
"RTN","RCTOPD",181,0)
 ;
"RTN","RCTOPD",182,0)
TOTAL ;set transmission total, reset quit variable
"RTN","RCTOPD",183,0)
 I RCNEW Q:TOTAL<25
"RTN","RCTOPD",184,0)
 I 'RCNEW S:TOTAL<25 TOTAL=0  S CURRTOT=$P($G(^RCD(340,DEBTOR,4)),U,3) Q:CURRTOT=TOTAL  S TOTAL=TOTAL-CURRTOT
"RTN","RCTOPD",185,0)
 S QUIT=0
"RTN","RCTOPD",186,0)
PROCQ Q
"RTN","RCTOPD",187,0)
 ;
"RTN","RCTOPD",188,0)
NOW() ;compiles current date,time
"RTN","RCTOPD",189,0)
 N X,Y,%,%H
"RTN","RCTOPD",190,0)
 S %H=$H D YX^%DTC
"RTN","RCTOPD",191,0)
 Q Y
"RTN","RCTOPD",192,0)
 ;
"RTN","RCTOPD",193,0)
FILE(DEBTOR0) ;gets file number for debtor
"RTN","RCTOPD",194,0)
 S FILE=$P($P(DEBTOR0,U),";",2)
"RTN","RCTOPD",195,0)
 S FILE=$S(FILE["DPT(":2,FILE["PRC(440":440,FILE["VA(200":200,1:0)
"RTN","RCTOPD",196,0)
FILEQ Q FILE
"VER")
8.0^22.0
"BLD",5882,6)
^SEQ #205
**END**
**END**
