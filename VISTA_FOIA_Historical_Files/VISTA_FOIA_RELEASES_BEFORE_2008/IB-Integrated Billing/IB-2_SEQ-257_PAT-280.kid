Released IB*2*280 SEQ #257
Extracted from mail message
**KIDS**:IB*2.0*280^

**INSTALL NAME**
IB*2.0*280
"BLD",5240,0)
IB*2.0*280^INTEGRATED BILLING^0^3040916^y
"BLD",5240,1,0)
^^2^2^3040810^
"BLD",5240,1,1,0)
Follow up patch for problems found late in testing patch IB*2.0*232
"BLD",5240,1,2,0)
for EDI Enhancements.
"BLD",5240,4,0)
^9.64PA^361.1^4
"BLD",5240,4,350.8,0)
350.8
"BLD",5240,4,350.8,222)
n^n^f^^n^^y^o^n
"BLD",5240,4,350.8,224)
I $P(^(0),U)="IB324"
"BLD",5240,4,355.3,0)
355.3
"BLD",5240,4,355.3,2,0)
^9.641^355.3^1
"BLD",5240,4,355.3,2,355.3,0)
GROUP INSURANCE PLAN  (File-top level)
"BLD",5240,4,355.3,2,355.3,1,0)
^9.6411^.15^1
"BLD",5240,4,355.3,2,355.3,1,.15,0)
ELECTRONIC PLAN TYPE
"BLD",5240,4,355.3,222)
y^n^p^^^^n^^n
"BLD",5240,4,355.3,224)

"BLD",5240,4,361.1,0)
361.1
"BLD",5240,4,361.1,2,0)
^9.641^361.1154^1
"BLD",5240,4,361.1,2,361.1154,0)
LINE ITEM REMARK  (sub-file)
"BLD",5240,4,361.1,2,361.1154,1,0)
^9.6411^^
"BLD",5240,4,361.1,222)
y^n^p^^^^n^^n
"BLD",5240,4,361.1,224)

"BLD",5240,4,364.7,0)
364.7
"BLD",5240,4,364.7,222)
n^n^f^^y^^y^o^n
"BLD",5240,4,364.7,224)
I +Y=390
"BLD",5240,4,"APDD",355.3,355.3)

"BLD",5240,4,"APDD",355.3,355.3,.15)

"BLD",5240,4,"APDD",361.1,361.1154)

"BLD",5240,4,"B",350.8,350.8)

"BLD",5240,4,"B",355.3,355.3)

"BLD",5240,4,"B",361.1,361.1)

"BLD",5240,4,"B",364.7,364.7)

"BLD",5240,"ABPKG")
n
"BLD",5240,"INI")
IBY280PR
"BLD",5240,"INIT")
IBY280PO
"BLD",5240,"KRN",0)
^9.67PA^8989.52^19
"BLD",5240,"KRN",.4,0)
.4
"BLD",5240,"KRN",.401,0)
.401
"BLD",5240,"KRN",.402,0)
.402
"BLD",5240,"KRN",.402,"NM",0)
^9.68A^^0
"BLD",5240,"KRN",.403,0)
.403
"BLD",5240,"KRN",.5,0)
.5
"BLD",5240,"KRN",.84,0)
.84
"BLD",5240,"KRN",3.6,0)
3.6
"BLD",5240,"KRN",3.8,0)
3.8
"BLD",5240,"KRN",9.2,0)
9.2
"BLD",5240,"KRN",9.8,0)
9.8
"BLD",5240,"KRN",9.8,"NM",0)
^9.68A^9^7
"BLD",5240,"KRN",9.8,"NM",3,0)
IBCEP2^^0^B67570854
"BLD",5240,"KRN",9.8,"NM",4,0)
IBCEP3^^0^B35967297
"BLD",5240,"KRN",9.8,"NM",5,0)
IBCEP4A^^0^B49012479
"BLD",5240,"KRN",9.8,"NM",6,0)
IBCBB1^^0^B54095399
"BLD",5240,"KRN",9.8,"NM",7,0)
IBCEOB0^^0^B78247980
"BLD",5240,"KRN",9.8,"NM",8,0)
IBCECSA5^^0^B49494305
"BLD",5240,"KRN",9.8,"NM",9,0)
IBCEF74^^0^B64874707
"BLD",5240,"KRN",9.8,"NM","B","IBCBB1",6)

"BLD",5240,"KRN",9.8,"NM","B","IBCECSA5",8)

"BLD",5240,"KRN",9.8,"NM","B","IBCEF74",9)

"BLD",5240,"KRN",9.8,"NM","B","IBCEOB0",7)

"BLD",5240,"KRN",9.8,"NM","B","IBCEP2",3)

"BLD",5240,"KRN",9.8,"NM","B","IBCEP3",4)

"BLD",5240,"KRN",9.8,"NM","B","IBCEP4A",5)

"BLD",5240,"KRN",19,0)
19
"BLD",5240,"KRN",19,"NM",0)
^9.68A^^
"BLD",5240,"KRN",19.1,0)
19.1
"BLD",5240,"KRN",101,0)
101
"BLD",5240,"KRN",409.61,0)
409.61
"BLD",5240,"KRN",771,0)
771
"BLD",5240,"KRN",870,0)
870
"BLD",5240,"KRN",8989.51,0)
8989.51
"BLD",5240,"KRN",8989.52,0)
8989.52
"BLD",5240,"KRN",8994,0)
8994
"BLD",5240,"KRN","B",.4,.4)

"BLD",5240,"KRN","B",.401,.401)

"BLD",5240,"KRN","B",.402,.402)

"BLD",5240,"KRN","B",.403,.403)

"BLD",5240,"KRN","B",.5,.5)

"BLD",5240,"KRN","B",.84,.84)

"BLD",5240,"KRN","B",3.6,3.6)

"BLD",5240,"KRN","B",3.8,3.8)

"BLD",5240,"KRN","B",9.2,9.2)

"BLD",5240,"KRN","B",9.8,9.8)

"BLD",5240,"KRN","B",19,19)

"BLD",5240,"KRN","B",19.1,19.1)

"BLD",5240,"KRN","B",101,101)

"BLD",5240,"KRN","B",409.61,409.61)

"BLD",5240,"KRN","B",771,771)

"BLD",5240,"KRN","B",870,870)

"BLD",5240,"KRN","B",8989.51,8989.51)

"BLD",5240,"KRN","B",8989.52,8989.52)

"BLD",5240,"KRN","B",8994,8994)

"BLD",5240,"QUES",0)
^9.62^^
"BLD",5240,"REQB",0)
^9.611^3^3
"BLD",5240,"REQB",1,0)
IB*2.0*232^2
"BLD",5240,"REQB",2,0)
IB*2.0*263^2
"BLD",5240,"REQB",3,0)
IB*2.0*240^2
"BLD",5240,"REQB","B","IB*2.0*232",1)

"BLD",5240,"REQB","B","IB*2.0*240",3)

"BLD",5240,"REQB","B","IB*2.0*263",2)

"DATA",350.8,302,0)
IB324^Insurance bill has invalid Payer Sequence^IB324^1^3
"DATA",364.7,390,0)
172^N^5^^^^N
"DATA",364.7,390,1)
K:'$G(IBXSAVE("IBFAC"))&'$P($G(IBXSAVE("IBFAC")),U,3) IBXDATA I $D(IBXDATA) S IBXDATA=$$GETFAC^IBCEP8(+IBXSAVE("IBFAC"),+$P(IBXSAVE("IBFAC"),U,2),"3C")
"DATA",364.7,390,3,0)
^^3^3^3040901^
"DATA",364.7,390,3,1,0)
Extract the city for the rendering facility.  Relies on the
"DATA",364.7,390,3,2,0)
existence of the array IBXSAVE("IBFAC") extracted previously by the
"DATA",364.7,390,3,3,0)
rendering facility name field.
"FIA",350.8)
IB ERROR
"FIA",350.8,0)
^IBE(350.8,
"FIA",350.8,0,0)
350.8I
"FIA",350.8,0,1)
n^n^f^^n^^y^o^n
"FIA",350.8,0,10)

"FIA",350.8,0,11)
I $P(^(0),U)="IB324"
"FIA",350.8,0,"RLRO")

"FIA",350.8,0,"VR")
2.0^IB
"FIA",350.8,350.8)
0
"FIA",355.3)
GROUP INSURANCE PLAN
"FIA",355.3,0)
^IBA(355.3,
"FIA",355.3,0,0)
355.3IP
"FIA",355.3,0,1)
y^n^p^^^^n^^n
"FIA",355.3,0,10)

"FIA",355.3,0,11)

"FIA",355.3,0,"RLRO")

"FIA",355.3,0,"VR")
2.0^IB
"FIA",355.3,355.3)
1
"FIA",355.3,355.3,.15)

"FIA",361.1)
EXPLANATION OF BENEFITS
"FIA",361.1,0)
^IBM(361.1,
"FIA",361.1,0,0)
361.1PI
"FIA",361.1,0,1)
y^n^p^^^^n^^n
"FIA",361.1,0,10)

"FIA",361.1,0,11)

"FIA",361.1,0,"RLRO")

"FIA",361.1,0,"VR")
2.0^IB
"FIA",361.1,361.1)
1
"FIA",361.1,361.115)
1
"FIA",361.1,361.115,4)

"FIA",361.1,361.1154)
0
"FIA",364.7)
IB FORM FIELD CONTENT
"FIA",364.7,0)
^IBA(364.7,
"FIA",364.7,0,0)
364.7IP
"FIA",364.7,0,1)
n^n^f^^y^^y^o^n
"FIA",364.7,0,10)

"FIA",364.7,0,11)
I +Y=390
"FIA",364.7,0,"RLRO")

"FIA",364.7,0,"VR")
2.0^IB
"FIA",364.7,364.7)
0
"FIA",364.7,364.73)
0
"INI")
IBY280PR
"INIT")
IBY280PO
"IX",364.7,364.7,"ALL",0)
364.7^ALL^Xref contains all local overrides defined for all insurance and type^MU^^F^IR^I^364.7^^^^^S
"IX",364.7,364.7,"ALL",1)
S ^IBA(364.7,"ALL",X2(2),DA)=""
"IX",364.7,364.7,"ALL",1.4)
I 'X2(2)!(X2(4)'="")!(X2(5)'="")!(X2(3)'="L") S X=0
"IX",364.7,364.7,"ALL",2)
K ^IBA(364.7,"ALL",X1(2),DA)
"IX",364.7,364.7,"ALL",2.4)
I 'X1(2)!(X1(4)'="")!(X1(5)'="")!(X1(3)'="L") S X=0
"IX",364.7,364.7,"ALL",2.5)
K ^IBA(364.7,"ALL")
"IX",364.7,364.7,"ALL",11.1,0)
^.114IA^5^5
"IX",364.7,364.7,"ALL",11.1,1,0)
1^F^364.7^.01^15^^F
"IX",364.7,364.7,"ALL",11.1,1,3)
 
"IX",364.7,364.7,"ALL",11.1,2,0)
2^C^^^10^1
"IX",364.7,364.7,"ALL",11.1,2,1.5)
S X=$P($G(^IBA(364.6,+X(1),0)),U,3)
"IX",364.7,364.7,"ALL",11.1,3,0)
3^F^364.7^.02^10^^F
"IX",364.7,364.7,"ALL",11.1,3,3)
 
"IX",364.7,364.7,"ALL",11.1,4,0)
4^F^364.7^.05^20^^F
"IX",364.7,364.7,"ALL",11.1,4,3)
 
"IX",364.7,364.7,"ALL",11.1,5,0)
5^F^364.7^.06^20^^F
"IX",364.7,364.7,"ALL",11.1,5,3)
 
"MBREQ")
0
"PGL",364.7,0,5,.05)
INSURANCE COMPANY^P36'^DIC(36,^0;5^Q
"PKG",192,-1)
1^1
"PKG",192,0)
INTEGRATED BILLING^IB^INTEGRATED BILLING
"PKG",192,20,0)
^9.402P^1^1
"PKG",192,20,1,0)
2^^IBAXDR
"PKG",192,20,1,1)
 
"PKG",192,20,"B",2,1)

"PKG",192,22,0)
^9.49I^1^1
"PKG",192,22,1,0)
2.0^2940321^2940414
"PKG",192,22,1,"PAH",1,0)
280^3040916^11719
"PKG",192,22,1,"PAH",1,1,0)
^^2^2^3040916
"PKG",192,22,1,"PAH",1,1,1,0)
Follow up patch for problems found late in testing patch IB*2.0*232
"PKG",192,22,1,"PAH",1,1,2,0)
for EDI Enhancements.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
9
"RTN","IBCBB1")
0^6^B54095399
"RTN","IBCBB1",1,0)
IBCBB1 ;ALB/AAS - CONTINUATION OF EDIT CHECK ROUTINE ;2-NOV-89
"RTN","IBCBB1",2,0)
 ;;2.0;INTEGRATED BILLING;**27,52,80,93,106,51,151,148,153,137,232,280**;21-MAR-94
"RTN","IBCBB1",3,0)
 ;;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","IBCBB1",4,0)
 ;
"RTN","IBCBB1",5,0)
 ;MAP TO DGCRBB1
"RTN","IBCBB1",6,0)
 ;
"RTN","IBCBB1",7,0)
% ;Bill Status
"RTN","IBCBB1",8,0)
 N Z,Z0,Z1
"RTN","IBCBB1",9,0)
 I $S(+IBST=0:1,1:"^1^2^3^4^7^"'[(U_IBST_U)) S IBER=IBER_"IB045;"
"RTN","IBCBB1",10,0)
 ;
"RTN","IBCBB1",11,0)
 ;Statement Covers From
"RTN","IBCBB1",12,0)
 I IBFDT="" S IBER=IBER_"IB061;"
"RTN","IBCBB1",13,0)
 I IBFDT]"",IBFDT'?7N&(IBFDT'?7N1".".N) S IBER=IBER_"IB061;"
"RTN","IBCBB1",14,0)
 I IBFDT>IBTDT S IBER=IBER_"IB061;" ; from must be on or before the to date 
"RTN","IBCBB1",15,0)
 S IBFFY=$$FY^IBOUTL(IBFDT)
"RTN","IBCBB1",16,0)
 ; if inpat - from date must not be prior to admit date.
"RTN","IBCBB1",17,0)
 I $$INPAT^IBCEF(IBIFN,1),(IBFDT<($P($G(^DGPT(+$P(IBND0,U,8),0)),U,2)\1))  S IBER=IBER_"IB061;"
"RTN","IBCBB1",18,0)
 ;
"RTN","IBCBB1",19,0)
 ;Statement Covers To
"RTN","IBCBB1",20,0)
 I IBTDT="" S IBER=IBER_"IB062;"
"RTN","IBCBB1",21,0)
 I IBTDT]"",IBTDT'?7N&(IBTDT'?7N1".".N) S IBER=IBER_"IB062;"
"RTN","IBCBB1",22,0)
 I IBTDT>DT!(IBTDT<IBFDT) S IBER=IBER_"IB062;"  ; to date must not be >than today's date
"RTN","IBCBB1",23,0)
 S IBTFY=$$FY^IBOUTL(IBTDT)
"RTN","IBCBB1",24,0)
 ;
"RTN","IBCBB1",25,0)
 ;Statement crosses fiscal years
"RTN","IBCBB1",26,0)
 ;I IBTFY'=IBFFY S IBER=IBER_"IB047;"
"RTN","IBCBB1",27,0)
 ;
"RTN","IBCBB1",28,0)
 ;Statement crosses calendar years
"RTN","IBCBB1",29,0)
 ;I $E(IBTDT,1,3)'=$E(IBFDT,1,3) S IBER=IBER_"IB046;"
"RTN","IBCBB1",30,0)
 ;
"RTN","IBCBB1",31,0)
 ;Total Charges
"RTN","IBCBB1",32,0)
 I +IBTC'>0!(+IBTC'=IBTC) S IBER=IBER_"IB064;"
"RTN","IBCBB1",33,0)
 ;
"RTN","IBCBB1",34,0)
 ;Billable charges for secondary claim
"RTN","IBCBB1",35,0)
 I $$MCRONBIL^IBEFUNC(IBIFN)&(($P(IBNDU1,U,1)-$P(IBNDU1,U,2))'>0) S IBER=IBER_"IB094;"
"RTN","IBCBB1",36,0)
 ;Fiscal Year 1
"RTN","IBCBB1",37,0)
 S IBFFY=$$FY^IBOUTL(IBFDT)
"RTN","IBCBB1",38,0)
 ;
"RTN","IBCBB1",39,0)
 ;Check provider link for current user, enterer, reviewer and Authorizor
"RTN","IBCBB1",40,0)
 I '$D(^VA(200,DUZ,0)) S IBER=IBER_"IB048;"
"RTN","IBCBB1",41,0)
 I IBEU]"",'$D(^VA(200,IBEU,0)) S IBER=IBER_"IB048;"
"RTN","IBCBB1",42,0)
 I IBRU]"",'$D(^VA(200,IBRU,0)) S IBER=IBER_"IB060;"
"RTN","IBCBB1",43,0)
 I IBAU]"",'$D(^VA(200,IBAU,0)) S IBER=IBER_"IB041;"
"RTN","IBCBB1",44,0)
 ;
"RTN","IBCBB1",45,0)
 ;Bill exists and not already new bill
"RTN","IBCBB1",46,0)
 ;I $S('$D(^PRCA(430,IBIFN,0)):1,$P($P(^PRCA(430,IBIFN,0),"^"),"-",2)'=IBBNO:1,1:0) S IBER=IBER_"IB056;"
"RTN","IBCBB1",47,0)
 ;I $P($$BN^PRCAFN(IBIFN),"-",2)'=IBBNO S IBER=IBER_"IB056;"
"RTN","IBCBB1",48,0)
 ;I IBER="",$P(^PRCA(430,IBIFN,0),"^",8)=$O(^PRCA(430.3,"AC",104,"")) S IBER=IBER_"IB040;"
"RTN","IBCBB1",49,0)
 I IBER="",+$$STA^PRCAFN(IBIFN)=104 S IBER=IBER_"IB040;"
"RTN","IBCBB1",50,0)
 ; If ins bill, must have valid COB sequence
"RTN","IBCBB1",51,0)
 I $P(IBND0,U,11)="i",$S($P(IBND0,U,21)="":1,1:"PST"'[$P(IBND0,U,21)) S IBER=IBER_"IB324;"
"RTN","IBCBB1",52,0)
 ;
"RTN","IBCBB1",53,0)
 ; Check for valid sec provider id for current ins
"RTN","IBCBB1",54,0)
 S Z=0 F  S Z=$O(^DGCR(399,IBIFN,"PRV",Z)) Q:'Z  S Z0=$G(^(Z,0)),Z1=+$$COBN^IBCEF(IBIFN) I $P(Z0,U,4+Z1)'="",$P(Z0,U,11+Z1)'="" D
"RTN","IBCBB1",55,0)
 . I '$$SECIDCK^IBCEF74(IBIFN,Z1,$P(Z0,U,11+Z1),Z) D WARN^IBCBB11("Prov secondary id type for the "_$P("PRIMARY^SECONDARY^TERTIARY",U,Z1)_" "_$$EXTERNAL^DILFD(399.0222,.01,,+Z0)_" is invalid/won't transmit")
"RTN","IBCBB1",56,0)
 ;
"RTN","IBCBB1",57,0)
 N IBCOBN,IBZ
"RTN","IBCBB1",58,0)
 S IBCOBN=+$$COBN^IBCEF(IBIFN),Z=$$GETTYP^IBCEP2A(IBIFN,IBCOBN)
"RTN","IBCBB1",59,0)
 I Z,$P(Z,U,2) D  ; Rendering/attending prov secondary id required
"RTN","IBCBB1",60,0)
 . ; for current insurance
"RTN","IBCBB1",61,0)
 . N Q,Q0,IBID,IBOK
"RTN","IBCBB1",62,0)
 . S IBOK=0
"RTN","IBCBB1",63,0)
 . D PROVINF^IBCEF74(IBIFN,IBCOBN,.IBID,IBCOBN,"C")
"RTN","IBCBB1",64,0)
 . S Q0=0,Q=$S($$FT^IBCEF(IBIFN)=3:4,1:3) F  S Q0=$O(IBID(IBCOBN,Q,Q0)) Q:'Q0  I $P(IBID(IBCOBN,Q,Q0),U,9)=+Z S IBOK=1 Q
"RTN","IBCBB1",65,0)
 . I 'IBOK S IBER=IBER_"IB303;"
"RTN","IBCBB1",66,0)
 K IBXDATA D F^IBCEF("N-ATT/REND PHYSICIAN NAME",,,IBIFN)
"RTN","IBCBB1",67,0)
 I $P($G(IBXDATA),U)="" S IBER=IBER_"IB303;"
"RTN","IBCBB1",68,0)
 I $$TXMT^IBCEF4(IBIFN) D
"RTN","IBCBB1",69,0)
 . D F^IBCEF("N-ALL ATT/REND PROV SSN/EI","IBZ",,IBIFN)
"RTN","IBCBB1",70,0)
 . I $P(IBZ,U,3)=""&($P(IBZ,U,4)="") S IBER=IBER_"IB321;" ; SSN/IEN required for rend/att
"RTN","IBCBB1",71,0)
 . ;
"RTN","IBCBB1",72,0)
 ;
"RTN","IBCBB1",73,0)
 ; Must be one and only one division on bill
"RTN","IBCBB1",74,0)
 S IBZ=$$MULTDIV^IBCBB11(IBIFN,IBND0)
"RTN","IBCBB1",75,0)
 I IBZ S IBER=IBER_$S(IBZ=1:"IB095;",IBZ=2:"IB104;",1:"IB105;")
"RTN","IBCBB1",76,0)
 ; Division address must be defined in institution file
"RTN","IBCBB1",77,0)
 I $P(IBND0,U,22) D
"RTN","IBCBB1",78,0)
 . N Z,Z0,Z1
"RTN","IBCBB1",79,0)
 . S Z0=$G(^DIC(4,+$P($G(^DG(40.8,+$P(IBND0,U,22),0)),U,7),0))
"RTN","IBCBB1",80,0)
 . S Z1=$G(^DIC(4,+$P($G(^DG(40.8,+$P(IBND0,U,22),0)),U,7),1))
"RTN","IBCBB1",81,0)
 . I $P(Z0,U,2)="" S IBER=IBER_"IB097;" Q
"RTN","IBCBB1",82,0)
 . F Z=1,3,4 I $P(Z1,U,Z)="" S IBER=IBER_"IB097;" Q
"RTN","IBCBB1",83,0)
 ;
"RTN","IBCBB1",84,0)
 ;CHAMPVA Rate Type and Primary Insurance Carriers Type of Coverage must match
"RTN","IBCBB1",85,0)
 S (IBRTCHV,IBPICHV)=0
"RTN","IBCBB1",86,0)
 I $P($G(^DGCR(399.3,+IBAT,0)),U,1)="CHAMPVA" S IBRTCHV=1
"RTN","IBCBB1",87,0)
 I $P($G(^IBE(355.2,+$P($G(^DIC(36,+IBNDMP,0)),U,13),0)),U,1)="CHAMPVA" S IBPICHV=1
"RTN","IBCBB1",88,0)
 I (+IBRTCHV!+IBPICHV)&('IBRTCHV!'IBPICHV) S IBER=IBER_"IB085;"
"RTN","IBCBB1",89,0)
 ;
"RTN","IBCBB1",90,0)
 N IBZPRC,IBZPRC92
"RTN","IBCBB1",91,0)
 D F^IBCEF("N-ALL PROCEDURES","IBZPRC",,IBIFN)
"RTN","IBCBB1",92,0)
 ; Procedure Clinic is required for Surgical Procedures Outpt Facility Charges
"RTN","IBCBB1",93,0)
 I +$P(IBND0,U,27)'=2,$$BILLRATE^IBCRU3(IBAT,IBCL,IBEVDT,"RC OUTPATIENT") D
"RTN","IBCBB1",94,0)
 . N Z,Z0,Z1,ZE S (ZE,Z)=0 F  S Z=$O(^DGCR(399,IBIFN,"CP",Z)) Q:'Z  D  I +ZE S IBER=IBER_"IB320;" Q
"RTN","IBCBB1",95,0)
 .. S Z0=$G(^DGCR(399,IBIFN,"CP",Z,0)),Z1=+Z0 I Z0'[";ICPT(" Q
"RTN","IBCBB1",96,0)
 .. I '((Z1'<10000)&(Z1'>69999))&'((Z1'<93501)&(Z1'>93533)) Q
"RTN","IBCBB1",97,0)
 .. I '$P(Z0,U,7) S ZE=1
"RTN","IBCBB1",98,0)
 ;
"RTN","IBCBB1",99,0)
 ; Extract procedures for UB92
"RTN","IBCBB1",100,0)
 D F^IBCEF("N-UB92 PROCEDURES","IBZPRC92",,IBIFN)
"RTN","IBCBB1",101,0)
 ; Does this bill have ANY prescriptions associated with it?
"RTN","IBCBB1",102,0)
 ; Must bill prescriptions separately from other charges
"RTN","IBCBB1",103,0)
 ;
"RTN","IBCBB1",104,0)
 I $$ISRX^IBCEF1(IBIFN) D
"RTN","IBCBB1",105,0)
 . N IBZ,IBRXDEF
"RTN","IBCBB1",106,0)
 . S IBRXDEF=$P($G(^IBE(350.9,1,1)),U,30),IBZ=0
"RTN","IBCBB1",107,0)
 . F  S IBZ=$O(IBZPRC92(IBZ)) Q:'IBZ  I IBZPRC92(IBZ),+$P(IBZPRC92(IBZ),U)'=IBRXDEF S IBER=IBER_"IB102;" Q
"RTN","IBCBB1",108,0)
 . K IBZ
"RTN","IBCBB1",109,0)
 ;
"RTN","IBCBB1",110,0)
 ; Check that COB sequences are not skipped
"RTN","IBCBB1",111,0)
 K Z
"RTN","IBCBB1",112,0)
 F Z=1:1:3 S:+$G(^DGCR(399,IBIFN,"I"_Z)) Z(Z)=""
"RTN","IBCBB1",113,0)
 F Z=0:1:2 S Z0=$O(Z(Z)) Q:'Z0  I Z0'=(Z+1) S IBER=IBER_"IB322;" Q
"RTN","IBCBB1",114,0)
 K Z
"RTN","IBCBB1",115,0)
 K IBXDATA D F^IBCEF("N-PROCEDURE CODING METHD",,,IBIFN)
"RTN","IBCBB1",116,0)
 ; Coding method should agree with types of procedure codes
"RTN","IBCBB1",117,0)
 S IBOK=$S('$O(IBZPRC(0))!(IBXDATA=""):1,1:0)
"RTN","IBCBB1",118,0)
 I 'IBOK S IBOK=1,IBZ=0 F  S IBZ=$O(IBZPRC(IBZ)) Q:'IBZ  I IBZPRC(IBZ),$P(IBZPRC(IBZ),U)'[$S(IBXDATA=9:"ICD",1:"ICP") S IBOK=0 Q
"RTN","IBCBB1",119,0)
 I 'IBOK D WARN^IBCBB11("Coding Method does not agree with all procedure codes found on bill")
"RTN","IBCBB1",120,0)
 D EDITMRA^IBCBB3(.IBQUIT,.IBER,IBIFN,IBFT)
"RTN","IBCBB1",121,0)
 Q:$G(IBQUIT)
"RTN","IBCBB1",122,0)
 ;
"RTN","IBCBB1",123,0)
 ;Other things that could be added:  Rev Code - calculating charges
"RTN","IBCBB1",124,0)
 ;        Diagnosis Coding, if MT copay - check for other co-payments
"RTN","IBCBB1",125,0)
 ;
"RTN","IBCBB1",126,0)
 I $P(IBNDTX,U,8),$$REQMRA^IBEFUNC(IBIFN) S IBER=IBER_"IB121;"   ; can't force MRAs to print
"RTN","IBCBB1",127,0)
 I $P(IBNDTX,U,8) D WARN^IBCBB11("Bill has been forced to print "_$S($P(IBNDTX,U,8)=1:"locally",1:"at clearinghouse"))
"RTN","IBCBB1",128,0)
 I IBFT'=2,$P(IBNDM,U,10)="" D WARN^IBCBB11("Patient Short Address has no value")
"RTN","IBCBB1",129,0)
 N IBXZ,IBIZ F IBIZ=12,13,14 S IBXZ=$P(IBNDM,U,IBIZ) I +IBXZ S IBXZ=$P($G(^DPT(DFN,.312,IBXZ,0)),U,18) I +IBXZ S IBXZ=$G(^IBA(355.3,+IBXZ,0)) I +$P(IBXZ,U,12) D
"RTN","IBCBB1",130,0)
 . D WARN^IBCBB11($P($G(^DIC(36,+IBXZ,0)),U,1)_" requires Amb Care Certification")
"RTN","IBCBB1",131,0)
 ;
"RTN","IBCBB1",132,0)
 ;Build AR array if no errors and MRA not needed or already rec'd
"RTN","IBCBB1",133,0)
 I IBER="",$S($$NEEDMRA^IBEFUNC(IBIFN)!($$REQMRA^IBEFUNC(IBIFN)):0,1:1) D ARRAY
"RTN","IBCBB1",134,0)
 ;
"RTN","IBCBB1",135,0)
END ;Don't kill IBIFN, IBER, DFN
"RTN","IBCBB1",136,0)
 I $O(^TMP($J,"BILL-WARN",0)),$G(IBER)="" S IBER="WARN" ;Warnings only
"RTN","IBCBB1",137,0)
 K IBBNO,IBEVDT,IBLOC,IBCL,IBTF,IBAT,IBWHO,IBST,IBFDT,IBTDT,IBTC,IBFY,IBFY1,IBAU,IBRU,IBEU,IBARTP,IBFYC,IBMRA,IBTOB,IBTOB12,IBNDU2,IBNDUF3,IBNDUF31,IBNDTX
"RTN","IBCBB1",138,0)
 K IBNDS,IBND0,IBNDU,IBNDM,IBNDMP,IBNDU1,IBFFY,IBTFY,IBFT,IBRTCHV,IBPICHV,IBXDATA,IBOK
"RTN","IBCBB1",139,0)
 I $D(IBER),IBER="" W !,"No Errors found for National edits"
"RTN","IBCBB1",140,0)
 Q
"RTN","IBCBB1",141,0)
 ;
"RTN","IBCBB1",142,0)
ARRAY ;Build PRCASV(array)
"RTN","IBCBB1",143,0)
 N IBCOBN,X
"RTN","IBCBB1",144,0)
 K PRCASV
"RTN","IBCBB1",145,0)
 Q:$$MCRWNR^IBEFUNC(+$$CURR^IBCEF2(IBIFN))
"RTN","IBCBB1",146,0)
 S IBCOBN=$$COBN^IBCEF(IBIFN)
"RTN","IBCBB1",147,0)
 S X=IBIFN
"RTN","IBCBB1",148,0)
 S PRCASV("BDT")=DT,PRCASV("ARREC")=IBIFN
"RTN","IBCBB1",149,0)
 S PRCASV("APR")=DUZ
"RTN","IBCBB1",150,0)
 S PRCASV("PAT")=DFN,PRCASV("CAT")=$P(^DGCR(399.3,IBAT,0),"^",6)
"RTN","IBCBB1",151,0)
 I IBWHO="i" S PRCASV("DEBTOR")=+IBNDMP_";DIC(36,"
"RTN","IBCBB1",152,0)
 S PRCASV("DEBTOR")=$S(IBWHO="p":DFN_";DPT(",IBWHO="o":$P(IBNDM,"^",11)_";DIC(4,",IBWHO="i":PRCASV("DEBTOR"),1:"")
"RTN","IBCBB1",153,0)
 S PRCASV("CARE")=$E($$TOB^IBCEF1(IBIFN),1,2)
"RTN","IBCBB1",154,0)
 S PRCASV("FY")=$$FY^IBOUTL(DT)_U_($P(IBNDU1,U)-$P(IBNDU1,U,2))
"RTN","IBCBB1",155,0)
 ;S PRCASV("FY")=$P(IBNDU1,U,9)_U_$S($P(IBNDU1,U,2)]"":($P(IBNDU1,U,10)-$P(IBNDU1,U,2)),1:$P(IBNDU1,U,10))_$S($P(IBNDU1,U,11)]"":U_$P(IBNDU1,U,11)_U_$P(IBNDU1,U,12),1:"")
"RTN","IBCBB1",156,0)
PLUS I IBWHO="i",$P(IBNDM,"^",2),$D(^DIC(36,$P(IBNDM,"^",2),0)) S PRCASV("2NDINS")=$P(IBNDM,"^",2)
"RTN","IBCBB1",157,0)
 I IBWHO="i",$P(IBNDM,"^",3),$D(^DIC(36,$P(IBNDM,"^",3),0)) S PRCASV("3RDINS")=$P(IBNDM,"^",3)
"RTN","IBCBB1",158,0)
 ;
"RTN","IBCBB1",159,0)
 N IBX S IBX=$P(IBND0,U,21),IBX=$S(IBX="P":"I1",IBX="S":"I2",IBX="T":"I3",1:"") Q:IBX=""
"RTN","IBCBB1",160,0)
 N IBNDI1
"RTN","IBCBB1",161,0)
 Q:'$D(^DGCR(399,IBIFN,IBX))  S IBNDI1=^(IBX)
"RTN","IBCBB1",162,0)
 S:$P(IBNDI1,"^",3)]"" PRCASV("GPNO")=$P(IBNDI1,"^",3)
"RTN","IBCBB1",163,0)
 S:$P(IBNDI1,"^",15)]"" PRCASV("GPNM")=$P(IBNDI1,"^",15)
"RTN","IBCBB1",164,0)
 S:$P(IBNDI1,"^",17)]"" PRCASV("INPA")=$P(IBNDI1,"^",17)
"RTN","IBCBB1",165,0)
 S:$P(IBNDI1,"^",2)]"" PRCASV("IDNO")=$P(IBNDI1,"^",2),PRCASV("INID")=PRCASV("IDNO")
"RTN","IBCBB1",166,0)
 ; Check that this is a secondary or tertiary bill and insurance for previous
"RTN","IBCBB1",167,0)
 ; COB sequence is Medicare WNR and MRA is active --> send data elements to AR
"RTN","IBCBB1",168,0)
 I IBCOBN>1,$$WNRBILL^IBEFUNC(IBIFN,IBCOBN-1),$$EDIACTV^IBCEF4(2) D MRA
"RTN","IBCBB1",169,0)
 Q
"RTN","IBCBB1",170,0)
 ;
"RTN","IBCBB1",171,0)
MRA N IBEOB S IBEOB=0
"RTN","IBCBB1",172,0)
 ;
"RTN","IBCBB1",173,0)
 K PRCASV("MEDURE"),PRCASV("MEDCA")
"RTN","IBCBB1",174,0)
 ; Get EOB data
"RTN","IBCBB1",175,0)
 ;F  S IBEOB=$O(^IBM(361.1,"B",IBIFN,IBEOB)) Q:'IBEOB  D
"RTN","IBCBB1",176,0)
 ;. D MRACALC^IBCEMU2(IBEOB,IBIFN,1,.PRCASV)
"RTN","IBCBB1",177,0)
 Q  ;MRA
"RTN","IBCBB1",178,0)
 ;
"RTN","IBCBB1",179,0)
 ;; PREGNANCY DX CODES: V22**-V24**, V27**-V28**, 630**-677**
"RTN","IBCBB1",180,0)
 ;; FLU SHOTS PROCEDURE CODES: 90724, G0008, 90732, G0009
"RTN","IBCECSA5")
0^8^B49494305
"RTN","IBCECSA5",1,0)
IBCECSA5 ;ALB/CXW - VIEW EOB SCREEN ;01-OCT-1999
"RTN","IBCECSA5",2,0)
 ;;2.0;INTEGRATED BILLING;**137,135,263,280**;21-MAR-1994
"RTN","IBCECSA5",3,0)
 ;;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","IBCECSA5",4,0)
 ;
"RTN","IBCECSA5",5,0)
EN ; -- main entry point for VIEW EOB
"RTN","IBCECSA5",6,0)
 N VALMCNT,VALMBG,VALMHDR
"RTN","IBCECSA5",7,0)
 S VALMCNT=0,VALMBG=1
"RTN","IBCECSA5",8,0)
 D EN^VALM("IBCEM VIEW EOB")
"RTN","IBCECSA5",9,0)
 Q
"RTN","IBCECSA5",10,0)
 ;
"RTN","IBCECSA5",11,0)
INIT ; -- init variables and list array
"RTN","IBCECSA5",12,0)
 I '$G(IBIFN) S VALMQUIT="" G INITQ
"RTN","IBCECSA5",13,0)
 D HDR^IBCEOB2,BLD^IBCEOB2
"RTN","IBCECSA5",14,0)
 K IBCNT,IBONE,^TMP("IBCECSD",$J)
"RTN","IBCECSA5",15,0)
 S IBONE=0
"RTN","IBCECSA5",16,0)
 M ^TMP("IBCECSD",$J)=^TMP("IBCEOB",$J)
"RTN","IBCECSA5",17,0)
 ;
"RTN","IBCECSA5",18,0)
 ; 4/7/03 - If only 1 EOB record found for this bill, then set the
"RTN","IBCECSA5",19,0)
 ;          IBCNT variable, the IBONE one-time flag, and build the
"RTN","IBCECSA5",20,0)
 ;          detail sections of this list.
"RTN","IBCECSA5",21,0)
 I $G(VALMCNT)=1 S IBCNT=$P($G(^TMP("IBCECSD",$J,1)),U,2),IBONE=1 I IBCNT D BLD^IBCECSA6
"RTN","IBCECSA5",22,0)
 ;
"RTN","IBCECSA5",23,0)
INITQ Q
"RTN","IBCECSA5",24,0)
 ;
"RTN","IBCECSA5",25,0)
HELP ; -- help code
"RTN","IBCECSA5",26,0)
 S X="?" D DISP^XQORM1 W !!
"RTN","IBCECSA5",27,0)
 Q
"RTN","IBCECSA5",28,0)
 ;
"RTN","IBCECSA5",29,0)
EXIT ; -- exit code
"RTN","IBCECSA5",30,0)
 K ^TMP("IBCECSD",$J)
"RTN","IBCECSA5",31,0)
 D CLEAR^VALM1,CLEAN^VALM10
"RTN","IBCECSA5",32,0)
 Q
"RTN","IBCECSA5",33,0)
MIN ;
"RTN","IBCECSA5",34,0)
 N IBREC1,IBRM1,IBRM2,IBRM3,IBRM4,IBRM5,IBRL,IBTYPE,IBT,IBTX,IBD
"RTN","IBCECSA5",35,0)
 S IBTYPE=$$INPAT^IBCEF(+IBREC)
"RTN","IBCECSA5",36,0)
 I $G(IBSRC) Q:'$D(^IBM(361.1,IBCNT,4))
"RTN","IBCECSA5",37,0)
 S IB=$$SETSTR^VALM1("MEDICARE INFORMATION:","",1,50)
"RTN","IBCECSA5",38,0)
 D SET(IB)
"RTN","IBCECSA5",39,0)
 I '$G(IBSRC) D
"RTN","IBCECSA5",40,0)
 . D CNTRL^VALM10(VALMCNT,1,21,IORVON,IORVOFF)
"RTN","IBCECSA5",41,0)
 . S ^TMP("IBCECSD",$J,"X",5)=VALMCNT
"RTN","IBCECSA5",42,0)
 I '$D(^IBM(361.1,IBCNT,4)) Q
"RTN","IBCECSA5",43,0)
 I 'IBTYPE Q
"RTN","IBCECSA5",44,0)
 D SET(" INPATIENT:")
"RTN","IBCECSA5",45,0)
 S IBREC1=$G(^IBM(361.1,IBCNT,4)),(IB,IBRL)=""
"RTN","IBCECSA5",46,0)
 ;
"RTN","IBCECSA5",47,0)
 F IBT=2:1 S IBTX=$P($T(MINDAT+IBT),";",3) Q:IBTX=""  D
"RTN","IBCECSA5",48,0)
 . S IBD=$P(IBREC1,"^",+IBTX)
"RTN","IBCECSA5",49,0)
 . I $L($P(IBTX,"^",4)) X $P(IBTX,"^",4) E  N IBFULL S IBFULL=1
"RTN","IBCECSA5",50,0)
 . I $S(IBFULL:1,1:IBD) D
"RTN","IBCECSA5",51,0)
 .. I $L($P(IBTX,"^",4)) X $P(IBTX,"^",4) I  Q
"RTN","IBCECSA5",52,0)
 .. X "S IBD="_$S($L($P(IBTX,"^",3)):$P(IBTX,"^",3),1:"$$A10(IBD)")
"RTN","IBCECSA5",53,0)
 .. S IB=$$SETSTR^VALM1($P(IBTX,"^",2)_IBD,IB,$S('IBRL:4,1:37),$S('IBRL:41,1:38))
"RTN","IBCECSA5",54,0)
 .. S IBRL=$S(IBRL:0,1:1)
"RTN","IBCECSA5",55,0)
 .. I 'IBRL D SET(IB,IBRL) S IB=""
"RTN","IBCECSA5",56,0)
 ;
"RTN","IBCECSA5",57,0)
 D:IBRL'="" SET(IB)
"RTN","IBCECSA5",58,0)
 Q
"RTN","IBCECSA5",59,0)
 ;
"RTN","IBCECSA5",60,0)
MINDAT ; data for MIN tag
"RTN","IBCECSA5",61,0)
 ; format:  piece^lable^special format code^special decision for disp
"RTN","IBCECSA5",62,0)
 ;;1^Cov Days/Visit Ct  : ^$$RJ(+IBD)^I $G(IBSRC)
"RTN","IBCECSA5",63,0)
 ;;3^Claim DRG Amt      : 
"RTN","IBCECSA5",64,0)
 ;;2^Lifetm Psych Dy Ct : ^$$RJ(IBD)
"RTN","IBCECSA5",65,0)
 ;;5^Disprop Share Amt  : ^^I IBTYPE
"RTN","IBCECSA5",66,0)
 ;;4^Cap Exception Amt  : 
"RTN","IBCECSA5",67,0)
 ;;7^PPS Capital Amt    : 
"RTN","IBCECSA5",68,0)
 ;;6^MSP Pass Thru Amt  : 
"RTN","IBCECSA5",69,0)
 ;;9^PPS Cap HSP-DRG Amt: ^^I IBTYPE
"RTN","IBCECSA5",70,0)
 ;;8^PPS Cap FSP-DRG Amt: ^^I IBTYPE
"RTN","IBCECSA5",71,0)
 ;;11^Old Capital Amt    : ^^I IBTYPE
"RTN","IBCECSA5",72,0)
 ;;10^PPS Cap DSH-DRG Amt: ^^I IBTYPE
"RTN","IBCECSA5",73,0)
 ;;13^PPS Op Hos DRG Amt : 
"RTN","IBCECSA5",74,0)
 ;;12^PPS Capital IME Amt: ^^I IBTYPE
"RTN","IBCECSA5",75,0)
 ;;15^PPS Op Fed DRG Amt : ^^I IBTYPE
"RTN","IBCECSA5",76,0)
 ;;14^Cost Report Day Ct : ^$$RJ(IBD)
"RTN","IBCECSA5",77,0)
 ;;17^Indirect Teach Amt : 
"RTN","IBCECSA5",78,0)
 ;;16^PPS Cap Outlier Amt: 
"RTN","IBCECSA5",79,0)
 ;;18^Non-Pay Prof Comp  : ^$$RJ(IBD)
"RTN","IBCECSA5",80,0)
 ;;19^Non-Covered Days Ct: ^$$RJ(+IBD)^I $G(IBSRC)
"RTN","IBCECSA5",81,0)
 ;;
"RTN","IBCECSA5",82,0)
 ;
"RTN","IBCECSA5",83,0)
REMARK ; set up remarks and line level details
"RTN","IBCECSA5",84,0)
 N IBREC1,IBP,IBT,IBX
"RTN","IBCECSA5",85,0)
 S IBREC1=$S($$INPAT^IBCEF(+IBREC):$G(^IBM(361.1,IBCNT,5)),1:$P($G(^IBM(361.1,IBCNT,3)),"^",3,7))
"RTN","IBCECSA5",86,0)
 I $TR(IBREC1,U)'=""!'$G(IBSRC) D
"RTN","IBCECSA5",87,0)
 . D SET("  REMARK:")
"RTN","IBCECSA5",88,0)
 . D SET("   CODE    SHORT DESCRIPTION")
"RTN","IBCECSA5",89,0)
 . F IBP=1:1:5 I $L($P(IBREC1,"^",IBP))!($L($G(^IBM(361.1,IBCNT,"RM"_IBP)))) S IBT(IBP)=$S($L($P(IBREC1,"^",IBP)):$P(IBREC1,"^",IBP),1:"    ")_"   "_$G(^("RM"_IBP)) D TXT1(.IBT,4,79) S IBX=0 F  S IBX=$O(IBT(IBX)) Q:IBX<1  D SET(IBT(IBX))
"RTN","IBCECSA5",90,0)
 . D SET(" ")
"RTN","IBCECSA5",91,0)
MRALLA S IB=$$SETSTR^VALM1("LINE LEVEL ADJUSTMENTS:","",1,50)
"RTN","IBCECSA5",92,0)
 D SET(IB)
"RTN","IBCECSA5",93,0)
 I '$G(IBSRC) D
"RTN","IBCECSA5",94,0)
 . D CNTRL^VALM10(VALMCNT,1,23,IORVON,IORVOFF)
"RTN","IBCECSA5",95,0)
 . S ^TMP("IBCECSD",$J,"X",7)=VALMCNT
"RTN","IBCECSA5",96,0)
 I '$D(^IBM(361.1,IBCNT,15,0)) D SET("NONE") Q  ; only if there is info
"RTN","IBCECSA5",97,0)
 ;
"RTN","IBCECSA5",98,0)
 ; look up all billed data
"RTN","IBCECSA5",99,0)
 N IBZDATA,IBFORM,IBX2,IBX3,IBREC2,IBREC3,IBTX,IBT,IBRC,IBZ,IBTXL
"RTN","IBCECSA5",100,0)
 S IBFORM=0                             ; hcfa-1500
"RTN","IBCECSA5",101,0)
 I $$FT^IBCEF(+IBREC)=3 S IBFORM=1      ; ub92
"RTN","IBCECSA5",102,0)
 D F^IBCEF("N-"_$S(IBFORM:"UB92",1:"HCFA 1500")_" SERVICE LINE (EDI)","IBZDATA",,+IBREC)
"RTN","IBCECSA5",103,0)
 ;
"RTN","IBCECSA5",104,0)
 D SET("  #   SV DT   REVCD  PROC  MOD  UNITS  BILLED  DEDUCT  COINS    ALLOW     PYMT")
"RTN","IBCECSA5",105,0)
 S IBX=0 F  S IBX=$O(^IBM(361.1,IBCNT,15,IBX)) Q:IBX<1  S IBREC1=^IBM(361.1,IBCNT,15,IBX,0) D
"RTN","IBCECSA5",106,0)
 . NEW RVL
"RTN","IBCECSA5",107,0)
 . S RVL=+$P(IBREC1,U,12)       ; referenced Vista line#
"RTN","IBCECSA5",108,0)
 . I 'RVL S RVL=IBX             ; use the EOB line# if not there
"RTN","IBCECSA5",109,0)
 . S IBT=$$RJ($P(IBREC1,"^"),3) ;             line number
"RTN","IBCECSA5",110,0)
 . S IBT=IBT_" "_$$DAT1^IBOUTL($P($P(IBREC1,"^",16),".")) ; service date
"RTN","IBCECSA5",111,0)
 . S IBT=IBT_" "_$$RJ($$EXTERNAL^DILFD(361.115,.1,"",$P(IBREC1,"^",10)),6) ;                                                revcd
"RTN","IBCECSA5",112,0)
 . S IBT=IBT_" "_$$RJ($P(IBREC1,"^",4),5) ;   procedure
"RTN","IBCECSA5",113,0)
 . S IBT=IBT_" "_$$RJ($P($G(^IBM(361.1,IBCNT,15,IBX,2,1,0)),"^"),3)_$S($D(^IBM(361.1,IBCNT,15,IBX,2,2,0)):"+",1:" ") ;      modifiers
"RTN","IBCECSA5",114,0)
 . S IBT=IBT_" "_$$RJ($FN($P(IBREC1,"^",11),"",0),5) ; units
"RTN","IBCECSA5",115,0)
 . S IBT=IBT_" "_$$RJ($FN($S(IBFORM:$P($G(IBZDATA(RVL)),"^",5),1:$P($G(IBZDATA(RVL)),"^",8)*$P($G(IBZDATA(RVL)),"^",9)),"",2),8) ;    billed
"RTN","IBCECSA5",116,0)
 . S IBT=IBT_" "_$$RJ($FN($P($G(^IBM(361.1,IBCNT,15,IBX,1,+$O(^IBM(361.1,IBCNT,15,IBX,1,"B","PR",0)),1,+$O(^IBM(361.1,IBCNT,15,IBX,1,+$O(^IBM(361.1,IBCNT,15,IBX,1,"B","PR",0)),1,"B",1,0)),0)),"^",2),"",2),7) ;  deduct
"RTN","IBCECSA5",117,0)
 . S IBT=IBT_" "_$$RJ($FN($P($G(^IBM(361.1,IBCNT,15,IBX,1,+$O(^IBM(361.1,IBCNT,15,IBX,1,"B","PR",0)),1,+$O(^IBM(361.1,IBCNT,15,IBX,1,+$O(^IBM(361.1,IBCNT,15,IBX,1,"B","PR",0)),1,"B",2,0)),0)),"^",2),"",2),6) ;   coins
"RTN","IBCECSA5",118,0)
 . S IBT=IBT_" "_$$RJ($FN($P(IBREC1,"^",13),"",2),8) ; allow
"RTN","IBCECSA5",119,0)
 . S IBT=IBT_" "_$$RJ($FN($P(IBREC1,"^",3),"",2),8) ;  payment
"RTN","IBCECSA5",120,0)
 . D SET(IBT)
"RTN","IBCECSA5",121,0)
 . S IBX2=0 F  S IBX2=$O(^IBM(361.1,IBCNT,15,IBX,1,IBX2)) Q:IBX2<1  D
"RTN","IBCECSA5",122,0)
 .. S IBREC2=^IBM(361.1,IBCNT,15,IBX,1,IBX2,0),IBX3=0
"RTN","IBCECSA5",123,0)
 .. F  S IBX3=$O(^IBM(361.1,IBCNT,15,IBX,1,IBX2,1,IBX3)) Q:IBX3<1  D
"RTN","IBCECSA5",124,0)
 ... S IBREC3=^IBM(361.1,IBCNT,15,IBX,1,IBX2,1,IBX3,0)
"RTN","IBCECSA5",125,0)
 ... S IBTX(1)="ADJ: "_$P(IBREC2,"^")_"  "_$P(IBREC3,"^")_"  "_$P(IBREC3,"^",4) D TXT1(.IBTX,0,79) S IBT=0 F  S IBT=$O(IBTX(IBT)) Q:IBT<1  D SET(IBTX(IBT))
"RTN","IBCECSA5",126,0)
 ... K IBTX
"RTN","IBCECSA5",127,0)
 ... D SET("ADJ AMT: "_$FN($P(IBREC3,"^",2),"",2))
"RTN","IBCECSA5",128,0)
 . S IBRC=0
"RTN","IBCECSA5",129,0)
 . F  S IBRC=$O(^IBM(361.1,IBCNT,15,IBX,4,IBRC)) Q:'IBRC  S IBREC2=$G(^(IBRC,0)) I IBREC2 K IBTX,IBZ S IBTX(1)="  -REMARK CODE("_+IBREC2_"): ",IBTXL=$L(IBTX(1)) D
"RTN","IBCECSA5",130,0)
 .. S IBTX(1)=IBTX(1)_$P(IBREC2,U,2)_"  "_$P(IBREC2,U,3)
"RTN","IBCECSA5",131,0)
 .. I $L(IBTX(1))>79 D
"RTN","IBCECSA5",132,0)
 ... D TXT1(.IBTX,0,79) D SET(IBTX(1)) M IBZ=IBTX K IBTX S IBTX(1)="",IBT=1 F  S IBT=$O(IBZ(IBT)) Q:'IBT  S IBTX(1)=IBTX(1)_IBZ(IBT)_" "
"RTN","IBCECSA5",133,0)
 .. E  D
"RTN","IBCECSA5",134,0)
 ... S IBTXL=0
"RTN","IBCECSA5",135,0)
 .. D TXT1(.IBTX,IBTXL,79) S IBT=0 F  S IBT=$O(IBTX(IBT)) Q:IBT<1  D SET(IBTX(IBT))
"RTN","IBCECSA5",136,0)
 . D SET(" ")
"RTN","IBCECSA5",137,0)
 D SET(" ")
"RTN","IBCECSA5",138,0)
 Q
"RTN","IBCECSA5",139,0)
 ;
"RTN","IBCECSA5",140,0)
TXT(IBRM,IBLN,IBXY) ;display text over 79 chars
"RTN","IBCECSA5",141,0)
 ;IBRM - text, IBLN - length, IBXY - position
"RTN","IBCECSA5",142,0)
 S IBRM=$E(IBRM,IBLN+1,999)
"RTN","IBCECSA5",143,0)
REP I $E(IBRM,1,IBLN)'="" S IB=$$SETSTR^VALM1($E(IBRM,1,IBLN),"",IBXY,IBLN) D SET(IB) S IBRM=$E(IBRM,IBLN+1,999) G REP
"RTN","IBCECSA5",144,0)
 Q
"RTN","IBCECSA5",145,0)
 ;
"RTN","IBCECSA5",146,0)
SET(IB,IBSAV) ;
"RTN","IBCECSA5",147,0)
 I '$G(IBSAV) D SET^IBCECSA6($G(IBSRC),IB,CNT,IBCNT)
"RTN","IBCECSA5",148,0)
 Q
"RTN","IBCECSA5",149,0)
 ;
"RTN","IBCECSA5",150,0)
A10(X) ;
"RTN","IBCECSA5",151,0)
 Q $$A10^IBCECSA6(X)
"RTN","IBCECSA5",152,0)
 ;
"RTN","IBCECSA5",153,0)
A7(X) ; returns a dollar amount right justified to 7 characters
"RTN","IBCECSA5",154,0)
 Q $$RJ($FN(X,"",2),7)
"RTN","IBCECSA5",155,0)
 ;
"RTN","IBCECSA5",156,0)
TXT1(IBT,DIWL,DIWR) ; sets up text for over 79 chars
"RTN","IBCECSA5",157,0)
 ; IBT - pass by ref, array of text to be formatted back in array
"RTN","IBCECSA5",158,0)
 ; DIWL - left margin, DIWR = right margin
"RTN","IBCECSA5",159,0)
 N IBX,X,DIWF,IBS K ^UTILITY($J,"W")
"RTN","IBCECSA5",160,0)
 S DIWF="|I"_DIWL
"RTN","IBCECSA5",161,0)
 S IBX=0 F  S IBX=$O(IBT(IBX)) Q:IBX<1  S X=IBT(IBX) D ^DIWP
"RTN","IBCECSA5",162,0)
 K IBT F  S IBX=$O(^UTILITY($J,"W",DIWL,IBX)) Q:IBX<1  S IBT(IBX)=^UTILITY($J,"W",DIWL,IBX,0)
"RTN","IBCECSA5",163,0)
 K ^UTILITY($J,"W")
"RTN","IBCECSA5",164,0)
 Q
"RTN","IBCECSA5",165,0)
 ;
"RTN","IBCECSA5",166,0)
RJ(X,Y) ; right just, default is 10
"RTN","IBCECSA5",167,0)
 Q $$RJ^XLFSTR(X,$G(Y,10)," ")
"RTN","IBCECSA5",168,0)
 ;
"RTN","IBCEF74")
0^9^B64874707
"RTN","IBCEF74",1,0)
IBCEF74 ;WOIFO/SS - FORMATTER AND EXTRACTOR SPECIFIC BILL FUNCTIONS ;31-JUL-03
"RTN","IBCEF74",2,0)
 ;;2.0;INTEGRATED BILLING;**232,280**;21-MAR-94
"RTN","IBCEF74",3,0)
 ;; Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","IBCEF74",4,0)
 ;
"RTN","IBCEF74",5,0)
SORT(IBPRNUM,IBPRTYP,IB399,IBSRC,IBDST,IBN,IBEXC) ;
"RTN","IBCEF74",6,0)
 ; Only output 1 of each provider id type
"RTN","IBCEF74",7,0)
 N IBXIEN,IBXDATA,IBNET,IBTRI,IB1,IB2,IBID,Z,IBZ,IBZ1,IBSVP
"RTN","IBCEF74",8,0)
 S (IB1,IB2,IBZ,IBZ1,IBTRI)=""
"RTN","IBCEF74",9,0)
 D F^IBCEF("N-ALL ATT/RENDERING PROV SSN","IBZ",,IB399)
"RTN","IBCEF74",10,0)
 S IBZ1=$$ALLPTYP^IBCEF3(IB399)
"RTN","IBCEF74",11,0)
 F Z=1:1:3 S $P(IBZ1,U,Z)=$S($P(IBZ1,U,Z)="CH":1,1:"") S:$P(IBZ1,U,Z) IBTRI=1
"RTN","IBCEF74",12,0)
 S IBNET=0 F  S IBNET=$O(^IBE(355.97,IBNET)) S IBNET=+IBNET Q:'IBNET  I $P($G(^IBE(355.97,IBNET,1)),U,6)=1 Q  ; network id type
"RTN","IBCEF74",13,0)
 I $G(IBN) D
"RTN","IBCEF74",14,0)
 . S Z=0 F  S Z=$O(IBDST(IBPRNUM,IBPRTYP,Z)) Q:'Z  S IBID(+$P(IBDST(IBPRNUM,IBPRTYP,Z),U,9))=""
"RTN","IBCEF74",15,0)
 F  S IB1=$O(IBSRC(IB1)) Q:IB1=""  D
"RTN","IBCEF74",16,0)
 . N OK,IBSTLIC
"RTN","IBCEF74",17,0)
 . S IBSTLIC=""
"RTN","IBCEF74",18,0)
 . F  S IB2=$O(IBSRC(IB1,IB2)) Q:IB2=""  D
"RTN","IBCEF74",19,0)
 . . S IBSVP=$P(IBSRC(IB1,IB2),U)
"RTN","IBCEF74",20,0)
 . . ; Ck state of care/license match if st license #
"RTN","IBCEF74",21,0)
 . . I $P($G(IBSRC(IB1,IB2)),U,3)="0B" S OK=1 D  Q:'OK
"RTN","IBCEF74",22,0)
 . . . I +$$CAREST^IBCEP2A(IB399)'=$P(IBSRC(IB1,IB2),U,7) S IBSTLIC=1 Q
"RTN","IBCEF74",23,0)
 . . . I $G(IBSTLIC(0))'="" S OK=0 Q
"RTN","IBCEF74",24,0)
 . . . S IBSTLIC(0)=$G(IBSRC(IB1,IB2)),OK=0
"RTN","IBCEF74",25,0)
 . . ; If ID is overridden in claim, don't output any others of this type
"RTN","IBCEF74",26,0)
 . . I $G(IBEXC),$P($G(IBSRC(IB1,IB2)),U,8)=IBEXC Q
"RTN","IBCEF74",27,0)
 . . ; EXCLUDE SSN FROM SECONDARY IDS
"RTN","IBCEF74",28,0)
 . . I $P($G(IBSRC(IB1,IB2)),U,3)="SY" Q
"RTN","IBCEF74",29,0)
 . . ; Only 1 of each provider id type allowed
"RTN","IBCEF74",30,0)
 . . Q:$D(IBID(+$P($G(IBSRC(IB1,IB2)),U,9)))
"RTN","IBCEF74",31,0)
 . . S IBN=IBN+1,IBID(+$P($G(IBSRC(IB1,IB2)),U,9))=""
"RTN","IBCEF74",32,0)
 . . S IBDST(IBPRNUM,IBPRTYP,IBN)=$G(IBSRC(IB1,IB2))
"RTN","IBCEF74",33,0)
 . I $G(IBID(IBNET))="",IBTRI,$P(IBZ1,U,$$COBN^IBCEF(IB399)) D
"RTN","IBCEF74",34,0)
 . . Q:$P(IBZ,U,IBPRTYP)=""
"RTN","IBCEF74",35,0)
 . . ; to get here, no network id exists and this is a TRICARE ins co.
"RTN","IBCEF74",36,0)
 . . S IBN=IBN+1,IBDST(IBPRNUM,IBPRTYP,IBN)=IBSVP_U_IB1_U_$P($G(^IBE(355.97,IBNET,0)),U,3)_U_$P(IBZ,U,IBPRTYP)_U_"0^0^^^"_IBNET
"RTN","IBCEF74",37,0)
 . I '$G(IBSTLIC),$G(IBSTLIC(0))'="" S IBN=IBN+1,IBDST(IBPRNUM,IBPRTYP,IBN)=IBSTLIC(0)
"RTN","IBCEF74",38,0)
 Q
"RTN","IBCEF74",39,0)
 ;
"RTN","IBCEF74",40,0)
 ;-- PROVINF --
"RTN","IBCEF74",41,0)
 ;Create an array with provider information
"RTN","IBCEF74",42,0)
 ;Input:
"RTN","IBCEF74",43,0)
 ; IB399 - ien of #399
"RTN","IBCEF74",44,0)
 ; IBPRNUM - 1=primary ins, 2= sec, 3 -tert
"RTN","IBCEF74",45,0)
 ; IBRES - for results
"RTN","IBCEF74",46,0)
 ; IBSORT - to sort OTHER INSURANCE data 
"RTN","IBCEF74",47,0)
 ;  if PROVINF is called for "C" mode of PROVIDER subroutine then 
"RTN","IBCEF74",48,0)
 ;    the IBSORT can be any (say 1)
"RTN","IBCEF74",49,0)
 ;  if PROVINF is called for "O" mode then it can be more then set
"RTN","IBCEF74",50,0)
 ;    of data then we need to sort array to use it in loop 
"RTN","IBCEF74",51,0)
 ;    (like IBXDATA(1) and IBXDATA(2))
"RTN","IBCEF74",52,0)
 ;    thus for mode "O" it should be 1 or 2 (see PROVIDER for example)
"RTN","IBCEF74",53,0)
 ;IBINSTP -  "C" -current insurance , "O"-other
"RTN","IBCEF74",54,0)
 ;Output:
"RTN","IBCEF74",55,0)
 ; IBRES(PRNUM,PRTYPE,SEQ#)=PROV^INSUR^IDTYPE^ID^FORMTYP^CARETYP
"RTN","IBCEF74",56,0)
 ; where:(see PROVIDER)
"RTN","IBCEF74",57,0)
PROVINF(IB399,IBPRNUM,IBRES,IBSORT,IBINSTP) ;
"RTN","IBCEF74",58,0)
 I +$G(IBSORT)=0 S IBSORT=IBPRNUM
"RTN","IBCEF74",59,0)
 N IBPRTYP,IBINSCO,IBPROV,IBFRMTYP,IBCARE,IB35591,IBN,IBCURR,IBEXC S IBN=0
"RTN","IBCEF74",60,0)
 S IBINSCO=+$P($G(^DGCR(399,IB399,"M")),"^",IBPRNUM)
"RTN","IBCEF74",61,0)
 S IBFRMTYP=$$FT^IBCEF(IB399),IBFRMTYP=$S(IBFRMTYP=2:2,IBFRMTYP=3:1,1:0)
"RTN","IBCEF74",62,0)
 S IBCARE=$S($$ISRX^IBCEF1(IB399):3,1:0) ;if bill is a prescription refill bill
"RTN","IBCEF74",63,0)
 S:IBCARE=0 IBCARE=$$INPAT^IBCEF(IB399,1) S:'IBCARE IBCARE=2 ;1-inp,2-out
"RTN","IBCEF74",64,0)
 F IBPRTYP=1:1:9 D
"RTN","IBCEF74",65,0)
 . N Z,IB355OV
"RTN","IBCEF74",66,0)
 . S IBPROV=$$PROVPTR^IBCEF7(IB399,IBPRTYP)
"RTN","IBCEF74",67,0)
 . Q:+IBPROV=0
"RTN","IBCEF74",68,0)
 . ;don't create anything if the form type is different than "HCFA 1500" or "UB-92"
"RTN","IBCEF74",69,0)
 . Q:IBFRMTYP=0
"RTN","IBCEF74",70,0)
 . N IBRETARR S IBRETARR=0
"RTN","IBCEF74",71,0)
 . D PRACT^IBCEF71(IBINSCO,IBFRMTYP,IBCARE,IBPROV,.IBRETARR,IBPRTYP,$G(IBINSTP))
"RTN","IBCEF74",72,0)
 . S IB355OV="",IBEXC=""
"RTN","IBCEF74",73,0)
 . S Z=$O(^DGCR(399,IB399,"PRV","B",IBPRTYP,0))
"RTN","IBCEF74",74,0)
 . I Z S Z=$G(^DGCR(399,IB399,"PRV",Z,0)) D
"RTN","IBCEF74",75,0)
 .. I $P(Z,U,IBPRNUM+4)'="",$P(Z,U,IBPRNUM+11)'="" S IB355OV=$P(Z,U,IBPRNUM+4)_U_$P(Z,U,IBPRNUM+11)
"RTN","IBCEF74",76,0)
 . S IBCURR=$$COB^IBCEF(IB399)
"RTN","IBCEF74",77,0)
 . S IBN=0,IB35591=$$CH35591^IBCEF72(IBINSCO,IBFRMTYP,IBCARE)
"RTN","IBCEF74",78,0)
 . I $G(IBINSTP)="C","34"[$G(IBPRTYP),"P"[$G(IBCURR),$G(IBFRMTYP)=2,$$MCRONBIL^IBEFUNC(IB399) S IB355OV=$$MCR24K^IBCEU3(IB399)_"^12"
"RTN","IBCEF74",79,0)
 . I $G(IBINSTP)="O","34"[$G(IBPRTYP),"ST"[$G(IBCURR),$G(IBFRMTYP)=2,$$MCRONBIL^IBEFUNC(IB399) S IB355OV=$$MCR24K^IBCEU3(IB399)_"^12" ;Calculate MEDICARE (WNR) specific provider qualifier and ID for HCFA 1500 secondary claims
"RTN","IBCEF74",80,0)
 . I $P(IB355OV,U,2) D
"RTN","IBCEF74",81,0)
 .. I $$CHCKSEC^IBCEF73(IBFRMTYP,IBPRTYP,$G(IBINSTP),$P($G(^IBE(355.97,+$P(IB355OV,U,2),0)),U,3)) D
"RTN","IBCEF74",82,0)
 ... S IBEXC=$P(IB355OV,U,2),IBN=IBN+1,IBRES(IBSORT,IBPRTYP,IBN)="OVERRIDE^"_IBINSCO_U_$P($G(^IBE(355.97,+IBEXC,0)),U,3)_U_$P(IB355OV,U)_"^^^^^"_+IBEXC
"RTN","IBCEF74",83,0)
 . I IB35591'="",IBEXC'=$P(IB35591,U,3) S:$$CHCKSEC^IBCEF73(IBFRMTYP,IBPRTYP,$G(IBINSTP),$P(IB35591,"^")) IBN=IBN+1,IBRES(IBSORT,IBPRTYP,IBN)="DEFAULT^"_IBINSCO_"^"_IB35591_"^^",$P(IBRES(IBSORT,IBPRTYP,IBN),U,9)=$P(IB35591,U,3)
"RTN","IBCEF74",84,0)
 . D SORT^IBCEF71(IBSORT,IBPRTYP,IB399,.IBRETARR,.IBRES,IBN,IBEXC)
"RTN","IBCEF74",85,0)
 S IBRES(IBSORT)=$S(IBPRNUM=3:"T",IBPRNUM=2:"S",1:"P")
"RTN","IBCEF74",86,0)
 Q
"RTN","IBCEF74",87,0)
 ;
"RTN","IBCEF74",88,0)
SECIDCK(IBIFN,IBSEQ,IBTYP,IBIFN1) ; Function returns 1 if ID type ptr in
"RTN","IBCEF74",89,0)
 ;  IBTYP is a valid X12 code for the claim/provider function (IBPROVF)
"RTN","IBCEF74",90,0)
 ;  as a secondary id
"RTN","IBCEF74",91,0)
 ; IBSEQ = the COB sequence being checked
"RTN","IBCEF74",92,0)
 ; IBIFN1 = the entry # in the PRV multiple being checked
"RTN","IBCEF74",93,0)
 ;  Called from input transform of fields .12-.14 in subfile 399.0222
"RTN","IBCEF74",94,0)
 N IBOK,IBFRM,IBCOBN,IBX12,IBPROVF
"RTN","IBCEF74",95,0)
 S IBPROVF=+$G(^DGCR(399,IBIFN,"PRV",IBIFN1,0))
"RTN","IBCEF74",96,0)
 S IBFRM=$$FT^IBCEF(IBIFN),IBFRM=$S(IBFRM=3:1,1:2) ; Form type
"RTN","IBCEF74",97,0)
 S IBCOBN=$$COBN^IBCEF(IBIFN) S:'IBCOBN IBCOBN=1 ; Current COB seq
"RTN","IBCEF74",98,0)
 S IBX12=$P($G(^IBE(355.97,+IBTYP,0)),U,3) ; X12 code for prov id typ
"RTN","IBCEF74",99,0)
 Q $$CHSEC^IBCEF73(IBFRM,IBPROVF,$S(IBSEQ=IBCOBN:"C",1:"O"),IBX12)
"RTN","IBCEF74",100,0)
 ;
"RTN","IBCEF74",101,0)
DEFID(IBIFN,IBPRV) ;
"RTN","IBCEF74",102,0)
 ; IBIFN = ien of bill
"RTN","IBCEF74",103,0)
 ; IBPRV = ien of entry in subfile 399.0222
"RTN","IBCEF74",104,0)
 ;  Function returns default ids: prim id def^sec id def^tert id def
"RTN","IBCEF74",105,0)
 N Z,Z1,ID,IBZ,IBINS,IBINS4,IBFRM
"RTN","IBCEF74",106,0)
 D F^IBCEF("N-ALL ATT/REND PROV SSN/EI","IBZ","",IBIFN)
"RTN","IBCEF74",107,0)
 S Z=$G(^DGCR(399,IBIFN,"PRV",IBPRV,0)),ID=$P(Z,U,5,7)
"RTN","IBCEF74",108,0)
 S IBFRM=$$FT^IBCEF(IBIFN),IBFRM=$S(IBFRM=3:1,1:2)
"RTN","IBCEF74",109,0)
 F Z1=1:1:3 I $P(ID,U,Z1)="" D
"RTN","IBCEF74",110,0)
 . Q:'$G(^DGCR(399,IBIFN,"I"_Z1))
"RTN","IBCEF74",111,0)
 . S $P(ID,U,Z1)=$$GETID^IBCEP2(IBIFN,2,$P(Z,U,2),Z1)
"RTN","IBCEF74",112,0)
 . I $P(ID,U,Z1)="" S $P(ID,U,Z1)=$P(IBZ,U,+Z)
"RTN","IBCEF74",113,0)
 Q ID
"RTN","IBCEF74",114,0)
 ;
"RTN","IBCEF74",115,0)
DISPID(IBXIEN) ; Displays a list of all provider and facility ids that will
"RTN","IBCEF74",116,0)
 ; extracted for this bill if it is transmitted electronically
"RTN","IBCEF74",117,0)
 N IBID,IBID1,IBZ,IBCT,IBFRM,IBCOBN,IBATT,IBQUIT,IBTYP,DIR,IBIFN,X,Y,Z,Z0,Z1
"RTN","IBCEF74",118,0)
 S IBIFN=IBXIEN
"RTN","IBCEF74",119,0)
 S IBFRM=$$FT^IBCEF(IBIFN),IBCOBN=$$COBN^IBCEF(IBIFN),IBATT=$S(IBFRM=2:3,1:4)
"RTN","IBCEF74",120,0)
 W @IOF
"RTN","IBCEF74",121,0)
 W !,"IF THIS BILL IS TRANSMITTED ELECTRONICALLY, THE FOLLOWING IDS WILL BE SENT:"
"RTN","IBCEF74",122,0)
 ; Returns all provider secondary ids to be transmitted in the indicated segments
"RTN","IBCEF74",123,0)
 S Z=+$G(^DGCR(399,IBIFN,"I1")) I Z W !,"  PRIMARY INS CO: ",$$EXTERNAL^DILFD(399,101,"",Z),$S(IBCOBN=1:" <<<Current Ins",1:"")
"RTN","IBCEF74",124,0)
 S Z=+$G(^DGCR(399,IBIFN,"I2")) I Z W !,"SECONDARY INS CO: ",$$EXTERNAL^DILFD(399,101,"",Z),$S(IBCOBN=2:" <<<Current Ins",1:"")
"RTN","IBCEF74",125,0)
 S Z=+$G(^DGCR(399,IBIFN,"I3")) I Z W !," TERTIARY INS CO: ",$$EXTERNAL^DILFD(399,101,"",Z),$S(IBCOBN=3:" <<<Current Ins",1:"")
"RTN","IBCEF74",126,0)
 W !!,"PROVIDER IDs: (VISTA RECORDS OP1,OP2,OP4,OP8,OP9,OPR2,OPR3,OPR4,OPR5,OPR8):"
"RTN","IBCEF74",127,0)
 F Z=1:1:3 I $G(^DGCR(399,IBIFN,"I"_Z)) D PROVINF^IBCEF74(IBIFN,Z,.IBID,"",$S(IBCOBN=Z:"C",1:"O"))
"RTN","IBCEF74",128,0)
 S Z=0 F  S Z=$O(IBID(Z)) Q:'Z  S Z0=0 F  S Z0=$O(IBID(Z,Z0)) Q:'Z0  S Z1=0 F  S Z1=$O(IBID(Z,Z0,Z1)) Q:'Z1  I $P(IBID(Z,Z0,Z1),U,9) S IBID1(Z0,Z,Z1)=IBID(Z,Z0,Z1)
"RTN","IBCEF74",129,0)
 S Z=+$O(^DGCR(399,IBIFN,"PRV","B",IBATT,0))
"RTN","IBCEF74",130,0)
 I Z S Z=$P($G(^DGCR(399,IBIFN,"PRV",Z,0)),U,2)
"RTN","IBCEF74",131,0)
 W !,?5,"ATTENDING/RENDERING: ",$$EXTERNAL^DILFD(399.0222,.02,"",Z)
"RTN","IBCEF74",132,0)
 D F^IBCEF("N-ALL ATT/REND PROV SSN/EI","IBZ","",IBIFN)
"RTN","IBCEF74",133,0)
 W !,?8,"SSN: ",?35,$S($P(IBZ,U,IBATT)'="":$P(IBZ,U,IBATT),1:"***MISSING***")
"RTN","IBCEF74",134,0)
 I $O(IBID1(IBATT,0)) W !,?8,"SECONDARY IDs"
"RTN","IBCEF74",135,0)
 S IBQUIT=0
"RTN","IBCEF74",136,0)
 S Z0=0 F  S Z0=$O(IBID1(IBATT,Z0)) Q:'Z0!IBQUIT  K IBTYP S Z1=0 F  S Z1=$O(IBID1(IBATT,Z0,Z1)) Q:'Z1  D  Q:IBQUIT
"RTN","IBCEF74",137,0)
 . Q:$D(IBTYP(+$P(IBID1(IBATT,Z0,Z1),U,9)))  ;1st of each type transmits
"RTN","IBCEF74",138,0)
 . I ($Y+5)>IOSL S IBQUIT=$$NOMORE() Q:IBQUIT
"RTN","IBCEF74",139,0)
 . S IBTYP(+$P(IBID1(IBATT,Z0,Z1),U,9))=""
"RTN","IBCEF74",140,0)
 . W !,?8,"(",$E("PST",Z0),") ",$$EXTERNAL^DILFD(36,4.01,"",$P(IBID1(IBATT,Z0,Z1),U,9)),?35,$P(IBID1(IBATT,Z0,Z1),U,4)
"RTN","IBCEF74",141,0)
 S Z=0 F  S Z=$O(IBID1(Z)) Q:'Z  I Z<3!(Z>4) D  Q:IBQUIT
"RTN","IBCEF74",142,0)
 . N Q
"RTN","IBCEF74",143,0)
 . S Q=+$O(^DGCR(399,IBIFN,"PRV","B",Z,0))
"RTN","IBCEF74",144,0)
 . W !!,?5,$$EXTERNAL^DILFD(399.0222,.01,"",Q),": "_$$EXTERNAL^DILFD(399.0222,.02,"",$P($G(^DGCR(399,IBIFN,"PRV",Q,0)),U,2))
"RTN","IBCEF74",145,0)
 . S Z0=0 F  S Z0=$O(IBID1(Z,Z0)) Q:'Z0!IBQUIT  K IBTYP S Z1=0 F  S Z1=$O(IBID1(Z,Z0,Z1)) Q:'Z1!IBQUIT  D
"RTN","IBCEF74",146,0)
 .. Q:$D(IBTYP(+$P(IBID1(Z,Z0,Z1),U,9)))  ; 1st of each type transmits
"RTN","IBCEF74",147,0)
 .. I ($Y+5)>IOSL S IBQUIT=$$NOMORE() Q:IBQUIT
"RTN","IBCEF74",148,0)
 .. S IBTYP(+$P(IBID1(Z,Z0,Z1),U,9))=""
"RTN","IBCEF74",149,0)
 .. W !,?8,"(",$E("PST",Z0),") ",$$EXTERNAL^DILFD(36,4.01,"",$P(IBID1(Z,Z0,Z1),U,9)),?35,$P(IBID1(Z,Z0,Z1),U,4)
"RTN","IBCEF74",150,0)
 S DIR(0)="EA",DIR("A")="PRESS RETURN TO CONTINUE " W ! D ^DIR K DIR
"RTN","IBCEF74",151,0)
 Q
"RTN","IBCEF74",152,0)
 ;
"RTN","IBCEF74",153,0)
NOMORE() ;
"RTN","IBCEF74",154,0)
 S DIR(0)="EA",DIR("A")="Press RETURN for more IDs or '^' to exit: " W ! D ^DIR
"RTN","IBCEF74",155,0)
 W @IOF
"RTN","IBCEF74",156,0)
 Q (Y'=1)
"RTN","IBCEF74",157,0)
 ;
"RTN","IBCEF74",158,0)
DEFSEC(IBIFN,IBARR) ; Function returns an array in IBARR for default
"RTN","IBCEF74",159,0)
 ; provider secondary ids for bill ien IBIFN
"RTN","IBCEF74",160,0)
 ; IBARR if passed by ref is returned as 
"RTN","IBCEF74",161,0)
 ;     IBARR(prov function,COBN)=default id
"RTN","IBCEF74",162,0)
 N IBCAR,IBCOBN,IBPC,IBINS,IBARRX,Q,Z,Z0,ZINS,X
"RTN","IBCEF74",163,0)
 K IBARR
"RTN","IBCEF74",164,0)
 S ZINS="",IBCOBN=$$COBN^IBCEF(IBIFN),IBPC=$S($$FT^IBCEF(IBIFN)=3:2,1:1)
"RTN","IBCEF74",165,0)
 S IBCAR=$$INPAT^IBCEF(IBIFN,1),IBCAR=$S('IBCAR:2,1:1)
"RTN","IBCEF74",166,0)
 F Z=1:1:3 S ZINS=ZINS_+$G(^DGCR(399,IBIFN,"I"_Z))_U
"RTN","IBCEF74",167,0)
 F Z=1:1:3 I $P(ZINS,U,Z),'$P($G(^DIC(36,+$P(ZINS,U,Z),4)),U,IBPC) S $P(ZINS,U,Z)=""
"RTN","IBCEF74",168,0)
 S Z=0 F  S Z=$O(^DGCR(399,IBIFN,"PRV",Z)) Q:'Z  S Z0=$G(^(Z,0)) D
"RTN","IBCEF74",169,0)
 . F Q=1:1:3 D
"RTN","IBCEF74",170,0)
 .. I $P(Z0,U,Q+4)'="" S IBARR(+Z0,Q)=$P(Z0,U,Q+4) Q  ; Override entered
"RTN","IBCEF74",171,0)
 .. S IBINS=$P(ZINS,U,Q)
"RTN","IBCEF74",172,0)
 .. Q:'IBINS
"RTN","IBCEF74",173,0)
 .. S X=$$IDFIND^IBCEP2(IBIFN,"",$P(Z0,U,2),Q,1)
"RTN","IBCEF74",174,0)
 .. I X'="" S IBARR(+Z0,Q)=X
"RTN","IBCEF74",175,0)
 Q
"RTN","IBCEF74",176,0)
 ;
"RTN","IBCEOB0")
0^7^B78247980
"RTN","IBCEOB0",1,0)
IBCEOB0 ;ALB/TMP - 835 EDI EOB MSG PROCESSING ;18-FEB-99
"RTN","IBCEOB0",2,0)
 ;;2.0;INTEGRATED BILLING;**135,280**;21-MAR-94
"RTN","IBCEOB0",3,0)
 Q
"RTN","IBCEOB0",4,0)
 ;
"RTN","IBCEOB0",5,0)
 ; For numeric entrypoints below, the following parameters are defined:
"RTN","IBCEOB0",6,0)
 ; IB0 = record being processed
"RTN","IBCEOB0",7,0)
 ; IBEOB = ien of EOB entry in 361.1
"RTN","IBCEOB0",8,0)
 ; IBOK = Returned as 1 if record filed OK, 0 if error
"RTN","IBCEOB0",9,0)
 ;
"RTN","IBCEOB0",10,0)
40(IB0,IBEOB,IBOK) ; Process record type 40 for EOB
"RTN","IBCEOB0",11,0)
 ; Parameters defined at top of routine
"RTN","IBCEOB0",12,0)
 ;
"RTN","IBCEOB0",13,0)
 ; IBZDATA is also assumed to exist or if not, is created in FINDLN
"RTN","IBCEOB0",14,0)
 ;
"RTN","IBCEOB0",15,0)
 N A,LEVEL,IBSEQ,IBDA,IBPC,IBLREF,IBIFN,Q,X,Y,DA,DD,DO,DIC,DLAYGO
"RTN","IBCEOB0",16,0)
 K ^TMP($J,40) ; the entry # for corresponding 41, 42, 45 records
"RTN","IBCEOB0",17,0)
 ;
"RTN","IBCEOB0",18,0)
 S IBIFN=+$G(^IBM(361.1,IBEOB,0))
"RTN","IBCEOB0",19,0)
 L +^IBM(361.1,IBEOB,15):0 I $T S IBSEQ=+$O(^IBM(361.1,IBEOB,15," "),-1)+1
"RTN","IBCEOB0",20,0)
 I '$G(IBSEQ) S ^TMP(IBEGBL,$J,+$O(^TMP(IBEGBL,$J,""),-1)+1)="Record lock failure - could not acquire next service line number" G Q40
"RTN","IBCEOB0",21,0)
 ;
"RTN","IBCEOB0",22,0)
 ; Update the 40 record data a little bit (pieces 3/4/16)
"RTN","IBCEOB0",23,0)
 I $P(IB0,U,21)="NU" S $P(IB0,U,4)=$P(IB0,U,3),$P(IB0,U,3)=""
"RTN","IBCEOB0",24,0)
 S $P(IB0,U,16)=$S(+$P(IB0,U,16):$P(IB0,U,16)/100,1:+$P(IB0,U,18)/100)
"RTN","IBCEOB0",25,0)
 I $P(IB0,U,4)?1.N S $P(IB0,U,4)=+$P(IB0,U,4)
"RTN","IBCEOB0",26,0)
 ;
"RTN","IBCEOB0",27,0)
 ; Find the line item from orig bill for this adjustment
"RTN","IBCEOB0",28,0)
 S IBLREF=+$$FINDLN^IBCEOB1(IB0,IBEOB,.IBZDATA)
"RTN","IBCEOB0",29,0)
 I 'IBLREF D  G Q40
"RTN","IBCEOB0",30,0)
 . N Z,Z0,CT
"RTN","IBCEOB0",31,0)
 . S ^TMP(IBEGBL,$J,+$O(^TMP(IBEGBL,$J,""),-1)+1)="Service line detail could not be matched to a billed item"
"RTN","IBCEOB0",32,0)
 . D DET40(IB0,.Z0)
"RTN","IBCEOB0",33,0)
 . S CT=+$O(^TMP(IBEGBL,$J,""),-1),Z=0 F  S Z=$O(Z0(Z)) Q:'Z  S CT=CT+1,^TMP(IBEGBL,$J,CT)=Z0(Z)
"RTN","IBCEOB0",34,0)
 ;
"RTN","IBCEOB0",35,0)
 S DIC="^IBM(361.1,"_IBEOB_",15,",DIC(0)="L",DLAYGO=361.115,DA(1)=IBEOB
"RTN","IBCEOB0",36,0)
 S X=IBSEQ
"RTN","IBCEOB0",37,0)
 S DIC("DR")=".12////"_+IBLREF_$S($P(IBLREF,U,2)="":"",1:";.15////"_$P(IBLREF,U,2))_";.16////"_$$DATE^IBCEU($P(IB0,U,19))_$S($P(IB0,U,20):";.17////"_$$DATE^IBCEU($P(IB0,U,20)),1:"")
"RTN","IBCEOB0",38,0)
 D FILE^DICN K DIC,DO,DD,DLAYGO ;Add a new LINE LEVEL ADJUSTMENT ('SVC')
"RTN","IBCEOB0",39,0)
 I Y<0 S ^TMP(IBEGBL,$J,+$O(^TMP(IBEGBL,$J,""),-1)+1)="Could not add a LINE LEVEL ADJUSTMENT ("_IBSEQ_")" G Q40
"RTN","IBCEOB0",40,0)
 ;
"RTN","IBCEOB0",41,0)
 L -^IBM(361.1,IBEOB,15)
"RTN","IBCEOB0",42,0)
 ;
"RTN","IBCEOB0",43,0)
 S LEVEL=15.1,LEVEL(0)=+Y,LEVEL(1)=IBEOB,LEVEL("DIE")="^IBM(361.1,"_IBEOB_",15,"
"RTN","IBCEOB0",44,0)
 S A="3;.04;0;0;0^4;.1;0;0;0^9;.09;0;0;0^17;.03;1;0;0^18;.11;0;1;D2^21;.18;0;0;0"
"RTN","IBCEOB0",45,0)
 I $$STORE^IBCEOB1(A,IB0,IBEOB,.LEVEL) S ^TMP($J,40)=LEVEL(0),IBOK=1
"RTN","IBCEOB0",46,0)
 I '$G(IBOK) S ^TMP(IBEGBL,$J,+$O(^TMP(IBEGBL,$J,""),-1)+1)="Bad data for line level adjustment "_IBSEQ G Q40
"RTN","IBCEOB0",47,0)
 ;
"RTN","IBCEOB0",48,0)
 ; Store modifiers
"RTN","IBCEOB0",49,0)
 S DIC="^IBM(361.1,"_IBEOB_",15,"_LEVEL(0)_",2,",DIC(0)="L",DLAYGO=361.1152,DA(2)=IBEOB,DA(1)=LEVEL(0)
"RTN","IBCEOB0",50,0)
 F Q=5:1:8 S X=$P(IB0,U,Q) I X'="" D FILE^DICN K DO,DD I Y<0 S IBOK=0 Q
"RTN","IBCEOB0",51,0)
 K DLAYGO,DIC,DR,DA
"RTN","IBCEOB0",52,0)
 I '$G(IBOK) S ^TMP(IBEGBL,$J,+$O(^TMP(IBEGBL,$J,""),-1)+1)="Could not file modifier data for line level adjustment "_IBSEQ G Q40
"RTN","IBCEOB0",53,0)
Q40 Q
"RTN","IBCEOB0",54,0)
 ;
"RTN","IBCEOB0",55,0)
 ;
"RTN","IBCEOB0",56,0)
41(IB0,IBEOB,IBOK) ; Process record type 41 for EOB
"RTN","IBCEOB0",57,0)
 ; Parameters defined at top of routine
"RTN","IBCEOB0",58,0)
 ;
"RTN","IBCEOB0",59,0)
 N DA,DR,DIE,X,Y,Z,Z0,CT
"RTN","IBCEOB0",60,0)
 I '$G(^TMP($J,40)) D  G Q41
"RTN","IBCEOB0",61,0)
 . S ^TMP(IBEGBL,$J,+$O(^TMP(IBEGBL,$J,""),-1)+1)="Service line adjustment has no corresponding service line"
"RTN","IBCEOB0",62,0)
 . D DET4X(41,IB0,.Z0)
"RTN","IBCEOB0",63,0)
 . S CT=+$O(^TMP(IBEGBL,$J,""),-1),Z=0 F  S Z=$O(Z0(Z)) Q:'Z  S CT=CT+1,^TMP(IBEGBL,$J,CT)=Z0(Z)
"RTN","IBCEOB0",64,0)
 ;
"RTN","IBCEOB0",65,0)
 S DR="",IBOK=1
"RTN","IBCEOB0",66,0)
 S DA=+^TMP($J,40),DA(1)=IBEOB
"RTN","IBCEOB0",67,0)
 S DIE="^IBM(361.1,"_DA(1)_",15,"
"RTN","IBCEOB0",68,0)
 I +$P(IB0,U,3) S DR=".13///"_$$DOLLAR^IBCEOB($P(IB0,U,3))
"RTN","IBCEOB0",69,0)
 I +$P(IB0,U,4) S DR=DR_$S(DR="":"",1:";")_".14///"_$$DOLLAR^IBCEOB($P(IB0,U,4))
"RTN","IBCEOB0",70,0)
 I DR'="" D ^DIE S IBOK=($D(Y)=0)
"RTN","IBCEOB0",71,0)
 I '$G(IBOK) S ^TMP(IBEGBL,$J,+$O(^TMP(IBEGBL,$J,""),-1)+1)="Bad data for service line adjustment-2"
"RTN","IBCEOB0",72,0)
Q41 Q
"RTN","IBCEOB0",73,0)
 ;
"RTN","IBCEOB0",74,0)
42(IB0,IBEOB,IBOK) ; Process record type 42 for EOB 
"RTN","IBCEOB0",75,0)
 ; Parameters defined at top of routine
"RTN","IBCEOB0",76,0)
 ;
"RTN","IBCEOB0",77,0)
 N DO,DD,DLAYGO,DIC,DA,X,Y,Z,Z0,CT
"RTN","IBCEOB0",78,0)
 S IBOK=0
"RTN","IBCEOB0",79,0)
 I '$G(^TMP($J,40)) D  G Q42
"RTN","IBCEOB0",80,0)
 . S ^TMP(IBEGBL,$J,+$O(^TMP(IBEGBL,$J,""),-1)+1)="Service line adjustment has no corresponding service line"
"RTN","IBCEOB0",81,0)
 . D DET4X(42,IB0,.Z0)
"RTN","IBCEOB0",82,0)
 . S CT=+$O(^TMP(IBEGBL,$J,""),-1),Z=0 F  S Z=$O(Z0(Z)) Q:'Z  S CT=CT+1,^TMP(IBEGBL,$J,CT)=Z0(Z)
"RTN","IBCEOB0",83,0)
 ;
"RTN","IBCEOB0",84,0)
 K DO,DD,DLAYGO
"RTN","IBCEOB0",85,0)
 S DR="",IBOK=1
"RTN","IBCEOB0",86,0)
 S DA(1)=+^TMP($J,40),DA(2)=IBEOB
"RTN","IBCEOB0",87,0)
 S X=+$O(^IBM(361.1,DA(2),15,DA(1),4," "),-1)+1,DIC="^IBM(361.1,"_DA(2)_",15,"_DA(1)_",4,",DIC(0)="L",DLAYGO=361.1154
"RTN","IBCEOB0",88,0)
 S DIC("DR")=$S($P(IB0,U,3)'="":".02////"_$P(IB0,U,3),1:"")
"RTN","IBCEOB0",89,0)
 S DIC("DR")=DIC("DR")_$S($P(IB0,U,4)'="":$S($L(DIC("DR")):";",1:"")_".03////"_$TR($P(IB0,U,4),";"," "))
"RTN","IBCEOB0",90,0)
 D FILE^DICN K DO,DD,DLAYGO
"RTN","IBCEOB0",91,0)
 I Y'>0 S IBOK=0
"RTN","IBCEOB0",92,0)
 I '$G(IBOK) S ^TMP(IBEGBL,$J,+$O(^TMP(IBEGBL,$J,""),-1)+1)="Bad data for service line adjustment-3"
"RTN","IBCEOB0",93,0)
Q42 Q
"RTN","IBCEOB0",94,0)
 ;
"RTN","IBCEOB0",95,0)
45(IB0,IBEOB,IBOK) ; Process record type 45 for EOB 
"RTN","IBCEOB0",96,0)
 ; Parameters defined at top of routine
"RTN","IBCEOB0",97,0)
 ;
"RTN","IBCEOB0",98,0)
 N IBDA,LEVEL,A,Z0,CT,Z
"RTN","IBCEOB0",99,0)
 I '$G(^TMP($J,40)) D  G Q45
"RTN","IBCEOB0",100,0)
 . S ^TMP(IBEGBL,$J,+$O(^TMP(IBEGBL,$J,""),-1)+1)="Service line adjustment has no corresponding service line"
"RTN","IBCEOB0",101,0)
 . D DET4X(45,IB0,.Z0)
"RTN","IBCEOB0",102,0)
 . S CT=+$O(^TMP(IBEGBL,$J,""),-1),Z=0 F  S Z=$O(Z0(Z)) Q:'Z  S CT=CT+1,^TMP(IBEGBL,$J,CT)=Z0(Z)
"RTN","IBCEOB0",103,0)
 ;
"RTN","IBCEOB0",104,0)
 I $P(IB0,U,3)'="" S $P(^TMP($J,40),U,2)=$P(IB0,U,3)
"RTN","IBCEOB0",105,0)
 I $P(IB0,U,3)="" S $P(IB0,U,3)=$P(^TMP($J,40),U,2)
"RTN","IBCEOB0",106,0)
 I $P(IB0,U,3)="" S ^TMP(IBEGBL,$J,+$O(^TMP(IBEGBL,$J,""),-1)+1)="Service line adjustment is missing its group code" G Q45
"RTN","IBCEOB0",107,0)
 ;
"RTN","IBCEOB0",108,0)
 S IBDA(2)=+^TMP($J,40)
"RTN","IBCEOB0",109,0)
 S IBDA(1)=+$O(^IBM(361.1,IBEOB,15,IBDA(2),1,"B",$P(IB0,U,3),0))
"RTN","IBCEOB0",110,0)
 ;
"RTN","IBCEOB0",111,0)
 I 'IBDA(1) D  ;Needs a new entry at group level
"RTN","IBCEOB0",112,0)
 . N X,Y,DA,DD,DO,DIC,DLAYGO
"RTN","IBCEOB0",113,0)
 . S DIC="^IBM(361.1,"_IBEOB_",15,"_IBDA(2)_",1,",DIC(0)="L",DLAYGO=361.1151,DA(2)=IBEOB,DA(1)=IBDA(2)
"RTN","IBCEOB0",114,0)
 . S DIC("P")=$$GETSPEC^IBEFUNC(361.115,1)
"RTN","IBCEOB0",115,0)
 . S X=$P(IB0,U,3)
"RTN","IBCEOB0",116,0)
 . D FILE^DICN K DIC,DO,DD,DLAYGO
"RTN","IBCEOB0",117,0)
 . I Y<0 K IBDA S ^TMP(IBEGBL,$J,+$O(^TMP(IBEGBL,$J,""),-1)+1)="Could not add adjustment group code ("_$P(IB0,U,3)_") at line adjustment "_+^TMP($J,40) Q
"RTN","IBCEOB0",118,0)
 . S IBDA(1)=+Y
"RTN","IBCEOB0",119,0)
 ;
"RTN","IBCEOB0",120,0)
 ; Add new entry at reason code level
"RTN","IBCEOB0",121,0)
 I $G(IBDA(1)) D
"RTN","IBCEOB0",122,0)
 . S DIC="^IBM(361.1,"_IBEOB_",15,"_IBDA(2)_",1,"_IBDA(1)_",1,",DIC(0)="L",DLAYGO=361.11511,DA(1)=IBDA(1),DA(2)=IBDA(2),DA(3)=IBEOB
"RTN","IBCEOB0",123,0)
 . S DIC("P")=$$GETSPEC^IBEFUNC(361.1151,1)
"RTN","IBCEOB0",124,0)
 . S X=$P(IB0,U,4)
"RTN","IBCEOB0",125,0)
 . D FILE^DICN K DIC,DO,DD,DLAYGO
"RTN","IBCEOB0",126,0)
 . I Y<0 K IBDA S ^TMP(IBEGBL,$J,+$O(^TMP(IBEGBL,$J,""),-1)+1)="Could not add reason code ("_$P(IB0,U,4)_") for adjustment group code ("_$P(IB0,U,3)_") at line adjustment "_+^TMP($J,40) Q
"RTN","IBCEOB0",127,0)
 . S IBDA=+Y
"RTN","IBCEOB0",128,0)
 ;
"RTN","IBCEOB0",129,0)
 I $G(IBDA) D
"RTN","IBCEOB0",130,0)
 . S LEVEL=15,LEVEL("DIE")="^IBM(361.1,"_IBEOB_",15,"_IBDA(2)_",1,"_IBDA(1)_",1,"
"RTN","IBCEOB0",131,0)
 . S LEVEL(0)=IBDA,LEVEL(1)=IBDA(1),LEVEL(2)=IBDA(2),LEVEL(3)=IBEOB
"RTN","IBCEOB0",132,0)
 . S A="5;.02;1;0;0^6;.03;0;1;1^7;.04;0;1;0"
"RTN","IBCEOB0",133,0)
 . S IBOK=$$STORE^IBCEOB1(A,IB0,IBEOB,.LEVEL)
"RTN","IBCEOB0",134,0)
 . I 'IBOK S ^TMP(IBEGBL,$J,+$O(^TMP(IBEGBL,$J,""),-1)+1)="Bad data for reason code ("_$P(IB0,U,4)_"), adjustment group code ("_$P(IB0,U,3)_") at line adjustment "_+^TMP($J,40) Q
"RTN","IBCEOB0",135,0)
 ;
"RTN","IBCEOB0",136,0)
Q45 Q
"RTN","IBCEOB0",137,0)
 ;
"RTN","IBCEOB0",138,0)
RCRU(IBZDATA,IB0,IBLN) ; Rev Code Roll-up procedure check -
"RTN","IBCEOB0",139,0)
 ; Total outbound line items by rev code and compare with
"RTN","IBCEOB0",140,0)
 ; incoming EOB 40 record to see if rolled up
"RTN","IBCEOB0",141,0)
 ;
"RTN","IBCEOB0",142,0)
 ; IBZDATA - ub92 output formatter array, pass by ref
"RTN","IBCEOB0",143,0)
 ; IB0     - 40 record data
"RTN","IBCEOB0",144,0)
 ; IBLN    - output, pass by ref
"RTN","IBCEOB0",145,0)
 ;
"RTN","IBCEOB0",146,0)
 NEW Z,LN,REV,UN,CH,RUD
"RTN","IBCEOB0",147,0)
 I $P(IB0,U,4)="" G RCRUX
"RTN","IBCEOB0",148,0)
 S IBLN="",Z=0
"RTN","IBCEOB0",149,0)
 F  S Z=$O(IBZDATA(Z)) Q:'Z  S LN=IBZDATA(Z) D
"RTN","IBCEOB0",150,0)
 . S REV=$P(LN,U,1),UN=$P(LN,U,4),CH=$P(LN,U,5)
"RTN","IBCEOB0",151,0)
 . I REV="" Q
"RTN","IBCEOB0",152,0)
 . S RUD=$G(RUD(REV))           ; roll up data array for rev code
"RTN","IBCEOB0",153,0)
 . S $P(RUD,U,1)=$P(RUD,U,1)+CH ; total charges
"RTN","IBCEOB0",154,0)
 . S $P(RUD,U,2)=$P(RUD,U,2)+UN ; total units
"RTN","IBCEOB0",155,0)
 . S $P(RUD,U,3)=$P(RUD,U,3)+1  ; total line items
"RTN","IBCEOB0",156,0)
 . S RUD(REV)=RUD
"RTN","IBCEOB0",157,0)
 . S RUD(REV,Z)=""
"RTN","IBCEOB0",158,0)
 . Q
"RTN","IBCEOB0",159,0)
 I '$D(RUD) G RCRUX
"RTN","IBCEOB0",160,0)
 ;
"RTN","IBCEOB0",161,0)
 ; delete rev code roll-up, if only 1 line item.
"RTN","IBCEOB0",162,0)
 S REV=""     ; this is not a roll up situation
"RTN","IBCEOB0",163,0)
 F  S REV=$O(RUD(REV)) Q:REV=""  I $P(RUD(REV),U,3)=1 KILL RUD(REV)
"RTN","IBCEOB0",164,0)
 I '$D(RUD) G RCRUX
"RTN","IBCEOB0",165,0)
 ;
"RTN","IBCEOB0",166,0)
 S RUD=$G(RUD($P(IB0,U,4)))   ; compare with 40 record data
"RTN","IBCEOB0",167,0)
 I RUD="" G RCRUX             ; make sure it exists
"RTN","IBCEOB0",168,0)
 I $P(RUD,U,1)'=+$$DOLLAR^IBCEOB($P(IB0,U,15)) G RCRUX    ; charges
"RTN","IBCEOB0",169,0)
 I $P(RUD,U,2)'=$P(IB0,U,16) G RCRUX                      ; units
"RTN","IBCEOB0",170,0)
 ;
"RTN","IBCEOB0",171,0)
 S IBLN=$O(RUD($P(IB0,U,4),""))  ; use 1st line# found
"RTN","IBCEOB0",172,0)
RCRUX ;
"RTN","IBCEOB0",173,0)
 Q
"RTN","IBCEOB0",174,0)
 ;
"RTN","IBCEOB0",175,0)
DET40(IB0,ARRAY) ; Format important details of rec 40 for error
"RTN","IBCEOB0",176,0)
 ; IB0 = data on 40 record (some pieces pre-formatted)
"RTN","IBCEOB0",177,0)
 ;  ARRAY(n)=formatted line returned if passed by ref
"RTN","IBCEOB0",178,0)
 N Q
"RTN","IBCEOB0",179,0)
 S ARRAY(1)="Payer reported the following was billed to them:"
"RTN","IBCEOB0",180,0)
 S ARRAY(2)=" "_$S($P(IB0,U,21)="NU":"Rev Cd",1:"Proc")_": "_$S($P(IB0,U,10)'="":$P(IB0,U,10),1:"Same as adjudicated")_"  Chg: "_$J($P(IB0,U,15)/100,"",2)_"  Units: "_$S($P(IB0,U,16):$P(IB0,U,16),1:1)
"RTN","IBCEOB0",181,0)
 S ARRAY(3)="  Svc Date(s): "_$S($P(IB0,U,19)'="":$$FDT($P(IB0,U,19)),1:"??")_$S($P(IB0,U,20)'="":"-"_$$FDT($P(IB0,U,20)),1:"")
"RTN","IBCEOB0",182,0)
 I $P(IB0,U,11)'="" S ARRAY(3)=ARRAY(3)_"  Mods: " F Q=11:1:14 I $P(IB0,U,Q)'="" S ARRAY(3)=ARRAY(3)_$S(Q=14:"",$P(IB0,U,Q+1)'="":",",1:"")_$P(IB0,U,Q)
"RTN","IBCEOB0",183,0)
 S ARRAY(4)="Payer reported adjudication on:"
"RTN","IBCEOB0",184,0)
 S ARRAY(5)=" "_$S($P(IB0,U,21)="NU":"Rev Cd",1:"Proc")_": "_$S($P(IB0,U,3)'="":$P(IB0,U,3),1:$P(IB0,U,4))
"RTN","IBCEOB0",185,0)
 S ARRAY(5)=ARRAY(5)_"  Type: "_$P(IB0,U,21)_$S($P(IB0,U,21)'="NU":"  Rev Cd: "_$P(IB0,U,4),1:"")_"  Units: "_$S($P(IB0,U,18):$P(IB0,U,18)/100,1:1)_"  Amt: "_$J($P(IB0,U,17)/100,"",2)
"RTN","IBCEOB0",186,0)
 I $P(IB0,U,5)'="" S ARRAY(5)=ARRAY(5)_"  Mods: " F Q=5:1:8 I $P(IB0,U,Q)'="" S ARRAY(5)=ARRAY(5)_$S(Q=8:"",$P(IB0,U,Q+1)'="":",",1:"")_$P(IB0,U,Q)
"RTN","IBCEOB0",187,0)
 Q
"RTN","IBCEOB0",188,0)
 ;
"RTN","IBCEOB0",189,0)
DET4X(RECID,IB0,ARRAY) ; Format important details of recs 41-45 for error
"RTN","IBCEOB0",190,0)
 ; RECID = 41,42,45
"RTN","IBCEOB0",191,0)
 ; IB0 = data on RECID rec
"RTN","IBCEOB0",192,0)
 ;  ARRAY(n)=formatted line returned if passed by ref
"RTN","IBCEOB0",193,0)
 N CT,Q
"RTN","IBCEOB0",194,0)
 I RECID=41 D  Q
"RTN","IBCEOB0",195,0)
 . S ARRAY(1)="Allowed Amt: "_$J($P(IB0,U,3)/100,"",2)_"  Per Diem Amt: "_$J($P(IB0,U,4)/100,"",2)
"RTN","IBCEOB0",196,0)
 ;
"RTN","IBCEOB0",197,0)
 I RECID=42 D  Q
"RTN","IBCEOB0",198,0)
 . S ARRAY(1)="Line Item Remark Code: "_$P(IB0,U,3)
"RTN","IBCEOB0",199,0)
 . I $P(IB0,U,4)'="" S CT=1 F Q=0:80:190 I $E($P(IB0,U,4),Q+1,Q+80)'="" S CT=CT+1,ARRAY(CT)=$E($P(IB0,U,4),Q+1,Q+80)
"RTN","IBCEOB0",200,0)
 ;
"RTN","IBCEOB0",201,0)
 I RECID=45 D
"RTN","IBCEOB0",202,0)
 . S ARRAY(1)="Adj Group Cd: "_$P(IB0,U,3)_"  Reason Cd: "_$P(IB0,U,4)_"  Amt: "_$J($P(IB0,U,5)/100,"",2)_"  Quantity: "_+$P(IB0,U,6)
"RTN","IBCEOB0",203,0)
 . I $P(IB0,U,7)'="" S CT=1 F Q=0:80:190 I $E($P(IB0,U,7),Q+1,Q+80)'="" S CT=CT+1,ARRAY(CT)=$E($P(IB0,U,7),Q+1,Q+80)
"RTN","IBCEOB0",204,0)
 Q
"RTN","IBCEOB0",205,0)
 ; 
"RTN","IBCEOB0",206,0)
FDT(X) ; Format date in X (YYYYMMDD) to MM/DD/YYYY
"RTN","IBCEOB0",207,0)
 S:X'="" X=$E(X,5,6)_"/"_$E(X,7,8)_"/"_$E(X,1,4)
"RTN","IBCEOB0",208,0)
 Q X
"RTN","IBCEOB0",209,0)
 ;
"RTN","IBCEP2")
0^3^B67570854
"RTN","IBCEP2",1,0)
IBCEP2 ;ALB/TMP - EDI UTILITIES for provider ID ;13-DEC-99
"RTN","IBCEP2",2,0)
 ;;2.0;INTEGRATED BILLING;**137,181,232,280**;21-MAR-94
"RTN","IBCEP2",3,0)
 ; DBIA for access to fields 53.2,54.1,54.2 in file 200: 224
"RTN","IBCEP2",4,0)
 ;
"RTN","IBCEP2",5,0)
GETID(IBIFN,IBTYPE,IBPROV,IBSEQ,IBT,IBT1) ; Extract IBTYPE id for the bill
"RTN","IBCEP2",6,0)
 ; IBIFN = bill ien (file 399)
"RTN","IBCEP2",7,0)
 ; IBTYPE = 2:PERFORMING PROVIDER ID (1 and 3 deleted)
"RTN","IBCEP2",8,0)
 ; IBSEQ = numeric COB sequence of the insurance on bill
"RTN","IBCEP2",9,0)
 ; Returns IBT = ien of the provider id type^ien of entry^file # for id
"RTN","IBCEP2",10,0)
 ;
"RTN","IBCEP2",11,0)
 S IBT=0
"RTN","IBCEP2",12,0)
 Q:IBTYPE'=2 ""
"RTN","IBCEP2",13,0)
 N IBID,IBPTYP
"RTN","IBCEP2",14,0)
 S IBID=$$IDFIND(IBIFN,"",IBPROV,IBSEQ,1,.IBT)
"RTN","IBCEP2",15,0)
 I IBID="" S IBT=""
"RTN","IBCEP2",16,0)
 ;
"RTN","IBCEP2",17,0)
 Q IBID
"RTN","IBCEP2",18,0)
 ;
"RTN","IBCEP2",19,0)
IDFIND(IBIFN,IBPTYP,IBPROV,IBSEQ,IBPERF,IBT) ;Loop thru source levels
"RTN","IBCEP2",20,0)
 ;   (if id definition allows) to find correct ID
"RTN","IBCEP2",21,0)
 ; IBIFN = bill ien (file 399)
"RTN","IBCEP2",22,0)
 ; IBPTYP = ien of the provider id type in file 355.97 or if null,
"RTN","IBCEP2",23,0)
 ;          the default performing provider ID type for the ins co. in
"RTN","IBCEP2",24,0)
 ;          COB sequence IBSEQ will be calculated
"RTN","IBCEP2",25,0)
 ; IBPROV = (variable pointer syntax) provider on bill IBIFN
"RTN","IBCEP2",26,0)
 ; IBSEQ = numeric COB sequence of the bill
"RTN","IBCEP2",27,0)
 ; IBPERF = 1 if the performing provider id is needed
"RTN","IBCEP2",28,0)
 ; Returns IBT = ptr to file 355.97^entry #^file #
"RTN","IBCEP2",29,0)
 ;
"RTN","IBCEP2",30,0)
 S IBT=+$G(IBPTYP)
"RTN","IBCEP2",31,0)
 Q:'$G(IBPERF)!'$G(IBPROV) ""
"RTN","IBCEP2",32,0)
 N IBSPEC,IBINS,IBINS4,IBSRC,IBUP,IBID,IBALT,IBPROF,Z
"RTN","IBCEP2",33,0)
 I $G(IBSEQ)="" S IBSEQ=+$$COBN^IBCEF(IBIFN) ; Default to current COB seq
"RTN","IBCEP2",34,0)
 S IBINS=+$P($G(^DGCR(399,IBIFN,"I"_IBSEQ)),U),IBINS4=$G(^DIC(36,+IBINS,4))
"RTN","IBCEP2",35,0)
 S IBPROF=($$FT^IBCEF(IBIFN)=2) S:'IBPROF IBPROF=2
"RTN","IBCEP2",36,0)
 ; form type is HCFA (prof)=1, UB92 (inst)=2
"RTN","IBCEP2",37,0)
 I $G(IBPTYP)="" S (IBT,IBPTYP)=+$P(IBINS4,U,IBPROF) ; Def to perf prv typ for form
"RTN","IBCEP2",38,0)
 I 'IBPTYP Q ""  ; No default id type
"RTN","IBCEP2",39,0)
 S IBSPEC=$G(^IBE(355.97,IBPTYP,1)),IBSRC=$P($G(^IBE(355.97,+IBPTYP,0)),U,2),IBSRC=$S('IBSRC:5,1:IBSRC),IBUP=1
"RTN","IBCEP2",40,0)
 S IBALT=0
"RTN","IBCEP2",41,0)
 ;
"RTN","IBCEP2",42,0)
 F  D  Q:'IBUP!($G(IBID)'="")  S IBSRC=IBSRC-1 Q:'IBSRC
"RTN","IBCEP2",43,0)
 . ;
"RTN","IBCEP2",44,0)
 . I IBSRC=1,$TR($P(IBSPEC,U,1,3),"^0")'="" D  Q  ; Indiv prov default
"RTN","IBCEP2",45,0)
 .. N IBSTATE
"RTN","IBCEP2",46,0)
 .. I $P(IBSPEC,U,2) D  Q  ; Federal DEA # from field 53.2 file 200
"RTN","IBCEP2",47,0)
 ... S IBID=$P($G(^VA(200,+IBPROV,"PS")),U,2) ; DBIA224
"RTN","IBCEP2",48,0)
 ... S $P(IBT,U,2,3)=(IBPROV_U_200)
"RTN","IBCEP2",49,0)
 .. S IBSTATE=+$$CAREST^IBCEP2A(IBIFN)
"RTN","IBCEP2",50,0)
 .. I $P(IBSPEC,U) D  Q  ; State issued DEA # needed
"RTN","IBCEP2",51,0)
 ... Q:'IBSTATE
"RTN","IBCEP2",52,0)
 ... ; Extract the state issuing DEA # from field 54.2 file 200
"RTN","IBCEP2",53,0)
 ... S Z=+$O(^VA(200,+IBPROV,"PS2","B",IBSTATE,0)),IBID=$P($G(^VA(200,+IBPROV,"PS2",Z,0)),U,2) ; DBIA224
"RTN","IBCEP2",54,0)
 ... S $P(IBT,U,2,3)=(+IBPROV_";"_Z_U_200)
"RTN","IBCEP2",55,0)
 .. I $P(IBSPEC,U,3) D  Q  ; State license # needed
"RTN","IBCEP2",56,0)
 ... Q:'IBSTATE
"RTN","IBCEP2",57,0)
 ... ; Extract the state license # from field 54.1 file 200
"RTN","IBCEP2",58,0)
 ... I IBPROV["VA(200" S Z=+$O(^VA(200,+IBPROV,"PS1","B",IBSTATE,0)),IBID=$P($G(^VA(200,+IBPROV,"PS1",Z,0)),U,2),$P(IBT,U,2,3)=(+IBPROV_";"_IBSTATE_U_200) ; DBIA224
"RTN","IBCEP2",59,0)
 ... I IBPROV["IBA(355.93" S IBID=$P($G(^IBA(355.93,+IBPROV,0)),U,12),$P(IBT,U,2,3)=(+IBPROV_U_355.93)
"RTN","IBCEP2",60,0)
 . ;
"RTN","IBCEP2",61,0)
 . I IBSRC=2,$P(IBSPEC,U,4) D  Q  ; FACILITY FED TAX ID #
"RTN","IBCEP2",62,0)
 .. N IBXDATA
"RTN","IBCEP2",63,0)
 .. D F^IBCEF("N-FEDERAL TAX ID",,,IBIFN)
"RTN","IBCEP2",64,0)
 .. S IBID=IBXDATA,$P(IBT,U,2,3)=(U_350.9)
"RTN","IBCEP2",65,0)
 . ;
"RTN","IBCEP2",66,0)
 . I IBSRC=1 S IBID=$$SRC1(IBIFN,"*ALL*",IBPTYP,IBPROV,.IBT) Q
"RTN","IBCEP2",67,0)
 . ;
"RTN","IBCEP2",68,0)
 . I IBSRC=2 S IBID=$$SRC2(IBPTYP,.IBT) Q
"RTN","IBCEP2",69,0)
 . ;
"RTN","IBCEP2",70,0)
 . I IBSRC=3 S IBID=$$SRC3(IBIFN,IBINS,IBPTYP,.IBT) Q
"RTN","IBCEP2",71,0)
 . ; 
"RTN","IBCEP2",72,0)
 . I IBSRC=4 S IBID=$$SRC4(IBIFN,IBINS,IBPTYP,IBPROV,.IBT) Q
"RTN","IBCEP2",73,0)
 . ;
"RTN","IBCEP2",74,0)
 . I IBSRC=5 S IBID=$$SRC5(IBIFN,IBINS,IBPTYP,IBSEQ,.IBT) Q
"RTN","IBCEP2",75,0)
 . ;
"RTN","IBCEP2",76,0)
 . I IBSRC=6 S IBID=$$SRC6(IBIFN,IBINS,IBPTYP,IBPROV,IBSEQ,.IBT) Q
"RTN","IBCEP2",77,0)
 ;
"RTN","IBCEP2",78,0)
 Q $G(IBID)
"RTN","IBCEP2",79,0)
 ;
"RTN","IBCEP2",80,0)
GETALL(IBTYPE,IBIFN,IBPROV,IBPID) ; Extract all performing prov id's for a
"RTN","IBCEP2",81,0)
 ; provider (IBPROV - vp format) on bill IBIFN
"RTN","IBCEP2",82,0)
 ; IBTYPE = type of ID to return (see GETID above)
"RTN","IBCEP2",83,0)
 ;
"RTN","IBCEP2",84,0)
 ; Returns array IBPID(COB SEQ #)=id (pass by reference) AND
"RTN","IBCEP2",85,0)
 ;   IBPID(COB SEQ #,1)=ien of id type (ptr to 355.97)
"RTN","IBCEP2",86,0)
 ;   IBPID = current insurance co's id
"RTN","IBCEP2",87,0)
 ;
"RTN","IBCEP2",88,0)
 N Z,COB,Z1,IBT
"RTN","IBCEP2",89,0)
 S COB=$$COBN^IBCEF(IBIFN)
"RTN","IBCEP2",90,0)
 F Z=1:1:3 Q:'$D(^DGCR(399,IBIFN,"I"_Z))  S IBPID(Z)=$$GETID(IBTYPE,IBIFN,IBPROV,Z,.IBT),IBPID(Z,1)=IBT I Z=COB S Z1=IBPID(Z)
"RTN","IBCEP2",91,0)
 Q $G(Z1)
"RTN","IBCEP2",92,0)
 ;
"RTN","IBCEP2",93,0)
SRC1(IBIFN,IBINS,IBPTYP,IBPROV,IBT) ; Licensing/gov't issued # - provider specific
"RTN","IBCEP2",94,0)
 ; Parameter definitions for SRC1, SRC3, SRC4, SRC5, SRC6:
"RTN","IBCEP2",95,0)
 ;   IBIFN = ien of bill (file 399)
"RTN","IBCEP2",96,0)
 ;   IBINS = ien of insurance co (file 36) or *ALL* for all insurance
"RTN","IBCEP2",97,0)
 ;           (always *ALL* for SRC1)
"RTN","IBCEP2",98,0)
 ;   IBPTYP = ien of the provider id type in file 355.97
"RTN","IBCEP2",99,0)
 ;   IBPROV = (variable pointer syntax) provider on bill IBIFN
"RTN","IBCEP2",100,0)
 ;   IBT = returned as type ien^file ien^file #
"RTN","IBCEP2",101,0)
 ;
"RTN","IBCEP2",102,0)
 N IBID,IB,IBRX,IBIDSV
"RTN","IBCEP2",103,0)
 S IBID="",IB=0,IBRX=$$ISRX^IBCEF1(IBIFN),IBIDSV=""
"RTN","IBCEP2",104,0)
 I $G(IBPROV) F  S IB=$O(^IBA(355.9,"AD",IBPTYP,IBPROV,IBINS,IB)) Q:'IB  D  Q:IBID'=""
"RTN","IBCEP2",105,0)
 . S IBID=$$UNIQ1(IBIFN,IBINS,IBPTYP,IBPROV,"",IB)
"RTN","IBCEP2",106,0)
 . I IBRX,$P($G(^IBA(355.9,IB,0)),U,5)'=3 S:IBIDSV="" IBIDSV=IBID S IBID="" ; Save 1st 'match' if no rx specific id
"RTN","IBCEP2",107,0)
 I IBID="",IBIDSV'="" S IBID=IBIDSV
"RTN","IBCEP2",108,0)
 Q IBID
"RTN","IBCEP2",109,0)
 ;
"RTN","IBCEP2",110,0)
SRC2(IB35597,IBT) ; Facility default - all providers
"RTN","IBCEP2",111,0)
 ; IB35597 = ien of the provider id type entry in file 355.97
"RTN","IBCEP2",112,0)
 ; IBT = returned as type ien^file ien^file #
"RTN","IBCEP2",113,0)
 ;
"RTN","IBCEP2",114,0)
 S $P(IBT,U,2,3)=(+IB35597_U_355.97)
"RTN","IBCEP2",115,0)
 Q $P($G(^IBE(355.97,+IB35597,0)),U,4)
"RTN","IBCEP2",116,0)
 ;
"RTN","IBCEP2",117,0)
SRC3(IBIFN,IBINS,IBPTYP,IBT) ; Ins co/all providers
"RTN","IBCEP2",118,0)
 ; See SRC1 for parameter definitions
"RTN","IBCEP2",119,0)
 N IB,IBID,IBRX,IBIDSV
"RTN","IBCEP2",120,0)
 S IBID="",IB=0,IBRX=$$ISRX^IBCEF1(IBIFN),IBIDSV=""
"RTN","IBCEP2",121,0)
 F  S IB=$O(^IBA(355.91,"AC",IBINS,IBPTYP,"*N/A*",IB)) Q:'IB  D  Q:IBID'=""
"RTN","IBCEP2",122,0)
 . S IBID=$$UNIQ2(IBIFN,IBINS,IBPTYP,"",IB,.IBT)
"RTN","IBCEP2",123,0)
 . I IBRX,$P($G(^IBA(355.91,IB,0)),U,5)'=3 S:IBIDSV="" IBIDSV=IBID S IBID="" ; Save 1st 'match' if no rx specific id
"RTN","IBCEP2",124,0)
 I IBID="",IBIDSV'="" S IBID=IBIDSV
"RTN","IBCEP2",125,0)
 Q IBID
"RTN","IBCEP2",126,0)
 ;
"RTN","IBCEP2",127,0)
SRC4(IBIFN,IBINS,IBPTYP,IBPROV,IBT) ;  Insurance co/individual provider
"RTN","IBCEP2",128,0)
 ; See SRC1 for parameter definitions
"RTN","IBCEP2",129,0)
 ;
"RTN","IBCEP2",130,0)
 N IBID,IB,IBRX,IBIDSV
"RTN","IBCEP2",131,0)
 S IBID="",IB=0,IBRX=$$ISRX^IBCEF1(IBIFN),IBIDSV=""
"RTN","IBCEP2",132,0)
 I $G(IBPROV) F  S IB=$O(^IBA(355.9,"AD",IBPTYP,IBPROV,IBINS,IB)) Q:'IB  D  Q:IBID'=""
"RTN","IBCEP2",133,0)
 . S IBID=$$UNIQ1(IBIFN,IBINS,IBPTYP,IBPROV,"",IB,.IBT)
"RTN","IBCEP2",134,0)
 . I IBRX,$P($G(^IBA(355.9,IB,0)),U,5)'=3 S:IBIDSV="" IBIDSV=IBID S IBID="" ; Save 1st 'match' if no rx specific id
"RTN","IBCEP2",135,0)
 I IBID="",IBIDSV'="" S IBID=IBIDSV
"RTN","IBCEP2",136,0)
 Q IBID
"RTN","IBCEP2",137,0)
 ;
"RTN","IBCEP2",138,0)
SRC5(IBIFN,IBINS,IBPTYP,IBSEQ,IBT) ; Ins co/all providers/care unit
"RTN","IBCEP2",139,0)
 ; See SRC1 for missing parameter definitions
"RTN","IBCEP2",140,0)
 ; IBSEQ = the numeric COB sequence of the insurance on the bill
"RTN","IBCEP2",141,0)
 ;
"RTN","IBCEP2",142,0)
 N IBP,IBUNIT,IBID,IB,Z,IBIDSV,IBRX
"RTN","IBCEP2",143,0)
 S IBID="",Z=0,IBRX=$$ISRX^IBCEF1(IBIFN),IBIDSV=""
"RTN","IBCEP2",144,0)
 S IBP=+$O(^DGCR(399,IBIFN,"PRV","B",$S($$FT^IBCEF(IBIFN)=3:4,1:3),0)),IBUNIT=$P($G(^DGCR(399,IBIFN,"PRV",IBP,0)),U,8+IBSEQ)
"RTN","IBCEP2",145,0)
 I IBUNIT'="" F  S Z=$O(^IBA(355.96,"AC",IBINS,IBPTYP,Z)) Q:'Z  D  Q:IBID'=""
"RTN","IBCEP2",146,0)
 . S IB=0 F  S IB=$O(^IBA(355.91,"ACARE",Z,IB)) Q:'IB  D  Q:IBID'=""
"RTN","IBCEP2",147,0)
 .. S IBID=$$UNIQ2(IBIFN,IBINS,IBPTYP,IBUNIT,IB,.IBT)
"RTN","IBCEP2",148,0)
 .. I IBRX,$P($G(^IBA(355.91,IB,0)),U,5)'=3 S:IBIDSV="" IBIDSV=IBID S IBID="" ; Save 1st 'match' if no rx specific id
"RTN","IBCEP2",149,0)
 I IBID="",IBIDSV'="" S IBID=IBIDSV
"RTN","IBCEP2",150,0)
 Q IBID
"RTN","IBCEP2",151,0)
 ;
"RTN","IBCEP2",152,0)
SRC6(IBIFN,IBINS,IBPTYP,IBPROV,IBSEQ,IBT) ; Ins co/ind provider/care unit
"RTN","IBCEP2",153,0)
 ; See SRC1 for missing parameter definitions
"RTN","IBCEP2",154,0)
 ; IBSEQ = the numeric COB sequence of the insurance on the bill
"RTN","IBCEP2",155,0)
 ;
"RTN","IBCEP2",156,0)
 N IBUNIT,IBP,IBID,IB
"RTN","IBCEP2",157,0)
 S IBID="",IB=0
"RTN","IBCEP2",158,0)
 S IBP=+$O(^DGCR(399,"PRV","B",$S($$FT^IBCEF(IBIFN)=3:3,1:4),0)),IBUNIT=$P($G(^DGCR(399,IBIFN,"PRV",IBP,0)),U,8+IBSEQ)
"RTN","IBCEP2",159,0)
 I $G(IBPROV),IBUNIT'="" F  S IB=$O(^IBA(355.9,"AD",IBPTYP,IBPROV,IBINS,IB)) Q:'IB  D  Q:IBID'=""
"RTN","IBCEP2",160,0)
 . S IBID=$$UNIQ1(IBIFN,IBINS,IBPTYP,IBPROV,IBUNIT,IB,.IBT)
"RTN","IBCEP2",161,0)
 Q IBID
"RTN","IBCEP2",162,0)
 ;
"RTN","IBCEP2",163,0)
UNIQ1(IBIFN,IBINS,IBPTYP,IBPROV,IBUNIT,IBCU,IBT) ; Match most-least specific
"RTN","IBCEP2",164,0)
 ; *** SEE PARAMETER DEFINITIONS IN IBCEP3 ***
"RTN","IBCEP2",165,0)
 ;
"RTN","IBCEP2",166,0)
 ; Start in file 355.9 (Specific Provider)
"RTN","IBCEP2",167,0)
 ;   IBPROV = (variable pointer syntax) provider on bill IBIFN
"RTN","IBCEP2",168,0)
 ;
"RTN","IBCEP2",169,0)
 N Q,Z0,Z1,Z2,IBID,IBX
"RTN","IBCEP2",170,0)
 S IBID=""
"RTN","IBCEP2",171,0)
 S IBX=$P($G(^IBA(355.9,+IBCU,0)),U,3) S:"0"[IBX IBX="*N/A*"
"RTN","IBCEP2",172,0)
 S Z0=$$FT^IBCEF(IBIFN),Z0=$S(Z0=2:2,Z0=3:1,1:0),Z1=$$INPAT^IBCEF(IBIFN,1) S:'Z1 Z1=2 S Z2=$$ISRX^IBCEF1(IBIFN)
"RTN","IBCEP2",173,0)
 ;
"RTN","IBCEP2",174,0)
 ; Match all elements
"RTN","IBCEP2",175,0)
 F Q=$S(Z2:3,1:Z1),$S(Z2:Z1,1:"") I Q'="",$D(^IBA(355.9,"AUNIQ",IBPROV,IBINS,IBX,Z0,Q,IBPTYP,IBCU)) S IBID=$P($G(^IBA(355.9,IBCU,0)),U,7),$P(IBT,U,2,3)=(IBCU_U_355.9) Q
"RTN","IBCEP2",176,0)
 G:IBID'="" UNIQ1Q
"RTN","IBCEP2",177,0)
 ;
"RTN","IBCEP2",178,0)
 ; Match both form types,specific I/O element
"RTN","IBCEP2",179,0)
 F Q=$S(Z2:3,1:Z1),$S(Z2:Z1,1:"") I Q'="",$D(^IBA(355.9,"AUNIQ",IBPROV,IBINS,IBX,0,Q,IBPTYP,IBCU)) S IBID=$P($G(^IBA(355.9,IBCU,0)),U,7),$P(IBT,U,2,3)=(IBCU_U_355.9) Q
"RTN","IBCEP2",180,0)
 G:IBID'="" UNIQ1Q
"RTN","IBCEP2",181,0)
 ;
"RTN","IBCEP2",182,0)
 ; Match specific form type, both I/O element or Rx
"RTN","IBCEP2",183,0)
 F Q=$S(Z2:3,1:0),$S(Z2:0,1:"") I Q'="",$D(^IBA(355.9,"AUNIQ",IBPROV,IBINS,IBX,Z0,Q,IBPTYP,IBCU)) S IBID=$P($G(^IBA(355.9,IBCU,0)),U,7),$P(IBT,U,2,3)=(IBCU_U_355.9) Q
"RTN","IBCEP2",184,0)
 G:IBID'="" UNIQ1Q
"RTN","IBCEP2",185,0)
 ;
"RTN","IBCEP2",186,0)
 ; Match both form types, both I/O element or Rx
"RTN","IBCEP2",187,0)
 F Q=$S(Z2:3,1:0),$S(Z2:0,1:"") I Q'="",$D(^IBA(355.9,"AUNIQ",IBPROV,IBINS,IBX,0,Q,IBPTYP,IBCU)) S IBID=$P($G(^IBA(355.9,IBCU,0)),U,7),$P(IBT,U,2,3)=(IBCU_U_355.9) Q
"RTN","IBCEP2",188,0)
 ;
"RTN","IBCEP2",189,0)
UNIQ1Q Q IBID
"RTN","IBCEP2",190,0)
 ;
"RTN","IBCEP2",191,0)
UNIQ2(IBIFN,IBINS,IBPTYP,IBUNIT,IBCU,IBT) ; Match on most-least specific
"RTN","IBCEP2",192,0)
 ; *** SEE PARAMETER DEFINITIONS IN IBCEP3 ***
"RTN","IBCEP2",193,0)
 ;
"RTN","IBCEP2",194,0)
 ; Start in file 355.91 (Specific Insurance)
"RTN","IBCEP2",195,0)
 ;
"RTN","IBCEP2",196,0)
 N Q,Z0,Z1,Z2,IBID,IBX
"RTN","IBCEP2",197,0)
 S IBID="" S:"0"[$G(IBUNIT) IBUNIT="*N/A*"
"RTN","IBCEP2",198,0)
 S Z0=$$FT^IBCEF(IBIFN),Z0=$S(Z0=2:2,Z0=3:1,1:0),Z1=$$INPAT^IBCEF(IBIFN,1) S:'Z1 Z1=2 S Z2=$$ISRX^IBCEF1(IBIFN)
"RTN","IBCEP2",199,0)
 ;
"RTN","IBCEP2",200,0)
 ; Match all elements
"RTN","IBCEP2",201,0)
 F Q=$S(Z2:3,1:Z1),$S(Z2:Z1,1:"") I Q'="",$D(^IBA(355.91,"AUNIQ",IBINS,IBUNIT,Z0,Q,IBPTYP,IBCU)) S IBID=$P($G(^IBA(355.91,IBCU,0)),U,7),$P(IBT,U,2,3)=(IBCU_U_355.91) Q
"RTN","IBCEP2",202,0)
 G:IBID'="" UNIQ2Q
"RTN","IBCEP2",203,0)
 ;
"RTN","IBCEP2",204,0)
 ; Match both form types,specific I/O element
"RTN","IBCEP2",205,0)
 F Q=$S(Z2:3,1:Z1),$S(Z2:Z1,1:"") I Q'="",$D(^IBA(355.91,"AUNIQ",IBINS,IBUNIT,0,Q,IBPTYP,IBCU)) S IBID=$P($G(^IBA(355.91,IBCU,0)),U,7),$P(IBT,U,2,3)=(IBCU_U_355.91) Q
"RTN","IBCEP2",206,0)
 G:IBID'="" UNIQ2Q
"RTN","IBCEP2",207,0)
 ;
"RTN","IBCEP2",208,0)
 ; Match specific form type, both I/O element or Rx
"RTN","IBCEP2",209,0)
 F Q=$S(Z2:3,1:0),$S(Z2:0,1:"") I Q'="",$D(^IBA(355.91,"AUNIQ",IBINS,IBUNIT,Z0,Q,IBPTYP,IBCU)) S IBID=$P($G(^IBA(355.91,IBCU,0)),U,7),$P(IBT,U,2,3)=(IBCU_U_355.91) Q
"RTN","IBCEP2",210,0)
 G:IBID'="" UNIQ2Q
"RTN","IBCEP2",211,0)
 ;
"RTN","IBCEP2",212,0)
 ; Match both form types, both I/O elements or Rx
"RTN","IBCEP2",213,0)
 F Q=$S(Z2:3,1:0),$S(Z2:0,1:"") I Q'="",$D(^IBA(355.91,"AUNIQ",IBINS,IBUNIT,0,Q,IBPTYP,IBCU)) S IBID=$P($G(^IBA(355.91,IBCU,0)),U,7),$P(IBT,U,2,3)=(IBCU_U_355.91) Q
"RTN","IBCEP2",214,0)
 ;
"RTN","IBCEP2",215,0)
UNIQ2Q Q IBID
"RTN","IBCEP2",216,0)
 ;
"RTN","IBCEP3")
0^4^B35967297
"RTN","IBCEP3",1,0)
IBCEP3 ;ALB/TMP - EDI UTILITIES for provider ID ;25-SEP-00
"RTN","IBCEP3",2,0)
 ;;2.0;INTEGRATED BILLING;**137,207,232,280**;21-MAR-94
"RTN","IBCEP3",3,0)
 ;
"RTN","IBCEP3",4,0)
CUNEED(IBIFN,IBSEQ,IBPTYP,IBRET,IBEMC) ; Determine if care unit needed for
"RTN","IBCEP3",5,0)
 ; provider type and insurance company(s) on bill
"RTN","IBCEP3",6,0)
 ; IBIFN = ien of bill (file 399)
"RTN","IBCEP3",7,0)
 ; IBSEQ = specific COB sequence to check or null for check all
"RTN","IBCEP3",8,0)
 ; IBPTYP = the ien of the provider id type in file 355.97 or if null,
"RTN","IBCEP3",9,0)
 ;          the default performing provider ID type for the ins co's.
"RTN","IBCEP3",10,0)
 ; IBRET = flag to return insurance ien (0) or file 355.97 ien (1)
"RTN","IBCEP3",11,0)
 ; IBEMC = no longer used
"RTN","IBCEP3",12,0)
 ;
"RTN","IBCEP3",13,0)
 ; Function returns care unit needed flag (0=not needed, 1=needed) ^
"RTN","IBCEP3",14,0)
 ; AND   if IBSEQ="": primary ins or 355.97 ien if care unit needed ^
"RTN","IBCEP3",15,0)
 ;                    secondary ins or 355.97 ien if care unit needed ^
"RTN","IBCEP3",16,0)
 ;                    tertiary ins or 355.97 ien if care unit needed
"RTN","IBCEP3",17,0)
 ;                    (these would be '^' pieces 2,3,4)
"RTN","IBCEP3",18,0)
 ;       if IBSEQ   : IBSEQ seq ins or 355.97 ien if care unit needed
"RTN","IBCEP3",19,0)
 ;                    (this would be '^' piece 2)
"RTN","IBCEP3",20,0)
 ;
"RTN","IBCEP3",21,0)
 Q:$G(IBEMC) 0
"RTN","IBCEP3",22,0)
 N Q,Z,Z0,Z4,IB,IBCTYP,IBFTYP,IBQ,IBRX,IBPT
"RTN","IBCEP3",23,0)
 S (IBRX,IB)=0
"RTN","IBCEP3",24,0)
 S IBFTYP=$$FT^IBCEF(IBIFN),IBCTYP=$$INPAT^IBCEF(IBIFN,1)
"RTN","IBCEP3",25,0)
 S IBFTYP=$S(IBFTYP=3:1,1:2) S:IBCTYP'=1 IBCTYP=2
"RTN","IBCEP3",26,0)
 I IBCTYP=2 S IBRX=$$ISRX^IBCEF1(IBIFN) ; Outpatient pharmacy
"RTN","IBCEP3",27,0)
 S IBPT=$G(IBPTYP)
"RTN","IBCEP3",28,0)
 ;
"RTN","IBCEP3",29,0)
 S (Z,IBQ)=0
"RTN","IBCEP3",30,0)
 F  D  Q:IBQ
"RTN","IBCEP3",31,0)
 . I $G(IBSEQ) S Z=IBSEQ,IBQ=1 ; Only once for specific COB sequence
"RTN","IBCEP3",32,0)
 . I '$G(IBSEQ) S Z=Z+1,IBPTYP=IBPT I Z>3 S IBQ=1 Q  ; Up to 3 times - all ins
"RTN","IBCEP3",33,0)
 . S Z0=$$INSSEQ^IBCEP1(IBIFN,Z),Z4=$G(^DIC(36,+Z0,4))
"RTN","IBCEP3",34,0)
 . I '$G(IBPTYP) S IBPTYP=+Z4
"RTN","IBCEP3",35,0)
 . I 'Z0!'IBPTYP S:'Z0 IBQ=1 Q
"RTN","IBCEP3",36,0)
 . S Q=+$$CAREUN(Z0,IBPTYP,IBFTYP,IBCTYP,IBRX)
"RTN","IBCEP3",37,0)
 . I Q S $P(IB,U,$S($G(IBSEQ):Z+1,1:2))=$S($G(IBRET):Q,1:Z0)
"RTN","IBCEP3",38,0)
 ;
"RTN","IBCEP3",39,0)
 I $TR(IB,"^0") S $P(IB,U)=1
"RTN","IBCEP3",40,0)
 Q IB
"RTN","IBCEP3",41,0)
 ;
"RTN","IBCEP3",42,0)
CAREUN(IBINS,IBPTYP,IBFTYP,IBCTYP,IBRX) ; Find ien (file 355.96) for care
"RTN","IBCEP3",43,0)
 ; unit for the combination of ins co, prov type, form type and
"RTN","IBCEP3",44,0)
 ; care type
"RTN","IBCEP3",45,0)
 ; IBINS = ien of ins co (file 36)
"RTN","IBCEP3",46,0)
 ; IBPTYP = ien of provider id type (file 355.97)
"RTN","IBCEP3",47,0)
 ; IBFTYP = form type (1=UB92,2=HCFA)
"RTN","IBCEP3",48,0)
 ; IBCTYP = care type (1=inpat,2=outpat)
"RTN","IBCEP3",49,0)
 ; IBRX = 1 if outpat/Rx bill
"RTN","IBCEP3",50,0)
 ;
"RTN","IBCEP3",51,0)
 N IB
"RTN","IBCEP3",52,0)
 S IB=""
"RTN","IBCEP3",53,0)
 ;
"RTN","IBCEP3",54,0)
 I $G(IBRX) D
"RTN","IBCEP3",55,0)
 . N T
"RTN","IBCEP3",56,0)
 . S T=$O(^IBA(355.96,"AD",IBINS,IBFTYP,3,IBPTYP,0))
"RTN","IBCEP3",57,0)
 . I 'T S T=$O(^IBA(355.96,"AD",IBINS,0,3,IBPTYP,0))
"RTN","IBCEP3",58,0)
 . I T S IB=T
"RTN","IBCEP3",59,0)
 ;
"RTN","IBCEP3",60,0)
 I 'IB D  ; Find from most specific to least specific
"RTN","IBCEP3",61,0)
 . I $O(^IBA(355.96,"AD",IBINS,IBFTYP,IBCTYP,IBPTYP,0)) S IB=+$O(^(0)) Q
"RTN","IBCEP3",62,0)
 . I $O(^IBA(355.96,"AD",IBINS,IBFTYP,0,IBPTYP,0)) S IB=+$O(^(0)) Q
"RTN","IBCEP3",63,0)
 . I $O(^IBA(355.96,"AD",IBINS,0,IBCTYP,IBPTYP,0)) S IB=+$O(^(0)) Q
"RTN","IBCEP3",64,0)
 . I $O(^IBA(355.96,"AD",IBINS,0,0,IBPTYP,0)) S IB=+$O(^(0)) Q
"RTN","IBCEP3",65,0)
 ;
"RTN","IBCEP3",66,0)
 Q IB
"RTN","IBCEP3",67,0)
 ;
"RTN","IBCEP3",68,0)
DISP(IBINS,IBTYPE) ; Return the name of the type of care unit needed
"RTN","IBCEP3",69,0)
 ; IBINS = ien of ins co (file 36)
"RTN","IBCEP3",70,0)
 ; IBTYPE = 2:PERFORMING PROVIDER ID
"RTN","IBCEP3",71,0)
 I $G(IBTYPE)'=2 Q ""
"RTN","IBCEP3",72,0)
 Q $P($G(^DIC(36,+IBINS,4)),U,9)
"RTN","IBCEP3",73,0)
 ;
"RTN","IBCEP3",74,0)
DELID(IBIFN,IBSEQ,IBX) ; Delete all provider data specific to an ins co
"RTN","IBCEP3",75,0)
 ; represented by the COB sequence IBSEQ for bill IBIFN
"RTN","IBCEP3",76,0)
 ; IBX = 1 if called from care unit prompt - don't delete value
"RTN","IBCEP3",77,0)
 N IBZ,IBDR,X,Y,Z0,Z1
"RTN","IBCEP3",78,0)
 S IBZ=0
"RTN","IBCEP3",79,0)
 Q:'$G(IBSEQ)!($G(IBSEQ)>3)
"RTN","IBCEP3",80,0)
 F  S IBZ=$O(^DGCR(399,IBIFN,"PRV",IBZ)) Q:'IBZ  S Z0=$G(^(IBZ,0)),Z1=$G(^(1)) D
"RTN","IBCEP3",81,0)
 . ; Delete provider id's
"RTN","IBCEP3",82,0)
 . I $P(Z0,U,4+IBSEQ)'="" S IBDR(399.0222,IBZ_","_IBIFN_",",(4+IBSEQ/100))="@"
"RTN","IBCEP3",83,0)
 . ; Delete provider id types
"RTN","IBCEP3",84,0)
 . I $P(Z0,U,11+IBSEQ)'="" S IBDR(399.0222,IBZ_","_IBIFN_",",(11+IBSEQ/100))="@"
"RTN","IBCEP3",85,0)
 . I $D(IBDR) D FILE^DIE(,"IBDR")
"RTN","IBCEP3",86,0)
 Q
"RTN","IBCEP3",87,0)
 ;
"RTN","IBCEP3",88,0)
SETID(IBIFN,IBSEQ) ; Default provider id for bill IBIFN and ins co for COB
"RTN","IBCEP3",89,0)
 ; sequence IBSEQ
"RTN","IBCEP3",90,0)
 N IBZ,X,Y,IBDR,IBT
"RTN","IBCEP3",91,0)
 S IBZ=0
"RTN","IBCEP3",92,0)
 Q  ; No longer used as of patch 232
"RTN","IBCEP3",93,0)
 ;Q:'$G(IBSEQ)!($G(IBSEQ)>3)
"RTN","IBCEP3",94,0)
 ;F  S IBZ=$O(^DGCR(399,IBIFN,"PRV",IBZ)) Q:'IBZ  S Z0=$G(^(IBZ,0)),Z1=$G(^(1)) D
"RTN","IBCEP3",95,0)
 ;. ; Update provider id's if no care unit is needed
"RTN","IBCEP3",96,0)
 ;. I $P(Z0,U,2)'="" D
"RTN","IBCEP3",97,0)
 ;.. S Z=$$GETID^IBCEP2(IBIFN,2,$P(Z0,U,2),IBSEQ,.IBT)
"RTN","IBCEP3",98,0)
 ;.. I Z'="",IBT S IBDR(399.0222,IBZ_","_IBIFN_",",(4+IBSEQ/100))=Z,IBDR(399.0222,IBZ_","_IBIFN_",",(11+IBSEQ/100))=+IBT
"RTN","IBCEP3",99,0)
 ;. I $D(IBDR) D FILE^DIE(,"IBDR")
"RTN","IBCEP3",100,0)
 Q
"RTN","IBCEP3",101,0)
 ;
"RTN","IBCEP3",102,0)
ALLID(IBIFN,IBFLD,IBFUNC) ; If form type or care type (I/O/RX) changes,
"RTN","IBCEP3",103,0)
 ; determine new provider id values if possible and update them
"RTN","IBCEP3",104,0)
 ; this includes primary, secondary, tertiary id's
"RTN","IBCEP3",105,0)
 ; IBIFN = ien of claim (file 399)
"RTN","IBCEP3",106,0)
 ; IBFLD = ien of the field being changed when this call is made
"RTN","IBCEP3",107,0)
 ;         (.19 = form type   .25 = care type)
"RTN","IBCEP3",108,0)
 ; IBFUNC = 1 to add,  2 to delete
"RTN","IBCEP3",109,0)
 N Z,Z0,IBC,IBDR,IBT
"RTN","IBCEP3",110,0)
 S Z=0
"RTN","IBCEP3",111,0)
 F  S Z=$O(^DGCR(399,IBIFN,"PRV",Z)) Q:'Z  S Z0=$G(^(Z,0)) D
"RTN","IBCEP3",112,0)
 . F IBC=5:1:7 I $S(IBFUNC=2:$P(Z0,U,IBC)'="",1:1) S IBDR(399.0222,IBC_","_IBIFN_",",(IBC/100))=$S(IBFUNC=2:"@",1:$$GETID^IBCEP2(IBIFN,2,$P(Z0,U,2),IBC-4,.IBT))
"RTN","IBCEP3",113,0)
 I $D(IBDR) D FILE^DIE(,"IBDR")
"RTN","IBCEP3",114,0)
 Q
"RTN","IBCEP3",115,0)
 ;
"RTN","IBCEP3",116,0)
CUMNT ; Add/edit care unit
"RTN","IBCEP3",117,0)
 N D,DIE,DIC,DIK,DIR,DA,X,Y,IB,IBINS,IBF,IBCT,IBOK,IBPTYP,IBOLD,IBY,IBINS1,IBPTYP1,DUOUT,DTOUT
"RTN","IBCEP3",118,0)
INS F  D  Q:Y'>0
"RTN","IBCEP3",119,0)
 . S DIC="^DIC(36,",DIC(0)="AEMQ" D ^DIC K DIC
"RTN","IBCEP3",120,0)
 . I $D(DUOUT)!$D(DTOUT) S Y=-1 Q
"RTN","IBCEP3",121,0)
 . I Y'>0 S DIR(0)="EA",DIR("A")="Insurance Co is required - press enter to continue: " D ^DIR K DIR Q
"RTN","IBCEP3",122,0)
 . S IBINS=+Y,IBF="A",IBINS1=$P(Y,U,2)
"RTN","IBCEP3",123,0)
 I $O(^IBA(355.96,"D",IBINS,""))'="" D
"RTN","IBCEP3",124,0)
 . W ! S DIR("A")="(A)dd or (E)dit entries?: ",DIR("B")="Add",DIR(0)="SA^A:Add;E:Edit" D ^DIR W ! K DIR
"RTN","IBCEP3",125,0)
 . S IBF=Y
"RTN","IBCEP3",126,0)
 Q:$G(IBF)=""!("AE"'[$G(IBF))
"RTN","IBCEP3",127,0)
 ;
"RTN","IBCEP3",128,0)
 I IBINS>0 D
"RTN","IBCEP3",129,0)
 . I IBF="A" D NEW^IBCEP4A(1)
"RTN","IBCEP3",130,0)
 . I IBF="E" D CHANGE^IBCEP4A(1)
"RTN","IBCEP3",131,0)
 ;
"RTN","IBCEP3",132,0)
 Q
"RTN","IBCEP3",133,0)
 ;
"RTN","IBCEP3",134,0)
DUP(IBDA,IBOLD,IBFUNC) ; Check if the combination of ins co, prov type, care
"RTN","IBCEP3",135,0)
 ; type and form already exists in file 355.96
"RTN","IBCEP3",136,0)
 ; IBDA = ien of entry in file 355.96
"RTN","IBCEP3",137,0)
 ; IBOLD = the 0-node before changes were made - used to reset the fields
"RTN","IBCEP3",138,0)
 N DUP,IB0,DR,X,Y,DIK,DIE,DA
"RTN","IBCEP3",139,0)
 S IB0=$G(^IBA(355.96,IBDA,0)),DUP=0
"RTN","IBCEP3",140,0)
 ;
"RTN","IBCEP3",141,0)
 I $O(^IBA(355.96,"AUNIQ",+$P(IB0,U,3),+IB0,+$P(IB0,U,4),+$P(IB0,U,5),+$P(IB0,U,6),0))'=IBDA!($O(^IBA(355.96,"AUNIQ",+$P(IB0,U,3),+IB0,+$P(IB0,U,4),+$P(IB0,U,5),+$P(IB0,U,6),""),-1)'=IBDA) D
"RTN","IBCEP3",142,0)
 . S DUP=1
"RTN","IBCEP3",143,0)
 . I IBFUNC="E" D
"RTN","IBCEP3",144,0)
 .. S DR=";.01///"_$P(IBOLD,U)_";.03///"_$S($P(IBOLD,U,3)'="":"/"_$P(IBOLD,U,3),1:"@")_";.04///"_$S($P(IBOLD,U,4)'="":"/"_$P(IBOLD,U,4),1:"@")
"RTN","IBCEP3",145,0)
 .. S DR=DR_";05///"_$S($P(IBOLD,U,5)'="":"/"_$P(IBOLD,U,5),1:"@")_";.06///"_$S($P(IBOLD,U,6)'="":"/"_$P(IBOLD,U,6),1:"@")
"RTN","IBCEP3",146,0)
 .. S DA=IBDA,DIE="^IBA(355.96," D ^DIE
"RTN","IBCEP3",147,0)
 . I IBFUNC="A" D
"RTN","IBCEP3",148,0)
 .. S DA=IBDA,DIK="^IBA(355.96," D ^DIK
"RTN","IBCEP3",149,0)
 Q DUP
"RTN","IBCEP3",150,0)
 ;
"RTN","IBCEP3",151,0)
PROFID(IBIFN,IBSEQ,IBID) ; Return id and type of rendering provider id
"RTN","IBCEP3",152,0)
 ; used for insurance co at COB seq IBSEQ for bill ien IBIFN
"RTN","IBCEP3",153,0)
 ; RETURN VALUES:
"RTN","IBCEP3",154,0)
 ; piece 1:
"RTN","IBCEP3",155,0)
 ;  1 = FEDERAL TAX ID
"RTN","IBCEP3",156,0)
 ;  2 = INSURANCE CO SPECIFIC ID
"RTN","IBCEP3",157,0)
 ;  3 = NETWORK ID
"RTN","IBCEP3",158,0)
 ; "" = not a HCFA bill or no id found
"RTN","IBCEP3",159,0)
 ; piece 2:
"RTN","IBCEP3",160,0)
 ;  the id #
"RTN","IBCEP3",161,0)
 N IBTYP,IBXDATA,IBZ
"RTN","IBCEP3",162,0)
 S:'$G(IBSEQ) IBSEQ=+$$COBN^IBCEF(IBXIEN)
"RTN","IBCEP3",163,0)
 S IBTYP=""_U_$G(IBID)
"RTN","IBCEP3",164,0)
 G:$$FT^IBCEF(IBIFN)'=2 PROFIDQ
"RTN","IBCEP3",165,0)
 I '$D(IBID) D F^IBCEF("N-ALL ATT/RENDERING PROV ID","IBZ",,IBIFN) S IBID=$$NOPUNCT^IBCEF($P(IBZ,U,IBSEQ+1))
"RTN","IBCEP3",166,0)
 G:IBID="" PROFIDQ
"RTN","IBCEP3",167,0)
 S IBTYP=$S($$NOPUNCT^IBCEF(IBID)=$$NOPUNCT^IBCEF($P($G(^IBE(350.9,1,1)),U,5)):1,$$NETWRK(IBIFN,IBID,IBSEQ):3,1:2)
"RTN","IBCEP3",168,0)
 S IBTYP=IBTYP_U_IBID
"RTN","IBCEP3",169,0)
 ;
"RTN","IBCEP3",170,0)
PROFIDQ Q IBTYP
"RTN","IBCEP3",171,0)
 ;
"RTN","IBCEP3",172,0)
NETWRK(IBIFN,IBID,IBSEQ) ; Determine if ID number IBID is the same as the
"RTN","IBCEP3",173,0)
 ; network id for the insurance co
"RTN","IBCEP3",174,0)
 ;  IBIFN = bill ien (file 399)
"RTN","IBCEP3",175,0)
 ;  IBSEQ = COB seq # of bill
"RTN","IBCEP3",176,0)
 ;   Returns 1 if network ID match is found for bill IBIFN, COB seq IBSEQ
"RTN","IBCEP3",177,0)
 N IBINS,IBNET
"RTN","IBCEP3",178,0)
 S IBNET=0
"RTN","IBCEP3",179,0)
 Q IBNET
"RTN","IBCEP3",180,0)
 ; This section needs work *********
"RTN","IBCEP3",181,0)
 I '$G(IBSEQ) S IBSEQ=+$$COBN^IBCEF(IBXIEN)
"RTN","IBCEP3",182,0)
 S IBINS=+$G(^DGCR(399,IBIFN,"I"_IBSEQ))
"RTN","IBCEP3",183,0)
 I $P($G(^IBE(355.97,+$$PPTYP^IBCEP0(IBINS),1)),U,6) D
"RTN","IBCEP3",184,0)
 . ; performing provider id type is a network id type
"RTN","IBCEP3",185,0)
 . I $$NOPUNCT^IBCEF($G(IBID))=$$NOPUNCT^IBCEF($$GETID^IBCEP2(IBIFN,3,$$PERFPRV^IBCEP2A(IBIFN),IBSEQ)) S IBNET=1
"RTN","IBCEP3",186,0)
 Q IBNET
"RTN","IBCEP3",187,0)
 ;
"RTN","IBCEP3",188,0)
 ;
"RTN","IBCEP3",189,0)
 ; Parameter definitions for UNIQ1 and UNIQ2 in IBCEP2
"RTN","IBCEP3",190,0)
 ;   IBIFN = ien of bill (file 399)
"RTN","IBCEP3",191,0)
 ;   IBINS = ien of insurance co (file 36) or *ALL* for all insurance
"RTN","IBCEP3",192,0)
 ;   IBPTYP = the ien of the provider id type in file 355.97
"RTN","IBCEP3",193,0)
 ;   IBUNIT = the value of the specific care unit to use for a match
"RTN","IBCEP3",194,0)
 ;            or *N/A* if none needed
"RTN","IBCEP3",195,0)
 ;   IBCU = the ien of the entry being matched in start file
"RTN","IBCEP3",196,0)
 ;   IBT = the second and third pieces are set to the entry ien^file #
"RTN","IBCEP4A")
0^5^B49012479
"RTN","IBCEP4A",1,0)
IBCEP4A ;ALB/TMP - EDI UTILITIES for provider ID ;29-SEP-00
"RTN","IBCEP4A",2,0)
 ;;2.0;INTEGRATED BILLING;**137,232,280**;21-MAR-94
"RTN","IBCEP4A",3,0)
 ;
"RTN","IBCEP4A",4,0)
NEW(IB) ; Add care unit
"RTN","IBCEP4A",5,0)
 ; Assumes IBINS is defined as ins co ien (file 36)
"RTN","IBCEP4A",6,0)
 ; IB = 0 or null if called from list manager, 1 if not
"RTN","IBCEP4A",7,0)
 N DIC,DIR,X,Y,Z,DA,DR,DIE,DO,DD,DLAYGO,IB95,IBADD,IBOK
"RTN","IBCEP4A",8,0)
 I '$G(IB) D FULL^VALM1
"RTN","IBCEP4A",9,0)
 ;
"RTN","IBCEP4A",10,0)
 ; Add an entry - either new care unit/ins co or a combination for
"RTN","IBCEP4A",11,0)
 ;  existing care unit/ins co
"RTN","IBCEP4A",12,0)
 S DIC("A")="SELECT CARE UNIT FOR THE INSURANCE CO: ",DIC="^IBA(355.95,",DIC("S")="I $P(^(0),U,3)=+$G(IBINS)",DIC(0)="AELMQ",DIC("DR")=".03////"_+$G(IBINS)_";.02",DLAYGO=355.95 D ^DIC K DIC,DLAYGO
"RTN","IBCEP4A",13,0)
 G:Y'>0 NEWQ
"RTN","IBCEP4A",14,0)
 S IB95=3,IB95("IBCU")=+Y
"RTN","IBCEP4A",15,0)
 D INSASS(IBINS,.IB95)
"RTN","IBCEP4A",16,0)
 I '$G(IB) D BLD^IBCEP4
"RTN","IBCEP4A",17,0)
NEWQ I '$G(IB) S VALMBCK="R"
"RTN","IBCEP4A",18,0)
 Q
"RTN","IBCEP4A",19,0)
 ;
"RTN","IBCEP4A",20,0)
CHANGE(IB) ; Edit a care unit name or combination for ins co IBINS
"RTN","IBCEP4A",21,0)
 ; Assumes IBINS is defined as ins co ien (file 36)
"RTN","IBCEP4A",22,0)
 ; IB = 0 or null if called from list manager, 1 if not
"RTN","IBCEP4A",23,0)
 N DIC,DIK,DIR,X,Y,Z,DA,DR,DIE,DO,DD,DLAYGO,IB95,IBOK,IBZ,IB0,IBEDIT,IBCK,IBDA,IBCHG,IBDELETE,Z100,DTOUT,DUOUT
"RTN","IBCEP4A",24,0)
 I '$G(IB) D FULL^VALM1
"RTN","IBCEP4A",25,0)
 S DIC("A")="CARE UNIT NAME: ",DIC(0)="AEMQ",DIC("S")="I $P(^(0),U,3)=+$G(IBINS)",DIC="^IBA(355.95," W ! D ^DIC K DIC
"RTN","IBCEP4A",26,0)
 I Y'>0 G CHGQ
"RTN","IBCEP4A",27,0)
 S IB95("IBCU")=+Y,IBDELETE=0,IBDELETE(0)=$G(^IBA(355.95,0)),IBDELETE(1)=$G(^(1))
"RTN","IBCEP4A",28,0)
 ; Edit fields outside of FM to assure uniqueness of combos is maintained
"RTN","IBCEP4A",29,0)
 W ! S DIR("A")="CARE UNIT NAME: ",DIR("B")=$P($G(^IBA(355.95,+IB95("IBCU"),0)),U),DIR(0)="355.95,.01AO",DIR("S")="I $P(^(0),U,3)=IBINS" D ^DIR K DIR
"RTN","IBCEP4A",30,0)
 I $D(DTOUT)!$D(DUOUT) G CHGQ
"RTN","IBCEP4A",31,0)
 ;
"RTN","IBCEP4A",32,0)
 ; Care unit name was deleted
"RTN","IBCEP4A",33,0)
 I X="@" D  G CHGQ
"RTN","IBCEP4A",34,0)
 . S DIR("A",1)="THIS WILL DELETE THE CARE UNIT NAME AND ALL ITS COMBINATIONS",DIR("A")="ARE YOU SURE THIS IS WHAT YOU WANT TO DO?: ",DIR(0)="YA",DIR("B")="NO" D ^DIR K DIR
"RTN","IBCEP4A",35,0)
 . I Y'=1 S IB95("IBCU")="" Q  ; Changed their mind - don't delete
"RTN","IBCEP4A",36,0)
 . S Z=0 F  S Z=$O(^IBA(355.96,"B",IB95("IBCU"),Z)) Q:'Z  S DIK="^IBA(355.96,",DA=Z D ^DIK
"RTN","IBCEP4A",37,0)
 . S DA=IB95("IBCU"),DIK="^IBA(355.95," D ^DIK
"RTN","IBCEP4A",38,0)
 . W ! S DIR(0)="EA",DIR("A",1)="CARE UNIT AND ALL ITS COMBINATIONS WERE DELETED",DIR("A")="PRESS ENTER TO CONTINUE " D ^DIR K DIR D BLD^IBCEP4
"RTN","IBCEP4A",39,0)
 ;
"RTN","IBCEP4A",40,0)
 I $P($G(^IBA(355.95,IB95("IBCU"),0)),U)'=Y S DIE="^IBA(355.95,",DR=".01///"_Y,DA=IB95("IBCU") D ^DIE ; File the name change
"RTN","IBCEP4A",41,0)
 S DR=".02",DIE="^IBA(355.95,",DA=IB95("IBCU") D ^DIE
"RTN","IBCEP4A",42,0)
 I $D(Y) G CHGQ
"RTN","IBCEP4A",43,0)
 ;
"RTN","IBCEP4A",44,0)
 I $O(^IBA(355.96,"ACARE",IB95("IBCU"),""))="" S IB95=3 D INSASS(IBINS,.IB95) G CHGQ
"RTN","IBCEP4A",45,0)
 ; only 1 combination found for ins/care unit
"RTN","IBCEP4A",46,0)
 I $O(^IBA(355.96,"ACARE",IB95("IBCU"),""),-1)=$O(^IBA(355.96,"ACARE",IB95("IBCU"),0)) D
"RTN","IBCEP4A",47,0)
 . S IBDA=$O(^IBA(355.96,"ACARE",IB95("IBCU"),0))
"RTN","IBCEP4A",48,0)
 ;
"RTN","IBCEP4A",49,0)
 ; Choose the combination to edit - more than 1 exists
"RTN","IBCEP4A",50,0)
 E  D
"RTN","IBCEP4A",51,0)
 . W !,"SELECT ONE OF THE FOLLOWING CARE UNIT COMBINATIONS:"
"RTN","IBCEP4A",52,0)
 . S DIC="^IBA(355.96,",DIC(0)="EMQ",DIC("S")="I $D(^IBA(355.96,""ACARE"","_IB95("IBCU")_",Y))",X=IBINS D ^DIC K DIC S IBDA=+Y
"RTN","IBCEP4A",53,0)
 ;
"RTN","IBCEP4A",54,0)
 I IBDA>0 D
"RTN","IBCEP4A",55,0)
 . N IBDA0,Q,Q0
"RTN","IBCEP4A",56,0)
 . S IBDA0=$G(^IBA(355.96,IBDA,0))
"RTN","IBCEP4A",57,0)
 . Q:IBDA0=""
"RTN","IBCEP4A",58,0)
 . W !!,"*** CARE UNIT COMBINATION FOR: ",$P($G(^IBA(355.95,+IB95("IBCU"),0)),U)," ***"
"RTN","IBCEP4A",59,0)
 . D DISP^IBCEP4("Q",IBINS,$P(IBDA0,U,6),$P(IBDA0,U,4),$P(IBDA0,U,5),1,.Q0)
"RTN","IBCEP4A",60,0)
 . S Z=0 F  S Z=$O(Q(Z)) Q:'Z  W !,Q(Z)
"RTN","IBCEP4A",61,0)
 . I $P(IBDA0,U,7) W !,"EXP DATE: ",$$FMTE^XLFDT($P(IBDA0,U,7),"2D")
"RTN","IBCEP4A",62,0)
 . W !,"CARE UNIT: ",$P($G(^IBA(355.95,+IBDA0,0)),U),!
"RTN","IBCEP4A",63,0)
 . W ! S DIR(0)="SA^E:EDIT;D:DELETE",DIR("B")="EDIT",DIR("A")="EDIT OR DELETE THIS CARE UNIT COMBINATION?: " D ^DIR K DIR
"RTN","IBCEP4A",64,0)
 . I $D(DTOUT)!$D(DUOUT) Q
"RTN","IBCEP4A",65,0)
 . I Y="D" D  Q
"RTN","IBCEP4A",66,0)
 .. S DIR(0)="YA",DIR("A")="ARE YOU SURE YOU WANT TO DELETE THIS CARE UNIT COMBINATION?: ",DIR("B")="NO" D ^DIR K DIR
"RTN","IBCEP4A",67,0)
 .. I Y=1 S DIK="^IBA(355.96,",DA=IBDA,IBCHG=1 D ^DIK
"RTN","IBCEP4A",68,0)
 . S (IBCK,IBCHG)=0,(IBEDIT,IBOK)=1
"RTN","IBCEP4A",69,0)
 . F  Q:'IBEDIT  S IBEDIT=0,IB0=$G(^IBA(355.96,+IBDA,0)) K IBZ F Z=.01,.03,.06,.04,.05 D  Q:'IBOK!IBEDIT
"RTN","IBCEP4A",70,0)
 .. S Z100=Z*100
"RTN","IBCEP4A",71,0)
 .. I Z100=1 W !,"CARE UNIT: ",$P($G(^IBA(355.95,IB95("IBCU"),0)),U) S IBZ(.01)=$P(IB0,U) Q
"RTN","IBCEP4A",72,0)
 .. I Z100=3 W !,"INSURANCE COMPANY: ",$$EXPAND^IBTRE(355.96,.03,$P(IB0,U,3)) S IBZ(.03)=$P(IB0,U) Q
"RTN","IBCEP4A",73,0)
 .. I Z100=5 S IBCK=1
"RTN","IBCEP4A",74,0)
 .. S IBZ(Z)=$$EDIT(Z,IB0,+IBDA,IBCK),IBCK=0
"RTN","IBCEP4A",75,0)
 .. I '$P(IBZ(Z),U,2) D  Q
"RTN","IBCEP4A",76,0)
 ... I $P(IB0,U,Z100)'=IBZ(Z) S IBCHG=1
"RTN","IBCEP4A",77,0)
 ... S $P(IB0,U,Z100)=IBZ(Z)
"RTN","IBCEP4A",78,0)
 .. S (IBOK,IBCHG)=0
"RTN","IBCEP4A",79,0)
 .. I $P(IBZ(Z),U,2)=2 D
"RTN","IBCEP4A",80,0)
 ... S DIR(0)="YA",DIR("A",1)="This entry already exists",DIR("A")="Do you want to re-edit?: " W ! D ^DIR K DIR W !
"RTN","IBCEP4A",81,0)
 ... I Y=1 S (IBOK,IBEDIT)=1
"RTN","IBCEP4A",82,0)
 . I IBOK Q:'IBCHG  S DIE="^IBA(355.96,",DR=".03////"_IBZ(.03)_";.04////"_IBZ(.04)_";.05////"_IBZ(.05)_";.06////"_IBZ(.06)_";.07",DA=+IBDA D ^DIE,BLD^IBCEP4 Q
"RTN","IBCEP4A",83,0)
 ;
"RTN","IBCEP4A",84,0)
 I '$G(IB) D BLD^IBCEP4
"RTN","IBCEP4A",85,0)
CHGQ I '$G(IB) S VALMBCK="R"
"RTN","IBCEP4A",86,0)
 Q
"RTN","IBCEP4A",87,0)
 ;
"RTN","IBCEP4A",88,0)
INSASS(IBINSZ,IB95) ; Assign care unit to or delete from an ins co
"RTN","IBCEP4A",89,0)
 ; IBINSZ = ien of ins co (file 36)
"RTN","IBCEP4A",90,0)
 ; IB95 = flag  ("IBCU")=care unit
"RTN","IBCEP4A",91,0)
 ;     can have subscripts to send in pre-entered data
"RTN","IBCEP4A",92,0)
 N DIR,DIC,DA,DR,X,Y,Z,IBFT,IBCT,IBPTYP,IBCU,IBCHG,IBINS,IBDA,IBPXDT,IBDICS
"RTN","IBCEP4A",93,0)
 S IBINS=IBINSZ
"RTN","IBCEP4A",94,0)
 S IBCHG=0,IBCU=$G(IB95("IBCU"))
"RTN","IBCEP4A",95,0)
 D FULL^VALM1
"RTN","IBCEP4A",96,0)
 I '$G(IBINSZ) K IB95 G INSQ
"RTN","IBCEP4A",97,0)
 W !
"RTN","IBCEP4A",98,0)
 F Z=.06,.04,.05,.07,.03 D  G:Z="" INSQ
"RTN","IBCEP4A",99,0)
 . ;
"RTN","IBCEP4A",100,0)
 . I $S(Z=.04:'$D(IB95("IBFT")),Z=.05:'$D(IB95("IBCT")),Z=.06:'$D(IB95("IBPTYP")),Z=.03:'$D(IB95("IBCU")),1:1) D
"RTN","IBCEP4A",101,0)
 .. N DA
"RTN","IBCEP4A",102,0)
 .. K IBDICS
"RTN","IBCEP4A",103,0)
 .. I Z=.04 D
"RTN","IBCEP4A",104,0)
 ... I $P($G(^IBE(355.97,+$G(IB95("IBPTYP")),0)),U,3)="1A" S IBDICS="I Y'=1 K X",DIR("B")="UB92",DIR("?")="ONLY UB92 IS VALID FOR A BLUE CROSS ID"
"RTN","IBCEP4A",105,0)
 .. S DIR(0)="355.96,"_Z_$S($G(IBDICS)="":"",1:"^^"_IBDICS) D ^DIR K DIR
"RTN","IBCEP4A",106,0)
 . I $D(DTOUT)!$D(DUOUT) S VALMBCK="R",Z="" K:$G(IB95)=2 IB95 Q
"RTN","IBCEP4A",107,0)
 . ;
"RTN","IBCEP4A",108,0)
 . I Z=.04 S IBFT=$S($G(IB95("IBFT"))="":+Y,1:IB95("IBFT")) S IB95("IBFT")=IBFT Q
"RTN","IBCEP4A",109,0)
 . ;
"RTN","IBCEP4A",110,0)
 . I Z=.05 S IBCT=$S($G(IB95("IBCT"))="":+Y,1:IB95("IBCT")) S IB95("IBCT")=IBCT Q
"RTN","IBCEP4A",111,0)
 . ;
"RTN","IBCEP4A",112,0)
 . I Z=.06 S IBPTYP=$S($G(IB95("IBPTYP"))="":+Y,1:IB95("IBPTYP")) S IB95("IBPTYP")=IBPTYP Q
"RTN","IBCEP4A",113,0)
 . ;
"RTN","IBCEP4A",114,0)
 . I Z=.07 S IBPXDT=$S('$G(IB95("IBEXPDT")):+Y,1:IB95("IBEXPDT")) S IB95("IBEXPDT")=IBPXDT Q
"RTN","IBCEP4A",115,0)
 . ;
"RTN","IBCEP4A",116,0)
 . I Z=.03,$G(IB95)=3,$G(IB95("IBCU"))'="" D  Q:Z=""
"RTN","IBCEP4A",117,0)
 .. N Q  ; Assign from add care type
"RTN","IBCEP4A",118,0)
 .. S IBCT=0
"RTN","IBCEP4A",119,0)
 .. W !,"CARE UNIT: "_$$EXPAND^IBTRE(355.96,.01,IB95("IBCU"))
"RTN","IBCEP4A",120,0)
 .. S IB95("IBINS")=+IBINSZ
"RTN","IBCEP4A",121,0)
 .. I $D(^IBA(355.96,"AUNIQ",IBINSZ,IB95("IBCU"),IB95("IBFT"),IB95("IBCT"),IB95("IBPTYP"))) D  Q
"RTN","IBCEP4A",122,0)
 ... S DIR(0)="EA",DIR("A",1)="This combination already exists - NOT ADDED",DIR("A")="Press ENTER to continue" W ! D ^DIR K DIR W !
"RTN","IBCEP4A",123,0)
 .. S IBCT=1 S Y=$$ADDCU(IBINSZ,IB95("IBCU"),IB95("IBFT"),IB95("IBCT"),IB95("IBPTYP"))
"RTN","IBCEP4A",124,0)
 .. I Y<0 W ! S DIR("A",1)="  >> Care Unit NOT completely filed",DIR("A")="PRESS ENTER TO CONTINUE ",DIR(0)="EA" D ^DIR K DIR Q
"RTN","IBCEP4A",125,0)
 .. W ! S DIR(0)="EA",DIR("A",1)="  >> CARE UNIT COMBINATION FILED FOR THE INSURANCE CO",IBCT=1,IBCHG=1,DIR("A")="PRESS ENTER TO CONTINUE ",DIR(0)="EA" D ^DIR K DIR
"RTN","IBCEP4A",126,0)
 I $G(IBCHG) D BLD^IBCEP4
"RTN","IBCEP4A",127,0)
INSQ S VALMBCK="R"
"RTN","IBCEP4A",128,0)
 Q
"RTN","IBCEP4A",129,0)
 ;
"RTN","IBCEP4A",130,0)
EDIT(IBFLD,IB0,IBIEN,IBCK1) ; Allow addition/edit of fields in file 355.96
"RTN","IBCEP4A",131,0)
 ; without direct Fileman call so uniqueness can be checked
"RTN","IBCEP4A",132,0)
 ; IBFLD = field # in file 355.96
"RTN","IBCEP4A",133,0)
 ; IB0 = current 0-node of data in the entry in file 355.96
"RTN","IBCEP4A",134,0)
 ; IBIEN = ien of entry being edited in file 355.96
"RTN","IBCEP4A",135,0)
 ; IBCK1 = flag ... if 1, checks for uniqueness after field changed
"RTN","IBCEP4A",136,0)
 ;
"RTN","IBCEP4A",137,0)
 ; FUNCTION RETURNS: value of field if field is OK, second piece is null
"RTN","IBCEP4A",138,0)
 ;                   If not good, 2nd piece = 1 : no data or ^ entered
"RTN","IBCEP4A",139,0)
 ;                                          = 2 : record not unique
"RTN","IBCEP4A",140,0)
 N DIR,DA,Y,X,IBNEW,IBINS,IBVAL
"RTN","IBCEP4A",141,0)
 S IBINS=+IB0,IBNEW="",IBVAL=$$EXPAND^IBTRE(355.96,IBFLD,$P(IB0,U,(IBFLD*100)))
"RTN","IBCEP4A",142,0)
 S DIR(0)="355.96,"_IBFLD
"RTN","IBCEP4A",143,0)
 S:IBVAL'="" DIR("B")=IBVAL
"RTN","IBCEP4A",144,0)
 D ^DIR K DIR
"RTN","IBCEP4A",145,0)
 I Y=""!$D(DTOUT)!$D(DUOUT) S IBNEW="^1" G EDITQ
"RTN","IBCEP4A",146,0)
 S IBNEW=$P(Y,U)
"RTN","IBCEP4A",147,0)
 I $G(IBCK1) D
"RTN","IBCEP4A",148,0)
 . N X1,X2,X3,X4,X5
"RTN","IBCEP4A",149,0)
 . S X1=$S(IBFLD'=.03:IBINS,1:IBNEW),X2=$S(IBFLD'=.01:$P(IB0,U),1:IBNEW),X3=$S(IBFLD'=.04:$P(IB0,U,4),1:IBNEW),X4=$S(IBFLD'=.05:$P(IB0,U,5),1:IBNEW),X5=$S(IBFLD'=.06:$P(IB0,U,6),1:IBNEW)
"RTN","IBCEP4A",150,0)
 . I $S(X1=""!(X2="")!(X3="")!(X4="")!(X5=""):1,$O(^IBA(355.96,"AUNIQ",X1,X2,X3,X4,X5,0)):$O(^(0))'=IBIEN,1:0) S IBNEW=IBNEW_"^2"
"RTN","IBCEP4A",151,0)
 ;
"RTN","IBCEP4A",152,0)
EDITQ Q IBNEW
"RTN","IBCEP4A",153,0)
 ;
"RTN","IBCEP4A",154,0)
ADDCU(IBINSZ,IBCU,IBFT,IBCT,IBPTYP) ;  Add a new care unit record to file 355.96
"RTN","IBCEP4A",155,0)
 ; Same parameter definitions as EDIT
"RTN","IBCEP4A",156,0)
 N DIC,DA,X,Y,DLAYGO
"RTN","IBCEP4A",157,0)
 S DIC(0)="L",DLAYGO=355.96,DIC="^IBA(355.96,",DIC("DR")=".03////"_IBINSZ_";.04////"_IBFT_";.05////"_IBCT_";.06////"_IBPTYP,X=IBCU
"RTN","IBCEP4A",158,0)
 D FILE^DICN
"RTN","IBCEP4A",159,0)
 Q Y
"RTN","IBCEP4A",160,0)
 ;
"RTN","IBY280PO")
0^^B3608190
"RTN","IBY280PO",1,0)
IBY280PO ;ALB/TMK - IB*2*280 POST-INSTALL ;17-AUG-04
"RTN","IBY280PO",2,0)
 ;;2.0;INTEGRATED BILLING;**280**;21-MAR-94
"RTN","IBY280PO",3,0)
 ;
"RTN","IBY280PO",4,0)
 N A,DLAYGO,DIC,DIE,DIK,DA,DR,DO,DD,Y,X,Z,Z0,Z1,Z3
"RTN","IBY280PO",5,0)
 D BMES^XPDUTL("Post-Installation Updates")
"RTN","IBY280PO",6,0)
 ;
"RTN","IBY280PO",7,0)
 D BMES^XPDUTL("Moving LINE ITEM REMARKS for EEOBs to new fields")
"RTN","IBY280PO",8,0)
EN S Z=0 F  S Z=$O(^IBM(361.1,Z)) Q:'Z  S Z0=0 F  S Z0=$O(^IBM(361.1,Z,15,Z0)) Q:'Z0  S Z3=$G(^(Z0,3)) I Z3'="" D
"RTN","IBY280PO",9,0)
 . K A,DO,DD,DIC,DA,DLAYGO
"RTN","IBY280PO",10,0)
 . S X=1,DA(2)=Z,DA(1)=Z0,DIC="^IBM(361.1,"_DA(2)_",15,"_DA(1)_",4,",DIC(0)="L"
"RTN","IBY280PO",11,0)
 . S DIC("DR")="",DLAYGO=361.115
"RTN","IBY280PO",12,0)
 . S DIC("DR")=$S($P(Z3,U)'="":".02////"_$P(Z3,U),1:"")
"RTN","IBY280PO",13,0)
 . S DIC("DR")=DIC("DR")_$S($P(Z3,U,2)'="":$S(DIC("DR")'="":";",1:"")_".03////"_$P(Z3,U,2),1:"")
"RTN","IBY280PO",14,0)
 . I '$D(^IBM(361.1,DA(2),15,DA(1),4,1,0)) D FILE^DICN Q:Y'>0
"RTN","IBY280PO",15,0)
 . M A=DA K DA
"RTN","IBY280PO",16,0)
 . S DA(1)=A(2),DA=A(1)
"RTN","IBY280PO",17,0)
 . I Y>0 S DIE="^IBM(361.1,"_DA(1)_",15,",DR="3.01///@;3.02///@" D ^DIE K ^IBM(361.1,DA(1),15,DA,3)
"RTN","IBY280PO",18,0)
 D ENDST
"RTN","IBY280PO",19,0)
 ;
"RTN","IBY280PO",20,0)
 ; search for all records in file 355.3 that contain internal code
"RTN","IBY280PO",21,0)
        ; TR in field .15 (Electronic Plan Type) and change it back to CH.
"RTN","IBY280PO",22,0)
 D BMES^XPDUTL("Reconvert 'TR' code to 'CH' for ELECTRONIC PLAN TYPE in file 355.3")
"RTN","IBY280PO",23,0)
        S DA=0
"RTN","IBY280PO",24,0)
        F  S DA=$O(^IBA(355.3,DA)) Q:'DA  D
"RTN","IBY280PO",25,0)
        . Q:$P($G(^IBA(355.3,DA,0)),U,15)'="TR"
"RTN","IBY280PO",26,0)
        . S DIE="^IBA(355.3,",DR=".15////CH" D ^DIE
"RTN","IBY280PO",27,0)
 ;
"RTN","IBY280PO",28,0)
 D ENDST
"RTN","IBY280PO",29,0)
 ;
"RTN","IBY280PO",30,0)
 D END
"RTN","IBY280PO",31,0)
 Q
"RTN","IBY280PO",32,0)
 ;
"RTN","IBY280PO",33,0)
ENDST ; End step
"RTN","IBY280PO",34,0)
 D BMES^XPDUTL("Step complete")
"RTN","IBY280PO",35,0)
 Q
"RTN","IBY280PO",36,0)
 ;
"RTN","IBY280PO",37,0)
END ; End
"RTN","IBY280PO",38,0)
 D BMES^XPDUTL("Post-install complete")
"RTN","IBY280PO",39,0)
 Q
"RTN","IBY280PO",40,0)
 ;
"RTN","IBY280PR")
0^^B8812273
"RTN","IBY280PR",1,0)
IBY280PR ;ALB/TMK - IB*2*280 PRE-INSTALL ;12-AUG-04
"RTN","IBY280PR",2,0)
 ;;2.0;INTEGRATED BILLING;**280**;21-MAR-94
"RTN","IBY280PR",3,0)
 ;
"RTN","IBY280PR",4,0)
 N INS,IBX,DIC,DIE,DIK,DA,DR,Y,X
"RTN","IBY280PR",5,0)
 D BMES^XPDUTL("Pre-Installation Updates")
"RTN","IBY280PR",6,0)
 ;
"RTN","IBY280PR",7,0)
 D BMES^XPDUTL("Restore remote member in mail group MCR")
"RTN","IBY280PR",8,0)
 N IBMCR,IBMCH,DLAYGO,DIC,DIK,DA,DO,DD,Z,Z0 ; IA 4439
"RTN","IBY280PR",9,0)
 S IBMCR=+$O(^XMB(3.8,"B","MCR",0)),IBMCH=+$O(^XMB(3.8,"B","MCH",0)) S Z=0 F  S Z=$O(^XMB(3.8,IBMCH,6,Z)) Q:'Z  S Z0=$P($G(^XMB(3.8,IBMCH,6,Z,0)),U) I Z0'="" D
"RTN","IBY280PR",10,0)
 . I '$D(^XMB(3.8,IBMCR,6,"B",$E(Z0,1,30))) D
"RTN","IBY280PR",11,0)
 .. S DLAYGO=3.812,DIC(0)="L",X=Z0,DA(1)=IBMCR,DIC="^XMB(3.8,"_DA(1)_",6," D FILE^DICN K DO,DD,DA,DLAYGO,DIC
"RTN","IBY280PR",12,0)
 ;
"RTN","IBY280PR",13,0)
 D BMES^XPDUTL("Updating/removing output formatter records")
"RTN","IBY280PR",14,0)
 ;
"RTN","IBY280PR",15,0)
 ; Make CI1-7 data element allow local override
"RTN","IBY280PR",16,0)
 S DA=1316,DIE="^IBA(364.6,",DR=".07////1" D ^DIE
"RTN","IBY280PR",17,0)
 ;
"RTN","IBY280PR",18,0)
 ; Delete entries 158/210 left over from changes to patch 232
"RTN","IBY280PR",19,0)
 F DA=158,210 S DIK="^IBA(364.7," D ^DIK
"RTN","IBY280PR",20,0)
 ;
"RTN","IBY280PR",21,0)
 ; Remove FL56 data from transmission file
"RTN","IBY280PR",22,0)
 F DA=906:1:910 D
"RTN","IBY280PR",23,0)
 . S DIE="^IBA(364.7,",DR=".03////5;1///K IBXDATA" D ^DIE
"RTN","IBY280PR",24,0)
 . S IBX(1)="Data is no longer transmitted."
"RTN","IBY280PR",25,0)
 . D WP^DIE(364.7,DA_",",3,"","IBX")
"RTN","IBY280PR",26,0)
 ;
"RTN","IBY280PR",27,0)
 D ENDST
"RTN","IBY280PR",28,0)
 ;
"RTN","IBY280PR",29,0)
 D BMES^XPDUTL("Update Provider ID types")
"RTN","IBY280PR",30,0)
 ; Correct X12 codes for provider ID types
"RTN","IBY280PR",31,0)
 S IBX=0
"RTN","IBY280PR",32,0)
 F  S IBX=$O(^IBE(355.97,IBX)) Q:+IBX=0  D
"RTN","IBY280PR",33,0)
 . Q:'$D(^IBE(355.97,IBX,0))
"RTN","IBY280PR",34,0)
 . S INS=$P(^IBE(355.97,IBX,0),"^",1)
"RTN","IBY280PR",35,0)
 . Q:INS=""
"RTN","IBY280PR",36,0)
 . I INS["CROSS" S $P(^IBE(355.97,IBX,0),"^",3)="1A"
"RTN","IBY280PR",37,0)
 . I INS["SHIELD" S $P(^IBE(355.97,IBX,0),"^",3)="1B"
"RTN","IBY280PR",38,0)
 . I INS["CHAMPUS"!(INS["TRICARE") S $P(^IBE(355.97,IBX,0),"^",3)="1H" I INS["CHAMPUS" S DA=IBX,DR=".01////TRICARE ID",DIE="^IBE(355.97," D ^DIE
"RTN","IBY280PR",39,0)
 . I INS["COMMER" S $P(^IBE(355.97,IBX,0),"^",3)="G2"
"RTN","IBY280PR",40,0)
 . I INS["CLIA" S $P(^IBE(355.97,IBX,0),"^",3)="X4"
"RTN","IBY280PR",41,0)
 . I INS["MEDICARE" S $P(^IBE(355.97,IBX,0),"^",3)="1C"
"RTN","IBY280PR",42,0)
 . I INS["TAX" S $P(^IBE(355.97,IBX,0),"^",3)="24"
"RTN","IBY280PR",43,0)
 . I INS["NETWORK" S $P(^IBE(355.97,IBX,0),"^",3)="N5"
"RTN","IBY280PR",44,0)
 . I INS["UPIN" S $P(^IBE(355.97,IBX,0),"^",3)="1G",$P(^(0),U,2)=0
"RTN","IBY280PR",45,0)
 . I INS["PPO" S $P(^IBE(355.97,IBX,0),"^",3)="B3"
"RTN","IBY280PR",46,0)
 . I INS["HMO" S $P(^IBE(355.97,IBX,0),"^",3)="BQ"
"RTN","IBY280PR",47,0)
 . I INS["SOCIAL" S $P(^IBE(355.97,IBX,0),"^",3)="SY"
"RTN","IBY280PR",48,0)
 . I INS["STATE" S $P(^IBE(355.97,IBX,0),"^",3)=$S(INS["LICENSE":"0B",1:"X5")
"RTN","IBY280PR",49,0)
 ;
"RTN","IBY280PR",50,0)
 D ENDST
"RTN","IBY280PR",51,0)
 ;
"RTN","IBY280PR",52,0)
 D BMES^XPDUTL("Remove xref on INSURANCE CO file, field 4.1 and delete bad values")
"RTN","IBY280PR",53,0)
 D DELIX^DDMOD(36,4.1,1,"","")
"RTN","IBY280PR",54,0)
 I $G(^IBA(364.7,1015,1))'["4010" S INS=0 F  S INS=$O(^DIC(36,INS)) Q:'INS  D
"RTN","IBY280PR",55,0)
 . S DR="4.01///@;4.02///@",DA=INS,DIE="^DIC(36," D ^DIE
"RTN","IBY280PR",56,0)
 ;
"RTN","IBY280PR",57,0)
 D ENDST
"RTN","IBY280PR",58,0)
 ;
"RTN","IBY280PR",59,0)
 D END
"RTN","IBY280PR",60,0)
 Q
"RTN","IBY280PR",61,0)
 ;
"RTN","IBY280PR",62,0)
ENDST ;
"RTN","IBY280PR",63,0)
 D BMES^XPDUTL("Step complete")
"RTN","IBY280PR",64,0)
 Q
"RTN","IBY280PR",65,0)
 ;
"RTN","IBY280PR",66,0)
END ;
"RTN","IBY280PR",67,0)
 D BMES^XPDUTL("Pre-install complete")
"RTN","IBY280PR",68,0)
 Q
"RTN","IBY280PR",69,0)
 ;
"UP",361.1,361.1154,-2)
361.1^15
"UP",361.1,361.1154,-1)
361.115^4
"UP",361.1,361.1154,0)
361.1154
"VER")
8.0^22.0
"^DD",350.8,350.8,0)
FIELD^^10^7
"^DD",350.8,350.8,0,"DDA")
N
"^DD",350.8,350.8,0,"DT")
2930322
"^DD",350.8,350.8,0,"ID",.03)
W "   ",$P(^(0),U,3)
"^DD",350.8,350.8,0,"IX","AC",350.8,.03)

"^DD",350.8,350.8,0,"IX","B",350.8,.01)

"^DD",350.8,350.8,0,"IX","C",350.8,.03)

"^DD",350.8,350.8,0,"NM","IB ERROR")
 
"^DD",350.8,350.8,0,"VRPK")
IB
"^DD",350.8,350.8,.01,0)
NAME^RF^^0;1^K:$L(X)>30!(X?.N)!($L(X)<3)!'(X'?1P.E) X
"^DD",350.8,350.8,.01,1,0)
^.1
"^DD",350.8,350.8,.01,1,1,0)
350.8^B
"^DD",350.8,350.8,.01,1,1,1)
S ^IBE(350.8,"B",$E(X,1,30),DA)=""
"^DD",350.8,350.8,.01,1,1,2)
K ^IBE(350.8,"B",$E(X,1,30),DA)
"^DD",350.8,350.8,.01,3)
NAME MUST BE 3-30 CHARACTERS, NOT NUMERIC OR STARTING WITH PUNCTUATION
"^DD",350.8,350.8,.01,21,0)
^^2^2^2910305^^
"^DD",350.8,350.8,.01,21,1,0)
This is a free text name of the entry.  It should be namespaced with
"^DD",350.8,350.8,.01,21,2,0)
the namespace of the package reporting the error.
"^DD",350.8,350.8,.02,0)
ERROR MESSAGE^F^^0;2^K:$L(X)>80!($L(X)<3) X
"^DD",350.8,350.8,.02,3)
Answer must be 3-80 characters in length.
"^DD",350.8,350.8,.02,21,0)
^^3^3^2940209^^^^
"^DD",350.8,350.8,.02,21,1,0)
This is the text of the message as it will be displayed to a user or
"^DD",350.8,350.8,.02,21,2,0)
posted in a bulletin.  It should be as meaningful as possible to the
"^DD",350.8,350.8,.02,21,3,0)
person seeing the message.
"^DD",350.8,350.8,.03,0)
ERROR CODE^F^^0;3^K:X[""""!($A(X)=45) X I $D(X) K:$L(X)>9!($L(X)<1) X
"^DD",350.8,350.8,.03,1,0)
^.1
"^DD",350.8,350.8,.03,1,1,0)
350.8^AC
"^DD",350.8,350.8,.03,1,1,1)
S ^IBE(350.8,"AC",$E(X,1,30),DA)=""
"^DD",350.8,350.8,.03,1,1,2)
K ^IBE(350.8,"AC",$E(X,1,30),DA)
"^DD",350.8,350.8,.03,1,2,0)
350.8^C
"^DD",350.8,350.8,.03,1,2,1)
S ^IBE(350.8,"C",$E(X,1,30),DA)=""
"^DD",350.8,350.8,.03,1,2,2)
K ^IBE(350.8,"C",$E(X,1,30),DA)
"^DD",350.8,350.8,.03,3)
Answer must be 1-9 characters in length.
"^DD",350.8,350.8,.03,21,0)
^^9^9^2920219^^^^
"^DD",350.8,350.8,.03,21,1,0)
This is the error code that will be passed to or determined by
"^DD",350.8,350.8,.03,21,2,0)
Integrated Billing.  The format for the Error Code should be
"^DD",350.8,350.8,.03,21,3,0)
nnxxx, where nn is the reporting package namespace and xxx are numeric
"^DD",350.8,350.8,.03,21,4,0)
values.
"^DD",350.8,350.8,.03,21,5,0)
 
"^DD",350.8,350.8,.03,21,6,0)
This is the error code that will be passed as the second piece of
"^DD",350.8,350.8,.03,21,7,0)
the variable Y to IB when +Y=-1.  More than one error code can be
"^DD",350.8,350.8,.03,21,8,0)
placed in the second ^ piece of Y delimited by semi-colons.  Applications
"^DD",350.8,350.8,.03,21,9,0)
may call ^IBAERR to display the error message(s).
"^DD",350.8,350.8,.03,"DT")
2920219
"^DD",350.8,350.8,.04,0)
PACKAGE REPORTING ERROR^S^1:INTEGRATED BILLING;2:ACCOUNTS RECEIVABLE;3:PHARMACY;^0;4^Q
"^DD",350.8,350.8,.04,21,0)
^^2^2^2920415^^^
"^DD",350.8,350.8,.04,21,1,0)
This is the package that requested this entry in this file and will
"^DD",350.8,350.8,.04,21,2,0)
report it to IB as an error if the conditions are detected.
"^DD",350.8,350.8,.05,0)
ERROR ACTION^S^1:DISPLAY MESSAGE;2:SEND BULLETIN;3:EDIT FILE;^0;5^Q
"^DD",350.8,350.8,.05,21,0)
^^6^6^2910227^
"^DD",350.8,350.8,.05,21,1,0)
This is the type of action that should be taken when this error is
"^DD",350.8,350.8,.05,21,2,0)
reported to IB.  If action other than displaying a message is indicated
"^DD",350.8,350.8,.05,21,3,0)
then the MUMPS code in the ERROR ACTION field will be executed.
"^DD",350.8,350.8,.05,21,4,0)
 
"^DD",350.8,350.8,.05,21,5,0)
Currently only display actions are implemented.  Please contact the 
"^DD",350.8,350.8,.05,21,6,0)
developing ISC if other action types are desired.
"^DD",350.8,350.8,.06,0)
CORRESPONDING ALERT^P354.5'^IBE(354.5,^0;6^Q
"^DD",350.8,350.8,.06,21,0)
^^1^1^2940209^
"^DD",350.8,350.8,.06,21,1,0)
This is the type of alert that should be sent when this error occurs.
"^DD",350.8,350.8,.06,"DT")
2930322
"^DD",350.8,350.8,10,0)
EXECUTABLE LOGIC^K^^10;E1,245^K:$L(X)>245 X D:$D(X) ^DIM
"^DD",350.8,350.8,10,3)
This is Standard MUMPS code.
"^DD",350.8,350.8,10,21,0)
^^2^2^2910227^
"^DD",350.8,350.8,10,21,1,0)
This is the MUMPS code that will be executed if an error is reported
"^DD",350.8,350.8,10,21,2,0)
with an ERROR ACTION of other than to display a message.
"^DD",355.3,355.3,.15,0)
ELECTRONIC PLAN TYPE^S^16:HMO MEDICARE;MX:MEDICARE A or B;TV:TITLE V;MC:MEDICAID;BL:BC/BS;CH:TRICARE;15:INDEMNITY;CI:COMMERCIAL;HM:HMO;DS:DISABILITY;12:PPO;13:POS;ZZ:OTHER;^0;15^Q
"^DD",355.3,355.3,.15,3)
Enter the appropriate type of plan to be used for electronic billing.
"^DD",355.3,355.3,.15,21,0)
^^1^1^3000306^^^
"^DD",355.3,355.3,.15,21,1,0)
This field contains the X12 data needed to identify the source of pay type
"^DD",355.3,355.3,.15,23,0)
^^2^2^3000306^
"^DD",355.3,355.3,.15,23,1,0)
This field must be consistent with the ELECTRONIC TYPE OF INSURANCE in file
"^DD",355.3,355.3,.15,23,2,0)
36.
"^DD",355.3,355.3,.15,"DT")
3040908
"^DD",361.1,361.115,4,0)
LINE ITEM REMARK^361.1154A^^4;0
"^DD",361.1,361.1154,0)
LINE ITEM REMARK SUB-FIELD^^.03^3
"^DD",361.1,361.1154,0,"DT")
3040817
"^DD",361.1,361.1154,0,"IX","B",361.1154,.01)

"^DD",361.1,361.1154,0,"NM","LINE ITEM REMARK")

"^DD",361.1,361.1154,0,"UP")
361.115
"^DD",361.1,361.1154,.01,0)
LINE ITEM REMARK^NJ5,0^^0;1^K:+X'=X!(X>99999)!(X<1)!(X?.E1"."1N.N) X
"^DD",361.1,361.1154,.01,1,0)
^.1
"^DD",361.1,361.1154,.01,1,1,0)
361.1154^B
"^DD",361.1,361.1154,.01,1,1,1)
S ^IBM(361.1,DA(2),15,DA(1),4,"B",$E(X,1,30),DA)=""
"^DD",361.1,361.1154,.01,1,1,2)
K ^IBM(361.1,DA(2),15,DA(1),4,"B",$E(X,1,30),DA)
"^DD",361.1,361.1154,.01,3)
Type a Number between 1 and 99999, 0 Decimal Digits
"^DD",361.1,361.1154,.01,21,0)
^^2^2^3040817^
"^DD",361.1,361.1154,.01,21,1,0)
This is the sequential number used to enumerate the line item remarks in 
"^DD",361.1,361.1154,.01,21,2,0)
the ERA.
"^DD",361.1,361.1154,.01,"DT")
3040817
"^DD",361.1,361.1154,.02,0)
LINE ITEM REMARK CODE^F^^0;2^K:$L(X)>10!($L(X)<1) X
"^DD",361.1,361.1154,.02,3)
Answer must be 1-10 characters in length.
"^DD",361.1,361.1154,.02,21,0)
^^1^1^3040817^
"^DD",361.1,361.1154,.02,21,1,0)
This is the remark code provided by MEDICARE for this line item.
"^DD",361.1,361.1154,.02,"DT")
3040817
"^DD",361.1,361.1154,.03,0)
LINE ITEM REMARK CODE TEXT^F^^0;3^K:$L(X)>190!($L(X)<1) X
"^DD",361.1,361.1154,.03,3)
Answer must be 1-190 characters in length.
"^DD",361.1,361.1154,.03,21,0)
^^1^1^3040817^
"^DD",361.1,361.1154,.03,21,1,0)
This is the free text explanation of the remark code in this record.
"^DD",361.1,361.1154,.03,"DT")
3040817
"^DD",364.7,364.7,0)
FIELD^^3^12
"^DD",364.7,364.7,0,"DDA")
N
"^DD",364.7,364.7,0,"DT")
2960710
"^DD",364.7,364.7,0,"ID",.03)
S %I=Y,Y=$S('$D(^(0)):"",$D(^IBA(364.5,+$P(^(0),U,3),0))#2:$P(^(0),U,1),1:""),C=$P(^DD(364.5,.01,0),U,2) D Y^DIQ:Y]"" W "   ",Y,@("$E("_DIC_"%I,0),0)") S Y=%I K %I
"^DD",364.7,364.7,0,"IX","AINS",364.7,.01)

"^DD",364.7,364.7,0,"IX","AINS1",364.7,.05)

"^DD",364.7,364.7,0,"IX","AINTYP",364.7,.01)

"^DD",364.7,364.7,0,"IX","AINTYP1",364.7,.05)

"^DD",364.7,364.7,0,"IX","AINTYP2",364.7,.06)

"^DD",364.7,364.7,0,"IX","ATYPE",364.7,.01)

"^DD",364.7,364.7,0,"IX","ATYPE1",364.7,.06)

"^DD",364.7,364.7,0,"IX","B",364.7,.01)

"^DD",364.7,364.7,0,"IX","C",364.7,.03)

"^DD",364.7,364.7,0,"NM","IB FORM FIELD CONTENT")
 
"^DD",364.7,364.7,0,"VRPK")
IB
"^DD",364.7,364.7,.01,0)
FORM FIELD REFERENCE^RP364.6'^IBA(364.6,^0;1^Q
"^DD",364.7,364.7,.01,1,0)
^.1
"^DD",364.7,364.7,.01,1,1,0)
364.7^B
"^DD",364.7,364.7,.01,1,1,1)
S ^IBA(364.7,"B",$E(X,1,30),DA)=""
"^DD",364.7,364.7,.01,1,1,2)
K ^IBA(364.7,"B",$E(X,1,30),DA)
"^DD",364.7,364.7,.01,1,2,0)
364.7^ATYPE^MUMPS
"^DD",364.7,364.7,.01,1,2,1)
N Z1,Z0 S Z0=$G(^IBA(364.7,DA,0)),Z1=$P(Z0,U,6) I Z1'="",$P($G(^IBA(364.6,+X,0)),U,3),'$P(Z0,U,5) S ^IBA(364.7,"ATYPE",$P(^IBA(364.6,+X,0),U,3),Z1,DA)=""
"^DD",364.7,364.7,.01,1,2,2)
N Z0,Z1 S Z0=$G(^IBA(364.7,DA,0)),Z1=$P(Z0,U,6) I Z1'="",$P($G(^IBA(364.6,+X,0)),U,3) K ^IBA(364.7,"ATYPE",$P(^IBA(364.6,+X,0),U,3),Z1,DA)
"^DD",364.7,364.7,.01,1,2,3)
DO NOT DELETE
"^DD",364.7,364.7,.01,1,2,"%D",0)
^^1^1^2980104^^^^
"^DD",364.7,364.7,.01,1,2,"%D",1,0)
Xref by form and bill type
"^DD",364.7,364.7,.01,1,2,"DT")
2960117
"^DD",364.7,364.7,.01,1,3,0)
364.7^AINTYP^MUMPS
"^DD",364.7,364.7,.01,1,3,1)
N Z0,Z1,Z2 S Z0=$G(^IBA(364.7,DA,0)),Z1=$P(Z0,U,5),Z2=$P(Z0,U,6) I Z1,Z2'="",$P($G(^IBA(364.6,+X,0)),U,3) S ^IBA(364.7,"AINTYP",$P(^IBA(364.6,+X,0),U,3),Z1,Z2,DA)=""
"^DD",364.7,364.7,.01,1,3,2)
N Z0,Z1,Z2 S Z0=$G(^IBA(364.7,DA,0)),Z1=$P(Z0,U,5),Z2=$P(Z0,U,6) I Z1,Z2'="",$P($G(^IBA(364.6,+X,0)),U,3) K ^IBA(364.7,"AINTYP",$P(^IBA(364.6,+X,0),U,3),Z1,Z2,DA)
"^DD",364.7,364.7,.01,1,3,3)
DO NOT DELETE
"^DD",364.7,364.7,.01,1,3,"%D",0)
^^1^1^2971231^^^
"^DD",364.7,364.7,.01,1,3,"%D",1,0)
Xref by form, insurance company and bill type
"^DD",364.7,364.7,.01,1,3,"DT")
2960117
"^DD",364.7,364.7,.01,1,4,0)
364.7^AINS^MUMPS
"^DD",364.7,364.7,.01,1,4,1)
N Z0,Z1 S Z0=$G(^IBA(364.7,DA,0)),Z1=$P(Z0,U,5) I Z1,$P($G(^IBA(364.6,+X,0)),U,3),$P(Z0,U,6)="" S ^IBA(364.7,"AINS",$P(^IBA(364.6,+X,0),U,3),Z1,DA)=""
"^DD",364.7,364.7,.01,1,4,2)
N Z0,Z1 S Z0=$G(^IBA(364.7,DA,0)),Z1=$P(Z0,U,5) I Z1,$P($G(^IBA(364.6,+X,0)),U,3) K ^IBA(364.7,"AINS",$P(^IBA(364.6,+X,0),U,3),Z1,DA)
"^DD",364.7,364.7,.01,1,4,3)
DO NOT DELETE
"^DD",364.7,364.7,.01,1,4,"%D",0)
^^1^1^2971231^^
"^DD",364.7,364.7,.01,1,4,"%D",1,0)
Xref by form field and insurance company
"^DD",364.7,364.7,.01,1,4,"DT")
2960118
"^DD",364.7,364.7,.01,3)
Enter the billing form that this field is associated with
"^DD",364.7,364.7,.01,21,0)
^^2^2^2951207^^^^
"^DD",364.7,364.7,.01,21,1,0)
This is a pointer to the billing form field that this field is associated
"^DD",364.7,364.7,.01,21,2,0)
with.
"^DD",364.7,364.7,.01,"DT")
3000428
"^DD",364.7,364.7,.02,0)
SECURITY LEVEL^S^N:NATIONAL,NO EDIT;L:LOCAL;^0;2^Q
"^DD",364.7,364.7,.02,3)
Enter N for nationally released fields (no edit) or L for locally added fields.
"^DD",364.7,364.7,.02,21,0)
^^3^3^2951219^^^
"^DD",364.7,364.7,.02,21,1,0)
This field determines whether or not editing of the entry is allowed.  For
"^DD",364.7,364.7,.02,21,2,0)
NATIONAL (N) field, no local editing is allowed.  If LOCAL (L) field is
"^DD",364.7,364.7,.02,21,3,0)
created, editing is allowed.
"^DD",364.7,364.7,.02,"DT")
3000428
"^DD",364.7,364.7,.03,0)
DATA ELEMENT^P364.5'^IBA(364.5,^0;3^Q
"^DD",364.7,364.7,.03,1,0)
^.1
"^DD",364.7,364.7,.03,1,1,0)
364.7^C
"^DD",364.7,364.7,.03,1,1,1)
S ^IBA(364.7,"C",$E(X,1,30),DA)=""
"^DD",364.7,364.7,.03,1,1,2)
K ^IBA(364.7,"C",$E(X,1,30),DA)
"^DD",364.7,364.7,.03,1,1,3)
DO NOT DELETE
"^DD",364.7,364.7,.03,1,1,"%D",0)
^^1^1^2960702^
"^DD",364.7,364.7,.03,1,1,"%D",1,0)
Xref by DATA ELEMENT NAME
"^DD",364.7,364.7,.03,1,1,"DT")
2960702
"^DD",364.7,364.7,.03,3)
Enter the data element that will define this form field.  If used on a screen, it must be a fileman type.
"^DD",364.7,364.7,.03,21,0)
^^1^1^2960627^^^^
"^DD",364.7,364.7,.03,21,1,0)
This identifies the data element that be extracted for this entry.
"^DD",364.7,364.7,.03,23,0)
^^4^4^2960627^^^^
"^DD",364.7,364.7,.03,23,1,0)
This is the data element that will be allowed to be displayed/edited on a
"^DD",364.7,364.7,.03,23,2,0)
screen, extracted for a transmit, or printed on a printed form.  If used on
"^DD",364.7,364.7,.03,23,3,0)
a screen, the data element must be a fileman type and a local field (>10000
"^DD",364.7,364.7,.03,23,4,0)
for ifn and on a node >10000) to be editable.
"^DD",364.7,364.7,.03,"DT")
2960702
"^DD",364.7,364.7,.04,0)
SCREEN PROMPT^FX^^0;4^K:$L(X)>70!($L(X)<1) X I $D(X),$P($G(^IBE(353,+$G(^IBA(364.6,+$G(^IBA(364.7,DA,0)),0)),2)),U,2)'="S" K X
"^DD",364.7,364.7,.04,.1)
 
"^DD",364.7,364.7,.04,1,0)
^.1^^0
"^DD",364.7,364.7,.04,3)
Answer must be 1-70 characters in length.
"^DD",364.7,364.7,.04,21,0)
3^^2^2^2960321^^^^
"^DD",364.7,364.7,.04,21,1,0)
This is used only by screen-type forms to place a prompt on the screen
"^DD",364.7,364.7,.04,21,2,0)
for a particular field.
"^DD",364.7,364.7,.04,23,0)
^^3^3^2960321^^^^
"^DD",364.7,364.7,.04,23,1,0)
This is the prompt that will preceed the data element defined for this
"^DD",364.7,364.7,.04,23,2,0)
entry.  If no data element, this prompt will display.  This field is only
"^DD",364.7,364.7,.04,23,3,0)
used for screen-type forms.
"^DD",364.7,364.7,.04,"DT")
2960321
"^DD",364.7,364.7,.05,0)
INSURANCE COMPANY^P36'^DIC(36,^0;5^Q
"^DD",364.7,364.7,.05,1,0)
^.1
"^DD",364.7,364.7,.05,1,1,0)
364.7^AINS1^MUMPS
"^DD",364.7,364.7,.05,1,1,1)
N Z0,Z1 S Z0=$G(^IBA(364.7,DA,0)),Z1=$P($G(^IBA(364.6,+Z0,0)),U,3) I Z1,$P(Z0,U,6)="" S ^IBA(364.7,"AINS",Z1,$E(X,1,30),DA)=""
"^DD",364.7,364.7,.05,1,1,2)
N Z0,Z1,Z2 S Z0=$G(^IBA(364.7,DA,0)),Z1=$P($G(^IBA(364.6,+Z0,0)),U,3),Z2=$P(Z0,U,6) K ^IBA(364.7,"AINS",Z1,$E(X,1,30),DA) I Z2'="",$D(^IBA(364.7,"AINTYP",Z1,X,Z2,DA)) S ^IBA(364.7,"ATYPE",Z1,Z2,DA)=""
"^DD",364.7,364.7,.05,1,1,3)
DO NOT DELETE
"^DD",364.7,364.7,.05,1,1,"%D",0)
^^1^1^2960118^
"^DD",364.7,364.7,.05,1,1,"%D",1,0)
Xref by form field and insurance company.
"^DD",364.7,364.7,.05,1,1,"DT")
2960118
"^DD",364.7,364.7,.05,1,2,0)
364.7^AINTYP1^MUMPS
"^DD",364.7,364.7,.05,1,2,1)
N Z0,Z1,Z2 S Z0=$G(^IBA(364.7,DA,0)),Z1=+$P($G(^IBA(364.6,+Z0,0)),U,3),Z2=$P(Z0,U,6) I Z1,Z2'="" S ^IBA(364.7,"AINTYP",Z1,$E(X,1,30),Z2,DA)="" K ^IBA(364.7,"ATYPE",Z1,Z2,DA),^IBA(364.7,"AINS",Z1,X,DA)
"^DD",364.7,364.7,.05,1,2,2)
N Z0,Z1,Z2 S Z0=$G(^IBA(364.7,DA,0)),Z1=+$P($G(^IBA(364.6,+Z0,0)),U,3),Z2=$P(Z0,U,6) K:Z1&(Z2'="") ^IBA(364.7,"AINTYP",Z1,$E(X,1,30),Z2,DA)
"^DD",364.7,364.7,.05,1,2,3)
DO NOT DELETE
"^DD",364.7,364.7,.05,1,2,"%D",0)
^^1^1^2960117^^^^
"^DD",364.7,364.7,.05,1,2,"%D",1,0)
Xref by insurance company and bill type
"^DD",364.7,364.7,.05,1,2,"DT")
2960117
"^DD",364.7,364.7,.05,3)
Enter the name of the insurance company that this field is associated with.
"^DD",364.7,364.7,.05,21,0)
^^2^2^2951207^
"^DD",364.7,364.7,.05,21,1,0)
This is the insurance company who has a need for other than the standard
"^DD",364.7,364.7,.05,21,2,0)
data in this field.
"^DD",364.7,364.7,.05,"DT")
3000428
"^DD",364.7,364.7,.06,0)
BILL TYPE^S^I:INPATIENT;O:OUTPATIENT;^0;6^Q
"^DD",364.7,364.7,.06,1,0)
^.1
"^DD",364.7,364.7,.06,1,1,0)
364.7^ATYPE1^MUMPS
"^DD",364.7,364.7,.06,1,1,1)
N Z0,Z1 S Z0=$G(^IBA(364.7,DA,0)),Z1=$P($G(^IBA(364.6,+Z0,0)),U,3) I Z1,'$P(Z0,U,5) S ^IBA(364.7,"ATYPE",Z1,$E(X,1,30),DA)=""
"^DD",364.7,364.7,.06,1,1,2)
N Z0,Z1,Z2 S Z0=$G(^IBA(364.7,DA,0)),Z1=$P($G(^IBA(364.6,+Z0,0)),U,3),Z2=$P(Z0,U,5) I Z1 K ^IBA(364.7,"ATYPE",Z1,$E(X,1,30),DA) I Z2,$D(^IBA(364.7,"AINTYP",Z1,Z2,X,DA)) S ^IBA(364.7,"AINS",Z1,Z2,DA)=""
"^DD",364.7,364.7,.06,1,1,3)
DO NOT DELETE
"^DD",364.7,364.7,.06,1,1,"%D",0)
^^1^1^2960117^^
"^DD",364.7,364.7,.06,1,1,"%D",1,0)
Xref by form and bill type.
"^DD",364.7,364.7,.06,1,1,"DT")
2960117
"^DD",364.7,364.7,.06,1,2,0)
364.7^AINTYP2^MUMPS
"^DD",364.7,364.7,.06,1,2,1)
N Z0,Z1,Z2 S Z0=$G(^IBA(364.7,DA,0)),Z1=+$P($G(^IBA(364.6,+Z0,0)),U,3),Z2=$P(Z0,U,5) I Z1,Z2 K:'$D(^IBA(364.7,"AINTYP",Z1,Z2,X,DA)) ^IBA(364.7,"AINS",Z1,Z2,DA) S ^IBA(364.7,"AINTYP",Z1,Z2,$E(X,1,30),DA)=""
"^DD",364.7,364.7,.06,1,2,2)
N Z0,Z1,Z2 S Z0=$G(^IBA(364.7,DA,0)),Z1=+$P($G(^IBA(364.6,+Z0,0)),U,3),Z2=$P(Z0,U,5) K:Z1&Z2 ^IBA(364.7,"AINTYP",Z1,Z2,$E(X,1,30),DA)
"^DD",364.7,364.7,.06,1,2,3)
DO NOT DELETE
"^DD",364.7,364.7,.06,1,2,"%D",0)
^^1^1^2960117^^^^
"^DD",364.7,364.7,.06,1,2,"%D",1,0)
Xref by form, insurance company and bill type
"^DD",364.7,364.7,.06,1,2,"DT")
2960117
"^DD",364.7,364.7,.06,3)
Enter the type of the bill.
"^DD",364.7,364.7,.06,21,0)
^^1^1^2960117^^
"^DD",364.7,364.7,.06,21,1,0)
This is the type of bill that requires this field.
"^DD",364.7,364.7,.06,"DT")
3000428
"^DD",364.7,364.7,.07,0)
PAD CHARACTER^S^ZL:ZERO PAD ON LEFT;ZR:ZERO PAD ON RIGHT;SL:SPACE PAD ON LEFT;SR:SPACE PAD ON RIGHT;N:NO PAD REQUIRED;^0;7^Q
"^DD",364.7,364.7,.07,3)
Enter the code that corresponds to the format and pad character to use for the data output in this field.
"^DD",364.7,364.7,.07,21,0)
^^3^3^2960126^^
"^DD",364.7,364.7,.07,21,1,0)
If present, this defines the character to be used to pad the DATA
"^DD",364.7,364.7,.07,21,2,0)
ELEMENT to its desired length and the orientation of the padding characters
"^DD",364.7,364.7,.07,21,3,0)
to the left or right of the data.  The default is space pad to the right.
"^DD",364.7,364.7,.07,"DT")
2960126
"^DD",364.7,364.7,.08,0)
REQUIRED^S^0:NO;1:YES;^0;8^Q
"^DD",364.7,364.7,.08,3)
Enter 1 (YES) if this data element is on a local screen 9 form and the data is required for the bill to be authorized.
"^DD",364.7,364.7,.08,21,0)
^.001^4^4^3001030^^
"^DD",364.7,364.7,.08,21,1,0)
This field controls the required/not required status of a data element
"^DD",364.7,364.7,.08,21,2,0)
on a local screen 9 form.  If this field is 1 (YES), this data element
"^DD",364.7,364.7,.08,21,3,0)
is always required to have data (not null) in order for a bill to be
"^DD",364.7,364.7,.08,21,4,0)
authorized.
"^DD",364.7,364.7,.08,"DT")
2951207
"^DD",364.7,364.7,.09,0)
EDIT STATUS^S^E:EDITABLE;D:DISPLAY ONLY;^0;9^Q
"^DD",364.7,364.7,.09,3)
Enter 'E' to enable editing for this field, 'D' for a display only field.
"^DD",364.7,364.7,.09,21,0)
^^2^2^2960320^
"^DD",364.7,364.7,.09,21,1,0)
This field is used to control whether or not a data element on a screen is
"^DD",364.7,364.7,.09,21,2,0)
editable or for display-only purposes.
"^DD",364.7,364.7,.09,"DT")
2960320
"^DD",364.7,364.7,.1,0)
EDIT GROUP NUMBER^NJ2,0^^0;10^K:+X'=X!(X>99)!(X<1)!(X?.E1"."1N.N) X
"^DD",364.7,364.7,.1,3)
 Enter the edit group # that this field will be included in.  Valid #'s are 1-99.
"^DD",364.7,364.7,.1,21,0)
^^6^6^2960321^^
"^DD",364.7,364.7,.1,21,1,0)
This field contains the # of the edit group that the screen data element
"^DD",364.7,364.7,.1,21,2,0)
will be included with.  When this group # is selected on an edit screen,
"^DD",364.7,364.7,.1,21,3,0)
all data elements assigned to this group # on this screen will be presented
"^DD",364.7,364.7,.1,21,4,0)
for editing.  If no # is entered here, this field will not be available for
"^DD",364.7,364.7,.1,21,5,0)
editing.  This field will only apply to screen-type forms' editable data
"^DD",364.7,364.7,.1,21,6,0)
element descriptions.
"^DD",364.7,364.7,.1,"DT")
2960321
"^DD",364.7,364.7,1,0)
FORMAT CODE^K^^1;E1,245^K:$L(X)>245 X D:$D(X) ^DIM
"^DD",364.7,364.7,1,3)
This is Standard MUMPS code.
"^DD",364.7,364.7,1,9)
@
"^DD",364.7,364.7,1,21,0)
^^8^8^2951207^
"^DD",364.7,364.7,1,21,1,0)
This is the code that will be xecuted to format the 'raw' data element
"^DD",364.7,364.7,1,21,2,0)
value that is returned from the execution of the DATA ELEMENT's definition.
"^DD",364.7,364.7,1,21,3,0)
This code can assume the variable/array IBXDATA is available as input and
"^DD",364.7,364.7,1,21,4,0)
should set this variable/array as its output.  Standard calls for data
"^DD",364.7,364.7,1,21,5,0)
formatting have been provided.  The variables IBXPG, IBXLN, IBXCOL are the
"^DD",364.7,364.7,1,21,6,0)
only IBX* variables that should be changed in this routine.  These represent
"^DD",364.7,364.7,1,21,7,0)
the page, line, column as the first 3 levels of subscript for the output
"^DD",364.7,364.7,1,21,8,0)
array.
"^DD",364.7,364.7,1,"DT")
2951207
"^DD",364.7,364.7,3,0)
FORMAT CODE DESCRIPTION^364.73^^3;0
"^DD",364.7,364.7,3,21,0)
^.001^1^1^3010102^^
"^DD",364.7,364.7,3,21,1,0)
This field describes the function of the format code entered.
"^DD",364.7,364.7,3,"DT")
2960710
"^DD",364.7,364.73,0)
FORMAT CODE DESCRIPTION SUB-FIELD^^.01^1
"^DD",364.7,364.73,0,"DT")
2960710
"^DD",364.7,364.73,0,"NM","FORMAT CODE DESCRIPTION")
 
"^DD",364.7,364.73,0,"UP")
364.7
"^DD",364.7,364.73,.01,0)
FORMAT CODE DESCRIPTION^W^^0;1^Q
"^DD",364.7,364.73,.01,3)
Enter a description of the processing logic of the format code.
"^DD",364.7,364.73,.01,21,0)
^.001^1^1^3010102^^^^
"^DD",364.7,364.73,.01,21,1,0)
This is a description of the processing logic of the format code.
"^DD",364.7,364.73,.01,"DT")
2960710
"^DIC",350.8,350.8,0)
IB ERROR
"^DIC",350.8,350.8,0,"GL")
^IBE(350.8,
"^DIC",350.8,350.8,"%D",0)
^^11^11^2940214^^^^
"^DIC",350.8,350.8,"%D",1,0)
This file contains errors for billing functions.  It may be used by
"^DIC",350.8,350.8,"%D",2,0)
applications, IB or AR.  The normal format for a routine to return
"^DIC",350.8,350.8,"%D",3,0)
an error is to return the variable:
"^DIC",350.8,350.8,"%D",4,0)
  Y=1^... a successful event occured
"^DIC",350.8,350.8,"%D",5,0)
  Y=-1^error code[;error code;error code...]^additional text
"^DIC",350.8,350.8,"%D",6,0)
The error messages can be displayed by calling routine ^IBAERR.  If
"^DIC",350.8,350.8,"%D",7,0)
the error occurs in a tasked job ($D(ZTQUEUED)'=0) the routine will
"^DIC",350.8,350.8,"%D",8,0)
put the error message in a bulletin and post it to the group defined
"^DIC",350.8,350.8,"%D",9,0)
in the IB SITE PARAMETER FILE.
"^DIC",350.8,350.8,"%D",10,0)
 
"^DIC",350.8,350.8,"%D",11,0)
Per VHA Directive 10-93-142, this file definition should not be modified.
"^DIC",350.8,"B","IB ERROR",350.8)

"^DIC",364.7,364.7,0)
IB FORM FIELD CONTENT^364.7P
"^DIC",364.7,364.7,0,"GL")
^IBA(364.7,
"^DIC",364.7,364.7,"%D",0)
^1.001^9^9^3030331^^^^
"^DIC",364.7,364.7,"%D",1,0)
DO NOT delete entries or edit data in this file with VA File Manager.
"^DIC",364.7,364.7,"%D",2,0)
 
"^DIC",364.7,364.7,"%D",3,0)
This is the file that contains the specific fields to be used to produce
"^DIC",364.7,364.7,"%D",4,0)
the associated form or screen.  If there is no insurance company or bill
"^DIC",364.7,364.7,"%D",5,0)
type specified for an entry, this is assumed to be the default definition
"^DIC",364.7,364.7,"%D",6,0)
of the field.
"^DIC",364.7,364.7,"%D",7,0)
 
"^DIC",364.7,364.7,"%D",8,0)
Entries in this file that are designated as having a SECURITY LEVEL of
"^DIC",364.7,364.7,"%D",9,0)
NATIONAL should not be deleted or edited.
"^DIC",364.7,"B","IB FORM FIELD CONTENT",364.7)

**END**
**END**
