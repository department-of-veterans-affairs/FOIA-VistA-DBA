Released PRPF*3*15 SEQ #17
Extracted from mail message
**KIDS**:PRPF*3.0*15^

**INSTALL NAME**
PRPF*3.0*15
"BLD",4744,0)
PRPF*3.0*15^INTEGRATED PATIENT FUNDS^0^3060227^y
"BLD",4744,1,0)
^^1^1^3050719^
"BLD",4744,1,1,0)
Patient Funds Diagnostic Patch
"BLD",4744,4,0)
^9.64PA^^0
"BLD",4744,"INID")
^n
"BLD",4744,"INIT")

"BLD",4744,"KRN",0)
^9.67PA^8989.52^19
"BLD",4744,"KRN",.4,0)
.4
"BLD",4744,"KRN",.401,0)
.401
"BLD",4744,"KRN",.402,0)
.402
"BLD",4744,"KRN",.403,0)
.403
"BLD",4744,"KRN",.5,0)
.5
"BLD",4744,"KRN",.84,0)
.84
"BLD",4744,"KRN",3.6,0)
3.6
"BLD",4744,"KRN",3.8,0)
3.8
"BLD",4744,"KRN",9.2,0)
9.2
"BLD",4744,"KRN",9.8,0)
9.8
"BLD",4744,"KRN",9.8,"NM",0)
^9.68A^6^6
"BLD",4744,"KRN",9.8,"NM",1,0)
PRPFDR1^^0^B73189530
"BLD",4744,"KRN",9.8,"NM",2,0)
PRPFDR2^^0^B68312638
"BLD",4744,"KRN",9.8,"NM",3,0)
PRPFDR3^^0^B71656753
"BLD",4744,"KRN",9.8,"NM",4,0)
PRPFDR4^^0^B33333935
"BLD",4744,"KRN",9.8,"NM",5,0)
PRPFDR5^^0^B63996018
"BLD",4744,"KRN",9.8,"NM",6,0)
PRPFDR6^^0^B32913557
"BLD",4744,"KRN",9.8,"NM","B","PRPFDR1",1)

"BLD",4744,"KRN",9.8,"NM","B","PRPFDR2",2)

"BLD",4744,"KRN",9.8,"NM","B","PRPFDR3",3)

"BLD",4744,"KRN",9.8,"NM","B","PRPFDR4",4)

"BLD",4744,"KRN",9.8,"NM","B","PRPFDR5",5)

"BLD",4744,"KRN",9.8,"NM","B","PRPFDR6",6)

"BLD",4744,"KRN",19,0)
19
"BLD",4744,"KRN",19,"NM",0)
^9.68A^2^2
"BLD",4744,"KRN",19,"NM",1,0)
PRPF SUPERVISOR^^2
"BLD",4744,"KRN",19,"NM",2,0)
PRPF DATA DIAGNOSTIC REPORT^^0
"BLD",4744,"KRN",19,"NM","B","PRPF DATA DIAGNOSTIC REPORT",2)

"BLD",4744,"KRN",19,"NM","B","PRPF SUPERVISOR",1)

"BLD",4744,"KRN",19.1,0)
19.1
"BLD",4744,"KRN",19.1,"NM",0)
^9.68A^^0
"BLD",4744,"KRN",101,0)
101
"BLD",4744,"KRN",409.61,0)
409.61
"BLD",4744,"KRN",771,0)
771
"BLD",4744,"KRN",870,0)
870
"BLD",4744,"KRN",8989.51,0)
8989.51
"BLD",4744,"KRN",8989.52,0)
8989.52
"BLD",4744,"KRN",8994,0)
8994
"BLD",4744,"KRN",8994,"NM",0)
^9.68A^^0
"BLD",4744,"KRN","B",.4,.4)

"BLD",4744,"KRN","B",.401,.401)

"BLD",4744,"KRN","B",.402,.402)

"BLD",4744,"KRN","B",.403,.403)

"BLD",4744,"KRN","B",.5,.5)

"BLD",4744,"KRN","B",.84,.84)

"BLD",4744,"KRN","B",3.6,3.6)

"BLD",4744,"KRN","B",3.8,3.8)

"BLD",4744,"KRN","B",9.2,9.2)

"BLD",4744,"KRN","B",9.8,9.8)

"BLD",4744,"KRN","B",19,19)

"BLD",4744,"KRN","B",19.1,19.1)

"BLD",4744,"KRN","B",101,101)

"BLD",4744,"KRN","B",409.61,409.61)

"BLD",4744,"KRN","B",771,771)

"BLD",4744,"KRN","B",870,870)

"BLD",4744,"KRN","B",8989.51,8989.51)

"BLD",4744,"KRN","B",8989.52,8989.52)

"BLD",4744,"KRN","B",8994,8994)

"BLD",4744,"QUES",0)
^9.62^^
"BLD",4744,"REQB",0)
^9.611^1^1
"BLD",4744,"REQB",1,0)
XU*8.0*343^1
"BLD",4744,"REQB","B","XU*8.0*343",1)

"KRN",19,7228,-1)
2^1
"KRN",19,7228,0)
PRPF SUPERVISOR^Supervisor Menu^^M^.5^PRPF SUPERVISOR^^^^^^466
"KRN",19,7228,10,0)
^19.01IP^13^13
"KRN",19,7228,10,12,0)
11754^12
"KRN",19,7228,10,12,"^")
PRPF DATA DIAGNOSTIC REPORT
"KRN",19,7228,"U")
SUPERVISOR MENU
"KRN",19,11754,-1)
0^2
"KRN",19,11754,0)
PRPF DATA DIAGNOSTIC REPORT^Database Diagnostic Report^^R^^PRPF SUPERVISOR^^^^^^INTEGRATED PATIENT FUNDS
"KRN",19,11754,1,0)
^^3^3^3050804^
"KRN",19,11754,1,1,0)
This routine is for use with the Patient Funds re-hosting project.
"KRN",19,11754,1,2,0)
This routine will scan the PRPF file range for specific errors and
"KRN",19,11754,1,3,0)
print a summary report with optional detail report.
"KRN",19,11754,25)
LEG^PRPFDR2
"KRN",19,11754,"U")
DATABASE DIAGNOSTIC REPORT
"MBREQ")
0
"ORD",18,19)
19;18;;;OPT^XPDTA;OPTF1^XPDIA;OPTE1^XPDIA;OPTF2^XPDIA;;OPTDEL^XPDIA
"ORD",18,19,0)
OPTION
"PKG",466,-1)
1^1
"PKG",466,0)
INTEGRATED PATIENT FUNDS^PRPF^PATIENT FUNDS.  INTEGRATED WITH PATIENT FILE
"PKG",466,20,0)
^9.402P^^
"PKG",466,22,0)
^9.49I^1^1
"PKG",466,22,1,0)
3.0^2970224
"PKG",466,22,1,"PAH",1,0)
15^3060227^100839
"PKG",466,22,1,"PAH",1,1,0)
^^1^1^3060227
"PKG",466,22,1,"PAH",1,1,1,0)
Patient Funds Diagnostic Patch
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
6
"RTN","PRPFDR1")
0^1^B73189530
"RTN","PRPFDR1",1,0)
PRPFDR1 ;BAYPINES/MJE  VPFS DATA MIGRATION ROUTINE 1 ;05/15/03
"RTN","PRPFDR1",2,0)
 ;;3.0;PATIENT FUNDS DIAG V5.9;**15**;JUNE 1, 1989
"RTN","PRPFDR1",3,0)
 ;BAD ENTRY POINT
"RTN","PRPFDR1",4,0)
 Q
"RTN","PRPFDR1",5,0)
NODE4 S PRPFHLD2=0
"RTN","PRPFDR1",6,0)
 F  S PRPFHLD2=$O(^PRPF(470,PRPFHLD1,4,PRPFHLD2)) Q:'PRPFHLD2  D
"RTN","PRPFDR1",7,0)
 .S PFNODE4=^PRPF(470,PRPFHLD1,4,PRPFHLD2,0)
"RTN","PRPFDR1",8,0)
 .I '$D(^PRPF(470.1,+$P(PFNODE4,"^",1),0)) D
"RTN","PRPFDR1",9,0)
 ..S ^TMP("PRPF_DIAGX",$J,PFSTAID,47,PFNAME_"_"_PRPFHLD1_"_"_"DefTrans#"_PRPFHLD2)="TRANSACTION REC^Transaction record missing, blank or ID invalid (Transaction missing)^"_$P(PFNODE4,"^",1)
"RTN","PRPFDR1",10,0)
 ..S CNTERR(47)=CNTERR(47)+1
"RTN","PRPFDR1",11,0)
 ..S CNTERR(100)=CNTERR(100)+1
"RTN","PRPFDR1",12,0)
 .I $D(^PRPF(470.1,+$P(PFNODE4,"^",1),0)) D
"RTN","PRPFDR1",13,0)
 ..S PFNODE4D=^PRPF(470.1,$P(PFNODE4,"^",1),0)
"RTN","PRPFDR1",14,0)
 ..I PFNODE4D="" D
"RTN","PRPFDR1",15,0)
 ...S ^TMP("PRPF_DIAGX",$J,PFSTAID,47,PFNAME_"_"_PRPFHLD1_"_"_"DefTrans#"_PRPFHLD2)="TRANSACTION REC^Transaction record missing, blank or ID invalid (Record blank)^"_$P(PFNODE4,"^",1)
"RTN","PRPFDR1",16,0)
 ...S CNTERR(47)=CNTERR(47)+1
"RTN","PRPFDR1",17,0)
 ...S CNTERR(100)=CNTERR(100)+1
"RTN","PRPFDR1",18,0)
 ..I PFNODE4D'="" D
"RTN","PRPFDR1",19,0)
 ...I +($P(PFNODE4D,"^",1))'=+$P(PFNODE4,"^",1) D
"RTN","PRPFDR1",20,0)
 ....S ^TMP("PRPF_DIAGX",$J,PFSTAID,47,PFNAME_"_"_PRPFHLD1_"_"_"DefTrans#"_PRPFHLD2)="TRANSACTION REC^Transaction record missing, blank or ID invalid (Transaction ID does not match IEN)^"_$P(PFNODE4,"^",1)
"RTN","PRPFDR1",21,0)
 ....S CNTERR(47)=CNTERR(47)+1
"RTN","PRPFDR1",22,0)
 ....S CNTERR(100)=CNTERR(100)+1
"RTN","PRPFDR1",23,0)
 ...I $P(PFNODE4D,"^",2)'=PRPFHLD1 D
"RTN","PRPFDR1",24,0)
 ....S ^TMP("PRPF_DIAGX",$J,PFSTAID,48,PFNAME_"_"_PRPFHLD1_"_"_"DefTrans#"_PRPFHLD2)="PATIENT NAME^Patient name does not match transaction^"_$P(PFNODE4D,"^",2)
"RTN","PRPFDR1",25,0)
 ....S CNTERR(48)=CNTERR(48)+1
"RTN","PRPFDR1",26,0)
 ....S CNTERR(100)=CNTERR(100)+1
"RTN","PRPFDR1",27,0)
 ...S PFNODE4X=$P(PFNODE4D,"^",3)
"RTN","PRPFDR1",28,0)
 ...I +PFNODE4X'=PFNODE4X!(PFNODE4X>99999)!(PFNODE4X<1) D
"RTN","PRPFDR1",29,0)
 ....S ^TMP("PRPF_DIAGX",$J,PFSTAID,49,PFNAME_"_"_PRPFHLD1_"_"_"DefTrans#"_PRPFHLD2)="PATIENT TRANSACTION #^Patient transaction # invalid^"_$P(PFNODE4D,"^",3)
"RTN","PRPFDR1",30,0)
 ....S CNTERR(49)=CNTERR(49)+1
"RTN","PRPFDR1",31,0)
 ....S CNTERR(100)=CNTERR(100)+1
"RTN","PRPFDR1",32,0)
 ...S PFNODE4X=$P(PFNODE4D,"^",4)
"RTN","PRPFDR1",33,0)
 ...I PFNODE4X=""!(+PFNODE4X'=PFNODE4X)&(PFNODE4X'?.N1".".N)!(PFNODE4X>99999)!(PFNODE4X<.01) D
"RTN","PRPFDR1",34,0)
 ....S ^TMP("PRPF_DIAGX",$J,PFSTAID,50,PFNAME_"_"_PRPFHLD1_"_"_"DefTrans#"_PRPFHLD2)="AMOUNT^Deferred amount invalid^"_$P(PFNODE4D,"^",4)
"RTN","PRPFDR1",35,0)
 ....S CNTERR(50)=CNTERR(50)+1
"RTN","PRPFDR1",36,0)
 ....S CNTERR(100)=CNTERR(100)+1
"RTN","PRPFDR1",37,0)
 ...S PFTDT=$P(PFNODE4D,"^",5)
"RTN","PRPFDR1",38,0)
 ...S PRPFBADD=""
"RTN","PRPFDR1",39,0)
 ...D DT^DILF("X",PFTDT,.PRPFBADD)
"RTN","PRPFDR1",40,0)
 ...I $L(+PFTDT)'=7!(PRPFBADD=-1)!(PRPFBADD="") D
"RTN","PRPFDR1",41,0)
 ....S ^TMP("PRPF_DIAGX",$J,PFSTAID,51,PFNAME_"_"_PRPFHLD1_"_"_"DefTrans#"_PRPFHLD2)="TRANSACTION DATE^Transaction date Invalid^"_$P(PFNODE4D,"^",5)
"RTN","PRPFDR1",42,0)
 ....S CNTERR(51)=CNTERR(51)+1
"RTN","PRPFDR1",43,0)
 ....S CNTERR(100)=CNTERR(100)+1
"RTN","PRPFDR1",44,0)
 ...S PFTDTE=$P(PFNODE4D,"^",6)
"RTN","PRPFDR1",45,0)
 ...S PRPFBADD=""
"RTN","PRPFDR1",46,0)
 ...D DT^DILF("X",PFTDTE,.PRPFBADD)
"RTN","PRPFDR1",47,0)
 ...I $L(+PFTDTE)'=7!(PRPFBADD=-1)!(PRPFBADD="") D
"RTN","PRPFDR1",48,0)
 ....S ^TMP("PRPF_DIAGX",$J,PFSTAID,52,PFNAME_"_"_PRPFHLD1_"_"_"DefTrans#"_PRPFHLD2)="DATE TRANSACTION ENTERED^Date transaction entered Invalid^"_$P(PFNODE4D,"^",6)
"RTN","PRPFDR1",49,0)
 ....S CNTERR(52)=CNTERR(52)+1
"RTN","PRPFDR1",50,0)
 ....S CNTERR(100)=CNTERR(100)+1
"RTN","PRPFDR1",51,0)
 ...S PFNODE4X=$P(PFNODE4D,"^",7)
"RTN","PRPFDR1",52,0)
 ...I $L(PFNODE4X)>10!($L(PFNODE4X)<1) D
"RTN","PRPFDR1",53,0)
 ....S ^TMP("PRPF_DIAGX",$J,PFSTAID,53,PFNAME_"_"_PRPFHLD1_"_"_"DefTrans#"_PRPFHLD2)="REFERENCE^Reference Invalid < 1 or > 10 in length^"_$P(PFNODE4D,"^",7)
"RTN","PRPFDR1",54,0)
 ....S CNTERR(53)=CNTERR(53)+1
"RTN","PRPFDR1",55,0)
 ....S CNTERR(100)=CNTERR(100)+1
"RTN","PRPFDR1",56,0)
 ...S PFNODE4X=$P(PFNODE4D,"^",8)
"RTN","PRPFDR1",57,0)
 ...I PFNODE4X'["D"&(PFNODE4X'["W") D
"RTN","PRPFDR1",58,0)
 ....S ^TMP("PRPF_DIAGX",$J,PFSTAID,54,PFNAME_"_"_PRPFHLD1_"_"_"DefTrans#"_PRPFHLD2)="DEPOSIT/WITHDRAWAL^Deposit/Withdrawal status Invalid^"_$P(PFNODE4D,"^",8)
"RTN","PRPFDR1",59,0)
 ....S CNTERR(54)=CNTERR(54)+1
"RTN","PRPFDR1",60,0)
 ....S CNTERR(100)=CNTERR(100)+1
"RTN","PRPFDR1",61,0)
 ...S PFNODE4X=$P(PFNODE4D,"^",9)
"RTN","PRPFDR1",62,0)
 ...I PFNODE4X'["1"&(PFNODE4X'["2")&(PFNODE4X'["3") D
"RTN","PRPFDR1",63,0)
 ....S ^TMP("PRPF_DIAGX",$J,PFSTAID,55,PFNAME_"_"_PRPFHLD1_"_"_"DefTrans#"_PRPFHLD2)="CASH/CHECK/OTHER^Cash/Check/Other status Invalid^"_$P(PFNODE4D,"^",9)
"RTN","PRPFDR1",64,0)
 ....S CNTERR(55)=CNTERR(55)+1
"RTN","PRPFDR1",65,0)
 ....S CNTERR(100)=CNTERR(100)+1
"RTN","PRPFDR1",66,0)
 ...S PFNODE4X=$P(PFNODE4D,"^",10)
"RTN","PRPFDR1",67,0)
 ...I PFNODE4X'["P"&(PFNODE4X'["G")&(PFNODE4X'="B") D
"RTN","PRPFDR1",68,0)
 ....S ^TMP("PRPF_DIAGX",$J,PFSTAID,56,PFNAME_"_"_PRPFHLD1_"_"_"DefTrans#"_PRPFHLD2)="SOURCE^Transaction source invalid^"_$P(PFNODE4D,"^",10)
"RTN","PRPFDR1",69,0)
 ....S CNTERR(56)=CNTERR(56)+1
"RTN","PRPFDR1",70,0)
 ....S CNTERR(100)=CNTERR(100)+1
"RTN","PRPFDR1",71,0)
 ...I $P(PFNODE4D,"^",11)="" D
"RTN","PRPFDR1",72,0)
 ....S ^TMP("PRPF_DIAGX",$J,PFSTAID,57,PFNAME_"_"_PRPFHLD1_"_"_"DefTrans#"_PRPFHLD2)="FORM^Form does not match^"_$P(PFNODE4D,"^",11)
"RTN","PRPFDR1",73,0)
 ....S CNTERR(57)=CNTERR(57)+1
"RTN","PRPFDR1",74,0)
 ....S CNTERR(100)=CNTERR(100)+1
"RTN","PRPFDR1",75,0)
 ...I $P(PFNODE4D,"^",11)'="" D
"RTN","PRPFDR1",76,0)
 ....I '$D(^PRPF(470.2,$P(PFNODE4D,"^",11),0)) D
"RTN","PRPFDR1",77,0)
 .....S ^TMP("PRPF_DIAGX",$J,PFSTAID,57,PFNAME_"_"_PRPFHLD1_"_"_"DefTrans#"_PRPFHLD2)="FORM^Form does not match^"_$P(PFNODE4D,"^",11)
"RTN","PRPFDR1",78,0)
 .....S CNTERR(57)=CNTERR(57)+1
"RTN","PRPFDR1",79,0)
 .....S CNTERR(100)=CNTERR(100)+1
"RTN","PRPFDR1",80,0)
 ...S PFNODE4X=$P(PFNODE4D,"^",12)
"RTN","PRPFDR1",81,0)
 ...I PFNODE4X'="" I +PFNODE4X'=PFNODE4X&(PFNODE4X'?.N1".".N)!(PFNODE4X>99999)!(PFNODE4X<.01) D
"RTN","PRPFDR1",82,0)
 ....S ^TMP("PRPF_DIAGX",$J,PFSTAID,58,PFNAME_"_"_PRPFHLD1_"_"_"DefTrans#"_PRPFHLD2)="PRIVATE SOURCE AMT^Pvt src amt invalid or < 0 or > 99999^"_$P(PFNODE4D,"^",12)
"RTN","PRPFDR1",83,0)
 ....S CNTERR(58)=CNTERR(58)+1
"RTN","PRPFDR1",84,0)
 ....S CNTERR(100)=CNTERR(100)+1
"RTN","PRPFDR1",85,0)
 ...S PFNODE4X=$P(PFNODE4D,"^",13)
"RTN","PRPFDR1",86,0)
 ...I PFNODE4X'="" I +PFNODE4X'=PFNODE4X&(PFNODE4X'?.N1".".N)!(PFNODE4X>99999)!(PFNODE4X<.01) D
"RTN","PRPFDR1",87,0)
 ....S ^TMP("PRPF_DIAGX",$J,PFSTAID,59,PFNAME_"_"_PRPFHLD1_"_"_"DefTrans#"_PRPFHLD2)="GRATUITOUS AMOUNT^Gratuitous amt invalid or < 0 or > 99999^"_$P(PFNODE4D,"^",13)
"RTN","PRPFDR1",88,0)
 ....S CNTERR(59)=CNTERR(59)+1
"RTN","PRPFDR1",89,0)
 ....S CNTERR(100)=CNTERR(100)+1
"RTN","PRPFDR1",90,0)
 ...S PFNODE4X=$P(PFNODE4D,"^",14)
"RTN","PRPFDR1",91,0)
 ...I PFNODE4X'="" D
"RTN","PRPFDR1",92,0)
 ....I '$D(^VA(200,PFNODE4X,0))!($L($P($G(^VA(200,PFNODE4X,0)),"^",1))<3!($L($P($G(^VA(200,PFNODE4X,0)),"^",1))>35)) D
"RTN","PRPFDR1",93,0)
 .....S ^TMP("PRPF_DIAGX",$J,PFSTAID,60,PFNAME_"_"_PRPFHLD1_"_"_"DefTrans#"_PRPFHLD2)="PATIENT FUNDS CLERK^Pfunds clerk invalid^"_$P($G(^VA(200,PFNODE4X,0)),"^",1)
"RTN","PRPFDR1",94,0)
 .....S CNTERR(60)=CNTERR(60)+1
"RTN","PRPFDR1",95,0)
 .....S CNTERR(100)=CNTERR(100)+1
"RTN","PRPFDR1",96,0)
 ...I PFNODE4X="" D
"RTN","PRPFDR1",97,0)
 ....S ^TMP("PRPF_DIAGX",$J,PFSTAID,60,PFNAME_"_"_PRPFHLD1_"_"_"DefTrans#"_PRPFHLD2)="PATIENT FUNDS CLERK^Pfunds clerk invalid^"_""
"RTN","PRPFDR1",98,0)
 ....S CNTERR(60)=CNTERR(60)+1
"RTN","PRPFDR1",99,0)
 ....S CNTERR(100)=CNTERR(100)+1
"RTN","PRPFDR1",100,0)
 .S PRPFDEFR=PRPFDEFR+1
"RTN","PRPFDR1",101,0)
 Q
"RTN","PRPFDR1",102,0)
NODE5 S (PRPFHLD2,PRPFHLD3,PRPFHLD4)=0
"RTN","PRPFDR1",103,0)
 F  S PRPFHLD2=$O(^PRPF(470,PRPFHLD1,5,PRPFHLD2)) Q:'PRPFHLD2  D
"RTN","PRPFDR1",104,0)
 .S PFNODE5=$G(^PRPF(470,PRPFHLD1,5,PRPFHLD2,0))
"RTN","PRPFDR1",105,0)
 .S PFSUSDT=$P(PFNODE5,"^",1)
"RTN","PRPFDR1",106,0)
 .I PFSUSDT="" D
"RTN","PRPFDR1",107,0)
 ..S ^TMP("PRPF_DIAGX",$J,PFSTAID,43.1,PFNAME_"_"_PRPFHLD1_"_"_"SuspenseDate#"_PRPFHLD2)="SUSPENSE DATE^Suspense date is blank^"_PFSUSDT
"RTN","PRPFDR1",108,0)
 ..S CNTERR(43)=CNTERR(43)+1
"RTN","PRPFDR1",109,0)
 ..S CNTERR(100)=CNTERR(100)+1
"RTN","PRPFDR1",110,0)
 .ELSE  D
"RTN","PRPFDR1",111,0)
 ..K PRPFBADD
"RTN","PRPFDR1",112,0)
 ..D DT^DILF("X",PFSUSDT,.PRPFBADD)
"RTN","PRPFDR1",113,0)
 ..I $L(+PFSUSDT)'=7!(PRPFBADD=-1) D
"RTN","PRPFDR1",114,0)
 ...S ^TMP("PRPF_DIAGX",$J,PFSTAID,43.2,PFNAME_"_"_PRPFHLD1_"_"_"SuspenseDate#"_PRPFHLD2)="SUSPENSE DATE^Suspense date is not valid^"_PFSUSDT
"RTN","PRPFDR1",115,0)
 ...S CNTERR(43)=CNTERR(43)+1
"RTN","PRPFDR1",116,0)
 ...S CNTERR(100)=CNTERR(100)+1
"RTN","PRPFDR1",117,0)
 .F  S PRPFHLD3=$O(^PRPF(470,PRPFHLD1,5,PRPFHLD2,1,PRPFHLD3)) Q:'PRPFHLD3  D
"RTN","PRPFDR1",118,0)
 ..S PFNODE51=$G(^PRPF(470,PRPFHLD1,5,PRPFHLD2,1,PRPFHLD3,0))
"RTN","PRPFDR1",119,0)
 ..S PFSUSID=PFNODE51
"RTN","PRPFDR1",120,0)
 ..I PFSUSID="" D
"RTN","PRPFDR1",121,0)
 ...S ^TMP("PRPF_DIAGX",$J,PFSTAID,44.1,PFNAME_"_"_PRPFHLD1_"_"_"SuspenseDate#"_PRPFHLD2_"_Item#"_PRPFHLD3)="SUSPENSE ID^Suspense ID is blank^"_PFSUSID
"RTN","PRPFDR1",122,0)
 ...S CNTERR(44)=CNTERR(44)+1
"RTN","PRPFDR1",123,0)
 ...S CNTERR(100)=CNTERR(100)+1
"RTN","PRPFDR1",124,0)
 ..I PFSUSID'="" I $L(PFSUSID)<1!($L(PFSUSID)>40) D
"RTN","PRPFDR1",125,0)
 ...S ^TMP("PRPF_DIAGX",$J,PFSTAID,44.2,PFNAME_"_"_PRPFHLD1_"_"_"SuspenseDate#"_PRPFHLD2_"_Item#"_PRPFHLD3)="SUSPENSE ID^Suspense ID < 1 or > 40 characters^"_PFSUSID
"RTN","PRPFDR1",126,0)
 ...S CNTERR(44)=CNTERR(44)+1
"RTN","PRPFDR1",127,0)
 ...S CNTERR(100)=CNTERR(100)+1
"RTN","PRPFDR1",128,0)
 ..S PFSUSTXT=""
"RTN","PRPFDR1",129,0)
 ..F  S PRPFHLD4=$O(^PRPF(470,PRPFHLD1,5,PRPFHLD2,1,PRPFHLD3,1,PRPFHLD4)) Q:'PRPFHLD4  D
"RTN","PRPFDR1",130,0)
 ...S PFNODE52=$G(^PRPF(470,PRPFHLD1,5,PRPFHLD2,1,PRPFHLD3,1,PRPFHLD4,0))
"RTN","PRPFDR1",131,0)
 ...S PFSUSTXT=PFSUSTXT_PFNODE52
"RTN","PRPFDR1",132,0)
 ..I PFSUSTXT="" D
"RTN","PRPFDR1",133,0)
 ...S ^TMP("PRPF_DIAGX",$J,PFSTAID,45.1,PFNAME_"_"_PRPFHLD1_"_"_"SuspenseDate#"_PRPFHLD2_"_Item#"_PRPFHLD3)="SUSPENSE DESC^Suspense description is blank^"_PFSUSTXT
"RTN","PRPFDR1",134,0)
 ...S CNTERR(45)=CNTERR(45)+1
"RTN","PRPFDR1",135,0)
 ...S CNTERR(100)=CNTERR(100)+1
"RTN","PRPFDR1",136,0)
 ..I PFSUSTXT'="" I $L(PFSUSTXT)<1!($L(PFSUSTXT)>255) D
"RTN","PRPFDR1",137,0)
 ...S ^TMP("PRPF_DIAGX",$J,PFSTAID,45.2,PFNAME_"_"_PRPFHLD1_"_"_"SuspenseDate#"_PRPFHLD2_"_Item#"_PRPFHLD3)="SUSPENSE DESC^Suspense description < 1 or > 255 characters^"_"SUSPENSE ID="_PFSUSID_", DESCRIPTION LENGTH="_$L(PFSUSTXT)
"RTN","PRPFDR1",138,0)
 ...S CNTERR(45)=CNTERR(45)+1
"RTN","PRPFDR1",139,0)
 ...S CNTERR(100)=CNTERR(100)+1
"RTN","PRPFDR1",140,0)
 ..S PRPFHLD4=0
"RTN","PRPFDR1",141,0)
 .S PRPFHLD3=0
"RTN","PRPFDR1",142,0)
 Q
"RTN","PRPFDR1",143,0)
NODE12 I $G(^PRPF(470,PRPFHLD1,12))'="" D
"RTN","PRPFDR1",144,0)
 .I '$D(^DIC(4,^PRPF(470,PRPFHLD1,12),99))!(PFSTAID="ERRBADID")!(PFSTAID="ERRBADID1") D
"RTN","PRPFDR1",145,0)
 ..S ^TMP("PRPF_DIAGX",$J,PFSTAID,42,PFNAME_"_"_PRPFHLD1)="STATIONID^STATION ID INVALID^"_PFSTAID
"RTN","PRPFDR1",146,0)
 ..S CNTERR(42)=CNTERR(42)+1
"RTN","PRPFDR1",147,0)
 ..S CNTERR(100)=CNTERR(100)+1
"RTN","PRPFDR1",148,0)
 S:$G(^PRPF(470,PRPFHLD1,12))="" PFSTAID="UNASSIGNED"
"RTN","PRPFDR1",149,0)
NODE12X I PFSTAID=""!(PFSTAID="UNASSIGNED")!(PFSTAID="ERRNOID")!(PFSTAID="ERRNOID1") D
"RTN","PRPFDR1",150,0)
 .S:PFSTAID="" PFSTAID="UNASSIGNED"
"RTN","PRPFDR1",151,0)
 .S CNTERR(41)=CNTERR(41)+1
"RTN","PRPFDR1",152,0)
 .S CNTERR(100)=CNTERR(100)+1
"RTN","PRPFDR1",153,0)
 Q
"RTN","PRPFDR2")
0^2^B68312638
"RTN","PRPFDR2",1,0)
PRPFDR2 ;BAYPINES/MJE  VPFS DATA MIGRATION ROUTINE 2 ;05/15/03
"RTN","PRPFDR2",2,0)
 ;;3.0;PATIENT FUNDS DIAG V5.9;**15**;JUNE 1, 1989
"RTN","PRPFDR2",3,0)
 ;ENTRY AT LINETAG ONLY
"RTN","PRPFDR2",4,0)
 Q
"RTN","PRPFDR2",5,0)
LEG ;ENTRY POINT FOR LEGACY SYSTEM
"RTN","PRPFDR2",6,0)
 D SETUP
"RTN","PRPFDR2",7,0)
 D SUM
"RTN","PRPFDR2",8,0)
 W !
"RTN","PRPFDR2",9,0)
 W !,"NOTE: In addition to the summary report there is an available detail"
"RTN","PRPFDR2",10,0)
 W !,"report, this report can be sent to any device or flat file if required."
"RTN","PRPFDR2",11,0)
 W !,""
"RTN","PRPFDR2",12,0)
 W !,">>>>> The detail diagnostic report will contain "_CNTERR(100)_" lines."
"RTN","PRPFDR2",13,0)
 W !,""
"RTN","PRPFDR2",14,0)
 W !,"If you still desire the detail report, then please input the name of the"
"RTN","PRPFDR2",15,0)
 W !,"device that the report will be sent to."
"RTN","PRPFDR2",16,0)
 W !,""
"RTN","PRPFDR2",17,0)
 W !,"If the detail report is not desired then input ""^"" at the device prompt and the detail report will not print."
"RTN","PRPFDR2",18,0)
 W !,""
"RTN","PRPFDR2",19,0)
 D REP
"RTN","PRPFDR2",20,0)
 K ^TMP("PRPF_DIAGX")
"RTN","PRPFDR2",21,0)
 D KILLIT^PRPFDR4
"RTN","PRPFDR2",22,0)
 Q
"RTN","PRPFDR2",23,0)
REP S (PFX,PFY,PFZ,PFNAME)=""
"RTN","PRPFDR2",24,0)
 S %ZIS("B")="",%ZIS("HFSMODE")="W" D ^%ZIS K XION R X:2
"RTN","PRPFDR2",25,0)
 I POP K ^TMP("PRPF_DIAGX") Q
"RTN","PRPFDR2",26,0)
 U IO
"RTN","PRPFDR2",27,0)
 D SUM
"RTN","PRPFDR2",28,0)
 F  S PFX=$O(^TMP("PRPF_DIAGX",$J,PFX)) Q:PFX=""  D
"RTN","PRPFDR2",29,0)
 .F  S PFY=$O(^TMP("PRPF_DIAGX",$J,PFX,PFY)) Q:PFY=""  D
"RTN","PRPFDR2",30,0)
 ..F  S PFZ=$O(^TMP("PRPF_DIAGX",$J,PFX,PFY,PFZ)) Q:PFZ=""  D
"RTN","PRPFDR2",31,0)
 ...S PFTEMP=^TMP("PRPF_DIAGX",$J,PFX,PFY,PFZ)
"RTN","PRPFDR2",32,0)
 ...W !,"STATION ID="_PFX_"^ERR#="_PFY_"^NAME="_PFZ_"^DESC="_$P(PFTEMP,"^",2)_"^VALUE=>"_$P(PFTEMP,"^",3)_"<"
"RTN","PRPFDR2",33,0)
 D ^%ZISC
"RTN","PRPFDR2",34,0)
 Q
"RTN","PRPFDR2",35,0)
SUM W !,"**************************************************************************"
"RTN","PRPFDR2",36,0)
 W !,"**      Patient Funds Diagnostic Summary      (version 5.9)             **"
"RTN","PRPFDR2",37,0)
 W !,"**************************************************************************"
"RTN","PRPFDR2",38,0)
 D NOW^%DTC S Y=% D DD^%DT
"RTN","PRPFDR2",39,0)
 W !,"Run Date: "_$P(Y,"@",1)_"  Run Time: "_$P(Y,"@",2),?72,"**"
"RTN","PRPFDR2",40,0)
 W !,"Total accounts processed = "_CNTREC,?72,"**"
"RTN","PRPFDR2",41,0)
 W !,"Total balance of accounts for migration = $"_$FN(CNTBAL,",",2),?72,"**"
"RTN","PRPFDR2",42,0)
 W !,"**************************************************************************"
"RTN","PRPFDR2",43,0)
 W !,"Err#    Field           Error                                        Total"
"RTN","PRPFDR2",44,0)
 W !," #      Name            Description                                  Count"
"RTN","PRPFDR2",45,0)
 W !,"**************************************************************************"
"RTN","PRPFDR2",46,0)
 W !," #1     NAME            Name is blank",?72,CNTERR(1)
"RTN","PRPFDR2",47,0)
 W !," #2     NAME            Name contains invalid data",?72,CNTERR(2)
"RTN","PRPFDR2",48,0)
 W !," #3     SSN             SSN is blank",?72,CNTERR(3)
"RTN","PRPFDR2",49,0)
 W !," #4     SSN             SSN contains invalid data",?72,CNTERR(4)
"RTN","PRPFDR2",50,0)
 W !," #5     SSN             SSN contains duplicate value",?72,CNTERR(5)
"RTN","PRPFDR2",51,0)
 W !," #6     SSN             SSN contains Pseudo SSN value",?72,CNTRPSU
"RTN","PRPFDR2",52,0)
 W !," #7     DOB             DOB is blank",?72,CNTERR(7)
"RTN","PRPFDR2",53,0)
 W !," #8     DOB             DOB contains invalid date",?72,CNTERR(8)
"RTN","PRPFDR2",54,0)
 W !," #9     WARD            Ward loc invalid length",?72,CNTERR(9)
"RTN","PRPFDR2",55,0)
 W !," #10    CLAIM           Claim # contains invalid data",?72,CNTERR(10)
"RTN","PRPFDR2",56,0)
 W !," #11    ZIP             Zipcode contains invalid data",?72,CNTERR(11)
"RTN","PRPFDR2",57,0)
 W !," #12    REGION OFFICE   Regional Office ID invalid data",?72,CNTERR(12)
"RTN","PRPFDR2",58,0)
 W !," #13    ICN             ICN Duplicate",?72,CNTERR(13)
"RTN","PRPFDR2",59,0)
 W !," #14    ICN             ICN unassigned or invalid",?72,CNTERR(14)
"RTN","PRPFDR2",60,0)
 W !," #15    PROVIDER AUTHR  Provider Name contains invalid data",?72,CNTERR(15)
"RTN","PRPFDR2",61,0)
 W !,"*#16    PROVID AUTH DT  Date of current restriction invalid date",?72,CNTERR(16)
"RTN","PRPFDR2",62,0)
 W !,"*#17    NO DEMO RECORD  No demographic record for account",?72,CNTERR(17)
"RTN","PRPFDR2",63,0)
 W !,"*#18    ACCOUNT STATUS  Account status not (A),I,Blank="_PRPFBC18,?72,CNTERR(18)
"RTN","PRPFDR2",64,0)
 W !,"*#19    PATIENT TYPE    Patient type not L,R,(U),X,Blank="_PRPFBC19,?72,CNTERR(19)
"RTN","PRPFDR2",65,0)
 W !,"*#20    PAT TYPE/PHY    Patient type L or R without Phy name",?72,CNTERR(20)
"RTN","PRPFDR2",66,0)
 W !,"*#21    PATIENT STATUS  Patient Status not A,R,C,N,(X),Blank="_PRPFBC21,?72,CNTERR(21)
"RTN","PRPFDR2",67,0)
 W !,"*#22    INDIGENT        Indigent status not (N),Y,Blank="_PRPFBC22,?72,CNTERR(22)
"RTN","PRPFDR2",68,0)
 W !,"*#23    APPORTIONEE $   Apportionee amount invalid or < $0 or > $99,999",?72,CNTERR(23)
"RTN","PRPFDR2",69,0)
 W !,"*#24    GUARDIAN $      Guardian amount invalid or < $0 or > $99,999",?72,CNTERR(24)
"RTN","PRPFDR2",70,0)
 W !,"*#25    INSTITUT AWARD  Institut award invalid or < $0 or > $99,999",?72,CNTERR(25)
"RTN","PRPFDR2",71,0)
 W !,"*#26    OTHER ASSETS    Other assets invalid or < $0 or > $99,999",?72,CNTERR(26)
"RTN","PRPFDR2",72,0)
 W !,"*#27    STORED BALANCE  Stored balance invalid or < $0 or > $99,999",?72,CNTERR(27)
"RTN","PRPFDR2",73,0)
 W !,"*#28    STORED PRIVATE  Stored private invalid or < $0 or > $99,999",?72,CNTERR(28)
"RTN","PRPFDR2",74,0)
 W !,"*#29    STORED GRATUIT  Stored gratuitous invalid or < $0 or > $99,999",?72,CNTERR(29)
"RTN","PRPFDR2",75,0)
 W !,"*#30    RESTRCT MONTH   Restricted Monthly invalid or < $0 or > $99,999",?72,CNTERR(30)
"RTN","PRPFDR2",76,0)
 W !,"*#31    RESTRCT WEEKLY  Restricted Weekly invalid or < $0 or > $99,999",?72,CNTERR(31)
"RTN","PRPFDR2",77,0)
 W !,"*#32    RESTRCT AMT ER  Restrict Mnthly amount < (5X) weekly amt",?72,CNTERR(32)
"RTN","PRPFDR2",78,0)
 W !,"*#33    RESTRCT AMT ER  Restrict Mnthly amount < weekly amt",?72,CNTERR(33)
"RTN","PRPFDR2",79,0)
 W !,"*#34    MINIMUM BAL     Minimum balance #1 invalid or < $0 or > $99,999",?72,CNTERR(34)
"RTN","PRPFDR2",80,0)
 W !,"*#35    MAXIMUM BAL     Maximum balance #1 invalid or < $0 or > $99,999",?72,CNTERR(35)
"RTN","PRPFDR2",81,0)
 W !,"*#36    NO BALANCE REC  Balance record missing for account",?72,CNTERR(36)
"RTN","PRPFDR2",82,0)
 W !,"*#37    INCOME PAYEE    Income payee blank, Income source present",?72,CNTERR(37)
"RTN","PRPFDR2",83,0)
 W !,"*#38    INCOME AMOUNT   Income amount error, Income source present",?72,CNTERR(38)
"RTN","PRPFDR2",84,0)
 W !,"*#39    INCOME AMOUNT   Income amount < $1 or > $99,999",?72,CNTERR(39)
"RTN","PRPFDR2",85,0)
 W !,"*#40    INCOME FREQCY   Income frequency not D,W,M,Y,X,V,O,Blank="_PRPFBC40,?72,CNTERR(40)
"RTN","PRPFDR2",86,0)
 W !,"*#41    STATION ID      Station ID blank or unassigned",?72,CNTERR(41)
"RTN","PRPFDR2",87,0)
 W !," #42    STATION ID      Station ID invalid",?72,CNTERR(42)
"RTN","PRPFDR2",88,0)
 W !,"*#43    SUSPENSE DATE   Suspense date has invalid date",?72,CNTERR(43)
"RTN","PRPFDR2",89,0)
 W !,"*#44    SUSPENSE ID     Suspense ID has Invalid data",?72,CNTERR(44)
"RTN","PRPFDR2",90,0)
 W !,"*#45    SUSPENSE TEXT   Suspense text is < 1 or > 255 characters",?72,CNTERR(45)
"RTN","PRPFDR2",91,0)
 W !,"*#46    DEFERRED TRANS  There are "_PRPFDEFR_" deferred transactions",?72,PRPFDEFR
"RTN","PRPFDR2",92,0)
 W !,"*#47    TRANSACTION REC Transaction record missing, blank or ID invalid",?72,CNTERR(47)
"RTN","PRPFDR2",93,0)
 W !,"*#48    PATIENT NAME    Patient name does not match deferred trans",?72,CNTERR(48)
"RTN","PRPFDR2",94,0)
 W !,"*#49    PATIENT TRANS # Patient transaction # invalid",?72,CNTERR(49)
"RTN","PRPFDR2",95,0)
 W !,"*#50    DEFR AMOUNT     Deferred amount invalid",?72,CNTERR(50)
"RTN","PRPFDR2",96,0)
 W !,"*#51    TRANSACTN DATE  Transaction date Invalid",?72,CNTERR(51)
"RTN","PRPFDR2",97,0)
 W !,"*#52    DT TRAN ENTD    Date transaction entered Invalid",?72,CNTERR(52)
"RTN","PRPFDR2",98,0)
 W !,"*#53    REFERENCE       Reference Invalid < 1 or > 10 in length",?72,CNTERR(53)
"RTN","PRPFDR2",99,0)
 W !,"*#54    DEPOSIT/WTHDRWL Deposit/Withdrawal status Invalid",?72,CNTERR(54)
"RTN","PRPFDR2",100,0)
 W !,"*#55    CASH/CHECK/OTR  Cash/Check/Other status Invalid",?72,CNTERR(55)
"RTN","PRPFDR2",101,0)
 W !,"*#56    SOURCE          Transaction source invalid",?72,CNTERR(56)
"RTN","PRPFDR2",102,0)
 W !,"*#57    FORM            Form does not match",?72,CNTERR(57)
"RTN","PRPFDR2",103,0)
 W !,"*#58    PRVT SOURCE AMT Private source amount invalid or < 0 or > 99999",?72,CNTERR(58)
"RTN","PRPFDR2",104,0)
 W !,"*#59    GRATUITOUS AMT  Gratuitous amount invalid or < 0 or > 99999",?72,CNTERR(59)
"RTN","PRPFDR2",105,0)
 W !,"*#60    PFUNDS CLERK    PFunds clerk invalid",?72,CNTERR(60)
"RTN","PRPFDR2",106,0)
 W !,"**************************************************************************"
"RTN","PRPFDR2",107,0)
 Q
"RTN","PRPFDR2",108,0)
SETUP ;SETUP PARAMS GET DATA
"RTN","PRPFDR2",109,0)
 K ^TMP("PRPF_DIAGX")
"RTN","PRPFDR2",110,0)
 S ^TMP("PRPF_DIAGX",$J,0)=DTIME_"^"_"DTIME"_"^"_"PRPF MIGRATION DIAGNOSTIC TEMP DATA"
"RTN","PRPFDR2",111,0)
 S (PRPFDEFR,PRPFBBAL,PRPFBDMO,PRPFHLD1,PRPFHLD2,PRPFHLD3,PRPFHLD4,CNTBAL,CNTREC,CNTRPSU,PFG,PFSTDBAL)=0
"RTN","PRPFDR2",112,0)
 S (PRPFBC18,PRPFBC19,PRPFBC21,PRPFBC22,PRPFBC40)=0
"RTN","PRPFDR2",113,0)
 F I=1:1:100 D
"RTN","PRPFDR2",114,0)
 .S CNTERR(I)=0
"RTN","PRPFDR2",115,0)
 F  S PRPFHLD1=$O(^PRPF(470,PRPFHLD1)) Q:'PRPFHLD1  D
"RTN","PRPFDR2",116,0)
 .S PFG=PFG+1 I PFG=100 W "." S PFG=0
"RTN","PRPFDR2",117,0)
 .S ND=""
"RTN","PRPFDR2",118,0)
 .S CNTREC=CNTREC+1
"RTN","PRPFDR2",119,0)
 .D:$G(^PRPF(470,PRPFHLD1,0))'="" COMPU
"RTN","PRPFDR2",120,0)
 .I $D(^PRPF(470,PRPFHLD1,12)) I $G(^PRPF(470,PRPFHLD1,12))'="" D
"RTN","PRPFDR2",121,0)
 ..I $D(^DIC(4,^PRPF(470,PRPFHLD1,12),99)) I $P(^DIC(4,^PRPF(470,PRPFHLD1,12),99),"^",1)'="" D
"RTN","PRPFDR2",122,0)
 ...S PFSTAID=^PRPF(470,PRPFHLD1,12)
"RTN","PRPFDR2",123,0)
 ...D NODE12^PRPFDR1
"RTN","PRPFDR2",124,0)
 ..I $D(^DIC(4,^PRPF(470,PRPFHLD1,12),99)) I $P(^DIC(4,^PRPF(470,PRPFHLD1,12),99),"^",1)="" D
"RTN","PRPFDR2",125,0)
 ...S PFSTAID="ERRBADID1"
"RTN","PRPFDR2",126,0)
 ...D NODE12^PRPFDR1
"RTN","PRPFDR2",127,0)
 ..I '$D(^DIC(4,^PRPF(470,PRPFHLD1,12),99)) D
"RTN","PRPFDR2",128,0)
 ...S PFSTAID="ERRBADID"
"RTN","PRPFDR2",129,0)
 ...D NODE12^PRPFDR1
"RTN","PRPFDR2",130,0)
 .I '$D(^PRPF(470,PRPFHLD1,12)) S PFSTAID="ERRNOID" D NODE12X^PRPFDR1
"RTN","PRPFDR2",131,0)
 .I $D(^PRPF(470,PRPFHLD1,12)) I $G(^PRPF(470,PRPFHLD1,12))="" D
"RTN","PRPFDR2",132,0)
 ..S PFSTAID="ERRNOID1"
"RTN","PRPFDR2",133,0)
 ..D NODE12X^PRPFDR1
"RTN","PRPFDR2",134,0)
 .D:$G(^PRPF(470,PRPFHLD1,0))'="" NODE0^PRPFDR5
"RTN","PRPFDR2",135,0)
 .D:$G(^PRPF(470,PRPFHLD1,0))="" NODE0X^PRPFDR5
"RTN","PRPFDR2",136,0)
 .D:$G(^PRPF(470,PRPFHLD1,1))'="" NODE1^PRPFDR4
"RTN","PRPFDR2",137,0)
 .D:$G(^PRPF(470,PRPFHLD1,1))="" NODE1X^PRPFDR4
"RTN","PRPFDR2",138,0)
 .D:$G(^PRPF(470,PRPFHLD1,2))'="" NODE2^PRPFDR4
"RTN","PRPFDR2",139,0)
 .D:$O(^PRPF(470,PRPFHLD1,4,0))>0 NODE4^PRPFDR1
"RTN","PRPFDR2",140,0)
 .D:$O(^PRPF(470,PRPFHLD1,5,0))>0 NODE5^PRPFDR1
"RTN","PRPFDR2",141,0)
 .D:$O(^PRPF(470,PRPFHLD1,6,0))>0 NODE6^PRPFDR4
"RTN","PRPFDR2",142,0)
 Q
"RTN","PRPFDR2",143,0)
 ;***************************************************************
"RTN","PRPFDR2",144,0)
COMPU ; SPECIFIC PATIENT INFO LOOKUP
"RTN","PRPFDR2",145,0)
 S PFNAME=$P($G(^DPT(PRPFHLD1,0)),"^",1)
"RTN","PRPFDR2",146,0)
 S PFSSN=$P($G(^DPT(PRPFHLD1,0)),"^",9)
"RTN","PRPFDR2",147,0)
 I PFNAME="" I PFSSN'="" S PFNAME="NAME-MISSING-SSN#"_PFSSN
"RTN","PRPFDR2",148,0)
 I PFNAME="" I PFSSN="" S PFNAME="NAME-MISSING-NO-SSN-IEN#"_PRPFHLD1
"RTN","PRPFDR2",149,0)
 S PFDOB=$P($G(^DPT(PRPFHLD1,0)),"^",3)
"RTN","PRPFDR2",150,0)
 S PFWARD=$P($G(^DPT(PRPFHLD1,.1)),"^",1)
"RTN","PRPFDR2",151,0)
 S PFCLAIM=$P($G(^DPT(PRPFHLD1,.31)),"^",3)
"RTN","PRPFDR2",152,0)
 S PFADDR1=$P($G(^DPT(PRPFHLD1,.11)),"^",1)
"RTN","PRPFDR2",153,0)
 S PFADDR2=$P($G(^DPT(PRPFHLD1,.11)),"^",2)
"RTN","PRPFDR2",154,0)
 S PFADDR3=$P($G(^DPT(PRPFHLD1,.11)),"^",3)
"RTN","PRPFDR2",155,0)
 S PFCITY=$P($G(^DPT(PRPFHLD1,.11)),"^",4)
"RTN","PRPFDR2",156,0)
 S PFSTATE=$P($G(^DPT(PRPFHLD1,.11)),"^",5)
"RTN","PRPFDR2",157,0)
 S PFZIP=$P($G(^DPT(PRPFHLD1,.11)),"^",6)
"RTN","PRPFDR2",158,0)
 S PFSITE=$P($$SITE^VASITE(),"^",3)
"RTN","PRPFDR2",159,0)
 S:PFSITE="" PFSITE="###"
"RTN","PRPFDR2",160,0)
 S PFAUTH=$P(^PRPF(470,PRPFHLD1,0),"^",13)
"RTN","PRPFDR2",161,0)
 Q
"RTN","PRPFDR3")
0^3^B71656753
"RTN","PRPFDR3",1,0)
PRPFDR3 ;BAYPINES/MJE  VPFS DATA MIGRATION ROUTINE 3 ;05/15/03
"RTN","PRPFDR3",2,0)
 ;;3.0;PATIENT FUNDS DIAG V5.9;**15**;JUNE 1, 1989
"RTN","PRPFDR3",3,0)
 ;ENTRY AT LINETAG ONLY
"RTN","PRPFDR3",4,0)
 Q
"RTN","PRPFDR3",5,0)
RPC(RESULTS,PARAM1,PARAM2) ;ENTRY POINT FOR VPFS RPC
"RTN","PRPFDR3",6,0)
 S PRPFJ=PARAM2
"RTN","PRPFDR3",7,0)
 S PRPFSEG=PARAM1
"RTN","PRPFDR3",8,0)
 I PRPFSEG>1 D SENDSEG Q
"RTN","PRPFDR3",9,0)
TESTRPC ;ENTRY POINT FOR TESTING
"RTN","PRPFDR3",10,0)
 K ^TMP("PRPF_DIAGVL")
"RTN","PRPFDR3",11,0)
 D SETUP^PRPFDR2
"RTN","PRPFDR3",12,0)
 S CNTSEG=1
"RTN","PRPFDR3",13,0)
 S CNTTOT=0
"RTN","PRPFDR3",14,0)
 D XSUM
"RTN","PRPFDR3",15,0)
 D XREP
"RTN","PRPFDR3",16,0)
 S RESULTS=$NA(^TMP("PRPF_DIAGVL",$J,1))
"RTN","PRPFDR3",17,0)
 D KILLIT^PRPFDR4
"RTN","PRPFDR3",18,0)
 Q
"RTN","PRPFDR3",19,0)
SENDSEG ;SEND A SEGMENT OF DATA TO MIGRATION JAVA APP
"RTN","PRPFDR3",20,0)
 S RESULTS=$NA(^TMP("PRPF_DIAGVL",PRPFJ,PRPFSEG))
"RTN","PRPFDR3",21,0)
 Q
"RTN","PRPFDR3",22,0)
SEG ;SET UP NEW SEGMENT NODE
"RTN","PRPFDR3",23,0)
 D:PRPFCNTR=10000
"RTN","PRPFDR3",24,0)
 .S CNTSEG=CNTSEG+1
"RTN","PRPFDR3",25,0)
 .S CNTTOT=CNTTOT+PRPFCNTR
"RTN","PRPFDR3",26,0)
 .S PRPFCNTR=0
"RTN","PRPFDR3",27,0)
 Q
"RTN","PRPFDR3",28,0)
XREP S (PFX,PFY,PFZ,PFNAME)=""
"RTN","PRPFDR3",29,0)
 F  S PFX=$O(^TMP("PRPF_DIAGX",$J,PFX)) Q:PFX=""  D
"RTN","PRPFDR3",30,0)
 .F  S PFY=$O(^TMP("PRPF_DIAGX",$J,PFX,PFY)) Q:PFY=""  D
"RTN","PRPFDR3",31,0)
 ..F  S PFZ=$O(^TMP("PRPF_DIAGX",$J,PFX,PFY,PFZ)) Q:PFZ=""  D
"RTN","PRPFDR3",32,0)
 ...S PFTEMP=^TMP("PRPF_DIAGX",$J,PFX,PFY,PFZ)
"RTN","PRPFDR3",33,0)
 ...S PRPFCNTR=PRPFCNTR+1
"RTN","PRPFDR3",34,0)
 ...S ^TMP("PRPF_DIAGVL",$J,CNTSEG,PRPFCNTR)="STATION ID="_PFX_"^ERR#="_PFY_"^NAME="_PFZ_"^DESC="_$P(PFTEMP,"^",2)_"^VALUE=>"_$P(PFTEMP,"^",3)_"<"
"RTN","PRPFDR3",35,0)
 ...D SEG
"RTN","PRPFDR3",36,0)
 S CNTTOT=CNTTOT+PRPFCNTR
"RTN","PRPFDR3",37,0)
 S ^TMP("PRPF_DIAGVL",$J,0)=DTIME_"^"_"DTIME"_"^"_"PRPF MIGRATION DIAGNOSTIC TEMP DATA SENT TO J2EE"
"RTN","PRPFDR3",38,0)
 S ^TMP("PRPF_DIAGVL",$J,1,0)="VPFS"_U_PFSITE_U_U_U_U_"0"_U_"A1"_U_CNTREC_U_CNTTOT_U_$J
"RTN","PRPFDR3",39,0)
 K ^TMP("PRPF_DIAGX")
"RTN","PRPFDR3",40,0)
 Q
"RTN","PRPFDR3",41,0)
XSUM ;THIS ENTRY POINT FOR VISTALINK
"RTN","PRPFDR3",42,0)
 S PRPFCNTR=0
"RTN","PRPFDR3",43,0)
 S PRPFCNTR=PRPFCNTR+1 S ^TMP("PRPF_DIAGVL",$J,CNTSEG,PRPFCNTR)="**************************************************************************"
"RTN","PRPFDR3",44,0)
 D SEG
"RTN","PRPFDR3",45,0)
 S PRPFCNTR=PRPFCNTR+1 S ^TMP("PRPF_DIAGVL",$J,CNTSEG,PRPFCNTR)="**      Patient Funds Diagnostic Summary LEGACY RPC    (version 5.9)    **"
"RTN","PRPFDR3",46,0)
 D SEG
"RTN","PRPFDR3",47,0)
 S PRPFCNTR=PRPFCNTR+1 S ^TMP("PRPF_DIAGVL",$J,CNTSEG,PRPFCNTR)="**************************************************************************"
"RTN","PRPFDR3",48,0)
 D SEG
"RTN","PRPFDR3",49,0)
 D NOW^%DTC S Y=% D DD^%DT
"RTN","PRPFDR3",50,0)
 S PRPFCNTR=PRPFCNTR+1 S ^TMP("PRPF_DIAGVL",$J,CNTSEG,PRPFCNTR)="Run Date: "_$P(Y,"@",1)_"  Run Time: "_$P(Y,"@",2)_$P("       "," ",1,7-$L(CNTREC))_"                            **"
"RTN","PRPFDR3",51,0)
 D SEG
"RTN","PRPFDR3",52,0)
 S PRPFCNTR=PRPFCNTR+1 S ^TMP("PRPF_DIAGVL",$J,CNTSEG,PRPFCNTR)="Total accounts processed = "_CNTREC_$P("       "," ",1,7-$L(CNTREC))_"                                       **"
"RTN","PRPFDR3",53,0)
 D SEG
"RTN","PRPFDR3",54,0)
 S PRPFCNTR=PRPFCNTR+1 S ^TMP("PRPF_DIAGVL",$J,CNTSEG,PRPFCNTR)="Total balance of accounts for migration = $"_$FN(CNTBAL,",",2)_$P("              "," ",1,14-$L($FN(CNTBAL,",",2)))_"                **"
"RTN","PRPFDR3",55,0)
 D SEG
"RTN","PRPFDR3",56,0)
 S PRPFCNTR=PRPFCNTR+1 S ^TMP("PRPF_DIAGVL",$J,CNTSEG,PRPFCNTR)="**************************************************************************"
"RTN","PRPFDR3",57,0)
 D SEG
"RTN","PRPFDR3",58,0)
 S PRPFCNTR=PRPFCNTR+1 S ^TMP("PRPF_DIAGVL",$J,CNTSEG,PRPFCNTR)="Err#    Field           Error                                        Total"
"RTN","PRPFDR3",59,0)
 D SEG
"RTN","PRPFDR3",60,0)
 S PRPFCNTR=PRPFCNTR+1 S ^TMP("PRPF_DIAGVL",$J,CNTSEG,PRPFCNTR)=" #      Name            Description                                  Count"
"RTN","PRPFDR3",61,0)
 D SEG
"RTN","PRPFDR3",62,0)
 S PRPFCNTR=PRPFCNTR+1 S ^TMP("PRPF_DIAGVL",$J,CNTSEG,PRPFCNTR)="**************************************************************************"
"RTN","PRPFDR3",63,0)
 D SEG
"RTN","PRPFDR3",64,0)
 S PRPFCNTR=PRPFCNTR+1 S ^TMP("PRPF_DIAGVL",$J,CNTSEG,PRPFCNTR)=" #1     NAME            Name is blank                                   "_CNTERR(1)
"RTN","PRPFDR3",65,0)
 D SEG
"RTN","PRPFDR3",66,0)
 S PRPFCNTR=PRPFCNTR+1 S ^TMP("PRPF_DIAGVL",$J,CNTSEG,PRPFCNTR)=" #2     NAME            Name contains invalid data                      "_CNTERR(2)
"RTN","PRPFDR3",67,0)
 D SEG
"RTN","PRPFDR3",68,0)
 S PRPFCNTR=PRPFCNTR+1 S ^TMP("PRPF_DIAGVL",$J,CNTSEG,PRPFCNTR)=" #3     SSN             SSN is blank                                    "_CNTERR(3)
"RTN","PRPFDR3",69,0)
 D SEG
"RTN","PRPFDR3",70,0)
 S PRPFCNTR=PRPFCNTR+1 S ^TMP("PRPF_DIAGVL",$J,CNTSEG,PRPFCNTR)=" #4     SSN             SSN contains invalid data                       "_CNTERR(4)
"RTN","PRPFDR3",71,0)
 D SEG
"RTN","PRPFDR3",72,0)
 S PRPFCNTR=PRPFCNTR+1 S ^TMP("PRPF_DIAGVL",$J,CNTSEG,PRPFCNTR)=" #5     SSN             SSN contains duplicate value                    "_CNTERR(5)
"RTN","PRPFDR3",73,0)
 D SEG
"RTN","PRPFDR3",74,0)
 S PRPFCNTR=PRPFCNTR+1 S ^TMP("PRPF_DIAGVL",$J,CNTSEG,PRPFCNTR)=" #6     SSN             SSN contains Pseudo SSN value                   "_CNTRPSU
"RTN","PRPFDR3",75,0)
 D SEG
"RTN","PRPFDR3",76,0)
 S PRPFCNTR=PRPFCNTR+1 S ^TMP("PRPF_DIAGVL",$J,CNTSEG,PRPFCNTR)=" #7     DOB             DOB is blank                                    "_CNTERR(7)
"RTN","PRPFDR3",77,0)
 D SEG
"RTN","PRPFDR3",78,0)
 S PRPFCNTR=PRPFCNTR+1 S ^TMP("PRPF_DIAGVL",$J,CNTSEG,PRPFCNTR)=" #8     DOB             DOB contains invalid date                       "_CNTERR(8)
"RTN","PRPFDR3",79,0)
 D SEG
"RTN","PRPFDR3",80,0)
 S PRPFCNTR=PRPFCNTR+1 S ^TMP("PRPF_DIAGVL",$J,CNTSEG,PRPFCNTR)=" #9     WARD            Ward loc invalid length                         "_CNTERR(9)
"RTN","PRPFDR3",81,0)
 D SEG
"RTN","PRPFDR3",82,0)
 S PRPFCNTR=PRPFCNTR+1 S ^TMP("PRPF_DIAGVL",$J,CNTSEG,PRPFCNTR)=" #10    CLAIM           Claim # contains invalid data                   "_CNTERR(10)
"RTN","PRPFDR3",83,0)
 D SEG
"RTN","PRPFDR3",84,0)
 S PRPFCNTR=PRPFCNTR+1 S ^TMP("PRPF_DIAGVL",$J,CNTSEG,PRPFCNTR)=" #11    ZIP             Zipcode contains invalid data                   "_CNTERR(11)
"RTN","PRPFDR3",85,0)
 D SEG
"RTN","PRPFDR3",86,0)
 S PRPFCNTR=PRPFCNTR+1 S ^TMP("PRPF_DIAGVL",$J,CNTSEG,PRPFCNTR)=" #12    REGION OFFICE   Regional Office ID invalid data                 "_CNTERR(12)
"RTN","PRPFDR3",87,0)
 D SEG
"RTN","PRPFDR3",88,0)
 S PRPFCNTR=PRPFCNTR+1 S ^TMP("PRPF_DIAGVL",$J,CNTSEG,PRPFCNTR)=" #13    ICN             ICN Duplicate                                   "_CNTERR(13)
"RTN","PRPFDR3",89,0)
 D SEG
"RTN","PRPFDR3",90,0)
 S PRPFCNTR=PRPFCNTR+1 S ^TMP("PRPF_DIAGVL",$J,CNTSEG,PRPFCNTR)=" #14    ICN             ICN unassigned or invalid                       "_CNTERR(14)
"RTN","PRPFDR3",91,0)
 D SEG
"RTN","PRPFDR3",92,0)
 S PRPFCNTR=PRPFCNTR+1 S ^TMP("PRPF_DIAGVL",$J,CNTSEG,PRPFCNTR)=" #15    PROVIDER AUTHR  Provider Name contains invalid data             "_CNTERR(15)
"RTN","PRPFDR3",93,0)
 D SEG
"RTN","PRPFDR3",94,0)
 S PRPFCNTR=PRPFCNTR+1 S ^TMP("PRPF_DIAGVL",$J,CNTSEG,PRPFCNTR)="*#16    PROVID AUTH DT  Date of current restriction invalid date        "_CNTERR(16)
"RTN","PRPFDR3",95,0)
 D SEG
"RTN","PRPFDR3",96,0)
 S PRPFCNTR=PRPFCNTR+1 S ^TMP("PRPF_DIAGVL",$J,CNTSEG,PRPFCNTR)="*#17    NO DEMO REC     No demographic record for account               "_CNTERR(17)
"RTN","PRPFDR3",97,0)
 D SEG
"RTN","PRPFDR3",98,0)
 S PRPFCNTR=PRPFCNTR+1 S ^TMP("PRPF_DIAGVL",$J,CNTSEG,PRPFCNTR)="*#18    ACCOUNT STATUS  Account status not (A),I,Blank="_PRPFBC18_$P("      "," ",1,6-$L(PRPFBC18))_"            "_CNTERR(18)
"RTN","PRPFDR3",99,0)
 D SEG
"RTN","PRPFDR3",100,0)
 S PRPFCNTR=PRPFCNTR+1 S ^TMP("PRPF_DIAGVL",$J,CNTSEG,PRPFCNTR)="*#19    PATIENT TYPE    Patient type not L,R,(U),X,Blank="_PRPFBC19_$P("      "," ",1,8-$L(PRPFBC19))_"        "_CNTERR(19)
"RTN","PRPFDR3",101,0)
 D SEG
"RTN","PRPFDR3",102,0)
 S PRPFCNTR=PRPFCNTR+1 S ^TMP("PRPF_DIAGVL",$J,CNTSEG,PRPFCNTR)="*#20    PAT TYPE/PHY    Patient type L or R without Phy name            "_CNTERR(20)
"RTN","PRPFDR3",103,0)
 D SEG
"RTN","PRPFDR3",104,0)
 S PRPFCNTR=PRPFCNTR+1 S ^TMP("PRPF_DIAGVL",$J,CNTSEG,PRPFCNTR)="*#21    PATIENT STATUS  Patient Status not A,R,C,N,(X),Blank="_PRPFBC21_$P("      "," ",1,6-$L(PRPFBC21))_"      "_CNTERR(21)
"RTN","PRPFDR3",105,0)
 D SEG
"RTN","PRPFDR3",106,0)
 S PRPFCNTR=PRPFCNTR+1 S ^TMP("PRPF_DIAGVL",$J,CNTSEG,PRPFCNTR)="*#22    INDIGENT        Indigent status not (N),Y,Blank="_PRPFBC22_$P("      "," ",1,6-$L(PRPFBC22))_"           "_CNTERR(22)
"RTN","PRPFDR3",107,0)
 D SEG
"RTN","PRPFDR3",108,0)
 S PRPFCNTR=PRPFCNTR+1 S ^TMP("PRPF_DIAGVL",$J,CNTSEG,PRPFCNTR)="*#23    APPORTIONEE $   Apportionee amount invalid or < $0 or > $99,999 "_CNTERR(23)
"RTN","PRPFDR3",109,0)
 D SEG
"RTN","PRPFDR3",110,0)
 S PRPFCNTR=PRPFCNTR+1 S ^TMP("PRPF_DIAGVL",$J,CNTSEG,PRPFCNTR)="*#24    GUARDIAN $      Guardian amount invalid or < $0 or > $99,999    "_CNTERR(24)
"RTN","PRPFDR3",111,0)
 D SEG
"RTN","PRPFDR3",112,0)
 S PRPFCNTR=PRPFCNTR+1 S ^TMP("PRPF_DIAGVL",$J,CNTSEG,PRPFCNTR)="*#25    INSTITUT AWARD  Institut award invalid or < $0 or > $99,999     "_CNTERR(25)
"RTN","PRPFDR3",113,0)
 D SEG
"RTN","PRPFDR3",114,0)
 S PRPFCNTR=PRPFCNTR+1 S ^TMP("PRPF_DIAGVL",$J,CNTSEG,PRPFCNTR)="*#26    OTHER ASSETS    Other assets invalid or < $0 or > $99,999       "_CNTERR(26)
"RTN","PRPFDR3",115,0)
 D SEG
"RTN","PRPFDR3",116,0)
 S PRPFCNTR=PRPFCNTR+1 S ^TMP("PRPF_DIAGVL",$J,CNTSEG,PRPFCNTR)="*#27    STORED BALANCE  Stored balance invalid or < $0 or > $99,999     "_CNTERR(27)
"RTN","PRPFDR3",117,0)
 D SEG
"RTN","PRPFDR3",118,0)
 S PRPFCNTR=PRPFCNTR+1 S ^TMP("PRPF_DIAGVL",$J,CNTSEG,PRPFCNTR)="*#28    STORED PRIVATE  Stored private invalid or < $0 or > $99,999     "_CNTERR(28)
"RTN","PRPFDR3",119,0)
 D SEG
"RTN","PRPFDR3",120,0)
 S PRPFCNTR=PRPFCNTR+1 S ^TMP("PRPF_DIAGVL",$J,CNTSEG,PRPFCNTR)="*#29    STORED GRATUIT  Stored gratuitous invalid or < $0 or > $99,999  "_CNTERR(29)
"RTN","PRPFDR3",121,0)
 D SEG
"RTN","PRPFDR3",122,0)
 S PRPFCNTR=PRPFCNTR+1 S ^TMP("PRPF_DIAGVL",$J,CNTSEG,PRPFCNTR)="*#30    RESTRCT MONTH   Restricted Monthly invalid or < $0 or > $99,999 "_CNTERR(30)
"RTN","PRPFDR3",123,0)
 D SEG
"RTN","PRPFDR3",124,0)
 S PRPFCNTR=PRPFCNTR+1 S ^TMP("PRPF_DIAGVL",$J,CNTSEG,PRPFCNTR)="*#31    RESTRCT WEEKLY  Restricted Weekly invalid or < $0 or > $99,999  "_CNTERR(31)
"RTN","PRPFDR3",125,0)
 D SEG
"RTN","PRPFDR3",126,0)
 S PRPFCNTR=PRPFCNTR+1 S ^TMP("PRPF_DIAGVL",$J,CNTSEG,PRPFCNTR)="*#32    RESTRCT AMT ER  Restrict Mnthly amount > (5X) weekly amt        "_CNTERR(32)
"RTN","PRPFDR3",127,0)
 D SEG
"RTN","PRPFDR3",128,0)
 D XSUM1^PRPFDR6
"RTN","PRPFDR3",129,0)
 Q
"RTN","PRPFDR4")
0^4^B33333935
"RTN","PRPFDR4",1,0)
PRPFDR4 ;BAYPINES/MJE  VPFS DATA MIGRATION ROUTINE 4 ;05/15/03
"RTN","PRPFDR4",2,0)
 ;;3.0;PATIENT FUNDS DIAG V5.9;**15**;JUNE 1, 1989
"RTN","PRPFDR4",3,0)
 ;BAD ENTRY POINT
"RTN","PRPFDR4",4,0)
 Q
"RTN","PRPFDR4",5,0)
NODE1 S PFNODE1=$G(^PRPF(470,PRPFHLD1,1))
"RTN","PRPFDR4",6,0)
 S PFSTDBAL=$P(PFNODE1,"^",4)
"RTN","PRPFDR4",7,0)
 I PFSTDBAL>0 S CNTBAL=CNTBAL+PFSTDBAL
"RTN","PRPFDR4",8,0)
 I PFSTDBAL'="" I PFSTDBAL<0!(PFSTDBAL>99999)!((PFSTDBAL'=+PFSTDBAL)&(PFSTDBAL'?.N1".".N)) D
"RTN","PRPFDR4",9,0)
 .S ^TMP("PRPF_DIAGX",$J,PFSTAID,27,PFNAME_"_"_PRPFHLD1)="STORED BALANCE^Stored balance invalid or out of range either < $0 or > $99,999^"_PFSTDBAL
"RTN","PRPFDR4",10,0)
 .S CNTERR(27)=CNTERR(27)+1
"RTN","PRPFDR4",11,0)
 .S CNTERR(100)=CNTERR(100)+1
"RTN","PRPFDR4",12,0)
 S PFSTDPVT=$P(PFNODE1,"^",5)
"RTN","PRPFDR4",13,0)
 I PFSTDPVT'="" I PFSTDPVT<0!(PFSTDPVT>99999)!((PFSTDPVT'=+PFSTDPVT)&(PFSTDPVT'?.N1".".N)) D
"RTN","PRPFDR4",14,0)
 .S ^TMP("PRPF_DIAGX",$J,PFSTAID,28,PFNAME_"_"_PRPFHLD1)="STORED PRIVATE SOURCE^Stored private invalid or out of range either < $0 or > $99,999^"_PFSTDPVT
"RTN","PRPFDR4",15,0)
 .S CNTERR(28)=CNTERR(28)+1
"RTN","PRPFDR4",16,0)
 .S CNTERR(100)=CNTERR(100)+1
"RTN","PRPFDR4",17,0)
 S PFSTDGRT=$P(PFNODE1,"^",6)
"RTN","PRPFDR4",18,0)
 I PFSTDGRT'="" I PFSTDGRT<0!(PFSTDGRT>99999)!((PFSTDGRT'=+PFSTDGRT)&(PFSTDGRT'?.N1".".N)) D
"RTN","PRPFDR4",19,0)
 .S ^TMP("PRPF_DIAGX",$J,PFSTAID,29,PFNAME_"_"_PRPFHLD1)="STORED GRATUITOUS^Stored gratuitous invalid or out of range either < $0 or > $99,999^"_PFSTDGRT
"RTN","PRPFDR4",20,0)
 .S CNTERR(29)=CNTERR(29)+1
"RTN","PRPFDR4",21,0)
 .S CNTERR(100)=CNTERR(100)+1
"RTN","PRPFDR4",22,0)
 S PFARPM=$P(PFNODE1,"^",7)
"RTN","PRPFDR4",23,0)
 I PFARPM'="" I PFARPM<0!(PFARPM>99999)!((PFARPM'=+PFARPM)&(PFARPM'?.N1".".N)) D
"RTN","PRPFDR4",24,0)
 .S ^TMP("PRPF_DIAGX",$J,PFSTAID,30,PFNAME_"_"_PRPFHLD1)="RESTRICTED AMOUNT^Restricted monthly amount invalid or < $0 or > $99,999^"_PFARPM
"RTN","PRPFDR4",25,0)
 .S CNTERR(30)=CNTERR(30)+1
"RTN","PRPFDR4",26,0)
 .S CNTERR(100)=CNTERR(100)+1
"RTN","PRPFDR4",27,0)
 S PFARPW=$P(PFNODE1,"^",8)
"RTN","PRPFDR4",28,0)
 I PFARPW'="" I PFARPW<0!(PFARPW>99999)!((PFARPW'=+PFARPW)&(PFARPW'?.N1".".N)) D
"RTN","PRPFDR4",29,0)
 .S ^TMP("PRPF_DIAGX",$J,PFSTAID,31,PFNAME_"_"_PRPFHLD1)="RESTRICTED AMOUNT^Restricted weekly amount invalid or < $0 or > $99,999^"_PFARPW
"RTN","PRPFDR4",30,0)
 .S CNTERR(31)=CNTERR(31)+1
"RTN","PRPFDR4",31,0)
 .S CNTERR(100)=CNTERR(100)+1
"RTN","PRPFDR4",32,0)
 I PFARPW'=""&(PFARPM'="") I PFARPM<(5*PFARPW) D
"RTN","PRPFDR4",33,0)
 .S ^TMP("PRPF_DIAGX",$J,PFSTAID,32,PFNAME_"_"_PRPFHLD1)="RESTRCT AMT ER^Restrict Mnthly amount < (5X) weekly amt^"_PFARPM
"RTN","PRPFDR4",34,0)
 .S CNTERR(32)=CNTERR(32)+1
"RTN","PRPFDR4",35,0)
 .S CNTERR(100)=CNTERR(100)+1
"RTN","PRPFDR4",36,0)
 I PFARPW'=""&(PFARPM'="") I PFARPM<PFARPW D
"RTN","PRPFDR4",37,0)
 .S ^TMP("PRPF_DIAGX",$J,PFSTAID,33,PFNAME_"_"_PRPFHLD1)="RESTRCT AMT ER^Restrict Mnthly amount < weekly amt^"_PFARPM
"RTN","PRPFDR4",38,0)
 .S CNTERR(33)=CNTERR(33)+1
"RTN","PRPFDR4",39,0)
 .S CNTERR(100)=CNTERR(100)+1
"RTN","PRPFDR4",40,0)
 Q
"RTN","PRPFDR4",41,0)
NODE1X S ^TMP("PRPF_DIAGX",$J,PFSTAID,36,PFNAME_"_"_PRPFHLD1)="NO BALANCE REC^BALANCE RECORD DATA MISSING^"_PFNAME
"RTN","PRPFDR4",42,0)
 S CNTERR(36)=CNTERR(36)+1
"RTN","PRPFDR4",43,0)
 S CNTERR(100)=CNTERR(100)+1
"RTN","PRPFDR4",44,0)
 Q
"RTN","PRPFDR4",45,0)
NODE2 S PFNODE2=^PRPF(470,PRPFHLD1,2)
"RTN","PRPFDR4",46,0)
 S PFMIN1=$P(PFNODE2,"^",1)
"RTN","PRPFDR4",47,0)
 I PFMIN1'="" I PFMIN1<0!(PFMIN1>99999)!((PFMIN1'=+PFMIN1)&(PFMIN1'?.N1".".N)) D
"RTN","PRPFDR4",48,0)
 .S ^TMP("PRPF_DIAGX",$J,PFSTAID,34,PFNAME_"_"_PRPFHLD1)="MINIMUM BALANCE #1^MIN balance invalid or out of range either < $0 or > $99,999^"_PFMIN1
"RTN","PRPFDR4",49,0)
 .S CNTERR(34)=CNTERR(34)+1
"RTN","PRPFDR4",50,0)
 .S CNTERR(100)=CNTERR(100)+1
"RTN","PRPFDR4",51,0)
 S PFMAX1=$P(PFNODE2,"^",2)
"RTN","PRPFDR4",52,0)
 I PFMAX1'="" I PFMAX1<0!(PFMAX1>99999)!((PFMAX1'=+PFMAX1)&(PFMAX1'?.N1".".N)) D
"RTN","PRPFDR4",53,0)
 .S ^TMP("PRPF_DIAGX",$J,PFSTAID,35,PFNAME_"_"_PRPFHLD1)="MAXIMUM BALANCE #1^MAX balance invalid or out of range either < $0 or > $99,999^"_PFMAX1
"RTN","PRPFDR4",54,0)
 .S CNTERR(35)=CNTERR(35)+1
"RTN","PRPFDR4",55,0)
 .S CNTERR(100)=CNTERR(100)+1
"RTN","PRPFDR4",56,0)
 Q
"RTN","PRPFDR4",57,0)
NODE6 S PRPFHLD2=0
"RTN","PRPFDR4",58,0)
 S (PFMCTR1,PFMCTR2,PFMCTR3)=1
"RTN","PRPFDR4",59,0)
 S PFMCTR1=1
"RTN","PRPFDR4",60,0)
 F  S PRPFHLD2=$O(^PRPF(470,PRPFHLD1,6,PRPFHLD2)) Q:'PRPFHLD2  D
"RTN","PRPFDR4",61,0)
 .S PFNODE6=^PRPF(470,PRPFHLD1,6,PRPFHLD2,0)
"RTN","PRPFDR4",62,0)
 .S PFINCPYE=$P(PFNODE6,"^",2)
"RTN","PRPFDR4",63,0)
 .I PFINCPYE="" D
"RTN","PRPFDR4",64,0)
 ..S ^TMP("PRPF_DIAGX",$J,PFSTAID,37,PFNAME_"_"_PRPFHLD1_"_"_"Inc#"_PRPFHLD2)="INCOME PAYEE^Income payee blank, Income source present^"_PFINCPYE
"RTN","PRPFDR4",65,0)
 ..S PFMCTR1=PFMCTR1+1
"RTN","PRPFDR4",66,0)
 ..S CNTERR(37)=CNTERR(37)+1
"RTN","PRPFDR4",67,0)
 ..S CNTERR(100)=CNTERR(100)+1
"RTN","PRPFDR4",68,0)
 .S PFINCOME=$P(PFNODE6,"^",3)
"RTN","PRPFDR4",69,0)
 .I +PFINCOME'=PFINCOME&(PFINCOME'?.N1".".N) D
"RTN","PRPFDR4",70,0)
 ..S ^TMP("PRPF_DIAGX",$J,PFSTAID,38,PFNAME_"_"_PRPFHLD1_"_"_"Inc#"_PRPFHLD2)="INCOME AMOUNT^Invalid income amount, Income source present^"_PFINCOME
"RTN","PRPFDR4",71,0)
 ..S PFMCTR2=PFMCTR2+1
"RTN","PRPFDR4",72,0)
 ..S CNTERR(38)=CNTERR(38)+1
"RTN","PRPFDR4",73,0)
 ..S CNTERR(100)=CNTERR(100)+1
"RTN","PRPFDR4",74,0)
 .I +PFINCOME=PFINCOME I PFINCOME<1!(PFINCOME>99999) D
"RTN","PRPFDR4",75,0)
 ..S ^TMP("PRPF_DIAGX",$J,PFSTAID,39,PFNAME_"_"_PRPFHLD1_"_"_"Inc#"_PRPFHLD2)="INCOME AMOUNT^Income amount out of range either < $1 or > $99,999^"_PFINCOME
"RTN","PRPFDR4",76,0)
 ..S CNTERR(39)=CNTERR(39)+1
"RTN","PRPFDR4",77,0)
 ..S CNTERR(100)=CNTERR(100)+1
"RTN","PRPFDR4",78,0)
 .S PFINCFRQ=$P(PFNODE6,"^",4)
"RTN","PRPFDR4",79,0)
 .I PFINCFRQ="" D
"RTN","PRPFDR4",80,0)
 ..S PRPFBC40=PRPFBC40+1
"RTN","PRPFDR4",81,0)
 .I PFINCFRQ'["D"&(PFINCFRQ'["W")&(PFINCFRQ'["M")&(PFINCFRQ'["Y")&(PFINCFRQ'["X")&(PFINCFRQ'["V")&(PFINCFRQ'["O")&(PFINCFRQ'="") D
"RTN","PRPFDR4",82,0)
 ..S ^TMP("PRPF_DIAGX",$J,PFSTAID,40,PFNAME_"_"_PRPFHLD1_"_"_"Inc#"_PRPFHLD2)="INCOME FREQUENCY^Income frequency not D,W,M,Y,X,V,O,Blank^"_PFINCFRQ
"RTN","PRPFDR4",83,0)
 ..S PFMCTR3=PFMCTR3+1
"RTN","PRPFDR4",84,0)
 ..S CNTERR(40)=CNTERR(40)+1
"RTN","PRPFDR4",85,0)
 ..S CNTERR(100)=CNTERR(100)+1
"RTN","PRPFDR4",86,0)
 Q
"RTN","PRPFDR4",87,0)
KILLIT ;VARIABLES KILLED HERE
"RTN","PRPFDR4",88,0)
 K CNTBAL,CNTERR,CNTREC,CNTRPSU,CNTSEG,CNTTOT,ND,PARAMS,PFADDR1,PFADDR2
"RTN","PRPFDR4",89,0)
 K PFADDR3,PFAPPOR,PFARPM,PFARPW,PFAUTH,PFAUTHDT,PFAUTHRS,PFCITY,PFCLAIM,PFDOB
"RTN","PRPFDR4",90,0)
 K PFG,PFGUARD,PFICNFLG,PFINCFRQ,PFINCOME,PFINCPYE,PFINDIG,PFINSAWD,PFMAX1,PFMCTR1
"RTN","PRPFDR4",91,0)
 K PFMCTR2,PFMCTR3,PFMIN1,PFNAME,PFNAMEX,PFNODE0,PFNODE1,PFNODE2,PFNODE4,PFNODE4D
"RTN","PRPFDR4",92,0)
 K PFNODE4X,PFNODE5,PFNODE51,PFNODE52,PFNODE6,PFNODE7,PFNODE8,PFOTRAST,PFPSTAT
"RTN","PRPFDR4",93,0)
 K PFRGNID,PFSITE,PFSSN,PFSTAID,PFSTAT,PFSTATE,PFSTDBAL,PFSTDGRT,PFSTDPVT,PFSUSDT
"RTN","PRPFDR4",94,0)
 K PFSUSID,PFSUSTXT,PFTDT,PFTDTE,PFTEMP,PFTYPE,PFWARD,PFX,PFY,PFZ,PFZIP,POP,PRPFBADD
"RTN","PRPFDR4",95,0)
 K PRPFBBAL,PRPFBDMO,PRPFCNTR,PRPFDEFR,PRPFHLD1,PRPFHLD2,PRPFHLD3,PRPFHLD4,PRPFSEG
"RTN","PRPFDR4",96,0)
 K X,XION
"RTN","PRPFDR4",97,0)
 Q
"RTN","PRPFDR5")
0^5^B63996018
"RTN","PRPFDR5",1,0)
PRPFDR5 ;BAYPINES/MJE  VPFS DATA MIGRATION ROUTINE 5 ;05/15/03
"RTN","PRPFDR5",2,0)
 ;;3.0;PATIENT FUNDS DIAG V5.9;**15**;JUNE 1, 1989
"RTN","PRPFDR5",3,0)
 ;BAD ENTRY POINT
"RTN","PRPFDR5",4,0)
 Q
"RTN","PRPFDR5",5,0)
NODE0 S PFNODE0=^PRPF(470,PRPFHLD1,0)
"RTN","PRPFDR5",6,0)
 S PFNAMEX=""
"RTN","PRPFDR5",7,0)
 S PFNAMEX=PFNAME
"RTN","PRPFDR5",8,0)
 I PFNAME=""!($E(PFNAME,1,12)="NAME-MISSING") D
"RTN","PRPFDR5",9,0)
 .S ^TMP("PRPF_DIAGX",$J,PFSTAID,1,PFNAME_"_"_PRPFHLD1)="NAME^Name is blank^"_PFNAME
"RTN","PRPFDR5",10,0)
 .S CNTERR(1)=CNTERR(1)+1
"RTN","PRPFDR5",11,0)
 .S CNTERR(100)=CNTERR(100)+1
"RTN","PRPFDR5",12,0)
 ELSE  I $$FORMAT^XLFNAME7(PFNAMEX,3,30)'=PFNAMEX D
"RTN","PRPFDR5",13,0)
 .S ^TMP("PRPF_DIAGX",$J,PFSTAID,2,PFNAME_"_"_PRPFHLD1)="NAME^Patient Name contains invalid data^"_PFNAME
"RTN","PRPFDR5",14,0)
 .S CNTERR(2)=CNTERR(2)+1
"RTN","PRPFDR5",15,0)
 .S CNTERR(100)=CNTERR(100)+1
"RTN","PRPFDR5",16,0)
 I PFSSN="" D
"RTN","PRPFDR5",17,0)
 .S ^TMP("PRPF_DIAGX",$J,PFSTAID,3,PFNAME_"_"_PRPFHLD1)="SSN^SSN is blank^"_PFSSN
"RTN","PRPFDR5",18,0)
 .S CNTERR(3)=CNTERR(3)+1
"RTN","PRPFDR5",19,0)
 .S CNTERR(100)=CNTERR(100)+1
"RTN","PRPFDR5",20,0)
 I PFSSN'="" D
"RTN","PRPFDR5",21,0)
 .I $L(PFSSN)<9!($L(PFSSN)>10) D
"RTN","PRPFDR5",22,0)
 ..S ^TMP("PRPF_DIAGX",$J,PFSTAID,4,PFNAME_"_"_PRPFHLD1)="SSN^SSN that is not 9 digits or has non-numeric values^"_PFSSN
"RTN","PRPFDR5",23,0)
 ..S CNTERR(4)=CNTERR(4)+1
"RTN","PRPFDR5",24,0)
 ..S CNTERR(100)=CNTERR(100)+1
"RTN","PRPFDR5",25,0)
 .I $L(PFSSN)=9 D
"RTN","PRPFDR5",26,0)
 ..I '(PFSSN?.9N) D
"RTN","PRPFDR5",27,0)
 ...S ^TMP("PRPF_DIAGX",$J,PFSTAID,4.1,PFNAME_"_"_PRPFHLD1)="SSN^SSN that is not 9 digits or has non-numeric values^"_PFSSN
"RTN","PRPFDR5",28,0)
 ...S CNTERR(4)=CNTERR(4)+1
"RTN","PRPFDR5",29,0)
 ...S CNTERR(100)=CNTERR(100)+1
"RTN","PRPFDR5",30,0)
 .I $L(PFSSN)=10 D
"RTN","PRPFDR5",31,0)
 ..I ($E(PFSSN,1,9)?.9N)&($E(PFSSN,10,10)="P") D
"RTN","PRPFDR5",32,0)
 ...S ^TMP("PRPF_DIAGX",$J,PFSTAID,6,PFNAME_"_"_PRPFHLD1)="SSN^PSEUDO SSN value^"_PFSSN
"RTN","PRPFDR5",33,0)
 ...S CNTRPSU=CNTRPSU+1
"RTN","PRPFDR5",34,0)
 ..I '($E(PFSSN,1,9)?.9N)!($E(PFSSN,10,10)'="P") D
"RTN","PRPFDR5",35,0)
 ...S ^TMP("PRPF_DIAGX",$J,PFSTAID,4.2,PFNAME_"_"_PRPFHLD1)="SSN^SSN that is not 9 digits or has non-numeric values^"_PFSSN
"RTN","PRPFDR5",36,0)
 ...S CNTERR(4)=CNTERR(4)+1
"RTN","PRPFDR5",37,0)
 ...S CNTERR(100)=CNTERR(100)+1
"RTN","PRPFDR5",38,0)
 I PFSSN'="" D
"RTN","PRPFDR5",39,0)
 .I $D(^TMP("PRPF_DIAGX",$J,"PFSSN",PFSSN)) D
"RTN","PRPFDR5",40,0)
 ..S ^TMP("PRPF_DIAGX",$J,PFSTAID,5,PFNAME_"_"_PRPFHLD1)="SSN^SSN duplicate value^"_PFSSN
"RTN","PRPFDR5",41,0)
 ..S CNTERR(5)=CNTERR(5)+1
"RTN","PRPFDR5",42,0)
 ..S CNTERR(100)=CNTERR(100)+1
"RTN","PRPFDR5",43,0)
 .S ^TMP("PRPF_DIAGX",$J,"PFSSN",PFSSN)=PFSSN
"RTN","PRPFDR5",44,0)
 I PFDOB="" D
"RTN","PRPFDR5",45,0)
 .S ^TMP("PRPF_DIAGX",$J,PFSTAID,7,PFNAME_"_"_PRPFHLD1)="DOB^DOB blank^"_PFDOB
"RTN","PRPFDR5",46,0)
 .S CNTERR(7)=CNTERR(7)+1
"RTN","PRPFDR5",47,0)
 .S CNTERR(100)=CNTERR(100)+1
"RTN","PRPFDR5",48,0)
 ELSE  D
"RTN","PRPFDR5",49,0)
 .K PRPFBADD
"RTN","PRPFDR5",50,0)
 .D DT^DILF("X",PFDOB,.PRPFBADD)
"RTN","PRPFDR5",51,0)
 .I $L(+PFDOB)'=7!(PRPFBADD=-1) D
"RTN","PRPFDR5",52,0)
 ..S ^TMP("PRPF_DIAGX",$J,PFSTAID,8,PFNAME_"_"_PRPFHLD1)="DOB^DOB contains invalid date^"_PFDOB
"RTN","PRPFDR5",53,0)
 ..S CNTERR(8)=CNTERR(8)+1
"RTN","PRPFDR5",54,0)
 ..S CNTERR(100)=CNTERR(100)+1
"RTN","PRPFDR5",55,0)
 I PFWARD'="" I $L(PFWARD)>30!($L(PFWARD)<2) D
"RTN","PRPFDR5",56,0)
 .S ^TMP("PRPF_DIAGX",$J,PFSTAID,9,PFNAME_"_"_PRPFHLD1)="WARD^Ward loc invalid length not 2 TO 30^"_PFWARD
"RTN","PRPFDR5",57,0)
 .S CNTERR(9)=CNTERR(9)+1
"RTN","PRPFDR5",58,0)
 .S CNTERR(100)=CNTERR(100)+1
"RTN","PRPFDR5",59,0)
 I PFCLAIM=""!(PFCLAIM="SS") D
"RTN","PRPFDR5",60,0)
 .;S ^TMP("PRPF_DIAGX",$J,PFSTAID,8,PFNAME_"_"_PRPFHLD1)="CLAIM#^Claim # blank^"_PFCLAIM
"RTN","PRPFDR5",61,0)
 .;S CNTERR(8)=CNTERR(8)+1
"RTN","PRPFDR5",62,0)
 .;S CNTERR(100)=CNTERR(100)+1
"RTN","PRPFDR5",63,0)
 ELSE  I $L(PFCLAIM)<7!($L(PFCLAIM)>9)!'(PFCLAIM?.N) D
"RTN","PRPFDR5",64,0)
 .S ^TMP("PRPF_DIAGX",$J,PFSTAID,10,PFNAME_"_"_PRPFHLD1)="CLAIM#^Claim # < 7 or > 9 digits or non-numeric^"_PFCLAIM
"RTN","PRPFDR5",65,0)
 .S CNTERR(10)=CNTERR(10)+1
"RTN","PRPFDR5",66,0)
 .S CNTERR(100)=CNTERR(100)+1
"RTN","PRPFDR5",67,0)
 I PFSTATE="" D
"RTN","PRPFDR5",68,0)
 .;S ^TMP("PRPF_DIAGX",$J,PFSTAID,10,PFNAME_"_"_PRPFHLD1)="STATE^STATE field is blank^"_PFSTATE
"RTN","PRPFDR5",69,0)
 .;S CNTERR(10)=CNTERR(10)+1
"RTN","PRPFDR5",70,0)
 .;S CNTERR(100)=CNTERR(100)+1
"RTN","PRPFDR5",71,0)
 I PFZIP="" D
"RTN","PRPFDR5",72,0)
 .;S ^TMP("PRPF_DIAGX",$J,PFSTAID,11,PFNAME_"_"_PRPFHLD1)="ZIPCODE#^ZIPCODE blank^"_PFZIP
"RTN","PRPFDR5",73,0)
 .;S CNTERR(11)=CNTERR(11)+1
"RTN","PRPFDR5",74,0)
 .;S CNTERR(100)=CNTERR(100)+1
"RTN","PRPFDR5",75,0)
 ELSE  I $L(PFZIP)>5!($L(PFZIP)<5)!'(PFZIP?5N) D
"RTN","PRPFDR5",76,0)
 .S ^TMP("PRPF_DIAGX",$J,PFSTAID,11,PFNAME_"_"_PRPFHLD1)="ZIPCODE#^ZIPCODE < or > 5 digits or non-numeric^"_PFZIP
"RTN","PRPFDR5",77,0)
 .S CNTERR(11)=CNTERR(11)+1
"RTN","PRPFDR5",78,0)
 .S CNTERR(100)=CNTERR(100)+1
"RTN","PRPFDR5",79,0)
 S PFRGNID=""
"RTN","PRPFDR5",80,0)
 S PFICNFLG=$$GETICN^MPIF001(PRPFHLD1)
"RTN","PRPFDR5",81,0)
 I +PFICNFLG'=-1 D
"RTN","PRPFDR5",82,0)
 .I $D(^TMP("PRPF_DIAGX",$J,"PFICN",+PFICNFLG)) D
"RTN","PRPFDR5",83,0)
 ..S ^TMP("PRPF_DIAGX",$J,PFSTAID,13,PFNAME_"_"_PRPFHLD1)="ICN^ICN Duplicate^"_PFICNFLG
"RTN","PRPFDR5",84,0)
 ..S CNTERR(13)=CNTERR(13)+1
"RTN","PRPFDR5",85,0)
 ..S CNTERR(100)=CNTERR(100)+1
"RTN","PRPFDR5",86,0)
 .S ^TMP("PRPF_DIAGX",$J,"PFICN",+PFICNFLG)=PFICNFLG
"RTN","PRPFDR5",87,0)
 I +PFICNFLG=-1 D
"RTN","PRPFDR5",88,0)
 .S ^TMP("PRPF_DIAGX",$J,PFSTAID,14,PFNAME_"_"_PRPFHLD1)="ICN^ICN Unassigned or invalid^"_$P(PFICNFLG,"^",2)
"RTN","PRPFDR5",89,0)
 .S CNTERR(14)=CNTERR(14)+1
"RTN","PRPFDR5",90,0)
 .S CNTERR(100)=CNTERR(100)+1
"RTN","PRPFDR5",91,0)
 .;S PRPFBJOB=$$MPIQQ^MPIFAPI(PRPFHLD1)
"RTN","PRPFDR5",92,0)
 S (PFAUTHRS,PFNAMEX)=""
"RTN","PRPFDR5",93,0)
 I PFAUTH'="" D
"RTN","PRPFDR5",94,0)
 .S (PFAUTHRS,PFNAMEX)=$P($G(^VA(200,PFAUTH,0)),"^",1)
"RTN","PRPFDR5",95,0)
 .I $$FORMAT^XLFNAME7(PFNAMEX,3,30)'=PFNAMEX!('$D(^VA(200,PFAUTH,0))) D
"RTN","PRPFDR5",96,0)
 ..S ^TMP("PRPF_DIAGX",$J,PFSTAID,15,PFNAME_"_"_PRPFHLD1)="PFAUTHRS^Provider name contains invalid data^"_PFAUTHRS
"RTN","PRPFDR5",97,0)
 ..S CNTERR(15)=CNTERR(15)+1
"RTN","PRPFDR5",98,0)
 ..S CNTERR(100)=CNTERR(100)+1
"RTN","PRPFDR5",99,0)
 S PFAUTHDT=$P(^PRPF(470,PRPFHLD1,0),"^",12)
"RTN","PRPFDR5",100,0)
 I PFAUTHDT'="" D
"RTN","PRPFDR5",101,0)
 .K PRPFBADD
"RTN","PRPFDR5",102,0)
 .D DT^DILF("X",PFAUTHDT,.PRPFBADD)
"RTN","PRPFDR5",103,0)
 .I $L(+PFAUTHDT)'=7!(PRPFBADD=-1) D
"RTN","PRPFDR5",104,0)
 ..S ^TMP("PRPF_DIAGX",$J,PFSTAID,16,PFNAME_"_"_PRPFHLD1)="PROVAUTHDT^Date of current restriction contains invalid date^"_PFAUTHDT
"RTN","PRPFDR5",105,0)
 ..S CNTERR(16)=CNTERR(16)+1
"RTN","PRPFDR5",106,0)
 ..S CNTERR(100)=CNTERR(100)+1
"RTN","PRPFDR5",107,0)
 S PFSTAT=$P(PFNODE0,"^",2)
"RTN","PRPFDR5",108,0)
 I PFSTAT="" D
"RTN","PRPFDR5",109,0)
 .S PRPFBC18=PRPFBC18+1
"RTN","PRPFDR5",110,0)
 I PFSTAT'["A"&(PFSTAT'["I")&(PFSTAT'="") D
"RTN","PRPFDR5",111,0)
 .S ^TMP("PRPF_DIAGX",$J,PFSTAID,18,PFNAME_"_"_PRPFHLD1)="ACCOUNT STATUS^Account status containing values other than A or I^"_PFSTAT
"RTN","PRPFDR5",112,0)
 .S CNTERR(18)=CNTERR(18)+1
"RTN","PRPFDR5",113,0)
 .S CNTERR(100)=CNTERR(100)+1
"RTN","PRPFDR5",114,0)
 S PFTYPE=$P(PFNODE0,"^",3)
"RTN","PRPFDR5",115,0)
 I PFTYPE="" D
"RTN","PRPFDR5",116,0)
 .S PRPFBC19=PRPFBC19+1
"RTN","PRPFDR5",117,0)
 I PFTYPE'["L"&(PFTYPE'["R")&(PFTYPE'["U")&(PFTYPE'["X")&(PFTYPE'="") D
"RTN","PRPFDR5",118,0)
 .S ^TMP("PRPF_DIAGX",$J,PFSTAID,19,PFNAME_"_"_PRPFHLD1)="PATIENT TYPE^Patient type values other than L, R, U, X^"_PFTYPE
"RTN","PRPFDR5",119,0)
 .S CNTERR(19)=CNTERR(19)+1
"RTN","PRPFDR5",120,0)
 .S CNTERR(100)=CNTERR(100)+1
"RTN","PRPFDR5",121,0)
 I (PFAUTH=""&(PFTYPE="L"))!(PFAUTH=""&(PFTYPE="R")) D
"RTN","PRPFDR5",122,0)
 .S ^TMP("PRPF_DIAGX",$J,PFSTAID,20,PFNAME_"_"_PRPFHLD1)="PATIENT TYPE/PHY^No Physician name for L or R^"_PFTYPE
"RTN","PRPFDR5",123,0)
 .S CNTERR(20)=CNTERR(20)+1
"RTN","PRPFDR5",124,0)
 .S CNTERR(100)=CNTERR(100)+1
"RTN","PRPFDR5",125,0)
 S PFPSTAT=$P(PFNODE0,"^",4)
"RTN","PRPFDR5",126,0)
 I PFPSTAT="" D
"RTN","PRPFDR5",127,0)
 .S PRPFBC21=PRPFBC21+1
"RTN","PRPFDR5",128,0)
 I PFPSTAT'["A"&(PFPSTAT'["R")&(PFPSTAT'["C")&(PFPSTAT'["N")&(PFPSTAT'["X")&(PFPSTAT'="") D
"RTN","PRPFDR5",129,0)
 .S ^TMP("PRPF_DIAGX",$J,PFSTAID,21,PFNAME_"_"_PRPFHLD1)="PATIENT STATUS^Patient status values other than A, R, C, N, X^"_PFPSTAT
"RTN","PRPFDR5",130,0)
 .S CNTERR(21)=CNTERR(21)+1
"RTN","PRPFDR5",131,0)
 .S CNTERR(100)=CNTERR(100)+1
"RTN","PRPFDR5",132,0)
 S PFINDIG=$P(PFNODE0,"^",5)
"RTN","PRPFDR5",133,0)
 I PFINDIG="" D
"RTN","PRPFDR5",134,0)
 .S PRPFBC22=PRPFBC22+1
"RTN","PRPFDR5",135,0)
 I PFINDIG'["Y"&(PFINDIG'["N")&(PFINDIG'="") D
"RTN","PRPFDR5",136,0)
 .S ^TMP("PRPF_DIAGX",$J,PFSTAID,22,PFNAME_"_"_PRPFHLD1)="INDIGENT^Indigent indicator values other than Y, N^"_PFINDIG
"RTN","PRPFDR5",137,0)
 .S CNTERR(22)=CNTERR(22)+1
"RTN","PRPFDR5",138,0)
 .S CNTERR(100)=CNTERR(100)+1
"RTN","PRPFDR5",139,0)
 S PFAPPOR=$P(PFNODE0,"^",6)
"RTN","PRPFDR5",140,0)
 I PFAPPOR'="" I PFAPPOR<0!(PFAPPOR>99999)!((PFAPPOR'=+PFAPPOR)&(PFAPPOR'?.N1".".N)) D
"RTN","PRPFDR5",141,0)
 .S ^TMP("PRPF_DIAGX",$J,PFSTAID,23,PFNAME_"_"_PRPFHLD1)="APPORTIONEE $^Apportionee amount invalid or out of range either < 0 or > $99,999.00^"_PFAPPOR
"RTN","PRPFDR5",142,0)
 .S CNTERR(23)=CNTERR(23)+1
"RTN","PRPFDR5",143,0)
 .S CNTERR(100)=CNTERR(100)+1
"RTN","PRPFDR5",144,0)
 S PFGUARD=$P(PFNODE0,"^",7)
"RTN","PRPFDR5",145,0)
 I PFGUARD'="" I PFGUARD<0!(PFGUARD>99999)!((PFGUARD'=+PFGUARD)&(PFGUARD'?.N1".".N)) D
"RTN","PRPFDR5",146,0)
 .S ^TMP("PRPF_DIAGX",$J,PFSTAID,24,PFNAME_"_"_PRPFHLD1)="GUARDIAN $^Guardian amount invalid or out of range either < 0 or > $99,999.00^"_PFGUARD
"RTN","PRPFDR5",147,0)
 .S CNTERR(24)=CNTERR(24)+1
"RTN","PRPFDR5",148,0)
 .S CNTERR(100)=CNTERR(100)+1
"RTN","PRPFDR5",149,0)
 S PFINSAWD=$P(PFNODE0,"^",8)
"RTN","PRPFDR5",150,0)
 I PFINSAWD'="" I PFINSAWD<0!(PFINSAWD>99999)!((PFINSAWD'=+PFINSAWD)&(PFINSAWD'?.N1".".N)) D
"RTN","PRPFDR5",151,0)
 .S ^TMP("PRPF_DIAGX",$J,PFSTAID,25,PFNAME_"_"_PRPFHLD1)="INSTITUTIONAL AWARD^Institutional award invalid or out of range either < 0 or > $99,999.00^"_PFINSAWD
"RTN","PRPFDR5",152,0)
 .S CNTERR(25)=CNTERR(25)+1
"RTN","PRPFDR5",153,0)
 .S CNTERR(100)=CNTERR(100)+1
"RTN","PRPFDR5",154,0)
 S PFOTRAST=$P(PFNODE0,"^",10)
"RTN","PRPFDR5",155,0)
 I PFOTRAST'="" I PFOTRAST<0!(PFOTRAST>99999)!((PFOTRAST'=+PFOTRAST)&(PFOTRAST'?.N1".".N)) D
"RTN","PRPFDR5",156,0)
 .S ^TMP("PRPF_DIAGX",$J,PFSTAID,26,PFNAME_"_"_PRPFHLD1)="OTHER ASSETS^Other assets invalid or out of range either < 0 or > $99,999.00^"_PFOTRAST
"RTN","PRPFDR5",157,0)
 .S CNTERR(26)=CNTERR(26)+1
"RTN","PRPFDR5",158,0)
 .S CNTERR(100)=CNTERR(100)+1
"RTN","PRPFDR5",159,0)
 Q
"RTN","PRPFDR5",160,0)
NODE0X S ^TMP("PRPF_DIAGX",$J,PFSTAID,17,PFNAME_"_"_PRPFHLD1)="NO DEMO RECORD^No demographic record for account^"_PFNAME
"RTN","PRPFDR5",161,0)
 S CNTERR(17)=CNTERR(17)+1
"RTN","PRPFDR5",162,0)
 S CNTERR(100)=CNTERR(100)+1
"RTN","PRPFDR5",163,0)
 Q
"RTN","PRPFDR6")
0^6^B32913557
"RTN","PRPFDR6",1,0)
PRPFDR6 ;BAYPINES/MJE  VPFS DATA MIGRATION ROUTINE 6 ;05/15/03
"RTN","PRPFDR6",2,0)
 ;;3.0;PATIENT FUNDS DIAG V5.9;**15**;JUNE 1, 1989
"RTN","PRPFDR6",3,0)
 ;ENTRY AT LINETAG ONLY
"RTN","PRPFDR6",4,0)
 Q
"RTN","PRPFDR6",5,0)
XSUM1 ;THIS ENTRY POINT FOR SUMMARY INFO
"RTN","PRPFDR6",6,0)
 S PRPFCNTR=PRPFCNTR+1 S ^TMP("PRPF_DIAGVL",$J,CNTSEG,PRPFCNTR)="*#33    RESTRCT AMT ER  Restrict Mnthly amount < weekly amt             "_CNTERR(33)
"RTN","PRPFDR6",7,0)
 D SEG^PRPFDR3
"RTN","PRPFDR6",8,0)
 S PRPFCNTR=PRPFCNTR+1 S ^TMP("PRPF_DIAGVL",$J,CNTSEG,PRPFCNTR)="*#34    MINIMUM BAL     Minimum balance #1 invalid or < $0 or > $99,999 "_CNTERR(34)
"RTN","PRPFDR6",9,0)
 D SEG^PRPFDR3
"RTN","PRPFDR6",10,0)
 S PRPFCNTR=PRPFCNTR+1 S ^TMP("PRPF_DIAGVL",$J,CNTSEG,PRPFCNTR)="*#35    MAXIMUM BAL     Maximum balance #1 invalid or < $0 or > $99,999 "_CNTERR(35)
"RTN","PRPFDR6",11,0)
 D SEG^PRPFDR3
"RTN","PRPFDR6",12,0)
 S PRPFCNTR=PRPFCNTR+1 S ^TMP("PRPF_DIAGVL",$J,CNTSEG,PRPFCNTR)="*#36    NO BALANCE REC  Balance record missing for account              "_CNTERR(36)
"RTN","PRPFDR6",13,0)
 D SEG^PRPFDR3
"RTN","PRPFDR6",14,0)
 S PRPFCNTR=PRPFCNTR+1 S ^TMP("PRPF_DIAGVL",$J,CNTSEG,PRPFCNTR)="*#37    INCOME PAYEE    Income payee blank, Income source present       "_CNTERR(37)
"RTN","PRPFDR6",15,0)
 D SEG^PRPFDR3
"RTN","PRPFDR6",16,0)
 S PRPFCNTR=PRPFCNTR+1 S ^TMP("PRPF_DIAGVL",$J,CNTSEG,PRPFCNTR)="*#38    INCOME AMOUNT   Income amount error, Income source present      "_CNTERR(38)
"RTN","PRPFDR6",17,0)
 D SEG^PRPFDR3
"RTN","PRPFDR6",18,0)
 S PRPFCNTR=PRPFCNTR+1 S ^TMP("PRPF_DIAGVL",$J,CNTSEG,PRPFCNTR)="*#39    INCOME AMOUNT   Income amount < $1 or > $99,999                 "_CNTERR(39)
"RTN","PRPFDR6",19,0)
 D SEG^PRPFDR3
"RTN","PRPFDR6",20,0)
 S PRPFCNTR=PRPFCNTR+1 S ^TMP("PRPF_DIAGVL",$J,CNTSEG,PRPFCNTR)="*#40    INCOME FREQCY   Income frequency not D,W,M,Y,X,V,O,Blank="_PRPFBC40_$P("      "," ",1,6-$L(PRPFBC40))_"  "_CNTERR(40)
"RTN","PRPFDR6",21,0)
 D SEG^PRPFDR3
"RTN","PRPFDR6",22,0)
 S PRPFCNTR=PRPFCNTR+1 S ^TMP("PRPF_DIAGVL",$J,CNTSEG,PRPFCNTR)="*#41    STATION ID      Station ID blank or unassigned                  "_CNTERR(41)
"RTN","PRPFDR6",23,0)
 D SEG^PRPFDR3
"RTN","PRPFDR6",24,0)
 S PRPFCNTR=PRPFCNTR+1 S ^TMP("PRPF_DIAGVL",$J,CNTSEG,PRPFCNTR)=" #42    STATION ID      Station ID invalid                              "_CNTERR(42)
"RTN","PRPFDR6",25,0)
 D SEG^PRPFDR3
"RTN","PRPFDR6",26,0)
 S PRPFCNTR=PRPFCNTR+1 S ^TMP("PRPF_DIAGVL",$J,CNTSEG,PRPFCNTR)="*#43    SUSPENSE DATE   Suspense date has invalid date                  "_CNTERR(43)
"RTN","PRPFDR6",27,0)
 D SEG^PRPFDR3
"RTN","PRPFDR6",28,0)
 S PRPFCNTR=PRPFCNTR+1 S ^TMP("PRPF_DIAGVL",$J,CNTSEG,PRPFCNTR)="*#44    SUSPENSE ID     Suspense ID has Invalid data                    "_CNTERR(44)
"RTN","PRPFDR6",29,0)
 D SEG^PRPFDR3
"RTN","PRPFDR6",30,0)
 S PRPFCNTR=PRPFCNTR+1 S ^TMP("PRPF_DIAGVL",$J,CNTSEG,PRPFCNTR)="*#45    SUSPENSE TEXT   Suspense text is < 1 or > 255 characters        "_CNTERR(45)
"RTN","PRPFDR6",31,0)
 D SEG^PRPFDR3
"RTN","PRPFDR6",32,0)
 S PRPFCNTR=PRPFCNTR+1 S ^TMP("PRPF_DIAGVL",$J,CNTSEG,PRPFCNTR)="*#46    DEFERRED TRANS  There are "_PRPFDEFR_" deferred transactions               "_PRPFDEFR
"RTN","PRPFDR6",33,0)
 D SEG^PRPFDR3
"RTN","PRPFDR6",34,0)
 S PRPFCNTR=PRPFCNTR+1 S ^TMP("PRPF_DIAGVL",$J,CNTSEG,PRPFCNTR)="*#47    TRANSACTION REC Transaction record missing, blank or ID invalid "_CNTERR(47)
"RTN","PRPFDR6",35,0)
 D SEG^PRPFDR3
"RTN","PRPFDR6",36,0)
 S PRPFCNTR=PRPFCNTR+1 S ^TMP("PRPF_DIAGVL",$J,CNTSEG,PRPFCNTR)="*#48    PATIENT NAME    Patient name does not match deferred trans      "_CNTERR(48)
"RTN","PRPFDR6",37,0)
 D SEG^PRPFDR3
"RTN","PRPFDR6",38,0)
 S PRPFCNTR=PRPFCNTR+1 S ^TMP("PRPF_DIAGVL",$J,CNTSEG,PRPFCNTR)="*#49    PATIENT TRANS # Patient transaction # invalid                   "_CNTERR(49)
"RTN","PRPFDR6",39,0)
 D SEG^PRPFDR3
"RTN","PRPFDR6",40,0)
 S PRPFCNTR=PRPFCNTR+1 S ^TMP("PRPF_DIAGVL",$J,CNTSEG,PRPFCNTR)="*#50    DEFR AMOUNT     Deferred amount invalid                         "_CNTERR(50)
"RTN","PRPFDR6",41,0)
 D SEG^PRPFDR3
"RTN","PRPFDR6",42,0)
 S PRPFCNTR=PRPFCNTR+1 S ^TMP("PRPF_DIAGVL",$J,CNTSEG,PRPFCNTR)="*#51    TRANSACTN DATE  Transaction date Invalid                        "_CNTERR(51)
"RTN","PRPFDR6",43,0)
 D SEG^PRPFDR3
"RTN","PRPFDR6",44,0)
 S PRPFCNTR=PRPFCNTR+1 S ^TMP("PRPF_DIAGVL",$J,CNTSEG,PRPFCNTR)="*#52    DT TRAN ENTD    Date transaction entered Invalid                "_CNTERR(52)
"RTN","PRPFDR6",45,0)
 D SEG^PRPFDR3
"RTN","PRPFDR6",46,0)
 S PRPFCNTR=PRPFCNTR+1 S ^TMP("PRPF_DIAGVL",$J,CNTSEG,PRPFCNTR)="*#53    REFERENCE       Reference Invalid < 1 or > 10 in length         "_CNTERR(53)
"RTN","PRPFDR6",47,0)
 D SEG^PRPFDR3
"RTN","PRPFDR6",48,0)
 S PRPFCNTR=PRPFCNTR+1 S ^TMP("PRPF_DIAGVL",$J,CNTSEG,PRPFCNTR)="*#54    DEPOSIT/WTHDRWL Deposit/Withdrawal status Invalid               "_CNTERR(54)
"RTN","PRPFDR6",49,0)
 D SEG^PRPFDR3
"RTN","PRPFDR6",50,0)
 S PRPFCNTR=PRPFCNTR+1 S ^TMP("PRPF_DIAGVL",$J,CNTSEG,PRPFCNTR)="*#55    CASH/CHECK/OTR  Cash/Check/Other status Invalid                 "_CNTERR(55)
"RTN","PRPFDR6",51,0)
 D SEG^PRPFDR3
"RTN","PRPFDR6",52,0)
 S PRPFCNTR=PRPFCNTR+1 S ^TMP("PRPF_DIAGVL",$J,CNTSEG,PRPFCNTR)="*#56    SOURCE          Transaction source invalid                      "_CNTERR(56)
"RTN","PRPFDR6",53,0)
 D SEG^PRPFDR3
"RTN","PRPFDR6",54,0)
 S PRPFCNTR=PRPFCNTR+1 S ^TMP("PRPF_DIAGVL",$J,CNTSEG,PRPFCNTR)="*#57    FORM            Form does not match                             "_CNTERR(57)
"RTN","PRPFDR6",55,0)
 D SEG^PRPFDR3
"RTN","PRPFDR6",56,0)
 S PRPFCNTR=PRPFCNTR+1 S ^TMP("PRPF_DIAGVL",$J,CNTSEG,PRPFCNTR)="*#58    PRVT SOURCE AMT Private source amount invalid or < 0 or > 99999 "_CNTERR(58)
"RTN","PRPFDR6",57,0)
 D SEG^PRPFDR3
"RTN","PRPFDR6",58,0)
 S PRPFCNTR=PRPFCNTR+1 S ^TMP("PRPF_DIAGVL",$J,CNTSEG,PRPFCNTR)="*#59    GRATUITOUS AMT  Gratuitous amount invalid or < 0 or > 99999     "_CNTERR(59)
"RTN","PRPFDR6",59,0)
 D SEG^PRPFDR3
"RTN","PRPFDR6",60,0)
 S PRPFCNTR=PRPFCNTR+1 S ^TMP("PRPF_DIAGVL",$J,CNTSEG,PRPFCNTR)="*#60    PFUNDS CLERK    PFunds clerk invalid                            "_CNTERR(60)
"RTN","PRPFDR6",61,0)
 D SEG^PRPFDR3
"RTN","PRPFDR6",62,0)
 S PRPFCNTR=PRPFCNTR+1 S ^TMP("PRPF_DIAGVL",$J,CNTSEG,PRPFCNTR)="**************************************************************************#DETAIL#"
"RTN","PRPFDR6",63,0)
 D SEG^PRPFDR3
"RTN","PRPFDR6",64,0)
 Q
"VER")
8.0^22.0
"BLD",4744,6)
^17
**END**
**END**
