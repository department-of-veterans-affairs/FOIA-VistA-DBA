Released PRC*5.1*66 SEQ #59
Extracted from mail message
**KIDS**:PRC*5.1*66^

**INSTALL NAME**
PRC*5.1*66
"BLD",2913,0)
PRC*5.1*66^IFCAP^0^3030915^y
"BLD",2913,1,0)
^^11^11^3030529^^^^
"BLD",2913,1,1,0)
This patch is in support of the site preparation steps for CoreFLS
"BLD",2913,1,2,0)
deployment. It should be installed as a normal patch. A new option will
"BLD",2913,1,3,0)
be installed under the CoreFLS Data Cleansing menu [PRCL COREFLS DATA
"BLD",2913,1,4,0)
CLEANSING] with the same security key as the other options. Instructions
"BLD",2913,1,5,0)
for the use of this option will be included in an official CoreFLS Action
"BLD",2913,1,6,0)
Request.
"BLD",2913,1,7,0)
 
"BLD",2913,1,8,0)
This option contains various reports that show in summary or detail
"BLD",2913,1,9,0)
format the data fields for records in the PROCUREMENT & ACCOUNTING
"BLD",2913,1,10,0)
TRANSACTIONS file (#442) that do not conform to the established CoreFLS
"BLD",2913,1,11,0)
data cleansing guidelines.
"BLD",2913,4,0)
^9.64PA^^
"BLD",2913,"KRN",0)
^9.67PA^19^17
"BLD",2913,"KRN",.4,0)
.4
"BLD",2913,"KRN",.401,0)
.401
"BLD",2913,"KRN",.402,0)
.402
"BLD",2913,"KRN",.403,0)
.403
"BLD",2913,"KRN",.5,0)
.5
"BLD",2913,"KRN",.84,0)
.84
"BLD",2913,"KRN",3.6,0)
3.6
"BLD",2913,"KRN",3.8,0)
3.8
"BLD",2913,"KRN",9.2,0)
9.2
"BLD",2913,"KRN",9.8,0)
9.8
"BLD",2913,"KRN",9.8,"NM",0)
^9.68A^4^4
"BLD",2913,"KRN",9.8,"NM",1,0)
PRCLC1^^0^B49470240
"BLD",2913,"KRN",9.8,"NM",2,0)
PRCLC2^^0^B24008539
"BLD",2913,"KRN",9.8,"NM",3,0)
PRCLC3^^0^B13497615
"BLD",2913,"KRN",9.8,"NM",4,0)
PRCLC4^^0^B16533455
"BLD",2913,"KRN",9.8,"NM","B","PRCLC1",1)

"BLD",2913,"KRN",9.8,"NM","B","PRCLC2",2)

"BLD",2913,"KRN",9.8,"NM","B","PRCLC3",3)

"BLD",2913,"KRN",9.8,"NM","B","PRCLC4",4)

"BLD",2913,"KRN",19,0)
19
"BLD",2913,"KRN",19,"NM",0)
^9.68A^6^6
"BLD",2913,"KRN",19,"NM",1,0)
PRCL PURCHASE ORDER^^0
"BLD",2913,"KRN",19,"NM",2,0)
PRCL COREFLS DATA CLEANSING^^2
"BLD",2913,"KRN",19,"NM",3,0)
PRCL PURCHASE ORDER COMPILE^^0
"BLD",2913,"KRN",19,"NM",4,0)
PRCL PURCHASE ORDER RPT - DET^^0
"BLD",2913,"KRN",19,"NM",5,0)
PRCL PURCHASE ORDER RPT - SUM^^0
"BLD",2913,"KRN",19,"NM",6,0)
PRCL MISSING PO NUMBER RPT^^0
"BLD",2913,"KRN",19,"NM","B","PRCL COREFLS DATA CLEANSING",2)

"BLD",2913,"KRN",19,"NM","B","PRCL MISSING PO NUMBER RPT",6)

"BLD",2913,"KRN",19,"NM","B","PRCL PURCHASE ORDER",1)

"BLD",2913,"KRN",19,"NM","B","PRCL PURCHASE ORDER COMPILE",3)

"BLD",2913,"KRN",19,"NM","B","PRCL PURCHASE ORDER RPT - DET",4)

"BLD",2913,"KRN",19,"NM","B","PRCL PURCHASE ORDER RPT - SUM",5)

"BLD",2913,"KRN",19.1,0)
19.1
"BLD",2913,"KRN",101,0)
101
"BLD",2913,"KRN",409.61,0)
409.61
"BLD",2913,"KRN",771,0)
771
"BLD",2913,"KRN",870,0)
870
"BLD",2913,"KRN",8994,0)
8994
"BLD",2913,"KRN","B",.4,.4)

"BLD",2913,"KRN","B",.401,.401)

"BLD",2913,"KRN","B",.402,.402)

"BLD",2913,"KRN","B",.403,.403)

"BLD",2913,"KRN","B",.5,.5)

"BLD",2913,"KRN","B",.84,.84)

"BLD",2913,"KRN","B",3.6,3.6)

"BLD",2913,"KRN","B",3.8,3.8)

"BLD",2913,"KRN","B",9.2,9.2)

"BLD",2913,"KRN","B",9.8,9.8)

"BLD",2913,"KRN","B",19,19)

"BLD",2913,"KRN","B",19.1,19.1)

"BLD",2913,"KRN","B",101,101)

"BLD",2913,"KRN","B",409.61,409.61)

"BLD",2913,"KRN","B",771,771)

"BLD",2913,"KRN","B",870,870)

"BLD",2913,"KRN","B",8994,8994)

"BLD",2913,"QUES",0)
^9.62^^
"KRN",19,10901,-1)
2^2
"KRN",19,10901,0)
PRCL COREFLS DATA CLEANSING^CoreFLS Data Cleansing Menu^^M^100917^PRCL DATA CLEANSING^^^^^^455
"KRN",19,10901,10,0)
^19.01IP^4^4
"KRN",19,10901,10,3,0)
10915^^
"KRN",19,10901,10,3,"^")
PRCL PURCHASE ORDER
"KRN",19,10901,"U")
COREFLS DATA CLEANSING MENU
"KRN",19,10915,-1)
0^1
"KRN",19,10915,0)
PRCL PURCHASE ORDER^Purchase Order Data Cleansing Reports^^M^^PRCL DATA CLEANSING^^^^^^IFCAP
"KRN",19,10915,1,0)
^19.06^9^9^3030723^^^^
"KRN",19,10915,1,1,0)
This menu contains a set of options related to purchase orders and other
"KRN",19,10915,1,2,0)
transactions in the PROCUREMENT & ACCOUNTING TRANSACTIONS (#442) file for
"KRN",19,10915,1,3,0)
CoreFLS data conversion. The option Compile List of Purchase Orders must be
"KRN",19,10915,1,4,0)
run prior to any other report.
"KRN",19,10915,1,5,0)
 
"KRN",19,10915,1,6,0)
The Compile List of Purchase Orders provides a list of purchase orders to
"KRN",19,10915,1,7,0)
be converted into the CoreFLS system. Reports highlighting data problems
"KRN",19,10915,1,8,0)
that may prevent the successful conversion of these items are also
"KRN",19,10915,1,9,0)
available.
"KRN",19,10915,10,0)
^19.01IP^4^4
"KRN",19,10915,10,1,0)
11191^1^1
"KRN",19,10915,10,1,"^")
PRCL PURCHASE ORDER COMPILE
"KRN",19,10915,10,2,0)
11192^2^2
"KRN",19,10915,10,2,"^")
PRCL PURCHASE ORDER RPT - SUM
"KRN",19,10915,10,3,0)
11193^3^3
"KRN",19,10915,10,3,"^")
PRCL PURCHASE ORDER RPT - DET
"KRN",19,10915,10,4,0)
11194^4^4
"KRN",19,10915,10,4,"^")
PRCL MISSING PO NUMBER RPT
"KRN",19,10915,99)
59343,54328
"KRN",19,10915,"U")
PURCHASE ORDER DATA CLEANSING 
"KRN",19,11191,-1)
0^3
"KRN",19,11191,0)
PRCL PURCHASE ORDER COMPILE^Compile List of Purchase Orders^^R^^PRCL DATA CLEANSING^^^^^^IFCAP^^1
"KRN",19,11191,1,0)
^19.06^6^6^3030722^^^
"KRN",19,11191,1,1,0)
This option examines the PROCUREMENT & ACCOUNTING TRANSACTIONS (#442) file
"KRN",19,11191,1,2,0)
and compiles the list of entries that must be checked for problems before
"KRN",19,11191,1,3,0)
the data is converted into the CoreFLS system.
"KRN",19,11191,1,4,0)
 
"KRN",19,11191,1,5,0)
This option must be invoked prior to running any of the associated CoreFLS
"KRN",19,11191,1,6,0)
Purchase Order Data Cleansing reports.
"KRN",19,11191,20)
S BODY=""
"KRN",19,11191,25)
TOP^PRCLC1
"KRN",19,11191,"U")
COMPILE LIST OF PURCHASE ORDER
"KRN",19,11192,-1)
0^5
"KRN",19,11192,0)
PRCL PURCHASE ORDER RPT - SUM^Summary Purchase Order Report^^R^^PRCL DATA CLEANSING^^^^^^IFCAP^^1
"KRN",19,11192,1,0)
^19.06^4^4^3030722^^
"KRN",19,11192,1,1,0)
This CoreFLS Data Cleansing Summary Report displays a list of fields that
"KRN",19,11192,1,2,0)
contain data problems and the number of entries in the file that have
"KRN",19,11192,1,3,0)
problems in those fields.  These data problems must be corrected prior to
"KRN",19,11192,1,4,0)
data conversion into the CoreFLS system.
"KRN",19,11192,20)
S BODY="LOOP^PRCLC2"
"KRN",19,11192,25)
TOP^PRCLC1
"KRN",19,11192,"U")
SUMMARY PURCHASE ORDER REPORT
"KRN",19,11193,-1)
0^4
"KRN",19,11193,0)
PRCL PURCHASE ORDER RPT - DET^Detail Purchase Order Report^^R^^PRCL DATA CLEANSING^^^^^^IFCAP^^1
"KRN",19,11193,1,0)
^19.06^4^4^3030723^^^
"KRN",19,11193,1,1,0)
This CoreFLS Data Cleansing Detail Report displays a list of entries and
"KRN",19,11193,1,2,0)
their related fields from the PROCUREMENT & ACCOUNTING TRANSACTIONS (#442)
"KRN",19,11193,1,3,0)
file that do not conform to the required formats for CoreFLS data
"KRN",19,11193,1,4,0)
conversion.
"KRN",19,11193,20)
S BODY="RPT^PRCLC2"
"KRN",19,11193,25)
TOP^PRCLC1
"KRN",19,11193,"U")
DETAIL PURCHASE ORDER REPORT
"KRN",19,11194,-1)
0^6
"KRN",19,11194,0)
PRCL MISSING PO NUMBER RPT^Missing Purchase Order Number or 'B' x-ref^^R^^PRCL DATA CLEANSING^^^^^^IFCAP^^1
"KRN",19,11194,1,0)
^19.06^3^3^3030722^^
"KRN",19,11194,1,1,0)
This CoreFLS Data Cleansing Report displays entries in the PROCUREMENT &
"KRN",19,11194,1,2,0)
ACCOUNTING TRANSACTIONS (#442) file not listed in the "B" cross reference
"KRN",19,11194,1,3,0)
or with a missing PURCHASE ORDER NUMBER (#.01) field.
"KRN",19,11194,20)
S BODY="RPT1^PRCLC3"
"KRN",19,11194,25)
TOP^PRCLC1
"KRN",19,11194,"U")
MISSING PURCHASE ORDER NUMBER 
"MBREQ")
0
"ORD",18,19)
19;18;;;OPT^XPDTA;OPTF1^XPDIA;OPTE1^XPDIA;OPTF2^XPDIA;;OPTDEL^XPDIA
"ORD",18,19,0)
OPTION
"PKG",455,-1)
1^1
"PKG",455,0)
IFCAP^PRC^IFCAP System Files
"PKG",455,20,0)
^9.402P^^
"PKG",455,22,0)
^9.49I^1^1
"PKG",455,22,1,0)
5.1^3001012^3001019^68
"PKG",455,22,1,"PAH",1,0)
66^3030915
"PKG",455,22,1,"PAH",1,1,0)
^^11^11^3030915
"PKG",455,22,1,"PAH",1,1,1,0)
This patch is in support of the site preparation steps for CoreFLS
"PKG",455,22,1,"PAH",1,1,2,0)
deployment. It should be installed as a normal patch. A new option will
"PKG",455,22,1,"PAH",1,1,3,0)
be installed under the CoreFLS Data Cleansing menu [PRCL COREFLS DATA
"PKG",455,22,1,"PAH",1,1,4,0)
CLEANSING] with the same security key as the other options. Instructions
"PKG",455,22,1,"PAH",1,1,5,0)
for the use of this option will be included in an official CoreFLS Action
"PKG",455,22,1,"PAH",1,1,6,0)
Request.
"PKG",455,22,1,"PAH",1,1,7,0)
 
"PKG",455,22,1,"PAH",1,1,8,0)
This option contains various reports that show in summary or detail
"PKG",455,22,1,"PAH",1,1,9,0)
format the data fields for records in the PROCUREMENT & ACCOUNTING
"PKG",455,22,1,"PAH",1,1,10,0)
TRANSACTIONS file (#442) that do not conform to the established CoreFLS
"PKG",455,22,1,"PAH",1,1,11,0)
data cleansing guidelines.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
4
"RTN","PRCLC1")
0^1^B49470240
"RTN","PRCLC1",1,0)
PRCLC1 ;WOIFO/KJH - Purchase Order (Main routine) - CoreFLS Data Cleansing ;7 May 2003  3:33 PM
"RTN","PRCLC1",2,0)
 ;;5.1;IFCAP;**66**;Oct 20, 2000
"RTN","PRCLC1",3,0)
 ;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","PRCLC1",4,0)
 ;
"RTN","PRCLC1",5,0)
 ;NOTE: This routine is not callable from the top. Set variable 'BODY' (see option reader) and then call tag 'TOP'.
"RTN","PRCLC1",6,0)
 Q
"RTN","PRCLC1",7,0)
TOP ; Make sure no one else is currently compiling the list of purchase orders.
"RTN","PRCLC1",8,0)
 W !!
"RTN","PRCLC1",9,0)
 L +^XTMP("PRCLC"):1 E  D EN^DDIOL("Purchase Order compile in progress. Please try again later.",,"!!") G EXIT
"RTN","PRCLC1",10,0)
 L -^XTMP("PRCLC")
"RTN","PRCLC1",11,0)
 ; Make sure last compile completed successfully. Otherwise, do not allow user to print anything.
"RTN","PRCLC1",12,0)
 I '$D(^XTMP("PRCLC",0)),BODY]"" D EN^DDIOL("You must first run the purchase order compile before printing any reports.",,"!!") G EXIT
"RTN","PRCLC1",13,0)
 ; Display date of last compile.
"RTN","PRCLC1",14,0)
 I $D(^XTMP("PRCLC",0)) D EN^DDIOL("Last Purchase Order compile done on "_$$FMTE^XLFDT($P(^XTMP("PRCLC",0),U,2)),,"!!")
"RTN","PRCLC1",15,0)
 ; If this is a report, run it and exit.
"RTN","PRCLC1",16,0)
 I BODY]"" D DISPLAY G EXIT
"RTN","PRCLC1",17,0)
 ; Otherwise, this is the 'compile' option.
"RTN","PRCLC1",18,0)
 D COMPILE
"RTN","PRCLC1",19,0)
EXIT ; Make sure all the variables that weren't NEW'd get KILL'd. (Exception: ZT* variables are handled by TaskMan.)
"RTN","PRCLC1",20,0)
 K BODY,INS,DA,DIR,DIRUT,DTOUT,DUOUT,X,Y,%ZIS
"RTN","PRCLC1",21,0)
 Q
"RTN","PRCLC1",22,0)
DISPLAY ; Ask the user if they wish to display some instructions with the report. (Only for the detail reports.)
"RTN","PRCLC1",23,0)
 S INS="N"
"RTN","PRCLC1",24,0)
 I $P(BODY,"^")="LOOP" G DISP1
"RTN","PRCLC1",25,0)
 K DIR
"RTN","PRCLC1",26,0)
 S DIR(0)="YA",DIR("A")="Do you wish to also display the instructions? ",DIR("B")="YES"
"RTN","PRCLC1",27,0)
 S DIR("?")="Enter 'YES' to display a set of instructions before displaying the report."
"RTN","PRCLC1",28,0)
 D ^DIR K DIR
"RTN","PRCLC1",29,0)
 I $D(DTOUT)!$D(DUOUT) D EN^DDIOL("<Report Aborted> ",,"!!?10") Q
"RTN","PRCLC1",30,0)
 I Y S INS="Y"
"RTN","PRCLC1",31,0)
DISP1 ;
"RTN","PRCLC1",32,0)
 ; Ask the user for a device to print to (queuing is allowed).
"RTN","PRCLC1",33,0)
 S %ZIS="Q"
"RTN","PRCLC1",34,0)
 D ^%ZIS Q:POP
"RTN","PRCLC1",35,0)
 I '$D(IO("Q")) G PRT
"RTN","PRCLC1",36,0)
 S ZTSAVE("BODY")="",ZTSAVE("INS")=""
"RTN","PRCLC1",37,0)
 S ZTRTN="PRT^PRCLC1",ZTDESC="CoreFLS Data Cleansing Report (File# 442 - PURCHASE ORDERS)"
"RTN","PRCLC1",38,0)
 D ^%ZTLOAD,HOME^%ZIS
"RTN","PRCLC1",39,0)
 K ZTSK
"RTN","PRCLC1",40,0)
 Q
"RTN","PRCLC1",41,0)
PRT ; Print the requested report.
"RTN","PRCLC1",42,0)
 U IO
"RTN","PRCLC1",43,0)
 N PRCLA,PRCLB,PRCLD1,PRCLD2,PRCLD3,PRCLD4,PRCLD5,PRCLERR,PRCLOK
"RTN","PRCLC1",44,0)
 N PRCLN,PRCLS,PRCLI,PRCLJ,DISP,TOT,REQ,HEAD,HEAD1,HDR,I
"RTN","PRCLC1",45,0)
 S REQ="  * Required field *"
"RTN","PRCLC1",46,0)
 S PRCLA=0,P=0,L=0,ABORT=0
"RTN","PRCLC1",47,0)
 D @BODY
"RTN","PRCLC1",48,0)
PRT1 ; Report completed
"RTN","PRCLC1",49,0)
 I 'ABORT W !,"<End of Report>" I $E(IOST,1,2)="C-" W " Enter RETURN to continue" R Y:DTIME
"RTN","PRCLC1",50,0)
 I ABORT W !,"<Report Aborted>"
"RTN","PRCLC1",51,0)
 D ^%ZISC
"RTN","PRCLC1",52,0)
 K L,L2,P,X,Y,ABORT
"RTN","PRCLC1",53,0)
 I $D(ZTQUEUED) S ZTREQ="@"
"RTN","PRCLC1",54,0)
 Q
"RTN","PRCLC1",55,0)
HDR ; Print the standard report header.
"RTN","PRCLC1",56,0)
 ; Do not ask 'RETURN' before first page on CRT.
"RTN","PRCLC1",57,0)
 I $E(IOST,1,2)="C-",P R !,"Enter RETURN to continue or '^' to exit: ",Y:DTIME I '$T!(Y[U) S ABORT=1 Q
"RTN","PRCLC1",58,0)
 ; Do not print a form feed before first page on printer. Top of form is set at end of previous report.
"RTN","PRCLC1",59,0)
 I $E(IOST,1,2)="C-"!P W @IOF
"RTN","PRCLC1",60,0)
 S P=P+1,L=4
"RTN","PRCLC1",61,0)
 W $E("                              ",1,80-$L(HDR)/2),HDR ; Main report name
"RTN","PRCLC1",62,0)
 W !,"CoreFLS Data Cleansing Report (File# 442 - Purchase Orders)",?69,"Page: ",$J(P,4)
"RTN","PRCLC1",63,0)
 W !
"RTN","PRCLC1",64,0)
 I $G(HEAD1)]"" W "Purchase Order list compiled: ",$$FMTE^XLFDT($P(^XTMP("PRCLC",0),U,2))
"RTN","PRCLC1",65,0)
 W ?58,"Printed: ",$$FMTE^XLFDT(DT),!
"RTN","PRCLC1",66,0)
 I $G(HEAD)]"" D @HEAD ; Sub-header
"RTN","PRCLC1",67,0)
 Q
"RTN","PRCLC1",68,0)
COMPILE ; Ask the user if they want to queue the purchase order compile
"RTN","PRCLC1",69,0)
 ; Ask user for deployment date
"RTN","PRCLC1",70,0)
 N CONVDT,DEPLOYDT
"RTN","PRCLC1",71,0)
 K DIR
"RTN","PRCLC1",72,0)
 S DIR(0)="D^::EX"
"RTN","PRCLC1",73,0)
 S DIR("A")="Enter the CoreFLS deployment date or Data Cleansing date"
"RTN","PRCLC1",74,0)
 S DIR("?")="The Data Cleansing reports will use this date to determine which vendor records should be examined."
"RTN","PRCLC1",75,0)
 D ^DIR K DIR
"RTN","PRCLC1",76,0)
 I $D(DTOUT)!$D(DUOUT) D EN^DDIOL("<Purchase Order Compile Aborted> ",,"!!?10") G EX
"RTN","PRCLC1",77,0)
 S DEPLOYDT=Y
"RTN","PRCLC1",78,0)
 S CONVDT=$$FMADD^XLFDT(Y,-365)
"RTN","PRCLC1",79,0)
 K DIR
"RTN","PRCLC1",80,0)
 S DIR(0)="YA",DIR("B")="YES"
"RTN","PRCLC1",81,0)
 S DIR("A")="Do you wish to queue the purchase order compile? "
"RTN","PRCLC1",82,0)
 S DIR("A",1)=" "
"RTN","PRCLC1",83,0)
 F PRCLI=1:1:5 S DIR("A",PRCLI+1)=$P($T(LIST+PRCLI),";;",2)
"RTN","PRCLC1",84,0)
 S DIR("A",PRCLI+2)=" "
"RTN","PRCLC1",85,0)
 S DIR("?")="Enter 'YES' to queue the purchase order compile."
"RTN","PRCLC1",86,0)
 D ^DIR K DIR
"RTN","PRCLC1",87,0)
 I $D(DTOUT)!$D(DUOUT) D EN^DDIOL("<Purchase Order Compile Aborted> ",,"!!?10") G EX
"RTN","PRCLC1",88,0)
 I Y D  G EX
"RTN","PRCLC1",89,0)
 . S ZTIO="NULL",ZTDESC="CoreFLS Purchase Order List (to be converted)",ZTRTN="TASK^PRCLC1",ZTSAVE("DEPLOYDT")="",ZTSAVE("CONVDT")=""
"RTN","PRCLC1",90,0)
 . D ^%ZTLOAD
"RTN","PRCLC1",91,0)
 . I $G(ZTSK)]"" D EN^DDIOL("Compile's TaskMan ID is "_ZTSK,"","!!?10")
"RTN","PRCLC1",92,0)
 . K ZTSK
"RTN","PRCLC1",93,0)
 . Q
"RTN","PRCLC1",94,0)
 D EN^DDIOL("Compiling purchase order list ...",,"!!?10")
"RTN","PRCLC1",95,0)
TASK ; Setup an ^XTMP holding area for the purchase order list
"RTN","PRCLC1",96,0)
 L +^XTMP("PRCLC"):5 E  D:'$D(ZTQUEUED) EN^DDIOL("Another purchase order compile is currently running.",,"!!?10") G EX
"RTN","PRCLC1",97,0)
 K ^XTMP("PRCLC")
"RTN","PRCLC1",98,0)
 ; Now start the purchase order compile
"RTN","PRCLC1",99,0)
 N PRCLA,PRCLD1,PRCLD2,PRCLD3,PRCLDT,PRCLDT2,PRCLN,PRCLS
"RTN","PRCLC1",100,0)
 ; Calculate date to check from. (First day of the fiscal year one year previous. Sloppy calculation since we won't need dates before 2000.)
"RTN","PRCLC1",101,0)
 I +$E(DEPLOYDT,4,5)>9 S X=$E(DEPLOYDT,1,3) ; Oct thru Dec
"RTN","PRCLC1",102,0)
 E  S X=$E(DEPLOYDT,1,3)-1 ; Jan thru Sep
"RTN","PRCLC1",103,0)
 S PRCLDT=$E(X,1,3)_"1001" ; First day of fiscal year
"RTN","PRCLC1",104,0)
 S PRCLDT2=($E(X,1,3)-1)_"1001" ; First day of prev. fiscal year
"RTN","PRCLC1",105,0)
 ; Setup list of P.O. statuses that won't be converted (1 = no conversion; 0 = no conversion, unless they pass a date check)
"RTN","PRCLC1",106,0)
 S PRCLS($O(^PRCD(442.3,"C",1,0)))=1 ; Order Not Completely Prepared
"RTN","PRCLC1",107,0)
 S PRCLS($O(^PRCD(442.3,"AC",3,0)))=1 ; Order Not Completely Prepared
"RTN","PRCLC1",108,0)
 S PRCLS($O(^PRCD(442.3,"AC",45,0)))=1 ; Cancelled Order
"RTN","PRCLC1",109,0)
 S PRCLS($O(^PRCD(442.3,"AC",100,0)))=1 ; Obligated - 1358
"RTN","PRCLC1",110,0)
 S PRCLS($O(^PRCD(442.3,"AC",105,0)))=1 ; Cancelled - 1358
"RTN","PRCLC1",111,0)
 S PRCLS($O(^PRCD(442.3,"AC",40,0)))=0 ; Transaction Complete
"RTN","PRCLC1",112,0)
 S PRCLS($O(^PRCD(442.3,"AC",41,0)))=0 ; Transaction Complete (Amended)
"RTN","PRCLC1",113,0)
 ; Loop through the transactions in file 442.
"RTN","PRCLC1",114,0)
 S PRCLA=0 F  S PRCLA=$O(^PRC(442,PRCLA)) Q:'PRCLA  D
"RTN","PRCLC1",115,0)
 . ; Select all transactions (with vendors) in file 442 after a given date (or before the given date with certain statuses).
"RTN","PRCLC1",116,0)
 . S PRCLN=$G(^PRC(442,PRCLA,1)),PRCLD1=$P(PRCLN,U,15),PRCLD2=$P(PRCLN,U,1)
"RTN","PRCLC1",117,0)
 . I PRCLD2="" Q  ; No vendor assigned to this transaction.
"RTN","PRCLC1",118,0)
 . S PRCLN=$G(^PRC(442,PRCLA,0)),PRCLD3=$P(PRCLN,U,1),PRCLD5=$P(PRCLN,U,2)
"RTN","PRCLC1",119,0)
 . I PRCLD5="" Q  ; No method of processing assigned to this transaction.
"RTN","PRCLC1",120,0)
 . I PRCLD5=21 Q  ; Transaction is a Misc. Obligation (1358). These will not be converted. **
"RTN","PRCLC1",121,0)
 . S PRCLN=$G(^PRC(442,PRCLA,7)),PRCLD4=$P(PRCLN,U,1)
"RTN","PRCLC1",122,0)
 . I PRCLD4="" Q  ; No status assigned to this transaction.
"RTN","PRCLC1",123,0)
 . I $G(PRCLS(PRCLD4))=1 Q  ; These statuses will not be converted no matter what the PO date is.
"RTN","PRCLC1",124,0)
 . I PRCLD1<PRCLDT Q:$D(PRCLS(PRCLD4))  ; ** If PO date is before the given date then skip it if the status is in the above list.
"RTN","PRCLC1",125,0)
 . ; Convert only open p-card POs in the last 12 months
"RTN","PRCLC1",126,0)
 . I PRCLD5=25,PRCLD1<CONVDT Q
"RTN","PRCLC1",127,0)
 . ; Open non p-card POs in the current and prior fiscal years will be converted
"RTN","PRCLC1",128,0)
 . I PRCLD5'=25,PRCLD1<PRCLDT2 Q
"RTN","PRCLC1",129,0)
 . S ^XTMP("PRCLC",PRCLA)=""
"RTN","PRCLC1",130,0)
 . Q
"RTN","PRCLC1",131,0)
 ; Standard header for all ^XTMP globals.
"RTN","PRCLC1",132,0)
 S X=$$FMADD^XLFDT(DT,30)
"RTN","PRCLC1",133,0)
 S ^XTMP("PRCLC",0)=X_U_DT_"^CoreFLS Purchase Order List (to be converted)"
"RTN","PRCLC1",134,0)
 L -^XTMP("PRCLC")
"RTN","PRCLC1",135,0)
 I $D(ZTQUEUED) S ZTREQ="@"
"RTN","PRCLC1",136,0)
EX ;
"RTN","PRCLC1",137,0)
 K DA,DIR,DIRUT,DTOUT,DUOUT,X,Y,%ZIS
"RTN","PRCLC1",138,0)
 Q
"RTN","PRCLC1",139,0)
LIST ; Prompt text for the purchase order compile question
"RTN","PRCLC1",140,0)
 ;;Compile may take 30 minutes or more depending on the size of your database.
"RTN","PRCLC1",141,0)
 ;;Answering 'NO' will start the compile immediately in the foreground and your
"RTN","PRCLC1",142,0)
 ;;terminal will be unresponsive until it completes. Answering 'YES' will allow
"RTN","PRCLC1",143,0)
 ;;you to schedule the compile. Note that once the compile begins you will not
"RTN","PRCLC1",144,0)
 ;;be allowed to access these options until it completes.
"RTN","PRCLC2")
0^2^B24008539
"RTN","PRCLC2",1,0)
PRCLC2 ;WOIFO/KJH - Purchase Order Reports - CoreFLS Data Cleansing ;28 May 2003  3:33 PM
"RTN","PRCLC2",2,0)
 ;;5.1;IFCAP;**66**;Oct 20, 2000
"RTN","PRCLC2",3,0)
 ;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","PRCLC2",4,0)
 ;
"RTN","PRCLC2",5,0)
 ;NOTE: This routine is not callable from the top. Use TOP in PRCLC1.
"RTN","PRCLC2",6,0)
 Q
"RTN","PRCLC2",7,0)
RPT ; Detail Purchase Order Report
"RTN","PRCLC2",8,0)
 S HDR="DETAILED PURCHASE ORDER REPORT",PRCLERR=0
"RTN","PRCLC2",9,0)
 D INS^PRCLC4("TXT1","PRCLC4") Q:ABORT
"RTN","PRCLC2",10,0)
 D HDR^PRCLC1 Q:ABORT
"RTN","PRCLC2",11,0)
 ; Check each purchase order selected by the compile
"RTN","PRCLC2",12,0)
 F  S PRCLA=$O(^XTMP("PRCLC",PRCLA)) Q:'PRCLA  D  Q:ABORT
"RTN","PRCLC2",13,0)
 . K DISP
"RTN","PRCLC2",14,0)
 . F PRCLJ=1:1:3 S DISP(PRCLJ)="  * OK *"
"RTN","PRCLC2",15,0)
 . D CHECK
"RTN","PRCLC2",16,0)
 . S PRCLOK=1
"RTN","PRCLC2",17,0)
 . F PRCLJ=1:1:3 I DISP(PRCLJ)'="  * OK *",DISP(PRCLJ)'="" S PRCLOK=0
"RTN","PRCLC2",18,0)
 . I PRCLOK=1 Q  ; No Purchase Order entries or Item sub-file entries that seem to be bad.
"RTN","PRCLC2",19,0)
 . S PRCLB=0 F PRCLI=0:1 S PRCLB=$O(DISP(2,PRCLB)) Q:'PRCLB
"RTN","PRCLC2",20,0)
 . S PRCLB=0 F PRCLJ=0:1 S PRCLB=$O(DISP(3,PRCLB)) Q:'PRCLB
"RTN","PRCLC2",21,0)
 . ; One (blank) header line plus 4 main lines plus 1 line for each item plus 1 line for each distribution point (plus 2 lines as a buffer).
"RTN","PRCLC2",22,0)
 . ; 1 blank line + 1 PO Line 
"RTN","PRCLC2",23,0)
 . ; + 1 blank line and 1 item line if bad item entry(s) exist
"RTN","PRCLC2",24,0)
 . ; + 1 line per item
"RTN","PRCLC2",25,0)
 . ; + 1 blank line and ref # line if bad inv/distb entry(s) exist
"RTN","PRCLC2",26,0)
 . ; + 1 blank line and 1 vendor line if vendor is reported
"RTN","PRCLC2",27,0)
 . S L2=2
"RTN","PRCLC2",28,0)
 . I PRCLI S L2=L2+PRCLI+2
"RTN","PRCLC2",29,0)
 . I PRCLJ S L2=L2+PRCLJ+2
"RTN","PRCLC2",30,0)
 . I $G(DISP(1))'="  * OK *" S L2=L2+2
"RTN","PRCLC2",31,0)
 . I L+L2+2>IOSL D HDR^PRCLC1 Q:ABORT
"RTN","PRCLC2",32,0)
 . S L=L+L2
"RTN","PRCLC2",33,0)
 . S PRCLN=$G(^PRC(442,PRCLA,1)),PRCLD1=$P(PRCLN,U,10),PRCLD2="" ; PA/PPM/Authorized Buyer
"RTN","PRCLC2",34,0)
 . I PRCLD1]"" S PRCLN=$G(^VA(200,PRCLD1,0)),PRCLD2=$P(PRCLN,U,1)
"RTN","PRCLC2",35,0)
 . W !,"PO#: ",$P($G(^PRC(442,PRCLA,0)),U,1)
"RTN","PRCLC2",36,0)
 . S PRCLERR=1
"RTN","PRCLC2",37,0)
 . I PRCLD2]"" W " (PA/PPM/Authorized Buyer: ",PRCLD2,")"
"RTN","PRCLC2",38,0)
 . I $G(DISP(1))'="  * OK *" W !!,"Vendor",?25,$G(DISP(1))
"RTN","PRCLC2",39,0)
 . I $G(DISP(2)) W !!,"ITEM has ",$G(DISP(2))," bad ",$S(DISP(2)=1:"entry",1:"entries")," in field ITEM MASTER FILE NO."
"RTN","PRCLC2",40,0)
 . S PRCLB=0 F  S PRCLB=$O(DISP(2,PRCLB)) Q:'PRCLB  D
"RTN","PRCLC2",41,0)
 .. W !,"    Entry ",PRCLB," points to IEN ",DISP(2,PRCLB)," in ITEM MASTER which does not exist."
"RTN","PRCLC2",42,0)
 .. Q
"RTN","PRCLC2",43,0)
 . S PRCLB=0 F  S PRCLB=$O(DISP("2A",PRCLB)) Q:'PRCLB  D
"RTN","PRCLC2",44,0)
 .. W !,"    Entry ",PRCLB," points to IEN ",DISP("2A",PRCLB)," in ITEM MASTER which has no name."
"RTN","PRCLC2",45,0)
 .. Q
"RTN","PRCLC2",46,0)
 . I $G(DISP(3)) W !!,"2237 REFERENCE NUMBER has ",$G(DISP(3))," bad ",$S(DISP(3)=1:"entry",1:"entries")," in field INVENTORY/DISTRIBUTION PT."
"RTN","PRCLC2",47,0)
 . S PRCLB=0 F  S PRCLB=$O(DISP(3,PRCLB)) Q:'PRCLB  D
"RTN","PRCLC2",48,0)
 .. W !,"    Entry ",PRCLB," points to IEN ",DISP(3,PRCLB)," in GENERIC INVENTORY which does not exist."
"RTN","PRCLC2",49,0)
 .. Q
"RTN","PRCLC2",50,0)
 . S PRCLB=0 F  S PRCLB=$O(DISP("3A",PRCLB)) Q:'PRCLB  D
"RTN","PRCLC2",51,0)
 .. W !,"    Entry ",PRCLB," points to IEN ",DISP("3A",PRCLB)," in GENERIC INVENTORY which has no name."
"RTN","PRCLC2",52,0)
 . W !
"RTN","PRCLC2",53,0)
 . Q
"RTN","PRCLC2",54,0)
 I 'PRCLERR W !,"No problem records to report."
"RTN","PRCLC2",55,0)
 W !
"RTN","PRCLC2",56,0)
 Q
"RTN","PRCLC2",57,0)
LOOP ; Summary Purchase Order Report
"RTN","PRCLC2",58,0)
 ; Check each purchase order selected by the compile
"RTN","PRCLC2",59,0)
 F  S PRCLA=$O(^XTMP("PRCLC",PRCLA)) Q:'PRCLA  D
"RTN","PRCLC2",60,0)
 . K DISP
"RTN","PRCLC2",61,0)
 . S TOT=$G(TOT)+1
"RTN","PRCLC2",62,0)
 . F PRCLJ=1:1:3 S DISP(PRCLJ)="  * OK *"
"RTN","PRCLC2",63,0)
 . D CHECK
"RTN","PRCLC2",64,0)
 . S PRCLOK=1
"RTN","PRCLC2",65,0)
 . F PRCLJ=1:1:3 I DISP(PRCLJ)'="  * OK *",DISP(PRCLJ)'="" S TOT(PRCLJ)=$G(TOT(PRCLJ))+1,PRCLOK=0
"RTN","PRCLC2",66,0)
 . I PRCLOK=1 Q  ; No errors were found on this purchase order.
"RTN","PRCLC2",67,0)
 . S TOT(0)=$G(TOT(0))+1
"RTN","PRCLC2",68,0)
 . Q
"RTN","PRCLC2",69,0)
 S HDR="SUMMARY PURCHASE ORDER REPORT",HEAD1=1
"RTN","PRCLC2",70,0)
 D HDR^PRCLC1
"RTN","PRCLC2",71,0)
 ; Set null values to "0" for reporting display
"RTN","PRCLC2",72,0)
 I '$G(TOT) S TOT=0
"RTN","PRCLC2",73,0)
 F I=0:1:3 I '$G(TOT(I)) S TOT(I)=0
"RTN","PRCLC2",74,0)
 W !,"# POs Found",?22,$J($G(TOT),8)
"RTN","PRCLC2",75,0)
 W !,"# With Problems",?22,$J($G(TOT(0)),8)
"RTN","PRCLC2",76,0)
 W !,"Vendor",?22,$J($G(TOT(1)),8)
"RTN","PRCLC2",77,0)
 W !,"Item Master File No.",?22,$J($G(TOT(2)),8)
"RTN","PRCLC2",78,0)
 W !,"Inv. Distrib. Point",?22,$J($G(TOT(3)),8)
"RTN","PRCLC2",79,0)
 W !
"RTN","PRCLC2",80,0)
 Q
"RTN","PRCLC2",81,0)
CHECK ;
"RTN","PRCLC2",82,0)
 ; Vendor
"RTN","PRCLC2",83,0)
 S PRCLN=$G(^PRC(442,PRCLA,1)),PRCLD1=$P(PRCLN,U,1) D
"RTN","PRCLC2",84,0)
 . I PRCLD1="" S DISP(1)=REQ Q
"RTN","PRCLC2",85,0)
 . I PRCLD1'?1.N S DISP(1)=PRCLD1 Q
"RTN","PRCLC2",86,0)
 . I '$D(^PRC(440,PRCLD1,0)) S DISP(1)=PRCLD1 Q
"RTN","PRCLC2",87,0)
 . Q
"RTN","PRCLC2",88,0)
 ; Item Master File No.
"RTN","PRCLC2",89,0)
 S PRCLB=0 F  S PRCLB=$O(^PRC(442,PRCLA,2,PRCLB)) Q:'PRCLB  D
"RTN","PRCLC2",90,0)
 . S PRCLN=$G(^PRC(442,PRCLA,2,PRCLB,0)),PRCLD1=$P(PRCLN,U,5)
"RTN","PRCLC2",91,0)
 . I PRCLD1="" Q  ; NULL is allowed for this field
"RTN","PRCLC2",92,0)
 . I PRCLD1'?1.N S DISP(2,PRCLB)=PRCLD1,DISP(2)=DISP(2)+1 Q
"RTN","PRCLC2",93,0)
 . I '$D(^PRC(441,PRCLD1,0)) S DISP(2,PRCLB)=PRCLD1,DISP(2)=DISP(2)+1 Q
"RTN","PRCLC2",94,0)
 . ; Check short description field (name)
"RTN","PRCLC2",95,0)
 . I $P(^PRC(441,PRCLD1,0),"^",2)="" S DISP("2A",PRCLB)=PRCLD1,DISP(2)=DISP(2)+1 Q
"RTN","PRCLC2",96,0)
 . Q
"RTN","PRCLC2",97,0)
 ; Inventory Distribution Point
"RTN","PRCLC2",98,0)
 S PRCLB=0 F  S PRCLB=$O(^PRC(442,PRCLA,13,PRCLB)) Q:'PRCLB  D
"RTN","PRCLC2",99,0)
 . S PRCLN=$G(^PRC(442,PRCLA,13,PRCLB,0)),PRCLD1=$P(PRCLN,U,11)
"RTN","PRCLC2",100,0)
 . I PRCLD1="" Q  ; NULL is allowed for this field
"RTN","PRCLC2",101,0)
 . I PRCLD1'?1.N S DISP(3,PRCLB)=PRCLD1,DISP(3)=DISP(3)+1 Q
"RTN","PRCLC2",102,0)
 . I '$D(^PRCP(445,PRCLD1,0)) S DISP(3,PRCLB)=PRCLD1,DISP(3)=DISP(3)+1 Q
"RTN","PRCLC2",103,0)
 . ; Check .01 field Inventory Point, free text (name)
"RTN","PRCLC2",104,0)
 . I $P(^PRCP(445,PRCLD1,0),"^",1)="" S DISP("3A",PRCLB)=PRCLD1,DISP(3)=DISP(3)+1 Q
"RTN","PRCLC2",105,0)
 . Q
"RTN","PRCLC2",106,0)
 Q
"RTN","PRCLC3")
0^3^B13497615
"RTN","PRCLC3",1,0)
PRCLC3 ;WOIFO/KJH - Purchase Order (Other Reports) - CoreFLS Data Cleansing ;28 May 2003  3:33 PM
"RTN","PRCLC3",2,0)
 ;;5.1;IFCAP;**66**;Oct 20, 2000
"RTN","PRCLC3",3,0)
 ;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","PRCLC3",4,0)
 ;
"RTN","PRCLC3",5,0)
 ;NOTE: This routine is not callable from the top. Use TOP in PRCLC1.
"RTN","PRCLC3",6,0)
 Q
"RTN","PRCLC3",7,0)
RPT1 ; Missing Purchase Order Number or "B" x-ref
"RTN","PRCLC3",8,0)
 S HDR="MISSING PURCHASE ORDER NUMBER OR 'B' X-REF REPORT",PRCLERR=0
"RTN","PRCLC3",9,0)
 D INS^PRCLC4("TXT1","PRCLC3") Q:ABORT
"RTN","PRCLC3",10,0)
 S HEAD="HDR1^PRCLC3"
"RTN","PRCLC3",11,0)
 D HDR^PRCLC1 Q:ABORT
"RTN","PRCLC3",12,0)
 F  S PRCLA=$O(^XTMP("PRCLC",PRCLA)) Q:'PRCLA  D  Q:ABORT
"RTN","PRCLC3",13,0)
 . D:L+1>IOSL HDR^PRCLC1 Q:ABORT
"RTN","PRCLC3",14,0)
 . S PRCLN=$G(^PRC(442,PRCLA,0)),PRCLD1=$P(PRCLN,U,1)
"RTN","PRCLC3",15,0)
 . I PRCLD1="" W !,$J(PRCLA,8),?10,REQ,?50,"PO Number" S L=L+1,PRCLERR=1 Q
"RTN","PRCLC3",16,0)
 . I '$D(^PRC(442,"B",$E(PRCLD1,1,30),PRCLA)) W !,$J(PRCLA,8),?10,PRCLD1,?50,"PO Number not in 'B' x-ref" S L=L+1,PRCLERR=1 Q
"RTN","PRCLC3",17,0)
 . Q
"RTN","PRCLC3",18,0)
 I 'PRCLERR W !!,"No problem records to report."
"RTN","PRCLC3",19,0)
 W !
"RTN","PRCLC3",20,0)
 Q
"RTN","PRCLC3",21,0)
HDR1 ;
"RTN","PRCLC3",22,0)
 W !,"IEN",?10,"Purchase Order",?50,"Reason"
"RTN","PRCLC3",23,0)
 S L=L+1
"RTN","PRCLC3",24,0)
 Q
"RTN","PRCLC3",25,0)
TXT1 ; ===========================================================================
"RTN","PRCLC3",26,0)
 ;;The following instructions/notes refer to the CoreFLS Data Cleansing detailed
"RTN","PRCLC3",27,0)
 ;;purchase order report for Missing Purchase Order Number or "B" x-ref.
"RTN","PRCLC3",28,0)
 ;;
"RTN","PRCLC3",29,0)
 ;;This report displays two related pieces of information:
"RTN","PRCLC3",30,0)
 ;;        1) If a Purchase Order record is found where the PURCHASE ORDER
"RTN","PRCLC3",31,0)
 ;;           NUMBER (#.01) field is blank, then this report displays the
"RTN","PRCLC3",32,0)
 ;;           internal entry number (IEN) for the purchase order and a
"RTN","PRCLC3",33,0)
 ;;           message that this is a required field. In this case, the user
"RTN","PRCLC3",34,0)
 ;;           needs to determine the correct purchase order number so that
"RTN","PRCLC3",35,0)
 ;;           the purchase order will be converted into CoreFLS.
"RTN","PRCLC3",36,0)
 ;;
"RTN","PRCLC3",37,0)
 ;;        2) If the purchase order number is not found in the
"RTN","PRCLC3",38,0)
 ;;           "B" cross-reference, this report displays the purchase order
"RTN","PRCLC3",39,0)
 ;;           number and IEN with a message that the "B" x-ref is missing.
"RTN","PRCLC3",40,0)
 ;;           This needs to be corrected because the CoreFLS extraction
"RTN","PRCLC3",41,0)
 ;;           process depends on this cross-reference.
"RTN","PRCLC3",42,0)
 ;;
"RTN","PRCLC3",43,0)
 ;;The information for each record is printed by row with the following columns:
"RTN","PRCLC3",44,0)
 ;;
"RTN","PRCLC3",45,0)
 ;;IEN            - PROCUREMENT & ACCOUNTING TRANSACTIONS (#442) file internal
"RTN","PRCLC3",46,0)
 ;;                 record (entry) number
"RTN","PRCLC3",47,0)
 ;;
"RTN","PRCLC3",48,0)
 ;;Purchase Order - value found in the PURCHASE ORDER NUMBER (#.01) field or
"RTN","PRCLC3",49,0)
 ;;                 "* Required field *" if this field is blank
"RTN","PRCLC3",50,0)
 ;;
"RTN","PRCLC3",51,0)
 ;;Reason         - brief description of the identified problem:
"RTN","PRCLC3",52,0)
 ;;
"RTN","PRCLC3",53,0)
 ;;                 "Purchase Order Number Missing" means the PURCHASE ORDER
"RTN","PRCLC3",54,0)
 ;;                  NUMBER (#.01) field is blank.
"RTN","PRCLC3",55,0)
 ;;
"RTN","PRCLC3",56,0)
 ;;                 "Purchase Order Number not in 'B' x-ref" means the Purchase
"RTN","PRCLC3",57,0)
 ;;                  Order Number found in the PURCHASE ORDER NUMBER (#.01)
"RTN","PRCLC3",58,0)
 ;;                  field is not listed in the "B" cross-reference.
"RTN","PRCLC3",59,0)
 ;;
"RTN","PRCLC3",60,0)
 ;;NOTE: Contact National VistA Support to resolve all entries on this report.
"RTN","PRCLC3",61,0)
 ;;**END**
"RTN","PRCLC4")
0^4^B16533455
"RTN","PRCLC4",1,0)
PRCLC4 ;WOIFO/KJH - Purchase Order (Instructions) - CoreFLS Data Cleansing ;21 Mar 2003  3:33 PM
"RTN","PRCLC4",2,0)
 ;;5.1;IFCAP;**66**;Oct 20, 2000
"RTN","PRCLC4",3,0)
 ;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","PRCLC4",4,0)
 ;
"RTN","PRCLC4",5,0)
 ;NOTE: This routine is not callable from the top. Use TOP in PRCLC1.
"RTN","PRCLC4",6,0)
 Q
"RTN","PRCLC4",7,0)
INS(TAG,RTN) ; Print Data Cleansing 'instructions/notes' (max 75 columns per line).
"RTN","PRCLC4",8,0)
 I INS'="Y" S HEAD1=1 Q
"RTN","PRCLC4",9,0)
 S HDR="INSTRUCTIONS FOR "_HDR
"RTN","PRCLC4",10,0)
 D HDR^PRCLC1
"RTN","PRCLC4",11,0)
 F PRCLI=1:1 S @("PRCLN=$T("_TAG_"+"_PRCLI_"^"_RTN_")"),PRCLN=$P(PRCLN,";;",2,999) Q:PRCLN="**END**"  D:L+3>IOSL HDR^PRCLC1 Q:ABORT  W !,PRCLN S L=L+1
"RTN","PRCLC4",12,0)
 Q:ABORT
"RTN","PRCLC4",13,0)
 ; Must have a page break between instructions and report, but don't want to do a full header.
"RTN","PRCLC4",14,0)
 W !!,"<End of Instructions>"
"RTN","PRCLC4",15,0)
 ; Do not ask 'RETURN' before first page on CRT.
"RTN","PRCLC4",16,0)
 I $E(IOST,1,2)="C-",P R " Enter RETURN to continue or '^' to exit: ",Y:DTIME I '$T!(Y[U) S ABORT=1 Q
"RTN","PRCLC4",17,0)
 ; Do not print a form feed before first page on printer. Top of form is set at end of previous report.
"RTN","PRCLC4",18,0)
 I $E(IOST,1,2)="C-"!P W @IOF
"RTN","PRCLC4",19,0)
 S HDR=$P(HDR," ",3,$L(HDR," ")),HEAD1=1,P=0,L=0 ; Reset header and page and line number indicators for main report
"RTN","PRCLC4",20,0)
 Q
"RTN","PRCLC4",21,0)
TXT1 ; ===========================================================================
"RTN","PRCLC4",22,0)
 ;;The following instructions/notes refer to the CoreFLS Data Cleansing
"RTN","PRCLC4",23,0)
 ;;Detailed Purchase Order Report. They explain the criteria for each field
"RTN","PRCLC4",24,0)
 ;;and what actions the user needs to take to update any fields that do not
"RTN","PRCLC4",25,0)
 ;;conform to the required formats. The report will display fields that don't
"RTN","PRCLC4",26,0)
 ;;match CoreFLS guidelines for PO records which would be converted into
"RTN","PRCLC4",27,0)
 ;;CoreFLS.
"RTN","PRCLC4",28,0)
 ;;
"RTN","PRCLC4",29,0)
 ;;Each field can contain one of the following pieces of information:
"RTN","PRCLC4",30,0)
 ;;
"RTN","PRCLC4",31,0)
 ;;* Required field *
"RTN","PRCLC4",32,0)
 ;;  - The field is required in CoreFLS, but may or may not be required in
"RTN","PRCLC4",33,0)
 ;;    VistA. The user needs to determine what value should be stored in this
"RTN","PRCLC4",34,0)
 ;;    field and update it in the VistA system.
"RTN","PRCLC4",35,0)
 ;;
"RTN","PRCLC4",36,0)
 ;;BLANK (no data displayed)
"RTN","PRCLC4",37,0)
 ;;  - The field has no data stored in it in the VistA system and it is not
"RTN","PRCLC4",38,0)
 ;;    required in CoreFLS. (The user may still wish to review these fields
"RTN","PRCLC4",39,0)
 ;;    to determine if they would like to populate these fields before the
"RTN","PRCLC4",40,0)
 ;;    conversion to CoreFLS.)
"RTN","PRCLC4",41,0)
 ;;
"RTN","PRCLC4",42,0)
 ;;Any Other Data Displayed
"RTN","PRCLC4",43,0)
 ;;  - The field contains data that will present a problem for the CoreFLS
"RTN","PRCLC4",44,0)
 ;;    data conversion.
"RTN","PRCLC4",45,0)
 ;;
"RTN","PRCLC4",46,0)
 ;;The following FIELD DESCRIPTIONS list details for each header abbreviation,
"RTN","PRCLC4",47,0)
 ;;the field name and number, and the allowed values or other screening
"RTN","PRCLC4",48,0)
 ;;criteria used for that field. Unless otherwise noted, all fields are from
"RTN","PRCLC4",49,0)
 ;;the PROCUREMENT & ACCOUNTING TRANSACTIONS (#442) file. Consult the help
"RTN","PRCLC4",50,0)
 ;;text for each field in the VistA system for further information.
"RTN","PRCLC4",51,0)
 ;;
"RTN","PRCLC4",52,0)
 ;;FIELD DESCRIPTIONS
"RTN","PRCLC4",53,0)
 ;;===========================================================================
"RTN","PRCLC4",54,0)
 ;;Vendor               [VENDOR                       (Field #5)              ]
"RTN","PRCLC4",55,0)
 ;;  - Required field. Must be a valid entry in the VENDOR file (#440).
"RTN","PRCLC4",56,0)
 ;;Item Master File No. [ITEM MASTER FILE NO.         (File 442.01 Field #1.5)]
"RTN","PRCLC4",57,0)
 ;;  - This field is part of multiple ITEM (#40) in file #442. If any entry
"RTN","PRCLC4",58,0)
 ;;    exists for this field, it must be a valid entry in the ITEM MASTER
"RTN","PRCLC4",59,0)
 ;;    file (#441).
"RTN","PRCLC4",60,0)
 ;;Inv. Distrib. Point  [INVENTORY/DISTRIBUTION POINT (File 442.14 Field #11) ]
"RTN","PRCLC4",61,0)
 ;;  - This field is part of multiple 2237 REFERENCE NUMBER (#.05) in
"RTN","PRCLC4",62,0)
 ;;    file #442. If any entry exists for this field, it must be a valid entry
"RTN","PRCLC4",63,0)
 ;;    in the GENERIC INVENTORY file (#445).
"RTN","PRCLC4",64,0)
 ;;**END**
"VER")
8.0^22.0
**END**
**END**
