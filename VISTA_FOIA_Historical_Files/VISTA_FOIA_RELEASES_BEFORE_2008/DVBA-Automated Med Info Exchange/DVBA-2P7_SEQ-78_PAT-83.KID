Released DVBA*2.7*83 SEQ #78
Extracted from mail message
**KIDS**:DVBA*2.7*83^

**INSTALL NAME**
DVBA*2.7*83
"BLD",5880,0)
DVBA*2.7*83^AUTOMATED MED INFO EXCHANGE^0^3050131^y
"BLD",5880,1,0)
^^1^1^3050125^
"BLD",5880,1,1,0)
Incorrect release date and time.
"BLD",5880,4,0)
^9.64PA^^
"BLD",5880,"ABPKG")
n
"BLD",5880,"INID")
^y
"BLD",5880,"INIT")
DVBA83PI
"BLD",5880,"KRN",0)
^9.67PA^8989.52^19
"BLD",5880,"KRN",.4,0)
.4
"BLD",5880,"KRN",.401,0)
.401
"BLD",5880,"KRN",.402,0)
.402
"BLD",5880,"KRN",.403,0)
.403
"BLD",5880,"KRN",.5,0)
.5
"BLD",5880,"KRN",.84,0)
.84
"BLD",5880,"KRN",3.6,0)
3.6
"BLD",5880,"KRN",3.8,0)
3.8
"BLD",5880,"KRN",9.2,0)
9.2
"BLD",5880,"KRN",9.8,0)
9.8
"BLD",5880,"KRN",9.8,"NM",0)
^9.68A^3^3
"BLD",5880,"KRN",9.8,"NM",1,0)
DVBCRELS^^0^B16425320
"BLD",5880,"KRN",9.8,"NM",2,0)
DVBA83PI^^0^B4139360
"BLD",5880,"KRN",9.8,"NM",3,0)
DVB83RPT^^0^B2840146
"BLD",5880,"KRN",9.8,"NM","B","DVB83RPT",3)

"BLD",5880,"KRN",9.8,"NM","B","DVBA83PI",2)

"BLD",5880,"KRN",9.8,"NM","B","DVBCRELS",1)

"BLD",5880,"KRN",19,0)
19
"BLD",5880,"KRN",19.1,0)
19.1
"BLD",5880,"KRN",101,0)
101
"BLD",5880,"KRN",409.61,0)
409.61
"BLD",5880,"KRN",771,0)
771
"BLD",5880,"KRN",870,0)
870
"BLD",5880,"KRN",8989.51,0)
8989.51
"BLD",5880,"KRN",8989.52,0)
8989.52
"BLD",5880,"KRN",8994,0)
8994
"BLD",5880,"KRN","B",.4,.4)

"BLD",5880,"KRN","B",.401,.401)

"BLD",5880,"KRN","B",.402,.402)

"BLD",5880,"KRN","B",.403,.403)

"BLD",5880,"KRN","B",.5,.5)

"BLD",5880,"KRN","B",.84,.84)

"BLD",5880,"KRN","B",3.6,3.6)

"BLD",5880,"KRN","B",3.8,3.8)

"BLD",5880,"KRN","B",9.2,9.2)

"BLD",5880,"KRN","B",9.8,9.8)

"BLD",5880,"KRN","B",19,19)

"BLD",5880,"KRN","B",19.1,19.1)

"BLD",5880,"KRN","B",101,101)

"BLD",5880,"KRN","B",409.61,409.61)

"BLD",5880,"KRN","B",771,771)

"BLD",5880,"KRN","B",870,870)

"BLD",5880,"KRN","B",8989.51,8989.51)

"BLD",5880,"KRN","B",8989.52,8989.52)

"BLD",5880,"KRN","B",8994,8994)

"BLD",5880,"QUES",0)
^9.62^^
"BLD",5880,"REQB",0)
^9.611^^
"INIT")
DVBA83PI
"MBREQ")
0
"PKG",223,-1)
1^1
"PKG",223,0)
AUTOMATED MED INFO EXCHANGE^DVBA^The entire AMIE package 7131/2507.
"PKG",223,20,0)
^9.402P^^
"PKG",223,22,0)
^9.49I^1^1
"PKG",223,22,1,0)
2.7^2950410^2950508
"PKG",223,22,1,"PAH",1,0)
83^3050131
"PKG",223,22,1,"PAH",1,1,0)
^^1^1^3050131
"PKG",223,22,1,"PAH",1,1,1,0)
Incorrect release date and time.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
3
"RTN","DVB83RPT")
0^3^B2840146
"RTN","DVB83RPT",1,0)
DVB83RPT ;ALB/RLC;REPORT TO IDENTIFY BAD RECORDS IN FILE 396.3; 01/24/05 1:05 PM
"RTN","DVB83RPT",2,0)
 ;;2.7;AMIE;**83**;Apr 10, 1995
"RTN","DVB83RPT",3,0)
 ;
"RTN","DVB83RPT",4,0)
 ;report to identify records that may possibly have to be corrected
"RTN","DVB83RPT",5,0)
 ;
"RTN","DVB83RPT",6,0)
 K ^TMP("396.3")
"RTN","DVB83RPT",7,0)
 D QUE
"RTN","DVB83RPT",8,0)
 Q
"RTN","DVB83RPT",9,0)
 ;
"RTN","DVB83RPT",10,0)
 ;Identify possible corrupt records
"RTN","DVB83RPT",11,0)
ID S DVBIEN=0
"RTN","DVB83RPT",12,0)
 F  S DVBIEN=$O(^DVB(396.3,DVBIEN)) Q:'DVBIEN  D
"RTN","DVB83RPT",13,0)
 .Q:'$D(^DVB(396.3,DVBIEN,0))
"RTN","DVB83RPT",14,0)
 .Q:$P(^DVB(396.3,DVBIEN,0),U,13)'=-1!($P(^DVB(396.3,DVBIEN,0),U,14)'=-1)
"RTN","DVB83RPT",15,0)
 .S ^TMP("396.3",DVBIEN)=""
"RTN","DVB83RPT",16,0)
 ;
"RTN","DVB83RPT",17,0)
RPT ;Report of records identified
"RTN","DVB83RPT",18,0)
 S DVPG=0
"RTN","DVB83RPT",19,0)
 D HEAD,HD1
"RTN","DVB83RPT",20,0)
 S DVBIEN=0
"RTN","DVB83RPT",21,0)
 F  S DVBIEN=$O(^TMP("396.3",DVBIEN)) Q:'DVBIEN  D
"RTN","DVB83RPT",22,0)
 .W !?5,DVBIEN
"RTN","DVB83RPT",23,0)
 .I $D(SCREEN),$Y>IOSL S DIR(0)="E" D ^DIR D HEAD,HD1 Q
"RTN","DVB83RPT",24,0)
 .I $Y>IOSL D HEAD,HD1
"RTN","DVB83RPT",25,0)
 D FOOT
"RTN","DVB83RPT",26,0)
 Q
"RTN","DVB83RPT",27,0)
 ;
"RTN","DVB83RPT",28,0)
HEAD ;Report header
"RTN","DVB83RPT",29,0)
 W:$D(IOF) @IOF
"RTN","DVB83RPT",30,0)
 S $Y=0
"RTN","DVB83RPT",31,0)
 W !,"LIST OF RECORDS FROM FILE 396.3 THAT MAY BE CORRUPT"
"RTN","DVB83RPT",32,0)
 S DVPG=DVPG+1 W ?72,"Page: ",DVPG,!!
"RTN","DVB83RPT",33,0)
 Q
"RTN","DVB83RPT",34,0)
 ;
"RTN","DVB83RPT",35,0)
HD1 ;Column heading
"RTN","DVB83RPT",36,0)
 W "Internal Record #",!,"================="
"RTN","DVB83RPT",37,0)
 Q
"RTN","DVB83RPT",38,0)
 ;
"RTN","DVB83RPT",39,0)
FOOT ;End of report
"RTN","DVB83RPT",40,0)
 W !!!,"*** END OF REPORT ***",!
"RTN","DVB83RPT",41,0)
 K DVBIEN,^TMP("396.3")
"RTN","DVB83RPT",42,0)
 Q
"RTN","DVB83RPT",43,0)
 ;
"RTN","DVB83RPT",44,0)
QUE ;Queue Report
"RTN","DVB83RPT",45,0)
 W:$D(IOF) @IOF
"RTN","DVB83RPT",46,0)
 W !,"LIST OF RECORDS FROM FILE 396.3 THAT MAY BE CORRUPT",!!
"RTN","DVB83RPT",47,0)
 N ZTQUEUED,POP
"RTN","DVB83RPT",48,0)
 K %ZIS,IOP,IOC,ZTIO S %ZIS="MQ" D ^%ZIS G:POP QUE1
"RTN","DVB83RPT",49,0)
 S ZTRTN="ID^DVB83RPT"
"RTN","DVB83RPT",50,0)
 I $D(IO("Q")) K IO("Q") D ^%ZTLOAD W !,"REQUEST QUEUED" Q
"RTN","DVB83RPT",51,0)
QUE1 S SCREEN="" I $D(ZTRTN) D @ZTRTN
"RTN","DVB83RPT",52,0)
 Q
"RTN","DVBA83PI")
0^2^B4139360
"RTN","DVBA83PI",1,0)
DVBA83PI ;ALB/RLC;POST-INIT ROUTINE TO UPDATE FILE 396.3; 01/24/05 1:05 PM
"RTN","DVBA83PI",2,0)
 ;;2.7;AMIE;**83**;Apr 10, 1995
"RTN","DVBA83PI",3,0)
 ;
"RTN","DVBA83PI",4,0)
EN S DVBIEN=0
"RTN","DVBA83PI",5,0)
 F  S DVBIEN=$O(^DVB(396.3,DVBIEN)) Q:'DVBIEN  D
"RTN","DVBA83PI",6,0)
 .Q:'$D(^DVB(396.3,DVBIEN,0))
"RTN","DVBA83PI",7,0)
 .Q:$P(^DVB(396.3,DVBIEN,0),U,13)'=-1!($P(^DVB(396.3,DVBIEN,0),U,14)'=-1)
"RTN","DVBA83PI",8,0)
 .Q:'$D(^DVB(396.3,DVBIEN,1))
"RTN","DVBA83PI",9,0)
 .Q:$P(^DVB(396.3,DVBIEN,1),U,6)=""
"RTN","DVBA83PI",10,0)
 .S DVB1=$G(^DVB(396.3,DVBIEN,1))
"RTN","DVBA83PI",11,0)
 .S DVBDT=$P(DVB1,U,6)
"RTN","DVBA83PI",12,0)
 .S DA=DVBIEN
"RTN","DVBA83PI",13,0)
 .S DIE="^DVB(396.3,"
"RTN","DVBA83PI",14,0)
 .S DR="12////"_DVBDT_";13////"_DVBDT_""
"RTN","DVBA83PI",15,0)
 .D ^DIE
"RTN","DVBA83PI",16,0)
 .K DA,DIE,DR
"RTN","DVBA83PI",17,0)
 .S ^TMP("UPDATED",$J,DVBIEN)=""
"RTN","DVBA83PI",18,0)
 K DA,DIE,DR,DVBIEN,DVB1,DVBDT,X
"RTN","DVBA83PI",19,0)
 ;
"RTN","DVBA83PI",20,0)
MSG ;generate mailman message to user listing all updated records
"RTN","DVBA83PI",21,0)
 N DVPARAM,XMDUZ,XMSUB,XMTEXT,XMY,MSGTXT
"RTN","DVBA83PI",22,0)
 S CT=0
"RTN","DVBA83PI",23,0)
 S CT=CT+1,MSGTXT(CT)="THE FOLLOWING RECORDS IN THE 2507 REQUEST FILE (396.6)"
"RTN","DVBA83PI",24,0)
 S CT=CT+1,MSGTXT(CT)="WERE UPDATED DURING INSTALLATION OF PATCH DVBA*2.7*83:"
"RTN","DVBA83PI",25,0)
 S CT=CT+1,MSGTXT(CT)=""
"RTN","DVBA83PI",26,0)
 S DVBIEN=0
"RTN","DVBA83PI",27,0)
 F  S DVBIEN=$O(^TMP("UPDATED",$J,DVBIEN)) Q:'DVBIEN  D
"RTN","DVBA83PI",28,0)
 .S CT=CT+1,MSGTXT(CT)=DVBIEN
"RTN","DVBA83PI",29,0)
 I '$D(^TMP("UPDATED",$J)) S CT=CT+1,MSGTXT(CT)="",CT=CT+1,MSGTXT(CT)="NO RECORDS FOUND THAT COULD BE UPDATED"
"RTN","DVBA83PI",30,0)
 S CT=CT+1,MSGTXT(CT)="",CT=CT+1,MSGTXT(CT)=""
"RTN","DVBA83PI",31,0)
 S CT=CT+1,MSGTXT(CT)="RUN ROUTINE DVB83RPT FROM PROGRAMMER MODE"
"RTN","DVBA83PI",32,0)
 S CT=CT+1,MSGTXT(CT)="FOR A LIST OF RECORDS THAT MAY NEED UPDATING."
"RTN","DVBA83PI",33,0)
 S XMTEXT="MSGTXT"
"RTN","DVBA83PI",34,0)
 S DVPARAM("FROM")="PATCH DVBA*2.7*83"
"RTN","DVBA83PI",35,0)
 S XMDUZ=DUZ,XMSUB="LIST OF FILE 396.3 UPDATES",XMY(DUZ)=""
"RTN","DVBA83PI",36,0)
 D SENDMSG^XMXAPI(XMDUZ,XMSUB,XMTEXT,.XMY,.DVPARAM,"","")
"RTN","DVBA83PI",37,0)
 K XMDUZ,XMSUB,XMY,CT,DVBIEN,MSGTXT,^TMP("UPDATED",$J)
"RTN","DVBA83PI",38,0)
 Q
"RTN","DVBCRELS")
0^1^B16425320
"RTN","DVBCRELS",1,0)
DVBCRELS ;ALB/GTS-557/THM-RELEASE 2507 REQUEST TO RO ; 5/27/91  4:54 PM
"RTN","DVBCRELS",2,0)
 ;;2.7;AMIE;**83**;Apr 10, 1995
"RTN","DVBCRELS",3,0)
 ;
"RTN","DVBCRELS",4,0)
 I $D(DUZ)#2=0 W *7,!!,"Invalid user number (DUZ)",!! H 3 Q
"RTN","DVBCRELS",5,0)
 I '$D(^XUSEC("DVBA C RELEASE 2507",DUZ)) W *7,!!,"You are not authorized to release 2507 requests!!",!! H 3 Q
"RTN","DVBCRELS",6,0)
 G EN
"RTN","DVBCRELS",7,0)
 ;
"RTN","DVBCRELS",8,0)
EXAM S EXAM=$P(^DVB(396.4,DA,0),U,3),EXAM=$P(^DVB(396.6,+EXAM,0),U,1)
"RTN","DVBCRELS",9,0)
 S STAT=$P(^DVB(396.4,DA,0),U,4)
"RTN","DVBCRELS",10,0)
 I STAT'="C"&(STAT'["X") S NFINAL=1 W !,EXAM," is not complete " W:STAT="T" " (transferred)"
"RTN","DVBCRELS",11,0)
 Q
"RTN","DVBCRELS",12,0)
 ;
"RTN","DVBCRELS",13,0)
EN D HOME^%ZIS S FF=IOF,HD="Veteran Selection",HD2="2507 Exam Release"
"RTN","DVBCRELS",14,0)
 ;
"RTN","DVBCRELS",15,0)
LOOK D KILL W @FF,!?(IOM-$L(HD)\2),HD,!?(IOM-$L(HD2)\2),HD2,!!! S DIC("W")="D DICW^DVBCUTIL" S DIC="^DVB(396.3,",DIC(0)="AEQM",DIC("A")="Select VETERAN: " D ^DIC G:X=""!(X=U) EXIT I +Y<0 W *7,"  ???" G LOOK
"RTN","DVBCRELS",16,0)
 S STAT=$P(^DVB(396.3,+Y,0),U,18) D STATCHK G:$D(NCN) LOOK
"RTN","DVBCRELS",17,0)
 S REQDA=+Y,DFN=+$P(Y,U,2),REQDT=$P(^DVB(396.3,REQDA,0),U,2)
"RTN","DVBCRELS",18,0)
 S (PNAM,SSN)="Unknown" I $D(^DPT(DFN,0)) S PNAM=$P(^(0),U,1),SSN=$P(^(0),U,9)
"RTN","DVBCRELS",19,0)
 S CNUM=$S($D(^DPT(DFN,.31)):$P(^(.31),U,3),1:"Unknown") K DICW
"RTN","DVBCRELS",20,0)
 S STAT=$P(^DVB(396.3,REQDA,0),U,18) D STATCHK I $D(NCN) K NCN G LOOK
"RTN","DVBCRELS",21,0)
 W !!,"Please wait while the individual exam statuses are checked.  " H 1 W !
"RTN","DVBCRELS",22,0)
 ;
"RTN","DVBCRELS",23,0)
DATA S NFINAL=0 F DA=0:0 S DA=$O(^DVB(396.4,"C",REQDA,DA)) Q:DA=""  D EXAM
"RTN","DVBCRELS",24,0)
 I NFINAL=0 W !!,"All exams have been completed, please enter the following:",!!
"RTN","DVBCRELS",25,0)
 I NFINAL=1 W *7,!!,"Since there are still incomplete exams,",!,"  this request cannot be released to the RO.  " W !!,"Press RETURN or ""^"" to exit  " R ANS:DTIME G:'$T!(ANS=U) EXIT G LOOK
"RTN","DVBCRELS",26,0)
 S DVBOTH=$P(^DVB(396.3,REQDA,1),U,3),DVBABY=$P(^(1),U,5),DVBDTA=$P(^(1),U,6)
"RTN","DVBCRELS",27,0)
 S:DVBABY="" DVBABY="@" S:DVBDTA="" DVBDTA="@"
"RTN","DVBCRELS",28,0)
 I NFINAL=0 K DR S CTIM=$$NOW^XLFDT,DA=REQDA,DIE="^DVB(396.3,",DR="12////"_CTIM_";13////"_CTIM_";14////^S X=DUZ;17///R;W *7;22;25R;26R" D ^DIE K CTIM
"RTN","DVBCRELS",29,0)
 I '$D(Y),NFINAL=0 W !!,"This request is now released.",!! H 2
"RTN","DVBCRELS",30,0)
 I '$D(Y),$P(^DVB(396.3,REQDA,0),U,22)]"",$P(^(0),U,22)'=$P(^XMB(1,1,0),U,1) D ^DVBCXFRE K DIC,DIE,DR,DA S FAX="Y",RSTAT="CT" G FX ;transfers
"RTN","DVBCRELS",31,0)
 ;set back to transcribed if error or not completed
"RTN","DVBCRELS",32,0)
 I $D(Y) W *7,!!,"Release NOT COMPLETED !!",!! H 2 S DR="6///@;12///@;13///@;14///@;17////T;25////"_DVBABY_";26////"_DVBDTA,DIE="^DVB(396.3,",DA=REQDA,DIC=DIE,$P(^DVB(396.3,REQDA,1),U,3)=DVBOTH D ^DIE G LOOK
"RTN","DVBCRELS",33,0)
 S FAX=$S($D(^DVB(396.3,REQDA,1)):$P(^(1),U,3),1:"N"),RSTAT="C"
"RTN","DVBCRELS",34,0)
 ;
"RTN","DVBCRELS",35,0)
FX ;if to be faxed or transferred out, set like RO has printed it
"RTN","DVBCRELS",36,0)
 I FAX="Y" K DR S CTIM=$$NOW^XLFDT,DR="6////"_CTIM_";15////"_CTIM_";16////^S X=DUZ;17////"_RSTAT S (DIE,DIC)="^DVB(396.3,",DA=REQDA D ^DIE
"RTN","DVBCRELS",37,0)
 G LOOK
"RTN","DVBCRELS",38,0)
 ;
"RTN","DVBCRELS",39,0)
EXIT G KILL^DVBCUTIL
"RTN","DVBCRELS",40,0)
 ;
"RTN","DVBCRELS",41,0)
KILL K CNUM,SSN,PNAM,FAX,CTIM,DIC,DA,D0,D1,DFN,X,Y,NCN,STAT,%,NOFND,NFINAL,REQDA,STAT,RSTAT,DVBDTA,DVBOTH,DVBABY
"RTN","DVBCRELS",42,0)
 Q
"RTN","DVBCRELS",43,0)
 ;
"RTN","DVBCRELS",44,0)
STATCHK I STAT="RX" W *7,!!,"This request has been cancelled by the RO.",!! H 2 S NCN=1 Q
"RTN","DVBCRELS",45,0)
 I STAT="CT" W *7,!!,"This request has been completed and transferred out.",!! H 2 S NCN=1 Q
"RTN","DVBCRELS",46,0)
 I STAT="X" W *7,!!,"This request has been cancelled by MAS.",!! H 2 S NCN=1 Q
"RTN","DVBCRELS",47,0)
 I STAT="R" W *7,!!,"This request has been released to the RO.",!! H 2 S NCN=1 Q
"RTN","DVBCRELS",48,0)
 I STAT="C" W *7,!!,"This request has been printed by the RO.",!! H 2 S NCN=1 Q
"RTN","DVBCRELS",49,0)
 I STAT="N"!(STAT="NT") W *7,!!,"This request is new and has not yet been reported to MAS.",!! H 2 S NCN=1
"RTN","DVBCRELS",50,0)
 Q
"VER")
8.0^22.0
**END**
**END**
