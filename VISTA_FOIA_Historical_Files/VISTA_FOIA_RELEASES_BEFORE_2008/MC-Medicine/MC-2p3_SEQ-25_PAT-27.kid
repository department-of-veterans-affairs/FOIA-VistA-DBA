Released MC*2.3*27 SEQ #25
Extracted from mail message
**KIDS**:MC*2.3*27^

**INSTALL NAME**
MC*2.3*27
"BLD",1978,0)
MC*2.3*27^MEDICINE^0^3000420^y
"BLD",1978,1,0)
^^2^2^3000208^^
"BLD",1978,1,1,0)
Please refer to the patch description for MC*2.3*27 on Forum for an
"BLD",1978,1,2,0)
explanation of this patch.
"BLD",1978,4,0)
^9.64PA^^
"BLD",1978,"ABPKG")
n
"BLD",1978,"KRN",0)
^9.67PA^19^18
"BLD",1978,"KRN",.4,0)
.4
"BLD",1978,"KRN",.401,0)
.401
"BLD",1978,"KRN",.402,0)
.402
"BLD",1978,"KRN",.403,0)
.403
"BLD",1978,"KRN",.5,0)
.5
"BLD",1978,"KRN",.84,0)
.84
"BLD",1978,"KRN",3.6,0)
3.6
"BLD",1978,"KRN",3.8,0)
3.8
"BLD",1978,"KRN",9.2,0)
9.2
"BLD",1978,"KRN",9.8,0)
9.8
"BLD",1978,"KRN",9.8,"NM",0)
^9.68A^2^2
"BLD",1978,"KRN",9.8,"NM",1,0)
MCARP^^0^B29285701
"BLD",1978,"KRN",9.8,"NM",2,0)
MCAPI^^^B4779104
"BLD",1978,"KRN",9.8,"NM","B","MCAPI",2)

"BLD",1978,"KRN",9.8,"NM","B","MCARP",1)

"BLD",1978,"KRN",19,0)
19
"BLD",1978,"KRN",19.1,0)
19.1
"BLD",1978,"KRN",101,0)
101
"BLD",1978,"KRN",409.61,0)
409.61
"BLD",1978,"KRN",771,0)
771
"BLD",1978,"KRN",869.2,0)
869.2
"BLD",1978,"KRN",870,0)
870
"BLD",1978,"KRN",8994,0)
8994
"BLD",1978,"KRN","B",.4,.4)

"BLD",1978,"KRN","B",.401,.401)

"BLD",1978,"KRN","B",.402,.402)

"BLD",1978,"KRN","B",.403,.403)

"BLD",1978,"KRN","B",.5,.5)

"BLD",1978,"KRN","B",.84,.84)

"BLD",1978,"KRN","B",3.6,3.6)

"BLD",1978,"KRN","B",3.8,3.8)

"BLD",1978,"KRN","B",9.2,9.2)

"BLD",1978,"KRN","B",9.8,9.8)

"BLD",1978,"KRN","B",19,19)

"BLD",1978,"KRN","B",19.1,19.1)

"BLD",1978,"KRN","B",101,101)

"BLD",1978,"KRN","B",409.61,409.61)

"BLD",1978,"KRN","B",771,771)

"BLD",1978,"KRN","B",869.2,869.2)

"BLD",1978,"KRN","B",870,870)

"BLD",1978,"KRN","B",8994,8994)

"BLD",1978,"QUES",0)
^9.62^^
"BLD",1978,"REQB",0)
^9.611^1^1
"BLD",1978,"REQB",1,0)
MC*2.3*18^2
"BLD",1978,"REQB","B","MC*2.3*18",1)

"MBREQ")
0
"PKG",185,-1)
1^1
"PKG",185,0)
MEDICINE^MC^MEDICINE PACKAGE INCLUDES ALL AREAS OF MEDICINE
"PKG",185,22,0)
^9.49I^1^1
"PKG",185,22,1,0)
2.3^2960913^2980612^2055
"PKG",185,22,1,"PAH",1,0)
27^3000420^144
"PKG",185,22,1,"PAH",1,1,0)
^^2^2^3000420
"PKG",185,22,1,"PAH",1,1,1,0)
Please refer to the patch description for MC*2.3*27 on Forum for an
"PKG",185,22,1,"PAH",1,1,2,0)
explanation of this patch.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
2
"RTN","MCAPI")
0^2^B4779104
"RTN","MCAPI",1,0)
MCAPI ; CIOFO/MD - Print result from a medicine file
"RTN","MCAPI",2,0)
 ;;2.3;Medicine;**27**;09/13/1996
"RTN","MCAPI",3,0)
 ;;**DBIA #3042**
"RTN","MCAPI",4,0)
 ;
"RTN","MCAPI",5,0)
 ; RESULT= variable pointer to a medicine file entry
"RTN","MCAPI",6,0)
 ;         (e.g. "12;MCAR(691.5,") (required).
"RTN","MCAPI",7,0)
 ;
"RTN","MCAPI",8,0)
 ; MCFLG =1 if report to be headerless (optional)
"RTN","MCAPI",9,0)
 ;
"RTN","MCAPI",10,0)
EN(RESULT,MCFLG) ; Print result from a medicine file
"RTN","MCAPI",11,0)
 N XQY0,MCARGRTN,PR,DISTP,DILCT,NUM,NAME,PRE,TSUP2,TT,TY,HOSP,ORVP,DA,MCARGDA,OT,MCARPPS,MCPRO,DFN,RDATE,SCD
"RTN","MCAPI",12,0)
 S XQY0="",OT=$$SINGLE^MCAPI(RESULT)
"RTN","MCAPI",13,0)
 I OT="" W !,"***** BAD MEDICINE FILE POINTER  *****",! Q
"RTN","MCAPI",14,0)
 S (DA,MCARGDA)=$P(OT,U,2),MCARPPS=$P(OT,U,3,4),MCPRO=$P(OT,U,11),DFN=$P(OT,U,13),ORVP=DFN_"DPT("
"RTN","MCAPI",15,0)
 D MCPPROC^MCARP
"RTN","MCAPI",16,0)
 S MCARGRTN=$P(OT,U,5)
"RTN","MCAPI",17,0)
 D @MCARPPS
"RTN","MCAPI",18,0)
 K %I
"RTN","MCAPI",19,0)
 Q
"RTN","MCAPI",20,0)
SINGLE(RESULT) ;  Function to return info on single proceedure.
"RTN","MCAPI",21,0)
 ;
"RTN","MCAPI",22,0)
 ; RESULT = variable pointer to a medicine file
"RTN","MCAPI",23,0)
 ;          (e.g. "12;MCAR(691.5,") (required)
"RTN","MCAPI",24,0)
 ;
"RTN","MCAPI",25,0)
 N VALUE,ZNODE,S4,S5,S6,WH,DFN,J,K,L,LL,LL1,M,MCARCODE,MCARDT,MCARPROC,MCESKEY,MCESSEC,MCFILE,PR,S1,S2
"RTN","MCAPI",26,0)
 S S6=+$G(RESULT) ;ien from medicine file
"RTN","MCAPI",27,0)
 S S5=$P($P($G(RESULT),";",2),",") ;S5 is the root of the medicine file, no ^ or ,
"RTN","MCAPI",28,0)
 S ZNODE=$G(@("^"_S5_","_S6_",0)")) ;zero node from record S6 in file S5
"RTN","MCAPI",29,0)
 I $G(ZNODE)="" S VALUE="" G KILL
"RTN","MCAPI",30,0)
 D:'($G(ZNODE)="")
"RTN","MCAPI",31,0)
 . S S4=9999999.9999-($P(ZNODE,"^")) ;S4 is proceedure time/date
"RTN","MCAPI",32,0)
 . S DFN=$P(ZNODE,"^",2),WH=""
"RTN","MCAPI",33,0)
 . Q
"RTN","MCAPI",34,0)
 D CONT^MCARPS2,PR0^MCARPS2 ;return single ^TMP("MCAR",$J,"GMRC", node
"RTN","MCAPI",35,0)
 S ^TMP("MCAR",$J,"GMRC","OT",1)=$G(^TMP("OR",$J,"MCAR","OT",1)),VALUE=$S($G(^TMP("MCAR",$J,"GMRC","OT",1))'="":^TMP("MCAR",$J,"GMRC","OT",1)_"^"_DFN,1:"")
"RTN","MCAPI",36,0)
KILL K ^TMP("MCAR",$J,"GMRC"),^TMP("OR",$J,"MCAR")
"RTN","MCAPI",37,0)
 Q VALUE
"RTN","MCARP")
0^1^B29285701
"RTN","MCARP",1,0)
MCARP ;WISC/TJK-PRINT ROUTINES ;12/15/97  14:54
"RTN","MCARP",2,0)
 ;;2.3;Medicine;**6,14,15,18,27**;09/13/1996
"RTN","MCARP",3,0)
 ;
"RTN","MCARP",4,0)
 ;
"RTN","MCARP",5,0)
CATH ;
"RTN","MCARP",6,0)
 S DIC="^MCAR(691.1,",MCARZ="CATHETERIZATION REPORT",MCARGRTN=$S('$$XTRCT(XQY0):"CATHB",1:"CATH1") G LOOK
"RTN","MCARP",7,0)
ECHO S DIC="^MCAR(691,",MCARZ="ECHO REPORT",MCARGRTN=$S('$$XTRCT(XQY0):"ECHOB",1:"ECHO1") G LOOK
"RTN","MCARP",8,0)
ECG S DIC="^MCAR(691.5,",MCARZ="ECG REPORT",MCARGRTN=$S('$$XTRCT(XQY0):"ECGB",1:"ECG1") G LOOK
"RTN","MCARP",9,0)
EP S DIC="^MCAR(691.8,",MCARZ="EP REPORT",MCARGRTN=$S('$$XTRCT(XQY0):"EPB",1:"EP1") G LOOK
"RTN","MCARP",10,0)
HOLTER S DIC="^MCAR(691.6,",MCARZ="HOLTER REPORT",MCARGRTN=$S('$$XTRCT(XQY0):"HOLTERB",1:"HOLTER1") G LOOK
"RTN","MCARP",11,0)
RHFULL S DIC="^MCAR(701,",MCARZ="RHEUMATOLOGY REPORT",MCARGRTN=$S('$$XTRCT(XQY0):"RHB",1:"RHFULL1") G LOOK
"RTN","MCARP",12,0)
ETT S DIC="^MCAR(691.7,",MCARZ="ETT REPORT",MCARGRTN=$S('$$XTRCT(XQY0):"ETTB",1:"ETT1")
"RTN","MCARP",13,0)
LOOK ;
"RTN","MCARP",14,0)
 D MCPPROC
"RTN","MCARP",15,0)
 I '$D(MCARPPS) D LOOK2,^DIC G:Y<0 EXIT S (MCARGDA,DA)=+Y
"RTN","MCARP",16,0)
 I $G(MCESON),$D(^MCAR(MCFILE,MCARGDA,"ES")) D STATUS^MCESPRT(MCFILE,MCARGDA)
"RTN","MCARP",17,0)
 I $D(ORHFS) U IO G PRINT ;dcm/slc added for CPRS
"RTN","MCARP",18,0)
DEVQUE ; Device Control and Queuing Control
"RTN","MCARP",19,0)
 K IO("Q") S %ZIS="MQ" D ^%ZIS I POP S MCOUT="" G EXIT
"RTN","MCARP",20,0)
 I $D(IO("Q")) S (ZTSAVE("DIC"),ZTSAVE("MC*"))="",ZTRTN="PRINT^MCARP",ZTDESC=MCARZ D ^%ZTLOAD K ZTSK G EXIT
"RTN","MCARP",21,0)
 U IO
"RTN","MCARP",22,0)
PRINT ; Print Report
"RTN","MCARP",23,0)
 K DXS,DIOT(2),^UTILITY($J),MCOUT S (D0,DA)=MCARGDA,PG=0
"RTN","MCARP",24,0)
 S DFN=$P(^MCAR(+$P(DIC,"(",2),MCARGDA,0),U,2),MCARGDT=$P(^(0),U,1) S:DIC[699 MCARGNUM=$P(^(0),U,$S(DIC[699.5:6,1:12))
"RTN","MCARP",25,0)
RHPRT ;
"RTN","MCARP",26,0)
 D INIT^MCARP1(MCARZ,MCARGDT,MCFILE)
"RTN","MCARP",27,0)
 S ^UTILITY($J,1)="S MCY="""" I $Y>IOSL-3 R:$E(IOST,1,2)=""C-"" !!,""Press return to continue, '^' to escape: "",MCY:DTIME S:'$T MCY=U S:MCY=U DN=0,MCOUT=1 D:DN HEAD^MCARP K MCY"
"RTN","MCARP",28,0)
 D HEAD,CALLTEM
"RTN","MCARP",29,0)
 I '$D(MCOUT) D:$G(MCESON) FOOTER^MCESPRT(MCFILE,MCARGDA)
"RTN","MCARP",30,0)
 S:$D(ZTQUEUED) ZTREQ="@" K ZTSK
"RTN","MCARP",31,0)
 G EXIT
"RTN","MCARP",32,0)
CALLTEM ;
"RTN","MCARP",33,0)
 N MCFILE D @MCARGRTN Q
"RTN","MCARP",34,0)
EXIT ;
"RTN","MCARP",35,0)
 D EXIT^MCARP1 Q
"RTN","MCARP",36,0)
LOOK2 ;
"RTN","MCARP",37,0)
 S DIC(0)="AEMQ",DIC("A")="Enter patient name or the date & time: "
"RTN","MCARP",38,0)
 I MCESON S DIC("S")=$$PREVIEW^MCESSCR(MCFILE)
"RTN","MCARP",39,0)
 Q
"RTN","MCARP",40,0)
CATH1 D ^MCAROC1 K DXS Q:$D(MCOUT)  D ^MCAROC2 K DXS Q:$D(MCOUT)  D ^MCAROC3 K DXS Q:$D(MCOUT)  D ^MCAROC4 Q
"RTN","MCARP",41,0)
CATHB D ^MCOBC1 Q
"RTN","MCARP",42,0)
ECHO1 D ^MCRPEC K DXS Q:$D(MCOUT)  Q
"RTN","MCARP",43,0)
ECHOB D ^MCOBK Q
"RTN","MCARP",44,0)
ECG1 D ^MCAROK Q
"RTN","MCARP",45,0)
ECGB D ^MCOBE1 Q
"RTN","MCARP",46,0)
EPB D ^MCOBEP Q
"RTN","MCARP",47,0)
EP1 D ^MCAROEP G EPEND:$D(MCOUT)
"RTN","MCARP",48,0)
 G VT:'$D(^MCAR(691.9,"C",MCARGDA))
"RTN","MCARP",49,0)
 S MCY=""
"RTN","MCARP",50,0)
 I $Y>IOSL-3 R:$E(IOST,1,2)="C-" !!,"Press return to continue, '^' to escape: ",MCY:DTIME S:'$T MCY=U S:$E(MCY)=U MCOUT=1 G:$G(MCOUT)=1 EPEND
"RTN","MCARP",51,0)
 F D0=0:0 S D0=$O(^MCAR(691.9,"C",MCARGDA,D0)) Q:D0=""  K DXS D HEAD,^MCAROAT G EPEND:$D(MCOUT)
"RTN","MCARP",52,0)
VT Q:'$D(^MCAR(692,"C",MCARGDA))
"RTN","MCARP",53,0)
 I $Y>IOSL-3 R:$E(IOST,1,2)="C-" !!,"Press return to continue, '^' to escape: ",MCY:DTIME S:'$T MCY=U S:$E(MCY)=U MCOUT=1 G:$G(MCOUT)=1 EPEND
"RTN","MCARP",54,0)
 F D0=0:0 S D0=$O(^MCAR(692,"C",MCARGDA,D0)) Q:D0=""  K DXS D HEAD,^MCAROV Q:$D(MCOUT)
"RTN","MCARP",55,0)
EPEND Q
"RTN","MCARP",56,0)
ETT1 D ^MCAROT Q
"RTN","MCARP",57,0)
ETTB D ^MCOBT Q
"RTN","MCARP",58,0)
HOLTER1 D ^MCAROH1 K DXS Q:$D(MCOUT)  D ^MCAROH2 Q
"RTN","MCARP",59,0)
HOLTERB D ^MCOBH1 Q
"RTN","MCARP",60,0)
GENERIC D ^MCAROGE Q
"RTN","MCARP",61,0)
GENERICB D ^MCOBGEN Q
"RTN","MCARP",62,0)
GI I $D(^DIC(120.8)) D ^MCAROGM I 1 ;    new allergy info
"RTN","MCARP",63,0)
 E  D ^MCAROG
"RTN","MCARP",64,0)
 K DXS
"RTN","MCARP",65,0)
 D:'$D(MCOUT) ^MCAROGA
"RTN","MCARP",66,0)
 Q
"RTN","MCARP",67,0)
GIB D ^MCOBGA Q
"RTN","MCARP",68,0)
PULM D ^MCAROP K DXS Q:$D(MCOUT)  D ^MCAROPE Q
"RTN","MCARP",69,0)
PULMB D ^MCOBPE Q
"RTN","MCARP",70,0)
NONENDO D ^MCAROGN Q
"RTN","MCARP",71,0)
NONENDOB D ^MCOBGN Q
"RTN","MCARP",72,0)
CONSULT D ^MCAROGC Q
"RTN","MCARP",73,0)
CONSULTB D ^MCOBGC Q
"RTN","MCARP",74,0)
GENIMP D ^MCAROPG Q
"RTN","MCARP",75,0)
GENIMPB D ^MCOBPG Q
"RTN","MCARP",76,0)
ALEAD D ^MCAROPA Q
"RTN","MCARP",77,0)
ALEADB D ^MCOBPA Q
"RTN","MCARP",78,0)
VLEAD D ^MCAROPV Q
"RTN","MCARP",79,0)
VLEADB D ^MCOBPV Q
"RTN","MCARP",80,0)
SURV D ^MCAROPS Q
"RTN","MCARP",81,0)
SURVB D ^MCOBPS Q
"RTN","MCARP",82,0)
RHFULL1 ;
"RTN","MCARP",83,0)
 I +$G(MCRH)=0 D RHFULL2 Q
"RTN","MCARP",84,0)
 S MCFILE=701,V=MCRH,MCRHR="^MCAROR"_$S(V=1:"A",V=2:"B",V=3:"N",V=4:"L",V=6:"Q",V=7:"H",V=8:"P",V=9:"D",1:"RHFULL2^MCARP") D @MCRHR K DXS Q:$D(MCOUT)  D:V=8 ^MCARORE K DXS Q:$D(MCOUT)  D:MCRH=1 DISP^MCMAG Q
"RTN","MCARP",85,0)
RHFULL2 ;
"RTN","MCARP",86,0)
 F RH="A","B","N","L","Q","H","P","E","D" Q:$D(MCOUT)  D
"RTN","MCARP",87,0)
 .S MCFILE=701,MCRHR="^MCAROR"_RH D @MCRHR K DXS Q:$D(MCOUT)
"RTN","MCARP",88,0)
 .I RH="A" D DISP^MCMAG K DXS
"RTN","MCARP",89,0)
 Q
"RTN","MCARP",90,0)
RHB D ^MCOBRH K DXS Q:$D(MCOUT)  D ^MCOBRHA Q
"RTN","MCARP",91,0)
DTIME S MCT=$P(X,".",2),X=$S(X:$E(X,4,5)_"/"_$E(X,6,7)_"/"_$E(X,2,3),1:"")_" "_$S(MCT:$E(MCT,1,2)_$E("00",0,2-$L($E(MCT,1,2)))_":"_$E(MCT,3,4)_$E("00",0,2-$L($E(MCT,3,4))),1:"")
"RTN","MCARP",92,0)
 K MCT Q
"RTN","MCARP",93,0)
HEAD ;
"RTN","MCARP",94,0)
 S HOSP=$P($G(^DPT(DFN,.1)),U) S:HOSP'="" HOSP=$O(^SC("B",HOSP,"")) S:HOSP'="" HOSP=$P(^SC(HOSP,0),U,15) S:HOSP'="" HOSP=$P($G(^DG(40.8,HOSP,0)),U)
"RTN","MCARP",95,0)
 S PG=PG+1 W:PG>1 @IOF I '+$G(MCFLG) D
"RTN","MCARP",96,0)
 .  W !!,"Pg. "_PG,?30,HOSP,?79-$L(MCARDTM),MCARDTM
"RTN","MCARP",97,0)
 .  I (PG>1),($E(IOST,1,2)="C-") W ! Q
"RTN","MCARP",98,0)
 .  W !,$$HEDSTAR("CONFIDENTIAL "_MCARZ,77)
"RTN","MCARP",99,0)
 .  W !,MCARGNM_"    "_SSN_"   " W ?39-($L(MCARWARD_" "_MCARRB)\2),MCARWARD_" "_MCARRB,?79-$L(" DOB: "_MCARDOB)," DOB: "_MCARDOB
"RTN","MCARP",100,0)
 .  Q
"RTN","MCARP",101,0)
 I +$G(MCFLG) W !,$$HEDSTAR(MCARZ,77)
"RTN","MCARP",102,0)
 W !,?39-($L("PROCEDURE DATE/TIME: "_MCARGDT2)\2),"PROCEDURE DATE/TIME: ",MCARGDT2
"RTN","MCARP",103,0)
 N FFF S $P(FFF,"- ",40)="- " W !,FFF,!
"RTN","MCARP",104,0)
 Q
"RTN","MCARP",105,0)
HEDSTAR(X,X1) ;    surround text string X with asterisks to length X1
"RTN","MCARP",106,0)
 N Y1
"RTN","MCARP",107,0)
 S (TY,Y1)="",$P(Y1," ",X1-$L(X)\2-1)=" ",TY=Y1_" "_X_" "
"RTN","MCARP",108,0)
 F I=$L(TY):1:X1 S TY=TY_" "
"RTN","MCARP",109,0)
 Q TY
"RTN","MCARP",110,0)
MCPPROC ; Get require variables
"RTN","MCARP",111,0)
 D MCPPROC^MCARP1 Q
"RTN","MCARP",112,0)
XTRCT(FULL) ;Extrinsic Function use to determine Full reporting or brief
"RTN","MCARP",113,0)
 Q $S($E($P(FULL,U),3)="B":0,1:1)
"RTN","MCARP",114,0)
MCPROP(MCPROP) ; Medicine Procedure file entry validator
"RTN","MCARP",115,0)
 N TEMP,PREFIX,CNT
"RTN","MCARP",116,0)
 S PREFIX=$S($E(MCPROP,3,4)="ES":7,1:4),TEMP=""
"RTN","MCARP",117,0)
 F CNT=PREFIX+2:1:$L(MCPROP) I $D(^MCAR(697.2,"B",$E(MCPROP,PREFIX+1,CNT))) S TEMP=$E(MCPROP,PREFIX+1,CNT) Q
"RTN","MCARP",118,0)
 Q TEMP
"VER")
8.0^22.0
**END**
**END**
