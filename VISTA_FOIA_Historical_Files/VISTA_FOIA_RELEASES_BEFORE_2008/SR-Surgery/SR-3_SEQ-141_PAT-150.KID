Released SR*3*150 SEQ #141
Extracted from mail message
**KIDS**:SR*3.0*150^

**INSTALL NAME**
SR*3.0*150
"BLD",5442,0)
SR*3.0*150^SURGERY^0^3051205^y
"BLD",5442,1,0)
^^1^1^3050818^
"BLD",5442,1,1,0)
THIS PATCH CORRECTS FOUR ISSUES RELATED TO CIDC.
"BLD",5442,4,0)
^9.64PA^133^1
"BLD",5442,4,133,0)
133
"BLD",5442,4,133,2,0)
^9.641^133^1
"BLD",5442,4,133,2,133,0)
SURGERY SITE PARAMETERS  (File-top level)
"BLD",5442,4,133,2,133,1,0)
^9.6411^.01^1
"BLD",5442,4,133,2,133,1,.01,0)
SITE
"BLD",5442,4,133,222)
y^n^p^^^^n^^n
"BLD",5442,4,133,224)

"BLD",5442,4,"APDD",133,133)

"BLD",5442,4,"APDD",133,133,.01)

"BLD",5442,4,"B",133,133)

"BLD",5442,6)
6^
"BLD",5442,"ABPKG")
n
"BLD",5442,"KRN",0)
^9.67PA^8989.52^19
"BLD",5442,"KRN",.4,0)
.4
"BLD",5442,"KRN",.401,0)
.401
"BLD",5442,"KRN",.402,0)
.402
"BLD",5442,"KRN",.402,"NM",0)
^9.68A^1^1
"BLD",5442,"KRN",.402,"NM",1,0)
SRPARAM    FILE #133^133^0
"BLD",5442,"KRN",.402,"NM","B","SRPARAM    FILE #133",1)

"BLD",5442,"KRN",.403,0)
.403
"BLD",5442,"KRN",.5,0)
.5
"BLD",5442,"KRN",.84,0)
.84
"BLD",5442,"KRN",3.6,0)
3.6
"BLD",5442,"KRN",3.8,0)
3.8
"BLD",5442,"KRN",9.2,0)
9.2
"BLD",5442,"KRN",9.8,0)
9.8
"BLD",5442,"KRN",9.8,"NM",0)
^9.68A^5^5
"BLD",5442,"KRN",9.8,"NM",1,0)
SROADX^^0^B91763601
"BLD",5442,"KRN",9.8,"NM",2,0)
SROADX2^^0^B33229144
"BLD",5442,"KRN",9.8,"NM",3,0)
SROPCE1^^0^B39384156
"BLD",5442,"KRN",9.8,"NM",4,0)
SROADX1^^0^B93981084
"BLD",5442,"KRN",9.8,"NM",5,0)
SROANEST^^0^B53321835
"BLD",5442,"KRN",9.8,"NM","B","SROADX",1)

"BLD",5442,"KRN",9.8,"NM","B","SROADX1",4)

"BLD",5442,"KRN",9.8,"NM","B","SROADX2",2)

"BLD",5442,"KRN",9.8,"NM","B","SROANEST",5)

"BLD",5442,"KRN",9.8,"NM","B","SROPCE1",3)

"BLD",5442,"KRN",19,0)
19
"BLD",5442,"KRN",19.1,0)
19.1
"BLD",5442,"KRN",101,0)
101
"BLD",5442,"KRN",409.61,0)
409.61
"BLD",5442,"KRN",771,0)
771
"BLD",5442,"KRN",870,0)
870
"BLD",5442,"KRN",8989.51,0)
8989.51
"BLD",5442,"KRN",8989.52,0)
8989.52
"BLD",5442,"KRN",8994,0)
8994
"BLD",5442,"KRN","B",.4,.4)

"BLD",5442,"KRN","B",.401,.401)

"BLD",5442,"KRN","B",.402,.402)

"BLD",5442,"KRN","B",.403,.403)

"BLD",5442,"KRN","B",.5,.5)

"BLD",5442,"KRN","B",.84,.84)

"BLD",5442,"KRN","B",3.6,3.6)

"BLD",5442,"KRN","B",3.8,3.8)

"BLD",5442,"KRN","B",9.2,9.2)

"BLD",5442,"KRN","B",9.8,9.8)

"BLD",5442,"KRN","B",19,19)

"BLD",5442,"KRN","B",19.1,19.1)

"BLD",5442,"KRN","B",101,101)

"BLD",5442,"KRN","B",409.61,409.61)

"BLD",5442,"KRN","B",771,771)

"BLD",5442,"KRN","B",870,870)

"BLD",5442,"KRN","B",8989.51,8989.51)

"BLD",5442,"KRN","B",8989.52,8989.52)

"BLD",5442,"KRN","B",8994,8994)

"BLD",5442,"QUES",0)
^9.62^^
"BLD",5442,"REQB",0)
^9.611^1^1
"BLD",5442,"REQB",1,0)
SR*3.0*119^2
"BLD",5442,"REQB","B","SR*3.0*119",1)

"FIA",133)
SURGERY SITE PARAMETERS
"FIA",133,0)
^SRO(133,
"FIA",133,0,0)
133P
"FIA",133,0,1)
y^n^p^^^^n^^n
"FIA",133,0,10)

"FIA",133,0,11)

"FIA",133,0,"RLRO")

"FIA",133,0,"VR")
3.0^SR
"FIA",133,133)
1
"FIA",133,133,.01)

"KRN",.402,1404,-1)
0^1
"KRN",.402,1404,0)
SRPARAM^3050623.0945^^133^^^3050623
"KRN",.402,1404,"DIAB",1,0,133,0)
3;T
"KRN",.402,1404,"DIAB",1,1,133.027,0)
.01;T
"KRN",.402,1404,"DIAB",1,1,133.028,0)
.01;T
"KRN",.402,1404,"DIAB",2,0,133,0)
6;T
"KRN",.402,1404,"DIAB",2,1,133.028,0)
1;T
"KRN",.402,1404,"DIAB",3,0,133,0)
41;T
"KRN",.402,1404,"DIAB",4,0,133,0)
9;T
"KRN",.402,1404,"DIAB",5,0,133,0)
10;T
"KRN",.402,1404,"DIAB",6,0,133,0)
11;T
"KRN",.402,1404,"DIAB",7,0,133,0)
13;T
"KRN",.402,1404,"DIAB",8,0,133,0)
29;T
"KRN",.402,1404,"DIAB",9,0,133,0)
15;T
"KRN",.402,1404,"DIAB",10,0,133,0)
17;T
"KRN",.402,1404,"DIAB",11,0,133,0)
18.5;T
"KRN",.402,1404,"DIAB",12,0,133,0)
33;T
"KRN",.402,1404,"DIAB",14,0,133,0)
28;T
"KRN",.402,1404,"DIAB",15,0,133,0)
20;T
"KRN",.402,1404,"DIAB",16,0,133,0)
21;T
"KRN",.402,1404,"DIAB",17,0,133,0)
22;T
"KRN",.402,1404,"DIAB",18,0,133,0)
23;T
"KRN",.402,1404,"DIAB",19,0,133,0)
24;T
"KRN",.402,1404,"DIAB",20,0,133,0)
25;T
"KRN",.402,1404,"DIAB",21,0,133,0)
26;T
"KRN",.402,1404,"DIAB",22,0,133,0)
27;T
"KRN",.402,1404,"DIAB",23,0,133,0)
35;T
"KRN",.402,1404,"DIAB",24,0,133,0)
37;T
"KRN",.402,1404,"DIAB",25,0,133,0)
40;T
"KRN",.402,1404,"DIAB",26,0,133,0)
42;T
"KRN",.402,1404,"DR",1,133)
3T~;6T~;41T~;9T~;10T~;11T~;13T~;29T~;15T~;17T~;18.5T~;33T~;Q;Q;Q;28T~;20T~;21T~;22T~;23T~;24T~;25T~;26T~;27T~;35T~;37T~;40T~;42T~;
"KRN",.402,1404,"DR",2,133.027)
.01T~;
"KRN",.402,1404,"DR",2,133.028)
.01T~;1T~;
"MBREQ")
0
"ORD",7,.402)
.402;7;;;EDEOUT^DIFROMSO(.402,DA,"",XPDA);FPRE^DIFROMSI(.402,"",XPDA);EPRE^DIFROMSI(.402,DA,$E("N",$G(XPDNEW)),XPDA,"",OLDA);;EPOST^DIFROMSI(.402,DA,"",XPDA);DEL^DIFROMSK(.402,"",%)
"ORD",7,.402,0)
INPUT TEMPLATE
"PKG",167,-1)
1^1
"PKG",167,0)
SURGERY^SR^SURGICAL DATA COLLECTION AND OPERATIONS SCHEDULING
"PKG",167,20,0)
^9.402P^^
"PKG",167,22,0)
^9.49I^1^1
"PKG",167,22,1,0)
3.0^3040426^2930811
"PKG",167,22,1,"PAH",1,0)
150^3051205^517
"PKG",167,22,1,"PAH",1,1,0)
^^1^1^3051205
"PKG",167,22,1,"PAH",1,1,1,0)
THIS PATCH CORRECTS FOUR ISSUES RELATED TO CIDC.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
5
"RTN","SROADX")
0^1^B91763601
"RTN","SROADX",1,0)
SROADX ;BIR/RJS - ASSOCIATED DIAGNOSIS FOR CODER AND VERIFY SCREENS ;11/22/05
"RTN","SROADX",2,0)
 ;;3.0;Surgery;**119,150**;24 Jun 93
"RTN","SROADX",3,0)
CASDX ;Associate/Delete "Primary" CPT to Diagnosis from the CPT Coding menu. 
"RTN","SROADX",4,0)
 N SRDX0,SRDX1,SRDX2,SROANS,SRODIR,SRDIRX,OTHCNT,SRASSDS
"RTN","SROADX",5,0)
 S S("OP")=^SRF(SRTN,"OP"),CPT=$P(S("OP"),U,2),SROPER=$P(S("OP"),U)
"RTN","SROADX",6,0)
 Q:'CPT
"RTN","SROADX",7,0)
 K DIR
"RTN","SROADX",8,0)
 D HDR^SROVER2
"RTN","SROADX",9,0)
 D CPTDISP^SROADX1,ASDX^SROADX1,ADXPRMT
"RTN","SROADX",10,0)
 Q:($G(Y(0))="")!($G(Y(0))="QUIT")
"RTN","SROADX",11,0)
 K DIR
"RTN","SROADX",12,0)
 S Y=$P(SROLST,",",Y)
"RTN","SROADX",13,0)
 S SROANS=Y
"RTN","SROADX",14,0)
 S SRODIR("A",1)="   Select the number(s) of the Diagnosis Code appropriate for this procedure"
"RTN","SROADX",15,0)
 S SRODIR("A")="     ("_SRTXT_")"
"RTN","SROADX",16,0)
 S:$G(SROANS)="D" SRODIR("A",1)="   Select the number(s) of the Diagnosis Code(s) to delete from this procedure"
"RTN","SROADX",17,0)
 D HDR^SROVER2
"RTN","SROADX",18,0)
 D CPTDISP^SROADX1,ASDX^SROADX1
"RTN","SROADX",19,0)
 S Y=SROANS
"RTN","SROADX",20,0)
 I Y="D" D
"RTN","SROADX",21,0)
 .W !,?8,SRDXCNT,". ALL"
"RTN","SROADX",22,0)
 .S DIR(0)=SRDX1,DIR("A")=SRODIR("A"),DIR("A",1)="",DIR("A",2)=SRODIR("A",1)
"RTN","SROADX",23,0)
 .F I=1:1 D ^DIR Q:$$VALASC()
"RTN","SROADX",24,0)
 .Q:(Y["^")!(Y="")!($P(Y,",",1)=0)
"RTN","SROADX",25,0)
 .I +Y(0)'=SRDXCNT D PDEL1^SROADX1
"RTN","SROADX",26,0)
 .I +Y(0)=SRDXCNT D PDELALL^SROADX1
"RTN","SROADX",27,0)
 I Y="A" D
"RTN","SROADX",28,0)
 .K DIR
"RTN","SROADX",29,0)
 .D SRODIR^SROADX1
"RTN","SROADX",30,0)
 .W ! F I=1:1:80 W "-"
"RTN","SROADX",31,0)
 .S DIR(0)=SRDX2
"RTN","SROADX",32,0)
 .S SRASSDS=$$PASSDS^SROADX1
"RTN","SROADX",33,0)
 .S DIR("B")=SRASSDS
"RTN","SROADX",34,0)
 .F I=1:1 D ^DIR Q:(($$VALASC())&('$$DXDUP(Y)))
"RTN","SROADX",35,0)
 .Q:(Y["^")!(Y="")!($P(Y,",",1)=0)
"RTN","SROADX",36,0)
 .I SRDIRX(+Y(0))'="ALL" D PADD1^SROADX1 Q
"RTN","SROADX",37,0)
 .I SRDIRX(+Y(0))="ALL" D PADDALL^SROADX1 Q
"RTN","SROADX",38,0)
 Q:Y="Q"!(Y["")
"RTN","SROADX",39,0)
 G CASDX
"RTN","SROADX",40,0)
 Q
"RTN","SROADX",41,0)
COTHADX D COTHBLD^SROADX1        ;Associate/Delete "Other" CPTs to Diagnosis from CPT/CODE menu.
"RTN","SROADX",42,0)
 N SRDX0,SRDX1,SRDX2,SRDIR,OTHCNT,SRASSDS
"RTN","SROADX",43,0)
 D HDR^SROVER2
"RTN","SROADX",44,0)
 S OTHCNT=SRDA
"RTN","SROADX",45,0)
 K DIR
"RTN","SROADX",46,0)
 D OTHCPTD^SROADX1
"RTN","SROADX",47,0)
 D OTHADX^SROADX1,ADXPRMT
"RTN","SROADX",48,0)
 Q:($G(Y(0))="")!($G(Y(0))="QUIT")
"RTN","SROADX",49,0)
 S SRODIR("A",1)="   Select the number(s) of the Diagnosis Code appropriate for this procedure"
"RTN","SROADX",50,0)
 S SRODIR("A")="     ("_$G(SRSHT)_")"
"RTN","SROADX",51,0)
 S:$G(Y(0))="DELETE" SRODIR("A",1)="   Select the number(s) of the Diagnosis Code(s) to delete from this procedure"
"RTN","SROADX",52,0)
 K DIR
"RTN","SROADX",53,0)
 S Y=$P(SROLST,",",Y)
"RTN","SROADX",54,0)
 S SROANS=Y
"RTN","SROADX",55,0)
 W @IOF
"RTN","SROADX",56,0)
 D OTHCPTD^SROADX1
"RTN","SROADX",57,0)
 D OTHADX^SROADX1
"RTN","SROADX",58,0)
 S Y=SROANS
"RTN","SROADX",59,0)
 I Y="D" D
"RTN","SROADX",60,0)
 .W !,?8,SRDXCNT,". ALL"
"RTN","SROADX",61,0)
 .S DIR(0)=SRDX1,DIR("A")=SRODIR("A"),DIR("A",1)="",DIR("A",2)=SRODIR("A",1)
"RTN","SROADX",62,0)
 .F I=1:1 D ^DIR Q:$$VALASC()
"RTN","SROADX",63,0)
 .Q:(Y["^")!(Y="")!($P(Y,",",1)=0)
"RTN","SROADX",64,0)
 .I +Y(0)=SRDXCNT D
"RTN","SROADX",65,0)
 ..W !,"ARE YOU SRE YOU WANT TO DELETE ALL ? (Y/N) "
"RTN","SROADX",66,0)
 ..S %=2 D YN^DICN
"RTN","SROADX",67,0)
 ..I %=1 Q:$E($G(IOST))'="C"!($G(DIK)'="")  D KOADX^SROADX2(SRTN,OTH)
"RTN","SROADX",68,0)
 ..W @IOF
"RTN","SROADX",69,0)
 ..S OTHCNT=SRDA
"RTN","SROADX",70,0)
 .I +Y(0)'=SRDXCNT D
"RTN","SROADX",71,0)
 ..S DIR(0)=SRDX1,DIR("A")=SRODIR("A"),DIR("A",1)="",DIR("A",2)=SRODIR("A",1)
"RTN","SROADX",72,0)
 ..D ODEL1^SROADX1
"RTN","SROADX",73,0)
 ..W @IOF
"RTN","SROADX",74,0)
 .D OTHCPTD^SROADX1
"RTN","SROADX",75,0)
 I Y="A" D  G COTHADX
"RTN","SROADX",76,0)
 .K DIR
"RTN","SROADX",77,0)
 .D SRODIR^SROADX1
"RTN","SROADX",78,0)
 .W ! F I=1:1:80 W "-"
"RTN","SROADX",79,0)
 .S DIR(0)=SRDX2
"RTN","SROADX",80,0)
 .S SRASSDS=$$OASSDS^SROADX1
"RTN","SROADX",81,0)
 .S DIR("B")=SRASSDS
"RTN","SROADX",82,0)
 .F I=1:1 D ^DIR Q:(($$VALASC())&('$$DXDUP(Y)))
"RTN","SROADX",83,0)
 .Q:(Y["^")!(Y="")!($P(Y,",",1)=0)
"RTN","SROADX",84,0)
 .I SRDIRX(+Y(0))="ALL",SRDX0'="SO^1:ASSOCIATE;2:DELETE;3:QUIT" D  Q
"RTN","SROADX",85,0)
 ..D OADDALL^SROADX1
"RTN","SROADX",86,0)
 .I SRDIRX(+Y(0))="ALL",SRDX0="SO^1:ASSOCIATE;2:DELETE;3:QUIT" D  Q
"RTN","SROADX",87,0)
 ..D OADD1^SROADX1
"RTN","SROADX",88,0)
 .I SRDIRX(+Y(0))'="ALL" D
"RTN","SROADX",89,0)
 ..D OADD1^SROADX1
"RTN","SROADX",90,0)
 .W @IOF
"RTN","SROADX",91,0)
 .D OTHCPTD^SROADX1
"RTN","SROADX",92,0)
 .D OTHADX^SROADX1
"RTN","SROADX",93,0)
 Q:Y="Q"!(Y["")
"RTN","SROADX",94,0)
 G COTHADX
"RTN","SROADX",95,0)
 Q
"RTN","SROADX",96,0)
VASDX         ;Associate/Delete PRINCIPAL CPTs to Diagnosis from Physician's Verify menu.
"RTN","SROADX",97,0)
 N SRDX0,SRDX1,SRDX2,SROANS,SRODIR,SRDIRX,SRASSDS
"RTN","SROADX",98,0)
 K DIR
"RTN","SROADX",99,0)
 W @IOF
"RTN","SROADX",100,0)
 S DIR("?")="^D VHELP^SROADX"
"RTN","SROADX",101,0)
 S DIR("??")="^D VHELP1^SROADX"
"RTN","SROADX",102,0)
 D CPTDISP^SROADX1,ASDX^SROADX1,ADXPRMT
"RTN","SROADX",103,0)
 Q:($G(Y(0))="")!($G(Y(0))="QUIT")
"RTN","SROADX",104,0)
 S SRODIR("A",1)="   Select the number(s) of the Diagnosis Code appropriate for this procedure"
"RTN","SROADX",105,0)
 S SRODIR("A")="     ("_SROCPT2_")"
"RTN","SROADX",106,0)
 S:$G(Y(0))="DELETE" SRODIR("A",1)="   Select the number(s) of the Diagnosis Code(s) to delete from this procedure"
"RTN","SROADX",107,0)
 K DIR
"RTN","SROADX",108,0)
 S Y=$P(SROLST,",",Y)
"RTN","SROADX",109,0)
 S SROANS=Y
"RTN","SROADX",110,0)
 W @IOF
"RTN","SROADX",111,0)
 D CPTDISP^SROADX1,ASDX^SROADX1
"RTN","SROADX",112,0)
 S Y=SROANS
"RTN","SROADX",113,0)
 I Y="D" D
"RTN","SROADX",114,0)
 .W !,?8,SRDXCNT,". ALL"
"RTN","SROADX",115,0)
 .S DIR(0)=SRDX1,DIR("A")=SRODIR("A"),DIR("A",1)="",DIR("A",2)=SRODIR("A",1)
"RTN","SROADX",116,0)
 .S DIR("?")="^D DHELP^SROADX"
"RTN","SROADX",117,0)
 .S DIR("??")="^D PHELP^SROADX"
"RTN","SROADX",118,0)
 .F I=1:1 D ^DIR Q:$$VALASC()
"RTN","SROADX",119,0)
 .Q:(Y["^")!(Y="")!($P(Y,",",1)=0)
"RTN","SROADX",120,0)
 .I +Y(0)=SRDXCNT D PDELALL^SROADX1 Q
"RTN","SROADX",121,0)
 .I +Y(0)'=SRDXCNT D PDEL1^SROADX1 Q
"RTN","SROADX",122,0)
 I Y="A" D
"RTN","SROADX",123,0)
 .K DIR
"RTN","SROADX",124,0)
 .D SRODIR^SROADX1
"RTN","SROADX",125,0)
 .W ! F I=1:1:80 W "-"
"RTN","SROADX",126,0)
 .S DIR("?")="^D AHELP^SROADX"
"RTN","SROADX",127,0)
 .S DIR("??")="^D PHELP^SROADX"
"RTN","SROADX",128,0)
 .S SRASSDS=$$PASSDS^SROADX1
"RTN","SROADX",129,0)
 .S DIR("B")=SRASSDS
"RTN","SROADX",130,0)
 .S DIR(0)=SRDX2
"RTN","SROADX",131,0)
 .F I=1:1 D ^DIR Q:(($$VALASC())&('$$DXDUP(Y)))
"RTN","SROADX",132,0)
 .Q:(Y["^")!(Y="")!($P(Y,",",1)=0)
"RTN","SROADX",133,0)
 .I SRDIRX(+Y(0))'="ALL" D PADD1^SROADX1 Q
"RTN","SROADX",134,0)
 .I SRDIRX(+Y(0))="ALL" D PADDALL^SROADX1 Q
"RTN","SROADX",135,0)
 G VASDX
"RTN","SROADX",136,0)
 Q
"RTN","SROADX",137,0)
NOTHADX S OTH=DA,OTHCNT=CNT
"RTN","SROADX",138,0)
 S SRSEL(CNT)=OTH_U_$G(OTHER)_"^CPT Code: "_CPT_U_$G(CPT1)
"RTN","SROADX",139,0)
VOTHADX N SRDX0,SRDX1,SRDX2,SRDIR,SRASSDS        ;Associate/Delete OTHER Diagnosis to CPTs from Physician's Verify menu.
"RTN","SROADX",140,0)
 Q:'$D(^SRF(SRTN,13,OTH))
"RTN","SROADX",141,0)
 W @IOF
"RTN","SROADX",142,0)
 K DIR
"RTN","SROADX",143,0)
 D OTHCPTD^SROADX1,OTHADX^SROADX1,ADXPRMT
"RTN","SROADX",144,0)
 Q:($G(Y(0))="")!($G(Y(0))="QUIT")
"RTN","SROADX",145,0)
 S SRODIR("A",1)="   Select the number(s) of the Diagnosis Code appropriate for this procedure"
"RTN","SROADX",146,0)
 S SRODIR("A")="     ("_$G(SRSHT)_")"
"RTN","SROADX",147,0)
 S:$G(Y(0))="DELETE" SRODIR("A",1)="   Select the number(s) of the Diagnosis Code(s) to delete from this procedure"
"RTN","SROADX",148,0)
 K DIR
"RTN","SROADX",149,0)
 S Y=$P(SROLST,",",Y)
"RTN","SROADX",150,0)
 S SROANS=Y
"RTN","SROADX",151,0)
 W @IOF
"RTN","SROADX",152,0)
 D OTHCPTD^SROADX1
"RTN","SROADX",153,0)
 D OTHADX^SROADX1
"RTN","SROADX",154,0)
 S Y=SROANS
"RTN","SROADX",155,0)
 I Y="D" D
"RTN","SROADX",156,0)
 .W !,?8,SRDXCNT,". ALL"
"RTN","SROADX",157,0)
 .S DIR("?")="^D DHELP^SROADX"
"RTN","SROADX",158,0)
 .S DIR("??")="^D OHELP^SROADX"
"RTN","SROADX",159,0)
 .S DIR(0)=SRDX1,DIR("A")=SRODIR("A"),DIR("A",1)="",DIR("A",2)=SRODIR("A",1)
"RTN","SROADX",160,0)
 .F I=1:1 D ^DIR Q:$$VALASC()
"RTN","SROADX",161,0)
 .Q:(Y["^")!(Y="")!($P(Y,",",1)=0)
"RTN","SROADX",162,0)
 .I +Y(0)=SRDXCNT D
"RTN","SROADX",163,0)
 ..W !,"ARE YOU SRE YOU WANT TO DELETE ALL ? (Y/N) "
"RTN","SROADX",164,0)
 ..S %=2 D YN^DICN
"RTN","SROADX",165,0)
 ..I %=1 Q:$E($G(IOST))'="C"!($G(DIK)'="")  D KOADX^SROADX2(SRTN,OTH)
"RTN","SROADX",166,0)
 .I +Y(0)'=SRDXCNT D  Q
"RTN","SROADX",167,0)
 ..S DIR(0)=SRDX1,DIR("A")=SRODIR("A"),DIR("A",1)=""
"RTN","SROADX",168,0)
 ..W ! F I=1:1:80 W "-"
"RTN","SROADX",169,0)
 ..S DIR("A",2)=SRODIR("A",1)
"RTN","SROADX",170,0)
 ..D ODEL1^SROADX1
"RTN","SROADX",171,0)
 .W @IOF
"RTN","SROADX",172,0)
 .D OTHCPTD^SROADX1
"RTN","SROADX",173,0)
 I Y="A" D
"RTN","SROADX",174,0)
 .K DIR
"RTN","SROADX",175,0)
 .D SRODIR^SROADX1
"RTN","SROADX",176,0)
 .W ! F I=1:1:80 W "-"
"RTN","SROADX",177,0)
 .S DIR("?")="^D AHELP^SROADX"
"RTN","SROADX",178,0)
 .S DIR("??")="^D OHELP^SROADX"
"RTN","SROADX",179,0)
 .S SRASSDS=$$OASSDS^SROADX1
"RTN","SROADX",180,0)
 .S DIR("B")=SRASSDS
"RTN","SROADX",181,0)
 .S DIR(0)=SRDX2
"RTN","SROADX",182,0)
 .F I=1:1 D ^DIR Q:(($$VALASC())&('$$DXDUP(Y)))
"RTN","SROADX",183,0)
 .Q:(Y["^")!(Y="")!($P(Y,",",1)=0)
"RTN","SROADX",184,0)
 .I SRDIRX(+Y(0))="ALL" D OADDALL^SROADX1 Q
"RTN","SROADX",185,0)
 .I SRDIRX(+Y(0))'="ALL" D OADD1^SROADX1 Q
"RTN","SROADX",186,0)
 G VOTHADX
"RTN","SROADX",187,0)
 Q
"RTN","SROADX",188,0)
OHELP ;
"RTN","SROADX",189,0)
 W !!,?5,"The Other Associated Diagnosis is used to associate a diagnosis"
"RTN","SROADX",190,0)
 W !,?5,"or a group of diagnoses to the Other Procedures"
"RTN","SROADX",191,0)
 Q
"RTN","SROADX",192,0)
PHELP ;
"RTN","SROADX",193,0)
 W !!,?5,"The Principal Associated Diagnosis is used to associate a diagnosis"
"RTN","SROADX",194,0)
 W !,?5,"or a group of diagnoses to the Principal CPT Code"
"RTN","SROADX",195,0)
 Q
"RTN","SROADX",196,0)
DHELP ;
"RTN","SROADX",197,0)
 W !!,?5,"Please enter a list or range, e.g.,2, or 2,3 or 1-3"
"RTN","SROADX",198,0)
 W !,?5,"from the above list to be Deleted."
"RTN","SROADX",199,0)
 Q
"RTN","SROADX",200,0)
AHELP ;
"RTN","SROADX",201,0)
 W !!,?5,"Please enter a list or range, e.g.,2, or 2,3 or 1-3"
"RTN","SROADX",202,0)
 W !,?5,"from the above list to be Associated."
"RTN","SROADX",203,0)
 Q
"RTN","SROADX",204,0)
VHELP ;
"RTN","SROADX",205,0)
 W !!,?5
"RTN","SROADX",206,0)
 W:DIR("0")="SO^D:DELETE;Q:QUIT" "Select either D to Delete or Q to Quit"
"RTN","SROADX",207,0)
 W:DIR("0")="SO^A:ASSOCIATE;D:DELETE;Q:QUIT" "Select A to Associate, D to Delete or Q to Quit"
"RTN","SROADX",208,0)
 W:DIR("0")="SO^A:ASSOCIATE;Q:QUIT" "Select A to Associate or Q to Quit"
"RTN","SROADX",209,0)
 Q
"RTN","SROADX",210,0)
VHELP1 ;
"RTN","SROADX",211,0)
 W !!,?5
"RTN","SROADX",212,0)
 W:DIR("0")="SO^D:DELETE;Q:QUIT" "This will setup your choices for Deleting any Associated Diagnosis"
"RTN","SROADX",213,0)
 W:DIR("0")="SO^A:ASSOCIATE;D:DELETE;Q:QUIT" "This will setup your choices for Associating or Deleting any Associated Diagnosis"
"RTN","SROADX",214,0)
 W:DIR("0")="SO^A:ASSOCIATE;Q:QUIT" "This will setup your choices for Associating any Associated Diagnosis"
"RTN","SROADX",215,0)
 Q
"RTN","SROADX",216,0)
PINPUT ;
"RTN","SROADX",217,0)
 Q:$D(EMILY)
"RTN","SROADX",218,0)
 N SRC,SRDX
"RTN","SROADX",219,0)
 S SRC(1)="The Associated Diagnosis can only be added via the",SRC(1,"F")="!!?5"
"RTN","SROADX",220,0)
 S SRC(2)="Surgery Menu options.  Your entry has NOT been filed",SRC(2,"F")="!?5"
"RTN","SROADX",221,0)
 D EN^DDIOL(.SRC),CONT^SROADX1
"RTN","SROADX",222,0)
 K X
"RTN","SROADX",223,0)
 Q
"RTN","SROADX",224,0)
ADXPRMT ;
"RTN","SROADX",225,0)
 I SRDX1'="LO^:0",SRDX2'="LO^:0" S SRDX0="SO^1:ASSOCIATE;2:DELETE;3:QUIT",SROLST="A,D,Q",DIR("L")="   1  ASSOCIATE      2  DELETE    3  QUIT"
"RTN","SROADX",226,0)
 I SRDX1'="LO^:0",SRDX2="LO^:0" S SRDX0="SO^1:DELETE;2:QUIT",SROLST="D,Q",DIR("L")="         1  DELETE    2  QUIT"
"RTN","SROADX",227,0)
 I SRDX1="LO^:1",SRDX2'="LO^:0" S SRDX0="SO^1:ASSOCIATE;2:QUIT",SROLST="A,Q",DIR("L")="          1  ASSOCIATE    2  QUIT"
"RTN","SROADX",228,0)
 I SRDX1="LO^:0",SRDX2="LO^:0" S SRDX0="SO^1:QUIT",SROLST="A,Q",DIR("L")="          No Diagnosis to associate    1  QUIT"
"RTN","SROADX",229,0)
 S DIR(0)=SRDX0,DIR("L",1)="     Select one of the following:",DIR("L",2)=""
"RTN","SROADX",230,0)
 D ^DIR K DIR
"RTN","SROADX",231,0)
 Q
"RTN","SROADX",232,0)
DXDUP(SRDX) I (Y["^")!($G(DTOUT)) Q 0
"RTN","SROADX",233,0)
 N SRAI,SRDXX,SRDUP,DIR S SRDUP=0
"RTN","SROADX",234,0)
 I SRDX="" Q 0
"RTN","SROADX",235,0)
 F SRAI=1:1:$L(SRDX,",") D
"RTN","SROADX",236,0)
 .Q:$P(SRDX,",",SRAI)<1
"RTN","SROADX",237,0)
 .I $D(SRDXX($P(SRDX,",",SRAI)))!((SRDIRX($P(SRDX,",",SRAI))="ALL")&($L(SRDX,",")>2)) S SRDUP=1,DIR(0)="FO^",DIR("A",1)="     **Duplicates entered",DIR("A")="     Press Return to continue" D ^DIR
"RTN","SROADX",238,0)
 .S SRDXX($P(SRDX,",",SRAI))=""
"RTN","SROADX",239,0)
 Q SRDUP
"RTN","SROADX",240,0)
VALASC() I (Y["^")!('$G(Y(0)))!($G(DTOUT)) Q 1
"RTN","SROADX",241,0)
 N VALA,DIR S VALA=1
"RTN","SROADX",242,0)
 S:Y=""!(Y=U)!('+Y(0))!(Y[",0")!($P(Y,",",1)=0) VALA=0
"RTN","SROADX",243,0)
 I 'VALA S DIR("A",1)="     **Invalid input",DIR(0)="FO^",DIR("A")="     Press Return to continue" D ^DIR
"RTN","SROADX",244,0)
 Q VALA
"RTN","SROADX1")
0^4^B93981084
"RTN","SROADX1",1,0)
SROADX1 ;BIR/RJS - CONTINUED FROM SROADX ASSOCIATED DIAGNOSIS FOR CODER AND VERIFY SCREENS ;09/12/05 12:01pm
"RTN","SROADX1",2,0)
 ;;3.0;Surgery;**119,150**;24 Jun 93
"RTN","SROADX1",3,0)
OTHADX ;Display ASDX for OTHER PROCS
"RTN","SROADX1",4,0)
 K SRTMP,SRASSD,SROICD
"RTN","SROADX1",5,0)
 S SRPADX=0,SROCNTR=1
"RTN","SROADX1",6,0)
 F SRI=1:1 S SRPADX=$O(^SRF(SRTN,13,OTH,"OADX",SRPADX)) Q:'SRPADX  D
"RTN","SROADX1",7,0)
 .S SRASSD=^SRF(SRTN,13,OTH,"OADX",SRPADX,0)
"RTN","SROADX1",8,0)
 .D AASDX
"RTN","SROADX1",9,0)
 .S SRTMP(SRI)=SROICD,SROCNTR=SROCNTR+1
"RTN","SROADX1",10,0)
 S SROCNTR=0
"RTN","SROADX1",11,0)
 D ADXDISP
"RTN","SROADX1",12,0)
 I '$O(^SRF(SRTN,13,OTH,"OADX",0)) W !,?5,SRMSG,!
"RTN","SROADX1",13,0)
 D PASSDIAG
"RTN","SROADX1",14,0)
 D ASSDIAG
"RTN","SROADX1",15,0)
 Q
"RTN","SROADX1",16,0)
ASDX N SRI,SRFIRST,SRICD9,SRPRIN,SRPADX,SRASSD ;Display ASDX for PRIN Procs
"RTN","SROADX1",17,0)
 K SRTMP
"RTN","SROADX1",18,0)
 S SRI=0,SRFIRST=1
"RTN","SROADX1",19,0)
 F  S SRI=$O(^SRF(SRTN,"OPMOD",SRI)) Q:'SRI  S SRM=$P(^SRF(SRTN,"OPMOD",SRI,0),U)
"RTN","SROADX1",20,0)
 S SRPADX=0,SROCNTR=2
"RTN","SROADX1",21,0)
 F SRI=1:1 S SRPADX=$O(^SRF(SRTN,"PADX",SRPADX)) Q:'SRPADX  D
"RTN","SROADX1",22,0)
 .S SRASSD=^SRF(SRTN,"PADX",SRPADX,0)
"RTN","SROADX1",23,0)
 .D AASDX
"RTN","SROADX1",24,0)
 .S SRTMP(SRI)=SROICD,SROCNTR=SROCNTR+1
"RTN","SROADX1",25,0)
 D ADXDISP
"RTN","SROADX1",26,0)
 I '$O(^SRF(SRTN,"PADX",0)) W !,?5,SRMSG
"RTN","SROADX1",27,0)
 D PASSDIAG
"RTN","SROADX1",28,0)
 D ASSDIAG
"RTN","SROADX1",29,0)
 Q
"RTN","SROADX1",30,0)
AASDX S SROICD=""
"RTN","SROADX1",31,0)
 S:SRASSD SRICD9=$P($G(^SRF(SRTN,15,SRASSD,0)),U,3)
"RTN","SROADX1",32,0)
 S:'SRASSD SRICD9=$P($G(^SRF(SRTN,34)),U,2)
"RTN","SROADX1",33,0)
 S:SRICD9 SROICD=$$ICDSTR
"RTN","SROADX1",34,0)
 I 'SRICD9 D
"RTN","SROADX1",35,0)
 .S:SRASSD SROICD=$P($G(^SRF(SRTN,15,SRASSD,0)),U)
"RTN","SROADX1",36,0)
 .S:'SRASSD SROICD=$P($G(^SRF(SRTN,34)),U,1)
"RTN","SROADX1",37,0)
 Q
"RTN","SROADX1",38,0)
PASSDIAG N ADCNT,SRICD9,SRFLG,SRCNTR,SRASSD  ;List PRIN DX to assoc.
"RTN","SROADX1",39,0)
 K SRADX,SRDIRX,SRADIAG
"RTN","SROADX1",40,0)
 S SRICD9=$P($G(^SRF(SRTN,34)),U,2)
"RTN","SROADX1",41,0)
 I SRICD9'="" S SRDIRX(1)=$$ICDSTR,SRADX(1)=$P(^ICD9(SRICD9,0),U,1),SRADIAG(1)=0
"RTN","SROADX1",42,0)
 I SRICD9="" S SRDIRX(1)=$P($G(^SRF(SRTN,34)),U,1),SRADIAG(1)=0
"RTN","SROADX1",43,0)
 Q
"RTN","SROADX1",44,0)
ASSDIAG N SRDCNT,SRADCNT,SRQ ;DXs for assoc.
"RTN","SROADX1",45,0)
 S (ADCNT,SRASSD)=0,SRCNT=2
"RTN","SROADX1",46,0)
 F  S ADCNT=$O(^SRF(SRTN,15,ADCNT)) Q:ADCNT=""  D
"RTN","SROADX1",47,0)
 .S SRICD9=$P(^SRF(SRTN,15,ADCNT,0),U,3)
"RTN","SROADX1",48,0)
 .S:SRICD9'="" SRDIRX(SRCNT)=$$ICDSTR,SRADX(SRCNT)=$P(^ICD9(SRICD9,0),U,1)
"RTN","SROADX1",49,0)
 .S:SRICD9="" SRDIRX(SRCNT)=$P(^SRF(SRTN,15,ADCNT,0),U,1)
"RTN","SROADX1",50,0)
 .S SRADIAG(SRCNT)=ADCNT,SRCNT=SRCNT+1
"RTN","SROADX1",51,0)
 S SRDX2="LO^:0"
"RTN","SROADX1",52,0)
 I (ADCNT<$$SRDIAGS) D
"RTN","SROADX1",53,0)
 .S:(SRCNT>2) SRDIRX(SRCNT)="ALL"
"RTN","SROADX1",54,0)
 .S:$D(SRDIRX) SRDX2="LO^:"_SRCNT
"RTN","SROADX1",55,0)
 .S:$$SRDIAGS=1 SRDX2="LO^:"_(SRCNT-1)
"RTN","SROADX1",56,0)
 Q
"RTN","SROADX1",57,0)
SRDIAGS() N SRDIAGS,SRDGCNT
"RTN","SROADX1",58,0)
 S (SRDIAGS,SRDGCNT)=0
"RTN","SROADX1",59,0)
 S:($P($G(^SRF(SRTN,34)),U)'="")!($P($G(^SRF(SRTN,34)),U,2)) SRDIAGS=1
"RTN","SROADX1",60,0)
 F I=1:1 S SRDGCNT=$O(^SRF(SRTN,15,SRDGCNT)) Q:SRDGCNT=""  S SRDIAGS=SRDIAGS+1
"RTN","SROADX1",61,0)
 Q SRDIAGS
"RTN","SROADX1",62,0)
ICDSTR() N SRICDSTR
"RTN","SROADX1",63,0)
 S SRICDSTR=$P($$ICDDX^ICDCODE(SRICD9,SRSDATE),U,2)_"-"_$P($$ICDDX^ICDCODE(SRICD9,SRSDATE),U,4)
"RTN","SROADX1",64,0)
 Q SRICDSTR
"RTN","SROADX1",65,0)
PASSDS() N SRPADX,SRASSDS,SRPX
"RTN","SROADX1",66,0)
 S SRASSDS="",SRPADX=0
"RTN","SROADX1",67,0)
 F SRI=1:1 S SRPADX=$O(^SRF(SRTN,"PADX",SRPADX)) Q:'SRPADX  D
"RTN","SROADX1",68,0)
 .S SRPX=^SRF(SRTN,"PADX",SRPADX,0)
"RTN","SROADX1",69,0)
 .S SRPX=SRPX+1
"RTN","SROADX1",70,0)
 .S SRASSDS=$S($L(SRASSDS)<1:SRPX,1:SRASSDS_","_SRPX)
"RTN","SROADX1",71,0)
 Q SRASSDS
"RTN","SROADX1",72,0)
OASSDS() N SRPADX,SRASSDS,SRPX
"RTN","SROADX1",73,0)
 S SRASSDS="",SRPADX=0
"RTN","SROADX1",74,0)
 F SRI=1:1 S SRPADX=$O(^SRF(SRTN,13,D0,"OADX",SRPADX)) Q:'SRPADX  D
"RTN","SROADX1",75,0)
 .S SRPX=^SRF(SRTN,13,D0,"OADX",SRPADX,0)
"RTN","SROADX1",76,0)
 .S SRPX=SRPX+1
"RTN","SROADX1",77,0)
 .S SRASSDS=$S($L(SRASSDS)<1:SRPX,1:SRASSDS_","_SRPX)
"RTN","SROADX1",78,0)
 Q SRASSDS
"RTN","SROADX1",79,0)
SRODIR N SRFLG,SRCNT,SRCNTR
"RTN","SROADX1",80,0)
 S DIR("A",1)=""
"RTN","SROADX1",81,0)
 S (SRFLG,SRCNT)=1,SRCNTR=2,ADCNT=""
"RTN","SROADX1",82,0)
 F  S ADCNT=$O(SRDIRX(ADCNT)) Q:'ADCNT  D
"RTN","SROADX1",83,0)
 .S:'$D(DIR("A",SRCNTR)) DIR("A",SRCNTR)=""
"RTN","SROADX1",84,0)
 .S DIR("A",SRCNTR)=DIR("A",SRCNTR)_SRCNT_". "_SRDIRX(ADCNT),SRCNT=SRCNT+1,SRCNTR=SRCNTR+1,SRFLG=1
"RTN","SROADX1",85,0)
 S DIR("A",SRCNTR+2)=SRODIR("A",1),DIR("A")=SRODIR("A"),DIR("A",SRCNTR+1)=""
"RTN","SROADX1",86,0)
 Q
"RTN","SROADX1",87,0)
COTHBLD N SRCNT,OTH,X,CPT,CPT1,SRDA K SRSEL
"RTN","SROADX1",88,0)
 S OTH=0,SRCNT=1
"RTN","SROADX1",89,0)
 F  S OTH=$O(^SRF(SRTN,13,OTH)) Q:'OTH  D
"RTN","SROADX1",90,0)
 .S OTHER=$P(^SRF(SRTN,13,OTH,0),U)
"RTN","SROADX1",91,0)
 .S X=$P($G(^SRF(SRTN,13,OTH,2)),U),CPT="NOT ENTERED",CPT1=""
"RTN","SROADX1",92,0)
 .I X S CPT1=X,Y=$$CPT^ICPTCOD(X),SRCPT=$P(Y,U,2),SRSHT=$P(Y,U,3),Y=SRCPT,SRDA=OTH D SSOTH^SROCPT S SRCPT=Y,CPT=SRCPT_"  "_SRSHT
"RTN","SROADX1",93,0)
 .S SRSEL(SRCNT)=OTH_U_OTHER_"^CPT Code: "_CPT_U_CPT1
"RTN","SROADX1",94,0)
 .S SRCNT=SRCNT+1
"RTN","SROADX1",95,0)
 Q
"RTN","SROADX1",96,0)
OTHADXD N SRCOMMA,SROADX,SRICD9,SROADX1,SROODX,SRASSD,SRSUB ;OTHER PROCS ADXs
"RTN","SROADX1",97,0)
 I '$O(^SRF(SRTN,13,OTH,"OADX",0)) W !,?5,SRMSG Q
"RTN","SROADX1",98,0)
 S SRSUB=1
"RTN","SROADX1",99,0)
 D OTHADX
"RTN","SROADX1",100,0)
 Q
"RTN","SROADX1",101,0)
PADXD N SRCOMMA,SRPADX,SRICD9,SRPDX,SRPDX1,SROPRIN,SRSUB
"RTN","SROADX1",102,0)
 S SRPADX=0,SROCNTR=2,SRSUB=1
"RTN","SROADX1",103,0)
 D ADXCHK^SROADX2
"RTN","SROADX1",104,0)
 I '$O(^SRF(SRTN,"PADX",0)),(($P($G(^SRF(SRTN,34)),U)'="")!($P($G(^SRF(SRTN,34)),U,2))),(($P($G(^SRF(SRTN,"OP")),U)'="")!($P($G(^SRF(SRTN,"OP")),U,2))) D
"RTN","SROADX1",105,0)
 .S SRASSD=0,SRFDA="130.275",SRIENU="+1"_","_SRTN_",",SRIENF=0_","_SRTN_"," D UPDATE,FILE
"RTN","SROADX1",106,0)
 D ASDX
"RTN","SROADX1",107,0)
 Q
"RTN","SROADX1",108,0)
ADXDISP N SROCNTR ;ADXS for PROC
"RTN","SROADX1",109,0)
 W !,?5,"Assoc. DX: "
"RTN","SROADX1",110,0)
 S (SROCNTR,SRDXCNT)=0
"RTN","SROADX1",111,0)
 F I=1:1  S SROCNTR=$O(SRTMP(SROCNTR)) Q:'SROCNTR  D
"RTN","SROADX1",112,0)
 .I $D(SRSUB) D
"RTN","SROADX1",113,0)
 ..W:'(I#2) ?48
"RTN","SROADX1",114,0)
 ..W:I#2 ?16
"RTN","SROADX1",115,0)
 ..W I,". ",$E(SRTMP(SROCNTR),1,25)
"RTN","SROADX1",116,0)
 ..I '(I#2),($O(SRTMP(SROCNTR))) W !
"RTN","SROADX1",117,0)
 .W:'$D(SRSUB) !,?8,I,". ",SRTMP(SROCNTR)
"RTN","SROADX1",118,0)
 S SRDXCNT=I
"RTN","SROADX1",119,0)
 S SRDX1="LO^:"_SRDXCNT
"RTN","SROADX1",120,0)
 S:SRDXCNT>0 SRDX1="LO^:"_SRDXCNT
"RTN","SROADX1",121,0)
 Q
"RTN","SROADX1",122,0)
OTHCPTD N SRM,SRI,SRFIRST ;PROCS/Codes/Mods.
"RTN","SROADX1",123,0)
 S SRFIRST=0
"RTN","SROADX1",124,0)
 W !,?3,"Other Procedures:",!!,OTHCNT,"."
"RTN","SROADX1",125,0)
 D COTHBLD
"RTN","SROADX1",126,0)
 W ?3,$P(SRSEL(SRDA),U,2),!,?2,"Other ",$P(SRSEL(SRDA),U,3)
"RTN","SROADX1",127,0)
 S OTH=$P(SRSEL(SRDA),U) K SRDES S CPT1=$P(SRSEL(SRDA),U,4),X=$$CPTD^ICPTCOD(CPT1,"SRDES") I $O(SRDES(0)) F I=1:1:X W !,?4,SRDES(I)
"RTN","SROADX1",128,0)
 W !,?3,"Modifiers: "
"RTN","SROADX1",129,0)
 S SRI=0
"RTN","SROADX1",130,0)
 F  S SRI=$O(^SRF(SRTN,13,OTH,"MOD",SRI)) Q:'SRI  D
"RTN","SROADX1",131,0)
 .S SRM=$P(^SRF(SRTN,13,OTH,"MOD",SRI,0),U)
"RTN","SROADX1",132,0)
 .W:SRFIRST !,?14
"RTN","SROADX1",133,0)
 .W $P($$MOD^ICPTMOD(SRM,"I"),"^",2),"-",$P($$MOD^ICPTMOD(SRM,"I"),"^",3)
"RTN","SROADX1",134,0)
 .S SRFIRST=1
"RTN","SROADX1",135,0)
 Q
"RTN","SROADX1",136,0)
CPTDISP S X=$P(^SRF(SRTN,"OP"),U,2) I X D  W !
"RTN","SROADX1",137,0)
 .S SRY=$$CPT^ICPTCOD(X),Y=$P(SRY,U,2),(SROCPT2,Z)=$P(SRY,U,3)
"RTN","SROADX1",138,0)
 S:'$D(Y) Y="NOT ENTERED",Z=""
"RTN","SROADX1",139,0)
 W "  CPT Code: "_Y_"  ",Z,!,"  Description:" D ^SROCPT W ! F I=1:1:80 W "-"
"RTN","SROADX1",140,0)
 W !,?3,"Principal CPT Code: "_Y_"  ",!,?3,"Description:",Z,!,?3,"Modifiers: "
"RTN","SROADX1",141,0)
 S SRMOD=0
"RTN","SROADX1",142,0)
 F  S SRMOD=$O(^SRF(SRTN,"OPMOD",SRMOD)) Q:'SRMOD  D
"RTN","SROADX1",143,0)
 .S SRMO=$P(^SRF(SRTN,"OPMOD",SRMOD,0),U)
"RTN","SROADX1",144,0)
 .W:$G(SRFIRST) !,?14
"RTN","SROADX1",145,0)
 .W $P($$MOD^ICPTMOD(SRMO,"I"),"^",2),"-",$P($$MOD^ICPTMOD(SRMO,"I"),"^",3)
"RTN","SROADX1",146,0)
 .S SRFIRST=1
"RTN","SROADX1",147,0)
 Q
"RTN","SROADX1",148,0)
PADDALL Q:$E($G(IOST))'="C"!($G(DIK)'="")
"RTN","SROADX1",149,0)
 D KPADX^SROADX2(DA)
"RTN","SROADX1",150,0)
 N DIE,DR,DA,PADX,SRY,SRY1,SRICD9,SRCNTRN,SRIENU,SRIENF,SRASSD
"RTN","SROADX1",151,0)
 S SRY(0)=Y(0),SRFDA="130.275",SRIENU="+1"_","_SRTN_","
"RTN","SROADX1",152,0)
 S SRICD9=$P($G(^SRF(SRTN,34)),U,2),SRCNTR=1,SRIENF=SRCNTR_","_SRTN_",",SRASSD=0
"RTN","SROADX1",153,0)
 K SRY1 D UPDATE,FILE
"RTN","SROADX1",154,0)
 S PADX=0
"RTN","SROADX1",155,0)
 F  S PADX=$O(^SRF(SRTN,15,PADX)) Q:'PADX  S SRASSD=PADX,SRICD9=$P(^SRF(SRTN,15,SRASSD,0),U,3),SRCNTR=SRCNTR+1,SRIENF=SRCNTR_","_SRTN_"," K SRY1 D UPDATE,FILE
"RTN","SROADX1",156,0)
 S Y(0)=SRY(0)
"RTN","SROADX1",157,0)
 Q
"RTN","SROADX1",158,0)
PADD1 ;PRIN ADX
"RTN","SROADX1",159,0)
 N SRY,SRY0,SRY1,SRY2,SRC,REC,DIE,DA,DR,SRASSD
"RTN","SROADX1",160,0)
 S SRY(0)=Y(0)
"RTN","SROADX1",161,0)
 D KPADX^SROADX2(SRTN)
"RTN","SROADX1",162,0)
 S SRCNTR=0,SRASSD=SRADIAG($P(SRY(0),",",1)),SRFDA="130.275",SRIENU="+1"_","_SRTN_",",SRIENF=SRCNTR_","_SRTN_"," D UPDATE,FILE
"RTN","SROADX1",163,0)
 S SRY(0)=$E(SRY(0),2,$L(SRY(0)))
"RTN","SROADX1",164,0)
 F SRY2=1:1:$P(SRDX2,":",2) D
"RTN","SROADX1",165,0)
 .S SRY0=$P(SRY(0),",",SRY2)
"RTN","SROADX1",166,0)
 .Q:SRY0<1
"RTN","SROADX1",167,0)
 .S SRCNTR=$P(^SRF(SRTN,"PADX",0),U,3)+1,SRASSD=SRADIAG(SRY0),SRFDA="130.275",SRIENU="+1"_","_SRTN_",",SRIENF=SRCNTR_","_SRTN_"," D UPDATE,FILE
"RTN","SROADX1",168,0)
 S Y(0)=SRY(0)
"RTN","SROADX1",169,0)
 Q
"RTN","SROADX1",170,0)
UPDATE ;
"RTN","SROADX1",171,0)
 S SRY1(SRFDA,SRIENU,".01")=SRASSD
"RTN","SROADX1",172,0)
 D UPDATE^DIE("","SRY1")
"RTN","SROADX1",173,0)
 Q
"RTN","SROADX1",174,0)
FILE ;
"RTN","SROADX1",175,0)
 S SRY1(SRFDA,SRIENF,".01")=SRASSD
"RTN","SROADX1",176,0)
 D FILE^DIE("","SRY1")
"RTN","SROADX1",177,0)
 K SRY1
"RTN","SROADX1",178,0)
 Q
"RTN","SROADX1",179,0)
PDELALL W !,"Are you sure you want to DELETE ALL Associated Diagnoses ? (Y/N) "
"RTN","SROADX1",180,0)
 S SRY(0)=Y(0)
"RTN","SROADX1",181,0)
 S %=2 D YN^DICN
"RTN","SROADX1",182,0)
 I %=1 Q:$E($G(IOST))'="C"!($G(DIK)'="")  D KPADX^SROADX2(DA)
"RTN","SROADX1",183,0)
 S Y(0)=SRY(0)
"RTN","SROADX1",184,0)
 Q
"RTN","SROADX1",185,0)
PDEL1 N SRC,SRY,SRY1,SRY2,REC,SRICD9,SRASSD ;DEL 1 PRIN ADX
"RTN","SROADX1",186,0)
 S (SRY,SRY0)=0
"RTN","SROADX1",187,0)
 F  S SRY=$O(^SRF(SRTN,"PADX",SRY)) Q:'SRY  S SRY0=SRY0+1,REC(SRY0)=SRY
"RTN","SROADX1",188,0)
 S SRY(0)=Y(0),SRFDA="130.275"
"RTN","SROADX1",189,0)
 F SRY2=1:1:SRDXCNT D
"RTN","SROADX1",190,0)
 .S SRY0=$P(SRY(0),",",SRY2)
"RTN","SROADX1",191,0)
 .Q:'SRY0
"RTN","SROADX1",192,0)
 .Q:'$D(REC(SRY0))
"RTN","SROADX1",193,0)
 .I SRY0=1,$P(^SRF(SRTN,"PADX",0),U,4)>1 K SRC S SRC(1)="PLEASE DELETE ALL DIAGNOSIS BEFORE THE PRINCIPAL",SRC(1,"F")="!!?5" D SRCWRT K SRC Q 
"RTN","SROADX1",194,0)
 .S SRIENF=REC(SRY0)_","_SRTN_",",SRASSD="@"
"RTN","SROADX1",195,0)
 .W !,"Are you sure you want to DELETE ",SRTMP(SRY0)," ? (Y/N) "
"RTN","SROADX1",196,0)
 .S %=2 D YN^DICN
"RTN","SROADX1",197,0)
 .I %=1 D FILE
"RTN","SROADX1",198,0)
 S Y(0)=SRY(0)
"RTN","SROADX1",199,0)
 Q
"RTN","SROADX1",200,0)
ODEL1 N SRY,SRY0,SRY1,SRY2,SRASSD ;DEL 1 OTH ADX
"RTN","SROADX1",201,0)
 S (SRY,SRY0)=0
"RTN","SROADX1",202,0)
 F  S SRY=$O(^SRF(SRTN,13,OTH,"OADX",SRY)) Q:'SRY  S SRY0=SRY0+1,REC(SRY0)=SRY
"RTN","SROADX1",203,0)
 S SRY(0)=Y(0),SRFDA="130.165"
"RTN","SROADX1",204,0)
 F SRY2=1:1:SRDXCNT D
"RTN","SROADX1",205,0)
 .S SRY0=$P(SRY(0),",",SRY2)
"RTN","SROADX1",206,0)
 .Q:'SRY0
"RTN","SROADX1",207,0)
 .S SRIENF=REC(SRY0)_","_OTH_","_SRTN_",",SRASSD="@"
"RTN","SROADX1",208,0)
 .W !,"Are you sure you want to DELETE ",SRTMP(SRY0)," ? (Y/N) "
"RTN","SROADX1",209,0)
 .Q:SRTMP(SRY0)=""
"RTN","SROADX1",210,0)
 .S %=2 D YN^DICN
"RTN","SROADX1",211,0)
 .I %=1 D FILE
"RTN","SROADX1",212,0)
 S Y(0)=SRY(0)
"RTN","SROADX1",213,0)
 Q
"RTN","SROADX1",214,0)
OADDALL Q:$E($G(IOST))'="C"!($G(DIK)'="")  D KOADX^SROADX2(SRTN,OTH) ;Associate all Diagnosis to OTHER Procedure
"RTN","SROADX1",215,0)
 N SRICD9,PADX,SRFDA,SRIENU,SRIENF,SRY,SRY1
"RTN","SROADX1",216,0)
 S SRY(0)=Y(0),SRFDA="130.165",SRIENU="+1"_","_OTH_","_SRTN_","
"RTN","SROADX1",217,0)
 S PADX=0
"RTN","SROADX1",218,0)
 F  S PADX=$O(SRADIAG(PADX)) Q:'PADX  S SRASSD=SRADIAG(PADX),SRIENF=PADX_","_OTH_","_SRTN_"," K SRY1 D UPDATE,FILE
"RTN","SROADX1",219,0)
 S Y(0)=SRY(0)
"RTN","SROADX1",220,0)
 Q
"RTN","SROADX1",221,0)
OADD1 N SRY,SRY0,SRY1,SRY2,SRCNTR,SRASSD ;Associate 1 Diagnosis to OTHER Procedure
"RTN","SROADX1",222,0)
 S SRY(0)=Y(0),SRCNTR=0
"RTN","SROADX1",223,0)
 S:$D(^SRF(SRTN,13,OTH,"OADX")) SRCNTR=$P(^SRF(SRTN,13,OTH,"OADX",0),U,3)+1
"RTN","SROADX1",224,0)
 D KOADX^SROADX2(SRTN,OTH)
"RTN","SROADX1",225,0)
 S:'$D(^SRF(SRTN,13,OTH,"OADX")) SRCNTR=1
"RTN","SROADX1",226,0)
 S SRFDA="130.165",SRIENU="+1"_","_OTH_","_SRTN_","
"RTN","SROADX1",227,0)
 I SRDIRX(+Y)="ALL" D
"RTN","SROADX1",228,0)
 .S SRY0=0
"RTN","SROADX1",229,0)
 .F  S SRY0=$O(SRADIAG(SRY0)) Q:'SRY0  D
"RTN","SROADX1",230,0)
 ..I '$D(^SRF(SRTN,13,OTH,"OADX","B",SRADIAG(SRY0))) D
"RTN","SROADX1",231,0)
 ..S SRASSD=SRADIAG(SRY0),SRIENF=SRCNTR_","_OTH_","_SRTN_"," K SRY1 D UPDATE,FILE
"RTN","SROADX1",232,0)
 ..S SRCNTR=SRCNTR+1
"RTN","SROADX1",233,0)
 I SRDIRX(+Y)'="ALL" D
"RTN","SROADX1",234,0)
 .F SRY2=1:1:$P(SRDX2,":",2) D
"RTN","SROADX1",235,0)
 ..S SRY0=$P(SRY(0),",",SRY2)
"RTN","SROADX1",236,0)
 ..Q:'SRY0
"RTN","SROADX1",237,0)
 ..S SRASSD=SRADIAG(SRY0),SRIENF=SRCNTR_","_OTH_","_SRTN_"," K SRY1 D UPDATE,FILE
"RTN","SROADX1",238,0)
 ..S SRCNTR=SRCNTR+1
"RTN","SROADX1",239,0)
 S Y(0)=SRY(0)
"RTN","SROADX1",240,0)
 Q
"RTN","SROADX1",241,0)
SRCMSG S SRDX=X
"RTN","SROADX1",242,0)
 S SRC(1)="The Diagnosis/Procedure Code Association may no longer be correct,",SRC(1,"F")="!!?5"
"RTN","SROADX1",243,0)
 S SRC(2)="please confirm or update the values in the Diagnosis Association Field",SRC(2,"F")="!?5"
"RTN","SROADX1",244,0)
 Q
"RTN","SROADX1",245,0)
SRCWRT D EN^DDIOL(.SRC)
"RTN","SROADX1",246,0)
 D CONT
"RTN","SROADX1",247,0)
 Q:$G(DTOUT)
"RTN","SROADX1",248,0)
 S:$D(SRDX) X=SRDX
"RTN","SROADX1",249,0)
 S SRFLG=1
"RTN","SROADX1",250,0)
 Q
"RTN","SROADX1",251,0)
CONT N DIR
"RTN","SROADX1",252,0)
 S DIR(0)="FO^"
"RTN","SROADX1",253,0)
 S DIR("A")="Press RETURN to continue  "
"RTN","SROADX1",254,0)
 D ^DIR
"RTN","SROADX1",255,0)
 Q
"RTN","SROADX1",256,0)
ADXKILL K ADCNT,SRCOMMA,SRDXCNT,SROCNTR,SROCPT2,SROFLG,SRTMP,SRICD9,SRDIAGS
"RTN","SROADX1",257,0)
 K SRASDX,SRMSG,SRADX,SRPADX,SRODIR,REC,SRDIRX,SROANS
"RTN","SROADX1",258,0)
 Q
"RTN","SROADX2")
0^2^B33229144
"RTN","SROADX2",1,0)
SROADX2 ;BIR/RJS - ASSOCIATED DIAGNOSIS FOR CODER AND VERIFY SCREENS ;09/12/05 12:01pm
"RTN","SROADX2",2,0)
 ;;3.0; Surgery ;**119,150**;24 Jun 93
"RTN","SROADX2",3,0)
PDXCHK(SRCODE) N SRYBAK,SRXBAK,DIR,SRQUIT,SRTEMP,DA
"RTN","SROADX2",4,0)
 Q:'$D(D0)
"RTN","SROADX2",5,0)
 I '$D(SRTN) N SRTN S SRTN=D0
"RTN","SROADX2",6,0)
 Q:D0=SRTN
"RTN","SROADX2",7,0)
 S ^TMP($J,"SRASOC",SRTN)=""
"RTN","SROADX2",8,0)
 M SRYBAK=Y
"RTN","SROADX2",9,0)
 I SRYBAK=1 S SRYBAK=""
"RTN","SROADX2",10,0)
 S DIR(0)="Y",SRXBAK=X,SRQUIT=0,SRKALL=0,Y=0
"RTN","SROADX2",11,0)
 S DIR("A",1)="The Procedure Associations may no longer be correct,"
"RTN","SROADX2",12,0)
 I SRCODE D
"RTN","SROADX2",13,0)
 .Q:$$PRLOOP(1)=0
"RTN","SROADX2",14,0)
 .I $P(XQY0,U)'="SROVER"&($P(XQY0,U)'="SRCODING EDIT") S DIR("A",2)="Please update the Associations in the CPT/CODE or PHYSICIAN'S VERIFY menu"
"RTN","SROADX2",15,0)
 .S DIR("A")="Delete PRINCIPAL Procedure Associations for this DX",DIR("B")="NO"
"RTN","SROADX2",16,0)
 .S:$$GET1^DIQ(130.18,D0_","_SRTN_",",3) DIR("B")="YES"
"RTN","SROADX2",17,0)
 .D ^DIR
"RTN","SROADX2",18,0)
 I 'SRCODE D
"RTN","SROADX2",19,0)
 .I $$PRLOOP(1)=0,$$OTLOOP(1)=0 Q
"RTN","SROADX2",20,0)
 .S DIR("A")="All Procedure Associations for this DX will be deleted. Continue",DIR("B")="NO"
"RTN","SROADX2",21,0)
 .D ^DIR S:'Y SRXBAK=SRYBAK,SRQUIT=1
"RTN","SROADX2",22,0)
 .S:Y SRKALL=1
"RTN","SROADX2",23,0)
 S:Y SRTEMP=$$PRLOOP(0)
"RTN","SROADX2",24,0)
 M Y=SRYBAK S X=SRXBAK
"RTN","SROADX2",25,0)
 I SRQUIT W !! Q
"RTN","SROADX2",26,0)
 K DIR
"RTN","SROADX2",27,0)
 D OTHCHK(SRCODE)
"RTN","SROADX2",28,0)
 K SRKALL,SRMATCH,DIR
"RTN","SROADX2",29,0)
 Q
"RTN","SROADX2",30,0)
OTHCHK(SRCODE) N OTH,DA,SRY,SRQUIT,SRYBAK,SRXBAK,DIR
"RTN","SROADX2",31,0)
 M SRYBAK=Y
"RTN","SROADX2",32,0)
 S SRQUIT=0,SRXBAK=X
"RTN","SROADX2",33,0)
 I 'SRKALL W ! D
"RTN","SROADX2",34,0)
 .Q:$$OTLOOP(1)=0
"RTN","SROADX2",35,0)
 .S DIR(0)="Y",DIR("A",1)="The OTHER Prodecure Associations may no longer be correct."
"RTN","SROADX2",36,0)
 .I SRCODE D
"RTN","SROADX2",37,0)
 ..I $P(XQY0,U)'="SROVER"&($P(XQY0,U)'="SRCODING EDIT") S DIR("A",2)="Please update the Associations in the CPT/CODE or PHYSICIAN'S VERIFY menu"
"RTN","SROADX2",38,0)
 ..S DIR("A")="Delete OTHER Procedure Associations for this DX",DIR("B")="NO"
"RTN","SROADX2",39,0)
 ..S:$$GET1^DIQ(130.18,D0_","_SRTN_",",3) DIR("B")="YES"
"RTN","SROADX2",40,0)
 ..D ^DIR W !!
"RTN","SROADX2",41,0)
 I Y!SRKALL D
"RTN","SROADX2",42,0)
 .N DA S OTH=0
"RTN","SROADX2",43,0)
 .F  S OTH=$O(^SRF(SRTN,13,OTH)) Q:'OTH  D
"RTN","SROADX2",44,0)
 ..S DA=0
"RTN","SROADX2",45,0)
 ..F  S DA=$O(^SRF(SRTN,13,OTH,"OADX",DA)) Q:'+DA  D
"RTN","SROADX2",46,0)
 ...I D0=^SRF(SRTN,13,OTH,"OADX",DA,0) D  Q
"RTN","SROADX2",47,0)
 ....D KOADX(SRTN,OTH)
"RTN","SROADX2",48,0)
 M Y=SRYBAK S X=SRXBAK
"RTN","SROADX2",49,0)
 Q
"RTN","SROADX2",50,0)
MSG Q:$D(SRFLG)
"RTN","SROADX2",51,0)
 Q:'$D(EMILY)
"RTN","SROADX2",52,0)
 D SRCMSG^SROADX1
"RTN","SROADX2",53,0)
 D SRCWRT^SROADX1
"RTN","SROADX2",54,0)
 Q
"RTN","SROADX2",55,0)
PRLOOP(SRCHK) N SRDX,SRMATCH S (SRDX,SRMATCH)=0
"RTN","SROADX2",56,0)
 F SRI=1:1 S SRDX=$O(^SRF(SRTN,"PADX",SRDX)) Q:'SRDX  D
"RTN","SROADX2",57,0)
 .I (D0=^SRF(SRTN,"PADX",SRDX,0))!($G(DA)=^SRF(SRTN,"PADX",SRDX,0)) S SRMATCH=1 Q
"RTN","SROADX2",58,0)
 I SRMATCH,'SRCHK D KPADX(SRTN)
"RTN","SROADX2",59,0)
 Q SRMATCH
"RTN","SROADX2",60,0)
OTLOOP(SRCHK) N SRDA,OTH,SRMATCH S (OTH,SRMATCH)=0
"RTN","SROADX2",61,0)
 F  S OTH=$O(^SRF(SRTN,13,OTH)) Q:'OTH  D
"RTN","SROADX2",62,0)
 .S SRDA=0
"RTN","SROADX2",63,0)
 .F  S SRDA=$O(^SRF(SRTN,13,OTH,"OADX",SRDA)) Q:'+SRDA  D
"RTN","SROADX2",64,0)
 ..I (D0=^SRF(SRTN,13,OTH,"OADX",SRDA,0))!($G(DA)=^SRF(SRTN,13,OTH,"OADX",SRDA,0)) D  Q
"RTN","SROADX2",65,0)
 ...I 'SRCHK D KOADX(SRTN,SRDA)
"RTN","SROADX2",66,0)
 ...S SRMATCH=1
"RTN","SROADX2",67,0)
 Q SRMATCH
"RTN","SROADX2",68,0)
DELASOC N DIR,Y,SRPR,SROT,SRXBAK
"RTN","SROADX2",69,0)
 S:'$D(SRTN)&$D(DA(1)) SRTN=DA(1)
"RTN","SROADX2",70,0)
 S:'$D(SRTN)&'$D(DA(1)) SRTN=DA
"RTN","SROADX2",71,0)
 I $D(^TMP($J,"SRASOC",SRTN)) K ^TMP($J,"SRASOC",SRTN) Q
"RTN","SROADX2",72,0)
 Q:$G(D0)=""
"RTN","SROADX2",73,0)
 S SRPR=$$PRLOOP(1),SROT=$$OTLOOP(1),SRXBAK=X
"RTN","SROADX2",74,0)
 I 'SRPR,'SROT Q
"RTN","SROADX2",75,0)
 S DIR(0)="FO",DIR("A")="Procedure Associations for this Diagnosis will be deleted. Continue"
"RTN","SROADX2",76,0)
 D ^DIR
"RTN","SROADX2",77,0)
 S SRPR=$$PRLOOP(0),SROT=$$OTLOOP(0)
"RTN","SROADX2",78,0)
 S X=SRXBAK
"RTN","SROADX2",79,0)
 Q
"RTN","SROADX2",80,0)
PRINASO(SRCODE) Q:$G(SRTN)=""!($G(X)="")
"RTN","SROADX2",81,0)
 N D0 S D0=0  D PDXCHK(SRCODE) K SRCODE Q
"RTN","SROADX2",82,0)
PRINASOD Q:$G(SRTN)=""!($G(X)="")
"RTN","SROADX2",83,0)
 I $D(^TMP($J,"SRASOC",SRTN)) K ^TMP($J,"SRASOC",SRTN) Q
"RTN","SROADX2",84,0)
 N D0 S D0=0  D DELASOC Q
"RTN","SROADX2",85,0)
PCPTASO(SRCODE) Q:$G(SRTN)=""!($G(X)="")
"RTN","SROADX2",86,0)
 I $G(D0)=""!('+$G(X)&(SRCODE))!('$D(^SRF(SRTN,"PADX"))) Q
"RTN","SROADX2",87,0)
 D:$$EDITWARN(SRCODE) KPADX(SRTN)
"RTN","SROADX2",88,0)
 K SRCODE
"RTN","SROADX2",89,0)
 Q
"RTN","SROADX2",90,0)
OCPTASO(SRCODE) Q:$G(SRTN)=""!($G(DA)="")!($G(X)="")
"RTN","SROADX2",91,0)
 I $G(D0)=""!('+$G(X)&(SRCODE))!('$D(^SRF(SRTN,13,DA,"OADX",0))) Q
"RTN","SROADX2",92,0)
 D:$$EDITWARN(SRCODE) KOADX(SRTN,DA)
"RTN","SROADX2",93,0)
 K SRCODE
"RTN","SROADX2",94,0)
 Q
"RTN","SROADX2",95,0)
EDITWARN(SRCODE) N SRYBAK,SRXBAK,DIR,SRY
"RTN","SROADX2",96,0)
 M SRYBAK=Y,SRDABAK=DA
"RTN","SROADX2",97,0)
 S DIR(0)="Y",DIR("B")="NO",SRXBAK=X,SRQUIT=0
"RTN","SROADX2",98,0)
 S DIR("A",1)="The Diagnosis to Procedure Associations may no longer be correct."
"RTN","SROADX2",99,0)
 I SRCODE D
"RTN","SROADX2",100,0)
 .I $P(XQY0,U)'="SROVER"&($P(XQY0,U)'="SRCODING EDIT") S DIR("A",2)="Please update the Associations in the CPT/CODE or PHYSICIAN'S VERIFY menu."
"RTN","SROADX2",101,0)
 .S DIR("A")="Delete Diagnosis Associations for this Procedure"
"RTN","SROADX2",102,0)
 .D ^DIR
"RTN","SROADX2",103,0)
 I 'SRCODE D
"RTN","SROADX2",104,0)
 .S DIR("A")="All DX Associations for this Procedure will be deleted. Continue"
"RTN","SROADX2",105,0)
 .D ^DIR
"RTN","SROADX2",106,0)
 .S:'Y SRXBAK=SRYBAK
"RTN","SROADX2",107,0)
 S X=SRXBAK,SRY=Y
"RTN","SROADX2",108,0)
 M Y=SRYBAK,DA=SRDABAK
"RTN","SROADX2",109,0)
 W !!
"RTN","SROADX2",110,0)
 Q SRY
"RTN","SROADX2",111,0)
KPADX(SRCN) ; kill all the principal cpt associated diagnosis codes
"RTN","SROADX2",112,0)
 N DA,DIK,SRX1,Y,SRXBAK
"RTN","SROADX2",113,0)
 S SRX1=0,DA(1)=SRCN,SRXBAK=X
"RTN","SROADX2",114,0)
 F  S SRX1=$O(^SRF(DA(1),"PADX",SRX1)) Q:'SRX1  D
"RTN","SROADX2",115,0)
 .S DA=SRX1,DA(1)=SRCN,DIK="^SRF("_DA(1)_",""PADX""," D ^DIK
"RTN","SROADX2",116,0)
 S X=SRXBAK
"RTN","SROADX2",117,0)
 Q
"RTN","SROADX2",118,0)
KOADX(SRCN,SRREC) ; kill other cpt associated diagnosis codes
"RTN","SROADX2",119,0)
 N DA,DIK,SRX1,Y,SRXBAK
"RTN","SROADX2",120,0)
 S SRX1=0,DA(2)=SRCN,SRXBAK=X
"RTN","SROADX2",121,0)
 F  S SRX1=$O(^SRF(DA(2),13,SRREC,"OADX",SRX1)) Q:'SRX1  D
"RTN","SROADX2",122,0)
 .S DA=SRX1,DA(1)=SRREC,DA(2)=SRCN,DIK="^SRF("_DA(2)_",13,"_DA(1)_",""OADX""," D ^DIK
"RTN","SROADX2",123,0)
 S X=SRXBAK
"RTN","SROADX2",124,0)
 Q
"RTN","SROADX2",125,0)
ADXCHK ; check the validity of associations and remove if diagnosis missing
"RTN","SROADX2",126,0)
 N SRDX,SRX,SRY,SRZ
"RTN","SROADX2",127,0)
 S SRDX=0
"RTN","SROADX2",128,0)
 I $D(^SRF(SRTN,13)) S SRX=0 D
"RTN","SROADX2",129,0)
 .F  S SRX=$O(^SRF(SRTN,13,SRX)) Q:'SRX  D
"RTN","SROADX2",130,0)
 ..I $D(^SRF(SRTN,13,SRX,"OADX")) S SRY=0 D
"RTN","SROADX2",131,0)
 ...F  S SRY=$O(^SRF(SRTN,13,SRX,"OADX",SRY)) Q:'SRY  D
"RTN","SROADX2",132,0)
 ....S SRDX=^SRF(SRTN,13,SRX,"OADX",SRY,0)
"RTN","SROADX2",133,0)
 ....I (SRDX'=0),'$D(^SRF(SRTN,15,SRDX,0)) D KOADX(SRTN,SRX)
"RTN","SROADX2",134,0)
 ....I (SRDX=0),($P($G(^SRF(SRTN,34)),U)=""),('$P($G(^SRF(SRTN,34)),U,2)) D KOADX(SRTN,SRX)
"RTN","SROADX2",135,0)
 I $D(^SRF(SRTN,"PADX")) S SRX=0 D
"RTN","SROADX2",136,0)
 .F  S SRX=$O(^SRF(SRTN,"PADX",SRX)) Q:'SRX  D
"RTN","SROADX2",137,0)
 ..S SRDX=^SRF(SRTN,"PADX",SRX,0)
"RTN","SROADX2",138,0)
 ..I (SRDX'=0),'$D(^SRF(SRTN,15,SRDX,0)) D KPADX(SRTN)
"RTN","SROADX2",139,0)
 I $O(^SRF(SRTN,"PADX",0)),(($P($G(^SRF(SRTN,34)),U)="")&('$P($G(^SRF(SRTN,34)),U,2)))!(($P($G(^SRF(SRTN,"OP")),U)="")&('$P($G(^SRF(SRTN,"OP")),U,2))) D KPADX(SRTN)
"RTN","SROADX2",140,0)
 Q
"RTN","SROANEST")
0^5^B53321835
"RTN","SROANEST",1,0)
SROANEST ;BIR/TJH - ANESTHESIA ENTRY ;01 Jun 2003
"RTN","SROANEST",2,0)
 ;;3.0;Surgery;**119,150**;24 Jun 93
"RTN","SROANEST",3,0)
SINPUT ;
"RTN","SROANEST",4,0)
 N SRSTART
"RTN","SROANEST",5,0)
 S Z=$E($P(^SRF($S($D(SRTN):SRTN,1:DA(1)),0),"^",9),1,7),X=$S(X?1.4N.A!(X?1.2N1":"2N.A):Z_"@"_X,1:X) K %DT,Z S %DT="RTX" D ^%DT S X=Y K:Y<1 X
"RTN","SROANEST",6,0)
 I '$D(X),$G(SRFLAG)=1 D  K SRFLAG Q
"RTN","SROANEST",7,0)
 .W !!,"Check date format.",!,"     Examples of Valid Dates:",!,"       JAN 20 1957 or 20 JAN 57 or 1/20/57 or 012057",!,"       T   (for TODAY),  T+1 (for TOMORROW),  T+2,  T+7,  etc."
"RTN","SROANEST",8,0)
 .W !,"       T-1 (for YESTERDAY),  T-3W (for 3 WEEKS AGO), etc.",!,"     If the year is omitted, the computer uses CURRENT YEAR.  Two digit year"
"RTN","SROANEST",9,0)
 .W !,"       assumes no more than 20 years in the future, or 80 years in the past.",!,"     If only the time is entered, the current date is assumed."
"RTN","SROANEST",10,0)
 .W !,"     Follow the date with a time, such as JAN 20@10, T@10AM, 10:30, etc.",!,"     You may enter a time, such as NOON, MIDNIGHT or NOW."
"RTN","SROANEST",11,0)
 .W !,"     You may enter   NOW+3'  (for current date and time Plus 3 minutes",!,"       *Note--the Apostrophe following the number of minutes)"
"RTN","SROANEST",12,0)
 .W !,"     Time is REQUIRED in this response.",!,"     Enter the time a member of the Anesthesia staff begins preparing the",!,"     patient for surgery in the O.R. suite or if the care is interrupted, the"
"RTN","SROANEST",13,0)
 .W !,"     time the care resumes."
"RTN","SROANEST",14,0)
 Q:'$D(X)
"RTN","SROANEST",15,0)
 S SRSTART=$P($G(^SRF($S($D(SRTN):SRTN,1:DA(1)),.2)),"^",15)
"RTN","SROANEST",16,0)
 I SRSTART="" K SRFLAG Q
"RTN","SROANEST",17,0)
 I X<SRSTART W !!,"The time entered is before the 'TIME PAT IN HOLD AREA'.  Please check the",!,"DATE/TIME entered for this field." H 2
"RTN","SROANEST",18,0)
 K SRFLAG
"RTN","SROANEST",19,0)
 Q
"RTN","SROANEST",20,0)
STIME ;
"RTN","SROANEST",21,0)
 I '$D(X) Q
"RTN","SROANEST",22,0)
 N SRSPREC,SRPET,SRTIME,SRCRET
"RTN","SROANEST",23,0)
 S SRCRET=$$GET1^DIQ(130.213,DA(2)_","_DA(1)_",",1,"I")
"RTN","SROANEST",24,0)
 I SRCRET,(X>SRCRET) W !!,"Start time is after current end time. Please correct." K X Q
"RTN","SROANEST",25,0)
 S SRSPREC=$O(^SRF(DA(1),50,DA(2)),-1)
"RTN","SROANEST",26,0)
 I SRSPREC'=0 D
"RTN","SROANEST",27,0)
 .S SRPET=$$GET1^DIQ(130.213,SRSPREC_","_DA(1)_",",1,"I")
"RTN","SROANEST",28,0)
 .I SRPET="" W !!,"New start time entry not permitted until previous end time is entered." K X Q
"RTN","SROANEST",29,0)
 .I SRPET>X W !!,"Start time is prior to previous end time. Please correct." K X
"RTN","SROANEST",30,0)
 I $D(X),(DA(2)=1) S SRTIME(130,DA(1)_",",.21)=X D FILE^DIE("","SRTIME","^TMP(""SR"",$J)")
"RTN","SROANEST",31,0)
 Q
"RTN","SROANEST",32,0)
FINALT  ;
"RTN","SROANEST",33,0)
 N SRCST,SRLET,SRYN,SRSNREC,SRFDA,SRTIME,SRLREC,SRCON
"RTN","SROANEST",34,0)
 I $D(^SRF(DA(1),"CON")),$P(^("CON"),"^") S SRCON=$P(^SRF(DA(1),"CON"),"^")
"RTN","SROANEST",35,0)
 S SRCST=$$GET1^DIQ(130.213,DA(2)_","_DA(1)_",",.01,"I")
"RTN","SROANEST",36,0)
 I X<SRCST W !!,"End time prior to start time.  Please correct." K X Q
"RTN","SROANEST",37,0)
 S SRSNREC=$O(^SRF(DA(1),50,DA(2)))
"RTN","SROANEST",38,0)
 I SRSNREC'="B" Q
"RTN","SROANEST",39,0)
ASK W !!,"Does this entry complete all start and end times for this case?  (Y/N)//  " R SRYN:DTIME I '$T!(SRYN["^") S SRYN="N" Q
"RTN","SROANEST",40,0)
 S SRYN=$E(SRYN) I "YyNn?"'[SRYN W !,"Invalid response, please enter Yes or No. Use ? for help." G ASK
"RTN","SROANEST",41,0)
 I "?"[SRYN D HELP G ASK
"RTN","SROANEST",42,0)
 I ("Nn"[SRYN) S SRFDA(130,DA(1)_",",.214)="@" D FILE^DIE("","SRFDA","^TMP(""SR"",$J)") K SRFDA Q
"RTN","SROANEST",43,0)
 D CHKTIME
"RTN","SROANEST",44,0)
 I SRAFLAG=1 K SRAFLAG Q
"RTN","SROANEST",45,0)
 S SRLREC=$O(^SRF(DA(1),50,"B"),-1)
"RTN","SROANEST",46,0)
 I SRLREC'=DA(2) S SRLET=$$GET1^DIQ(130.213,SRLREC_","_DA(1)_",",1,"I")
"RTN","SROANEST",47,0)
 I SRLREC=DA(2) S SRLET=X
"RTN","SROANEST",48,0)
 S SRTIME(130,DA(1)_",",.24)=SRLET,SRTIME(130,DA(1)_",",.214)="1" D FILE^DIE("","SRTIME","^TMP(""SR"",$J)")
"RTN","SROANEST",49,0)
 K SRAFLAG
"RTN","SROANEST",50,0)
 Q:'$D(SRCON)
"RTN","SROANEST",51,0)
ASK2 ;
"RTN","SROANEST",52,0)
 W !,"Does this entry complete all start and end times for the concurrent",!,"case? (Y/N)//  " R SRYN:DTIME I '$T!(SRYN["^") S SRYN="N" Q
"RTN","SROANEST",53,0)
 I "?"[SRYN D HELP^SROCON D HELP G ASK2
"RTN","SROANEST",54,0)
 S SRYN=$E(SRYN) I "YyNn"'[SRYN W !,"Invalid response, please enter Yes or No. Use ? for help." G ASK2
"RTN","SROANEST",55,0)
 I ("Nn"[SRYN),(($P(^SRF(SRCON,.2),"^",17)=1)) S SRFDA(130,SRCON_",",.214)="@" D FILE^DIE("","SRFDA","^TMP(""SR"",$J)") K SRFDA Q
"RTN","SROANEST",56,0)
 S SRTIME(130,SRCON_",",.214)="1" D FILE^DIE("","SRTIME","^TMP(""SR"",$J)")
"RTN","SROANEST",57,0)
 Q
"RTN","SROANEST",58,0)
CHKTIME ;  verify blocks of time are valid
"RTN","SROANEST",59,0)
 N SRSREC,SRCST,SRCET,SRAFLAG1,SRSNREC,SRNST,SRLREC
"RTN","SROANEST",60,0)
 S SRAFLAG=0,SRSREC=0,SRAFLAG1=0
"RTN","SROANEST",61,0)
 F  S SRSREC=$O(^SRF(DA(1),50,SRSREC)) Q:'SRSREC!(SRAFLAG1=1)  D 
"RTN","SROANEST",62,0)
 .S SRCST=$$GET1^DIQ(130.213,SRSREC_","_DA(1)_",",.01,"I"),SRCET=$$GET1^DIQ(130.213,SRSREC_","_DA(1)_",",1,"I")
"RTN","SROANEST",63,0)
 .S SRLREC=$O(^SRF(DA(1),50,"B"),-1)
"RTN","SROANEST",64,0)
 .I (SRCET=""),(SRSREC'=SRLREC) W !!,"One or more time entries missing end time.  Please correct." S SRAFLAG=1,SRAFLAG1=1 Q
"RTN","SROANEST",65,0)
 .S SRSNREC=$O(^SRF(DA(1),50,SRSREC))
"RTN","SROANEST",66,0)
 .I SRSNREC="B" S SRAFLAG1=1 Q
"RTN","SROANEST",67,0)
 .S SRNST=$$GET1^DIQ(130.213,SRSNREC_","_DA(1)_",",.01,"I")
"RTN","SROANEST",68,0)
 .I SRNST<SRCET W !!,"Some time entries overlap.  Please correct." S SRAFLAG=1,SRAFLAG1=1 Q
"RTN","SROANEST",69,0)
 Q
"RTN","SROANEST",70,0)
CSET ;  caled by set xref of mult anes start and end times used for concurrent case anes field stuffing
"RTN","SROANEST",71,0)
 N SRSREC,SRCST,SRCET,SRTIME
"RTN","SROANEST",72,0)
 I $$GET1^DIQ(130,DA(1),.214,"I")'=1 Q
"RTN","SROANEST",73,0)
 S SRSREC=0
"RTN","SROANEST",74,0)
 F  S SRSREC=$O(^SRF(DA(1),50,SRSREC)) Q:'SRSREC  D
"RTN","SROANEST",75,0)
 .S:'$D(SRCST) SRCST=$$GET1^DIQ(130.213,SRSREC_","_DA(1)_",",.01,"I")
"RTN","SROANEST",76,0)
 .S SRCET=$$GET1^DIQ(130.213,SRSREC_","_DA(1)_",",1,"I")
"RTN","SROANEST",77,0)
 S SRTIME(130,DA(1)_",",.24)=SRCET,SRTIME(130,DA(1)_",",.21)=SRCST D FILE^DIE("","SRTIME","^TMP(""SR"",$J)")
"RTN","SROANEST",78,0)
 Q
"RTN","SROANEST",79,0)
DEL ; called by kill xref of mult anes start and end times
"RTN","SROANEST",80,0)
 I '$D(DA(2)) Q
"RTN","SROANEST",81,0)
 I (DA(2)=1),(D=.01) S SRFDA(130,DA(1)_",",.21)="@" D FILE^DIE("","SRFDA","^TMP(""SR"",$J)") K SRFDA
"RTN","SROANEST",82,0)
 I ($O(^SRF(DA(1),50,DA(2)))="B"),(D=1) S SRFDA(130,DA(1)_",",.24)="@",SRFDA(130,DA(1)_",",.214)="@" D FILE^DIE("","SRFDA","^TMP(""SR"",$J)") K SRFDA
"RTN","SROANEST",83,0)
 Q
"RTN","SROANEST",84,0)
HELP ;
"RTN","SROANEST",85,0)
 W !,"Enter ""Y"" only if the block of time entered is the final block of time for"
"RTN","SROANEST",86,0)
 W !,"this case.  If the block of time is not the final block, enter ""N""."
"RTN","SROANEST",87,0)
 Q
"RTN","SROANEST",88,0)
BILLTIME() ;  calculate total minutes for mult anes start and end times
"RTN","SROANEST",89,0)
 N SRSREC,SRCST,SRCET,SRTTIME
"RTN","SROANEST",90,0)
 S SRSREC=0,SRTTIME=0
"RTN","SROANEST",91,0)
 I $$GET1^DIQ(130,D0,.214,"I")'=1 Q SRTTIME
"RTN","SROANEST",92,0)
 I '$D(^SRF(D0,50)) Q SRTTIME
"RTN","SROANEST",93,0)
 F  S SRSREC=$O(^SRF(D0,50,SRSREC)) Q:'SRSREC  D
"RTN","SROANEST",94,0)
 .S SRCST=$$GET1^DIQ(130.213,SRSREC_","_D0_",",.01,"I"),SRCET=$$GET1^DIQ(130.213,SRSREC_","_D0_",",1,"I")
"RTN","SROANEST",95,0)
 .D CALC
"RTN","SROANEST",96,0)
 Q SRTTIME
"RTN","SROANEST",97,0)
CALC ; calculate minutes between start and end times
"RTN","SROANEST",98,0)
 N SRETH,SRDHRS,SRSHR,SREHR,SRSMN,SREMN,SRSTH,X1,X2,Y,%H
"RTN","SROANEST",99,0)
 S X1=SRCST,X2=0 D C^%DTC S SRSTH=%H
"RTN","SROANEST",100,0)
 S X1=SRCET,X2=0 D C^%DTC S SRETH=%H
"RTN","SROANEST",101,0)
 S SRDHRS=(SRETH-SRSTH)*24
"RTN","SROANEST",102,0)
 S SRSHR=$E(($P(SRCST_"0",".",2)),1,2)
"RTN","SROANEST",103,0)
 S SREHR=$E(($P(SRCET_"0",".",2)),1,2)
"RTN","SROANEST",104,0)
 I SREHR<SRSHR S SREHR=SREHR+24,SRDHRS=SRDHRS-24
"RTN","SROANEST",105,0)
 S SRSMN=$E(($P(SRCST_"00",".",2)),3,4)
"RTN","SROANEST",106,0)
 S SREMN=$E(($P(SRCET_"00",".",2)),3,4)
"RTN","SROANEST",107,0)
 I SREMN<SRSMN S SREMN=SREMN+60,SREHR=SREHR-1
"RTN","SROANEST",108,0)
 S Y=(SRDHRS*60)+((SREHR-SRSHR)*60)+(SREMN-SRSMN)
"RTN","SROANEST",109,0)
 S SRTTIME=SRTTIME+Y
"RTN","SROANEST",110,0)
 Q
"RTN","SROANEST",111,0)
ANESTIME(SRDFN,SRFDATE,SRTDATE) ; API to return multiple anesthesia records and times
"RTN","SROANEST",112,0)
 N SRCASE,SRREC,SRCNT,SRNON,SRX,SRDATE,SRRES,SRSC,SRCV,SRQO,SRIR,SREC,SRMST,SRHNC,SRAO,SRSREC,SRCST,SRCET,SRTTIME,SR,SRDIAG
"RTN","SROANEST",113,0)
 S (SRREC,SRCNT,SRRES)=0
"RTN","SROANEST",114,0)
 I '$D(SRDFN)!'$D(SRFDATE) Q -1
"RTN","SROANEST",115,0)
 I '$D(SRTDATE) S SRTDATE=SRFDATE
"RTN","SROANEST",116,0)
 I '$D(^SRF("B",SRDFN)) Q 0
"RTN","SROANEST",117,0)
 S SRFDATE=$P(SRFDATE,"."),SRTDATE=$P(SRTDATE,".")
"RTN","SROANEST",118,0)
 F  S SRREC=$O(^SRF("B",SRDFN,SRREC)) Q:'SRREC  S SRCNT=SRCNT+1,SRCASE(SRCNT)=SRREC
"RTN","SROANEST",119,0)
 S SRREC=0
"RTN","SROANEST",120,0)
 F  S SRREC=$O(SRCASE(SRREC)) Q:'SRREC  D
"RTN","SROANEST",121,0)
 .S SRCASE=SRCASE(SRREC)
"RTN","SROANEST",122,0)
 .S SRNON=$S($P($G(^SRF(SRCASE,"NON")),"^")="Y":1,1:0)
"RTN","SROANEST",123,0)
 .I 'SRNON S SRX=$G(^SRF(SRCASE,.2)),SRDATE=$P(SRX,"^",10)
"RTN","SROANEST",124,0)
 .I SRNON S SRX=$G(^SRF(SRCASE,"NON")),SRDATE=$P(SRX,"^",4)
"RTN","SROANEST",125,0)
 .S SRDATE=$P(SRDATE,".")
"RTN","SROANEST",126,0)
 .I (SRDATE<SRFDATE)!(SRDATE>SRTDATE) K SRCASE(SRREC) Q
"RTN","SROANEST",127,0)
 S SRREC=0
"RTN","SROANEST",128,0)
 F  S SRREC=$O(SRCASE(SRREC)) Q:'SRREC  D
"RTN","SROANEST",129,0)
 .S SRCASE=SRCASE(SRREC)
"RTN","SROANEST",130,0)
 .I $$GET1^DIQ(130,SRCASE,.214,"I")'=1 S SRRES=-2 Q
"RTN","SROANEST",131,0)
 .S SRDIAG=$P($G(^SRF(SRCASE,34)),"^",2)
"RTN","SROANEST",132,0)
 .S (SRAO,SREC,SRHNC,SRIR,SRMST)=0
"RTN","SROANEST",133,0)
 .S SR(0)=$G(^SRF(SRCASE,0))
"RTN","SROANEST",134,0)
 .S SRSC=$P(SR(0),"^",16),SRAO=$P(SR(0),"^",17),SRIR=$P(SR(0),"^",18),SREC=$P(SR(0),"^",19),SRMST=$P(SR(0),"^",22),SRHNC=$P(SR(0),"^",23),SRCV=$P(SR(0),"^",24)
"RTN","SROANEST",135,0)
 .I '$D(^SRF(SRCASE,50)) S:SRRES'=1 SRRES=-2 Q
"RTN","SROANEST",136,0)
 .S SRRES=1,SRREC=0
"RTN","SROANEST",137,0)
 .F  S SRREC=$O(^SRF(SRCASE,50,SRREC)) Q:(SRREC="B")!(SRREC="")  D
"RTN","SROANEST",138,0)
 ..S SRCST=$$GET1^DIQ(130.213,SRREC_","_SRCASE_",",.01,"I"),SRCET=$$GET1^DIQ(130.213,SRREC_","_SRCASE_",",1,"I")
"RTN","SROANEST",139,0)
 ..I 'SRCET K ^TMP("SRANES",$J,SRCASE) S SRRES=-2,SRREC="" Q
"RTN","SROANEST",140,0)
 ..S SRTTIME=0 D CALC
"RTN","SROANEST",141,0)
 ..S ^TMP("SRANES",$J,SRCASE,SRCST,SRCET)=SRDFN_"^"_SRTTIME_"^"_SRDIAG_"^"_SRSC_"^"_SRCV_"^"_SRAO_"^"_SRIR_"^"_SREC_"^"_SRMST_"^"_SRHNC
"RTN","SROANEST",142,0)
 Q SRRES
"RTN","SROPCE1")
0^3^B39384156
"RTN","SROPCE1",1,0)
SROPCE1 ;BIR/ADM - ASK SC/EI QUESTIONS FOR PCE AND CROSS REFERENCE LOGIC ;09/12/05 12:01pm
"RTN","SROPCE1",2,0)
 ;;3.0; Surgery ;**58,105,119,150**;24 Jun 93
"RTN","SROPCE1",3,0)
 ;
"RTN","SROPCE1",4,0)
 ; Reference to CL^SDCO21 supported by DBIA #406
"RTN","SROPCE1",5,0)
 ; Reference to DIS^DGRPDB supported by DBIA #700
"RTN","SROPCE1",6,0)
 ; Reference to Field #.322013 in File #2 supported by DBIA #3475
"RTN","SROPCE1",7,0)
 ;
"RTN","SROPCE1",8,0)
EN1 I '$P(^SRO(133,SRSITE,0),"^",16) Q
"RTN","SROPCE1",9,0)
 N SRPDATE,SRSDATE S SRPDATE=$P(^SRO(133,SRSITE,0),"^",17),SRSDATE=$S($D(SRTN):$P(^SRF(SRTN,0),"^",9),$D(SRWLST):$P(^SRO(133.8,SRSS,1,SROFN,0),"^",5),1:DT) I SRPDATE,SRSDATE<SRPDATE Q
"RTN","SROPCE1",10,0)
 N SRAO,SRDR,SREC,SRELIG,SRIR,SRPERC,SRQ,SRSC,SRCL,SRX,VAEL,VASV,SRCV,SRMST,SRHNC
"RTN","SROPCE1",11,0)
 S SRQ=0 D  I SRQ=1 Q
"RTN","SROPCE1",12,0)
 .I '$D(SRWLST) Q
"RTN","SROPCE1",13,0)
 .I $D(SRWLST),'$P(^SRO(133.8,SRSS,1,SROFN,0),"^",4) Q
"RTN","SROPCE1",14,0)
 .S SRQ=1
"RTN","SROPCE1",15,0)
CLASS ; build classification array
"RTN","SROPCE1",16,0)
 S:$D(SRTN) DFN=$P(^SRF(SRTN,0),"^") D CL^SDCO21(DFN,SRSDATE,,.SRCL)
"RTN","SROPCE1",17,0)
 I '$D(SRCL) W !!,"No classification information is required for this patient.",! K DA,DIE,DR S:$D(SRTN) DA=SRTN,DIE=130,DR=".0155////1" S:$D(SRWLST) DA(1)=SRSS,DA=SROFN,DIE="^SRO(133.8,"_DA(1)_",1,",DR="20////1" D ^DIE G END
"RTN","SROPCE1",18,0)
 I $D(SRTN),'$P(^SRF(SRTN,0),"^",20) G ELIG
"RTN","SROPCE1",19,0)
 I $D(SRWLST),'$P(^SRO(133.8,SRSS,1,SROFN,0),"^",20) G ELIG
"RTN","SROPCE1",20,0)
ASK W ! K DIR S DIR("A")="Do you want to update classification information (Y/N)? ",DIR("B")="NO",DIR(0)="YA" D ^DIR K DIR I 'Y!$D(DTOUT)!$D(DUOUT) W:'$D(SRWLST) @IOF Q
"RTN","SROPCE1",21,0)
ELIG ; output of eligibility and service connected conditions
"RTN","SROPCE1",22,0)
 N SRY D DEM^VADPT,ELIG^VADPT,SVC^VADPT
"RTN","SROPCE1",23,0)
 S SRELIG=$P(VAEL(1),"^",2),SRSC=$P(VAEL(3),"^"),SRSC=$S(SRSC:"YES",SRSC=0:"NO",1:""),SRPERC=$P(VAEL(3),"^",2)
"RTN","SROPCE1",24,0)
 S SRAO=$S(VASV(2):"YES",1:"NO"),SRIR=$S(VASV(3):"YES",1:"NO"),SRCV=$S(VASV(10):"YES",1:"NO")
"RTN","SROPCE1",25,0)
 S SRMST=$S($D(SRCL(5)):"YES",1:"NO"),SRHNC=$S($D(SRCL(6)):"YES",1:"NO")
"RTN","SROPCE1",26,0)
 S DIC=2,DA=DFN,DR=".322013",DIQ="SRY",DIQ(0)="I" D EN^DIQ1 K DA,DIC,DIQ,DR
"RTN","SROPCE1",27,0)
 S SREC=SRY(2,DFN,.322013,"I"),SREC=$S(SREC="Y":"YES",1:"NO")
"RTN","SROPCE1",28,0)
 W @IOF,!,VADM(1)_"  ("_VA("PID")_")       ",$P(VAEL(6),"^",2),!!,"   * * * Eligibility Information and Service Connected Conditions * * *"
"RTN","SROPCE1",29,0)
 W !!,?5,"Primary Eligibility: "_SRELIG,!,?5,"Combat Vet: "_SRCV,?22,"A/O Exp.: "_SRAO,?39,"M/S Trauma: "_SRMST
"RTN","SROPCE1",30,0)
 W !,?5,"ION Rad.: "_SRIR,?22,"Env Contam: "_SREC,?39,"H/N Cancer: "_SRHNC
"RTN","SROPCE1",31,0)
 D DIS^DGRPDB
"RTN","SROPCE1",32,0)
 W ! F I=1:1:79 W "-"
"RTN","SROPCE1",33,0)
SUP S SRY="operation" I $D(SRTN),$P($G(^SRF(SRTN,"NON")),"^")="Y" S SRY="procedure"
"RTN","SROPCE1",34,0)
 K DIR W !!,"Please supply the following required information about this "_SRY_":",! S:$D(SRWLST) DA(1)=SRSS,DA=SROFN S:$D(SRTN) DA=SRTN S SRDR="" S:'$D(SRQ) SRQ=0 D  I SRQ S:$D(SRWLST) SRSOUT=1 G END
"RTN","SROPCE1",35,0)
 .I $D(SRCL(3)) D SC I SRQ Q
"RTN","SROPCE1",36,0)
 .I $D(SRCL(7)) D CV I SRQ Q
"RTN","SROPCE1",37,0)
 .I $D(SRCL(1)) D AO I SRQ Q
"RTN","SROPCE1",38,0)
 .I $D(SRCL(2)) D IR I SRQ Q
"RTN","SROPCE1",39,0)
 .I $D(SRCL(4)) D EC I SRQ Q
"RTN","SROPCE1",40,0)
 .I $D(SRCL(5)) D MST I SRQ Q
"RTN","SROPCE1",41,0)
 .I $D(SRCL(6)) D HNC
"RTN","SROPCE1",42,0)
 K DA,DIE,DR S:$D(SRTN) DA=SRTN,DIE=130,DR=SRDR_".0155////1" S:$D(SRWLST) DA(1)=SRSS,DA=SROFN,DIE="^SRO(133.8,"_DA(1)_",1,",DR=SRDR_"20////1"
"RTN","SROPCE1",43,0)
 D ^DIE
"RTN","SROPCE1",44,0)
UPDX I $D(SRTN),X,$D(^SRF(SRTN,15)) D
"RTN","SROPCE1",45,0)
 .R !!,"Update all 'OTHER POSTOP DIAGNOSIS' Eligibility and",!,"Service Connected Conditions with these values?  Enter YES or NO. <NO>",Z:DTIME S:'$T Z=""
"RTN","SROPCE1",46,0)
 .D:(Z["Y")!(Z["y") UPDSC
"RTN","SROPCE1",47,0)
 .I Z["?" D  G UPDX
"RTN","SROPCE1",48,0)
 ..W !!,"Associate all of the existing OTHER POSTOP DIAGNOSIS for this surgical case with the new Eligibility and Service Connected Conditions?"
"RTN","SROPCE1",49,0)
 ..W !,"To edit diagnoses classification status individually, please use the Physician's Verification or the CPT/ICD9 Coding screens"
"RTN","SROPCE1",50,0)
END K DA,DIE,DR,SRZ,X,Y I 'SRQ,'$D(SRREQ),'$D(SRWLST) D PRESS
"RTN","SROPCE1",51,0)
 Q
"RTN","SROPCE1",52,0)
SC S DIR("A")="Treatment related to Service Connected condition (Y/N)",DIR(0)=$S($D(SRWLST):"133.801,16",1:"130,.016") D ^DIR K DIR I $D(DTOUT)!$D(DUOUT) S SRQ=1 Q
"RTN","SROPCE1",53,0)
 I X=""!(X="@") W !,*7,?15,"Enter YES or NO." G SC
"RTN","SROPCE1",54,0)
 S SRCL(3)=Y,SRDR=$G(SRDR)_$S($D(SRWLST):"16",1:".016")_"////"_SRCL(3)_";"
"RTN","SROPCE1",55,0)
 S SRCL(3,"UPDATE")=1
"RTN","SROPCE1",56,0)
 Q
"RTN","SROPCE1",57,0)
CV S DIR("A")="Treatment related to Combat (Y/N)",DIR(0)=$S($D(SRWLST):"133.801,23",1:"130,.024") D ^DIR K DIR I $D(DTOUT)!$D(DUOUT) S SRQ=1 Q
"RTN","SROPCE1",58,0)
 I X=""!(X="@") W !,*7,?15,"Enter YES or NO." G CV
"RTN","SROPCE1",59,0)
 S SRCL(7)=Y,SRDR=SRDR_$S($D(SRWLST):"23",1:".024")_"////"_SRCL(7)_";"
"RTN","SROPCE1",60,0)
 S SRCL(7,"UPDATE")=1
"RTN","SROPCE1",61,0)
 Q
"RTN","SROPCE1",62,0)
AO S DIR("A")="Treatment related to Agent Orange Exposure (Y/N)",DIR(0)=$S($D(SRWLST):"133.801,17",1:"130,.017") D ^DIR K DIR I $D(DTOUT)!$D(DUOUT) S SRQ=1 Q
"RTN","SROPCE1",63,0)
 I X=""!(X="@") W !,*7,?15,"Enter YES or NO." G AO
"RTN","SROPCE1",64,0)
 S SRCL(1)=Y,SRDR=SRDR_$S($D(SRWLST):"17",1:".017")_"////"_SRCL(1)_";"
"RTN","SROPCE1",65,0)
 S SRCL(1,"UPDATE")=1
"RTN","SROPCE1",66,0)
 Q
"RTN","SROPCE1",67,0)
IR S DIR("A")="Treatment related to Ionizing Radiation Exposure (Y/N)",DIR(0)=$S($D(SRWLST):"133.801,18",1:"130,.018") D ^DIR K DIR I $D(DTOUT)!$D(DUOUT) S SRQ=1 Q
"RTN","SROPCE1",68,0)
 I X=""!(X="@") W !,*7,?15,"Enter YES or NO." G IR
"RTN","SROPCE1",69,0)
 S SRCL(2)=Y,SRDR=SRDR_$S($D(SRWLST):"18",1:".018")_"////"_SRCL(2)_";"
"RTN","SROPCE1",70,0)
 S SRCL(2,"UPDATE")=1
"RTN","SROPCE1",71,0)
 Q
"RTN","SROPCE1",72,0)
EC S DIR("A")="Treatment related to Environmental Contaminant Exposure (Y/N)",DIR(0)=$S($D(SRWLST):"133.801,19",1:"130,.019") D ^DIR K DIR I $D(DTOUT)!$D(DUOUT) S SRQ=1 Q
"RTN","SROPCE1",73,0)
 I X=""!(X="@") W !,*7,?15,"Enter YES or NO." G EC
"RTN","SROPCE1",74,0)
 S SRCL(4)=Y,SRDR=SRDR_$S($D(SRWLST):"19",1:".019")_"////"_SRCL(4)_";"
"RTN","SROPCE1",75,0)
 S SRCL(4,"UPDATE")=1
"RTN","SROPCE1",76,0)
 Q
"RTN","SROPCE1",77,0)
MST S DIR("A")="Treatment related to Military Sexual Trauma (Y/N)",DIR(0)=$S($D(SRWLST):"133.801,21",1:"130,.022") D ^DIR K DIR I $D(DTOUT)!$D(DUOUT) S SRQ=1 Q
"RTN","SROPCE1",78,0)
 I X=""!(X="@") W !,*7,?15,"Enter YES or NO." G MST
"RTN","SROPCE1",79,0)
 S SRCL(5)=Y,SRDR=SRDR_$S($D(SRWLST):"21",1:".022")_"////"_SRCL(5)_";"
"RTN","SROPCE1",80,0)
 S SRCL(5,"UPDATE")=1
"RTN","SROPCE1",81,0)
 Q
"RTN","SROPCE1",82,0)
HNC S DIR("A")="Treatment related to Head and/or Neck Cancer (Y/N)",DIR(0)=$S($D(SRWLST):"133.801,22",1:"130,.023") D ^DIR K DIR I $D(DTOUT)!$D(DUOUT) S SRQ=1 Q
"RTN","SROPCE1",83,0)
 I X=""!(X="@") W !,*7,?15,"Enter YES or NO." G HNC
"RTN","SROPCE1",84,0)
 S SRCL(6)=Y,SRDR=SRDR_$S($D(SRWLST):"22",1:".023")_"////"_SRCL(6)_";"
"RTN","SROPCE1",85,0)
 S SRCL(6,"UPDATE")=1
"RTN","SROPCE1",86,0)
 Q
"RTN","SROPCE1",87,0)
WL ; entry from waiting list
"RTN","SROPCE1",88,0)
 N SRWLST S SRWLST=1 G EN1
"RTN","SROPCE1",89,0)
 Q
"RTN","SROPCE1",90,0)
REQ ; entry from new request entry
"RTN","SROPCE1",91,0)
 N SRREQ S SRREQ=1 G EN1
"RTN","SROPCE1",92,0)
PRESS W ! K DIR S DIR("A")="Press RETURN to continue  ",DIR(0)="FOA" D ^DIR K DIR W @IOF
"RTN","SROPCE1",93,0)
 Q
"RTN","SROPCE1",94,0)
UPDSC ;Update existing DX to Service Connected/Environmental Indicators associations.
"RTN","SROPCE1",95,0)
 K DA,DIE
"RTN","SROPCE1",96,0)
 S (DA,I)=0,DA(1)=SRTN,DIE="^SRF("_SRTN_",15,"
"RTN","SROPCE1",97,0)
 K DR
"RTN","SROPCE1",98,0)
 D:$D(SRCL(1,"UPDATE")) BLDDR(5,SRCL(1))
"RTN","SROPCE1",99,0)
 D:$D(SRCL(2,"UPDATE")) BLDDR(6,SRCL(2))
"RTN","SROPCE1",100,0)
 D:$D(SRCL(3,"UPDATE")) BLDDR(4,SRCL(3))
"RTN","SROPCE1",101,0)
 D:$D(SRCL(4,"UPDATE")) BLDDR(9,SRCL(4))
"RTN","SROPCE1",102,0)
 D:$D(SRCL(5,"UPDATE")) BLDDR(7,SRCL(5))
"RTN","SROPCE1",103,0)
 D:$D(SRCL(6,"UPDATE")) BLDDR(8,SRCL(6))
"RTN","SROPCE1",104,0)
 D:$D(SRCL(7,"UPDATE")) BLDDR(10,SRCL(7))
"RTN","SROPCE1",105,0)
 F I=1:1 S DA=$O(^SRF(SRTN,15,DA)) Q:DA=""  D ^DIE
"RTN","SROPCE1",106,0)
 Q
"RTN","SROPCE1",107,0)
BLDDR(DXPIECE,NEWSC) ;Build the DR string for updating DX/Service Indicators associations
"RTN","SROPCE1",108,0)
 S:$D(DR) DR=DR_";"
"RTN","SROPCE1",109,0)
 S:'$D(DR) DR=""
"RTN","SROPCE1",110,0)
 S DR=DR_DXPIECE_"///"_NEWSC
"RTN","SROPCE1",111,0)
 K DXPIECE,NEWSC
"RTN","SROPCE1",112,0)
 Q
"VER")
8.0^22.0
"^DD",133,133,.01,0)
SITE^RP4'^DIC(4,^0;1^Q
"^DD",133,133,.01,.1)
Site/Division
"^DD",133,133,.01,1,0)
^.1
"^DD",133,133,.01,1,1,0)
133^B
"^DD",133,133,.01,1,1,1)
S ^SRO(133,"B",$E(X,1,30),DA)=""
"^DD",133,133,.01,1,1,2)
K ^SRO(133,"B",$E(X,1,30),DA)
"^DD",133,133,.01,1,2,0)
^^TRIGGER^133^18
"^DD",133,133,.01,1,2,1)
K DIV S DIV=X,D0=DA,DIV(0)=D0 S Y(1)=$S($D(^SRO(133,D0,0)):^(0),1:"") S X=$P(Y(1),U,15),X=X S DIU=X K Y S X=DIV S X="YES" S DIH=$G(^SRO(133,DIV(0),0)),DIV=X S $P(^(0),U,15)=DIV,DIH=133,DIG=18 D ^DICR
"^DD",133,133,.01,1,2,2)
Q
"^DD",133,133,.01,1,2,"%D",0)
^.101^1^1^3051003^^
"^DD",133,133,.01,1,2,"%D",1,0)
The trigger on the SITE field stuffs the UPDATES TO PCE field with a "YES" value.
"^DD",133,133,.01,1,2,"CREATE VALUE")
S X="YES"
"^DD",133,133,.01,1,2,"DELETE VALUE")
NO EFFECT
"^DD",133,133,.01,1,2,"DT")
3051003
"^DD",133,133,.01,1,2,"FIELD")
UPDATES
"^DD",133,133,.01,1,3,0)
^^TRIGGER^133^19
"^DD",133,133,.01,1,3,1)
K DIV S DIV=X,D0=DA,DIV(0)=D0 S Y(1)=$S($D(^SRO(133,D0,0)):^(0),1:"") S X=$P(Y(1),U,16),X=X S DIU=X K Y S X=DIV S X="YES" S DIH=$G(^SRO(133,DIV(0),0)),DIV=X S $P(^(0),U,16)=DIV,DIH=133,DIG=19 D ^DICR
"^DD",133,133,.01,1,3,2)
Q
"^DD",133,133,.01,1,3,"%D",0)
^^1^1^3051003^
"^DD",133,133,.01,1,3,"%D",1,0)
The trigger on the SITE field stuffs the ASK CLASSIFICATION QUESTIONS field with a "YES" value.
"^DD",133,133,.01,1,3,"CREATE VALUE")
S X="YES"
"^DD",133,133,.01,1,3,"DELETE VALUE")
NO EFFECT
"^DD",133,133,.01,1,3,"DT")
3051003
"^DD",133,133,.01,1,3,"FIELD")
ASK CLASSIFICATION
"^DD",133,133,.01,3)

"^DD",133,133,.01,21,0)
^.001^4^4^3051003^^^
"^DD",133,133,.01,21,1,0)
This is the institution responsible for the Surgery service.  If the
"^DD",133,133,.01,21,2,0)
facility is multi-divisional, there will be more than one entry in
"^DD",133,133,.01,21,3,0)
this file.
"^DD",133,133,.01,21,4,0)
 
"^DD",133,133,.01,"DEL",1,0)
N SRX S SRX=$C(7)_"Deletion from this file is not allowed !!" D EN^DDIOL(SRX) I 1
"^DD",133,133,.01,"DT")
3051003
"BLD",5442,6)
^141
**END**
**END**
