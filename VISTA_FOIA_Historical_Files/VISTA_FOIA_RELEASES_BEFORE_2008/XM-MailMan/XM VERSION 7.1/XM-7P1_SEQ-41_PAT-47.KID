Released XM*7.1*47 SEQ #41
Extracted from mail message
**KIDS**:XM*7.1*47^

**INSTALL NAME**
XM*7.1*47
"BLD",30,0)
XM*7.1*47^MAILMAN^0^2970527^n
"BLD",30,1,0)
^^48^48^2970527^^^^
"BLD",30,1,1,0)
MailMan patch XM*7.1*47 contains the following bug fix:
"BLD",30,1,2,0)

"BLD",30,1,3,0)
NOIS:       TOG-0597-11935
"BLD",30,1,4,0)
Rtn:        ^XMA7
"BLD",30,1,5,0)
Test Site:  Togus, ME
"BLD",30,1,6,0)
When using the 'user information' option, in the list showing users for whom
"BLD",30,1,7,0)
the user may act as surrogate, the first user in the list shows
"BLD",30,1,8,0)
'no privileges', no matter which privileges have been granted.
"BLD",30,1,9,0)
This patch fixes that bug.
"BLD",30,1,10,0)

"BLD",30,1,11,0)
This user may act as surrogate for:
"BLD",30,1,12,0)

"BLD",30,1,13,0)
USER,ONE                             (No Privileges)  <== bug
"BLD",30,1,14,0)
USER,TWO                             (Read and Write Privileges)
"BLD",30,1,15,0)

"BLD",30,1,16,0)
===========================================================================
"BLD",30,1,17,0)
This patch should be installed after hours, when user activity is at a
"BLD",30,1,18,0)
minimum.  You should put the XMUSER Option out of order.
"BLD",30,1,19,0)
===========================================================================
"BLD",30,1,20,0)
 
"BLD",30,1,21,0)
INSTALLATION:
"BLD",30,1,22,0)
1.  If any of these routines is mapped (on systems which allow mapping),
"BLD",30,1,23,0)
    disable mapping for the affected routine(s).
"BLD",30,1,24,0)
2.  On the PackMan menu, use the 'INSTALL/CHECK MESSAGE' option.  This loads
"BLD",30,1,25,0)
    the patch into a Transport Global on your system.
"BLD",30,1,26,0)
3.  On the KIDS:Installation menu, use the following options to install the
"BLD",30,1,27,0)
    Transport Global:
"BLD",30,1,28,0)
       Verify Checksums in Transport Global
"BLD",30,1,29,0)
       Print Transport Global
"BLD",30,1,30,0)
       Compare Transport Global to Current System
"BLD",30,1,31,0)
       Backup a Transport Global
"BLD",30,1,32,0)
       Install Package(s)
"BLD",30,1,33,0)
4.  MSM Sites - Answer YES to the question 'Want to MOVE routines to
"BLD",30,1,34,0)
    other CPUs?'. Enter the names of your Compute and Print server(s).
"BLD",30,1,35,0)
5.  AXP Sites, after patch has installed, rebuild your map set.
"BLD",30,1,36,0)
============================================================================ 
"BLD",30,1,37,0)
  
"BLD",30,1,38,0)
ROUTINES:
"BLD",30,1,39,0)
The second line of the routine now looks like:
"BLD",30,1,40,0)
       ;;7.1;MailMan;**[patch list]**;Jun 02, 1994
"BLD",30,1,41,0)
 
"BLD",30,1,42,0)
              Before          After
"BLD",30,1,43,0)
Name          Checksum        Checksum        Patch List
"BLD",30,1,44,0)
----------------------------------------------------------
"BLD",30,1,45,0)
XMA7          10079999        10080629        10,47
"BLD",30,1,46,0)

"BLD",30,1,47,0)
* Checksums produced by CHECK^XTSUMBLD
"BLD",30,1,48,0)
============================================================================
"BLD",30,4,0)
^9.64PA^^0
"BLD",30,"INI")

"BLD",30,"INIT")

"BLD",30,"KRN",0)
^9.67PA^19^12
"BLD",30,"KRN",.4,0)
.4
"BLD",30,"KRN",.401,0)
.401
"BLD",30,"KRN",.402,0)
.402
"BLD",30,"KRN",.403,0)
.403
"BLD",30,"KRN",.5,0)
.5
"BLD",30,"KRN",.84,0)
.84
"BLD",30,"KRN",3.6,0)
3.6
"BLD",30,"KRN",3.8,0)
3.8
"BLD",30,"KRN",9.2,0)
9.2
"BLD",30,"KRN",9.8,0)
9.8
"BLD",30,"KRN",9.8,"NM",0)
^9.68A^1^1
"BLD",30,"KRN",9.8,"NM",1,0)
XMA7^^0^B17310756
"BLD",30,"KRN",9.8,"NM","B","XMA7",1)

"BLD",30,"KRN",19,0)
19
"BLD",30,"KRN",19,"NM",0)
^9.68A^^0
"BLD",30,"KRN",19.1,0)
19.1
"BLD",30,"KRN",19.1,"NM",0)
^9.68A^^
"BLD",30,"KRN","B",.4,.4)

"BLD",30,"KRN","B",.401,.401)

"BLD",30,"KRN","B",.402,.402)

"BLD",30,"KRN","B",.403,.403)

"BLD",30,"KRN","B",.5,.5)

"BLD",30,"KRN","B",.84,.84)

"BLD",30,"KRN","B",3.6,3.6)

"BLD",30,"KRN","B",3.8,3.8)

"BLD",30,"KRN","B",9.2,9.2)

"BLD",30,"KRN","B",9.8,9.8)

"BLD",30,"KRN","B",19,19)

"BLD",30,"KRN","B",19.1,19.1)

"BLD",30,"QUES",0)
^9.62^^
"BLD",30,"REQB",0)
^9.611^^
"PKG",6,-1)
1^1
"PKG",6,0)
MAILMAN^XM^Electronic Mail, both local and networked
"PKG",6,22,0)
^9.49I^1^1
"PKG",6,22,1,0)
7.1^2940602^2950925
"PKG",6,22,1,"PAH",1,0)
47^2970527
"PKG",6,22,1,"PAH",1,1,0)
^^48^48^2970527
"PKG",6,22,1,"PAH",1,1,1,0)
MailMan patch XM*7.1*47 contains the following bug fix:
"PKG",6,22,1,"PAH",1,1,2,0)

"PKG",6,22,1,"PAH",1,1,3,0)
NOIS:       TOG-0597-11935
"PKG",6,22,1,"PAH",1,1,4,0)
Rtn:        ^XMA7
"PKG",6,22,1,"PAH",1,1,5,0)
Test Site:  Togus, ME
"PKG",6,22,1,"PAH",1,1,6,0)
When using the 'user information' option, in the list showing users for whom
"PKG",6,22,1,"PAH",1,1,7,0)
the user may act as surrogate, the first user in the list shows
"PKG",6,22,1,"PAH",1,1,8,0)
'no privileges', no matter which privileges have been granted.
"PKG",6,22,1,"PAH",1,1,9,0)
This patch fixes that bug.
"PKG",6,22,1,"PAH",1,1,10,0)

"PKG",6,22,1,"PAH",1,1,11,0)
This user may act as surrogate for:
"PKG",6,22,1,"PAH",1,1,12,0)

"PKG",6,22,1,"PAH",1,1,13,0)
USER,ONE                             (No Privileges)  <== bug
"PKG",6,22,1,"PAH",1,1,14,0)
USER,TWO                             (Read and Write Privileges)
"PKG",6,22,1,"PAH",1,1,15,0)

"PKG",6,22,1,"PAH",1,1,16,0)
===========================================================================
"PKG",6,22,1,"PAH",1,1,17,0)
This patch should be installed after hours, when user activity is at a
"PKG",6,22,1,"PAH",1,1,18,0)
minimum.  You should put the XMUSER Option out of order.
"PKG",6,22,1,"PAH",1,1,19,0)
===========================================================================
"PKG",6,22,1,"PAH",1,1,20,0)
 
"PKG",6,22,1,"PAH",1,1,21,0)
INSTALLATION:
"PKG",6,22,1,"PAH",1,1,22,0)
1.  If any of these routines is mapped (on systems which allow mapping),
"PKG",6,22,1,"PAH",1,1,23,0)
    disable mapping for the affected routine(s).
"PKG",6,22,1,"PAH",1,1,24,0)
2.  On the PackMan menu, use the 'INSTALL/CHECK MESSAGE' option.  This loads
"PKG",6,22,1,"PAH",1,1,25,0)
    the patch into a Transport Global on your system.
"PKG",6,22,1,"PAH",1,1,26,0)
3.  On the KIDS:Installation menu, use the following options to install the
"PKG",6,22,1,"PAH",1,1,27,0)
    Transport Global:
"PKG",6,22,1,"PAH",1,1,28,0)
       Verify Checksums in Transport Global
"PKG",6,22,1,"PAH",1,1,29,0)
       Print Transport Global
"PKG",6,22,1,"PAH",1,1,30,0)
       Compare Transport Global to Current System
"PKG",6,22,1,"PAH",1,1,31,0)
       Backup a Transport Global
"PKG",6,22,1,"PAH",1,1,32,0)
       Install Package(s)
"PKG",6,22,1,"PAH",1,1,33,0)
4.  MSM Sites - Answer YES to the question 'Want to MOVE routines to
"PKG",6,22,1,"PAH",1,1,34,0)
    other CPUs?'. Enter the names of your Compute and Print server(s).
"PKG",6,22,1,"PAH",1,1,35,0)
5.  AXP Sites, after patch has installed, rebuild your map set.
"PKG",6,22,1,"PAH",1,1,36,0)
============================================================================ 
"PKG",6,22,1,"PAH",1,1,37,0)
  
"PKG",6,22,1,"PAH",1,1,38,0)
ROUTINES:
"PKG",6,22,1,"PAH",1,1,39,0)
The second line of the routine now looks like:
"PKG",6,22,1,"PAH",1,1,40,0)
       ;;7.1;MailMan;**[patch list]**;Jun 02, 1994
"PKG",6,22,1,"PAH",1,1,41,0)
 
"PKG",6,22,1,"PAH",1,1,42,0)
              Before          After
"PKG",6,22,1,"PAH",1,1,43,0)
Name          Checksum        Checksum        Patch List
"PKG",6,22,1,"PAH",1,1,44,0)
----------------------------------------------------------
"PKG",6,22,1,"PAH",1,1,45,0)
XMA7          10079999        10080629        10,47
"PKG",6,22,1,"PAH",1,1,46,0)

"PKG",6,22,1,"PAH",1,1,47,0)
* Checksums produced by CHECK^XTSUMBLD
"PKG",6,22,1,"PAH",1,1,48,0)
============================================================================
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
1
"RTN","XMA7")
0^1^B17310756
"RTN","XMA7",1,0)
XMA7 ;(WASH ISC)/RJ/THM/CAP-SUR/EDIT ;05/27/97  07:59
"RTN","XMA7",2,0)
 ;;7.1;MailMan;**10,47**;Jun 02, 1994
"RTN","XMA7",3,0)
ASM ;ASSUME IDENTITY
"RTN","XMA7",4,0)
 I '$D(^XMB(3.7,"AB",DUZ)) W !!,"You are not anyone's surrogate !" Q
"RTN","XMA7",5,0)
 D LIST K DIR S DIR("A")="SURROGATE NAME",DIR(0)="FO^3:30" D ^DIR K DIR,DIRUT
"RTN","XMA7",6,0)
 I X="SHARED,MAIL" S Y=.6 I $D(^XUSEC("XMNOPRIV",DUZ)) W !,*7,"You have been given the XMNOPRIV key and cannot access "_X_"." Q
"RTN","XMA7",7,0)
 I 'Y S DIC(0)="QMZ",DIC="^VA(200,",DIC("S")="I $S(Y=DUZ:1,$D(^XMB(3.7,""AB"",DUZ,+Y)):1,1:0)" D ^DIC K DIC Q:Y<0
"RTN","XMA7",8,0)
 I DUZ=+Y S XMBASK=0 G ID0
"RTN","XMA7",9,0)
 I Y'=.6,'$D(^XMB(3.7,"AB",DUZ,+Y)) W !,*7,"You are not a surrogate for that user" G ASM
"RTN","XMA7",10,0)
 I +Y=.6 W !!,"Please use AIS (Assume the Identity of Shared,Mail) option.",!! Q
"RTN","XMA7",11,0)
 S XMDUZ=+Y,X=$O(^XMB(3.7,"AB",DUZ,+Y,0))
"RTN","XMA7",12,0)
 I $L(X),$D(^XMB(3.7,XMDUZ,9,X,0)) S XMPRIV=^(0)
"RTN","XMA7",13,0)
SHOW S XMDUNO=$P(^VA(200,DUZ,0),U),XMDUN=$P(^VA(200,XMDUZ,0),U),^XUTL("XQ",$J,"XMDUZ",0)=XMDUZ_"^"_XMDUN_"^"_XMPRIV
"RTN","XMA7",14,0)
 D EN^XM Q
"RTN","XMA7",15,0)
SHARE ;Entry point for assuming the identity of SHARED,MAIL
"RTN","XMA7",16,0)
 S:'$D(XMPRIV) XMPRIV="" D SHOW,REC^XMA Q
"RTN","XMA7",17,0)
ID0 N %5 F %5=1:1 D REC^XMA:'$D(XMBASK) I $D(XMBASK) K XMBASK Q
"RTN","XMA7",18,0)
 W *7,!!,"Returning to regular identity",!! S XMDUN=$P(^VA(200,DUZ,0),U),XMDUZ=DUZ K XMPRIV,^XUTL("XQ",$J,"XMDUZ",0) G EN^XM
"RTN","XMA7",19,0)
LIST S I=0,DX=1,DY=1 X ^%ZOSF("XY")
"RTN","XMA7",20,0)
 W !,"You may act as a surrogate for: ",! S %=$$L1(DUZ)
"RTN","XMA7",21,0)
 W !!,"You may choose yourself to reassume your own identity",! Q
"RTN","XMA7",22,0)
L1(J) ;
"RTN","XMA7",23,0)
L2 S I=$O(^XMB(3.7,"AB",J,I)) I 'I Q 1
"RTN","XMA7",24,0)
 S %0=$$LW(I,1) I '%0 Q 0
"RTN","XMA7",25,0)
 G L2
"RTN","XMA7",26,0)
LW(XMA7,XMA7J) ;p1=User,p2=Display privileges
"RTN","XMA7",27,0)
 N I,X,%,%0,Y
"RTN","XMA7",28,0)
 I $Y+3>IOSL K DIR S DIR(0)="E" D ^DIR K DIR,DIRUT S DX=0,DY=0 W !! X ^%ZOSF("XY") I X[U Q 0
"RTN","XMA7",29,0)
 K X
"RTN","XMA7",30,0)
 W !,?2,$P(^VA(200,XMA7,0),U)
"RTN","XMA7",31,0)
 I 'XMA7J Q 1
"RTN","XMA7",32,0)
 S:XMA7=.6 X="^y^y" I '$D(X) S X=$O(^XMB(3.7,"AB",J,XMA7,0)) I X S X=$S($D(^XMB(3.7,XMA7,9,X,0)):^(0),1:"")
"RTN","XMA7",33,0)
 I $P(X,U,2,3)'["y" S %0=1,%="No" G LQ
"RTN","XMA7",34,0)
 S %=$S($P(X,U,2)["y":"Read",1:""),%0=''$L(%)
"RTN","XMA7",35,0)
 S %(0)=0 I $P(X,U,3)["y" S %=%_$S($L(%):" and ",1:"")_"Write",%0=1
"RTN","XMA7",36,0)
LQ W ?38,"  ("_%_" Privilege"_$S(%0:"s",1:"")_")"
"RTN","XMA7",37,0)
 Q 1
"RTN","XMA7",38,0)
EDIT ;MAIL BOX
"RTN","XMA7",39,0)
 S DIC="AEQMZ",DIE="^XMB(3.7,",DA=DUZ,DR="11;4:4.8;2.2:2.29;8;9;12;13;14;14.1" D ^DIE
"RTN","XMA7",40,0)
 S DIE="^VA(200,",DA=DUZ,DR="31.3" D ^DIE,INIT^XMAK,EN^XM,KILL^XMAK Q
"RTN","XMA7",41,0)
UHELP ;USER HELP
"RTN","XMA7",42,0)
 W !! S DIC=200,DIC(0)="AEQMZ",DIC("S")="I $S('$D(^VA(200,Y,0)):0,Y<1:1,$L($P(^(0),U,3)):1,1:0)"
"RTN","XMA7",43,0)
 S DIC("W")="N % S %=$G(^XMB(3.7,Y,0)) I $L($P(%,U,2)) W ""Forwarding Address: ""_$P(%,U,2)_"", Local Delivery is O""_$S($P(%,U,8):""n"",1:""ff"")"
"RTN","XMA7",44,0)
 D ^DIC K DIC Q:Y<0  W !
"RTN","XMA7",45,0)
 I '$D(^XMB(3.7,+Y)) W !!,"No Mailbox for this user !"
"RTN","XMA7",46,0)
 D EN G UHELP
"RTN","XMA7",47,0)
EN I $O(^XMB(3.7,+Y,100,0))'="" W !!,"Last Device Used: ",$O(^(0))
"RTN","XMA7",48,0)
 S Y=+Y Q:'$D(^XMB(3.7,+Y,0))&'$D(^XMB(3.8,"AB",Y))
"RTN","XMA7",49,0)
 I $D(^XMB(3.7,Y,"B")) S X=^("B") W:$L(X) !!,"Current Banner: "_X
"RTN","XMA7",50,0)
 I $D(^XMB(3.7,Y,"L")) W !!,"Last used MailMan: "_$P(^("L"),U)
"RTN","XMA7",51,0)
 S X=$P($G(^XMB(3.7,Y,0)),U,6) I X W !!,"<<< This user has "_X_" NEW message"_$S(X>1:"s",1:"") S X=$P(^XMB(3.7,Y,2,1,0),U,2) W:X " ("_X_" in the IN basket) " W ". >>>"
"RTN","XMA7",52,0)
 R X:3
"RTN","XMA7",53,0)
 I $D(^XMB(3.8,"AB",Y)) W !!,"Mail Groups:" F X=0:0 S X=$O(^XMB(3.8,"AB",Y,X)) Q:X=""  I $D(^XMB(3.8,X,0)) S I=^(0),J=$P(I,U,2) I J'="PR",J="PU"!$D(^XMB(3.8,"AB",DUZ,X)) W !?2,$P(I,U) D ORG^XMA7G
"RTN","XMA7",54,0)
 I $D(^XMB(3.7,Y,1,0)) W !!,"Introduction:",! F X=0:0 S X=$O(^XMB(3.7,Y,1,X)) Q:X'>0  W "  ",^(X,0),!
"RTN","XMA7",55,0)
 S X=$G(^XMB(3.7,Y,0)) I $L($P(X,U,4)) W !,"Telephone: "_$P(X,U,4)
"RTN","XMA7",56,0)
 I $L($P(X,U,2)) W !,"Forwarding Address: "_$P(X,U,2)_", Local Delivery is o"_$S($P(X,U,8):"n",1:"ff")
"RTN","XMA7",57,0)
UU I $D(^XMB(3.7,Y,3,0)) W !,"Address:",! F X=0:0 S X=$O(^XMB(3.7,Y,3,X)) Q:X=""  W "  ",^(X,0),!
"RTN","XMA7",58,0)
 S J=+Y,I=0 I $O(^XMB(3.7,"AB",J,0))>0 W !,"This user may act as surrogate for:" S X=$$L1(J) Q:'X
"RTN","XMA7",59,0)
 ;
"RTN","XMA7",60,0)
 S (J,I)=0
"RTN","XMA7",61,0)
UI S I=$O(^XMB(3.7,+Y,9,I)) Q:'I  S %=$G(^(I,0))
"RTN","XMA7",62,0)
 I J=0 S J=1 W !,"This user's surrogates are:"
"RTN","XMA7",63,0)
 I +% S %0=$$LW(+%,0) I '%0 Q
"RTN","XMA7",64,0)
 G UI
"VER")
8.0^21.0
**END**
**END**
