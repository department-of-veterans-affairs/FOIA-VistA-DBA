Released XU*8*304 SEQ #257
Extracted from mail message
**KIDS**:XU*8.0*304^

**INSTALL NAME**
XU*8.0*304
"BLD",737,0)
XU*8.0*304^KERNEL^0^3030715^y
"BLD",737,1,0)
^^2^2^3030715^^^^
"BLD",737,1,1,0)
See patch XU*8*304 in the National Patch Module on FORUM for complete
"BLD",737,1,2,0)
information on this patch.
"BLD",737,4,0)
^9.64PA^9.6^1
"BLD",737,4,9.6,0)
9.6
"BLD",737,4,9.6,2,0)
^9.641^9.64^1
"BLD",737,4,9.6,2,9.64,0)
FILE  (sub-file)
"BLD",737,4,9.6,2,9.64,1,0)
^9.6411^222.7^2
"BLD",737,4,9.6,2,9.64,1,222.5,0)
RESOLVE POINTERS
"BLD",737,4,9.6,2,9.64,1,222.7,0)
DATA COMES WITH FILE
"BLD",737,4,9.6,222)
y^y^p^^^^n^^n
"BLD",737,4,9.6,224)

"BLD",737,4,"APDD",9.6,9.64)

"BLD",737,4,"APDD",9.6,9.64,222.5)

"BLD",737,4,"APDD",9.6,9.64,222.7)

"BLD",737,4,"B",9.6,9.6)

"BLD",737,"INIT")
INIT^XPDKRN
"BLD",737,"KRN",0)
^9.67PA^8989.52^19
"BLD",737,"KRN",.4,0)
.4
"BLD",737,"KRN",.401,0)
.401
"BLD",737,"KRN",.402,0)
.402
"BLD",737,"KRN",.403,0)
.403
"BLD",737,"KRN",.5,0)
.5
"BLD",737,"KRN",.84,0)
.84
"BLD",737,"KRN",3.6,0)
3.6
"BLD",737,"KRN",3.8,0)
3.8
"BLD",737,"KRN",9.2,0)
9.2
"BLD",737,"KRN",9.8,0)
9.8
"BLD",737,"KRN",9.8,"NM",0)
^9.68A^4^3
"BLD",737,"KRN",9.8,"NM",2,0)
XPDKRN^^0^B3190703
"BLD",737,"KRN",9.8,"NM",3,0)
XPDDP^^0^B38279807
"BLD",737,"KRN",9.8,"NM",4,0)
XPDCOMG^^0^B14114977
"BLD",737,"KRN",9.8,"NM","B","XPDCOMG",4)

"BLD",737,"KRN",9.8,"NM","B","XPDDP",3)

"BLD",737,"KRN",9.8,"NM","B","XPDKRN",2)

"BLD",737,"KRN",19,0)
19
"BLD",737,"KRN",19.1,0)
19.1
"BLD",737,"KRN",101,0)
101
"BLD",737,"KRN",409.61,0)
409.61
"BLD",737,"KRN",771,0)
771
"BLD",737,"KRN",870,0)
870
"BLD",737,"KRN",8989.51,0)
8989.51
"BLD",737,"KRN",8989.52,0)
8989.52
"BLD",737,"KRN",8994,0)
8994
"BLD",737,"KRN","B",.4,.4)

"BLD",737,"KRN","B",.401,.401)

"BLD",737,"KRN","B",.402,.402)

"BLD",737,"KRN","B",.403,.403)

"BLD",737,"KRN","B",.5,.5)

"BLD",737,"KRN","B",.84,.84)

"BLD",737,"KRN","B",3.6,3.6)

"BLD",737,"KRN","B",3.8,3.8)

"BLD",737,"KRN","B",9.2,9.2)

"BLD",737,"KRN","B",9.8,9.8)

"BLD",737,"KRN","B",19,19)

"BLD",737,"KRN","B",19.1,19.1)

"BLD",737,"KRN","B",101,101)

"BLD",737,"KRN","B",409.61,409.61)

"BLD",737,"KRN","B",771,771)

"BLD",737,"KRN","B",870,870)

"BLD",737,"KRN","B",8989.51,8989.51)

"BLD",737,"KRN","B",8989.52,8989.52)

"BLD",737,"KRN","B",8994,8994)

"BLD",737,"QUES",0)
^9.62^^
"BLD",737,"REQB",0)
^9.611^1^1
"BLD",737,"REQB",1,0)
XU*8.0*229^1
"BLD",737,"REQB","B","XU*8.0*229",1)

"FIA",9.6)
BUILD
"FIA",9.6,0)
^XPD(9.6,
"FIA",9.6,0,0)
9.6I
"FIA",9.6,0,1)
y^y^p^^^^n^^n
"FIA",9.6,0,10)

"FIA",9.6,0,11)

"FIA",9.6,0,"RLRO")

"FIA",9.6,0,"VR")
8.0^XU
"FIA",9.6,9.6)
1
"FIA",9.6,9.64)
1
"FIA",9.6,9.64,222.5)

"FIA",9.6,9.64,222.7)

"INIT")
INIT^XPDKRN
"IX",9.6,9.64,"AD",0)
9.64^AD^Delete fields if data no longer comes with file.^MU^^F^^I^9.64^^^^^A
"IX",9.6,9.64,"AD",.1,0)
^^2^2^3030522^^
"IX",9.6,9.64,"AD",.1,1,0)
If DATA COMES WITH FILE (#222.7) is changed from YES (to NO or null), then
"IX",9.6,9.64,"AD",.1,2,0)
make sure that any fields associated with data coming with the file are null.
"IX",9.6,9.64,"AD",1)
D ADXREF^XPDKRN
"IX",9.6,9.64,"AD",1.4)
S X=(X1(1)="y")
"IX",9.6,9.64,"AD",2)
Q
"IX",9.6,9.64,"AD",11.1,0)
^.114IA^1^1
"IX",9.6,9.64,"AD",11.1,1,0)
1^F^9.64^222.7^^^
"MBREQ")
0
"PKG",3,-1)
1^1
"PKG",3,0)
KERNEL^XU^SIGN-ON, SECURITY, MENU DRIVER, DEVICES, TASKMAN^
"PKG",3,20,0)
^9.402P^^0
"PKG",3,22,0)
^9.49I^1^1
"PKG",3,22,1,0)
8.0^2950703^2970507^.5
"PKG",3,22,1,"PAH",1,0)
304^3030715
"PKG",3,22,1,"PAH",1,1,0)
^^2^2^3030715
"PKG",3,22,1,"PAH",1,1,1,0)
See patch XU*8*304 in the National Patch Module on FORUM for complete
"PKG",3,22,1,"PAH",1,1,2,0)
information on this patch.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
3
"RTN","XPDCOMG")
0^4^B14114977
"RTN","XPDCOMG",1,0)
XPDCOMG ;SFISC/RSD - compare globals ;07/15/2003  10:22
"RTN","XPDCOMG",2,0)
 ;;8.0;KERNEL;**304**;Jul 10, 1995
"RTN","XPDCOMG",3,0)
EN D FIA,KRN
"RTN","XPDCOMG",4,0)
 Q
"RTN","XPDCOMG",5,0)
FIA N DIC,OLDA,XPDFIL,XPDFILO,XPDFILS,XPDS,XPDS0,XPDX,XPDX0,XPDY,XPDY1,XPDZ,XPDZ1,X,Y
"RTN","XPDCOMG",6,0)
 S XPDFIL=0
"RTN","XPDCOMG",7,0)
 F  S XPDFIL=$O(^XTMP("XPDI",XPDA,"FIA",XPDFIL)) Q:'XPDFIL  S XPDZ1=^(XPDFIL,0),XPDFILO=^(0,1) D
"RTN","XPDCOMG",8,0)
 .I '$D(^DIC(XPDFIL)) W !!," File # ",XPDFIL," is NEW",! Q
"RTN","XPDCOMG",9,0)
 .S XPDZ="^XTMP(""XPDI"","_XPDA
"RTN","XPDCOMG",10,0)
 .I $P(XPDFILO,U)="y" D
"RTN","XPDCOMG",11,0)
 ..W !!," File # ",XPDFIL," Data Dictionary ",!
"RTN","XPDCOMG",12,0)
 ..S XPDY=XPDZ_",""^DIC"","_XPDFIL_","_XPDFIL_",0",XPDX=XPDY_")",XPDY=XPDY_",",XPDY1="^DIC("_XPDFIL_",0",XPDS=XPDY1_")",XPDY1=XPDY1_","
"RTN","XPDCOMG",13,0)
 ..D COMPAR(1)
"RTN","XPDCOMG",14,0)
 ..S XPDFILS=0 F  S XPDFILS=$O(^XTMP("XPDI",XPDA,"^DD",XPDFIL,XPDFILS)) Q:'XPDFILS  D
"RTN","XPDCOMG",15,0)
 ...S XPDY=XPDZ_",""^DD"","_XPDFIL_","_XPDFILS,XPDX=XPDY_")",XPDY=XPDY_",",XPDY1="^DD("_XPDFILS,XPDS=XPDY1_")",XPDY1=XPDY1_","
"RTN","XPDCOMG",16,0)
 ...D COMPAR(1)
"RTN","XPDCOMG",17,0)
 .Q:'$D(^XTMP("XPDI",XPDA,"DATA",XPDFIL))
"RTN","XPDCOMG",18,0)
 .W !!," File # ",XPDFIL," Data ",!
"RTN","XPDCOMG",19,0)
 .K DIC
"RTN","XPDCOMG",20,0)
 .S DIC=XPDFIL,DIC(0)="X",XPDZ=XPDZ_",""DATA"","_XPDFIL,OLDA=0
"RTN","XPDCOMG",21,0)
 .F  S OLDA=$O(^XTMP("XPDI",XPDA,"DATA",XPDFIL,OLDA)) Q:'OLDA  S OLDA(0)=^(OLDA,0) D
"RTN","XPDCOMG",22,0)
 ..S X=$P(OLDA(0),U) D ^DIC
"RTN","XPDCOMG",23,0)
 ..I Y<0 W !,X," will be ADDED " Q
"RTN","XPDCOMG",24,0)
 ..S XPDY=XPDZ_","_OLDA_",",XPDX=XPDZ_","_OLDA_")",XPDY1=XPDZ1_+Y_",",XPDS=XPDZ1_+Y_")"
"RTN","XPDCOMG",25,0)
 ..D COMPAR(0)
"RTN","XPDCOMG",26,0)
 W !! Q
"RTN","XPDCOMG",27,0)
KRN N DEL,DIC,OLDA,ORD,X,XPDFIL,XPDFILNM,XPDI,XPDS,XPDS0,XPDX,XPDX0,XPDY,XPDY1,XPDZ,XPDZ1,Y
"RTN","XPDCOMG",28,0)
 S ORD=0
"RTN","XPDCOMG",29,0)
 F  S ORD=$O(^XTMP("XPDI",XPDA,"ORD",ORD)) Q:'ORD  S XPDFIL=+$O(^(ORD,0)),XPDFILNM=$G(^(XPDFIL,0)) D:XPDFIL
"RTN","XPDCOMG",30,0)
 .I $P($G(^DIC(XPDFIL,0)),U)'=XPDFILNM W !!," File "_XPDFIL_" is not "_XPDFILNM_", nothing can be installed.",! Q
"RTN","XPDCOMG",31,0)
 .W !!,XPDFILNM,! K DIC
"RTN","XPDCOMG",32,0)
 .S DIC=XPDFIL,DIC(0)="X",XPDZ="^XTMP(""XPDI"","_XPDA_",""KRN"","_XPDFIL_",",XPDZ1=^DIC(XPDFIL,0,"GL"),OLDA=0
"RTN","XPDCOMG",33,0)
 .F  S OLDA=$O(^XTMP("XPDI",XPDA,"KRN",XPDFIL,OLDA)) Q:'OLDA  S DEL=+$G(^(OLDA,-1)),OLDA(0)=^(0) D
"RTN","XPDCOMG",34,0)
 ..I XPDFIL<.44 S DIC("S")="I $P(^(0),U,"_$S(XPDFIL'=.403:"4)",1:"8)")_"="_$P(OLDA(0),U,$S(XPDFIL'=.403:4,1:8))
"RTN","XPDCOMG",35,0)
 ..I DEL=1,XPDFIL<.44 S %=$P(OLDA(0),U),$P(OLDA(0),U)=$P(%,"    FILE #"),DIC("S")="I $P(^(0),U,"_$S(XPDFIL'=.403:4,1:8)_")="_+$P(%,"    FILE #",2)
"RTN","XPDCOMG",36,0)
 ..S X=$P(OLDA(0),U) D ^DIC
"RTN","XPDCOMG",37,0)
 ..I Y<0,DEL'=1 W !,XPDFILNM,": ",X," will be ADDED " Q
"RTN","XPDCOMG",38,0)
 ..I DEL=1 W:Y>0 !,XPDFILNM,": ",X," will be DELETED " Q
"RTN","XPDCOMG",39,0)
 ..S XPDY=XPDZ_OLDA_",",XPDX=XPDZ_OLDA_",-1)",XPDY1=XPDZ1_+Y_",",XPDS=XPDZ1_+Y_")" D COMPAR(0)
"RTN","XPDCOMG",40,0)
 Q
"RTN","XPDCOMG",41,0)
 ;taken from XTVGC2 routine
"RTN","XPDCOMG",42,0)
COMPAR(XPDFL) S XPDFL=$G(XPDFL)
"RTN","XPDCOMG",43,0)
 N XPDS1,XPDX1
"RTN","XPDCOMG",44,0)
 F  D  Q:XPDX=""&(XPDS="")
"RTN","XPDCOMG",45,0)
 .S XPDX0=$$QU(.XPDX,XPDY),XPDX1=$P(XPDX,XPDY,2)
"RTN","XPDCOMG",46,0)
 .S XPDS0=$$QU(.XPDS,XPDY1),XPDS1=$P(XPDS,XPDY1,2) Q:XPDX=""&(XPDS="")
"RTN","XPDCOMG",47,0)
 .D CHECK
"RTN","XPDCOMG",48,0)
 Q
"RTN","XPDCOMG",49,0)
CHECK N FL,I,X1,X1,S1,S2
"RTN","XPDCOMG",50,0)
CHK1 I XPDX="" W:'XPDFL !,"* DEL *   ",XPDS," = ",XPDS0 Q
"RTN","XPDCOMG",51,0)
 I XPDS="" W !,"* ADD *   ",XPDY1_XPDX1," = ",XPDX0 Q
"RTN","XPDCOMG",52,0)
 S FL=$S(XPDX1=XPDS1:0,1:1)
"RTN","XPDCOMG",53,0)
 I FL S X1=$E(XPDX1,1,$L(XPDX1)-1),S1=$E(XPDS1,1,$L(XPDS1)-1) D
"RTN","XPDCOMG",54,0)
 .F I=1:1 S X2=$P(X1,",",I),S2=$P(S1,",",I) I X2'=S2 S FL=$S(+X2=X2:$S(+S2'=S2:1,X2<S2:1,1:-1),+S2=S2:-1,S2]X2:1,1:-1) Q
"RTN","XPDCOMG",55,0)
 I FL<0 W:'XPDFL !,"* DEL *   ",XPDS," = ",XPDS0 S XPDS0=$$QU(.XPDS,XPDY1),XPDS1=$P(XPDS,XPDY1,2) G CHK1
"RTN","XPDCOMG",56,0)
 I FL>0 W !,"* ADD *   ",XPDY1_XPDX1," = ",XPDX0 S XPDX0=$$QU(.XPDX,XPDY),XPDX1=$P(XPDX,XPDY,2) G CHK1
"RTN","XPDCOMG",57,0)
 I XPDX0'=XPDS0 W !,"* OLD *   ",XPDS," = ",XPDS0,!,"* NEW *   ",XPDY1_XPDX1," = ",XPDX0
"RTN","XPDCOMG",58,0)
 Q
"RTN","XPDCOMG",59,0)
QU(X,Y) ;X=gr, Y=root
"RTN","XPDCOMG",60,0)
 Q:$G(X)="" ""
"RTN","XPDCOMG",61,0)
 S X=$Q(@X)
"RTN","XPDCOMG",62,0)
 I X=""!(X'[$G(Y)) S X="" Q ""
"RTN","XPDCOMG",63,0)
 Q @X
"RTN","XPDDP")
0^3^B38279807
"RTN","XPDDP",1,0)
XPDDP ;SFISC/RSD - Display a package ;05/22/2003  11:38
"RTN","XPDDP",2,0)
 ;;8.0;KERNEL;**21,28,44,68,100,108,229,304**;Jul 10, 1995
"RTN","XPDDP",3,0)
EN1 ;print from Build file
"RTN","XPDDP",4,0)
 N DIC,D0,XPD,XPDT,XPDST,Y,Z
"RTN","XPDDP",5,0)
 S XPDST=$$LOOK^XPDB1 Q:XPDST<0
"RTN","XPDDP",6,0)
 S XPD("XPDT(")="",Y="LST1^XPDDP",Z="Build File Print"
"RTN","XPDDP",7,0)
 D EN^XUTMDEVQ(Y,Z,.XPD)
"RTN","XPDDP",8,0)
 Q
"RTN","XPDDP",9,0)
EN2 ;print from Distribution
"RTN","XPDDP",10,0)
 N D0,DIC,POP,XPD,XPDA,XPDNM,XPDT,XPDST,Y,Z,%ZIS
"RTN","XPDDP",11,0)
 S XPDST=$$LOOK^XPDI1("I $D(^XTMP(""XPDI"",Y))",1)
"RTN","XPDDP",12,0)
 S XPD("XPDT(")="",Y="LST2^XPDDP",Z="Transport Global Print",D0=$O(^XTMP("XPDI",XPDST,"BLD",0))
"RTN","XPDDP",13,0)
 Q:'D0
"RTN","XPDDP",14,0)
 D EN^XUTMDEVQ(Y,Z,.XPD)
"RTN","XPDDP",15,0)
 Q
"RTN","XPDDP",16,0)
 ;
"RTN","XPDDP",17,0)
LST1 ;
"RTN","XPDDP",18,0)
 K DIRUT N XPDIT S XPDIT=0
"RTN","XPDDP",19,0)
 F  S XPDIT=$O(XPDT(XPDIT)) Q:$D(DIRUT)!(XPDIT'>0)  D
"RTN","XPDDP",20,0)
 . S D0=+XPDT(XPDIT) D PNT("XPD(9.6,D0)")
"RTN","XPDDP",21,0)
 Q
"RTN","XPDDP",22,0)
 ;
"RTN","XPDDP",23,0)
LST2 ;Print from XPDT array
"RTN","XPDDP",24,0)
 K DIRUT N XPDIT S XPDIT=0
"RTN","XPDDP",25,0)
 F  S XPDIT=$O(XPDT(XPDIT)) Q:$D(DIRUT)!(XPDIT'>0)  D
"RTN","XPDDP",26,0)
 . S XPDA=+XPDT(XPDIT),D0=$O(^XTMP("XPDI",XPDA,"BLD",0)) D PNT("XTMP(""XPDI"",XPDA,""BLD"",D0)")
"RTN","XPDDP",27,0)
 Q
"RTN","XPDDP",28,0)
 ;
"RTN","XPDDP",29,0)
PNT(XPDGR) ;print a package, XPDGR=global root
"RTN","XPDDP",30,0)
 ;XPDFL=0 - Build - ^XPD(9.7 global root, 1 - Install - ^XTMP global root
"RTN","XPDDP",31,0)
 ;2 - Packman ^TMP($J, global root
"RTN","XPDDP",32,0)
 N I,J,K,X,XPD,XPDDT,XPDI,XPD0,XPDFL,XPDPG,XPDUL,XPDTYPE,XPDTRACK,XPDTXT,XPDOUT
"RTN","XPDDP",33,0)
 Q:$G(XPDGR)=""  S XPDGR="^"_XPDGR
"RTN","XPDDP",34,0)
 Q:'$D(@XPDGR@(0))
"RTN","XPDDP",35,0)
 S XPD0=^(0),XPDPG=1,XPDFL=$S($E(XPDGR,1,5)="^TMP(":2,1:$E(XPDGR,1,5)="^XTMP"),$P(XPDUL,"-",IOM)="",XPDDT=$$HTE^XLFDT($H,"1PM"),XPDTYPE=+$P(XPD0,U,3),XPDTRACK=$P(XPD0,U,5)
"RTN","XPDDP",36,0)
 W:$E(IOST,1,2)="C-" @IOF D HDR W XPDUL,!
"RTN","XPDDP",37,0)
 W "TYPE: ",$$EXTERNAL^DILFD(9.6,2,"",XPDTYPE)
"RTN","XPDDP",38,0)
 W !,"TRACK NATIONALLY: ",$$EXTERNAL^DILFD(9.6,5,"",XPDTRACK)
"RTN","XPDDP",39,0)
 W !,"NATIONAL PACKAGE: ",$P($G(^DIC(9.4,+$P(XPD0,U,2),0),$P(XPD0,U,2)),U)
"RTN","XPDDP",40,0)
 W !,"DESCRIPTION:",!
"RTN","XPDDP",41,0)
 S (XPDI,XPDOUT)=0
"RTN","XPDDP",42,0)
 F  S XPDI=$O(@XPDGR@(1,XPDI)) Q:'XPDI  S XPDTXT=$G(^(XPDI,0)) D  Q:XPDOUT
"RTN","XPDDP",43,0)
 . I $L(XPDTXT)'<IOM,$E(XPDTXT,$L(XPDTXT))=" " F  S XPDTXT=$E(XPDTXT,1,$L(XPDTXT)-1) Q:$E(XPDTXT,$L(XPDTXT))'=" "
"RTN","XPDDP",44,0)
 . F  D  Q:$L(XPDTXT)<IOM!XPDOUT!(IOM<2)  S XPDTXT=$E(XPDTXT,IOM,999)
"RTN","XPDDP",45,0)
 . . W $S(IOM>1:$E(XPDTXT,1,IOM-1),1:XPDTXT),!
"RTN","XPDDP",46,0)
 . . S XPDOUT=$$CHK(2)
"RTN","XPDDP",47,0)
 Q:$D(DIRUT)  G:XPDTYPE=1 MULT
"RTN","XPDDP",48,0)
 W !,"ENVIRONMENT CHECK : ",$G(@XPDGR@("PRE"))
"RTN","XPDDP",49,0)
 W ?47,"DELETE ENV ROUTINE: ",$S($P($G(@XPDGR@("INID")),U)="y":"Yes",1:"No")
"RTN","XPDDP",50,0)
 W !
"RTN","XPDDP",51,0)
 I 'XPDTYPE D
"RTN","XPDDP",52,0)
 . W " PRE-INIT ROUTINE : ",$G(@XPDGR@("INI"))
"RTN","XPDDP",53,0)
 . W ?42,"DELETE PRE-INIT ROUTINE: ",$S($P($G(@XPDGR@("INID")),U,3)="y":"Yes",1:"No")
"RTN","XPDDP",54,0)
 . W !
"RTN","XPDDP",55,0)
 Q:$$CHK(4)  W "POST-INIT ROUTINE : ",$G(@XPDGR@("INIT"))
"RTN","XPDDP",56,0)
 W ?41,"DELETE POST-INIT ROUTINE: ",$S($P($G(@XPDGR@("INID")),U,2)="y":"Yes",1:"No")
"RTN","XPDDP",57,0)
 W !
"RTN","XPDDP",58,0)
 W:'XPDTYPE "PRE-TRANSPORT RTN : ",$G(@XPDGR@("PRET")),!
"RTN","XPDDP",59,0)
 G:XPDTYPE=2 GLOBAL
"RTN","XPDDP",60,0)
 I '$O(@XPDGR@(4,0)) Q:$$CHK(4)  G COMP
"RTN","XPDDP",61,0)
 S I=$$CHK(10,1) Q:I  I '$P(I,"^",2) W !! D HDR1 W XPDUL,!
"RTN","XPDDP",62,0)
PNT2 S XPDI=0 F  S XPDI=$O(@XPDGR@(4,XPDI)) Q:'XPDI  S XPD=$G(^(XPDI,222)) Q:$$CHK(4,1)  D
"RTN","XPDDP",63,0)
 .;file number, file name, partial DD
"RTN","XPDDP",64,0)
 .W !,XPDI,?12,$S('XPDFL:$P($G(^DIC(XPDI,0),"**unknown**"),U),1:$G(^XTMP("XPDI",XPDA,"FIA",XPDI)))
"RTN","XPDDP",65,0)
 .W ?41,$$EXTERNAL^DILFD(9.64,222.1,"",$P(XPD,U)),?47,$$EXTERNAL^DILFD(9.64,222.2,"",$P(XPD,U,2)),?53,$$EXTERNAL^DILFD(9.64,222.7,"",$P(XPD,U,7))
"RTN","XPDDP",66,0)
 .W ?60,$E($$EXTERNAL^DILFD(9.64,222.8,"",$P(XPD,U,8)),1,4),?67,$$EXTERNAL^DILFD(9.64,222.5,"",$P(XPD,U,5)),?73,$$EXTERNAL^DILFD(9.64,222.9,"",$P(XPD,U,9)),!
"RTN","XPDDP",67,0)
 .;print partial DD information
"RTN","XPDDP",68,0)
 .I $P(XPD,U,3)="p" S J=0 D
"RTN","XPDDP",69,0)
 ..W "Partial DD:"
"RTN","XPDDP",70,0)
 ..F  S J=$O(@XPDGR@(4,"APDD",XPDI,J)) Q:'J  W ?12,"subDD: ",J D  Q:$$CHK(4,1)
"RTN","XPDDP",71,0)
 ...I '$O(@XPDGR@(4,"APDD",XPDI,J,0)) W ! Q
"RTN","XPDDP",72,0)
 ...S I=0 F  S I=$O(@XPDGR@(4,"APDD",XPDI,J,I)) Q:'I  W ?30,"fld: ",I,!
"RTN","XPDDP",73,0)
 .I $D(@XPDGR@(4,XPDI,223)) W ?2,"DD SCREEN  : ",^(223),!
"RTN","XPDDP",74,0)
 .I $D(@XPDGR@(4,XPDI,224)) W ?2,"DATA SCREEN: ",^(224),!
"RTN","XPDDP",75,0)
COMP Q:$D(DIRUT)  W ! Q:$$CHK(3)  S I=0,XPD=$P(^DD(9.68,.03,0),U,3)
"RTN","XPDDP",76,0)
 ;print build components
"RTN","XPDDP",77,0)
 F  S I=$O(@XPDGR@("KRN",I)),K=0,J="" Q:$D(DIRUT)!'I  F  S J=$O(@XPDGR@("KRN",I,"NM","B",J)) Q:J=""  S X=$O(^(J,0)) Q:$$CHK(4)  D:X
"RTN","XPDDP",78,0)
 .S X=$G(@XPDGR@("KRN",I,"NM",X,0)) Q:X=""
"RTN","XPDDP",79,0)
 .;K is flag to write type of component
"RTN","XPDDP",80,0)
 .I 'K W !,$S($D(^DIC(I,0)):$P(^(0),U),XPDFL:$G(^XTMP("XPDI",XPDA,"FIA",I),"UNKNOWN"),1:"UNKNOWN")_":",! S K=1
"RTN","XPDDP",81,0)
 .;write the entry name and write the action
"RTN","XPDDP",82,0)
 .W ?3,$P(X,U),?50,$P($P(XPD,";",$P(X,U,3)+1),":",2),!
"RTN","XPDDP",83,0)
 Q:XPDFL=2
"RTN","XPDDP",84,0)
 ;XPDFL=2 this is a Packman message, called from XMP2 - Summarize
"RTN","XPDDP",85,0)
 ;XPDFL=1 this is a Install, the call backs are already Build Components
"RTN","XPDDP",86,0)
 Q:$D(DIRUT)  Q:$$CHK(3)
"RTN","XPDDP",87,0)
 I $O(@XPDGR@("QUES",0)) W !,"INSTALL QUESTIONS: " S I=0 D
"RTN","XPDDP",88,0)
 .F  S I=$O(@XPDGR@("QUES",I)) Q:'I  S X=$P(^(I,0),U),J=$G(^(1)),K=$G(^("A")) Q:$$CHK(5)  D
"RTN","XPDDP",89,0)
 ..W !?5,"SUBSCIRPT: ",X,!,"DIR(0)=",J W:K]"" !,"DIR(""A"")=",K,!
"RTN","XPDDP",90,0)
 ..F J=1:1 Q:'$D(@XPDGR@("QUES",I,"A1",J,0))  W "DIR(""A"",",J,")=",^(0),!
"RTN","XPDDP",91,0)
 ..I $G(@XPDGR@("QUES",I,"B"))]"" W "DIR(""B"")=",^("B"),!
"RTN","XPDDP",92,0)
 ..I $G(@XPDGR@("QUES",I,"Q"))]"" W "DIR(""?"")=",^("Q"),!
"RTN","XPDDP",93,0)
 ..F J=1:1 Q:'$D(@XPDGR@("QUES",I,"Q1",J,0))  W "DIR(""?"",",J,")=",^(0),!
"RTN","XPDDP",94,0)
 ..I $G(@XPDGR@("QUES",I,"QQ"))]"" W "DIR(""??"")=",^("QQ"),!
"RTN","XPDDP",95,0)
 ..I $G(@XPDGR@("QUES",I,"M"))]"" W "M CODE: ",^("M"),!
"RTN","XPDDP",96,0)
 Q:$D(DIRUT)  Q:$$CHK(3)
"RTN","XPDDP",97,0)
 I $L($G(@XPDGR@("ABPKG"))) S XPD=^("ABPKG") D:$P(XPD,U)="y"
"RTN","XPDDP",98,0)
 .W !,"ALPHA/BETA TESTING:",$$EXTERNAL^DILFD(9.6,20,"",$P(XPD,U)),?40,"INSTALLATION MESSAGE: ",$$EXTERNAL^DILFD(9.6,21,"",$P(XPD,U,2))
"RTN","XPDDP",99,0)
 .W !,"ADDRESS: ",$P(XPD,U,3),!!,"INCLUDE NAMESPACE",?30,"EXCLUDE NAMESPACE" S I=0
"RTN","XPDDP",100,0)
 .F  S I=$O(@XPDGR@("ABNS",I)),J=0 Q:'I  W !?5,^(I,0) F  S J=$O(@XPDGR@("ABNS",I,1,J)) Q:'J  W ?35,^(J,0),! Q:$$CHK(3)
"RTN","XPDDP",101,0)
REQB Q:$D(DIRUT)  Q:$$CHK(4)
"RTN","XPDDP",102,0)
 I $O(@XPDGR@("REQB",0)) W !,"REQUIRED BUILDS:",?50,"ACTION:" D
"RTN","XPDDP",103,0)
 .S XPDI=0 F  S XPDI=$O(@XPDGR@("REQB",XPDI)) Q:'XPDI  S XPD=$G(^(XPDI,0)) Q:$$CHK(4,1)  D
"RTN","XPDDP",104,0)
 ..W !?3,$P(XPD,U),?50,$$EXTERNAL^DILFD(9.611,1,"",$P(XPD,U,2))
"RTN","XPDDP",105,0)
 Q
"RTN","XPDDP",106,0)
GLOBAL ;globals listing
"RTN","XPDDP",107,0)
 S I=$$CHK(8,1) Q:I  I '$P(I,"^",2) W !!,"GLOBAL:",?20,"KILL GLOBAL BEFORE INSTALL:"
"RTN","XPDDP",108,0)
 S XPDI=0 F  S XPDI=$O(@XPDGR@("GLO",XPDI)) Q:'XPDI  S XPD=$G(^(XPDI,0)) Q:$$CHK(4,1)  D
"RTN","XPDDP",109,0)
 .W !?3,$P(XPD,U),?33,$$EXTERNAL^DILFD(9.65,1,"",$P(XPD,U,2))
"RTN","XPDDP",110,0)
 W ! Q
"RTN","XPDDP",111,0)
 ;
"RTN","XPDDP",112,0)
MULT ;multiple-package
"RTN","XPDDP",113,0)
 S I=$$CHK(10,1) Q:I  I '$P(I,"^",2) W !,"SEQUENCE OF BUILDS:"
"RTN","XPDDP",114,0)
 S XPDI=0 F  S XPDI=$O(@XPDGR@(10,XPDI)) Q:'XPDI  S XPD=$G(^(XPDI,0)) Q:$$CHK(4,1)  D
"RTN","XPDDP",115,0)
 .W !?2,XPDI,?8,$E($P(XPD,U),1,44),?54,$S($P(XPD,U,2)=1:"",1:"Not ")_"Required to Continue"
"RTN","XPDDP",116,0)
 W ! Q
"RTN","XPDDP",117,0)
 ;
"RTN","XPDDP",118,0)
 ;return 0 if header was not written, else "0^1"
"RTN","XPDDP",119,0)
CHK(Y,XPD) ;Y=excess lines XPD=1 print file header, return 1 to exit
"RTN","XPDDP",120,0)
 Q:$Y<(IOSL-Y) 0
"RTN","XPDDP",121,0)
 I $E(IOST,1,2)="C-" D  Q:'Y 1
"RTN","XPDDP",122,0)
 .N DIR,I,J,K,X
"RTN","XPDDP",123,0)
 .S DIR(0)="E" D ^DIR
"RTN","XPDDP",124,0)
 S XPD=$G(XPD),XPDPG=XPDPG+1
"RTN","XPDDP",125,0)
 W @IOF D HDR,HDR1:XPD
"RTN","XPDDP",126,0)
 W XPDUL,!
"RTN","XPDDP",127,0)
 Q "0^1"
"RTN","XPDDP",128,0)
 ;
"RTN","XPDDP",129,0)
XMP2(X,D0) ;called from ^XMP2
"RTN","XPDDP",130,0)
 N XPDA S XPDA=-1
"RTN","XPDDP",131,0)
 D PNT(X) Q
"RTN","XPDDP",132,0)
 ;
"RTN","XPDDP",133,0)
HDR W !,"PACKAGE: ",$P(XPD0,U),"     ",XPDDT,?70,"PAGE ",XPDPG,!
"RTN","XPDDP",134,0)
 Q
"RTN","XPDDP",135,0)
HDR1 W ?41,"UP",?47,"SEND",?53,"DATA",?73,"USER",!,?41,"DATE",?47,"SEC.",?53,"COMES",?60,"SITE",?67,"RSLV",?73,"OVER"
"RTN","XPDDP",136,0)
 W !,"FILE #",?12,"NAME",?41,"DD",?47,"CODE",?53,"W/FILE",?60,"DATA",?67,"PTS",?73,"RIDE",!
"RTN","XPDDP",137,0)
 Q
"RTN","XPDKRN")
0^2^B3190703
"RTN","XPDKRN",1,0)
XPDKRN ;SFISC/RSD - Kernel Install program ;07/02/2003  12:59
"RTN","XPDKRN",2,0)
V ;;8.0;KERNEL;**304**;Jul 10, 1995
"RTN","XPDKRN",3,0)
EN N X,Y
"RTN","XPDKRN",4,0)
 W !!,"KIDS "_$P($T(V),";",3),!
"RTN","XPDKRN",5,0)
 D DT^DICRW:'$D(DT),INIT:($O(^DOPT("XPD","B"),-1)'=5)
"RTN","XPDKRN",6,0)
 I '$G(DUZ) W !,"DUZ must be defined as an active user!!" Q
"RTN","XPDKRN",7,0)
 D  Q:Y<0  G @X
"RTN","XPDKRN",8,0)
 .N DIC
"RTN","XPDKRN",9,0)
 .S DIC="^DOPT(""XPD"",",DIC(0)="AEQZ"
"RTN","XPDKRN",10,0)
 .D ^DIC Q:Y<0
"RTN","XPDKRN",11,0)
 .S X=$P(Y(0),U,2,99)
"RTN","XPDKRN",12,0)
 Q
"RTN","XPDKRN",13,0)
 ;
"RTN","XPDKRN",14,0)
INIT N DIK,I,X
"RTN","XPDKRN",15,0)
 K ^DOPT("XPD")
"RTN","XPDKRN",16,0)
 S ^DOPT("XPD",0)="KIDS OPTION^1N^",DIK="^DOPT(""XPD"","
"RTN","XPDKRN",17,0)
 F I=1:1 S X=$E($T(OPT+I),4,99) Q:X=""  S ^DOPT("XPD",I,0)=X
"RTN","XPDKRN",18,0)
 D IXALL^DIK
"RTN","XPDKRN",19,0)
 Q
"RTN","XPDKRN",20,0)
ADXREF ;New-style 'AD' xref for FILE (#9.64) subfile of the BUILD (#9.6) file.
"RTN","XPDKRN",21,0)
 ;If DATA COMES WITH FILE is changed from YES to NO, then
"RTN","XPDKRN",22,0)
 ;make sure these other fields are empty.
"RTN","XPDKRN",23,0)
 N XPDFDA,XPDIENS
"RTN","XPDKRN",24,0)
 S XPDIENS=DA_","_DA(1)_","
"RTN","XPDKRN",25,0)
 S XPDFDA(9.64,XPDIENS,222.5)="@" ; RESOLVE POINTERS
"RTN","XPDKRN",26,0)
 S XPDFDA(9.64,XPDIENS,222.6)="@" ; DATA LIST
"RTN","XPDKRN",27,0)
 S XPDFDA(9.64,XPDIENS,222.8)="@" ; SITE'S DATA
"RTN","XPDKRN",28,0)
 S XPDFDA(9.64,XPDIENS,222.9)="@" ; MAY USER OVERRIDE DATA UPDATE
"RTN","XPDKRN",29,0)
 S XPDFDA(9.64,XPDIENS,224)="@"   ; SCREEN TO SELECT DATA
"RTN","XPDKRN",30,0)
 D FILE^DIE("","XPDFDA")
"RTN","XPDKRN",31,0)
 Q
"RTN","XPDKRN",32,0)
OPT ;
"RTN","XPDKRN",33,0)
 ;;LOAD A DISTRIBUTION^EN1^XPDIL
"RTN","XPDKRN",34,0)
 ;;VERIFY CHECKSUMS IN TRANSPORT GLOBAL^EN1^XPDDCS
"RTN","XPDKRN",35,0)
 ;;PRINT TRANSPORT GLOBAL^EN2^XPDDP
"RTN","XPDKRN",36,0)
 ;;COMPARE TRANSPORT GLOBAL TO CURRENT SYSTEM^EN1^XPDCOM
"RTN","XPDKRN",37,0)
 ;;BACKUP A TRANSPORT GLOBAL^EN^XPDIB
"RTN","XPDKRN",38,0)
 ;;INSTALL PACKAGE(S)^EN^XPDI
"RTN","XPDKRN",39,0)
 ;;RESTART INSTALL OF PACKAGE(S)^EN^XPDIR
"RTN","XPDKRN",40,0)
 ;;UNLOAD A DISTRIBUTION^EN1^XPDIU
"UP",9.6,9.64,-1)
9.6^4
"UP",9.6,9.64,0)
9.64
"VER")
8.0^22.0
"^DD",9.6,9.64,222.5,0)
RESOLVE POINTERS^S^y:YES;n:NO;^222;5^Q
"^DD",9.6,9.64,222.5,21,0)
^^4^4^3030521^^
"^DD",9.6,9.64,222.5,21,1,0)
YES means you want to have all pointer type field values resolved
"^DD",9.6,9.64,222.5,21,2,0)
at the installing site.
"^DD",9.6,9.64,222.5,21,3,0)
 
"^DD",9.6,9.64,222.5,21,4,0)
NO means you do not want any pointer type field values resolved.
"^DD",9.6,9.64,222.5,"DT")
3030521
"^DD",9.6,9.64,222.7,0)
DATA COMES WITH FILE^S^y:YES;n:NO;^222;7^Q
"^DD",9.6,9.64,222.7,1,0)
^.1^^0
"^DD",9.6,9.64,222.7,5,1,0)
9.64^222.3^1
"^DD",9.6,9.64,222.7,21,0)
^^4^4^2920513^^^^
"^DD",9.6,9.64,222.7,21,1,0)
YES means that the data should be included in the initialization
"^DD",9.6,9.64,222.7,21,2,0)
routines.
"^DD",9.6,9.64,222.7,21,3,0)
 
"^DD",9.6,9.64,222.7,21,4,0)
NO means that the data should be left out.
"^DD",9.6,9.64,222.7,"DT")
3030522
**END**
**END**
