Released GMRC*3*43 SEQ #38
Extracted from mail message
**KIDS**:GMRC*3.0*43^

**INSTALL NAME**
GMRC*3.0*43
"BLD",6044,0)
GMRC*3.0*43^CONSULT/REQUEST TRACKING^0^3050315^y
"BLD",6044,1,0)
^^3^3^3050304^
"BLD",6044,1,1,0)
Modify Consult/Request Completion Time Statistics process to take into 
"BLD",6044,1,2,0)
consideration when the consult was completed the same day as the request 
"BLD",6044,1,3,0)
date.
"BLD",6044,4,0)
^9.64PA^^
"BLD",6044,"KRN",0)
^9.67PA^8989.52^19
"BLD",6044,"KRN",.4,0)
.4
"BLD",6044,"KRN",.401,0)
.401
"BLD",6044,"KRN",.402,0)
.402
"BLD",6044,"KRN",.403,0)
.403
"BLD",6044,"KRN",.5,0)
.5
"BLD",6044,"KRN",.84,0)
.84
"BLD",6044,"KRN",3.6,0)
3.6
"BLD",6044,"KRN",3.8,0)
3.8
"BLD",6044,"KRN",9.2,0)
9.2
"BLD",6044,"KRN",9.8,0)
9.8
"BLD",6044,"KRN",9.8,"NM",0)
^9.68A^2^2
"BLD",6044,"KRN",9.8,"NM",1,0)
GMRCSTU^^0^B64607366
"BLD",6044,"KRN",9.8,"NM",2,0)
GMRCSTU1^^0^B44975811
"BLD",6044,"KRN",9.8,"NM","B","GMRCSTU",1)

"BLD",6044,"KRN",9.8,"NM","B","GMRCSTU1",2)

"BLD",6044,"KRN",19,0)
19
"BLD",6044,"KRN",19.1,0)
19.1
"BLD",6044,"KRN",101,0)
101
"BLD",6044,"KRN",409.61,0)
409.61
"BLD",6044,"KRN",771,0)
771
"BLD",6044,"KRN",870,0)
870
"BLD",6044,"KRN",8989.51,0)
8989.51
"BLD",6044,"KRN",8989.52,0)
8989.52
"BLD",6044,"KRN",8994,0)
8994
"BLD",6044,"KRN","B",.4,.4)

"BLD",6044,"KRN","B",.401,.401)

"BLD",6044,"KRN","B",.402,.402)

"BLD",6044,"KRN","B",.403,.403)

"BLD",6044,"KRN","B",.5,.5)

"BLD",6044,"KRN","B",.84,.84)

"BLD",6044,"KRN","B",3.6,3.6)

"BLD",6044,"KRN","B",3.8,3.8)

"BLD",6044,"KRN","B",9.2,9.2)

"BLD",6044,"KRN","B",9.8,9.8)

"BLD",6044,"KRN","B",19,19)

"BLD",6044,"KRN","B",19.1,19.1)

"BLD",6044,"KRN","B",101,101)

"BLD",6044,"KRN","B",409.61,409.61)

"BLD",6044,"KRN","B",771,771)

"BLD",6044,"KRN","B",870,870)

"BLD",6044,"KRN","B",8989.51,8989.51)

"BLD",6044,"KRN","B",8989.52,8989.52)

"BLD",6044,"KRN","B",8994,8994)

"BLD",6044,"QUES",0)
^9.62^^
"BLD",6044,"REQB",0)
^9.611^2^2
"BLD",6044,"REQB",1,0)
GMRC*3.0*29^2
"BLD",6044,"REQB",2,0)
GMRC*3.0*30^2
"BLD",6044,"REQB","B","GMRC*3.0*29",1)

"BLD",6044,"REQB","B","GMRC*3.0*30",2)

"MBREQ")
0
"PKG",222,-1)
1^1
"PKG",222,0)
CONSULT/REQUEST TRACKING^GMRC^CONSULTS/REQUESTS
"PKG",222,22,0)
^9.49I^1^1
"PKG",222,22,1,0)
3.0^2980101^2990325^66481
"PKG",222,22,1,"PAH",1,0)
43^3050315
"PKG",222,22,1,"PAH",1,1,0)
^^3^3^3050315
"PKG",222,22,1,"PAH",1,1,1,0)
Modify Consult/Request Completion Time Statistics process to take into 
"PKG",222,22,1,"PAH",1,1,2,0)
consideration when the consult was completed the same day as the request 
"PKG",222,22,1,"PAH",1,1,3,0)
date.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
2
"RTN","GMRCSTU")
0^1^B64607366
"RTN","GMRCSTU",1,0)
GMRCSTU ;SLC/DCM,dee - Statistic Utilities for C/RT ;09/26/02 10:16
"RTN","GMRCSTU",2,0)
 ;;3.0;CONSULT/REQUEST TRACKING;**1,7,29,30,43**;DEC 27, 1997
"RTN","GMRCSTU",3,0)
 Q
"RTN","GMRCSTU",4,0)
 ;
"RTN","GMRCSTU",5,0)
GETDT(GMRCO) ;get the date that the consult/request was accepted by service
"RTN","GMRCSTU",6,0)
 N ND,GMRCDA
"RTN","GMRCSTU",7,0)
 S COMPLDT=9999999
"RTN","GMRCSTU",8,0)
 S ND=0 F  S ND=$O(^GMR(123,GMRCO,40,ND)) Q:ND?1A.E!(ND="")  D
"RTN","GMRCSTU",9,0)
 .S:$P(^GMR(123,GMRCO,40,ND,0),"^",2)=21 GMRCDA=$P(^(0),"^",1)
"RTN","GMRCSTU",10,0)
 .S:$P(^GMR(123,GMRCO,40,ND,0),"^",2)=1 GMRCDA(1)=$P(^(0),"^",1)
"RTN","GMRCSTU",11,0)
 .S:$P(^GMR(123,GMRCO,40,ND,0),"^",2)=15 GMRCDA(15)=$P(^(0),"^",3)
"RTN","GMRCSTU",12,0)
 .I $P(^GMR(123,GMRCO,40,ND,0),"^",2)=10,$P(^(0),"^",3)<COMPLDT S COMPLDT=$P(^(0),"^",3)
"RTN","GMRCSTU",13,0)
 S RCVDT=$S($D(GMRCDA)#2:GMRCDA,$D(GMRCDA(1)):GMRCDA(1),$D(GMRCDA(15)):GMRCDA(15),1:$P(^GMR(123,GMRCO,0),"^",1))
"RTN","GMRCSTU",14,0)
 Q
"RTN","GMRCSTU",15,0)
EN ;
"RTN","GMRCSTU",16,0)
 K ^TMP("GMRCSLIST",$J),GMRCQUT
"RTN","GMRCSTU",17,0)
 ;Get the service/grouper
"RTN","GMRCSTU",18,0)
 D ASRV^GMRCASV
"RTN","GMRCSTU",19,0)
 G:$D(GMRCQUT) KILL
"RTN","GMRCSTU",20,0)
 I '$O(^TMP("GMRCSLIST",$J,0)) S GMRCQUT=1 G KILL
"RTN","GMRCSTU",21,0)
 ;Get the date range
"RTN","GMRCSTU",22,0)
 D ^GMRCSPD
"RTN","GMRCSTU",23,0)
 G:$D(GMRCQUT) KILL
"RTN","GMRCSTU",24,0)
 Q
"RTN","GMRCSTU",25,0)
 ;
"RTN","GMRCSTU",26,0)
ENOR(RETURN,GMRCSRVC,GMRCDT1,GMRCDT2) ;Entry point for GUI interface.
"RTN","GMRCSTU",27,0)
 ;.RETURN:   This is the root to the returned temp array.
"RTN","GMRCSTU",28,0)
 ;GMRCSRVC:  Service for which consults are to be displayed.
"RTN","GMRCSTU",29,0)
 ;GMRCDT1:  Starting date or "ALL"
"RTN","GMRCSTU",30,0)
 ;GMRCDT2:  Ending date if not GMRCDT1="ALL"
"RTN","GMRCSTU",31,0)
 ;
"RTN","GMRCSTU",32,0)
 ;^TMP("GMRCSLIST",$J,n)=ien^name^parient ien^"+" if grouper^status
"RTN","GMRCSTU",33,0)
 ;  status is "" tracking and/or grouper
"RTN","GMRCSTU",34,0)
 ;            1  grouper only
"RTN","GMRCSTU",35,0)
 ;            2  tracking only
"RTN","GMRCSTU",36,0)
 ;            9  disabled
"RTN","GMRCSTU",37,0)
 ;
"RTN","GMRCSTU",38,0)
 N GMRCEDT1,GMRCEDT2,GMRCDG,GMRCHEAD,GMRCCT,GMRCGRP,VALMCNT,VALMBCK
"RTN","GMRCSTU",39,0)
 N GMRCWRIT
"RTN","GMRCSTU",40,0)
 S GMRCWRIT=0
"RTN","GMRCSTU",41,0)
 K ^TMP("GMRCR",$J,"PRL")
"RTN","GMRCSTU",42,0)
 S RETURN="^TMP(""GMRCR"",$J,""PRL"")"
"RTN","GMRCSTU",43,0)
 I '($D(GMRCSRVC)#2) S GMRCSRVC=1
"RTN","GMRCSTU",44,0)
 Q:'$D(^GMR(123.5,$G(GMRCSRVC),0))
"RTN","GMRCSTU",45,0)
 ;Build service array
"RTN","GMRCSTU",46,0)
 S GMRCDG=GMRCSRVC
"RTN","GMRCSTU",47,0)
 D SERV1^GMRCASV
"RTN","GMRCSTU",48,0)
 ;Get external form of date range
"RTN","GMRCSTU",49,0)
 I '($D(GMRCDT1)#2) S GMRCDT1="ALL"
"RTN","GMRCSTU",50,0)
 S:GMRCDT1="ALL" GMRCDT2=0
"RTN","GMRCSTU",51,0)
 D LISTDATE^GMRCSTU1(GMRCDT1,$G(GMRCDT2),.GMRCEDT1,.GMRCEDT2)
"RTN","GMRCSTU",52,0)
 G ODTSTR
"RTN","GMRCSTU",53,0)
 ;
"RTN","GMRCSTU",54,0)
ODT ;List Manager entry point
"RTN","GMRCSTU",55,0)
 N GMRCWRIT
"RTN","GMRCSTU",56,0)
 S GMRCWRIT=1
"RTN","GMRCSTU",57,0)
 D WAIT^DICD
"RTN","GMRCSTU",58,0)
 ;
"RTN","GMRCSTU",59,0)
ODTSTR ;Find the mean, standard deviation of how long to complete a consult from when it is accepted in the service to when it is complete
"RTN","GMRCSTU",60,0)
 N RCVDT,COMPLDT,INDEX,TEMPTMP,GROUPER,TAB
"RTN","GMRCSTU",61,0)
 N GMRCDG,GMRCDGT,GMRCDT
"RTN","GMRCSTU",62,0)
 N GMRCGRP,GMRCND,GMRCO,ND,X,X1,X2,X3,X4
"RTN","GMRCSTU",63,0)
 I '$O(^TMP("GMRCSLIST",$J,0)) S GMRCQUT=1 G KILL
"RTN","GMRCSTU",64,0)
 S INDEX=0
"RTN","GMRCSTU",65,0)
 F  S INDEX=$O(^TMP("GMRCSLIST",$J,INDEX)) Q:INDEX=""  D
"RTN","GMRCSTU",66,0)
 .S ND=$P(^TMP("GMRCSLIST",$J,INDEX),"^",1)
"RTN","GMRCSTU",67,0)
 .Q:$P(^TMP("GMRCSLIST",$J,INDEX),"^",5)=9
"RTN","GMRCSTU",68,0)
 .S ^TMP("GMRCSVC",$J,1,ND,"T")="0^0^0^0^0^0"
"RTN","GMRCSTU",69,0)
 .S ^TMP("GMRCSVC",$J,1,ND,"I")="0^0^0^0^0"
"RTN","GMRCSTU",70,0)
 .S ^TMP("GMRCSVC",$J,1,ND,"O")="0^0^0^0^0"
"RTN","GMRCSTU",71,0)
 .S ^TMP("GMRCSVC",$J,1,ND,"U")="0^0^0^0^0"
"RTN","GMRCSTU",72,0)
 .S ^TMP("GMRCSVC",$J,2,ND,"T")="0^0^0^0^0^0"
"RTN","GMRCSTU",73,0)
 .S ^TMP("GMRCSVC",$J,2,ND,"I")="0^0^0^0^0"
"RTN","GMRCSTU",74,0)
 .S ^TMP("GMRCSVC",$J,2,ND,"O")="0^0^0^0^0"
"RTN","GMRCSTU",75,0)
 .S ^TMP("GMRCSVC",$J,2,ND,"U")="0^0^0^0^0"
"RTN","GMRCSTU",76,0)
 S GMRCND=0
"RTN","GMRCSTU",77,0)
 S INDEX=""
"RTN","GMRCSTU",78,0)
 F  S INDEX=$O(^TMP("GMRCSLIST",$J,INDEX),-1) Q:INDEX=""  D
"RTN","GMRCSTU",79,0)
 .S ND=$P(^TMP("GMRCSLIST",$J,INDEX),"^",1)
"RTN","GMRCSTU",80,0)
 .Q:$P(^TMP("GMRCSLIST",$J,INDEX),"^",5)=9
"RTN","GMRCSTU",81,0)
 .Q:$P(^TMP("GMRCSVC",$J,1,ND,"T"),"^",2)>0
"RTN","GMRCSTU",82,0)
 .I $P(^TMP("GMRCSLIST",$J,INDEX),"^",5)'=1 D
"RTN","GMRCSTU",83,0)
 ..S GMRCDT=""
"RTN","GMRCSTU",84,0)
 ..F  S GMRCDT=$O(^GMR(123,"AE",ND,2,GMRCDT)) Q:GMRCDT=""  D
"RTN","GMRCSTU",85,0)
 ...S GMRCO=0
"RTN","GMRCSTU",86,0)
 ...F  S GMRCO=$O(^GMR(123,"AE",ND,2,GMRCDT,GMRCO)) Q:GMRCO=""  D  W:GMRCWRIT&'(GMRCND#25) "."
"RTN","GMRCSTU",87,0)
 ....D GETDT(GMRCO)
"RTN","GMRCSTU",88,0)
 ....I COMPLDT<9999999,$S(GMRCDT1="ALL":1,RCVDT'<GMRCDT1&(RCVDT'>GMRCDT2):1,1:0) D
"RTN","GMRCSTU",89,0)
 .....S X1=COMPLDT
"RTN","GMRCSTU",90,0)
 .....S X2=RCVDT
"RTN","GMRCSTU",91,0)
 .....D ^%DTC
"RTN","GMRCSTU",92,0)
 .....IF X=0 D
"RTN","GMRCSTU",93,0)
 ......S X=$$FMDIFF^XLFDT(COMPLDT,RCVDT,3)
"RTN","GMRCSTU",94,0)
 ......S X=+$P(X," ",2)/24
"RTN","GMRCSTU",95,0)
 ......S X3=$E(X,1,3)
"RTN","GMRCSTU",96,0)
 ......S X4=$E(X,4)
"RTN","GMRCSTU",97,0)
 ......S:X4>4 X3=X3+.01
"RTN","GMRCSTU",98,0)
 ......S X=X3
"RTN","GMRCSTU",99,0)
 .....S $P(^TMP("GMRCSVC",$J,1,ND,"T"),U)=$P(^TMP("GMRCSVC",$J,1,ND,"T"),U)+X
"RTN","GMRCSTU",100,0)
 .....S $P(^TMP("GMRCSVC",$J,1,ND,"T"),"^",2)=$P(^TMP("GMRCSVC",$J,1,ND,"T"),"^",2)+1
"RTN","GMRCSTU",101,0)
 .....S $P(^TMP("GMRCSVC",$J,1,ND,"T"),"^",3)=$P(^TMP("GMRCSVC",$J,1,ND,"T"),"^",3)+(X*X)
"RTN","GMRCSTU",102,0)
 .....I $P(^GMR(123,GMRCO,0),"^",18)="I" D
"RTN","GMRCSTU",103,0)
 ......S $P(^TMP("GMRCSVC",$J,1,ND,"I"),"^",1)=$P(^TMP("GMRCSVC",$J,1,ND,"I"),"^",1)+X
"RTN","GMRCSTU",104,0)
 ......S $P(^TMP("GMRCSVC",$J,1,ND,"I"),"^",2)=$P(^TMP("GMRCSVC",$J,1,ND,"I"),"^",2)+1
"RTN","GMRCSTU",105,0)
 ......S $P(^TMP("GMRCSVC",$J,1,ND,"I"),"^",3)=$P(^TMP("GMRCSVC",$J,1,ND,"I"),"^",3)+(X*X)
"RTN","GMRCSTU",106,0)
 .....E  I $P(^GMR(123,GMRCO,0),"^",18)="O" D
"RTN","GMRCSTU",107,0)
 ......S $P(^TMP("GMRCSVC",$J,1,ND,"O"),"^",1)=$P(^TMP("GMRCSVC",$J,1,ND,"O"),"^",1)+X
"RTN","GMRCSTU",108,0)
 ......S $P(^TMP("GMRCSVC",$J,1,ND,"O"),"^",2)=$P(^TMP("GMRCSVC",$J,1,ND,"O"),"^",2)+1
"RTN","GMRCSTU",109,0)
 ......S $P(^TMP("GMRCSVC",$J,1,ND,"O"),"^",3)=$P(^TMP("GMRCSVC",$J,1,ND,"O"),"^",3)+(X*X)
"RTN","GMRCSTU",110,0)
 .....E  D
"RTN","GMRCSTU",111,0)
 ......S $P(^TMP("GMRCSVC",$J,1,ND,"U"),"^",1)=$P(^TMP("GMRCSVC",$J,1,ND,"U"),"^",1)+X
"RTN","GMRCSTU",112,0)
 ......S $P(^TMP("GMRCSVC",$J,1,ND,"U"),"^",2)=$P(^TMP("GMRCSVC",$J,1,ND,"U"),"^",2)+1
"RTN","GMRCSTU",113,0)
 ......S $P(^TMP("GMRCSVC",$J,1,ND,"U"),"^",3)=$P(^TMP("GMRCSVC",$J,1,ND,"U"),"^",3)+(X*X)
"RTN","GMRCSTU",114,0)
 .....S GMRCND=GMRCND+1
"RTN","GMRCSTU",115,0)
 .D PARENTS^GMRCSTU1(ND,+$P(^TMP("GMRCSLIST",$J,INDEX),"^",3))
"RTN","GMRCSTU",116,0)
 S ND=0
"RTN","GMRCSTU",117,0)
STAT ;Do the statistics
"RTN","GMRCSTU",118,0)
 F  S ND=$O(^TMP("GMRCSVC",$J,2,ND)) Q:ND=""  D
"RTN","GMRCSTU",119,0)
 .I $P($G(^TMP("GMRCSVC",$J,1,ND,"T")),"^",1)>0 D DOSTAT^GMRCSTU1(1,ND)
"RTN","GMRCSTU",120,0)
 .I $P(^TMP("GMRCSVC",$J,2,ND,"T"),"^",1)>0 D DOSTAT^GMRCSTU1(2,ND)
"RTN","GMRCSTU",121,0)
 K ^TMP("GMRCR",$J,"PRL")
"RTN","GMRCSTU",122,0)
 S GMRCCT=0
"RTN","GMRCSTU",123,0)
 D LISTDATE^GMRCSTU1(GMRCDT1,GMRCDT2,.GMRCEDT1,.GMRCEDT2)
"RTN","GMRCSTU",124,0)
 S TAB=""
"RTN","GMRCSTU",125,0)
 S $P(TAB," ",40)=""
"RTN","GMRCSTU",126,0)
 S GMRCCT=GMRCCT+1
"RTN","GMRCSTU",127,0)
 S ^TMP("GMRCR",$J,"PRL",GMRCCT,0)=$E(TAB,1,19)_"Consult/Request Completion Time Statistics"
"RTN","GMRCSTU",128,0)
 S GMRCCT=GMRCCT+1
"RTN","GMRCSTU",129,0)
 S TEMPTMP="FROM: "_GMRCEDT1_"   TO: "_GMRCEDT2
"RTN","GMRCSTU",130,0)
 S ^TMP("GMRCR",$J,"PRL",GMRCCT,0)=$E(TAB,1,40-($L(TEMPTMP)/2))_TEMPTMP
"RTN","GMRCSTU",131,0)
 S GMRCCT=GMRCCT+1
"RTN","GMRCSTU",132,0)
 S ^TMP("GMRCR",$J,"PRL",GMRCCT,0)=""
"RTN","GMRCSTU",133,0)
 S INDEX=0
"RTN","GMRCSTU",134,0)
 S GROUPER=0
"RTN","GMRCSTU",135,0)
 S GROUPER(0)=0
"RTN","GMRCSTU",136,0)
 F  S INDEX=$O(^TMP("GMRCSLIST",$J,INDEX)) Q:INDEX=""  D
"RTN","GMRCSTU",137,0)
 .S ND=$P(^TMP("GMRCSLIST",$J,INDEX),"^",1)
"RTN","GMRCSTU",138,0)
 .Q:$P(^TMP("GMRCSLIST",$J,INDEX),"^",5)=9&'$D(^TMP("GMRCSVC",$J,2,ND))
"RTN","GMRCSTU",139,0)
 .F  Q:GROUPER(GROUPER)=$P(^TMP("GMRCSLIST",$J,INDEX),"^",3)  D
"RTN","GMRCSTU",140,0)
 ..;End of a group so print the group totals
"RTN","GMRCSTU",141,0)
 ..D SERVSTAT^GMRCSTU1(.GMRCCT,2,GROUPER(GROUPER),GROUPER(GROUPER))
"RTN","GMRCSTU",142,0)
 ..;pop grouper from stack
"RTN","GMRCSTU",143,0)
 ..S GROUPER=GROUPER-1
"RTN","GMRCSTU",144,0)
 .I $P(^TMP("GMRCSLIST",$J,INDEX),"^",4)="+" D
"RTN","GMRCSTU",145,0)
 ..;Start of a new group so print the group heading.
"RTN","GMRCSTU",146,0)
 ..S GMRCCT=GMRCCT+1
"RTN","GMRCSTU",147,0)
 ..S TEMPTMP="GROUPER: "_$P(^GMR(123.5,ND,0),"^",1)
"RTN","GMRCSTU",148,0)
 ..S:$P(^TMP("GMRCSLIST",$J,INDEX),"^",3)>0 TEMPTMP=TEMPTMP_"  in Group: "_$P(^GMR(123.5,$P(^TMP("GMRCSLIST",$J,INDEX),"^",3),0),"^",1)
"RTN","GMRCSTU",149,0)
 ..S ^TMP("GMRCR",$J,"PRL",GMRCCT,0)=$E(TAB,1,40-(($L(TEMPTMP)/2)+.5))_TEMPTMP
"RTN","GMRCSTU",150,0)
 ..S GMRCCT=GMRCCT+1
"RTN","GMRCSTU",151,0)
 ..S ^TMP("GMRCR",$J,"PRL",GMRCCT,0)=""
"RTN","GMRCSTU",152,0)
 ..;push new grouper on stack
"RTN","GMRCSTU",153,0)
 ..S GROUPER=GROUPER+1
"RTN","GMRCSTU",154,0)
 ..S GROUPER(GROUPER)=ND
"RTN","GMRCSTU",155,0)
 .Q:$P(^TMP("GMRCSLIST",$J,INDEX),"^",5)=1
"RTN","GMRCSTU",156,0)
 .Q:$P(^TMP("GMRCSLIST",$J,INDEX),"^",5)=9
"RTN","GMRCSTU",157,0)
 .D SERVSTAT^GMRCSTU1(.GMRCCT,1,ND,GROUPER(GROUPER))
"RTN","GMRCSTU",158,0)
 ;Now list the group totals for the current groups.
"RTN","GMRCSTU",159,0)
 F GROUPER=GROUPER:-1:1 D
"RTN","GMRCSTU",160,0)
 .;End of a group so print the group totals
"RTN","GMRCSTU",161,0)
 .D SERVSTAT^GMRCSTU1(.GMRCCT,2,GROUPER(GROUPER),GROUPER(GROUPER))
"RTN","GMRCSTU",162,0)
 ;Done building list.
"RTN","GMRCSTU",163,0)
 S VALMCNT=GMRCCT,VALMBCK="R"
"RTN","GMRCSTU",164,0)
KILL ;kill variables and exit
"RTN","GMRCSTU",165,0)
 S:$D(GMRCQUT) VALMBCK="Q"
"RTN","GMRCSTU",166,0)
 K ^TMP("GMRCS",$J),^TMP("GMRCSLIST",$J)
"RTN","GMRCSTU",167,0)
 Q
"RTN","GMRCSTU",168,0)
PRNT ;print statistics to a printer
"RTN","GMRCSTU",169,0)
 ;Called from a List Manager action
"RTN","GMRCSTU",170,0)
 Q:'$D(^TMP("GMRCR",$J,"PRL",2,0))
"RTN","GMRCSTU",171,0)
 I $D(IOTM),$D(IOBM),$D(IOSTBM) D FULL^VALM1
"RTN","GMRCSTU",172,0)
 D PRNTASK
"RTN","GMRCSTU",173,0)
 D PRNTIT("PRL","PRNTQ^GMRCSTU","CONSULT/REQUEST PACKAGE PRINT COMPLETION TIME STATISTICS FROM LIST MANAGER DISPLAY")
"RTN","GMRCSTU",174,0)
 Q
"RTN","GMRCSTU",175,0)
 ;
"RTN","GMRCSTU",176,0)
PRNTASK ;Ask for device
"RTN","GMRCSTU",177,0)
 N POP,%ZIS
"RTN","GMRCSTU",178,0)
 K GMRCQUT
"RTN","GMRCSTU",179,0)
 S POP=0
"RTN","GMRCSTU",180,0)
 S %ZIS="MQ"
"RTN","GMRCSTU",181,0)
 D ^%ZIS
"RTN","GMRCSTU",182,0)
 I POP D  Q
"RTN","GMRCSTU",183,0)
 .S GMRCMSG="Printer Busy. Try Again Later."
"RTN","GMRCSTU",184,0)
 .D EXAC^GMRCADC(GMRCMSG)
"RTN","GMRCSTU",185,0)
 .K GMRCMSG
"RTN","GMRCSTU",186,0)
 .S GMRCQUT=1
"RTN","GMRCSTU",187,0)
 Q
"RTN","GMRCSTU",188,0)
 ;
"RTN","GMRCSTU",189,0)
PRNTIT(TMPNAME,QUERTN,QUEDESC) ;Send list to printer
"RTN","GMRCSTU",190,0)
 N ANSWER,INDEX,DOLLARH,ZTRTN,ZTDESC
"RTN","GMRCSTU",191,0)
 I $D(IO("Q")) D  Q
"RTN","GMRCSTU",192,0)
 .S DOLLARH=$H
"RTN","GMRCSTU",193,0)
 .M ^XTMP("GMRCR","$"_$J,DOLLARH,"PRINT")=^TMP("GMRCR",$J,TMPNAME)
"RTN","GMRCSTU",194,0)
 .S ZTRTN=QUERTN
"RTN","GMRCSTU",195,0)
 .S ZTDESC=QUEDESC
"RTN","GMRCSTU",196,0)
 .S ZTSAVE("J")="$"_$J
"RTN","GMRCSTU",197,0)
 .S ZTSAVE("DOLLARH")=""
"RTN","GMRCSTU",198,0)
 .S ZTSAVE("TMPNAME")=""
"RTN","GMRCSTU",199,0)
 .S ZTSAVE("GMRCDG")=""
"RTN","GMRCSTU",200,0)
 .S ZTSAVE("GMRCDT1")=""
"RTN","GMRCSTU",201,0)
 .S ZTSAVE("GMRCDT2")=""
"RTN","GMRCSTU",202,0)
 .D ^%ZTLOAD,^%ZISC
"RTN","GMRCSTU",203,0)
 .K ZTSAVE
"RTN","GMRCSTU",204,0)
 .S VALMBCK="R"
"RTN","GMRCSTU",205,0)
 U IO
"RTN","GMRCSTU",206,0)
 S ANSWER=""
"RTN","GMRCSTU",207,0)
 S INDEX=""
"RTN","GMRCSTU",208,0)
 F  S INDEX=$O(^TMP("GMRCR",$J,TMPNAME,INDEX)) Q:INDEX=""  W ^TMP("GMRCR",$J,TMPNAME,INDEX,0),! I IOST["C-",$S($D(IOSL)#2:$Y>(IOSL-2),1:$Y>22) R "Press <ENTER> To Continue, '^' To Quit: ",ANSWER:DTIME Q:'$T!(ANSWER["^")  W @IOF
"RTN","GMRCSTU",209,0)
 I ANSWER'["^",IOST["C-",$Y>1 R !,"Press <ENTER> To Continue: ",ANSWER:DTIME
"RTN","GMRCSTU",210,0)
 U IO(0)
"RTN","GMRCSTU",211,0)
 D ^%ZISC
"RTN","GMRCSTU",212,0)
 S VALMBCK="R"
"RTN","GMRCSTU",213,0)
 Q
"RTN","GMRCSTU",214,0)
 ;
"RTN","GMRCSTU",215,0)
PRNTQ ;Print Queued report from ^XTMP global then kill off ^XTMP
"RTN","GMRCSTU",216,0)
 N INDEX
"RTN","GMRCSTU",217,0)
 U IO
"RTN","GMRCSTU",218,0)
 S INDEX=""
"RTN","GMRCSTU",219,0)
 F  S INDEX=$O(^XTMP("GMRCR",J,DOLLARH,"PRINT",INDEX)) Q:INDEX=""  W ^XTMP("GMRCR",J,DOLLARH,"PRINT",INDEX,0),!
"RTN","GMRCSTU",220,0)
 K ^XTMP("GMRCR",J,DOLLARH,"PRINT"),J,DOLLARH
"RTN","GMRCSTU",221,0)
 D ^%ZISC
"RTN","GMRCSTU",222,0)
 Q
"RTN","GMRCSTU1")
0^2^B44975811
"RTN","GMRCSTU1",1,0)
GMRCSTU1 ;SLC/DCM,dee - Statistic Utilities for C/RT ;9/26/02 10:15
"RTN","GMRCSTU1",2,0)
 ;;3.0;CONSULT/REQUEST TRACKING;**7,29,43**;DEC 27, 1997
"RTN","GMRCSTU1",3,0)
 Q
"RTN","GMRCSTU1",4,0)
 ;
"RTN","GMRCSTU1",5,0)
SQRT(X) ;calculate the square root of number X
"RTN","GMRCSTU1",6,0)
 Q X**.5
"RTN","GMRCSTU1",7,0)
 ;
"RTN","GMRCSTU1",8,0)
PARENTS(ND,PARENT) ;Add totals for service to itself as a parent and to its parent service
"RTN","GMRCSTU1",9,0)
 ; ND      This service in GMRCSVC
"RTN","GMRCSTU1",10,0)
 ; PARENT  This services grouper in GMRCSVC
"RTN","GMRCSTU1",11,0)
 N ND2
"RTN","GMRCSTU1",12,0)
 F ND2="T","I","O","U" D
"RTN","GMRCSTU1",13,0)
 .S $P(^TMP("GMRCSVC",$J,2,ND,ND2),"^",1)=$P(^TMP("GMRCSVC",$J,2,ND,ND2),"^",1)+$P(^TMP("GMRCSVC",$J,1,ND,ND2),"^",1)
"RTN","GMRCSTU1",14,0)
 .S $P(^TMP("GMRCSVC",$J,2,ND,ND2),"^",2)=$P(^TMP("GMRCSVC",$J,2,ND,ND2),"^",2)+$P(^TMP("GMRCSVC",$J,1,ND,ND2),"^",2)
"RTN","GMRCSTU1",15,0)
 .S $P(^TMP("GMRCSVC",$J,2,ND,ND2),"^",3)=$P(^TMP("GMRCSVC",$J,2,ND,ND2),"^",3)+$P(^TMP("GMRCSVC",$J,1,ND,ND2),"^",3)
"RTN","GMRCSTU1",16,0)
 .I PARENT D
"RTN","GMRCSTU1",17,0)
 ..S $P(^TMP("GMRCSVC",$J,2,PARENT,ND2),"^",1)=$P($G(^TMP("GMRCSVC",$J,2,PARENT,ND2)),"^",1)+$P(^TMP("GMRCSVC",$J,2,ND,ND2),"^",1)
"RTN","GMRCSTU1",18,0)
 ..S $P(^TMP("GMRCSVC",$J,2,PARENT,ND2),"^",2)=$P($G(^TMP("GMRCSVC",$J,2,PARENT,ND2)),"^",2)+$P(^TMP("GMRCSVC",$J,2,ND,ND2),"^",2)
"RTN","GMRCSTU1",19,0)
 ..S $P(^TMP("GMRCSVC",$J,2,PARENT,ND2),"^",3)=$P($G(^TMP("GMRCSVC",$J,2,PARENT,ND2)),"^",3)+$P(^TMP("GMRCSVC",$J,2,ND,ND2),"^",3)
"RTN","GMRCSTU1",20,0)
 Q
"RTN","GMRCSTU1",21,0)
 ;
"RTN","GMRCSTU1",22,0)
DOSTAT(GEN,ND) ;Do the number crunching for the statistics
"RTN","GMRCSTU1",23,0)
 ; GEN    1 if service
"RTN","GMRCSTU1",24,0)
 ;        2 if grouper
"RTN","GMRCSTU1",25,0)
 ; ND      This service in GMRCSVC
"RTN","GMRCSTU1",26,0)
 N VAR,SUMX
"RTN","GMRCSTU1",27,0)
 S VAR=$P(^TMP("GMRCSVC",$J,GEN,ND,"T"),"^",2)
"RTN","GMRCSTU1",28,0)
 S $P(^TMP("GMRCSVC",$J,GEN,ND,"T"),"^",4)=$P(^TMP("GMRCSVC",$J,GEN,ND,"T"),"^",1)/VAR
"RTN","GMRCSTU1",29,0)
 I VAR>1 D
"RTN","GMRCSTU1",30,0)
 .S SUMX=$P(^TMP("GMRCSVC",$J,GEN,ND,"T"),"^",1)
"RTN","GMRCSTU1",31,0)
 .S SUMX=SUMX*SUMX/VAR
"RTN","GMRCSTU1",32,0)
 .S SUMX=($P(^TMP("GMRCSVC",$J,GEN,ND,"T"),"^",3)-SUMX)/(VAR-1)
"RTN","GMRCSTU1",33,0)
 .S $P(^TMP("GMRCSVC",$J,GEN,ND,"T"),"^",5)=$$SQRT(SUMX)
"RTN","GMRCSTU1",34,0)
 E  S $P(^TMP("GMRCSVC",$J,GEN,ND,"T"),"^",5)="N<2"
"RTN","GMRCSTU1",35,0)
 S VAR=$P(^TMP("GMRCSVC",$J,GEN,ND,"I"),"^",2)
"RTN","GMRCSTU1",36,0)
 I VAR>0 D
"RTN","GMRCSTU1",37,0)
 .S $P(^TMP("GMRCSVC",$J,GEN,ND,"I"),"^",4)=$P(^TMP("GMRCSVC",$J,GEN,ND,"I"),"^",1)/VAR
"RTN","GMRCSTU1",38,0)
 .I VAR>1 D
"RTN","GMRCSTU1",39,0)
 ..S SUMX=$P(^TMP("GMRCSVC",$J,GEN,ND,"I"),"^",1)
"RTN","GMRCSTU1",40,0)
 ..S SUMX=SUMX*SUMX/VAR
"RTN","GMRCSTU1",41,0)
 ..S SUMX=($P(^TMP("GMRCSVC",$J,GEN,ND,"I"),"^",3)-SUMX)/(VAR-1)
"RTN","GMRCSTU1",42,0)
 ..S $P(^TMP("GMRCSVC",$J,GEN,ND,"I"),"^",5)=$$SQRT(SUMX)
"RTN","GMRCSTU1",43,0)
 .E  S $P(^TMP("GMRCSVC",$J,GEN,ND,"I"),"^",5)="N<2"
"RTN","GMRCSTU1",44,0)
 S VAR=$P(^TMP("GMRCSVC",$J,GEN,ND,"O"),"^",2)
"RTN","GMRCSTU1",45,0)
 I VAR>0 D
"RTN","GMRCSTU1",46,0)
 .S $P(^TMP("GMRCSVC",$J,GEN,ND,"O"),"^",4)=$P(^TMP("GMRCSVC",$J,GEN,ND,"O"),"^",1)/VAR
"RTN","GMRCSTU1",47,0)
 .I VAR>1 D
"RTN","GMRCSTU1",48,0)
 ..S SUMX=$P(^TMP("GMRCSVC",$J,GEN,ND,"O"),"^",1)
"RTN","GMRCSTU1",49,0)
 ..S SUMX=SUMX*SUMX/VAR
"RTN","GMRCSTU1",50,0)
 ..S SUMX=($P(^TMP("GMRCSVC",$J,GEN,ND,"O"),"^",3)-SUMX)/(VAR-1)
"RTN","GMRCSTU1",51,0)
 ..S $P(^TMP("GMRCSVC",$J,GEN,ND,"O"),"^",5)=$$SQRT(SUMX)
"RTN","GMRCSTU1",52,0)
 .E  S $P(^TMP("GMRCSVC",$J,GEN,ND,"O"),"^",5)="N<2"
"RTN","GMRCSTU1",53,0)
 S VAR=$P(^TMP("GMRCSVC",$J,GEN,ND,"U"),"^",2)
"RTN","GMRCSTU1",54,0)
 I VAR>0 D
"RTN","GMRCSTU1",55,0)
 .S $P(^TMP("GMRCSVC",$J,GEN,ND,"U"),"^",4)=$P(^TMP("GMRCSVC",$J,GEN,ND,"U"),"^",1)/VAR
"RTN","GMRCSTU1",56,0)
 .I VAR>1 D
"RTN","GMRCSTU1",57,0)
 ..S SUMX=$P(^TMP("GMRCSVC",$J,GEN,ND,"U"),"^",1)
"RTN","GMRCSTU1",58,0)
 ..S SUMX=SUMX*SUMX/VAR
"RTN","GMRCSTU1",59,0)
 ..S SUMX=($P(^TMP("GMRCSVC",$J,GEN,ND,"U"),"^",3)-SUMX)/(VAR-1)
"RTN","GMRCSTU1",60,0)
 ..S $P(^TMP("GMRCSVC",$J,GEN,ND,"U"),"^",5)=$$SQRT(SUMX)
"RTN","GMRCSTU1",61,0)
 .E  S $P(^TMP("GMRCSVC",$J,GEN,ND,"U"),"^",5)="N<2"
"RTN","GMRCSTU1",62,0)
 Q
"RTN","GMRCSTU1",63,0)
 ;
"RTN","GMRCSTU1",64,0)
LISTDATE(GMRCDT1,GMRCDT2,GMRCEDT1,GMRCEDT2) ;Change dates to display format
"RTN","GMRCSTU1",65,0)
 ; Input:
"RTN","GMRCSTU1",66,0)
 ;  GMRCDT1  Start date in FM format, can be "ALL" for all dates
"RTN","GMRCSTU1",67,0)
 ;  GMRCDT2  End date in FM format, can be null if GMRCDT1 is "ALL"
"RTN","GMRCSTU1",68,0)
 ; Output:
"RTN","GMRCSTU1",69,0)
 ;  GMRCEDT1 Start date in external format
"RTN","GMRCSTU1",70,0)
 ;  GMRCEDT2 End date in extenal format
"RTN","GMRCSTU1",71,0)
 ;
"RTN","GMRCSTU1",72,0)
 S GMRCEDT1=$$FMTE^XLFDT(GMRCDT1)
"RTN","GMRCSTU1",73,0)
 S GMRCEDT2=$$FMTE^XLFDT(GMRCDT2)
"RTN","GMRCSTU1",74,0)
 I GMRCEDT1'="ALL" D
"RTN","GMRCSTU1",75,0)
 .S Y=GMRCEDT1
"RTN","GMRCSTU1",76,0)
 .X ^DD("DD")
"RTN","GMRCSTU1",77,0)
 .S GMRCEDT1=$P(Y,"@",1)
"RTN","GMRCSTU1",78,0)
 .K %,%DT,%H,%I
"RTN","GMRCSTU1",79,0)
 I GMRCEDT2=0 D
"RTN","GMRCSTU1",80,0)
 .S X="NOW"
"RTN","GMRCSTU1",81,0)
 .D NOW^%DTC
"RTN","GMRCSTU1",82,0)
 .S Y=%
"RTN","GMRCSTU1",83,0)
 .K %,%DT,%H,%I
"RTN","GMRCSTU1",84,0)
 .X ^DD("DD")
"RTN","GMRCSTU1",85,0)
 .S GMRCEDT2=$P(Y,"@",1)
"RTN","GMRCSTU1",86,0)
 Q
"RTN","GMRCSTU1",87,0)
 ;
"RTN","GMRCSTU1",88,0)
SERVSTAT(COUNT,GEN,ND,GRP) ;Build list for a service or a grouper
"RTN","GMRCSTU1",89,0)
 ; COUNT  subscript in to the array ^TMP("GMRCR"
"RTN","GMRCSTU1",90,0)
 ; GEN    1 if service
"RTN","GMRCSTU1",91,0)
 ;        2 if grouper
"RTN","GMRCSTU1",92,0)
 ; ND     Pointer to this this service in GMRCSVC
"RTN","GMRCSTU1",93,0)
 ; GRP    Pointer to grouper that this service is in ^GMR(123.5
"RTN","GMRCSTU1",94,0)
 ;        (If this is not a grouper i.e. GEN=2)
"RTN","GMRCSTU1",95,0)
 ;
"RTN","GMRCSTU1",96,0)
 N TEMP,NUMBER
"RTN","GMRCSTU1",97,0)
 S COUNT=COUNT+1
"RTN","GMRCSTU1",98,0)
 I GEN=1 D
"RTN","GMRCSTU1",99,0)
 .S TEMP="SERVICE: "_$P(^GMR(123.5,ND,0),"^",1)
"RTN","GMRCSTU1",100,0)
 .S:GRP>0 TEMP=TEMP_"  in Group: "_$P(^GMR(123.5,GRP,0),"^",1)
"RTN","GMRCSTU1",101,0)
 .S ^TMP("GMRCR",$J,"PRL",GMRCCT,0)=TEMP
"RTN","GMRCSTU1",102,0)
 E  D
"RTN","GMRCSTU1",103,0)
 .S TEMP="GROUPER: "_$P(^GMR(123.5,ND,0),"^",1)_" Totals:"
"RTN","GMRCSTU1",104,0)
 .S ^TMP("GMRCR",$J,"PRL",GMRCCT,0)=$E(TAB,1,10)_TEMP
"RTN","GMRCSTU1",105,0)
 S NUMBER=$P(^TMP("GMRCSVC",$J,GEN,ND,"T"),"^",2)
"RTN","GMRCSTU1",106,0)
 S COUNT=COUNT+1
"RTN","GMRCSTU1",107,0)
 S ^TMP("GMRCR",$J,"PRL",COUNT,0)="Total Number Of Consults Completed: "_NUMBER
"RTN","GMRCSTU1",108,0)
 S COUNT=COUNT+1
"RTN","GMRCSTU1",109,0)
 S TEMP="Mean Days To Complete: "
"RTN","GMRCSTU1",110,0)
 S:NUMBER>0 TEMP=TEMP_$J($P(^TMP("GMRCSVC",$J,GEN,ND,"T"),"^",4),4,2)
"RTN","GMRCSTU1",111,0)
 S TEMP=TEMP_$E(TAB,1,50-$L(TEMP))_"Standard Deviation: "
"RTN","GMRCSTU1",112,0)
 I NUMBER>0 S ^TMP("GMRCR",$J,"PRL",COUNT,0)=TEMP_$S($P(^TMP("GMRCSVC",$J,GEN,ND,"T"),"^",5)=+$P(^TMP("GMRCSVC",$J,GEN,ND,"T"),"^",5):$J($P(^TMP("GMRCSVC",$J,GEN,ND,"T"),"^",5),4,1),1:$P(^TMP("GMRCSVC",$J,GEN,ND,"T"),"^",5))
"RTN","GMRCSTU1",113,0)
 E  S ^TMP("GMRCR",$J,"PRL",COUNT,0)=TEMP
"RTN","GMRCSTU1",114,0)
 S NUMBER=$P(^TMP("GMRCSVC",$J,GEN,ND,"I"),"^",2)
"RTN","GMRCSTU1",115,0)
 S COUNT=COUNT+1
"RTN","GMRCSTU1",116,0)
 S ^TMP("GMRCR",$J,"PRL",COUNT,0)="Total INPATIENT Consults: "_NUMBER
"RTN","GMRCSTU1",117,0)
 S COUNT=COUNT+1
"RTN","GMRCSTU1",118,0)
 S TEMP="Mean Days To Complete: "
"RTN","GMRCSTU1",119,0)
 S:NUMBER>0 TEMP=TEMP_$J($P(^TMP("GMRCSVC",$J,GEN,ND,"I"),"^",4),4,2)
"RTN","GMRCSTU1",120,0)
 S TEMP=TEMP_$E(TAB,1,50-$L(TEMP))_"Standard Deviation: "
"RTN","GMRCSTU1",121,0)
 I NUMBER>0 D
"RTN","GMRCSTU1",122,0)
 . S TEMP=TEMP_$S($P(^TMP("GMRCSVC",$J,GEN,ND,"I"),"^",5)=+$P(^TMP("GMRCSVC",$J,GEN,ND,"I"),"^",5):$J($P(^TMP("GMRCSVC",$J,GEN,ND,"I"),"^",5),4,1),1:$P(^TMP("GMRCSVC",$J,GEN,ND,"I"),"^",5))
"RTN","GMRCSTU1",123,0)
 S ^TMP("GMRCR",$J,"PRL",COUNT,0)=TEMP
"RTN","GMRCSTU1",124,0)
 S NUMBER=$P(^TMP("GMRCSVC",$J,GEN,ND,"O"),"^",2)
"RTN","GMRCSTU1",125,0)
 S COUNT=COUNT+1
"RTN","GMRCSTU1",126,0)
 S ^TMP("GMRCR",$J,"PRL",COUNT,0)="Total OUTPATIENT Consults: "_NUMBER
"RTN","GMRCSTU1",127,0)
 S COUNT=COUNT+1
"RTN","GMRCSTU1",128,0)
 S TEMP="Mean Days To Complete: "
"RTN","GMRCSTU1",129,0)
 S:NUMBER>0 TEMP=TEMP_$J($P(^TMP("GMRCSVC",$J,GEN,ND,"O"),"^",4),4,2)
"RTN","GMRCSTU1",130,0)
 S TEMP=TEMP_$E(TAB,1,50-$L(TEMP))_"Standard Deviation: "
"RTN","GMRCSTU1",131,0)
 I NUMBER>0 D
"RTN","GMRCSTU1",132,0)
 . S TEMP=TEMP_$S($P(^TMP("GMRCSVC",$J,GEN,ND,"O"),"^",5)=+$P(^TMP("GMRCSVC",$J,GEN,ND,"O"),"^",5):$J($P(^TMP("GMRCSVC",$J,GEN,ND,"O"),"^",5),4,1),1:$P(^TMP("GMRCSVC",$J,GEN,ND,"O"),"^",5))
"RTN","GMRCSTU1",133,0)
 S ^TMP("GMRCR",$J,"PRL",COUNT,0)=TEMP
"RTN","GMRCSTU1",134,0)
 I $P(^TMP("GMRCSVC",$J,GEN,ND,"U"),"^",2)>0 D
"RTN","GMRCSTU1",135,0)
 .S NUMBER=$P(^TMP("GMRCSVC",$J,GEN,ND,"U"),"^",2)
"RTN","GMRCSTU1",136,0)
 .S COUNT=COUNT+1
"RTN","GMRCSTU1",137,0)
 .S ^TMP("GMRCR",$J,"PRL",COUNT,0)="Total Unclassified Consults: "_NUMBER
"RTN","GMRCSTU1",138,0)
 .S COUNT=COUNT+1
"RTN","GMRCSTU1",139,0)
 .S TEMP="Mean Days To Complete: "
"RTN","GMRCSTU1",140,0)
 .S:NUMBER>0 TEMP=TEMP_$J($P(^TMP("GMRCSVC",$J,GEN,ND,"U"),"^",4),4,2)
"RTN","GMRCSTU1",141,0)
 .S TEMP=TEMP_$E(TAB,1,50-$L(TEMP))_"Standard Deviation: "
"RTN","GMRCSTU1",142,0)
 .I NUMBER>0 D
"RTN","GMRCSTU1",143,0)
 .. S TEMP=TEMP_$S($P(^TMP("GMRCSVC",$J,GEN,ND,"U"),"^",5)=+$P(^TMP("GMRCSVC",$J,GEN,ND,"U"),"^",5):$J($P(^TMP("GMRCSVC",$J,GEN,ND,"U"),"^",5),4,1),1:$P(^TMP("GMRCSVC",$J,GEN,ND,"U"),"^",5))
"RTN","GMRCSTU1",144,0)
 .S ^TMP("GMRCR",$J,"PRL",COUNT,0)=TEMP
"RTN","GMRCSTU1",145,0)
 I +$P(^TMP("GMRCSVC",$J,GEN,ND,"T"),"^",6)>0 S COUNT=COUNT+1,^TMP("GMRCR",$J,"PRL",COUNT,0)="No. With Unresolved Accepted in Service Times: "_$J($P(^TMP("GMRCSVC",$J,GEN,ND,"T"),"^",6),3)_"  (Not Included In Statistics)"
"RTN","GMRCSTU1",146,0)
 S COUNT=COUNT+1
"RTN","GMRCSTU1",147,0)
 S ^TMP("GMRCR",$J,"PRL",COUNT,0)=""
"RTN","GMRCSTU1",148,0)
 Q
"VER")
8.0^22.0
**END**
**END**
