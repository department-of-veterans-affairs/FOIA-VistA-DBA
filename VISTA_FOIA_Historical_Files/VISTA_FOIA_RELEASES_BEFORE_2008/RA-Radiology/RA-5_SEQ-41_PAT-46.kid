Released RA*5*46 SEQ #41
Extracted from mail message
**KIDS**:RA*5.0*46^

**INSTALL NAME**
RA*5.0*46
"BLD",4722,0)
RA*5.0*46^RADIOLOGY/NUCLEAR MEDICINE^0^3040223^y
"BLD",4722,1,0)
^^1^1^3031010^
"BLD",4722,1,1,0)
See patch description for this patch for details.
"BLD",4722,4,0)
^9.64PA^^
"BLD",4722,"KRN",0)
^9.67PA^8989.52^19
"BLD",4722,"KRN",.4,0)
.4
"BLD",4722,"KRN",.401,0)
.401
"BLD",4722,"KRN",.402,0)
.402
"BLD",4722,"KRN",.403,0)
.403
"BLD",4722,"KRN",.5,0)
.5
"BLD",4722,"KRN",.84,0)
.84
"BLD",4722,"KRN",3.6,0)
3.6
"BLD",4722,"KRN",3.8,0)
3.8
"BLD",4722,"KRN",9.2,0)
9.2
"BLD",4722,"KRN",9.8,0)
9.8
"BLD",4722,"KRN",9.8,"NM",0)
^9.68A^1^1
"BLD",4722,"KRN",9.8,"NM",1,0)
RACPTCSV^^0^B32620282
"BLD",4722,"KRN",9.8,"NM","B","RACPTCSV",1)

"BLD",4722,"KRN",19,0)
19
"BLD",4722,"KRN",19.1,0)
19.1
"BLD",4722,"KRN",101,0)
101
"BLD",4722,"KRN",409.61,0)
409.61
"BLD",4722,"KRN",771,0)
771
"BLD",4722,"KRN",870,0)
870
"BLD",4722,"KRN",8989.51,0)
8989.51
"BLD",4722,"KRN",8989.52,0)
8989.52
"BLD",4722,"KRN",8994,0)
8994
"BLD",4722,"KRN","B",.4,.4)

"BLD",4722,"KRN","B",.401,.401)

"BLD",4722,"KRN","B",.402,.402)

"BLD",4722,"KRN","B",.403,.403)

"BLD",4722,"KRN","B",.5,.5)

"BLD",4722,"KRN","B",.84,.84)

"BLD",4722,"KRN","B",3.6,3.6)

"BLD",4722,"KRN","B",3.8,3.8)

"BLD",4722,"KRN","B",9.2,9.2)

"BLD",4722,"KRN","B",9.8,9.8)

"BLD",4722,"KRN","B",19,19)

"BLD",4722,"KRN","B",19.1,19.1)

"BLD",4722,"KRN","B",101,101)

"BLD",4722,"KRN","B",409.61,409.61)

"BLD",4722,"KRN","B",771,771)

"BLD",4722,"KRN","B",870,870)

"BLD",4722,"KRN","B",8989.51,8989.51)

"BLD",4722,"KRN","B",8989.52,8989.52)

"BLD",4722,"KRN","B",8994,8994)

"BLD",4722,"QUES",0)
^9.62^^
"BLD",4722,"REQB",0)
^9.611^1^1
"BLD",4722,"REQB",1,0)
RA*5.0*38^2
"BLD",4722,"REQB","B","RA*5.0*38",1)

"MBREQ")
0
"PKG",18,-1)
1^1
"PKG",18,0)
RADIOLOGY/NUCLEAR MEDICINE^RA^REGISTERS PATIENTS,RECORDS EXAMS,PROFILES,AMIS REPORTS
"PKG",18,20,0)
^9.402P^^
"PKG",18,22,0)
^9.49I^1^1
"PKG",18,22,1,0)
5.0^3011017^2980407^50
"PKG",18,22,1,"PAH",1,0)
46^3040223
"PKG",18,22,1,"PAH",1,1,0)
^^1^1^3040223
"PKG",18,22,1,"PAH",1,1,1,0)
See patch description for this patch for details.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
1
"RTN","RACPTCSV")
0^1^B32620282
"RTN","RACPTCSV",1,0)
RACPTCSV ;HISC/SWM - CPT Code Set Version ;2/23/04  09:03
"RTN","RACPTCSV",2,0)
 ;;5.0;Radiology/Nuclear Medicine;**38,46**;Mar 16, 1998
"RTN","RACPTCSV",3,0)
 Q
"RTN","RACPTCSV",4,0)
ACTC() ; find out if CPT CODE is active
"RTN","RACPTCSV",5,0)
 ; called from file 70.03 field 2's DIC("S")
"RTN","RACPTCSV",6,0)
 ; Y = ien file 71
"RTN","RACPTCSV",7,0)
 ; DA(2) = RADFN
"RTN","RACPTCSV",8,0)
 ; DA(1) = RADTI
"RTN","RACPTCSV",9,0)
 N RAACTIV,RA710,RACPT,RACPTNAM,RADT0,RAMSG,RADATE,RADATV
"RTN","RACPTCSV",10,0)
 N RATXT,RAI,RAX ; RATXT is local array of error text
"RTN","RACPTCSV",11,0)
 S RAACTIV=1 ; =1 no error, or CPT CODE is active
"RTN","RACPTCSV",12,0)
 S RAI=0 ; counter
"RTN","RACPTCSV",13,0)
 S RA710=^RAMIS(71,+Y,0)
"RTN","RACPTCSV",14,0)
 S RACPT=$P(RA710,U,9)
"RTN","RACPTCSV",15,0)
 I RACPT="",($P(RA710,U,6)="D")!($P(RA710,U,6)="S") D  S RAACTIV=0
"RTN","RACPTCSV",16,0)
 . S RAI=RAI+1
"RTN","RACPTCSV",17,0)
 . S RATXT(RAI)="** A Detailed or Series procedure is missing a CPT CODE.**"
"RTN","RACPTCSV",18,0)
 . Q
"RTN","RACPTCSV",19,0)
 S RADT0=^RADPT(DA(2),"DT",DA(1),0),RADATE=$P(RADT0,U)
"RTN","RACPTCSV",20,0)
 I $P(RA710,U,6)="P" D  S RAACTIV=0
"RTN","RACPTCSV",21,0)
 . S RAI=RAI+1
"RTN","RACPTCSV",22,0)
 . S RATXT(RAI)="** Procedure is a parent type. **"
"RTN","RACPTCSV",23,0)
 . Q
"RTN","RACPTCSV",24,0)
 I $D(^RAMIS(71,+Y,"I"))#2,^("I")'="",^("I")'>DT D  S RAACTIV=0
"RTN","RACPTCSV",25,0)
 . S RADATV=$$FMTE^XLFDT($P(^RAMIS(71,+Y,"I"),U),2) ; convert inact.dt
"RTN","RACPTCSV",26,0)
 . S RAI=RAI+1
"RTN","RACPTCSV",27,0)
 . S RATXT(RAI)="** Procedure is inactive since "_RADATV_". **"
"RTN","RACPTCSV",28,0)
 . Q
"RTN","RACPTCSV",29,0)
 I $P(RA710,U,12)'=$P(^RADPT(DA(2),"DT",DA(1),0),U,2) D  S RAACTIV=0
"RTN","RACPTCSV",30,0)
 . S RAI=RAI+1
"RTN","RACPTCSV",31,0)
 . S RATXT(RAI)="** Procedure's Imaging Type differs from Exam's Imaging Type. **"
"RTN","RACPTCSV",32,0)
 . Q
"RTN","RACPTCSV",33,0)
 S RADATV=$$FMTE^XLFDT(RADATE,2) ; convert Exam Date
"RTN","RACPTCSV",34,0)
 I RACPT,'$$ACTCODE^RACPTMSC(RACPT,RADATE) D  S RAACTIV=0
"RTN","RACPTCSV",35,0)
 . S RACPTNAM=$P($$NAMCODE^RACPTMSC(RACPT,RADATE),U)
"RTN","RACPTCSV",36,0)
 . S RAI=RAI+1
"RTN","RACPTCSV",37,0)
 . S RATXT(RAI)="** Procedure's CPT "_RACPTNAM_" is invalid for Exam Date "_RADATV_". **"
"RTN","RACPTCSV",38,0)
 .; if registering exam, and order is parent proc, display help message
"RTN","RACPTCSV",39,0)
 . I $D(RAOPT("REG")),$P($G(^RAMIS(71,+$P($G(^RAO(75.1,+$G(RAORDS(1)),0)),U,2),0)),U,6)="P" D
"RTN","RACPTCSV",40,0)
 .. S RAI=RAI+1
"RTN","RACPTCSV",41,0)
 .. S RATXT(RAI)="** Enter ""^"" to skip this descendent"
"RTN","RACPTCSV",42,0)
 .. S RAI=RAI+1
"RTN","RACPTCSV",43,0)
 .. S RATXT(RAI)="   or enter a procedure with an active CPT code. **"
"RTN","RACPTCSV",44,0)
 .. Q
"RTN","RACPTCSV",45,0)
 . Q
"RTN","RACPTCSV",46,0)
 I RAACTIV Q RAACTIV ; no errors flagged
"RTN","RACPTCSV",47,0)
 I '$D(RATXT) Q RAACTIV ; quit warning if no error text in local array
"RTN","RACPTCSV",48,0)
 ; X is what user typed, or is proc at // if user pressed return key
"RTN","RACPTCSV",49,0)
 I $E(RA710,1,$L(X))'=X Q RAACTIV ; quit warning if X'=prcnam begin chars
"RTN","RACPTCSV",50,0)
 I $P(^RAMIS(71,Y,0),U)'=X Q RAACTIV ; quit warning if lookup prcnam '= X
"RTN","RACPTCSV",51,0)
 ; if registering, quit warning if both met:
"RTN","RACPTCSV",52,0)
 ;  if user input matches order's procedure (frm descnd if parnt ordr)
"RTN","RACPTCSV",53,0)
 ;    if lookup IEN isn't same as order's proc's ien
"RTN","RACPTCSV",54,0)
 ; note:  RAPRC won't exist if procs added aftr descnts entered
"RTN","RACPTCSV",55,0)
 I $D(RAOPT("REG")),X=$G(RAPRC),Y'=$G(RAPROCI) Q RAACTIV
"RTN","RACPTCSV",56,0)
 S RAMSG=$P(RA710,U)
"RTN","RACPTCSV",57,0)
 D EN^DDIOL(RAMSG,,"!")
"RTN","RACPTCSV",58,0)
 S RAI=0
"RTN","RACPTCSV",59,0)
 F  S RAI=$O(RATXT(RAI)) Q:'RAI  S RAMSG=RATXT(RAI) D EN^DDIOL(RAMSG,,"!?4")
"RTN","RACPTCSV",60,0)
 S RAMSG=""
"RTN","RACPTCSV",61,0)
 D EN^DDIOL(RAMSG,,"!") ; put blank line after listing
"RTN","RACPTCSV",62,0)
 Q RAACTIV
"RTN","RACPTCSV",63,0)
FUTC() ; called from input templates [RA EXAM EDIT], [RA STATUS CHANGE]
"RTN","RACPTCSV",64,0)
 ; IF exam date is future to first Log Date:
"RTN","RACPTCSV",65,0)
 ;   check CPT CODE when/after that date arrives
"RTN","RACPTCSV",66,0)
 ;   and last Log Date isn't later than Exam Date
"RTN","RACPTCSV",67,0)
 ; assumes existing RADFN,RADTI,RACNI,RADTE
"RTN","RACPTCSV",68,0)
 ; RETURNS 0=inact.CPT Code, 1=active CPT Code
"RTN","RACPTCSV",69,0)
 N RADTEX,RARET,RALOG1,RALOGL,RA71,RACPTNAM,RAMSG,RAX
"RTN","RACPTCSV",70,0)
 S RARET=1 ; default return to 1 (active)
"RTN","RACPTCSV",71,0)
 S RAX=^RADPT(RADFN,"DT",RADTI,"P",RACNI,0) G:RAX="" FUTCQ
"RTN","RACPTCSV",72,0)
 S RADTEX=RADTE\1 ; date portion of RADTE
"RTN","RACPTCSV",73,0)
 S RALOG1=$O(^RADPT(RADFN,"DT",RADTI,"P",RACNI,"L",0)) G:'RALOG1 FUTCQ
"RTN","RACPTCSV",74,0)
 S RALOG1=+^RADPT(RADFN,"DT",RADTI,"P",RACNI,"L",RALOG1,0)\1 G:'RALOG1 FUTCQ ;dt portion 1st log date
"RTN","RACPTCSV",75,0)
 G:RALOG1'<RADTEX FUTCQ ;1st Log Date same/greater than Exam Date
"RTN","RACPTCSV",76,0)
 G:DT<RADTEX FUTCQ ; future Exam Date hasn't arrived yet
"RTN","RACPTCSV",77,0)
 S RALOGL=$O(^RADPT(RADFN,"DT",RADTI,"P",RACNI,"L",""),-1) G:'RALOGL FUTCQ
"RTN","RACPTCSV",78,0)
 S RALOGL=+^RADPT(RADFN,"DT",RADTI,"P",RACNI,"L",RALOGL,0)\1 ;dt portion last log date
"RTN","RACPTCSV",79,0)
 G:RALOGL'<RADTEX FUTCQ ;latest Log Date = OR > Exam Date
"RTN","RACPTCSV",80,0)
 ; now check CPT CODE from case record
"RTN","RACPTCSV",81,0)
 S RA71=$G(^RAMIS(71,+$P(RAX,U,2),0))
"RTN","RACPTCSV",82,0)
 S RARET=$$ACTCODE^RACPTMSC(+$P(RA71,"^",9),RADTE)
"RTN","RACPTCSV",83,0)
 I 'RARET D
"RTN","RACPTCSV",84,0)
 . S RACPTNAM=$P($$NAMCODE^RACPTMSC(+$P(RA71,"^",9),RADTE),U)
"RTN","RACPTCSV",85,0)
 . S RAMSG="*** Exam was registered with a future date, and since      ***"
"RTN","RACPTCSV",86,0)
 . D EN^DDIOL(RAMSG,,"!?4")
"RTN","RACPTCSV",87,0)
 . S RAMSG="*** registration, its CPT Code "_RACPTNAM_" has been inactivated. ***"
"RTN","RACPTCSV",88,0)
 . D EN^DDIOL(RAMSG,,"!?4")
"RTN","RACPTCSV",89,0)
 . S RAMSG="You must choose a procedure that has an active CPT Code."
"RTN","RACPTCSV",90,0)
 . D EN^DDIOL(RAMSG,,"!!?4")
"RTN","RACPTCSV",91,0)
 . D EN^DDIOL(" ",,"!?4")
"RTN","RACPTCSV",92,0)
 . Q
"RTN","RACPTCSV",93,0)
FUTCQ ;
"RTN","RACPTCSV",94,0)
 Q RARET
"RTN","RACPTCSV",95,0)
FUTCMOD() ; called from input templates [RA EXAM EDIT], [RA STATUS CHANGE]
"RTN","RACPTCSV",96,0)
 ; IF exam date is future to first Log Date:
"RTN","RACPTCSV",97,0)
 ;   check CPT Modifier when/after that date arrives
"RTN","RACPTCSV",98,0)
 ;   and last Log Date isn't later than Exam Date
"RTN","RACPTCSV",99,0)
 ; assumes existing RADFN,RADTI,RACNI,RADTE
"RTN","RACPTCSV",100,0)
 ; RETURNS 0=at least one CPT Mod is inactive, 1=all CPT Mods active
"RTN","RACPTCSV",101,0)
 N RADTEX,RARET,RALOG1,RALOGL,RA813,RAMSG,RA0,RA1,RAX,RAMODSTR
"RTN","RACPTCSV",102,0)
 S RARET=1 ;default return value to 1
"RTN","RACPTCSV",103,0)
 G:'$O(^RADPT(RADFN,"DT",RADTI,"P",RACNI,"CMOD",0)) FUTCMODQ ; no cpt mod entered
"RTN","RACPTCSV",104,0)
 S RADTEX=RADTE\1 ; date portion of RADTE
"RTN","RACPTCSV",105,0)
 S RALOG1=$O(^RADPT(RADFN,"DT",RADTI,"P",RACNI,"L",0)) G:'RALOG1 FUTCMODQ
"RTN","RACPTCSV",106,0)
 S RALOG1=+^RADPT(RADFN,"DT",RADTI,"P",RACNI,"L",RALOG1,0)\1 G:'RALOG1 FUTCMODQ ;dt portion 1st log date
"RTN","RACPTCSV",107,0)
 G:RALOG1'<RADTEX FUTCMODQ ; 1st Log date same/greater than Exam Date
"RTN","RACPTCSV",108,0)
 G:DT<RADTEX FUTCMODQ ; future Exam Date hasn't arrived yet
"RTN","RACPTCSV",109,0)
 S RALOGL=$O(^RADPT(RADFN,"DT",RADTI,"P",RACNI,"L",""),-1) G:'RALOGL FUTCMODQ
"RTN","RACPTCSV",110,0)
 S RALOGL=+^RADPT(RADFN,"DT",RADTI,"P",RACNI,"L",RALOGL,0)\1 G:'RALOGL FUTCMODQ ;dt portion last log date
"RTN","RACPTCSV",111,0)
 G:RALOGL'<RADTEX FUTCMODQ ;latest Log Date = OR > Exam Date
"RTN","RACPTCSV",112,0)
 ; now check all CPT Mods from case record
"RTN","RACPTCSV",113,0)
 S RA1=0 F  S RA1=$O(^RADPT(RADFN,"DT",RADTI,"P",RACNI,"CMOD",RA1)) Q:'RA1  D
"RTN","RACPTCSV",114,0)
 . S RAX=+^RADPT(RADFN,"DT",RADTI,"P",RACNI,"CMOD",RA1,0)
"RTN","RACPTCSV",115,0)
 . S RA0=$$ACTMOD^RACPTMSC(RAX,RADTE)
"RTN","RACPTCSV",116,0)
 . I 'RA0 S RARET=0 D
"RTN","RACPTCSV",117,0)
 .. S RAMSG="Exam was registered with a future date, and since registration,"
"RTN","RACPTCSV",118,0)
 .. D EN^DDIOL(RAMSG,,"!?4")
"RTN","RACPTCSV",119,0)
 .. S RAMSG=$P(RAMODSTR,"^",2)_" "_$P(RAMODSTR,"^",3)_" has been inactivated."
"RTN","RACPTCSV",120,0)
 .. D EN^DDIOL(RAMSG,,"!?4")
"RTN","RACPTCSV",121,0)
 .. Q
"RTN","RACPTCSV",122,0)
 . Q
"RTN","RACPTCSV",123,0)
 I 'RARET D EN^DDIOL("You must delete the inactive CPT Modifier(s) before you can continue.",,"!?4")
"RTN","RACPTCSV",124,0)
FUTCMODQ ;
"RTN","RACPTCSV",125,0)
 Q RARET
"RTN","RACPTCSV",126,0)
 ;
"VER")
8.0^22
**END**
**END**
