Released RMPR*3*99 SEQ #76
Extracted from mail message
**KIDS**:RMPR*3.0*99^

**INSTALL NAME**
RMPR*3.0*99
"BLD",5514,0)
RMPR*3.0*99^PROSTHETICS^0^3041109^y
"BLD",5514,4,0)
^9.64PA^660^1
"BLD",5514,4,660,0)
660
"BLD",5514,4,660,2,0)
^9.641^660^1
"BLD",5514,4,660,2,660,0)
RECORD OF PROS APPLIANCE/REPAIR  (File-top level)
"BLD",5514,4,660,2,660,1,0)
^9.6411^4^1
"BLD",5514,4,660,2,660,1,4,0)
ITEM
"BLD",5514,4,660,222)
y^y^p^^^^n^^n
"BLD",5514,4,660,224)

"BLD",5514,4,"APDD",660,660)

"BLD",5514,4,"APDD",660,660,4)

"BLD",5514,4,"B",660,660)

"BLD",5514,"ABPKG")
n
"BLD",5514,"INID")
^n
"BLD",5514,"INIT")
XREF^RMPRU99
"BLD",5514,"KRN",0)
^9.67PA^8989.52^19
"BLD",5514,"KRN",.4,0)
.4
"BLD",5514,"KRN",.401,0)
.401
"BLD",5514,"KRN",.402,0)
.402
"BLD",5514,"KRN",.403,0)
.403
"BLD",5514,"KRN",.5,0)
.5
"BLD",5514,"KRN",.84,0)
.84
"BLD",5514,"KRN",3.6,0)
3.6
"BLD",5514,"KRN",3.8,0)
3.8
"BLD",5514,"KRN",9.2,0)
9.2
"BLD",5514,"KRN",9.8,0)
9.8
"BLD",5514,"KRN",9.8,"NM",0)
^9.68A^11^11
"BLD",5514,"KRN",9.8,"NM",1,0)
RMPRPAT3^^0^B38507405
"BLD",5514,"KRN",9.8,"NM",2,0)
RMPRPAT2^^0^B25980530
"BLD",5514,"KRN",9.8,"NM",3,0)
RMPOPAT2^^0^B29575123
"BLD",5514,"KRN",9.8,"NM",4,0)
RMPOPAT3^^0^B37951435
"BLD",5514,"KRN",9.8,"NM",5,0)
RMPOBIL5^^0^B13391809
"BLD",5514,"KRN",9.8,"NM",6,0)
RMPOBIL7^^0^B16571456
"BLD",5514,"KRN",9.8,"NM",7,0)
RMPRPRT1^^0^B21363701
"BLD",5514,"KRN",9.8,"NM",8,0)
RMPRU99^^0^B371206
"BLD",5514,"KRN",9.8,"NM",9,0)
RMPR9S4^^0^B24749556
"BLD",5514,"KRN",9.8,"NM",10,0)
RMPR9S8^^0^B21539447
"BLD",5514,"KRN",9.8,"NM",11,0)
RMPR9S4E^^0^B41302904
"BLD",5514,"KRN",9.8,"NM","B","RMPOBIL5",5)

"BLD",5514,"KRN",9.8,"NM","B","RMPOBIL7",6)

"BLD",5514,"KRN",9.8,"NM","B","RMPOPAT2",3)

"BLD",5514,"KRN",9.8,"NM","B","RMPOPAT3",4)

"BLD",5514,"KRN",9.8,"NM","B","RMPR9S4",9)

"BLD",5514,"KRN",9.8,"NM","B","RMPR9S4E",11)

"BLD",5514,"KRN",9.8,"NM","B","RMPR9S8",10)

"BLD",5514,"KRN",9.8,"NM","B","RMPRPAT2",2)

"BLD",5514,"KRN",9.8,"NM","B","RMPRPAT3",1)

"BLD",5514,"KRN",9.8,"NM","B","RMPRPRT1",7)

"BLD",5514,"KRN",9.8,"NM","B","RMPRU99",8)

"BLD",5514,"KRN",19,0)
19
"BLD",5514,"KRN",19,"NM",0)
^9.68A^^
"BLD",5514,"KRN",19.1,0)
19.1
"BLD",5514,"KRN",101,0)
101
"BLD",5514,"KRN",409.61,0)
409.61
"BLD",5514,"KRN",771,0)
771
"BLD",5514,"KRN",870,0)
870
"BLD",5514,"KRN",8989.51,0)
8989.51
"BLD",5514,"KRN",8989.52,0)
8989.52
"BLD",5514,"KRN",8994,0)
8994
"BLD",5514,"KRN","B",.4,.4)

"BLD",5514,"KRN","B",.401,.401)

"BLD",5514,"KRN","B",.402,.402)

"BLD",5514,"KRN","B",.403,.403)

"BLD",5514,"KRN","B",.5,.5)

"BLD",5514,"KRN","B",.84,.84)

"BLD",5514,"KRN","B",3.6,3.6)

"BLD",5514,"KRN","B",3.8,3.8)

"BLD",5514,"KRN","B",9.2,9.2)

"BLD",5514,"KRN","B",9.8,9.8)

"BLD",5514,"KRN","B",19,19)

"BLD",5514,"KRN","B",19.1,19.1)

"BLD",5514,"KRN","B",101,101)

"BLD",5514,"KRN","B",409.61,409.61)

"BLD",5514,"KRN","B",771,771)

"BLD",5514,"KRN","B",870,870)

"BLD",5514,"KRN","B",8989.51,8989.51)

"BLD",5514,"KRN","B",8989.52,8989.52)

"BLD",5514,"KRN","B",8994,8994)

"BLD",5514,"QUES",0)
^9.62^^
"BLD",5514,"REQB",0)
^9.611^5^5
"BLD",5514,"REQB",1,0)
RMPR*3.0*92^2
"BLD",5514,"REQB",2,0)
RMPR*3.0*70^2
"BLD",5514,"REQB",3,0)
RMPR*3.0*59^2
"BLD",5514,"REQB",4,0)
RMPR*3.0*29^2
"BLD",5514,"REQB",5,0)
RMPR*3.0*44^2
"BLD",5514,"REQB","B","RMPR*3.0*29",4)

"BLD",5514,"REQB","B","RMPR*3.0*44",5)

"BLD",5514,"REQB","B","RMPR*3.0*59",3)

"BLD",5514,"REQB","B","RMPR*3.0*70",2)

"BLD",5514,"REQB","B","RMPR*3.0*92",1)

"FIA",660)
RECORD OF PROS APPLIANCE/REPAIR
"FIA",660,0)
^RMPR(660,
"FIA",660,0,0)
660IOD
"FIA",660,0,1)
y^y^p^^^^n^^n
"FIA",660,0,10)

"FIA",660,0,11)

"FIA",660,0,"RLRO")

"FIA",660,0,"VR")
3.0^RMPR
"FIA",660,660)
1
"FIA",660,660,4)

"INIT")
XREF^RMPRU99
"MBREQ")
0
"PKG",150,-1)
1^1
"PKG",150,0)
PROSTHETICS^RMPR^PROSTHETICS VERSION 3.0 ALPHA
"PKG",150,22,0)
^9.49I^1^1
"PKG",150,22,1,0)
3.0^2960209^2960620
"PKG",150,22,1,"PAH",1,0)
99^3041109^34015
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
11
"RTN","RMPOBIL5")
0^5^B13391809
"RTN","RMPOBIL5",1,0)
RMPOBIL5 ;(NG)/DUG - HOME OXYGEN BILLING TRANSACTIONS ;7/24/98
"RTN","RMPOBIL5",2,0)
 ;;3.0;PROSTHETICS;**29,99**;Feb 09, 1996
"RTN","RMPOBIL5",3,0)
 S (RC,RA,AN,ANS,RK,RZ)=0 D HDR
"RTN","RMPOBIL5",4,0)
 F  S RA=$O(^RMPR(660,"AC",RMPRDFN,RA)) Q:RA=""  D
"RTN","RMPOBIL5",5,0)
 . S AN=""
"RTN","RMPOBIL5",6,0)
 . F  S AN=$O(^RMPR(660,"AC",RMPRDFN,RA,AN)) Q:AN=""  D
"RTN","RMPOBIL5",7,0)
 . . I $D(^RMPO(665.72,"AC",AN))>0 S RC=RC+1,IT(RC)=AN
"RTN","RMPOBIL5",8,0)
 G:'$D(IT) END
"RTN","RMPOBIL5",9,0)
DIS ;DISPLAY APPLIANCES OR REPAIRS
"RTN","RMPOBIL5",10,0)
 I $G(RK)="" S (RC,RK)=""
"RTN","RMPOBIL5",11,0)
 I RK+1'>RC S RK=RK+1,AN=+IT(RK) D  G:$$XIT EXIT G DIS
"RTN","RMPOBIL5",12,0)
 . S Y=^RMPR(660,AN,0) D PRT,OVER:((IOSL-4)<$Y)
"RTN","RMPOBIL5",13,0)
END I RC=0 W !,"No home oxygen items for this veteran!",!! H 3 G EXIT
"RTN","RMPOBIL5",14,0)
 E  D  G EXIT
"RTN","RMPOBIL5",15,0)
 .I RC>0 D  I $G(RK)+1'>$G(RC) D DIS
"RTN","RMPOBIL5",16,0)
 . . W !!,"End of Home Oxygen records for this veteran!" D OVER
"RTN","RMPOBIL5",17,0)
 .I $G(RC)="" Q
"RTN","RMPOBIL5",18,0)
EXIT Q:'$D(RMPRDFN)
"RTN","RMPOBIL5",19,0)
 W ! K I,J,L,R0,IT,RA
"RTN","RMPOBIL5",20,0)
 I $D(DUOUT)!($D(DTOUT)) G ASK1^RMPRPAT
"RTN","RMPOBIL5",21,0)
 S FL=4 G ASK2^RMPRPAT
"RTN","RMPOBIL5",22,0)
 K RMPRCNUM,TRANS,TRANS1,TYPE,VEN
"RTN","RMPOBIL5",23,0)
 K AMIS,AN,CST,DATE,DEL,DUOUT,DTOUT,FL,FRM,PAGE,QTY,RC,REM,RZ,RK,SN,STA
"RTN","RMPOBIL5",24,0)
 Q
"RTN","RMPOBIL5",25,0)
XIT() Q '$D(ANS)!(ANS=U)!($D(DUOUT))!($D(DTOUT))
"RTN","RMPOBIL5",26,0)
PRT S DATE=$P(Y,U,3),TYPE=$P(Y,U,6),QTY=$P(Y,U,7)
"RTN","RMPOBIL5",27,0)
 S VEN=$P(Y,U,9),TRANS=$P(Y,U,4),STA=$P(Y,U,10),SN=$P(Y,U,11)
"RTN","RMPOBIL5",28,0)
 S DEL=$P(Y,U,12)
"RTN","RMPOBIL5",29,0)
 S CST=$S($P(Y,U,16)'="":$P(Y,U,16),$D(^RMPR(660,AN,"LB")):$P(^RMPR(660,AN,"LB"),U,9),1:"")
"RTN","RMPOBIL5",30,0)
 ;form requested on
"RTN","RMPOBIL5",31,0)
 S FRM=$P(Y,U,13),REM=$P(Y,U,18)
"RTN","RMPOBIL5",32,0)
 S DATE=$E(DATE,4,5)_"/"_$E(DATE,6,7)_"/"_$E(DATE,2,3)
"RTN","RMPOBIL5",33,0)
 ;S TYPE=$S(TYPE="":"",$D(^RMPR(661,TYPE,0)):$P(^(0),U,1),1:"")
"RTN","RMPOBIL5",34,0)
 S TYPE=$P($G(^RMPR(660,AN,1)),U,4)
"RTN","RMPOBIL5",35,0)
 S AMIS=$P(Y,U,15),VEN=$S(VEN="":"",$D(^PRC(440,VEN,0)):$P(^(0),U,1),1:"")
"RTN","RMPOBIL5",36,0)
 I $D(^RMPR(660.1,"AC",AN)),$P(^RMPR(660.1,$O(^RMPR(660.1,"AC",AN,0)),0),U,11)]"" S AMIS=AMIS_"+"
"RTN","RMPOBIL5",37,0)
 S TRANS=$S(TRANS]"":TRANS,1:""),TRANS1=""
"RTN","RMPOBIL5",38,0)
 S:TRANS="X" TRANS1=TRANS,TRANS=""
"RTN","RMPOBIL5",39,0)
 S DEL=$E(DEL,4,5)_"/"_$E(DEL,6,7)_"/"_$E(DEL,2,3) S:DEL="//" DEL=""
"RTN","RMPOBIL5",40,0)
 W !,RK,". ",DATE,?13,QTY,?17
"RTN","RMPOBIL5",41,0)
 ;W AMIS_$S(TYPE'="":$E($P(^PRC(441,TYPE,0),U,2),1,10),$P(Y,U,26)="D":"DELIVERY",$P(Y,U,26)="P":"PICKUP",$P(Y,U,17):"SHIPPING",1:"")
"RTN","RMPOBIL5",42,0)
 W AMIS_$S(TYPE'="":$E($P($G(^RMPR(661.1,TYPE,0)),U,2),1,10),$P(Y,U,26)="D":"DELIVERY",$P(Y,U,26)="P":"PICKUP",$P(Y,U,17):"SHIPPING",1:"")
"RTN","RMPOBIL5",43,0)
 ;W:$D(^RMPR(660,$P(IT(RK),U,1),"HST")) $E($P(^("HST"),U,1),1,10)
"RTN","RMPOBIL5",44,0)
 I TYPE=""&($D(^RMPR(660,$P(IT(RK),U,1),"HST"))) W $E($P(^("HST"),U,1),1,10)
"RTN","RMPOBIL5",45,0)
 W ?30,TRANS,?31,TRANS1
"RTN","RMPOBIL5",46,0)
 ;display source of procurement for 2529-3 under vendor header
"RTN","RMPOBIL5",47,0)
 I $D(RMPRLPRO) W ?33,RMPRLPRO
"RTN","RMPOBIL5",48,0)
 K RMPRLPRO
"RTN","RMPOBIL5",49,0)
 I VEN'="" W ?33,$E(VEN,1,10)
"RTN","RMPOBIL5",50,0)
 W:$D(^RMPR(660,$P(IT(RK),U,1),"HST")) $E($P(^("HST"),U,3),1,10)
"RTN","RMPOBIL5",51,0)
 W:STA'="" ?45,$P(^DIC(4,STA,99),U,1)
"RTN","RMPOBIL5",52,0)
 W ?50,$E(SN,1,9),?60,DEL
"RTN","RMPOBIL5",53,0)
 W ?71,$J($FN($S(CST'="":CST,$P(Y,U,17):$P(Y,U,17),1:""),"T",2),9)
"RTN","RMPOBIL5",54,0)
 W:REM]"" !,?3,REM
"RTN","RMPOBIL5",55,0)
 I $P(IT(RK),U,2)="" S IT(RK)=IT(RK)_"^"_RZ
"RTN","RMPOBIL5",56,0)
 Q
"RTN","RMPOBIL5",57,0)
OVER N ANS
"RTN","RMPOBIL5",58,0)
 S RZ=RK W !,"+=Turned-In  *=Historical Data  I=Initial  X=Repair  S=Spare  R=Replacement",!,"Enter 1-",RK," to show full entry, '^' to exit or `return` to continue.  " R ANS:DTIME S:'$T ANS="^"
"RTN","RMPOBIL5",59,0)
 I ANS="^^" S ANS="^" G ASK1^RMPRPAT Q
"RTN","RMPOBIL5",60,0)
 I ANS="^" G ASK1^RMPRPAT Q
"RTN","RMPOBIL5",61,0)
 I ANS="",RK+1'>RC D HDR Q
"RTN","RMPOBIL5",62,0)
 I ANS="" Q
"RTN","RMPOBIL5",63,0)
 I ANS'?1N.N!(ANS>RK)!(+ANS=0)!(+ANS'=ANS) W $C(7),!," Must be between 1 and ",RK," to be valid" G OVER
"RTN","RMPOBIL5",64,0)
 I ANS>0,(ANS<(RK+1)) S AN=ANS,RZ=RK D ^RMPRPAT3
"RTN","RMPOBIL5",65,0)
 S RK=$P(IT(ANS),U,2)
"RTN","RMPOBIL5",66,0)
 Q
"RTN","RMPOBIL5",67,0)
HDR ;Print Header, Screen 4
"RTN","RMPOBIL5",68,0)
 W @IOF
"RTN","RMPOBIL5",69,0)
 S PAGE=3
"RTN","RMPOBIL5",70,0)
 W !,$E(RMPRNAM,1,20),?23,"SSN: "
"RTN","RMPOBIL5",71,0)
 W $E(RMPRSSN,1,3)_"-"_$E(RMPRSSN,4,5)_"-"_$E(RMPRSSN,6,10)
"RTN","RMPOBIL5",72,0)
 W ?42,"DOB: "
"RTN","RMPOBIL5",73,0)
 S Y=RMPRDOB X ^DD("DD") W Y K Y
"RTN","RMPOBIL5",74,0)
 W ?61,"CLAIM# ",$G(RMPRCNUM)
"RTN","RMPOBIL5",75,0)
 W !?4,"Date",?12,"Qty",?19,"HCPCS",?28,"Type",?34,"Vendor",?45,"Sta",?50,"Serial",?58,"Delivery Date",?72,"Tot Cost"
"RTN","RMPOBIL5",76,0)
 Q
"RTN","RMPOBIL7")
0^6^B16571456
"RTN","RMPOBIL7",1,0)
RMPOBIL7 ;HINES CIO/RVD - HOME OXYGEN BILLING TRANSACTIONS ;9/16/02  11:11
"RTN","RMPOBIL7",2,0)
 ;;3.0;PROSTHETICS;**70,99**;Feb 09, 1996
"RTN","RMPOBIL7",3,0)
 ;RVD 7/8/02 patch #70 - this is a copy of RMPOBIL5 routine.
"RTN","RMPOBIL7",4,0)
 ;                       For Read Only 2319.
"RTN","RMPOBIL7",5,0)
 ;
"RTN","RMPOBIL7",6,0)
 ;DBIA # 800 - for this routine, the agreement covers the field #.01 NAME
"RTN","RMPOBIL7",7,0)
 ;             file #440.
"RTN","RMPOBIL7",8,0)
 ;DBIA # 801 - for this routine, the agreement covers the field
"RTN","RMPOBIL7",9,0)
 ;             #.05 Short Description, file #441.
"RTN","RMPOBIL7",10,0)
 ;DBIA # 10090 - Fileman read of file #4, field #99.
"RTN","RMPOBIL7",11,0)
 ;
"RTN","RMPOBIL7",12,0)
 N DA,DR,DIQ,DIC
"RTN","RMPOBIL7",13,0)
 K ^UTILITY("DIQ1",$J)
"RTN","RMPOBIL7",14,0)
 S (RC,RA,AN,ANS,RK,RZ)=0 D HDR
"RTN","RMPOBIL7",15,0)
 F  S RA=$O(^RMPR(660,"AC",RMPRDFN,RA)) Q:RA=""  D
"RTN","RMPOBIL7",16,0)
 . S AN=""
"RTN","RMPOBIL7",17,0)
 . F  S AN=$O(^RMPR(660,"AC",RMPRDFN,RA,AN)) Q:AN=""  D
"RTN","RMPOBIL7",18,0)
 . . I $D(^RMPO(665.72,"AC",AN))>0 S RC=RC+1,IT(RC)=AN
"RTN","RMPOBIL7",19,0)
 G:'$D(IT) END
"RTN","RMPOBIL7",20,0)
DIS ;DISPLAY APPLIANCES OR REPAIRS
"RTN","RMPOBIL7",21,0)
 I $G(RK)="" S (RC,RK)=""
"RTN","RMPOBIL7",22,0)
 I RK+1'>RC S RK=RK+1,AN=+IT(RK) D  G:$$XIT EXIT G DIS
"RTN","RMPOBIL7",23,0)
 . S Y=^RMPR(660,AN,0) D PRT,OVER:((IOSL-4)<$Y)
"RTN","RMPOBIL7",24,0)
END I RC=0 W !,"No home oxygen items for this veteran!",!! H 3 G EXIT
"RTN","RMPOBIL7",25,0)
 E  D  G EXIT
"RTN","RMPOBIL7",26,0)
 .I RC>0 D  I $G(RK)+1'>$G(RC) D DIS
"RTN","RMPOBIL7",27,0)
 . . W !!,"End of Home Oxygen records for this veteran!" D OVER
"RTN","RMPOBIL7",28,0)
 .I $G(RC)="" Q
"RTN","RMPOBIL7",29,0)
EXIT Q:'$D(RMPRDFN)
"RTN","RMPOBIL7",30,0)
 W ! K I,J,L,R0,IT,RA
"RTN","RMPOBIL7",31,0)
 I $D(DUOUT)!($D(DTOUT)) G ASK1^RMPOPAT
"RTN","RMPOBIL7",32,0)
 S FL=4 G ASK2^RMPOPAT
"RTN","RMPOBIL7",33,0)
 K RMPRCNUM,TRANS,TRANS1,TYPE,VEN,RMPRSTN,DIQ,^UTILITY("DIQ1",$J)
"RTN","RMPOBIL7",34,0)
 K AMIS,AN,CST,DATE,DEL,DUOUT,DTOUT,FL,FRM,PAGE,QTY,RC,REM,RZ,RK,SN,STA
"RTN","RMPOBIL7",35,0)
 Q
"RTN","RMPOBIL7",36,0)
XIT() Q '$D(ANS)!(ANS=U)!($D(DUOUT))!($D(DTOUT))
"RTN","RMPOBIL7",37,0)
PRT MERGE RMY=Y
"RTN","RMPOBIL7",38,0)
 S DATE=$P(Y,U,3),TYPE=$P(Y,U,6),QTY=$P(Y,U,7)
"RTN","RMPOBIL7",39,0)
 S VEN=$P(Y,U,9),TRANS=$P(Y,U,4),STA=$P(Y,U,10),SN=$P(Y,U,11)
"RTN","RMPOBIL7",40,0)
 S DEL=$P(Y,U,12)
"RTN","RMPOBIL7",41,0)
 S CST=$S($P(Y,U,16)'="":$P(Y,U,16),$D(^RMPR(660,AN,"LB")):$P(^RMPR(660,AN,"LB"),U,9),1:"")
"RTN","RMPOBIL7",42,0)
 ;form requested on
"RTN","RMPOBIL7",43,0)
 S FRM=$P(Y,U,13),REM=$P(Y,U,18)
"RTN","RMPOBIL7",44,0)
 S DATE=$E(DATE,4,5)_"/"_$E(DATE,6,7)_"/"_$E(DATE,2,3)
"RTN","RMPOBIL7",45,0)
 ;S TYPE=$S(TYPE="":"",$D(^RMPR(661,TYPE,0)):$P(^(0),U,1),1:"")
"RTN","RMPOBIL7",46,0)
 S TYPE=$P($G(^RMPR(660,AN,1)),U,4)
"RTN","RMPOBIL7",47,0)
 S AMIS=$P(Y,U,15),VEN=$S(VEN="":"",$D(^PRC(440,VEN,0)):$P(^(0),U,1),1:"")
"RTN","RMPOBIL7",48,0)
 I $D(^RMPR(660.1,"AC",AN)),$P(^RMPR(660.1,$O(^RMPR(660.1,"AC",AN,0)),0),U,11)]"" S AMIS=AMIS_"+"
"RTN","RMPOBIL7",49,0)
 S TRANS=$S(TRANS]"":TRANS,1:""),TRANS1=""
"RTN","RMPOBIL7",50,0)
 S:TRANS="X" TRANS1=TRANS,TRANS=""
"RTN","RMPOBIL7",51,0)
 S DEL=$E(DEL,4,5)_"/"_$E(DEL,6,7)_"/"_$E(DEL,2,3) S:DEL="//" DEL=""
"RTN","RMPOBIL7",52,0)
 W !,RK,". ",DATE,?13,QTY,?17
"RTN","RMPOBIL7",53,0)
 ;W AMIS_$S(TYPE'="":$E($P(^PRC(441,TYPE,0),U,2),1,10),$P(Y,U,26)="D":"DELIVERY",$P(Y,U,26)="P":"PICKUP",$P(Y,U,17):"SHIPPING",1:"")
"RTN","RMPOBIL7",54,0)
 W AMIS_$S(TYPE'="":$E($P($G(^RMPR(661.1,TYPE,0)),U,1),1,10),$P(Y,U,26)="D":"DELIVERY",$P(Y,U,26)="P":"PICKUP",$P(Y,U,17):"SHIPPING",1:"")
"RTN","RMPOBIL7",55,0)
 ;W:$D(^RMPR(660,$P(IT(RK),U,1),"HST")) $E($P(^("HST"),U,1),1,10)
"RTN","RMPOBIL7",56,0)
 I TYPE=""&($D(^RMPR(660,$P(IT(RK),U,1),"HST"))) W $E($P(^("HST"),U,1),1,10)
"RTN","RMPOBIL7",57,0)
 W ?30,TRANS,?31,TRANS1
"RTN","RMPOBIL7",58,0)
 ;display source of procurement for 2529-3 under vendor header
"RTN","RMPOBIL7",59,0)
 I $D(RMPRLPRO) W ?33,RMPRLPRO
"RTN","RMPOBIL7",60,0)
 K RMPRLPRO
"RTN","RMPOBIL7",61,0)
 I VEN'="" W ?33,$E(VEN,1,10)
"RTN","RMPOBIL7",62,0)
 W:$D(^RMPR(660,$P(IT(RK),U,1),"HST")) $E($P(^("HST"),U,3),1,10)
"RTN","RMPOBIL7",63,0)
 I STA'="" D
"RTN","RMPOBIL7",64,0)
 .S DIC="^DIC(4,",DIQ(0)="E",DR=99,DIQ="RMPRSTN",DA=STA D EN^DIQ1
"RTN","RMPOBIL7",65,0)
 .W:$D(RMPRSTN(4,STA,99,"E")) ?45,RMPRSTN(4,STA,99,"E")
"RTN","RMPOBIL7",66,0)
 W ?50,$E(SN,1,9),?60,DEL
"RTN","RMPOBIL7",67,0)
 W ?71,$J($FN($S(CST'="":CST,$P(RMY,U,17):$P(RMY,U,17),1:""),"T",2),9)
"RTN","RMPOBIL7",68,0)
 W:REM]"" !,?3,REM
"RTN","RMPOBIL7",69,0)
 I $P(IT(RK),U,2)="" S IT(RK)=IT(RK)_"^"_RZ
"RTN","RMPOBIL7",70,0)
 Q
"RTN","RMPOBIL7",71,0)
OVER N ANS
"RTN","RMPOBIL7",72,0)
 S RZ=RK W !,"+=Turned-In  *=Historical Data  I=Initial  X=Repair  S=Spare  R=Replacement",!,"Enter 1-",RK," to show full entry, '^' to exit or `return` to continue.  " R ANS:DTIME S:'$T ANS="^"
"RTN","RMPOBIL7",73,0)
 I ANS="^^" S ANS="^" G ASK1^RMPOPAT Q
"RTN","RMPOBIL7",74,0)
 I ANS="^" G ASK1^RMPOPAT Q
"RTN","RMPOBIL7",75,0)
 I ANS="",RK+1'>RC D HDR Q
"RTN","RMPOBIL7",76,0)
 I ANS="" Q
"RTN","RMPOBIL7",77,0)
 I ANS'?1N.N!(ANS>RK)!(+ANS=0)!(+ANS'=ANS) W $C(7),!," Must be between 1 and ",RK," to be valid" G OVER
"RTN","RMPOBIL7",78,0)
 I ANS>0,(ANS<(RK+1)) S AN=ANS,RZ=RK D ^RMPOPAT3 I RMOXY=0 K RK Q
"RTN","RMPOBIL7",79,0)
 S RK=$P(IT(ANS),U,2)
"RTN","RMPOBIL7",80,0)
 Q
"RTN","RMPOBIL7",81,0)
HDR ;Print Header, Screen 4
"RTN","RMPOBIL7",82,0)
 W @IOF
"RTN","RMPOBIL7",83,0)
 S PAGE=3
"RTN","RMPOBIL7",84,0)
 W !,$E(RMPRNAM,1,20),?23,"SSN: "
"RTN","RMPOBIL7",85,0)
 W $E(RMPRSSN,1,3)_"-"_$E(RMPRSSN,4,5)_"-"_$E(RMPRSSN,6,10)
"RTN","RMPOBIL7",86,0)
 W ?42,"DOB: "
"RTN","RMPOBIL7",87,0)
 S Y=RMPRDOB X ^DD("DD") W Y K Y
"RTN","RMPOBIL7",88,0)
 W ?61,"CLAIM# ",$G(RMPRCNUM)
"RTN","RMPOBIL7",89,0)
 W !?4,"Date",?12,"Qty",?19,"Item",?28,"Type",?34,"Vendor",?45,"Sta",?50,"Serial",?58,"Delivery Date",?72,"Tot Cost"
"RTN","RMPOBIL7",90,0)
 Q
"RTN","RMPOPAT2")
0^3^B29575123
"RTN","RMPOPAT2",1,0)
RMPOPAT2 ;HINES CIO/RVD-DISPLAY PATIENT ITEM ACTIVITY ;9/16/02  11:16
"RTN","RMPOPAT2",2,0)
 ;;3.0;PROSTHETICS;**70,99**;Feb 09, 1996
"RTN","RMPOPAT2",3,0)
 ;RVD 7/5/02 patch #70 - Go to RMPOPAT if Read Only 2319, and
"RTN","RMPOPAT2",4,0)
 ;
"RTN","RMPOPAT2",5,0)
 ;DBIA # 800 - for this routine, the agreement covers the field #.01 NAME
"RTN","RMPOPAT2",6,0)
 ;             file #440.
"RTN","RMPOPAT2",7,0)
 ;DBIA # 801 - for this routine, the agreement covers the field
"RTN","RMPOPAT2",8,0)
 ;             #.05 Short Description, file #441.
"RTN","RMPOPAT2",9,0)
 ;DBIA # 10090 - Fileman read on file #4, field #99
"RTN","RMPOPAT2",10,0)
 D HDR
"RTN","RMPOPAT2",11,0)
 K ^UTILITY("DIQ1",$J) N DIC,DIQ
"RTN","RMPOPAT2",12,0)
 S (RA,AN,ANS,RK,RZ)=0 K ^TMP($J,"TT"),^TMP($J,"AG"),IT
"RTN","RMPOPAT2",13,0)
 MERGE ^TMP($J,"TT")=^RMPR(660,"AC",RMPRDFN)
"RTN","RMPOPAT2",14,0)
 S B=0
"RTN","RMPOPAT2",15,0)
 F  S B=$O(^TMP($J,"TT",B)) Q:B'>0  D
"RTN","RMPOPAT2",16,0)
 . S BC=0
"RTN","RMPOPAT2",17,0)
 . F  S BC=$O(^TMP($J,"TT",B,BC)) Q:BC'>0  D
"RTN","RMPOPAT2",18,0)
 . .Q:$P($G(^RMPR(660,BC,0)),U,10)'=RMPR("STA")
"RTN","RMPOPAT2",19,0)
 . .S GN=$P($G(^RMPR(660,BC,"AMS")),U,1)
"RTN","RMPOPAT2",20,0)
 . .S ND=$P($G(^RMPR(660,BC,1)),U,4)
"RTN","RMPOPAT2",21,0)
 . .I ND S ND=$P(^RMPR(661.1,ND,0),U,8)
"RTN","RMPOPAT2",22,0)
 . .S:ND="" ND=2
"RTN","RMPOPAT2",23,0)
 . .S:GN="" GN=BC
"RTN","RMPOPAT2",24,0)
 . .S ^TMP($J,"AG",GN,ND,BC)=B
"RTN","RMPOPAT2",25,0)
 S B=""
"RTN","RMPOPAT2",26,0)
 F  S B=$O(^TMP($J,"AG",B)) Q:B'>0  D
"RTN","RMPOPAT2",27,0)
 .S BC=""
"RTN","RMPOPAT2",28,0)
 .F  S BC=$O(^TMP($J,"AG",B,BC)) Q:BC'>0  D
"RTN","RMPOPAT2",29,0)
 . .Q:BC=2
"RTN","RMPOPAT2",30,0)
 . .MERGE ^TMP($J,"AGG")=^TMP($J,"AG",B)
"RTN","RMPOPAT2",31,0)
 . .S HC="",GTCST=0
"RTN","RMPOPAT2",32,0)
 . .K HCC1
"RTN","RMPOPAT2",33,0)
 . .F  S HC=$O(^TMP($J,"AGG",HC)) Q:HC'>0  D
"RTN","RMPOPAT2",34,0)
 . . .S HCC=0
"RTN","RMPOPAT2",35,0)
 . . .;changes for Surgical Implants
"RTN","RMPOPAT2",36,0)
 . . .S BDC=""
"RTN","RMPOPAT2",37,0)
 . . .F BDC=1:1 S HCC=$O(^TMP($J,"AGG",HC,HCC)) Q:HCC'>0  D
"RTN","RMPOPAT2",38,0)
 . . . .S GTCST=GTCST+$P(^RMPR(660,HCC,0),U,16)
"RTN","RMPOPAT2",39,0)
 . . . .I BDC=1&(HC'=2) S HCC1=HCC
"RTN","RMPOPAT2",40,0)
 . . . .I BDC'=1 K ^TMP($J,"TT",^TMP($J,"AGG",HC,HCC),HCC)
"RTN","RMPOPAT2",41,0)
 . . . .I HC=2 K ^TMP($J,"TT",^TMP($J,"AGG",HC,HCC),HCC)
"RTN","RMPOPAT2",42,0)
 . .I $G(HCC1) S $P(^TMP($J,"TT",^TMP($J,"AGG",1,HCC1),HCC1),U,3)=GTCST K HCC1
"RTN","RMPOPAT2",43,0)
 . .K GTCST,^TMP($J,"AGG")
"RTN","RMPOPAT2",44,0)
 K ^TMP($J,"AG"),BDC
"RTN","RMPOPAT2",45,0)
 S B=0,RC=1
"RTN","RMPOPAT2",46,0)
 F  S B=$O(^TMP($J,"TT",B)) Q:B'>0  D
"RTN","RMPOPAT2",47,0)
 .S RK=0
"RTN","RMPOPAT2",48,0)
 .F  S RK=$O(^TMP($J,"TT",B,RK)) Q:RK'>0  D
"RTN","RMPOPAT2",49,0)
 . .Q:$D(^RMPO(665.72,"AC",RK))
"RTN","RMPOPAT2",50,0)
 . .S IT(RC)=RK
"RTN","RMPOPAT2",51,0)
 . .I $P(^TMP($J,"TT",B,RK),U,3) S $P(IT(RC),U,3)=$P(^TMP($J,"TT",B,RK),U,3)
"RTN","RMPOPAT2",52,0)
 . .S RC=RC+1
"RTN","RMPOPAT2",53,0)
 S RK=0,RZ=0
"RTN","RMPOPAT2",54,0)
 K ^TMP($J,"TT"),B
"RTN","RMPOPAT2",55,0)
 ;
"RTN","RMPOPAT2",56,0)
 G:'$D(IT) END
"RTN","RMPOPAT2",57,0)
DIS ;DISPLAY APPLIANCES OR REPAIRS
"RTN","RMPOPAT2",58,0)
 I $G(RK)="" S RK="",RC=""
"RTN","RMPOPAT2",59,0)
 I (RK+1'>RC)&($G(IT(RK+1))) S RK=RK+1 S AN=+IT(RK),Y=^RMPR(660,AN,0) D PRT,OVER:((IOSL-4)<$Y) G:'$D(ANS)!(ANS=U)!($D(DUOUT))!($D(DTOUT)) EXIT G DIS
"RTN","RMPOPAT2",60,0)
END I RC=0 W !,"No Appliances or Repairs exist for this veteran!",!! H 3 G EXIT
"RTN","RMPOPAT2",61,0)
 ;
"RTN","RMPOPAT2",62,0)
 I RC>0 W !!,"End of Appliance/Repair records for this veteran!" D OVER I $G(RK)+1'>$G(RC)&($G(IT($G(RK)+1))) D DIS
"RTN","RMPOPAT2",63,0)
 ;
"RTN","RMPOPAT2",64,0)
EXIT K I,J,L,R0,IT,RA,RMPRSTN,RMYSAV,DIQ,^UTILITY("DIQ1",$J)
"RTN","RMPOPAT2",65,0)
 Q:'$D(RMPRDFN)
"RTN","RMPOPAT2",66,0)
 W !
"RTN","RMPOPAT2",67,0)
 I $D(DUOUT)!($D(DTOUT)) G ASK1^RMPOPAT
"RTN","RMPOPAT2",68,0)
 S FL=4 G ASK2^RMPOPAT
"RTN","RMPOPAT2",69,0)
 Q
"RTN","RMPOPAT2",70,0)
PRT MERGE RMYSAV=Y
"RTN","RMPOPAT2",71,0)
 S DATE=$P(Y,U,3),TYPE=$P(Y,U,6),QTY=$P(Y,U,7)
"RTN","RMPOPAT2",72,0)
 S VEN=$P(Y,U,9),TRANS=$P(Y,U,4),STA=$P(Y,U,10),SN=$P(Y,U,11)
"RTN","RMPOPAT2",73,0)
 S DEL=$P(Y,U,12)
"RTN","RMPOPAT2",74,0)
 S CST=$S($P(Y,U,16)'="":$P(Y,U,16),$D(^RMPR(660,AN,"LB")):$P(^RMPR(660,AN,"LB"),U,9),1:"")
"RTN","RMPOPAT2",75,0)
 ;lab source of procurement
"RTN","RMPOPAT2",76,0)
 I $D(^RMPR(660,AN,"LB")) S RMPRLPRO=$P(^("LB"),U,3) D
"RTN","RMPOPAT2",77,0)
 .I RMPRLPRO="O" S RMPRLPRO="ORTHOTIC" Q
"RTN","RMPOPAT2",78,0)
 .I RMPRLPRO="R" S RMPRLPRO="RESTORATION" Q
"RTN","RMPOPAT2",79,0)
 .I RMPRLPRO="S" S RMPRLPRO="SHOE" Q
"RTN","RMPOPAT2",80,0)
 .I RMPRLPRO="W" S RMPRLPRO="WHEELCHAIR" Q
"RTN","RMPOPAT2",81,0)
 .I RMPRLPRO="N" S RMPRLPRO="FOOT CENTER" Q
"RTN","RMPOPAT2",82,0)
 .I RMPRLPRO="D" S RMPRLPRO="DDC" Q
"RTN","RMPOPAT2",83,0)
 ;form requested on
"RTN","RMPOPAT2",84,0)
 S FRM=$P(Y,U,13),REM=$P(Y,U,18)
"RTN","RMPOPAT2",85,0)
 S DATE=$E(DATE,4,5)_"/"_$E(DATE,6,7)_"/"_$E(DATE,2,3)
"RTN","RMPOPAT2",86,0)
 S TYPE=$P($G(^RMPR(660,AN,1)),U,4)
"RTN","RMPOPAT2",87,0)
 ;S TYPE=$S(TYPE="":"",$D(^RMPR(661,TYPE,0)):$P(^(0),U,1),1:"")
"RTN","RMPOPAT2",88,0)
 S AMIS=$P(Y,U,15),VEN=$S(VEN="":"",$D(^PRC(440,VEN,0)):$P(^(0),U,1),1:"")
"RTN","RMPOPAT2",89,0)
 I $D(^RMPR(660.1,"AC",AN)),$P(^RMPR(660.1,$O(^RMPR(660.1,"AC",AN,0)),0),U,11)]"" S AMIS=AMIS_"+"
"RTN","RMPOPAT2",90,0)
 S TRANS=$S(TRANS]"":TRANS,1:""),TRANS1="" S:TRANS="X" TRANS1=TRANS,TRANS=""
"RTN","RMPOPAT2",91,0)
 S DEL=$E(DEL,4,5)_"/"_$E(DEL,6,7)_"/"_$E(DEL,2,3) S:DEL="//" DEL=""
"RTN","RMPOPAT2",92,0)
 W !,RK,". ",DATE,?13,QTY,?17
"RTN","RMPOPAT2",93,0)
 W AMIS_$S(TYPE'="":$E($P($G(^RMPR(661.1,TYPE,0)),U,2),1,10),$P(Y,U,26)="D":"DELIVERY",$P(Y,U,26)="P":"PICKUP",$P(Y,U,17):"SHIPPING",1:"")
"RTN","RMPOPAT2",94,0)
 ;W AMIS_$S(TYPE'="":$E($P(^PRC(441,TYPE,0),U,2),1,10),$P(Y,U,26)="D":"DELIVERY",$P(Y,U,26)="P":"PICKUP",$P(Y,U,17):"SHIPPING",1:"")
"RTN","RMPOPAT2",95,0)
 ;historical item
"RTN","RMPOPAT2",96,0)
 I TYPE=""&($D(^RMPR(660,$P(IT(RK),U,1),"HST"))) W $E($P(^("HST"),U,1),1,10)
"RTN","RMPOPAT2",97,0)
 W ?30,TRANS,?31,TRANS1
"RTN","RMPOPAT2",98,0)
 ;display source of procurement for 2529-3 under vendor header
"RTN","RMPOPAT2",99,0)
 I $D(RMPRLPRO) W ?33,RMPRLPRO
"RTN","RMPOPAT2",100,0)
 I '$D(RMPRLPRO),VEN'="" W ?33,$E(VEN,1,10)
"RTN","RMPOPAT2",101,0)
 K RMPRLPRO
"RTN","RMPOPAT2",102,0)
 W:$D(^RMPR(660,$P(IT(RK),U,1),"HST")) $E($P(^("HST"),U,3),1,10)
"RTN","RMPOPAT2",103,0)
 I STA'="" D
"RTN","RMPOPAT2",104,0)
 .S DIC="^DIC(4,",DIQ(0)="E",DR=99,DIQ="RMPRSTN",DA=STA D EN^DIQ1
"RTN","RMPOPAT2",105,0)
 .W:$D(RMPRSTN(4,STA,99,"E")) ?45,RMPRSTN(4,STA,99,"E")
"RTN","RMPOPAT2",106,0)
 W ?50,$E(SN,1,9),?60,DEL
"RTN","RMPOPAT2",107,0)
 I $P(IT(RK),U,3) S CST=$P(IT(RK),U,3)
"RTN","RMPOPAT2",108,0)
 W ?71,$J($FN($S(CST'="":CST,$P(RMYSAV,U,17):$P(RMYSAV,U,17),1:""),"T",2),9)
"RTN","RMPOPAT2",109,0)
 W:REM]"" !,?3,REM
"RTN","RMPOPAT2",110,0)
 I $P(IT(RK),U,2)="" S $P(IT(RK),U,2)=RZ
"RTN","RMPOPAT2",111,0)
 Q
"RTN","RMPOPAT2",112,0)
OVER ;
"RTN","RMPOPAT2",113,0)
 N ANS
"RTN","RMPOPAT2",114,0)
 S RZ=RK W !,"+=Turned-In  *=Historical Data  I=Initial  X=Repair  S=Spare  R=Replacement",!,"Enter 1-",RK," to show full entry, '^' to exit or `return` to continue.  " R ANS:DTIME S:'$T ANS="^"
"RTN","RMPOPAT2",115,0)
 I ANS="^^" S ANS="^" G ASK1^RMPOPAT Q
"RTN","RMPOPAT2",116,0)
 I ANS="^" G ASK1^RMPOPAT Q
"RTN","RMPOPAT2",117,0)
 I ANS="",RK+1'>RC&($G(IT(RK+1))) D HDR Q
"RTN","RMPOPAT2",118,0)
 I ANS="" Q
"RTN","RMPOPAT2",119,0)
 I ANS'?1N.N!(ANS>RK)!(+ANS=0)!(+ANS'=ANS) W $C(7),!," Must be between 1 and ",RK," to be valid" G OVER
"RTN","RMPOPAT2",120,0)
 I ANS>0,(ANS<(RK+1)) S AN=ANS,RZ=RK D ^RMPOPAT3
"RTN","RMPOPAT2",121,0)
 S RK=$P(IT(ANS),U,2)
"RTN","RMPOPAT2",122,0)
 Q
"RTN","RMPOPAT2",123,0)
HDR ;Print Header, Screen 4
"RTN","RMPOPAT2",124,0)
 W @IOF
"RTN","RMPOPAT2",125,0)
 S PAGE=3
"RTN","RMPOPAT2",126,0)
 W !,$E(RMPRNAM,1,20),?23,"SSN: "
"RTN","RMPOPAT2",127,0)
 W $E(RMPRSSN,1,3)_"-"_$E(RMPRSSN,4,5)_"-"_$E(RMPRSSN,6,10)
"RTN","RMPOPAT2",128,0)
 W ?42,"DOB: "
"RTN","RMPOPAT2",129,0)
 S Y=RMPRDOB X ^DD("DD") W Y K Y
"RTN","RMPOPAT2",130,0)
 W ?61,"CLAIM# ",$G(RMPRCNUM)
"RTN","RMPOPAT2",131,0)
 W !?4,"Date",?12,"Qty",?19,"HCPCS",?28,"Type",?34,"Vendor",?45,"Sta",?50,"Serial",?58,"Delivery Date",?72,"Tot Cost"
"RTN","RMPOPAT2",132,0)
 Q
"RTN","RMPOPAT3")
0^4^B37951435
"RTN","RMPOPAT3",1,0)
RMPOPAT3 ;HINES-CIOFO/RVD-Detail Display Patient 10-2319 Transaction;11/04/04
"RTN","RMPOPAT3",2,0)
 ;;3.0;PROSTHETICS;**70,92,99**;Feb 09, 1996
"RTN","RMPOPAT3",3,0)
 ;
"RTN","RMPOPAT3",4,0)
 ; RVD 7/8/02 patch #70 - this routine is a copy of RMPRPAT3.
"RTN","RMPOPAT3",5,0)
 ;                        For Read Only 2319.
"RTN","RMPOPAT3",6,0)
 ; AAC 08/03/04 Patch 92 - Code Set Versioning (CSV) 
"RTN","RMPOPAT3",7,0)
 ;Used API=ICDDX^ICDCODE to replace direct calls to global ICD9(80).
"RTN","RMPOPAT3",8,0)
 ;
"RTN","RMPOPAT3",9,0)
 ;DBIA # 10082 - file #80, global read.
"RTN","RMPOPAT3",10,0)
 ;                        
"RTN","RMPOPAT3",11,0)
 ;expect ANS,IT(ANS)
"RTN","RMPOPAT3",12,0)
 ;          +IT(ANS)=ien of file 660
"RTN","RMPOPAT3",13,0)
 ;expect variables from GETPAT^RMPRUTIL
"RTN","RMPOPAT3",14,0)
 ;    RMPRSSNE (external form of SSN)
"RTN","RMPOPAT3",15,0)
 ;    RMPRNAM (name of patient)
"RTN","RMPOPAT3",16,0)
 ;    RMPRDOB
"RTN","RMPOPAT3",17,0)
 ;display detailed record
"RTN","RMPOPAT3",18,0)
PRINT ;called from RMPOPAT2
"RTN","RMPOPAT3",19,0)
 ;get 2319 transaction
"RTN","RMPOPAT3",20,0)
 ;
"RTN","RMPOPAT3",21,0)
 N DIC,DIQ,DR,DA,RMPRV,RMPRDA,RV
"RTN","RMPOPAT3",22,0)
 S DIC=660,DIQ="R19",DR=".01:96",DIQ(0)="EN"
"RTN","RMPOPAT3",23,0)
 S (RMPRDA,DA)=+IT(ANS)
"RTN","RMPOPAT3",24,0)
 D EN^DIQ1
"RTN","RMPOPAT3",25,0)
 S DIQ="R19",DR=72,DIQ(0)="I" D EN^DIQ1
"RTN","RMPOPAT3",26,0)
 ;get vendor info
"RTN","RMPOPAT3",27,0)
 S DA=$P(^RMPR(660,RMPRDA,0),U,9)
"RTN","RMPOPAT3",28,0)
 I DA D
"RTN","RMPOPAT3",29,0)
 .S DIC=440,DIQ="RV",DR=".01:6",DIQ(0)="EN"
"RTN","RMPOPAT3",30,0)
 .S (RMPRV,DA)=$P(^RMPR(660,RMPRDA,0),U,9)
"RTN","RMPOPAT3",31,0)
 .D EN^DIQ1
"RTN","RMPOPAT3",32,0)
 ;
"RTN","RMPOPAT3",33,0)
 ;array defined for record in following format:
"RTN","RMPOPAT3",34,0)
 ;R19(filenumber,ien,field,E)=external form of data
"RTN","RMPOPAT3",35,0)
 ;RV(filenumber,ien,field,E)=external form of data
"RTN","RMPOPAT3",36,0)
 ;example
"RTN","RMPOPAT3",37,0)
 ;R19(660,100,.01,"E")=APR 27, 1995
"RTN","RMPOPAT3",38,0)
 ;R19(660,100,.02,"E")=FUDGE,CHOCOLATE
"RTN","RMPOPAT3",39,0)
 ;RV(440,131,.01,"E")=ORTHOTIC LAB
"RTN","RMPOPAT3",40,0)
 ;
"RTN","RMPOPAT3",41,0)
 D HDR
"RTN","RMPOPAT3",42,0)
 W !,"TYPE OF FORM: ",$G(R19(660,RMPRDA,11,"E"))
"RTN","RMPOPAT3",43,0)
 W ?25,"INITIATOR: ",$G(R19(660,RMPRDA,27,"E"))
"RTN","RMPOPAT3",44,0)
 ;historical item
"RTN","RMPOPAT3",45,0)
 W !,"ITEM DESCRIPTION: ",$G(R19(660,RMPRDA,89,"E"))
"RTN","RMPOPAT3",46,0)
 W ?55,"DATE: ",$G(R19(660,RMPRDA,1,"E"))
"RTN","RMPOPAT3",47,0)
 W !,"DELIVER TO: ",$G(R19(660,RMPRDA,25,"E"))
"RTN","RMPOPAT3",48,0)
 W !,"TYPE TRANS: ",$G(R19(660,RMPRDA,2,"E"))
"RTN","RMPOPAT3",49,0)
 W ?30,"QTY: ",$G(R19(660,RMPRDA,5,"E"))
"RTN","RMPOPAT3",50,0)
 W:$G(R19(660,RMPRDA,29,"E")) ?40,"INVENTORY POINT: ",R19(660,RMPRDA,29,"E"),!
"RTN","RMPOPAT3",51,0)
 W ?40,"SOURCE: ",$G(R19(660,RMPRDA,12,"E"))
"RTN","RMPOPAT3",52,0)
 ;vendor tracking number
"RTN","RMPOPAT3",53,0)
 I $G(R19(660,RMPRDA,11,"E"))="VISA" D
"RTN","RMPOPAT3",54,0)
 .W !,"VENDOR TRACKING: ",$G(R19(660,RMPRDA,4.2,"E"))
"RTN","RMPOPAT3",55,0)
 .W ?38,"BANK AUTHORIZATION: ",$G(R19(660,RMPRDA,4.3,"E"))
"RTN","RMPOPAT3",56,0)
 W !,"VENDOR: ",?15,$G(R19(660,RMPRDA,7,"E"))
"RTN","RMPOPAT3",57,0)
 I $D(RV) D
"RTN","RMPOPAT3",58,0)
 .W !?15,$G(RV(440,RMPRV,1,"E"))
"RTN","RMPOPAT3",59,0)
 .W !?15,$G(RV(440,RMPRV,4.2,"E")),","
"RTN","RMPOPAT3",60,0)
 .W ?$X+3,$G(RV(440,RMPRV,4.4,"E")),?$X+5,$G(RV(440,RMPRV,4.6,"E"))
"RTN","RMPOPAT3",61,0)
 W !,"DELIVERY DATE: "
"RTN","RMPOPAT3",62,0)
 I $D(R19(660,RMPRDA,10,"E")) W R19(660,RMPRDA,10,"E")
"RTN","RMPOPAT3",63,0)
 W !
"RTN","RMPOPAT3",64,0)
 I '$P(IT(AN),U,3) D
"RTN","RMPOPAT3",65,0)
 .W "TOTAL COST: "
"RTN","RMPOPAT3",66,0)
 .I $G(R19(660,RMPRDA,14,"E"))'="" W "$"_$J(R19(660,RMPRDA,14,"E"),2)
"RTN","RMPOPAT3",67,0)
 .I $G(R19(660,RMPRDA,14,"E"))="" W $S($G(R19(660,RMPRDA,6,"E"))'="":"$"_$J(R19(660,RMPRDA,6,"E"),2),$G(R19(660,RMPRDA,48,"E"))'="":"$"_$J(R19(660,RMPRDA,48,"E"),2),1:"")
"RTN","RMPOPAT3",68,0)
 ;
"RTN","RMPOPAT3",69,0)
 ;lab data
"RTN","RMPOPAT3",70,0)
 I $D(^RMPR(660,RMPRDA,"LB")) D
"RTN","RMPOPAT3",71,0)
 .N DIC,DIQ,DR,L19,DA
"RTN","RMPOPAT3",72,0)
 .S (DA,RMPRLA)=$P(^RMPR(660,RMPRDA,"LB"),U,10)
"RTN","RMPOPAT3",73,0)
 .Q:DA=""
"RTN","RMPOPAT3",74,0)
 .S DIC=664.1,DIQ="L19",DR="15",DIQ(0)="E"
"RTN","RMPOPAT3",75,0)
 .D EN^DIQ1
"RTN","RMPOPAT3",76,0)
 .W !,"WORK ORDER: ",$G(R19(660,RMPRDA,71,"E"))
"RTN","RMPOPAT3",77,0)
 .W ?40,"RECEIVING STATION: ",$G(R19(660,RMPRDA,70,"E"))
"RTN","RMPOPAT3",78,0)
 .W !,"TECHNICIAN: ",$G(L19(664.1,RMPRLA,15,"E"))
"RTN","RMPOPAT3",79,0)
 .W !,"TOTAL LABOR HOURS: ",$G(R19(660,RMPRDA,45,"E"))
"RTN","RMPOPAT3",80,0)
 .W ?40,"TOTAL LABOR COST: ",$G(R19(660,RMPRDA,46,"E"))
"RTN","RMPOPAT3",81,0)
 .W !,"TOTAL MATERIAL COST: ",$G(R19(660,RMPRDA,47,"E"))
"RTN","RMPOPAT3",82,0)
 .W ?40,"TOTAL LAB COST: ",$G(R19(660,RMPRDA,48,"E"))
"RTN","RMPOPAT3",83,0)
 .W !,"COMPLETION DATE: ",$G(R19(660,RMPRDA,50,"E"))
"RTN","RMPOPAT3",84,0)
 .W ?40,"LAB REMARKS: ",$G(R19(660,RMPRDA,51,"E"))
"RTN","RMPOPAT3",85,0)
 W !,"REMARKS: ",?15,$G(R19(660,RMPRDA,16,"E"))
"RTN","RMPOPAT3",86,0)
 I $G(R19(660,RMPRDA,17.5,"E")) W ?40,"RETURN STATUS: ",R19(660,RMPRDA,17.5,"E")
"RTN","RMPOPAT3",87,0)
 ;
"RTN","RMPOPAT3",88,0)
 ;historical data
"RTN","RMPOPAT3",89,0)
 I $G(R19(660,RMPRDA,15,"E"))["*" D
"RTN","RMPOPAT3",90,0)
 .;include records that have been merged
"RTN","RMPOPAT3",91,0)
 .W !!,"HISTORICAL DATA",!
"RTN","RMPOPAT3",92,0)
 .Q:'$D(R19(660,RMPRDA,89))
"RTN","RMPOPAT3",93,0)
 .W !,?15,"ITEM: ",$G(R19(660,RMPRDA,89,"E"))
"RTN","RMPOPAT3",94,0)
 .W !,?15,"STATION: ",$G(R19(660,RMPRDA,90,"E"))
"RTN","RMPOPAT3",95,0)
 .W !,?15,"VENDOR: ",$G(R19(660,RMPRDA,91,"E"))
"RTN","RMPOPAT3",96,0)
 .W !,?23,$G(R19(660,RMPRDA,93,"E")),!,?23,$G(R19(660,RMPRDA,94,"E"))
"RTN","RMPOPAT3",97,0)
 .W "   ",$G(R19(660,RMPRDA,95,"E")),"  ",$G(R19(660,RMPRDA,96,"E"))
"RTN","RMPOPAT3",98,0)
 ;put in lab display here fields 45,46,47,48 and 51
"RTN","RMPOPAT3",99,0)
 ;lab amis
"RTN","RMPOPAT3",100,0)
 I $G(R19(660,RMPRDA,73,"E")) D
"RTN","RMPOPAT3",101,0)
 .W ?40,"ORTHOTICS LAB CODE: "
"RTN","RMPOPAT3",102,0)
 .W $S($D(R19(660,RMPRDA,74,"E")):R19(660,RMPRDA,74,"E"),$D(R19(660,RMPRDA,75,"E")):R19(660,RMPRDA,75,"E"),1:"")
"RTN","RMPOPAT3",103,0)
 .W !?40,"RESTORATIONS LAB CODE: "
"RTN","RMPOPAT3",104,0)
 .W $S($D(R19(660,RMPRDA,76,"E")):R19(660,RMPRDA,76,"E"),$D(R19(660,RMPRDA,77,"E")):R19(660,RMPRDA,77,"E"),1:"")
"RTN","RMPOPAT3",105,0)
 ;purchasing and issue from stock amis
"RTN","RMPOPAT3",106,0)
 W !,"DISABILITY SERVED: ",$G(R19(660,RMPRDA,62,"E"))
"RTN","RMPOPAT3",107,0)
 ;appliance/item information
"RTN","RMPOPAT3",108,0)
 ;historical/original item
"RTN","RMPOPAT3",109,0)
 W !,"ITEM DESCRIPTION: ",$G(R19(660,RMPRDA,89,"E"))
"RTN","RMPOPAT3",110,0)
 ;check for changes to item description
"RTN","RMPOPAT3",111,0)
 I $G(R19(660,RMPRDA,89,"E"))'=$G(R19(660,RMPRDA,4,"E")) W !,"*** See Above For Original Item Description ***"
"RTN","RMPOPAT3",112,0)
 W !,"APPLIANCE: ",$G(R19(660,RMPRDA,4,"E"))
"RTN","RMPOPAT3",113,0)
 W !,"PSAS HCPCS: ",$G(R19(660,RMPRDA,4.5,"E"))
"RTN","RMPOPAT3",114,0)
 I $P($G(^RMPR(660,RMPRDA,1)),U,4) W ?22,$P($G(^RMPR(661.1,$P(^RMPR(660,RMPRDA,1),U,4),0)),U,2)
"RTN","RMPOPAT3",115,0)
 ;added by #69
"RTN","RMPOPAT3",116,0)
 ;
"RTN","RMPOPAT3",117,0)
 ; PATCH 92 - Code Set Versioning (CSV) changes below
"RTN","RMPOPAT3",118,0)
 ; AAC      - 08/03/04
"RTN","RMPOPAT3",119,0)
 ;
"RTN","RMPOPAT3",120,0)
 S (RMPRICD,RMPRIC9,RMPRCOD,RMPRDAT)="" S RMPRERR=0
"RTN","RMPOPAT3",121,0)
 S RMPRDAT=$P($G(^RMPR(660,RMPRDA,0)),U,1)
"RTN","RMPOPAT3",122,0)
 I $D(^RMPR(660,RMPRDA,10)) S RMPRIC9=$P(^RMPR(660,RMPRDA,10),U,8)
"RTN","RMPOPAT3",123,0)
 I RMPRIC9'="" D
"RTN","RMPOPAT3",124,0)
 .S RMPRICD=$$ICDDX^ICDCODE(RMPRIC9,RMPRDAT)
"RTN","RMPOPAT3",125,0)
 .S RMPRERR=$P(RMPRICD,U,1)
"RTN","RMPOPAT3",126,0)
 .I RMPRERR<0 W !,"ICD-9 Message: ",$P(RMPRICD,U,2)
"RTN","RMPOPAT3",127,0)
 W !,"ICD-9 Code: "
"RTN","RMPOPAT3",128,0)
 I $G(RMPRICD)'="" W $P(RMPRICD,U,2),?19,$E($P(RMPRICD,U,4),1,55) I $P(RMPRICD,U,10)'>0 W " ","** Inactive ** Date: " S Y=$P(RMPRICD,U,12) D DD^%DT W Y
"RTN","RMPOPAT3",129,0)
 ;
"RTN","RMPOPAT3",130,0)
 ; End Patch 92
"RTN","RMPOPAT3",131,0)
 ;
"RTN","RMPOPAT3",132,0)
 W !,"CPT MODIFIER: ",$G(R19(660,RMPRDA,4.7,"E"))
"RTN","RMPOPAT3",133,0)
 W !,"DESCRIPTION: ",$G(R19(660,RMPRDA,24,"E"))
"RTN","RMPOPAT3",134,0)
 W !,"EXTENDED DESCRIPTION: ",!
"RTN","RMPOPAT3",135,0)
 I $D(R19(660,RMPRDA,28)) D  G:$D(DUOUT)!$D(DTOUT) EX1
"RTN","RMPOPAT3",136,0)
 .N R28
"RTN","RMPOPAT3",137,0)
 .;command part of new standards
"RTN","RMPOPAT3",138,0)
 .MERGE R28=R19(660,RMPRDA,28)
"RTN","RMPOPAT3",139,0)
 .I $P($G(^RMPR(660,RMPRDA,"DES",0)),U,3)>1 N DIR S DIR(0)="E" D ^DIR Q:$D(DUOUT)!$D(DTOUT)  D HDR W !,"EXTENDED DESCRIPTION: ",!
"RTN","RMPOPAT3",140,0)
 .D EN^DDIOL(.R28)
"RTN","RMPOPAT3",141,0)
 ;NPPD key items consolidated, example L5300 limb order
"RTN","RMPOPAT3",142,0)
 I $P(IT(AN),U,3) W !!,"*** Return For DETAIL REPORT ***" N DIR S DIR(0)="E" D ^DIR G:$D(DUOUT)!$D(DTOUT) EX1  W @IOF D HDR,^RMPRPAT7
"RTN","RMPOPAT3",143,0)
 ;display work order if it is a 2529-3 form
"RTN","RMPOPAT3",144,0)
 ;must pass ien to file 664.1 NOT 664.2
"RTN","RMPOPAT3",145,0)
 I $G(R19(660,RMPRDA,72,"I"))'="" D  G EX1
"RTN","RMPOPAT3",146,0)
 .S DIR(0)="E" D ^DIR Q:$D(DTOUT)!$D(DUOUT)
"RTN","RMPOPAT3",147,0)
 .S RMPRBCK=RMPRDA
"RTN","RMPOPAT3",148,0)
 .N DIC
"RTN","RMPOPAT3",149,0)
 .S RMPRDA=R19(660,RMPRBCK,72,"I")
"RTN","RMPOPAT3",150,0)
 .D DISP^RMPR293(RMPRDA)
"RTN","RMPOPAT3",151,0)
 .S RMPRDA=RMPRBCK K RMPRBCK
"RTN","RMPOPAT3",152,0)
 ;return from work order
"RTN","RMPOPAT3",153,0)
 G EXIT
"RTN","RMPOPAT3",154,0)
 ;
"RTN","RMPOPAT3",155,0)
HDR ;display heading
"RTN","RMPOPAT3",156,0)
 W @IOF,RMPRNAM,?30," SSN: "
"RTN","RMPOPAT3",157,0)
 W $E(RMPRSSN,1,3)_"-"_$E(RMPRSSN,4,5)_"-"_$E(RMPRSSN,6,10),?50
"RTN","RMPOPAT3",158,0)
 W $G(R19(660,RMPRDA,8,"E")),?70,"DOB: "
"RTN","RMPOPAT3",159,0)
 W $S(RMPRDOB:$E(RMPRDOB,4,5)_"-"_$E(RMPRDOB,6,7)_"-"_(1700+$E(RMPRDOB,1,3)),1:"Unknown")
"RTN","RMPOPAT3",160,0)
 W !?20,"APPLIANCE/REPAIR LINE ITEM DETAIL ",?70,"<4-",ANS,">",!
"RTN","RMPOPAT3",161,0)
 Q
"RTN","RMPOPAT3",162,0)
EXIT ;common exit point
"RTN","RMPOPAT3",163,0)
 I $Y>(IOSL-4) F  W ! Q:$Y>(IOSL-3)
"RTN","RMPOPAT3",164,0)
 N DIR S DIR(0)="E" D ^DIR
"RTN","RMPOPAT3",165,0)
 S RMOXY=Y
"RTN","RMPOPAT3",166,0)
 ;duout,dtout is evaluated in dis+1^rmpopat2
"RTN","RMPOPAT3",167,0)
EX1 ;back out through that point to clean up
"RTN","RMPOPAT3",168,0)
 K R19,RV,RMPRICC,RMPRICD,RMPRIC9,RMPRCOD,RMPRDAT,RMPRERR,Y W @IOF
"RTN","RMPOPAT3",169,0)
 Q
"RTN","RMPOPAT3",170,0)
 ;end
"RTN","RMPR9S4")
0^9^B24749556
"RTN","RMPR9S4",1,0)
RMPR9S4 ;HOIFO/HNC - GUI 2319ITEM TRANSACTIONS LIST ;9/10/02  08:42
"RTN","RMPR9S4",2,0)
 ;;3.0;PROSTHETICS;**59,99**;Feb 09, 1996
"RTN","RMPR9S4",3,0)
 ;
"RTN","RMPR9S4",4,0)
 Q
"RTN","RMPR9S4",5,0)
A1(IEN) G A2
"RTN","RMPR9S4",6,0)
EN(RESULTS,IEN) ;broker
"RTN","RMPR9S4",7,0)
A2 S (RA,AN,ANS,RK,RZ)=0 K ^TMP($J,"TT"),^TMP($J,"AG"),IT
"RTN","RMPR9S4",8,0)
 K ^TMP($J,"RMPRB")
"RTN","RMPR9S4",9,0)
 K ^TMP($J,"RMPRC")
"RTN","RMPR9S4",10,0)
 ;IT IS RESULTS
"RTN","RMPR9S4",11,0)
 ;0;2 DFN in 668
"RTN","RMPR9S4",12,0)
 S RMPRDFN=$P($G(^RMPR(668,IEN,0)),U,2)
"RTN","RMPR9S4",13,0)
 I RMPRDFN="" S ^TMP($J,"RMPRB",1)="PATIENT NOT KNOWN" Q
"RTN","RMPR9S4",14,0)
 MERGE ^TMP($J,"TT")=^RMPR(660,"AC",RMPRDFN)
"RTN","RMPR9S4",15,0)
 S B=0
"RTN","RMPR9S4",16,0)
 F  S B=$O(^TMP($J,"TT",B)) Q:B'>0  D
"RTN","RMPR9S4",17,0)
 . S BC=0
"RTN","RMPR9S4",18,0)
 . F  S BC=$O(^TMP($J,"TT",B,BC)) Q:BC'>0  D
"RTN","RMPR9S4",19,0)
 . .;Q:$P($G(^RMPR(660,BC,0)),U,10)'=RMPR("STA")
"RTN","RMPR9S4",20,0)
 . .S GN=$P($G(^RMPR(660,BC,"AMS")),U,1)
"RTN","RMPR9S4",21,0)
 . .S ND=$P($G(^RMPR(660,BC,1)),U,4)
"RTN","RMPR9S4",22,0)
 . .I ND S ND=$P(^RMPR(661.1,ND,0),U,8)
"RTN","RMPR9S4",23,0)
 . .S:ND="" ND=2
"RTN","RMPR9S4",24,0)
 . .S:GN="" GN=BC
"RTN","RMPR9S4",25,0)
 . .S ^TMP($J,"AG",GN,ND,BC)=B
"RTN","RMPR9S4",26,0)
 S B=""
"RTN","RMPR9S4",27,0)
 F  S B=$O(^TMP($J,"AG",B)) Q:B'>0  D
"RTN","RMPR9S4",28,0)
 .S BC=""
"RTN","RMPR9S4",29,0)
 .F  S BC=$O(^TMP($J,"AG",B,BC)) Q:BC'>0  D
"RTN","RMPR9S4",30,0)
 . .Q:BC=2
"RTN","RMPR9S4",31,0)
 . .MERGE ^TMP($J,"AGG")=^TMP($J,"AG",B)
"RTN","RMPR9S4",32,0)
 . .S HC="",GTCST=0
"RTN","RMPR9S4",33,0)
 . .K HCC1
"RTN","RMPR9S4",34,0)
 . .F  S HC=$O(^TMP($J,"AGG",HC)) Q:HC'>0  D
"RTN","RMPR9S4",35,0)
 . . .S HCC=0
"RTN","RMPR9S4",36,0)
 . . .;changes for Surgical Implants
"RTN","RMPR9S4",37,0)
 . . .S BDC=""
"RTN","RMPR9S4",38,0)
 . . .F BDC=1:1 S HCC=$O(^TMP($J,"AGG",HC,HCC)) Q:HCC'>0  D
"RTN","RMPR9S4",39,0)
 . . . .S GTCST=GTCST+$P(^RMPR(660,HCC,0),U,16)
"RTN","RMPR9S4",40,0)
 . . . .I BDC=1&(HC'=2) S HCC1=HCC
"RTN","RMPR9S4",41,0)
 . . . .I BDC'=1 K ^TMP($J,"TT",^TMP($J,"AGG",HC,HCC),HCC)
"RTN","RMPR9S4",42,0)
 . . . .I HC=2 K ^TMP($J,"TT",^TMP($J,"AGG",HC,HCC),HCC)
"RTN","RMPR9S4",43,0)
 . .I $G(HCC1) S $P(^TMP($J,"TT",^TMP($J,"AGG",1,HCC1),HCC1),U,3)=GTCST K HCC1
"RTN","RMPR9S4",44,0)
 . .K GTCST,^TMP($J,"AGG")
"RTN","RMPR9S4",45,0)
 K ^TMP($J,"AG"),BDC
"RTN","RMPR9S4",46,0)
 S B=0,RC=1
"RTN","RMPR9S4",47,0)
 F  S B=$O(^TMP($J,"TT",B)) Q:B'>0  D
"RTN","RMPR9S4",48,0)
 .S RK=0
"RTN","RMPR9S4",49,0)
 .F  S RK=$O(^TMP($J,"TT",B,RK)) Q:RK'>0  D
"RTN","RMPR9S4",50,0)
 . .Q:$D(^RMPO(665.72,"AC",RK))
"RTN","RMPR9S4",51,0)
 . .S ^TMP($J,"RMPRC",RC)=RK
"RTN","RMPR9S4",52,0)
 . .I $P(^TMP($J,"TT",B,RK),U,3) S $P(^TMP($J,"RMPRC",RC),U,3)=$P(^TMP($J,"TT",B,RK),U,3)
"RTN","RMPR9S4",53,0)
 . .S RC=RC+1
"RTN","RMPR9S4",54,0)
 S RK=0,RZ=0
"RTN","RMPR9S4",55,0)
 K ^TMP($J,"TT"),B
"RTN","RMPR9S4",56,0)
 ;
"RTN","RMPR9S4",57,0)
 G:'$D(^TMP($J,"RMPRC")) END
"RTN","RMPR9S4",58,0)
 ;
"RTN","RMPR9S4",59,0)
DIS ;format data string - ALL
"RTN","RMPR9S4",60,0)
 S RC=""
"RTN","RMPR9S4",61,0)
 S RK=0
"RTN","RMPR9S4",62,0)
 F  S RK=$O(^TMP($J,"RMPRC",RK)) Q:RK=""  D
"RTN","RMPR9S4",63,0)
 .S AN=+^TMP($J,"RMPRC",RK)
"RTN","RMPR9S4",64,0)
 .S Y=^RMPR(660,AN,0)
"RTN","RMPR9S4",65,0)
 .D PRT
"RTN","RMPR9S4",66,0)
 ;
"RTN","RMPR9S4",67,0)
 ;
"RTN","RMPR9S4",68,0)
END I RC=0 S ^TMP($J,"RMPRB",1)="NOTHING TO REPORT" G EXIT
"RTN","RMPR9S4",69,0)
 ;
"RTN","RMPR9S4",70,0)
 ;
"RTN","RMPR9S4",71,0)
EXIT ;common exit point
"RTN","RMPR9S4",72,0)
 ;pass to broker
"RTN","RMPR9S4",73,0)
 K ^TMP($J,"RMPRC")
"RTN","RMPR9S4",74,0)
 ;S RESULT=$NA(^TMP($J))
"RTN","RMPR9S4",75,0)
 M RESULTS=^TMP($J,"RMPRB")
"RTN","RMPR9S4",76,0)
 I '$D(RESULTS) S RESULTS(0)="NOTHING TO REPORT"
"RTN","RMPR9S4",77,0)
 K I,J,L,R0,RA
"RTN","RMPR9S4",78,0)
 Q
"RTN","RMPR9S4",79,0)
 ;
"RTN","RMPR9S4",80,0)
 Q
"RTN","RMPR9S4",81,0)
PRT S DATE=$P(Y,U,3),TYPE=$P(Y,U,6),QTY=$P(Y,U,7)
"RTN","RMPR9S4",82,0)
 S VEN=$P(Y,U,9),TRANS=$P(Y,U,4),STA=$P(Y,U,10),SN=$P(Y,U,11)
"RTN","RMPR9S4",83,0)
 S DEL=$P(Y,U,12)
"RTN","RMPR9S4",84,0)
 S CST=$S($P(Y,U,16)'="":$P(Y,U,16),$D(^RMPR(660,AN,"LB")):$P(^RMPR(660,AN,"LB"),U,9),1:"")
"RTN","RMPR9S4",85,0)
 ;lab source of procurement
"RTN","RMPR9S4",86,0)
 I $D(^RMPR(660,AN,"LB")) S RMPRLPRO=$P(^("LB"),U,3) D
"RTN","RMPR9S4",87,0)
 .I RMPRLPRO="O" S RMPRLPRO="ORTHOTIC" Q
"RTN","RMPR9S4",88,0)
 .I RMPRLPRO="R" S RMPRLPRO="RESTORATION" Q
"RTN","RMPR9S4",89,0)
 .I RMPRLPRO="S" S RMPRLPRO="SHOE" Q
"RTN","RMPR9S4",90,0)
 .I RMPRLPRO="W" S RMPRLPRO="WHEELCHAIR" Q
"RTN","RMPR9S4",91,0)
 .I RMPRLPRO="N" S RMPRLPRO="FOOT CENTER" Q
"RTN","RMPR9S4",92,0)
 .I RMPRLPRO="D" S RMPRLPRO="DDC" Q
"RTN","RMPR9S4",93,0)
 ;form requested on
"RTN","RMPR9S4",94,0)
 S FRM=$P(Y,U,13),REM=$P(Y,U,18)
"RTN","RMPR9S4",95,0)
 S DATE=$E(DATE,4,5)_"/"_$E(DATE,6,7)_"/"_$E(DATE,2,3)
"RTN","RMPR9S4",96,0)
 S TYPE=$P($G(^RMPR(660,AN,1)),U,4)
"RTN","RMPR9S4",97,0)
 ;S TYPE=$S(TYPE="":"",$D(^RMPR(661,TYPE,0)):$P(^(0),U,1),1:"")
"RTN","RMPR9S4",98,0)
 S AMIS=$P(Y,U,15),VEN=$S(VEN="":"",$D(^PRC(440,VEN,0)):$P(^(0),U,1),1:"")
"RTN","RMPR9S4",99,0)
 I $D(^RMPR(660.1,"AC",AN)),$P(^RMPR(660.1,$O(^RMPR(660.1,"AC",AN,0)),0),U,11)]"" S AMIS=AMIS_"+"
"RTN","RMPR9S4",100,0)
 S TRANS=$S(TRANS]"":TRANS,1:""),TRANS1="" S:TRANS="X" TRANS1=TRANS,TRANS=""
"RTN","RMPR9S4",101,0)
 S DEL=$E(DEL,4,5)_"/"_$E(DEL,6,7)_"/"_$E(DEL,2,3) S:DEL="//" DEL=""
"RTN","RMPR9S4",102,0)
 ;
"RTN","RMPR9S4",103,0)
 ;set results array
"RTN","RMPR9S4",104,0)
 ;
"RTN","RMPR9S4",105,0)
 S HTYPE=""
"RTN","RMPR9S4",106,0)
 I $D(^RMPR(660,$P(^TMP($J,"RMPRC",RK),U,1),"HST")) S HTYPE=$E(^RMPR(660,$P(^TMP($J,"RMPRC",RK),U,1),"HST"),1,15)
"RTN","RMPR9S4",107,0)
 S ITEM=AMIS_$S(TYPE'="":$P($G(^RMPR(661.1,TYPE,0)),U,2),$P(Y,U,26)="D":"DELIVERY",$P(Y,U,26)="P":"PICKUP",$P(Y,U,17):"SHIPPING",HTYPE'="":HTYPE,1:"")
"RTN","RMPR9S4",108,0)
 K HTYPE
"RTN","RMPR9S4",109,0)
 ;
"RTN","RMPR9S4",110,0)
 S HCPCS=$P($G(^RMPR(660,$P(^TMP($J,"RMPRC",RK),U,1),1)),U,4)
"RTN","RMPR9S4",111,0)
 I HCPCS'="" S HCPCS=$P($G(^RMPR(661.1,HCPCS,0)),U,1)
"RTN","RMPR9S4",112,0)
 ;
"RTN","RMPR9S4",113,0)
 S ^TMP($J,"RMPRB",RK)=$P(^TMP($J,"RMPRC",RK),U,1)_U_DATE_U_QTY_U_ITEM
"RTN","RMPR9S4",114,0)
 S ^TMP($J,"RMPRB",RK)=^TMP($J,"RMPRB",RK)_U_HCPCS_U_TRANS_TRANS1
"RTN","RMPR9S4",115,0)
 ;
"RTN","RMPR9S4",116,0)
 ;S VEN=$E(VEN,1,15)
"RTN","RMPR9S4",117,0)
 ;display source of procurement for 2529-3 under vendor header
"RTN","RMPR9S4",118,0)
 I $D(RMPRLPRO) S ^TMP($J,"RMPRB",RK)=^TMP($J,"RMPRB",RK)_U_RMPRLPRO
"RTN","RMPR9S4",119,0)
 ;E  S ^TMP($J,"RMPRB",RK)=^TMP($J,"RMPRB",RK)_U_VEN
"RTN","RMPR9S4",120,0)
 I '$D(RMPRLPRO),VEN'="" S ^TMP($J,"RMPRB",RK)=^TMP($J,"RMPRB",RK)_U_$E(VEN,1,10)
"RTN","RMPR9S4",121,0)
 K RMPRLPRO
"RTN","RMPR9S4",122,0)
 ;I $D(^RMPR(660,$P(^TMP($J,"RMPRC",RK),U,1),"HST")) S ^TMP($J,"RMPRB",RK)=^TMP($J,"RMPRB",RK)_U_$E($P(^RMPR(660,$P(^TMP($J,"RMPRC",RK),U,1),"HST"),U,3),1,15)
"RTN","RMPR9S4",123,0)
 ;
"RTN","RMPR9S4",124,0)
 I STA'="" S ^TMP($J,"RMPRB",RK)=^TMP($J,"RMPRB",RK)_U_$P($G(^DIC(4,STA,99)),U,1)
"RTN","RMPR9S4",125,0)
 I STA="" S ^TMP($J,"RMPRB",RK)=^TMP($J,"RMPRB",RK)_U_"UNKNOWN"
"RTN","RMPR9S4",126,0)
 S ^TMP($J,"RMPRB",RK)=^TMP($J,"RMPRB",RK)_U_SN_U_DEL
"RTN","RMPR9S4",127,0)
 I $P(^TMP($J,"RMPRC",RK),U,3) S CST=$P(^TMP($J,"RMPRC",RK),U,3)
"RTN","RMPR9S4",128,0)
 S COST=$J($FN($S(CST'="":CST,$P(Y,U,17):$P(Y,U,17),1:""),"T",2),9)
"RTN","RMPR9S4",129,0)
 ;
"RTN","RMPR9S4",130,0)
 S ^TMP($J,"RMPRB",RK)=^TMP($J,"RMPRB",RK)_U_COST_U_REM
"RTN","RMPR9S4",131,0)
 ;
"RTN","RMPR9S4",132,0)
 I $P(^TMP($J,"RMPRC",RK),U,2)="" S $P(^TMP($J,"RMPRC",RK),U,2)=RZ
"RTN","RMPR9S4",133,0)
 ;
"RTN","RMPR9S4",134,0)
 Q
"RTN","RMPR9S4",135,0)
 ;END
"RTN","RMPR9S4E")
0^11^B41302904
"RTN","RMPR9S4E",1,0)
RMPR9S4E ;HOIFO/SPS-GUI 2319 Extended Display Transaction screen 4 ;12/17/02  09:35
"RTN","RMPR9S4E",2,0)
 ;;3.0;PROSTHETICS;**59,92,99**;Feb 09, 1996
"RTN","RMPR9S4E",3,0)
 ;
"RTN","RMPR9S4E",4,0)
 ;         (IEN)=ien of file 660
"RTN","RMPR9S4E",5,0)
 ;
"RTN","RMPR9S4E",6,0)
 ;AAC Patch 92 08/04/04 - Code Set Versioning (CSV)
"RTN","RMPR9S4E",7,0)
 ;Used API=ICDDX^ICDCODE to replace direct calls to global ICD9(80)
"RTN","RMPR9S4E",8,0)
 ;
"RTN","RMPR9S4E",9,0)
 ;
"RTN","RMPR9S4E",10,0)
 ;display detailed record
"RTN","RMPR9S4E",11,0)
A1(IEN) G A2
"RTN","RMPR9S4E",12,0)
EN(RESULTS,IEN) ;Broker
"RTN","RMPR9S4E",13,0)
A2 ;
"RTN","RMPR9S4E",14,0)
 I +IEN'>0 S RESULTS(0)="NOTHING TO REPORT" G EXIT
"RTN","RMPR9S4E",15,0)
 I '$D(^RMPR(660,IEN)) S RESULTS(0)="NOTHING TO REPORT" G EXIT
"RTN","RMPR9S4E",16,0)
 N DIC,DIQ,DR,DA,RMPRV,RMPRDA,RV
"RTN","RMPR9S4E",17,0)
 S DIC=660,DIQ="R19",DR=".01:96",DIQ(0)="EN"
"RTN","RMPR9S4E",18,0)
 S (RMPRDA,DA)=(IEN)
"RTN","RMPR9S4E",19,0)
 D EN^DIQ1
"RTN","RMPR9S4E",20,0)
 S DIQ="R19",DR=72,DIQ(0)="I" D EN^DIQ1
"RTN","RMPR9S4E",21,0)
 ;get vendor info
"RTN","RMPR9S4E",22,0)
 S DA=$P(^RMPR(660,RMPRDA,0),U,9)
"RTN","RMPR9S4E",23,0)
 I DA D
"RTN","RMPR9S4E",24,0)
 .S DIC=440,DIQ="RV",DR=".01:6",DIQ(0)="EN"
"RTN","RMPR9S4E",25,0)
 .S (RMPRV,DA)=$P(^RMPR(660,RMPRDA,0),U,9)
"RTN","RMPR9S4E",26,0)
 .D EN^DIQ1
"RTN","RMPR9S4E",27,0)
 ;
"RTN","RMPR9S4E",28,0)
 ;array defined for record in following format:
"RTN","RMPR9S4E",29,0)
 ;R19(filenumber,ien,field,E)=external form of data
"RTN","RMPR9S4E",30,0)
 ;RV(filenumber,ien,field,E)=external form of data
"RTN","RMPR9S4E",31,0)
 ;example:
"RTN","RMPR9S4E",32,0)
 ;R19(660,100,.01,"E")=APR 27, 1995
"RTN","RMPR9S4E",33,0)
 ;R19(660,100,.02,"E")=NAME,PATIENT
"RTN","RMPR9S4E",34,0)
 ;RV(440,131,.01,"E")=ORTHOTIC LAB
"RTN","RMPR9S4E",35,0)
 S RMPRDFN=$P(^RMPR(660,RMPRDA,0),U,2)
"RTN","RMPR9S4E",36,0)
 S RMPRNAM=$P(^DPT(RMPRDFN,0),U),RMPRSSN=$P(^(0),U,9),RMPRDOB=$P(^(0),U,3)
"RTN","RMPR9S4E",37,0)
 ;
"RTN","RMPR9S4E",38,0)
 D HDR
"RTN","RMPR9S4E",39,0)
 ; "TYPE OF FORM: ",
"RTN","RMPR9S4E",40,0)
 S RESULTS(5)=$G(R19(660,RMPRDA,11,"E"))
"RTN","RMPR9S4E",41,0)
 ; "INITIATOR: ",
"RTN","RMPR9S4E",42,0)
 S RESULTS(6)=$G(R19(660,RMPRDA,27,"E"))
"RTN","RMPR9S4E",43,0)
 ; "DATE: ",
"RTN","RMPR9S4E",44,0)
 S RESULTS(7)=$G(R19(660,RMPRDA,1,"E"))
"RTN","RMPR9S4E",45,0)
 ; "DELIVER TO: ",
"RTN","RMPR9S4E",46,0)
 S RESULTS(8)=$G(R19(660,RMPRDA,25,"E"))
"RTN","RMPR9S4E",47,0)
 ; "TYPE TRANS: ",
"RTN","RMPR9S4E",48,0)
 S RESULTS(9)=$G(R19(660,RMPRDA,2,"E"))
"RTN","RMPR9S4E",49,0)
 ; "QTY: ",
"RTN","RMPR9S4E",50,0)
 S RESULTS(10)=$G(R19(660,RMPRDA,5,"E"))
"RTN","RMPR9S4E",51,0)
 ; "INVENTORY POINT: "
"RTN","RMPR9S4E",52,0)
 S RESULTS(11)=$G(R19(660,RMPRDA,29,"E"))
"RTN","RMPR9S4E",53,0)
 ; "SOURCE: ",
"RTN","RMPR9S4E",54,0)
 S RESULTS(12)=$G(R19(660,RMPRDA,12,"E"))
"RTN","RMPR9S4E",55,0)
 ;vendor tracking number
"RTN","RMPR9S4E",56,0)
 S (RESULTS(13),RESULTS(14))=""
"RTN","RMPR9S4E",57,0)
 I $G(R19(660,RMPRDA,11,"E"))="VISA" D
"RTN","RMPR9S4E",58,0)
 .; "VENDOR TRACKING: ",
"RTN","RMPR9S4E",59,0)
 .S RESULTS(13)=$G(R19(660,RMPRDA,4.2,"E"))
"RTN","RMPR9S4E",60,0)
 .; "BANK AUTHORIZATION: ",
"RTN","RMPR9S4E",61,0)
 .S RESULTS(14)=$G(R19(660,RMPRDA,4.3,"E"))
"RTN","RMPR9S4E",62,0)
 ; "VENDOR: ",
"RTN","RMPR9S4E",63,0)
 S RESULTS(15)=$G(R19(660,RMPRDA,7,"E"))
"RTN","RMPR9S4E",64,0)
 ; VENDOR PHONE AND ADDRESS INFO
"RTN","RMPR9S4E",65,0)
 F I=16:1:20 S RESULTS(I)=""
"RTN","RMPR9S4E",66,0)
 I $D(RV) D
"RTN","RMPR9S4E",67,0)
 .; "VENDOR PHONE: and Address ",
"RTN","RMPR9S4E",68,0)
 .S RESULTS(16)=$G(RV(440,RMPRV,5,"E"))
"RTN","RMPR9S4E",69,0)
 .S RESULTS(17)=$G(RV(440,RMPRV,1,"E"))
"RTN","RMPR9S4E",70,0)
 .S RESULTS(18)=$G(RV(440,RMPRV,4.2,"E"))
"RTN","RMPR9S4E",71,0)
 .S RESULTS(19)=$G(RV(440,RMPRV,4.4,"E"))
"RTN","RMPR9S4E",72,0)
 .S RESULTS(20)=$G(RV(440,RMPRV,4.6,"E"))
"RTN","RMPR9S4E",73,0)
 ; "DELIVERY DATE: "
"RTN","RMPR9S4E",74,0)
 S RESULTS(21)=$G(R19(660,RMPRDA,10,"E"))
"RTN","RMPR9S4E",75,0)
 ; "TOTAL COST: "
"RTN","RMPR9S4E",76,0)
 S RESULTS(22)=0.00
"RTN","RMPR9S4E",77,0)
 I $G(R19(660,RMPRDA,14,"E"))'="" S RESULTS(22)="$"_$FN(R19(660,RMPRDA,14,"E"),"T",2)
"RTN","RMPR9S4E",78,0)
 I $G(R19(660,RMPRDA,14,"E"))="" S RESULTS(22)=$S($G(R19(660,RMPRDA,6,"E"))'="":"$"_$FN(R19(660,RMPRDA,6,"E"),"T",2),$G(R19(660,RMPRDA,48,"E"))'="":"$"_$FN(R19(660,RMPRDA,48,"E"),"T",2),1:"")
"RTN","RMPR9S4E",79,0)
 ; "OBL: ",
"RTN","RMPR9S4E",80,0)
 S RESULTS(23)=$G(R19(660,RMPRDA,23,"E"))
"RTN","RMPR9S4E",81,0)
 ;
"RTN","RMPR9S4E",82,0)
 ;lab data
"RTN","RMPR9S4E",83,0)
 F I=24:1:32 S RESULTS(I)=""
"RTN","RMPR9S4E",84,0)
 I $D(^RMPR(660,RMPRDA,"LB")) D
"RTN","RMPR9S4E",85,0)
 .N DIC,DIQ,DR,L19,DA
"RTN","RMPR9S4E",86,0)
 .S (DA,RMPRLA)=$P(^RMPR(660,RMPRDA,"LB"),U,10)
"RTN","RMPR9S4E",87,0)
 .Q:DA=""
"RTN","RMPR9S4E",88,0)
 .S DIC=664.1,DIQ="L19",DR="15",DIQ(0)="E"
"RTN","RMPR9S4E",89,0)
 .D EN^DIQ1
"RTN","RMPR9S4E",90,0)
 .; "WORK ORDER: ",
"RTN","RMPR9S4E",91,0)
 .S RESULTS(24)=$G(R19(660,RMPRDA,71,"E"))
"RTN","RMPR9S4E",92,0)
 .; "RECEIVING STATION: ",
"RTN","RMPR9S4E",93,0)
 .S RESULTS(25)=$G(R19(660,RMPRDA,70,"E"))
"RTN","RMPR9S4E",94,0)
 .; "TECHNICIAN: ",
"RTN","RMPR9S4E",95,0)
 .S RESULTS(26)=$G(L19(664.1,RMPRLA,15,"E"))
"RTN","RMPR9S4E",96,0)
 .; "TOTAL LABOR HOURS: ",
"RTN","RMPR9S4E",97,0)
 .S RESULTS(27)=$G(R19(660,RMPRDA,45,"E"))
"RTN","RMPR9S4E",98,0)
 .; "TOTAL LABOR COST: ",
"RTN","RMPR9S4E",99,0)
 .S RESULTS(28)=$G(R19(660,RMPRDA,46,"E"))
"RTN","RMPR9S4E",100,0)
 .; "TOTAL MATERIAL COST: ",
"RTN","RMPR9S4E",101,0)
 .S RESULTS(29)=$G(R19(660,RMPRDA,47,"E"))
"RTN","RMPR9S4E",102,0)
 .; "TOTAL LAB COST: ",
"RTN","RMPR9S4E",103,0)
 .S RESULTS(30)=$G(R19(660,RMPRDA,48,"E"))
"RTN","RMPR9S4E",104,0)
 .; "COMPLETION DATE: ",
"RTN","RMPR9S4E",105,0)
 .S RESULTS(31)=$G(R19(660,RMPRDA,50,"E"))
"RTN","RMPR9S4E",106,0)
 .; "LAB REMARKS: ",
"RTN","RMPR9S4E",107,0)
 .S RESULTS(32)=$G(R19(660,RMPRDA,51,"E"))
"RTN","RMPR9S4E",108,0)
 ; "REMARKS: ",
"RTN","RMPR9S4E",109,0)
 S RESULTS(33)=$G(R19(660,RMPRDA,16,"E"))
"RTN","RMPR9S4E",110,0)
 ; "RETURN STATUS: ",
"RTN","RMPR9S4E",111,0)
 S RESULTS(34)=$G(R19(660,RMPRDA,17.5,"E"))
"RTN","RMPR9S4E",112,0)
 ;
"RTN","RMPR9S4E",113,0)
 ; CoreFLS Data used to be/and same as historical data
"RTN","RMPR9S4E",114,0)
 F I=35:1:42 S RESULTS(I)=""
"RTN","RMPR9S4E",115,0)
 I $G(R19(660,RMPRDA,15,"E"))["*" D
"RTN","RMPR9S4E",116,0)
 .;include records that have been merged
"RTN","RMPR9S4E",117,0)
 .; "COREFLS/HISTORICAL DATA",!
"RTN","RMPR9S4E",118,0)
 .Q:'$D(R19(660,RMPRDA,89))
"RTN","RMPR9S4E",119,0)
 .; "ITEM: ",
"RTN","RMPR9S4E",120,0)
 .S RESULTS(35)=$G(R19(660,RMPRDA,89,"E"))
"RTN","RMPR9S4E",121,0)
 .; "STATION: ",
"RTN","RMPR9S4E",122,0)
 .S RESULTS(36)=$G(R19(660,RMPRDA,90,"E"))
"RTN","RMPR9S4E",123,0)
 .; "VENDOR: ",
"RTN","RMPR9S4E",124,0)
 .S RESULTS(37)=$G(R19(660,RMPRDA,91,"E"))
"RTN","RMPR9S4E",125,0)
 .; "   PHONE: ",
"RTN","RMPR9S4E",126,0)
 .S RESULTS(38)=$G(R19(660,RMPRDA,92,"E"))
"RTN","RMPR9S4E",127,0)
 .; " STREET
"RTN","RMPR9S4E",128,0)
 .S RESULTS(39)=$G(R19(660,RMPRDA,93,"E"))
"RTN","RMPR9S4E",129,0)
 .; CITY
"RTN","RMPR9S4E",130,0)
 .S RESULTS(40)=$G(R19(660,RMPRDA,94,"E"))
"RTN","RMPR9S4E",131,0)
 .; STATE
"RTN","RMPR9S4E",132,0)
 .S RESULTS(41)=$G(R19(660,RMPRDA,95,"E"))
"RTN","RMPR9S4E",133,0)
 .; ZIP
"RTN","RMPR9S4E",134,0)
 .S RESULTS(42)=$G(R19(660,RMPRDA,96,"E"))
"RTN","RMPR9S4E",135,0)
 ;put in lab display here fields 45,46,47,48 and 51
"RTN","RMPR9S4E",136,0)
 ;lab amis
"RTN","RMPR9S4E",137,0)
 F I=43:1:44 S RESULTS(I)=""
"RTN","RMPR9S4E",138,0)
 I $G(R19(660,RMPRDA,73,"E")) D
"RTN","RMPR9S4E",139,0)
 .; "ORTHOTICS LAB CODE: "
"RTN","RMPR9S4E",140,0)
 .S RESULTS(43)=$S($D(R19(660,RMPRDA,74,"E")):R19(660,RMPRDA,74,"E"),$D(R19(660,RMPRDA,75,"E")):R19(660,RMPRDA,75,"E"),1:"")
"RTN","RMPR9S4E",141,0)
 .; "RESTORATIONS LAB CODE: "
"RTN","RMPR9S4E",142,0)
 .S RESULTS(44)=$S($D(R19(660,RMPRDA,76,"E")):R19(660,RMPRDA,76,"E"),$D(R19(660,RMPRDA,77,"E")):R19(660,RMPRDA,77,"E"),1:"")
"RTN","RMPR9S4E",143,0)
 ;purchasing and issue from stock amis
"RTN","RMPR9S4E",144,0)
 ; "DISABILITY SERVED: ",
"RTN","RMPR9S4E",145,0)
 S RESULTS(45)=$G(R19(660,RMPRDA,62,"E"))
"RTN","RMPR9S4E",146,0)
 ;appliance/item information
"RTN","RMPR9S4E",147,0)
 ; "APPLIANCE: ",
"RTN","RMPR9S4E",148,0)
 ;S RESULTS(46)=$G(R19(660,RMPRDA,4,"E"))
"RTN","RMPR9S4E",149,0)
 S RESULTS(46)=$G(R19(660,RMPRDA,89,"E"))
"RTN","RMPR9S4E",150,0)
 ; "PSAS HCPCS: ",
"RTN","RMPR9S4E",151,0)
 S RESULTS(47)=$G(R19(660,RMPRDA,4.5,"E"))
"RTN","RMPR9S4E",152,0)
 ; "PSAS HCPCS DESC.
"RTN","RMPR9S4E",153,0)
 S RESULTS(48)=""
"RTN","RMPR9S4E",154,0)
 I $P($G(^RMPR(660,RMPRDA,1)),U,4) S RESULTS(48)=$P($G(^RMPR(661.1,$P(^RMPR(660,RMPRDA,1),U,4),0)),U,2)
"RTN","RMPR9S4E",155,0)
 ;added by #69
"RTN","RMPR9S4E",156,0)
 ;
"RTN","RMPR9S4E",157,0)
 ; Patch 92 - Code Set Versioning (CSV) changes below inserted afer the line above for #69
"RTN","RMPR9S4E",158,0)
 ; AAC - 08/04/04
"RTN","RMPR9S4E",159,0)
 ;
"RTN","RMPR9S4E",160,0)
 S (RMPRICD,RMPRIC0,RMPRCOD,RMPRIC9,RESULTS(49))="" S RMPRERR=0
"RTN","RMPR9S4E",161,0)
 S RMPRDAT=$G(R19(660,RMPRDA,.01,"E"))
"RTN","RMPR9S4E",162,0)
 I $D(^RMPR(660,RMPRDA,10)) S RMPRIC9=$P(^RMPR(660,RMPRDA,10),U,8)
"RTN","RMPR9S4E",163,0)
 I RMPRIC9'=""  D
"RTN","RMPR9S4E",164,0)
 .S RMPRICD=$$ICDDX^ICDCODE(RMPRIC9,RMPRDAT)
"RTN","RMPR9S4E",165,0)
 .S RMPRERR=$P(RMPRICD,U,1)
"RTN","RMPR9S4E",166,0)
 .I RMPRERR<0 S RESULTS(49)=$P(RMPRICD,U,2)
"RTN","RMPR9S4E",167,0)
ZZ ;
"RTN","RMPR9S4E",168,0)
 I RMPRERR>0 S RESULTS(49)=$P(RMPRICD,U,2)_" "_$E($P(RMPRICD,U,4),1,55) I $P(RMPRICD,U,10)'>0 S RESULTS(49)=RESULTS(49)_" "_"** Inactive ** Date: " S Y=$P(RMPRICD,U,12) D DD^%DT S RESULTS(49)=RESULTS(49)_" "_Y
"RTN","RMPR9S4E",169,0)
 ; "ICD-9 Code: ",
"RTN","RMPR9S4E",170,0)
 ; S RESULTS(49)=RMPRICC_"    "_$E($G(^ICD9(RMPRIC9,1)),1,55)
"RTN","RMPR9S4E",171,0)
 ;
"RTN","RMPR9S4E",172,0)
 ; End Patch 92
"RTN","RMPR9S4E",173,0)
 ;
"RTN","RMPR9S4E",174,0)
 ; "CPT MODIFIER: ",
"RTN","RMPR9S4E",175,0)
 S RESULTS(50)=$G(R19(660,RMPRDA,4.7,"E"))
"RTN","RMPR9S4E",176,0)
 ; "DESCRIPTION: ",
"RTN","RMPR9S4E",177,0)
 S RESULTS(51)=$G(R19(660,RMPRDA,24,"E"))
"RTN","RMPR9S4E",178,0)
 ; ,"EXTENDED DESCRIPTION: ",!
"RTN","RMPR9S4E",179,0)
 N R28
"RTN","RMPR9S4E",180,0)
 I $D(R19(660,RMPRDA,28)) D
"RTN","RMPR9S4E",181,0)
 .;command part of new standards
"RTN","RMPR9S4E",182,0)
 .MERGE R28=R19(660,RMPRDA,28)
"RTN","RMPR9S4E",183,0)
 S LN=0,CNT=52
"RTN","RMPR9S4E",184,0)
 F  S LN=$O(R28(LN)) Q:LN'>0  D
"RTN","RMPR9S4E",185,0)
 .S RESULTS(CNT)=R28(LN)
"RTN","RMPR9S4E",186,0)
 .S CNT=CNT+1
"RTN","RMPR9S4E",187,0)
 G EXIT
"RTN","RMPR9S4E",188,0)
 ;
"RTN","RMPR9S4E",189,0)
HDR ;display heading
"RTN","RMPR9S4E",190,0)
 S RESULTS(1)=RMPRNAM
"RTN","RMPR9S4E",191,0)
 ; " SSN: "
"RTN","RMPR9S4E",192,0)
 S RESULTS(2)=$E(RMPRSSN,1,3)_"-"_$E(RMPRSSN,4,5)_"-"_$E(RMPRSSN,6,10)
"RTN","RMPR9S4E",193,0)
 S RESULTS(3)=$G(R19(660,RMPRDA,8,"E"))
"RTN","RMPR9S4E",194,0)
 ; "DOB: "
"RTN","RMPR9S4E",195,0)
 S RESULTS(4)=$S(RMPRDOB:$E(RMPRDOB,4,5)_"-"_$E(RMPRDOB,6,7)_"-"_(1700+$E(RMPRDOB,1,3)),1:"Unknown")
"RTN","RMPR9S4E",196,0)
 Q
"RTN","RMPR9S4E",197,0)
EXIT ;common exit point
"RTN","RMPR9S4E",198,0)
 I '$D(RESULTS) S RESULTS(0)="NOTHING TO REPORT"
"RTN","RMPR9S4E",199,0)
 K R19,RV,RMPRICC,RMPRICD,RMPRIC9,RMPRCOD,RMPRDAT,RMPRERR,RMPRIC0,Y
"RTN","RMPR9S4E",200,0)
 Q
"RTN","RMPR9S4E",201,0)
 ;end
"RTN","RMPR9S8")
0^10^B21539447
"RTN","RMPR9S8",1,0)
RMPR9S8 ;HOIFO/HNC - GUI 2319 TAB 8 HOME OXYGEN TRANSACTIONS LIST ;9/10/02  08:43
"RTN","RMPR9S8",2,0)
 ;;3.0;PROSTHETICS;**59,99**;Feb 09, 1996
"RTN","RMPR9S8",3,0)
 ;
"RTN","RMPR9S8",4,0)
 Q
"RTN","RMPR9S8",5,0)
A1(IEN) G A2
"RTN","RMPR9S8",6,0)
EN(RESULTS,IEN) ;broker
"RTN","RMPR9S8",7,0)
A2 S (RA,AN,ANS,RK,RZ)=0 K ^TMP($J,"TT"),^TMP($J,"AG"),IT
"RTN","RMPR9S8",8,0)
 K ^TMP($J,"RMPRB")
"RTN","RMPR9S8",9,0)
 K ^TMP($J,"RMPRC")
"RTN","RMPR9S8",10,0)
 ;IT IS RESULTS
"RTN","RMPR9S8",11,0)
 ;0;2 DFN in 668
"RTN","RMPR9S8",12,0)
 S RMPRDFN=$P($G(^RMPR(668,IEN,0)),U,2)
"RTN","RMPR9S8",13,0)
 I RMPRDFN="" S ^TMP($J,"RMPRB",1)="PATIENT NOT KNOWN" Q
"RTN","RMPR9S8",14,0)
 MERGE ^TMP($J,"TT")=^RMPR(660,"AC",RMPRDFN)
"RTN","RMPR9S8",15,0)
 S B=0
"RTN","RMPR9S8",16,0)
 F  S B=$O(^TMP($J,"TT",B)) Q:B'>0  D
"RTN","RMPR9S8",17,0)
 . S BC=0
"RTN","RMPR9S8",18,0)
 . F  S BC=$O(^TMP($J,"TT",B,BC)) Q:BC'>0  D
"RTN","RMPR9S8",19,0)
 . .;Q:$P($G(^RMPR(660,BC,0)),U,10)'=RMPR("STA")
"RTN","RMPR9S8",20,0)
 . .;home oxygen
"RTN","RMPR9S8",21,0)
 . .Q:'$D(^RMPO(665.72,"AC",BC))
"RTN","RMPR9S8",22,0)
 . .S GN=$P($G(^RMPR(660,BC,"AMS")),U,1)
"RTN","RMPR9S8",23,0)
 . .S ND=$P($G(^RMPR(660,BC,1)),U,4)
"RTN","RMPR9S8",24,0)
 . .I ND S ND=$P(^RMPR(661.1,ND,0),U,8)
"RTN","RMPR9S8",25,0)
 . .S:ND="" ND=2
"RTN","RMPR9S8",26,0)
 . .S:GN="" GN=BC
"RTN","RMPR9S8",27,0)
 . .S ^TMP($J,"AG",GN,ND,BC)=B
"RTN","RMPR9S8",28,0)
 S B=""
"RTN","RMPR9S8",29,0)
 F  S B=$O(^TMP($J,"AG",B)) Q:B'>0  D
"RTN","RMPR9S8",30,0)
 .S BC=""
"RTN","RMPR9S8",31,0)
 .F  S BC=$O(^TMP($J,"AG",B,BC)) Q:BC'>0  D
"RTN","RMPR9S8",32,0)
 . .Q:BC=2
"RTN","RMPR9S8",33,0)
 . .MERGE ^TMP($J,"AGG")=^TMP($J,"AG",B)
"RTN","RMPR9S8",34,0)
 . .S HC="",GTCST=0
"RTN","RMPR9S8",35,0)
 . .K HCC1
"RTN","RMPR9S8",36,0)
 . .F  S HC=$O(^TMP($J,"AGG",HC)) Q:HC'>0  D
"RTN","RMPR9S8",37,0)
 . . .S HCC=0
"RTN","RMPR9S8",38,0)
 . . .;changes for Surgical Implants
"RTN","RMPR9S8",39,0)
 . . .S BDC=""
"RTN","RMPR9S8",40,0)
 . . .F BDC=1:1 S HCC=$O(^TMP($J,"AGG",HC,HCC)) Q:HCC'>0  D
"RTN","RMPR9S8",41,0)
 . . . .S GTCST=GTCST+$P(^RMPR(660,HCC,0),U,16)
"RTN","RMPR9S8",42,0)
 . . . .I BDC=1&(HC'=2) S HCC1=HCC
"RTN","RMPR9S8",43,0)
 . . . .I BDC'=1 K ^TMP($J,"TT",^TMP($J,"AGG",HC,HCC),HCC)
"RTN","RMPR9S8",44,0)
 . . . .I HC=2 K ^TMP($J,"TT",^TMP($J,"AGG",HC,HCC),HCC)
"RTN","RMPR9S8",45,0)
 . .I $G(HCC1) S $P(^TMP($J,"TT",^TMP($J,"AGG",1,HCC1),HCC1),U,3)=GTCST K HCC1
"RTN","RMPR9S8",46,0)
 . .K GTCST,^TMP($J,"AGG")
"RTN","RMPR9S8",47,0)
 K ^TMP($J,"AG"),BDC
"RTN","RMPR9S8",48,0)
 S B=0,RC=1
"RTN","RMPR9S8",49,0)
 F  S B=$O(^TMP($J,"TT",B)) Q:B'>0  D
"RTN","RMPR9S8",50,0)
 .S RK=0
"RTN","RMPR9S8",51,0)
 .F  S RK=$O(^TMP($J,"TT",B,RK)) Q:RK'>0  D
"RTN","RMPR9S8",52,0)
 . .Q:'$D(^RMPO(665.72,"AC",RK))
"RTN","RMPR9S8",53,0)
 . .S ^TMP($J,"RMPRC",RC)=RK
"RTN","RMPR9S8",54,0)
 . .I $P(^TMP($J,"TT",B,RK),U,3) S $P(^TMP($J,"RMPRC",RC),U,3)=$P(^TMP($J,"TT",B,RK),U,3)
"RTN","RMPR9S8",55,0)
 . .S RC=RC+1
"RTN","RMPR9S8",56,0)
 S RK=0,RZ=0
"RTN","RMPR9S8",57,0)
 K ^TMP($J,"TT"),B
"RTN","RMPR9S8",58,0)
 ;
"RTN","RMPR9S8",59,0)
 G:'$D(^TMP($J,"RMPRC")) END
"RTN","RMPR9S8",60,0)
 ;
"RTN","RMPR9S8",61,0)
DIS ;format data string - only HOME OXYGEN
"RTN","RMPR9S8",62,0)
 S RC=""
"RTN","RMPR9S8",63,0)
 S RK=1
"RTN","RMPR9S8",64,0)
 F  S RK=$O(^TMP($J,"RMPRC",RK)) Q:RK=""  D
"RTN","RMPR9S8",65,0)
 .S AN=+^TMP($J,"RMPRC",RK)
"RTN","RMPR9S8",66,0)
 .S Y=^RMPR(660,AN,0)
"RTN","RMPR9S8",67,0)
 .D PRT
"RTN","RMPR9S8",68,0)
 ;
"RTN","RMPR9S8",69,0)
END ;
"RTN","RMPR9S8",70,0)
 ;
"RTN","RMPR9S8",71,0)
EXIT ;common exit point
"RTN","RMPR9S8",72,0)
 K ^TMP($J,"RMPRC")
"RTN","RMPR9S8",73,0)
 ;pass to broker
"RTN","RMPR9S8",74,0)
 M RESULTS=^TMP($J,"RMPRB")
"RTN","RMPR9S8",75,0)
 I '$D(RESULTS) S RESULTS(0)="NOTHING TO REPORT"
"RTN","RMPR9S8",76,0)
 K I,J,L,R0,RA
"RTN","RMPR9S8",77,0)
 Q
"RTN","RMPR9S8",78,0)
 ;
"RTN","RMPR9S8",79,0)
 Q
"RTN","RMPR9S8",80,0)
PRT S DATE=$P(Y,U,3),TYPE=$P(Y,U,6),QTY=$P(Y,U,7)
"RTN","RMPR9S8",81,0)
 S VEN=$P(Y,U,9),TRANS=$P(Y,U,4),STA=$P(Y,U,10),SN=$P(Y,U,11)
"RTN","RMPR9S8",82,0)
 S DEL=$P(Y,U,12)
"RTN","RMPR9S8",83,0)
 S CST=$S($P(Y,U,16)'="":$P(Y,U,16),$D(^RMPR(660,AN,"LB")):$P(^RMPR(660,AN,"LB"),U,9),1:"")
"RTN","RMPR9S8",84,0)
 ;lab source of procurement
"RTN","RMPR9S8",85,0)
 I $D(^RMPR(660,AN,"LB")) S RMPRLPRO=$P(^("LB"),U,3) D
"RTN","RMPR9S8",86,0)
 .I RMPRLPRO="O" S RMPRLPRO="ORTHOTIC" Q
"RTN","RMPR9S8",87,0)
 .I RMPRLPRO="R" S RMPRLPRO="RESTORATION" Q
"RTN","RMPR9S8",88,0)
 .I RMPRLPRO="S" S RMPRLPRO="SHOE" Q
"RTN","RMPR9S8",89,0)
 .I RMPRLPRO="W" S RMPRLPRO="WHEELCHAIR" Q
"RTN","RMPR9S8",90,0)
 .I RMPRLPRO="N" S RMPRLPRO="FOOT CENTER" Q
"RTN","RMPR9S8",91,0)
 .I RMPRLPRO="D" S RMPRLPRO="DDC" Q
"RTN","RMPR9S8",92,0)
 ;form requested on
"RTN","RMPR9S8",93,0)
 S FRM=$P(Y,U,13),REM=$P(Y,U,18)
"RTN","RMPR9S8",94,0)
 S DATE=$E(DATE,4,5)_"/"_$E(DATE,6,7)_"/"_$E(DATE,2,3)
"RTN","RMPR9S8",95,0)
 S TYPE=$P($G(^RMPR(660,AN,1)),U,4)
"RTN","RMPR9S8",96,0)
 ;S TYPE=$S(TYPE="":"",$D(^RMPR(661,TYPE,0)):$P(^(0),U,1),1:"")
"RTN","RMPR9S8",97,0)
 S AMIS=$P(Y,U,15),VEN=$S(VEN="":"",$D(^PRC(440,VEN,0)):$P(^(0),U,1),1:"")
"RTN","RMPR9S8",98,0)
 I $D(^RMPR(660.1,"AC",AN)),$P(^RMPR(660.1,$O(^RMPR(660.1,"AC",AN,0)),0),U,11)]"" S AMIS=AMIS_"+"
"RTN","RMPR9S8",99,0)
 S TRANS=$S(TRANS]"":TRANS,1:""),TRANS1="" S:TRANS="X" TRANS1=TRANS,TRANS=""
"RTN","RMPR9S8",100,0)
 S DEL=$E(DEL,4,5)_"/"_$E(DEL,6,7)_"/"_$E(DEL,2,3) S:DEL="//" DEL=""
"RTN","RMPR9S8",101,0)
 ;
"RTN","RMPR9S8",102,0)
 ;set results array
"RTN","RMPR9S8",103,0)
 ;only home oxygen records at this point
"RTN","RMPR9S8",104,0)
 S ITEM=$S(TYPE'="":$P($G(^RMPR(661.1,TYPE,0)),U,2),$P(Y,U,26)="D":"DELIVERY",$P(Y,U,26)="P":"PICKUP",$P(Y,U,17):"SHIPPING",1:"")
"RTN","RMPR9S8",105,0)
 ;
"RTN","RMPR9S8",106,0)
 S HCPCS=$P($G(^RMPR(660,$P(^TMP($J,"RMPRC",RK),U,1),1)),U,4)
"RTN","RMPR9S8",107,0)
 I HCPCS'="" S HCPCS=$P($G(^RMPR(661.1,HCPCS,0)),U,1)
"RTN","RMPR9S8",108,0)
 S ^TMP($J,"RMPRB",RK)=$P(^TMP($J,"RMPRC",RK),U,1)_U_DATE_U_QTY_U_ITEM
"RTN","RMPR9S8",109,0)
 S ^TMP($J,"RMPRB",RK)=^TMP($J,"RMPRB",RK)_U_HCPCS_U_TRANS_TRANS1
"RTN","RMPR9S8",110,0)
 ;
"RTN","RMPR9S8",111,0)
 ;display source of procurement for 2529-3 under vendor header
"RTN","RMPR9S8",112,0)
 I $D(RMPRLPRO) S ^TMP($J,"RMPRB",RK)=^TMP($J,"RMPRB",RK)_U_RMPRLPRO
"RTN","RMPR9S8",113,0)
 I '$D(RMPRLPRO),VEN'="" S ^TMP($J,"RMPRB",RK)=^TMP($J,"RMPRB",RK)_U_$E(VEN,1,10)
"RTN","RMPR9S8",114,0)
 K RMPRLPRO
"RTN","RMPR9S8",115,0)
 ;
"RTN","RMPR9S8",116,0)
 S ^TMP($J,"RMPRB",RK)=^TMP($J,"RMPRB",RK)_U_$P($G(^DIC(4,STA,99)),U,1)_U_SN_U_DEL
"RTN","RMPR9S8",117,0)
 I $P(^TMP($J,"RMPRC",RK),U,3) S CST=$P(^TMP($J,"RMPRC",RK),U,3)
"RTN","RMPR9S8",118,0)
 S COST=$J($FN($S(CST'="":CST,$P(Y,U,17):$P(Y,U,17),1:""),"T",2),9)
"RTN","RMPR9S8",119,0)
 ;
"RTN","RMPR9S8",120,0)
 S ^TMP($J,"RMPRB",RK)=^TMP($J,"RMPRB",RK)_U_COST_U_REM
"RTN","RMPR9S8",121,0)
 ;
"RTN","RMPR9S8",122,0)
 I $P(^TMP($J,"RMPRC",RK),U,2)="" S $P(^TMP($J,"RMPRC",RK),U,2)=RZ
"RTN","RMPR9S8",123,0)
 ;
"RTN","RMPR9S8",124,0)
 Q
"RTN","RMPR9S8",125,0)
 ;END
"RTN","RMPRPAT2")
0^2^B25980530
"RTN","RMPRPAT2",1,0)
RMPRPAT2 ;PHX/RFM/JLT/HNC-DISPLAY PATIENT ITEM ACTIVITY ;10/19/1993
"RTN","RMPRPAT2",2,0)
 ;;3.0;PROSTHETICS;**32,34,29,44,99**;Feb 09, 1996
"RTN","RMPRPAT2",3,0)
 D HDR
"RTN","RMPRPAT2",4,0)
 S (RA,AN,ANS,RK,RZ)=0 K ^TMP($J,"TT"),^TMP($J,"AG"),IT
"RTN","RMPRPAT2",5,0)
 MERGE ^TMP($J,"TT")=^RMPR(660,"AC",RMPRDFN)
"RTN","RMPRPAT2",6,0)
 S B=0
"RTN","RMPRPAT2",7,0)
 F  S B=$O(^TMP($J,"TT",B)) Q:B'>0  D
"RTN","RMPRPAT2",8,0)
 . S BC=0
"RTN","RMPRPAT2",9,0)
 . F  S BC=$O(^TMP($J,"TT",B,BC)) Q:BC'>0  D
"RTN","RMPRPAT2",10,0)
 . .Q:$P($G(^RMPR(660,BC,0)),U,10)'=RMPR("STA")
"RTN","RMPRPAT2",11,0)
 . .S GN=$P($G(^RMPR(660,BC,"AMS")),U,1)
"RTN","RMPRPAT2",12,0)
 . .S ND=$P($G(^RMPR(660,BC,1)),U,4)
"RTN","RMPRPAT2",13,0)
 . .I ND S ND=$P(^RMPR(661.1,ND,0),U,8)
"RTN","RMPRPAT2",14,0)
 . .S:ND="" ND=2
"RTN","RMPRPAT2",15,0)
 . .S:GN="" GN=BC
"RTN","RMPRPAT2",16,0)
 . .S ^TMP($J,"AG",GN,ND,BC)=B
"RTN","RMPRPAT2",17,0)
 S B=""
"RTN","RMPRPAT2",18,0)
 F  S B=$O(^TMP($J,"AG",B)) Q:B'>0  D
"RTN","RMPRPAT2",19,0)
 .S BC=""
"RTN","RMPRPAT2",20,0)
 .F  S BC=$O(^TMP($J,"AG",B,BC)) Q:BC'>0  D
"RTN","RMPRPAT2",21,0)
 . .Q:BC=2
"RTN","RMPRPAT2",22,0)
 . .MERGE ^TMP($J,"AGG")=^TMP($J,"AG",B)
"RTN","RMPRPAT2",23,0)
 . .S HC="",GTCST=0
"RTN","RMPRPAT2",24,0)
 . .K HCC1
"RTN","RMPRPAT2",25,0)
 . .F  S HC=$O(^TMP($J,"AGG",HC)) Q:HC'>0  D
"RTN","RMPRPAT2",26,0)
 . . .S HCC=0
"RTN","RMPRPAT2",27,0)
 . . .;changes for Surgical Implants
"RTN","RMPRPAT2",28,0)
 . . .S BDC=""
"RTN","RMPRPAT2",29,0)
 . . .F BDC=1:1 S HCC=$O(^TMP($J,"AGG",HC,HCC)) Q:HCC'>0  D
"RTN","RMPRPAT2",30,0)
 . . . .S GTCST=GTCST+$P(^RMPR(660,HCC,0),U,16)
"RTN","RMPRPAT2",31,0)
 . . . .I BDC=1&(HC'=2) S HCC1=HCC
"RTN","RMPRPAT2",32,0)
 . . . .I BDC'=1 K ^TMP($J,"TT",^TMP($J,"AGG",HC,HCC),HCC)
"RTN","RMPRPAT2",33,0)
 . . . .I HC=2 K ^TMP($J,"TT",^TMP($J,"AGG",HC,HCC),HCC)
"RTN","RMPRPAT2",34,0)
 . .I $G(HCC1) S $P(^TMP($J,"TT",^TMP($J,"AGG",1,HCC1),HCC1),U,3)=GTCST K HCC1
"RTN","RMPRPAT2",35,0)
 . .K GTCST,^TMP($J,"AGG")
"RTN","RMPRPAT2",36,0)
 K ^TMP($J,"AG"),BDC
"RTN","RMPRPAT2",37,0)
 S B=0,RC=1
"RTN","RMPRPAT2",38,0)
 F  S B=$O(^TMP($J,"TT",B)) Q:B'>0  D
"RTN","RMPRPAT2",39,0)
 .S RK=0
"RTN","RMPRPAT2",40,0)
 .F  S RK=$O(^TMP($J,"TT",B,RK)) Q:RK'>0  D
"RTN","RMPRPAT2",41,0)
 . .Q:$D(^RMPO(665.72,"AC",RK))
"RTN","RMPRPAT2",42,0)
 . .S IT(RC)=RK
"RTN","RMPRPAT2",43,0)
 . .I $P(^TMP($J,"TT",B,RK),U,3) S $P(IT(RC),U,3)=$P(^TMP($J,"TT",B,RK),U,3)
"RTN","RMPRPAT2",44,0)
 . .S RC=RC+1
"RTN","RMPRPAT2",45,0)
 S RK=0,RZ=0
"RTN","RMPRPAT2",46,0)
 K ^TMP($J,"TT"),B
"RTN","RMPRPAT2",47,0)
 ;
"RTN","RMPRPAT2",48,0)
 G:'$D(IT) END
"RTN","RMPRPAT2",49,0)
DIS ;DISPLAY APPLIANCES OR REPAIRS
"RTN","RMPRPAT2",50,0)
 I $G(RK)="" S RK="",RC=""
"RTN","RMPRPAT2",51,0)
 I (RK+1'>RC)&($G(IT(RK+1))) S RK=RK+1 S AN=+IT(RK),Y=^RMPR(660,AN,0) D PRT,OVER:((IOSL-4)<$Y) G:'$D(ANS)!(ANS=U)!($D(DUOUT))!($D(DTOUT)) EXIT G DIS
"RTN","RMPRPAT2",52,0)
END I RC=0 W !,"No Appliances or Repairs exist for this veteran!",!! H 3 G EXIT
"RTN","RMPRPAT2",53,0)
 ;
"RTN","RMPRPAT2",54,0)
 I RC>0 W !!,"End of Appliance/Repair records for this veteran!" D OVER I $G(RK)+1'>$G(RC)&($G(IT($G(RK)+1))) D DIS
"RTN","RMPRPAT2",55,0)
 ;
"RTN","RMPRPAT2",56,0)
EXIT K I,J,L,R0,IT,RA
"RTN","RMPRPAT2",57,0)
 Q:'$D(RMPRDFN)
"RTN","RMPRPAT2",58,0)
 W !
"RTN","RMPRPAT2",59,0)
 I $D(DUOUT)!($D(DTOUT)) G ASK1^RMPRPAT
"RTN","RMPRPAT2",60,0)
 S FL=4 G ASK2^RMPRPAT
"RTN","RMPRPAT2",61,0)
 Q
"RTN","RMPRPAT2",62,0)
PRT S DATE=$P(Y,U,3),TYPE=$P(Y,U,6),QTY=$P(Y,U,7)
"RTN","RMPRPAT2",63,0)
 S VEN=$P(Y,U,9),TRANS=$P(Y,U,4),STA=$P(Y,U,10),SN=$P(Y,U,11)
"RTN","RMPRPAT2",64,0)
 S DEL=$P(Y,U,12)
"RTN","RMPRPAT2",65,0)
 S CST=$S($P(Y,U,16)'="":$P(Y,U,16),$D(^RMPR(660,AN,"LB")):$P(^RMPR(660,AN,"LB"),U,9),1:"")
"RTN","RMPRPAT2",66,0)
 ;lab source of procurement
"RTN","RMPRPAT2",67,0)
 I $D(^RMPR(660,AN,"LB")) S RMPRLPRO=$P(^("LB"),U,3) D
"RTN","RMPRPAT2",68,0)
 .I RMPRLPRO="O" S RMPRLPRO="ORTHOTIC" Q
"RTN","RMPRPAT2",69,0)
 .I RMPRLPRO="R" S RMPRLPRO="RESTORATION" Q
"RTN","RMPRPAT2",70,0)
 .I RMPRLPRO="S" S RMPRLPRO="SHOE" Q
"RTN","RMPRPAT2",71,0)
 .I RMPRLPRO="W" S RMPRLPRO="WHEELCHAIR" Q
"RTN","RMPRPAT2",72,0)
 .I RMPRLPRO="N" S RMPRLPRO="FOOT CENTER" Q
"RTN","RMPRPAT2",73,0)
 .I RMPRLPRO="D" S RMPRLPRO="DDC" Q
"RTN","RMPRPAT2",74,0)
 ;form requested on
"RTN","RMPRPAT2",75,0)
 S FRM=$P(Y,U,13),REM=$P(Y,U,18)
"RTN","RMPRPAT2",76,0)
 S DATE=$E(DATE,4,5)_"/"_$E(DATE,6,7)_"/"_$E(DATE,2,3)
"RTN","RMPRPAT2",77,0)
 S TYPE=$P($G(^RMPR(660,AN,1)),U,4)
"RTN","RMPRPAT2",78,0)
 ;S TYPE=$S(TYPE="":"",$D(^RMPR(661,TYPE,0)):$P(^(0),U,1),1:"")
"RTN","RMPRPAT2",79,0)
 S AMIS=$P(Y,U,15),VEN=$S(VEN="":"",$D(^PRC(440,VEN,0)):$P(^(0),U,1),1:"")
"RTN","RMPRPAT2",80,0)
 I $D(^RMPR(660.1,"AC",AN)),$P(^RMPR(660.1,$O(^RMPR(660.1,"AC",AN,0)),0),U,11)]"" S AMIS=AMIS_"+"
"RTN","RMPRPAT2",81,0)
 S TRANS=$S(TRANS]"":TRANS,1:""),TRANS1="" S:TRANS="X" TRANS1=TRANS,TRANS=""
"RTN","RMPRPAT2",82,0)
 S DEL=$E(DEL,4,5)_"/"_$E(DEL,6,7)_"/"_$E(DEL,2,3) S:DEL="//" DEL=""
"RTN","RMPRPAT2",83,0)
 W !,RK,". ",DATE,?13,QTY,?17
"RTN","RMPRPAT2",84,0)
 ;W AMIS_$S(TYPE'="":$E($P(^PRC(441,TYPE,0),U,2),1,10),$P(Y,U,26)="D":"DELIVERY",$P(Y,U,26)="P":"PICKUP",$P(Y,U,17):"SHIPPING",1:"")
"RTN","RMPRPAT2",85,0)
 W AMIS_$S(TYPE'="":$E($P($G(^RMPR(661.1,TYPE,0)),U,2),1,10),$P(Y,U,26)="D":"DELIVERY",$P(Y,U,26)="P":"PICKUP",$P(Y,U,17):"SHIPPING",1:"")
"RTN","RMPRPAT2",86,0)
 ;historical item
"RTN","RMPRPAT2",87,0)
 I TYPE=""&($D(^RMPR(660,$P(IT(RK),U,1),"HST"))) W $E($P(^("HST"),U,1),1,10)
"RTN","RMPRPAT2",88,0)
 W ?30,TRANS,?31,TRANS1
"RTN","RMPRPAT2",89,0)
 ;display source of procurement for 2529-3 under vendor header
"RTN","RMPRPAT2",90,0)
 I $D(RMPRLPRO) W ?33,RMPRLPRO
"RTN","RMPRPAT2",91,0)
 I '$D(RMPRLPRO),VEN'="" W ?33,$E(VEN,1,10)
"RTN","RMPRPAT2",92,0)
 K RMPRLPRO
"RTN","RMPRPAT2",93,0)
 ;historical vendor
"RTN","RMPRPAT2",94,0)
 W:$D(^RMPR(660,$P(IT(RK),U,1),"HST")) $E($P(^("HST"),U,3),1,10)
"RTN","RMPRPAT2",95,0)
 W:STA'="" ?45,$P(^DIC(4,STA,99),U,1)
"RTN","RMPRPAT2",96,0)
 W ?50,$E(SN,1,9),?60,DEL
"RTN","RMPRPAT2",97,0)
 I $P(IT(RK),U,3) S CST=$P(IT(RK),U,3)
"RTN","RMPRPAT2",98,0)
 W ?71,$J($FN($S(CST'="":CST,$P(Y,U,17):$P(Y,U,17),1:""),"T",2),9)
"RTN","RMPRPAT2",99,0)
 W:REM]"" !,?3,REM
"RTN","RMPRPAT2",100,0)
 I $P(IT(RK),U,2)="" S $P(IT(RK),U,2)=RZ
"RTN","RMPRPAT2",101,0)
 Q
"RTN","RMPRPAT2",102,0)
OVER ;
"RTN","RMPRPAT2",103,0)
 N ANS
"RTN","RMPRPAT2",104,0)
 S RZ=RK W !,"+=Turned-In  *=Historical Data  I=Initial  X=Repair  S=Spare  R=Replacement",!,"Enter 1-",RK," to show full entry, '^' to exit or `return` to continue.  " R ANS:DTIME S:'$T ANS="^"
"RTN","RMPRPAT2",105,0)
 I ANS="^^" S ANS="^" G ASK1^RMPRPAT Q
"RTN","RMPRPAT2",106,0)
 I ANS="^" G ASK1^RMPRPAT Q
"RTN","RMPRPAT2",107,0)
 I ANS="",RK+1'>RC&($G(IT(RK+1))) D HDR Q
"RTN","RMPRPAT2",108,0)
 I ANS="" Q
"RTN","RMPRPAT2",109,0)
 I ANS'?1N.N!(ANS>RK)!(+ANS=0)!(+ANS'=ANS) W $C(7),!," Must be between 1 and ",RK," to be valid" G OVER
"RTN","RMPRPAT2",110,0)
 I ANS>0,(ANS<(RK+1)) S AN=ANS,RZ=RK D ^RMPRPAT3
"RTN","RMPRPAT2",111,0)
 S RK=$P(IT(ANS),U,2)
"RTN","RMPRPAT2",112,0)
 Q
"RTN","RMPRPAT2",113,0)
HDR ;Print Header, Screen 4
"RTN","RMPRPAT2",114,0)
 W @IOF
"RTN","RMPRPAT2",115,0)
 S PAGE=3
"RTN","RMPRPAT2",116,0)
 W !,$E(RMPRNAM,1,20),?23,"SSN: "
"RTN","RMPRPAT2",117,0)
 W $E(RMPRSSN,1,3)_"-"_$E(RMPRSSN,4,5)_"-"_$E(RMPRSSN,6,10)
"RTN","RMPRPAT2",118,0)
 W ?42,"DOB: "
"RTN","RMPRPAT2",119,0)
 S Y=RMPRDOB X ^DD("DD") W Y K Y
"RTN","RMPRPAT2",120,0)
 W ?61,"CLAIM# ",$G(RMPRCNUM)
"RTN","RMPRPAT2",121,0)
 W !?4,"Date",?12,"Qty",?19,"HCPCS",?28,"Type",?34,"Vendor",?45,"Sta",?50,"Serial",?58,"Delivery Date",?72,"Tot Cost"
"RTN","RMPRPAT2",122,0)
 Q
"RTN","RMPRPAT3")
0^1^B38507405
"RTN","RMPRPAT3",1,0)
RMPRPAT3 ;HINES-CIOFO/HNC,RVD - Detail Display Patient 10-2319 Transaction ;11/03/04
"RTN","RMPRPAT3",2,0)
 ;;3.0;PROSTHETICS;**3,12,25,28,32,41,69,92,99**;Feb 09, 1996
"RTN","RMPRPAT3",3,0)
 ;
"RTN","RMPRPAT3",4,0)
 ; RVD 4/30/02 patch #69 - add ICD-9 CODE and description in the display.
"RTN","RMPRPAT3",5,0)
 ;                         add HCPCS and Short Description.
"RTN","RMPRPAT3",6,0)
 ; AAC 08/03/04 Patch 92 - Code Set Versioning (CSV)
"RTN","RMPRPAT3",7,0)
 ;Used API=ICDDX^ICDCODE to replace direct calls to global ICD9(80).
"RTN","RMPRPAT3",8,0)
 ;
"RTN","RMPRPAT3",9,0)
 ;expect ANS,IT(ANS)
"RTN","RMPRPAT3",10,0)
 ;          +IT(ANS)=ien of file 660
"RTN","RMPRPAT3",11,0)
 ;expect variables from GETPAT^RMPRUTIL
"RTN","RMPRPAT3",12,0)
 ;    RMPRSSNE (external form of SSN)
"RTN","RMPRPAT3",13,0)
 ;    RMPRNAM (name of patient)
"RTN","RMPRPAT3",14,0)
 ;    RMPRDOB
"RTN","RMPRPAT3",15,0)
 ;display detailed record
"RTN","RMPRPAT3",16,0)
PRINT ;called from RMPRPAT2
"RTN","RMPRPAT3",17,0)
 ;get 2319 transaction
"RTN","RMPRPAT3",18,0)
 ;
"RTN","RMPRPAT3",19,0)
 N DIC,DIQ,DR,DA,RMPRV,RMPRDA,RV
"RTN","RMPRPAT3",20,0)
 S DIC=660,DIQ="R19",DR=".01:96",DIQ(0)="EN"
"RTN","RMPRPAT3",21,0)
 S (RMPRDA,DA)=+IT(ANS)
"RTN","RMPRPAT3",22,0)
 D EN^DIQ1
"RTN","RMPRPAT3",23,0)
 S DIQ="R19",DR=72,DIQ(0)="I" D EN^DIQ1
"RTN","RMPRPAT3",24,0)
 ;get vendor info
"RTN","RMPRPAT3",25,0)
 S DA=$P(^RMPR(660,RMPRDA,0),U,9)
"RTN","RMPRPAT3",26,0)
 I DA D
"RTN","RMPRPAT3",27,0)
 .S DIC=440,DIQ="RV",DR=".01:6",DIQ(0)="EN"
"RTN","RMPRPAT3",28,0)
 .S (RMPRV,DA)=$P(^RMPR(660,RMPRDA,0),U,9)
"RTN","RMPRPAT3",29,0)
 .D EN^DIQ1
"RTN","RMPRPAT3",30,0)
 ;
"RTN","RMPRPAT3",31,0)
 ;array defined for record in following format:
"RTN","RMPRPAT3",32,0)
 ;R19(filenumber,ien,field,E)=external form of data
"RTN","RMPRPAT3",33,0)
 ;RV(filenumber,ien,field,E)=external form of data
"RTN","RMPRPAT3",34,0)
 ;example:
"RTN","RMPRPAT3",35,0)
 ;R19(660,100,.01,"E")=APR 27, 1995
"RTN","RMPRPAT3",36,0)
 ;R19(660,100,.02,"E")=FUDGE,CHOCOLATE
"RTN","RMPRPAT3",37,0)
 ;RV(440,131,.01,"E")=ORTHOTIC LAB
"RTN","RMPRPAT3",38,0)
 ;
"RTN","RMPRPAT3",39,0)
 D HDR
"RTN","RMPRPAT3",40,0)
 W !,"TYPE OF FORM: ",$G(R19(660,RMPRDA,11,"E"))
"RTN","RMPRPAT3",41,0)
 W ?25,"INITIATOR: ",$G(R19(660,RMPRDA,27,"E"))
"RTN","RMPRPAT3",42,0)
 W ?55,"DATE: ",$G(R19(660,RMPRDA,1,"E"))
"RTN","RMPRPAT3",43,0)
 ;historical/original item
"RTN","RMPRPAT3",44,0)
 ;W !,"ITEM DESCRIPTION: ",$G(R19(660,RMPRDA,89,"E"))
"RTN","RMPRPAT3",45,0)
 W !,"DELIVER TO: ",$G(R19(660,RMPRDA,25,"E"))
"RTN","RMPRPAT3",46,0)
 W !,"TYPE TRANS: ",$G(R19(660,RMPRDA,2,"E"))
"RTN","RMPRPAT3",47,0)
 W ?30,"QTY: ",$G(R19(660,RMPRDA,5,"E"))
"RTN","RMPRPAT3",48,0)
 W:$G(R19(660,RMPRDA,29,"E")) ?40,"INVENTORY POINT: ",R19(660,RMPRDA,29,"E"),!
"RTN","RMPRPAT3",49,0)
 W ?40,"SOURCE: ",$G(R19(660,RMPRDA,12,"E"))
"RTN","RMPRPAT3",50,0)
 ;vendor tracking number
"RTN","RMPRPAT3",51,0)
 I $G(R19(660,RMPRDA,11,"E"))="VISA" D
"RTN","RMPRPAT3",52,0)
 .W !,"VENDOR TRACKING: ",$G(R19(660,RMPRDA,4.2,"E"))
"RTN","RMPRPAT3",53,0)
 .W ?38,"BANK AUTHORIZATION: ",$G(R19(660,RMPRDA,4.3,"E"))
"RTN","RMPRPAT3",54,0)
 W !,"VENDOR: ",?15,$G(R19(660,RMPRDA,7,"E"))
"RTN","RMPRPAT3",55,0)
 I $D(RV) D
"RTN","RMPRPAT3",56,0)
 .W !,"VENDOR PHONE: ",?15,$G(RV(440,RMPRV,5,"E"))
"RTN","RMPRPAT3",57,0)
 .W !?15,$G(RV(440,RMPRV,1,"E"))
"RTN","RMPRPAT3",58,0)
 .W !?15,$G(RV(440,RMPRV,4.2,"E")),","
"RTN","RMPRPAT3",59,0)
 .W ?$X+3,$G(RV(440,RMPRV,4.4,"E")),?$X+5,$G(RV(440,RMPRV,4.6,"E"))
"RTN","RMPRPAT3",60,0)
 W !,"DELIVERY DATE: "
"RTN","RMPRPAT3",61,0)
 I $D(R19(660,RMPRDA,10,"E")) W R19(660,RMPRDA,10,"E")
"RTN","RMPRPAT3",62,0)
 W !
"RTN","RMPRPAT3",63,0)
 I '$P(IT(AN),U,3) D
"RTN","RMPRPAT3",64,0)
 .W "TOTAL COST: "
"RTN","RMPRPAT3",65,0)
 .I $G(R19(660,RMPRDA,14,"E"))'="" W "$"_$J(R19(660,RMPRDA,14,"E"),2)
"RTN","RMPRPAT3",66,0)
 .I $G(R19(660,RMPRDA,14,"E"))="" W $S($G(R19(660,RMPRDA,6,"E"))'="":"$"_$J(R19(660,RMPRDA,6,"E"),2),$G(R19(660,RMPRDA,48,"E"))'="":"$"_$J(R19(660,RMPRDA,48,"E"),2),1:"")
"RTN","RMPRPAT3",67,0)
 W ?30,"OBL: ",$G(R19(660,RMPRDA,23,"E"))
"RTN","RMPRPAT3",68,0)
 ;
"RTN","RMPRPAT3",69,0)
 ;lab data
"RTN","RMPRPAT3",70,0)
 I $D(^RMPR(660,RMPRDA,"LB")) D
"RTN","RMPRPAT3",71,0)
 .N DIC,DIQ,DR,L19,DA
"RTN","RMPRPAT3",72,0)
 .S (DA,RMPRLA)=$P(^RMPR(660,RMPRDA,"LB"),U,10)
"RTN","RMPRPAT3",73,0)
 .Q:DA=""
"RTN","RMPRPAT3",74,0)
 .S DIC=664.1,DIQ="L19",DR="15",DIQ(0)="E"
"RTN","RMPRPAT3",75,0)
 .D EN^DIQ1
"RTN","RMPRPAT3",76,0)
 .W !,"WORK ORDER: ",$G(R19(660,RMPRDA,71,"E"))
"RTN","RMPRPAT3",77,0)
 .W ?40,"RECEIVING STATION: ",$G(R19(660,RMPRDA,70,"E"))
"RTN","RMPRPAT3",78,0)
 .W !,"TECHNICIAN: ",$G(L19(664.1,RMPRLA,15,"E"))
"RTN","RMPRPAT3",79,0)
 .W !,"TOTAL LABOR HOURS: ",$G(R19(660,RMPRDA,45,"E"))
"RTN","RMPRPAT3",80,0)
 .W ?40,"TOTAL LABOR COST: ",$G(R19(660,RMPRDA,46,"E"))
"RTN","RMPRPAT3",81,0)
 .W !,"TOTAL MATERIAL COST: ",$G(R19(660,RMPRDA,47,"E"))
"RTN","RMPRPAT3",82,0)
 .W ?40,"TOTAL LAB COST: ",$G(R19(660,RMPRDA,48,"E"))
"RTN","RMPRPAT3",83,0)
 .W !,"COMPLETION DATE: ",$G(R19(660,RMPRDA,50,"E"))
"RTN","RMPRPAT3",84,0)
 .W ?40,"LAB REMARKS: ",$G(R19(660,RMPRDA,51,"E"))
"RTN","RMPRPAT3",85,0)
 W !,"REMARKS: ",?15,$G(R19(660,RMPRDA,16,"E"))
"RTN","RMPRPAT3",86,0)
 I $G(R19(660,RMPRDA,17.5,"E")) W ?40,"RETURN STATUS: ",R19(660,RMPRDA,17.5,"E")
"RTN","RMPRPAT3",87,0)
 ;
"RTN","RMPRPAT3",88,0)
 ;historical data
"RTN","RMPRPAT3",89,0)
 I $G(R19(660,RMPRDA,15,"E"))["*" D
"RTN","RMPRPAT3",90,0)
 .;include records that have been merged
"RTN","RMPRPAT3",91,0)
 .W !!,"HISTORICAL DATA",!
"RTN","RMPRPAT3",92,0)
 .Q:'$D(R19(660,RMPRDA,89))
"RTN","RMPRPAT3",93,0)
 .W !,?15,"ITEM: ",$G(R19(660,RMPRDA,89,"E"))
"RTN","RMPRPAT3",94,0)
 .W !,?15,"STATION: ",$G(R19(660,RMPRDA,90,"E"))
"RTN","RMPRPAT3",95,0)
 .W !,?15,"VENDOR: ",$G(R19(660,RMPRDA,91,"E")),"   PHONE: ",$G(R19(660,RMPRDA,92,"E"))
"RTN","RMPRPAT3",96,0)
 .W !,?23,$G(R19(660,RMPRDA,93,"E")),!,?23,$G(R19(660,RMPRDA,94,"E"))
"RTN","RMPRPAT3",97,0)
 .W "   ",$G(R19(660,RMPRDA,95,"E")),"  ",$G(R19(660,RMPRDA,96,"E"))
"RTN","RMPRPAT3",98,0)
 ;put in lab display here fields 45,46,47,48 and 51
"RTN","RMPRPAT3",99,0)
 ;lab amis
"RTN","RMPRPAT3",100,0)
 I $G(R19(660,RMPRDA,73,"E")) D
"RTN","RMPRPAT3",101,0)
 .W ?40,"ORTHOTICS LAB CODE: "
"RTN","RMPRPAT3",102,0)
 .W $S($D(R19(660,RMPRDA,74,"E")):R19(660,RMPRDA,74,"E"),$D(R19(660,RMPRDA,75,"E")):R19(660,RMPRDA,75,"E"),1:"")
"RTN","RMPRPAT3",103,0)
 .W !?40,"RESTORATIONS LAB CODE: "
"RTN","RMPRPAT3",104,0)
 .W $S($D(R19(660,RMPRDA,76,"E")):R19(660,RMPRDA,76,"E"),$D(R19(660,RMPRDA,77,"E")):R19(660,RMPRDA,77,"E"),1:"")
"RTN","RMPRPAT3",105,0)
 ;purchasing and issue from stock amis
"RTN","RMPRPAT3",106,0)
 W !,"DISABILITY SERVED: ",$G(R19(660,RMPRDA,62,"E"))
"RTN","RMPRPAT3",107,0)
 ;appliance/item information
"RTN","RMPRPAT3",108,0)
 ;historical/original item
"RTN","RMPRPAT3",109,0)
 W !,"ITEM DESCRIPTION: ",$G(R19(660,RMPRDA,89,"E"))
"RTN","RMPRPAT3",110,0)
 ;check for item description changes
"RTN","RMPRPAT3",111,0)
 I $G(R19(660,RMPRDA,89,"E"))'=$G(R19(660,RMPRDA,4,"E")) W !,"*** See Above For Original Item Description ***"
"RTN","RMPRPAT3",112,0)
 W !,"APPLIANCE: ",$G(R19(660,RMPRDA,4,"E"))
"RTN","RMPRPAT3",113,0)
 W !,"PSAS HCPCS: ",$G(R19(660,RMPRDA,4.5,"E"))
"RTN","RMPRPAT3",114,0)
 I $P($G(^RMPR(660,RMPRDA,1)),U,4) W ?22,$P($G(^RMPR(661.1,$P(^RMPR(660,RMPRDA,1),U,4),0)),U,2)
"RTN","RMPRPAT3",115,0)
 ;added by #69
"RTN","RMPRPAT3",116,0)
 ;
"RTN","RMPRPAT3",117,0)
 ; PATCH 92 - Code Set Versioning (CSV) changes below
"RTN","RMPRPAT3",118,0)
 ; AAC      - 08/03/04
"RTN","RMPRPAT3",119,0)
 ;
"RTN","RMPRPAT3",120,0)
 S (RMPRICD,RMPRIC9,RMPRCOD,RMPRDAT)="" S RMPRERR=0
"RTN","RMPRPAT3",121,0)
 S RMPRDAT=$P($G(^RMPR(660,RMPRDA,0)),U,1)
"RTN","RMPRPAT3",122,0)
 I $D(^RMPR(660,RMPRDA,10)) S RMPRIC9=$P(^RMPR(660,RMPRDA,10),U,8)
"RTN","RMPRPAT3",123,0)
 I RMPRIC9'="" D
"RTN","RMPRPAT3",124,0)
 .S RMPRICD=$$ICDDX^ICDCODE(RMPRIC9,RMPRDAT)
"RTN","RMPRPAT3",125,0)
 .S RMPRERR=$P(RMPRICD,U,1)
"RTN","RMPRPAT3",126,0)
 .I RMPRERR<0 W !,"ICD-9 Message: ",$P(RMPRICD,U,2)
"RTN","RMPRPAT3",127,0)
 W !,"ICD-9 Code: "
"RTN","RMPRPAT3",128,0)
 I $G(RMPRICD)'="" W $P(RMPRICD,U,2),?19,$E($P(RMPRICD,U,4),1,55) I $P(RMPRICD,U,10)'>0 W " ","** Inactive ** Date: " S Y=$P(RMPRICD,U,12) D DD^%DT W Y
"RTN","RMPRPAT3",129,0)
 ;
"RTN","RMPRPAT3",130,0)
 ; End of Patch 92
"RTN","RMPRPAT3",131,0)
 ;
"RTN","RMPRPAT3",132,0)
 W !,"CPT MODIFIER: ",$G(R19(660,RMPRDA,4.7,"E"))
"RTN","RMPRPAT3",133,0)
 W !,"DESCRIPTION: ",$G(R19(660,RMPRDA,24,"E"))
"RTN","RMPRPAT3",134,0)
 W !,"EXTENDED DESCRIPTION: ",!
"RTN","RMPRPAT3",135,0)
 I $D(R19(660,RMPRDA,28)) D  G:$D(DUOUT)!$D(DTOUT) EX1
"RTN","RMPRPAT3",136,0)
 .N R28
"RTN","RMPRPAT3",137,0)
 .;command part of new standards
"RTN","RMPRPAT3",138,0)
 .MERGE R28=R19(660,RMPRDA,28)
"RTN","RMPRPAT3",139,0)
 .I $P($G(^RMPR(660,RMPRDA,"DES",0)),U,3)>1 N DIR S DIR(0)="E" D ^DIR Q:$D(DUOUT)!$D(DTOUT)  D HDR W !,"EXTENDED DESCRIPTION: ",!
"RTN","RMPRPAT3",140,0)
 .D EN^DDIOL(.R28)
"RTN","RMPRPAT3",141,0)
 ;NPPD key items consolidated, example L5300 limb order
"RTN","RMPRPAT3",142,0)
 I $P(IT(AN),U,3) W !!,"*** Return For DETAIL REPORT ***" N DIR S DIR(0)="E" D ^DIR G:$D(DUOUT)!$D(DTOUT) EX1  W @IOF D HDR,^RMPRPAT7
"RTN","RMPRPAT3",143,0)
 ;display work order if it is a 2529-3 form
"RTN","RMPRPAT3",144,0)
 ;must pass ien to file 664.1 NOT 664.2
"RTN","RMPRPAT3",145,0)
 I $G(R19(660,RMPRDA,72,"I"))'="" D  G EX1
"RTN","RMPRPAT3",146,0)
 .S DIR(0)="E" D ^DIR Q:$D(DTOUT)!$D(DUOUT)
"RTN","RMPRPAT3",147,0)
 .S RMPRBCK=RMPRDA
"RTN","RMPRPAT3",148,0)
 .N DIC
"RTN","RMPRPAT3",149,0)
 .S RMPRDA=R19(660,RMPRBCK,72,"I")
"RTN","RMPRPAT3",150,0)
 .D DISP^RMPR293(RMPRDA)
"RTN","RMPRPAT3",151,0)
 .S RMPRDA=RMPRBCK K RMPRBCK
"RTN","RMPRPAT3",152,0)
 ;return from work order
"RTN","RMPRPAT3",153,0)
 G EXIT
"RTN","RMPRPAT3",154,0)
 ;
"RTN","RMPRPAT3",155,0)
HDR ;display heading
"RTN","RMPRPAT3",156,0)
 W @IOF,RMPRNAM,?30," SSN: "
"RTN","RMPRPAT3",157,0)
 W $E(RMPRSSN,1,3)_"-"_$E(RMPRSSN,4,5)_"-"_$E(RMPRSSN,6,10),?50
"RTN","RMPRPAT3",158,0)
 W $G(R19(660,RMPRDA,8,"E")),?70,"DOB: "
"RTN","RMPRPAT3",159,0)
 W $S(RMPRDOB:$E(RMPRDOB,4,5)_"-"_$E(RMPRDOB,6,7)_"-"_(1700+$E(RMPRDOB,1,3)),1:"Unknown")
"RTN","RMPRPAT3",160,0)
 W !?20,"APPLIANCE/REPAIR LINE ITEM DETAIL ",?70,"<4-",ANS,">",!
"RTN","RMPRPAT3",161,0)
 Q
"RTN","RMPRPAT3",162,0)
EXIT ;common exit point
"RTN","RMPRPAT3",163,0)
 I $Y>(IOSL-4) F  W ! Q:$Y>(IOSL-3)
"RTN","RMPRPAT3",164,0)
 N DIR S DIR(0)="E" D ^DIR
"RTN","RMPRPAT3",165,0)
 ;duout,dtout is evaluated in dis+1^rmprpat2
"RTN","RMPRPAT3",166,0)
EX1 ;back out through that point to clean up
"RTN","RMPRPAT3",167,0)
 K R19,RV,RMPRICD,RMPRIC9,RMPRICD,RMPRIC9,MSGICD,RMPRCOD,RMPRERR,RMPRDAT,Y W @IOF
"RTN","RMPRPAT3",168,0)
 Q
"RTN","RMPRPAT3",169,0)
 ;end
"RTN","RMPRPRT1")
0^7^B21363701
"RTN","RMPRPRT1",1,0)
RMPRPRT1 ;PHX/HNB-CONTINUATION OF PRINT 2319 ;10/19/1993
"RTN","RMPRPRT1",2,0)
 ;;3.0;PROSTHETICS;**10,99**;Feb 09, 1996
"RTN","RMPRPRT1",3,0)
 ;CALLED BY END^RMPRPRT
"RTN","RMPRPRT1",4,0)
 ;VARIABLES REQUIRED: R5 - A STRING ARRAY HOLDING PATIENT'S PROSTHETIC
"RTN","RMPRPRT1",5,0)
 ;                         DISABILITY CODE INFORMATION
"RTN","RMPRPRT1",6,0)
 I $Y>(IOSL-6) W @IOF D HDR^RMPRPRT
"RTN","RMPRPRT1",7,0)
 W !!,"PSC Issue Card: " S J=0 W !
"RTN","RMPRPRT1",8,0)
 F I=1:1 D  Q:J'>0
"RTN","RMPRPRT1",9,0)
 .I $Y>(IOSL-6) W @IOF D HDR^RMPRPRT
"RTN","RMPRPRT1",10,0)
 .S J=$O(R5(5,J)) Q:J=""!(J?.A)  Q:$G(J)<1 
"RTN","RMPRPRT1",11,0)
 .S L=$P(R5(5,J,0),U,1) ;S L=$P(R5(5,J,0),U,1) 
"RTN","RMPRPRT1",12,0)
 .W $E(L,4,5)_"-"_$E(L,6,7)_"-"_$E(L,2,3),?17,"Appl: ",$S($D(^RMPR(661,+$P(R5(5,J,0),U,4),0)):$E($P(^PRC(441,+$P(^(0),U),0),U,2),1,37),1:"UNKNOWN"),?66,"SN: ",$P(R5(5,J,0),U,3),!
"RTN","RMPRPRT1",13,0)
 I I=1 W "NONE LISTED",!
"RTN","RMPRPRT1",14,0)
 W !,"Clothing Allowance: ",!
"RTN","RMPRPRT1",15,0)
 I $D(R5(6)),$O(R5(6,0))>0 D
"RTN","RMPRPRT1",16,0)
 .F RI=0:0 S RI=$O(^RMPR(665,RMPRDFN,6,"B",RI)) Q:RI'>0  D
"RTN","RMPRPRT1",17,0)
 ..S RA=$O(^RMPR(665,RMPRDFN,6,"B",RI,0))
"RTN","RMPRPRT1",18,0)
 ..S RR5=R5(6,RA,0),RR5=RR5
"RTN","RMPRPRT1",19,0)
 ..;D  I $Y>(IOSL-6) W @IOF D HDR^RMPRPRT
"RTN","RMPRPRT1",20,0)
 ..W ?22,"DATE: ",$E(RR5,4,5)_"-"_$E(RR5,6,7)_"-"_$E(RR5,2,3)
"RTN","RMPRPRT1",21,0)
 ..W "  ",$S($P(RR5,U,2)["E":"ELIGIBLE",$P(RR5,U,2)["N":"NOT-ELIGIBLE",1:"")
"RTN","RMPRPRT1",22,0)
 ..W "  ",$S($P(RR5,U,3)["S":"STATIC",$P(RR5,U,3)["N":"NON-STATIC",1:"")
"RTN","RMPRPRT1",23,0)
 ..I $P(RR5,U,5) S Y=$P(RR5,U,5) D DD^%DT W !,?22,"Date of Exam: ",Y W:$P(RR5,U,6) "  Examiner: ",$E($P(^VA(200,$P(RR5,U,6),0),U,1),1,30)
"RTN","RMPRPRT1",24,0)
 ..W !,?22,"Desc: "
"RTN","RMPRPRT1",25,0)
 ..W $S($D(R5(6,RA,1)):$P(R5(6,RA,1),U),1:""),!
"RTN","RMPRPRT1",26,0)
 ..I $Y>(IOSL-6) W @IOF D HDR^RMPRPRT
"RTN","RMPRPRT1",27,0)
 I '$D(R5(6)),$P(R5(0),U,6)="" W "NONE LISTED",!
"RTN","RMPRPRT1",28,0)
 S RO=0
"RTN","RMPRPRT1",29,0)
 F  S RO=$O(^RMPR(667,"C",RMPRDFN,RO)) Q:RO'>0  D  I $Y>(IOSL-6) W @IOF D HDR^RMPRPRT
"RTN","RMPRPRT1",30,0)
 .Q:$P(^RMPR(667,RO,2),U,1)=0
"RTN","RMPRPRT1",31,0)
 .W:'$D(RMPRFLG) !,"Automobile(s):",?15,"Make",?27,"Model",?39,"Vehical ID #",?62,"Date Processed"
"RTN","RMPRPRT1",32,0)
 .W:'$P(^RMPR(667,RO,0),U,6)'="" !?15,$E($P(^RMPR(667.2,$P(^RMPR(667,RO,0),U,6),0),U,1),1,11),?27,$E($P(^RMPR(667,RO,0),U,7),1,10),?39,$P(^RMPR(667,RO,0),U,1) S Y=$P(^RMPR(667,RO,0),U,8) D DD^%DT W ?64,Y S RMPRFLG=1
"RTN","RMPRPRT1",33,0)
 I '$D(RMPRFLG) W !,"Automobile(s): NONE LISTED"
"RTN","RMPRPRT1",34,0)
 W !,"Items Returned: "
"RTN","RMPRPRT1",35,0)
 I $D(^RMPR(665,RMPRDFN,7,0)) D OLD^RMPRPAT1
"RTN","RMPRPRT1",36,0)
 I $D(^RMPR(660.1,"C",RMPRDFN)) S RO=0 F  S RO=$O(^RMPR(660.1,"C",RMPRDFN,RO)) Q:RO'>0  D WRIL^RMPRPAT1
"RTN","RMPRPRT1",37,0)
 I '$D(^RMPR(660.1,"C",RMPRDFN)) W "NONE LISTED"
"RTN","RMPRPRT1",38,0)
 ;W !!,"Items on loan: " I $D(^RMPR(660.1,"C",RMPRDFN)) S RO=0 F  S RO=$O(^RMPR(660.1,"C",RMPRDFN,RO)) Q:RO=""  D WRIL^RMPRPAT1
"RTN","RMPRPRT1",39,0)
 W !!,"Other Data: " S J=0 F I=1:1 S J=$O(R5(4,J)) Q:J=""!(J?.A)  W !?5,R5(4,J,0) I $Y>(IOSL-6) W @IOF D HDR^RMPRPRT
"RTN","RMPRPRT1",40,0)
 I I=1 W "NONE LISTED"
"RTN","RMPRPRT1",41,0)
 I $Y>(IOSL-6) W @IOF D HDR^RMPRPRT
"RTN","RMPRPRT1",42,0)
 W !,"RECORD OF APPLIANCES/REPAIRS: " D HDRH S RC=0,(RA,AN)=""
"RTN","RMPRPRT1",43,0)
 S RA=""
"RTN","RMPRPRT1",44,0)
 F  S RA=$O(^RMPR(660,"AC",RMPRDFN,RA)) Q:RA'>0  S AN="" F  S AN=$O(^RMPR(660,"AC",RMPRDFN,RA,AN)) Q:AN'>0  S RC=RC+1,Y=^RMPR(660,AN,0) D PRT I $Y>(IOSL-6) W @IOF D HDR^RMPRPRT
"RTN","RMPRPRT1",45,0)
 I RC=0 W !,"No Appliances or Repairs exist for this veteran!",!!
"RTN","RMPRPRT1",46,0)
 E  W !!,"End of Appliance/Repair records for this veteran!",!!," *Historical Item"
"RTN","RMPRPRT1",47,0)
EXIT K I,IT,J,L,RC,K,RA,AN,DATE,TYPE,QTY,VEN,TRANS,TRANS1,STA,SN,DEL,CST,FRM,REM,R0,RMPRE,RMPRFLG,RO,Y G EXIT^RMPRPRT
"RTN","RMPRPRT1",48,0)
HDRH W !!?4,"DATE",?13,"QTY",?17," HCPCS DESC",?29,"N R ",?33,"VENDOR",?45,"STA",?50,"SERIAL NBR",?62,"DELIVERED",?72,"COST",!
"RTN","RMPRPRT1",49,0)
 F L=1:1:79 W "-"
"RTN","RMPRPRT1",50,0)
 Q
"RTN","RMPRPRT1",51,0)
PRT S DATE=$P(Y,U,3),TYPE=$P(Y,U,6),QTY=$P(Y,U,7),VEN=$P(Y,U,9),TRANS=$P(Y,U,4),STA=$P(Y,U,10),SN=$P(Y,U,11),DEL=$P(Y,U,12),AMIS=$P(Y,U,15)
"RTN","RMPRPRT1",52,0)
 ;include 2529-3 data
"RTN","RMPRPRT1",53,0)
 S CST=$S($P(Y,U,16)'="":$P(Y,U,16),$D(^RMPR(660,AN,"LB")):$P(^RMPR(660,AN,"LB"),U,9),1:"")
"RTN","RMPRPRT1",54,0)
 ;vendor 2529-3
"RTN","RMPRPRT1",55,0)
 I $D(^RMPR(660,AN,"LB")) S RMPRLPRO=$P(^("LB"),U,3) D
"RTN","RMPRPRT1",56,0)
 .I RMPRLPRO="O" S RMPRLPRO="ORTHOTIC" Q
"RTN","RMPRPRT1",57,0)
 .I RMPRLPRO="R" S RMPRLPRO="RESTROATION" Q
"RTN","RMPRPRT1",58,0)
 .I RMPRLPRO="S" S RMPRLPRO="SHOE" Q
"RTN","RMPRPRT1",59,0)
 .I RMPRLPRO="W" S RMPRLPRO="WHEELCHAIR" Q
"RTN","RMPRPRT1",60,0)
 .I RMPRLPRO="N" S RMPRLPRO="FOOT CENTER" Q
"RTN","RMPRPRT1",61,0)
 .I RMPRLPRO="D" S RMPRLPRO="DDC" Q
"RTN","RMPRPRT1",62,0)
 S FRM=$P(Y,U,13),REM=$P(Y,U,18),DATE=$E(DATE,4,5)_"/"_$E(DATE,6,7)_"/"_$E(DATE,2,3)
"RTN","RMPRPRT1",63,0)
 ;S TYPE=$S(TYPE="":"",$D(^RMPR(661,TYPE,0)):$P(^(0),U,1),1:"")
"RTN","RMPRPRT1",64,0)
 S TYPE=$P($G(^RMPR(660,AN,1)),U,4)
"RTN","RMPRPRT1",65,0)
 S VEN=$S(VEN="":"",$D(^PRC(440,VEN,0)):$P(^(0),U,1),1:"")
"RTN","RMPRPRT1",66,0)
 S TRANS=$S(TRANS]"":TRANS,1:""),TRANS1="" S:TRANS="X" TRANS1=TRANS,TRANS=""
"RTN","RMPRPRT1",67,0)
 S DEL=$E(DEL,4,5)_"/"_$E(DEL,6,7)_"/"_$E(DEL,2,3) S:DEL="//" DEL=""
"RTN","RMPRPRT1",68,0)
 W !,RC,". ",DATE,?13,QTY,?17
"RTN","RMPRPRT1",69,0)
 W AMIS_$S(TYPE'="":$E($P($G(^RMPR(661.1,TYPE,0)),U,2),1,10),$P(Y,U,26)="D":"DELIVERY",$P(Y,U,26)="P":"PICKUP",$P(Y,U,17):"SHIPPING",1:"")
"RTN","RMPRPRT1",70,0)
 ;AMIS_$S(TYPE'="":$E($P(^PRC(441,TYPE,0),U,2),1,10),$P(Y,U,26)="D":"DELIVERY",$P(Y,U,26)="P":"PICKUP",$P(Y,U,17):"SHIPPING",1:"")
"RTN","RMPRPRT1",71,0)
 ;I TYPE=""&($D(^RMPR(660,$P(IT(RK),U,1),"HST"))) W $E($P(^("HST"),U,1),1,10)
"RTN","RMPRPRT1",72,0)
 W ?29,TRANS,?31,TRANS1
"RTN","RMPRPRT1",73,0)
 ;display source of procurement 2529-3 under vendor header
"RTN","RMPRPRT1",74,0)
 I $D(RMPRLPRO) W ?33,RMPRLPRO
"RTN","RMPRPRT1",75,0)
 K RMPRLPRO
"RTN","RMPRPRT1",76,0)
 I VEN'="" W ?33,$E(VEN,1,10)
"RTN","RMPRPRT1",77,0)
 W ?45,$P(^DIC(4,STA,99),U,1),?50,$E(SN,1,10),?62,DEL,?72,$J($S(CST'="":CST,$P(Y,U,17):$P(Y,U,17),1:""),0,2)
"RTN","RMPRPRT1",78,0)
 W:REM]"" !,?5,"REMARKS: ",REM I $Y+6>IOSL D HDR^RMPRPRT,HDRH
"RTN","RMPRPRT1",79,0)
 S (DATE,TYPE,QTY,VEN,TRANS,TRANS1,STA,SN,DEL,CST,FRM,REM)=""
"RTN","RMPRPRT1",80,0)
 Q
"RTN","RMPRU99")
0^8^B371206
"RTN","RMPRU99",1,0)
RMPRU99 ;HINCIO/HNC - HISTORICAL ITEM TRIGGER; 9/28/04 12:27pm
"RTN","RMPRU99",2,0)
 ;;3.0;PROSTHETICS;**99**,FEB 09,1996
"RTN","RMPRU99",3,0)
EN ;
"RTN","RMPRU99",4,0)
 ;X=ien 661, DA=ien 660
"RTN","RMPRU99",5,0)
 N RMPRITE,RMPR441
"RTN","RMPRU99",6,0)
 S RMPR441=$P($G(^RMPR(661,X,0)),U,1)
"RTN","RMPRU99",7,0)
 I RMPR441="" S X="" Q
"RTN","RMPRU99",8,0)
 S RMPRITE=$P($G(^PRC(441,RMPR441,0)),U,2)
"RTN","RMPRU99",9,0)
 S X=RMPRITE
"RTN","RMPRU99",10,0)
 Q
"RTN","RMPRU99",11,0)
DEL ;
"RTN","RMPRU99",12,0)
 Q
"RTN","RMPRU99",13,0)
XREF ;
"RTN","RMPRU99",14,0)
 W !!,"Setting Cross Reference..."
"RTN","RMPRU99",15,0)
 S DIK="^RMPR(660,",DIK(1)="4" D ENALL^DIK
"RTN","RMPRU99",16,0)
 ;END
"VER")
8.0^22.0
"^DD",660,660,4,0)
ITEM^RP661'O^RMPR(661,^0;6^Q
"^DD",660,660,4,1,0)
^.1
"^DD",660,660,4,1,1,0)
660^AD
"^DD",660,660,4,1,1,1)
S ^RMPR(660,"AD",$E(X,1,30),DA)=""
"^DD",660,660,4,1,1,2)
K ^RMPR(660,"AD",$E(X,1,30),DA)
"^DD",660,660,4,1,1,"%D",0)
^^1^1^2930306^
"^DD",660,660,4,1,1,"%D",1,0)
Allows lookups for an item by Ifcap Item Master number.
"^DD",660,660,4,1,2,0)
^^TRIGGER^660^89
"^DD",660,660,4,1,2,1)
K DIV S DIV=X,D0=DA,DIV(0)=D0 S Y(1)=$S($D(^RMPR(660,D0,"HST")):^("HST"),1:"") S X=$P(Y(1),U,1),X=X S DIU=X K Y S X=DIV D EN^RMPRU99 S DIH=$G(^RMPR(660,DIV(0),"HST")),DIV=X S $P(^("HST"),U,1)=DIV,DIH=660,DIG=89 D ^DICR
"^DD",660,660,4,1,2,2)
K DIV S DIV=X,D0=DA,DIV(0)=D0 S Y(1)=$S($D(^RMPR(660,D0,"HST")):^("HST"),1:"") S X=$P(Y(1),U,1),X=X S DIU=X K Y S X=DIV D DEL^RMPRU99 S DIH=$G(^RMPR(660,DIV(0),"HST")),DIV=X S $P(^("HST"),U,1)=DIV,DIH=660,DIG=89 D ^DICR
"^DD",660,660,4,1,2,"%D",0)
^^3^3^3041018^
"^DD",660,660,4,1,2,"%D",1,0)
This trigger will save the IFCAP Item Master Short Description to allow
"^DD",660,660,4,1,2,"%D",2,0)
the NIF project to implement IFCAP patch 75 to overwrite the Short Descripton
"^DD",660,660,4,1,2,"%D",3,0)
with the new NIF Item Description.
"^DD",660,660,4,1,2,"CREATE VALUE")
D EN^RMPRU99
"^DD",660,660,4,1,2,"DELETE VALUE")
D DEL^RMPRU99
"^DD",660,660,4,1,2,"DT")
3040922
"^DD",660,660,4,1,2,"FIELD")
HISTORICAL ITEM
"^DD",660,660,4,2)
S Y(0)=Y X ^DD(660,4,2,9.2) S D0=$P(Y(101),U,1) S:'$D(^PRC(441,+D0,0)) D0=-1 S Y(201)=$S($D(^PRC(441,D0,0)):^(0),1:"") S X=$P(Y(201),U,2) S D0=I(0,0) S Y=X
"^DD",660,660,4,2,9.2)
S I(0,0)=$S($D(D0):D0,1:""),D0=Y(0) S:'$D(^RMPR(661,+D0,0)) D0=-1 S I(100,0)=$S($D(D0):D0,1:""),Y(101)=$S($D(^RMPR(661,D0,0)):^(0),1:"")
"^DD",660,660,4,2.1)
ITEM:.01:SHORT DESCRIPTION
"^DD",660,660,4,3)
Please enter the Item from the PROS ITEM MASTER file.
"^DD",660,660,4,21,0)
^^3^3^2950417^^^^
"^DD",660,660,4,21,1,0)
This field is a pointer to the master item list of possible appliances.
"^DD",660,660,4,21,2,0)
The master list is set up so that appliances fall into groups which are
"^DD",660,660,4,21,3,0)
the types of appliances.
"^DD",660,660,4,"DT")
3040922
**END**
**END**
