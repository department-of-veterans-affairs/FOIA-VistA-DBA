Released MC*2.3*31 SEQ #32
Extracted from mail message
**KIDS**:MC*2.3*31^

**INSTALL NAME**
MC*2.3*31
"BLD",2964,0)
MC*2.3*31^MEDICINE^0^3021125^y
"BLD",2964,1,0)
^^2^2^3021107^^^
"BLD",2964,1,1,0)
Please refer to the National Patch Module for the detail of this patch 
"BLD",2964,1,2,0)
build.
"BLD",2964,4,0)
^9.64PA^^0
"BLD",2964,"ABNS",0)
^9.66A^^
"BLD",2964,"ABPKG")
n^n
"BLD",2964,"INID")
^
"BLD",2964,"INIT")

"BLD",2964,"KRN",0)
^9.67PA^19^18
"BLD",2964,"KRN",.4,0)
.4
"BLD",2964,"KRN",.4,"NM",0)
^9.68A^1^1
"BLD",2964,"KRN",.4,"NM",1,0)
MCNONENDOPARAC    FILE #699^699^0
"BLD",2964,"KRN",.4,"NM","B","MCNONENDOPARAC    FILE #699",1)

"BLD",2964,"KRN",.401,0)
.401
"BLD",2964,"KRN",.401,"NM",0)
^9.68A^^
"BLD",2964,"KRN",.402,0)
.402
"BLD",2964,"KRN",.402,"NM",0)
^9.68A^^
"BLD",2964,"KRN",.403,0)
.403
"BLD",2964,"KRN",.403,"NM",0)
^9.68A^^
"BLD",2964,"KRN",.5,0)
.5
"BLD",2964,"KRN",.5,"NM",0)
^9.68A^^
"BLD",2964,"KRN",.84,0)
.84
"BLD",2964,"KRN",.84,"NM",0)
^9.68A^^
"BLD",2964,"KRN",3.6,0)
3.6
"BLD",2964,"KRN",3.6,"NM",0)
^9.68A^^0
"BLD",2964,"KRN",3.8,0)
3.8
"BLD",2964,"KRN",3.8,"NM",0)
^9.68A^^
"BLD",2964,"KRN",9.2,0)
9.2
"BLD",2964,"KRN",9.2,"NM",0)
^9.68A^^
"BLD",2964,"KRN",9.8,0)
9.8
"BLD",2964,"KRN",9.8,"NM",0)
^9.68A^9^9
"BLD",2964,"KRN",9.8,"NM",1,0)
MCARAM5^^0^B13100707
"BLD",2964,"KRN",9.8,"NM",2,0)
MCAREO^^0^B246054
"BLD",2964,"KRN",9.8,"NM",3,0)
MCARGEO^^0^B255921
"BLD",2964,"KRN",9.8,"NM",4,0)
MCARPACE^^0^B10748436
"BLD",2964,"KRN",9.8,"NM",5,0)
MCARPCE^^0^B9279131
"BLD",2964,"KRN",9.8,"NM",6,0)
MCEO^^0^B1076781
"BLD",2964,"KRN",9.8,"NM",7,0)
MCPFTE^^0^B7583785
"BLD",2964,"KRN",9.8,"NM",8,0)
MCPFTI^^0^B9100897
"BLD",2964,"KRN",9.8,"NM",9,0)
MCRH1^^0^B25789056
"BLD",2964,"KRN",9.8,"NM","B","MCARAM5",1)

"BLD",2964,"KRN",9.8,"NM","B","MCAREO",2)

"BLD",2964,"KRN",9.8,"NM","B","MCARGEO",3)

"BLD",2964,"KRN",9.8,"NM","B","MCARPACE",4)

"BLD",2964,"KRN",9.8,"NM","B","MCARPCE",5)

"BLD",2964,"KRN",9.8,"NM","B","MCEO",6)

"BLD",2964,"KRN",9.8,"NM","B","MCPFTE",7)

"BLD",2964,"KRN",9.8,"NM","B","MCPFTI",8)

"BLD",2964,"KRN",9.8,"NM","B","MCRH1",9)

"BLD",2964,"KRN",19,0)
19
"BLD",2964,"KRN",19,"NM",0)
^9.68A^^
"BLD",2964,"KRN",19.1,0)
19.1
"BLD",2964,"KRN",19.1,"NM",0)
^9.68A^^
"BLD",2964,"KRN",101,0)
101
"BLD",2964,"KRN",101,"NM",0)
^9.68A^^0
"BLD",2964,"KRN",409.61,0)
409.61
"BLD",2964,"KRN",409.61,"NM",0)
^9.68A^^
"BLD",2964,"KRN",771,0)
771
"BLD",2964,"KRN",771,"NM",0)
^9.68A^^0
"BLD",2964,"KRN",869.2,0)
869.2
"BLD",2964,"KRN",869.2,"NM",0)
^9.68A^^0
"BLD",2964,"KRN",870,0)
870
"BLD",2964,"KRN",870,"NM",0)
^9.68A^^0
"BLD",2964,"KRN",8994,0)
8994
"BLD",2964,"KRN",8994,"NM",0)
^9.68A^^
"BLD",2964,"KRN","B",.4,.4)

"BLD",2964,"KRN","B",.401,.401)

"BLD",2964,"KRN","B",.402,.402)

"BLD",2964,"KRN","B",.403,.403)

"BLD",2964,"KRN","B",.5,.5)

"BLD",2964,"KRN","B",.84,.84)

"BLD",2964,"KRN","B",3.6,3.6)

"BLD",2964,"KRN","B",3.8,3.8)

"BLD",2964,"KRN","B",9.2,9.2)

"BLD",2964,"KRN","B",9.8,9.8)

"BLD",2964,"KRN","B",19,19)

"BLD",2964,"KRN","B",19.1,19.1)

"BLD",2964,"KRN","B",101,101)

"BLD",2964,"KRN","B",409.61,409.61)

"BLD",2964,"KRN","B",771,771)

"BLD",2964,"KRN","B",869.2,869.2)

"BLD",2964,"KRN","B",870,870)

"BLD",2964,"KRN","B",8994,8994)

"BLD",2964,"QUES",0)
^9.62^^
"BLD",2964,"REQB",0)
^9.611^1^1
"BLD",2964,"REQB",1,0)
MC*2.3*33^2
"BLD",2964,"REQB","B","MC*2.3*33",1)

"KRN",.4,2171,-1)
0^1
"KRN",.4,2171,0)
MCNONENDOPARAC^3020726.0935^^699^^^3020726
"KRN",.4,2171,"DXS",1,1)
ELECTIVE
"KRN",.4,2171,"DXS",1,2)
URGENT
"KRN",.4,2171,"DXS",1,3)
EMERGENCY
"KRN",.4,2171,"DXS",2,"IM")
INTRAMUSCULAR
"KRN",.4,2171,"DXS",2,"IV")
INTRAVENOUS
"KRN",.4,2171,"DXS",2,"O")
ORAL
"KRN",.4,2171,"DXS",2,"PV")
PARAVARICEAL
"KRN",.4,2171,"DXS",2,"SM")
SUBMUCOSAL
"KRN",.4,2171,"DXS",2,"SQ")
SUBCUTANEOUS
"KRN",.4,2171,"DXS",2,"T")
TOPICAL
"KRN",.4,2171,"DXS",2,"V")
INTRAVARICEAL
"KRN",.4,2171,"DXS",3,1)
WASH
"KRN",.4,2171,"DXS",3,2)
IMMERSION
"KRN",.4,2171,"DXS",3,3)
GAS
"KRN",.4,2171,"DXS",3,4)
UNKNOWN
"KRN",.4,2171,"DXS",3,5)
OTHER
"KRN",.4,2171,"DXS",4,"A")
ABNORMAL
"KRN",.4,2171,"DXS",4,"I")
INCOMPLETE EXAMINATION
"KRN",.4,2171,"DXS",4,"N")
NORMAL
"KRN",.4,2171,"DXS",5,1)
REQUIRED NO THERAPY
"KRN",.4,2171,"DXS",5,2)
REQUIRED TRANSFUSION
"KRN",.4,2171,"DXS",5,3)
REQUIRED MEDICAL THERAPY
"KRN",.4,2171,"DXS",5,4)
REQUIRED ENDOSCOPIC THERAPY
"KRN",.4,2171,"DXS",5,5)
REQUIRED SURGICAL THERAPY
"KRN",.4,2171,"DXS",5,6)
RESULTED IN DEATH
"KRN",.4,2171,"F",1)
"PRIMARY PROVIDER: ";C5~701;X~"FELLOW: ";C5~200;X~"2ND FELLOW: ";C40~201;X~"PERFORMED AT: ";C5~8;X~"PERFORMED BY: ";C40~6;X~"WARD/CLINIC: ";C5~9;X~
"KRN",.4,2171,"F",2)
"PROCEDURE: ";C5;S~-697.2,^MCAR(697.2,^^S I(0,0)=D0 S DIP(1)=$S($D(^MCAR(699,D0,0)):^(0),1:"") S X=$P(DIP(1),U,12),X=X S D(0)=+X;Z;"1:"~-697.2,7;X~
"KRN",.4,2171,"F",3)
"PROCEDURE SUMMARY: ";C5~600;X~"PROCEDURE START TIME: ";C5;S~10;X~"PROCEDURE STOP TIME: ";C40~11;X~"URGENCY: ";C5;S~12;X~"PROTOCOL: ";C5;S~2.8;X~
"KRN",.4,2171,"F",4)
"EGD SIMPLE PRI. EXAM: ";C5;S~2.85;X~"LAB OR XRAY: ";C5;S~2.86;X~"OCCULT BLOOD: ";C5;S~2.87;X~"SPECIMEN COLLECTION: ";C5;S~2.88;X~
"KRN",.4,2171,"F",5)
"PRESCRIPTION GIVEN: ";C5;S~40," ";C10~40,.01;X~40,"DOSAGE: ";C50~40,1;X~"INSTRUCTION: ";C5;S~203,.01~"INSTRUMENT: ";C5;S~4,.01;X~"MEDICATIONS: ";C5;S~
"KRN",.4,2171,"F",6)
5," ";C10~5,.01;X~5,"DOSE ROUTE: ";C30~5,1;X~5,"TOTAL DOSE: ";C60~5,2;X~"POST-PROCEDURE INST. CLEANING: ";C5;S~29;X~"SIGNS AND SYMPTOMS: ";C5;S~
"KRN",.4,2171,"F",7)
2.2,.01;C26;X~"SUMMARY: ";C5;S~202;X~"RESULTS: ";C5;S~28,.01;C15;X~"FOLLOWUP DEVICE/THERAPY: ";C5;S~2.6,.01;C31;X~"SURVEILLANCE: ";C5;S~2.7,.01;C21;X~
"KRN",.4,2171,"F",8)
"INDICATION COMMENTS: ";C5;S~3;X~"INDICATED THERAPY: ";C5;S~2.1,.01;C25;X~"DISEASE FOLLOWUP: ";C5;S~2.5,.01;C24;X~"COMPLICATION: ";C5;S~30," ";C10~
"KRN",.4,2171,"F",9)
30,.01;X~30,"COMP. RESULTS: ";C50~30,1;X~"DIAGNOSIS: ";C5;S~37.1,.01~S MCFILE=699 D DISP^MCMAG;Z;"S MCFILE=699 D DISP^MCMAG"~K MCFILE;Z;"K MCFILE"~
"KRN",.4,2171,"H")
@
"KRN",.4,2171,"IOM")
75
"KRN",.4,2171,"LAST")
1
"KRN",.4,2171,"ROU")
^MCPARC
"KRN",.4,2171,"ROUOLD")
MCPARC
"KRN",.4,2171,"SUB")
1
"MBREQ")
0
"ORD",5,.4)
.4;5;;;EDEOUT^DIFROMSO(.4,DA,"",XPDA);FPRE^DIFROMSI(.4,"",XPDA);EPRE^DIFROMSI(.4,DA,$E("N",$G(XPDNEW)),XPDA,"",OLDA);;EPOST^DIFROMSI(.4,DA,"",XPDA);DEL^DIFROMSK(.4,"",%)
"ORD",5,.4,0)
PRINT TEMPLATE
"PKG",31,-1)
1^1
"PKG",31,0)
MEDICINE^MC^MEDICINE PACKAGE INCLUDES ALL AREAS OF MEDICINE
"PKG",31,20,0)
^9.402P^^
"PKG",31,22,0)
^9.49I^1^1
"PKG",31,22,1,0)
2.3^2960913^2980615^4558
"PKG",31,22,1,"PAH",1,0)
31^3021125
"PKG",31,22,1,"PAH",1,1,0)
^^2^2^3021125
"PKG",31,22,1,"PAH",1,1,1,0)
Please refer to the National Patch Module for the detail of this patch 
"PKG",31,22,1,"PAH",1,1,2,0)
build.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
9
"RTN","MCARAM5")
0^1^B13100707
"RTN","MCARAM5",1,0)
MCARAM5 ;WASH ISC/JKL-MUSE TRANSFER LOCAL DATA INTO DHCP ;4/24/96  09:24
"RTN","MCARAM5",2,0)
 ;;2.3;Medicine;**31**;09/13/1996
"RTN","MCARAM5",3,0)
 ;
"RTN","MCARAM5",4,0)
 ;
"RTN","MCARAM5",5,0)
EKG(MCA,MCE) ;Transfer local array data into new EKG record in DHCP
"RTN","MCARAM5",6,0)
 ; USAGE: S X=$$EKG^MCARAM5(.A,.B)
"RTN","MCARAM5",7,0)
 ; WHERE: A=array of local data 
"RTN","MCARAM5",8,0)
 ;        B=array of DHCP data
"RTN","MCARAM5",9,0)
 ;          including internal record number of EKG file
"RTN","MCARAM5",10,0)
 ; if successful, returns function value of 0
"RTN","MCARAM5",11,0)
 ; if unsuccessful, returns error message
"RTN","MCARAM5",12,0)
 ; check for valid SSN
"RTN","MCARAM5",13,0)
 N MCI,%,MCERR,Y,DIC,X,MCP
"RTN","MCARAM5",14,0)
 S MCERR=$$LSSN^MCARAM6(MCA("DT"),MCA(.02),.MCP)
"RTN","MCARAM5",15,0)
 I +MCERR'=55 S MCERR=$$NMCHK^MCARAM5(.MCA,.MCP) I +MCERR>50 Q MCERR
"RTN","MCARAM5",16,0)
 I +MCERR=55 S MCERR=$$LNAME^MCARAM6(MCA("DT"),MCA("NAME"),.MCP) Q:+MCERR>50 "55-Social Security Number not in Patient file"  S MCERR=$$SSNCHK^MCARAM5(.MCA,.MCP) I +MCERR>50 Q MCERR
"RTN","MCARAM5",17,0)
 ; if PID not a medical patient, add PID to medical patient file
"RTN","MCARAM5",18,0)
 I '$D(^MCAR(690,MCP(1))) S ^MCAR(690,MCP(1),0)=MCP(1),^MCAR(690,"B",MCP(1),MCP(1))="",$P(^MCAR(690,0),U,4)=$P(^MCAR(690,0),U,4)+1 S:$P(^MCAR(690,0),U,3)<MCP(1) $P(^MCAR(690,0),U,3)=MCP(1)
"RTN","MCARAM5",19,0)
 ; set confirmation status, field 11,of record
"RTN","MCARAM5",20,0)
 S MCA(11)="C"
"RTN","MCARAM5",21,0)
 S MCI=.02,MCA(1)=MCP(1),DIC("DR")=".02///"_MCA(.02) F  S MCI=$O(MCA(MCI)) Q:MCI=""!(MCI?1A.A)  S DIC("DR")=DIC("DR")_";"_MCI_"///"_MCA(MCI)
"RTN","MCARAM5",22,0)
 ; EKG Data dictionary identified by PID of 690, PID of 690 .01 is file 2
"RTN","MCARAM5",23,0)
 S DIC("DR")=$P(DIC("DR"),"1///")_"1////"_$P(DIC("DR"),"1///",2,99)
"RTN","MCARAM5",24,0)
 K DD,DO N DLAYGO S DLAYGO=691.5,DIC="^MCAR(691.5,",DIC(0)="LXZ",X=MCA("DT")
"RTN","MCARAM5",25,0)
 D FILE^DICN
"RTN","MCARAM5",26,0)
 I +Y'>0 Q $$LOG^MCARAM7("58-ECG record not filed")
"RTN","MCARAM5",27,0)
 ; set automated instrument data, field 21,of record
"RTN","MCARAM5",28,0)
 S MCE("EKG")=+Y
"RTN","MCARAM5",29,0)
 D NOW^%DTC S ^MCAR(691.5,MCE("EKG"),"A")=%
"RTN","MCARAM5",30,0)
 Q 0
"RTN","MCARAM5",31,0)
 ;
"RTN","MCARAM5",32,0)
EKGDG(MCA,MCE) ; Transfer local array diagnosis data into EKG record
"RTN","MCARAM5",33,0)
 ; USAGE: S X=$$EKGDG^MCARAM5(.A,.B)
"RTN","MCARAM5",34,0)
 ; WHERE: A=array of diagnosis data
"RTN","MCARAM5",35,0)
 ;        B=array of DHCP data
"RTN","MCARAM5",36,0)
 ;          including internal record number of EKG file
"RTN","MCARAM5",37,0)
 ; if successful, returns function value of 0
"RTN","MCARAM5",38,0)
 ; if unsuccessful, returns error message
"RTN","MCARAM5",39,0)
 N MCI,MCJ
"RTN","MCARAM5",40,0)
 I '$D(^MCAR(691.5,MCE("EKG"))) Q $$LOG^MCARAM7("59-ECG record undefined-Diagnosis not filed")
"RTN","MCARAM5",41,0)
 S MCERR=$$DGCK^MCARAM4(.MCA) I +MCERR>50 Q $$LOG^MCARAM7(MCERR)
"RTN","MCARAM5",42,0)
 S MCI="DX,0"
"RTN","MCARAM5",43,0)
 F MCJ=1:1:MCA(MCI) S MCI=$O(MCA(MCI)),^MCAR(691.5,MCE("EKG"),9,MCJ,0)=MCA(MCI)
"RTN","MCARAM5",44,0)
 S ^MCAR(691.5,MCE("EKG"),9,0)=U_U_MCJ_U_MCJ
"RTN","MCARAM5",45,0)
 Q 0
"RTN","MCARAM5",46,0)
 ;
"RTN","MCARAM5",47,0)
EKGRX(MCA,MCE) ; Transfer local array medication data into EKG record
"RTN","MCARAM5",48,0)
 ; USAGE: S X=$$EKGDG^MCARAM5(.A,.B)
"RTN","MCARAM5",49,0)
 ; WHERE: A=array of medication data
"RTN","MCARAM5",50,0)
 ;        B=array of DHCP data
"RTN","MCARAM5",51,0)
 ;          including internal record number of EKG file
"RTN","MCARAM5",52,0)
 ; if successful, returns function value of 0
"RTN","MCARAM5",53,0)
 ; if unsuccessful, returns error message
"RTN","MCARAM5",54,0)
 N MCI
"RTN","MCARAM5",55,0)
 I '$D(^MCAR(691.5,MCE("EKG"))) Q $$LOG^MCARAM7("60-ECG record undefined-Medication not filed")
"RTN","MCARAM5",56,0)
 S ^MCAR(691.5,MCE("EKG"),2,0)="^691.53PA"
"RTN","MCARAM5",57,0)
 S MCERR=$$RXCK^MCARAM4(.MCA) I +MCERR>0 Q $$LOG^MCARAM7(MCERR)
"RTN","MCARAM5",58,0)
 S DIE="^MCAR(691.5,"_MCE("EKG")_",2,",DA(1)=MCE("EKG")
"RTN","MCARAM5",59,0)
 F MCI=1:1:MCA("RX,0") S DA=MCI,DR=".01///^S X=$P(MCA(""RX,""_MCI),U);1///^S X=$P(MCA(""RX,""_MCI),U,2);2///^S X=$P(MCA(""RX,""_MCI),U,3)" D ^DIE
"RTN","MCARAM5",60,0)
 S ^MCAR(691.5,MCE("EKG"),2,0)="^691.53PA^"_MCI_U_MCI
"RTN","MCARAM5",61,0)
 Q 0
"RTN","MCARAM5",62,0)
 ;
"RTN","MCARAM5",63,0)
EKGOR(MCA,MCE) ;Transfer order entry data into EKG record
"RTN","MCARAM5",64,0)
 ; USAGE: S X=$$EKGOR^MCARAM5(.A,.B)
"RTN","MCARAM5",65,0)
 ; WHERE: A=array of local data
"RTN","MCARAM5",66,0)
 ;          including print name for ECG procedure/subspecialty
"RTN","MCARAM5",67,0)
 ;        B=array of DHCP data 
"RTN","MCARAM5",68,0)
 ;          including internal record number of EKG file
"RTN","MCARAM5",69,0)
 ; if successful, returns function value of 0
"RTN","MCARAM5",70,0)
 ; if unsuccessful, returns error message
"RTN","MCARAM5",71,0)
 Q 0
"RTN","MCARAM5",72,0)
NMCHK(MCA,MCP) ;Check name input against patient data
"RTN","MCARAM5",73,0)
 ; Marquette allows 16 chars for last name and 10 chars for first etc.
"RTN","MCARAM5",74,0)
 ; USAGE: S X=$$NMCHK^MCARAM5(.MCA,.MCP)
"RTN","MCARAM5",75,0)
 ; WHERE: MCA=array of local data
"RTN","MCARAM5",76,0)
 ;        MCP=array of DHCP patient data
"RTN","MCARAM5",77,0)
 ; if successful, returns function value of 0
"RTN","MCARAM5",78,0)
 ; if unsuccessful, returns error message
"RTN","MCARAM5",79,0)
 N MCI,MCERR S MCERR=0
"RTN","MCARAM5",80,0)
 S MCP("LNAME")=$P(MCP("NAME"),","),MCA("LNAME")=$P(MCA("NAME"),",")
"RTN","MCARAM5",81,0)
 F MCI=1:1:$L(MCP("LNAME")) Q:$L(MCP("LNAME"))>16  I $E(MCA("LNAME"),MCI,MCI)'=$E(MCP("LNAME"),MCI,MCI) S MCERR="56-Name does not match Patient file" Q
"RTN","MCARAM5",82,0)
 Q MCERR
"RTN","MCARAM5",83,0)
 ;
"RTN","MCARAM5",84,0)
SSNCHK(MCA,MCP) ;Check SSN input
"RTN","MCARAM5",85,0)
 ; USAGE: S X=$$SSNCHK^MCARAM5(.MCA,.MCP)
"RTN","MCARAM5",86,0)
 ; WHERE: MCA=array of local data
"RTN","MCARAM5",87,0)
 ;        MCP=array of DHCP patient data
"RTN","MCARAM5",88,0)
 ; if successful, returns function value of 0
"RTN","MCARAM5",89,0)
 ; if unsuccessful, returns error message
"RTN","MCARAM5",90,0)
 N MCI,MCERR S MCERR=0
"RTN","MCARAM5",91,0)
 S MCP("SSN")=$P(^DPT(MCP(1),0),"^",9)
"RTN","MCARAM5",92,0)
 I $E(MCA(.02),1,8)'=$E(MCP("SSN"),1,8) S MCERR="55-Social Security Number not in Patient file"
"RTN","MCARAM5",93,0)
 Q MCERR
"RTN","MCAREO")
0^2^B246054
"RTN","MCAREO",1,0)
MCAREO ;WISC/MLH-ENTER/EDIT CARDIAC PROCEDURES-ORDER ENTRY HOOKS ;8/3/92  08:59
"RTN","MCAREO",2,0)
 ;;2.3;Medicine;**31**;09/13/1996
"RTN","MCAREO",3,0)
 ;
"RTN","MCAREO",4,0)
ORDER ;INITIALIZE ORDER ENTRY
"RTN","MCAREO",5,0)
 D:'$D(MCOEON) ORDER^MCPARAM Q:'$D(MCOEON)
"RTN","MCAREO",6,0)
 Q
"RTN","MCAREO",7,0)
 ;
"RTN","MCAREO",8,0)
ORDER1 ;COMPLETE ORDER ENTRY
"RTN","MCAREO",9,0)
 G IM:'$D(MCOEON) Q:'$D(^MCAR(MCFILE,MCARGDA))  Q:$D(DTOUT)
"RTN","MCAREO",10,0)
IM D EN1^MCMAG Q
"RTN","MCARGEO")
0^3^B255921
"RTN","MCARGEO",1,0)
MCARGEO ;WISC/MLH-GI ENTER/EDIT-ORDER ENTRY/IMAGING HOOKS ;5/2/96  12:44
"RTN","MCARGEO",2,0)
 ;;2.3;Medicine;**31**;09/13/1996
"RTN","MCARGEO",3,0)
ORDER D:'$D(MCOEON) ORDER^MCPARAM Q:'$D(MCOEON)
"RTN","MCARGEO",4,0)
 Q
"RTN","MCARGEO",5,0)
ORDER1 G IM:'$D(MCOEON) Q:'$D(^MCAR(MCFILE,MCARGDA))  Q:$D(DTOUT)
"RTN","MCARGEO",6,0)
IM D EN1^MCMAG Q
"RTN","MCARPACE")
0^4^B10748436
"RTN","MCARPACE",1,0)
MCARPACE ;WISC/RMP,TJK-COMBINED GENERATOR,LEAD ENTER/EDIT ;5/2/96  13:02
"RTN","MCARPACE",2,0)
 ;;2.3;Medicine;**16,31**;09/13/1996
"RTN","MCARPACE",3,0)
 W @IOF,!!!,"COMBINED IMPLANT/LEADS PROCEDURES",!!!
"RTN","MCARPACE",4,0)
 S DIC="^MCAR(698,",DIC(0)="AELQM",(DLAYGO,DIDEL)=698
"RTN","MCARPACE",5,0)
 S DIC("A")="Enter Patient name or Date of Generator Implant: "
"RTN","MCARPACE",6,0)
 S DIC("DR")=".01;1//"_$G(MCPATNM)
"RTN","MCARPACE",7,0)
 D ^DIC G:Y<1 EXIT
"RTN","MCARPACE",8,0)
 S DFN=$P(^MCAR(698,+Y,0),U,2),DFNUM=$P(^MCAR(690,DFN,0),U,1),MCPATNM=$P(^DPT(DFNUM,0),"^",1)
"RTN","MCARPACE",9,0)
 W !,"Generator Information...."
"RTN","MCARPACE",10,0)
 S DIE=DIC,(DA,MCARGDA,MCARGDA1)=+Y,DR="2;4;6;S:$P(^(0),U,6)'=12 Y=7;6.1;7;12;14;19:601",MCFILE=698 S MCARGNUM=$$NUM(MCFILE) D IN^MCEO
"RTN","MCARPACE",11,0)
 G EXIT:$D(DTOUT)!$D(DUOUT) D ^DIE,OUT^MCEO,QTASK^MCPARAM G EXIT:$D(DUOUT),EXIT:$D(DTOUT) K DIC,DIE,DR,DA S MCSEL=$P(^MCAR(698,MCARGDA,0),U,7)
"RTN","MCARPACE",12,0)
 G @($S(MCSEL["A":"ALEAD",MCSEL["V":"VLEAD",1:"EXIT"))
"RTN","MCARPACE",13,0)
ALEAD W !,"Atrial Lead Data...." S (DLAYGO,MCFILE,DIDEL)=698.2 D LAST
"RTN","MCARPACE",14,0)
 S DIC="^MCAR(698.2,",DIC(0)="AELQM",DIC("DR")="1////^S X=DFN",DIC("S")="I $P(^(0),U,2)=DFN",DIC("B")=$P(^MCAR(698,MCARGDA,0),U)
"RTN","MCARPACE",15,0)
 D ^DIC K DIC("B"),DIC("S") G EXIT:$D(DUOUT)!($D(DTOUT)) G:Y<0 @$S(MCSEL["V":"VLEAD",1:"EXIT")
"RTN","MCARPACE",16,0)
 S DIE=DIC,(MCARGDA,DA)=+Y,DR="2;4:601",MCFILE=698.2 S MCARGNUM=$$NUM(MCFILE) D IN^MCEO G EXIT:$D(DTOUT)!$D(DUOUT) D ^DIE,OUT^MCEO,QTASK^MCPARAM K DIC,DIE,DR,DA
"RTN","MCARPACE",17,0)
 G @($S(MCSEL["V":"VLEAD",1:"EXIT"))
"RTN","MCARPACE",18,0)
VLEAD W !,"Ventricular Lead Data..." S (DLAYGO,MCFILE,DIDEL)=698.1 D LAST
"RTN","MCARPACE",19,0)
 S DIC="^MCAR(698.1,",DIC(0)="AEQLM",DIC("DR")="1////^S X=DFN",DIC("S")="I $P(^(0),U,2)=DFN",DIC("B")=$P(^MCAR(698,MCARGDA,0),U)
"RTN","MCARPACE",20,0)
 D ^DIC K DIC("B"),DIC("S") G EXIT:$D(DUOUT)!($D(DTOUT)),EXIT:Y<0
"RTN","MCARPACE",21,0)
 S DIE=DIC,(MCARGDA,DA)=+Y,DR="2;4:601",MCFILE=698.1 S MCARGNUM=$$NUM(MCFILE) D IN^MCEO G EXIT:$D(DTOUT)!$D(DUOUT) D ^DIE,OUT^MCEO,QTASK^MCPARAM K DIC,DIE,DR,DA
"RTN","MCARPACE",22,0)
 G EXIT
"RTN","MCARPACE",23,0)
GEN2 W !,"GENERATOR DATA..."
"RTN","MCARPACE",24,0)
 I $D(MCOEON) K MCORSV
"RTN","MCARPACE",25,0)
 S MCFILE=698,DIE="^MCAR(698,",(DA,MCARGDA)=MCARGDA1,DR="19:601" D ^DIE K DIC,DIE,DR,DA,MCARGDA1 D ORDER1,QTASK^MCPARAM
"RTN","MCARPACE",26,0)
EXIT K MCSEL,DFN,MCARGDA,DLAYGO,DIDEL,DFNUM Q
"RTN","MCARPACE",27,0)
NUM(MCFILE) ;
"RTN","MCARPACE",28,0)
 Q $O(^MCAR(697.2,"C","MCAR("_MCFILE,0))
"RTN","MCARPACE",29,0)
LAST S (Y,I)=0 F  S I=$O(^MCAR(MCFILE,"C",DFN,I)) Q:I=""  S X=+$G(^MCAR(MCFILE,I,0)) I X,X>Y S Y=X
"RTN","MCARPACE",30,0)
 I 'Y W !!,"No ",$S(MCFILE=698.1:"Ventricular",1:"Atrial")," Lead data entered for this patient",!! K I,Y,X Q
"RTN","MCARPACE",31,0)
 X ^DD("DD") W !!,"Last ",$S(MCFILE=698.1:"Ventricular",1:"Atrial")," Lead implanted on ",Y,!! K X,Y,I Q
"RTN","MCARPACE",32,0)
 ;
"RTN","MCARPACE",33,0)
DEM ;    EDIT DEMOGRAPHIC INFORMATION ONLY
"RTN","MCARPACE",34,0)
 W @IOF,!!!,"DEMOGRAPHIC INFORMATION",!!!
"RTN","MCARPACE",35,0)
 ;S (DIC,DIE)="^MCAR(690,",DIC(0)="AEMQZ",DIC("B")=$G(MCPATNM)
"RTN","MCARPACE",36,0)
 S (DIC,DIE)="^MCAR(690,",DIC(0)="AELMQZ",DIC("B")=$G(MCPATNM),DLAYGO=690
"RTN","MCARPACE",37,0)
 D ^DIC
"RTN","MCARPACE",38,0)
 K DIC
"RTN","MCARPACE",39,0)
 IF Y'<0 D
"RTN","MCARPACE",40,0)
 .  S MCPATNM=Y(0,0) ;    new default name
"RTN","MCARPACE",41,0)
 .  S DA=+Y,DR="[MCARPACEDIT]"
"RTN","MCARPACE",42,0)
 .  D ^DIE
"RTN","MCARPACE",43,0)
 .  Q
"RTN","MCARPACE",44,0)
 ;END IF
"RTN","MCARPACE",45,0)
 ;
"RTN","MCARPACE",46,0)
 QUIT
"RTN","MCARPACE",47,0)
 ;
"RTN","MCARPACE",48,0)
ORDER1 ;
"RTN","MCARPACE",49,0)
 Q:'$D(MCOEON)  Q:'$D(^MCAR(MCFILE,MCARGDA))  Q:$D(DTOUT)
"RTN","MCARPACE",50,0)
 Q
"RTN","MCARPCE")
0^5^B9279131
"RTN","MCARPCE",1,0)
MCARPCE ;WISC/TJK-ENTER/EDIT ROUTINE FOR PACEMAKER SURVEILLANCE ;5/2/96  08:54
"RTN","MCARPCE",2,0)
 ;;2.3;Medicine;**31**;09/13/1996
"RTN","MCARPCE",3,0)
START S DIC="^MCAR(698.3,",DIC(0)="AEQLM",(MCFILE,DLAYGO,DIDEL)=698.3,DIC("DR")=".01;1//"_$G(MCPATNM)
"RTN","MCARPCE",4,0)
 S DIC("A")="Enter Patient Name, or Date and Time: "
"RTN","MCARPCE",5,0)
 S DIC("B")=$G(MCPATNM)
"RTN","MCARPCE",6,0)
 W @IOF,"SURVEILLANCE PROCEDURES"
"RTN","MCARPCE",7,0)
 I $G(DJSC) W "       *** SCREEN EDIT ***"
"RTN","MCARPCE",8,0)
 E  I $G(MCBL)=1 W "       *** BRIEF EDIT ***"
"RTN","MCARPCE",9,0)
 W !!!
"RTN","MCARPCE",10,0)
 D ^DIC G EXIT:Y<0 S MCARGDA=+Y S MCARNEW="" S:$P(Y,U,3) MCARNEW=1
"RTN","MCARPCE",11,0)
 S (MCARNAM,DFN)=$P(^MCAR(698.3,+Y,0),U,2)
"RTN","MCARPCE",12,0)
 I 'MCARNAM S MCARNEW=1 D KILL G EXIT
"RTN","MCARPCE",13,0)
 I '$D(^MCAR(698,"C",MCARNAM)) D MSG G EXIT
"RTN","MCARPCE",14,0)
 ;    Get new default patient name
"RTN","MCARPCE",15,0)
 S MCX=$$VALUE^MCENDIQ1(MCFILE,+Y,1)
"RTN","MCARPCE",16,0)
 I MCX'="" S MCPATNM=MCX
"RTN","MCARPCE",17,0)
 ;    Get most recent procedure
"RTN","MCARPCE",18,0)
 F I=0:0 S I=$O(^MCAR(690,"AC",MCARNAM,I)) Q:I=""  Q:$O(^(I,0))="MCAR(698"
"RTN","MCARPCE",19,0)
 I I="" D MSG G EXIT
"RTN","MCARPCE",20,0)
 S MCARGEN=$O(^MCAR(690,"AC",MCARNAM,I,"MCAR(698",0)) I 'MCARGEN D MSG G EXIT
"RTN","MCARPCE",21,0)
 I '$D(^MCAR(698,MCARGEN,0)) D MSG G EXIT
"RTN","MCARPCE",22,0)
 I $D(^MCAR(698,MCARGEN,1)),$P(^(1),U,1) D MSG G EXIT
"RTN","MCARPCE",23,0)
 I $P(^MCAR(698,MCARGEN,0),U,7)="" W !!,*7,"TYPE OF LEAD NOT DEFINED FOR THIS PATIENT IN GENERATOR FILE",!! R "PRESS RETURN TO CONTINUE: ",X:DTIME D KILL G EXIT
"RTN","MCARPCE",24,0)
 S MCARLEAD=$P(^MCAR(698,MCARGEN,0),U,7)
"RTN","MCARPCE",25,0)
 S DIE="^MCAR(698.3,",DR=3,DA=MCARGDA D ^DIE G EXIT:$D(Y),EXIT:$D(DTOUT)
"RTN","MCARPCE",26,0)
 S MCARFLG=$S($P(^MCAR(698.3,DA,0),U,4)["T":1,1:"")
"RTN","MCARPCE",27,0)
 G SCREEN1:$D(DJSC) S DR=$S($G(MCBL)=1:"[MCARPACSURVBRIEF]",1:"[MCARPACSURV]"),DA=MCARGDA,MCFILE=698.3 D ORDERA G EXIT:$D(DUOUT)!$D(DTOUT) D ^DIE,ORDER1,QTASK^MCPARAM
"RTN","MCARPCE",28,0)
EXIT K %,%X,%Y,%Y2,C,D0,DA,DI,DJSC,DQ,DR,DZ,I,J,MCARFLG,MCARGDA,MCARGEN,MCARLEAD,MCARNAM,MCX,X,Y,DLAYGO,DIDEL,MCFILE,MCARNEW D EXIT^MCARGE Q
"RTN","MCARPCE",29,0)
ORDERA S MCARGNUM=$O(^MCAR(697.2,"C","MCAR("_MCFILE,0))
"RTN","MCARPCE",30,0)
ORDER D:'$D(MCOEON) ORDER^MCPARAM Q:'$D(MCOEON)
"RTN","MCARPCE",31,0)
 Q
"RTN","MCARPCE",32,0)
ORDER1 G IM:'$D(MCOEON) Q:'$D(^MCAR(MCFILE,MCARGDA))  Q:$D(DTOUT)
"RTN","MCARPCE",33,0)
IM D EN1^MCMAG Q
"RTN","MCARPCE",34,0)
SCREEN K DJSC
"RTN","MCARPCE",35,0)
 S (DJSC,MCARGNUM)=$O(^MCAR(697.2,"BA","PACEMAKER SURVEILLANCE",0))
"RTN","MCARPCE",36,0)
 G EXIT:DJSC="",START
"RTN","MCARPCE",37,0)
SCREEN1 S DJDN=MCARGDA,DJSC=$S($G(MCBS)=1:"MCPACSURVBR",1:"MCPACSUR"_$S(MCARFLG:"T",1:"C")_MCARLEAD)
"RTN","MCARPCE",38,0)
 D ORDERA G EXIT:$D(DTOUT)!$D(DUOUT) D EN^MCARD,ORDER1,QTASK^MCPARAM
"RTN","MCARPCE",39,0)
 ;get new default patient name
"RTN","MCARPCE",40,0)
 S MCX=$$VALUE^MCENDIQ1(MCFILE,MCARGDA,1)
"RTN","MCARPCE",41,0)
 I MCX'="" S MCPATNM=MCX
"RTN","MCARPCE",42,0)
 G EXIT
"RTN","MCARPCE",43,0)
MSG W !!,"PATIENT HAS NO CURRENT GENERATOR IMPLANT LISTED IN GENERATOR FILE",!! R "PRESS RETURN TO CONTINUE ",X:DTIME D KILL Q
"RTN","MCARPCE",44,0)
KILL I MCARNEW S DIK="^MCAR(698.3,",DA=MCARGDA D ^DIK W !,*7,"Entry Deleted"
"RTN","MCARPCE",45,0)
 Q
"RTN","MCEO")
0^6^B1076781
"RTN","MCEO",1,0)
MCEO ;WISC/MLH-MED PROC EDIT, OE INTERFACE ;4/2/98  15:19
"RTN","MCEO",2,0)
 ;;2.3;Medicine;**17,31**;09/13/1996
"RTN","MCEO",3,0)
 ;
"RTN","MCEO",4,0)
IN ;
"RTN","MCEO",5,0)
 N DA,DIC,DIE,DR
"RTN","MCEO",6,0)
 S MCFILE1=MCFILE
"RTN","MCEO",7,0)
 I '$D(MCOEON) D ORDER^MCPARAM
"RTN","MCEO",8,0)
 IF $D(MCOEON) D  ;    order entry flag on
"RTN","MCEO",9,0)
 .  N MCFILE1
"RTN","MCEO",10,0)
 .  Q
"RTN","MCEO",11,0)
 ;END IF
"RTN","MCEO",12,0)
 ;
"RTN","MCEO",13,0)
 S MCFILE=MCFILE1
"RTN","MCEO",14,0)
 QUIT
"RTN","MCEO",15,0)
 ;
"RTN","MCEO",16,0)
OUT ;
"RTN","MCEO",17,0)
 N DONE
"RTN","MCEO",18,0)
 IF $D(MCOEON) D  I 1 ;    order entry flag on
"RTN","MCEO",19,0)
 .  IF $D(^MCAR(MCFILE,MCARGDA)) D  I 1 ;    a record on file
"RTN","MCEO",20,0)
 ..    IF $D(DTOUT) D  I 1 ;    timeout
"RTN","MCEO",21,0)
 ...      S DONE=1
"RTN","MCEO",22,0)
 ...      Q
"RTN","MCEO",23,0)
 ..    ELSE  Q
"RTN","MCEO",24,0)
 ..    ;END IF
"RTN","MCEO",25,0)
 ..    Q
"RTN","MCEO",26,0)
 .  ELSE  S DONE=1 ;    no record on file
"RTN","MCEO",27,0)
 .  ;END IF
"RTN","MCEO",28,0)
 .  ;
"RTN","MCEO",29,0)
 .  Q
"RTN","MCEO",30,0)
 ;END IF
"RTN","MCEO",31,0)
 ;
"RTN","MCEO",32,0)
 D EN1^MCMAG ;    imaging link
"RTN","MCEO",33,0)
 QUIT
"RTN","MCPFTE")
0^7^B7583785
"RTN","MCPFTE",1,0)
MCPFTE ;WISC/TJK-PULMONARY FUNCTION TEST ENTER/EDIT ;7/9/99  10:08
"RTN","MCPFTE",2,0)
 ;;2.3;Medicine;**25,31**;09/13/1996
"RTN","MCPFTE",3,0)
 ; Reference IA #10061 for VADPT call.
"RTN","MCPFTE",4,0)
DIC ; Pulmonary Function Test Enter/Edit
"RTN","MCPFTE",5,0)
 D MCEPROC^MCARE,DATE^MCAREH
"RTN","MCPFTE",6,0)
 S DIC="^MCAR(700,",DIC(0)="AEQLMZ",(DLAYGO,DIDEL,MCFILE)=700
"RTN","MCPFTE",7,0)
 I MCESON S DIC("S")=$$PREEDIT^MCESSCR(MCFILE)
"RTN","MCPFTE",8,0)
 D ^DIC K DIC,DLAYGO G EXIT:Y<0
"RTN","MCPFTE",9,0)
 I $D(DTOUT),'$P(Y(0),U,2) S DIK="^MCAR(700,",DA=+Y D ^DIK G EXIT
"RTN","MCPFTE",10,0)
 S DFN=$P(Y(0),U,2),MCARGDA=+Y
"RTN","MCPFTE",11,0)
 I MCESON,$$ESTONUM^MCESSCR(MCFILE,MCARGDA)>2 D ESRC^MCESSCR(MCFILE,MCARGDA) I '$D(MCBACK) G EXIT
"RTN","MCPFTE",12,0)
 D:$D(MCBACK) BACK
"RTN","MCPFTE",13,0)
 D DEM^VADPT S MCSEX=$P(VADM(5),U),MCRACE=$P(VADM(8),U,2) D KVAR^VADPT
"RTN","MCPFTE",14,0)
 I MCRACE="" D RACEMSG^MCPFTSS
"RTN","MCPFTE",15,0)
 S MCRACE=$S(MCRACE["ASIAN":"",MCRACE["BLACK":"B",1:"") K:MCRACE="" MCRACE
"RTN","MCPFTE",16,0)
 S DIE="^MCAR(700,",DA=MCARGDA
"RTN","MCPFTE",17,0)
 ; MFD 2-23-93 S DR=$S($G(MCBL)=1:"[MCPFTBRIEF]",1:"[MCPFTEDIT]")
"RTN","MCPFTE",18,0)
 S DR="["_MCEPROC_"]"
"RTN","MCPFTE",19,0)
 D ORDERA G EXIT:$D(DUOUT)!$D(DTOUT)
"RTN","MCPFTE",20,0)
 S DIE="^MCAR(700,",DA=MCARGDA
"RTN","MCPFTE",21,0)
 S DR="["_MCEPROC_"]"
"RTN","MCPFTE",22,0)
 D ^DIE,ORDER1,QTASK^MCPARAM
"RTN","MCPFTE",23,0)
 D ESRC^MCESSCR(MCFILE,MCARGDA)
"RTN","MCPFTE",24,0)
EXIT ; Leave gracefully
"RTN","MCPFTE",25,0)
 K DIC,DIK,DA,DIE,DR,DFN,MCRACE,DIWF,MCSEX,MCARGDA,DIR,DIDEL
"RTN","MCPFTE",26,0)
 K MCESON,MCESKEY,MCROUT,MCARCODE,MCEBRIEF,MCEFULL,MCPBRIEF,MCPFULL,MCPRTRTN,MCBS,MCPATFLD,MCSFULL,MCSBRIEF,MCBACK
"RTN","MCPFTE",27,0)
 Q
"RTN","MCPFTE",28,0)
ORDERA S MCARGNUM=$O(^MCAR(697.2,"C","MCAR(700",0)),MCFILE=700
"RTN","MCPFTE",29,0)
ORDER D:'$D(MCOEON) ORDER^MCPARAM Q:'$D(MCOEON)
"RTN","MCPFTE",30,0)
 Q
"RTN","MCPFTE",31,0)
ORDER1 G IM:'$D(MCOEON) Q:'$D(^MCAR(MCFILE,MCARGDA))  Q:$D(DTOUT)
"RTN","MCPFTE",32,0)
IM D EN1^MCMAG
"RTN","MCPFTE",33,0)
 Q
"RTN","MCPFTE",34,0)
PVFASS ;Entry point to  Associate Predicted Value Formulas
"RTN","MCPFTE",35,0)
 S DIC("A")="Select the SEX for which the Predicted Value will be applied: "
"RTN","MCPFTE",36,0)
 S DIC="^MCAR(700.1,",DIC(0)="AEQM" D ^DIC I Y<0 D EXIT Q
"RTN","MCPFTE",37,0)
 S DIC(0)="AELQM"
"RTN","MCPFTE",38,0)
 S DIE=DIC,DA=+Y,DR=".01;1:10;12:15"
"RTN","MCPFTE",39,0)
 D ^DIE K DIC,DIE,DLAYGO,DA,DR G PVFASS
"RTN","MCPFTE",40,0)
PVFEDT ;Entry point to Enter/Edit Predicited Value Formulas
"RTN","MCPFTE",41,0)
 S DIC("A")="Select the Predicted Value Formula: "
"RTN","MCPFTE",42,0)
 S DIC(0)="AELQ",DLAYGO=700.2
"RTN","MCPFTE",43,0)
 S DIC=700.2,D="D" D IX^DIC I Y<0 D EXIT Q
"RTN","MCPFTE",44,0)
 S DIE=DIC,DA=+Y,DR=".01:9"
"RTN","MCPFTE",45,0)
 D ^DIE K DIC,DIE,DLAYGO,DA,DR G PVFEDT
"RTN","MCPFTE",46,0)
DISP N MCX S MCX=^MCAR(700.2,+Y,0)
"RTN","MCPFTE",47,0)
 W ?35,"REFERENCE: ",$P(MCX,U,3)
"RTN","MCPFTE",48,0)
 W !,?5,"SEX: ",$S($P(MCX,U,4)="F":"Female",$P(MCX,U,4)="M":"Male",1:"")
"RTN","MCPFTE",49,0)
 W !,?5,"CI: ",$P(MCX,U,5),?18,"SEE: ",$P(MCX,U,6)
"RTN","MCPFTE",50,0)
 W !,?5,"METHOD: ",$P(MCX,U,7)
"RTN","MCPFTE",51,0)
 W !,?5,"DEMOGRAPHICS: ",$P(MCX,U,8)
"RTN","MCPFTE",52,0)
 W !,?5,"SMOKERS INCLUDED: ",$S($P(MCX,U,9)="N":"NO",$P(MCX,U,9)="Y":"YES",1:""),?30,"ALTITUDE: ",$P(MCX,U,10),! Q
"RTN","MCPFTE",53,0)
BACK ;Set Y to the new record and allow the user to edit the new record
"RTN","MCPFTE",54,0)
 S Y=MCY,Y(0)=MCY(0),Y(0,0)=MCY(0,0),MCARGDA=+Y K MCY,DIROUT,DUOUT,DTOUT,EXIT
"RTN","MCPFTE",55,0)
 Q
"RTN","MCPFTI")
0^8^B9100897
"RTN","MCPFTI",1,0)
MCPFTI ;WISC/TJK-PFT INTERPRETATION ENTRY ;7/9/99  10:11
"RTN","MCPFTI",2,0)
 ;;2.3;Medicine;**25,31**;09/13/1996
"RTN","MCPFTI",3,0)
 ; Reference IA #10061 for VADPT call.
"RTN","MCPFTI",4,0)
DIC ; PFT Interpretation Entry.
"RTN","MCPFTI",5,0)
 D MCEPROC^MCARE
"RTN","MCPFTI",6,0)
 S DIC="^MCAR(700,",DIC(0)="AEQMZ"
"RTN","MCPFTI",7,0)
 I MCESON S DIC("S")=$$PREEDIT^MCESSCR(MCFILE)
"RTN","MCPFTI",8,0)
 D ^DIC K DIC G EXIT:Y<0
"RTN","MCPFTI",9,0)
 S DFN=$P(Y(0),U,2),MCARGDA=+Y,MCARGDT=$P(Y,U,2)
"RTN","MCPFTI",10,0)
 I MCESON,$$ESTONUM^MCESSCR(MCFILE,MCARGDA)>2 D ESRC^MCESSCR(MCFILE,MCARGDA) G EXIT Q
"RTN","MCPFTI",11,0)
GETORDER D ORDERA G EXIT:$D(DUOUT)!$D(DTOUT)
"RTN","MCPFTI",12,0)
 D SETVAR^MCPFTP2
"RTN","MCPFTI",13,0)
 S RDATE=9999999.9999-$P(^MCAR(700,MCARGDA,0),U),MCPFT0=^(0),HT=$P(MCPFT0,U,4),WT=$P(MCPFT0,U,5),X1=$E($P(MCPFT0,U,1),1,7)
"RTN","MCPFTI",14,0)
 S HT=HT*2.54,WT=WT/2.2
"RTN","MCPFTI",15,0)
 S:'HT HT=$P(MCPFT0,U,3) S:'WT WT=$P(MCPFT0,U,6)
"RTN","MCPFTI",16,0)
 S MC17="" D DEM^VADPT S RACE=$P(VADM(8),U,2),MCSEX=$P(VADM(5),U),X2=$P(VADM(3),U) D ^%DTC
"RTN","MCPFTI",17,0)
 I RACE="" D RACEMSG^MCPFTSS
"RTN","MCPFTI",18,0)
 ; ---------------------
"RTN","MCPFTI",19,0)
 ; AGE = the patients age at the date of the procedure
"RTN","MCPFTI",20,0)
 ; ---------------------
"RTN","MCPFTI",21,0)
 S AGE=X\365.25 D PRED^MCPFTP1 W:$D(MCRCN) !,MCRCN
"RTN","MCPFTI",22,0)
 ;D INP^VADPT S MCARWARD=$S(VAIN(4)'="":$P(VAIN(4),U,2),1:"NOT INPATIENT"),MCARRB=VAIN(5) 
"RTN","MCPFTI",23,0)
 S MCARZ="PULMONARY FUNCTION TEST" D INIT^MCARP1(MCARZ,MCARGDT,MCFILE)
"RTN","MCPFTI",24,0)
 S DIR(0)="E"
"RTN","MCPFTI",25,0)
 D ^DIR
"RTN","MCPFTI",26,0)
 I 'Y G EXIT
"RTN","MCPFTI",27,0)
I W @IOF,"***INTERPRETATION ENTRY***"
"RTN","MCPFTI",28,0)
 S HEAD1="VOLUMES",MCX=0,$P(MCDOT," ",81)=""
"RTN","MCPFTI",29,0)
 S MCFF="S DN=1,MCY="""" I $Y>(IOSL-3) R:$E(IOST,1,2)=""C-"" !!,""Press Return to Continue, '^' to escape: "",MCY:DTIME S:'$T MCY=U S:MCY=U MCOUT=1,DN=0 Q:$D(MCOUT)  W:DN @IOF D HEAD^MCARP D:$D(HEAD1) HEAD1^MCPFTP2,HEAD2^MCPFTP2 K MCY"
"RTN","MCPFTI",30,0)
 D HEAD^MCARP,HEAD1^MCPFTP2,HEAD2^MCPFTP2 G EXIT:$D(MCOUT) D VOL^MCPFTP2 G EXIT:$D(MCOUT)
"RTN","MCPFTI",31,0)
PVPRT ;
"RTN","MCPFTI",32,0)
 S DIR(0)="E" D ^DIR G EXIT:'Y
"RTN","MCPFTI",33,0)
 W @IOF
"RTN","MCPFTI",34,0)
 D PV1^MCPFTP5 G EXIT:$D(MCOUT)
"RTN","MCPFTI",35,0)
ED D ^MCPFTIC G EXIT:$D(DUOUT)!$D(DTOUT)
"RTN","MCPFTI",36,0)
 S DIE="^MCAR(700,",DA=MCARGDA,DR="33.5;30;21;31;600"
"RTN","MCPFTI",37,0)
 ;MFD 2/10/93 DR(2,700.05)=.01
"RTN","MCPFTI",38,0)
 D ^DIE,ORDER1,QTASK^MCPARAM
"RTN","MCPFTI",39,0)
 D ESRC^MCESSCR(MCFILE,MCARGDA)
"RTN","MCPFTI",40,0)
 ;
"RTN","MCPFTI",41,0)
 ;    Allow the user to print a PFT report now
"RTN","MCPFTI",42,0)
 S DIR(0)="Y",DIR("A")="Print report now",DIR("B")="YES" ;    setup
"RTN","MCPFTI",43,0)
 D ^DIR ;    ask
"RTN","MCPFTI",44,0)
 I Y S TEMP=MCARGDA D ^MCPFTP1A S MCARGDA=TEMP D SUM^MCPFTP ;    yes, they want the report
"RTN","MCPFTI",45,0)
 ;
"RTN","MCPFTI",46,0)
EXIT D EXIT1^MCPFTP1 K A,J,F,SUB,FLD,NM,K,I,DIR,LN,DIRUT
"RTN","MCPFTI",47,0)
 K DIE,MCND,DA,DR,DBZZ
"RTN","MCPFTI",48,0)
 K MCAR,MCARDOB,MCARDTM,MCARHDR,MCARRB,MCARWARD,MCRHR,VADM,VAIN
"RTN","MCPFTI",49,0)
 K MCARP,MCFILE,MCESON,MCESKEY,MCROUT,MCTYPE
"RTN","MCPFTI",50,0)
 K MCPBRIEF,MCPFULL,MCPRTRTN,TEMP
"RTN","MCPFTI",51,0)
 Q
"RTN","MCPFTI",52,0)
ORDERA S MCARGNUM=$O(^MCAR(697.2,"C","MCAR(700",0)),MCFILE=700
"RTN","MCPFTI",53,0)
ORDER D:'$D(MCOEON) ORDER^MCPARAM Q:'$D(MCOEON)
"RTN","MCPFTI",54,0)
 Q
"RTN","MCPFTI",55,0)
ORDER1 G IM:'$D(MCOEON) Q:'$D(^MCAR(MCFILE,MCARGDA))  Q:$D(DTOUT)
"RTN","MCPFTI",56,0)
IM D EN1^MCMAG Q
"RTN","MCRH1")
0^9^B25789056
"RTN","MCRH1",1,0)
MCRH1 ;WISC/HAG-RHEUMATOLOGY PATIENT HISTORY EDIT ;7/3/96  09:13
"RTN","MCRH1",2,0)
 ;;2.3;Medicine;**31**;09/13/1996
"RTN","MCRH1",3,0)
 ; Reference IA #10061 VADPT calls
"RTN","MCRH1",4,0)
 ;                 681 Get Lab Data
"RTN","MCRH1",5,0)
CONS S MCARCODE="Z" D CONSULT^MCARGE G EXIT
"RTN","MCRH1",6,0)
CONSS S MCARCODE="Z" D CONSULT^MCARGES G EXIT
"RTN","MCRH1",7,0)
CONSP D CONSULT^MCARGP G EXIT
"RTN","MCRH1",8,0)
MCRHMED S MCARCODE="R" D EN1^MCARSUP G EXIT
"RTN","MCRH1",9,0)
ALLP S MCRHLP="P",MCRH=0 G SEL
"RTN","MCRH1",10,0)
DIAGP S MCRHLP="P",MCRH=1 G SEL
"RTN","MCRH1",11,0)
BACKP S MCRHLP="P",MCRH=2 G SEL
"RTN","MCRH1",12,0)
NARRP S MCRHLP="P",MCRH=3 G SEL
"RTN","MCRH1",13,0)
LABP S MCRHLP="P",MCRH=4 G SEL
"RTN","MCRH1",14,0)
HAQP S MCRHLP="P",MCRH=6 G SEL
"RTN","MCRH1",15,0)
HISTP S MCRHLP="P",MCRH=7 G SEL
"RTN","MCRH1",16,0)
PHYSP S MCRHLP="P",MCRH=8 G SEL
"RTN","MCRH1",17,0)
DEATHP S MCRHLP="P",MCRH=9 G SEL
"RTN","MCRH1",18,0)
DIAGL S MCRHLP="L",MCRH=1 G SEL
"RTN","MCRH1",19,0)
NARRL S MCRHLP="L",MCRH=3 G SEL
"RTN","MCRH1",20,0)
HAQL S MCRHLP="L",MCRH=6 G SEL
"RTN","MCRH1",21,0)
HISTL S MCRHLP="L",MCRH=7 G SEL
"RTN","MCRH1",22,0)
PHYSL S MCRHLP="L",MCRH=8 G SEL
"RTN","MCRH1",23,0)
DEATHL S MCRHLP="L",MCRH=9 G SEL
"RTN","MCRH1",24,0)
BRIEFL S MCRHLP="L",MCRH=10 G SEL
"RTN","MCRH1",25,0)
DIAGF S MCRH=1 G SEL
"RTN","MCRH1",26,0)
BACKF S MCRH=2 G SEL
"RTN","MCRH1",27,0)
NARRF S MCRH=3 G SEL
"RTN","MCRH1",28,0)
TRETF S MCRH=5 G SEL
"RTN","MCRH1",29,0)
LABF S MCRH=4 G SEL
"RTN","MCRH1",30,0)
HAQF S MCRH=6 G SEL
"RTN","MCRH1",31,0)
HISTF S MCRH=7 G SEL
"RTN","MCRH1",32,0)
PHYSF S MCRH=8 G SEL
"RTN","MCRH1",33,0)
DEATHF S MCRH=9 G SEL
"RTN","MCRH1",34,0)
BRIEFF S MCRH=10
"RTN","MCRH1",35,0)
SEL ; Visit Date Selection
"RTN","MCRH1",36,0)
 N MCRHB
"RTN","MCRH1",37,0)
 S MCFILE=701,MCPRO="RHEUM"
"RTN","MCRH1",38,0)
 S DIC("A")="Select prior visit by entering the patient name or visit date"_$S(MCRH=2:" or enter the date@time for a new visit: ",1:": ")
"RTN","MCRH1",39,0)
PRT I $D(MCRHLP),(MCRHLP="P"),(MCRH'=4) D RHFULL^MCARP G EXIT
"RTN","MCRH1",40,0)
 S DIC="^MCAR(701,",DIC(0)=$S(MCRH=2:"AELQMZ",1:"AEQMZ") S:MCRH=2 DLAYGO=701 D ^DIC K DLAYGO G:Y<0 EXIT S (DJDN,DA,MCARGDA)=+Y,DFN=$P(Y(0),U,2),MC0=Y(0) D ^VADPT S MCSEX=$P(VADM(5),U),Y(0)=MC0 K MC0
"RTN","MCRH1",41,0)
 I MCRH=5 S Y=$P(Y(0),U,2),PSOPAR="" D DOIT^MCPSOP G SEL
"RTN","MCRH1",42,0)
 I MCRH=4 S DJDIS=1,MCLRDFN=$G(^DPT($P(Y(0),U,2),"LR")) W:MCLRDFN="" !!,*7,*27,*91,*49,*109,"  Patient laboratory information has not been processed!",*27,*91,*109 G:MCLRDFN="" SEL D GETLAB G:Y<0 SEL I '$D(MCRHLP) D HOME^%ZIS,QSTART G EXIT
"RTN","MCRH1",43,0)
 I MCRH=4,$D(MCRHLP),(MCRHLP="P") D QUE G EXIT
"RTN","MCRH1",44,0)
LIN I $D(MCRHLP),(MCRHLP="L") S V=MCRH,DIE="^MCAR(701," S DR=$S($G(MCBL)=1:"[MCRHBRIEF]",1:"[MCRH"_$S(V=1:"DIAG",V=3:"NARR",V=6:"HAQ",V=7:"HIST",V=9:"DEATH",1:"PHYS")) K V D ORDERA G EXIT:$D(DTOUT)!$D(DUOUT) D ^DIE,ORDER1,QTASK^MCPARAM G SEL
"RTN","MCRH1",45,0)
FUL S:MCRH=2 DJDN=$P(^MCAR(701,DA,0),U,2),DJDIS=1 S V=MCRH,(MCRHB,DJSC)=$S($G(MCBS)=1:"MCRHBRSCREEN",1:"MCRH"_$S(V=1:"DIAG",V=2:"BACK",V=3:"NARR",V=4:"LAB010",V=6:"HAQ",V=7:"HIST",V=9:"DEATH",1:"PHYS"))
"RTN","MCRH1",46,0)
 D ORDERA G EXIT:$D(DTOUT)!$D(DUOUT) K V D EN^MCARD,ORDER1,QTASK^MCPARAM G SEL
"RTN","MCRH1",47,0)
DEL ;DELETE RHEUMATOLOGY VISIT
"RTN","MCRH1",48,0)
 S DIC("A")="Select a prior visit by entering the patient's name or visit date: "
"RTN","MCRH1",49,0)
 W !! S DIC="^MCAR(701,",DIC(0)="AEQM"
"RTN","MCRH1",50,0)
 ;S:MCESON DIC("S")="I $$SCRDEL^MCESSCR(MCFILE,Y)"
"RTN","MCRH1",51,0)
 D ^DIC G:Y<0 EXIT S (MCRH1,DA)=+Y
"RTN","MCRH1",52,0)
DISP W !!,"Would you like a display of the data for this visit" S %=1 D YN^DICN G DISP:%=0,USURE:%=2 I %<0 G DEL
"RTN","MCRH1",53,0)
 S (DJDN,DA)=MCRH1,DJSC="MCRHHIST",DJDIS=1 D EN^MCARD
"RTN","MCRH1",54,0)
USURE W !!,"Are you sure you want to delete this entry" S %=2 D YN^DICN G DEL:%=0 I %'=1 W !,"Nothing Deleted" G DEL
"RTN","MCRH1",55,0)
 S (DIK,DIC)="^MCAR(701,",DA=MCRH1 D ^DIK W !!,"Entry deleted." R X:2 G DEL
"RTN","MCRH1",56,0)
GETLAB ;
"RTN","MCRH1",57,0)
 S DIC("B")=$O(^LR(MCLRDFN,"CH",0))
"RTN","MCRH1",58,0)
 S DIC="^LR(MCLRDFN,""CH"",",DIC(0)="AEQMZ",DIC("A")="Select DATE/TIME SPECIMEN TAKEN: " D ^DIC S:Y>0 (DJDN,MCLRDA)=+Y,MCARGDT=$P(Y,U,2),MCLABDT=9999999-MCARGDT S DA(1)=MCLRDFN K DIC("A") Q
"RTN","MCRH1",59,0)
QUE K IO("Q") S %ZIS="MQ" D ^%ZIS G:POP EXIT
"RTN","MCRH1",60,0)
 I $D(IO("Q")) S MCARZ="RHEUMATOLOGY REPORT",(ZTSAVE("MC*"),ZTSAVE("DFN"),ZTSAVE("DA"),ZTSAVE("DT"))="",ZTRTN="QSTART^MCRH1",ZTDESC=MCARZ D ^%ZTLOAD K ZTSK Q
"RTN","MCRH1",61,0)
QSTART K ^UTILITY("DIQ1",$J) S PG=0,DIC="^LR(MCLRDFN,""CH"",",DA=MCLRDA
"RTN","MCRH1",62,0)
 S DR="2:7;9:20;41;45;63;96;174;384;386;387;395:399;428;430;431;454;468;469;547:549;553;561;563;581;587;594;595;625;627;631;639;649;690;691;693;694;700;703;738;741;748;771;750"
"RTN","MCRH1",63,0)
 S Y=MCLRDA,DA(1)=MCLRDFN,DA(63.04)=MCLABDT D EN^DIQ1
"RTN","MCRH1",64,0)
 S MCARGRTN="RHFULL1" U IO D RHPRT^MCARP D ^%ZISC Q
"RTN","MCRH1",65,0)
LOCK ;LOCK GLOBAL THAT IS BEING ACCESSED BY ANOTHER USER
"RTN","MCRH1",66,0)
 ;L @(DIC_DA_"):1") S MCRHL=$T Q:MCRHL'=0  I MCRHL=0 W !!,*7,"THIS ENTRY IS BEING EDITED BY ANOTHER USER.  TRY LATER." Q
"RTN","MCRH1",67,0)
EXIT D KVAR^VADPT K %,DA,DFN,DIC,DIE,DIK,DJDIS,DJDN,DJSC,DR,DT1,H,I,K,K1
"RTN","MCRH1",68,0)
 K MCFILE,MCARCODE,MCARGDT,MCARGRTN,MCARZ,MCRH1,MCRH,MCRHL,MCLABDT,MCLRDFN,MCRHLP,MCRHY,PG,POP,PSOPAR,STA,V,X,X1,Z,ZTDESC,ZTRTN,ZTSAVE,MCARGNUM,MCARGDA,MCSEX Q
"RTN","MCRH1",69,0)
ORDERA S MCARGNUM=$O(^MCAR(697.2,"C","MCAR(701",0))
"RTN","MCRH1",70,0)
ORDER D:'$D(MCOEON) ORDER^MCPARAM Q:'$D(MCOEON)
"RTN","MCRH1",71,0)
 Q
"RTN","MCRH1",72,0)
ORDER1 G IM:'$D(MCOEON) Q:'$D(^MCAR(MCFILE,MCARGDA))  Q:$D(DTOUT)
"RTN","MCRH1",73,0)
IM Q:MCRH'=1  D EN1^MCMAG Q
"VER")
8.0^22
**END**
**END**
