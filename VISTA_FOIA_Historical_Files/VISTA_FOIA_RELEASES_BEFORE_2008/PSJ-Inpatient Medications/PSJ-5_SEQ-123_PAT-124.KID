Released PSJ*5*124 SEQ #123
Extracted from mail message
**KIDS**:PSJ*5.0*124^

**INSTALL NAME**
PSJ*5.0*124
"BLD",5493,0)
PSJ*5.0*124^INPATIENT MEDICATIONS^0^3050314^y
"BLD",5493,1,0)
^^5^5^3050121^
"BLD",5493,1,1,0)
 1. TNV-1104-30671  Pharmacy is reporting that they do not see the
"BLD",5493,1,2,0)
    "Patient Record Flags" when using the Inpatient Pharmacy option
"BLD",5493,1,3,0)
    "Inpatient Order Entry [PSJ OE]".  This patch will add a 
"BLD",5493,1,4,0)
    reference to DISPPRF^DGPFAPI that is designed to display the
"BLD",5493,1,5,0)
    "Patient Record Flags".
"BLD",5493,4,0)
^9.64PA^^
"BLD",5493,"KRN",0)
^9.67PA^8989.52^19
"BLD",5493,"KRN",.4,0)
.4
"BLD",5493,"KRN",.401,0)
.401
"BLD",5493,"KRN",.402,0)
.402
"BLD",5493,"KRN",.403,0)
.403
"BLD",5493,"KRN",.5,0)
.5
"BLD",5493,"KRN",.84,0)
.84
"BLD",5493,"KRN",3.6,0)
3.6
"BLD",5493,"KRN",3.8,0)
3.8
"BLD",5493,"KRN",9.2,0)
9.2
"BLD",5493,"KRN",9.8,0)
9.8
"BLD",5493,"KRN",9.8,"NM",0)
^9.68A^2^2
"BLD",5493,"KRN",9.8,"NM",1,0)
PSJDPT^^0^B4843407
"BLD",5493,"KRN",9.8,"NM",2,0)
PSGVBW0^^0^B34843910
"BLD",5493,"KRN",9.8,"NM","B","PSGVBW0",2)

"BLD",5493,"KRN",9.8,"NM","B","PSJDPT",1)

"BLD",5493,"KRN",19,0)
19
"BLD",5493,"KRN",19.1,0)
19.1
"BLD",5493,"KRN",101,0)
101
"BLD",5493,"KRN",409.61,0)
409.61
"BLD",5493,"KRN",771,0)
771
"BLD",5493,"KRN",870,0)
870
"BLD",5493,"KRN",8989.51,0)
8989.51
"BLD",5493,"KRN",8989.52,0)
8989.52
"BLD",5493,"KRN",8994,0)
8994
"BLD",5493,"KRN","B",.4,.4)

"BLD",5493,"KRN","B",.401,.401)

"BLD",5493,"KRN","B",.402,.402)

"BLD",5493,"KRN","B",.403,.403)

"BLD",5493,"KRN","B",.5,.5)

"BLD",5493,"KRN","B",.84,.84)

"BLD",5493,"KRN","B",3.6,3.6)

"BLD",5493,"KRN","B",3.8,3.8)

"BLD",5493,"KRN","B",9.2,9.2)

"BLD",5493,"KRN","B",9.8,9.8)

"BLD",5493,"KRN","B",19,19)

"BLD",5493,"KRN","B",19.1,19.1)

"BLD",5493,"KRN","B",101,101)

"BLD",5493,"KRN","B",409.61,409.61)

"BLD",5493,"KRN","B",771,771)

"BLD",5493,"KRN","B",870,870)

"BLD",5493,"KRN","B",8989.51,8989.51)

"BLD",5493,"KRN","B",8989.52,8989.52)

"BLD",5493,"KRN","B",8994,8994)

"BLD",5493,"QUES",0)
^9.62^^
"BLD",5493,"REQB",0)
^9.611^2^1
"BLD",5493,"REQB",2,0)
PSJ*5.0*127^2
"BLD",5493,"REQB","B","PSJ*5.0*127",2)

"MBREQ")
0
"PKG",221,-1)
1^1
"PKG",221,0)
INPATIENT MEDICATIONS^PSJ^UNIT DOSE AND IVS
"PKG",221,20,0)
^9.402P^^
"PKG",221,22,0)
^9.49I^1^1
"PKG",221,22,1,0)
5.0^2971215^2981113^1
"PKG",221,22,1,"PAH",1,0)
124^3050314^520637415
"PKG",221,22,1,"PAH",1,1,0)
^^5^5^3050314
"PKG",221,22,1,"PAH",1,1,1,0)
 1. TNV-1104-30671  Pharmacy is reporting that they do not see the
"PKG",221,22,1,"PAH",1,1,2,0)
    "Patient Record Flags" when using the Inpatient Pharmacy option
"PKG",221,22,1,"PAH",1,1,3,0)
    "Inpatient Order Entry [PSJ OE]".  This patch will add a 
"PKG",221,22,1,"PAH",1,1,4,0)
    reference to DISPPRF^DGPFAPI that is designed to display the
"PKG",221,22,1,"PAH",1,1,5,0)
    "Patient Record Flags".
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
2
"RTN","PSGVBW0")
0^2^B34843910
"RTN","PSGVBW0",1,0)
PSGVBW0 ;BIR/CML3,MV-SHOW NON-VERFIED ORDERS GATHERED IN PSGVBW ;17 SEP 97 /  1:41 PM
"RTN","PSGVBW0",2,0)
 ;;5.0; INPATIENT MEDICATIONS ;**29,39,53,56,95,80,110,127,124**;16 DEC 97
"RTN","PSGVBW0",3,0)
 ;
"RTN","PSGVBW0",4,0)
 ; Reference to ^PSSLOCK is supported by DBIA #2789
"RTN","PSGVBW0",5,0)
 ; Reference to ^DIR is supported by DBIA 10026
"RTN","PSGVBW0",6,0)
 ; Reference to ^VALM is supported by DBIA 10118
"RTN","PSGVBW0",7,0)
 ;
"RTN","PSGVBW0",8,0)
START ;
"RTN","PSGVBW0",9,0)
 S (LINE,PSGOEA,PSGOEAV)="",$P(LINE,"-",81)="" S PSGPXN=$G(PSGPXN)
"RTN","PSGVBW0",10,0)
 K ^TMP("PSJLIST",$J) D:PSGSS'="P" DISPLAYW Q:'$O(^TMP("PSJSELECT",$J,0))
"RTN","PSGVBW0",11,0)
PROCESS ; Loop through selected patients and display profile/orders.
"RTN","PSGVBW0",12,0)
 K DIR,PSJPNV S PSJPNV=1
"RTN","PSGVBW0",13,0)
 I $P(PSJSYSU,";")=3 S X=$O(^TMP("PSJSELECT",$J,1)),DIR(0)="Y",DIR("A")="Do you want to print a profile for the"_$S(X:"se",1:"")_" patient"_$S(X:"s",1:""),DIR("B")="NO" D
"RTN","PSGVBW0",14,0)
 .D ^DIR K DIR I Y D ^PSJHVARS,^PSGVBWP,RESTORE^PSJHVARS
"RTN","PSGVBW0",15,0)
 .W !!,"Select profile type for order processing.",!!
"RTN","PSGVBW0",16,0)
 D ENL^PSGOU Q:"SNL"'[PSGOL
"RTN","PSGVBW0",17,0)
 F PSJCNT=0:0 S PSJCNT=$O(^TMP("PSJSELECT",$J,PSJCNT)) Q:'PSJCNT  D PROCESS1 S PSGOP=PSGP D ENQL^PSGLW:$P(PSJSYSL,"^",2)]"" Q:$G(PSJGOTO)="E"  I $D(^TMP("PSJSELECT",$J,+$G(PSJGOTO))) S PSJCNT=PSJGOTO-1
"RTN","PSGVBW0",18,0)
 Q
"RTN","PSGVBW0",19,0)
PROCESS1 ;
"RTN","PSGVBW0",20,0)
 S PSJPN=$G(^TMP("PSJSELECT",$J,PSJCNT)) K PSJGOTO
"RTN","PSGVBW0",21,0)
 S PSJLK=$$L^PSSLOCK($P(PSJPN,U,2),1) I 'PSJLK W !,$C(7),$P(PSJLK,U,2) Q
"RTN","PSGVBW0",22,0)
 K PSJGOTO D:PSJPN]"" GTORDERS
"RTN","PSGVBW0",23,0)
 I PSJLK D UL^PSSLOCK($P(PSJPN,U,2))
"RTN","PSGVBW0",24,0)
 I $G(PSGPXN),$$DEFON^PSGPER1 D  K PSGPXPT S PSGPXN=0
"RTN","PSGVBW0",25,0)
 .S PSGPXPT=PSGP
"RTN","PSGVBW0",26,0)
 .N DFN,PSGP S (PSGP,DFN)=PSGPXPT D ^PSGPER,ENCV^PSGSETU,^PSIVXU
"RTN","PSGVBW0",27,0)
 S PSGPXN=$G(PSGPXN)
"RTN","PSGVBW0",28,0)
 Q
"RTN","PSGVBW0",29,0)
 ;
"RTN","PSGVBW0",30,0)
DISPLAYW ; Allow selection of patients on each ward selected.
"RTN","PSGVBW0",31,0)
 K ^TMP("PSJSELECT",$J) S PSJCNT=1,PSGVBWN="" F  S PSGVBWN=$O(^TMP("PSGVBW",$J,PSGVBWN)) Q:PSGVBWN=""  D DISPLAYT
"RTN","PSGVBW0",32,0)
 Q
"RTN","PSGVBW0",33,0)
 ;
"RTN","PSGVBW0",34,0)
DISPLAYT ;
"RTN","PSGVBW0",35,0)
 NEW PSGPICK  ;PSGPICK=1-->user selected order, stop display the profile
"RTN","PSGVBW0",36,0)
 D HEADER S PSGVBTM="",PSGVBY=0 F  S PSGVBTM=$O(^TMP("PSGVBW",$J,PSGVBWN,PSGVBTM))  Q:(PSGVBTM=""!$G(PSGPICK))  D V2
"RTN","PSGVBW0",37,0)
 I PSJASK,(PSGVBY>0) D ASK
"RTN","PSGVBW0",38,0)
 Q
"RTN","PSGVBW0",39,0)
 ;
"RTN","PSGVBW0",40,0)
GTORDERS ;
"RTN","PSGVBW0",41,0)
 S (PSGP,DFN)=$P(PSJPN,U,2) K PSJACNWP D ^PSJAC
"RTN","PSGVBW0",42,0)
 I PSGOL'="N" D PROFILE Q
"RTN","PSGVBW0",43,0)
 D ENGORD^PSGVBWU
"RTN","PSGVBW0",44,0)
 S PSJPRIO="" F  S PSJPRIO=$O(^TMP("PSJON",$J,PSJPRIO)) Q:PSJPRIO=""  S PSJON="" D
"RTN","PSGVBW0",45,0)
 . F  S PSJON=$O(^TMP("PSJON",$J,PSJPRIO,PSJON)) Q:PSJON=""  D
"RTN","PSGVBW0",46,0)
 .. I $P(PSJON,U,2)=+$P(PSJON,U,2) Q:'$$LOCK^PSJOEA(DFN,$P(PSJON,U,2))  D GTORDER2 Q
"RTN","PSGVBW0",47,0)
 .. I '$$LS^PSSLOCK(DFN,$P(PSJON,U,2)) D DISPORD(DFN,$P(PSJON,U,2)) Q
"RTN","PSGVBW0",48,0)
 .. D DISACTIO^PSJOE(DFN,$P(PSJON,U,2),1) Q:$D(PSJGOTO)  D UNL^PSSLOCK(DFN,$P(PSJON,U,2))
"RTN","PSGVBW0",49,0)
 Q
"RTN","PSGVBW0",50,0)
 ;
"RTN","PSGVBW0",51,0)
GTORDER2 ;
"RTN","PSGVBW0",52,0)
 N PSJO S PSJO=0 F  S PSJO=$O(^PS(53.1,"ACX",$P(PSJON,U,2),PSJO)) Q:'PSJO  D
"RTN","PSGVBW0",53,0)
 .D DISACTIO^PSJOE(DFN,PSJO_"P",1) Q:$D(PSJGOTO)
"RTN","PSGVBW0",54,0)
 I $D(^TMP("PSJCOM",$J)) N PSJORD S PSJORD=$P(PSJON,U,2) D CHK^PSJOEA1
"RTN","PSGVBW0",55,0)
 N PSJO S PSJO=0 F  S PSJO=$O(^PS(53.1,"ACX",$P(PSJON,U,2),PSJO)) Q:'PSJO  D
"RTN","PSGVBW0",56,0)
 .D UNL^PSSLOCK(DFN,PSJO_"P") Q:$G(Y)<0
"RTN","PSGVBW0",57,0)
 Q
"RTN","PSGVBW0",58,0)
 ;
"RTN","PSGVBW0",59,0)
PROFILE ; Display the patient's profile and allow order selection.
"RTN","PSGVBW0",60,0)
 S PSGP=DFN,PSJOL=PSGOL F  D EN^VALM("PSJ LM PNV") Q:'$G(PSJORD)&'$G(PSJNEWOE)  S PSJNEWOE=0
"RTN","PSGVBW0",61,0)
 Q
"RTN","PSGVBW0",62,0)
 ;
"RTN","PSGVBW0",63,0)
DONE ;
"RTN","PSGVBW0",64,0)
 K ^TMP("PSGVBW",$J),^TMP("PSJON",$J)
"RTN","PSGVBW0",65,0)
 K CF,DA,LINE,NP,POP,PPN,PR,PSGCANFL,PSGION,PSGOL,PSGOEAV,PSGOENOF,PSGON,PSGONC,PSGONR,PSGLMT,PSGORD,PSGPRF,PSGVBA,PSGVBAF,PSGVBON,PSGVBPN,PSGVBQ,PSGVBQ1,PSGVBSD,PSGVBSS,PSGVBST,PSGVBTM,PSGVBW,PSGVBWN,PSGVBY,QQ,Z
"RTN","PSGVBW0",66,0)
 Q
"RTN","PSGVBW0",67,0)
 ;
"RTN","PSGVBW0",68,0)
V2 ;
"RTN","PSGVBW0",69,0)
 S PSGVBPN="" F  S PSGVBPN=$O(^TMP("PSGVBW",$J,PSGVBWN,PSGVBTM,PSGVBPN)) Q:(PSGVBPN=""!$G(PSGPICK))  S PSGP=$P(PSGVBPN,"^",2),PPN=$P(PSGVBPN,"^") S:PPN="" PPN=PSGP_";DPT(" D WRT
"RTN","PSGVBW0",70,0)
 Q
"RTN","PSGVBW0",71,0)
 ;
"RTN","PSGVBW0",72,0)
WRT ;
"RTN","PSGVBW0",73,0)
 S PSGVBY=PSGVBY+1,PSJASK=1
"RTN","PSGVBW0",74,0)
 W !,$J(PSGVBY,4),?6,$S(PSGVBTM'="zz":PSGVBTM,1:"Not Found"),?27,PPN," (",$P(PSGVBPN,U,3),")" S ^TMP("PSJLIST",$J,PSGVBY)=PSGVBWN_U_PSGVBTM_U_PPN_U_PSGP
"RTN","PSGVBW0",75,0)
 I $Y+1>IOSL,(PSGVBY>0) NEW DIR S DIR(0)="EA",DIR("A")=" '^' TO QUIT " D ^DIR D
"RTN","PSGVBW0",76,0)
 . I X="^" S PSGPICK=1  Q
"RTN","PSGVBW0",77,0)
 . S PSJASK=0 W @IOF
"RTN","PSGVBW0",78,0)
 Q
"RTN","PSGVBW0",79,0)
 ;
"RTN","PSGVBW0",80,0)
ASK ;
"RTN","PSGVBW0",81,0)
 N DIR,PSGDFN,PSGASKX S DIR(0)="LOA^1:"_PSGVBY,DIR("A")="Select 1 - "_PSGVBY_": " D ^DIR I $D(DUOUT)!$D(DTOUT) K ^TMP("PSGVBW",$J) Q
"RTN","PSGVBW0",82,0)
 S:Y]"" PSGPICK=1
"RTN","PSGVBW0",83,0)
 F PSJINDEX=1:1:$L(Y,",")-1 D
"RTN","PSGVBW0",84,0)
 . S PSGASKX=$G(^TMP("PSJLIST",$J,$P(Y,",",PSJINDEX))),PSGDFN=$P(PSGASKX,"^",4)_"^"_$P(PSGASKX,"^",3)
"RTN","PSGVBW0",85,0)
 . D CHK^PSJDPT(.PSGDFN,1) I PSGDFN=-1 Q
"RTN","PSGVBW0",86,0)
 . S:PSGASKX]"" ^TMP("PSJSELECT",$J,PSJCNT)=$P(PSGASKX,U,3,4),^TMP("PSJSELECT",$J,"B",$P(PSGASKX,U,3),PSJCNT)="",PSJCNT=PSJCNT+1
"RTN","PSGVBW0",87,0)
 Q
"RTN","PSGVBW0",88,0)
 ;
"RTN","PSGVBW0",89,0)
H2 ;
"RTN","PSGVBW0",90,0)
 W !!?2,"Select patients either singularly separated by commas (1,2,3), by a range of",!,"patients separated by a dash (1-3), or a combination (1,2,4-6).  To select all",!,"patients, enter 'ALL' or a dash ('-').  You can also enter '-n' to"
"RTN","PSGVBW0",91,0)
 W " select the",!,"first patient through the 'nth' patient or enter 'n-' to select the 'nth'",!,"patient through the last patient.  If a patient is selected more than once,"
"RTN","PSGVBW0",92,0)
 W !,"only the first selection is used.  (Entering '1,2,1' would return '1,2'.)" Q
"RTN","PSGVBW0",93,0)
 ;
"RTN","PSGVBW0",94,0)
HEADER ;
"RTN","PSGVBW0",95,0)
 W:$Y @IOF W !,"ORDERS NOT VERIFIED BY A ",$S($P(PSJSYSU,";",3)>1:"PHARMACIST",1:"NURSE")," - ",$S(PSGVBWN="ZZ":"^OTHER",1:PSGVBWN)
"RTN","PSGVBW0",96,0)
 W !!," No.",?7,"TEAM",?32,"PATIENT",!,LINE K PSGVBY S PSGVBY=0 Q
"RTN","PSGVBW0",97,0)
 Q
"RTN","PSGVBW0",98,0)
 ;
"RTN","PSGVBW0",99,0)
NP ;
"RTN","PSGVBW0",100,0)
 W $C(7) R !!,"ENTER AN '^' TO SELECT ORDERS NOW, OR PRESS THE RETURN KEY TO CONTINUE. ",NP:DTIME E  S NP="^"
"RTN","PSGVBW0",101,0)
 Q
"RTN","PSGVBW0",102,0)
DISPORD(DFN,ON)     ;Display the order that being lock by another user
"RTN","PSGVBW0",103,0)
 NEW PSJLINE,PSJOC,X
"RTN","PSGVBW0",104,0)
 S PSJLINE=1
"RTN","PSGVBW0",105,0)
 D DSPLORDU^PSJLMUT1(DFN,ON)
"RTN","PSGVBW0",106,0)
 W ! F X=0:0 S X=$O(PSJOC(ON,X)) Q:'X  W !,PSJOC(ON,X)
"RTN","PSGVBW0",107,0)
 Q
"RTN","PSGVBW0",108,0)
        
"RTN","PSJDPT")
0^1^B4843407
"RTN","PSJDPT",1,0)
PSJDPT ;BIR/JLC - CENTRALIZED PATIENT LOOKUP FOR IPM ; 07 Nov 00
"RTN","PSJDPT",2,0)
 ;;5.0; INPATIENT MEDICATIONS ;**53,124**;16 DEC 97
"RTN","PSJDPT",3,0)
 ;
"RTN","PSJDPT",4,0)
 ; Reference to ^DPT is supported by DBIA 10035
"RTN","PSJDPT",5,0)
 ; Reference to ^DGSEC4 is supported by DBIA 3027
"RTN","PSJDPT",6,0)
 ; Reference to ^DIC is supported by DBIA 10006
"RTN","PSJDPT",7,0)
 ; Reference to ^DICN is supported by DBIA 10009
"RTN","PSJDPT",8,0)
 ; Reference to ^DPTLK1 is supported by DBIA 3266
"RTN","PSJDPT",9,0)
 ; Reference to DISPPRF^DGPFAPI is supported by DBIA 4563
"RTN","PSJDPT",10,0)
 ; Reference to GETACT^DGPFAPI is supported by DBIA 3860
"RTN","PSJDPT",11,0)
 ;
"RTN","PSJDPT",12,0)
EN K DIC S DIC("W")="D DPT^PSJDPT",DIC="^DPT("
"RTN","PSJDPT",13,0)
 F Q=1:1:3 I X?@$P("1A4N^4N^9N","^",Q) Q
"RTN","PSJDPT",14,0)
 I  S D=$P("BS5^BS^SSN","^",Q),DIC(0)="EZI" D IX^DIC I Y>0 K DIC D CHK(.Y) Q
"RTN","PSJDPT",15,0)
 S DIC("W")="D DPT^PSJDPT",DIC(0)="QEMIZ" D ^DIC Q:Y'>0  K DIC
"RTN","PSJDPT",16,0)
 D CHK(.Y) Q
"RTN","PSJDPT",17,0)
CHK(Y,DISP,PAUSE) N RESULT,RES,CHKY,PSGTEMP
"RTN","PSJDPT",18,0)
 S DISP=$G(DISP),PAUSE=$G(PAUSE)
"RTN","PSJDPT",19,0)
 I $G(XQY0)["PSJI COMPLETE",$$GETACT^DGPFAPI(+Y,"PSGTEMP") K PSGTEMP W @IOF,"PATIENT: ",$P(Y,U,2)
"RTN","PSJDPT",20,0)
 S CHKY=Y D DISPPRF^DGPFAPI(Y) S Y=CHKY K CHKY
"RTN","PSJDPT",21,0)
 D PTSEC^DGSEC4(.RESULT,$P(Y,"^"),1)
"RTN","PSJDPT",22,0)
 I RESULT(1)'=0 D
"RTN","PSJDPT",23,0)
 . W !! I DISP W ?(80-$L($P(Y,"^",2)))\2,$P(Y,"^",2),!
"RTN","PSJDPT",24,0)
 . F I=2:1:9 I $D(RESULT(I)) W ?(80-$L(RESULT(I)))\2,RESULT(I),!
"RTN","PSJDPT",25,0)
 . I RESULT(1)'=0,RESULT(1)'=2,PAUSE H 2
"RTN","PSJDPT",26,0)
 . Q:RESULT(1)=1
"RTN","PSJDPT",27,0)
 . I RESULT(1)=-1!(RESULT(1)=3)!(RESULT(1)=4) S Y=-1 Q
"RTN","PSJDPT",28,0)
 . I RESULT(1)=2 D ENCONT I Y=-1 Q
"RTN","PSJDPT",29,0)
 . D NOTICE^DGSEC4(.RES,Y,XQY0,$S(RESULT(1)=1:1,1:3)) I RES=0 S Y=-1 Q
"RTN","PSJDPT",30,0)
 Q
"RTN","PSJDPT",31,0)
ENCONT W !,"Do you want to continue processing this patient record"
"RTN","PSJDPT",32,0)
 S %=2 D YN^DICN I %<0!(%=2) S Y=-1
"RTN","PSJDPT",33,0)
 I '% W !!,"Enter 'YES' to continue processing, or 'NO' to quit processing this record." G ENCONT
"RTN","PSJDPT",34,0)
 Q
"RTN","PSJDPT",35,0)
DPT I $$DOB^DPTLK1(Y)["*SENSITIVE" G SENS
"RTN","PSJDPT",36,0)
 S ND=$S($D(^DPT(Y,0)):^(0),1:""),NB=$P(ND,"^",3),NS=$P(ND,"^",9)
"RTN","PSJDPT",37,0)
 I NS W ?42,$E(NS,1,3),"-",$E(NS,4,5),"-",$E(NS,6,10)," "
"RTN","PSJDPT",38,0)
 I NB W ?55,$E(NB,4,5),"/",$E(NB,6,7),"/",$E(NB,2,3)," "
"RTN","PSJDPT",39,0)
 I $D(^DPT(Y,.1)) W ?67,$P(^(.1),"^")
"RTN","PSJDPT",40,0)
 Q
"RTN","PSJDPT",41,0)
SENS W ?42,"*SENSITIVE* ",?55,"*SENSITIVE* ",?67,"*SENSITIVE*" Q
"VER")
8.0^22.0
**END**
**END**
