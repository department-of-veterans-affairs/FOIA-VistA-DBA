Released EN*7*76 SEQ #74
Extracted from mail message
**KIDS**:EN*7.0*76^

**INSTALL NAME**
EN*7.0*76
"BLD",4781,0)
EN*7.0*76^ENGINEERING^0^3030926^y
"BLD",4781,1,0)
^^1^1^3030529^
"BLD",4781,1,1,0)
CoreFLS Data Cleansing Reports for the Work Order (#6920) file.
"BLD",4781,4,0)
^9.64PA^^
"BLD",4781,"KRN",0)
^9.67PA^8989.52^19
"BLD",4781,"KRN",.4,0)
.4
"BLD",4781,"KRN",.401,0)
.401
"BLD",4781,"KRN",.402,0)
.402
"BLD",4781,"KRN",.403,0)
.403
"BLD",4781,"KRN",.5,0)
.5
"BLD",4781,"KRN",.84,0)
.84
"BLD",4781,"KRN",3.6,0)
3.6
"BLD",4781,"KRN",3.8,0)
3.8
"BLD",4781,"KRN",9.2,0)
9.2
"BLD",4781,"KRN",9.8,0)
9.8
"BLD",4781,"KRN",9.8,"NM",0)
^9.68A^7^7
"BLD",4781,"KRN",9.8,"NM",1,0)
ENH6920^^0^B34605991
"BLD",4781,"KRN",9.8,"NM",2,0)
ENH6920I^^0^B40599926
"BLD",4781,"KRN",9.8,"NM",3,0)
ENH6920L^^0^B82840916
"BLD",4781,"KRN",9.8,"NM",4,0)
ENH6920M^^0^B38247468
"BLD",4781,"KRN",9.8,"NM",5,0)
ENH6920P^^0^B39282807
"BLD",4781,"KRN",9.8,"NM",6,0)
ENH6920U^^0^B41698486
"BLD",4781,"KRN",9.8,"NM",7,0)
ENH6920H^^0^B65523077
"BLD",4781,"KRN",9.8,"NM","B","ENH6920",1)

"BLD",4781,"KRN",9.8,"NM","B","ENH6920H",7)

"BLD",4781,"KRN",9.8,"NM","B","ENH6920I",2)

"BLD",4781,"KRN",9.8,"NM","B","ENH6920L",3)

"BLD",4781,"KRN",9.8,"NM","B","ENH6920M",4)

"BLD",4781,"KRN",9.8,"NM","B","ENH6920P",5)

"BLD",4781,"KRN",9.8,"NM","B","ENH6920U",6)

"BLD",4781,"KRN",19,0)
19
"BLD",4781,"KRN",19,"NM",0)
^9.68A^7^7
"BLD",4781,"KRN",19,"NM",1,0)
ENH WORK ORDER^^0
"BLD",4781,"KRN",19,"NM",2,0)
ENH DATA CLEANSING^^2
"BLD",4781,"KRN",19,"NM",3,0)
ENH 6920 SUMMARY REPORT^^0
"BLD",4781,"KRN",19,"NM",4,0)
ENH 6920 REQUIRED RPT^^0
"BLD",4781,"KRN",19,"NM",5,0)
ENH 6920 LOOKUP RPT^^0
"BLD",4781,"KRN",19,"NM",6,0)
ENH 6920 NON-REQUIRED RPT^^0
"BLD",4781,"KRN",19,"NM",7,0)
ENH 6920 COMPILE^^0
"BLD",4781,"KRN",19,"NM","B","ENH 6920 COMPILE",7)

"BLD",4781,"KRN",19,"NM","B","ENH 6920 LOOKUP RPT",5)

"BLD",4781,"KRN",19,"NM","B","ENH 6920 NON-REQUIRED RPT",6)

"BLD",4781,"KRN",19,"NM","B","ENH 6920 REQUIRED RPT",4)

"BLD",4781,"KRN",19,"NM","B","ENH 6920 SUMMARY REPORT",3)

"BLD",4781,"KRN",19,"NM","B","ENH DATA CLEANSING",2)

"BLD",4781,"KRN",19,"NM","B","ENH WORK ORDER",1)

"BLD",4781,"KRN",19.1,0)
19.1
"BLD",4781,"KRN",101,0)
101
"BLD",4781,"KRN",409.61,0)
409.61
"BLD",4781,"KRN",771,0)
771
"BLD",4781,"KRN",870,0)
870
"BLD",4781,"KRN",8989.51,0)
8989.51
"BLD",4781,"KRN",8989.52,0)
8989.52
"BLD",4781,"KRN",8994,0)
8994
"BLD",4781,"KRN","B",.4,.4)

"BLD",4781,"KRN","B",.401,.401)

"BLD",4781,"KRN","B",.402,.402)

"BLD",4781,"KRN","B",.403,.403)

"BLD",4781,"KRN","B",.5,.5)

"BLD",4781,"KRN","B",.84,.84)

"BLD",4781,"KRN","B",3.6,3.6)

"BLD",4781,"KRN","B",3.8,3.8)

"BLD",4781,"KRN","B",9.2,9.2)

"BLD",4781,"KRN","B",9.8,9.8)

"BLD",4781,"KRN","B",19,19)

"BLD",4781,"KRN","B",19.1,19.1)

"BLD",4781,"KRN","B",101,101)

"BLD",4781,"KRN","B",409.61,409.61)

"BLD",4781,"KRN","B",771,771)

"BLD",4781,"KRN","B",870,870)

"BLD",4781,"KRN","B",8989.51,8989.51)

"BLD",4781,"KRN","B",8989.52,8989.52)

"BLD",4781,"KRN","B",8994,8994)

"BLD",4781,"QUES",0)
^9.62^^
"BLD",4781,"REQB",0)
^9.611^1^1
"BLD",4781,"REQB",1,0)
EN*7.0*74^0
"BLD",4781,"REQB","B","EN*7.0*74",1)

"KRN",19,11578,-1)
2^2
"KRN",19,11578,0)
ENH DATA CLEANSING^CoreFLS AEMS/MERS Data Cleansing Reports^^M^101009^ENH DATA CLEANSING^^^^^^33
"KRN",19,11578,10,0)
^19.01IP^7^7
"KRN",19,11578,10,6,0)
11703^6^6
"KRN",19,11578,10,6,"^")
ENH WORK ORDER
"KRN",19,11578,"U")
COREFLS AEMS/MERS DATA CLEANSI
"KRN",19,11703,-1)
0^1
"KRN",19,11703,0)
ENH WORK ORDER^Work Order # - 6920^^M^^ENH DATA CLEANSING^^^^^^ENGINEERING^^1
"KRN",19,11703,1,0)
^^2^2^3030916^
"KRN",19,11703,1,1,0)
This menu displays all of the CoreFLS Data Cleansing report options for
"KRN",19,11703,1,2,0)
AEMS/MERS WORK ORDER # (#6920) file.
"KRN",19,11703,10,0)
^19.01IP^6^5
"KRN",19,11703,10,1,0)
11720^2^2
"KRN",19,11703,10,1,"^")
ENH 6920 SUMMARY REPORT
"KRN",19,11703,10,3,0)
11725^1^1
"KRN",19,11703,10,3,"^")
ENH 6920 COMPILE
"KRN",19,11703,10,4,0)
11721^3^3
"KRN",19,11703,10,4,"^")
ENH 6920 REQUIRED RPT
"KRN",19,11703,10,5,0)
11722^4^4
"KRN",19,11703,10,5,"^")
ENH 6920 LOOKUP RPT
"KRN",19,11703,10,6,0)
11723^5^5
"KRN",19,11703,10,6,"^")
ENH 6920 NON-REQUIRED RPT
"KRN",19,11703,20)
W !! I $D(^XTMP("ENH6920",0)) D EN^DDIOL("Last Work Order compile done on "_$$FMTE^XLFDT($P(^XTMP("ENH6920",0),U,2)),,"!!")
"KRN",19,11703,25)

"KRN",19,11703,99)
59344,60049
"KRN",19,11703,"U")
WORK ORDER # - 6920
"KRN",19,11720,-1)
0^3
"KRN",19,11720,0)
ENH 6920 SUMMARY REPORT^Summary Report^^R^^^^^^^^ENGINEERING^^1^1
"KRN",19,11720,1,0)
^^5^5^3030918^
"KRN",19,11720,1,1,0)
This option prints or displays the CoreFLS Data Cleansing Summary Report
"KRN",19,11720,1,2,0)
for the WORK ORDER # (#6920) file. The report shows the fields being
"KRN",19,11720,1,3,0)
checked and the total number of times that required fields and 
"KRN",19,11720,1,4,0)
non-required fields are missing data and the total number of times that
"KRN",19,11720,1,5,0)
lookup fields have invalid data.
"KRN",19,11720,15)
W !! I $D(^XTMP("ENH6920",0)) D EN^DDIOL("Last Work Order compile done on "_$$FMTE^XLFDT($P(^XTMP("ENH6920",0),U,2)),,"!!")
"KRN",19,11720,20)
S ENHRPT=1
"KRN",19,11720,25)
REPTYP^ENH6920
"KRN",19,11720,"U")
SUMMARY REPORT
"KRN",19,11721,-1)
0^4
"KRN",19,11721,0)
ENH 6920 REQUIRED RPT^Required Fields Missing Data Report^^R^^^^^^^^ENGINEERING^^1^1
"KRN",19,11721,1,0)
^^3^3^3030918^
"KRN",19,11721,1,1,0)
This option prints or displays the CoreFLS Data Cleansing Required Fields
"KRN",19,11721,1,2,0)
Missing Data Report for the WORK ORDER # (#6920) file. The report lists
"KRN",19,11721,1,3,0)
the required fields that are empty and that you must correct.
"KRN",19,11721,15)
W !! I $D(^XTMP("ENH6920",0)) D EN^DDIOL("Last Work Order compile done on "_$$FMTE^XLFDT($P(^XTMP("ENH6920",0),U,2)),,"!!")
"KRN",19,11721,20)
S ENHRPT=2
"KRN",19,11721,25)
REPTYP^ENH6920
"KRN",19,11721,"U")
REQUIRED FIELDS MISSING DATA R
"KRN",19,11722,-1)
0^5
"KRN",19,11722,0)
ENH 6920 LOOKUP RPT^Lookup Fields w/ Invalid Data Report^^R^^^^^^^^ENGINEERING^^1^1
"KRN",19,11722,1,0)
^^4^4^3030918^
"KRN",19,11722,1,1,0)
This option prints or displays the CoreFLS Data Cleansing Lookup Fields w/
"KRN",19,11722,1,2,0)
Invalid Data Report for the WORK ORDER # (#6920) file. The report lists
"KRN",19,11722,1,3,0)
the lookup fields that contain an invalid value in the pointer field that 
"KRN",19,11722,1,4,0)
you must correct.
"KRN",19,11722,15)
W !! I $D(^XTMP("ENH6920",0)) D EN^DDIOL("Last Work Order compile done on "_$$FMTE^XLFDT($P(^XTMP("ENH6920",0),U,2)),,"!!")
"KRN",19,11722,20)
S ENHRPT=3
"KRN",19,11722,25)
REPTYP^ENH6920
"KRN",19,11722,"U")
LOOKUP FIELDS W/ INVALID DATA 
"KRN",19,11723,-1)
0^6
"KRN",19,11723,0)
ENH 6920 NON-REQUIRED RPT^Non-Required Fields Missing Data Report^^R^^^^^^^^ENGINEERING^^1^1
"KRN",19,11723,1,0)
^^3^3^3030918^
"KRN",19,11723,1,1,0)
This option prints or displays the CoreFLS Data Cleansing Non-Required
"KRN",19,11723,1,2,0)
Fields Missing Data Report for the WORK ORDER # (#6920) file. The report
"KRN",19,11723,1,3,0)
lists the non-required fields that are empty and that you should correct.
"KRN",19,11723,15)
W !! I $D(^XTMP("ENH6920",0)) D EN^DDIOL("Last Work Order compile done on "_$$FMTE^XLFDT($P(^XTMP("ENH6920",0),U,2)),,"!!")
"KRN",19,11723,20)
S ENHRPT=4
"KRN",19,11723,25)
REPTYP^ENH6920
"KRN",19,11723,"U")
NON-REQUIRED FIELDS MISSING DA
"KRN",19,11725,-1)
0^7
"KRN",19,11725,0)
ENH 6920 COMPILE^Compile Work Order List for Reports^^R^^^^^^^^ENGINEERING^^^
"KRN",19,11725,1,0)
^^3^3^3030918^
"KRN",19,11725,1,1,0)
This option MUST be run prior to using any of the report options. If you
"KRN",19,11725,1,2,0)
have already compiled a Work Order list for the reports, you do not need
"KRN",19,11725,1,3,0)
to select this option unless you need a new listing.
"KRN",19,11725,15)

"KRN",19,11725,25)
COMPILE^ENH6920
"KRN",19,11725,"U")
COMPILE WORK ORDER LIST FOR RE
"MBREQ")
0
"ORD",18,19)
19;18;;;OPT^XPDTA;OPTF1^XPDIA;OPTE1^XPDIA;OPTF2^XPDIA;;OPTDEL^XPDIA
"ORD",18,19,0)
OPTION
"PKG",33,-1)
1^1
"PKG",33,0)
ENGINEERING^EN^AUTOMATED ENGINEERING MANAGEMENT SYSTEM
"PKG",33,20,0)
^9.402P^^
"PKG",33,22,0)
^9.49I^1^1
"PKG",33,22,1,0)
7.0^2930817^2960130
"PKG",33,22,1,"PAH",1,0)
76^3030926
"PKG",33,22,1,"PAH",1,1,0)
^^1^1^3030926
"PKG",33,22,1,"PAH",1,1,1,0)
CoreFLS Data Cleansing Reports for the Work Order (#6920) file.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
7
"RTN","ENH6920")
0^1^B34605991
"RTN","ENH6920",1,0)
ENH6920 ;WOIFO/EEN - Work Order Report Driver (AMES/MERS) - CoreFLS ;09/26/03 16:54
"RTN","ENH6920",2,0)
 ;;7.0;Engineering;**76**;Aug 17,1993
"RTN","ENH6920",3,0)
 ;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","ENH6920",4,0)
 ;
"RTN","ENH6920",5,0)
 Q  ;This routine is not callable from the top
"RTN","ENH6920",6,0)
 ;
"RTN","ENH6920",7,0)
 ;This routine contains the entry points from the 6920 report options.
"RTN","ENH6920",8,0)
 ;
"RTN","ENH6920",9,0)
REPTYP ; Entry point for printing reports
"RTN","ENH6920",10,0)
 I '$D(DT)!'$D(U) D DT^DICRW
"RTN","ENH6920",11,0)
 S ABORT=0
"RTN","ENH6920",12,0)
 D HOME^%ZIS
"RTN","ENH6920",13,0)
 ;W @IOF,"WORK ORDER # (#6920)"
"RTN","ENH6920",14,0)
 ; Make sure no one else is currently compiling the list of Work Orders
"RTN","ENH6920",15,0)
 L +^XTMP("ENH6920"):1 E  D EN^DDIOL("Work Order compile in progress. Please try again later.",,"!!") G EXIT
"RTN","ENH6920",16,0)
 ; Display date of last compile (if there was one).
"RTN","ENH6920",17,0)
 I $D(^XTMP("ENH6920",0)) D EN^DDIOL("Last Work Order compile done on "_$$FMTE^XLFDT($P(^XTMP("ENH6920",0),U,2)),,"!!")
"RTN","ENH6920",18,0)
 L -^XTMP("ENH6920")
"RTN","ENH6920",19,0)
 ; Make sure last compile completed successfully. 
"RTN","ENH6920",20,0)
 ; Otherwise, do not allow user to print anything.
"RTN","ENH6920",21,0)
 I '$D(^XTMP("ENH6920",0))!('$D(^XTMP("ENH6920R",0))) D EN^DDIOL("*** Warning: Please compile the list of Work Orders first ***",,"!!") G EXIT
"RTN","ENH6920",22,0)
 I ENHRPT=1 S PRTRTN="OPT1^ENH6920P"
"RTN","ENH6920",23,0)
 I ENHRPT=2 S PRTRTN="OPT2^ENH6920P"
"RTN","ENH6920",24,0)
 I ENHRPT=3 S PRTRTN="OPT3^ENH6920P"
"RTN","ENH6920",25,0)
 I ENHRPT=4 S PRTRTN="OPT4^ENH6920P"
"RTN","ENH6920",26,0)
 ;D EN^DDIOL(" ",,"!!")
"RTN","ENH6920",27,0)
 D DIVM I ABORT G EXIT Q
"RTN","ENH6920",28,0)
 D INST^ENH6920U I ABORT G EXIT Q
"RTN","ENH6920",29,0)
 D DEVICE
"RTN","ENH6920",30,0)
 G EXIT
"RTN","ENH6920",31,0)
 Q
"RTN","ENH6920",32,0)
 ;
"RTN","ENH6920",33,0)
COMPILE ; Entry point for compile option
"RTN","ENH6920",34,0)
 I '$D(DT)!'$D(U) D DT^DICRW
"RTN","ENH6920",35,0)
 S ABORT=0
"RTN","ENH6920",36,0)
 D HOME^%ZIS
"RTN","ENH6920",37,0)
 ; Make sure no one else is currently compiling the list of Work Orders
"RTN","ENH6920",38,0)
 L +^XTMP("ENH6920"):1 E  D EN^DDIOL("Work Order compile in progress. Please try again later.",,"!!") G EXIT
"RTN","ENH6920",39,0)
 ; Display date of last compile (if there was one).
"RTN","ENH6920",40,0)
 I $D(^XTMP("ENH6920",0)) D EN^DDIOL("Last Work Order compile done on "_$$FMTE^XLFDT($P(^XTMP("ENH6920",0),U,2)),,"!!")
"RTN","ENH6920",41,0)
 L -^XTMP("ENH6920")
"RTN","ENH6920",42,0)
 D COMP
"RTN","ENH6920",43,0)
 ; If compile running in background (user selected 'NOW' in TaskMan) then kick the user out of the menu until complete.
"RTN","ENH6920",44,0)
 L +^XTMP("ENH6920"):1 E  G EXIT
"RTN","ENH6920",45,0)
 L -^XTMP("ENH6920")
"RTN","ENH6920",46,0)
 Q
"RTN","ENH6920",47,0)
 ;
"RTN","ENH6920",48,0)
DIVM ; Print by Division Prompt
"RTN","ENH6920",49,0)
 ;
"RTN","ENH6920",50,0)
 K DIR,ENHDIVFG,Y
"RTN","ENH6920",51,0)
 W !!," This report is sorted by division. You may select a single division or ALL."
"RTN","ENH6920",52,0)
 S DIVDIR="S^1:ALL",CNT=1,DIV=""
"RTN","ENH6920",53,0)
 F  S DIV=$O(^XTMP("ENH6920","DIV",DIV)) Q:DIV=""  D
"RTN","ENH6920",54,0)
 . S CNT=CNT+1
"RTN","ENH6920",55,0)
 . S DIVDIR=DIVDIR_";"_CNT_":"_DIV
"RTN","ENH6920",56,0)
 S DIR(0)=DIVDIR
"RTN","ENH6920",57,0)
 S DIR("A")="Please select a division (1-"_CNT_")"
"RTN","ENH6920",58,0)
 S DIR("A",1)=" "
"RTN","ENH6920",59,0)
 S DIR("B")=1
"RTN","ENH6920",60,0)
 S DIR("?")=" "
"RTN","ENH6920",61,0)
 S DIR("?",1)=" The list below contains the divisions that have been"
"RTN","ENH6920",62,0)
 S DIR("?",2)=" found in the LOCATION (#3) field in the WORK ORDER #"
"RTN","ENH6920",63,0)
 S DIR("?",3)=" (#6920) file."
"RTN","ENH6920",64,0)
 S DIR("?",4)=" "
"RTN","ENH6920",65,0)
 S DIR("?",5)=" Select ""ZZ no division"" to display the records with"
"RTN","ENH6920",66,0)
 S DIR("?",6)=" no entry in the LOCATION (#3) field."
"RTN","ENH6920",67,0)
 D ^DIR K DIR
"RTN","ENH6920",68,0)
 I Y[U!(Y="")!$D(DTOUT)!$D(DUOUT) S ABORT=1 Q
"RTN","ENH6920",69,0)
 S ENHDIVFG=Y(0)
"RTN","ENH6920",70,0)
 Q
"RTN","ENH6920",71,0)
 ;
"RTN","ENH6920",72,0)
DEVICE ; Ask the user for a device to print to (queuing is allowed).
"RTN","ENH6920",73,0)
 W !
"RTN","ENH6920",74,0)
 S %ZIS="Q"
"RTN","ENH6920",75,0)
 D ^%ZIS I POP S ABORT=1 Q
"RTN","ENH6920",76,0)
 ;User has decided to Queue report
"RTN","ENH6920",77,0)
 I $D(IO("Q")) D  Q
"RTN","ENH6920",78,0)
 . S ZTSAVE("ENHRPT")="",ZTSAVE("ENHDIVFG")="",ZTSAVE("ENHINST")=""
"RTN","ENH6920",79,0)
 . S ZTRTN=PRTRTN
"RTN","ENH6920",80,0)
 . S ZTDESC="CoreFLS DATA QUALITY REPORT (File# 6920 - WORK ORDER)"
"RTN","ENH6920",81,0)
 . D ^%ZTLOAD,HOME^%ZIS
"RTN","ENH6920",82,0)
 . K ZTSK,ZTSAVE,ZTRTN,ZTDESC
"RTN","ENH6920",83,0)
 D @PRTRTN
"RTN","ENH6920",84,0)
 Q
"RTN","ENH6920",85,0)
 ;
"RTN","ENH6920",86,0)
COMP ; Compile queuing prompt
"RTN","ENH6920",87,0)
 K DIR
"RTN","ENH6920",88,0)
 S DIR(0)="YA",DIR("B")="YES"
"RTN","ENH6920",89,0)
 S DIR("A")="Do you wish to queue the Work Order compile? "
"RTN","ENH6920",90,0)
 S DIR("A",1)=" "
"RTN","ENH6920",91,0)
 F I=1:1:6 S DIR("A",I+1)=$P($T(LIST+I),";;",2)
"RTN","ENH6920",92,0)
 S DIR("A",I+2)=" "
"RTN","ENH6920",93,0)
 S DIR("?")="Enter 'YES' to queue the Work Order compile or '^' to abort the compile."
"RTN","ENH6920",94,0)
 D ^DIR K DIR
"RTN","ENH6920",95,0)
 I $D(DTOUT)!$D(DUOUT) D EN^DDIOL("<Work Order Compile Aborted> ",,"!!?10") G EX
"RTN","ENH6920",96,0)
 I Y D  G EX
"RTN","ENH6920",97,0)
 . S ZTIO="NULL",ZTDESC="CoreFLS Data Cleansing Reports Work Order List",ZTRTN="TASK^ENH6920"
"RTN","ENH6920",98,0)
 . D ^%ZTLOAD
"RTN","ENH6920",99,0)
 . I $G(ZTSK)]"" D EN^DDIOL("Compile's TaskMan ID is "_ZTSK,"","!!?10")
"RTN","ENH6920",100,0)
 . K ZTSK
"RTN","ENH6920",101,0)
 . Q
"RTN","ENH6920",102,0)
 D EN^DDIOL("Compiling Work Order list ...",,"!!?10")
"RTN","ENH6920",103,0)
TASK    ; Setup an ^XTMP holding area for the Work Order list
"RTN","ENH6920",104,0)
 L +^XTMP("ENH6920"):5 E  D:'$D(ZTQUEUED) EN^DDIOL("*** Aborted: another Work Order compile is currently running ***",,"!!?10") G:'$D(ZTQUEUED) EX G EXIT
"RTN","ENH6920",105,0)
 K ^XTMP("ENH6920")
"RTN","ENH6920",106,0)
 K ^XTMP("ENH6920R")
"RTN","ENH6920",107,0)
 ; Start Work Order compile
"RTN","ENH6920",108,0)
 D ^ENH6920L
"RTN","ENH6920",109,0)
 ; Standard header for all ^XTMP globals.
"RTN","ENH6920",110,0)
 S X=$$FMADD^XLFDT(DT,30)
"RTN","ENH6920",111,0)
 S ^XTMP("ENH6920",0)=X_U_DT_U_"CoreFLS Work Order List by Field"
"RTN","ENH6920",112,0)
 S ^XTMP("ENH6920R",0)=X_U_DT_U_"CoreFLS Work Order List by Record"
"RTN","ENH6920",113,0)
 L -^XTMP("ENH6920")
"RTN","ENH6920",114,0)
 I $D(ZTQUEUED) S ZTREQ="@"
"RTN","ENH6920",115,0)
 ;
"RTN","ENH6920",116,0)
EX0     K DA,DIR,DIRUT,DTOUT,DUOUT,X,Y,%ZIS
"RTN","ENH6920",117,0)
 Q
"RTN","ENH6920",118,0)
EX      K DIR S DIR(0)="E" D ^DIR
"RTN","ENH6920",119,0)
 K DA,DIR,DIRUT,DTOUT,DUOUT,X,Y,%ZIS
"RTN","ENH6920",120,0)
 Q
"RTN","ENH6920",121,0)
EXIT ;
"RTN","ENH6920",122,0)
 K P,L,ABORT,ENFLG,TOTANA,CRITREC,BPTREC,DESREC,CHKTYP,FLDNAME,FLDNUM
"RTN","ENH6920",123,0)
 K PRTRTN,DIR,ENHRPT,ENHDIVFG,ENHDIV,ENHDR,DIV,SFIEN,FLD,RECIEN,RECNUM
"RTN","ENH6920",124,0)
 K NAME,ENHDIVCT,CNT,DIVDIR,DTOUT,DUOUT,POP,Y,ZTIO,I,ENHQFLG
"RTN","ENH6920",125,0)
 K DESFLD,ENHHELP1,ENHHELP2,ENHMNU1,ENHMNU2,DIVCT,%ZIS,ENHINST
"RTN","ENH6920",126,0)
 K MULTIEN,FLDANA,EQIDBPT,ENTRBPT,ENTRDES,IEN,LOCBPT,LOCIDCRT,ENFILE
"RTN","ENH6920",127,0)
 K PRIORDES,RECANA,TASKDES,TECHBPT,TECHDES,SORTFL,STATCRT,SHOPBPT
"RTN","ENH6920",128,0)
 K SHOPDES,TSHOPBPT,TSHOPDES,TYP,WACTBPT,WACTDES,WCCBPT,WCCDES,WPERDES
"RTN","ENH6920",129,0)
 Q
"RTN","ENH6920",130,0)
 ;
"RTN","ENH6920",131,0)
LIST ; Prompt text for Compile option
"RTN","ENH6920",132,0)
 ;;Compile may take 30 minutes or more depending on the size of your database.
"RTN","ENH6920",133,0)
 ;;Answering 'NO' will start the compile immediately in the foreground and your
"RTN","ENH6920",134,0)
 ;;terminal will be unresponsive until it completes. Answering 'YES' will allow
"RTN","ENH6920",135,0)
 ;;you to schedule the compile. Note that once the compile begins you will not
"RTN","ENH6920",136,0)
 ;;be allowed to access these options until it completes.
"RTN","ENH6920",137,0)
 ;;You may also enter '^' to abort the compile.
"RTN","ENH6920H")
0^7^B65523077
"RTN","ENH6920H",1,0)
ENH6920H ;WOIFO/EEN - Work Order Report Headers (AMES/MERS) - CoreFLS ;09/26/03 16:55
"RTN","ENH6920H",2,0)
 ;;7.0;Engineering;**76**;Aug 17,1993
"RTN","ENH6920H",3,0)
 ;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","ENH6920H",4,0)
 ;
"RTN","ENH6920H",5,0)
 Q  ;This routine is not callable from the top
"RTN","ENH6920H",6,0)
 ;
"RTN","ENH6920H",7,0)
 ; This routine contains the resort of XTMP and report headers for the
"RTN","ENH6920H",8,0)
 ; Work Order (#6920) file
"RTN","ENH6920H",9,0)
 ;
"RTN","ENH6920H",10,0)
SORT ; Re-sort XTMP for RECORD sort
"RTN","ENH6920H",11,0)
 ;
"RTN","ENH6920H",12,0)
 S EN1="",ENFILE="ENH6920",ENFILE1="ENH6920R"
"RTN","ENH6920H",13,0)
 K ^XTMP(ENFILE1)
"RTN","ENH6920H",14,0)
 F  S EN1=$O(^XTMP(ENFILE,EN1)) Q:EN1=""  D
"RTN","ENH6920H",15,0)
 . S EN2=""
"RTN","ENH6920H",16,0)
 . F  S EN2=$O(^XTMP(ENFILE,EN1,EN2)) Q:EN2=""  D
"RTN","ENH6920H",17,0)
 .. S EN3=0
"RTN","ENH6920H",18,0)
 .. F  S EN3=$O(^XTMP(ENFILE,EN1,EN2,EN3)) Q:'EN3  D
"RTN","ENH6920H",19,0)
 ... S EN4=0
"RTN","ENH6920H",20,0)
 ... F  S EN4=$O(^XTMP(ENFILE,EN1,EN2,EN3,EN4)) Q:'EN4  D
"RTN","ENH6920H",21,0)
 .... I EN3=.0201!(EN3=.022)!(EN3=35) D MSORT Q
"RTN","ENH6920H",22,0)
 .... S ^XTMP(ENFILE1,EN1,EN2,EN4,EN3)=^XTMP(ENFILE,EN1,EN2,EN3,EN4)
"RTN","ENH6920H",23,0)
 K EN1,EN2,EN3,EN4,EN5,ENFILE,ENFILE1
"RTN","ENH6920H",24,0)
 Q
"RTN","ENH6920H",25,0)
 ;
"RTN","ENH6920H",26,0)
MSORT ; Re-sort for multiples by RECORD
"RTN","ENH6920H",27,0)
 ;
"RTN","ENH6920H",28,0)
 Q:EN4=""
"RTN","ENH6920H",29,0)
 S EN5=0
"RTN","ENH6920H",30,0)
 F  S EN5=$O(^XTMP(ENFILE,EN1,EN2,EN3,EN4,EN5)) Q:'EN5  D
"RTN","ENH6920H",31,0)
 . S ^XTMP(ENFILE1,EN1,EN2,EN4,EN3,EN5)=^XTMP(ENFILE,EN1,EN2,EN3,EN4,EN5)
"RTN","ENH6920H",32,0)
 Q
"RTN","ENH6920H",33,0)
 ;
"RTN","ENH6920H",34,0)
SHDR ; Summary Report Header
"RTN","ENH6920H",35,0)
 W !!,"Totals for the """_^XTMP(ENFILE,DIV,0)_""" Division:"
"RTN","ENH6920H",36,0)
 W ! F I=1:1:65 W "-"
"RTN","ENH6920H",37,0)
 W !,"Total records analyzed",?55,$J(TOTANA,8)
"RTN","ENH6920H",38,0)
 W !,"Total records with Required Fields Missing Data",?55,$J(CRITREC,8)
"RTN","ENH6920H",39,0)
 W !,"Total records with Lookup Fields w/ Invalid Data",?55,$J(BPTREC,8)
"RTN","ENH6920H",40,0)
 W !,"Total records with Non-Required Fields Missing Data",?55,$J(DESREC,8)
"RTN","ENH6920H",41,0)
 S L=L+7
"RTN","ENH6920H",42,0)
 Q
"RTN","ENH6920H",43,0)
 ;
"RTN","ENH6920H",44,0)
CHDR ; Required Fields w/ Missing Data Report Header
"RTN","ENH6920H",45,0)
 W !!,"Totals for the """_^XTMP(ENFILE,DIV,0)_""" Division:"
"RTN","ENH6920H",46,0)
 W ! F I=1:1:65 W "-"
"RTN","ENH6920H",47,0)
 W !,"Total records analyzed",?55,$J(TOTANA,8)
"RTN","ENH6920H",48,0)
 W !,"Total records with Required Fields Missing Data",?55,$J(RECANA,8)
"RTN","ENH6920H",49,0)
 W !,"Total fields with Required Fields Missing Data",?55,$J(FLDANA,8)
"RTN","ENH6920H",50,0)
 S L=L+6
"RTN","ENH6920H",51,0)
 Q
"RTN","ENH6920H",52,0)
 ;
"RTN","ENH6920H",53,0)
BHDR ; Lookup Fields w/ Invalid Data Report Header
"RTN","ENH6920H",54,0)
 W !!,"Totals for the """_^XTMP(ENFILE,DIV,0)_""" Division:"
"RTN","ENH6920H",55,0)
 W ! F I=1:1:65 W "-"
"RTN","ENH6920H",56,0)
 W !,"Total records analyzed",?55,$J(TOTANA,8)
"RTN","ENH6920H",57,0)
 W !,"Total records with Lookup Fields w/ Invalid Data",?55,$J(RECANA,8)
"RTN","ENH6920H",58,0)
 W !,"Total fields with Lookup Fields w/ Invalid Data",?55,$J(FLDANA,8)
"RTN","ENH6920H",59,0)
 S L=L+6
"RTN","ENH6920H",60,0)
 Q
"RTN","ENH6920H",61,0)
 ;
"RTN","ENH6920H",62,0)
DHDR ; Non-Required Fields w/ Missing Data Report Header
"RTN","ENH6920H",63,0)
 W !!,"Totals for the """_^XTMP(ENFILE,DIV,0)_""" Division:"
"RTN","ENH6920H",64,0)
 W ! F I=1:1:65 W "-"
"RTN","ENH6920H",65,0)
 W !,"Total records analyzed",?55,$J(TOTANA,8)
"RTN","ENH6920H",66,0)
 W !,"Total records with Non-Required Fields Missing Data",?55,$J(RECANA,8)
"RTN","ENH6920H",67,0)
 W !,"Total fields with Non-Required Fields Missing Data",?55,$J(FLDANA,8)
"RTN","ENH6920H",68,0)
 S L=L+6
"RTN","ENH6920H",69,0)
 Q
"RTN","ENH6920H",70,0)
 ;
"RTN","ENH6920H",71,0)
DETC ; Detailed Report Column Header
"RTN","ENH6920H",72,0)
 W !!,"REC",?10,"WORK ORDER",?45,"FIELD",?70,"MULTIPLE"
"RTN","ENH6920H",73,0)
 W !,"IEN",?10,"NUMBER",?45,"NAME",?70,"NUMBER"
"RTN","ENH6920H",74,0)
 W ! F I=1:1:80 W "="
"RTN","ENH6920H",75,0)
 S L=L+4
"RTN","ENH6920H",76,0)
 Q
"RTN","ENH6920H",77,0)
 ;
"RTN","ENH6920H",78,0)
SUMC ; Summary Report Column Header
"RTN","ENH6920H",79,0)
 W !!,"DATA QUALITY",?15,"FIELD",?31,"REQUIRED FIELDS",?48,"LOOKUP FIELDS",?65,"NON-REQ. FIELDS"
"RTN","ENH6920H",80,0)
 W !,"CHECK TYPE",?15,"NAME",?31,"MISSING DATA",?48,"W/ INVALID DATA",?65,"MISSING DATA"
"RTN","ENH6920H",81,0)
 W ! F I=1:1:80 W "="
"RTN","ENH6920H",82,0)
 S L=L+4
"RTN","ENH6920H",83,0)
 Q
"RTN","ENH6920H",84,0)
 ;
"RTN","ENH6920H",85,0)
NOMULT ; Column Header with out the Multiple Column
"RTN","ENH6920H",86,0)
 W !!,"REC",?10,"WORK ORDER",?45,"FIELD"
"RTN","ENH6920H",87,0)
 W !,"IEN",?10,"NUMBER",?45,"NAME"
"RTN","ENH6920H",88,0)
 W ! F I=1:1:80 W "="
"RTN","ENH6920H",89,0)
 S L=L+4
"RTN","ENH6920H",90,0)
 Q
"RTN","ENH6920H",91,0)
 ;
"RTN","ENH6920H",92,0)
DIVHDR ; Division Header for subsequent pages on reports
"RTN","ENH6920H",93,0)
 W !!,"For the """_^XTMP(ENFILE,DIV,0)_""" Division:"
"RTN","ENH6920H",94,0)
 W ! F I=1:1:65 W "-"
"RTN","ENH6920H",95,0)
 S L=L+3
"RTN","ENH6920H",96,0)
 Q
"RTN","ENH6920H",97,0)
 ;
"RTN","ENH6920H",98,0)
PRT3 ; Print Instructions for Broken Pointers Report
"RTN","ENH6920H",99,0)
 ;
"RTN","ENH6920H",100,0)
 S (P,L,ABORT)=0
"RTN","ENH6920H",101,0)
 S ENHDR="LOOKUP FIELDS W/ INVALID DATA"
"RTN","ENH6920H",102,0)
 S ENHDR1="Instructions"
"RTN","ENH6920H",103,0)
 U IO
"RTN","ENH6920H",104,0)
 D HDR^ENH6920U
"RTN","ENH6920H",105,0)
 W !!,"The purpose of this report is to display a list of all fields in the WORK"
"RTN","ENH6920H",106,0)
 W !,"ORDER # (#6920) file that contain an invalid value in a lookup-type or pointer"
"RTN","ENH6920H",107,0)
 W !,"field. An invalid value is defined as a value that either does not have an"
"RTN","ENH6920H",108,0)
 W !,"entry in the file to which it points, or the entry in the file pointed to has"
"RTN","ENH6920H",109,0)
 W !,"an empty NAME (#.01) field.  An entry and a name must be present in the file"
"RTN","ENH6920H",110,0)
 W !,"to which a field points."
"RTN","ENH6920H",111,0)
 S L=L+7
"RTN","ENH6920H",112,0)
 I L+5>IOSL D HDR^ENH6920U Q:ABORT
"RTN","ENH6920H",113,0)
 W !!,"Before you use this report, you may want to run the compile to ensure you are"
"RTN","ENH6920H",114,0)
 W !,"viewing the most recent modifications."
"RTN","ENH6920H",115,0)
 S L=L+3
"RTN","ENH6920H",116,0)
 I L+14>IOSL D HDR^ENH6920U Q:ABORT
"RTN","ENH6920H",117,0)
 W !!,"This report examines the following lookup fields:"
"RTN","ENH6920H",118,0)
 W !,"NOTE: Abbreviations for field names used on this report appear in quotes next"
"RTN","ENH6920H",119,0)
 W !,"to the field number"
"RTN","ENH6920H",120,0)
 W !!,"     LOCATION (#3)"
"RTN","ENH6920H",121,0)
 W !,"     ENTERED BY (#7.5)"
"RTN","ENH6920H",122,0)
 W !,"     SHOP (#9)"
"RTN","ENH6920H",123,0)
 W !,"     ASSIGNED TECH (TECHNICIANS ASSIGNED Multiple) (#6920.02,.01)"
"RTN","ENH6920H",124,0)
 W !,"     SHOP (TECHNICIANS ASSIGNED Multiple) (#6920.02,2) - ""Tech Assigned- Shop"""
"RTN","ENH6920H",125,0)
 W !,"     EQUIPMENT ID# (#18)"
"RTN","ENH6920H",126,0)
 W !,"     WORK ACTION (Multiple) (#6920.035,.01)"
"RTN","ENH6920H",127,0)
 W !,"     WORK CENTER CODE (#35.5)"
"RTN","ENH6920H",128,0)
 S L=L+13
"RTN","ENH6920H",129,0)
 I L+6>IOSL D HDR^ENH6920U Q:ABORT
"RTN","ENH6920H",130,0)
 W !!,"The report is sorted by division. When printing or viewing this report, you"
"RTN","ENH6920H",131,0)
 W !,"may select a single division or ALL. Select ""ZZ no division"" to display the"
"RTN","ENH6920H",132,0)
 W !,"records with no entry in the LOCATION (#3) field."
"RTN","ENH6920H",133,0)
 S L=L+4
"RTN","ENH6920H",134,0)
 I L+4>IOSL D HDR^ENH6920U Q:ABORT
"RTN","ENH6920H",135,0)
 W !!,"The totals for each division are as follows:"
"RTN","ENH6920H",136,0)
 S L=L+2
"RTN","ENH6920H",137,0)
 I L+5>IOSL D HDR^ENH6920U Q:ABORT
"RTN","ENH6920H",138,0)
 W !!,"Total records analyzed - number of records in the WORK ORDER # (#6920) file"
"RTN","ENH6920H",139,0)
 W !,"     assigned to the division"
"RTN","ENH6920H",140,0)
 S L=L+3
"RTN","ENH6920H",141,0)
 I L+5>IOSL D HDR^ENH6920U Q:ABORT
"RTN","ENH6920H",142,0)
 W !!,"Total records with Lookup Fields w/ Invalid Data - number of records that have"
"RTN","ENH6920H",143,0)
 W !,"     an invalid value in one or more of the lookup fields"
"RTN","ENH6920H",144,0)
 S L=L+3
"RTN","ENH6920H",145,0)
 I L+5>IOSL D HDR^ENH6920U Q:ABORT
"RTN","ENH6920H",146,0)
 W !!,"Total fields with Lookup Fields w/ Invalid Data - number of lookup fields with"
"RTN","ENH6920H",147,0)
 W !,"     invalid data"
"RTN","ENH6920H",148,0)
 S L=L+3
"RTN","ENH6920H",149,0)
 I L+7>IOSL D HDR^ENH6920U Q:ABORT
"RTN","ENH6920H",150,0)
 W !!,"The report lists each record in order by its internal entry number (IEN)."
"RTN","ENH6920H",151,0)
 W !,"Each row on the report contains the following columns:"
"RTN","ENH6920H",152,0)
 W !!,"REC IEN - lists the WORK ORDER # (#6920) file internal record number"
"RTN","ENH6920H",153,0)
 S L=L+5
"RTN","ENH6920H",154,0)
 I L+6>IOSL D HDR^ENH6920U Q:ABORT
"RTN","ENH6920H",155,0)
 W !!,"WORK ORDER NUMBER - WORK ORDER # (#.01) field"
"RTN","ENH6920H",156,0)
 W !!,"FIELD NAME - name or abbreviation of the lookup field"
"RTN","ENH6920H",157,0)
 S L=L+4
"RTN","ENH6920H",158,0)
 I L+4>IOSL D HDR^ENH6920U Q:ABORT
"RTN","ENH6920H",159,0)
 W !!,"MULTIPLE NUMBER - index number of the multiple"
"RTN","ENH6920H",160,0)
 S L=L+2
"RTN","ENH6920H",161,0)
 I L+6>IOSL D HDR^ENH6920U Q:ABORT
"RTN","ENH6920H",162,0)
 W !!,"You must correct every field that appears on this report prior to conversion."
"RTN","ENH6920H",163,0)
 W !,"Use AEMS/MERS to enter a valid value in the lookup field. If you have any"
"RTN","ENH6920H",164,0)
 W !,"difficulties correcting these fields, contact the IRM or ADPAC for assistance."
"RTN","ENH6920H",165,0)
 S L=L+4
"RTN","ENH6920H",166,0)
 I L+13>IOSL D HDR^ENH6920U Q:ABORT
"RTN","ENH6920H",167,0)
 W !!,"*** Special Note *************************************************"
"RTN","ENH6920H",168,0)
 W !,"The following are multiple-type fields:"
"RTN","ENH6920H",169,0)
 W !,"     ASSIGNED TECH (#6920.02,.01)"
"RTN","ENH6920H",170,0)
 W !,"     SHOP (#6920.02,2)"
"RTN","ENH6920H",171,0)
 W !,"     WORK ACTION(#6920.035,.01)"
"RTN","ENH6920H",172,0)
 W !,"Multiple fields can occur many times within one WORK ORDER #"
"RTN","ENH6920H",173,0)
 W !,"(#6920) file record. All occurrences of these fields are examined."
"RTN","ENH6920H",174,0)
 W !,"The index number of the multiple with invalid data is displayed on"
"RTN","ENH6920H",175,0)
 W !,"this report."
"RTN","ENH6920H",176,0)
 W !,"******************************************************************"
"RTN","ENH6920H",177,0)
 S L=L+11
"RTN","ENH6920H",178,0)
 I L+8>IOSL D HDR^ENH6920U Q:ABORT
"RTN","ENH6920H",179,0)
 W !!,"**** Conversion Note *********************************************"
"RTN","ENH6920H",180,0)
 W !,"If any lookup field on this report is left with invalid data, it"
"RTN","ENH6920H",181,0)
 W !,"will be converted as empty into CoreFLS."
"RTN","ENH6920H",182,0)
 W !,"******************************************************************"
"RTN","ENH6920H",183,0)
 W !!,"<End of Instructions>" I $E(IOST,1,2)="C-" W "  Enter RETURN to continue or '^' to exit: " R Y:DTIME I '$T!(Y[U) S ABORT=1 Q
"RTN","ENH6920H",184,0)
 W @IOF
"RTN","ENH6920H",185,0)
 K Y,P,L,ENHDR,ENHDR1
"RTN","ENH6920H",186,0)
 Q
"RTN","ENH6920I")
0^2^B40599926
"RTN","ENH6920I",1,0)
ENH6920I ;WOIFO/EEN - Work Order Instructions (AMES/MERS) - CoreFLS ;09/26/03 16:55
"RTN","ENH6920I",2,0)
 ;;7.0;Engineering;**76**;Aug 17,1993
"RTN","ENH6920I",3,0)
 ;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","ENH6920I",4,0)
 ;
"RTN","ENH6920I",5,0)
 Q  ; This report is not callable from the top
"RTN","ENH6920I",6,0)
 ;
"RTN","ENH6920I",7,0)
 ;This routine contains the instructions for the Summary Report.
"RTN","ENH6920I",8,0)
 ;
"RTN","ENH6920I",9,0)
PRT1 ; Print Instructions for Summary Report
"RTN","ENH6920I",10,0)
 ;
"RTN","ENH6920I",11,0)
 S (P,L,ABORT)=0
"RTN","ENH6920I",12,0)
 S ENHDR="SUMMARY"
"RTN","ENH6920I",13,0)
 S ENHDR1="Instructions"
"RTN","ENH6920I",14,0)
 U IO
"RTN","ENH6920I",15,0)
 D HDR^ENH6920U
"RTN","ENH6920I",16,0)
 W !!,"The purpose of this report is to display the total number of records in the"
"RTN","ENH6920I",17,0)
 W !,"WORK ORDER # (#6920) file that have invalid or missing (empty) values in the"
"RTN","ENH6920I",18,0)
 W !,"fields that are being converted into the CoreFLS system.  The compile examines"
"RTN","ENH6920I",19,0)
 W !,"12 fields to determine if there is a valid value in each.  If there is no"
"RTN","ENH6920I",20,0)
 W !,"value in the field, it is considered to be empty. If there is a value in a"
"RTN","ENH6920I",21,0)
 W !,"lookup-type (a.k.a. pointer) field, the compile examines the value to ensure"
"RTN","ENH6920I",22,0)
 W !,"that it is valid."
"RTN","ENH6920I",23,0)
 S L=L+8
"RTN","ENH6920I",24,0)
 I L+5>IOSL D HDR^ENH6920U Q:ABORT
"RTN","ENH6920I",25,0)
 W !!,"Before you use this report, you may want to run the compile to ensure you are"
"RTN","ENH6920I",26,0)
 W !,"viewing the most recent modifications."
"RTN","ENH6920I",27,0)
 S L=L+3
"RTN","ENH6920I",28,0)
 I L+10>IOSL D HDR^ENH6920U Q:ABORT
"RTN","ENH6920I",29,0)
 W !!,"This report examines the following fields:"
"RTN","ENH6920I",30,0)
 W !,"NOTE: Abbreviations for field names used on this report appear in quotes next"
"RTN","ENH6920I",31,0)
 W !,"to the field number"
"RTN","ENH6920I",32,0)
 W !!,"     LOCATION (#3)"
"RTN","ENH6920I",33,0)
 W !,"     TASK DESCRIPTION (#6)"
"RTN","ENH6920I",34,0)
 W !,"     ENTERED BY (#7.5)"
"RTN","ENH6920I",35,0)
 S L=L+8
"RTN","ENH6920I",36,0)
 I L+11>IOSL D HDR^ENH6920U Q:ABORT
"RTN","ENH6920I",37,0)
 I $E(IOSL,1,2)'="C-"&(L<5) W ! S L=L+1
"RTN","ENH6920I",38,0)
 W !,"     SHOP (#9)"
"RTN","ENH6920I",39,0)
 W !,"     ASSIGNED TECH (TECHNICIANS ASSIGNED Multiple) (#6920.02,.01)"
"RTN","ENH6920I",40,0)
 W !,"     SHOP (TECHNICIANS ASSIGNED Multiple) (#6920.02,2) - ""Tech Assigned- Shop"""
"RTN","ENH6920I",41,0)
 W !,"     PRIORITY (#17)"
"RTN","ENH6920I",42,0)
 W !,"     EQUIPMENT ID# (#18)"
"RTN","ENH6920I",43,0)
 W !,"     STATUS (#32)"
"RTN","ENH6920I",44,0)
 W !,"     WORK ACTION (Multiple) (#6920.035,.01)"
"RTN","ENH6920I",45,0)
 W !,"     WORK CENTER CODE (#35.5)"
"RTN","ENH6920I",46,0)
 W !,"     WORK PERFORMED (#39)"
"RTN","ENH6920I",47,0)
 S L=L+9
"RTN","ENH6920I",48,0)
 I L+7>IOSL D HDR^ENH6920U Q:ABORT
"RTN","ENH6920I",49,0)
 W !!,"This report is sorted by division. When printing or viewing this report, you"
"RTN","ENH6920I",50,0)
 W !,"may select a single division or ALL. Select ""ZZ no division"" to display the"
"RTN","ENH6920I",51,0)
 W !,"records with no entry in the LOCATION (#3) field. The report lists the overall"
"RTN","ENH6920I",52,0)
 W !,"count of the number of problem records and fields detected."
"RTN","ENH6920I",53,0)
 S L=L+5
"RTN","ENH6920I",54,0)
 I L+4>IOSL D HDR^ENH6920U Q:ABORT
"RTN","ENH6920I",55,0)
 W !!,"The totals for each division are as follows:"
"RTN","ENH6920I",56,0)
 S L=L+2
"RTN","ENH6920I",57,0)
 I L+5>IOSL D HDR^ENH6920U Q:ABORT
"RTN","ENH6920I",58,0)
 W !!,"Total records analyzed - number of records in the WORK ORDER # (#6920) file"
"RTN","ENH6920I",59,0)
 W !,"     assigned to the division"
"RTN","ENH6920I",60,0)
 S L=L+3
"RTN","ENH6920I",61,0)
 I L+5>IOSL D HDR^ENH6920U Q:ABORT
"RTN","ENH6920I",62,0)
 W !!,"Total records with Required Fields Missing Data - number of records that have"
"RTN","ENH6920I",63,0)
 W !,"     at least one empty required field"
"RTN","ENH6920I",64,0)
 S L=L+3
"RTN","ENH6920I",65,0)
 I L+5>IOSL D HDR^ENH6920U Q:ABORT
"RTN","ENH6920I",66,0)
 W !!,"Total records with Lookup Fields w/ Invalid Data - number of records"
"RTN","ENH6920I",67,0)
 W !,"     that have invalid data in any of the lookup fields"
"RTN","ENH6920I",68,0)
 S L=L+3
"RTN","ENH6920I",69,0)
 I L+5>IOSL D HDR^ENH6920U Q:ABORT
"RTN","ENH6920I",70,0)
 W !!,"Total records with Non-Required Fields Missing Data - number of records"
"RTN","ENH6920I",71,0)
 W !,"     that have nothing in at least one non-required field"
"RTN","ENH6920I",72,0)
 S L=L+3
"RTN","ENH6920I",73,0)
 I L+5>IOSL D HDR^ENH6920U Q:ABORT
"RTN","ENH6920I",74,0)
 W !!,"Next, the report lists the counts for each individual field. The fields are"
"RTN","ENH6920I",75,0)
 W !,"listed in alphabetical order. Each row consists of the following columns:"
"RTN","ENH6920I",76,0)
 S L=L+3
"RTN","ENH6920I",77,0)
 I L+7>IOSL D HDR^ENH6920U Q:ABORT
"RTN","ENH6920I",78,0)
 W !!,"DATA QUALITY CHECK TYPE - tells whether the field was examined for:"
"RTN","ENH6920I",79,0)
 W !,"     REQ: required fields missing data"
"RTN","ENH6920I",80,0)
 W !,"     INV: invalid data"
"RTN","ENH6920I",81,0)
 W !,"     NREQ: non-required fields missing data"
"RTN","ENH6920I",82,0)
 S L=L+5
"RTN","ENH6920I",83,0)
 I L+5>IOSL D HDR^ENH6920U Q:ABORT
"RTN","ENH6920I",84,0)
 W !!,"FIELD NAME - name or abbreviation of the field from the WORK ORDER #"
"RTN","ENH6920I",85,0)
 W !,"     (#6920) file"
"RTN","ENH6920I",86,0)
 S L=L+3
"RTN","ENH6920I",87,0)
 I L+5>IOSL D HDR^ENH6920U Q:ABORT
"RTN","ENH6920I",88,0)
 W !!,"REQUIRED FIELDS MISSING DATA - count of the number of empty required fields"
"RTN","ENH6920I",89,0)
 W !,"     (""N/A"" appears in this column if the field is not required by CoreFLS.)"
"RTN","ENH6920I",90,0)
 S L=L+3
"RTN","ENH6920I",91,0)
 I L+6>IOSL D HDR^ENH6920U Q:ABORT
"RTN","ENH6920I",92,0)
 W !!,"LOOKUP FIELDS W/ INVALID DATA - count of the number of lookup fields that"
"RTN","ENH6920I",93,0)
 W !,"contain an invalid value  (""N/A"" appears in this column if the field is"
"RTN","ENH6920I",94,0)
 W !,"     not a lookup field.)"
"RTN","ENH6920I",95,0)
 S L=L+4
"RTN","ENH6920I",96,0)
 I L+6>IOSL D HDR^ENH6920U Q:ABORT
"RTN","ENH6920I",97,0)
 W !!,"NON-REQ. FIELDS WITH MISSING DATA - count of the number of empty non-required"
"RTN","ENH6920I",98,0)
 W !,"     fields (""N/A"" appears in this column if non-required does not apply"
"RTN","ENH6920I",99,0)
 W !,"     to this field.)"
"RTN","ENH6920I",100,0)
 S L=L+4
"RTN","ENH6920I",101,0)
 I L+11>IOSL D HDR^ENH6920U Q:ABORT
"RTN","ENH6920I",102,0)
 W !!,"*** Special Note *************************************************"
"RTN","ENH6920I",103,0)
 W !,"LOCATION and EQUIPMENT ID# are two fields that are checked"
"RTN","ENH6920I",104,0)
 W !,"together. It is required that at least one of these two fields"
"RTN","ENH6920I",105,0)
 W !,"have data for CoreFLS.  In other words if both fields are empty"
"RTN","ENH6920I",106,0)
 W !,"for a record, the record is flagged to be corrected. Entering data"
"RTN","ENH6920I",107,0)
 W !,"in either of the two fields corrects the record so it no longer"
"RTN","ENH6920I",108,0)
 W !,"appears on the report. These fields are noted on this report as"
"RTN","ENH6920I",109,0)
 W !,"""Location/Equip ID#""."
"RTN","ENH6920I",110,0)
 S L=L+9
"RTN","ENH6920I",111,0)
 I L+13>IOSL D HDR^ENH6920U Q:ABORT
"RTN","ENH6920I",112,0)
 W !!,"The following are multiple-type fields:"
"RTN","ENH6920I",113,0)
 W !,"     ASSIGNED TECH (#6920.02,.01)"
"RTN","ENH6920I",114,0)
 W !,"     SHOP (#6920.02,2)"
"RTN","ENH6920I",115,0)
 W !,"     WORK ACTION(#6920.035,.01)"
"RTN","ENH6920I",116,0)
 W !,"Multiple fields can occur many times within one WORK ORDER #"
"RTN","ENH6920I",117,0)
 W !,"(#6920) file record. All occurrences of these fields are examined."
"RTN","ENH6920I",118,0)
 W !,"The index number of the multiple with invalid data is displayed on"
"RTN","ENH6920I",119,0)
 W !,"the detail reports."
"RTN","ENH6920I",120,0)
 W !,"******************************************************************"
"RTN","ENH6920I",121,0)
 W !!,"<End of Instructions>" I $E(IOST,1,2)="C-" W "  Enter RETURN to continue or '^' to exit: " R Y:DTIME I '$T!(Y[U) S ABORT=1 Q
"RTN","ENH6920I",122,0)
 W @IOF
"RTN","ENH6920I",123,0)
 K P,L,Y,ENHDR,ENHDR1
"RTN","ENH6920I",124,0)
 Q
"RTN","ENH6920L")
0^3^B82840916
"RTN","ENH6920L",1,0)
ENH6920L ;WOIFO/EEN - Work Order Report Loop (AEMS/MERS) - CoreFLS ;09/26/03 16:56
"RTN","ENH6920L",2,0)
 ;;7.0;ENGINEERING;**76**;Aug 17,1993
"RTN","ENH6920L",3,0)
 ;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","ENH6920L",4,0)
 ;
"RTN","ENH6920L",5,0)
INIT ; Initialize Variables
"RTN","ENH6920L",6,0)
 ;I $E(IOST,1,2)="C-" D WAIT^DICD
"RTN","ENH6920L",7,0)
 S (ENIEN,DIVCT,ENHDIVCT)=0,ENFILE="ENH6920"
"RTN","ENH6920L",8,0)
 K ^XTMP(ENFILE)
"RTN","ENH6920L",9,0)
 ;
"RTN","ENH6920L",10,0)
LOOP ; Initialize XTMP global with BAD records in file 6920 Work Orders
"RTN","ENH6920L",11,0)
 ;
"RTN","ENH6920L",12,0)
 F  S ENIEN=$O(^ENG(6920,ENIEN)) Q:'ENIEN  D
"RTN","ENH6920L",13,0)
 . S (CRITFLD,BPTFLD,DESFLD,CRITFLG,BPTFLG,DESFLG)=0
"RTN","ENH6920L",14,0)
 . S (ENHDIV,NAME,LOCPTER,ENTRPTER,SHOPPTER,TECHPTER,TSHOPTER)=""
"RTN","ENH6920L",15,0)
 . S (EQIDPTER,WACTPTER,WCCPTER)=""
"RTN","ENH6920L",16,0)
 . ;
"RTN","ENH6920L",17,0)
 . ; Get DIVISION using LOCATION if NULL then set to "ZZ no division"
"RTN","ENH6920L",18,0)
 . S ENHDIV=$P($G(^ENG(6920,ENIEN,0)),U,4)
"RTN","ENH6920L",19,0)
 . I ENHDIV'="" S ENHDIV=$P($G(^ENG("SP",ENHDIV,0)),U,10)
"RTN","ENH6920L",20,0)
 . I ENHDIV="" S ENHDIV="ZZ no division"
"RTN","ENH6920L",21,0)
 . ;
"RTN","ENH6920L",22,0)
 . ; Set DIVISION node in ^XTMP and initialize nodes for each DIVISION
"RTN","ENH6920L",23,0)
 . I '$D(^XTMP(ENFILE,"DIV",ENHDIV)) D
"RTN","ENH6920L",24,0)
 .. S DIVCT=DIVCT+1
"RTN","ENH6920L",25,0)
 .. S ^XTMP(ENFILE,"DIV",ENHDIV)=DIVCT
"RTN","ENH6920L",26,0)
 .. S ^XTMP(ENFILE,DIVCT,0)=ENHDIV
"RTN","ENH6920L",27,0)
 .. S ^XTMP(ENFILE,DIVCT,"SUM")="0^0^0^0"
"RTN","ENH6920L",28,0)
 .. S ^XTMP(ENFILE,DIVCT,"CRIT")="0"
"RTN","ENH6920L",29,0)
 .. S ^XTMP(ENFILE,DIVCT,"BPT")=0
"RTN","ENH6920L",30,0)
 .. S ^XTMP(ENFILE,DIVCT,"DES")=0
"RTN","ENH6920L",31,0)
 .. S ^XTMP(ENFILE,DIVCT,"CRIT",318)=0
"RTN","ENH6920L",32,0)
 .. S ^XTMP(ENFILE,DIVCT,"BPT",3)=0
"RTN","ENH6920L",33,0)
 .. S ^XTMP(ENFILE,DIVCT,"BPT",18)=0
"RTN","ENH6920L",34,0)
 .. S ^XTMP(ENFILE,DIVCT,"BPT",7.5)=0
"RTN","ENH6920L",35,0)
 .. S ^XTMP(ENFILE,DIVCT,"BPT",9)=0
"RTN","ENH6920L",36,0)
 .. S ^XTMP(ENFILE,DIVCT,"BPT",.0201)=0
"RTN","ENH6920L",37,0)
 .. S ^XTMP(ENFILE,DIVCT,"BPT",.022)=0
"RTN","ENH6920L",38,0)
 .. S ^XTMP(ENFILE,DIVCT,"BPT",35)=0
"RTN","ENH6920L",39,0)
 .. S ^XTMP(ENFILE,DIVCT,"BPT",35.5)=0
"RTN","ENH6920L",40,0)
 .. S ^XTMP(ENFILE,DIVCT,"DES",6)=0
"RTN","ENH6920L",41,0)
 .. S ^XTMP(ENFILE,DIVCT,"DES",7.5)=0
"RTN","ENH6920L",42,0)
 .. S ^XTMP(ENFILE,DIVCT,"DES",9)=0
"RTN","ENH6920L",43,0)
 .. S ^XTMP(ENFILE,DIVCT,"DES",.0201)=0
"RTN","ENH6920L",44,0)
 .. S ^XTMP(ENFILE,DIVCT,"DES",.022)=0
"RTN","ENH6920L",45,0)
 .. S ^XTMP(ENFILE,DIVCT,"DES",17)=0
"RTN","ENH6920L",46,0)
 .. S ^XTMP(ENFILE,DIVCT,"DES",32)=0
"RTN","ENH6920L",47,0)
 .. S ^XTMP(ENFILE,DIVCT,"DES",35)=0
"RTN","ENH6920L",48,0)
 .. S ^XTMP(ENFILE,DIVCT,"DES",35.5)=0
"RTN","ENH6920L",49,0)
 .. S ^XTMP(ENFILE,DIVCT,"DES",39)=0
"RTN","ENH6920L",50,0)
 . ;
"RTN","ENH6920L",51,0)
 . ; Nodes that have been initialized or that already exist
"RTN","ENH6920L",52,0)
 . I $D(^XTMP(ENFILE,"DIV",ENHDIV)) D
"RTN","ENH6920L",53,0)
 .. S ENDIVCT=^XTMP(ENFILE,"DIV",ENHDIV)
"RTN","ENH6920L",54,0)
 . ;
"RTN","ENH6920L",55,0)
 . ; Get NAME (.01 field)
"RTN","ENH6920L",56,0)
 . S NAME=$P($G(^ENG(6920,ENIEN,0)),U)
"RTN","ENH6920L",57,0)
 . ;
"RTN","ENH6920L",58,0)
 . ; **Add up Critical Null fields**
"RTN","ENH6920L",59,0)
 . ; -- LOCATION and EQUIPMENT ID# (Check for Crit Null) --
"RTN","ENH6920L",60,0)
 . I $P($G(^ENG(6920,ENIEN,0)),U,4)=""&($P($G(^ENG(6920,ENIEN,3)),U,8)="") D
"RTN","ENH6920L",61,0)
 .. S CRITFLD=CRITFLD+1,CRITFLG=1
"RTN","ENH6920L",62,0)
 .. S ^XTMP(ENFILE,ENDIVCT,"CRIT",318)=^XTMP(ENFILE,ENDIVCT,"CRIT",318)+1
"RTN","ENH6920L",63,0)
 .. S ^XTMP(ENFILE,ENDIVCT,"CRIT",318,ENIEN)=ENIEN_U_NAME_U_"Location/Equip ID#"_U_"6920,3 and 6920,18"_U_"N/A"_U_"N/A"
"RTN","ENH6920L",64,0)
 . ;
"RTN","ENH6920L",65,0)
 . ; **Add up Broken Pointer fields**
"RTN","ENH6920L",66,0)
 . ; -- LOCATION (Check for Broken Pter) --
"RTN","ENH6920L",67,0)
 . S LOCPTER=$P($G(^ENG(6920,ENIEN,0)),U,4)
"RTN","ENH6920L",68,0)
 . I LOCPTER'="" D
"RTN","ENH6920L",69,0)
 .. I '$D(^ENG("SP",LOCPTER,0))!($P($G(^ENG("SP",LOCPTER,0)),U)="") D
"RTN","ENH6920L",70,0)
 ... S BPTFLD=BPTFLD+1,BPTFLG=1
"RTN","ENH6920L",71,0)
 ... S ^XTMP(ENFILE,ENDIVCT,"BPT",3)=^XTMP(ENFILE,ENDIVCT,"BPT",3)+1
"RTN","ENH6920L",72,0)
 ... S ^XTMP(ENFILE,ENDIVCT,"BPT",3,ENIEN)=ENIEN_U_NAME_U_"Location"_U_"6920,3"_U_"N/A"_U_LOCPTER_U_"6928"
"RTN","ENH6920L",73,0)
 . ;
"RTN","ENH6920L",74,0)
 . ; -- ENTERED BY (Check for Broken Pter) --
"RTN","ENH6920L",75,0)
 . S ENTRPTER=$P($G(^ENG(6920,ENIEN,1)),U)
"RTN","ENH6920L",76,0)
 . I ENTRPTER'="" D
"RTN","ENH6920L",77,0)
 .. I '$D(^VA(200,ENTRPTER,0))!($P($G(^VA(200,ENTRPTER,0)),U)="") D
"RTN","ENH6920L",78,0)
 ... S BPTFLD=BPTFLD+1,BPTFLG=1
"RTN","ENH6920L",79,0)
 ... S ^XTMP(ENFILE,ENDIVCT,"BPT",7.5)=^XTMP(ENFILE,ENDIVCT,"BPT",7.5)+1
"RTN","ENH6920L",80,0)
 ... S ^XTMP(ENFILE,ENDIVCT,"BPT",7.5,ENIEN)=ENIEN_U_NAME_U_"Entered By"_U_"6920,7.5"_U_"N/A"_U_ENTRPTER_U_"200"
"RTN","ENH6920L",81,0)
 . ;
"RTN","ENH6920L",82,0)
 . ; -- SHOP (Check for Broken Pter) --
"RTN","ENH6920L",83,0)
 . S SHOPPTER=$P($G(^ENG(6920,ENIEN,2)),U)
"RTN","ENH6920L",84,0)
 . I SHOPPTER'="" D
"RTN","ENH6920L",85,0)
 .. I '$D(^DIC(6922,SHOPPTER,0))!($P($G(^DIC(6922,SHOPPTER,0)),U)="") D
"RTN","ENH6920L",86,0)
 ... S BPTFLD=BPTFLD+1,BPTFLG=1
"RTN","ENH6920L",87,0)
 ... S ^XTMP(ENFILE,ENDIVCT,"BPT",9)=^XTMP(ENFILE,ENDIVCT,"BPT",9)+1
"RTN","ENH6920L",88,0)
 ... S ^XTMP(ENFILE,ENDIVCT,"BPT",9,ENIEN)=ENIEN_U_NAME_U_"Shop"_U_"6928,9"_U_"N/A"_U_SHOPPTER_U_"6922"
"RTN","ENH6920L",89,0)
 . ;
"RTN","ENH6920L",90,0)
 . ; -- WORK CENTER CODE (Check for Broken Pter) --
"RTN","ENH6920L",91,0)
 . S WCCPTER=$P($G(^ENG(6920,ENIEN,5)),U,5)
"RTN","ENH6920L",92,0)
 . I WCCPTER'="" D
"RTN","ENH6920L",93,0)
 .. I '$D(^DIC(6921,WCCPTER,0))!($P($G(^DIC(6921,WCCPTER,0)),U)="") D
"RTN","ENH6920L",94,0)
 ... S BPTFLD=BPTFLD+1,BPTFLG=1
"RTN","ENH6920L",95,0)
 ... S ^XTMP(ENFILE,ENDIVCT,"BPT",35.5)=^XTMP(ENFILE,ENDIVCT,"BPT",35.5)+1
"RTN","ENH6920L",96,0)
 ... S ^XTMP(ENFILE,ENDIVCT,"BPT",35.5,ENIEN)=ENIEN_U_NAME_U_"Work Center Code"_U_"6920,35.5"_U_"N/A"_U_WCCPTER_U_"6921"
"RTN","ENH6920L",97,0)
 . ;
"RTN","ENH6920L",98,0)
 . ; -- EQUIPMENT ID# (Check for Broken Pter) --
"RTN","ENH6920L",99,0)
 . S EQIDPTER=$P($G(^ENG(6920,ENIEN,3)),U,8)
"RTN","ENH6920L",100,0)
 . I EQIDPTER'="" D
"RTN","ENH6920L",101,0)
 .. I '$D(^ENG(6914,EQIDPTER,0))!($P($G(^ENG(6914,EQIDPTER,0)),U)="") D
"RTN","ENH6920L",102,0)
 ... S BPTFLD=BPTFLD+1,BPTFLG=1
"RTN","ENH6920L",103,0)
 ... S ^XTMP(ENFILE,ENDIVCT,"BPT",18)=^XTMP(ENFILE,ENDIVCT,"BPT",18)+1
"RTN","ENH6920L",104,0)
 ... S ^XTMP(ENFILE,ENDIVCT,"BPT",18,ENIEN)=ENIEN_U_NAME_U_"Equipment ID#"_U_"6920,18"_U_"N/A"_U_EQIDPTER_U_"6914"
"RTN","ENH6920L",105,0)
 . ;
"RTN","ENH6920L",106,0)
 . ; -- WORK ACTION multiple (Check for Broken Pters) --
"RTN","ENH6920L",107,0)
 . S UIEN=0
"RTN","ENH6920L",108,0)
 . F  S UIEN=$O(^ENG(6920,ENIEN,8,UIEN)) Q:'UIEN  D
"RTN","ENH6920L",109,0)
 .. S WACTPTER=$P($G(^ENG(6920,ENIEN,8,UIEN,0)),U)
"RTN","ENH6920L",110,0)
 .. I WACTPTER'="" D
"RTN","ENH6920L",111,0)
 ... I '$D(^ENG(6920.1,WACTPTER,0))!($P($G(^ENG(6920.1,WACTPTER,0)),U)="") D
"RTN","ENH6920L",112,0)
 .... S BPTFLD=BPTFLD+1,BPTFLG=1
"RTN","ENH6920L",113,0)
 .... S ^XTMP(ENFILE,ENDIVCT,"BPT",35)=^XTMP(ENFILE,ENDIVCT,"BPT",35)+1
"RTN","ENH6920L",114,0)
 .... S ^XTMP(ENFILE,ENDIVCT,"BPT",35,ENIEN,UIEN)=ENIEN_U_NAME_U_"Work Action"_U_"6920,35"_U_UIEN_U_WACTPTER_U_"6920.1"
"RTN","ENH6920L",115,0)
 . ;
"RTN","ENH6920L",116,0)
 . ; -- TECHNICIANS ASSIGNED multiple (Check for Broken Pters) --
"RTN","ENH6920L",117,0)
 . S UIEN=0
"RTN","ENH6920L",118,0)
 . F  S UIEN=$O(^ENG(6920,ENIEN,7,UIEN)) Q:'UIEN  D
"RTN","ENH6920L",119,0)
 .. S TECHPTER=$P($G(^ENG(6920,ENIEN,7,UIEN,0)),U)
"RTN","ENH6920L",120,0)
 .. I TECHPTER'="" D
"RTN","ENH6920L",121,0)
 ... I '$D(^ENG("EMP",TECHPTER,0))!($P($G(^ENG("EMP",TECHPTER,0)),U)="") D
"RTN","ENH6920L",122,0)
 .... S BPTFLD=BPTFLD+1,BPTFLG=1
"RTN","ENH6920L",123,0)
 .... S ^XTMP(ENFILE,ENDIVCT,"BPT",.0201)=^XTMP(ENFILE,ENDIVCT,"BPT",.0201)+1
"RTN","ENH6920L",124,0)
 .... S ^XTMP(ENFILE,ENDIVCT,"BPT",.0201,ENIEN,UIEN)=ENIEN_U_NAME_U_"Assigned Tech"_U_"6920.02,.01"_U_UIEN_U_TECHPTER_U_"6929"
"RTN","ENH6920L",125,0)
 ... S TSHOPTER=$P($G(^ENG(6920,ENIEN,7,UIEN,0)),U,3)
"RTN","ENH6920L",126,0)
 ... I TSHOPTER'="" D
"RTN","ENH6920L",127,0)
 .... I '$D(^DIC(6922,TSHOPTER,0))!($P($G(^DIC(6922,TSHOPTER,0)),U)="") D
"RTN","ENH6920L",128,0)
 ..... S BPTFLD=BPTFLD+1,BPTFLG=1
"RTN","ENH6920L",129,0)
 ..... S ^XTMP(ENFILE,ENDIVCT,"BPT",.022)=^XTMP(ENFILE,ENDIVCT,"BPT",.022)+1
"RTN","ENH6920L",130,0)
 ..... S ^XTMP(ENFILE,ENDIVCT,"BPT",.022,ENIEN,UIEN)=ENIEN_U_NAME_U_"Tech Assigned- Shop"_U_"6920.02,2"_U_UIEN_U_TSHOPTER_U_"6922"
"RTN","ENH6920L",131,0)
 . ;
"RTN","ENH6920L",132,0)
 . ; **Add up the Desirable Null fields**
"RTN","ENH6920L",133,0)
 . ; -- TASK DESCRIPTION (Check for Desirable Null)
"RTN","ENH6920L",134,0)
 . I $P($G(^ENG(6920,ENIEN,1)),U,2)="" D
"RTN","ENH6920L",135,0)
 .. S DESFLD=DESFLD+1,DESFLG=1
"RTN","ENH6920L",136,0)
 .. S ^XTMP(ENFILE,ENDIVCT,"DES",6)=^XTMP(ENFILE,ENDIVCT,"DES",6)+1
"RTN","ENH6920L",137,0)
 .. S ^XTMP(ENFILE,ENDIVCT,"DES",6,ENIEN)=ENIEN_U_NAME_U_"Task Description"_U_"6920,6"_U_"N/A"_U_"N/A"
"RTN","ENH6920L",138,0)
 . ;
"RTN","ENH6920L",139,0)
 . ; -- ENTERED BY (Check for Desirable Null)
"RTN","ENH6920L",140,0)
 . I $P($G(^ENG(6920,ENIEN,1)),U)="" D
"RTN","ENH6920L",141,0)
 .. S DESFLD=DESFLD+1,DESFLG=1
"RTN","ENH6920L",142,0)
 .. S ^XTMP(ENFILE,ENDIVCT,"DES",7.5)=^XTMP(ENFILE,ENDIVCT,"DES",7.5)+1
"RTN","ENH6920L",143,0)
 .. S ^XTMP(ENFILE,ENDIVCT,"DES",7.5,ENIEN)=ENIEN_U_NAME_U_"Entered By"_U_"6920,7.5"_U_"N/A"_U_"N/A"
"RTN","ENH6920L",144,0)
 . ;
"RTN","ENH6920L",145,0)
 . ; -- SHOP (Check for Desirable Null)
"RTN","ENH6920L",146,0)
 . I $P($G(^ENG(6920,ENIEN,2)),U)="" D
"RTN","ENH6920L",147,0)
 .. S DESFLD=DESFLD+1,DESFLG=1
"RTN","ENH6920L",148,0)
 .. S ^XTMP(ENFILE,ENDIVCT,"DES",9)=^XTMP(ENFILE,ENDIVCT,"DES",9)+1
"RTN","ENH6920L",149,0)
 .. S ^XTMP(ENFILE,ENDIVCT,"DES",9,ENIEN)=ENIEN_U_NAME_U_"Shop"_U_"6920,9"_U_"N/A"_U_"N/A"
"RTN","ENH6920L",150,0)
 . ;
"RTN","ENH6920L",151,0)
 . ; -- PRIORITY (Check for Desirable Null)
"RTN","ENH6920L",152,0)
 . I $P($G(^ENG(6920,ENIEN,2)),U,3)="" D
"RTN","ENH6920L",153,0)
 .. S DESFLD=DESFLD+1,DESFLG=1
"RTN","ENH6920L",154,0)
 .. S ^XTMP(ENFILE,ENDIVCT,"DES",17)=^XTMP(ENFILE,ENDIVCT,"DES",17)+1
"RTN","ENH6920L",155,0)
 .. S ^XTMP(ENFILE,ENDIVCT,"DES",17,ENIEN)=ENIEN_U_NAME_U_"Priority"_U_"6920,17"_U_"N/A"_U_"N/A"
"RTN","ENH6920L",156,0)
 . ;
"RTN","ENH6920L",157,0)
 . ; -- STATUS (Check for Desirable Null) --
"RTN","ENH6920L",158,0)
 . I $P($G(^ENG(6920,ENIEN,4)),U,3)="" D
"RTN","ENH6920L",159,0)
 .. S DESFLD=DESFLD+1,DESFLG=1
"RTN","ENH6920L",160,0)
 .. S ^XTMP(ENFILE,ENDIVCT,"DES",32)=^XTMP(ENFILE,ENDIVCT,"DES",32)+1
"RTN","ENH6920L",161,0)
 .. S ^XTMP(ENFILE,ENDIVCT,"DES",32,ENIEN)=ENIEN_U_NAME_U_"Status"_U_"6920,32"_U_"N/A"_U_"N/A"
"RTN","ENH6920L",162,0)
 . ;
"RTN","ENH6920L",163,0)
 . ; -- WORK CENTER CODE (Check for Desirable Null)
"RTN","ENH6920L",164,0)
 . I $P($G(^ENG(6920,ENIEN,5)),U,5)="" D
"RTN","ENH6920L",165,0)
 .. S DESFLD=DESFLD+1,DESFLG=1
"RTN","ENH6920L",166,0)
 .. S ^XTMP(ENFILE,ENDIVCT,"DES",35.5)=^XTMP(ENFILE,ENDIVCT,"DES",35.5)+1
"RTN","ENH6920L",167,0)
 .. S ^XTMP(ENFILE,ENDIVCT,"DES",35.5,ENIEN)=ENIEN_U_NAME_U_"Work Center Code"_U_"6920,35.5"_U_"N/A"_U_"N/A"
"RTN","ENH6920L",168,0)
 . ;
"RTN","ENH6920L",169,0)
 . ; -- WORK PERFORMED (Check for Desirable Null)
"RTN","ENH6920L",170,0)
 . I $P($G(^ENG(6920,ENIEN,5)),U,7)="" D
"RTN","ENH6920L",171,0)
 .. S DESFLD=DESFLD+1,DESFLG=1
"RTN","ENH6920L",172,0)
 .. S ^XTMP(ENFILE,ENDIVCT,"DES",39)=^XTMP(ENFILE,ENDIVCT,"DES",39)+1
"RTN","ENH6920L",173,0)
 .. S ^XTMP(ENFILE,ENDIVCT,"DES",39,ENIEN)=ENIEN_U_NAME_U_"Work Performed"_U_"6920,39"_U_"N/A"_U_"N/A"
"RTN","ENH6920L",174,0)
 . ;
"RTN","ENH6920L",175,0)
 . ; -- WORK ACTION multiple (Check for Desirable Null) --
"RTN","ENH6920L",176,0)
 . S UIEN=0 F  S UIEN=$O(^ENG(6920,ENIEN,8,UIEN)) Q:'UIEN  D
"RTN","ENH6920L",177,0)
 .. I $P($G(^ENG(6920,ENIEN,8,UIEN,0)),U)="" D
"RTN","ENH6920L",178,0)
 ... S DESFLD=DESFLD+1,DESFLG=1
"RTN","ENH6920L",179,0)
 ... S ^XTMP(ENFILE,ENDIVCT,"DES",35)=^XTMP(ENFILE,ENDIVCT,"DES",35)+1
"RTN","ENH6920L",180,0)
 ... S ^XTMP(ENFILE,ENDIVCT,"DES",35,ENIEN)=ENIEN_U_NAME_U_"Work Action"_U_"6920,39"_U_UIEN_U_"N/A"
"RTN","ENH6920L",181,0)
 . ;
"RTN","ENH6920L",182,0)
 . ; -- TECHNICIANS ASSIGNED multiple (Check for Desirable Null) --
"RTN","ENH6920L",183,0)
 . S UIEN=0 F  S UIEN=$O(^ENG(6920,ENIEN,7,UIEN)) Q:'UIEN  D
"RTN","ENH6920L",184,0)
 .. I $P($G(^ENG(6920,ENIEN,7,UIEN,0)),U)="" D
"RTN","ENH6920L",185,0)
 ... S DESFLD=DESFLD+1,DESFLG=1
"RTN","ENH6920L",186,0)
 ... S ^XTMP(ENFILE,ENDIVCT,"DES",.0201)=^XTMP(ENFILE,ENDIVCT,"DES",.0201)+1
"RTN","ENH6920L",187,0)
 ... S ^XTMP(ENFILE,ENDIVCT,"DES",.0201,ENIEN,UIEN)=ENIEN_U_NAME_U_"Assigned Tech"_U_"6920.02,.01"_U_UIEN_U_"N/A"
"RTN","ENH6920L",188,0)
 .. I $P($G(^ENG(6920,ENIEN,7,UIEN,0)),U,3)="" D
"RTN","ENH6920L",189,0)
 ... S DESFLD=DESFLD+1,DESFLG=1
"RTN","ENH6920L",190,0)
 ... S ^XTMP(ENFILE,ENDIVCT,"DES",.022)=^XTMP(ENFILE,ENDIVCT,"DES",.022)+1
"RTN","ENH6920L",191,0)
 ... S ^XTMP(ENFILE,ENDIVCT,"DES",.022,ENIEN,UIEN)=ENIEN_U_NAME_U_"Tech Assigned- Shop"_U_"6920.02,2"_U_UIEN_U_"N/A"
"RTN","ENH6920L",192,0)
 . ;
"RTN","ENH6920L",193,0)
 . D ADDCNT^ENH6920U
"RTN","ENH6920L",194,0)
 D SORT^ENH6920H ; Re-sort the XTMP to sort by RECORD not FIELD
"RTN","ENH6920L",195,0)
 Q
"RTN","ENH6920L",196,0)
 ;
"RTN","ENH6920L",197,0)
EXIT ; Kill all local variables
"RTN","ENH6920L",198,0)
 K ENIEN,ENHDIV,ENDIVCT,CRITFLD,BPTFLD,DESFLD,CRITFLG,BPTFLG,DESFLG
"RTN","ENH6920L",199,0)
 K DIVCT,LOCPTER,ENTRPTER,SHOPPTER,TECHPTER,TSHOPTER,EQIDPTER,WACTPTER
"RTN","ENH6920L",200,0)
 K UIEN,WCCPTER
"RTN","ENH6920L",201,0)
 Q
"RTN","ENH6920M")
0^4^B38247468
"RTN","ENH6920M",1,0)
ENH6920M ;WOIFO/EEN - Work Order Instructions (AMES/MERS) - CoreFLS ;09/26/03 16:56
"RTN","ENH6920M",2,0)
 ;;7.0;Engineering;**76**;Aug 17,1993
"RTN","ENH6920M",3,0)
 ;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","ENH6920M",4,0)
 ;
"RTN","ENH6920M",5,0)
 Q  ; This report is not callable from the top
"RTN","ENH6920M",6,0)
 ;
"RTN","ENH6920M",7,0)
 ;This routine contains the instructions for the Lookup Fields w/Invalid
"RTN","ENH6920M",8,0)
 ;Data and Non-Required Fields Missing Data reports.
"RTN","ENH6920M",9,0)
 ;
"RTN","ENH6920M",10,0)
PRT4 ; Print Instructions for Desirable Nulls Report
"RTN","ENH6920M",11,0)
 ;
"RTN","ENH6920M",12,0)
 S (P,L,ABORT)=0
"RTN","ENH6920M",13,0)
 S ENHDR="NON-REQUIRED FIELDS MISSING DATA"
"RTN","ENH6920M",14,0)
 S ENHDR1="Instructions"
"RTN","ENH6920M",15,0)
 U IO
"RTN","ENH6920M",16,0)
 D HDR^ENH6920U
"RTN","ENH6920M",17,0)
 W !!,"The purpose of this report is to display a list of WORK ORDER # (#6920)"
"RTN","ENH6920M",18,0)
 W !,"items with missing (empty) data for the fields that are not required in"
"RTN","ENH6920M",19,0)
 W !,"the CoreFLS system.  If fields appearing on this report are left empty, the"
"RTN","ENH6920M",20,0)
 W !,"conversion will either default to a value or convert the field as empty into"
"RTN","ENH6920M",21,0)
 W !,"the CoreFLS system."
"RTN","ENH6920M",22,0)
 S L=L+6
"RTN","ENH6920M",23,0)
 I L+5>IOSL D HDR^ENH6920U Q:ABORT
"RTN","ENH6920M",24,0)
 W !!,"Before you use this report, you may want to run the compile to ensure you are"
"RTN","ENH6920M",25,0)
 W !,"viewing the most recent modifications."
"RTN","ENH6920M",26,0)
 S L=L+3
"RTN","ENH6920M",27,0)
 I L+16>IOSL D HDR^ENH6920U Q:ABORT
"RTN","ENH6920M",28,0)
 W !!,"This report examines the following non-required fields:"
"RTN","ENH6920M",29,0)
 W !,"NOTE: Abbreviations for field names used on this report appear in quotes next"
"RTN","ENH6920M",30,0)
 W !,"to the field number"
"RTN","ENH6920M",31,0)
 W !!,"     TASK DESCRIPTION (#6)"
"RTN","ENH6920M",32,0)
 W !,"     ENTERED BY (#7.5)"
"RTN","ENH6920M",33,0)
 W !,"     SHOP (#9)"
"RTN","ENH6920M",34,0)
 W !,"     ASSIGNED TECH (TECHNICIANS ASSIGNED Multiple) (#6920.02,.01)"
"RTN","ENH6920M",35,0)
 W !,"     SHOP (TECHNICIANS ASSIGNED Multiple) (#6920.02,2) - ""Tech Assigned- Shop"""
"RTN","ENH6920M",36,0)
 W !,"     PRIORITY (#17)"
"RTN","ENH6920M",37,0)
 W !,"     STATUS (#32)"
"RTN","ENH6920M",38,0)
 W !,"     WORK ACTION (Multiple) (#6920.035,.01)"
"RTN","ENH6920M",39,0)
 W !,"     WORK CENTER CODE (#35.5)"
"RTN","ENH6920M",40,0)
 W !,"     WORK PERFORMED (#39)"
"RTN","ENH6920M",41,0)
 S L=L+15
"RTN","ENH6920M",42,0)
 I L+6>IOSL D HDR^ENH6920U Q:ABORT
"RTN","ENH6920M",43,0)
 W !!,"The report is sorted by division. When printing or viewing this report, you"
"RTN","ENH6920M",44,0)
 W !,"may select a single division or ALL. Select ""ZZ no division"" to display the"
"RTN","ENH6920M",45,0)
 W !,"records with no entry in the LOCATION (#3) field."
"RTN","ENH6920M",46,0)
 S L=L+4
"RTN","ENH6920M",47,0)
 I L+7>IOSL D HDR^ENH6920U Q:ABORT
"RTN","ENH6920M",48,0)
 W !!,"The totals for each division are as follows:"
"RTN","ENH6920M",49,0)
 W !!,"Total records analyzed - number of records in the WORK ORDER # (#6920) file"
"RTN","ENH6920M",50,0)
 W !,"     assigned to the division"
"RTN","ENH6920M",51,0)
 S L=L+5
"RTN","ENH6920M",52,0)
 I L+5>IOSL D HDR^ENH6920U Q:ABORT
"RTN","ENH6920M",53,0)
 W !!,"Total records with Non-Required Fields Missing Data - number of records that"
"RTN","ENH6920M",54,0)
 W !,"     have one or more empty non-required fields"
"RTN","ENH6920M",55,0)
 S L=L+3
"RTN","ENH6920M",56,0)
 I L+5>IOSL D HDR^ENH6920U Q:ABORT
"RTN","ENH6920M",57,0)
 W !!,"Total fields with Non-Required Fields Missing Data - number of non-required"
"RTN","ENH6920M",58,0)
 W !,"     fields that are empty"
"RTN","ENH6920M",59,0)
 S L=L+3
"RTN","ENH6920M",60,0)
 I L+5>IOSL D HDR^ENH6920U Q:ABORT
"RTN","ENH6920M",61,0)
 W !!,"The report then lists each record in order by its internal entry number (IEN)."
"RTN","ENH6920M",62,0)
 W !,"Each row contains the following columns:"
"RTN","ENH6920M",63,0)
 S L=L+3
"RTN","ENH6920M",64,0)
 I L+4>IOSL D HDR^ENH6920U Q:ABORT
"RTN","ENH6920M",65,0)
 W !!,"REC IEN - lists the WORK ORDER # (#6920) file internal record number"
"RTN","ENH6920M",66,0)
 S L=L+2
"RTN","ENH6920M",67,0)
 I L+4>IOSL D HDR^ENH6920U Q:ABORT
"RTN","ENH6920M",68,0)
 W !!,"WORK ORDER NUMBER - WORK ORDER # (#.01) field"
"RTN","ENH6920M",69,0)
 S L=L+2
"RTN","ENH6920M",70,0)
 I L+4>IOSL D HDR^ENH6920U Q:ABORT
"RTN","ENH6920M",71,0)
 W !!,"FIELD NAME - name of the non-required field"
"RTN","ENH6920M",72,0)
 S L=L+2
"RTN","ENH6920M",73,0)
 I L+4>IOSL D HDR^ENH6920U Q:ABORT
"RTN","ENH6920M",74,0)
 W !!,"MULTIPLE NUMBER - index number of the multiple"
"RTN","ENH6920M",75,0)
 S L=L+2
"RTN","ENH6920M",76,0)
 I L+8>IOSL D HDR^ENH6920U Q:ABORT
"RTN","ENH6920M",77,0)
 W !!,"You should correct every field that appears on this report prior to conversion."
"RTN","ENH6920M",78,0)
 W !,"Use AEMS/MERS to enter a valid value in each empty field listed."
"RTN","ENH6920M",79,0)
 S L=L+6
"RTN","ENH6920M",80,0)
 I L+13>IOSL D HDR^ENH6920U Q:ABORT
"RTN","ENH6920M",81,0)
 W !!,"*** Special Note *************************************************"
"RTN","ENH6920M",82,0)
 W !,"The following are multiple-type fields:"
"RTN","ENH6920M",83,0)
 W !,"     ASSIGNED TECH (#6920.02,.01)"
"RTN","ENH6920M",84,0)
 W !,"     SHOP (#6920.02,2)"
"RTN","ENH6920M",85,0)
 W !,"     WORK ACTION(#6920.035,.01)"
"RTN","ENH6920M",86,0)
 W !,"Multiple fields can occur many times within one WORK ORDER #"
"RTN","ENH6920M",87,0)
 W !,"(#6920) file record. All occurrences of these fields are examined."
"RTN","ENH6920M",88,0)
 W !,"The index number of the multiple with invalid data is displayed on"
"RTN","ENH6920M",89,0)
 W !,"this report."
"RTN","ENH6920M",90,0)
 W !,"******************************************************************"
"RTN","ENH6920M",91,0)
 S L=L+11
"RTN","ENH6920M",92,0)
 I L+15>IOSL D HDR^ENH6920U Q:ABORT
"RTN","ENH6920M",93,0)
 W !!,"*** Conversion Note  *********************************************"
"RTN","ENH6920M",94,0)
 W !,"If the non-required fields are left empty, the following will"
"RTN","ENH6920M",95,0)
 W !,"occur during CoreFLS conversion:"
"RTN","ENH6920M",96,0)
 W !!,"TASK DESCRIPTION (#6) - Data in WORK PERFORMED (#39) will be used"
"RTN","ENH6920M",97,0)
 W !,"                        as the default. If both fields are empty"
"RTN","ENH6920M",98,0)
 W !,"                        then the Task Description will be"
"RTN","ENH6920M",99,0)
 W !,"                        converted as empty"
"RTN","ENH6920M",100,0)
 W !!,"ENTERED BY (#7.5) - Default is ""MAXIMO"""
"RTN","ENH6920M",101,0)
 W !!,"PRIORITY (#17) - Default is 0 (zero)"
"RTN","ENH6920M",102,0)
 S L=L+13
"RTN","ENH6920M",103,0)
 I L+14>IOSL D HDR^ENH6920U Q:ABORT
"RTN","ENH6920M",104,0)
 W !!,"STATUS (#32) - when STATUS is empty and:"
"RTN","ENH6920M",105,0)
 W !,"   DATE COMPLETED is:     DATE STARTED is:     DEFAULT STATUS is:"
"RTN","ENH6920M",106,0)
 W !,"     empty                  not empty            ""In Progress"""
"RTN","ENH6920M",107,0)
 W !,"     empty                  empty                ""Waiting for Approval"""
"RTN","ENH6920M",108,0)
 W !,"     not empty              > 6 months*          ""Completed"""
"RTN","ENH6920M",109,0)
 W !,"     not empty              =< 6 months*         ""Closed"""
"RTN","ENH6920M",110,0)
 W !!,"                            *from the scheduled deployment date"
"RTN","ENH6920M",111,0)
 W !!,"    WARNING: Fields in ""Closed"" orders may not be editable after"
"RTN","ENH6920M",112,0)
 W !,"    conversion to CoreFLS"
"RTN","ENH6920M",113,0)
 S L=L+12
"RTN","ENH6920M",114,0)
 I L+11>IOSL D HDR^ENH6920U Q:ABORT
"RTN","ENH6920M",115,0)
 W !!,"WORK CENTER CODE (#35.5) - If the first two characters of the"
"RTN","ENH6920M",116,0)
 W !,"                           Work Order # is ""PM"" then the default"
"RTN","ENH6920M",117,0)
 W !,"                           will be ""PM"", otherwise the default"
"RTN","ENH6920M",118,0)
 W !,"                           will be ""CM"""
"RTN","ENH6920M",119,0)
 W !!,"All other non-required fields will be converted as empty."
"RTN","ENH6920M",120,0)
 W !,"******************************************************************"
"RTN","ENH6920M",121,0)
 W !!,"<End of Instructions>" I $E(IOST,1,2)="C-" W "  Enter RETURN to continue or '^' to exit: " R Y:DTIME I '$T!(Y[U) S ABORT=1 Q
"RTN","ENH6920M",122,0)
 W @IOF
"RTN","ENH6920M",123,0)
 K Y,P,L,ENHDR,ENHDR1
"RTN","ENH6920M",124,0)
 Q
"RTN","ENH6920P")
0^5^B39282807
"RTN","ENH6920P",1,0)
ENH6920P ;WOIFO/EEN - Work Order Report Print (AMES/MERS) - CoreFLS ;09/26/03  16:56
"RTN","ENH6920P",2,0)
 ;;7.0;Engineering;**76**;Aug 17,1993
"RTN","ENH6920P",3,0)
 ;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","ENH6920P",4,0)
 ;
"RTN","ENH6920P",5,0)
 Q  ;This routine is not callable from the top
"RTN","ENH6920P",6,0)
 ;
"RTN","ENH6920P",7,0)
 ; This routine prints Summary and Detailed Reports for the
"RTN","ENH6920P",8,0)
 ; Work Order (#6920) file
"RTN","ENH6920P",9,0)
 ;
"RTN","ENH6920P",10,0)
INIT ; Initialize Variables
"RTN","ENH6920P",11,0)
 S (P,L,ABORT,ENFLG,TOTANA,RECANA,FLDANA,CRITREC,BPTREC,DESREC)=0
"RTN","ENH6920P",12,0)
 S (CRITREC,BPTREC,DESREC)=0,ENFILE="ENH6920",ENFILE1="ENH6920R"
"RTN","ENH6920P",13,0)
 S (CHKTYP,FLDNAME,FLDNUM,DIV,DIVI,NAME,TYP)=""
"RTN","ENH6920P",14,0)
 K ENHDR1
"RTN","ENH6920P",15,0)
 Q
"RTN","ENH6920P",16,0)
 ;
"RTN","ENH6920P",17,0)
OPT1 ; Print Summary Report
"RTN","ENH6920P",18,0)
 I ENHINST=1 D PRT1^ENH6920I Q:ABORT
"RTN","ENH6920P",19,0)
 D INIT
"RTN","ENH6920P",20,0)
 S ENHDR="SUMMARY"
"RTN","ENH6920P",21,0)
 I ENHDIVFG="ALL" D
"RTN","ENH6920P",22,0)
 . S ENHDIV=" for ALL Divisions",DIVI=""
"RTN","ENH6920P",23,0)
 . F  S DIVI=$O(^XTMP(ENFILE,"DIV",DIVI)) Q:DIVI=""!(ENFLG=1)  D
"RTN","ENH6920P",24,0)
 .. S DIV=^XTMP(ENFILE,"DIV",DIVI)
"RTN","ENH6920P",25,0)
 .. D L1
"RTN","ENH6920P",26,0)
 I ENHDIVFG'="ALL" D
"RTN","ENH6920P",27,0)
 . S ENHDIV=" for "_ENHDIVFG_" Division"
"RTN","ENH6920P",28,0)
 . S DIV=$G(^XTMP(ENFILE,"DIV",ENHDIVFG))
"RTN","ENH6920P",29,0)
 . D L1
"RTN","ENH6920P",30,0)
 D EORT^ENH6920U
"RTN","ENH6920P",31,0)
 K DIVI
"RTN","ENH6920P",32,0)
 Q
"RTN","ENH6920P",33,0)
L1 ; Print for Summary Report
"RTN","ENH6920P",34,0)
 U IO
"RTN","ENH6920P",35,0)
 D HDR^ENH6920U
"RTN","ENH6920P",36,0)
 I ABORT S ENFLG=1 Q
"RTN","ENH6920P",37,0)
 S TOTANA=$P($G(^XTMP(ENFILE,DIV,"SUM")),U)
"RTN","ENH6920P",38,0)
 S CRITREC=$P($G(^XTMP(ENFILE,DIV,"SUM")),U,2)
"RTN","ENH6920P",39,0)
 S BPTREC=$P($G(^XTMP(ENFILE,DIV,"SUM")),U,3)
"RTN","ENH6920P",40,0)
 S DESREC=$P($G(^XTMP(ENFILE,DIV,"SUM")),U,4)
"RTN","ENH6920P",41,0)
 S LOCIDCRT=^XTMP(ENFILE,DIV,"CRIT",318)
"RTN","ENH6920P",42,0)
 ;S STATCRT=^XTMP(ENFILE,DIV,"CRIT",32)
"RTN","ENH6920P",43,0)
 S LOCBPT=^XTMP(ENFILE,DIV,"BPT",3)
"RTN","ENH6920P",44,0)
 S ENTRBPT=^XTMP(ENFILE,DIV,"BPT",7.5)
"RTN","ENH6920P",45,0)
 S SHOPBPT=^XTMP(ENFILE,DIV,"BPT",9)
"RTN","ENH6920P",46,0)
 S TECHBPT=^XTMP(ENFILE,DIV,"BPT",.0201)
"RTN","ENH6920P",47,0)
 S TSHOPBPT=^XTMP(ENFILE,DIV,"BPT",.022)
"RTN","ENH6920P",48,0)
 S EQIDBPT=^XTMP(ENFILE,DIV,"BPT",18)
"RTN","ENH6920P",49,0)
 S WACTBPT=^XTMP(ENFILE,DIV,"BPT",35)
"RTN","ENH6920P",50,0)
 S WCCBPT=^XTMP(ENFILE,DIV,"BPT",35.5)
"RTN","ENH6920P",51,0)
 S TASKDES=^XTMP(ENFILE,DIV,"DES",6)
"RTN","ENH6920P",52,0)
 S ENTRDES=^XTMP(ENFILE,DIV,"DES",7.5)
"RTN","ENH6920P",53,0)
 S SHOPDES=^XTMP(ENFILE,DIV,"DES",9)
"RTN","ENH6920P",54,0)
 S TECHDES=^XTMP(ENFILE,DIV,"DES",.0201)
"RTN","ENH6920P",55,0)
 S TSHOPDES=^XTMP(ENFILE,DIV,"DES",.022)
"RTN","ENH6920P",56,0)
 S PRIORDES=^XTMP(ENFILE,DIV,"DES",17)
"RTN","ENH6920P",57,0)
 S STATCRT=^XTMP(ENFILE,DIV,"DES",32)
"RTN","ENH6920P",58,0)
 S WACTDES=^XTMP(ENFILE,DIV,"DES",35)
"RTN","ENH6920P",59,0)
 S WCCDES=^XTMP(ENFILE,DIV,"DES",35.5)
"RTN","ENH6920P",60,0)
 S WPERDES=^XTMP(ENFILE,DIV,"DES",39)
"RTN","ENH6920P",61,0)
 D SHDR^ENH6920H,SUMC^ENH6920H
"RTN","ENH6920P",62,0)
 W !,"INV, NREQ",?15,"Assigned Tech",?35,$J("N/A",5),?52,$J(TECHBPT,5)
"RTN","ENH6920P",63,0)
 W ?69,$J(TECHDES,5)
"RTN","ENH6920P",64,0)
 W !,"INV, NREQ",?15,"Entered By",?35,$J("N/A",5),?52,$J(ENTRBPT,5)
"RTN","ENH6920P",65,0)
 W ?69,$J(ENTRDES,5)
"RTN","ENH6920P",66,0)
 W !,"INV",?15,"Equipment ID#",?35,$J("N/A",5),?52,$J(EQIDBPT,5)
"RTN","ENH6920P",67,0)
 W ?69,$J("N/A",5)
"RTN","ENH6920P",68,0)
 W !,"INV",?15,"Location",?35,$J("N/A",5),?52,$J(LOCBPT,5)
"RTN","ENH6920P",69,0)
 W ?69,$J("N/A",5)
"RTN","ENH6920P",70,0)
 W !,"REQ",?15,"Location/Equip ID#",?35,$J(LOCIDCRT,5),?52,$J("N/A",5)
"RTN","ENH6920P",71,0)
 W ?69,$J("N/A",5)
"RTN","ENH6920P",72,0)
 W !,"NREQ",?15,"Priority",?35,$J("N/A",5),?52,$J("N/A",5)
"RTN","ENH6920P",73,0)
 W ?69,$J(PRIORDES,5)
"RTN","ENH6920P",74,0)
 W !,"INV, NREQ",?15,"Shop",?35,$J("N/A",5),?52,$J(SHOPBPT,5)
"RTN","ENH6920P",75,0)
 W ?69,$J(SHOPDES,5)
"RTN","ENH6920P",76,0)
 W !,"NREQ",?15,"Status",?35,$J("N/A",5),?52,$J("N/A",5)
"RTN","ENH6920P",77,0)
 W ?69,$J(STATCRT,5)
"RTN","ENH6920P",78,0)
 S L=L+8
"RTN","ENH6920P",79,0)
 I L+7>IOSL D  Q:ABORT
"RTN","ENH6920P",80,0)
 . D HDR^ENH6920U
"RTN","ENH6920P",81,0)
 . I ABORT S ENFLG=1 Q
"RTN","ENH6920P",82,0)
 . D DIVHDR^ENH6920H,SUMC^ENH6920H
"RTN","ENH6920P",83,0)
 W !,"NREQ",?15,"Task Description",?35,$J("N/A",5),?52,$J("N/A",5)
"RTN","ENH6920P",84,0)
 W ?69,$J(TASKDES,5)
"RTN","ENH6920P",85,0)
 W !,"INV, NREQ",?15,"Tech Assigned- Shop",?35,$J("N/A",5),?52
"RTN","ENH6920P",86,0)
 W $J(TSHOPBPT,5),?69,$J(TSHOPDES,5)
"RTN","ENH6920P",87,0)
 W !,"INV, NREQ",?15,"Work Action",?35,$J("N/A",5),?52,$J(WACTBPT,5)
"RTN","ENH6920P",88,0)
 W ?69,$J(WACTDES,5)
"RTN","ENH6920P",89,0)
 W !,"INV, NREQ",?15,"Work Center Code",?35,$J("N/A",5),?52,$J(WCCBPT,5)
"RTN","ENH6920P",90,0)
 W ?69,$J(WCCDES,5)
"RTN","ENH6920P",91,0)
 W !,"NREQ",?15,"Work Performed",?35,$J("N/A",5),?52,$J("N/A",5)
"RTN","ENH6920P",92,0)
 W ?69,$J(WPERDES,5)
"RTN","ENH6920P",93,0)
 S L=L+6
"RTN","ENH6920P",94,0)
 I ENHDIVFG'="ALL" S ENFLG=1 ; Stop print if single division is picked
"RTN","ENH6920P",95,0)
 Q
"RTN","ENH6920P",96,0)
 ;
"RTN","ENH6920P",97,0)
OPT2 ; Required Fields Missing Data Report
"RTN","ENH6920P",98,0)
 I ENHINST=1 D PRT2^ENH6920U Q:ABORT
"RTN","ENH6920P",99,0)
 D INIT
"RTN","ENH6920P",100,0)
 S TYP="CRIT"
"RTN","ENH6920P",101,0)
 S ENHDR="REQUIRED FIELDS MISSING DATA"
"RTN","ENH6920P",102,0)
 G PRT
"RTN","ENH6920P",103,0)
 Q
"RTN","ENH6920P",104,0)
OPT3 ; Lookup Fields with Invalid Data Report
"RTN","ENH6920P",105,0)
 I ENHINST=1 D PRT3^ENH6920H Q:ABORT
"RTN","ENH6920P",106,0)
 D INIT
"RTN","ENH6920P",107,0)
 S TYP="BPT"
"RTN","ENH6920P",108,0)
 S ENHDR="LOOKUP FIELDS W/ INVALID DATA"
"RTN","ENH6920P",109,0)
 G PRT
"RTN","ENH6920P",110,0)
 Q
"RTN","ENH6920P",111,0)
 ;
"RTN","ENH6920P",112,0)
OPT4 ; Non-Required Fields Missing Data Report
"RTN","ENH6920P",113,0)
 I ENHINST=1 D PRT4^ENH6920M Q:ABORT
"RTN","ENH6920P",114,0)
 D INIT
"RTN","ENH6920P",115,0)
 S TYP="DES"
"RTN","ENH6920P",116,0)
 S ENHDR="NON-REQUIRED FIELDS MISSING DATA"
"RTN","ENH6920P",117,0)
 G PRT
"RTN","ENH6920P",118,0)
 Q
"RTN","ENH6920P",119,0)
 ;
"RTN","ENH6920P",120,0)
PRT ; Start printing detailed reports by division
"RTN","ENH6920P",121,0)
 I ENHDIVFG="ALL" D
"RTN","ENH6920P",122,0)
 . S ENHDIV=" for ALL Divisions",DIVI=""
"RTN","ENH6920P",123,0)
 . F  S DIVI=$O(^XTMP(ENFILE,"DIV",DIVI)) Q:DIVI=""!(ENFLG=1)  D
"RTN","ENH6920P",124,0)
 .. S DIV=^XTMP(ENFILE,"DIV",DIVI)
"RTN","ENH6920P",125,0)
 .. D LOOP
"RTN","ENH6920P",126,0)
 I ENHDIVFG'="ALL" D
"RTN","ENH6920P",127,0)
 . S ENHDIV=" for "_ENHDIVFG_" Division"
"RTN","ENH6920P",128,0)
 . S DIV=^XTMP(ENFILE,"DIV",ENHDIVFG)
"RTN","ENH6920P",129,0)
 . D LOOP
"RTN","ENH6920P",130,0)
 D EORT^ENH6920U
"RTN","ENH6920P",131,0)
 K DIVI
"RTN","ENH6920P",132,0)
 Q
"RTN","ENH6920P",133,0)
 ;
"RTN","ENH6920P",134,0)
LOOP ; Loop to print out regular fields
"RTN","ENH6920P",135,0)
 U IO
"RTN","ENH6920P",136,0)
 Q:TYP=""!(DIV="")
"RTN","ENH6920P",137,0)
 ;D SORT ; To re-sort by record instead of by field
"RTN","ENH6920P",138,0)
 S TOTANA=$P($G(^XTMP(ENFILE,DIV,"SUM")),U)
"RTN","ENH6920P",139,0)
 I TYP="CRIT" S RECANA=$P($G(^XTMP(ENFILE,DIV,"SUM")),U,2)
"RTN","ENH6920P",140,0)
 I TYP="BPT" S RECANA=$P($G(^XTMP(ENFILE,DIV,"SUM")),U,3)
"RTN","ENH6920P",141,0)
 I TYP="DES" S RECANA=$P($G(^XTMP(ENFILE,DIV,"SUM")),U,4)
"RTN","ENH6920P",142,0)
 S FLDANA=^XTMP(ENFILE,DIV,TYP)
"RTN","ENH6920P",143,0)
 D HDR^ENH6920U
"RTN","ENH6920P",144,0)
 I ABORT S ENFLG=1 Q
"RTN","ENH6920P",145,0)
 I TYP="CRIT" D CHDR^ENH6920H,NOMULT^ENH6920H
"RTN","ENH6920P",146,0)
 I TYP="BPT" D BHDR^ENH6920H,DETC^ENH6920H
"RTN","ENH6920P",147,0)
 I TYP="DES" D DHDR^ENH6920H,DETC^ENH6920H
"RTN","ENH6920P",148,0)
 I FLDANA=0&(RECANA=0) D  Q
"RTN","ENH6920P",149,0)
 . W !!,"**NO DATA TO PRINT**",!
"RTN","ENH6920P",150,0)
 . S L=L+3
"RTN","ENH6920P",151,0)
 . I ENHDIVFG'="ALL" S ENFLG=1
"RTN","ENH6920P",152,0)
 S RECIEN=0
"RTN","ENH6920P",153,0)
 F  S RECIEN=$O(^XTMP(ENFILE1,DIV,TYP,RECIEN)) Q:'RECIEN!(ENFLG=1)  D
"RTN","ENH6920P",154,0)
 . S FLD=0
"RTN","ENH6920P",155,0)
 . F  S FLD=$O(^XTMP(ENFILE1,DIV,TYP,RECIEN,FLD)) Q:'FLD!(ENFLG=1)  D
"RTN","ENH6920P",156,0)
 .. I FLD=.0201!(FLD=.022)!(FLD=35) D MULT Q
"RTN","ENH6920P",157,0)
 .. ;I RECIEN=.0201!(RECIEN=.022)!(RECIEN=35) D MULT Q
"RTN","ENH6920P",158,0)
 .. S NAME=$P(^XTMP(ENFILE1,DIV,TYP,RECIEN,FLD),U,2)
"RTN","ENH6920P",159,0)
 .. S FLDNAME=$P(^XTMP(ENFILE1,DIV,TYP,RECIEN,FLD),U,3)
"RTN","ENH6920P",160,0)
 .. W !,$J(RECIEN,8),?10,NAME,?45,FLDNAME
"RTN","ENH6920P",161,0)
 .. S L=L+1
"RTN","ENH6920P",162,0)
 .. I L+2>IOSL D  Q:ABORT
"RTN","ENH6920P",163,0)
 ... D HDR^ENH6920U I ABORT S ENFLG=1 Q
"RTN","ENH6920P",164,0)
 ... I TYP'="CRIT" D DIVHDR^ENH6920H,DETC^ENH6920H
"RTN","ENH6920P",165,0)
 ... E  D DIVHDR^ENH6920H,NOMULT^ENH6920H
"RTN","ENH6920P",166,0)
 I ENHDIVFG'="ALL" S ENFLG=1 ; Stop Print if single division is picked
"RTN","ENH6920P",167,0)
 Q
"RTN","ENH6920P",168,0)
 ;
"RTN","ENH6920P",169,0)
MULT ; Loop to print Multiples
"RTN","ENH6920P",170,0)
 ;
"RTN","ENH6920P",171,0)
 Q:TYP=""
"RTN","ENH6920P",172,0)
 S MULTIEN=0
"RTN","ENH6920P",173,0)
 F  S MULTIEN=$O(^XTMP(ENFILE1,DIV,TYP,RECIEN,FLD,MULTIEN)) Q:'MULTIEN!(ENFLG=1)  D
"RTN","ENH6920P",174,0)
 . S NAME=$P(^XTMP(ENFILE1,DIV,TYP,RECIEN,FLD,MULTIEN),U,2)
"RTN","ENH6920P",175,0)
 . S FLDNAME=$P(^XTMP(ENFILE1,DIV,TYP,RECIEN,FLD,MULTIEN),U,3)
"RTN","ENH6920P",176,0)
 . S SFIEN=$P(^XTMP(ENFILE1,DIV,TYP,RECIEN,FLD,MULTIEN),U,5)
"RTN","ENH6920P",177,0)
 . W !,$J(RECIEN,8),?10,NAME,?45,FLDNAME,?70,$J(SFIEN,3)
"RTN","ENH6920P",178,0)
 . S L=L+1
"RTN","ENH6920P",179,0)
 . I L+2>IOSL D  Q:ABORT
"RTN","ENH6920P",180,0)
 .. D HDR^ENH6920U I ABORT S ENFLG=1 Q
"RTN","ENH6920P",181,0)
 .. I TYP'="CRIT" D DIVHDR^ENH6920H,DETC^ENH6920H
"RTN","ENH6920P",182,0)
 .. E  D DIVHDR^ENH6920H,NOMULT^ENH6920H
"RTN","ENH6920P",183,0)
 Q
"RTN","ENH6920U")
0^6^B41698486
"RTN","ENH6920U",1,0)
ENH6920U ;WOIFO/EEN - Work Order Report Utilities (AMES/MERS) - CoreFLS ;09/26/03 16:56
"RTN","ENH6920U",2,0)
 ;;7.0;Engineering;**76**;Aug 17,1993
"RTN","ENH6920U",3,0)
 ;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","ENH6920U",4,0)
 ;
"RTN","ENH6920U",5,0)
 Q  ;this routine is not callable from the top
"RTN","ENH6920U",6,0)
 ;
"RTN","ENH6920U",7,0)
 ;This routine contains common utilities and the instructions for the 
"RTN","ENH6920U",8,0)
 ;Required Fields Missing Data report.
"RTN","ENH6920U",9,0)
 ;
"RTN","ENH6920U",10,0)
HDR ; Print the standard report header.
"RTN","ENH6920U",11,0)
 ; Do not ask 'RETURN' before first page on CRT.
"RTN","ENH6920U",12,0)
 I $E(IOST,1,2)="C-",P R !!,"Enter RETURN to continue or '^' to exit: ",Y:DTIME I '$T!(Y[U) S ABORT=1 Q
"RTN","ENH6920U",13,0)
 ; Do not print a form feed before first page on printer.
"RTN","ENH6920U",14,0)
 ; Top of form is set at end of previous report.
"RTN","ENH6920U",15,0)
 I $E(IOST,1,2)="C-"!P W @IOF
"RTN","ENH6920U",16,0)
 S P=P+1,L=4
"RTN","ENH6920U",17,0)
 W !,"WORK ORDER # (#6920) - "_$G(ENHDR),?67,"Page: ",$J(P,5,0)
"RTN","ENH6920U",18,0)
 W !,"CoreFLS Data Cleansing Report ",$G(ENHDR1),?58,"Printed: ",$$FMTE^XLFDT(DT)
"RTN","ENH6920U",19,0)
 Q
"RTN","ENH6920U",20,0)
 ;
"RTN","ENH6920U",21,0)
EORT ; Report completed
"RTN","ENH6920U",22,0)
 I 'ABORT D
"RTN","ENH6920U",23,0)
 . W !!,"<End of Report>"
"RTN","ENH6920U",24,0)
 . I $E(IOST,1,2)="C-" W " Enter RETURN to continue " R Y:DTIME
"RTN","ENH6920U",25,0)
 I ABORT W !!,"<Report Aborted>"
"RTN","ENH6920U",26,0)
 D ^%ZISC
"RTN","ENH6920U",27,0)
 K L,P,X,Y,ABORT
"RTN","ENH6920U",28,0)
 I $D(ZTQUEUED) S ZTREQ="@"
"RTN","ENH6920U",29,0)
 Q
"RTN","ENH6920U",30,0)
 ;
"RTN","ENH6920U",31,0)
INST ; Print Instructions for Summary Report
"RTN","ENH6920U",32,0)
 ;
"RTN","ENH6920U",33,0)
 ;  Variables:
"RTN","ENH6920U",34,0)
 ;    ENHRPT = Type of report
"RTN","ENH6920U",35,0)
 ;           1 - Summary Report
"RTN","ENH6920U",36,0)
 ;           2 - Required Fields Missing Data Report
"RTN","ENH6920U",37,0)
 ;           3 - Lookup Fields w/ Invalid Data Report
"RTN","ENH6920U",38,0)
 ;           4 - Non-Required Fields Missing Data Report
"RTN","ENH6920U",39,0)
 ;
"RTN","ENH6920U",40,0)
 D HOME^%ZIS
"RTN","ENH6920U",41,0)
 K DIR
"RTN","ENH6920U",42,0)
 S DIR(0)="Y"
"RTN","ENH6920U",43,0)
 S DIR("A")="Do you wish to print the instructions for this report"
"RTN","ENH6920U",44,0)
 S DIR("A",1)=" "
"RTN","ENH6920U",45,0)
 S DIR("B")="NO"
"RTN","ENH6920U",46,0)
 S DIR("?")="Please enter Y to print the instructions or N to skip the instructions"
"RTN","ENH6920U",47,0)
 D ^DIR K DIR
"RTN","ENH6920U",48,0)
 I Y[U!(Y="")!$D(DTOUT)!$D(DUOUT) S ABORT=1 Q
"RTN","ENH6920U",49,0)
 S ENHINST=Y
"RTN","ENH6920U",50,0)
 Q
"RTN","ENH6920U",51,0)
 ;
"RTN","ENH6920U",52,0)
PRT2    ; Print Instructions for Required Fields Missing Data Report
"RTN","ENH6920U",53,0)
 ;
"RTN","ENH6920U",54,0)
 S (P,L,ABORT)=0
"RTN","ENH6920U",55,0)
 S ENHDR="REQUIRED FIELDS MISSING DATA"
"RTN","ENH6920U",56,0)
 S ENHDR1="Instructions"
"RTN","ENH6920U",57,0)
 U IO
"RTN","ENH6920U",58,0)
 D HDR
"RTN","ENH6920U",59,0)
 W !!,"The purpose of this report is to display a list of all WORK ORDER # (#6920)"
"RTN","ENH6920U",60,0)
 W !,"items with missing (empty) data for the fields that are required in the CoreFLS"
"RTN","ENH6920U",61,0)
 W !,"system. CoreFLS is unable to function when a required field is empty; therefore,"
"RTN","ENH6920U",62,0)
 W !,"you must enter valid data in these fields prior to conversion."
"RTN","ENH6920U",63,0)
 W !!,"Before you use this report, you may want to run the compile to ensure you are"
"RTN","ENH6920U",64,0)
 W !,"viewing the most recent modifications."
"RTN","ENH6920U",65,0)
 S L=L+8
"RTN","ENH6920U",66,0)
 I L+6>IOSL D HDR Q:ABORT
"RTN","ENH6920U",67,0)
 W !!,"This report examines the following required fields:"
"RTN","ENH6920U",68,0)
 W !,"     LOCATION (#3)"
"RTN","ENH6920U",69,0)
 W !,"     EQUIPMENT ID# (#18)"
"RTN","ENH6920U",70,0)
 S L=L+4
"RTN","ENH6920U",71,0)
 I L+6>IOSL D HDR Q:ABORT
"RTN","ENH6920U",72,0)
 W !!,"The report is sorted by division. When printing or viewing this report, you"
"RTN","ENH6920U",73,0)
 W !,"may select a single division or ALL. Select ""ZZ no division"" to display"
"RTN","ENH6920U",74,0)
 W !,"the records with no entry in the LOCATION (#3) field."
"RTN","ENH6920U",75,0)
 S L=L+4
"RTN","ENH6920U",76,0)
 I L+4>IOSL D HDR Q:ABORT
"RTN","ENH6920U",77,0)
 W !!,"The totals for each division are as follows:"
"RTN","ENH6920U",78,0)
 S L=L+2
"RTN","ENH6920U",79,0)
 I L+5>IOSL D HDR Q:ABORT
"RTN","ENH6920U",80,0)
 W !!,"Total records analyzed - number of records in the WORK ORDER # (#6920)"
"RTN","ENH6920U",81,0)
 W !,"     file assigned to the division"
"RTN","ENH6920U",82,0)
 S L=L+3
"RTN","ENH6920U",83,0)
 I L+5>IOSL D HDR Q:ABORT
"RTN","ENH6920U",84,0)
 W !!,"Total records with Required Fields Missing Data - number of records that have"
"RTN","ENH6920U",85,0)
 W !,"     one or more empty required fields"
"RTN","ENH6920U",86,0)
 S L=L+3
"RTN","ENH6920U",87,0)
 I L+5>IOSL D HDR Q:ABORT
"RTN","ENH6920U",88,0)
 W !!,"Total fields with Required Fields Missing Data - number of required fields"
"RTN","ENH6920U",89,0)
 W !,"     that are empty"
"RTN","ENH6920U",90,0)
 S L=L+3
"RTN","ENH6920U",91,0)
 I L+7>IOSL D HDR Q:ABORT
"RTN","ENH6920U",92,0)
 W !!,"The report then lists each record in order by its internal entry number (IEN)."
"RTN","ENH6920U",93,0)
 W !,"Each row on the report contains the following columns:"
"RTN","ENH6920U",94,0)
 W !!,"REC IEN - lists the WORK ORDER # (#6920) file internal record number"
"RTN","ENH6920U",95,0)
 S L=L+5
"RTN","ENH6920U",96,0)
 I L+4>IOSL D HDR Q:ABORT
"RTN","ENH6920U",97,0)
 W !!,"WORK ORDER NUMBER - WORK ORDER # (#.01) field"
"RTN","ENH6920U",98,0)
 S L=L+2
"RTN","ENH6920U",99,0)
 I L+4>IOSL D HDR Q:ABORT
"RTN","ENH6920U",100,0)
 W !!,"FIELD NAME - name of the required field"
"RTN","ENH6920U",101,0)
 S L=L+2
"RTN","ENH6920U",102,0)
 I L+7>IOSL D HDR Q:ABORT
"RTN","ENH6920U",103,0)
 W !!,"You must correct every field that appears on this report prior to conversion."
"RTN","ENH6920U",104,0)
 W !,"Use AEMS/MERS to enter a valid value in either of these two fields. If you"
"RTN","ENH6920U",105,0)
 W !,"have any difficulties correcting these fields, contact the IRM or ADPAC"
"RTN","ENH6920U",106,0)
 W !,"for assistance."
"RTN","ENH6920U",107,0)
 S L=L+5
"RTN","ENH6920U",108,0)
 I L+12>IOSL D HDR Q:ABORT
"RTN","ENH6920U",109,0)
 W !!,"*** Special Note ************************************************"
"RTN","ENH6920U",110,0)
 W !,"LOCATION and EQUIPMENT ID# are two fields that are checked"
"RTN","ENH6920U",111,0)
 W !,"together.  It is required that at least one of these two fields"
"RTN","ENH6920U",112,0)
 W !,"have data for the CoreFLS conversion.  In other words, if both"
"RTN","ENH6920U",113,0)
 W !,"fields are empty for a record, the record is flagged to be"
"RTN","ENH6920U",114,0)
 W !,"corrected. Entering data in either of the two fields corrects the"
"RTN","ENH6920U",115,0)
 W !,"record so it no longer appears on the report. These fields are"
"RTN","ENH6920U",116,0)
 W !,"noted on this report as ""Location/Equip ID#""."
"RTN","ENH6920U",117,0)
 W !,"*****************************************************************"
"RTN","ENH6920U",118,0)
 S L=L+10
"RTN","ENH6920U",119,0)
 I L+8>IOSL D HDR Q:ABORT
"RTN","ENH6920U",120,0)
 W !!,"*** Conversion Note *********************************************"
"RTN","ENH6920U",121,0)
 W !,"If the required fields are left empty, the record will not be"
"RTN","ENH6920U",122,0)
 W !,"converted into CoreFLS."
"RTN","ENH6920U",123,0)
 W !,"*****************************************************************"
"RTN","ENH6920U",124,0)
 W !!,"<End of Instructions>" I $E(IOST,1,2)="C-" W "  Enter RETURN to continue or '^' to exit: " R Y:DTIME I '$T!(Y[U) S ABORT=1 Q
"RTN","ENH6920U",125,0)
 W @IOF
"RTN","ENH6920U",126,0)
 K Y,L,P,ENHDR,ENHDR1
"RTN","ENH6920U",127,0)
 Q
"RTN","ENH6920U",128,0)
 ;
"RTN","ENH6920U",129,0)
ADDCNT ; Add counters for loop in ENH6920L routine
"RTN","ENH6920U",130,0)
 ; Add counters for Total Analyzed, Critical, Broken, and Desirable
"RTN","ENH6920U",131,0)
 S $P(^XTMP(ENFILE,ENDIVCT,"SUM"),U)=$P(^XTMP(ENFILE,ENDIVCT,"SUM"),U)+1
"RTN","ENH6920U",132,0)
 I CRITFLG D
"RTN","ENH6920U",133,0)
 . S $P(^XTMP(ENFILE,ENDIVCT,"SUM"),U,2)=$P(^XTMP(ENFILE,ENDIVCT,"SUM"),U,2)+1
"RTN","ENH6920U",134,0)
 . S ^XTMP(ENFILE,ENDIVCT,"CRIT")=^XTMP(ENFILE,ENDIVCT,"CRIT")+CRITFLD
"RTN","ENH6920U",135,0)
 I BPTFLG D
"RTN","ENH6920U",136,0)
 . S $P(^XTMP(ENFILE,ENDIVCT,"SUM"),U,3)=$P(^XTMP(ENFILE,ENDIVCT,"SUM"),U,3)+1
"RTN","ENH6920U",137,0)
 . S ^XTMP(ENFILE,ENDIVCT,"BPT")=^XTMP(ENFILE,ENDIVCT,"BPT")+BPTFLD
"RTN","ENH6920U",138,0)
 I DESFLG D
"RTN","ENH6920U",139,0)
 . S $P(^XTMP(ENFILE,ENDIVCT,"SUM"),U,4)=$P(^XTMP(ENFILE,ENDIVCT,"SUM"),U,4)+1
"RTN","ENH6920U",140,0)
 . S ^XTMP(ENFILE,ENDIVCT,"DES")=^XTMP(ENFILE,ENDIVCT,"DES")+DESFLD
"RTN","ENH6920U",141,0)
 Q
"VER")
8.0^22
**END**
**END**
