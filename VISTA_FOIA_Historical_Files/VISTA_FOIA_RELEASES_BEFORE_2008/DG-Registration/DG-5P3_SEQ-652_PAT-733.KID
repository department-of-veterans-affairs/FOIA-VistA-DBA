Released DG*5.3*733 SEQ #652
Extracted from mail message
**KIDS**:DG*5.3*733^

**INSTALL NAME**
DG*5.3*733
"BLD",6504,0)
DG*5.3*733^REGISTRATION^0^3061229^y
"BLD",6504,1,0)
^^1^1^3061023^
"BLD",6504,1,1,0)
TRIGGER FOR 1010EZ COMBAT AFTER 11/11/98
"BLD",6504,4,0)
^9.64PA^2^1
"BLD",6504,4,2,0)
2
"BLD",6504,4,2,2,0)
^9.641^2^1
"BLD",6504,4,2,2,2,0)
PATIENT  (File-top level)
"BLD",6504,4,2,2,2,1,0)
^9.6411^.5294^2
"BLD",6504,4,2,2,2,1,.5291,0)
COMBAT SERVICE INDICATED?
"BLD",6504,4,2,2,2,1,.5294,0)
COMBAT TO DATE
"BLD",6504,4,2,222)
y^y^p^^^^n^^n
"BLD",6504,4,2,224)

"BLD",6504,4,"APDD",2,2)

"BLD",6504,4,"APDD",2,2,.5291)

"BLD",6504,4,"APDD",2,2,.5294)

"BLD",6504,4,"B",2,2)

"BLD",6504,6)
6^
"BLD",6504,6.3)
15
"BLD",6504,"ABPKG")
n
"BLD",6504,"INIT")
EN^DG53P733
"BLD",6504,"KRN",0)
^9.67PA^8989.52^19
"BLD",6504,"KRN",.4,0)
.4
"BLD",6504,"KRN",.401,0)
.401
"BLD",6504,"KRN",.402,0)
.402
"BLD",6504,"KRN",.403,0)
.403
"BLD",6504,"KRN",.5,0)
.5
"BLD",6504,"KRN",.84,0)
.84
"BLD",6504,"KRN",3.6,0)
3.6
"BLD",6504,"KRN",3.8,0)
3.8
"BLD",6504,"KRN",9.2,0)
9.2
"BLD",6504,"KRN",9.8,0)
9.8
"BLD",6504,"KRN",9.8,"NM",0)
^9.68A^3^3
"BLD",6504,"KRN",9.8,"NM",1,0)
DGENDD^^0^B7066164
"BLD",6504,"KRN",9.8,"NM",2,0)
DGDEPU^^0^B3475639
"BLD",6504,"KRN",9.8,"NM",3,0)
DG53P733^^0^B17745118
"BLD",6504,"KRN",9.8,"NM","B","DG53P733",3)

"BLD",6504,"KRN",9.8,"NM","B","DGDEPU",2)

"BLD",6504,"KRN",9.8,"NM","B","DGENDD",1)

"BLD",6504,"KRN",19,0)
19
"BLD",6504,"KRN",19.1,0)
19.1
"BLD",6504,"KRN",101,0)
101
"BLD",6504,"KRN",409.61,0)
409.61
"BLD",6504,"KRN",771,0)
771
"BLD",6504,"KRN",870,0)
870
"BLD",6504,"KRN",8989.51,0)
8989.51
"BLD",6504,"KRN",8989.52,0)
8989.52
"BLD",6504,"KRN",8994,0)
8994
"BLD",6504,"KRN","B",.4,.4)

"BLD",6504,"KRN","B",.401,.401)

"BLD",6504,"KRN","B",.402,.402)

"BLD",6504,"KRN","B",.403,.403)

"BLD",6504,"KRN","B",.5,.5)

"BLD",6504,"KRN","B",.84,.84)

"BLD",6504,"KRN","B",3.6,3.6)

"BLD",6504,"KRN","B",3.8,3.8)

"BLD",6504,"KRN","B",9.2,9.2)

"BLD",6504,"KRN","B",9.8,9.8)

"BLD",6504,"KRN","B",19,19)

"BLD",6504,"KRN","B",19.1,19.1)

"BLD",6504,"KRN","B",101,101)

"BLD",6504,"KRN","B",409.61,409.61)

"BLD",6504,"KRN","B",771,771)

"BLD",6504,"KRN","B",870,870)

"BLD",6504,"KRN","B",8989.51,8989.51)

"BLD",6504,"KRN","B",8989.52,8989.52)

"BLD",6504,"KRN","B",8994,8994)

"BLD",6504,"QUES",0)
^9.62^^
"BLD",6504,"REQB",0)
^9.611^1^1
"BLD",6504,"REQB",1,0)
DG*5.3*503^2
"BLD",6504,"REQB","B","DG*5.3*503",1)

"FIA",2)
PATIENT
"FIA",2,0)
^DPT(
"FIA",2,0,0)
2I
"FIA",2,0,1)
y^y^p^^^^n^^n
"FIA",2,0,10)

"FIA",2,0,11)

"FIA",2,0,"RLRO")

"FIA",2,0,"VR")
5.3^DG
"FIA",2,2)
1
"FIA",2,2,.5291)

"FIA",2,2,.5294)

"INIT")
EN^DG53P733
"IX",2,2,"ACVCOM",0)
2^ACVCOM^Update Combat Vet Eligibility End Date^MU^^R^^I^2^^^^^A
"IX",2,2,"ACVCOM",.1,0)
^^11^11^3030613^
"IX",2,2,"ACVCOM",.1,1,0)
This multi-level MUMPS x-ref will trigger an update to the Combat Vet 
"IX",2,2,"ACVCOM",.1,2,0)
Eligibility End Date field under the following conditions:
"IX",2,2,"ACVCOM",.1,3,0)
  1) Service Separation Date [Last] is precise and > 2981111 AND EITHER
"IX",2,2,"ACVCOM",.1,4,0)
  2) Combat To Date is after 11/11/98 OR
"IX",2,2,"ACVCOM",.1,5,0)
     Persian Gulf To Date is after 11/11/98 OR
"IX",2,2,"ACVCOM",.1,6,0)
     Somalia To Date is after 11/11/98 OR
"IX",2,2,"ACVCOM",.1,7,0)
     Yugoslavia To Date is after 11/11/98
"IX",2,2,"ACVCOM",.1,8,0)
 
"IX",2,2,"ACVCOM",.1,9,0)
The Combat vet field will be set to the Service Separation Date + 2 
"IX",2,2,"ACVCOM",.1,10,0)
years, and will only be updated if information in these fields has 
"IX",2,2,"ACVCOM",.1,11,0)
changed.
"IX",2,2,"ACVCOM",1)
D SETCV^DGCV(DA,X2(1))
"IX",2,2,"ACVCOM",1.4)
I '$P($G(^DPT(DA,.52)),"^",15) S X=$$CVELIG^DGCV(DA)
"IX",2,2,"ACVCOM",2)
Q
"IX",2,2,"ACVCOM",2.4)
Q
"IX",2,2,"ACVCOM",11.1,0)
^.114IA^9^9
"IX",2,2,"ACVCOM",11.1,1,0)
1^F^2^.327^^^F
"IX",2,2,"ACVCOM",11.1,2,0)
2^F^2^.5294^^^F
"IX",2,2,"ACVCOM",11.1,3,0)
3^F^2^.322021^^^F
"IX",2,2,"ACVCOM",11.1,4,0)
4^F^2^.322018^^^F
"IX",2,2,"ACVCOM",11.1,5,0)
5^F^2^.322012^^^F
"IX",2,2,"ACVCOM",11.1,6,0)
6^F^2^.5291^^^F
"IX",2,2,"ACVCOM",11.1,7,0)
7^F^2^.322019^^^F
"IX",2,2,"ACVCOM",11.1,8,0)
8^F^2^.322016^^^F
"IX",2,2,"ACVCOM",11.1,9,0)
9^F^2^.32201^^^F
"MBREQ")
0
"PKG",5,-1)
1^1
"PKG",5,0)
REGISTRATION^DG^PATIENT REGISTRATION, ADMISSION, DISCHARGE, EMBOSSER 
"PKG",5,20,0)
^9.402P^^
"PKG",5,22,0)
^9.49I^1^1
"PKG",5,22,1,0)
5.3^2930813
"PKG",5,22,1,"PAH",1,0)
733^3061229^1255
"PKG",5,22,1,"PAH",1,1,0)
^^1^1^3061229
"PKG",5,22,1,"PAH",1,1,1,0)
TRIGGER FOR 1010EZ COMBAT AFTER 11/11/98
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
3
"RTN","DG53P733")
0^3^B17745118^n/a
"RTN","DG53P733",1,0)
DG53P733 ;ALB/AMA,GTS - PATCH DG*5.3*733 POST-INSTALL ROUTINE
"RTN","DG53P733",2,0)
 ;;5.3;Registration;**733**;Aug 13, 1993;Build 15
"RTN","DG53P733",3,0)
 ;
"RTN","DG53P733",4,0)
EN ;
"RTN","DG53P733",5,0)
 N ZTDTH,ZTIO,ZTDESC,ZTRTN,ZTSAVE,ZTSK
"RTN","DG53P733",6,0)
 S ZTDTH=$H
"RTN","DG53P733",7,0)
 S ZTIO=""
"RTN","DG53P733",8,0)
 S ZTDESC="DG*5.3*733 Post-Install message"
"RTN","DG53P733",9,0)
 S ZTRTN="CLEANUP^DG53P733"
"RTN","DG53P733",10,0)
 S ZTSAVE("DUZ")=""
"RTN","DG53P733",11,0)
 S ZTSAVE("JVAL")=$J
"RTN","DG53P733",12,0)
 D ^%ZTLOAD
"RTN","DG53P733",13,0)
 I $G(ZTSK) DO
"RTN","DG53P733",14,0)
 . D BMES^XPDUTL("POST-INSTALL CLEANUP MESSAGE QUEUED TO SEND")
"RTN","DG53P733",15,0)
 . D BMES^XPDUTL("Means Test database cleanup has been completed.  Check your VA Mailman")
"RTN","DG53P733",16,0)
 . D MES^XPDUTL("mailbox for the ""DG*5.3*733 External value cleanup"" message.")
"RTN","DG53P733",17,0)
 . D BMES^XPDUTL("Only if you do not receive the e-mail, check the following global:")
"RTN","DG53P733",18,0)
 . D MES^XPDUTL("  ^XTMP(""DG"","_$J_",""PATCH 733 CLEANUP BULLETIN"")")
"RTN","DG53P733",19,0)
 I '$G(ZTSK) D BMES^XPDUTL("PROBLEM: POST-INSTALL CLEANUP MESSAGE NOT SENT")
"RTN","DG53P733",20,0)
 Q
"RTN","DG53P733",21,0)
CLEANUP ;
"RTN","DG53P733",22,0)
 N JVAL,DGMMLNE,DFN,FIRST,RECCNT
"RTN","DG53P733",23,0)
 S JVAL=$J
"RTN","DG53P733",24,0)
 ;*Create bulletin head to identify cleanup records
"RTN","DG53P733",25,0)
 K ^XTMP("DG",JVAL,"PATCH 733 CLEANUP BULLETIN")
"RTN","DG53P733",26,0)
 S ^XTMP("DG",JVAL,"PATCH 733 CLEANUP BULLETIN",1)="This message indicates the patients in the PATIENT file (2)"
"RTN","DG53P733",27,0)
 S ^XTMP("DG",JVAL,"PATCH 733 CLEANUP BULLETIN",2)="that have had the COMBAT INDICATED ON 1010EZ field (1010.157)"
"RTN","DG53P733",28,0)
 S ^XTMP("DG",JVAL,"PATCH 733 CLEANUP BULLETIN",3)="populated to the correct YES, NO or NULL value."
"RTN","DG53P733",29,0)
 S ^XTMP("DG",JVAL,"PATCH 733 CLEANUP BULLETIN",4)=" "
"RTN","DG53P733",30,0)
 ;
"RTN","DG53P733",31,0)
 S DGMMLNE=4
"RTN","DG53P733",32,0)
 ;
"RTN","DG53P733",33,0)
 ;*Set up message text
"RTN","DG53P733",34,0)
 S DGMMLNE=DGMMLNE+1
"RTN","DG53P733",35,0)
 S ^XTMP("DG",JVAL,"PATCH 733 CLEANUP BULLETIN",DGMMLNE)="Checking COMBAT INDICATED ON 1010EZ field (1010.157) in PATIENT file (2)..."
"RTN","DG53P733",36,0)
 S DGMMLNE=DGMMLNE+1
"RTN","DG53P733",37,0)
 S ^XTMP("DG",JVAL,"PATCH 733 CLEANUP BULLETIN",DGMMLNE)=" "
"RTN","DG53P733",38,0)
 ;
"RTN","DG53P733",39,0)
 ;Execute COMBAT INDICATED ON 1010EZ field conversion
"RTN","DG53P733",40,0)
 S FIRST=1,RECCNT=0
"RTN","DG53P733",41,0)
 S DFN=0 F  S DFN=$O(^DPT(DFN)) Q:'DFN  D
"RTN","DG53P733",42,0)
 . Q:'$D(^DPT(DFN,.52))
"RTN","DG53P733",43,0)
 . N NODE52,NODE1010 S NODE52=$G(^DPT(DFN,.52)),NODE1010=$G(^DPT(DFN,1010.15))
"RTN","DG53P733",44,0)
 . I ($P(NODE52,U,11)=""),($P(NODE1010,U,7)'="") D  Q
"RTN","DG53P733",45,0)
 . . S $P(^DPT(DFN,1010.15),U,7)=""
"RTN","DG53P733",46,0)
 . . D ADDLINE("NULL")
"RTN","DG53P733",47,0)
 . I ($P(NODE52,U,11)="N"),($P(NODE1010,U,7)'=0) D  Q
"RTN","DG53P733",48,0)
 . . S $P(^DPT(DFN,1010.15),U,7)=0
"RTN","DG53P733",49,0)
 . . D ADDLINE("NO")
"RTN","DG53P733",50,0)
 . I ($P(NODE52,U,11)="Y"),($P(NODE52,U,14)'>2981111),($P(NODE1010,U,7)'=0) D  Q
"RTN","DG53P733",51,0)
 . . S $P(^DPT(DFN,1010.15),U,7)=0
"RTN","DG53P733",52,0)
 . . D ADDLINE("NO")
"RTN","DG53P733",53,0)
 . I ($P(NODE52,U,11)="Y"),($P(NODE52,U,14)>2981111),($P(NODE1010,U,7)'=1) D  Q
"RTN","DG53P733",54,0)
 . . S $P(^DPT(DFN,1010.15),U,7)=1
"RTN","DG53P733",55,0)
 . . D ADDLINE("YES")
"RTN","DG53P733",56,0)
 ;
"RTN","DG53P733",57,0)
 S DGMMLNE=DGMMLNE+1
"RTN","DG53P733",58,0)
 S ^XTMP("DG",JVAL,"PATCH 733 CLEANUP BULLETIN",DGMMLNE)=" "
"RTN","DG53P733",59,0)
 S DGMMLNE=DGMMLNE+1
"RTN","DG53P733",60,0)
 S ^XTMP("DG",JVAL,"PATCH 733 CLEANUP BULLETIN",DGMMLNE)="There were "_RECCNT_" records corrected."
"RTN","DG53P733",61,0)
 S DGMMLNE=DGMMLNE+1
"RTN","DG53P733",62,0)
 S ^XTMP("DG",JVAL,"PATCH 733 CLEANUP BULLETIN",DGMMLNE)=" "
"RTN","DG53P733",63,0)
 ;
"RTN","DG53P733",64,0)
 ;* Queue message to be sent
"RTN","DG53P733",65,0)
 D SENDMESS
"RTN","DG53P733",66,0)
 Q
"RTN","DG53P733",67,0)
ADDLINE(MSG) ;
"RTN","DG53P733",68,0)
 I FIRST D FIRST S FIRST=0
"RTN","DG53P733",69,0)
 S DGMMLNE=DGMMLNE+1,RECCNT=RECCNT+1
"RTN","DG53P733",70,0)
 S ^XTMP("DG",JVAL,"PATCH 733 CLEANUP BULLETIN",DGMMLNE)="  IEN:  "_DFN_"    COMBAT INDICATED ON 1010EZ changed to:  "_MSG
"RTN","DG53P733",71,0)
 Q
"RTN","DG53P733",72,0)
FIRST ;
"RTN","DG53P733",73,0)
 S DGMMLNE=DGMMLNE+1
"RTN","DG53P733",74,0)
 S ^XTMP("DG",JVAL,"PATCH 733 CLEANUP BULLETIN",DGMMLNE)="The COMBAT INDICATED ON 1010EZ field (#1010.157) for the following Patient"
"RTN","DG53P733",75,0)
 S DGMMLNE=DGMMLNE+1
"RTN","DG53P733",76,0)
 S ^XTMP("DG",JVAL,"PATCH 733 CLEANUP BULLETIN",DGMMLNE)="file (#2) IENs were modified:"
"RTN","DG53P733",77,0)
 S DGMMLNE=DGMMLNE+1
"RTN","DG53P733",78,0)
 S ^XTMP("DG",JVAL,"PATCH 733 CLEANUP BULLETIN",DGMMLNE)=" "
"RTN","DG53P733",79,0)
 Q
"RTN","DG53P733",80,0)
SENDMESS ;
"RTN","DG53P733",81,0)
 N XMSUB,XMDUZ,XMTEXT,XMY,XMMG
"RTN","DG53P733",82,0)
 S XMSUB="DG*5.3*733 COMBAT INDICATED ON 1010EZ cleanup"
"RTN","DG53P733",83,0)
 S XMDUZ="DG*5.3*733 Install Cleanup"
"RTN","DG53P733",84,0)
 S XMTEXT="^XTMP(""DG"",JVAL,""PATCH 733 CLEANUP BULLETIN"","
"RTN","DG53P733",85,0)
 S XMY(DUZ)=""
"RTN","DG53P733",86,0)
 S XMY(.5)=""
"RTN","DG53P733",87,0)
 D ^XMD
"RTN","DG53P733",88,0)
 S DGMMLNE=$P($$FMADD^XLFDT($$NOW^XLFDT,,,5),".")
"RTN","DG53P733",89,0)
 S ^XTMP("DG",JVAL,"PATCH 733 CLEANUP BULLETIN",0)=DGMMLNE
"RTN","DG53P733",90,0)
 I '$D(XMMG) K ^XTMP("DG",JVAL,"PATCH 733 CLEANUP BULLETIN")
"RTN","DG53P733",91,0)
 Q
"RTN","DGDEPU")
0^2^B3475639^B3409637
"RTN","DGDEPU",1,0)
DGDEPU ;ALB/CAW/AMA - Dependent Utilities - Generic ;11/3/94
"RTN","DGDEPU",2,0)
 ;;5.3;Registration;**45,733**;Aug 13, 1993;Build 15
"RTN","DGDEPU",3,0)
 ;
"RTN","DGDEPU",4,0)
SEL ; -- select processing
"RTN","DGDEPU",5,0)
 ;DG*5.3*733 -- added DIR to the list a vars to be NEW'ed
"RTN","DGDEPU",6,0)
 N BG,LST,Y,DIR
"RTN","DGDEPU",7,0)
 S BG=+$O(@VALMAR@("IDX",$S($G(BEG):BEG,1:1),0))
"RTN","DGDEPU",8,0)
 S LST=+$O(@VALMAR@("IDX",$S($G(END):END,1:DGCNT),0))
"RTN","DGDEPU",9,0)
 I 'BG W !!,*7,"There are no '",VALM("ENTITY"),"s' to select.",! S DIR(0)="E" D ^DIR K DIR D OUT G SELQ
"RTN","DGDEPU",10,0)
 S Y=+$P($P(XQORNOD(0),U,4),"=",2)
"RTN","DGDEPU",11,0)
 I 'Y S DIR(0)="N^"_BG_":"_LST,DIR("A")="Select "_VALM("ENTITY")_"(s)" D ^DIR K DIR I $D(DIRUT) D OUT G SELQ
"RTN","DGDEPU",12,0)
 ;
"RTN","DGDEPU",13,0)
 ; -- check was valid entries
"RTN","DGDEPU",14,0)
 S DGERR=0,DGW=Y
"RTN","DGDEPU",15,0)
 I DGW<BG!(DGW>LST) D
"RTN","DGDEPU",16,0)
 . W !,*7,"Selection '",DGW,"' is not a valid choice."
"RTN","DGDEPU",17,0)
 . D OUT,PAUSE^VALM1
"RTN","DGDEPU",18,0)
 ;
"RTN","DGDEPU",19,0)
SELQ K DIRUT,DTOUT,DUOUT,DIROUT Q
"RTN","DGDEPU",20,0)
 ;
"RTN","DGDEPU",21,0)
OUT ;
"RTN","DGDEPU",22,0)
 S DGERR=1
"RTN","DGDEPU",23,0)
 Q
"RTN","DGDEPU",24,0)
 ;
"RTN","DGDEPU",25,0)
LOOKUP ; Look up the tests that can be added to
"RTN","DGDEPU",26,0)
 ;
"RTN","DGDEPU",27,0)
 S DIC("S")="I $P(^(0),U,2)=DFN"
"RTN","DGDEPU",28,0)
 W ! S DIC="^DGMT(408.31,",DIC(0)="EQZ",X=DFN,D="C" D IX^DIC K DIC G LOOKUPQ:$D(DTOUT)!($D(DUOUT))!(+Y<0)
"RTN","DGDEPU",29,0)
 I ('$P($G(^DG(408.34,+$P(Y(0),"^",23),0)),U,2))!('$P($G(^DGMT(408.31,+Y,"PRIM")),"^")) W !?5,*7,"This means test is uneditable and cannot be added to." G LOOKUP
"RTN","DGDEPU",30,0)
 S DGMTI=+Y,DGMT0=Y(0) K DIC,Y
"RTN","DGDEPU",31,0)
LOOKUPQ ;
"RTN","DGDEPU",32,0)
 Q
"RTN","DGENDD")
0^1^B7066164^B5152913
"RTN","DGENDD",1,0)
DGENDD ;ALB/CJM,JAN,LBD,AMA - Enrollment Data Dictionary Functions; 13 JUN 1997;6-28-01
"RTN","DGENDD",2,0)
 ;;5.3;Registration;**121,351,503,733**;Aug 13,1993;Build 15
"RTN","DGENDD",3,0)
 ;
"RTN","DGENDD",4,0)
SET1(DFN,DGENRIEN) ;
"RTN","DGENDD",5,0)
 ;Description: sets the "AENRC" X-ref on the patient file
"RTN","DGENDD",6,0)
 ;Inputs:
"RTN","DGENDD",7,0)
 ;  DFN - the patient ien
"RTN","DGENDD",8,0)
 ;  DGENRIEN - ien of current enrollment
"RTN","DGENDD",9,0)
 ;
"RTN","DGENDD",10,0)
 Q:'$G(DGENRIEN)
"RTN","DGENDD",11,0)
 Q:'$G(DFN)
"RTN","DGENDD",12,0)
 ;
"RTN","DGENDD",13,0)
 N STATUS
"RTN","DGENDD",14,0)
 S STATUS=$P($G(^DGEN(27.11,DGENRIEN,0)),"^",4)
"RTN","DGENDD",15,0)
 S:STATUS ^DPT("AENRC",STATUS,DFN)=""
"RTN","DGENDD",16,0)
 ;
"RTN","DGENDD",17,0)
 Q
"RTN","DGENDD",18,0)
 ;
"RTN","DGENDD",19,0)
KILL1(DFN) ;
"RTN","DGENDD",20,0)
 ;Description: This is the kill logic that corresponds to SET1.
"RTN","DGENDD",21,0)
 ;Input: DFN is the patient ien
"RTN","DGENDD",22,0)
 ;
"RTN","DGENDD",23,0)
 Q:'$G(DFN)
"RTN","DGENDD",24,0)
 ;
"RTN","DGENDD",25,0)
 N DGSTATUS,STATUS
"RTN","DGENDD",26,0)
 S DGSTATUS=$P(^DGEN(27.15,0),U,3)
"RTN","DGENDD",27,0)
 F STATUS=1:1:DGSTATUS K ^DPT("AENRC",STATUS,DFN)
"RTN","DGENDD",28,0)
 Q
"RTN","DGENDD",29,0)
 ;
"RTN","DGENDD",30,0)
SET2(DGENRIEN,STATUS) ;
"RTN","DGENDD",31,0)
 ;Description: This MUMPS x-ref on the Patient Enrollment file sets the
"RTN","DGENDD",32,0)
 ;  "AENRC" X-ref on the patient file.
"RTN","DGENDD",33,0)
 ;Inputs:
"RTN","DGENDD",34,0)
 ;  DGENRIEN - enrollment ien
"RTN","DGENDD",35,0)
 ;  STATUS - the enrollment status
"RTN","DGENDD",36,0)
 ;
"RTN","DGENDD",37,0)
 Q:'$G(DGENRIEN)
"RTN","DGENDD",38,0)
 Q:'$G(STATUS)
"RTN","DGENDD",39,0)
 ;
"RTN","DGENDD",40,0)
 N DFN
"RTN","DGENDD",41,0)
 S DFN=$P($G(^DGEN(27.11,DGENRIEN,0)),"^",2)
"RTN","DGENDD",42,0)
 Q:'DFN
"RTN","DGENDD",43,0)
 I $$FINDCUR^DGENA(DFN)=DGENRIEN D
"RTN","DGENDD",44,0)
 . S ^DPT("AENRC",STATUS,DFN)=""
"RTN","DGENDD",45,0)
 ;
"RTN","DGENDD",46,0)
 Q
"RTN","DGENDD",47,0)
 ;
"RTN","DGENDD",48,0)
KILL2(DGENRIEN,STATUS) ;
"RTN","DGENDD",49,0)
 ;Description: This is the kill logic that corresponds to SET2.
"RTN","DGENDD",50,0)
 ;Inputs:
"RTN","DGENDD",51,0)
 ;  DGENRIEN - enrollment ien
"RTN","DGENDD",52,0)
 ;  STATUS - the enrollment status
"RTN","DGENDD",53,0)
 ;
"RTN","DGENDD",54,0)
 Q:'$G(DGENRIEN)
"RTN","DGENDD",55,0)
 Q:'$G(STATUS)
"RTN","DGENDD",56,0)
 ;
"RTN","DGENDD",57,0)
 N DFN
"RTN","DGENDD",58,0)
 S DFN=$P($G(^DGEN(27.11,DGENRIEN,0)),"^",2)
"RTN","DGENDD",59,0)
 Q:'DFN
"RTN","DGENDD",60,0)
 I $$FINDCUR^DGENA(DFN)=DGENRIEN D
"RTN","DGENDD",61,0)
 . K ^DPT("AENRC",STATUS,DFN)
"RTN","DGENDD",62,0)
 Q
"RTN","DGENDD",63,0)
 ;
"RTN","DGENDD",64,0)
SETREM(DGENRIEN,STATUS) ;
"RTN","DGENDD",65,0)
 ;This set logic is called by the Enrollment Status field (#.04) in 
"RTN","DGENDD",66,0)
 ;the Patient Enrollment file (#27.11).  If the Enrollment Status
"RTN","DGENDD",67,0)
 ;contains the word REJECTED, then "**REJECTED**" will be stuffed
"RTN","DGENDD",68,0)
 ;into the Remarks field (#.091) of the Patient file (#2).  If the
"RTN","DGENDD",69,0)
 ;Enrollment Status does not contain REJECTED, then the word
"RTN","DGENDD",70,0)
 ;"**REJECTED**" will be removed.
"RTN","DGENDD",71,0)
 ;Input:
"RTN","DGENDD",72,0)
 ;  DGENRIEN - IEN of the enrollment record
"RTN","DGENDD",73,0)
 ;  STATUS - enrollment status
"RTN","DGENDD",74,0)
 ;
"RTN","DGENDD",75,0)
 Q:'$G(DGENRIEN)
"RTN","DGENDD",76,0)
 Q:'$G(STATUS)
"RTN","DGENDD",77,0)
 ;
"RTN","DGENDD",78,0)
 N DFN,REM
"RTN","DGENDD",79,0)
 S DFN=$P($G(^DGEN(27.11,DGENRIEN,0)),U,2)
"RTN","DGENDD",80,0)
 Q:'DFN  Q:$G(^DPT(DFN,0))=""
"RTN","DGENDD",81,0)
 L +^DPT(DFN,0):5 I '$T Q
"RTN","DGENDD",82,0)
 S REM=$P(^DPT(DFN,0),U,10)
"RTN","DGENDD",83,0)
 ;The enrollment status contains REJECTED, set REMARKS
"RTN","DGENDD",84,0)
 I "^11^12^13^14^22^"[(U_STATUS_U) D  G SETREMQ
"RTN","DGENDD",85,0)
 . I REM["**REJECTED**" Q  ;Remarks already contain REJECTED
"RTN","DGENDD",86,0)
 . S REM=REM_"**REJECTED**"
"RTN","DGENDD",87,0)
 . S $P(^DPT(DFN,0),U,10)=REM
"RTN","DGENDD",88,0)
 ;The enrollment status does not contain REJECTED, remove REMARKS
"RTN","DGENDD",89,0)
 I REM'["**REJECTED**" G SETREMQ
"RTN","DGENDD",90,0)
 S REM=$P(REM,"**REJECTED**",1)_$P(REM,"**REJECTED**",2,99)
"RTN","DGENDD",91,0)
 S $P(^DPT(DFN,0),U,10)=REM
"RTN","DGENDD",92,0)
SETREMQ L -^DPT(DFN,0)
"RTN","DGENDD",93,0)
 Q
"RTN","DGENDD",94,0)
 ;
"RTN","DGENDD",95,0)
CSI1010(DA) ;
"RTN","DGENDD",96,0)
 ;If COMBAT SERVICE INDICATED? (2/.5291) is "NO,"
"RTN","DGENDD",97,0)
 ;set COMBAT INDICATED ON 1010EZ (2/1010.157) to "NO."
"RTN","DGENDD",98,0)
 I $P($G(^DPT(DA,.52)),U,11)="N" D
"RTN","DGENDD",99,0)
 . N DGFDA
"RTN","DGENDD",100,0)
 . S DGFDA(2,DA_",",1010.157)=0
"RTN","DGENDD",101,0)
 . D FILE^DIE(,"DGFDA")
"RTN","DGENDD",102,0)
 Q
"RTN","DGENDD",103,0)
 ;
"RTN","DGENDD",104,0)
CTD1010(DA) ;
"RTN","DGENDD",105,0)
 ;If COMBAT SERVICE INDICATED? (2/.5291) is "YES" and
"RTN","DGENDD",106,0)
 ;COMBAT TO DATE (2/.5294) is greater than 11/11/1998,
"RTN","DGENDD",107,0)
 ;set COMBAT INDICATED ON 1010EZ (2/1010.157) to "YES."
"RTN","DGENDD",108,0)
 N NODE,ANS,DGFDA
"RTN","DGENDD",109,0)
 S NODE=$G(^DPT(DA,.52)),ANS=0
"RTN","DGENDD",110,0)
 I ($P(NODE,U,11)="Y"),($P(NODE,U,14)>2981111) S ANS=1
"RTN","DGENDD",111,0)
 S DGFDA(2,DA_",",1010.157)=ANS
"RTN","DGENDD",112,0)
 D FILE^DIE(,"DGFDA")
"RTN","DGENDD",113,0)
 Q
"VER")
8.0^22.0
"^DD",2,2,.5291,0)
COMBAT SERVICE INDICATED?^RSX^Y:YES;N:NO;^.52;11^S DFN=DA D SV^DGLOCK
"^DD",2,2,.5291,.1)
IN COMBAT (Y/N)
"^DD",2,2,.5291,1,0)
^.1
"^DD",2,2,.5291,1,1,0)
^^TRIGGER^2^.5292
"^DD",2,2,.5291,1,1,1)
X ^DD(2,.5291,1,1,1.3) I X S X=DIV S Y(1)=$S($D(^DPT(D0,.52)):^(.52),1:"") S X=$S('$D(^DIC(22,+$P(Y(1),U,12),0)):"",1:$P(^(0),U,1)) S DIU=X K Y S X=DIV S X="" X ^DD(2,.5291,1,1,1.4)
"^DD",2,2,.5291,1,1,1.3)
K DIV S DIV=X,D0=DA,DIV(0)=D0 S Y(0)=X S Y(1)=$C(59)_$S($D(^DD(2,.5291,0)):$P(^(0),U,3),1:"") S X=$P($P(Y(1),$C(59)_Y(0)_":",2),$C(59),1)="NO"
"^DD",2,2,.5291,1,1,1.4)
S DIH=$S($D(^DPT(DIV(0),.52)):^(.52),1:""),DIV=X X "F %=0:0 Q:$L($P(DIH,U,11,99))  S DIH=DIH_U" S %=$P(DIH,U,13,999),DIU=$P(DIH,U,12),^(.52)=$P(DIH,U,1,11)_U_DIV_$S(%]"":U_%,1:""),DIH=2,DIG=.5292 D ^DICR
"^DD",2,2,.5291,1,1,2)
Q
"^DD",2,2,.5291,1,1,2.3)
K DIV S DIV=X,D0=DA,DIV(0)=D0 S Y(0)=X S Y(2)=$C(59)_$S($D(^DD(2,.5291,0)):$P(^(0),U,3),1:""),Y(1)=$S($D(^DPT(D0,.52)):^(.52),1:"") S X=$P($P(Y(2),$C(59)_$P(Y(1),U,11)_":",2),$C(59),1)=""
"^DD",2,2,.5291,1,1,2.4)
S DIH=$S($D(^DPT(DIV(0),.52)):^(.52),1:""),DIV=X X "F %=0:0 Q:$L($P(DIH,U,11,99))  S DIH=DIH_U" S %=$P(DIH,U,13,999),DIU=$P(DIH,U,12),^(.52)=$P(DIH,U,1,11)_U_DIV_$S(%]"":U_%,1:""),DIH=2,DIG=.5292 D ^DICR
"^DD",2,2,.5291,1,1,"CREATE CONDITION")
IN COMBAT="NO"
"^DD",2,2,.5291,1,1,"CREATE VALUE")
@
"^DD",2,2,.5291,1,1,"DELETE CONDITION")
IN COMBAT=""
"^DD",2,2,.5291,1,1,"DELETE VALUE")
NO EFFECT
"^DD",2,2,.5291,1,1,"FIELD")
COMBAT WHERE
"^DD",2,2,.5291,1,2,0)
^^TRIGGER^2^.5293
"^DD",2,2,.5291,1,2,1)
X ^DD(2,.5291,1,2,1.3) I X S X=DIV S Y(1)=$S($D(^DPT(D0,.52)):^(.52),1:"") S X=$P(Y(1),U,13) S DIU=X K Y S X=DIV S X="" X ^DD(2,.5291,1,2,1.4)
"^DD",2,2,.5291,1,2,1.3)
K DIV S DIV=X,D0=DA,DIV(0)=D0 S Y(0)=X S Y(1)=$C(59)_$S($D(^DD(2,.5291,0)):$P(^(0),U,3),1:"") S X=$P($P(Y(1),$C(59)_Y(0)_":",2),$C(59),1)="NO"
"^DD",2,2,.5291,1,2,1.4)
S DIH=$S($D(^DPT(DIV(0),.52)):^(.52),1:""),DIV=X X "F %=0:0 Q:$L($P(DIH,U,12,99))  S DIH=DIH_U" S %=$P(DIH,U,14,999),DIU=$P(DIH,U,13),^(.52)=$P(DIH,U,1,12)_U_DIV_$S(%]"":U_%,1:""),DIH=2,DIG=.5293 D ^DICR
"^DD",2,2,.5291,1,2,2)
Q
"^DD",2,2,.5291,1,2,2.3)
K DIV S DIV=X,D0=DA,DIV(0)=D0 S Y(0)=X S Y(2)=$C(59)_$S($D(^DD(2,.5291,0)):$P(^(0),U,3),1:""),Y(1)=$S($D(^DPT(D0,.52)):^(.52),1:"") S X=$P($P(Y(2),$C(59)_$P(Y(1),U,11)_":",2),$C(59),1)=""
"^DD",2,2,.5291,1,2,2.4)
S DIH=$S($D(^DPT(DIV(0),.52)):^(.52),1:""),DIV=X X "F %=0:0 Q:$L($P(DIH,U,12,99))  S DIH=DIH_U" S %=$P(DIH,U,14,999),DIU=$P(DIH,U,13),^(.52)=$P(DIH,U,1,12)_U_DIV_$S(%]"":U_%,1:""),DIH=2,DIG=.5293 D ^DICR
"^DD",2,2,.5291,1,2,"CREATE CONDITION")
IN COMBAT="NO"
"^DD",2,2,.5291,1,2,"CREATE VALUE")
@
"^DD",2,2,.5291,1,2,"DELETE CONDITION")
IN COMBAT=""
"^DD",2,2,.5291,1,2,"DELETE VALUE")
NO EFFECT
"^DD",2,2,.5291,1,2,"FIELD")
COMBAT FRO
"^DD",2,2,.5291,1,3,0)
^^TRIGGER^2^.5294
"^DD",2,2,.5291,1,3,1)
X ^DD(2,.5291,1,3,1.3) I X S X=DIV S Y(1)=$S($D(^DPT(D0,.52)):^(.52),1:"") S X=$P(Y(1),U,14) S DIU=X K Y S X=DIV S X="" X ^DD(2,.5291,1,3,1.4)
"^DD",2,2,.5291,1,3,1.3)
K DIV S DIV=X,D0=DA,DIV(0)=D0 S Y(0)=X S Y(1)=$C(59)_$S($D(^DD(2,.5291,0)):$P(^(0),U,3),1:"") S X=$P($P(Y(1),$C(59)_Y(0)_":",2),$C(59),1)="NO"
"^DD",2,2,.5291,1,3,1.4)
S DIH=$S($D(^DPT(DIV(0),.52)):^(.52),1:""),DIV=X X "F %=0:0 Q:$L($P(DIH,U,13,99))  S DIH=DIH_U" S %=$P(DIH,U,15,999),DIU=$P(DIH,U,14),^(.52)=$P(DIH,U,1,13)_U_DIV_$S(%]"":U_%,1:""),DIH=2,DIG=.5294 D ^DICR
"^DD",2,2,.5291,1,3,2)
Q
"^DD",2,2,.5291,1,3,2.3)
K DIV S DIV=X,D0=DA,DIV(0)=D0 S Y(0)=X S Y(2)=$C(59)_$S($D(^DD(2,.5291,0)):$P(^(0),U,3),1:""),Y(1)=$S($D(^DPT(D0,.52)):^(.52),1:"") S X=$P($P(Y(2),$C(59)_$P(Y(1),U,11)_":",2),$C(59),1)=""
"^DD",2,2,.5291,1,3,2.4)
S DIH=$S($D(^DPT(DIV(0),.52)):^(.52),1:""),DIV=X X "F %=0:0 Q:$L($P(DIH,U,13,99))  S DIH=DIH_U" S %=$P(DIH,U,15,999),DIU=$P(DIH,U,14),^(.52)=$P(DIH,U,1,13)_U_DIV_$S(%]"":U_%,1:""),DIH=2,DIG=.5294 D ^DICR
"^DD",2,2,.5291,1,3,"CREATE CONDITION")
IN COMBAT="NO"
"^DD",2,2,.5291,1,3,"CREATE VALUE")
@
"^DD",2,2,.5291,1,3,"DELETE CONDITION")
IN COMBAT=""
"^DD",2,2,.5291,1,3,"DELETE VALUE")
NO EFFECT
"^DD",2,2,.5291,1,3,"FIELD")
COMBAT TO DATE
"^DD",2,2,.5291,1,4,0)
2^AENR5291^MUMPS
"^DD",2,2,.5291,1,4,1)
D EVENT^IVMPLOG(DA)
"^DD",2,2,.5291,1,4,2)
D EVENT^IVMPLOG(DA)
"^DD",2,2,.5291,1,4,"%D",0)
^^2^2^3040614^
"^DD",2,2,.5291,1,4,"%D",1,0)
This MUMPS cross-reference is used to notify HEC of changes to the
"^DD",2,2,.5291,1,4,"%D",2,0)
COMBAT SERVICE INDICATED? field.
"^DD",2,2,.5291,1,4,"DT")
3040614
"^DD",2,2,.5291,1,5,0)
2^AI^MUMPS
"^DD",2,2,.5291,1,5,1)
D CSI1010^DGENDD(DA)
"^DD",2,2,.5291,1,5,2)
Q
"^DD",2,2,.5291,1,5,"%D",0)
^^4^4^3061023^
"^DD",2,2,.5291,1,5,"%D",1,0)
This MUMPS xref will trigger an update to the COMBAT
"^DD",2,2,.5291,1,5,"%D",2,0)
INDICATED ON 1010EZ field (2/1010.157), so that when
"^DD",2,2,.5291,1,5,"%D",3,0)
COMBAT SERVICE INDICATED? is "NO," COMBAT INDICATED
"^DD",2,2,.5291,1,5,"%D",4,0)
ON 1010EZ is set to "NO."
"^DD",2,2,.5291,1,5,"DT")
3061023
"^DD",2,2,.5291,3)
Did this patient serve in combat?
"^DD",2,2,.5291,20,0)
^.3LA^1^1
"^DD",2,2,.5291,20,1,0)
CS
"^DD",2,2,.5291,21,0)
^^4^4^2861006^
"^DD",2,2,.5291,21,1,0)
For this veteran applicant enter 'Y' if s/he served in a combat
"^DD",2,2,.5291,21,2,0)
zone, or 'N' if not.  Once the service record is verified only
"^DD",2,2,.5291,21,3,0)
users who hold the designated security key may enter/edit this
"^DD",2,2,.5291,21,4,0)
field.
"^DD",2,2,.5291,"DEL",1,0)
S DFN=DA D SV^DGLOCK I '$D(X)
"^DD",2,2,.5291,"DT")
3061023
"^DD",2,2,.5294,0)
COMBAT TO DATE^RDX^^.52;14^S %DT="E" D ^%DT S X=Y K:'$$VALCON^DGRPMS(DA,"COMB",X,1) X I $D(X) S DFN=DA D COM^DGLOCK I $D(X) D DOB^DGHELP
"^DD",2,2,.5294,.1)

"^DD",2,2,.5294,1,0)
^.1
"^DD",2,2,.5294,1,1,0)
2^AENR5294^MUMPS
"^DD",2,2,.5294,1,1,1)
D EVENT^IVMPLOG(DA)
"^DD",2,2,.5294,1,1,2)
D EVENT^IVMPLOG(DA)
"^DD",2,2,.5294,1,1,"%D",0)
^.101^2^2^3040708^^
"^DD",2,2,.5294,1,1,"%D",1,0)
This MUMPS cross-reference is used to notify HEC of changes to the
"^DD",2,2,.5294,1,1,"%D",2,0)
COMBAT TO DATE field.
"^DD",2,2,.5294,1,1,"DT")
3040610
"^DD",2,2,.5294,1,2,0)
2^AK^MUMPS
"^DD",2,2,.5294,1,2,1)
D CTD1010^DGENDD(DA)
"^DD",2,2,.5294,1,2,2)
Q
"^DD",2,2,.5294,1,2,"%D",0)
^^9^9^3061023^
"^DD",2,2,.5294,1,2,"%D",1,0)
This MUMPS xref will trigger an update to the COMBAT
"^DD",2,2,.5294,1,2,"%D",2,0)
INDICATED ON 1010EZ field (2/1010.157), so that when
"^DD",2,2,.5294,1,2,"%D",3,0)
COMBAT SERVICE INDICATED? (2/.5291) is "YES" and
"^DD",2,2,.5294,1,2,"%D",4,0)
COMBAT TO DATE (2/.5294) is greater that 11/11/1998,
"^DD",2,2,.5294,1,2,"%D",5,0)
COMBAT INDICATED ON 1010EZ is set to "YES."
"^DD",2,2,.5294,1,2,"%D",6,0)
 
"^DD",2,2,.5294,1,2,"%D",7,0)
Conversely, if COMBAT TO DATE is less than or equal
"^DD",2,2,.5294,1,2,"%D",8,0)
to 11/11/1998, COMBAT INDICATED ON 1010EZ will be
"^DD",2,2,.5294,1,2,"%D",9,0)
set to "NO."
"^DD",2,2,.5294,1,2,"DT")
3061023
"^DD",2,2,.5294,3)
For this combat veteran enter the date combat service ended.
"^DD",2,2,.5294,5,1,0)
2^.5291^3
"^DD",2,2,.5294,20,0)
^.3LA^1^1
"^DD",2,2,.5294,20,1,0)
CS
"^DD",2,2,.5294,21,0)
^^6^6^2910116^^^
"^DD",2,2,.5294,21,1,0)
For this veteran who served in a combat zone (IN COMBAT prompt must
"^DD",2,2,.5294,21,2,0)
be answered YES) enter the date on which combat service ended.
"^DD",2,2,.5294,21,3,0)
Once the service record is verified
"^DD",2,2,.5294,21,4,0)
only those users who hold the designated security key may
"^DD",2,2,.5294,21,5,0)
enter/edit this field.  This field cannot be deleted as long as
"^DD",2,2,.5294,21,6,0)
combat service is indicated.
"^DD",2,2,.5294,"DEL",1,0)
S DFN=DA D COMD^DGLOCK1 I '$D(X)
"^DD",2,2,.5294,"DT")
3061023
"BLD",6504,6)
^652
**END**
**END**
