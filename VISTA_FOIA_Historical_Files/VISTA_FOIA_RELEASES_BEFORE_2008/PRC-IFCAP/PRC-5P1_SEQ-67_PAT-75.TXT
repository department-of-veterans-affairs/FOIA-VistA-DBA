$TXT Created by GREENE,LYFORD K. at MNTVBB.FO-WASH.MED.VA.GOV  (KIDS) on Friday, 01/28/05 at 16:36
=============================================================================
Run Date: MAY 11, 2005                     Designation: PRC*5.1*75
Package : PRC - IFCAP                         Priority: Mandatory
Version : 5.1        SEQ #67                    Status: Released
                  Compliance Date: JUN 11, 2005
=============================================================================


Subject: NATIONAL ITEM FILE - ITEM EXTRACT

Category: 
  - Routine
  - Enhancement (Mandatory)

Description:
============

 This patch was developed as an initial deliverable for IT Service
 Request #20030703 National Item File - Phase II, which is online at 
 http://vista.med.va.gov/pas/ViewTrackingRecord.asp?RequestID=20030703.
  
 The main objective of this software is to extract active items that were
 purchased within the previous 12 months; were received, issued, assembled,
 or manually adjusted in a Generic Inventory Package (GIP) inventory point
 within the previous 12 months; and flagged in the ITEM MASTER (#441) file
 as reusable, or are components of an active case cart or instrument kit.
 Last used vendor specific information for selected items is also
 extracted.
  
 Items that have previously been assigned a NIF Item Number are excluded
 from the extract.  This prevents the items from being reprocessed if an 
 additional extract is subsequently submitted from that site.
  
 When invoking the compile, the user is asked whether physical count
 transactions in GIP should also be included in the analysis of inventory
 item activity.  Depending on the circumstance, the user should answer 
 'YES' when a large number of items have recently been added to the GIP 
 inventory, but have not yet been received or issued or 'NO' to exclude 
 slow moving stock from NIF processing.
  
 The output consists of variable length records of up-arrow/caret ("^")
 delimited fields written to a host file.
  
 The goal is to save the Department of Veterans Affairs (VA) money and to
 reduce the time necessary to process each station's data by restricting
 the extraction to items currently in use, rather than submitting the
 entire contents of the ITEM MASTER (#441) file to the NIF contractor for
 processing.
  
 This project's Software Requirements Specification (SRS), Software Design 
 Document (SDD) and other information can currently be found at the
 Technical Services Project Repository's (TSPR) National Item File - Phase 
 II website located at
 http://tspr.vista.med.va.gov/warboard/anotebk.asp?proj=805&Type=Active.
  
 This patch can be installed upon receipt.  The extraction, however, 
 should be executed when the site is notified by the VHA Office of 
 Clinical Logistics to submit item data for processing by the NIF 
 contractor.  
  
  
 This patch addresses the following New Service Request (NSR):
 -------------------------------------------------------------
 20030703 National Item File - Phase II
  
  
 This patch addresses the following NOIS/Remedy Ticket(s):
 --------------------------------------------------- 
 There are no NOIS/Remedy tickets associated with this patch.
  
  
  
 Test Sites:
 ---------------------------
 VISN 2
 VISN 8 sites
 VISN 9 sites
 Columbia SC VAMC
 Minneapolis VAMC
 Togus VAMC
  
     ************************************************************
     * Although this patch can be installed upon receipt, the   *
     * extraction (noted in the post-install instructions)      *
     * should be executed when the site is notified by the VHA  *
     * Office of Clinical Logistics to submit item data for     *
     * processing by the NIF contractor.                        *
     ************************************************************ 
  
          ================INSTALLATION INSTRUCTIONS =================
  
 If installed during the normal workday, it is recommended that the
 following selections in the OPTION (#19) file and all of their descendants
 be disabled to prevent possible conflicts while running the KIDS Install.
 Other VISTA users will not be affected.
  
          No menu options need to be disabled.
  
  
 Install Time - less than 20 minutes for installation of the KIDS
 distribution and entry of the required device file entry.
  
  
   1.   LOAD TRANSPORT GLOBAL 
        ---------------------
        Choose the PackMan message containing this patch and invoke the 
        INSTALL/CHECK MESSAGE PackMan option.  
              
   2.   DISABLE ROUTINE MAPPING   (DSM for Open VMS sites only) 
        -----------------------
        Disable routine mapping on all systems for the routines listed in 
        step 3 below.
   
        NOTE:  If the routines included in this patch are not currently in 
               your mapped routine set, please skip this step.
               Since the routines with this patch are new, they are not
               expected to be mapped.  DSM for Open VMS sites:  Be 
               sure to read the instructions in 7.  REBUILD MAPPED 
               ROUTINE(S).
   
   3.   COMPONENTS SENT WITH PATCH 
        ------------------------
        The following is a list of the routines included in this patch.  
        The second line of each of these routines now looks like: 
   
            ;;5.1;IFCAP;**[patch list]**;Oct 20, 2000 
   
                            CHECK^XTSUMBLD results
  
        Routine          Before Patch     After Patch   Patch List 
        -------          ------------     -----------   ----------
        PRCHITX          N/A              18103266          75
        PRCHITX1         N/A              7407139           75
        PRCHITX2         3221747          deleted           75
            (Routine PRCHITX2 may exist at prior test sites for this
             patch.)
   
         Total number of routines: 3
  
         Total number of new routines: 2
         Total number of deleted routines: 1
  
  
   4.   START UP KIDS 
        -------------
        Start up the Kernel Installation and Distribution System Menu 
        [XPD MAIN]: 
    
             Edits and Distribution ...  
             Utilities ...  
             Installation ...  
    
     Select Kernel Installation & Distribution System Option: INStallation
                                                              ---
  
             Load a Distribution 
             Print Transport Global 
             Compare Transport Global to Current System 
             Verify Checksums in Transport Global 
             Install Package(s) 
             Restart Install of Package(s) 
             Unload a Distribution 
             Backup a Transport Global 
    
     Select Installation Option: 
    
   5.   Select Installation Option: 
        --------------------------
        NOTE:  The following are OPTIONAL - (When prompted for the INSTALL
               NAME, enter PRC*5.1*75):
       
        a.  Backup a Transport Global - This option will create a backup
            message of any routines exported with this patch. It will not
            backup any other changes such as DD's or templates.
        b.  Compare Transport Global to Current System - This option will
            allow you to view all changes that will be made when this patch
            is installed.  It compares all components of this patch
            (routines, DD's, templates, etc.).
        c.  Verify Checksums in Transport Global - This option will allow
            you to ensure the integrity of the routines that are in the
            transport global.
      
   6.   Select Installation Option: Install Package(s) 
                                    ----------------
        **This is the step to start the installation of this KIDS patch: 
    
        a.  Choose the Install Package(s) option to start the patch
            install.
        b.  When prompted 'Want KIDS to INHIBIT LOGONs during the install?
            YES//' answer NO.
        c.  When prompted 'Want to DISABLE Scheduled Options, Menu Options,
            and Protocols? YES//' answer NO.
  
   7.   REBUILD MAPPED ROUTINE(S)  (DSM for Open VMS sites only)
        -------------------------
        Optional - Include the routines distributed with this patch in the
        mapped routine set.
      
           NOTE: This step is only necessary if you performed step 2 or 
                 if you wish to include the routines in your mapped set.
                 As this extraction process will probably only be run once
                 or twice at each site, it is recommended that the routines
                 not be mapped.
  
  
 **************** POST-INSTALLATION INSTRUCTIONS **************** 
  
   1.   CREATE HOST FILE SERVER DEVICE:
        -------------------------------
        Using VA FileMan, create the HFS type device for the extract's
        output.  The definition is different for DSM/VMS sites, Cache/NT,
        Cache/VMS and MSM/NT sites, as shown for the DEVICE (#3.5) file
        entries listed in 1a, 1b, 1c, etc.  New device definitions are
        necessary as this extract produces record lengths that can
        potentially be as long as 4 Kilobytes and some systems have a
        default maximum of 512 bytes.
  
        The operating system will break into multiple lines those records
        that exceed the default or specified length.  The extended record
        lengths on some MUMPS systems are specified in the Open Parameters.
        It is also necessary, in some cases, to override the default host
        file protection scheme so that the files can be retrieved.  In
        DSM/VMS, the desired file access permissions are also specified in
        the Open Parameters.
  
        The TERMINAL TYPE (#3.2) file entry referenced by the SUBTYPE (#3)
        field must not write control codes to the output buffer via MUMPS
        code in either the OPEN EXECUTE (#6) field or CLOSE EXECUTE (#7)
        field.  Form feeds, font setting codes etc. will cause problems
        when the extract is loaded into NIF interface tables.
  
        a.  Device characteristics for DSM/VMS
            ----------------------------------
            NAME: PRC_WIDE_HOST_FILE        $I: TMP.TMP
            ASK PARAMETERS: NO
            LOCATION OF TERMINAL: DSM/VMS HOST FILE ON DISK
            ASK HOST FILE: YES            ASK HFS I/O OPERATION: NO
            OPEN PARAMETERS: 
            (NEWVERSION,RECORDSIZE=4096,PROTECTION=(S:RWED,O:RWED,G:RWED,W:RWED))
            SUBTYPE: P-OTHER              TYPE: HOST FILE SERVER
  
        NOTE:  A sample edit dialog for DSM sites is as follows:
              Select VA FileMan Option: ENTER or Edit File Entries
  
              INPUT TO WHAT FILE: CALM/LOG BATCH TYPE// DEVICE    (295
                entries)
              EDIT WHICH FIELD: ALL// NAME  
              THEN EDIT FIELD: $I  
              THEN EDIT FIELD: ASK PARAMETERS  
              THEN EDIT FIELD: LOCATION OF TERMINAL  
              THEN EDIT FIELD: ASK HOST FILE  
              THEN EDIT FIELD: ASK HFS I/O OPERATION  
              THEN EDIT FIELD: OPEN PARAMETERS  
              THEN EDIT FIELD: TYPE
                    1   TYPE  
                    2   TYPE-AHEAD  
              CHOOSE 1-2: 1  TYPE
              THEN EDIT FIELD: SUBTYPE
              THEN EDIT FIELD: 
              STORE THESE FIELDS IN TEMPLATE: 
  
              Select DEVICE NAME: PRC_WIDE_HOST_FILE
              Are you adding 'PRC_WIDE_HOST_FILE' as a new DEVICE (the
                296TH)? No// Y (Yes)
              DEVICE LOCATION OF TERMINAL: DSM/VMS HOST FILE ON DISK
              DEVICE $I: TMP.TMP          This $I in use by other Devices.
              DEVICE VOLUME SET(CPU): 
              DEVICE TYPE: HFS  HOST FILE SERVER
              $I: TMP.TMP// 
              ASK PARAMETERS: N  NO
              LOCATION OF TERMINAL: DSM/VMS HOST FILE ON DISK// 
              ASK HOST FILE: Y  YES
              ASK HFS I/O OPERATION: N  NO
              OPEN PARAMETERS: 
              (NEWVERSION,RECORDSIZE=4096,PROTECTION=(S:RWED,O:RWED,G:RWED,W:RWED))
              TYPE: HOST FILE SERVER// 
              SUBTYPE: P-OTHER   General printer (132)
  
              Select DEVICE NAME:
  
        b.  Device characteristics for Cache/NT or 2000
            -------------------------------------------
            NAME: PRC_WIDE_HOST_FILE        $I: TMP.TMP
            ASK PARAMETERS: NO
            LOCATION OF TERMINAL: CACHE/NT HOST FILE ON DISK
            ASK HOST FILE: YES           ASK HFS I/O OPERATION: NO
            OPEN PARAMETERS: "WNS"       SUBTYPE: P-OTHER
            TYPE: HOST FILE SERVER
  
  
        c.  Device characteristics for Cache/VMS
            --------------------------------------
            NAME: PRC_WIDE_HOST_FILE        $I: TMP.TMP
            ASK PARAMETERS: NO
            LOCATION OF TERMINAL: CACHE/VMS HOST FILE ON DISK
            ASK HOST FILE: YES           ASK HFS I/O OPERATION: NO
            OPEN PARAMETERS: "WNS"       SUBTYPE: P-OTHER
            TYPE: HOST FILE SERVER
  
  
        d.  Device characteristics for MSM/NT
            ---------------------------------
            NAME: PRC_WIDE_HOST_FILE        $I: 51
            ASK PARAMETERS: NO
            LOCATION OF TERMINAL: MSM/NT HOST FILE ON DISK
            ASK HOST FILE: NO            ASK HFS I/O OPERATION: NO
            OPEN PARAMETERS: ("C:\MSM\IFCPITEMxxx.DAT":"W")
            SUBTYPE: P-OTHER             TYPE: HOST FILE SERVER
  
        NOTE:  Where xxx is the Station Number of your VistA installation.
               Substitute the appropriate path instead of "C:\MSM\"
  
  
   2.  EXECUTE THE EXTRACTION:
       -----------------------
       When the VHA Office of Clinical Logistics notifies the site,
       execute the item data extraction.  Refer to the example.
  
       NOTE:  It is best to queue the compile to a time when there
              are reduced levels of user purchasing and inventory
              activity.
  
       Select Programmer Options Option: PG  Programmer mode
  
       >D ^PRCHITX1
         
       This option writes item information to the .dat file.
  
       It is recommended to queue this extract for a time of low user
       activity.
       Include physical inventory count transactions in the analysis? 
       NO// ?
  
       Answer 'YES' if you have a large number of items that have 
       recently been added to your GIP inventory, but have not yet been
       received or issued.
       Answer 'NO' to exclude slow moving stock from NIF processing.
  
       Include physical inventory count transactions in the analysis?
       NO//    (Answer YES or NO as appropriate)
       Host File Device: PRC_WIDE_HOST_FILE// QUEUE TO PRINT ON
       DEVICE: PRC_WIDE_HOST_FILE//   DSM/VMS HOST FILE ON DISK
       HOST FILE NAME: TMP.TMP//USER$:[ANONYMOUS]IFCPITEMxxx.DAT
  
       NOTE:  Where xxx is the Station Number of the user's VistA
              installation.  'IFCP' is IFCAP's namespace for host files.  
              Also, substitute the appropriate directory in place of
              'USER$:[ANONYMOUS]', (provided as an example).
              It is recommended that the user specify a directory, rather
              than accept the default.
  
          
       Requested Start Time: NOW//T@2110  (NOV 25, 2003@21:10:00)
       Task #914972
  
       NOTE:  The elapsed time for the compilation and host file creation
              will vary depending on the size of the user's database and
              the competing processes, but the process will probably be
              under 40 minutes.
  
       Once the process completes, a MailMan message (containing the item
       and vendor record counts) will be sent to the user who invoked the
       extraction.  Below the counts will be the sentence 'Physical count
       transactions were included in the analysis.' if the user previously 
       answered 'YES'.  If the user previously answered 'NO', the sentence
       'Physical count transactions were not included in the analysis.' 
       will be displayed.
  
       For executions in production accounts, the MailMan message will also
       be sent to the VHA OI SDD PRCHITEM distribution list
       (prchitem@va.gov) on Exchange.  The message's subject line is:
       "Subj: NIF Item Extract Statistics for Station xxx"
      
       NOTE:  Where xxx is the user's Station Number.  The sender is the
              NIF ITEM EXTRACTOR.
  
   3.  FTP THE RESULTS
       ---------------
       File Transfer Protocol (FTP) the file in ASCII (NOT Binary) mode to
       the VA FTP server, which will be specified when the site is
       scheduled to submit an extract.
  
       Upon the successful completion of the data extract and file
       transfer to the specified FTP directory, the IRM staff should send
       an e-mail message, via Exchange, to john.hinson@mail.va.gov.  The
       e-mail message should specify the station name, the station number,
       and the file transmission date.
  
       NOTE:  DO NOT DELETE routines PRCHITX or PRCHITX1 in case another
              extraction is necessary.

Routine Information:
====================

Routine Name:
  - PRCHITX

 This routine selects active ITEM MASTER (#441) file entries which have 
 met at least one of the following conditions:
   1. have been purchased in the previous 12 months
   2. have been received, issued, assembled, or manually adjusted by a
      GIP inventory point in the previous 12 months
   3. have been classified as reusable
   4. are components of an active case cart or instrument kit
   5. have been physically counted in a GIP inventory in the previous 12 
      months, in the case where the user had answered 'YES' to the question
      about including physical inventory count transactions in the 
      analysis.
 It excludes those items that have already been assigned a NIF Item Number.
 The routine then extracts item data and the associated last used vendor
 data for the selected items.

Routine Checksum:
See patch description.

Routine Name:
  - PRCHITX1

 This routine prompts the user for the decision on whether to process
 inventory physical count transactions in the analysis and for the output
 device information.  It then invokes the extract compile and writes the
 data to a host system flat file according to the specification jointly
 agreed upon with the National Item File contractor.  It also sends a
 MailMan message with the record counts.

Routine Checksum:
See patch description.

Routine Name:
  - PRCHITX2

 Most sites will not have this routine.  It was distributed in an earlier 
 version of this patch to compile a list of items purchased by the
 Prosthetics & Sensory Aids Service.  This routine is now being deleted as
 this functionality is no longer appropriate, because Prosthetics is
 developing its own item submission for the NIF.

Routine Checksum:
See patch description.

=============================================================================
User Information:
Entered By  : GREENE,LYFORD                 Date Entered  : NOV 18, 2003
Completed By: BURGESS,PATRICIA              Date Completed: MAY 11, 2005
Released By : NELSON,VICKI M                Date Released : MAY 11, 2005
=============================================================================


Packman Mail Message:
=====================

$END TXT
