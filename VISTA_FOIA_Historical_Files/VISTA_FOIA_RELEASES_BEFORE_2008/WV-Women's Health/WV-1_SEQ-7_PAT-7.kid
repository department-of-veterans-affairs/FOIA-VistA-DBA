Released WV*1*7 SEQ #7
Extracted from mail message
**KIDS**:WV*1.0*7^

**INSTALL NAME**
WV*1.0*7
"BLD",1756,0)
WV*1.0*7^WOMEN'S HEALTH^0^2991012^y
"BLD",1756,1,0)
^^2^2^2991004^^^
"BLD",1756,1,1,0)
Please read the WV*1*7 patch description on FORUM for an explanation of
"BLD",1756,1,2,0)
what this patch does.
"BLD",1756,4,0)
^9.64PA^790.31^6
"BLD",1756,4,790,0)
790
"BLD",1756,4,790,2,0)
^9.641^790^2
"BLD",1756,4,790,2,790,0)
WV PATIENT  (File-top level)
"BLD",1756,4,790,2,790,1,0)
^9.6411^.23^3
"BLD",1756,4,790,2,790,1,.15,0)
DES DAUGHTER
"BLD",1756,4,790,2,790,1,.23,0)
FAMILY HX OF BR CA
"BLD",1756,4,790,2,790,1,.27,0)
SEXUAL TRAUMA
"BLD",1756,4,790,2,790.09,0)
APPOINTMENTS  (sub-file)
"BLD",1756,4,790,2,790.09,1,0)
^9.6411^^0
"BLD",1756,4,790,222)
y^n^p^^^^n
"BLD",1756,4,790.02,0)
790.02
"BLD",1756,4,790.02,2,0)
^9.641^790.02^1
"BLD",1756,4,790.02,2,790.02,0)
WV SITE PARAMETER  (File-top level)
"BLD",1756,4,790.02,2,790.02,1,0)
^9.6411^41.03^6
"BLD",1756,4,790.02,2,790.02,1,39.01,0)
TUBE ACTIVE
"BLD",1756,4,790.02,2,790.02,1,39.03,0)
TUBE DEF DAYS DELINQ
"BLD",1756,4,790.02,2,790.02,1,40.01,0)
PELUS ACTIVE
"BLD",1756,4,790.02,2,790.02,1,40.03,0)
PELUS DEF DAYS DELINQ
"BLD",1756,4,790.02,2,790.02,1,41.01,0)
VAGUS ACTIVE
"BLD",1756,4,790.02,2,790.02,1,41.03,0)
VAGUS DEF DAYS DELINQ
"BLD",1756,4,790.02,222)
y^n^p^^^^n
"BLD",1756,4,790.2,0)
790.2
"BLD",1756,4,790.2,222)
y^n^f^^n^^y^m^n
"BLD",1756,4,790.2,224)
I Y>38
"BLD",1756,4,790.31,0)
790.31
"BLD",1756,4,790.31,222)
n^n^f^^n^^y^r^n
"BLD",1756,4,790.31,224)

"BLD",1756,4,790.4,0)
790.4
"BLD",1756,4,790.4,222)
y^n^f^^^^n
"BLD",1756,4,790.71,0)
790.71
"BLD",1756,4,790.71,222)
y^n^f^^^^n
"BLD",1756,4,"APDD",790,790)

"BLD",1756,4,"APDD",790,790,.15)

"BLD",1756,4,"APDD",790,790,.23)

"BLD",1756,4,"APDD",790,790,.27)

"BLD",1756,4,"APDD",790,790.09)

"BLD",1756,4,"APDD",790.02,790.02)

"BLD",1756,4,"APDD",790.02,790.02,39.01)

"BLD",1756,4,"APDD",790.02,790.02,39.03)

"BLD",1756,4,"APDD",790.02,790.02,40.01)

"BLD",1756,4,"APDD",790.02,790.02,40.03)

"BLD",1756,4,"APDD",790.02,790.02,41.01)

"BLD",1756,4,"APDD",790.02,790.02,41.03)

"BLD",1756,4,"B",790,790)

"BLD",1756,4,"B",790.02,790.02)

"BLD",1756,4,"B",790.2,790.2)

"BLD",1756,4,"B",790.31,790.31)

"BLD",1756,4,"B",790.4,790.4)

"BLD",1756,4,"B",790.71,790.71)

"BLD",1756,"ABPKG")
n
"BLD",1756,"INIT")
WV7PST
"BLD",1756,"KRN",0)
^9.67PA^19^18
"BLD",1756,"KRN",.4,0)
.4
"BLD",1756,"KRN",.401,0)
.401
"BLD",1756,"KRN",.402,0)
.402
"BLD",1756,"KRN",.403,0)
.403
"BLD",1756,"KRN",.403,"NM",0)
^9.68A^1^1
"BLD",1756,"KRN",.403,"NM",1,0)
WV SITE PARAMS-FORM-1    FILE #790.02^790.02^0
"BLD",1756,"KRN",.403,"NM","B","WV SITE PARAMS-FORM-1    FILE #790.02",1)

"BLD",1756,"KRN",.5,0)
.5
"BLD",1756,"KRN",.84,0)
.84
"BLD",1756,"KRN",3.6,0)
3.6
"BLD",1756,"KRN",3.8,0)
3.8
"BLD",1756,"KRN",9.2,0)
9.2
"BLD",1756,"KRN",9.8,0)
9.8
"BLD",1756,"KRN",9.8,"NM",0)
^9.68A^23^22
"BLD",1756,"KRN",9.8,"NM",1,0)
WVUTL9^^0^B5186118
"BLD",1756,"KRN",9.8,"NM",2,0)
WVLETPR^^0^B34996416
"BLD",1756,"KRN",9.8,"NM",3,0)
WVUTL1^^0^B39200608
"BLD",1756,"KRN",9.8,"NM",4,0)
WVUTL1A^^0^B35324430
"BLD",1756,"KRN",9.8,"NM",5,0)
WVRPSNP^^0^B43016328
"BLD",1756,"KRN",9.8,"NM",6,0)
WVRPST^^0^B15157327
"BLD",1756,"KRN",9.8,"NM",7,0)
WVUTL7^^0^B40245215
"BLD",1756,"KRN",9.8,"NM",9,0)
WVRADWP^^0^B25478768
"BLD",1756,"KRN",9.8,"NM",10,0)
WVPROF2^^0^B22021069
"BLD",1756,"KRN",9.8,"NM",11,0)
WVPRPCD^^0^B22667860
"BLD",1756,"KRN",9.8,"NM",12,0)
WVUTL6^^0^B11211277
"BLD",1756,"KRN",9.8,"NM",13,0)
WVGETAL1^^0^B2009629
"BLD",1756,"KRN",9.8,"NM",14,0)
WVGETALL^^0^B56519718
"BLD",1756,"KRN",9.8,"NM",15,0)
WVRPSNP1^^0^B22704718
"BLD",1756,"KRN",9.8,"NM",16,0)
WVPOST^^1^
"BLD",1756,"KRN",9.8,"NM",17,0)
WVRALINK^^0^B42806410
"BLD",1756,"KRN",9.8,"NM",18,0)
WVEXPTRA^^0^B42180249
"BLD",1756,"KRN",9.8,"NM",19,0)
WVBRNED^^0^B29784744
"BLD",1756,"KRN",9.8,"NM",20,0)
WVNOTIF^^0^B22756649
"BLD",1756,"KRN",9.8,"NM",21,0)
WVRPSCR1^^0^B36274367
"BLD",1756,"KRN",9.8,"NM",22,0)
WVRPSCR2^^0^B9166089
"BLD",1756,"KRN",9.8,"NM",23,0)
WV7PST^^0^B19913075
"BLD",1756,"KRN",9.8,"NM","B","WV7PST",23)

"BLD",1756,"KRN",9.8,"NM","B","WVBRNED",19)

"BLD",1756,"KRN",9.8,"NM","B","WVEXPTRA",18)

"BLD",1756,"KRN",9.8,"NM","B","WVGETAL1",13)

"BLD",1756,"KRN",9.8,"NM","B","WVGETALL",14)

"BLD",1756,"KRN",9.8,"NM","B","WVLETPR",2)

"BLD",1756,"KRN",9.8,"NM","B","WVNOTIF",20)

"BLD",1756,"KRN",9.8,"NM","B","WVPOST",16)

"BLD",1756,"KRN",9.8,"NM","B","WVPROF2",10)

"BLD",1756,"KRN",9.8,"NM","B","WVPRPCD",11)

"BLD",1756,"KRN",9.8,"NM","B","WVRADWP",9)

"BLD",1756,"KRN",9.8,"NM","B","WVRALINK",17)

"BLD",1756,"KRN",9.8,"NM","B","WVRPSCR1",21)

"BLD",1756,"KRN",9.8,"NM","B","WVRPSCR2",22)

"BLD",1756,"KRN",9.8,"NM","B","WVRPSNP",5)

"BLD",1756,"KRN",9.8,"NM","B","WVRPSNP1",15)

"BLD",1756,"KRN",9.8,"NM","B","WVRPST",6)

"BLD",1756,"KRN",9.8,"NM","B","WVUTL1",3)

"BLD",1756,"KRN",9.8,"NM","B","WVUTL1A",4)

"BLD",1756,"KRN",9.8,"NM","B","WVUTL6",12)

"BLD",1756,"KRN",9.8,"NM","B","WVUTL7",7)

"BLD",1756,"KRN",9.8,"NM","B","WVUTL9",1)

"BLD",1756,"KRN",19,0)
19
"BLD",1756,"KRN",19,"NM",0)
^9.68A^1^1
"BLD",1756,"KRN",19,"NM",1,0)
WV IMPORT RAD/NM EXAMS^^0
"BLD",1756,"KRN",19,"NM","B","WV IMPORT RAD/NM EXAMS",1)

"BLD",1756,"KRN",19.1,0)
19.1
"BLD",1756,"KRN",101,0)
101
"BLD",1756,"KRN",409.61,0)
409.61
"BLD",1756,"KRN",771,0)
771
"BLD",1756,"KRN",869.2,0)
869.2
"BLD",1756,"KRN",870,0)
870
"BLD",1756,"KRN",8994,0)
8994
"BLD",1756,"KRN","B",.4,.4)

"BLD",1756,"KRN","B",.401,.401)

"BLD",1756,"KRN","B",.402,.402)

"BLD",1756,"KRN","B",.403,.403)

"BLD",1756,"KRN","B",.5,.5)

"BLD",1756,"KRN","B",.84,.84)

"BLD",1756,"KRN","B",3.6,3.6)

"BLD",1756,"KRN","B",3.8,3.8)

"BLD",1756,"KRN","B",9.2,9.2)

"BLD",1756,"KRN","B",9.8,9.8)

"BLD",1756,"KRN","B",19,19)

"BLD",1756,"KRN","B",19.1,19.1)

"BLD",1756,"KRN","B",101,101)

"BLD",1756,"KRN","B",409.61,409.61)

"BLD",1756,"KRN","B",771,771)

"BLD",1756,"KRN","B",869.2,869.2)

"BLD",1756,"KRN","B",870,870)

"BLD",1756,"KRN","B",8994,8994)

"BLD",1756,"QUES",0)
^9.62^^
"BLD",1756,"REQB",0)
^9.611^4^4
"BLD",1756,"REQB",1,0)
WV*1.0*6^2
"BLD",1756,"REQB",2,0)
WV*1.0*5^2
"BLD",1756,"REQB",3,0)
WV*1.0*4^2
"BLD",1756,"REQB",4,0)
WV*1.0*3^2
"BLD",1756,"REQB","B","WV*1.0*3",4)

"BLD",1756,"REQB","B","WV*1.0*4",3)

"BLD",1756,"REQB","B","WV*1.0*5",2)

"BLD",1756,"REQB","B","WV*1.0*6",1)

"DATA",790.2,39,0)
TUBAL LIGATION^TUBE^0^TL^^^^^^^0
"DATA",790.2,40,0)
PELVIC ULTRASOUND^PELUS^0^PU^R^^^76856^^^0
"DATA",790.2,41,0)
VAGINAL ULTRASOUND^VAGUS^0^VU^R^^^76830^^^0
"DATA",790.31,1,0)
Invasive CA: Cervical^1^1^2^19^17^23^7^18^3^8^^^^^^^^^0^1
"DATA",790.31,3,0)
HGSIL: CIS/CINIII/CINII^2^1^^^^^^^^^^^^^^^^^0^1
"DATA",790.31,5,0)
LGSIL: CINI/HPV^3^1^^^^^^^^^^^^^^^^^0^1
"DATA",790.31,7,0)
Insufficient Tissue^1^^2^17^7^23^19^18^^8^30^34^35^31^32^33^^^0^2
"DATA",790.31,8,0)
Error/disregard^95^^^^^^^^^^^^^^^^^^1^2^^1
"DATA",790.31,9,0)
Negative^90^20^21^25^26^28^^^^^^^^^^^^^0^0
"DATA",790.31,10,0)
Positive^6^20^21^^^^^^^^^^^^^^^^0^1
"DATA",790.31,11,0)
WNL/Normal^90^27^2^19^7^18^8^^23^17^1^21^^^^^^^0^0^^^^^^^^^NORMAL
"DATA",790.31,12,0)
Unsatisfactory for Dx^2^2^1^19^7^18^^23^17^25^26^28^^^^^^^0^2
"DATA",790.31,13,0)
ASCUS^1^1^^^^^^^^^^^^^^^^^0^1
"DATA",790.31,15,0)
Benign Changes^6^2^19^17^23^7^18^^8^^^^^^^^^^0^0
"DATA",790.31,16,0)
HPV/condyloma^3^2^19^17^23^7^^18^^^^^^^^^^^0^1^1^^^^^^^^Condyloma
"DATA",790.31,17,0)
CIN I/mild dysplasia^3^2^19^17^7^23^18^3^^^^^^^^^^^0^1
"DATA",790.31,18,0)
CIN II/moderate dysplasia^2^2^19^17^23^7^18^3^^^^^^^^^^^0^1
"DATA",790.31,19,0)
CIN III/severe dysplasia^2^2^19^17^7^23^18^3^^^^^^^^^^^0^1
"DATA",790.31,20,0)
Done^92^4^22^40^41^39^^^^^^^^^^^^^0^2
"DATA",790.31,22,0)
AGCUS, malignant^1^1^^^^^^^^^^^^^^^^^0^1
"DATA",790.31,24,0)
AGCUS, premalignant^1^1^^^^^^^^^^^^^^^^^0^1
"DATA",790.31,30,0)
Inflammation/Cervicitis^5^2^19^17^23^7^18^3^^^^^^^^^^^0^1
"DATA",790.31,32,0)
Not Done^99^21^7^^^^^^^^^^^^^^^^0^2
"DATA",790.31,33,0)
AGCUS^1^1^^^^^^^^^^^^^^^^^0^1
"DATA",790.31,37,0)
Abnormal Appearing Cervix^2^1^^^^^^^^^^^^^^^^^0^1^0^1
"DATA",790.31,39,0)
Other Malignant Neoplasms^1^1^^^^^19^3^23^17^^^^^^^^^0^1
"DATA",790.31,40,0)
ASCUS, premalignant^1^1^^^^^^^^^^^^^^^^^0^1
"DATA",790.31,41,0)
ASCUS, malignant^1^1^^^^^^^^^^^^^^^^^0^1
"DATA",790.31,42,0)
Squamous Cell Carcinoma^1^1^^^^^^^^^^^^^^^^^0^1
"DATA",790.31,43,0)
Benign Cell Chgs: Other^5^1^^^^^^^^^^^^^^^^^0^0
"DATA",790.31,44,0)
Benign Cell Chgs: react/atrphy^5^1^^^^^^^^^^^^^^^^^0^0
"DATA",790.31,45,0)
Benign Endometrial Cells^4^1^^^^^^^^^^^^^^^^^0^1
"DATA",790.31,46,0)
Benign Cell Chgs: react/inflam^5^1^^^^^^^^^^^^^^^^^0^0
"DATA",790.31,47,0)
Benign Cell Chgs: Infection^5^1^^^^^^^^^^^^^^^^^0^1
"DATA",790.31,48,0)
Benign Cell Chgs: react/radiat^5^1^^^^^^^^^^^^^^^^^0^1
"DATA",790.31,49,0)
Benign Cell Chgs: react/IUD^5^1^^^^^^^^^^^^^^^^^0^0
"DATA",790.31,50,0)
Benign Cell Chgs: react/other^5^1^^^^^^^^^^^^^^^^^0^0
"DATA",790.31,51,0)
Invasive CA: Other (non-cerv)^1^2^19^7^18^3^23^17^8^^^^^^^^^^0^1
"DATA",790.31,52,0)
Endometritis^5^8^3^^^^^^^^^^^^^^^^0^1
"DATA",790.31,53,0)
Adenomatous Hyperplas w/Atypia^2^8^3^^^^^^^^^^^^^^^^0^1
"DATA",790.31,54,0)
Adenomatous Hyperplas w/o Atyp^3^8^^^^^^^^^^^^^^^^^0^1
"DATA",790.31,55,0)
Carcinoma, Non-invasive^1^8^^^^^^^^^^^^^^^^^0^1
"DATA",790.31,56,0)
Benign Finding, Negative^5^25^26^28^^^^^^^^^^^^^^^0^0^^0
"DATA",790.31,57,0)
Prbly Benign, Short Int F/U^4^25^26^28^^^^^^^^^^^^^^^0^1
"DATA",790.31,58,0)
Suspicious Abnorm, Consider Bx^1^25^26^28^^^^^^^^^^^^^^^0^1
"DATA",790.31,59,0)
Highly Sug of Malig, Tk Action^1^25^26^28^^^^^^^^^^^^^^^0^1
"DATA",790.31,60,0)
See Patient Chart/Record^10^24^^^^^^^^^^^^^^^^^0^2^^0
"DATA",790.31,61,0)
Assessment Is Incomplete^2^25^26^28^^^^^^^^^^^^^^^0^2
"DATA",790.31,62,0)
Not Indicated^50^25^26^28^^^^^^^^^^^^^^^0^2
"DATA",790.31,63,0)
Indicated, But Not Performed^5^25^26^28^^^^^^^^^^^^^^^0^2
"DATA",790.31,64,0)
Benign Findings^6^27^29^30^34^35^31^32^33^^^^^^^^^^0^0^0^0
"DATA",790.31,65,0)
Discrete Mass^1^27^^^^^^^^^^^^^^^^^0^1^0^0
"DATA",790.31,66,0)
Retraction/Dimpling^1^27^^^^^^^^^^^^^^^^^0^1^0^0
"DATA",790.31,67,0)
Bloody Nipple Discharge^1^27^^^^^^^^^^^^^^^^^0^1^0^0
"DATA",790.31,68,0)
Nipple/Areolar Scaliness^1^27^^^^^^^^^^^^^^^^^0^1^0^0
"DATA",790.31,69,0)
CBE Refused^90^^^^^^^^^^^^^^^^^^0^2^0^0
"DATA",790.31,70,0)
HIV^5^21^^^^^^^^^^^^^^^^^0^1
"DATA",790.31,71,0)
Chlamydia^5^21^^^^^^^^^^^^^^^^^0^1
"DATA",790.31,72,0)
Gonorrhea^5^21^^^^^^^^^^^^^^^^^0^1
"DATA",790.31,73,0)
Syphilis^5^21^^^^^^^^^^^^^^^^^0^1
"DATA",790.31,74,0)
Trichomoniasis^5^21^^^^^^^^^^^^^^^^^0^1
"DATA",790.31,75,0)
Herpes^5^21^^^^^^^^^^^^^^^^^0^1
"DATA",790.31,76,0)
2 or more STD's^5^21^^^^^^^^^^^^^^^^^0^1
"DATA",790.31,77,0)
3 or more STD's^5^21^^^^^^^^^^^^^^^^^0^1
"DATA",790.31,78,0)
Not Available^90^29^27^2^19^7^18^8^^23^17^1^21^37^^^^^0^2^0^0
"DATA",790.31,79,0)
VIN I^3^2^^^^^^^^^^^^^^^^^0^1^0
"DATA",790.31,80,0)
VIN II^2^2^^^^^^^^^^^^^^^^^0^1^0
"DATA",790.31,81,0)
VIN III^2^2^^^^^^^^^^^^^^^^^0^1^0
"DATA",790.31,82,0)
VAIN I^3^2^^^^^^^^^^^^^^^^^0^1^0
"DATA",790.31,83,0)
VAIN II^2^2^^^^^^^^^^^^^^^^^0^1^0
"DATA",790.31,84,0)
VAIN III^2^2^^^^^^^^^^^^^^^^^0^1^0
"DATA",790.31,85,0)
Pregnant(no bx),Imp:Inflam^6^37^^^^^^^^^^^^^^^^^0^0
"DATA",790.31,86,0)
Pregnant(no bx),Imp:WNL^90^37^^^^^^^^^^^^^^^^^0^0
"DATA",790.31,87,0)
Pregnant(no bx),Imp:HPV^3^37^^^^^^^^^^^^^^^^^0^1
"DATA",790.31,88,0)
Pregnant(no bx),Imp:CIN I^3^37^^^^^^^^^^^^^^^^^0^1
"DATA",790.31,89,0)
Pregnant(no bx),Imp:CIN II^2^37^^^^^^^^^^^^^^^^^0^1
"DATA",790.31,90,0)
Pregnant(no bx),Imp:CIN III^2^37^^^^^^^^^^^^^^^^^0^1
"DATA",790.31,91,0)
Pregnant(no bx),Imp:Invasive^1^37^^^^^^^^^^^^^^^^^0^1
"DATA",790.31,92,0)
Atypia^5^29^30^34^35^31^32^33^^^^^^^^^^^0^1^^0
"DATA",790.31,93,0)
Carcinoma-in-situ^1^29^30^34^35^31^32^33^3^^^^^^^^^^0^1
"DATA",790.31,94,0)
Carcinoma-in-situ, NED^1^29^30^34^35^31^32^33^^^^^^^^^^^0^1
"DATA",790.31,95,0)
Carcinoma-in-situ, recurrent^1^29^30^34^35^31^32^33^^^^^^^^^^^0^1
"DATA",790.31,96,0)
Inflammation^5^29^30^34^35^31^32^33^^^^^^^^^^^0^1
"DATA",790.31,97,0)
Invasive Ca^1^29^30^34^35^31^32^33^^^^^^^^^^^0^1^^^^^^^^^ 
"DATA",790.31,98,0)
Invasive Ca, responding Rx^1^29^30^34^35^31^32^33^^^^^^^^^^^0^1
"DATA",790.31,99,0)
Invasive Ca, stable^1^29^30^34^35^31^32^33^^^^^^^^^^^0^1
"DATA",790.31,100,0)
Invasive Ca, progressive^1^29^30^34^35^31^32^33^^^^^^^^^^^0^1
"DATA",790.31,101,0)
Invasive Ca, NED^1^29^30^34^35^31^32^33^^^^^^^^^^^0^1
"DATA",790.31,102,0)
Impression: CIN I^3^37^^^^^^^^^^^^^^^^^^1^0^0^^^^^^^CIN I
"DATA",790.31,103,0)
Impression: CIN II^2^37^^^^^^^^^^^^^^^^^0^1^0^0^^^^^^^CIN II
"DATA",790.31,104,0)
Impression: CIN III^2^37^^^^^^^^^^^^^^^^^0^1^0^0^^^^^^^CIN III
"DATA",790.31,105,0)
Impression: HPV^3^37^^^^^^^^^^^^^^^^^0^1^1^0^^^^^^^HPV
"DATA",790.31,106,0)
Impression: WNL/Normal^90^37^^^^^^^^^^^^^^^^^0^0^0^^^^^^^^WNL^NORMAL
"DATA",790.31,107,0)
Impression: Inflammation^5^37^^^^^^^^^^^^^^^^^0^1^0^0^^^^^^^Inflam
"DATA",790.31,108,0)
Impression: Invasive CA^1^37^^^^^^^^^^^^^^^^^0^1^0^0^^^^^^^Invasiv
"DATA",790.31,109,0)
Impression: VAIN I^3^37^^^^^^^^^^^^^^^^^0^1^0^0^^^^^^^VAIN I
"DATA",790.31,110,0)
Impression: VAIN II^2^37^^^^^^^^^^^^^^^^^0^1^0^0^^^^^^^VAIN II
"DATA",790.31,111,0)
Impression: VAIN III^2^37^^^^^^^^^^^^^^^^^0^1^0^0^^^^^^^VAIN III
"DATA",790.31,112,0)
Impression: VIN I^3^37^^^^^^^^^^^^^^^^^0^1^0^0^^^^^^^VIN I
"DATA",790.31,113,0)
Impression: VIN II^2^37^^^^^^^^^^^^^^^^^0^1^0^0^^^^^^^VIN II
"DATA",790.31,114,0)
Impression: VIN III^2^37^^^^^^^^^^^^^^^^^0^1^0^0^^^^^^^VIN III
"DATA",790.31,115,0)
No Discrete Mass^90^38^^^^^^^^^^^^^^^^^0^0^0^0
"DATA",790.31,116,0)
Cystic Mass^5^38^^^^^^^^^^^^^^^^^0^1^^0
"DATA",790.31,117,0)
Cystic Mass, Complicated^1^38^^^^^^^^^^^^^^^^^0^1^^0
"DATA",790.31,118,0)
Solid Mass, Smooth Margins^1^38^^^^^^^^^^^^^^^^^0^1^^0
"DATA",790.31,119,0)
Solid Mass, Irregular Margins^1^38^^^^^^^^^^^^^^^^^0^1^^0
"DATA",790.31,120,0)
Abnormal/other^1^27^^^^^^^^^^^^^^^^^^1
"DATA",790.31,121,0)
Fibroids^1^3^^^^^^^^^^^^^^^^^0^1
"DATA",790.31,122,0)
Dysfunctional Uterine Bleeding^1^3^^^^^^^^^^^^^^^^^0^1
"DATA",790.31,123,0)
Chronic Pelvic Pain^1^3^^^^^^^^^^^^^^^^^0^1
"DATA",790.31,124,0)
Adenomyosis^1^3^^^^^^^^^^^^^^^^^0^1
"DATA",790.31,125,0)
Adenoacanthoma^1^3^^^^^^^^^^^^^^^^^0^1
"DATA",790.31,126,0)
CA endometrium Stage I^1^3^^^^^^^^^^^^^^^^^0^1
"DATA",790.31,127,0)
CA endometrium Stage II^1^3^^^^^^^^^^^^^^^^^0^1
"DATA",790.31,128,0)
CA endometrium Stage III^1^3^^^^^^^^^^^^^^^^^0^1
"DATA",790.31,129,0)
CA endometrium Stage IV^1^3^^^^^^^^^^^^^^^^^0^1
"DATA",790.31,130,0)
Cellular Leiomyoma^1^3^^^^^^^^^^^^^^^^^0^1
"DATA",790.31,131,0)
Choriocarcinoma^1^3^^^^^^^^^^^^^^^^^0^1
"DATA",790.31,132,0)
Cystocele^1^3^^^^^^^^^^^^^^^^^0^1
"DATA",790.31,133,0)
Cysto-urethrocele^1^3^^^^^^^^^^^^^^^^^0^1
"DATA",790.31,134,0)
Dysmenorrhea, intractable NOS^1^3^^^^^^^^^^^^^^^^^0^1
"DATA",790.31,135,0)
Endometriosis^1^3^^^^^^^^^^^^^^^^^0^1
"DATA",790.31,136,0)
Enterocele^1^3^^^^^^^^^^^^^^^^^0^1
"DATA",790.31,137,0)
Fibro Sarcoma^1^3^^^^^^^^^^^^^^^^^0^1
"DATA",790.31,138,0)
Generalized pelvic relaxation^1^3^^^^^^^^^^^^^^^^^0^1
"DATA",790.31,139,0)
Hematometrium^1^3^^^^^^^^^^^^^^^^^0^1
"DATA",790.31,140,0)
Hydatidiform mole^1^3^^^^^^^^^^^^^^^^^0^1
"DATA",790.31,141,0)
Other^1^3^^^^^^^^^^^^^^^^^0^1
"DATA",790.31,142,0)
Ovarian CA NOS^1^3^^^^^^^^^^^^^^^^^0^1
"DATA",790.31,143,0)
Placenta accreta^1^3^^^^^^^^^^^^^^^^^0^1
"DATA",790.31,144,0)
Pregnancy - cornual^1^3^^^^^^^^^^^^^^^^^0^1
"DATA",790.31,145,0)
Procidentia^1^3^^^^^^^^^^^^^^^^^0^1
"DATA",790.31,146,0)
Prolapse grade II^1^3^^^^^^^^^^^^^^^^^0^1
"DATA",790.31,147,0)
Prolapse grade III^1^3^^^^^^^^^^^^^^^^^0^1
"DATA",790.31,148,0)
Pyosalpinx^1^3^^^^^^^^^^^^^^^^^0^1
"DATA",790.31,149,0)
Rectocele^1^3^^^^^^^^^^^^^^^^^0^1
"DATA",790.31,150,0)
Salpingitis isthmica nodosa^1^3^^^^^^^^^^^^^^^^^0^1
"DATA",790.31,151,0)
Tubal CA NOS^1^3^^^^^^^^^^^^^^^^^0^1
"DATA",790.31,152,0)
Tubo-ovarian abscess^1^3^^^^^^^^^^^^^^^^^0^1
"DATA",790.31,153,0)
Uterine anomaly^1^3^^^^^^^^^^^^^^^^^0^1
"DATA",790.31,154,0)
Uterine foreign body^1^3^^^^^^^^^^^^^^^^^0^1
"DATA",790.31,155,0)
Uterine injury-external^1^3^^^^^^^^^^^^^^^^^0^1
"DATA",790.31,156,0)
Uterine injury-surgical^1^3^^^^^^^^^^^^^^^^^0^1
"DATA",790.31,157,0)
Uterine tuberculosis^1^3^^^^^^^^^^^^^^^^^0^1
"DATA",790.31,158,0)
Congential abn of uterus NOS^1^3^^^^^^^^^^^^^^^^^0^1
"DATA",790.31,159,0)
Endometrial hyperplasia (rec)^1^3^^^^^^^^^^^^^^^^^0^1
"FIA",790)
WV PATIENT
"FIA",790,0)
^WV(790,
"FIA",790,0,0)
790IP
"FIA",790,0,1)
y^n^p^^^^n
"FIA",790,0,10)

"FIA",790,0,11)

"FIA",790,0,"RLRO")

"FIA",790,0,"VR")
1.0^WV
"FIA",790,790)
1
"FIA",790,790,.15)

"FIA",790,790,.23)

"FIA",790,790,.27)

"FIA",790,790,2)

"FIA",790,790.09)
0
"FIA",790.02)
WV SITE PARAMETER
"FIA",790.02,0)
^WV(790.02,
"FIA",790.02,0,0)
790.02P
"FIA",790.02,0,1)
y^n^p^^^^n
"FIA",790.02,0,10)

"FIA",790.02,0,11)

"FIA",790.02,0,"RLRO")

"FIA",790.02,0,"VR")
1.0^WV
"FIA",790.02,790.02)
1
"FIA",790.02,790.02,39.01)

"FIA",790.02,790.02,39.03)

"FIA",790.02,790.02,40.01)

"FIA",790.02,790.02,40.03)

"FIA",790.02,790.02,41.01)

"FIA",790.02,790.02,41.03)

"FIA",790.2)
WV PROCEDURE TYPE
"FIA",790.2,0)
^WV(790.2,
"FIA",790.2,0,0)
790.2I
"FIA",790.2,0,1)
y^n^f^^n^^y^m^n
"FIA",790.2,0,10)

"FIA",790.2,0,11)
I Y>38
"FIA",790.2,0,"RLRO")

"FIA",790.2,0,"VR")
1.0^WV
"FIA",790.2,790.2)
0
"FIA",790.31)
WV RESULTS/DIAGNOSIS
"FIA",790.31,0)
^WV(790.31,
"FIA",790.31,0,0)
790.31I
"FIA",790.31,0,1)
n^n^f^^n^^y^r^n
"FIA",790.31,0,10)

"FIA",790.31,0,11)

"FIA",790.31,0,"RLRO")

"FIA",790.31,0,"VR")
1.0^WV
"FIA",790.31,790.31)
0
"FIA",790.4)
WV NOTIFICATION
"FIA",790.4,0)
^WV(790.4,
"FIA",790.4,0,0)
790.4IP
"FIA",790.4,0,1)
y^n^f^^^^n
"FIA",790.4,0,10)

"FIA",790.4,0,11)

"FIA",790.4,0,"RLRO")

"FIA",790.4,0,"VR")
1.0^WV
"FIA",790.4,790.4)
0
"FIA",790.71)
WV SNAPSHOT REPORTS
"FIA",790.71,0)
^WV(790.71,
"FIA",790.71,0,0)
790.71ID
"FIA",790.71,0,1)
y^n^f^^^^n
"FIA",790.71,0,10)

"FIA",790.71,0,11)

"FIA",790.71,0,"RLRO")

"FIA",790.71,0,"VR")
1.0^WV
"FIA",790.71,790.71)
0
"INIT")
WV7PST
"KRN",.403,76,-1)
0^1
"KRN",.403,76,0)
WV SITE PARAMS-FORM-1^^^^2950317^^^790.02^0^0^1
"KRN",.403,76,40,0)
^.4031I^6^6
"KRN",.403,76,40,1,0)
1^^1,1^2^6^0
"KRN",.403,76,40,1,1)
PAGE 1
"KRN",.403,76,40,1,40,0)
^.4032PI^260^1
"KRN",.403,76,40,1,40,260,0)
WV SITE PARAMS-EDITBLK-1^1^1,1^e
"KRN",.403,76,40,2,0)
2^^1,1^3^1^0
"KRN",.403,76,40,2,1)
PAGE 2
"KRN",.403,76,40,2,40,0)
^.4032PI^261^1
"KRN",.403,76,40,2,40,261,0)
WV SITE PARAMS-EDITBLK-2^1^1,1^e
"KRN",.403,76,40,3,0)
3^^1,1^4^2
"KRN",.403,76,40,3,1)
Page 3
"KRN",.403,76,40,3,40,0)
^.4032IP^312^1
"KRN",.403,76,40,3,40,312,0)
WV SITE PATAMS-EDITBLK-3^1^1,1^e
"KRN",.403,76,40,4,0)
4^^1,1^5^3
"KRN",.403,76,40,4,1)
Page 4
"KRN",.403,76,40,4,40,0)
^.4032IP^313^1
"KRN",.403,76,40,4,40,313,0)
WV SITE PARAMS-EDITBLK-4^1^1,1^e
"KRN",.403,76,40,5,0)
5^^1,1^6^4
"KRN",.403,76,40,5,1)
Page 5
"KRN",.403,76,40,5,40,0)
^.4032IP^314^1
"KRN",.403,76,40,5,40,314,0)
WV SITE PARAMS-EDITBLK-5^1^1,1^e
"KRN",.403,76,40,6,0)
6^^1,1^1^5
"KRN",.403,76,40,6,1)
Page 6
"KRN",.403,76,40,6,40,0)
^.4032IP^343^1
"KRN",.403,76,40,6,40,343,0)
WV SITE PARAMS-EDITBLK-6^1^1,1^e
"KRN",.404,260,0)
WV SITE PARAMS-EDITBLK-1^790.02
"KRN",.404,260,40,0)
^.4044I^12^10
"KRN",.404,260,40,1,0)
1^!M^1^
"KRN",.404,260,40,1,.1)
S Y="* * *  EDIT SITE PARAMETERS FOR "_IOINHI_$P(^DIC(4,DA,0),U)_IOINORM_"  * * *"
"KRN",.404,260,40,1,2)
^^3,12^
"KRN",.404,260,40,2,0)
2^________________________________________________________________________________^1^
"KRN",.404,260,40,2,2)
^^4,1^
"KRN",.404,260,40,4,0)
4^Default Case Manager^3
"KRN",.404,260,40,4,1)
.02
"KRN",.404,260,40,4,2)
6,33^30^6,11^0
"KRN",.404,260,40,5,0)
5^Ask Case Manager^3
"KRN",.404,260,40,5,1)
.05
"KRN",.404,260,40,5,2)
7,33^3^7,15^0
"KRN",.404,260,40,6,0)
6^Autoqueue Normal PAP Letters^3
"KRN",.404,260,40,6,1)
.03
"KRN",.404,260,40,6,2)
9,33^3^9,3^0
"KRN",.404,260,40,7,0)
7^PAP Result Normal Letter^3
"KRN",.404,260,40,7,1)
.04
"KRN",.404,260,40,7,2)
10,33^47^10,7^0
"KRN",.404,260,40,8,0)
8^Autoqueue Normal MAM Letters^3
"KRN",.404,260,40,8,1)
.07
"KRN",.404,260,40,8,2)
11,33^3^11,3^0
"KRN",.404,260,40,9,0)
9^MAM Result Normal Letter^3
"KRN",.404,260,40,9,1)
.08
"KRN",.404,260,40,9,2)
12,33^47^12,7^0
"KRN",.404,260,40,10,0)
10^Default #days to print letter^3
"KRN",.404,260,40,10,1)
.06
"KRN",.404,260,40,10,2)
14,33^3^14,2^0
"KRN",.404,260,40,12,0)
12^!M^1^
"KRN",.404,260,40,12,.1)
S Y="(PAGE 1 OF 6)"
"KRN",.404,260,40,12,2)
^^17,58
"KRN",.404,261,0)
WV SITE PARAMS-EDITBLK-2^790.02
"KRN",.404,261,40,0)
^.4044I^19^8
"KRN",.404,261,40,1,0)
1^!M^1^
"KRN",.404,261,40,1,.1)
S Y="* * *  EDIT SITE PARAMETERS FOR "_IOINHI_$P(^DIC(4,DA,0),U)_IOINORM_"  * * *"
"KRN",.404,261,40,1,2)
^^3,12^
"KRN",.404,261,40,2,0)
2^________________________________________________________________________________^1^
"KRN",.404,261,40,2,2)
^^4,1
"KRN",.404,261,40,10,0)
6.1^Import Mammograms from Radiology^3
"KRN",.404,261,40,10,1)
.1
"KRN",.404,261,40,10,2)
6,51^3^6,17
"KRN",.404,261,40,10,10)
S:'X DDSBR=12
"KRN",.404,261,40,11,0)
11^!M^1^
"KRN",.404,261,40,11,.1)
S Y="(PAGE 2 OF 6)"
"KRN",.404,261,40,11,2)
^^17,58
"KRN",.404,261,40,14,0)
6.2^Status Given to Imported Mammograms^3
"KRN",.404,261,40,14,1)
.23
"KRN",.404,261,40,14,2)
7,54^6^7,17
"KRN",.404,261,40,14,3)
OPEN
"KRN",.404,261,40,17,0)
6^RADIOLOGY:^1
"KRN",.404,261,40,17,2)
^^6,5
"KRN",.404,261,40,18,0)
7^LABORATORY:^1
"KRN",.404,261,40,18,2)
^^9,4
"KRN",.404,261,40,19,0)
7.1^Import Tests from Laboratory^3
"KRN",.404,261,40,19,1)
.24
"KRN",.404,261,40,19,2)
9,47^3^9,17
"KRN",.404,312,0)
WV SITE PATAMS-EDITBLK-3^790.02
"KRN",.404,312,40,0)
^.4044I^36^36
"KRN",.404,312,40,1,0)
1^!M^1
"KRN",.404,312,40,1,.1)
S Y="* * *  EDIT SITE PARAMETERS FOR "_IOINHI_$P(^DIC(4,DA,0),U)_IOINORM_"  * * *"
"KRN",.404,312,40,1,2)
^^3,12
"KRN",.404,312,40,2,0)
2^________________________________________________________________________________^1
"KRN",.404,312,40,2,2)
^^4,1
"KRN",.404,312,40,3,0)
3^Procedure Type^1
"KRN",.404,312,40,3,2)
^^6,5
"KRN",.404,312,40,4,0)
3.1^Active^1
"KRN",.404,312,40,4,2)
^^6,31
"KRN",.404,312,40,5,0)
3.3^DAYS DELINQUENT^1
"KRN",.404,312,40,5,2)
^^6,43
"KRN",.404,312,40,6,0)
4^--------------------^1
"KRN",.404,312,40,6,2)
^^7,5
"KRN",.404,312,40,7,0)
4.1^------^1
"KRN",.404,312,40,7,2)
^^7,31
"KRN",.404,312,40,8,0)
5^---------------^1
"KRN",.404,312,40,8,2)
^^7,43
"KRN",.404,312,40,9,0)
4.5^Breast Ultrasound^1
"KRN",.404,312,40,9,2)
^^8,5
"KRN",.404,312,40,10,0)
6^Clinical Breast Exam^1
"KRN",.404,312,40,10,2)
^^9,5
"KRN",.404,312,40,11,0)
7^Colposcopy Impr (No Bx)^1
"KRN",.404,312,40,11,2)
^^10,5
"KRN",.404,312,40,12,0)
8^Colposcopy w/Biopsy^1
"KRN",.404,312,40,12,2)
^^11,5
"KRN",.404,312,40,13,0)
8.1^Cone Biopsy^1
"KRN",.404,312,40,13,2)
^^12,5
"KRN",.404,312,40,14,0)
9^Cryotherapy^1
"KRN",.404,312,40,14,2)
^^13,5
"KRN",.404,312,40,15,0)
10^Ectocervical Biopsy^1
"KRN",.404,312,40,15,2)
^^14,5
"KRN",.404,312,40,16,0)
11^Endocervical Currettage^1
"KRN",.404,312,40,16,2)
^^15,5
"KRN",.404,312,40,17,0)
12^Endometrial Biopsy^1
"KRN",.404,312,40,17,2)
^^16,5
"KRN",.404,312,40,18,0)
4.6^^3
"KRN",.404,312,40,18,1)
38.01
"KRN",.404,312,40,18,2)
8,32^3
"KRN",.404,312,40,19,0)
6.1^^3
"KRN",.404,312,40,19,1)
27.01
"KRN",.404,312,40,19,2)
9,32^3
"KRN",.404,312,40,20,0)
6.6^^3
"KRN",.404,312,40,20,1)
37.01
"KRN",.404,312,40,20,2)
10,32^3
"KRN",.404,312,40,21,0)
7.1^^3
"KRN",.404,312,40,21,1)
2.01
"KRN",.404,312,40,21,2)
11,32^3
"KRN",.404,312,40,22,0)
8.2^^3
"KRN",.404,312,40,22,1)
19.01
"KRN",.404,312,40,22,2)
12,32^3
"KRN",.404,312,40,23,0)
9.1^^3
"KRN",.404,312,40,23,1)
4.01
"KRN",.404,312,40,23,2)
13,32^3
"KRN",.404,312,40,24,0)
10.1^^3
"KRN",.404,312,40,24,1)
17.01
"KRN",.404,312,40,24,2)
14,32^3
"KRN",.404,312,40,25,0)
11.1^^3
"KRN",.404,312,40,25,1)
18.01
"KRN",.404,312,40,25,2)
15,32^3
"KRN",.404,312,40,26,0)
12.1^^3
"KRN",.404,312,40,26,1)
8.01
"KRN",.404,312,40,26,2)
16,32^3
"KRN",.404,312,40,27,0)
4.8^^3
"KRN",.404,312,40,27,1)
38.03
"KRN",.404,312,40,27,2)
8,48^4
"KRN",.404,312,40,28,0)
6.3^^3
"KRN",.404,312,40,28,1)
27.03
"KRN",.404,312,40,28,2)
9,48^4
"KRN",.404,312,40,29,0)
6.8^^3
"KRN",.404,312,40,29,1)
37.03
"KRN",.404,312,40,29,2)
10,48^4
"KRN",.404,312,40,30,0)
7.3^^3
"KRN",.404,312,40,30,1)
2.03
"KRN",.404,312,40,30,2)
11,48^4
"KRN",.404,312,40,31,0)
8.3^^3
"KRN",.404,312,40,31,1)
19.03
"KRN",.404,312,40,31,2)
12,48^4
"KRN",.404,312,40,32,0)
9.3^^3
"KRN",.404,312,40,32,1)
4.03
"KRN",.404,312,40,32,2)
13,48^4
"KRN",.404,312,40,33,0)
10.3^^3
"KRN",.404,312,40,33,1)
7.03
"KRN",.404,312,40,33,2)
14,48^4
"KRN",.404,312,40,34,0)
11.3^^3
"KRN",.404,312,40,34,1)
18.03
"KRN",.404,312,40,34,2)
15,48^4
"KRN",.404,312,40,35,0)
12.3^^3
"KRN",.404,312,40,35,1)
8.03
"KRN",.404,312,40,35,2)
16,48^4
"KRN",.404,312,40,36,0)
20^!M^1
"KRN",.404,312,40,36,.1)
S Y="(PAGE 3 OF 6)"
"KRN",.404,312,40,36,2)
^^17,57
"KRN",.404,313,0)
WV SITE PARAMS-EDITBLK-4^790.02
"KRN",.404,313,40,0)
^.4044I^36^36
"KRN",.404,313,40,1,0)
1^!M^1
"KRN",.404,313,40,1,.1)
S Y="* * *  EDIT SITE PARAMETERS FOR "_IOINHI_$P(^DIC(4,DA,0),U)_IOINORM_"  * * *"
"KRN",.404,313,40,1,2)
^^3,12
"KRN",.404,313,40,2,0)
2^________________________________________________________________________________^1
"KRN",.404,313,40,2,2)
^^4,1
"KRN",.404,313,40,3,0)
3^Procedure Type^1
"KRN",.404,313,40,3,2)
^^6,5
"KRN",.404,313,40,4,0)
3.1^Active^1
"KRN",.404,313,40,4,2)
^^6,31
"KRN",.404,313,40,5,0)
3.2^DAYS DELINQUENT^1
"KRN",.404,313,40,5,2)
^^6,43
"KRN",.404,313,40,6,0)
4^--------------------^1
"KRN",.404,313,40,6,2)
^^7,5
"KRN",.404,313,40,7,0)
4.1^------^1
"KRN",.404,313,40,7,2)
^^7,31
"KRN",.404,313,40,8,0)
4.2^---------------^1
"KRN",.404,313,40,8,2)
^^7,43
"KRN",.404,313,40,9,0)
4.5^Fine Needle Aspiration^1
"KRN",.404,313,40,9,2)
^^8,5
"KRN",.404,313,40,10,0)
4.6^^3
"KRN",.404,313,40,10,1)
34.01
"KRN",.404,313,40,10,2)
8,32^3
"KRN",.404,313,40,11,0)
4.8^^3
"KRN",.404,313,40,11,1)
34.03
"KRN",.404,313,40,11,2)
8,48^4
"KRN",.404,313,40,12,0)
5^General Surgery Consult^1
"KRN",.404,313,40,12,2)
^^9,5
"KRN",.404,313,40,13,0)
5.1^^3
"KRN",.404,313,40,13,1)
29.01
"KRN",.404,313,40,13,2)
9,32^3
"KRN",.404,313,40,14,0)
5.3^^3
"KRN",.404,313,40,14,1)
29.03
"KRN",.404,313,40,14,2)
9,48^4
"KRN",.404,313,40,15,0)
6^Gyn Onc Consult^1
"KRN",.404,313,40,15,2)
^^10,5
"KRN",.404,313,40,16,0)
6.1^^3
"KRN",.404,313,40,16,1)
24.01
"KRN",.404,313,40,16,2)
10,32^3
"KRN",.404,313,40,17,0)
6.3^^3
"KRN",.404,313,40,17,1)
24.03
"KRN",.404,313,40,17,2)
10,48^4
"KRN",.404,313,40,18,0)
7^Hysterectomy^1
"KRN",.404,313,40,18,2)
^^11,5
"KRN",.404,313,40,19,0)
7.1^^3
"KRN",.404,313,40,19,1)
3.01
"KRN",.404,313,40,19,2)
11,32^3
"KRN",.404,313,40,20,0)
7.3^^3
"KRN",.404,313,40,20,1)
3.03
"KRN",.404,313,40,20,2)
11,48^4
"KRN",.404,313,40,21,0)
8^Laser Abilation^1
"KRN",.404,313,40,21,2)
^^12,5
"KRN",.404,313,40,22,0)
8.1^^3
"KRN",.404,313,40,22,1)
22.01
"KRN",.404,313,40,22,2)
12,32^3
"KRN",.404,313,40,23,0)
8.3^^3
"KRN",.404,313,40,23,1)
22.03
"KRN",.404,313,40,23,2)
12,48^4
"KRN",.404,313,40,24,0)
9^Laser Cone^1
"KRN",.404,313,40,24,2)
^^13,5
"KRN",.404,313,40,25,0)
9.1^^3
"KRN",.404,313,40,25,1)
23.01
"KRN",.404,313,40,25,2)
13,32^3
"KRN",.404,313,40,26,0)
9.3^^3
"KRN",.404,313,40,26,1)
23.03
"KRN",.404,313,40,26,2)
13,48^4
"KRN",.404,313,40,27,0)
10^LEEP^1
"KRN",.404,313,40,27,2)
^^14,5
"KRN",.404,313,40,28,0)
10.1^^3
"KRN",.404,313,40,28,1)
17.01
"KRN",.404,313,40,28,2)
14,32^3
"KRN",.404,313,40,29,0)
10.3^^3
"KRN",.404,313,40,29,1)
17.03
"KRN",.404,313,40,29,2)
14,48^4
"KRN",.404,313,40,30,0)
11^Lumpectomy^1
"KRN",.404,313,40,30,2)
^^15,5
"KRN",.404,313,40,31,0)
11.1^^3
"KRN",.404,313,40,31,1)
32.01
"KRN",.404,313,40,31,2)
15,32^3
"KRN",.404,313,40,32,0)
11.3^^3
"KRN",.404,313,40,32,1)
32.03
"KRN",.404,313,40,32,2)
15,48^4
"KRN",.404,313,40,33,0)
12^Mammogram Dx Bilat^1
"KRN",.404,313,40,33,2)
^^16,5
"KRN",.404,313,40,34,0)
12.1^^3
"KRN",.404,313,40,34,1)
25.01
"KRN",.404,313,40,34,2)
16,32^3
"KRN",.404,313,40,35,0)
12.3^^3
"KRN",.404,313,40,35,1)
25.03
"KRN",.404,313,40,35,2)
16,48^4
"KRN",.404,313,40,36,0)
20^!M^1
"KRN",.404,313,40,36,.1)
S Y="(PAGE 4 OF 6)"
"KRN",.404,313,40,36,2)
^^17,58
"KRN",.404,314,0)
WV SITE PARAMS-EDITBLK-5^790.02
"KRN",.404,314,40,0)
^.4044I^36^36
"KRN",.404,314,40,1,0)
1^!M^1
"KRN",.404,314,40,1,.1)
S Y="* * *  EDIT SITE PARAMETERS FOR "_IOINHI_$P(^DIC(4,DA,0),U)_IOINORM_"  * * *"
"KRN",.404,314,40,1,2)
^^3,12
"KRN",.404,314,40,2,0)
2^________________________________________________________________________________^1
"KRN",.404,314,40,2,2)
^^4,1
"KRN",.404,314,40,3,0)
3^Procedure Type^1
"KRN",.404,314,40,3,2)
^^6,5
"KRN",.404,314,40,4,0)
3.1^Active^1
"KRN",.404,314,40,4,2)
^^6,31
"KRN",.404,314,40,5,0)
3.3^DAYS DELINQUENT^1
"KRN",.404,314,40,5,2)
^^6,43
"KRN",.404,314,40,6,0)
4^--------------------^1
"KRN",.404,314,40,6,2)
^^7,5
"KRN",.404,314,40,7,0)
4.1^------^1
"KRN",.404,314,40,7,2)
^^7,31
"KRN",.404,314,40,8,0)
4.3^---------------^1
"KRN",.404,314,40,8,2)
^^7,43
"KRN",.404,314,40,9,0)
5^Mamogram Dx Unilat^1
"KRN",.404,314,40,9,2)
^^8,5
"KRN",.404,314,40,10,0)
5.1^^3
"KRN",.404,314,40,10,1)
26.01
"KRN",.404,314,40,10,2)
8,32^3
"KRN",.404,314,40,11,0)
5.3^^3
"KRN",.404,314,40,11,1)
26.03
"KRN",.404,314,40,11,2)
8,48^4
"KRN",.404,314,40,12,0)
6^Mammogram Screening^1
"KRN",.404,314,40,12,2)
^^9,5
"KRN",.404,314,40,13,0)
6.1^^3
"KRN",.404,314,40,13,1)
28.01
"KRN",.404,314,40,13,2)
9,32^3
"KRN",.404,314,40,14,0)
6.2^^3
"KRN",.404,314,40,14,1)
28.03
"KRN",.404,314,40,14,2)
9,48^4
"KRN",.404,314,40,15,0)
7^Mastectomy^1
"KRN",.404,314,40,15,2)
^^10,5
"KRN",.404,314,40,16,0)
7.1^^3
"KRN",.404,314,40,16,1)
33.01
"KRN",.404,314,40,16,2)
10,32^3
"KRN",.404,314,40,17,0)
7.3^^3
"KRN",.404,314,40,17,1)
33.03
"KRN",.404,314,40,17,2)
10,48^4
"KRN",.404,314,40,18,0)
8^Needle Biopsy^1
"KRN",.404,314,40,18,2)
^^11,5
"KRN",.404,314,40,19,0)
8.1^^3
"KRN",.404,314,40,19,1)
30.01
"KRN",.404,314,40,19,2)
11,32^3
"KRN",.404,314,40,20,0)
8.3^^3
"KRN",.404,314,40,20,1)
30.03
"KRN",.404,314,40,20,2)
11,48^4
"KRN",.404,314,40,21,0)
9^Open Biopsy^1
"KRN",.404,314,40,21,2)
^^12,5
"KRN",.404,314,40,22,0)
9.1^^3
"KRN",.404,314,40,22,1)
31.01
"KRN",.404,314,40,22,2)
12,32^3
"KRN",.404,314,40,23,0)
9.3^^3
"KRN",.404,314,40,23,1)
31.03
"KRN",.404,314,40,23,2)
12,48^4
"KRN",.404,314,40,24,0)
10^PAP Smear^1
"KRN",.404,314,40,24,2)
^^13,5
"KRN",.404,314,40,25,0)
10.1^^3
"KRN",.404,314,40,25,1)
1.01
"KRN",.404,314,40,25,2)
13,32^3
"KRN",.404,314,40,26,0)
10.3^^3
"KRN",.404,314,40,26,1)
1.03
"KRN",.404,314,40,26,2)
13,48^4
"KRN",.404,314,40,27,0)
11^Pelvic Ultrasound^1
"KRN",.404,314,40,27,2)
^^14,5
"KRN",.404,314,40,28,0)
11.1^^3
"KRN",.404,314,40,28,1)
40.01
"KRN",.404,314,40,28,2)
14,32^3
"KRN",.404,314,40,29,0)
11.3^^3
"KRN",.404,314,40,29,1)
40.03
"KRN",.404,314,40,29,2)
14,48^4
"KRN",.404,314,40,30,0)
12^Pregnancy Test^1
"KRN",.404,314,40,30,2)
^^15,5
"KRN",.404,314,40,31,0)
12.1^^3
"KRN",.404,314,40,31,1)
20.01
"KRN",.404,314,40,31,2)
15,32^3
"KRN",.404,314,40,32,0)
12.3^^3
"KRN",.404,314,40,32,1)
20.03
"KRN",.404,314,40,32,2)
15,48^4
"KRN",.404,314,40,33,0)
13^STD Evaluation^1
"KRN",.404,314,40,33,2)
^^16,5
"KRN",.404,314,40,34,0)
13.1^^3
"KRN",.404,314,40,34,1)
21.01
"KRN",.404,314,40,34,2)
16,32^3
"KRN",.404,314,40,35,0)
13.3^^3
"KRN",.404,314,40,35,1)
21.03
"KRN",.404,314,40,35,2)
16,48^4
"KRN",.404,314,40,36,0)
20^!M^1
"KRN",.404,314,40,36,.1)
S Y="(PAGE 5 OF 6)"
"KRN",.404,314,40,36,2)
^^17,57
"KRN",.404,343,0)
WV SITE PARAMS-EDITBLK-6^790.02
"KRN",.404,343,40,0)
^.4044I^18^18
"KRN",.404,343,40,1,0)
1^!M^1
"KRN",.404,343,40,1,.1)
S Y="* * *  EDIT SITE PARAMETERS FOR "_IOINHI_$P(^DIC(4,DA,0),U)_IOINORM_"  * * *"
"KRN",.404,343,40,1,2)
^^3,12
"KRN",.404,343,40,2,0)
2^-------------------------------------------------------------------------------^1
"KRN",.404,343,40,2,2)
^^4,1
"KRN",.404,343,40,3,0)
3^Procedure Type^1
"KRN",.404,343,40,3,2)
^^6,5
"KRN",.404,343,40,4,0)
3.1^Active^1
"KRN",.404,343,40,4,2)
^^6,31
"KRN",.404,343,40,5,0)
3.3^DAYS DELINQUENT^1
"KRN",.404,343,40,5,2)
^^6,43
"KRN",.404,343,40,6,0)
4^--------------------^1
"KRN",.404,343,40,6,2)
^^7,5
"KRN",.404,343,40,7,0)
4.1^------^1
"KRN",.404,343,40,7,2)
^^7,31
"KRN",.404,343,40,8,0)
4.3^---------------^1
"KRN",.404,343,40,8,2)
^^7,43
"KRN",.404,343,40,9,0)
5^Stereotactic Biopsy^1
"KRN",.404,343,40,9,2)
^^8,5
"KRN",.404,343,40,10,0)
5.1^^3
"KRN",.404,343,40,10,1)
35.01
"KRN",.404,343,40,10,2)
8,32^3
"KRN",.404,343,40,11,0)
5.3^^3
"KRN",.404,343,40,11,1)
35.03
"KRN",.404,343,40,11,2)
8,48^4
"KRN",.404,343,40,12,0)
6^Tubal Ligation^1
"KRN",.404,343,40,12,2)
^^9,5
"KRN",.404,343,40,13,0)
6.1^^3
"KRN",.404,343,40,13,1)
39.01
"KRN",.404,343,40,13,2)
9,32^3
"KRN",.404,343,40,14,0)
6.3^^3
"KRN",.404,343,40,14,1)
39.03
"KRN",.404,343,40,14,2)
9,48^4
"KRN",.404,343,40,15,0)
7^Vaginal Ultrasound^1
"KRN",.404,343,40,15,2)
^^10,5
"KRN",.404,343,40,16,0)
7.1^^3
"KRN",.404,343,40,16,1)
41.01
"KRN",.404,343,40,16,2)
10,32^3
"KRN",.404,343,40,17,0)
7.3^^3
"KRN",.404,343,40,17,1)
41.03
"KRN",.404,343,40,17,2)
10,48^4
"KRN",.404,343,40,18,0)
20^!M^1
"KRN",.404,343,40,18,.1)
S Y="(PAGE 6 OF 6)"
"KRN",.404,343,40,18,2)
^^17,57
"KRN",19,10430,-1)
0^1
"KRN",19,10430,0)
WV IMPORT RAD/NM EXAMS^Import Radiology/NM Exams^^R^^^^^^^^WOMEN'S HEALTH
"KRN",19,10430,1,0)
^^6^6^2990803^
"KRN",19,10430,1,1,0)
This option searches the Radiology/Nuclear Medicine database for all WH
"KRN",19,10430,1,2,0)
patients who had a mammogram or breast/pelvic/vaginal ultrasound exam
"KRN",19,10430,1,3,0)
during the date range you select. These procedures and patients will be
"KRN",19,10430,1,4,0)
added to the WH database if not already there.
"KRN",19,10430,1,5,0)
 
"KRN",19,10430,1,6,0)
Exams over three years old will not be imported into the WH database.
"KRN",19,10430,25)
WVEXPTRA
"KRN",19,10430,"U")
IMPORT RADIOLOGY/NM EXAMS
"MBREQ")
0
"ORD",0,9.8)
9.8;;1;RTNF^XPDTA;RTNE^XPDTA
"ORD",0,9.8,0)
ROUTINE
"ORD",8,.403)
.403;8;;;EDEOUT^DIFROMSO(.403,DA,"",XPDA);FPRE^DIFROMSI(.403,"",XPDA);EPRE^DIFROMSI(.403,DA,$E("N",$G(XPDNEW)),XPDA,"",OLDA);;EPOST^DIFROMSI(.403,DA,"",XPDA);DEL^DIFROMSK(.403,"",%)
"ORD",8,.403,0)
FORM
"ORD",18,19)
19;18;;;OPT^XPDTA;OPTF1^XPDIA;OPTE1^XPDIA;OPTF2^XPDIA;;OPTDEL^XPDIA
"ORD",18,19,0)
OPTION
"PKG",364,-1)
1^1
"PKG",364,0)
WOMEN'S HEALTH^WV^Tracks health issues specific to female patients.
"PKG",364,20,0)
^9.402P^^
"PKG",364,22,0)
^9.49I^1^1
"PKG",364,22,1,0)
1.0^2980925^2980508^547
"PKG",364,22,1,"PAH",1,0)
7^2991012
"PKG",364,22,1,"PAH",1,1,0)
^^2^2^2991012
"PKG",364,22,1,"PAH",1,1,1,0)
Please read the WV*1*7 patch description on FORUM for an explanation of
"PKG",364,22,1,"PAH",1,1,2,0)
what this patch does.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
22
"RTN","WV7PST")
0^23^B19913075
"RTN","WV7PST",1,0)
WV7PST ;HCIOFO/FT-Patch 7 Post-Installation Routine ;10/1/99  18:00
"RTN","WV7PST",2,0)
 ;;1.0;WOMEN'S HEALTH;**7**;Sep 30, 1998
"RTN","WV7PST",3,0)
 ;
"RTN","WV7PST",4,0)
EN ; Start post-install
"RTN","WV7PST",5,0)
 D XREF,RCODE,ZERO
"RTN","WV7PST",6,0)
 D QMAIL
"RTN","WV7PST",7,0)
 Q
"RTN","WV7PST",8,0)
XREF ; Index new cross-reference added to File 790.2 (CPT CODE - .08)
"RTN","WV7PST",9,0)
 N DIK
"RTN","WV7PST",10,0)
 S DIK="^WV(790.2,",DIK(1)=".08"
"RTN","WV7PST",11,0)
 D ENALL^DIK
"RTN","WV7PST",12,0)
 Q
"RTN","WV7PST",13,0)
RCODE ; Put R code in PACKAGE (#.05), File 790.2
"RTN","WV7PST",14,0)
 N DA,DIE,DR,WVLOOP
"RTN","WV7PST",15,0)
 F WVLOOP="BREAST ULTRASOUND","MAMMOGRAM DX BILAT","MAMMOGRAM DX UNILAT","MAMMOGRAM SCREENING","PELVIC ULTRASOUND","VAGINAL ULTRASOUND" D
"RTN","WV7PST",16,0)
 .S DA=$O(^WV(790.2,"B",WVLOOP,0))
"RTN","WV7PST",17,0)
 .Q:'DA
"RTN","WV7PST",18,0)
 .S DR=".05///"_"R",DIE="^WV(790.2,"
"RTN","WV7PST",19,0)
 .D ^DIE
"RTN","WV7PST",20,0)
 .Q
"RTN","WV7PST",21,0)
 Q
"RTN","WV7PST",22,0)
QMAIL ; Queue mail message
"RTN","WV7PST",23,0)
 N ZTDESC,ZTDTH,ZTIO,ZTRTN,ZTSAVE
"RTN","WV7PST",24,0)
 S ZTRTN="MAIL^WV7PST",ZTDESC="WV*1*7 INSTALLED"
"RTN","WV7PST",25,0)
 S ZTIO="",ZTDTH=$H
"RTN","WV7PST",26,0)
 D ^%ZTLOAD
"RTN","WV7PST",27,0)
 Q
"RTN","WV7PST",28,0)
MAIL ; Send message to Default Case Managers to 
"RTN","WV7PST",29,0)
 ; 1) enter parameters for new procedures
"RTN","WV7PST",30,0)
 ; 2) include |APPOINTMENTS| on form letters (if desired).
"RTN","WV7PST",31,0)
 N XMDUZ,XMSUB,XMTEXT,XMY,WVSITE,WVIEN,WVLINE,WVMSG
"RTN","WV7PST",32,0)
 S (WVLINE,WVSITE)=0
"RTN","WV7PST",33,0)
 F  S WVSITE=$O(^WV(790.02,WVSITE)) Q:'WVSITE  D
"RTN","WV7PST",34,0)
 .S WVIEN=$P($G(^WV(790.02,WVSITE,0)),U,2) ;default case manager
"RTN","WV7PST",35,0)
 .Q:'WVIEN
"RTN","WV7PST",36,0)
 .S XMY(WVIEN)=""
"RTN","WV7PST",37,0)
 .Q
"RTN","WV7PST",38,0)
 I '$O(XMY(0)) Q
"RTN","WV7PST",39,0)
SEND ; Create mail message and send
"RTN","WV7PST",40,0)
 S XMDUZ=.5 ;message sender
"RTN","WV7PST",41,0)
 S XMSUB="Women's Health patch #7 installed"
"RTN","WV7PST",42,0)
 S WVMSG(+$$LINE())="Patch #7 for the Women's Health package was installed. This patch adds 3"
"RTN","WV7PST",43,0)
 S WVMSG(+$$LINE())="new procedures for tracking. They are: Tubal Ligation, Pelvic Ultrasound"
"RTN","WV7PST",44,0)
 S WVMSG(+$$LINE())="and Vaginal Ultrasound. Please update your site parameters:"
"RTN","WV7PST",45,0)
 S WVMSG(+$$LINE())=" "
"RTN","WV7PST",46,0)
 S WVMSG(+$$LINE())="   Go to the: File Maintenance menu"
"RTN","WV7PST",47,0)
 S WVMSG(+$$LINE())="  Select the: Edit Site Parameters option"
"RTN","WV7PST",48,0)
 S WVMSG(+$$LINE())=" Select your: Site/Facility"
"RTN","WV7PST",49,0)
 S WVMSG(+$$LINE())="Go to pages 5 and 6"
"RTN","WV7PST",50,0)
 S WVMSG(+$$LINE())=" "
"RTN","WV7PST",51,0)
 S WVMSG(+$$LINE())="Enter YES in the 'Active' column and a numeric value in the 'DAYS DELINQUENT'"
"RTN","WV7PST",52,0)
 S WVMSG(+$$LINE())="column for each new procedure."
"RTN","WV7PST",53,0)
 S WVMSG(+$$LINE())=" "
"RTN","WV7PST",54,0)
 S WVMSG(+$$LINE())="Exit and save your changes."
"RTN","WV7PST",55,0)
 S WVMSG(+$$LINE())=" "
"RTN","WV7PST",56,0)
 S WVMSG(+$$LINE())="==================================================="
"RTN","WV7PST",57,0)
 S WVMSG(+$$LINE())=" "
"RTN","WV7PST",58,0)
 S WVMSG(+$$LINE())="Also, you can automatically have a patient's future appointments display in"
"RTN","WV7PST",59,0)
 S WVMSG(+$$LINE())="a notification letter. To do so:"
"RTN","WV7PST",60,0)
 S WVMSG(+$$LINE())=" "
"RTN","WV7PST",61,0)
 S WVMSG(+$$LINE())="   Go to the: File Maintenance menu"
"RTN","WV7PST",62,0)
 S WVMSG(+$$LINE())="  Select the: Add/Edit a Notification Purpose & Letter option"
"RTN","WV7PST",63,0)
 S WVMSG(+$$LINE())=" "
"RTN","WV7PST",64,0)
 S WVMSG(+$$LINE())="Select the notification letter which will display the future appointments."
"RTN","WV7PST",65,0)
 S WVMSG(+$$LINE())=" "
"RTN","WV7PST",66,0)
 S WVMSG(+$$LINE())="Answer NO to the 'Do you wish to delete the old letter for this Purpose of"
"RTN","WV7PST",67,0)
 S WVMSG(+$$LINE())="Notification and replace it with the generic sample letter?"
"RTN","WV7PST",68,0)
 S WVMSG(+$$LINE())="Enter Yes or No: NO//' prompt."
"RTN","WV7PST",69,0)
 S WVMSG(+$$LINE())=" "
"RTN","WV7PST",70,0)
 S WVMSG(+$$LINE())="Navigate to the FORM LETTER (WP) field."
"RTN","WV7PST",71,0)
 S WVMSG(+$$LINE())=" "
"RTN","WV7PST",72,0)
 S WVMSG(+$$LINE())="In the text of the letter type ""|APPOINTMENTS|"" (without the quotes) along"
"RTN","WV7PST",73,0)
 S WVMSG(+$$LINE())="with any other text that should appear in the letter."
"RTN","WV7PST",74,0)
 S WVMSG(+$$LINE())=" "
"RTN","WV7PST",75,0)
 S WVMSG(+$$LINE())="For example, create a new paragraph:"
"RTN","WV7PST",76,0)
 S WVMSG(+$$LINE())=" "
"RTN","WV7PST",77,0)
 S WVMSG(+$$LINE())="Your future appointments are:"
"RTN","WV7PST",78,0)
 S WVMSG(+$$LINE())="|APPOINTMENTS|"
"RTN","WV7PST",79,0)
 S WVMSG(+$$LINE())=" "
"RTN","WV7PST",80,0)
 S WVMSG(+$$LINE())=" "
"RTN","WV7PST",81,0)
 S XMTEXT="WVMSG("
"RTN","WV7PST",82,0)
 D ^XMD
"RTN","WV7PST",83,0)
 Q
"RTN","WV7PST",84,0)
LINE() ; Increment line counter by 1
"RTN","WV7PST",85,0)
 S WVLINE=+$G(WVLINE)+1
"RTN","WV7PST",86,0)
 Q WVLINE
"RTN","WV7PST",87,0)
 ;
"RTN","WV7PST",88,0)
ZERO ; Set Fields .77, .78 and .79 in File 790.71 entries to zero
"RTN","WV7PST",89,0)
 ; (pieces 28, 29 & 30 of node 2).
"RTN","WV7PST",90,0)
 N WVLOOP,WVNODE,WVX
"RTN","WV7PST",91,0)
 S WVLOOP=0
"RTN","WV7PST",92,0)
 F  S WVLOOP=$O(^WV(790.71,WVLOOP)) Q:'WVLOOP  D
"RTN","WV7PST",93,0)
 .S WVNODE=$G(^WV(790.71,WVLOOP,2))
"RTN","WV7PST",94,0)
 .Q:WVNODE=""
"RTN","WV7PST",95,0)
 .F WVX=28,29,30 S:$P(WVNODE,U,WVX)="" $P(WVNODE,U,WVX)=0
"RTN","WV7PST",96,0)
 .S ^WV(790.71,WVLOOP,2)=WVNODE
"RTN","WV7PST",97,0)
 .Q
"RTN","WV7PST",98,0)
 Q
"RTN","WVBRNED")
0^19^B29784744
"RTN","WVBRNED",1,0)
WVBRNED ;HCIOFO/FT,JR-BROWSE TX NEEDS PAST DUE; ;6/1/99  13:42
"RTN","WVBRNED",2,0)
 ;;1.0;WOMEN'S HEALTH;**7**;Sep 30, 1998
"RTN","WVBRNED",3,0)
 ;;  Original routine created by IHS/ANMC/MWR
"RTN","WVBRNED",4,0)
 ;;* MICHAEL REMILLARD, DDS * ALASKA NATIVE MEDICAL CENTER *
"RTN","WVBRNED",5,0)
 ;;  CALLED BY OPTION: "WV BROWSE NEEDS PAST DUE" TO BROWSE AND
"RTN","WVBRNED",6,0)
 ;;  EDIT PATIENTS WITH TREATMENT NEEDS PAST DUE.
"RTN","WVBRNED",7,0)
 ;
"RTN","WVBRNED",8,0)
 ;---> USE NODES 1 & 2 IN ^TMP GLOBAL.
"RTN","WVBRNED",9,0)
 ;
"RTN","WVBRNED",10,0)
BEGIN ;EP
"RTN","WVBRNED",11,0)
 D SETVARS^WVUTL5 K WVRES
"RTN","WVBRNED",12,0)
 D TITLE^WVUTL5("BREAST & CERVICAL TX NEEDS PAST DUE REPORT")
"RTN","WVBRNED",13,0)
 D UNDETER G:WVPOP EXIT
"RTN","WVBRNED",14,0)
 D ASKDATE G:WVPOP EXIT
"RTN","WVBRNED",15,0)
 D CMGR    G:WVPOP EXIT
"RTN","WVBRNED",16,0)
 D ORDER   G:WVPOP EXIT
"RTN","WVBRNED",17,0)
 D DEVICE  G:WVPOP EXIT
"RTN","WVBRNED",18,0)
 D SORT
"RTN","WVBRNED",19,0)
 D COPYGBL
"RTN","WVBRNED",20,0)
 D ^WVBRNED1
"RTN","WVBRNED",21,0)
 ;
"RTN","WVBRNED",22,0)
EXIT ;EP
"RTN","WVBRNED",23,0)
 D KILLALL^WVUTL8
"RTN","WVBRNED",24,0)
 Q
"RTN","WVBRNED",25,0)
 ;
"RTN","WVBRNED",26,0)
 ;
"RTN","WVBRNED",27,0)
UNDETER ;EP
"RTN","WVBRNED",28,0)
 ;---> ASK TO INCLUDE CASES WITH UNDETERMINED OR UNDATED NEEDS.
"RTN","WVBRNED",29,0)
 ;---> WVA=1 SAYS INCLUDE PATIENTS WITH UNDETERMINED NEEDS.
"RTN","WVBRNED",30,0)
 N DIR,DIRUT,Y
"RTN","WVBRNED",31,0)
 W !!?3,"Include patients whose Breast or Cervical Tx Needs are "
"RTN","WVBRNED",32,0)
 W "undetermined?"
"RTN","WVBRNED",33,0)
 N DIR S DIR("A")="   Enter Yes or No: "
"RTN","WVBRNED",34,0)
 S WVA=0,DIR(0)="YA",DIR("B")="YES" D HELP1^WVBRNEDH
"RTN","WVBRNED",35,0)
 D ^DIR W !
"RTN","WVBRNED",36,0)
 S:$D(DIRUT) WVPOP=1
"RTN","WVBRNED",37,0)
 I Y S WVA=1 Q
"RTN","WVBRNED",38,0)
 Q
"RTN","WVBRNED",39,0)
 ;
"RTN","WVBRNED",40,0)
 ;
"RTN","WVBRNED",41,0)
ASKDATE ;EP
"RTN","WVBRNED",42,0)
 ;---> ASK FOR DATE BY WHICH NEEDS WILL BE DELINQUENT.
"RTN","WVBRNED",43,0)
 N DIR,DIRUT,Y
"RTN","WVBRNED",44,0)
 W !!?3,"Select the date to be checked for patient Tx Needs past due:"
"RTN","WVBRNED",45,0)
 S DIR(0)="D^::EX",DIR("A")="   Select a date"
"RTN","WVBRNED",46,0)
 S DIR("B")="TODAY" D HELP4^WVBRNEDH
"RTN","WVBRNED",47,0)
 D ^DIR
"RTN","WVBRNED",48,0)
 I $D(DIRUT) S WVPOP=1 Q
"RTN","WVBRNED",49,0)
 S WVDDATE=Y
"RTN","WVBRNED",50,0)
 Q
"RTN","WVBRNED",51,0)
 ;
"RTN","WVBRNED",52,0)
 ;
"RTN","WVBRNED",53,0)
CMGR ;EP
"RTN","WVBRNED",54,0)
 ;---> SELECT CASES FOR ONE CASE MANAGER OR ALL.
"RTN","WVBRNED",55,0)
 ;---> DO NOT PROMPT FOR CASE MANAGER IF SITE PARAMETERS SAY NOT TO.
"RTN","WVBRNED",56,0)
 I '$D(^WV(790.02,DUZ(2),0)) S WVE=1 Q
"RTN","WVBRNED",57,0)
 I '$P(^WV(790.02,DUZ(2),0),U,5) S WVE=1 Q
"RTN","WVBRNED",58,0)
 W !!?3,"Report on all patients for ONE particular Case Manager,"
"RTN","WVBRNED",59,0)
 W !?3,"or report on all patients for ALL Case Managers?"
"RTN","WVBRNED",60,0)
 N DIR,DIRUT,Y
"RTN","WVBRNED",61,0)
 S DIR("A")="   Select ONE or ALL: ",DIR("B")="ALL",WVMGR=""
"RTN","WVBRNED",62,0)
 S DIR(0)="SAM^o:ONE;a:ALL" D HELP3^WVBRNEDH
"RTN","WVBRNED",63,0)
 D ^DIR K DIR
"RTN","WVBRNED",64,0)
 I Y=-1!($D(DIRUT)) S WVPOP=1 Q
"RTN","WVBRNED",65,0)
 ;---> IF ALL CASE MANAGERS, S WVE=1 AND QUIT.
"RTN","WVBRNED",66,0)
 I Y="a" S WVE=1 Q
"RTN","WVBRNED",67,0)
 ;
"RTN","WVBRNED",68,0)
 W !!,"   Select the Case Manager whose patients you wish to browse."
"RTN","WVBRNED",69,0)
 D DIC^WVFMAN(790.01,"QEMA",.Y,"   Select CASE MANAGER: ")
"RTN","WVBRNED",70,0)
 I Y<0 S WVPOP=1 Q
"RTN","WVBRNED",71,0)
 ;---> FOR ONE CASE MANAGER, SET WVE=0 AND WVMGR=^VA(200 DFN, QUIT.
"RTN","WVBRNED",72,0)
 S WVMGR=+Y,WVE=0
"RTN","WVBRNED",73,0)
 Q
"RTN","WVBRNED",74,0)
 ;
"RTN","WVBRNED",75,0)
 ;
"RTN","WVBRNED",76,0)
ORDER ;EP
"RTN","WVBRNED",77,0)
 ;---> ASK ORDER BY DATE DELINQUENT OR BY PATIENT NAME.
"RTN","WVBRNED",78,0)
 ;---> SORT SEQUENCE IN WVB:  1=DELINQ DATE (DEFAULT), 2=PATIENT NAME
"RTN","WVBRNED",79,0)
 ;---> 3=PRIMARY CARE PROVIDER
"RTN","WVBRNED",80,0)
 N DIR,DIRUT,Y S WVB=1
"RTN","WVBRNED",81,0)
 W !!?3,"Display Procedures in order of:"
"RTN","WVBRNED",82,0)
 W ?37,"1) DATE DELINQUENT (earliest first)"
"RTN","WVBRNED",83,0)
 W !?37,"2) PATIENT NAME (alphabetically)"
"RTN","WVBRNED",84,0)
 W !?37,"3) PRIMARY CARE PROVIDER (alphabetically)"
"RTN","WVBRNED",85,0)
 S DIR("A")="   Selection ",DIR("B")=1
"RTN","WVBRNED",86,0)
 S DIR(0)="SAM^1:DATE DELINQUENT;2:PATIENT NAME;3:PRIMARY CARE PROVIDER"
"RTN","WVBRNED",87,0)
 D HELP2^WVBRNEDH
"RTN","WVBRNED",88,0)
 D ^DIR K DIR
"RTN","WVBRNED",89,0)
 I Y=-1!($D(DIRUT)) S WVPOP=1 Q
"RTN","WVBRNED",90,0)
 S WVB=Y
"RTN","WVBRNED",91,0)
 Q
"RTN","WVBRNED",92,0)
 ;
"RTN","WVBRNED",93,0)
DEVICE ;EP
"RTN","WVBRNED",94,0)
 ;---> GET DEVICE AND POSSIBLY QUEUE TO TASKMAN.
"RTN","WVBRNED",95,0)
 S ZTRTN="DEQUEUE^WVBRNED"
"RTN","WVBRNED",96,0)
 F WVSV="A","B","E","DDATE","MGR" D
"RTN","WVBRNED",97,0)
 .I $D(@("WV"_WVSV)) S ZTSAVE("WV"_WVSV)=""
"RTN","WVBRNED",98,0)
 ;---> SAVE CURRENT COMMUNITY ARRAY.
"RTN","WVBRNED",99,0)
 I $D(WVCC) N N S N=0 F  S N=$O(WVCC(N)) Q:N=""  D
"RTN","WVBRNED",100,0)
 .S ZTSAVE("WVCC("""_N_""")")=""
"RTN","WVBRNED",101,0)
 D ZIS^WVUTL2(.WVPOP,1,"HOME")
"RTN","WVBRNED",102,0)
 Q
"RTN","WVBRNED",103,0)
 ;
"RTN","WVBRNED",104,0)
SORT ;EP
"RTN","WVBRNED",105,0)
 ;---> SORT AND STORE LOCAL ARRAY IN ^TMP("WV",$J,1,
"RTN","WVBRNED",106,0)
 ;---> WVA=1 SAYS INCLUDE PATIENTS WITH UNDETERMINED NEEDS.
"RTN","WVBRNED",107,0)
 ;---> 5 & 8 ARE IENS IN ^WV(790.5, AND ^WV(790.51 GLOBALS FOR "UNDETERMINED".
"RTN","WVBRNED",108,0)
 ;
"RTN","WVBRNED",109,0)
 K ^TMP("WV",$J) N N,Y,WVBRTXND,WVCXTXND
"RTN","WVBRNED",110,0)
 S N=0
"RTN","WVBRNED",111,0)
 S WVBRTXND=$$IEN^WVUTL9(790.51,"Not Indicated")
"RTN","WVBRNED",112,0)
 S WVCXTXND=$$IEN^WVUTL9(790.5,"Not Indicated")
"RTN","WVBRNED",113,0)
 F  S N=$O(^WV(790,N)) Q:'N  D
"RTN","WVBRNED",114,0)
 .S Y=^WV(790,N,0)
"RTN","WVBRNED",115,0)
 .;---> QUIT IF PATIENT IS INACTIVE.
"RTN","WVBRNED",116,0)
 .Q:$P(Y,U,24)
"RTN","WVBRNED",117,0)
 .;---> IF DEAD, SET INACTIVE DATE TO DATE OF DEATH
"RTN","WVBRNED",118,0)
 .I $$DECEASED^WVUTL1($P(Y,U)) D
"RTN","WVBRNED",119,0)
 ..N DA,DR,DIE
"RTN","WVBRNED",120,0)
 ..S DIE="^WV(790,",DA=$P(Y,U)
"RTN","WVBRNED",121,0)
 ..S DR=".24////"_$P($$GET1^DIQ(2,DA,.351,"I"),".") ;date only
"RTN","WVBRNED",122,0)
 ..N X,Y
"RTN","WVBRNED",123,0)
 ..D ^DIE
"RTN","WVBRNED",124,0)
 ..Q
"RTN","WVBRNED",125,0)
 .;---> QUIT IF BOTH TX NEEDS ARE "NOT INDICATED"
"RTN","WVBRNED",126,0)
 .I $P(Y,U,18)=WVBRTXND,$P(Y,U,11)=WVCXTXND Q
"RTN","WVBRNED",127,0)
 .;---> QUIT IF LOOKING FOR ONE CASE MANAGER AND THIS DOESN'T MATCH.
"RTN","WVBRNED",128,0)
 .I 'WVE Q:$P(Y,U,10)'=WVMGR
"RTN","WVBRNED",129,0)
 .;---> IF WVA=0, DON'T INCLUDE BECAUSE OF UNDETERMINED NEEDS.
"RTN","WVBRNED",130,0)
 .I 'WVA D  Q
"RTN","WVBRNED",131,0)
 ..;---> ONLY IF IT'S A SPECIFIED NEED AND IT'S DELINQUENT, INCLUDE.
"RTN","WVBRNED",132,0)
 ..I 5'[$P(Y,U,11)&($P(Y,U,12)<WVDDATE) D SET Q
"RTN","WVBRNED",133,0)
 ..I 8'[$P(Y,U,18)&($P(Y,U,19)<WVDDATE) D SET Q
"RTN","WVBRNED",134,0)
 .;---> IF WVA=1, INCLUDE BECAUSE OF UNDETERMINED NEEDS.
"RTN","WVBRNED",135,0)
 .I 5[$P(Y,U,11)!(8[$P(Y,U,18)) D SET Q
"RTN","WVBRNED",136,0)
 .;---> IF EITHER NEED IS DELINQUENT, INCLUDE.
"RTN","WVBRNED",137,0)
 .I $P(Y,U,12)<WVDDATE!($P(Y,U,19)<WVDDATE) D SET
"RTN","WVBRNED",138,0)
 Q
"RTN","WVBRNED",139,0)
 ;
"RTN","WVBRNED",140,0)
 ;
"RTN","WVBRNED",141,0)
COPYGBL ;EP
"RTN","WVBRNED",142,0)
 ;---> COPY ^TMP("WV",$J,1 TO ^TMP("WV",$J,2 TO MAKE IT FLAT.
"RTN","WVBRNED",143,0)
 N I,M,N
"RTN","WVBRNED",144,0)
 S N=-1,I=0
"RTN","WVBRNED",145,0)
 F  S N=$O(^TMP("WV",$J,1,N)) Q:N=""  D
"RTN","WVBRNED",146,0)
 .S M=-1
"RTN","WVBRNED",147,0)
 .F  S M=$O(^TMP("WV",$J,1,N,M)) Q:M=""  D
"RTN","WVBRNED",148,0)
 ..S I=I+1,^TMP("WV",$J,2,I)=^TMP("WV",$J,1,N,M)
"RTN","WVBRNED",149,0)
 Q
"RTN","WVBRNED",150,0)
 ;
"RTN","WVBRNED",151,0)
SET ;EP
"RTN","WVBRNED",152,0)
 ;---> SORT SEQUENCE IN WVB: 1=DELINQ DATE (DEFAULT), 2=PATIENT NAME
"RTN","WVBRNED",153,0)
 ;---> 3=PRIMARY CARE PROVIDER
"RTN","WVBRNED",154,0)
 N Z S WVDFN=$P(Y,U) D PATVARS^WVUTL3(WVDFN)
"RTN","WVBRNED",155,0)
 S Z=WVCHRT_U_WVNAME_U_WVCMGR_U_WVCNEED_U_WVBNEED_U_WVDFN
"RTN","WVBRNED",156,0)
 S WVJPCP=$$PROVI^WVUTL1A(WVDFN)
"RTN","WVBRNED",157,0)
 I WVB=1 D  Q
"RTN","WVBRNED",158,0)
 .S WVPDAT=+$P(Y,U,12),WVMDAT=+$P(Y,U,19)
"RTN","WVBRNED",159,0)
 .I WVPDAT,WVMDAT S ^TMP("WV",$J,1,$S(WVPDAT<WVMDAT:WVPDAT,1:WVMDAT),WVNAME)=Z Q
"RTN","WVBRNED",160,0)
 .I WVPDAT S ^TMP("WV",$J,1,WVPDAT,WVNAME)=Z Q
"RTN","WVBRNED",161,0)
 .S ^TMP("WV",$J,1,WVMDAT,WVNAME)=Z
"RTN","WVBRNED",162,0)
 .Q
"RTN","WVBRNED",163,0)
 I WVB=2 S ^TMP("WV",$J,1,WVNAME,WVDFN)=Z
"RTN","WVBRNED",164,0)
 I WVB=3 S ^TMP("WV",$J,1,WVJPCP,WVNAME)=Z
"RTN","WVBRNED",165,0)
 Q
"RTN","WVBRNED",166,0)
 ;
"RTN","WVBRNED",167,0)
 ;
"RTN","WVBRNED",168,0)
DEQUEUE ;EP
"RTN","WVBRNED",169,0)
 ;---> TASKMAN QUEUE OF PRINTOUT.
"RTN","WVBRNED",170,0)
 D SETVARS^WVUTL5,SORT,COPYGBL,^WVBRNED1,EXIT
"RTN","WVBRNED",171,0)
 Q
"RTN","WVBRNED",172,0)
 ;
"RTN","WVBRNED",173,0)
PRINTX ;EP
"RTN","WVBRNED",174,0)
 N I,T,X S T=$$REPEAT^XLFSTR(" ",WVTAB)
"RTN","WVBRNED",175,0)
 F I=1:1 S X=$T(@WVLINL+I) Q:X'[";;"  W !,T,$P(X,";;",2)
"RTN","WVBRNED",176,0)
 Q
"RTN","WVEXPTRA")
0^18^B42180249
"RTN","WVEXPTRA",1,0)
WVEXPTRA ;HCIOFO/FT-EXPORT MAMS & ULTRASOUNDS TO WOMEN'S HEALTH  ;8/5/99  16:22
"RTN","WVEXPTRA",2,0)
 ;;1.0;WOMEN'S HEALTH;**3,5,7**;Sep 30, 1998
"RTN","WVEXPTRA",3,0)
 ;;  Original routine created by IHS/ANMC/MWR
"RTN","WVEXPTRA",4,0)
 ;;* MICHAEL REMILLARD, DDS * ALASKA NATIVE MEDICAL CENTER *
"RTN","WVEXPTRA",5,0)
 ;---> WVNEWP = TOTAL NEW WOMEN'S HEALTH PATIENTS ADDED.
"RTN","WVEXPTRA",6,0)
 ;---> WVMAM  = TOTAL NEW MAMMOGRAMS PROCEDURES ADDED.
"RTN","WVEXPTRA",7,0)
 ;
"RTN","WVEXPTRA",8,0)
EN1 ;
"RTN","WVEXPTRA",9,0)
 S WVPOP=0
"RTN","WVEXPTRA",10,0)
 D CHECK I WVPOP D KILL Q  ;check if site parameter entry exists
"RTN","WVEXPTRA",11,0)
 D DESC ;describe option
"RTN","WVEXPTRA",12,0)
 D DTRNG I WVPOP D KILL Q  ;get date range
"RTN","WVEXPTRA",13,0)
 D STATUS I WVPOP D KILL Q  ;select status of procedure
"RTN","WVEXPTRA",14,0)
 D VET I WVPOP D KILL Q  ;veterans/non-veterans
"RTN","WVEXPTRA",15,0)
 D QUEUE ;queue a background job
"RTN","WVEXPTRA",16,0)
 D KILL
"RTN","WVEXPTRA",17,0)
 Q
"RTN","WVEXPTRA",18,0)
EN2 ;
"RTN","WVEXPTRA",19,0)
 D CPTS ;get procedure pointers
"RTN","WVEXPTRA",20,0)
 D GET ;get RAD/NM data & store in WH
"RTN","WVEXPTRA",21,0)
 D MAIL ;send mail message to user
"RTN","WVEXPTRA",22,0)
 D KILL ;kill variables
"RTN","WVEXPTRA",23,0)
 Q
"RTN","WVEXPTRA",24,0)
DESC ; Describe option
"RTN","WVEXPTRA",25,0)
 W @IOF
"RTN","WVEXPTRA",26,0)
 W !,"This option searches the Radiology/Nuclear Medicine database for"
"RTN","WVEXPTRA",27,0)
 W !,"all female patients who had a mammogram, breast ultrasound, pelvic"
"RTN","WVEXPTRA",28,0)
 W !,"ultrasound or vaginal ultrasound exam during the date range you select."
"RTN","WVEXPTRA",29,0)
 W !,"These procedures and patients will be added to the WH database if"
"RTN","WVEXPTRA",30,0)
 W !,"not already there.",!
"RTN","WVEXPTRA",31,0)
 W !,"This job will be queued as a background task so as to free up your"
"RTN","WVEXPTRA",32,0)
 W !,"terminal to do other work. You will receive a mail message when"
"RTN","WVEXPTRA",33,0)
 W !,"the job is done. The mail message will contain a count of the"
"RTN","WVEXPTRA",34,0)
 W !,"number of procedures and patients added.",!!
"RTN","WVEXPTRA",35,0)
 Q 
"RTN","WVEXPTRA",36,0)
CHECK ; Check if DUZ(2) exists for user, if entry exists in site parameter
"RTN","WVEXPTRA",37,0)
 ; file, if case manager, and if File 70 exists.
"RTN","WVEXPTRA",38,0)
 D CHECK^WVLOGO
"RTN","WVEXPTRA",39,0)
 I '$G(DUZ(2))!('$D(^WV(790.02,+DUZ(2),0))) S WVPOP=1
"RTN","WVEXPTRA",40,0)
 I '$P($G(^WV(790.02,+$G(DUZ(2)),0)),U,2) D
"RTN","WVEXPTRA",41,0)
 .D NODCM^WVUTL9
"RTN","WVEXPTRA",42,0)
 .S WVPOP=1
"RTN","WVEXPTRA",43,0)
 .Q
"RTN","WVEXPTRA",44,0)
 I '$D(^RADPT) W !,"There is no Radiology/Nuclear Medicine Patient file (#70)",! S WVPOP=1
"RTN","WVEXPTRA",45,0)
 Q
"RTN","WVEXPTRA",46,0)
DTRNG ; prompt for date range, go back three years maximum
"RTN","WVEXPTRA",47,0)
 S WVSTDT=DT-30000,WVSTDT=$$DATECHK(WVSTDT)
"RTN","WVEXPTRA",48,0)
 K DIR S DIR(0)="DA^"_WVSTDT_":"_DT
"RTN","WVEXPTRA",49,0)
 S DIR("A")="Enter START DATE: "
"RTN","WVEXPTRA",50,0)
 S DIR("?")="Enter the earliest date of the mammograms/ultrasounds you wish to retrieve. You can begin your search at "_$$FMTE^XLFDT(WVSTDT,"D")_"."
"RTN","WVEXPTRA",51,0)
 D ^DIR K DIR
"RTN","WVEXPTRA",52,0)
 I $D(DIRUT) S WVPOP=1 Q
"RTN","WVEXPTRA",53,0)
 S WVSTDT=Y
"RTN","WVEXPTRA",54,0)
 S DIR(0)="DA^"_WVSTDT_":"_DT
"RTN","WVEXPTRA",55,0)
 S DIR("A")="Enter END DATE: ",DIR("B")=$$FMTE^XLFDT(DT,"D")
"RTN","WVEXPTRA",56,0)
 S DIR("?")="Enter the most recent date of the mammograms/ultrasounds you wish to retrieve."
"RTN","WVEXPTRA",57,0)
 D ^DIR K DIR
"RTN","WVEXPTRA",58,0)
 I $D(DIRUT) S WVPOP=1 Q
"RTN","WVEXPTRA",59,0)
 S WVENDT=Y
"RTN","WVEXPTRA",60,0)
 Q
"RTN","WVEXPTRA",61,0)
DATECHK(WVDATE) ; Check if WVDATE is a valid date. Substract 1 day until a
"RTN","WVEXPTRA",62,0)
 ; valid date in WVDATE and return same.
"RTN","WVEXPTRA",63,0)
 N %DT,WVLOOP,X,Y
"RTN","WVEXPTRA",64,0)
 S Y=0
"RTN","WVEXPTRA",65,0)
 F WVLOOP=1:1 Q:Y>0  D
"RTN","WVEXPTRA",66,0)
 .S X=WVDATE,%DT=""
"RTN","WVEXPTRA",67,0)
 .D ^%DT
"RTN","WVEXPTRA",68,0)
 .Q:Y>0  ;valid date - stop checking
"RTN","WVEXPTRA",69,0)
 .S WVDATE=$$FMADD^XLFDT(WVDATE,-1)
"RTN","WVEXPTRA",70,0)
 .Q
"RTN","WVEXPTRA",71,0)
 Q WVDATE
"RTN","WVEXPTRA",72,0)
 ;
"RTN","WVEXPTRA",73,0)
STATUS ; Select default status for procedures
"RTN","WVEXPTRA",74,0)
 K DIR
"RTN","WVEXPTRA",75,0)
 S DIR(0)="S^o:OPEN;c:CLOSED",DIR("A")="Select STATUS OF IMPORTED MAMMOGRAMS"
"RTN","WVEXPTRA",76,0)
 S DIR("?")="Enter 'O' to give a Status of OPEN to Mammograms imported from the Radiology Software into the Women's Health database. Enter 'C' to give a Status of CLOSED to imported Mammograms."
"RTN","WVEXPTRA",77,0)
 D ^DIR K DIR
"RTN","WVEXPTRA",78,0)
 I $D(DIRUT) S WVPOP=1
"RTN","WVEXPTRA",79,0)
 S WVSTATUS=Y
"RTN","WVEXPTRA",80,0)
 Q
"RTN","WVEXPTRA",81,0)
VET ; Add veterans only
"RTN","WVEXPTRA",82,0)
 W ! S WVVET=""
"RTN","WVEXPTRA",83,0)
 N DIR S DIR(0)="Y",DIR("A")="Add veterans only"
"RTN","WVEXPTRA",84,0)
 S DIR("?",1)="Answer YES to add veterans only."
"RTN","WVEXPTRA",85,0)
 S DIR("?")="Answer NO to include non-veterans (e.g., employees)."
"RTN","WVEXPTRA",86,0)
 D ^DIR
"RTN","WVEXPTRA",87,0)
 I $D(DIRUT) S WVPOP=1 Q
"RTN","WVEXPTRA",88,0)
 S WVVET=+Y
"RTN","WVEXPTRA",89,0)
 Q
"RTN","WVEXPTRA",90,0)
QUEUE ; Task as background job
"RTN","WVEXPTRA",91,0)
 S ZTIO="",ZTDESC="WH GRAB RAD/NM DATA",ZTRTN="EN2^WVEXPTRA"
"RTN","WVEXPTRA",92,0)
 S ZTDTH=$H,WVPOP=1
"RTN","WVEXPTRA",93,0)
 S ZTSAVE("WVENDT")="",ZTSAVE("WVSTDT")="",ZTSAVE("WVSTATUS")=""
"RTN","WVEXPTRA",94,0)
 S ZTSAVE("WVVET")=""
"RTN","WVEXPTRA",95,0)
 D ^%ZTLOAD
"RTN","WVEXPTRA",96,0)
 Q
"RTN","WVEXPTRA",97,0)
CPTS ; Loop through File 71 to get procedure pointers for the CPTs we
"RTN","WVEXPTRA",98,0)
 ; are interested in.
"RTN","WVEXPTRA",99,0)
 N WVPROC S WVIEN=0 K WVARRAY
"RTN","WVEXPTRA",100,0)
 F  S WVIEN=$O(^RAMIS(71,WVIEN)) Q:'WVIEN  D
"RTN","WVEXPTRA",101,0)
 .S WVCPT=$$GET1^DIQ(71,WVIEN,9,"I") ;CPT code
"RTN","WVEXPTRA",102,0)
 .Q:WVCPT=""
"RTN","WVEXPTRA",103,0)
 .S WVPROC=0
"RTN","WVEXPTRA",104,0)
 .S WVPROC=$O(^WV(790.2,"AC",WVCPT,WVPROC))
"RTN","WVEXPTRA",105,0)
 .Q:'WVPROC
"RTN","WVEXPTRA",106,0)
 .Q:$P($G(^WV(790.2,+WVPROC,0)),U,5)'="R"
"RTN","WVEXPTRA",107,0)
 .S WVARRAY(WVIEN)=""
"RTN","WVEXPTRA",108,0)
 .Q
"RTN","WVEXPTRA",109,0)
 Q
"RTN","WVEXPTRA",110,0)
GET ; get mammograms and ultrasounds from RAD/NM database
"RTN","WVEXPTRA",111,0)
 ;---> WVMCNT = total new procedures added.
"RTN","WVEXPTRA",112,0)
 ;---> WVNEWP = total new patients added.
"RTN","WVEXPTRA",113,0)
 S (WVMCNT,WVNEWP)=0
"RTN","WVEXPTRA",114,0)
 Q:'$D(WVARRAY)  ;no mammogram or ultrasound procedures in File 71
"RTN","WVEXPTRA",115,0)
 S WVENDT=WVENDT\1,WVENDT=9999999-WVENDT ;inverse end date
"RTN","WVEXPTRA",116,0)
 S WVSTDT=WVSTDT\1,WVSTDT=9999999-WVSTDT ;inverse start date
"RTN","WVEXPTRA",117,0)
 S WVSTDT=WVSTDT_".9999"
"RTN","WVEXPTRA",118,0)
 S WVDFN=0 ;patient dfn
"RTN","WVEXPTRA",119,0)
 F  S WVDFN=$O(^RADPT(WVDFN)) Q:'WVDFN  D  ;RAD/NM patient file
"RTN","WVEXPTRA",120,0)
 .Q:$P($G(^DPT(WVDFN,0)),U,2)'="F"  ;not female
"RTN","WVEXPTRA",121,0)
 .I WVVET,$$GET1^DIQ(2,WVDFN,1901,"I")'="Y" Q  ;don't add non-veterans
"RTN","WVEXPTRA",122,0)
 .S WVDTI=WVENDT  ;Because the exam date is inverse the end date will
"RTN","WVEXPTRA",123,0)
 .;                will be the lower value.
"RTN","WVEXPTRA",124,0)
 .F  S WVDTI=$O(^RADPT(WVDFN,"DT",WVDTI)) Q:'WVDTI!(WVDTI>WVSTDT)  D
"RTN","WVEXPTRA",125,0)
 ..S WVCNI=0 ;case number
"RTN","WVEXPTRA",126,0)
 ..F  S WVCNI=$O(^RADPT(WVDFN,"DT",WVDTI,"P",WVCNI)) Q:'WVCNI  D
"RTN","WVEXPTRA",127,0)
 ...S WVNODE=$G(^RADPT(WVDFN,"DT",WVDTI,"P",WVCNI,0))
"RTN","WVEXPTRA",128,0)
 ...Q:WVNODE=""
"RTN","WVEXPTRA",129,0)
 ...S WVPROC=$P(WVNODE,U,2) ;procedure pointer
"RTN","WVEXPTRA",130,0)
 ...Q:'WVPROC  ;no pointer to File 71 (no procedure) 
"RTN","WVEXPTRA",131,0)
 ...Q:'$D(WVARRAY(WVPROC))  ;not a WH-related procedure
"RTN","WVEXPTRA",132,0)
 ...S WVRPT=$P(WVNODE,U,17) ;report pointer
"RTN","WVEXPTRA",133,0)
 ...Q:'WVRPT  ;no pointer to File 74 (no report)
"RTN","WVEXPTRA",134,0)
 ...Q:$$GET1^DIQ(74,WVRPT,5,"I")'="V"  ;report status, must be VERIFIED
"RTN","WVEXPTRA",135,0)
 ...D CREATEH^WVRALINK(WVDFN,WVDTI,WVCNI,WVSTATUS)
"RTN","WVEXPTRA",136,0)
 ...Q
"RTN","WVEXPTRA",137,0)
 ..Q
"RTN","WVEXPTRA",138,0)
 .Q
"RTN","WVEXPTRA",139,0)
 Q
"RTN","WVEXPTRA",140,0)
MAIL ; send mail message to user with counts of procedures & patients added
"RTN","WVEXPTRA",141,0)
 S XMDUZ=.5 ;message sender
"RTN","WVEXPTRA",142,0)
 S XMY(DUZ)="" ;person who ran option
"RTN","WVEXPTRA",143,0)
 S XMSUB="Export of RAD/NM procedures to WH is done"
"RTN","WVEXPTRA",144,0)
 S WVMSG(1)="  # of New patients added to Women's Health package: "_WVNEWP
"RTN","WVEXPTRA",145,0)
 S WVMSG(2)="# of New procedures added to Women's Health package: "_WVMCNT
"RTN","WVEXPTRA",146,0)
 I '$D(WVARRAY) D
"RTN","WVEXPTRA",147,0)
 .S WVMSG(3)=" "
"RTN","WVEXPTRA",148,0)
 .S WVMSG(4)="There are no mammogram or ultrasound procedures listed in your"
"RTN","WVEXPTRA",149,0)
 .S WVMSG(5)="Radiology/Nuclear Medicine package."
"RTN","WVEXPTRA",150,0)
 .Q
"RTN","WVEXPTRA",151,0)
 S XMTEXT="WVMSG("
"RTN","WVEXPTRA",152,0)
 D ^XMD
"RTN","WVEXPTRA",153,0)
 I $D(ZTQUEUED) S ZTREQ="@"
"RTN","WVEXPTRA",154,0)
 Q
"RTN","WVEXPTRA",155,0)
KILL ;
"RTN","WVEXPTRA",156,0)
 K DIR,DIROUT,DIRUT,DTOUT,DUOUT
"RTN","WVEXPTRA",157,0)
 K WVARRAY,WVCNI,WVCPT,WVDFN,WVDTI,WVENDT,WVIEN,WVMCNT,WVNEWP,WVNODE,WVPOP,WVPROC,WVRPT,WVSTATUS,WVSTDT,WVVET
"RTN","WVEXPTRA",158,0)
 K X,Y,ZTDESC,ZTDTH,ZTIO,ZTRTN,ZTSAVE,ZTSK
"RTN","WVEXPTRA",159,0)
 Q
"RTN","WVEXPTRA",160,0)
 ;
"RTN","WVGETAL1")
0^13^B2009629
"RTN","WVGETAL1",1,0)
WVGETAL1 ;HCIOFO/FT-Autoload Female Patients (cont.) ;6/17/99  15:17
"RTN","WVGETAL1",2,0)
 ;;1.0;WOMEN'S HEALTH;**7**;Sep 30, 1998
"RTN","WVGETAL1",3,0)
EC ; prompt for Eligibility codes
"RTN","WVGETAL1",4,0)
 W ! K DIR
"RTN","WVGETAL1",5,0)
 S DIR(0)="Y",DIR("A")="     Include patients by eligibility code, too"
"RTN","WVGETAL1",6,0)
 S DIR("?")="Answer YES to include non-veteran patients with a desired eligibility code"
"RTN","WVGETAL1",7,0)
 D ^DIR K DIR
"RTN","WVGETAL1",8,0)
 I $D(DIRUT) S WVPOP=1
"RTN","WVGETAL1",9,0)
 Q:$G(WVPOP)!(Y=0)
"RTN","WVGETAL1",10,0)
 K DIC N WVLOOP
"RTN","WVGETAL1",11,0)
 S WVLOOP=0,DIC="^DIC(8,",Y=0
"RTN","WVGETAL1",12,0)
 F  Q:Y<0  D
"RTN","WVGETAL1",13,0)
 .S WVLOOP=WVLOOP+1
"RTN","WVGETAL1",14,0)
 .S DIC(0)="AEMQZ"
"RTN","WVGETAL1",15,0)
 .S DIC("A")="     Select "_$S(WVLOOP>1:"Next ",1:"")_"Eligibility Code: "
"RTN","WVGETAL1",16,0)
 .D ^DIC
"RTN","WVGETAL1",17,0)
 .S:$D(DTOUT)!($D(DUOUT)) WVPOP=1
"RTN","WVGETAL1",18,0)
 .I $D(DTOUT)!($D(DUOUT))!(Y<0) Q
"RTN","WVGETAL1",19,0)
 .S WVEC(+Y)=""
"RTN","WVGETAL1",20,0)
 .Q
"RTN","WVGETAL1",21,0)
 K DIC
"RTN","WVGETAL1",22,0)
 Q
"RTN","WVGETAL1",23,0)
VECCHK() ; Veteran/Eligibility Code check
"RTN","WVGETAL1",24,0)
 N DFN,WVLOOP,VAEL,VAERR,X,Y
"RTN","WVGETAL1",25,0)
 ; get veteran status
"RTN","WVGETAL1",26,0)
 I $$GET1^DIQ(2,WVN,1901,"I")="Y" Q 1
"RTN","WVGETAL1",27,0)
 S DFN=WVN
"RTN","WVGETAL1",28,0)
 D ELIG^VADPT ;get elibility code
"RTN","WVGETAL1",29,0)
 S WVLOOP=+$P($G(VAEL(1)),U,1) ;VAEL(1)=internal^external
"RTN","WVGETAL1",30,0)
 I 'WVLOOP Q 0
"RTN","WVGETAL1",31,0)
 I $D(WVEC(WVLOOP)) Q 1
"RTN","WVGETAL1",32,0)
 Q 0
"RTN","WVGETAL1",33,0)
 ;
"RTN","WVGETALL")
0^14^B56519718
"RTN","WVGETALL",1,0)
WVGETALL ;HCIOFO/FT,JR-AUTOLOAD FEMALE PATIENTS ;9/8/99  12:20
"RTN","WVGETALL",2,0)
 ;;1.0;WOMEN'S HEALTH;**3,7**;Sep 30, 1998
"RTN","WVGETALL",3,0)
 ;;  Original routine created by IHS/ANMC/MWR
"RTN","WVGETALL",4,0)
 ;;* MICHAEL REMILLARD, DDS * ALASKA NATIVE MEDICAL CENTER *
"RTN","WVGETALL",5,0)
 ;;  AUTOMATICALLY LOADS WOMENS PATIENTS FROM THE MAIN PATIENT FILE,
"RTN","WVGETALL",6,0)
 ;;  LIMITED BY AGE AND CURRENT COMMUNITY.
"RTN","WVGETALL",7,0)
 ;
"RTN","WVGETALL",8,0)
EN ;
"RTN","WVGETALL",9,0)
 N WVPARM,WVEC
"RTN","WVGETALL",10,0)
 S WVPARM=$G(^WV(790.02,+$G(DUZ(2)),0)),WVEC=""
"RTN","WVGETALL",11,0)
 I WVPARM="" D CHECK^WVLOGO Q  ;no site parameter entry
"RTN","WVGETALL",12,0)
 ; Stop if no default case manager
"RTN","WVGETALL",13,0)
 I '$P(WVPARM,U,2) D NODCM^WVUTL9 Q
"RTN","WVGETALL",14,0)
 D SETVARS^WVUTL5
"RTN","WVGETALL",15,0)
 D INTRO  G:WVPOP EXIT
"RTN","WVGETALL",16,0)
 D SELECT G:WVPOP EXIT
"RTN","WVGETALL",17,0)
 D EC^WVGETAL1 G:WVPOP EXIT
"RTN","WVGETALL",18,0)
 D DEVICE G:WVPOP EXIT
"RTN","WVGETALL",19,0)
 D LOAD
"RTN","WVGETALL",20,0)
 ;
"RTN","WVGETALL",21,0)
EXIT ;EP
"RTN","WVGETALL",22,0)
 D KILLALL^WVUTL8 K WVJSDT,WVJEDT,WVN,WVST
"RTN","WVGETALL",23,0)
 Q
"RTN","WVGETALL",24,0)
 ;
"RTN","WVGETALL",25,0)
 ;
"RTN","WVGETALL",26,0)
INTRO ;EP
"RTN","WVGETALL",27,0)
 ;---> INTRODUCTORY SCREENS.
"RTN","WVGETALL",28,0)
 S WVTITLE="AUTOLOAD PATIENTS"
"RTN","WVGETALL",29,0)
 D TITLE^WVUTL5(WVTITLE)
"RTN","WVGETALL",30,0)
 D TEXT1,DIRZ^WVUTL3
"RTN","WVGETALL",31,0)
 Q:WVPOP
"RTN","WVGETALL",32,0)
 D TITLE^WVUTL5(WVTITLE)
"RTN","WVGETALL",33,0)
 D TEXT2,DIRZ^WVUTL3
"RTN","WVGETALL",34,0)
 Q
"RTN","WVGETALL",35,0)
 ;
"RTN","WVGETALL",36,0)
SELECT ;EP
"RTN","WVGETALL",37,0)
 ;---> SELECT AGE.
"RTN","WVGETALL",38,0)
 D TITLE^WVUTL5(WVTITLE)
"RTN","WVGETALL",39,0)
 ;---> SELECT AGE.
"RTN","WVGETALL",40,0)
 K DIR
"RTN","WVGETALL",41,0)
 W !?5,"Select the age below which patients should NOT be added:"
"RTN","WVGETALL",42,0)
 S DIR("A")="     Enter AGE: ",DIR("B")=19
"RTN","WVGETALL",43,0)
 S DIR(0)="NOA^10:99" D HELP1
"RTN","WVGETALL",44,0)
 D ^DIR K DIR
"RTN","WVGETALL",45,0)
 I Y=-1!($D(DIRUT)) S WVPOP=1 Q
"RTN","WVGETALL",46,0)
 S WVAGE=+Y
"RTN","WVGETALL",47,0)
 W !!?5,"Define Active Patient for Patient file download."
"RTN","WVGETALL",48,0)
 W !?5,"If the patient has had no activity (visits or admissions) between"
"RTN","WVGETALL",49,0)
 W !?5,"the start and end dates you enter here, she will not be included"
"RTN","WVGETALL",50,0)
 W !?5,"in this Patient file download.",!
"RTN","WVGETALL",51,0)
STD S DIR(0)="DAO",DIR("A")="     Start Date of Patient Activity to Include: "
"RTN","WVGETALL",52,0)
 S Y=DT-30000,Y=$$DATECHK^WVEXPTRA(Y)
"RTN","WVGETALL",53,0)
 D DD^%DT S DIR("B")=Y
"RTN","WVGETALL",54,0)
 S DIR("?",1)="     If the patient has not had a Visit or Admission after this start date,"
"RTN","WVGETALL",55,0)
 S DIR("?",2)="     they will not be included in the auto-load."
"RTN","WVGETALL",56,0)
 S DIR("?")="     This date can be up to 3 years prior to todays date."
"RTN","WVGETALL",57,0)
 D ^DIR K DIR I Y'>0  W !!!! K WVJRDT S WVPOP=1 Q
"RTN","WVGETALL",58,0)
 S WVJSDT=Y
"RTN","WVGETALL",59,0)
K S DIR(0)="DAO",DIR("A")="     End Date of Patient Activity to Include: "
"RTN","WVGETALL",60,0)
 S DIR("?")="   "
"RTN","WVGETALL",61,0)
 S DIR("?",1)="     If the patient has not had a Visit or Admission before this date,"
"RTN","WVGETALL",62,0)
 S DIR("?",2)="     they will not be included in the auto-load."
"RTN","WVGETALL",63,0)
 S DIR("?",3)="     This date may be up to 3 years prior to todays date, but must be"
"RTN","WVGETALL",64,0)
 S DIR("?",4)="     after the start date."
"RTN","WVGETALL",65,0)
 S Y=DT D DD^%DT S DIR("B")=Y
"RTN","WVGETALL",66,0)
 D ^DIR K DIR I Y'>0  W !!!! K WVJSDT S WVPOP=1 Q
"RTN","WVGETALL",67,0)
 I Y<WVJSDT W !!!,"     END DATE MUST BE AFTER START DATE",!!! K WVJSDT G STD
"RTN","WVGETALL",68,0)
 S WVJEDT=Y
"RTN","WVGETALL",69,0)
 Q
"RTN","WVGETALL",70,0)
 ;
"RTN","WVGETALL",71,0)
DEVICE ;EP
"RTN","WVGETALL",72,0)
 ;---> GET DEVICE AND POSSIBLY QUEUE TO TASKMAN.
"RTN","WVGETALL",73,0)
 S ZTRTN="LOAD^WVGETALL"
"RTN","WVGETALL",74,0)
 S ZTSAVE("WVAGE")="",ZTSAVE("WVJSDT")="",ZTSAVE("WVJEDT")=""
"RTN","WVGETALL",75,0)
 D ZIS^WVUTL2(.WVPOP,1)
"RTN","WVGETALL",76,0)
 Q
"RTN","WVGETALL",77,0)
 ;
"RTN","WVGETALL",78,0)
LOAD ;EP
"RTN","WVGETALL",79,0)
 ;---> AUTOLOAD OF PATIENTS
"RTN","WVGETALL",80,0)
 N WVCOUNT,WVERROR,N,X,Y D SETVARS^WVUTL5
"RTN","WVGETALL",81,0)
 D TOPHEAD^WVUTL7 S WVCONF=1
"RTN","WVGETALL",82,0)
 S WVTITLE="* AUTOLOAD OF WOMEN PATIENTS *"
"RTN","WVGETALL",83,0)
 D CENTERT^WVUTL5(.WVTITLE)
"RTN","WVGETALL",84,0)
 U IO
"RTN","WVGETALL",85,0)
 W:$Y>0 @IOF D HEADER7^WVUTL7
"RTN","WVGETALL",86,0)
 S (WVCOUNT,N)=0
"RTN","WVGETALL",87,0)
 S WVN=0 F  S WVN=$O(^DPT("ASX","F",WVN)) Q:'WVN  Q:WVPOP  D
"RTN","WVGETALL",88,0)
 .S Y=^DPT(WVN,0)
"RTN","WVGETALL",89,0)
 .;---> QUIT IF NOT FEMALE.
"RTN","WVGETALL",90,0)
 .Q:$P(Y,U,2)'="F"
"RTN","WVGETALL",91,0)
 .;---> QUIT IF DECEASED OR LESS THAN WVAGE.
"RTN","WVGETALL",92,0)
 .Q:+$$AGE^WVUTL1(WVN)<WVAGE
"RTN","WVGETALL",93,0)
 .Q:$D(^WV(790,WVN,0))
"RTN","WVGETALL",94,0)
 .; Quit if patient not a veteran or doesn't have selected eligibility
"RTN","WVGETALL",95,0)
 .; code
"RTN","WVGETALL",96,0)
 .Q:'$$VECCHK^WVGETAL1()
"RTN","WVGETALL",97,0)
 .;Q:$$GET1^DIQ(2,WVN,1901,"I")'="Y"
"RTN","WVGETALL",98,0)
 .;Quit if not active patient
"RTN","WVGETALL",99,0)
 .Q:$$HOS(WVN)<1
"RTN","WVGETALL",100,0)
 .I $Y+5>IOSL D:WVCRT DIRZ^WVUTL3 Q:WVPOP  D HEADER7^WVUTL7
"RTN","WVGETALL",101,0)
 .W !?3,$$NAME^WVUTL1(WVN),?30,$$SSN^WVUTL1(WVN)
"RTN","WVGETALL",102,0)
 .W ?45,$$SLDT2^WVUTL5($$DOB^WVUTL1(WVN))
"RTN","WVGETALL",103,0)
 .D AUTOADD^WVPATE(WVN,DUZ(2),.WVERROR)
"RTN","WVGETALL",104,0)
 .I WVERROR<0 W ?60,"FAILED" Q
"RTN","WVGETALL",105,0)
 .S WVCOUNT=WVCOUNT+1 W ?60,"ADDED" ;,?70,WVN
"RTN","WVGETALL",106,0)
 W !!?5,"TOTAL: ",WVCOUNT," PATIENT",$S(WVCOUNT=1:"",1:"S")
"RTN","WVGETALL",107,0)
 W " ADDED TO THE WOMEN'S HEALTH DATABASE.",!
"RTN","WVGETALL",108,0)
 I WVCRT&('$D(IO("S"))) D DIRZ^WVUTL3 W @IOF
"RTN","WVGETALL",109,0)
 K TEST1,TEST2 D ^%ZISC
"RTN","WVGETALL",110,0)
 Q
"RTN","WVGETALL",111,0)
 ;
"RTN","WVGETALL",112,0)
 ;
"RTN","WVGETALL",113,0)
TEXT1 ;EP
"RTN","WVGETALL",114,0)
 ;;This utility will examine the VISTA Patient file (#2) for ALL
"RTN","WVGETALL",115,0)
 ;;WOMEN VETERANS or WOMEN patients with an ELIGIBILITY CODE you
"RTN","WVGETALL",116,0)
 ;;select over a given age who were seen in the date range selected,
"RTN","WVGETALL",117,0)
 ;;and add them to the Women's Health Database.
"RTN","WVGETALL",118,0)
 ;;
"RTN","WVGETALL",119,0)
 ;;You will be asked to select a cutoff age (e.g., 40 and over),
"RTN","WVGETALL",120,0)
 ;;Start and End Activity dates and Eligibility Code(s).
"RTN","WVGETALL",121,0)
 ;;Patients not having a visit or admission between these dates
"RTN","WVGETALL",122,0)
 ;;will not be added to the file.  These dates can be no more
"RTN","WVGETALL",123,0)
 ;;than 3 years prior to today's date.
"RTN","WVGETALL",124,0)
 ;;
"RTN","WVGETALL",125,0)
 ;;Women already in the Women's Health Database will not be added twice.
"RTN","WVGETALL",126,0)
 ;;Women who are deceased will not be added.  Women added to the Women's
"RTN","WVGETALL",127,0)
 ;;Health Database will be given Breast and Cervical Treatment Needs of
"RTN","WVGETALL",128,0)
 ;;"Undetermined", with no due dates.
"RTN","WVGETALL",129,0)
 ;;
"RTN","WVGETALL",130,0)
 ;;This utility may be run at any time, as often as desired.  It may be
"RTN","WVGETALL",131,0)
 ;;useful to run it on a monthly basis in order to pick up new women who
"RTN","WVGETALL",132,0)
 ;;are added to the Patient Database.
"RTN","WVGETALL",133,0)
 S WVTAB=5,WVLINL="TEXT1" D PRINTX
"RTN","WVGETALL",134,0)
 Q
"RTN","WVGETALL",135,0)
 ;
"RTN","WVGETALL",136,0)
 ;
"RTN","WVGETALL",137,0)
TEXT2 ;EP
"RTN","WVGETALL",138,0)
 ;;Before the program begins, you will be prompted for a "DEVICE:".
"RTN","WVGETALL",139,0)
 ;;The name, social security number, and date of birth of each
"RTN","WVGETALL",140,0)
 ;;patient added to the Women's Health Database will be displayed
"RTN","WVGETALL",141,0)
 ;;on the DEVICE.
"RTN","WVGETALL",142,0)
 ;;This DEVICE may be a printer, or you may enter "HOME" to have the
"RTN","WVGETALL",143,0)
 ;;information simply display on your screen.
"RTN","WVGETALL",144,0)
 ;;
"RTN","WVGETALL",145,0)
 ;;If the DEVICE you select is a printer, it may be preferable
"RTN","WVGETALL",146,0)
 ;;to "queue" the job, in order to free up your terminal.
"RTN","WVGETALL",147,0)
 ;;See your computer sitemanager for assistance with queuing jobs.
"RTN","WVGETALL",148,0)
 ;;
"RTN","WVGETALL",149,0)
 ;;WARNING: The first time this utility is run, it may add several
"RTN","WVGETALL",150,0)
 ;;thousand patients to the Women's Health Database.  It may take
"RTN","WVGETALL",151,0)
 ;;several minutes or even hours to run, depending on the size of the
"RTN","WVGETALL",152,0)
 ;;database and speed of the computer.  Subsequent runs should be much
"RTN","WVGETALL",153,0)
 ;;quicker.
"RTN","WVGETALL",154,0)
 ;;
"RTN","WVGETALL",155,0)
 ;;You may type "^" at anytime to quit before the program begins.
"RTN","WVGETALL",156,0)
 S WVTAB=5,WVLINL="TEXT2" D PRINTX
"RTN","WVGETALL",157,0)
 Q
"RTN","WVGETALL",158,0)
 ;
"RTN","WVGETALL",159,0)
HELP1 ;EP
"RTN","WVGETALL",160,0)
 ;;Enter a two-digit number that will be the lowest age of patients
"RTN","WVGETALL",161,0)
 ;;added to the Women's Health Database.  For example, if you enter 15,
"RTN","WVGETALL",162,0)
 ;;all women age 15 and older will be included, 14 and under will not.
"RTN","WVGETALL",163,0)
 S WVTAB=5,WVLINL="HELP1" D HELPTX
"RTN","WVGETALL",164,0)
 Q
"RTN","WVGETALL",165,0)
 ;
"RTN","WVGETALL",166,0)
 ;
"RTN","WVGETALL",167,0)
PRINTX ;EP
"RTN","WVGETALL",168,0)
 N I,T,X S T=$$REPEAT^XLFSTR(" ",WVTAB)
"RTN","WVGETALL",169,0)
 F I=1:1 S X=$T(@WVLINL+I) Q:X'[";;"  W !,T,$P(X,";;",2)
"RTN","WVGETALL",170,0)
 Q
"RTN","WVGETALL",171,0)
 ;
"RTN","WVGETALL",172,0)
HELPTX ;EP
"RTN","WVGETALL",173,0)
 N I,T,X S T=$$REPEAT^XLFSTR(" ",WVTAB)
"RTN","WVGETALL",174,0)
 F I=1:1 S X=$T(@WVLINL+I) Q:X'[";;"  S DIR("?",I)=T_$P(X,";;",2)
"RTN","WVGETALL",175,0)
 S DIR("?")=DIR("?",I-1) K DIR("?",I-1)
"RTN","WVGETALL",176,0)
 Q
"RTN","WVGETALL",177,0)
HOS(WVN) ;Comes here to determine if visit/adm. is current
"RTN","WVGETALL",178,0)
 ;WVN=DFN, WVJSDT=Selected earliest date for consideration.
"RTN","WVGETALL",179,0)
 S WVST="ADFN"_WVN
"RTN","WVGETALL",180,0)
 S TEST1=$O(^DGPM(WVST,WVJSDT)) I TEST1>WVJSDT I TEST1<WVJEDT Q 1
"RTN","WVGETALL",181,0)
 S TEST2=$O(^SCE("ADFN",WVN,WVJSDT)) I TEST2>WVJSDT I TEST2<WVJEDT Q 1
"RTN","WVGETALL",182,0)
 Q 0
"RTN","WVLETPR")
0^2^B34996416
"RTN","WVLETPR",1,0)
WVLETPR ;HCIOFO/FT,JR-WV PRINT LETTERS.  ;8/5/99  15:56
"RTN","WVLETPR",2,0)
 ;;1.0;WOMEN'S HEALTH;**7**;Sep 30, 1998
"RTN","WVLETPR",3,0)
 ;;  Original routine created by IHS/ANMC/MWR
"RTN","WVLETPR",4,0)
 ;;* MICHAEL REMILLARD, DDS * ALASKA NATIVE MEDICAL CENTER *
"RTN","WVLETPR",5,0)
 ;;  CALLED BY OPTION: "WV PRINT INDIVIDUAL LETTERS" TO PRINT A
"RTN","WVLETPR",6,0)
 ;;  LETTER FOR A SINGLE INDIVIDUAL (AS OPPOSED TO ALL THOSE QUEUED).
"RTN","WVLETPR",7,0)
 ;
"RTN","WVLETPR",8,0)
 D SETVARS^WVUTL5 S (WVPOP1,WVPOP)=0
"RTN","WVLETPR",9,0)
 N WVDA,WVTITLE
"RTN","WVLETPR",10,0)
 F  S WVPOP=0 D  Q:WVPOP1
"RTN","WVLETPR",11,0)
 .D SELECT Q:WVPOP
"RTN","WVLETPR",12,0)
 .D DEVICE Q:WVPOP
"RTN","WVLETPR",13,0)
 .S WVCRT=$S($E(IOST)="C":1,1:0)
"RTN","WVLETPR",14,0)
 .D PRINT
"RTN","WVLETPR",15,0)
 D ^%ZISC
"RTN","WVLETPR",16,0)
 ;
"RTN","WVLETPR",17,0)
EXIT ;EP
"RTN","WVLETPR",18,0)
 D KILLALL^WVUTL8
"RTN","WVLETPR",19,0)
 Q
"RTN","WVLETPR",20,0)
 ;
"RTN","WVLETPR",21,0)
SELECT ;EP
"RTN","WVLETPR",22,0)
 ;---> SELECT PATIENT, THEN SELECT NOTIFICATION.
"RTN","WVLETPR",23,0)
 N DIC,X,Y
"RTN","WVLETPR",24,0)
 D TITLE^WVUTL5("PRINT INDIVIDUAL PATIENT LETTERS")
"RTN","WVLETPR",25,0)
 D PATLKUP^WVUTL8(.Y)
"RTN","WVLETPR",26,0)
 I Y<0 S (WVPOP,WVPOP1)=1 Q
"RTN","WVLETPR",27,0)
 S WVDFN=+Y,X=$$NAME^WVUTL1(WVDFN)
"RTN","WVLETPR",28,0)
 D DIC^WVFMAN(790.4,"EM",.Y,"","","",X,.WVPOP)
"RTN","WVLETPR",29,0)
 I $D(DUOUT)!($D(DTOUT)) S WVPOP=1 Q
"RTN","WVLETPR",30,0)
 I Y<0 D NONE S WVPOP=1 Q
"RTN","WVLETPR",31,0)
 S WVDA=+Y
"RTN","WVLETPR",32,0)
 ;
"RTN","WVLETPR",33,0)
 ;---> IF FACILITIES OF LETTER AND USER DON'T MATCH, QUIT.
"RTN","WVLETPR",34,0)
 N WVFACIL S WVFACIL=$P(^WV(790.4,WVDA,0),U,7)
"RTN","WVLETPR",35,0)
 I ((WVFACIL'=DUZ(2))&(WVFACIL)) D TEXT1,DIRZ^WVUTL3 S WVPOP=1 Q
"RTN","WVLETPR",36,0)
 ;
"RTN","WVLETPR",37,0)
 S WVPURP=$P(^WV(790.4,WVDA,0),U,4)
"RTN","WVLETPR",38,0)
 S WVTYPE=$P(^WV(790.4,WVDA,0),U,3)
"RTN","WVLETPR",39,0)
 ;
"RTN","WVLETPR",40,0)
 ;---> CHECK IF PURPOSE HAS BEEN ENTERED.
"RTN","WVLETPR",41,0)
 I 'WVPURP D  Q
"RTN","WVLETPR",42,0)
 .W !!?5,"No Purpose has been entered for this Notification."
"RTN","WVLETPR",43,0)
 .D DIRZ^WVUTL3 S WVPOP=1 Q
"RTN","WVLETPR",44,0)
 ;
"RTN","WVLETPR",45,0)
 ;---> CHECK IF THIS PURPOSE OF NOTIFICATION HAS A LETTER.
"RTN","WVLETPR",46,0)
 I '$D(^WV(790.404,WVPURP,1,0)) D  Q
"RTN","WVLETPR",47,0)
 .W !!!?5,"No letter has been entered for this Purpose of Notification."
"RTN","WVLETPR",48,0)
 .W !?5,"Programmer information: Notification=^WV(790.4,"_WVDA_",0)."
"RTN","WVLETPR",49,0)
 .W !?5,"                         Purpose IEN=",WVPURP
"RTN","WVLETPR",50,0)
 .W !?5,"                         Patient IEN=",WVDFN
"RTN","WVLETPR",51,0)
 .D DIRZ^WVUTL3 S WVPOP=1 Q
"RTN","WVLETPR",52,0)
 ;
"RTN","WVLETPR",53,0)
 ;---> CHECK IF TYPE OF NOTIFICATION FOR THIS NOTIFICATION IS PRINTABLE.
"RTN","WVLETPR",54,0)
 I 'WVTYPE D CANTPRT Q
"RTN","WVLETPR",55,0)
 I '$P(^WV(790.403,WVTYPE,0),U,2) D CANTPRT Q
"RTN","WVLETPR",56,0)
 Q
"RTN","WVLETPR",57,0)
 ;
"RTN","WVLETPR",58,0)
CANTPRT ;EP
"RTN","WVLETPR",59,0)
 ;---> CAN'T PRINT THIS NOTIFICATION.
"RTN","WVLETPR",60,0)
 W !!?5,"This Type of Notification"
"RTN","WVLETPR",61,0)
 W:WVTYPE ", ",$P(^WV(790.403,WVTYPE,0),U),"," W " is not printable."
"RTN","WVLETPR",62,0)
 D DIRZ^WVUTL3 S WVPOP=1
"RTN","WVLETPR",63,0)
 Q
"RTN","WVLETPR",64,0)
 ;
"RTN","WVLETPR",65,0)
DEVICE ;EP
"RTN","WVLETPR",66,0)
 ;---> GET DEVICE AND POSSIBLY QUEUE TO TASKMAN.
"RTN","WVLETPR",67,0)
 K %ZIS,IOP
"RTN","WVLETPR",68,0)
 S ZTRTN="PRINT^WVLETPR",ZTSAVE("WVDA")=""
"RTN","WVLETPR",69,0)
 D ZIS^WVUTL2(.WVPOP,1)
"RTN","WVLETPR",70,0)
 Q
"RTN","WVLETPR",71,0)
 ;
"RTN","WVLETPR",72,0)
PRINT ;EP
"RTN","WVLETPR",73,0)
 ;---> REQUIRED VARIABLE: WVDA=IEN IN ^WV(790.4, ION=DEVICE
"RTN","WVLETPR",74,0)
 ;---> NEXT LINE: IOP WILL INHIBIT ^DIWF FROM PROMPTING FOR DEVICE.
"RTN","WVLETPR",75,0)
 D SETVARS^WVUTL5
"RTN","WVLETPR",76,0)
 N WVDFN,WVPURP,IOP
"RTN","WVLETPR",77,0)
 S IOP=ION
"RTN","WVLETPR",78,0)
 ;---> IF FACILITIES OF LETTER AND USER DON'T MATCH, QUIT (IF NULL, OK).
"RTN","WVLETPR",79,0)
 N WVFACIL S WVFACIL=$P(^WV(790.4,WVDA,0),U,7)
"RTN","WVLETPR",80,0)
 I ((WVFACIL'=DUZ(2))&(WVFACIL)) D TEXT1 H 5 S WVPOP=1 Q
"RTN","WVLETPR",81,0)
 ;
"RTN","WVLETPR",82,0)
 S WVDFN=$P(^WV(790.4,WVDA,0),U)
"RTN","WVLETPR",83,0)
 S WVPURP=$P(^WV(790.4,WVDA,0),U,4)
"RTN","WVLETPR",84,0)
 ;---> WVN=DATE OF "PRINT DATE", USE TO KILL "APRT" XREF BELOW.
"RTN","WVLETPR",85,0)
 S:'$D(WVKDT) WVKDT=$P(^WV(790.4,WVDA,0),U,11)
"RTN","WVLETPR",86,0)
 ;---> IF NO PURPOSE (DELETED), KILL "APRT" XREF AND QUIT.
"RTN","WVLETPR",87,0)
 I 'WVPURP D  Q
"RTN","WVLETPR",88,0)
 .W !!?5,"No Purpose of Notification has been chosen; therefore, this"
"RTN","WVLETPR",89,0)
 .W !?5,"notification cannot be printed."
"RTN","WVLETPR",90,0)
 .D KILLXREF(WVDA,WVKDT)
"RTN","WVLETPR",91,0)
 ;---> IF QUEUED AND WVCRT IS NOT SET, THEN SET IT.
"RTN","WVLETPR",92,0)
 S:'$D(WVCRT) WVCRT=$S($E(IOST)="C":1,1:0)
"RTN","WVLETPR",93,0)
 S DIWF="^WV(790.404,WVPURP,1,"
"RTN","WVLETPR",94,0)
 S DIWF(1)=790
"RTN","WVLETPR",95,0)
 S BY="INTERNAL(#.01)="_WVDFN
"RTN","WVLETPR",96,0)
 ;---> IF LOCKED, PROMPT DEVICE, QUIT AND LEAVE IN THE QUEUE.
"RTN","WVLETPR",97,0)
 L +^WV(790.4,WVDA):0 I '$T U IO D  D PROMPT Q
"RTN","WVLETPR",98,0)
 .W !!?5,"The selected Notification is being edited by another user."
"RTN","WVLETPR",99,0)
 .W !?5,"Programmer information: Notification=^WV(790.4,"_WVDA_",0)."
"RTN","WVLETPR",100,0)
 .W:'WVCRT @IOF
"RTN","WVLETPR",101,0)
 ;
"RTN","WVLETPR",102,0)
 ;---> IF PATIENT IS DECEASED, DON'T PRINT LETTER; PRINT EXPLANATION,
"RTN","WVLETPR",103,0)
 ;---> CHANGE THE STATUS OF THE NOTIFICATION TO "CLOSED", AND GIVE
"RTN","WVLETPR",104,0)
 ;---> THE OUTCOME OF "PATIENT DECEASED".
"RTN","WVLETPR",105,0)
 I $$DECEASED^WVUTL1(WVDFN) D DECEASED Q
"RTN","WVLETPR",106,0)
 ;---> Compute future appointments
"RTN","WVLETPR",107,0)
 D KAPPT^WVUTL9(WVDFN) ;kill off old computed appts.
"RTN","WVLETPR",108,0)
 D GAPPT^WVUTL9(WVDFN) ;get future appts
"RTN","WVLETPR",109,0)
 D SAPPT^WVUTL9(WVDFN) ;set appts in File 790
"RTN","WVLETPR",110,0)
 D KILLUG^WVUTL9 ;kill off Utility global off future appts
"RTN","WVLETPR",111,0)
 ;---> PRINT IT TO IOP, PRESERVE WVPOP.
"RTN","WVLETPR",112,0)
 D EN2^DIWF
"RTN","WVLETPR",113,0)
 D PROMPT
"RTN","WVLETPR",114,0)
 ;---> DON'T STUFF "DATE PRINTED" IF IT ALREADY HAS A "DATE PRINTED".
"RTN","WVLETPR",115,0)
 I $P(^WV(790.4,WVDA,0),U,10)]"" D KILLXREF(WVDA,WVKDT) L -^WV(790.4,WVDA) Q
"RTN","WVLETPR",116,0)
 ;
"RTN","WVLETPR",117,0)
 ;---> DON'T STUFF "DATE PRINTED" IF IT'S JUST TO THE SCREEN.
"RTN","WVLETPR",118,0)
 I WVCRT D  Q
"RTN","WVLETPR",119,0)
 .W !!?3,"NOTE: Because this letter was only displayed on a screen and"
"RTN","WVLETPR",120,0)
 .W !?9,"not printed on a printer, it will NOT yet be logged by the"
"RTN","WVLETPR",121,0)
 .W !?9,"program as having been ""PRINTED"".",!
"RTN","WVLETPR",122,0)
 .L -^WV(790.4,WVDA) D DIRZ^WVUTL3
"RTN","WVLETPR",123,0)
 ;
"RTN","WVLETPR",124,0)
 ;---> NEXT LINES KILL "APRT" XREF AND SET "DATE PRINTED"=TODAY.
"RTN","WVLETPR",125,0)
 ;---> ("APRT" XREF INDICATE A NOTIFICATION IS QUEUED TO BE PRINTED.)
"RTN","WVLETPR",126,0)
 D KILLXREF(WVDA,WVKDT)
"RTN","WVLETPR",127,0)
 D DIE^WVFMAN(790.4,".1////"_DT,WVDA)
"RTN","WVLETPR",128,0)
 L -^WV(790.4,WVDA) Q
"RTN","WVLETPR",129,0)
 Q
"RTN","WVLETPR",130,0)
 ;
"RTN","WVLETPR",131,0)
KILLXREF(WVDA,WVKDT) ;EP
"RTN","WVLETPR",132,0)
 ;---> KILL "APRT" XREF (REMOVE LETTER FROM QUEUE).
"RTN","WVLETPR",133,0)
 Q:'$G(WVDA)  Q:'$G(WVKDT)
"RTN","WVLETPR",134,0)
 K ^WV(790.4,"APRT",WVKDT,WVDA)
"RTN","WVLETPR",135,0)
 Q
"RTN","WVLETPR",136,0)
 ;
"RTN","WVLETPR",137,0)
DECEASED ;EP
"RTN","WVLETPR",138,0)
 ;---> IF THE PATIENT IS DECEASED.
"RTN","WVLETPR",139,0)
 ;---> DON'T STUFF "DATE PRINTED" IF IT'S JUST TO THE SCREEN.
"RTN","WVLETPR",140,0)
 W !!?3,"NOTE: Because this patient, ",$$NAME^WVUTL1(WVDFN)," #"
"RTN","WVLETPR",141,0)
 W $$SSN^WVUTL1(WVDFN),", is now"
"RTN","WVLETPR",142,0)
 W !?9,"registered as deceased, the letter will NOT be printed."
"RTN","WVLETPR",143,0)
 W !?9,"Instead, this notification will be given a status of CLOSED"
"RTN","WVLETPR",144,0)
 W !?9,"and an outcome of ""Patient Deceased""."
"RTN","WVLETPR",145,0)
 D:WVCRT&('$D(IO("S"))) DIRZ^WVUTL3
"RTN","WVLETPR",146,0)
 W:'WVCRT @IOF
"RTN","WVLETPR",147,0)
 S DR=".14////c;.05///Patient Deceased"
"RTN","WVLETPR",148,0)
 D DIE^WVFMAN(790.4,DR,WVDA)
"RTN","WVLETPR",149,0)
 ;---> KILL "APRT" XREF (FLAGS NOTIFICATION AS QUEUED TO BE PRINTED).
"RTN","WVLETPR",150,0)
 D KILLXREF(WVDA,WVKDT)
"RTN","WVLETPR",151,0)
 L -^WV(790.4,WVDA)
"RTN","WVLETPR",152,0)
 Q
"RTN","WVLETPR",153,0)
 ;
"RTN","WVLETPR",154,0)
PROMPT ;EP
"RTN","WVLETPR",155,0)
 ;---> PROMPT IF NECESSARY, PROMPT DEVICE.
"RTN","WVLETPR",156,0)
 D:WVCRT DIRZ^WVUTL3
"RTN","WVLETPR",157,0)
 Q
"RTN","WVLETPR",158,0)
 ;
"RTN","WVLETPR",159,0)
NONE ;EP
"RTN","WVLETPR",160,0)
 S WVTITLE="* No letters selected for printing. *"
"RTN","WVLETPR",161,0)
 D CENTERT^WVUTL5(.WVTITLE)
"RTN","WVLETPR",162,0)
 W !!!!,WVTITLE,!!
"RTN","WVLETPR",163,0)
 D DIRZ^WVUTL3
"RTN","WVLETPR",164,0)
 Q
"RTN","WVLETPR",165,0)
 ;
"RTN","WVLETPR",166,0)
TEXT1 ;EP
"RTN","WVLETPR",167,0)
 ;;
"RTN","WVLETPR",168,0)
 ;;* NOTE: The Facility with which this letter is associated does not
"RTN","WVLETPR",169,0)
 ;;        match the Facility under which you are currently logged on.
"RTN","WVLETPR",170,0)
 ;;        To print this Notification, you must either edit the Facility
"RTN","WVLETPR",171,0)
 ;;        for this Notification, or log off and log back in under the
"RTN","WVLETPR",172,0)
 ;;        same Facility with which the Notification is associated.
"RTN","WVLETPR",173,0)
 S WVTAB=5,WVLINL="TEXT1" D PRINTX
"RTN","WVLETPR",174,0)
 Q
"RTN","WVLETPR",175,0)
 ;
"RTN","WVLETPR",176,0)
PRINTX ;EP
"RTN","WVLETPR",177,0)
 N I,T,X S T=$$REPEAT^XLFSTR(" ",WVTAB)
"RTN","WVLETPR",178,0)
 F I=1:1 S X=$T(@WVLINL+I) Q:X'[";;"  W !,T,$P(X,";;",2)
"RTN","WVLETPR",179,0)
 Q
"RTN","WVNOTIF")
0^20^B22756649
"RTN","WVNOTIF",1,0)
WVNOTIF ;HCIOFO/FT,JR-WV ADD/EDIT WV NOTIFICATIONS; ;6/10/99  17:14
"RTN","WVNOTIF",2,0)
 ;;1.0;WOMEN'S HEALTH;**7**;Sep 30, 1998
"RTN","WVNOTIF",3,0)
 ;;  Original routine created by IHS/ANMC/MWR
"RTN","WVNOTIF",4,0)
 ;;* MICHAEL REMILLARD, DDS * ALASKA NATIVE MEDICAL CENTER *
"RTN","WVNOTIF",5,0)
 ;;  CALLED BY DIFFERENT OPTIONS TO ADD/EDIT NOTIFICATIONS.
"RTN","WVNOTIF",6,0)
 ;
"RTN","WVNOTIF",7,0)
ADD ;EP
"RTN","WVNOTIF",8,0)
 ;---> CALLED BY OPTION: "WV ADD A NEW NOTIFICATION".
"RTN","WVNOTIF",9,0)
 D SETVARS^WVUTL5
"RTN","WVNOTIF",10,0)
 D TITLE^WVUTL5("ADD NEW NOTIFICATION")
"RTN","WVNOTIF",11,0)
 D PATLKUP^WVUTL8(.Y)
"RTN","WVNOTIF",12,0)
 D:Y>0 NEW(+Y)
"RTN","WVNOTIF",13,0)
 D EXIT
"RTN","WVNOTIF",14,0)
 Q
"RTN","WVNOTIF",15,0)
 ;
"RTN","WVNOTIF",16,0)
 ;
"RTN","WVNOTIF",17,0)
EDIT ;EP
"RTN","WVNOTIF",18,0)
 ;---> CALLED BY OPTION: "WV EDIT NOTIFICATION".
"RTN","WVNOTIF",19,0)
 ;---> EDIT AN EXISTING NOTIFICATION.
"RTN","WVNOTIF",20,0)
 N WVENFLAG S WVENFLAG=0
"RTN","WVNOTIF",21,0)
 F  Q:WVENFLAG<0  D EDIT1
"RTN","WVNOTIF",22,0)
 Q
"RTN","WVNOTIF",23,0)
EDIT1 ;
"RTN","WVNOTIF",24,0)
 D SETVARS^WVUTL5
"RTN","WVNOTIF",25,0)
 N WVDICB,Y
"RTN","WVNOTIF",26,0)
 D TITLE^WVUTL5("EDIT A NOTIFICATION")
"RTN","WVNOTIF",27,0)
 S WVDICB=+$G(^DISV(DUZ,"^WV(790.4,"))
"RTN","WVNOTIF",28,0)
 S WVDICB=$S(WVDICB>0:$$GET1^DIQ(2,+$P($G(^WV(790.4,WVDICB,0)),U),.01,"E"),1:"")
"RTN","WVNOTIF",29,0)
 I WVDICB="" D DIC^WVFMAN(790.4,"QEMA",.Y,"   Select PATIENT: ")
"RTN","WVNOTIF",30,0)
 I WVDICB]"" D DIC^WVFMAN(790.4,"QEMA",.Y,"   Select PATIENT: ",WVDICB)
"RTN","WVNOTIF",31,0)
 I Y<0 D EXIT S WVENFLAG=-1 Q
"RTN","WVNOTIF",32,0)
 D EDIT2(+Y),EXIT
"RTN","WVNOTIF",33,0)
 Q
"RTN","WVNOTIF",34,0)
 ;
"RTN","WVNOTIF",35,0)
EXIT ;EP
"RTN","WVNOTIF",36,0)
 D KILLALL^WVUTL8
"RTN","WVNOTIF",37,0)
 Q
"RTN","WVNOTIF",38,0)
 ;
"RTN","WVNOTIF",39,0)
 ;
"RTN","WVNOTIF",40,0)
NEW(WVDFN,WVACCN) ;EP
"RTN","WVNOTIF",41,0)
 ;---> STUFF NEW ENTRY IN WV NOTIFICATION FILE, .01=DFN.
"RTN","WVNOTIF",42,0)
 ;---> REQUIRED VARIABLE: WVDFN=IEN OF WV PATIENT, FILE 790.
"RTN","WVNOTIF",43,0)
 ;---> OPTIONAL VARIABLE: WVACCN=ACCESSION# FOR PROCEDURE.
"RTN","WVNOTIF",44,0)
 I $$DECEASED^WVUTL1(WVDFN) D  Q
"RTN","WVNOTIF",45,0)
 .W !!?5,"This patient is registered as deceased." D DIRZ^WVUTL3
"RTN","WVNOTIF",46,0)
 N DA,DIC,X
"RTN","WVNOTIF",47,0)
 S X=WVDFN K DD,DO
"RTN","WVNOTIF",48,0)
 S DIC="^WV(790.4,",DIC(0)="ML",DLAYGO=790
"RTN","WVNOTIF",49,0)
 S DIC("DR")=".02///T;.06///"_$S($D(WVACCN):$P(WVACCN,","),1:"")
"RTN","WVNOTIF",50,0)
 S DIC("DR")=DIC("DR")_";.07////"_$G(DUZ(2))
"RTN","WVNOTIF",51,0)
 D FILE^DICN K DD,DO,DIC
"RTN","WVNOTIF",52,0)
 ;---> IF Y<0, CHECK PERMISSIONS.
"RTN","WVNOTIF",53,0)
 I Y<0 D ERROR1 Q
"RTN","WVNOTIF",54,0)
 D EDIT2(+Y)
"RTN","WVNOTIF",55,0)
 Q
"RTN","WVNOTIF",56,0)
 ;
"RTN","WVNOTIF",57,0)
 ;
"RTN","WVNOTIF",58,0)
EDIT2(DA) ;EP - FROM WVBRNOT2
"RTN","WVNOTIF",59,0)
 ;---> REQUIRED VARIABLES: DA=IEN IN ^WV(790.4,.
"RTN","WVNOTIF",60,0)
 N WVDA D SETVARS^WVUTL5
"RTN","WVNOTIF",61,0)
 S WVDFN=$P(^WV(790.4,DA,0),U)
"RTN","WVNOTIF",62,0)
 D SCREEN(DA,WVDFN,.WVPOP)
"RTN","WVNOTIF",63,0)
 Q:WVPOP
"RTN","WVNOTIF",64,0)
 I $G(DA) S WVDA=DA D PRINTNOW
"RTN","WVNOTIF",65,0)
 ;---> OPPORTUNITY TO EDIT PATIENT'S CASE DATA.
"RTN","WVNOTIF",66,0)
 ;---> IF $D(WVLOOP), NEW (ABOVE) WAS CALLED FROM CASEDATA^WVPATE,
"RTN","WVNOTIF",67,0)
 ;---> SO DON'T LOOP THROUGH AGAIN.
"RTN","WVNOTIF",68,0)
 D:'$D(WVLOOP) CASEDATA^WVPATE(WVDFN)
"RTN","WVNOTIF",69,0)
 Q
"RTN","WVNOTIF",70,0)
 ;
"RTN","WVNOTIF",71,0)
 ;
"RTN","WVNOTIF",72,0)
SCREEN(DA,WVDFN,WVPOP) ;EP
"RTN","WVNOTIF",73,0)
 ;---> EDIT WITH SCREENMAN.
"RTN","WVNOTIF",74,0)
 ;---> NEEDS WVDFN FOR SCREEN ON ACCESSION# FIELD LOOKUP.
"RTN","WVNOTIF",75,0)
 S DDSFILE=790.4,DR="[WV NOTIF-FORM-1]",WVPOP=0
"RTN","WVNOTIF",76,0)
 ;---> IF THIS NOTIFICATION HAS ALREADY BEEN PRINTED, THEN DISALLOW
"RTN","WVNOTIF",77,0)
 ;---> THE USER TO EDIT MOST FIELDS BY USING FORM-2 BELOW.
"RTN","WVNOTIF",78,0)
 S:$P(^WV(790.4,DA,0),U,10) DR="[WV NOTIF-FORM-2]"
"RTN","WVNOTIF",79,0)
 D DDS^WVFMAN(DDSFILE,DR,DA,"","",.WVPOP)
"RTN","WVNOTIF",80,0)
 Q
"RTN","WVNOTIF",81,0)
 ;
"RTN","WVNOTIF",82,0)
 ;
"RTN","WVNOTIF",83,0)
PRINTNOW ;EP
"RTN","WVNOTIF",84,0)
 ;---> PRINT OR VIEW NOTIFICATION NOW, IF IT'S A LETTER.
"RTN","WVNOTIF",85,0)
 ;---> REQUIRED VARIABLE: WVDA=IEN IN ^WV(790.4,
"RTN","WVNOTIF",86,0)
 Q:'$D(WVDA)
"RTN","WVNOTIF",87,0)
 ;---> QUIT IF THIS NOTIFICATION DOES NOT HAVE A "TYPE OF NOTIFICATION".
"RTN","WVNOTIF",88,0)
 Q:'$P(^WV(790.4,WVDA,0),U,3)
"RTN","WVNOTIF",89,0)
 ;---> QUIT IF TYPE OF NOTIFICATION IS NOT PRINTABLE.
"RTN","WVNOTIF",90,0)
 Q:'$P(^WV(790.403,$P(^WV(790.4,WVDA,0),U,3),0),U,2)
"RTN","WVNOTIF",91,0)
 ;---> QUIT IF THIS NOTIFICATION HAS ALREADY BEEN PRINTED.
"RTN","WVNOTIF",92,0)
 ;Q:$P(^WV(790.4,WVDA,0),U,10) ;DISABLED FOR NOW, ALLOW VIEW OR REPRINT.
"RTN","WVNOTIF",93,0)
 F  D  Q:WVPOP  Q:$P(^WV(790.4,WVDA,0),U,10)
"RTN","WVNOTIF",94,0)
 .N WVCRT,DA,DIR
"RTN","WVNOTIF",95,0)
 .N WVPRMT,WVPRMT1,WVPRMT2,WVPRMTQ
"RTN","WVNOTIF",96,0)
 .W !!,"Do you wish to PREVIEW or PRINT this letter now?"
"RTN","WVNOTIF",97,0)
 .S DIR(0)="Y",DIR("B")="NO" D HELP2
"RTN","WVNOTIF",98,0)
 .D ^DIR K DIR W !
"RTN","WVNOTIF",99,0)
 .I $D(DIRUT)!(Y<1) S WVPOP=1 Q
"RTN","WVNOTIF",100,0)
 .;---> QUIT IF NOT ASSOCIATED WITH THE USER'S CURRENT FACILITY.
"RTN","WVNOTIF",101,0)
 .N WVFACIL S WVFACIL=$P(^WV(790.4,WVDA,0),U,7)
"RTN","WVNOTIF",102,0)
 .I ((WVFACIL'=DUZ(2))&(WVFACIL)) D  S WVPOP=1 Q
"RTN","WVNOTIF",103,0)
 ..D TEXT1^WVLETPR,DIRZ^WVUTL3
"RTN","WVNOTIF",104,0)
 .I Y D DEVICE^WVLETPR Q:WVPOP  D PRINT^WVLETPR
"RTN","WVNOTIF",105,0)
 Q
"RTN","WVNOTIF",106,0)
 ;
"RTN","WVNOTIF",107,0)
ERROR1 ;EP
"RTN","WVNOTIF",108,0)
 W !!?10,*7,"NEW NOTIFICATION ENTRY FOR THIS PATIENT FAILED."
"RTN","WVNOTIF",109,0)
 D DIRZ^WVUTL3
"RTN","WVNOTIF",110,0)
 Q
"RTN","WVNOTIF",111,0)
 ;
"RTN","WVNOTIF",112,0)
ADDNOTIF ;EP
"RTN","WVNOTIF",113,0)
 ;---> ADD NEW NOTIFICATION.
"RTN","WVNOTIF",114,0)
 ;---> AT PRESENT THIS EP IS NOT CALLED BY ANTHING.
"RTN","WVNOTIF",115,0)
 W !,"Do you wish to add a NEW Notification for this patient?"
"RTN","WVNOTIF",116,0)
 S DIR(0)="Y",DIR("B")="NO" D HELP1
"RTN","WVNOTIF",117,0)
 D ^DIR K DIR W !
"RTN","WVNOTIF",118,0)
 I Y D
"RTN","WVNOTIF",119,0)
 .N WVLOOP,DIC,DIE,Y
"RTN","WVNOTIF",120,0)
 .S Y=WVDFN,WVLOOP=1 D NEW(WVDFN)
"RTN","WVNOTIF",121,0)
 Q
"RTN","WVNOTIF",122,0)
 ;
"RTN","WVNOTIF",123,0)
HELP1 ;EP
"RTN","WVNOTIF",124,0)
 ;;Enter YES to add a NEW Notification for this patient.  If the
"RTN","WVNOTIF",125,0)
 ;;notification is a letter, the letter may be queued to print shortly
"RTN","WVNOTIF",126,0)
 ;;before the patient's next appointment by selecting an appropriate
"RTN","WVNOTIF",127,0)
 ;;"Print Date".
"RTN","WVNOTIF",128,0)
 S WVTAB=5,WVLINL="HELP1" D HELPTX
"RTN","WVNOTIF",129,0)
 Q
"RTN","WVNOTIF",130,0)
 ;
"RTN","WVNOTIF",131,0)
HELP2 ;EP
"RTN","WVNOTIF",132,0)
 ;;"Preview" allows you to look at the letter that has just been queued.
"RTN","WVNOTIF",133,0)
 ;;To preview this letter, select HOME at the "DEVICE: " prompt.
"RTN","WVNOTIF",134,0)
 ;;
"RTN","WVNOTIF",135,0)
 ;;"Print" will print the letter now (regardless of its "Print Date")
"RTN","WVNOTIF",136,0)
 ;;and remove it from the queue of letters waiting to print.
"RTN","WVNOTIF",137,0)
 ;;To print this letter now, select a printer at the "DEVICE: " prompt.
"RTN","WVNOTIF",138,0)
 S WVTAB=5,WVLINL="HELP2" D HELPTX
"RTN","WVNOTIF",139,0)
 Q
"RTN","WVNOTIF",140,0)
 ;
"RTN","WVNOTIF",141,0)
HELPTX ;EP
"RTN","WVNOTIF",142,0)
 ;---> CREATES DIR ARRAY FOR DIR.  REQUIRED VARIABLES: WVTAB,WVLINL.
"RTN","WVNOTIF",143,0)
 N I,T,X S T=$$REPEAT^XLFSTR(" ",WVTAB)
"RTN","WVNOTIF",144,0)
 F I=1:1 S X=$T(@WVLINL+I) Q:X'[";;"  S DIR("?",I)=T_$P(X,";;",2)
"RTN","WVNOTIF",145,0)
 S DIR("?")=DIR("?",I-1) K DIR("?",I-1)
"RTN","WVNOTIF",146,0)
 Q
"RTN","WVPOST")
1^16
"RTN","WVPROF2")
0^10^B22021069
"RTN","WVPROF2",1,0)
WVPROF2 ;HCIOFO/FT,JR-DISPLAY PATIENT PROFILE; ;5/27/99  16:48
"RTN","WVPROF2",2,0)
 ;;1.0;WOMEN'S HEALTH;**7**;Sep 30, 1998
"RTN","WVPROF2",3,0)
 ;;  Original routine created by IHS/ANMC/MWR
"RTN","WVPROF2",4,0)
 ;;* MICHAEL REMILLARD, DDS * ALASKA NATIVE MEDICAL CENTER *
"RTN","WVPROF2",5,0)
 ;;  RETRIEVE AND SORT PROCEDURES, NOTIFICATIONS, PAP REGIMENS,
"RTN","WVPROF2",6,0)
 ;;  AND PREGNANCIES FOR PATIENT PROFILE.  CALLED BY WVPROF.
"RTN","WVPROF2",7,0)
 ;
"RTN","WVPROF2",8,0)
SORT ;EP
"RTN","WVPROF2",9,0)
 ;---> SORT AND STORE ARRAY IN ^TMP("WV",$J
"RTN","WVPROF2",10,0)
 ;
"RTN","WVPROF2",11,0)
 K ^TMP("WV",$J)
"RTN","WVPROF2",12,0)
 ;---> WVBEGDT1=ONE SECOND BEFORE BEGIN DATE.
"RTN","WVPROF2",13,0)
 ;---> WVENDDT1=THE LAST SECOND OF END DATE.
"RTN","WVPROF2",14,0)
 ;S WVBEGDT1=WVBEGDT-.0001,WVENDDT1=WVENDDT+.9999    ;---> XDATES
"RTN","WVPROF2",15,0)
 ;
"RTN","WVPROF2",16,0)
 D PATVARS^WVUTL3(WVDFN)
"RTN","WVPROF2",17,0)
 ;
"RTN","WVPROF2",18,0)
 ;*******************
"RTN","WVPROF2",19,0)
 ;---> GET PROCEDURES
"RTN","WVPROF2",20,0)
 S WVIEN=0
"RTN","WVPROF2",21,0)
 F  S WVIEN=$O(^WV(790.1,"C",WVDFN,WVIEN)) Q:'WVIEN  D
"RTN","WVPROF2",22,0)
 .;---> SET Y=THE ZERO NODE FOR THIS PROCEDURE.
"RTN","WVPROF2",23,0)
 .S Y=^WV(790.1,WVIEN,0)
"RTN","WVPROF2",24,0)
 .;---> QUIT IF THIS PROCEDURE HAS A RESULT OF "ERROR/DISREGARD".
"RTN","WVPROF2",25,0)
 .Q:WVERRORS&($P(Y,U,5)=8)
"RTN","WVPROF2",26,0)
 .;---> QUIT IF NOT WITHIN DATE RANGE.
"RTN","WVPROF2",27,0)
 .S (WVDATE,WVDATE1)=$P(Y,U,12)
"RTN","WVPROF2",28,0)
 .;Q:WVDATE'>WVBEGDT1!(WVDATE>WVENDDT1)                ;---> XDATES
"RTN","WVPROF2",29,0)
 .S WVDATE1=$$SLDT2^WVUTL5(WVDATE1)
"RTN","WVPROF2",30,0)
 .S WVACC=$P(Y,U)                                      ;---> ACCESSION#
"RTN","WVPROF2",31,0)
 .S WVPCD=$P(^WV(790.2,$P(Y,U,4),0),U,2)               ;---> PROC TYPE
"RTN","WVPROF2",32,0)
 .S WVSTAT=$$STATUS^WVUTL4                             ;---> STATUS
"RTN","WVPROF2",33,0)
 .S WVDIAG=$$DIAG^WVUTL4($P(Y,U,5))                    ;---> RESULT/DIAG
"RTN","WVPROF2",34,0)
 .S WVPROV=$P(Y,U,7) D                                 ;---> PROVIDER
"RTN","WVPROF2",35,0)
 ..I 'WVPROV S WVPROV="NOT ENTERED" Q
"RTN","WVPROF2",36,0)
 ..S WVPROV=$P($$GET1^DIQ(200,WVPROV,.01,"E"),",")
"RTN","WVPROF2",37,0)
 .;---> FOR PROCEDURES, SET 1ST PIECE AND 6TH SUBSCRIPT=1.
"RTN","WVPROF2",38,0)
 .S X=1_U_U_U_WVDATE1_U_WVPCD_U_WVACC_U_WVDIAG
"RTN","WVPROF2",39,0)
 .S X=X_U_WVPROV_U_WVSTAT_U_WVIEN
"RTN","WVPROF2",40,0)
 .S ^TMP("WV",$J,1,9999999.9999-WVDATE,WVACC,1,WVIEN)=X Q
"RTN","WVPROF2",41,0)
 ;
"RTN","WVPROF2",42,0)
 ;**********************
"RTN","WVPROF2",43,0)
 ;---> GET NOTIFICATIONS
"RTN","WVPROF2",44,0)
 Q:'WVD
"RTN","WVPROF2",45,0)
 S WVIEN=0
"RTN","WVPROF2",46,0)
 F  S WVIEN=$O(^WV(790.4,"B",WVDFN,WVIEN)) Q:'WVIEN  D
"RTN","WVPROF2",47,0)
 .S Y=^WV(790.4,WVIEN,0)
"RTN","WVPROF2",48,0)
 .;---> QUIT IF NOT WITHIN DATE RANGE.  WVDATE1 PRESERVES NOTIF DATE.
"RTN","WVPROF2",49,0)
 .S (WVDATE,WVDATE1)=$P(Y,U,2)
"RTN","WVPROF2",50,0)
 .;Q:WVDATE'>WVBEGDT1!(WVDATE>WVENDDT1)               ;---> XDATE
"RTN","WVPROF2",51,0)
 .S WVDATE1=$$SLDT2^WVUTL5(WVDATE1)
"RTN","WVPROF2",52,0)
 .S WVACC=$P(Y,U,6) D                                 ;---> ACCESSION#
"RTN","WVPROF2",53,0)
 ..I WVACC="" S WVACC="NO ACC#" Q
"RTN","WVPROF2",54,0)
 ..;---> IF THIS NOTIFICATION PERTAINS TO A PROCEDURE (I.E., IT
"RTN","WVPROF2",55,0)
 ..;---> HAS AN ACCESSION#), RESET ITS DATE SO THAT IT WILL COLLATE
"RTN","WVPROF2",56,0)
 ..;---> UNDER ITS PROCEDURE IN THE DISPLAY.
"RTN","WVPROF2",57,0)
 ..S WVACC=$P(^WV(790.1,WVACC,0),U),WVDATE=$P(^(0),U,12)
"RTN","WVPROF2",58,0)
 .S WVSTAT=$$STATUS^WVUTL4                            ;---> STATUS
"RTN","WVPROF2",59,0)
 .S WVTYPE=$P(Y,U,3)  D                               ;---> TYPE
"RTN","WVPROF2",60,0)
 ..I WVTYPE="" S WVTYPE="NOT ENTERED" Q
"RTN","WVPROF2",61,0)
 ..S WVTYPE=$P(^WV(790.403,WVTYPE,0),U)
"RTN","WVPROF2",62,0)
 .S WVPURP=$P(Y,U,4)  D                               ;---> PURPOSE
"RTN","WVPROF2",63,0)
 ..I WVPURP="" S WVPURP="NOT ENTERED" Q
"RTN","WVPROF2",64,0)
 ..S WVPURP=$P(^WV(790.404,WVPURP,0),U)
"RTN","WVPROF2",65,0)
 .S WVOUT=$P(Y,U,5)  D                                ;---> OUTCOME
"RTN","WVPROF2",66,0)
 ..I WVOUT="" S WVOUT="NOT ENTERED" Q
"RTN","WVPROF2",67,0)
 ..S WVOUT=$P(^WV(790.405,WVOUT,0),U)
"RTN","WVPROF2",68,0)
 .;---> FOR NOTIFICATIONS, SET 1ST PIECE AND 6TH SUBSCRIPT=2.
"RTN","WVPROF2",69,0)
 .;S X=2_U_WVCHRT_U_WVNAME_U_WVDATE1_U_WVACC_U_WVTYPE_U_WVPURP
"RTN","WVPROF2",70,0)
 .S X=2_U_U_U_WVDATE1_U_WVACC_U_WVTYPE_U_WVPURP
"RTN","WVPROF2",71,0)
 .S X=X_U_WVOUT_U_WVSTAT_U_WVIEN
"RTN","WVPROF2",72,0)
 .S ^TMP("WV",$J,1,9999999.9999-WVDATE,WVACC,2,WVIEN)=X Q
"RTN","WVPROF2",73,0)
 ;
"RTN","WVPROF2",74,0)
 ;**********************
"RTN","WVPROF2",75,0)
 ;---> GET PAP REGIMENS
"RTN","WVPROF2",76,0)
 S WVIEN=0
"RTN","WVPROF2",77,0)
 F  S WVIEN=$O(^WV(790.04,"C",WVDFN,WVIEN)) Q:'WVIEN  D
"RTN","WVPROF2",78,0)
 .;---> SET Y=THE ZERO NODE FOR THIS PAP REGIMEN LOG ENTRY.
"RTN","WVPROF2",79,0)
 .S Y=^WV(790.04,WVIEN,0)
"RTN","WVPROF2",80,0)
 .;---> PIECE 1=START DATE FOR THE PAP REGIMEN.
"RTN","WVPROF2",81,0)
 .S (WVDATE,WVDATE1)=$P(Y,U)                           ;---> DATE
"RTN","WVPROF2",82,0)
 .;---> QUIT IF NOT WITHIN DATE RANGE.
"RTN","WVPROF2",83,0)
 .;Q:WVDATE'>WVBEGDT1!(WVDATE>WVENDDT1)                ;---> XDATES
"RTN","WVPROF2",84,0)
 .S WVDATE1=$$SLDT2^WVUTL5(WVDATE1)
"RTN","WVPROF2",85,0)
 .S WVPAPRG1=$$PAPRG1^WVUTL1($P(Y,U,3))                ;---> PAP REGIMEN
"RTN","WVPROF2",86,0)
 .;---> FOR PAP REGIMENS, SET 1ST PIECE AND 6TH SUBSCRIPT=3.
"RTN","WVPROF2",87,0)
 .;S X=3_U_WVCHRT_U_WVNAME_U_WVDATE1_U_WVPAPRG1
"RTN","WVPROF2",88,0)
 .S X=3_U_U_U_WVDATE1_U_WVPAPRG1
"RTN","WVPROF2",89,0)
 .S ^TMP("WV",$J,1,9999999.9999-WVDATE,1,3,WVIEN)=X Q
"RTN","WVPROF2",90,0)
 ;
"RTN","WVPROF2",91,0)
 ;**********************
"RTN","WVPROF2",92,0)
 ;---> GET PREGNANCIES
"RTN","WVPROF2",93,0)
 S WVIEN=0
"RTN","WVPROF2",94,0)
 F  S WVIEN=$O(^WV(790.05,"C",WVDFN,WVIEN)) Q:'WVIEN  D
"RTN","WVPROF2",95,0)
 .;---> SET Y=THE ZERO NODE FOR THIS PREGNANCY LOG ENTRY.
"RTN","WVPROF2",96,0)
 .S Y=^WV(790.05,WVIEN,0)
"RTN","WVPROF2",97,0)
 .;---> PIECE 1=DATE PREGNANCY LOG ENTRY WAS MADE.
"RTN","WVPROF2",98,0)
 .S (WVDATE,WVDATE1)=$P(Y,U)                           ;---> DATE
"RTN","WVPROF2",99,0)
 .;---> QUIT IF NOT WITHIN DATE RANGE.
"RTN","WVPROF2",100,0)
 .;Q:WVDATE'>WVBEGDT1!(WVDATE>WVENDDT1)                ;---> XDATES
"RTN","WVPROF2",101,0)
 .S WVDATE1=$$SLDT2^WVUTL5(WVDATE1)
"RTN","WVPROF2",102,0)
 .S WVPSTAT=$S($P(Y,U,3):"PREGNANT",1:"NOT PREGNANT")  ;---> PREG STATUS
"RTN","WVPROF2",103,0)
 .S WVEDCL=$S(X:$$SLDT2^WVUTL5($P(Y,U,4)),1:"")        ;---> EDC
"RTN","WVPROF2",104,0)
 .;---> FOR PREGNANCIES, SET 1ST PIECE AND 6TH SUBSCRIPT=4.
"RTN","WVPROF2",105,0)
 .;S X=4_U_WVCHRT_U_WVNAME_U_WVDATE1_U_WVPSTAT_U_WVEDCL
"RTN","WVPROF2",106,0)
 .S X=4_U_U_U_WVDATE1_U_WVPSTAT_U_WVEDCL
"RTN","WVPROF2",107,0)
 .S ^TMP("WV",$J,1,9999999.9999-WVDATE,1,4,WVIEN)=X Q
"RTN","WVPROF2",108,0)
 Q
"RTN","WVPRPCD")
0^11^B22667860
"RTN","WVPRPCD",1,0)
WVPRPCD ;HCIOFO/FT,JR-WV PRINT A PROCEDURE; ;8/5/99  15:58
"RTN","WVPRPCD",2,0)
 ;;1.0;WOMEN'S HEALTH;**6,7**;Sep 30, 1998
"RTN","WVPRPCD",3,0)
 ;;  Original routine created by IHS/ANMC/MWR
"RTN","WVPRPCD",4,0)
 ;;* MICHAEL REMILLARD, DDS * ALASKA NATIVE MEDICAL CENTER *
"RTN","WVPRPCD",5,0)
 ;;  DISPLAY CODE FOR PRINTING PROCEDURES.  ENTRY POINTS FOR PRINTING
"RTN","WVPRPCD",6,0)
 ;;  INDIVIDUAL PROCEDURES AND ALL NEW PROCEDURES.
"RTN","WVPRPCD",7,0)
 ;
"RTN","WVPRPCD",8,0)
TOP(DA) ;EP
"RTN","WVPRPCD",9,0)
 ;---> PRINT PROCEDURE (NOT CALLED BY ANY OPTION).
"RTN","WVPRPCD",10,0)
 ;---> REQUIRED VARIABLE: DA=IEN OF PROCEDURE IN PROC FILE 790.1.
"RTN","WVPRPCD",11,0)
 ;
"RTN","WVPRPCD",12,0)
 D SETVARS^WVUTL5
"RTN","WVPRPCD",13,0)
 D DEVICE Q:WVPOP
"RTN","WVPRPCD",14,0)
 D START(DA)
"RTN","WVPRPCD",15,0)
 D ^%ZISC
"RTN","WVPRPCD",16,0)
 W @IOF
"RTN","WVPRPCD",17,0)
 Q
"RTN","WVPRPCD",18,0)
 ;
"RTN","WVPRPCD",19,0)
 ;
"RTN","WVPRPCD",20,0)
STARTQ ;EP
"RTN","WVPRPCD",21,0)
 ;---> ENTRY POINT FOR TASKMAN--CANNOT PASS PARAMETERS.
"RTN","WVPRPCD",22,0)
 ;---> REQUIRED VARIABLE: DA=IEN OF PROCEDURE IN PROC FILE 790.1.
"RTN","WVPRPCD",23,0)
 D START(DA)
"RTN","WVPRPCD",24,0)
 Q
"RTN","WVPRPCD",25,0)
 ;
"RTN","WVPRPCD",26,0)
 ;
"RTN","WVPRPCD",27,0)
START(DA) ;EP
"RTN","WVPRPCD",28,0)
 N WVPRMT1,WVTITLE,WVY,N,X
"RTN","WVPRPCD",29,0)
 D SETVARS^WVUTL5
"RTN","WVPRPCD",30,0)
 S WVSL="I $Y+6>IOSL D:WVCRT DIRZ^WVUTL3 Q:WVPOP  D HEADER4^WVUTL7"
"RTN","WVPRPCD",31,0)
 D TOPHEAD^WVUTL7,PCDVARS^WVUTL3(DA)
"RTN","WVPRPCD",32,0)
 ;---> WVCRT=1 IF OUTPUT IS TO SCREEN (SET BY TOPHEAD^WVUTL7).
"RTN","WVPRPCD",33,0)
 S WVTITLE1="* * *  WOMEN'S HEALTH: PROCEDURE PRINTOUT  * * *"
"RTN","WVPRPCD",34,0)
 D CENTERT^WVUTL5(.WVTITLE1)
"RTN","WVPRPCD",35,0)
 S WVPRMT1="   Press RETURN to continue or '^'to exit, or"
"RTN","WVPRPCD",36,0)
 S WVY=^WV(790.1,DA,0),WVDFN=$P(WVY,U,2)
"RTN","WVPRPCD",37,0)
 ;
"RTN","WVPRPCD",38,0)
 U IO
"RTN","WVPRPCD",39,0)
 D HEADER4^WVUTL7 W:'WVCRT !
"RTN","WVPRPCD",40,0)
 W !?5,"Date of Procedure: ",$$TXDT^WVUTL5($P(WVY,U,12))
"RTN","WVPRPCD",41,0)
 W !?4,"Date First Entered: ",$$TXDT^WVUTL5($P(WVY,U,19))
"RTN","WVPRPCD",42,0)
 W ?42,"First Entered By: " S X=$P(WVY,U,18) W $E($$PROV^WVUTL6,1,20)
"RTN","WVPRPCD",43,0)
 W ! W:$P(WVY,U,15)]"" ?43,"Radiology Case#: ",$P(WVY,U,15)
"RTN","WVPRPCD",44,0)
 S X=$P($G(^WV(790.1,DA,2)),U,17) ;lab accession#
"RTN","WVPRPCD",45,0)
 W:X]"" ?44,"Lab Accession#: ",X
"RTN","WVPRPCD",46,0)
 W !?4,"Clinician/Provider: ",WVPROV
"RTN","WVPRPCD",47,0)
 W !?2,"Ward/Clinic/Location: " S X=$P(WVY,U,11) W $$HOSPLC^WVUTL6
"RTN","WVPRPCD",48,0)
 W !?2,"Health Care Facility: " S X=$P(WVY,U,10) W $$INSTTX^WVUTL6(X)
"RTN","WVPRPCD",49,0)
 W !?14,"Comments: "
"RTN","WVPRPCD",50,0)
 ;---> WRITE OUT CLINICAL HISTORY; IF TWO LINES, SPLIT BETWEEN WORDS.
"RTN","WVPRPCD",51,0)
 D
"RTN","WVPRPCD",52,0)
 .Q:'$D(^WV(790.1,DA,3))
"RTN","WVPRPCD",53,0)
 .N L,Y
"RTN","WVPRPCD",54,0)
 .S Y=$P(^WV(790.1,DA,3),U)
"RTN","WVPRPCD",55,0)
 .I $L(Y)<57 W Y,! Q
"RTN","WVPRPCD",56,0)
 .S L=56 I Y[" " F  Q:$E(Y,L)=" "  S L=L-1
"RTN","WVPRPCD",57,0)
 .W $E(Y,1,L),! W:$L(Y)>56 ?24,$E(Y,L+1,109)
"RTN","WVPRPCD",58,0)
 ;
"RTN","WVPRPCD",59,0)
 W !?4,"Complete by (Date): ",$$TXDT^WVUTL5($P(WVY,U,13))
"RTN","WVPRPCD",60,0)
 W !?5,"Results/Diagnosis: ",WVRES
"RTN","WVPRPCD",61,0)
 W !," Sec Results/diagnosis: " W $$DIAG^WVUTL4($P(WVY,U,6))
"RTN","WVPRPCD",62,0)
 W ?57,"HPV: " W:$P(WVY,U,8) "YES"
"RTN","WVPRPCD",63,0)
 W !?16,"Status: " S Y=WVY W $$STATUS^WVUTL4
"RTN","WVPRPCD",64,0)
 ;
"RTN","WVPRPCD",65,0)
 ;---> IF THIS PROCEDURE HAS COLPOSCOPY-TYPE RESULTS, DISPLAY COLP PAGE.
"RTN","WVPRPCD",66,0)
 D:$$COLP^WVUTL4(DA)  Q:WVPOP
"RTN","WVPRPCD",67,0)
 .I WVCRT D DIRZ^WVUTL3 Q:WVPOP  D HEADER4^WVUTL7
"RTN","WVPRPCD",68,0)
 .S WVTITLE="-----  CLINICAL FINDINGS  -----"
"RTN","WVPRPCD",69,0)
 .D CENTERT^WVUTL5(.WVTITLE) W !!,WVTITLE
"RTN","WVPRPCD",70,0)
 .;
"RTN","WVPRPCD",71,0)
 .X WVSL Q:WVPOP  W !?2,"T-Zone Seen Entirely: "
"RTN","WVPRPCD",72,0)
 .W $S($P(WVY,U,21):"YES",$P(WVY,U,21)=0:"NO",1:"")
"RTN","WVPRPCD",73,0)
 .W ?54,"Multifocal: "
"RTN","WVPRPCD",74,0)
 .W $S($P(WVY,U,21):"YES",$P(WVY,U,21)=0:"NO",1:"")
"RTN","WVPRPCD",75,0)
 .;
"RTN","WVPRPCD",76,0)
 .X WVSL Q:WVPOP  W !?2,"Lesion Outside Canal: "
"RTN","WVPRPCD",77,0)
 .W $S($P(WVY,U,22):"YES",$P(WVY,U,22)=0:"NO",1:"")
"RTN","WVPRPCD",78,0)
 .W ?45,"Number of Quadrants: " W $P(WVY,U,24)
"RTN","WVPRPCD",79,0)
 .;
"RTN","WVPRPCD",80,0)
 .X WVSL Q:WVPOP  W !?5,"Satisfactory Exam: "
"RTN","WVPRPCD",81,0)
 .W $S($P(WVY,U,20):"YES",$P(WVY,U,20)=0:"NO",1:"")
"RTN","WVPRPCD",82,0)
 .W ?46,"Quadrant Locations: ",$P($G(^WV(790.1,DA,2)),U,16)
"RTN","WVPRPCD",83,0)
 .X WVSL Q:WVPOP  W !?12,"Impression: "
"RTN","WVPRPCD",84,0)
 .W $$DIAG^WVUTL4($P(WVY,U,29))
"RTN","WVPRPCD",85,0)
 .;
"RTN","WVPRPCD",86,0)
 .X WVSL Q:WVPOP  S WVTITLE="-----  TISSUE PATHOLOGY  -----"
"RTN","WVPRPCD",87,0)
 .D CENTERT^WVUTL5(.WVTITLE) W !!,WVTITLE
"RTN","WVPRPCD",88,0)
 .;
"RTN","WVPRPCD",89,0)
 .X WVSL Q:WVPOP  W !?9,"ECC Dysplasia: "
"RTN","WVPRPCD",90,0)
 .S X=$P(WVY,U,25) W $$ECCDYS^WVUTL6
"RTN","WVPRPCD",91,0)
 .W ?57,"Margins Clear: "
"RTN","WVPRPCD",92,0)
 .W $S($P(WVY,U,27):"YES",$P(WVY,U,27)=0:"NO",1:"") X WVSL Q:WVPOP
"RTN","WVPRPCD",93,0)
 .X WVSL Q:WVPOP  W !?3,"Ectocervical Biopsy: "
"RTN","WVPRPCD",94,0)
 .W $$DIAG^WVUTL4($P(WVY,U,26))
"RTN","WVPRPCD",95,0)
 .W ?57,"Stage: "
"RTN","WVPRPCD",96,0)
 .W $$STAGE^WVUTL4($P(WVY,U,31)) X WVSL Q:WVPOP
"RTN","WVPRPCD",97,0)
 .X WVSL Q:WVPOP  W !?8,"STD Evaluation: "
"RTN","WVPRPCD",98,0)
 .W $$DIAG^WVUTL4($P(WVY,U,28))
"RTN","WVPRPCD",99,0)
 ;
"RTN","WVPRPCD",100,0)
 I WVCRT D DIRZ^WVUTL3 Q:WVPOP  D HEADER4^WVUTL7
"RTN","WVPRPCD",101,0)
 S WVTITLE="-----  NOTES  -----  "
"RTN","WVPRPCD",102,0)
 D CENTERT^WVUTL5(.WVTITLE) W !!,WVTITLE,!
"RTN","WVPRPCD",103,0)
 S WVTITLE="-----  NOTES (continued)  -----"
"RTN","WVPRPCD",104,0)
 D CENTERT^WVUTL5(.WVTITLE) S WVSUBH=WVTITLE
"RTN","WVPRPCD",105,0)
 S N=0
"RTN","WVPRPCD",106,0)
 F  S N=$O(^WV(790.1,DA,1,N)) Q:'N!(WVPOP)  D
"RTN","WVPRPCD",107,0)
 .X WVSL Q:WVPOP
"RTN","WVPRPCD",108,0)
 .W !,^WV(790.1,DA,1,N,0)
"RTN","WVPRPCD",109,0)
 S WVTITLE="-----  End of Procedure Printout  -----"
"RTN","WVPRPCD",110,0)
 D CENTERT^WVUTL5(.WVTITLE) W !!,WVTITLE
"RTN","WVPRPCD",111,0)
 K WVSUBH
"RTN","WVPRPCD",112,0)
 I WVCRT&('$D(IO("S")))&('WVPOP) D DIRZ^WVUTL3 W @IOF
"RTN","WVPRPCD",113,0)
 Q
"RTN","WVPRPCD",114,0)
 ;
"RTN","WVPRPCD",115,0)
DEVICE ;EP
"RTN","WVPRPCD",116,0)
 ;---> GET DEVICE AND POSSIBLY QUEUE TO TASKMAN.
"RTN","WVPRPCD",117,0)
 S ZTRTN="STARTQ^WVPRPCD",ZTSAVE("DA")=""
"RTN","WVPRPCD",118,0)
 D ZIS^WVUTL2(.WVPOP,1)
"RTN","WVPRPCD",119,0)
 Q
"RTN","WVPRPCD",120,0)
 ;
"RTN","WVPRPCD",121,0)
JUSTPRT ;EP
"RTN","WVPRPCD",122,0)
 ;---> CALLED BY OPTION: "WV  PRINT INDIVIDUAL PROCEDURES".
"RTN","WVPRPCD",123,0)
 ;---> JUST PRINT AN INDIVIDUAL PROCEDURE.
"RTN","WVPRPCD",124,0)
 N DA,Y
"RTN","WVPRPCD",125,0)
 F  D  Q:Y<0
"RTN","WVPRPCD",126,0)
 .D TITLE^WVUTL5("PRINT A PROCEDURE")
"RTN","WVPRPCD",127,0)
 .D LKUPPCD^WVPROC(.Y)
"RTN","WVPRPCD",128,0)
 .Q:Y<0
"RTN","WVPRPCD",129,0)
 .D TOP(+Y)
"RTN","WVPRPCD",130,0)
 D EXIT
"RTN","WVPRPCD",131,0)
 Q
"RTN","WVPRPCD",132,0)
 ;
"RTN","WVPRPCD",133,0)
PRTNEW ;EP
"RTN","WVPRPCD",134,0)
 ;---> CALLED BY OPTION: "WV PRINT ALL NEW PROCEDURES".
"RTN","WVPRPCD",135,0)
 ;---> PRINT ALL PROCEDURES WITH A STATUS OF "NEW" (NEW UPLOADED
"RTN","WVPRPCD",136,0)
 ;---> LAB RESULTS).
"RTN","WVPRPCD",137,0)
 D TITLE^WVUTL5("PRINT ALL ""NEW"" PROCEDURES")
"RTN","WVPRPCD",138,0)
 S ZTRTN="DEQUEUE^WVPRPCD"
"RTN","WVPRPCD",139,0)
 D ZIS^WVUTL2(.WVPOP,1)
"RTN","WVPRPCD",140,0)
 Q:WVPOP
"RTN","WVPRPCD",141,0)
 ;
"RTN","WVPRPCD",142,0)
DEQUEUE ;EP
"RTN","WVPRPCD",143,0)
 ;---> FOR TASKMAN QUEUE OF PRINTOUT.
"RTN","WVPRPCD",144,0)
 S N=0
"RTN","WVPRPCD",145,0)
 F  S N=$O(^WV(790.1,"S","n",N)) Q:'N  D
"RTN","WVPRPCD",146,0)
 .D START(N)
"RTN","WVPRPCD",147,0)
 D ^%ZISC,EXIT
"RTN","WVPRPCD",148,0)
 Q
"RTN","WVPRPCD",149,0)
 ;
"RTN","WVPRPCD",150,0)
EXIT ;EP
"RTN","WVPRPCD",151,0)
 D KILLALL^WVUTL8
"RTN","WVPRPCD",152,0)
 Q
"RTN","WVRADWP")
0^9^B25478768
"RTN","WVRADWP",1,0)
WVRADWP ;HCIOFO/FT-Display Report Data from Related Packages  ;8/3/99  15:56
"RTN","WVRADWP",2,0)
 ;;1.0;WOMEN'S HEALTH;**4,5,7**;Sep 30, 1998
"RTN","WVRADWP",3,0)
 ;
"RTN","WVRADWP",4,0)
EN ; Determine which report to show (i.e., radiology/nuclear medicine)
"RTN","WVRADWP",5,0)
 ; Called from Edit a Procedure option screen form.
"RTN","WVRADWP",6,0)
 D EX
"RTN","WVRADWP",7,0)
 Q:'$G(DA)
"RTN","WVRADWP",8,0)
 Q:'$D(^WV(790.1,+DA,0))
"RTN","WVRADWP",9,0)
 N WV7901
"RTN","WVRADWP",10,0)
 S WV7901=$E(^WV(790.1,+DA,0),1,2) ;first 2 characters of accession code
"RTN","WVRADWP",11,0)
 Q:WV7901=""
"RTN","WVRADWP",12,0)
 I "^BU^MB^MS^MU^PU^VU^"[WV7901 D EN1 Q  ;show rad/nm report data
"RTN","WVRADWP",13,0)
 Q
"RTN","WVRADWP",14,0)
EN1 ; Set up radiology report data and call FM Browser
"RTN","WVRADWP",15,0)
 N LOOP,WVLCNT,WVRADCSE,WVRADDFN,WVRADDTE,WVRADIEN,WVRPTIEN
"RTN","WVRADWP",16,0)
 S WVRADIEN=$P(^WV(790.1,DA,0),U,15)
"RTN","WVRADWP",17,0)
 Q:WVRADIEN=""  ;no 'radiology mam case #'
"RTN","WVRADWP",18,0)
 S WVRADDFN=$P(^WV(790.1,DA,0),U,2)
"RTN","WVRADWP",19,0)
 Q:'WVRADDFN  ;no dfn
"RTN","WVRADWP",20,0)
 S WVRADDTE=$O(^RADPT("ADC",WVRADIEN,WVRADDFN,0))
"RTN","WVRADWP",21,0)
 Q:'WVRADDTE  ;no inverse exam date
"RTN","WVRADWP",22,0)
 S WVRADCSE=$O(^RADPT("ADC",WVRADIEN,WVRADDFN,WVRADDTE,0))
"RTN","WVRADWP",23,0)
 Q:'WVRADCSE  ;no case number
"RTN","WVRADWP",24,0)
 S WVRPTIEN=+$P(^RADPT(WVRADDFN,"DT",WVRADDTE,"P",WVRADCSE,0),U,17)
"RTN","WVRADWP",25,0)
 Q:'WVRPTIEN  ;no report in File 74
"RTN","WVRADWP",26,0)
 K ^TMP($J,"WV RADRPT"),^TMP("WV RADRPT",$J)
"RTN","WVRADWP",27,0)
 D GETS^DIQ(74,WVRPTIEN_",","*","EI","^TMP($J,""WV RADRPT"")")
"RTN","WVRADWP",28,0)
 S ^TMP("WV RADRPT",$J,1,0)="                   DAY-CASE #: "_$G(^TMP($J,"WV RADRPT",74,WVRPTIEN_",",.01,"E"))_$S($$AMEND(WVRPTIEN):"                    (AMENDED REPORT)",1:"")
"RTN","WVRADWP",29,0)
 S ^TMP("WV RADRPT",$J,2,0)="               EXAM DATE/TIME: "_^TMP($J,"WV RADRPT",74,WVRPTIEN_",",3,"E")
"RTN","WVRADWP",30,0)
 S ^TMP("WV RADRPT",$J,3,0)="          VERIFYING PHYSICIAN: "_^TMP($J,"WV RADRPT",74,WVRPTIEN_",",9,"E")
"RTN","WVRADWP",31,0)
 S ^TMP("WV RADRPT",$J,4,0)="                    PROCEDURE: "_^TMP($J,"WV RADRPT",74,WVRPTIEN_",",102,"E")
"RTN","WVRADWP",32,0)
 S ^TMP("WV RADRPT",$J,5,0)="             CATEGORY OF EXAM: "_^TMP($J,"WV RADRPT",74,WVRPTIEN_",",104,"E")
"RTN","WVRADWP",33,0)
 S ^TMP("WV RADRPT",$J,6,0)="                         WARD: "_^TMP($J,"WV RADRPT",74,WVRPTIEN_",",106,"E")
"RTN","WVRADWP",34,0)
 S ^TMP("WV RADRPT",$J,7,0)=" TREATING SERVICE (INPATIENT): "_^TMP($J,"WV RADRPT",74,WVRPTIEN_",",107,"E")
"RTN","WVRADWP",35,0)
 S ^TMP("WV RADRPT",$J,8,0)="             PRINCIPAL CLINIC: "_^TMP($J,"WV RADRPT",74,WVRPTIEN_",",108,"E")
"RTN","WVRADWP",36,0)
 S ^TMP("WV RADRPT",$J,9,0)="      CONTRACT SHARING SOURCE: "_^TMP($J,"WV RADRPT",74,WVRPTIEN_",",109,"E")
"RTN","WVRADWP",37,0)
 S ^TMP("WV RADRPT",$J,10,0)="PRIMARY INTERPRETING RESIDENT: "_^TMP($J,"WV RADRPT",74,WVRPTIEN_",",112,"E")
"RTN","WVRADWP",38,0)
 S ^TMP("WV RADRPT",$J,11,0)="   PRIMARY INTERPRETING STAFF: "_^TMP($J,"WV RADRPT",74,WVRPTIEN_",",115,"E")
"RTN","WVRADWP",39,0)
 S ^TMP("WV RADRPT",$J,12,0)="            PRIMARY DIAGNOSIS: "_^TMP($J,"WV RADRPT",74,WVRPTIEN_",",113,"E")
"RTN","WVRADWP",40,0)
 S ^TMP("WV RADRPT",$J,13,0)="         REQUESTING PHYSICIAN: "_^TMP($J,"WV RADRPT",74,WVRPTIEN_",",114,"E")
"RTN","WVRADWP",41,0)
 S ^TMP("WV RADRPT",$J,14,0)="                 COMPLICATION: "_^TMP($J,"WV RADRPT",74,WVRPTIEN_",",116,"E")
"RTN","WVRADWP",42,0)
 S ^TMP("WV RADRPT",$J,15,0)=" "
"RTN","WVRADWP",43,0)
 S ^TMP("WV RADRPT",$J,16,0)="CLINICAL HISTORY:"
"RTN","WVRADWP",44,0)
 S LOOP=0,WVLCNT=16
"RTN","WVRADWP",45,0)
 F  S LOOP=$O(^TMP($J,"WV RADRPT",74,WVRPTIEN_",",400,LOOP)) Q:'LOOP  D
"RTN","WVRADWP",46,0)
 .S WVLCNT=WVLCNT+1
"RTN","WVRADWP",47,0)
 .S ^TMP("WV RADRPT",$J,WVLCNT,0)=^TMP($J,"WV RADRPT",74,WVRPTIEN_",",400,LOOP)
"RTN","WVRADWP",48,0)
 .Q
"RTN","WVRADWP",49,0)
 S WVLCNT=WVLCNT+1
"RTN","WVRADWP",50,0)
 S ^TMP("WV RADRPT",$J,WVLCNT,0)=" "
"RTN","WVRADWP",51,0)
 S WVLCNT=WVLCNT+1
"RTN","WVRADWP",52,0)
 S ^TMP("WV RADRPT",$J,WVLCNT,0)="IMPRESSION TEXT:"
"RTN","WVRADWP",53,0)
 S LOOP=0
"RTN","WVRADWP",54,0)
 F  S LOOP=$O(^TMP($J,"WV RADRPT",74,WVRPTIEN_",",300,LOOP)) Q:'LOOP  D
"RTN","WVRADWP",55,0)
 .S WVLCNT=WVLCNT+1
"RTN","WVRADWP",56,0)
 .S ^TMP("WV RADRPT",$J,WVLCNT,0)=^TMP($J,"WV RADRPT",74,WVRPTIEN_",",300,LOOP)
"RTN","WVRADWP",57,0)
 .Q
"RTN","WVRADWP",58,0)
 S WVLCNT=WVLCNT+1
"RTN","WVRADWP",59,0)
 S ^TMP("WV RADRPT",$J,WVLCNT,0)=" "
"RTN","WVRADWP",60,0)
 S WVLCNT=WVLCNT+1
"RTN","WVRADWP",61,0)
 S ^TMP("WV RADRPT",$J,WVLCNT,0)="REPORT TEXT:"
"RTN","WVRADWP",62,0)
 S LOOP=0
"RTN","WVRADWP",63,0)
 F  S LOOP=$O(^TMP($J,"WV RADRPT",74,WVRPTIEN_",",200,LOOP)) Q:'LOOP  D
"RTN","WVRADWP",64,0)
 .S WVLCNT=WVLCNT+1
"RTN","WVRADWP",65,0)
 .S ^TMP("WV RADRPT",$J,WVLCNT,0)=^TMP($J,"WV RADRPT",74,WVRPTIEN_",",200,LOOP)
"RTN","WVRADWP",66,0)
 .Q
"RTN","WVRADWP",67,0)
 K ^TMP($J,"WV RADRPT"),WVLCNT,^WV(790.1,DA,9)
"RTN","WVRADWP",68,0)
 S WVJCN=0 F  S WVJCN=$O(^TMP("WV RADRPT",$J,WVJCN)) Q:WVJCN'>0  D
"RTN","WVRADWP",69,0)
 .S ^WV(790.1,DA,9,WVJCN,0)=$G(^TMP("WV RADRPT",$J,WVJCN,0)) S WVJCN1=WVJCN
"RTN","WVRADWP",70,0)
 S ^WV(790.1,DA,9,0)="^^"_WVJCN1_"^"_WVJCN1
"RTN","WVRADWP",71,0)
 K ^TMP("WV RADRPT",$J)
"RTN","WVRADWP",72,0)
 Q
"RTN","WVRADWP",73,0)
EX ; delete existing radiology report text stored in WH
"RTN","WVRADWP",74,0)
 K ^WV(790.1,DA,9)
"RTN","WVRADWP",75,0)
 Q
"RTN","WVRADWP",76,0)
MAIL(DFN,WVACCESS,WVPROC,WVPROV) ; Send mail message to case manager when
"RTN","WVRADWP",77,0)
 ; Radiology procedure is added to WH Procedure file (#790.1).
"RTN","WVRADWP",78,0)
 ; Called from WVRALINK
"RTN","WVRADWP",79,0)
 ;      DFN -> Patient ien
"RTN","WVRADWP",80,0)
 ; WVACCESS -> File 790.1 ien (procedure entry)
"RTN","WVRADWP",81,0)
 ;   WVPROC -> File 790.2 ien (procedure type)
"RTN","WVRADWP",82,0)
 ;   WVPROV -> File 200   IEN (provider/requestor)
"RTN","WVRADWP",83,0)
 Q:'$G(DFN)!('$G(WVACCESS))!('$G(WVPROC))
"RTN","WVRADWP",84,0)
 N WVCMGR,WVLOOP,WVMSG,XMDUZ,XMSUB,XMTEXT
"RTN","WVRADWP",85,0)
 S WVCMGR=+$$GET1^DIQ(790,DFN,.1,"I") ;get case manager
"RTN","WVRADWP",86,0)
 S:WVCMGR XMY(WVCMGR)=""
"RTN","WVRADWP",87,0)
 ; if no case manager, then get default case manager(s)
"RTN","WVRADWP",88,0)
 I 'WVCMGR S WVLOOP=0 F  S WVLOOP=$O(^WV(790.02,WVLOOP)) Q:'WVLOOP  D
"RTN","WVRADWP",89,0)
 .S WVCMGR=$$GET1^DIQ(790.02,WVLOOP,.02,"I")
"RTN","WVRADWP",90,0)
 .S:WVCMGR XMY(WVCMGR)=""
"RTN","WVRADWP",91,0)
 .Q
"RTN","WVRADWP",92,0)
 Q:$O(XMY(0))'>0  ;no case manager(s)
"RTN","WVRADWP",93,0)
 ;S:WVPROV XMY(WVPROV)=""
"RTN","WVRADWP",94,0)
 S XMDUZ=.5 ;message sender
"RTN","WVRADWP",95,0)
 S XMSUB="RAD/NM added a procedure for a WH patient"
"RTN","WVRADWP",96,0)
 S WVMSG(1)="        Patient: "_$P($G(^DPT(DFN,0)),U,1)_" (SSN: "_$$SSN^WVUTL1(DFN)_")"
"RTN","WVRADWP",97,0)
 S WVMSG(2)=" WH Accession #: "_$P($G(^WV(790.1,+WVACCESS,0)),U,1)
"RTN","WVRADWP",98,0)
 S WVMSG(3)="      Procedure: "_$P($G(^WV(790.2,+WVPROC,0)),U,1)
"RTN","WVRADWP",99,0)
 S WVMSG(4)=" "
"RTN","WVRADWP",100,0)
 S WVMSG(5)="Please use the 'Edit a Procedure' option in the WOMEN'S"
"RTN","WVRADWP",101,0)
 S WVMSG(6)="HEALTH package to complete/close this procedure."
"RTN","WVRADWP",102,0)
 S XMTEXT="WVMSG("
"RTN","WVRADWP",103,0)
 D ^XMD
"RTN","WVRADWP",104,0)
 Q
"RTN","WVRADWP",105,0)
AMEND(WVRPTIEN) ; Check if RAD/NM report is amended.
"RTN","WVRADWP",106,0)
 ; WVRPTIEN - File 74 ien
"RTN","WVRADWP",107,0)
 N WVAMEND
"RTN","WVRADWP",108,0)
 K ^TMP("DILIST",$J),^TMP("DIERR",$J)
"RTN","WVRADWP",109,0)
 D LIST^DIC(74.06,","_WVRPTIEN_",",.01)
"RTN","WVRADWP",110,0)
 S WVAMEND=$O(^TMP("DILIST",$J,0))
"RTN","WVRADWP",111,0)
 K ^TMP("DILIST",$J),^TMP("DIERR",$J)
"RTN","WVRADWP",112,0)
 Q WVAMEND
"RTN","WVRALINK")
0^17^B42806410
"RTN","WVRALINK",1,0)
WVRALINK ;HCIOFO/FT-RAD/NM-WOMEN'S HEALTH LINK  ;9/8/99  13:58
"RTN","WVRALINK",2,0)
 ;;1.0;WOMEN'S HEALTH;**3,5,7**;Sep 30, 1998
"RTN","WVRALINK",3,0)
 ;;  Original routine created by IHS/ANMC/MWR
"RTN","WVRALINK",4,0)
 ;;* MICHAEL REMILLARD, DDS * ALASKA NATIVE MEDICAL CENTER *
"RTN","WVRALINK",5,0)
 ;;  CREATE MAMMOGRAM PROCEDURE IN WOMEN'S HEALTH FOR THIS PATIENT.
"RTN","WVRALINK",6,0)
 ;;  CALLED BY ^RART WHEN A RADIOLOGY REPORT IS VERIFIED.
"RTN","WVRALINK",7,0)
 ;;  CALLED BY ^RARTE1 WHEN A RADIOLOGY REPORT IS UNVERIFIED.
"RTN","WVRALINK",8,0)
 ;;  CALLED BY ^WVEXPTRA WHEN EXPORTING HISTORICAL MAMS TO WOMEN'S HEALTH
"RTN","WVRALINK",9,0)
 ;
"RTN","WVRALINK",10,0)
 ;---> REQUIRED VARIABLES: DFN  = DFN OF RADIOLOGY PATIENT.
"RTN","WVRALINK",11,0)
 ;--->                     DATE = INVERSE DATE/TIME OF VISIT.
"RTN","WVRALINK",12,0)
 ;--->                     CASE = IEN OF RADIOLOGY EXAM (CASE).
"RTN","WVRALINK",13,0)
 ;
"RTN","WVRALINK",14,0)
 ;---> OPTIONAL VARIABLE:  WVNEWP = TOTAL NEW WH PATIENTS ADDED.
"RTN","WVRALINK",15,0)
 ;--->                     WVMCNT = TOTAL NEW MAMS PROCEDURES ADDED.
"RTN","WVRALINK",16,0)
 ;--->                     THESE IF CALLED FROM ^WVEXPTRA ROUTINE.
"RTN","WVRALINK",17,0)
 ;
"RTN","WVRALINK",18,0)
 ;---> GENERATED VARIBLES:
"RTN","WVRALINK",19,0)
 ;---> WVPROC = IEN OF RADIOLOGY PROCEDURE (FILE #71), THEN IT
"RTN","WVRALINK",20,0)
 ;--->          GETS CHANGED TO WOMEN'S HEALTH PROCEDURE TYPE
"RTN","WVRALINK",21,0)
 ;--->                                   (FILE #790.2).
"RTN","WVRALINK",22,0)
 ;---> WVLOC  = WARD/CLINIC/LOCATION (FILE #44).
"RTN","WVRALINK",23,0)
 ;---> WVDATE = DATE OF THE PROCEDURE.
"RTN","WVRALINK",24,0)
 ;---> WVPROV = ORDERING PROVIDER.
"RTN","WVRALINK",25,0)
 ;---> WVMOD  = LEFT OR RIGHT, IF IT'S A UNILATERAL MAMMOGRAM.
"RTN","WVRALINK",26,0)
 ;---> WVDX   = RADIOLOGY DIAGNOSTIC CODE.
"RTN","WVRALINK",27,0)
 ;---> WVBWDX = WOMEN'S HEALTH RESULT/DIAGNOSIS.
"RTN","WVRALINK",28,0)
 ;
"RTN","WVRALINK",29,0)
CREATE(DFN,DATE,CASE) ;
"RTN","WVRALINK",30,0)
 Q:'+$$VERSION^XPDUTL("WV")
"RTN","WVRALINK",31,0)
 Q:($G(DFN)']"")!($G(DATE)']"")!($G(CASE)']"")
"RTN","WVRALINK",32,0)
 N ZTDESC,ZTDTH,ZTIO,ZTRTN,ZTSAVE
"RTN","WVRALINK",33,0)
 S ZTRTN="CREATEQ^WVRALINK",ZTDESC="WV CREATE MAMMOGRAM ENTRY"
"RTN","WVRALINK",34,0)
 S ZTSAVE("DFN")="",ZTSAVE("DATE")="",ZTSAVE("CASE")=""
"RTN","WVRALINK",35,0)
 S ZTIO="",ZTDTH=$H
"RTN","WVRALINK",36,0)
 D ^%ZTLOAD
"RTN","WVRALINK",37,0)
 Q
"RTN","WVRALINK",38,0)
CREATEH(DFN,DATE,CASE,STATUS) ; Entry from ^WVEXPTRA which looks for exams
"RTN","WVRALINK",39,0)
 ; created before the WH package was installed.
"RTN","WVRALINK",40,0)
 Q:($G(DFN)']"")!($G(DATE)']"")!($G(CASE)']"")!($G(STATUS)']"")
"RTN","WVRALINK",41,0)
 ; 
"RTN","WVRALINK",42,0)
CREATEQ ; Queue data entry creation. Called from CREATE above
"RTN","WVRALINK",43,0)
 N WVPROC,WVLOC,WVDATE,WVPROV,WVMOD,WVDX,WVBWDX,WVLEFT,WVRIGHT
"RTN","WVRALINK",44,0)
 N WVCASE,WVCPT,WVERR,WVCREDIT ;,WVEXAM0
"RTN","WVRALINK",45,0)
 ;---> QUIT IF RADIOLOGY DATA IS NOT DEFINED OR ="".
"RTN","WVRALINK",46,0)
 Q:'$D(^RADPT(DFN,"DT",DATE,"P",CASE,0))
"RTN","WVRALINK",47,0)
 ;
"RTN","WVRALINK",48,0)
 ;---> QUIT IF THIS PROCEDURE DOES NOT HAVE A MAM CPT CODE.
"RTN","WVRALINK",49,0)
 ;---> QUIT IF THIS PROCEDURE DOES NOT HAVE AN ULTRASOUND CPT CODE.
"RTN","WVRALINK",50,0)
 ;---> WVEXAM0=ZERO NODE OF RADIOLOGY EXAM.
"RTN","WVRALINK",51,0)
 S WVEXAM0=^RADPT(DFN,"DT",DATE,"P",CASE,0)
"RTN","WVRALINK",52,0)
 S WVCPT=$P(^RAMIS(71,$P(WVEXAM0,U,2),0),U,9)
"RTN","WVRALINK",53,0)
 S WVPROC=$O(^WV(790.2,"AC",WVCPT,0)) ;cpt code x-ref to get 790.2 ien
"RTN","WVRALINK",54,0)
 Q:'WVPROC  ;cpt code is not tracked in 790.2
"RTN","WVRALINK",55,0)
 Q:$P($G(^WV(790.2,+WVPROC,0)),U,5)'="R"  ;cpt is not rad/nm procedure
"RTN","WVRALINK",56,0)
 Q:$P($G(^DPT(DFN,0)),U,2)'="F"  ;not female
"RTN","WVRALINK",57,0)
 ;
"RTN","WVRALINK",58,0)
 ;---> QUIT IF NO WOMEN'S HEALTH SITE PARAMETER FILE ON THIS MACHINE.
"RTN","WVRALINK",59,0)
 ;     OR NO DEFAULT CASE MANAGER
"RTN","WVRALINK",60,0)
 Q:'$D(^WV(790.02,DUZ(2)))
"RTN","WVRALINK",61,0)
 Q:'$P($G(^WV(790.02,+$G(DUZ(2)),0)),U,2)
"RTN","WVRALINK",62,0)
 ;
"RTN","WVRALINK",63,0)
 ;---> IF NOT CALLED FROM ^WVEXPTRA (i.e., STATUS is undefined) CHECK
"RTN","WVRALINK",64,0)
 ;---> SITE PARAMETER AND QUIT IF "IMPORT MAMMOGRAMS FROM RADIOLOGY"
"RTN","WVRALINK",65,0)
 ;---> IS NOT SET TO "YES".
"RTN","WVRALINK",66,0)
 N Y S Y=^WV(790.02,DUZ(2),0)
"RTN","WVRALINK",67,0)
 I '$D(STATUS) Q:'$P(Y,U,10)
"RTN","WVRALINK",68,0)
 ;
"RTN","WVRALINK",69,0)
 ;---> SET WVZSTAT =THE STATUS (OPEN OR CLOSED) IN WOMEN'S HEALTH.
"RTN","WVRALINK",70,0)
 ;---> THAT MAMMOGRAMS SHOULD RECEIVE WHEN COPIED OVER FROM RADIOLOGY.
"RTN","WVRALINK",71,0)
 S WVZSTAT=$P(Y,U,23) S:WVZSTAT="" WVZSTAT="o"
"RTN","WVRALINK",72,0)
 I $G(STATUS)]"" S WVZSTAT=$G(STATUS) ;status selected in ^WVEXPTRA
"RTN","WVRALINK",73,0)
 ;
"RTN","WVRALINK",74,0)
 D COPY(WVEXAM0)
"RTN","WVRALINK",75,0)
 ;
"RTN","WVRALINK",76,0)
EXIT ;EP
"RTN","WVRALINK",77,0)
 K I,N,X
"RTN","WVRALINK",78,0)
 I $D(ZTQUEUED) S ZTREQ="@"
"RTN","WVRALINK",79,0)
 Q
"RTN","WVRALINK",80,0)
 ;
"RTN","WVRALINK",81,0)
COPY(Y) ;EP
"RTN","WVRALINK",82,0)
 ;---> COPY MAM PROCEDURE DATA FROM RADIOLOGY TO WOMEN'S HEALTH.
"RTN","WVRALINK",83,0)
 ;---> VARIABLE DFN=PATIENT
"RTN","WVRALINK",84,0)
 ;---> LOCATION=DUZ(2)
"RTN","WVRALINK",85,0)
 ;---> WARD/CLINIC/LOCATION
"RTN","WVRALINK",86,0)
 N X
"RTN","WVRALINK",87,0)
 S WVLOC=$P(Y,U,8)
"RTN","WVRALINK",88,0)
 ;
"RTN","WVRALINK",89,0)
 ;---> WVDATE=DATE OF THE PROCEDURE.
"RTN","WVRALINK",90,0)
 S WVDATE=$P($P(^RADPT(DFN,"DT",DATE,0),U),".")
"RTN","WVRALINK",91,0)
 ;
"RTN","WVRALINK",92,0)
 ;---> RECONSTRUCT THE FULL CASE# FOR THIS RAD PROCEDURE.
"RTN","WVRALINK",93,0)
 ;---> THIS IS USED AS A LINK (XREF) BETWEEN THE RADIOLOGY PROCEDURE
"RTN","WVRALINK",94,0)
 ;---> AND THE WOMEN'S HEALTH PROCEDURE.
"RTN","WVRALINK",95,0)
 S WVCASE=$E(WVDATE,4,7)_$E(WVDATE,2,3)_"-"_$P(Y,U)
"RTN","WVRALINK",96,0)
 ;---> CHECK TO BE SURE THE CASE# XREF IS REALLY DOWN THERE.
"RTN","WVRALINK",97,0)
 S:'$D(^RADPT("ADC",WVCASE,DFN,DATE,CASE)) WVCASE="UNKNOWN"
"RTN","WVRALINK",98,0)
 ;
"RTN","WVRALINK",99,0)
 ;---> QUIT IF THIS PROCEDURE HAS ALREADY BEEN SENT TO WOMEN'S HEALTH.
"RTN","WVRALINK",100,0)
 Q:$D(^WV(790.1,"E",WVCASE))
"RTN","WVRALINK",101,0)
 ;
"RTN","WVRALINK",102,0)
 ;---> REQUESTING PROVIDER/ORDERING PROVIDER
"RTN","WVRALINK",103,0)
 S WVPROV=$P(Y,U,14)
"RTN","WVRALINK",104,0)
 ;
"RTN","WVRALINK",105,0)
 ;---> IF UNILATERAL, ATTEMPT TO PICK UP LEFT OR RIGHT MODIFIER.
"RTN","WVRALINK",106,0)
 I WVPROC=26 D
"RTN","WVRALINK",107,0)
 .I $D(^RADPT(DFN,"DT",DATE,"P",CASE,"M",0)) D
"RTN","WVRALINK",108,0)
 ..N N S N=0
"RTN","WVRALINK",109,0)
 ..F  S N=$O(^RADPT(DFN,"DT",DATE,"P",CASE,"M",N)) Q:'N  D
"RTN","WVRALINK",110,0)
 ...S WVMOD=$P(^RADPT(DFN,"DT",DATE,"P",CASE,"M",N,0),U)
"RTN","WVRALINK",111,0)
 ...S WVMOD=$P(^RAMIS(71.2,WVMOD,0),U)
"RTN","WVRALINK",112,0)
 ...I "LEFTleft"[WVMOD S WVLEFT=1
"RTN","WVRALINK",113,0)
 ...I "RIGHTright"[WVMOD S WVRIGHT=1
"RTN","WVRALINK",114,0)
 ..Q:$D(WVLEFT)&($D(WVRIGHT))
"RTN","WVRALINK",115,0)
 ..I $D(WVLEFT) S WVMOD="l" Q
"RTN","WVRALINK",116,0)
 ..I $D(WVRIGHT) S WVMOD="r" Q
"RTN","WVRALINK",117,0)
 ;
"RTN","WVRALINK",118,0)
 ;---> IF THERE'S A DIAGNOSTIC CODE, ATTEMPT TO PICK UP DIAGNOSIS.
"RTN","WVRALINK",119,0)
 ;---> USE "WV DIAGNOSTIC CODE TRANSLATION" FILE #790.32.
"RTN","WVRALINK",120,0)
 S WVDX=$P(Y,U,13)
"RTN","WVRALINK",121,0)
 I +WVDX I $D(^WV(790.32,"C",WVDX)) S WVBWDX=$O(^WV(790.32,"C",WVDX,0))
"RTN","WVRALINK",122,0)
 ;
"RTN","WVRALINK",123,0)
 ;---> GET CREDIT METHOD.
"RTN","WVRALINK",124,0)
 S WVCREDIT=$P(Y,U,26)
"RTN","WVRALINK",125,0)
 ;
"RTN","WVRALINK",126,0)
PATIENT ;---> IF PATIENT ISN'T IN WOMEN'S HEALTH DATABASE, ADD HER.
"RTN","WVRALINK",127,0)
 S WVERR=1
"RTN","WVRALINK",128,0)
 I '$D(^WV(790,DFN,0)) D
"RTN","WVRALINK",129,0)
 .D AUTOADD^WVPATE(DFN,DUZ(2),.WVERR)
"RTN","WVRALINK",130,0)
 .I $D(WVNEWP) S:WVERR WVNEWP=WVNEWP+1
"RTN","WVRALINK",131,0)
 Q:WVERR<0
"RTN","WVRALINK",132,0)
 D FIND^WVRALIN1 ;check for 'unlinked' entry in File 790.1
"RTN","WVRALINK",133,0)
 Q:$D(^WV(790.1,"E",WVCASE))  ;quit if link was made in WVRALIN1
"RTN","WVRALINK",134,0)
PROC ;---> CREATE MAMMOGRAM PROCEDURE IN WV PROCEDURE FILE #790.1.
"RTN","WVRALINK",135,0)
 S WVDR=".02////"_DFN_";.04////"_WVPROC
"RTN","WVRALINK",136,0)
 S WVDR=WVDR_";.05////"_$G(WVBWDX)_";.07////"_WVPROV
"RTN","WVRALINK",137,0)
 S WVDR=WVDR_";.09////"_$G(WVMOD)_";.1////"_DUZ(2)_";.11////"_WVLOC
"RTN","WVRALINK",138,0)
 S WVDR=WVDR_";.12////"_WVDATE_";.14////"_WVZSTAT_";.15////"_WVCASE
"RTN","WVRALINK",139,0)
 S WVDR=WVDR_";.18////.5;.19////"_DT_";.34////"_$G(DUZ(2))_";.35////"_WVCREDIT
"RTN","WVRALINK",140,0)
 ;
"RTN","WVRALINK",141,0)
 D NEW2^WVPROC(DFN,WVPROC,WVDATE,WVDR,"","",.WVERR)
"RTN","WVRALINK",142,0)
 I $D(WVMCNT) S:WVERR>-1 WVMCNT=WVMCNT+1
"RTN","WVRALINK",143,0)
 Q:WVERR<0  ;procedure not added
"RTN","WVRALINK",144,0)
 Q:$D(WVMCNT)  ;mass import of Rad/NM exams
"RTN","WVRALINK",145,0)
 ;Q:$P($G(^WV(790.02,+DUZ(2),0)),U,23)="c"  ;Status=closed
"RTN","WVRALINK",146,0)
 D MAIL^WVRADWP(DFN,+Y,WVPROC,WVPROV) ;iens for patient, accession, procedure, provider/requestor
"RTN","WVRALINK",147,0)
 Q
"RTN","WVRALINK",148,0)
 ;
"RTN","WVRALINK",149,0)
 ;
"RTN","WVRALINK",150,0)
DELETE(DFN,DATE,CASE) ;EP
"RTN","WVRALINK",151,0)
 ;---> MODIFY WOMEN'S HEALTH PROCEDURE TO REFLECT CHANGE.
"RTN","WVRALINK",152,0)
 ;---> CALLED FROM RARTE1 (DELETE A REPORT AND UNVERIFY A REPORT).
"RTN","WVRALINK",153,0)
 ;
"RTN","WVRALINK",154,0)
 Q:'+$$VERSION^XPDUTL("WV")
"RTN","WVRALINK",155,0)
 Q:'$D(DFN)!('$D(DATE))!('$D(CASE))
"RTN","WVRALINK",156,0)
 N ZTDESC,ZTDTH,ZTIO,ZTRTN,ZTSAVE
"RTN","WVRALINK",157,0)
 S ZTRTN="DELETEQ^WVRALINK",ZTDESC="WV MAMMOGRAM RPT CHANGE"
"RTN","WVRALINK",158,0)
 S ZTSAVE("DFN")="",ZTSAVE("DATE")="",ZTSAVE("CASE")=""
"RTN","WVRALINK",159,0)
 S ZTIO="",ZTDTH=$H
"RTN","WVRALINK",160,0)
 D ^%ZTLOAD
"RTN","WVRALINK",161,0)
 Q
"RTN","WVRALINK",162,0)
DELETEQ ; Modify WV entry when mammogram report is unverified or deleted
"RTN","WVRALINK",163,0)
 Q:'$D(^RADPT(DFN,"DT",DATE,"P",CASE,0))
"RTN","WVRALINK",164,0)
 N WVIEN,WVDATE,WVCASE,WVCMGR,WVLOOP,WVMSG,WVPROV
"RTN","WVRALINK",165,0)
 N XMDUZ,XMSUB,XMTEXT,XMY ;send mail message to case manager
"RTN","WVRALINK",166,0)
 ;
"RTN","WVRALINK",167,0)
 ;---> WVDATE=DATE OF PROCEDURE.
"RTN","WVRALINK",168,0)
 S WVDATE=$P($P(^RADPT(DFN,"DT",DATE,0),U),".")
"RTN","WVRALINK",169,0)
 S WVCASE=$P(^RADPT(DFN,"DT",DATE,"P",CASE,0),U)
"RTN","WVRALINK",170,0)
 ;
"RTN","WVRALINK",171,0)
 ;---> WVCASE=RECONSTRUCTED CASE# OF PROCEDURE.
"RTN","WVRALINK",172,0)
 S WVCASE=$E(WVDATE,4,7)_$E(WVDATE,2,3)_"-"_WVCASE
"RTN","WVRALINK",173,0)
 ;---> QUIT IF NO CASE# XREF IN WOMEN'S HEALTH PROCEDURE FILE.
"RTN","WVRALINK",174,0)
 Q:'$D(^WV(790.1,"E",WVCASE))
"RTN","WVRALINK",175,0)
 ;
"RTN","WVRALINK",176,0)
 S WVIEN=$O(^WV(790.1,"E",WVCASE,0))
"RTN","WVRALINK",177,0)
 Q:'$D(^WV(790.1,WVIEN,0))
"RTN","WVRALINK",178,0)
 D RADMOD^WVPROC(WVIEN) ;update wh status to "open"
"RTN","WVRALINK",179,0)
 S WVPROV=+$$GET1^DIQ(790.1,WVIEN,.07,"I") ;get provider/requestor
"RTN","WVRALINK",180,0)
 S WVCMGR=+$$GET1^DIQ(790,DFN,.1,"I") ;get case manager
"RTN","WVRALINK",181,0)
 S:WVCMGR XMY(WVCMGR)=""
"RTN","WVRALINK",182,0)
 ; if no case manager, then get default case manager(s)
"RTN","WVRALINK",183,0)
 I 'WVCMGR S WVLOOP=0 F  S WVLOOP=$O(^WV(790.02,WVLOOP)) Q:'WVLOOP  D
"RTN","WVRALINK",184,0)
 .S WVCMGR=$$GET1^DIQ(790.02,WVLOOP,.02,"I")
"RTN","WVRALINK",185,0)
 .S:WVCMGR XMY(WVCMGR)=""
"RTN","WVRALINK",186,0)
 .Q
"RTN","WVRALINK",187,0)
 Q:$O(XMY(0))'>0  ;no case manager(s)
"RTN","WVRALINK",188,0)
 S:WVPROV XMY(WVPROV)=""
"RTN","WVRALINK",189,0)
 S XMDUZ=.5 ;message sender
"RTN","WVRALINK",190,0)
 S XMSUB="RAD/NM Rpt for WH patient is UNVERIFIED/DELETED"
"RTN","WVRALINK",191,0)
 S WVMSG(1)="        Patient: "_$P($G(^DPT(DFN,0)),U,1)_" (SSN: "_$$SSN^WVUTL1(DFN)_")"
"RTN","WVRALINK",192,0)
 S WVMSG(2)=" WH Accession #: "_$P($G(^WV(790.1,+WVIEN,0)),U,1)
"RTN","WVRALINK",193,0)
 S WVMSG(3)="  RAD/NM Case #: "_WVCASE
"RTN","WVRALINK",194,0)
 S WVMSG(4)=" "
"RTN","WVRALINK",195,0)
 S WVMSG(5)="NOTE: THIS PROCEDURE HAS BEEN ALTERED IN RADIOLOGY/NM."
"RTN","WVRALINK",196,0)
 S WVMSG(6)="Follow-up is required in the WOMEN'S HEALTH package!"
"RTN","WVRALINK",197,0)
 S XMTEXT="WVMSG("
"RTN","WVRALINK",198,0)
 D ^XMD
"RTN","WVRALINK",199,0)
 I $D(ZTQUEUED) S ZTREQ="@"
"RTN","WVRALINK",200,0)
 Q
"RTN","WVRPSCR1")
0^21^B36274367
"RTN","WVRPSCR1",1,0)
WVRPSCR1 ;HCIOFO/FT,JR-Display Compliance Rates (cont.) ;6/17/99  11:47
"RTN","WVRPSCR1",2,0)
 ;;1.0;WOMEN'S HEALTH;**3,7**;Sep 30, 1998
"RTN","WVRPSCR1",3,0)
 ;;  Original routine created by IHS/ANMC/MWR
"RTN","WVRPSCR1",4,0)
 ;;* MICHAEL REMILLARD, DDS * ALASKA NATIVE MEDICAL CENTER *
"RTN","WVRPSCR1",5,0)
 ;;  THIS REPORT WILL DISPLAY COMPLIANCE RATES FOR PAPS & MAMS.
"RTN","WVRPSCR1",6,0)
 ;;  ENTRY POINTS CALLED BY WVRPSCR.
"RTN","WVRPSCR1",7,0)
DATA ;EP
"RTN","WVRPSCR1",8,0)
 ;---> SORT AND STORE ARRAY IN ^TMP("WV",$J
"RTN","WVRPSCR1",9,0)
 K WVTMP,^TMP("WV",$J),^TMP("WVP",$J),WVPR
"RTN","WVRPSCR1",10,0)
 ;---> WVBEGDT1=ONE SECOND BEFORE BEGIN DATE.
"RTN","WVRPSCR1",11,0)
 ;---> WVENDDT1=THE LAST SECOND OF END DATE.
"RTN","WVRPSCR1",12,0)
 F WVCNT=20,30,40,50,60,70,200 S WVAGRG(WVCNT)=""
"RTN","WVRPSCR1",13,0)
 S WVBEGDT1=WVBEGDT-.0001,WVENDDT1=WVENDDT+.9999
"RTN","WVRPSCR1",14,0)
 ;
"RTN","WVRPSCR1",15,0)
 S WVDATE=WVBEGDT1,WVTOT=$$ACTIVE^WVRPSCR2(WVBEGDT,WVENDDT1,WVAGRG)
"RTN","WVRPSCR1",16,0)
 F  S WVDATE=$O(^WV(790.1,"D",WVDATE)) Q:'WVDATE!(WVDATE>WVENDDT1)  D
"RTN","WVRPSCR1",17,0)
 .S WVIEN=0
"RTN","WVRPSCR1",18,0)
 .F  S WVIEN=$O(^WV(790.1,"D",WVDATE,WVIEN)) Q:'WVIEN  D
"RTN","WVRPSCR1",19,0)
 ..S Y=^WV(790.1,WVIEN,0)
"RTN","WVRPSCR1",20,0)
 ..S WVDFN=$P(Y,U,2),WVPCDN=$P(Y,U,4),WVRES=$P(Y,U,5)
"RTN","WVRPSCR1",21,0)
 ..;
"RTN","WVRPSCR1",22,0)
 ..;---> QUIT IF THIS PROCEDURE HAS A RESULT OF "ERROR/DISREGARD".
"RTN","WVRPSCR1",23,0)
 ..Q:WVRES=8
"RTN","WVRPSCR1",24,0)
 ..;
"RTN","WVRPSCR1",25,0)
 ..;---> QUIT IF NEITHER A PAP (IEN=1) NOR A SCREENING MAM (IEN=28).
"RTN","WVRPSCR1",26,0)
 ..Q:((WVPCDN'=1)&(WVPCDN'=28))
"RTN","WVRPSCR1",27,0)
 ..;
"RTN","WVRPSCR1",28,0)
 ..;---> QUIT IS PATIENT IS NOT WITHIN AGE RANGE.
"RTN","WVRPSCR1",29,0)
 ..S WVAGE=+$$AGE^WVUTL9(WVDFN)
"RTN","WVRPSCR1",30,0)
 ..I WVAGRG'=1 Q:((WVAGE<$P(WVAGRG,"-"))!(WVAGE>$P(WVAGRG,"-",2)))
"RTN","WVRPSCR1",31,0)
 ..;
"RTN","WVRPSCR1",32,0)
 ..;---> GET VALUE OF RESULT: 0=NORMAL, 1=ABNORMAL, 2=NO RESULT
"RTN","WVRPSCR1",33,0)
 ..S WVNORM=$$NORMAL^WVUTL4(WVRES) S:WVNORM=2 WVNORM=0
"RTN","WVRPSCR1",34,0)
 ..;
"RTN","WVRPSCR1",35,0)
 ..S ^TMP("WV",$J,WVDFN,WVNORM,WVPCDN,WVIEN)=""
"RTN","WVRPSCR1",36,0)
 ..I WVPCDN=1 D
"RTN","WVRPSCR1",37,0)
 ...S WVJPAPR=$P($G(^WV(790,WVDFN,0)),U,16)
"RTN","WVRPSCR1",38,0)
 ...I WVJPAPR'>0 S WVJPAPR="NOT SPECIFIED"
"RTN","WVRPSCR1",39,0)
 ...E  S WVJPAPR=$P($G(^WV(790.03,WVJPAPR,0)),U)
"RTN","WVRPSCR1",40,0)
 ...S ^TMP("WVP",$J,WVJPAPR,WVDFN,WVNORM,WVPCDN,WVIEN)=""
"RTN","WVRPSCR1",41,0)
 ..I WVPCDN=28 D
"RTN","WVRPSCR1",42,0)
 ...S WVJ=$O(WVAGRG(WVAGE))
"RTN","WVRPSCR1",43,0)
 ...S WVJAGER=$S(WVJ=20:"<20",WVJ=30:"20-29",WVJ=40:"30-39",WVJ=50:"40-49",WVJ=60:"50-59",WVJ=70:"60-69",WVJ=200:">70",1:"AGE UNKNOWN")
"RTN","WVRPSCR1",44,0)
 ...S ^TMP("WVP",$J,WVJAGER,WVDFN,WVNORM,WVPCDN,WVIEN)=""
"RTN","WVRPSCR1",45,0)
 ;
"RTN","WVRPSCR1",46,0)
 ;---> NOW COLLATE DATA FROM ^TMP ARRAY INTO LOCAL WVTMP REPORT ARRAY.
"RTN","WVRPSCR1",47,0)
 ;---> FIRST, SEED LOCAL ARRAY WITH ZEROS.
"RTN","WVRPSCR1",48,0)
 F M=1,28 D
"RTN","WVRPSCR1",49,0)
 .N I F I=1:1:5 S WVTMP("RES",M,I)=0
"RTN","WVRPSCR1",50,0)
 ;
"RTN","WVRPSCR1",51,0)
 ;---> COLLATE DATA.
"RTN","WVRPSCR1",52,0)
 S N=0
"RTN","WVRPSCR1",53,0)
 F  S N=$O(^TMP("WV",$J,N)) Q:'N  D
"RTN","WVRPSCR1",54,0)
 .F M=1,28 D
"RTN","WVRPSCR1",55,0)
 ..Q:$D(^TMP("WV",$J,N,1,M))
"RTN","WVRPSCR1",56,0)
 ..S P=0,Q=0
"RTN","WVRPSCR1",57,0)
 ..F  S P=$O(^TMP("WV",$J,N,0,M,P)) Q:'P  S Q=Q+1
"RTN","WVRPSCR1",58,0)
 ..Q:'Q
"RTN","WVRPSCR1",59,0)
 ..I '$D(WVTMP("RES",M,Q)) S WVTMP("RES",M,Q)=1 Q
"RTN","WVRPSCR1",60,0)
 ..S WVTMP("RES",M,Q)=WVTMP("RES",M,Q)+1
"RTN","WVRPSCR1",61,0)
 ;
"RTN","WVRPSCR1",62,0)
 ;---> STORE ALL NODES >5 IN THE 5+ NODE.
"RTN","WVRPSCR1",63,0)
 F M=1,28 D
"RTN","WVRPSCR1",64,0)
 .S Q=5
"RTN","WVRPSCR1",65,0)
 .F  S Q=$O(WVTMP("RES",M,Q)) Q:'Q  D
"RTN","WVRPSCR1",66,0)
 ..S WVTMP("RES",M,5)=WVTMP("RES",M,5)+WVTMP("RES",M,Q)
"RTN","WVRPSCR1",67,0)
 ..K WVTMP("RES",M,Q)
"RTN","WVRPSCR1",68,0)
 ;
"RTN","WVRPSCR1",69,0)
 ;---> FIGURE PERCENTAGES OF WOMEN AND STORE IN ARRAY.
"RTN","WVRPSCR1",70,0)
 F M=1,28 D
"RTN","WVRPSCR1",71,0)
 .F Q=1:1:5 S $P(WVTMP("RES",M,Q),U,2)=$J((+WVTMP("RES",M,Q)/WVTOT),0,2)
"RTN","WVRPSCR1",72,0)
 ;
"RTN","WVRPSCR1",73,0)
 ;---> BUILD DISPLAY ARRAY.
"RTN","WVRPSCR1",74,0)
 N WVNODE K ^TMP("WV",$J)
"RTN","WVRPSCR1",75,0)
 ;
"RTN","WVRPSCR1",76,0)
 ;---> PAPS SUBHEADER LINE.
"RTN","WVRPSCR1",77,0)
 S WVNODE=$$S(40)_"SCREENING PAPS"
"RTN","WVRPSCR1",78,0)
 D WRITE(1,WVNODE)
"RTN","WVRPSCR1",79,0)
 S WVNODE=$$S(39)_"----------------"
"RTN","WVRPSCR1",80,0)
 D WRITE(2,WVNODE)
"RTN","WVRPSCR1",81,0)
 S WVNODE=" # of PAPs:                                        1     2     3     4     5+"
"RTN","WVRPSCR1",82,0)
 D WRITE(4,WVNODE)
"RTN","WVRPSCR1",83,0)
 S WVNODE=" -----------                                     ----- ----- ----- ----- -----"
"RTN","WVRPSCR1",84,0)
 D WRITE(5,WVNODE)
"RTN","WVRPSCR1",85,0)
 ;
"RTN","WVRPSCR1",86,0)
 ;---> PAPS NUMBER OF WOMEN DATA LINE.
"RTN","WVRPSCR1",87,0)
 S WVNODE=" # of Women:                                    "
"RTN","WVRPSCR1",88,0)
 F Q=1:1:5 S WVNODE=WVNODE_$J($P(WVTMP("RES",1,Q),U),6)
"RTN","WVRPSCR1",89,0)
 D WRITE(6,WVNODE)
"RTN","WVRPSCR1",90,0)
 S WVNODE=" % of Women:                                    "
"RTN","WVRPSCR1",91,0)
 F Q=1:1:5 S WVNODE=WVNODE_$J(($P(WVTMP("RES",1,Q),U,2)*100),5)_"%"
"RTN","WVRPSCR1",92,0)
 D WRITE(7,WVNODE)
"RTN","WVRPSCR1",93,0)
 ;
"RTN","WVRPSCR1",94,0)
 ;---> LINE FEEDS BETWEEN PAPS AND MAMS.
"RTN","WVRPSCR1",95,0)
 S WVNODE="" D WRITE(8,WVNODE) S WVNODE="" D WRITE(9,WVNODE)
"RTN","WVRPSCR1",96,0)
 ;
"RTN","WVRPSCR1",97,0)
 ;---> MAMS SUBHEADER LINE.
"RTN","WVRPSCR1",98,0)
 S WVNODE=$$S(40)_"SCREENING MAMS"
"RTN","WVRPSCR1",99,0)
 D WRITE(10,WVNODE)
"RTN","WVRPSCR1",100,0)
 S WVNODE=$$S(39)_"----------------"
"RTN","WVRPSCR1",101,0)
 D WRITE(11,WVNODE)
"RTN","WVRPSCR1",102,0)
 S WVNODE=" # of MAMs:                                        1     2     3     4     5+"
"RTN","WVRPSCR1",103,0)
 D WRITE(13,WVNODE)
"RTN","WVRPSCR1",104,0)
 S WVNODE=" -----------                                     ----- ----- ----- ----- -----"
"RTN","WVRPSCR1",105,0)
 D WRITE(14,WVNODE)
"RTN","WVRPSCR1",106,0)
 ;
"RTN","WVRPSCR1",107,0)
 ;---> PAPS NUMBER OF WOMEN DATA LINE.
"RTN","WVRPSCR1",108,0)
 S WVNODE=" # of Women:                                    "
"RTN","WVRPSCR1",109,0)
 F Q=1:1:5 S WVNODE=WVNODE_$J($P(WVTMP("RES",28,Q),U),6)
"RTN","WVRPSCR1",110,0)
 D WRITE(15,WVNODE)
"RTN","WVRPSCR1",111,0)
 S WVNODE=" % of Women:                                    "
"RTN","WVRPSCR1",112,0)
 F Q=1:1:5 S WVNODE=WVNODE_$J(($P(WVTMP("RES",28,Q),U,2)*100),5)_"%"
"RTN","WVRPSCR1",113,0)
 D WRITE(16,WVNODE)
"RTN","WVRPSCR1",114,0)
 Q
"RTN","WVRPSCR1",115,0)
 ;
"RTN","WVRPSCR1",116,0)
WRITE(I,Y) ;EP
"RTN","WVRPSCR1",117,0)
 S ^TMP("WV",$J,I,0)=Y
"RTN","WVRPSCR1",118,0)
 Q
"RTN","WVRPSCR1",119,0)
 ;
"RTN","WVRPSCR1",120,0)
S(S) ;EP
"RTN","WVRPSCR1",121,0)
 ;---> SPACES.
"RTN","WVRPSCR1",122,0)
 Q $$S^WVUTL7($G(S))
"RTN","WVRPSCR1",123,0)
 ;
"RTN","WVRPSCR1",124,0)
 ;
"RTN","WVRPSCR1",125,0)
AGERNG(WVAGRG,WVPOP) ;EP
"RTN","WVRPSCR1",126,0)
 ;---> ASK AGE RANGE.
"RTN","WVRPSCR1",127,0)
 ;---> RETURN AGE RANGE IN WVAGRG.
"RTN","WVRPSCR1",128,0)
 N DIR,DIRUT,Y S WVPOP=0
"RTN","WVRPSCR1",129,0)
 W !!?3,"Do you wish to limit this report to an age range?"
"RTN","WVRPSCR1",130,0)
 S DIR(0)="Y",DIR("B")="NO" D HELP1
"RTN","WVRPSCR1",131,0)
 S DIR("A")="   Enter Yes or No"
"RTN","WVRPSCR1",132,0)
 D ^DIR K DIR W !
"RTN","WVRPSCR1",133,0)
 S:$D(DIRUT) WVPOP=1
"RTN","WVRPSCR1",134,0)
 ;---> IF NOT DISPLAYING BY AGE RANGE, SET WVAGRG (AGE RANGE)=1, QUIT.
"RTN","WVRPSCR1",135,0)
 I 'Y S WVAGRG=1 Q
"RTN","WVRPSCR1",136,0)
BYAGE1 ;
"RTN","WVRPSCR1",137,0)
 W !?5,"Enter the age range you wish to select in the form of: 40-75"
"RTN","WVRPSCR1",138,0)
 W !?5,"Use a dash ""-"" to separate the limits of the range."
"RTN","WVRPSCR1",139,0)
 W !?5,"To select only one age, simply enter that age, with no dash."
"RTN","WVRPSCR1",140,0)
 W !?5,"(NOTE: Patient ages will reflect the age they are today.)",!
"RTN","WVRPSCR1",141,0)
 K DIR
"RTN","WVRPSCR1",142,0)
 S DIR(0)="FOA",DIR("A")="     Enter age range: "
"RTN","WVRPSCR1",143,0)
 S:$D(^WV(790.72,DUZ,0)) DIR("B")=$P(^(0),U,3)
"RTN","WVRPSCR1",144,0)
 D ^DIR K DIR
"RTN","WVRPSCR1",145,0)
 I $D(DIRUT) S WVPOP=1 Q
"RTN","WVRPSCR1",146,0)
 D CHECK(.Y)
"RTN","WVRPSCR1",147,0)
 I Y="" D  G BYAGE1
"RTN","WVRPSCR1",148,0)
 .W !!?5,"* INVALID AGE RANGE.  Please begin again."
"RTN","WVRPSCR1",149,0)
 ;---> WVAGRG=SELECTED AGE RANGE(S).
"RTN","WVRPSCR1",150,0)
 S WVAGRG=Y
"RTN","WVRPSCR1",151,0)
 D DIC^WVFMAN(790.72,"L",.Y,"","","","`"_DUZ)
"RTN","WVRPSCR1",152,0)
 Q:Y<0
"RTN","WVRPSCR1",153,0)
 D DIE^WVFMAN(790.72,".03////"_WVAGRG,+Y,.WVPOP,1)
"RTN","WVRPSCR1",154,0)
 Q
"RTN","WVRPSCR1",155,0)
 ;
"RTN","WVRPSCR1",156,0)
HELP1 ;EP
"RTN","WVRPSCR1",157,0)
 ;;Answer "YES" to display screening rates for a specific age range.
"RTN","WVRPSCR1",158,0)
 ;;If you choose to display for an age range, you will be given the
"RTN","WVRPSCR1",159,0)
 ;;opportunity to select the age range.  For example, you might choose
"RTN","WVRPSCR1",160,0)
 ;;to display from ages 50-75.
"RTN","WVRPSCR1",161,0)
 ;;Answer "NO" to display screening rates for all ages.
"RTN","WVRPSCR1",162,0)
 S WVTAB=5,WVLINL="HELP1" D HELPTX
"RTN","WVRPSCR1",163,0)
 Q
"RTN","WVRPSCR1",164,0)
 ;
"RTN","WVRPSCR1",165,0)
PRINTX ;EP
"RTN","WVRPSCR1",166,0)
 N I,T,X S T=$$REPEAT^XLFSTR(" ",WVTAB)
"RTN","WVRPSCR1",167,0)
 F I=1:1 S X=$T(@WVLINL+I) Q:X'[";;"  W !,T,$P(X,";;",2)
"RTN","WVRPSCR1",168,0)
 Q
"RTN","WVRPSCR1",169,0)
 ;
"RTN","WVRPSCR1",170,0)
HELPTX ;EP
"RTN","WVRPSCR1",171,0)
 ;---> CREATES DIR ARRAY FOR DIR.  REQUIRED VARIABLES: WVTAB,WVLINL.
"RTN","WVRPSCR1",172,0)
 N I,T,X S T=$$REPEAT^XLFSTR(" ",WVTAB)
"RTN","WVRPSCR1",173,0)
 F I=1:1 S X=$T(@WVLINL+I) Q:X'[";;"  S DIR("?",I)=T_$P(X,";;",2)
"RTN","WVRPSCR1",174,0)
 S DIR("?")=DIR("?",I-1) K DIR("?",I-1)
"RTN","WVRPSCR1",175,0)
 Q
"RTN","WVRPSCR1",176,0)
 ;
"RTN","WVRPSCR1",177,0)
CHECK(X) ;EP
"RTN","WVRPSCR1",178,0)
 ;---> CHECK SYNTAX OF AGE RANGE STRING.
"RTN","WVRPSCR1",179,0)
 ;---> IF X=ONE AGE ONLY, SET IT IN THE FORM X-X AND QUIT.
"RTN","WVRPSCR1",180,0)
 I X?1N.N S X=X_"-"_X Q
"RTN","WVRPSCR1",181,0)
 ;
"RTN","WVRPSCR1",182,0)
 N FAIL,I,Y1,Y2
"RTN","WVRPSCR1",183,0)
 S FAIL=0
"RTN","WVRPSCR1",184,0)
 ;---> CHECK EACH RANGE.
"RTN","WVRPSCR1",185,0)
 S Y1=$P(X,"-"),Y2=$P(X,"-",2)
"RTN","WVRPSCR1",186,0)
 ;---> EACH END OF EACH RANGE SHOULD BE A NUMBER.
"RTN","WVRPSCR1",187,0)
 I (Y1'?1N.N)!(Y2'?1N.N) S X="" Q
"RTN","WVRPSCR1",188,0)
 ;---> THE LOWER NUMBER SHOULD BE FIRST.
"RTN","WVRPSCR1",189,0)
 I Y2<Y1 S FAIL=1
"RTN","WVRPSCR1",190,0)
 I FAIL S X="" Q
"RTN","WVRPSCR1",191,0)
 Q
"RTN","WVRPSCR2")
0^22^B9166089
"RTN","WVRPSCR2",1,0)
WVRPSCR2 ;HCIOFO/JWR,FT-WVRPSCR cont'd, Gathers Pap Regimens info. ;6/17/99  11:46
"RTN","WVRPSCR2",2,0)
 ;;1.0;WOMEN'S HEALTH;**7**;Sep 30, 1998
"RTN","WVRPSCR2",3,0)
EN ;---> NOW COLLATE DATA FROM ^TMP ARRAY INTO LOCAL WVTMP REPORT ARRAY.
"RTN","WVRPSCR2",4,0)
 ;---> FIRST, SEED LOCAL ARRAY WITH ZEROS.
"RTN","WVRPSCR2",5,0)
 K WVPR
"RTN","WVRPSCR2",6,0)
 ;
"RTN","WVRPSCR2",7,0)
 ;---> COLLATE DATA.
"RTN","WVRPSCR2",8,0)
 S J="" F  S J=$O(^TMP("WVP",$J,J)) Q:J=""  D
"RTN","WVRPSCR2",9,0)
 .S N=0 F  S N=$O(^TMP("WVP",$J,J,N)) Q:'N  D
"RTN","WVRPSCR2",10,0)
 ..F M=1,28 S WVJTYP=$S(M=1:"PAPR",1:"MAM") D
"RTN","WVRPSCR2",11,0)
 ...Q:$D(^TMP("WVP",$J,J,N,1,M))  ;DON'T INCLUDE IF PATIENT HAD ANY ABNOR
"RTN","WVRPSCR2",12,0)
 ...S P=0,Q=0
"RTN","WVRPSCR2",13,0)
 ...F  S P=$O(^TMP("WVP",$J,J,N,0,M,P)) Q:'P  S Q=Q+1
"RTN","WVRPSCR2",14,0)
 ...Q:'Q
"RTN","WVRPSCR2",15,0)
 ...I '$D(WVPR(WVJTYP,J,M,Q)) S WVPR(WVJTYP,J,M,Q)=1 Q
"RTN","WVRPSCR2",16,0)
 ...S WVPR(WVJTYP,J,M,Q)=WVPR(WVJTYP,J,M,Q)+1
"RTN","WVRPSCR2",17,0)
 ;
"RTN","WVRPSCR2",18,0)
 ;---> STORE ALL NODES >5 IN THE 5+ NODE.
"RTN","WVRPSCR2",19,0)
 F M=1,28 S WVJTYP=$S(M=1:"PAPR",1:"MAM") D
"RTN","WVRPSCR2",20,0)
 .S J="" F  S J=$O(^TMP("WVP",$J,J)) Q:J=""  D
"RTN","WVRPSCR2",21,0)
 ..S Q=5
"RTN","WVRPSCR2",22,0)
 ..F  S Q=$O(WVPR(WVJTYP,J,M,Q)) Q:'Q  D
"RTN","WVRPSCR2",23,0)
 ...S WVPR(WVJTYP,J,M,5)=$G(WVPR(WVJTYP,J,M,5))+WVPR(WVJTYP,J,M,Q)
"RTN","WVRPSCR2",24,0)
 ;
"RTN","WVRPSCR2",25,0)
 ;---> FIGURE PERCENTAGES OF WOMEN AND STORE IN ARRAY.
"RTN","WVRPSCR2",26,0)
 F M=1,28 S WVJTYP=$S(M=1:"PAPR",1:"MAM") D
"RTN","WVRPSCR2",27,0)
 .S J="" F  S J=$O(WVPR(WVJTYP,J)) Q:J=""  D
"RTN","WVRPSCR2",28,0)
 ..F Q=1:1:5 I $D(WVPR(WVJTYP,J,M,Q)) S $P(WVPR(WVJTYP,J,M,Q),U,2)=$J((+WVPR(WVJTYP,J,M,Q)/WVTOT),0,2)
"RTN","WVRPSCR2",29,0)
 ;
"RTN","WVRPSCR2",30,0)
PRINT N BLANK,DATA
"RTN","WVRPSCR2",31,0)
 S $P(BLANK," ",41)="",CN=7.001
"RTN","WVRPSCR2",32,0)
 S WVJST=0 F M=1,28 S WVJTYP=$S(M=1:"PAPR",1:"MAM") S:M=28 CN=16.001 D
"RTN","WVRPSCR2",33,0)
 .S J="" F  S J=$O(WVPR(WVJTYP,J)) Q:J=""  D
"RTN","WVRPSCR2",34,0)
 ..Q:'$D(WVPR(WVJTYP,J,M))
"RTN","WVRPSCR2",35,0)
 ..N P F Q=1:1:5 S DATA=$G(WVPR(WVJTYP,J,M,Q)) D
"RTN","WVRPSCR2",36,0)
 ...S P(1)=$P(DATA,U),P(2)=$P(DATA,U,2)*100 S:P(1)="" P(1)=0
"RTN","WVRPSCR2",37,0)
 ...S P("NO")=$G(P("NO"))_$E(BLANK,1,6-$L(P(1)))_P(1)
"RTN","WVRPSCR2",38,0)
 ...S P("PCT")=$G(P("PCT"))_$E(BLANK,1,5-$L(P(2)))_P(2)_"%"
"RTN","WVRPSCR2",39,0)
 ..S ^TMP("WV",$J,CN,0)=" "_J_$E(BLANK,1,36-$L(J))_"# of Women "_P("NO")
"RTN","WVRPSCR2",40,0)
 ..S CN=CN+.001
"RTN","WVRPSCR2",41,0)
 ..S ^TMP("WV",$J,CN,0)=$E(BLANK,1,37)_"% of Women "_P("PCT")
"RTN","WVRPSCR2",42,0)
 ..S CN=CN+.001
"RTN","WVRPSCR2",43,0)
 ..S ^TMP("WV",$J,CN,0)=""
"RTN","WVRPSCR2",44,0)
 ..S CN=CN+.001
"RTN","WVRPSCR2",45,0)
 Q
"RTN","WVRPSCR2",46,0)
HDR ;
"RTN","WVRPSCR2",47,0)
 Q:N>7.9&(N'>16)
"RTN","WVRPSCR2",48,0)
 S WVJHDR=$S(N<8:"PAP REGIMEN",N>16:"AGE GROUPS ",1:"           ")
"RTN","WVRPSCR2",49,0)
 W !!," ",WVJHDR,"                                       1     2     3     4     5+"
"RTN","WVRPSCR2",50,0)
 W !," -----------                                     ----- ----- ----- ----- -----"
"RTN","WVRPSCR2",51,0)
 Q
"RTN","WVRPSCR2",52,0)
ACTIVE(WVBEGIN,WVEND,WVAGRG) ; Count active patients in WV PATIENT file (#790).
"RTN","WVRPSCR2",53,0)
 ; Active is defined as not having a DATE INACTIVE (#.24) field
"RTN","WVRPSCR2",54,0)
 ; value or that value falls within the date range selected.
"RTN","WVRPSCR2",55,0)
 ; WVBEGIN - start of date range in FM format
"RTN","WVRPSCR2",56,0)
 ;   WVEND - end of date range in FM format
"RTN","WVRPSCR2",57,0)
 N WVLOOP,WVNODE,WVACTIVE,WVAGE
"RTN","WVRPSCR2",58,0)
 S (WVLOOP,WVACTIVE)=0
"RTN","WVRPSCR2",59,0)
 ; check if date range exists
"RTN","WVRPSCR2",60,0)
 I 'WVBEGIN!('WVEND)!(WVAGRG="") S WVACTIVE=1 Q WVACTIVE
"RTN","WVRPSCR2",61,0)
 F  S WVLOOP=$O(^WV(790,WVLOOP)) Q:'WVLOOP  D
"RTN","WVRPSCR2",62,0)
 .S WVNODE=$G(^WV(790,WVLOOP,0))
"RTN","WVRPSCR2",63,0)
 .Q:WVNODE=""
"RTN","WVRPSCR2",64,0)
 .S WVAGE=+$$AGE^WVUTL9(WVLOOP)
"RTN","WVRPSCR2",65,0)
 .I WVAGRG'=1 Q:((WVAGE<$P(WVAGRG,"-"))!(WVAGE>$P(WVAGRG,"-",2)))
"RTN","WVRPSCR2",66,0)
 .I +$P(WVNODE,U,24)'>0 S WVACTIVE=WVACTIVE+1 Q  ;active
"RTN","WVRPSCR2",67,0)
 .Q:$P(WVNODE,U,24)<WVBEGIN  ;inactive before date range
"RTN","WVRPSCR2",68,0)
 .I $P(WVNODE,U,24)>WVEND S WVACTIVE=WVACTIVE+1 Q  ;inactive after range
"RTN","WVRPSCR2",69,0)
 .S WVACTIVE=WVACTIVE+1 ;active at some time within range
"RTN","WVRPSCR2",70,0)
 .Q
"RTN","WVRPSCR2",71,0)
 S:WVACTIVE=0 WVACTIVE=1
"RTN","WVRPSCR2",72,0)
 Q WVACTIVE
"RTN","WVRPSCR2",73,0)
 ;
"RTN","WVRPSNP")
0^5^B43016328
"RTN","WVRPSNP",1,0)
WVRPSNP ;HCIOFO/FT,JR-REPORT: SNAPSHOT OF PROGRAM  ;7/7/99  10:36
"RTN","WVRPSNP",2,0)
 ;;1.0;WOMEN'S HEALTH;**7**;Sep 30, 1998
"RTN","WVRPSNP",3,0)
 ;;  Original routine created by IHS/ANMC/MWR
"RTN","WVRPSNP",4,0)
 ;;* MICHAEL REMILLARD, DDS * ALASKA NATIVE MEDICAL CENTER *
"RTN","WVRPSNP",5,0)
 ;;  CALLED BY OPTION: "WV PRINT SNAPSHOT" TO DISPLAY FROM 1/1 CURRENT
"RTN","WVRPSNP",6,0)
 ;;  YEAR TO PRESENT #PATIENTS, #PAPS, #MAMS, #DELINQUENT NEEDS, ETC.
"RTN","WVRPSNP",7,0)
 ;
"RTN","WVRPSNP",8,0)
 D SETVARS^WVUTL5 S WVFAC=DUZ(2) K ^TMP("WVF",$J)
"RTN","WVRPSNP",9,0)
 N A,B,C,D,E,F,G,H,I,J,K,L,M,N,P,Q,R,S,X,Y,WA,WB,WC,WE,WF,WG,WH,WX,N0
"RTN","WVRPSNP",10,0)
 N WVBRTXND,WVCXTXND
"RTN","WVRPSNP",11,0)
 D TITLE^WVUTL5("PROGRAM SNAPSHOT")
"RTN","WVRPSNP",12,0)
 D ASKTOY G:WVPOP EXIT
"RTN","WVRPSNP",13,0)
 D ASKSAVE G:WVPOP EXIT
"RTN","WVRPSNP",14,0)
 D DEVICE  G:WVPOP EXIT
"RTN","WVRPSNP",15,0)
 D GATHER
"RTN","WVRPSNP",16,0)
 D:WVA STORE
"RTN","WVRPSNP",17,0)
 K WVDTIEN
"RTN","WVRPSNP",18,0)
 D ^WVRPSNP1
"RTN","WVRPSNP",19,0)
 ;
"RTN","WVRPSNP",20,0)
EXIT ;EP
"RTN","WVRPSNP",21,0)
 D KILLALL^WVUTL8
"RTN","WVRPSNP",22,0)
 K ^TMP("WVF",$J)
"RTN","WVRPSNP",23,0)
 Q
"RTN","WVRPSNP",24,0)
 ;
"RTN","WVRPSNP",25,0)
ASKTOY ;
"RTN","WVRPSNP",26,0)
 S WVTOY="" S DIR("A")="   Report by (C)alendar or (F)iscal year? "
"RTN","WVRPSNP",27,0)
 S DIR(0)="SAO^C:Calendar Year;F:Fiscal Year",DIR("B")="Fiscal"
"RTN","WVRPSNP",28,0)
 D ^DIR
"RTN","WVRPSNP",29,0)
 I "FC"'[Y S WVPOP=1 Q
"RTN","WVRPSNP",30,0)
 S WVTOY=Y
"RTN","WVRPSNP",31,0)
 S WVJDT=$E(DT,1,3)_"0000"
"RTN","WVRPSNP",32,0)
 I WVTOY="F" I $E(DT,4,5)<10 S WVJDT=$E(DT-10000,1,3)_"1000"
"RTN","WVRPSNP",33,0)
 Q
"RTN","WVRPSNP",34,0)
DEVICE ;EP
"RTN","WVRPSNP",35,0)
 ;---> GET DEVICE AND POSSIBLY QUEUE TO TASKMAN.
"RTN","WVRPSNP",36,0)
 S ZTRTN="DEQUEUE^WVRPSNP"
"RTN","WVRPSNP",37,0)
 F WVSV="A","FAC","TOY","JDT" D
"RTN","WVRPSNP",38,0)
 .I $D(@("WV"_WVSV)) S ZTSAVE("WV"_WVSV)=""
"RTN","WVRPSNP",39,0)
 D ZIS^WVUTL2(.WVPOP,1,"HOME")
"RTN","WVRPSNP",40,0)
 Q
"RTN","WVRPSNP",41,0)
 ;
"RTN","WVRPSNP",42,0)
ASKSAVE ;EP
"RTN","WVRPSNP",43,0)
 ;---> ASK IF THIS REPORT SHOULD BE SAVED FOR LATER RETRIEVAL.
"RTN","WVRPSNP",44,0)
 N DIR,DIRUT,Y
"RTN","WVRPSNP",45,0)
 W !!?3,"Should today's Snapshot be stored for later retrieval and"
"RTN","WVRPSNP",46,0)
 W " comparisons?"
"RTN","WVRPSNP",47,0)
 S DIR(0)="Y",DIR("A")="   Enter Yes or No",DIR("B")="NO"
"RTN","WVRPSNP",48,0)
 S WVA=0 D HELP1
"RTN","WVRPSNP",49,0)
 D ^DIR K DIR W !
"RTN","WVRPSNP",50,0)
 S:$D(DIRUT) WVPOP=1
"RTN","WVRPSNP",51,0)
 S:Y WVA=1
"RTN","WVRPSNP",52,0)
 Q
"RTN","WVRPSNP",53,0)
 ;
"RTN","WVRPSNP",54,0)
DEQUEUE ;EP
"RTN","WVRPSNP",55,0)
 ;---> QUEUED REPORT
"RTN","WVRPSNP",56,0)
 N A,B,C,D,E,F,G,H,J,K,L,M,N,P,Q,R,S,X,Y
"RTN","WVRPSNP",57,0)
 D SETVARS^WVUTL5,GATHER,STORE,^WVRPSNP1,EXIT
"RTN","WVRPSNP",58,0)
 Q
"RTN","WVRPSNP",59,0)
 ;
"RTN","WVRPSNP",60,0)
STORE ;EP
"RTN","WVRPSNP",61,0)
 ;---> STORE REPORT DATA IN FILE #790.71.
"RTN","WVRPSNP",62,0)
 Q:'WVA
"RTN","WVRPSNP",63,0)
 N WVDR,DA,DIC,DIE,X,Y
"RTN","WVRPSNP",64,0)
 S WVDR=".02////"_WVFAC,Y=.02
"RTN","WVRPSNP",65,0)
 F WVI=A,B,C,D,E,F,G,H,S,J,K,L,P,Q,R D
"RTN","WVRPSNP",66,0)
 .S Y=Y+.01,WVDR=WVDR_";"_Y_"////"_WVI
"RTN","WVRPSNP",67,0)
 S Y=.5,WVJDR=".5////"_WVI(1)
"RTN","WVRPSNP",68,0)
 F WVJ=2:1:30 S Y=Y+.01 S WVJDR=WVJDR_";"_Y_"////"_WVI(WVJ)
"RTN","WVRPSNP",69,0)
 S WVDR=WVDR_";.18////"_WVTOY
"RTN","WVRPSNP",70,0)
 N A,B,C,D,E,F,G,H,S,J,K,L,P,Q,R D
"RTN","WVRPSNP",71,0)
 .S A=0,WVJNDA="" F  S A=$O(^WV(790.71,"B",DT,A)) Q:A'>0  D  Q:WVJNDA>0
"RTN","WVRPSNP",72,0)
 ..S:$D(^WV(790.71,"T",WVTOY,A)) WVJNDA=A
"RTN","WVRPSNP",73,0)
 .I WVJNDA'>0 D 
"RTN","WVRPSNP",74,0)
 ..K DD,DO S DIC="^WV(790.71,",DIC(0)="ML",X=DT
"RTN","WVRPSNP",75,0)
 ..D FILE^DICN Q:Y<0  S WVJNDA=+Y
"RTN","WVRPSNP",76,0)
 .S Y=$G(WVJNDA) Q:Y'>0
"RTN","WVRPSNP",77,0)
 .D DIE^WVFMAN(790.71,WVDR,WVJNDA)
"RTN","WVRPSNP",78,0)
 .D DIE^WVFMAN(790.71,WVJDR,WVJNDA)
"RTN","WVRPSNP",79,0)
 Q
"RTN","WVRPSNP",80,0)
 ;
"RTN","WVRPSNP",81,0)
 ;
"RTN","WVRPSNP",82,0)
GATHER ;EP
"RTN","WVRPSNP",83,0)
 ;---> GATHER DATA
"RTN","WVRPSNP",84,0)
 S (A,B,C,D,E,F,G,H,J,K,L,M,N,P,Q,R,S)=0
"RTN","WVRPSNP",85,0)
 ;---> USE WVDT SO THAT THE DATE WON'T CHANGE IF RUN SPANS MIDNIGHT.
"RTN","WVRPSNP",86,0)
 D SETVARS^WVUTL5 S WVDT=DT
"RTN","WVRPSNP",87,0)
 S WVBRTXND=$$IEN^WVUTL9(790.51,"Not Indicated")
"RTN","WVRPSNP",88,0)
 S WVCXTXND=$$IEN^WVUTL9(790.5,"Not Indicated")
"RTN","WVRPSNP",89,0)
 ;
"RTN","WVRPSNP",90,0)
 ;---> PATIENT DATA
"RTN","WVRPSNP",91,0)
 F  S N=$O(^WV(790,N)) Q:'N  S Y=^WV(790,N,0) D
"RTN","WVRPSNP",92,0)
 .;---> QUIT IF PATIENT IS NOT ACTIVE.
"RTN","WVRPSNP",93,0)
 .Q:$P(Y,U,24)
"RTN","WVRPSNP",94,0)
 .;---> QUIT IF PATIENT IS DECEASED.
"RTN","WVRPSNP",95,0)
 .Q:$$DECEASED^WVUTL1($P(Y,U))
"RTN","WVRPSNP",96,0)
 .;---> TOTAL ACTIVE WOMEN IN REGISTER.
"RTN","WVRPSNP",97,0)
 .S A=A+1
"RTN","WVRPSNP",98,0)
 .;---> WOMEN PREGNANT.
"RTN","WVRPSNP",99,0)
 .I $P(Y,U,13)&($P(Y,U,14)>WVDT) S B=B+1
"RTN","WVRPSNP",100,0)
 .;---> DES DAUGHTERS.
"RTN","WVRPSNP",101,0)
 .S:$P(Y,U,15) C=C+1
"RTN","WVRPSNP",102,0)
 .;---> WOMEN WITH CERVICAL TX NEEDS NOT SPECIFIED OR NOT DATED.
"RTN","WVRPSNP",103,0)
 .;     Don't count if need is "Not Indicated"
"RTN","WVRPSNP",104,0)
 .I ($P(Y,U,11)'=WVCXTXND) I 5[$P(Y,U,11)!('$P(Y,U,12)) S D=D+1
"RTN","WVRPSNP",105,0)
 .;---> IF DATE DUE=NULL IT WAS COUNTED LINE ABOVE, SO DON'T COUNT
"RTN","WVRPSNP",106,0)
 .;---> IT IN THE LINE BELOW: +$P(Y,U,19).
"RTN","WVRPSNP",107,0)
 .;---> WOMEN WITH CERVICAL TX NEEDS SPECIFIED AND PAST DUE.
"RTN","WVRPSNP",108,0)
 .I ($P(Y,U,11)'=WVCXTXND) I 5'[$P(Y,U,11)&($P(Y,U,12)<WVDT)&(+$P(Y,U,12)) S E=E+1
"RTN","WVRPSNP",109,0)
 .;---> WOMEN WITH BREAST TX NEEDS NOT SPECIFIED OR NOT DATED.
"RTN","WVRPSNP",110,0)
 .;     Don't count if need is "Not Indicated"
"RTN","WVRPSNP",111,0)
 .I ($P(Y,U,18)'=WVBRTXND) I 8[$P(Y,U,18)!('$P(Y,U,19)) S F=F+1
"RTN","WVRPSNP",112,0)
 .;---> WOMEN WITH BREAST TX NEEDS SPECIFIED AND PAST DUE.
"RTN","WVRPSNP",113,0)
 .I ($P(Y,U,18)'=WVBRTXND) I 8'[$P(Y,U,18)&($P(Y,U,19)<WVDT)&(+$P(Y,U,19)) S G=G+1
"RTN","WVRPSNP",114,0)
 ;
"RTN","WVRPSNP",115,0)
 ;---> PROCEDURE DATA
"RTN","WVRPSNP",116,0)
 S N=0
"RTN","WVRPSNP",117,0)
 F  S N=$O(^WV(790.1,"S","o",N)) Q:'N  S Y=^WV(790.1,N,0) D
"RTN","WVRPSNP",118,0)
 .Q:"o"'[$P(Y,U,14)
"RTN","WVRPSNP",119,0)
 .Q:$P(Y,U,5)=8
"RTN","WVRPSNP",120,0)
 .S H=H+1 S:$P(Y,U,13)<WVDT S=S+1
"RTN","WVRPSNP",121,0)
 ;
"RTN","WVRPSNP",122,0)
 ;---> TOTAL PAPS, CBES, AND MAMS FOR THIS YEAR (SINCE JAN 1, OR FISCAL).
"RTN","WVRPSNP",123,0)
 S N=WVJDT,WVENDDT1=WVDT+.9999
"RTN","WVRPSNP",124,0)
 F  S N=$O(^WV(790.1,"D",N)) Q:'N!(N>WVENDDT1)  D
"RTN","WVRPSNP",125,0)
 .S M=0
"RTN","WVRPSNP",126,0)
 .F  S M=$O(^WV(790.1,"D",N,M)) Q:'M  S Y=^WV(790.1,M,0) D
"RTN","WVRPSNP",127,0)
 ..;---> BELOW IS HARD CODED FOR IENS IN ^WV(790.2, (PAP, CBE, OR MAM) AND
"RTN","WVRPSNP",128,0)
 ..;---> ^WV(790.31, (ERROR/DISREGARD).  COULD BE MORE ROBUST BY LOOKING
"RTN","WVRPSNP",129,0)
 ..;---> AT #.10 FIELD OF ^WV(790.2 AND #.23 FIELD OF ^WV(790.31,.
"RTN","WVRPSNP",130,0)
 ..Q:$P(Y,U,5)=8
"RTN","WVRPSNP",131,0)
 ..I $P(Y,U,4)=1 S P=P+1 Q                                    ;---> PAP
"RTN","WVRPSNP",132,0)
 ..I $P(Y,U,4)=25!($P(Y,U,4)=26)!($P(Y,U,4)=28) S Q=Q+1 Q     ;---> MAM
"RTN","WVRPSNP",133,0)
 ..I $P(Y,U,4)=27 S R=R+1                                     ;---> CBE
"RTN","WVRPSNP",134,0)
 ;
"RTN","WVRPSNP",135,0)
 ;---> NOTIFICATION DATA
"RTN","WVRPSNP",136,0)
 S N=0
"RTN","WVRPSNP",137,0)
 F  S N=$O(^WV(790.4,"AOPEN",N)) Q:'N  D
"RTN","WVRPSNP",138,0)
 .S M=0
"RTN","WVRPSNP",139,0)
 .F  S M=$O(^WV(790.4,"AOPEN",N,M)) Q:'M  D
"RTN","WVRPSNP",140,0)
 ..I '$D(^WV(790.4,M,0)) K ^WV(790.4,"AOPEN",N,M) Q
"RTN","WVRPSNP",141,0)
 ..S Y=^WV(790.4,M,0)
"RTN","WVRPSNP",142,0)
 ..S:$P(Y,U,14)="o" J=J+1
"RTN","WVRPSNP",143,0)
 ..S:$P(Y,U,14)="o"&($P(Y,U,13)<WVDT) K=K+1
"RTN","WVRPSNP",144,0)
 ;---> LETTERS QUEUED
"RTN","WVRPSNP",145,0)
 S N=0 F  S N=$O(^WV(790.4,"APRT",N)) Q:'N  D
"RTN","WVRPSNP",146,0)
 .S M=0 F  S M=$O(^WV(790.4,"APRT",N,M)) Q:'M  S L=L+1
"RTN","WVRPSNP",147,0)
R ;---> TREATMENT REFUSALS
"RTN","WVRPSNP",148,0)
 N WVREFPCE
"RTN","WVRPSNP",149,0)
 ;piece # and its value form a link for refusal counts
"RTN","WVRPSNP",150,0)
 ; (e.g., piece 1 has a value of 24). Entry #1 in File 790.2 is Pap Smear
"RTN","WVRPSNP",151,0)
 ; and the # of refused Pap Smears is stored in piece 24 (of node 2) 
"RTN","WVRPSNP",152,0)
 ; in File 790.71.
"RTN","WVRPSNP",153,0)
 S WVREFPCE="24^4^13^6^^^7^9^^^^^^^^^16^8^5^25^26^14^15^12^18^19^2^20^11^22^23^17^21^10^27^^3^1^28^29^30"
"RTN","WVRPSNP",154,0)
 F WA=1:1:41 D
"RTN","WVRPSNP",155,0)
 .S WB=$P(WVREFPCE,U,WA)
"RTN","WVRPSNP",156,0)
 .Q:'WB
"RTN","WVRPSNP",157,0)
 .S WVI(WB)=0
"RTN","WVRPSNP",158,0)
 S WA=WVJDT F  S WA=$O(^WV(790.3,"B",WA)) Q:WA'>0  D
"RTN","WVRPSNP",159,0)
 .S WB=0 F  S WB=$O(^WV(790.3,"B",WA,WB)) Q:WB'>0  D
"RTN","WVRPSNP",160,0)
 ..S N0=$G(^WV(790.3,WB,0))
"RTN","WVRPSNP",161,0)
 ..N P1 F P1=1,2,3,4 S P1(P1)=$P(N0,U,P1) S:P1(P1)="" P1(P1)="NOT ENTERED"
"RTN","WVRPSNP",162,0)
 ..Q:'P1(3)
"RTN","WVRPSNP",163,0)
 ..S WVCN=+$P(WVREFPCE,U,+P1(3)) Q:'WVCN
"RTN","WVRPSNP",164,0)
 ..S WVI(WVCN)=WVI(WVCN)+1
"RTN","WVRPSNP",165,0)
 Q
"RTN","WVRPSNP",166,0)
 ;
"RTN","WVRPSNP",167,0)
 ;
"RTN","WVRPSNP",168,0)
HELP1 ;EP
"RTN","WVRPSNP",169,0)
 ;;Answer "YES" to store the results of today's snapshot after they
"RTN","WVRPSNP",170,0)
 ;;have been printed out.  These results can then be retrieved in the
"RTN","WVRPSNP",171,0)
 ;;future (by calling up today's date) and compared to other Snapshots
"RTN","WVRPSNP",172,0)
 ;;in order to look at the trends and progress of your program over
"RTN","WVRPSNP",173,0)
 ;;time. (Note: If a previous snapshot for today has been run, it will
"RTN","WVRPSNP",174,0)
 ;;be overwritten by this or any later run today.)
"RTN","WVRPSNP",175,0)
 ;;
"RTN","WVRPSNP",176,0)
 ;;Answer "NO" to simply print today's Snapshot without storing it.
"RTN","WVRPSNP",177,0)
 S WVTAB=5,WVLINL="HELP1" D HELPTX
"RTN","WVRPSNP",178,0)
 Q
"RTN","WVRPSNP",179,0)
 ;
"RTN","WVRPSNP",180,0)
HELPTX ;EP
"RTN","WVRPSNP",181,0)
 N I,T,X S T=$$REPEAT^XLFSTR(" ",WVTAB)
"RTN","WVRPSNP",182,0)
 F I=1:1 S X=$T(@WVLINL+I) Q:X'[";;"  S DIR("?",I)=T_$P(X,";;",2)
"RTN","WVRPSNP",183,0)
 S DIR("?")=DIR("?",I-1) K DIR("?",I-1)
"RTN","WVRPSNP",184,0)
 Q
"RTN","WVRPSNP1")
0^15^B22704718
"RTN","WVRPSNP1",1,0)
WVRPSNP1 ;HCIOFO/FT,JR-REPORT: SNAPSHOT OF PROGRAM ;7/7/99  11:14
"RTN","WVRPSNP1",2,0)
 ;;1.0;WOMEN'S HEALTH;**7**;Sep 30, 1998
"RTN","WVRPSNP1",3,0)
 ;;  Original routine created by IHS/ANMC/MWR
"RTN","WVRPSNP1",4,0)
 ;;* MICHAEL REMILLARD, DDS * ALASKA NATIVE MEDICAL CENTER *
"RTN","WVRPSNP1",5,0)
 ;;  DISPLAY CODE FOR SNAPSHOT REPORT.  CALLED BY WVRPSNP.
"RTN","WVRPSNP1",6,0)
 ;
"RTN","WVRPSNP1",7,0)
 ;---> REQUIRED VARIABLES: WVDT=DATE SNAPSHOT WAS RUN.
"RTN","WVRPSNP1",8,0)
 ;--->                     WVFAC=FACILITY IEN IN ^DIC(4 - DUZ(2)
"RTN","WVRPSNP1",9,0)
 ;--->                     A-L,P,Q = FIELDS #.03-#.16 IN FILE 790.71
"RTN","WVRPSNP1",10,0)
 ;
"RTN","WVRPSNP1",11,0)
DISPLAY ;EP
"RTN","WVRPSNP1",12,0)
 U IO
"RTN","WVRPSNP1",13,0)
 S WVTOY=$S($D(WVTOY):WVTOY,1:M),WVPOP=0
"RTN","WVRPSNP1",14,0)
 I '$D(WVJDT) S WVJDT=$S(WVTOY="C":WVDT,$E(WVDT,4,5)>9:WVDT,1:WVDT-10000)
"RTN","WVRPSNP1",15,0)
 S WVJDTO=$S($G(WVTOY)="F":"Oct 1, ",1:"Jan 1, ")_($E($S($D(WVJDT):WVJDT,1:WVDT),1,3)+1700)_":"
"RTN","WVRPSNP1",16,0)
 S WVJTOY=$S(WVTOY="F":"Fiscal Year",1:"Calendar Year")
"RTN","WVRPSNP1",17,0)
 D HDR
"RTN","WVRPSNP1",18,0)
 ;
"RTN","WVRPSNP1",19,0)
 N X,Y
"RTN","WVRPSNP1",20,0)
 W !
"RTN","WVRPSNP1",21,0)
 S X="Total Active Women in Register:",Y=A D PNUM
"RTN","WVRPSNP1",22,0)
 S X="Women Who Are Pregnant:",Y=B D PNUM
"RTN","WVRPSNP1",23,0)
 ;S X="Woman Who Are DES Daughters:",Y=C D PNUM
"RTN","WVRPSNP1",24,0)
 S X="Women with Cervical Tx Needs not specified or not dated:",Y=D
"RTN","WVRPSNP1",25,0)
 D PNUM
"RTN","WVRPSNP1",26,0)
 S X="Women with Cervical Tx Needs specified and past due:",Y=E D PNUM
"RTN","WVRPSNP1",27,0)
 S X="Women with Breast Tx Needs not specified or not dated:",Y=F D PNUM
"RTN","WVRPSNP1",28,0)
 S X="Women with Breast Tx Needs specified and past due:",Y=G D PNUM
"RTN","WVRPSNP1",29,0)
 W !
"RTN","WVRPSNP1",30,0)
 S X="Total Number of Procedures with a Status of ""OPEN"":",Y=H D DOTS
"RTN","WVRPSNP1",31,0)
 S X="Number of OPEN Procedures Past Due (or not dated):",Y=S D DOTS
"RTN","WVRPSNP1",32,0)
 W:'WVCRT !
"RTN","WVRPSNP1",33,0)
 S X="Total Number of PAP Smears done since "_WVJDTO
"RTN","WVRPSNP1",34,0)
 S Y=P D DOTS G:WVPOP=1 EXIT
"RTN","WVRPSNP1",35,0)
 S X="Total Number of CBEs done since "_WVJDTO
"RTN","WVRPSNP1",36,0)
 S Y=R D DOTS G:WVPOP=1 EXIT
"RTN","WVRPSNP1",37,0)
 S X="Total Number of Mammograms done since "_WVJDTO
"RTN","WVRPSNP1",38,0)
 S Y=Q D DOTS G:WVPOP=1 EXIT
"RTN","WVRPSNP1",39,0)
 W !
"RTN","WVRPSNP1",40,0)
 S X="Total Number of Notifications with a Status of ""OPEN"":",Y=J
"RTN","WVRPSNP1",41,0)
 D DOTS G:WVPOP=1 EXIT
"RTN","WVRPSNP1",42,0)
 S X="Number of OPEN Notifications Past Due (or not dated):",Y=K D DOTS G:WVPOP=1 EXIT
"RTN","WVRPSNP1",43,0)
 S X="Number of Letters Queued (for later printing):",Y=L D DOTS G:WVPOP=1 EXIT
"RTN","WVRPSNP1",44,0)
 I $G(WVDTIEN)>0 S WVJX=$G(^WV(790.71,WVDTIEN,2)) D
"RTN","WVRPSNP1",45,0)
 .F P=1:1:30 S WVI(P)=$P(WVJX,U,P)
"RTN","WVRPSNP1",46,0)
 W !!,"   REFUSALS for TREATMENT:"
"RTN","WVRPSNP1",47,0)
 S X="Breast Ultrasounds:",Y=WVI(1) D DOTS G:WVPOP=1 EXIT
"RTN","WVRPSNP1",48,0)
 S X="Clinical Breast Exams:",Y=WVI(2) D DOTS G:WVPOP=1 EXIT
"RTN","WVRPSNP1",49,0)
 S X="Colposcopy Impression (No Bx):",Y=WVI(3) D DOTS G:WVPOP=1 EXIT
"RTN","WVRPSNP1",50,0)
 S X="Colposcopy W/Biopsy:",Y=WVI(4) D DOTS G:WVPOP=1 EXIT
"RTN","WVRPSNP1",51,0)
 S X="Cone Biopsy:",Y=WVI(5) D DOTS G:WVPOP=1 EXIT
"RTN","WVRPSNP1",52,0)
 S X="Cryotherapy:",Y=WVI(6) D DOTS G:WVPOP=1 EXIT
"RTN","WVRPSNP1",53,0)
 S X="Ectocervical Biopsy:",Y=WVI(7) D DOTS G:WVPOP=1 EXIT
"RTN","WVRPSNP1",54,0)
 S X="Endocervical Currettage:",Y=WVI(8) D DOTS G:WVPOP=1 EXIT
"RTN","WVRPSNP1",55,0)
 S X="Endometrial Biopsy:",Y=WVI(9) D DOTS G:WVPOP=1 EXIT
"RTN","WVRPSNP1",56,0)
 S X="Fine Needle Aspiration:",Y=WVI(10) D DOTS G:WVPOP=1 EXIT
"RTN","WVRPSNP1",57,0)
 S X="General Surgery Consults:",Y=WVI(11) D DOTS G:WVPOP=1 EXIT
"RTN","WVRPSNP1",58,0)
 S X="Gyn Onc Consults:",Y=WVI(12) D DOTS G:WVPOP=1 EXIT
"RTN","WVRPSNP1",59,0)
 S X="Hysterectomy:",Y=WVI(13) D DOTS G:WVPOP=1 EXIT
"RTN","WVRPSNP1",60,0)
 S X="Laser Abilation:",Y=WVI(14) D DOTS G:WVPOP=1 EXIT
"RTN","WVRPSNP1",61,0)
 S X="Laser Cone:",Y=WVI(15) D DOTS G:WVPOP=1 EXIT
"RTN","WVRPSNP1",62,0)
 S X="Leep:",Y=WVI(16) D DOTS G:WVPOP=1 EXIT
"RTN","WVRPSNP1",63,0)
 S X="Lumpectomy:",Y=WVI(17) D DOTS G:WVPOP=1 EXIT
"RTN","WVRPSNP1",64,0)
 S X="Mammogram Dx Bilat:",Y=WVI(18) D DOTS G:WVPOP=1 EXIT
"RTN","WVRPSNP1",65,0)
 S X="Mammogram Dx Unilat:",Y=WVI(19) D DOTS G:WVPOP=1 EXIT
"RTN","WVRPSNP1",66,0)
 S X="Mammogram Screening:",Y=WVI(20) D DOTS G:WVPOP=1 EXIT
"RTN","WVRPSNP1",67,0)
 S X="Mastectomy:",Y=WVI(21) D DOTS G:WVPOP=1 EXIT
"RTN","WVRPSNP1",68,0)
 S X="Needle Biopsy:",Y=WVI(22) D DOTS G:WVPOP=1 EXIT
"RTN","WVRPSNP1",69,0)
 S X="Open Biopsy:",Y=WVI(23) D DOTS G:WVPOP=1 EXIT
"RTN","WVRPSNP1",70,0)
 S X="Pap Smear:",Y=WVI(24) D DOTS G:WVPOP=1 EXIT
"RTN","WVRPSNP1",71,0)
 S X="Pelvic Ultrasound:",Y=WVI(29) D DOTS G:WVPOP=1 EXIT
"RTN","WVRPSNP1",72,0)
 S X="Pregnancy Test:",Y=WVI(25) D DOTS G:WVPOP=1 EXIT
"RTN","WVRPSNP1",73,0)
 S X="STD Evaluation:",Y=WVI(26) D DOTS G:WVPOP=1 EXIT
"RTN","WVRPSNP1",74,0)
 S X="Stereotactic Biopsy:",Y=WVI(27) D DOTS G:WVPOP=1 EXIT
"RTN","WVRPSNP1",75,0)
 S X="Tubal Ligation:",Y=WVI(28) D DOTS G:WVPOP=1 EXIT
"RTN","WVRPSNP1",76,0)
 S X="Vaginal Ultrasound:",Y=WVI(30) D DOTS G:WVPOP=1 EXIT
"RTN","WVRPSNP1",77,0)
SKIP D:'WVCRT
"RTN","WVRPSNP1",78,0)
 .N WVTITLE S WVTITLE="-----  End of Report  -----"
"RTN","WVRPSNP1",79,0)
 .D CENTERT^WVUTL5(.WVTITLE) W !!!,WVTITLE
"RTN","WVRPSNP1",80,0)
 I WVCRT&('$D(IO("S"))) D DIRZ^WVUTL3 W @IOF
"RTN","WVRPSNP1",81,0)
 D ^%ZISC
"RTN","WVRPSNP1",82,0)
 Q
"RTN","WVRPSNP1",83,0)
 ;
"RTN","WVRPSNP1",84,0)
PNUM ;EP
"RTN","WVRPSNP1",85,0)
 ;---> PATIENT NUMBERS
"RTN","WVRPSNP1",86,0)
 W:'WVCRT ! W !?3,X W $$REPEAT^XLFSTR(" .",(58-$L(X))/2)
"RTN","WVRPSNP1",87,0)
 W ?61,".",?62,$J(Y,5) W:A>0 ?69,$J(Y/A*100,3,0),"%"
"RTN","WVRPSNP1",88,0)
 Q
"RTN","WVRPSNP1",89,0)
 ;
"RTN","WVRPSNP1",90,0)
DOTS ;EP
"RTN","WVRPSNP1",91,0)
 I $Y+4>IOSL D:WVCRT&('$D(IO("S"))) DIRZ^WVUTL3 Q:$G(WVPOP)=1  D HDR
"RTN","WVRPSNP1",92,0)
 W:'WVCRT ! W !?3,X W $$REPEAT^XLFSTR(" .",(58-$L(X))/2)
"RTN","WVRPSNP1",93,0)
 W ?61,".",?62,$J(Y,5)
"RTN","WVRPSNP1",94,0)
 Q
"RTN","WVRPSNP1",95,0)
HDR ;EP
"RTN","WVRPSNP1",96,0)
 S WVTITLE="* * *  PROGRAM SNAPSHOT FOR "_$$TXDT^WVUTL5(WVDT)_"  * * *"
"RTN","WVRPSNP1",97,0)
 D CENTERT^WVUTL5(.WVTITLE)
"RTN","WVRPSNP1",98,0)
 D TOPHEAD1^WVUTL7,HEADER6^WVUTL7
"RTN","WVRPSNP1",99,0)
 Q
"RTN","WVRPSNP1",100,0)
CH ;
"RTN","WVRPSNP1",101,0)
 Q:$Y+4<IOSL
"RTN","WVRPSNP1",102,0)
 I WVCRT&('$D(IO("S"))) D DIRZ^WVUTL3 W @IOF
"RTN","WVRPSNP1",103,0)
 Q:WVPOP  D HDR
"RTN","WVRPSNP1",104,0)
 Q
"RTN","WVRPSNP1",105,0)
EXIT ;
"RTN","WVRPSNP1",106,0)
 D ^%ZISC,KILLALL^WVUTL8 Q
"RTN","WVRPSNP1",107,0)
 K ^TMP("WVF",$J),^TMP("WVREF",$J)
"RTN","WVRPSNP1",108,0)
 Q
"RTN","WVRPST")
0^6^B15157327
"RTN","WVRPST",1,0)
WVRPST ;HCIOFO/JR,FT-Sexual Trauma Summary ;5/24/99  16:24
"RTN","WVRPST",2,0)
 ;;1.0;WOMEN'S HEALTH;**7**;Sep 30, 1998
"RTN","WVRPST",3,0)
 ;
"RTN","WVRPST",4,0)
 W @IOF,!?33,"WOMEN'S HEALTH"
"RTN","WVRPST",5,0)
 W !?19,"* * *  SEXUAL TRAUMA SUMMARY REPORT  * * *",!
"RTN","WVRPST",6,0)
 K IO("Q") S %ZIS="Q" D ^%ZIS G EXIT:POP I $D(IO("Q")) D  Q
"RTN","WVRPST",7,0)
 .S ZTRTN="GET^WVRPST",ZTDESC="WH SEXUAL TRAUMA SUMMARY"
"RTN","WVRPST",8,0)
 .D ^%ZTLOAD D HOME^%ZIS K IO("Q")
"RTN","WVRPST",9,0)
GET ;get data for rpt
"RTN","WVRPST",10,0)
 U IO
"RTN","WVRPST",11,0)
 N DATA
"RTN","WVRPST",12,0)
 S (WVDFN,WVCNT,WVMV,WVM,WVCV,WVETCN,WVCIVCN,WVC,WVB,WVBV,WVCNALL)=0
"RTN","WVRPST",13,0)
 S (WVN,WVNV)=0
"RTN","WVRPST",14,0)
 F  S WVDFN=$O(^WV(790,WVDFN)) Q:WVDFN'>0  S WV0=$G(^(WVDFN,0)) D
"RTN","WVRPST",15,0)
 .S WVST=$P(WV0,U,27)
"RTN","WVRPST",16,0)
 .I '$$NOT(WVDFN) Q
"RTN","WVRPST",17,0)
 .S WVCNALL=WVCNALL+1
"RTN","WVRPST",18,0)
 .S WVET=$S($$GET1^DIQ(2,WVDFN,1901,"I")="Y":"V",1:"")
"RTN","WVRPST",19,0)
 .S:WVET="V" WVETCN=WVETCN+1 S:WVET'="V" WVCIVCN=WVCIVCN+1
"RTN","WVRPST",20,0)
 .Q:WVST=""  S WVCNT=WVCNT+1
"RTN","WVRPST",21,0)
 .S DATA="WV"_WVST_WVET
"RTN","WVRPST",22,0)
 .S @DATA=@DATA+1
"RTN","WVRPST",23,0)
 S WVMALL=WVM+WVMV,WVCALL=WVC+WVCV,WVBALL=WVB+WVBV
"RTN","WVRPST",24,0)
 S WVALL=WVMALL+WVCALL+WVBALL
"RTN","WVRPST",25,0)
 S WVVALL=WVMV+WVCV+WVBV,WVNALL=WVC+WVB+WVM
"RTN","WVRPST",26,0)
 D PRINT
"RTN","WVRPST",27,0)
EXIT ;
"RTN","WVRPST",28,0)
 D ^%ZISC
"RTN","WVRPST",29,0)
 D KILLALL^WVUTL8
"RTN","WVRPST",30,0)
 Q
"RTN","WVRPST",31,0)
PRINT ;Print with %'s based on total WH pats
"RTN","WVRPST",32,0)
 S WVCRT=$S($E(IOST)="C":1,1:0)
"RTN","WVRPST",33,0)
 D HEAD
"RTN","WVRPST",34,0)
 W !!?3,"Military Trauma",?24,$J(WVMV,5),?31,$$PER(WVMV,WVCNALL)
"RTN","WVRPST",35,0)
 W ?41,$J(WVM,6),?49,$$PER(WVM,WVCNT)
"RTN","WVRPST",36,0)
 W ?59,$J(WVMALL,5),?66,$$PER(WVMALL,WVCNALL)
"RTN","WVRPST",37,0)
 W !!?3,"Civilian Trauma",?24,$J(WVCV,5),?31,$$PER(WVCV,WVCNALL)
"RTN","WVRPST",38,0)
 W ?41,$J(WVC,6),?49,$$PER(WVC,WVCNALL)
"RTN","WVRPST",39,0)
 W ?59,$J(WVCALL,5),?66,$$PER(WVCALL,WVCNALL)
"RTN","WVRPST",40,0)
 W !!?3,"Both",?24,$J(WVBV,5),?31,$$PER(WVBV,WVCNALL)
"RTN","WVRPST",41,0)
 W ?41,$J(WVB,6),?49,$$PER(WVB,WVCNALL)
"RTN","WVRPST",42,0)
 W ?59,$J(WVBALL,5),?66,$$PER(WVBALL,WVCNALL)
"RTN","WVRPST",43,0)
 W !!?2,$$REPEAT^XLFSTR("-",76)
"RTN","WVRPST",44,0)
 W !,?3,"TOTALS",?24,$J(WVVALL,5),?31,$$PER(WVVALL,WVCNALL)
"RTN","WVRPST",45,0)
 W ?41,$J(WVNALL,6),?49,$$PER(WVNALL,WVCNALL)
"RTN","WVRPST",46,0)
 W ?59,$J(WVALL,5),?66,$$PER(WVALL,WVCNALL)
"RTN","WVRPST",47,0)
 W !,"  ",$$REPEAT^XLFSTR("-",76)
"RTN","WVRPST",48,0)
 W !?5," TOTAL WH PATIENTS ------->",$J(WVCNALL,5)
"RTN","WVRPST",49,0)
 W !?5,"TOTAL VETERAN PATIENTS --->",$J(WVETCN,5)
"RTN","WVRPST",50,0)
 W !?5,"TOTAL NON-VET PATIENTS --->",$J(WVCIVCN,5)
"RTN","WVRPST",51,0)
 W !!?12,"Above percentages are based on Total Active Women patients"
"RTN","WVRPST",52,0)
 W !?22,"in the Women's Health Database."
"RTN","WVRPST",53,0)
 S WVPOP=0
"RTN","WVRPST",54,0)
 I WVCRT&('$D(IO("S")))&('POP) D DIRZ^WVUTL3 W @IOF,!
"RTN","WVRPST",55,0)
 Q
"RTN","WVRPST",56,0)
MORE ;Print with %'s based on type of patient (vet! non-vet)
"RTN","WVRPST",57,0)
 D HEAD
"RTN","WVRPST",58,0)
 W !!?3,"Military Trauma",?24,$J(WVMV,5),?31,$$PER(WVMV,WVETCN)
"RTN","WVRPST",59,0)
 W ?41,$J(WVM,6),?49,$$PER(WVM,WVCNT)
"RTN","WVRPST",60,0)
 W !!?3,"Civilian Trauma",?24,$J(WVCV,5),?31,$$PER(WVCV,WVETCN)
"RTN","WVRPST",61,0)
 W ?41,$J(WVC,6),?49,$$PER(WVC,WVCIVCN)
"RTN","WVRPST",62,0)
 W !!?3,"Both",?24,$J(WVBV,5),?31,$$PER(WVBV,WVETCN)
"RTN","WVRPST",63,0)
 W ?41,$J(WVB,6),?49,$$PER(WVB,WVCIVCN)
"RTN","WVRPST",64,0)
 W !!?2,$$REPEAT^XLFSTR("-",76)
"RTN","WVRPST",65,0)
 W !,?3,"TOTALS",?24,$J(WVVALL,5),?31,$$PER(WVVALL,WVETCN)
"RTN","WVRPST",66,0)
 W ?41,$J(WVNALL,6),?49,$$PER(WVNALL,WVCIVCN)
"RTN","WVRPST",67,0)
 W !,"  ",$$REPEAT^XLFSTR("-",76)
"RTN","WVRPST",68,0)
 W !?5," TOTAL WH PATIENTS ------->",$J(WVCNALL,5)
"RTN","WVRPST",69,0)
 W !?5,"TOTAL VETERAN PATIENTS --->",$J(WVETCN,5)
"RTN","WVRPST",70,0)
 W !?5,"TOTAL NON-VET PATIENTS --->",$J(WVCIVCN,5)
"RTN","WVRPST",71,0)
 W !!?12,"Here Vet percentages are based on Total Active Vet patients."
"RTN","WVRPST",72,0)
 W !?11,"Non-Vet percentages are based on Total Active Non-Vet patients."
"RTN","WVRPST",73,0)
 I WVCRT&('$D(IO("S")))&('POP) D DIRZ^WVUTL3 W @IOF,!
"RTN","WVRPST",74,0)
 Q
"RTN","WVRPST",75,0)
HEAD ;
"RTN","WVRPST",76,0)
 W:$Y>0 @IOF
"RTN","WVRPST",77,0)
 W !?26,"SEXUAL TRAUMA SUMMARY REPORT",!!
"RTN","WVRPST",78,0)
 W ?3,$$RUNDT^WVUTL1A()
"RTN","WVRPST",79,0)
 W !,$$REPEAT^XLFSTR("=",80)
"RTN","WVRPST",80,0)
 W !?3,"Sexual Trauma",?27,"Veterans",?43,"Non-Veterans"
"RTN","WVRPST",81,0)
 W ?60,"Vets & Non-Vets"
"RTN","WVRPST",82,0)
 W !,"  ",$$REPEAT^XLFSTR("-",76)
"RTN","WVRPST",83,0)
 Q
"RTN","WVRPST",84,0)
NOT(WVDFN) ;Screen out patients for Inactive & Dead
"RTN","WVRPST",85,0)
 N TEST
"RTN","WVRPST",86,0)
 S TEST=$$GET1^DIQ(2,WVDFN,.351,"I")
"RTN","WVRPST",87,0)
 Q:TEST>0 0
"RTN","WVRPST",88,0)
 S TEST=$P($G(^WV(790,WVDFN,0)),U,24)
"RTN","WVRPST",89,0)
 Q:TEST>0 0
"RTN","WVRPST",90,0)
 Q 1
"RTN","WVRPST",91,0)
PER(WVX,WVY) ;
"RTN","WVRPST",92,0)
 Q:WVY'>0!(WVX'>0) "(  0%)"
"RTN","WVRPST",93,0)
 N WVR S WVR=WVX/WVY*100,WVR(1)=$E($P(WVR,".",2)),WVR=$P(WVR,".")
"RTN","WVRPST",94,0)
 S WVR=$S(WVR<1:"."_WVR(1),WVR(1)>4:WVR+1,1:WVR)
"RTN","WVRPST",95,0)
 S WVR="("_$E("   ",1,3-$L(WVR))_WVR_"%)"
"RTN","WVRPST",96,0)
 Q WVR
"RTN","WVUTL1")
0^3^B39200608
"RTN","WVUTL1",1,0)
WVUTL1 ;HCIOFO/FT,JR-UTIL: MOSTLY PATIENT DATA  ;10/11/99  14:31
"RTN","WVUTL1",2,0)
 ;;1.0;WOMEN'S HEALTH;**7**;Sep 30, 1998
"RTN","WVUTL1",3,0)
 ;;  Original routine created by IHS/ANMC/MWR
"RTN","WVUTL1",4,0)
 ;;* MICHAEL REMILLARD, DDS * ALASKA NATIVE MEDICAL CENTER *
"RTN","WVUTL1",5,0)
 ;;  UTILITY: PATIENT DEMOGRAPHICS, NEEDS, AND REGIMENS.
"RTN","WVUTL1",6,0)
 ;;  ALSO DISPLAY PRIORITY, PROCEDURE TYPE.
"RTN","WVUTL1",7,0)
 ;
"RTN","WVUTL1",8,0)
 ;
"RTN","WVUTL1",9,0)
NAME(DFN) ;EP
"RTN","WVUTL1",10,0)
 ;---> PATIENT NAME.
"RTN","WVUTL1",11,0)
 ;---> REQUIRED VARIABLE: DFN=IEN PATIENT FILE
"RTN","WVUTL1",12,0)
 Q:'$G(DFN) "NO PATIENT"
"RTN","WVUTL1",13,0)
 Q:'$D(^DPT(DFN,0)) "UNKNOWN"
"RTN","WVUTL1",14,0)
 Q $P(^DPT(DFN,0),U)
"RTN","WVUTL1",15,0)
 ;
"RTN","WVUTL1",16,0)
DOB(DFN) ;EP
"RTN","WVUTL1",17,0)
 ;---> RETURN PATIENT'S DATE OF BIRTH IN FILEMAN FORMAT.
"RTN","WVUTL1",18,0)
 ;---> REQUIRED VARIABLE: DFN=IEN PATIENT FILE
"RTN","WVUTL1",19,0)
 Q:'$G(DFN) "NO PATIENT"
"RTN","WVUTL1",20,0)
 Q:'$P($G(^DPT(DFN,0)),U,3) "UNKNOWN"
"RTN","WVUTL1",21,0)
 Q $P(^DPT(DFN,0),U,3)
"RTN","WVUTL1",22,0)
 ;
"RTN","WVUTL1",23,0)
 ;
"RTN","WVUTL1",24,0)
AGE(DFN) ;EP
"RTN","WVUTL1",25,0)
 ;---> YIELD PATIENT'S AGE IN YEARS.
"RTN","WVUTL1",26,0)
 ;---> REQUIRED VARIABLE: DFN=IEN PATIENT FILE
"RTN","WVUTL1",27,0)
 N X,X1,X2
"RTN","WVUTL1",28,0)
 Q:'$G(DFN) "NO PATIENT"
"RTN","WVUTL1",29,0)
 S X2=$$DOB(DFN)
"RTN","WVUTL1",30,0)
 Q:'+X2 "UNKNOWN"
"RTN","WVUTL1",31,0)
 I $$DECEASED(DFN) Q "DECEASED: "_$$SLDT2^WVUTL5(+^DPT(DFN,.35))
"RTN","WVUTL1",32,0)
 S X1=DT
"RTN","WVUTL1",33,0)
 D ^%DTC
"RTN","WVUTL1",34,0)
 Q $P(X/365.25,".")_"y/o"
"RTN","WVUTL1",35,0)
 ;
"RTN","WVUTL1",36,0)
DECEASED(DFN) ;EP
"RTN","WVUTL1",37,0)
 ;---> RETURN 1 IF PATIENT IS DECEASED, 0 IF NOT DECEASED.
"RTN","WVUTL1",38,0)
 ;---> REQUIRED VARIABLE: DFN=IEN PATIENT FILE
"RTN","WVUTL1",39,0)
 Q:'$G(DFN) 0
"RTN","WVUTL1",40,0)
 Q:'$D(^DPT(DFN,.35)) 0
"RTN","WVUTL1",41,0)
 Q:'+^DPT(DFN,.35) 0
"RTN","WVUTL1",42,0)
 Q 1
"RTN","WVUTL1",43,0)
 ;
"RTN","WVUTL1",44,0)
SEX(DFN) ;EP
"RTN","WVUTL1",45,0)
 ;---> RETURN 1 IF PATIENT IS FEMALE.
"RTN","WVUTL1",46,0)
 ;---> REQUIRED VARIABLE: DFN=IEN PATIENT FILE
"RTN","WVUTL1",47,0)
 Q:'$G(DFN) ""
"RTN","WVUTL1",48,0)
 Q:'$D(^DPT(DFN,0)) ""
"RTN","WVUTL1",49,0)
 Q:$P(^DPT(DFN,0),U,2)'="F" ""
"RTN","WVUTL1",50,0)
 Q 1
"RTN","WVUTL1",51,0)
 ;
"RTN","WVUTL1",52,0)
INACT(DFN) ;EP
"RTN","WVUTL1",53,0)
 ;---> DATE THIS PATIENT BECAME INACTIVE
"RTN","WVUTL1",54,0)
 ;---> REQUIRED VARIABLE: DFN=IEN PATIENT FILE
"RTN","WVUTL1",55,0)
 Q:'$G(DFN) "NO PATIENT"
"RTN","WVUTL1",56,0)
 Q:'$D(^DPT(DFN,0)) "UNKNOWN"
"RTN","WVUTL1",57,0)
 Q $P(^WV(790,DFN,0),U,24)
"RTN","WVUTL1",58,0)
 ;
"RTN","WVUTL1",59,0)
AGEAT(DFN,DATE) ;EP
"RTN","WVUTL1",60,0)
 ;---> YIELD PATIENT'S AGE IN YEARS AT GIVEN DATE.
"RTN","WVUTL1",61,0)
 ;---> REQUIRED VARIABLE: DFN =IEN PATIENT FILE
"RTN","WVUTL1",62,0)
 ;--->                    DATE=DATE AT WHICH AGE IS DESIRED.
"RTN","WVUTL1",63,0)
 N X,X1,X2
"RTN","WVUTL1",64,0)
 Q:'$G(DFN) "NO PATIENT"
"RTN","WVUTL1",65,0)
 Q:'$G(DATE) "NO DATE"
"RTN","WVUTL1",66,0)
 S X2=$$DOB(DFN)
"RTN","WVUTL1",67,0)
 Q:'+X2 "UNKNOWN"
"RTN","WVUTL1",68,0)
 S X1=DATE
"RTN","WVUTL1",69,0)
 D ^%DTC
"RTN","WVUTL1",70,0)
 Q $P(X/365.25,".")_"y/o"
"RTN","WVUTL1",71,0)
 ;
"RTN","WVUTL1",72,0)
NAMAGE(DFN) ;EP
"RTN","WVUTL1",73,0)
 ;---> PATIENT NAME CONCAT WITH AGE.
"RTN","WVUTL1",74,0)
 ;---> REQUIRED VARIABLE: DFN=IEN PATIENT FILE
"RTN","WVUTL1",75,0)
 Q:'$G(DFN) "NO PATIENT"
"RTN","WVUTL1",76,0)
 Q $$NAME(DFN)_" ("_$$AGE(DFN)_")"
"RTN","WVUTL1",77,0)
 ;
"RTN","WVUTL1",78,0)
SSN(DFN) ;EP
"RTN","WVUTL1",79,0)
 ;---> SOCIAL SECURITY NUMBER.
"RTN","WVUTL1",80,0)
 ;---> REQUIRED VARIABLE: DFN=IEN PATIENT FILE
"RTN","WVUTL1",81,0)
 N X
"RTN","WVUTL1",82,0)
 Q:'$G(DFN) "NO PATIENT"
"RTN","WVUTL1",83,0)
 Q:'$D(^DPT(DFN,0)) "UNKNOWN"
"RTN","WVUTL1",84,0)
 S X=$P(^DPT(DFN,0),U,9)
"RTN","WVUTL1",85,0)
 Q:X']"" "UNKNOWN"
"RTN","WVUTL1",86,0)
 S X=$E(X,1,3)_"-"_$E(X,4,5)_"-"_$E(X,6,9)
"RTN","WVUTL1",87,0)
 Q X
"RTN","WVUTL1",88,0)
 ;
"RTN","WVUTL1",89,0)
HRCN(DFN) ;EP
"RTN","WVUTL1",90,0)
 ;---> RETURN SSN.
"RTN","WVUTL1",91,0)
 ;---> REQUIRED VARIABLE: DFN
"RTN","WVUTL1",92,0)
 Q $$SSN(DFN)
"RTN","WVUTL1",93,0)
 ;
"RTN","WVUTL1",94,0)
HPHONE(DFN) ;EP
"RTN","WVUTL1",95,0)
 ;---> GET HOME PHONE#.
"RTN","WVUTL1",96,0)
 ;---> REQUIRED VARIABLE: DFN=IEN PATIENT FILE
"RTN","WVUTL1",97,0)
 N WVPHONE
"RTN","WVUTL1",98,0)
 Q:'$G(DFN) "NO PATIENT"
"RTN","WVUTL1",99,0)
 S WVPHONE=$$GET1^DIQ(2,DFN,.131,"I")
"RTN","WVUTL1",100,0)
 Q:WVPHONE="" "UNKNOWN"
"RTN","WVUTL1",101,0)
 Q WVPHONE
"RTN","WVUTL1",102,0)
 ;
"RTN","WVUTL1",103,0)
STREET(DFN) ;EP
"RTN","WVUTL1",104,0)
 ;---> GET STREET ADDRESS.
"RTN","WVUTL1",105,0)
 ;---> REQUIRED VARIABLE: DFN=IEN PATIENT FILE
"RTN","WVUTL1",106,0)
 Q:'$G(DFN) "NO PATIENT"
"RTN","WVUTL1",107,0)
 N WVADDR
"RTN","WVUTL1",108,0)
 S WVADDR=$$GET1^DIQ(2,DFN,.111,"I")
"RTN","WVUTL1",109,0)
 Q:WVADDR="" "UNKNOWN"
"RTN","WVUTL1",110,0)
 Q WVADDR
"RTN","WVUTL1",111,0)
 ;
"RTN","WVUTL1",112,0)
CITY(DFN) ;EP
"RTN","WVUTL1",113,0)
 ;---> GET CITY ADDRESS.
"RTN","WVUTL1",114,0)
 ;---> REQUIRED VARIABLE: DFN=IEN PATIENT FILE
"RTN","WVUTL1",115,0)
 Q:'$G(DFN) "NO PATIENT"
"RTN","WVUTL1",116,0)
 N WVCITY
"RTN","WVUTL1",117,0)
 S WVCITY=$$GET1^DIQ(2,DFN,.114,"I")
"RTN","WVUTL1",118,0)
 Q:WVCITY="" "UNKNOWN"
"RTN","WVUTL1",119,0)
 Q WVCITY
"RTN","WVUTL1",120,0)
 ;
"RTN","WVUTL1",121,0)
STATE(DFN) ;EP
"RTN","WVUTL1",122,0)
 ;---> GET STATE ADDRESS.
"RTN","WVUTL1",123,0)
 ;---> REQUIRED VARIABLE: DFN=IEN PATIENT FILE
"RTN","WVUTL1",124,0)
 Q:'$G(DFN) "NO PATIENT"
"RTN","WVUTL1",125,0)
 N WVSTATE
"RTN","WVUTL1",126,0)
 S WVSTATE=$$GET1^DIQ(2,DFN,.115,"I")
"RTN","WVUTL1",127,0)
 Q:WVSTATE="" "UNKNOWN"
"RTN","WVUTL1",128,0)
 S WVSTATE=$$GET1^DIQ(5,WVSTATE,1,"I") S:WVSTATE="" WVSTATE="UNKNOWN"
"RTN","WVUTL1",129,0)
 Q WVSTATE
"RTN","WVUTL1",130,0)
 ;
"RTN","WVUTL1",131,0)
ZIP(DFN) ;EP
"RTN","WVUTL1",132,0)
 ;---> GET ZIPCODE ADDRESS.
"RTN","WVUTL1",133,0)
 ;---> REQUIRED VARIABLE: DFN=IEN PATIENT FILE
"RTN","WVUTL1",134,0)
 Q:'$G(DFN) "NO PATIENT"
"RTN","WVUTL1",135,0)
 N WVZIP
"RTN","WVUTL1",136,0)
 S WVZIP=$$GET1^DIQ(2,DFN,.116,"I")
"RTN","WVUTL1",137,0)
 Q:WVZIP'>0 "UNKNOWN"
"RTN","WVUTL1",138,0)
 Q WVZIP
"RTN","WVUTL1",139,0)
 ;
"RTN","WVUTL1",140,0)
CTYSTZ(DFN) ;EP
"RTN","WVUTL1",141,0)
 ;---> GET ZIPCODE ADDRESS.
"RTN","WVUTL1",142,0)
 ;---> REQUIRED VARIABLE: DFN=IEN PATIENT FILE
"RTN","WVUTL1",143,0)
 Q:'$G(DFN) "NO PATIENT"
"RTN","WVUTL1",144,0)
 Q $$CITY(DFN)_", "_$$STATE(DFN)_"  "_$$ZIP(DFN)
"RTN","WVUTL1",145,0)
 ;
"RTN","WVUTL1",146,0)
CMGR(DFN) ;EP
"RTN","WVUTL1",147,0)
 ;---> YIELD PATIENT'S CASE MANAGER.
"RTN","WVUTL1",148,0)
 ;---> REQUIRED VARIABLE: DFN=IEN PATIENT FILE
"RTN","WVUTL1",149,0)
 N X
"RTN","WVUTL1",150,0)
 Q:'$G(DFN) "NO PATIENT"
"RTN","WVUTL1",151,0)
 Q:'$D(^WV(790,DFN,0)) "UNKNOWN"
"RTN","WVUTL1",152,0)
 S X=$P(^WV(790,DFN,0),U,10)
"RTN","WVUTL1",153,0)
 Q $$PERSON(X)
"RTN","WVUTL1",154,0)
 ;
"RTN","WVUTL1",155,0)
PERSON(X) ;EP
"RTN","WVUTL1",156,0)
 ;---> RETURN PERSON'S NAME FROM FILE #200.
"RTN","WVUTL1",157,0)
 N WVNAME
"RTN","WVUTL1",158,0)
 Q:'X "UNKNOWN"
"RTN","WVUTL1",159,0)
 S WVNAME=$$GET1^DIQ(200,X,.01,"E")
"RTN","WVUTL1",160,0)
 Q $S(WVNAME'="":WVNAME,1:"UNKNOWN")
"RTN","WVUTL1",161,0)
 ;
"RTN","WVUTL1",162,0)
EDC(DFN) ;EP
"RTN","WVUTL1",163,0)
 ;---> YIELD IF PATIENT IS PREGNANT, AND EDC.
"RTN","WVUTL1",164,0)
 ;---> REQUIRED VARIABLE: DFN=IEN PATIENT FILE
"RTN","WVUTL1",165,0)
 N X,Y
"RTN","WVUTL1",166,0)
 Q:'$G(DFN) "NO PATIENT"
"RTN","WVUTL1",167,0)
 Q:'$D(^WV(790,DFN,0)) "UNKNOWN"
"RTN","WVUTL1",168,0)
 S Y=$P(^WV(790,DFN,0),U,13)
"RTN","WVUTL1",169,0)
 S X=$P(^WV(790,DFN,0),U,14)
"RTN","WVUTL1",170,0)
 Q:'Y ""
"RTN","WVUTL1",171,0)
 S Y=" PREGNANT"
"RTN","WVUTL1",172,0)
 Q Y_", EDC: "_$S(X:$$SLDT2^WVUTL5(X),1:"NO DATE ")_" "
"RTN","WVUTL1",173,0)
 ;
"RTN","WVUTL1",174,0)
PAPRG(DFN,TXDT) ;EP
"RTN","WVUTL1",175,0)
 ;---> YIELD PATIENT'S PAP REGIMEN AND DATE IT BEGAN.
"RTN","WVUTL1",176,0)
 ;---> REQUIRED VARIABLE: DFN=IEN PATIENT FILE
"RTN","WVUTL1",177,0)
 ;---> OPTIONAL VARIABLE: TXDT=1 IF DATE SHOULD BE TEXT FORMAT.
"RTN","WVUTL1",178,0)
 N Y,X
"RTN","WVUTL1",179,0)
 Q:'$G(DFN) "NO PATIENT"
"RTN","WVUTL1",180,0)
 Q:'$D(^WV(790,DFN,0)) "UNKNOWN"
"RTN","WVUTL1",181,0)
 S Y=$P(^WV(790,DFN,0),U,16)
"RTN","WVUTL1",182,0)
 S X=$P(^WV(790,DFN,0),U,17) D Z(.X,$G(TXDT))
"RTN","WVUTL1",183,0)
 Q $$PAPRG1(Y)_" (began "_X_")"
"RTN","WVUTL1",184,0)
 ;
"RTN","WVUTL1",185,0)
PAPRG1(PREG) ;EP
"RTN","WVUTL1",186,0)
 ;---> YIELD PATIENT'S PAP REGIMEN.
"RTN","WVUTL1",187,0)
 ;---> REQUIRED VARIABLE: PREG=IEN IN WV PAP REGIMEN FILE #790.03.
"RTN","WVUTL1",188,0)
 Q:'$G(PREG) "UNKNOWN"
"RTN","WVUTL1",189,0)
 Q:'$D(^WV(790.03,PREG,0)) "PAP REGIMEN MISSING"
"RTN","WVUTL1",190,0)
 Q $P(^WV(790.03,PREG,0),U)
"RTN","WVUTL1",191,0)
 ;
"RTN","WVUTL1",192,0)
CNEED(DFN,TXDT) ;PEP
"RTN","WVUTL1",193,0)
 ;---> YIELD PATIENT'S CX TX NEED AND CX TX NEED DUE DATE.
"RTN","WVUTL1",194,0)
 ;---> REQUIRED VARIABLE: DFN=IEN PATIENT FILE
"RTN","WVUTL1",195,0)
 ;---> OPTIONAL VARIABLE: TXDT=1 IF DATE SHOULD BE TEXT FORMAT.
"RTN","WVUTL1",196,0)
 N X,Y
"RTN","WVUTL1",197,0)
 Q:'$G(DFN) "NO PATIENT"
"RTN","WVUTL1",198,0)
 Q:'$D(^WV(790,DFN,0)) "UNKNOWN"
"RTN","WVUTL1",199,0)
 S Y=$P(^WV(790,DFN,0),U,11)
"RTN","WVUTL1",200,0)
 Q:'Y "UNKNOWN"
"RTN","WVUTL1",201,0)
 Q:'$D(^WV(790.5,Y,0)) "UNKNOWN"
"RTN","WVUTL1",202,0)
 S X=$P(^WV(790,DFN,0),U,12) D Z(.X,$G(TXDT))
"RTN","WVUTL1",203,0)
 Q $E($P(^WV(790.5,Y,0),U),1,22)_" (by "_X_")"
"RTN","WVUTL1",204,0)
 ;
"RTN","WVUTL1",205,0)
BNEED(DFN,TXDT) ;PEP
"RTN","WVUTL1",206,0)
 ;---> YIELD PATIENT'S BR TX NEED AND BR TX NEED DUE DATE.
"RTN","WVUTL1",207,0)
 ;---> REQUIRED VARIABLE: DFN=IEN PATIENT FILE
"RTN","WVUTL1",208,0)
 ;---> OPTIONAL VARIABLE: TXDT=1 IF DATE SHOULD BE TEXT FORMAT.
"RTN","WVUTL1",209,0)
 N X,Y,Z
"RTN","WVUTL1",210,0)
 Q:'$G(DFN) "NO PATIENT"
"RTN","WVUTL1",211,0)
 Q:'$D(^WV(790,DFN,0)) "UNKNOWN"
"RTN","WVUTL1",212,0)
 S Y=$P(^WV(790,DFN,0),U,18)
"RTN","WVUTL1",213,0)
 Q:'Y "UNKNOWN"
"RTN","WVUTL1",214,0)
 Q:'$D(^WV(790.51,Y,0)) "UNKNOWN"
"RTN","WVUTL1",215,0)
 S X=$P(^WV(790,DFN,0),U,19) D Z(.X,$G(TXDT))
"RTN","WVUTL1",216,0)
 Q $E($P(^WV(790.51,Y,0),U),1,22)_" (by "_X_")"
"RTN","WVUTL1",217,0)
 ;
"RTN","WVUTL1",218,0)
DES(DFN) ;EP
"RTN","WVUTL1",219,0)
 ;---> YIELD PATIENT'S STATUS AS A DES DAUGHTER: 1=YES, 0=NO.
"RTN","WVUTL1",220,0)
 ;---> DFN=IEN PATIENT FILE
"RTN","WVUTL1",221,0)
 Q:'$G(DFN) "NO PATIENT"
"RTN","WVUTL1",222,0)
 Q:'$D(^WV(790,DFN,0)) "NO RECORD"
"RTN","WVUTL1",223,0)
 I '$$VFIELD^DILFD(790,.15) Q "^DD MISSING"
"RTN","WVUTL1",224,0)
 S X=$P(^WV(790,DFN,0),U,15)
"RTN","WVUTL1",225,0)
 Q:X="" ""
"RTN","WVUTL1",226,0)
 Q $$EXTERNAL^DILFD(790,.15,"",X)
"RTN","WVUTL1",227,0)
 ;
"RTN","WVUTL1",228,0)
FAMHX(DFN) ;EP
"RTN","WVUTL1",229,0)
 ;---> RETURN FAMILY HISTORY OF BREAST CANCER.
"RTN","WVUTL1",230,0)
 ;---> DFN=IEN PATIENT FILE
"RTN","WVUTL1",231,0)
 N X
"RTN","WVUTL1",232,0)
 Q:'$G(DFN) "NO PATIENT"
"RTN","WVUTL1",233,0)
 Q:'$D(^WV(790,DFN,0)) "NO RECORD"
"RTN","WVUTL1",234,0)
 I '$$VFIELD^DILFD(790,.23) Q "^DD MISSING"
"RTN","WVUTL1",235,0)
 S X=$P(^WV(790,DFN,0),U,23)
"RTN","WVUTL1",236,0)
 Q:X="" ""
"RTN","WVUTL1",237,0)
 Q $$EXTERNAL^DILFD(790,.23,"",X)
"RTN","WVUTL1",238,0)
 ;
"RTN","WVUTL1",239,0)
REFS(DFN) ;EP
"RTN","WVUTL1",240,0)
 ;---> RETURN REFERRAL SOURCE FOR THIS PATIENT.
"RTN","WVUTL1",241,0)
 ;---> DFN=IEN PATIENT FILE
"RTN","WVUTL1",242,0)
 Q:'$G(DFN) "NO PATIENT"
"RTN","WVUTL1",243,0)
 Q:'$D(^WV(790,DFN,0)) "UNKNOWN"
"RTN","WVUTL1",244,0)
 I '$$VFIELD^DILFD(790,.22) Q "^DD MISSING"
"RTN","WVUTL1",245,0)
 S X=$P(^WV(790,DFN,0),U,22) S:X>0 X=$P($G(^WV(790.07,X,0)),U)
"RTN","WVUTL1",246,0)
 Q X
"RTN","WVUTL1",247,0)
 ;
"RTN","WVUTL1",248,0)
ENRLDT(DFN,TXDT) ;PEP
"RTN","WVUTL1",249,0)
 ;---> YIELD PATIENT'S ENROLLMENT DATE.
"RTN","WVUTL1",250,0)
 ;---> REQUIRED VARIABLE: DFN=IEN PATIENT FILE
"RTN","WVUTL1",251,0)
 ;---> OPTIONAL VARIABLE: TXDT=1 IF DATE SHOULD BE IN TEXT FORMAT.
"RTN","WVUTL1",252,0)
 N X
"RTN","WVUTL1",253,0)
 Q:'$G(DFN) "NO PATIENT"
"RTN","WVUTL1",254,0)
 Q:'$D(^WV(790,DFN,0)) "UNKNOWN"
"RTN","WVUTL1",255,0)
 S X=$P(^WV(790,DFN,0),U,21)
"RTN","WVUTL1",256,0)
 Q:'X ""  D Z(.X,$G(TXDT))
"RTN","WVUTL1",257,0)
 Q X
"RTN","WVUTL1",258,0)
 ;
"RTN","WVUTL1",259,0)
Z(X,Z) ;EP
"RTN","WVUTL1",260,0)
 ;---> SET Z = NUMERIC (1/1/95) OR TEXT (JAN 1,1995) FORMAT OF DATE.
"RTN","WVUTL1",261,0)
 ;---> REQUIRED VARIABLE:  X=FILEMAN INTERNAL DATE FORMAT.
"RTN","WVUTL1",262,0)
 ;---> OPTIONAL VARIABLE: Z=1 IF TEXT, 0/"" IF NUMERIC.
"RTN","WVUTL1",263,0)
 S X=$S($G(Z):$$TXDT^WVUTL5(X),1:$$SLDT2^WVUTL5(X))
"RTN","WVUTL1",264,0)
 Q
"RTN","WVUTL1",265,0)
 ;
"RTN","WVUTL1",266,0)
 ;
"RTN","WVUTL1",267,0)
ACC(IEN) ;EP
"RTN","WVUTL1",268,0)
 ;---> ACCESSION#; CONCATENATE SCREENING PAP IF IT EXISTS.
"RTN","WVUTL1",269,0)
 ;---> IEN=IEN IN WV PROCEDURE FILE #790.1).
"RTN","WVUTL1",270,0)
 Q:'$G(IEN) "NO PROC"
"RTN","WVUTL1",271,0)
 Q:'$D(^WV(790.1,IEN,0)) "NO PROC"
"RTN","WVUTL1",272,0)
 N X S X=$P(^WV(790.1,IEN,0),U,30)
"RTN","WVUTL1",273,0)
 I X]"" I $D(^WV(790.1,X,0)) S X=$P(^WV(790.1,X,0),U),X=","_X
"RTN","WVUTL1",274,0)
 Q $E($P(^WV(790.1,IEN,0),U)_X,1,19)
"RTN","WVUTL1A")
0^4^B35324430
"RTN","WVUTL1A",1,0)
WVUTL1A ;HCIOFO/JR,FT-Continuation of ^WVUTL1 (Utilities) ;10/11/99  14:15
"RTN","WVUTL1A",2,0)
 ;;1.0;WOMEN'S HEALTH;**4,7**;Sep 30, 1998
"RTN","WVUTL1A",3,0)
 ;;
"RTN","WVUTL1A",4,0)
PRIOR() ;EP
"RTN","WVUTL1A",5,0)
 ;---> CALLED FROM WV NOTIF-EDITBLK-1 TO GET VALUE AND TEXT OF
"RTN","WVUTL1A",6,0)
 ;---> NOTIFICATION PRIORITY AND RESULT/REMINDER, FROM PURPOSE OF
"RTN","WVUTL1A",7,0)
 ;---> NOTIFICATION WHEN FIRST DISPLAYING SCREEN.
"RTN","WVUTL1A",8,0)
 ;---> REQUIRED VARIABLE: DA=IEN OF NOTIFICATION.
"RTN","WVUTL1A",9,0)
 N X
"RTN","WVUTL1A",10,0)
 Q:'$D(DA) "UNKNOWN"
"RTN","WVUTL1A",11,0)
 Q:'$D(^WV(790.4,DA,0)) "UNKNOWN"
"RTN","WVUTL1A",12,0)
 S X=$P(^WV(790.4,DA,0),U,4)
"RTN","WVUTL1A",13,0)
 Q:'X "UNKNOWN"
"RTN","WVUTL1A",14,0)
 Q $$PRIOR1
"RTN","WVUTL1A",15,0)
 ;
"RTN","WVUTL1A",16,0)
PRIOR1() ;EP
"RTN","WVUTL1A",17,0)
 ;---> CALLED FROM WV NOTIF-EDITBLK-1 TO GET VALUE AND TEXT OF
"RTN","WVUTL1A",18,0)
 ;---> NOTIFICATION PRIORITY FROM PURPOSE OF NOTIFICATION AS AN
"RTN","WVUTL1A",19,0)
 ;---> ACTION WHEN EDITING PURPOSE OF NOTIFICATION.  ALSO DISPLAY
"RTN","WVUTL1A",20,0)
 ;---> WHETHER PURPOSE IS A RESULT OR A REMINDER.
"RTN","WVUTL1A",21,0)
 ;---> REQUIRED VARIABLE: X=IEN IN NOTIFICATION PURPOSE FILE.
"RTN","WVUTL1A",22,0)
 N R,Y,Z
"RTN","WVUTL1A",23,0)
 Q:'$D(X) "UNDEFINED"
"RTN","WVUTL1A",24,0)
 Q:'X "UNKNOWN"
"RTN","WVUTL1A",25,0)
 Q:'$D(^WV(790.404,X,0)) "UNKNOWN"
"RTN","WVUTL1A",26,0)
 S Y=$P(^WV(790.404,X,0),U,2) D
"RTN","WVUTL1A",27,0)
 .I 'Y S R="UNKNOWN" Q
"RTN","WVUTL1A",28,0)
 .I '$$VFIELD^DILFD(790.404,.02) S R="^DD MISSING"
"RTN","WVUTL1A",29,0)
 .S R=$$EXTERNAL^DILFD(790.404,.02,"",Y)
"RTN","WVUTL1A",30,0)
 S Z=$P(^WV(790.404,X,0),U,6)
"RTN","WVUTL1A",31,0)
 Q:Z="" R
"RTN","WVUTL1A",32,0)
 Q:Z R_", RESULT"
"RTN","WVUTL1A",33,0)
 Q R_", REMINDER"
"RTN","WVUTL1A",34,0)
 ;
"RTN","WVUTL1A",35,0)
 ;
"RTN","WVUTL1A",36,0)
NTPROC() ;EP
"RTN","WVUTL1A",37,0)
 ;---> CALLED FROM WV NOTIF-EDITBLK-1(?) BLOCK TO DISPLAY PROCEDURE
"RTN","WVUTL1A",38,0)
 ;---> NAME, BASED ON ACCESSION# PTR, WHEN FIRST DISPLAYING SCREEN.
"RTN","WVUTL1A",39,0)
 ;---> REQUIRED VARIABLE: X=ACCESSION# OF PROCEDURE
"RTN","WVUTL1A",40,0)
 N X
"RTN","WVUTL1A",41,0)
 S X=$P(^WV(790.4,DA,0),U,6)
"RTN","WVUTL1A",42,0)
 Q $$PROC
"RTN","WVUTL1A",43,0)
 ;
"RTN","WVUTL1A",44,0)
PROC() ;EP
"RTN","WVUTL1A",45,0)
 ;---> DISPLAY PROCEDURE TYPE OF THIS PROCEDURE.
"RTN","WVUTL1A",46,0)
 ;---> REQUIRED VARIABLE: X=IEN OF PROCEDURE IN PROC FILE #790.1.
"RTN","WVUTL1A",47,0)
 N WVY,WVYY,Y,Z S WVYY="INVALID ACC# OR PTR"
"RTN","WVUTL1A",48,0)
 Q:X']"" ""
"RTN","WVUTL1A",49,0)
 Q:'$D(^WV(790.1,X,0)) WVYY
"RTN","WVUTL1A",50,0)
 S WVY=$P(^WV(790.1,X,0),U,4)
"RTN","WVUTL1A",51,0)
 Q:'WVY WVYY
"RTN","WVUTL1A",52,0)
 Q:'$D(^WV(790.2,WVY,0)) WVYY
"RTN","WVUTL1A",53,0)
 S Z=$P(^WV(790.2,WVY,0),U)
"RTN","WVUTL1A",54,0)
 ;---> IF UNILATERAL AND LEFT/RIGHT HAS A VALUE, REPLACE "UNILATERAL"
"RTN","WVUTL1A",55,0)
 ;---> WITH LEFT OR RIGHT.
"RTN","WVUTL1A",56,0)
 S Y=$P(^WV(790.1,X,0),U,9)
"RTN","WVUTL1A",57,0)
 S Y=$S(Y="l":"LEFT",Y="r":"RIGHT",1:"")
"RTN","WVUTL1A",58,0)
 Q:Y="" Z
"RTN","WVUTL1A",59,0)
 Q $P(Z," ")_" "_Y
"RTN","WVUTL1A",60,0)
 ;
"RTN","WVUTL1A",61,0)
PROC1() ;EP
"RTN","WVUTL1A",62,0)
 ;---> DISPLAY PROCEDURE TYPE OF THIS PROCEDURE, USING DA.
"RTN","WVUTL1A",63,0)
 ;---> CALLED BY WV PROC-HEADER-1, WHICH CANNOT USE X.
"RTN","WVUTL1A",64,0)
 ;---> REQUIRED VARIABLE: DA=IEN OF PROCEDURE IN PROC FILE #790.1.
"RTN","WVUTL1A",65,0)
 N X S X=DA
"RTN","WVUTL1A",66,0)
 Q $$PROC
"RTN","WVUTL1A",67,0)
PROVI(DFN) ;
"RTN","WVUTL1A",68,0)
 ;---> RETURNS THE PRIMARY CARE PROVIDER
"RTN","WVUTL1A",69,0)
 ;---> REQUIRED VARIABLE: DFN
"RTN","WVUTL1A",70,0)
 Q:$G(DFN)'>0 "UNKNOWN"
"RTN","WVUTL1A",71,0)
 N X S X=$P($G(^DPT(DFN,.104)),U)
"RTN","WVUTL1A",72,0)
 S X=$S(X>0:$$GET1^DIQ(200,X,.01,"E"),1:"")
"RTN","WVUTL1A",73,0)
 I X="" S X=$P($$OUTPTPR^SDUTL3(DFN),U,2)
"RTN","WVUTL1A",74,0)
 S:X="" X="UNKNOWN"
"RTN","WVUTL1A",75,0)
 Q X
"RTN","WVUTL1A",76,0)
SCR(X) ;
"RTN","WVUTL1A",77,0)
 Q:$G(X)'>0 0
"RTN","WVUTL1A",78,0)
 S WVJX=$S(X>0:$P($G(^WV(790.07,X,0)),U,2),1:0)
"RTN","WVUTL1A",79,0)
 Q WVJX
"RTN","WVUTL1A",80,0)
QUAD(X) ;
"RTN","WVUTL1A",81,0)
 Q:$TR(X,"ULR,")'="" 0
"RTN","WVUTL1A",82,0)
 N TEST,CN,CNT,WVJX S WVJX=X,CN=""
"RTN","WVUTL1A",83,0)
 S (CN("LL"),CN("UL"),CN("UR"),CN("LR"))="",TEST=1
"RTN","WVUTL1A",84,0)
 F  S CN=$O(CN(CN)) Q:CN=""  I $P(WVJX,CN,2,5)[CN S WVJX=$P(WVJX,CN,1,2)_$P(WVJX,CN,3)
"RTN","WVUTL1A",85,0)
 F CN=1:1:11 I $E(WVJX,CN)=","&($E(WVJX,CN+1)=",") S WVJX=$E(WVJX,1,CN)_$E(WVJX,CN+2,11) S CN=CN-1
"RTN","WVUTL1A",86,0)
 F CN=1:1:4 S CNT=$P(X,",",CN) I CNT'="" I '$D(CN(CNT)) S TEST=0 Q
"RTN","WVUTL1A",87,0)
 S:$E(WVJX,$L(WVJX))="," WVJX=$E(WVJX,1,$L(WVJX)-1)
"RTN","WVUTL1A",88,0)
 S:$E(WVJX,1)="," WVJX=$E(WVJX,2,11)
"RTN","WVUTL1A",89,0)
 S:TEST>0 TEST=TEST_"^"_WVJX
"RTN","WVUTL1A",90,0)
 Q TEST
"RTN","WVUTL1A",91,0)
REF ;
"RTN","WVUTL1A",92,0)
 N X,Y,B,L
"RTN","WVUTL1A",93,0)
 Q:$G(DA)=""  S X=DA
"RTN","WVUTL1A",94,0)
 S Y=X,X=$P($G(^WV(790.07,X,0)),U)
"RTN","WVUTL1A",95,0)
 S L="abcdefghijklmnopqrstuvwxyz"
"RTN","WVUTL1A",96,0)
 S B="ABCDEFGHIJKLMNOPQRSTUVWXYZ"
"RTN","WVUTL1A",97,0)
 S X=$TR($E(X,1,$L(X)),L,B)
"RTN","WVUTL1A",98,0)
 I WVACT="SET" S ^WV(790.07,"C",X,Y)=""
"RTN","WVUTL1A",99,0)
 I WVACT="KIL" K ^WV(790.07,"C",X,Y)
"RTN","WVUTL1A",100,0)
 K WVACT Q
"RTN","WVUTL1A",101,0)
FAC N X,Y
"RTN","WVUTL1A",102,0)
 S WVJBFAC="",WVJCFAC="",WVJPCP=""
"RTN","WVUTL1A",103,0)
 Q:$G(WVDFN)'>0
"RTN","WVUTL1A",104,0)
 S X=$G(^WV(790,WVDFN,0))
"RTN","WVUTL1A",105,0)
 S WVJBFAC=$P(X,U,25),WVJCFAC=$P(X,U,26),WVJPCP=$$PROVI(WVDFN)
"RTN","WVUTL1A",106,0)
 S:WVJBFAC>0 WVJBFAC=$E($$GET1^DIQ(4,WVJBFAC,.01,"E"),1,18)
"RTN","WVUTL1A",107,0)
 S:WVJCFAC>0 WVJCFAC=$E($$GET1^DIQ(4,WVJCFAC,.01,"E"),1,18)
"RTN","WVUTL1A",108,0)
 Q
"RTN","WVUTL1A",109,0)
RAXS(DA) ; 
"RTN","WVUTL1A",110,0)
 I $G(DA)'>0 Q 0
"RTN","WVUTL1A",111,0)
 S WVJJ0=$G(^WV(790.1,DA,0))
"RTN","WVUTL1A",112,0)
 I '$D(WVJJ0) Q 0
"RTN","WVUTL1A",113,0)
 I "^BU^MB^MU^MS^"'[$E(WVJJ0,1,2) Q 0
"RTN","WVUTL1A",114,0)
 I $P(WVJJ0,U,15)="" Q 0
"RTN","WVUTL1A",115,0)
 Q 1
"RTN","WVUTL1A",116,0)
FACIL(DFN,TYP) ;Gets Treatment Facility, if typ="C" for Cervix, "B" for Breast
"RTN","WVUTL1A",117,0)
 N X,Y
"RTN","WVUTL1A",118,0)
 S Y=""
"RTN","WVUTL1A",119,0)
 I $G(DFN)'>0 Q Y
"RTN","WVUTL1A",120,0)
 S X=$G(^WV(790,DFN,0))
"RTN","WVUTL1A",121,0)
 S:TYP="B" Y=$P(X,U,25) S:TYP="C" Y=$P(X,U,26)
"RTN","WVUTL1A",122,0)
 S:Y>0 Y=$E($$GET1^DIQ(4,Y,.01,"E"),1,18)
"RTN","WVUTL1A",123,0)
 Q Y
"RTN","WVUTL1A",124,0)
MST(WVDFN) ;Gets Military Sexual Trauma
"RTN","WVUTL1A",125,0)
 I $G(WVDFN)'>0 Q ""
"RTN","WVUTL1A",126,0)
 N J S J=$P($G(^WV(790,WVDFN,0)),U,27)
"RTN","WVUTL1A",127,0)
 S J=$S(J="M":"Military",J="C":"Civilian",J="B":"Both",J="N":"None",1:"")
"RTN","WVUTL1A",128,0)
 Q J
"RTN","WVUTL1A",129,0)
SC(WVJ) ;Screen called from File 790.02 to elim. inactive from selectable
"RTN","WVUTL1A",130,0)
 I $G(XQY0)["WV ADD/EDIT CASE MANAGERS" Q 1
"RTN","WVUTL1A",131,0)
 I $G(WVJOPEN)>0 Q 1
"RTN","WVUTL1A",132,0)
 N WVINACT
"RTN","WVUTL1A",133,0)
 S WVINACT=$P($G(^WV(790.01,+WVJ,0)),U,2) ;date inactivated
"RTN","WVUTL1A",134,0)
 I WVINACT>0,WVINACT<$G(DT) Q 0
"RTN","WVUTL1A",135,0)
 Q 1
"RTN","WVUTL1A",136,0)
LOOK(WVJ) ;Display select fields with lookup on 790, not file#2 Identif.
"RTN","WVUTL1A",137,0)
 Q:WVJ'>0
"RTN","WVUTL1A",138,0)
 N DIC,DA,DR,DIQ,Y
"RTN","WVUTL1A",139,0)
 S DIC="^WV(790,",DA=WVJ,DIQ="WVJAR(",DIQ(0)="E"
"RTN","WVUTL1A",140,0)
 S DR=".06;.1;.16" D EN^DIQ1
"RTN","WVUTL1A",141,0)
 S WVJ=WVJAR(790,WVJ,.06,"E")_"    "_WVJAR(790,WVJ,.1,"E")
"RTN","WVUTL1A",142,0)
 K WVJAR
"RTN","WVUTL1A",143,0)
 Q WVJ
"RTN","WVUTL1A",144,0)
LOOKL(WVJ) ;
"RTN","WVUTL1A",145,0)
 N Y,WVX,WVP,WVY,WVDT,WVP,X,WVDTS,WVMARK
"RTN","WVUTL1A",146,0)
 S X1=DT,X2=-30 D C^%DTC S WVDTS=X
"RTN","WVUTL1A",147,0)
 S WVX="" F  S WVX=$O(^WV(790.3,"C",+WVJ,WVX)) Q:WVX'>0  D
"RTN","WVUTL1A",148,0)
 .S WVY=$G(^WV(790.3,WVX,0)),WVDT=+WVY,WVP=$P(WVY,U,3)
"RTN","WVUTL1A",149,0)
 .Q:WVDT'>WVDTS  S WVMARK=1
"RTN","WVUTL1A",150,0)
 .S Y=WVDT D DD^%DT S WVDT=Y
"RTN","WVUTL1A",151,0)
 .;S WVP=$S(WVP'>0:"",1:$P($G(^WV(790.1,WVP,0)),U,4))
"RTN","WVUTL1A",152,0)
 .S:WVP'="" WVP=$P($G(^WV(790.2,WVP,0)),U)
"RTN","WVUTL1A",153,0)
 .W !?32,WVDT,?47,WVP
"RTN","WVUTL1A",154,0)
 W:$G(WVMARK)=1 !
"RTN","WVUTL1A",155,0)
 Q
"RTN","WVUTL1A",156,0)
RUNDT(WVY) ;Get and format run date for various reports 
"RTN","WVUTL1A",157,0)
 ; Center when WVY="C"
"RTN","WVUTL1A",158,0)
 N Y,WVJ
"RTN","WVUTL1A",159,0)
 I $D(WVJRNOW) Q WVJRNOW
"RTN","WVUTL1A",160,0)
 D NOW^%DTC S Y=% D DD^%DT
"RTN","WVUTL1A",161,0)
 S Y=$E(Y,1,12)_"  "_$E(Y,14,18)
"RTN","WVUTL1A",162,0)
 S:$L(Y)'>10 Y=""
"RTN","WVUTL1A",163,0)
 S (WVJRNOW,WVJ)="Run Date: "_Y
"RTN","WVUTL1A",164,0)
 I $G(WVY)="C" Q "                         "_WVJ
"RTN","WVUTL1A",165,0)
 Q WVJ
"RTN","WVUTL1A",166,0)
MSTAL(WVDFN) ; get Military Sexual Trauma (MST) code w/GETSTAT^DGMSTAPI api
"RTN","WVUTL1A",167,0)
 ; supported DBIA #2716.
"RTN","WVUTL1A",168,0)
 ; if MST="Y" return "M" (for military, only), otherwise return null
"RTN","WVUTL1A",169,0)
 N WVMST
"RTN","WVUTL1A",170,0)
 S WVMST=""
"RTN","WVUTL1A",171,0)
 I $T(GETSTAT^DGMSTAPI)]"" D  ;check if api exists
"RTN","WVUTL1A",172,0)
 .S WVMST=$$GETSTAT^DGMSTAPI(WVDFN),WVMST=$P(WVMST,U,2)
"RTN","WVUTL1A",173,0)
 .Q
"RTN","WVUTL1A",174,0)
 Q:WVMST="Y" "M"
"RTN","WVUTL1A",175,0)
 Q ""
"RTN","WVUTL1A",176,0)
MSTDEF(WVDFN) ;Makes MST default for ScreenMan Patient edits
"RTN","WVUTL1A",177,0)
 N WVMST
"RTN","WVUTL1A",178,0)
 S WVMST=$$GET1^DIQ(790,WVDFN,.27,"E")
"RTN","WVUTL1A",179,0)
 Q:WVMST'="" WVMST
"RTN","WVUTL1A",180,0)
 I $T(GETSTAT^DGMSTAPI)]"" D  ;check if api exists
"RTN","WVUTL1A",181,0)
 .S WVMST=$$GETSTAT^DGMSTAPI(WVDFN),WVMST=$P(WVMST,U,2)
"RTN","WVUTL1A",182,0)
 .S WVMST=$S(WVMST="Y":"M",1:"")
"RTN","WVUTL1A",183,0)
 .Q
"RTN","WVUTL1A",184,0)
 Q WVMST
"RTN","WVUTL1A",185,0)
MSTUPD ; Entry point to update Sexual Trauma when the Military Sexual Trauma
"RTN","WVUTL1A",186,0)
 ; patch is released.
"RTN","WVUTL1A",187,0)
 S WVDFN=0
"RTN","WVUTL1A",188,0)
 F  S WVDFN=$O(^WV(790,WVDFN)) Q:WVDFN'>0  S WV0=$G(^(WVDFN,0)) D
"RTN","WVUTL1A",189,0)
 .Q:$P(WV0,U,27)'=""
"RTN","WVUTL1A",190,0)
 .Q:$$MSTAL(WVDFN)=""
"RTN","WVUTL1A",191,0)
 .S $P(^WV(790,WVDFN,0),U,27)=$$MSTAL(WVDFN)
"RTN","WVUTL1A",192,0)
 Q
"RTN","WVUTL1A",193,0)
MSTU ;Update procedure header Sexual Trauma when MST is populated in PIMS
"RTN","WVUTL1A",194,0)
 Q:$G(WVDFN)'>0
"RTN","WVUTL1A",195,0)
 Q:$P($G(^WV(790,WVDFN,0)),U,27)'=""
"RTN","WVUTL1A",196,0)
 Q:$$MSTDEF(WVDFN)=""
"RTN","WVUTL1A",197,0)
 N DR,DA,DIE,DIC
"RTN","WVUTL1A",198,0)
 S DR=".27////"_$E($$MSTDEF(WVDFN))
"RTN","WVUTL1A",199,0)
 S DA=WVDFN
"RTN","WVUTL1A",200,0)
 S DIE=790
"RTN","WVUTL1A",201,0)
 D ^DIE
"RTN","WVUTL1A",202,0)
 Q
"RTN","WVUTL1A",203,0)
LINE ; Called from the WV LINE FOR MENUS option. That option is merely a
"RTN","WVUTL1A",204,0)
 ; place holder in the menu and used for visual purposes. This is 
"RTN","WVUTL1A",205,0)
 ; entry point does nothing.
"RTN","WVUTL1A",206,0)
 Q
"RTN","WVUTL1A",207,0)
VET(DFN) ; Check if patient is a veteran.
"RTN","WVUTL1A",208,0)
 N WVETERAN
"RTN","WVUTL1A",209,0)
 S WVETERAN=$$GET1^DIQ(2,DFN,1901,"I")
"RTN","WVUTL1A",210,0)
 Q $S(WVETERAN="Y":"Yes",WVETERAN="N":"No",1:"Unknown")
"RTN","WVUTL1A",211,0)
 ;
"RTN","WVUTL6")
0^12^B11211277
"RTN","WVUTL6",1,0)
WVUTL6 ;HCIOFO/FT,JR-UTIL: TEXT VALS, DEF PRINT DATE; ;10/11/99  14:03
"RTN","WVUTL6",2,0)
 ;;1.0;WOMEN'S HEALTH;**3,7**;Sep 30, 1998
"RTN","WVUTL6",3,0)
 ;;  Original routine created by IHS/ANMC/MWR
"RTN","WVUTL6",4,0)
 ;;* MICHAEL REMILLARD, DDS * ALASKA NATIVE MEDICAL CENTER *
"RTN","WVUTL6",5,0)
 ;;  UTILITY: TEXT FOR PROVIDER, PROCEDURE, HOSP LOC, INSTIT, & ECC.
"RTN","WVUTL6",6,0)
 ;;  PROC SPECIAL VALUE (PAP, MAM, COLP).  COMPUTE DEFAULT PRINT DATE.
"RTN","WVUTL6",7,0)
 ;
"RTN","WVUTL6",8,0)
 ;
"RTN","WVUTL6",9,0)
PROV() ;EP
"RTN","WVUTL6",10,0)
 ;---> RETURN TEXT OF PROVIDER'S NAME.
"RTN","WVUTL6",11,0)
 ;---> REQUIRED VARIABLE: X=IEN IN NEW PERSON FILE #200.
"RTN","WVUTL6",12,0)
 N WVNAME
"RTN","WVUTL6",13,0)
 Q:'$D(X) ""
"RTN","WVUTL6",14,0)
 Q:'X "UNKNOWN"
"RTN","WVUTL6",15,0)
 S WVNAME=$$GET1^DIQ(200,X,.01,"E")
"RTN","WVUTL6",16,0)
 Q $S(WVNAME'="":WVNAME,1:"UNKNOWN POINTER")
"RTN","WVUTL6",17,0)
 ;
"RTN","WVUTL6",18,0)
 ;
"RTN","WVUTL6",19,0)
PCDNAM() ;EP
"RTN","WVUTL6",20,0)
 ;---> RETURN TEXT OF PROCEDURE TYPE.
"RTN","WVUTL6",21,0)
 ;---> REQUIRED VARIABLE: X=IEN IN WV PROCEDURE TYPE FILE #790.2.
"RTN","WVUTL6",22,0)
 Q:'$D(X) ""
"RTN","WVUTL6",23,0)
 Q:'X "UNKNOWN"
"RTN","WVUTL6",24,0)
 Q:'$D(^WV(790.2,X,0)) "UNKNOWN POINTER"
"RTN","WVUTL6",25,0)
 Q $P(^WV(790.2,X,0),U)
"RTN","WVUTL6",26,0)
 ;
"RTN","WVUTL6",27,0)
HOSPLC() ;EP
"RTN","WVUTL6",28,0)
 ;---> RETURN TEXT OF HOSPITAL LOCATION NAME.
"RTN","WVUTL6",29,0)
 ;---> REQUIRED VARIABLE: X=IEN IN HOSPITAL LOCATION FILE #44.
"RTN","WVUTL6",30,0)
 Q:'$D(X) ""
"RTN","WVUTL6",31,0)
 Q:'X "UNKNOWN"
"RTN","WVUTL6",32,0)
 Q:'$D(^SC(X,0)) "UNKNOWN POINTER"
"RTN","WVUTL6",33,0)
 Q $P(^SC(X,0),U)
"RTN","WVUTL6",34,0)
 ;
"RTN","WVUTL6",35,0)
INSTIT() ;EP
"RTN","WVUTL6",36,0)
 ;---> RETURN IEN OF INSTITUTION (FACILITY) FILE 4, FOR THIS HOSPITAL
"RTN","WVUTL6",37,0)
 ;---> LOCATION ENTRY IN HOSPITAL LOCATION FILE 44.
"RTN","WVUTL6",38,0)
 ;---> ALSO CONCATENATE "`" TO THE FRONT OF IEN FOR USE IN DR STRINGS.
"RTN","WVUTL6",39,0)
 Q:'$D(X) ""
"RTN","WVUTL6",40,0)
 Q:X="" ""
"RTN","WVUTL6",41,0)
 Q:'$D(^SC(X,0)) ""
"RTN","WVUTL6",42,0)
 Q:$P(^SC(X,0),U,4)']"" ""
"RTN","WVUTL6",43,0)
 Q "`"_$P(^SC(X,0),U,4)
"RTN","WVUTL6",44,0)
 ;
"RTN","WVUTL6",45,0)
INSTTX(FACILITY) ;EP
"RTN","WVUTL6",46,0)
 ;---> RETURN TEXT OF INSTITUTION (FACILITY) NAME.
"RTN","WVUTL6",47,0)
 ;---> REQUIRED VARIABLE: X=IEN IN INSTITUTION FILE #4.
"RTN","WVUTL6",48,0)
 Q:'$G(FACILITY) ""
"RTN","WVUTL6",49,0)
 N WVDIC4
"RTN","WVUTL6",50,0)
 S WVDIC4=$$GET1^DIQ(4,FACILITY,.01,"E")
"RTN","WVUTL6",51,0)
 Q $S(WVDIC4]"":WVDIC4,1:"UNKNOWN POINTER")
"RTN","WVUTL6",52,0)
 ;
"RTN","WVUTL6",53,0)
ECCDYS() ;EP
"RTN","WVUTL6",54,0)
 ;---> RETURN TEXT FROM SET OF CODES FOR ECC DYSPLASIA, FIELD .25,
"RTN","WVUTL6",55,0)
 ;---> OF PROCEDURE FILE 790.1.
"RTN","WVUTL6",56,0)
 ;---> REQUIRED VARIABLE: X=CODE FOR TEXT OF ECC DYSPLASIA.
"RTN","WVUTL6",57,0)
 Q:'$D(X) ""
"RTN","WVUTL6",58,0)
 Q:X="" ""
"RTN","WVUTL6",59,0)
 I '$$VFIELD^DILFD(790.1,.25) Q "^DD MISSING"
"RTN","WVUTL6",60,0)
 Q $$EXTERNAL^DILFD(790.1,.25,"",X)
"RTN","WVUTL6",61,0)
 ;
"RTN","WVUTL6",62,0)
PNOCX(IEN) ;EP
"RTN","WVUTL6",63,0)
 ;---> RETURN 1 IF THIS PROCEDURE IS NOT ANY TYPE OF CERVICAL TX.
"RTN","WVUTL6",64,0)
 Q:'$G(IEN) 1
"RTN","WVUTL6",65,0)
 Q:'$D(^WV(790.2,IEN,0)) 1
"RTN","WVUTL6",66,0)
 Q:$$PMAM(IEN) 1
"RTN","WVUTL6",67,0)
 Q:IEN=27 1  Q:IEN=29 1  Q:IEN=30 1  Q:IEN=31 1  Q:IEN=32 1
"RTN","WVUTL6",68,0)
 Q:IEN=33 1  Q:IEN=34 1  Q:IEN=35 1
"RTN","WVUTL6",69,0)
 Q 0
"RTN","WVUTL6",70,0)
 ;
"RTN","WVUTL6",71,0)
 ;
"RTN","WVUTL6",72,0)
PMAM(IEN) ;EP
"RTN","WVUTL6",73,0)
 ;---> RETURN 1 IF THIS PROCEDURE IS ANY TYPE OF MAMMOGRAM, RETURN 0
"RTN","WVUTL6",74,0)
 ;---> IF NOT.
"RTN","WVUTL6",75,0)
 ;---> REQUIRED VARIABLE: IEN=IEN IN PROCEDURE TYPE FILE #790.2.
"RTN","WVUTL6",76,0)
 ;---> 25, 26, AND 27 ARE IENS OF MAMS IN ^WV(790.2,.
"RTN","WVUTL6",77,0)
 Q:'$G(IEN) 0
"RTN","WVUTL6",78,0)
 Q:IEN=25 1  Q:IEN=26 1  Q:IEN=28 1
"RTN","WVUTL6",79,0)
 Q 0
"RTN","WVUTL6",80,0)
 ;
"RTN","WVUTL6",81,0)
 ;
"RTN","WVUTL6",82,0)
PRTDATE ;EP
"RTN","WVUTL6",83,0)
 ;---> CALL BY WV NOTIF-EDITBLK-1 TO COMPUTE AND STUFF DATE NOTIFICATION
"RTN","WVUTL6",84,0)
 ;---> LETTER WILL BE PRINTED, "Print Date" FIELD.  CALLED FROM
"RTN","WVUTL6",85,0)
 ;---> "TYPE OF NOTIFICATION" FIELD ORDER, "POST ACTION ON CHANGE".
"RTN","WVUTL6",86,0)
 ;--->
"RTN","WVUTL6",87,0)
 ;---> IF THE "TYPE OF NOTIFICATION" IS PRINTABLE (LETTER), AS STORED
"RTN","WVUTL6",88,0)
 ;---> IN #.02 FIELD OF FILE #790.403, THIS COMPUTES PRINT DATE AND
"RTN","WVUTL6",89,0)
 ;---> STUFFS A DEFAULT "COMPLETE BY DATE" (FIELD #.13) AS WELL.
"RTN","WVUTL6",90,0)
 ;---> "PRINT DATE" WILL BE CX/BR NEED DUE DATE - SITE PARAMETER, AS
"RTN","WVUTL6",91,0)
 ;---> STORED IN #.06 FIELD OF FILE #790.02, OR -30 DAYS IF
"RTN","WVUTL6",92,0)
 ;---> PARAMETER NOT SET.  (SEE PRTDAT^WVUTL2-ABOVE.)
"RTN","WVUTL6",93,0)
 ;---> "COMPLETE BY DATE" WILL BE "PRINT DATE"+30. SEE NDELQ1^WVUTL4.
"RTN","WVUTL6",94,0)
 ;--->
"RTN","WVUTL6",95,0)
 ;---> IF THE "TYPE OF NOTIFICATION" IS NOT PRINTABLE (PHONE), THIS
"RTN","WVUTL6",96,0)
 ;---> SETS "PRINT DATE"="" AND RECOMPUTES "COMPLETE BY DATE" BASED ON
"RTN","WVUTL6",97,0)
 ;---> DATE NOTIFICATION WAS OPENED (FIELD #.02) +30 DAYS.
"RTN","WVUTL6",98,0)
 ;
"RTN","WVUTL6",99,0)
 ;---> (NOTE: FOR UNIFORMITY, EXECUTABLE DEFAULT FOR "PRINT DATE"
"RTN","WVUTL6",100,0)
 ;---> CALLS THIS CODE TO SET ITS STORED VALUE, THEN SETS ITS DEFAULT
"RTN","WVUTL6",101,0)
 ;---> EQUAL TO ITS STORED VALUE.)
"RTN","WVUTL6",102,0)
 ;--->
"RTN","WVUTL6",103,0)
 ;---> REQUIRED VARIABLES: WVDFN=IEN OF PATIENT
"RTN","WVUTL6",104,0)
 ;--->                     DUZ(2)=SITE
"RTN","WVUTL6",105,0)
 ;--->                     WVTYPE=IEN TYPE OF NOTIFICATION (LETTER, ETC)
"RTN","WVUTL6",106,0)
 ;--->                     WVPURP=IEN PURPOSE OF NOTIFICATION
"RTN","WVUTL6",107,0)
 ;
"RTN","WVUTL6",108,0)
 N WVTYPE,WVPURP,X,Y
"RTN","WVUTL6",109,0)
 S WVTYPE=$$GET^DDSVAL(DIE,DA,.03)
"RTN","WVUTL6",110,0)
 I 'WVTYPE D PUT^DDSVAL(DIE,DA,.11,"") Q
"RTN","WVUTL6",111,0)
 ;---> IF NOT PRINTABLE, SET PRINT DATE="".
"RTN","WVUTL6",112,0)
 I '$P(^WV(790.403,WVTYPE,0),U,2) D  Q
"RTN","WVUTL6",113,0)
 .D PUT^DDSVAL(DIE,DA,.11,"")
"RTN","WVUTL6",114,0)
 .S X=$$NDELQ^WVUTL4 D PUT^DDSVAL(DIE,DA,.13,X)
"RTN","WVUTL6",115,0)
 S WVPURP=$$GET^DDSVAL(DIE,DA,.04)
"RTN","WVUTL6",116,0)
 ;---> COMPUTE AND STUFF PRINT DATE.
"RTN","WVUTL6",117,0)
 D PRTDAT(WVDFN,DUZ(2),WVTYPE,WVPURP,.X)
"RTN","WVUTL6",118,0)
 D PUT^DDSVAL(DIE,DA,.11,X)
"RTN","WVUTL6",119,0)
 ;---> COMPUTE AND STUFF COMPLETE BY DATE.
"RTN","WVUTL6",120,0)
 S X=$$NDELQ1^WVUTL4 D PUT^DDSVAL(DIE,DA,.13,X)
"RTN","WVUTL6",121,0)
 Q
"RTN","WVUTL6",122,0)
 ;
"RTN","WVUTL6",123,0)
 ;
"RTN","WVUTL6",124,0)
PRTDAT(DFN,DUZ2,TYPE,PURP,DATE) ;EP
"RTN","WVUTL6",125,0)
 ;---> YIELD PATIENT'S LETTER PRINT DATE, BASED ON CX/BR NEED.
"RTN","WVUTL6",126,0)
 ;---> DUE DATE MINUS SITE PARAMETER (OR 30 DAYS, IF NOT SET).
"RTN","WVUTL6",127,0)
 ;---> TYPE OF NOTIFICATION MUST BE "PRINTABLE" (#.02 OF #790.403).
"RTN","WVUTL6",128,0)
 ;---> REQUIRED VARIABLES: DFN=IEN OF PATIENT
"RTN","WVUTL6",129,0)
 ;--->                     DUZ2=DUZ(2)
"RTN","WVUTL6",130,0)
 ;--->                     TYPE=IEN TYPE OF NOTIFICATION
"RTN","WVUTL6",131,0)
 ;--->                     PURP=IEN PURPOSE OF NOTIFICATION
"RTN","WVUTL6",132,0)
 ;---> RETURNS VARIABLES:  DATE=DEFAULT DATE LETTER SHOULD BE PRINTED
"RTN","WVUTL6",133,0)
 ;
"RTN","WVUTL6",134,0)
 N P,Q,X,X1,X2
"RTN","WVUTL6",135,0)
 S DATE=""
"RTN","WVUTL6",136,0)
 Q:'TYPE!('PURP)
"RTN","WVUTL6",137,0)
 ;---> QUIT IF THIS "TYPE OF NOTIFICATION" IS NOT "PRINTABLE" (PIECE 2).
"RTN","WVUTL6",138,0)
 Q:'$P(^WV(790.403,TYPE,0),U,2)
"RTN","WVUTL6",139,0)
 S X2=$P($G(^WV(790.02,DUZ2,0)),U,6)
"RTN","WVUTL6",140,0)
 S X2=$S(X2:-X2,1:-30)
"RTN","WVUTL6",141,0)
 Q:'$D(^WV(790,DFN,0))
"RTN","WVUTL6",142,0)
 ;---> IF THIS PURPOSE IS A RESULT LETTER, SET PRINT DATE=TODAY, QUIT.
"RTN","WVUTL6",143,0)
 Q:'$D(^WV(790.404,PURP,0))
"RTN","WVUTL6",144,0)
 I $P(^WV(790.404,PURP,0),U,6) S DATE=DT Q
"RTN","WVUTL6",145,0)
 ;---> IF THIS IS NOT ASSOCIATED WITH BR/CX NEEDS, QUIT WITH DATE="".
"RTN","WVUTL6",146,0)
 Q:$P(^WV(790.404,PURP,0),U,5)=""
"RTN","WVUTL6",147,0)
 S:$P(^WV(790.404,PURP,0),U,5)="CX" P=11,Q=12
"RTN","WVUTL6",148,0)
 S:$P(^WV(790.404,PURP,0),U,5)="BR" P=18,Q=19
"RTN","WVUTL6",149,0)
 ;---> QUIT IF THIS PATIENT HAS NO BR/CX NEED ENTERED.
"RTN","WVUTL6",150,0)
 Q:'$P(^WV(790,DFN,0),U,P)
"RTN","WVUTL6",151,0)
 ;---> QUIT IF THIS PATIENT HAS NO BR/CX NEED DUE DATE.
"RTN","WVUTL6",152,0)
 S X=$P(^WV(790,DFN,0),U,Q) Q:'X
"RTN","WVUTL6",153,0)
 S:'$E(X,7) $E(X,7)=1
"RTN","WVUTL6",154,0)
 S X1=X D C^%DTC
"RTN","WVUTL6",155,0)
 S DATE=X
"RTN","WVUTL6",156,0)
 Q
"RTN","WVUTL7")
0^7^B40245215
"RTN","WVUTL7",1,0)
WVUTL7 ;HCIOFO/FT,JR-UTIL: HEADERS & TRAILERS; ;6/3/99  11:34
"RTN","WVUTL7",2,0)
 ;;1.0;WOMEN'S HEALTH;**5,7**;Sep 30, 1998
"RTN","WVUTL7",3,0)
 ;;  Original routine created by IHS/ANMC/MWR
"RTN","WVUTL7",4,0)
 ;;* MICHAEL REMILLARD, DDS * ALASKA NATIVE MEDICAL CENTER *
"RTN","WVUTL7",5,0)
 ;;  UTILITY: HEADERS AND TRAILERS.
"RTN","WVUTL7",6,0)
 ;
"RTN","WVUTL7",7,0)
S(S) ;EP
"RTN","WVUTL7",8,0)
 ;---> RETURN A VALUE OF SPACES EQUAL IN LENGTH TO THE NUMBER S.
"RTN","WVUTL7",9,0)
 N I,SP S SP=$$REPEAT^XLFSTR(" ",80)
"RTN","WVUTL7",10,0)
 Q $E(SP,1,$G(S))
"RTN","WVUTL7",11,0)
 ;
"RTN","WVUTL7",12,0)
TOPHEAD ;EP
"RTN","WVUTL7",13,0)
 ;---> CODE TO SET VARIABLES FOR HEADER.
"RTN","WVUTL7",14,0)
 N X
"RTN","WVUTL7",15,0)
 D NOW^%DTC S WVNOW=$$SLDT1^WVUTL5(%)
"RTN","WVUTL7",16,0)
 S WVLINE=$$REPEAT^XLFSTR("-",80)
"RTN","WVUTL7",17,0)
 S WVPAGE=1
"RTN","WVUTL7",18,0)
 S WVCRT=$S($E(IOST)="C":1,1:0)
"RTN","WVUTL7",19,0)
 S WVCONFF="*********************** CONFIDENTIAL PATIENT INFORMATION "
"RTN","WVUTL7",20,0)
 S WVCONFF=WVCONFF_"***********************"
"RTN","WVUTL7",21,0)
 S WVTIMLN=$E(WVLINE,1,26)_" printed: "_WVNOW_" "_$E(WVLINE,1,27)
"RTN","WVUTL7",22,0)
 Q
"RTN","WVUTL7",23,0)
 ;
"RTN","WVUTL7",24,0)
TOPHEAD1 ;EP
"RTN","WVUTL7",25,0)
 ;---> CODE TO SET VARIABLES FOR HEADER.
"RTN","WVUTL7",26,0)
 N X
"RTN","WVUTL7",27,0)
 D NOW^%DTC S WVNOW=$$SLDT1^WVUTL5(%)
"RTN","WVUTL7",28,0)
 S WVLINE=$$REPEAT^XLFSTR("-",80)
"RTN","WVUTL7",29,0)
 S WVPAGE=$G(WVPAGE)+1
"RTN","WVUTL7",30,0)
 S WVCRT=$S($E(IOST)="C":1,1:0)
"RTN","WVUTL7",31,0)
 S WVCONFF="*********************** CONFIDENTIAL PATIENT INFORMATION "
"RTN","WVUTL7",32,0)
 S WVCONFF=WVCONFF_"***********************"
"RTN","WVUTL7",33,0)
 S WVTIMLN=$E(WVLINE,1,26)_" printed: "_WVNOW_" "_$E(WVLINE,1,27)
"RTN","WVUTL7",34,0)
 Q
"RTN","WVUTL7",35,0)
 ;
"RTN","WVUTL7",36,0)
HEADER1 ;EP
"RTN","WVUTL7",37,0)
 ;---> BROWSE/REPORT HEADER: MULTIPLE PATIENTS, MULTIPLE PROCEDURES.
"RTN","WVUTL7",38,0)
 ;---> REQUIRED VARIABLES: WVBEGDT,WVCRT,WVENDDT,WVPAGE,WVTITLE,DUZ(2)
"RTN","WVUTL7",39,0)
 ;---> OPTIONAL VARIABLE:  WVCONF (CONFIDENTIAL), WVSUBH (SUBHEADER).
"RTN","WVUTL7",40,0)
 N X
"RTN","WVUTL7",41,0)
 W:WVPAGE>1!WVCRT @IOF,!
"RTN","WVUTL7",42,0)
 W:$D(WVCONF) WVCONFF,! W:'WVCRT WVTIMLN,!
"RTN","WVUTL7",43,0)
 W !,WVTITLE W:'WVCRT ?70,"page: ",WVPAGE
"RTN","WVUTL7",44,0)
 W !!,$$RUNDT^WVUTL1A("C")
"RTN","WVUTL7",45,0)
 W !,"Case Mgr: " D
"RTN","WVUTL7",46,0)
 .I '$D(WVE) W "ALL" Q
"RTN","WVUTL7",47,0)
 .I WVE W "ALL" Q
"RTN","WVUTL7",48,0)
 .I '$D(WVCMGR) W "UNKNOWN" Q
"RTN","WVUTL7",49,0)
 .I WVCMGR="" W "UNKNOWN" Q
"RTN","WVUTL7",50,0)
 .N WVCMGRNM
"RTN","WVUTL7",51,0)
 .S WVCMGRNM=$$GET1^DIQ(200,WVCMGR,.01,"E")
"RTN","WVUTL7",52,0)
 .W $S(WVCMGRNM]"":WVCMGRNM,1:"UNKNOWN")
"RTN","WVUTL7",53,0)
 W ?56,"For period: ",$$TXDT^WVUTL5(WVBEGDT)
"RTN","WVUTL7",54,0)
 W !,"Facility: ",$$INSTTX^WVUTL6(DUZ(2))
"RTN","WVUTL7",55,0)
 W ?64,"To: ",$$TXDT^WVUTL5(WVENDDT)
"RTN","WVUTL7",56,0)
 W !,$$REPEAT^XLFSTR("=",80)
"RTN","WVUTL7",57,0)
 I $D(WVSUBH) D @WVSUBH
"RTN","WVUTL7",58,0)
 Q
"RTN","WVUTL7",59,0)
 ;
"RTN","WVUTL7",60,0)
HEADER2 ;EP
"RTN","WVUTL7",61,0)
 ;---> PATIENT REPORT HEADER: ONE PATIENT, MULTIPLE PROCEDURES.
"RTN","WVUTL7",62,0)
 ;---> REQUIRED VARIABLES: WVBEGDT,WVCRT,WVENDDT,WVPAGE,WVTITLE,DUZ(2)
"RTN","WVUTL7",63,0)
 ;---> OPTIONAL VARIABLE:  WVCONF (CONFIDENTIAL), WVSUBH (SUBHEADER).
"RTN","WVUTL7",64,0)
 N X
"RTN","WVUTL7",65,0)
 D FAC^WVUTL1A
"RTN","WVUTL7",66,0)
 W:WVPAGE>1!WVCRT @IOF,!
"RTN","WVUTL7",67,0)
 W:$D(WVCONF) WVCONFF,! W:'WVCRT WVTIMLN,!
"RTN","WVUTL7",68,0)
 W !,WVTITLE W:'WVCRT ?70,"page: ",WVPAGE
"RTN","WVUTL7",69,0)
 W !!,$$RUNDT^WVUTL1A("C")
"RTN","WVUTL7",70,0)
 W !,"Patient Name: ",WVNAMAGE,?52,$$PNLAB^WVUTL5(),WVCHRT
"RTN","WVUTL7",71,0)
 W !,"Case Manager: ",WVCMGR
"RTN","WVUTL7",72,0)
 W ?50,"Facility: ",$E($$INSTTX^WVUTL6(DUZ(2)),1,19)
"RTN","WVUTL7",73,0)
 W !,"Cx Tx Need  : ",WVCNEED
"RTN","WVUTL7",74,0)
 W ?47,"Cx Facility: ",$G(WVJCFAC)
"RTN","WVUTL7",75,0)
 W !,"PAP Regimen : ",WVPAPRG
"RTN","WVUTL7",76,0)
 W !,"Br Tx Need  : ",WVBNEED
"RTN","WVUTL7",77,0)
 W ?47,"Br Facility: ",$G(WVJBFAC)
"RTN","WVUTL7",78,0)
 W !,"Pr Provider : ",$G(WVJPCP)
"RTN","WVUTL7",79,0)
 W ?45,"Sexual Trauma: ",$$MST^WVUTL1A(WVDFN)
"RTN","WVUTL7",80,0)
 W !,"Hx of BR CA : ",$S($P($G(^WV(790,WVDFN,0)),U,23)]"":$$GET1^DIQ(790,WVDFN,.23,"E"),1:"")
"RTN","WVUTL7",81,0)
 W ?51,"Veteran: ",$$VET^WVUTL1A(WVDFN)
"RTN","WVUTL7",82,0)
 W !,$$REPEAT^XLFSTR("=",49)
"RTN","WVUTL7",83,0)
 W $S(WVEDC]"":WVEDC_"======",1:"===============================")
"RTN","WVUTL7",84,0)
 I $D(WVSUBH) D @WVSUBH
"RTN","WVUTL7",85,0)
 Q
"RTN","WVUTL7",86,0)
 ;
"RTN","WVUTL7",87,0)
HEADER3 ;EP
"RTN","WVUTL7",88,0)
 ;---> LAB LOG REPORT HEADER: MULTIPLE PATIENTS, MULTIPLE PROCEDURES.
"RTN","WVUTL7",89,0)
 ;---> REQUIRED VARIABLES: WVBEGDT,WVCRT,WVENDDT,WVPAGE,WVTITLE,DUZ(2)
"RTN","WVUTL7",90,0)
 ;---> OPTIONAL VARIABLE:  WVCONF (CONFIDENTIAL), WVSUBH (SUBHEADER).
"RTN","WVUTL7",91,0)
 N X
"RTN","WVUTL7",92,0)
 W:WVPAGE>1!WVCRT @IOF,!
"RTN","WVUTL7",93,0)
 W:$D(WVCONF) WVCONFF,! W:'WVCRT WVTIMLN,!
"RTN","WVUTL7",94,0)
 W !,WVTITLE W:'WVCRT ?70,"page: ",WVPAGE
"RTN","WVUTL7",95,0)
 W !!,$$RUNDT^WVUTL1A("C")
"RTN","WVUTL7",96,0)
 W !,"Facility: ",$$INSTTX^WVUTL6($S($G(WVFAC):WVFAC,1:DUZ(2)))
"RTN","WVUTL7",97,0)
 W ?53,"From: ",$$SLDT2^WVUTL5(WVBEGDT)
"RTN","WVUTL7",98,0)
 W " to ",$$SLDT2^WVUTL5(WVENDDT)
"RTN","WVUTL7",99,0)
 W !,$$REPEAT^XLFSTR("=",80)
"RTN","WVUTL7",100,0)
 I $D(WVSUBH) D @WVSUBH
"RTN","WVUTL7",101,0)
 Q
"RTN","WVUTL7",102,0)
 ;
"RTN","WVUTL7",103,0)
HEADER4 ;EP
"RTN","WVUTL7",104,0)
 ;---> PATIENT REPORT HEADER: ONE PATIENT, ONE PROCEDURE.
"RTN","WVUTL7",105,0)
 ;---> REQUIRED VARIABLES: WVBEGDT,WVCRT,WVENDDT,WVPAGE,WVTITLE1,DUZ(2)
"RTN","WVUTL7",106,0)
 ;---> OPTIONAL VARIABLE:  WVCONF (CONFIDENTIAL), WVSUBH (SUBHEADER).
"RTN","WVUTL7",107,0)
 W:WVPAGE>1!WVCRT @IOF,!
"RTN","WVUTL7",108,0)
 W WVCONFF W:'WVCRT !,WVTIMLN
"RTN","WVUTL7",109,0)
 W !!,WVTITLE1,?70,"page: ",WVPAGE S WVPAGE=WVPAGE+1
"RTN","WVUTL7",110,0)
HEADER41 ;EP
"RTN","WVUTL7",111,0)
 ;---> CALLED BY WVPROC; BYPASSES FORMFEED, TITLE, ETC.
"RTN","WVUTL7",112,0)
 N WVDES
"RTN","WVUTL7",113,0)
 W !!,$$RUNDT^WVUTL1A("C")
"RTN","WVUTL7",114,0)
 W !,"Patient Name: ",WVNAMAGE,?53,$$PNLAB^WVUTL5(),WVCHRT
"RTN","WVUTL7",115,0)
 W !,"Case Manager: ",WVCMGR
"RTN","WVUTL7",116,0)
 W ?50,"Procedure: ",$E(WVPN,1,19)
"RTN","WVUTL7",117,0)
 W !,"PAP Regimen : ",WVPAPRG
"RTN","WVUTL7",118,0)
 W ?55,"Acc#: ",WVACCN
"RTN","WVUTL7",119,0)
 W !,"Cx Tx Need  : ",WVCNEED
"RTN","WVUTL7",120,0)
 W ?48,"Cx Facility: ",$$FACIL^WVUTL1A(WVDFN,"C")
"RTN","WVUTL7",121,0)
 W !,"Br Tx Need  : ",WVBNEED
"RTN","WVUTL7",122,0)
 W ?48,"Br Facility: ",$$FACIL^WVUTL1A(WVDFN,"B")
"RTN","WVUTL7",123,0)
 W !,"Sexual Trauma: ",$$MST^WVUTL1A(WVDFN)
"RTN","WVUTL7",124,0)
 W ?52,"Veteran: ",$$VET^WVUTL1A(WVDFN)
"RTN","WVUTL7",125,0)
 S WVDES=$$DES^WVUTL1(WVDFN)
"RTN","WVUTL7",126,0)
 W !,$S(WVDES="YES":"*DES DAUGHTER*",1:"--------------")
"RTN","WVUTL7",127,0)
 W $$REPEAT^XLFSTR("-",37)
"RTN","WVUTL7",128,0)
 W $S(WVEDC]"":WVEDC_"----",1:"-----------------------------")
"RTN","WVUTL7",129,0)
 Q
"RTN","WVUTL7",130,0)
 ;
"RTN","WVUTL7",131,0)
HEADER5 ;EP
"RTN","WVUTL7",132,0)
 ;---> DELINQUENT NEEDS REPORT HEADER: MULTIPLE PATIENTS
"RTN","WVUTL7",133,0)
 ;---> REQUIRED VARIABLES: WVBEGDT,WVCRT,WVENDDT,WVPAGE,WVTITLE,DUZ(2)
"RTN","WVUTL7",134,0)
 ;---> OPTIONAL VARIABLE:  WVCONF (CONFIDENTIAL), WVSUBH (SUBHEADER).
"RTN","WVUTL7",135,0)
 N X
"RTN","WVUTL7",136,0)
 W:WVPAGE>1!WVCRT @IOF,!
"RTN","WVUTL7",137,0)
 W:$D(WVCONF) WVCONFF,! W:'WVCRT WVTIMLN,!
"RTN","WVUTL7",138,0)
 W !,WVTITLE W:'WVCRT ?70,"page: ",WVPAGE
"RTN","WVUTL7",139,0)
 W !,"Case Mgr: " D
"RTN","WVUTL7",140,0)
 .I '$D(WVE) W "ALL" Q
"RTN","WVUTL7",141,0)
 .I WVE W "ALL" Q
"RTN","WVUTL7",142,0)
 .I $G(WVMGR)']"" W "UNKNOWN" Q
"RTN","WVUTL7",143,0)
 .N WVCMGRNM
"RTN","WVUTL7",144,0)
 .S WVCMGRNM=$$GET1^DIQ(200,WVMGR,.01,"E")
"RTN","WVUTL7",145,0)
 .W $S(WVCMGRNM]"":WVCMGRNM,1:"UNKNOWN")
"RTN","WVUTL7",146,0)
 S Y=DT D DD^%DT W ?46,"Run Date: ",Y
"RTN","WVUTL7",147,0)
 W !,"Facility: ",$$INSTTX^WVUTL6(WVFAC)
"RTN","WVUTL7",148,0)
 W ?46,"Tx Needs Past Due as of ",$$SLDT2^WVUTL5(WVDDATE)
"RTN","WVUTL7",149,0)
 W !,$$REPEAT^XLFSTR("=",80)
"RTN","WVUTL7",150,0)
 I $D(WVSUBH) D @WVSUBH
"RTN","WVUTL7",151,0)
 Q
"RTN","WVUTL7",152,0)
 ;
"RTN","WVUTL7",153,0)
HEADER6 ;EP
"RTN","WVUTL7",154,0)
 ;---> PROGRAM SNAPSHOT HEADER: JUST TITLE AND FACILITY (NO PATIENTS)
"RTN","WVUTL7",155,0)
 ;---> REQUIRED VARIABLES: WVCRT,WVTITLE,DUZ(2)
"RTN","WVUTL7",156,0)
 N X
"RTN","WVUTL7",157,0)
 W:WVPAGE>1!WVCRT @IOF,!
"RTN","WVUTL7",158,0)
 W:'WVCRT !,WVTIMLN,!
"RTN","WVUTL7",159,0)
 W !,WVTITLE W:'WVCRT ?70,"page: ",WVPAGE
"RTN","WVUTL7",160,0)
 W !?3,$$RUNDT^WVUTL1A(DT) I $D(WVJTOY) W ?60,"(",WVJTOY,")"
"RTN","WVUTL7",161,0)
 W !,"   Note: This report includes all divisions"
"RTN","WVUTL7",162,0)
 W " using this database."
"RTN","WVUTL7",163,0)
 W !,$$REPEAT^XLFSTR("=",80)
"RTN","WVUTL7",164,0)
 I $D(WVSUBH) D @WVSUBH
"RTN","WVUTL7",165,0)
 Q
"RTN","WVUTL7",166,0)
 ;
"RTN","WVUTL7",167,0)
HEADER7 ;EP
"RTN","WVUTL7",168,0)
 ;---> AUTOLOAD OF PATIENTS HEADER
"RTN","WVUTL7",169,0)
 ;---> REQUIRED VARIABLES: WVCRT,WVTITLE,DUZ(2)
"RTN","WVUTL7",170,0)
 N X
"RTN","WVUTL7",171,0)
 W:WVPAGE>1!WVCRT @IOF,!
"RTN","WVUTL7",172,0)
 W:$D(WVCONF) WVCONFF,! W:'WVCRT WVTIMLN,!
"RTN","WVUTL7",173,0)
 W !,WVTITLE W:'WVCRT ?70,"page: ",WVPAGE S WVPAGE=WVPAGE+1
"RTN","WVUTL7",174,0)
 W !!,$$RUNDT^WVUTL1A("C")
"RTN","WVUTL7",175,0)
 W !,"Facility: ",$$INSTTX^WVUTL6(DUZ(2))
"RTN","WVUTL7",176,0)
 W ?64,"Cutoff Age: ",WVAGE
"RTN","WVUTL7",177,0)
 W !,$$REPEAT^XLFSTR("=",80)
"RTN","WVUTL7",178,0)
 W !,?3,"NAME",?30,$$PNLB^WVUTL5(),?45,"DOB",?60,"STATUS"
"RTN","WVUTL7",179,0)
 W !,WVLINE
"RTN","WVUTL7",180,0)
 Q
"RTN","WVUTL7",181,0)
 ;
"RTN","WVUTL7",182,0)
HEADER8 ;EP
"RTN","WVUTL7",183,0)
 ;---> SCREENING RATES REPORT HEADER: (NO PATIENTS)
"RTN","WVUTL7",184,0)
 ;---> REQUIRED VARIABLES: WVCRT,WVTITLE,DUZ(2)
"RTN","WVUTL7",185,0)
 N X
"RTN","WVUTL7",186,0)
 W:WVPAGE>1!WVCRT @IOF,!
"RTN","WVUTL7",187,0)
 W:'WVCRT !,WVTIMLN,!
"RTN","WVUTL7",188,0)
 W !,WVTITLE W:'WVCRT ?70,"page: ",WVPAGE
"RTN","WVUTL7",189,0)
 W !!?4,"For Age Range: ",$S(WVAGRG=1:"ALL",1:WVAGRG)
"RTN","WVUTL7",190,0)
 W ?56,"For period: ",$$SLDT2^WVUTL5(WVBEGDT)
"RTN","WVUTL7",191,0)
 S Y=DT D DD^%DT W !?4,"Run Date: ",Y
"RTN","WVUTL7",192,0)
 W ?64,"To: ",$$SLDT2^WVUTL5(WVENDDT)
"RTN","WVUTL7",193,0)
 W !,$$REPEAT^XLFSTR("=",80)
"RTN","WVUTL7",194,0)
 W !?4,"(Note: This report includes all divisions using this database.)"
"RTN","WVUTL7",195,0)
 W !?11,"Number of Active Patients: "_$G(WVTOT),!
"RTN","WVUTL7",196,0)
 Q
"RTN","WVUTL7",197,0)
 ;
"RTN","WVUTL7",198,0)
ENDREP(X) ;EP
"RTN","WVUTL7",199,0)
 ;---> END A REPORT, DO FORMFEED OR "Press <Return>" IF NECESSARY.
"RTN","WVUTL7",200,0)
 ;---> REQUIRED VARIABLES: WVCRT=1 IF OUTPUT TO SCREEN
"RTN","WVUTL7",201,0)
 ;--->                     WVPOP=1 IF ESCAPING
"RTN","WVUTL7",202,0)
 ;---> OPTIONAL VARIABLE:  X=1 IF "End of Report" SHOULD NOT DISPLAY.
"RTN","WVUTL7",203,0)
 ;
"RTN","WVUTL7",204,0)
 S WVTITLE="-----  End of Report  -----"
"RTN","WVUTL7",205,0)
 I '$G(X)&('WVPOP) D CENTERT^WVUTL5(.WVTITLE) W !,WVTITLE
"RTN","WVUTL7",206,0)
 I WVCRT&('$D(IO("S")))&('WVPOP) D DIRZ^WVUTL3 W @IOF,!
"RTN","WVUTL7",207,0)
 D ^%ZISC
"RTN","WVUTL7",208,0)
 Q
"RTN","WVUTL9")
0^1^B5186118
"RTN","WVUTL9",1,0)
WVUTL9 ;HCIOFO/FT-Women's Health Utility Routine; ;10/6/99  12:21
"RTN","WVUTL9",2,0)
 ;;1.0;WOMEN'S HEALTH;**3,7**;Sep 30, 1998
"RTN","WVUTL9",3,0)
 ;
"RTN","WVUTL9",4,0)
DCM(SITE) ; Default case manager check
"RTN","WVUTL9",5,0)
 ; If there is a default case manager return 1 else 0.
"RTN","WVUTL9",6,0)
 I 'SITE Q 0
"RTN","WVUTL9",7,0)
 I $P($G(^WV(790.02,SITE,0)),U,2) Q 1
"RTN","WVUTL9",8,0)
 Q 0
"RTN","WVUTL9",9,0)
 ;
"RTN","WVUTL9",10,0)
NODCM ; No Default Case Manager message
"RTN","WVUTL9",11,0)
 W !,"Sorry, but a DEFAULT CASE MANAGER must be assigned for your facility"
"RTN","WVUTL9",12,0)
 W !,"before a patient can be entered into the Women's Health database.",!
"RTN","WVUTL9",13,0)
 W !,"Please use the EDIT SITE PARAMETERS option on the FILE MAINTENANCE"
"RTN","WVUTL9",14,0)
 W !,"menu to designate a DEFAULT CASE MANAGER.",!
"RTN","WVUTL9",15,0)
 D DIRZ^WVUTL3
"RTN","WVUTL9",16,0)
 Q
"RTN","WVUTL9",17,0)
 ;
"RTN","WVUTL9",18,0)
AGE(DFN) ;EP
"RTN","WVUTL9",19,0)
 ;---> YIELD PATIENT'S AGE IN YEARS.
"RTN","WVUTL9",20,0)
 ;---> REQUIRED VARIABLE: DFN=IEN PATIENT FILE
"RTN","WVUTL9",21,0)
 ; Different from AGE^WVUTL1. This EP returns age at date of death.
"RTN","WVUTL9",22,0)
 N X,X1,X2
"RTN","WVUTL9",23,0)
 Q:'$G(DFN) "NO PATIENT"
"RTN","WVUTL9",24,0)
 S X2=$$DOB^WVUTL1(DFN)
"RTN","WVUTL9",25,0)
 Q:'+X2 "UNKNOWN"
"RTN","WVUTL9",26,0)
 S X1=DT
"RTN","WVUTL9",27,0)
 I $$DECEASED^WVUTL1(DFN) S X1=+^DPT(DFN,.35)
"RTN","WVUTL9",28,0)
 D ^%DTC
"RTN","WVUTL9",29,0)
 Q $P(X/365.25,".")_"y/o"
"RTN","WVUTL9",30,0)
 ;
"RTN","WVUTL9",31,0)
GAPPT(DFN) ; Get future appointments from SDA^VADPT
"RTN","WVUTL9",32,0)
 ; Returns ^UTILITY("VASD",$J,#,"I") <-internal values
"RTN","WVUTL9",33,0)
 ;         ^UTILITY("VASD",$J,#,"E") <-external vlaues
"RTN","WVUTL9",34,0)
 ; piece 1: appointment date/time
"RTN","WVUTL9",35,0)
 ;       2: clinic
"RTN","WVUTL9",36,0)
 ;       3: status
"RTN","WVUTL9",37,0)
 ;       4: type
"RTN","WVUTL9",38,0)
 Q:'$G(DFN)
"RTN","WVUTL9",39,0)
 N VASD,VAERR
"RTN","WVUTL9",40,0)
 S VASD("F")=$$NOW^XLFDT,VASD("W")=1 ;get active/kept appts 
"RTN","WVUTL9",41,0)
 D SDA^VADPT
"RTN","WVUTL9",42,0)
 Q
"RTN","WVUTL9",43,0)
KAPPT(DFN) ; Kill APPOINTMENTS multiple
"RTN","WVUTL9",44,0)
 Q:'$G(DFN)
"RTN","WVUTL9",45,0)
 N DA,DIK
"RTN","WVUTL9",46,0)
 S DA=0,DA(1)=DFN
"RTN","WVUTL9",47,0)
 F  S DA=$O(^WV(790,DFN,2,DA)) Q:'DA  D
"RTN","WVUTL9",48,0)
 .S DIK="^WV(790,"_DFN_",2,"
"RTN","WVUTL9",49,0)
 .D ^DIK
"RTN","WVUTL9",50,0)
 .Q
"RTN","WVUTL9",51,0)
 Q
"RTN","WVUTL9",52,0)
SAPPT(DFN) ; Set APPOINTMENTS multiple
"RTN","WVUTL9",53,0)
 Q:'$G(DFN)
"RTN","WVUTL9",54,0)
 Q:'$D(^WV(790,DFN))
"RTN","WVUTL9",55,0)
 N DA,DIC,DLAYGO,LOOP,X
"RTN","WVUTL9",56,0)
 S LOOP=0,DIC="^WV(790,"_DFN_",2,",DIC(0)="L",DA(1)=DFN,DLAYGO=790
"RTN","WVUTL9",57,0)
 S DIC("P")=$P(^DD(790,2,0),U,2)
"RTN","WVUTL9",58,0)
 I '$D(^UTILITY("VASD",$J))  D  Q  ;no appts passed from SDA^VADPT
"RTN","WVUTL9",59,0)
 .S X="No Future Appointments"
"RTN","WVUTL9",60,0)
 .D ^DIC
"RTN","WVUTL9",61,0)
 .Q
"RTN","WVUTL9",62,0)
 F  S LOOP=$O(^UTILITY("VASD",$J,LOOP)) Q:'LOOP  D
"RTN","WVUTL9",63,0)
 .S X=$G(^UTILITY("VASD",$J,LOOP,"E"))
"RTN","WVUTL9",64,0)
 .Q:X=""
"RTN","WVUTL9",65,0)
 .S X=$P(X,U,1)_"   Clinic: "_$P(X,U,2)
"RTN","WVUTL9",66,0)
 .D ^DIC
"RTN","WVUTL9",67,0)
 .Q
"RTN","WVUTL9",68,0)
 Q
"RTN","WVUTL9",69,0)
KILLUG ; Kill Utility Global created by SDA^VADPT call
"RTN","WVUTL9",70,0)
 K ^UTILITY("VASD",$J)
"RTN","WVUTL9",71,0)
 Q
"RTN","WVUTL9",72,0)
IEN(WVFILE,WVALUE) ; Return ien of entry
"RTN","WVUTL9",73,0)
 ; input: WVFILE - File number
"RTN","WVUTL9",74,0)
 ;        WVALUE - value of the .01 field
"RTN","WVUTL9",75,0)
 I 'WVFILE!(WVALUE="") Q 0
"RTN","WVUTL9",76,0)
 Q +$O(^WV(WVFILE,"B",WVALUE,0))
"RTN","WVUTL9",77,0)
 ;
"UP",790,790.09,-1)
790^2
"UP",790,790.09,0)
790.09
"VER")
8.0^22.0
"^DD",790,790,.15,0)
DES DAUGHTER^S^1:YES;0:NO;9:UNKNOWN;^0;15^Q
"^DD",790,790,.15,3)
Enter 'Yes' if this patient's mother took DES when she was pregnant with this patient.
"^DD",790,790,.15,21,0)
^^2^2^2990524^^
"^DD",790,790,.15,21,1,0)
This field indicates if this patient's mother took diethylstilbestrol
"^DD",790,790,.15,21,2,0)
(DES) when she was pregnant with this patient.
"^DD",790,790,.15,"DT")
2990524
"^DD",790,790,.23,0)
FAMILY HX OF BR CA^S^0:no family history;1:2nd degree relative;2:1st degree relative;3:>1 1st degree relatives;4:personal history;9:unknown;^0;23^Q
"^DD",790,790,.23,3)
Enter the code that describes the category of relative(s) who have had breast cancer.  (1st degree relative is a sister/mother, 2nd degree relatives are extended family.)
"^DD",790,790,.23,21,0)
^^5^5^2990524^
"^DD",790,790,.23,21,1,0)
This field identifies if the patient or the patient's relatives have had
"^DD",790,790,.23,21,2,0)
breast cancer. The information may be selected from a set of codes to
"^DD",790,790,.23,21,3,0)
indicate unknown, personal history, no family history, a 2nd degree
"^DD",790,790,.23,21,4,0)
relative (cousin, aunt, grandmother), a 1st degree relative (mother OR
"^DD",790,790,.23,21,5,0)
sister) or multiple 1st degree relatives (mother AND sister).
"^DD",790,790,.23,"DT")
2990524
"^DD",790,790,.27,0)
SEXUAL TRAUMA^S^M:Military;C:Civilian;B:Both;N:None;^0;27^Q
"^DD",790,790,.27,21,0)
^^2^2^2990524^^
"^DD",790,790,.27,21,1,0)
This field indicates if the patient has experienced any sexual trauma
"^DD",790,790,.27,21,2,0)
(rape, sexual assault, etc.) either in the military and/or as a civilian.
"^DD",790,790,.27,"DT")
2990524
"^DD",790,790,2,0)
APPOINTMENTS^790.09A^^2;0
"^DD",790,790,2,21,0)
^^1^1^2990903^
"^DD",790,790,2,21,1,0)
This multiple contains the patient's future appointments.
"^DD",790,790.09,0)
APPOINTMENTS SUB-FIELD^^.01^1
"^DD",790,790.09,0,"DT")
2990318
"^DD",790,790.09,0,"IX","B",790.09,.01)

"^DD",790,790.09,0,"NM","APPOINTMENTS")

"^DD",790,790.09,0,"UP")
790
"^DD",790,790.09,.01,0)
APPOINTMENTS^F^^0;1^K:$L(X)>80!($L(X)<3) X
"^DD",790,790.09,.01,1,0)
^.1
"^DD",790,790.09,.01,1,1,0)
790.09^B
"^DD",790,790.09,.01,1,1,1)
S ^WV(790,DA(1),2,"B",$E(X,1,30),DA)=""
"^DD",790,790.09,.01,1,1,2)
K ^WV(790,DA(1),2,"B",$E(X,1,30),DA)
"^DD",790,790.09,.01,3)
Answer must be 3-80 characters in length.
"^DD",790,790.09,.01,21,0)
^^8^8^2990903^^
"^DD",790,790.09,.01,21,1,0)
This field contains the external date of the appointment concatenated to
"^DD",790,790.09,.01,21,2,0)
the name of the clinic. This field value is set by the WVUTL9 routine when
"^DD",790,790.09,.01,21,3,0)
a WH user displays/prints a notification letter. If there are no future
"^DD",790,790.09,.01,21,4,0)
appointments scheduled, then the value "No Future Appointments" is stored
"^DD",790,790.09,.01,21,5,0)
in this field.
"^DD",790,790.09,.01,21,6,0)
 
"^DD",790,790.09,.01,21,7,0)
The future appointments are displayed in the text of the letter only when
"^DD",790,790.09,.01,21,8,0)
"|APPOINTMENTS|" (without the quotes) appears in the form letter template.
"^DD",790,790.09,.01,"DT")
2990318
"^DD",790.02,790.02,39.01,0)
TUBE ACTIVE^S^1:YES;0:NO;^39;1^Q
"^DD",790.02,790.02,39.01,3)
If users should NOT be allowed to select tubal ligation when entering new procedures at this site, then enter 'No' to make it inactive. Enter 'Yes' to make tubal ligation active.
"^DD",790.02,790.02,39.01,21,0)
^^4^4^2990701^
"^DD",790.02,790.02,39.01,21,1,0)
This field stores a value (1 = Yes; 0 = No) that is used to display or
"^DD",790.02,790.02,39.01,21,2,0)
remove the tubal ligation procedure from the procedure look-up list. If
"^DD",790.02,790.02,39.01,21,3,0)
the procedure is to be included in the tracking of women's health care and
"^DD",790.02,790.02,39.01,21,4,0)
treatment needs, this field value should be 'Yes'.
"^DD",790.02,790.02,39.01,"DT")
2990701
"^DD",790.02,790.02,39.03,0)
TUBE DEF DAYS DELINQ^NJ4,0^^39;3^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1N.N) X
"^DD",790.02,790.02,39.03,3)
Enter the default number of days a tubal ligation will be allowed to remain 'Open' before being marked as 'Delinquent'.
"^DD",790.02,790.02,39.03,21,0)
^^7^7^2990701^
"^DD",790.02,790.02,39.03,21,1,0)
This field stores the number of days that a patient's tubal ligation
"^DD",790.02,790.02,39.03,21,2,0)
procedure record is allowed to have an open status.  The software uses
"^DD",790.02,790.02,39.03,21,3,0)
this date to calculate the Complete by (Date) field that resides in the WV
"^DD",790.02,790.02,39.03,21,4,0)
Procedure (790.1) file and which is displayed in the procedure edit
"^DD",790.02,790.02,39.03,21,5,0)
options. Indirectly this file is used to establish a date that the open
"^DD",790.02,790.02,39.03,21,6,0)
procedure is considered delinquent and reflected in the Browse Procedures
"^DD",790.02,790.02,39.03,21,7,0)
and Program Snapshot reports.
"^DD",790.02,790.02,39.03,"DT")
2990701
"^DD",790.02,790.02,40.01,0)
PELUS ACTIVE^S^1:YES;0:NO;^40;1^Q
"^DD",790.02,790.02,40.01,3)
If users should NOT be allowed to select pelvic ultrasound when entering new procedures at this site, then enter 'No' to make it inactive. Enter 'Yes' to make pelvic ultrasound active.
"^DD",790.02,790.02,40.01,21,0)
^^4^4^2990701^
"^DD",790.02,790.02,40.01,21,1,0)
This field stores a value (1 = Yes; 0 = No) that is used to display or
"^DD",790.02,790.02,40.01,21,2,0)
remove the pelvic ultrasound procedure from the procedure look-up list.
"^DD",790.02,790.02,40.01,21,3,0)
If the procedure is to be included in the tracking of women's health care
"^DD",790.02,790.02,40.01,21,4,0)
and treatment needs, this field value should be 'Yes'.
"^DD",790.02,790.02,40.01,"DT")
2990701
"^DD",790.02,790.02,40.03,0)
PELUS DEF DAYS DELINQ^NJ4,0^^40;3^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1N.N) X
"^DD",790.02,790.02,40.03,3)
Enter the default number of days a pelvic ultrasound will be allowed to remain 'Open' before being marked as 'Delinquent'.
"^DD",790.02,790.02,40.03,21,0)
^^7^7^2990701^
"^DD",790.02,790.02,40.03,21,1,0)
This field stores the number of days that a patient's pelvic ultrasound
"^DD",790.02,790.02,40.03,21,2,0)
procedure record is allowed to have an open status.  The software uses
"^DD",790.02,790.02,40.03,21,3,0)
this date to calculate the Complete by (Date) field that resides in the WV
"^DD",790.02,790.02,40.03,21,4,0)
Procedure (790.1) file and which is displayed in the procedure edit
"^DD",790.02,790.02,40.03,21,5,0)
options. Indirectly this file is used to establish a date that the open
"^DD",790.02,790.02,40.03,21,6,0)
procedure is considered delinquent and reflected in the Browse Procedures
"^DD",790.02,790.02,40.03,21,7,0)
and Program Snapshot reports.
"^DD",790.02,790.02,40.03,"DT")
2990701
"^DD",790.02,790.02,41.01,0)
VAGUS ACTIVE^S^1:YES;0:NO;^41;1^Q
"^DD",790.02,790.02,41.01,3)
If users should NOT be allowed to select vaginal ultrasound when entering new procedures at this site, then enter 'No' to make it inactive. Enter 'Yes' to make vaginal ultrasound active.
"^DD",790.02,790.02,41.01,21,0)
^^4^4^2990701^
"^DD",790.02,790.02,41.01,21,1,0)
This field stores a value (1 = Yes; 0 = No) that is used to display or
"^DD",790.02,790.02,41.01,21,2,0)
remove the vaginal ultrasound procedure from the procedure look-up list.
"^DD",790.02,790.02,41.01,21,3,0)
If the procedure is to be included in the tracking of women's health care
"^DD",790.02,790.02,41.01,21,4,0)
and treatment needs, this field value should be 'Yes'.
"^DD",790.02,790.02,41.01,"DT")
2990701
"^DD",790.02,790.02,41.03,0)
VAGUS DEF DAYS DELINQ^NJ4,0^^41;3^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1N.N) X
"^DD",790.02,790.02,41.03,3)
Enter the default number of days a vaginal ultrasound will be allowed to remian 'Open' before being marked as 'Delinquent'.
"^DD",790.02,790.02,41.03,21,0)
^^7^7^2990728^^
"^DD",790.02,790.02,41.03,21,1,0)
This field stores the number of days that a patient's vaginal ultrasound
"^DD",790.02,790.02,41.03,21,2,0)
procedure record is allowed to have an open status.  The software uses
"^DD",790.02,790.02,41.03,21,3,0)
this date to calculate the Complete by (Date) field that resides in the WV
"^DD",790.02,790.02,41.03,21,4,0)
Procedure (790.1) file and which is displayed in the procedure edit
"^DD",790.02,790.02,41.03,21,5,0)
options. Indirectly this file is used to establish a date that the open
"^DD",790.02,790.02,41.03,21,6,0)
procedure is considered delinquent and reflected in the Browse Procedures
"^DD",790.02,790.02,41.03,21,7,0)
and Program Snapshot reports.
"^DD",790.02,790.02,41.03,"DT")
2990701
"^DD",790.2,790.2,0)
FIELD^^.05^11
"^DD",790.2,790.2,0,"DT")
2990803
"^DD",790.2,790.2,0,"ID",.04)
W "   ",$P(^(0),U,4)
"^DD",790.2,790.2,0,"IX","AC",790.2,.08)

"^DD",790.2,790.2,0,"IX","B",790.2,.01)

"^DD",790.2,790.2,0,"IX","C",790.2,.02)

"^DD",790.2,790.2,0,"IX","D",790.2,.04)

"^DD",790.2,790.2,0,"IX","E",790.2,.2)

"^DD",790.2,790.2,0,"IX","F",790.2,.21)

"^DD",790.2,790.2,0,"NM","WV PROCEDURE TYPE")

"^DD",790.2,790.2,0,"PT",790.1,.04)

"^DD",790.2,790.2,0,"PT",790.3,2)

"^DD",790.2,790.2,0,"PT",790.31,.03)

"^DD",790.2,790.2,0,"PT",790.31,.04)

"^DD",790.2,790.2,0,"PT",790.31,.05)

"^DD",790.2,790.2,0,"PT",790.31,.06)

"^DD",790.2,790.2,0,"PT",790.31,.07)

"^DD",790.2,790.2,0,"PT",790.31,.08)

"^DD",790.2,790.2,0,"PT",790.31,.09)

"^DD",790.2,790.2,0,"PT",790.31,.1)

"^DD",790.2,790.2,0,"PT",790.31,.11)

"^DD",790.2,790.2,0,"PT",790.31,.12)

"^DD",790.2,790.2,0,"PT",790.31,.13)

"^DD",790.2,790.2,0,"PT",790.31,.14)

"^DD",790.2,790.2,0,"PT",790.31,.15)

"^DD",790.2,790.2,0,"PT",790.31,.16)

"^DD",790.2,790.2,0,"PT",790.31,.17)

"^DD",790.2,790.2,0,"PT",790.31,.18)

"^DD",790.2,790.2,0,"PT",790.31,.19)

"^DD",790.2,790.2,0,"VRPK")
WOMEN'S HEALTH
"^DD",790.2,790.2,.01,0)
PROCEDURE TYPE^RF^^0;1^K:$L(X)>30!($L(X)<3)!'(X'?1P.E) X
"^DD",790.2,790.2,.01,1,0)
^.1
"^DD",790.2,790.2,.01,1,1,0)
790.2^B
"^DD",790.2,790.2,.01,1,1,1)
S ^WV(790.2,"B",$E(X,1,30),DA)=""
"^DD",790.2,790.2,.01,1,1,2)
K ^WV(790.2,"B",$E(X,1,30),DA)
"^DD",790.2,790.2,.01,3)
Answer must be 3-30 characters in length.
"^DD",790.2,790.2,.01,21,0)
^^4^4^2980706^
"^DD",790.2,790.2,.01,21,1,0)
This field contains the name of the procedure type.  It may be a test
"^DD",790.2,790.2,.01,21,2,0)
(e.g., mammography, pregnancy test), diagnostic procedure (such as an
"^DD",790.2,790.2,.01,21,3,0)
open biopsy, fine needle aspiration), therapeutic procedure (e.g.,
"^DD",790.2,790.2,.01,21,4,0)
cryotherapy, lumpectomy) or a consult to a specific treating specialty.
"^DD",790.2,790.2,.01,"DT")
2960312
"^DD",790.2,790.2,.02,0)
ABBREVIATION^F^^0;2^K:X[""""!($A(X)=45) X I $D(X) K:$L(X)>8!($L(X)<1) X
"^DD",790.2,790.2,.02,1,0)
^.1
"^DD",790.2,790.2,.02,1,1,0)
790.2^C
"^DD",790.2,790.2,.02,1,1,1)
S ^WV(790.2,"C",$E(X,1,30),DA)=""
"^DD",790.2,790.2,.02,1,1,2)
K ^WV(790.2,"C",$E(X,1,30),DA)
"^DD",790.2,790.2,.02,1,1,"DT")
2940614
"^DD",790.2,790.2,.02,3)
Answer must be 1-8 characters in length.
"^DD",790.2,790.2,.02,21,0)
^^2^2^2980706^
"^DD",790.2,790.2,.02,21,1,0)
This field contains an abbreviation for a procedure type.  The data is
"^DD",790.2,790.2,.02,21,2,0)
used as a display identifier.
"^DD",790.2,790.2,.02,"DT")
2960312
"^DD",790.2,790.2,.03,0)
ASK COLPOSCOPY-TYPE RESULTS^S^0:NO;1:YES;^0;3^Q
"^DD",790.2,790.2,.03,3)
This field indicates that colposcopy-type results (page 2) should be available when editing this procedure.
"^DD",790.2,790.2,.03,21,0)
^^9^9^2980921^
"^DD",790.2,790.2,.03,21,1,0)
This field turns on and off the display of the clinical findings/tissue
"^DD",790.2,790.2,.03,21,2,0)
pathology screen that is used to document clinical exam and pathology
"^DD",790.2,790.2,.03,21,3,0)
information related to specific cervical procedures such as colposcopy,
"^DD",790.2,790.2,.03,21,4,0)
cone biopsy, laser cone and LEEP's. The value of this field should be 1
"^DD",790.2,790.2,.03,21,5,0)
(Yes) when associated with the above procedure types and new procedures
"^DD",790.2,790.2,.03,21,6,0)
that have similar documentation requirements. The clinical findings/tissue
"^DD",790.2,790.2,.03,21,7,0)
pathology screen appears in the Add a NEW Procedure and Edit a Procedure
"^DD",790.2,790.2,.03,21,8,0)
options as page 2.  Information such as related PAP accession #, quadrant
"^DD",790.2,790.2,.03,21,9,0)
involvement, impression, biopsy and staging data may be documented.
"^DD",790.2,790.2,.03,"DT")
2960312
"^DD",790.2,790.2,.04,0)
ACCESSION PREFIX^F^^0;4^K:X[""""!($A(X)=45) X I $D(X) K:$L(X)>10!($L(X)<1) X
"^DD",790.2,790.2,.04,1,0)
^.1
"^DD",790.2,790.2,.04,1,1,0)
790.2^D
"^DD",790.2,790.2,.04,1,1,1)
S ^WV(790.2,"D",$E(X,1,30),DA)=""
"^DD",790.2,790.2,.04,1,1,2)
K ^WV(790.2,"D",$E(X,1,30),DA)
"^DD",790.2,790.2,.04,1,1,"DT")
2950216
"^DD",790.2,790.2,.04,3)
Answer must be 1-10 characters in length.
"^DD",790.2,790.2,.04,21,0)
^^4^4^2980708^^
"^DD",790.2,790.2,.04,21,1,0)
This field contains an abbreviation or synonym that is used to identify
"^DD",790.2,790.2,.04,21,2,0)
the procedure (e.g., CBE = clinical breast exam, CY = Cryotherapy). The
"^DD",790.2,790.2,.04,21,3,0)
data in this field may be concatenated with an accession # to facilitate
"^DD",790.2,790.2,.04,21,4,0)
selection of patient procedures within the software.
"^DD",790.2,790.2,.04,"DT")
2960312
"^DD",790.2,790.2,.05,0)
PACKAGE^S^R:RADIOLOGY/NM;^0;5^Q
"^DD",790.2,790.2,.05,21,0)
^^3^3^2990803^
"^DD",790.2,790.2,.05,21,1,0)
This field contains a letter code that identifies the VistA software
"^DD",790.2,790.2,.05,21,2,0)
package that performs this procedure and stores the results of the
"^DD",790.2,790.2,.05,21,3,0)
procedure.
"^DD",790.2,790.2,.05,"DT")
2990803
"^DD",790.2,790.2,.06,0)
LAST ACCESSION#^F^^0;6^K:$L(X)>15!($L(X)<1) X
"^DD",790.2,790.2,.06,3)
Answer must be 1-15 characters in length.
"^DD",790.2,790.2,.06,21,0)
^^6^6^2980921^
"^DD",790.2,790.2,.06,21,1,0)
This field stores the most recent accession number associated with a
"^DD",790.2,790.2,.06,21,2,0)
specific procedure type.  The accession number is a combination of the
"^DD",790.2,790.2,.06,21,3,0)
year and an incremental number generated by the software. There may be
"^DD",790.2,790.2,.06,21,4,0)
multiple occurrences of the same accession number within the WV Procedure
"^DD",790.2,790.2,.06,21,5,0)
Type file, but concatenation of the accession prefix with the accession #
"^DD",790.2,790.2,.06,21,6,0)
makes this value unique within the software.
"^DD",790.2,790.2,.06,"DT")
2940705
"^DD",790.2,790.2,.08,0)
CPT CODE^P81'^ICPT(^0;8^Q
"^DD",790.2,790.2,.08,1,0)
^.1
"^DD",790.2,790.2,.08,1,1,0)
790.2^AC
"^DD",790.2,790.2,.08,1,1,1)
S ^WV(790.2,"AC",$E(X,1,30),DA)=""
"^DD",790.2,790.2,.08,1,1,2)
K ^WV(790.2,"AC",$E(X,1,30),DA)
"^DD",790.2,790.2,.08,1,1,"%D",0)
^^2^2^2990803^
"^DD",790.2,790.2,.08,1,1,"%D",1,0)
This cross-reference is used to match a WH procedure type to a procedure
"^DD",790.2,790.2,.08,1,1,"%D",2,0)
done in another VistA package (e.g., Radiology/NM).
"^DD",790.2,790.2,.08,1,1,"DT")
2990803
"^DD",790.2,790.2,.08,21,0)
^^3^3^2990804^
"^DD",790.2,790.2,.08,21,1,0)
This field contains the CPT code that corresponds to this procedure type.
"^DD",790.2,790.2,.08,21,2,0)
In Women's Health Version 1.0, the CPT code field is only used to generate
"^DD",790.2,790.2,.08,21,3,0)
local FileMan reports and to identify Radiology/NM procedures.
"^DD",790.2,790.2,.08,"DT")
2990803
"^DD",790.2,790.2,.09,0)
ICD CODE^P80.1'^ICD0(^0;9^Q
"^DD",790.2,790.2,.09,21,0)
^^3^3^2980828^
"^DD",790.2,790.2,.09,21,1,0)
This field contains the ICD code that corresponds to this procedure type.
"^DD",790.2,790.2,.09,21,2,0)
In Women's Health Version 1.0, the ICD code field is only used to generate
"^DD",790.2,790.2,.09,21,3,0)
local FileMan reports.
"^DD",790.2,790.2,.09,"DT")
2940620
"^DD",790.2,790.2,.11,0)
ASK MARGINS CLEAR? QUESTION^S^1:YES;0:NO;^0;11^Q
"^DD",790.2,790.2,.11,3)
Should the question "Margins Clear?" be asked on page 2 of treatment data screen.
"^DD",790.2,790.2,.11,21,0)
^^5^5^2980921^
"^DD",790.2,790.2,.11,21,1,0)
This field permits or denies the user from entering information at the
"^DD",790.2,790.2,.11,21,2,0)
Margins Clear prompt on the clinical findings/tissue pathology screen
"^DD",790.2,790.2,.11,21,3,0)
(page 2) of ADD a NEW Procedure and Edit a Procedure options.  This field
"^DD",790.2,790.2,.11,21,4,0)
does not affect the display of the prompt just the navigation of the
"^DD",790.2,790.2,.11,21,5,0)
cursor on the screen.
"^DD",790.2,790.2,.11,"DT")
2941016
"^DD",790.2,790.2,.2,0)
SYNONYM1^F^^0;20^K:$L(X)>30!($L(X)<1) X
"^DD",790.2,790.2,.2,1,0)
^.1
"^DD",790.2,790.2,.2,1,1,0)
790.2^E
"^DD",790.2,790.2,.2,1,1,1)
S ^WV(790.2,"E",$E(X,1,30),DA)=""
"^DD",790.2,790.2,.2,1,1,2)
K ^WV(790.2,"E",$E(X,1,30),DA)
"^DD",790.2,790.2,.2,1,1,"DT")
2960210
"^DD",790.2,790.2,.2,3)
Enter a synonym for this procedure type.
"^DD",790.2,790.2,.2,21,0)
^^2^2^2980709^
"^DD",790.2,790.2,.2,21,1,0)
This field contains an alternative name for this procedure type.
"^DD",790.2,790.2,.2,21,2,0)
.
"^DD",790.2,790.2,.2,"DT")
2960210
"^DD",790.2,790.2,.21,0)
SYNONYM2^F^^0;21^K:$L(X)>30!($L(X)<1) X
"^DD",790.2,790.2,.21,1,0)
^.1
"^DD",790.2,790.2,.21,1,1,0)
790.2^F
"^DD",790.2,790.2,.21,1,1,1)
S ^WV(790.2,"F",$E(X,1,30),DA)=""
"^DD",790.2,790.2,.21,1,1,2)
K ^WV(790.2,"F",$E(X,1,30),DA)
"^DD",790.2,790.2,.21,1,1,"DT")
2960210
"^DD",790.2,790.2,.21,3)
Enter a synomym for this procedure type.
"^DD",790.2,790.2,.21,21,0)
^^1^1^2980921^
"^DD",790.2,790.2,.21,21,1,0)
This field contains an alternative name for this procedure type.
"^DD",790.2,790.2,.21,"DT")
2960210
"^DD",790.31,790.31,0)
FIELD^^.31^25
"^DD",790.31,790.31,0,"DDA")
N
"^DD",790.31,790.31,0,"DT")
2980507
"^DD",790.31,790.31,0,"ID",.02)
W "   ",$P(^(0),U,2)
"^DD",790.31,790.31,0,"IX","B",790.31,.01)

"^DD",790.31,790.31,0,"IX","C",790.31,.02)

"^DD",790.31,790.31,0,"IX","P10",790.31,.1)

"^DD",790.31,790.31,0,"IX","P11",790.31,.11)

"^DD",790.31,790.31,0,"IX","P12",790.31,.12)

"^DD",790.31,790.31,0,"IX","P13",790.31,.13)

"^DD",790.31,790.31,0,"IX","P14",790.31,.14)

"^DD",790.31,790.31,0,"IX","P15",790.31,.15)

"^DD",790.31,790.31,0,"IX","P16",790.31,.16)

"^DD",790.31,790.31,0,"IX","P17",790.31,.17)

"^DD",790.31,790.31,0,"IX","P18",790.31,.18)

"^DD",790.31,790.31,0,"IX","P19",790.31,.19)

"^DD",790.31,790.31,0,"IX","P3",790.31,.03)

"^DD",790.31,790.31,0,"IX","P4",790.31,.04)

"^DD",790.31,790.31,0,"IX","P5",790.31,.05)

"^DD",790.31,790.31,0,"IX","P6",790.31,.06)

"^DD",790.31,790.31,0,"IX","P7",790.31,.07)

"^DD",790.31,790.31,0,"IX","P8",790.31,.08)

"^DD",790.31,790.31,0,"IX","P9",790.31,.09)

"^DD",790.31,790.31,0,"IX","S",790.31,.3)

"^DD",790.31,790.31,0,"IX","U",790.31,.01)

"^DD",790.31,790.31,0,"NM","WV RESULTS/DIAGNOSIS")

"^DD",790.31,790.31,0,"PT",790.1,.05)

"^DD",790.31,790.31,0,"PT",790.1,.06)

"^DD",790.31,790.31,0,"PT",790.1,.26)

"^DD",790.31,790.31,0,"PT",790.1,.28)

"^DD",790.31,790.31,0,"PT",790.1,.29)

"^DD",790.31,790.31,0,"PT",790.1,.33)

"^DD",790.31,790.31,0,"PT",790.32,.01)

"^DD",790.31,790.31,0,"VRPK")
WOMEN'S HEALTH
"^DD",790.31,790.31,.01,0)
RESULTS/DIAGNOSIS^RF^^0;1^K:X[""""!($A(X)=45) X I $D(X) K:$L(X)>30!($L(X)<3)!'(X'?1P.E) X
"^DD",790.31,790.31,.01,1,0)
^.1
"^DD",790.31,790.31,.01,1,1,0)
790.31^B
"^DD",790.31,790.31,.01,1,1,1)
S ^WV(790.31,"B",$E(X,1,30),DA)=""
"^DD",790.31,790.31,.01,1,1,2)
K ^WV(790.31,"B",$E(X,1,30),DA)
"^DD",790.31,790.31,.01,1,2,0)
790.31^U^MUMPS
"^DD",790.31,790.31,.01,1,2,1)
D UPXREF^WVUTL5(X,"^WV(790.31,")
"^DD",790.31,790.31,.01,1,2,2)
D KUPXREF^WVUTL5(X,"^WV(790.31,")
"^DD",790.31,790.31,.01,1,2,"%D",0)
^^1^1^2960308^
"^DD",790.31,790.31,.01,1,2,"%D",1,0)
Sets uppercase xref.
"^DD",790.31,790.31,.01,1,2,"DT")
2960308
"^DD",790.31,790.31,.01,3)
Answer must be 3-30 characters in length.
"^DD",790.31,790.31,.01,21,0)
^^5^5^2980909^
"^DD",790.31,790.31,.01,21,1,0)
This field contains terms that are used to document results or diagnoses
"^DD",790.31,790.31,.01,21,2,0)
associated with specific procedure types.  The diagnosis or results for
"^DD",790.31,790.31,.01,21,3,0)
PAP smears are based on the Bethesda Classification system; those for
"^DD",790.31,790.31,.01,21,4,0)
mammograms use the American College of Radiology classification.  Entries
"^DD",790.31,790.31,.01,21,5,0)
should not be locally edited.
"^DD",790.31,790.31,.01,"DT")
2960312
"^DD",790.31,790.31,.02,0)
PRIORITY^RNJ2,0^^0;2^K:+X'=X!(X>99)!(X<1)!(X?.E1"."1N.N) X
"^DD",790.31,790.31,.02,1,0)
^.1
"^DD",790.31,790.31,.02,1,1,0)
790.31^C
"^DD",790.31,790.31,.02,1,1,1)
S ^WV(790.31,"C",$E(X,1,30),DA)=""
"^DD",790.31,790.31,.02,1,1,2)
K ^WV(790.31,"C",$E(X,1,30),DA)
"^DD",790.31,790.31,.02,1,1,"DT")
2941007
"^DD",790.31,790.31,.02,3)
Type a Number between 1 and 99, 0 Decimal Digits
"^DD",790.31,790.31,.02,21,0)
^^3^3^2980909^
"^DD",790.31,790.31,.02,21,1,0)
This field stores an arbitrary number used to prioritize the results or
"^DD",790.31,790.31,.02,21,2,0)
diagnosis term. The range is from 1-90 with 90 being defined as normal or
"^DD",790.31,790.31,.02,21,3,0)
no results.
"^DD",790.31,790.31,.02,"DT")
2941013
"^DD",790.31,790.31,.03,0)
ASSOCIATED PROCEDURE-3^P790.2'^WV(790.2,^0;3^Q
"^DD",790.31,790.31,.03,1,0)
^.1
"^DD",790.31,790.31,.03,1,1,0)
790.31^P3^MUMPS
"^DD",790.31,790.31,.03,1,1,1)
S ^WV(790.31,"P",$E(X,1,30),DA)=""
"^DD",790.31,790.31,.03,1,1,2)
K ^WV(790.31,"P",$E(X,1,30),DA)
"^DD",790.31,790.31,.03,1,1,"DT")
2941015
"^DD",790.31,790.31,.03,3)
Select the procedure name with which this procedure result will be associated.
"^DD",790.31,790.31,.03,21,0)
^^3^3^2980909^
"^DD",790.31,790.31,.03,21,1,0)
This field is used to associate the name of a single procedure type stored
"^DD",790.31,790.31,.03,21,2,0)
in the WV Procedure Type (#790.2) file (e.g., PAP smear, CBE, endometrial
"^DD",790.31,790.31,.03,21,3,0)
biopsy, mammogram) with a specific result/diagnosis.
"^DD",790.31,790.31,.03,"DT")
2980507
"^DD",790.31,790.31,.04,0)
ASSOCIATED PROCEDURE-4^P790.2'^WV(790.2,^0;4^Q
"^DD",790.31,790.31,.04,1,0)
^.1
"^DD",790.31,790.31,.04,1,1,0)
790.31^P4^MUMPS
"^DD",790.31,790.31,.04,1,1,1)
S ^WV(790.31,"P",$E(X,1,30),DA)=""
"^DD",790.31,790.31,.04,1,1,2)
K ^WV(790.31,"P",$E(X,1,30),DA)
"^DD",790.31,790.31,.04,1,1,"DT")
2941015
"^DD",790.31,790.31,.04,21,0)
^^3^3^2980909^
"^DD",790.31,790.31,.04,21,1,0)
This field is used to associate the name of a single procedure type stored
"^DD",790.31,790.31,.04,21,2,0)
in the WV Procedure Type (#790.2) file (e.g., PAP smear, CBE, endometrial
"^DD",790.31,790.31,.04,21,3,0)
biopsy, mammogram) with a specific result/diagnosis.
"^DD",790.31,790.31,.04,"DT")
2980507
"^DD",790.31,790.31,.05,0)
ASSOCIATED PROCEDURE-5^P790.2'^WV(790.2,^0;5^Q
"^DD",790.31,790.31,.05,1,0)
^.1
"^DD",790.31,790.31,.05,1,1,0)
790.31^P5^MUMPS
"^DD",790.31,790.31,.05,1,1,1)
S ^WV(790.31,"P",$E(X,1,30),DA)=""
"^DD",790.31,790.31,.05,1,1,2)
K ^WV(790.31,"P",$E(X,1,30),DA)
"^DD",790.31,790.31,.05,1,1,"DT")
2941015
"^DD",790.31,790.31,.05,21,0)
^^3^3^2980909^
"^DD",790.31,790.31,.05,21,1,0)
This field is used to associate the name of a single procedure type stored
"^DD",790.31,790.31,.05,21,2,0)
in the WV Procedure Type (#790.2) file (e.g., PAP smear, CBE, endometrial
"^DD",790.31,790.31,.05,21,3,0)
biopsy, mammogram) with a specific result/diagnosis. 
"^DD",790.31,790.31,.05,"DT")
2980507
"^DD",790.31,790.31,.06,0)
ASSOCIATED PROCEDURE-6^P790.2'^WV(790.2,^0;6^Q
"^DD",790.31,790.31,.06,1,0)
^.1
"^DD",790.31,790.31,.06,1,1,0)
790.31^P6^MUMPS
"^DD",790.31,790.31,.06,1,1,1)
S ^WV(790.31,"P",$E(X,1,30),DA)=""
"^DD",790.31,790.31,.06,1,1,2)
K ^WV(790.31,"P",$E(X,1,30),DA)
"^DD",790.31,790.31,.06,1,1,"DT")
2941015
"^DD",790.31,790.31,.06,21,0)
^^3^3^2980909^
"^DD",790.31,790.31,.06,21,1,0)
This field is used to associate the name of a single procedure type stored
"^DD",790.31,790.31,.06,21,2,0)
in the WV Procedure Type (#790.2) file (e.g., PAP smear, CBE, endometrial
"^DD",790.31,790.31,.06,21,3,0)
biopsy, mammogram) with a specific result/diagnosis. 
"^DD",790.31,790.31,.06,"DT")
2980507
"^DD",790.31,790.31,.07,0)
ASSOCIATED PROCEDURE-7^P790.2'^WV(790.2,^0;7^Q
"^DD",790.31,790.31,.07,1,0)
^.1
"^DD",790.31,790.31,.07,1,1,0)
790.31^P7^MUMPS
"^DD",790.31,790.31,.07,1,1,1)
S ^WV(790.31,"P",$E(X,1,30),DA)=""
"^DD",790.31,790.31,.07,1,1,2)
K ^WV(790.31,"P",$E(X,1,30),DA)
"^DD",790.31,790.31,.07,1,1,"DT")
2941015
"^DD",790.31,790.31,.07,21,0)
^^3^3^2980909^^
"^DD",790.31,790.31,.07,21,1,0)
This field is used to associate the name of a single procedure type stored
"^DD",790.31,790.31,.07,21,2,0)
in the WV Procedure Type (#790.2) file (e.g., PAP smear, CBE, endometrial
"^DD",790.31,790.31,.07,21,3,0)
biopsy, mammogram) with a specific result/diagnosis. 
"^DD",790.31,790.31,.07,"DT")
2980507
"^DD",790.31,790.31,.08,0)
ASSOCIATED PROCEDURE-8^P790.2'^WV(790.2,^0;8^Q
"^DD",790.31,790.31,.08,1,0)
^.1
"^DD",790.31,790.31,.08,1,1,0)
790.31^P8^MUMPS
"^DD",790.31,790.31,.08,1,1,1)
S ^WV(790.31,"P",$E(X,1,30),DA)=""
"^DD",790.31,790.31,.08,1,1,2)
K ^WV(790.31,"P",$E(X,1,30),DA)
"^DD",790.31,790.31,.08,1,1,"DT")
2941015
"^DD",790.31,790.31,.08,21,0)
^^3^3^2980909^^
"^DD",790.31,790.31,.08,21,1,0)
This field is used to associate the name of a single procedure type stored
"^DD",790.31,790.31,.08,21,2,0)
in the WV Procedure Type (#790.2) file (e.g., PAP smear, CBE, endometrial
"^DD",790.31,790.31,.08,21,3,0)
biopsy, mammogram) with a specific result/diagnosis. 
"^DD",790.31,790.31,.08,"DT")
2980507
"^DD",790.31,790.31,.09,0)
ASSOCIATED PROCEDURE-9^P790.2'^WV(790.2,^0;9^Q
"^DD",790.31,790.31,.09,1,0)
^.1
"^DD",790.31,790.31,.09,1,1,0)
790.31^P9^MUMPS
"^DD",790.31,790.31,.09,1,1,1)
S ^WV(790.31,"P",$E(X,1,30),DA)=""
"^DD",790.31,790.31,.09,1,1,2)
K ^WV(790.31,"P",$E(X,1,30),DA)
"^DD",790.31,790.31,.09,1,1,"DT")
2941015
"^DD",790.31,790.31,.09,21,0)
^^3^3^2980909^^
"^DD",790.31,790.31,.09,21,1,0)
This field is used to associate the name of a single procedure type stored
"^DD",790.31,790.31,.09,21,2,0)
in the WV Procedure Type (#790.2) file (e.g., PAP smear, CBE, endometrial
"^DD",790.31,790.31,.09,21,3,0)
biopsy, mammogram) with a specific result/diagnosis. 
"^DD",790.31,790.31,.09,"DT")
2980507
"^DD",790.31,790.31,.1,0)
ASSOCIATED PROCEDURE-10^P790.2'^WV(790.2,^0;10^Q
"^DD",790.31,790.31,.1,1,0)
^.1
"^DD",790.31,790.31,.1,1,1,0)
790.31^P10^MUMPS
"^DD",790.31,790.31,.1,1,1,1)
S ^WV(790.31,"P",$E(X,1,30),DA)=""
"^DD",790.31,790.31,.1,1,1,2)
K ^WV(790.31,"P",$E(X,1,30),DA)
"^DD",790.31,790.31,.1,1,1,"DT")
2941016
"^DD",790.31,790.31,.1,21,0)
^^3^3^2980909^
"^DD",790.31,790.31,.1,21,1,0)
This field is used to associate the name of a single procedure type stored
"^DD",790.31,790.31,.1,21,2,0)
in the WV Procedure Type (#790.2) file (e.g., PAP smear, CBE, endometrial
"^DD",790.31,790.31,.1,21,3,0)
biopsy, mammogram) with a specific result/diagnosis. 
"^DD",790.31,790.31,.1,"DT")
2980507
"^DD",790.31,790.31,.11,0)
ASSOCIATED PROCEDURE-11^P790.2'^WV(790.2,^0;11^Q
"^DD",790.31,790.31,.11,1,0)
^.1
"^DD",790.31,790.31,.11,1,1,0)
790.31^P11^MUMPS
"^DD",790.31,790.31,.11,1,1,1)
S ^WV(790.31,"P",$E(X,1,30),DA)=""
"^DD",790.31,790.31,.11,1,1,2)
K ^WV(790.31,"P",$E(X,1,30),DA)
"^DD",790.31,790.31,.11,1,1,"DT")
2941016
"^DD",790.31,790.31,.11,21,0)
^^3^3^2980909^
"^DD",790.31,790.31,.11,21,1,0)
This field is used to associate the name of a single procedure type stored
"^DD",790.31,790.31,.11,21,2,0)
in the WV Procedure Type (#790.2) file (e.g., PAP smear, CBE, endometrial
"^DD",790.31,790.31,.11,21,3,0)
biopsy, mammogram) with a specific result/diagnosis. 
"^DD",790.31,790.31,.11,"DT")
2980507
"^DD",790.31,790.31,.12,0)
ASSOCIATED PROCEDURE-12^P790.2'^WV(790.2,^0;12^Q
"^DD",790.31,790.31,.12,1,0)
^.1
"^DD",790.31,790.31,.12,1,1,0)
790.31^P12^MUMPS
"^DD",790.31,790.31,.12,1,1,1)
S ^WV(790.31,"P",$E(X,1,30),DA)=""
"^DD",790.31,790.31,.12,1,1,2)
K ^WV(790.31,"P",$E(X,1,30),DA)
"^DD",790.31,790.31,.12,1,1,"DT")
2941016
"^DD",790.31,790.31,.12,21,0)
^^3^3^2980909^
"^DD",790.31,790.31,.12,21,1,0)
This field is used to associate the name of a single procedure type stored
"^DD",790.31,790.31,.12,21,2,0)
in the WV Procedure Type (#790.2) file (e.g., PAP smear, CBE, endometrial
"^DD",790.31,790.31,.12,21,3,0)
biopsy, mammogram) with a specific result/diagnosis. 
"^DD",790.31,790.31,.12,"DT")
2980507
"^DD",790.31,790.31,.13,0)
ASSOCIATED PROCEDURE-13^P790.2'^WV(790.2,^0;13^Q
"^DD",790.31,790.31,.13,1,0)
^.1
"^DD",790.31,790.31,.13,1,1,0)
790.31^P13^MUMPS
"^DD",790.31,790.31,.13,1,1,1)
S ^WV(790.31,"P",$E(X,1,30),DA)=""
"^DD",790.31,790.31,.13,1,1,2)
K ^WV(790.31,"P",$E(X,1,30),DA)
"^DD",790.31,790.31,.13,1,1,"DT")
2960316
"^DD",790.31,790.31,.13,21,0)
^^3^3^2980909^
"^DD",790.31,790.31,.13,21,1,0)
This field is used to associate the name of a single procedure type stored
"^DD",790.31,790.31,.13,21,2,0)
in the WV Procedure Type (#790.2) file (e.g., PAP smear, CBE, endometrial
"^DD",790.31,790.31,.13,21,3,0)
biopsy, mammogram) with a specific result/diagnosis. 
"^DD",790.31,790.31,.13,"DT")
2980507
"^DD",790.31,790.31,.14,0)
ASSOCIATED PROCEDURE-14^P790.2'^WV(790.2,^0;14^Q
"^DD",790.31,790.31,.14,1,0)
^.1
"^DD",790.31,790.31,.14,1,1,0)
790.31^P14^MUMPS
"^DD",790.31,790.31,.14,1,1,1)
S ^WV(790.31,"P",$E(X,1,30),DA)=""
"^DD",790.31,790.31,.14,1,1,2)
K ^WV(790.31,"P",$E(X,1,30),DA)
"^DD",790.31,790.31,.14,1,1,"DT")
2941016
"^DD",790.31,790.31,.14,21,0)
^^3^3^2980909^
"^DD",790.31,790.31,.14,21,1,0)
This field is used to associate the name of a single procedure type stored
"^DD",790.31,790.31,.14,21,2,0)
in the WV Procedure Type (#790.2) file (e.g., PAP smear, CBE, endometrial
"^DD",790.31,790.31,.14,21,3,0)
biopsy, mammogram) with a specific result/diagnosis. 
"^DD",790.31,790.31,.14,"DT")
2980507
"^DD",790.31,790.31,.15,0)
ASSOCIATED PROCEDURE-15^P790.2'^WV(790.2,^0;15^Q
"^DD",790.31,790.31,.15,1,0)
^.1
"^DD",790.31,790.31,.15,1,1,0)
790.31^P15^MUMPS
"^DD",790.31,790.31,.15,1,1,1)
S ^WV(790.31,"P",$E(X,1,30),DA)=""
"^DD",790.31,790.31,.15,1,1,2)
K ^WV(790.31,"P",$E(X,1,30),DA)
"^DD",790.31,790.31,.15,1,1,"DT")
2941016
"^DD",790.31,790.31,.15,21,0)
^^3^3^2980909^
"^DD",790.31,790.31,.15,21,1,0)
This field is used to associate the name of a single procedure type stored
"^DD",790.31,790.31,.15,21,2,0)
in the WV Procedure Type (#790.2) file (e.g., PAP smear, CBE, endometrial
"^DD",790.31,790.31,.15,21,3,0)
biopsy, mammogram) with a specific result/diagnosis. 
"^DD",790.31,790.31,.15,"DT")
2980507
"^DD",790.31,790.31,.16,0)
ASSOCIATED PROCEDURE-16^P790.2'^WV(790.2,^0;16^Q
"^DD",790.31,790.31,.16,1,0)
^.1
"^DD",790.31,790.31,.16,1,1,0)
790.31^P16^MUMPS
"^DD",790.31,790.31,.16,1,1,1)
S ^WV(790.31,"P",$E(X,1,30),DA)=""
"^DD",790.31,790.31,.16,1,1,2)
K ^WV(790.31,"P",$E(X,1,30),DA)
"^DD",790.31,790.31,.16,1,1,"DT")
2941016
"^DD",790.31,790.31,.16,21,0)
^^3^3^2980909^
"^DD",790.31,790.31,.16,21,1,0)
This field is used to associate the name of a single procedure type stored
"^DD",790.31,790.31,.16,21,2,0)
in the WV Procedure Type (#790.2) file (e.g., PAP smear, CBE, endometrial
"^DD",790.31,790.31,.16,21,3,0)
biopsy, mammogram) with a specific result/diagnosis. 
"^DD",790.31,790.31,.16,"DT")
2980507
"^DD",790.31,790.31,.17,0)
ASSOCIATED PROCEDURE-17^P790.2'^WV(790.2,^0;17^Q
"^DD",790.31,790.31,.17,1,0)
^.1
"^DD",790.31,790.31,.17,1,1,0)
790.31^P17^MUMPS
"^DD",790.31,790.31,.17,1,1,1)
S ^WV(790.31,"P",$E(X,1,30),DA)=""
"^DD",790.31,790.31,.17,1,1,2)
K ^WV(790.31,"P",$E(X,1,30),DA)
"^DD",790.31,790.31,.17,1,1,"DT")
2941016
"^DD",790.31,790.31,.17,21,0)
^^3^3^2980909^
"^DD",790.31,790.31,.17,21,1,0)
This field is used to associate the name of a single procedure type stored
"^DD",790.31,790.31,.17,21,2,0)
in the WV Procedure Type (#790.2) file (e.g., PAP smear, CBE, endometrial
"^DD",790.31,790.31,.17,21,3,0)
biopsy, mammogram) with a specific result/diagnosis. 
"^DD",790.31,790.31,.17,"DT")
2980507
"^DD",790.31,790.31,.18,0)
ASSOCIATED PROCEDURE-18^P790.2'^WV(790.2,^0;18^Q
"^DD",790.31,790.31,.18,1,0)
^.1
"^DD",790.31,790.31,.18,1,1,0)
790.31^P18^MUMPS
"^DD",790.31,790.31,.18,1,1,1)
S ^WV(790.31,"P",$E(X,1,30),DA)=""
"^DD",790.31,790.31,.18,1,1,2)
K ^WV(790.31,"P",$E(X,1,30),DA)
"^DD",790.31,790.31,.18,1,1,"DT")
2941016
"^DD",790.31,790.31,.18,21,0)
^^3^3^2980909^
"^DD",790.31,790.31,.18,21,1,0)
This field is used to associate the name of a single procedure type stored
"^DD",790.31,790.31,.18,21,2,0)
in the WV Procedure Type (#790.2) file (e.g., PAP smear, CBE, endometrial
"^DD",790.31,790.31,.18,21,3,0)
biopsy, mammogram) with a specific result/diagnosis. 
"^DD",790.31,790.31,.18,"DT")
2980507
"^DD",790.31,790.31,.19,0)
ASSOCIATED PROCEDURE-19^P790.2'^WV(790.2,^0;19^Q
"^DD",790.31,790.31,.19,1,0)
^.1
"^DD",790.31,790.31,.19,1,1,0)
790.31^P19^MUMPS
"^DD",790.31,790.31,.19,1,1,1)
S ^WV(790.31,"P",$E(X,1,30),DA)=""
"^DD",790.31,790.31,.19,1,1,2)
K ^WV(790.31,"P",$E(X,1,30),DA)
"^DD",790.31,790.31,.19,1,1,"DT")
2941016
"^DD",790.31,790.31,.19,21,0)
^^3^3^2980909^
"^DD",790.31,790.31,.19,21,1,0)
This field is used to associate the name of a single procedure type stored
"^DD",790.31,790.31,.19,21,2,0)
in the WV Procedure Type (#790.2) file (e.g., PAP smear, CBE, endometrial
"^DD",790.31,790.31,.19,21,3,0)
biopsy, mammogram) with a specific result/diagnosis. 
"^DD",790.31,790.31,.19,"DT")
2980507
"^DD",790.31,790.31,.2,0)
ASSOC WITH ALL PROCEDURES^S^1:YES;0:NO;^0;20^Q
"^DD",790.31,790.31,.2,3)
Enter "YES" if this Result/Diagnosis should be associated with ALL Procedures.
"^DD",790.31,790.31,.2,21,0)
^^2^2^2980909^
"^DD",790.31,790.31,.2,21,1,0)
This field indicates, by a set of codes (1 = YES; 0 = NO), that the
"^DD",790.31,790.31,.2,21,2,0)
results/diagnosis should be associated with ALL Procedures.
"^DD",790.31,790.31,.2,"DT")
2941006
"^DD",790.31,790.31,.21,0)
NORMAL/ABNORMAL^RS^0:NORMAL;1:ABNORMAL;2:NO RESULT;^0;21^Q
"^DD",790.31,790.31,.21,3)
'Normal' procedure results will not appear in 'Abnormal Only' reports.
"^DD",790.31,790.31,.21,21,0)
^^3^3^2980917^
"^DD",790.31,790.31,.21,21,1,0)
This field is used to categorize the results/diagnosis of the procedure
"^DD",790.31,790.31,.21,21,2,0)
using a set of codes (0 = Normal, 1 = Abnormal, 2 = No Results).  This
"^DD",790.31,790.31,.21,21,3,0)
data is used in producing the Procedure Statistics report.
"^DD",790.31,790.31,.21,"DT")
2950109
"^DD",790.31,790.31,.22,0)
INCLUDES HPV^S^1:YES;0:NO;^0;22^Q
"^DD",790.31,790.31,.22,3)
Enter 'Yes' if this results/diagnosis includes HPV.
"^DD",790.31,790.31,.22,21,0)
^^3^3^2980917^
"^DD",790.31,790.31,.22,21,1,0)
This field indicates whether the HPV prompt is displayed on the edit
"^DD",790.31,790.31,.22,21,2,0)
screens of the Add a New Procedure and Edit a Procedure options.  Set of
"^DD",790.31,790.31,.22,21,3,0)
codes (1 = Yes, 0 = No).
"^DD",790.31,790.31,.22,"DT")
2941015
"^DD",790.31,790.31,.23,0)
EXCLUDE FROM REGULAR OUTPUTS^S^1:YES;0:NO;^0;23^Q
"^DD",790.31,790.31,.23,3)
Should this result/diagnosis be excluded from most regular reports, profiles, etc.  For example, the result 'Error/disregard' should be 'Yes' here.
"^DD",790.31,790.31,.23,21,0)
^^3^3^2980917^
"^DD",790.31,790.31,.23,21,1,0)
This field contains data (set of codes: 1 = Yes, 0 = No) indicating that a
"^DD",790.31,790.31,.23,21,2,0)
procedure's result/diagnosis be excluded from most regular reports,
"^DD",790.31,790.31,.23,21,3,0)
snapshots, profiles, etc.
"^DD",790.31,790.31,.23,"DT")
2941020
"^DD",790.31,790.31,.3,0)
SYNONYM1^F^^0;30^K:X[""""!($A(X)=45) X I $D(X) K:$L(X)>9!($L(X)<1) X
"^DD",790.31,790.31,.3,1,0)
^.1
"^DD",790.31,790.31,.3,1,1,0)
790.31^S
"^DD",790.31,790.31,.3,1,1,1)
S ^WV(790.31,"S",$E(X,1,30),DA)=""
"^DD",790.31,790.31,.3,1,1,2)
K ^WV(790.31,"S",$E(X,1,30),DA)
"^DD",790.31,790.31,.3,1,1,"DT")
2951104
"^DD",790.31,790.31,.3,3)
Answer must be 1-9 characters in length.
"^DD",790.31,790.31,.3,21,0)
^^3^3^2980917^^
"^DD",790.31,790.31,.3,21,1,0)
This field contains a 1-9 character long abbreviation for the
"^DD",790.31,790.31,.3,21,2,0)
result/diagnosis. A facility may add/edit/delete a synonym to suit its
"^DD",790.31,790.31,.3,21,3,0)
needs.
"^DD",790.31,790.31,.3,"DT")
2960301
"^DD",790.31,790.31,.31,0)
SYNONYM2^F^^0;31^K:$L(X)>9!($L(X)<1) X
"^DD",790.31,790.31,.31,3)
Answer must be 1-9 characters in length.
"^DD",790.31,790.31,.31,21,0)
^^3^3^2980917^^
"^DD",790.31,790.31,.31,21,1,0)
This field contains an additional 1-9 character long abbreviation for the
"^DD",790.31,790.31,.31,21,2,0)
result/diagnosis. A facility may add/edit/delete a synonym to suit its
"^DD",790.31,790.31,.31,21,3,0)
needs.
"^DD",790.31,790.31,.31,"DT")
2960301
"^DD",790.4,790.4,0)
FIELD^^.14^13
"^DD",790.4,790.4,0,"DT")
2980602
"^DD",790.4,790.4,0,"ID",.02)
W "   ",$E($P(^(0),U,2),4,5)_"-"_$E($P(^(0),U,2),6,7)_"-"_$E($P(^(0),U,2),2,3)
"^DD",790.4,790.4,0,"ID",.04)
S %I=Y,Y=$S('$D(^(0)):"",$D(^WV(790.404,+$P(^(0),U,4),0))#2:$P(^(0),U,1),1:""),C=$P(^DD(790.404,.01,0),U,2) D Y^DIQ:Y]"" W "   ",Y,@("$E("_DIC_"%I,0),0)") S Y=%I K %I
"^DD",790.4,790.4,0,"ID",.06)
S %I=Y,Y=$S('$D(^(0)):"",$D(^WV(790.1,+$P(^(0),U,6),0))#2:$P(^(0),U,1),1:""),C=$P(^DD(790.1,.01,0),U,2) D Y^DIQ:Y]"" W "   ",Y,@("$E("_DIC_"%I,0),0)") S Y=%I K %I
"^DD",790.4,790.4,0,"IX","AOPEN",790.4,.02)

"^DD",790.4,790.4,0,"IX","AOPENS",790.4,.14)

"^DD",790.4,790.4,0,"IX","APRT",790.4,.11)

"^DD",790.4,790.4,0,"IX","B",790.4,.01)

"^DD",790.4,790.4,0,"IX","C",790.4,.06)

"^DD",790.4,790.4,0,"IX","D",790.4,.02)

"^DD",790.4,790.4,0,"NM","WV NOTIFICATION")

"^DD",790.4,790.4,0,"VRPK")
WOMEN'S HEALTH
"^DD",790.4,790.4,.01,0)
PATIENT^RP790'^WV(790,^0;1^Q
"^DD",790.4,790.4,.01,1,0)
^.1^^-1
"^DD",790.4,790.4,.01,1,1,0)
790.4^B
"^DD",790.4,790.4,.01,1,1,1)
S ^WV(790.4,"B",$E(X,1,30),DA)=""
"^DD",790.4,790.4,.01,1,1,2)
K ^WV(790.4,"B",$E(X,1,30),DA)
"^DD",790.4,790.4,.01,3)

"^DD",790.4,790.4,.01,21,0)
^^2^2^2980921^
"^DD",790.4,790.4,.01,21,1,0)
This field stores the name of the patient associated with the notification
"^DD",790.4,790.4,.01,21,2,0)
record. Points to the WV Patient (#790) file.
"^DD",790.4,790.4,.01,"DT")
2980507
"^DD",790.4,790.4,.02,0)
DATE NOTIFICATION OPENED^RDX^^0;2^S %DT="EX",%DT(0)=-DT D ^%DT S X=Y K:Y<1 X K %DT(0)
"^DD",790.4,790.4,.02,1,0)
^.1
"^DD",790.4,790.4,.02,1,1,0)
790.4^AOPEN^MUMPS
"^DD",790.4,790.4,.02,1,1,1)
I "o"[$P(^WV(790.4,DA,0),U,14) S ^WV(790.4,"AOPEN",X,DA)=""
"^DD",790.4,790.4,.02,1,1,2)
K ^WV(790.4,"AOPEN",X,DA)
"^DD",790.4,790.4,.02,1,1,"%D",0)
^^3^3^2940818^^^^
"^DD",790.4,790.4,.02,1,1,"%D",1,0)
The "AOPEN",DATE xref, exists only for those entries where there has been
"^DD",790.4,790.4,.02,1,1,"%D",2,0)
no closure to the notification, i.e., the patient has not yet been
"^DD",790.4,790.4,.02,1,1,"%D",3,0)
reached or has not yet responded.
"^DD",790.4,790.4,.02,1,1,"DT")
2940725
"^DD",790.4,790.4,.02,1,2,0)
790.4^D
"^DD",790.4,790.4,.02,1,2,1)
S ^WV(790.4,"D",$E(X,1,30),DA)=""
"^DD",790.4,790.4,.02,1,2,2)
K ^WV(790.4,"D",$E(X,1,30),DA)
"^DD",790.4,790.4,.02,1,2,"DT")
2940714
"^DD",790.4,790.4,.02,3)
This is the date that the notification was first entered, the beginning of the process to contact the patient with information.
"^DD",790.4,790.4,.02,21,0)
^^3^3^2980909^
"^DD",790.4,790.4,.02,21,1,0)
This field stores the date that the notification was entered into
"^DD",790.4,790.4,.02,21,2,0)
database.  It may be today's date or a date in the past.  A future date
"^DD",790.4,790.4,.02,21,3,0)
cannot be associated with this record.
"^DD",790.4,790.4,.02,"DT")
2980722
"^DD",790.4,790.4,.03,0)
TYPE OF NOTIFICATION^P790.403'^WV(790.403,^0;3^Q
"^DD",790.4,790.4,.03,1,0)
^.1^^0
"^DD",790.4,790.4,.03,4)

"^DD",790.4,790.4,.03,21,0)
^^2^2^2980921^
"^DD",790.4,790.4,.03,21,1,0)
This field stores the method used to notify the patient from the choices
"^DD",790.4,790.4,.03,21,2,0)
available in the WV Notification Type (#790.403) file.
"^DD",790.4,790.4,.03,"DT")
2980507
"^DD",790.4,790.4,.04,0)
PURPOSE OF NOTIFICATION^*P790.404'^WV(790.404,^0;4^S DIC("S")="I $P(^(0),U,4)'=0" D ^DIC K DIC S DIC=DIE,X=+Y K:Y<0 X
"^DD",790.4,790.4,.04,12)
Select the purpose for this Notification.
"^DD",790.4,790.4,.04,12.1)
S DIC("S")="I $P(^(0),U,4)'=0"
"^DD",790.4,790.4,.04,21,0)
^^5^5^2980921^
"^DD",790.4,790.4,.04,21,1,0)
This field contains the reason for the notification, (e.g., the results of
"^DD",790.4,790.4,.04,21,2,0)
a test, reminder to schedule a procedure).  The information is required to
"^DD",790.4,790.4,.04,21,3,0)
autoqueue normal PAP and mammogram letters when the appropriate fields
"^DD",790.4,790.4,.04,21,4,0)
(.03, .04, .07 and .08) in the WV Site Parameter (#790.02) file are
"^DD",790.4,790.4,.04,21,5,0)
completed.  Pointer to the WV Notification Purpose (#790.404) file.
"^DD",790.4,790.4,.04,"DT")
2980507
"^DD",790.4,790.4,.05,0)
OUTCOME^*P790.405'^WV(790.405,^0;5^S DIC("S")="I $P(^(0),U,2)'=0" D ^DIC K DIC S DIC=DIE,X=+Y K:Y<0 X
"^DD",790.4,790.4,.05,12)
Select the outcome for this Notification.
"^DD",790.4,790.4,.05,12.1)
S DIC("S")="I $P(^(0),U,2)'=0"
"^DD",790.4,790.4,.05,21,0)
^^4^4^2980921^
"^DD",790.4,790.4,.05,21,1,0)
This field stores the results or outcome, which may be a goal or an event,
"^DD",790.4,790.4,.05,21,2,0)
associated with this patient's notification.  Data used to populate this
"^DD",790.4,790.4,.05,21,3,0)
field is obtained from the Notification Outcome (#790.405) file that can
"^DD",790.4,790.4,.05,21,4,0)
be edited through the Add/Edit Notification Outcomes option by the ADPAC.
"^DD",790.4,790.4,.05,"DT")
2980507
"^DD",790.4,790.4,.06,0)
ACCESSION#^*P790.1'^WV(790.1,^0;6^S DIC("S")="I $D(WVDFN) I $P(^(0),U,2)=WVDFN" D ^DIC K DIC S DIC=DIE,X=+Y K:Y<0 X
"^DD",790.4,790.4,.06,1,0)
^.1
"^DD",790.4,790.4,.06,1,1,0)
790.4^C^MUMPS
"^DD",790.4,790.4,.06,1,1,1)
S ^WV(790.4,"C",$P(^WV(790.1,X,0),U),DA)=""
"^DD",790.4,790.4,.06,1,1,2)
K ^WV(790.4,"C",$P(^WV(790.1,X,0),U))
"^DD",790.4,790.4,.06,1,1,"DT")
2941229
"^DD",790.4,790.4,.06,3)
Select an accession number from the Procedure File for this patient.
"^DD",790.4,790.4,.06,12)
Only Accession#'s pertaining to this patient may be selected.
"^DD",790.4,790.4,.06,12.1)
S DIC("S")="I $D(WVDFN) I $P(^(0),U,2)=WVDFN"
"^DD",790.4,790.4,.06,21,0)
^^2^2^2980921^
"^DD",790.4,790.4,.06,21,1,0)
This field stores the accession number of the procedure associated with
"^DD",790.4,790.4,.06,21,2,0)
this patient's notification.  Pointer to the WV Procedure (#790.1) file.
"^DD",790.4,790.4,.06,"DT")
2980507
"^DD",790.4,790.4,.07,0)
FACILITY^P4'^DIC(4,^0;7^Q
"^DD",790.4,790.4,.07,3)
Select the health care facility initiating or printing this notification.
"^DD",790.4,790.4,.07,21,0)
^^3^3^2980909^
"^DD",790.4,790.4,.07,21,1,0)
This field contains the name of the health care facility that initiated
"^DD",790.4,790.4,.07,21,2,0)
and printed the letter or notification.  Pointer to the Institution (#4)
"^DD",790.4,790.4,.07,21,3,0)
file.
"^DD",790.4,790.4,.07,"DT")
2980507
"^DD",790.4,790.4,.08,0)
DATE NOTIFICATION CLOSED^D^^0;8^S %DT="EX" D ^%DT S X=Y K:Y<1 X
"^DD",790.4,790.4,.08,3)
Enter the date that an outcome for this notification was entered and marked 'Closed'.
"^DD",790.4,790.4,.08,21,0)
^^2^2^2980921^
"^DD",790.4,790.4,.08,21,1,0)
This is the date that an outcome for this notification was entered and
"^DD",790.4,790.4,.08,21,2,0)
marked 'Closed'.
"^DD",790.4,790.4,.08,"DT")
2940722
"^DD",790.4,790.4,.09,0)
PT EDUCATION^S^n:NO;y:YES;^0;9^Q
"^DD",790.4,790.4,.09,3)
Enter whether or not patient education occurred. 
"^DD",790.4,790.4,.09,21,0)
^^2^2^2980921^
"^DD",790.4,790.4,.09,21,1,0)
This field documents, through a set of codes (Y = Yes, N = No), that
"^DD",790.4,790.4,.09,21,2,0)
patient education was provided at the time of the visit.
"^DD",790.4,790.4,.09,"DT")
2980602
"^DD",790.4,790.4,.1,0)
DATE LETTER PRINTED^DX^^0;10^S %DT="ETX",%DT(0)=-DT D ^%DT S X=Y K:Y<1 X K %DT(0)
"^DD",790.4,790.4,.1,3)
If the type of notification is a letter, then enter the date the letter was printed.
"^DD",790.4,790.4,.1,21,0)
^^5^5^2980909^^^
"^DD",790.4,790.4,.1,21,1,0)
This field contains the date on which the notification letter was printed.
"^DD",790.4,790.4,.1,21,2,0)
The date the letter is printed automatically displays through the Add a
"^DD",790.4,790.4,.1,21,3,0)
New Notification and Edit a Notification options.  Data cannot be manually
"^DD",790.4,790.4,.1,21,4,0)
entered by the user through the above options. This field is also used in
"^DD",790.4,790.4,.1,21,5,0)
generating the Program Snapshot and Browse Notifications reports.
"^DD",790.4,790.4,.1,"DT")
2980722
"^DD",790.4,790.4,.11,0)
PRINT DATE^D^^0;11^S %DT="EFX" D ^%DT S X=Y K:Y<1 X
"^DD",790.4,790.4,.11,1,0)
^.1
"^DD",790.4,790.4,.11,1,1,0)
790.4^APRT
"^DD",790.4,790.4,.11,1,1,1)
S ^WV(790.4,"APRT",$E(X,1,30),DA)=""
"^DD",790.4,790.4,.11,1,1,2)
K ^WV(790.4,"APRT",$E(X,1,30),DA)
"^DD",790.4,790.4,.11,1,1,"DT")
2941003
"^DD",790.4,790.4,.11,3)
Enter the date on which you would like this letter printed.
"^DD",790.4,790.4,.11,21,0)
^^8^8^2980909^
"^DD",790.4,790.4,.11,21,1,0)
This field stores the date on which this letter should be queued or
"^DD",790.4,790.4,.11,21,2,0)
printed by the Print Queued Letters option.  The letter will print out on
"^DD",790.4,790.4,.11,21,3,0)
the specified date or later depending on when the Print Queued Letters
"^DD",790.4,790.4,.11,21,4,0)
option is run.  When a default date displays in this field, it is based on
"^DD",790.4,790.4,.11,21,5,0)
whether this letter is a 'reminder' or 'results' letter.  A reminder
"^DD",790.4,790.4,.11,21,6,0)
letter's default date is based on the due date of the treatment need
"^DD",790.4,790.4,.11,21,7,0)
associated with the purpose for notification.  The default date for the
"^DD",790.4,790.4,.11,21,8,0)
results letter is today's date.
"^DD",790.4,790.4,.11,"DT")
2941003
"^DD",790.4,790.4,.13,0)
COMPLETE BY (DATE)^D^^0;13^S %DT="EX" D ^%DT S X=Y K:Y<1 X
"^DD",790.4,790.4,.13,3)
Enter the date this notification will be marked 'Delinquent' if it has not been 'Closed'.
"^DD",790.4,790.4,.13,21,0)
^^4^4^2980909^
"^DD",790.4,790.4,.13,21,1,0)
This field contains the date that this notification will be considered
"^DD",790.4,790.4,.13,21,2,0)
delinquent or past due if it does not have a status of closed.  The value
"^DD",790.4,790.4,.13,21,3,0)
of this field is used to generate the information on the Browse
"^DD",790.4,790.4,.13,21,4,0)
Notifications and Program Snapshot reports.
"^DD",790.4,790.4,.13,"DT")
2940918
"^DD",790.4,790.4,.14,0)
STATUS^S^o:OPEN;c:CLOSED;^0;14^Q
"^DD",790.4,790.4,.14,1,0)
^.1
"^DD",790.4,790.4,.14,1,1,0)
790.4^AOPENS^MUMPS
"^DD",790.4,790.4,.14,1,1,1)
S:"o"[X ^WV(790.4,"AOPEN",$P(^WV(790.4,DA,0),U,2),DA)="" K:X="c" ^WV(790.4,"AOPEN",$P(^WV(790.4,DA,0),U,2),DA)
"^DD",790.4,790.4,.14,1,1,2)
;
"^DD",790.4,790.4,.14,1,1,"DT")
2940913
"^DD",790.4,790.4,.14,3)
Enter the status for this notification.
"^DD",790.4,790.4,.14,21,0)
^^3^3^2980921^
"^DD",790.4,790.4,.14,21,1,0)
This field stores the status (set of codes: O = Open, C = Closed) for this
"^DD",790.4,790.4,.14,21,2,0)
notification.  The value of this field is used in generating the Program
"^DD",790.4,790.4,.14,21,3,0)
Snapshot and Browse Notifications reports.
"^DD",790.4,790.4,.14,"DT")
2940913
"^DD",790.71,790.71,0)
FIELD^^.79^48
"^DD",790.71,790.71,0,"DDA")
N
"^DD",790.71,790.71,0,"DT")
2990706
"^DD",790.71,790.71,0,"ID",.02)
S %I=Y,Y=$S('$D(^(0)):"",$D(^DIC(4,+$P(^(0),U,2),0))#2:$P(^(0),U,1),1:""),C=$P(^DD(4,.01,0),U,2) D Y^DIQ:Y]"" W "   ",Y,@("$E("_DIC_"%I,0),0)") S Y=%I K %I
"^DD",790.71,790.71,0,"ID",.18)
W "   ",@("$P($P($C(59)_$S($D(^DD(790.71,.18,0)):$P(^(0),U,3),1:0)_$E("_DIC_"Y,0),0),$C(59)_$P(^(0),U,18)_"":"",2),$C(59),1)")
"^DD",790.71,790.71,0,"IX","B",790.71,.01)

"^DD",790.71,790.71,0,"IX","C",790.71,.02)

"^DD",790.71,790.71,0,"IX","T",790.71,.18)

"^DD",790.71,790.71,0,"NM","WV SNAPSHOT REPORTS")

"^DD",790.71,790.71,0,"VRPK")
WOMEN'S HEALTH
"^DD",790.71,790.71,.01,0)
DATE OF SNAPSHOT^RDX^^0;1^S %DT="EX" D ^%DT S X=Y S:$D(X) DINUM=X K:Y<1 X
"^DD",790.71,790.71,.01,1,0)
^.1
"^DD",790.71,790.71,.01,1,1,0)
790.71^B
"^DD",790.71,790.71,.01,1,1,1)
S ^WV(790.71,"B",$E(X,1,30),DA)=""
"^DD",790.71,790.71,.01,1,1,2)
K ^WV(790.71,"B",$E(X,1,30),DA)
"^DD",790.71,790.71,.01,3)
Enter the date on which this snapshot report was run.
"^DD",790.71,790.71,.01,21,0)
^^1^1^2980708^
"^DD",790.71,790.71,.01,21,1,0)
This field stores the date on which a Program Snapshot report was run.
"^DD",790.71,790.71,.01,"DT")
2980610
"^DD",790.71,790.71,.02,0)
Facility^P4'^DIC(4,^0;2^Q
"^DD",790.71,790.71,.02,1,0)
^.1
"^DD",790.71,790.71,.02,1,1,0)
790.71^C
"^DD",790.71,790.71,.02,1,1,1)
S ^WV(790.71,"C",$E(X,1,30),DA)=""
"^DD",790.71,790.71,.02,1,1,2)
K ^WV(790.71,"C",$E(X,1,30),DA)
"^DD",790.71,790.71,.02,1,1,"DT")
2950124
"^DD",790.71,790.71,.02,3)
Enter the facility for which this snapshot report was run.
"^DD",790.71,790.71,.02,21,0)
^^2^2^2980708^
"^DD",790.71,790.71,.02,21,1,0)
This field stores the name of the facility for which this Program Snapshot
"^DD",790.71,790.71,.02,21,2,0)
report was run.
"^DD",790.71,790.71,.02,"DT")
2980507
"^DD",790.71,790.71,.03,0)
Total Women in Register^NJ6,0^^0;3^K:+X'=X!(X>999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",790.71,790.71,.03,3)
Type a number between 0 and 999999, 0 decimal digits.
"^DD",790.71,790.71,.03,21,0)
^^2^2^2980708^
"^DD",790.71,790.71,.03,21,1,0)
This field contains the total number of women with active records in the
"^DD",790.71,790.71,.03,21,2,0)
WV Patient (#790) file.
"^DD",790.71,790.71,.03,"DT")
2950123
"^DD",790.71,790.71,.04,0)
Women Who Are Pregnant^NJ6,0^^0;4^K:+X'=X!(X>999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",790.71,790.71,.04,3)
Type a number between 0 and 999999, 0 decimal digits.
"^DD",790.71,790.71,.04,21,0)
^^2^2^2980708^
"^DD",790.71,790.71,.04,21,1,0)
This field contains the number of women who were pregnant at the time
"^DD",790.71,790.71,.04,21,2,0)
the Program Snapshot report option was run.
"^DD",790.71,790.71,.04,"DT")
2950123
"^DD",790.71,790.71,.05,0)
Women Who Are DES Daughters^NJ6,0^^0;5^K:+X'=X!(X>999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",790.71,790.71,.05,3)
Type a number between 0 and 999999, 0 decimal digits.
"^DD",790.71,790.71,.05,21,0)
^^2^2^2980708^
"^DD",790.71,790.71,.05,21,1,0)
This field contains the number of women who were DES daughters when the
"^DD",790.71,790.71,.05,21,2,0)
Program Snapshot report option was run. 
"^DD",790.71,790.71,.05,"DT")
2950123
"^DD",790.71,790.71,.06,0)
PAP Needs Not Spec'd/Dated^NJ6,0^^0;6^K:+X'=X!(X>999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",790.71,790.71,.06,3)
Type a number between 0 and 999999, 0 decimal digits.
"^DD",790.71,790.71,.06,21,0)
^^3^3^2980708^
"^DD",790.71,790.71,.06,21,1,0)
This field contains the number of women whose records indicated that their
"^DD",790.71,790.71,.06,21,2,0)
cervical treatment needs were not specificed or the due date was not
"^DD",790.71,790.71,.06,21,3,0)
recorded.
"^DD",790.71,790.71,.06,"DT")
2950123
"^DD",790.71,790.71,.07,0)
PAP Needs Spec'd & Past Due^NJ6,0^^0;7^K:+X'=X!(X>999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",790.71,790.71,.07,3)
Type a number between 0 and 999999, 0 decimal digits.
"^DD",790.71,790.71,.07,21,0)
^^2^2^2980708^
"^DD",790.71,790.71,.07,21,1,0)
This field contains the number of women whose records indicated that their
"^DD",790.71,790.71,.07,21,2,0)
cervical treatment needs were specificed and are past due.
"^DD",790.71,790.71,.07,"DT")
2950123
"^DD",790.71,790.71,.08,0)
MAM Needs Not Spec'd/Dated^NJ6,0^^0;8^K:+X'=X!(X>999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",790.71,790.71,.08,3)
Type a number between 0 and 999999, 0 decimal digits.
"^DD",790.71,790.71,.08,21,0)
^^3^3^2980708^
"^DD",790.71,790.71,.08,21,1,0)
This field contains the number of women whose records indicated that
"^DD",790.71,790.71,.08,21,2,0)
breast treatment needs were not specificed or the due date was not
"^DD",790.71,790.71,.08,21,3,0)
entered.
"^DD",790.71,790.71,.08,"DT")
2950123
"^DD",790.71,790.71,.09,0)
MAM Needs Spec'd & Past Due^NJ6,0^^0;9^K:+X'=X!(X>999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",790.71,790.71,.09,3)
Type a number between 0 and 999999, 0 decimal digits.
"^DD",790.71,790.71,.09,21,0)
^^2^2^2980708^
"^DD",790.71,790.71,.09,21,1,0)
This field contains the number of women whose records indicated that
"^DD",790.71,790.71,.09,21,2,0)
their breast treatment needs were specificed and are past due.
"^DD",790.71,790.71,.09,"DT")
2950123
"^DD",790.71,790.71,.1,0)
Total Procedures Status OPEN^NJ6,0^^0;10^K:+X'=X!(X>999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",790.71,790.71,.1,3)
Type a number between 0 and 999999, 0 decimal digits.
"^DD",790.71,790.71,.1,21,0)
^^2^2^2980713^^
"^DD",790.71,790.71,.1,21,1,0)
This field contains the number of procedure records that have a status of
"^DD",790.71,790.71,.1,21,2,0)
open.
"^DD",790.71,790.71,.1,"DT")
2950123
"^DD",790.71,790.71,.11,0)
OPEN Procedures Past Due^NJ6,0^^0;11^K:+X'=X!(X>999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",790.71,790.71,.11,3)
Type a number between 0 and 999999, 0 decimal digits.
"^DD",790.71,790.71,.11,21,0)
^^3^3^2980921^
"^DD",790.71,790.71,.11,21,1,0)
This field contains the number of procedure records (with an 'Open'
"^DD",790.71,790.71,.11,21,2,0)
status) which indicate that breast or cervical treatment needs are past
"^DD",790.71,790.71,.11,21,3,0)
due.
"^DD",790.71,790.71,.11,"DT")
2950123
"^DD",790.71,790.71,.12,0)
Total PAPS for the Year^NJ6,0^^0;12^K:+X'=X!(X>999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",790.71,790.71,.12,3)
Type a number between 0 and 999999, 0 decimal digits.
"^DD",790.71,790.71,.12,21,0)
^^2^2^2980921^
"^DD",790.71,790.71,.12,21,1,0)
This field contains a count of the PAP smears done since the beginning of
"^DD",790.71,790.71,.12,21,2,0)
the calendar or fiscal year, depending upon what the user selected.
"^DD",790.71,790.71,.12,"DT")
2980713
"^DD",790.71,790.71,.13,0)
Total MAMS for the Year^NJ6,0^^0;13^K:+X'=X!(X>999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",790.71,790.71,.13,3)
Type a number between 0 and 999999, 0 decimal digits.
"^DD",790.71,790.71,.13,21,0)
^^2^2^2980921^
"^DD",790.71,790.71,.13,21,1,0)
This field contains a count of the mammograms done since the beginning of
"^DD",790.71,790.71,.13,21,2,0)
the calendar or fiscal year, depending upon what the user selected.
"^DD",790.71,790.71,.13,"DT")
2980713
"^DD",790.71,790.71,.14,0)
Total Notifications Stat OPEN^NJ6,0^^0;14^K:+X'=X!(X>999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",790.71,790.71,.14,3)
Type a number between 0 and 999999, 0 decimal digits.
"^DD",790.71,790.71,.14,21,0)
^^2^2^2980713^
"^DD",790.71,790.71,.14,21,1,0)
This field stores the number of notification records, with a status of
"^DD",790.71,790.71,.14,21,2,0)
open, when the Program Snapshot report was run.
"^DD",790.71,790.71,.14,"DT")
2950123
"^DD",790.71,790.71,.15,0)
OPEN Notifications Past Due^NJ6,0^^0;15^K:+X'=X!(X>999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",790.71,790.71,.15,3)
Type a number between 0 and 999999, 0 decimal digits.
"^DD",790.71,790.71,.15,21,0)
^^2^2^2980713^
"^DD",790.71,790.71,.15,21,1,0)
This field contains the number of notification records that were past
"^DD",790.71,790.71,.15,21,2,0)
due when the Program Snaphot report was run. 
"^DD",790.71,790.71,.15,"DT")
2950123
"^DD",790.71,790.71,.16,0)
Number of Letters Queued^NJ6,0^^0;16^K:+X'=X!(X>999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",790.71,790.71,.16,3)
Type a number between 0 and 999999, 0 decimal digits.
"^DD",790.71,790.71,.16,21,0)
^^3^3^2980921^
"^DD",790.71,790.71,.16,21,1,0)
This field contains the number of letters scheduled to be queued at a
"^DD",790.71,790.71,.16,21,2,0)
future time.  This count is calculated from the type of notification and
"^DD",790.71,790.71,.16,21,3,0)
the print date fields in the WV Notification (790.4) file.
"^DD",790.71,790.71,.16,"DT")
2950123
"^DD",790.71,790.71,.17,0)
Total CBEs for the Year^NJ6,0^^0;17^K:+X'=X!(X>999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",790.71,790.71,.17,3)
Type a number between 0 and 999999, 0 decimal digits.
"^DD",790.71,790.71,.17,21,0)
^^3^3^2980921^
"^DD",790.71,790.71,.17,21,1,0)
This field contains a count of the clinical breast exams (CBE) done since
"^DD",790.71,790.71,.17,21,2,0)
the beginning of the calendar or fiscal year, depending upon what the user
"^DD",790.71,790.71,.17,21,3,0)
selected.
"^DD",790.71,790.71,.17,"DT")
2980713
"^DD",790.71,790.71,.18,0)
TYPE OF YEAR^S^F:Fiscal Year;C:Calendar Year;^0;18^Q
"^DD",790.71,790.71,.18,1,0)
^.1
"^DD",790.71,790.71,.18,1,1,0)
790.71^T
"^DD",790.71,790.71,.18,1,1,1)
S ^WV(790.71,"T",$E(X,1,30),DA)=""
"^DD",790.71,790.71,.18,1,1,2)
K ^WV(790.71,"T",$E(X,1,30),DA)
"^DD",790.71,790.71,.18,1,1,"DT")
2980611
"^DD",790.71,790.71,.18,21,0)
^^2^2^2980709^
"^DD",790.71,790.71,.18,21,1,0)
This field contains a code to identify if the report output is for a
"^DD",790.71,790.71,.18,21,2,0)
calendar year (1/1-12/31) or a fiscal year (10/1/-9/30).
"^DD",790.71,790.71,.18,"DT")
2980709
"^DD",790.71,790.71,.5,0)
Breast Ultrasounds^NJ4,0^^2;1^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1N.N) X
"^DD",790.71,790.71,.5,3)
Type a Number between 0 and 9999, 0 Decimal Digits
"^DD",790.71,790.71,.5,21,0)
^^3^3^2980713^
"^DD",790.71,790.71,.5,21,1,0)
This field contains the number of records (in File #790.3) indicating that
"^DD",790.71,790.71,.5,21,2,0)
a patient declined having a breast ultrasound within the timeframe
"^DD",790.71,790.71,.5,21,3,0)
associated with the Program Snapshot report.
"^DD",790.71,790.71,.5,"DT")
2990706
"^DD",790.71,790.71,.51,0)
Clinical Breast Exams^NJ4,0^^2;2^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1N.N) X
"^DD",790.71,790.71,.51,3)
Type a Number between 0 and 9999, 0 Decimal Digits
"^DD",790.71,790.71,.51,21,0)
^^3^3^2980713^
"^DD",790.71,790.71,.51,21,1,0)
This field contains the number of records (in File #790.3) indicating that
"^DD",790.71,790.71,.51,21,2,0)
a patient declined having a clinical breast exam within the timeframe
"^DD",790.71,790.71,.51,21,3,0)
associated with the Program Snapshot report.
"^DD",790.71,790.71,.51,"DT")
2990706
"^DD",790.71,790.71,.52,0)
Colposcopy Impression (NO BX)^NJ4,0^^2;3^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1N.N) X
"^DD",790.71,790.71,.52,3)
Type a Number between 0 and 9999, 0 Decimal Digits
"^DD",790.71,790.71,.52,21,0)
^^3^3^2980713^
"^DD",790.71,790.71,.52,21,1,0)
This field contains the number of records (in File #790.3) indicating that
"^DD",790.71,790.71,.52,21,2,0)
a patient declined having the procedure, colposcopy impression without
"^DD",790.71,790.71,.52,21,3,0)
biopsy, within the timeframe associated with the Program Snapshot report.
"^DD",790.71,790.71,.52,"DT")
2990706
"^DD",790.71,790.71,.53,0)
Colposcopy W/Biopsy^NJ4,0^^2;4^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1N.N) X
"^DD",790.71,790.71,.53,3)
Type a Number between 0 and 9999, 0 Decimal Digits
"^DD",790.71,790.71,.53,21,0)
^^3^3^2980713^
"^DD",790.71,790.71,.53,21,1,0)
This field contains the number of records (in File #790.3) indicating that
"^DD",790.71,790.71,.53,21,2,0)
a patient declined having the procedure, colposcopy with biopsy, within
"^DD",790.71,790.71,.53,21,3,0)
the timeframe associated with the Program Snapshot report.
"^DD",790.71,790.71,.53,"DT")
2990706
"^DD",790.71,790.71,.54,0)
Cone Biopsy^NJ4,0^^2;5^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1N.N) X
"^DD",790.71,790.71,.54,3)
Type a Number between 0 and 9999, 0 Decimal Digits
"^DD",790.71,790.71,.54,21,0)
^^3^3^2980713^
"^DD",790.71,790.71,.54,21,1,0)
This field contains the number of records (in File #790.3) indicating that
"^DD",790.71,790.71,.54,21,2,0)
a patient declined having the procedure, cone biopsy, within the timeframe
"^DD",790.71,790.71,.54,21,3,0)
associated with the Program Snapshot report.
"^DD",790.71,790.71,.54,"DT")
2990706
"^DD",790.71,790.71,.55,0)
Cryotherapy^NJ4,0^^2;6^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1N.N) X
"^DD",790.71,790.71,.55,3)
Type a Number between 0 and 9999, 0 Decimal Digits
"^DD",790.71,790.71,.55,21,0)
^^3^3^2980714^
"^DD",790.71,790.71,.55,21,1,0)
This field contains the number of records (in File #790.3) indicating that
"^DD",790.71,790.71,.55,21,2,0)
a patient declined having the procedure, cryotherapy, within the timeframe
"^DD",790.71,790.71,.55,21,3,0)
associated with the Program Snapshot report.
"^DD",790.71,790.71,.55,"DT")
2990706
"^DD",790.71,790.71,.56,0)
Ectocervical Biopsy^NJ4,0^^2;7^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1N.N) X
"^DD",790.71,790.71,.56,3)
Type a Number between 0 and 9999, 0 Decimal Digits
"^DD",790.71,790.71,.56,21,0)
^^3^3^2980713^
"^DD",790.71,790.71,.56,21,1,0)
This field contains the number of records (in File #790.3) indicating that
"^DD",790.71,790.71,.56,21,2,0)
a patient declined having the procedure, ectocervical biospy, within the
"^DD",790.71,790.71,.56,21,3,0)
timeframe associated with the Program Snapshot report.
"^DD",790.71,790.71,.56,"DT")
2990706
"^DD",790.71,790.71,.57,0)
Endocervical Currettage^NJ4,0^^2;8^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1N.N) X
"^DD",790.71,790.71,.57,3)
Type a Number between 0 and 9999, 0 Decimal Digits
"^DD",790.71,790.71,.57,21,0)
^^3^3^2980713^
"^DD",790.71,790.71,.57,21,1,0)
This field contains the number of records (in File #790.3) indicating that
"^DD",790.71,790.71,.57,21,2,0)
a patient declined having the procedure, endocervical currettage, within
"^DD",790.71,790.71,.57,21,3,0)
the timeframe associated with the Program Snapshot report.
"^DD",790.71,790.71,.57,"DT")
2990706
"^DD",790.71,790.71,.58,0)
Endometrial Biopsy^NJ4,0^^2;9^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1N.N) X
"^DD",790.71,790.71,.58,3)
Type a Number between 0 and 9999, 0 Decimal Digits
"^DD",790.71,790.71,.58,21,0)
^^3^3^2980713^
"^DD",790.71,790.71,.58,21,1,0)
This field contains the number of records (in File #790.3) indicating that
"^DD",790.71,790.71,.58,21,2,0)
a patient declined having the procedure, endometrial biopsy, within the
"^DD",790.71,790.71,.58,21,3,0)
timeframe associated with the Program Snapshot report.
"^DD",790.71,790.71,.58,"DT")
2990706
"^DD",790.71,790.71,.59,0)
Fine Needle Aspiration^NJ4,0^^2;10^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1N.N) X
"^DD",790.71,790.71,.59,3)
Type a Number between 0 and 9999, 0 Decimal Digits
"^DD",790.71,790.71,.59,21,0)
^^3^3^2980713^
"^DD",790.71,790.71,.59,21,1,0)
This field contains the number of records (in File #790.3) indicating that
"^DD",790.71,790.71,.59,21,2,0)
a patient declined having the procedure, fine needle aspiration, within
"^DD",790.71,790.71,.59,21,3,0)
the timeframe associated with the Program Snapshot report.
"^DD",790.71,790.71,.59,"DT")
2990706
"^DD",790.71,790.71,.6,0)
General Surgery Consult^NJ4,0^^2;11^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1N.N) X
"^DD",790.71,790.71,.6,3)
Type a Number between 0 and 9999, 0 Decimal Digits
"^DD",790.71,790.71,.6,21,0)
^^3^3^2980713^
"^DD",790.71,790.71,.6,21,1,0)
This field contains the number of records (in File #790.3) indicating that
"^DD",790.71,790.71,.6,21,2,0)
a patient declined a general surgery consult referral within the timeframe
"^DD",790.71,790.71,.6,21,3,0)
associated with the Program Snapshot report.
"^DD",790.71,790.71,.6,"DT")
2990706
"^DD",790.71,790.71,.61,0)
Gyn Onc Consult^NJ4,0^^2;12^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1N.N) X
"^DD",790.71,790.71,.61,3)
Type a Number between 0 and 9999, 0 Decimal Digits
"^DD",790.71,790.71,.61,21,0)
^^3^3^2980713^
"^DD",790.71,790.71,.61,21,1,0)
This field contains the number of records (in File #790.3) indicating that
"^DD",790.71,790.71,.61,21,2,0)
a patient declined a gynecological oncology consult referral, within the
"^DD",790.71,790.71,.61,21,3,0)
timeframe associated with the Program Snapshot report.
"^DD",790.71,790.71,.61,"DT")
2990706
"^DD",790.71,790.71,.62,0)
Hysterectomy^NJ4,0^^2;13^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1N.N) X
"^DD",790.71,790.71,.62,3)
Type a Number between 0 and 9999, 0 Decimal Digits
"^DD",790.71,790.71,.62,21,0)
^^3^3^2980713^
"^DD",790.71,790.71,.62,21,1,0)
This field contains the number of records (in File #790.3) indicating that
"^DD",790.71,790.71,.62,21,2,0)
a patient declined having a hysterectomy within the timeframe associated
"^DD",790.71,790.71,.62,21,3,0)
with the Program Snapshot report.
"^DD",790.71,790.71,.62,"DT")
2990706
"^DD",790.71,790.71,.63,0)
Laser Abilation^NJ4,0^^2;14^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1N.N) X
"^DD",790.71,790.71,.63,3)
Type a Number between 0 and 9999, 0 Decimal Digits
"^DD",790.71,790.71,.63,21,0)
^^3^3^2980713^
"^DD",790.71,790.71,.63,21,1,0)
This field contains the number of records (in File #790.3) indicating that
"^DD",790.71,790.71,.63,21,2,0)
a patient declined having a laser abilation procedure within the timeframe
"^DD",790.71,790.71,.63,21,3,0)
associated with the Program Snapshot report.
"^DD",790.71,790.71,.63,"DT")
2990706
"^DD",790.71,790.71,.64,0)
Laser Cone^NJ4,0^^2;15^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1N.N) X
"^DD",790.71,790.71,.64,3)
Type a Number between 0 and 9999, 0 Decimal Digits
"^DD",790.71,790.71,.64,21,0)
^^3^3^2980713^
"^DD",790.71,790.71,.64,21,1,0)
This field contains the number of records (in File #790.3) indicating that
"^DD",790.71,790.71,.64,21,2,0)
a patient declined having a laser cone procedure, within the timeframe
"^DD",790.71,790.71,.64,21,3,0)
associated with the Program Snapshot report.
"^DD",790.71,790.71,.64,"DT")
2990706
"^DD",790.71,790.71,.65,0)
Leep^NJ4,0^^2;16^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1N.N) X
"^DD",790.71,790.71,.65,3)
Type a Number between 0 and 9999, 0 Decimal Digits
"^DD",790.71,790.71,.65,21,0)
^^3^3^2980716^
"^DD",790.71,790.71,.65,21,1,0)
This field contains the number of records (in File #790.3) indicating that
"^DD",790.71,790.71,.65,21,2,0)
a patient declined having a loop electrosurgical excision procedure (LEEP)
"^DD",790.71,790.71,.65,21,3,0)
within the timeframe of the Program Snapshot report.
"^DD",790.71,790.71,.65,"DT")
2990706
"^DD",790.71,790.71,.66,0)
Lumpectomy^NJ4,0^^2;17^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1N.N) X
"^DD",790.71,790.71,.66,3)
Type a Number between 0 and 9999, 0 Decimal Digits
"^DD",790.71,790.71,.66,21,0)
^^3^3^2980713^
"^DD",790.71,790.71,.66,21,1,0)
This field contains the number of records (in File #790.3) indicating that
"^DD",790.71,790.71,.66,21,2,0)
a patient declined having lumpectomy (of the breast) within the timeframe
"^DD",790.71,790.71,.66,21,3,0)
associated with the Program Snapshot report.
"^DD",790.71,790.71,.66,"DT")
2990706
"^DD",790.71,790.71,.67,0)
Mammogram Dx Bilat^NJ4,0^^2;18^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1N.N) X
"^DD",790.71,790.71,.67,3)
Type a Number between 0 and 9999, 0 Decimal Digits
"^DD",790.71,790.71,.67,21,0)
^^3^3^2980921^
"^DD",790.71,790.71,.67,21,1,0)
This field contains the number of records (in File #790.3) indicating that
"^DD",790.71,790.71,.67,21,2,0)
a patient declined having the radiology test, mammogram Dx bilateral,
"^DD",790.71,790.71,.67,21,3,0)
within the timeframe associated with the Program Snapshot report.
"^DD",790.71,790.71,.67,"DT")
2990706
"^DD",790.71,790.71,.68,0)
Mammogram Dx Unilat^NJ4,0^^2;19^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1N.N) X
"^DD",790.71,790.71,.68,3)
Type a Number between 0 and 9999, 0 Decimal Digits
"^DD",790.71,790.71,.68,21,0)
^^3^3^2980921^
"^DD",790.71,790.71,.68,21,1,0)
This field contains the number of records (in File #790.3) indicating that
"^DD",790.71,790.71,.68,21,2,0)
a patient declined having the radiology test, mammogram Dx unilateral,
"^DD",790.71,790.71,.68,21,3,0)
within the timeframe associated with the Program Snapshot report.
"^DD",790.71,790.71,.68,"DT")
2990706
"^DD",790.71,790.71,.69,0)
Mammogram Screening^NJ4,0^^2;20^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1N.N) X
"^DD",790.71,790.71,.69,3)
Type a Number between 0 and 9999, 0 Decimal Digits
"^DD",790.71,790.71,.69,21,0)
^^3^3^2980713^
"^DD",790.71,790.71,.69,21,1,0)
This field contains the number of records (in File #790.3) indicating that
"^DD",790.71,790.71,.69,21,2,0)
a patient declined having the radiology procedure, mammogram screening,
"^DD",790.71,790.71,.69,21,3,0)
within the timeframe associated with the Program Snapshot report.
"^DD",790.71,790.71,.69,"DT")
2990706
"^DD",790.71,790.71,.7,0)
Masectomy^NJ4,0^^2;21^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1N.N) X
"^DD",790.71,790.71,.7,3)
Type a Number between 0 and 9999, 0 Decimal Digits
"^DD",790.71,790.71,.7,21,0)
^^3^3^2980713^
"^DD",790.71,790.71,.7,21,1,0)
This field contains the number of records (in File #790.3) indicating that
"^DD",790.71,790.71,.7,21,2,0)
a patient declined having a mastectomy within the timeframe associated
"^DD",790.71,790.71,.7,21,3,0)
with the Program Snapshot report.
"^DD",790.71,790.71,.7,"DT")
2990706
"^DD",790.71,790.71,.71,0)
Needle Biopsy^NJ4,0^^2;22^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1N.N) X
"^DD",790.71,790.71,.71,3)
Type a Number between 0 and 9999, 0 Decimal Digits
"^DD",790.71,790.71,.71,21,0)
^^3^3^2980714^
"^DD",790.71,790.71,.71,21,1,0)
This field contains the number of records (in File #790.3) indicating a
"^DD",790.71,790.71,.71,21,2,0)
patient declined having a needle biopsy within the timeframe associated
"^DD",790.71,790.71,.71,21,3,0)
with the Program Snapshot report.
"^DD",790.71,790.71,.71,"DT")
2990706
"^DD",790.71,790.71,.72,0)
Open Biopsy^NJ4,0^^2;23^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1N.N) X
"^DD",790.71,790.71,.72,3)
Type a Number between 0 and 9999, 0 Decimal Digits
"^DD",790.71,790.71,.72,21,0)
^^3^3^2980714^
"^DD",790.71,790.71,.72,21,1,0)
This field contains the number of records (in File #790.3) indicating a
"^DD",790.71,790.71,.72,21,2,0)
patient declined having an open biopsy within the timeframe associated
"^DD",790.71,790.71,.72,21,3,0)
with the Program Snapshot report.
"^DD",790.71,790.71,.72,"DT")
2990706
"^DD",790.71,790.71,.73,0)
Pap Smear^NJ4,0^^2;24^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1N.N) X
"^DD",790.71,790.71,.73,3)
Type a Number between 0 and 9999, 0 Decimal Digits
"^DD",790.71,790.71,.73,21,0)
^^3^3^2980921^
"^DD",790.71,790.71,.73,21,1,0)
This field contains the number of records (in File #790.3) indicating a
"^DD",790.71,790.71,.73,21,2,0)
patient declined having a PAP smear within the timeframe associated with
"^DD",790.71,790.71,.73,21,3,0)
the Program Snapshot report.
"^DD",790.71,790.71,.73,"DT")
2990706
"^DD",790.71,790.71,.74,0)
Pregnancy Test^NJ4,0^^2;25^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1N.N) X
"^DD",790.71,790.71,.74,3)
Type a Number between 0 and 9999, 0 Decimal Digits
"^DD",790.71,790.71,.74,21,0)
^^3^3^2980714^
"^DD",790.71,790.71,.74,21,1,0)
This field contains the number of records (in File #790.3) indicating a
"^DD",790.71,790.71,.74,21,2,0)
patient declined having a pregnancy test within the timeframe associated
"^DD",790.71,790.71,.74,21,3,0)
with the Program Snapshot report.
"^DD",790.71,790.71,.74,"DT")
2990706
"^DD",790.71,790.71,.75,0)
STD Evaluation^NJ4,0^^2;26^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1N.N) X
"^DD",790.71,790.71,.75,3)
Type a Number between 0 and 9999, 0 Decimal Digits
"^DD",790.71,790.71,.75,21,0)
^^3^3^2980921^
"^DD",790.71,790.71,.75,21,1,0)
This field contains the number of records (in File #790.3) indicating a
"^DD",790.71,790.71,.75,21,2,0)
patient declined having a STD evaluation within the timeframe associated
"^DD",790.71,790.71,.75,21,3,0)
with the Program Snapshot report.
"^DD",790.71,790.71,.75,"DT")
2990706
"^DD",790.71,790.71,.76,0)
Stereotactic Biopsy^NJ4,0^^2;27^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1N.N) X
"^DD",790.71,790.71,.76,3)
Type a Number between 0 and 9999, 0 Decimal Digits
"^DD",790.71,790.71,.76,21,0)
^^3^3^2990706^^
"^DD",790.71,790.71,.76,21,1,0)
This field contains the number of records (in File #790.3) indicating a
"^DD",790.71,790.71,.76,21,2,0)
patient declined having a stereotactic biospy within the timeframe
"^DD",790.71,790.71,.76,21,3,0)
associated with the Program Snapshot report.
"^DD",790.71,790.71,.76,"DT")
2990706
"^DD",790.71,790.71,.77,0)
Tubal Ligation^NJ4,0^^2;28^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1N.N) X
"^DD",790.71,790.71,.77,3)
Type a Number between 0 and 9999, 0 Decimal Digits
"^DD",790.71,790.71,.77,21,0)
^^3^3^2990706^
"^DD",790.71,790.71,.77,21,1,0)
This field contains the number of records (in File #790.3) indicating a
"^DD",790.71,790.71,.77,21,2,0)
patient declined having a tubal ligation within the timeframe associated
"^DD",790.71,790.71,.77,21,3,0)
with the Program Snapshot report.
"^DD",790.71,790.71,.77,"DT")
2990706
"^DD",790.71,790.71,.78,0)
Pelvic Ultrasound^NJ4,0^^2;29^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1N.N) X
"^DD",790.71,790.71,.78,3)
Type a Number between 0 and 9999, 0 Decimal Digits
"^DD",790.71,790.71,.78,21,0)
^^3^3^2990706^
"^DD",790.71,790.71,.78,21,1,0)
This field contains the number of records (in File #790.3) indicating a
"^DD",790.71,790.71,.78,21,2,0)
patient declined having a pelvic ultrasound within the timeframe
"^DD",790.71,790.71,.78,21,3,0)
associated with the Program Snapshot report.
"^DD",790.71,790.71,.78,"DT")
2990706
"^DD",790.71,790.71,.79,0)
Vaginal Ultrasound^NJ4,0^^2;30^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1N.N) X
"^DD",790.71,790.71,.79,3)
Type a Number between 0 and 9999, 0 Decimal Digits
"^DD",790.71,790.71,.79,21,0)
^^3^3^2990706^
"^DD",790.71,790.71,.79,21,1,0)
This field contains the number of records (in File #790.3) indicating a
"^DD",790.71,790.71,.79,21,2,0)
patient declined having a vaginal ultrasound within the timeframe
"^DD",790.71,790.71,.79,21,3,0)
associated with the Program Snapshot report.
"^DD",790.71,790.71,.79,"DT")
2990706
"^DIC",790.2,790.2,0)
WV PROCEDURE TYPE^790.2
"^DIC",790.2,790.2,0,"GL")
^WV(790.2,
"^DIC",790.2,790.2,"%D",0)
^^5^5^2980706^^
"^DIC",790.2,790.2,"%D",1,0)
This file stores and defines the type of procedures that may be
"^DIC",790.2,790.2,"%D",2,0)
associated with patients within this application.  The procedure type
"^DIC",790.2,790.2,"%D",3,0)
definitions includes the name, abbreviation, synonyms, last accession #,
"^DIC",790.2,790.2,"%D",4,0)
CPT and ICD codes, and colposcopy related information.  There is no option
"^DIC",790.2,790.2,"%D",5,0)
to edit this file although new entries may be added through FileMan. 
"^DIC",790.2,"B","WV PROCEDURE TYPE",790.2)

"^DIC",790.31,790.31,0)
WV RESULTS/DIAGNOSIS^790.31
"^DIC",790.31,790.31,0,"GL")
^WV(790.31,
"^DIC",790.31,790.31,"%D",0)
^^7^7^2980918^^
"^DIC",790.31,790.31,"%D",1,0)
This file stores a list of official results/diagnosis based on the
"^DIC",790.31,790.31,"%D",2,0)
Bethesda Classification system for PAP smears and the American College of
"^DIC",790.31,790.31,"%D",3,0)
Radiology (ACR) for mammograms.  Every result or diagnosis is associated
"^DIC",790.31,790.31,"%D",4,0)
with procedure types appropriate for that term.  File data is used to
"^DIC",790.31,790.31,"%D",5,0)
document appropriate results for procedures performed on women patients
"^DIC",790.31,790.31,"%D",6,0)
through the Add a New Procedure and Edit a Procedure options.  This file
"^DIC",790.31,790.31,"%D",7,0)
is exported with data and should not be locally edited.
"^DIC",790.31,"B","WV RESULTS/DIAGNOSIS",790.31)

"^DIC",790.4,790.4,0)
WV NOTIFICATION^790.4
"^DIC",790.4,790.4,0,"GL")
^WV(790.4,
"^DIC",790.4,790.4,"%D",0)
^^4^4^2980820^
"^DIC",790.4,790.4,"%D",1,0)
This file stores information surrounding the date/time, purpose, and
"^DIC",790.4,790.4,"%D",2,0)
circumstances (scheduling of procedures, results of tests, etc.) for each
"^DIC",790.4,790.4,"%D",3,0)
patient notification.  These records are used to view the Browse
"^DIC",790.4,790.4,"%D",4,0)
Notifications and Program Snapshot reports.
"^DIC",790.4,"B","WV NOTIFICATION",790.4)

"^DIC",790.71,790.71,0)
WV SNAPSHOT REPORTS^790.71
"^DIC",790.71,790.71,0,"GL")
^WV(790.71,
"^DIC",790.71,790.71,"%D",0)
^^8^8^2980713^
"^DIC",790.71,790.71,"%D",1,0)
This file contains information aggregated from data stored in the WV
"^DIC",790.71,790.71,"%D",2,0)
Procedure (790.1), WV Notification (790.4), and WV Refusals (790.3) files.
"^DIC",790.71,790.71,"%D",3,0)
Data storage is dependent upon running the Snapshot of the Program Today
"^DIC",790.71,790.71,"%D",4,0)
option and answering YES to the question, "Should today's Snapshot be
"^DIC",790.71,790.71,"%D",5,0)
stored for later retrieval and comparisons?" These records provide a
"^DIC",790.71,790.71,"%D",6,0)
historical perspective of the Woman Veterans Health Program at your
"^DIC",790.71,790.71,"%D",7,0)
facility and may be printed through the Retrieve/Print Earlier Snapshot
"^DIC",790.71,790.71,"%D",8,0)
option.
"^DIC",790.71,"B","WV SNAPSHOT REPORTS",790.71)

**END**
**END**
