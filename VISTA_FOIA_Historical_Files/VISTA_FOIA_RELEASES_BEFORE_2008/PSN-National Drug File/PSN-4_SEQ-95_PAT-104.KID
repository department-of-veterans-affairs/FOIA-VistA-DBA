Released PSN*4*104 SEQ #95
Extracted from mail message
**KIDS**:PSN*4.0*104^

**INSTALL NAME**
PSN*4.0*104
"BLD",5603,0)
PSN*4.0*104^NATIONAL DRUG FILE^0^3050708^y
"BLD",5603,1,0)
^^4^4^3050705^
"BLD",5603,1,1,0)
This patch will modify the DATA component of DBIA 4545, which returns data
"BLD",5603,1,2,0)
from the VA PRODUCT file (#50.68). Added to the output will be the VA
"BLD",5603,1,3,0)
GENERIC NAME field (#.05) of the VA PRODUCT file (#50.68), along with the
"BLD",5603,1,4,0)
NAME field (#.01) of that VA GENERIC file (#50.6) entry.
"BLD",5603,4,0)
^9.64PA^^
"BLD",5603,"KRN",0)
^9.67PA^8989.52^19
"BLD",5603,"KRN",.4,0)
.4
"BLD",5603,"KRN",.401,0)
.401
"BLD",5603,"KRN",.402,0)
.402
"BLD",5603,"KRN",.403,0)
.403
"BLD",5603,"KRN",.5,0)
.5
"BLD",5603,"KRN",.84,0)
.84
"BLD",5603,"KRN",3.6,0)
3.6
"BLD",5603,"KRN",3.8,0)
3.8
"BLD",5603,"KRN",9.2,0)
9.2
"BLD",5603,"KRN",9.8,0)
9.8
"BLD",5603,"KRN",9.8,"NM",0)
^9.68A^2^1
"BLD",5603,"KRN",9.8,"NM",2,0)
PSN50P68^^0^B15013447
"BLD",5603,"KRN",9.8,"NM","B","PSN50P68",2)

"BLD",5603,"KRN",19,0)
19
"BLD",5603,"KRN",19.1,0)
19.1
"BLD",5603,"KRN",101,0)
101
"BLD",5603,"KRN",409.61,0)
409.61
"BLD",5603,"KRN",771,0)
771
"BLD",5603,"KRN",870,0)
870
"BLD",5603,"KRN",8989.51,0)
8989.51
"BLD",5603,"KRN",8989.52,0)
8989.52
"BLD",5603,"KRN",8994,0)
8994
"BLD",5603,"KRN","B",.4,.4)

"BLD",5603,"KRN","B",.401,.401)

"BLD",5603,"KRN","B",.402,.402)

"BLD",5603,"KRN","B",.403,.403)

"BLD",5603,"KRN","B",.5,.5)

"BLD",5603,"KRN","B",.84,.84)

"BLD",5603,"KRN","B",3.6,3.6)

"BLD",5603,"KRN","B",3.8,3.8)

"BLD",5603,"KRN","B",9.2,9.2)

"BLD",5603,"KRN","B",9.8,9.8)

"BLD",5603,"KRN","B",19,19)

"BLD",5603,"KRN","B",19.1,19.1)

"BLD",5603,"KRN","B",101,101)

"BLD",5603,"KRN","B",409.61,409.61)

"BLD",5603,"KRN","B",771,771)

"BLD",5603,"KRN","B",870,870)

"BLD",5603,"KRN","B",8989.51,8989.51)

"BLD",5603,"KRN","B",8989.52,8989.52)

"BLD",5603,"KRN","B",8994,8994)

"BLD",5603,"QUES",0)
^9.62^^
"BLD",5603,"REQB",0)
^9.611^1^1
"BLD",5603,"REQB",1,0)
PSN*4.0*94^2
"BLD",5603,"REQB","B","PSN*4.0*94",1)

"MBREQ")
0
"PKG",136,-1)
1^1
"PKG",136,0)
NATIONAL DRUG FILE^PSN^This is the National Drug File Package V 3.14
"PKG",136,20,0)
^9.402P^^
"PKG",136,22,0)
^9.49I^1^1
"PKG",136,22,1,0)
4.0^2981030^2981223^11595
"PKG",136,22,1,"PAH",1,0)
104^3050708
"PKG",136,22,1,"PAH",1,1,0)
^^4^4^3050708
"PKG",136,22,1,"PAH",1,1,1,0)
This patch will modify the DATA component of DBIA 4545, which returns data
"PKG",136,22,1,"PAH",1,1,2,0)
from the VA PRODUCT file (#50.68). Added to the output will be the VA
"PKG",136,22,1,"PAH",1,1,3,0)
GENERIC NAME field (#.05) of the VA PRODUCT file (#50.68), along with the
"PKG",136,22,1,"PAH",1,1,4,0)
NAME field (#.01) of that VA GENERIC file (#50.6) entry.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
1
"RTN","PSN50P68")
0^2^B15013447
"RTN","PSN50P68",1,0)
PSN50P68 ;BIR/LDT - API FOR INFORMATION FROM FILE 50.68; 5 Sep 03
"RTN","PSN50P68",2,0)
 ;;4.0; NATIONAL DRUG FILE;**80,94,104**; 30 Oct 98
"RTN","PSN50P68",3,0)
 ;
"RTN","PSN50P68",4,0)
FORM(PSNIEN) ;
"RTN","PSN50P68",5,0)
 ;PSNIEN - IEN of entry in VA PRODUCT file (#50.68).
"RTN","PSN50P68",6,0)
 ;Returns NATIONAL FORMULARY NAME field (#4) of the VA PRODUCT file (#50.68).
"RTN","PSN50P68",7,0)
 I +$G(PSNIEN)'>0 Q ""
"RTN","PSN50P68",8,0)
 Q $P($G(^PSNDF(50.68,+PSNIEN,0)),"^",6)
"RTN","PSN50P68",9,0)
 ;
"RTN","PSN50P68",10,0)
DATA(PSNIEN,PSNFT,LIST) ;
"RTN","PSN50P68",11,0)
 ;PSNIEN - IEN of entry in VA PRODUCT file (#50.68).
"RTN","PSN50P68",12,0)
 ;PSNFT - Free Text name in  VA PRODUCT file (#50.68).
"RTN","PSN50P68",13,0)
 ;LIST - Subscript of ^TMP array in the form ^TMP($J,LIST,Field Number where Field Number is the
"RTN","PSN50P68",14,0)
 ;       Field Number of the data piece beingreturned.
"RTN","PSN50P68",15,0)
 N DIERR,ZZERR,PSN50P68,PSN
"RTN","PSN50P68",16,0)
 I $G(LIST)']"" Q
"RTN","PSN50P68",17,0)
 K ^TMP($J,LIST)
"RTN","PSN50P68",18,0)
 I +$G(PSNIEN)'>0,($G(PSNFT)']"") S ^TMP($J,LIST,0)=-1_"^"_"NO DATA FOUND" Q
"RTN","PSN50P68",19,0)
 I $G(PSNIEN)]"",+$G(PSNIEN)'>0 S ^TMP($J,LIST,0)=-1_"^"_"NO DATA FOUND" Q
"RTN","PSN50P68",20,0)
 I $G(PSNIEN)]"" N PSNIEN2 S PSNIEN2=$$FIND1^DIC(50.68,"","B","`"_PSNIEN,,,"") D
"RTN","PSN50P68",21,0)
 .I +PSNIEN2'>0 S ^TMP($J,LIST,0)=-1_"^"_"NO DATA FOUND" Q
"RTN","PSN50P68",22,0)
 .S ^TMP($J,LIST,0)=1
"RTN","PSN50P68",23,0)
 .D GETS^DIQ(50.68,+PSNIEN2,".01;.05;3;4;11;12;13;19","IE","PSN50P68") S PSN(1)=0
"RTN","PSN50P68",24,0)
 .F  S PSN(1)=$O(PSN50P68(50.68,PSN(1))) Q:'PSN(1)  D SETZRO
"RTN","PSN50P68",25,0)
 I $G(PSNIEN)="",$G(PSNFT)]"" D
"RTN","PSN50P68",26,0)
 .I PSNFT["??" D LOOP Q
"RTN","PSN50P68",27,0)
 .D FIND^DIC(50.68,,"@;.01","QP",PSNFT,,"B",,,"")
"RTN","PSN50P68",28,0)
 .I +$G(^TMP("DILIST",$J,0))=0 S ^TMP($J,LIST,0)=-1_"^"_"NO DATA FOUND" Q
"RTN","PSN50P68",29,0)
 .I +^TMP("DILIST",$J,0)>0 S ^TMP($J,LIST,0)=+^TMP("DILIST",$J,0) N PSNXX S PSNXX=0 F  S PSNXX=$O(^TMP("DILIST",$J,PSNXX)) Q:'PSNXX  D
"RTN","PSN50P68",30,0)
 ..S PSNIEN=+^TMP("DILIST",$J,PSNXX,0) K PSN50P68 D GETS^DIQ(50.68,+PSNIEN,".01;.05;3;4;11;12;13;19","IE","PSN50P68") S PSN(1)=0
"RTN","PSN50P68",31,0)
 ..F  S PSN(1)=$O(PSN50P68(50.68,PSN(1))) Q:'PSN(1)  D SETZRO
"RTN","PSN50P68",32,0)
 K ^TMP("DILIST",$J)
"RTN","PSN50P68",33,0)
 Q
"RTN","PSN50P68",34,0)
SETZRO ;
"RTN","PSN50P68",35,0)
 S ^TMP($J,LIST,+PSN(1),.01)=$G(PSN50P68(50.68,PSN(1),.01,"I"))
"RTN","PSN50P68",36,0)
 S ^TMP($J,LIST,"B",$G(PSN50P68(50.68,PSN(1),.01,"I")),+PSN(1))=""
"RTN","PSN50P68",37,0)
 S ^TMP($J,LIST,+PSN(1),.05)=$S($G(PSN50P68(50.68,PSN(1),.05,"I"))="":"",1:$G(PSN50P68(50.68,PSN(1),.05,"I"))_"^"_$G(PSN50P68(50.68,PSN(1),.05,"E")))
"RTN","PSN50P68",38,0)
 S ^TMP($J,LIST,+PSN(1),3)=$S($G(PSN50P68(50.68,PSN(1),3,"I"))="":"",1:$G(PSN50P68(50.68,PSN(1),3,"I"))_"^"_$G(PSN50P68(50.68,PSN(1),3,"E")))
"RTN","PSN50P68",39,0)
 S ^TMP($J,LIST,+PSN(1),4)=$G(PSN50P68(50.68,PSN(1),4,"I"))
"RTN","PSN50P68",40,0)
 S ^TMP($J,LIST,+PSN(1),11)=$G(PSN50P68(50.68,PSN(1),11,"I"))
"RTN","PSN50P68",41,0)
 S ^TMP($J,LIST,+PSN(1),12)=$G(PSN50P68(50.68,PSN(1),12,"I"))
"RTN","PSN50P68",42,0)
 S ^TMP($J,LIST,+PSN(1),13)=$G(PSN50P68(50.68,PSN(1),13,"I"))
"RTN","PSN50P68",43,0)
 S ^TMP($J,LIST,+PSN(1),19)=$S($G(PSN50P68(50.68,PSN(1),19,"I"))="":"",1:$G(PSN50P68(50.68,PSN(1),19,"I"))_"^"_$G(PSN50P68(50.68,PSN(1),19,"E")))
"RTN","PSN50P68",44,0)
 Q
"RTN","PSN50P68",45,0)
 ;
"RTN","PSN50P68",46,0)
LOOP ;
"RTN","PSN50P68",47,0)
 N PSNIEN,CNT,PSN50DD1,PSN50DD2,PSN50DD3,PSN1NOD,PSNZNOD,PSN1NOD,PSN7FED
"RTN","PSN50P68",48,0)
 D FIELD^DID(50.68,19,"Z","POINTER","PSN50DD1","PSN50DD2") S PSN50DD3=$G(PSN50DD1("POINTER"))
"RTN","PSN50P68",49,0)
 S CNT=0
"RTN","PSN50P68",50,0)
 S PSNIEN=0 F  S PSNIEN=$O(^PSNDF(50.68,PSNIEN)) Q:'PSNIEN  D
"RTN","PSN50P68",51,0)
 .S PSNZNOD=$G(^PSNDF(50.68,PSNIEN,0)),PSN1NOD=$G(^(1)),PSN7FED=$P($G(^(7)),"^")
"RTN","PSN50P68",52,0)
 .I $P(PSNZNOD,"^")="" Q
"RTN","PSN50P68",53,0)
 .S CNT=CNT+1
"RTN","PSN50P68",54,0)
 .S ^TMP($J,LIST,PSNIEN,.01)=$P(PSNZNOD,"^")
"RTN","PSN50P68",55,0)
 .S ^TMP($J,LIST,"B",$P(PSNZNOD,"^"),PSNIEN)=""
"RTN","PSN50P68",56,0)
 .S ^TMP($J,LIST,PSNIEN,.05)=$S($P(PSNZNOD,"^",2)="":"",1:$P(PSNZNOD,"^",2)_"^"_$P($G(^PSNDF(50.6,+$P(PSNZNOD,"^",2),0)),"^"))
"RTN","PSN50P68",57,0)
 .S ^TMP($J,LIST,PSNIEN,3)=$S($P(PSNZNOD,"^",5)="":"",1:$P(PSNZNOD,"^",5)_"^"_$P($G(^PS(50.607,+$P(PSNZNOD,"^",5),0)),"^"))
"RTN","PSN50P68",58,0)
 .S ^TMP($J,LIST,PSNIEN,4)=$P(PSNZNOD,"^",6)
"RTN","PSN50P68",59,0)
 .S ^TMP($J,LIST,PSNIEN,11)=$P(PSN1NOD,"^",5)
"RTN","PSN50P68",60,0)
 .S ^TMP($J,LIST,PSNIEN,12)=$P(PSN1NOD,"^",6)
"RTN","PSN50P68",61,0)
 .S ^TMP($J,LIST,PSNIEN,13)=$P(PSN1NOD,"^",7)
"RTN","PSN50P68",62,0)
 .I PSN50DD3'="",PSN7FED'="",PSN50DD3[(PSN7FED_":") S ^TMP($J,LIST,PSNIEN,19)=PSN7FED_"^"_$P($E(PSN50DD3,$F(PSN50DD3,(PSN7FED_":")),999),";")
"RTN","PSN50P68",63,0)
 .I '$D(^TMP($J,LIST,PSNIEN,19)) S ^TMP($J,LIST,PSNIEN,19)=""
"RTN","PSN50P68",64,0)
 S ^TMP($J,LIST,0)=$S(+CNT>0:CNT,1:"-1^NO DATA FOUND")
"RTN","PSN50P68",65,0)
 Q
"VER")
8.0^22.0
"BLD",5603,6)
^SEQ #95
**END**
**END**
