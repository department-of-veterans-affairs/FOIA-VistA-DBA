$TXT Created by GINSBERG,ELIOT at MNTVLL.FO-ALBANY.MED.VA.GOV  (KIDS) on Wednesday, 05/03/06 at 11:18
=============================================================================
Run Date: JUN 07, 2006                     Designation: DG*5.3*611
Package : DG - REGISTRATION                   Priority: Mandatory
Version : 5.3       SEQ #619                    Status: Released
                  Compliance Date: JUL 08, 2006
=============================================================================

Associated patches: (v)DG*5.3*566  <<= must be installed BEFORE `DG*5.3*611'
                    (v)DG*5.3*624  <<= must be installed BEFORE `DG*5.3*611'

Subject: FIX MEANS TEST DISPLAY

Category: 
  - Routine

Description:
============

 This patch addresses a flow control issue with the Registration means test
 options 
 - Add a New Means Test [DG MEANS TEST ADD]
 - Edit an Existing Means Test [DG MEANS TEST EDIT]
 - Complete a Required Means Test [DG MEANS TEST COMPLETE] 
 and Registration copay exemption test options 
 - Add a Copay Exemption Test [DG CO-PAY TEST ADD]
 - Edit an Existing Copay Exemption Test [DG CO-PAY TEST EDIT].
  
  
 Issue # 1
 ---------
 Currently, a user conducting a means/copay exemption test for a patient
 who prefers not to provide financial information has to press <Enter>
 repeatedly in response to screen prompts for this information. Only after
 the final screen is it possible to confirm that the patient "Declines to
 give income information." This can be cumbersome and time-consuming.
  
 Solution
 ------------
 Add a new 'Do you wish to provide financial information?' prompt (default 
 response 'YES') early in each of the following options:
     Add a New Means Test                   [DG MEANS TEST ADD]
     Add a Copay Exemption Test             [DG CO-PAY TEST ADD])
     Edit an Existing Means Test            [DG MEANS TEST EDIT]
     Edit an Existing Copay Exemption Test  [DG CO-PAY TEST EDIT])
     Complete a Required Means Test         [DG MEANS TEST COMPLETE]
  
 Also, just above the new prompt, display the following verbiage, which is
 similar to the text in VA Form 1010EZ, Application for Health Benefits:
  
 PROVIDE SPECIFIC INCOME AND/OR ASSET INFORMATION
 TO HAVE ELIGIBILITY FOR CARE DETERMINED. <YES>
 Continue, and complete the test with last calendar year's 
 information.
  
 PROVIDE MY DETAILED FINANCIAL INFORMATION. <NO>
 The appropriate enrollment priority based on nondisclosure of
 my financial information will be assigned.
  
  
 If the patient declines to give income information (answers 'NO' to 'Do
 you wish to provide financial information?'), what happens next will
 differ, depending on whether the user is in Add mode or Edit/Complete
 mode.
  
 If Not Providing Financial Information in Add Mode:
 --------------------------------------------------- 
 The Means Test/Copay Exemption Test screens will be skipped. The user
 will be asked if (s)he wishes to complete the Means Test/Copay Exemption
 Test. A 'NO' reply will abort the creation of the new test and return the
 user to the 'Select PATIENT NAME' prompt. A 'YES' reply will result in the
 creation of a new Means/Copay Exemption Test for the patient originally
 selected. The STATUS (#.03 field of ANNUAL MEANS TEST #408.1 File) of 
 the new Means Test will be 'MT COPAY REQUIRED.' If the test is a Copay
 Exemption test, the STATUS will be 'NON-EXEMPT.'
  
 If Not Providing Financial Information in Edit or Complete Mode:
 --------------------------------------------------------------- 
 Data values in the NET WORTH (#.05) and INCOME (#.05) fields of the ANNUAL
 MEANS TEST (#408.31) File will be removed (edit mode), and the Means Test
 screens will be skipped. As exiting is not allowed either prior to or
 after this patch (DG*5.3*611), processing will complete and the Means Test
 will be assigned a STATUS of 'MT COPAY REQUIRED.' If the test is a Copay
 Exemption test, the STATUS will be 'NON-EXEMPT.'
  
 If 'YES' to New 'Provide Financial Information' Prompt But None Provided:
 -------------------------------------------------------------------------
 If the patient answers 'YES' to 'Do you wish to provide financial
 information?'), then proceed in normal fashion to the Means Test/Copay
 Exemption Test screens. If no income or asset information is provided at
 this time, then prompt the user for 'DECLINES TO GIVE INCOME INFORMATION'
 with a default reply of 'YES.' If the user indicates 'YES', proceed to
 complete the Means Test and assign a STATUS of 'MT COPAY REQUIRED.' If the
 test is a Copay Exemption test, the STATUS will be 'NON-EXEMPT.'
  
 If the reply to 'DECLINES TO GIVE INCOME INFORMATION' is 'NO' and the test
 is a Means Test, go back to allow editing of the income and asset screens.
 If the reply is 'NO' and the test is a Copay Exemption Test, proceed to
 complete the test but this time assign a STATUS of 'EXEMPT' rather than
 'NON-EXEMPT.' This functionality is not new and is apparently due to
 'Total' at the bottom of Screen 2 being auto-populated with $0.00.
  
  
 This patch addresses the following New Service Request (NSR):
 -------------------------------------------------------------
 There is no NSR associated with this patch.
  
  
 This patch addresses the following Remedy Tickets:
 ---------------------------------------------------------
 There were originally 3 Remedy Tickets associated with this patch:
  
 HD0000000063712 
 BED-0104-10516  View Registration Data [DG REGISTRATION VIEW] 
  
 HD0000000063791
 MAR-0304-20170  MEANS TEST INFO NOT DISPLAYING
  
 HD0000000064074
 BIR-0704-31754  INCOME DATA
  
 Overview of Remedy Tickets:
 ----------------------------------
 Note:
 All of the Remedy Tickets that were originally connected to this patch 
 have been marked as 'Resolved' by the users logging the Remedy tickets.
  
 1) HD0000000063712:  In the View Registration Data  [DG REGISTRATION 
 VIEW] option, on the INCOME SCREENING DATA Screen #9 under certain 
 conditions it is possible to receive the prompt to copy the previous 
 Income Year's information into this years Income Test. (^DGRP9)
 From any option in a view mode the user should not be prompted to copy 
 data.  This functionality will be modified to only allow the user the 
 choice of copying the data when the routine is called from an option in 
 an edit mode.
  
 2) HD0000000063791: When editing an existing means test, the information 
 is not displaying in the option: VIEW REGISTRATION.  However, if you copy
 the information under the EDIT AN EXISTING MEANS TEST option, it will 
 display.  The VIEW REGISTRATION option will be modified to be 
 automatically updated when the Means Test information is entered.
  
 3) HD0000000064074: When loading patient data from PDX (segments MAS 
 Registration, Means Test, and Copay test) , the Means Test loads 
 correctly, but does not put the data in the Registration screens and 
 generates the income missing inconsistency. The VIEW REGISTRATION option 
 will be modified to be automatically updated when the Means Test 
 information is uploaded.
  
 Components Sent With Patch
 --------------------------
  
 ROUTINE SUMMARY:
 ================
  The following is a list of the routines included in this patch.  The
  second line of each of these routines will look like:
  
      <tab>;;5.3;Registration;**[patch list]**;Aug 13, 1993
  
                           CHECK^XTSUMBLD results
  Routine name      Before Patch          After Patch         Patch List
  ============      ============          ===========         ==========
  DGMTSC                 5398759              7959287         182,327,372,
                                                              433,463,540,
                                                                 566,611
  DGMTSCC               14268893             14710318         33,45,130,
                                                              438,332,433,
                                                              462,456,610,
                                                                 624,611
  
                    CHECK1^XTSUMBLD (new method) results
  Routine name      Before Patch          After Patch         Patch List
  ============      ============          ===========         ==========
  DGMTSC                12063858             22224962         182,327,372,
                                                              433,463,540,
                                                                 566,611
  DGMTSCC               31522709             36081556         33,45,130,
                                                              438,332,433,
                                                              462,456,610,
                                                                 624,611
                                                            
 Number of routines in patch: 2
  Number of routines changed: 2
  
  
 DOCUMENTATION RETRIEVAL
 =======================
 Sites may retrieve the user documentation directly using FTP from the
 ANONYMOUS.SOFTWARE directory at the following OI Field Offices:
     
                  Albany   : ftp.fo-albany.med.va.gov
                  Hines    : ftp.fo-hines.med.va.gov
            Salt Lake City : ftp.fo-slc.med.va.gov
    First Available Server : download.vista.med.va.gov (preferred method)
    
                                                                           
  The following files will be available:
     
        File Name                     Description
        ---------                     -----------      
 DG_5_3_P611_REG_UM.PDF    Revised PIMS V. 5.3 Registration Menu User 
                                                               Manual
 DG_5_3_P611_MTS_UM.PDF    Revised PIMS V. 5.3 Means Test Supervisor Menu 
                                                              User Manual
   
   
  Note:  Use Binary mode when transferring the .PDF files.
    
  The VistA Documentation Library [VDL] web site contains all end-user 
  manuals.  The address is http://www.va.gov/vdl/.
  
  
 Test Sites:
 -----------
 Durham (Large)
 Puget Sound (Integrated)
 Salisbury, NC (Large)  
  
  
        ================INSTALLATION INSTRUCTIONS =================
  
 If installed during the normal workday, it is recommended that the 
 following selection(s) in the OPTION (#19) file be disabled to prevent
 possible conflicts while running the KIDS Install. Other VISTA users will
 not be affected.
  
  Means Test Supervisor Menu              [DG MEANS TEST SUPERVISOR MENU]
  Means Test User Menu                    [DG MEANS TEST USER MENU]
  Add a New Means Test                    [DG MEANS TEST ADD]
  Complete a Required Means Test          [DG MEANS TEST COMPLETE]
  Edit an Existing Means Test             [DG MEANS TEST EDIT]
  Copay Exemption Test User Menu          [DG CO-PAY TEST USER MENU]
  Add a Copay Exemption Test              [DG CO-PAY TEST ADD]
  Edit an Existing Copay Exemption Test   [DG CO-PAY TEST EDIT]
  IVM BACKGROUND JOB                      [IVM BACKGROUND JOB]
  
  
 Install Time - less than 5 minutes
  
  
 1.  LOAD TRANSPORT GLOBAL 
     ---------------------
     Choose the PackMan message containing this patch and invoke the 
     INSTALL/CHECK MESSAGE PackMan option.  
              
 2.  START UP KIDS 
     -------------
     Start up the Kernel Installation and Distribution System Menu 
     [XPD MAIN]: 
    
          Edits and Distribution ...  
          Utilities ...  
          Installation ...  
    
 Select Kernel Installation & Distribution System Option: INStallation 
                                                          ---
          Load a Distribution 
          Print Transport Global 
          Compare Transport Global to Current System 
          Verify Checksums in Transport Global 
          Install Package(s) 
          Restart Install of Package(s) 
          Unload a Distribution 
          Backup a Transport Global 
    
 Select Installation Option: 
    
 3.  Select Installation Option: 
     ---------------------------
     NOTE:  The following are OPTIONAL - (When prompted for the INSTALL
            NAME, enter DG*5.3*611):
       
     a.  Backup a Transport Global - This option will create a backup
         message of any routines exported with this patch. It will not
         backup any other changes such as DD's or templates.
     b.  Compare Transport Global to Current System - This option will
         allow you to view all changes that will be made when this patch
         is installed.  It compares all components of this patch
         (routines, DD's, templates, etc.).
     c.  Verify Checksums in Transport Global - This option will allow
         you to ensure the integrity of the routines that are in the
         transport global.
      
 4.  Select Installation Option: Install Package(s) 
                                 ------------------
     **This is the step to start the installation of this KIDS patch: 
    
     a.  Choose the Install Package(s) option to start the patch
         install.
     b.  When prompted 'Want KIDS to INHIBIT LOGONs during the install? 
         YES//' answer NO.
     c.  When prompted 'Want to DISABLE Scheduled Options, Menu 
         Options, and Protocols? YES//' answer YES.
     d.  When prompted 'Enter options you wish to mark as 'Out Of
         Order':' enter the following options:
   
      Means Test Supervisor Menu              [DG MEANS TEST SUPERVISOR
                                                                  MENU]
      Means Test User Menu                    [DG MEANS TEST USER MENU]
      Add a New Means Test                    [DG MEANS TEST ADD]
      Complete a Required Means Test          [DG MEANS TEST COMPLETE]
      Edit an Existing Means Test             [DG MEANS TEST EDIT]
      Copay Exemption Test User Menu          [DG CO-PAY TEST USER MENU]
      Add a Copay Exemption Test              [DG CO-PAY TEST ADD]
      Edit an Existing Copay Exemption Test   [DG CO-PAY TEST EDIT]
      IVM BACKGROUND JOB                      [IVM BACKGROUND JOB]
  
     e.  When prompted 'Enter protocols you wish to mark as 'Out Of
         Order':' press <Enter>.

Routine Information:
====================
The checksums below are new checksums, and
 can be checked with CHECK1^XTSUMBLD.

Routine Name: DGMTSC
    Before: B12063858  After: B22224962  **182,327,372,433,463,540,566,611**
 Description of Changes:
  Description of Changes:
  If the user is either adding or a editing a means test, call new module
  DISCF.
   
  Also added new module DEDUCT
   
  Before:
   +18  EN1   ;Entry point to edit means test if incomplete
   +19        S DGMTSCI=+$O(DGMTSC(0))
   +20        I DGMTI,$$GET1^DIQ(408.31,DGMTI,.23)["IVM" S DGVINI=0     
  ;DG*5.3*5 40
   +21        G @($$ROU^DGMTSCU(DGMTSCI))
   
  After:
   +18        N DGREF,DTOUT,DUOUT,DGCAT,DGREF,ANSPFIN,PROVS
   +19        S ANSPFIN="N"
   +20        I DGMTACT="ADD"!(DGMTACT="EDT")!(DGMTACT="COM") D DISCF 
  Q:$D(DTOUT)!$D(DUOUT)  I $D (DGREF) D Q Q
   +21        ;
   +22  EN1   ;Entry point to edit means test if incomplete
   +23        S DGMTSCI=+$O(DGMTSC(0))
   +24        I DGMTI,$$GET1^DIQ(408.31,DGMTI,.23)["IVM" S DGVINI=0     
  ;DG*5.3*5 40
   +25        G @($$ROU^DGMTSCU(DGMTSCI))
   
  Before:
   +60        I DGMTACT'="VEW",$P($G(^DGMT(408.31,DGMTI,0)),U,3) D 
  INCON^DGMTUTL1
  (DFN,DGMTDT,DGMTI,DGMTYPT,.IVMERR),PROB^IVMCMFB(DGMTDT,.IVMERR,1)
   
  After:
   +65        ;don't apply consistency checks if user elects to not provide 
  financial information
   +66        I DGMTACT'="VEW",$P($G(^DGMT(408.31,DGMTI,0)),U,3),'$D(DGREF) 
  D INCON^DGMTUTL1
  (DFN,DGMTDT,DGMTI,DGMTYPT,.IVMERR),PROB^IVMCMFB(DGMTDT,.IVMERR,1)
   
  Before:
  +66         K DGERR,IVMERR,ARRAY,ZIC,ZIR,ZMT,ZDP,IVMAR,IVMAR2
   
  After:
  +72         K DGERR,IVMERR,ARRAY,ZIC,ZIR,ZMT,ZDP,IVMAR,IVMAR2,DGREF
   
  # of differences found: 2

Routine Name: DGMTSCC
    Before: B31522709  After: B36081556  **33,45,130,438,332,433,462,456,
                                          610,624,611**
 Description of Changes:
  Description of changes:
  Module EN:
  When trying to complete the Means test, and if the user previously 
  declined to provide financial information, report that the patient 
  declined to give information and finish completing the means test.
   
   
  If the user previously wanted to give financial information, but didn't 
  provide any, do module REF
   
  Module REF:
  add in default values
   
  Before:
   +19        I 'DGINTF,'DGNWTF S DGREF1="" D REF G Q:$D(DTOUT)!($D(DUOUT))
   +20        D CAT^DGMTSCU2,STA^DGMTSCU2        
   +21        I '$D(DGREF) D CHK I DGERR W
  !?3,*7,$S(DGMTYPT=1:"Means",1:"Copay")_" test cannot be completed." G Q 
   
  After:
   +19        ;if ANSPFIN="Y" user already answered to provide financial 
  information (module REF)
   +20        ;variable PROVDET may or may not be set from program DGMTSC
   +21        I $G(ANSPFIN)="Y",$D(DGREF) D
   +22        . S (DGINTF,DGNWTF)=""
   +23        . W !,"DECLINES TO GIVE INCOME INFORMATION: YES"
   +24        . S DGREF1=""
   +25        . Q
   +26        I ($G(DGINTF)=0),($G(DGNWTF)=0) S DGREF1="" D 
  REF G Q:$D(DTOUT)!($D(DUOUT))
   +27        D CAT^DGMTSCU2,STA^DGMTSCU2
   +28        ;don't try to run validation checks if declining to provide 
              financial information
   +29        I '$D(DGREF) D CHK I DGERR W 
  !?3,*7,$S(DGMTYPT=1:"Means",1:"Copay")_" test cannot be completed." G Q
   
   
  Before:
   +31 Q       K DGFIN,DGREF,DTOUT,DUOUT,Y
   
  After:
   +38 Q       K DGFIN,DTOUT,DUOUT,Y
   
   
  Before:
   +46        N DIR,Y
   +47        S DIR("A")="DECLINES TO GIVE INCOME INFORMATION"
   +48        I $P($G(^DGMT(408.31,DGMTI,0)),"^",14)]"" S 
  DIR("B")=$$YN^DGMTSCU1($P(^(0),"^",14))
   +49       S DIR(0)="408.31,.14" D ^DIR K DIR G REFQ:$D(DTOUT)!($D(DUOUT))
   +50       S:Y DGREF="" Q:'$D(DGREF)!($D(DGREF1))!(DGMTYPT'=1)  S 
  S DGCAT="C" D STA^DGMTSCU2
   
  After:
  +53        N DIR,Y,U
  +54        S U="^"
  +55        S DIR("A")="DECLINES TO GIVE INCOME INFORMATION"
  +56        I $P($G(^DGMT(408.31,DGMTI,0)),"^",14)]"" S 
  DIR("B")=$$YN^DGMTSCU1($P(^(0),"^",14))
  +57        I '$D(DIR("B")),$G(ANSPFIN)'="Y" S DIR("B")="NO"
  +58
         ;user answered Y initially, but didn't provide income information
  +59        I $G(ANSPFIN)="Y" S DIR("B")="YES"
  +60        I $G(DGINTF)=0,$G(DGNWTF)=0 S DIR("B")="YES"
  +61        S DIR(0)="408.31,.14" D ^DIR K DIR G REFQ:$D(DTOUT)!($D(DUOUT))
  +62
         S:Y DGREF="" Q:'$D(DGREF)!($D(DGREF1))!(DGMTYPT'=1)  S DGCAT="C"
  D STA^DGMTSCU2
  +63        S ANSPFIN="Y"


=============================================================================
User Information:
Entered By  : MULLER,RICHARD                Date Entered  : JUN 25, 2004
Completed By: RUDINGER,NANCY L.             Date Completed: JUN 01, 2006
Released By : ALEXANDER,DIANNE              Date Released : JUN 07, 2006
=============================================================================


Packman Mail Message:
=====================

$END TXT
