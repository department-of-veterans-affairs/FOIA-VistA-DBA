KIDS Distribution saved on Mar 11, 2002@15:20:50
CM TOOLS 1.0
**KIDS**:CM TOOLS 1.0^

**INSTALL NAME**
CM TOOLS 1.0
"BLD",4068,0)
CM TOOLS 1.0^CM TOOLS^0^3020311^y
"BLD",4068,1,0)
^^1^1^3020311^
"BLD",4068,1,1,0)
CM Tools package version 1.0
"BLD",4068,4,0)
^9.64PA^8973.1^1
"BLD",4068,4,8973.1,0)
8973.1
"BLD",4068,4,8973.1,222)
y^y^f^^^^n
"BLD",4068,4,"B",8973.1,8973.1)

"BLD",4068,"INIT")
KMPDPOST
"BLD",4068,"KRN",0)
^9.67PA^8989.52^19
"BLD",4068,"KRN",.4,0)
.4
"BLD",4068,"KRN",.401,0)
.401
"BLD",4068,"KRN",.402,0)
.402
"BLD",4068,"KRN",.403,0)
.403
"BLD",4068,"KRN",.5,0)
.5
"BLD",4068,"KRN",.84,0)
.84
"BLD",4068,"KRN",3.6,0)
3.6
"BLD",4068,"KRN",3.8,0)
3.8
"BLD",4068,"KRN",9.2,0)
9.2
"BLD",4068,"KRN",9.8,0)
9.8
"BLD",4068,"KRN",9.8,"NM",0)
^9.68A^9^9
"BLD",4068,"KRN",9.8,"NM",1,0)
KMPDBD01^^0^B2581147
"BLD",4068,"KRN",9.8,"NM",2,0)
KMPDHU01^^0^B23412526
"BLD",4068,"KRN",9.8,"NM",3,0)
KMPDHU02^^0^B35440001
"BLD",4068,"KRN",9.8,"NM",4,0)
KMPDPOST^^0^B485104
"BLD",4068,"KRN",9.8,"NM",5,0)
KMPDSS^^0^B7442957
"BLD",4068,"KRN",9.8,"NM",6,0)
KMPDUT2^^0^B1519727
"BLD",4068,"KRN",9.8,"NM",7,0)
KMPDUTL^^0^B3136236
"BLD",4068,"KRN",9.8,"NM",8,0)
KMPDUTL3^^0^B939909
"BLD",4068,"KRN",9.8,"NM",9,0)
KMPDU^^0^B233286
"BLD",4068,"KRN",9.8,"NM","B","KMPDBD01",1)

"BLD",4068,"KRN",9.8,"NM","B","KMPDHU01",2)

"BLD",4068,"KRN",9.8,"NM","B","KMPDHU02",3)

"BLD",4068,"KRN",9.8,"NM","B","KMPDPOST",4)

"BLD",4068,"KRN",9.8,"NM","B","KMPDSS",5)

"BLD",4068,"KRN",9.8,"NM","B","KMPDU",9)

"BLD",4068,"KRN",9.8,"NM","B","KMPDUT2",6)

"BLD",4068,"KRN",9.8,"NM","B","KMPDUTL",7)

"BLD",4068,"KRN",9.8,"NM","B","KMPDUTL3",8)

"BLD",4068,"KRN",19,0)
19
"BLD",4068,"KRN",19,"NM",0)
^9.68A^4^4
"BLD",4068,"KRN",19,"NM",1,0)
KMPD BACKGROUND DRIVER^^0
"BLD",4068,"KRN",19,"NM",2,0)
KMPD CM TOOLS MANAGER MENU^^0
"BLD",4068,"KRN",19,"NM",3,0)
KMPD STATUS^^0
"BLD",4068,"KRN",19,"NM",4,0)
XTCM MAIN^^3
"BLD",4068,"KRN",19,"NM","B","KMPD BACKGROUND DRIVER",1)

"BLD",4068,"KRN",19,"NM","B","KMPD CM TOOLS MANAGER MENU",2)

"BLD",4068,"KRN",19,"NM","B","KMPD STATUS",3)

"BLD",4068,"KRN",19,"NM","B","XTCM MAIN",4)

"BLD",4068,"KRN",19.1,0)
19.1
"BLD",4068,"KRN",19.1,"NM",0)
^9.68A^^
"BLD",4068,"KRN",101,0)
101
"BLD",4068,"KRN",409.61,0)
409.61
"BLD",4068,"KRN",771,0)
771
"BLD",4068,"KRN",870,0)
870
"BLD",4068,"KRN",8989.51,0)
8989.51
"BLD",4068,"KRN",8989.52,0)
8989.52
"BLD",4068,"KRN",8994,0)
8994
"BLD",4068,"KRN","B",.4,.4)

"BLD",4068,"KRN","B",.401,.401)

"BLD",4068,"KRN","B",.402,.402)

"BLD",4068,"KRN","B",.403,.403)

"BLD",4068,"KRN","B",.5,.5)

"BLD",4068,"KRN","B",.84,.84)

"BLD",4068,"KRN","B",3.6,3.6)

"BLD",4068,"KRN","B",3.8,3.8)

"BLD",4068,"KRN","B",9.2,9.2)

"BLD",4068,"KRN","B",9.8,9.8)

"BLD",4068,"KRN","B",19,19)

"BLD",4068,"KRN","B",19.1,19.1)

"BLD",4068,"KRN","B",101,101)

"BLD",4068,"KRN","B",409.61,409.61)

"BLD",4068,"KRN","B",771,771)

"BLD",4068,"KRN","B",870,870)

"BLD",4068,"KRN","B",8989.51,8989.51)

"BLD",4068,"KRN","B",8989.52,8989.52)

"BLD",4068,"KRN","B",8994,8994)

"BLD",4068,"QUES",0)
^9.62^^
"BLD",4068,"REQB",0)
^9.611^1^1
"BLD",4068,"REQB",1,0)
HL*1.6*79^1
"BLD",4068,"REQB","B","HL*1.6*79",1)

"FIA",8973.1)
CM HL7 DATA
"FIA",8973.1,0)
^KMPD(8973.1,
"FIA",8973.1,0,0)
8973.1DI
"FIA",8973.1,0,1)
y^y^f^^^^n
"FIA",8973.1,0,10)

"FIA",8973.1,0,11)

"FIA",8973.1,0,"RLRO")

"FIA",8973.1,0,"VR")
1.0^CM TOOLS
"FIA",8973.1,8973.1)
0
"INIT")
KMPDPOST
"KRN",19,10393,-1)
3^4
"KRN",19,10393,0)
XTCM MAIN^Capacity Management^^M^^^^^^^^TOOLKIT
"KRN",19,10393,1,0)
^19.06^2^2^3020129^^
"KRN",19,10393,1,1,0)
This menu holds all the currently available capacity management
"KRN",19,10393,1,2,0)
functions.
"KRN",19,10393,10,0)
^19.01IP^12^12
"KRN",19,10393,10,12,0)
18205^TLS
"KRN",19,10393,10,12,"^")
KMPD CM TOOLS MANAGER MENU
"KRN",19,10393,99)
58868,57233
"KRN",19,10393,99.1)
55707,82829
"KRN",19,10393,"U")
CAPACITY MANAGEMENT
"KRN",19,18104,-1)
0^1
"KRN",19,18104,0)
KMPD BACKGROUND DRIVER^CM Tools Background Driver^^R^^^^^^^^CM TOOLS
"KRN",19,18104,1,0)
^19.06^6^6^3020220^^^^
"KRN",19,18104,1,1,0)
This option should be queued to run each night (1:30am recommended).  Each
"KRN",19,18104,1,2,0)
night it will compress HL7 data into daily statistics and store this data
"KRN",19,18104,1,3,0)
in file #8973.1 (CM HL7 DATA).  Each Sunday this daily data will be
"KRN",19,18104,1,4,0)
compiled into weekly stats and shipped (via MailMan) to the CM National
"KRN",19,18104,1,5,0)
Database.  After the weekly transmission, file #8973.1 will be purged,
"KRN",19,18104,1,6,0)
leaving only two weeks of data.
"KRN",19,18104,25)
KMPDBD01
"KRN",19,18104,200.9)
y^y
"KRN",19,18104,"U")
CM TOOLS BACKGROUND DRIVER
"KRN",19,18204,-1)
0^3
"KRN",19,18204,0)
KMPD STATUS^CM Tools Status^^R^^^^^^^^CM TOOLS
"KRN",19,18204,1,0)
^^2^2^3020220^
"KRN",19,18204,1,1,0)
This option displays the status of the [KMPD BACKGROUND DRIVER] option, 
"KRN",19,18204,1,2,0)
and information on the CM HL7 DATA file (#8973.1).
"KRN",19,18204,25)
EN^KMPDSS
"KRN",19,18204,"U")
CM TOOLS STATUS
"KRN",19,18205,-1)
0^2
"KRN",19,18205,0)
KMPD CM TOOLS MANAGER MENU^CM Tools Manager Menu^^M^^^^^^^^CM TOOLS
"KRN",19,18205,10,0)
^19.01IP^1^1
"KRN",19,18205,10,1,0)
18204^STA
"KRN",19,18205,10,1,"^")
KMPD STATUS
"KRN",19,18205,99)
58868,57233
"KRN",19,18205,"U")
CM TOOLS MANAGER MENU
"MBREQ")
0
"ORD",18,19)
19;18;;;OPT^XPDTA;OPTF1^XPDIA;OPTE1^XPDIA;OPTF2^XPDIA;;OPTDEL^XPDIA
"ORD",18,19,0)
OPTION
"PKG",556,-1)
1^1
"PKG",556,0)
CM TOOLS^KMPD^Capacity Management Tools
"PKG",556,7)
^^I
"PKG",556,22,0)
^9.49I^1^1
"PKG",556,22,1,0)
1.0^3020311
"PKG",556,22,1,1,0)
^^1^1^3020311
"PKG",556,22,1,1,1,0)
CM Tools package version 1.0
"PKG",556,"DEV")
KAMAROWSKI/SF
"PKG",556,"VERSION")
1.0
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
9
"RTN","KMPDBD01")
0^1^B2581147
"RTN","KMPDBD01",1,0)
KMPDBD01 ;OAK/RAK - CM Tools Background Driver ;3/11/02  15:13
"RTN","KMPDBD01",2,0)
 ;;1.0;CM TOOLS;;Mar 11, 2002
"RTN","KMPDBD01",3,0)
 ;
"RTN","KMPDBD01",4,0)
EN ;-entry point for background driver
"RTN","KMPDBD01",5,0)
 ;
"RTN","KMPDBD01",6,0)
 S:'$G(DT) DT=$$DT^XLFDT
"RTN","KMPDBD01",7,0)
 ;
"RTN","KMPDBD01",8,0)
 N DAILY,ENDT,STDT
"RTN","KMPDBD01",9,0)
 S STDT=$$NOW^XLFDT,DAILY=$$FMADD^XLFDT(DT,-1)
"RTN","KMPDBD01",10,0)
 S ^XTMP("KMPD","BACKGROUND","HL7","DLY","TOTAL","START")=STDT,^("END")="",^("DELTA")=""
"RTN","KMPDBD01",11,0)
 ; compile and store daily stats in file 8973.1 (CM HL7 DATA)
"RTN","KMPDBD01",12,0)
 D DAILY^KMPDHU02(DAILY,DAILY)
"RTN","KMPDBD01",13,0)
 ; store start, stop and delta times for daily background job
"RTN","KMPDBD01",14,0)
 S ENDT=$$NOW^XLFDT
"RTN","KMPDBD01",15,0)
 S ^XTMP("KMPD","BACKGROUND","HL7","DLY","TOTAL","END")=ENDT
"RTN","KMPDBD01",16,0)
 S ^XTMP("KMPD","BACKGROUND","HL7","DLY","TOTAL","DELTA")=$$FMDIFF^XLFDT(ENDT,STDT,3)
"RTN","KMPDBD01",17,0)
 ;
"RTN","KMPDBD01",18,0)
 ; if sunday do weekly compression, transmit data to cm national
"RTN","KMPDBD01",19,0)
 ; database, and purge file #8973.1 (cm hl7 data) of old data
"RTN","KMPDBD01",20,0)
 I '$$DOW^XLFDT(DT,1) D 
"RTN","KMPDBD01",21,0)
 .S STDT=$$NOW^XLFDT
"RTN","KMPDBD01",22,0)
 .S ^XTMP("KMPD","BACKGROUND","HL7","WKY","TOTAL","START")=STDT,^("END")="",^("DELTA")=""
"RTN","KMPDBD01",23,0)
 .; weekly compression
"RTN","KMPDBD01",24,0)
 .D WEEKLY^KMPDHU01(DT,1)
"RTN","KMPDBD01",25,0)
 .; store start, stop and delta times for daily background job
"RTN","KMPDBD01",26,0)
 .S ENDT=$$NOW^XLFDT
"RTN","KMPDBD01",27,0)
 .S ^XTMP("KMPD","BACKGROUND","HL7","WKY","TOTAL","END")=ENDT
"RTN","KMPDBD01",28,0)
 .S ^XTMP("KMPD","BACKGROUND","HL7","WKY","TOTAL","DELTA")=$$FMDIFF^XLFDT(ENDT,STDT,3)
"RTN","KMPDBD01",29,0)
 ;
"RTN","KMPDBD01",30,0)
 Q
"RTN","KMPDHU01")
0^2^B23412526
"RTN","KMPDHU01",1,0)
KMPDHU01 ;OAK/RAK - CM Tools HL7 Utility;1/29/02  09:37 ;3/11/02  15:15
"RTN","KMPDHU01",2,0)
 ;;1.0;CM TOOLS;;Mar 11, 2002
"RTN","KMPDHU01",3,0)
 ;
"RTN","KMPDHU01",4,0)
WEEKLY(KMPDT,KMPDPRGE) ;-- compress daily stats to weekly
"RTN","KMPDHU01",5,0)
 ;-----------------------------------------------------------------------
"RTN","KMPDHU01",6,0)
 ; KMPDT.... Compression date in internal fileman formt.  This date
"RTN","KMPDHU01",7,0)
 ;           must be a Sunday.  It represents the date from which the
"RTN","KMPDHU01",8,0)
 ;           previous weeks data should be compressed. 
"RTN","KMPDHU01",9,0)
 ;           Example: if KMPDT = 2981011  then compression will begin
"RTN","KMPDHU01",10,0)
 ;                    on 2981010 (KMPDT-1)
"RTN","KMPDHU01",11,0)
 ; KMPDPRGE. 0 - do not purge data from file #8973.1
"RTN","KMPDHU01",12,0)
 ;           1 - purge data from file #8973.1
"RTN","KMPDHU01",13,0)
 ;
"RTN","KMPDHU01",14,0)
 ; Every Sunday compress the daily stats in file #8973.1 into weekly
"RTN","KMPDHU01",15,0)
 ; and upload the data to the CM RUM National Database
"RTN","KMPDHU01",16,0)
 ;-----------------------------------------------------------------------
"RTN","KMPDHU01",17,0)
 ;
"RTN","KMPDHU01",18,0)
 Q:'$G(KMPDT)
"RTN","KMPDHU01",19,0)
 S KMPDPRGE=+$G(KMPDPRGE)
"RTN","KMPDHU01",20,0)
 ;
"RTN","KMPDHU01",21,0)
 N DATA,DATE,DELDATE,EN,END,HOURS,I,IEN,J,NM,PT,SITE,ST,START
"RTN","KMPDHU01",22,0)
 ;
"RTN","KMPDHU01",23,0)
 ; quit if not sunday.
"RTN","KMPDHU01",24,0)
 Q:$$DOW^XLFDT(KMPDT,1)
"RTN","KMPDHU01",25,0)
 ; storage  processed
"RTN","KMPDHU01",26,0)
 K ^TMP($J),^TMP("KMPDHU01",$J)
"RTN","KMPDHU01",27,0)
 ; site info.
"RTN","KMPDHU01",28,0)
 S SITE=$$SITE^VASITE Q:SITE=""
"RTN","KMPDHU01",29,0)
 S DATE=KMPDT
"RTN","KMPDHU01",30,0)
 S (START,END)="",ST=$$NOW^XLFDT
"RTN","KMPDHU01",31,0)
 ; Date to begin deletion.
"RTN","KMPDHU01",32,0)
 S DELDATE=$$FMADD^XLFDT(KMPDT,-14)
"RTN","KMPDHU01",33,0)
 ;
"RTN","KMPDHU01",34,0)
 W:'$D(ZTQUEUED) !,"Compressing data into weekly format..."
"RTN","KMPDHU01",35,0)
 ; Reverse $order to get previous dates.
"RTN","KMPDHU01",36,0)
 F  S DATE=$O(^KMPD(8973.1,"B",DATE),-1) Q:'DATE  D 
"RTN","KMPDHU01",37,0)
 .; If DATE is saturday set START and END dates and kill TMPARRY.
"RTN","KMPDHU01",38,0)
 .I $$DOW^XLFDT(DATE,1)=6 D 
"RTN","KMPDHU01",39,0)
 ..S END=DATE,START=$$FMADD^XLFDT(DATE,-6)
"RTN","KMPDHU01",40,0)
 ..K ^TMP($J)
"RTN","KMPDHU01",41,0)
 .Q:'START
"RTN","KMPDHU01",42,0)
 .S IEN=0
"RTN","KMPDHU01",43,0)
 .F  S IEN=$O(^KMPD(8973.1,"B",DATE,IEN)) Q:'IEN  D 
"RTN","KMPDHU01",44,0)
 ..Q:'$D(^KMPD(8973.1,IEN,0))
"RTN","KMPDHU01",45,0)
 ..; data nodes into DATA() array.
"RTN","KMPDHU01",46,0)
 ..S DATA(0)=^KMPD(8973.1,IEN,0),DATA(1)=$G(^(1)),DATA(1.1)=$G(^(1.1)),DATA(1.2)=$G(^(1.2)),DATA(2)=$G(^(2)),DATA(2.1)=$G(^(2.1)),DATA(2.2)=$G(^(2.2)),DATA(99)=$G(^(99))
"RTN","KMPDHU01",47,0)
 ..; quit if data has already been sent to national database
"RTN","KMPDHU01",48,0)
 ..Q:$P(DATA(0),U,2)
"RTN","KMPDHU01",49,0)
 ..; quit if no namespace or protocol
"RTN","KMPDHU01",50,0)
 ..S NM=$P(DATA(0),U,3),PT=$P(DATA(0),U,5) Q:NM=""!(PT="")
"RTN","KMPDHU01",51,0)
 ..; change first piece to start date (this is for national database)
"RTN","KMPDHU01",52,0)
 ..S $P(DATA(0),U)=START
"RTN","KMPDHU01",53,0)
 ..; second piece not applicable to national database
"RTN","KMPDHU01",54,0)
 ..S $P(DATA(0),U,2)=""
"RTN","KMPDHU01",55,0)
 ..; node 99.1 is for national database (end date^facility name)
"RTN","KMPDHU01",56,0)
 ..S DATA(99.1)=END_"^"_$P(SITE,U,2)_"^"_$P(SITE,U,3)
"RTN","KMPDHU01",57,0)
 ..I '$D(ZTQUEUED) W:$X>78 !?16 W "."
"RTN","KMPDHU01",58,0)
 ..S ^TMP($J,START,NM,PT,0)=DATA(0)
"RTN","KMPDHU01",59,0)
 ..F I=0:0 S I=$O(DATA(I)) Q:'I  D 
"RTN","KMPDHU01",60,0)
 ...;W !,$$FMTE^XLFDT(DATE),?15,IEN,",",I,")=",DATA(I)
"RTN","KMPDHU01",61,0)
 ...; Add data to get weekly totals.
"RTN","KMPDHU01",62,0)
 ...F J=1:1:$S(I=0:4,I=99:6,I=99.1:3,1:9) D 
"RTN","KMPDHU01",63,0)
 ....S $P(^TMP($J,START,NM,PT,I),U,J)=$P($G(^TMP($J,START,NM,PT,I)),U,J)+$P(DATA(I),U,J)
"RTN","KMPDHU01",64,0)
 ..;
"RTN","KMPDHU01",65,0)
 ..; Back to IEN level.
"RTN","KMPDHU01",66,0)
 ..; Add to processed array.
"RTN","KMPDHU01",67,0)
 ..S ^TMP("KMPDHU01",$J,IEN)=""
"RTN","KMPDHU01",68,0)
 .;
"RTN","KMPDHU01",69,0)
 .; Back to DATE level.
"RTN","KMPDHU01",70,0)
 .; If START then transmit data.
"RTN","KMPDHU01",71,0)
 .I DATE=START I $D(^TMP($J)) D TRANSMIT K ^TMP($J)
"RTN","KMPDHU01",72,0)
 ;
"RTN","KMPDHU01",73,0)
 D:$D(^TMP($J)) TRANSMIT
"RTN","KMPDHU01",74,0)
 K ^TMP($J)
"RTN","KMPDHU01",75,0)
 ;
"RTN","KMPDHU01",76,0)
 S ST=$$NOW^XLFDT
"RTN","KMPDHU01",77,0)
 ; update field .02 (SENT TO CM NATIONAL DATABASE) to 'YES' for all
"RTN","KMPDHU01",78,0)
 ; processed entries.
"RTN","KMPDHU01",79,0)
 W:'$D(ZTQUEUED) !!,"Updating records to reflect transmission..."
"RTN","KMPDHU01",80,0)
 S IEN=0
"RTN","KMPDHU01",81,0)
 F  S IEN=$O(^TMP("KMPDHU01",$J,IEN)) Q:'IEN  D 
"RTN","KMPDHU01",82,0)
 .K FDA,ERROR I '$D(ZTQUEUED) W:$X>78 !?16 W "."
"RTN","KMPDHU01",83,0)
 .S FDA($J,8973.1,IEN_",",.02)=1
"RTN","KMPDHU01",84,0)
 .D FILE^DIE("","FDA($J)","ERROR")
"RTN","KMPDHU01",85,0)
 K ^TMP("KMPDHU01",$J)
"RTN","KMPDHU01",86,0)
 S EN=$$NOW^XLFDT
"RTN","KMPDHU01",87,0)
 S ^XTMP("KMPD","BACKGROUND","HL7","WKY","UPDT","START")=ST
"RTN","KMPDHU01",88,0)
 S ^XTMP("KMPD","BACKGROUND","HL7","WKY","UPDT","END")=EN
"RTN","KMPDHU01",89,0)
 S ^XTMP("KMPD","BACKGROUND","HL7","WKY","UPDT","DELTA")=$$FMDIFF^XLFDT(EN,ST,3)
"RTN","KMPDHU01",90,0)
 ;
"RTN","KMPDHU01",91,0)
 S ST=$$NOW^XLFDT
"RTN","KMPDHU01",92,0)
 ; leave two complete weeks of data in file #8973.1
"RTN","KMPDHU01",93,0)
 D:KMPDPRGE PURGE^KMPDUTL3(DELDATE)
"RTN","KMPDHU01",94,0)
 S EN=$$NOW^XLFDT
"RTN","KMPDHU01",95,0)
 S ^XTMP("KMPD","BACKGROUND","HL7","WKY","PURGE","START")=ST
"RTN","KMPDHU01",96,0)
 S ^XTMP("KMPD","BACKGROUND","HL7","WKY","PURGE","END")=EN
"RTN","KMPDHU01",97,0)
 S ^XTMP("KMPD","BACKGROUND","HL7","WKY","PURGE","DELTA")=$$FMDIFF^XLFDT(EN,ST,3)
"RTN","KMPDHU01",98,0)
 ;
"RTN","KMPDHU01",99,0)
 W:'$D(ZTQUEUED) !!,"Finished!"
"RTN","KMPDHU01",100,0)
 ;
"RTN","KMPDHU01",101,0)
 ;
"RTN","KMPDHU01",102,0)
 Q
"RTN","KMPDHU01",103,0)
 ;
"RTN","KMPDHU01",104,0)
TRANSMIT ;-- format TMPARRY data, put into e-mail and send to cm.
"RTN","KMPDHU01",105,0)
 ;
"RTN","KMPDHU01",106,0)
 Q:'$D(^TMP($J))
"RTN","KMPDHU01",107,0)
 ;
"RTN","KMPDHU01",108,0)
 N HRSDAYS,I,IEN,LN,N,P,S,XMSUB,X,XMTEXT,XMY,XMZ,Y,Z
"RTN","KMPDHU01",109,0)
 ;
"RTN","KMPDHU01",110,0)
 K ^TMP("KMPDHU01-2",$J)
"RTN","KMPDHU01",111,0)
 ;
"RTN","KMPDHU01",112,0)
 S LN=0
"RTN","KMPDHU01",113,0)
 ; version and patch info.
"RTN","KMPDHU01",114,0)
 S LN=LN+1,^TMP("KMPDHU01-2",$J,LN)="VERSION="_$$VERSION^KMPDUTL
"RTN","KMPDHU01",115,0)
 ;
"RTN","KMPDHU01",116,0)
 W:'$D(ZTQUEUED) !!,"Formatting ",$$FMTE^XLFDT($G(START))," data for mail delivery..."
"RTN","KMPDHU01",117,0)
 ; reformat so that data is in ^TMP("KMPR UPLOAD",$J,LN)= format.
"RTN","KMPDHU01",118,0)
 S IEN=0,S=""
"RTN","KMPDHU01",119,0)
 F  S S=$O(^TMP($J,S)) Q:S=""  S N="" W "." D 
"RTN","KMPDHU01",120,0)
 .F  S N=$O(^TMP($J,S,N)) Q:N=""  S P="" D 
"RTN","KMPDHU01",121,0)
 ..F  S P=$O(^TMP($J,S,N,P)) Q:P=""  S I="",IEN=IEN+1 D 
"RTN","KMPDHU01",122,0)
 ...F  S I=$O(^TMP($J,S,N,P,I)) Q:I=""  D 
"RTN","KMPDHU01",123,0)
 ....S LN=LN+1
"RTN","KMPDHU01",124,0)
 ....S ^TMP("KMPDHU01-2",$J,LN)=IEN_","_I_")="_^TMP($J,S,N,P,I)
"RTN","KMPDHU01",125,0)
 ;
"RTN","KMPDHU01",126,0)
 ; quit if no data to transmit.
"RTN","KMPDHU01",127,0)
 Q:'$D(^TMP("KMPDHU01-2",$J))
"RTN","KMPDHU01",128,0)
 ; send packman message.
"RTN","KMPDHU01",129,0)
 S XMTEXT="^TMP(""KMPDHU01-2"","_$J_","
"RTN","KMPDHU01",130,0)
 S XMSUB="CM HL7 DATA~"_$P(SITE,U,2)_" ("_$P(SITE,U,3)_")~"_$$FMTE^XLFDT(START)
"RTN","KMPDHU01",131,0)
 S XMY("S.KMP4-CM-SERVER@ISC-ALBANY.VA.GOV")=""
"RTN","KMPDHU01",132,0)
 ;S XMY("CAPACITY,MANAGEMENT@ISC-ALBANY.VA.GOV")=""
"RTN","KMPDHU01",133,0)
 S XMY("KAMAROWSKI@ISC-ALBANY.VA.GOV")=""
"RTN","KMPDHU01",134,0)
 D ^XMD
"RTN","KMPDHU01",135,0)
 W:'$D(ZTQUEUED) !,"Message #",$G(XMZ)," sent..."
"RTN","KMPDHU01",136,0)
 K ^TMP("KMPDHU01-2",$J)
"RTN","KMPDHU01",137,0)
 ;
"RTN","KMPDHU01",138,0)
 Q
"RTN","KMPDHU02")
0^3^B35440001
"RTN","KMPDHU02",1,0)
KMPDHU02 ;OAK/RAK - CM Tools Compile & File HL7 Daily Stats; ;3/11/02  15:16
"RTN","KMPDHU02",2,0)
 ;;1.0;CM TOOLS;;Mar 11, 2002
"RTN","KMPDHU02",3,0)
 ;
"RTN","KMPDHU02",4,0)
DAILY(KMPDST,KMPDEN) ;-entry point
"RTN","KMPDHU02",5,0)
 ;-----------------------------------------------------------------------
"RTN","KMPDHU02",6,0)
 ; KMPDST... Start date in internal fileman format.
"RTN","KMPDHU02",7,0)
 ; KMPDEN... End date in internal fileman format.
"RTN","KMPDHU02",8,0)
 ;
"RTN","KMPDHU02",9,0)
 ; This API gathers HL7 data and stores it in file 8973.1 (CM HL7 DATA)
"RTN","KMPDHU02",10,0)
 ;
"RTN","KMPDHU02",11,0)
 ; Variables used:
"RTN","KMPDHU02",12,0)
 ; GBL...... Global where data is stored - for use with indirection
"RTN","KMPDHU02",13,0)
 ; GBL1..... globas where compiled data is stored before filing - 
"RTN","KMPDHU02",14,0)
 ;           used with indirection
"RTN","KMPDHU02",15,0)
 ; SS1...... subscript 1 - identifies data
"RTN","KMPDHU02",16,0)
 ;            HR   - hourly
"RTN","KMPDHU02",17,0)
 ;            NMSP - namespace
"RTN","KMPDHU02",18,0)
 ;            PROT - protocol
"RTN","KMPDHU02",19,0)
 ; SS2...... subscript 2 - identifies data sorted within SS1
"RTN","KMPDHU02",20,0)
 ;            IO   - incoming/outgoing messages
"RTN","KMPDHU02",21,0)
 ;            LR   - local/remote messages
"RTN","KMPDHU02",22,0)
 ;            PR   - protocol
"RTN","KMPDHU02",23,0)
 ;            TM   - type of transmission
"RTN","KMPDHU02",24,0)
 ;            
"RTN","KMPDHU02",25,0)
 ; SS3...... subcript 3 - which identifier for SS2 is being sorted
"RTN","KMPDHU02",26,0)
 ;            IO   - I - incoming
"RTN","KMPDHU02",27,0)
 ;                   O - outgoing
"RTN","KMPDHU02",28,0)
 ;                   U - unknown
"RTN","KMPDHU02",29,0)
 ;            LR   - L - local
"RTN","KMPDHU02",30,0)
 ;                   R - remote
"RTN","KMPDHU02",31,0)
 ;                   U - unknown
"RTN","KMPDHU02",32,0)
 ;            PR   - P - placeholder for consistent subscripting
"RTN","KMPDHU02",33,0)
 ;            TM   - M - mailman
"RTN","KMPDHU02",34,0)
 ;                   T - tcp
"RTN","KMPDHU02",35,0)
 ;                   U -unknown
"RTN","KMPDHU02",36,0)
 ; SS4...... subscript 4 - according to SS1
"RTN","KMPDHU02",37,0)
 ;            HR   - date.time
"RTN","KMPDHU02",38,0)
 ;            NMSP - namespace
"RTN","KMPDHU02",39,0)
 ;            PROT - protocal
"RTN","KMPDHU02",40,0)
 ; SS5...... subcript 5 - according to SS1
"RTN","KMPDHU02",41,0)
 ;            HR   - namespace
"RTN","KMPDHU02",42,0)
 ;            NMSP - date.tim
"RTN","KMPDHU02",43,0)
 ;            PROT - namespace
"RTN","KMPDHU02",44,0)
 ; SS6...... subscript 6 - according to SS1
"RTN","KMPDHU02",45,0)
 ;            HR   - protocol
"RTN","KMPDHU02",46,0)
 ;            NMSP - protocol
"RTN","KMPDHU02",47,0)
 ;            PROT - date.time
"RTN","KMPDHU02",48,0)
 ;-----------------------------------------------------------------------
"RTN","KMPDHU02",49,0)
 ;
"RTN","KMPDHU02",50,0)
 Q:'$G(KMPDST)
"RTN","KMPDHU02",51,0)
 Q:'$G(KMPDEN)
"RTN","KMPDHU02",52,0)
 ; make sure end date has hours
"RTN","KMPDHU02",53,0)
 S:'$P(KMPDEN,".",2) $P(KMPDEN,".",2)="99"
"RTN","KMPDHU02",54,0)
 S:'$G(DT) DT=$$DT^XLFDT
"RTN","KMPDHU02",55,0)
 ;
"RTN","KMPDHU02",56,0)
 N END,ERROR,GBL,GBL1,SS1,SS2,SS3,SS4,SS5,SS6,STR,X
"RTN","KMPDHU02",57,0)
 ;
"RTN","KMPDHU02",58,0)
 ; update ^XTMP("KMPD",0) node to 1 year from today
"RTN","KMPDHU02",59,0)
 S ^XTMP("KMPD",0)=DT+10000
"RTN","KMPDHU02",60,0)
 ; get data from hl7 api
"RTN","KMPDHU02",61,0)
 W:'$D(ZTQUEUED) !,"Gathering HL7 data..."
"RTN","KMPDHU02",62,0)
 ; start time for hl7 api
"RTN","KMPDHU02",63,0)
 S STR=$$NOW^XLFDT
"RTN","KMPDHU02",64,0)
 S X=$$CM^HLUCM(KMPDST,KMPDEN,1,1,"KMPDH","EITHER",.ERROR)
"RTN","KMPDHU02",65,0)
 ; finish time for hl7 api
"RTN","KMPDHU02",66,0)
 S END=$$NOW^XLFDT
"RTN","KMPDHU02",67,0)
 ; store start time, end time, and delta
"RTN","KMPDHU02",68,0)
 S ^XTMP("KMPD","BACKGROUND","HL7","DLY","API","START")=STR
"RTN","KMPDHU02",69,0)
 S ^XTMP("KMPD","BACKGROUND","HL7","DLY","API","END")=END
"RTN","KMPDHU02",70,0)
 S ^XTMP("KMPD","BACKGROUND","HL7","DLY","API","DELTA")=$$FMDIFF^XLFDT(END,STR,3)
"RTN","KMPDHU02",71,0)
 I 'X!($D(ERROR))!('$D(^TMP("KMPDH",$J))) D  Q
"RTN","KMPDHU02",72,0)
 .W:'$D(ZTQUEUED) " no data to report"
"RTN","KMPDHU02",73,0)
 ;
"RTN","KMPDHU02",74,0)
 ; start time for compiling data
"RTN","KMPDHU02",75,0)
 S STR=$$NOW^XLFDT
"RTN","KMPDHU02",76,0)
 W:'$D(ZTQUEUED) !,"Compiling HL7 data into daily statistics..."
"RTN","KMPDHU02",77,0)
 ; global for storing compiled data before filing
"RTN","KMPDHU02",78,0)
 S GBL1=$NA(^TMP("KMPDH-1",$J))
"RTN","KMPDHU02",79,0)
 K @GBL1
"RTN","KMPDHU02",80,0)
 ; global with 'raw' hl7 api data
"RTN","KMPDHU02",81,0)
 S GBL=$NA(^TMP("KMPDH",$J)),SS1=""
"RTN","KMPDHU02",82,0)
 F  S SS1=$O(@GBL@(SS1)) Q:SS1=""  S SS2="" D 
"RTN","KMPDHU02",83,0)
 .F  S SS2=$O(@GBL@(SS1,SS2)) Q:SS2=""  S SS3="" D 
"RTN","KMPDHU02",84,0)
 ..F  S SS3=$O(@GBL@(SS1,SS2,SS3)) Q:SS3=""  S SS4="" D 
"RTN","KMPDHU02",85,0)
 ...F  S SS4=$O(@GBL@(SS1,SS2,SS3,SS4)) Q:SS4=""  S SS5="" D 
"RTN","KMPDHU02",86,0)
 ....Q:SS1="PROT"&(SS4="ZZZ")
"RTN","KMPDHU02",87,0)
 ....F  S SS5=$O(@GBL@(SS1,SS2,SS3,SS4,SS5)) Q:SS5=""  S SS6="" D 
"RTN","KMPDHU02",88,0)
 .....; if SS1="NMSP" or SS1="PROT" quit if SS4 and SS5 (protocol/
"RTN","KMPDHU02",89,0)
 .....;                             namespace pair) = ZZZ
"RTN","KMPDHU02",90,0)
 .....I SS1="NMSP"!(SS1="PROT") Q:SS4="ZZZ"&(SS5="ZZZ")
"RTN","KMPDHU02",91,0)
 .....F  S SS6=$O(@GBL@(SS1,SS2,SS3,SS4,SS5,SS6)) Q:SS6=""  D 
"RTN","KMPDHU02",92,0)
 ......Q:SS1="HR"&(SS6="ZZZ")
"RTN","KMPDHU02",93,0)
 ......Q:SS1="NMSP"&(SS6="ZZZ")
"RTN","KMPDHU02",94,0)
 ......; compile data into daily stats for file #8973.1 (CM HL7 DATA)
"RTN","KMPDHU02",95,0)
 ......D COMPILE
"RTN","KMPDHU02",96,0)
 ;
"RTN","KMPDHU02",97,0)
 ; end compile
"RTN","KMPDHU02",98,0)
 S END=$$NOW^XLFDT
"RTN","KMPDHU02",99,0)
 ; store start time, end time and delta
"RTN","KMPDHU02",100,0)
 S ^XTMP("KMPD","BACKGROUND","HL7","DLY","COMPILE","START")=STR
"RTN","KMPDHU02",101,0)
 S ^XTMP("KMPD","BACKGROUND","HL7","DLY","COMPILE","END")=END
"RTN","KMPDHU02",102,0)
 S ^XTMP("KMPD","BACKGROUND","HL7","DLY","COMPILE","DELTA")=$$FMDIFF^XLFDT(END,STR,3)
"RTN","KMPDHU02",103,0)
 ;
"RTN","KMPDHU02",104,0)
 ; start time
"RTN","KMPDHU02",105,0)
 S STR=$$NOW^XLFDT
"RTN","KMPDHU02",106,0)
 D:$D(@GBL1) FILE
"RTN","KMPDHU02",107,0)
 ; end time
"RTN","KMPDHU02",108,0)
 S END=$$NOW^XLFDT
"RTN","KMPDHU02",109,0)
 ; store start time, end time and delta
"RTN","KMPDHU02",110,0)
 S ^XTMP("KMPD","BACKGROUND","HL7","DLY","FILE","START")=STR
"RTN","KMPDHU02",111,0)
 S ^XTMP("KMPD","BACKGROUND","HL7","DLY","FILE","END")=END
"RTN","KMPDHU02",112,0)
 S ^XTMP("KMPD","BACKGROUND","HL7","DLY","FILE","DELTA")=$$FMDIFF^XLFDT(END,STR,3)
"RTN","KMPDHU02",113,0)
 ;
"RTN","KMPDHU02",114,0)
 W:'$D(ZTQUEUED) !,"Finished!"
"RTN","KMPDHU02",115,0)
 ;
"RTN","KMPDHU02",116,0)
 Q
"RTN","KMPDHU02",117,0)
 ;
"RTN","KMPDHU02",118,0)
COMPILE ;-compile and store data into GLB1 for filing in file #8973.1
"RTN","KMPDHU02",119,0)
 ;-----------------------------------------------------------------------
"RTN","KMPDHU02",120,0)
 ; DATA.... data from GBL array
"RTN","KMPDHU02",121,0)
 ; DATE.... date.hr
"RTN","KMPDHU02",122,0)
 ; ND...... node where data will be filed in file #8973.1
"RTN","KMPDHU02",123,0)
 ; LC...... up-arrow (^) piece location of data to be filed
"RTN","KMPDHU02",124,0)
 ; NM....... namespace
"RTN","KMPDHU02",125,0)
 ; PT...... protocol name~ien
"RTN","KMPDHU02",126,0)
 ; PTNP.... prime time - 1
"RTN","KMPDHU02",127,0)
 ;          non-prime time 2
"RTN","KMPDHU02",128,0)
 ;-----------------------------------------------------------------------
"RTN","KMPDHU02",129,0)
 ;
"RTN","KMPDHU02",130,0)
 N DATA,DATE,I,ND,LC,NM,PT,PTNP
"RTN","KMPDHU02",131,0)
 ;
"RTN","KMPDHU02",132,0)
 Q:'$D(@GBL@(SS1,SS2,SS3,SS4,SS5,SS6))  S DATA=$G(^(SS6)) Q:DATA=""
"RTN","KMPDHU02",133,0)
 ; namespace
"RTN","KMPDHU02",134,0)
 S NM=$S(SS1="HR"!(SS1="PROT"):SS5,SS1="NMSP":SS4,1:"") Q:NM=""
"RTN","KMPDHU02",135,0)
 ; protocol
"RTN","KMPDHU02",136,0)
 S PT=$S(SS1="HR"!(SS1="NMSP"):SS6,SS1="PROT":SS4,1:"") Q:PT=""
"RTN","KMPDHU02",137,0)
 ; prime time - 1, non-prime time - 2
"RTN","KMPDHU02",138,0)
 S DATE=$S(SS1="HR":SS4,SS1="NMSP":SS5,SS1="PROT":SS6,1:"") Q:'DATE
"RTN","KMPDHU02",139,0)
 S PTNP=$$PTNP(DATE) Q:'PTNP
"RTN","KMPDHU02",140,0)
 ;
"RTN","KMPDHU02",141,0)
 I SS1="HR" D 
"RTN","KMPDHU02",142,0)
 .S ND=$S(SS2="TM":1,1:""),ND=ND+(PTNP-1)
"RTN","KMPDHU02",143,0)
 .S LC=$S(SS3="T":0,SS3="M":3,SS3="U":6,1:"")
"RTN","KMPDHU02",144,0)
 I SS1="NMSP" D 
"RTN","KMPDHU02",145,0)
 .S ND=$S(SS2="IO":1.1,SS2="LR":1.2,1:""),ND=ND+(PTNP-1)
"RTN","KMPDHU02",146,0)
 .S LC=$S(SS3="I"!(SS3="L"):0,SS3="O"!(SS3="R"):3,SS3="U":6,1:"") Q:LC=""
"RTN","KMPDHU02",147,0)
 I SS1="PROT" D 
"RTN","KMPDHU02",148,0)
 .S ND=99,LC=$S(PTNP=1:0,PTNP=2:3,1:"")
"RTN","KMPDHU02",149,0)
 ;
"RTN","KMPDHU02",150,0)
 ; quit if not node (ND) or location (LC)
"RTN","KMPDHU02",151,0)
 Q:'$P(DATE,".")!('ND)!(LC="")
"RTN","KMPDHU02",152,0)
 ;
"RTN","KMPDHU02",153,0)
 F I=1:1:3 D 
"RTN","KMPDHU02",154,0)
 .S $P(@GBL1@($P(DATE,"."),PT,NM,ND),U,(I+LC))=$P($G(@GBL1@($P(DATE,"."),PT,NM,ND)),U,(I+LC))+$P(DATA,U,I)
"RTN","KMPDHU02",155,0)
 ;W !,SS1,?6,SS2,?12,SS3,?18,DATE,"-",PTNP,?34,NM,?40,$E(PT,1,38)
"RTN","KMPDHU02",156,0)
 ;
"RTN","KMPDHU02",157,0)
 Q
"RTN","KMPDHU02",158,0)
 ;
"RTN","KMPDHU02",159,0)
FILE ;-file data into file 8973.1 (CM HL7 DATA)
"RTN","KMPDHU02",160,0)
 ;
"RTN","KMPDHU02",161,0)
 Q:'$D(@GBL1)
"RTN","KMPDHU02",162,0)
 ;
"RTN","KMPDHU02",163,0)
 W:'$D(ZTQUEUED) !,"Filing HL7 stats into file 8973.1 (CM HL7 DATA)..."
"RTN","KMPDHU02",164,0)
 ;
"RTN","KMPDHU02",165,0)
 N DATE,ERROR,FDA,I,IEN,NM,PT,PT1,ZIEN
"RTN","KMPDHU02",166,0)
 ;
"RTN","KMPDHU02",167,0)
 S DATE=0
"RTN","KMPDHU02",168,0)
 F  S DATE=$O(@GBL1@(DATE)) Q:'DATE  S PT="" D 
"RTN","KMPDHU02",169,0)
 .F  S PT=$O(@GBL1@(DATE,PT)) Q:PT=""  S NM="" D 
"RTN","KMPDHU02",170,0)
 ..; remove ien (name~123) from protocol
"RTN","KMPDHU02",171,0)
 ..S PT1=$P(PT,"~") Q:PT1=""
"RTN","KMPDHU02",172,0)
 ..F  S NM=$O(@GBL1@(DATE,PT,NM)) Q:NM=""  S ND=0 D 
"RTN","KMPDHU02",173,0)
 ...K ERROR,FDA,IEN,ZIEN
"RTN","KMPDHU02",174,0)
 ...; determine if data has already been filed (if ien)
"RTN","KMPDHU02",175,0)
 ...S IEN=$O(^KMPD(8973.1,"APTDTNM",PT1,DATE,NM,0))
"RTN","KMPDHU02",176,0)
 ...;     if filed set IEN="ien," - edit entry
"RTN","KMPDHU02",177,0)
 ...; if not filed set IEN="+1," - add entry
"RTN","KMPDHU02",178,0)
 ...S IEN=$S(IEN:IEN_",",1:"+1,")
"RTN","KMPDHU02",179,0)
 ...S FDA($J,8973.1,IEN,.01)=DATE
"RTN","KMPDHU02",180,0)
 ...S FDA($J,8973.1,IEN,.03)=NM
"RTN","KMPDHU02",181,0)
 ...S FDA($J,8973.1,IEN,.05)=PT1
"RTN","KMPDHU02",182,0)
 ...F  S ND=$O(@GBL1@(DATE,PT,NM,ND)) Q:'ND  D 
"RTN","KMPDHU02",183,0)
 ....S DATA=@GBL1@(DATE,PT,NM,ND) Q:DATA=""
"RTN","KMPDHU02",184,0)
 ....F I=1:1:$S(ND=99:6,1:9) S:$P(DATA,U,I)'="" FDA($J,8973.1,IEN,ND+(I*.001))=$P(DATA,U,I)
"RTN","KMPDHU02",185,0)
 ...; file data
"RTN","KMPDHU02",186,0)
 ...D UPDATE^DIE("","FDA($J)","ZIEN","ERROR")
"RTN","KMPDHU02",187,0)
 ;
"RTN","KMPDHU02",188,0)
 Q
"RTN","KMPDHU02",189,0)
 ;
"RTN","KMPDHU02",190,0)
PTNP(DATE) ;-extrinsic function - determine if date.hr is prime time or non-prime time
"RTN","KMPDHU02",191,0)
 N DOW,HOUR
"RTN","KMPDHU02",192,0)
 ; day of week in numeric format
"RTN","KMPDHU02",193,0)
 S DOW=$$DOW^XLFDT(DATE,1)
"RTN","KMPDHU02",194,0)
 ; hours
"RTN","KMPDHU02",195,0)
 S HOUR=$E($P(DATE,".",2),1,2)
"RTN","KMPDHU02",196,0)
 ; prime time - not saturday or sunday or holiday and between the hours
"RTN","KMPDHU02",197,0)
 ;              of 8am (0800) to 5 pm (1700)
"RTN","KMPDHU02",198,0)
 Q:DOW'=0&(DOW'=6)&('$G(^HOLIDAY($P(DATE,"."),0)))&(HOUR>7)&(HOUR<18) 1
"RTN","KMPDHU02",199,0)
 ; non-prime time
"RTN","KMPDHU02",200,0)
 Q 2
"RTN","KMPDPOST")
0^4^B485104
"RTN","KMPDPOST",1,0)
KMPDPOST ;OAK/RAK - CM Tools Post Install ;3/11/02  15:16
"RTN","KMPDPOST",2,0)
 ;;1.0;CM TOOLS;;Mar 11, 2002
"RTN","KMPDPOST",3,0)
 ;
"RTN","KMPDPOST",4,0)
EN ;-entry point
"RTN","KMPDPOST",5,0)
 D MES^XPDUTL("     Queueing [KMPD BACKGROUND DRIVER] to run each day at 1:30am...")
"RTN","KMPDPOST",6,0)
 ; make sure option KMPD BACKGROUND DRIVER is queued to run each night
"RTN","KMPDPOST",7,0)
 D QUEBKG^KMPDUTL("KMPD BACKGROUND DRIVER","T+1@0130","1D",0)
"RTN","KMPDPOST",8,0)
 D MES^XPDUTL("     Complete!")
"RTN","KMPDPOST",9,0)
 Q
"RTN","KMPDSS")
0^5^B7442957
"RTN","KMPDSS",1,0)
KMPDSS ;OAK/RAK - CM Tools Status ;3/11/02  15:17
"RTN","KMPDSS",2,0)
 ;;1.0;CM TOOLS;;Mar 11, 2002
"RTN","KMPDSS",3,0)
 ;
"RTN","KMPDSS",4,0)
EN ;-entry point
"RTN","KMPDSS",5,0)
 N DIR,KMPDX,KMPDX1,VERSION,X,Y
"RTN","KMPDSS",6,0)
 S X="KMPDUTL" X ^%ZOSF("TEST") I '$T W !,"The CM Tools Package is not installed!" Q
"RTN","KMPDSS",7,0)
 S VERSION=$$VERSION^KMPDUTL
"RTN","KMPDSS",8,0)
 S X="CM Tools v"_$P(VERSION,U)
"RTN","KMPDSS",9,0)
 W @IOF,!?(IOM-$L(X)\2),X
"RTN","KMPDSS",10,0)
 ; if patches
"RTN","KMPDSS",11,0)
 I $P(VERSION,U,2)]"" S X=$P(VERSION,U,2) W !?(IOM-$L(X)\2),X
"RTN","KMPDSS",12,0)
 W !
"RTN","KMPDSS",13,0)
 I '$O(^DIC(19,"B","KMPD BACKGROUND DRIVER",0)) D 
"RTN","KMPDSS",14,0)
 .W !," The 'CM Tools Background Driver' option [KMPD BACKGROUND DRIVER] is missing!"
"RTN","KMPDSS",15,0)
 E  D 
"RTN","KMPDSS",16,0)
 .S KMPDX=+$O(^DIC(19,"B","KMPD BACKGROUND DRIVER",0))
"RTN","KMPDSS",17,0)
 .S KMPDX=+$O(^DIC(19.2,"B",KMPDX,0))
"RTN","KMPDSS",18,0)
 .; if not scheduled or no task id
"RTN","KMPDSS",19,0)
 .I 'KMPDX!('$G(^DIC(19.2,+KMPDX,1))) D  Q:'Y
"RTN","KMPDSS",20,0)
 ..W !?5,"The 'CM Tools Background Driver' [KMPD BACKGROUND DRIVER] is not scheduled",!?5,"to run!",!
"RTN","KMPDSS",21,0)
 ..K DIR S DIR(0)="YO",DIR("B")="YES"
"RTN","KMPDSS",22,0)
 ..S DIR("A")="Do you want to queue this option to run each night at 1:30am"
"RTN","KMPDSS",23,0)
 ..W ! D ^DIR Q:'Y
"RTN","KMPDSS",24,0)
 ..D QUEBKG^KMPDUTL("KMPD BACKGROUND DRIVER","T+1@0130","1D",0)
"RTN","KMPDSS",25,0)
 .S KMPDX=+$O(^DIC(19,"B","KMPD BACKGROUND DRIVER",0))
"RTN","KMPDSS",26,0)
 .S KMPDX=+$O(^DIC(19.2,"B",KMPDX,0))
"RTN","KMPDSS",27,0)
 .S KMPDX=$G(^DIC(19.2,KMPDX,0)),KMPDX1=$G(^(1))
"RTN","KMPDSS",28,0)
 .S $P(KMPDX,U,2)=$$FMTE^XLFDT($P(KMPDX,U,2))
"RTN","KMPDSS",29,0)
 .W !?5,"CM Tools Background Driver [KMPD BACKGROUND DRIVER]"
"RTN","KMPDSS",30,0)
 .W !?5,"QUEUED TO RUN AT.......: ",$P(KMPDX,U,2)
"RTN","KMPDSS",31,0)
 .W !?5,"RESCHEDULING FREQUENCY.: ",$P(KMPDX,U,6)
"RTN","KMPDSS",32,0)
 .W !?5,"TASK ID................: ",+KMPDX1
"RTN","KMPDSS",33,0)
 .; user info.
"RTN","KMPDSS",34,0)
 .S KMPDX1=$G(^%ZTSK(+KMPDX1,0))
"RTN","KMPDSS",35,0)
 .W !?5,"QUEUED BY..............: ",$P($G(^VA(200,+$P(KMPDX1,U,3),0)),U)
"RTN","KMPDSS",36,0)
 .; quit if no user
"RTN","KMPDSS",37,0)
 .Q:'(+$P(KMPDX1,U,3))
"RTN","KMPDSS",38,0)
 .; user 'active' or 'terminated'
"RTN","KMPDSS",39,0)
 .S KMPDX1=$$ACTIVE^XUSER(+$P(KMPDX1,U,3))
"RTN","KMPDSS",40,0)
 .W "  (",$S($P(KMPDX1,U,2)["TERMINATED":"Terminated - "_$$FMTE^XLFDT($P(KMPDX1,U,3),2),1:"Active"),")"
"RTN","KMPDSS",41,0)
 W !
"RTN","KMPDSS",42,0)
 W !?35,"  # of",?45,"Oldest",?55,"Recent"
"RTN","KMPDSS",43,0)
 W !?5,"File",?35,"Entries",?45," Date",?55," Date"
"RTN","KMPDSS",44,0)
 W !?5,"-------------------------",?35,"-------",?45,"------",?54,"-------"
"RTN","KMPDSS",45,0)
 ; file name
"RTN","KMPDSS",46,0)
 W !?5,"8973.1 - CM HL7 DATA"
"RTN","KMPDSS",47,0)
 ; number of entries
"RTN","KMPDSS",48,0)
 W ?35,$J($FN($P($G(^KMPD(8973.1,0)),U,4),",",0),7)
"RTN","KMPDSS",49,0)
 ; oldest date
"RTN","KMPDSS",50,0)
 W ?45,$$FMTE^XLFDT(+$O(^KMPD(8973.1,"B",0)),2)
"RTN","KMPDSS",51,0)
 ; most recent date
"RTN","KMPDSS",52,0)
 W ?55,$$FMTE^XLFDT(+$O(^KMPD(8973.1,"B","A"),-1),2)
"RTN","KMPDSS",53,0)
 ; pause
"RTN","KMPDSS",54,0)
 K DIR S DIR(0)="EO",DIR("A")="Press RETURN to continue"
"RTN","KMPDSS",55,0)
 W !! D ^DIR
"RTN","KMPDSS",56,0)
 ;
"RTN","KMPDSS",57,0)
 Q
"RTN","KMPDU")
0^9^B233286
"RTN","KMPDU",1,0)
KMPDU ;OAK/RAK - CM Tools Utility ;3/11/02  15:17
"RTN","KMPDU",2,0)
 ;;1.0;CM TOOLS;;Mar 11, 2002
"RTN","KMPDU",3,0)
FMDTI(Y,X) ;-- date/time in internal fileMan format.
"RTN","KMPDU",4,0)
 ;----------------------------------------------------------------------
"RTN","KMPDU",5,0)
 ;     X - User response ('T', '12/12/94', etc.)
"RTN","KMPDU",6,0)
 ;
"RTN","KMPDU",7,0)
 ; Return: Y(0)=InternalFilemanDate
"RTN","KMPDU",8,0)
 ;         Y(1)=ExternalFilemanDate
"RTN","KMPDU",9,0)
 ;----------------------------------------------------------------------
"RTN","KMPDU",10,0)
 K Y
"RTN","KMPDU",11,0)
 I $G(X)']"" S Y(0)="^" Q
"RTN","KMPDU",12,0)
 N %DT,DATETIME
"RTN","KMPDU",13,0)
 S %DT="ST" D ^%DT
"RTN","KMPDU",14,0)
 S DATETIME=$S(Y>0:Y,1:"^")
"RTN","KMPDU",15,0)
 K Y
"RTN","KMPDU",16,0)
 ;-- fm internal format.
"RTN","KMPDU",17,0)
 S Y(0)=DATETIME
"RTN","KMPDU",18,0)
 ;-- external format.
"RTN","KMPDU",19,0)
 S Y(1)=$$FMTE^XLFDT(DATETIME)
"RTN","KMPDU",20,0)
 Q
"RTN","KMPDUT2")
0^6^B1519727
"RTN","KMPDUT2",1,0)
KMPDUT2 ;OAK/RAK - CM Tools Utility ;3/11/02  15:17
"RTN","KMPDUT2",2,0)
 ;;1.0;CM TOOLS;;Mar 11, 2002
"RTN","KMPDUT2",3,0)
 ;
"RTN","KMPDUT2",4,0)
ID(KMPDIEN) ;--called from ^DD(8973.1,0,"ID","W")
"RTN","KMPDUT2",5,0)
 ;-----------------------------------------------------------------------
"RTN","KMPDUT2",6,0)
 ; KMPDIEN... Ien for file #8973.1 (CM HL7 DATA)
"RTN","KMPDUT2",7,0)
 ;-----------------------------------------------------------------------
"RTN","KMPDUT2",8,0)
 Q:'$G(KMPDIEN)
"RTN","KMPDUT2",9,0)
 Q:'$D(^KMPD(8973.1,+KMPDIEN,0))
"RTN","KMPDUT2",10,0)
 N DATA,TXT
"RTN","KMPDUT2",11,0)
 S DATA=$G(^KMPD(8973.1,+KMPDIEN,0)) Q:DATA=""
"RTN","KMPDUT2",12,0)
 ; sent to national database
"RTN","KMPDUT2",13,0)
 S TXT(1)=$S($P(DATA,U,2):"sent",1:"not sent")
"RTN","KMPDUT2",14,0)
 S TXT(1)=TXT(1)_$J(" ",11-$L(TXT(1)))
"RTN","KMPDUT2",15,0)
 ; namespace
"RTN","KMPDUT2",16,0)
 S TXT(1)=TXT(1)_$P(DATA,U,3)
"RTN","KMPDUT2",17,0)
 S TXT(1)=TXT(1)_$J(" ",18-$L(TXT(1)))
"RTN","KMPDUT2",18,0)
 ; protocol
"RTN","KMPDUT2",19,0)
 S TXT(1)=TXT(1)_$P(DATA,U,5)
"RTN","KMPDUT2",20,0)
 S TXT(1,"F")="?15"
"RTN","KMPDUT2",21,0)
 D EN^DDIOL(.TXT)
"RTN","KMPDUT2",22,0)
 Q
"RTN","KMPDUT2",23,0)
 ;
"RTN","KMPDUT2",24,0)
XREF(DA,X,KMPDTYPE) ;-set/kill 'APTDTNM' xref in file #8973.1
"RTN","KMPDUT2",25,0)
 ;-----------------------------------------------------------------------
"RTN","KMPDUT2",26,0)
 ; DA....... Ien for file #8973.1 (CM HL7 DATA)
"RTN","KMPDUT2",27,0)
 ; X........ Value of field #.05 (PROTOCOL)
"RTN","KMPDUT2",28,0)
 ; KMPDTYPE. 1 - set xref
"RTN","KMPDUT2",29,0)
 ;           2 - kill xref
"RTN","KMPDUT2",30,0)
 ;-----------------------------------------------------------------------
"RTN","KMPDUT2",31,0)
 Q:'$G(DA)
"RTN","KMPDUT2",32,0)
 Q:$G(X)=""
"RTN","KMPDUT2",33,0)
 Q:'$G(KMPDTYPE)
"RTN","KMPDUT2",34,0)
 N DATA,DATE,NM
"RTN","KMPDUT2",35,0)
 S DATA=$G(^KMPD(8973.1,DA,0)) Q:DATA=""
"RTN","KMPDUT2",36,0)
 S DATE=$P(DATA,U) Q:'DATE
"RTN","KMPDUT2",37,0)
 S NM=$P(DATA,U,3) Q:NM=""
"RTN","KMPDUT2",38,0)
 I KMPDTYPE=1 S ^KMPD(8973.1,"APTDTNM",X,DATE,NM,DA)=""
"RTN","KMPDUT2",39,0)
 I KMPDTYPE=2 K ^KMPD(8973.1,"APTDTNM",X,DATE,NM,DA)
"RTN","KMPDUT2",40,0)
 Q
"RTN","KMPDUTL")
0^7^B3136236
"RTN","KMPDUTL",1,0)
KMPDUTL ;OAK/RAK - CM Tools Utility ;3/11/02  15:18
"RTN","KMPDUTL",2,0)
 ;;1.0;CM TOOLS;;Mar 11, 2002
"RTN","KMPDUTL",3,0)
 ;
"RTN","KMPDUTL",4,0)
QUEBKG(KMPDOPT,KMPDTIME,KMPDFREQ,KMPDDEL) ;-- queue background job
"RTN","KMPDUTL",5,0)
 ;-----------------------------------------------------------------------
"RTN","KMPDUTL",6,0)
 ; KMPDOPT.... Option name to queue (free text name in .01 field of 
"RTN","KMPDUTL",7,0)
 ;                                   OPTION file)
"RTN","KMPDUTL",8,0)
 ; KMPDTIME... Date/time to queue option (T@1400, etc)
"RTN","KMPDUTL",9,0)
 ; KMPDFREQ... Scheduling frequency (1D, etc)
"RTN","KMPDUTL",10,0)
 ; KMPDDEL.... Delete option if it already exists in file 19.2
"RTN","KMPDUTL",11,0)
 ;              0 - do not delete (quit if already scheduled)
"RTN","KMPDUTL",12,0)
 ;              1 - delete if already in file 19.2
"RTN","KMPDUTL",13,0)
 ;
"RTN","KMPDUTL",14,0)
 ; This API will queue an option from file #19 (OPTION) to run in file
"RTN","KMPDUTL",15,0)
 ; 19.2 (OPTION SCHEDULE).
"RTN","KMPDUTL",16,0)
 ;-----------------------------------------------------------------------
"RTN","KMPDUTL",17,0)
 Q:$G(KMPDOPT)=""
"RTN","KMPDUTL",18,0)
 Q:$G(KMPDTIME)=""
"RTN","KMPDUTL",19,0)
 Q:$G(KMPDFREQ)=""
"RTN","KMPDUTL",20,0)
 S KMPDDEL=+$G(KMPDDEL)
"RTN","KMPDUTL",21,0)
 N DA,DIFROM,DIK,FDA,ERROR,IEN,IEN1,IENZ,TEXT,X,Y,Z
"RTN","KMPDUTL",22,0)
 ; Newing DIFROM will force reschedule when installing from KIDS
"RTN","KMPDUTL",23,0)
 S:'$G(DT) DT=$$DT^XLFDT
"RTN","KMPDUTL",24,0)
 ; change to internal format
"RTN","KMPDUTL",25,0)
 D FMDTI^KMPDU(.Z,KMPDTIME)
"RTN","KMPDUTL",26,0)
 Q:Z(0)="^"!(Z(0)="")
"RTN","KMPDUTL",27,0)
 S KMPDTIME=Z(0) K Z
"RTN","KMPDUTL",28,0)
 S TEXT=KMPDOPT
"RTN","KMPDUTL",29,0)
 ; quit if not in file 19
"RTN","KMPDUTL",30,0)
 S IEN=$O(^DIC(19,"B",TEXT,0)) Q:'IEN
"RTN","KMPDUTL",31,0)
 S IEN1=$O(^DIC(19.2,"B",IEN,0))
"RTN","KMPDUTL",32,0)
 ; quit if already in file 19.2 and not KMPDDEL
"RTN","KMPDUTL",33,0)
 Q:IEN1&('KMPDDEL)
"RTN","KMPDUTL",34,0)
 ; delete if in file 19.2
"RTN","KMPDUTL",35,0)
 I IEN1 S DIK="^DIC(19.2,",DA=IEN1 D ^DIK
"RTN","KMPDUTL",36,0)
 ; add entry
"RTN","KMPDUTL",37,0)
 S FDA($J,19.2,"+1,",.01)=IEN
"RTN","KMPDUTL",38,0)
 ; queued to run at what time
"RTN","KMPDUTL",39,0)
 S FDA($J,19.2,"+1,",2)=KMPDTIME
"RTN","KMPDUTL",40,0)
 ; rescheduling frequency.
"RTN","KMPDUTL",41,0)
 S FDA($J,19.2,"+1,",6)=KMPDFREQ
"RTN","KMPDUTL",42,0)
 D UPDATE^DIE("","FDA($J)",.IENZ,"ERROR")
"RTN","KMPDUTL",43,0)
 I $D(ERROR) D MSG^DIALOG("W","",60,10,"ERROR")
"RTN","KMPDUTL",44,0)
 S IEN1=$O(^DIC(19.2,"B",IEN,0))
"RTN","KMPDUTL",45,0)
 I '$G(^DIC(19.2,+IEN1,1)) D 
"RTN","KMPDUTL",46,0)
 .D MES^XPDUTL("     ERROR - Not able to reschedule "_KMPDOPT)
"RTN","KMPDUTL",47,0)
 .D MES^XPDUTL("     Use 'Schedule/Unschedule Options' [XUTM SCHEDULE] to reschedule.")
"RTN","KMPDUTL",48,0)
 ;
"RTN","KMPDUTL",49,0)
 Q
"RTN","KMPDUTL",50,0)
 ;
"RTN","KMPDUTL",51,0)
VERSION() ;-- extrinsic - return current version.
"RTN","KMPDUTL",52,0)
 Q $P($T(+2^KMPDUTL),";",3)_"^"_$P($T(+2^KMPDUTL),";",5)
"RTN","KMPDUTL3")
0^8^B939909
"RTN","KMPDUTL3",1,0)
KMPDUTL3 ;OAK/RAK - CM Tools Utility ;3/11/02  15:18
"RTN","KMPDUTL3",2,0)
 ;;1.0;CM TOOLS;;Mar 11, 2002
"RTN","KMPDUTL3",3,0)
 ;
"RTN","KMPDUTL3",4,0)
PURGE(KMPDT) ;-- purge data in file #8973.1
"RTN","KMPDUTL3",5,0)
 ;-----------------------------------------------------------------------
"RTN","KMPDUTL3",6,0)
 ; KMPDT.. Date to begin purge in internal fileman format. Purge will
"RTN","KMPDUTL3",7,0)
 ;           reverse $order and delete entries 'EARLIER' than KMPDT.
"RTN","KMPDUTL3",8,0)
 ;-----------------------------------------------------------------------
"RTN","KMPDUTL3",9,0)
 ;
"RTN","KMPDUTL3",10,0)
 Q:'$G(KMPDT)
"RTN","KMPDUTL3",11,0)
 ;
"RTN","KMPDUTL3",12,0)
 N DA,DATE,DIK,IEN
"RTN","KMPDUTL3",13,0)
 W:'$D(ZTQUEUED) !!,"Purging old records..."
"RTN","KMPDUTL3",14,0)
 S DATE=KMPDT
"RTN","KMPDUTL3",15,0)
 F  S DATE=$O(^KMPD(8973.1,"B",DATE),-1) Q:'DATE!(DATE>KMPDT)  D 
"RTN","KMPDUTL3",16,0)
 .F IEN=0:0 S IEN=$O(^KMPD(8973.1,"B",DATE,IEN)) Q:'IEN  D 
"RTN","KMPDUTL3",17,0)
 ..; quit if not 'sent to cm database'.
"RTN","KMPDUTL3",18,0)
 ..Q:'$P($G(^KMPD(8973.1,IEN,0)),U,2)
"RTN","KMPDUTL3",19,0)
 ..I '$D(ZTQUEUED) W:$X>78 !?16 W "."
"RTN","KMPDUTL3",20,0)
 ..; Delete entry.
"RTN","KMPDUTL3",21,0)
 ..S DA=IEN,DIK="^KMPD(8973.1," D ^DIK
"RTN","KMPDUTL3",22,0)
 ;
"RTN","KMPDUTL3",23,0)
 Q
"SEC","^DIC",8973.1,8973.1,0,"AUDIT")
@
"SEC","^DIC",8973.1,8973.1,0,"DD")
@
"SEC","^DIC",8973.1,8973.1,0,"DEL")
@
"SEC","^DIC",8973.1,8973.1,0,"LAYGO")
@
"SEC","^DIC",8973.1,8973.1,0,"RD")
@
"SEC","^DIC",8973.1,8973.1,0,"WR")
@
"VER")
8.0^22.0
"^DD",8973.1,8973.1,0)
FIELD^^99.006^64
"^DD",8973.1,8973.1,0,"DDA")
N
"^DD",8973.1,8973.1,0,"DT")
3011017
"^DD",8973.1,8973.1,0,"ID","W")
D:$G(Y) ID^KMPDUT2(Y)
"^DD",8973.1,8973.1,0,"IX","APTDTNM",8973.1,.05)

"^DD",8973.1,8973.1,0,"IX","B",8973.1,.01)

"^DD",8973.1,8973.1,0,"NM","CM HL7 DATA")

"^DD",8973.1,8973.1,0,"VRPK")
CM TOOLS
"^DD",8973.1,8973.1,.01,0)
DATE^RD^^0;1^S %DT="EX" D ^%DT S X=Y K:Y<1 X
"^DD",8973.1,8973.1,.01,1,0)
^.1
"^DD",8973.1,8973.1,.01,1,1,0)
8973.1^B
"^DD",8973.1,8973.1,.01,1,1,1)
S ^KMPD(8973.1,"B",$E(X,1,30),DA)=""
"^DD",8973.1,8973.1,.01,1,1,2)
K ^KMPD(8973.1,"B",$E(X,1,30),DA)
"^DD",8973.1,8973.1,.01,3)
(No range limit on date)
"^DD",8973.1,8973.1,.01,"DT")
3010820
"^DD",8973.1,8973.1,.02,0)
SENT TO NATIONAL DATABASE^S^0:NO;1:YES;^0;2^Q
"^DD",8973.1,8973.1,.02,3)

"^DD",8973.1,8973.1,.02,"DT")
3010720
"^DD",8973.1,8973.1,.03,0)
NAMESPACE^F^^0;3^K:$L(X)>4!($L(X)<1) X
"^DD",8973.1,8973.1,.03,3)
Answer must be 1-4 characters in length.
"^DD",8973.1,8973.1,.03,"DT")
3010820
"^DD",8973.1,8973.1,.05,0)
PROTOCOL^F^^0;5^K:$L(X)>63!($L(X)<3) X
"^DD",8973.1,8973.1,.05,1,0)
^.1
"^DD",8973.1,8973.1,.05,1,1,0)
8973.1^APTDTNM^MUMPS
"^DD",8973.1,8973.1,.05,1,1,1)
D XREF^KMPDUT2($G(DA),$G(X),1)
"^DD",8973.1,8973.1,.05,1,1,2)
D XREF^KMPDUT2($G(DA),$G(X),2)
"^DD",8973.1,8973.1,.05,1,1,"%D",0)
^^1^1^3010820^
"^DD",8973.1,8973.1,.05,1,1,"%D",1,0)
^KMPD(8973.1,"APTDTNM",Protocol,Date,Namespace)=""
"^DD",8973.1,8973.1,.05,1,1,"DT")
3010820
"^DD",8973.1,8973.1,.05,3)
Answer must be 3-63 characters in length
"^DD",8973.1,8973.1,.05,"DT")
3010820
"^DD",8973.1,8973.1,1.001,0)
TRANS TCP TOT CHR (PT)^F^^1;1^K:$L(X)>25!($L(X)<1) X
"^DD",8973.1,8973.1,1.001,3)
Answer must be 1-25 characters in length
"^DD",8973.1,8973.1,1.001,"DT")
3010720
"^DD",8973.1,8973.1,1.002,0)
TRANS TCP TOT MESSAGES (PT)^F^^1;2^K:$L(X)>25!($L(X)<1) X
"^DD",8973.1,8973.1,1.002,3)
Answer must be 1-25 characters in length
"^DD",8973.1,8973.1,1.002,"DT")
3010720
"^DD",8973.1,8973.1,1.003,0)
TRANS TCP TOT SECONDS (PT)^F^^1;3^K:$L(X)>25!($L(X)<1) X
"^DD",8973.1,8973.1,1.003,3)
Answer must be 1-25 characters in length
"^DD",8973.1,8973.1,1.003,"DT")
3010720
"^DD",8973.1,8973.1,1.004,0)
TRANS MAIL TOT CHR (PT)^F^^1;4^K:$L(X)>25!($L(X)<1) X
"^DD",8973.1,8973.1,1.004,3)
Answer must be 1-25 characters in length
"^DD",8973.1,8973.1,1.004,"DT")
3010720
"^DD",8973.1,8973.1,1.005,0)
TRANS MAIL TOT MESSAGES (PT)^F^^1;5^K:$L(X)>25!($L(X)<1) X
"^DD",8973.1,8973.1,1.005,3)
Answer must be 1-25 characters in length
"^DD",8973.1,8973.1,1.005,"DT")
3010720
"^DD",8973.1,8973.1,1.006,0)
TRANS MAIL TOT SECONDS (PT)^F^^1;6^K:$L(X)>25!($L(X)<1) X
"^DD",8973.1,8973.1,1.006,3)
Answer must be 1-25 characters in length
"^DD",8973.1,8973.1,1.006,"DT")
3010720
"^DD",8973.1,8973.1,1.007,0)
TRANS UNK TOT CHR (PT)^F^^1;7^K:$L(X)>25!($L(X)<1) X
"^DD",8973.1,8973.1,1.007,3)
Answer must be 1-25 characters in length
"^DD",8973.1,8973.1,1.007,"DT")
3010720
"^DD",8973.1,8973.1,1.008,0)
TRANS UNK TOT MESSAGES (PT)^F^^1;8^K:$L(X)>25!($L(X)<1) X
"^DD",8973.1,8973.1,1.008,3)
Answer must be 1-25 characters in length
"^DD",8973.1,8973.1,1.008,"DT")
3010720
"^DD",8973.1,8973.1,1.009,0)
TRANS UNK TOT SECONDS (PT)^F^^1;9^K:$L(X)>25!($L(X)<1) X
"^DD",8973.1,8973.1,1.009,3)
Answer must be 1-25 characters in length
"^DD",8973.1,8973.1,1.009,"DT")
3010720
"^DD",8973.1,8973.1,1.101,0)
I/O INCOMING TOT CHR (PT)^F^^1.1;1^K:$L(X)>25!($L(X)<1) X
"^DD",8973.1,8973.1,1.101,3)
Answer must be 1-25 characters in length
"^DD",8973.1,8973.1,1.101,"DT")
3010720
"^DD",8973.1,8973.1,1.102,0)
I/O INCOMING TOT MESSAGES (PT)^F^^1.1;2^K:$L(X)>25!($L(X)<1) X
"^DD",8973.1,8973.1,1.102,3)
Answer must be 1-25 characters in length
"^DD",8973.1,8973.1,1.102,"DT")
3010720
"^DD",8973.1,8973.1,1.103,0)
I/O INCOMING TOT SECONDS (PT)^F^^1.1;3^K:$L(X)>25!($L(X)<1) X
"^DD",8973.1,8973.1,1.103,3)
Answer must be 1-25 characters in length
"^DD",8973.1,8973.1,1.103,"DT")
3010720
"^DD",8973.1,8973.1,1.104,0)
I/O OUTGOING TOT CHR (PT)^F^^1.1;4^K:$L(X)>25!($L(X)<1) X
"^DD",8973.1,8973.1,1.104,3)
Answer must be 1-25 characters in length
"^DD",8973.1,8973.1,1.104,"DT")
3010720
"^DD",8973.1,8973.1,1.105,0)
I/O OUTGOING TOT MESSAGES (PT)^F^^1.1;5^K:$L(X)>25!($L(X)<1) X
"^DD",8973.1,8973.1,1.105,3)
Answer must be 1-25 characters in length
"^DD",8973.1,8973.1,1.105,"DT")
3010720
"^DD",8973.1,8973.1,1.106,0)
I/O OUTGOING TOT SECONDS (PT)^F^^1.1;6^K:$L(X)>25!($L(X)<1) X
"^DD",8973.1,8973.1,1.106,3)
Answer must be 1-25 characters in length
"^DD",8973.1,8973.1,1.106,"DT")
3010720
"^DD",8973.1,8973.1,1.107,0)
I/O UNK TOT CHR (PT)^F^^1.1;7^K:$L(X)>25!($L(X)<1) X
"^DD",8973.1,8973.1,1.107,3)
Answer must be 1-25 characters in length
"^DD",8973.1,8973.1,1.107,"DT")
3010720
"^DD",8973.1,8973.1,1.108,0)
I/O UNK TOT MESSAGES (PT)^F^^1.1;8^K:$L(X)>25!($L(X)<1) X
"^DD",8973.1,8973.1,1.108,3)
Answer must be 1-25 characters in length
"^DD",8973.1,8973.1,1.108,"DT")
3010720
"^DD",8973.1,8973.1,1.109,0)
I/O UNK TOT SECONDS (PT)^F^^1.1;9^K:$L(X)>25!($L(X)<1) X
"^DD",8973.1,8973.1,1.109,3)
Answer must be 1-25 characters in length
"^DD",8973.1,8973.1,1.109,"DT")
3010720
"^DD",8973.1,8973.1,1.201,0)
L/R LOCAL TOT CHR (PT)^F^^1.2;1^K:$L(X)>25!($L(X)<1) X
"^DD",8973.1,8973.1,1.201,3)
Answer must be 1-25 characters in length
"^DD",8973.1,8973.1,1.201,"DT")
3010720
"^DD",8973.1,8973.1,1.202,0)
L/R LOCAL TOT MESSAGES (PT)^F^^1.2;2^K:$L(X)>25!($L(X)<1) X
"^DD",8973.1,8973.1,1.202,3)
Answer must be 1-25 characters in length
"^DD",8973.1,8973.1,1.202,"DT")
3010720
"^DD",8973.1,8973.1,1.203,0)
L/R LOCAL TOT SECONDS (PT)^F^^1.2;3^K:$L(X)>25!($L(X)<1) X
"^DD",8973.1,8973.1,1.203,3)
Answer must be 1-25 characters in length
"^DD",8973.1,8973.1,1.203,"DT")
3010720
"^DD",8973.1,8973.1,1.204,0)
L/R REMOTE TOT CHR (PT)^F^^1.2;4^K:$L(X)>25!($L(X)<1) X
"^DD",8973.1,8973.1,1.204,3)
Answer must be 1-25 characters in length
"^DD",8973.1,8973.1,1.204,"DT")
3010720
"^DD",8973.1,8973.1,1.205,0)
L/R REMOTE TOT MESSAGES (PT)^F^^1.2;5^K:$L(X)>25!($L(X)<1) X
"^DD",8973.1,8973.1,1.205,3)
Answer must be 1-25 characters in length
"^DD",8973.1,8973.1,1.205,"DT")
3010720
"^DD",8973.1,8973.1,1.206,0)
L/R REMOTE TOT SECONDS (PT)^F^^1.2;6^K:$L(X)>25!($L(X)<1) X
"^DD",8973.1,8973.1,1.206,3)
Answer must be 1-25 characters in length
"^DD",8973.1,8973.1,1.206,"DT")
3010720
"^DD",8973.1,8973.1,1.207,0)
L/R UNK TOT CHR (PT)^F^^1.2;7^K:$L(X)>25!($L(X)<1) X
"^DD",8973.1,8973.1,1.207,3)
Answer must be 1-25 characters in length
"^DD",8973.1,8973.1,1.207,"DT")
3010720
"^DD",8973.1,8973.1,1.208,0)
L/R UNK TOT MESSAGES (PT)^F^^1.2;8^K:$L(X)>25!($L(X)<1) X
"^DD",8973.1,8973.1,1.208,3)
Answer must be 1-25 characters in length
"^DD",8973.1,8973.1,1.208,"DT")
3010720
"^DD",8973.1,8973.1,1.209,0)
L/R UNK TOT SECONDS (PT)^F^^1.2;9^K:$L(X)>25!($L(X)<1) X
"^DD",8973.1,8973.1,1.209,3)
Answer must be 1-25 characters in length
"^DD",8973.1,8973.1,1.209,"DT")
3010720
"^DD",8973.1,8973.1,2.001,0)
TRANS TCP TOT CHR (NP)^F^^2;1^K:$L(X)>25!($L(X)<1) X
"^DD",8973.1,8973.1,2.001,3)
Answer must be 1-25 characters in length
"^DD",8973.1,8973.1,2.001,"DT")
3010720
"^DD",8973.1,8973.1,2.002,0)
TRANS TCP TOT MESSAGES (NP)^F^^2;2^K:$L(X)>25!($L(X)<1) X
"^DD",8973.1,8973.1,2.002,3)
Answer must be 1-25 characters in length
"^DD",8973.1,8973.1,2.002,"DT")
3010720
"^DD",8973.1,8973.1,2.003,0)
TRANS TCP TOT SECONDS (NP)^F^^2;3^K:$L(X)>25!($L(X)<1) X
"^DD",8973.1,8973.1,2.003,3)
Answer must be 1-25 characters in length
"^DD",8973.1,8973.1,2.003,"DT")
3010720
"^DD",8973.1,8973.1,2.004,0)
TRANS MAIL TOT CHR (NP)^F^^2;4^K:$L(X)>25!($L(X)<1) X
"^DD",8973.1,8973.1,2.004,3)
Answer must be 1-25 characters in length
"^DD",8973.1,8973.1,2.004,"DT")
3010720
"^DD",8973.1,8973.1,2.005,0)
TRANS MAIL TOT MESSAGES (NP)^F^^2;5^K:$L(X)>25!($L(X)<1) X
"^DD",8973.1,8973.1,2.005,3)
Answer must be 1-25 characters in length
"^DD",8973.1,8973.1,2.005,"DT")
3010720
"^DD",8973.1,8973.1,2.006,0)
TRANS MAIL TOT SECONDS (NP)^F^^2;6^K:$L(X)>25!($L(X)<1) X
"^DD",8973.1,8973.1,2.006,3)
Answer must be 1-25 characters in length
"^DD",8973.1,8973.1,2.006,"DT")
3010720
"^DD",8973.1,8973.1,2.007,0)
TRANS UNK TOT CHR (NP)^F^^2;7^K:$L(X)>25!($L(X)<1) X
"^DD",8973.1,8973.1,2.007,3)
Answer must be 1-25 characters in length
"^DD",8973.1,8973.1,2.007,"DT")
3010720
"^DD",8973.1,8973.1,2.008,0)
TRANS UNK TOT MESSAGES (NP)^F^^2;8^K:$L(X)>25!($L(X)<1) X
"^DD",8973.1,8973.1,2.008,3)
Answer must be 1-25 characters in length
"^DD",8973.1,8973.1,2.008,"DT")
3010720
"^DD",8973.1,8973.1,2.009,0)
TRANS UNK TOT SECONDS (NP)^F^^2;9^K:$L(X)>25!($L(X)<1) X
"^DD",8973.1,8973.1,2.009,3)
Answer must be 1-25 characters in length
"^DD",8973.1,8973.1,2.009,"DT")
3010720
"^DD",8973.1,8973.1,2.101,0)
I/O INCOMING TOT CHR (PT)^F^^2.1;1^K:$L(X)>25!($L(X)<1) X
"^DD",8973.1,8973.1,2.101,3)
Answer must be 1-25 characters in length
"^DD",8973.1,8973.1,2.101,"DT")
3010720
"^DD",8973.1,8973.1,2.102,0)
I/O INCOMING TOT MESSAGES (NP)^F^^2.1;2^K:$L(X)>25!($L(X)<1) X
"^DD",8973.1,8973.1,2.102,3)
Answer must be 1-25 characters in length
"^DD",8973.1,8973.1,2.102,"DT")
3010720
"^DD",8973.1,8973.1,2.103,0)
I/O INCOMING TOT SECONDS (NP)^F^^2.1;3^K:$L(X)>25!($L(X)<1) X
"^DD",8973.1,8973.1,2.103,3)
Answer must be 1-25 characters in length
"^DD",8973.1,8973.1,2.103,"DT")
3010720
"^DD",8973.1,8973.1,2.104,0)
I/O OUTGOING TOT CHR (NP)^F^^2.1;4^K:$L(X)>25!($L(X)<1) X
"^DD",8973.1,8973.1,2.104,3)
Answer must be 1-25 characters in length
"^DD",8973.1,8973.1,2.104,"DT")
3010720
"^DD",8973.1,8973.1,2.105,0)
I/O OUTGOING TOT MESSAGES (NP)^F^^2.1;5^K:$L(X)>25!($L(X)<1) X
"^DD",8973.1,8973.1,2.105,3)
Answer must be 1-25 characters in length
"^DD",8973.1,8973.1,2.105,"DT")
3010720
"^DD",8973.1,8973.1,2.106,0)
I/O OUTGOING TOT SECONDS (NP)^F^^2.1;6^K:$L(X)>25!($L(X)<1) X
"^DD",8973.1,8973.1,2.106,3)
Answer must be 1-25 characters in length
"^DD",8973.1,8973.1,2.106,"DT")
3010720
"^DD",8973.1,8973.1,2.107,0)
I/O UNK TOT CHR (NP)^F^^2.1;7^K:$L(X)>25!($L(X)<1) X
"^DD",8973.1,8973.1,2.107,3)
Answer must be 1-25 characters in length
"^DD",8973.1,8973.1,2.107,"DT")
3010720
"^DD",8973.1,8973.1,2.108,0)
I/O UNK TOT MESSAGES (NP)^F^^2.1;8^K:$L(X)>25!($L(X)<1) X
"^DD",8973.1,8973.1,2.108,3)
Answer must be 1-25 characters in length
"^DD",8973.1,8973.1,2.108,"DT")
3010720
"^DD",8973.1,8973.1,2.109,0)
I/O UNK TOT SECONDS (NP)^F^^2.1;9^K:$L(X)>25!($L(X)<1) X
"^DD",8973.1,8973.1,2.109,3)
Answer must be 1-25 characters in length
"^DD",8973.1,8973.1,2.109,"DT")
3010720
"^DD",8973.1,8973.1,2.201,0)
L/R LOCAL TOT CHR (NP)^F^^2.2;1^K:$L(X)>25!($L(X)<1) X
"^DD",8973.1,8973.1,2.201,3)
Answer must be 1-25 characters in length
"^DD",8973.1,8973.1,2.201,"DT")
3010720
"^DD",8973.1,8973.1,2.202,0)
L/R LOCAL TOT MESSAGES (NP)^F^^2.2;2^K:$L(X)>25!($L(X)<1) X
"^DD",8973.1,8973.1,2.202,3)
Answer must be 1-25 characters in length
"^DD",8973.1,8973.1,2.202,"DT")
3010720
"^DD",8973.1,8973.1,2.203,0)
L/R LOCAL TOT SECONDS (NP)^F^^2.2;3^K:$L(X)>25!($L(X)<1) X
"^DD",8973.1,8973.1,2.203,3)
Answer must be 1-25 characters in length
"^DD",8973.1,8973.1,2.203,"DT")
3010720
"^DD",8973.1,8973.1,2.204,0)
L/R REMOTE TOT CHR (PT)^F^^2.2;4^K:$L(X)>25!($L(X)<1) X
"^DD",8973.1,8973.1,2.204,3)
Answer must be 1-25 characters in length
"^DD",8973.1,8973.1,2.204,"DT")
3010720
"^DD",8973.1,8973.1,2.205,0)
L/R REMOTE TOT MESSAGES (NP)^F^^2.2;5^K:$L(X)>25!($L(X)<1) X
"^DD",8973.1,8973.1,2.205,3)
Answer must be 1-25 characters in length
"^DD",8973.1,8973.1,2.205,"DT")
3010720
"^DD",8973.1,8973.1,2.206,0)
L/R REMOTE TOT SECONDS (NP)^F^^2.2;6^K:$L(X)>25!($L(X)<1) X
"^DD",8973.1,8973.1,2.206,3)
Answer must be 1-25 characters in length
"^DD",8973.1,8973.1,2.206,"DT")
3010720
"^DD",8973.1,8973.1,2.207,0)
L/R UNK TOT CHR (NP)^F^^2.2;7^K:$L(X)>25!($L(X)<1) X
"^DD",8973.1,8973.1,2.207,3)
Answer must be 1-25 characters in length
"^DD",8973.1,8973.1,2.207,"DT")
3010720
"^DD",8973.1,8973.1,2.208,0)
L/R UNK TOT MESSAGES (NP)^F^^2.2;8^K:$L(X)>25!($L(X)<1) X
"^DD",8973.1,8973.1,2.208,3)
Answer must be 1-25 characters in length
"^DD",8973.1,8973.1,2.208,"DT")
3010720
"^DD",8973.1,8973.1,2.209,0)
L/R UNK TOT SECONDS (NP)^F^^2.2;9^K:$L(X)>25!($L(X)<1) X
"^DD",8973.1,8973.1,2.209,3)
Answer must be 1-25 characters in length
"^DD",8973.1,8973.1,2.209,"DT")
3010720
"^DD",8973.1,8973.1,99.001,0)
TOT CHR (PT)^F^^99;1^K:$L(X)>25!($L(X)<1) X
"^DD",8973.1,8973.1,99.001,3)
Answer must be 1-25 characters in length
"^DD",8973.1,8973.1,99.001,"DT")
3010816
"^DD",8973.1,8973.1,99.002,0)
TOT MESSAGES (PT)^F^^99;2^K:$L(X)>25!($L(X)<1) X
"^DD",8973.1,8973.1,99.002,3)
Answer must be 1-25 characters in length
"^DD",8973.1,8973.1,99.002,"DT")
3010816
"^DD",8973.1,8973.1,99.003,0)
TOT SECONDS (PT)^F^^99;3^K:$L(X)>25!($L(X)<1) X
"^DD",8973.1,8973.1,99.003,3)
Answer must be 1-25 characters in length
"^DD",8973.1,8973.1,99.003,"DT")
3010816
"^DD",8973.1,8973.1,99.004,0)
TOT CHR (NP)^F^^99;4^K:$L(X)>25!($L(X)<1) X
"^DD",8973.1,8973.1,99.004,3)
Answer must be 1-25 characters in length
"^DD",8973.1,8973.1,99.004,"DT")
3010816
"^DD",8973.1,8973.1,99.005,0)
TOT MESSAGES (NP)^F^^99;5^K:$L(X)>25!($L(X)<1) X
"^DD",8973.1,8973.1,99.005,3)
Answer must be 1-25 characters in length
"^DD",8973.1,8973.1,99.005,"DT")
3010816
"^DD",8973.1,8973.1,99.006,0)
TOT SECONDS (NP)^F^^99;6^K:$L(X)>25!($L(X)<1) X
"^DD",8973.1,8973.1,99.006,3)
Answer must be 1-25 characters in length
"^DD",8973.1,8973.1,99.006,"DT")
3010816
"^DIC",8973.1,8973.1,0)
CM HL7 DATA^8973.1
"^DIC",8973.1,8973.1,0,"GL")
^KMPD(8973.1,
"^DIC",8973.1,8973.1,"%",0)
^1.005^^0
"^DIC",8973.1,8973.1,"%D",0)
^^1^1^3010820^
"^DIC",8973.1,8973.1,"%D",1,0)
Holds HL7 daily statistics.
"^DIC",8973.1,"B","CM HL7 DATA",8973.1)

**END**
**END**
