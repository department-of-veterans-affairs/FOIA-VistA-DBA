$TXT Created by BEUSCHEL,GARY at REL.MAILMAN.ISC-SF.VA.GOV  (KIDS) on MONDAY, 02/24/97 at 13:41
=============================================================================
Run Date: MAY 09, 1997                     Designation: XM*7.1*36
Package : XM - MAILMAN                         Priority: Mandatory
Version : 7.1        SEQ #38                    Status: Released
=============================================================================


Subject: Let Domain begin with number

Category: 
  - Routine
  - Data Dictionary
  - Enhancement (Mandatory)
  - Informational

Description: 
============

  MailMan patch XM*7.1*36 contains the following enhancements and bug fixes:
   
  NOIS: ISF-0195-60010      Routine: ^XMAH0
  Message range will no longer delete when user times out answering question,
  "Are you sure?"
  
  NOIS: PHO-0896-61825      Routine: ^XMA21A
  Domain names starting with a number are valid and will no longer be rejected.
  
  NOIS: NOL-0896-70074      Routine: ^XMAD1A
  Ensures that recipient multiple records start from 1.
  
  E3R: 7039,8898            Routine: ^XMA21A,^XMA21G
  Users holding new security key "XM GROUP PRIORITY" may forward priority
  mail to groups.
  
  NOIS: PIH-0496-21979      Routine: ^XMA21A
  If NETWORK - MAX LINES @ SEND TO field is null in the KERNEL SITE PARAMETERS
  file, the default maximum message lines is no longer 2000 - it is unlimited. 
  
  In connection with this, I am passing on a request from Brenda Bishop (via Hal
  Whitley) @ ISC-BIRM.VA.GOV to all sites running CMOP (the Consolidated Mail
  Outpatient Pharmacy Package): 
   
  "Sites using the Consolidated Mail Outpatient Pharmacy (CMOP) package are
  advised to set the Kernel site parameter field [NETWORK - MAX LINES @
  SEND TO] field to Null (without value)."
  
  NOIS: TUC-0395-60417      Routine: ^XMA7G
                            DD: file 3.8, field .01 - add "LAYGO" node
  Prevents users from adding a private mail group with the same name as a
  public one.
  
  NOIS: SPO-0595-50655      Routine: ^XMYPOST6
                            DD:  file 3.8, field .01 - remove identifier node
  Removes the identifier (Coordinator field) from the .01 field of the Mail
  Group file.  (DBIA #1622)
  
  NOIS: None                Routine: ^XMYPOST6
                            DD:  file 3.7, field 2   - add a cross reference
  Add a new cross reference (F) on the FORWARDING ADDRESS field of the MAIL BOX
  file.  This enables the site manager to easily find and remedy bad forwarding
  addresses.
  
  NOIS: SBY-0695-30284      Routine: ^XMAP
  If the user's institution field is set to null, '()' will no longer appear
  after the user's name when showing institutions on mail messages.
   
  NOIS: ATG-0495-30025      Routine: ^XMA0
  If you save a group of messages to a new mailbox, the zero node of the
  message multiple will be created.  Previously, it hadn't been.
  
  NOIS: DAY-1096-41348      Routine: ^XMA1
  If '^' is contained in the response to 'Select message action' prompt,
  MM will up-arrow out.
  
  NOIS: None                Routine: ^XMA5A,^XMAI2,^XMAPHOST,^XMUT5G
  Remove references to the old user file:  ^DIC(3
  
  NOIS: SDC-1296-61151      Routine: ^XMA0,^XMA1
  Correct MailMan's response if the user chooses not to proceed with message
  termination.
  
  NOIS: None                Routine: ^XMA21G
  Reference mail message #22778858 on FORUM from Milt Roberson.  MM aborted
  when trying to expand a group which included a remote member at a numeric
  address at compuserve.com.  This fixes that.
  
  NOIS: BRX-0197-10241      Routine: ^XMA0,^XMA01
  At the <save,delete,terminate,print> "which messages" prompt, if the user's
  answer includes ^, then the function is aborted.
  
  E3R: 9311                 Routine: ^XMA7G
  Users enrolled in a mail group which does not allow self-enrollment can no
  longer disenroll themselves.
  
  NOIS: None                Routine: ^XMR1A
  Prevent subscript in global reference from being more than 64 characters long.
  Reference FORUM msg #23054338.
  
  NOIS: MEM-0197-70649      Routine: ^XMBGRP
  Routine no longer attempts to write to the screen during 'silent' calls.
  Documentation corrected.  Parameter 'D' in call to function $$MG^XMBGRP,
  if set to 0 will not allow self-enrollment in a group; 1 will allow.
  
  Replace the description of $$MG^XMBGRP on page 31 of the Programmer Reference
  Manual with the following: 
  
  ============================================================================
  $$MG^XMBGRP
  
  This extrinsic function is used to create a new mail group or to add members
  to an existing mail group.  Only local users may be enrolled as members with
  this function.
  
  Usage:  S X=$$MG^XMBGRP(A,B,C,D,.E,.F,G)
  
  (B,C,D,.F are ignored if the mail group previously exists.)
  
  If successful, X will have the value of the mail group internal entry number.
  If unsuccessful, X will be zero.
  
  Where:
  
  A =Mail group name (if new group)
     Mail group internal entry number (if existing group)
  B =Mail group type flag (0=public; 1=private)
  C =DUZ of organizer (.5=Postmaster assumed, if 0 passed)
  D =Self enrollment allowed flag (0=no; 1=yes)
  .E=Array of members to be enrolled.
     Members must be local users.
     Array must consist of DUZ's only; not names.
     E(n)="", where n is the member's DUZ.
  .F=Mail group description array.
     F(1)="first line"
     F(2)="second line"
     etc.
  G =Silent flag (0=interactive; 1=silent)
  ============================================================================
  
  NOIS: none
  Reference message #23076068 on FORUM from Skip Williams.  Correct the
  documentation on page 46 of the 'Programmer Reference Manual'.
  In the Example, Step 3 -- Deliver Message to Recipients, the last line of
  code should be:
  
          D ENT1^XMD ; Call for MailMan Delivery
  
  NOIS: none                Routines: ^XMA21G,^XMA7G,^XMAD1,
                                      ^XMAD1A,^XMA5A,^XMFAX
                            DD:  file 3.8, field 14 (new)
                                 file 3.8, field 15 (new)
                                 file 3.9, (within Recipient multiple)
                                           field 13 (new)
                                 file 3.9, (within Recipient multiple)
                                           field 14 (new)
                                 file 4.3, field 143 (new)
  
  MailMan, with this patch, is now able to fax messages.  Currently, only FORUM
  (to my knowledge) is able to take advantage of this new capability, which
  requires the presence of the AKF* suite of fax software and files and fax
  capability.  The site manager should indicate whether or not the site is
  fax-enabled by setting the new field #143 in file 4.3 (default is "no"). 
  
  Two new mail group multiples have been added to the Mail Group file:  Fax
  Recipient, and Fax Group.  These multiples point to associated files in the fax
  (AKF*) suite.  These files (^AKF("FAXR", Fax Rolodex, and ^AKF("FAXG", Fax
  Group) must be populated through the fax suite.  LAYGO through MailMan is not
  permitted. 
  
  When a mail message is sent (or forwarded) to a mail group with these fax
  multiples populated, the message is also transferred to the fax suite, and a
  task is queued to fax the message to those recipients pointed to by the group. 
  
  Fax recipients are faxed only the original message.  Replies to mail messages
  are not faxed. Replies are not delivered as e-mail to fax recipients, unless
  they are also on the message as "normal" recipients. 
  
  MailMan faxes do not have a cover page.  They print in much the same way as a
  message is printed on a printer. 
  
  Individual fax recipients are stored in the recipient multiple of the message
  (identified as F.<fax recipient>).  A "Query" of the message will reveal that
  the message was sent to the Mail Group.  A "Query Detail" will reveal fax
  recipients, when the message was transferred to the fax suite, and the fax ID
  assigned to it by the fax suite, but will not reveal the transmission status. 
  (The user can ascertain the transmission status via the fax suite and the fax
  ID.) 
  
  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
  NOT INCLUDED in this patch is:
  1) a necessary change to ^AKFAX to enable it to
  recognize a MailMan Fax so that it can suppress the cover page for MailMan
  faxes and address the fax to the recipient ("MailMan Fax for ... ").
  2) a new field in file #589500 - ^AKF("FAX", FAX TRANSMISSION FILE
  589500,3    MAILMAN FAX       0;4 SET OF CODES
                                '0' FOR NO;
                                '1' FOR YES;
              HELP-PROMPT:      Is this a MailMan-generated fax?
              DESCRIPTION:      Routine ^AKFAX checks this field to see if the
                                fax is a MailMan generated fax.  If it is, then
                                1) the fax cover sheet is suppressed and
                                2) two additional lines are added to the top of
                                the fax, identifying the recipient and the fax ID.
  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
  
  Following are DD extracts of the new fields:
  
  STANDARD DATA DICTIONARY #4.3 -- KERNEL SITE PARAMETERS FILE STORED IN ^XMB(1,
  
  4.3,143     FAX ENABLED       0;19 SET OF CODES
                                '0' FOR no; 
                                '1' FOR yes; 
              HELP-PROMPT:      Is your site fax enabled? 
              DESCRIPTION:      Your site is fax enabled if you have the suite
                                of fax software and files (^AKF) and fax
                                capability and you choose to allow faxes to be
                                sent via MailMan.  
                                To send faxes via MailMan, Mail groups (file
                                3.8) must first be populated in the fax
                                recipient and fax group multiples.  Then, when
                                a user sends a message to a mail group, the
                                message is also faxed to any fax recipients in
                                that mail group.
                                Responses to the message are not faxed.
   
  STANDARD DATA DICTIONARY #3.8 -- MAIL GROUP FILE          STORED IN ^XMB(3.8, 
  
  3.8,14      FAX RECIPIENT     8;0 POINTER Multiple #3.814
  3.814,.01     FAX RECIPIENT     0;1 POINTER TO FAX ROLODEX FILE (#589499)
                                   (Multiply asked)
                HELP-PROMPT:      Enter the fax recipient who should receive 
                                  faxes sent to this mail group. 
                DESCRIPTION:      This is a list of individual recipients who
                                  will receive by fax any mail sent to this
                                  mail group.  They receive the original
                                  message only.  They do not receive responses.
                CROSS-REFERENCE:  3.814^B 
                                  1)= S ^XMB(3.8,DA(1),8,"B",$E(X,1,30),DA)=""
                                  2)= K ^XMB(3.8,DA(1),8,"B",$E(X,1,30),DA)
  
  3.8,15      FAX GROUP           9;0 POINTER Multiple #3.815
  3.815,.01     FAX GROUP           0;1 POINTER TO FAX GROUP FILE (#589498)
                                   (Multiply asked)
                INPUT TRANSFORM:  S DIC("S")="N XM S XM=$G(^(3)) I $P(XM,U,2)!(
                                  $G(XMDUZ,DUZ)=+XM)" D ^DIC K DIC S DIC=DIE,X=
                                  +Y K:Y<0 X
                HELP-PROMPT:      Enter the fax group which should receive 
                                  faxes sent to this mail group. 
                DESCRIPTION:      Each member of the fax group will receive by
                                  fax any message sent to this mail group. 
                                  Only the original message will be faxed. 
                                  Responses will not be faxed.  
                SCREEN:           S DIC("S")="N XM S XM=$G(^(3))
                                             I $P(XM,U,2)!($G(XMDUZ,DUZ)=+XM)"
                EXPLANATION:      Group must be public or user must be
                                  (surrogate of) creator of group.
                CROSS-REFERENCE:  3.815^B 
                                  1)= S ^XMB(3.8,DA(1),9,"B",$E(X,1,30),DA)=""
                                  2)= K ^XMB(3.8,DA(1),9,"B",$E(X,1,30),DA)
  
  STANDARD DATA DICTIONARY #3.9 -- MESSAGE FILE     STORED IN ^XMB(3.9,
  
  3.91,13   FAX RECIPIENT         0;11 POINTER TO FAX ROLODEX FILE (#589499)
                HELP-PROMPT:      Enter the fax recipient 
                DESCRIPTION:      When the message is addressed to a fax
                                  recipient, this field points to the fax
                                  rolodex file.  After the message is handed
                                  off to the fax software, the pointer in this
                                  field is deleted, the STATUS field is deleted,
                                  and the FAX ID field is set to the fax ID
                                  number assigned to it by the fax software.
                CROSS-REFERENCE:  3.91^AFAX 
                                  1)= S ^XMB(3.9,DA(1),1,"AFAX",$E(X,1,30),DA)=""
                                  2)= K ^XMB(3.9,DA(1),1,"AFAX",$E(X,1,30),DA)
                                  This cross reference makes it possible for
                                  MailMan to immediately find the recipients
                                  to fax a message to.
  
  3.91,14   FAX ID                0;12 FREE TEXT (1-14 CHARS)
                HELP-PROMPT:      Enter the fax ID
                DESCRIPTION:      This is the fax ID as assigned to it by the
                                  fax software (^AKF*).
  
  ===========================================================================
  
   This patch should be installed after hours, when user activity is at a
   minimum.  You should put the XMUSER Option out of order and shut down
   mail delivery tasks.  A cross reference ("F", on FORWARDING ADDRESS) is
   being added to the MAIL BOX file, and a lock must be placed on the whole
   global for the duration of the indexing.  If the lock cannot be obtained,
   the indexing of the new cross reference will not run.  If the indexing does
   not run, you can do it later by running ^XMYPOST6 yourself.  ^XMYPOST6
   will take about 1 minute per 2500 users in the ^XMB(3.7 global.
  ===========================================================================
   
  INSTALLATION:
    1.  This routine is usually mapped on systems that allow mapping,
        so you will need to disable mapping for the effected routine.
    2.  Use the 'INSTALL/CHECK MESSAGE' option on the PackMan menu. This
        option will load the KIDS package onto your system.
    3.  The patch has now been loaded into a Transport global on your
        system. You now need to use KIDS to install the Transport global.
    4.  On the KIDS menu, under the 'Installation' menu, use the following
        options:
           Print Transport Global
           Compare Transport Global to Current System
           Verify Checksums in Transport Global
           Backup a Transport Global
           Install Package(s)
    5.  MSM Sites - Answer YES to the question 'Want to MOVE routines to
        other CPUs?'. Enter the names of your Compute and Print server(s).
    6.  AXP Sites, after patch has installed, rebuild your map set.
  ============================================================================ 
    
   ROUTINES:
     The second line of the routine now looks like:
         ;;7.1;MailMan;**[patch list]**;Jun 02, 1994
   
                  Before          After
   Name          Checksum       Checksum          Patch List
   ----------------------------------------------------------
   
   XMA0           9701230       10480365          15,36
   XMA01          2756871        2847569          36
   XMA1           9575986        9580091          31,36
   XMA21A         8186870        7475211          4,30,36
   XMA21G         9710102       11073971          31,36
   XMA5A         14213526       13683319          31,36
   XMA7G          5426292        5211523          36
   XMAD1          7205963        7275936          24,27,36
   XMAD1A         5656044        6312375          36
   XMAH0          1594203        1761641          36
   XMAI2          1646281        1510945          36
   XMAP           8812311        8826127          24,36
   XMAPHOST       6366459        6157206          7,14,27,36
   XMBGRP         5496318        5680054          13,36
   XMFAX          **new**        4957190          36
   XMR1A          6956680        6979581          13,36
   XMUT5G          380003         338629          36
   XMYPOST6       **new**          11500          36
  
  ============================================================================

Routine Information:
====================

Routine Name:
  - XMYPOST6


Routine Checksum:

Routine Name:
  - XMA5A


Routine Checksum:

Routine Name:
  - XMAPHOST


Routine Checksum:

Routine Name:
  - XMUT5G


Routine Checksum:

Routine Name:
  - XMAI2


Routine Checksum:

Routine Name:
  - XMAH0


Routine Checksum:

Routine Name:
  - XMA21A


Routine Checksum:

Routine Name:
  - XMAD1A


Routine Checksum:

Routine Name:
  - XMA21G


Routine Checksum:

Routine Name:
  - XMA7G


Routine Checksum:

Routine Name:
  - XMAP


Routine Checksum:

Routine Name:
  - XMA0


Routine Checksum:

Routine Name:
  - XMA1


Routine Checksum:

Routine Name:
  - XMFAX


Routine Checksum:

Routine Name:
  - XMAD1


Routine Checksum:

Routine Name:
  - XMA01


Routine Checksum:

Routine Name:
  - XMBGRP


Routine Checksum:

Routine Name:
  - XMR1A


Routine Checksum:

=============================================================================
User Information:                               
Entered By  : BEUSCHEL,GARY                  Date Entered : SEP 04, 1996
Completed By: DIMICELI,RON                  Date Completed: MAR 04, 1997
Released By : JURASAS,ERIC                  Date Released : MAY 09, 1997
=============================================================================


Packman Mail Message:
=====================

$END TXT
