Released XM*7.1*36 SEQ #38
Extracted from mail message
**KIDS**:XM*7.1*36^

**INSTALL NAME**
XM*7.1*36
"BLD",17,0)
XM*7.1*36^MAILMAN^0^2970224^n
"BLD",17,1,0)
^^323^323^2970224^^^^
"BLD",17,1,1,0)
MailMan patch XM*7.1*36 contains the following enhancements and bug fixes:
"BLD",17,1,2,0)
 
"BLD",17,1,3,0)
NOIS: ISF-0195-60010      Routine: ^XMAH0
"BLD",17,1,4,0)
Message range will no longer delete when user times out answering question,
"BLD",17,1,5,0)
"Are you sure?"
"BLD",17,1,6,0)

"BLD",17,1,7,0)
NOIS: PHO-0896-61825      Routine: ^XMA21A
"BLD",17,1,8,0)
Domain names starting with a number are valid and will no longer be rejected.
"BLD",17,1,9,0)

"BLD",17,1,10,0)
NOIS: NOL-0896-70074      Routine: ^XMAD1A
"BLD",17,1,11,0)
Ensures that recipient multiple records start from 1.
"BLD",17,1,12,0)

"BLD",17,1,13,0)
E3R: 7039,8898            Routine: ^XMA21A,^XMA21G
"BLD",17,1,14,0)
Users holding new security key "XM GROUP PRIORITY" may forward priority
"BLD",17,1,15,0)
mail to groups.
"BLD",17,1,16,0)

"BLD",17,1,17,0)
NOIS: PIH-0496-21979      Routine: ^XMA21A
"BLD",17,1,18,0)
If NETWORK - MAX LINES @ SEND TO field is null in the KERNEL SITE PARAMETERS
"BLD",17,1,19,0)
file, the default maximum message lines is no longer 2000 - it is unlimited. 
"BLD",17,1,20,0)

"BLD",17,1,21,0)
In connection with this, I am passing on a request from Brenda Bishop (via Hal
"BLD",17,1,22,0)
Whitley) @ ISC-BIRM.VA.GOV to all sites running CMOP (the Consolidated Mail
"BLD",17,1,23,0)
Outpatient Pharmacy Package): 
"BLD",17,1,24,0)
 
"BLD",17,1,25,0)
"Sites using the Consolidated Mail Outpatient Pharmacy (CMOP) package are
"BLD",17,1,26,0)
advised to set the Kernel site parameter field [NETWORK - MAX LINES @
"BLD",17,1,27,0)
SEND TO] field to Null (without value)."
"BLD",17,1,28,0)

"BLD",17,1,29,0)
NOIS: TUC-0395-60417      Routine: ^XMA7G
"BLD",17,1,30,0)
                          DD: file 3.8, field .01 - add "LAYGO" node
"BLD",17,1,31,0)
Prevents users from adding a private mail group with the same name as a
"BLD",17,1,32,0)
public one.
"BLD",17,1,33,0)

"BLD",17,1,34,0)
NOIS: SPO-0595-50655      Routine: ^XMYPOST6
"BLD",17,1,35,0)
                          DD:  file 3.8, field .01 - remove identifier node
"BLD",17,1,36,0)
Removes the identifier (Coordinator field) from the .01 field of the Mail
"BLD",17,1,37,0)
Group file.  (DBIA #1622)
"BLD",17,1,38,0)

"BLD",17,1,39,0)
NOIS: None                Routine: ^XMYPOST6
"BLD",17,1,40,0)
                          DD:  file 3.7, field 2   - add a cross reference
"BLD",17,1,41,0)
Add a new cross reference (F) on the FORWARDING ADDRESS field of the MAIL BOX
"BLD",17,1,42,0)
file.  This enables the site manager to easily find and remedy bad forwarding
"BLD",17,1,43,0)
addresses.
"BLD",17,1,44,0)

"BLD",17,1,45,0)
NOIS: SBY-0695-30284      Routine: ^XMAP
"BLD",17,1,46,0)
If the user's institution field is set to null, '()' will no longer appear
"BLD",17,1,47,0)
after the user's name when showing institutions on mail messages.
"BLD",17,1,48,0)
 
"BLD",17,1,49,0)
NOIS: ATG-0495-30025      Routine: ^XMA0
"BLD",17,1,50,0)
If you save a group of messages to a new mailbox, the zero node of the
"BLD",17,1,51,0)
message multiple will be created.  Previously, it hadn't been.
"BLD",17,1,52,0)

"BLD",17,1,53,0)
NOIS: DAY-1096-41348      Routine: ^XMA1
"BLD",17,1,54,0)
If '^' is contained in the response to 'Select message action' prompt,
"BLD",17,1,55,0)
MM will up-arrow out.
"BLD",17,1,56,0)

"BLD",17,1,57,0)
NOIS: None                Routine: ^XMA5A,^XMAI2,^XMAPHOST,^XMUT5G
"BLD",17,1,58,0)
Remove references to the old user file:  ^DIC(3
"BLD",17,1,59,0)

"BLD",17,1,60,0)
NOIS: SDC-1296-61151      Routine: ^XMA0,^XMA1
"BLD",17,1,61,0)
Correct MailMan's response if the user chooses not to proceed with message
"BLD",17,1,62,0)
termination.
"BLD",17,1,63,0)

"BLD",17,1,64,0)
NOIS: None                Routine: ^XMA21G
"BLD",17,1,65,0)
Reference mail message #22778858 on FORUM from Milt Roberson.  MM aborted
"BLD",17,1,66,0)
when trying to expand a group which included a remote member at a numeric
"BLD",17,1,67,0)
address at compuserve.com.  This fixes that.
"BLD",17,1,68,0)

"BLD",17,1,69,0)
NOIS: BRX-0197-10241      Routine: ^XMA0,^XMA01
"BLD",17,1,70,0)
At the <save,delete,terminate,print> "which messages" prompt, if the user's
"BLD",17,1,71,0)
answer includes ^, then the function is aborted.
"BLD",17,1,72,0)

"BLD",17,1,73,0)
E3R: 9311                 Routine: ^XMA7G
"BLD",17,1,74,0)
Users enrolled in a mail group which does not allow self-enrollment can no
"BLD",17,1,75,0)
longer disenroll themselves.
"BLD",17,1,76,0)

"BLD",17,1,77,0)
NOIS: None                Routine: ^XMR1A
"BLD",17,1,78,0)
Prevent subscript in global reference from being more than 64 characters long.
"BLD",17,1,79,0)
Reference FORUM msg #23054338.
"BLD",17,1,80,0)

"BLD",17,1,81,0)
NOIS: MEM-0197-70649      Routine: ^XMBGRP
"BLD",17,1,82,0)
Routine no longer attempts to write to the screen during 'silent' calls.
"BLD",17,1,83,0)
Documentation corrected.  Parameter 'D' in call to function $$MG^XMBGRP,
"BLD",17,1,84,0)
if set to 0 will not allow self-enrollment in a group; 1 will allow.
"BLD",17,1,85,0)

"BLD",17,1,86,0)
Replace the description of $$MG^XMBGRP on page 31 of the Programmer Reference
"BLD",17,1,87,0)
Manual with the following: 
"BLD",17,1,88,0)

"BLD",17,1,89,0)
============================================================================
"BLD",17,1,90,0)
$$MG^XMBGRP
"BLD",17,1,91,0)

"BLD",17,1,92,0)
This extrinsic function is used to create a new mail group or to add members
"BLD",17,1,93,0)
to an existing mail group.  Only local users may be enrolled as members with
"BLD",17,1,94,0)
this function.
"BLD",17,1,95,0)

"BLD",17,1,96,0)
Usage:  S X=$$MG^XMBGRP(A,B,C,D,.E,.F,G)
"BLD",17,1,97,0)

"BLD",17,1,98,0)
(B,C,D,.F are ignored if the mail group previously exists.)
"BLD",17,1,99,0)

"BLD",17,1,100,0)
If successful, X will have the value of the mail group internal entry number.
"BLD",17,1,101,0)
If unsuccessful, X will be zero.
"BLD",17,1,102,0)

"BLD",17,1,103,0)
Where:
"BLD",17,1,104,0)

"BLD",17,1,105,0)
A =Mail group name (if new group)
"BLD",17,1,106,0)
   Mail group internal entry number (if existing group)
"BLD",17,1,107,0)
B =Mail group type flag (0=public; 1=private)
"BLD",17,1,108,0)
C =DUZ of organizer (.5=Postmaster assumed, if 0 passed)
"BLD",17,1,109,0)
D =Self enrollment allowed flag (0=no; 1=yes)
"BLD",17,1,110,0)
.E=Array of members to be enrolled.
"BLD",17,1,111,0)
   Members must be local users.
"BLD",17,1,112,0)
   Array must consist of DUZ's only; not names.
"BLD",17,1,113,0)
   E(n)="", where n is the member's DUZ.
"BLD",17,1,114,0)
.F=Mail group description array.
"BLD",17,1,115,0)
   F(1)="first line"
"BLD",17,1,116,0)
   F(2)="second line"
"BLD",17,1,117,0)
   etc.
"BLD",17,1,118,0)
G =Silent flag (0=interactive; 1=silent)
"BLD",17,1,119,0)
============================================================================
"BLD",17,1,120,0)

"BLD",17,1,121,0)
NOIS: none
"BLD",17,1,122,0)
Reference message #23076068 on FORUM from Skip Williams.  Correct the
"BLD",17,1,123,0)
documentation on page 46 of the 'Programmer Reference Manual'.
"BLD",17,1,124,0)
In the Example, Step 3 -- Deliver Message to Recipients, the last line of
"BLD",17,1,125,0)
code should be:
"BLD",17,1,126,0)

"BLD",17,1,127,0)
        D ENT1^XMD ; Call for MailMan Delivery
"BLD",17,1,128,0)

"BLD",17,1,129,0)
NOIS: none                Routines: ^XMA21G,^XMA7G,^XMAD1,
"BLD",17,1,130,0)
                                    ^XMAD1A,^XMA5A,^XMFAX
"BLD",17,1,131,0)
                          DD:  file 3.8, field 14 (new)
"BLD",17,1,132,0)
                               file 3.8, field 15 (new)
"BLD",17,1,133,0)
                               file 3.9, (within Recipient multiple)
"BLD",17,1,134,0)
                                         field 13 (new)
"BLD",17,1,135,0)
                               file 3.9, (within Recipient multiple)
"BLD",17,1,136,0)
                                         field 14 (new)
"BLD",17,1,137,0)
                               file 4.3, field 143 (new)
"BLD",17,1,138,0)

"BLD",17,1,139,0)
MailMan, with this patch, is now able to fax messages.  Currently, only FORUM
"BLD",17,1,140,0)
(to my knowledge) is able to take advantage of this new capability, which
"BLD",17,1,141,0)
requires the presence of the AKF* suite of fax software and files and fax
"BLD",17,1,142,0)
capability.  The site manager should indicate whether or not the site is
"BLD",17,1,143,0)
fax-enabled by setting the new field #143 in file 4.3 (default is "no"). 
"BLD",17,1,144,0)

"BLD",17,1,145,0)
Two new mail group multiples have been added to the Mail Group file:  Fax
"BLD",17,1,146,0)
Recipient, and Fax Group.  These multiples point to associated files in the fax
"BLD",17,1,147,0)
(AKF*) suite.  These files (^AKF("FAXR", Fax Rolodex, and ^AKF("FAXG", Fax
"BLD",17,1,148,0)
Group) must be populated through the fax suite.  LAYGO through MailMan is not
"BLD",17,1,149,0)
permitted. 
"BLD",17,1,150,0)

"BLD",17,1,151,0)
When a mail message is sent (or forwarded) to a mail group with these fax
"BLD",17,1,152,0)
multiples populated, the message is also transferred to the fax suite, and a
"BLD",17,1,153,0)
task is queued to fax the message to those recipients pointed to by the group. 
"BLD",17,1,154,0)

"BLD",17,1,155,0)
Fax recipients are faxed only the original message.  Replies to mail messages
"BLD",17,1,156,0)
are not faxed. Replies are not delivered as e-mail to fax recipients, unless
"BLD",17,1,157,0)
they are also on the message as "normal" recipients. 
"BLD",17,1,158,0)

"BLD",17,1,159,0)
MailMan faxes do not have a cover page.  They print in much the same way as a
"BLD",17,1,160,0)
message is printed on a printer. 
"BLD",17,1,161,0)

"BLD",17,1,162,0)
Individual fax recipients are stored in the recipient multiple of the message
"BLD",17,1,163,0)
(identified as F.<fax recipient>).  A "Query" of the message will reveal that
"BLD",17,1,164,0)
the message was sent to the Mail Group.  A "Query Detail" will reveal fax
"BLD",17,1,165,0)
recipients, when the message was transferred to the fax suite, and the fax ID
"BLD",17,1,166,0)
assigned to it by the fax suite, but will not reveal the transmission status. 
"BLD",17,1,167,0)
(The user can ascertain the transmission status via the fax suite and the fax
"BLD",17,1,168,0)
ID.) 
"BLD",17,1,169,0)

"BLD",17,1,170,0)
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
"BLD",17,1,171,0)
NOT INCLUDED in this patch is:
"BLD",17,1,172,0)
1) a necessary change to ^AKFAX to enable it to
"BLD",17,1,173,0)
recognize a MailMan Fax so that it can suppress the cover page for MailMan
"BLD",17,1,174,0)
faxes and address the fax to the recipient ("MailMan Fax for ... ").
"BLD",17,1,175,0)
2) a new field in file #589500 - ^AKF("FAX", FAX TRANSMISSION FILE
"BLD",17,1,176,0)
589500,3    MAILMAN FAX       0;4 SET OF CODES
"BLD",17,1,177,0)
                              '0' FOR NO;
"BLD",17,1,178,0)
                              '1' FOR YES;
"BLD",17,1,179,0)
            HELP-PROMPT:      Is this a MailMan-generated fax?
"BLD",17,1,180,0)
            DESCRIPTION:      Routine ^AKFAX checks this field to see if the
"BLD",17,1,181,0)
                              fax is a MailMan generated fax.  If it is, then
"BLD",17,1,182,0)
                              1) the fax cover sheet is suppressed and
"BLD",17,1,183,0)
                              2) two additional lines are added to the top of
"BLD",17,1,184,0)
                              the fax, identifying the recipient and the fax ID.
"BLD",17,1,185,0)
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
"BLD",17,1,186,0)

"BLD",17,1,187,0)
Following are DD extracts of the new fields:
"BLD",17,1,188,0)

"BLD",17,1,189,0)
STANDARD DATA DICTIONARY #4.3 -- KERNEL SITE PARAMETERS FILE STORED IN ^XMB(1,
"BLD",17,1,190,0)

"BLD",17,1,191,0)
4.3,143     FAX ENABLED       0;19 SET OF CODES
"BLD",17,1,192,0)
                              '0' FOR no; 
"BLD",17,1,193,0)
                              '1' FOR yes; 
"BLD",17,1,194,0)
            HELP-PROMPT:      Is your site fax enabled? 
"BLD",17,1,195,0)
            DESCRIPTION:      Your site is fax enabled if you have the suite
"BLD",17,1,196,0)
                              of fax software and files (^AKF) and fax
"BLD",17,1,197,0)
                              capability and you choose to allow faxes to be
"BLD",17,1,198,0)
                              sent via MailMan.  
"BLD",17,1,199,0)
                              To send faxes via MailMan, Mail groups (file
"BLD",17,1,200,0)
                              3.8) must first be populated in the fax
"BLD",17,1,201,0)
                              recipient and fax group multiples.  Then, when
"BLD",17,1,202,0)
                              a user sends a message to a mail group, the
"BLD",17,1,203,0)
                              message is also faxed to any fax recipients in
"BLD",17,1,204,0)
                              that mail group.
"BLD",17,1,205,0)
                              Responses to the message are not faxed.
"BLD",17,1,206,0)
 
"BLD",17,1,207,0)
STANDARD DATA DICTIONARY #3.8 -- MAIL GROUP FILE          STORED IN ^XMB(3.8, 
"BLD",17,1,208,0)

"BLD",17,1,209,0)
3.8,14      FAX RECIPIENT     8;0 POINTER Multiple #3.814
"BLD",17,1,210,0)
3.814,.01     FAX RECIPIENT     0;1 POINTER TO FAX ROLODEX FILE (#589499)
"BLD",17,1,211,0)
                                 (Multiply asked)
"BLD",17,1,212,0)
              HELP-PROMPT:      Enter the fax recipient who should receive 
"BLD",17,1,213,0)
                                faxes sent to this mail group. 
"BLD",17,1,214,0)
              DESCRIPTION:      This is a list of individual recipients who
"BLD",17,1,215,0)
                                will receive by fax any mail sent to this
"BLD",17,1,216,0)
                                mail group.  They receive the original
"BLD",17,1,217,0)
                                message only.  They do not receive responses.
"BLD",17,1,218,0)
              CROSS-REFERENCE:  3.814^B 
"BLD",17,1,219,0)
                                1)= S ^XMB(3.8,DA(1),8,"B",$E(X,1,30),DA)=""
"BLD",17,1,220,0)
                                2)= K ^XMB(3.8,DA(1),8,"B",$E(X,1,30),DA)
"BLD",17,1,221,0)

"BLD",17,1,222,0)
3.8,15      FAX GROUP           9;0 POINTER Multiple #3.815
"BLD",17,1,223,0)
3.815,.01     FAX GROUP           0;1 POINTER TO FAX GROUP FILE (#589498)
"BLD",17,1,224,0)
                                 (Multiply asked)
"BLD",17,1,225,0)
              INPUT TRANSFORM:  S DIC("S")="N XM S XM=$G(^(3)) I $P(XM,U,2)!(
"BLD",17,1,226,0)
                                $G(XMDUZ,DUZ)=+XM)" D ^DIC K DIC S DIC=DIE,X=
"BLD",17,1,227,0)
                                +Y K:Y<0 X
"BLD",17,1,228,0)
              HELP-PROMPT:      Enter the fax group which should receive 
"BLD",17,1,229,0)
                                faxes sent to this mail group. 
"BLD",17,1,230,0)
              DESCRIPTION:      Each member of the fax group will receive by
"BLD",17,1,231,0)
                                fax any message sent to this mail group. 
"BLD",17,1,232,0)
                                Only the original message will be faxed. 
"BLD",17,1,233,0)
                                Responses will not be faxed.  
"BLD",17,1,234,0)
              SCREEN:           S DIC("S")="N XM S XM=$G(^(3))
"BLD",17,1,235,0)
                                           I $P(XM,U,2)!($G(XMDUZ,DUZ)=+XM)"
"BLD",17,1,236,0)
              EXPLANATION:      Group must be public or user must be
"BLD",17,1,237,0)
                                (surrogate of) creator of group.
"BLD",17,1,238,0)
              CROSS-REFERENCE:  3.815^B 
"BLD",17,1,239,0)
                                1)= S ^XMB(3.8,DA(1),9,"B",$E(X,1,30),DA)=""
"BLD",17,1,240,0)
                                2)= K ^XMB(3.8,DA(1),9,"B",$E(X,1,30),DA)
"BLD",17,1,241,0)

"BLD",17,1,242,0)
STANDARD DATA DICTIONARY #3.9 -- MESSAGE FILE     STORED IN ^XMB(3.9,
"BLD",17,1,243,0)

"BLD",17,1,244,0)
3.91,13   FAX RECIPIENT         0;11 POINTER TO FAX ROLODEX FILE (#589499)
"BLD",17,1,245,0)
              HELP-PROMPT:      Enter the fax recipient 
"BLD",17,1,246,0)
              DESCRIPTION:      When the message is addressed to a fax
"BLD",17,1,247,0)
                                recipient, this field points to the fax
"BLD",17,1,248,0)
                                rolodex file.  After the message is handed
"BLD",17,1,249,0)
                                off to the fax software, the pointer in this
"BLD",17,1,250,0)
                                field is deleted, the STATUS field is deleted,
"BLD",17,1,251,0)
                                and the FAX ID field is set to the fax ID
"BLD",17,1,252,0)
                                number assigned to it by the fax software.
"BLD",17,1,253,0)
              CROSS-REFERENCE:  3.91^AFAX 
"BLD",17,1,254,0)
                                1)= S ^XMB(3.9,DA(1),1,"AFAX",$E(X,1,30),DA)=""
"BLD",17,1,255,0)
                                2)= K ^XMB(3.9,DA(1),1,"AFAX",$E(X,1,30),DA)
"BLD",17,1,256,0)
                                This cross reference makes it possible for
"BLD",17,1,257,0)
                                MailMan to immediately find the recipients
"BLD",17,1,258,0)
                                to fax a message to.
"BLD",17,1,259,0)

"BLD",17,1,260,0)
3.91,14   FAX ID                0;12 FREE TEXT (1-14 CHARS)
"BLD",17,1,261,0)
              HELP-PROMPT:      Enter the fax ID
"BLD",17,1,262,0)
              DESCRIPTION:      This is the fax ID as assigned to it by the
"BLD",17,1,263,0)
                                fax software (^AKF*).
"BLD",17,1,264,0)

"BLD",17,1,265,0)
===========================================================================
"BLD",17,1,266,0)

"BLD",17,1,267,0)
 This patch should be installed after hours, when user activity is at a
"BLD",17,1,268,0)
 minimum.  You should put the XMUSER Option out of order and shut down
"BLD",17,1,269,0)
 mail delivery tasks.  A cross reference ("F", on FORWARDING ADDRESS) is
"BLD",17,1,270,0)
 being added to the MAIL BOX file, and a lock must be placed on the whole
"BLD",17,1,271,0)
 global for the duration of the indexing.  If the lock cannot be obtained,
"BLD",17,1,272,0)
 the indexing of the new cross reference will not run.  If the indexing does
"BLD",17,1,273,0)
 not run, you can do it later by running ^XMYPOST6 yourself.  ^XMYPOST6
"BLD",17,1,274,0)
 will take about 1 minute per 2500 users in the ^XMB(3.7 global.
"BLD",17,1,275,0)
===========================================================================
"BLD",17,1,276,0)
 
"BLD",17,1,277,0)
INSTALLATION:
"BLD",17,1,278,0)
  1.  This routine is usually mapped on systems that allow mapping,
"BLD",17,1,279,0)
      so you will need to disable mapping for the effected routine.
"BLD",17,1,280,0)
  2.  Use the 'INSTALL/CHECK MESSAGE' option on the PackMan menu. This
"BLD",17,1,281,0)
      option will load the KIDS package onto your system.
"BLD",17,1,282,0)
  3.  The patch has now been loaded into a Transport global on your
"BLD",17,1,283,0)
      system. You now need to use KIDS to install the Transport global.
"BLD",17,1,284,0)
  4.  On the KIDS menu, under the 'Installation' menu, use the following
"BLD",17,1,285,0)
      options:
"BLD",17,1,286,0)
         Print Transport Global
"BLD",17,1,287,0)
         Compare Transport Global to Current System
"BLD",17,1,288,0)
         Verify Checksums in Transport Global
"BLD",17,1,289,0)
         Backup a Transport Global
"BLD",17,1,290,0)
         Install Package(s)
"BLD",17,1,291,0)
  5.  MSM Sites - Answer YES to the question 'Want to MOVE routines to
"BLD",17,1,292,0)
      other CPUs?'. Enter the names of your Compute and Print server(s).
"BLD",17,1,293,0)
  6.  AXP Sites, after patch has installed, rebuild your map set.
"BLD",17,1,294,0)
============================================================================ 
"BLD",17,1,295,0)
  
"BLD",17,1,296,0)
 ROUTINES:
"BLD",17,1,297,0)
   The second line of the routine now looks like:
"BLD",17,1,298,0)
       ;;7.1;MailMan;**[patch list]**;Jun 02, 1994
"BLD",17,1,299,0)
 
"BLD",17,1,300,0)
                Before          After
"BLD",17,1,301,0)
 Name          Checksum       Checksum          Patch List
"BLD",17,1,302,0)
 ----------------------------------------------------------
"BLD",17,1,303,0)
 
"BLD",17,1,304,0)
 XMA0           9701230       10480365          15,36
"BLD",17,1,305,0)
 XMA01          2756871        2847569          36
"BLD",17,1,306,0)
 XMA1           9575986        9580091          31,36
"BLD",17,1,307,0)
 XMA21A         8186870        7475211          4,30,36
"BLD",17,1,308,0)
 XMA21G         9710102       11073971          31,36
"BLD",17,1,309,0)
 XMA5A         14213526       13683319          31,36
"BLD",17,1,310,0)
 XMA7G          5426292        5211523          36
"BLD",17,1,311,0)
 XMAD1          7205963        7275936          24,27,36
"BLD",17,1,312,0)
 XMAD1A         5656044        6312375          36
"BLD",17,1,313,0)
 XMAH0          1594203        1761641          36
"BLD",17,1,314,0)
 XMAI2          1646281        1510945          36
"BLD",17,1,315,0)
 XMAP           8812311        8826127          24,36
"BLD",17,1,316,0)
 XMAPHOST       6366459        6157206          7,14,27,36
"BLD",17,1,317,0)
 XMBGRP         5496318        5680054          13,36
"BLD",17,1,318,0)
 XMFAX          **new**        4957190          36
"BLD",17,1,319,0)
 XMR1A          6956680        6979581          13,36
"BLD",17,1,320,0)
 XMUT5G          380003         338629          36
"BLD",17,1,321,0)
 XMYPOST6       **new**          11500          36
"BLD",17,1,322,0)

"BLD",17,1,323,0)
============================================================================
"BLD",17,4,0)
^9.64PA^3.7^4
"BLD",17,4,3.7,0)
3.7
"BLD",17,4,3.7,2,0)
^9.641^3.7^1
"BLD",17,4,3.7,2,3.7,0)
MAIL BOX  (File-top level)
"BLD",17,4,3.7,2,3.7,1,0)
^9.6411^2^1
"BLD",17,4,3.7,2,3.7,1,2,0)
FORWARDING ADDRESS
"BLD",17,4,3.7,222)
y^y^p^^^^n
"BLD",17,4,3.8,0)
3.8
"BLD",17,4,3.8,2,0)
^9.641^3.815^3
"BLD",17,4,3.8,2,3.8,0)
MAIL GROUP  (File-top level)
"BLD",17,4,3.8,2,3.8,1,0)
^9.6411^.01^1
"BLD",17,4,3.8,2,3.8,1,.01,0)
NAME
"BLD",17,4,3.8,2,3.814,0)
FAX RECIPIENT  (sub-file)
"BLD",17,4,3.8,2,3.814,1,0)
^9.6411^^
"BLD",17,4,3.8,2,3.815,0)
FAX GROUP  (sub-file)
"BLD",17,4,3.8,2,3.815,1,0)
^9.6411^^
"BLD",17,4,3.8,222)
y^y^p^^^^n
"BLD",17,4,3.9,0)
3.9
"BLD",17,4,3.9,2,0)
^9.641^3.91^1
"BLD",17,4,3.9,2,3.91,0)
RECIPIENT  (sub-file)
"BLD",17,4,3.9,2,3.91,1,0)
^9.6411^14^2
"BLD",17,4,3.9,2,3.91,1,13,0)
FAX RECIPIENT
"BLD",17,4,3.9,2,3.91,1,14,0)
FAX ID
"BLD",17,4,3.9,222)
y^y^p^^^^n
"BLD",17,4,4.3,0)
4.3
"BLD",17,4,4.3,2,0)
^9.641^4.3^1
"BLD",17,4,4.3,2,4.3,0)
KERNEL SITE PARAMETERS  (File-top level)
"BLD",17,4,4.3,2,4.3,1,0)
^9.6411^143^1
"BLD",17,4,4.3,2,4.3,1,143,0)
FAX ENABLED
"BLD",17,4,4.3,222)
y^y^p^^^^n
"BLD",17,4,"APDD",3.7,3.7)

"BLD",17,4,"APDD",3.7,3.7,2)

"BLD",17,4,"APDD",3.8,3.8)

"BLD",17,4,"APDD",3.8,3.8,.01)

"BLD",17,4,"APDD",3.8,3.814)

"BLD",17,4,"APDD",3.8,3.815)

"BLD",17,4,"APDD",3.9,3.91)

"BLD",17,4,"APDD",3.9,3.91,13)

"BLD",17,4,"APDD",3.9,3.91,14)

"BLD",17,4,"APDD",4.3,4.3)

"BLD",17,4,"APDD",4.3,4.3,143)

"BLD",17,4,"B",3.7,3.7)

"BLD",17,4,"B",3.8,3.8)

"BLD",17,4,"B",3.9,3.9)

"BLD",17,4,"B",4.3,4.3)

"BLD",17,"INIT")
XMYPOST6
"BLD",17,"KRN",0)
^9.67PA^19^12
"BLD",17,"KRN",.4,0)
.4
"BLD",17,"KRN",.4,"NM",0)
^9.68A^^
"BLD",17,"KRN",.401,0)
.401
"BLD",17,"KRN",.402,0)
.402
"BLD",17,"KRN",.403,0)
.403
"BLD",17,"KRN",.5,0)
.5
"BLD",17,"KRN",.84,0)
.84
"BLD",17,"KRN",3.6,0)
3.6
"BLD",17,"KRN",3.8,0)
3.8
"BLD",17,"KRN",9.2,0)
9.2
"BLD",17,"KRN",9.8,0)
9.8
"BLD",17,"KRN",9.8,"NM",0)
^9.68A^23^18
"BLD",17,"KRN",9.8,"NM",3,0)
XMA21A^^0^B15728817
"BLD",17,"KRN",9.8,"NM",7,0)
XMAH0^^0^B1959040
"BLD",17,"KRN",9.8,"NM",8,0)
XMAD1A^^0^B9156631
"BLD",17,"KRN",9.8,"NM",9,0)
XMA21G^^0^B25426832
"BLD",17,"KRN",9.8,"NM",10,0)
XMYPOST6^^0^B151824
"BLD",17,"KRN",9.8,"NM",11,0)
XMAP^^0^B19073795
"BLD",17,"KRN",9.8,"NM",12,0)
XMA0^^0^B24196407
"BLD",17,"KRN",9.8,"NM",13,0)
XMA1^^0^B19851320
"BLD",17,"KRN",9.8,"NM",14,0)
XMA7G^^0^B8921656
"BLD",17,"KRN",9.8,"NM",15,0)
XMA5A^^0^B20578234
"BLD",17,"KRN",9.8,"NM",16,0)
XMAI2^^0^B2260662
"BLD",17,"KRN",9.8,"NM",17,0)
XMAPHOST^^0^B12822637
"BLD",17,"KRN",9.8,"NM",18,0)
XMUT5G^^0^B429148
"BLD",17,"KRN",9.8,"NM",19,0)
XMBGRP^^0^B17544691
"BLD",17,"KRN",9.8,"NM",20,0)
XMA01^^0^B4007953
"BLD",17,"KRN",9.8,"NM",21,0)
XMAD1^^0^B11559477
"BLD",17,"KRN",9.8,"NM",22,0)
XMFAX^^0^B12272643
"BLD",17,"KRN",9.8,"NM",23,0)
XMR1A^^0^B12264071
"BLD",17,"KRN",9.8,"NM","B","XMA0",12)

"BLD",17,"KRN",9.8,"NM","B","XMA01",20)

"BLD",17,"KRN",9.8,"NM","B","XMA1",13)

"BLD",17,"KRN",9.8,"NM","B","XMA21A",3)

"BLD",17,"KRN",9.8,"NM","B","XMA21G",9)

"BLD",17,"KRN",9.8,"NM","B","XMA5A",15)

"BLD",17,"KRN",9.8,"NM","B","XMA7G",14)

"BLD",17,"KRN",9.8,"NM","B","XMAD1",21)

"BLD",17,"KRN",9.8,"NM","B","XMAD1A",8)

"BLD",17,"KRN",9.8,"NM","B","XMAH0",7)

"BLD",17,"KRN",9.8,"NM","B","XMAI2",16)

"BLD",17,"KRN",9.8,"NM","B","XMAP",11)

"BLD",17,"KRN",9.8,"NM","B","XMAPHOST",17)

"BLD",17,"KRN",9.8,"NM","B","XMBGRP",19)

"BLD",17,"KRN",9.8,"NM","B","XMFAX",22)

"BLD",17,"KRN",9.8,"NM","B","XMR1A",23)

"BLD",17,"KRN",9.8,"NM","B","XMUT5G",18)

"BLD",17,"KRN",9.8,"NM","B","XMYPOST6",10)

"BLD",17,"KRN",19,0)
19
"BLD",17,"KRN",19,"NM",0)
^9.68A^^
"BLD",17,"KRN",19.1,0)
19.1
"BLD",17,"KRN",19.1,"NM",0)
^9.68A^1^1
"BLD",17,"KRN",19.1,"NM",1,0)
XM GROUP PRIORITY^^0
"BLD",17,"KRN",19.1,"NM","B","XM GROUP PRIORITY",1)

"BLD",17,"KRN","B",.4,.4)

"BLD",17,"KRN","B",.401,.401)

"BLD",17,"KRN","B",.402,.402)

"BLD",17,"KRN","B",.403,.403)

"BLD",17,"KRN","B",.5,.5)

"BLD",17,"KRN","B",.84,.84)

"BLD",17,"KRN","B",3.6,3.6)

"BLD",17,"KRN","B",3.8,3.8)

"BLD",17,"KRN","B",9.2,9.2)

"BLD",17,"KRN","B",9.8,9.8)

"BLD",17,"KRN","B",19,19)

"BLD",17,"KRN","B",19.1,19.1)

"BLD",17,"QUES",0)
^9.62^^
"BLD",17,"REQB",0)
^9.611^^
"FIA",3.7)
MAIL BOX
"FIA",3.7,0)
^XMB(3.7,
"FIA",3.7,0,0)
3.7P
"FIA",3.7,0,1)
y^y^p^^^^n
"FIA",3.7,0,10)

"FIA",3.7,0,11)

"FIA",3.7,0,"RLRO")

"FIA",3.7,0,"VR")
7.1^XM
"FIA",3.7,3.7)
1
"FIA",3.7,3.7,2)

"FIA",3.8)
MAIL GROUP
"FIA",3.8,0)
^XMB(3.8,
"FIA",3.8,0,0)
3.8
"FIA",3.8,0,1)
y^y^p^^^^n
"FIA",3.8,0,10)

"FIA",3.8,0,11)

"FIA",3.8,0,"RLRO")

"FIA",3.8,0,"VR")
7.1^XM
"FIA",3.8,3.8)
1
"FIA",3.8,3.8,.01)

"FIA",3.8,3.8,14)

"FIA",3.8,3.8,15)

"FIA",3.8,3.814)
0
"FIA",3.8,3.815)
0
"FIA",3.9)
MESSAGE
"FIA",3.9,0)
^XMB(3.9,
"FIA",3.9,0,0)
3.9s
"FIA",3.9,0,1)
y^y^p^^^^n
"FIA",3.9,0,10)

"FIA",3.9,0,11)

"FIA",3.9,0,"RLRO")

"FIA",3.9,0,"VR")
7.1^XM
"FIA",3.9,3.9)
1
"FIA",3.9,3.91)
1
"FIA",3.9,3.91,13)

"FIA",3.9,3.91,14)

"FIA",4.3)
KERNEL SITE PARAMETERS
"FIA",4.3,0)
^XMB(1,
"FIA",4.3,0,0)
4.3P
"FIA",4.3,0,1)
y^y^p^^^^n
"FIA",4.3,0,10)

"FIA",4.3,0,11)

"FIA",4.3,0,"RLRO")

"FIA",4.3,0,"VR")
7.1^XM
"FIA",4.3,4.3)
1
"FIA",4.3,4.3,143)

"INIT")
XMYPOST6
"KRN",19.1,24,-1)
0^1
"KRN",19.1,24,0)
XM GROUP PRIORITY^Forward priority mail to group^^n
"KRN",19.1,24,1,0)
^^2^2^2961022^
"KRN",19.1,24,1,1,0)
The holder of this key may forward priority mail to groups.  Without this key,
"KRN",19.1,24,1,2,0)
only the sender of a priority message may forward it to groups. 
"ORD",3,19.1)
19.1;3;1;;KEY^XPDTA1;;;;;KEYDEL^XPDIA1
"ORD",3,19.1,0)
SECURITY KEY
"PKG",6,-1)
1^1
"PKG",6,0)
MAILMAN^XM^Electronic Mail, both local and networked
"PKG",6,22,0)
^9.49I^1^1
"PKG",6,22,1,0)
7.1^2940602^2950925
"PKG",6,22,1,"PAH",1,0)
36^2970224
"PKG",6,22,1,"PAH",1,1,0)
^^323^323^2970224
"PKG",6,22,1,"PAH",1,1,1,0)
MailMan patch XM*7.1*36 contains the following enhancements and bug fixes:
"PKG",6,22,1,"PAH",1,1,2,0)
 
"PKG",6,22,1,"PAH",1,1,3,0)
NOIS: ISF-0195-60010      Routine: ^XMAH0
"PKG",6,22,1,"PAH",1,1,4,0)
Message range will no longer delete when user times out answering question,
"PKG",6,22,1,"PAH",1,1,5,0)
"Are you sure?"
"PKG",6,22,1,"PAH",1,1,6,0)

"PKG",6,22,1,"PAH",1,1,7,0)
NOIS: PHO-0896-61825      Routine: ^XMA21A
"PKG",6,22,1,"PAH",1,1,8,0)
Domain names starting with a number are valid and will no longer be rejected.
"PKG",6,22,1,"PAH",1,1,9,0)

"PKG",6,22,1,"PAH",1,1,10,0)
NOIS: NOL-0896-70074      Routine: ^XMAD1A
"PKG",6,22,1,"PAH",1,1,11,0)
Ensures that recipient multiple records start from 1.
"PKG",6,22,1,"PAH",1,1,12,0)

"PKG",6,22,1,"PAH",1,1,13,0)
E3R: 7039,8898            Routine: ^XMA21A,^XMA21G
"PKG",6,22,1,"PAH",1,1,14,0)
Users holding new security key "XM GROUP PRIORITY" may forward priority
"PKG",6,22,1,"PAH",1,1,15,0)
mail to groups.
"PKG",6,22,1,"PAH",1,1,16,0)

"PKG",6,22,1,"PAH",1,1,17,0)
NOIS: PIH-0496-21979      Routine: ^XMA21A
"PKG",6,22,1,"PAH",1,1,18,0)
If NETWORK - MAX LINES @ SEND TO field is null in the KERNEL SITE PARAMETERS
"PKG",6,22,1,"PAH",1,1,19,0)
file, the default maximum message lines is no longer 2000 - it is unlimited. 
"PKG",6,22,1,"PAH",1,1,20,0)

"PKG",6,22,1,"PAH",1,1,21,0)
In connection with this, I am passing on a request from Brenda Bishop (via Hal
"PKG",6,22,1,"PAH",1,1,22,0)
Whitley) @ ISC-BIRM.VA.GOV to all sites running CMOP (the Consolidated Mail
"PKG",6,22,1,"PAH",1,1,23,0)
Outpatient Pharmacy Package): 
"PKG",6,22,1,"PAH",1,1,24,0)
 
"PKG",6,22,1,"PAH",1,1,25,0)
"Sites using the Consolidated Mail Outpatient Pharmacy (CMOP) package are
"PKG",6,22,1,"PAH",1,1,26,0)
advised to set the Kernel site parameter field [NETWORK - MAX LINES @
"PKG",6,22,1,"PAH",1,1,27,0)
SEND TO] field to Null (without value)."
"PKG",6,22,1,"PAH",1,1,28,0)

"PKG",6,22,1,"PAH",1,1,29,0)
NOIS: TUC-0395-60417      Routine: ^XMA7G
"PKG",6,22,1,"PAH",1,1,30,0)
                          DD: file 3.8, field .01 - add "LAYGO" node
"PKG",6,22,1,"PAH",1,1,31,0)
Prevents users from adding a private mail group with the same name as a
"PKG",6,22,1,"PAH",1,1,32,0)
public one.
"PKG",6,22,1,"PAH",1,1,33,0)

"PKG",6,22,1,"PAH",1,1,34,0)
NOIS: SPO-0595-50655      Routine: ^XMYPOST6
"PKG",6,22,1,"PAH",1,1,35,0)
                          DD:  file 3.8, field .01 - remove identifier node
"PKG",6,22,1,"PAH",1,1,36,0)
Removes the identifier (Coordinator field) from the .01 field of the Mail
"PKG",6,22,1,"PAH",1,1,37,0)
Group file.  (DBIA #1622)
"PKG",6,22,1,"PAH",1,1,38,0)

"PKG",6,22,1,"PAH",1,1,39,0)
NOIS: None                Routine: ^XMYPOST6
"PKG",6,22,1,"PAH",1,1,40,0)
                          DD:  file 3.7, field 2   - add a cross reference
"PKG",6,22,1,"PAH",1,1,41,0)
Add a new cross reference (F) on the FORWARDING ADDRESS field of the MAIL BOX
"PKG",6,22,1,"PAH",1,1,42,0)
file.  This enables the site manager to easily find and remedy bad forwarding
"PKG",6,22,1,"PAH",1,1,43,0)
addresses.
"PKG",6,22,1,"PAH",1,1,44,0)

"PKG",6,22,1,"PAH",1,1,45,0)
NOIS: SBY-0695-30284      Routine: ^XMAP
"PKG",6,22,1,"PAH",1,1,46,0)
If the user's institution field is set to null, '()' will no longer appear
"PKG",6,22,1,"PAH",1,1,47,0)
after the user's name when showing institutions on mail messages.
"PKG",6,22,1,"PAH",1,1,48,0)
 
"PKG",6,22,1,"PAH",1,1,49,0)
NOIS: ATG-0495-30025      Routine: ^XMA0
"PKG",6,22,1,"PAH",1,1,50,0)
If you save a group of messages to a new mailbox, the zero node of the
"PKG",6,22,1,"PAH",1,1,51,0)
message multiple will be created.  Previously, it hadn't been.
"PKG",6,22,1,"PAH",1,1,52,0)

"PKG",6,22,1,"PAH",1,1,53,0)
NOIS: DAY-1096-41348      Routine: ^XMA1
"PKG",6,22,1,"PAH",1,1,54,0)
If '^' is contained in the response to 'Select message action' prompt,
"PKG",6,22,1,"PAH",1,1,55,0)
MM will up-arrow out.
"PKG",6,22,1,"PAH",1,1,56,0)

"PKG",6,22,1,"PAH",1,1,57,0)
NOIS: None                Routine: ^XMA5A,^XMAI2,^XMAPHOST,^XMUT5G
"PKG",6,22,1,"PAH",1,1,58,0)
Remove references to the old user file:  ^DIC(3
"PKG",6,22,1,"PAH",1,1,59,0)

"PKG",6,22,1,"PAH",1,1,60,0)
NOIS: SDC-1296-61151      Routine: ^XMA0,^XMA1
"PKG",6,22,1,"PAH",1,1,61,0)
Correct MailMan's response if the user chooses not to proceed with message
"PKG",6,22,1,"PAH",1,1,62,0)
termination.
"PKG",6,22,1,"PAH",1,1,63,0)

"PKG",6,22,1,"PAH",1,1,64,0)
NOIS: None                Routine: ^XMA21G
"PKG",6,22,1,"PAH",1,1,65,0)
Reference mail message #22778858 on FORUM from Milt Roberson.  MM aborted
"PKG",6,22,1,"PAH",1,1,66,0)
when trying to expand a group which included a remote member at a numeric
"PKG",6,22,1,"PAH",1,1,67,0)
address at compuserve.com.  This fixes that.
"PKG",6,22,1,"PAH",1,1,68,0)

"PKG",6,22,1,"PAH",1,1,69,0)
NOIS: BRX-0197-10241      Routine: ^XMA0,^XMA01
"PKG",6,22,1,"PAH",1,1,70,0)
At the <save,delete,terminate,print> "which messages" prompt, if the user's
"PKG",6,22,1,"PAH",1,1,71,0)
answer includes ^, then the function is aborted.
"PKG",6,22,1,"PAH",1,1,72,0)

"PKG",6,22,1,"PAH",1,1,73,0)
E3R: 9311                 Routine: ^XMA7G
"PKG",6,22,1,"PAH",1,1,74,0)
Users enrolled in a mail group which does not allow self-enrollment can no
"PKG",6,22,1,"PAH",1,1,75,0)
longer disenroll themselves.
"PKG",6,22,1,"PAH",1,1,76,0)

"PKG",6,22,1,"PAH",1,1,77,0)
NOIS: None                Routine: ^XMR1A
"PKG",6,22,1,"PAH",1,1,78,0)
Prevent subscript in global reference from being more than 64 characters long.
"PKG",6,22,1,"PAH",1,1,79,0)
Reference FORUM msg #23054338.
"PKG",6,22,1,"PAH",1,1,80,0)

"PKG",6,22,1,"PAH",1,1,81,0)
NOIS: MEM-0197-70649      Routine: ^XMBGRP
"PKG",6,22,1,"PAH",1,1,82,0)
Routine no longer attempts to write to the screen during 'silent' calls.
"PKG",6,22,1,"PAH",1,1,83,0)
Documentation corrected.  Parameter 'D' in call to function $$MG^XMBGRP,
"PKG",6,22,1,"PAH",1,1,84,0)
if set to 0 will not allow self-enrollment in a group; 1 will allow.
"PKG",6,22,1,"PAH",1,1,85,0)

"PKG",6,22,1,"PAH",1,1,86,0)
Replace the description of $$MG^XMBGRP on page 31 of the Programmer Reference
"PKG",6,22,1,"PAH",1,1,87,0)
Manual with the following: 
"PKG",6,22,1,"PAH",1,1,88,0)

"PKG",6,22,1,"PAH",1,1,89,0)
============================================================================
"PKG",6,22,1,"PAH",1,1,90,0)
$$MG^XMBGRP
"PKG",6,22,1,"PAH",1,1,91,0)

"PKG",6,22,1,"PAH",1,1,92,0)
This extrinsic function is used to create a new mail group or to add members
"PKG",6,22,1,"PAH",1,1,93,0)
to an existing mail group.  Only local users may be enrolled as members with
"PKG",6,22,1,"PAH",1,1,94,0)
this function.
"PKG",6,22,1,"PAH",1,1,95,0)

"PKG",6,22,1,"PAH",1,1,96,0)
Usage:  S X=$$MG^XMBGRP(A,B,C,D,.E,.F,G)
"PKG",6,22,1,"PAH",1,1,97,0)

"PKG",6,22,1,"PAH",1,1,98,0)
(B,C,D,.F are ignored if the mail group previously exists.)
"PKG",6,22,1,"PAH",1,1,99,0)

"PKG",6,22,1,"PAH",1,1,100,0)
If successful, X will have the value of the mail group internal entry number.
"PKG",6,22,1,"PAH",1,1,101,0)
If unsuccessful, X will be zero.
"PKG",6,22,1,"PAH",1,1,102,0)

"PKG",6,22,1,"PAH",1,1,103,0)
Where:
"PKG",6,22,1,"PAH",1,1,104,0)

"PKG",6,22,1,"PAH",1,1,105,0)
A =Mail group name (if new group)
"PKG",6,22,1,"PAH",1,1,106,0)
   Mail group internal entry number (if existing group)
"PKG",6,22,1,"PAH",1,1,107,0)
B =Mail group type flag (0=public; 1=private)
"PKG",6,22,1,"PAH",1,1,108,0)
C =DUZ of organizer (.5=Postmaster assumed, if 0 passed)
"PKG",6,22,1,"PAH",1,1,109,0)
D =Self enrollment allowed flag (0=no; 1=yes)
"PKG",6,22,1,"PAH",1,1,110,0)
.E=Array of members to be enrolled.
"PKG",6,22,1,"PAH",1,1,111,0)
   Members must be local users.
"PKG",6,22,1,"PAH",1,1,112,0)
   Array must consist of DUZ's only; not names.
"PKG",6,22,1,"PAH",1,1,113,0)
   E(n)="", where n is the member's DUZ.
"PKG",6,22,1,"PAH",1,1,114,0)
.F=Mail group description array.
"PKG",6,22,1,"PAH",1,1,115,0)
   F(1)="first line"
"PKG",6,22,1,"PAH",1,1,116,0)
   F(2)="second line"
"PKG",6,22,1,"PAH",1,1,117,0)
   etc.
"PKG",6,22,1,"PAH",1,1,118,0)
G =Silent flag (0=interactive; 1=silent)
"PKG",6,22,1,"PAH",1,1,119,0)
============================================================================
"PKG",6,22,1,"PAH",1,1,120,0)

"PKG",6,22,1,"PAH",1,1,121,0)
NOIS: none
"PKG",6,22,1,"PAH",1,1,122,0)
Reference message #23076068 on FORUM from Skip Williams.  Correct the
"PKG",6,22,1,"PAH",1,1,123,0)
documentation on page 46 of the 'Programmer Reference Manual'.
"PKG",6,22,1,"PAH",1,1,124,0)
In the Example, Step 3 -- Deliver Message to Recipients, the last line of
"PKG",6,22,1,"PAH",1,1,125,0)
code should be:
"PKG",6,22,1,"PAH",1,1,126,0)

"PKG",6,22,1,"PAH",1,1,127,0)
        D ENT1^XMD ; Call for MailMan Delivery
"PKG",6,22,1,"PAH",1,1,128,0)

"PKG",6,22,1,"PAH",1,1,129,0)
NOIS: none                Routines: ^XMA21G,^XMA7G,^XMAD1,
"PKG",6,22,1,"PAH",1,1,130,0)
                                    ^XMAD1A,^XMA5A,^XMFAX
"PKG",6,22,1,"PAH",1,1,131,0)
                          DD:  file 3.8, field 14 (new)
"PKG",6,22,1,"PAH",1,1,132,0)
                               file 3.8, field 15 (new)
"PKG",6,22,1,"PAH",1,1,133,0)
                               file 3.9, (within Recipient multiple)
"PKG",6,22,1,"PAH",1,1,134,0)
                                         field 13 (new)
"PKG",6,22,1,"PAH",1,1,135,0)
                               file 3.9, (within Recipient multiple)
"PKG",6,22,1,"PAH",1,1,136,0)
                                         field 14 (new)
"PKG",6,22,1,"PAH",1,1,137,0)
                               file 4.3, field 143 (new)
"PKG",6,22,1,"PAH",1,1,138,0)

"PKG",6,22,1,"PAH",1,1,139,0)
MailMan, with this patch, is now able to fax messages.  Currently, only FORUM
"PKG",6,22,1,"PAH",1,1,140,0)
(to my knowledge) is able to take advantage of this new capability, which
"PKG",6,22,1,"PAH",1,1,141,0)
requires the presence of the AKF* suite of fax software and files and fax
"PKG",6,22,1,"PAH",1,1,142,0)
capability.  The site manager should indicate whether or not the site is
"PKG",6,22,1,"PAH",1,1,143,0)
fax-enabled by setting the new field #143 in file 4.3 (default is "no"). 
"PKG",6,22,1,"PAH",1,1,144,0)

"PKG",6,22,1,"PAH",1,1,145,0)
Two new mail group multiples have been added to the Mail Group file:  Fax
"PKG",6,22,1,"PAH",1,1,146,0)
Recipient, and Fax Group.  These multiples point to associated files in the fax
"PKG",6,22,1,"PAH",1,1,147,0)
(AKF*) suite.  These files (^AKF("FAXR", Fax Rolodex, and ^AKF("FAXG", Fax
"PKG",6,22,1,"PAH",1,1,148,0)
Group) must be populated through the fax suite.  LAYGO through MailMan is not
"PKG",6,22,1,"PAH",1,1,149,0)
permitted. 
"PKG",6,22,1,"PAH",1,1,150,0)

"PKG",6,22,1,"PAH",1,1,151,0)
When a mail message is sent (or forwarded) to a mail group with these fax
"PKG",6,22,1,"PAH",1,1,152,0)
multiples populated, the message is also transferred to the fax suite, and a
"PKG",6,22,1,"PAH",1,1,153,0)
task is queued to fax the message to those recipients pointed to by the group. 
"PKG",6,22,1,"PAH",1,1,154,0)

"PKG",6,22,1,"PAH",1,1,155,0)
Fax recipients are faxed only the original message.  Replies to mail messages
"PKG",6,22,1,"PAH",1,1,156,0)
are not faxed. Replies are not delivered as e-mail to fax recipients, unless
"PKG",6,22,1,"PAH",1,1,157,0)
they are also on the message as "normal" recipients. 
"PKG",6,22,1,"PAH",1,1,158,0)

"PKG",6,22,1,"PAH",1,1,159,0)
MailMan faxes do not have a cover page.  They print in much the same way as a
"PKG",6,22,1,"PAH",1,1,160,0)
message is printed on a printer. 
"PKG",6,22,1,"PAH",1,1,161,0)

"PKG",6,22,1,"PAH",1,1,162,0)
Individual fax recipients are stored in the recipient multiple of the message
"PKG",6,22,1,"PAH",1,1,163,0)
(identified as F.<fax recipient>).  A "Query" of the message will reveal that
"PKG",6,22,1,"PAH",1,1,164,0)
the message was sent to the Mail Group.  A "Query Detail" will reveal fax
"PKG",6,22,1,"PAH",1,1,165,0)
recipients, when the message was transferred to the fax suite, and the fax ID
"PKG",6,22,1,"PAH",1,1,166,0)
assigned to it by the fax suite, but will not reveal the transmission status. 
"PKG",6,22,1,"PAH",1,1,167,0)
(The user can ascertain the transmission status via the fax suite and the fax
"PKG",6,22,1,"PAH",1,1,168,0)
ID.) 
"PKG",6,22,1,"PAH",1,1,169,0)

"PKG",6,22,1,"PAH",1,1,170,0)
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
"PKG",6,22,1,"PAH",1,1,171,0)
NOT INCLUDED in this patch is:
"PKG",6,22,1,"PAH",1,1,172,0)
1) a necessary change to ^AKFAX to enable it to
"PKG",6,22,1,"PAH",1,1,173,0)
recognize a MailMan Fax so that it can suppress the cover page for MailMan
"PKG",6,22,1,"PAH",1,1,174,0)
faxes and address the fax to the recipient ("MailMan Fax for ... ").
"PKG",6,22,1,"PAH",1,1,175,0)
2) a new field in file #589500 - ^AKF("FAX", FAX TRANSMISSION FILE
"PKG",6,22,1,"PAH",1,1,176,0)
589500,3    MAILMAN FAX       0;4 SET OF CODES
"PKG",6,22,1,"PAH",1,1,177,0)
                              '0' FOR NO;
"PKG",6,22,1,"PAH",1,1,178,0)
                              '1' FOR YES;
"PKG",6,22,1,"PAH",1,1,179,0)
            HELP-PROMPT:      Is this a MailMan-generated fax?
"PKG",6,22,1,"PAH",1,1,180,0)
            DESCRIPTION:      Routine ^AKFAX checks this field to see if the
"PKG",6,22,1,"PAH",1,1,181,0)
                              fax is a MailMan generated fax.  If it is, then
"PKG",6,22,1,"PAH",1,1,182,0)
                              1) the fax cover sheet is suppressed and
"PKG",6,22,1,"PAH",1,1,183,0)
                              2) two additional lines are added to the top of
"PKG",6,22,1,"PAH",1,1,184,0)
                              the fax, identifying the recipient and the fax ID.
"PKG",6,22,1,"PAH",1,1,185,0)
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
"PKG",6,22,1,"PAH",1,1,186,0)

"PKG",6,22,1,"PAH",1,1,187,0)
Following are DD extracts of the new fields:
"PKG",6,22,1,"PAH",1,1,188,0)

"PKG",6,22,1,"PAH",1,1,189,0)
STANDARD DATA DICTIONARY #4.3 -- KERNEL SITE PARAMETERS FILE STORED IN ^XMB(1,
"PKG",6,22,1,"PAH",1,1,190,0)

"PKG",6,22,1,"PAH",1,1,191,0)
4.3,143     FAX ENABLED       0;19 SET OF CODES
"PKG",6,22,1,"PAH",1,1,192,0)
                              '0' FOR no; 
"PKG",6,22,1,"PAH",1,1,193,0)
                              '1' FOR yes; 
"PKG",6,22,1,"PAH",1,1,194,0)
            HELP-PROMPT:      Is your site fax enabled? 
"PKG",6,22,1,"PAH",1,1,195,0)
            DESCRIPTION:      Your site is fax enabled if you have the suite
"PKG",6,22,1,"PAH",1,1,196,0)
                              of fax software and files (^AKF) and fax
"PKG",6,22,1,"PAH",1,1,197,0)
                              capability and you choose to allow faxes to be
"PKG",6,22,1,"PAH",1,1,198,0)
                              sent via MailMan.  
"PKG",6,22,1,"PAH",1,1,199,0)
                              To send faxes via MailMan, Mail groups (file
"PKG",6,22,1,"PAH",1,1,200,0)
                              3.8) must first be populated in the fax
"PKG",6,22,1,"PAH",1,1,201,0)
                              recipient and fax group multiples.  Then, when
"PKG",6,22,1,"PAH",1,1,202,0)
                              a user sends a message to a mail group, the
"PKG",6,22,1,"PAH",1,1,203,0)
                              message is also faxed to any fax recipients in
"PKG",6,22,1,"PAH",1,1,204,0)
                              that mail group.
"PKG",6,22,1,"PAH",1,1,205,0)
                              Responses to the message are not faxed.
"PKG",6,22,1,"PAH",1,1,206,0)
 
"PKG",6,22,1,"PAH",1,1,207,0)
STANDARD DATA DICTIONARY #3.8 -- MAIL GROUP FILE          STORED IN ^XMB(3.8, 
"PKG",6,22,1,"PAH",1,1,208,0)

"PKG",6,22,1,"PAH",1,1,209,0)
3.8,14      FAX RECIPIENT     8;0 POINTER Multiple #3.814
"PKG",6,22,1,"PAH",1,1,210,0)
3.814,.01     FAX RECIPIENT     0;1 POINTER TO FAX ROLODEX FILE (#589499)
"PKG",6,22,1,"PAH",1,1,211,0)
                                 (Multiply asked)
"PKG",6,22,1,"PAH",1,1,212,0)
              HELP-PROMPT:      Enter the fax recipient who should receive 
"PKG",6,22,1,"PAH",1,1,213,0)
                                faxes sent to this mail group. 
"PKG",6,22,1,"PAH",1,1,214,0)
              DESCRIPTION:      This is a list of individual recipients who
"PKG",6,22,1,"PAH",1,1,215,0)
                                will receive by fax any mail sent to this
"PKG",6,22,1,"PAH",1,1,216,0)
                                mail group.  They receive the original
"PKG",6,22,1,"PAH",1,1,217,0)
                                message only.  They do not receive responses.
"PKG",6,22,1,"PAH",1,1,218,0)
              CROSS-REFERENCE:  3.814^B 
"PKG",6,22,1,"PAH",1,1,219,0)
                                1)= S ^XMB(3.8,DA(1),8,"B",$E(X,1,30),DA)=""
"PKG",6,22,1,"PAH",1,1,220,0)
                                2)= K ^XMB(3.8,DA(1),8,"B",$E(X,1,30),DA)
"PKG",6,22,1,"PAH",1,1,221,0)

"PKG",6,22,1,"PAH",1,1,222,0)
3.8,15      FAX GROUP           9;0 POINTER Multiple #3.815
"PKG",6,22,1,"PAH",1,1,223,0)
3.815,.01     FAX GROUP           0;1 POINTER TO FAX GROUP FILE (#589498)
"PKG",6,22,1,"PAH",1,1,224,0)
                                 (Multiply asked)
"PKG",6,22,1,"PAH",1,1,225,0)
              INPUT TRANSFORM:  S DIC("S")="N XM S XM=$G(^(3)) I $P(XM,U,2)!(
"PKG",6,22,1,"PAH",1,1,226,0)
                                $G(XMDUZ,DUZ)=+XM)" D ^DIC K DIC S DIC=DIE,X=
"PKG",6,22,1,"PAH",1,1,227,0)
                                +Y K:Y<0 X
"PKG",6,22,1,"PAH",1,1,228,0)
              HELP-PROMPT:      Enter the fax group which should receive 
"PKG",6,22,1,"PAH",1,1,229,0)
                                faxes sent to this mail group. 
"PKG",6,22,1,"PAH",1,1,230,0)
              DESCRIPTION:      Each member of the fax group will receive by
"PKG",6,22,1,"PAH",1,1,231,0)
                                fax any message sent to this mail group. 
"PKG",6,22,1,"PAH",1,1,232,0)
                                Only the original message will be faxed. 
"PKG",6,22,1,"PAH",1,1,233,0)
                                Responses will not be faxed.  
"PKG",6,22,1,"PAH",1,1,234,0)
              SCREEN:           S DIC("S")="N XM S XM=$G(^(3))
"PKG",6,22,1,"PAH",1,1,235,0)
                                           I $P(XM,U,2)!($G(XMDUZ,DUZ)=+XM)"
"PKG",6,22,1,"PAH",1,1,236,0)
              EXPLANATION:      Group must be public or user must be
"PKG",6,22,1,"PAH",1,1,237,0)
                                (surrogate of) creator of group.
"PKG",6,22,1,"PAH",1,1,238,0)
              CROSS-REFERENCE:  3.815^B 
"PKG",6,22,1,"PAH",1,1,239,0)
                                1)= S ^XMB(3.8,DA(1),9,"B",$E(X,1,30),DA)=""
"PKG",6,22,1,"PAH",1,1,240,0)
                                2)= K ^XMB(3.8,DA(1),9,"B",$E(X,1,30),DA)
"PKG",6,22,1,"PAH",1,1,241,0)

"PKG",6,22,1,"PAH",1,1,242,0)
STANDARD DATA DICTIONARY #3.9 -- MESSAGE FILE     STORED IN ^XMB(3.9,
"PKG",6,22,1,"PAH",1,1,243,0)

"PKG",6,22,1,"PAH",1,1,244,0)
3.91,13   FAX RECIPIENT         0;11 POINTER TO FAX ROLODEX FILE (#589499)
"PKG",6,22,1,"PAH",1,1,245,0)
              HELP-PROMPT:      Enter the fax recipient 
"PKG",6,22,1,"PAH",1,1,246,0)
              DESCRIPTION:      When the message is addressed to a fax
"PKG",6,22,1,"PAH",1,1,247,0)
                                recipient, this field points to the fax
"PKG",6,22,1,"PAH",1,1,248,0)
                                rolodex file.  After the message is handed
"PKG",6,22,1,"PAH",1,1,249,0)
                                off to the fax software, the pointer in this
"PKG",6,22,1,"PAH",1,1,250,0)
                                field is deleted, the STATUS field is deleted,
"PKG",6,22,1,"PAH",1,1,251,0)
                                and the FAX ID field is set to the fax ID
"PKG",6,22,1,"PAH",1,1,252,0)
                                number assigned to it by the fax software.
"PKG",6,22,1,"PAH",1,1,253,0)
              CROSS-REFERENCE:  3.91^AFAX 
"PKG",6,22,1,"PAH",1,1,254,0)
                                1)= S ^XMB(3.9,DA(1),1,"AFAX",$E(X,1,30),DA)=""
"PKG",6,22,1,"PAH",1,1,255,0)
                                2)= K ^XMB(3.9,DA(1),1,"AFAX",$E(X,1,30),DA)
"PKG",6,22,1,"PAH",1,1,256,0)
                                This cross reference makes it possible for
"PKG",6,22,1,"PAH",1,1,257,0)
                                MailMan to immediately find the recipients
"PKG",6,22,1,"PAH",1,1,258,0)
                                to fax a message to.
"PKG",6,22,1,"PAH",1,1,259,0)

"PKG",6,22,1,"PAH",1,1,260,0)
3.91,14   FAX ID                0;12 FREE TEXT (1-14 CHARS)
"PKG",6,22,1,"PAH",1,1,261,0)
              HELP-PROMPT:      Enter the fax ID
"PKG",6,22,1,"PAH",1,1,262,0)
              DESCRIPTION:      This is the fax ID as assigned to it by the
"PKG",6,22,1,"PAH",1,1,263,0)
                                fax software (^AKF*).
"PKG",6,22,1,"PAH",1,1,264,0)

"PKG",6,22,1,"PAH",1,1,265,0)
===========================================================================
"PKG",6,22,1,"PAH",1,1,266,0)

"PKG",6,22,1,"PAH",1,1,267,0)
 This patch should be installed after hours, when user activity is at a
"PKG",6,22,1,"PAH",1,1,268,0)
 minimum.  You should put the XMUSER Option out of order and shut down
"PKG",6,22,1,"PAH",1,1,269,0)
 mail delivery tasks.  A cross reference ("F", on FORWARDING ADDRESS) is
"PKG",6,22,1,"PAH",1,1,270,0)
 being added to the MAIL BOX file, and a lock must be placed on the whole
"PKG",6,22,1,"PAH",1,1,271,0)
 global for the duration of the indexing.  If the lock cannot be obtained,
"PKG",6,22,1,"PAH",1,1,272,0)
 the indexing of the new cross reference will not run.  If the indexing does
"PKG",6,22,1,"PAH",1,1,273,0)
 not run, you can do it later by running ^XMYPOST6 yourself.  ^XMYPOST6
"PKG",6,22,1,"PAH",1,1,274,0)
 will take about 1 minute per 2500 users in the ^XMB(3.7 global.
"PKG",6,22,1,"PAH",1,1,275,0)
===========================================================================
"PKG",6,22,1,"PAH",1,1,276,0)
 
"PKG",6,22,1,"PAH",1,1,277,0)
INSTALLATION:
"PKG",6,22,1,"PAH",1,1,278,0)
  1.  This routine is usually mapped on systems that allow mapping,
"PKG",6,22,1,"PAH",1,1,279,0)
      so you will need to disable mapping for the effected routine.
"PKG",6,22,1,"PAH",1,1,280,0)
  2.  Use the 'INSTALL/CHECK MESSAGE' option on the PackMan menu. This
"PKG",6,22,1,"PAH",1,1,281,0)
      option will load the KIDS package onto your system.
"PKG",6,22,1,"PAH",1,1,282,0)
  3.  The patch has now been loaded into a Transport global on your
"PKG",6,22,1,"PAH",1,1,283,0)
      system. You now need to use KIDS to install the Transport global.
"PKG",6,22,1,"PAH",1,1,284,0)
  4.  On the KIDS menu, under the 'Installation' menu, use the following
"PKG",6,22,1,"PAH",1,1,285,0)
      options:
"PKG",6,22,1,"PAH",1,1,286,0)
         Print Transport Global
"PKG",6,22,1,"PAH",1,1,287,0)
         Compare Transport Global to Current System
"PKG",6,22,1,"PAH",1,1,288,0)
         Verify Checksums in Transport Global
"PKG",6,22,1,"PAH",1,1,289,0)
         Backup a Transport Global
"PKG",6,22,1,"PAH",1,1,290,0)
         Install Package(s)
"PKG",6,22,1,"PAH",1,1,291,0)
  5.  MSM Sites - Answer YES to the question 'Want to MOVE routines to
"PKG",6,22,1,"PAH",1,1,292,0)
      other CPUs?'. Enter the names of your Compute and Print server(s).
"PKG",6,22,1,"PAH",1,1,293,0)
  6.  AXP Sites, after patch has installed, rebuild your map set.
"PKG",6,22,1,"PAH",1,1,294,0)
============================================================================ 
"PKG",6,22,1,"PAH",1,1,295,0)
  
"PKG",6,22,1,"PAH",1,1,296,0)
 ROUTINES:
"PKG",6,22,1,"PAH",1,1,297,0)
   The second line of the routine now looks like:
"PKG",6,22,1,"PAH",1,1,298,0)
       ;;7.1;MailMan;**[patch list]**;Jun 02, 1994
"PKG",6,22,1,"PAH",1,1,299,0)
 
"PKG",6,22,1,"PAH",1,1,300,0)
                Before          After
"PKG",6,22,1,"PAH",1,1,301,0)
 Name          Checksum       Checksum          Patch List
"PKG",6,22,1,"PAH",1,1,302,0)
 ----------------------------------------------------------
"PKG",6,22,1,"PAH",1,1,303,0)
 
"PKG",6,22,1,"PAH",1,1,304,0)
 XMA0           9701230       10480365          15,36
"PKG",6,22,1,"PAH",1,1,305,0)
 XMA01          2756871        2847569          36
"PKG",6,22,1,"PAH",1,1,306,0)
 XMA1           9575986        9580091          31,36
"PKG",6,22,1,"PAH",1,1,307,0)
 XMA21A         8186870        7475211          4,30,36
"PKG",6,22,1,"PAH",1,1,308,0)
 XMA21G         9710102       11073971          31,36
"PKG",6,22,1,"PAH",1,1,309,0)
 XMA5A         14213526       13683319          31,36
"PKG",6,22,1,"PAH",1,1,310,0)
 XMA7G          5426292        5211523          36
"PKG",6,22,1,"PAH",1,1,311,0)
 XMAD1          7205963        7275936          24,27,36
"PKG",6,22,1,"PAH",1,1,312,0)
 XMAD1A         5656044        6312375          36
"PKG",6,22,1,"PAH",1,1,313,0)
 XMAH0          1594203        1761641          36
"PKG",6,22,1,"PAH",1,1,314,0)
 XMAI2          1646281        1510945          36
"PKG",6,22,1,"PAH",1,1,315,0)
 XMAP           8812311        8826127          24,36
"PKG",6,22,1,"PAH",1,1,316,0)
 XMAPHOST       6366459        6157206          7,14,27,36
"PKG",6,22,1,"PAH",1,1,317,0)
 XMBGRP         5496318        5680054          13,36
"PKG",6,22,1,"PAH",1,1,318,0)
 XMFAX          **new**        4957190          36
"PKG",6,22,1,"PAH",1,1,319,0)
 XMR1A          6956680        6979581          13,36
"PKG",6,22,1,"PAH",1,1,320,0)
 XMUT5G          380003         338629          36
"PKG",6,22,1,"PAH",1,1,321,0)
 XMYPOST6       **new**          11500          36
"PKG",6,22,1,"PAH",1,1,322,0)

"PKG",6,22,1,"PAH",1,1,323,0)
============================================================================
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
18
"RTN","XMA0")
0^12^B24196407
"RTN","XMA0",1,0)
XMA0 ;(WASH ISC)/CAP/THM-Basket Control ;01/21/97  12:52
"RTN","XMA0",2,0)
 ;;7.1;MailMan;**15,36**;Jun 02, 1994
"RTN","XMA0",3,0)
 G ^XMA01
"RTN","XMA0",4,0)
GD2 I +XMKS<1 S XMKS=$O(^XMB(3.7,XMDUZ,2,XMK,1,"C",0))
"RTN","XMA0",5,0)
 I +XMKS<1 G KLE^XMA11
"RTN","XMA0",6,0)
 K XMS,XMSEC,XMTYPE
"RTN","XMA0",7,0)
 W !! W:XMKN'="" XMKN," Basket " W "Message: ",XMKS W:XMKS "// "
"RTN","XMA0",8,0)
GD3 K XMR R X:DTIME S:'$T X=U
"RTN","XMA0",9,0)
 G Q:X[U I X="" G KLE^XMA11:'$O(^XMB(3.7,XMDUZ,2,XMK,1,0)),Q:XMKS="" S X=XMKS
"RTN","XMA0",10,0)
 I "Rr"[X G GD2:$$SHARE^XMA1B(0),ENTR^XMA03
"RTN","XMA0",11,0)
 G NEW^XMAL0:"Nn"[X,^XMA03:$E(X)="?",ENTG^XMAL0A:"Qq"[X,REN^XMA11:"Cc"[X
"RTN","XMA0",12,0)
 I $E(X)="`" S X=$E(X,2,$L(X))
"RTN","XMA0",13,0)
 I X?1.N G ENTM^XMA03
"RTN","XMA0",14,0)
GD4 S X=$S($L(X):$E(X),1:" "),X=$TR(X,"abcdefghijklmnopqrstuvwxyz","ABCDEFGHIJKLMNOPQRSTUVWXYZ")
"RTN","XMA0",15,0)
 I "EFDST"[$E(X) S XMR="",Y=$$SHARE^XMA1B(0) K XMR G GD2:Y
"RTN","XMA0",16,0)
 F %=1:1:7 G G:$E($P("DELETE,EDIT,FORWARD,PRINT,HEADERLESS,SAVE,TERMINATE",",",%),1,$L(X))=X
"RTN","XMA0",17,0)
 W *7,"   Enter ?" G GD2
"RTN","XMA0",18,0)
G I $E(X)="E",$S(XMDUZ'=.5:1,XMK<1000:1,1:0) W *7,"  ???" G GD2
"RTN","XMA0",19,0)
 S Y=$T(@X) G RANGE^XMA01
"RTN","XMA0",20,0)
X S X=$O(XMBEG("")) G DK1:X="" S XMBEG=XMBEG(X),POP=0,%=$P(XMTYPE,";",2) K XMBEG(X)
"RTN","XMA0",21,0)
 I $L(%) D @% S $P(XMTYPE,";",2)="" I X["^"!POP D PR3 G DK2
"RTN","XMA0",22,0)
 S %=$P(XMTYPE,";",3) G DK1:'$L(%)
"RTN","XMA0",23,0)
 I $E(XMTYPE)="P",$D(IO("Q")),IO("Q") D EN2^XMA02 K XMP G DK1
"RTN","XMA0",24,0)
D3 I XMBEG="" S XMKS="" G X
"RTN","XMA0",25,0)
 S XMKS=$P(XMBEG,","),XMBEG=$P(XMBEG,",",2,99) G D3:'XMKS
"RTN","XMA0",26,0)
 S XMZ=$O(^XMB(3.7,XMDUZ,2,XMK,1,"C",XMKS,0)) G D3:'XMZ
"RTN","XMA0",27,0)
 S %=$E(XMTYPE),Y=$S($D(^XMB(3.9,XMZ,0)):^(0),1:"")
"RTN","XMA0",28,0)
 I %="F",$F(":Y:y:",":"_$P(Y,U,9)_":"),$P(Y,U,2)'=XMDUZ G ENT3^XMAH
"RTN","XMA0",29,0)
 I %'="S",$F(":Y:y:",":"_$P(Y,U,11)_":"),DUZ'=XMDUZ G ENT4^XMAH
"RTN","XMA0",30,0)
 I %="D",$P(Y,U,7)="S" G ENTB^XMAH
"RTN","XMA0",31,0)
 S XMC=XMC+1 D @$P(XMTYPE,";",3) G D3
"RTN","XMA0",32,0)
DK1 S %=$P(XMTYPE,";",4) I $L(%) D @%
"RTN","XMA0",33,0)
 I $E(XMTYPE)="S",$G(XMKM)>0,$G(XMKM)'=$G(XMK),'$D(^XMB(3.7,XMDUZ,2,XMKM,1,0)) S ^XMB(3.7,XMDUZ,2,XMKM,1,0)="^3.702P^"_XMZ_U_$P(^XMB(3.7,XMDUZ,2,XMKM,0),U,5)
"RTN","XMA0",34,0)
DK2 K XMBEG,XMY,^TMP("XMY",$J),XMYT,XMTP
"RTN","XMA0",35,0)
 I XMKS,'$D(^XMB(3.7,XMDUZ,2,XMK,1,"C",XMKS)) S XMKS=""
"RTN","XMA0",36,0)
 I XMKS="" D NUMB^XMA03
"RTN","XMA0",37,0)
 S %=$P(XMTYPE,";") G:$E(%)="S" O:XMKM<0
"RTN","XMA0",38,0)
 I $F(":H:P:",$E($G(XMTYPE))),$S($G(XMP)=3:1,'$G(XMC):1,1:0) W !!,"Queued to print later",*7 G O
"RTN","XMA0",39,0)
 I %'=U W !,XMC," message",$S(XMC'=1:"s",1:"")," ",$P(%,","),$S($E(%,$L(%))'="e":"e",1:""),"d",$P(%,",",2),"."
"RTN","XMA0",40,0)
 I %="Terminate",$G(XMC) D T2^XMA1
"RTN","XMA0",41,0)
 K %,XMC
"RTN","XMA0",42,0)
O K XMP
"RTN","XMA0",43,0)
TQ K XMTYPE,DIR,DIRUT G GD2
"RTN","XMA0",44,0)
ENTPRT ;FROM XMA1
"RTN","XMA0",45,0)
 D PRT S XMP=$S('$D(XMP):1,+XMP=0:1,1:XMP) D PR2:XMP'=3,PR3 Q
"RTN","XMA0",46,0)
PRT ;
"RTN","XMA0",47,0)
 S DIR(0)="Y",DIR("A")="Print recipient list ",DIR("B")="NO"
"RTN","XMA0",48,0)
 S DIR("?")="^D QU2^XMA02" D ^DIR K DIR,DIRUT I $D(DUOUT)!$D(DTOUT) G QQ
"RTN","XMA0",49,0)
 G PRT:"YNyn"'[$E(X_" ") S %="Yy"[$E(X_" "),$P(XMTYPE,";",5)=%
"RTN","XMA0",50,0)
 G PRN:'% S DIR(0)="S^D:DETAIL;S:SUMMARY",DIR("A")="Print Detailed or Summarized recipient chain",DIR("B")="SUMMARY" D ^DIR K DIR,DIRUT G QQ:$D(DUOUT)!$D(DTOUT) S $P(XMTYPE,";",7)=($E(Y)="D")
"RTN","XMA0",51,0)
PRN W !,"Print From Response: Original Message// " R Y:DTIME
"RTN","XMA0",52,0)
 G PRQ:Y[U!'$T G PRO:Y["?" I "Oo"'[$E(Y),Y'="",+Y'=Y W *7 G PRO
"RTN","XMA0",53,0)
 K %ZIS S $P(XMTYPE,";",6)=$S(+Y:Y,1:0),%ZIS="Q"
"RTN","XMA0",54,0)
 D ^%ZIS G PRQ:POP I $D(IO("Q")),IO("Q"),'$D(XMBEG) D EN1^XMA02 S XMP=3 Q
"RTN","XMA0",55,0)
 S:IO="" IO=$I Q:IO=IO(0)!$D(IO("Q"))
"RTN","XMA0",56,0)
 Q
"RTN","XMA0",57,0)
PRO D ENT8^XMAH
"RTN","XMA0",58,0)
 G PRN
"RTN","XMA0",59,0)
HDR ;Headerless Print
"RTN","XMA0",60,0)
 S XMP=2
"RTN","XMA0",61,0)
PR2 I $D(XMTYPE) Q:XMTYPE="^"  I $S(IO'=IO(0)&($G(XMP)'=2):1,'$D(XMP):1,1:0) S XMP=999
"RTN","XMA0",62,0)
 S:'$D(XMP) XMP=1
"RTN","XMA0",63,0)
 U IO D:XMP'=2 TOP^XMS2 W:XMP=2&($Y>2) @IOF D ENTPRT^XMAP
"RTN","XMA0",64,0)
 I $P(XMTYPE,";",5) D QE2^XMA5
"RTN","XMA0",65,0)
 Q
"RTN","XMA0",66,0)
PR3 ;I '$D(XMA1P) W @IOF
"RTN","XMA0",67,0)
 D ^%ZISC S IOP=IO(0) D ^%ZIS
"RTN","XMA0",68,0)
 Q
"RTN","XMA0",69,0)
PRQ Q:'$D(XMTYPE)  S XMTYPE="^",IO=IO(0) Q
"RTN","XMA0",70,0)
SA K DIC S DIC(0)="AEQNL",DIC="^XMB(3.7,XMDUZ,2,",DLAYGO=3.7,DA(1)=XMDUZ
"RTN","XMA0",71,0)
 D ^DIC S XMKM=+Y K DA Q
"RTN","XMA0",72,0)
SB Q:XMKM<0!(XMKM=XMK)  L +^XMB(3.7,XMDUZ)
"RTN","XMA0",73,0)
 S XMHOLD=$S($D(^XMB(3.7,XMDUZ,2,XMK,1,XMZ,0)):^(0),1:"") I $P(XMHOLD,U,3) D NEW^XMA
"RTN","XMA0",74,0)
 S Y=^XMB(3.7,XMDUZ,2,XMKM,0),%=$P(Y,U,4),%1=$P(Y,U,3) I %1<1 S %1=1
"RTN","XMA0",75,0)
SC I $D(^XMB(3.7,XMDUZ,2,XMKM,1,"C",%1)) S %1=%1+1 G SC
"RTN","XMA0",76,0)
 ;
"RTN","XMA0",77,0)
 ;Get 0 node From old Basket
"RTN","XMA0",78,0)
 S V=$G(^XMB(3.7,XMDUZ,2,XMK,1,XMZ,0)),XMA0V=$P(V,U,5)
"RTN","XMA0",79,0)
 ;
"RTN","XMA0",80,0)
 ;Kill Vaporization Date x-ref / remove from data if not .5 or .6
"RTN","XMA0",81,0)
 I XMA0V K ^XMB(3.7,"AC",XMA0V,XMDUZ,XMK,XMZ) I XMA0V?7N1"*" S $P(V,U,5)=""
"RTN","XMA0",82,0)
 ;
"RTN","XMA0",83,0)
 S:%1>% %=%1 S $P(^XMB(3.7,XMDUZ,2,XMKM,0),U,3,5)=%1_U_%_U_($P(Y,U,5)+1),^(1,XMZ,0)=XMZ_U_%1_U_$P(V,U,3,99),^XMB(3.7,XMDUZ,2,XMKM,1,"C",%1,XMZ)=""
"RTN","XMA0",84,0)
 K V,^XMB(3.7,"M",XMZ,XMDUZ,XMK) S ^(XMKM,XMZ)=""
"RTN","XMA0",85,0)
 ;
"RTN","XMA0",86,0)
 ;Keep Vaporization Date if DUZ>=1
"RTN","XMA0",87,0)
 I XMA0V,XMA0V?7N S ^XMB(3.7,"AC",XMA0V,XMDUZ,XMKM,XMZ)=""
"RTN","XMA0",88,0)
 ;
"RTN","XMA0",89,0)
 K XMA0V I XMKM>.5,$P(XMHOLD,U,3) D NNEW^XMA
"RTN","XMA0",90,0)
 I $D(^XMB(3.7,XMDUZ,2,XMK,0)) S %=^(0),%1=$P(%,U,3),Y=$P(%,U,4) S:XMKS<%1 %1=XMKS S:%1=Y (%1,Y)=Y-1 S:Y<1 (%1,Y)="" S $P(%,U,3,5)=%1_U_Y_U_($P(%,U,5)-1),^(0)=% K ^(1,XMZ),^("C",XMKS)
"RTN","XMA0",91,0)
 L -^XMB(3.7,XMDUZ) K XMHOLD Q
"RTN","XMA0",92,0)
Q G ^XMAK
"RTN","XMA0",93,0)
QQ S XMTYPE="^" K DUOUT,DTOUT Q
"RTN","XMA0",94,0)
 ;;Name;Prog1;Prog2;Prog3;Prt Rcpnts=1;Prt From Resp#
"RTN","XMA0",95,0)
E ;;Edit;ASK^XMC4;EDIT^XMC4
"RTN","XMA0",96,0)
S ;;Save;SA^XMA0;SB^XMA0
"RTN","XMA0",97,0)
F ;;Forward;DE2A^XMA21;ENTF^XMA2
"RTN","XMA0",98,0)
P ;;Print;PRT^XMA0;PR2^XMA0;PR3^XMA0
"RTN","XMA0",99,0)
H ;;Print, without header;PRT^XMA0;HDR^XMA0;PR3^XMA0
"RTN","XMA0",100,0)
D ;;Delete;DEL^XMAH0;KLQ^XMA1B
"RTN","XMA0",101,0)
T ;;Terminate;DEL^XMAH0;T^XMA1
"RTN","XMA01")
0^20^B4007953
"RTN","XMA01",1,0)
XMA01 ;(WASH ISC)/CAP-XMA0 (CONT) ;01/07/97  14:47
"RTN","XMA01",2,0)
 ;;7.1;MailMan;**36**;Jun 02, 1994
"RTN","XMA01",3,0)
 S Y=^XMB(3.7,XMDUZ,2,XMK,0),XMKN=$P(Y,U),K=$P(Y,U,2),XMKS=$O(^(1,"C",0))
"RTN","XMA01",4,0)
 W ! S I=+$P(Y,U,4)
"RTN","XMA01",5,0)
 I I,$O(^XMB(3.7,XMDUZ,2,XMK,1,"C",0)) W "LAST Message Number: " F I=I:-1 Q:I<1  I $D(^(I)) W I Q
"RTN","XMA01",6,0)
 S Y=+$P(Y,U,5) W "   "
"RTN","XMA01",7,0)
 I Y=0 G ENTR^XMA03:$O(^XMB(3.7,XMDUZ,2,XMK,1,0)) W "No "
"RTN","XMA01",8,0)
 W "Messages in BASKET" I Y W ": ",Y
"RTN","XMA01",9,0)
 I Y=0 G Q^XMA0:XMK<2,KLE^XMA11
"RTN","XMA01",10,0)
 I +K W " (",+K," NEW)"
"RTN","XMA01",11,0)
 G GD2^XMA0
"RTN","XMA01",12,0)
 ;
"RTN","XMA01",13,0)
 ;Programmer option choices
"RTN","XMA01",14,0)
EN S X=$S($D(DUZ(0)):DUZ(0),1:""),XMXUSEC=$S(X="@":1,$D(^XUSEC("XUPROG",XMDUZ)):1,$D(^XUSEC("XUPROGMODE",XMDUZ)):1,1:0)
"RTN","XMA01",15,0)
 S DIC="^DOPT(""XM"",",DIC(0)="AEQMZ"
"RTN","XMA01",16,0)
 S DIC("S")="Q:XMXUSEC  I ^(0)'[""LOAD"""
"RTN","XMA01",17,0)
 W !! D ^DIC K DIC Q:Y<0  X $P(Y(0),U,2,999) G EN
"RTN","XMA01",18,0)
 ;
"RTN","XMA01",19,0)
 ;Range processing from XMA0
"RTN","XMA01",20,0)
RANGE K DIR S XMTYPE=$P(Y,";",3,9)
"RTN","XMA01",21,0)
 S %=$P(^XMB(3.7,XMDUZ,2,XMK,0),U,4)
"RTN","XMA01",22,0)
 F %=%:-1 Q:$S(%<1:1,$D(^XMB(3.7,XMDUZ,2,XMK,1,"C",%)):1,1:0)
"RTN","XMA01",23,0)
 I %<1 W !,"<< Please resequence this basket !! >>"_$C(7) G TQ^XMA0
"RTN","XMA01",24,0)
 S DIR(0)="L^"_$O(^XMB(3.7,XMDUZ,2,XMK,1,"C",0))_":"_%,DIR("A")=$P($P(XMTYPE,";"),",")_" which messages"_$P($P(XMTYPE,";"),",",2)
"RTN","XMA01",25,0)
 S DIR("?")="^D R^XMAH",DIR("S")="I +Y,$D(^XMB(3.7,XMDUZ,2,XMK,1,""C"",Y))"
"RTN","XMA01",26,0)
 D ^DIR G TQ^XMA0:X[U!$D(DIRUT) K DIR,DIRUT G ENT9^XMAH:Y=""&'$O(Y(0)) S XMC=0,Y="" F I=0:0 S Y=$O(Y(Y)) Q:Y=""  S XMBEG(Y)=Y(Y) K Y(Y)
"RTN","XMA01",27,0)
 K Y G X^XMA0
"RTN","XMA1")
0^13^B19851320
"RTN","XMA1",1,0)
XMA1 ;(WASH ISC)/CAP/THM-ACTIONS ;02/18/97  12:39
"RTN","XMA1",2,0)
 ;;7.1;MailMan;**31,36**;Jun 02, 1994
"RTN","XMA1",3,0)
CBASK D C2 I $D(XMAN),$L(XMAN)>1 S X=$E(XMAN,2) K XMAN G C3
"RTN","XMA1",4,0)
C1 G Q:$E($G(XMA1))="^"
"RTN","XMA1",5,0)
 ;
"RTN","XMA1",6,0)
 ;Display Other Body parts (BLOBs)
"RTN","XMA1",7,0)
 ;
"RTN","XMA1",8,0)
 I '$G(XMAPBLOB),$O(^MAG(2005,0)) D @($S($G(IOT)="IMPC":"BLOB",1:"NODISP")_"^XMAPBLOB")
"RTN","XMA1",9,0)
 ;
"RTN","XMA1",10,0)
 S Y="IGNORE (in" I XMDUZ'=.6,XMK=1,'$G(XMNEW) S X=$S($D(XMDISPI):$P(XMDISPI,U,2),1:"") I $L(X) S Y=$S(X="D":"DELETE (from",X="T":"TERMINATE (from",1:"IGNORE (in")
"RTN","XMA1",11,0)
 W !!,"Select MESSAGE Action: "_Y_" " W:$L(XMKN) XMKN_" " W "basket)" W "// " R X:DTIME S:'$T X=U
"RTN","XMA1",12,0)
 G Q:X[U
"RTN","XMA1",13,0)
 W ! S:X="" X=$P(Y," ") S X=$TR(X,"abcdefghijklmnopqrstuvwxyz","ABCDEFGHIJKLMNOPQRSTUVWXYZ")
"RTN","XMA1",14,0)
 F %="QUERY","QN","QD" I $E(%,1,$L($P(X," ")))=$P(X," ") G UP
"RTN","XMA1",15,0)
 I X["?" S XQH="XMR-ACTION" D EN^XQH G C1:$S(XMDUZ'=.5:1,XMK<1001:1,1:0) D PRIOH^XMC4 G C1
"RTN","XMA1",16,0)
C3 K XMA21G S XMA1=X S:$E(X)="^" X=$E(X,2,99)
"RTN","XMA1",17,0)
 G Q:XMA1="^" I $E("IGNORE",1,$L(X))=X D ENI^XMA10 G Q
"RTN","XMA1",18,0)
 I $P(XMR,U,7)="S" D SPOOL^XMAH G C1:X[U
"RTN","XMA1",19,0)
D I $E("DELETE",1,$L(X))=X,XMK G C1:$$SHARE^XMA1B(0) D  G END
"RTN","XMA1",20,0)
 . D BEG
"RTN","XMA1",21,0)
 . S XMKD=XMK
"RTN","XMA1",22,0)
 . S:$D(XMDN) XMDI=XMDN
"RTN","XMA1",23,0)
 . D KLQ^XMA1B
"RTN","XMA1",24,0)
 . S:'$D(XMKS) XMKS=""
"RTN","XMA1",25,0)
 . D NUMB^XMA03:XMKS=""
"RTN","XMA1",26,0)
 . W:$P($G(XMTYPE),";")'="Terminate" !,"Deleted !!"
"RTN","XMA1",27,0)
 . K XMNEW
"RTN","XMA1",28,0)
 . D KNEW
"RTN","XMA1",29,0)
 I "FXLNSQ"'[X S I=$O(^XMB(3.9,XMZ,2,.999)) I I S I=^(I,0) I $L($P(I,U,2)) G ENT0^XMAH:$E(I,1,4)="$TXT"
"RTN","XMA1",30,0)
 I "LNS"'[X,XMDUZ'=DUZ G ENT1^XMAH:"Yy"[$E($P(XMR,U,11)_" ")
"RTN","XMA1",31,0)
 I $E("TERMINATE",1,$L(X))=X G C1:$$SHARE^XMA1B(0),T
"RTN","XMA1",32,0)
 I $E("SAVE",1,$L(X))=X D S^XMA1B G QQ
"RTN","XMA1",33,0)
 I $E("LATER",1,$L(X))=X G POST^XMB1:XMDUZ'=.6 D SH^XMA1B G C1
"RTN","XMA1",34,0)
 I $E("BACKUP",1,$L(X))=X D E G C1
"RTN","XMA1",35,0)
 I $E("WRITE",1,$L(X))=X!($E("ANSWER",1,$L(X))=X) G GC1:XMDUZ=.6,NO:$D(XMNOSEND) D WRITE^XMA11A G C1
"RTN","XMA1",36,0)
 I $E("EDIT",1,$L(X))=X G GC1:XMDUZ=.6 I XME D EDIT^XMA11 G C1:$D(^XMB(3.9,XMZ)),Q
"RTN","XMA1",37,0)
 I $E("VAPORIZE",1,$L(X))=X G C1:$$SHARE^XMA1B(0),DATE^XMA11A
"RTN","XMA1",38,0)
 I $E("FORWARD",1,$L(X))=X G:$P(XMR,U,2)'=XMDUZ NF^XMA11:"Yy"[$E($P(XMR,U,9)_" ") G:XMDUZ=.6 GC1:$P(XMR,U,2)'=DUZ D FWD^XMA1A G C1
"RTN","XMA1",39,0)
 I $E("REPLY",1,$L(X))=X G NO:$D(XMNOSEND),^XMAH1
"RTN","XMA1",40,0)
 I $E("HEADERLESS",1,$L(X))=X!($E("PRINT",1,$L(X))=X) G:XMDUZ=.5&(XMK>999) SN^XMA1E S XMP=$E(X)="H"+1,XMA1P=1 D ENTPRT^XMA0 K XMP,XMA1P G C1
"RTN","XMA1",41,0)
 I "X"[X G GC1:XMDUZ=.6 G ENT0^XMAH:'$D(^XUSEC("XUPROGMODE",DUZ)) S X=XMZ,DIC(0)="N" D MM^XMP G C1
"RTN","XMA1",42,0)
 I $E("NEW",1,$L(X))=X G GC1:XMDUZ=.6 S XMNEW=$S('$D(^XMB(3.7,XMDUZ,2,XMK,1,XMZ,0)):1,$P(^(0),U,3)+0=0:1,1:0) W "  Will be new next time." G C1
"RTN","XMA1",43,0)
 I $E("COPY",1,$L(X))=X G SN^XMA1E:XMDUZ=.5&(XMK>999),CN^XMA1E:$L($P(XMR,U,10)),GC1:XMDUZ=.6&($P(XMR,U,2)'=DUZ),NO:$D(XMNOSEND),^XMA2C
"RTN","XMA1",44,0)
 I $E(X)="K" G ENTK^XMA10
"RTN","XMA1",45,0)
ER W *7,"'",X,"' is not a valid command.  Enter '???' or 'help' for help." G C1
"RTN","XMA1",46,0)
C2 S XMZO=XMZ,XMKO=XMK_U_XMR D CONF
"RTN","XMA1",47,0)
 S XMZ=XMZO,XMK=+XMKO,XMR=$P(XMKO,U,2,99),XME=$S($P(XMR,U,2)=XMDUZ:1,XMDUZ=.5:$S(XMK>1000:1,1:0),1:0) Q
"RTN","XMA1",48,0)
 ;
"RTN","XMA1",49,0)
GC1 D SH^XMA1B G C1
"RTN","XMA1",50,0)
ZTSK ;
"RTN","XMA1",51,0)
 S XMDUZ=XMB("XMDUZ"),XMZ=XMB("XMZ"),XMKM=1 D S2^XMA1B G NNEW^XMA
"RTN","XMA1",52,0)
CONF I XMDUZ'=DUZ Q:"Yy"[$E($P(XMR,U,11)_" ")
"RTN","XMA1",53,0)
 G CONF^XMA1A
"RTN","XMA1",54,0)
T I $S($G(XMRC)="":1,'$D(^XMB(3.9,XMZ,1,XMRC)):1,1:0) S X="D" G D
"RTN","XMA1",55,0)
 D BEG S X="N",%DT="T" D ^%DT S ^XMB(3.9,XMZ,1,XMRC,"D")=Y
"RTN","XMA1",56,0)
 I $P($G(XMTYPE),";")'="Terminate" D T2
"RTN","XMA1",57,0)
 K XMNEW
"RTN","XMA1",58,0)
 S XMKD=XMK D KLQ^XMA1B,KNEW
"RTN","XMA1",59,0)
 G END
"RTN","XMA1",60,0)
T2 W !,"You won't see future responses. (In WASTE basket)" H 1
"RTN","XMA1",61,0)
 Q
"RTN","XMA1",62,0)
UP S %=$P(X," ",2),XMQUE=1 G UQ:X="Q" I $L(X)>2,$L(%) G UE:%=+% S XMQUE=% G UQ
"RTN","XMA1",63,0)
 I $E("QD",1,$L(X))=X S XMQUE=3 G UQ
"RTN","XMA1",64,0)
 I $E("QN",1,$L(X))=X S XMQUE=2 G UQ
"RTN","XMA1",65,0)
 G ER
"RTN","XMA1",66,0)
UE W !,*7,"INTEGERS are not valid names." G UZ
"RTN","XMA1",67,0)
UQ K % D QUER^XMA5
"RTN","XMA1",68,0)
UZ K XMQUE G C1
"RTN","XMA1",69,0)
E ;BACK UP
"RTN","XMA1",70,0)
 G EQ:$G(^XMB(3.9,XMZ,3,0))="" S %1=$P(^(0),U,3) G EQ:%1<1
"RTN","XMA1",71,0)
E0 W !,"There are "_%1_" responses.",!,"Back up to: Original message// "
"RTN","XMA1",72,0)
 R X:DTIME Q:X=U!'$T
"RTN","XMA1",73,0)
 I X=""!("Oo"[$E(X)) S X=0
"RTN","XMA1",74,0)
E1 G EQ:X=0 I X<0 S X=%1+X+1 S:X<0 X=0 G:X=0 E1
"RTN","XMA1",75,0)
 G EQ:+X=X D ENT8^XMAH
"RTN","XMA1",76,0)
 G E
"RTN","XMA1",77,0)
EQ S XMB0=XMZ,XMA0=X,XMBCK=1 K XMAPBLOB D ENTBCK^XMAP,KNEW:'$D(XMNEW) K XMBCK Q
"RTN","XMA1",78,0)
KNEW K XMKD I '$D(XMNEW) G NEW^XMA
"RTN","XMA1",79,0)
 I XMNEW D NNEW^XMA
"RTN","XMA1",80,0)
 K XMNEW,XMS,XMSEC Q
"RTN","XMA1",81,0)
Q S XMHOLD=X D KNEW S X=XMHOLD S:$E($G(XMA1))="^" X="^" K XMHOLD
"RTN","XMA1",82,0)
QQ K XMA1,XMAPBLOB,XMS,XMSEC Q
"RTN","XMA1",83,0)
K S K=$O(^XMB(3.7,XMDUZ,2,"B",K)) Q:K=""  G K:$O(^(K,0))'=XMKM Q
"RTN","XMA1",84,0)
 ;
"RTN","XMA1",85,0)
 ;Response Time Monitor
"RTN","XMA1",86,0)
BEG Q:'$D(XRTL)  S XRTN="XMA1-DEL/TERM" D T0^%ZOSV Q
"RTN","XMA1",87,0)
END Q:'$D(XRT0)  D T1^%ZOSV G QQ
"RTN","XMA1",88,0)
NO G ERR^XMA1A
"RTN","XMA21A")
0^3^B15728817
"RTN","XMA21A",1,0)
XMA21A ;(WASH ISC)/CAP-MailMan name server (CONT) ;12/09/96  15:00
"RTN","XMA21A",2,0)
 ;;7.1;MailMan;**4,30,36**;Jun 02, 1994
"RTN","XMA21A",3,0)
 Q
"RTN","XMA21A",4,0)
INST ;Check domain
"RTN","XMA21A",5,0)
 N XMNOFWD
"RTN","XMA21A",6,0)
 S:$E(X)="<" X=$E(X,2,999) S X=$P(X,">"),X1=X,%Z=""
"RTN","XMA21A",7,0)
 F %="INFO:","I:","CC:" I X[% S %Z=%,X=$P(X,%,2)
"RTN","XMA21A",8,0)
 I "G."=$E(X,1,2)!($E(X,1,2)="g.") D  G:XMNOFWD ER^XMA21G
"RTN","XMA21A",9,0)
 . S XMNOFWD=0
"RTN","XMA21A",10,0)
 . S XMR=$S($D(XMR):XMR,'$D(XMZ):"",$D(^XMB(3.9,XMZ,0)):^(0),1:"")
"RTN","XMA21A",11,0)
 . Q:$P(XMR,U,7)'["P"
"RTN","XMA21A",12,0)
 . Q:$D(XMCHAN)
"RTN","XMA21A",13,0)
 . I $S($D(XMDUZ):XMDUZ,1:DUZ)'=$P(XMR,U,2),'$D(^XUSEC("XM GROUP PRIORITY",XMDUZ)) K %Z S XMNOFWD=1
"RTN","XMA21A",14,0)
 S X1=X,X=$TR(X,"abcdefghijklmnopqrstuvwxyz","ABCDEFGHIJKLMNOPQRSTUVWXYZ"),X=$P(X,"@",2)
"RTN","XMA21A",15,0)
2 I X'=^XMB("NETNAME") S X1=%Z_X1 G 3
"RTN","XMA21A",16,0)
 S Y=^XMB("NUM")
"RTN","XMA21A",17,0)
 I $P(X1,"@")'["%" S X1=%Z_X1 G LOCAL
"RTN","XMA21A",18,0)
 S X1=$TR(X1,"._+",", .")
"RTN","XMA21A",19,0)
 S Y=$P(X1,"@"),X=$P(Y,"%",$L(Y,"%")),X1=$P(Y,"%",1,$L(Y,"%")-1)_"@"_X
"RTN","XMA21A",20,0)
 G 2
"RTN","XMA21A",21,0)
3 S DIC="^DIC(4.2,",DIC(0)="ZM"_$E("E",$D(XMLOC)) D I2 Q:Y<0  S $P(Y(0),U)=$S('$D(X9):$P(X,"@",2),$L(X9):X9_"."_X,1:$P(Y,U,2)) K X9
"RTN","XMA21A",22,0)
 I $P(X1,"@")="" S XMMG="Missing recipient name" S Y=-1 Q
"RTN","XMA21A",23,0)
 I '$D(^XMB("NUM")) S XMMG="This domain not christened" S Y=-1 Q
"RTN","XMA21A",24,0)
 I +Y=^XMB("NUM") G LOCAL
"RTN","XMA21A",25,0)
 I '$D(XMDF),$P(Y(0),U,2)["C",$P(Y(0),U,2)'["S" S XMMG="MailMan access to "_$P(Y,U,2)_" closed." S Y=-1 Q
"RTN","XMA21A",26,0)
 I '$D(XMDF),$P(Y(0),U,11)'="",'$D(^XUSEC($P(Y(0),U,11),DUZ)) S XMMG="You don't hold this domain's KEY.",Y=-1 Q
"RTN","XMA21A",27,0)
 I '$D(XMDF),$P(Y(0),U,2)["N" S XMMG="NO forwarding to this domain.",Y=-1 Q
"RTN","XMA21A",28,0)
 S %=$P(Y(0),U)
"RTN","XMA21A",29,0)
 D CHKDOM(%,.XMMG,.Y) Q:Y=-1
"RTN","XMA21A",30,0)
 I $G(XMZ),$$NO(XMZ) W:'$D(ZTQUEUED) *7 S XMMG="<< Messages longer than "_+^XMB(1,1,"NETWORK-LIMIT")_" lines may NOT be sent across the network. >>",Y=-1 Q
"RTN","XMA21A",31,0)
 ;
"RTN","XMA21A",32,0)
 S Y1=$P(X1,"@")_"@"_%
"RTN","XMA21A",33,0)
 I $L(Y1)>104!($L($P(Y1,"@")_Y(0,0))>103) S Y=-1,XMMG="Address parsing unsuccessful !" Q
"RTN","XMA21A",34,0)
 G I:$G(XMN)
"RTN","XMA21A",35,0)
 ;Add RCPT (XMN is either zero or undefined)
"RTN","XMA21A",36,0)
 D PSP^XMA210 S ^TMP("XMY",$J,$S('$D(^DIC(4.2,"C",$P(Y1,"@",2))):Y1,1:$P(Y1,"@")_"@"_Y(0,0)))=+Y
"RTN","XMA21A",37,0)
 I '$D(XMA21G) S ^TMP("XMY0",$J,Y1)=""
"RTN","XMA21A",38,0)
 Q:$D(XMCHAN)
"RTN","XMA21A",39,0)
 ;
"RTN","XMA21A",40,0)
 ;Display for interactive users (XMCHAN not defined above)
"RTN","XMA21A",41,0)
 S XMMG="via "_$P(^DIC(4.2,+Y,0),U)_$S($P(^(0),U,2)["S":"",1:" (Queued)")
"RTN","XMA21A",42,0)
 S XMQ(+Y)="" Q
"RTN","XMA21A",43,0)
 ;Remove RCPT
"RTN","XMA21A",44,0)
I Q:'$D(^TMP("XMY",$J,Y1))  K ^TMP("XMY",$J,Y1),^TMP("XMY0",$J,Y1) W "  Deleted."
"RTN","XMA21A",45,0)
 Q
"RTN","XMA21A",46,0)
I2 S X9="",XMA21A=^XMB("NUM") I $L(X,".")>1!$D(XMCHAN) S %Z=$P(X,".",$L(X,".")) I %Z="MIL"!(%Z="DE") S DIC(0)=DIC(0)_"MXO"
"RTN","XMA21A",47,0)
 F  D ^DIC Q:$S(Y-XMA21A=0&'$L(X9):1,Y-XMA21A'=0&(Y>0):1,1:0)  D  Q:'$D(XMA21A)
"RTN","XMA21A",48,0)
 . I X=^XMB("NETNAME") D  Q
"RTN","XMA21A",49,0)
 . . S Y=-1,XMDOMLK=1  ; XMDOMLK is checked only by ^XMR.
"RTN","XMA21A",50,0)
 . . S XMMG="Sub-Domain '"_X9_"' not found."
"RTN","XMA21A",51,0)
 . . K XMA21A
"RTN","XMA21A",52,0)
 . S X9=X9_$S($L(X9):".",1:"")_$P(X,".")
"RTN","XMA21A",53,0)
 . S X=$P(X,".",2,999)
"RTN","XMA21A",54,0)
 . I X="" K XMA21A S:$E(X9)'="#" XMMG="Domain not found." Q
"RTN","XMA21A",55,0)
 . ;I $L(X9,".")>1,X'?.E1".".E,DIC(0)'["X" S DIC(0)=DIC(0)_"X" ; *** WHY?
"RTN","XMA21A",56,0)
 I '$D(XMA21A),$E(X9)="#" G I3
"RTN","XMA21A",57,0)
 Q
"RTN","XMA21A",58,0)
 ;X400 ADDRESSING
"RTN","XMA21A",59,0)
I3 S X="#" D ^DIC I Y>0 K X9 S X=X1 Q
"RTN","XMA21A",60,0)
 S XMMG="X.400 DOMAIN not found. MUST HAVE '#' as it's SYNONYM" Q
"RTN","XMA21A",61,0)
LOCAL ;Recipient is local
"RTN","XMA21A",62,0)
 ;Recipient name
"RTN","XMA21A",63,0)
 S X=$P(X1,"@")
"RTN","XMA21A",64,0)
 ;Call Local Name Server Y>0=success
"RTN","XMA21A",65,0)
 D W3 S X=$P(X1,"@")
"RTN","XMA21A",66,0)
 Q:$S(Y>0:1,".D.G.S.d.g.s."[$E(X_" ",1,2):1,X'[".":1,1:0)
"RTN","XMA21A",67,0)
 ;If not successful first time, convert first "," to "." - try again
"RTN","XMA21A",68,0)
 S X=$TR(X,"._+",", ."),XMMG=""
"RTN","XMA21A",69,0)
 G W3GO
"RTN","XMA21A",70,0)
W3 N %,XMA21AL S %=X1,XMA21AL=1 N X1 S X1=%
"RTN","XMA21A",71,0)
W3GO N XMLOCQ S XMLOCQ="QUIT" D W3^XMA21
"RTN","XMA21A",72,0)
 Q
"RTN","XMA21A",73,0)
NO(XMZ) ;Do not allow message to be sent across network if too long
"RTN","XMA21A",74,0)
 ;according to field 8.3 of file 4.3
"RTN","XMA21A",75,0)
 ; Return 0 if OK; 1 if too long
"RTN","XMA21A",76,0)
 I $S($D(XMCHAN):1,$D(XMDF):1,$D(^XUSEC("XMMGR",DUZ)):1,1:0) Q 0
"RTN","XMA21A",77,0)
 N %
"RTN","XMA21A",78,0)
 S %=$P($G(^XMB(1,1,"NETWORK-LIMIT")),U)
"RTN","XMA21A",79,0)
 Q:'% 0
"RTN","XMA21A",80,0)
 I $P($G(^XMB(3.9,XMZ,2,0)),U,4)>% Q 1
"RTN","XMA21A",81,0)
 Q 0
"RTN","XMA21A",82,0)
CHKDOM(XMDOM,XMMG,Y) ;
"RTN","XMA21A",83,0)
 I $TR(XMDOM,".-_","")'?.AN D  Q
"RTN","XMA21A",84,0)
 . S Y=-1
"RTN","XMA21A",85,0)
 . S XMMG="Domain must not contain any punctuation, except for '.', '-', or '_'."
"RTN","XMA21A",86,0)
 N I
"RTN","XMA21A",87,0)
 F I=1:1:$L(XMDOM,".") D  Q:$G(Y)=-1
"RTN","XMA21A",88,0)
 . Q:$P(XMDOM,".",I)?1AN.E
"RTN","XMA21A",89,0)
 . S Y=-1
"RTN","XMA21A",90,0)
 . S XMMG="Domain '"_XMDOM_"' not valid.  Must begin with letter or number."
"RTN","XMA21A",91,0)
 Q
"RTN","XMA21G")
0^9^B25426832
"RTN","XMA21G",1,0)
XMA21G ;(WASH ISC)/CAP-Name parser / Group handler ;01/30/97  09:00
"RTN","XMA21G",2,0)
 ;;7.1;MailMan;**31,36**;Jun 02, 1994
"RTN","XMA21G",3,0)
 ;
"RTN","XMA21G",4,0)
 ;XMUOUT is set if the user really aborts
"RTN","XMA21G",5,0)
 ;XMOUT is set if the user doesn't answer 'Yes' to seeing more recipients
"RTN","XMA21G",6,0)
 ;
"RTN","XMA21G",7,0)
ENT ;FROM NAME SERVER
"RTN","XMA21G",8,0)
 I '$D(XMCHAN) K XMLOC S:'$D(ZTQUEUED) XMLOC=1
"RTN","XMA21G",9,0)
MG D XMR I '$D(XMCHAN),$P(XMR,U,7)["P",XMDUZ'=$P(XMR,U,2),'$D(XMCOPY),'$D(^XUSEC("XM GROUP PRIORITY",XMDUZ)) G ER
"RTN","XMA21G",10,0)
 S DIC("S")="S J=^(0),XMA=$S($D(^XMB(3.8,+Y,3)):$P(^(3),U),1:.5) I $P(J,U,2)=""PU""!(XMA=XMDUZ)!(+$P(J,U,6)=0&$D(^XMB(3.8,+Y,1,""B"",XMDUZ)))"
"RTN","XMA21G",11,0)
 S DIC="^XMB(3.8,",DIC(0)="M"_$S('$D(XMLOC):"",$D(XMCHAN):"",$D(ZTQUEUED):"",1:"E")_$S($D(XMCHAN):"O",'$D(XMDF):"",1:"O") D ^DIC K DIC S I=+Y I I<0 S XMMG="Mail Group not found " Q
"RTN","XMA21G",12,0)
 I $D(^XMB(3.8,I,4,"B")),'$D(^XMB(3.8,I,4,"B",XMDUZ)) S XMMG="You may not send mail directly to this group" G:$D(XMLOC) ASL^XMA7G Q
"RTN","XMA21G",13,0)
 D NOW^%DTC S %=^XMB(3.8,+Y,0),$P(%,U,4,5)=$P(%,U,4)+1_U_X,^(0)=%,X=$S($D(^XMB(3.8,+Y,1,0)):$P(^(0),U,4),1:0),XME0=$P(%,U,6),XMLOCAL=X
"RTN","XMA21G",14,0)
 I $D(XMLOC),'$D(XMFINAL) D
"RTN","XMA21G",15,0)
 . W !,X_" Local"
"RTN","XMA21G",16,0)
 . W:$D(^XMB(3.8,+Y,5,0)) "    "_$P(^(0),U,4)_" Member Group(s)"
"RTN","XMA21G",17,0)
 . W:$D(^XMB(3.8,+Y,6,0)) "    "_$P(^(0),U,4)_" Other Members"
"RTN","XMA21G",18,0)
 . W:$D(^XMB(3.8,+Y,7,0)) "    "_$P(^(0),U,4)_" Distribution Lists"
"RTN","XMA21G",19,0)
 . I $P(^XMB(1,1,0),U,19) D
"RTN","XMA21G",20,0)
 . . W:$D(^XMB(3.8,+Y,8,0)) "    "_$P(^(0),U,4)_" Fax Recipients"
"RTN","XMA21G",21,0)
 . . W:$D(^XMB(3.8,+Y,9,0)) "    "_$P(^(0),U,4)_" Fax Groups"
"RTN","XMA21G",22,0)
 . W ":",!
"RTN","XMA21G",23,0)
 ;
"RTN","XMA21G",24,0)
 ;EXPAND known group (Y=mail_group#^mail_group_name,I=+Y,XME0=Restrictions)
"RTN","XMA21G",25,0)
GO K XMOUT,XMUOUT
"RTN","XMA21G",26,0)
 D DO
"RTN","XMA21G",27,0)
 I XMN,XMLOCAL,$D(^TMP("XMY",$J,"* (Broadcast to all local users)")) D
"RTN","XMA21G",28,0)
 . Q:$D(XMQUEUED)!$D(XMCHAN)
"RTN","XMA21G",29,0)
 . W !!,*7,"Because you have broadcast this message, it will still go to all local users.",!
"RTN","XMA21G",30,0)
 K XMOUT,XMUOUT,XMA21G,XMLOCAL
"RTN","XMA21G",31,0)
 S XMMG=""
"RTN","XMA21G",32,0)
 Q
"RTN","XMA21G",33,0)
DO G:$G(XMDF) Y:$D(XMFINAL) I 'XMN S ^TMP("XMY0",$J,"G."_$P(Y,U,2)_$S(XME0:" [Private Mail Group]",1:""))=+Y
"RTN","XMA21G",34,0)
 I XMN K ^TMP("XMY0",$J,"G."_$P(Y,U,2))
"RTN","XMA21G",35,0)
 I '$D(XMR) N XMR D XMR
"RTN","XMA21G",36,0)
Y N Y S (XMB0,XMC0,Y)=0,XMANS=1
"RTN","XMA21G",37,0)
 ;Local members
"RTN","XMA21G",38,0)
 S XMD0=1 D YL G YQ:$D(XMUOUT)
"RTN","XMA21G",39,0)
 ;Member Groups
"RTN","XMA21G",40,0)
 I XME0<4 S XMD0=5,Y=0 D YL G YQ:$D(XMUOUT)
"RTN","XMA21G",41,0)
 ;Remote Members
"RTN","XMA21G",42,0)
 I $S('XME0:1,XME0=2:0,XME0=3:0,XME0=6:0,1:1) D
"RTN","XMA21G",43,0)
 . S XMD0=6,Y=0 D YL Q:$D(XMUOUT)
"RTN","XMA21G",44,0)
 . S XMD0=7,Y=0 D YL Q:$D(XMUOUT)
"RTN","XMA21G",45,0)
 . Q:'$P(^XMB(1,1,0),U,19)
"RTN","XMA21G",46,0)
 . S XMD0=8,Y=0 D YL Q:$D(XMUOUT)
"RTN","XMA21G",47,0)
 . S XMD0=9,Y=0 D YL Q:$D(XMUOUT)
"RTN","XMA21G",48,0)
YQ K:'$D(XMD0(0)) XMANS,XME0 K XMD0 Q
"RTN","XMA21G",49,0)
 ;Hit name server for Member-remote
"RTN","XMA21G",50,0)
XMA21 S J=X N %,XMA21G,XMLOC,I,XMD0,XME0,X,Y S X=J,XMA21G=1 G WHOXM^XMA21
"RTN","XMA21G",51,0)
 ;Recurse/(EXPAND) member-group
"RTN","XMA21G",52,0)
YG N I,XMD0,Y,Z S I=+X,XMD0(0)=1 G Y
"RTN","XMA21G",53,0)
 ;Expand Distribution List
"RTN","XMA21G",54,0)
YD N %,%0,D,Y S %0=XMD0(1) K XMD0(1)
"RTN","XMA21G",55,0)
 Q:'$D(^XMB(3.816,%0,0))  S Y=$P(^(0),U)
"RTN","XMA21G",56,0)
 I ".S.s.D.d.G.g."'[("."_$E(Y,1,2)) S Y="G."_Y
"RTN","XMA21G",57,0)
 F %=0:0 S %=$O(^XMB(3.816,%0,1,%)) Q:+%'=%  I $D(^(%,0)) S D=^(0) I $D(^DIC(4.2,D,0)) S X=Y_"@"_$P(^(0),U),Z=X D YLQ S:'XMN ^TMP("XMY",$J,X)=D K:XMN ^TMP("XMY",$J,X)
"RTN","XMA21G",58,0)
 Q
"RTN","XMA21G",59,0)
YL ;Parse different Types of Mail Group Members
"RTN","XMA21G",60,0)
 S Y=$O(^XMB(3.8,I,XMD0,Y)) Q:'Y  D O Q:$D(XMUOUT)  S X=^XMB(3.8,I,XMD0,Y,0)
"RTN","XMA21G",61,0)
 ;I XMD0=1 S Z=$S($D(^VA(200,X,0)):^(0),1:"") G YL:$P(Z,U,3)="",YL:'$D(^XMB(3.7,X,0)) S %=^(0)
"RTN","XMA21G",62,0)
 I XMD0=1 S Z=$S($D(^VA(200,X,0)):^(0),1:""),%=$S($D(^XMB(3.7,X,0)):^(0),1:"No Mailbox "_X)
"RTN","XMA21G",63,0)
 I XMD0=5 G YL:'$D(^XMB(3.8,+X,0)) S Z=^(0) D YLQ,YG S X=$P(Z,U) G YL
"RTN","XMA21G",64,0)
 I XMD0=6 S X=$P(X,U),XMD0=7,Z=X D YLQ S XMD0=6 D XMA21 G YL
"RTN","XMA21G",65,0)
 I XMD0=7 S XMD0(1)=+X,X="Distribution List "_$P(^XMB(3.816,+X,0),U) D YLQ,YD G YL
"RTN","XMA21G",66,0)
 I XMD0=8 D FR(X) S XMD0=8 G YL  ; Fax recipients
"RTN","XMA21G",67,0)
 I XMD0=9 D  S XMD0=9 G YL       ; Fax groups
"RTN","XMA21G",68,0)
 . N Y,Z
"RTN","XMA21G",69,0)
 . S Z=+X  ; pointer to fax group
"RTN","XMA21G",70,0)
 . S X="FAX Group: "_$P(^AKF("FAXG",Z,0),U,1)
"RTN","XMA21G",71,0)
 . S XMD0=7 D YLQ S XMD0=9
"RTN","XMA21G",72,0)
 . S Y=0
"RTN","XMA21G",73,0)
 . F  S Y=$O(^AKF("FAXG",Z,2,Y)) Q:Y'>0  D FR(^AKF("FAXG",Z,2,Y,0))
"RTN","XMA21G",74,0)
 ;
"RTN","XMA21G",75,0)
 ;Individuals added/minus'd
"RTN","XMA21G",76,0)
 D YLQ
"RTN","XMA21G",77,0)
 G YL:XMD0'=1 I XMN K ^TMP("XMY",$J,X) G YL
"RTN","XMA21G",78,0)
 I X=.6 W:'$D(ZTQUEUED)&'$D(XMCHAN) !!,*7,"'Shared,Mail' was not included as a recipient of this message !",!! G YL
"RTN","XMA21G",79,0)
 S ^TMP("XMY",$J,X)="" S:$P(%,U,2)'="" ^TMP("XMY",$J,X,"F")=$P(%,U,2)_U_$P(%,U,8)
"RTN","XMA21G",80,0)
 ;INFO:, CC:
"RTN","XMA21G",81,0)
 I X,$D(XMA0),$L(XMA0),'$D(^XMB(3.9,XMZ,1,"C",X)),X-$P(XMR,U,2)'=0 S ^TMP("XMY",$J,X,1)=XMA0
"RTN","XMA21G",82,0)
 G YL
"RTN","XMA21G",83,0)
YLQ N % S %=X N X S X=$S('%:%,1:$P(Z,U))
"RTN","XMA21G",84,0)
 Q:$S('XMANS:1,'$D(XMLOC):1,$D(XMFINAL):1,1:0)
"RTN","XMA21G",85,0)
 S XMB0=XMB0+1,XMC0=XMC0+$S(XMD0=7:4,1:1)
"RTN","XMA21G",86,0)
 Q:$D(XMOUT)  I $S('(XMC0-1#4):1,XMD0=7:1,1:0) W !
"RTN","XMA21G",87,0)
 W ?$S(XMD0=7:0,1:(XMC0-1#4*20)),$E($S(XMN:" Deleted "_X,1:X),1,$S(XMD0=7:79,1:19))
"RTN","XMA21G",88,0)
 Q
"RTN","XMA21G",89,0)
O Q:$S($D(XMOUT):1,$D(XMFINAL):1,XMB0#16:1,'XMB0:1,$O(^XMB(3.8,I,XMD0,Y)):0,1:1)
"RTN","XMA21G",90,0)
 S X=0 R !,"Do you want to see more group members?  NO//",X:DTIME
"RTN","XMA21G",91,0)
 S X=$TR(X,"abcdefghijklmnopqrstuvwxyz","ABCDEFGHIJKLMNOPQRSTUVWXYZ")
"RTN","XMA21G",92,0)
 I X["^" S XMOUT=99 Q
"RTN","XMA21G",93,0)
 I $E("NO",1,$L(X))=X S XMOUT=1 W ! Q
"RTN","XMA21G",94,0)
 I $E("YES",1,$L(X))'=X W !,*7,"Answer 'Yes' or 'No' !" G O
"RTN","XMA21G",95,0)
 W ! Q
"RTN","XMA21G",96,0)
FR(X) ; Fax recipient
"RTN","XMA21G",97,0)
 N Z
"RTN","XMA21G",98,0)
 S Z=X  ; pointer to fax recipient
"RTN","XMA21G",99,0)
 S X="FAX Recipient: "_$P(^AKF("FAXR",+X,0),U,1)
"RTN","XMA21G",100,0)
 S XMD0=7 D YLQ
"RTN","XMA21G",101,0)
 S X="F."_$E(X,16,99)
"RTN","XMA21G",102,0)
 I XMN K ^TMP("XMY",$J,X) Q
"RTN","XMA21G",103,0)
 S ^TMP("XMY",$J,X)=Z
"RTN","XMA21G",104,0)
 Q
"RTN","XMA21G",105,0)
ER S XMMG="Only sender or holder of XM GROUP PRIORITY key may forward priority messages to Mail Groups!" Q
"RTN","XMA21G",106,0)
XMR S XMR=$S($D(XMR):XMR,'$D(XMZ):"",$D(^XMB(3.9,XMZ,0)):^(0),1:"")
"RTN","XMA21G",107,0)
 Q
"RTN","XMA5A")
0^15^B20578234
"RTN","XMA5A",1,0)
XMA5A ;(WASH ISC)/THM/CAP- EDIT/ADD/SUBTRACT RECIPIENTS ;02/11/97  08:28
"RTN","XMA5A",2,0)
 ;;7.1;MailMan;**31,36**;Jun 02, 1994
"RTN","XMA5A",3,0)
 S:'$D(XMQUE) XMQUE="" I $D(XMTYPE),XMP S XMQUE=$S($P(XMTYPE,";",7):3,1:1)
"RTN","XMA5A",4,0)
 N XMA0 S XMA0=$P($G(^XMB(3.9,XMZ,3,0)),U,4)
"RTN","XMA5A",5,0)
 S X=$S(XMQUE=1:6,XMQUE=3:1,1:0) I X S Y=$S($D(^XMB(3.9,XMZ,1,0)):$P(^(0),U,3),1:"NO") I $S(Y:1,X:1,1:0) W !,">> "_Y_" RECIPIENT"_$S(Y=1:"",1:"S")_" ! <<",! G 1
"RTN","XMA5A",6,0)
 I X=6 W !,">> This message has no summary recipient list.  Please enter 'QD'. <<",!
"RTN","XMA5A",7,0)
1 I 'XMP,XMQUE="" D LATER G Z
"RTN","XMA5A",8,0)
 I XMQUE'?1.N,$L(XMQUE) S XMA5A=1,X=XMQUE,DIC="^VA(200,",DIC(0)="FNO",DIC("S")="I $D(^XMB(3.9,XMZ,1,$C(67),+Y))" D ^DIC K DIC I Y>0 S I=$O(^XMB(3.9,XMZ,1,$C(67),+Y,0)),X=^XMB(3.9,XMZ,1,I,0),XMF0="Q" G N
"RTN","XMA5A",9,0)
 K XMA5A I XMQUE=1 W !," <<< This message was ADDRESSED as follows ! >>>",! I '$O(^XMB(3.9,XMZ,6,0)) W !,"This is an old message.  Only the Detail Query is available.",! S XMQUE=3
"RTN","XMA5A",10,0)
Q0 K XMA5 S XMF0("Q")="~"
"RTN","XMA5A",11,0)
 ;
"RTN","XMA5A",12,0)
 ;List Groups first if Summary
"RTN","XMA5A",13,0)
 S XMQUE(0)=$S(XMQUE'?1.N&$L(XMQUE):3,1:XMQUE),%=$S(XMQUE=3:1,XMQUE=1:6,XMQUE(0):1,1:0) G Z:'%,Q1:XMQUE'=1
"RTN","XMA5A",14,0)
 S XMF0="G.",XMF0("Q")="G.~"
"RTN","XMA5A",15,0)
Q1 S XMF0=$O(^XMB(3.9,XMZ,$E(611,XMQUE(0)),$E("BCC",XMQUE(0)),XMF0)) G CONT:XMF0]XMF0("Q")!(XMF0="") S X=$O(^(XMF0,0)),I=+X,X=$G(^XMB(3.9,XMZ,$E(611,XMQUE(0)),X,0)) G Q1:X=""
"RTN","XMA5A",16,0)
N S XMA5=X,X1=$P(X,U),(X2,X3)=""
"RTN","XMA5A",17,0)
 I XMQUE=3,$D(^XMB(3.9,XMZ,1,I,"T")) S X2=^("T"),X3=$P(X2,U,2),X2=$P(X2,U),X2=$P("THRU: ^CC: ^INFO: ",U,$F("TCI",X2)-1)
"RTN","XMA5A",18,0)
 S XMSG=X2_$S(+X1'=X1:X1,$D(^VA(200,X1,0)):$P(^(0),U),1:X1)
"RTN","XMA5A",19,0)
 I XMQUE=1 D OUT^XMA5 G Q1:'$D(XMOUT) D LATER G Z
"RTN","XMA5A",20,0)
 I XMQUE'?1.N,$L(XMQUE),$E($S(XMSG'[": ":XMSG,1:$P(XMSG,": ",2)),1,$L(XMQUE))'=XMQUE G Q1:'$D(XMA5A) Q
"RTN","XMA5A",21,0)
 S X1=XMA5,X=$P(X,U,3) D D S:'$D(XMSG) XMSG=""
"RTN","XMA5A",22,0)
 S XMSG=$E(XMSG_"             ",1,$S($L(XMSG)<20:20,1:$L(XMSG)))_" "_$S(X'="":"Last read: "_Y,$E(X1,1,2)="F.":"",($P(X1,U)'["@")&($P(X1,U)'?1"*".E):"Not read.",1:"")
"RTN","XMA5A",23,0)
 S X=X1 S:$P(X,U,2) XMSG=XMSG_" ("_+$P(X,U,2)_" of "_XMA0_" response"_$S(XMA0>1:"s",1:"")_")"
"RTN","XMA5A",24,0)
 I $L($P(X,U,4,6))>2 D
"RTN","XMA5A",25,0)
 . S X=$P(X,U,5) D D
"RTN","XMA5A",26,0)
 . S:X'="" XMSG=XMSG_$S($E(X1,1,2)="F.":" Sent to Fax: ",1:" Sent: ")_Y
"RTN","XMA5A",27,0)
 . S:$P(X1,U,4)'="" XMSG=XMSG_" Message-ID: "_$P(X1,U,4)
"RTN","XMA5A",28,0)
 . S:$P(X1,U,6)'="" XMSG=XMSG_" Status: "_$P(X1,U,6)
"RTN","XMA5A",29,0)
 . S:$P(X1,U,12)'="" XMSG=XMSG_" Fax ID: "_$P(X1,U,12)
"RTN","XMA5A",30,0)
 I $P(X1,U,7)'="",$D(^DIC(4.2,$P(X1,U,7),0)) S XMSG=XMSG_" Path: "_$P(^(0),U)
"RTN","XMA5A",31,0)
 I $P(X1,U,8)'="" S XMSG=XMSG_" Time: "_$P(X1,U,8)_" seconds."
"RTN","XMA5A",32,0)
 I $D(^XMB(3.9,XMZ,1,I,"D")) S X=^("D") D D S XMSG=XMSG_"  Terminated: "_Y
"RTN","XMA5A",33,0)
 S %=$G(^XMB(3.9,XMZ,1,I,"F")) I $L(%) S:+% $P(%," ")=$P(^VA(200,+%,0),U) S XMSG=$S($E(%)=" ":XMSG_" Forwarded on: "_$P(%,U),1:XMSG_" Forwarded by: "_$P(%,U))
"RTN","XMA5A",34,0)
 I $D(^XMB(3.9,XMZ,1,I,"C")) S XMSG=XMSG_" Copied: "_^("C")
"RTN","XMA5A",35,0)
 I $D(^XMB(3.9,XMZ,1,I,"S")) S XMSG=XMSG_" Surrogate: "_^("S")
"RTN","XMA5A",36,0)
 S X=XMA5,X=$P(X,U,10) I $G(X) D D S XMSG=XMSG_" [First read: "_Y_"]"
"RTN","XMA5A",37,0)
 I XMQUE'?1.N,$L(XMQUE) D OUT^XMA5 G Z:$D(XMOUT),Q1:'$D(XMA5A),Z^XMA5
"RTN","XMA5A",38,0)
 D OUT^XMA5 G:'$D(XMA5A)!(XMQUE'="") Q1:'$D(XMOUT),Z
"RTN","XMA5A",39,0)
 ;
"RTN","XMA5A",40,0)
 ;Get rest of Summary or quit
"RTN","XMA5A",41,0)
CONT I XMQUE=1,XMF0("Q")="G.~" W ! S XMF0="",XMF0("Q")="G." G Q1
"RTN","XMA5A",42,0)
 I XMQUE=1,XMF0("Q")="G." S XMF0="G.~",XMF0("Q")="~" G Q1
"RTN","XMA5A",43,0)
 D LATER G Z
"RTN","XMA5A",44,0)
LATER ;LIST DATES MESSAGE WILL BE NEW ON 'LATER'
"RTN","XMA5A",45,0)
 W:$D(XMQUE) ! S:'$D(XMQUE) XMQUE="" K XMF0 I XMQUE=2 Q
"RTN","XMA5A",46,0)
 N I S XMSG="" Q:'$O(^XMB(3.73,"AC",XMZ,XMDUZ,0))  S %="" F I=0:0 S I=$O(^(I)) Q:'I  S %=I_U_% I $L(%,U)>9 S %=" (There are more dates & times-- SEE REPORT FOR FULL LIST)^"_% Q
"RTN","XMA5A",47,0)
L S I=$P(%,U,1),%=$P(%,U,2,99) I I S X=$P(^XMB(3.73,I,0),U) D D S I=X
"RTN","XMA5A",48,0)
 S XMSG=I_$S($L(XMSG):", ",1:"")_XMSG G L:$L(%)
"RTN","XMA5A",49,0)
 S XMSG="**NEW** dates and times: "_$E(XMSG,$S($E(XMSG)=" ":2,1:1),999)
"RTN","XMA5A",50,0)
 D OUT^XMA5 W ! Q
"RTN","XMA5A",51,0)
Z G Z^XMA5:$S(XMQUE="":1,$D(XMOUT):1,$D(ZTQUEUED):1,IO'=$G(IO(0)):1,$G(XMA1P):1,1:0)
"RTN","XMA5A",52,0)
 I XMQUE=1 S XMSG="Enter 'QD' for individual recipients" S:XMQUE'=2 XMSG=XMSG_", 'QN' for Network information" S XMSG=XMSG_"." D OUT^XMA5 G Z:$D(XMOUT)
"RTN","XMA5A",53,0)
 S XMSG="Enter 'Q name' or 'Q name@domain' to search for a particular recipient." D OUT^XMA5 G Z:$D(XMOUT)
"RTN","XMA5A",54,0)
 G Z^XMA5
"RTN","XMA5A",55,0)
D Q:X<20000  S Y=$E(X,6,7)_" "_$P("Jan^Feb^Mar^Apr^May^Jun^Jul^Aug^Sep^Oct^Nov^Dec",U,$E(X,4,5))_" "_$E(X,2,3) S:X\1'=X %2=$P(X,".",2)_"0000",Y=Y_" "_$E(%2,1,2)_":"_$E(%2,3,4) S X=Y
"RTN","XMA5A",56,0)
 K %2 Q
"RTN","XMA7G")
0^14^B8921656
"RTN","XMA7G",1,0)
XMA7G ;(WASH ISC)/RJ/THM/CAP-GROUP ;01/09/97  13:52
"RTN","XMA7G",2,0)
 ;;7.1;MailMan;**36**;Jun 02, 1994
"RTN","XMA7G",3,0)
GHELP ;GROUP
"RTN","XMA7G",4,0)
 W !! S DIC="^XMB(3.8,",DIC(0)="AEQMZ",DIC("S")="D GHLP^XMA7G" D ^DIC
"RTN","XMA7G",5,0)
 K DIC("S"),DR Q:Y<0  W @IOF S DA=+Y F DR=0,3,4,2,5,6,7,1200001 D EN^DIQ
"RTN","XMA7G",6,0)
 S Y=DA D ENTQ^XMA5 G GHELP
"RTN","XMA7G",7,0)
GHLP N X,% S %=^XMB(3.8,+Y,0) I $P(%,U,2)'="PR" Q
"RTN","XMA7G",8,0)
 S X=$G(^XMB(3.8,+Y,3)) I $L(X),$P(%,U,6),$P(X,U)=$S($D(XMDUZ):XMDUZ,1:DUZ) Q
"RTN","XMA7G",9,0)
 I $D(^XMB(3.8,+Y,1,"B",$S($D(XMDUZ):XMDUZ,1:DUZ))) Q
"RTN","XMA7G",10,0)
 Q
"RTN","XMA7G",11,0)
JOIN ;GROUP
"RTN","XMA7G",12,0)
 W !! S DIC="^XMB(3.8,",DIC(0)="AEQMZ",XMA0=$S($D(XMDUZ):XMDUZ,1:DUZ)
"RTN","XMA7G",13,0)
 S DIC("S")="S XMB0=$P(^(0),U,2) I XMB0=""PR""&$D(^XMB(3.8,+Y,1,""B"",XMA0))!(XMB0=""PU"")"
"RTN","XMA7G",14,0)
 S DIC("W")="W:$D(^XMB(3.8,+Y,1,""B"",XMA0)) ?35,""Member"" I $P(^XMB(3.8,+Y,0),U,3)'=""y"" W ?43,""...Self Enrollment Not Allowed."""
"RTN","XMA7G",15,0)
 D ^DIC K DIC,XMB0 I Y<0 K XMA0 Q
"RTN","XMA7G",16,0)
 W !
"RTN","XMA7G",17,0)
 I $P(^XMB(3.8,+Y,0),U,3)'="y" W !,"Self enrollment is not allowed for this mail group." G JOIN
"RTN","XMA7G",18,0)
 G DROP:$D(^XMB(3.8,+Y,1,"B",XMA0))
"RTN","XMA7G",19,0)
 S DIE="^XMB(3.8,",DR="2///`"_XMA0,DA=+Y D ^DIE W !,"You are now a member",! G JOIN
"RTN","XMA7G",20,0)
DROP R !,"You are a member.  Do you want to drop out?  NO// ",X:DTIME I '$T!(X="^") G JOIN
"RTN","XMA7G",21,0)
 I X="?" W !,"Enter YES to remove yourself from the group" G DROP
"RTN","XMA7G",22,0)
 I "Yy"'[$S($L(X):$E(X),1:1) G JOIN
"RTN","XMA7G",23,0)
 S DA(1)=+Y,DA=$O(^XMB(3.8,+Y,1,"B",XMA0,0)),DIK="^XMB(3.8,"_+Y_",1,"
"RTN","XMA7G",24,0)
 D ^DIK K DIK,DA
"RTN","XMA7G",25,0)
 W !,"You are no longer a member.",! G JOIN
"RTN","XMA7G",26,0)
 ;
"RTN","XMA7G",27,0)
ENT ;E/E PERSONAL GROUP
"RTN","XMA7G",28,0)
 W !! S DIC="^XMB(3.8,",DIC(0)="AEQMZL",DLAYGO=3.8
"RTN","XMA7G",29,0)
 S DIC("S")="I $P(^(0),U,2)=""PR"",$D(^XMB(3.8,+Y,3)),$P(^(3),U)=$S($D(XMDUZ):XMDUZ,1:DUZ)"
"RTN","XMA7G",30,0)
 D ^DIC I Y<0!(U[X) K DIC,DR,DIE,DIDEL Q
"RTN","XMA7G",31,0)
 S (DIDEL,DIE)=3.8,DA=+Y
"RTN","XMA7G",32,0)
 S DR="4////PR;5////"_$S($D(XMDUZ):XMDUZ,1:DUZ)_";7////n;.01T;2;10////1"
"RTN","XMA7G",33,0)
 S:$P(^XMB(1,1,0),U,19) DR=DR_";14;15"
"RTN","XMA7G",34,0)
 D ^DIE
"RTN","XMA7G",35,0)
 G ENT
"RTN","XMA7G",36,0)
LAYGO(X) ; Prevent someone from adding a (private) group with the same name as a public one.
"RTN","XMA7G",37,0)
 ; This function is invoked by the LAYGO field of ^XMB(3.8,.01)
"RTN","XMA7G",38,0)
 ; Returns 1 if group X may be created; 0 if not.
"RTN","XMA7G",39,0)
 N IEN,LAYGO
"RTN","XMA7G",40,0)
 S IEN="",LAYGO=1
"RTN","XMA7G",41,0)
 F  S IEN=$O(^XMB(3.8,"B",X,IEN)) Q:IEN=""  D  Q:'LAYGO
"RTN","XMA7G",42,0)
 . Q:$P(^XMB(3.8,IEN,0),U,2)="PR"
"RTN","XMA7G",43,0)
 . S LAYGO=0
"RTN","XMA7G",44,0)
 . D EN^DDIOL("Can't add it because public group '"_X_"' already exists.","","!,*7")
"RTN","XMA7G",45,0)
 Q LAYGO
"RTN","XMA7G",46,0)
ASL ;SHOW
"RTN","XMA7G",47,0)
 S Y=0 W !!,"To send mail to this group, forward it to an authorized sender:",!
"RTN","XMA7G",48,0)
ASL1 S Y=$O(^XMB(3.8,I,4,"B",Y)) Q:+Y'>0  S X1=Y D USER^XMA W ?5,X1,! G ASL1
"RTN","XMA7G",49,0)
 Q
"RTN","XMA7G",50,0)
MSG S XMSUBJ="New Member added.",X(1,0)=XMDUN_" Has joined the "_$P(Y,U,2)_" Group.",XMTEXT="X(",^TMP("XMY",$J,"G."_$P(Y,U,2))=""
"RTN","XMA7G",51,0)
 D ENX^XMD Q
"RTN","XMA7G",52,0)
ORG I $D(^XMB(3.8,X,3)) W:^(3)=Y " (Organizer)"
"RTN","XMA7G",53,0)
 W ?40,$S((J="PR"):"(Private)",1:"(Public)") Q
"RTN","XMAD1")
0^21^B11559477
"RTN","XMAD1",1,0)
XMAD1 ;(WASH ISC)/CAP-MailMan Deliver (3.9 File) ;01/15/97  09:44
"RTN","XMAD1",2,0)
 ;;7.1;MailMan;**24,27,36**;Jun 02, 1994
"RTN","XMAD1",3,0)
 ;
"RTN","XMAD1",4,0)
 ;XMAD1F = ARRAY OF RECIPIENTS IF FORWARDING MESSAGE
"RTN","XMAD1",5,0)
 ;XMCHAN= DEFINED ONLY IF COMING FROM NETWORKING
"RTN","XMAD1",6,0)
 ;XME0 = SPECIAL FLAG FOR FILER = BROADCASTING
"RTN","XMAD1",7,0)
 ;XMFF = DEFINED ONLY IF FORWARDING MESSAGE
"RTN","XMAD1",8,0)
 ;XMLOCK= LIST OF KEYS IF USER IS ALLOWED...
"RTN","XMAD1",9,0)
 ;^TMP("XMY",$J,duz) = Node set for each recipient
"RTN","XMAD1",10,0)
 ;^TMP("XMY",$J,XMDUZ,0) = Basket_Name will deliver the message to
"RTN","XMAD1",11,0)
 ;    a particular basket, but only for the sender
"RTN","XMAD1",12,0)
 ;
"RTN","XMAD1",13,0)
 ;FILE XMY ARRAY INTO RECIPIENT LIST
"RTN","XMAD1",14,0)
 ;
"RTN","XMAD1",15,0)
 ;SET UP XMBPOST("POST"... FOR FORWARDED MESSAGES
"RTN","XMAD1",16,0)
 ;
"RTN","XMAD1",17,0)
ENT ;FROM XMD - ^TMP("XMY",$J,) RECIPIENTS (XMFF IS NOT DEFINED)
"RTN","XMAD1",18,0)
 ;FROM XMA1 - FORWARD TO ^TMP("XMY",$J,) RECIPIENTS (XMFF IS DEFINED)
"RTN","XMAD1",19,0)
 ;
"RTN","XMAD1",20,0)
 D FINAL^XMAD1X
"RTN","XMAD1",21,0)
 ;
"RTN","XMAD1",22,0)
 Q:+XMZ=0  Q:'$D(^XMB(3.9,XMZ,0))  S XMR=^(0)
"RTN","XMAD1",23,0)
 I '$P(XMR,U,3),'$D(XMCHAN),'$D(XMFF) D T S ^XMB(3.9,XMZ,0)=XMR
"RTN","XMAD1",24,0)
 ;
"RTN","XMAD1",25,0)
 K XMQ,XMAD1F S I=0,Y=0,%=$E($G(XMDUZ),1,60),XME0=$S(%="":"",$D(^TMP("XMY",$J,%,0)):"^^"_^(0),1:""),XMLOCK=$S($D(^XMB(3.9,XMZ,4)):^(4),1:"")
"RTN","XMAD1",26,0)
L I '$D(XMREMID) L +^XMB(3.9,XMZ):0 E  H 1 G L:$D(XMCHAN),L:$D(ZTQUEUED) W:I=0 !,*7,"WAITING for another user to transmit this message.  Enter '^' to abort: " R X:0 Q:X?1"^".E  S I=1 G L
"RTN","XMAD1",27,0)
 K Y2 S XMF0=$S($D(^XMB(3.9,XMZ,1,0)):^(0),1:"")
"RTN","XMAD1",28,0)
 L +^XMB("POSTDONE",XMZ)
"RTN","XMAD1",29,0)
 F XMB0=0:0 S XMAD1Y=$O(^TMP("XMY",$J,"")) Q:XMAD1Y=""  S Y=XMAD1Y D ^XMAD1A K ^TMP("XMY",$J,XMAD1Y)
"RTN","XMAD1",30,0)
 S ^XMB(3.9,XMZ,1,0)="^3.91LA^"_($P(XMF0,U,3)+XMB0)_U_($P(XMF0,U,4)+XMB0)
"RTN","XMAD1",31,0)
 S Y=$S('$D(XMDUZ):DUZ,XMDUZ=.6:DUZ,1:XMDUZ),$P(XME0,U)=$S('$D(XMB("TYPE")):Y,XMB("TYPE")=2:"",1:Y)
"RTN","XMAD1",32,0)
 I $S($D(XMFF)&$O(XMAD1F(0)):1,'$D(XMFF):1,$P(XME0,U,2)="* LOCAL BROADCAST":1,1:0) S:'$D(XMNETREC) ^XMBPOST("POST",XMZ)=$S($D(XMFF):XME0,$D(XMAD1F(0)):XME0,1:$P(XME0_"^^^^^^^",U,1,8)_"^DONE") S Y2=$P($G(^XMB(3.9,XMZ,1,0)),U,3) G B:'Y2
"RTN","XMAD1",33,0)
 ;
"RTN","XMAD1",34,0)
 ;Force Broadcasts into delivery queue w/most rcpts.
"RTN","XMAD1",35,0)
 I $P(XME0,U,2)="* LOCAL BROADCAST" S Y=$G(^XMBPOST("POST",XMZ,0)),$P(Y,U,7,9)=$H*86400+$P($H,",",2)_"^9999999^DONE",^(0)=Y G B
"RTN","XMAD1",36,0)
 ;
"RTN","XMAD1",37,0)
 I $D(^XMB(3.9,XMZ,1,"AFAX")) D FAX^XMFAX(XMZ)
"RTN","XMAD1",38,0)
 ;Done if this is not a forwarded message
"RTN","XMAD1",39,0)
 I '$D(XMFF)!'$O(XMAD1F(0)) G B:$D(XMNETREC),B:'$O(XMAD1F(0)),A
"RTN","XMAD1",40,0)
 S Y=0 F I=0:0 S I=$O(^XMBPOST("POST",XMZ,I)) Q:I=""  S Y=I
"RTN","XMAD1",41,0)
 S Y2=0 F I=0:0 S I=$O(XMAD1F(I)) Q:'I  S ^XMBPOST("POST",XMZ,I+Y)=XMAD1F(I),Y2=Y2+$L(XMAD1F(I),"^")
"RTN","XMAD1",42,0)
A S Y1=$G(^XMBPOST("POST",XMZ,0)),$P(Y1,U,7,9)=$H*86400+$P($H,",",2)_"^"_$S($D(Y2):Y2,1:$P($G(^XMB(3.9,XMZ,1,0)),U,3))_"^DONE",^XMBPOST("POST",XMZ,0)=Y1
"RTN","XMAD1",43,0)
B I '$D(XMREMID) L -^XMB(3.9,XMZ)
"RTN","XMAD1",44,0)
 L -^XMB("POSTDONE",XMZ)
"RTN","XMAD1",45,0)
 K XMA0,XMAD,XMAD1Y,XMB,XMB0,XMAD1F,XMD0,XME0,XMF0,XMLOCK,XMQ,XMINST,XMSITE,XMTSK
"RTN","XMAD1",46,0)
 K Y1,Y2,Y3
"RTN","XMAD1",47,0)
 ;
"RTN","XMAD1",48,0)
 ;START BACKGROUND FILER
"RTN","XMAD1",49,0)
C ;I $P($G(^XMB(1,1,0)),U,16) G OFF^XMAD2
"RTN","XMAD1",50,0)
 D ENTL^XMADGO1 Q
"RTN","XMAD1",51,0)
 ;
"RTN","XMAD1",52,0)
 ;ENTRY TO KILL XMY WHEN DONE
"RTN","XMAD1",53,0)
ENT1 ;FROM XMB,XMR1,XMD
"RTN","XMAD1",54,0)
 I $D(XMREMID),$L(XMREMID) L +(^XMBX(3.9,"AI",$E(XMREMID,1,64)),^XMB(3.9,XMZ)) D D L -(^XMBX(3.9,"AI",$E(XMREMID,1,64)),^XMB(3.9,XMZ)) Q
"RTN","XMAD1",55,0)
D D ENT K XMY,XMY0,^TMP("XMY",$J),^TMP("XMY0",$J) Q
"RTN","XMAD1",56,0)
 ;
"RTN","XMAD1",57,0)
T ;PUT INTO MESSAGE
"RTN","XMAD1",58,0)
 D NOW^%DTC S $P(XMR,U,3)=%
"RTN","XMAD1",59,0)
 Q
"RTN","XMAD1A")
0^8^B9156631
"RTN","XMAD1A",1,0)
XMAD1A ;(WASH ISC)/CAP-MailMan Deliver (3.9 File) ;01/10/97  11:24
"RTN","XMAD1A",2,0)
 ;;7.1;MailMan;**36**;Jun 02, 1994
"RTN","XMAD1A",3,0)
 ;
"RTN","XMAD1A",4,0)
 ;Process each ^TMP("XMY",$J,) -- ^TMP("XMY",$J,,0)=Basket -- ^TMP("XMY",$J,,"D")=Delete Date
"RTN","XMAD1A",5,0)
 ;
"RTN","XMAD1A",6,0)
D1 I '$D(ZTQUEUED),'$D(XMCHAN),XMDUZ'=.5 W "."
"RTN","XMAD1A",7,0)
 S (XMD0,ER)=0,XMB0=XMB0+1
"RTN","XMAD1A",8,0)
 I $L(XMLOCK),Y'["@" D SEC I ER S XMB0=XMB0-1 Q
"RTN","XMAD1A",9,0)
 S I=$O(^XMB(3.9,XMZ,1,"C",Y,0))
"RTN","XMAD1A",10,0)
 ;
"RTN","XMAD1A",11,0)
 I I S %=^TMP("XMY",$J,Y) D XMFF K ^XMB(3.9,XMZ,1,I,"D") S XMB0=XMB0-1 G:".S.s."'[$E("."_Y_" ",1,3) DQ:Y'["@" D MRK,^XMS1 Q
"RTN","XMAD1A",12,0)
 I Y["@",^TMP("XMY",$J,Y)="" S X=Y,XMN=0 D INST^XMA21A W:Y<1&'$D(XMDF)&'$D(ZTQUEUED) !,"NETWORK ADDRESS ERROR: (",Y,") " W:$D(XMMG)&'$D(XMDF)&'$D(ZTQUEUED) XMMG K Y1,Y2,Y3,XMMG,XMANS,XMAGS S Y=XMAD1Y
"RTN","XMAD1A",13,0)
 S K=Y_$S(Y["@":"^^^^^Awaiting transmission."_U_^TMP("XMY",$J,Y),"S.s."[$E(Y_1,1,2):"^^^^^Awaiting Server","D.d."[$E(Y_1,1,2):"^^^^^Awaiting Device.","F.f."[$E(Y_1,1,2):"^^^^^Awaiting Fax",1:"")
"RTN","XMAD1A",14,0)
 ;
"RTN","XMAD1A",15,0)
 ;Default Priority Response Delivery
"RTN","XMAD1A",16,0)
 I +Y,$P(XMR,U,7)["P" S $P(K,U,9)=+$P($G(^XMB(3.7,Y,0)),U,11)
"RTN","XMAD1A",17,0)
 S:+XMB0=0 XMB0=1
"RTN","XMAD1A",18,0)
 F XMB0=XMB0:1 I '$D(^XMB(3.9,XMZ,1,$P(XMF0,U,3)+XMB0,0)) D  Q
"RTN","XMAD1A",19,0)
 . N I S I=$P(XMF0,U,3)+XMB0
"RTN","XMAD1A",20,0)
 . I $E(Y,1,2)="F." S $P(K,U,11)=^TMP("XMY",$J,Y),^XMB(3.9,XMZ,1,"AFAX",^TMP("XMY",$J,Y),I)=""
"RTN","XMAD1A",21,0)
 . S ^XMB(3.9,XMZ,1,I,0)=K D XMFF
"RTN","XMAD1A",22,0)
 . I Y["@",$P(K,U,7) S ^XMB(3.9,XMZ,1,"AQUEUE",$P(K,U,7),I)=""
"RTN","XMAD1A",23,0)
 . S ^XMB(3.9,XMZ,1,"C",Y,I)=""
"RTN","XMAD1A",24,0)
 . Q:'$D(^TMP("XMY",$J,Y,1))
"RTN","XMAD1A",25,0)
 . S ^XMB(3.9,XMZ,1,I,"T")=^TMP("XMY",$J,Y,1)
"RTN","XMAD1A",26,0)
 . Q
"RTN","XMAD1A",27,0)
 I '$D(XMCHAN) G:Y?1"*".E BRO
"RTN","XMAD1A",28,0)
 I Y["@"!("^D.^S.^"[(U_$$UP^XLFSTR($E(Y,1,2))_U)) D ^XMS1 S Y=XMAD1Y Q
"RTN","XMAD1A",29,0)
DQ I '$D(XMFF),$D(^TMP("XMY",$J,Y,0)) S ^XMBPOST("POST",XMZ,0,Y)=^TMP("XMY",$J,Y,0)_$S($D(^TMP("XMY",$J,Y,"D")):":"_^TMP("XMY",$J,Y,"D"),1:"") Q
"RTN","XMAD1A",30,0)
 S:'$D(XMAD1F) XMAD1F=1 S:$D(^TMP("XMY",$J,Y,0)) Y=Y_":"_^TMP("XMY",$J,Y,0) S:$D(^TMP("XMY",$J,+Y,"D")) $P(Y,":",3)=^TMP("XMY",$J,+Y,"D")
"RTN","XMAD1A",31,0)
 S K=$S($D(XMAD1F(XMAD1F)):XMAD1F(XMAD1F),1:Y) I K'=Y S K=K_U_Y
"RTN","XMAD1A",32,0)
 I $L(K)>200 S K=Y,XMAD1F=XMAD1F+1
"RTN","XMAD1A",33,0)
 S XMAD1F(XMAD1F)=K
"RTN","XMAD1A",34,0)
 Q
"RTN","XMAD1A",35,0)
 ;
"RTN","XMAD1A",36,0)
SEC S ER=0 Q:$L(XMLOCK)=0
"RTN","XMAD1A",37,0)
 F K=1:1 S J=$P(XMLOCK,",",K) Q:J=""  I '$D(^XUSEC(J,Y)) S ER=1 Q
"RTN","XMAD1A",38,0)
 Q
"RTN","XMAD1A",39,0)
BRO ;BROADCAST TO ALL LOCAL USERS
"RTN","XMAD1A",40,0)
 W !,"Broadcasting now..." S $P(XME0,U,2)="* LOCAL BROADCAST"
"RTN","XMAD1A",41,0)
 Q
"RTN","XMAD1A",42,0)
XMFF I $D(XMFF),'$L($G(^XMB(3.9,XMZ,1,I,"F"))) S ^("F")=XMFF
"RTN","XMAD1A",43,0)
 Q
"RTN","XMAD1A",44,0)
MRK ;Mark Recipient
"RTN","XMAD1A",45,0)
 N A S K=$P(^XMB(3.9,XMZ,1,I,0),U,7),A=$S(%:%,1:K),$P(^(0),U,6,7)="Queued for Transmission^"_A
"RTN","XMAD1A",46,0)
 I A S ^XMB(3.9,XMZ,1,"AQUEUE",A,I)=""
"RTN","XMAD1A",47,0)
 Q
"RTN","XMAH0")
0^7^B1959040
"RTN","XMAH0",1,0)
XMAH0 ;(WASH ISC)/CAP/THM- MISC Basket Control ;09/11/96  14:32
"RTN","XMAH0",2,0)
 ;;7.1;MailMan;**36**;Jun 02, 1994
"RTN","XMAH0",3,0)
DEL ;DELETE RANGE FROM XMA0
"RTN","XMAH0",4,0)
 W !,"Do you really want to ",$S($P(XMTYPE,";")["T":"terminate",1:"delete")," these messages? NO// " R X:DTIME I '$T S $P(XMTYPE,";",3)="" Q
"RTN","XMAH0",5,0)
 I X["?" G ENT5^XMAH
"RTN","XMAH0",6,0)
 I $E(X)="Y"!($E(X)="y") W " ",$S($P(XMTYPE,";")["T":"terminating",1:"deleting"),"..." Q
"RTN","XMAH0",7,0)
 S $P(XMTYPE,";",3)=""
"RTN","XMAH0",8,0)
 Q
"RTN","XMAH0",9,0)
NO ;%=INPUT / 1=NO ACCESS CODE 10=NO MAILBOX 11=NEITHER
"RTN","XMAH0",10,0)
 W !,*7,"You do not have " W:%#10 "an access code" W:%>9 $S(%#10:" nor a ",1:"")_"mail box" W ".",!,"MailMan will not deliver messages to you. "
"RTN","XMAH0",11,0)
 Q
"RTN","XMAI2")
0^16^B2260662
"RTN","XMAI2",1,0)
XMAI2 ;(WASH ISC)/CAP/L.RHODE - SENDS A BULLETIN 4 TOO MANY MESSAGES; ;12/13/96  08:46
"RTN","XMAI2",2,0)
 ;;7.1;MailMan;**36**;Jun 02, 1994
"RTN","XMAI2",3,0)
 ;MODIFIED WJW HINES-ISC to make queable
"RTN","XMAI2",4,0)
STAT ;DISPLAY STATISTICS
"RTN","XMAI2",5,0)
 S XMC0=500 ; Thresh-hold number of messages a user can own
"RTN","XMAI2",6,0)
 ;
"RTN","XMAI2",7,0)
CHECK N E,G,H,XMA0,XMDUZ S XMA0=.9999,XMDUZ="<System-Maintenance-XMAI2>"
"RTN","XMAI2",8,0)
 F  S XMA0=$O(^XMB(3.7,XMA0)) Q:+XMA0=0  S E=.9999,G=0,H=0 D
"RTN","XMAI2",9,0)
 . F  S E=$O(^XMB(3.7,XMA0,2,E)) Q:+E=0  S G=G+$P($G(^(E,0)),U,5) I E=1 S H=G
"RTN","XMAI2",10,0)
 . I G>XMC0 D BULL
"RTN","XMAI2",11,0)
 . Q
"RTN","XMAI2",12,0)
 Q
"RTN","XMAI2",13,0)
 ;
"RTN","XMAI2",14,0)
BULL ;send bulletin
"RTN","XMAI2",15,0)
 N B S B=XMA0 N %,A,XMA0,XMC0,XMTEXT,XMY
"RTN","XMAI2",16,0)
 S %=$P($G(^VA(200,B,0)),U),A=$P(%,",",2) I $E(A)=" " S A=$E(A,2,999)
"RTN","XMAI2",17,0)
 S XMTEXT(1)=A_" "_$P(%,",")_": You have at least "_G
"RTN","XMAI2",18,0)
 S XMTEXT(2)="messages in mail baskets."
"RTN","XMAI2",19,0)
 I H S XMTEXT(2)=XMTEXT(2)_" ("_H_" in your IN basket)"
"RTN","XMAI2",20,0)
 S XMTEXT(3)="Please terminate all of your unnecessary messages."
"RTN","XMAI2",21,0)
 S XMTEXT(4)=""
"RTN","XMAI2",22,0)
 S XMTEXT(5)="Thanks"
"RTN","XMAI2",23,0)
 S XMTEXT(6)=" "
"RTN","XMAI2",24,0)
 S XMTEXT="XMTEXT(",XMDUZ=.5,XMSUB="DELETE OLD MAIL MESSAGES",XMY(B)=""
"RTN","XMAI2",25,0)
 D ^XMD
"RTN","XMAI2",26,0)
 Q
"RTN","XMAP")
0^11^B19073795
"RTN","XMAP",1,0)
XMAP ;(WASH ISC)/CAP-MESSAGE DISPLAY ;10/31/96  09:22
"RTN","XMAP",2,0)
 ;;7.1;MailMan;**24,36**;Jun 02, 1994
"RTN","XMAP",3,0)
ENTPRT ;
"RTN","XMAP",4,0)
 S XMA0=$S('$D(XMTYPE):"",1:$P(XMTYPE,";",6)) S:'$D(XMP) XMP=1
"RTN","XMAP",5,0)
ENTCRT ;
"RTN","XMAP",6,0)
 G INIT^XMAP0
"RTN","XMAP",7,0)
U D ^XMAP1 I $S($G(XMINST)=XMK:1,$D(XMA5("HDR")):1,1:0) Q
"RTN","XMAP",8,0)
4 W $S('$D(^XMB(3.7,XMDUZ,"N0",XMK,I)):"",$P(%,U,7)["P":"  +Priority+",1:"  **NEW**")
"RTN","XMAP",9,0)
 I $P(%,U,7)="S" W !!,"<<<<< SPOOLED DOCUMENT - CAN BE 'NEW'ed, 'DELETE'd or 'LATER'd ONLY >>>>>",! G B
"RTN","XMAP",10,0)
 D LINE
"RTN","XMAP",11,0)
 I $D(ZTQUEUED) G Q^XMAP0:XMS
"RTN","XMAP",12,0)
 I $D(XMKEY),XMKEY="^" S X="^" G END^XMAP0
"RTN","XMAP",13,0)
5 S XMB0=I G:XMA0 M:XMP,K S XMA0=%1 W ! D S
"RTN","XMAP",14,0)
 I $P(%1,U,2),'XMP,$S($D(XMF0)#10=0:1,'XMF0:1,1:0) S X=$P(%1,U,3) I X G I:%1-X'=0,J
"RTN","XMAP",15,0)
 ;TEXT
"RTN","XMAP",16,0)
 S XMJ=.999
"RTN","XMAP",17,0)
F S XMJ=$O(^XMB(3.9,XMB0,2,XMJ))
"RTN","XMAP",18,0)
 I IOSL-5<$Y!$S(XMJ:0,IOSL-6'<$Y:0,'$D(^XMB(3.9,XMZ,3)):0,1:1) D P,S W !,@IOF G I:$D(DTOUT)!$D(DUOUT) I XMP'=2 D ^XMAP1,LINE
"RTN","XMAP",19,0)
 G I:'XMJ S XMC0=^XMB(3.9,XMB0,2,XMJ,0) I XMC0'="",$F("$TXT$END",$E(XMC0,1,4))#4=1 S XMC0=$P(XMC0,U)
"RTN","XMAP",20,0)
 S (X,Y)=XMC0
"RTN","XMAP",21,0)
 D C:XMS=1,L G F
"RTN","XMAP",22,0)
I I $D(XMF0) S XMA0=.9 G K
"RTN","XMAP",23,0)
M I 'XMP,$P(XMA0,U,3)-XMA0<0 G J
"RTN","XMAP",24,0)
 I XMP S XMA0=$P(XMTYPE,";",6)-1 S:XMA0<0 XMA0=0
"RTN","XMAP",25,0)
K S XMD0=+XMA0 D N I 'XMP S XMA0=$S(+XMA0:+XMA0,1:.9)
"RTN","XMAP",26,0)
 S XMD0=""
"RTN","XMAP",27,0)
R S XMA0=$O(^XMB(3.9,XMB0,3,XMA0)) G RQ:'XMA0 G:$D(XMF0) RQ:XMA0>XMF0 S XME0=^(XMA0,0),XMAP0R=XMA0
"RTN","XMAP",28,0)
 G:'$D(^XMB(3.9,XME0,0)) R I IOSL-5<$Y D P G RQ:$D(DTOUT)!$D(DUOUT) W !,@IOF I XMP'=2 S XMHOLD=XMA0 D ^XMAP1,LINE S XMA0=XMHOLD K XMHOLD
"RTN","XMAP",29,0)
 S %3=^XMB(3.9,XME0,0) W !!,XMA0,") " D S,S
"RTN","XMAP",30,0)
 S %2=$P(%3,U,2) D W W:$L(%2) %2 S %2=$P(%3,U,4)
"RTN","XMAP",31,0)
 I $L(%2) D W,X W " (Sender: ",%2,")"
"RTN","XMAP",32,0)
 S (Y,X)=$P(%3,U,3) D D,X W "    ",X S %2=0
"RTN","XMAP",33,0)
 I $D(^XMB(3.9,XME0,2,0)) S %2=$P(^(0),U,4)
"RTN","XMAP",34,0)
 D X W "  ",%2," Line" W:%2'=1 "s" S %2=$P(%3,U)
"RTN","XMAP",35,0)
 I %2'?1"R".N D X W "  SUBJECT: ",%2
"RTN","XMAP",36,0)
ENT S XMJ=.999 W ! D S
"RTN","XMAP",37,0)
G S XMJ=$O(^XMB(3.9,XME0,2,XMJ)) G R:'XMJ S XMC0=^(XMJ,0)
"RTN","XMAP",38,0)
 I IOSL-5<$Y D P W !,@IOF G RQ:$D(DTOUT)!$D(DUOUT) I XMP'=2 S XMHOLD=XMA0 D ^XMAP1,LINE S XMA0=XMHOLD K XMHOLD
"RTN","XMAP",39,0)
 S X=XMC0 I XMS=1 S Y=X D C
"RTN","XMAP",40,0)
 D L G G
"RTN","XMAP",41,0)
RQ K XME0,XMC0 D PRT^XMAPBLOB
"RTN","XMAP",42,0)
 G J:XMDUZ=.6
"RTN","XMAP",43,0)
 S X=$O(^XMB(3.9,XMZ,1,"C",$S(XMDUZ=.6:DUZ,1:XMDUZ),0)) I 'X G J
"RTN","XMAP",44,0)
RZ S XMA0=$S($D(^XMB(3.9,XMZ,1,X,0)):^(0),1:$S(XMDUZ=.6:DUZ,1:XMDUZ))
"RTN","XMAP",45,0)
 I $S('$D(XMAP0R):1,XMDUZ=.6:1,1:0) S XMAP0R=""
"RTN","XMAP",46,0)
 I $P(XMA0,U,2)<XMAP0R,XMAP0R'<1 S $P(XMA0,U,2)=XMAP0R
"RTN","XMAP",47,0)
 S ^XMB(3.9,XMZ,1,X,0)=XMA0
"RTN","XMAP",48,0)
J W ! D S,NEW^XMA:XMDUZ'=.6 S X=$O(^XMB(3.7,"M",XMZ,XMDUZ,0))
"RTN","XMAP",49,0)
 I X'="",$D(^XMB(3.7,XMDUZ,2,X,1,XMZ,0)) S $P(^(0),U,4)=DT
"RTN","XMAP",50,0)
 ;
"RTN","XMAP",51,0)
 ;Display BLOB listing
"RTN","XMAP",52,0)
B ;
"RTN","XMAP",53,0)
 S X="" I 'XMP,'$D(XMCOPY),'$D(XMBCK),'$D(ZTQUEUED) S XMAP("ASKED")=0 D CBASK^XMA1 K:'$G(XMAP("ASKED")) XMAP("ASKED")
"RTN","XMAP",54,0)
QQ G END^XMAP0
"RTN","XMAP",55,0)
L ;WRITE LINE
"RTN","XMAP",56,0)
O S %4=$F(X,"|TAB|")-6
"RTN","XMAP",57,0)
 I %4'<0 S X=$E(X,1,%4)_$E("         ",1,9-(%4-(%4\9*9)))_$E(X,%4+6,999) G O
"RTN","XMAP",58,0)
 W !,$E(X,1,IOM-1) D S Q:$L(X)<IOM  S X=$E(X,IOM,999) G L
"RTN","XMAP",59,0)
 ;GET USER FROM %
"RTN","XMAP",60,0)
W Q:%2=""  D DSP^XM:'$D(XMDISPI)
"RTN","XMAP",61,0)
 Q:$S(%2'=+%2:1,'$D(^VA(200,%2,0)):1,1:0)  N %,I S %=%2,I=^(0),%2=$P(I,U)
"RTN","XMAP",62,0)
 I $P(XMDISPI,U)["T",$P(I,U,9) S I=$G(^DIC(3.1,$P(I,U,9),0)) I $L($P(I,U)) S %2=%2_" - "_$P(I,U)
"RTN","XMAP",63,0)
 I $P(XMDISPI,U)["I",$G(^XMB(3.7,%,6000))'="" S %2=%2_" ("_$P(^(6000),U)_")"
"RTN","XMAP",64,0)
 Q
"RTN","XMAP",65,0)
P I $D(IO(0)) Q:IO(0)'=IO&$L(IO)
"RTN","XMAP",66,0)
 Q:$E(IOST)'="C"  K DIR S DIR(0)="E" D ^DIR K DIRUT Q
"RTN","XMAP",67,0)
ENTR ;RESP HEADER
"RTN","XMAP",68,0)
 S DIR(0)="E",%3=0
"RTN","XMAP",69,0)
H S %3=$O(^XMB(3.9,XMZ,3,%3)) G HQ:'%3 S XMA0=^(%3,0)
"RTN","XMAP",70,0)
 I $Y+4>IOSL S XMHOLD=%3_U_XMA0 D P G HQ:$D(DUOUT)!$D(DTOUT) W:XMP=0 # W:XMP @IOF D:XMP'=2&XMP ^XMAP1,LINE S %3=+XMHOLD,XMA0=$P(XMHOLD,U,2,99) K XMHOLD
"RTN","XMAP",71,0)
 G H:'$D(^XMB(3.9,XMA0,0)) S %=^(0),%2=$P(%,U,2),X=$P(%,U,3),%1=0 I $D(^(2,0)) S %1=$P(^(0),U,4)
"RTN","XMAP",72,0)
 D W,S W !,%3,") From: ",%2,"  " D D,X W X D X
"RTN","XMAP",73,0)
 W "   ",%1," Line" W:%1'=1 "s" G H
"RTN","XMAP",74,0)
HQ K %,%1,%2,XMA0 Q
"RTN","XMAP",75,0)
D Q:X<20000  S Y=$E(X,6,7)_" "_$P("Jan^Feb^Mar^Apr^May^Jun^Jul^Aug^Sep^Oct^Nov^Dec",U,$E(X,4,5))_" "_$E(X,2,3) S:X\1'=X %2=$P(X,".",2)_"0000",Y=Y_" "_$E(%2,1,2)_":"_$E(%2,3,4) S X=Y
"RTN","XMAP",76,0)
 Q
"RTN","XMAP",77,0)
ENTBCK ;BACK-UP
"RTN","XMAP",78,0)
 K XMAP0R S XMP=0,XMA0=XMA0_"B" W @IOF D:XMA0 ^XMAP1,LINE D N G ENTCRT:'XMA0
"RTN","XMAP",79,0)
 D SCRAM^XMAP0 I I=1 Q:XMKEY=U
"RTN","XMAP",80,0)
 S XMA0=XMA0-1 G R
"RTN","XMAP",81,0)
N S XMF0=$S($D(^XMB(3.9,XMZ,3,0)):$P(^(0),U,3),1:0) Q
"RTN","XMAP",82,0)
C I '$D(XMSEC) D ENT^XME1
"RTN","XMAP",83,0)
 S Y="" F I=1:1:$L(X) S Y=Y_$E(XMSEC(I#XMCL+1),$A(X,I)-31)
"RTN","XMAP",84,0)
 S X=Y Q
"RTN","XMAP",85,0)
LINE W !,"------------------------------------------------------------------------------"
"RTN","XMAP",86,0)
 D S
"RTN","XMAP",87,0)
S S XMAPLCNT=$G(XMAPLCNT)+1 Q
"RTN","XMAP",88,0)
X Q:$X+12+$L(%2)'>IOM  W ! D S Q
"RTN","XMAPHOST")
0^17^B12822637
"RTN","XMAPHOST",1,0)
XMAPHOST ;(WASH ISC)/KMB/CAP-PRINT TO MESSAGE (P-MESSAGE) ;12/13/96  08:50
"RTN","XMAPHOST",2,0)
 ;;7.1;MailMan;**7,14,27,36**;Sep 12, 1994
"RTN","XMAPHOST",3,0)
 ;
"RTN","XMAPHOST",4,0)
 ;This routine is called as a close execute for the P-Message device
"RTN","XMAPHOST",5,0)
 ;to put reports written to host files (DOS,VMS...) into mail messages.
"RTN","XMAPHOST",6,0)
 ;
"RTN","XMAPHOST",7,0)
 ;It has one idiosyncracy.  If the report contains one single line
"RTN","XMAPHOST",8,0)
 ;or two lines separated with only a $C(13) instead of a CR/LF that is
"RTN","XMAPHOST",9,0)
 ;more than 254 characters long, there will be unexpected results.
"RTN","XMAPHOST",10,0)
 ;
"RTN","XMAPHOST",11,0)
 ;
"RTN","XMAPHOST",12,0)
 K ^TMP("XMY",$J),^TMP("XMY0",$J) I '$D(ZTQUEUED) K XMY,XMY0
"RTN","XMAPHOST",13,0)
 S Y=0
"RTN","XMAPHOST",14,0)
 N XMDUZ S XMDUZ=DUZ I '$G(XMDUZ) S XMDUZ=.5 I '$D(ZTQUEUED) U IO(0) W !!,*7,"No user identity.  Using Postmaster as sender and receiver." U IO
"RTN","XMAPHOST",15,0)
 S %=$G(XMSUB) N XMXUSEC,XMSUB,XMR S XMSUB=%
"RTN","XMAPHOST",16,0)
 I '$D(^XMB(3.7,$S($D(XMDUZ):XMDUZ,1:DUZ))),'$D(ZTQUEUED) U IO(0) W !,*7,"You do not have a mail box.  MailMan will not deliver messages to you." U IO
"RTN","XMAPHOST",17,0)
 I '$D(ZTQUEUED) U IO(0) W !!,"Moving text to MailMan message... (Creating now) " U IO
"RTN","XMAPHOST",18,0)
 N XMZ D DUN S XMSUB=$S($L($G(XMSUB))>3:XMSUB,$D(ZTQUEUED):"QUEUED MAIL REPORT FROM "_%,1:"")
"RTN","XMAPHOST",19,0)
 I '$D(ZTQUEUED) D 0
"RTN","XMAPHOST",20,0)
 D GET^XMA2
"RTN","XMAPHOST",21,0)
 S XMAPHOST("XMZ")=XMZ,XMAPHOST("XMSUB")=XMSUB
"RTN","XMAPHOST",22,0)
 Q
"RTN","XMAPHOST",23,0)
 ;
"RTN","XMAPHOST",24,0)
 ;Read the host file into a message, send it, erase it
"RTN","XMAPHOST",25,0)
READ ;Read record from file
"RTN","XMAPHOST",26,0)
 ;Each time <CR> is found in record it ends a message line
"RTN","XMAPHOST",27,0)
 N %,XMA0,XMB0,XMR,XMZ,Y
"RTN","XMAPHOST",28,0)
 I $$NEWERR^%ZTER N $ETRAP,$ESTACK S $ETRAP=""
"RTN","XMAPHOST",29,0)
 S X="EOF^XMAPHOST",@^%ZOSF("TRAP")
"RTN","XMAPHOST",30,0)
 S %=0,I=0,X="",XMZ=XMAPHOST("XMZ"),XMB0=^%ZOSF("OS")
"RTN","XMAPHOST",31,0)
 U IO F  D  G EOF:$G(XMAPHOST("EOF"))
"RTN","XMAPHOST",32,0)
 . S X=$$GET(),XMA0=$L(X) S:X="" %=%+1 Q:%>999!$G(XMAPHOST("EOF"))
"RTN","XMAPHOST",33,0)
 . I X[""!(%<9) F  D  Q:X=""!$G(XMAPHOST("EOF"))
"RTN","XMAPHOST",34,0)
 . . S I=$$PUT(XMZ,$P(X,$C(13)),I),X=$P(X,$C(13),2,999)
"RTN","XMAPHOST",35,0)
 . . I $L(X),XMA0>254 S X=X_$$GET(),XMA0=0
"RTN","XMAPHOST",36,0)
 . . Q
"RTN","XMAPHOST",37,0)
 . Q
"RTN","XMAPHOST",38,0)
 Q
"RTN","XMAPHOST",39,0)
PUT(XMZ,X,I) ;Put data into message.
"RTN","XMAPHOST",40,0)
 S I=I+1,^XMB(3.9,XMZ,2,I,0)=$$STRIP(X),%=0
"RTN","XMAPHOST",41,0)
 I '$D(ZTQUEUED),I#10=0 U IO(0) W "." U IO
"RTN","XMAPHOST",42,0)
 Q I
"RTN","XMAPHOST",43,0)
GET() ;Read a record from the file
"RTN","XMAPHOST",44,0)
 N Y,X
"RTN","XMAPHOST",45,0)
 G:$D(XMAPHOST("EOF")) GETR
"RTN","XMAPHOST",46,0)
 I $$NEWERR^%ZTER N $ETRAP,$ESTACK S $ETRAP=""
"RTN","XMAPHOST",47,0)
 S X="GETQ^XMAPHOST",@^%ZOSF("TRAP")
"RTN","XMAPHOST",48,0)
GETR R Y#255:1
"RTN","XMAPHOST",49,0)
 I XMB0["MSM" G GETQ:$ZC'=0 Q Y
"RTN","XMAPHOST",50,0)
 Q Y
"RTN","XMAPHOST",51,0)
GETQ S XMAPHOST("EOF")=1
"RTN","XMAPHOST",52,0)
 Q ""
"RTN","XMAPHOST",53,0)
EOF ;
"RTN","XMAPHOST",54,0)
 I '$$NEWERR^%ZTER S X="ERR^ZU",@^%ZOSF("TRAP")
"RTN","XMAPHOST",55,0)
 I '$D(ZTQUEUED) U IO(0) W !,"END OF FILE",!
"RTN","XMAPHOST",56,0)
 S ^XMB(3.9,XMAPHOST("XMZ"),2,0)="^3.92A^"_I_"^"_I
"RTN","XMAPHOST",57,0)
 ;Here, send the message to recipient.
"RTN","XMAPHOST",58,0)
 N XMZ S XMZ=XMAPHOST("XMZ") I $D(ZTQUEUED) S XMY($S($G(XMDUZ):XMDUZ,$G(DUZ):DUZ,1:.5))="" D REDO^XMA21 G FINAL
"RTN","XMAPHOST",59,0)
 ;Here, we ask the user for recipients.
"RTN","XMAPHOST",60,0)
 I '$D(ZTQUEUED) U IO(0) D DUN N DIC,XMDUZ,XMDUN S XMDUZ=$S(DUZ:DUZ,1:.5),XMDUN=% D DESTXM^XMA21 G FINAL
"RTN","XMAPHOST",61,0)
FINAL I '$D(^TMP("XMY",$J)) S TMP("XMY",$J,.5)="",^TMP("XMY0",$J,.5)=""
"RTN","XMAPHOST",62,0)
 D ENT^XMAD1
"RTN","XMAPHOST",63,0)
 I '$D(ZTQUEUED) U IO(0) W !,"Message subject: ",XMAPHOST("XMSUB"),", Message number: ",XMZ,! H 3
"RTN","XMAPHOST",64,0)
Q1 S IONOFF=1 ;Prevent form feed during device close
"RTN","XMAPHOST",65,0)
 K %,X,XMAPHOST,XMY,^TMP("XMY",$J),^TMP("XMY0",$J),Y,I Q
"RTN","XMAPHOST",66,0)
STRIP(X) ;Remove Control Characters
"RTN","XMAPHOST",67,0)
 N % S %=0 I X'?.ANP N % F %=1:1:$L(X) I $E(X,%)?1C S X=$E(X,1,%-1)_$E(X,%+1,999) Q:X?.ANP  S %=%-1
"RTN","XMAPHOST",68,0)
 Q X
"RTN","XMAPHOST",69,0)
DUN ;GET NAME IN %
"RTN","XMAPHOST",70,0)
 S %=$P($G(^VA(200,DUZ,0),"POSTMASTER"),U)
"RTN","XMAPHOST",71,0)
 Q
"RTN","XMAPHOST",72,0)
0 U IO(0) S XMAPHOST("XMSUB")=XMSUB D ENTS^XMA20
"RTN","XMAPHOST",73,0)
 I X'["^" S XMSUB=$S($L(X):X,1:XMAPHOST("XMSUB")) U IO Q
"RTN","XMAPHOST",74,0)
 W !!,"Sorry, I cannot stop the creation of this message at this point.",!,"You must enter a valid SUBJECT.",!
"RTN","XMAPHOST",75,0)
 G 0
"RTN","XMBGRP")
0^19^B17544691
"RTN","XMBGRP",1,0)
XMBGRP ;(WASH ISC)/JL,CAP-MAIL GROUP API ;01/21/97  13:10
"RTN","XMBGRP",2,0)
 ;;7.1;MailMan;**13,36**;Jun 02, 1994
"RTN","XMBGRP",3,0)
 ;XMY(#)=LOCAL MEMBERS
"RTN","XMBGRP",4,0)
 ;
"RTN","XMBGRP",5,0)
MG(A,B,C,D,XMY,XMTEXT,XMBGRP) ;Create or add members
"RTN","XMBGRP",6,0)
 ;
"RTN","XMBGRP",7,0)
 ;Usage:  S X=$$MG^XMBGRP(A,B,C,D,.E,.F,G)
"RTN","XMBGRP",8,0)
 ;
"RTN","XMBGRP",9,0)
 ;param1=NAME (If +A, then it is a pointer)
"RTN","XMBGRP",10,0)
 ;param2=TYPE [Public '0' or Private '1']
"RTN","XMBGRP",11,0)
 ;param3=Organizer
"RTN","XMBGRP",12,0)
 ;param4=allow self enrollment (+D>0 Yes; +D=0 No)
"RTN","XMBGRP",13,0)
 ;param5=rcpts of error messages (Array - Pass by reference)
"RTN","XMBGRP",14,0)
 ;param6=Description (Array - Pass by reference)
"RTN","XMBGRP",15,0)
 ;param7=silent flag
"RTN","XMBGRP",16,0)
 ;
"RTN","XMBGRP",17,0)
 N %,%1,DA,DIC,DIE,DR,DTOUT,DUOUT,X,Y,XMA0
"RTN","XMBGRP",18,0)
 ;
"RTN","XMBGRP",19,0)
 ;Mail Group already exists -- add new members
"RTN","XMBGRP",20,0)
 S XMA0=A,X=A I +A S DA=A D AM G QDA
"RTN","XMBGRP",21,0)
 ;
"RTN","XMBGRP",22,0)
 I B="" S B=0
"RTN","XMBGRP",23,0)
 I C="" S C=DUZ
"RTN","XMBGRP",24,0)
 I $L(A)<3 D ERR1 G Q0
"RTN","XMBGRP",25,0)
 I $L(A)>30 D ERR2 G Q0
"RTN","XMBGRP",26,0)
 I B'=0,B'=1 S %="B",%1=2 G Q3
"RTN","XMBGRP",27,0)
 I C<1 S C=.5
"RTN","XMBGRP",28,0)
 I D'=0,D'=1 S %="D",%1=4 G Q3
"RTN","XMBGRP",29,0)
 I XMBGRP'=0,XMBGRP'=1 S %="D",%1=7 G Q3
"RTN","XMBGRP",30,0)
 I '$D(XMBGRP)!$D(ZTQUEUED) S XMBGRP=1
"RTN","XMBGRP",31,0)
 I '$D(^VA(200,C,0)) D ERR4 G Q0
"RTN","XMBGRP",32,0)
 I $D(^XMB(3.8,"B",A)) S DA=$O(^(A,0)) I DA D ERR5 G QDA:'$L($O(XMY(""))) D AM G QDA
"RTN","XMBGRP",33,0)
 S DIC="^XMB(3.8,",DIC(0)="FZMN"_$S(XMBGRP:"",1:"E")
"RTN","XMBGRP",34,0)
 S DIC("DR")="4///"_$S(B=0:"PU",1:"PR")_";5///"_C_";10///0;7///"_$S(D>0:"y",1:"n")
"RTN","XMBGRP",35,0)
 D FILE^DICN
"RTN","XMBGRP",36,0)
 I Y<0 S A="Mail Group ("_X_") CREATION FAILED !!!" D NTF G Q0
"RTN","XMBGRP",37,0)
 S DA=+Y,DIE="^XMB(3.8,"
"RTN","XMBGRP",38,0)
 ;
"RTN","XMBGRP",39,0)
 ;Add descriptive text
"RTN","XMBGRP",40,0)
 I $O(XMTEXT(""))="" G GO
"RTN","XMBGRP",41,0)
 S DR(1,3.8,3)="3///@",Y=""
"RTN","XMBGRP",42,0)
 F X=1:1 S Y=$O(XMTEXT("")) Q:Y=""  D
"RTN","XMBGRP",43,0)
 . S %=$G(XMTEXT(Y)) S:%="" %=" "
"RTN","XMBGRP",44,0)
 . S DR(1,3.8,300+X)="3///+"_%
"RTN","XMBGRP",45,0)
 . K XMTEXT(Y),Y
"RTN","XMBGRP",46,0)
 . Q
"RTN","XMBGRP",47,0)
 D ^DIE K DR
"RTN","XMBGRP",48,0)
GO S A="Mail Group "_XMA0_" created." D NTF
"RTN","XMBGRP",49,0)
 I $O(XMY("")) D AM S A="Members have been added to the "_$P(^XMB(3.8,DA,0),U)_" Mail Group." D NTF
"RTN","XMBGRP",50,0)
 G QDA
"RTN","XMBGRP",51,0)
AM ;ADD MEMBERS
"RTN","XMBGRP",52,0)
 I '$L($O(XMY(0))) D ERR7 Q
"RTN","XMBGRP",53,0)
 L ^XMB(3.8,DA):9 E  D ERR6 G AMQ
"RTN","XMBGRP",54,0)
 N Y,XMA0,DIE S DIE="^XMB(3.8,"
"RTN","XMBGRP",55,0)
Y S Y=$O(XMY("")) I Y="" G AMQ
"RTN","XMBGRP",56,0)
 I +Y'=Y!(Y<1)!'$D(^VA(200,Y,0))!'$D(^XMB(3.9,Y,0)),Y'=.5,Y'=.6 D ERR8 K XMY(Y) G Y
"RTN","XMBGRP",57,0)
 S DR=$S(XMBGRP:"2////"_Y,1:"2///"_$P(^VA(200,Y,0),U))
"RTN","XMBGRP",58,0)
 S XMA0=Y D ^DIE K XMY(XMA0)
"RTN","XMBGRP",59,0)
 G Y
"RTN","XMBGRP",60,0)
AMQ L -^XMB(3.8,DA) Q
"RTN","XMBGRP",61,0)
DM(A,XMY,XMBGRP) ;DELETE MEMBER
"RTN","XMBGRP",62,0)
 ;Param1 = Mail Group Name or entry number
"RTN","XMBGRP",63,0)
 ;Param2 = Array of members to remove
"RTN","XMBGRP",64,0)
 ;Param3 = Silent Flag
"RTN","XMBGRP",65,0)
 ;
"RTN","XMBGRP",66,0)
 N %8,DA,Y,DIK,X,XMA0
"RTN","XMBGRP",67,0)
 S DA=A I +A'=A,A'=0,A'="" S DA=$O(^XMB(3.8,"B",A,0))
"RTN","XMBGRP",68,0)
 I '$D(XMBGRP) S XMBGRP=1
"RTN","XMBGRP",69,0)
 I +DA'=DA!(DA=0) D ERRA G Q0
"RTN","XMBGRP",70,0)
 I '$L($O(XMY(""))) D ERR9 G Q0
"RTN","XMBGRP",71,0)
D S %8=$O(XMY("")) I %8="" Q 1
"RTN","XMBGRP",72,0)
 K XMY(%8) S XMA0=%8 D DIK S A="Member "_$S($D(^VA(200,XMA0,0)):$P(^(0),U),1:"#"_XMA0)_" has been deleted from Mail Group "_A_"."
"RTN","XMBGRP",73,0)
 G D
"RTN","XMBGRP",74,0)
DIK N A,Y,DIK S Y=DA N DA
"RTN","XMBGRP",75,0)
 S DA(1)=+Y,DA=$O(^XMB(3.8,+Y,1,"B",XMA0,0)),DIK="^XMB(3.8,"_+Y_",1,"
"RTN","XMBGRP",76,0)
 D ^DIK Q
"RTN","XMBGRP",77,0)
ERR1 S A="E901 "_A_" is not valid -- it is shorter than 3 characters" G NTF
"RTN","XMBGRP",78,0)
ERR2 S A="E902 "_A_" is not valid -- it is longer than 30 characters" G NTF
"RTN","XMBGRP",79,0)
ERR3 S A="E903 "_B_" is not valid (must be 0 or 1)." G NTF
"RTN","XMBGRP",80,0)
ERR4 S A="E904 "_C_" is not a user to use as an organizer of a mail group." G NTF
"RTN","XMBGRP",81,0)
ERR5 S A="E905 MG "_A_" on file - members added but nothings else changed." G NTF
"RTN","XMBGRP",82,0)
ERR6 S A="E906 "_X_" File could not be accessed - Did not add members." G NTF
"RTN","XMBGRP",83,0)
ERR7 S A="E907 No members specified to add to Mail Group "_X D NTF Q
"RTN","XMBGRP",84,0)
ERR8 S A="E908 Invalid member, [NOT pointer to ^VA(200] ("_Y_") list." D NTF Q
"RTN","XMBGRP",85,0)
ERR9 S A="E909 Member delete attempted with no members specified." D NTF Q
"RTN","XMBGRP",86,0)
ERRA S A="E910 Mail Group "_A_" could not be found !" D NTF Q
"RTN","XMBGRP",87,0)
Q0 K XMY Q 0
"RTN","XMBGRP",88,0)
Q3 S B="Parameter"_%1_"="_@% D ERR3 G Q0
"RTN","XMBGRP",89,0)
QDA K XMY Q DA
"RTN","XMBGRP",90,0)
NTF ;NOTIFICATION
"RTN","XMBGRP",91,0)
 N XMY,XMDUZ,XMSUB,XMTEXT
"RTN","XMBGRP",92,0)
 S XMDUZ=.5,XMSUB="MAIL GROUP API"
"RTN","XMBGRP",93,0)
 S XMY(.5)="",XMY(DUZ)="",XMTEXT="A("
"RTN","XMBGRP",94,0)
 S A(1)="There was a call to the Mail Group Applications Programmer"
"RTN","XMBGRP",95,0)
 S A(2)="Interface (API) that required notification to the user:"
"RTN","XMBGRP",96,0)
 S A(3)="",A(4)=A
"RTN","XMBGRP",97,0)
 I XMBGRP D ^XMD Q
"RTN","XMBGRP",98,0)
 F I=1:1:4 W !,A(I)
"RTN","XMBGRP",99,0)
 W !,*7 Q
"RTN","XMFAX")
0^22^B12272643
"RTN","XMFAX",1,0)
XMFAX ;ISC-SF/GMB-Fax ;02/11/97  08:23
"RTN","XMFAX",2,0)
 ;;7.1;MailMan;**36**;Jun 02, 1994
"RTN","XMFAX",3,0)
FAX(XMZ) ; Fax a message
"RTN","XMFAX",4,0)
 N XMABORT,XMCNT,XMFIEN,XMQUIET
"RTN","XMFAX",5,0)
 S XMQUIET=1 ; "quiet flag"
"RTN","XMFAX",6,0)
 S XMABORT=0
"RTN","XMFAX",7,0)
 D CRE8FAX(XMZ,XMQUIET,.XMCNT,.XMABORT) Q:XMABORT
"RTN","XMFAX",8,0)
 D SENDFAX(XMQUIET,XMFIEN,XMCNT)
"RTN","XMFAX",9,0)
 Q
"RTN","XMFAX",10,0)
CRE8FAX(XMZ,XMQUIET,XMCNT,XMABORT) ;
"RTN","XMFAX",11,0)
 N XMFID
"RTN","XMFAX",12,0)
 D RECORD(XMQUIET,.XMFID,.XMFIEN,.XMABORT) Q:XMABORT
"RTN","XMFAX",13,0)
 L +^AKF("FAX",XMFIEN)
"RTN","XMFAX",14,0)
 D RECIPS(XMZ,XMFID,XMFIEN,.XMCNT)
"RTN","XMFAX",15,0)
 D BODY(XMZ,XMFIEN)
"RTN","XMFAX",16,0)
 L -^AKF("FAX",XMFIEN)
"RTN","XMFAX",17,0)
 Q
"RTN","XMFAX",18,0)
RECORD(AKQ,AKFAX,AKIEN,XMABORT) ; Add record to fax file
"RTN","XMFAX",19,0)
 ; AKFAX    Fax ID
"RTN","XMFAX",20,0)
 ; AKIEN    Record number in ^AKF("FAX",
"RTN","XMFAX",21,0)
 D NE^AKFAX0 I '$D(AKFAX) S XMABORT=1 Q  ; Add record to fax file
"RTN","XMFAX",22,0)
 S $P(^AKF("FAX",AKIEN,0),U,4)=1  ; This is a MailMan-generated fax
"RTN","XMFAX",23,0)
 Q
"RTN","XMFAX",24,0)
RECIPS(XMZ,XMFID,XMFIEN,XMCNT) ; Add recipients to fax record and update recipient record in mail msg.
"RTN","XMFAX",25,0)
 N I,XMREC,XMIENS,XMFDA
"RTN","XMFAX",26,0)
 S I="",XMCNT=0
"RTN","XMFAX",27,0)
 F  S I=$O(^XMB(3.9,XMZ,1,"AFAX",I)) Q:I=""  D
"RTN","XMFAX",28,0)
 . S XMREC=$G(^AKF("FAXR",I,0)) Q:XMREC=""
"RTN","XMFAX",29,0)
 . S XMCNT=XMCNT+1
"RTN","XMFAX",30,0)
 . S XMIENS="+1,"_XMFIEN_","
"RTN","XMFAX",31,0)
 . S XMFDA(589500.01,XMIENS,.01)=I ; Pointer to recipient
"RTN","XMFAX",32,0)
 . S XMFDA(589500.01,XMIENS,1)="Awaiting Transmission Path"
"RTN","XMFAX",33,0)
 . S XMFDA(589500.01,XMIENS,2)=$P(XMREC,U,2) ; Recipient fax phone
"RTN","XMFAX",34,0)
 . S XMFDA(589500.01,XMIENS,3)=$P(XMREC,U,3) ; Recipient physical location
"RTN","XMFAX",35,0)
 . S XMFDA(589500.01,XMIENS,4)=$P(XMREC,U,4) ; Recipient voice phone
"RTN","XMFAX",36,0)
 . D UPDATE^DIE("","XMFDA") ; Add recipient to fax record
"RTN","XMFAX",37,0)
 . S XMIENS=$O(^XMB(3.9,XMZ,1,"AFAX",I,""))_","_XMZ_","
"RTN","XMFAX",38,0)
 . S XMFDA(3.91,XMIENS,4)=$$NOW^XLFDT()    ; Current date/time
"RTN","XMFAX",39,0)
 . S XMFDA(3.91,XMIENS,5)="@"  ; get rid of status
"RTN","XMFAX",40,0)
 . S XMFDA(3.91,XMIENS,13)="@" ; get rid of xref
"RTN","XMFAX",41,0)
 . S XMFDA(3.91,XMIENS,14)=XMFID ; fax id
"RTN","XMFAX",42,0)
 . D FILE^DIE("","XMFDA") ; Update mail msg recipient
"RTN","XMFAX",43,0)
 Q
"RTN","XMFAX",44,0)
BODY(XMZ,XMFIEN) ; Copy the msg text to the fax text
"RTN","XMFAX",45,0)
 N XMTEXT,XMREC,I,XMDATE,XMFROM
"RTN","XMFAX",46,0)
 S XMREC=^XMB(3.9,XMZ,0)
"RTN","XMFAX",47,0)
 S I=1,XMTEXT(I)="Subj: "_$P(XMREC,U,1)_"  ["_XMZ_"]"
"RTN","XMFAX",48,0)
 S XMDATE=$P(XMREC,U,3) S:+XMDATE=XMDATE XMDATE=$$FMTE^XLFDT(XMDATE,1)
"RTN","XMFAX",49,0)
 I $L(XMTEXT(I))+$L(XMDATE)+1>79 S I=I+1,XMTEXT(I)=XMDATE
"RTN","XMFAX",50,0)
 E  S XMTEXT(I)=XMTEXT(I)_" "_XMDATE
"RTN","XMFAX",51,0)
 S I=I+1,XMTEXT(I)="From: "_$$FROM($P(XMREC,U,2))
"RTN","XMFAX",52,0)
 I DUZ'=$P(XMREC,U,2) S I=I+1,XMTEXT(I)="Sender: "_$$FROM(DUZ)
"RTN","XMFAX",53,0)
 S I=I+1,XMTEXT(I)="-------------------------------------------------------------------------------"
"RTN","XMFAX",54,0)
 S I=I+1,XMTEXT(I)=""
"RTN","XMFAX",55,0)
 D WP^DIE(589500,XMFIEN_",",7,"","XMTEXT")
"RTN","XMFAX",56,0)
 D WP^DIE(589500,XMFIEN_",",7,"A","^XMB(3.9,"_XMZ_",2)")
"RTN","XMFAX",57,0)
 Q 
"RTN","XMFAX",58,0)
SENDFAX(AKQ,AKIEN,AKML) ;
"RTN","XMFAX",59,0)
 W !,"Sending to fax"
"RTN","XMFAX",60,0)
 D QUE^AKFAX0
"RTN","XMFAX",61,0)
 Q
"RTN","XMFAX",62,0)
FAXHDR(XMFID,XMFTO) ; Print the fax header
"RTN","XMFAX",63,0)
 W !,"MailMan FAX for ",XMFTO
"RTN","XMFAX",64,0)
 W !,"FAXmail ID: ",XMFID,", Faxed: ",$$FMTE^XLFDT($$NOW^XLFDT,1),!
"RTN","XMFAX",65,0)
 Q
"RTN","XMFAX",66,0)
FROM(XMFROM) ;
"RTN","XMFAX",67,0)
 N XMFREC,XMTITLE
"RTN","XMFAX",68,0)
 Q:XMFROM'=+XMFROM XMFROM
"RTN","XMFAX",69,0)
 S XMFREC=$G(^VA(200,XMFROM,0)) Q:XMFREC="" $S(XMFROM=.5:"POSTMASTER",1:"USER #"_XMFROM)_"@"_^XMB("NETNAME")
"RTN","XMFAX",70,0)
 S XMFROM=$P(XMFREC,U)_"@"_^XMB("NETNAME")
"RTN","XMFAX",71,0)
 I $P($G(XMDISPI),U)["T",$P(XMFREC,U,9) D
"RTN","XMFAX",72,0)
 . S XMTITLE=$P($G(^DIC(3.1,$P(XMFREC,U,9),0)),U)
"RTN","XMFAX",73,0)
 . S:XMTITLE'="" XMFROM=XMFROM_"@"_^XMB("NETNAME")_" - "_XMTITLE
"RTN","XMFAX",74,0)
 E  I $P($G(XMDISPI),U)["I",$D(^XMB(3.7,XMFROM,6000)) S XMFROM=XMFROM_" ("_$P(^(6000),U)_")"
"RTN","XMFAX",75,0)
 Q XMFROM
"RTN","XMR1A")
0^23^B12264071
"RTN","XMR1A",1,0)
XMR1A ;(WASH ISC)/THM/CAP-SMTP (TURN,DSP,STAT&ERRORS) ;02/04/97  08:06
"RTN","XMR1A",2,0)
 ;;7.1;MailMan;**13,36**;Jun 02, 1994
"RTN","XMR1A",3,0)
IN S X=XMP S:X["<" X=$P($P(X,"<",2),">") S Y=$S(+$E(X):$P(X,"@",2)_"@"_$P(X,"@"),1:X)
"RTN","XMR1A",4,0)
 I Y'?.ANP F %=1:1:$L(Y) I $E(Y,%)?1C,$A(Y,%)'=9 S Y=$E(Y,%+1,999) Q:Y?.ANP  S %=%-1
"RTN","XMR1A",5,0)
 I $P(Y,"@")=^XMB("NETNAME") S XMZ2=$P(Y,"@",2)
"RTN","XMR1A",6,0)
 E  S XMZ2=$S($L(Y):$O(^XMBX(3.9,"AI",$E(Y,1,64),0)),1:"")
"RTN","XMR1A",7,0)
 ;
"RTN","XMR1A",8,0)
 ;Return indication if DUPLICATE (in response chain)
"RTN","XMR1A",9,0)
 S %=0 K XMR1A
"RTN","XMR1A",10,0)
 I $G(XMZ2) F  S %=$O(^XMB(3.9,XMZ2,3,%)) Q:'%  I $G(^(%,0))=XMZ S XMR1A=1 K XMZ2 Q
"RTN","XMR1A",11,0)
 ;
"RTN","XMR1A",12,0)
 S %=$S($G(XMZ2):$G(^XMB(3.9,XMZ2,0)),1:"")
"RTN","XMR1A",13,0)
 ;No original Message ?
"RTN","XMR1A",14,0)
 Q:%=""
"RTN","XMR1A",15,0)
 ;
"RTN","XMR1A",16,0)
 ;Original Message was Info Only
"RTN","XMR1A",17,0)
 S %=$P(%,U,12) I "yY"[$E(%_" ") S XMR1A=2 Q
"RTN","XMR1A",18,0)
 I $D(^XMB(3.9,XMZ2,"IN")) S XMREMID(0)=^("IN")
"RTN","XMR1A",19,0)
 Q
"RTN","XMR1A",20,0)
NONO ;No Subject or Text
"RTN","XMR1A",21,0)
 S XMSG="552 MESSAGE REJECTED - NO SUBJECT AND NO TEXT"
"RTN","XMR1A",22,0)
 G Q
"RTN","XMR1A",23,0)
NOGO S Y=$O(^XMBX(3.9,"AI",X,0)) I Y,$D(^(Y)) S Y=$P(^(Y),".")
"RTN","XMR1A",24,0)
 S XMSG="254 Message ACCEPTED as <"_$S(+$E(X):X,1:$P(X,"@",2)_"@"_$P(X,"@")_">")
"RTN","XMR1A",25,0)
 I $L(Y)=7 S XMSG=XMSG_" previously received: "_$E(Y,4,5)_"/"_$E(Y,6,7)_"/"_$E(Y,2,3)
"RTN","XMR1A",26,0)
Q X XMSEN K XMR1A,XMREMID D K G KILL^XMA3
"RTN","XMR1A",27,0)
 ;
"RTN","XMR1A",28,0)
 ;REJECT MESSAGE
"RTN","XMR1A",29,0)
REJECT I $G(XMR1A)=2 S XMSG="555 Reply to 'Information Only' message rejected." G Q
"RTN","XMR1A",30,0)
 S XMSG="254 Rejected.  Duplicate (purged) or no additional recipients."
"RTN","XMR1A",31,0)
 G Q
"RTN","XMR1A",32,0)
NOTEXT ;Put fake text line into message if received with no text
"RTN","XMR1A",33,0)
 S ^XMB(3.9,XMZ,2,1,0)=" ",XMLINE=2 Q
"RTN","XMR1A",34,0)
K ;REMOVE FROM ARRIVING BASKET
"RTN","XMR1A",35,0)
 S XMZHOLD=XMDUZ,(XMKD,XMK)=.95,XMDUZ=.5 D KL^XMA1B K XMKD
"RTN","XMR1A",36,0)
 Q
"RTN","XMR1A",37,0)
STAT I XMBCK'="" S XMSG="211-Current reverse path is: "_XMBCK X XMSEN Q:ER
"RTN","XMR1A",38,0)
 I $L(XMLOCK) S XMSG="211-Current locklist is: "_XMLOCK X XMSEN Q:ER
"RTN","XMR1A",39,0)
 I XMINST'="" S XMSG="211-Current sender is: "_$P(^DIC(4.2,XMINST,0),U) X XMSEN Q:ER
"RTN","XMR1A",40,0)
 S XMSG="211-Acceptable commands at the moment are: " X XMSEN Q:ER  S XMSG="211-"
"RTN","XMR1A",41,0)
 S K=XMSTATE_XMCONT F I=1:1 Q:$P(K,U,I,999)=""  S J=$P(K,U,I) I J'="" S XMSG=XMSG_J_" "
"RTN","XMR1A",42,0)
 X XMSEN Q:ER
"RTN","XMR1A",43,0)
DSP I $D(XMZ),$O(^XMB(3.9,XMZ,2,0))>0 S J=0 S XMSG="211-Current text buffer is:" X XMSEN Q:ER  F I=1:1 S J=$O(^XMB(3.9,XMZ,2,J)) Q:J<.001  S XMSG="211-"_J_"  "_^(J,0) X XMSEN Q:ER
"RTN","XMR1A",44,0)
D2 I $O(^TMP("XMY",$J,0))'="" S J=0 S XMSG="211-Current recipients are: " X XMSEN Q:ER  F  S J=$O(^TMP("XMY",$J,J)) Q:J=""  S XMSG="211-"_$S('J:J,1:$P(^VA(200,J,0),U)) X XMSEN Q:ER
"RTN","XMR1A",45,0)
 S XMSG="211 OK" X XMSEN Q
"RTN","XMR1A",46,0)
TURN ;TURN AROUND PROTOCOL
"RTN","XMR1A",47,0)
 S XMINST=$G(XMRDOM)
"RTN","XMR1A",48,0)
 I $F("Yy",$P(^DIC(4.2,XMINST,0),U,16))>1 S XMSG="502 "_^XMB("NAME")_" has TURN disabled." X XMSEN Q
"RTN","XMR1A",49,0)
 I $O(^XMB(3.7,.5,2,XMINST+1000,1,0))>0 G T1
"RTN","XMR1A",50,0)
 S XMSG="502 "_^XMB("NAME")_" has no messages to export" X XMSEN Q
"RTN","XMR1A",51,0)
T1 I $P(^DIC(4.2,XMINST,0),U)'=$G(XMHELO("XMP")) S XMSG="502 TURN command rejected." X XMSEN Q
"RTN","XMR1A",52,0)
 S XMSG="250 "_^XMB("NAME")_" has messages to export" X XMSEN Q:ER  G ^XMS
"RTN","XMR1A",53,0)
 ;Record encoding
"RTN","XMR1A",54,0)
V S ^XMB(3.9,XMZ,"K")=$P(XMENCR,U,2,99),^(0)=$P(^XMB(3.9,XMZ,0)_"^^^^^^^^^",U,1,9)_U_$P(XMENCR,U)_U_$P(^(0),U,11,99)
"RTN","XMR1A",55,0)
 Q
"RTN","XMUT5G")
0^18^B429148
"RTN","XMUT5G",1,0)
XMUT5G ;(WASH ISC)/CAP-VALIDATE MAIL GROUP MEMBERS ;12/13/96  08:52
"RTN","XMUT5G",2,0)
 ;;7.1;MailMan;**36**;Jun 02, 1994
"RTN","XMUT5G",3,0)
 S DIC="^XMB(3.8,",DIC(0)="AEO" D ^DIC
"RTN","XMUT5G",4,0)
 S A=0,XMA0=+Y,C=0 W !,"Analyzing "_$P(Y,U,2)_" Mail Group",!!
"RTN","XMUT5G",5,0)
A S A=$O(^XMB(3.8,XMA0,1,"B",A)) G Q:'A
"RTN","XMUT5G",6,0)
 S C=C+1 I C#100=0 W "***"_A_"*** "
"RTN","XMUT5G",7,0)
 S F=$G(^VA(200,A,0))
"RTN","XMUT5G",8,0)
 I '$L($P(F,U,2))!$L($P(F,U,11)) W A," "
"RTN","XMUT5G",9,0)
 G A
"RTN","XMUT5G",10,0)
Q K A,C,XMA0,DIC,DTOUT,DUOUT Q
"RTN","XMYPOST6")
0^10^B151824
"RTN","XMYPOST6",1,0)
XMYPOST6 ;SFISC/GMB - Kill identifier node ;02/06/97  08:39
"RTN","XMYPOST6",2,0)
 ;;7.1;MailMan;**36**;Jun 02, 1994
"RTN","XMYPOST6",3,0)
 K ^DD(3.8,0,"ID",5.1)
"RTN","XMYPOST6",4,0)
 L +^XMB(3.7):60 E  Q
"RTN","XMYPOST6",5,0)
 K ^XMB(3.7,"F")
"RTN","XMYPOST6",6,0)
 S DIK="^XMB(3.7,",DIK(1)="2^F" D ENALL^DIK K DIK
"RTN","XMYPOST6",7,0)
 L -^XMB(3.7)
"RTN","XMYPOST6",8,0)
 Q
"UP",3.8,3.814,-1)
3.8^8
"UP",3.8,3.814,0)
3.814
"UP",3.8,3.815,-1)
3.8^9
"UP",3.8,3.815,0)
3.815
"UP",3.9,3.91,-1)
3.9^1
"UP",3.9,3.91,0)
3.91
"VER")
8.0^21.0
"^DD",3.7,3.7,2,0)
FORWARDING ADDRESS^FX^^0;2^K:X[""""!($A(X)=45) X I $D(X) K:$L(X)>40!($L(X)<1)!'(+X'=X&(X["@")) X I $D(X) K:'$$CHK^XMA21FWD($P(X,"@",2)) X
"^DD",3.7,3.7,2,.1)
REMOTE ADDDRESS TO WHICH MAIL WILL BE ROUTED
"^DD",3.7,3.7,2,1,0)
^.1
"^DD",3.7,3.7,2,1,1,0)
^^BULLETIN MESSAGE
"^DD",3.7,3.7,2,1,1,1)
S Y(0)=X,D0=DA S X=Y(0) S Y(1)=$S($D(^XMB(3.7,D0,0)):^(0),1:"") S X=$P(Y(1),U,2) S XMB(1)=X X ^DD(3.7,2,1,1,1.2) K XMY S XMB="XMZFWDBULL" D ^XMB:$D(^XMB(3.6,"B",XMB)),ENT^XMUT7(DA) K Y,XMB
"^DD",3.7,3.7,2,1,1,1.2)
S X=Y(0) S Y(1)=$S($D(^XMB(3.7,D0,0)):^(0),1:"") S X=$S('$D(^VA(200,+$P(Y(1),U,1),0)):"",1:$P(^(0),U,1)) S XMB(2)=X
"^DD",3.7,3.7,2,1,1,2)
Q
"^DD",3.7,3.7,2,1,1,"%D",0)
^^5^5^2931101^^^^
"^DD",3.7,3.7,2,1,1,"%D",1,0)
This cross reference makes sure that someone is notified when a user
"^DD",3.7,3.7,2,1,1,"%D",2,0)
creates a new FORWARDING ADDRESS if there is a member of the POSTMASTER
"^DD",3.7,3.7,2,1,1,"%D",3,0)
mail group.  It also sends out a test message (from the POSTMASTER) that
"^DD",3.7,3.7,2,1,1,"%D",4,0)
will generate an error message to the POSTMASTER if the new FORWARDING
"^DD",3.7,3.7,2,1,1,"%D",5,0)
ADDRESS is not correct.
"^DD",3.7,3.7,2,1,1,"CREATE PARAMETER #1")
FORWARDING
"^DD",3.7,3.7,2,1,1,"CREATE PARAMETER #2")
NAME
"^DD",3.7,3.7,2,1,1,"CREATE VALUE")
XM-FWD-ADDRESS-CHECKER
"^DD",3.7,3.7,2,1,1,"DELETE VALUE")
NO EFFECT
"^DD",3.7,3.7,2,1,2,0)
3.7^F
"^DD",3.7,3.7,2,1,2,1)
S ^XMB(3.7,"F",$E(X,1,30),DA)=""
"^DD",3.7,3.7,2,1,2,2)
K ^XMB(3.7,"F",$E(X,1,30),DA)
"^DD",3.7,3.7,2,1,2,"%D",0)
^^2^2^2970205^
"^DD",3.7,3.7,2,1,2,"%D",1,0)
This cross reference enables the site manager to easily find a user who
"^DD",3.7,3.7,2,1,2,"%D",2,0)
enters a bad forwarding address.
"^DD",3.7,3.7,2,1,2,"DT")
2970205
"^DD",3.7,3.7,2,3)
Enter a valid NETWORK address (Lname,Fname@Domain).
"^DD",3.7,3.7,2,21,0)
^^6^6^2891206^^^^
"^DD",3.7,3.7,2,21,1,0)
If this field is specified, it names an additional address to which
"^DD",3.7,3.7,2,21,2,0)
this message is to be routed.
"^DD",3.7,3.7,2,21,3,0)
 
"^DD",3.7,3.7,2,21,4,0)
See the LOCAL DELIVERY FLAG.  If you do not edit this field to 'ON', then
"^DD",3.7,3.7,2,21,5,0)
mail will only be delivered to your FORWARDING ADDRESS and not to your
"^DD",3.7,3.7,2,21,6,0)
Mailbox.
"^DD",3.7,3.7,2,21,7,0)
 
"^DD",3.7,3.7,2,21,8,0)
 
"^DD",3.7,3.7,2,21,9,0)
 
"^DD",3.7,3.7,2,21,10,0)
 
"^DD",3.7,3.7,2,"DT")
2970205
"^DD",3.8,3.8,.01,0)
NAME^RFX^^0;1^S:X?1"G.".E!(X?1"g.".E) X=$E(X,3,99) K:$L(X)>30!($L(X)<3)!'(X'?1P.E)!(X'?.ANP) X
"^DD",3.8,3.8,.01,.1)
MAIL GROUP NAME
"^DD",3.8,3.8,.01,1,0)
^.1
"^DD",3.8,3.8,.01,1,1,0)
3.8^B
"^DD",3.8,3.8,.01,1,1,1)
S ^XMB(3.8,"B",$E(X,1,30),DA)=""
"^DD",3.8,3.8,.01,1,1,2)
K ^XMB(3.8,"B",$E(X,1,30),DA)
"^DD",3.8,3.8,.01,3)
ANSWER MUST BE 3-30 CHARACTERS IN LENGTH
"^DD",3.8,3.8,.01,21,0)
^^2^2^2921125^^^^
"^DD",3.8,3.8,.01,21,1,0)
The name of a mail group, i.e. a list of recipients who can
"^DD",3.8,3.8,.01,21,2,0)
all be addressed at once by reference to this name.
"^DD",3.8,3.8,.01,"DT")
2931202
"^DD",3.8,3.8,.01,"LAYGO",1,0)
I $$LAYGO^XMA7G(X)
"^DD",3.8,3.8,14,0)
FAX RECIPIENT^3.814P^^8;0
"^DD",3.8,3.8,14,"DT")
2970211
"^DD",3.8,3.8,15,0)
FAX GROUP^3.815P^^9;0
"^DD",3.8,3.8,15,"DT")
2970211
"^DD",3.8,3.814,0)
FAX RECIPIENT SUB-FIELD^^.01^1
"^DD",3.8,3.814,0,"DT")
2970113
"^DD",3.8,3.814,0,"IX","B",3.814,.01)

"^DD",3.8,3.814,0,"NM","FAX RECIPIENT")

"^DD",3.8,3.814,0,"UP")
3.8
"^DD",3.8,3.814,.01,0)
FAX RECIPIENT^MP589499'^AKF("FAXR",^0;1^Q
"^DD",3.8,3.814,.01,1,0)
^.1
"^DD",3.8,3.814,.01,1,1,0)
3.814^B
"^DD",3.8,3.814,.01,1,1,1)
S ^XMB(3.8,DA(1),8,"B",$E(X,1,30),DA)=""
"^DD",3.8,3.814,.01,1,1,2)
K ^XMB(3.8,DA(1),8,"B",$E(X,1,30),DA)
"^DD",3.8,3.814,.01,3)
Enter the fax recipient who should receive faxes sent to this mail group.
"^DD",3.8,3.814,.01,21,0)
^^3^3^2970114^^^^
"^DD",3.8,3.814,.01,21,1,0)
This is a list of individual recipients who will receive by fax any mail sent
"^DD",3.8,3.814,.01,21,2,0)
to this mail group.  They receive the original message only.  They do not
"^DD",3.8,3.814,.01,21,3,0)
receive responses. 
"^DD",3.8,3.814,.01,"DT")
2970211
"^DD",3.8,3.815,0)
FAX GROUP SUB-FIELD^^.01^1
"^DD",3.8,3.815,0,"DT")
2970114
"^DD",3.8,3.815,0,"IX","B",3.815,.01)

"^DD",3.8,3.815,0,"NM","FAX GROUP")

"^DD",3.8,3.815,0,"UP")
3.8
"^DD",3.8,3.815,.01,0)
FAX GROUP^M*P589498'^AKF("FAXG",^0;1^S DIC("S")="N XM S XM=$G(^(3)) I $P(XM,U,2)!($G(XMDUZ,DUZ)=+XM)" D ^DIC K DIC S DIC=DIE,X=+Y K:Y<0 X
"^DD",3.8,3.815,.01,1,0)
^.1
"^DD",3.8,3.815,.01,1,1,0)
3.815^B
"^DD",3.8,3.815,.01,1,1,1)
S ^XMB(3.8,DA(1),9,"B",$E(X,1,30),DA)=""
"^DD",3.8,3.815,.01,1,1,2)
K ^XMB(3.8,DA(1),9,"B",$E(X,1,30),DA)
"^DD",3.8,3.815,.01,3)
Enter the fax group which should receive faxes sent to this mail group.
"^DD",3.8,3.815,.01,12)
Group must be public or user must be (surrogate of) creator of group.
"^DD",3.8,3.815,.01,12.1)
S DIC("S")="N XM S XM=$G(^(3)) I $P(XM,U,2)!($G(XMDUZ,DUZ)=+XM)"
"^DD",3.8,3.815,.01,21,0)
^^2^2^2970114^^^^
"^DD",3.8,3.815,.01,21,1,0)
Each member of the fax group will receive by fax any message sent to this mail
"^DD",3.8,3.815,.01,21,2,0)
group.  Only the original message will be faxed.  Responses will not be faxed.
"^DD",3.8,3.815,.01,"DT")
2970211
"^DD",3.9,3.91,13,0)
FAX RECIPIENT^P589499'^AKF("FAXR",^0;11^Q
"^DD",3.9,3.91,13,1,0)
^.1
"^DD",3.9,3.91,13,1,1,0)
3.91^AFAX
"^DD",3.9,3.91,13,1,1,1)
S ^XMB(3.9,DA(1),1,"AFAX",$E(X,1,30),DA)=""
"^DD",3.9,3.91,13,1,1,2)
K ^XMB(3.9,DA(1),1,"AFAX",$E(X,1,30),DA)
"^DD",3.9,3.91,13,1,1,"%D",0)
^^2^2^2970114^^
"^DD",3.9,3.91,13,1,1,"%D",1,0)
This cross reference makes it possible for MailMan to immediately find the
"^DD",3.9,3.91,13,1,1,"%D",2,0)
recipients to fax a message to. 
"^DD",3.9,3.91,13,1,1,"DT")
2970110
"^DD",3.9,3.91,13,3)
Enter the fax recipient
"^DD",3.9,3.91,13,21,0)
^^4^4^2970211^^^^
"^DD",3.9,3.91,13,21,1,0)
When the message is addressed to a fax recipient, this field points to the fax
"^DD",3.9,3.91,13,21,2,0)
rolodex file.  After the message is handed off to the fax software, the pointer
"^DD",3.9,3.91,13,21,3,0)
in this field is deleted, the STATUS field is deleted, and the FAX ID field is
"^DD",3.9,3.91,13,21,4,0)
set to the fax ID number assigned to it by the fax software. 
"^DD",3.9,3.91,13,"DT")
2970211
"^DD",3.9,3.91,14,0)
FAX ID^F^^0;12^K:$L(X)>14!($L(X)<1) X
"^DD",3.9,3.91,14,3)
Enter the fax ID
"^DD",3.9,3.91,14,21,0)
^^1^1^2970211^
"^DD",3.9,3.91,14,21,1,0)
This is the FAX ID assigned to the fax by the fax software (^AKF*).
"^DD",3.9,3.91,14,"DT")
2970211
"^DD",4.3,4.3,143,0)
FAX ENABLED^S^0:no;1:yes;^0;19^Q
"^DD",4.3,4.3,143,3)
Is your site fax enabled?
"^DD",4.3,4.3,143,21,0)
^^7^7^2970109^
"^DD",4.3,4.3,143,21,1,0)
Your site is fax enabled if you have the suite of fax software and files
"^DD",4.3,4.3,143,21,2,0)
(^AKF) and fax capability and you choose to allow faxes to be sent via MailMan.
"^DD",4.3,4.3,143,21,3,0)

"^DD",4.3,4.3,143,21,4,0)
To send faxes via MailMan, Mail groups (file 3.8) must first be populated in the
"^DD",4.3,4.3,143,21,5,0)
fax recipient and fax group multiples.  Then, when a user sends a message to a
"^DD",4.3,4.3,143,21,6,0)
mail group, the message is also faxed to any fax recipients in that mail group.
"^DD",4.3,4.3,143,21,7,0)
Responses to the message are not faxed.
"^DD",4.3,4.3,143,"DT")
2970211
**END**
**END**
