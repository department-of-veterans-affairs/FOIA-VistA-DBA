Released SD*5.3*335 SEQ #289
Extracted from mail message
**KIDS**:SD*5.3*335^

**INSTALL NAME**
SD*5.3*335
"BLD",4702,0)
SD*5.3*335^SCHEDULING^0^3040325^y
"BLD",4702,4,0)
^9.64PA^^
"BLD",4702,"ABPKG")
n
"BLD",4702,"KRN",0)
^9.67PA^8989.52^19
"BLD",4702,"KRN",.4,0)
.4
"BLD",4702,"KRN",.401,0)
.401
"BLD",4702,"KRN",.402,0)
.402
"BLD",4702,"KRN",.403,0)
.403
"BLD",4702,"KRN",.5,0)
.5
"BLD",4702,"KRN",.84,0)
.84
"BLD",4702,"KRN",3.6,0)
3.6
"BLD",4702,"KRN",3.8,0)
3.8
"BLD",4702,"KRN",9.2,0)
9.2
"BLD",4702,"KRN",9.8,0)
9.8
"BLD",4702,"KRN",9.8,"NM",0)
^9.68A^3^3
"BLD",4702,"KRN",9.8,"NM",1,0)
SDPMUT1^^0^B47732047
"BLD",4702,"KRN",9.8,"NM",2,0)
SCRPW301^^0^B56978108
"BLD",4702,"KRN",9.8,"NM",3,0)
SCRPW304^^0^B26371926
"BLD",4702,"KRN",9.8,"NM","B","SCRPW301",2)

"BLD",4702,"KRN",9.8,"NM","B","SCRPW304",3)

"BLD",4702,"KRN",9.8,"NM","B","SDPMUT1",1)

"BLD",4702,"KRN",19,0)
19
"BLD",4702,"KRN",19.1,0)
19.1
"BLD",4702,"KRN",101,0)
101
"BLD",4702,"KRN",409.61,0)
409.61
"BLD",4702,"KRN",771,0)
771
"BLD",4702,"KRN",870,0)
870
"BLD",4702,"KRN",8989.51,0)
8989.51
"BLD",4702,"KRN",8989.52,0)
8989.52
"BLD",4702,"KRN",8994,0)
8994
"BLD",4702,"KRN","B",.4,.4)

"BLD",4702,"KRN","B",.401,.401)

"BLD",4702,"KRN","B",.402,.402)

"BLD",4702,"KRN","B",.403,.403)

"BLD",4702,"KRN","B",.5,.5)

"BLD",4702,"KRN","B",.84,.84)

"BLD",4702,"KRN","B",3.6,3.6)

"BLD",4702,"KRN","B",3.8,3.8)

"BLD",4702,"KRN","B",9.2,9.2)

"BLD",4702,"KRN","B",9.8,9.8)

"BLD",4702,"KRN","B",19,19)

"BLD",4702,"KRN","B",19.1,19.1)

"BLD",4702,"KRN","B",101,101)

"BLD",4702,"KRN","B",409.61,409.61)

"BLD",4702,"KRN","B",771,771)

"BLD",4702,"KRN","B",870,870)

"BLD",4702,"KRN","B",8989.51,8989.51)

"BLD",4702,"KRN","B",8989.52,8989.52)

"BLD",4702,"KRN","B",8994,8994)

"BLD",4702,"QUES",0)
^9.62^^
"BLD",4702,"REQB",0)
^9.611^2^2
"BLD",4702,"REQB",1,0)
SD*5.3*292^1
"BLD",4702,"REQB",2,0)
TIU*1.0*168^1
"BLD",4702,"REQB","B","SD*5.3*292",1)

"BLD",4702,"REQB","B","TIU*1.0*168",2)

"MBREQ")
0
"PKG",16,-1)
1^1
"PKG",16,0)
SCHEDULING^SD^APPOINTMENTS,PROFILES,LETTERS,AMIS REPORTS
"PKG",16,20,0)
^9.402P^^
"PKG",16,22,0)
^9.49I^1^1
"PKG",16,22,1,0)
5.3^2941102
"PKG",16,22,1,"PAH",1,0)
335^3040325^3507
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
3
"RTN","SCRPW301")
0^2^B56978108
"RTN","SCRPW301",1,0)
SCRPW301 ; BPFO/JRC - Performance Monitor Detailed Report ; 2/3/04 7:33am
"RTN","SCRPW301",2,0)
 ;;5.3;SCHEDULING;**292,335**;AUG 13, 1993
"RTN","SCRPW301",3,0)
 ;
"RTN","SCRPW301",4,0)
EN ;Main entry point for generation of local detailed report
"RTN","SCRPW301",5,0)
 ;Declare variable(s) and arrays
"RTN","SCRPW301",6,0)
 N SCRNARR,SORTARR
"RTN","SCRPW301",7,0)
 S SCRNARR="^TMP(""SCRPW"",$J,""SCRNARR"")"
"RTN","SCRPW301",8,0)
 S SORTARR="^TMP(""SCRPW"",$J,""SORTARR"")"
"RTN","SCRPW301",9,0)
 K @SCRNARR,@SORTARR
"RTN","SCRPW301",10,0)
 ;Get time limit
"RTN","SCRPW301",11,0)
 I '$$TLMT^SCRPW302(SCRNARR) D EX1 Q
"RTN","SCRPW301",12,0)
 ;Get date frame
"RTN","SCRPW301",13,0)
 I '$$DATE^SCRPW302("","",SCRNARR) D EX1 Q
"RTN","SCRPW301",14,0)
 ;Get division (one/many/all)
"RTN","SCRPW301",15,0)
 I '$$DIV^SCRPW302(SCRNARR) D EX1 Q
"RTN","SCRPW301",16,0)
 ;Get provider (one/many/all)
"RTN","SCRPW301",17,0)
 I '$$PROV^SCRPW302(SCRNARR) D EX1 Q
"RTN","SCRPW301",18,0)
 ;Get stop code (one/man/all)
"RTN","SCRPW301",19,0)
 I '$$DSS^SCRPW303(SCRNARR) D EX1 Q
"RTN","SCRPW301",20,0)
 ;Include scanned notes
"RTN","SCRPW301",21,0)
 I '$$SCAN^SCRPW302(SCRNARR) D EX1 Q
"RTN","SCRPW301",22,0)
 ;Get primary & secondary sort
"RTN","SCRPW301",23,0)
 I '$$SORT^SCRPW303(SORTARR) D EX1 Q
"RTN","SCRPW301",24,0)
 ;Queue report
"RTN","SCRPW301",25,0)
 W !!,"** REPORT REQUIRES 132 COLUMNS TO PRINT CORRECTLY **",!!
"RTN","SCRPW301",26,0)
 N ZTDESC,ZTIO,ZTSAVE,TMP
"RTN","SCRPW301",27,0)
 S ZTIO=""
"RTN","SCRPW301",28,0)
 S ZTDESC="Performance Monitor Detailed Report"
"RTN","SCRPW301",29,0)
 S ZTSAVE("SCRNARR")=""
"RTN","SCRPW301",30,0)
 S TMP=$$OREF^DILF(SCRNARR)
"RTN","SCRPW301",31,0)
 S ZTSAVE(TMP)=""
"RTN","SCRPW301",32,0)
 I $D(@SCRNARR)#2 S ZTSAVE(SCRNARR)=""
"RTN","SCRPW301",33,0)
 S ZTSAVE("SORTARR")=""
"RTN","SCRPW301",34,0)
 S TMP=$$OREF^DILF(SORTARR)
"RTN","SCRPW301",35,0)
 S ZTSAVE(TMP)=""
"RTN","SCRPW301",36,0)
 I $D(@SORTARR)#2 S ZTSAVE(SORTARR)=""
"RTN","SCRPW301",37,0)
 D EN^XUTMDEVQ("EN1^SCRPW301",ZTDESC,.ZTSAVE)
"RTN","SCRPW301",38,0)
 D EX1
"RTN","SCRPW301",39,0)
 Q
"RTN","SCRPW301",40,0)
 ;
"RTN","SCRPW301",41,0)
EN1 ;Tasked entry point
"RTN","SCRPW301",42,0)
 ;Input  : SCRNARR - Screen array
"RTN","SCRPW301",43,0)
 ;         SORTARR - Sort array
"RTN","SCRPW301",44,0)
 ;Output : None
"RTN","SCRPW301",45,0)
 ;
"RTN","SCRPW301",46,0)
 ;Declare variables
"RTN","SCRPW301",47,0)
 N OUTARR,PAGENUM,ENODE,DFN,TMP
"RTN","SCRPW301",48,0)
 N SUB1,SUB2,PTRENC,DIV,PROV,TNODE,STOP
"RTN","SCRPW301",49,0)
 S OUTARR="^TMP(""SCRPW"",$J,""OUTARR"")"
"RTN","SCRPW301",50,0)
 S STOP=0
"RTN","SCRPW301",51,0)
 K @OUTARR
"RTN","SCRPW301",52,0)
 ;Get data
"RTN","SCRPW301",53,0)
 D GETDATA^SDPMUT1(SCRNARR,SORTARR,OUTARR)
"RTN","SCRPW301",54,0)
 ;Print summary page
"RTN","SCRPW301",55,0)
 S PAGENUM=1
"RTN","SCRPW301",56,0)
 D SUMMARY,WAIT I STOP D EXIT Q
"RTN","SCRPW301",57,0)
 ;Print detailed report
"RTN","SCRPW301",58,0)
 I '$D(@OUTARR) D EXIT Q
"RTN","SCRPW301",59,0)
 ;Loop through data
"RTN","SCRPW301",60,0)
 S STOP=0
"RTN","SCRPW301",61,0)
 S SUB1="" F  S SUB1=$O(@OUTARR@("DETAIL",SUB1)) Q:SUB1=""  D  Q:STOP
"RTN","SCRPW301",62,0)
 .D PRTHEAD
"RTN","SCRPW301",63,0)
 .S SUB2="" F  S SUB2=$O(@OUTARR@("DETAIL",SUB1,SUB2)) Q:SUB2=""  D  Q:STOP
"RTN","SCRPW301",64,0)
 ..S DFN=0 F  S DFN=+$O(@OUTARR@("DETAIL",SUB1,SUB2,DFN)) Q:'DFN  D  Q:STOP
"RTN","SCRPW301",65,0)
 ...S PTRENC=0 F  S PTRENC=+$O(@OUTARR@("DETAIL",SUB1,SUB2,DFN,PTRENC)) Q:'PTRENC  D  Q:STOP
"RTN","SCRPW301",66,0)
 ....S INFO=$G(@OUTARR@("DETAIL",SUB1,SUB2,DFN,PTRENC))
"RTN","SCRPW301",67,0)
 ....D PRTDTL
"RTN","SCRPW301",68,0)
 ....I $Y>(IOSL-5) D WAIT Q:STOP  D PRTHEAD
"RTN","SCRPW301",69,0)
 ....Q
"RTN","SCRPW301",70,0)
 ...Q
"RTN","SCRPW301",71,0)
 ..Q
"RTN","SCRPW301",72,0)
 .Q:STOP
"RTN","SCRPW301",73,0)
 .D SUB1SUM,WAIT
"RTN","SCRPW301",74,0)
 .Q
"RTN","SCRPW301",75,0)
 ;Clean up and quit
"RTN","SCRPW301",76,0)
 D EXIT
"RTN","SCRPW301",77,0)
 Q
"RTN","SCRPW301",78,0)
 ;
"RTN","SCRPW301",79,0)
SUMMARY ;Summary Page
"RTN","SCRPW301",80,0)
 ;Input  : SCRNARR - Screen array
"RTN","SCRPW301",81,0)
 ;         OUTARR - Data array
"RTN","SCRPW301",82,0)
 ;         PAGENUM - Page number
"RTN","SCRPW301",83,0)
 ;Output : None
"RTN","SCRPW301",84,0)
 ;         PAGENUM is incremented by 1
"RTN","SCRPW301",85,0)
 ;
"RTN","SCRPW301",86,0)
 N DIV,PROV,DSS,INFO,PS
"RTN","SCRPW301",87,0)
 I $E(IOST)="C" W @IOF
"RTN","SCRPW301",88,0)
 W !,"Performance Monitor Detailed Report",?120,"Page: ",PAGENUM
"RTN","SCRPW301",89,0)
 W !!,"Run Date: ",$$HTE^XLFDT($H)
"RTN","SCRPW301",90,0)
 W !!,"Encounter Date Range: ",?15,$$FMTE^XLFDT($P(@SCRNARR@("RANGE"),U,1))
"RTN","SCRPW301",91,0)
 W " to ",$$FMTE^XLFDT($P(@SCRNARR@("RANGE"),U,2))
"RTN","SCRPW301",92,0)
 W !!,"Time limit for acceptable signatures: ",@SCRNARR@("TLMT")
"RTN","SCRPW301",93,0)
 W !!,"Division(s): "
"RTN","SCRPW301",94,0)
 I @SCRNARR@("DIVISION")=0 D
"RTN","SCRPW301",95,0)
 .S PS=0
"RTN","SCRPW301",96,0)
 .S DIV=0 F  S DIV=$O(@SCRNARR@("DIVISION",DIV)) Q:'DIV  D
"RTN","SCRPW301",97,0)
 ..S INFO=@SCRNARR@("DIVISION",DIV)
"RTN","SCRPW301",98,0)
 ..I ($L(INFO)+$X+3)>(IOM-1) W !,?13,"/ " S PS=0
"RTN","SCRPW301",99,0)
 ..I PS W " / "
"RTN","SCRPW301",100,0)
 ..W INFO
"RTN","SCRPW301",101,0)
 ..S PS=1
"RTN","SCRPW301",102,0)
 .Q
"RTN","SCRPW301",103,0)
 I @SCRNARR@("DIVISION")=1 W "All"
"RTN","SCRPW301",104,0)
 W !!,"Provider(s): "
"RTN","SCRPW301",105,0)
 I @SCRNARR@("PROVIDERS")=0 D
"RTN","SCRPW301",106,0)
 .S PS=0
"RTN","SCRPW301",107,0)
 .S PROV=0 F  S PROV=$O(@SCRNARR@("PROVIDERS",PROV)) Q:'PROV  D
"RTN","SCRPW301",108,0)
 ..S INFO=@SCRNARR@("PROVIDERS",PROV)
"RTN","SCRPW301",109,0)
 ..I ($L(INFO)+$X+3)>(IOM-1) W !,?13,"/ " S PS=0
"RTN","SCRPW301",110,0)
 ..I PS W " / "
"RTN","SCRPW301",111,0)
 ..W INFO
"RTN","SCRPW301",112,0)
 ..S PS=1
"RTN","SCRPW301",113,0)
 .Q
"RTN","SCRPW301",114,0)
 I @SCRNARR@("PROVIDERS")=1 W "All"
"RTN","SCRPW301",115,0)
 W !!,"DSS ID(s)  : "
"RTN","SCRPW301",116,0)
 I @SCRNARR@("DSS")=0 D
"RTN","SCRPW301",117,0)
 .I @SCRNARR@("DSS-NTNL") W "All stop codes & credit pairs in national cohort" Q
"RTN","SCRPW301",118,0)
 .S PS=0
"RTN","SCRPW301",119,0)
 .S DSS=0 F  S DSS=$O(@SCRNARR@("DSS",DSS)) Q:'DSS  D
"RTN","SCRPW301",120,0)
 ..S INFO=@SCRNARR@("DSS",DSS)
"RTN","SCRPW301",121,0)
 ..I ($L(INFO)+$X+3)>(IOM-1) W !,?13,"/ " S PS=0
"RTN","SCRPW301",122,0)
 ..I PS W " / "
"RTN","SCRPW301",123,0)
 ..W INFO
"RTN","SCRPW301",124,0)
 ..S PS=1
"RTN","SCRPW301",125,0)
 I @SCRNARR@("DSS")=1 W "All"
"RTN","SCRPW301",126,0)
 W !!,"Count encounters with scanned notes: ",$S(@SCRNARR@("SCANNED"):"YES",1:"NO")
"RTN","SCRPW301",127,0)
 I '$D(@OUTARR) D  Q
"RTN","SCRPW301",128,0)
 .W !
"RTN","SCRPW301",129,0)
 .W !,"*********************************************"
"RTN","SCRPW301",130,0)
 .W !,"*  NOTHING TO REPORT FOR SELECTED CRITERIA  *"
"RTN","SCRPW301",131,0)
 .W !,"*********************************************"
"RTN","SCRPW301",132,0)
 S INFO=$$SITE^VASITE()
"RTN","SCRPW301",133,0)
 W !!,"Total for facility ",$P(INFO,"^",2)," (",$P(INFO,"^",3),")"
"RTN","SCRPW301",134,0)
 I $$S^%ZTLOAD() W !! Q
"RTN","SCRPW301",135,0)
 S INFO=$G(@OUTARR@("SUMMARY"))
"RTN","SCRPW301",136,0)
 D PRTSUMS
"RTN","SCRPW301",137,0)
 Q
"RTN","SCRPW301",138,0)
 ;
"RTN","SCRPW301",139,0)
PRTSUMS ;Print summaries
"RTN","SCRPW301",140,0)
 ;Input  : INFO - Summary information to print
"RTN","SCRPW301",141,0)
 ;         SCRNARR - Screen array
"RTN","SCRPW301",142,0)
 ;Output : None
"RTN","SCRPW301",143,0)
 ;
"RTN","SCRPW301",144,0)
 N VAL
"RTN","SCRPW301",145,0)
 W !,"Encounters (denominator): ",+$P(INFO,U,1)
"RTN","SCRPW301",146,0)
 W ?34,"Compliant Notes (numerator): ",+$P(INFO,U,2)
"RTN","SCRPW301",147,0)
 W ?69,"Compliance Rate: "
"RTN","SCRPW301",148,0)
 S VAL=0 I +$P(INFO,U,1)&($P(INFO,U,1)-$P(INFO,U,7))>0 S VAL=100*($P(INFO,U,2)/($P(INFO,U,1)-$P(INFO,U,7)))
"RTN","SCRPW301",149,0)
 W $TR($J(VAL,3,0)," ")_" %"
"RTN","SCRPW301",150,0)
 W !,?5,"Encounter Providers: ",+$P(INFO,U,4)
"RTN","SCRPW301",151,0)
 W ?34,"DSS IDs: ",+$P(INFO,U,5),?53,"Ave Time: "
"RTN","SCRPW301",152,0)
 S VAL=0 I +$P(INFO,U,8) S VAL=$P(INFO,U,6)/$P(INFO,U,8)
"RTN","SCRPW301",153,0)
 W $TR($J(VAL,3,0)," ")
"RTN","SCRPW301",154,0)
 I $G(@SCRNARR@("SCANNED")) W ?71,"Scanned Notes: ",+$P(INFO,U,7)
"RTN","SCRPW301",155,0)
 Q
"RTN","SCRPW301",156,0)
 ;
"RTN","SCRPW301",157,0)
WAIT ;End of page logic
"RTN","SCRPW301",158,0)
 ;Input  : None
"RTN","SCRPW301",159,0)
 ;Output : STOP - Flag indicating if printing should continue
"RTN","SCRPW301",160,0)
 ;                1 = Stop     0 = Continue
"RTN","SCRPW301",161,0)
 ;
"RTN","SCRPW301",162,0)
 S STOP=0
"RTN","SCRPW301",163,0)
 ;CRT - Prompt for continue
"RTN","SCRPW301",164,0)
 I $E(IOST,1,2)="C-"&(IOSL'>24) D  Q
"RTN","SCRPW301",165,0)
 .F  Q:$Y>(IOSL-3)  W !
"RTN","SCRPW301",166,0)
 .N DIR,X,Y,DTOUT,DUOUT,DIRUT,DIROUT
"RTN","SCRPW301",167,0)
 .S DIR(0)="E"
"RTN","SCRPW301",168,0)
 .D ^DIR
"RTN","SCRPW301",169,0)
 .S STOP=$S(Y'=1:1,1:0)
"RTN","SCRPW301",170,0)
 ;Background task - check TaskMan
"RTN","SCRPW301",171,0)
 S STOP=$$S^%ZTLOAD()
"RTN","SCRPW301",172,0)
 I STOP D
"RTN","SCRPW301",173,0)
 .W !,"*********************************************"
"RTN","SCRPW301",174,0)
 .W !,"*  PRINTING OF REPORT STOPPED AS REQUESTED  *"
"RTN","SCRPW301",175,0)
 .W !,"*********************************************"
"RTN","SCRPW301",176,0)
 Q
"RTN","SCRPW301",177,0)
 ;
"RTN","SCRPW301",178,0)
PRTHEAD ;Report Heading
"RTN","SCRPW301",179,0)
 ;Input  : SORTARR - Sort array
"RTN","SCRPW301",180,0)
 ;         PAGENUM - Page number
"RTN","SCRPW301",181,0)
 ;         SUB1 - Primary sort value
"RTN","SCRPW301",182,0)
 ;Output : None
"RTN","SCRPW301",183,0)
 ;         PAGENUM is incremented by 1
"RTN","SCRPW301",184,0)
 ;
"RTN","SCRPW301",185,0)
 N SORT,SORTTEXT,DASH,TYPE
"RTN","SCRPW301",186,0)
 S SORT=$G(@SORTARR)
"RTN","SCRPW301",187,0)
 S SORTTEXT=$G(@SORTARR@("TEXT"))
"RTN","SCRPW301",188,0)
 S PAGENUM=PAGENUM+1
"RTN","SCRPW301",189,0)
 S $P(DASH,"-",IOM)="-"
"RTN","SCRPW301",190,0)
 W @IOF
"RTN","SCRPW301",191,0)
 W !,"Performance indicator detailed report",?120,"Page: ",PAGENUM
"RTN","SCRPW301",192,0)
 W !!,"Report for ",$P(SORTTEXT,U,1)," "
"RTN","SCRPW301",193,0)
 S TYPE=$P(SORT,U,1) D
"RTN","SCRPW301",194,0)
 .I TYPE=1 W $P(SUB1,U,1)," (",$P(SUB1,U,2),")" Q
"RTN","SCRPW301",195,0)
 .I TYPE=5 W $$FMTE^XLFDT(SUB1,"D") Q
"RTN","SCRPW301",196,0)
 .W SUB1
"RTN","SCRPW301",197,0)
 W " sorted by ",$P(SORTTEXT,U,2)
"RTN","SCRPW301",198,0)
 W !!,"Encounter",?40,"Primary Encounter",?62,"DSS"
"RTN","SCRPW301",199,0)
 W ?89,"Acceptable Provider",?112,"Date",?122,"Time"
"RTN","SCRPW301",200,0)
 W !,"Date",?11,"Patient Name",?34,"SSN",?40,"Provider",?62,"ID"
"RTN","SCRPW301",201,0)
 W ?67,"Clinic Name",?89,"Signing Progress Note",?112,"Signed"
"RTN","SCRPW301",202,0)
 W ?122,"Span"
"RTN","SCRPW301",203,0)
 W !,$E(DASH,1,9),?11,$E(DASH,1,21),?34,$E(DASH,1,4),?40,$E(DASH,1,20)
"RTN","SCRPW301",204,0)
 W ?62,$E(DASH,1,3),?67,$E(DASH,1,20),?89,$E(DASH,1,21),?112,$E(DASH,1,8)
"RTN","SCRPW301",205,0)
 W ?122,$E(DASH,1,5)
"RTN","SCRPW301",206,0)
 Q
"RTN","SCRPW301",207,0)
 ;
"RTN","SCRPW301",208,0)
PRTDTL ;Print detail line
"RTN","SCRPW301",209,0)
 ;Input  : INFO - Detail information to print
"RTN","SCRPW301",210,0)
 ;         DFN - Pointer to Patient
"RTN","SCRPW301",211,0)
 ;         PTRENC - Pointer to Outpatient Encounter
"RTN","SCRPW301",212,0)
 ;Output : None
"RTN","SCRPW301",213,0)
 ;
"RTN","SCRPW301",214,0)
 N PROV,ENODE,VAL,VADM,VAERR,VA
"RTN","SCRPW301",215,0)
 D DEM^VADPT
"RTN","SCRPW301",216,0)
 S PROV=$$ENCPROV^SDPMUT2(PTRENC)
"RTN","SCRPW301",217,0)
 S ENODE=$G(^SCE(PTRENC,0))
"RTN","SCRPW301",218,0)
 S VAL=$$FMTE^XLFDT($P(ENODE,U,1),"2DF")
"RTN","SCRPW301",219,0)
 W !,$TR(VAL," ","0")
"RTN","SCRPW301",220,0)
 W ?11,$E(VADM(1),1,21)
"RTN","SCRPW301",221,0)
 W ?34,$E($P(VADM(2),U,1),6,10)
"RTN","SCRPW301",222,0)
 I PROV W ?40,$E($P($G(^VA(200,PROV,0)),U,1),1,20)
"RTN","SCRPW301",223,0)
 I 'PROV W ?40,"Provider Unknown"
"RTN","SCRPW301",224,0)
 S VAL=$P(ENODE,U,3)
"RTN","SCRPW301",225,0)
 S VAL=$P($G(^DIC(40.7,VAL,0)),U,2)
"RTN","SCRPW301",226,0)
 S:VAL="" VAL="???"
"RTN","SCRPW301",227,0)
 W ?62,VAL
"RTN","SCRPW301",228,0)
 S VAL=$P(ENODE,U,4)
"RTN","SCRPW301",229,0)
 S VAL=$P($G(^SC(VAL,0)),U,1)
"RTN","SCRPW301",230,0)
 S:VAL="" VAL="Clinic Unknown"
"RTN","SCRPW301",231,0)
 W ?67,$E(VAL,1,20)
"RTN","SCRPW301",232,0)
 S VAL=$P(INFO,U,1)
"RTN","SCRPW301",233,0)
 I VAL W ?89,$E($P($G(^VA(200,VAL,0)),U,1),1,21)
"RTN","SCRPW301",234,0)
 S VAL=$P(INFO,U,2)
"RTN","SCRPW301",235,0)
 I VAL S VAL=$$FMTE^XLFDT(VAL,"2DF") W ?112,$TR(VAL," ","0")
"RTN","SCRPW301",236,0)
 W ?122,$P(INFO,U,3)
"RTN","SCRPW301",237,0)
 Q
"RTN","SCRPW301",238,0)
 ;
"RTN","SCRPW301",239,0)
SUB1SUM ;Summary for primary sort
"RTN","SCRPW301",240,0)
 ;Input  : SORTARR - Sort array
"RTN","SCRPW301",241,0)
 ;         OUTARR - Data array
"RTN","SCRPW301",242,0)
 ;         SUB1 - Primary sort value (1st subscript in OUTARR)
"RTN","SCRPW301",243,0)
 ;Output : None
"RTN","SCRPW301",244,0)
 ;
"RTN","SCRPW301",245,0)
 N SORT,SORTTEXT,TYPE,INFO
"RTN","SCRPW301",246,0)
 I $Y>(IOSL+6) D WAIT Q:STOP  D PRTHEAD
"RTN","SCRPW301",247,0)
 S SORT=$G(@SORTARR)
"RTN","SCRPW301",248,0)
 S SORTTEXT=$G(@SORTARR@("TEXT"))
"RTN","SCRPW301",249,0)
 S INFO=$G(@OUTARR@("SUBTOTAL",SUB1))
"RTN","SCRPW301",250,0)
 W !!,"Total for ",$P(SORTTEXT,U,1)," "
"RTN","SCRPW301",251,0)
 S TYPE=$P(SORT,U,1) D
"RTN","SCRPW301",252,0)
 .I TYPE=1 W $P(SUB1,U,1)," (",$P(SUB1,U,2),")" Q
"RTN","SCRPW301",253,0)
 .I TYPE=5 W $$FMTE^XLFDT(SUB1,"D") Q
"RTN","SCRPW301",254,0)
 .W SUB1
"RTN","SCRPW301",255,0)
 D PRTSUMS
"RTN","SCRPW301",256,0)
 Q
"RTN","SCRPW301",257,0)
 ;
"RTN","SCRPW301",258,0)
EXIT ;Kill temporary arrays
"RTN","SCRPW301",259,0)
 K @OUTARR
"RTN","SCRPW301",260,0)
EX1 K @SCRNARR,@SORTARR
"RTN","SCRPW301",261,0)
 Q
"RTN","SCRPW304")
0^3^B26371926
"RTN","SCRPW304",1,0)
SCRPW304 ; BPFO/JRC - Performance Monitors National Summary Report; 30 Jul 2003 ; 2/5/04 7:13am
"RTN","SCRPW304",2,0)
 ;;5.3;SCHEDULING;**292,335**;AUG 13, 1993
"RTN","SCRPW304",3,0)
 ;
"RTN","SCRPW304",4,0)
EN ;Main Entry Point
"RTN","SCRPW304",5,0)
 ;Declare variable(s) and arrays
"RTN","SCRPW304",6,0)
 N SCRNARR,SORTARR
"RTN","SCRPW304",7,0)
 S SCRNARR="^TMP(""SCRPW"",$J,""SCRNARR"")"
"RTN","SCRPW304",8,0)
 S SORTARR="^TMP(""SCRPW"",$J,""SORTARR"")"
"RTN","SCRPW304",9,0)
 K @SCRNARR,@SORTARR
"RTN","SCRPW304",10,0)
 ;Set national screen/sort
"RTN","SCRPW304",11,0)
 D ROLLUP^SCRPW303(SCRNARR,SORTARR)
"RTN","SCRPW304",12,0)
 ;Get date frame
"RTN","SCRPW304",13,0)
 I $$DATE^SCRPW302("","",SCRNARR)=0 D EX1 Q
"RTN","SCRPW304",14,0)
 ;Queue report
"RTN","SCRPW304",15,0)
 W !!
"RTN","SCRPW304",16,0)
 N ZTDESC,ZTIO,ZTSAVE,TMP
"RTN","SCRPW304",17,0)
 S ZTIO=""
"RTN","SCRPW304",18,0)
 S ZTDESC="Performance Monitor National Summary Report"
"RTN","SCRPW304",19,0)
 S ZTSAVE("SCRNARR")=""
"RTN","SCRPW304",20,0)
 S TMP=$$OREF^DILF(SCRNARR)
"RTN","SCRPW304",21,0)
 S ZTSAVE(TMP)=""
"RTN","SCRPW304",22,0)
 I $D(@SCRNARR)#2 S ZTSAVE(SCRNARR)=""
"RTN","SCRPW304",23,0)
 S ZTSAVE("SORTARR")=""
"RTN","SCRPW304",24,0)
 S TMP=$$OREF^DILF(SORTARR)
"RTN","SCRPW304",25,0)
 S ZTSAVE(TMP)=""
"RTN","SCRPW304",26,0)
 I $D(@SORTARR)#2 S ZTSAVE(SORTARR)=""
"RTN","SCRPW304",27,0)
 D EN^XUTMDEVQ("EN1^SCRPW304",ZTDESC,.ZTSAVE)
"RTN","SCRPW304",28,0)
 D EX1
"RTN","SCRPW304",29,0)
 Q
"RTN","SCRPW304",30,0)
 ;
"RTN","SCRPW304",31,0)
EN1 ;Tasked entry point
"RTN","SCRPW304",32,0)
 ;Input  : SCRNARR - Screen array
"RTN","SCRPW304",33,0)
 ;         SORTARR - Sort array
"RTN","SCRPW304",34,0)
 ;Output : None
"RTN","SCRPW304",35,0)
 ;
"RTN","SCRPW304",36,0)
 N OUTARR,STOP,PAGENUM,STOP,SUMNODE,PINODE,DIV
"RTN","SCRPW304",37,0)
 S OUTARR="^TMP(""SCRPW"",$J,""OUTARR"")"
"RTN","SCRPW304",38,0)
 S STOP=0
"RTN","SCRPW304",39,0)
 K @OUTARR
"RTN","SCRPW304",40,0)
 S PAGENUM=1
"RTN","SCRPW304",41,0)
 ;Get data
"RTN","SCRPW304",42,0)
 D GETDATA^SDPMUT1(SCRNARR,SORTARR,OUTARR)
"RTN","SCRPW304",43,0)
 ;Print summary for facility
"RTN","SCRPW304",44,0)
 S DIV=""
"RTN","SCRPW304",45,0)
 D PRTHEAD
"RTN","SCRPW304",46,0)
 S SUMNODE=$G(@OUTARR@("SUMMARY"))
"RTN","SCRPW304",47,0)
 S PINODE=$G(@OUTARR@("SUMMARY","PI"))
"RTN","SCRPW304",48,0)
 I '$$S^%ZTLOAD() D PRTSUMS
"RTN","SCRPW304",49,0)
 D WAIT^SCRPW301 I STOP D EXIT Q
"RTN","SCRPW304",50,0)
 ;Print divisional summaries
"RTN","SCRPW304",51,0)
 S DIV="" F  S DIV=$O(@OUTARR@("SUBTOTAL",DIV)) Q:DIV=""  D  Q:STOP
"RTN","SCRPW304",52,0)
 .D PRTHEAD
"RTN","SCRPW304",53,0)
 .S SUMNODE=$G(@OUTARR@("SUBTOTAL",DIV))
"RTN","SCRPW304",54,0)
 .S PINODE=$G(@OUTARR@("SUBTOTAL",DIV,"PI"))
"RTN","SCRPW304",55,0)
 .D PRTSUMS
"RTN","SCRPW304",56,0)
 .D WAIT^SCRPW301 I STOP Q
"RTN","SCRPW304",57,0)
 ;Cleanup and quit
"RTN","SCRPW304",58,0)
 D EXIT
"RTN","SCRPW304",59,0)
 Q
"RTN","SCRPW304",60,0)
 ;
"RTN","SCRPW304",61,0)
PRTHEAD ;Page Header
"RTN","SCRPW304",62,0)
 ;Input  : OUTARR - Data array
"RTN","SCRPW304",63,0)
 ;         SCRNARR - Screen array
"RTN","SCRPW304",64,0)
 ;         PAGENUM - Page number
"RTN","SCRPW304",65,0)
 ;         DIV - Division Name ^ Division Number
"RTN","SCRPW304",66,0)
 ;             - NULL if facility name/number should be used
"RTN","SCRPW304",67,0)
 ;Output : None
"RTN","SCRPW304",68,0)
 ;         PAGENUM is incremented by 1
"RTN","SCRPW304",69,0)
 ;
"RTN","SCRPW304",70,0)
 N TMP,LINE,VISN
"RTN","SCRPW304",71,0)
 W @IOF
"RTN","SCRPW304",72,0)
 W !,"Performance Monitor National Summary Report",?70,"Page: ",PAGENUM
"RTN","SCRPW304",73,0)
 S LINE="Division: "_$P(DIV,U,1)_" ("_$P(DIV,U,2)_")"
"RTN","SCRPW304",74,0)
 I DIV="" D
"RTN","SCRPW304",75,0)
 .S TMP=$$SITE^VASITE()
"RTN","SCRPW304",76,0)
 .D PARENT^XUAF4("VISN",$P(TMP,U,1))
"RTN","SCRPW304",77,0)
 .S VISN="" F VISN=$O(VISN("P",VISN)) Q:VISN=""
"RTN","SCRPW304",78,0)
 .S LINE="Facility: "_$P(TMP,U,2)_" ("_$P(TMP,U,3)_")"_" "_$P($G(VISN("P",VISN)),U,1)
"RTN","SCRPW304",79,0)
 W !!,LINE
"RTN","SCRPW304",80,0)
 W !,"Run Date: ",$$HTE^XLFDT($H)
"RTN","SCRPW304",81,0)
 W !,"Encounter Date Range: ",$$FMTE^XLFDT($P(@SCRNARR@("RANGE"),U,1))
"RTN","SCRPW304",82,0)
 W " to ",$$FMTE^XLFDT($P(@SCRNARR@("RANGE"),U,2))
"RTN","SCRPW304",83,0)
 I DIV="" S LINE=+$G(@OUTARR@("SUMMARY"))
"RTN","SCRPW304",84,0)
 I DIV'="" S LINE=+$G(@OUTARR@("SUBTOTAL",DIV))
"RTN","SCRPW304",85,0)
 W !,"Total number of encounters (denominator): ",LINE
"RTN","SCRPW304",86,0)
 W !!,"Total number of encounters in the denominator are those included in the"
"RTN","SCRPW304",87,0)
 W !,"Performance Monitor cohort"
"RTN","SCRPW304",88,0)
 S PAGENUM=PAGENUM+1
"RTN","SCRPW304",89,0)
 Q
"RTN","SCRPW304",90,0)
 ;
"RTN","SCRPW304",91,0)
PRTSUMS ;Print summaries
"RTN","SCRPW304",92,0)
 ;Input  : SUMNODE - Summary node from OUTARR
"RTN","SCRPW304",93,0)
 ;         PINODE - PI node from OUTARR
"RTN","SCRPW304",94,0)
 ;Output : None
"RTN","SCRPW304",95,0)
 ;
"RTN","SCRPW304",96,0)
 I (SUMNODE="")&(PINODE="") D  Q
"RTN","SCRPW304",97,0)
 .W !
"RTN","SCRPW304",98,0)
 .W !,"***********************************************"
"RTN","SCRPW304",99,0)
 .W !,"*  NOTHING TO REPORT FOR SELECTED DATE FRAME  *"
"RTN","SCRPW304",100,0)
 .W !,"***********************************************"
"RTN","SCRPW304",101,0)
 N VAL,DASH6,TOTENC,CMPENC,PRCNT,TMP,SCANNED,NPN
"RTN","SCRPW304",102,0)
 S $P(DASH6,"-",6)="-"
"RTN","SCRPW304",103,0)
 S $P(PRCNT,U,11)=""
"RTN","SCRPW304",104,0)
 ;Get general totals
"RTN","SCRPW304",105,0)
 S TOTENC=+$P(SUMNODE,U,1)
"RTN","SCRPW304",106,0)
 S CMPENC=+$P(SUMNODE,U,2)
"RTN","SCRPW304",107,0)
 S SCANNED=+$P(SUMNODE,U,7)
"RTN","SCRPW304",108,0)
 S NPN=+$P(SUMNODE,U,9)
"RTN","SCRPW304",109,0)
 ;Calculate compliance percentages
"RTN","SCRPW304",110,0)
 I TOTENC S VAL=0 F TMP=1:1:11 D
"RTN","SCRPW304",111,0)
 .I (TOTENC-SCANNED)>0 S VAL=100*($P(PINODE,U,TMP)/(TOTENC-SCANNED))
"RTN","SCRPW304",112,0)
 .S $P(PRCNT,U,TMP)=$TR($J(VAL,3,0)," ")_"%"
"RTN","SCRPW304",113,0)
 ;Part 1
"RTN","SCRPW304",114,0)
 W !!,"Signed",?21,"Elapsed Time (Days)"
"RTN","SCRPW304",115,0)
 W !,"within",?14,"0-1",?22,">1-2",?31,">2-3",?39,">3-4",?47,">4-5"
"RTN","SCRPW304",116,0)
 W ?55,">5-6",?63,">6-7",?71,">7-8"
"RTN","SCRPW304",117,0)
 W !,?13,DASH6,?21,DASH6,?30,DASH6,?38,DASH6,?46,DASH6,?54,DASH6
"RTN","SCRPW304",118,0)
 W ?62,DASH6,?70,DASH6
"RTN","SCRPW304",119,0)
 W !,"Encounters",?13,+$P(PINODE,U,1),?21,+$P(PINODE,U,2)
"RTN","SCRPW304",120,0)
 W ?30,+$P(PINODE,U,3),?38,+$P(PINODE,U,4),?46,+$P(PINODE,U,5)
"RTN","SCRPW304",121,0)
 W ?54,+$P(PINODE,U,6),?62,+$P(PINODE,U,7),?70,+$P(PINODE,U,8)
"RTN","SCRPW304",122,0)
 W !,"Percentage",?13,$P(PRCNT,U,1),?21,$P(PRCNT,U,2)
"RTN","SCRPW304",123,0)
 W ?30,$P(PRCNT,U,3),?38,$P(PRCNT,U,4),?46,$P(PRCNT,U,5)
"RTN","SCRPW304",124,0)
 W ?54,$P(PRCNT,U,6),?62,$P(PRCNT,U,7),?70,$P(PRCNT,U,8)
"RTN","SCRPW304",125,0)
 ;Part 2
"RTN","SCRPW304",126,0)
 W !!,"Signed",?21,"Elapsed Time (Days)",?45,"Pending",?60,"Scanned"
"RTN","SCRPW304",127,0)
 W !,"within",?14,">8-9",?22,">9-10",?32,">10",?38,"Signatures"
"RTN","SCRPW304",128,0)
 W ?50,"Notes",?59,"Note Only"
"RTN","SCRPW304",129,0)
 W !,?13,DASH6,?21,DASH6,?30,DASH6,?38,DASH6_"----"
"RTN","SCRPW304",130,0)
 W ?50,DASH6,?59,DASH6_"---"
"RTN","SCRPW304",131,0)
 W !,"Encounters",?13,+$P(PINODE,U,9),?21,+$P(PINODE,U,10)
"RTN","SCRPW304",132,0)
 W ?30,+$P(PINODE,U,11),?38,TOTENC-CMPENC-NPN-SCANNED-(+$P(PINODE,U,11))
"RTN","SCRPW304",133,0)
 W ?50,NPN,?59,SCANNED
"RTN","SCRPW304",134,0)
 W !,"Percentage",?13,$P(PRCNT,U,9),?21,$P(PRCNT,U,10)
"RTN","SCRPW304",135,0)
 W ?30,$P(PRCNT,U,11)
"RTN","SCRPW304",136,0)
 S (VAL,NPNVAL)=0
"RTN","SCRPW304",137,0)
 I (TOTENC-SCANNED)>0 S NPNVAL=100*(NPN/(TOTENC-SCANNED))
"RTN","SCRPW304",138,0)
 S NPNVAL=$TR($J(NPNVAL,3,0)," ")_"%"
"RTN","SCRPW304",139,0)
 I (TOTENC-SCANNED)>0 S VAL=100*((TOTENC-SCANNED-CMPENC-NPN-(+$P(PINODE,U,11)))/TOTENC)
"RTN","SCRPW304",140,0)
 S VAL=$TR($J(VAL,3,0)," ")_"%"
"RTN","SCRPW304",141,0)
 W ?38,VAL,?50,NPNVAL,?59,"N/A"
"RTN","SCRPW304",142,0)
 Q
"RTN","SCRPW304",143,0)
 ;
"RTN","SCRPW304",144,0)
EXIT ;Kill temporary arrays
"RTN","SCRPW304",145,0)
 K @OUTARR
"RTN","SCRPW304",146,0)
EX1 K @SORTARR,@SCRNARR
"RTN","SCRPW304",147,0)
 Q
"RTN","SDPMUT1")
0^1^B47732047
"RTN","SDPMUT1",1,0)
SDPMUT1 ; BPFO/JRC - Performance Monitors Utilities; 6-19-2003 ; 12/22/03 11:32am
"RTN","SDPMUT1",2,0)
 ;;5.3;SCHEDULING;**292,335**;AUGUST 13, 1993
"RTN","SDPMUT1",3,0)
 ;
"RTN","SDPMUT1",4,0)
GETDATA(SCRNARR,SORTARR,OUTARR) ;Get progress note compliance information
"RTN","SDPMUT1",5,0)
 ;Input  : SCRNARR - Screening array full global reference
"RTN","SDPMUT1",6,0)
 ;         SORTARR - Sort array full global reference
"RTN","SDPMUT1",7,0)
 ;         OUTARR  - Output array full global reference
"RTN","SDPMUT1",8,0)
 ;Output : None
"RTN","SDPMUT1",9,0)
 ;         @OUTARR@("SUMMARY") = Enc^Comply^ ^Prov^Stop^ET^Scan^Signed
"RTN","SDPMUT1",10,0)
 ;           Enc    - Number of encounters checked for compliance
"RTN","SDPMUT1",11,0)
 ;           Comply - Compliant encounters (note signed w/in time limit)
"RTN","SDPMUT1",12,0)
 ;           Prov   - Unique primary encounter providers
"RTN","SDPMUT1",13,0)
 ;           Stop   - Unique primary stop codes
"RTN","SDPMUT1",14,0)
 ;           ET     - Total elapsed time (days) to sign PN
"RTN","SDPMUT1",15,0)
 ;           Scan   - Encounters with scanned notes
"RTN","SDPMUT1",16,0)
 ;           Signed - Encounters with signed notes
"RTN","SDPMUT1",17,0)
 ;         @OUTARR@("SUBTOTAL",SUB1) = SUMMARY node for sort level 1
"RTN","SDPMUT1",18,0)
 ;         @OUTARR@("SUMMARY","PI") = F0^F1^F2^F3^F4^F5^F6^F7^F8^F9^F10^F11
"RTN","SDPMUT1",19,0)
 ;           Fx  - Notes signed in x to X+1 days
"RTN","SDPMUT1",20,0)
 ;           F11 - Notes signed in 10 or more days
"RTN","SDPMUT1",21,0)
 ;         @OUTARR@("SUBTOTAL",SUB1,"PI") = PI node for sort level 1
"RTN","SDPMUT1",22,0)
 ;         @OUTARR@("DETAIL",SUB1,SUB2,DFN,PtrEnc) = Prov^DT^ET
"RTN","SDPMUT1",23,0)
 ;           Prov - TIU Provider
"RTN","SDPMUT1",24,0)
 ;           DT   - Date Provider signed progress note
"RTN","SDPMUT1",25,0)
 ;           ET   - Number of days that elpased before signing PN
"RTN","SDPMUT1",26,0)
 ;Note   : OUTARR is initialized (i.e. KILLed) on input
"RTN","SDPMUT1",27,0)
 ;       : When division is used as a sorting subscript,
"RTN","SDPMUT1",28,0)
 ;         DivisionName^DivisionNumber is used as the subscript
"RTN","SDPMUT1",29,0)
 ;       : Time is stripped from the encounter date when used as a
"RTN","SDPMUT1",30,0)
 ;         sorting subscript
"RTN","SDPMUT1",31,0)
 ;
"RTN","SDPMUT1",32,0)
 ;Declare variables
"RTN","SDPMUT1",33,0)
 N PTRENC,DATE,ENDDATE,UNQARR,STOP,LOOP
"RTN","SDPMUT1",34,0)
 ;Get begin and end dates for scan
"RTN","SDPMUT1",35,0)
 S DATE=$G(@SCRNARR@("RANGE"))
"RTN","SDPMUT1",36,0)
 S ENDDATE=$P(DATE,U,2)
"RTN","SDPMUT1",37,0)
 S DATE=$P(DATE,U,1)
"RTN","SDPMUT1",38,0)
 Q:('DATE)!('ENDDATE)
"RTN","SDPMUT1",39,0)
 S DATE=$P(DATE,".",1)-.000001
"RTN","SDPMUT1",40,0)
 S $P(ENDDATE,".",2)=999999
"RTN","SDPMUT1",41,0)
 ;Initialize output and array used to track uniques
"RTN","SDPMUT1",42,0)
 S UNQARR=$NA(^TMP("SDPMUT1-UNIQUE",$J))
"RTN","SDPMUT1",43,0)
 K @UNQARR,@OUTARR
"RTN","SDPMUT1",44,0)
 ;Scan
"RTN","SDPMUT1",45,0)
 S STOP=0
"RTN","SDPMUT1",46,0)
 F LOOP=1:1 S DATE=+$O(^SCE("B",DATE)) Q:('DATE)!(DATE>ENDDATE)  D  Q:STOP
"RTN","SDPMUT1",47,0)
 .S PTRENC=0
"RTN","SDPMUT1",48,0)
 .F  S PTRENC=+$O(^SCE("B",DATE,PTRENC)) Q:'PTRENC  D  Q:STOP
"RTN","SDPMUT1",49,0)
 ..;Task asked to stop
"RTN","SDPMUT1",50,0)
 ..I '(LOOP#100) S STOP=$$S^%ZTLOAD()  Q:STOP
"RTN","SDPMUT1",51,0)
 ..;Screen out encounter
"RTN","SDPMUT1",52,0)
 ..Q:$$SCREEN^SDPMUT2(PTRENC,SCRNARR)
"RTN","SDPMUT1",53,0)
 ..;Set output array
"RTN","SDPMUT1",54,0)
 ..D GET
"RTN","SDPMUT1",55,0)
 ;Cleanup and quit
"RTN","SDPMUT1",56,0)
 K @UNQARR
"RTN","SDPMUT1",57,0)
 Q
"RTN","SDPMUT1",58,0)
GET ;Get info & establish output array for GETDATA
"RTN","SDPMUT1",59,0)
 ;Input  : PTRENC - Pointer to Outpatient Encounter file
"RTN","SDPMUT1",60,0)
 ;         UNQARR - Array to use for unique calculations
"RTN","SDPMUT1",61,0)
 ;         Input parameters for GETDATA (SCRNARR, SORTARR, and OUTARR)
"RTN","SDPMUT1",62,0)
 ;Ouput  : See GETDATA for format of nodes set into OUTARR
"RTN","SDPMUT1",63,0)
 ;         Unique Stop Codes
"RTN","SDPMUT1",64,0)
 ;           @UNQARR@("SUMMARY","STOP",PtrStopCode)
"RTN","SDPMUT1",65,0)
 ;           @UNQARR@("SUBTOTAL","STOP",SUB1,PtrStopCode)
"RTN","SDPMUT1",66,0)
 ;         Unique Primary Encounter Providers
"RTN","SDPMUT1",67,0)
 ;           @UNQARR@("SUMMARY","PROV",PtrProvider)
"RTN","SDPMUT1",68,0)
 ;           @UNQARR@("SUBTOTAL","PROV",SUB1,PtrProvider)
"RTN","SDPMUT1",69,0)
 ;Declare variables
"RTN","SDPMUT1",70,0)
 N DFN,DIV,CLINIC,NODE,NOTEINFO,PROV,ENCDT,SUB1,SUB2,TIUPROV
"RTN","SDPMUT1",71,0)
 N TIUDT,TIUET,SUMNODE,SUBNODE,ESUB1,ESUB2,SCODE,X
"RTN","SDPMUT1",72,0)
 S NODE=^SCE(PTRENC,0)
"RTN","SDPMUT1",73,0)
 S DFN=+$P(NODE,U,2),DIV=+$P(NODE,U,11),CLINIC=+$P(NODE,U,4)
"RTN","SDPMUT1",74,0)
 S SCODE=+$P(NODE,U,3),ENCDT=+NODE
"RTN","SDPMUT1",75,0)
 ;Get primary encounter provider
"RTN","SDPMUT1",76,0)
 S PROV=$$ENCPROV^SDPMUT2(PTRENC)
"RTN","SDPMUT1",77,0)
 ;Set sorting subscripts (ESUB1 & ESUB2)
"RTN","SDPMUT1",78,0)
 ;  If SUBx = 1 Set sorting criteria to division
"RTN","SDPMUT1",79,0)
 ;  If SUBx = 2 Set soring criteria to clinic
"RTN","SDPMUT1",80,0)
 ;  If SUBx = 3 Set sorting criteria to Provider
"RTN","SDPMUT1",81,0)
 ;  If SUBx = 4 Set sorting criteria to Stop Code
"RTN","SDPMUT1",82,0)
 ;  If SUBx = 5 Set sorting criteria to Encounter Date
"RTN","SDPMUT1",83,0)
 ;  If SUBx = 6 Set sorting criteria to Patient
"RTN","SDPMUT1",84,0)
 S NODE=@SORTARR
"RTN","SDPMUT1",85,0)
 S SUB1=$P(NODE,"^",1)
"RTN","SDPMUT1",86,0)
 S SUB2=$P(NODE,"^",2)
"RTN","SDPMUT1",87,0)
 F NODE="SUB1","SUB2" D  I @("E"_NODE)="" S @("E"_NODE)="UNKNOWN"
"RTN","SDPMUT1",88,0)
 .I @NODE=1 D  Q
"RTN","SDPMUT1",89,0)
 ..S X=$G(^DG(40.8,DIV,0))
"RTN","SDPMUT1",90,0)
 ..S @("E"_NODE)=$P(X,U,1)_"^"_$P(X,U,2)
"RTN","SDPMUT1",91,0)
 .I @NODE=2 D  Q
"RTN","SDPMUT1",92,0)
 ..S @("E"_NODE)=$P($G(^SC(CLINIC,0)),U,1)
"RTN","SDPMUT1",93,0)
 .I @NODE=3 D  Q
"RTN","SDPMUT1",94,0)
 ..S @("E"_NODE)=$P($G(^VA(200,PROV,0)),U,1)
"RTN","SDPMUT1",95,0)
 .I @NODE=4 D  Q
"RTN","SDPMUT1",96,0)
 ..S @("E"_NODE)=$P($G(^DIC(40.7,SCODE,0)),U,1)
"RTN","SDPMUT1",97,0)
 .I @NODE=5 D  Q
"RTN","SDPMUT1",98,0)
 ..S @("E"_NODE)=$P(ENCDT,".",1)
"RTN","SDPMUT1",99,0)
 .I @NODE=6 D  Q
"RTN","SDPMUT1",100,0)
 ..S @("E"_NODE)=$P($G(^DPT(DFN,0)),U,1)
"RTN","SDPMUT1",101,0)
 .S @("E"_NODE)="UNKNOWN"
"RTN","SDPMUT1",102,0)
 ;Increment Encounters for hospital and sort level 1
"RTN","SDPMUT1",103,0)
 S $P(@OUTARR@("SUMMARY"),U,1)=$P($G(@OUTARR@("SUMMARY")),U,1)+1
"RTN","SDPMUT1",104,0)
 S $P(@OUTARR@("SUBTOTAL",ESUB1),U,1)=$P($G(@OUTARR@("SUBTOTAL",ESUB1)),U,1)+1
"RTN","SDPMUT1",105,0)
 ;Get TIU information
"RTN","SDPMUT1",106,0)
 S NOTEINFO=$$NOTEINF^SDPMUT2(PTRENC)
"RTN","SDPMUT1",107,0)
 S (TIUPROV,TIUDT,TIUET)=""
"RTN","SDPMUT1",108,0)
 ;Only update performance indicators for note status of B
"RTN","SDPMUT1",109,0)
 I $P((NOTEINFO),U,2)="B" D
"RTN","SDPMUT1",110,0)
 .S TIUPROV=$P((NOTEINFO),U,5)
"RTN","SDPMUT1",111,0)
 .S TIUDT=$P((NOTEINFO),U,6)
"RTN","SDPMUT1",112,0)
 .I 'TIUPROV D
"RTN","SDPMUT1",113,0)
 ..S TIUPROV=$P((NOTEINFO),U,3)
"RTN","SDPMUT1",114,0)
 ..S TIUDT=$P((NOTEINFO),U,4)
"RTN","SDPMUT1",115,0)
 .S TIUET=$$FMDIFF^XLFDT(TIUDT,ENCDT)
"RTN","SDPMUT1",116,0)
 .I TIUET<0 Q
"RTN","SDPMUT1",117,0)
 .;Increment Compliant Notes for hospital and sort level 1
"RTN","SDPMUT1",118,0)
 .I TIUET'>@SCRNARR@("TLMT") D
"RTN","SDPMUT1",119,0)
 ..S $P(@OUTARR@("SUMMARY"),U,2)=$P($G(@OUTARR@("SUMMARY")),U,2)+1
"RTN","SDPMUT1",120,0)
 ..S $P(@OUTARR@("SUBTOTAL",ESUB1),U,2)=$P($G(@OUTARR@("SUBTOTAL",ESUB1)),U,2)+1
"RTN","SDPMUT1",121,0)
 .;Increment Total Elapsed Time for hospital and sort level 1
"RTN","SDPMUT1",122,0)
 .S $P(@OUTARR@("SUMMARY"),U,6)=$P($G(@OUTARR@("SUMMARY")),U,6)+TIUET
"RTN","SDPMUT1",123,0)
 .S $P(@OUTARR@("SUBTOTAL",ESUB1),U,6)=$P($G(@OUTARR@("SUBTOTAL",ESUB1)),U,6)+TIUET
"RTN","SDPMUT1",124,0)
 .;Increment Total Signed Notes for hospital and sort level 1
"RTN","SDPMUT1",125,0)
 .S $P(@OUTARR@("SUMMARY"),U,8)=$P($G(@OUTARR@("SUMMARY")),U,8)+1
"RTN","SDPMUT1",126,0)
 .S $P(@OUTARR@("SUBTOTAL",ESUB1),U,8)=$P($G(@OUTARR@("SUBTOTAL",ESUB1)),U,8)+1
"RTN","SDPMUT1",127,0)
 .;Update performance indicator node for hospital and sort level 1
"RTN","SDPMUT1",128,0)
 .S SUMNODE=$G(@OUTARR@("SUMMARY","PI"))
"RTN","SDPMUT1",129,0)
 .S SUBNODE=$G(@OUTARR@("SUBTOTAL",ESUB1,"PI"))
"RTN","SDPMUT1",130,0)
 .I TIUET'<0&(TIUET'>1) D
"RTN","SDPMUT1",131,0)
 ..S $P(SUMNODE,U,1)=$P($G(SUMNODE),U,1)+1
"RTN","SDPMUT1",132,0)
 ..S $P(SUBNODE,U,1)=$P($G(SUBNODE),U,1)+1
"RTN","SDPMUT1",133,0)
 .I TIUET>1&(TIUET'>2) D
"RTN","SDPMUT1",134,0)
 ..S $P(SUMNODE,U,2)=$P($G(SUMNODE),U,2)+1
"RTN","SDPMUT1",135,0)
 ..S $P(SUBNODE,U,2)=$P($G(SUBNODE),U,2)+1
"RTN","SDPMUT1",136,0)
 .I TIUET>2&(TIUET'>3) D
"RTN","SDPMUT1",137,0)
 ..S $P(SUMNODE,U,3)=$P($G(SUMNODE),U,3)+1
"RTN","SDPMUT1",138,0)
 ..S $P(SUBNODE,U,3)=$P($G(SUBNODE),U,3)+1
"RTN","SDPMUT1",139,0)
 .I TIUET>3&(TIUET'>4) D
"RTN","SDPMUT1",140,0)
 ..S $P(SUMNODE,U,4)=$P($G(SUMNODE),U,4)+1
"RTN","SDPMUT1",141,0)
 ..S $P(SUBNODE,U,4)=$P($G(SUBNODE),U,4)+1
"RTN","SDPMUT1",142,0)
 .I TIUET>4&(TIUET'>5) D
"RTN","SDPMUT1",143,0)
 ..S $P(SUMNODE,U,5)=$P($G(SUMNODE),U,5)+1
"RTN","SDPMUT1",144,0)
 ..S $P(SUBNODE,U,5)=$P($G(SUBNODE),U,5)+1
"RTN","SDPMUT1",145,0)
 .I TIUET>5&(TIUET'>6) D
"RTN","SDPMUT1",146,0)
 ..S $P(SUMNODE,U,6)=$P($G(SUMNODE),U,6)+1
"RTN","SDPMUT1",147,0)
 ..S $P(SUBNODE,U,6)=$P($G(SUBNODE),U,6)+1
"RTN","SDPMUT1",148,0)
 .I TIUET>6&(TIUET'>7) D
"RTN","SDPMUT1",149,0)
 ..S $P(SUMNODE,U,7)=$P($G(SUMNODE),U,7)+1
"RTN","SDPMUT1",150,0)
 ..S $P(SUBNODE,U,7)=$P($G(SUBNODE),U,7)+1
"RTN","SDPMUT1",151,0)
 .I TIUET>7&(TIUET'>8) D
"RTN","SDPMUT1",152,0)
 ..S $P(SUMNODE,U,8)=$P($G(SUMNODE),U,8)+1
"RTN","SDPMUT1",153,0)
 ..S $P(SUBNODE,U,8)=$P($G(SUBNODE),U,8)+1
"RTN","SDPMUT1",154,0)
 .I TIUET>8&(TIUET'>9) D
"RTN","SDPMUT1",155,0)
 ..S $P(SUMNODE,U,9)=$P($G(SUMNODE),U,9)+1
"RTN","SDPMUT1",156,0)
 ..S $P(SUBNODE,U,9)=$P($G(SUBNODE),U,9)+1
"RTN","SDPMUT1",157,0)
 .I TIUET>9&(TIUET'>10) D
"RTN","SDPMUT1",158,0)
 ..S $P(SUMNODE,U,10)=$P($G(SUMNODE),U,10)+1
"RTN","SDPMUT1",159,0)
 ..S $P(SUBNODE,U,10)=$P($G(SUBNODE),U,10)+1
"RTN","SDPMUT1",160,0)
 .I TIUET>10 D
"RTN","SDPMUT1",161,0)
 ..S $P(SUMNODE,U,11)=$P($G(SUMNODE),U,11)+1
"RTN","SDPMUT1",162,0)
 ..S $P(SUBNODE,U,11)=$P($G(SUBNODE),U,11)+1
"RTN","SDPMUT1",163,0)
 .S @OUTARR@("SUMMARY","PI")=SUMNODE
"RTN","SDPMUT1",164,0)
 .S @OUTARR@("SUBTOTAL",ESUB1,"PI")=SUBNODE
"RTN","SDPMUT1",165,0)
 .Q
"RTN","SDPMUT1",166,0)
 ;Increment Scanned Notes for hospital and sort level 1 (if required)
"RTN","SDPMUT1",167,0)
 I @SCRNARR@("SCANNED")&($P(NOTEINFO,U,2)["D") D
"RTN","SDPMUT1",168,0)
 .S $P(@OUTARR@("SUMMARY"),U,7)=$P($G(@OUTARR@("SUMMARY")),U,7)+1
"RTN","SDPMUT1",169,0)
 .S $P(@OUTARR@("SUBTOTAL",ESUB1),U,7)=$P($G(@OUTARR@("SUBTOTAL",ESUB1)),U,7)+1
"RTN","SDPMUT1",170,0)
 .Q
"RTN","SDPMUT1",171,0)
 ;Only update performance indicators for note status of A
"RTN","SDPMUT1",172,0)
 I $P((NOTEINFO),U,2)="A" D
"RTN","SDPMUT1",173,0)
 .S $P(@OUTARR@("SUMMARY"),U,9)=$P($G(@OUTARR@("SUMMARY")),U,9)+1
"RTN","SDPMUT1",174,0)
 .S $P(@OUTARR@("SUBTOTAL",ESUB1),U,9)=$P($G(@OUTARR@("SUBTOTAL",ESUB1)),U,9)+1
"RTN","SDPMUT1",175,0)
 .Q
"RTN","SDPMUT1",176,0)
 ;Increment unique Stop Codes for hospital and sort level 1
"RTN","SDPMUT1",177,0)
 I SCODE D
"RTN","SDPMUT1",178,0)
 .I '($D(@UNQARR@("SUMMARY","STOP",SCODE))#2) D
"RTN","SDPMUT1",179,0)
 ..S $P(@OUTARR@("SUMMARY"),U,5)=$P($G(@OUTARR@("SUMMARY")),U,5)+1
"RTN","SDPMUT1",180,0)
 ..S @UNQARR@("SUMMARY","STOP",SCODE)=""
"RTN","SDPMUT1",181,0)
 ..Q
"RTN","SDPMUT1",182,0)
 .I '($D(@UNQARR@("SUBTOTAL","STOP",ESUB1,SCODE))#2) D
"RTN","SDPMUT1",183,0)
 ..S $P(@OUTARR@("SUBTOTAL",ESUB1),U,5)=$P($G(@OUTARR@("SUBTOTAL",ESUB1)),U,5)+1
"RTN","SDPMUT1",184,0)
 ..S @UNQARR@("SUBTOTAL","STOP",ESUB1,SCODE)=""
"RTN","SDPMUT1",185,0)
 ..Q
"RTN","SDPMUT1",186,0)
 .Q
"RTN","SDPMUT1",187,0)
 ;Increment unique Providers for hospital and sort level 1
"RTN","SDPMUT1",188,0)
 I PROV D
"RTN","SDPMUT1",189,0)
 .I '($D(@UNQARR@("SUMMARY","PROV",PROV))#2) D
"RTN","SDPMUT1",190,0)
 ..S $P(@OUTARR@("SUMMARY"),U,4)=$P($G(@OUTARR@("SUMMARY")),U,4)+1
"RTN","SDPMUT1",191,0)
 ..S @UNQARR@("SUMMARY","PROV",PROV)=""
"RTN","SDPMUT1",192,0)
 ..Q
"RTN","SDPMUT1",193,0)
 .I '($D(@UNQARR@("SUBTOTAL","PROV",ESUB1,PROV))#2) D
"RTN","SDPMUT1",194,0)
 ..S $P(@OUTARR@("SUBTOTAL",ESUB1),U,4)=$P($G(@OUTARR@("SUBTOTAL",ESUB1)),U,4)+1
"RTN","SDPMUT1",195,0)
 ..S @UNQARR@("SUBTOTAL","PROV",ESUB1,PROV)=""
"RTN","SDPMUT1",196,0)
 ..Q
"RTN","SDPMUT1",197,0)
 .Q
"RTN","SDPMUT1",198,0)
 ;Set detailed node
"RTN","SDPMUT1",199,0)
 S @OUTARR@("DETAIL",ESUB1,ESUB2,DFN,PTRENC)=TIUPROV_"^"_TIUDT_"^"_TIUET
"RTN","SDPMUT1",200,0)
 Q
"VER")
8.0^22.0
**END**
**END**
