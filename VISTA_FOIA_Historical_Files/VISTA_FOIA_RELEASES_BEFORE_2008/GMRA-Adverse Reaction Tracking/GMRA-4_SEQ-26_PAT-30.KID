Released GMRA*4*30 SEQ #26
Extracted from mail message
**KIDS**:GMRA*4.0*30^

**INSTALL NAME**
GMRA*4.0*30
"BLD",6358,0)
GMRA*4.0*30^ADVERSE REACTION TRACKING^0^3050810^y
"BLD",6358,1,0)
^^8^8^3050808^^
"BLD",6358,1,1,0)
Remedy ticket HD67463 was logged because the site noticed that deceased 
"BLD",6358,1,2,0)
patients were appearing on the [GMRA PRINT-PATIENT NOT ASKED] report.  
"BLD",6358,1,3,0)
This report lists patients who have not been given an allergy/adverse 
"BLD",6358,1,4,0)
reaction assessment.  The sites then use this list and contact the 
"BLD",6358,1,5,0)
patients in an attempt to get the assessment information from them.  It 
"BLD",6358,1,6,0)
is not desirable for the VA to inadvertently contact the family of a 
"BLD",6358,1,7,0)
deceased individual in an attempt to get the allergy/adverse reaction 
"BLD",6358,1,8,0)
information for that person.
"BLD",6358,4,0)
^9.64PA^^
"BLD",6358,"ABPKG")
n
"BLD",6358,"KRN",0)
^9.67PA^8989.52^19
"BLD",6358,"KRN",.4,0)
.4
"BLD",6358,"KRN",.4,"NM",0)
^9.68A^^0
"BLD",6358,"KRN",.401,0)
.401
"BLD",6358,"KRN",.401,"NM",0)
^9.68A^^0
"BLD",6358,"KRN",.402,0)
.402
"BLD",6358,"KRN",.403,0)
.403
"BLD",6358,"KRN",.5,0)
.5
"BLD",6358,"KRN",.84,0)
.84
"BLD",6358,"KRN",3.6,0)
3.6
"BLD",6358,"KRN",3.6,"NM",0)
^9.68A^^0
"BLD",6358,"KRN",3.8,0)
3.8
"BLD",6358,"KRN",3.8,"NM",0)
^9.68A^^0
"BLD",6358,"KRN",9.2,0)
9.2
"BLD",6358,"KRN",9.8,0)
9.8
"BLD",6358,"KRN",9.8,"NM",0)
^9.68A^1^1
"BLD",6358,"KRN",9.8,"NM",1,0)
GMRAPNA^^0^15125034
"BLD",6358,"KRN",9.8,"NM","B","GMRAPNA",1)

"BLD",6358,"KRN",19,0)
19
"BLD",6358,"KRN",19,"NM",0)
^9.68A^^0
"BLD",6358,"KRN",19.1,0)
19.1
"BLD",6358,"KRN",19.1,"NM",0)
^9.68A^^0
"BLD",6358,"KRN",101,0)
101
"BLD",6358,"KRN",101,"NM",0)
^9.68A^^0
"BLD",6358,"KRN",409.61,0)
409.61
"BLD",6358,"KRN",409.61,"NM",0)
^9.68A^^0
"BLD",6358,"KRN",771,0)
771
"BLD",6358,"KRN",870,0)
870
"BLD",6358,"KRN",8989.51,0)
8989.51
"BLD",6358,"KRN",8989.52,0)
8989.52
"BLD",6358,"KRN",8994,0)
8994
"BLD",6358,"KRN","B",.4,.4)

"BLD",6358,"KRN","B",.401,.401)

"BLD",6358,"KRN","B",.402,.402)

"BLD",6358,"KRN","B",.403,.403)

"BLD",6358,"KRN","B",.5,.5)

"BLD",6358,"KRN","B",.84,.84)

"BLD",6358,"KRN","B",3.6,3.6)

"BLD",6358,"KRN","B",3.8,3.8)

"BLD",6358,"KRN","B",9.2,9.2)

"BLD",6358,"KRN","B",9.8,9.8)

"BLD",6358,"KRN","B",19,19)

"BLD",6358,"KRN","B",19.1,19.1)

"BLD",6358,"KRN","B",101,101)

"BLD",6358,"KRN","B",409.61,409.61)

"BLD",6358,"KRN","B",771,771)

"BLD",6358,"KRN","B",870,870)

"BLD",6358,"KRN","B",8989.51,8989.51)

"BLD",6358,"KRN","B",8989.52,8989.52)

"BLD",6358,"KRN","B",8994,8994)

"BLD",6358,"QUES",0)
^9.62^^
"BLD",6358,"REQB",0)
^9.611^^
"MBREQ")
0
"PKG",326,-1)
1^1
"PKG",326,0)
ADVERSE REACTION TRACKING^GMRA^Adverse Reaction Tracking package
"PKG",326,20,0)
^9.402P^^
"PKG",326,22,0)
^9.49I^1^1
"PKG",326,22,1,0)
4.0^2960328^2960511^3316
"PKG",326,22,1,"PAH",1,0)
30^3050810^33234
"PKG",326,22,1,"PAH",1,1,0)
^^8^8^3050810
"PKG",326,22,1,"PAH",1,1,1,0)
Remedy ticket HD67463 was logged because the site noticed that deceased 
"PKG",326,22,1,"PAH",1,1,2,0)
patients were appearing on the [GMRA PRINT-PATIENT NOT ASKED] report.  
"PKG",326,22,1,"PAH",1,1,3,0)
This report lists patients who have not been given an allergy/adverse 
"PKG",326,22,1,"PAH",1,1,4,0)
reaction assessment.  The sites then use this list and contact the 
"PKG",326,22,1,"PAH",1,1,5,0)
patients in an attempt to get the assessment information from them.  It 
"PKG",326,22,1,"PAH",1,1,6,0)
is not desirable for the VA to inadvertently contact the family of a 
"PKG",326,22,1,"PAH",1,1,7,0)
deceased individual in an attempt to get the allergy/adverse reaction 
"PKG",326,22,1,"PAH",1,1,8,0)
information for that person.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
1
"RTN","GMRAPNA")
0^1^B15125034
"RTN","GMRAPNA",1,0)
GMRAPNA ;HIRMFO/WAA-PATIENT NOT ASKED ABOUT ALLERGIES ;12/1/95  14:15
"RTN","GMRAPNA",2,0)
 ;;4.0;Adverse Reaction Tracking;**30**;Mar 29, 1996
"RTN","GMRAPNA",3,0)
EN1 ; Entry for LIST BY LOCATION OF UNDOCUMENTED ALLERGIES option
"RTN","GMRAPNA",4,0)
 D EN1^GMRACMR G:GMRAOUT EXIT
"RTN","GMRAPNA",5,0)
 D DEV
"RTN","GMRAPNA",6,0)
 D EXIT
"RTN","GMRAPNA",7,0)
 Q
"RTN","GMRAPNA",8,0)
DEV ; *** Select output device, force queueing
"RTN","GMRAPNA",9,0)
 ;***** NOTE: CHECKS TO SEE IF VALID DEVICE IS SELECTED THEN ALL I HAVE TO DO IS RUN TASK MAN.
"RTN","GMRAPNA",10,0)
 S GMRAZIS="" S:GMRASEL'="1," GMRAZIS="Q"
"RTN","GMRAPNA",11,0)
 W !! D DEV^GMRAUTL I POP G EXIT
"RTN","GMRAPNA",12,0)
 I $D(IO("Q")) D  G EXIT
"RTN","GMRAPNA",13,0)
 . K IO("Q")
"RTN","GMRAPNA",14,0)
 . S ZTRTN="ENTSK^GMRAPNA"
"RTN","GMRAPNA",15,0)
 . S ZTSAVE("GMRA*")="",ZTSAVE("^TMP($J,")=""
"RTN","GMRAPNA",16,0)
 . S ZTDESC="List of patients who have not been asked of allergies"
"RTN","GMRAPNA",17,0)
 . D ^%ZTLOAD
"RTN","GMRAPNA",18,0)
 . W !!,$S($D(ZTSK):"Request queued...",1:"Request NOT queued please try later...")
"RTN","GMRAPNA",19,0)
 . Q
"RTN","GMRAPNA",20,0)
 E  D ENTSK
"RTN","GMRAPNA",21,0)
 Q
"RTN","GMRAPNA",22,0)
ENTSK U IO
"RTN","GMRAPNA",23,0)
 D EN1^GMRACMR2,EN1^GMRACMR3
"RTN","GMRAPNA",24,0)
 S GMRAPAGE=0,X="NOW" D ^%DT S GMRAPDT=$$DATE^GMRAUTL1(Y)
"RTN","GMRAPNA",25,0)
 D PRINT
"RTN","GMRAPNA",26,0)
 G EXIT
"RTN","GMRAPNA",27,0)
PRINT ;PRINT THE DATE
"RTN","GMRAPNA",28,0)
 D PRE
"RTN","GMRAPNA",29,0)
 S GMRAHLOC="" F  S GMRAHLOC=$O(^TMP($J,"GMRAWC","C",GMRAHLOC)) Q:GMRAHLOC=""!(GMRAOUT)  S GMRAX=0 F  S GMRAX=$O(^(GMRAHLOC,GMRAX)) Q:GMRAX<1  D  Q:GMRAOUT
"RTN","GMRAPNA",30,0)
 .S GMRA=$G(^TMP($J,"GMRAWC",GMRAX)),GMRACNT=0
"RTN","GMRAPNA",31,0)
 .I GMRA="" Q
"RTN","GMRAPNA",32,0)
 .D HEAD Q:GMRAOUT
"RTN","GMRAPNA",33,0)
 .W !!,?10,$S(GMRA="W":"WARD",GMRA="M":"MODULE",GMRA="C":"CLINIC",1:"UNKNOWN"),": ",$P(^SC(GMRAX,0),U)
"RTN","GMRAPNA",34,0)
 .S GMRADATE=0 F  S GMRADATE=$O(^TMP($J,"GMRAWC",GMRAX,GMRADATE))  Q:GMRADATE=""  S GMRADFN=0 Q:GMRAOUT  F  S GMRADFN=$O(^TMP($J,"GMRAWC",GMRAX,GMRADATE,GMRADFN)) Q:GMRADFN<1  D  Q:GMRAOUT
"RTN","GMRAPNA",35,0)
 ..I '$D(^GMR(120.86,GMRADFN,0))
"RTN","GMRAPNA",36,0)
 ..E  I +$P(^GMR(120.86,GMRADFN,0),U,4)<$G(GMRAED,9999999) Q
"RTN","GMRAPNA",37,0)
 ..Q:'$D(^DPT(GMRADFN,0))
"RTN","GMRAPNA",38,0)
 ..Q:$$DECEASED^GMRAFX(GMRADFN)  ;GMRA*4*30 Prevent deceased patients from appearing on this report.
"RTN","GMRAPNA",39,0)
 ..S GMRACNT=GMRACNT+1
"RTN","GMRAPNA",40,0)
 ..W !,$P(^DPT(GMRADFN,0),U) S DFN=GMRADFN,VAINDT=$S(GMRADATE="CURRENT":DT,1:GMRADATE) D 1^VADPT W ?30,VA("PID") W:GMRA'="C" ?45,$P(VAIN(2),U,2)
"RTN","GMRAPNA",41,0)
 ..I VAIN(5)'="" W !,?5,"Room/Bed: ",VAIN(5)
"RTN","GMRAPNA",42,0)
 ..D KVAR^VADPT K VA,DFN
"RTN","GMRAPNA",43,0)
 ..I $Y>(IOSL-4) D HEAD Q:GMRAOUT
"RTN","GMRAPNA",44,0)
 ..Q
"RTN","GMRAPNA",45,0)
 .D NOPAT
"RTN","GMRAPNA",46,0)
 .Q
"RTN","GMRAPNA",47,0)
 D CLOSE^GMRAUTL
"RTN","GMRAPNA",48,0)
 Q
"RTN","GMRAPNA",49,0)
NOPAT ; If there are no patients print informational message
"RTN","GMRAPNA",50,0)
 Q:GMRACNT
"RTN","GMRAPNA",51,0)
 W !,?24,"* No Patients for this ",$S(GMRA="W":"Ward",GMRA="M":"Module",GMRA="C":"Clinic",1:"UNKNOWN")," *"
"RTN","GMRAPNA",52,0)
 W !
"RTN","GMRAPNA",53,0)
 Q
"RTN","GMRAPNA",54,0)
HEAD ;HEADER PAGE FOR PRINTOUT
"RTN","GMRAPNA",55,0)
 S GMRAPAGE=GMRAPAGE+1,GMRATL="" I $E(IOST,1)="C",GMRAPAGE=1 W @IOF
"RTN","GMRAPNA",56,0)
 I $E(IOST,1)="C",GMRAPAGE'=1 D  Q:GMRAOUT
"RTN","GMRAPNA",57,0)
 .S DIR(0)="E" D ^DIR I 'Y S GMRAOUT=1
"RTN","GMRAPNA",58,0)
 .K Y
"RTN","GMRAPNA",59,0)
 .Q
"RTN","GMRAPNA",60,0)
 I GMRAPAGE'=1 W @IOF
"RTN","GMRAPNA",61,0)
 W !,GMRAPDT,?23,"PATIENTS NOT ASKED ABOUT ALLERGIES",?70,"PAGE ",GMRAPAGE
"RTN","GMRAPNA",62,0)
 I GMRASEL["1" S GMRATL="CURRENT INPATIENTS"
"RTN","GMRAPNA",63,0)
 I GMRASEL["2" S GMRATL=$S(GMRATL="":"OUTPATIENTS",1:GMRATL_" / OUTPATIENTS")
"RTN","GMRAPNA",64,0)
 I GMRASEL["3" S GMRATL=$S(GMRATL="":"NEW ADMISSIONS",1:GMRATL_" / NEW ADMISSIONS")
"RTN","GMRAPNA",65,0)
 W !,?(40-($L(GMRATL)/2)),GMRATL
"RTN","GMRAPNA",66,0)
 I (GMRASEL["2"!(GMRASEL["3")) W !,?23,"FROM ",$$DATE^GMRAUTL1(GMRAST),?42,"TO ",$$DATE^GMRAUTL1(GMRAED)
"RTN","GMRAPNA",67,0)
 W !!,"PATIENT",?30,"SSN" W:GMRA'="C" ?45,"PROVIDER"
"RTN","GMRAPNA",68,0)
 W !,$$REPEAT^XLFSTR("-",78)
"RTN","GMRAPNA",69,0)
 I $D(ZTQUEUED) S:$$STPCK^GMRAUTL1 GMRAOUT=1 ; Check if stopped by user
"RTN","GMRAPNA",70,0)
 Q
"RTN","GMRAPNA",71,0)
PRE ; This will validate the TMP global and fire off Xref
"RTN","GMRAPNA",72,0)
 N GMRAX,GMRAY,GMRAT1,GMRAT2,GMRAT3
"RTN","GMRAPNA",73,0)
 Q:'$D(^TMP($J,"GMRAWC"))
"RTN","GMRAPNA",74,0)
 S GMRAX=0  F  S GMRAX=$O(^TMP($J,"GMRAWC",GMRAX)) Q:GMRAX<1  D
"RTN","GMRAPNA",75,0)
 .S GMRAY=^TMP($J,"GMRAWC",GMRAX)
"RTN","GMRAPNA",76,0)
 .S GMRAT1=$P($G(^SC(GMRAX,0)),U,2)
"RTN","GMRAPNA",77,0)
 .S GMRAT2=$P($G(^SC(GMRAX,0)),U)
"RTN","GMRAPNA",78,0)
 .S GMRAT3=$S(GMRAT1'="":GMRAT1,1:GMRAT2)
"RTN","GMRAPNA",79,0)
 .S ^TMP($J,"GMRAWC","C",GMRAT3,GMRAX)=""
"RTN","GMRAPNA",80,0)
 .Q
"RTN","GMRAPNA",81,0)
 Q
"RTN","GMRAPNA",82,0)
EXIT ;
"RTN","GMRAPNA",83,0)
 K ^TMP($J,"GMRAWC")
"RTN","GMRAPNA",84,0)
 D KILL^XUSCLEAN
"RTN","GMRAPNA",85,0)
 Q
"VER")
8.0^22.0
"BLD",6358,6)
^SEQ #26
**END**
**END**
