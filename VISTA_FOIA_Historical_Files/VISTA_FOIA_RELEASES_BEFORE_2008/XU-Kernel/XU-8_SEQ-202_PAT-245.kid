EMERGENCY Released XU*8*245 SEQ #202
Extracted from mail message
**KIDS**:XU*8.0*245^

**INSTALL NAME**
XU*8.0*245
"BLD",590,0)
XU*8.0*245^KERNEL^0^3020723^y
"BLD",590,1,0)
^^1^1^3020716^
"BLD",590,1,1,0)
Please refer to the Description in FORUM Patch Module for details.
"BLD",590,4,0)
^9.64PA^200^1
"BLD",590,4,200,0)
200
"BLD",590,4,200,2,0)
^9.641^200.06^1
"BLD",590,4,200,2,200.06,0)
VISITED FROM  (sub-file)
"BLD",590,4,200,2,200.06,1,0)
^9.6411^^0
"BLD",590,4,200,222)
y^y^p^^^^n
"BLD",590,4,"APDD",200,200.06)

"BLD",590,4,"B",200,200)

"BLD",590,"KRN",0)
^9.67PA^8989.52^20
"BLD",590,"KRN",.4,0)
.4
"BLD",590,"KRN",.401,0)
.401
"BLD",590,"KRN",.402,0)
.402
"BLD",590,"KRN",.403,0)
.403
"BLD",590,"KRN",.5,0)
.5
"BLD",590,"KRN",.84,0)
.84
"BLD",590,"KRN",3.6,0)
3.6
"BLD",590,"KRN",3.8,0)
3.8
"BLD",590,"KRN",9.2,0)
9.2
"BLD",590,"KRN",9.8,0)
9.8
"BLD",590,"KRN",9.8,"NM",0)
^9.68A^1^1
"BLD",590,"KRN",9.8,"NM",1,0)
XUESSO1^^0^B26848322
"BLD",590,"KRN",9.8,"NM","B","XUESSO1",1)

"BLD",590,"KRN",19,0)
19
"BLD",590,"KRN",19.1,0)
19.1
"BLD",590,"KRN",101,0)
101
"BLD",590,"KRN",409.61,0)
409.61
"BLD",590,"KRN",771,0)
771
"BLD",590,"KRN",870,0)
870
"BLD",590,"KRN",8989.51,0)
8989.51
"BLD",590,"KRN",8989.52,0)
8989.52
"BLD",590,"KRN",8994,0)
8994
"BLD",590,"KRN",8994.2,0)
8994.2
"BLD",590,"KRN","B",.4,.4)

"BLD",590,"KRN","B",.401,.401)

"BLD",590,"KRN","B",.402,.402)

"BLD",590,"KRN","B",.403,.403)

"BLD",590,"KRN","B",.5,.5)

"BLD",590,"KRN","B",.84,.84)

"BLD",590,"KRN","B",3.6,3.6)

"BLD",590,"KRN","B",3.8,3.8)

"BLD",590,"KRN","B",9.2,9.2)

"BLD",590,"KRN","B",9.8,9.8)

"BLD",590,"KRN","B",19,19)

"BLD",590,"KRN","B",19.1,19.1)

"BLD",590,"KRN","B",101,101)

"BLD",590,"KRN","B",409.61,409.61)

"BLD",590,"KRN","B",771,771)

"BLD",590,"KRN","B",870,870)

"BLD",590,"KRN","B",8989.51,8989.51)

"BLD",590,"KRN","B",8989.52,8989.52)

"BLD",590,"KRN","B",8994,8994)

"BLD",590,"KRN","B",8994.2,8994.2)

"BLD",590,"QUES",0)
^9.62^^
"BLD",590,"REQB",0)
^9.611^1^1
"BLD",590,"REQB",1,0)
XU*8.0*196^2
"BLD",590,"REQB","B","XU*8.0*196",1)

"FIA",200)
NEW PERSON
"FIA",200,0)
^VA(200,
"FIA",200,0,0)
200I
"FIA",200,0,1)
y^y^p^^^^n
"FIA",200,0,10)

"FIA",200,0,11)

"FIA",200,0,"RLRO")

"FIA",200,0,"VR")
8.0^XU
"FIA",200,200)
1
"FIA",200,200,8910)

"FIA",200,200.06)
0
"IX",200,200,"AVISIT",0)
200^AVISIT^This is a regular index of the remote DUZ and Station number.^R^^R^IR^W^200.06^^^^^S
"IX",200,200,"AVISIT",1)
S ^VA(200,"AVISIT",$E(X(1),1,30),$E(X(2),1,15),DA(1),DA)=""
"IX",200,200,"AVISIT",2)
K ^VA(200,"AVISIT",$E(X(1),1,30),$E(X(2),1,15),DA(1),DA)
"IX",200,200,"AVISIT",2.5)
K ^VA(200,"AVISIT")
"IX",200,200,"AVISIT",11.1,0)
^.114IA^2^2
"IX",200,200,"AVISIT",11.1,1,0)
1^F^200.06^.01^30^1^F
"IX",200,200,"AVISIT",11.1,2,0)
2^F^200.06^2^15^2^F
"MBREQ")
0
"PKG",3,-1)
1^1
"PKG",3,0)
KERNEL^XU^SIGN-ON, SECURITY, MENU DRIVER, DEVICES, TASKMAN^
"PKG",3,20,0)
^9.402P^^0
"PKG",3,22,0)
^9.49I^1^1
"PKG",3,22,1,0)
8.0^2950703^2970507^.5
"PKG",3,22,1,"PAH",1,0)
245^3020723
"PKG",3,22,1,"PAH",1,1,0)
^^1^1^3020723
"PKG",3,22,1,"PAH",1,1,1,0)
Please refer to the Description in FORUM Patch Module for details.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
1
"RTN","XUESSO1")
0^1^B26848322
"RTN","XUESSO1",1,0)
XUESSO1 ;LUKE/SEA Single Sign-on utilities; ;07/22/2002  17:12
"RTN","XUESSO1",2,0)
 ;;8.0;KERNEL;**165,183,196,245**;Jul 10, 1995
"RTN","XUESSO1",3,0)
 ;
"RTN","XUESSO1",4,0)
GET(INDUZ) ;Gather identifying data from user's home site.
"RTN","XUESSO1",5,0)
 ;Must have Name, Access&Verify codes, SSN (no pseudo), station name&number
"RTN","XUESSO1",6,0)
 N %,NAME,SITE,SSN,PHONE,X,N
"RTN","XUESSO1",7,0)
 I '$D(DUZ) G BOMB
"RTN","XUESSO1",8,0)
 I '$D(DUZ(2)) G BOMB
"RTN","XUESSO1",9,0)
 I '$D(INDUZ) S INDUZ=DUZ
"RTN","XUESSO1",10,0)
 S N=$G(^VA(200,DUZ,0))
"RTN","XUESSO1",11,0)
 I '$L(N) G BOMB
"RTN","XUESSO1",12,0)
 S %=$P(N,U,3) I $L(%)<1 G BOMB ;No Access Code
"RTN","XUESSO1",13,0)
 S %=$P(N,U,2) I $L(%)<1 G BOMB ;No Verify Code
"RTN","XUESSO1",14,0)
 S %=$P(N,U,11) I $L(%)>1,(DT>%) G BOMB ;Terminated
"RTN","XUESSO1",15,0)
 S NAME=$P(N,U)
"RTN","XUESSO1",16,0)
 I '$L(NAME) G BOMB
"RTN","XUESSO1",17,0)
 ;
"RTN","XUESSO1",18,0)
 S SITE=$$NS^XUAF4(DUZ(2)) ;Site is name^station#
"RTN","XUESSO1",19,0)
 I $P(SITE,U,2)="" G BOMB ;Need a station number
"RTN","XUESSO1",20,0)
 ;
"RTN","XUESSO1",21,0)
 S SSN=$P($G(^VA(200,DUZ,1)),U,9)
"RTN","XUESSO1",22,0)
 I $$SPECIAL($P(SITE,"^",2)) S SSN=999999999 G G4 ;Manila RO doesn't need SSN
"RTN","XUESSO1",23,0)
 I 'SSN G BOMB
"RTN","XUESSO1",24,0)
 ;Don't allow if the SSN is pseudo
"RTN","XUESSO1",25,0)
 I $E(SSN,10)="P" G BOMB
"RTN","XUESSO1",26,0)
 ;Don't allow if the SSN is not real, (e.g. 00000NNNN)
"RTN","XUESSO1",27,0)
 I $E(SSN,1,5)="00000" G BOMB
"RTN","XUESSO1",28,0)
 ;
"RTN","XUESSO1",29,0)
G4 S PHONE=$$PH
"RTN","XUESSO1",30,0)
 S X=SSN_U_NAME_U_SITE_U_DUZ
"RTN","XUESSO1",31,0)
 I $L(PHONE)>2&($L(PHONE<20)) S X=X_U_PHONE
"RTN","XUESSO1",32,0)
 ;ssn^name^station name^station number^DUZ^phone
"RTN","XUESSO1",33,0)
 Q X
"RTN","XUESSO1",34,0)
 ;
"RTN","XUESSO1",35,0)
 ;
"RTN","XUESSO1",36,0)
BOMB ;Insufficient information to allow visiting
"RTN","XUESSO1",37,0)
 S X="-1^Insufficient User Information On File.  ssn,name,station name,station number,DUZ"
"RTN","XUESSO1",38,0)
 Q X
"RTN","XUESSO1",39,0)
 ;
"RTN","XUESSO1",40,0)
 ;
"RTN","XUESSO1",41,0)
PH() ; Try for a phone number or pager
"RTN","XUESSO1",42,0)
 N %,X
"RTN","XUESSO1",43,0)
 S %=""
"RTN","XUESSO1",44,0)
 S X=$G(^VA(200,DUZ,.13))
"RTN","XUESSO1",45,0)
 I '$L(X) Q ""
"RTN","XUESSO1",46,0)
 ;
"RTN","XUESSO1",47,0)
 S %=$P(X,U,5) I $L(%)>6 Q %  ;Commercial #
"RTN","XUESSO1",48,0)
 S %=$P(X,U,2) I $L(%)>2 Q %  ;Office
"RTN","XUESSO1",49,0)
 S %=$P(X,U,8) I $L(%)>6 Q %  ;Digital Pager
"RTN","XUESSO1",50,0)
 S %=$P(X,U,7) I $L(%)>6 Q %  ;Pager
"RTN","XUESSO1",51,0)
 S %=$P(X,U,3) I $L(%)>2 Q %  ;Phone #3
"RTN","XUESSO1",52,0)
 S %=$P(X,U,4) I $L(%)>2 Q %  ;Phone #4
"RTN","XUESSO1",53,0)
 S %=$P(X,U,1) I $L(%)>2 Q %  ;Home Phone
"RTN","XUESSO1",54,0)
 Q "" ;Couldn't find one.
"RTN","XUESSO1",55,0)
 ;
"RTN","XUESSO1",56,0)
SPECIAL(SN) ;Special Manila RO site
"RTN","XUESSO1",57,0)
 Q 358=SN
"RTN","XUESSO1",58,0)
 ;
"RTN","XUESSO1",59,0)
 ;
"RTN","XUESSO1",60,0)
PUT(DATIN) ;;Setup data from authenticating site GET() at receiving site
"RTN","XUESSO1",61,0)
 ;Return: 0=fail, 1=OK
"RTN","XUESSO1",62,0)
 N NEWDUZ,FDR,TODAY,IEN,DIC,USER,X
"RTN","XUESSO1",63,0)
 N SSN,NAME,SITE,SITENUM,RMTDUZ,PHONE
"RTN","XUESSO1",64,0)
 S TODAY=$$HTFM^XLFDT($H),DT=$P(TODAY,"."),U="^"
"RTN","XUESSO1",65,0)
 S NEWDUZ=0
"RTN","XUESSO1",66,0)
 K ^TMP("DIERR",$J)
"RTN","XUESSO1",67,0)
 ;
"RTN","XUESSO1",68,0)
 IF (U_DATIN)["^^" Q 0 ;There is some data missing
"RTN","XUESSO1",69,0)
 S SSN=$P(DATIN,U,1)
"RTN","XUESSO1",70,0)
 S NAME=$P(DATIN,U,2)
"RTN","XUESSO1",71,0)
 S SITE=$P(DATIN,U,3)
"RTN","XUESSO1",72,0)
 S SITENUM=$P(DATIN,U,4)
"RTN","XUESSO1",73,0)
 S RMTDUZ=$P(DATIN,U,5)
"RTN","XUESSO1",74,0)
 S PHONE=$P(DATIN,U,6)
"RTN","XUESSO1",75,0)
 ;Format checks
"RTN","XUESSO1",76,0)
 I NAME'?1U.E1","1U.E Q 0
"RTN","XUESSO1",77,0)
 I SSN'?9N Q 0
"RTN","XUESSO1",78,0)
 I '$L(SITE)!('$L(SITENUM)) Q 0
"RTN","XUESSO1",79,0)
 ;
"RTN","XUESSO1",80,0)
 I $$TALL() Q $$SET(NEWDUZ) ;Return 1 if OK.
"RTN","XUESSO1",81,0)
 Q 0
"RTN","XUESSO1",82,0)
 ;
"RTN","XUESSO1",83,0)
TALL() ;Test for existing user or adds a new one
"RTN","XUESSO1",84,0)
 N DUZ,FLAG S FLAG=0,DUZ=0,DUZ(0)=""
"RTN","XUESSO1",85,0)
 ;See if the SSN is in the NPF cross reference
"RTN","XUESSO1",86,0)
 I '$$SPECIAL(SITENUM),$D(^VA(200,"SSN",SSN)) D
"RTN","XUESSO1",87,0)
 .S NEWDUZ=$O(^VA(200,"SSN",SSN,0))
"RTN","XUESSO1",88,0)
 .I '$D(^VA(200,NEWDUZ,8910,"B",SITENUM)) D VISM
"RTN","XUESSO1",89,0)
 .D UPDT
"RTN","XUESSO1",90,0)
 .S FLAG=1
"RTN","XUESSO1",91,0)
 .Q
"RTN","XUESSO1",92,0)
 ;See if in the AVISIT cross reference
"RTN","XUESSO1",93,0)
 I 'FLAG,$$SPECIAL(SITENUM) D
"RTN","XUESSO1",94,0)
 . S NEWDUZ=$O(^VA(200,"AVISIT",SITENUM,RMTDUZ,0))
"RTN","XUESSO1",95,0)
 . Q:NEWDUZ'>0
"RTN","XUESSO1",96,0)
 . D UPDT S FLAG=1
"RTN","XUESSO1",97,0)
 . Q
"RTN","XUESSO1",98,0)
 I FLAG Q 1 ;Quit here if we found a match for SSN or AVISIT
"RTN","XUESSO1",99,0)
 ;
"RTN","XUESSO1",100,0)
 ;
"RTN","XUESSO1",101,0)
 ;There is no matching SSN, try for a NAME match in "B"
"RTN","XUESSO1",102,0)
 S FLAG=0,NAME=$$UP^XLFSTR(NAME)
"RTN","XUESSO1",103,0)
 I $D(^VA(200,"B",NAME)) D
"RTN","XUESSO1",104,0)
 .N %,USER,USER2
"RTN","XUESSO1",105,0)
 .S NEWDUZ=$O(^VA(200,"B",NAME,0))
"RTN","XUESSO1",106,0)
 .S USER2=$O(^VA(200,"B",NAME,NEWDUZ)) ;More then one?
"RTN","XUESSO1",107,0)
 .Q:$L(USER2)>0
"RTN","XUESSO1",108,0)
 .;
"RTN","XUESSO1",109,0)
 .S %=$P($G(^VA(200,NEWDUZ,1)),U,9)
"RTN","XUESSO1",110,0)
 .Q:%'=SSN  ;Don't use this name if it has a different SSN
"RTN","XUESSO1",111,0)
 .;
"RTN","XUESSO1",112,0)
 .I '$L($P(^VA(200,NEWDUZ,1),U,9)) D ADDS
"RTN","XUESSO1",113,0)
 .I '$D(^VA(200,NEWDUZ,8910,"B",SITENUM)) D VISM
"RTN","XUESSO1",114,0)
 .D UPDT S FLAG=1
"RTN","XUESSO1",115,0)
 .Q
"RTN","XUESSO1",116,0)
 I FLAG Q 1 ;Quit here if we found an exact match for NAME (w/o SSN)
"RTN","XUESSO1",117,0)
 ;
"RTN","XUESSO1",118,0)
NEWU ;We didn't find anybody under SSN or NAME so we add a new user
"RTN","XUESSO1",119,0)
 ;
"RTN","XUESSO1",120,0)
 S DIC(0)="" ;Turn off ^XUA4A7 (work around)
"RTN","XUESSO1",121,0)
 ;
"RTN","XUESSO1",122,0)
 ;Put the name in the .01 field first.
"RTN","XUESSO1",123,0)
 D ADDU ;ADDU will set NEWDUZ
"RTN","XUESSO1",124,0)
 ;If NEWDUZ is still 0, the User add didn't work so exit.
"RTN","XUESSO1",125,0)
 I NEWDUZ=0 Q 0
"RTN","XUESSO1",126,0)
 ; Add SSN and Alias
"RTN","XUESSO1",127,0)
 D ADDS,ADDA
"RTN","XUESSO1",128,0)
 ; Fill in the  VISITED FROM multiple
"RTN","XUESSO1",129,0)
 D VISM,UPDT ;Do update for all data in UPDT
"RTN","XUESSO1",130,0)
 ;
"RTN","XUESSO1",131,0)
 I $D(^TMP("DIERR",$J)) Q 0  ;W !!,"=========> FileMan Error",!!
"RTN","XUESSO1",132,0)
 ;
"RTN","XUESSO1",133,0)
 I NEWDUZ D BULL Q 1  ;Every thing OK
"RTN","XUESSO1",134,0)
 Q 0  ;Couldn't add user
"RTN","XUESSO1",135,0)
 ;
"RTN","XUESSO1",136,0)
 ;
"RTN","XUESSO1",137,0)
 ;              *****Subroutines*****
"RTN","XUESSO1",138,0)
 ;
"RTN","XUESSO1",139,0)
 ;
"RTN","XUESSO1",140,0)
SET(NEWDUZ) ;Set the user up to go
"RTN","XUESSO1",141,0)
 Q:NEWDUZ'>0 0
"RTN","XUESSO1",142,0)
 N XUSER,XOPT
"RTN","XUESSO1",143,0)
 S DUZ=NEWDUZ,U="^"
"RTN","XUESSO1",144,0)
 D DUZ^XUS1A
"RTN","XUESSO1",145,0)
 Q 1
"RTN","XUESSO1",146,0)
 ;
"RTN","XUESSO1",147,0)
ADDU ;Add a new name to the New Person File
"RTN","XUESSO1",148,0)
 N DD,DO,DIC,DA,X,Y
"RTN","XUESSO1",149,0)
 S DIC="^VA(200,",DIC(0)="L",X=NAME
"RTN","XUESSO1",150,0)
 D FILE^DICN
"RTN","XUESSO1",151,0)
 S:Y>0 NEWDUZ=+Y
"RTN","XUESSO1",152,0)
 Q
"RTN","XUESSO1",153,0)
 ;
"RTN","XUESSO1",154,0)
ADDS ;Add a SSN to the file
"RTN","XUESSO1",155,0)
 Q:$$SPECIAL(SITENUM)
"RTN","XUESSO1",156,0)
 S IEN=NEWDUZ_","
"RTN","XUESSO1",157,0)
 S FDR(200,IEN,9)=SSN
"RTN","XUESSO1",158,0)
 ;Do update for all data in UPDT
"RTN","XUESSO1",159,0)
 Q
"RTN","XUESSO1",160,0)
 ;
"RTN","XUESSO1",161,0)
ADDA ;Add a new Alias to file 200.04
"RTN","XUESSO1",162,0)
 Q:$D(^VA(200,NEWDUZ,3,"B","VISITOR"))
"RTN","XUESSO1",163,0)
 S IEN="+2,"_NEWDUZ_","
"RTN","XUESSO1",164,0)
 S FDR("200.04",IEN,.01)="VISITOR"
"RTN","XUESSO1",165,0)
 ;Do update for all data in UPDT
"RTN","XUESSO1",166,0)
 Q
"RTN","XUESSO1",167,0)
 ;
"RTN","XUESSO1",168,0)
VISM ;Create a multiple for this site number in the VISTED FROM file
"RTN","XUESSO1",169,0)
 ;K IEN,FDR
"RTN","XUESSO1",170,0)
 S IEN="+3,"_NEWDUZ_","
"RTN","XUESSO1",171,0)
 S FDR("200.06",IEN,.01)=SITENUM
"RTN","XUESSO1",172,0)
 ;
"RTN","XUESSO1",173,0)
 S FDR("200.06",IEN,1)=SITE
"RTN","XUESSO1",174,0)
 S FDR("200.06",IEN,2)=RMTDUZ
"RTN","XUESSO1",175,0)
 S FDR("200.06",IEN,3)=TODAY
"RTN","XUESSO1",176,0)
 I $D(PHONE),($L(PHONE)>2) S FDR("200.06",IEN,5)=PHONE
"RTN","XUESSO1",177,0)
 ;Do update for all data in UPDT
"RTN","XUESSO1",178,0)
 Q
"RTN","XUESSO1",179,0)
 ;
"RTN","XUESSO1",180,0)
UPDT ;Update the LAST VISIT field
"RTN","XUESSO1",181,0)
 I $D(FDR(200.06)) S IEN=$O(FDR(200.06,""))
"RTN","XUESSO1",182,0)
 E  S IEN=$O(^VA(200,NEWDUZ,8910,"B",SITENUM,0))_","_NEWDUZ_","
"RTN","XUESSO1",183,0)
 S FDR(200.06,IEN,4)=TODAY
"RTN","XUESSO1",184,0)
 K IEN D UPDATE^DIE("E","FDR","IEN") ;File all the data
"RTN","XUESSO1",185,0)
 Q
"RTN","XUESSO1",186,0)
 ;
"RTN","XUESSO1",187,0)
BULL ;Set up the bulletin and fire it off, Let MM see if bulletin is there
"RTN","XUESSO1",188,0)
 N XMB
"RTN","XUESSO1",189,0)
 S XMB="XUVISIT"
"RTN","XUESSO1",190,0)
 S XMB(1)=$$FMTE^XLFDT(TODAY)
"RTN","XUESSO1",191,0)
 S XMB(2)=NAME
"RTN","XUESSO1",192,0)
 S XMB(3)=NEWDUZ
"RTN","XUESSO1",193,0)
 S XMB(4)=SITE
"RTN","XUESSO1",194,0)
 S XMB(5)=SITENUM
"RTN","XUESSO1",195,0)
 S XMB(6)=RMTDUZ
"RTN","XUESSO1",196,0)
 S XMB(7)=PHONE
"RTN","XUESSO1",197,0)
 D ^XMB
"RTN","XUESSO1",198,0)
 Q
"UP",200,200.06,-1)
200^8910
"UP",200,200.06,0)
200.06
"VER")
8.0^22.0
"^DD",200,200,8910,0)
VISITED FROM^200.06A^^8910;0
"^DD",200,200,8910,21,0)
^^8^8^3000208^
"^DD",200,200,8910,21,1,0)
This subfile stores the information that travels along with visitors using
"^DD",200,200,8910,21,2,0)
the CPRS Foreign Views software to look at medical data of a patient which
"^DD",200,200,8910,21,3,0)
resides on a system where the visitor may not have valid access or verify
"^DD",200,200,8910,21,4,0)
codes.  When that person name and Social Security Number is put into the
"^DD",200,200,8910,21,5,0)
visited system's New Person File this multiple is updated to provide the
"^DD",200,200,8910,21,6,0)
ability to trace the visitors back to the system from which they are
"^DD",200,200,8910,21,7,0)
visiting.  This field (.01) stores the number of the site where the
"^DD",200,200,8910,21,8,0)
visitor was authenticated.
"^DD",200,200.06,0)
VISITED FROM SUB-FIELD^^5^6
"^DD",200,200.06,0,"DT")
3000126
"^DD",200,200.06,0,"IX","B",200.06,.01)

"^DD",200,200.06,0,"NM","VISITED FROM")

"^DD",200,200.06,0,"UP")
200
"^DD",200,200.06,.01,0)
VISITED FROM^F^^0;1^K:$L(X)>30!($L(X)<1) X
"^DD",200,200.06,.01,1,0)
^.1
"^DD",200,200.06,.01,1,1,0)
200.06^B
"^DD",200,200.06,.01,1,1,1)
S ^VA(200,DA(1),8910,"B",$E(X,1,30),DA)=""
"^DD",200,200.06,.01,1,1,2)
K ^VA(200,DA(1),8910,"B",$E(X,1,30),DA)
"^DD",200,200.06,.01,3)
This is the numerical designation of the user's home site
"^DD",200,200.06,.01,21,0)
^^3^3^3000208^
"^DD",200,200.06,.01,21,1,0)
This field holds the official Station Number ID of the remote site that
"^DD",200,200.06,.01,21,2,0)
did the user authentication. This may be the site that caused this user to
"^DD",200,200.06,.01,21,3,0)
be added to the NPF.
"^DD",200,200.06,.01,"DT")
3020715
"^DD",200,200.06,1,0)
SITE NAME^F^^0;2^K:$L(X)>30!($L(X)<2) X
"^DD",200,200.06,1,3)
Please enter the name of the user's home site
"^DD",200,200.06,1,21,0)
^^2^2^3000126^
"^DD",200,200.06,1,21,1,0)
This field contains the name of the site where the visitor was
"^DD",200,200.06,1,21,2,0)
authenticated.
"^DD",200,200.06,1,"DT")
3000124
"^DD",200,200.06,2,0)
DUZ AT HOME SITE^NJ12,0^^0;3^K:+X'=X!(X>999999999999)!(X<1)!(X?.E1"."1N.N) X
"^DD",200,200.06,2,3)
Please enter the New Person File IEN at the home site
"^DD",200,200.06,2,21,0)
^^2^2^3000126^
"^DD",200,200.06,2,21,1,0)
This field contains the internal entry number in the New Person File at
"^DD",200,200.06,2,21,2,0)
the site where this visitor was authenticated.
"^DD",200,200.06,2,"DT")
3020715
"^DD",200,200.06,3,0)
FIRST VISIT^D^^0;4^S %DT="EST" D ^%DT S X=Y K:Y<1 X
"^DD",200,200.06,3,3)
Please enter the FileMan date/time of first visit.
"^DD",200,200.06,3,21,0)
^^2^2^3000126^
"^DD",200,200.06,3,21,1,0)
This field contains the date when this visitor first visited from the site
"^DD",200,200.06,3,21,2,0)
recorded in the .01 field.
"^DD",200,200.06,3,"DT")
3000126
"^DD",200,200.06,4,0)
LAST VISITED^D^^0;5^S %DT="EST" D ^%DT S X=Y K:Y<1 X
"^DD",200,200.06,4,3)
Please enter a Fileman date for today.
"^DD",200,200.06,4,21,0)
^^2^2^3000126^
"^DD",200,200.06,4,21,1,0)
This field is updated each time a visitor arrives from the site in the .01
"^DD",200,200.06,4,21,2,0)
field.
"^DD",200,200.06,4,"DT")
3000126
"^DD",200,200.06,5,0)
PHONE AT SITE^F^^0;6^K:$L(X)>33!($L(X)<3) X
"^DD",200,200.06,5,3)
Pleas enter the commercial phone number at home site
"^DD",200,200.06,5,21,0)
^^2^2^3000126^
"^DD",200,200.06,5,21,1,0)
This field may contain a phone number for the visitor at their home site.
"^DD",200,200.06,5,21,2,0)
Since phone numbers are not always entered, this field may be blank.
"^DD",200,200.06,5,"DT")
3000124
**END**
**END**
