$TXT Created by GARCIA,JOSE at NXT.KERNEL.FO-OAKLAND.MED.VA.GOV  (KIDS) on FRIDAY, 06/07/02 at 13:57
=============================================================================
Run Date: JUN 14, 2002                     Designation: HL*1.6*87
Package : HL - HEALTH LEVEL SEVEN     Priority: Mandatory
Version : 1.6        SEQ #79                    Status: Released
=============================================================================


Subject: Excessive Generation of Duplicate Messages

Category: 
  - Routine

Description: 
============

 Associated Patches:  This patch requires that KIDS build HL*1.6*77 be 
                      installed.
  
 Test sites:    Oklahoma City VAMC, Muskogee VAMC, San Francisco VAMC
  
 NOIS:    OKL-1201-70586   VA* Logical Links not transmitting
          ISF-0700-62124   Duplicate Entries for messages
          SDC-0301-60090   Message stuck in 'Awaiting ACK' status
          ISF-0400-62120   Excessive Retransmissions
          ISH-0900-40469   re-transmissions for a message awaiting an ack
  
 This patch fixes the problem where a TCP client logical link and its 
 corresponding listener logical link lose synchronization.  Loss of 
 synchronization creates excessive retransmission of messages and their 
 acknowledgements, causing side effects: one is that the client link gets 
 stuck in a "Reading" state because its TCP receive buffer fills up; 
 another is that the disk on both the sending and the receiving sides 
 fills up at a faster rate.
  
 This patch makes corrections in the way the TCP client logical link 
 retransmits a message when its corresponding acknowledgement does not 
 arrive in time or receives an incorrect acknowledgement.  Previous HL7 
 code allowed the logical link to retransmit a message when the 
 acknowledgement message was incorrect, including an "incorrect msg id" 
 acknowledgement.  This patch corrects the code to allow retransmission of 
 a message only when the logical link does not receive an acknowledgement 
 in time (timed out) and ignores incorrect acknowledgements.
  
 Routine Information:
 =====================
  
 The following routine is included in this patch.  The second line of the 
 routine now looks like this:
  
 ;;1.6;HEALTH LEVEL SEVEN;**19,43,49,57,63,64,66,67,76,77,87**;JUL 17,1995.
  
 The VA Kernel checksums for this routine (calculated using 
 CHECK^XTSUMBLD) are listed below:
  
   Routine     Checksum        Checksum        
   Name        Before Patch    After Patch     
   ========    ============    ===========     
   HLCSTCP2    12129232        12913767 
  
   Patch List
   =====================
   **19,43,49,57,63,64,66,67,76,77,87**;
  
 Sites should use CHECK^XTSUMBLD to verify checksums after the patch
 has been installed.
  
 Installation Instructions:
  ==========================
  
    1.  Users are allowed to be on the system during the installation.
  
    2.  AXP/DSM SITES: Review your mapped routine set.  If any of the
        routines listed in the ROUTINE SUMMARY section are mapped, they
        should be removed from the mapped set at this time.
  
    3.  Shutdown all Logical Links, incoming and outgoing filers, and
        the Link Manager using the Filer and Link Management options
        listed below:
  
          Stop All Messaging Background Processes [HL STOP ALL]
          TCP Link Manager Start/Stop [HL START/STOP LINK MANAGER]
  
        AXP/DSM SITES ONLY: Disable all HL7 UCX Services for this
        installation.
  
    4.  Use the 'INSTALL/CHECK MESSAGE' option on the PackMan menu. This
        option will load the KIDS package onto your system.
  
   5.  This patch is now loaded into a transport global on your
        system. The next step is to use KIDS to install the Transport
        global. To do this, use the 'Installation [XPD INSTALLATION 
        MENU]' menu.  You should use each of the following 'Installation'
        menu options in the order shown below:
  
          Verify Checksums in Transport Global
          Print Transport Global
          Compare Transport Global to Current System
          Backup a Transport Global
          Install Package(s)
  
        When using the 'Install Package(s)' menu option to install 
        the patch build, you will be asked several questions.  The 
        questions asked, and the answers you should supply, are 
        shown below.
  
          INSTALL NAME: <HL*1.6*87>
          Want KIDS to INHIBIT LOGONS during the install?  <NO>
          Want to DISABLE Scheduled Options, Menu Options, and
          Protocols?  <NO>
  
    6.  Start up all Logical Links and incoming and outgoing filers using
        the Filer and Link Management Option's 'Restart/Start All Links
        and Filers [HL TASK RESTART]' menu option.
  
        (Note that links that do not have "autostart" enabled will need
        to be restarted manually.)
  
        AXP/DSM SITES ONLY: If you previously disabled an HL7 UCX Service
        for this installation, you may enable it now.
  
    7.  AXP/DSM Sites:  After the patch has been installed, rebuild your
        map set, if necessary.
  
    8.  Start Link Manager using the 'TCP Link Manager Start/Stop [HL
        START/STOP LINK MANAGER]' menu option. 

Routine Information:
====================

Routine Name:
  - HLCSTCP2


Routine Checksum:

=============================================================================
User Information:                               
Entered By  : GARCIA,JOSE                    Date Entered : OCT 30, 2001
Completed By: HERREN,CATHRYN                Date Completed: JUN 11, 2002
Released By : APOLONIO,AUGUSTO              Date Released : JUN 14, 2002
=============================================================================


Packman Mail Message:
=====================

$END TXT
