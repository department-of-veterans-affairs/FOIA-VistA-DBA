Released SD*5.3*375 SEQ #305
Extracted from mail message
**KIDS**:SD*5.3*375^

**INSTALL NAME**
SD*5.3*375
"BLD",5571,0)
SD*5.3*375^SCHEDULING^0^3040805^y
"BLD",5571,4,0)
^9.64PA^^
"BLD",5571,"KRN",0)
^9.67PA^8989.52^19
"BLD",5571,"KRN",.4,0)
.4
"BLD",5571,"KRN",.401,0)
.401
"BLD",5571,"KRN",.402,0)
.402
"BLD",5571,"KRN",.403,0)
.403
"BLD",5571,"KRN",.5,0)
.5
"BLD",5571,"KRN",.84,0)
.84
"BLD",5571,"KRN",3.6,0)
3.6
"BLD",5571,"KRN",3.8,0)
3.8
"BLD",5571,"KRN",9.2,0)
9.2
"BLD",5571,"KRN",9.8,0)
9.8
"BLD",5571,"KRN",9.8,"NM",0)
^9.68A^2^2
"BLD",5571,"KRN",9.8,"NM",1,0)
SCRPW41^^0^B64634157
"BLD",5571,"KRN",9.8,"NM",2,0)
SCRPW42^^0^B55996330
"BLD",5571,"KRN",9.8,"NM","B","SCRPW41",1)
 
"BLD",5571,"KRN",9.8,"NM","B","SCRPW42",2)
 
"BLD",5571,"KRN",19,0)
19
"BLD",5571,"KRN",19.1,0)
19.1
"BLD",5571,"KRN",101,0)
101
"BLD",5571,"KRN",409.61,0)
409.61
"BLD",5571,"KRN",771,0)
771
"BLD",5571,"KRN",870,0)
870
"BLD",5571,"KRN",8989.51,0)
8989.51
"BLD",5571,"KRN",8989.52,0)
8989.52
"BLD",5571,"KRN",8994,0)
8994
"BLD",5571,"KRN","B",.4,.4)
 
"BLD",5571,"KRN","B",.401,.401)
 
"BLD",5571,"KRN","B",.402,.402)
 
"BLD",5571,"KRN","B",.403,.403)
 
"BLD",5571,"KRN","B",.5,.5)
 
"BLD",5571,"KRN","B",.84,.84)
 
"BLD",5571,"KRN","B",3.6,3.6)
 
"BLD",5571,"KRN","B",3.8,3.8)
 
"BLD",5571,"KRN","B",9.2,9.2)
 
"BLD",5571,"KRN","B",9.8,9.8)
 
"BLD",5571,"KRN","B",19,19)
 
"BLD",5571,"KRN","B",19.1,19.1)
 
"BLD",5571,"KRN","B",101,101)
 
"BLD",5571,"KRN","B",409.61,409.61)
 
"BLD",5571,"KRN","B",771,771)
 
"BLD",5571,"KRN","B",870,870)
 
"BLD",5571,"KRN","B",8989.51,8989.51)
 
"BLD",5571,"KRN","B",8989.52,8989.52)
 
"BLD",5571,"KRN","B",8994,8994)
 
"BLD",5571,"QUES",0)
^9.62^^
"BLD",5571,"REQB",0)
^9.611^2^2
"BLD",5571,"REQB",1,0)
FB*3.5*78^1
"BLD",5571,"REQB",2,0)
SD*5.3*176^1
"BLD",5571,"REQB","B","FB*3.5*78",1)
 
"BLD",5571,"REQB","B","SD*5.3*176",2)
 
"MBREQ")
0
"PKG",16,-1)
1^1
"PKG",16,0)
SCHEDULING^SD^APPOINTMENTS,PROFILES,LETTERS,AMIS REPORTS
"PKG",16,20,0)
^9.402P^^
"PKG",16,22,0)
^9.49I^1^1
"PKG",16,22,1,0)
5.3^2930813
"PKG",16,22,1,"PAH",1,0)
375^3040805
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")
 
"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
2
"RTN","SCRPW41")
0^1^B64634157
"RTN","SCRPW41",1,0)
SCRPW41 ;RENO/KEITH - Veterans Without Activity Since a Specified Date Range ; 5/25/2004
"RTN","SCRPW41",2,0)
 ;;5.3;Scheduling;**144,375**;AUG 13, 1993
"RTN","SCRPW41",3,0)
 N DIR,%DT K SD
"RTN","SCRPW41",4,0)
 D TITL^SCRPW50("Veterans Without Activity Since a Specified Date Range")
"RTN","SCRPW41",5,0)
 W !!,"This report will return a list of veterans that are not deceased who had",!,"activity during a date range specified by the user, and have not been seen"
"RTN","SCRPW41",6,0)
 W !,"since.  Activity is determined by an examination of Fee Basis, inpatient and",!,"outpatient care (including future appointments)."
"RTN","SCRPW41",7,0)
 D SUBT^SCRPW50("**** Date Range Selection ****")
"RTN","SCRPW41",8,0)
 W ! S %DT="AEPX",%DT("A")="Beginning date: " D ^%DT G:Y<1 EXIT^SCRPW42 S SD("BDT")=Y X ^DD("DD") S SD("PBDT")=Y
"RTN","SCRPW41",9,0)
EDT S %DT("A")="   Ending date: " W ! D ^%DT G:Y<1 EXIT^SCRPW42
"RTN","SCRPW41",10,0)
 I Y<SD("BDT") W !!,$C(7),"End date cannot be before begin date!",! G EDT
"RTN","SCRPW41",11,0)
 S SD("EDT")=Y_.999999 X ^DD("DD") S SD("PEDT")=Y,(SDOUT,SDNUL)=0
"RTN","SCRPW41",12,0)
 D BLD^SCRPW21 S SDX="" D SUBT^SCRPW50("**** Output Sort Selection (optional) ****") S DIR("?")="Sort elements selected will determine the order of output.",(SD("PAGE"),SD("SORT"))=0
"RTN","SCRPW41",13,0)
 F SDI=1:1:6 S T="~",DIR("A")=$S(SDX="":"Specify data element to sort by",1:"Within "_SDX_", sort by") D ASK Q:SDOUT!SDNUL
"RTN","SCRPW41",14,0)
 G:SDOUT EXIT^SCRPW42 D SUBT^SCRPW50("**** Parameters Selected ****") W !!,"Veterans not seen since the date range: ",SD("PBDT")," to ",SD("PEDT"),!!,"Output sort elements: " D
"RTN","SCRPW41",15,0)
 .I SD("SORT")=0 W "(NONE SELECTED)" Q
"RTN","SCRPW41",16,0)
 .S SDI=0 F  S SDI=$O(SD("SORT",SDI)) Q:'SDI  S SDX=SD("SORT",SDI) W:SDI>1 ! W ?(19+(3*SDI)) S SDL=$S($P(SDX,U,3):(69-$X),1:(80-$X)) W $E($P(SDX,U,2),1,SDL)_$S($P(SDX,U,3):" <pagefeed>",1:"")
"RTN","SCRPW41",17,0)
 .Q
"RTN","SCRPW41",18,0)
 K DIR S DIR(0)="Y",DIR("A")="Ok",DIR("B")="YES",DIR("?")="Specify if the parameters are satisfactory as displayed." W ! D ^DIR G:$D(DTOUT)!$D(DUOUT) EXIT^SCRPW42 G:'Y EXIT^SCRPW42
"RTN","SCRPW41",19,0)
 N ZTSAVE S ZTSAVE("SD(")="" W !!,"This report requires 132 column output.",!
"RTN","SCRPW41",20,0)
 D EN^XUTMDEVQ("START^SCRPW41","Veterans Without Activity Since a Specified Date",.ZTSAVE) G EXIT^SCRPW42
"RTN","SCRPW41",21,0)
 ;
"RTN","SCRPW41",22,0)
ASK ;Ask for sort elements
"RTN","SCRPW41",23,0)
 N SDZ I $L(SDX) D SUBT^SCRPW50("**** Select "_$S(SDI=2:"second",SDI=3:"third",SDI=4:"fourth",SDI=5:"fifth",SDI=6:"sixth",1:"another")_" sort element (optional) ****")
"RTN","SCRPW41",24,0)
 K DIR(0) S S1=$$DIR^SCRPW23(.DIR,1,"","","O",2) Q:SDOUT!SDNUL
"RTN","SCRPW41",25,0)
 K DIR(0) S DIR("A")="Select "_$P(S1,U,2)_" data element",S2=$$DIR^SCRPW23(.DIR,2,"",$P(S1,U),"O",2,1) Q:SDOUT  I SDNUL S SDNUL=0 G ASK
"RTN","SCRPW41",26,0)
 S SDX=$P(S2,U,2),SD("SORT",SDI)=$P(S1,U)_$P(S2,U)_U_SDX_U_$$PF(),SD("SORT")=SD("SORT")+1 Q
"RTN","SCRPW41",27,0)
 ;
"RTN","SCRPW41",28,0)
PF() ;Prompt for page feed
"RTN","SCRPW41",29,0)
 N DIR S DIR(0)="Y",DIR("A")="Perform a pagefeed for each new "_SDX_" value",DIR("B")="NO",DIR("?")="Specify if you want a pagefeed between each sort value for this element." W ! D ^DIR I $D(DTOUT)!$D(DUOUT) S SDOUT=1 Q 0
"RTN","SCRPW41",30,0)
 S:Y SD("PAGE")=SDI Q Y
"RTN","SCRPW41",31,0)
 ;
"RTN","SCRPW41",32,0)
START ;Print report
"RTN","SCRPW41",33,0)
 K ^TMP("SCRPW",$J) D BLD^SCRPW21 S (SDOUT,SDSTOP,DFN)=0 D NOW^%DTC S SDNOW=%,T="~"
"RTN","SCRPW41",34,0)
 S SDFEE=""
"RTN","SCRPW41",35,0)
 F  S DFN=$O(^DPT(DFN)) Q:'DFN  S SDSTOP=SDSTOP+1 D:SDSTOP#3000=0 STOP Q:SDOUT  I $$VET() S SDX=$$EVAL(SD("BDT"),SD("EDT")) D:$P(SDX,U)=2 SET
"RTN","SCRPW41",36,0)
 G:SDOUT EXIT^SCRPW42 D NOW^%DTC S Y=% X ^DD("DD") S SDPNOW=$P(Y,":",1,2),SDLINE="",$P(SDLINE,"-",133)="",SDPAGE=1,(SDTOT,SDPG)=0 G ^SCRPW42
"RTN","SCRPW41",37,0)
 ;
"RTN","SCRPW41",38,0)
VET() ;Vet?  Alive?  Eligible?
"RTN","SCRPW41",39,0)
 D DEM^VADPT Q:VADM(6) 0  ;deceased
"RTN","SCRPW41",40,0)
 D ELIG^VADPT Q:'VAEL(4) 0  ;veteran
"RTN","SCRPW41",41,0)
 Q VAEL(5)  ;eligible
"RTN","SCRPW41",42,0)
 ;
"RTN","SCRPW41",43,0)
EVAL(SDBD,SDED) ;Evaluate last activity
"RTN","SCRPW41",44,0)
 ;Required input: SDBD=begin date of date range
"RTN","SCRPW41",45,0)
 ;Required input: SDED=end date of date range
"RTN","SCRPW41",46,0)
 ;Output: code^last activity date^location, where 'code'=
"RTN","SCRPW41",47,0)
 ;        1=activity since date range
"RTN","SCRPW41",48,0)
 ;        2=activity during date range, none since
"RTN","SCRPW41",49,0)
 ;        3=no activity during or after date range
"RTN","SCRPW41",50,0)
 N SDDT,SDX,SDXX,SDY
"RTN","SCRPW41",51,0)
 S SDX=$O(^SCE("ADFN",DFN,9999999),-1) I SDX S SDY=$O(^SCE("ADFN",DFN,SDX,0)),SDY=$$GETOE^SDOE(SDY),SDY=$P($G(^SC(+$P(SDY,U,4),0)),U),SDDT(SDX)=SDY
"RTN","SCRPW41",52,0)
 S SDX=$O(^DPT(DFN,"S",9999999),-1) I SDX S SDY=+$G(^DPT(DFN,"S",SDX,0)),SDY=$P($G(^SC(+SDY,0)),U),SDDT(SDX)=SDY
"RTN","SCRPW41",53,0)
 S SDX=$O(^DPT(DFN,"DIS",0)) I SDX S SDDT(9999999-SDX)="REGISTRATION"
"RTN","SCRPW41",54,0)
 S SDX=$O(^SDV("ADT",DFN,9999999),-1) I SDX S SDDT(SDX)="ADD/EDIT"
"RTN","SCRPW41",55,0)
 ;S SDX=$O(^FBAAA(DFN,1,9999999),-1) I SDX S SDX=$P($G(^FBAAA(DFN,1,SDX,0)),U) I SDX S SDDT(SDX)="FEE BASIS"
"RTN","SCRPW41",56,0)
 S SDXX=$$AUTHL^FBUTL(DFN,,SDBD,"SDX") D
"RTN","SCRPW41",57,0)
 .I +SDXX=-1,$P(SDXX,"^",2)=110 S SDFEE="FEE BASIS SYSTEM NOT AVAILABLE"
"RTN","SCRPW41",58,0)
 .I SDXX>0 S SDDT($G(SDX(SDXX,"FDT")))="FEE BASIS"
"RTN","SCRPW41",59,0)
 S SDX=$O(^DGPM("APRD",DFN,9999999),-1) I SDX S SDY=$O(^DGPM("APRD",DFN,SDX,0)),SDY=$G(^DGPM(+SDY,0)) I $L(SDY) D
"RTN","SCRPW41",60,0)
 .I $P(SDY,U,2)=1 S SDDT(SDX)=$P($G(^DIC(42,+$P(SDY,U,6),0)),U) Q
"RTN","SCRPW41",61,0)
 .I $P(SDY,U,2)=3 N D0,X S D0=$O(^DGPM("APRD",DFN,SDX,0)) D WARD^DGPMUTL S SDDT(SDX)=X Q
"RTN","SCRPW41",62,0)
 .D WARD(SDX) Q
"RTN","SCRPW41",63,0)
 D WARD(SDNOW)
"RTN","SCRPW41",64,0)
 S SDX=$O(SDDT(9999999),-1),SDX=$S('$L(SDX):U_U,1:U_SDX_U_SDDT(SDX))
"RTN","SCRPW41",65,0)
 Q:$P(SDX,U,2)'<SDED 1_SDX  Q:$P(SDX,U,2)'<SDBD 2_SDX  Q 3_SDX
"RTN","SCRPW41",66,0)
 ;
"RTN","SCRPW41",67,0)
WARD(SDT) ;Get ward for date/time
"RTN","SCRPW41",68,0)
 ;Required input: SDT=date/time
"RTN","SCRPW41",69,0)
 N DGT,DG1,DGA1,DGXFR0 S DGT=SDT D ^DGPMSTAT I DG1 S SDDT(SDT)=$P($G(^DIC(42,DG1,0)),U)
"RTN","SCRPW41",70,0)
 Q
"RTN","SCRPW41",71,0)
 ;
"RTN","SCRPW41",72,0)
SET ;Set TMP global
"RTN","SCRPW41",73,0)
 S SD0=$G(^DPT(DFN,0)),SDSSN=$P(SD0,U,9),SDPNAM=$P(SD0,U) Q:'$L(SDPNAM)  S $P(SDX,U)=SDSSN
"RTN","SCRPW41",74,0)
 N SDS I SD("SORT") S SDI="" F  S SDI=$O(SD("SORT",SDI)) Q:'SDI  S SDS(SDI)=$$SORT($P(SD("SORT",SDI),U))
"RTN","SCRPW41",75,0)
 I 'SD("SORT") S ^TMP("SCRPW",$J,1,SDPNAM,DFN)=SDX Q
"RTN","SCRPW41",76,0)
 I SD("SORT")=1 S ^TMP("SCRPW",$J,1,SDS(1),SDPNAM,DFN)=SDX Q
"RTN","SCRPW41",77,0)
 I SD("SORT")=2 S ^TMP("SCRPW",$J,1,SDS(1),SDS(2),SDPNAM,DFN)=SDX Q
"RTN","SCRPW41",78,0)
 I SD("SORT")=3 S ^TMP("SCRPW",$J,1,SDS(1),SDS(2),SDS(3),SDPNAM,DFN)=SDX Q
"RTN","SCRPW41",79,0)
 S SDUI=$$DSV^SCRPW42(SDS(1),SDS(2),SDS(3),SDS(4))
"RTN","SCRPW41",80,0)
 I SD("SORT")=4 S ^TMP("SCRPW",$J,1,SDS(1),SDS(2),SDS(3),SDS(4))="",^TMP("SCRPW",$J,2,SDUI,SDPNAM,DFN)=SDX Q
"RTN","SCRPW41",81,0)
 I SD("SORT")=5 S ^TMP("SCRPW",$J,1,SDS(1),SDS(2),SDS(3),SDS(4))="",^TMP("SCRPW",$J,2,SDUI,SDS(5),SDPNAM,DFN)=SDX Q
"RTN","SCRPW41",82,0)
 I SD("SORT")=6 S ^TMP("SCRPW",$J,1,SDS(1),SDS(2),SDS(3),SDS(4))="",^TMP("SCRPW",$J,2,SDUI,SDS(5),SDS(6),SDPNAM,DFN)=SDX
"RTN","SCRPW41",83,0)
 Q
"RTN","SCRPW41",84,0)
 ;
"RTN","SCRPW41",85,0)
SORT(SDACR) ;Return sort value
"RTN","SCRPW41",86,0)
 ;Required input: SDACR=data element acronym
"RTN","SCRPW41",87,0)
 N SDACT,SDX,SDOE0
"RTN","SCRPW41",88,0)
 S SDOE0=U_DFN_U,SDACT=^TMP("SCRPW",$J,"ACT",SDACR) X $P(SDACT,T,7)
"RTN","SCRPW41",89,0)
 S SDX=$O(SDX("")) Q $P(SDX(SDX),U,2)
"RTN","SCRPW41",90,0)
 ;
"RTN","SCRPW41",91,0)
STOP ;Check for stop task request
"RTN","SCRPW41",92,0)
 S:$D(ZTQUEUED) (SDOUT,ZTSTOP)=$S($$S^%ZTLOAD:1,1:0) Q
"RTN","SCRPW41",93,0)
 ;
"RTN","SCRPW41",94,0)
ASK1 ;Prompt for 'Means Test/Eligibility/Enrollment Report' parameters
"RTN","SCRPW41",95,0)
 N SD,SDDIV,%DT,X,Y,DIR,SDOUT,SDNUL S (SDOUT,SDNUL,SD("SORT"))=0
"RTN","SCRPW41",96,0)
 D TITL^SCRPW50("Means Test/Eligibility/Enrollment Report")
"RTN","SCRPW41",97,0)
 G:'$$DIVA^SCRPW17(.SDDIV) EXIT1^SCRPW42
"RTN","SCRPW41",98,0)
 D SUBT^SCRPW50("**** Date Range Selection ****")
"RTN","SCRPW41",99,0)
 W ! S %DT="AEPX",%DT(0)=2961001,%DT("A")="Beginning date: " D ^%DT G:Y<1 EXIT1^SCRPW42 S SD("BDT")=Y X ^DD("DD") S $P(SD("BDT"),U,2)=Y
"RTN","SCRPW41",100,0)
EDT1 S %DT("A")="   Ending date: " W ! D ^%DT G:Y<1 EXIT1^SCRPW42
"RTN","SCRPW41",101,0)
 I Y<SD("BDT") W !!,$C(7),"End date cannot be before begin date!",! G EDT1
"RTN","SCRPW41",102,0)
 S SD("EDT")=Y_.999999 X ^DD("DD") S $P(SD("EDT"),U,2)=Y
"RTN","SCRPW41",103,0)
 D SUBT^SCRPW50("**** Report Format Selection ****")
"RTN","SCRPW41",104,0)
 K DIR S DIR(0)="S^D:DETAILED;S:SUMMARY",DIR("A")="Select report format",DIR("?",1)="Specify the format of report you wish to print.  'Detailed' allows the printing",DIR("?")="of patient lists, 'summary' produces totals only."
"RTN","SCRPW41",105,0)
 S DIR("B")="SUMMARY" D ^DIR G:$D(DTOUT)!$D(DUOUT) EXIT1^SCRPW42 S SD("FMT",1)=Y_U_Y(0)  G:Y="S" STAT
"RTN","SCRPW41",106,0)
 D SUBT^SCRPW50("**** Detail Category Selection ****")
"RTN","SCRPW41",107,0)
 K DIR S DIR(0)="S^MT:MEANS TEST INDICATOR;EE:ENCOUNTER ELIGIBILITY;EP:ENROLLMENT PRIORITY",DIR("A")="Select category for detail",DIR("?")="This determines how output will be sorted."
"RTN","SCRPW41",108,0)
 D ^DIR G:$D(DTOUT)!$D(DUOUT) EXIT1^SCRPW42 S SD("FMT",2)=Y_U_Y(0) D SCAT^SCRPW43 G:'$D(SD("FMT",3))!SDOUT EXIT1^SCRPW42
"RTN","SCRPW41",109,0)
 S SDNUL=0 D BLD^SCRPW21 S SDX="" D SUBT^SCRPW50("**** Output Sort Selection (optional) ****") S DIR("?")="Sort elements selected will determine the order of output.",(SD("PAGE"),SD("SORT"))=0
"RTN","SCRPW41",110,0)
 F SDI=1:1:6 S T="~",DIR("A")=$S(SDX="":"Specify data element to sort by",1:"Within "_SDX_", sort by") D ASK^SCRPW41 Q:SDOUT!SDNUL
"RTN","SCRPW41",111,0)
STAT ;Prompt for encounter statuses to include
"RTN","SCRPW41",112,0)
 D SUBT^SCRPW50("**** Encounter Status Selection ****")
"RTN","SCRPW41",113,0)
 K SD("STAT") W !!,"Choose as many of the following statuses",!,"as you wish to include in the report:",!
"RTN","SCRPW41",114,0)
 W !?10,"CHECKED IN",!?10,"CHECKED OUT",!?10,"NO ACTION TAKEN",!?10,"INPATIENT APPOINTMENT",!?10,"NON-COUNT",!?10,"ACTION REQUIRED",! N DIC,I S DIC="^SD(409.63,",DIC(0)="AEMQ",DIC("B")="CHECKED OUT"
"RTN","SCRPW41",115,0)
 S DIC("S")="I Y<4!(Y=8!(Y=12!(Y=14)))",DIC("A")="Select encounter status: " F I=1:1 D ^DIC Q:$D(DTOUT)!$D(DUOUT)  S:Y>0 SD("STAT",$P(Y,U))=$P(Y,U,2) K DIC("B") Q:X=""&(I>1)
"RTN","SCRPW41",116,0)
 G:'$D(SD("STAT")) EXIT1^SCRPW42 D PDIS^SCRPW43 G:SDOUT EXIT1^SCRPW42
"RTN","SCRPW41",117,0)
 N ZTSAVE S ZTSAVE("SD(")="",ZTSAVE("SDDIV(")="",ZTSAVE("SDDIV")=""
"RTN","SCRPW41",118,0)
 W:$P(SD("FMT",1),U)="D" !!,"This report requires 132 column output." W ! D EN^XUTMDEVQ("START^SCRPW43","Means Test/Eligibility/Enrollment Report",.ZTSAVE),DISP0^SCRPW23 G EXIT1^SCRPW42
"RTN","SCRPW42")
0^2^B55996330
"RTN","SCRPW42",1,0)
SCRPW42 ;RENO/KEITH - Veterans Without Activity Since a Specified Date Range (cont.) ; 5/25/2004
"RTN","SCRPW42",2,0)
 ;;5.3;Scheduling;**144,176,375**;AUG 13, 1993
"RTN","SCRPW42",3,0)
 D:$E(IOST)="C" DISP0^SCRPW23 D HDR G:SDOUT EXIT D PRT0 G:SDOUT EXIT W !!,"REPORT TOTAL: ",SDT(0)
"RTN","SCRPW42",4,0)
 I $E(IOST)="C",'SDOUT N DIR S DIR(0)="E" D ^DIR
"RTN","SCRPW42",5,0)
EXIT D END^SCRPW50,KVA^VADPT K %,%H,%I,%DT,D0,DFN,DG1,DGA1,DGT,DGXFR0,DIR,DTOUT,DUOUT,S1,S2,S3,S4,S5,S6,SD,SD0,SDACR,SDUI
"RTN","SCRPW42",6,0)
 K SDACT,SDBD,SDDT,SDED,SDI,SDL,SDLINE,SDMTS,SDNOW,SDNUL,SDOE0,SDOUT,SDPAGE,SDPG,SDPNAM,SDPNOW,SDS,SDSSN,SDSTOP,SDT,SDTOT,SDX,SDY,SDZ,T,X,Y,SDFEE Q
"RTN","SCRPW42",7,0)
 ;
"RTN","SCRPW42",8,0)
HDR ;Print report header
"RTN","SCRPW42",9,0)
 I $E(IOST)="C",SDPAGE>1 N DIR S DIR(0)="E" D ^DIR S SDOUT=Y'=1 Q:SDOUT
"RTN","SCRPW42",10,0)
 D STOP Q:SDOUT  W:SDPAGE>1!($E(IOST)="C") $$XY^SCRPW50(IOF,1,0)
"RTN","SCRPW42",11,0)
 W:$X $$XY^SCRPW50("",0,0)
"RTN","SCRPW42",12,0)
 W SDLINE,!?34,"<*>  VETERANS WITHOUT ACTIVITY SINCE A SPECIFIED DATE RANGE  <*>",!,SDLINE
"RTN","SCRPW42",13,0)
 W:SDFEE'="" !,?40,"****",SDFEE,"****"
"RTN","SCRPW42",14,0)
 W !,"Last activity date range: ",SD("PBDT")," to ",SD("PEDT"),!,"Date printed: ",SDPNOW,?(126-$L(SDPAGE)),"Page: ",SDPAGE,!,SDLINE S SDPAGE=SDPAGE+1 Q
"RTN","SCRPW42",15,0)
 ;
"RTN","SCRPW42",16,0)
HD2 Q:SDOUT  D:$Y>(IOSL-4) HDR Q:SDOUT  W !,"Patient:",?26,"SSN:",?38,"Last activity:",?57,"Location:",?86,"Means Test:",?102,"Primary eligibility:" Q
"RTN","SCRPW42",17,0)
 ;
"RTN","SCRPW42",18,0)
STOP ;Check for stop task request
"RTN","SCRPW42",19,0)
 S:$D(ZTQUEUED) (SDOUT,ZTSTOP)=$S($$S^%ZTLOAD:1,1:0) Q
"RTN","SCRPW42",20,0)
 ;
"RTN","SCRPW42",21,0)
DSV(S1,S2,S3,S4) ;Produce detail sort value
"RTN","SCRPW42",22,0)
 ;Required input: S1, S2, S3, S4=subscript values
"RTN","SCRPW42",23,0)
 N SDX S SDX=$G(^TMP("SCRPW",$J,3,S1,S2,S3,S4)) Q:SDX SDX
"RTN","SCRPW42",24,0)
 S (SDX,^TMP("SCRPW",$J,3,0))=$G(^TMP("SCRPW",$J,3,0))+1
"RTN","SCRPW42",25,0)
 S ^TMP("SCRPW",$J,3,S1,S2,S3,S4)=SDX Q SDX
"RTN","SCRPW42",26,0)
 ;
"RTN","SCRPW42",27,0)
PRT0 ;Print 0 sorts
"RTN","SCRPW42",28,0)
 I '$D(^TMP("SCRPW",$J,1)) W !!,"No patients found that meet the report criteria!" S SDOUT=1 Q
"RTN","SCRPW42",29,0)
 S SDT(0)=0 I SD("SORT") D PRT1 Q
"RTN","SCRPW42",30,0)
 D SHD(0),HD2 S SDPNAM=""
"RTN","SCRPW42",31,0)
 F  S SDPNAM=$O(^TMP("SCRPW",$J,1,SDPNAM)) Q:SDPNAM=""!SDOUT  S DFN=0 F  S DFN=$O(^TMP("SCRPW",$J,1,SDPNAM,DFN)) Q:'DFN!SDOUT  S SDX=^TMP("SCRPW",$J,1,SDPNAM,DFN) D PLINE(0)
"RTN","SCRPW42",32,0)
 Q
"RTN","SCRPW42",33,0)
 ;
"RTN","SCRPW42",34,0)
PRT1 ;Print 1 sort
"RTN","SCRPW42",35,0)
 S S1="" F  S S1=$O(^TMP("SCRPW",$J,1,S1)) Q:S1=""!SDOUT  D
"RTN","SCRPW42",36,0)
 .S SDT(1)=0 D:SD("PAGE")=1&SDPG HDR Q:SDOUT
"RTN","SCRPW42",37,0)
 .I SD("SORT")=1 D PRT11 Q
"RTN","SCRPW42",38,0)
 .D PRT2,SST(1) Q
"RTN","SCRPW42",39,0)
 Q
"RTN","SCRPW42",40,0)
 ;
"RTN","SCRPW42",41,0)
PRT2 ;Print 2 sorts
"RTN","SCRPW42",42,0)
 S S2="" F  S S2=$O(^TMP("SCRPW",$J,1,S1,S2)) Q:S2=""!SDOUT  D
"RTN","SCRPW42",43,0)
 .S SDT(2)=0 D:SD("PAGE")=2&SDPG HDR Q:SDOUT
"RTN","SCRPW42",44,0)
 .I SD("SORT")=2 D PRT21 Q
"RTN","SCRPW42",45,0)
 .D PRT3,SST(2) Q
"RTN","SCRPW42",46,0)
 Q
"RTN","SCRPW42",47,0)
 ;
"RTN","SCRPW42",48,0)
PRT3 ;Print 3 sorts
"RTN","SCRPW42",49,0)
 S S3="" F  S S3=$O(^TMP("SCRPW",$J,1,S1,S2,S3)) Q:S3=""!SDOUT  D
"RTN","SCRPW42",50,0)
 .S SDT(3)=0 D:SD("PAGE")=3&SDPG HDR Q:SDOUT
"RTN","SCRPW42",51,0)
 .I SD("SORT")=3 D PRT31 Q
"RTN","SCRPW42",52,0)
 .D PRT4,SST(3) Q
"RTN","SCRPW42",53,0)
 Q
"RTN","SCRPW42",54,0)
 ;
"RTN","SCRPW42",55,0)
PRT4 ;Print 4 sorts
"RTN","SCRPW42",56,0)
 S S4="" F  S S4=$O(^TMP("SCRPW",$J,1,S1,S2,S3,S4)) Q:S4=""!SDOUT  D
"RTN","SCRPW42",57,0)
 .S SDUI=$$DSV(S1,S2,S3,S4)
"RTN","SCRPW42",58,0)
 .S SDT(4)=0 D:SD("PAGE")=4&SDPG HDR Q:SDOUT
"RTN","SCRPW42",59,0)
 .I SD("SORT")=4 D PRT41 Q
"RTN","SCRPW42",60,0)
 .D PRT5,SST(4) Q
"RTN","SCRPW42",61,0)
 Q
"RTN","SCRPW42",62,0)
 ;
"RTN","SCRPW42",63,0)
PRT5 ;Print 5 sorts
"RTN","SCRPW42",64,0)
 S S5="" F  S S5=$O(^TMP("SCRPW",$J,2,SDUI,S5)) Q:S5=""!SDOUT  D
"RTN","SCRPW42",65,0)
 .S SDT(5)=0 D:SD("PAGE")=5&SDPG HDR Q:SDOUT
"RTN","SCRPW42",66,0)
 .I SD("SORT")=5 D PRT51 Q
"RTN","SCRPW42",67,0)
 .D PRT6,SST(5) Q
"RTN","SCRPW42",68,0)
 Q
"RTN","SCRPW42",69,0)
 ;
"RTN","SCRPW42",70,0)
PRT6 ;Print 6 sorts
"RTN","SCRPW42",71,0)
 S S6="" F  S S6=$O(^TMP("SCRPW",$J,2,SDUI,S5,S6)) Q:S6=""!SDOUT  S SDT(6)=0 D:SD("PAGE")=6&SDPG HDR Q:SDOUT  D PRT61
"RTN","SCRPW42",72,0)
 Q
"RTN","SCRPW42",73,0)
 ;
"RTN","SCRPW42",74,0)
PRT11 D SHD(1),HD2 S SDPNAM=""
"RTN","SCRPW42",75,0)
 F  S SDPNAM=$O(^TMP("SCRPW",$J,1,S1,SDPNAM)) Q:SDPNAM=""!SDOUT  S DFN=0 F  S DFN=$O(^TMP("SCRPW",$J,1,S1,SDPNAM,DFN)) Q:'DFN!SDOUT  S SDX=^TMP("SCRPW",$J,1,S1,SDPNAM,DFN) D PLINE(1)
"RTN","SCRPW42",76,0)
 W ! D SST(1) Q
"RTN","SCRPW42",77,0)
 ;
"RTN","SCRPW42",78,0)
PRT21 D SHD(2),HD2 S SDPNAM=""
"RTN","SCRPW42",79,0)
 F  S SDPNAM=$O(^TMP("SCRPW",$J,1,S1,S2,SDPNAM)) Q:SDPNAM=""!SDOUT  S DFN=0 F  S DFN=$O(^TMP("SCRPW",$J,1,S1,S2,SDPNAM,DFN)) Q:'DFN!SDOUT  S SDX=^TMP("SCRPW",$J,1,S1,S2,SDPNAM,DFN) D PLINE(2)
"RTN","SCRPW42",80,0)
 W ! D SST(2) Q
"RTN","SCRPW42",81,0)
 ;
"RTN","SCRPW42",82,0)
PRT31 D SHD(3),HD2 S SDPNAM=""
"RTN","SCRPW42",83,0)
 F  S SDPNAM=$O(^TMP("SCRPW",$J,1,S1,S2,S3,SDPNAM)) Q:SDPNAM=""!SDOUT  S DFN=0 F  S DFN=$O(^TMP("SCRPW",$J,1,S1,S2,S3,SDPNAM,DFN)) Q:'DFN!SDOUT  S SDX=^TMP("SCRPW",$J,1,S1,S2,S3,SDPNAM,DFN) D PLINE(3)
"RTN","SCRPW42",84,0)
 W ! D SST(3) Q
"RTN","SCRPW42",85,0)
 ;
"RTN","SCRPW42",86,0)
PRT41 D SHD(4),HD2 S SDPNAM=""
"RTN","SCRPW42",87,0)
 F  S SDPNAM=$O(^TMP("SCRPW",$J,2,SDUI,SDPNAM)) Q:SDPNAM=""!SDOUT  S DFN=0 F  S DFN=$O(^TMP("SCRPW",$J,2,SDUI,SDPNAM,DFN)) Q:'DFN!SDOUT  S SDX=^TMP("SCRPW",$J,2,SDUI,SDPNAM,DFN) D PLINE(4)
"RTN","SCRPW42",88,0)
 W ! D SST(4) Q
"RTN","SCRPW42",89,0)
 ;
"RTN","SCRPW42",90,0)
PRT51 D SHD(5),HD2 S SDPNAM=""
"RTN","SCRPW42",91,0)
 F  S SDPNAM=$O(^TMP("SCRPW",$J,2,SDUI,S5,SDPNAM)) Q:SDPNAM=""!SDOUT  S DFN=0 F  S DFN=$O(^TMP("SCRPW",$J,2,SDUI,S5,SDPNAM,DFN)) Q:'DFN!SDOUT  S SDX=^TMP("SCRPW",$J,2,SDUI,S5,SDPNAM,DFN) D PLINE(5)
"RTN","SCRPW42",92,0)
 W ! D SST(5) Q
"RTN","SCRPW42",93,0)
 ;
"RTN","SCRPW42",94,0)
PRT61 D SHD(6),HD2 S SDPNAM=""
"RTN","SCRPW42",95,0)
 F  S SDPNAM=$O(^TMP("SCRPW",$J,2,SDUI,S5,S6,SDPNAM)) Q:SDPNAM=""!SDOUT  S DFN=0 F  S DFN=$O(^TMP("SCRPW",$J,2,SDUI,S5,S6,SDPNAM,DFN)) Q:'DFN!SDOUT  S SDX=^TMP("SCRPW",$J,2,SDUI,S5,S6,SDPNAM,DFN) D PLINE(6)
"RTN","SCRPW42",96,0)
 W ! D SST(6) Q
"RTN","SCRPW42",97,0)
 ;
"RTN","SCRPW42",98,0)
SHD(SDLEV) ;Print sort subheaders
"RTN","SCRPW42",99,0)
 ;Required input: SDLEV=number of sort levels
"RTN","SCRPW42",100,0)
 Q:SDOUT
"RTN","SCRPW42",101,0)
 I $Y>(IOSL-SDLEV-6) D HDR S SDPG=0 Q:SDOUT
"RTN","SCRPW42",102,0)
 W:(SD("PAGE")'=SD("SORT")&SDPG) !!,SDLINE S SDPG=1
"RTN","SCRPW42",103,0)
 I SD("SORT") W ! N SDI S SDI=0 D  W !
"RTN","SCRPW42",104,0)
 .F  S SDI=$O(SD("SORT",SDI)) Q:'SDI  W !?(5*SDI),$P(SD("SORT",SDI),U,2),": ",@("S"_SDI)
"RTN","SCRPW42",105,0)
 .Q
"RTN","SCRPW42",106,0)
 Q
"RTN","SCRPW42",107,0)
 ;
"RTN","SCRPW42",108,0)
PLINE(SDLEV) ;Print detail line
"RTN","SCRPW42",109,0)
 D:$Y>(IOSL-3) HDR,HD2 Q:SDOUT  D ELIG^VADPT S SDMTS=$P(VAEL(9),U,2),SDMTS=$S($L(SDMTS)>13:$E(SDMTS,1,13)_".",1:SDMTS)
"RTN","SCRPW42",110,0)
 W !,$E(SDPNAM,1,24),?26,$P(SDX,U) S Y=$P(SDX,U,2) X ^DD("DD") W ?38,$P(Y,":",1,2),?57,$E($P(SDX,U,3),1,27),?86,SDMTS,?102,$P(VAEL(1),U,2)
"RTN","SCRPW42",111,0)
 N SDI F SDI=0:1:SDLEV S SDT(SDI)=SDT(SDI)+1
"RTN","SCRPW42",112,0)
 Q
"RTN","SCRPW42",113,0)
 ;
"RTN","SCRPW42",114,0)
SST(SDLEV) ;Print sort subtotal
"RTN","SCRPW42",115,0)
 D:$Y>(IOSL-3) HDR Q:SDOUT
"RTN","SCRPW42",116,0)
 W !?(5*SDLEV),"SUBTOTAL: ",SDT(SDLEV),"  " S SDX=$P(SD("SORT",SDLEV),U,2)_" = "_@("S"_SDLEV),SDX=$E(SDX,1,(130-$X)) W "(",SDX,")" Q
"RTN","SCRPW42",117,0)
 ;
"RTN","SCRPW42",118,0)
S44 ;Print 'Means Test/Eligibility/Enrollment Report'
"RTN","SCRPW42",119,0)
 F SDX="MTP","EEP","EPP" S SDIV="" D
"RTN","SCRPW42",120,0)
 .F  S SDIV=$O(^TMP("SCRPW",$J,0,SDIV)) Q:SDIV=""  S SDZ="" D
"RTN","SCRPW42",121,0)
 ..F  S SDZ=$O(^TMP("SCRPW",$J,0,SDIV,SDX,SDZ)) Q:SDZ=""  S (SDTU,SDTV,DFN)=0 D
"RTN","SCRPW42",122,0)
 ...F  S DFN=$O(^TMP("SCRPW",$J,0,SDIV,SDX,SDZ,DFN)) Q:'DFN  S SDTU=SDTU+1,SDT=0 D
"RTN","SCRPW42",123,0)
 ....F  S SDT=$O(^TMP("SCRPW",$J,0,SDIV,SDX,SDZ,DFN,SDT)) Q:'SDT  S SDTV=SDTV+1
"RTN","SCRPW42",124,0)
 ....Q
"RTN","SCRPW42",125,0)
 ...S $P(^TMP("SCRPW",$J,0,SDIV,$E(SDX,1,2),SDZ,"ENC"),U,2)=SDTV_U_SDTU Q
"RTN","SCRPW42",126,0)
 ..Q
"RTN","SCRPW42",127,0)
 .Q
"RTN","SCRPW42",128,0)
 S SDIV="" F  S SDIV=$O(^TMP("SCRPW",$J,0,SDIV)) Q:SDIV=""  S (SDTU,SDTV)=0 D
"RTN","SCRPW42",129,0)
 .S DFN=0 F  S DFN=$O(^TMP("SCRPW",$J,0,SDIV,"RPT",DFN)) Q:'DFN  S SDTU=SDTU+1,SDT=0 F  S SDT=$O(^TMP("SCRPW",$J,0,SDIV,"RPT",DFN,SDT)) Q:'SDT  S SDTV=SDTV+1
"RTN","SCRPW42",130,0)
 .S $P(^TMP("SCRPW",$J,0,SDIV,"RPT","ENC"),U,2)=SDTV_U_SDTU Q
"RTN","SCRPW42",131,0)
 .Q
"RTN","SCRPW42",132,0)
 D STOP G:SDOUT EXIT1
"RTN","SCRPW42",133,0)
 S SDLINE="",$P(SDLINE,"-",(IOM+1))="",SDPG=0 D NOW^%DTC S Y=% X ^DD("DD") S SDPNOW=$P(Y,":",1,2),SDTIT(1)="<*>  MEANS TEST/ELIGIBILITY/ENROLLMENT REPORT  <*>" D
"RTN","SCRPW42",134,0)
 .I $P(SDDIV,U,2)="SELECTED DIVISIONS" D  Q
"RTN","SCRPW42",135,0)
 ..S SDI=0 F  S SDI=$O(SDDIV(SDI)) Q:'SDI  S SDIV(SDDIV(SDI))=SDI
"RTN","SCRPW42",136,0)
 ..Q
"RTN","SCRPW42",137,0)
 .I $P(SDDIV,U,2)="ALL DIVISIONS" D  Q
"RTN","SCRPW42",138,0)
 ..S SDI=0 F  S SDI=$O(^TMP("SCRPW",$J,0,SDI)) Q:'SDI  S SDX=$P($G(^DG(40.8,SDI,0)),U) S:'$L(SDX) SDX="***UNKNOWN***" S SDIV(SDX)=SDI
"RTN","SCRPW42",139,0)
 ..Q
"RTN","SCRPW42",140,0)
 .S SDIV($P(SDDIV,U,2))=$P(SDDIV,U) Q
"RTN","SCRPW42",141,0)
 I 'SDDIV,$P(SDDIV,U,2)'="ALL DIVISIONS" S SDIV($P(SDDIV,U,2))=$$PRIM^VASITE()
"RTN","SCRPW42",142,0)
 D:$E(IOST)="C" DISP0^SCRPW23 S C=(IOM-80\2),SDIVN="" F  S SDIVN=$O(SDIV(SDIVN)) Q:SDIVN=""!SDOUT  S SDIV=SDIV(SDIVN) D DPRT^SCRPW44(.SDIV)
"RTN","SCRPW42",143,0)
 G:SDOUT EXIT1 S SDMD=$O(^TMP("SCRPW",$J,0,0)),SDMD=$O(^TMP("SCRPW",$J,0,SDMD)) I SDMD S SDIV=0 D DPRT^SCRPW44(.SDIV)
"RTN","SCRPW42",144,0)
 I $E(IOST)="C",'SDOUT W ! N DIR S DIR(0)="E" D ^DIR
"RTN","SCRPW42",145,0)
EXIT1 D END^SCRPW50,KVA^VADPT K %,%DT,C,DFN,DIC,DIR,DTOUT,DUOUT,I,S0,S1,S2,S3,S4,S5,S6,SD,SD0,SDACR,SDACT,SDDIV,SDE,SDEL,SDEP,SDUI
"RTN","SCRPW42",146,0)
 K SDI,SDII,SDIV,SDIVN,SDL,SDL1,SDLEV,SDLF,SDLINE,SDMD,SDMT,SDMTS,SDNUL,SDOE,SDOE0,SDOUT,SDP,SDPAGE,SDPG,SDPGL,SDPNAM,SDPNOW,SDS,SDSSN,SDSTOP
"RTN","SCRPW42",147,0)
 K SDT,SDTIT,SDTU,SDTV,SDU,SDV,SDX,SDY,SDZ,T,X,Y Q
"VER")
8.0^22
**END**
**END**
