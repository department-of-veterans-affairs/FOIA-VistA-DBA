Released PRC*5.1*90 SEQ #87
Extracted from mail message
**KIDS**:PRC*5.1*90^

**INSTALL NAME**
PRC*5.1*90
"BLD",4993,0)
PRC*5.1*90^IFCAP^0^3060628^y
"BLD",4993,1,0)
^^8^8^3060614^
"BLD",4993,1,1,0)
This patch corrects two issues. The first involves the inability of the 
"BLD",4993,1,2,0)
Display/Print 1358 option to find an obligation number when the user had 
"BLD",4993,1,3,0)
previously used this option and then backed completely 
"BLD",4993,1,4,0)
out.                 
"BLD",4993,1,5,0)
 
"BLD",4993,1,6,0)
The second issue involves the Running Balances option.  A blank page 
"BLD",4993,1,7,0)
precedes the printing of the report and the page number is wrapping to 
"BLD",4993,1,8,0)
the next line.
"BLD",4993,4,0)
^9.64PA^^
"BLD",4993,6)
1^
"BLD",4993,"KRN",0)
^9.67PA^8989.52^19
"BLD",4993,"KRN",.4,0)
.4
"BLD",4993,"KRN",.401,0)
.401
"BLD",4993,"KRN",.402,0)
.402
"BLD",4993,"KRN",.403,0)
.403
"BLD",4993,"KRN",.5,0)
.5
"BLD",4993,"KRN",.84,0)
.84
"BLD",4993,"KRN",3.6,0)
3.6
"BLD",4993,"KRN",3.8,0)
3.8
"BLD",4993,"KRN",9.2,0)
9.2
"BLD",4993,"KRN",9.8,0)
9.8
"BLD",4993,"KRN",9.8,"NM",0)
^9.68A^4^4
"BLD",4993,"KRN",9.8,"NM",1,0)
PRCEFIS4^^0^B7308183
"BLD",4993,"KRN",9.8,"NM",2,0)
PRCSP1A^^0^B47712305
"BLD",4993,"KRN",9.8,"NM",3,0)
PRCSFMS^^0^B10344273
"BLD",4993,"KRN",9.8,"NM",4,0)
PRCSFMS1^^0^B17770205
"BLD",4993,"KRN",9.8,"NM","B","PRCEFIS4",1)

"BLD",4993,"KRN",9.8,"NM","B","PRCSFMS",3)

"BLD",4993,"KRN",9.8,"NM","B","PRCSFMS1",4)

"BLD",4993,"KRN",9.8,"NM","B","PRCSP1A",2)

"BLD",4993,"KRN",19,0)
19
"BLD",4993,"KRN",19.1,0)
19.1
"BLD",4993,"KRN",101,0)
101
"BLD",4993,"KRN",409.61,0)
409.61
"BLD",4993,"KRN",771,0)
771
"BLD",4993,"KRN",870,0)
870
"BLD",4993,"KRN",8989.51,0)
8989.51
"BLD",4993,"KRN",8989.52,0)
8989.52
"BLD",4993,"KRN",8994,0)
8994
"BLD",4993,"KRN","B",.4,.4)

"BLD",4993,"KRN","B",.401,.401)

"BLD",4993,"KRN","B",.402,.402)

"BLD",4993,"KRN","B",.403,.403)

"BLD",4993,"KRN","B",.5,.5)

"BLD",4993,"KRN","B",.84,.84)

"BLD",4993,"KRN","B",3.6,3.6)

"BLD",4993,"KRN","B",3.8,3.8)

"BLD",4993,"KRN","B",9.2,9.2)

"BLD",4993,"KRN","B",9.8,9.8)

"BLD",4993,"KRN","B",19,19)

"BLD",4993,"KRN","B",19.1,19.1)

"BLD",4993,"KRN","B",101,101)

"BLD",4993,"KRN","B",409.61,409.61)

"BLD",4993,"KRN","B",771,771)

"BLD",4993,"KRN","B",870,870)

"BLD",4993,"KRN","B",8989.51,8989.51)

"BLD",4993,"KRN","B",8989.52,8989.52)

"BLD",4993,"KRN","B",8994,8994)

"BLD",4993,"QUES",0)
^9.62^^
"MBREQ")
0
"PKG",455,-1)
1^1
"PKG",455,0)
IFCAP^PRC^IFCAP System Files
"PKG",455,20,0)
^9.402P^^
"PKG",455,22,0)
^9.49I^1^1
"PKG",455,22,1,0)
5.1^3001012^3001019^68
"PKG",455,22,1,"PAH",1,0)
90^3060628^123456803
"PKG",455,22,1,"PAH",1,1,0)
^^8^8^3060628
"PKG",455,22,1,"PAH",1,1,1,0)
This patch corrects two issues. The first involves the inability of the 
"PKG",455,22,1,"PAH",1,1,2,0)
Display/Print 1358 option to find an obligation number when the user had 
"PKG",455,22,1,"PAH",1,1,3,0)
previously used this option and then backed completely 
"PKG",455,22,1,"PAH",1,1,4,0)
out.                 
"PKG",455,22,1,"PAH",1,1,5,0)
 
"PKG",455,22,1,"PAH",1,1,6,0)
The second issue involves the Running Balances option.  A blank page 
"PKG",455,22,1,"PAH",1,1,7,0)
precedes the printing of the report and the page number is wrapping to 
"PKG",455,22,1,"PAH",1,1,8,0)
the next line.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
4
"RTN","PRCEFIS4")
0^1^B7308183^B7242646
"RTN","PRCEFIS4",1,0)
PRCEFIS4 ;WISC/CTB/CLH-POST LIQUIDATION WHILE IN CODE SHEET MODULE ; 10/10/97  1400
"RTN","PRCEFIS4",2,0)
V ;;5.1;IFCAP;**90**;Oct 20, 2000
"RTN","PRCEFIS4",3,0)
 ;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","PRCEFIS4",4,0)
 Q:$D(PRCFA(1358))
"RTN","PRCEFIS4",5,0)
 S PRCFA("CSM")="",ZX=$O(^PRCD(442.5,"C",1358,0))
"RTN","PRCEFIS4",6,0)
 S PODA=$S($G(PRCFA("PODA"))]"":PRCFA("PODA"),$G(PRCF("PODA"))]"":PRCF("PODA"),1:"")
"RTN","PRCEFIS4",7,0)
 D PO^PRCH58OB(.PODA,.PO)
"RTN","PRCEFIS4",8,0)
 S PRCFA("TRDA")=$P(PO(0),"^",12) I PRCFA("TRDA")'>0 K PRCFA("TRDA") G EX1
"RTN","PRCEFIS4",9,0)
 G:$P(PO(0),"^",2)'=ZX EX1
"RTN","PRCEFIS4",10,0)
 I $D(PRCFD("PAYMENT")) G CI
"RTN","PRCEFIS4",11,0)
 G OUT
"RTN","PRCEFIS4",12,0)
 ;post 1358 liquidation is not asked - plt 4/93
"RTN","PRCEFIS4",13,0)
 ;K ZX S DIR("A")="Do you wish to post a liquidation to the 1358 now",DIR("B")="No",DIR(0)="YO",DIR("?")="Enter YES to post, <RETURN> or No to quit"
"RTN","PRCEFIS4",14,0)
 ;D ^DIR I Y'=1 G OUT
"RTN","PRCEFIS4",15,0)
CI S:$G(PRCFA("PODA"))="" PRCFA("PODA")=$S($G(PODA)]"":PODA,$G(PRCF("PODA"))]"":PRCF("PODA"),1:"") D EN1^PRCELIQ
"RTN","PRCEFIS4",16,0)
OUT ;W:'$D(PRCFD("PAYMENT")) !!,"Returning to Code Sheet Module",!!,$C(7) Q
"RTN","PRCEFIS4",17,0)
 Q
"RTN","PRCEFIS4",18,0)
EX1 K %,DIC,DIE,DR,PRCFA("CSM"),X,X1,ZX Q
"RTN","PRCEFIS4",19,0)
 ;
"RTN","PRCEFIS4",20,0)
EOM ; PRINT END OF MONTH REPORT
"RTN","PRCEFIS4",21,0)
 S DIC="^PRC(442,",L=0,(BY,FLDS)="[PRCE 1358 EOM REPORT]" D EN1^DIP Q
"RTN","PRCEFIS4",22,0)
 ;
"RTN","PRCEFIS4",23,0)
PRINT ;PRINT ANY 1358
"RTN","PRCEFIS4",24,0)
 S ZX=$O(^PRCD(442.5,"C",1358,0)) I ZX="" W !,"Error in PAT Type file, Contact your IFCAP coordinator.",$C(7),!! K ZX Q
"RTN","PRCEFIS4",25,0)
 W !,"Brief or Standard output? (B/S): B// " R X:DTIME Q:'$T!(X["^")  S:X="" X="B" I "BbSs?"'[$E(X,1) W "??  B(rief) or S(tandard) ONLY",$C(7) G PRINT
"RTN","PRCEFIS4",26,0)
 I $E(X,1)["?" W !,"  The Standard output is the complete 1358 document, the Brief output provides",!,"  only the transaction information." G PRINT
"RTN","PRCEFIS4",27,0)
 I "Bb"[$E(X,1) F I=1:1 D ^PRCEFIS5 K PO,IOINHI,IOINLOW,IOINORM,ZX S %A="Do you wish to view another 1358",%B="",%=1 D ^PRCFYN K:%=1 PRC("CP") G:%=1 PRINT K I G EXIT
"RTN","PRCEFIS4",28,0)
 I '$D(PRC("SITE")) S PRCF("X")="AS" D ^PRCFSITE
"RTN","PRCEFIS4",29,0)
 S REP="PRCEFIS4" D PRF58E^PRCE58P
"RTN","PRCEFIS4",30,0)
REP I $D(REP) S %A="Do you wish to print another 1358",%B="",%=2 D ^PRCFYN I %=1 W !! K PRC("CP") G PRINT
"RTN","PRCEFIS4",31,0)
EXIT K %,%DT,%ZIS,BY,C2,C3,D,DA,DHD,DIE,PRCS,PRCSQ,FLDS,REP,FR,I,IOP,L,N,TO,X,Y,PRC("CP")
"RTN","PRCEFIS4",32,0)
 S:$D(PRCXSITE) PRC("SITE")=PRCXSITE S:$D(PRCXCP) PRC("CP")=PRCXCP K PRCXCP,PRCXSITE Q
"RTN","PRCEFIS4",33,0)
 Q
"RTN","PRCSFMS")
0^3^B10344273^B10346074
"RTN","PRCSFMS",1,0)
PRCSFMS ;WISC/KMB-FMS TRANSACTIONS FOR CP RUNNING BALANCE ;10/16/97  1315
"RTN","PRCSFMS",2,0)
V ;;5.1;IFCAP;**90**;Oct 20, 2000
"RTN","PRCSFMS",3,0)
 ;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","PRCSFMS",4,0)
BEGIN ;   this routine is called from PRCSP1A
"RTN","PRCSFMS",5,0)
 ;   find FMS transactions, for selected quarter, for CP
"RTN","PRCSFMS",6,0)
 N FTST,ZIP,P18,P19,RPR,RPR1,CUTOFF,FMSTOT,LINE,STRING,RDATE1,FIRST,FINAL,AMT,TYPE,MINUS,OBL,REF,RECNO,P1,RECN1
"RTN","PRCSFMS",7,0)
 S Z1=0,P1=0,U="^"
"RTN","PRCSFMS",8,0)
 D NOW^%DTC S Y=% D DD^%DT S RDATE1=Y
"RTN","PRCSFMS",9,0)
 S FMSTOT=0 S:'$D(PRCS("O")) PRCS("O")=0 S FINAL=PRCS("O"),STRING=PRC("SITE")_"-"_PRC("FY")_"-"_PRC("QTR")_"-"_+PRC("CP")
"RTN","PRCSFMS",10,0)
 S MINUS="" S:'$D(PRCS("C")) PRCS("C")=0
"RTN","PRCSFMS",11,0)
 S FIRST=PRCS("C")
"RTN","PRCSFMS",12,0)
 S RECNO="" F  S RECNO=$O(^PRCS(417,"C",STRING,RECNO)) Q:RECNO=""  D  Q:Z1=U
"RTN","PRCSFMS",13,0)
 .I '$D(C1),P1=0 D HDR1
"RTN","PRCSFMS",14,0)
 .I '$D(C1),IOSL-$Y<8 D HOLD1 Q:Z1=U
"RTN","PRCSFMS",15,0)
 .S ZIP="",RPR1="",RECN1=$P(^PRCS(417,RECNO,0),"^",23)
"RTN","PRCSFMS",16,0)
 .Q:RECN1="D"
"RTN","PRCSFMS",17,0)
 .Q:RECN1="N"
"RTN","PRCSFMS",18,0)
 .S AMT=$P(^PRCS(417,RECNO,0),"^",20),REF=$P(^(0),"^",22),OBL=$P(^(0),"^",18),TYPE=$P(^(0),"^",17)
"RTN","PRCSFMS",19,0)
 .S P18=$P(^PRCS(417,RECNO,0),"^",18),P19=$P(^PRCS(417,RECNO,0),"^",19)
"RTN","PRCSFMS",20,0)
 .S RPR="C"_P18_P19
"RTN","PRCSFMS",21,0)
 .I TYPE="CC",$D(^PRCH(440.6,"B",RPR)) S RPR1=$O(^PRCH(440.6,"B",RPR,0))
"RTN","PRCSFMS",22,0)
 .I $G(RPR1)'="" S FTST=$P($G(^PRCH(440.6,RPR1,0)),"^",16) S:FTST="N" ZIP="@"
"RTN","PRCSFMS",23,0)
 .S CUTOFF=$P($G(^PRCS(417,RECNO,1)),"^") I CUTOFF'=1 S FIRST=FIRST-AMT
"RTN","PRCSFMS",24,0)
 .I CUTOFF=1,TYPE'="CC",$E(OBL,4,7)'?4A S FIRST=FIRST-AMT
"RTN","PRCSFMS",25,0)
 .S FINAL=FINAL-AMT
"RTN","PRCSFMS",26,0)
 .I '$D(C1) S Y=$P(REF,".") D DD^%DT W !,Y
"RTN","PRCSFMS",27,0)
 .I '$D(C1) W ?13,OBL,?32,TYPE,?40,$J(AMT,11,2),ZIP,?54,$J(FIRST,11,2)
"RTN","PRCSFMS",28,0)
 .I '$D(C1) W ?68,$J(FINAL,11,2)
"RTN","PRCSFMS",29,0)
 .S FMSTOT=FMSTOT+AMT
"RTN","PRCSFMS",30,0)
 I FMSTOT<0 S MINUS="-",FMSTOT=-FMSTOT
"RTN","PRCSFMS",31,0)
 I Z1'=U W !!,"FMS transaction total for this quarter: ",MINUS,"$"_$J(FMSTOT,0,2)
"RTN","PRCSFMS",32,0)
 S L="",$P(L,"=",IOM)="=" W !,L S L=""
"RTN","PRCSFMS",33,0)
 S PRCS("C")=FIRST,PRCS("O")=FINAL Q
"RTN","PRCSFMS",34,0)
HOLD1 ;
"RTN","PRCSFMS",35,0)
 Q:$D(C1)
"RTN","PRCSFMS",36,0)
 G HDR1:$D(ZTQUEUED),HDR1:IO'=IO(0)
"RTN","PRCSFMS",37,0)
 D:$E(IOST,1,2)="C-" CRT D:Z1'=U HDR1
"RTN","PRCSFMS",38,0)
 Q
"RTN","PRCSFMS",39,0)
HDR1 ;
"RTN","PRCSFMS",40,0)
 S P1=1
"RTN","PRCSFMS",41,0)
 S P=P+1 W @IOF W "Control Point Balance - ",Z(0)_" "_$E($P(PRC("CP")," ",2),1,10),?50,RDATE1,?73,"PAGE ",P
"RTN","PRCSFMS",42,0)
 W !,?40,"FMS Transactions",!
"RTN","PRCSFMS",43,0)
 W !,"TRANSMISSION",?32,"TRANS",?40,"TRANSACTION",?68,"UNOBLIG",!,"DATE",?13,"REFERENCE #",?32,"CODE",?40,"$ AMOUNT",?54,"CP BALANCE",?68,"BALANCE"
"RTN","PRCSFMS",44,0)
 S L="",$P(L,"=",IOM)="=" W !,L S L="" Q
"RTN","PRCSFMS",45,0)
NONE ; find PO with no 2237 for running balance
"RTN","PRCSFMS",46,0)
 QUIT
"RTN","PRCSFMS",47,0)
HOLD2 ;
"RTN","PRCSFMS",48,0)
 G HDR2:$D(ZTQUEUED),HDR2:IO'=IO(0)
"RTN","PRCSFMS",49,0)
 D:$E(IOST,1,2)="C-" CRT D:Z1'=U HDR2
"RTN","PRCSFMS",50,0)
 Q
"RTN","PRCSFMS",51,0)
HDR2 ;
"RTN","PRCSFMS",52,0)
 S P1=1
"RTN","PRCSFMS",53,0)
 S P=P+1 W @IOF W "Control Point Balance - ",Z(0)_" "_$E($P(PRC("CP")," ",2),1,10),?50,RDATE1,?73,"PAGE ",P
"RTN","PRCSFMS",54,0)
 W !,?5,"__________PO TRANSACTIONS WITHOUT 2237______________",!
"RTN","PRCSFMS",55,0)
 W !,"PO/",?20,"PO ",?33,"COMMITTED",?58,"OBL/CEIL",?68,"UNOBLIG",!,"OBL#",?20,"DATE",?33,"(EST) COST",?44,"CP BALANCE",?58,"$ AMOUNT",?68,"BALANCE"
"RTN","PRCSFMS",56,0)
 S L="",$P(L,"=",IOM)="=" W !,L S L="" Q
"RTN","PRCSFMS",57,0)
CRT W !,"Press return to continue, uparrow (^) to exit: " R Z1:DTIME S:'$T Z1=U Q:Z1=""  Q:Z1=U  W "??" G CRT
"RTN","PRCSFMS1")
0^4^B17770205^B17771985
"RTN","PRCSFMS1",1,0)
PRCSFMS1 ;WISC/KMB-FMS TRANSACTIONS FOR CP QUARTERLY REPORT ;10-17-94 11:05
"RTN","PRCSFMS1",2,0)
V ;;5.1;IFCAP;**90**;Oct 20, 2000
"RTN","PRCSFMS1",3,0)
 ;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","PRCSFMS1",4,0)
BEGIN ;   this routine is called from PRCSQR
"RTN","PRCSFMS1",5,0)
 ;   find FMS transactions, for selected quarter, for CP
"RTN","PRCSFMS1",6,0)
 N Z1,FMSTOT,LINE,STRING,RDATE1,FIRST,FINAL,AMT,TYPE,MINUS,OBL,REF,RECNO,P1,PRCSAPP S (P1,Z1)=0
"RTN","PRCSFMS1",7,0)
 D NOW^%DTC S Y=% D DD^%DT S RDATE1=Y
"RTN","PRCSFMS1",8,0)
 S FMSTOT=0 S:'$D(PRCS("O")) PRCS("O")=0 S FINAL=PRCS("O"),STRING=PRC("SITE")_"-"_PRC("FY")_"-"_PRC("QTR")_"-"_+PRC("CP")
"RTN","PRCSFMS1",9,0)
 S:'$D(PRCS("PRE")) PRCS("PRE")=0 S PRCSAPP=PRCS("PRE")
"RTN","PRCSFMS1",10,0)
 S MINUS="" S:'$D(PRCS("C")) PRCS("C")=0 S FIRST=PRCS("C")
"RTN","PRCSFMS1",11,0)
 S RECNO="" F  S RECNO=$O(^PRCS(417,"C",STRING,RECNO)) Q:RECNO=""  D  Q:Z1=U
"RTN","PRCSFMS1",12,0)
 .I P1=0 D HDR1
"RTN","PRCSFMS1",13,0)
 .I IOSL-$Y<8 D HOLD1 Q:Z1=U
"RTN","PRCSFMS1",14,0)
 .S AMT=$P(^PRCS(417,RECNO,0),"^",20),REF=$P(^(0),"^",22),OBL=$P(^(0),"^",18),TYPE=$P(^(0),"^",17)
"RTN","PRCSFMS1",15,0)
 .S PRCSAPP=PRCSAPP-AMT,FIRST=FIRST-AMT,FINAL=FINAL-AMT
"RTN","PRCSFMS1",16,0)
 .S Y=$P(REF,".") D DD^%DT W !,Y
"RTN","PRCSFMS1",17,0)
 .W ?13,OBL,?24,TYPE,?32,$J(AMT,0,2),?42,$J(PRCSAPP,0,2),?54,$J(FIRST,0,2)
"RTN","PRCSFMS1",18,0)
 .W ?68,$J(FINAL,0,2)
"RTN","PRCSFMS1",19,0)
 .S FMSTOT=FMSTOT+AMT
"RTN","PRCSFMS1",20,0)
 I FMSTOT<0 S MINUS="-",FMSTOT=-FMSTOT
"RTN","PRCSFMS1",21,0)
 I Z1'=U W !!,"FMS transaction total for this quarter: ",MINUS,"$"_$J(FMSTOT,0,2)
"RTN","PRCSFMS1",22,0)
 S L="",$P(L,"=",IOM)="=" W !,L S L=""
"RTN","PRCSFMS1",23,0)
 S PRCS("PRE")=PRCSAPP,PRCS("C")=FIRST,PRCS("O")=FINAL Q
"RTN","PRCSFMS1",24,0)
HOLD1 ;
"RTN","PRCSFMS1",25,0)
 Q:$D(C1)
"RTN","PRCSFMS1",26,0)
 G HDR1:$D(ZTQUEUED),HDR1:IO'=IO(0) W !,"Press return to continue, uparrow (^) to exit: " R Z1:DTIME S:'$T Z1=U D:Z1'=U HDR1 Q
"RTN","PRCSFMS1",27,0)
HDR1 ;
"RTN","PRCSFMS1",28,0)
 S P1=1
"RTN","PRCSFMS1",29,0)
 S P=P+1 W @IOF W "QUARTERLY REPORT "_"- "_Z(0)_" "_$E($P(PRC("CP")," ",2),1,10),?50,RDATE1,?73,"PAGE ",P
"RTN","PRCSFMS1",30,0)
 W !,?40,"FMS Transactions",!
"RTN","PRCSFMS1",31,0)
 W !,"TRANS",?32,"TRANS",?42,"CONTROL PT.",?54,"UNCOMMITTED",?68,"UNOBLIGATED",!,"DATE",?13,"REF #",?24,"TYPE",?32,"AMOUNT",?42,"REQ TOT",?54,"BALANCE",?68,"BALANCE"
"RTN","PRCSFMS1",32,0)
 S L="",$P(L,"=",IOM)="=" W !,L S L="" Q
"RTN","PRCSFMS1",33,0)
NONE ; find PO with no 2237 for running balance
"RTN","PRCSFMS1",34,0)
 N PRCSAPP,P1,Y,RDATE,TOTAL,AMT,AMT1,PI,REC,FIRST,FINAL,NET,STRING,NONNET
"RTN","PRCSFMS1",35,0)
 N YEAR,L,RDATE1,CP,LINE,MINUS,TYPR,RQTR
"RTN","PRCSFMS1",36,0)
 D NOW^%DTC S Y=% D DD^%DT S RDATE1=Y
"RTN","PRCSFMS1",37,0)
 S CP=$P(PRC("CP")," "),REC="",TOTAL=0,P1=0,Z1=""
"RTN","PRCSFMS1",38,0)
 S STRING="2^2^2^3^3^3^4^4^4^1^1^1"
"RTN","PRCSFMS1",39,0)
 S:'$D(PRCS("O")) PRCS("O")=0 S FINAL=PRCS("O")
"RTN","PRCSFMS1",40,0)
 S:'$D(PRCS("PRE")) PRCS("PRE")=0 S PRCSAPP=PRCS("PRE")
"RTN","PRCSFMS1",41,0)
 S MINUS="" S:'$D(PRCS("C")) PRCS("C")=0 S FIRST=PRCS("C")
"RTN","PRCSFMS1",42,0)
 S PRCC=+$$YEAR^PRC0C(PRC("FY"))
"RTN","PRCSFMS1",43,0)
 S PRCE=$$QTRDATE^PRC0D(PRCC,PRC("QTR"))
"RTN","PRCSFMS1",44,0)
 S REC=$P(PRCE,"^",8)+100,REC=$$DATE^PRC0C(REC,"H")
"RTN","PRCSFMS1",45,0)
 S PRCG=$$QTRDATE^PRC0D(+REC,$P(REC,"^",2))
"RTN","PRCSFMS1",46,0)
 S PRCE=$P(PRCE,"^",7)-1,PRCG=$P(PRCG,"^",7)-1
"RTN","PRCSFMS1",47,0)
 F  S PRCE=$O(^PRC(442,"AB",PRCE)) QUIT:PRCE>PRCG!'PRCE  D  Q:Z1=U
"RTN","PRCSFMS1",48,0)
 . S REC=0 F  S REC=$O(^PRC(442,"AB",PRCE,REC)) QUIT:'REC  S PRCF=$G(^PRC(442,REC,0)) I $P(PRCF,"^",12)="",+PRCF=PRC("SITE"),+$P(PRCF,"^",3)=+PRC("CP") D:$P($G(^(12)),"^",2)]""  Q:Z1=U
"RTN","PRCSFMS1",49,0)
 ..S AMT=$P($G(^PRC(442,REC,0)),"^",16) S:AMT="" AMT=0
"RTN","PRCSFMS1",50,0)
 ..S:$P($G(^PRC(442,REC,7)),"^",2)=45 AMT=0
"RTN","PRCSFMS1",51,0)
 ..I $P($G(^PRC(442,REC,0)),"^",2)=25,$P($G(^PRC(442,REC,7)),"^",2)=22 S AMT=0
"RTN","PRCSFMS1",52,0)
 ..S PRCSAPP=PRCSAPP-AMT,FIRST=FIRST-AMT,FINAL=FINAL-AMT,TOTAL=TOTAL+AMT
"RTN","PRCSFMS1",53,0)
 ..D:P1=0 HDR2
"RTN","PRCSFMS1",54,0)
 ..W !,$P(^PRC(442,REC,0),"^")
"RTN","PRCSFMS1",55,0)
 ..S Y=$P(^PRC(442,REC,1),"^",15) D DD^%DT W ?15,Y
"RTN","PRCSFMS1",56,0)
 ..W ?30,$J(AMT,0,2),?41,$J(PRCSAPP,0,2),?55,$J(FIRST,0,2),?69,$J(FINAL,0,2)
"RTN","PRCSFMS1",57,0)
 ..Q:Z1=U  I IOSL-$Y<8 D HOLD2 Q:Z1=U
"RTN","PRCSFMS1",58,0)
 .. QUIT
"RTN","PRCSFMS1",59,0)
 . QUIT
"RTN","PRCSFMS1",60,0)
 S PRCS("C")=FIRST,PRCS("O")=FINAL,PRCS("PRE")=PRCSAPP
"RTN","PRCSFMS1",61,0)
 I TOTAL<0 S MINUS="-",TOTAL=-TOTAL
"RTN","PRCSFMS1",62,0)
 I Z1'=U W !!,"PO transaction (no 2237) total for this quarter: ",MINUS,"$",$J(TOTAL,0,2)
"RTN","PRCSFMS1",63,0)
 S L="",$P(L,"=",IOM)="=" W !,L S L="" QUIT
"RTN","PRCSFMS1",64,0)
HOLD2 ;
"RTN","PRCSFMS1",65,0)
 Q:$D(C1)
"RTN","PRCSFMS1",66,0)
 G HDR2:$D(ZTQUEUED),HDR2:IO'=IO(0) W !,"Press return to continue, uparrow (^) to exit: " R Z1:DTIME S:'$T Z1=U D:Z1'=U HDR2 Q
"RTN","PRCSFMS1",67,0)
HDR2 ;
"RTN","PRCSFMS1",68,0)
 S P1=1
"RTN","PRCSFMS1",69,0)
 S P=P+1 W @IOF W "QUARTERLY REPORT "_Z(0)_" "_$E($P(PRC("CP")," ",2),1,10),?50,RDATE1,?73,"PAGE ",P
"RTN","PRCSFMS1",70,0)
 W !,?5,"__________PO TRANSACTIONS WITHOUT 2237______________",!
"RTN","PRCSFMS1",71,0)
 W !,"PO/",?15,"PO ",?30,"OBLIGATED",?41,"CONTROL PT.",?55,"UNCOMMITTED",?69,"UNOBLIGATED",!,"OBL#",?15,"DATE",?30,"AMOUNT",?42,"REQ TOT",?55,"BALANCE",?69,"BALANCE"
"RTN","PRCSFMS1",72,0)
 S L="",$P(L,"=",IOM)="=" W !,L S L="" Q
"RTN","PRCSP1A")
0^2^B47712305^B46555519
"RTN","PRCSP1A",1,0)
PRCSP1A ;WISC/SAW/BGJ-CONTROL POINT ACTIVITY PRINT OPTIONS CON'T ;5/1/92  9:20 AM [2/18/99 9:02am]
"RTN","PRCSP1A",2,0)
V ;;5.1;IFCAP;**90**;Oct 20, 2000
"RTN","PRCSP1A",3,0)
 ;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","PRCSP1A",4,0)
CPB ;CP BAL
"RTN","PRCSP1A",5,0)
 N PRCSST
"RTN","PRCSP1A",6,0)
 S PRCSST=1 D EN1^PRCSUT G W2:'$D(PRC("SITE")),EXIT:Y<0 S PRCSZ=Z
"RTN","PRCSP1A",7,0)
CPB1 K C1 W !,"Summary Balances Report Only" S %=2 D YN^DICN G EXIT:%<0,CPB1:%=0 S:%=1 C1=1
"RTN","PRCSP1A",8,0)
 D DEV1 G EXIT:POP I $D(IO("Q")) S ZTRTN="QUE^PRCSP1A",ZTDESC="RUNNING BALANCE REPORT",ZTSAVE("PRC*")="" S:$D(C1) ZTSAVE("C1")="" D ^%ZTLOAD D ^%ZISC D W1 G EXIT:%'=1 W !! G CPB
"RTN","PRCSP1A",9,0)
 D QUE D ^%ZISC D W1 G EXIT:%'=1 K C1 W !! G CPB
"RTN","PRCSP1A",10,0)
QUE ;
"RTN","PRCSP1A",11,0)
 N PRCC,PRCD,PRCE
"RTN","PRCSP1A",12,0)
 N A,B
"RTN","PRCSP1A",13,0)
 S PRC("CP")=$P($G(^PRC(420,PRC("SITE"),1,+PRC("CP"),0)),"^",1)
"RTN","PRCSP1A",14,0)
 U IO S Z1="",P=0 D NOW^%DTC S Y=% D DD^%DT S TDATE=Y,PRCS("A")=1 I $D(^PRC(420,PRC("SITE"),1,+PRC("CP"),0)),$P(^(0),"^",11)="Y" S PRCS("A")=1
"RTN","PRCSP1A",15,0)
 S PRCC=$P($$QTRDATE^PRC0D(PRC("FY"),PRC("QTR")),"^",7)
"RTN","PRCSP1A",16,0)
 S PRCC=PRCC_"-"_PRC("SITE")_"-"_$P(PRC("CP")," ")_"-",PRCD=PRCC_"~"
"RTN","PRCSP1A",17,0)
 S (N,Z,Z(0))=PRCSZ,Z(0)=Z(0)_"-",(PRCS("O"),PRCS("C"))=0,N(1)="" D:'$D(C1) HDR D:$D(C1) HDR2
"RTN","PRCSP1A",18,0)
 I $G(C1)=1 W !,"STATION: ",PRC("SITE"),"   FUND CONTROL POINT: ",PRC("CP"),!,?5,"FISCAL YEAR: ",PRC("FY"),"   QTR: ",PRC("QTR")
"RTN","PRCSP1A",19,0)
 F  S PRCC=$O(^PRCS(410,"RB",PRCC)) QUIT:PRCC]PRCD!'PRCC  S N(1)=$O(^(PRCC,"")),J=" " QUIT:'N(1)  S:'PRCS("A") J=$S($D(^PRCS(410,N(1),7)):$P(^(7),"^",6),1:"") I J'=""!($P(^PRCS(410,N(1),0),"^",2)'="O"),$P(^(0),"^",2)]"" D TOT
"RTN","PRCSP1A",20,0)
 Q:Z1=U  D CRT:$E(IOST,1,2)="C-" QUIT:Z1=U  D ^PRCSFMS Q:Z1=U
"RTN","PRCSP1A",21,0)
 D:IOSL-$Y<8 HOLD Q:Z1=U
"RTN","PRCSP1A",22,0)
 W !!!,"Balance Summary",?20,$J("1st Quarter",15),$J("2nd Quarter",15),$J("3rd Quarter",15),$J("4th Quarter",15)
"RTN","PRCSP1A",23,0)
 S PRCC=$$FCPBAL^PRC0D(PRC("SITE"),PRC("CP"),PRC("FY"),2)
"RTN","PRCSP1A",24,0)
 S PRCD=$$FCPBAL^PRC0D(PRC("SITE"),PRC("CP"),PRC("FY"),1)
"RTN","PRCSP1A",25,0)
 W !!,"Actual CP Bal:",?20 F A=1:1:4 W $J($P(PRCC,"^",A),15,2)
"RTN","PRCSP1A",26,0)
 W !,"Actual Fiscal Bal:",?20 F A=1:1:4 W $J($P(PRCD,"^",A),15,2)
"RTN","PRCSP1A",27,0)
 W !,"Tot Commit, not Obl:",?20 F A=1:1:4 W $J($J($P(PRCD,"^",A),0,2)-$J($P(PRCC,"^",A),0,2),15,2)
"RTN","PRCSP1A",28,0)
 I $J(PRCS("C"),0,2)-$J($P(PRCC,"^",PRC("QTR")),0,2)!($J(PRCS("O"),0,2)-$J($P(PRCD,"^",PRC("QTR")),0,2)) W ! D EN^DDIOL("Report balances do not agree with actual balances. Please recalculate"),EN^DDIOL("your control point.")
"RTN","PRCSP1A",29,0)
 W !!,"SECTION 1 CODES  # - cancelled order   * - order not obligated or signed",!,?17,"@ - purchase card order for reconciliation",!,?17,"& - reconciled order with final charge - ready for approval",!,?17,"R - total reconciled charges"
"RTN","PRCSP1A",30,0)
 W !,"SECTION 2 CODES",!,?17,"@ - purchase card CC transaction is not reconciled",!
"RTN","PRCSP1A",31,0)
 W !,"The symbols '*','@', and '&' indicate incomplete items.",!,"Please take the necessary steps to clear these items."
"RTN","PRCSP1A",32,0)
 D EXIT D:$D(ZTSK) KILL^%ZTLOAD Q
"RTN","PRCSP1A",33,0)
TOT N PRCA,PRCB,PRCG,PRCF,PRCH,PRCJ,PRCK
"RTN","PRCSP1A",34,0)
 S T="" S:$D(^PRCS(410,N(1),4)) T=^(4) S X=^(0),Z=$P(X,"^",2),T(0)=$P(T,"^",5),T(1)=$J($P(T,"^",8),0,2),T(3)=$P(T,"^",14),T=$J($P(T,"^",3),0,2),PRCA=$G(^(4)),PRCB=$G(^(7)),PRCH="*^*"
"RTN","PRCSP1A",35,0)
 I $P($G(^PRCS(410,N(1),1)),"^",2)=9999999 S PRCH=""
"RTN","PRCSP1A",36,0)
 S PRCF=$G(^PRCS(410,N(1),0)),PRCG=$P(PRCF,"^",2),PRCK=$P(PRCF,"^"),PRCF=$P(PRCF,"^",4),PRCK=$P(PRCK,"-",2)_$P(PRCK,"-",3)_$P(PRCK,"-",5)
"RTN","PRCSP1A",37,0)
 I PRCG="A",PRCF=1 S:$P(PRCB,"^",6)]"" PRCS("C")=PRCS("C")-T(1),$P(PRCH,"^")="" S:$P(PRCA,"^",10)]"" PRCS("O")=PRCS("O")-T,$P(PRCH,"^",2)="" Q:$D(C1)  G WRT
"RTN","PRCSP1A",38,0)
 I PRCG="O" S:$P(PRCB,"^",6)]"" PRCS("C")=PRCS("C")-T(1),$P(PRCH,"^")="" S:$P(PRCA,"^",10)]"" PRCS("O")=PRCS("O")-T,$P(PRCH,"^",2)=""
"RTN","PRCSP1A",39,0)
 I PRCG="C" S PRCH="",PRCS("C")=PRCS("C")+T(1),PRCS("O")=PRCS("O")+T
"RTN","PRCSP1A",40,0)
 I PRCG="A" S PRCH="",PRCS("C")=PRCS("C")-T(1) S:T(3)'="Y" PRCS("O")=PRCS("O")-T
"RTN","PRCSP1A",41,0)
 I PRCG="CA" S PRCH="#^#"
"RTN","PRCSP1A",42,0)
 S PRCJ=$P($G(^PRCS(410,N(1),4)),"^",5)
"RTN","PRCSP1A",43,0)
 I PRCH'["#",PRCJ'="" S PRCJ=$P(^PRCS(410,N(1),0),"-")_"-"_PRCJ,PRCJ=$O(^PRC(442,"B",PRCJ,0)) I +PRCJ'=0,$P($G(^PRC(442,PRCJ,0)),"^",2)=25 S X=$G(^(7)) D
"RTN","PRCSP1A",44,0)
 . S:PRCG'="A" PRCH="@" S:$P($G(X),"^",2)=40!($P($G(X),"^",2)=41) PRCH="^" S:$P($G(X),"^",2)=50!($P($G(X),"^",2)=51) PRCH="&"
"RTN","PRCSP1A",45,0)
 . S T=$P($$FP^PRCH0A(+PRCJ),U,2),$P(PRCH,"^",2)="R"
"RTN","PRCSP1A",46,0)
 . QUIT
"RTN","PRCSP1A",47,0)
 QUIT:$D(C1)
"RTN","PRCSP1A",48,0)
WRT Q:Z1=U  D:IOSL-$Y<8 HOLD Q:Z1=U  S X1=$S(Z="O":"OBLIGATION",Z="A":"ADJUSTMENT",Z="CA":"CANCELLED",1:"CEILING")
"RTN","PRCSP1A",49,0)
 I $P($G(^PRCS(410,N(1),0)),"^",4)=5 S X1="ISSUE BOOK"
"RTN","PRCSP1A",50,0)
 S PZIP=$P($P(X,"^"),"-",5),PZIP=$E(PZIP,1,4)
"RTN","PRCSP1A",51,0)
 W !,PRCK,?8,$E(X1,1,3),?12,T(0)
"RTN","PRCSP1A",52,0)
 S Y=$P($G(^PRCS(410,N(1),4)),"^",4) S:Y="" Y=$P($G(^PRCS(410,N(1),7)),"^",5) I Y'="" W ?26,$E(Y,4,5),"/",$E(Y,6,7),"/",$E(Y,2,3)
"RTN","PRCSP1A",53,0)
 W ?36,$J(T(1),10,2),$P(PRCH,"^")
"RTN","PRCSP1A",54,0)
 W ?47,$J(PRCS("C"),10,2) I T'="",T(3)'="Y" W ?58,$J(T,10,2),$P(PRCH,"^",2)
"RTN","PRCSP1A",55,0)
 W ?69,$J(PRCS("O"),10,2) Q
"RTN","PRCSP1A",56,0)
HDR S P=P+1 W @IOF,"CONTROL POINT BALANCE - ",Z(0)_" "_$P(PRC("CP")," ",2),?50,TDATE,?73,"PAGE ",P
"RTN","PRCSP1A",57,0)
 W !!,?69,"FISCAL"
"RTN","PRCSP1A",58,0)
 W !,"FYQSeq# TXN OBL #",?26,"AP/OB DT",?37,"COMM $AMT",?50,"CP $BAL",?60,"OBL $AMT",?69,"UNOBL $BAL"
"RTN","PRCSP1A",59,0)
 S L="",$P(L,"-",IOM)="-" W !,L S L="" Q
"RTN","PRCSP1A",60,0)
HDR2 S P=P+1 W @IOF,"CONTROL POINT BALANCE - ",Z(0)_" "_$P(PRC("CP")," ",2),?50,TDATE,?73,"PAGE ",P,! Q
"RTN","PRCSP1A",61,0)
HOLD G HDR:$E(IOST,1,2)'="C-"
"RTN","PRCSP1A",62,0)
CRT W !,"Press return to continue, uparrow (^) to exit: " R Z1:DTIME S:'$T Z1=U I ((Z1'=U)&&('$D(C1)))  D HDR
"RTN","PRCSP1A",63,0)
 Q
"RTN","PRCSP1A",64,0)
CTR ;CEILING TRANS
"RTN","PRCSP1A",65,0)
 D EN^PRCSUT G W2:'$D(PRC("SITE")),EXIT:Y<0 S PRCSAZ=PRC("SITE")_"-"_PRC("FY")_"-"_PRC("QTR")_"-"_$P(PRC("CP")," ")
"RTN","PRCSP1A",66,0)
 S FLDS="[PRCSCTR]",DHD="CEILING REPORT -  CP: "_PRC("CP"),BY="@.01,@1",FR=PRCSAZ_"-0001,C",TO=PRCSAZ_"-9999,C" D S
"RTN","PRCSP1A",67,0)
 N REPORT2 S REPORT2=1 D T2^PRCSAPP1 K PRC("CP"),PRCSAZ G CTR
"RTN","PRCSP1A",68,0)
ITEMH ;EP;Entry Point for Control Point ITEM HISTORY ; AAC/JDM 10-12-97 -  ADDED LINES 66-67 & 69-80 FOR E3R #3344
"RTN","PRCSP1A",69,0)
 ;EN3^PRCSUT Gets the SITE & Prompts for CONTROL POINT
"RTN","PRCSP1A",70,0)
 ;DODIP Runs EN1^DIP to list history to selected device
"RTN","PRCSP1A",71,0)
 D EN3^PRCSUT G W2:'$D(PRC("SITE")),EXIT:Y<0 S D0=+Y
"RTN","PRCSP1A",72,0)
 S CTL=$P(Y,U,2),(FR1,TO1)=CTL
"RTN","PRCSP1A",73,0)
 ;
"RTN","PRCSP1A",74,0)
 ; CHOOSE OLD WAY ( LAST 5 ) OR NEW WAY ( DATE RANGE )
"RTN","PRCSP1A",75,0)
 K DIR
"RTN","PRCSP1A",76,0)
 S DIR(0)="S^L:Last 5 Purchase Orders;D:Date Range"
"RTN","PRCSP1A",77,0)
 S DIR("A")="Select ITEM HISTORY Viewing Method"
"RTN","PRCSP1A",78,0)
 S DIR("B")="L"
"RTN","PRCSP1A",79,0)
 D ^DIR
"RTN","PRCSP1A",80,0)
 G:$D(DIRUT) EXIT
"RTN","PRCSP1A",81,0)
 W !
"RTN","PRCSP1A",82,0)
 G:Y="L" ITEMH1
"RTN","PRCSP1A",83,0)
 ;
"RTN","PRCSP1A",84,0)
 ; FALL THROUGH TO DATE RANGE DISPLAY
"RTN","PRCSP1A",85,0)
 ;
"RTN","PRCSP1A",86,0)
ITEMH0 ; VIEW HISTORY BY DATE RANGE
"RTN","PRCSP1A",87,0)
 ;
"RTN","PRCSP1A",88,0)
 S DIC="^PRC(441,",DIC(0)="AEMNQZ" D ^DIC G EXIT:Y<0
"RTN","PRCSP1A",89,0)
 S (FR2,TO2)=$P(Y,U,1)
"RTN","PRCSP1A",90,0)
 K DIR S DIR(0)="D",DIR("A")="DATE ORDERED (BEGIN RANGE) ",DIR("B")="T-30" D ^DIR G:$D(DIRUT) EXIT
"RTN","PRCSP1A",91,0)
 D ^%DT S FR3=Y
"RTN","PRCSP1A",92,0)
 K DIR S DIR(0)="D",DIR("A")="DATE ORDERED   (END RANGE) ",DIR("B")="T" D ^DIR G:$D(DIRUT) EXIT
"RTN","PRCSP1A",93,0)
 D ^%DT S TO3=Y
"RTN","PRCSP1A",94,0)
 D DODIP
"RTN","PRCSP1A",95,0)
 G ITEMH
"RTN","PRCSP1A",96,0)
 ;
"RTN","PRCSP1A",97,0)
ITEMH1 S DIC="^PRC(441,",DIC(0)="AEMNQZ" D ^DIC G EXIT:Y<0 S D0=+Y
"RTN","PRCSP1A",98,0)
 D DEV G EXIT:POP
"RTN","PRCSP1A",99,0)
 ;
"RTN","PRCSP1A",100,0)
ITEMH2 W @IOF S X=D0 D ITEM0^PRCSES1 I $D(ZTSK) D KILL^%ZTLOAD G EXIT
"RTN","PRCSP1A",101,0)
W3 D:$E(IOST,1,2)="C-" W W !!,"Would you like to look at another Item History" S %=2 D YN^DICN G W3:%=0,EXIT:%=2!(%<0) G ITEMH
"RTN","PRCSP1A",102,0)
S S L=0,DIC="^PRCS(410,"
"RTN","PRCSP1A",103,0)
 D EN1^DIP Q
"RTN","PRCSP1A",104,0)
 ;
"RTN","PRCSP1A",105,0)
DEV K IO("Q") S IOP="HOME" D ^%ZIS Q
"RTN","PRCSP1A",106,0)
 ;
"RTN","PRCSP1A",107,0)
DEV1 K IO("Q") S %ZIS("B")="HOME",%ZIS="MQ" D ^%ZIS Q
"RTN","PRCSP1A",108,0)
 ;
"RTN","PRCSP1A",109,0)
W1 K YY S YY(1)="Would you like to run another running balances report",YY(1,"F")="!!" D EN^DDIOL(.YY)
"RTN","PRCSP1A",110,0)
 S %=2 D YN^DICN G W1:%=0 Q
"RTN","PRCSP1A",111,0)
W2 K YY S YY(1)="You are not an authorized control point user.",YY(1,"F")="!!",YY(2)="Contact your control point official.",YY(2,"F")="!" D EN^DDIOL(.YY)
"RTN","PRCSP1A",112,0)
 K DIR S DIR(0)="E" D ^DIR G EXIT
"RTN","PRCSP1A",113,0)
W4 K YY S YY(1)="Enter information for another report or '^' to return to the menu.",YY(1,"F")="!!" D EN^DDIOL(.YY) Q
"RTN","PRCSP1A",114,0)
W I $E(IOST,1,2)="C-" K DIR S DIR(0)="E" D ^DIR
"RTN","PRCSP1A",115,0)
 I $E(IOST,1,2)'="C-" D ^%ZISC U IO
"RTN","PRCSP1A",116,0)
 ;
"RTN","PRCSP1A",117,0)
EXIT K PUR,TDATE,REPORT2,%,%IS,%DT,BY,C0,C2,C3,D,D0,DA,DHD,DIC,DIE,P
"RTN","PRCSP1A",118,0)
 K PRCSZ,PRCS,FLDS,FR,I,L,N,T,TO,X,X1,Y,Z,Z1,PZIP,ZTRTN,ZTSAVE Q
"RTN","PRCSP1A",119,0)
 K C,CTL,DIR,DTOUT,DUOUT,DIROUT,DIRUT,FR1,FR2,FR3,PRC,PRCSIP,TO1,TO2,TO3,AA,YY
"RTN","PRCSP1A",120,0)
 Q
"RTN","PRCSP1A",121,0)
WRITMD ;EP0; WRITES ITEM SHORT DESCRIPTION ON HISTORY HEADER
"RTN","PRCSP1A",122,0)
 W $P(^PRC(441,FR2,0),U,2)
"RTN","PRCSP1A",123,0)
 Q
"RTN","PRCSP1A",124,0)
WRITMN ;EP; WRITES ITEM NUMBER
"RTN","PRCSP1A",125,0)
 W $P(^PRC(441,FR2,0),U,1)
"RTN","PRCSP1A",126,0)
 Q
"RTN","PRCSP1A",127,0)
DODIP ; EP ;FOR RTNS CALLING FOR CP ITEM HIST
"RTN","PRCSP1A",128,0)
 ; AAC/JDM 11/12/97 - THIS SECTION ADDED FOR E3R #3344
"RTN","PRCSP1A",129,0)
 ; PRCSPGQ  is page variable
"RTN","PRCSP1A",130,0)
 ; PRCSDT   is Date/Time in DEC 11, 1998@8:35 format
"RTN","PRCSP1A",131,0)
 ;
"RTN","PRCSP1A",132,0)
 S PRCSPGQ=0
"RTN","PRCSP1A",133,0)
 D NOW^%DTC
"RTN","PRCSP1A",134,0)
 S Y=$J(%,7,4)
"RTN","PRCSP1A",135,0)
 D DD^%DT
"RTN","PRCSP1A",136,0)
 S PRCSDT=Y
"RTN","PRCSP1A",137,0)
 S FLDS="[PRCS CP ITEMHIST]",BY="[PRCS CP ITEMHIST]",L=0,DIC="^PRCS(410,"
"RTN","PRCSP1A",138,0)
 S FR=FR1_","_FR2_","_FR3
"RTN","PRCSP1A",139,0)
 S TO=TO1_","_TO2_","_TO3
"RTN","PRCSP1A",140,0)
 D EN1^DIP
"RTN","PRCSP1A",141,0)
 Q
"VER")
8.0^22.0
"BLD",4993,6)
^87
**END**
**END**
