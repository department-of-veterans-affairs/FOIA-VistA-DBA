Released LR*5.2*312 SEQ #240
Extracted from mail message
**KIDS**:LR*5.2*312^

**INSTALL NAME**
LR*5.2*312
"BLD",5069,0)
LR*5.2*312^LAB SERVICE^0^3040615^y
"BLD",5069,1,0)
^^1^1^3021212^^^^
"BLD",5069,1,1,0)
See patch description for details.
"BLD",5069,4,0)
^9.64PA^^
"BLD",5069,"ABNS",0)
^9.66A^^
"BLD",5069,"ABPKG")
n^y^G.LABTEST@ISC-SLC.VA.GOV
"BLD",5069,"KRN",0)
^9.67PA^8989.52^20
"BLD",5069,"KRN",.4,0)
.4
"BLD",5069,"KRN",.401,0)
.401
"BLD",5069,"KRN",.402,0)
.402
"BLD",5069,"KRN",.403,0)
.403
"BLD",5069,"KRN",.5,0)
.5
"BLD",5069,"KRN",.84,0)
.84
"BLD",5069,"KRN",3.6,0)
3.6
"BLD",5069,"KRN",3.8,0)
3.8
"BLD",5069,"KRN",9.2,0)
9.2
"BLD",5069,"KRN",9.8,0)
9.8
"BLD",5069,"KRN",9.8,"NM",0)
^9.68A^4^4
"BLD",5069,"KRN",9.8,"NM",1,0)
LR7OGMM^^0^B6478402
"BLD",5069,"KRN",9.8,"NM",2,0)
LR7OGM^^0^B28392947
"BLD",5069,"KRN",9.8,"NM",3,0)
LR7OGMC^^0^B8193182
"BLD",5069,"KRN",9.8,"NM",4,0)
LR7OGMU^^0^B2070393
"BLD",5069,"KRN",9.8,"NM","B","LR7OGM",2)

"BLD",5069,"KRN",9.8,"NM","B","LR7OGMC",3)

"BLD",5069,"KRN",9.8,"NM","B","LR7OGMM",1)

"BLD",5069,"KRN",9.8,"NM","B","LR7OGMU",4)

"BLD",5069,"KRN",19,0)
19
"BLD",5069,"KRN",19,"NM",0)
^9.68A^^
"BLD",5069,"KRN",19.1,0)
19.1
"BLD",5069,"KRN",101,0)
101
"BLD",5069,"KRN",409.61,0)
409.61
"BLD",5069,"KRN",771,0)
771
"BLD",5069,"KRN",869.2,0)
869.2
"BLD",5069,"KRN",870,0)
870
"BLD",5069,"KRN",8989.51,0)
8989.51
"BLD",5069,"KRN",8989.52,0)
8989.52
"BLD",5069,"KRN",8994,0)
8994
"BLD",5069,"KRN","B",.4,.4)

"BLD",5069,"KRN","B",.401,.401)

"BLD",5069,"KRN","B",.402,.402)

"BLD",5069,"KRN","B",.403,.403)

"BLD",5069,"KRN","B",.5,.5)

"BLD",5069,"KRN","B",.84,.84)

"BLD",5069,"KRN","B",3.6,3.6)

"BLD",5069,"KRN","B",3.8,3.8)

"BLD",5069,"KRN","B",9.2,9.2)

"BLD",5069,"KRN","B",9.8,9.8)

"BLD",5069,"KRN","B",19,19)

"BLD",5069,"KRN","B",19.1,19.1)

"BLD",5069,"KRN","B",101,101)

"BLD",5069,"KRN","B",409.61,409.61)

"BLD",5069,"KRN","B",771,771)

"BLD",5069,"KRN","B",869.2,869.2)

"BLD",5069,"KRN","B",870,870)

"BLD",5069,"KRN","B",8989.51,8989.51)

"BLD",5069,"KRN","B",8989.52,8989.52)

"BLD",5069,"KRN","B",8994,8994)

"BLD",5069,"PRE")

"BLD",5069,"QUES",0)
^9.62^^
"BLD",5069,"REQB",0)
^9.611^3^3
"BLD",5069,"REQB",1,0)
LR*5.2*187^2
"BLD",5069,"REQB",2,0)
LR*5.2*220^2
"BLD",5069,"REQB",3,0)
LR*5.2*230^2
"BLD",5069,"REQB","B","LR*5.2*187",1)

"BLD",5069,"REQB","B","LR*5.2*220",2)

"BLD",5069,"REQB","B","LR*5.2*230",3)

"MBREQ")
0
"PKG",26,-1)
1^1
"PKG",26,0)
LAB SERVICE^LR^CORE LAB SYSTEM
"PKG",26,20,0)
^9.402P^1^1
"PKG",26,20,1,0)
2^^LRXDRPT
"PKG",26,20,1,1)

"PKG",26,20,"B",2,1)

"PKG",26,22,0)
^9.49I^1^1
"PKG",26,22,1,0)
5.2^2940927^2950118
"PKG",26,22,1,"PAH",1,0)
312^3040615
"PKG",26,22,1,"PAH",1,1,0)
^^1^1^3040615
"PKG",26,22,1,"PAH",1,1,1,0)
See patch description for details.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
4
"RTN","LR7OGM")
0^2^B28392947
"RTN","LR7OGM",1,0)
LR7OGM ;SLC/STAFF- Interim report rpc memo ;10/15/98  22:21
"RTN","LR7OGM",2,0)
 ;;5.2;LAB SERVICE;**187,220,312**;Sep 27, 1994
"RTN","LR7OGM",3,0)
 ;
"RTN","LR7OGM",4,0)
TEST ; test use only
"RTN","LR7OGM",5,0)
 N TESTS,I K TESTS,^TMP("LR7OGX",$J)
"RTN","LR7OGM",6,0)
 ;S TESTS(548)=548
"RTN","LR7OGM",7,0)
 ;F I=1:1:10 I $D(^LAB(60,I,0)) S TESTS(I)=I
"RTN","LR7OGM",8,0)
 D SELECT(2,2970202,2920202,.TESTS,0,-1)
"RTN","LR7OGM",9,0)
 S I=0 F  S I=$O(^TMP("LR7OGX",$J,"OUTPUT",I)) Q:I<1  W !,^(I)
"RTN","LR7OGM",10,0)
 K ^TMP("LR7OGX",$J)
"RTN","LR7OGM",11,0)
 Q
"RTN","LR7OGM",12,0)
 ;
"RTN","LR7OGM",13,0)
INTERIM(ROOT,DFN,SDATE,EDATE) ; from ORWLRR
"RTN","LR7OGM",14,0)
 N FORMAT,MICROCHK,TESTS K TESTS
"RTN","LR7OGM",15,0)
 S (FORMAT,MICROCHK)=""
"RTN","LR7OGM",16,0)
 S ROOT=$NA(^TMP("LR7OGX",$J,"OUTPUT"))
"RTN","LR7OGM",17,0)
 D SELECT(DFN,SDATE,EDATE,.TESTS,FORMAT,MICROCHK) ;
"RTN","LR7OGM",18,0)
 Q
"RTN","LR7OGM",19,0)
 ;
"RTN","LR7OGM",20,0)
INTERIMG(ROOT,DFN,SDATE,DIR,FORMAT) ; from ORWLRR
"RTN","LR7OGM",21,0)
 N MICROCHK,TESTS K TESTS
"RTN","LR7OGM",22,0)
 S MICROCHK=1,FORMAT=$G(FORMAT,1)
"RTN","LR7OGM",23,0)
 S ROOT=$NA(^TMP("LR7OGX",$J,"OUTPUT"))
"RTN","LR7OGM",24,0)
 D SELECT(DFN,SDATE,DIR,.TESTS,FORMAT,MICROCHK) ;
"RTN","LR7OGM",25,0)
 Q
"RTN","LR7OGM",26,0)
 ;
"RTN","LR7OGM",27,0)
INTERIMS(ROOT,DFN,SDATE,EDATE,TESTLIST) ; from ORWLRR
"RTN","LR7OGM",28,0)
 N FORMAT,MICROCHK,NUM,TESTS K TESTS
"RTN","LR7OGM",29,0)
 S (FORMAT,MICROCHK)=""
"RTN","LR7OGM",30,0)
 S NUM=0 F  S NUM=$O(TESTLIST(NUM)) Q:NUM<1  S TESTS(+TESTLIST(NUM))=""
"RTN","LR7OGM",31,0)
 S ROOT=$NA(^TMP("LR7OGX",$J,"OUTPUT"))
"RTN","LR7OGM",32,0)
 D SELECT(DFN,SDATE,EDATE,.TESTS,FORMAT,MICROCHK) ;
"RTN","LR7OGM",33,0)
 Q
"RTN","LR7OGM",34,0)
 ;
"RTN","LR7OGM",35,0)
MICRO(ROOT,DFN,SDATE,EDATE) ; from ORWLRR
"RTN","LR7OGM",36,0)
 N FORMAT,MICROCHK,TESTS K TESTS
"RTN","LR7OGM",37,0)
 S FORMAT="",MICROCHK=-1
"RTN","LR7OGM",38,0)
 S ROOT=$NA(^TMP("LR7OGX",$J,"OUTPUT"))
"RTN","LR7OGM",39,0)
 D SELECT(DFN,SDATE,EDATE,.TESTS,FORMAT,MICROCHK) ;
"RTN","LR7OGM",40,0)
 Q
"RTN","LR7OGM",41,0)
 ;
"RTN","LR7OGM",42,0)
SELECT(DFN,SDATE,EDATE,TESTS,FORMAT,MICROCHK) ;
"RTN","LR7OGM",43,0)
 ; get patient info, and expand tests
"RTN","LR7OGM",44,0)
 ; route setup chem and/or micro data
"RTN","LR7OGM",45,0)
 ; 9th piece of output indicates format (2: CH of CH/MI exact date/time, 3: MI of CH/MI, else 1 or "")
"RTN","LR7OGM",46,0)
 N AGE,ALL,ASK,AVAIL,CNIDT,DIRECT,DONE,EDT,FOK,I,IDT,LRDFN,MICROSUB,MNIDT,OUTCNT,PNM,ROUTE,SEX,SDT K MICROSUB
"RTN","LR7OGM",47,0)
 K ^TMP("LR7OG",$J),^TMP("LR7OGX",$J,"OUTPUT")
"RTN","LR7OGM",48,0)
 S OUTCNT=1,DONE=0
"RTN","LR7OGM",49,0)
 D DEMO^LR7OGU(DFN,.LRDFN,.PNM,.AGE,.SEX)
"RTN","LR7OGM",50,0)
 I '$G(LRDFN) Q
"RTN","LR7OGM",51,0)
 S ^TMP("LR7OG",$J,"G")=DFN_U_PNM_U_LRDFN_U_AGE_U_SEX_"^8"
"RTN","LR7OGM",52,0)
 S ALL=$S($O(TESTS(0)):0,1:1)
"RTN","LR7OGM",53,0)
 I 'ALL D TESTSGET^LR7OGU(.TESTS,.MICROSUB)
"RTN","LR7OGM",54,0)
 S DIRECT=1
"RTN","LR7OGM",55,0)
 I FORMAT S DIRECT=EDATE,EDATE=2700101
"RTN","LR7OGM",56,0)
 S EDATE=EDATE\1
"RTN","LR7OGM",57,0)
 S (IDT,SDT)=9999999-SDATE,EDT=9999999-EDATE
"RTN","LR7OGM",58,0)
 I FORMAT>1 S FOK=0 D  I FOK Q
"RTN","LR7OGM",59,0)
 . I DIRECT=1 D  Q
"RTN","LR7OGM",60,0)
 .. I FORMAT=2 D  Q
"RTN","LR7OGM",61,0)
 ... D MI^LR7OGMM(LRDFN,IDT,.MICROSUB,ALL,.OUTCNT,FORMAT,.DONE)
"RTN","LR7OGM",62,0)
 ... S $P(^TMP("LR7OGX",$J,"OUTPUT",1),U,9)=3
"RTN","LR7OGM",63,0)
 ... S FOK=1
"RTN","LR7OGM",64,0)
 .. I FORMAT=3 D  Q
"RTN","LR7OGM",65,0)
 ... S $P(^TMP("LR7OGX",$J,"OUTPUT",1),U,9)=1
"RTN","LR7OGM",66,0)
 . I DIRECT=-1 D  Q
"RTN","LR7OGM",67,0)
 .. I FORMAT=2 D  Q
"RTN","LR7OGM",68,0)
 ... S $P(^TMP("LR7OGX",$J,"OUTPUT",1),U,9)=1
"RTN","LR7OGM",69,0)
 .. I FORMAT=3 D  Q
"RTN","LR7OGM",70,0)
 ... D CH^LR7OGMC(LRDFN,IDT,ALL,.OUTCNT,FORMAT,.DONE)
"RTN","LR7OGM",71,0)
 ... S $P(^TMP("LR7OGX",$J,"OUTPUT",1),U,9)=2
"RTN","LR7OGM",72,0)
 ... S FOK=1
"RTN","LR7OGM",73,0)
 I ALL S ASK="BOTH"
"RTN","LR7OGM",74,0)
 E  I $O(MICROSUB(0)) D
"RTN","LR7OGM",75,0)
 . S ASK="MI" I $O(^TMP("LR7OG",$J,"TMP",0)) S ASK="BOTH"
"RTN","LR7OGM",76,0)
 E  S ASK="CH"
"RTN","LR7OGM",77,0)
 S I=IDT,CNIDT=0 F  S I=$O(^LR(LRDFN,"CH",I),DIRECT) Q:'I  I $P($G(^(I,0)),"^",3) S CNIDT=I Q
"RTN","LR7OGM",78,0)
 S I=IDT,MNIDT=0 F  S I=$O(^LR(LRDFN,"MI",I),DIRECT) Q:'I  S MNIDT=I Q
"RTN","LR7OGM",79,0)
 S AVAIL="NONE"
"RTN","LR7OGM",80,0)
 I CNIDT,CNIDT'>EDT D
"RTN","LR7OGM",81,0)
 . S AVAIL="CH" I MNIDT,MNIDT'>EDT S AVAIL="BOTH"
"RTN","LR7OGM",82,0)
 E  I MNIDT,MNIDT'>EDT S AVAIL="MI"
"RTN","LR7OGM",83,0)
 I DIRECT=-1 S AVAIL="BOTH"
"RTN","LR7OGM",84,0)
 S ROUTE="NONE"
"RTN","LR7OGM",85,0)
 I ASK="BOTH" S ROUTE=AVAIL
"RTN","LR7OGM",86,0)
 I ASK="CH",AVAIL="CH"!(AVAIL="BOTH") S ROUTE="CH"
"RTN","LR7OGM",87,0)
 I ASK="MI",AVAIL="MI"!(AVAIL="BOTH") S ROUTE="MI"
"RTN","LR7OGM",88,0)
 I MICROCHK=-1 S ROUTE="MI"
"RTN","LR7OGM",89,0)
 I ROUTE="NONE" D  Q
"RTN","LR7OGM",90,0)
 . K ^TMP("LR7OG",$J)
"RTN","LR7OGM",91,0)
 I ROUTE="CH" D  Q
"RTN","LR7OGM",92,0)
 . F  S IDT=$O(^LR(LRDFN,"CH",IDT),DIRECT) Q:IDT<1  Q:IDT>EDT  D CH^LR7OGMC(LRDFN,IDT,ALL,.OUTCNT,FORMAT,.DONE) Q:DONE
"RTN","LR7OGM",93,0)
 . K ^TMP("LR7OG",$J)
"RTN","LR7OGM",94,0)
 I ROUTE="MI" D  Q
"RTN","LR7OGM",95,0)
 . F  S IDT=$O(^LR(LRDFN,"MI",IDT),DIRECT) Q:IDT<1  Q:IDT>EDT  D MI^LR7OGMM(LRDFN,IDT,.MICROSUB,ALL,.OUTCNT,FORMAT,.DONE) Q:DONE
"RTN","LR7OGM",96,0)
 . K ^TMP("LR7OG",$J)
"RTN","LR7OGM",97,0)
 F  D  Q:DONE
"RTN","LR7OGM",98,0)
 . S I=IDT,CNIDT=0 F  S I=$O(^LR(LRDFN,"CH",I),DIRECT) Q:'I  I $P($G(^(I,0)),"^",3) S CNIDT=I Q
"RTN","LR7OGM",99,0)
 . S I=IDT,MNIDT=0 F  S I=$O(^LR(LRDFN,"MI",I),DIRECT) Q:'I  S MNIDT=I Q
"RTN","LR7OGM",100,0)
 . I 'CNIDT,'MNIDT S DONE=1 Q
"RTN","LR7OGM",101,0)
 . D  I IDT>EDT S DONE=1 Q
"RTN","LR7OGM",102,0)
 .. I CNIDT=MNIDT D  Q  ; both chem and micro at this date/time
"RTN","LR7OGM",103,0)
 ... S IDT=CNIDT
"RTN","LR7OGM",104,0)
 ... I IDT'>EDT D
"RTN","LR7OGM",105,0)
 .... I FORMAT D  Q
"RTN","LR7OGM",106,0)
 ..... I SDT=(9999999-2700101)!(DIRECT=-1) D  Q
"RTN","LR7OGM",107,0)
 ...... D MI^LR7OGMM(LRDFN,IDT,.MICROSUB,ALL,.OUTCNT,FORMAT,.DONE)
"RTN","LR7OGM",108,0)
 ...... S $P(^TMP("LR7OGX",$J,"OUTPUT",1),U,9)=3
"RTN","LR7OGM",109,0)
 ..... D CH^LR7OGMC(LRDFN,IDT,ALL,.OUTCNT,FORMAT,.DONE)
"RTN","LR7OGM",110,0)
 ..... S $P(^TMP("LR7OGX",$J,"OUTPUT",1),U,9)=2
"RTN","LR7OGM",111,0)
 .... I MICROCHK'=1 D  Q:DONE
"RTN","LR7OGM",112,0)
 ..... D CH^LR7OGMC(LRDFN,IDT,ALL,.OUTCNT,FORMAT,.DONE)
"RTN","LR7OGM",113,0)
 ..... I FORMAT S MICROCHK=1
"RTN","LR7OGM",114,0)
 .... D MI^LR7OGMM(LRDFN,IDT,.MICROSUB,ALL,.OUTCNT,FORMAT,.DONE)
"RTN","LR7OGM",115,0)
 .. I 'MNIDT D  Q  ; no micro since this date/time, only chem at this date/time
"RTN","LR7OGM",116,0)
 ... S IDT=CNIDT
"RTN","LR7OGM",117,0)
 ... I IDT'>EDT D CH^LR7OGMC(LRDFN,IDT,ALL,.OUTCNT,FORMAT,.DONE)
"RTN","LR7OGM",118,0)
 .. I 'CNIDT D  Q  ; no chem since this date/time, only micro at this date/time
"RTN","LR7OGM",119,0)
 ... S IDT=MNIDT
"RTN","LR7OGM",120,0)
 ... I IDT'>EDT D MI^LR7OGMM(LRDFN,IDT,.MICROSUB,ALL,.OUTCNT,FORMAT,.DONE)
"RTN","LR7OGM",121,0)
 .. I (DIRECT=1&(CNIDT<MNIDT))!(DIRECT=-1&(CNIDT>MNIDT)) D  Q  ;chem and micro data, chem is more recent
"RTN","LR7OGM",122,0)
 ... S IDT=CNIDT
"RTN","LR7OGM",123,0)
 ... I IDT'>EDT D CH^LR7OGMC(LRDFN,IDT,ALL,.OUTCNT,FORMAT,.DONE)
"RTN","LR7OGM",124,0)
 .. S IDT=MNIDT
"RTN","LR7OGM",125,0)
 .. I IDT'>EDT D MI^LR7OGMM(LRDFN,IDT,.MICROSUB,ALL,.OUTCNT,FORMAT,.DONE)
"RTN","LR7OGM",126,0)
 K ^TMP("LR7OG",$J)
"RTN","LR7OGM",127,0)
 Q
"RTN","LR7OGMC")
0^3^B8193182
"RTN","LR7OGMC",1,0)
LR7OGMC ;SLC/STAFF- Interim report rpc memo chem ;5/20/97  19:03
"RTN","LR7OGMC",2,0)
 ;;5.2;LAB SERVICE;**187,230,312**;Sep 27, 1994
"RTN","LR7OGMC",3,0)
 ;
"RTN","LR7OGMC",4,0)
 ; sets lab data into ^TMP("LR7OG",$J,"TP"
"RTN","LR7OGMC",5,0)
 ; ^TMP("LR7OG",$J,"G")=dfn^pnm^lrdfn^age^sex^lrcw
"RTN","LR7OGMC",6,0)
 ; ^TMP("LR7OG",$J,"TMP",test subscript in data)=zero node of test
"RTN","LR7OGMC",7,0)
 ; ^TMP("LR7OG",$J,"TP",collect date/time)=zero node from data
"RTN","LR7OGMC",8,0)
 ; ^TMP("LR7OG",$J,"TP",collect date/time,printorder)=test#^name^printname^^printcode^dataname^result^flag
"RTN","LR7OGMC",9,0)
 ; ^TMP("LR7OG",$J,"TP",collect date/time,printorder,#)=interpretation
"RTN","LR7OGMC",10,0)
 ; ^TMP("LR7OG",$J,"TP",collect date/time,"C",#)=comment
"RTN","LR7OGMC",11,0)
 ;
"RTN","LR7OGMC",12,0)
CH(LRDFN,IDT,ALL,OUTCNT,FORMAT,DONE) ; from LR7OGM
"RTN","LR7OGMC",13,0)
 N CDT,CHSUB,CMNT,INTP,LABSUB,PNODE,PORDER,SPEC,TCNT,TESTNUM,TESTSUB,ZERO
"RTN","LR7OGMC",14,0)
 S ZERO=$G(^LR(LRDFN,"CH",IDT,0))
"RTN","LR7OGMC",15,0)
 I '$P(ZERO,U,3) Q
"RTN","LR7OGMC",16,0)
 S CDT=+ZERO,LABSUB="CH",TCNT=0,SPEC=$P(ZERO,U,5)
"RTN","LR7OGMC",17,0)
 S CHSUB=1 F  S CHSUB=$O(^LR(LRDFN,"CH",IDT,CHSUB)) Q:CHSUB=""  I ALL!$D(^TMP("LR7OG",$J,"TMP",CHSUB)) D  Q
"RTN","LR7OGMC",18,0)
 . I FORMAT D
"RTN","LR7OGMC",19,0)
 .. S ^TMP("LR7OGX",$J,"OUTPUT",OUTCNT)="0^CH^"_(9999999-IDT)
"RTN","LR7OGMC",20,0)
 .. S OUTCNT=OUTCNT+1
"RTN","LR7OGMC",21,0)
 .. S DONE=1
"RTN","LR7OGMC",22,0)
 . K ^TMP("LR7OG",$J,"TP")
"RTN","LR7OGMC",23,0)
 . I ALL S TESTSUB=1 F  S TESTSUB=$O(^LR(LRDFN,"CH",IDT,TESTSUB)) Q:TESTSUB<1  S TESTNUM=$O(^LAB(60,"C","CH;"_TESTSUB_";1",0)) D CHSETUP
"RTN","LR7OGMC",24,0)
 . I 'ALL S TESTSUB=1 F  S TESTSUB=$O(^TMP("LR7OG",$J,"TMP",TESTSUB)) Q:TESTSUB<1  S TESTNUM=+^(TESTSUB) D CHSETUP
"RTN","LR7OGMC",25,0)
 . I TCNT D
"RTN","LR7OGMC",26,0)
 .. S ^TMP("LR7OG",$J,"TP",CDT)=ZERO
"RTN","LR7OGMC",27,0)
 .. S CMNT=0 F  S CMNT=+$O(^LR(LRDFN,LABSUB,IDT,1,CMNT)) Q:CMNT<1  S ^TMP("LR7OG",$J,"TP",CDT,"C",CMNT)=^(CMNT,0) S TCNT=TCNT+1
"RTN","LR7OGMC",28,0)
 . I FORMAT D GRID^LR7OGMG(.OUTCNT)
"RTN","LR7OGMC",29,0)
 . I 'FORMAT D PRINT^LR7OGMP(.OUTCNT)
"RTN","LR7OGMC",30,0)
 . K ^TMP("LR7OG",$J,"TP")
"RTN","LR7OGMC",31,0)
 Q
"RTN","LR7OGMC",32,0)
 ;
"RTN","LR7OGMC",33,0)
CHSETUP ; within scope of CH
"RTN","LR7OGMC",34,0)
 I 'TESTNUM Q
"RTN","LR7OGMC",35,0)
 Q:'$D(^LAB(60,TESTNUM,.1))  S PNODE=^(.1) I '("BO"[$P($G(^(0)),U,3)) Q
"RTN","LR7OGMC",36,0)
 Q:'$D(^LR(LRDFN,LABSUB,IDT,TESTSUB))  Q:'$L($P(^(TESTSUB),U))
"RTN","LR7OGMC",37,0)
 S PORDER=$P(PNODE,U,6),PORDER=$S(PORDER:PORDER,1:TESTSUB/1000000)
"RTN","LR7OGMC",38,0)
 F  Q:'$D(^TMP("LR7OG",$J,"TP",CDT,PORDER))  Q:TESTNUM=+^(PORDER)  S PORDER=PORDER+1
"RTN","LR7OGMC",39,0)
 I $D(^TMP("LR7OG",$J,"TP",CDT,PORDER)) Q
"RTN","LR7OGMC",40,0)
 S ^TMP("LR7OG",$J,"TP",CDT,PORDER)=TESTNUM_U_$P(^LAB(60,TESTNUM,0),U)_U_$P(PNODE,U)_U_$P(PNODE,U,2)_U_$P(PNODE,U,3)_U_$P(^(0),U,5)_U_$P(^LR(LRDFN,LABSUB,IDT,TESTSUB),U)_U_$P(^(TESTSUB),U,2)
"RTN","LR7OGMC",41,0)
 S TCNT=TCNT+1
"RTN","LR7OGMC",42,0)
 I $D(^LAB(60,TESTNUM,1,SPEC,1,0)) D
"RTN","LR7OGMC",43,0)
 . S INTP=0 F  S INTP=+$O(^LAB(60,TESTNUM,1,SPEC,1,INTP)) Q:INTP<1  S ^TMP("LR7OG",$J,"TP",CDT,PORDER,INTP)=^(INTP,0) S TCNT=TCNT+1
"RTN","LR7OGMC",44,0)
 Q
"RTN","LR7OGMM")
0^1^B6478402
"RTN","LR7OGMM",1,0)
LR7OGMM ;SLC/STAFF- Interim report rpc memo micro ;5/20/97  18:52
"RTN","LR7OGMM",2,0)
 ;;5.2;LAB SERVICE;**187,312**;Sep 27, 1994
"RTN","LR7OGMM",3,0)
 ;
"RTN","LR7OGMM",4,0)
MI(LRDFN,IDT,MICROSUB,ALL,OUTCNT,FORMAT,DONE) ; from LR7OGM
"RTN","LR7OGMM",5,0)
 N MISUB,OK
"RTN","LR7OGMM",6,0)
 I '$D(^LR(LRDFN,"MI",IDT)) Q
"RTN","LR7OGMM",7,0)
 S OK=ALL
"RTN","LR7OGMM",8,0)
 I 'OK S MISUB=0 F  S MISUB=+$O(MICROSUB(MISUB)) Q:MISUB<1  I $D(^LR(LRDFN,"MI",IDT,MISUB)) S OK=1 Q
"RTN","LR7OGMM",9,0)
 I 'OK Q
"RTN","LR7OGMM",10,0)
 I $G(FORMAT) D
"RTN","LR7OGMM",11,0)
 .S ^TMP("LR7OGX",$J,"OUTPUT",OUTCNT)="^MI^"_(9999999-IDT)
"RTN","LR7OGMM",12,0)
 .S OUTCNT=OUTCNT+1
"RTN","LR7OGMM",13,0)
 .S DONE=1
"RTN","LR7OGMM",14,0)
 D MIC(LRDFN,IDT,.OUTCNT)
"RTN","LR7OGMM",15,0)
 Q
"RTN","LR7OGMM",16,0)
 ;
"RTN","LR7OGMM",17,0)
MIC(LRDFN,LRIDT,OUTCNT) ;
"RTN","LR7OGMM",18,0)
 N AGE,GCNT,GIOM,LINE,LREND,LRONESPC,LRONETST,NUM,SEX
"RTN","LR7OGMM",19,0)
 S GCNT=0,GIOM=80,LREND=0,LRONESPC="",LRONETST=0
"RTN","LR7OGMM",20,0)
 S AGE=$P(^TMP("LR7OG",$J,"G"),U,5),SEX=$P(^("G"),U,6)
"RTN","LR7OGMM",21,0)
 ; new variables used by LR7OSMZ0
"RTN","LR7OGMM",22,0)
 N %,A,A8,AB,B,B1,B2,B3,C,CCNT,DIC,DZ,I,IA,II,INC,J,K,LR1PASS,LR2ORMOR,LRAA,LRABCNT,LRACC,LRACNT,LRAD,LRADM,LRADX,LRAFS,LRAMT,LRAN,LRAO,LRAX
"RTN","LR7OGMM",23,0)
 N LRBN,LRBRR,LRBUG,LRCMNT,LRCOMTAB,LRCS,LRDCOM,LRDOC,LRDRTM1,LRDRTM2,LREF,LRFLAG,LRFMT,LRGRM,LRIFN,LRINT,LRJ02,LRLABKY,LRLLT,LRMYC,LRNS,LRNUM
"RTN","LR7OGMM",24,0)
 N LRORG,LRPAR,LRPATLOC,LRPC,LRPG,LRPRE,LRPRINT,LRQU,LRRC,LRRES,LRSB,LRSBC1,LRSBC2,LRSET,LRSIC1,LRSIC2,LRSET,LRSIC1,LRSIC2,LRSPEC,LRSSD,LRST
"RTN","LR7OGMM",25,0)
 N LRTA,LRTB,LRTBA,LRTBC,LRTBS,LRTK,LRTS,LRTSTS,LRTUS,LRUS,LRWRD,LRWRDVEW,N,S1,SP,X,X1,Y,Y1
"RTN","LR7OGMM",26,0)
 K DIC,LR1PASS,LRBUG,LRDCOM,LRINT,LRRES,LRTS K ^TMP("LR",$J),^TMP("LRC",$J),^TMP("LRT",$J)
"RTN","LR7OGMM",27,0)
 D EN1^LR7OSMZ0
"RTN","LR7OGMM",28,0)
 I '$O(^TMP("LRC",$J,0)) Q
"RTN","LR7OGMM",29,0)
 S NUM=0 F  S NUM=$O(^TMP("LRC",$J,NUM)) Q:NUM<1  S LINE=^(NUM,0) D
"RTN","LR7OGMM",30,0)
 .S ^TMP("LR7OGX",$J,"OUTPUT",OUTCNT)=LINE,OUTCNT=OUTCNT+1
"RTN","LR7OGMM",31,0)
 S ^TMP("LR7OGX",$J,"OUTPUT",OUTCNT)="===============================================================================",OUTCNT=OUTCNT+1
"RTN","LR7OGMM",32,0)
 K ^TMP("LR",$J),^TMP("LRC",$J),^TMP("LRT",$J)
"RTN","LR7OGMM",33,0)
 Q
"RTN","LR7OGMU")
0^4^B2070393
"RTN","LR7OGMU",1,0)
LR7OGMU ;SLC/STAFF- Interim report rpc memo utility ;6/6/97  16:15
"RTN","LR7OGMU",2,0)
 ;;5.2;LAB SERVICE;**187,312**;Sep 27, 1994
"RTN","LR7OGMU",3,0)
 ;
"RTN","LR7OGMU",4,0)
NEWOLD(Y,DFN) ; from ORWLRR
"RTN","LR7OGMU",5,0)
 N LRDFN
"RTN","LR7OGMU",6,0)
 D DEMO^LR7OGU(DFN,.LRDFN)
"RTN","LR7OGMU",7,0)
 S Y=$$NEWEST(LRDFN)_U_$$OLDEST(LRDFN)
"RTN","LR7OGMU",8,0)
 Q
"RTN","LR7OGMU",9,0)
 ;
"RTN","LR7OGMU",10,0)
NEWEST(LRDFN) ;
"RTN","LR7OGMU",11,0)
 N IDT,FIRSTCH,FIRSTMI
"RTN","LR7OGMU",12,0)
 S (FIRSTCH,FIRSTMI)=""
"RTN","LR7OGMU",13,0)
 S IDT=0 F  S IDT=$O(^LR(LRDFN,"CH",IDT)) Q:IDT<1  I $P($G(^(IDT,0)),U,3) S FIRSTCH=9999999-IDT Q
"RTN","LR7OGMU",14,0)
 S IDT=0 F  S IDT=$O(^LR(LRDFN,"MI",IDT)) Q:IDT<1  S FIRSTMI=9999999-IDT Q
"RTN","LR7OGMU",15,0)
 I FIRSTCH>FIRSTMI Q FIRSTCH
"RTN","LR7OGMU",16,0)
 I FIRSTCH'>FIRSTMI Q FIRSTMI
"RTN","LR7OGMU",17,0)
 Q ""
"RTN","LR7OGMU",18,0)
 ;
"RTN","LR7OGMU",19,0)
OLDEST(LRDFN) ;
"RTN","LR7OGMU",20,0)
 N IDT,FIRSTCH,FIRSTMI
"RTN","LR7OGMU",21,0)
 S (FIRSTCH,FIRSTMI)=""
"RTN","LR7OGMU",22,0)
 S IDT="" F  S IDT=$O(^LR(LRDFN,"CH",IDT),-1) Q:IDT=""  I $P($G(^(IDT,0)),U,3) S FIRSTCH=9999999-IDT Q
"RTN","LR7OGMU",23,0)
 S IDT="" F  S IDT=$O(^LR(LRDFN,"MI",IDT),-1) Q:IDT=""  S FIRSTMI=9999999-IDT Q
"RTN","LR7OGMU",24,0)
 I FIRSTMI="" Q FIRSTCH
"RTN","LR7OGMU",25,0)
 I FIRSTCH="" Q FIRSTMI
"RTN","LR7OGMU",26,0)
 I FIRSTCH<FIRSTMI Q FIRSTCH
"RTN","LR7OGMU",27,0)
 I FIRSTCH'<FIRSTMI Q FIRSTMI
"RTN","LR7OGMU",28,0)
 Q ""
"VER")
8.0^22.0
**END**
**END**
