Released XM*7.1*39 SEQ #33
Extracted from mail message
**KIDS**:XM*7.1*39^

**INSTALL NAME**
XM*7.1*39
"BLD",21,0)
XM*7.1*39^MAILMAN^0^2961216^n
"BLD",21,1,0)
^^41^41^2961216^^^
"BLD",21,1,1,0)
 This MailMan patch will change how an 'ANSWER' message looks. The message
"BLD",21,1,2,0)
 will now show the users response, the users network signature, and then
"BLD",21,1,3,0)
 the original message. The orignal message with be preceded with a '>'.
"BLD",21,1,4,0)
 The user can now edit the entire message, including the original message,
"BLD",21,1,5,0)
 by using the 'Edit' option at the 'TRANSMIT option: ' prompt.
"BLD",21,1,6,0)

"BLD",21,1,7,0)
===========================================================================
"BLD",21,1,8,0)
 This patch should be installed after hours, when there is minimum users on
"BLD",21,1,9,0)
 the system.  You should put the XMUSER Option out of order.
"BLD",21,1,10,0)
===========================================================================
"BLD",21,1,11,0)
 
"BLD",21,1,12,0)
INSTALLATION:
"BLD",21,1,13,0)
  1.  These routines are usually mapped on systems that allow mapping,
"BLD",21,1,14,0)
      so you will need to disable mapping for the effected routines.
"BLD",21,1,15,0)
  2.  Use the 'INSTALL/CHECK MESSAGE' option on the PackMan menu. This
"BLD",21,1,16,0)
      option will load the KIDS package onto your system.
"BLD",21,1,17,0)
  3.  The patch has now been loaded into a Transport global on your
"BLD",21,1,18,0)
      system. You now need to use KIDS to install the Transport global.
"BLD",21,1,19,0)
  4.  On the KIDS menu, under the 'Installation' menu, use the following
"BLD",21,1,20,0)
      options:
"BLD",21,1,21,0)
        2 Verify Checksums in Transport Global
"BLD",21,1,22,0)
        3 Print Transport Global
"BLD",21,1,23,0)
        4 Compare Transport Global to Current System
"BLD",21,1,24,0)
        5 Backup a Transport Global
"BLD",21,1,25,0)
        6 Install Package(s)
"BLD",21,1,26,0)
  5.  MSM Sites - Answer YES to the question 'Want to MOVE routines to
"BLD",21,1,27,0)
      other CPUs?'. Enter the names of your Compute and Print server(s).
"BLD",21,1,28,0)
  6.  AXP Sites, after patch has installed, rebuild your map set.
"BLD",21,1,29,0)
===========================================================================
"BLD",21,1,30,0)
  
"BLD",21,1,31,0)
 ROUTINES:
"BLD",21,1,32,0)
   The second line of the routine now looks like:
"BLD",21,1,33,0)
       ;;7.1;MailMan;**[patch list]**;Jun 02, 1994
"BLD",21,1,34,0)
 
"BLD",21,1,35,0)
               Before          After
"BLD",21,1,36,0)
 Name          Checksum        Checksum        Patch List
"BLD",21,1,37,0)
 ----------------------------------------------------------
"BLD",21,1,38,0)
 XMA11B         3291121         3593034        39
"BLD",21,1,39,0)
 XMA2          10106075        10059315        5,6,10,15,39
"BLD",21,1,40,0)
===========================================================================
"BLD",21,1,41,0)

"BLD",21,4,0)
^9.64PA^^
"BLD",21,"KRN",0)
^9.67PA^19^14
"BLD",21,"KRN",.4,0)
.4
"BLD",21,"KRN",.401,0)
.401
"BLD",21,"KRN",.402,0)
.402
"BLD",21,"KRN",.403,0)
.403
"BLD",21,"KRN",.5,0)
.5
"BLD",21,"KRN",.84,0)
.84
"BLD",21,"KRN",3.6,0)
3.6
"BLD",21,"KRN",3.8,0)
3.8
"BLD",21,"KRN",9.2,0)
9.2
"BLD",21,"KRN",9.8,0)
9.8
"BLD",21,"KRN",9.8,"NM",0)
^9.68A^2^2
"BLD",21,"KRN",9.8,"NM",1,0)
XMA2^^0^B24945570
"BLD",21,"KRN",9.8,"NM",2,0)
XMA11B^^0^B5407716
"BLD",21,"KRN",9.8,"NM","B","XMA11B",2)

"BLD",21,"KRN",9.8,"NM","B","XMA2",1)

"BLD",21,"KRN",19,0)
19
"BLD",21,"KRN",19.1,0)
19.1
"BLD",21,"KRN",101,0)
101
"BLD",21,"KRN",409.61,0)
409.61
"BLD",21,"KRN","B",.4,.4)

"BLD",21,"KRN","B",.401,.401)

"BLD",21,"KRN","B",.402,.402)

"BLD",21,"KRN","B",.403,.403)

"BLD",21,"KRN","B",.5,.5)

"BLD",21,"KRN","B",.84,.84)

"BLD",21,"KRN","B",3.6,3.6)

"BLD",21,"KRN","B",3.8,3.8)

"BLD",21,"KRN","B",9.2,9.2)

"BLD",21,"KRN","B",9.8,9.8)

"BLD",21,"KRN","B",19,19)

"BLD",21,"KRN","B",19.1,19.1)

"BLD",21,"KRN","B",101,101)

"BLD",21,"KRN","B",409.61,409.61)

"PKG",8,-1)
1^1
"PKG",8,0)
MAILMAN^XM^Electronic Mail, both local and networked
"PKG",8,22,0)
^9.49I^1^1
"PKG",8,22,1,0)
7.1^2940602^2951128
"PKG",8,22,1,"PAH",1,0)
39^2961216
"PKG",8,22,1,"PAH",1,1,0)
^^41^41^2961216
"PKG",8,22,1,"PAH",1,1,1,0)
 This MailMan patch will change how an 'ANSWER' message looks. The message
"PKG",8,22,1,"PAH",1,1,2,0)
 will now show the users response, the users network signature, and then
"PKG",8,22,1,"PAH",1,1,3,0)
 the original message. The orignal message with be preceded with a '>'.
"PKG",8,22,1,"PAH",1,1,4,0)
 The user can now edit the entire message, including the original message,
"PKG",8,22,1,"PAH",1,1,5,0)
 by using the 'Edit' option at the 'TRANSMIT option: ' prompt.
"PKG",8,22,1,"PAH",1,1,6,0)

"PKG",8,22,1,"PAH",1,1,7,0)
===========================================================================
"PKG",8,22,1,"PAH",1,1,8,0)
 This patch should be installed after hours, when there is minimum users on
"PKG",8,22,1,"PAH",1,1,9,0)
 the system.  You should put the XMUSER Option out of order.
"PKG",8,22,1,"PAH",1,1,10,0)
===========================================================================
"PKG",8,22,1,"PAH",1,1,11,0)
 
"PKG",8,22,1,"PAH",1,1,12,0)
INSTALLATION:
"PKG",8,22,1,"PAH",1,1,13,0)
  1.  These routines are usually mapped on systems that allow mapping,
"PKG",8,22,1,"PAH",1,1,14,0)
      so you will need to disable mapping for the effected routines.
"PKG",8,22,1,"PAH",1,1,15,0)
  2.  Use the 'INSTALL/CHECK MESSAGE' option on the PackMan menu. This
"PKG",8,22,1,"PAH",1,1,16,0)
      option will load the KIDS package onto your system.
"PKG",8,22,1,"PAH",1,1,17,0)
  3.  The patch has now been loaded into a Transport global on your
"PKG",8,22,1,"PAH",1,1,18,0)
      system. You now need to use KIDS to install the Transport global.
"PKG",8,22,1,"PAH",1,1,19,0)
  4.  On the KIDS menu, under the 'Installation' menu, use the following
"PKG",8,22,1,"PAH",1,1,20,0)
      options:
"PKG",8,22,1,"PAH",1,1,21,0)
        2 Verify Checksums in Transport Global
"PKG",8,22,1,"PAH",1,1,22,0)
        3 Print Transport Global
"PKG",8,22,1,"PAH",1,1,23,0)
        4 Compare Transport Global to Current System
"PKG",8,22,1,"PAH",1,1,24,0)
        5 Backup a Transport Global
"PKG",8,22,1,"PAH",1,1,25,0)
        6 Install Package(s)
"PKG",8,22,1,"PAH",1,1,26,0)
  5.  MSM Sites - Answer YES to the question 'Want to MOVE routines to
"PKG",8,22,1,"PAH",1,1,27,0)
      other CPUs?'. Enter the names of your Compute and Print server(s).
"PKG",8,22,1,"PAH",1,1,28,0)
  6.  AXP Sites, after patch has installed, rebuild your map set.
"PKG",8,22,1,"PAH",1,1,29,0)
===========================================================================
"PKG",8,22,1,"PAH",1,1,30,0)
  
"PKG",8,22,1,"PAH",1,1,31,0)
 ROUTINES:
"PKG",8,22,1,"PAH",1,1,32,0)
   The second line of the routine now looks like:
"PKG",8,22,1,"PAH",1,1,33,0)
       ;;7.1;MailMan;**[patch list]**;Jun 02, 1994
"PKG",8,22,1,"PAH",1,1,34,0)
 
"PKG",8,22,1,"PAH",1,1,35,0)
               Before          After
"PKG",8,22,1,"PAH",1,1,36,0)
 Name          Checksum        Checksum        Patch List
"PKG",8,22,1,"PAH",1,1,37,0)
 ----------------------------------------------------------
"PKG",8,22,1,"PAH",1,1,38,0)
 XMA11B         3291121         3593034        39
"PKG",8,22,1,"PAH",1,1,39,0)
 XMA2          10106075        10059315        5,6,10,15,39
"PKG",8,22,1,"PAH",1,1,40,0)
===========================================================================
"PKG",8,22,1,"PAH",1,1,41,0)

"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
2
"RTN","XMA11B")
0^2^B5407716
"RTN","XMA11B",1,0)
XMA11B ;(WASH ISC)/CAP/XXX - Internet Style Answer ;12/16/96  14:02
"RTN","XMA11B",2,0)
 ;;7.1;MailMan;**39**;Jun 02, 1994
"RTN","XMA11B",3,0)
 ;Support for Internet Mail activities (Non-Linked Mail Systems)
"RTN","XMA11B",4,0)
 ;See fields 2.21 through 2.23 of Mail Box (3.7) file
"RTN","XMA11B",5,0)
 ;
"RTN","XMA11B",6,0)
 N I,X,XMLCNT
"RTN","XMA11B",7,0)
 ;find last line
"RTN","XMA11B",8,0)
 S I=0
"RTN","XMA11B",9,0)
 F  S I=$O(^XMB(3.9,XMZ,2,I)) Q:'I  S XMLCNT=I
"RTN","XMA11B",10,0)
 S I=XMLCNT
"RTN","XMA11B",11,0)
 ;Add 2 blank lines
"RTN","XMA11B",12,0)
 F XMLCNT=I+1,I+2 S ^XMB(3.9,XMZ,2,XMLCNT,0)=" "
"RTN","XMA11B",13,0)
 ;
"RTN","XMA11B",14,0)
 ;Copy in Network Signature fields (2.21 thru 2.23)
"RTN","XMA11B",15,0)
 S XMLCNT=XMLCNT+1,^XMB(3.9,XMZ,2,XMLCNT,0)="------------------------------------------------------------------------"
"RTN","XMA11B",16,0)
 S X=$G(^XMB(3.7,DUZ,"NS1"))
"RTN","XMA11B",17,0)
 I $G(XMA2R)'=99,X'?."^" F I=1:1:3 S XMLCNT=XMLCNT+1,^XMB(3.9,XMZ,2,XMLCNT,0)=$P(X,U,I)
"RTN","XMA11B",18,0)
 I $G(XMA2R)=99 S XMLCNT=XMLCNT+1,^XMB(3.9,XMZ,2,XMLCNT,0)="Automated Software Response API "_^XMB("NETNAME")_" !"
"RTN","XMA11B",19,0)
 S XMLCNT=XMLCNT+1,^XMB(3.9,XMZ,2,XMLCNT,0)="------------------------------------------------------------------------"
"RTN","XMA11B",20,0)
 S XMLCNT=XMLCNT+1,^XMB(3.9,XMZ,2,XMLCNT,0)=" "
"RTN","XMA11B",21,0)
 ;
"RTN","XMA11B",22,0)
 ;Copy Body of Original Message
"RTN","XMA11B",23,0)
 S I=^XMB(3.9,XMA11B,0),X=">Original Msg: '"_$P(I,U)_"' from "_$S($P(I,U,2)["@":$P(I,U,2),1:$P($G(^VA(200,+$P(I,U,2),0)),U))
"RTN","XMA11B",24,0)
 S XMLCNT=XMLCNT+1,^XMB(3.9,XMZ,2,XMLCNT,0)=X
"RTN","XMA11B",25,0)
 S XMLCNT=XMLCNT+1,^XMB(3.9,XMZ,2,XMLCNT,0)=">"
"RTN","XMA11B",26,0)
 S I=.999
"RTN","XMA11B",27,0)
 F  S I=$O(^XMB(3.9,XMA11B,2,I)) Q:I<1  S X=">"_^(I,0),XMLCNT=XMLCNT+1,^XMB(3.9,XMZ,2,XMLCNT,0)=X
"RTN","XMA11B",28,0)
 ;
"RTN","XMA11B",29,0)
 ;Set wp field zero node
"RTN","XMA11B",30,0)
 S ^XMB(3.9,XMZ,2,0)="^3.92A^"_XMLCNT_U_XMLCNT_U_DT
"RTN","XMA11B",31,0)
Q Q
"RTN","XMA11B",32,0)
 ;
"RTN","XMA11B",33,0)
MAX(%) ;Check Maximum Lines (1=Too large, 0=Okay)
"RTN","XMA11B",34,0)
 S %=$P($G(^XMB(1,1,.11)),U,3)
"RTN","XMA11B",35,0)
 I $P(^XMB(3.9,XMZ,2,0),U,3)'>$S(%:%,1:999) Q 0
"RTN","XMA11B",36,0)
 W *7,!!,"This message has too many lines to 'Answer' (Larger than site copy limit).",!,"Please use the Write option to Write a new message.",!!
"RTN","XMA11B",37,0)
 Q 1
"RTN","XMA2")
0^1^B24945570
"RTN","XMA2",1,0)
XMA2 ;(WASH ISC)/CAP/THM-MailMan SEND ;12/16/96  13:19
"RTN","XMA2",2,0)
 ;;7.1;MailMan;**5,6,10,15,39**;Jun 02, 1994
"RTN","XMA2",3,0)
SEND ;LOAD-XMLOAD=1
"RTN","XMA2",4,0)
 D INIT^XMA20 I $D(XMNOSEND) G TWO^XMA1E
"RTN","XMA2",5,0)
 D SEN:'ER G EXIT^XMA20
"RTN","XMA2",6,0)
 Q
"RTN","XMA2",7,0)
SEN ;
"RTN","XMA2",8,0)
SEN0 S:'$D(XMZ) XMZ="" K XMQ D SS
"RTN","XMA2",9,0)
 I $D(XMSUB),XMSUB[U K XMLOAD Q
"RTN","XMA2",10,0)
 S XMZO=XMZ,(X1,XMR)="" D CONF^XMA1 Q
"RTN","XMA2",11,0)
SS D SUBJ Q:XMSUB[U  S:'$D(XMZ1) XMZ1=0
"RTN","XMA2",12,0)
 S XMRL=0,XMR=XMSUB_U_XMDUZ D ENT
"RTN","XMA2",13,0)
 I $G(XMA2BLOB),$O(^XMB(3.9,XMZ,2,0)) D ENTM^XMA0A,ADD^XMA2B K XMA2BLOB I $D(XMOUT) K XMOUT G K
"RTN","XMA2",14,0)
 D DESTXM^XMA21 I $D(XMLOAD),X'["^" D ^XMASEC
"RTN","XMA2",15,0)
 K XMLOAD,XMFG I X[U G KX:'$D(DTOUT),H
"RTN","XMA2",16,0)
 ;XMA11B=answer message
"RTN","XMA2",17,0)
 I $D(XMA11B) D ^XMA11B
"RTN","XMA2",18,0)
 W ! D OK^XMA22 K XMKEY,XMKEYTRY I X[U D ENTD^XMA0A,KILL^XMA3 Q:'$D(DTOUT)  G H
"RTN","XMA2",19,0)
 D KX G K:'$O(^XMB(3.9,XMZ,2,.999))
"RTN","XMA2",20,0)
 W:'$D(ZTQUEUED) "  Delivering ["_XMZ_"]... " D ENT1^XMAD1 W:'$D(ZTQUEUED) !,"  Sent" Q
"RTN","XMA2",21,0)
KX D ENTD^XMA0A Q
"RTN","XMA2",22,0)
SQ S XMSUB=Y Q
"RTN","XMA2",23,0)
SUBJ D ENTS^XMA20,SQ,GET:Y'=U Q
"RTN","XMA2",24,0)
XMZ ;Create stub/return error
"RTN","XMA2",25,0)
 S XMRETURN=1 D GET K XMRETURN Q
"RTN","XMA2",26,0)
GET ;Create stub
"RTN","XMA2",27,0)
 D G2 Q:$S($D(XMZ)[0:1,XMZ<0:1,1:0)
"RTN","XMA2",28,0)
G1 D NOW^%DTC
"RTN","XMA2",29,0)
G11 N %1,Y,%0 I $G(XMDUZ)=.6 N XMDUZ S XMDUZ=DUZ,%1=.6
"RTN","XMA2",30,0)
 S %1=$S($D(%1):%1,$D(DUZ)#10:DUZ,1:""),Y=$S($D(XMDUZ):XMDUZ,%1:%1,1:.5),%0=$S($D(^XMB(3.9,XMZ,0)):^(0),1:"") I $L(Y)>100 S Y="Internet_see_header"
"RTN","XMA2",31,0)
 ;Info Only / sent by Postmaster
"RTN","XMA2",32,0)
 I Y=.5,$S($G(XMDUZ):XMDUZ,$G(DUZ):DUZ,1:0)'=.5 S $P(%0,U,12)="y"
"RTN","XMA2",33,0)
 I XMSUB[U S XMSUB=$$ENCODEUP^XMCU1(XMSUB)
"RTN","XMA2",34,0)
 S $P(%0,U,1,4)=XMSUB_U_Y_U_%_U_$S(Y'=%1&+Y:%1,1:""),^(0)=%0
"RTN","XMA2",35,0)
 S:$L(XMSUB) ^XMB(3.9,"B",$E(XMSUB,1,30),XMZ)="" Q
"RTN","XMA2",36,0)
G2 S X=0 N %,%0
"RTN","XMA2",37,0)
G L +^XMB(3.9,0):9 K XMZ S X=X+1 I '$T H 0 G G:X<999 W:'$D(ZTQUEUED) !,"  Please try again later.",! G IQ:$D(XMRETURN),ERR^XMA20
"RTN","XMA2",38,0)
 S %0=^XMB(3.9,0)
"RTN","XMA2",39,0)
I S %=$P(%0,U,3)+1,$P(%0,U,3)=%,$P(^XMB(3.9,0),U,3,4)=%_U_($P(%0,U,4)+1)
"RTN","XMA2",40,0)
 G I:$D(^XMB(3.9,%)) I X<999 S X=X+1 G I:$O(^(%))?1.N S ^(%,0)="",XMZ=% G GQ
"RTN","XMA2",41,0)
 I '$D(XMRETURN) S XMZ=% D RECV^XMA25 G ERR^XMA20
"RTN","XMA2",42,0)
IQ H 1 S XMZ=-1
"RTN","XMA2",43,0)
GQ L -^XMB(3.9,0) Q
"RTN","XMA2",44,0)
 ;
"RTN","XMA2",45,0)
ENT G:$D(XMLOAD) ^XMP
"RTN","XMA2",46,0)
 D ENTM^XMA0A
"RTN","XMA2",47,0)
ENT1 ;WPS Edit
"RTN","XMA2",48,0)
 ;
"RTN","XMA2",49,0)
 ;PackMan message ?
"RTN","XMA2",50,0)
 S %=$P($G(^XMB(3.9,XMZ,2,0)),U,3) I % S Y=$S($E($G(^(2,%,0)))="$":1,1:0) D CHECK^XMP2A:Y=0 I Y>0 D PHELP^XMP2A
"RTN","XMA2",51,0)
 ;
"RTN","XMA2",52,0)
 ;DWPK and DWLW control wrap and the length of the lines
"RTN","XMA2",53,0)
 ;
"RTN","XMA2",54,0)
 S DWPK=1,DWLW=75,(DIA,DIC)="^XMB(3.9,"_$S($D(XMRCVR)&$G(XMZ2):XMZ2,1:XMZ)_",2,",DIA("P")=3.9,$P(^XMB(3.9,XMZ,2,0),U,2)="3.92A"
"RTN","XMA2",55,0)
 W !,$S($D(XMCOPY):"You may edit",1:"Enter the")," text of the message"
"RTN","XMA2",56,0)
 I '$O(^XMB(3.7,"AD",DUZ,0)) D ENTR^XMA0A
"RTN","XMA2",57,0)
 D EN^DIWE K DC,DIWEPSE G H:$D(DTOUT) D KX:'$D(^XMB(3.9,XMZ,2))
"RTN","XMA2",58,0)
EC S XMCNT=0 S:$D(^XMB(3.9,XMZ,2,0)) XMCNT=$P(^(0),U,3) Q
"RTN","XMA2",59,0)
 Q
"RTN","XMA2",60,0)
H I $D(XMA2F),$G(DTOUT) S XMOUT=1 Q
"RTN","XMA2",61,0)
 K DTOUT G HALT^XMA20
"RTN","XMA2",62,0)
D2 S XMFF0=1 D DE2A^XMA21 K XMFF0,XMB Q:X[U
"RTN","XMA2",63,0)
 ;ENTRY TO FORWARD
"RTN","XMA2",64,0)
D2X D D S XMFF="" I XMDUZ'=$P(XMR,U,2) S XMFF=XMDUZ_U_XMDUZ
"RTN","XMA2",65,0)
 S $P(XMFF,U)=$P(XMFF,U)_" "_Y
"RTN","XMA2",66,0)
 I "Yy"'[$E($P(XMR,U,12)_" "),'$P(XMR,U,12) S %=$O(^XMB(3.9,XMZ,1,"C",XMDUZ,0)) I %,$D(^XMB(3.9,XMZ,1,%,"T")),^("T")="I" S %="" F Y=0:0 S %=$O(^TMP("XMY",$J,%)) Q:%=""  S ^TMP("XMY",$J,%,1)="I"
"RTN","XMA2",67,0)
 D ENT^XMAD1 K XMFF Q
"RTN","XMA2",68,0)
1 S %=%+1,%1=%1+1,X=$S(+X'=X:X,'$D(^VA(200,X,0)):X,1:$P(^(0),U)) W:'(%1-1#4) ! I $X>40,$L(X)>19 S %1=%1+1 W:'(%1-1#4) !
"RTN","XMA2",69,0)
 W ?(%1-1#4*20),X I $L(X)>19 S %1=%1+1 W:'(%1-1#4) !
"RTN","XMA2",70,0)
 Q
"RTN","XMA2",71,0)
ENTF S XMR=$G(^XMB(3.9,XMZ,0)) Q:XMR=""
"RTN","XMA2",72,0)
 K ^TMP("XMYT",$J)
"RTN","XMA2",73,0)
 S %X="^TMP(""XMY"","_$J_",",%Y="^TMP(""XMYT"","_$J_"," D %XY^%RCR
"RTN","XMA2",74,0)
 D D2X
"RTN","XMA2",75,0)
 S %Y="^TMP(""XMY"","_$J_",",%X="^TMP(""XMYT"","_$J_"," D %XY^%RCR
"RTN","XMA2",76,0)
 Q
"RTN","XMA2",77,0)
D25 ;Show RCPTs
"RTN","XMA2",78,0)
 S I=$S($D(^XMB(3.9,XMZ,1,0)):$P(^(0),U,3),1:0)
"RTN","XMA2",79,0)
 I I<2,$O(^XMB(3.9,XMZ,1,"C",0))=XMDUZ G D3
"RTN","XMA2",80,0)
 S %2=I_"^any" D 2 G D5:X["^",D3:I<1 S XMDIC="^XMB(3.9,"_XMZ_",6,""B""," I '$O(^XMB(3.9,XMZ,6,0)) S $P(XMDIC,",",3,4)="1,""C"""
"RTN","XMA2",81,0)
 W !,"This message has been delivered to ",$S(I>24:I_" ",1:""),"recipient",$S(I=1:"",1:"s"),"." S %2=I_"^more",I="",(J,%,%1)=0
"RTN","XMA2",82,0)
Q1 S I=$O(@(XMDIC_"I)")) I I="" S DIWEPSE=1 G Q2
"RTN","XMA2",83,0)
 S XMA2Q1=I I '(%#24)&%,I'<0 D 2 G D3:I=""
"RTN","XMA2",84,0)
 S (I,X)=XMA2Q1 D 1 G Q1
"RTN","XMA2",85,0)
Q2 K XMDIC
"RTN","XMA2",86,0)
D3 K XMA2Q1 S:'$D(XMRCVR) XMZ1=XMZ
"RTN","XMA2",87,0)
 I '$D(XMCOPY) D GET S:XMZ1'=XMZ $P(^XMB(3.9,XMZ,0),U,8)=XMZ1
"RTN","XMA2",88,0)
 D ENT1,W I $D(DTOUT) D ENTR^XMA0A G H
"RTN","XMA2",89,0)
 S:'$D(XMRCVR) XMZ2=XMZ S X="^",XMZ=XMZ1
"RTN","XMA2",90,0)
 I $D(XMZ2),'$O(^XMB(3.9,XMZ2,2,0)),'$D(ZTQUEUED) G D4
"RTN","XMA2",91,0)
 I $O(^XMB(3.9,XMZ2,2,0)) D ^XMA22 K XMKEY,XMKEYTRY
"RTN","XMA2",92,0)
 I X'[U!$D(DTOUT) K XMZ1 G CHK^XMA20:XMZ2-XMZ'=0,ENT^XMAD1
"RTN","XMA2",93,0)
D4 D KX S XMZ=XMZ2
"RTN","XMA2",94,0)
 D K:'$O(^XMB(3.9,XMZ,1,0)) S XMZ=XMZ1 K XMZ1
"RTN","XMA2",95,0)
D5 I '$G(XMCOPY) W !!,"  No Response Sent !",*7,!
"RTN","XMA2",96,0)
 Q
"RTN","XMA2",97,0)
 ;DIWEPSE effects screen editor
"RTN","XMA2",98,0)
W K DIWEPSE Q
"RTN","XMA2",99,0)
UTM Q:XMSUB'["~U~"  S XMSUB=$$DECODEUP^XMCU1(XMSUB) G UTM
"RTN","XMA2",100,0)
2 Q:I<0
"RTN","XMA2",101,0)
 W !,"Do you want to see ",$P(%2,U,2)," of the *",+%2,"* recipients listed?  NO// " R X:DTIME
"RTN","XMA2",102,0)
 I "Yy"'[$E(X_" ") S I="",J=1
"RTN","XMA2",103,0)
 S %1=0 Q
"RTN","XMA2",104,0)
K Q:$D(XMRCVR)  G KILL^XMA3
"RTN","XMA2",105,0)
D D NOW^%DTC S X=% K %
"RTN","XMA2",106,0)
 S Y=$E(X,6,7)_" "_$P("Jan^Feb^Mar^Apr^May^Jun^Jul^Aug^Sep^Oct^Nov^Dec",U,$E(X,4,5))_" "_$E(X,2,3) S:X\1'=X %=$P(X,".",2)_"0000",Y=Y_" "_$E(%,1,2)_":"_$E(%,3,4)
"RTN","XMA2",107,0)
 Q
"VER")
8.0^21.0
**END**
**END**
