$TXT Created by CASTLE,JOHN at DAYT17.FO-BAYPINES.MED.VA.GOV  (KIDS) on Tuesday, 02/28/06 at 16:10
=============================================================================
Run Date: MAR 13, 2006                     Designation: PSJ*5*164
Package : PSJ - INPATIENT MEDICATIONS         Priority: Mandatory
Version : 5       SEQ #146                      Status: Released
                  Compliance Date: APR 13, 2006
=============================================================================

Associated patches: (v)PSJ*5*150   <<= must be installed BEFORE `PSJ*5*164'

Subject: PSGEUD ERROR AND DISPENSE DRUG ISSUE

Category: 
  - Routine

Description:
============

 This patch addresses two issues contained in two Remedy tickets,
 HD118307 and HD108011.
  
 The first issue addressed by this patch is an undefined variable
 error when the user attempts to run the menu option [PSJU EUD].
 If the user selects a patient who has never been admitted, and then
 presses the carriage return at the Select Patient prompt, an
 undefined variable error occurs.
  
 The second issue addressed by this patch involves an incorrect display
 of the dispense drug units in backdoor pharmacy.  If the dispense
 drug units per dose are changed (editing field 12 backdoor), and one
 of the drugs' units dispensed becomes 0, backdoor pharmacy will still
 display a dispense unit of 1 for that drug.  BCMA and CPRS show the
 correct dispense drug units, and the correct units are stored in
 the ^PS(55) pharmacy patient file.  Therefore, this is strictly a 
 display problem.
  
  
 ASSOCIATED NOIS/REMEDY TICKETS:
 ==============================
 HD118307     -   PSJU EUD OPTION ERROR
  
 HD108011     -   UNITS/DOSE DON'T MATCH
  
  
 ASSOCIATED E3R:
 ==============
 N/A
  
  
 PARTICIPATING TEST SITES:
 ========================
 Loma Linda,CA
 Minneapolis,MN
 Oklahoma City,OK
 Palo Alto HCS
  
  
 NOIS/REMEDY OVERVIEW:
 ====================
 1)  HD118307 - PSJU EUD OPTION ERROR
  
 Problem:
 -------
 If a patient who has never been admitted is first selected at the
 Select Patient: prompt, then the user hits the carriage return,
 an undefined variable error occurs.
  
 Resolution:
 ----------
 Correct the undefined variable error so that if the carriage return
 is entered, the user will be taken out of the menu option.
  
  
 2)  HD108011 - UNITS/DOSE DON'T MATCH
  
 Problem:
 -------
 If the dispense drug units for an order has been edited and becomes 0
 in the edit, backdoor pharmacy will display a dispense drug unit of 1
 for that medication.
  
 Resolution:
 ----------
 Because this has been determined to be a display error, not a filing
 error, the display will be corrected to ensure the proper number of
 dispense drug units display for each dispense drug on the order.
  
  
 TECHNICAL DESCRIPTION:
 =====================
 1)  HD118307
  
 In GP+2^PSGEUD, when the code does a $O, it assumes that the package-wide
 variable PSJPAD is defined and has a value.  However, if the patient
 selected has never been admitted, PSJPAD will not be set.  The fix is to
 check $D(PSJPAD), and if it's 0, go to the DONE subroutine.
  
 2)  HD108011
  
 This fix requires an update to PSJLMUDE.  At INIT+52^PSJLMUDE, 
 there is a long $S that can evaluate to the wrong number for the
 dispense drug units.  To the outer $S, add the condition
 $P(ND,"^",2)=0:0.
  
  
 ROUTINE SUMMARY:
 ===============
  
   The following is a list of the routines included in this patch.
   The second line of each of the routines now looks like this:
  
      ;;5.0; INPATIENT MEDICATIONS ;**[PATCH LIST]**;16 DEC 97
  
  
 New Integrity Checking tools:  CHECK1^XTSUMBLD results
  
 Routine Name    Before Patch     After Patch            Patch List
 ============    ============     ===========            ==========
 PSGEUD          27607319           27762235       31,41,50,111,150,164
 PSJLMUDE        58744268           59012480       7,47,50,63,64,58,80,  
                                                   116,110,111,164 
                           CHECK^XTSUMBLD results
    
 Routine Name    Before Patch      After Patch           Patch List
 ============    ============      ===========           ===========
 PSGEUD          17731404          17875288        31,41,50,111,150,164
 PSJLMUDE        30288950          30502140        7,47,50,63,64,58,80,
                                                   116,110,111,164
  
 INSTALLATION INSTRUCTIONS:
 =========================
  
  
   ************************ NOTE ************************
   IF A USER IS ON THE SYSTEM AND USING THESE PROGRAMS 
   AN EDITED ERROR WILL OCCUR.  
   The patch should be installed when NO Inpatient Pharmacy 
   users are on the system.
   ******************************************************
  
  Installation will take less than 1 minute.
  
   1. Use the INSTALL/CHECK MESSAGE option on the PackMan menu.
   
   2. From the Kernel Installation & Distribution System menu, select
      the Installation menu.
   
   3. From this menu, you may select to use the following options
      (when prompted for INSTALL NAME, enter PSJ*5.0*164):
          a.  Verify Checksums in Transport Global - This option will allow
              you to ensure the integrity of the routines that are in the
              transport global.
          b.  Print Transport Global - This option will allow you to view
              the components of the KIDS build.
          c.  Compare Transport Global to Current System - This option will
              allow you to view all changes that will be made when this patch
              is installed.  It compares all components of this patch
              (routines, DD's, templates, etc.).
          d.  Backup a Transport Global - This option will create a backup
              message of any routines exported with this patch. It will not
              backup any other changes such as DD's or templates.
    
   4. Use the Install Package(s) option and select the package PSJ*5.0*164.
    
   5. When prompted "Want KIDS to INHIBIT LOGONs during the install? YES//"
      respond NO.
    
   6. When prompted "Want to DISABLE Scheduled Options, Menu Options, and
      Protocols? YES//" respond NO.

Routine Information:
====================
The checksums below are new checksums, and
 can be checked with CHECK1^XTSUMBLD.

Routine Name: PSGEUD
    Before: B27607319  After: B27762235  **31,41,50,111,150,164**
Routine Name: PSJLMUDE
    Before: B58744268  After: B59012480  **7,47,50,63,64,58,80,116,110,
                                          111,164**

=============================================================================
User Information:
Entered By  : CASTLE,JOHN                   Date Entered  : OCT 04, 2005
Completed By: ILUSTRISIMO,LUCY              Date Completed: MAR 08, 2006
Released By : LESIEUR,SHIRLEY               Date Released : MAR 13, 2006
=============================================================================


Packman Mail Message:
=====================

$END TXT
