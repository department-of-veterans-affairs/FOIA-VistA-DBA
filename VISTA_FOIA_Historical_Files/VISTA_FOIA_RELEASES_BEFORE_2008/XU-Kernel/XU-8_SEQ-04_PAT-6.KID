Verified XU*8*6 SEQ #4
Extracted from mail message
**KIDS**:XU*8.0*6^

**INSTALL NAME**
XU*8.0*6
"BLD",66,0)
XU*8.0*6^KERNEL^0^2950926^n
"BLD",66,1,0)
^^26^26^2950926^
"BLD",66,1,1,0)
XU*8.0*6
"BLD",66,1,2,0)
This patch fixes some problems found in the ALERT system after Kernel was
"BLD",66,1,3,0)
released.
"BLD",66,1,4,0)
========================================================================= 
"BLD",66,1,5,0)
INSTALLATION: 
"BLD",66,1,6,0)
 
"BLD",66,1,7,0)
 1. Use the 'INSTALL/CHECK MESSAGE' option on the PackMan menu. This 
"BLD",66,1,8,0)
    option will load the KIDS package in this message onto your system.  
"BLD",66,1,9,0)
 2. Answer NO to the question: 
"BLD",66,1,10,0)
    'Shall I preserve what is on disk in a separate back-up message ?' 
"BLD",66,1,11,0)
 3. The patch has now been loaded into a Transport global on your system.
"BLD",66,1,12,0)
 
"BLD",66,1,13,0)
    You now need to use KIDS to install the Transport global.  
"BLD",66,1,14,0)
 4. On the KIDS menu, under the 'Installation' menu, use the option 
"BLD",66,1,15,0)
    'Install Package(s)'.  
"BLD",66,1,16,0)
    Select the package 'XU*8.0*6' and proceed with install.  
"BLD",66,1,17,0)
 
"BLD",66,1,18,0)
This patch can be loaded any time that users are not likely to be in
"BLD",66,1,19,0)
the ALERT system.  i.e. It could be queued up to install eary in the
"BLD",66,1,20,0)
morning.  If a user is in the ALERT system they may get a CLOBER error.
"BLD",66,1,21,0)
========================================================================= 
"BLD",66,1,22,0)
 
"BLD",66,1,23,0)
 
"BLD",66,1,24,0)
XQALSET and XQALDEL now NEW DA so they don't cause problems with
"BLD",66,1,25,0)
calling routines.  
"BLD",66,1,26,0)
XQALDOIT and XQALFWD fix problems with the forwarding of alerts to others.
"BLD",66,4,0)
^9.64PA^^
"BLD",66,"KRN",0)
^9.67PA^8994^15
"BLD",66,"KRN",.4,0)
.4
"BLD",66,"KRN",.401,0)
.401
"BLD",66,"KRN",.402,0)
.402
"BLD",66,"KRN",.403,0)
.403
"BLD",66,"KRN",.5,0)
.5
"BLD",66,"KRN",.84,0)
.84
"BLD",66,"KRN",3.6,0)
3.6
"BLD",66,"KRN",9.2,0)
9.2
"BLD",66,"KRN",9.8,0)
9.8
"BLD",66,"KRN",9.8,"NM",0)
^9.68A^4^4
"BLD",66,"KRN",9.8,"NM",1,0)
XQALSET^^0^B22056543
"BLD",66,"KRN",9.8,"NM",2,0)
XQALDEL^^0^B24693816
"BLD",66,"KRN",9.8,"NM",3,0)
XQALDOIT^^0^B16152304
"BLD",66,"KRN",9.8,"NM",4,0)
XQALFWD^^0^B16610131
"BLD",66,"KRN",9.8,"NM","B","XQALDEL",2)

"BLD",66,"KRN",9.8,"NM","B","XQALDOIT",3)

"BLD",66,"KRN",9.8,"NM","B","XQALFWD",4)

"BLD",66,"KRN",9.8,"NM","B","XQALSET",1)

"BLD",66,"KRN",19,0)
19
"BLD",66,"KRN",19.1,0)
19.1
"BLD",66,"KRN",101,0)
101
"BLD",66,"KRN",409.61,0)
409.61
"BLD",66,"KRN",8994,0)
8994
"BLD",66,"KRN",8995,0)
8995
"BLD",66,"KRN","B",.4,.4)

"BLD",66,"KRN","B",.401,.401)

"BLD",66,"KRN","B",.402,.402)

"BLD",66,"KRN","B",.403,.403)

"BLD",66,"KRN","B",.5,.5)

"BLD",66,"KRN","B",.84,.84)

"BLD",66,"KRN","B",3.6,3.6)

"BLD",66,"KRN","B",9.2,9.2)

"BLD",66,"KRN","B",9.8,9.8)

"BLD",66,"KRN","B",19,19)

"BLD",66,"KRN","B",19.1,19.1)

"BLD",66,"KRN","B",101,101)

"BLD",66,"KRN","B",409.61,409.61)

"BLD",66,"KRN","B",8994,8994)

"BLD",66,"KRN","B",8995,8995)

"PKG",283,-1)
21^4
"PKG",283,0)
KERNEL^XU^SIGN-ON, SECURITY, MENU DRIVER, DEVICES, TASKMAN^
"PKG",283,1,0)
^^1^1^2950921^
"PKG",283,1,1,0)
This is the basic package containing the KERNEL.
"PKG",283,2,0)
^9.42A^^0
"PKG",283,3,0)
^9.43^^0
"PKG",283,4,0)
^9.44AP^^0
"PKG",283,5)
SAN FRANCISCO
"PKG",283,7)
^^I
"PKG",283,8,0)
^9.404ID^^0
"PKG",283,11)
^
"PKG",283,20,0)
^9.402P^^0
"PKG",283,22,0)
^9.49I^21^5
"PKG",283,22,6,0)
6^2890609^2880718
"PKG",283,22,6.5,0)
6.5^2890807
"PKG",283,22,7,0)
7^2920831
"PKG",283,22,8,0)
7.1^2930507^2930125
"PKG",283,22,21,0)
8.0^2950729^2950729^6
"PKG",283,22,21,"PAH",0)
^9.4901^4^4
"PKG",283,22,21,"PAH",1,0)
1^2950728
"PKG",283,22,21,"PAH",1,1,0)
^^43^43^2950901^
"PKG",283,22,21,"PAH",1,1,1,0)
This is patch 1 of Kernel 8.0. All of the changes in this patch were
"PKG",283,22,21,"PAH",1,1,2,0)
made after verification. This patch was sent as a seperate file with
"PKG",283,22,21,"PAH",1,1,3,0)
the Kernel 8.0 distribution.
"PKG",283,22,21,"PAH",1,1,4,0)

"PKG",283,22,21,"PAH",1,1,5,0)
Routines:
"PKG",283,22,21,"PAH",1,1,6,0)
ORF2     - Corrects error when deleting OERR Alerts.
"PKG",283,22,21,"PAH",1,1,7,0)
XPDR     - Purge Build/Install file option will now find patches.
"PKG",283,22,21,"PAH",1,1,8,0)
XQ1      - Corrects undefined error if the variable ZTMQUEUED is killed in
"PKG",283,22,21,"PAH",1,1,9,0)
           an queued task.
"PKG",283,22,21,"PAH",1,1,10,0)
XQALDOIT - New API call, DOOPT.
"PKG",283,22,21,"PAH",1,1,11,0)
XQALERT  - New API call, GETACT.
"PKG",283,22,21,"PAH",1,1,12,0)
XQALSET  - Corrects undefined error when two people process Alerts at
"PKG",283,22,21,"PAH",1,1,13,0)
           the same time.
"PKG",283,22,21,"PAH",1,1,14,0)
XUFILE   - Grant File Access option will now accept file numbers with
"PKG",283,22,21,"PAH",1,1,15,0)
           up to 5 decimal places.
"PKG",283,22,21,"PAH",1,1,16,0)
XUTMTDL  - Correct undefine error when deleting list of Taskman tasks.
"PKG",283,22,21,"PAH",1,1,17,0)
ZTLOAD2  - Restricted Queue on an option will now default to the correct
"PKG",283,22,21,"PAH",1,1,18,0)
           date/time.
"PKG",283,22,21,"PAH",1,1,19,0)
ZTMS3    - Corrects no-open error in Taskman, caused when IO("C") is left
"PKG",283,22,21,"PAH",1,1,20,0)
           defined by task.
"PKG",283,22,21,"PAH",1,1,21,0)

"PKG",283,22,21,"PAH",1,1,22,0)
ZTM4,    - Corrects the hanging of Taskman Submanagers on ^ZTSCH("IO") when
"PKG",283,22,21,"PAH",1,1,23,0)
ZTMS7      printer is off-line.
"PKG",283,22,21,"PAH",1,1,24,0)

"PKG",283,22,21,"PAH",1,1,25,0)
Option:
"PKG",283,22,21,"PAH",1,1,26,0)
XU OPTION START - Entry action will now be executed on queued options.
"PKG",283,22,21,"PAH",1,1,27,0)

"PKG",283,22,21,"PAH",1,1,28,0)
Installation:
"PKG",283,22,21,"PAH",1,1,29,0)
 1. Before installing this patch, you should inhibit users from login,
"PKG",283,22,21,"PAH",1,1,30,0)
    shutdown Taskman and remove users from system.
"PKG",283,22,21,"PAH",1,1,31,0)
 2. After installing this patch, you need to move the following 4 routines
"PKG",283,22,21,"PAH",1,1,32,0)
    from your productions account to the manager account:
"PKG",283,22,21,"PAH",1,1,33,0)
    ZTLOAD2
"PKG",283,22,21,"PAH",1,1,34,0)
    ZTM4
"PKG",283,22,21,"PAH",1,1,35,0)
    ZTMS3
"PKG",283,22,21,"PAH",1,1,36,0)
    ZTMS7
"PKG",283,22,21,"PAH",1,1,37,0)
 3. Rename the routines as follows:
"PKG",283,22,21,"PAH",1,1,38,0)
    ZL ZTLOAD2 ZS %ZTLOAD2
"PKG",283,22,21,"PAH",1,1,39,0)
    ZL ZTM4 ZS %ZTM4
"PKG",283,22,21,"PAH",1,1,40,0)
    ZL ZTMS3 ZS %ZTMS3
"PKG",283,22,21,"PAH",1,1,41,0)
    ZL ZTMS7 ZS %ZTMS7
"PKG",283,22,21,"PAH",1,1,42,0)
 4. Un-inhibit users from login and restart Taskman.
"PKG",283,22,21,"PAH",1,1,43,0)

"PKG",283,22,21,"PAH",2,0)
2^2950926
"PKG",283,22,21,"PAH",2,1,0)
^^128^128^2950926
"PKG",283,22,21,"PAH",2,1,1,0)
This is Patch 2 to Kernel version 8.0.  It is in KIDS format and you must
"PKG",283,22,21,"PAH",2,1,2,0)
use the KIDS options to install it. This patch contains Taskman routines.
"PKG",283,22,21,"PAH",2,1,3,0)
You should put Taskman in a wait state and stop the submanager before moving
"PKG",283,22,21,"PAH",2,1,4,0)
the Taskman routines to your Manager account.
"PKG",283,22,21,"PAH",2,1,5,0)
========================================================================= 
"PKG",283,22,21,"PAH",2,1,6,0)
INSTALLATION:
"PKG",283,22,21,"PAH",2,1,7,0)
 
"PKG",283,22,21,"PAH",2,1,8,0)
 1. Use the 'INSTALL/CHECK MESSAGE' option on the PackMan menu. This
"PKG",283,22,21,"PAH",2,1,9,0)
    option will load the KIDS package in this message onto your system.
"PKG",283,22,21,"PAH",2,1,10,0)
 2. Answer NO to the question:
"PKG",283,22,21,"PAH",2,1,11,0)
    'Shall I preserve what is on disk in a separate back-up message ?'
"PKG",283,22,21,"PAH",2,1,12,0)
 3. The patch has now been loaded into a Transport global on your system.
"PKG",283,22,21,"PAH",2,1,13,0)
    You now need to use KIDS to install the Transport global.
"PKG",283,22,21,"PAH",2,1,14,0)
 4. On the KIDS menu, under the 'Installation' menu, use the option
"PKG",283,22,21,"PAH",2,1,15,0)
    'Install Package(s)'.
"PKG",283,22,21,"PAH",2,1,16,0)
    Select the package 'XU*8.0*2' and proceed with install.
"PKG",283,22,21,"PAH",2,1,17,0)
 5. After installing this patch, you need to move the following 2 routines
"PKG",283,22,21,"PAH",2,1,18,0)
    from your productions account to the manager account:
"PKG",283,22,21,"PAH",2,1,19,0)
    ZTMS
"PKG",283,22,21,"PAH",2,1,20,0)
    ZTMS2
"PKG",283,22,21,"PAH",2,1,21,0)
 6. In the manager account rename the 2 routines;  i.e.  ZL ZTMS ZS %ZTMS
"PKG",283,22,21,"PAH",2,1,22,0)
    ZTMS     to  %ZTMS
"PKG",283,22,21,"PAH",2,1,23,0)
    ZTMS2    to  %ZTMS2
"PKG",283,22,21,"PAH",2,1,24,0)
 7. If you are a 486 Site, you should now move the 2 routines; %ZTMS &
"PKG",283,22,21,"PAH",2,1,25,0)
    %ZTMS2 to the Manager account on you other CPU's. You also should
"PKG",283,22,21,"PAH",2,1,26,0)
    move the routine XPDIJ from your production account to the production
"PKG",283,22,21,"PAH",2,1,27,0)
    account on the other CPU's.
"PKG",283,22,21,"PAH",2,1,28,0)
 8. Remove Taskman from wait state
"PKG",283,22,21,"PAH",2,1,29,0)
========================================================================= 
"PKG",283,22,21,"PAH",2,1,30,0)
 
"PKG",283,22,21,"PAH",2,1,31,0)
The Routine XUTMOPT has new entry points to allow other packages to
"PKG",283,22,21,"PAH",2,1,32,0)
edit
"PKG",283,22,21,"PAH",2,1,33,0)
the OPTION SCHEDULING file (#19.2).
"PKG",283,22,21,"PAH",2,1,34,0)
 
"PKG",283,22,21,"PAH",2,1,35,0)
These new entry points include the following:
"PKG",283,22,21,"PAH",2,1,36,0)
 
"PKG",283,22,21,"PAH",2,1,37,0)
 
"PKG",283,22,21,"PAH",2,1,38,0)
* EDIT^XUTMOPT: Edit an Option
"PKG",283,22,21,"PAH",2,1,39,0)
 
"PKG",283,22,21,"PAH",2,1,40,0)
Usage  D EDIT^XUTMOPT(option_name)
"PKG",283,22,21,"PAH",2,1,41,0)
 
"PKG",283,22,21,"PAH",2,1,42,0)
Input  option_name:    Name of the option to be edited.
"PKG",283,22,21,"PAH",2,1,43,0)
 
"PKG",283,22,21,"PAH",2,1,44,0)
Output none
"PKG",283,22,21,"PAH",2,1,45,0)
 
"PKG",283,22,21,"PAH",2,1,46,0)
Description
"PKG",283,22,21,"PAH",2,1,47,0)
 
"PKG",283,22,21,"PAH",2,1,48,0)
This entry point allows users to edit an option's scheduling in the
"PKG",283,22,21,"PAH",2,1,49,0)
OPTION
"PKG",283,22,21,"PAH",2,1,50,0)
SCHEDULING file (#19.2).
"PKG",283,22,21,"PAH",2,1,51,0)
 
"PKG",283,22,21,"PAH",2,1,52,0)
 
"PKG",283,22,21,"PAH",2,1,53,0)
* DISP^XUTMOPT: Display an Option
"PKG",283,22,21,"PAH",2,1,54,0)
 
"PKG",283,22,21,"PAH",2,1,55,0)
Usage  D DISP^XUTMOPT(option_name)
"PKG",283,22,21,"PAH",2,1,56,0)
 
"PKG",283,22,21,"PAH",2,1,57,0)
Input  option_name:    Name of the option to be displayed.
"PKG",283,22,21,"PAH",2,1,58,0)
 
"PKG",283,22,21,"PAH",2,1,59,0)
Output none
"PKG",283,22,21,"PAH",2,1,60,0)
 
"PKG",283,22,21,"PAH",2,1,61,0)
Description
"PKG",283,22,21,"PAH",2,1,62,0)
 
"PKG",283,22,21,"PAH",2,1,63,0)
This entry point is used to display the schedule for an option.
"PKG",283,22,21,"PAH",2,1,64,0)
 
"PKG",283,22,21,"PAH",2,1,65,0)
 
"PKG",283,22,21,"PAH",2,1,66,0)
* RESCH^XUTMOPT: Reschedule an Option
"PKG",283,22,21,"PAH",2,1,67,0)
 
"PKG",283,22,21,"PAH",2,1,68,0)
Usage  D RESCH^XUTMOPT(option_name,when_to_run,device_to_use,
"PKG",283,22,21,"PAH",2,1,69,0)
re-schedule_freq,flags,error_array)
"PKG",283,22,21,"PAH",2,1,70,0)
 
"PKG",283,22,21,"PAH",2,1,71,0)
Input option_name:    Name of the option to be rescheduled.
"PKG",283,22,21,"PAH",2,1,72,0)
 
"PKG",283,22,21,"PAH",2,1,73,0)
      when_to_run:    (optional)
"PKG",283,22,21,"PAH",2,1,74,0)
                      The new scheduled time for the option to run.
"PKG",283,22,21,"PAH",2,1,75,0)
 
"PKG",283,22,21,"PAH",2,1,76,0)
      device_to_use:  (optional)
"PKG",283,22,21,"PAH",2,1,77,0)
                      The device to use for the rescheduled option.
"PKG",283,22,21,"PAH",2,1,78,0)
 
"PKG",283,22,21,"PAH",2,1,79,0)
   re-schedule_freq:  (optional)
"PKG",283,22,21,"PAH",2,1,80,0)
                      The frequency to run the rescheduled option.
"PKG",283,22,21,"PAH",2,1,81,0)
 
"PKG",283,22,21,"PAH",2,1,82,0)
      flags:          (optional) If the flag is set to an 'L' LAYGO
"PKG",283,22,21,"PAH",2,1,83,0)
                      a new entry if needed.
"PKG",283,22,21,"PAH",2,1,84,0)
 
"PKG",283,22,21,"PAH",2,1,85,0)
     error_array:     (optional) Pass by reference. Will be set to -1
"PKG",283,22,21,"PAH",2,1,86,0)
                      if the option was not found.
"PKG",283,22,21,"PAH",2,1,87,0)
 
"PKG",283,22,21,"PAH",2,1,88,0)
Output none
"PKG",283,22,21,"PAH",2,1,89,0)
 
"PKG",283,22,21,"PAH",2,1,90,0)
Description
"PKG",283,22,21,"PAH",2,1,91,0)
 
"PKG",283,22,21,"PAH",2,1,92,0)
This entry point allows an application to set-up the schedule for an
"PKG",283,22,21,"PAH",2,1,93,0)
option.
"PKG",283,22,21,"PAH",2,1,94,0)
 
"PKG",283,22,21,"PAH",2,1,95,0)
XUTMR had a bug in the Taskman Requeue code.
"PKG",283,22,21,"PAH",2,1,96,0)
When the question 'Do you wish to change the Device the task goes to:' was
"PKG",283,22,21,"PAH",2,1,97,0)
answered NO. Then it would delete the output device.
"PKG",283,22,21,"PAH",2,1,98,0)
 
"PKG",283,22,21,"PAH",2,1,99,0)
XUTMRP and XUTMRP1 are new routines that allow a site to redirect tasks
"PKG",283,22,21,"PAH",2,1,100,0)
that are waiting for a particular device to be rescheduled to a new
"PKG",283,22,21,"PAH",2,1,101,0)
device. The options to invoke these routines can be found on the Taskman
"PKG",283,22,21,"PAH",2,1,102,0)
Management Utilities menu.
"PKG",283,22,21,"PAH",2,1,103,0)
 
"PKG",283,22,21,"PAH",2,1,104,0)
There are updates to the DD for the following two fields of the NEW PERSON
"PKG",283,22,21,"PAH",2,1,105,0)
file (#200): VOICE PAGER (#.137) and DIGITAL PAGER (#.138). These fields
"PKG",283,22,21,"PAH",2,1,106,0)
now allow three digit pager numbers.
"PKG",283,22,21,"PAH",2,1,107,0)
 
"PKG",283,22,21,"PAH",2,1,108,0)
XUVERIFY had a bug that prevented the use of a '?' in the access/verify
"PKG",283,22,21,"PAH",2,1,109,0)
code pair. This has been fix.
"PKG",283,22,21,"PAH",2,1,110,0)
 
"PKG",283,22,21,"PAH",2,1,111,0)
ZTMS and ZTMS2 have fixes to problems found after K8 release.  That relate
"PKG",283,22,21,"PAH",2,1,112,0)
to leaving IO("C") around, also fixed in Kernel 7.1.  %ZTMS2 also does a
"PKG",283,22,21,"PAH",2,1,113,0)
check to see that %ZTIO and IO are the same. If not record in the TM error
"PKG",283,22,21,"PAH",2,1,114,0)
log and CLOSE %ZTIO and set to IO.  This may be why 2 devices get opened
"PKG",283,22,21,"PAH",2,1,115,0)
at once.
"PKG",283,22,21,"PAH",2,1,116,0)
 
"PKG",283,22,21,"PAH",2,1,117,0)
XPDE, XPDIA1 have been updated so that KIDS now supports List Manager
"PKG",283,22,21,"PAH",2,1,118,0)
templates and Remote Procedures for the Kernel RPC Broker.
"PKG",283,22,21,"PAH",2,1,119,0)
 
"PKG",283,22,21,"PAH",2,1,120,0)
XPDT returns error message if HFS filename is rejected by Device Handler.
"PKG",283,22,21,"PAH",2,1,121,0)
 
"PKG",283,22,21,"PAH",2,1,122,0)
XPDR has been enhanced to allow purging of Build and Install files at the
"PKG",283,22,21,"PAH",2,1,123,0)
same time.
"PKG",283,22,21,"PAH",2,1,124,0)
 
"PKG",283,22,21,"PAH",2,1,125,0)
XPDDCS will now check that routines in the transport global have header nodes.
"PKG",283,22,21,"PAH",2,1,126,0)
 
"PKG",283,22,21,"PAH",2,1,127,0)
XPDIJ doesn't display the message, 'Data already Installed', if there was no
"PKG",283,22,21,"PAH",2,1,128,0)
data sent.
"PKG",283,22,21,"PAH",3,0)
5^2950921
"PKG",283,22,21,"PAH",3,1,0)
^^36^36^2950921^
"PKG",283,22,21,"PAH",3,1,1,0)
XU*8*5
"PKG",283,22,21,"PAH",3,1,2,0)
This is a patch to XPDKEY to provide a supported call to do a lookup
"PKG",283,22,21,"PAH",3,1,3,0)
on the Security Key file.
"PKG",283,22,21,"PAH",3,1,4,0)
 
"PKG",283,22,21,"PAH",3,1,5,0)
========================================================================= 
"PKG",283,22,21,"PAH",3,1,6,0)
INSTALLATION: 
"PKG",283,22,21,"PAH",3,1,7,0)
 
"PKG",283,22,21,"PAH",3,1,8,0)
 1. Use the 'INSTALL/CHECK MESSAGE' option on the PackMan menu. This 
"PKG",283,22,21,"PAH",3,1,9,0)
    option will load the KIDS package in this message onto your system.  
"PKG",283,22,21,"PAH",3,1,10,0)
 2. Answer NO to the question: 
"PKG",283,22,21,"PAH",3,1,11,0)
    'Shall I preserve what is on disk in a separate back-up message ?' 
"PKG",283,22,21,"PAH",3,1,12,0)
 3. The patch has now been loaded into a Transport global on your system.
"PKG",283,22,21,"PAH",3,1,13,0)
 
"PKG",283,22,21,"PAH",3,1,14,0)
    You now need to use KIDS to install the Transport global.  
"PKG",283,22,21,"PAH",3,1,15,0)
 4. On the KIDS menu, under the 'Installation' menu, use the option 
"PKG",283,22,21,"PAH",3,1,16,0)
    'Install Package(s)'.  
"PKG",283,22,21,"PAH",3,1,17,0)
    Select the package 'XU*8.0*5' and proceed with install.  
"PKG",283,22,21,"PAH",3,1,18,0)
 
"PKG",283,22,21,"PAH",3,1,19,0)
    This routine is used by KIDS, so there will not be any user accessing
"PKG",283,22,21,"PAH",3,1,20,0)
    it.  This patch can be installed at any time.
"PKG",283,22,21,"PAH",3,1,21,0)
 
"PKG",283,22,21,"PAH",3,1,22,0)
========================================================================= 
"PKG",283,22,21,"PAH",3,1,23,0)
 
"PKG",283,22,21,"PAH",3,1,24,0)
*  LKUP^XPDKEY(key_lookup)
"PKG",283,22,21,"PAH",3,1,25,0)
Usage  S Y=27,X=LKUP^XPDKEY(Y) 
"PKG",283,22,21,"PAH",3,1,26,0)
 
"PKG",283,22,21,"PAH",3,1,27,0)
Input  key_lookup: Name or number of a key.
"PKG",283,22,21,"PAH",3,1,28,0)
 
"PKG",283,22,21,"PAH",3,1,29,0)
Output If called with a number it returns the name of the option.
"PKG",283,22,21,"PAH",3,1,30,0)
       If called with a name it returns the number of the option.
"PKG",283,22,21,"PAH",3,1,31,0)
 
"PKG",283,22,21,"PAH",3,1,32,0)
Description
"PKG",283,22,21,"PAH",3,1,33,0)
 
"PKG",283,22,21,"PAH",3,1,34,0)
This is an extrinsic function to do lookups on the Security Key file and
"PKG",283,22,21,"PAH",3,1,35,0)
return the name if called with a number, or return a number if called with
"PKG",283,22,21,"PAH",3,1,36,0)
a name.  If the name or number is not found it returns the empty string.
"PKG",283,22,21,"PAH",4,0)
6^2950926
"PKG",283,22,21,"PAH",4,1,0)
^^26^26^2950926
"PKG",283,22,21,"PAH",4,1,1,0)
XU*8.0*6
"PKG",283,22,21,"PAH",4,1,2,0)
This patch fixes some problems found in the ALERT system after Kernel was
"PKG",283,22,21,"PAH",4,1,3,0)
released.
"PKG",283,22,21,"PAH",4,1,4,0)
========================================================================= 
"PKG",283,22,21,"PAH",4,1,5,0)
INSTALLATION: 
"PKG",283,22,21,"PAH",4,1,6,0)
 
"PKG",283,22,21,"PAH",4,1,7,0)
 1. Use the 'INSTALL/CHECK MESSAGE' option on the PackMan menu. This 
"PKG",283,22,21,"PAH",4,1,8,0)
    option will load the KIDS package in this message onto your system.  
"PKG",283,22,21,"PAH",4,1,9,0)
 2. Answer NO to the question: 
"PKG",283,22,21,"PAH",4,1,10,0)
    'Shall I preserve what is on disk in a separate back-up message ?' 
"PKG",283,22,21,"PAH",4,1,11,0)
 3. The patch has now been loaded into a Transport global on your system.
"PKG",283,22,21,"PAH",4,1,12,0)
 
"PKG",283,22,21,"PAH",4,1,13,0)
    You now need to use KIDS to install the Transport global.  
"PKG",283,22,21,"PAH",4,1,14,0)
 4. On the KIDS menu, under the 'Installation' menu, use the option 
"PKG",283,22,21,"PAH",4,1,15,0)
    'Install Package(s)'.  
"PKG",283,22,21,"PAH",4,1,16,0)
    Select the package 'XU*8.0*6' and proceed with install.  
"PKG",283,22,21,"PAH",4,1,17,0)
 
"PKG",283,22,21,"PAH",4,1,18,0)
This patch can be loaded any time that users are not likely to be in
"PKG",283,22,21,"PAH",4,1,19,0)
the ALERT system.  i.e. It could be queued up to install eary in the
"PKG",283,22,21,"PAH",4,1,20,0)
morning.  If a user is in the ALERT system they may get a CLOBER error.
"PKG",283,22,21,"PAH",4,1,21,0)
========================================================================= 
"PKG",283,22,21,"PAH",4,1,22,0)
 
"PKG",283,22,21,"PAH",4,1,23,0)
 
"PKG",283,22,21,"PAH",4,1,24,0)
XQALSET and XQALDEL now NEW DA so they don't cause problems with
"PKG",283,22,21,"PAH",4,1,25,0)
calling routines.  
"PKG",283,22,21,"PAH",4,1,26,0)
XQALDOIT and XQALFWD fix problems with the forwarding of alerts to others.
"PKG",283,22,21,"PAH","B",1,1)

"PKG",283,22,21,"PAH","B",2,2)

"PKG",283,22,21,"PAH","B",5,3)

"PKG",283,22,21,"PAH","B",6,4)

"PKG",283,22,"B",6,6)

"PKG",283,22,"B",6.5,6.5)

"PKG",283,22,"B",7,7)

"PKG",283,22,"B",7.1,8)

"PKG",283,22,"B","8.0",21)

"PKG",283,1933,0)
^9.455^^0
"PKG",283,"DEV")
SF:HVB,RWF,AC,XAK,VYD,JIC SEA:MJM,JLI
"PKG",283,"DIBT",0)
^9.48^^0
"PKG",283,"DIE",0)
^9.47^^0
"PKG",283,"DIPT",0)
^9.46^^0
"PKG",283,"EX",0)
^9.432^^0
"PKG",283,"INI")
^
"PKG",283,"INIT")
^
"PKG",283,"M",0)
^9.495^^0
"PKG",283,"PRE")
^
"PKG",283,"ST",0)
^9.444D^2830000^1
"PKG",283,"ST",2830000,0)
2830000^A
"PKG",283,"VERSION")
8.0
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Options and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
4
"RTN","XQALDEL")
0^2^B24693816
"RTN","XQALDEL",1,0)
XQALDEL ;ISC-SF.SEA/JLI - DELETE ALERTS ;8/21/95  11:35
"RTN","XQALDEL",2,0)
 ;;8.0;KERNEL;**6**;Jul 10, 1995
"RTN","XQALDEL",3,0)
 ;;
"RTN","XQALDEL",4,0)
 Q
"RTN","XQALDEL",5,0)
 ;
"RTN","XQALDEL",6,0)
DELETE ;
"RTN","XQALDEL",7,0)
 Q:'$D(XQAID)  Q:XQAID=""  S:'$D(XQAKILL) XQAKILL=0 S:$P(XQAID,";")="NO-ID" XQAKILL=1
"RTN","XQALDEL",8,0)
 S XQADAT=$$NOW^XLFDT()
"RTN","XQALDEL",9,0)
 I '$D(XQAUSER) N XQAUSER S XQAUSER=DUZ
"RTN","XQALDEL",10,0)
 I $D(XQAKILL) S XQXX=$O(^XTV(8992.1,"B",XQAID,0)) I XQXX>0 S XQXY=$O(^XTV(8992.1,XQXX,20,"B",XQAUSER,0)) I XQXY>0 S $P(^XTV(8992.1,XQXX,20,XQXY,0),U,4)=XQADAT
"RTN","XQALDEL",11,0)
 K XQXX,XQXY
"RTN","XQALDEL",12,0)
 I '$D(^XTV(8992,"AXQA",XQAID,XQAUSER)) D KILLOC
"RTN","XQALDEL",13,0)
 F XQX=$S('XQAKILL:0,1:XQAUSER-.01):0 S XQX=$O(^XTV(8992,"AXQA",XQAID,XQX)) Q:XQX'>0  D  Q:XQAKILL
"RTN","XQALDEL",14,0)
 . F XQK=0:0 S XQK=$O(^XTV(8992,"AXQA",XQAID,XQX,XQK)) Q:XQK'>0  K ^(XQK),^XTV(8992,"AXQAN",$P(XQAID,";"),XQX,XQK) S XQAID1=XQAID D DELA S XQAID=XQAID1
"RTN","XQALDEL",15,0)
 K XQAID,XQX,XQJ,XQK,XQAID1,XQAKILL
"RTN","XQALDEL",16,0)
 Q
"RTN","XQALDEL",17,0)
 ;
"RTN","XQALDEL",18,0)
DELETEA ;
"RTN","XQALDEL",19,0)
 Q:'$D(XQAID)  Q:XQAID=""  S XQA1=$P(XQAID,";")
"RTN","XQALDEL",20,0)
 S XQADAT=$$NOW^XLFDT()
"RTN","XQALDEL",21,0)
 I '$D(XQAUSER) N XQAUSER S XQAUSER=DUZ
"RTN","XQALDEL",22,0)
 I '$D(^XTV(8992,"AXQAN",XQA1,XQAUSER)) D KILLOC
"RTN","XQALDEL",23,0)
 I $D(XQAKILL) S XQXX=$O(^XTV(8992.1,"B",XQAID,0)) I XQXX>0 S XQXY=$O(^XTV(8992.1,XQXX,20,"B",XQAUSER,0)) I XQXY>0 S $P(^XTV(8992.1,XQXX,20,XQXY,0),U,4)=XQADAT
"RTN","XQALDEL",24,0)
 S:'$D(XQAKILL) XQAKILL=0 G:$P(XQAID,";")="NO-ID" DELETE S XQX=$S('XQAKILL:0,1:XQAUSER-.01)
"RTN","XQALDEL",25,0)
 I $P(XQAID,",",2)'=""!($P(XQAID,";",2)="") F XQX=XQX:0 S XQX=$O(^XTV(8992,"AXQAN",XQA1,XQX)) Q:XQX'>0  D  Q:XQAKILL
"RTN","XQALDEL",26,0)
 . F XQK=0:0 S XQK=$O(^XTV(8992,"AXQAN",XQA1,XQX,XQK)) Q:XQK'>0  K ^(XQK) I $D(^XTV(8992,XQX,"XQA",XQK,0)) D DELA
"RTN","XQALDEL",27,0)
 I $P(XQAID,",",2)=""&($P(XQAID,";",2)'="") F XQX=XQX:0 S XQX=$O(^XTV(8992,"AXQA",XQAID,XQX)) Q:XQX'>0  D  Q:XQAKILL
"RTN","XQALDEL",28,0)
 . S XQK=$O(^XTV(8992,"AXQA",XQAID,XQX,0)) Q:XQK'>0  K ^(XQK),^XTV(8992,"AXQAN",XQA1,XQX,XQK) I $D(^XTV(8992,XQX,"XQA",XQK,0)) D DELA
"RTN","XQALDEL",29,0)
 K XQAID,XQA1,XQX,XQK,XQAKILL
"RTN","XQALDEL",30,0)
 Q
"RTN","XQALDEL",31,0)
DELA ;
"RTN","XQALDEL",32,0)
 N XQ11,XQK1 S XQAID=$P(^XTV(8992,XQX,"XQA",XQK,0),U,2),XQ11=$P(^(0),U) K ^XTV(8992,XQX,"XQA",XQK),^XTV(8992,"AXQA",XQAID,XQX,XQK) S XQK1=$P(^XTV(8992,XQX,"XQA",0),U,4)-1 K:XQK1'>0 ^(0) S:XQK1>0 $P(^(0),U,4)=XQK1
"RTN","XQALDEL",33,0)
 K ^XTV(8992,"AXQAN",$P(XQAID,";"),XQX,XQK),^XTV(8992,XQX,"XQA","B",XQ11,XQK)
"RTN","XQALDEL",34,0)
 S XQXX=$O(^XTV(8992.1,"B",XQAID,0)) I XQXX>0 S XQXY=$O(^XTV(8992.1,XQXX,20,"B",XQX,0)) I XQXY>0 S $P(^XTV(8992.1,XQXX,20,XQXY,0),U,5)=XQADAT
"RTN","XQALDEL",35,0)
 K XQXX,XQXY
"RTN","XQALDEL",36,0)
 Q
"RTN","XQALDEL",37,0)
 ;
"RTN","XQALDEL",38,0)
KILLOC ;
"RTN","XQALDEL",39,0)
 S XQX=XQAUSER F XQK=0:0 S XQK=$O(^XTV(8992,XQAUSER,"XQA",XQK)) Q:XQK'>0  I $P(^(XQK,0),U,2)=XQAID D
"RTN","XQALDEL",40,0)
 . N XQAID D DELA
"RTN","XQALDEL",41,0)
 Q
"RTN","XQALDEL",42,0)
 ;
"RTN","XQALDEL",43,0)
OLDDEL ;
"RTN","XQALDEL",44,0)
 ;
"RTN","XQALDEL",45,0)
 S XQADAT=$$NOW^XLFDT()
"RTN","XQALDEL",46,0)
 S X2=-15 I $D(ZTQPARAM),ZTQPARAM>0 S X2=-ZTQPARAM
"RTN","XQALDEL",47,0)
 S XQDAT=$$FMADD^XLFDT(DT,X2)
"RTN","XQALDEL",48,0)
 F XQ1=0:0 S XQ1=$O(^XTV(8992,XQ1)) Q:XQ1'>0  F XQ2=0:0 S XQ2=$O(^XTV(8992,XQ1,"XQA",XQ2)) Q:XQ2'>0  S X=^(XQ2,0) D
"RTN","XQALDEL",49,0)
 . I $P(X,U,13)>0 I $$FMADD^XLFDT($P($P(X,U,2),";",3),+$P(X,U,13))\1=DT D
"RTN","XQALDEL",50,0)
 . . N XQA,I,XQAUSER S XQAUSER=XQ1 F I=0:0 S I=$O(^XMB(3.7,XQAUSER,9,I)) Q:I'>0  S XQA(I)=+^(I,0)
"RTN","XQALDEL",51,0)
 . . Q:'$D(XQA)  D FORWARD^XQALFWD($P(X,U,2),.XQA,"A","ALERT NOT PROCESSED BY "_$P(^VA(200,XQAUSER,0),U))
"RTN","XQALDEL",52,0)
 . I $P(X,U,14)>0 I $$FMADD^XLFDT($P($P(X,U,2),";",3),+$P(X,U,14))\1=DT D
"RTN","XQALDEL",53,0)
 . . N XQA,I,XQAUSER S XQAUSER=XQ1 S I=$P($G(^VA(200,XQAUSER,5)),U) I I>0 S I=$P($G(^DIC(49,+I,0)),U,3) I I>0,$D(^VA(200,+I,0)) S XQA=+I
"RTN","XQALDEL",54,0)
 . . I $D(XQA) D FORWARD^XQALFWD($P(X,U,2),XQA,"A","ALERT NOT PROCESSED BY "_$P(^VA(200,XQAUSER,0),U))
"RTN","XQALDEL",55,0)
 . I XQ2'>XQDAT  D OLDDEL1
"RTN","XQALDEL",56,0)
 D KILLARCH
"RTN","XQALDEL",57,0)
 K X1,X2,X,XQ1,XQ2,XQDAT,XQA,XQADAT
"RTN","XQALDEL",58,0)
 Q
"RTN","XQALDEL",59,0)
OLDDEL1 ;
"RTN","XQALDEL",60,0)
 S XQA=$P(^XTV(8992,XQ1,"XQA",XQ2,0),U,2) K ^(0),^(1),^(2) K:XQA'="" ^XTV(8992,"AXQA",XQA,XQ1),^XTV(8992,"AXQAN",$P(XQA,";"),XQ1) S $P(^(0),U,4)=$P(^XTV(8992,XQ1,"XQA",0),U,4)-1 I $O(^(0))'>0 K ^(0)
"RTN","XQALDEL",61,0)
 I XQA'="" S XQXX=$O(^XTV(8992.1,"B",XQA,0)) I XQXX>0 S XQXY=$O(^XTV(8992.1,XQXX,20,"B",XQ1,0)) I XQXY>0 S $P(^XTV(8992.1,XQXX,20,XQXY,0),U,6)=XQADAT
"RTN","XQALDEL",62,0)
 Q
"RTN","XQALDEL",63,0)
 ;
"RTN","XQALDEL",64,0)
KILLARCH ;
"RTN","XQALDEL",65,0)
 N DA,DIK
"RTN","XQALDEL",66,0)
 S XQDAT=$$FMADD^XLFDT(DT,-30)
"RTN","XQALDEL",67,0)
 F XQ1=0:0 S XQ1=$O(^XTV(8992.1,XQ1)) Q:XQ1'>0  D
"RTN","XQALDEL",68,0)
 . S X1=$P(^XTV(8992.1,XQ1,0),U,2),X2=$P(^(0),U,8)
"RTN","XQALDEL",69,0)
 . S DA=XQ1 I X2="",X1>XQDAT Q
"RTN","XQALDEL",70,0)
 . I X2>0,DT<X2 Q
"RTN","XQALDEL",71,0)
 . S DIK="^XTV(8992.1," D ^DIK
"RTN","XQALDEL",72,0)
 Q
"RTN","XQALDEL",73,0)
 ;
"RTN","XQALDEL",74,0)
USERDEL ; Delete undesired alerts for a user
"RTN","XQALDEL",75,0)
 N DA,DIC
"RTN","XQALDEL",76,0)
 S DIC("A")="Select NEW PERSON entry for deletion of alerts: "
"RTN","XQALDEL",77,0)
 S DIC(0)="AEQM",DIC=200
"RTN","XQALDEL",78,0)
 D ^DIC K DIC Q:Y'>0  S XQAUSER=+Y
"RTN","XQALDEL",79,0)
 S XQALDELE=1
"RTN","XQALDEL",80,0)
 K XQX1
"RTN","XQALDEL",81,0)
 D DOIT^XQALERT1
"RTN","XQALDEL",82,0)
 K XQALDELE
"RTN","XQALDEL",83,0)
 I $D(XQX1),XQX1>0 D
"RTN","XQALDEL",84,0)
 . F  Q:XQX1=""  S DA=+XQX1,XQX1=$P(XQX1,",",2,99) D  I XQX1="" S Y=$O(XQX1(0)) I Y>0 S XQX1=XQX1(Y) K XQX1(Y)
"RTN","XQALDEL",85,0)
 . . S XQAID=$P(^XUTL("XQ",$J,"XQA1",DA),U,2),XQAKILL=1
"RTN","XQALDEL",86,0)
 . . I XQAID="" K ^XTV(8992,XQAUSER,"XQA",+^XUTL("XQ",$J,"XQA1",DA,1))
"RTN","XQALDEL",87,0)
 . . I XQAID'="" D DELETE
"RTN","XQALDEL",88,0)
 . . K ^XUTL("XQ",$J,"XQA1",DA),^XUTL("XQ",$J,"XQA",(999999-DA))
"RTN","XQALDEL",89,0)
 . I $O(^XTV(8992,XQAUSER,"XQA",0))'>0 K ^XTV(8992,XQAUSER,"XQA")
"RTN","XQALDEL",90,0)
 K XQAUSER,XQX1
"RTN","XQALDEL",91,0)
 Q
"RTN","XQALDOIT")
0^3^B16152304
"RTN","XQALDOIT",1,0)
XQALDOIT ;ISC-SF.SEA/JLI - ALERT HANDLER ;9/21/95  13:42
"RTN","XQALDOIT",2,0)
 ;;8.0;KERNEL;**1,6**;Jul 10, 1995
"RTN","XQALDOIT",3,0)
 ;
"RTN","XQALDOIT",4,0)
EN ;
"RTN","XQALDOIT",5,0)
 S XQAEXIT="DOIT^XQALERT1"
"RTN","XQALDOIT",6,0)
 S XQX=^XUTL("XQ",$J,"XQA1",+XQX1),XQI=^(+XQX1,1),XQZ=^(2)
"RTN","XQALDOIT",7,0)
EN1 ;
"RTN","XQALDOIT",8,0)
 S XQADATA=$S(XQZ'="":XQZ,1:$P(XQX,U,9,99)),XQAID=$P(XQX,U,2),XQA1=$P(XQAID,";"),XQX2=+XQX1,XQX1=$P(XQX1,",",2,200) I XQX1'>0 S XQK=$O(XQX1(0)) I XQK>0 S XQX1=XQX1(XQK) K XQX1(XQK)
"RTN","XQALDOIT",9,0)
 S XQAROU=""
"RTN","XQALDOIT",10,0)
 S XQAKILL=1 I XQX2,$P(XQX,U,8)'="" S XQAROU=$P(XQX,U,7,8) K:XQA1="" ^XTV(8992,DUZ,"XQA",XQI)
"RTN","XQALDOIT",11,0)
 I XQAID'="" D
"RTN","XQALDOIT",12,0)
 . S XQXX=$O(^XTV(8992.1,"B",XQAID,0)),XQXY=0 I XQXX>0 S XQXY=$O(^XTV(8992.1,XQXX,20,"B",DUZ,0)) I XQXY>0,$P(^XTV(8992.1,XQXX,20,XQXY,0),U,3)="" S $P(^XTV(8992.1,XQXX,20,XQXY,0),U,3)=$$NOW^XLFDT()
"RTN","XQALDOIT",13,0)
 . I $P(XQAID,";")="NO-ID" D
"RTN","XQALDOIT",14,0)
 . . I XQXY>0 S $P(^XTV(8992.1,XQXX,20,XQXY,0),U,4)=$$NOW^XLFDT(),$P(^(0),U,5)=$$NOW^XLFDT()
"RTN","XQALDOIT",15,0)
 . . K ^XTV(8992,XQAUSER,"XQA",XQI),^XTV(8992,"AXQA",XQAID,XQAUSER,XQI),^XTV(8992,"AXQAN",$P(XQAID,";"),XQAUSER,XQI),^XTV(8992,XQAUSER,"XQA","B",$P(XQX,U),XQI),XQAID,XQAKILL
"RTN","XQALDOIT",16,0)
 . K XQXX,XQXY
"RTN","XQALDOIT",17,0)
 I XQAROU'="",XQAROU'="^ " D @XQAROU G @XQAEXIT
"RTN","XQALDOIT",18,0)
 I XQAROU'="" W !!,"Processed Alert Number ",XQX2,!?4,$P(XQX,U,3),! G @XQAEXIT
"RTN","XQALDOIT",19,0)
 I XQX2 S XQMM("J")=$P(XQX,U,7)_";"_$P(^DIC(19,XQY,0),U),XQRB=0 K:XQA1="" ^XTV(8992,DUZ,"XQA",XQI)
"RTN","XQALDOIT",20,0)
 K XQI,XQX,XQJ,XQK,XQXOUT,XQ1,XQII,XQA1,XQAREV,XQACNT,XQAROU,XQX2,%ZIS
"RTN","XQALDOIT",21,0)
 K:$O(^XTV(8992,DUZ,"XQA",0))'>0 ^(0)
"RTN","XQALDOIT",22,0)
 Q
"RTN","XQALDOIT",23,0)
 ;
"RTN","XQALDOIT",24,0)
ACTION(ALERTID) ;
"RTN","XQALDOIT",25,0)
 N XQAUSER
"RTN","XQALDOIT",26,0)
 S XQI=$O(^XTV(8992,"AXQA",ALERTID,DUZ,0))
"RTN","XQALDOIT",27,0)
 Q:XQI'>0
"RTN","XQALDOIT",28,0)
 S XQX=$G(^XTV(8992,DUZ,"XQA",XQI,0)) Q:XQX=""  S XQAUSER=DUZ
"RTN","XQALDOIT",29,0)
 S XQZ=$G(^XTV(8992,DUZ,"XQA",XQI,1))
"RTN","XQALDOIT",30,0)
 I $D(XQAGETAC) Q  ; just get data to return
"RTN","XQALDOIT",31,0)
 S XQAEXIT="ENDACT",XQX1=XQI
"RTN","XQALDOIT",32,0)
 I $P(XQX,U,8)'="" G EN1
"RTN","XQALDOIT",33,0)
 D EN1
"RTN","XQALDOIT",34,0)
ENDACT ;
"RTN","XQALDOIT",35,0)
 I $D(XQMM("J")) S XQMM("J")=$P(XQMM("J"),";")_";",XQALEXIT=1 D  D ^XQ74 K XQALEXIT,XQALMENU
"RTN","XQALDOIT",36,0)
 . K XQALMENU
"RTN","XQALDOIT",37,0)
 . N X S X=$P(XQMM("J"),";")
"RTN","XQALDOIT",38,0)
 . I X=+X S:$P(^DIC(19,X,0),U,4)="M" XQALMENU="" Q
"RTN","XQALDOIT",39,0)
 . S X=$O(^DIC(19,"B",X,0)) S:$P($G(^DIC(19,+X,0)),U,4)="M" XQALMENU=""
"RTN","XQALDOIT",40,0)
 I $D(XQX1),XQX1'>0 K XQX1
"RTN","XQALDOIT",41,0)
 I $D(XQAKILL) D DELETEA^XQALERT
"RTN","XQALDOIT",42,0)
 K XQAKILL,XQAROU,XQAID,XQADATA
"RTN","XQALDOIT",43,0)
 Q
"RTN","XQALDOIT",44,0)
DOOPT(OPTION) ;
"RTN","XQALDOIT",45,0)
 N XQX1,XQAKILL,XQAROU,XQADATA,XQAID,XQMM
"RTN","XQALDOIT",46,0)
 S XQMM("J")=OPTION
"RTN","XQALDOIT",47,0)
 D ENDACT
"RTN","XQALDOIT",48,0)
 Q
"RTN","XQALDOIT",49,0)
 ;
"RTN","XQALDOIT",50,0)
PRINT ;
"RTN","XQALDOIT",51,0)
 S XQIJ=$$NOW^XLFDT(),%ZIS="MQ" D ^%ZIS Q:POP  I $D(IO("Q")) K IO("Q") S ZTRTN="DQ^XQALDOIT",ZTIO=ION,ZTSAVE("XQIJ")="",ZTSAVE("^XUTL(""XQ"",$J,""XQA2"",")="" D ^%ZTLOAD K ZTSK,ZTRTN,ZTIO,ZTSAVE Q
"RTN","XQALDOIT",52,0)
DQ ;
"RTN","XQALDOIT",53,0)
 U IO W @IOF,!!?10,"PENDING ALERTS  "_$P(^VA(200,+^XTV(8992,DUZ,0),0),U)_"   "_$E(XQIJ,4,5)_"/"_$E(XQIJ,6,7)_"/"_$E(XQIJ,2,3)_"  "_$E($P(XQIJ,".",2)_"00",1,2)_":"_$E($P(XQIJ,".",2)_"0000",3,4),!!
"RTN","XQALDOIT",54,0)
 F XQIJ=0:0 S XQIJ=$O(^XUTL("XQ",$J,"XQA2",XQIJ)) Q:XQIJ'>0  W !,^(XQIJ)
"RTN","XQALDOIT",55,0)
 D ^%ZISC K XQIJ W:'$D(ZTQUEUED) !!
"RTN","XQALDOIT",56,0)
 Q
"RTN","XQALDOIT",57,0)
MORP K ^XUTL("XQ",$J,"XQA2") S XQIK=0 F XQIJ=0:0 S XQIJ=$O(^XUTL("XQ",$J,"XQA",XQIJ)) Q:XQIJ'>0  S XQIK=XQIK+1,XQIX=^(XQIJ),^XUTL("XQ",$J,"XQA2",XQIK)=$J(XQIK,3)_". "_$P(XQIX,U,3)
"RTN","XQALDOIT",58,0)
 K XQIK,XQIX,XQIJ
"RTN","XQALDOIT",59,0)
 Q
"RTN","XQALDOIT",60,0)
MAIL ;
"RTN","XQALDOIT",61,0)
 S XMTEXT="^XUTL(""XQ"",$J,""XQA2"",",XMSUB="LIST OF PENDING ALERTS",XMY(DUZ)="",XMDUZ=.5 D ^XMD K XMTEXT,XMSUB,XMDUZ,XMY W !!,"Message will be delivered as NEW mail to YOU.",!!
"RTN","XQALDOIT",62,0)
 Q
"RTN","XQALFWD")
0^4^B16610131
"RTN","XQALFWD",1,0)
XQALFWD ;ISC-SF.SEA/JLI - FORWARD ALERTS ;9/25/95  12:20
"RTN","XQALFWD",2,0)
 ;;8.0;KERNEL;**6**;Jul 10, 1995
"RTN","XQALFWD",3,0)
 Q
"RTN","XQALFWD",4,0)
FWRD ; ENTRY POINT FOR SELECTION FROM 'VIEW ALERTS' SCREEN
"RTN","XQALFWD",5,0)
 ; USER NEEDS TO SELECT ALERT(S) FOR FORWARDING
"RTN","XQALFWD",6,0)
 ; TYPE (ALERT, MAIL MESSAGE, OR PRINT)
"RTN","XQALFWD",7,0)
 ; AND RECIPIENT(S) OR DEVICE
"RTN","XQALFWD",8,0)
 ; AND COMMENT IF ANY TO BE DISPLAYED WITH ALERT
"RTN","XQALFWD",9,0)
 ;
"RTN","XQALFWD",10,0)
 W !,"Enter RETURN to continue:" R X:DTIME Q:'$T  W @IOF,!,"You may now Select the alert or alerts that you want forwarded:",!
"RTN","XQALFWD",11,0)
 S XQALFWD=1 S XQX1=-1 D DOIT^XQALERT1
"RTN","XQALFWD",12,0)
 K XQALFWDL
"RTN","XQALFWD",13,0)
 S:'$D(XQX1) XQX1=-1 S:'$D(XQXOUT) XQXOUT=0
"RTN","XQALFWD",14,0)
 F  Q:XQX1'>0  S XQALFWDL(+XQX1)=$P(^XUTL("XQ",$J,"XQA1",+XQX1),U,2),XQX1=$P(XQX1,",",2,200)
"RTN","XQALFWD",15,0)
 G:'$D(XQALFWDL) EXIT
"RTN","XQALFWD",16,0)
 K DIR S DIR(0)="S^A:ALERT;M:MAIL MESSAGE;P:PRINT COPY;",DIR("A")="Select the method of forwarding desired",DIR("B")="ALERT" D ^DIR K DIR G:$D(DIRUT) EXIT S XQATYP=Y
"RTN","XQALFWD",17,0)
 I XQATYP="A"!(XQATYP="M") D LOOP1^XQALMAKE G:'$D(XQA) EXIT S I="" F  S I=$O(XQA(I)) Q:I=""  S XQAARR(I)=I K XQA(I)
"RTN","XQALFWD",18,0)
 I XQATYP="P" S DIC=3.5,DIC(0)="AEQM",DIC("A")="Select the DEVICE to print on" D ^DIC K DIC G:Y'>0 EXIT S XQAARR="`"_(+Y)
"RTN","XQALFWD",19,0)
 W !,"You may enter a comment to be associated with the forwarded alert if you wish",!,"Comment (optional): " R XQACOMNT:DTIME G:'$T!(XQACOMNT[U) EXIT
"RTN","XQALFWD",20,0)
 K XQALFWD
"RTN","XQALFWD",21,0)
 D FORWARD(.XQALFWDL,.XQAARR,XQATYP,XQACOMNT)
"RTN","XQALFWD",22,0)
EXIT S XQX1=-1 W !!,"You will now return to PROCESSING ALERTS, enter RETURN to continue:" R X:DTIME
"RTN","XQALFWD",23,0)
 K XQALFWDL,XQAARR,XQATYP,XQACOMNT,DIRUT,XQALFWD
"RTN","XQALFWD",24,0)
 Q
"RTN","XQALFWD",25,0)
 ;
"RTN","XQALFWD",26,0)
 Q
"RTN","XQALFWD",27,0)
FORWARD(XQALST,XQARECIP,XQATYPE,XQACOMNT) ;
"RTN","XQALFWD",28,0)
 Q:'$D(XQALST)  Q:'$D(XQARECIP)
"RTN","XQALFWD",29,0)
 N I,XQAVALS
"RTN","XQALFWD",30,0)
 S XQATYPE=$G(XQATYPE)
"RTN","XQALFWD",31,0)
 I XQATYPE="A" D
"RTN","XQALFWD",32,0)
 . S I="" F  S I=$O(XQALST(I)) Q:I=""  D SETXQA D RESETUP^XQALSET(XQALST(I),.XQAVALS,XQACOMNT)
"RTN","XQALFWD",33,0)
 . I $O(XQALST(""))="",$D(XQALST)=1,XQALST'="" D SETXQA D RESETUP^XQALSET(XQALST,.XQAVALS,XQACOMNT)
"RTN","XQALFWD",34,0)
 I XQATYPE="M" D
"RTN","XQALFWD",35,0)
 . D MAIL1
"RTN","XQALFWD",36,0)
 I XQATYPE="P" D
"RTN","XQALFWD",37,0)
 . S IOP=XQAARR D ^%ZIS Q:POP
"RTN","XQALFWD",38,0)
 . D PRNT D ^%ZISC
"RTN","XQALFWD",39,0)
 Q
"RTN","XQALFWD",40,0)
 ;
"RTN","XQALFWD",41,0)
SETXQA ;
"RTN","XQALFWD",42,0)
 I $D(XQARECIP)=1 S XQAVALS(XQARECIP)="" Q
"RTN","XQALFWD",43,0)
 S J="" F  S J=$O(XQARECIP(J)) Q:J=""  S XQAVALS(XQARECIP(J))=""
"RTN","XQALFWD",44,0)
 Q
"RTN","XQALFWD",45,0)
 ;
"RTN","XQALFWD",46,0)
SETXMY ;
"RTN","XQALFWD",47,0)
 I $D(XQARECIP)=1 S XMY(XQARECIP)="" Q
"RTN","XQALFWD",48,0)
 S J="" F  S J=$O(XQARECIP(J)) Q:J=""  S XMY(XQARECIP(J))=""
"RTN","XQALFWD",49,0)
 Q
"RTN","XQALFWD",50,0)
 ;
"RTN","XQALFWD",51,0)
MAIL1 ;
"RTN","XQALFWD",52,0)
 N I,XMY,XMSUB,XMTEXT
"RTN","XQALFWD",53,0)
 S I="" F  S I=$O(XQALST(I)) Q:I=""  S X=$O(^XTV(8992,"AXQA",XQALST(I),XQAUSER,0)) I X'="" S X=$G(^XTV(8992,XQAUSER,"XQA",X,0)) I X'="" D SETXMY D MAIL
"RTN","XQALFWD",54,0)
 I $D(XQALST)=1,XQALST>0 S X=$O(^XTV(8992,"AXQA",XQALST,XQAUSER,0)) I X'="" S X=$G(^XTV(8992,XQAUSER,"XQA",X,0)) I X'="" D SETXMY D MAIL
"RTN","XQALFWD",55,0)
 Q
"RTN","XQALFWD",56,0)
MAIL ;
"RTN","XQALFWD",57,0)
 K ^TMP($J,"XQAL") S XMSUB="ALERT: "_$P(X,U,3),XMTEXT="^TMP($J,""XQAL"","
"RTN","XQALFWD",58,0)
 S ^TMP($J,"XQAL",1)=$P(X,U,3),^TMP($J,"XQAL",2)="  Forwarded by: "_$P(^VA(200,XQAUSER,0),U)_"       Generated: "_$$DAT8^XQALERT($P($P(X,U,2),";",3),1) S:$G(XQACOMNT)'="" ^TMP($J,"XQAL",3)=XQACOMNT
"RTN","XQALFWD",59,0)
 D ^XMD
"RTN","XQALFWD",60,0)
 Q
"RTN","XQALFWD",61,0)
 ;
"RTN","XQALFWD",62,0)
PRNT ;
"RTN","XQALFWD",63,0)
 I $D(XQALST)=1,XQALST>0 S X=$O(^XTV(8992,"AXQA",XQALST,XQAUSER,0)) I X'="" S X=$G(^XTV(8992,XQAUSER,"XQA",X,0)) I X'="" D PRNT1
"RTN","XQALFWD",64,0)
 S I="" F  S I=$O(XQALST(I)) Q:I=""  S X=$O(^XTV(8992,"AXQA",XQALST(I),XQAUSER,0)) I X'="" S X=$G(^XTV(8992,XQAUSER,"XQA",X,0)) I X'="" D PRNT1
"RTN","XQALFWD",65,0)
 Q
"RTN","XQALFWD",66,0)
PRNT1 ;
"RTN","XQALFWD",67,0)
 U IO W @IOF
"RTN","XQALFWD",68,0)
 W !!,"ALERT:  "_$P(X,U,3),!!,"   Forwarded by: ",$P(^VA(200,XQAUSER,0),U),"    Generated on: ",$$DAT8^XQALERT($P($P(X,U,2),";",3)),!!,$G(XQACOMNT)
"RTN","XQALFWD",69,0)
 Q
"RTN","XQALSET")
0^1^B22056543
"RTN","XQALSET",1,0)
XQALSET ;ISC-SF.SEA/JLI - SETUP ALERTS ;8/22/95  08:41
"RTN","XQALSET",2,0)
 ;;8.0;KERNEL;**1,6**;Jul 10, 1995
"RTN","XQALSET",3,0)
 ;;
"RTN","XQALSET",4,0)
 Q
"RTN","XQALSET",5,0)
 ;
"RTN","XQALSET",6,0)
SETUP Q:$O(XQA(0))=""  Q:'($D(XQAMSG)#2)  Q:XQAMSG=""  N X,XQI,XQJ,XQX,XQK,XQACOMNT,XQARESET,DA
"RTN","XQALSET",7,0)
 S XQAOPT1=$S('($D(XQAROU)#2):U,XQAROU'[U:U_XQAROU,1:XQAROU),XQAOPT1=$S(XQAOPT1'=U:XQAOPT1,$D(XQAOPT)#2:XQAOPT_U,1:XQAOPT1) S:XQAOPT1=U XQAOPT1=U_" "
"RTN","XQALSET",8,0)
NOW S XQX=$$NOW^XLFDT()
"RTN","XQALSET",9,0)
 S:$S('$D(XQAID):1,XQAID="":1,1:0) XQAID="NO-ID"
"RTN","XQALSET",10,0)
 S:XQAID[";" XQAID=$P(XQAID,";") S XQA1=XQAID I XQA1'="" F XQI=0:1 S XQAID=XQA1_";"_DUZ_";"_(XQI*.00000001+XQX) L +^XTV(8992,"AXQA",XQAID) D  L -^XTV(8992,"AXQA",XQAID) Q:XQI=""  S XQAID=XQAID+.00000001
"RTN","XQALSET",11,0)
 . I $D(^XTV(8992,"AXQA",XQAID)) Q
"RTN","XQALSET",12,0)
 . S ^XTV(8992,"AXQA",XQAID,0,0)="",XQI=""
"RTN","XQALSET",13,0)
 I XQAID'="" D
"RTN","XQALSET",14,0)
 . N FDA,IENS,XQA2,DIERR
"RTN","XQALSET",15,0)
 . S XQA2=XQA1 I XQA2[",",$P(XQA2,",",3)'="" S XQA2=$P(XQA2,",")_","_$P(XQA2,",",3)
"RTN","XQALSET",16,0)
 . F  D  Q:'$D(DIERR)  Q:'$D(^TMP("DIERR",$J,"E",111))
"RTN","XQALSET",17,0)
 . . K DIERR,^TMP("DIERR",$J)
"RTN","XQALSET",18,0)
 . . S FDA=$NA(^TMP($J,"XQALSET")) K @FDA
"RTN","XQALSET",19,0)
 . . S @FDA@(8992.1,"+1,",.01)=XQAID D UPDATE^DIE("",FDA,"IENS")
"RTN","XQALSET",20,0)
 . . K @FDA
"RTN","XQALSET",21,0)
 . I $D(DIERR) S XQDIERR1=DIERR M XQDIERR=^TMP("DIERR",$J) Q
"RTN","XQALSET",22,0)
 . Q:IENS(1)'>0  S (DA,XQADA)=IENS(1)
"RTN","XQALSET",23,0)
 . S IENS=IENS(1)_",",@FDA@(8992.1,IENS,.02)=XQX,^(.03)=XQA2,^(.05)=DUZ,^(1.01)=XQAMSG
"RTN","XQALSET",24,0)
 . I $D(XQAARCH) S X=$$FMADD^XLFDT(DT,XQAARCH) I X>DT S @FDA@(8992.1,IENS,.08)=X
"RTN","XQALSET",25,0)
 . I $P(XQA1,",",2)>0 S @FDA@(8992.1,IENS,.04)=$P(XQA1,",",2)
"RTN","XQALSET",26,0)
 . I $D(ZTQUEUED) S @FDA@(8992.1,IENS,.06)=1
"RTN","XQALSET",27,0)
 . I $D(XQAOPT)#2 S @FDA@(8992.1,IENS,1.02)=XQAOPT
"RTN","XQALSET",28,0)
 . I $D(XQAROU)#2 S XQAXX=$S(XQAROU[U:XQAROU,1:U_XQAROU) I $P(XQAXX,U,2)'="" S:$P(XQAXX,U)'="" @FDA@(8992.1,IENS,1.03)=$P(XQAXX,U) S @FDA@(8992.1,IENS,1.04)=$P(XQAXX,U,2)
"RTN","XQALSET",29,0)
 . I $D(XQACTMSG) S @FDA@(8992.1,IENS,1.05)=XQACTMSG
"RTN","XQALSET",30,0)
 . I $D(XQADATA) S @FDA@(8992.1,IENS,2)=XQADATA
"RTN","XQALSET",31,0)
 . D FILE^DIE("KS",FDA)
"RTN","XQALSET",32,0)
REENT S XQALIN1=$S($D(XQAID)#2:XQAID,1:"")_U_$E(XQAMSG,1,80)_"^1^"_$S(XQAOPT1=U:"D",1:"R")_U_$S($D(XQACTMSG):$E(XQACTMSG,1,40),1:"")_U_XQAOPT1 S:$D(XQASURO) $P(XQALIN1,U,12)=XQASURO S:$D(XQASUPV) $P(XQALIN1,U,13)=XQASUPV
"RTN","XQALSET",33,0)
 S XQALIN=XQX_U_XQALIN1,XQJ=0
"RTN","XQALSET",34,0)
 K XQALIN1 S:$D(XQADATA) XQALIN1=XQADATA
"RTN","XQALSET",35,0)
LOOP1 S XQJ=$O(XQA(" ")) I XQJ'="" K:"G.g."'[$E(XQJ_",,",1,2) XQA(XQJ) D:$D(XQA(XQJ)) GROUP G LOOP1
"RTN","XQALSET",36,0)
 S XQJ=0
"RTN","XQALSET",37,0)
LOOP S XQJ=$O(XQA(XQJ)) G:XQJ="" WRAP
"RTN","XQALSET",38,0)
 I $G(XQADA)>0 D
"RTN","XQALSET",39,0)
 . S XQATOP=$S($D(^XTV(8992.1,XQADA,20,0)):$P(^(0),U,4),1:0)+1 S ^(0)="^8992.11^"_XQJ_U_XQATOP
"RTN","XQALSET",40,0)
 . S ^XTV(8992.1,XQADA,20,XQATOP,0)=XQJ,^XTV(8992.1,"R",XQJ,XQADA,XQATOP)="",^XTV(8992.1,XQADA,20,"B",XQJ,XQATOP)="" I $D(XQARESET) S $P(^XTV(8992.1,XQADA,20,XQATOP,0),U,7,8)=XQAUSER_U_XQX
"RTN","XQALSET",41,0)
 I '$D(^XTV(8992,XQJ,0)) D
"RTN","XQALSET",42,0)
 . N FDA,IENS
"RTN","XQALSET",43,0)
 . F  D  Q:'$D(DIERR)  Q:'$D(^TMP("DIERR",$J,"E",110))&'$D(^TMP("DIERR",$J,"E",111))
"RTN","XQALSET",44,0)
 . . K DIERR,^TMP("DIERR",$J)
"RTN","XQALSET",45,0)
 . . S FDA=$NA(^TMP($J,"XQALSET")) K @FDA S @FDA@(8992,"+1,",.01)=XQJ
"RTN","XQALSET",46,0)
 . . S IENS(1)=XQJ
"RTN","XQALSET",47,0)
 . . D UPDATE^DIE("S",FDA,"IENS")
"RTN","XQALSET",48,0)
 S XQXI=XQX S:'$D(^XTV(8992,XQJ,"XQA",0)) ^(0)="^8992.01DA^"
"RTN","XQALSET",49,0)
REP I $D(^XTV(8992,XQJ,"XQA",XQXI,0)) S XQXI=XQXI+.00000001 G REP
"RTN","XQALSET",50,0)
 S ^XTV(8992,XQJ,"XQA",XQXI,0)=XQALIN S:$D(XQALIN1) ^(1)=XQALIN1 S:$D(XQARESET) ^(2)=XQAUSER_U_XQX_U_$G(XQACOMNT) S ^(0)=$P(^XTV(8992,XQJ,"XQA",0),U,1,2)_U_XQXI_U_($P(^(0),U,4)+1)
"RTN","XQALSET",51,0)
 K XQA(XQJ) S:XQAID'="" ^XTV(8992,"AXQA",XQAID,XQJ,XQXI)="",^XTV(8992,"AXQAN",XQA1,XQJ,XQXI)=""
"RTN","XQALSET",52,0)
 G LOOP
"RTN","XQALSET",53,0)
WRAP K:XQAID'="" ^XTV(8992,"AXQA",XQAID,0,0) K XQA,XQALIN,XQALIN1,XQAMSG,XQAID,XQAFLG,XQAOPT,XQAOPT1,XQAROU,XQADATA,XQI,XQX,XQJ,XQK,XQA1,XQACTMSG,XQJ,XQXI,XQAARCH
"RTN","XQALSET",54,0)
 Q
"RTN","XQALSET",55,0)
 ;
"RTN","XQALSET",56,0)
GROUP S XQL="" F XQI=3:1:$L(XQJ) S XQL1=$E(XQJ,XQI) S:XQL1?1L XQL1=$C($A(XQL1)-32) S XQL=XQL_XQL1
"RTN","XQALSET",57,0)
 S XQI=$O(^XMB(3.8,"B",XQL,0)) I XQI'>0 S XQL1=$O(^XMB(3.8,"B",XQL)) I $E(XQL1,1,$L(XQL))=XQL S XQL2=$O(^(XQL1)) I $E(XQL2,1,$L(XQL))'=XQL S XQI=$O(^(XQL1,0))
"RTN","XQALSET",58,0)
 I XQI>0 F XQL=0:0 S XQL=$O(^XMB(3.8,XQI,1,XQL)) Q:XQL'>0  S XQA(+^(XQL,0))=""
"RTN","XQALSET",59,0)
 K XQA(XQJ),XQI,XQL,XQL1,XQL2
"RTN","XQALSET",60,0)
 Q
"RTN","XQALSET",61,0)
 ;
"RTN","XQALSET",62,0)
RESETUP(XQAIDVAL,XQA,XQACOMNT) ;
"RTN","XQALSET",63,0)
 N XQAIEN,DA,XQI,XQJ,XQK,XQX
"RTN","XQALSET",64,0)
 S:'$D(XQAUSER) XQAUSER=DUZ
"RTN","XQALSET",65,0)
 S XQARESET=1
"RTN","XQALSET",66,0)
 S XQAIEN=$O(^XTV(8992,"AXQA",XQAIDVAL,XQAUSER,0))
"RTN","XQALSET",67,0)
 S X=$G(^XTV(8992,XQAUSER,"XQA",XQAIEN,0)),X1=$G(^(1))
"RTN","XQALSET",68,0)
 Q:X=""
"RTN","XQALSET",69,0)
 S XQAID=$P(X,U,2),XQA1=$P(XQAID,";"),XQADA=$O(^XTV(8992.1,"B",XQAID,0))
"RTN","XQALSET",70,0)
 S XQAOPT1=$P(X,U,7,8),XQAMSG=$P(X,U,3),XQACTMSG=$P(X,U,6)
"RTN","XQALSET",71,0)
 S XQADATA=$S(X1'="":X1,1:$P(X,U,9,100))
"RTN","XQALSET",72,0)
 S XQX=$$NOW^XLFDT()
"RTN","XQALSET",73,0)
 D REENT
"RTN","XQALSET",74,0)
 Q
"VER")
8.0^21.0
**END**
**END**
