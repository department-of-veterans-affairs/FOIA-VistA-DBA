Released XU*8*125 SEQ #114
Extracted from mail message
**KIDS**:XU*8.0*125^

**INSTALL NAME**
XU*8.0*125
"BLD",182,0)
XU*8.0*125^KERNEL^0^2991007^y
"BLD",182,4,0)
^9.64PA^8992^1
"BLD",182,4,8992,0)
8992
"BLD",182,4,8992,2,0)
^9.641^8992.01^1
"BLD",182,4,8992,2,8992.01,0)
ALERT DATE/TIME  (sub-file)
"BLD",182,4,8992,2,8992.01,1,0)
^9.6411^.02^1
"BLD",182,4,8992,2,8992.01,1,.02,0)
ALERT ID
"BLD",182,4,8992,222)
y^y^p^^^^n
"BLD",182,4,"APDD",8992,8992.01)

"BLD",182,4,"APDD",8992,8992.01,.02)

"BLD",182,4,"B",8992,8992)

"BLD",182,"INID")
^n
"BLD",182,"INIT")
XU8P125
"BLD",182,"KRN",0)
^9.67PA^19^18
"BLD",182,"KRN",.4,0)
.4
"BLD",182,"KRN",.401,0)
.401
"BLD",182,"KRN",.402,0)
.402
"BLD",182,"KRN",.403,0)
.403
"BLD",182,"KRN",.5,0)
.5
"BLD",182,"KRN",.84,0)
.84
"BLD",182,"KRN",3.6,0)
3.6
"BLD",182,"KRN",3.8,0)
3.8
"BLD",182,"KRN",9.2,0)
9.2
"BLD",182,"KRN",9.8,0)
9.8
"BLD",182,"KRN",9.8,"NM",0)
^9.68A^5^5
"BLD",182,"KRN",9.8,"NM",1,0)
XQALERT^^0^B10180014
"BLD",182,"KRN",9.8,"NM",2,0)
XQALERT1^^0^B75342331
"BLD",182,"KRN",9.8,"NM",3,0)
XQALSET^^0^B30914838
"BLD",182,"KRN",9.8,"NM",4,0)
XQALBUTL^^0^B9566859
"BLD",182,"KRN",9.8,"NM",5,0)
XQALSURO^^0^B18431726
"BLD",182,"KRN",9.8,"NM","B","XQALBUTL",4)

"BLD",182,"KRN",9.8,"NM","B","XQALERT",1)

"BLD",182,"KRN",9.8,"NM","B","XQALERT1",2)

"BLD",182,"KRN",9.8,"NM","B","XQALSET",3)

"BLD",182,"KRN",9.8,"NM","B","XQALSURO",5)

"BLD",182,"KRN",19,0)
19
"BLD",182,"KRN",19.1,0)
19.1
"BLD",182,"KRN",101,0)
101
"BLD",182,"KRN",409.61,0)
409.61
"BLD",182,"KRN",771,0)
771
"BLD",182,"KRN",869.2,0)
869.2
"BLD",182,"KRN",870,0)
870
"BLD",182,"KRN",8994,0)
8994
"BLD",182,"KRN","B",.4,.4)

"BLD",182,"KRN","B",.401,.401)

"BLD",182,"KRN","B",.402,.402)

"BLD",182,"KRN","B",.403,.403)

"BLD",182,"KRN","B",.5,.5)

"BLD",182,"KRN","B",.84,.84)

"BLD",182,"KRN","B",3.6,3.6)

"BLD",182,"KRN","B",3.8,3.8)

"BLD",182,"KRN","B",9.2,9.2)

"BLD",182,"KRN","B",9.8,9.8)

"BLD",182,"KRN","B",19,19)

"BLD",182,"KRN","B",19.1,19.1)

"BLD",182,"KRN","B",101,101)

"BLD",182,"KRN","B",409.61,409.61)

"BLD",182,"KRN","B",771,771)

"BLD",182,"KRN","B",869.2,869.2)

"BLD",182,"KRN","B",870,870)

"BLD",182,"KRN","B",8994,8994)

"BLD",182,"QUES",0)
^9.62^^
"BLD",182,"REQB",0)
^9.611^^
"FIA",8992)
ALERT
"FIA",8992,0)
^XTV(8992,
"FIA",8992,0,0)
8992PA
"FIA",8992,0,1)
y^y^p^^^^n
"FIA",8992,0,10)

"FIA",8992,0,11)

"FIA",8992,0,"RLRO")

"FIA",8992,0,"VR")
8.0^XU
"FIA",8992,8992)
1
"FIA",8992,8992.01)
1
"FIA",8992,8992.01,.02)

"INIT")
XU8P125
"MBREQ")
0
"PKG",3,-1)
1^1
"PKG",3,0)
KERNEL^XU^SIGN-ON, SECURITY, MENU DRIVER, DEVICES, TASKMAN^
"PKG",3,20,0)
^9.402P^^
"PKG",3,22,0)
^9.49I^1^1
"PKG",3,22,1,0)
8.0^2950703^2970507^.5
"PKG",3,22,1,"PAH",1,0)
125^2991007
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
6
"RTN","XQALBUTL")
0^4^B9566859
"RTN","XQALBUTL",1,0)
XQALBUTL ; slc/CLA,ISC-SF.SEA/JLI - Utilities for OE/RR notifications ;09/03/99  11:21
"RTN","XQALBUTL",2,0)
 ;;8.0;KERNEL;**114,125**;Jul 10, 1995
"RTN","XQALBUTL",3,0)
 ; PROVIDES FUNCTIONALITY USED BY ORBUTL
"RTN","XQALBUTL",4,0)
EN ;
"RTN","XQALBUTL",5,0)
 Q
"RTN","XQALBUTL",6,0)
RECIPURG(XQX) ;called by option ORB PURG RECIP - purge existing notifs: recipient/DUZ
"RTN","XQALBUTL",7,0)
 N XQK,XQA,XQADAT S XQADAT=$$NOW^XLFDT()
"RTN","XQALBUTL",8,0)
 F XQK=0:0 S XQK=$O(^XTV(8992,XQX,"XQA",XQK)) Q:XQK'>0  S XQA=$P(^(XQK,0),"^",2) D OLDPURG
"RTN","XQALBUTL",9,0)
 Q
"RTN","XQALBUTL",10,0)
 ;
"RTN","XQALBUTL",11,0)
PTPURG(DFN) ;called by option ORB PURG PATIENT - purge existing notifs: patient
"RTN","XQALBUTL",12,0)
 N XQX,XQK,XQA,XQADAT S XQADAT=$$NOW^XLFDT()
"RTN","XQALBUTL",13,0)
 F XQX=0:0 S XQX=$O(^XTV(8992,XQX)) Q:XQX'>0  F XQK=0:0 S XQK=$O(^XTV(8992,XQX,"XQA",XQK)) Q:XQK'>0  S XQA=$P(^(XQK,0),"^",2) I $P($P(XQA,";"),",",2)=DFN D OLDPURG
"RTN","XQALBUTL",14,0)
 Q
"RTN","XQALBUTL",15,0)
 ;
"RTN","XQALBUTL",16,0)
NOTIPURG(Y) ;called by option ORB PURG NOTIF - purge existing notifs: notification
"RTN","XQALBUTL",17,0)
 N XQX,XQK,XQA,XQADAT S XQADAT=$$NOW^XLFDT()
"RTN","XQALBUTL",18,0)
 F XQX=0:0 S XQX=$O(^XTV(8992,XQX)) Q:XQX'>0  F XQK=0:0 S XQK=$O(^XTV(8992,XQX,"XQA",XQK)) Q:XQK'>0  S XQA=$P(^(XQK,0),"^",2) I $P($P(XQA,";"),",",3)=+Y D OLDPURG
"RTN","XQALBUTL",19,0)
 Q
"RTN","XQALBUTL",20,0)
OLDPURG ;called by RECIPURG, PTPURG, NOTIPURG - KILLs specified alert entries
"RTN","XQALBUTL",21,0)
 N XQAID S XQAID=XQA D DELA^XQALDEL ; JLI 9-3-99 FIXES NULL SUBSCRIPT IN DELA+1^XQALDEL
"RTN","XQALBUTL",22,0)
 Q
"RTN","XQALBUTL",23,0)
 ;
"RTN","XQALBUTL",24,0)
AHISTORY(XQAID,ROOT) ; SR  Returns information from alert tracking file for alert with XQAID as its alert ID.  The data is returned desendent from the closed root passed in ROOT.
"RTN","XQALBUTL",25,0)
 N X
"RTN","XQALBUTL",26,0)
 K @ROOT
"RTN","XQALBUTL",27,0)
 S X=$O(^XTV(8992.1,"B",XQAID,0)) I X'>0 Q
"RTN","XQALBUTL",28,0)
 M @ROOT=^XTV(8992.1,X)
"RTN","XQALBUTL",29,0)
 Q
"RTN","XQALBUTL",30,0)
 ;
"RTN","XQALBUTL",31,0)
PENDING(XQAUSER,XQAID) ; SR. Returns whether the user specified has the alert indicated by XQAID pending.  (1=YES, 0=NO)
"RTN","XQALBUTL",32,0)
 Q $D(^XTV(8992,"AXQA",XQAID,XQAUSER))/10
"RTN","XQALBUTL",33,0)
 ;
"RTN","XQALBUTL",34,0)
PKGPEND(XQAUSER,XQAPKG) ; SR. Returns 1 if the user indicated by XQAUSER has any pending alerts with the first ';'-piece of XQAID contains the package identifier indicated by XQAPKG.
"RTN","XQALBUTL",35,0)
 N I,X
"RTN","XQALBUTL",36,0)
 F I=0:0 S X="",I=$O(^XTV(8992,XQAUSER,"XQA",I)) Q:I'>0  S X=$P($P(^(I,0),U,2),";") I X[XQAPKG Q
"RTN","XQALBUTL",37,0)
 Q $S(X'="":1,1:0)
"RTN","XQALBUTL",38,0)
 ;
"RTN","XQALBUTL",39,0)
ALERTDAT(XQAID,ROOT) ; SR. Returns information from alert tracking file for alert with XQAID in array XQALERTD.  If the alert is not present, the array is undefined.
"RTN","XQALBUTL",40,0)
 N IEN
"RTN","XQALBUTL",41,0)
 I $G(ROOT)="" S ROOT="XQALERTD"
"RTN","XQALBUTL",42,0)
 K @ROOT
"RTN","XQALBUTL",43,0)
 S IEN=$O(^XTV(8992.1,"B",XQAID,0)) I IEN'>0 S @ROOT="" Q
"RTN","XQALBUTL",44,0)
 D MAKELIST(ROOT,8992.1,(IEN_","))
"RTN","XQALBUTL",45,0)
 Q
"RTN","XQALBUTL",46,0)
USERLIST(XQAID,ROOT) ; SR. Returns recipients of alert with ID of XQAID from alert tracking file in array XQALUSER
"RTN","XQALBUTL",47,0)
 N IEN,N,I,X
"RTN","XQALBUTL",48,0)
 I $G(ROOT)="" S ROOT="XQALUSRS"
"RTN","XQALBUTL",49,0)
 K @ROOT
"RTN","XQALBUTL",50,0)
 S IEN=$O(^XTV(8992.1,"B",XQAID,0)) I IEN'>0 S @ROOT="" Q
"RTN","XQALBUTL",51,0)
 S N=0 F I=0:0 S I=$O(^XTV(8992.1,IEN,20,I)) Q:I'>0  S N=N+1,X=+^(I,0),X=X_U_$$GET1^DIQ(8992.11,(I_","_IEN_","),.01),@ROOT@(N)=X
"RTN","XQALBUTL",52,0)
 Q
"RTN","XQALBUTL",53,0)
USERDATA(XQAID,XQAUSER,ROOT) ; SR. returns information from alert tracking file related to alert with ID of XQAID for user specified by XQAUSER
"RTN","XQALBUTL",54,0)
 N IEN,IEN2
"RTN","XQALBUTL",55,0)
 I $G(ROOT)="" S ROOT="XQALUSER"
"RTN","XQALBUTL",56,0)
 K @ROOT
"RTN","XQALBUTL",57,0)
 S IEN=$O(^XTV(8992.1,"B",XQAID,0)) I IEN'>0 S @ROOT="" Q
"RTN","XQALBUTL",58,0)
 S IEN2=$O(^XTV(8992.1,IEN,20,"B",XQAUSER,0)) I IEN2'>0 S @ROOT="" Q
"RTN","XQALBUTL",59,0)
 D MAKELIST(ROOT,8992.11,(IEN2_","_IEN_","))
"RTN","XQALBUTL",60,0)
 Q
"RTN","XQALBUTL",61,0)
MAKELIST(ARRAY,FILE,IENS) ; Makes a list of fields as subscripts in ARRAY with the values of the fields as the value.  If internal and external differ, the value is given as internal^external.
"RTN","XQALBUTL",62,0)
 N ROOT,FIELD,X
"RTN","XQALBUTL",63,0)
 K @ARRAY
"RTN","XQALBUTL",64,0)
 S ROOT=$NA(^TMP("XQALMAKELIST",$J))
"RTN","XQALBUTL",65,0)
 K @ROOT
"RTN","XQALBUTL",66,0)
 D GETS^DIQ(FILE,IENS,"*","IE",ROOT)
"RTN","XQALBUTL",67,0)
 F FIELD=0:0 S FIELD=$O(@ROOT@(FILE,IENS,FIELD)) Q:FIELD'>0  S X=^(FIELD,"I") S:X'=^("E") X=X_U_^("E") S @ARRAY@(FIELD)=X,@ARRAY@(FIELD,$$GET1^DID(FILE,FIELD,"","LABEL"))=""
"RTN","XQALBUTL",68,0)
 K @ROOT
"RTN","XQALBUTL",69,0)
 Q
"RTN","XQALERT")
0^1^B10180014
"RTN","XQALERT",1,0)
XQALERT ;ISC-SF.SEA/JLI - ALERT HANDLER ;09/03/99  11:21
"RTN","XQALERT",2,0)
 ;;8.0;KERNEL;**1,65,125**;Jul 05, 1995
"RTN","XQALERT",3,0)
 ;;
"RTN","XQALERT",4,0)
 Q
"RTN","XQALERT",5,0)
 ;
"RTN","XQALERT",6,0)
SETUP ;SR.
"RTN","XQALERT",7,0)
 D SETUP^XQALSET
"RTN","XQALERT",8,0)
 Q
"RTN","XQALERT",9,0)
 ;
"RTN","XQALERT",10,0)
DISPLAY ;SR. Display any new alerts
"RTN","XQALERT",11,0)
 Q:$O(^XTV(8992,DUZ,"XQA",0))'>0
"RTN","XQALERT",12,0)
 N X,XQI,XQX,XQX1,DIR,XQA,Y S XQX=0,XQX1=0,Y=1,DIR(0)="E"
"RTN","XQALERT",13,0)
 F XQI=0:0 D:XQX1&'(XQX1#20) ^DIR Q:'Y  S XQI=$O(^XTV(8992,DUZ,"XQA",XQI)) Q:XQI'>0  S XQX=XQX+1,X=$G(^XTV(8992,DUZ,"XQA",XQI,0)) I $P(X,U,4) D
"RTN","XQALERT",14,0)
 . N XQXXX,XQXX,XQXY
"RTN","XQALERT",15,0)
 . S XQXXX=X,(XQXX,XQXY)=0,XQXX=$P(X,U,2) I XQXX'="" S XQXX=$O(^XTV(8992.1,"B",$E(XQXX,1,30),0)) I XQXX>0 S XQXY=$O(^XTV(8992.1,XQXX,20,"B",DUZ,0)) I XQXY>0 S XQXDAT=$$NOW^XLFDT(),$P(^XTV(8992.1,XQXX,20,XQXY,0),U,2)=XQXDAT
"RTN","XQALERT",16,0)
 . S X=XQXXX W:XQX1=0 $C(7) W !,$P(X,U,3) S XQX1=XQX1+1,$P(^XTV(8992,DUZ,"XQA",XQI,0),U,4)="" I $D(^(2)) S X1=^(2) D
"RTN","XQALERT",17,0)
 . . S X2=$P(X1,U,3)
"RTN","XQALERT",18,0)
 . . W !?5,"*** FORWARDED BY: ",$P(^VA(200,+X1,0),U),"   Generated: " S X1=$P($P(X,U,2),";",3) W $$DAT8(X1,1)
"RTN","XQALERT",19,0)
 . . I X2'="" W !?5,X2
"RTN","XQALERT",20,0)
 . I $P(X,U,5)="D" S XQA=$P(X,U,2) K ^XTV(8992,DUZ,"XQA",XQI) D  S XQX=XQX-1 D:XQA'="" D
"RTN","XQALERT",21,0)
 . . I $G(XQXX)>0,$G(XQXY)>0 S $P(^XTV(8992.1,XQXX,20,XQXY,0),U,5)=XQXDAT
"RTN","XQALERT",22,0)
 . K XQXX,XQXY
"RTN","XQALERT",23,0)
 I XQX>0 W:XQX1=0 !!,"You have PENDING ALERTS" W !?10,"Enter  ""VA   VIEW ALERTS     to review alerts",!
"RTN","XQALERT",24,0)
 W:XQX1>0 !
"RTN","XQALERT",25,0)
 K XQI,XQX,XQX1,DIR,XQA,Y
"RTN","XQALERT",26,0)
 Q
"RTN","XQALERT",27,0)
D K ^XTV(8992,"AXQA",XQA,DUZ),^XTV(8992,"AXQAN",$P(XQA,";"),DUZ)
"RTN","XQALERT",28,0)
 Q
"RTN","XQALERT",29,0)
 ;
"RTN","XQALERT",30,0)
 ;
"RTN","XQALERT",31,0)
DAT8(FMDAT,TFLG) ;
"RTN","XQALERT",32,0)
 N X
"RTN","XQALERT",33,0)
 S X=$E(FMDAT,4,5)_"/"_$E(FMDAT,6,7)_"/"_$E(FMDAT,2,3)
"RTN","XQALERT",34,0)
 I $G(TFLG)>0 S FMDAT=FMDAT_"0000000",X=X_" "_$E(FMDAT,9,10)_":"_$E(FMDAT,11,12)_":"_$E(FMDAT,13,14)
"RTN","XQALERT",35,0)
 Q X
"RTN","XQALERT",36,0)
DOIT ;OPT. Process Alerts
"RTN","XQALERT",37,0)
 N XQALAST,XQALFWD,XQAUSER K DTOUT,DIRUT,DUOUT,DIROUT
"RTN","XQALERT",38,0)
 S XQAUSER=DUZ D DOIT^XQALERT1,COUNT^XQALDEL(0,XQAUSER)
"RTN","XQALERT",39,0)
 Q
"RTN","XQALERT",40,0)
 ;
"RTN","XQALERT",41,0)
DELETE ;
"RTN","XQALERT",42,0)
 D DELETE^XQALDEL
"RTN","XQALERT",43,0)
 Q
"RTN","XQALERT",44,0)
 ;
"RTN","XQALERT",45,0)
DELETEA ;
"RTN","XQALERT",46,0)
 D DELETEA^XQALDEL
"RTN","XQALERT",47,0)
 Q
"RTN","XQALERT",48,0)
 ;
"RTN","XQALERT",49,0)
OLDDEL ;OPT.
"RTN","XQALERT",50,0)
 D OLDDEL^XQALDEL
"RTN","XQALERT",51,0)
 Q
"RTN","XQALERT",52,0)
 ;
"RTN","XQALERT",53,0)
USERDEL ;OPT.
"RTN","XQALERT",54,0)
 D USERDEL^XQALDEL
"RTN","XQALERT",55,0)
 Q
"RTN","XQALERT",56,0)
 ;
"RTN","XQALERT",57,0)
USER(ROOT,XQAUSER,FRSTDATE,LASTDATE) ; Returns current alerts for the user in an array located under root
"RTN","XQALERT",58,0)
 I '$D(XQAUSER) S XQAUSER=DUZ
"RTN","XQALERT",59,0)
 D GETUSER^XQALDATA(ROOT,XQAUSER,$G(FRSTDATE),$G(LASTDATE))
"RTN","XQALERT",60,0)
 Q
"RTN","XQALERT",61,0)
 ;
"RTN","XQALERT",62,0)
PATIENT(ROOT,PATIENT,FRSTDATE,LASTDATE) ;
"RTN","XQALERT",63,0)
 I $G(PATIENT)'>0 Q
"RTN","XQALERT",64,0)
 D GETPAT^XQALDATA(ROOT,PATIENT,$G(FRSTDATE),$G(LASTDATE))
"RTN","XQALERT",65,0)
 Q
"RTN","XQALERT",66,0)
ACTION(ALERTID) ;
"RTN","XQALERT",67,0)
 D ACTION^XQALDOIT(ALERTID)
"RTN","XQALERT",68,0)
 Q
"RTN","XQALERT",69,0)
GETACT(ALERTID) ; Return to calling routine the information needed to act on
"RTN","XQALERT",70,0)
 ; the specified alert.
"RTN","XQALERT",71,0)
 ; On return the following variables are defined:
"RTN","XQALERT",72,0)
 ;  XQAID = the full alert id
"RTN","XQALERT",73,0)
 ;  XQADATA = Any data passed as XQADATA at the time the alert was generated
"RTN","XQALERT",74,0)
 ;  XQAROU  = Indicates routine to be run (includes tag if necessary)
"RTN","XQALERT",75,0)
 ;    This value may have three meanings
"RTN","XQALERT",76,0)
 ;      1.  A null value indicates no routine to be used (XQAOPT contains
"RTN","XQALERT",77,0)
 ;          option name to be run)
"RTN","XQALERT",78,0)
 ;      2.  A value of ^<space>  indicates that the alert is information
"RTN","XQALERT",79,0)
 ;          only (no routine or option action involved).
"RTN","XQALERT",80,0)
 ;      3.  The name of the routine as ^ROUTINE  or TAG^ROUTINE
"RTN","XQALERT",81,0)
 ;  XQAOPT  = Indicates the name of the option to be run if not null.
"RTN","XQALERT",82,0)
 ;
"RTN","XQALERT",83,0)
 N XQX,XQZ,XQAGETAC
"RTN","XQALERT",84,0)
 S XQAGETAC=1,XQX="",XQZ=""
"RTN","XQALERT",85,0)
 D ACTION^XQALDOIT(ALERTID)
"RTN","XQALERT",86,0)
 S XQAID=$P(XQX,U,2)
"RTN","XQALERT",87,0)
 S XQADATA=$S(XQZ'="":XQZ,1:$P(XQX,U,9,99))
"RTN","XQALERT",88,0)
 S XQAROU=$S($P(XQX,U,8)="":"",1:$P(XQX,U,7,8))
"RTN","XQALERT",89,0)
 S XQAOPT=$S($P(XQX,U,8)="":$P(XQX,U,7),1:"")
"RTN","XQALERT",90,0)
 Q
"RTN","XQALERT",91,0)
 Q
"RTN","XQALERT1")
0^2^B75342331
"RTN","XQALERT1",1,0)
XQALERT1 ;ISC-SF.SEA/JLI - ALERT HANDLER ;09/03/99  11:21
"RTN","XQALERT1",2,0)
 ;;8.0;KERNEL;**20,65,114,123,125**;Jul 10, 1995
"RTN","XQALERT1",3,0)
 ;;
"RTN","XQALERT1",4,0)
 Q
"RTN","XQALERT1",5,0)
 ;
"RTN","XQALERT1",6,0)
DOIT I $D(XQX1),XQX1'>0 K XQX1
"RTN","XQALERT1",7,0)
 I $D(XQAID) D  I '$D(XQAID) G EXIT
"RTN","XQALERT1",8,0)
 . N XQACHOIC,REASK S REASK=0
"RTN","XQALERT1",9,0)
 . I '$D(XQX1),$O(^XTV(8992,XQAUSER,"XQA",+$O(^XTV(8992,XQAUSER,"XQA",0))))'>0,$G(XQAROUX)="^ " S XQAROU=""
"RTN","XQALERT1",10,0)
AGAIN . S XQACHOIC="Y:YES;N:NO;C:CONTINUE;",XQA("?")="Enter Y (or C) to continue, N to exit alert processing"
"RTN","XQALERT1",11,0)
 . S XQACHOIC=$G(XQACHOIC)_"F:FORWARD ALERT;R:RENEW(MAKE NEW AGAIN);" S XQA("?",1)="Enter F to forward this alert to someone else",XQA("?",2)="Enter R to Renew (Make New) this alert"
"RTN","XQALERT1",12,0)
 . D  I REASK=1 G AGAIN
"RTN","XQALERT1",13,0)
 . . S REASK=0 W !! K DIR S DIR(0)="SA^"_XQACHOIC,DIR("A")=$S(XQACHOIC["F:":"Continue (Y/N) or F(orward) or R(enew) ",1:"Continue Processing (Y/N) "),DIR("B")="YES" D ^DIR K DIR
"RTN","XQALERT1",14,0)
 . . I $D(DUOUT)!$D(DIRUT) S Y="N" K DUOUT,DIRUT
"RTN","XQALERT1",15,0)
 . . I Y="N" D:$D(XQAKILL) DELETEA^XQALERT K XQAID
"RTN","XQALERT1",16,0)
 . . I Y="R" S REASK=REASK+1 K XQAKILL I '$D(^XTV(8992,"AXQA",XQAID,DUZ)) D RESTORE
"RTN","XQALERT1",17,0)
 . . I Y="F" D:'$D(^XTV(8992,"AXQA",XQAID,DUZ)) RESTORE D FRWRDONE S REASK=REASK+1
"RTN","XQALERT1",18,0)
 . . Q
"RTN","XQALERT1",19,0)
 . Q
"RTN","XQALERT1",20,0)
 I $D(XQAKILL) D DELETEA^XQALERT
"RTN","XQALERT1",21,0)
 S XQAREV=1,XQXOUT=0,XQK=0,XQACNT=0 K XQADATA,XQAID,XQAROU,XQAKILL,XQAROUX
"RTN","XQALERT1",22,0)
 I '$D(XQX1) S XQX1=0 K ^TMP("XQ",$J,"XQA"),^("XQA1"),^("XQA2") I $O(^XTV(8992,XQAUSER,"XQA",0))'>0 K XQX1 D:'$G(^TMP("XQALERT1",$J,"NOTFIRST")) CHKSURO G EXIT
"RTN","XQALERT1",23,0)
 S ^TMP("XQALERT1",$J,"NOTFIRST")=1 ; Added 2/2/99 jli to clear flag for initial entry
"RTN","XQALERT1",24,0)
 ;Sort and remove display only
"RTN","XQALERT1",25,0)
 I 'XQX1 W !!! D
"RTN","XQALERT1",26,0)
 . D SORT
"RTN","XQALERT1",27,0)
 ; Now display them.
"RTN","XQALERT1",28,0)
SUBLOOP W @IOF
"RTN","XQALERT1",29,0)
 S XQK=0 F XQI=0:0 Q:XQX1!XQXOUT  S XQI=$O(^TMP("XQ",$J,"XQA",XQI)) Q:XQI'>0  S XQX=^(XQI),XQII=^(XQI,1),XQZ=^(2),XQZ1=^(3) D  I XQX'="" D DOIT1
"RTN","XQALERT1",30,0)
 . I '$D(^XTV(8992,XQAUSER,"XQA",XQII)) S XQX="" K ^TMP("XQ",$J,"XQA",XQI),^TMP("XQ",$J,"XQA1",(999999-XQI))
"RTN","XQALERT1",31,0)
 . Q
"RTN","XQALERT1",32,0)
 S:'$D(XQXOUT) XQXOUT=0 G:XQXOUT EXIT G:XQK'>0&'XQX1 EXIT I 'XQX1 D ASK G:XQXOUT EXIT
"RTN","XQALERT1",33,0)
 G:+XQX1=0 EXIT I XQX1<0 S XQX1=0 G DOIT
"RTN","XQALERT1",34,0)
 I $D(XQALDELE)!$D(XQALFWD) Q
"RTN","XQALERT1",35,0)
 ;D WAIT(+XQX1) G:XQXOUT EXIT
"RTN","XQALERT1",36,0)
 G:XQXOUT EXIT
"RTN","XQALERT1",37,0)
 G EN^XQALDOIT
"RTN","XQALERT1",38,0)
 ;
"RTN","XQALERT1",39,0)
RESTORE ; Restore a deleted message for use
"RTN","XQALERT1",40,0)
 N ALERTREF,XTVGLOB,ADUZ,X,X0,X1,X2,TIME,MESG,OPT,TAG,ROU
"RTN","XQALERT1",41,0)
 S XTVGLOB=$NA(^XTV(8992,DUZ,"XQA"))
"RTN","XQALERT1",42,0)
 S ADUZ=$O(^XTV(8992,"AXQA",XQAID,0)) I ADUZ>0 S TIME=$O(^(ADUZ,0)) D  I 1
"RTN","XQALERT1",43,0)
 . M @XTVGLOB@(TIME)=^XTV(8992,ADUZ,"XQA",TIME) K @XTVGLOB@(TIME,2) ; copy alert, kill comment if any
"RTN","XQALERT1",44,0)
 E  S ALERTREF=$O(^XTV(8992.1,"B",XQAID,0)) Q:ALERTREF'>0  D  ; otherwise rebuild from alert tracking file if possible
"RTN","XQALERT1",45,0)
 . S X0=^XTV(8992.1,ALERTREF,0),X1=$G(^(1)),X2=$G(^(2))
"RTN","XQALERT1",46,0)
 . S TIME=$P($P(X0,U),";",3),MESG=$P(X1,U),OPT=$P(X1,U,2),TAG=$P(X1,U,3),ROU=$P(X1,U,4)
"RTN","XQALERT1",47,0)
 . S X=TIME_U_XQAID_U_MESG_U_U_$S(OPT'=""!(ROU'=""):"R",1:"I")_U_U_$S(OPT'="":OPT,TAG'="":TAG,1:"")_U_$S(OPT'="":"",ROU'="":ROU,1:" ")
"RTN","XQALERT1",48,0)
 . S @XTVGLOB@(TIME,0)=X I $G(X2)'="" S ^(1)=X2
"RTN","XQALERT1",49,0)
 S ^XTV(8992,"AXQA",XQAID,DUZ,TIME)="",^XTV(8992,"AXQAN",$E($P(XQAID,";"),1,30),DUZ,TIME)=""
"RTN","XQALERT1",50,0)
 Q
"RTN","XQALERT1",51,0)
 ;
"RTN","XQALERT1",52,0)
EXIT ;
"RTN","XQALERT1",53,0)
 I $G(XQALAST)="I",$G(DUZ("AUTO")) D WAIT2
"RTN","XQALERT1",54,0)
 I $D(XQALDELE)!$D(XQALFWD) Q
"RTN","XQALERT1",55,0)
 K ^TMP("XQ",$J,"XQA"),^("XQA1"),^("XQA2"),XQI,XQX,XQJ,XQK,XQX1,XQX2,XQXOUT,XQ1,XQII,XQACNT,XQA1,XQAREV,%ZIS,XQAROU,XQALAST,XQAROUX
"RTN","XQALERT1",56,0)
 K ^TMP("XQALERT1",$J)
"RTN","XQALERT1",57,0)
 Q
"RTN","XQALERT1",58,0)
 ;
"RTN","XQALERT1",59,0)
 ; CHKSURO added 2/2/99 to give user opportunity to add/remove surrogate if no alerts present
"RTN","XQALERT1",60,0)
CHKSURO ; If user selects process alerts with no alerts present, give him/her the opportunity to add or delete a surrogate
"RTN","XQALERT1",61,0)
 N DIR S DIR(0)="Y",DIR("A")="Do you want to set or remove a surrogate recipient",DIR("?")="A surrogate will receive your alerts until they are removed as surrogate."
"RTN","XQALERT1",62,0)
 I '$G(^TMP("XQALERT1",$J,"NOTFIRST")) S DIR("A",1)="You have no alerts for processing."
"RTN","XQALERT1",63,0)
 D ^DIR K DIR Q:'Y
"RTN","XQALERT1",64,0)
 I $P($G(^XTV(8992,XQAUSER,0)),U,2)'>0 D SURROGAT^XQALSURO I 1
"RTN","XQALERT1",65,0)
 E  D CHKREMV^XQALSURO
"RTN","XQALERT1",66,0)
 Q
"RTN","XQALERT1",67,0)
 ;
"RTN","XQALERT1",68,0)
DOIT1 ;
"RTN","XQALERT1",69,0)
 I XQK=0 S XQALINFO=0 I '$D(XQALFWD) W @IOF
"RTN","XQALERT1",70,0)
 S XQK=XQK+1 W !,$J(XQK,2),".",$S($P(XQX,U,8)=" ":"I",1:" "),"  ",$E($P(XQX,U,3),1,70) S:$P(XQX,U,8)=" " XQALINFO=XQALINFO+1 D:XQZ1'=""
"RTN","XQALERT1",71,0)
 . W !?8,"Forwarded by: ",$P(^VA(200,+XQZ1,0),U),"  Generated: ",$$DAT8^XQALERT(+$P($P(XQX,U,2),";",3),1)
"RTN","XQALERT1",72,0)
 . I $P(XQZ1,U,3)'="" W !?8,$P(XQZ1,U,3)
"RTN","XQALERT1",73,0)
 S ^TMP("XQ",$J,"XQA1",XQK)=XQX,^(XQK,1)=XQII,^(2)=XQZ,^(3)=XQZ1
"RTN","XQALERT1",74,0)
 I ($Y+6)>IOSL N XQKVALUE S XQKVALUE=XQK D ASK0(XQI) S:'$D(XQK) XQK=XQKVALUE Q:XQX1!(XQXOUT)  W @IOF
"RTN","XQALERT1",75,0)
 Q
"RTN","XQALERT1",76,0)
 ;
"RTN","XQALERT1",77,0)
ASK0(XQI) ;Stack XQI
"RTN","XQALERT1",78,0)
ASK ;
"RTN","XQALERT1",79,0)
 N XQALNEWF K XQALAST
"RTN","XQALERT1",80,0)
 ;I '$D(XQALDELE)&'$D(XQALFWD) S XQALNEWF=$P(^XTV(8992,XQAUSER,0),U,5) I XQALNEWF<20 D
"RTN","XQALERT1",81,0)
 ;. N XQALFDA
"RTN","XQALERT1",82,0)
 ;. S XQALNEWF=XQALNEWF+1,XQALFDA=(8992,(XQAUSER_","),.05)=XQALNEWF D FILE^DIE("","XQALFDA")
"RTN","XQALERT1",83,0)
 ;. W !,"NEW OPTIONS: S-to add/remove SURROGATE and D-to selectively Delete SOME alerts"
"RTN","XQALERT1",84,0)
 S XQ1=0,XQXOUT=0 W !?10,"Select from 1 to ",XQK W:$D(XQALDELE) " to DELETE" W:$D(XQALFWD) " to FORWARD"
"RTN","XQALERT1",85,0)
 W !?10,"or enter ?, A, " W:'$D(XQALDELE)&'$D(XQALFWD)&(XQALINFO>0) "I, D, " W:'$D(XQALDELE)&'$D(XQALFWD) "F, S, P, M, R, " W "or ^ to exit" I XQI>0,$O(^XTV(8992,XQAUSER,"XQA",XQI))>0 W !?10,"or RETURN to continue" S XQ1=1
"RTN","XQALERT1",86,0)
 R ": ",XQII:DTIME S:'$T!(XQII[U)!(XQII=""&'XQ1) XQXOUT=1 Q:XQXOUT
"RTN","XQALERT1",87,0)
 I '$D(XQALDELE)&'$D(XQALFWD),"PpMm"[$E(XQII_".") D MORP^XQALDOIT D:"Pp"[$E(XQII_".") PRINT^XQALDOIT D:"Mm"[$E(XQII_".") MAIL^XQALDOIT K ^TMP("XQ",$J,"XQA2") G ASK
"RTN","XQALERT1",88,0)
 I XQII'="",XQII["?" D HELP G ASK
"RTN","XQALERT1",89,0)
 I XQII=""&XQ1 Q
"RTN","XQALERT1",90,0)
 I "IiAaFfRrSsDd"'[$E(XQII_"."),$L(XQII)>31,$E(XQII,1,32)?1N.N W !,$C(7),"  ??  Invalid number entered",! G ASK
"RTN","XQALERT1",91,0)
 I "IiAaFfRrSsDd"'[$E(XQII_"."),(XQII<1)!(XQII>XQK) W $C(7),"  ??",! G ASK
"RTN","XQALERT1",92,0)
 I '$D(XQALDELE)&'$D(XQALFWD),"Ff"[$E(XQII) D FWRD^XQALFWD S XQX1=-2 Q  ; MODIFIED 7-6
"RTN","XQALERT1",93,0)
 I '$D(XQALDELE)&'$D(XQALFWD),"Ss"[$E(XQII) D CHKSURO S XQX1=-1 Q
"RTN","XQALERT1",94,0)
 I '$D(XQALDELE)&'$D(XQALFWD),"Dd"[$E(XQII) D ASKDEL S XQX1=-2 Q  ; MODIFIED 7-6
"RTN","XQALERT1",95,0)
 I '$D(XQALDELE),"Rr"[$E(XQII) S XQX1=-2 Q
"RTN","XQALERT1",96,0)
 I "Aa"[$E(XQII) S X="1-"_XQACNT,DIR(0)="LV^1:"_XQACNT D ^DIR K DIR,XQX1 M XQX1=Y S XQII="" K Y ;Merge list from Y
"RTN","XQALERT1",97,0)
 I XQII'="","Ii"[$E(XQII) S XQX1(0)="",XQX2=0,XQII="" F XQK=0:0 S XQK=$O(^TMP("XQ",$J,"XQA1",XQK)) S:XQK'>0 XQX1=XQX1(0) Q:XQK'>0  I $P(^(XQK),U,7,8)="^ " S XQX1(XQX2)=XQX1(XQX2)_XQK_"," S:$L(XQX1(XQX2))>240 XQX2=XQX2+1,XQX1(XQX2)=""
"RTN","XQALERT1",98,0)
 I XQII="" Q
"RTN","XQALERT1",99,0)
 S X=XQII,DIR(0)="LV^1:"_XQK D ^DIR I '$D(Y) W $C(7),"  ??" D HELP G ASK ;Use of 'LV' is special
"RTN","XQALERT1",100,0)
 K XQX1 M XQX1=Y K Y S Y=XQX1 ;Merge list from Y
"RTN","XQALERT1",101,0)
 Q
"RTN","XQALERT1",102,0)
WAIT(IFN) ;Wait for user input if last alert is INFO and next isn't.
"RTN","XQALERT1",103,0)
 N X,YY Q:$G(XQXOUT)
"RTN","XQALERT1",104,0)
 S X=$G(^TMP("XQ",$J,"XQA1",IFN)),YY=$P(X,U,7,8),YY=$S(YY="^ ":"I",YY="^":"O",1:"R")
"RTN","XQALERT1",105,0)
 I $G(XQALAST)="I","OR"[YY D WAIT2
"RTN","XQALERT1",106,0)
 I YY="I",$Y+4>IOSL D WAIT2 W @IOF
"RTN","XQALERT1",107,0)
 S XQALAST=YY
"RTN","XQALERT1",108,0)
 Q
"RTN","XQALERT1",109,0)
WAIT2 ;Wait for user input before continuing
"RTN","XQALERT1",110,0)
 N DIR,Y,DIROUT,DIRUT S DIR(0)="E",DIR("?")="The next ALERT may cause the loss of info on the screen."
"RTN","XQALERT1",111,0)
 D ^DIR S:$D(DIRUT) XQXOUT=1
"RTN","XQALERT1",112,0)
 Q
"RTN","XQALERT1",113,0)
 ;
"RTN","XQALERT1",114,0)
HELP W !!,"YOU MAY ENTER:",!?3,$S(XQK>1:"One or more numbers",1:"A number")," in the range 1 to ",XQK," to select specific alert(s)"
"RTN","XQALERT1",115,0)
 W !?6,"for "_$S($D(XQALDELE):"DELETION.",$D(XQALFWD):"FORWARDING",1:"processing.") W:XQK>1 "  This may be a series of numbers, e.g., 2,3,6-9"
"RTN","XQALERT1",116,0)
 W !?3,"A to "_$S($D(XQALDELE):"DELETE",$D(XQALFWD):"FORWARD",1:"process")," all of the pending alerts in the order shown."
"RTN","XQALERT1",117,0)
 W:'$D(XQALDELE)&'$D(XQALFWD) !?3,"I to process all of the INFORMATION ONLY alerts, if any, without further ado."
"RTN","XQALERT1",118,0)
 W:'$D(XQALDELE)&'$D(XQALFWD) !?3,"S to add or remove a surrogate to receive alerts for you"
"RTN","XQALERT1",119,0)
 W:'$D(XQALDELE)&'$D(XQALFWD) !?3,"F to forward one or more specific alerts.  Forwarding may be as an ALERT",!,"to specific user(s) and/or mail group(s), or as a MAIL MESSAGE, or to a",!,"specific PRINTER."
"RTN","XQALERT1",120,0)
 W:'$D(XQALDELE)&'$D(XQALFWD) !?3,"D to delete specific alerts (some alerts may not be deleted)"
"RTN","XQALERT1",121,0)
 W:'$D(XQALDELE)&'$D(XQALFWD) !?3,"P to print a copy of the pending alerts on a printer"
"RTN","XQALERT1",122,0)
 W:'$D(XQALDELE)&'$D(XQALFWD) !?3,"M to receive a MailMan message containing a copy of these pending alerts"
"RTN","XQALERT1",123,0)
 W:'$D(XQALDELE) !?3,"R to Redisplay the available alerts"
"RTN","XQALERT1",124,0)
 W !?3,"^ to exit"
"RTN","XQALERT1",125,0)
 I XQI W !?5,"or RETURN to see additional pending ALERTS"
"RTN","XQALERT1",126,0)
 W !!
"RTN","XQALERT1",127,0)
 Q
"RTN","XQALERT1",128,0)
 ;
"RTN","XQALERT1",129,0)
SORT ;Sort and remove display only
"RTN","XQALERT1",130,0)
 F XQI=0:0 S XQI=$O(^XTV(8992,XQAUSER,"XQA",XQI)) Q:XQI'>0  S XQX=^(XQI,0),XQZ=$G(^(1)),XQZ1=$G(^(2)) S XQJ=$P(XQX,U,7,8) K:XQJ=U ^XTV(8992,XQAUSER,"XQA",XQI) I XQJ'=U D
"RTN","XQALERT1",131,0)
 . S XQACNT=XQACNT+1,XQJ=$S(XQAREV:999999-XQACNT,1:XQACNT),^TMP("XQ",$J,"XQA",XQJ)=XQX,^(XQJ,1)=XQI,^(2)=XQZ,^(3)=XQZ1
"RTN","XQALERT1",132,0)
 S XQK=0 F XQI=0:0 S XQI=$O(^TMP("XQ",$J,"XQA",XQI)) Q:XQI'>0  S XQK=XQK+1 M ^TMP("XQ",$J,"XQA1",XQK)=^TMP("XQ",$J,"XQA",XQI)
"RTN","XQALERT1",133,0)
 Q
"RTN","XQALERT1",134,0)
 ;
"RTN","XQALERT1",135,0)
ASKDEL ;
"RTN","XQALERT1",136,0)
 N XQALDELE,XQX1COPY,XQAID,DA,XQAKILL,XQXOUT,XQAUSERD
"RTN","XQALERT1",137,0)
 S XQALDELE=1
"RTN","XQALERT1",138,0)
 K XQX1
"RTN","XQALERT1",139,0)
 D DOIT^XQALERT1
"RTN","XQALERT1",140,0)
 K XQALDELE S XQAUSERD=1
"RTN","XQALERT1",141,0)
 I $D(XQX1),XQX1>0 D
"RTN","XQALERT1",142,0)
 . M XQX1COPY=XQX1
"RTN","XQALERT1",143,0)
 . F  Q:XQX1=""  S DA=+XQX1,XQX1=$P(XQX1,",",2,99) D  I XQX1="" S Y=$O(XQX1(0)) I Y>0 S XQX1=XQX1(Y) K XQX1(Y)
"RTN","XQALERT1",144,0)
 . . S XQAID=$P(^TMP("XQ",$J,"XQA1",DA),U,2),XQALVALU=^(DA),XQAKILL=1
"RTN","XQALERT1",145,0)
 . . I $P(XQALVALU,U,8)=" "!$P(XQALVALU,U,10) D
"RTN","XQALERT1",146,0)
 . . . I XQAID="" K ^XTV(8992,XQAUSER,"XQA",+^TMP("XQ",$J,"XQA1",DA,1))
"RTN","XQALERT1",147,0)
 . . . I XQAID'="" D DELETE^XQALDEL
"RTN","XQALERT1",148,0)
 . . . K ^TMP("XQ",$J,"XQA1",DA),^TMP("XQ",$J,"XQA",(999999-DA))
"RTN","XQALERT1",149,0)
 . K XQX1 M XQX1=XQX1COPY S XQAID=0
"RTN","XQALERT1",150,0)
 . F  Q:XQX1=""  S DA=+XQX1,XQX1=$P(XQX1,",",2,99) D  I XQX1="" S Y=$O(XQX1(0)) I Y>0 S XQX1=XQX1(Y) K XQX1(Y)
"RTN","XQALERT1",151,0)
 . . I $D(^TMP("XQ",$J,"XQA1",DA)) W:'XQAID !!,"Unable to delete alerts which require action: ",DA W:XQAID ",",DA S XQAID=1
"RTN","XQALERT1",152,0)
 . I XQAID=1 K DIR S DIR(0)="E" D ^DIR K DIR
"RTN","XQALERT1",153,0)
 K XQX1,XQAKILL
"RTN","XQALERT1",154,0)
 Q
"RTN","XQALERT1",155,0)
 ;
"RTN","XQALERT1",156,0)
FRWRDONE ;
"RTN","XQALERT1",157,0)
 N XQX1,XQALFWDL S XQALFWDL(1)=XQAID
"RTN","XQALERT1",158,0)
 N XQAID
"RTN","XQALERT1",159,0)
 D FWDONE^XQALFWD
"RTN","XQALERT1",160,0)
 Q
"RTN","XQALSET")
0^3^B30914838
"RTN","XQALSET",1,0)
XQALSET ;ISC-SF.SEA/JLI - SETUP ALERTS ;09/03/99  11:22
"RTN","XQALSET",2,0)
 ;;8.0;KERNEL;**1,6,65,75,114,125**;Jul 10, 1995
"RTN","XQALSET",3,0)
 ;;
"RTN","XQALSET",4,0)
 Q
"RTN","XQALSET",5,0)
 ;
"RTN","XQALSET",6,0)
SETUP Q:$O(XQA(0))=""  Q:'($D(XQAMSG)#2)  Q:XQAMSG=""
"RTN","XQALSET",7,0)
 N X,XQI,XQJ,XQX,XQK,XQACOMNT,XQARESET,DA
"RTN","XQALSET",8,0)
 S XQAOPT1=$S('($D(XQAROU)#2):U,XQAROU'[U:U_XQAROU,1:XQAROU),XQAOPT1=$S(XQAOPT1'=U:XQAOPT1,$D(XQAOPT)#2:XQAOPT_U,1:XQAOPT1) S:XQAOPT1=U XQAOPT1=U_" "
"RTN","XQALSET",9,0)
NOW S XQX=$$NOW^XLFDT()
"RTN","XQALSET",10,0)
 S:$S('$D(XQAID):1,XQAID="":1,1:0) XQAID="NO-ID" S:XQAID[";" XQAID=$P(XQAID,";") S XQA1=XQAID,XQI=XQX
"RTN","XQALSET",11,0)
 I XQA1'="" F  S XQAID=XQA1_";"_DUZ_";"_XQI L +^XTV(8992,"AXQA",XQAID) D  L -^XTV(8992,"AXQA",XQAID) Q:XQI=""  S XQI=XQI+.00000001
"RTN","XQALSET",12,0)
 . I $D(^XTV(8992,"AXQA",XQAID)) Q
"RTN","XQALSET",13,0)
 . S ^XTV(8992,"AXQA",XQAID,0,0)="",XQI=""
"RTN","XQALSET",14,0)
 I XQAID'="" D
"RTN","XQALSET",15,0)
 . N FDA,IENS,XQA2,DIERR
"RTN","XQALSET",16,0)
 . S XQA2=XQA1 I XQA2[",",$P(XQA2,",",3)'="" S XQA2=$P(XQA2,",")_","_$P(XQA2,",",3)
"RTN","XQALSET",17,0)
 . F  D  Q:'$D(DIERR)  Q:'$D(^TMP("DIERR",$J,"E",111))
"RTN","XQALSET",18,0)
 . . K DIERR,^TMP("DIERR",$J)
"RTN","XQALSET",19,0)
 . . S FDA=$NA(^TMP($J,"XQALSET")) K @FDA
"RTN","XQALSET",20,0)
 . . S @FDA@(8992.1,"+1,",.01)=XQAID D UPDATE^DIE("",FDA,"IENS")
"RTN","XQALSET",21,0)
 . . K @FDA
"RTN","XQALSET",22,0)
 . I $D(DIERR) S XQDIERR1=DIERR M XQDIERR=^TMP("DIERR",$J) Q
"RTN","XQALSET",23,0)
 . Q:IENS(1)'>0  S (DA,XQADA)=IENS(1)
"RTN","XQALSET",24,0)
 . S IENS=IENS(1)_",",@FDA@(8992.1,IENS,.02)=XQX,^(.03)=XQA2,^(.05)=DUZ,^(1.01)=XQAMSG
"RTN","XQALSET",25,0)
 . I $D(XQAARCH) S X=$$FMADD^XLFDT(DT,XQAARCH) I X>DT S @FDA@(8992.1,IENS,.08)=X
"RTN","XQALSET",26,0)
 . I $P(XQA1,",",2)>0 S @FDA@(8992.1,IENS,.04)=$P(XQA1,",",2)
"RTN","XQALSET",27,0)
 . I $D(ZTQUEUED) S @FDA@(8992.1,IENS,.06)=1
"RTN","XQALSET",28,0)
 . I $D(XQAOPT)#2 S @FDA@(8992.1,IENS,1.02)=XQAOPT
"RTN","XQALSET",29,0)
 . I $D(XQAROU)#2 S XQAXX=$S(XQAROU[U:XQAROU,1:U_XQAROU) I $P(XQAXX,U,2)'="" S:$P(XQAXX,U)'="" @FDA@(8992.1,IENS,1.03)=$P(XQAXX,U) S @FDA@(8992.1,IENS,1.04)=$P(XQAXX,U,2)
"RTN","XQALSET",30,0)
 . I $D(XQACTMSG) S @FDA@(8992.1,IENS,1.05)=XQACTMSG
"RTN","XQALSET",31,0)
 . I $D(XQADATA) S @FDA@(8992.1,IENS,2)=XQADATA
"RTN","XQALSET",32,0)
 . D FILE^DIE("KS",FDA)
"RTN","XQALSET",33,0)
REENT S XQALIN1=$S($D(XQAID)#2:XQAID,1:"")_U_$E(XQAMSG,1,80)_"^1^"_$S(XQAOPT1=U:"D",1:"R")_U_$S($D(XQACTMSG):$E(XQACTMSG,1,40),1:"")_U_XQAOPT1
"RTN","XQALSET",34,0)
 S:$D(XQACNDEL) $P(XQALIN1,U,9)=1 S:$D(XQASURO) $P(XQALIN1,U,12)=XQASURO S:$D(XQASUPV) $P(XQALIN1,U,13)=XQASUPV
"RTN","XQALSET",35,0)
 S XQALIN=XQX_U_XQALIN1,XQJ=0
"RTN","XQALSET",36,0)
 K XQALIN1 S:$D(XQADATA) XQALIN1=XQADATA
"RTN","XQALSET",37,0)
LOOP1 S XQJ=$O(XQA(" ")) I XQJ'="" K:"G.g."'[$E(XQJ_",,",1,2) XQA(XQJ) D:$D(XQA(XQJ)) GROUP G LOOP1
"RTN","XQALSET",38,0)
 ;
"RTN","XQALSET",39,0)
 ; The following section of code was added to provide a generalized way to handle surrogates
"RTN","XQALSET",40,0)
 ;
"RTN","XQALSET",41,0)
 F XQJ=0:0 S XQJ=$O(XQA(XQJ)) Q:XQJ=""  D
"RTN","XQALSET",42,0)
 . N X S X=$G(^XTV(8992,XQJ,0))
"RTN","XQALSET",43,0)
 . I $P(X,U,2)>0 D  ;                   Surrogate specified
"RTN","XQALSET",44,0)
 . . N NOW,DATE S NOW=$$NOW^XLFDT() ;   Get Current date/time to check date/times if present
"RTN","XQALSET",45,0)
 . . S DATE=$P(X,U,4) I DATE>0,DATE<NOW D  Q  ;  Current Date/time past End date for surrogate
"RTN","XQALSET",46,0)
 . . . N FDA
"RTN","XQALSET",47,0)
 . . . S FDA(8992,(XQJ_","),.02)="@"
"RTN","XQALSET",48,0)
 . . . S FDA(8992,(XQJ_","),.03)="@"
"RTN","XQALSET",49,0)
 . . . S FDA(8992,(XQJ_","),.04)="@"
"RTN","XQALSET",50,0)
 . . . D FILE^DIE("E","FDA") ;            Remove surrogate and related date/times
"RTN","XQALSET",51,0)
 . . . Q
"RTN","XQALSET",52,0)
 . . S DATE=$P(X,U,3) I DATE>0,DATE>NOW Q  ; Period for surrogate hasn't started yet
"RTN","XQALSET",53,0)
 . . S X=+$P(X,U,2) ;                        Get surrogate value (Pointer to file 200)
"RTN","XQALSET",54,0)
 . . S XQA(X)="" K XQA(XQJ) ; Add Surrogate to XQA array, delete XQJ entry
"RTN","XQALSET",55,0)
 . . I X<XQJ S XQJ=X-1 ; Make sure surrogate gets checked also
"RTN","XQALSET",56,0)
 . . Q
"RTN","XQALSET",57,0)
 . Q
"RTN","XQALSET",58,0)
 ;
"RTN","XQALSET",59,0)
 ; End of surrogate specific code
"RTN","XQALSET",60,0)
 S XQJ=0
"RTN","XQALSET",61,0)
LOOP S XQJ=$O(XQA(XQJ)) G:XQJ="" WRAP
"RTN","XQALSET",62,0)
 I '(+$$ACTIVE^XUSER(XQJ)) K XQA(XQJ) G LOOP ;Don't send to users that can't sign-on
"RTN","XQALSET",63,0)
 I
"RTN","XQALSET",64,0)
 I $G(XQADA)>0 L +^XTV(8992.1,XQADA):10 D
"RTN","XQALSET",65,0)
 . S XQATOP=$S($D(^XTV(8992.1,XQADA,20,0)):$P(^(0),U,4),1:0)+1 S ^(0)="^8992.11^"_XQJ_U_XQATOP
"RTN","XQALSET",66,0)
 . S ^XTV(8992.1,XQADA,20,XQATOP,0)=XQJ,^XTV(8992.1,"R",XQJ,XQADA,XQATOP)="",^XTV(8992.1,XQADA,20,"B",XQJ,XQATOP)="" I $D(XQARESET) S $P(^XTV(8992.1,XQADA,20,XQATOP,0),U,7,8)=XQAUSER_U_XQX
"RTN","XQALSET",67,0)
 I '$D(^XTV(8992,XQJ,0)) D
"RTN","XQALSET",68,0)
 . N FDA,IENS
"RTN","XQALSET",69,0)
 . F  D  Q:'$D(DIERR)  Q:'$D(^TMP("DIERR",$J,"E",110))&'$D(^TMP("DIERR",$J,"E",111))
"RTN","XQALSET",70,0)
 . . K DIERR,^TMP("DIERR",$J)
"RTN","XQALSET",71,0)
 . . S FDA=$NA(^TMP($J,"XQALSET")) K @FDA S @FDA@(8992,"+1,",.01)=XQJ
"RTN","XQALSET",72,0)
 . . S IENS(1)=XQJ
"RTN","XQALSET",73,0)
 . . D UPDATE^DIE("S",FDA,"IENS")
"RTN","XQALSET",74,0)
 L +^XTV(8992,XQJ):10 S XQXI=XQX S:'$D(^XTV(8992,XQJ,"XQA",0)) ^(0)="^8992.01DA^"
"RTN","XQALSET",75,0)
REP I $D(^XTV(8992,XQJ,"XQA",XQXI,0)) S XQXI=XQXI+.00000001 G REP
"RTN","XQALSET",76,0)
 S ^XTV(8992,XQJ,"XQA",XQXI,0)=XQALIN S:$D(XQALIN1) ^(1)=XQALIN1 S:$D(XQARESET) ^(2)=XQAUSER_U_XQX_U_$G(XQACOMNT) S ^(0)=$P(^XTV(8992,XQJ,"XQA",0),U,1,2)_U_XQXI_U_($P(^(0),U,4)+1)
"RTN","XQALSET",77,0)
 L -^XTV(8992,XQJ) L:$G(XQADA)>0 -^XTV(8992.1,XQADA)
"RTN","XQALSET",78,0)
 K XQA(XQJ) S:XQAID'="" ^XTV(8992,"AXQA",XQAID,XQJ,XQXI)="",^XTV(8992,"AXQAN",XQA1,XQJ,XQXI)=""
"RTN","XQALSET",79,0)
 G LOOP
"RTN","XQALSET",80,0)
WRAP K:XQAID'="" ^XTV(8992,"AXQA",XQAID,0,0) K XQA,XQALIN,XQALIN1,XQAMSG,XQAID,XQAFLG,XQAOPT,XQAOPT1,XQAROU,XQADATA,XQI,XQX,XQJ,XQK,XQA1,XQACTMSG,XQJ,XQXI,XQAARCH
"RTN","XQALSET",81,0)
 Q
"RTN","XQALSET",82,0)
 ;
"RTN","XQALSET",83,0)
GROUP S XQL="" F XQI=3:1:$L(XQJ) S XQL1=$E(XQJ,XQI) S:XQL1?1L XQL1=$C($A(XQL1)-32) S XQL=XQL_XQL1
"RTN","XQALSET",84,0)
 S XQI=$O(^XMB(3.8,"B",XQL,0)) I XQI'>0 S XQL1=$O(^XMB(3.8,"B",XQL)) I $E(XQL1,1,$L(XQL))=XQL S XQL2=$O(^(XQL1)) I $E(XQL2,1,$L(XQL))'=XQL S XQI=$O(^(XQL1,0))
"RTN","XQALSET",85,0)
 I XQI>0 F XQL=0:0 S XQL=$O(^XMB(3.8,XQI,1,XQL)) Q:XQL'>0  S XQA(+^(XQL,0))=""
"RTN","XQALSET",86,0)
 K XQA(XQJ),XQI,XQL,XQL1,XQL2
"RTN","XQALSET",87,0)
 Q
"RTN","XQALSET",88,0)
 ;
"RTN","XQALSET",89,0)
RESETUP(XQAIDVAL,XQA,XQACOMNT) ;
"RTN","XQALSET",90,0)
 N XQAIEN,DA,XQI,XQJ,XQK,XQX
"RTN","XQALSET",91,0)
 S:'$D(XQAUSER) XQAUSER=DUZ
"RTN","XQALSET",92,0)
 S XQARESET=1
"RTN","XQALSET",93,0)
 S XQAIEN=$O(^XTV(8992,"AXQA",XQAIDVAL,XQAUSER,0)) Q:XQAIEN'>0
"RTN","XQALSET",94,0)
 S X=$G(^XTV(8992,XQAUSER,"XQA",XQAIEN,0)),X1=$G(^(1))
"RTN","XQALSET",95,0)
 Q:X=""
"RTN","XQALSET",96,0)
 S XQAID=$P(X,U,2),XQA1=$P(XQAID,";"),XQADA=$O(^XTV(8992.1,"B",XQAID,0))
"RTN","XQALSET",97,0)
 S XQAOPT1=$P(X,U,7,8),XQAMSG=$P(X,U,3),XQACTMSG=$P(X,U,6)
"RTN","XQALSET",98,0)
 S XQADATA=$S(X1'="":X1,1:$P(X,U,9,100))
"RTN","XQALSET",99,0)
 S XQX=$$NOW^XLFDT()
"RTN","XQALSET",100,0)
 D REENT
"RTN","XQALSET",101,0)
 Q
"RTN","XQALSURO")
0^5^B18431726
"RTN","XQALSURO",1,0)
XQALSURO ;ISC-SF.SEA/JLI - SURROGATES FOR ALERTS ;10/7/99  09:56
"RTN","XQALSURO",2,0)
 ;;8.0;KERNEL;**114,125**;Jul 10, 1995
"RTN","XQALSURO",3,0)
 ;;
"RTN","XQALSURO",4,0)
 Q
"RTN","XQALSURO",5,0)
OTHRSURO ; OPT:- XQALERT SURROGATE SET/REMOVE -- OTHERS SPECIFY SURROGATE FOR SELECTED USER
"RTN","XQALSURO",6,0)
 N XQAUSER
"RTN","XQALSURO",7,0)
 K DIR S DIR(0)="PD^200",DIR("A",1)="SURROGATE related to which"
"RTN","XQALSURO",8,0)
 S DIR("A")="NEW PERSON entry"
"RTN","XQALSURO",9,0)
 D ^DIR K DIR Q:Y'>0  W "  ",$P(Y,U,2)
"RTN","XQALSURO",10,0)
 S XQAUSER=+Y
"RTN","XQALSURO",11,0)
 I '$P($G(^XTV(8992,XQAUSER,0)),U,2) G SURROGAT
"RTN","XQALSURO",12,0)
 G CHKREMV
"RTN","XQALSURO",13,0)
 ;
"RTN","XQALSURO",14,0)
SURROGAT ; USER SPECIFICATION OF SURROGATE
"RTN","XQALSURO",15,0)
 N DIR,XQALSURO,XQALSTRT,XQALEND
"RTN","XQALSURO",16,0)
SURRO1 S DIR(0)="P^200",DIR("A")="Select USER to be SURROGATE" D ^DIR K DIR Q:Y'>0
"RTN","XQALSURO",17,0)
 W "  ",$P(Y,U,2)
"RTN","XQALSURO",18,0)
 S XQALSURO=+Y
"RTN","XQALSURO",19,0)
 ; code added to prevent cyclical surrogates
"RTN","XQALSURO",20,0)
 I XQALSURO=XQAUSER W $C(7),!,"You cannot specify yourself as your own surrogate!",! G SURRO1
"RTN","XQALSURO",21,0)
 S XQALSTRT=$$GET1^DIQ(8992,(XQALSURO_","),.02,"I") I XQALSTRT>0 D  I '$D(XQALSURO) G SURRO1
"RTN","XQALSURO",22,0)
 . I XQALSTRT=XQAUSER W $C(7),!,"YOU are designated as the surrogate for this user - can't do it!",! K XQALSURO Q
"RTN","XQALSURO",23,0)
 . F  S XQALSTRT=$$GET1^DIQ(8992,(XQALSTRT_","),.02,"I") Q:XQALSTRT'>0  I XQALSTRT=XQAUSER W $C(7),!,"This forms a circle which leads back to you - can't do it!",! K XQALSURO Q
"RTN","XQALSURO",24,0)
 . Q
"RTN","XQALSURO",25,0)
 ; end of test for cyclical surrogates
"RTN","XQALSURO",26,0)
 S DIR(0)="DO^::ATEQX",DIR("A")="Specify Date/Time SURROGATE becomes active"
"RTN","XQALSURO",27,0)
 S DIR("A",1)="",DIR("A",2)=""
"RTN","XQALSURO",28,0)
 S DIR("A",3)="if no date/time is entered, alerts will start going to"
"RTN","XQALSURO",29,0)
 S DIR("A",4)="the SURROGATE immediately."
"RTN","XQALSURO",30,0)
 D ^DIR K DIR
"RTN","XQALSURO",31,0)
 S XQALSTRT=+Y
"RTN","XQALSURO",32,0)
 S DIR(0)="DO^::AEQTX",DIR("A")="Specify Date/Time SURROGATE should be removed"
"RTN","XQALSURO",33,0)
 S DIR("A",1)="",DIR("A",2)=""
"RTN","XQALSURO",34,0)
 S DIR("A",3)="if no date/time is entered, YOU must remove the SURROGATE"
"RTN","XQALSURO",35,0)
 S DIR("A",4)="to terminate alerts going to the SURROGATE"
"RTN","XQALSURO",36,0)
 D ^DIR K DIR
"RTN","XQALSURO",37,0)
 S XQALEND=+Y
"RTN","XQALSURO",38,0)
 D SETSURO(XQAUSER,XQALSURO,XQALSTRT,XQALEND)
"RTN","XQALSURO",39,0)
 Q
"RTN","XQALSURO",40,0)
 ;
"RTN","XQALSURO",41,0)
SETSURO(XQAUSER,XQALSURO,XQALSTRT,XQALEND) ; SR
"RTN","XQALSURO",42,0)
 N XQALFM
"RTN","XQALSURO",43,0)
 I $G(XQAUSER)'>0 Q
"RTN","XQALSURO",44,0)
 I $G(XQALSURO)'>0 Q
"RTN","XQALSURO",45,0)
 I '$D(^XTV(8992,XQAUSER,0)) D
"RTN","XQALSURO",46,0)
 . N XQALFM,XQALFM1
"RTN","XQALSURO",47,0)
 . S XQALFM1(1)=XQAUSER
"RTN","XQALSURO",48,0)
 . S XQALFM(8992,"+1,",.01)=XQAUSER
"RTN","XQALSURO",49,0)
 . D UPDATE^DIE("","XQALFM","XQALFM1")
"RTN","XQALSURO",50,0)
 . Q
"RTN","XQALSURO",51,0)
 S XQAUSER=XQAUSER_","
"RTN","XQALSURO",52,0)
 S XQALFM(8992,XQAUSER,.02)=XQALSURO
"RTN","XQALSURO",53,0)
 I $G(XQALSTRT)>0 S XQALFM(8992,XQAUSER,.03)=XQALSTRT
"RTN","XQALSURO",54,0)
 I $G(XQALEND)>0 S XQALFM(8992,XQAUSER,.04)=XQALEND
"RTN","XQALSURO",55,0)
 D FILE^DIE("I","XQALFM")
"RTN","XQALSURO",56,0)
 N XQAMESG,XMSUB,XMTEXT
"RTN","XQALSURO",57,0)
 S XQAMESG(1,0)="You have been specified as a surrogate recipient for alerts for"
"RTN","XQALSURO",58,0)
 S XQAMESG(2,0)=$$GET1^DIQ(200,(XQAUSER_","),.01,"E")_" (IEN="_$P(XQAUSER,",")_") effective "_$S($G(XQALSTRT)'>0:"immediately",1:$$FMTE^XLFDT(XQALSTRT))
"RTN","XQALSURO",59,0)
 I $G(XQALEND)'>0 S XQAMESG(2,0)=XQAMESG(2,0)_"."
"RTN","XQALSURO",60,0)
 E  S XQAMESG(3,0)="until "_$$FMTE^XLFDT(XQALEND)
"RTN","XQALSURO",61,0)
 S XMSUB="Surrogate Recipient for "_$$GET1^DIQ(200,(XQAUSER_","),.01,"E")
"RTN","XQALSURO",62,0)
 S XMTEXT="XQAMESG("
"RTN","XQALSURO",63,0)
 D SENDMESG
"RTN","XQALSURO",64,0)
 Q
"RTN","XQALSURO",65,0)
 ;
"RTN","XQALSURO",66,0)
CHKREMV ;
"RTN","XQALSURO",67,0)
 N DIR
"RTN","XQALSURO",68,0)
 S DIR("A",1)=$$GET1^DIQ(8992,(XQAUSER_","),.02,"E")_" is currently your surrogate"
"RTN","XQALSURO",69,0)
 S DIR(0)="Y",DIR("A")="Do you really want to REMOVE this surrogate",DIR("B")="YES"
"RTN","XQALSURO",70,0)
 D ^DIR K DIR I 'Y Q
"RTN","XQALSURO",71,0)
 D REMVSURO(XQAUSER)
"RTN","XQALSURO",72,0)
 Q
"RTN","XQALSURO",73,0)
 ;
"RTN","XQALSURO",74,0)
REMVSURO(XQAUSER) ; SR
"RTN","XQALSURO",75,0)
 I $G(XQAUSER)'>0 Q
"RTN","XQALSURO",76,0)
 N XQALFM,XQALSURO
"RTN","XQALSURO",77,0)
 S XQALSURO=+$P($G(^XTV(8992,XQAUSER,0)),U,2)
"RTN","XQALSURO",78,0)
 S XQAUSER=XQAUSER_","
"RTN","XQALSURO",79,0)
 S XQALFM(8992,XQAUSER,.02)="@"
"RTN","XQALSURO",80,0)
 S XQALFM(8992,XQAUSER,.03)="@"
"RTN","XQALSURO",81,0)
 S XQALFM(8992,XQAUSER,.04)="@"
"RTN","XQALSURO",82,0)
 D FILE^DIE("","XQALFM")
"RTN","XQALSURO",83,0)
 I XQALSURO>0 D
"RTN","XQALSURO",84,0)
 . N XQAMESG,XMSUB,XMTEXT
"RTN","XQALSURO",85,0)
 . S XQAMESG(1,0)="You have been REMOVED as a surrogate recipient for alerts for"
"RTN","XQALSURO",86,0)
 . S XQAMESG(2,0)=$$GET1^DIQ(200,(XQAUSER_","),.01,"E")_" (IEN="_$P(XQAUSER,",")_")."
"RTN","XQALSURO",87,0)
 . S XMTEXT="XQAMESG(",XMSUB="Removal as surrogate recipient"
"RTN","XQALSURO",88,0)
 . D SENDMESG
"RTN","XQALSURO",89,0)
 Q
"RTN","XQALSURO",90,0)
 ;
"RTN","XQALSURO",91,0)
CURRSURO(XQAUSER) ; SR - returns current surrogate for user or -1  usage $$CURRSURO^XQALSURO(DUZ)
"RTN","XQALSURO",92,0)
 I $P($G(^XTV(8992,XQAUSER,0)),U,2)>0 Q +$P(^XTV(8992,XQAUSER,0),U,2)
"RTN","XQALSURO",93,0)
 Q -1
"RTN","XQALSURO",94,0)
 ;
"RTN","XQALSURO",95,0)
SENDMESG ;
"RTN","XQALSURO",96,0)
 N XMY,XMDUZ,XMCHAN
"RTN","XQALSURO",97,0)
 S XMY(XQALSURO)="",XMDUZ=.5
"RTN","XQALSURO",98,0)
 D ^XMD
"RTN","XQALSURO",99,0)
 Q
"RTN","XU8P125")
0^^B267041
"RTN","XU8P125",1,0)
XU8P125 ;SF-CIOFO/JDS  Post Init for XU*8*125 ;10/01/99  10:28
"RTN","XU8P125",2,0)
 ;;KID's Post Init
"RTN","XU8P125",3,0)
 ;
"RTN","XU8P125",4,0)
EN ;
"RTN","XU8P125",5,0)
 N DA,DIK
"RTN","XU8P125",6,0)
 K ^XTV(8992,"AXQA")
"RTN","XU8P125",7,0)
 K ^XTV(8992,"AXQAN")
"RTN","XU8P125",8,0)
 S DA(1)=0
"RTN","XU8P125",9,0)
 F  S DA(1)=$O(^XTV(8992,DA(1))) Q:DA(1)'>0  D
"RTN","XU8P125",10,0)
 . S DIK="^XTV(8992,"_DA(1)_",""XQA"","
"RTN","XU8P125",11,0)
 . S DIK(1)=".02^AXQA^AXQAN"
"RTN","XU8P125",12,0)
 . D ENALL^DIK
"RTN","XU8P125",13,0)
 Q
"UP",8992,8992.01,-1)
8992^XQA
"UP",8992,8992.01,0)
8992.01
"VER")
8.0^21.0
"^DD",8992,8992.01,.02,0)
ALERT ID^FI^^0;2^K:X[""""!($A(X)=45) X I $D(X) K:$L(X)>20!($L(X)<2) X
"^DD",8992,8992.01,.02,1,0)
^.1
"^DD",8992,8992.01,.02,1,1,0)
8992^AXQA^MUMPS
"^DD",8992,8992.01,.02,1,1,1)
S ^XTV(8992,"AXQA",X,DA(1),DA)=""
"^DD",8992,8992.01,.02,1,1,2)
K ^XTV(8992,"AXQA",X,DA(1),DA)
"^DD",8992,8992.01,.02,1,1,"%D",0)
^^5^5^2991001^^^^
"^DD",8992,8992.01,.02,1,1,"%D",1,0)
 
"^DD",8992,8992.01,.02,1,1,"%D",2,0)
This is a cross-reference on the complete XQAID value for this alert,
"^DD",8992,8992.01,.02,1,1,"%D",3,0)
which can be used to identify those individuals who received this particular
"^DD",8992,8992.01,.02,1,1,"%D",4,0)
instance of the alert, and could be used to delete other entries which
"^DD",8992,8992.01,.02,1,1,"%D",5,0)
had received the alert.
"^DD",8992,8992.01,.02,1,1,"DT")
2991001
"^DD",8992,8992.01,.02,1,2,0)
8992^AXQAN^MUMPS
"^DD",8992,8992.01,.02,1,2,1)
S ^XTV(8992,"AXQAN",$P(X,";"),DA(1),DA)=""
"^DD",8992,8992.01,.02,1,2,2)
K ^XTV(8992,"AXQAN",$P(X,";"),DA(1),DA)
"^DD",8992,8992.01,.02,1,2,"%D",0)
^^6^6^2991001^^^^
"^DD",8992,8992.01,.02,1,2,"%D",1,0)
 
"^DD",8992,8992.01,.02,1,2,"%D",2,0)
This cross-reference may be used to identify those users who received the
"^DD",8992,8992.01,.02,1,2,"%D",3,0)
alert with the application package specified XQAID (the first ";"-piece
"^DD",8992,8992.01,.02,1,2,"%D",4,0)
of the complete XQAID value) for those cases in which the full XQAID value
"^DD",8992,8992.01,.02,1,2,"%D",5,0)
may not be known, e.g., an application which was selected by the user
"^DD",8992,8992.01,.02,1,2,"%D",6,0)
without selecting the ALERT ACTION option to process the alert.
"^DD",8992,8992.01,.02,1,2,"DT")
2991001
"^DD",8992,8992.01,.02,3)
This is the package identification used to identify this particular alert.  Answer must be 2-20 characters in length.
"^DD",8992,8992.01,.02,21,0)
^^4^4^2930402^
"^DD",8992,8992.01,.02,21,1,0)
This is a field in which the package id passed during alert filing.  This
"^DD",8992,8992.01,.02,21,2,0)
id may simply be a package namespace, or it may be a namespace followed by
"^DD",8992,8992.01,.02,21,3,0)
additional data to more accurately identify the type or purpose of the
"^DD",8992,8992.01,.02,21,4,0)
alert.
"^DD",8992,8992.01,.02,"DT")
2991001
**END**
**END**
