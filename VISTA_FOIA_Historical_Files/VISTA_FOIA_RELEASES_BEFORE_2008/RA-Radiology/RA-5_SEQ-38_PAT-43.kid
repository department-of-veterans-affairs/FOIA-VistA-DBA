Released RA*5*43 SEQ #38
Extracted from mail message
**KIDS**:RA*5.0*43^

**INSTALL NAME**
RA*5.0*43
"BLD",4612,0)
RA*5.0*43^RADIOLOGY/NUCLEAR MEDICINE^0^3030918^y
"BLD",4612,1,0)
^^2^2^3030825^^
"BLD",4612,1,1,0)
Plese refer the patch description on FORUM for a detailed account of the 
"BLD",4612,1,2,0)
changes exported with this patch.
"BLD",4612,4,0)
^9.64PA^74^1
"BLD",4612,4,74,0)
74
"BLD",4612,4,74,2,0)
^9.641^74^1
"BLD",4612,4,74,2,74,0)
RAD/NUC MED REPORTS  (File-top level)
"BLD",4612,4,74,2,74,1,0)
^9.6411^10^1
"BLD",4612,4,74,2,74,1,10,0)
ELECTRONIC SIGNATURE CODE
"BLD",4612,4,74,222)
y^n^p^^^^n^^n
"BLD",4612,4,74,224)

"BLD",4612,4,"APDD",74,74)

"BLD",4612,4,"APDD",74,74,10)

"BLD",4612,4,"B",74,74)

"BLD",4612,"KRN",0)
^9.67PA^8989.52^19
"BLD",4612,"KRN",.4,0)
.4
"BLD",4612,"KRN",.401,0)
.401
"BLD",4612,"KRN",.402,0)
.402
"BLD",4612,"KRN",.402,"NM",0)
^9.68A^2^2
"BLD",4612,"KRN",.402,"NM",1,0)
RA VERIFY REPORT ONLY    FILE #74^74^0
"BLD",4612,"KRN",.402,"NM",2,0)
RA REPORT EDIT    FILE #74^74^0
"BLD",4612,"KRN",.402,"NM","B","RA REPORT EDIT    FILE #74",2)

"BLD",4612,"KRN",.402,"NM","B","RA VERIFY REPORT ONLY    FILE #74",1)

"BLD",4612,"KRN",.403,0)
.403
"BLD",4612,"KRN",.5,0)
.5
"BLD",4612,"KRN",.84,0)
.84
"BLD",4612,"KRN",3.6,0)
3.6
"BLD",4612,"KRN",3.8,0)
3.8
"BLD",4612,"KRN",9.2,0)
9.2
"BLD",4612,"KRN",9.8,0)
9.8
"BLD",4612,"KRN",9.8,"NM",0)
^9.68A^3^3
"BLD",4612,"KRN",9.8,"NM",1,0)
RAMAIN^^0^B29647242
"BLD",4612,"KRN",9.8,"NM",2,0)
RART^^0^B21428021
"BLD",4612,"KRN",9.8,"NM",3,0)
RARTR^^0^B53486671
"BLD",4612,"KRN",9.8,"NM","B","RAMAIN",1)

"BLD",4612,"KRN",9.8,"NM","B","RART",2)

"BLD",4612,"KRN",9.8,"NM","B","RARTR",3)

"BLD",4612,"KRN",19,0)
19
"BLD",4612,"KRN",19.1,0)
19.1
"BLD",4612,"KRN",101,0)
101
"BLD",4612,"KRN",409.61,0)
409.61
"BLD",4612,"KRN",771,0)
771
"BLD",4612,"KRN",870,0)
870
"BLD",4612,"KRN",8989.51,0)
8989.51
"BLD",4612,"KRN",8989.52,0)
8989.52
"BLD",4612,"KRN",8994,0)
8994
"BLD",4612,"KRN","B",.4,.4)

"BLD",4612,"KRN","B",.401,.401)

"BLD",4612,"KRN","B",.402,.402)

"BLD",4612,"KRN","B",.403,.403)

"BLD",4612,"KRN","B",.5,.5)

"BLD",4612,"KRN","B",.84,.84)

"BLD",4612,"KRN","B",3.6,3.6)

"BLD",4612,"KRN","B",3.8,3.8)

"BLD",4612,"KRN","B",9.2,9.2)

"BLD",4612,"KRN","B",9.8,9.8)

"BLD",4612,"KRN","B",19,19)

"BLD",4612,"KRN","B",19.1,19.1)

"BLD",4612,"KRN","B",101,101)

"BLD",4612,"KRN","B",409.61,409.61)

"BLD",4612,"KRN","B",771,771)

"BLD",4612,"KRN","B",870,870)

"BLD",4612,"KRN","B",8989.51,8989.51)

"BLD",4612,"KRN","B",8989.52,8989.52)

"BLD",4612,"KRN","B",8994,8994)

"BLD",4612,"QUES",0)
^9.62^^
"BLD",4612,"REQB",0)
^9.611^3^3
"BLD",4612,"REQB",1,0)
RA*5.0*18^2
"BLD",4612,"REQB",2,0)
RA*5.0*27^2
"BLD",4612,"REQB",3,0)
RA*5.0*31^2
"BLD",4612,"REQB","B","RA*5.0*18",1)

"BLD",4612,"REQB","B","RA*5.0*27",2)

"BLD",4612,"REQB","B","RA*5.0*31",3)

"FIA",74)
RAD/NUC MED REPORTS
"FIA",74,0)
^RARPT(
"FIA",74,0,0)
74I
"FIA",74,0,1)
y^n^p^^^^n^^n
"FIA",74,0,10)

"FIA",74,0,11)

"FIA",74,0,"RLRO")

"FIA",74,0,"VR")
5.0^RA
"FIA",74,74)
1
"FIA",74,74,10)

"KRN",.402,228,-1)
0^2
"KRN",.402,228,0)
RA REPORT EDIT^3030825.0859^^74^^^3030904
"KRN",.402,228,"%D",0)
^.4021^2^2^2990429^^^
"KRN",.402,228,"%D",1,0)
This template is used for entering and editing reports in the reports
"KRN",.402,228,"%D",2,0)
file.
"KRN",.402,228,"DR",1,74)
I '$D(RACT) W !?3,$C(7),"Variable RACT must be defined to continue!" S Y="@99";S:RACT'="I" Y="@10";6///^S X="NOW";11////^S X=DUZ;@10;S RATRSC=$P(^RARPT(DA,"T"),U);
"KRN",.402,228,"DR",1,74,1)
I $D(RARPDT) I (RADTE\1)>(($E(RARPDT,7,10)-1700)_$E(RARPDT,1,2)_$E(RARPDT,4,5)) K RARPDT;8//^S X=$S($D(RARPDT):RARPDT,1:"");S:X?7N RARPDT=$E(X,4,5)_"/"_$E(X,6,7)_"/"_(1700+$E(X,1,3));@15;100///^S X="""NOW""";S:RACT="V" Y="@99";
"KRN",.402,228,"DR",1,74,2)
W !,"------------------------------------------------------------------------------";@1;D CHPRINT^RAUTL9;400;S RANODE="H";I $O(^RARPT(DA,RANODE,0)) D UPDT^RAUTL3("^RARPT("_DA_","""_RANODE_""",");
"KRN",.402,228,"DR",1,74,3)
W !,"------------------------------------------------------------------------------";@2;200;S RANODE="R" D EXIST^RAUTL9;I $O(^RARPT(DA,RANODE,0)) D UPDT^RAUTL3("^RARPT("_DA_","""_RANODE_""",");
"KRN",.402,228,"DR",1,74,4)
W !,"------------------------------------------------------------------------------";@3;300;S RANODE="I" D EXIST^RAUTL9;I $O(^RARPT(DA,RANODE,0)) D UPDT^RAUTL3("^RARPT("_DA_","""_RANODE_""",");
"KRN",.402,228,"DR",1,74,5)
W !,"------------------------------------------------------------------------------";I $O(^RARPT(DA,"I",0))>0 S Y=$S($D(RAONLINE):"@99",1:"@30");
"KRN",.402,228,"DR",1,74,6)
I $D(^RADPT(+$P(^RARPT(DA,0),U,2),"DT",(9999999.9999-$P(^RARPT(DA,0),U,3)),0)),$D(^RA(79,+$P(^(0),U,3),.1)),$P(^(.1),U,16)'["Y" S Y=$S($D(RAONLINE):"@99",1:"@30");I '$O(^RARPT(DA,"R",0)) S Y="@99";5///PROBLEM DRAFT;
"KRN",.402,228,"DR",1,74,7)
25///No Impression was entered for this report.;
"KRN",.402,228,"DR",1,74,8)
W !!?3,$C(7),"NOTE: This report does not have an impression.  As a result,",!?3,"      the report will be placed in a 'PROBLEM DRAFT' status",!?3,"      with an appropriate 'PROBLEM STATEMENT' entered as well.",!;S Y="@99";@30;
"KRN",.402,228,"DR",1,74,9)
D EN1^RAUTL9;S:'$D(DIRUT) Y="@40";D:$D(DIE("NO^"))&($G(DIE("NO^"))'="OUTOK")&($G(DIE("NO^"))'="BACKOUTOK") EN^DDIOL("EXIT NOT ALLOWED ??"_$C(7),"","!!?3");
"KRN",.402,228,"DR",1,74,10)
S:$D(DIE("NO^"))&($G(DIE("NO^"))'="OUTOK")&($G(DIE("NO^"))'="BACKOUTOK") Y="@30";5///^S X="^";@40;5///^S X=RASTATX;S:RASTATX="V" RACT=RASTATX S:RASTATX'="V" Y=$S($E(RASTATX)="P":"@50",1:"@99") I $E(RASTATX)'="P" K ^RARPT(DA,"P");
"KRN",.402,228,"DR",1,74,11)
I X="V",'$D(^XUSEC("RA VERIFY",DUZ)) W !!,$C(7),"You do not have the appropriate privileges to verify a report." S Y="@35";9///^S X=$S($D(RAELESIG):DUZ,1:"");S:$D(RAELESIG) Y="@33";9;
"KRN",.402,228,"DR",1,74,12)
I X=""!('X) W !!,$C(7),"You must enter the 'VERIFYING PHYSICIAN'." S Y="@35";@33;I '$D(RASIG("PER"))#2!('$D(RASIG("NAME"))#2) S Y="@34";S X1=RASIG("PER"),X=RASIG("NAME"),X2=DA D EN^XUSHSHP S RASIGCDE=X;10///^S X=RASIGCDE;@34;
"KRN",.402,228,"DR",1,74,13)
17////^S X=DUZ;S Y="@45";@35;5///DRAFT;S Y="@30";@45;7///^S X="NOW";S Y="@15";@50;25;@99;K RASTATX,RATRSC,RANODE,RASIGCDE;
"KRN",.402,228,"DR",2,74.01)
2////^S X=RACT;3////^S X=DUZ;
"KRN",.402,228,"ROU")
^RACTWR
"KRN",.402,228,"ROUOLD")
RACTWR
"KRN",.402,233,-1)
0^1
"KRN",.402,233,0)
RA VERIFY REPORT ONLY^3030825.09^^74^^^3030904
"KRN",.402,233,"%D",0)
^^1^1^2940607^
"KRN",.402,233,"%D",1,0)
This template is used for the verifying of reports.
"KRN",.402,233,"DR",1,74)
S RACT="";S RAOLDST=$P($G(^RARPT(DA,0)),U,5);I $O(^RARPT(DA,"I",0))>0 S Y="@1";I $D(^RADPT(+$P(^RARPT(DA,0),U,2),"DT",(9999999.9999-$P(^RARPT(DA,0),U,3)),0)),$D(^RA(79,+$P(^(0),U,3),.1)),$P(^(.1),U,16)'["Y" S Y="@1";
"KRN",.402,233,"DR",1,74,1)
5///PROBLEM DRAFT;25///No Impression was entered for this report.;
"KRN",.402,233,"DR",1,74,2)
W !!,?3,$C(7),"NOTE: This report does not have an impression.  As a result,",!?3,"      the report will be placed in a 'PROBLEM DRAFT' status",!?3,"      with an appropriate 'PROBLEM STATEMENT' entered as well.",!;S Y="@99";@1;
"KRN",.402,233,"DR",1,74,3)
I $P(^RARPT(DA,0),U,5)="PD",$D(^("P")) W !!?3,"This report currently has a status of 'PROBLEM DRAFT' with",!?3,"the following 'PROBLEM STATEMENT':",!!?10,^("P"),!;@5;D EN1^RAUTL9;S:'$D(DIRUT) Y="@7";
"KRN",.402,233,"DR",1,74,4)
D:$D(DIE("NO^"))&($G(DIE("NO^"))'="OUTOK")&($G(DIE("NO^"))'="BACKOUTOK") EN^DDIOL("EXIT NOT ALLOWED ??"_$C(7),"","!!?3");S:$D(DIE("NO^"))&($G(DIE("NO^"))'="OUTOK")&($G(DIE("NO^"))'="BACKOUTOK") Y="@5";5///^S X="^";@7;
"KRN",.402,233,"DR",1,74,5)
5///^S X=RASTATX;S RACT=RASTATX I $E(RACT)'="P" S Y=$S(RACT="V":"@10",1:"@99") K ^RARPT(DA,"P");25;S Y="@99";@10;I $D(RAONLINE),$D(RAVER),$D(RASIG("PER")),$D(RASIG("NAME")) S Y="@20";9//^S X=$S($D(RAVER):RAVER,1:"");
"KRN",.402,233,"DR",1,74,6)
I X=""!('X) W !!,$C(7),"You must enter the 'VERIFYING PHYSICIAN'." S Y="@15";K RAVER S:$D(^VA(200,X,0)) RAVER=$P(^(0),U);17////^S X=DUZ;S Y="@30";@15;5///DRAFT;S Y="@5";@20;9///^S X=RAVER;
"KRN",.402,233,"DR",1,74,7)
S X1=RASIG("PER"),X=RASIG("NAME"),X2=DA D EN^XUSHSHP S RASIGCDE=X;10///^S X=RASIGCDE;17////^S X=DUZ;K RASIGCDE,X2,X1;@30;Q;7///^S X="NOW";@99;I $E(RAOLDST)=$E(RACT) S Y="@999";100///^S X=$$MIDNGHT^RAUTL5($$NOW^XLFDT());@999;
"KRN",.402,233,"DR",1,74,8)
K RASTATX,RAOLDST;
"KRN",.402,233,"DR",2,74.01)
2///^S X=$S($E(RACT)="V":"V",1:"E");3////^S X=DUZ;
"KRN",.402,233,"ROU")
^RACTVR
"KRN",.402,233,"ROUOLD")
RACTVR
"MBREQ")
0
"ORD",7,.402)
.402;7;;;EDEOUT^DIFROMSO(.402,DA,"",XPDA);FPRE^DIFROMSI(.402,"",XPDA);EPRE^DIFROMSI(.402,DA,$E("N",$G(XPDNEW)),XPDA,"",OLDA);;EPOST^DIFROMSI(.402,DA,"",XPDA);DEL^DIFROMSK(.402,"",%)
"ORD",7,.402,0)
INPUT TEMPLATE
"PKG",18,-1)
1^1
"PKG",18,0)
RADIOLOGY/NUCLEAR MEDICINE^RA^REGISTERS PATIENTS,RECORDS EXAMS,PROFILES,AMIS REPORTS
"PKG",18,20,0)
^9.402P^^
"PKG",18,22,0)
^9.49I^1^1
"PKG",18,22,1,0)
5.0^3011017^2980407^50
"PKG",18,22,1,"PAH",1,0)
43^3030918
"PKG",18,22,1,"PAH",1,1,0)
^^2^2^3030918
"PKG",18,22,1,"PAH",1,1,1,0)
Plese refer the patch description on FORUM for a detailed account of the 
"PKG",18,22,1,"PAH",1,1,2,0)
changes exported with this patch.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
3
"RTN","RAMAIN")
0^1^B29647242
"RTN","RAMAIN",1,0)
RAMAIN ;HISC/FPT,GJC,CAH AISC/MJK,RMO-Utility File Maintenance ;7/24/02  14:45
"RTN","RAMAIN",2,0)
 ;;5.0;Radiology/Nuclear Medicine;**31,43**;Mar 16, 1998
"RTN","RAMAIN",3,0)
 ;
"RTN","RAMAIN",4,0)
3 ;;Major AMIS Code Enter/Edit
"RTN","RAMAIN",5,0)
 N RAI F RAI=1:1:5 W !?9,$P($T(REMIND+RAI),";;",2)
"RTN","RAMAIN",6,0)
 S DIR(0)="Y",DIR("B")="No"
"RTN","RAMAIN",7,0)
 S DIR("A")="          add/change any AMIS codes and weight"
"RTN","RAMAIN",8,0)
 S DIR("A",1)="          Do you have approval from Radiology Service VACO to"
"RTN","RAMAIN",9,0)
 D ^DIR K DIR Q:$D(DIRUT)  Q:'Y
"RTN","RAMAIN",10,0)
L3 S DIC="^RAMIS(71.1,",DIC(0)="AEMQ" W ! D ^DIC K DIC I Y<0 K D,X,Y,DDH,I,POP,DISYS Q
"RTN","RAMAIN",11,0)
 S DA=+Y,DIE="^RAMIS(71.1,",DR=".01;2" D ^DIE K %,%W,%Y,D0,DA,DE,DQ,DIE,DR,DI,I,POP G L3
"RTN","RAMAIN",12,0)
REMIND ;;
"RTN","RAMAIN",13,0)
 ;;+----------------------------------------------------------+
"RTN","RAMAIN",14,0)
 ;;| New entries and modifications to existing entries are    |
"RTN","RAMAIN",15,0)
 ;;| prohibited without approval from Radiology Service VACO. |
"RTN","RAMAIN",16,0)
 ;;+----------------------------------------------------------+
"RTN","RAMAIN",17,0)
 ;
"RTN","RAMAIN",18,0)
4 ;;Film Type Enter/Edit
"RTN","RAMAIN",19,0)
 K DD,DIC,DLAYGO,DO
"RTN","RAMAIN",20,0)
 S DIC="^RA(78.4,",DIC(0)="AEMQL",DLAYGO=78.4 W ! D ^DIC
"RTN","RAMAIN",21,0)
 K DD,DIC,DLAYGO,DO
"RTN","RAMAIN",22,0)
 I +Y<0 D  D Q4 Q
"RTN","RAMAIN",23,0)
 . D DSPLNKS^RAMAIN1
"RTN","RAMAIN",24,0)
 . K D,DI,X,Y
"RTN","RAMAIN",25,0)
 . Q
"RTN","RAMAIN",26,0)
 S DA=+Y,DIE="^RA(78.4,",DR=".01;2;3;4;5;S:+X'=1 Y=""@1"";6;@1"
"RTN","RAMAIN",27,0)
 D ^DIE S RA784=$G(^RA(78.4,DA,0)),RA784(1)=$P(RA784,U)
"RTN","RAMAIN",28,0)
 S RA784(5)=+$P(RA784,U,4),RA784(6)=$P(RA784,U,5)
"RTN","RAMAIN",29,0)
 I RA784(5),(RA784(6)']"") D
"RTN","RAMAIN",30,0)
 . N DIE,DR
"RTN","RAMAIN",31,0)
 . W !!?5,$C(7),"'"_RA784(1)_"' has been defined as a wasted film size."
"RTN","RAMAIN",32,0)
 . W !?5,"If a particular film size is deemed as a wasted piece of"
"RTN","RAMAIN",33,0)
 . W !?5,"film, the wasted piece of film must be associated with an"
"RTN","RAMAIN",34,0)
 . W !?5,"unwasted piece of film."
"RTN","RAMAIN",35,0)
 . W !!?5,"Redefining '"_RA784(1)_"' as an unwasted film size."
"RTN","RAMAIN",36,0)
 . S DIE="^RA(78.4,",DR="5///@" D ^DIE W "   Done!"
"RTN","RAMAIN",37,0)
 . Q
"RTN","RAMAIN",38,0)
 K %,D0,DA,DE,DQ,DIE,DR,RA784,X,Y G 4
"RTN","RAMAIN",39,0)
Q4 K I,POP,DISYS,DDH
"RTN","RAMAIN",40,0)
 Q
"RTN","RAMAIN",41,0)
 ;
"RTN","RAMAIN",42,0)
5 ;;Diagnostic Code Enter/Edit
"RTN","RAMAIN",43,0)
 S DIC="^RA(78.3,",DIC(0)="AEMQL",DLAYGO=78.3 W ! D ^DIC K DIC,DLAYGO I Y<0 K D,X,Y,POP,I Q
"RTN","RAMAIN",44,0)
 S DA=+Y,DIE="^RA(78.3,",DR="2:5" D ^DIE K %,D0,DA,DE,DQ,DIE,DR,I,DI G 5
"RTN","RAMAIN",45,0)
 ;
"RTN","RAMAIN",46,0)
6 ;;Flash Card/Label Formatter
"RTN","RAMAIN",47,0)
 W:'$D(RAFLH) !!?5,">>> Exam Label/Report Header/Report Footer/Flash Card Formatter <<<"
"RTN","RAMAIN",48,0)
 S DIC="^RA(78.2,",DIC(0)="AEMQL",DLAYGO=78.2 W ! D ^DIC K DIC,DLAYGO G Q6:Y<0 S (RAFLH,DA)=+Y,DIE="^RA(78.2,",DR="[RA FLASH CARD EDIT]" D ^DIE K DE,DQ,DIE,DR I '$D(^RA(78.2,RAFLH,0)) G Q6
"RTN","RAMAIN",49,0)
 S RAFMT=RAFLH,RAK=0
"RTN","RAMAIN",50,0)
 F  S RAK=$O(^RA(78.7,RAK)) Q:RAK'>0  D SETFLH^RAFLH2(RAK)
"RTN","RAMAIN",51,0)
 D CMP^RAFLH1
"RTN","RAMAIN",52,0)
 W !!,"<<<<<<----------------------------Column No.------------------------------>>>>>>"
"RTN","RAMAIN",53,0)
 W !!,"0--------1---------2---------3---------4---------5---------6---------7---------8"
"RTN","RAMAIN",54,0)
 W !,"1        0         0         0         0         0         0         0         0",! S RATEST="",RANUM=1,RAFFLF="!" D PRT^RAFLH K RAFFLF W !! G 6
"RTN","RAMAIN",55,0)
Q6 S RAK=0 F  S RAK=$O(^RA(78.7,RAK)) Q:RAK'>0  D KILFLH^RAFLH2(RAK)
"RTN","RAMAIN",56,0)
 K %,%W,%X,%Y,D,D0,D1,DA,FL,RA787,RATEST,RAII,RAK,RAFLH,RAFMT,RANUM,X,Y
"RTN","RAMAIN",57,0)
 K POP,I,DDH,DUOUT,DI,DISYS
"RTN","RAMAIN",58,0)
 Q
"RTN","RAMAIN",59,0)
 ;
"RTN","RAMAIN",60,0)
7 ;;Complication Type Enter/Edit
"RTN","RAMAIN",61,0)
 S DIC="^RA(78.1,",DIC(0)="AEMQL",DLAYGO=78.1 W ! D ^DIC K DIC,DLAYGO I Y<0 K D,X,Y G Q7
"RTN","RAMAIN",62,0)
 S DA=+Y,DIE="^RA(78.1,",DR=".01;2" D ^DIE K %,D,D0,DA,DE,DQ,DIE,DR D Q7 G 7
"RTN","RAMAIN",63,0)
Q7 K DI,DISYS,I,POP Q
"RTN","RAMAIN",64,0)
 ;
"RTN","RAMAIN",65,0)
8 ;;Sharing/Contract Agreement Entry/Edit
"RTN","RAMAIN",66,0)
 S DIC="^DIC(34,",DIC(0)="AELMQ",DIC("A")="Select Agreement/Contract: ",DLAYGO=34 W ! D ^DIC K DIC,DLAYGO I Y<0 K D,X,Y,I,POP Q
"RTN","RAMAIN",67,0)
 S DA=+Y,DIE="^DIC(34,",DR=".01:3" D ^DIE K %,%W,%X,%Y,D,D0,DA,DE,DQ,DIE,DR,X,Y,DI,DISYS G 8
"RTN","RAMAIN",68,0)
 ;
"RTN","RAMAIN",69,0)
9 ;;Standard Reports
"RTN","RAMAIN",70,0)
 S DIC="^RA(74.1,",DIC(0)="AEMQL",DLAYGO=74.1 W ! D ^DIC K DIC,DLAYGO I Y<0 K D,X,Y D Q9 Q
"RTN","RAMAIN",71,0)
 S DA=+Y,DIE="^RA(74.1,",DR="[RA STANDARD REPORT ENTRY]" D ^DIE K %,%W,%X,%Y,C,D,D0,DA,DE,DQ,DIE,DR,X,Y D Q9 G 9
"RTN","RAMAIN",72,0)
Q9 K DDH,DI,DISYS,I,J,POP
"RTN","RAMAIN",73,0)
 Q
"RTN","RAMAIN",74,0)
 ;
"RTN","RAMAIN",75,0)
10 ;;Procedure Modifiers Entry
"RTN","RAMAIN",76,0)
 K DD,DO,DLAYGO,DIC,DA,DINUM,X,Y
"RTN","RAMAIN",77,0)
 S (DIC,DLAYGO)="^RAMIS(71.2,",DIC(0)="AEMQL"
"RTN","RAMAIN",78,0)
 S DIC("A")="Select Procedure Modifier: ",DIC("W")="D PROHLP^RAMAIN"
"RTN","RAMAIN",79,0)
 W ! D ^DIC K DIC,DLAYGO I +Y'>0 K D,X,Y,POP,I,DDH,DG,DISYS,DUOUT Q
"RTN","RAMAIN",80,0)
 S DIE="^RAMIS(71.2,",DA=+Y,DR="3;4" D ^DIE
"RTN","RAMAIN",81,0)
 K %W,%X,%Y,D,DIE,DO,DD,DLAYGO,DA,DR,X,Y,POP,I,D0,DI,DISYS,DQ,C G 10
"RTN","RAMAIN",82,0)
 ;
"RTN","RAMAIN",83,0)
11 ;;Reports Distribution Edit
"RTN","RAMAIN",84,0)
 S DIC="^RABTCH(74.3,",DIC(0)="AEMQ" W ! D ^DIC K DIC I Y<0 K D,X,Y,I,POP Q
"RTN","RAMAIN",85,0)
 S DA=+Y,DIE="^RABTCH(74.3,",DR="[RA DISTRIBUTION EDIT]" D ^DIE K %,%W,%X,%Y,D,D0,DA,DE,DQ,DIE,DR,X,Y,DI,DISYS,I,POP G 11
"RTN","RAMAIN",86,0)
 ;
"RTN","RAMAIN",87,0)
12 ;;Rad/Nuc Med Procedure Message Enter/Edit
"RTN","RAMAIN",88,0)
 S DIC="^RAMIS(71.4,",DIC(0)="AELMQ",DLAYGO=71.4
"RTN","RAMAIN",89,0)
 W ! D ^DIC K DIC,DLAYGO I Y<0 K D,DTOUT,DUOUT,X,Y Q
"RTN","RAMAIN",90,0)
 S DA=+Y,DIE="^RAMIS(71.4,",DR=.01 D ^DIE
"RTN","RAMAIN",91,0)
 K %,%W,%X,%Y,D0,DA,DE,DQ,DR,DIE,X,Y G 12
"RTN","RAMAIN",92,0)
 ;
"RTN","RAMAIN",93,0)
13 ;;Cost of Procedure Enter/Edit
"RTN","RAMAIN",94,0)
 I '$D(RACCESS(DUZ)) D SET^RAPSET1 I $D(XQUIT) K RACCESS,XQUIT Q
"RTN","RAMAIN",95,0)
 ; ask img type
"RTN","RAMAIN",96,0)
 K ^TMP($J,"RA I-TYPE") D SELIMG^RAUTL7 G:$G(RAQUIT) 139
"RTN","RAMAIN",97,0)
 N RA0,RA1,RA2 S RA0="",RA2=""
"RTN","RAMAIN",98,0)
131 S RA0=$O(^TMP($J,"RA I-TYPE",RA0)) G:RA0="" 133
"RTN","RAMAIN",99,0)
132 S RA1=$O(^TMP($J,"RA I-TYPE",RA0,0)) G:'RA1 131
"RTN","RAMAIN",100,0)
 S RA2=RA1_U_RA2 G 131
"RTN","RAMAIN",101,0)
133 G:RA2="" 139 S DIC="^RAMIS(71,",DIC(0)="AEMQ"
"RTN","RAMAIN",102,0)
 ; restrict choice of procedure by img type selected
"RTN","RAMAIN",103,0)
 S DIC("S")="I RA2[$P(^(0),U,12)"
"RTN","RAMAIN",104,0)
 W ! D ^DIC K DIC I Y<0 K %,DTOUT,DUOUT,DIC,X,Y G 139
"RTN","RAMAIN",105,0)
 S DA=+Y,DIE="^RAMIS(71,",DR=10 D ^DIE
"RTN","RAMAIN",106,0)
 K D,D0,DA,DDH,DI,DIC,DIE,DQ,DR,X
"RTN","RAMAIN",107,0)
 G 133
"RTN","RAMAIN",108,0)
139 K ^TMP($J,"RA I-TYPE"),RAQUIT
"RTN","RAMAIN",109,0)
 Q
"RTN","RAMAIN",110,0)
 ;
"RTN","RAMAIN",111,0)
PROHLP ; Help displays the modifiers and all associated imaging types.
"RTN","RAMAIN",112,0)
 D:'$D(IOM) HOME^%ZIS
"RTN","RAMAIN",113,0)
 N RAIT,RAIT1,RAIT2,RAIT3 Q:'+$O(^RAMIS(71.2,+Y,1,0))  ; Quit, no data
"RTN","RAMAIN",114,0)
 S (RAIT,RAIT3)=0
"RTN","RAMAIN",115,0)
 F  S RAIT=+$O(^RAMIS(71.2,+Y,1,RAIT)) W:'RAIT ")" Q:'RAIT  D
"RTN","RAMAIN",116,0)
 . S RAIT1=+$G(^RAMIS(71.2,+Y,1,RAIT,0))
"RTN","RAMAIN",117,0)
 . S RAIT2=$P($G(^RA(79.2,RAIT1,0)),"^",3)
"RTN","RAMAIN",118,0)
 . W:($X+5)>IOM !?2 W ?$X+1 W:'RAIT3 "(" W RAIT2 S RAIT3=1
"RTN","RAMAIN",119,0)
 . Q
"RTN","RAMAIN",120,0)
 Q
"RTN","RART")
0^2^B21428021
"RTN","RART",1,0)
RART ;HISC/CAH,FPT,GJC AISC/MJK,TMP,RMO-Reporting Menu ;11/16/98  15:02
"RTN","RART",2,0)
 ;;5.0;Radiology/Nuclear Medicine;**2,5,15,18,43**;Mar 16, 1998
"RTN","RART",3,0)
 ;;last modification by SS for P18 June 15, 2000
"RTN","RART",4,0)
3 ;;Verify a Report
"RTN","RART",5,0)
 D SET^RAPSET1 I $D(XQUIT) K XQUIT Q
"RTN","RART",6,0)
 I $D(RANOSCRN) S X=$$DIVLOC^RAUTL7() I X D Q QUIT
"RTN","RART",7,0)
 G:$D(^VA(200,"ARC","S",DUZ))!($D(^XUSEC("RA VERIFY",DUZ))) 30
"RTN","RART",8,0)
 G:$P(RAMDV,"^",18)=1 30
"RTN","RART",9,0)
 G:'$D(^VA(200,"ARC","R",DUZ)) 30
"RTN","RART",10,0)
 I $P(RAMDV,"^",18)'=1 W !!,$C(7),"Interpreting Residents are not allowed to verify reports." G Q
"RTN","RART",11,0)
30 K RAUP S RAPGM=30,RAREPORT=1 D ^RACNLU G Q:X="^" I '$D(^RARPT(+RARPT,0)) W !!?2,$C(7),"No report available!" G 30
"RTN","RART",12,0)
 I $P(^RARPT(+RARPT,0),"^",5)="V" W !!?2,$C(7),"Report already verified!" G 30
"RTN","RART",13,0)
SS1 Q:$$VERONLY^RAUTL11=-1  ;P18 case info 
"RTN","RART",14,0)
31 S DIE("NO^")="",DA=RARPT,DR="[RA VERIFY REPORT ONLY]",DIE="^RARPT("
"RTN","RART",15,0)
 S RAIMGTYI=$P($G(^RADPT(RADFN,"DT",RADTI,0)),U,2),RAIMGTYJ=$P($G(^RA(79.2,+RAIMGTYI,0)),U)
"RTN","RART",16,0)
 I RAIMGTYJ']"" W !,"Error: Cannot determine imaging type of exam.",! K RAIMGTYI,RAIMGTYJ G @RAPGM
"RTN","RART",17,0)
 ; must lock both report AND case together, so to ensure 
"RTN","RART",18,0)
 ; that a verified report has the correct diagnostic codes
"RTN","RART",19,0)
 S RAXIT=$$LOCK^RAUTL12(DIE,DA) ; lock Report
"RTN","RART",20,0)
 I RAXIT K RAXIT G @RAPGM
"RTN","RART",21,0)
 S RASAVDIE="^RADPT("_RADFN_",""DT"","_RADTI_",""P"",",RASAVDA(2)=RADFN,RASAVDA(1)=RADTI,RASAVDA=RACNI
"RTN","RART",22,0)
 ; rpt exists & locked, thus no need to lock at "DT" level because users
"RTN","RART",23,0)
 ; can only use 'report entry/edit' option to enter dx's for printsets
"RTN","RART",24,0)
 S RAXIT=$$LOCK^RAUTL12(RASAVDIE,.RASAVDA) ; lock case before asking REPORT STATUS
"RTN","RART",25,0)
 I RAXIT K RAXIT G @RAPGM
"RTN","RART",26,0)
 D ^DIE K DE,DQ,DR D UNLOCK^RAUTL12(DIE,DA) ; unlock Report
"RTN","RART",27,0)
 K DIE,RAXIT
"RTN","RART",28,0)
 S X=+$O(^RA(72,"AA",RAIMGTYJ,9,0)),DA(2)=RADFN,DA(1)=RADTI,DA=RACNI,DIE="^RADPT("_DA(2)_",""DT"","_DA(1)_",""P"","
"RTN","RART",29,0)
 S DR=13_$S(RACT'="V":"",'$D(^RA(72,X,.1)):"",$P(^(.1),"^",5)'="Y":"",1:"R")_";I $D(^RA(78.3,+X,0)),$P(^(0),""^"",4)=""y"" S RAAB=1 "
"RTN","RART",30,0)
 I RACT="V",($P($G(^RA(72,+X,.1)),"^",5)="Y") S DIE("NO^")="BACK"
"RTN","RART",31,0)
 D ^DIE
"RTN","RART",32,0)
 K DA,DE,DQ,DIE,DR
"RTN","RART",33,0)
 I $P(^RADPT(RADFN,"DT",RADTI,"P",RACNI,0),U,13)="" G UNL31
"RTN","RART",34,0)
 S DR="50///"_RACN
"RTN","RART",35,0)
 S DR(2,70.03)=13.1
"RTN","RART",36,0)
 S DR(3,70.14)=.01_";I $D(^RA(78.3,+X,0)),$P(^(0),""^"",4)=""y"" S RAAB=1"
"RTN","RART",37,0)
 S DA(1)=RADFN,DA=RADTI,DIE="^RADPT("_DA(1)_",""DT"","
"RTN","RART",38,0)
 D ^DIE
"RTN","RART",39,0)
UNL31 ; copy then unlock
"RTN","RART",40,0)
 N:'$D(RAPRTSET) RAPRTSET N:'$D(RAMEMARR) RAMEMARR
"RTN","RART",41,0)
 D EN2^RAUTL20(.RAMEMARR)
"RTN","RART",42,0)
 I RAPRTSET S RADRS=1,RAXIT=0 D COPY^RARTE2 ; copy diagnoses
"RTN","RART",43,0)
 D UNLOCK^RAUTL12(RASAVDIE,.RASAVDA) ; use params from PrimDiag's lock
"RTN","RART",44,0)
 K RASAVDIE,RASAVDA
"RTN","RART",45,0)
 K DA,DE,DQ,DIE,DR
"RTN","RART",46,0)
32 K RAXIT
"RTN","RART",47,0)
 I $G(RAPGM)="GETRPT^RARTVER" I $E(RACT'="V"),($P(^RARPT(RARPT,0),U,14)]"") D RETURN^RARTVER2
"RTN","RART",48,0)
PACS I (RACT="V")!(RACT="R") D TASK^RAHLO4
"RTN","RART",49,0)
 I RACT="V",$T(CREATE^WVRALINK)]"" D CREATE^WVRALINK(RADFN,RADTI,RACNI) ;women's health
"RTN","RART",50,0)
 ;
"RTN","RART",51,0)
 I RAPGM="NXT^RABTCH1" G @RAPGM
"RTN","RART",52,0)
TIME D:RACT="V" UPSTAT^RAUTL0 K RAAB
"RTN","RART",53,0)
 I $G(RARDX)="S" D
"RTN","RART",54,0)
 . D SAVE^RARTVER2
"RTN","RART",55,0)
 . I $G(RAPGM)="GETRPT^RARTVER" D
"RTN","RART",56,0)
 .. ; for 'On-line Verifying of Reports' default device selection is the
"RTN","RART",57,0)
 .. ; "REPORT PRINTER NAME"
"RTN","RART",58,0)
 .. S %ZIS("B")=$P($G(RAMLC),"^",10) K:%ZIS("B")']"" %ZIS("B")
"RTN","RART",59,0)
 .. Q
"RTN","RART",60,0)
 . D Q^RARTR,RESTORE^RARTVER2
"RTN","RART",61,0)
 . K:$D(%ZIS("B")) %ZIS("B")
"RTN","RART",62,0)
 . Q
"RTN","RART",63,0)
 G @RAPGM
"RTN","RART",64,0)
Q K %,%DT,%X,C,D,D0,D1,DA,DIC,RACN,RACNI,RACT,RADATE,RADFN,RADTE,RADTI,RADUZ,RAHEAD,RAI,RAIMGTYI,RAIMGTYJ,RANME,RANUM,RAOR,RAPGM,RAPRC,RAQUIT,RAREPORT,RARPT,RASET,RASN,RASSN,RAST,RASTI,RAUP,RAVER,X,Y,^TMP($J,"RAEX")
"RTN","RART",65,0)
 K %W,%Y,%Y1,DDER,DI,DIROUT,DIRUT,DLAYGO,DTOUT,DUOUT,RACI,ZTSK,POP,DDH
"RTN","RART",66,0)
 Q
"RTN","RART",67,0)
OERR1 ; Jump to 'OERR1^RART1' This is necessary to support the reference to
"RTN","RART",68,0)
 ; this line label in the OE/RR Notifications file.
"RTN","RART",69,0)
 G OERR1^RART1 Q
"RTN","RART",70,0)
 ;
"RTN","RART",71,0)
PRTDX ; print dx codes on report display (called from RART1)
"RTN","RART",72,0)
 K RAFLG D WAIT^RART1:($Y+6)>IOSL&('$D(RARTVERF))
"RTN","RART",73,0)
 Q:X="^"!(X="T")!(X="P")
"RTN","RART",74,0)
 S RADXCODE=$P(^RADPT(RADFN,"DT",RADTI,"P",RACNI,0),U,13)
"RTN","RART",75,0)
 W !?3,"Primary Diagnostic Code: ",!?2,$S($D(^RA(78.3,+RADXCODE,0)):$P(^(0),U,1),1:"") K RAFLG
"RTN","RART",76,0)
 D WAIT^RART1:($Y+6)>IOSL&('$D(RARTVERF)) Q:X="^"!(X="T")!(X="P")
"RTN","RART",77,0)
 I '$O(^RADPT(RADFN,"DT",RADTI,"P",RACNI,"DX",0)) W ! Q
"RTN","RART",78,0)
 W !!?3,"Secondary Diagnostic Codes: "
"RTN","RART",79,0)
 S RADXCODE=0
"RTN","RART",80,0)
 F  S RADXCODE=$O(^RADPT(RADFN,"DT",RADTI,"P",RACNI,"DX","B",RADXCODE)) Q:RADXCODE'>0!('$D(^RA(78.3,+RADXCODE,0)))!($D(RAOOUT))  K RAFLG D WAIT^RART1:($Y+6)>IOSL&('$D(RARTVERF)) Q:X="^"!(X="T")!(X="P")  W !?2,$P(^RA(78.3,RADXCODE,0),U,1)
"RTN","RART",81,0)
 W !
"RTN","RART",82,0)
 Q
"RTN","RART",83,0)
EXIT ; Kill variables created when user prints 'Abnormal Rad/Nuc Med Report
"RTN","RART",84,0)
 ; Alert'.  Variables are created when 'PRT^RARTR' is called.
"RTN","RART",85,0)
 K %X,%XX,%Y,%YY,A,DDER,DFN,DI,DIR,DIW,DIWI,DIWT,DIWTC,DIWX,DLAYGO
"RTN","RART",86,0)
 K DN,RACI,RACN0,RACPT,RACPTNDE,RADTE0,RADTV,RAN,RAOBR4,RAPRCNDE
"RTN","RART",87,0)
 K RAPROC,RAPROCIT,RAPRV,RARPT0,VA,VADM,VAERR,X2,ZTSK
"RTN","RART",88,0)
 Q
"RTN","RARTR")
0^3^B53486671
"RTN","RARTR",1,0)
RARTR ;HISC/CAH COLUMBIA/REB AISC/MJK,RMO-Queue/print Reports ;11/27/98  09:05
"RTN","RARTR",2,0)
 ;;5.0;Radiology/Nuclear Medicine;**5,13,16,27,43**;Mar 16, 1998
"RTN","RARTR",3,0)
PRT ; Begin print/build of e-mail message
"RTN","RARTR",4,0)
 ;
"RTN","RARTR",5,0)
 ; ** NOTE: If the layout of this output is changed  **
"RTN","RARTR",6,0)
 ; **       please check that routine RAO7PC3 is     **
"RTN","RARTR",7,0)
 ; **       not affected. It assumes fixed format of **
"RTN","RARTR",8,0)
 ; **       the following headings:                  **
"RTN","RARTR",9,0)
 ; **            Clinical History:                   **
"RTN","RARTR",10,0)
 ; **            Report:                             **
"RTN","RARTR",11,0)
 ; **            Impression:                         **
"RTN","RARTR",12,0)
 ; **            Primary Diagnostic Code:            **
"RTN","RARTR",13,0)
 ; **            Secondary Diagnostic Codes:         **
"RTN","RARTR",14,0)
 ; **            Primary Interpreting Staff:         **
"RTN","RARTR",15,0)
 ;
"RTN","RARTR",16,0)
 S RAFFLF=IOF U:'$D(RAUTOE) IO Q:'$D(^RARPT(+$G(RARPT),0))
"RTN","RARTR",17,0)
 W:$Y>0&('$D(RAUTOE)) @RAFFLF ;If RAUTOE defined build mail msg
"RTN","RARTR",18,0)
 S X=$G(^RARPT(+$G(RARPT),0)),RAORIOF=RAFFLF
"RTN","RARTR",19,0)
 ;S RAFFLF=$S('$D(ORACTION):RAFFLF,ORACTION'=8:RAFFLF,1:"!")
"RTN","RARTR",20,0)
 D INIT ; setup exam/report variables
"RTN","RARTR",21,0)
 I RAY0<0!(RAY1<0)!(RAY2<0)!(RAY3<0) K RAFFLF Q  ; data nodes missing
"RTN","RARTR",22,0)
 ;
"RTN","RARTR",23,0)
PRT1 I $D(RAUTOE) D
"RTN","RARTR",24,0)
 . S ^TMP($J,"RA AUTOE",$$INCR^RAUTL4(RAACNT))=" "
"RTN","RARTR",25,0)
 . I $D(RADDEN) D
"RTN","RARTR",26,0)
 .. S ^TMP($J,"RA AUTOE",$$INCR^RAUTL4(RAACNT))="Report Unverified by: "_$P($G(^VA(200,$S($G(RADUZ):RADUZ,1:DUZ),0)),"^")
"RTN","RARTR",27,0)
 .. Q
"RTN","RARTR",28,0)
 . Q
"RTN","RARTR",29,0)
 I +$O(^RARPT(RARPT,"ERR",0)) D
"RTN","RARTR",30,0)
 . S RAERRFLG="" ; set for future reference (display AMENRPT^RARTR text)
"RTN","RARTR",31,0)
 . W:'$D(RAUTOE) !!?10,$$AMENRPT^RARTR2(),!
"RTN","RARTR",32,0)
 . I $D(RAUTOE) D
"RTN","RARTR",33,0)
 .. S ^TMP($J,"RA AUTOE",$$INCR^RAUTL4(RAACNT))=" "
"RTN","RARTR",34,0)
 .. S ^TMP($J,"RA AUTOE",$$INCR^RAUTL4(RAACNT))="         "_$$AMENRPT^RARTR2()
"RTN","RARTR",35,0)
 .. Q
"RTN","RARTR",36,0)
 . Q
"RTN","RARTR",37,0)
 I $P(RAY3,"^",25)<2 D  G END:$D(RAOOUT)
"RTN","RARTR",38,0)
 . D MODS^RAUTL2,OUT1^RARTR3
"RTN","RARTR",39,0)
 . D:+$P(RAY3,"^",28) RDIO^RARTUTL(+$P(RAY3,"^",28))  Q:$D(RAOOUT)
"RTN","RARTR",40,0)
 . D:+$O(^RADPT(RADFN,"DT",RADTI,"P",RACNI,"RX",0)) PHARM^RARTUTL(RACNI_","_RADTI_","_RADFN_",")
"RTN","RARTR",41,0)
 . W:'$D(RAUTOE) !
"RTN","RARTR",42,0)
 . S:$D(RAUTOE) ^TMP($J,"RA AUTOE",$$INCR^RAUTL4(RAACNT))=""
"RTN","RARTR",43,0)
 . Q
"RTN","RARTR",44,0)
 I $P(RAY3,"^",25)>1 D
"RTN","RARTR",45,0)
 . D MEMS1^RARTR3
"RTN","RARTR",46,0)
 . W:'$D(RAUTOE) !
"RTN","RARTR",47,0)
 . S:$D(RAUTOE) ^TMP($J,"RA AUTOE",$$INCR^RAUTL4(RAACNT))=""
"RTN","RARTR",48,0)
 . Q
"RTN","RARTR",49,0)
 G END:$D(RAOOUT)
"RTN","RARTR",50,0)
 ; Check for duplicate history in file 70 and 74.
"RTN","RARTR",51,0)
 D CHKDUPHX^RART1  ; Sets RADUPHX to 1 for duplicate or 0 if different.
"RTN","RARTR",52,0)
 F RAP="H","AH","R","I" K ^UTILITY($J,"W"),^(1) D  G END:$D(RAOOUT)
"RTN","RARTR",53,0)
 . S RAP("P")=$S(RAP="H":"Clinical History:",RAP="AH":"Additional Clinical History:",RAP="R":"Report:",1:"Impression:")
"RTN","RARTR",54,0)
 . ; Don't continue if printing Additional Clinical History and it is a
"RTN","RARTR",55,0)
 . ; duplicate of Clinical History.
"RTN","RARTR",56,0)
 . Q:RAP="AH"&(RADUPHX>0)
"RTN","RARTR",57,0)
 . W:'$D(RAUTOE) !?RATAB,RAP("P")
"RTN","RARTR",58,0)
 . I $D(RAUTOE),($D(RADDEN)),(RAP="R") D
"RTN","RARTR",59,0)
 .. N RABAN1,RABAN2,RASPCE S $P(RASPCE," ",46)=""
"RTN","RARTR",60,0)
 .. S RABAN1="*** Uncorrected Version   ***"
"RTN","RARTR",61,0)
 .. S RABAN2="*** Refer to final report ***"
"RTN","RARTR",62,0)
 .. S ^TMP($J,"RA AUTOE",$$INCR^RAUTL4(RAACNT))=""
"RTN","RARTR",63,0)
 .. S ^TMP($J,"RA AUTOE",$$INCR^RAUTL4(RAACNT))=RASPCE_RABAN1
"RTN","RARTR",64,0)
 .. S ^TMP($J,"RA AUTOE",$$INCR^RAUTL4(RAACNT))=RASPCE_RABAN2
"RTN","RARTR",65,0)
 .. S ^TMP($J,"RA AUTOE",$$INCR^RAUTL4(RAACNT))=""
"RTN","RARTR",66,0)
 .. Q
"RTN","RARTR",67,0)
 . S:$D(RAUTOE) ^TMP($J,"RA AUTOE",$$INCR^RAUTL4(RAACNT))="    "_RAP("P")
"RTN","RARTR",68,0)
 . W:$D(RASTFL)&(RAP="R")&('$D(RAUTOE)) ?45,"Status: ",$$XTERNAL^RAUTL5(RAST,$P($G(^DD(74,5,0)),"^",2))
"RTN","RARTR",69,0)
 . I RAP="R",($D(RAUTOE)) D
"RTN","RARTR",70,0)
 .. S $P(RAP("S")," ",(46-$L(^TMP($J,"RA AUTOE",RAACNT))))=""
"RTN","RARTR",71,0)
 .. I '$D(RADDEN) S ^TMP($J,"RA AUTOE",RAACNT)=^(RAACNT)_RAP("S")_"Status: "_$$XTERNAL^RAUTL5(RAST,$P($G(^DD(74,5,0)),"^",2))
"RTN","RARTR",72,0)
 .. Q
"RTN","RARTR",73,0)
 . D:$D(RAUTOE) SET^RARTR2
"RTN","RARTR",74,0)
 . D:'$D(RAUTOE) WRITE^RARTR2 Q:$D(RAOOUT)
"RTN","RARTR",75,0)
 . K ^UTILITY($J,"W")
"RTN","RARTR",76,0)
 . Q
"RTN","RARTR",77,0)
 I $D(RADDEN),($G(^RARPT(RARPT,"PURGE"))) D
"RTN","RARTR",78,0)
 . ; when the report is unverified and purge data exists (rpt adden)
"RTN","RARTR",79,0)
 . N RAPRGE S RAPRGE=+$G(^RARPT(RARPT,"PURGE"))
"RTN","RARTR",80,0)
 . S ^TMP($J,"RA AUTOE",$$INCR^RAUTL4(RAACNT))=""
"RTN","RARTR",81,0)
 . S ^TMP($J,"RA AUTOE",$$INCR^RAUTL4(RAACNT))="Report Purged: "_$$FMTE^XLFDT(RAPRGE,"1P")
"RTN","RARTR",82,0)
 . S ^TMP($J,"RA AUTOE",$$INCR^RAUTL4(RAACNT))=""
"RTN","RARTR",83,0)
 . Q
"RTN","RARTR",84,0)
 I $P($G(^RA(79.1,+$P(RAY2,U,4),0)),U,18)="Y" D PRTDX^RARTR1 G:$D(RAOOUT) END ;print dx codes
"RTN","RARTR",85,0)
 D EN1^RARTR0 G:$D(RAOOUT) END
"RTN","RARTR",86,0)
 I '$D(RAVERFND) D  G END:$D(RAOOUT)
"RTN","RARTR",87,0)
 . I '$D(RAUTOE) D:($Y+RAFOOT+4)>IOSL HANG^RARTR2 Q:$D(RAOOUT)  D HD:($Y+RAFOOT+4)>IOSL
"RTN","RARTR",88,0)
 . N RADFTSBN,RADFTSBT S:$D(RADDEN) RAVERF=+$P(RA74B4,"^",9)
"RTN","RARTR",89,0)
 . S RADFTSBN=$E($P($G(^VA(200,RAVERF,20)),"^",2),1,25)
"RTN","RARTR",90,0)
 . S:RADFTSBN']"" RADFTSBN=$E($P($G(^VA(200,RAVERF,0)),"^"),1,25)
"RTN","RARTR",91,0)
 . S RADFTSBT=$E($P($G(^VA(200,RAVERF,20)),"^",3),1,30)
"RTN","RARTR",92,0)
 . I RADFTSBT']"" S RADFTSBT=$$TITLE^RARTR0(RAVERF)
"RTN","RARTR",93,0)
 . W:'$D(RAUTOE) !!,"VERIFIED BY:",!?2,$S(RADFTSBN]"":RADFTSBN,1:"")
"RTN","RARTR",94,0)
 . W:RADFTSBT]""&('$D(RAUTOE)) ", "_RADFTSBT
"RTN","RARTR",95,0)
 . I $D(RAUTOE) D
"RTN","RARTR",96,0)
 .. S ^TMP($J,"RA AUTOE",$$INCR^RAUTL4(RAACNT))="VERIFIED BY:"
"RTN","RARTR",97,0)
 .. S ^TMP($J,"RA AUTOE",$$INCR^RAUTL4(RAACNT))="  "_$S(RADFTSBN]"":RADFTSBN,1:"")_$S(RADFTSBT]"":", "_RADFTSBT,1:"")
"RTN","RARTR",98,0)
 .. S ^TMP($J,"RA AUTOE",$$INCR^RAUTL4(RAACNT))=""
"RTN","RARTR",99,0)
 .. Q
"RTN","RARTR",100,0)
 . Q
"RTN","RARTR",101,0)
 K RASBPN,RASBT,RASECIEN,RASECOND,RASECSS
"RTN","RARTR",102,0)
 I '$D(RAUTOE) D:($Y+RAFOOT+4)>IOSL HANG^RARTR2 G END:$D(RAOOUT) D HD:($Y+RAFOOT+4)>IOSL
"RTN","RARTR",103,0)
 W:'$D(RAUTOE) !!,$S($D(^RABTCH(74.2,+RABTCH,0)):$P(^(0),"^"),1:""),"/" I +$G(^RARPT(RARPT,"T")),$D(^VA(200,+$P(^RARPT(RARPT,"T"),"^"),0)) W:'$D(RAUTOE) $P(^(0),"^",2)
"RTN","RARTR",104,0)
 S:$D(RAUTOE) ^TMP($J,"RA AUTOE",$$INCR^RAUTL4(RAACNT))=$P($G(^RABTCH(74.2,+RABTCH,0)),"^")_"/"_$S(+$G(^RARPT(RARPT,"T"))&($D(^VA(200,+$P($G(^RARPT(RARPT,"T")),"^"),0))):$P(^(0),"^",2),1:"")
"RTN","RARTR",105,0)
 S:$D(RAUTOE) ^TMP($J,"RA AUTOE",$$INCR^RAUTL4(RAACNT))=""
"RTN","RARTR",106,0)
 D HANG^RARTR2 G END:$D(RAOOUT)
"RTN","RARTR",107,0)
 I RAST'="V" D:'$D(RAMDV) SETDIV^RARTR2 I $P(RAMDV,U,25) D WARNING^RARTR1
"RTN","RARTR",108,0)
 G PEND:RAST'="PD"
"RTN","RARTR",109,0)
 S $P(RASTRSK,"*",80)=""
"RTN","RARTR",110,0)
 I '$D(RAUTOE) D
"RTN","RARTR",111,0)
 . D HD:($Y+RAFOOT+9)>IOSL
"RTN","RARTR",112,0)
 . W !,$E(RASTRSK,1,22)," P R O B L E M   S T A T E M E N T ",$E(RASTRSK,1,22)
"RTN","RARTR",113,0)
 . W !!,$S($D(^RARPT(RARPT,"P")):^("P"),1:"None entered.") W !!,RASTRSK
"RTN","RARTR",114,0)
 . Q
"RTN","RARTR",115,0)
 E  D
"RTN","RARTR",116,0)
 . S ^TMP($J,"RA AUTOE",$$INCR^RAUTL4(RAACNT))=$E(RASTRSK,1,22)_" P R O B L E M   S T A T E M E N T "_$E(RASTRSK,1,22)
"RTN","RARTR",117,0)
 . S ^TMP($J,"RA AUTOE",$$INCR^RAUTL4(RAACNT))=$S($D(^RARPT(RARPT,"P")):^("P"),1:"None entered.")
"RTN","RARTR",118,0)
 . S ^TMP($J,"RA AUTOE",$$INCR^RAUTL4(RAACNT))=""
"RTN","RARTR",119,0)
 . Q
"RTN","RARTR",120,0)
PEND D FOOT^RARTR2,HANG^RARTR2 D:'$D(RAMIE)&('$D(RAUTOE)) Q^RAFLH1
"RTN","RARTR",121,0)
END K:$D(RAOOUT) XQAID,XQAKILL
"RTN","RARTR",122,0)
 K %I,%W,%Y1,C,DN,I,RADXCODE,RARTMES,RAVERF,RAVERFND,RAPVERF
"RTN","RARTR",123,0)
 K RAVERS,RAFOOT,RAY0,RAY1,RAY2,RAY3,RALOC,RAFMT,RAMOD,RASTFL,RALB,RALBR
"RTN","RARTR",124,0)
 K RALBRT,RALBS,RALBST,RAV,RAP,RATAB,RAXX,VAL,VAR,RADFN,RADTI,RACN,RADTE
"RTN","RARTR",125,0)
 K RARPT,RAHDFM,RAFTFM,RAV,RAIOF,RABTCH,RAOOUT,RAPIR,RAPIS,VAERR,Z
"RTN","RARTR",126,0)
 K RASTRSK S RAFFLF=RAORIOF K RAORIOF,RAFFLF,RAERRFLG
"RTN","RARTR",127,0)
 Q
"RTN","RARTR",128,0)
Q ; Queue the report
"RTN","RARTR",129,0)
 S ZTDTH=$H,ZTRTN="DQ^RARTR",ZTSAVE("RARPT")="" S:$D(RARTMES) ZTSAVE("RARTMES")=""
"RTN","RARTR",130,0)
 D ZIS^RAUTL Q:RAPOP
"RTN","RARTR",131,0)
 ;
"RTN","RARTR",132,0)
DQ S U="^",X="T",%DT="" D ^%DT S DT=Y G PRT
"RTN","RARTR",133,0)
 ;
"RTN","RARTR",134,0)
INIT ; initialize exam/report variables
"RTN","RARTR",135,0)
 ; main variables set:
"RTN","RARTR",136,0)
 ; RAY0: zero node data from the Patient File (2)
"RTN","RARTR",137,0)
 ; RAY1: zero node data from the Rad/Nuc Med Patient File (70)
"RTN","RARTR",138,0)
 ; RAY2: Registered Exams (70.02) zero node data
"RTN","RARTR",139,0)
 ; RAY3: Examinations     (70.03) zero node data
"RTN","RARTR",140,0)
 S (RAY0,RAY1,RAY2,RAY3)=-1 ; error condition, if no data nodes
"RTN","RARTR",141,0)
 S RADFN=+$P(X,"^",2),RADTE=+$P(X,"^",3),RADTI=(9999999.9999-RADTE)
"RTN","RARTR",142,0)
 S RACN=+$P(X,"^",4),RAST=$P(X,"^",5),RATAB=5
"RTN","RARTR",143,0)
 S:'$D(RABTCH) RABTCH=0 S (DIWL,DIWF)=0
"RTN","RARTR",144,0)
 Q:'$D(^RADPT(RADFN,0))  S RANUM=1,RAY1=^(0)
"RTN","RARTR",145,0)
 Q:'$D(^DPT(RADFN,0))  S RAY0=^(0)
"RTN","RARTR",146,0)
 Q:'$D(^RADPT(RADFN,"DT",RADTI,0))  S RAY2=^(0)
"RTN","RARTR",147,0)
 S RACNI=$O(^RADPT(RADFN,"DT",RADTI,"P","B",RACN,0))
"RTN","RARTR",148,0)
 S (RAY3,RALB)=$S($D(^RADPT(RADFN,"DT",RADTI,"P",+RACNI,0)):^(0),1:-1)
"RTN","RARTR",149,0)
 Q:RAY3<0  ; examinations data missing
"RTN","RARTR",150,0)
 ;
"RTN","RARTR",151,0)
 S (RAHDFM,RAFTFM)=1 S:$D(^RA(79.1,+$P(RAY2,"^",4),0)) RAHDFM=^(0),RAFTFM=+$P(RAHDFM,"^",13),DIWL=$P(RAHDFM,"^",14),DIWF=$P(RAHDFM,"^",15),RAHDFM=+$P(RAHDFM,"^",12) S RAFOOT=$S($D(^RA(78.2,RAFTFM,0)):+$P(^(0),"^",2),1:0)
"RTN","RARTR",152,0)
 S:'DIWL DIWL=5 S:'DIWF DIWF=70 S DIWF="WC"_(DIWF-DIWL)
"RTN","RARTR",153,0)
 G @$S($D(RAUTOE):"HEAD^RARTR0",1:"HD1")
"RTN","RARTR",154,0)
 Q
"RTN","RARTR",155,0)
 ;
"RTN","RARTR",156,0)
HD D FOOT^RARTR2:$E(IOST,1,2)'="C-"
"RTN","RARTR",157,0)
HD1 S RAFMT=RAHDFM I $D(RARTMES) W:$Y>0 @RAFFLF W !,?((80-$L(RARTMES))/2),RARTMES,! S RAIOF=RAFFLF,RAFFLF="!"
"RTN","RARTR",158,0)
 I '$D(RARTMES) W:$Y>0 @RAFFLF
"RTN","RARTR",159,0)
 D PRT^RAFLH S:$D(RARTMES) RAFFLF=RAIOF
"RTN","RARTR",160,0)
 W:$D(RAERRFLG) !!?10,$$AMENRPT^RARTR2(),!!
"RTN","RARTR",161,0)
 Q
"VER")
8.0^22
"^DD",74,74,10,0)
ELECTRONIC SIGNATURE CODE^FIO^^0;10^K:$L(X)>50!($L(X)<1) X
"^DD",74,74,10,2)
S Y(0)=Y S Y="  <Hidden>"
"^DD",74,74,10,2.1)
S Y="  <Hidden>"
"^DD",74,74,10,3)
This is the system generated electronic signature code of the verifying interpreting physician.
"^DD",74,74,10,21,0)
^.001^2^2^3030821^^^^
"^DD",74,74,10,21,1,0)
This field is computed by the system to the electronic signature code of
"^DD",74,74,10,21,2,0)
the verifying interpreting physician.
"^DD",74,74,10,23,0)
^^13^13^3030821^
"^DD",74,74,10,23,1,0)
The upper limit on this field has been extended to fifty characters from
"^DD",74,74,10,23,2,0)
thirty characters.  This is the result of patch RA*5*43.  The data from
"^DD",74,74,10,23,3,0)
the SIGNATURE BLOCK PRINTED NAME (SBPN, field #20.2) field in the NEW
"^DD",74,74,10,23,4,0)
PERSON file can have a maximum of forty characters.
"^DD",74,74,10,23,5,0)
 
"^DD",74,74,10,23,6,0)
When conditions are met, the Rad/Nuc Med application fails to store data 
"^DD",74,74,10,23,7,0)
in the ELECTRONIC SIGNATURE CODE (ESC, field #10) on the RAD/NUC MED 
"^DD",74,74,10,23,8,0)
REPORTS (#74) file because data exceeds the number of characters the ESC 
"^DD",74,74,10,23,9,0)
field allows.
"^DD",74,74,10,23,10,0)
 
"^DD",74,74,10,23,11,0)
This patch bumps the upper limit of characters on the ESC field from 
"^DD",74,74,10,23,12,0)
thirty characters to fifty characters, thus exceeding the upper limit 
"^DD",74,74,10,23,13,0)
imposed on the SBPN field by ten characters.
"^DD",74,74,10,"DT")
3030821
**END**
**END**
