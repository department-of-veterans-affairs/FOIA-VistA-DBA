Released PSA*3*7 SEQ #10
Extracted from mail message
**KIDS**:PSA*3.0*7^

**INSTALL NAME**
PSA*3.0*7
"BLD",504,0)
PSA*3.0*7^DRUG ACCOUNTABILITY^0^2990302^y
"BLD",504,1,0)
^^4^4^2990302^^^^
"BLD",504,1,1,0)
When an invoice is selected to be printed, and the invoice is still in
"BLD",504,1,2,0)
the temporary global used to hold data prior to processing/verification,
"BLD",504,1,3,0)
the last invoice in the file will be printed, instead of the selected
"BLD",504,1,4,0)
invoice.
"BLD",504,4,0)
^9.64PA^^
"BLD",504,"KRN",0)
^9.67PA^^
"BLD",504,"KRN",.4,0)
.4
"BLD",504,"KRN",.4,"NM",0)
^9.68A^^0
"BLD",504,"KRN",.401,0)
.401
"BLD",504,"KRN",.401,"NM",0)
^9.68A^^0
"BLD",504,"KRN",.402,0)
.402
"BLD",504,"KRN",.402,"NM",0)
^9.68A^^0
"BLD",504,"KRN",.403,0)
.403
"BLD",504,"KRN",.5,0)
.5
"BLD",504,"KRN",.84,0)
.84
"BLD",504,"KRN",3.6,0)
3.6
"BLD",504,"KRN",3.8,0)
3.8
"BLD",504,"KRN",9.2,0)
9.2
"BLD",504,"KRN",9.8,0)
9.8
"BLD",504,"KRN",9.8,"NM",0)
^9.68A^1^1
"BLD",504,"KRN",9.8,"NM",1,0)
PSAORDP^^0^B66885884
"BLD",504,"KRN",9.8,"NM","B","PSAORDP",1)

"BLD",504,"KRN",19,0)
19
"BLD",504,"KRN",19.1,0)
19.1
"BLD",504,"KRN",101,0)
101
"BLD",504,"KRN",409.61,0)
409.61
"BLD",504,"KRN",771,0)
771
"BLD",504,"KRN",869.2,0)
869.2
"BLD",504,"KRN",870,0)
870
"BLD",504,"KRN",8994,0)
8994
"BLD",504,"KRN","B",.4,.4)

"BLD",504,"KRN","B",.401,.401)

"BLD",504,"KRN","B",.402,.402)

"BLD",504,"KRN","B",.403,.403)

"BLD",504,"KRN","B",.5,.5)

"BLD",504,"KRN","B",.84,.84)

"BLD",504,"KRN","B",3.6,3.6)

"BLD",504,"KRN","B",3.8,3.8)

"BLD",504,"KRN","B",9.2,9.2)

"BLD",504,"KRN","B",9.8,9.8)

"BLD",504,"KRN","B",19,19)

"BLD",504,"KRN","B",19.1,19.1)

"BLD",504,"KRN","B",101,101)

"BLD",504,"KRN","B",409.61,409.61)

"BLD",504,"KRN","B",771,771)

"BLD",504,"KRN","B",869.2,869.2)

"BLD",504,"KRN","B",870,870)

"BLD",504,"KRN","B",8994,8994)

"BLD",504,"QUES",0)
^9.62^^
"BLD",504,"REQB",0)
^9.611^^0
"BLD",504,"REQG",0)
^9.611^^
"MBREQ")
0
"PKG",182,-1)
1^1
"PKG",182,0)
DRUG ACCOUNTABILITY^PSA^Drug Accountability/Inventory Interface^
"PKG",182,20,0)
^9.402P^^0
"PKG",182,22,0)
^9.49I^1^1
"PKG",182,22,1,0)
3.0^2971024^2970912^531
"PKG",182,22,1,"PAH",1,0)
7^2990302
"PKG",182,22,1,"PAH",1,1,0)
^^4^4^2990416
"PKG",182,22,1,"PAH",1,1,1,0)
When an invoice is selected to be printed, and the invoice is still in
"PKG",182,22,1,"PAH",1,1,2,0)
the temporary global used to hold data prior to processing/verification,
"PKG",182,22,1,"PAH",1,1,3,0)
the last invoice in the file will be printed, instead of the selected
"PKG",182,22,1,"PAH",1,1,4,0)
invoice.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
1
"RTN","PSAORDP")
0^1^B66885884
"RTN","PSAORDP",1,0)
PSAORDP ;BIR/JMB-Print Orders ;9/19/97
"RTN","PSAORDP",2,0)
 ;;3.0; DRUG ACCOUNTABILITY/INVENTORY INTERFACE;**7**; 10/24/97
"RTN","PSAORDP",3,0)
 ;This routine selects the orders, invoices, or invoice status to be
"RTN","PSAORDP",4,0)
 ;printed from the DRUG ACCOUNTABILITY ORDERS. It calls PSAORDP1 to
"RTN","PSAORDP",5,0)
 ;print processed invoices and ^PSAUP4 to print unprocessed invoices.
"RTN","PSAORDP",6,0)
 ;
"RTN","PSAORDP",7,0)
 I '$D(^XUSEC("PSA ORDERS",DUZ)) W !,"You do not hold the key to enter the option." Q
"RTN","PSAORDP",8,0)
START W !! S DIR(0)="S^O:Order Number;I:Invoice Number;S:Invoice Status",DIR("A")="Print by Order#, Invoice#, or Invoice Status",DIR("B")="O",DIR("??")="^D SELHELP^PSAORDP" D ^DIR K DIR
"RTN","PSAORDP",9,0)
 Q:$G(DIRUT)  S PSAPRT=Y,PSAOUT=0
"RTN","PSAORDP",10,0)
 D:PSAPRT="O" ORDER D:PSAPRT="I" INVOICE D:PSAPRT="S" STATUS G:PSAOUT EXIT
"RTN","PSAORDP",11,0)
 I PSAPRT="O"!(PSAPRT="I"),$O(PSAORD(""))="" G EXIT
"RTN","PSAORDP",12,0)
 W ! S %ZIS="Q" D ^%ZIS G:POP EXIT
"RTN","PSAORDP",13,0)
 I $D(IO("Q")) D  G EXIT
"RTN","PSAORDP",14,0)
 .S ZTDESC="Drug Acct. - Print Prime Vendor Invoices",ZTRTN="DQ^PSAORDP"
"RTN","PSAORDP",15,0)
 .F PSASAVE="PSAINV","PSAPRT","PSASTA" S:$D(@PSASAVE) ZTSAVE(PSASAVE)=""
"RTN","PSAORDP",16,0)
 .S ZTSAVE("PSAORD(")="" D ^%ZTLOAD
"RTN","PSAORDP",17,0)
 ;
"RTN","PSAORDP",18,0)
DQ S PSAOUT=0
"RTN","PSAORDP",19,0)
 I PSAPRT="O" D PRTORD G EXIT
"RTN","PSAORDP",20,0)
 I PSAPRT="I" D PRTINV G EXIT
"RTN","PSAORDP",21,0)
 D:PSAPRT="S" PRTSTA
"RTN","PSAORDP",22,0)
 ;
"RTN","PSAORDP",23,0)
EXIT W:$E(IOST,1,2)="C-" @IOF D ^%ZISC S:$D(ZTQUEUED) ZTREQ="@" K IO("Q")
"RTN","PSAORDP",24,0)
 K %,%ZIS,DA,DIC,DTOUT,DUOUT,PSA,PSAAECST,PSABY,PSACIEN,PSACNT,PSACTRL,PSACTRLH,PSADATA,PSADEC,PSADJDRG,PSADJSUP,PSADLN,PSADONE,PSADRG,PSADS
"RTN","PSAORDP",25,0)
 K PSAECOST,PSAEND,PSAFIN,PSAFIRST,PSAFPG,PSAICOST,PSAIECST,PSAIN,PSAINV,PSAINVB,PSAINVBH,PSAINVH,PSALINE,PSANDC,PSAORD,PSAORDB,PSAOUT,PSAPAGE,PSAPC,PSAPRT,PSARUN
"RTN","PSAORDP",26,0)
 K PSAS,PSASAVE,PSASLN,PSASS,PSAST,PSASTA,PSASUB,PSATOT,PSAXCNT,X,ZTDESC,ZTRTN,ZTSAVE
"RTN","PSAORDP",27,0)
 Q
"RTN","PSAORDP",28,0)
 ;
"RTN","PSAORDP",29,0)
INVOICE ;Prompts for order and invoice
"RTN","PSAORDP",30,0)
 K PSAORD S (PSACNT,PSADONE,PSAFIN,PSAXCNT)=0,PSASLN="",$P(PSASLN,"-",80)=""
"RTN","PSAORDP",31,0)
 F  W !,PSASLN S DIR(0)="FO^1:22",DIR("A")="Select ORDER NUMBER",DIR("?")="Enter the order number of the invoice to be printed",DIR("??")="^D ORDIHELP^PSAORDP" D ^DIR K DIR D  Q:PSAOUT!(PSAFIN)
"RTN","PSAORDP",32,0)
 .S PSAORDB=Y I $G(DTOUT)!($G(DUOUT)) S PSAOUT=1 Q
"RTN","PSAORDP",33,0)
 .I PSAORDB="" S PSAFIN=1 Q
"RTN","PSAORDP",34,0)
 .Q:PSAORDB=" "
"RTN","PSAORDP",35,0)
 .;In 58.811
"RTN","PSAORDP",36,0)
 .I $O(^PSD(58.811,"B",PSAORDB,0)) S PSAORD=+$O(^PSD(58.811,"B",PSAORDB,0)),PSAINVB="" D
"RTN","PSAORDP",37,0)
 ..F  S PSAINVB=$O(^PSD(58.811,PSAORD,1,"B",PSAINVB)) Q:PSAINVB=""  S PSACNT=PSACNT+1,(PSAINV,PSAINVH)=$O(^PSD(58.811,PSAORD,1,"B",PSAINVB,0)),PSAINVBH=PSAINVB
"RTN","PSAORDP",38,0)
 .;In XTMP
"RTN","PSAORDP",39,0)
 .Q:PSAOUT  S (PSACTRL,PSADONE)=0
"RTN","PSAORDP",40,0)
 .F  S PSACTRL=$O(^XTMP("PSAPV",PSACTRL)) Q:PSACTRL=""!(PSADONE)  D
"RTN","PSAORDP",41,0)
 ..I $P($G(^XTMP("PSAPV",PSACTRL,"IN")),"^",4)=PSAORDB S PSAXCNT=PSAXCNT+1,(PSAINVH,PSAINVB)=$P(^("IN"),"^",2),PSACTRLH=PSACTRL,PSA(PSAORDB,PSAINVB,PSACTRL)=""
"RTN","PSAORDP",42,0)
 .Q:PSAOUT
"RTN","PSAORDP",43,0)
 .I PSACNT,'PSAXCNT D  Q
"RTN","PSAORDP",44,0)
 ..I PSACNT=1 W !,"Invoice# "_PSAINVBH S PSAORD(PSAORDB,PSAORD)=PSAINVH Q
"RTN","PSAORDP",45,0)
 ..D:PSACNT>1 INV
"RTN","PSAORDP",46,0)
 .I 'PSACNT,PSAXCNT D  Q
"RTN","PSAORDP",47,0)
 ..I PSAXCNT=1 W !,"Invoice# "_PSAINVH S PSAORD(PSAORDB,0)=PSAINVH_"~"_PSACTRLH,PSACTRL=PSACTRLH Q
"RTN","PSAORDP",48,0)
 ..D:PSAXCNT>1 INVXTMP
"RTN","PSAORDP",49,0)
 .I PSACNT,PSAXCNT D INVBOTH Q
"RTN","PSAORDP",50,0)
 .I '$D(PSAORD(PSAORDB)) W !,PSAORDB_" is an invalid order number."
"RTN","PSAORDP",51,0)
 Q
"RTN","PSAORDP",52,0)
 ;
"RTN","PSAORDP",53,0)
INV ;Select invoice from 58.811
"RTN","PSAORDP",54,0)
 S (PSACNT,PSADONE)=0
"RTN","PSAORDP",55,0)
 F  S DA(1)=PSAORD,DIC="^PSD(58.811,"_DA(1)_",1,",DIC("A")="Select INVOICE NUMBER: ",DIC(0)="AEMZQ",DA(1)=PSAORD D ^DIC K DIC D  Q:PSAOUT!(PSADONE)
"RTN","PSAORDP",56,0)
 .I $G(DTOUT)!($G(DUOUT)) S PSAOUT=1 Q
"RTN","PSAORDP",57,0)
 .I Y=-1 S PSADONE=1 Q
"RTN","PSAORDP",58,0)
 .I 'PSACNT S PSAORD(PSAORDB,PSAORD)=+Y,PSACNT=1 Q
"RTN","PSAORDP",59,0)
 .I PSACNT S PSAORD(PSAORDB,PSAORD)=PSAORD(PSAORDB,PSAORD)_","_+Y
"RTN","PSAORDP",60,0)
 Q
"RTN","PSAORDP",61,0)
 ;
"RTN","PSAORDP",62,0)
INVXTMP ;Select invoice from XTMP
"RTN","PSAORDP",63,0)
 S (PSAXCNT,PSADONE)=0,PSAFIRST=1
"RTN","PSAORDP",64,0)
 F  S DIR(0)="FO^1:22",DIR("A")="Select INVOICE NUMBER" D ^DIR K DIR D  Q:PSAOUT!(PSADONE)
"RTN","PSAORDP",65,0)
 .I $G(DTOUT)!($G(DUOUT)) S PSAOUT=1 Q
"RTN","PSAORDP",66,0)
 .I Y="" S PSADONE=1 Q
"RTN","PSAORDP",67,0)
 .Q:Y=" "  S PSAINV=Y
"RTN","PSAORDP",68,0)
 .I 'PSAXCNT S PSAORD(PSAORDB,0)=Y_"~"_PSACTRLH,PSAXCNT=1 Q
"RTN","PSAORDP",69,0)
 .I PSAXCNT S PSAORD(PSAORDB,0)=PSAORD(PSAORDB,0)_","_Y Q
"RTN","PSAORDP",70,0)
 Q
"RTN","PSAORDP",71,0)
 ;
"RTN","PSAORDP",72,0)
INVBOTH ;Select invoice from XTMP & 58.811
"RTN","PSAORDP",73,0)
 S (PSADONE)=0
"RTN","PSAORDP",74,0)
 F  S DIR(0)="FO^1:22",DIR("A")="Select INVOICE NUMBER" D ^DIR K DIR D  Q:PSAOUT!(PSADONE)
"RTN","PSAORDP",75,0)
 .I $G(DTOUT)!($G(DUOUT)) S PSAXCNT=1 Q
"RTN","PSAORDP",76,0)
 .Q:Y=" "
"RTN","PSAORDP",77,0)
 .I Y="" S PSADONE=1 Q
"RTN","PSAORDP",78,0)
 .S PSAINVB=Y,PSAINV=$O(^PSD(58.811,PSAORD,1,"B",PSAINVB,0))
"RTN","PSAORDP",79,0)
 .I PSAINV S:$D(PSAORD(PSAORDB,PSAORD)) PSAORD(PSAORDB,PSAORD)=PSAORD(PSAORDB,PSAORD)_","_PSAINV S:'$D(PSAORD(PSAORDB,PSAORD)) PSAORD(PSAORDB,PSAORD)=PSAINV Q
"RTN","PSAORDP",80,0)
 .I $D(PSA(PSAORDB,PSAINVB)) S PSACTRL=$O(PSA(PSAORDB,PSAINVB,0)) I PSACTRL'="" S:$D(PSAORD(PSAORDB,0)) PSAORD(PSAORDB,0)=PSAORD(PSAORDB,0)_","_PSAINVB_"~"_PSACTRL S:'$D(PSAORD(PSAORDB,0)) PSAORD(PSAORDB,0)=PSAINVB_"~"_PSACTRL Q
"RTN","PSAORDP",81,0)
 .W !,PSAINVB_" is an invalid invoice number."
"RTN","PSAORDP",82,0)
 Q
"RTN","PSAORDP",83,0)
 ;
"RTN","PSAORDP",84,0)
PRTINV ;Loops thru orders & invoices to print invoices
"RTN","PSAORDP",85,0)
 S PSAORDB="" F  S PSAORDB=$O(PSAORD(PSAORDB)) Q:PSAORDB=""!(PSAOUT)  D
"RTN","PSAORDP",86,0)
 .S PSAORD="" F  S PSAORD=$O(PSAORD(PSAORDB,PSAORD)) Q:PSAORD=""!(PSAOUT)  D
"RTN","PSAORDP",87,0)
 ..F PSAPC=1:1 S PSAINV=$P(PSAORD(PSAORDB,PSAORD),",",PSAPC) Q:PSAINV=""!(PSAOUT)  D
"RTN","PSAORDP",88,0)
 ...I PSAORD D ^PSAORDP1 Q
"RTN","PSAORDP",89,0)
 ...;DAVEB (PSA*3*7)
"RTN","PSAORDP",90,0)
 ...S PSACTRL=$P(PSAINV,"~",2),PSAINV=$P(PSAINV,"~"),IOM=80
"RTN","PSAORDP",91,0)
 ...I $D(PSA(PSAORDB,$P(PSAINV,"~"))) S PSAINV=$P(PSAINV,"~"),PSACTRL=$O(PSA(PSAORDB,PSAINV,0))
"RTN","PSAORDP",92,0)
 ...D NOW^%DTC S Y=% D DD^%DT S PSARUN=$E(Y,1,18),PSAPAGE=1,$P(PSASLN,"-",80)="",$P(PSADLN,"=",80)="",PSADJDRG=0,PSAFPG=1
"RTN","PSAORDP",93,0)
 ...D START^PSAUP4
"RTN","PSAORDP",94,0)
 Q
"RTN","PSAORDP",95,0)
 ;
"RTN","PSAORDP",96,0)
ORDER ;Select order
"RTN","PSAORDP",97,0)
 K PSAORD S PSADONE=0
"RTN","PSAORDP",98,0)
 F  W ! S DIR(0)="FO^1:22",DIR("A")="Select ORDER NUMBER",DIR("?")="Enter the number of the order to be printed",DIR("??")="^D ORDHELP^PSAORDP" D ^DIR K DIR D  Q:PSAOUT!(PSADONE)
"RTN","PSAORDP",99,0)
 .I $G(DTOUT)!($G(DUOUT)) S PSAOUT=1 Q
"RTN","PSAORDP",100,0)
 .Q:X=" "
"RTN","PSAORDP",101,0)
 .I X="" S PSADONE=1 Q
"RTN","PSAORDP",102,0)
 .I $O(^PSD(58.811,"B",Y,0)) S PSAORD(Y,+$O(^PSD(58.811,"B",Y,0)))=""
"RTN","PSAORDP",103,0)
 .S PSACTRL=0 F  S PSACTRL=$O(^XTMP("PSAPV",PSACTRL)) Q:PSACTRL=""!(PSADONE)  I $P($G(^XTMP("PSAPV",PSACTRL,"IN")),"^",4)=Y S PSAORD(Y,0)="",PSADONE=1
"RTN","PSAORDP",104,0)
 .S PSADONE=0
"RTN","PSAORDP",105,0)
 .I '$D(PSAORD(X)) W !,Y_" is an invalid order number."
"RTN","PSAORDP",106,0)
 Q
"RTN","PSAORDP",107,0)
 ;
"RTN","PSAORDP",108,0)
PRTORD ;Loops thru invoices to print all for one order
"RTN","PSAORDP",109,0)
 S PSAORDB="" F  S PSAORDB=$O(PSAORD(PSAORDB)) Q:PSAORDB=""!(PSAOUT)  D
"RTN","PSAORDP",110,0)
 .S PSAORD="" F  S PSAORD=$O(PSAORD(PSAORDB,PSAORD)) Q:PSAORD=""!(PSAOUT)  D
"RTN","PSAORDP",111,0)
 ..I 'PSAORD S PSACTRL=0 F  S PSACTRL=$O(^XTMP("PSAPV",PSACTRL)) Q:PSACTRL=""!(PSAOUT)  D
"RTN","PSAORDP",112,0)
 ...Q:$P($G(^XTMP("PSAPV",PSACTRL,"IN")),"^",4)'=PSAORDB
"RTN","PSAORDP",113,0)
 ...D NOW^%DTC S Y=% D DD^%DT S PSARUN=$E(Y,1,18),PSAPAGE=1,$P(PSASLN,"-",80)="",$P(PSADLN,"=",80)="",PSADJDRG=0,PSAFPG=1
"RTN","PSAORDP",114,0)
 ...S PSAINV=$P($G(^XTMP("PSAPV",PSACTRL,"IN")),"^",2) D START^PSAUP4
"RTN","PSAORDP",115,0)
 ..I PSAORD S PSAINVB="" F  S PSAINVB=$O(^PSD(58.811,PSAORD,1,"B",PSAINVB)) Q:PSAINVB=""!(PSAOUT)  S PSAINV=$O(^PSD(58.811,PSAORD,1,"B",PSAINVB,0)) D ^PSAORDP1
"RTN","PSAORDP",116,0)
 G EXIT
"RTN","PSAORDP",117,0)
 ;
"RTN","PSAORDP",118,0)
STATUS ;Select status
"RTN","PSAORDP",119,0)
 W ! S DIR(0)="SOB^U:Unprocessed;P:Processed",DIR("A")="Select Unprocessed or Processed Invoice Status",DIR("??")="^D STATHELP^PSAORDP"
"RTN","PSAORDP",120,0)
 D ^DIR K DIR I $G(DIRUT) S PSAOUT=1 Q
"RTN","PSAORDP",121,0)
 S PSASTA=Y
"RTN","PSAORDP",122,0)
 I PSASTA="P",'$O(^PSD(58.811,"ASTAT","P",0)) W !!,"There are no invoices with the status of Processed." G STATUS
"RTN","PSAORDP",123,0)
 I PSASTA="U" D  G:'PSACNT STATUS
"RTN","PSAORDP",124,0)
 .S (PSACNT,PSACTRL)=0 F  S PSACTRL=$O(^XTMP("PSAPV",PSACTRL)) Q:PSACTRL=""!(PSACNT)  I $D(^XTMP("PSAPV",PSACTRL,"IN")),$P(^("IN"),"^",8)'="P" S PSACNT=1
"RTN","PSAORDP",125,0)
 .I 'PSACNT W !!,"There are no invoices with the status of Unprocessed."
"RTN","PSAORDP",126,0)
 Q
"RTN","PSAORDP",127,0)
 ;
"RTN","PSAORDP",128,0)
PRTSTA ;Sets up printing & prints Unprocessed invoices
"RTN","PSAORDP",129,0)
 G:PSASTA="P" PROCESS
"RTN","PSAORDP",130,0)
 S PSACTRL=0 F  S PSACTRL=$O(^XTMP("PSAPV",PSACTRL)) Q:PSACTRL=""!(PSAOUT)  D
"RTN","PSAORDP",131,0)
 .Q:$P($G(^XTMP("PSAPV",PSACTRL,"IN")),"^",8)="P"
"RTN","PSAORDP",132,0)
 .S IOM=80 D NOW^%DTC S Y=% D DD^%DT S PSARUN=$E(Y,1,18),PSAPAGE=1,$P(PSASLN,"-",80)="",$P(PSADLN,"=",80)="",PSADJDRG=0,PSAFPG=1
"RTN","PSAORDP",133,0)
 .D START^PSAUP4
"RTN","PSAORDP",134,0)
 Q
"RTN","PSAORDP",135,0)
 ;
"RTN","PSAORDP",136,0)
PROCESS ;Prints Processed invoices
"RTN","PSAORDP",137,0)
 ;S PSAORDB="" F  S PSAORDB=$O(^PSD(58.811,"AORD",PSAORDB)) Q:PSAORDB=""!(PSAOUT)  D
"RTN","PSAORDP",138,0)
 ;.S PSAINVB="" F  S PSAINVB=$O(^PSD(58.811,"AORD",PSAORDB,PSAINVB)) Q:PSAINVB=""!(PSAOUT)  D
"RTN","PSAORDP",139,0)
 ;..S PSAORD=0 F  S PSAORD=$O(^PSD(58.811,"AORD",PSAORDB,PSAINVB,PSAORD)) Q:'PSAORD!(PSAOUT)  D
"RTN","PSAORDP",140,0)
 ;...S PSAINV=0 F  S PSAINV=$O(^PSD(58.811,"AORD",PSAORDB,PSAINVB,PSAORD,PSAINV))  Q:'PSAINV!(PSAOUT)  D ^PSAORDP1
"RTN","PSAORDP",141,0)
 S PSAORD=0 F  S PSAORD=$O(^PSD(58.811,"ASTAT","P",PSAORD)) Q:'PSAORD!(PSAOUT)  D
"RTN","PSAORDP",142,0)
 .S PSAINV=0 F  S PSAINV=$O(^PSD(58.811,"ASTAT","P",PSAORD,PSAINV)) Q:'PSAINV!(PSAOUT)  D
"RTN","PSAORDP",143,0)
 ..S PSAORDB=$P($G(^PSD(58.811,PSAORD,0)),"^"),PSAINVB=$P($G(^PSD(58.811,PSAORD,1,PSAINV,0)),"^") Q:PSAORDB=""!(PSAINVB="")  D ^PSAORDP1
"RTN","PSAORDP",144,0)
 G EXIT
"RTN","PSAORDP",145,0)
 ;
"RTN","PSAORDP",146,0)
ORDHELP ;Extended help to Select Order
"RTN","PSAORDP",147,0)
 W !?5,"Enter the order number assigned to the order to be print."
"RTN","PSAORDP",148,0)
 Q
"RTN","PSAORDP",149,0)
ORDIHELP ;Extended help to Select Invoice's Order
"RTN","PSAORDP",150,0)
 W !?5,"Enter the invoice's order number to be print. The invoice number ",!?5,"prompt will follow."
"RTN","PSAORDP",151,0)
 Q
"RTN","PSAORDP",152,0)
SELHELP ;Extended help to Print by Order#, Invoice#, or Invoice Status
"RTN","PSAORDP",153,0)
 W !?5,"To print all invoices for a specific order, select Order Number.",!?5,"To print a specific invoice, select Invoice Number. To print all"
"RTN","PSAORDP",154,0)
 W !?5,"invoices with an unprocessed or processed status, select Invoice",!?5,"Status."
"RTN","PSAORDP",155,0)
 Q
"RTN","PSAORDP",156,0)
STATHELP ;Extended help for Enter Status
"RTN","PSAORDP",157,0)
 W !?5,"Enter U to print all uploaded invoices that have not been processed.",!?5,"Enter P to print all processed invoices that have not been verified."
"RTN","PSAORDP",158,0)
 Q
"VER")
8.0^21.0
**END**
**END**
