$TXT Created by MULLER,RICHARD at MNTVBB.FO-ALBANY.MED.VA.GOV  (KIDS) on Monday, 11/08/04 at 15:31
=============================================================================
Run Date: FEB 18, 2005                     Designation: EAS*1*59
Package : EAS - ENROLLMENT APPLICATION SYSTEM Priority: Mandatory
Version : 1        SEQ #53                      Status: Released
                  Compliance Date: MAR 21, 2005
=============================================================================

Associated patches: (v)EAS*1*42    <<= must be installed BEFORE `EAS*1*59'

Subject: IVM UPDATES TO Z06 PROCESS

Category: 
  - Routine
  - Enhancement (Mandatory)

Description:
============

 All IVM converted Means Tests do not transmit to HEC Legacy.  An IVM 
 converted Means Test will only transmit the converted test to HEC Legacy, 
 if it is for the current income year and it has not expired.  When there 
 is a current (non-future dated) Means Test on file, the test for the 
 previous income year can be converted via an ORU~Z06 HL7 Transmission 
 from IVM.  When this occurs, an ORU~Z07 (Full Data/DCD) HL7 Transmission 
 does not get triggered to be sent to HEC Legacy.
  
 The software currently does not allow IVM converted Means Tests over a 
 year old to generate an ORU~Z07 (Full Data/DCD) HL7 Transmission.  This 
 causes the record in the HEC Legacy IVM CLIENT INCOME File (#300.13) to 
 be out of synch with the test on file at the site.
  
 When the IVM converts a Means Test regardless of the income year, an 
 ORU~Z07 (Full Data/DCD) HL7 Transmission needs to be triggered.  This 
 will keep the Means Test information synchronized between the sites and 
 HEC Legacy.
  
 This patch EAS*1.0*59, will enable the IVM converted Means Tests for a 
 prior income year to be transmitted to HEC Legacy.
  
 A subsequent HEC Legacy patch IVMB*2.0*814 (Block ORU~Z10 Messages for 
 IVM Converted Tests) is being developed to lower the number of ORU~Z10 
 Transmissions attempting to share the converted Means Test with all sites 
 visited.  The ORU~Z10 message does not upload at the sites, because the 
 test has already been sent to all sites visited via an ORU~Z06 HL7 
 Transmission from IVM.  These are redundant messages and are ignored at 
 the sites.  The IVM FINANCIAL QUERY menu option will still be able to 
 query for and receive Mean Test information on IVM converted Means 
 Tests.  The solicited (ORF) Income Test Data (Z10) transmissions will 
 continue to return IVM converted Means Test information, the 
 modifications will only block the unsolicited (ORU) Income Test Data 
 (Z10) transmissions.
  
  
 This patch addresses the following E3R(s):
 ------------------------------------------
 There are no E3Rs associated with this patch.
  
  
 This patch addresses the following NOIS message(s):
 ---------------------------------------------------
  
 There are no NOIS associated with this patch.
  
  
 Overview of NOIS Message(s):
 ---------------------------
  
 None.
  
 TEST SITES:
 -----------
 Portland
 Puget Sound
 Battle Creek
  
              
  
        ================INSTALLATION INSTRUCTIONS =================
  
 You may wish to stop the HL7 filers prior to the install to prevent
 possible 'No Source Errors' from occurring. No transmissions will be
 lost if the filers are not stopped first, they will be picked up once
 the filers are restarted.
  
 This patch can be loaded with users on the system.
  
     Install Time - 2 minutes
  
  
   1.   LOAD TRANSPORT GLOBAL
        ---------------------
        Choose the PackMan message containing this patch and invoke the
        INSTALL/CHECK MESSAGE PackMan option.
  
   2.   DISABLE ROUTINE MAPPING   (DSM for Open VMS sites only)
        -----------------------
        Disable routine mapping on all systems for the routines listed in
        step 3 below.
  
        NOTE:  If the routines included in this patch are not currently in
               your mapped routine set, please skip this step.
  
   3.   COMPONENTS SENT WITH PATCH
        ------------------------
        The following is a list of the routines included in this patch.
        The second line of each of these routines now looks like:
  
        ;;1.0;ENROLLMENT APPLICATION SYSTEM;**[patch list]**; 21-OCT-94
  
                            CHECK^XTSUMBLD results
  
        Routine        Before Patch     After Patch    Patch List
        -------        ------------     -----------    ----------
        EASPTRN1       5585873          5754704        30,33,47,42,59
  
              Total number of routines: 1
  
  
   4.   START UP KIDS
        -------------
        Start up the Kernel Installation and Distribution System Menu
        [XPD MAIN]:
  
             Edits and Distribution ...
             Utilities ...
             Installation ...
  
   Select Kernel Installation & Distribution System Option: INStallation
                                                            ---
             Load a Distribution
             Print Transport Global
             Compare Transport Global to Current System
             Verify Checksums in Transport Global
             Install Package(s)
             Restart Install of Package(s)
             Unload a Distribution
             Backup a Transport Global
  
   Select Installation Option:
  
   5.   Select Installation Option:
        --------------------------
        NOTE:  The following are OPTIONAL - (When prompted for the INSTALL
               NAME, enter EAS*1.0*59):
  
        a.  Print Transport Global - This option will allow you to view 
            all components the of this patch (routines, DD's, templates, 
            etc.).
        b.  Backup a Transport Global - This option will create a backup
            message of any routines exported with this patch. It will not
            backup any other changes such as DD's or templates.
        c.  Compare Transport Global to Current System - This option will
            allow you to view all changes that will be made when this patch
            is installed.  It compares all components of this patch
            (routines, DD's, templates, etc.).
        d.  Verify Checksums in Transport Global - This option will allow
            you to ensure the integrity of the routines that are in the
            transport global.
  
   6.   Select Installation Option: Install Package(s)
                                    ----------------
        **This is the step to start the installation of this KIDS patch:
  
       a.  Choose the Install Package(s) option to start the patch install.
       b.  When prompted 'Want KIDS to INHIBIT LOGONs during the install?
           YES//' answer NO (unless otherwise indicated)
       c.  When prompted 'Want to DISABLE Scheduled Options, Menu
           Options, and Protocols? YES//' answer NO (unless otherwise
           indicated)
  
  
   7.   REBUILD MAPPED ROUTINE(S)  (DSM for Open VMS sites only)
        -------------------------
        Optional - Include the routines distributed with this patch
        in the mapped routine set.
  
        NOTE: This step is only necessary if you performed step 2 or
              if you wish to include the routines in your mapped set.
  
   8.  When the installation is complete, be sure to re-start the filers
       if you chose to stop them.

Routine Information:
====================

Routine Name:
  - EASPTRN1

 Before:
  
 CLOSE(IVMIY,DFN,IVMCS,IVMCR)  ; Close IVM case record for a patient
   ; Input:    DFN  --  Pointer to the patient in file #2
   ;         IVMIY  --  Income year of the closed case
   ;         IVMCS  --  Closure source [1=IVM | 2=DHCP]
   ;         IVMCR  --  Pointer to the closure reason in file #301.93
   ;
   N DA,DIE,DR,X,Y,EVENTS,STATUS,EAEVENT
   I '$G(IVMIY)!'$G(DFN)!'$G(IVMCS)!'$G(IVMCR) G CLOSEQ
  
 After:
  
 CLOSE(IVMIY,DFN,IVMCS,IVMCR)  ; Close IVM case record for a patient
   ; Input:    DFN  --  Pointer to the patient in file #2
   ;         IVMIY  --  Income year of the closed case
   ;         IVMCS  --  Closure source [1=IVM | 2=DHCP]
   ;         IVMCR  --  Pointer to the closure reason in file #301.93
   ;
   N DA,DIE,DR,X,Y,EVENTS,STATUS,EAEVENT,IVEVENT
   I '$G(IVMIY)!'$G(DFN)!'$G(IVMCS)!'$G(IVMCR) G CLOSEQ
  
  
 Before:
  
   ;
   ;If previous years event make sure enrollment event does not get
   ;  updated
   ;
   S EAEVENT=1
   I $G(EXPIRED)=1 S EAEVENT=2,STATUS=1
   I $G(EXPIRED)=0 S EAEVENT=1,STATUS=0
   D NOW^%DTC S DR=".03////"_STATUS_";.04////1;1.01////"_IVMCR_";1.02////"_
 IVMCS_";1.03////"_%_";30.01////2;30.02////2;30.03////"_$G(EAEVENT)
   S DIE="^IVM(301.5," D ^DIE
 CLOSEQ  Q
   ;
  
 After:
  
   ;
   ; If previous years event make sure Enrollment Event does not get
   ; updated, and the IVM Event does
   ;
   S EAEVENT=1,IVEVENT=2
   I $G(EXPIRED)=1 S EAEVENT=2,STATUS=0,IVEVENT=1
   I $G(EXPIRED)=0 S EAEVENT=1,STATUS=0
   D NOW^%DTC S DR=".03////"_STATUS_";.04////1;1.01////"_IVMCR_";1.02////"_
 IVMCS_";1.03////"_%_";30.01////"_IVEVENT_";30.02////2;30.03////"_$G(EAEVENT)
   S DIE="^IVM(301.5," D ^DIE
 CLOSEQ  Q
   ;

Routine Checksum:
 
 

=============================================================================
User Information:
Entered By  : MULLER,RICHARD                Date Entered  : OCT 28, 2004
Completed By: WILSON,PAT                    Date Completed: FEB 14, 2005
Released By : GROOMS,ANTHONY E              Date Released : FEB 18, 2005
=============================================================================


Packman Mail Message:
=====================

$END TXT
