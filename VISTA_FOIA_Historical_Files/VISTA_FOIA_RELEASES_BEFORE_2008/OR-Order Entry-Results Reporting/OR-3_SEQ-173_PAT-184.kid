Released OR*3*184 SEQ #173
Extracted from mail message
**KIDS**:OR*3.0*184^

**INSTALL NAME**
OR*3.0*184
"BLD",4296,0)
OR*3.0*184^ORDER ENTRY/RESULTS REPORTING^0^3030408^y
"BLD",4296,4,0)
^9.64PA^^
"BLD",4296,"INI")

"BLD",4296,"INIT")

"BLD",4296,"KRN",0)
^9.67PA^8989.52^19
"BLD",4296,"KRN",.4,0)
.4
"BLD",4296,"KRN",.401,0)
.401
"BLD",4296,"KRN",.402,0)
.402
"BLD",4296,"KRN",.403,0)
.403
"BLD",4296,"KRN",.5,0)
.5
"BLD",4296,"KRN",.84,0)
.84
"BLD",4296,"KRN",3.6,0)
3.6
"BLD",4296,"KRN",3.8,0)
3.8
"BLD",4296,"KRN",9.2,0)
9.2
"BLD",4296,"KRN",9.8,0)
9.8
"BLD",4296,"KRN",9.8,"NM",0)
^9.68A^1^1
"BLD",4296,"KRN",9.8,"NM",1,0)
ORQQPX^^0^B56256529
"BLD",4296,"KRN",9.8,"NM","B","ORQQPX",1)

"BLD",4296,"KRN",19,0)
19
"BLD",4296,"KRN",19,"NM",0)
^9.68A^^0
"BLD",4296,"KRN",19.1,0)
19.1
"BLD",4296,"KRN",101,0)
101
"BLD",4296,"KRN",409.61,0)
409.61
"BLD",4296,"KRN",771,0)
771
"BLD",4296,"KRN",870,0)
870
"BLD",4296,"KRN",8989.51,0)
8989.51
"BLD",4296,"KRN",8989.52,0)
8989.52
"BLD",4296,"KRN",8994,0)
8994
"BLD",4296,"KRN",8994,"NM",0)
^9.68A^1^1
"BLD",4296,"KRN",8994,"NM",1,0)
ORQQPX GET HIST LOCATIONS^^0
"BLD",4296,"KRN",8994,"NM","B","ORQQPX GET HIST LOCATIONS",1)

"BLD",4296,"KRN","B",.4,.4)

"BLD",4296,"KRN","B",.401,.401)

"BLD",4296,"KRN","B",.402,.402)

"BLD",4296,"KRN","B",.403,.403)

"BLD",4296,"KRN","B",.5,.5)

"BLD",4296,"KRN","B",.84,.84)

"BLD",4296,"KRN","B",3.6,3.6)

"BLD",4296,"KRN","B",3.8,3.8)

"BLD",4296,"KRN","B",9.2,9.2)

"BLD",4296,"KRN","B",9.8,9.8)

"BLD",4296,"KRN","B",19,19)

"BLD",4296,"KRN","B",19.1,19.1)

"BLD",4296,"KRN","B",101,101)

"BLD",4296,"KRN","B",409.61,409.61)

"BLD",4296,"KRN","B",771,771)

"BLD",4296,"KRN","B",870,870)

"BLD",4296,"KRN","B",8989.51,8989.51)

"BLD",4296,"KRN","B",8989.52,8989.52)

"BLD",4296,"KRN","B",8994,8994)

"BLD",4296,"QUES",0)
^9.62^^
"BLD",4296,"REQB",0)
^9.611^^0
"KRN",8994,1206,-1)
0^1
"KRN",8994,1206,0)
ORQQPX GET HIST LOCATIONS^HISTLOC^ORQQPX^4^R^^^1
"KRN",8994,1206,1,0)
^^2^2^3000104^
"KRN",8994,1206,1,1,0)
Returns a list of historical locations from the LOCATION file
"KRN",8994,1206,1,2,0)
(#9999999.06).
"MBREQ")
0
"ORD",16,8994)
8994;16;1;;;;;;;RPCDEL^XPDIA1
"ORD",16,8994,0)
REMOTE PROCEDURE
"PKG",110,-1)
1^1
"PKG",110,0)
ORDER ENTRY/RESULTS REPORTING^OR^Order Entry/Results Reporting
"PKG",110,20,0)
^9.402P^^
"PKG",110,22,0)
^9.49I^1^1
"PKG",110,22,1,0)
3.0^2971217
"PKG",110,22,1,"PAH",1,0)
184^3030408
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
1
"RTN","ORQQPX")
0^1^B56256529
"RTN","ORQQPX",1,0)
ORQQPX ; SLC/JM - PCE and Reminder routines ;4/8/2003
"RTN","ORQQPX",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**10,85,184**;Dec 17, 1997
"RTN","ORQQPX",3,0)
 Q
"RTN","ORQQPX",4,0)
IMMLIST(ORY,ORPT) ;return pt's immunization list:
"RTN","ORQQPX",5,0)
 ;id^name^date/time^reaction^inverse d/t
"RTN","ORQQPX",6,0)
 I $L($T(IMMUN^PXRHS03))<1 S ORY(1)="^Immunizations not available." Q
"RTN","ORQQPX",7,0)
 K ^TMP("PXI",$J)
"RTN","ORQQPX",8,0)
 D IMMUN^PXRHS03(ORPT)
"RTN","ORQQPX",9,0)
 N ORI,IMM,IVDT,IEN,X
"RTN","ORQQPX",10,0)
 S ORI=0,IMM="",IVDT="",IEN=0
"RTN","ORQQPX",11,0)
 F  S IMM=$O(^TMP("PXI",$J,IMM)) Q:IMM=""  D
"RTN","ORQQPX",12,0)
 .F  S IVDT=$O(^TMP("PXI",$J,IMM,IVDT)) Q:IVDT=""  D
"RTN","ORQQPX",13,0)
 ..F  S IEN=$O(^TMP("PXI",$J,IMM,IVDT,IEN)) Q:IEN<1  D
"RTN","ORQQPX",14,0)
 ...S ORI=ORI+1,X=$G(^TMP("PXI",$J,IMM,IVDT,IEN,0)) Q:'$L(X)
"RTN","ORQQPX",15,0)
 ...S ORY(ORI)=IEN_U_IMM_U_$P(X,U,3)
"RTN","ORQQPX",16,0)
 ...I $P(X,U,7)=1 S ORY(ORI)=ORY(ORI)_U_$P(X,U,6)_U_IVDT
"RTN","ORQQPX",17,0)
 ...E  S ORY(ORI)=ORY(ORI)_U_U_IVDT
"RTN","ORQQPX",18,0)
 S:+$G(ORY(1))<1 ORY(1)="^No immunizations found.^2900101^^9999999"
"RTN","ORQQPX",19,0)
 K ^TMP("PXI",$J)
"RTN","ORQQPX",20,0)
 Q
"RTN","ORQQPX",21,0)
DETAIL(ORY,IMM) ; return detailed information for an immunization
"RTN","ORQQPX",22,0)
 S ORY(1)="Detailed information on immunizations is not available."
"RTN","ORQQPX",23,0)
 Q
"RTN","ORQQPX",24,0)
REMIND(ORY,ORPT) ;return pt's currently due PCE clinical reminders
"RTN","ORQQPX",25,0)
 ; in the format file 811.9 ien^reminder print name^date due^last occur.
"RTN","ORQQPX",26,0)
 N ORTMPLST,ORI,ORJ,ORIEN,ORTXT,ORX,ORLASTDT,ORDUEDT,ORLOC
"RTN","ORQQPX",27,0)
 S ORJ=0
"RTN","ORQQPX",28,0)
 ;
"RTN","ORQQPX",29,0)
 ;get patient's location flag (INPATIENT ONLY - outpt locations cannot be
"RTN","ORQQPX",30,0)
 ;reliably determined, and many simultaneous outpt locations can occur):
"RTN","ORQQPX",31,0)
 I +$G(ORPT)>0 D
"RTN","ORQQPX",32,0)
 .N DFN S DFN=ORPT,VA200="" D OERR^VADPT
"RTN","ORQQPX",33,0)
 .I +$G(VAIN(4))>0 S ORLOC=+$G(^DIC(42,+$G(VAIN(4)),44))
"RTN","ORQQPX",34,0)
 .K VA200,VAIN
"RTN","ORQQPX",35,0)
 ;
"RTN","ORQQPX",36,0)
 D REMLIST(.ORTMPLST,$G(ORLOC))
"RTN","ORQQPX",37,0)
 ;D GETLST^XPAR(.ORTMPLST,"USR^LOC.`"_$G(ORLOC)_"^SRV.`"_+$G(ORSRV)_"^DIV^SYS^PKG","ORQQPX SEARCH ITEMS","Q",.ORERR)
"RTN","ORQQPX",38,0)
 ;I ORERR>0 S ORY(1)=U_"Error: "_$P(ORERR,U,2) Q
"RTN","ORQQPX",39,0)
 S ORI=0 F  S ORI=$O(ORTMPLST(ORI)) Q:'ORI  D
"RTN","ORQQPX",40,0)
 .S ORIEN=$P(ORTMPLST(ORI),U,2)
"RTN","ORQQPX",41,0)
 .K ^TMP("PXRHM",$J)
"RTN","ORQQPX",42,0)
 .D MAIN^PXRM(ORPT,ORIEN,0)
"RTN","ORQQPX",43,0)
 .S ORTXT="",ORTXT=$O(^TMP("PXRHM",$J,ORIEN,ORTXT)) Q:ORTXT=""  D
"RTN","ORQQPX",44,0)
 ..S ORX=^TMP("PXRHM",$J,ORIEN,ORTXT)
"RTN","ORQQPX",45,0)
 ..S ORDUEDT=$P(ORX,U,2),ORLASTDT=$P(ORX,U,3)
"RTN","ORQQPX",46,0)
 ..S ORLASTDT=$S(+$G(ORLASTDT)>0:ORLASTDT,1:"")  ;null if not a date
"RTN","ORQQPX",47,0)
 ..S ORJ=ORJ+1
"RTN","ORQQPX",48,0)
 ..S ORY(ORJ)=ORIEN_U_ORTXT_U_ORDUEDT_U_ORLASTDT
"RTN","ORQQPX",49,0)
 .K ^TMP("PXRHM",$J)
"RTN","ORQQPX",50,0)
 Q
"RTN","ORQQPX",51,0)
REMDET(ORY,ORPT,ORIEN) ;return detail for a pt's clinical reminder
"RTN","ORQQPX",52,0)
 ; ORY - return array
"RTN","ORQQPX",53,0)
 ; ORPT - patient DFN
"RTN","ORQQPX",54,0)
 ; ORIEN - clinical reminder (811.9 ien)
"RTN","ORQQPX",55,0)
 K ^TMP("PXRHM",$J)
"RTN","ORQQPX",56,0)
 D MAIN^PXRM(ORPT,ORIEN,5)     ; 5 returns all reminder info
"RTN","ORQQPX",57,0)
 N CR,I,J,ORTXT S I=1
"RTN","ORQQPX",58,0)
 S ORTXT="",ORTXT=$O(^TMP("PXRHM",$J,ORIEN,ORTXT)) Q:ORTXT=""  D
"RTN","ORQQPX",59,0)
 .S J=0 F  S J=$O(^TMP("PXRHM",$J,ORIEN,ORTXT,"TXT",J)) Q:J=""  D
"RTN","ORQQPX",60,0)
 ..S ORY(I)=^TMP("PXRHM",$J,ORIEN,ORTXT,"TXT",J),I=I+1
"RTN","ORQQPX",61,0)
 K ^TMP("PXRHM",$J)
"RTN","ORQQPX",62,0)
 Q
"RTN","ORQQPX",63,0)
NEWACTIV(ORY) ;Return true if Interactive Reminders are active
"RTN","ORQQPX",64,0)
 S ORY=0
"RTN","ORQQPX",65,0)
 I $T(APPL^PXRMRPCA)'="",+$G(DUZ) D
"RTN","ORQQPX",66,0)
 . N SRV
"RTN","ORQQPX",67,0)
 . S SRV=$P($G(^VA(200,DUZ,5)),U)
"RTN","ORQQPX",68,0)
 . S ORY=$$GET^XPAR(DUZ_";VA(200,^SRV.`"_+$G(SRV)_"^DIV^SYS","PXRM GUI REMINDERS ACTIVE",1,"Q")
"RTN","ORQQPX",69,0)
 . I +ORY S ORY=1
"RTN","ORQQPX",70,0)
 . E  S ORY=0
"RTN","ORQQPX",71,0)
 Q
"RTN","ORQQPX",72,0)
HISTLOC(LST) ;Returns a list of historical locations
"RTN","ORQQPX",73,0)
 N IDX,PTR,LINE,NAME
"RTN","ORQQPX",74,0)
 K ^TMP("OR",$J,"LOC")
"RTN","ORQQPX",75,0)
 S LST=$NA(^TMP("OR",$J,"LOC"))
"RTN","ORQQPX",76,0)
 S (LINE,IDX)=0
"RTN","ORQQPX",77,0)
 F  S IDX=$O(^AUTTLOC(IDX)) Q:'IDX  D
"RTN","ORQQPX",78,0)
 .S PTR=+$G(^AUTTLOC(IDX,0))
"RTN","ORQQPX",79,0)
 .I +PTR D
"RTN","ORQQPX",80,0)
 ..S NAME=$P($G(^DIC(4,PTR,0)),U)
"RTN","ORQQPX",81,0)
 ..I NAME'="" D
"RTN","ORQQPX",82,0)
 ...S LINE=LINE+1
"RTN","ORQQPX",83,0)
 ...S ^TMP("OR",$J,"LOC",LINE)=PTR_U_NAME
"RTN","ORQQPX",84,0)
 Q
"RTN","ORQQPX",85,0)
GETFLDRS(ORFLDRS) ;Return Visible Reminder Folders
"RTN","ORQQPX",86,0)
 ; Codes: D=Due, A=Applicable, N=Not Applicable, E=Evaluated, O=Other
"RTN","ORQQPX",87,0)
 N SRV,ORERR,ORTMP
"RTN","ORQQPX",88,0)
 S SRV=$P($G(^VA(200,DUZ,5)),U)
"RTN","ORQQPX",89,0)
 D GETLST^XPAR(.ORTMP,"USR^SRV.`"_+$G(SRV)_"^DIV^SYS^PKG","ORQQPX REMINDER FOLDERS","Q",.ORERR)
"RTN","ORQQPX",90,0)
 I +ORTMP S ORFLDRS=$P($G(ORTMP(1)),U,2)
"RTN","ORQQPX",91,0)
 E  S ORFLDRS="DAO"
"RTN","ORQQPX",92,0)
 Q
"RTN","ORQQPX",93,0)
SETFLDRS(ORY,ORFLDRS) ;Sets Visible Reminder Folders for the current user
"RTN","ORQQPX",94,0)
 N ORERR
"RTN","ORQQPX",95,0)
 D EN^XPAR(DUZ_";VA(200,","ORQQPX REMINDER FOLDERS",1,ORFLDRS,.ORERR)
"RTN","ORQQPX",96,0)
 S ORY=1
"RTN","ORQQPX",97,0)
 Q
"RTN","ORQQPX",98,0)
GETDEFOL(ORDEFLOC) ;Return Default Outside Locations
"RTN","ORQQPX",99,0)
 N SRV,ORERR
"RTN","ORQQPX",100,0)
 S SRV=$P($G(^VA(200,DUZ,5)),U)
"RTN","ORQQPX",101,0)
 D GETLST^XPAR(.ORDEFLOC,"USR^SRV.`"_+$G(SRV)_"^DIV^SYS^PKG","ORQQPX DEFAULT LOCATIONS","Q",.ORERR)
"RTN","ORQQPX",102,0)
 Q
"RTN","ORQQPX",103,0)
INSCURS(ORY) ; Returns status of ORQQPX REMINDER TEXT AT CURSOR
"RTN","ORQQPX",104,0)
 N SRV,ORERR,ORTMP
"RTN","ORQQPX",105,0)
 S ORY=0,SRV=$P($G(^VA(200,DUZ,5)),U)
"RTN","ORQQPX",106,0)
 D GETLST^XPAR(.ORTMP,"USR^SRV.`"_+$G(SRV)_"^DIV^SYS^PKG","ORQQPX REMINDER TEXT AT CURSOR","Q",.ORERR)
"RTN","ORQQPX",107,0)
 I +ORTMP S ORY=$P($G(ORTMP(1)),U,2)
"RTN","ORQQPX",108,0)
 Q
"RTN","ORQQPX",109,0)
NEWCVOK(ORY) ; Returns status of 
"RTN","ORQQPX",110,0)
 N SRV,ORERR,ORTMP
"RTN","ORQQPX",111,0)
 S ORY=0,SRV=$P($G(^VA(200,DUZ,5)),U)
"RTN","ORQQPX",112,0)
 D GETLST^XPAR(.ORTMP,"USR^SRV.`"_+$G(SRV)_"^DIV^SYS^PKG","ORQQPX NEW REMINDER PARAMS","Q",.ORERR)
"RTN","ORQQPX",113,0)
 I +ORTMP S ORY=$P($G(ORTMP(1)),U,2)
"RTN","ORQQPX",114,0)
 Q
"RTN","ORQQPX",115,0)
ADDNAME(ORX) ; Add Reminder or Category Name as 3rd piece
"RTN","ORQQPX",116,0)
 N CAT,IEN
"RTN","ORQQPX",117,0)
 S CAT=$E($P(ORX,U,2),2)
"RTN","ORQQPX",118,0)
 S IEN=$E($P(ORX,U,2),3,99)
"RTN","ORQQPX",119,0)
 I +IEN D
"RTN","ORQQPX",120,0)
 .I CAT="R" S $P(ORX,U,3)=$P($G(^PXD(811.9,IEN,0)),U,3)
"RTN","ORQQPX",121,0)
 .I CAT="C" S $P(ORX,U,3)=$P($G(^PXRMD(811.7,IEN,0)),U)
"RTN","ORQQPX",122,0)
 Q ORX
"RTN","ORQQPX",123,0)
REMACCUM(ORY,LVL,TYP,SORT,CLASS) ; Accumulates ORTMP into ORY
"RTN","ORQQPX",124,0)
 ; Format of entries in ORQQPX COVER SHEET REMINDERS:
"RTN","ORQQPX",125,0)
 ;   L:Lock;R:Remove;N:Normal / C:Category;R:Reminder / Cat or Rem IEN
"RTN","ORQQPX",126,0)
 N IDX,I,J,K,M,FOUND,ORERR,ORTMP,FLAG,IEN
"RTN","ORQQPX",127,0)
 N FFLAG,FIEN,OUT,P2,ADD,DOADD,CODE
"RTN","ORQQPX",128,0)
 I LVL="CLASS" D  I 1
"RTN","ORQQPX",129,0)
 .N ORLST,ORCLS,ORCLSPRM,ORWP
"RTN","ORQQPX",130,0)
 .S ORCLSPRM="ORQQPX COVER SHEET REM CLASSES"
"RTN","ORQQPX",131,0)
 .D GETLST^XPAR(.ORLST,"SYS",ORCLSPRM,"Q",.ORERR)
"RTN","ORQQPX",132,0)
 .S I=0,M=0,CLASS=$G(CLASS)
"RTN","ORQQPX",133,0)
 .F  S I=$O(ORLST(I)) Q:'I  D
"RTN","ORQQPX",134,0)
 ..S ORCLS=$P(ORLST(I),U,1)
"RTN","ORQQPX",135,0)
 ..I +CLASS S ADD=(ORCLS=+CLASS) I 1
"RTN","ORQQPX",136,0)
 ..E  S ADD=$$ISA^USRLM(DUZ,ORCLS,.ORERR)
"RTN","ORQQPX",137,0)
 ..I +ADD D
"RTN","ORQQPX",138,0)
 ...D GETWP^XPAR(.ORWP,"SYS",ORCLSPRM,ORCLS,.ORERR)
"RTN","ORQQPX",139,0)
 ...S K=0
"RTN","ORQQPX",140,0)
 ...F  S K=$O(ORWP(K)) Q:'K  D
"RTN","ORQQPX",141,0)
 ....S M=M+1
"RTN","ORQQPX",142,0)
 ....S J=$P(ORWP(K,0),";",1)
"RTN","ORQQPX",143,0)
 ....S ORTMP(M)=J_U_$P(ORWP(K,0),";",2)
"RTN","ORQQPX",144,0)
 E  D GETLST^XPAR(.ORTMP,LVL,"ORQQPX COVER SHEET REMINDERS",TYP,.ORERR)
"RTN","ORQQPX",145,0)
 S I=0,IDX=$O(ORY(999999),-1)+1,ADD=(SORT="")
"RTN","ORQQPX",146,0)
 F  S I=$O(ORTMP(I)) Q:'I  D
"RTN","ORQQPX",147,0)
 .S (FOUND,J)=0,P2=$P(ORTMP(I),U,2)
"RTN","ORQQPX",148,0)
 .S FLAG=$E(P2),IEN=$E(P2,2,999)
"RTN","ORQQPX",149,0)
 .I ADD S DOADD=1
"RTN","ORQQPX",150,0)
 .E  D
"RTN","ORQQPX",151,0)
 ..S DOADD=0
"RTN","ORQQPX",152,0)
 ..F  S J=$O(ORY(J)) Q:'J  D  Q:FOUND
"RTN","ORQQPX",153,0)
 ...S P2=$P(ORY(J),U,2)
"RTN","ORQQPX",154,0)
 ...S FIEN=$E(P2,2,999)
"RTN","ORQQPX",155,0)
 ...I FIEN=IEN S FOUND=J,FFLAG=$E(P2)
"RTN","ORQQPX",156,0)
 ..I FOUND D  I 1
"RTN","ORQQPX",157,0)
 ...I FLAG="R",FFLAG'="L" K ORY(FOUND)
"RTN","ORQQPX",158,0)
 ...I FLAG'=FFLAG,(FLAG_FFLAG)["L" S $E(P2)="L",$P(ORY(FOUND),U,2)=P2
"RTN","ORQQPX",159,0)
 ..E  I (FLAG'="R") S DOADD=1
"RTN","ORQQPX",160,0)
 .I DOADD D
"RTN","ORQQPX",161,0)
 ..S OUT(IDX)=ORTMP(I)
"RTN","ORQQPX",162,0)
 ..S $P(OUT(IDX),U)=$P(OUT(IDX),U)_SORT
"RTN","ORQQPX",163,0)
 ..I SORT="" S OUT(IDX)=$$ADDNAME(OUT(IDX))
"RTN","ORQQPX",164,0)
 ..S IDX=IDX+1
"RTN","ORQQPX",165,0)
 M ORY=OUT
"RTN","ORQQPX",166,0)
 Q
"RTN","ORQQPX",167,0)
ADDREM(ORY,IDX,IEN) ; Add Reminder to ORY list
"RTN","ORQQPX",168,0)
 I $D(ORY("B",IEN)) Q               ; See if it's in the list
"RTN","ORQQPX",169,0)
 I '$D(^PXD(811.9,IEN)) Q           ; Check if Exists
"RTN","ORQQPX",170,0)
 I $P(^PXD(811.9,IEN,0),U,6)'="" Q  ; Check if Active
"RTN","ORQQPX",171,0)
 S ORY(IDX)=IDX_U_IEN
"RTN","ORQQPX",172,0)
 S ORY("B",IEN)=""
"RTN","ORQQPX",173,0)
 Q
"RTN","ORQQPX",174,0)
ADDCAT(ORY,IDX,IEN) ; Add Category Reminders to ORY list
"RTN","ORQQPX",175,0)
 N ORREM,I,IDX2,NREM
"RTN","ORQQPX",176,0)
 D CATREM^PXRMAPI0(IEN,.ORREM)
"RTN","ORQQPX",177,0)
 S I=0
"RTN","ORQQPX",178,0)
 F  S I=$O(ORREM(I)) Q:'I  D
"RTN","ORQQPX",179,0)
 . S IDX2="00000"_I
"RTN","ORQQPX",180,0)
 . S IDX2=$E(IDX2,$L(IDX2)-5,99)
"RTN","ORQQPX",181,0)
 . D ADDREM(.ORY,+(IDX_"."_IDX2),$P(ORREM(I),U,1))
"RTN","ORQQPX",182,0)
 Q
"RTN","ORQQPX",183,0)
REMLIST(ORY,LOC) ;Returns a list of all cover sheet reminders
"RTN","ORQQPX",184,0)
 N SRV,I,J,ORLST,CODE,IDX,IEN,NEWP
"RTN","ORQQPX",185,0)
 S SRV=$P($G(^VA(200,DUZ,5)),U)
"RTN","ORQQPX",186,0)
 D NEWCVOK(.NEWP)
"RTN","ORQQPX",187,0)
 I 'NEWP D GETLST^XPAR(.ORY,"USR^LOC.`"_$G(LOC)_"^SRV.`"_+$G(SRV)_"^DIV^SYS^PKG","ORQQPX SEARCH ITEMS","Q",.ORERR) Q
"RTN","ORQQPX",188,0)
 D REMACCUM(.ORLST,"PKG","Q",1000)
"RTN","ORQQPX",189,0)
 D REMACCUM(.ORLST,"SYS","Q",2000)
"RTN","ORQQPX",190,0)
 D REMACCUM(.ORLST,"DIV","Q",3000)
"RTN","ORQQPX",191,0)
 I +SRV D REMACCUM(.ORLST,"SRV.`"_+$G(SRV),"Q",4000)
"RTN","ORQQPX",192,0)
 I +LOC D REMACCUM(.ORLST,"LOC.`"_+$G(LOC),"Q",5000)
"RTN","ORQQPX",193,0)
 D REMACCUM(.ORLST,"CLASS","Q",6000)
"RTN","ORQQPX",194,0)
 D REMACCUM(.ORLST,"USR","Q",7000)
"RTN","ORQQPX",195,0)
 S I=0
"RTN","ORQQPX",196,0)
 F  S I=$O(ORLST(I)) Q:'I  D
"RTN","ORQQPX",197,0)
 .S IDX=$P(ORLST(I),U,1)
"RTN","ORQQPX",198,0)
 .F  Q:'$D(ORY(IDX))  S IDX=IDX+1
"RTN","ORQQPX",199,0)
 .S CODE=$E($P(ORLST(I),U,2),2)
"RTN","ORQQPX",200,0)
 .S IEN=$E($P(ORLST(I),U,2),3,999)
"RTN","ORQQPX",201,0)
 .I CODE="R" D ADDREM(.ORY,IDX,IEN)
"RTN","ORQQPX",202,0)
 .I CODE="C" D ADDCAT(.ORY,IDX,IEN)
"RTN","ORQQPX",203,0)
 K ORY("B")
"RTN","ORQQPX",204,0)
 Q
"RTN","ORQQPX",205,0)
LVREMLST(ORY,LVL,CLASS) ;Returns cover sheet reminders at a specified level
"RTN","ORQQPX",206,0)
 D REMACCUM(.ORY,LVL,"Q","",$G(CLASS))
"RTN","ORQQPX",207,0)
 Q
"RTN","ORQQPX",208,0)
SAVELVL(ORY,LVL,CLASS,DATA) ;Save cover sheet reminders at a specified level
"RTN","ORQQPX",209,0)
 N ORERR,PARAM,I
"RTN","ORQQPX",210,0)
 I LVL="CLASS" D  I 1
"RTN","ORQQPX",211,0)
 .S PARAM="ORQQPX COVER SHEET REM CLASSES"
"RTN","ORQQPX",212,0)
 .S LVL="SYS"
"RTN","ORQQPX",213,0)
 .D DEL^XPAR(LVL,PARAM,"`"_CLASS,.ORERR)
"RTN","ORQQPX",214,0)
 .D EN^XPAR(LVL,PARAM,"`"_CLASS,.DATA,.ORERR)
"RTN","ORQQPX",215,0)
 E  D
"RTN","ORQQPX",216,0)
 .S PARAM="ORQQPX COVER SHEET REMINDERS"
"RTN","ORQQPX",217,0)
 .D NDEL^XPAR(LVL,PARAM,.ORERR)
"RTN","ORQQPX",218,0)
 .S I=0
"RTN","ORQQPX",219,0)
 .F  S I=$O(DATA(I)) Q:'I  D
"RTN","ORQQPX",220,0)
 ..D EN^XPAR(LVL,PARAM,$P(DATA(I),U,1),$P(DATA(I),U,2),.ORERR)
"RTN","ORQQPX",221,0)
 S ORY=1
"RTN","ORQQPX",222,0)
 Q
"RTN","ORQQPX",223,0)
GETLIST(ORY,ORLOC) ;Returns a list of all cover sheet reminders
"RTN","ORQQPX",224,0)
 N I
"RTN","ORQQPX",225,0)
 D REMLIST(.ORY,$G(ORLOC))
"RTN","ORQQPX",226,0)
 S I=0
"RTN","ORQQPX",227,0)
 F  S I=$O(ORY(I)) Q:'I  D
"RTN","ORQQPX",228,0)
 .S ORY(I)=$P(ORY(I),U,2)
"RTN","ORQQPX",229,0)
 Q
"RTN","ORQQPX",230,0)
EVALCOVR(ORY,ORPT,ORLOC) ; Evaluate Cover Sheet Reminders
"RTN","ORQQPX",231,0)
 N ORTMP
"RTN","ORQQPX",232,0)
 D GETLIST(.ORTMP,$G(ORLOC))
"RTN","ORQQPX",233,0)
 D ALIST^ORQQPXRM(.ORY,ORPT,.ORTMP)
"RTN","ORQQPX",234,0)
 Q
"VER")
8.0^22.0
**END**
**END**
