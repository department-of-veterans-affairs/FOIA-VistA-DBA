$TXT Created by MARTIN,THOMAS H at TEST.DUBLIN.MED.VA.GOV  (KIDS) on Friday, 02/27/04 at 17:17
=============================================================================
Run Date: MAR 04, 2004                     Designation: XT*7.3*86
Package : XT - TOOLKIT                        Priority: Mandatory
Version : 7.3        SEQ #68                    Status: Released
                  Compliance Date: APR 04, 2004
=============================================================================


Subject: FIXES TO NATIONAL CPRS RESPONSE TIME MONITOR

Category: 
  - Routine

Description:
============

                          XT*7.3*86
                                         
 Patch Tracking #: 37833284
  
 This patch will address problems encountered with the release of the
 National CPRS Response Time Monitor, specifically:
  
         1.  A possible <UNDEFINED> error on monitor activation or 
             deactivation.
         2.  Inability of the post-init to resolve the institution
             of some facilities.
         3.  Incomplete VMS commands in the dynamic VMS scripts.
         4.  Necessity of a 'change directory' command for some VMS sites
             to use the local FTP VMS scripts (see post-install
             instructions below).
         5.  Missing operation to 'submit' the VMS com file on VMS systems
             in the national rollup routine.
         6.  Failure of the 're-send' option for national data 
             retransmission due to incorrect VMS privileges (because of not
             using TaskMan).
         7.  Various problems with the order in performing the 
             installation steps, missing steps and other inconsistencies in
             the monitor installation and user guides.
         8.  The documentation did not specify that when queuing the
             option AWCM CPRS MONITOR that it should be specified as
             STARTUP enabled in the SPECIAL QUEUEING field.
  
 IMPORTANT NOTE:   Build XT*7.3*84 must be installed before this patch.
 Please make sure of this.  It was originally released as a host file named
 CPRS_Response_Time_Monitor.kid which is found on any CIO FO FTP site. This
 build contained essential TIU and OR patches to support this application.
 If you have not installed build XT*7.3*84 , do not install this patch at 
 this time.
  
 Test Sites: Dublin (Cache/NT and Cache/VMS), Montgomery (Cache/VMS), Erie
 (Cache/VMS), Minneapolis (Cache/NT), Atlanta, GA (DSM/VMS), Charleston
 (DSM/VMS)
  
  
 Blood Bank Approval: February 2nd, 2004
  
  
 Documentation Changes:
  
 Current documentation for this system can be found on the FTP sites in 
 the following manuals: 
  
 CPRS_R_TIME_INSTALLATION_GUIDE_XT86.PDF
 CPRS_RESPONSE_TIME_MONITOR_USER_GUIDE.PDF
 CPRS_RESPONSE_TIME_TECHNICAL_MANUAL.PDF
  
 The documentation for this package is available for retrieval via FTP.  
 All VA Medical Centers are encouraged to use the TCPIP FTP functionality
 to obtain the documentation from one of the following OI Field Office 
 ANONYMOUS.SOFTWARE directories: 
  
       IRM Field Office                          FTP Address
       ================                          ===========
       Albany                                    ftp.fo-albany.med.va.gov  
       Hines                                     ftp.fo-hines.med.va.gov
       Salt Lake City                            ftp.fo-slc.med.va.gov 
       VistA Download Site                       download.vista.med.va.gov
  
  
 NOIS Calls:
  
 BRX-0104-11910, WAS-0104-21787, CLA-0104-21772, LOU-0104-41728,
 ALX-0104-71636, PHI-0104-21600, HIN-0104-41585, MWV-0104-21534,
 LEB-0104-21416, UNY-0104-11385, CHS-0104-41363, OKL-0204-70816
  
  
 Routine Summary:
  
 The following routines are included in this patch.  The second line of 
 all routines now look like this: 
  
                  ;;7.3;TOOLKIT;**patch list**;Jan 9, 2004
   
                             Checksums
      Routine            Old          New       Patch List
  
      AWCMCPR1        20964997     20969035     **84,86**
      AWCMCPR3        13258386     13540320     **84,86**
      AWCMCPS2           N/A         360394      **86**
      AWCMCPST         3695336      3824167     **84,86**
      AWCMFTP         10809269     11064915     **84,86**
      AWCMFTP1         8325177      7927824     **84,86**  
  
 Sites should use CHECK^XTSUMBLD to verify checksums.
  
  
 List of preceding patches: XT*7.3*84, OR*3.0*214, TIU*1.0*181
  
  
  =========================================================================
  
 Installation:
  
     Notes: Users MAY remain on the system. 
            TaskMan does NOT need to be stopped.
  
    1.  Use the 'INSTALL/CHECK MESSAGE' option on the PackMan menu. This
        option will load the KIDS package onto your system.
  
    2.  The patch has now been loaded into a Transport Global on your
        system. You now need to use KIDS to install the Transport Global.
        On the KIDS menu, under the 'Installation' submenu, use the
        following options:
  
           Verify Checksums in Transport Global
           Backup a Transport Global
  
    3.  This patch can be queued and installed at any time but care 
        should be taken for the installation to occur at times between the
        local web page uploads, the uploading of national data
        and movement of data to the permanent file.
  
        You should check the time of these options and run/schedule the 
        installation so as not to conflict with them:
  
                 AWCM CPRS MONITOR
                 AWCM LOCAL ROLLUP
                 AWCM ROLL UP NATIONAL
  
    4.  Installation will take less than 2 minutes.  On the KIDS menu,
        under the 'Installation' menu, use the following option:
  
          Install Package(s)  'XT*7.3*86'
                               =========
  
    Want KIDS to INHIBIT LOGONs during the install? YES// NO
  
    Want to DISABLE Scheduled Options,Menu Options,and Protocols? YES// NO
  
   Enter the Device you want to print the Install messages.
  
   You can queue the install by entering a 'Q' at the device prompt.
   Enter a '^' to abort the install.
  
   DEVICE: HOME// <You may queue it if you wish>
                  ------------------------------
  
   Post-installation instructions:
  
 These instructions are intended specifically for VMS sites (whether Cache
 or DSM).
  
 In the initial installation, many sites had trouble with local web page 
 FTP processes due to the version of IIS running on their or their VISN's
 webserver. To get the job to move the web pages, they had to temporarily
 modify AWCMFTP under the VMS tag and insert a 'cd <directoryname> command 
 into the com file creation code. This patch includes support for this
 feature and the included routine, AWCMFTP, will overwrite any
 modifications previously made by a site.
  
 There are two ways you may activate this feature:  1) use the CPRS 
 Monitor Main Menu [AWCM MAIN] or 2) you may use VA FileManager and edit 
 field 25.  In either editing selection, if your site requires this
 feature, the value should be changed to YES or 1.
  
 Examples:
  
 Using the VA FileManager:
  
   Note: When selecting the file, it is easier to enter 177100.12 instead 
 of the file name since the two files for this application begin with 'CPRS
 MONITOR'.  It should be noted that this field (#25) will be blank 
 initially, e.g., in a 'NO' state.
  
   Select VA FileMan Option:  Enter or Edit File Entries
                              ==========================
  
 INPUT TO WHAT FILE: PATIENT// 177100.12  CPRS MONITOR
                               =========   (1 entry)
  
 EDIT WHICH FIELD: ALL// 25  USE 'CD' COMMAND IN FTP SCRIPT
                         ==
 THEN EDIT FIELD:  <RETURN>
  
 Select CPRS MONITOR FACILITY:    <your facility name>
 USE 'CD' COMMAND IN FTP SCRIPT: Y  YES    <enter either Y or 1>
                                 =
  
  
  
 Using the CPRS Monitor Main Menu:
  
             ==>>  1    Edit CPRS Monitor Parameter File
                   2    Generate CPRS Monitor Web Data
                   3    Purge CPRS Monitor Data
                   4    Roll Up Data to National Database
                   5    Re-send Data to National Server
  
 Select CPRS Monitor Main Menu  Option: 1   Edit CPRS Monitor Parameter
                                                  File
  
 Edit the CPRS Monitor Parameter File
  
 Select CPRS MONITOR FACILITY:    <Your facility>
 SYSTEM ACTIVE: YES//
 STATION NUMBER: <your station number>//
 REMINDERS LINE COLOR: 0,0,192//
  
 . . . . . . .
  
 . . . . . . .
  
 LOG VMS FTP ACTIVITY: NO//
 DELETE OLD COM FILES (VMS): YES//
 USE 'CD' COMMAND IN FTP SCRIPT: Y  YES    <enter either Y or 1>
                                 =
  
 If you should be mistaken and your site does not require this feature, 
 you may either delete the value above by entering an @ or set it to NO or 
 zero.
  
 This feature will not adversely affect NT sites if turned on by 
 mistake because while command errors in com files are fatal to the VMS
 process/job and it halts, NT merely discards the erroneous command and
 continues.
  
 Finally you should make sure that the option AWCM CPRS MONITOR has the 
 SPECIAL QUEUEING field set to S for STARTUP.  In the event you reboot 
 your system, you will want the monitor to resume operation.  You will use 
 the TaskMan Management option:
  
           Schedule/Unschedule Options
           One-time Option Queue
           Taskman Management Utilities ...
           List Tasks
           Dequeue Tasks
           Requeue Tasks
           Delete Tasks
           Print Options that are Scheduled to run
           Cleanup Task List
           Print Options Recommended for Queueing
  
 Select Taskman Management Option:  Schedule/Unschedule Options
  
 Select OPTION to schedule or reschedule:    AWCM CPRS MONITOR  (R)
  
  
                          Edit Option Schedule
  
     Option Name: AWCM CPRS MONITOR
     Menu Text: Generate CPRS Monitor Web Data            TASK ID: 8623180
   
 __________________________________________________________________________
  
   QUEUED TO RUN AT WHAT TIME: <a date and time will appear here>
  
 DEVICE FOR QUEUED JOB OUTPUT:
  
  QUEUED TO RUN ON VOLUME SET:
  
       RESCHEDULING FREQUENCY: 600S
  
              TASK PARAMETERS:
  
             SPECIAL QUEUEING: STARTUP    <<<<==== Should be S or STARTUP

Routine Information:
====================

Routine Name:
  - AWCMCPR1

 If the application was activated in the parameter file (177100.12) by 
 using the 'System Active?' field or any of the three tab fields (Lab, TIU 
 or Reminder), an <UNDEFINED> error could occur.  This was because of the 
 CPRS application being in the middle of a transaction at activation and 
 the type of transaction was missing.  
  
 For transactions in progress, if the start time was missing, it was forced
 to be the same as the end time.  This was changed to discard the
 transaction if the transaction type or start time were missing.
  
 Certain files created on VMS systems were not deleted by the tag PURDEL 
 in this routine, due to an incorrect VMS com command (missing $) and also 
 a mis-calculation of the file name.  This was changed to add the $ needed 
 for valid VMS com commands and the files for deletion are referred to by 
 the proper, uncalculated names.

Routine Checksum:

Routine Name:
  - AWCMCPST

 When the post-init ran during installation, the INSTITUTION file (#4) 
 value was to be returned by $$SITE^VASITE.  Due to a transposition of
 values, the lookup was attempted incorrectly.   This was changed to do the
 lookup properly and return the correct station number and INSTITUTION
 pointer.

Routine Checksum:

Routine Name:
  - AWCMFTP

 In this routine, which controls the local FTP to a web server, there
 were several problems.  
  
 First the local script had VMS com file errors because missing $ in two of
 the commands.  Secondly, due to incorrect VMS syntax, the files created
 were not successfully deleted after use.
  
 In addition, due to variations in the webserver (IIS) software, during the
 FTP of the local web pages many VMS sites needed to have a 'change
 directory' command to put the process at the correct directory level on
 the web server.
  
 A field has been added to the parameter file called "USE 'CD' COMMAND IN
 FTP SCRIPT?" and a site which needs the command may enter YES or 1 in the
 field.  This will cause the VMS script that is written on the fly to
 contain the command to change to the proper directory as calculated from
 the parameter file field WEB PAGE ROOT LOCATION.

Routine Checksum:

Routine Name:
  - AWCMCPR3

 The manual rerunning of a previous day for the national rollup would fail 
 on VMS systems due to the fact it was run real-time.  The average user 
 does not possess privileges to submit com file created to VMS.  This was 
 changed to queue automatically and run via Taskman, which has proper 
 privileges.
  
 Also, due to the usage of an incorrect operating system indicator, NT 
 commands were attempted to be sent to VMS.

Routine Checksum:

Routine Name:
  - AWCMFTP1

 This routine moves the previous day's response times via FTP to the
 national monitor web site. Although the com script was written correctly,
 the M routine was missing an instruction (X CMD) to submit the command to
 VMS and the com file was never executed even though it was in the
 directory.  This has been corrected.

Routine Checksum:

Routine Name:
  - AWCMCPS2

 This a new routine that will run one time as a post-init.  It's purpose 
 is to re-index the parameter file (177100.12) and correct an installation 
 index problem.

Routine Checksum:

=============================================================================
User Information:
Entered By  : MARTIN,TOMMY                  Date Entered  : JAN 30, 2004
Completed By: SINGH,GURBIR                  Date Completed: MAR 02, 2004
Released By : HARROD,PAUL                   Date Released : MAR 04, 2004
=============================================================================


Packman Mail Message:
=====================

$END TXT
