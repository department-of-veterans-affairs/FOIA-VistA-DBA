Released EC*2*56 SEQ #52
Extracted from mail message
**KIDS**:EC*2.0*56^

**INSTALL NAME**
EC*2.0*56
"BLD",5220,0)
EC*2.0*56^EVENT CAPTURE^0^3031203^y
"BLD",5220,1,0)
^^2^2^3031203^
"BLD",5220,1,1,0)
This patch addresses NOISes related to the Event Capture
"BLD",5220,1,2,0)
Provider Summary Report.
"BLD",5220,4,0)
^9.64PA^^
"BLD",5220,"ABPKG")
n
"BLD",5220,"KRN",0)
^9.67PA^8989.52^19
"BLD",5220,"KRN",.4,0)
.4
"BLD",5220,"KRN",.401,0)
.401
"BLD",5220,"KRN",.402,0)
.402
"BLD",5220,"KRN",.403,0)
.403
"BLD",5220,"KRN",.5,0)
.5
"BLD",5220,"KRN",.84,0)
.84
"BLD",5220,"KRN",3.6,0)
3.6
"BLD",5220,"KRN",3.8,0)
3.8
"BLD",5220,"KRN",9.2,0)
9.2
"BLD",5220,"KRN",9.8,0)
9.8
"BLD",5220,"KRN",9.8,"NM",0)
^9.68A^2^2
"BLD",5220,"KRN",9.8,"NM",1,0)
ECPROV3^^0^B31918117
"BLD",5220,"KRN",9.8,"NM",2,0)
ECRRPT^^0^B41323639
"BLD",5220,"KRN",9.8,"NM","B","ECPROV3",1)

"BLD",5220,"KRN",9.8,"NM","B","ECRRPT",2)

"BLD",5220,"KRN",19,0)
19
"BLD",5220,"KRN",19.1,0)
19.1
"BLD",5220,"KRN",101,0)
101
"BLD",5220,"KRN",409.61,0)
409.61
"BLD",5220,"KRN",771,0)
771
"BLD",5220,"KRN",870,0)
870
"BLD",5220,"KRN",8989.51,0)
8989.51
"BLD",5220,"KRN",8989.52,0)
8989.52
"BLD",5220,"KRN",8994,0)
8994
"BLD",5220,"KRN","B",.4,.4)

"BLD",5220,"KRN","B",.401,.401)

"BLD",5220,"KRN","B",.402,.402)

"BLD",5220,"KRN","B",.403,.403)

"BLD",5220,"KRN","B",.5,.5)

"BLD",5220,"KRN","B",.84,.84)

"BLD",5220,"KRN","B",3.6,3.6)

"BLD",5220,"KRN","B",3.8,3.8)

"BLD",5220,"KRN","B",9.2,9.2)

"BLD",5220,"KRN","B",9.8,9.8)

"BLD",5220,"KRN","B",19,19)

"BLD",5220,"KRN","B",19.1,19.1)

"BLD",5220,"KRN","B",101,101)

"BLD",5220,"KRN","B",409.61,409.61)

"BLD",5220,"KRN","B",771,771)

"BLD",5220,"KRN","B",870,870)

"BLD",5220,"KRN","B",8989.51,8989.51)

"BLD",5220,"KRN","B",8989.52,8989.52)

"BLD",5220,"KRN","B",8994,8994)

"BLD",5220,"QUES",0)
^9.62^^
"BLD",5220,"REQB",0)
^9.611^2^2
"BLD",5220,"REQB",1,0)
EC*2.0*47^2
"BLD",5220,"REQB",2,0)
EC*2.0*41^2
"BLD",5220,"REQB","B","EC*2.0*41",2)

"BLD",5220,"REQB","B","EC*2.0*47",1)

"MBREQ")
0
"PKG",486,-1)
1^1
"PKG",486,0)
EVENT CAPTURE^EC^Event Capture Workload Capture System^
"PKG",486,20,0)
^9.402P^^
"PKG",486,22,0)
^9.49I^1^1
"PKG",486,22,1,0)
2.0^2960508^2981027^66481
"PKG",486,22,1,"PAH",1,0)
56^3031203
"PKG",486,22,1,"PAH",1,1,0)
^^2^2^3031203
"PKG",486,22,1,"PAH",1,1,1,0)
This patch addresses NOISes related to the Event Capture
"PKG",486,22,1,"PAH",1,1,2,0)
Provider Summary Report.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
2
"RTN","ECPROV3")
0^1^B31918117
"RTN","ECPROV3",1,0)
ECPROV3 ;BIR/MAM,JPW-Event Capture Provider Summary (cont'd) ;7 May 96
"RTN","ECPROV3",2,0)
 ;;2.0; EVENT CAPTURE ;**5,8,18,29,47,56**;8 May 96
"RTN","ECPROV3",3,0)
 ; This routine is used when printing the report for
"RTN","ECPROV3",4,0)
 ; all ACCESSIBLE DSS Units
"RTN","ECPROV3",5,0)
 ;JAM/3/7/03, This routine now combines ECPROV3, ECPROV4 and ECPROV5
"RTN","ECPROV3",6,0)
 ;
"RTN","ECPROV3",7,0)
 S %H=$H D YX^%DTC S ECRDT=Y
"RTN","ECPROV3",8,0)
 I ECL D  D LOC,PRINT Q
"RTN","ECPROV3",9,0)
 .I ECPRV=1 D UNIT Q
"RTN","ECPROV3",10,0)
 .I 'ECPRV S ECC=+$P(^ECD(ECD,0),U,11) Q
"RTN","ECPROV3",11,0)
 S ECL=0 D
"RTN","ECPROV3",12,0)
 .F I=0:0 S ECL=$O(^ECH("ADT",ECL)) Q:'ECL  D
"RTN","ECPROV3",13,0)
 ..S ECLN=$P(^DIC(4,ECL,0),"^") I ECPRV D UNIT
"RTN","ECPROV3",14,0)
 ..I 'ECPRV S ECC=+$P(^ECD(ECD,0),U,11)
"RTN","ECPROV3",15,0)
 ..D LOC
"RTN","ECPROV3",16,0)
PRINT ;Changes below were made by VMP to correct NOIS ATG-1003-32545
"RTN","ECPROV3",17,0)
 S (ECLN,ECPN)=0,ECCN=""
"RTN","ECPROV3",18,0)
 F I=0:0 S ECLN=$O(^TMP($J,ECLN)) Q:ECLN=""!(ECOUT)!(ECLN["^")  D
"RTN","ECPROV3",19,0)
 .I 'ECPRV D CATS Q
"RTN","ECPROV3",20,0)
 . S ECDN="" D NOUNIT F I=0:0 S ECDN=$O(^TMP($J,ECLN,ECDN)) Q:ECDN=""!(ECOUT)  D CATS
"RTN","ECPROV3",21,0)
 K ECPNAM
"RTN","ECPROV3",22,0)
 Q
"RTN","ECPROV3",23,0)
CATS ; continue looping
"RTN","ECPROV3",24,0)
 I $O(^TMP($J,ECLN,ECDN,""))']"" D PAGE W !!!,?12,"NO PROCEDURES" S ECPG=1 Q
"RTN","ECPROV3",25,0)
 D PAGE Q:ECOUT  S ECPG=1,ECUN=0 F I=0:0 S ECUN=$O(^TMP($J,ECLN,ECDN,ECUN)) Q:ECUN=""!(ECOUT)  S ECINZ="^"_$O(^(ECUN,0)) D:$Y+7>IOSL PAGE Q:ECOUT  D PRO
"RTN","ECPROV3",26,0)
 Q
"RTN","ECPROV3",27,0)
PRO I $Y+10>IOSL D PAGE I ECOUT Q
"RTN","ECPROV3",28,0)
 W !!,ECUN S ECCN=0 F I=0:0 S ECCN=$O(^TMP($J,ECINZ,ECCN)) D:ECCN="" TOTP Q:ECCN=""!(ECOUT)  D MORE
"RTN","ECPROV3",29,0)
 Q
"RTN","ECPROV3",30,0)
MORE ;
"RTN","ECPROV3",31,0)
 ;ALB/ESD - Loop through to get procedure reason and print
"RTN","ECPROV3",32,0)
 W !,?3,ECCN S ECPN=0,(ECPRSN,ECPI)=""
"RTN","ECPROV3",33,0)
 F  S ECPN=$O(^TMP($J,ECINZ,ECCN,ECPN)) Q:ECPN=""!(ECOUT)  S ECUSER=1 D:$Y+7>IOSL PAGE Q:ECOUT  K ECUSER F  S ECPRSN=$O(^TMP($J,ECINZ,ECCN,ECPN,ECPRSN)) Q:ECPRSN=""!(ECOUT)  DO
"RTN","ECPROV3",34,0)
 .S ECCPT=$S($P(ECPN,"~",3)="I":$P(ECPN,"~",2),1:$P($G(^EC(725,$P(ECPN,"~",2),0)),"^",5))
"RTN","ECPROV3",35,0)
 .I ECCPT'="" D
"RTN","ECPROV3",36,0)
 ..;Changes made by VMP to correct NOIS ATG-1003-32545
"RTN","ECPROV3",37,0)
 ..S ECPI=$$CPT^ICPTCOD(ECCPT),ECCPT=$P(ECPI,"^",2)
"RTN","ECPROV3",38,0)
 .S ECPNAM=$S($P(ECPN,"~",3)="E":$P($G(^EC(725,+$P(ECPN,"~",2),0)),"^"),$P(ECPN,"~",3)="I":$P(ECPI,"^",3),1:"UNKNOWN")
"RTN","ECPROV3",39,0)
 .S ECPSY=$P(ECPN,"~",4),ECPSYN=""
"RTN","ECPROV3",40,0)
 .I ECPSY'="" S ECPSYN=$P($G(^ECJ(ECPSY,"PRO")),"^",2)
"RTN","ECPROV3",41,0)
 .W !,?6,ECCPT," ",$E(ECPNAM,1,40) W:ECPSYN'="" " [",$E(ECPSYN,1,25),"]"
"RTN","ECPROV3",42,0)
 .W:$D(ECRY) ?70,ECPRSN
"RTN","ECPROV3",43,0)
 .W ?105,$J(^TMP($J,ECINZ,ECCN,ECPN,ECPRSN),6)
"RTN","ECPROV3",44,0)
 .;print CPT procedure modifiers
"RTN","ECPROV3",45,0)
 .S IEN=""
"RTN","ECPROV3",46,0)
 .F  S IEN=$O(^TMP($J,ECINZ,ECCN,ECPN,ECPRSN,"MOD",IEN)) Q:IEN=""  D  I ECOUT Q
"RTN","ECPROV3",47,0)
 ..S MODI=$$MOD^ICPTMOD(IEN,"I",$P(ECPN,"~",5))
"RTN","ECPROV3",48,0)
 ..S MOD=$P(MODI,"^",2) I MOD="" K MODI Q
"RTN","ECPROV3",49,0)
 ..S MODESC=$P(MODI,"^",3) I MODESC="" S MODESC="UNKNOWN"
"RTN","ECPROV3",50,0)
 ..S MODAMT=^TMP($J,ECINZ,ECCN,ECPN,ECPRSN,"MOD",IEN)
"RTN","ECPROV3",51,0)
 ..W !?10,"- ",MOD," ",MODESC," (",MODAMT,")"
"RTN","ECPROV3",52,0)
 ..I ($Y+3)>IOSL D PAGE
"RTN","ECPROV3",53,0)
 .K MODESC,MOD,IEN,MODAMT,MODI
"RTN","ECPROV3",54,0)
 Q
"RTN","ECPROV3",55,0)
LOC S (ECDFN,ECOUT,^TMP($J,ECLN))=0
"RTN","ECPROV3",56,0)
 F I=0:0 S ECDFN=$O(^ECH("ADT",ECL,ECDFN)) Q:'ECDFN  D
"RTN","ECPROV3",57,0)
 .I ECPRV D GECD Q
"RTN","ECPROV3",58,0)
 .D GMM
"RTN","ECPROV3",59,0)
 Q
"RTN","ECPROV3",60,0)
GECD S ECD=0 F I=0:0 S ECD=$O(^ECH("ADT",ECL,ECDFN,ECD)) Q:'ECD  D GMM
"RTN","ECPROV3",61,0)
 Q
"RTN","ECPROV3",62,0)
GMM S MM=ECSD F I=0:0 S MM=$O(^ECH("ADT",ECL,ECDFN,ECD,MM)) Q:'MM!(MM>ECED)  D LOC1
"RTN","ECPROV3",63,0)
 Q
"RTN","ECPROV3",64,0)
LOC1 S ECFN=0 F I=0:0 S ECFN=$O(^ECH("ADT",ECL,ECDFN,ECD,MM,ECFN)) Q:'ECFN  D UTL
"RTN","ECPROV3",65,0)
 Q
"RTN","ECPROV3",66,0)
UTL ; set ^TMP($J,"ECPROV"
"RTN","ECPROV3",67,0)
 Q:'$D(^ECH(+ECFN,0))!(+$G(ECD)'=$P($G(^ECH(+ECFN,0)),"^",7))
"RTN","ECPROV3",68,0)
 S ECEC=^ECH(+ECFN,0),ECV=+$P(ECEC,"^",10),ECC=+$P(ECEC,"^",8)
"RTN","ECPROV3",69,0)
 S ECP=$P(ECEC,"^",9),ECU=+$P(ECEC,"^",11)
"RTN","ECPROV3",70,0)
 S ECCN=$S($P($G(^EC(726,ECC,0)),"^")]"":$P(^(0),"^"),1:"None")
"RTN","ECPROV3",71,0)
 Q:ECP']""
"RTN","ECPROV3",72,0)
 S ECD=+$P(ECEC,"^",7)
"RTN","ECPROV3",73,0)
 I ECPRV=1 Q:'$D(ECDU(ECD))  S ECDN=ECDU(ECD)
"RTN","ECPROV3",74,0)
 I ECPRV=2 S ECDN=$S($P($G(^ECD(ECD,0)),"^")]"":$P(^(0),"^"),1:"UNKNOWN")
"RTN","ECPROV3",75,0)
 S ECUN=$S($P($G(^VA(200,ECU,0)),"^")]"":$P(^(0),"^"),1:"UNKNOWN")
"RTN","ECPROV3",76,0)
 S ECPSY=+$O(^ECJ("AP",ECL,ECD,ECC,ECP,"")),ECPN=""
"RTN","ECPROV3",77,0)
 S ECFILE=$P(ECP,";",2),ECFILE=$S($E(ECFILE)="I":81,$E(ECFILE)="E":725,1:"UNKNOWN")
"RTN","ECPROV3",78,0)
 I ECFILE=81 S ECPN=$P($$CPT^ICPTCOD(+ECP,$P(ECEC,"^",3)),"^",3)
"RTN","ECPROV3",79,0)
 I ECFILE=725 S ECPN=$P($G(^EC(725,+ECP,0)),"^")
"RTN","ECPROV3",80,0)
 I ECFILE="UNKNOWN"!(ECPN="") S ECPN="UNKNOWN"
"RTN","ECPROV3",81,0)
 ;Changes made by VMP to correct NOIS SDC-1003-60397
"RTN","ECPROV3",82,0)
 S ECPN=$E(ECPN,1,5)_"~"_$P(ECP,";")_"~"_$E($P(ECP,";",2))_"~"_ECPSY
"RTN","ECPROV3",83,0)
 ;Get Procedure CPT modifiers
"RTN","ECPROV3",84,0)
 S ECMODF=0 K ECMOD
"RTN","ECPROV3",85,0)
 I $O(^ECH(+ECFN,"MOD",0))'="" S ECMODF=$$MOD^ECUTL(+ECFN,"I",.ECMOD)
"RTN","ECPROV3",86,0)
 ;
"RTN","ECPROV3",87,0)
 ;ALB/ESD - Get procedure reason from EC Patient file (#721) record
"RTN","ECPROV3",88,0)
 N ECLNK
"RTN","ECPROV3",89,0)
 S ECPRSN=""
"RTN","ECPROV3",90,0)
 S ECLNK=+$P(ECEC,"^",23)
"RTN","ECPROV3",91,0)
 I +ECLNK>0 DO
"RTN","ECPROV3",92,0)
 .S ECPRSN=$P($G(^ECL(ECLNK,0)),"^",1)
"RTN","ECPROV3",93,0)
 .S:+ECPRSN'>0 ECPRSN="REASON NOT DEFINED"
"RTN","ECPROV3",94,0)
 .S:+ECPRSN>0 ECPRSN=$P(^ECR(ECPRSN,0),"^",1)
"RTN","ECPROV3",95,0)
 S:+ECLNK'>0 ECPRSN="REASON NOT DEFINED"
"RTN","ECPROV3",96,0)
 I '$D(ECRY) S ECPRSN="REASON NOT DEFINED" ;group proc reason-not print
"RTN","ECPROV3",97,0)
 I '$D(^TMP($J,ECLN,ECDN,ECUN)) S ECINC=ECINC+1,ECINZ="^"_ECINC,^(ECUN)=0,^(ECUN,ECINC)=0
"RTN","ECPROV3",98,0)
 S ECINZ="^"_$O(^TMP($J,ECLN,ECDN,ECUN,0))
"RTN","ECPROV3",99,0)
 I '$D(^TMP($J,ECINZ,ECCN)) S ^TMP($J,ECINZ,ECCN)=0
"RTN","ECPROV3",100,0)
 ;
"RTN","ECPROV3",101,0)
 ;ALB/ESD - Add procedure reason to ^TMP array
"RTN","ECPROV3",102,0)
 I '$D(^TMP($J,ECINZ,ECCN,ECPN,ECPRSN)) S ^TMP($J,ECINZ,ECCN,ECPN,ECPRSN)=0
"RTN","ECPROV3",103,0)
 S ^TMP($J,ECLN)=^TMP($J,ECLN)+ECV
"RTN","ECPROV3",104,0)
 S ^TMP($J,ECLN,ECDN,ECUN)=^TMP($J,ECLN,ECDN,ECUN)+ECV
"RTN","ECPROV3",105,0)
 S ^TMP($J,ECINZ,ECCN)=^TMP($J,ECINZ,ECCN)+ECV
"RTN","ECPROV3",106,0)
 ;
"RTN","ECPROV3",107,0)
 ;ALB/ESD - Add procedure reason to ^TMP array
"RTN","ECPROV3",108,0)
 S ^TMP($J,ECINZ,ECCN,ECPN,ECPRSN)=^TMP($J,ECINZ,ECCN,ECPN,ECPRSN)+ECV
"RTN","ECPROV3",109,0)
 ;ALB/JAM - Add Procedure CPT modifier to ^TMP array
"RTN","ECPROV3",110,0)
 S MOD="" F  S MOD=$O(ECMOD(MOD)) Q:MOD=""  D
"RTN","ECPROV3",111,0)
 . S ^TMP($J,ECINZ,ECCN,ECPN,ECPRSN,"MOD",MOD)=$G(^TMP($J,ECINZ,ECCN,ECPN,ECPRSN,"MOD",MOD))+ECV
"RTN","ECPROV3",112,0)
 Q
"RTN","ECPROV3",113,0)
PAGE ; end of page
"RTN","ECPROV3",114,0)
 I $D(ECPG),$E(IOST,1,2)="C-" W !!,"Press <RET> to continue, or ^ to quit  " R X:DTIME I '$T!(X="^") S ECOUT=1 Q
"RTN","ECPROV3",115,0)
HDR ; print heading
"RTN","ECPROV3",116,0)
 W:$Y @IOF W !!,?49,"EVENT CAPTURE PROVIDER SUMMARY",!,?49,"FROM "_$P(ECDATE,"^")_"  TO "_$P(ECDATE,"^",2),!,?49,"Run Date : ",ECRDT
"RTN","ECPROV3",117,0)
 W !!?3,"Category",!,?6,"CPT Code",?20,"Description"
"RTN","ECPROV3",118,0)
 W:$D(ECRY) ?70,"Procedure Reason"
"RTN","ECPROV3",119,0)
 W ?105,"Volume",!,?10,"CPT Modifier (volume)",!
"RTN","ECPROV3",120,0)
 F LINE=1:1:132 W "-"
"RTN","ECPROV3",121,0)
 W !!,"Location: "_ECLN,! W:ECDN]"" "DSS Unit: "_ECDN
"RTN","ECPROV3",122,0)
 I ECPRV,$D(ECUSER) W !!,ECUN,!,ECCN
"RTN","ECPROV3",123,0)
 Q
"RTN","ECPROV3",124,0)
TOTP Q:ECOUT  W !,?105,"------",!,"Total Procedures for "_ECUN,?105,$J(^TMP($J,ECLN,ECDN,ECUN),6)
"RTN","ECPROV3",125,0)
 Q
"RTN","ECPROV3",126,0)
UNIT ; set units
"RTN","ECPROV3",127,0)
 S CNT=0 F I=0:0 S CNT=$O(UNIT(CNT)) Q:'CNT  S ECDU(+UNIT(CNT))=$P(UNIT(CNT),"^",2)
"RTN","ECPROV3",128,0)
 Q
"RTN","ECPROV3",129,0)
 ;
"RTN","ECPROV3",130,0)
NOUNIT ;Nothing there
"RTN","ECPROV3",131,0)
 I $O(^TMP($J,ECLN,ECDN))']"" D PAGE W !!!,?12,"NO PROCEDURES",! S ECPG=1
"RTN","ECPROV3",132,0)
 Q
"RTN","ECRRPT")
0^2^B41323639
"RTN","ECRRPT",1,0)
ECRRPT ;ALB/JAM;Event Capture Report RPC Broker ;Jan 2, 2001
"RTN","ECRRPT",2,0)
 ;;2.0; EVENT CAPTURE ;**25,32,41,56**;8 May 96
"RTN","ECRRPT",3,0)
 ;
"RTN","ECRRPT",4,0)
REQCHK(ECV) ;Required data check
"RTN","ECRRPT",5,0)
 N I,C
"RTN","ECRRPT",6,0)
 S C=1
"RTN","ECRRPT",7,0)
 F I=1:1:$L(ECV,U) I '$D(@$P(ECV,U,I)) D
"RTN","ECRRPT",8,0)
 . S ^TMP("ECMSG",$J,C)="0^Required data missing "_$P(ECV,U,I)
"RTN","ECRRPT",9,0)
 . S C=C+1,ECERR=1
"RTN","ECRRPT",10,0)
 Q
"RTN","ECRRPT",11,0)
DATECHK(ECSD,ECED) ;Check human format date and converts to FileMan format
"RTN","ECRRPT",12,0)
 ;    Input  ECSD  - Start Date (ex. 10/9/01)
"RTN","ECRRPT",13,0)
 ;           ECED  - End Date
"RTN","ECRRPT",14,0)
 N ECI,X,Y
"RTN","ECRRPT",15,0)
 S %DT="X" F ECI="ECSD","ECED" S X=@ECI D ^%DT S @ECI=Y
"RTN","ECRRPT",16,0)
 S ECSD=$S(ECSD=-1:DT,1:ECSD),ECED=$S(ECED=-1:DT,1:ECED)
"RTN","ECRRPT",17,0)
 S ECDATE=$$FMTE^XLFDT(ECSD)_"^"_$$FMTE^XLFDT(ECED)
"RTN","ECRRPT",18,0)
 Q
"RTN","ECRRPT",19,0)
QUEUE ;Queues report to printer
"RTN","ECRRPT",20,0)
 N ZTIO,ZTDESC,ZTRTN,ZTDTH,ZTSAVE,%ZIS,I,IOP,POP
"RTN","ECRRPT",21,0)
 S XNAM=$P($G(^%ZIS(1,ECDEV,0)),U,2)
"RTN","ECRRPT",22,0)
 S IOP="Q;`"_ECDEV,%ZIS="Q" D ^%ZIS I POP D  Q
"RTN","ECRRPT",23,0)
 . ;S IOP="Q;"_XNAM,%ZIS="Q" D ^%ZIS I POP D  Q
"RTN","ECRRPT",24,0)
 . S ^TMP("ECMSG",$J,1)="0^Device selection unsuccessful"
"RTN","ECRRPT",25,0)
 S ZTIO=ION,ZTDESC=ECDESC,ZTRTN=ECROU
"RTN","ECRRPT",26,0)
 S ZTDTH=$$FMTH^XLFDT(ECQDT)
"RTN","ECRRPT",27,0)
 ;D NOW^%DTC S ZTDTH=$S(%'<ECQDT:%+.0002,1:ECQDT)
"RTN","ECRRPT",28,0)
 F I=1:1:$L(ECV,U) I $D(@$P(ECV,U,I)) S ZTSAVE($P(ECV,U,I))=""
"RTN","ECRRPT",29,0)
 M ZTSAVE=ECSAVE
"RTN","ECRRPT",30,0)
 D ^%ZTLOAD,HOME^%ZIS,^%ZISC ;K IO("Q")
"RTN","ECRRPT",31,0)
 I $D(ZTSK) S ^TMP("ECMSG",$J)="1^Report queued. Task #"_ZTSK Q
"RTN","ECRRPT",32,0)
 S ^TMP("ECMSG",$J)="0^Task Rejected"
"RTN","ECRRPT",33,0)
 Q
"RTN","ECRRPT",34,0)
 ;
"RTN","ECRRPT",35,0)
ECPAT ;Patient Summary Report for RPC Call
"RTN","ECRRPT",36,0)
 ;     Variables passed in
"RTN","ECRRPT",37,0)
 ;       ECDFN  - Patient IEN for file #2
"RTN","ECRRPT",38,0)
 ;       ECSD   - Start Date or Report
"RTN","ECRRPT",39,0)
 ;       ECED   - End Date or Report
"RTN","ECRRPT",40,0)
 ;       ECRY   - Print Procedure Reason (optional)
"RTN","ECRRPT",41,0)
 ;
"RTN","ECRRPT",42,0)
 ;     Variable return
"RTN","ECRRPT",43,0)
 ;       ^TMP($J,"ECRPT",n)=report output or to print device.
"RTN","ECRRPT",44,0)
 N ECDATE,ECPAT,ECV,DIC,X,Y,ECROU,ECDESC
"RTN","ECRRPT",45,0)
 S ECV="ECDFN^ECSD^ECED" D REQCHK(ECV) I ECERR Q
"RTN","ECRRPT",46,0)
 S DIC=2,DIC(0)="QNMZX",X=ECDFN D ^DIC Q:Y<0  S ECPAT=$P(Y,U,2)
"RTN","ECRRPT",47,0)
 D DATECHK(.ECSD,.ECED)
"RTN","ECRRPT",48,0)
 S ECSD=ECSD-.0001,ECED=ECED+.9999
"RTN","ECRRPT",49,0)
 I $E($G(ECRY))'="Y" K ECRY
"RTN","ECRRPT",50,0)
 I ECPTYP="P" D  Q
"RTN","ECRRPT",51,0)
 . S ECV="ECDFN^ECPAT^ECDATE^ECSD^ECED^ECRY",ECROU="SUM^ECPAT"
"RTN","ECRRPT",52,0)
 . S ECDESC="EVENT CAPTURE PATIENT SUMMARY"
"RTN","ECRRPT",53,0)
 . D QUEUE
"RTN","ECRRPT",54,0)
 D SUM^ECPAT
"RTN","ECRRPT",55,0)
 Q
"RTN","ECRRPT",56,0)
ECRDSSU ;DSS Unit Workload Summary Report
"RTN","ECRRPT",57,0)
 ;     Variables passed in
"RTN","ECRRPT",58,0)
 ;       ECL    - Location to report (1 or ALL)
"RTN","ECRRPT",59,0)
 ;       ECD    - DSS Unit to report (1, some or ALL)
"RTN","ECRRPT",60,0)
 ;       ECSD   - Start Date or Report
"RTN","ECRRPT",61,0)
 ;       ECED   - End Date or Report
"RTN","ECRRPT",62,0)
 ;       ECDUZ  - User IEN from file (#200)
"RTN","ECRRPT",63,0)
 ;
"RTN","ECRRPT",64,0)
 ;     Variable return
"RTN","ECRRPT",65,0)
 ;       ^TMP($J,"ECRPT",n)=report output or to print device.
"RTN","ECRRPT",66,0)
 N ECLOC,ECDSSU,ECV,ECI,ECSTDT,ECENDDT,ECKEY,ECROU,ECSAVE,ECDESC,ECNT
"RTN","ECRRPT",67,0)
 N ECDATE,ECX,DUZ,DIC,X,Y
"RTN","ECRRPT",68,0)
 S ECV="ECL^ECD0^ECSD^ECED^ECDUZ" D REQCHK(ECV) I ECERR Q
"RTN","ECRRPT",69,0)
 D  I '$D(ECLOC) S ^TMP("ECMSG",$J)="1^Invalid Location." Q
"RTN","ECRRPT",70,0)
 . I ECL="ALL" D LOCARRY^ECRUTL Q
"RTN","ECRRPT",71,0)
 . S DIC=4,DIC(0)="QNMZX",X=ECL D ^DIC Q:Y<0  S ECLOC(1)=+Y_"^"_$P(Y,U,2)
"RTN","ECRRPT",72,0)
 D  I '$D(ECDSSU) S ^TMP("ECMSG",$J)="1^Invalid DSS Unit." Q
"RTN","ECRRPT",73,0)
 . I ECD0="ALL" D  Q
"RTN","ECRRPT",74,0)
 . . S ECKEY=$S($D(^XUSEC("ECALLU",ECDUZ)):1,1:0),DUZ=ECDUZ D ALLU^ECRUTL
"RTN","ECRRPT",75,0)
 . S (ECI,ECNT)=0 F ECI=0:1 S ECX="ECD"_ECI Q:'$D(@ECX)  D
"RTN","ECRRPT",76,0)
 . . K DIC S DIC=724,DIC(0)="QNMZX",X=@ECX D ^DIC I Y<0 Q
"RTN","ECRRPT",77,0)
 . . S ECNT=ECNT+1,ECDSSU(ECNT)=Y
"RTN","ECRRPT",78,0)
 D DATECHK(.ECSD,.ECED)
"RTN","ECRRPT",79,0)
 S ECSTDT=ECSD-.0001,ECENDDT=ECED+.9999
"RTN","ECRRPT",80,0)
 I ECPTYP="P" D  Q
"RTN","ECRRPT",81,0)
 . S ECV="ECDATE^ECSTDT^ECENDDT",ECROU="STRPT^ECRDSSU"
"RTN","ECRRPT",82,0)
 . S (ECSAVE("ECLOC("),ECSAVE("ECDSSU("))=""
"RTN","ECRRPT",83,0)
 . S ECDESC="DSS UNIT WORKLOAD SUMMARY REPORT"
"RTN","ECRRPT",84,0)
 . D QUEUE
"RTN","ECRRPT",85,0)
 D STRPT^ECRDSSU
"RTN","ECRRPT",86,0)
 Q
"RTN","ECRRPT",87,0)
PROSUM ;Provider (1-3) Summary Report for RPC Call
"RTN","ECRRPT",88,0)
 ;     Variables passed in
"RTN","ECRRPT",89,0)
 ;       ECU    - Provider IEN for file #200
"RTN","ECRRPT",90,0)
 ;       ECSD   - Start Date or Report
"RTN","ECRRPT",91,0)
 ;       ECED   - End Date or Report
"RTN","ECRRPT",92,0)
 ;       ECRY   - Print Procedure Reason (optional)
"RTN","ECRRPT",93,0)
 ;
"RTN","ECRRPT",94,0)
 ;     Variable return
"RTN","ECRRPT",95,0)
 ;       ^TMP($J,"ECRPT",n)=report output or to print device.
"RTN","ECRRPT",96,0)
 N ECV,ECDATE,ECUN,ECROU,ECDESC,DIC,X,Y
"RTN","ECRRPT",97,0)
 S ECV="ECU^ECSD^ECED" D REQCHK(ECV) I ECERR Q
"RTN","ECRRPT",98,0)
 S DIC=200,DIC(0)="QNZX",X=ECU D ^DIC D:Y<0  Q:Y<0  S ECUN=$P(Y,U,2)
"RTN","ECRRPT",99,0)
 . S ^TMP("ECMSG",$J)="1^Invalid Provider."
"RTN","ECRRPT",100,0)
 D DATECHK(.ECSD,.ECED)
"RTN","ECRRPT",101,0)
 S ECSD=ECSD-.0001,ECED=ECED+.9999
"RTN","ECRRPT",102,0)
 I ECRY'="Y" K ECRY
"RTN","ECRRPT",103,0)
 I ECPTYP="P" D  Q
"RTN","ECRRPT",104,0)
 . S ECV="ECU^ECUN^ECDATE^ECSD^ECED^ECRY"
"RTN","ECRRPT",105,0)
 . S ECROU="EN^ECPRSUM1",ECDESC="Event Capture Provider Summary"
"RTN","ECRRPT",106,0)
 . D QUEUE
"RTN","ECRRPT",107,0)
 D EN^ECPRSUM1
"RTN","ECRRPT",108,0)
 Q
"RTN","ECRRPT",109,0)
ECPROV ;Provider Summary Report for RPC Call
"RTN","ECRRPT",110,0)
 ;     Variables passed in
"RTN","ECRRPT",111,0)
 ;       ECL    - Location to report (1 or ALL)
"RTN","ECRRPT",112,0)
 ;       ECD    - DSS Unit to report (1 or ALL)
"RTN","ECRRPT",113,0)
 ;       ECSD   - Start Date or Report
"RTN","ECRRPT",114,0)
 ;       ECED   - End Date or Report
"RTN","ECRRPT",115,0)
 ;       ECRY   - Print Procedure Reason (optional)
"RTN","ECRRPT",116,0)
 ;       ECDUZ  - User DUZ (ien in #200)
"RTN","ECRRPT",117,0)
 ;
"RTN","ECRRPT",118,0)
 ;     Variable return
"RTN","ECRRPT",119,0)
 ;       ^TMP($J,"ECRPT",n)=report output or to print device.
"RTN","ECRRPT",120,0)
 N ECV,ECDN,ECDATE,ECLN,ECSAVE,ECDESC,ECROU,DIC,X,Y,CNT,UNIT
"RTN","ECRRPT",121,0)
 S ECDN="ALL",ECV="ECL^ECD^ECSD^ECED^ECDUZ" D REQCHK(ECV) I ECERR Q
"RTN","ECRRPT",122,0)
 I ECL'="ALL" D  I ECERR Q
"RTN","ECRRPT",123,0)
 . ;The line below was changed by VMP for NOIS ANN-1003-42305
"RTN","ECRRPT",124,0)
 . S DIC=4,DIC(0)="QNZX",X=ECL D ^DIC D:Y<0  Q:Y<0  S ECLN=$P(Y,U,2)
"RTN","ECRRPT",125,0)
 . . S ^TMP("ECMSG",$J)="1^Invalid Location.",ECERR=1
"RTN","ECRRPT",126,0)
 I ECD'="ALL" K DIC D  I ECERR Q
"RTN","ECRRPT",127,0)
 . S DIC=724,DIC(0)="QNMZX",X=ECD D ^DIC D:Y<0  Q:Y<0  S ECDN=$P(Y,U,2)
"RTN","ECRRPT",128,0)
 . . S ^TMP("ECMSG",$J)="1^Invalid Location.",ECERR=1
"RTN","ECRRPT",129,0)
 I ECD="ALL",'$D(^XUSEC("ECALLU",ECDUZ)) D
"RTN","ECRRPT",130,0)
 . S (ECD,ECDN)="SOME",(X,CNT)=0
"RTN","ECRRPT",131,0)
 . F  S X=$O(^VA(200,ECDUZ,"EC",X)) Q:'X  D
"RTN","ECRRPT",132,0)
 . . S CNT=CNT+1,UNIT=$P(^VA(200,ECDUZ,"EC",X,0),"^")
"RTN","ECRRPT",133,0)
 . . S UNIT(CNT)=UNIT_"^"_$P(^ECD(UNIT,0),"^")
"RTN","ECRRPT",134,0)
 I $E($G(ECRY))'="Y" K ECRY
"RTN","ECRRPT",135,0)
 D DATECHK(.ECSD,.ECED)
"RTN","ECRRPT",136,0)
 S ECSD=ECSD-.0001,ECED=ECED+.9999 S:'$D(UNIT) UNIT=""
"RTN","ECRRPT",137,0)
 I ECPTYP="P" D  Q
"RTN","ECRRPT",138,0)
 . S ECV="ECDATE^ECSD^ECED^ECRY",ECROU="START^ECPROV2"
"RTN","ECRRPT",139,0)
 . S (ECSAVE("ECL*"),ECSAVE("ECD*"),ECSAVE("UNIT*"))=""
"RTN","ECRRPT",140,0)
 . S ECDESC="EVENT CAPTURE PROVIDER SUMMARY"
"RTN","ECRRPT",141,0)
 . D QUEUE
"RTN","ECRRPT",142,0)
 U IO D START^ECPROV2
"RTN","ECRRPT",143,0)
 Q
"RTN","ECRRPT",144,0)
ECOSSUM ;Ordering Section Summary Report for RPC Call
"RTN","ECRRPT",145,0)
 ;     Variables passed in
"RTN","ECRRPT",146,0)
 ;       ECOS   - Ordering Section
"RTN","ECRRPT",147,0)
 ;       ECSD   - Start Date or Report
"RTN","ECRRPT",148,0)
 ;       ECED   - End Date or Report
"RTN","ECRRPT",149,0)
 ;       ECL    - Location to report (1 or ALL)
"RTN","ECRRPT",150,0)
 ;       ECD    - DSS Unit to report (1, some or ALL)
"RTN","ECRRPT",151,0)
 ;       ECDUZ  - User ien (#200)
"RTN","ECRRPT",152,0)
 ;
"RTN","ECRRPT",153,0)
 ;     Variable return
"RTN","ECRRPT",154,0)
 ;       ^TMP($J,"ECRPT",n)=report output or to print device.
"RTN","ECRRPT",155,0)
 N ECV,ECI,ECOSN,ECLOC,ECDSSU,ECDATE,ECNT,ECSAVE,ECROU,ECDESC,DUZ,DIC,X,Y
"RTN","ECRRPT",156,0)
 S ECV="ECOS^ECL^ECD0^ECSD^ECED^ECDUZ" D REQCHK(ECV) I ECERR Q
"RTN","ECRRPT",157,0)
 S DIC=723,DIC(0)="QNMZX",X=ECOS D ^DIC D:Y<0  Q:Y<0  S ECOSN=$P(Y,U,2)
"RTN","ECRRPT",158,0)
 . S ^TMP("ECMSG",$J)="1^Invalid Ordering Section.",ECERR=1
"RTN","ECRRPT",159,0)
 D  I '$D(ECLOC) S ^TMP("ECMSG",$J)="1^Invalid Location.",ECERR=1 Q
"RTN","ECRRPT",160,0)
 . K DIC I ECL="ALL" D LOCARRY^ECRUTL Q
"RTN","ECRRPT",161,0)
 . S DIC=4,DIC(0)="QNZX",X=ECL D ^DIC Q:Y<0  S ECLOC(1)=+Y_"^"_$P(Y,U,2)
"RTN","ECRRPT",162,0)
 D  I '$D(ECDSSU) S ^TMP("ECMSG",$J)="1^Invalid DSS Unit." Q
"RTN","ECRRPT",163,0)
 . I ECD0="ALL" D  Q
"RTN","ECRRPT",164,0)
 . . S ECKEY=$S($D(^XUSEC("ECALLU",ECDUZ)):1,1:0),DUZ=ECDUZ D ALLU^ECRUTL
"RTN","ECRRPT",165,0)
 . S (ECI,ECNT)=0 F ECI=0:1 S ECX="ECD"_ECI Q:'$D(@ECX)  D
"RTN","ECRRPT",166,0)
 . . K DIC S DIC=724,DIC(0)="QNMZX",X=@ECX D ^DIC I Y<0 Q
"RTN","ECRRPT",167,0)
 . . S ECNT=ECNT+1,ECDSSU(ECNT)=Y
"RTN","ECRRPT",168,0)
 D DATECHK(.ECSD,.ECED)
"RTN","ECRRPT",169,0)
 S ECSD=ECSD-.0001,ECED=ECED+.9999
"RTN","ECRRPT",170,0)
 I ECPTYP="P" D  Q
"RTN","ECRRPT",171,0)
 . S ECV="ECOS^ECSD^ECED^ECOSN",ECROU="START^ECOSSUM"
"RTN","ECRRPT",172,0)
 . S (ECSAVE("ECLOC("),ECSAVE("ECDSSU("))=""
"RTN","ECRRPT",173,0)
 . S ECDESC="EC Ordering Section Summary"
"RTN","ECRRPT",174,0)
 . D QUEUE
"RTN","ECRRPT",175,0)
 D START^ECOSSUM
"RTN","ECRRPT",176,0)
 Q
"RTN","ECRRPT",177,0)
ECPCER ;PCE Data Summary Report for RPC Call
"RTN","ECRRPT",178,0)
 ;     Variables passed in
"RTN","ECRRPT",179,0)
 ;       ECDFN  - Patient IEN for file #2
"RTN","ECRRPT",180,0)
 ;       ECSD   - Start Date or Report
"RTN","ECRRPT",181,0)
 ;       ECED   - End Date or Report
"RTN","ECRRPT",182,0)
 ;
"RTN","ECRRPT",183,0)
 ;     Variable return
"RTN","ECRRPT",184,0)
 ;       ^TMP($J,"ECRPT",n)=report output or to print device.
"RTN","ECRRPT",185,0)
 N ECV,ECDATE,ECPAT,ECROU,ECDESC,X,DIC,Y
"RTN","ECRRPT",186,0)
 S ECV="ECDFN^ECSD^ECED" D REQCHK(ECV) I ECERR Q
"RTN","ECRRPT",187,0)
 S DIC=2,DIC(0)="QNMZX",X=ECDFN D ^DIC D:Y<0  Q:Y<0  S ECPAT=$P(Y,U,2)
"RTN","ECRRPT",188,0)
 . S ^TMP("ECMSG",$J)="1^Invalid Provider."
"RTN","ECRRPT",189,0)
 D DATECHK(.ECSD,.ECED)
"RTN","ECRRPT",190,0)
 S ECSD=ECSD-.0001,ECED=ECED+.9999
"RTN","ECRRPT",191,0)
 I ECPTYP="P" D  Q
"RTN","ECRRPT",192,0)
 . S ECV="ECDFN^ECPAT^ECDATE^ECSD^ECED",ECROU="SUM^ECPCER"
"RTN","ECRRPT",193,0)
 . S ECDESC="ECS/PCE PATIENT SUMMARY"
"RTN","ECRRPT",194,0)
 . D QUEUE
"RTN","ECRRPT",195,0)
 D SUM^ECPCER
"RTN","ECRRPT",196,0)
 Q
"VER")
8.0^22
**END**
**END**
