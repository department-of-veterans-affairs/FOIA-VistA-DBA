Released GMTS*2.7*59 SEQ #54
Extracted from mail message
**KIDS**:GMTS*2.7*59^

**INSTALL NAME**
GMTS*2.7*59
"BLD",3804,0)
GMTS*2.7*59^HEALTH SUMMARY^0^3021126^y
"BLD",3804,1,0)
^^2^2^3020718^
"BLD",3804,1,1,0)
The description of this build is found in the National Patch Module under 
"BLD",3804,1,2,0)
patch GMTS*2.7*59.
"BLD",3804,4,0)
^9.64PA^^
"BLD",3804,"KRN",0)
^9.67PA^8989.52^19
"BLD",3804,"KRN",.4,0)
.4
"BLD",3804,"KRN",.401,0)
.401
"BLD",3804,"KRN",.402,0)
.402
"BLD",3804,"KRN",.403,0)
.403
"BLD",3804,"KRN",.5,0)
.5
"BLD",3804,"KRN",.84,0)
.84
"BLD",3804,"KRN",3.6,0)
3.6
"BLD",3804,"KRN",3.8,0)
3.8
"BLD",3804,"KRN",9.2,0)
9.2
"BLD",3804,"KRN",9.8,0)
9.8
"BLD",3804,"KRN",9.8,"NM",0)
^9.68A^2^2
"BLD",3804,"KRN",9.8,"NM",1,0)
GMTSLRB^^0^B2785063
"BLD",3804,"KRN",9.8,"NM",2,0)
GMTSLRT^^0^B4237640
"BLD",3804,"KRN",9.8,"NM","B","GMTSLRB",1)

"BLD",3804,"KRN",9.8,"NM","B","GMTSLRT",2)

"BLD",3804,"KRN",19,0)
19
"BLD",3804,"KRN",19.1,0)
19.1
"BLD",3804,"KRN",101,0)
101
"BLD",3804,"KRN",409.61,0)
409.61
"BLD",3804,"KRN",771,0)
771
"BLD",3804,"KRN",870,0)
870
"BLD",3804,"KRN",8989.51,0)
8989.51
"BLD",3804,"KRN",8989.52,0)
8989.52
"BLD",3804,"KRN",8994,0)
8994
"BLD",3804,"KRN","B",.4,.4)

"BLD",3804,"KRN","B",.401,.401)

"BLD",3804,"KRN","B",.402,.402)

"BLD",3804,"KRN","B",.403,.403)

"BLD",3804,"KRN","B",.5,.5)

"BLD",3804,"KRN","B",.84,.84)

"BLD",3804,"KRN","B",3.6,3.6)

"BLD",3804,"KRN","B",3.8,3.8)

"BLD",3804,"KRN","B",9.2,9.2)

"BLD",3804,"KRN","B",9.8,9.8)

"BLD",3804,"KRN","B",19,19)

"BLD",3804,"KRN","B",19.1,19.1)

"BLD",3804,"KRN","B",101,101)

"BLD",3804,"KRN","B",409.61,409.61)

"BLD",3804,"KRN","B",771,771)

"BLD",3804,"KRN","B",870,870)

"BLD",3804,"KRN","B",8989.51,8989.51)

"BLD",3804,"KRN","B",8989.52,8989.52)

"BLD",3804,"KRN","B",8994,8994)

"BLD",3804,"QUES",0)
^9.62^^
"BLD",3804,"REQB",0)
^9.611^1^1
"BLD",3804,"REQB",1,0)
GMTS*2.7*47^2
"BLD",3804,"REQB","B","GMTS*2.7*47",1)

"MBREQ")
0
"PKG",126,-1)
1^1
"PKG",126,0)
HEALTH SUMMARY^GMTS^Integrated Health Summary Tools^^^3010208
"PKG",126,20,0)
^9.402P^^
"PKG",126,22,0)
^9.49I^1^1
"PKG",126,22,1,0)
2.7^2951020^2951020^11
"PKG",126,22,1,"PAH",1,0)
59^3021126^1118
"PKG",126,22,1,"PAH",1,1,0)
^^2^2^3021126
"PKG",126,22,1,"PAH",1,1,1,0)
The description of this build is found in the National Patch Module under 
"PKG",126,22,1,"PAH",1,1,2,0)
patch GMTS*2.7*59.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
2
"RTN","GMTSLRB")
0^1^B2785063
"RTN","GMTSLRB",1,0)
GMTSLRB ; SLC/JER,KER - Blood Availability Component ; 11/26/2002
"RTN","GMTSLRB",2,0)
 ;;2.7;Health Summary;**17,47,59**;Oct 20, 1995
"RTN","GMTSLRB",3,0)
 ;                                      
"RTN","GMTSLRB",4,0)
 ; External References
"RTN","GMTSLRB",5,0)
 ;   DBIA   525  ^LR( all fields
"RTN","GMTSLRB",6,0)
 ;   DBIA  2056  $$GET1^DIQ (file 2)
"RTN","GMTSLRB",7,0)
 ;   DBIA  3177  AVUNIT^VBECA4()  Blood Bank Pkg
"RTN","GMTSLRB",8,0)
 ;                         
"RTN","GMTSLRB",9,0)
MAIN ; Blood Availability 
"RTN","GMTSLRB",10,0)
 N GMI,MAX,LRDFN,IX,X,LOC
"RTN","GMTSLRB",11,0)
 S MAX=$S(+($G(GMTSNDM))>0:+($G(GMTSNDM)),1:999),LOC="LRB"
"RTN","GMTSLRB",12,0)
 S LRDFN=$$GET1^DIQ(2,+($G(DFN)),63,"I") Q:+LRDFN=0!('$D(^LR(+LRDFN)))
"RTN","GMTSLRB",13,0)
 ;                 
"RTN","GMTSLRB",14,0)
 ; Get Available Units
"RTN","GMTSLRB",15,0)
 ;   Blood Bank Package  AVUNIT^VBECA4
"RTN","GMTSLRB",16,0)
 ;   Lab Package         ^GMTSLRBE    
"RTN","GMTSLRB",17,0)
 ;                 
"RTN","GMTSLRB",18,0)
 D:+($$ROK^GMTSU("VBECA4"))>0 AVUNIT^VBECA4(DFN,LOC,GMTS1,GMTS2,MAX)
"RTN","GMTSLRB",19,0)
 D:+($$ROK^GMTSU("VBECA4"))'>0 ^GMTSLRBE
"RTN","GMTSLRB",20,0)
 Q:'$D(^TMP("LRB",$J))
"RTN","GMTSLRB",21,0)
 D WRTBTYP
"RTN","GMTSLRB",22,0)
 S IX=0 F  S IX=$O(^TMP("LRB",$J,IX)) Q:IX=""  D
"RTN","GMTSLRB",23,0)
 . S X=^TMP("LRB",$J,IX) D WRT
"RTN","GMTSLRB",24,0)
 K ^TMP("LRB",$J)
"RTN","GMTSLRB",25,0)
 Q
"RTN","GMTSLRB",26,0)
WRTBTYP ; Writes Blood Type (Added 03/31/1994)
"RTN","GMTSLRB",27,0)
 D CKP^GMTSUP Q:$D(GMTSQIT)
"RTN","GMTSLRB",28,0)
 W ?1,"Patient Blood Type:",?22,$P(^TMP("LRB",$J,0),U,1)
"RTN","GMTSLRB",29,0)
 W ?25,$P(^TMP("LRB",$J,0),U,2),!!
"RTN","GMTSLRB",30,0)
 Q
"RTN","GMTSLRB",31,0)
WRT ; Writes Blood Availability Record
"RTN","GMTSLRB",32,0)
 D CKP^GMTSUP Q:$D(GMTSQIT)
"RTN","GMTSLRB",33,0)
 W $P(X,U),?2,$P(X,U,2),?11,$P(X,U,3),?22,$P(X,U,4)
"RTN","GMTSLRB",34,0)
 W ?62,$J($P(X,U,6),2),?65,$P(X,U,7),?69,$P(X,U,8),!
"RTN","GMTSLRB",35,0)
 D CKP^GMTSUP Q:$D(GMTSQIT)
"RTN","GMTSLRB",36,0)
 W ?6,"Unit Location:"
"RTN","GMTSLRB",37,0)
 W ?22,$S($L($P(X,U,10)):$P(X,U,10),1:"Blood Bank"),!
"RTN","GMTSLRB",38,0)
 D CKP^GMTSUP Q:$D(GMTSQIT)
"RTN","GMTSLRB",39,0)
 W ?6,"Unit Division:",?22,$P(X,U,9),!
"RTN","GMTSLRB",40,0)
 I $L($P(X,U,8)) D CKP^GMTSUP Q:$D(GMTSQIT)  D
"RTN","GMTSLRB",41,0)
 . W ?6,"Donation Type:",?22,$P(X,U,8),!
"RTN","GMTSLRB",42,0)
 Q
"RTN","GMTSLRT")
0^2^B4237640
"RTN","GMTSLRT",1,0)
GMTSLRT ; SLC/JER,KER - Blood Bank Transfusion       ; 11/26/2002
"RTN","GMTSLRT",2,0)
 ;;2.7;Health Summary;**28,47,59**;Oct 20, 1995
"RTN","GMTSLRT",3,0)
 ;                   
"RTN","GMTSLRT",4,0)
 ; External References
"RTN","GMTSLRT",5,0)
 ;   DBIA    525  ^LR( all fields
"RTN","GMTSLRT",6,0)
 ;   DBIA   2056  $$GET1^DIQ (file 2)
"RTN","GMTSLRT",7,0)
 ;   DBIA   3176  TRAN^VBECA4
"RTN","GMTSLRT",8,0)
 ;                   
"RTN","GMTSLRT",9,0)
MAIN ; Blood Transfusion
"RTN","GMTSLRT",10,0)
 N GMA,GMI,GMR,IX,MAX,A,R,TD,BPN,LOC
"RTN","GMTSLRT",11,0)
 S LOC="LRT",LRDFN=$$GET1^DIQ(2,+($G(DFN)),63,"I")
"RTN","GMTSLRT",12,0)
 ;                    
"RTN","GMTSLRT",13,0)
 ; Get Transfusion Records
"RTN","GMTSLRT",14,0)
 ;   Blood Bank Package  TRANS^VBECA4
"RTN","GMTSLRT",15,0)
 ;   Lab Package         ^GMTSLRTE
"RTN","GMTSLRT",16,0)
 ;                    
"RTN","GMTSLRT",17,0)
 D:+($$ROK^GMTSU("VBECA4"))>0 TRAN^VBECA4(DFN,LOC,GMTS1,GMTS2)
"RTN","GMTSLRT",18,0)
 D:+($$ROK^GMTSU("VBECA4"))'>0 ^GMTSLRTE
"RTN","GMTSLRT",19,0)
 Q:'$D(^TMP("LRT",$J))
"RTN","GMTSLRT",20,0)
 S MAX=$S(+($G(GMTSNDM))>0:+($G(GMTSNDM)),1:999),IX=GMTS1
"RTN","GMTSLRT",21,0)
 F GMI=1:1:MAX S IX=$O(^TMP("LRT",$J,IX)) Q:IX=""!(IX>GMTS2)  D
"RTN","GMTSLRT",22,0)
 . S GMR=^TMP("LRT",$J,IX) D PRSREC,WRT
"RTN","GMTSLRT",23,0)
 I $O(^TMP("LRT",$J,"A"))'="" D
"RTN","GMTSLRT",24,0)
 . D CKP^GMTSUP Q:$D(GMTSQIT)  W !
"RTN","GMTSLRT",25,0)
 . D CKP^GMTSUP Q:$D(GMTSQIT)  W " Blood Product Key: "
"RTN","GMTSLRT",26,0)
 S GMI="A" F  S GMI=$O(^TMP("LRT",$J,GMI)) Q:GMI=""  D
"RTN","GMTSLRT",27,0)
 . D CKP^GMTSUP Q:$D(GMTSQIT)
"RTN","GMTSLRT",28,0)
 . W ?21,GMI," = ",$G(^TMP("LRT",$J,GMI)),!
"RTN","GMTSLRT",29,0)
 K ^TMP("LRT",$J)
"RTN","GMTSLRT",30,0)
 Q
"RTN","GMTSLRT",31,0)
PRSREC ; Parses Record for presentation
"RTN","GMTSLRT",32,0)
 N GMI,X S X=$P(GMR,U) D REGDT4^GMTSU S TD=X
"RTN","GMTSLRT",33,0)
 S GMA(1)=$P(GMR,U,2),BPN=$L(GMA(1),";")
"RTN","GMTSLRT",34,0)
 I $P(GMA(1),";",BPN)="" S BPN=BPN-1
"RTN","GMTSLRT",35,0)
 F GMI=2:1:BPN S GMA(GMI)="("_$P($P(GMA(1),";",GMI),"\")_") "_$P($P(GMA(1),";",GMI),"\",2)
"RTN","GMTSLRT",36,0)
 S GMA(1)="("_$P($P(GMA(1),";",1),"\")_") "_$P($P(GMA(1),";",1),"\",2)
"RTN","GMTSLRT",37,0)
 Q
"RTN","GMTSLRT",38,0)
WRT ; Writes the Transfusion Record for each day
"RTN","GMTSLRT",39,0)
 N GML,GMI1,GMI2,GMM,GMJ S GMM=$S(BPN#4:1,1:0),GML=BPN\4+GMM
"RTN","GMTSLRT",40,0)
 D CKP^GMTSUP Q:$D(GMTSQIT)  W TD
"RTN","GMTSLRT",41,0)
 F GMI1=1:1:GML D  Q:$D(GMTSQIT)
"RTN","GMTSLRT",42,0)
 . F GMI2=1:1:($S((GMI1=GML)&(BPN#4):BPN#4,1:4)) D  Q:$D(GMTSQIT)
"RTN","GMTSLRT",43,0)
 . . S GMJ=((GMI1-1)*4)+GMI2 D CKP^GMTSUP Q:$D(GMTSQIT)
"RTN","GMTSLRT",44,0)
 . . W ?(((GMI2-1)*15)+10),GMA(GMJ)
"RTN","GMTSLRT",45,0)
 . . I $S(GMI2#4=0:1,GMI2=BPN:1,GMI2+(4*(GMI1-1))=BPN:1,1:0) W !
"RTN","GMTSLRT",46,0)
 Q
"VER")
8.0^22.0
**END**
**END**
