Released RA*5*54 SEQ #48
Extracted from mail message
**KIDS**:RA*5.0*54^

**INSTALL NAME**
RA*5.0*54
"BLD",5923,0)
RA*5.0*54^RADIOLOGY/NUCLEAR MEDICINE^0^3050203^y
"BLD",5923,1,0)
^^7^7^3041217^
"BLD",5923,1,1,0)
This patch address two problems:
"BLD",5923,1,2,0)
1)      A RAD/NUC MED PROCEDURE MESSAGE file (#71.4) entry may be edited 
"BLD",5923,1,3,0)
by more than one user at a time with the option Procedure Message 
"BLD",5923,1,4,0)
Entry/Edit [RA PROCMSGEDIT].
"BLD",5923,1,5,0)
2)      The menu option Resend Radiology HL7 Message [RA HL7 MESSAGE 
"BLD",5923,1,6,0)
RESEND] communication is missing the 'exam registered' HL7 messages in 
"BLD",5923,1,7,0)
subsequent cases after the first case.
"BLD",5923,4,0)
^9.64PA^^
"BLD",5923,"KRN",0)
^9.67PA^8989.52^19
"BLD",5923,"KRN",.4,0)
.4
"BLD",5923,"KRN",.401,0)
.401
"BLD",5923,"KRN",.402,0)
.402
"BLD",5923,"KRN",.403,0)
.403
"BLD",5923,"KRN",.5,0)
.5
"BLD",5923,"KRN",.84,0)
.84
"BLD",5923,"KRN",3.6,0)
3.6
"BLD",5923,"KRN",3.8,0)
3.8
"BLD",5923,"KRN",9.2,0)
9.2
"BLD",5923,"KRN",9.8,0)
9.8
"BLD",5923,"KRN",9.8,"NM",0)
^9.68A^3^3
"BLD",5923,"KRN",9.8,"NM",1,0)
RAMAIN^^0^B33148002
"BLD",5923,"KRN",9.8,"NM",2,0)
RAHLRS^^0^B10763501
"BLD",5923,"KRN",9.8,"NM",3,0)
RAHLRPC^^0^B6387845
"BLD",5923,"KRN",9.8,"NM","B","RAHLRPC",3)

"BLD",5923,"KRN",9.8,"NM","B","RAHLRS",2)

"BLD",5923,"KRN",9.8,"NM","B","RAMAIN",1)

"BLD",5923,"KRN",19,0)
19
"BLD",5923,"KRN",19.1,0)
19.1
"BLD",5923,"KRN",101,0)
101
"BLD",5923,"KRN",409.61,0)
409.61
"BLD",5923,"KRN",771,0)
771
"BLD",5923,"KRN",870,0)
870
"BLD",5923,"KRN",8989.51,0)
8989.51
"BLD",5923,"KRN",8989.52,0)
8989.52
"BLD",5923,"KRN",8994,0)
8994
"BLD",5923,"KRN","B",.4,.4)

"BLD",5923,"KRN","B",.401,.401)

"BLD",5923,"KRN","B",.402,.402)

"BLD",5923,"KRN","B",.403,.403)

"BLD",5923,"KRN","B",.5,.5)

"BLD",5923,"KRN","B",.84,.84)

"BLD",5923,"KRN","B",3.6,3.6)

"BLD",5923,"KRN","B",3.8,3.8)

"BLD",5923,"KRN","B",9.2,9.2)

"BLD",5923,"KRN","B",9.8,9.8)

"BLD",5923,"KRN","B",19,19)

"BLD",5923,"KRN","B",19.1,19.1)

"BLD",5923,"KRN","B",101,101)

"BLD",5923,"KRN","B",409.61,409.61)

"BLD",5923,"KRN","B",771,771)

"BLD",5923,"KRN","B",870,870)

"BLD",5923,"KRN","B",8989.51,8989.51)

"BLD",5923,"KRN","B",8989.52,8989.52)

"BLD",5923,"KRN","B",8994,8994)

"BLD",5923,"QUES",0)
^9.62^^
"BLD",5923,"REQB",0)
^9.611^2^2
"BLD",5923,"REQB",1,0)
RA*5.0*25^1
"BLD",5923,"REQB",2,0)
RA*5.0*50^1
"BLD",5923,"REQB","B","RA*5.0*25",1)

"BLD",5923,"REQB","B","RA*5.0*50",2)

"MBREQ")
0
"PKG",31,-1)
1^1
"PKG",31,0)
RADIOLOGY/NUCLEAR MEDICINE^RA^REGISTERS PATIENTS,RECORDS EXAMS,PROFILES,AMIS REPORTS
"PKG",31,22,0)
^9.49I^1^1
"PKG",31,22,1,0)
5.0^2980317^2981117^66481
"PKG",31,22,1,"PAH",1,0)
54^3050203^123456966
"PKG",31,22,1,"PAH",1,1,0)
^^7^7^3050203
"PKG",31,22,1,"PAH",1,1,1,0)
This patch address two problems:
"PKG",31,22,1,"PAH",1,1,2,0)
1)      A RAD/NUC MED PROCEDURE MESSAGE file (#71.4) entry may be edited 
"PKG",31,22,1,"PAH",1,1,3,0)
by more than one user at a time with the option Procedure Message 
"PKG",31,22,1,"PAH",1,1,4,0)
Entry/Edit [RA PROCMSGEDIT].
"PKG",31,22,1,"PAH",1,1,5,0)
2)      The menu option Resend Radiology HL7 Message [RA HL7 MESSAGE 
"PKG",31,22,1,"PAH",1,1,6,0)
RESEND] communication is missing the 'exam registered' HL7 messages in 
"PKG",31,22,1,"PAH",1,1,7,0)
subsequent cases after the first case.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
3
"RTN","RAHLRPC")
0^3^B6387845
"RTN","RAHLRPC",1,0)
RAHLRPC ;HIRMFO/BNT-Rad/NM HL7 Protocol calls ;05/21/99   14:50
"RTN","RAHLRPC",2,0)
 ;;5.0;Radiology/Nuclear Medicine;**12,25,54**;Mar 16, 1998
"RTN","RAHLRPC",3,0)
REG ; register exam
"RTN","RAHLRPC",4,0)
 N X,RAPID,RAEID
"RTN","RAHLRPC",5,0)
 S RAPID="RA REF" ; get all protocols beginning RA REG
"RTN","RAHLRPC",6,0)
 F  S RAPID=$O(^ORD(101,"B",RAPID)) Q:RAPID'["RA REG"  D
"RTN","RAHLRPC",7,0)
 .S RAEID=$O(^ORD(101,"B",RAPID,0))
"RTN","RAHLRPC",8,0)
 .D:RAEID EN^RAHLR
"RTN","RAHLRPC",9,0)
 Q
"RTN","RAHLRPC",10,0)
CANCEL ; cancel exam
"RTN","RAHLRPC",11,0)
 N X,RAPID,RAEID
"RTN","RAHLRPC",12,0)
 S RAPID="RA CANCEK" ; get all protocols beginning RA CANCEL
"RTN","RAHLRPC",13,0)
 F  S RAPID=$O(^ORD(101,"B",RAPID)) Q:RAPID'["RA CANCEL"  D
"RTN","RAHLRPC",14,0)
 .S RAEID=$O(^ORD(101,"B",RAPID,0))
"RTN","RAHLRPC",15,0)
 .D:RAEID EN^RAHLR
"RTN","RAHLRPC",16,0)
 Q
"RTN","RAHLRPC",17,0)
RPT ; report verified or released/not verified
"RTN","RAHLRPC",18,0)
 N X,RAPID,RAEID
"RTN","RAHLRPC",19,0)
 S RAPID="RA RPS" ; get all protocols beginning RA RPT
"RTN","RAHLRPC",20,0)
 F  S RAPID=$O(^ORD(101,"B",RAPID)) Q:RAPID'["RA RPT"  D
"RTN","RAHLRPC",21,0)
 .S RAEID=$O(^ORD(101,"B",RAPID,0))
"RTN","RAHLRPC",22,0)
 .D:RAEID EN^RAHLRPT
"RTN","RAHLRPC",23,0)
 Q
"RTN","RAHLRPC",24,0)
EXM ; examined case
"RTN","RAHLRPC",25,0)
 ;Called from RAUTL1 and RASTED after a case's status is upgraded
"RTN","RAHLRPC",26,0)
 ; and case's 30th piece is null
"RTN","RAHLRPC",27,0)
 ;
"RTN","RAHLRPC",28,0)
 ;If this new status is :
"RTN","RAHLRPC",29,0)
 ; at a status (or higher than a status) where
"RTN","RAHLRPC",30,0)
 ; GENERATE EXAMINED HL7 MSG = Y,
"RTN","RAHLRPC",31,0)
 ; then :
"RTN","RAHLRPC",32,0)
 ; 1. send an HL7 msg re this case having reached EXAMINED status
"RTN","RAHLRPC",33,0)
 ; 2. set subfile 70.03's HL7 EXAMINED MSG SENT  to  Y
"RTN","RAHLRPC",34,0)
 ;
"RTN","RAHLRPC",35,0)
 ; RALOWER = next lower status
"RTN","RAHLRPC",36,0)
 ; RANEWST = new status ien
"RTN","RAHLRPC",37,0)
 ; 
"RTN","RAHLRPC",38,0)
 N RAIMGTYI,RAIMGTYJ,RALOWER,RANEWST,RAEXMDUN,RAGENHL7
"RTN","RAHLRPC",39,0)
 S RAIMGTYI=$P($G(^RADPT(RADFN,"DT",RADTI,0)),U,2),RAIMGTYJ=$P(^RA(79.2,RAIMGTYI,0),U),RANEWST=$P($G(^RADPT(RADFN,"DT",RADTI,"P",RACNI,0)),U,3)
"RTN","RAHLRPC",40,0)
 Q:$P(^RADPT(RADFN,"DT",RADTI,"P",RACNI,0),U,30)="Y"  ;already sent
"RTN","RAHLRPC",41,0)
 G:$P(^RA(72,RANEWST,0),U,8)="Y" 1 ;this status has GEN HL7 marked Y
"RTN","RAHLRPC",42,0)
 ; look thru lower statuses for GEN HL7 marked Y
"RTN","RAHLRPC",43,0)
DOWN S RALOWER=$P($G(^RA(72,+RANEWST,0)),U,3)
"RTN","RAHLRPC",44,0)
 F  S RALOWER=$O(^RA(72,"AA",RAIMGTYJ,RALOWER),-1) Q:RALOWER<1  S:$P(^RA(72,+$O(^RA(72,"AA",RAIMGTYJ,RALOWER,0)),0),U,8)="Y" RAGENHL7=1
"RTN","RAHLRPC",45,0)
 ;
"RTN","RAHLRPC",46,0)
 Q:'$G(RAGENHL7)  ;none of the lower status levels have GEN HL7 marked Y
"RTN","RAHLRPC",47,0)
1 S RAEXMDUN=1
"RTN","RAHLRPC",48,0)
A1 N X,RAPID,RAEID ;*54 called from RAHLRS
"RTN","RAHLRPC",49,0)
 S RAPID="RA EXAMINEC" ; get all protocols beginning RA EXAMINED
"RTN","RAHLRPC",50,0)
 F  S RAPID=$O(^ORD(101,"B",RAPID)) Q:RAPID'["RA EXAMINED"  D
"RTN","RAHLRPC",51,0)
 .S RAEID=$O(^ORD(101,"B",RAPID,0))
"RTN","RAHLRPC",52,0)
 .D:RAEID EN^RAHLR
"RTN","RAHLRPC",53,0)
2 S $P(^RADPT(RADFN,"DT",RADTI,"P",RACNI,0),U,30)="Y"
"RTN","RAHLRPC",54,0)
 Q
"RTN","RAHLRS")
0^2^B10763501
"RTN","RAHLRS",1,0)
RAHLRS ;HIRMFO/CRT/PDW - Resend HL7 messages for selected cases ;Mar 16, 1998
"RTN","RAHLRS",2,0)
 ;;5.0;Radiology/Nuclear Medicine;**25,54**;Mar 16, 1998
"RTN","RAHLRS",3,0)
 ;
"RTN","RAHLRS",4,0)
 ; Utility to RESEND HL7 messages
"RTN","RAHLRS",5,0)
 ;
"RTN","RAHLRS",6,0)
 N RACNI,RADFN,RADTI,RARPT,X
"RTN","RAHLRS",7,0)
 ;
"RTN","RAHLRS",8,0)
 D SETVARS Q:$G(RAIMGTY)=""
"RTN","RAHLRS",9,0)
 ;
"RTN","RAHLRS",10,0)
 F  S X=$$RACNLU(.RADFN,.RADTI,.RACNI) Q:+X'>0  D  Q:QUIT<0
"RTN","RAHLRS",11,0)
 .D RESEND(RADFN,RADTI,RACNI,.QUIT)
"RTN","RAHLRS",12,0)
 Q
"RTN","RAHLRS",13,0)
 ;
"RTN","RAHLRS",14,0)
RACNLU(RADFN,RADTI,RACNI) ; Select Case Number
"RTN","RAHLRS",15,0)
 ;
"RTN","RAHLRS",16,0)
 N RANOSCRN S RANOSCRN="" ; Don't limit cases to current Imaging Type
"RTN","RAHLRS",17,0)
 S (RADFN,RADTI,RADFN)=""
"RTN","RAHLRS",18,0)
 D ^RACNLU
"RTN","RAHLRS",19,0)
 Q X
"RTN","RAHLRS",20,0)
 ;
"RTN","RAHLRS",21,0)
RESEND(RADFN,RADTI,RACNI,QUIT) ; re-send exam message(s) to HL7 subscribers
"RTN","RAHLRS",22,0)
 ;
"RTN","RAHLRS",23,0)
 N RAED
"RTN","RAHLRS",24,0)
 ;
"RTN","RAHLRS",25,0)
 S QUIT=0
"RTN","RAHLRS",26,0)
 I '$D(DT) D ^%DT S DT=Y
"RTN","RAHLRS",27,0)
 ;
"RTN","RAHLRS",28,0)
 S RAED=$$RAED(RADFN,RADTI,RACNI)
"RTN","RAHLRS",29,0)
 S QUIT=$$OK(RADFN,RADTI,RACNI)
"RTN","RAHLRS",30,0)
 I QUIT>0 D
"RTN","RAHLRS",31,0)
 .I RAED[",REG," D
"RTN","RAHLRS",32,0)
 ..D EN^DDIOL("Re-sending 'EXAM REGISTERD' HL7 message...",,"!!,?6")
"RTN","RAHLRS",33,0)
 ..D REG^RAHLRPC
"RTN","RAHLRS",34,0)
 .I RAED[",CANCEL," D
"RTN","RAHLRS",35,0)
 ..D EN^DDIOL("Re-sending 'EXAM CANCELLED' HL7 message...",,"!,?6")
"RTN","RAHLRS",36,0)
 ..D CANCEL^RAHLRPC
"RTN","RAHLRS",37,0)
 .I RAED[",EXAM," D
"RTN","RAHLRS",38,0)
 ..S $P(^RADPT(RADFN,"DT",RADTI,"P",RACNI,0),"^",30)="" ;Reset sent flag
"RTN","RAHLRS",39,0)
 ..D EN^DDIOL("Re-sending 'EXAMINED' HL7 message...",,"!,?6")
"RTN","RAHLRS",40,0)
 ..D A1^RAHLRPC ;*54
"RTN","RAHLRS",41,0)
 .I RAED[",RPT," D
"RTN","RAHLRS",42,0)
 ..D EN^DDIOL("Re-sending 'REPORT VERIFIED' HL7 message...",,"!,?6")
"RTN","RAHLRS",43,0)
 ..D RPT^RAHLRPC
"RTN","RAHLRS",44,0)
 Q
"RTN","RAHLRS",45,0)
 ;
"RTN","RAHLRS",46,0)
RAED(RADFN,RADTI,RACNI) ; identify correct ^RAHLRPC entry point(s)
"RTN","RAHLRS",47,0)
 ;
"RTN","RAHLRS",48,0)
 N RASTAT,RAIMTYP,RAORD,RETURN,RARPST
"RTN","RAHLRS",49,0)
 S (RARPST,RASTAT)=""
"RTN","RAHLRS",50,0)
 ;
"RTN","RAHLRS",51,0)
 S RETURN=",REG,"
"RTN","RAHLRS",52,0)
 ;
"RTN","RAHLRS",53,0)
 S RASTAT=$$GET1^DIQ(70.03,RACNI_","_RADTI_","_RADFN,3,"I")
"RTN","RAHLRS",54,0)
 ;
"RTN","RAHLRS",55,0)
 S RAIMTYP=$$GET1^DIQ(72,+RASTAT,7)
"RTN","RAHLRS",56,0)
 S RAORD=$$GET1^DIQ(72,+RASTAT,3)
"RTN","RAHLRS",57,0)
 ;
"RTN","RAHLRS",58,0)
 S:RAORD=0 RETURN=RETURN_"CANCEL,"
"RTN","RAHLRS",59,0)
 ;
"RTN","RAHLRS",60,0)
 I $$GET1^DIQ(72,+RASTAT,8)="YES" D  ; Generate Examined HL7 Message
"RTN","RAHLRS",61,0)
 .S RETURN=RETURN_"EXAM,"
"RTN","RAHLRS",62,0)
 ;
"RTN","RAHLRS",63,0)
 I RETURN'[",EXAM," D
"RTN","RAHLRS",64,0)
 .; also check previous statuses for 'Generate Examined HL7 Message'
"RTN","RAHLRS",65,0)
 .F  S RAORD=$O(^RA(72,"AA",RAIMTYP,RAORD),-1) Q:+RAORD<1  D  Q:RETURN[",EXAM,"
"RTN","RAHLRS",66,0)
 ..S RASTAT=$O(^RA(72,"AA",RAIMTYP,RAORD,0))
"RTN","RAHLRS",67,0)
 ..I $$GET1^DIQ(72,+RASTAT,8)="YES" S RETURN=RETURN_"EXAM,"
"RTN","RAHLRS",68,0)
 ;
"RTN","RAHLRS",69,0)
 I RARPT]"" D  ; Check if Verified Report exists
"RTN","RAHLRS",70,0)
 .S RARPST=$$GET1^DIQ(74,RARPT,5,"I")
"RTN","RAHLRS",71,0)
 .I RARPST="V" S RETURN=RETURN_"RPT,"
"RTN","RAHLRS",72,0)
 ;
"RTN","RAHLRS",73,0)
 Q RETURN
"RTN","RAHLRS",74,0)
 ;
"RTN","RAHLRS",75,0)
OK(RADFN,RADTI,RACNI) ; Get User to confirm continue
"RTN","RAHLRS",76,0)
 ;
"RTN","RAHLRS",77,0)
 N X,RAEXST
"RTN","RAHLRS",78,0)
 ;
"RTN","RAHLRS",79,0)
 S RAEXST=$$GET1^DIQ(70.03,RACNI_","_RADTI_","_RADFN,3)
"RTN","RAHLRS",80,0)
 ;
"RTN","RAHLRS",81,0)
 S X="",$P(X,"=",70)=""
"RTN","RAHLRS",82,0)
 D EN^DDIOL(X,"","!?5")
"RTN","RAHLRS",83,0)
 S DIR("A")="Re-send all HL7 messages for this '"_RAEXST_"' case?"
"RTN","RAHLRS",84,0)
 S DIR(0)="Y",DIR("B")="YES" D ^DIR
"RTN","RAHLRS",85,0)
 I Y="^" Q -1
"RTN","RAHLRS",86,0)
 Q Y
"RTN","RAHLRS",87,0)
 ;
"RTN","RAHLRS",88,0)
SETVARS ; Setup key Rad/Nuc Med variables
"RTN","RAHLRS",89,0)
 ;
"RTN","RAHLRS",90,0)
 I $O(RACCESS(DUZ,""))="" D SETVARS^RAPSET1(0)
"RTN","RAHLRS",91,0)
 Q:'($D(RACCESS(DUZ))\10)  ; user does not have location access
"RTN","RAHLRS",92,0)
 I $G(RAIMGTY)="" D SETVARS^RAPSET1(1) K:$G(RAIMGTY)="" XQUIT
"RTN","RAHLRS",93,0)
 Q
"RTN","RAMAIN")
0^1^B33148002
"RTN","RAMAIN",1,0)
RAMAIN ;HISC/FPT,GJC,CAH AISC/MJK,RMO;VMP/PW-Utility File Maintenance ;7/24/02  14:45
"RTN","RAMAIN",2,0)
 ;;5.0;Radiology/Nuclear Medicine;**31,43,50,54**;Mar 16, 1998
"RTN","RAMAIN",3,0)
 ;
"RTN","RAMAIN",4,0)
3 ;;Major AMIS Code Enter/Edit
"RTN","RAMAIN",5,0)
 N RAI F RAI=1:1:5 W !?9,$P($T(REMIND+RAI),";;",2)
"RTN","RAMAIN",6,0)
 S DIR(0)="Y",DIR("B")="No"
"RTN","RAMAIN",7,0)
 S DIR("A")="          add/change any AMIS codes and weight"
"RTN","RAMAIN",8,0)
 S DIR("A",1)="          Do you have approval from Radiology Service VACO to"
"RTN","RAMAIN",9,0)
 D ^DIR K DIR Q:$D(DIRUT)  Q:'Y
"RTN","RAMAIN",10,0)
L3 S DIC="^RAMIS(71.1,",DIC(0)="AEMQ" W ! D ^DIC K DIC I Y<0 K D,X,Y,DDH,I,POP,DISYS Q
"RTN","RAMAIN",11,0)
 S DA=+Y,DIE="^RAMIS(71.1,",DR=".01;2" D ^DIE K %,%W,%Y,D0,DA,DE,DQ,DIE,DR,DI,I,POP G L3
"RTN","RAMAIN",12,0)
REMIND ;;
"RTN","RAMAIN",13,0)
 ;;+----------------------------------------------------------+
"RTN","RAMAIN",14,0)
 ;;| New entries and modifications to existing entries are    |
"RTN","RAMAIN",15,0)
 ;;| prohibited without approval from Radiology Service VACO. |
"RTN","RAMAIN",16,0)
 ;;+----------------------------------------------------------+
"RTN","RAMAIN",17,0)
 ;
"RTN","RAMAIN",18,0)
4 ;;Film Type Enter/Edit
"RTN","RAMAIN",19,0)
 K DD,DIC,DLAYGO,DO
"RTN","RAMAIN",20,0)
 S DIC="^RA(78.4,",DIC(0)="AEMQL",DLAYGO=78.4 W ! D ^DIC
"RTN","RAMAIN",21,0)
 K DD,DIC,DLAYGO,DO
"RTN","RAMAIN",22,0)
 I +Y<0 D  D Q4 Q
"RTN","RAMAIN",23,0)
 . D DSPLNKS^RAMAIN1
"RTN","RAMAIN",24,0)
 . K D,DI,X,Y
"RTN","RAMAIN",25,0)
 . Q
"RTN","RAMAIN",26,0)
 S DA=+Y,DIE="^RA(78.4,",DR=".01;2;3;4;5;S:+X'=1 Y=""@1"";6;@1"
"RTN","RAMAIN",27,0)
 D ^DIE S RA784=$G(^RA(78.4,DA,0)),RA784(1)=$P(RA784,U)
"RTN","RAMAIN",28,0)
 S RA784(5)=+$P(RA784,U,4),RA784(6)=$P(RA784,U,5)
"RTN","RAMAIN",29,0)
 I RA784(5),(RA784(6)']"") D
"RTN","RAMAIN",30,0)
 . N DIE,DR
"RTN","RAMAIN",31,0)
 . W !!?5,$C(7),"'"_RA784(1)_"' has been defined as a wasted film size."
"RTN","RAMAIN",32,0)
 . W !?5,"If a particular film size is deemed as a wasted piece of"
"RTN","RAMAIN",33,0)
 . W !?5,"film, the wasted piece of film must be associated with an"
"RTN","RAMAIN",34,0)
 . W !?5,"unwasted piece of film."
"RTN","RAMAIN",35,0)
 . W !!?5,"Redefining '"_RA784(1)_"' as an unwasted film size."
"RTN","RAMAIN",36,0)
 . S DIE="^RA(78.4,",DR="5///@" D ^DIE W "   Done!"
"RTN","RAMAIN",37,0)
 . Q
"RTN","RAMAIN",38,0)
 K %,D0,DA,DE,DQ,DIE,DR,RA784,X,Y G 4
"RTN","RAMAIN",39,0)
Q4 K I,POP,DISYS,DDH
"RTN","RAMAIN",40,0)
 Q
"RTN","RAMAIN",41,0)
 ;
"RTN","RAMAIN",42,0)
5 ;;Diagnostic Code Enter/Edit
"RTN","RAMAIN",43,0)
 S DIC="^RA(78.3,",DIC(0)="AEMQL",DLAYGO=78.3 W ! D ^DIC K DIC,DLAYGO I Y<0 K D,X,Y,POP,I Q
"RTN","RAMAIN",44,0)
 S DA=+Y,DIE="^RA(78.3,",DR="2:5" D ^DIE K %,D0,DA,DE,DQ,DIE,DR,I,DI G 5
"RTN","RAMAIN",45,0)
 ;
"RTN","RAMAIN",46,0)
6 ;;Flash Card/Label Formatter
"RTN","RAMAIN",47,0)
 W:'$D(RAFLH) !!?5,">>> Exam Label/Report Header/Report Footer/Flash Card Formatter <<<"
"RTN","RAMAIN",48,0)
 S DIC="^RA(78.2,",DIC(0)="AEMQL",DLAYGO=78.2 W ! D ^DIC K DIC,DLAYGO G Q6:Y<0 S (RAFLH,DA)=+Y,DIE="^RA(78.2,",DR="[RA FLASH CARD EDIT]" D ^DIE K DE,DQ,DIE,DR I '$D(^RA(78.2,RAFLH,0)) G Q6
"RTN","RAMAIN",49,0)
 S RAFMT=RAFLH,RAK=0
"RTN","RAMAIN",50,0)
 F  S RAK=$O(^RA(78.7,RAK)) Q:RAK'>0  D SETFLH^RAFLH2(RAK)
"RTN","RAMAIN",51,0)
 D CMP^RAFLH1
"RTN","RAMAIN",52,0)
 W !!,"<<<<<<----------------------------Column No.------------------------------>>>>>>"
"RTN","RAMAIN",53,0)
 W !!,"0--------1---------2---------3---------4---------5---------6---------7---------8"
"RTN","RAMAIN",54,0)
 W !,"1        0         0         0         0         0         0         0         0",! S RATEST="",RANUM=1,RAFFLF="!" D PRT^RAFLH K RAFFLF W !! G 6
"RTN","RAMAIN",55,0)
Q6 S RAK=0 F  S RAK=$O(^RA(78.7,RAK)) Q:RAK'>0  D KILFLH^RAFLH2(RAK)
"RTN","RAMAIN",56,0)
 K %,%W,%X,%Y,D,D0,D1,DA,FL,RA787,RATEST,RAII,RAK,RAFLH,RAFMT,RANUM,X,Y
"RTN","RAMAIN",57,0)
 K POP,I,DDH,DUOUT,DI,DISYS
"RTN","RAMAIN",58,0)
 Q
"RTN","RAMAIN",59,0)
 ;
"RTN","RAMAIN",60,0)
7 ;;Complication Type Enter/Edit
"RTN","RAMAIN",61,0)
 S DIC="^RA(78.1,",DIC(0)="AEMQL",DLAYGO=78.1 W ! D ^DIC K DIC,DLAYGO I Y<0 K D,X,Y G Q7
"RTN","RAMAIN",62,0)
 S DA=+Y,DIE="^RA(78.1,",DR=".01;2" D ^DIE K %,D,D0,DA,DE,DQ,DIE,DR D Q7 G 7
"RTN","RAMAIN",63,0)
Q7 K DI,DISYS,I,POP Q
"RTN","RAMAIN",64,0)
 ;
"RTN","RAMAIN",65,0)
8 ;;Sharing/Contract Agreement Entry/Edit
"RTN","RAMAIN",66,0)
 S DIC="^DIC(34,",DIC(0)="AELMQ",DIC("A")="Select Agreement/Contract: ",DLAYGO=34 W ! D ^DIC K DIC,DLAYGO I Y<0 K D,X,Y,I,POP Q
"RTN","RAMAIN",67,0)
 S DA=+Y,DIE="^DIC(34,",DR=".01:3" D ^DIE K %,%W,%X,%Y,D,D0,DA,DE,DQ,DIE,DR,X,Y,DI,DISYS G 8
"RTN","RAMAIN",68,0)
 ;
"RTN","RAMAIN",69,0)
9 ;;Standard Reports
"RTN","RAMAIN",70,0)
 S DIC="^RA(74.1,",DIC(0)="AEMQL",DLAYGO=74.1 W ! D ^DIC K DIC,DLAYGO I Y<0 K D,X,Y D Q9 Q
"RTN","RAMAIN",71,0)
 S DA=+Y,DIE="^RA(74.1,",DR="[RA STANDARD REPORT ENTRY]" D ^DIE K %,%W,%X,%Y,C,D,D0,DA,DE,DQ,DIE,DR,X,Y D Q9 G 9
"RTN","RAMAIN",72,0)
Q9 K DDH,DI,DISYS,I,J,POP
"RTN","RAMAIN",73,0)
 Q
"RTN","RAMAIN",74,0)
 ;
"RTN","RAMAIN",75,0)
10 ;;Procedure Modifiers Entry
"RTN","RAMAIN",76,0)
 K DD,DO,DLAYGO,DIC,DA,DINUM,X,Y
"RTN","RAMAIN",77,0)
 S (DIC,DLAYGO)="^RAMIS(71.2,",DIC(0)="AEMQL"
"RTN","RAMAIN",78,0)
 S DIC("A")="Select Procedure Modifier: ",DIC("W")="D PROHLP^RAMAIN"
"RTN","RAMAIN",79,0)
 W ! D ^DIC K DIC,DLAYGO I +Y'>0 K D,X,Y,POP,I,DDH,DG,DISYS,DUOUT Q
"RTN","RAMAIN",80,0)
 S DIE="^RAMIS(71.2,",DA=+Y,DR="3;4" D ^DIE
"RTN","RAMAIN",81,0)
 K %W,%X,%Y,D,DIE,DO,DD,DLAYGO,DA,DR,X,Y,POP,I,D0,DI,DISYS,DQ,C G 10
"RTN","RAMAIN",82,0)
 ;
"RTN","RAMAIN",83,0)
11 ;;Reports Distribution Edit
"RTN","RAMAIN",84,0)
 S DIC="^RABTCH(74.3,",DIC(0)="AEMQ" W ! D ^DIC K DIC I Y<0 K D,X,Y,I,POP Q
"RTN","RAMAIN",85,0)
 S DA=+Y,DIE="^RABTCH(74.3,",DR="[RA DISTRIBUTION EDIT]" D ^DIE K %,%W,%X,%Y,D,D0,DA,DE,DQ,DIE,DR,X,Y,DI,DISYS,I,POP G 11
"RTN","RAMAIN",86,0)
 ;
"RTN","RAMAIN",87,0)
12 ;;Rad/Nuc Med Procedure Message Enter/Edit
"RTN","RAMAIN",88,0)
 S DIC="^RAMIS(71.4,",DIC(0)="AELMQ",DLAYGO=71.4
"RTN","RAMAIN",89,0)
 W ! D ^DIC K DIC,DLAYGO I Y<0 K D,DTOUT,DUOUT,X,Y Q
"RTN","RAMAIN",90,0)
 S DA=+Y
"RTN","RAMAIN",91,0)
 L +^RAMIS(71.4,DA):3 I '$T D  G 12 ;*54
"RTN","RAMAIN",92,0)
 . K DIR S DIR(0)="EA",DIR("A")="Sorry, someone else is editing that entry. <cr> - continue " D ^DIR K DIR
"RTN","RAMAIN",93,0)
 K RAMLNA,RAMLNB S RAMSGDA=DA ;*50
"RTN","RAMAIN",94,0)
 S RAMLNA=$G(^RAMIS(71.4,DA,0)) ;*50
"RTN","RAMAIN",95,0)
 S DIE="^RAMIS(71.4,",DR=.01 D ^DIE
"RTN","RAMAIN",96,0)
 S RAMLNB=$G(^RAMIS(71.4,+$G(DA),0)) ;*50
"RTN","RAMAIN",97,0)
 I RAMLNB'=RAMLNA S DA=RAMSGDA D ORDITMS^RAMAIN3 ;*50
"RTN","RAMAIN",98,0)
 L -^RAMIS(71.4,RAMSGDA) ;*54
"RTN","RAMAIN",99,0)
 K %,%W,%X,%Y,D0,DA,DE,DQ,DR,DIE,X,Y,RAMLNA,RAMLNB,RAMSGDA
"RTN","RAMAIN",100,0)
 G 12
"RTN","RAMAIN",101,0)
 ;
"RTN","RAMAIN",102,0)
13 ;;Cost of Procedure Enter/Edit
"RTN","RAMAIN",103,0)
 I '$D(RACCESS(DUZ)) D SET^RAPSET1 I $D(XQUIT) K RACCESS,XQUIT Q
"RTN","RAMAIN",104,0)
 ; ask img type
"RTN","RAMAIN",105,0)
 K ^TMP($J,"RA I-TYPE") D SELIMG^RAUTL7 G:$G(RAQUIT) 139
"RTN","RAMAIN",106,0)
 N RA0,RA1,RA2 S RA0="",RA2=""
"RTN","RAMAIN",107,0)
131 S RA0=$O(^TMP($J,"RA I-TYPE",RA0)) G:RA0="" 133
"RTN","RAMAIN",108,0)
132 S RA1=$O(^TMP($J,"RA I-TYPE",RA0,0)) G:'RA1 131
"RTN","RAMAIN",109,0)
 S RA2=RA1_U_RA2 G 131
"RTN","RAMAIN",110,0)
133 G:RA2="" 139 S DIC="^RAMIS(71,",DIC(0)="AEMQ"
"RTN","RAMAIN",111,0)
 ; restrict choice of procedure by img type selected
"RTN","RAMAIN",112,0)
 S DIC("S")="I RA2[$P(^(0),U,12)"
"RTN","RAMAIN",113,0)
 W ! D ^DIC K DIC I Y<0 K %,DTOUT,DUOUT,DIC,X,Y G 139
"RTN","RAMAIN",114,0)
 S DA=+Y,DIE="^RAMIS(71,",DR=10 D ^DIE
"RTN","RAMAIN",115,0)
 K D,D0,DA,DDH,DI,DIC,DIE,DQ,DR,X
"RTN","RAMAIN",116,0)
 G 133
"RTN","RAMAIN",117,0)
139 K ^TMP($J,"RA I-TYPE"),RAQUIT
"RTN","RAMAIN",118,0)
 Q
"RTN","RAMAIN",119,0)
 ;
"RTN","RAMAIN",120,0)
PROHLP ; Help displays the modifiers and all associated imaging types.
"RTN","RAMAIN",121,0)
 D:'$D(IOM) HOME^%ZIS
"RTN","RAMAIN",122,0)
 N RAIT,RAIT1,RAIT2,RAIT3 Q:'+$O(^RAMIS(71.2,+Y,1,0))  ; Quit, no data
"RTN","RAMAIN",123,0)
 S (RAIT,RAIT3)=0
"RTN","RAMAIN",124,0)
 F  S RAIT=+$O(^RAMIS(71.2,+Y,1,RAIT)) W:'RAIT ")" Q:'RAIT  D
"RTN","RAMAIN",125,0)
 . S RAIT1=+$G(^RAMIS(71.2,+Y,1,RAIT,0))
"RTN","RAMAIN",126,0)
 . S RAIT2=$P($G(^RA(79.2,RAIT1,0)),"^",3)
"RTN","RAMAIN",127,0)
 . W:($X+5)>IOM !?2 W ?$X+1 W:'RAIT3 "(" W RAIT2 S RAIT3=1
"RTN","RAMAIN",128,0)
 . Q
"RTN","RAMAIN",129,0)
 Q
"VER")
8.0^22.0
**END**
**END**
