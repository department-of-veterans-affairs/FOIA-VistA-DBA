Released HL*1.6*101 SEQ #87
Extracted from mail message
**KIDS**:HL*1.6*101^

**INSTALL NAME**
HL*1.6*101
"BLD",611,0)
HL*1.6*101^HEALTH LEVEL SEVEN^0^3030505^y
"BLD",611,1,0)
^^2^2^3030505^
"BLD",611,1,1,0)
Please refer to the Description in the FORUM Patch Module for details.
"BLD",611,1,2,0)
Patch HL*1.6*101.
"BLD",611,4,0)
^9.64PA^^
"BLD",611,"KRN",0)
^9.67PA^8989.52^19
"BLD",611,"KRN",.4,0)
.4
"BLD",611,"KRN",.401,0)
.401
"BLD",611,"KRN",.402,0)
.402
"BLD",611,"KRN",.403,0)
.403
"BLD",611,"KRN",.5,0)
.5
"BLD",611,"KRN",.84,0)
.84
"BLD",611,"KRN",3.6,0)
3.6
"BLD",611,"KRN",3.8,0)
3.8
"BLD",611,"KRN",9.2,0)
9.2
"BLD",611,"KRN",9.8,0)
9.8
"BLD",611,"KRN",9.8,"NM",0)
^9.68A^1^1
"BLD",611,"KRN",9.8,"NM",1,0)
HLFNC2^^0^B17108807
"BLD",611,"KRN",9.8,"NM","B","HLFNC2",1)

"BLD",611,"KRN",19,0)
19
"BLD",611,"KRN",19.1,0)
19.1
"BLD",611,"KRN",101,0)
101
"BLD",611,"KRN",409.61,0)
409.61
"BLD",611,"KRN",771,0)
771
"BLD",611,"KRN",870,0)
870
"BLD",611,"KRN",8989.51,0)
8989.51
"BLD",611,"KRN",8989.52,0)
8989.52
"BLD",611,"KRN",8994,0)
8994
"BLD",611,"KRN","B",.4,.4)

"BLD",611,"KRN","B",.401,.401)

"BLD",611,"KRN","B",.402,.402)

"BLD",611,"KRN","B",.403,.403)

"BLD",611,"KRN","B",.5,.5)

"BLD",611,"KRN","B",.84,.84)

"BLD",611,"KRN","B",3.6,3.6)

"BLD",611,"KRN","B",3.8,3.8)

"BLD",611,"KRN","B",9.2,9.2)

"BLD",611,"KRN","B",9.8,9.8)

"BLD",611,"KRN","B",19,19)

"BLD",611,"KRN","B",19.1,19.1)

"BLD",611,"KRN","B",101,101)

"BLD",611,"KRN","B",409.61,409.61)

"BLD",611,"KRN","B",771,771)

"BLD",611,"KRN","B",870,870)

"BLD",611,"KRN","B",8989.51,8989.51)

"BLD",611,"KRN","B",8989.52,8989.52)

"BLD",611,"KRN","B",8994,8994)

"BLD",611,"QUES",0)
^9.62^^
"BLD",611,"REQB",0)
^9.611^1^1
"BLD",611,"REQB",1,0)
HL*1.6*59^0
"BLD",611,"REQB","B","HL*1.6*59",1)

"MBREQ")
0
"PKG",9,-1)
1^1
"PKG",9,0)
HEALTH LEVEL SEVEN^HL^DHCP IMPLEMENTATION OF HEALTH LEVEL SEVEN^
"PKG",9,20,0)
^9.402P^^
"PKG",9,22,0)
^9.49I^1^1
"PKG",9,22,1,0)
1.6^2980130^2980130^6
"PKG",9,22,1,"PAH",1,0)
101^3030505
"PKG",9,22,1,"PAH",1,1,0)
^^2^2^3030505
"PKG",9,22,1,"PAH",1,1,1,0)
Please refer to the Description in the FORUM Patch Module for details.
"PKG",9,22,1,"PAH",1,1,2,0)
Patch HL*1.6*101.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
1
"RTN","HLFNC2")
0^1^B17108807
"RTN","HLFNC2",1,0)
HLFNC2 ;AISC/SAW-Continuation of HLFNC, Additional Functions/Calls Used for HL7 Messages ;12/17/2002  16:40
"RTN","HLFNC2",2,0)
 ;;1.6;HEALTH LEVEL SEVEN;**2,26,57,59,101**;Oct 13, 1995
"RTN","HLFNC2",3,0)
INIT(EID,HL,INT) ;Initialize Variables in HL array for Building a Message
"RTN","HLFNC2",4,0)
 ;
"RTN","HLFNC2",5,0)
 ;This is a subroutine call with parameter passing that returns an
"RTN","HLFNC2",6,0)
 ;array of values in the variable specified by the parameter HL.  If no
"RTN","HLFNC2",7,0)
 ;error occurs, the array of values is returned.  Otherwise, the single
"RTN","HLFNC2",8,0)
 ;value HL is returned equal to the following:  error code^error message
"RTN","HLFNC2",9,0)
 ;
"RTN","HLFNC2",10,0)
 ;Required Input Parameters
"RTN","HLFNC2",11,0)
 ;    EID = Name or IEN of the event driver or subscriber protocol in
"RTN","HLFNC2",12,0)
 ;            Protocol file for which the initialization variables are
"RTN","HLFNC2",13,0)
 ;            to be returned
"RTN","HLFNC2",14,0)
 ;     HL = The variable in which the array of values will be returned
"RTN","HLFNC2",15,0)
 ;            This parameter must be passed by reference
"RTN","HLFNC2",16,0)
 ;Optional Input Parameter
"RTN","HLFNC2",17,0)
 ;    INT = 1 indicates that only array values for internal DHCP
"RTN","HLFNC2",18,0)
 ;            to DHCP message exchange should be initialized
"RTN","HLFNC2",19,0)
 ;
"RTN","HLFNC2",20,0)
 ;Check for required input parameter
"RTN","HLFNC2",21,0)
 I $G(EID)="" S HL="7^Missing EID Input Parameter" Q
"RTN","HLFNC2",22,0)
 I '$D(INT) S INT=0
"RTN","HLFNC2",23,0)
 ;Convert EID to IEN if necessary
"RTN","HLFNC2",24,0)
 I 'EID S EID=$O(^ORD(101,"B",EID,0)) I 'EID S HL="1^"_$G(^HL(771.7,1,0)) Q
"RTN","HLFNC2",25,0)
 N X0,X,X1,X2
"RTN","HLFNC2",26,0)
 ;Get node 770 from file 101 and node 0 from file 771
"RTN","HLFNC2",27,0)
 S X0=$G(^ORD(101,EID,0))
"RTN","HLFNC2",28,0)
 ;if server application is disabled quit
"RTN","HLFNC2",29,0)
 I $P(X0,U,3)]"" S HL="16^"_$G(^HL(771.7,16,0)) Q
"RTN","HLFNC2",30,0)
 ;if no known clients, set error but allow app to continue
"RTN","HLFNC2",31,0)
 I '$D(^ORD(101,EID,775,"B")) S HL="15^"_$G(^HL(771.7,15,0))
"RTN","HLFNC2",32,0)
 S X=$G(^ORD(101,EID,770)),X1=$G(^HL(771,+X,0))
"RTN","HLFNC2",33,0)
 I X1']"" S HL="14^"_$G(^HL(771.7,14,0)) Q
"RTN","HLFNC2",34,0)
 ;Set HL array variables
"RTN","HLFNC2",35,0)
 S HL("Q")="""""",HL("FS")=$G(^HL(771,+X,"FS")),HL("ECH")=$G(^("EC")) S:HL("FS")']"" HL("FS")="^" S:HL("ECH")']"" HL("ECH")="~|\&"
"RTN","HLFNC2",36,0)
 S HL("SAN")=$P(X1,"^"),HL("SAF")=$P(X1,"^",3) S:$P(X1,"^",7) HL("CC")=$P($G(^HL(779.004,$P(X1,"^",7),0)),"^")
"RTN","HLFNC2",37,0)
 S HL("MTN")=$P($G(^HL(771.2,+$P(X,"^",3),0)),"^"),HL("ETN")=$P($G(^HL(779.001,+$P(X,"^",4),0)),"^")
"RTN","HLFNC2",38,0)
 S:$P(X,"^",5) HL("MTN_ETN")=$P($G(^HL(779.005,+$P(X,"^",5),0)),"^")
"RTN","HLFNC2",39,0)
 S HL("PID")=$S($P(X,"^",6)="D":"D",1:$P($$PARAM^HLCS2,"^",3)),HL("VER")=$P($G(^HL(771.5,+$P(X,"^",10),0)),"^")
"RTN","HLFNC2",40,0)
 S:$P(X,"^",9) HL("APAT")=$P($G(^HL(779.003,$P(X,"^",9),0)),"^")
"RTN","HLFNC2",41,0)
 I 'INT S:$P(X,"^",8) HL("ACAT")=$P($G(^HL(779.003,$P(X,"^",8),0)),"^")
"RTN","HLFNC2",42,0)
 ;-- Set variables for backwards compatablity
"RTN","HLFNC2",43,0)
 S HLQ=HL("Q"),HLFS=HL("FS"),HLECH=HL("ECH")
"RTN","HLFNC2",44,0)
 Q
"RTN","HLFNC2",45,0)
MSH(HL,MID,RESULT,SECURITY) ;Create an MSH Segment for an Outgoing HL7
"RTN","HLFNC2",46,0)
 ;Message
"RTN","HLFNC2",47,0)
 ;
"RTN","HLFNC2",48,0)
 ;This is a subroutine call with parameter passing that returns an HL7
"RTN","HLFNC2",49,0)
 ;Message Header (MSH) segment in the variable RESULT (and possibly
"RTN","HLFNC2",50,0)
 ;RESULT(1) if the MSH segment is longer than 245 characters).  If the
"RTN","HLFNC2",51,0)
 ;required input parameters HL or MID are missing, RESULT is returned
"RTN","HLFNC2",52,0)
 ;equal to null
"RTN","HLFNC2",53,0)
 ;
"RTN","HLFNC2",54,0)
 ;Required Input Parameters
"RTN","HLFNC2",55,0)
 ;      HL = The array of values returned by the call to INIT^HLFNC2
"RTN","HLFNC2",56,0)
 ;     MID = The Message Control ID to be included in the MSH segment.
"RTN","HLFNC2",57,0)
 ;             The Batch Control ID for the batch is returned by the
"RTN","HLFNC2",58,0)
 ;             call to CREATE^HLTF.  The application concatenates a
"RTN","HLFNC2",59,0)
 ;             sequential number to the batch ID to create the MID
"RTN","HLFNC2",60,0)
 ;  RESULT = The variable that will be returned to the calling
"RTN","HLFNC2",61,0)
 ;             application as described above
"RTN","HLFNC2",62,0)
 ;Optional Input Parameter
"RTN","HLFNC2",63,0)
 ;SECURITY = Security to be included in field #8 of the MSH segment
"RTN","HLFNC2",64,0)
 ;
"RTN","HLFNC2",65,0)
 ;Check for required parameters
"RTN","HLFNC2",66,0)
 I '$D(HL)#2!('$D(MID)) Q ""
"RTN","HLFNC2",67,0)
 N X,X1,X2
"RTN","HLFNC2",68,0)
 ;Build MSH segment from HL array variables and other input parameters
"RTN","HLFNC2",69,0)
 S X="MSH"_HL("FS")_HL("ECH")_HL("FS")_HL("SAN")_HL("FS")_HL("SAF")_HL("FS")_$S($D(HL("RAN")):HL("RAN"),1:"")_HL("FS")_$S($D(HL("RAF")):HL("RAF"),1:"")_HL("FS")_$S($D(HL("DTM")):HL("DTM"),1:"")_HL("FS")
"RTN","HLFNC2",70,0)
 S X=X_$S($G(SECURITY)]"":SECURITY,1:"")_HL("FS")_HL("MTN")_$E(HL("ECH"))_HL("ETN")
"RTN","HLFNC2",71,0)
 ;Message structure component for HL7 v 2.3.1 and beyond
"RTN","HLFNC2",72,0)
 S:$D(HL("MTN_ETN")) X=X_$E(HL("ECH"))_HL("MTN_ETN")
"RTN","HLFNC2",73,0)
 S X=X_HL("FS")_MID_HL("FS")_HL("PID")_HL("FS")_HL("VER")
"RTN","HLFNC2",74,0)
 S:$D(HL("SN")) $P(X,HL("FS"),13)=HL("SN") S:$D(HL("ACAT")) $P(X,HL("FS"),15)=HL("ACAT") S:$D(HL("APAT")) $P(X,HL("FS"),16)=HL("APAT") S:$D(HL("CC")) $P(X,HL("FS"),17)=HL("CC")
"RTN","HLFNC2",75,0)
 ;If continuation pointer variable exists, insert it in piece 14 and
"RTN","HLFNC2",76,0)
 ;create new variable X1 if length of X will be greater than 245
"RTN","HLFNC2",77,0)
 I $D(HL("CP")) D
"RTN","HLFNC2",78,0)
 .I $L(X)+$L(HL("CP"))+2'>245 S $P(X,HL("FS"),14)=HL("CP") Q
"RTN","HLFNC2",79,0)
 .S $P(X,HL("FS"),14)="",X1=HL("FS")_$P(X,HL("FS"),15,17),X=$P(X,HL("FS"),1,14)
"RTN","HLFNC2",80,0)
 .S X2=$L(X),X=X_$E(HL("CP"),1,(245-X2)),X1=$E(HL("CP"),(246-X2),245)_X1
"RTN","HLFNC2",81,0)
 .S X2=$L(X) I $L(X2)<245 S X=X_$E(X1,1,(245-X2)),X1=$E(X1,(246-X2),245)
"RTN","HLFNC2",82,0)
 S RESULT=X S:$L($G(X1)) RESULT(1)=X1
"RTN","HLFNC2",83,0)
 Q
"RTN","HLFNC2",84,0)
RSPINIT(EIDS,HL) ;Initialize Variables in HL array for Building a Response Message
"RTN","HLFNC2",85,0)
 ;
"RTN","HLFNC2",86,0)
 ;This is a subroutine call with parameter passing that returns an
"RTN","HLFNC2",87,0)
 ;array of values in the variable specified by the parameter HL.  If no
"RTN","HLFNC2",88,0)
 ;error occurs, the array of values is returned.  Otherwise, the single
"RTN","HLFNC2",89,0)
 ;value HL is returned equal to the following:  error code^error message
"RTN","HLFNC2",90,0)
 ;
"RTN","HLFNC2",91,0)
 ;Required Input Parameters
"RTN","HLFNC2",92,0)
 ;    EIDS = Name or IEN of the subscriber protocol in
"RTN","HLFNC2",93,0)
 ;            Protocol file for which the initialization variables are
"RTN","HLFNC2",94,0)
 ;            to be returned
"RTN","HLFNC2",95,0)
 ;     HL = The variable in which the array of values will be returned
"RTN","HLFNC2",96,0)
 ;            This parameter must be passed by reference
"RTN","HLFNC2",97,0)
 ;
"RTN","HLFNC2",98,0)
 ;Check for required input parameter
"RTN","HLFNC2",99,0)
 I $G(EIDS)="" S HL="7^Missing EIDS Input Parameter" Q
"RTN","HLFNC2",100,0)
 ;Convert EIDS to IEN if necessary
"RTN","HLFNC2",101,0)
 I 'EIDS S EIDS=$O(^ORD(101,"B",EIDS,0)) I 'EIDS S HL="15^"_"Invalid Subscriber Protocol" Q
"RTN","HLFNC2",102,0)
 N X0,X,X1,X2
"RTN","HLFNC2",103,0)
 ;Get node 770 from file 101 and node 0 from file 771
"RTN","HLFNC2",104,0)
 S X0=$G(^ORD(101,EIDS,0))
"RTN","HLFNC2",105,0)
 S X=$G(^ORD(101,EIDS,770)),X1=$G(^HL(771,+$P(X,"^",2),0))
"RTN","HLFNC2",106,0)
 I X1']"" S HL="15^"_"Subscriber Application Missing in Protocol File" Q
"RTN","HLFNC2",107,0)
 ;Set HL array variables
"RTN","HLFNC2",108,0)
 S HL("RFS")=$G(^HL(771,+$P(X,"^",2),"FS")),HL("RECH")=$G(^("EC")) S:HL("RFS")']"" HL("RFS")="^" S:HL("RECH")']"" HL("RECH")="~|\&"
"RTN","HLFNC2",109,0)
 S HL("RAN")=$P(X1,"^")
"RTN","HLFNC2",110,0)
 S HL("RMTN")=$P($G(^HL(771.2,+$P(X,"^",11),0)),"^"),HL("RETN")=$P($G(^HL(779.001,+$P(X,"^",4),0)),"^")
"RTN","HLFNC2",111,0)
 Q
"VER")
8.0^22.0
**END**
**END**
