Released EN*7*77 SEQ #75
Extracted from mail message
**KIDS**:EN*7.0*77^

**INSTALL NAME**
EN*7.0*77
"BLD",4741,0)
EN*7.0*77^ENGINEERING^0^3031001^y
"BLD",4741,1,0)
^^1^1^3030507^
"BLD",4741,1,1,0)
CoreFLS Data Quality Assurance - Engineering Space (#6928) Patch EN*7.0*77
"BLD",4741,4,0)
^9.64PA^^
"BLD",4741,"ABPKG")
n
"BLD",4741,"KRN",0)
^9.67PA^8989.52^19
"BLD",4741,"KRN",.4,0)
.4
"BLD",4741,"KRN",.401,0)
.401
"BLD",4741,"KRN",.402,0)
.402
"BLD",4741,"KRN",.403,0)
.403
"BLD",4741,"KRN",.5,0)
.5
"BLD",4741,"KRN",.84,0)
.84
"BLD",4741,"KRN",3.6,0)
3.6
"BLD",4741,"KRN",3.8,0)
3.8
"BLD",4741,"KRN",9.2,0)
9.2
"BLD",4741,"KRN",9.8,0)
9.8
"BLD",4741,"KRN",9.8,"NM",0)
^9.68A^7^7
"BLD",4741,"KRN",9.8,"NM",1,0)
ENH6928^^0^B9419416
"BLD",4741,"KRN",9.8,"NM",2,0)
ENH6928L^^0^B48176643
"BLD",4741,"KRN",9.8,"NM",3,0)
ENH6928P^^0^B31757158
"BLD",4741,"KRN",9.8,"NM",4,0)
ENH6928U^^0^B48115911
"BLD",4741,"KRN",9.8,"NM",5,0)
ENH6928M^^0^B79583642
"BLD",4741,"KRN",9.8,"NM",6,0)
ENH6928I^^0^B28592396
"BLD",4741,"KRN",9.8,"NM",7,0)
ENH6928H^^0^B12620142
"BLD",4741,"KRN",9.8,"NM","B","ENH6928",1)

"BLD",4741,"KRN",9.8,"NM","B","ENH6928H",7)

"BLD",4741,"KRN",9.8,"NM","B","ENH6928I",6)

"BLD",4741,"KRN",9.8,"NM","B","ENH6928L",2)

"BLD",4741,"KRN",9.8,"NM","B","ENH6928M",5)

"BLD",4741,"KRN",9.8,"NM","B","ENH6928P",3)

"BLD",4741,"KRN",9.8,"NM","B","ENH6928U",4)

"BLD",4741,"KRN",19,0)
19
"BLD",4741,"KRN",19,"NM",0)
^9.68A^6^6
"BLD",4741,"KRN",19,"NM",1,0)
ENH DATA CLEANSING^^2
"BLD",4741,"KRN",19,"NM",2,0)
ENH ENGINEERING SPACE^^0
"BLD",4741,"KRN",19,"NM",3,0)
ENH 6928 SUMMARY REPORT^^0
"BLD",4741,"KRN",19,"NM",4,0)
ENH 6928 REQUIRED RPT^^0
"BLD",4741,"KRN",19,"NM",5,0)
ENH 6928 LOOKUP RPT^^0
"BLD",4741,"KRN",19,"NM",6,0)
ENH 6928 NON-REQUIRED RPT^^0
"BLD",4741,"KRN",19,"NM","B","ENH 6928 LOOKUP RPT",5)

"BLD",4741,"KRN",19,"NM","B","ENH 6928 NON-REQUIRED RPT",6)

"BLD",4741,"KRN",19,"NM","B","ENH 6928 REQUIRED RPT",4)

"BLD",4741,"KRN",19,"NM","B","ENH 6928 SUMMARY REPORT",3)

"BLD",4741,"KRN",19,"NM","B","ENH DATA CLEANSING",1)

"BLD",4741,"KRN",19,"NM","B","ENH ENGINEERING SPACE",2)

"BLD",4741,"KRN",19.1,0)
19.1
"BLD",4741,"KRN",19.1,"NM",0)
^9.68A^^0
"BLD",4741,"KRN",101,0)
101
"BLD",4741,"KRN",409.61,0)
409.61
"BLD",4741,"KRN",771,0)
771
"BLD",4741,"KRN",870,0)
870
"BLD",4741,"KRN",8989.51,0)
8989.51
"BLD",4741,"KRN",8989.52,0)
8989.52
"BLD",4741,"KRN",8994,0)
8994
"BLD",4741,"KRN","B",.4,.4)

"BLD",4741,"KRN","B",.401,.401)

"BLD",4741,"KRN","B",.402,.402)

"BLD",4741,"KRN","B",.403,.403)

"BLD",4741,"KRN","B",.5,.5)

"BLD",4741,"KRN","B",.84,.84)

"BLD",4741,"KRN","B",3.6,3.6)

"BLD",4741,"KRN","B",3.8,3.8)

"BLD",4741,"KRN","B",9.2,9.2)

"BLD",4741,"KRN","B",9.8,9.8)

"BLD",4741,"KRN","B",19,19)

"BLD",4741,"KRN","B",19.1,19.1)

"BLD",4741,"KRN","B",101,101)

"BLD",4741,"KRN","B",409.61,409.61)

"BLD",4741,"KRN","B",771,771)

"BLD",4741,"KRN","B",870,870)

"BLD",4741,"KRN","B",8989.51,8989.51)

"BLD",4741,"KRN","B",8989.52,8989.52)

"BLD",4741,"KRN","B",8994,8994)

"BLD",4741,"QUES",0)
^9.62^^
"BLD",4741,"REQB",0)
^9.611^1^1
"BLD",4741,"REQB",1,0)
EN*7.0*74^0
"BLD",4741,"REQB","B","EN*7.0*74",1)

"KRN",19,11578,-1)
2^1
"KRN",19,11578,0)
ENH DATA CLEANSING^CoreFLS AEMS/MERS Data Cleansing Reports^^M^101009^ENH DATA CLEANSING^^^^^^33
"KRN",19,11578,10,0)
^19.01IP^7^7
"KRN",19,11578,10,3,0)
11629^3^3
"KRN",19,11578,10,3,"^")
ENH ENGINEERING SPACE
"KRN",19,11578,"U")
COREFLS AEMS/MERS DATA CLEANSI
"KRN",19,11629,-1)
0^2
"KRN",19,11629,0)
ENH ENGINEERING SPACE^Engineering Space - 6928^^M^^ENH DATA CLEANSING^^^^^^ENGINEERING
"KRN",19,11629,1,0)
^^2^2^3030916^
"KRN",19,11629,1,1,0)
This menu displays all of the CoreFLS Data Cleansing report options for
"KRN",19,11629,1,2,0)
AEMS/MERS ENG SPACE (#6928) file.
"KRN",19,11629,10,0)
^19.01IP^4^4
"KRN",19,11629,10,1,0)
11728^1^1
"KRN",19,11629,10,1,"^")
ENH 6928 SUMMARY REPORT
"KRN",19,11629,10,2,0)
11729^2^2
"KRN",19,11629,10,2,"^")
ENH 6928 REQUIRED RPT
"KRN",19,11629,10,3,0)
11730^3^3
"KRN",19,11629,10,3,"^")
ENH 6928 LOOKUP RPT
"KRN",19,11629,10,4,0)
11731^4^4
"KRN",19,11629,10,4,"^")
ENH 6928 NON-REQUIRED RPT
"KRN",19,11629,25)

"KRN",19,11629,99)
59344,60178
"KRN",19,11629,"U")
ENGINEERING SPACE - 6928
"KRN",19,11728,-1)
0^3
"KRN",19,11728,0)
ENH 6928 SUMMARY REPORT^Summary Report^^R^^^^^^^^ENGINEERING^^1^
"KRN",19,11728,1,0)
^^5^5^3030923^
"KRN",19,11728,1,1,0)
This option prints or displays the CoreFLS Data Cleansing Summary Report
"KRN",19,11728,1,2,0)
for the ENG SPACE (#6928) file. The report shows the fields being checked
"KRN",19,11728,1,3,0)
and the total number of times that required fields and non-required fields
"KRN",19,11728,1,4,0)
are missing data and the total number of times that lookup fields have
"KRN",19,11728,1,5,0)
invalid data.
"KRN",19,11728,15)

"KRN",19,11728,20)
S ENHRPT=1
"KRN",19,11728,25)
REPTYP^ENH6928
"KRN",19,11728,"U")
SUMMARY REPORT
"KRN",19,11729,-1)
0^4
"KRN",19,11729,0)
ENH 6928 REQUIRED RPT^Required Fields Missing Data Report^^R^^^^^^^^ENGINEERING^^1^
"KRN",19,11729,1,0)
^^3^3^3030923^
"KRN",19,11729,1,1,0)
This option prints or displays the CoreFLS Data Cleansing Required Fields
"KRN",19,11729,1,2,0)
Missing Data Report for the ENG SPACE (#6928) file. The report
"KRN",19,11729,1,3,0)
lists the required fields that are empty and that you must correct.
"KRN",19,11729,15)

"KRN",19,11729,20)
S ENHRPT=2
"KRN",19,11729,25)
REPTYP^ENH6928
"KRN",19,11729,"U")
REQUIRED FIELDS MISSING DATA R
"KRN",19,11730,-1)
0^5
"KRN",19,11730,0)
ENH 6928 LOOKUP RPT^Lookup Fields w/ Invalid Data Report^^R^^^^^^^^ENGINEERING^^1^
"KRN",19,11730,1,0)
^^4^4^3030923^
"KRN",19,11730,1,1,0)
This option prints or displays the CoreFLS Data Cleansing Lookup Fields w/
"KRN",19,11730,1,2,0)
Invalid Data Report for the ENG SPACE (#6928) file. The report lists the
"KRN",19,11730,1,3,0)
lookup fields that contain an invalid value in a pointer field that you 
"KRN",19,11730,1,4,0)
must correct.
"KRN",19,11730,15)

"KRN",19,11730,20)
S ENHRPT=3
"KRN",19,11730,25)
REPTYP^ENH6928
"KRN",19,11730,"U")
LOOKUP FIELDS W/ INVALID DATA 
"KRN",19,11731,-1)
0^6
"KRN",19,11731,0)
ENH 6928 NON-REQUIRED RPT^Non-Required Fields Missing Data Report^^R^^^^^^^^ENGINEERING^^1^
"KRN",19,11731,1,0)
^^3^3^3030923^
"KRN",19,11731,1,1,0)
This option prints or displays the CoreFLS Data Cleansing Non-Required
"KRN",19,11731,1,2,0)
Fields Missing Data Report for the ENG SPACE (#6928) file. The report
"KRN",19,11731,1,3,0)
lists the non-required fields that are empty and that you should correct.
"KRN",19,11731,15)

"KRN",19,11731,20)
S ENHRPT=4
"KRN",19,11731,25)
REPTYP^ENH6928
"KRN",19,11731,"U")
NON-REQUIRED FIELDS MISSING DA
"MBREQ")
0
"ORD",18,19)
19;18;;;OPT^XPDTA;OPTF1^XPDIA;OPTE1^XPDIA;OPTF2^XPDIA;;OPTDEL^XPDIA
"ORD",18,19,0)
OPTION
"PKG",33,-1)
1^1
"PKG",33,0)
ENGINEERING^EN^AUTOMATED ENGINEERING MANAGEMENT SYSTEM
"PKG",33,20,0)
^9.402P^^
"PKG",33,22,0)
^9.49I^1^1
"PKG",33,22,1,0)
7.0^2930817^2960130
"PKG",33,22,1,"PAH",1,0)
77^3031001
"PKG",33,22,1,"PAH",1,1,0)
^^1^1^3031001
"PKG",33,22,1,"PAH",1,1,1,0)
CoreFLS Data Quality Assurance - Engineering Space (#6928) Patch EN*7.0*77
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
7
"RTN","ENH6928")
0^1^B9419416
"RTN","ENH6928",1,0)
ENH6928 ;WOIFO/EEN - Engineering Space Report Driver (AMES/MERS) - CoreFLS ;10/01/03 15:14
"RTN","ENH6928",2,0)
 ;;7.0;Engineering;**77**;Aug 17,1993
"RTN","ENH6928",3,0)
 ;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","ENH6928",4,0)
 ;
"RTN","ENH6928",5,0)
 Q  ;this routine is not callable from the top
"RTN","ENH6928",6,0)
 ;
"RTN","ENH6928",7,0)
 ;This routine is the main entry point for all the ENGINEERING SPACE
"RTN","ENH6928",8,0)
 ;(#6928) data cleansing options.
"RTN","ENH6928",9,0)
 ;
"RTN","ENH6928",10,0)
REPTYP ; Entry Point to print all data cleansing reports
"RTN","ENH6928",11,0)
 ;
"RTN","ENH6928",12,0)
 I '$D(DT)!'$D(U) D DT^DICRW
"RTN","ENH6928",13,0)
 K ^TMP("ENH6928",$J)
"RTN","ENH6928",14,0)
 S ABORT=0
"RTN","ENH6928",15,0)
 Q:'$D(ENHRPT)
"RTN","ENH6928",16,0)
 I ENHRPT=1 D
"RTN","ENH6928",17,0)
 . S PRTRTN="OPT1^ENH6928P"
"RTN","ENH6928",18,0)
 I ENHRPT=2 D
"RTN","ENH6928",19,0)
 . S PRTRTN="OPT2^ENH6928P"
"RTN","ENH6928",20,0)
 I ENHRPT=3 D
"RTN","ENH6928",21,0)
 . S PRTRTN="OPT3^ENH6928P"
"RTN","ENH6928",22,0)
 I ENHRPT=4 D
"RTN","ENH6928",23,0)
 . S PRTRTN="OPT4^ENH6928P"
"RTN","ENH6928",24,0)
 D DIVM I ABORT G EXIT Q
"RTN","ENH6928",25,0)
 D INST^ENH6928U I ABORT G EXIT Q
"RTN","ENH6928",26,0)
 D DEVICE
"RTN","ENH6928",27,0)
 G EXIT
"RTN","ENH6928",28,0)
 Q
"RTN","ENH6928",29,0)
 ;
"RTN","ENH6928",30,0)
DIVM ; Print by Division Prompt
"RTN","ENH6928",31,0)
 ;
"RTN","ENH6928",32,0)
 K DIR,DIV,ENHDIVFG,Y,ENHDIV
"RTN","ENH6928",33,0)
 S IEN=0
"RTN","ENH6928",34,0)
 F  S IEN=$O(^ENG("SP",IEN)) Q:'IEN  D
"RTN","ENH6928",35,0)
 . S DIV=$P(^ENG("SP",IEN,0),U,10) I DIV="" S DIV="ZZ no division"
"RTN","ENH6928",36,0)
 . I '$D(ENHDIV(DIV)) S ENHDIV(DIV)=""
"RTN","ENH6928",37,0)
 W !!," This report is sorted by division. You may select a single division or ALL.",!
"RTN","ENH6928",38,0)
 S DIVDIR="S^1:ALL",CNT=1,DIV=""
"RTN","ENH6928",39,0)
 F  S DIV=$O(ENHDIV(DIV)) Q:DIV=""  D
"RTN","ENH6928",40,0)
 . S CNT=CNT+1
"RTN","ENH6928",41,0)
 . S DIVDIR=DIVDIR_";"_CNT_":"_DIV
"RTN","ENH6928",42,0)
 S DIR(0)=DIVDIR
"RTN","ENH6928",43,0)
 S DIR("A")="Please select a division (1-"_CNT_")"
"RTN","ENH6928",44,0)
 S DIR("A",1)=" "
"RTN","ENH6928",45,0)
 S DIR("B")=1
"RTN","ENH6928",46,0)
 S DIR("?")=" "
"RTN","ENH6928",47,0)
 S DIR("?",1)=" The list below contains the divisions that have been"
"RTN","ENH6928",48,0)
 S DIR("?",2)=" found in the DIVISION (#.6) field in the ENG SPACE"
"RTN","ENH6928",49,0)
 S DIR("?",3)=" (#6928) file."
"RTN","ENH6928",50,0)
 S DIR("?",4)=" "
"RTN","ENH6928",51,0)
 S DIR("?",5)=" Select ""ZZ no division"" to display the records with no"
"RTN","ENH6928",52,0)
 S DIR("?",6)=" entry in the DIVISION (#.6) field."
"RTN","ENH6928",53,0)
 D ^DIR K DIR
"RTN","ENH6928",54,0)
 I Y[U!(Y="")!$D(DTOUT)!$D(DUOUT) S ABORT=1 Q
"RTN","ENH6928",55,0)
 S ENHDIVFG=Y(0)
"RTN","ENH6928",56,0)
 Q
"RTN","ENH6928",57,0)
 ;
"RTN","ENH6928",58,0)
DEVICE ; Ask the user for a device to print to (queuing is allowed).
"RTN","ENH6928",59,0)
 W !
"RTN","ENH6928",60,0)
 S %ZIS="Q"
"RTN","ENH6928",61,0)
 D ^%ZIS Q:POP
"RTN","ENH6928",62,0)
 ;User has decided to Queue report
"RTN","ENH6928",63,0)
 I $D(IO("Q")) D  Q
"RTN","ENH6928",64,0)
 . S ZTSAVE("ENHRPT")="",ZTSAVE("ENHDIVFG")="",ZTSAVE("ENHINST")=""
"RTN","ENH6928",65,0)
 . S ZTRTN=PRTRTN
"RTN","ENH6928",66,0)
 . S ZTDESC="CoreFLS DATA QUALITY REPORT (File# 6928 - ENG SPACE)"
"RTN","ENH6928",67,0)
 . D ^%ZTLOAD,HOME^%ZIS
"RTN","ENH6928",68,0)
 . K ZTSK,ZTSAVE,ZTRTN,ZTDESC
"RTN","ENH6928",69,0)
 D @PRTRTN
"RTN","ENH6928",70,0)
 Q
"RTN","ENH6928",71,0)
 ;
"RTN","ENH6928",72,0)
EXIT ;
"RTN","ENH6928",73,0)
 K P,L,ABORT,I,ENFLG,TOTANA,CRITREC,BPTREC,DESREC,CRITNUM,BPTNUM,DESNUM
"RTN","ENH6928",74,0)
 K CHKTYP,FLDNAME,IEN,FLDNUM,RMCRIT,BFPCRIT,BFPBPT,FUNCRIT,FUNBPT,PRTRTN
"RTN","ENH6928",75,0)
 K SERVBPT,KEYBPT,HBPT,NAME,UTLBPT,UIEN,DESNSF,DIR,ENHRPT,ENHDIVFG,ENHDIV
"RTN","ENH6928",76,0)
 K ENHDR,DIV,SFIEN,SFNAME,RMNUM,FLD,NSFDES,PTFIL,PTERVAL,RECIEN,RECNUM
"RTN","ENH6928",77,0)
 K CNT,DIVDIR,POP,Y,PTEDFIL,DESFLD,RECANA,ENHINST,DIVCT,%ZIS,FUNDES
"RTN","ENH6928",78,0)
 K FLDANA,DTOUT,DUOUT
"RTN","ENH6928",79,0)
 Q
"RTN","ENH6928H")
0^7^B12620142
"RTN","ENH6928H",1,0)
ENH6928H ;WOIFO/EEN - Engineering Space Report Headers (AMES/MERS) - CoreFLS ;10/01/03 15:14
"RTN","ENH6928H",2,0)
 ;;7.0;Engineering;**77**;Aug 17,1993
"RTN","ENH6928H",3,0)
 ;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","ENH6928H",4,0)
 ;
"RTN","ENH6928H",5,0)
 ; This routine prints Summary and Detailed Reports headers for the
"RTN","ENH6928H",6,0)
 ; Engineering Space File (#6928)
"RTN","ENH6928H",7,0)
 ;
"RTN","ENH6928H",8,0)
 Q  ;This routine is not callable from the top
"RTN","ENH6928H",9,0)
 ;
"RTN","ENH6928H",10,0)
SHDR ; Summary Report Header
"RTN","ENH6928H",11,0)
 W !!,"Totals for the """_^TMP("ENH6928",$J,DIV,0)_""" Division:"
"RTN","ENH6928H",12,0)
 W ! F I=1:1:63 W "-"
"RTN","ENH6928H",13,0)
 W !,"Total records analyzed",?55,$J(TOTANA,8)
"RTN","ENH6928H",14,0)
 W !,"Total records with Required Fields Missing Data",?55,$J(CRITREC,8)
"RTN","ENH6928H",15,0)
 W !,"Total records with Lookup Fields w/ Invalid Data",?55,$J(BPTREC,8)
"RTN","ENH6928H",16,0)
 W !,"Total records with Non-Required Fields Missing Data",?55,$J(DESREC,8)
"RTN","ENH6928H",17,0)
 S L=L+7
"RTN","ENH6928H",18,0)
 Q
"RTN","ENH6928H",19,0)
 ;
"RTN","ENH6928H",20,0)
CHDR ; Required Fields w/ Missing Data Report Header
"RTN","ENH6928H",21,0)
 W !!,"Totals for the """_^TMP("ENH6928",$J,DIV,0)_""" Division:"
"RTN","ENH6928H",22,0)
 W ! F I=1:1:63 W "-"
"RTN","ENH6928H",23,0)
 W !,"Total records analyzed",?55,$J(TOTANA,8)
"RTN","ENH6928H",24,0)
 W !,"Total records with Required Fields Missing Data",?55,$J(RECANA,8)
"RTN","ENH6928H",25,0)
 W !,"Total fields with Required Fields Missing Data",?55,$J(FLDANA,8)
"RTN","ENH6928H",26,0)
 S L=L+6
"RTN","ENH6928H",27,0)
 Q
"RTN","ENH6928H",28,0)
 ;
"RTN","ENH6928H",29,0)
BHDR ; Lookup Fields w/ Invalid Data Report Header
"RTN","ENH6928H",30,0)
 W !!,"Totals for the """_^TMP("ENH6928",$J,DIV,0)_""" Division:"
"RTN","ENH6928H",31,0)
 W ! F I=1:1:63 W "-"
"RTN","ENH6928H",32,0)
 W !,"Total records analyzed",?55,$J(TOTANA,8)
"RTN","ENH6928H",33,0)
 W !,"Total records with Lookup Fields w/ Invalid Data",?55,$J(RECANA,8)
"RTN","ENH6928H",34,0)
 W !,"Total fields with Lookup Fields w/ Invalid Data",?55,$J(FLDANA,8)
"RTN","ENH6928H",35,0)
 S L=L+6
"RTN","ENH6928H",36,0)
 Q
"RTN","ENH6928H",37,0)
 ;
"RTN","ENH6928H",38,0)
DHDR ; Non-Required Fields w/ Missing Data Report Header
"RTN","ENH6928H",39,0)
 W !!,"Totals for the """_^TMP("ENH6928",$J,DIV,0)_""" Division:"
"RTN","ENH6928H",40,0)
 W ! F I=1:1:63 W "-"
"RTN","ENH6928H",41,0)
 W !,"Total records analyzed",?55,$J(TOTANA,8)
"RTN","ENH6928H",42,0)
 W !,"Total records with Non-Required Fields Missing Data",?55,$J(RECANA,8)
"RTN","ENH6928H",43,0)
 W !,"Total fields with Non-Required Fields Missing Data",?55,$J(FLDANA,8)
"RTN","ENH6928H",44,0)
 S L=L+6
"RTN","ENH6928H",45,0)
 Q
"RTN","ENH6928H",46,0)
 ;
"RTN","ENH6928H",47,0)
SUB ; Header for subsequent pages
"RTN","ENH6928H",48,0)
 W !!,"Totals for the """_^TMP("ENH6928",$J,DIV,0)_""" Division:"
"RTN","ENH6928H",49,0)
 W ! F I=1:1:63 W "-"
"RTN","ENH6928H",50,0)
 S L=L+3
"RTN","ENH6928H",51,0)
 Q
"RTN","ENH6928H",52,0)
 ;
"RTN","ENH6928H",53,0)
SUMC ; Summary Report columns
"RTN","ENH6928H",54,0)
 W !!,"DATA QUALITY",?15,"FIELD",?31,"REQUIRED FIELDS",?48,"LOOKUP FIELDS",?65,"NON-REQ. FIELDS"
"RTN","ENH6928H",55,0)
 W !,"CHECK TYPE",?15,"NAME",?31,"MISSING DATA",?48,"W/ INVALID DATA",?65,"MISSING DATA"
"RTN","ENH6928H",56,0)
 W ! F I=1:1:80 W "="
"RTN","ENH6928H",57,0)
 S L=L+4
"RTN","ENH6928H",58,0)
 Q
"RTN","ENH6928H",59,0)
 ;
"RTN","ENH6928H",60,0)
DETC ; Detailed Report columns
"RTN","ENH6928H",61,0)
 W !!,"REC",?10,"ROOM",?45,"FIELD",?67,"MULTIPLE"
"RTN","ENH6928H",62,0)
 W !,"IEN",?10,"NUMBER",?45,"NAME",?67,"NUMBER"
"RTN","ENH6928H",63,0)
 W ! F I=1:1:80 W "="
"RTN","ENH6928H",64,0)
 S L=L+4
"RTN","ENH6928H",65,0)
 Q
"RTN","ENH6928H",66,0)
 ;
"RTN","ENH6928H",67,0)
NOMULT  ; Column Header with out the Multiple Column
"RTN","ENH6928H",68,0)
 W !!,"REC",?10,"ROOM",?45,"FIELD"
"RTN","ENH6928H",69,0)
 W !,"IEN",?10,"NUMBER",?45,"NAME"
"RTN","ENH6928H",70,0)
 W ! F I=1:1:80 W "="
"RTN","ENH6928H",71,0)
 S L=L+4
"RTN","ENH6928H",72,0)
 Q
"RTN","ENH6928H",73,0)
 ;
"RTN","ENH6928H",74,0)
SORT ; Re-sort TMP for RECORD sort
"RTN","ENH6928H",75,0)
 ;
"RTN","ENH6928H",76,0)
 S EN1="",ENFILE="ENH6928",ENFILE1="ENH6928R"
"RTN","ENH6928H",77,0)
 K ^TMP(ENFILE1)
"RTN","ENH6928H",78,0)
 F  S EN1=$O(^TMP(ENFILE,$J,EN1)) Q:EN1=""  D
"RTN","ENH6928H",79,0)
 . S EN2=""
"RTN","ENH6928H",80,0)
 . F  S EN2=$O(^TMP(ENFILE,$J,EN1,EN2)) Q:EN2=""  D
"RTN","ENH6928H",81,0)
 .. S EN3=0
"RTN","ENH6928H",82,0)
 .. F  S EN3=$O(^TMP(ENFILE,$J,EN1,EN2,EN3)) Q:'EN3  D
"RTN","ENH6928H",83,0)
 ... S EN4=0
"RTN","ENH6928H",84,0)
 ... F  S EN4=$O(^TMP(ENFILE,$J,EN1,EN2,EN3,EN4)) Q:'EN4  D
"RTN","ENH6928H",85,0)
 .... I EN3=14 D MSORT Q
"RTN","ENH6928H",86,0)
 .... S ^TMP(ENFILE1,$J,EN1,EN2,EN4,EN3)=^TMP(ENFILE,$J,EN1,EN2,EN3,EN4)
"RTN","ENH6928H",87,0)
 K EN1,EN2,EN3,EN4,EN5,ENFILE,ENFILE1
"RTN","ENH6928H",88,0)
 Q
"RTN","ENH6928H",89,0)
 ;
"RTN","ENH6928H",90,0)
MSORT ; Re-sort for multiples by RECORD
"RTN","ENH6928H",91,0)
 ;
"RTN","ENH6928H",92,0)
 Q:EN4=""
"RTN","ENH6928H",93,0)
 S EN5=0
"RTN","ENH6928H",94,0)
 F  S EN5=$O(^TMP(ENFILE,$J,EN1,EN2,EN3,EN4,EN5)) Q:'EN5  D
"RTN","ENH6928H",95,0)
 . S ^TMP(ENFILE1,$J,EN1,EN2,EN4,EN3,EN5)=^TMP(ENFILE,$J,EN1,EN2,EN3,EN4,EN5)
"RTN","ENH6928H",96,0)
 Q
"RTN","ENH6928I")
0^6^B28592396
"RTN","ENH6928I",1,0)
ENH6928I ;WOIFO/EEN - Engineering Space Instructions (AMES/MERS) - CoreFLS ;10/01/03 15:15
"RTN","ENH6928I",2,0)
 ;;7.0;Engineering;**77**;Aug 17,1993
"RTN","ENH6928I",3,0)
 ;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","ENH6928I",4,0)
 ;
"RTN","ENH6928I",5,0)
 Q  ; This report is not callable from the top
"RTN","ENH6928I",6,0)
 ;
"RTN","ENH6928I",7,0)
PRT1 ; Print Instructions for Summary Report
"RTN","ENH6928I",8,0)
 ;
"RTN","ENH6928I",9,0)
 S (P,L,ABORT)=0
"RTN","ENH6928I",10,0)
 S ENHDR="SUMMARY"
"RTN","ENH6928I",11,0)
 S ENHDR1="Instructions"
"RTN","ENH6928I",12,0)
 U IO
"RTN","ENH6928I",13,0)
 D HDR^ENH6928U
"RTN","ENH6928I",14,0)
 W !!,"The purpose of this report is to display the total number of records in the"
"RTN","ENH6928I",15,0)
 W !,"ENG SPACE (#6928) file that have invalid or missing (empty) values"
"RTN","ENH6928I",16,0)
 W !,"in the fields that are being converted into the CoreFLS system.  The report"
"RTN","ENH6928I",17,0)
 W !,"examines eight fields to determine if there is a valid value in each. If there"
"RTN","ENH6928I",18,0)
 W !,"is no value in the field, it is considered to be empty. If there is a value"
"RTN","ENH6928I",19,0)
 W !,"in a lookup-type (a.k.a. pointer) field, the report examines the value to"
"RTN","ENH6928I",20,0)
 W !,"ensure that it is valid."
"RTN","ENH6928I",21,0)
 S L=L+8
"RTN","ENH6928I",22,0)
 I L+14>IOSL D HDR^ENH6928U Q:ABORT
"RTN","ENH6928I",23,0)
 W !!,"This report examines the following fields:"
"RTN","ENH6928I",24,0)
 W !,"NOTE: Abbreviations for field names used on this report appear in quotes next"
"RTN","ENH6928I",25,0)
 W !,"to the field number"
"RTN","ENH6928I",26,0)
 W !!,"     ROOM NUMBER (#.01)"
"RTN","ENH6928I",27,0)
 W !,"     BUILDING FILE POINTER (#.51) - ""Bldg File Ptr"""
"RTN","ENH6928I",28,0)
 W !,"     SERVICE (#1.5)"
"RTN","ENH6928I",29,0)
 W !,"     KEY (#2)"
"RTN","ENH6928I",30,0)
 W !,"     FUNCTION (#2.6)"
"RTN","ENH6928I",31,0)
 W !,"     H-08-9 CRITERIA (#4.9) - ""H-08-9 Crit"""
"RTN","ENH6928I",32,0)
 W !,"     UTILITIES (Multiple) (#6928.01,1)"
"RTN","ENH6928I",33,0)
 W !,"     NET SQ.FT. (#4.5)"
"RTN","ENH6928I",34,0)
 S L=L+13
"RTN","ENH6928I",35,0)
 I L+7>IOSL D HDR^ENH6928U Q:ABORT
"RTN","ENH6928I",36,0)
 W !!,"The report is sorted by division. When printing or viewing this report, you"
"RTN","ENH6928I",37,0)
 W !,"may select a single division or ALL. Select ""ZZ no division"" to display the"
"RTN","ENH6928I",38,0)
 W !,"records with no entry in the DIVISION (#.6) field. The report lists the overall"
"RTN","ENH6928I",39,0)
 W !,"count of the number of problem records and fields detected."
"RTN","ENH6928I",40,0)
 S L=L+5
"RTN","ENH6928I",41,0)
 I L+4>IOSL D HDR^ENH6928U Q:ABORT
"RTN","ENH6928I",42,0)
 W !!,"The totals for each division are as follows:"
"RTN","ENH6928I",43,0)
 S L=L+2
"RTN","ENH6928I",44,0)
 I L+5>IOSL D HDR^ENH6928U Q:ABORT
"RTN","ENH6928I",45,0)
 W !!,"Total records analyzed - number of records in the ENG SPACE (#6928) file"
"RTN","ENH6928I",46,0)
 W !,"     assigned to the division"
"RTN","ENH6928I",47,0)
 S L=L+3
"RTN","ENH6928I",48,0)
 I L+5>IOSL D HDR^ENH6928U Q:ABORT
"RTN","ENH6928I",49,0)
 W !!,"Total records with Required Fields Missing Data - number of records that have"
"RTN","ENH6928I",50,0)
 W !,"     at least one empty required field"
"RTN","ENH6928I",51,0)
 S L=L+3
"RTN","ENH6928I",52,0)
 I L+5>IOSL D HDR^ENH6928U Q:ABORT
"RTN","ENH6928I",53,0)
 W !!,"Total records with Lookup Fields w/ Invalid Data - number of records that have"
"RTN","ENH6928I",54,0)
 W !,"     invalid data in any of the lookup fields"
"RTN","ENH6928I",55,0)
 S L=L+3
"RTN","ENH6928I",56,0)
 I L+5>IOSL D HDR^ENH6928U Q:ABORT
"RTN","ENH6928I",57,0)
 W !!,"Total records with Non-Required Fields Missing Data - number of records that"
"RTN","ENH6928I",58,0)
 W !,"     have nothing in at least one non-required field"
"RTN","ENH6928I",59,0)
 S L=L+3
"RTN","ENH6928I",60,0)
 I L+5>IOSL D HDR^ENH6928U Q:ABORT
"RTN","ENH6928I",61,0)
 W !!,"Next, the report lists the counts for each individual field. The fields are"
"RTN","ENH6928I",62,0)
 W !,"listed in alphabetical order. Each row consists of the following columns:"
"RTN","ENH6928I",63,0)
 S L=L+3
"RTN","ENH6928I",64,0)
 I L+7>IOSL D HDR^ENH6928U Q:ABORT
"RTN","ENH6928I",65,0)
 W !!,"DATA QUALITY CHECK TYPE - tells whether the field was examined for:"
"RTN","ENH6928I",66,0)
 W !,"     REQ: required fields missing data"
"RTN","ENH6928I",67,0)
 W !,"     INV: invalid data"
"RTN","ENH6928I",68,0)
 W !,"     NREQ: non-required fields missing data"
"RTN","ENH6928I",69,0)
 S L=L+5
"RTN","ENH6928I",70,0)
 I L+4>IOSL D HDR^ENH6928U Q:ABORT
"RTN","ENH6928I",71,0)
 W !!,"FIELD NAME - name or abbreviation of the field from the ENG SPACE (#6928) file"
"RTN","ENH6928I",72,0)
 S L=L+2
"RTN","ENH6928I",73,0)
 I L+5>IOSL D HDR^ENH6928U Q:ABORT
"RTN","ENH6928I",74,0)
 W !!,"REQUIRED FIELDS MISSING DATA - count of the number of empty required fields"
"RTN","ENH6928I",75,0)
 W !,"     (""N/A"" appears in this column if the field is not required by CoreFLS.)"
"RTN","ENH6928I",76,0)
 S L=L+3
"RTN","ENH6928I",77,0)
 I L+6>IOSL D HDR^ENH6928U Q:ABORT
"RTN","ENH6928I",78,0)
 W !!,"LOOKUP FIELDS W/ INVALID DATA - count of the number of lookup fields that"
"RTN","ENH6928I",79,0)
 W !,"     contain an invalid value  (""N/A"" appears in this column if the field"
"RTN","ENH6928I",80,0)
 W !,"     is not a lookup field.)"
"RTN","ENH6928I",81,0)
 S L=L+4
"RTN","ENH6928I",82,0)
 I L+6>IOSL D HDR^ENH6928U Q:ABORT
"RTN","ENH6928I",83,0)
 W !!,"NON-REQ. FIELDS WITH MISSING DATA - count of the number of empty non-required"
"RTN","ENH6928I",84,0)
 W !,"     fields (""N/A"" appears in this column if non-required does not apply"
"RTN","ENH6928I",85,0)
 W !,"     to this field.)"
"RTN","ENH6928I",86,0)
 S L=L+4
"RTN","ENH6928I",87,0)
 I L+11>IOSL D HDR^ENH6928U Q:ABORT
"RTN","ENH6928I",88,0)
 W !!,"*** Special Note ************************************************"
"RTN","ENH6928I",89,0)
 W !,"The following is a multiple-type field:"
"RTN","ENH6928I",90,0)
 W !,"     UTILITIES (#6928.01,1)"
"RTN","ENH6928I",91,0)
 W !,"Multiple fields can occur many times within one ENG SPACE (#6928)"
"RTN","ENH6928I",92,0)
 W !,"file record. All occurrences of these fields are examined. The"
"RTN","ENH6928I",93,0)
 W !,"index number of the multiple with missing or invalid data is"
"RTN","ENH6928I",94,0)
 W !,"displayed on the detail reports."
"RTN","ENH6928I",95,0)
 W !,"*****************************************************************"
"RTN","ENH6928I",96,0)
 W !!,"<End of Instructions>" I $E(IOST,1,2)="C-" W "  Enter RETURN to continue or '^' to exit: " R Y:DTIME I '$T!(Y[U) S ABORT=1 Q
"RTN","ENH6928I",97,0)
 W @IOF
"RTN","ENH6928I",98,0)
 K P,L,Y,ENHDR,ENHDR1
"RTN","ENH6928I",99,0)
 Q
"RTN","ENH6928L")
0^2^B48176643
"RTN","ENH6928L",1,0)
ENH6928L ;WOIFO/EEN - Engineering Space Report Loop (AEMS/MERS) - CoreFLS ;10/01/03 15:15
"RTN","ENH6928L",2,0)
 ;;7.0;ENGINEERING;**77**;Aug 17,1993
"RTN","ENH6928L",3,0)
 ;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","ENH6928L",4,0)
 ;
"RTN","ENH6928L",5,0)
INIT ; Initialize Variables
"RTN","ENH6928L",6,0)
 I $E(IOST,1,2)="C-" D WAIT^DICD
"RTN","ENH6928L",7,0)
 K ^TMP("ENH6928",$J)
"RTN","ENH6928L",8,0)
 S (ENIEN,DIVCT)=0
"RTN","ENH6928L",9,0)
 ;
"RTN","ENH6928L",10,0)
LOOP ; Initialize TMP global with records in file 6928 Engineering Space
"RTN","ENH6928L",11,0)
 ;
"RTN","ENH6928L",12,0)
 F  S ENIEN=$O(^ENG("SP",ENIEN)) Q:'ENIEN  D
"RTN","ENH6928L",13,0)
 . S (CRITFLD,BPTFLD,DESFLD,CRITFLG,BPTFLG,DESFLG,UIEN)=0
"RTN","ENH6928L",14,0)
 . S (ENHDIV,RMNAME,BFPTER,KEYPTER,HPTER,SERVPTER,FUNPTER,UTLPTER)=""
"RTN","ENH6928L",15,0)
 . ;
"RTN","ENH6928L",16,0)
 . ; Get Division if NULL then set to "ZZ no division"
"RTN","ENH6928L",17,0)
 . S ENHDIV=$P($G(^ENG("SP",ENIEN,0)),U,10)
"RTN","ENH6928L",18,0)
 . I ENHDIV="" S ENHDIV="ZZ no division"
"RTN","ENH6928L",19,0)
 . ;
"RTN","ENH6928L",20,0)
 . ; Set Division node in ^TMP and initialize nodes for Division
"RTN","ENH6928L",21,0)
 . I '$D(^TMP("ENH6928",$J,"DIV",ENHDIV)) D
"RTN","ENH6928L",22,0)
 .. S DIVCT=DIVCT+1
"RTN","ENH6928L",23,0)
 .. S ^TMP("ENH6928",$J,"DIV",ENHDIV)=DIVCT
"RTN","ENH6928L",24,0)
 .. S ^TMP("ENH6928",$J,DIVCT,0)=ENHDIV
"RTN","ENH6928L",25,0)
 .. S ^TMP("ENH6928",$J,DIVCT,"SUM")="0^0^0^0"
"RTN","ENH6928L",26,0)
 .. S ^TMP("ENH6928",$J,DIVCT,"CRIT")="0"
"RTN","ENH6928L",27,0)
 .. S ^TMP("ENH6928",$J,DIVCT,"BPT")=0
"RTN","ENH6928L",28,0)
 .. S ^TMP("ENH6928",$J,DIVCT,"DES")=0
"RTN","ENH6928L",29,0)
 .. S ^TMP("ENH6928",$J,DIVCT,"CRIT",.01)=0
"RTN","ENH6928L",30,0)
 .. S ^TMP("ENH6928",$J,DIVCT,"CRIT",.51)=0
"RTN","ENH6928L",31,0)
 .. S ^TMP("ENH6928",$J,DIVCT,"BPT",.51)=0
"RTN","ENH6928L",32,0)
 .. S ^TMP("ENH6928",$J,DIVCT,"BPT",1.5)=0
"RTN","ENH6928L",33,0)
 .. S ^TMP("ENH6928",$J,DIVCT,"BPT",2)=0
"RTN","ENH6928L",34,0)
 .. S ^TMP("ENH6928",$J,DIVCT,"BPT",2.6)=0
"RTN","ENH6928L",35,0)
 .. S ^TMP("ENH6928",$J,DIVCT,"BPT",4.9)=0
"RTN","ENH6928L",36,0)
 .. S ^TMP("ENH6928",$J,DIVCT,"BPT",14)=0
"RTN","ENH6928L",37,0)
 .. S ^TMP("ENH6928",$J,DIVCT,"DES",2.6)=0
"RTN","ENH6928L",38,0)
 .. S ^TMP("ENH6928",$J,DIVCT,"DES",4.5)=0
"RTN","ENH6928L",39,0)
 . ;
"RTN","ENH6928L",40,0)
 . ; Nodes that have been initialized or that already exist
"RTN","ENH6928L",41,0)
 . I $D(^TMP("ENH6928",$J,"DIV",ENHDIV)) D
"RTN","ENH6928L",42,0)
 .. S ENDIVCT=^TMP("ENH6928",$J,"DIV",ENHDIV)
"RTN","ENH6928L",43,0)
 . ;
"RTN","ENH6928L",44,0)
 . ; Get Room Number (.01 field)
"RTN","ENH6928L",45,0)
 . S RMNAME=$P($G(^ENG("SP",ENIEN,0)),U)
"RTN","ENH6928L",46,0)
 . ;
"RTN","ENH6928L",47,0)
 . ; **Add up Critical Null fields**
"RTN","ENH6928L",48,0)
 . ; -- Room Number (Check for Crit Null) --
"RTN","ENH6928L",49,0)
 . I $P($G(^ENG("SP",ENIEN,0)),U)="" D
"RTN","ENH6928L",50,0)
 .. S CRITFLD=CRITFLD+1,CRITFLG=1
"RTN","ENH6928L",51,0)
 .. S ^TMP("ENH6928",$J,ENDIVCT,"CRIT",.01)=^TMP("ENH6928",$J,ENDIVCT,"CRIT",.01)+1
"RTN","ENH6928L",52,0)
 .. S ^TMP("ENH6928",$J,ENDIVCT,"CRIT",.01,ENIEN)=ENIEN_U_RMNAME_U_"Room Number"_U_"6928,.01"_U_"N/A"_U_"N/A"
"RTN","ENH6928L",53,0)
 . ;
"RTN","ENH6928L",54,0)
 . ; -- Building File Pointer (Check for Crit Null) --
"RTN","ENH6928L",55,0)
 . I $P($G(^ENG("SP",ENIEN,0)),U,14)="" D
"RTN","ENH6928L",56,0)
 .. S CRITFLD=CRITFLD+1,CRITFLG=1
"RTN","ENH6928L",57,0)
 .. S ^TMP("ENH6928",$J,ENDIVCT,"CRIT",.51)=^TMP("ENH6928",$J,ENDIVCT,"CRIT",.51)+1
"RTN","ENH6928L",58,0)
 .. S ^TMP("ENH6928",$J,ENDIVCT,"CRIT",.51,ENIEN)=ENIEN_U_RMNAME_U_"Bldg File Ptr"_U_"6928,.51"_U_"N/A"_U_"N/A"
"RTN","ENH6928L",59,0)
 . ;
"RTN","ENH6928L",60,0)
 . ; -- Function (Check for Crit Null) --
"RTN","ENH6928L",61,0)
 . ;I $P($G(^ENG("SP",ENIEN,4)),U)="" D
"RTN","ENH6928L",62,0)
 .;. S CRITFLD=CRITFLD+1,CRITFLG=1
"RTN","ENH6928L",63,0)
 .;. S ^TMP("ENH6928",$J,ENDIVCT,"CRIT",2.6)=^TMP("ENH6928",$J,ENDIVCT,"CRIT",2.6)+1
"RTN","ENH6928L",64,0)
 .;. S ^TMP("ENH6928",$J,ENDIVCT,"CRIT",2.6,ENIEN)=ENIEN_U_RMNAME_U_"Function"_U_"6928,2.6"_U_"N/A"_U_"N/A"
"RTN","ENH6928L",65,0)
 . ;
"RTN","ENH6928L",66,0)
 . ; **Add up Broken Pointer fields**
"RTN","ENH6928L",67,0)
 . ; -- Building File Pointer (Check for Broken Pter) --
"RTN","ENH6928L",68,0)
 . S BFPTER=$P($G(^ENG("SP",ENIEN,0)),U,14)
"RTN","ENH6928L",69,0)
 . I BFPTER'="" D
"RTN","ENH6928L",70,0)
 .. I '$D(^ENG(6928.3,BFPTER,0))!($P($G(^ENG(6928.3,BFPTER,0)),U)="") D
"RTN","ENH6928L",71,0)
 ... S BPTFLD=BPTFLD+1,BPTFLG=1
"RTN","ENH6928L",72,0)
 ... S ^TMP("ENH6928",$J,ENDIVCT,"BPT",.51)=^TMP("ENH6928",$J,ENDIVCT,"BPT",.51)+1
"RTN","ENH6928L",73,0)
 ... S ^TMP("ENH6928",$J,ENDIVCT,"BPT",.51,ENIEN)=ENIEN_U_RMNAME_U_"Bldg File Ptr"_U_"6928,.51"_U_"N/A"_U_BFPTER_U_"6928.3"
"RTN","ENH6928L",74,0)
 . ;
"RTN","ENH6928L",75,0)
 . ; -- Service (Check for Broken Pter) --
"RTN","ENH6928L",76,0)
 . S SERVPTER=$P($G(^ENG("SP",ENIEN,0)),U,4)
"RTN","ENH6928L",77,0)
 . I SERVPTER'="" D
"RTN","ENH6928L",78,0)
 .. I '$D(^DIC(49,SERVPTER,0))!($P($G(^DIC(49,SERVPTER,0)),U)="") D
"RTN","ENH6928L",79,0)
 ... S BPTFLD=BPTFLD+1,BPTFLG=1
"RTN","ENH6928L",80,0)
 ... S ^TMP("ENH6928",$J,ENDIVCT,"BPT",1.5)=^TMP("ENH6928",$J,ENDIVCT,"BPT",1.5)+1
"RTN","ENH6928L",81,0)
 ... S ^TMP("ENH6928",$J,ENDIVCT,"BPT",1.5,ENIEN)=ENIEN_U_RMNAME_U_"Service"_U_"6928,1.5"_U_"N/A"_U_SERVPTER_U_"49"
"RTN","ENH6928L",82,0)
 . ;
"RTN","ENH6928L",83,0)
 . ; -- Key (Check for Broken Pter) --
"RTN","ENH6928L",84,0)
 . S KEYPTER=$P($G(^ENG("SP",ENIEN,0)),U,5)
"RTN","ENH6928L",85,0)
 . I KEYPTER'="" D
"RTN","ENH6928L",86,0)
 .. I '$D(^ENG("LK",KEYPTER,0))!($P($G(^ENG("LK",KEYPTER,0)),U)="") D
"RTN","ENH6928L",87,0)
 ... S BPTFLD=BPTFLD+1,BPTFLG=1
"RTN","ENH6928L",88,0)
 ... S ^TMP("ENH6928",$J,ENDIVCT,"BPT",2)=^TMP("ENH6928",$J,ENDIVCT,"BPT",2)+1
"RTN","ENH6928L",89,0)
 ... S ^TMP("ENH6928",$J,ENDIVCT,"BPT",2,ENIEN)=ENIEN_U_RMNAME_U_"Key"_U_"6928,2"_U_"N/A"_U_KEYPTER_U_"6927"
"RTN","ENH6928L",90,0)
 . ;
"RTN","ENH6928L",91,0)
 . ; -- Function (Check for Broken Pter) --
"RTN","ENH6928L",92,0)
 . S FUNPTER=$P($G(^ENG("SP",ENIEN,4)),U)
"RTN","ENH6928L",93,0)
 . I FUNPTER'="" D
"RTN","ENH6928L",94,0)
 .. I '$D(^ENG(6928.1,FUNPTER,0))!($P($G(^ENG(6928.1,FUNPTER,0)),U)="") D
"RTN","ENH6928L",95,0)
 ... S BPTFLD=BPTFLD+1,BPTFLG=1
"RTN","ENH6928L",96,0)
 ... S ^TMP("ENH6928",$J,ENDIVCT,"BPT",2.6)=^TMP("ENH6928",$J,ENDIVCT,"BPT",2.6)+1
"RTN","ENH6928L",97,0)
 ... S ^TMP("ENH6928",$J,ENDIVCT,"BPT",2.6,ENIEN)=ENIEN_U_RMNAME_U_"Function"_U_"6928,2.6"_U_"N/A"_U_FUNPTER_U_"6928.1"
"RTN","ENH6928L",98,0)
 . ;
"RTN","ENH6928L",99,0)
 . ; -- H-08-9 Criteria (Check for Broken Pter) --
"RTN","ENH6928L",100,0)
 . S HPTER=$P($G(^ENG("SP",ENIEN,9)),U,2)
"RTN","ENH6928L",101,0)
 . I HPTER'="" D
"RTN","ENH6928L",102,0)
 .. I '$D(^OFM(7336.6,HPTER,0))!($P($G(^OFM(7336.6,HPTER,0)),U)="") D
"RTN","ENH6928L",103,0)
 ... S BPTFLD=BPTFLD+1,BPTFLG=1
"RTN","ENH6928L",104,0)
 ... S ^TMP("ENH6928",$J,ENDIVCT,"BPT",4.9)=^TMP("ENH6928",$J,ENDIVCT,"BPT",4.9)+1
"RTN","ENH6928L",105,0)
 ... S ^TMP("ENH6928",$J,ENDIVCT,"BPT",4.9,ENIEN)=ENIEN_U_RMNAME_U_"H-08-9 Crit"_U_"6928,4.9"_U_"N/A"_U_HPTER_U_"7336.6"
"RTN","ENH6928L",106,0)
 . ;
"RTN","ENH6928L",107,0)
 . ; -- Utilities multiple (Check for Broken Pters) --
"RTN","ENH6928L",108,0)
 . S UIEN=0 F  S UIEN=$O(^ENG("SP",ENIEN,1,UIEN)) Q:'UIEN  D
"RTN","ENH6928L",109,0)
 .. S UTLPTER=$P($G(^ENG("SP",ENIEN,1,UIEN,0)),U)
"RTN","ENH6928L",110,0)
 .. I UTLPTER'="" D
"RTN","ENH6928L",111,0)
 ... I '$D(^ENG(6928.2,UTLPTER,0))!($P($G(^ENG(6928.2,UTLPTER,0)),U)="") D
"RTN","ENH6928L",112,0)
 .... S BPTFLD=BPTFLD+1,BPTFLG=1
"RTN","ENH6928L",113,0)
 .... S ^TMP("ENH6928",$J,ENDIVCT,"BPT",14)=^TMP("ENH6928",$J,ENDIVCT,"BPT",14)+1
"RTN","ENH6928L",114,0)
 .... S ^TMP("ENH6928",$J,ENDIVCT,"BPT",14,ENIEN,UIEN)=ENIEN_U_RMNAME_U_"Utilities"_U_"6928,14"_U_UIEN_U_UTLPTER_U_"6928.2"
"RTN","ENH6928L",115,0)
 . ;
"RTN","ENH6928L",116,0)
 . ; **Add up the Desirable Null fields**
"RTN","ENH6928L",117,0)
 . ; -- Net Sq. Ft. (Check for Desirable Null) --
"RTN","ENH6928L",118,0)
 . I $P($G(^ENG("SP",ENIEN,0)),U,9)="" D
"RTN","ENH6928L",119,0)
 .. S DESFLD=DESFLD+1,DESFLG=1
"RTN","ENH6928L",120,0)
 .. S ^TMP("ENH6928",$J,ENDIVCT,"DES",4.5)=^TMP("ENH6928",$J,ENDIVCT,"DES",4.5)+1
"RTN","ENH6928L",121,0)
 .. S ^TMP("ENH6928",$J,ENDIVCT,"DES",4.5,ENIEN)=ENIEN_U_RMNAME_U_"Net Sq. Ft."_U_"6928,4.5"_U_"N/A"_U_"N/A"
"RTN","ENH6928L",122,0)
 . ;
"RTN","ENH6928L",123,0)
 . ; -- Function (Check for Desirable Null) --
"RTN","ENH6928L",124,0)
 . I $P($G(^ENG("SP",ENIEN,4)),U)="" D
"RTN","ENH6928L",125,0)
 .. S DESFLD=DESFLD+1,DESFLG=1
"RTN","ENH6928L",126,0)
 .. S ^TMP("ENH6928",$J,ENDIVCT,"DES",2.6)=^TMP("ENH6928",$J,ENDIVCT,"DES",2.6)+1
"RTN","ENH6928L",127,0)
 .. S ^TMP("ENH6928",$J,ENDIVCT,"DES",2.6,ENIEN)=ENIEN_U_RMNAME_U_"Function"_U_"6928,2.6"_U_"N/A"_U_"N/A"
"RTN","ENH6928L",128,0)
 . ;
"RTN","ENH6928L",129,0)
 . ; Add counters for Total Analyzed, Critical, Broken, and Desirable
"RTN","ENH6928L",130,0)
 . S $P(^TMP("ENH6928",$J,ENDIVCT,"SUM"),U)=$P(^TMP("ENH6928",$J,ENDIVCT,"SUM"),U)+1
"RTN","ENH6928L",131,0)
 . I CRITFLG D
"RTN","ENH6928L",132,0)
 .. S $P(^TMP("ENH6928",$J,ENDIVCT,"SUM"),U,2)=$P(^TMP("ENH6928",$J,ENDIVCT,"SUM"),U,2)+1
"RTN","ENH6928L",133,0)
 .. S ^TMP("ENH6928",$J,ENDIVCT,"CRIT")=^TMP("ENH6928",$J,ENDIVCT,"CRIT")+CRITFLD
"RTN","ENH6928L",134,0)
 . I BPTFLG D
"RTN","ENH6928L",135,0)
 .. S $P(^TMP("ENH6928",$J,ENDIVCT,"SUM"),U,3)=$P(^TMP("ENH6928",$J,ENDIVCT,"SUM"),U,3)+1
"RTN","ENH6928L",136,0)
 .. S ^TMP("ENH6928",$J,ENDIVCT,"BPT")=^TMP("ENH6928",$J,ENDIVCT,"BPT")+BPTFLD
"RTN","ENH6928L",137,0)
 . I DESFLG D
"RTN","ENH6928L",138,0)
 .. S $P(^TMP("ENH6928",$J,ENDIVCT,"SUM"),U,4)=$P(^TMP("ENH6928",$J,ENDIVCT,"SUM"),U,4)+1
"RTN","ENH6928L",139,0)
 .. S ^TMP("ENH6928",$J,ENDIVCT,"DES")=^TMP("ENH6928",$J,ENDIVCT,"DES")+DESFLD
"RTN","ENH6928L",140,0)
 . ;
"RTN","ENH6928L",141,0)
 . Q
"RTN","ENH6928L",142,0)
 ; Re-sort by record IEN
"RTN","ENH6928L",143,0)
 D SORT^ENH6928H
"RTN","ENH6928L",144,0)
 ;
"RTN","ENH6928L",145,0)
EXIT ; Kill all local variables
"RTN","ENH6928L",146,0)
 K ENIEN,ENHDIV,ENDIVCT,CRITFLD,BPTFLD,HPTER,UIEN,UTLPTER,RMNAME,DIVI
"RTN","ENH6928L",147,0)
 K DESFLD,CRITFLG,BPTFLG,DESFLG,BFPTER,KEYPTER,SERVPTER,UTILPTER,FUNPTER
"RTN","ENH6928L",148,0)
 K DIVCT
"RTN","ENH6928L",149,0)
 Q
"RTN","ENH6928M")
0^5^B79583642
"RTN","ENH6928M",1,0)
ENH6928M ;WOIFO/EEN - Engineering Space Instructions (AMES/MERS) - CoreFLS ;10/01/03 15:15
"RTN","ENH6928M",2,0)
 ;;7.0;Engineering;**77**;Aug 17,1993
"RTN","ENH6928M",3,0)
 ;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","ENH6928M",4,0)
 ;
"RTN","ENH6928M",5,0)
 Q  ; This report is not callable from the top
"RTN","ENH6928M",6,0)
 ;
"RTN","ENH6928M",7,0)
PRT3 ; Print Instructions for Broken Pointers Report
"RTN","ENH6928M",8,0)
 ;
"RTN","ENH6928M",9,0)
 S (P,L,ABORT)=0
"RTN","ENH6928M",10,0)
 S ENHDR="LOOKUP FIELDS W/ INVALID DATA"
"RTN","ENH6928M",11,0)
 S ENHDR1="Instructions"
"RTN","ENH6928M",12,0)
 U IO
"RTN","ENH6928M",13,0)
 D HDR^ENH6928U
"RTN","ENH6928M",14,0)
 W !!,"The purpose of this report is to display a list of all fields in the ENG SPACE"
"RTN","ENH6928M",15,0)
 W !,"(#6928) file that contain an invalid value in a lookup-type or pointer"
"RTN","ENH6928M",16,0)
 W !,"field.  An invalid value is defined as a value that either does not have an"
"RTN","ENH6928M",17,0)
 W !,"entry in the file to which it points, or the entry in the file pointed to has"
"RTN","ENH6928M",18,0)
 W !,"an empty NAME (#.01) field.  An entry and a name must be present in the file"
"RTN","ENH6928M",19,0)
 W !,"to which a field points."
"RTN","ENH6928M",20,0)
 S L=L+7
"RTN","ENH6928M",21,0)
 I L+13>IOSL D HDR^ENH6928U Q:ABORT
"RTN","ENH6928M",22,0)
 W !!,"This report examines the following lookup fields:"
"RTN","ENH6928M",23,0)
 W !,"NOTE: Abbreviations for field names used on this report appear in quotes next"
"RTN","ENH6928M",24,0)
 W !,"to the field number"
"RTN","ENH6928M",25,0)
 W !!,"     BUILDING FILE POINTER (#.51) - ""Bldg File Ptr"""
"RTN","ENH6928M",26,0)
 W !,"     SERVICE (#1.5)"
"RTN","ENH6928M",27,0)
 W !,"     KEY (#2)"
"RTN","ENH6928M",28,0)
 W !,"     FUNCTION (#2.6)"
"RTN","ENH6928M",29,0)
 W !,"     H-08-9 CRITERIA (#4.9) - ""H-08-9 Crit"""
"RTN","ENH6928M",30,0)
 W !,"     UTILITIES (Multiple) (#6928.01,.01)"
"RTN","ENH6928M",31,0)
 S L=L+11
"RTN","ENH6928M",32,0)
 I L+6>IOSL D HDR^ENH6928U Q:ABORT
"RTN","ENH6928M",33,0)
 W !!,"The report is sorted by division. When printing or viewing this report, you"
"RTN","ENH6928M",34,0)
 W !,"may select a single division or ALL. Select ""ZZ no division"" to display the"
"RTN","ENH6928M",35,0)
 W !,"records with no entry in the DIVISION (#.6) field."
"RTN","ENH6928M",36,0)
 S L=L+4
"RTN","ENH6928M",37,0)
 I L+4>IOSL D HDR^ENH6928U Q:ABORT
"RTN","ENH6928M",38,0)
 W !!,"The totals for each division are as follows:"
"RTN","ENH6928M",39,0)
 S L=L+2
"RTN","ENH6928M",40,0)
 I L+5>IOSL D HDR^ENH6928U Q:ABORT
"RTN","ENH6928M",41,0)
 W !!,"Total records analyzed - number of records in the ENG SPACE (#6928) file"
"RTN","ENH6928M",42,0)
 W !,"     assigned to the division"
"RTN","ENH6928M",43,0)
 S L=L+3
"RTN","ENH6928M",44,0)
 I L+5>IOSL D HDR^ENH6928U Q:ABORT
"RTN","ENH6928M",45,0)
 W !!,"Total records with Lookup Fields w/ Invalid Data - number of records"
"RTN","ENH6928M",46,0)
 W !,"     that have an invalid value in one or more of the lookup fields"
"RTN","ENH6928M",47,0)
 S L=L+3
"RTN","ENH6928M",48,0)
 I L+5>IOSL D HDR^ENH6928U Q:ABORT
"RTN","ENH6928M",49,0)
 W !!,"Total fields with Lookup Fields w/ Invalid Data - number of lookup fields"
"RTN","ENH6928M",50,0)
 W !,"     with invalid data"
"RTN","ENH6928M",51,0)
 S L=L+3
"RTN","ENH6928M",52,0)
 I L+7>IOSL D HDR^ENH6928U Q:ABORT
"RTN","ENH6928M",53,0)
 W !!,"The report then lists each record in order by its internal entry number (IEN)."
"RTN","ENH6928M",54,0)
 W !,"Each row on the report contains the following columns:"
"RTN","ENH6928M",55,0)
 W !!,"REC IEN - lists the ENG SPACE (#6928) file internal record number"
"RTN","ENH6928M",56,0)
 S L=L+5
"RTN","ENH6928M",57,0)
 I L+3>IOSL D HDR^ENH6928U Q:ABORT
"RTN","ENH6928M",58,0)
 W !!,"ROOM NUMBER - name or number of the record (#.01 field)"
"RTN","ENH6928M",59,0)
 S L=L+2
"RTN","ENH6928M",60,0)
 I L+3>IOSL D HDR^ENH6928U Q:ABORT
"RTN","ENH6928M",61,0)
 W !!,"FIELD NAME - name or abbreviation of the lookup field"
"RTN","ENH6928M",62,0)
 S L=L+2
"RTN","ENH6928M",63,0)
 I L+4>IOSL D HDR^ENH6928U Q:ABORT
"RTN","ENH6928M",64,0)
 W !!,"MULTIPLE NUM - index number of the multiple"
"RTN","ENH6928M",65,0)
 S L=L+2
"RTN","ENH6928M",66,0)
 I L+9>IOSL D HDR^ENH6928U Q:ABORT
"RTN","ENH6928M",67,0)
 W !!,"You must correct every field that appears on this report prior to conversion"
"RTN","ENH6928M",68,0)
 W !,"to CoreFLS. Use AEMS/MERS to enter a valid value in each lookup field listed."
"RTN","ENH6928M",69,0)
 W !,"To do so, select the Enter New Room Space Data [ENSPROOM] option. Using this"
"RTN","ENH6928M",70,0)
 W !,"report as a reference, correct each record with invalid data in the SERVICE,"
"RTN","ENH6928M",71,0)
 W !,"KEY, FUNCTION, H-08-9 CRITERIA, or UTILITIES fields. If the value is not"
"RTN","ENH6928M",72,0)
 W !,"required, you may make the field empty (delete the existing value)."
"RTN","ENH6928M",73,0)
 S L=L+7
"RTN","ENH6928M",74,0)
 I L+9>IOSL D HDR^ENH6928U Q:ABORT
"RTN","ENH6928M",75,0)
 W !!,"*** Special Note on BUILDING FILE POINTER ***********************"
"RTN","ENH6928M",76,0)
 W !,"You cannot correct the BUILDING FILE POINTER (#.51) field using"
"RTN","ENH6928M",77,0)
 W !,"data entry in AEMS/MERS or in an editing session of VA FileMan."
"RTN","ENH6928M",78,0)
 W !,"This field is triggered-in when you enter or edit a value in the"
"RTN","ENH6928M",79,0)
 W !,"ROOM NUMBER (#.01) field. The ROOM NUMBER  format consists of:"
"RTN","ENH6928M",80,0)
 W !,"      [room number]-[wing/building]-[division]"
"RTN","ENH6928M",81,0)
 S L=L+7
"RTN","ENH6928M",82,0)
 I L+10>IOSL D HDR^ENH6928U Q:ABORT
"RTN","ENH6928M",83,0)
 W !!,"Two methods are available to correct records missing a value in"
"RTN","ENH6928M",84,0)
 W !,"the BUILDING FILE POINTER:"
"RTN","ENH6928M",85,0)
 W !!,"  1. You may select the record in AEMS/MERS or VA FileMan and"
"RTN","ENH6928M",86,0)
 W !,"     re-type the ROOM NUMBER (#.01) field to recreate the BUILDING"
"RTN","ENH6928M",87,0)
 W !,"     FILE POINTER. DO NOT ACCEPT the default value by pressing"
"RTN","ENH6928M",88,0)
 W !,"     <Enter>. You must re-type the entire room number value."
"RTN","ENH6928M",89,0)
 S L=L+8
"RTN","ENH6928M",90,0)
 I L+10>IOSL D HDR^ENH6928U Q:ABORT
"RTN","ENH6928M",91,0)
 W !!,"  2. You may request that the IRM or ADPAC re-index the 'AF'"
"RTN","ENH6928M",92,0)
 W !,"     cross-reference in VA FileMan on the ROOM NUMBER (#.01) field"
"RTN","ENH6928M",93,0)
 W !,"     to recreate the BUILDING FILE POINTER."
"RTN","ENH6928M",94,0)
 W !!,"If you have any difficulties contact the IRM or ADPAC for"
"RTN","ENH6928M",95,0)
 W !,"assistance."
"RTN","ENH6928M",96,0)
 W !,"******************************************************************"
"RTN","ENH6928M",97,0)
 S L=L+8
"RTN","ENH6928M",98,0)
 I L+11>IOSL D HDR^ENH6928U Q:ABORT
"RTN","ENH6928M",99,0)
 W !!,"**** Special Note ***********************************************"
"RTN","ENH6928M",100,0)
 W !,"The following is a multiple-type field:"
"RTN","ENH6928M",101,0)
 W !,"     UTILITIES (#6928.01,1)"
"RTN","ENH6928M",102,0)
 W !,"Multiple fields can occur many times within one ENG SPACE (#6928)"
"RTN","ENH6928M",103,0)
 W !,"file record. All occurrences of these fields are examined. The"
"RTN","ENH6928M",104,0)
 W !,"index number of the multiple with missing or invalid data is"
"RTN","ENH6928M",105,0)
 W !,"displayed on this report."
"RTN","ENH6928M",106,0)
 W !,"******************************************************************"
"RTN","ENH6928M",107,0)
 S L=L+9
"RTN","ENH6928M",108,0)
 I L+8>IOSL D HDR^ENH6928U Q:ABORT
"RTN","ENH6928M",109,0)
 W !!,"*** Conversion Note *********************************************"
"RTN","ENH6928M",110,0)
 W !,"If any lookup field on this report is left with invalid data, it"
"RTN","ENH6928M",111,0)
 W !,"will be converted as empty into CoreFLS."
"RTN","ENH6928M",112,0)
 W !,"******************************************************************"
"RTN","ENH6928M",113,0)
 W !!,"<End of Instructions>" I $E(IOST,1,2)="C-" W "  Enter RETURN to continue or '^' to exit: " R Y:DTIME I '$T!(Y[U) S ABORT=1 Q
"RTN","ENH6928M",114,0)
 W @IOF
"RTN","ENH6928M",115,0)
 K Y,P,L,ENHDR,ENHDR1
"RTN","ENH6928M",116,0)
 Q
"RTN","ENH6928M",117,0)
 ;
"RTN","ENH6928M",118,0)
PRT4 ; Print Instructions for Desirable Nulls Report
"RTN","ENH6928M",119,0)
 ;
"RTN","ENH6928M",120,0)
 S (P,L,ABORT)=0
"RTN","ENH6928M",121,0)
 S ENHDR="NON-REQUIRED FIELDS MISSING DATA"
"RTN","ENH6928M",122,0)
 S ENHDR1="instructions"
"RTN","ENH6928M",123,0)
 U IO
"RTN","ENH6928M",124,0)
 D HDR^ENH6928U
"RTN","ENH6928M",125,0)
 W !!,"The purpose of this report is to display a list of all ENG SPACE (#6928)"
"RTN","ENH6928M",126,0)
 W !,"items with missing (empty) data for the fields that are not required in"
"RTN","ENH6928M",127,0)
 W !,"the CoreFLS system.  If fields appearing on this report are left empty, the"
"RTN","ENH6928M",128,0)
 W !,"conversion will either default to a value or convert the field as empty into"
"RTN","ENH6928M",129,0)
 W !,"the CoreFLS system."
"RTN","ENH6928M",130,0)
 S L=L+6
"RTN","ENH6928M",131,0)
 I L+6>IOSL D HDR^ENH6928U Q:ABORT
"RTN","ENH6928M",132,0)
 W !!,"This report examines the following non-required fields:"
"RTN","ENH6928M",133,0)
 W !,"     FUNCTION (#2.6)"
"RTN","ENH6928M",134,0)
 W !,"     NET SQUARE FEET (#4.5)"
"RTN","ENH6928M",135,0)
 S L=L+4
"RTN","ENH6928M",136,0)
 I L+6>IOSL D HDR^ENH6928U Q:ABORT
"RTN","ENH6928M",137,0)
 W !!,"The report is sorted by division. When printing or viewing this report, you"
"RTN","ENH6928M",138,0)
 W !,"may select a single division or ALL. Select ""ZZ no division"" to display the"
"RTN","ENH6928M",139,0)
 W !,"records with no entry in the DIVISION (#.6) field."
"RTN","ENH6928M",140,0)
 S L=L+4
"RTN","ENH6928M",141,0)
 I L+4>IOSL D HDR^ENH6928U Q:ABORT
"RTN","ENH6928M",142,0)
 W !!,"The totals for each division are as follows:"
"RTN","ENH6928M",143,0)
 S L=L+2
"RTN","ENH6928M",144,0)
 I L+5>IOSL D HDR^ENH6928U Q:ABORT
"RTN","ENH6928M",145,0)
 W !!,"Total records analyzed - number of records in the ENG SPACE (#6928) file"
"RTN","ENH6928M",146,0)
 W !,"     assigned to the division"
"RTN","ENH6928M",147,0)
 S L=L+3
"RTN","ENH6928M",148,0)
 I L+5>IOSL D HDR^ENH6928U Q:ABORT
"RTN","ENH6928M",149,0)
 W !!,"Total records with Non-Required Fields Missing Data - number of records"
"RTN","ENH6928M",150,0)
 W !,"     that have one or more empty non-required fields"
"RTN","ENH6928M",151,0)
 S L=L+3
"RTN","ENH6928M",152,0)
 I L+5>IOSL D HDR^ENH6928U Q:ABORT
"RTN","ENH6928M",153,0)
 W !!,"Total fields with Non-Required Fields Missing Data - number of non-required"
"RTN","ENH6928M",154,0)
 W !,"     fields that are empty"
"RTN","ENH6928M",155,0)
 S L=L+3
"RTN","ENH6928M",156,0)
 I L+5>IOSL D HDR^ENH6928U Q:ABORT
"RTN","ENH6928M",157,0)
 W !!,"The report then lists each record in order by its internal entry number (IEN)."
"RTN","ENH6928M",158,0)
 W !,"Each row on the report contains the following columns:"
"RTN","ENH6928M",159,0)
 S L=L+3
"RTN","ENH6928M",160,0)
 I L+8>IOSL D HDR^ENH6928U Q:ABORT
"RTN","ENH6928M",161,0)
 W !!,"REC IEN - lists the ENG SPACE (#6928) file internal record number"
"RTN","ENH6928M",162,0)
 W !!,"ROOM NUMBER - name or number of the record (#.01 field)"
"RTN","ENH6928M",163,0)
 W !!,"FIELD NAME - name of the non-required field"
"RTN","ENH6928M",164,0)
 S L=L+6
"RTN","ENH6928M",165,0)
 I L+5>IOSL D HDR^ENH6928U Q:ABORT
"RTN","ENH6928M",166,0)
 W !!,"You should correct every field that appears on this report prior to conversion."
"RTN","ENH6928M",167,0)
 W !,"Use AEMS/MERS to enter a valid value in each empty field listed. You may"
"RTN","ENH6928M",168,0)
 W !,"correct the FUNCTION or NET SQ. FT. field by selecting the associated record"
"RTN","ENH6928M",169,0)
 W !,"in the AEMS/MERS' Enter New Room Space Data [ENSPROOM] option and entering"
"RTN","ENH6928M",170,0)
 W !,"valid data for the field that is empty."
"RTN","ENH6928M",171,0)
 S L=L+4
"RTN","ENH6928M",172,0)
 I L+12>IOSL D HDR^ENH6928U Q:ABORT
"RTN","ENH6928M",173,0)
 W !!,"*** Conversion Note *********************************************"
"RTN","ENH6928M",174,0)
 W !,"If these non-required fields are left empty, the following will"
"RTN","ENH6928M",175,0)
 W !,"occur during the CoreFLS conversion:"
"RTN","ENH6928M",176,0)
 W !!,"   FUNCTION (#2.6) - will be converted as empty"
"RTN","ENH6928M",177,0)
 W !!,"   NET SQ.FT. (#4.5) - will be defaulted to 0 (zero)"
"RTN","ENH6928M",178,0)
 W !,"******************************************************************"
"RTN","ENH6928M",179,0)
 W !!,"<End of Instructions>" I $E(IOST,1,2)="C-" W "  Enter RETURN to continue or '^' to exit: " R Y:DTIME I '$T!(Y[U) S ABORT=1 Q
"RTN","ENH6928M",180,0)
 W @IOF
"RTN","ENH6928M",181,0)
 K Y,P,L,ENHDR,ENHDR1
"RTN","ENH6928M",182,0)
 Q
"RTN","ENH6928P")
0^3^B31757158
"RTN","ENH6928P",1,0)
ENH6928P ;WOIFO/EEN - Engineering Space Report Print (AMES/MERS) - CoreFLS ;10/01/03 15:15
"RTN","ENH6928P",2,0)
 ;;7.0;Engineering;**77**;Aug 17,1993
"RTN","ENH6928P",3,0)
 ;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","ENH6928P",4,0)
 ;
"RTN","ENH6928P",5,0)
 ; This routine prints Summary and Detailed Reports for the
"RTN","ENH6928P",6,0)
 ; Engineering Space File (#6928)
"RTN","ENH6928P",7,0)
 ;
"RTN","ENH6928P",8,0)
 Q  ;This routine is not callable from the top
"RTN","ENH6928P",9,0)
 ;
"RTN","ENH6928P",10,0)
INIT ; Initialize Variables
"RTN","ENH6928P",11,0)
 S (P,L,ABORT,ENFLG,TOTANA,CRITREC,BPTREC,DESREC,CRITNUM,BPTNUM,DESNUM)=0
"RTN","ENH6928P",12,0)
 S (CHKTYP,FLDNAME,FLDNUM,RMCRIT,BFPCRIT,BFPBPT,FUNDES,FUNBPT)=""
"RTN","ENH6928P",13,0)
 S (DIV,SERVBPT,KEYBPT,HBPT,UTLBPT,UIEN,NSFDES)=""
"RTN","ENH6928P",14,0)
 K ENHDR1
"RTN","ENH6928P",15,0)
 Q
"RTN","ENH6928P",16,0)
 ;
"RTN","ENH6928P",17,0)
OPT1 ; Print Summary Report
"RTN","ENH6928P",18,0)
 I ENHINST=1 D PRT1^ENH6928I Q:ABORT
"RTN","ENH6928P",19,0)
 I '$D(^TMP("ENH6928",$J)) D ^ENH6928L
"RTN","ENH6928P",20,0)
 D INIT
"RTN","ENH6928P",21,0)
 S ENHDR="SUMMARY"
"RTN","ENH6928P",22,0)
 I ENHDIVFG="ALL" D
"RTN","ENH6928P",23,0)
 . S ENHDIV=" for ALL Divisions",DIVI=""
"RTN","ENH6928P",24,0)
 . F  S DIVI=$O(^TMP("ENH6928",$J,"DIV",DIVI)) Q:DIVI=""!(ENFLG=1)  D
"RTN","ENH6928P",25,0)
 .. S DIV=^TMP("ENH6928",$J,"DIV",DIVI)
"RTN","ENH6928P",26,0)
 .. D L1
"RTN","ENH6928P",27,0)
 I ENHDIVFG'="ALL" D
"RTN","ENH6928P",28,0)
 . S ENHDIV=" for "_ENHDIVFG_" Division"
"RTN","ENH6928P",29,0)
 . S DIV=^TMP("ENH6928",$J,"DIV",ENHDIVFG)
"RTN","ENH6928P",30,0)
 . D L1
"RTN","ENH6928P",31,0)
 D EORT^ENH6928U
"RTN","ENH6928P",32,0)
 K DIVI
"RTN","ENH6928P",33,0)
 Q
"RTN","ENH6928P",34,0)
L1 U IO
"RTN","ENH6928P",35,0)
 D HDR^ENH6928U
"RTN","ENH6928P",36,0)
 I ABORT S ENFLG=1 Q
"RTN","ENH6928P",37,0)
 S TOTANA=$P($G(^TMP("ENH6928",$J,DIV,"SUM")),U)
"RTN","ENH6928P",38,0)
 S CRITREC=$P($G(^TMP("ENH6928",$J,DIV,"SUM")),U,2)
"RTN","ENH6928P",39,0)
 S BPTREC=$P($G(^TMP("ENH6928",$J,DIV,"SUM")),U,3)
"RTN","ENH6928P",40,0)
 S DESREC=$P($G(^TMP("ENH6928",$J,DIV,"SUM")),U,4)
"RTN","ENH6928P",41,0)
 S RMCRIT=^TMP("ENH6928",$J,DIV,"CRIT",.01)
"RTN","ENH6928P",42,0)
 S BFPCRIT=^TMP("ENH6928",$J,DIV,"CRIT",.51)
"RTN","ENH6928P",43,0)
 S BFPBPT=^TMP("ENH6928",$J,DIV,"BPT",.51)
"RTN","ENH6928P",44,0)
 S FUNBPT=^TMP("ENH6928",$J,DIV,"BPT",2.6)
"RTN","ENH6928P",45,0)
 S SERVBPT=^TMP("ENH6928",$J,DIV,"BPT",1.5)
"RTN","ENH6928P",46,0)
 S KEYBPT=^TMP("ENH6928",$J,DIV,"BPT",2)
"RTN","ENH6928P",47,0)
 S HBPT=^TMP("ENH6928",$J,DIV,"BPT",4.9)
"RTN","ENH6928P",48,0)
 S UTLBPT=^TMP("ENH6928",$J,DIV,"BPT",14)
"RTN","ENH6928P",49,0)
 S FUNDES=^TMP("ENH6928",$J,DIV,"DES",2.6)
"RTN","ENH6928P",50,0)
 S NSFDES=^TMP("ENH6928",$J,DIV,"DES",4.5)
"RTN","ENH6928P",51,0)
 D SHDR^ENH6928H,SUMC^ENH6928H
"RTN","ENH6928P",52,0)
 W !,"REQ, INV",?15,"Bldg File Ptr",?35
"RTN","ENH6928P",53,0)
 W $J(BFPCRIT,5),?52,$J(BFPBPT,5),?69,$J("N/A",5)
"RTN","ENH6928P",54,0)
 W !,"INV, NREQ",?15,"Function",?35
"RTN","ENH6928P",55,0)
 W $J("N/A",5),?52,$J(FUNBPT,5),?69,$J(FUNDES,5)
"RTN","ENH6928P",56,0)
 ;W !,"REQ, INV",?15,"Function",?35,FUNCRIT,?52,FUNBPT,?69,"N/A"
"RTN","ENH6928P",57,0)
 W !,"INV",?15,"H-08-9 Crit",?35
"RTN","ENH6928P",58,0)
 W $J("N/A",5),?52,$J(HBPT,5),?69,$J("N/A",5)
"RTN","ENH6928P",59,0)
 W !,"INV",?15,"Key",?35
"RTN","ENH6928P",60,0)
 W $J("N/A",5),?52,$J(KEYBPT,5),?69,$J("N/A",5)
"RTN","ENH6928P",61,0)
 W !,"NREQ",?15,"Net Sq. Ft.",?35
"RTN","ENH6928P",62,0)
 W $J("N/A",5),?52,$J("N/A",5),?69,$J(NSFDES,5)
"RTN","ENH6928P",63,0)
 W !,"REQ",?15,"Room Number",?35
"RTN","ENH6928P",64,0)
 W $J(RMCRIT,5),?52,$J("N/A",5),?69,$J("N/A",5)
"RTN","ENH6928P",65,0)
 W !,"INV",?15,"Service",?35
"RTN","ENH6928P",66,0)
 W $J("N/A",5),?52,$J(SERVBPT,5),?69,$J("N/A",5)
"RTN","ENH6928P",67,0)
 W !,"INV",?15,"Utilities",?35
"RTN","ENH6928P",68,0)
 W $J("N/A",5),?52,$J(UTLBPT,5),?69,$J("N/A",5)
"RTN","ENH6928P",69,0)
 S L=L+8
"RTN","ENH6928P",70,0)
 I ENHDIVFG'="ALL" S ENFLG=1 ; Stop print if single division is picked
"RTN","ENH6928P",71,0)
 Q
"RTN","ENH6928P",72,0)
 ;
"RTN","ENH6928P",73,0)
OPT2 ; Required Fields Missing Data Report
"RTN","ENH6928P",74,0)
 I ENHINST=1 D PRT2^ENH6928U Q:ABORT
"RTN","ENH6928P",75,0)
 I '$D(^TMP("ENH6928",$J))!('$D(^TMP("ENH6928R",$J))) D ^ENH6928L
"RTN","ENH6928P",76,0)
 D INIT
"RTN","ENH6928P",77,0)
 S TYP="CRIT"
"RTN","ENH6928P",78,0)
 S ENHDR="REQUIRED FIELDS MISSING DATA"
"RTN","ENH6928P",79,0)
 G PRT
"RTN","ENH6928P",80,0)
 Q
"RTN","ENH6928P",81,0)
 ;
"RTN","ENH6928P",82,0)
OPT3 ; Lookup Fields with Invalid Data Report
"RTN","ENH6928P",83,0)
 I ENHINST=1 D PRT3^ENH6928M Q:ABORT
"RTN","ENH6928P",84,0)
 I '$D(^TMP("ENH6928",$J))!('$D(^TMP("ENH6928R",$J))) D ^ENH6928L
"RTN","ENH6928P",85,0)
 D INIT
"RTN","ENH6928P",86,0)
 S TYP="BPT"
"RTN","ENH6928P",87,0)
 S ENHDR="LOOKUP FIELDS W/ INVALID DATA"
"RTN","ENH6928P",88,0)
 G PRT
"RTN","ENH6928P",89,0)
 Q
"RTN","ENH6928P",90,0)
 ;
"RTN","ENH6928P",91,0)
OPT4 ; Non-Required Fields Missing Data Report
"RTN","ENH6928P",92,0)
 I ENHINST=1 D PRT4^ENH6928M Q:ABORT
"RTN","ENH6928P",93,0)
 I '$D(^TMP("ENH6928",$J))!('$D(^TMP("ENH6928R",$J))) D ^ENH6928L
"RTN","ENH6928P",94,0)
 D INIT
"RTN","ENH6928P",95,0)
 S TYP="DES"
"RTN","ENH6928P",96,0)
 S ENHDR="NON-REQUIRED FIELDS MISSING DATA"
"RTN","ENH6928P",97,0)
 G PRT
"RTN","ENH6928P",98,0)
 Q
"RTN","ENH6928P",99,0)
PRT ; Start printing detailed reports by division
"RTN","ENH6928P",100,0)
 I ENHDIVFG="ALL" D
"RTN","ENH6928P",101,0)
 . S ENHDIV=" for ALL Divisions",DIVI=""
"RTN","ENH6928P",102,0)
 . F  S DIVI=$O(^TMP("ENH6928",$J,"DIV",DIVI)) Q:DIVI=""!(ENFLG=1)  D
"RTN","ENH6928P",103,0)
 .. S DIV=^TMP("ENH6928",$J,"DIV",DIVI)
"RTN","ENH6928P",104,0)
 .. D LOOP
"RTN","ENH6928P",105,0)
 I ENHDIVFG'="ALL" D
"RTN","ENH6928P",106,0)
 . S ENHDIV=" for "_ENHDIVFG_" Division"
"RTN","ENH6928P",107,0)
 . S DIV=^TMP("ENH6928",$J,"DIV",ENHDIVFG)
"RTN","ENH6928P",108,0)
 . D LOOP
"RTN","ENH6928P",109,0)
 D EORT^ENH6928U
"RTN","ENH6928P",110,0)
 K DIVI,TYP
"RTN","ENH6928P",111,0)
 Q
"RTN","ENH6928P",112,0)
 ;
"RTN","ENH6928P",113,0)
LOOP ; Loop to print regular fields
"RTN","ENH6928P",114,0)
 U IO
"RTN","ENH6928P",115,0)
 Q:TYP=""
"RTN","ENH6928P",116,0)
 S TOTANA=$P($G(^TMP("ENH6928",$J,DIV,"SUM")),U)
"RTN","ENH6928P",117,0)
 I TYP="CRIT" S RECANA=$P($G(^TMP("ENH6928",$J,DIV,"SUM")),U,2)
"RTN","ENH6928P",118,0)
 I TYP="BPT" S RECANA=$P($G(^TMP("ENH6928",$J,DIV,"SUM")),U,3)
"RTN","ENH6928P",119,0)
 I TYP="DES" S RECANA=$P($G(^TMP("ENH6928",$J,DIV,"SUM")),U,4)
"RTN","ENH6928P",120,0)
 S FLDANA=^TMP("ENH6928",$J,DIV,TYP)
"RTN","ENH6928P",121,0)
 D HDR^ENH6928U
"RTN","ENH6928P",122,0)
 I ABORT S ENFLG=1 Q
"RTN","ENH6928P",123,0)
 I TYP="CRIT" D CHDR^ENH6928H,NOMULT^ENH6928H
"RTN","ENH6928P",124,0)
 I TYP="BPT" D BHDR^ENH6928H,DETC^ENH6928H
"RTN","ENH6928P",125,0)
 I TYP="DES" D DHDR^ENH6928H,NOMULT^ENH6928H
"RTN","ENH6928P",126,0)
 I FLDANA=0&(RECANA=0) D  Q
"RTN","ENH6928P",127,0)
 . W !!,"**NO DATA TO PRINT**",!
"RTN","ENH6928P",128,0)
 . S L=L+3
"RTN","ENH6928P",129,0)
 . I ENHDIVFG'="ALL" S ENFLG=1
"RTN","ENH6928P",130,0)
 S RECIEN=0
"RTN","ENH6928P",131,0)
 F  S RECIEN=$O(^TMP("ENH6928R",$J,DIV,TYP,RECIEN)) Q:'RECIEN!(ENFLG=1)  D
"RTN","ENH6928P",132,0)
 . S FLD=0
"RTN","ENH6928P",133,0)
 . F  S FLD=$O(^TMP("ENH6928R",$J,DIV,TYP,RECIEN,FLD)) Q:'FLD!(ENFLG=1)  D
"RTN","ENH6928P",134,0)
 .. I FLD=14 D MULT Q
"RTN","ENH6928P",135,0)
 .. S RMNUM=$P(^TMP("ENH6928R",$J,DIV,TYP,RECIEN,FLD),U,2)
"RTN","ENH6928P",136,0)
 .. S FLDNAME=$P(^TMP("ENH6928R",$J,DIV,TYP,RECIEN,FLD),U,3)
"RTN","ENH6928P",137,0)
 .. S FLDNUM=$P(^TMP("ENH6928R",$J,DIV,TYP,RECIEN,FLD),U,4)
"RTN","ENH6928P",138,0)
 .. W !,$J(RECIEN,8),?10,RMNUM,?45,FLDNAME
"RTN","ENH6928P",139,0)
 .. S L=L+1
"RTN","ENH6928P",140,0)
 .. I L+3>IOSL D  Q:ABORT
"RTN","ENH6928P",141,0)
 ... D HDR^ENH6928U I ABORT S ENFLG=1 Q
"RTN","ENH6928P",142,0)
 ... I TYP="BPT" D SUB^ENH6928H,DETC^ENH6928H
"RTN","ENH6928P",143,0)
 ... E  D SUB^ENH6928H,NOMULT^ENH6928H
"RTN","ENH6928P",144,0)
 I ENHDIVFG'="ALL" S ENFLG=1 ; Stop Print if single division is picked
"RTN","ENH6928P",145,0)
 Q
"RTN","ENH6928P",146,0)
 ;
"RTN","ENH6928P",147,0)
MULT ; Loop to print Multiples
"RTN","ENH6928P",148,0)
 ;
"RTN","ENH6928P",149,0)
 Q:TYP=""
"RTN","ENH6928P",150,0)
 S MULTIEN=0
"RTN","ENH6928P",151,0)
 F  S MULTIEN=$O(^TMP("ENH6928R",$J,DIV,TYP,RECIEN,FLD,MULTIEN)) Q:'MULTIEN!(ENFLG=1)  D
"RTN","ENH6928P",152,0)
 . S NAME=$P(^TMP("ENH6928R",$J,DIV,TYP,RECIEN,FLD,MULTIEN),U,2)
"RTN","ENH6928P",153,0)
 . S FLDNAME=$P(^TMP("ENH6928R",$J,DIV,TYP,RECIEN,FLD,MULTIEN),U,3)
"RTN","ENH6928P",154,0)
 . S SFIEN=$P(^TMP("ENH6928R",$J,DIV,TYP,RECIEN,FLD,MULTIEN),U,5)
"RTN","ENH6928P",155,0)
 . W !,$J(RECIEN,8),?10,NAME,?45,FLDNAME,?68,$J(SFIEN,3)
"RTN","ENH6928P",156,0)
 . S L=L+1
"RTN","ENH6928P",157,0)
 . I L+3>IOSL D  Q:ABORT
"RTN","ENH6928P",158,0)
 .. D HDR^ENH6928U I ABORT S ENFLG=1 Q
"RTN","ENH6928P",159,0)
 .. I TYP="BPT" D SUB^ENH6928H,DETC^ENH6928H
"RTN","ENH6928P",160,0)
 .. E  D SUB^ENH6928H,NOMULT^ENH6928H
"RTN","ENH6928P",161,0)
 K MULTIEN
"RTN","ENH6928P",162,0)
 Q
"RTN","ENH6928U")
0^4^B48115911
"RTN","ENH6928U",1,0)
ENH6928U ;WOIFO/EEN - Engineering Space Report Utilities (AMES/MERS) - CoreFLS ;10/01/03 15:15
"RTN","ENH6928U",2,0)
 ;;7.0;Engineering;**77**;Aug 17,1993
"RTN","ENH6928U",3,0)
 ;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","ENH6928U",4,0)
 ;
"RTN","ENH6928U",5,0)
HDR ; Print the standard report header.
"RTN","ENH6928U",6,0)
 ; Do not ask 'RETURN' before first page on CRT.
"RTN","ENH6928U",7,0)
 I $E(IOST,1,2)="C-",P R !!,"Enter RETURN to continue or '^' to exit: ",Y:DTIME I '$T!(Y[U) S ABORT=1 Q
"RTN","ENH6928U",8,0)
 ; Do not print a form feed before first page on printer.
"RTN","ENH6928U",9,0)
 ; Top of form is set at end of previous report.
"RTN","ENH6928U",10,0)
 I $E(IOST,1,2)="C-"!P W @IOF
"RTN","ENH6928U",11,0)
 S P=P+1,L=4
"RTN","ENH6928U",12,0)
 W !,"ENG SPACE (#6928) - "_$G(ENHDR),?67,"Page: ",$J(P,5,0)
"RTN","ENH6928U",13,0)
 W !,"CoreFLS Data Cleansing Report ",$G(ENHDR1),?58,"Printed: ",$$FMTE^XLFDT(DT)
"RTN","ENH6928U",14,0)
 Q
"RTN","ENH6928U",15,0)
 ;
"RTN","ENH6928U",16,0)
EORT ; Report completed
"RTN","ENH6928U",17,0)
 I 'ABORT D
"RTN","ENH6928U",18,0)
 . W !!,"<End of Report>"
"RTN","ENH6928U",19,0)
 . I $E(IOST,1,2)="C-" W " Enter RETURN to continue " R Y:DTIME
"RTN","ENH6928U",20,0)
 I ABORT W !!,"<Report Aborted>"
"RTN","ENH6928U",21,0)
 D ^%ZISC
"RTN","ENH6928U",22,0)
 K L,P,X,Y,ABORT
"RTN","ENH6928U",23,0)
 I $D(ZTQUEUED) S ZTREQ="@"
"RTN","ENH6928U",24,0)
 Q
"RTN","ENH6928U",25,0)
 ;
"RTN","ENH6928U",26,0)
INST ; Print Instructions for Summary Report
"RTN","ENH6928U",27,0)
 ;
"RTN","ENH6928U",28,0)
 ;  Variables:
"RTN","ENH6928U",29,0)
 ;    ENHRPT = Type of report
"RTN","ENH6928U",30,0)
 ;           1 - Summary Report
"RTN","ENH6928U",31,0)
 ;           2 - Required Fields Missing Data Report
"RTN","ENH6928U",32,0)
 ;           3 - Lookup Fields w/ Invalid Data Report
"RTN","ENH6928U",33,0)
 ;           4 - Non-Required Fields Missing Data Report
"RTN","ENH6928U",34,0)
 ;
"RTN","ENH6928U",35,0)
 D HOME^%ZIS
"RTN","ENH6928U",36,0)
 K DIR
"RTN","ENH6928U",37,0)
 S DIR(0)="Y"
"RTN","ENH6928U",38,0)
 S DIR("A")="Do you wish to print the instructions for this report"
"RTN","ENH6928U",39,0)
 S DIR("A",1)=" "
"RTN","ENH6928U",40,0)
 S DIR("B")="NO"
"RTN","ENH6928U",41,0)
 S DIR("?")="Please enter Y to print the instructions or N to skip the instructions"
"RTN","ENH6928U",42,0)
 D ^DIR K DIR
"RTN","ENH6928U",43,0)
 I Y[U!(Y="")!$D(DTOUT)!$D(DUOUT) S ABORT=1 Q
"RTN","ENH6928U",44,0)
 S ENHINST=Y
"RTN","ENH6928U",45,0)
 Q
"RTN","ENH6928U",46,0)
 ;
"RTN","ENH6928U",47,0)
PRT2 ; Print Instructions for Required Fields Missing Data Report
"RTN","ENH6928U",48,0)
 ;
"RTN","ENH6928U",49,0)
 S (P,L,ABORT)=0
"RTN","ENH6928U",50,0)
 S ENHDR="REQUIRED FIELDS MISSING DATA"
"RTN","ENH6928U",51,0)
 S ENHDR1="Instructions"
"RTN","ENH6928U",52,0)
 U IO
"RTN","ENH6928U",53,0)
 D HDR
"RTN","ENH6928U",54,0)
 W !!,"The purpose of this report is to display a list of all ENG SPACE (#6928) items"
"RTN","ENH6928U",55,0)
 W !,"with missing (empty) data for the fields that are required in the CoreFLS"
"RTN","ENH6928U",56,0)
 W !,"system. CoreFLS is unable to function when a required field is empty;"
"RTN","ENH6928U",57,0)
 W !,"therefore, you must enter valid data in these fields prior to conversion."
"RTN","ENH6928U",58,0)
 S L=L+5
"RTN","ENH6928U",59,0)
 I L+9>IOSL D HDR^ENH6928U Q:ABORT
"RTN","ENH6928U",60,0)
 W !!,"This report examines the following required fields:"
"RTN","ENH6928U",61,0)
 W !,"NOTE: Abbreviations for field names used on this report appear in quotes next"
"RTN","ENH6928U",62,0)
 W !,"to the field number"
"RTN","ENH6928U",63,0)
 W !!,"     ROOM NUMBER (#.01)"
"RTN","ENH6928U",64,0)
 W !,"     BUILDING FILE POINTER (#.51) - ""Bldg File Ptr"""
"RTN","ENH6928U",65,0)
 S L=L+7
"RTN","ENH6928U",66,0)
 I L+6>IOSL D HDR^ENH6928U Q:ABORT
"RTN","ENH6928U",67,0)
 W !!,"The report is sorted by division. When printing or viewing this report, you"
"RTN","ENH6928U",68,0)
 W !,"may select a single division or ALL. Select ""ZZ no division"" to display the"
"RTN","ENH6928U",69,0)
 W !,"records with no entry in the DIVISION (#.6) field."
"RTN","ENH6928U",70,0)
 S L=L+4
"RTN","ENH6928U",71,0)
 I L+4>IOSL D HDR^ENH6928U Q:ABORT
"RTN","ENH6928U",72,0)
 W !!,"The totals for each division are as follows:"
"RTN","ENH6928U",73,0)
 S L=L+2
"RTN","ENH6928U",74,0)
 I L+5>IOSL D HDR^ENH6928U Q:ABORT
"RTN","ENH6928U",75,0)
 W !!,"Total records analyzed - number of records in the ENG SPACE (#6928) file"
"RTN","ENH6928U",76,0)
 W !,"     assigned to the division"
"RTN","ENH6928U",77,0)
 S L=L+3
"RTN","ENH6928U",78,0)
 I L+5>IOSL D HDR^ENH6928U Q:ABORT
"RTN","ENH6928U",79,0)
 W !!,"Total records with Required Fields Missing Data - number of records that have"
"RTN","ENH6928U",80,0)
 W !,"     one or more empty required fields"
"RTN","ENH6928U",81,0)
 S L=L+3
"RTN","ENH6928U",82,0)
 I L+5>IOSL D HDR^ENH6928U Q:ABORT
"RTN","ENH6928U",83,0)
 W !!,"Total fields with Required Fields Missing Data - number of required fields"
"RTN","ENH6928U",84,0)
 W !,"     that are empty"
"RTN","ENH6928U",85,0)
 S L=L+3
"RTN","ENH6928U",86,0)
 I L+5>IOSL D HDR^ENH6928U Q:ABORT
"RTN","ENH6928U",87,0)
 W !!,"The report then lists each record in order by its internal entry number (IEN)."
"RTN","ENH6928U",88,0)
 W !,"Each row on the report contains the following columns:"
"RTN","ENH6928U",89,0)
 S L=L+3
"RTN","ENH6928U",90,0)
 I L+4>IOSL D HDR^ENH6928U Q:ABORT
"RTN","ENH6928U",91,0)
 W !!,"REC IEN - lists the ENG SPACE (#6928) file internal record number"
"RTN","ENH6928U",92,0)
 S L=L+2
"RTN","ENH6928U",93,0)
 I L+4>IOSL D HDR^ENH6928U Q:ABORT
"RTN","ENH6928U",94,0)
 W !!,"ROOM NUMBER - name or number of the record (#.01 field)"
"RTN","ENH6928U",95,0)
 S L=L+2
"RTN","ENH6928U",96,0)
 I L+4>IOSL D HDR^ENH6928U Q:ABORT
"RTN","ENH6928U",97,0)
 W !!,"FIELD NAME - name or abbreviation of the required field"
"RTN","ENH6928U",98,0)
 S L=L+2
"RTN","ENH6928U",99,0)
 I L+5>IOSL D HDR^ENH6928U Q:ABORT
"RTN","ENH6928U",100,0)
 W !!,"You must correct every field that appears on this report prior to conversion."
"RTN","ENH6928U",101,0)
 W !,"Use AEMS/MERS to enter a valid value in each empty field listed."
"RTN","ENH6928U",102,0)
 S L=L+3
"RTN","ENH6928U",103,0)
 I L+8>IOSL D HDR^ENH6928U Q:ABORT
"RTN","ENH6928U",104,0)
 W !!,"*** Special Note on ROOM NUMBER *********************************"
"RTN","ENH6928U",105,0)
 W !,"To correct the ROOM NUMBER (#.01) field's value, select the record"
"RTN","ENH6928U",106,0)
 W !,"using the Enter New Room Space Data [ENSPROOM] option in AEMS/MERS"
"RTN","ENH6928U",107,0)
 W !,"then edit the field."
"RTN","ENH6928U",108,0)
 W !,"******************************************************************"
"RTN","ENH6928U",109,0)
 S L=L+6
"RTN","ENH6928U",110,0)
 I L+9>IOSL D HDR Q:ABORT
"RTN","ENH6928U",111,0)
 W !!,"*** Special Note on BUILDING FILE POINTER ***********************"
"RTN","ENH6928U",112,0)
 W !,"You cannot correct the BUILDING FILE POINTER (#.51) field using"
"RTN","ENH6928U",113,0)
 W !,"data entry in AEMS/MERS or in an editing session of VA FileMan."
"RTN","ENH6928U",114,0)
 W !,"This field is triggered-in when you enter or edit a value in the"
"RTN","ENH6928U",115,0)
 W !,"ROOM NUMBER (#.01) field. The ROOM NUMBER format consists of:"
"RTN","ENH6928U",116,0)
 W !,"      [room number]-[wing/building]-[division]"
"RTN","ENH6928U",117,0)
 S L=L+7
"RTN","ENH6928U",118,0)
 I L+10>IOSL D HDR Q:ABORT
"RTN","ENH6928U",119,0)
 W !!,"Two methods are available to correct records missing a value in"
"RTN","ENH6928U",120,0)
 W !,"the BUILDING FILE POINTER:"
"RTN","ENH6928U",121,0)
 W !!,"  1. You may select the record in AEMS/MERS or VA FileMan and"
"RTN","ENH6928U",122,0)
 W !,"     re-type the ROOM NUMBER (#.01) to recreate the BUILDING FILE"
"RTN","ENH6928U",123,0)
 W !,"     POINTER. DO NOT ACCEPT the default value by pressing <Enter>."
"RTN","ENH6928U",124,0)
 W !,"     You must re-type the entire room number value."
"RTN","ENH6928U",125,0)
 S L=L+8
"RTN","ENH6928U",126,0)
 I L+10>IOSL D HDR Q:ABORT
"RTN","ENH6928U",127,0)
 W !!,"  2. You may request that the IRM or ADPAC re-index the 'AF'"
"RTN","ENH6928U",128,0)
 W !,"     cross-reference in VA FileMan on the ROOM NUMBER (#.01) field"
"RTN","ENH6928U",129,0)
 W !,"     to recreate the BUILDING FILE POINTER."
"RTN","ENH6928U",130,0)
 W !!,"If you have any difficulties contact the IRM or ADPAC for"
"RTN","ENH6928U",131,0)
 W !,"assistance."
"RTN","ENH6928U",132,0)
 W !,"******************************************************************"
"RTN","ENH6928U",133,0)
 S L=L+8
"RTN","ENH6928U",134,0)
 I L+15>IOSL D HDR Q:ABORT
"RTN","ENH6928U",135,0)
 W !!,"*** Conversion Note *********************************************"
"RTN","ENH6928U",136,0)
 W !,"If the required fields are left empty, the following will occur"
"RTN","ENH6928U",137,0)
 W !,"during CoreFLS conversion:"
"RTN","ENH6928U",138,0)
 W !!,"   ROOM NUMBER (#.01) - the record will not be converted"
"RTN","ENH6928U",139,0)
 W !!,"   BUILDING FILE POINTER (#.51) - the record will not be"
"RTN","ENH6928U",140,0)
 W !,"                                  converted and will also not be"
"RTN","ENH6928U",141,0)
 W !,"                                  included in the LOCATION"
"RTN","ENH6928U",142,0)
 W !,"                                  hierarchy"
"RTN","ENH6928U",143,0)
 W !,"******************************************************************"
"RTN","ENH6928U",144,0)
 W !!,"<End of Instructions>" I $E(IOST,1,2)="C-" W "  Enter RETURN to continue or '^' to exit: " R Y:DTIME I '$T!(Y[U) S ABORT=1 Q
"RTN","ENH6928U",145,0)
 W @IOF
"RTN","ENH6928U",146,0)
 K Y,L,P,ENHDR,ENHDR1
"RTN","ENH6928U",147,0)
 Q
"VER")
8.0^22
**END**
**END**
