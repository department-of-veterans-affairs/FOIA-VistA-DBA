Released PRC*5.1*70 SEQ #65
Extracted from mail message
**KIDS**:PRC*5.1*70^

**INSTALL NAME**
PRC*5.1*70
"BLD",3453,0)
PRC*5.1*70^IFCAP^0^3031203^y
"BLD",3453,1,0)
^^1^1^3031203^^^
"BLD",3453,1,1,0)
UNDEFINED VARIABLE 'LNCT'/INVALID CLASSIFICATION OF REQUEST
"BLD",3453,4,0)
^9.64PA^^
"BLD",3453,"ABPKG")
n
"BLD",3453,"KRN",0)
^9.67PA^8989.52^19
"BLD",3453,"KRN",.4,0)
.4
"BLD",3453,"KRN",.4,"NM",0)
^9.68A^^
"BLD",3453,"KRN",.401,0)
.401
"BLD",3453,"KRN",.401,"NM",0)
^9.68A^^
"BLD",3453,"KRN",.402,0)
.402
"BLD",3453,"KRN",.402,"NM",0)
^9.68A^^
"BLD",3453,"KRN",.403,0)
.403
"BLD",3453,"KRN",.403,"NM",0)
^9.68A^^
"BLD",3453,"KRN",.5,0)
.5
"BLD",3453,"KRN",.5,"NM",0)
^9.68A^^
"BLD",3453,"KRN",.84,0)
.84
"BLD",3453,"KRN",.84,"NM",0)
^9.68A^^
"BLD",3453,"KRN",3.6,0)
3.6
"BLD",3453,"KRN",3.6,"NM",0)
^9.68A^^
"BLD",3453,"KRN",3.8,0)
3.8
"BLD",3453,"KRN",3.8,"NM",0)
^9.68A^^
"BLD",3453,"KRN",9.2,0)
9.2
"BLD",3453,"KRN",9.2,"NM",0)
^9.68A^^
"BLD",3453,"KRN",9.8,0)
9.8
"BLD",3453,"KRN",9.8,"NM",0)
^9.68A^3^2
"BLD",3453,"KRN",9.8,"NM",2,0)
PRCHRPT1^^0^B44321172
"BLD",3453,"KRN",9.8,"NM",3,0)
PRCSD121^^0^B19939086
"BLD",3453,"KRN",9.8,"NM","B","PRCHRPT1",2)

"BLD",3453,"KRN",9.8,"NM","B","PRCSD121",3)

"BLD",3453,"KRN",19,0)
19
"BLD",3453,"KRN",19.1,0)
19.1
"BLD",3453,"KRN",101,0)
101
"BLD",3453,"KRN",409.61,0)
409.61
"BLD",3453,"KRN",771,0)
771
"BLD",3453,"KRN",870,0)
870
"BLD",3453,"KRN",8989.51,0)
8989.51
"BLD",3453,"KRN",8989.52,0)
8989.52
"BLD",3453,"KRN",8994,0)
8994
"BLD",3453,"KRN","B",.4,.4)

"BLD",3453,"KRN","B",.401,.401)

"BLD",3453,"KRN","B",.402,.402)

"BLD",3453,"KRN","B",.403,.403)

"BLD",3453,"KRN","B",.5,.5)

"BLD",3453,"KRN","B",.84,.84)

"BLD",3453,"KRN","B",3.6,3.6)

"BLD",3453,"KRN","B",3.8,3.8)

"BLD",3453,"KRN","B",9.2,9.2)

"BLD",3453,"KRN","B",9.8,9.8)

"BLD",3453,"KRN","B",19,19)

"BLD",3453,"KRN","B",19.1,19.1)

"BLD",3453,"KRN","B",101,101)

"BLD",3453,"KRN","B",409.61,409.61)

"BLD",3453,"KRN","B",771,771)

"BLD",3453,"KRN","B",870,870)

"BLD",3453,"KRN","B",8989.51,8989.51)

"BLD",3453,"KRN","B",8989.52,8989.52)

"BLD",3453,"KRN","B",8994,8994)

"BLD",3453,"QUES",0)
^9.62^^
"BLD",3453,"REQB",0)
^9.611^1^1
"BLD",3453,"REQB",1,0)
PRC*5.1*15^1
"BLD",3453,"REQB","B","PRC*5.1*15",1)

"MBREQ")
0
"PKG",455,-1)
1^1
"PKG",455,0)
IFCAP^PRC^IFCAP System Files
"PKG",455,20,0)
^9.402P^^
"PKG",455,22,0)
^9.49I^1^1
"PKG",455,22,1,0)
5.1^3001012^3001019^68
"PKG",455,22,1,"PAH",1,0)
70^3031203
"PKG",455,22,1,"PAH",1,1,0)
^^1^1^3031203
"PKG",455,22,1,"PAH",1,1,1,0)
UNDEFINED VARIABLE 'LNCT'/INVALID CLASSIFICATION OF REQUEST
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
2
"RTN","PRCHRPT1")
0^2^B44321172
"RTN","PRCHRPT1",1,0)
PRCHRPT1 ;ID/RSD,SF-ISC/TKW-PRINT OPTIONS ; [1/13/99 1:27pm]
"RTN","PRCHRPT1",2,0)
V ;;5.1;IFCAP;**15,70**;Oct 20, 2000
"RTN","PRCHRPT1",3,0)
 ;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","PRCHRPT1",4,0)
 ;
"RTN","PRCHRPT1",5,0)
EN ;DISPLAY ITEM HISTORY
"RTN","PRCHRPT1",6,0)
 S PRCF("X")="SP",AGN=1,LLCT=0,LNCT=0 D ^PRCFSITE
"RTN","PRCHRPT1",7,0)
EN0 Q:'$D(PRC("SITE"))  W !! S DIC="^PRC(441,",DIC(0)="QEAMNZ" D ^DIC G Q:Y<0 S D0=+Y I '$D(^(4,0)) W !,"History for this item does not yet exist.   Press <RETURN>" R X:DTIME G EN0
"RTN","PRCHRPT1",8,0)
 S PRCHQ="ITEM^PRCHRPT1",ITMY=Y(0) D RDTXS G:'$D(PRC("SITE")) Q D ^PRCHQUE K DIC,ZTSK,D0
"RTN","PRCHRPT1",9,0)
 G EN0
"RTN","PRCHRPT1",10,0)
 ;
"RTN","PRCHRPT1",11,0)
EN1 ;PRINT ITEM CATALOG
"RTN","PRCHRPT1",12,0)
 S PRCF("X")="SP" D ^PRCFSITE
"RTN","PRCHRPT1",13,0)
EN10 Q:'$D(PRC("SITE"))  K PRCHD S M="FUND CONTROL POINT",DIS(0)="I PRC(""SITE"")=$E($O(^PRC(441,D0,4,""B"",PRC(""SITE""))),1,3)" D RNG G Q:FR["^"!(TO["^") I FR["?"!(TO["?") D DSP^PRCHRPT2 G EN10
"RTN","PRCHRPT1",14,0)
 I FR S X=+FR D FX S FR=X
"RTN","PRCHRPT1",15,0)
 I TO S X=+TO D FX S TO=X
"RTN","PRCHRPT1",16,0)
 S FR=FR_",!",TO=TO_",z",DIC="^PRC(441,",FLDS="[PRCHITCAT]",BY="#@FCP,FCP,FCP,LONG NAME;"""",@$E(SHORT DESCRIPTION,1,50)" S L=0 D EN1^DIP
"RTN","PRCHRPT1",17,0)
 ;
"RTN","PRCHRPT1",18,0)
Q K FR,TO,FLDS,BY,DIC,I,J,K,L,PRC,PRCHFCP,D0,DA,M,DIS,ZTSK
"RTN","PRCHRPT1",19,0)
 K %,ABORT,DIR,FCPNO,FCPTCNT,FCPTPGS,FR1,FR2,FR3,FR4,ITMNO,ITMY,LCNT,LLIM,NXD,PRCHQ,PRCRI,PRCI,RTX,^TEMP("FCPCNT"),^TEMP("FCPDT"),^TEMP("FCPNAME"),^TEMP("FCPPGS"),TO1,TO2,TO3,TO4,TXCNT,TXFCP,TXIEN,TXR,TXS,TXSTN,X,Y
"RTN","PRCHRPT1",20,0)
 K AGN,C,DDH,SCTL,STN,ITMDESC,^TMP("PRCHRPT1",$J)
"RTN","PRCHRPT1",21,0)
 QUIT
"RTN","PRCHRPT1",22,0)
 ;
"RTN","PRCHRPT1",23,0)
FX I $D(^PRC(420,+PRC("SITE"),1,X,0)) S X=PRC("SITE")_$P($P(^(0),U,1)," ",1)
"RTN","PRCHRPT1",24,0)
 Q
"RTN","PRCHRPT1",25,0)
 ;
"RTN","PRCHRPT1",26,0)
ITEM S TXR=$G(^TMP("PRCHITMH",0)) S:'TXR TXR=10
"RTN","PRCHRPT1",27,0)
 S U="^" Q:'$D(^PRC(441,D0,0))  S W=$P(^(0),U,2),ASK=0,(W1,W(3),W(4))=0,W(2)="",PRC("SITE")=$S($D(PRC("SITE")):PRC("SITE"),1:0),W(1)=PRC("SITE")_0 K ^TMP("PRCHRPT1",$J)
"RTN","PRCHRPT1",28,0)
 F W(1)=W(1):0 Q:'$O(^PRC(441,D0,4,"B",W(1)))  S W(1)=$O(^PRC(441,D0,4,"B",W(1))) S PRCHFCP=$S($D(^PRC(420,PRC("SITE"),1,+$E(W(1),4,9),0)):$P(^(0),U,1),1:$E(W(1),4,9)) K ^TMP("PRCHRPT1",$J) D ITEM0 Q:ASK
"RTN","PRCHRPT1",29,0)
 K ASK,W,W1,DIC D:$D(ZTSK) KILL^%ZTLOAD K ZTSK
"RTN","PRCHRPT1",30,0)
 Q
"RTN","PRCHRPT1",31,0)
 ;
"RTN","PRCHRPT1",32,0)
ITEM0 I $D(^PRC(441,D0,4,W(1),1,"AC")) D
"RTN","PRCHRPT1",33,0)
 . S W(2)=""
"RTN","PRCHRPT1",34,0)
 . S W(3)=""
"RTN","PRCHRPT1",35,0)
 . S FLG=""
"RTN","PRCHRPT1",36,0)
 . S COUNT=""
"RTN","PRCHRPT1",37,0)
 . F  S W(3)=$O(^PRC(441,D0,4,W(1),1,"AC",W(3))) Q:W(3)'>0  Q:FLG=1  D
"RTN","PRCHRPT1",38,0)
 . . S W(4)=""
"RTN","PRCHRPT1",39,0)
 . . F  S W(4)=$O(^PRC(441,D0,4,W(1),1,"AC",W(3),W(4))) Q:W(4)'>0  D
"RTN","PRCHRPT1",40,0)
 . . . S ^TMP("PRCHRPT1",$J,(W(4)))=W(4)
"RTN","PRCHRPT1",41,0)
 . . . S COUNT=COUNT+1
"RTN","PRCHRPT1",42,0)
 . . . I COUNT=TXR S FLG=1 Q
"RTN","PRCHRPT1",43,0)
 . . . Q
"RTN","PRCHRPT1",44,0)
 . . Q
"RTN","PRCHRPT1",45,0)
 . Q
"RTN","PRCHRPT1",46,0)
 I '$D(^PRC(441,D0,4,W(1),1,"AC")) D  Q
"RTN","PRCHRPT1",47,0)
 . D HDR
"RTN","PRCHRPT1",48,0)
 . W !!,"FCP: "_PRCHFCP_" has no history for this item."
"RTN","PRCHRPT1",49,0)
 . Q
"RTN","PRCHRPT1",50,0)
NONE I $O(^TMP("PRCHRPT1",$J,0))="" W !,"A history for this item does not yet exist." D  Q
"RTN","PRCHRPT1",51,0)
 . I $G(ZTSK)'>0 W !,"Press RETURN to continue." R X:DTIME Q
"RTN","PRCHRPT1",52,0)
 I $G(LNCT)="" S LNCT=0
"RTN","PRCHRPT1",53,0)
 I LNCT=0 D HDR
"RTN","PRCHRPT1",54,0)
 I LNCT'=0,$E(IOST)="P" S LNCT=0  D HDR
"RTN","PRCHRPT1",55,0)
 I LNCT'=0,$E(IOST)'="P" D ASK Q:ASK  S LNCT=0 D HDR
"RTN","PRCHRPT1",56,0)
 ;
"RTN","PRCHRPT1",57,0)
SKPTXS S NX=0 I $G(LNCT)="" S LNCT=0
"RTN","PRCHRPT1",58,0)
 F K=1:1:TXR Q:'$O(^TMP("PRCHRPT1",$J,NX))  S NX=$O(^TMP("PRCHRPT1",$J,NX)),W(6)=^TMP("PRCHRPT1",$J,NX) Q:W(6)=""  S LNCT=LNCT+1,W(5)=0,W(5)=$O(^PRC(442,W(6),2,"AE",D0,W(5))) I W(5)'="" S W1=W1+1 D ITEM1 D CKLCT Q:ASK
"RTN","PRCHRPT1",59,0)
 I 'W1 K ^TMP("PRCHRPT1",$J) G NONE
"RTN","PRCHRPT1",60,0)
 Q
"RTN","PRCHRPT1",61,0)
 ;
"RTN","PRCHRPT1",62,0)
CKLCT I $E(IOST)'="P"&(LNCT=5) S LNCT=0 D ASK Q:ASK  D HDR:$O(^TMP("PRCHRPT1",$J,NX))
"RTN","PRCHRPT1",63,0)
 I $E(IOST)="P"&(LNCT=50) S LNCT=0 D ASK Q:ASK  D HDR:$O(^TMP("PRCHRPT1",$J,NX))
"RTN","PRCHRPT1",64,0)
 Q
"RTN","PRCHRPT1",65,0)
 ;
"RTN","PRCHRPT1",66,0)
ITEM1 W ! I $D(^PRC(442,W(6),1)),$P(^(1),U,15)'="" S Y=$P(^(1),U,15) D DD^%DT W Y
"RTN","PRCHRPT1",67,0)
 W ?15,$P(^PRC(442,W(6),0),U,1)
"RTN","PRCHRPT1",68,0)
 I $D(^PRC(442,W(6),2,W(5),2)) S W(7)=^(2) W ?26,$J($P(^(2),U,8),10)
"RTN","PRCHRPT1",69,0)
 I $D(^PRC(442,W(6),2,W(5),0)) S W(8)=^(0) W:+$P(W(8),U,3) ?38,$P($G(^PRCD(420.5,+$P(W(8),U,3),0)),U,1)
"RTN","PRCHRPT1",70,0)
 W:$D(W(8)) ?48,$J($P(W(8),U,9),9,2) W:$D(W(7)) ?59,$J($P(W(7),U,1),10,2) W:$D(W(8)) ?71,$J($P(W(8),U,2),8)
"RTN","PRCHRPT1",71,0)
 I $P($G(^PRC(442,W(6),1)),U,1)>0 S W(8)=$P(^(1),U,1),W(8)=$P($G(^PRC(440,W(8),0)),U,1) I W(8)'="" W !,"Vendor: ",W(8)
"RTN","PRCHRPT1",72,0)
 K W(7),W(8)
"RTN","PRCHRPT1",73,0)
 Q
"RTN","PRCHRPT1",74,0)
 ;
"RTN","PRCHRPT1",75,0)
ASK Q:$E(IOST)="P"  W !!,"Press RETURN to continue, '^' to Quit" R X:DTIME I X["^" S ASK=1
"RTN","PRCHRPT1",76,0)
 Q
"RTN","PRCHRPT1",77,0)
 ;
"RTN","PRCHRPT1",78,0)
RNG ; ALLOW ENTRY OF BEGINNING AND ENDING RANGE
"RTN","PRCHRPT1",79,0)
 S FR="",TO="z" W !!!,"START WITH "_M_": FIRST//" R FR:DTIME S:$T=0 FR="^" I (FR["?")!(FR["^")!(FR="") Q
"RTN","PRCHRPT1",80,0)
 I FR'="@",$D(PRCHD),PRCHD="DATE" K %DT S X=FR D ^%DT S FR=Y W:Y=-1 $C(7),!,"INVALID DATE" G:Y=-1 RNG D DD^%DT W "   ",Y
"RTN","PRCHRPT1",81,0)
 W !!,"GO TO "_M_": LAST//" R TO:DTIME S:$T=0 TO="^" Q:(TO["^")!(TO["?")  S:TO="" TO="z" Q:TO="z"
"RTN","PRCHRPT1",82,0)
 I $D(PRCHD),PRCHD="DATE" S X=TO D ^%DT S TO=Y W:Y=-1 $C(7),!,"INVALID DATE" G:Y=-1 RNG D DD^%DT W "   ",Y
"RTN","PRCHRPT1",83,0)
 I (+FR=FR)&(+TO=TO) I FR>TO W $C(7),!,"INVALID RANGE" G RNG
"RTN","PRCHRPT1",84,0)
 I FR'="@" I (+FR'=FR)!(+TO'=TO) I FR]TO W $C(7),!,"INVALID RANGE" G RNG
"RTN","PRCHRPT1",85,0)
 Q
"RTN","PRCHRPT1",86,0)
 ;
"RTN","PRCHRPT1",87,0)
PDT ; ROUTINE ALLOWING ENTRY OF A DATE FOR PRINTING, ETC. (DEFAULTS TO NOW)
"RTN","PRCHRPT1",88,0)
 W !!,"Enter date (and time, if not NOW) to "_M S %DT="AET",%DT("A")="DATE: NOW//" D ^%DT K %DT
"RTN","PRCHRPT1",89,0)
 S:X="" X="NOW",Y=$H S PRCHPDAT=Y Q:X="NOW"!(X["^")  G:Y=-1 PDT
"RTN","PRCHRPT1",90,0)
 I +$P(Y,".",2)'>0 W $C(7),!,"You must enter the time as well as the date to print the report" G PDT
"RTN","PRCHRPT1",91,0)
 S PRCHPDAT=Y
"RTN","PRCHRPT1",92,0)
 Q
"RTN","PRCHRPT1",93,0)
 ;
"RTN","PRCHRPT1",94,0)
SDEV ; SELECT DEVICE FOR QUEUED PRINTING
"RTN","PRCHRPT1",95,0)
 W ! K %ZIS,IOP S %ZIS="Q",IOP="Q",%ZIS("B")="" D ^%ZIS
"RTN","PRCHRPT1",96,0)
 S IOP=ION_";"_IOST_";"_IOM_";"_IOSL I IO=IO(0) D ^%ZIS U IO D @ZTRTN D ^%ZISC
"RTN","PRCHRPT1",97,0)
 Q
"RTN","PRCHRPT1",98,0)
HDR ;
"RTN","PRCHRPT1",99,0)
 ;
"RTN","PRCHRPT1",100,0)
 I $G(LNCT)>0&($E(IOST)'="P") D ASK G:ASK Q
"RTN","PRCHRPT1",101,0)
 W @IOF,!!,"Item Number: ",D0,?25,"Description: ",W,!?8,"FCP: ",PRCHFCP,!!,?26,"Quantity",!,?26,"Previously",?38,"Unit of",?71,"Quantity"
"RTN","PRCHRPT1",102,0)
 W !,"Date Ordered",?15,"PO Number",?26,"Received",?38,"Purchase",?48,"Unit Cost",?59,"Total Cost",?71,"Ordered",! F I=1:1:80 W "_"
"RTN","PRCHRPT1",103,0)
 Q
"RTN","PRCHRPT1",104,0)
RDTXS ; Prompt for # back TX's to list for an FCP(default=10,max=9999)
"RTN","PRCHRPT1",105,0)
 W !
"RTN","PRCHRPT1",106,0)
RDTXS1 K DIR
"RTN","PRCHRPT1",107,0)
 S DIR(0)="F^1:4"
"RTN","PRCHRPT1",108,0)
 S DIR("A")="Enter # BACK TRANSACTIONS to list, 'S' to sort or '^' to EXIT"
"RTN","PRCHRPT1",109,0)
 S DIR("B")=10
"RTN","PRCHRPT1",110,0)
 S DIR("?")="Enter 1-9999 or 'S' to sort by PO Date, FCP, etc."
"RTN","PRCHRPT1",111,0)
 S DIR("??")="^D WARN^PRCHRPT1"
"RTN","PRCHRPT1",112,0)
 D ^DIR
"RTN","PRCHRPT1",113,0)
 S TXS=X
"RTN","PRCHRPT1",114,0)
 I $D(DIRUT) S ABORT=1 G Q
"RTN","PRCHRPT1",115,0)
 I TXS?.N&((TXS<1)!(TXS>9999)) D QUESTION G RDTXS1
"RTN","PRCHRPT1",116,0)
 I TXS?.N S TXR=TXS,^TMP("PRCHITMH",0)=TXR*1,TXR=^TMP("PRCHITMH",0),RTX="A" Q
"RTN","PRCHRPT1",117,0)
 I TXS'="s"&(TXS'="S") W ! D QUESTION G RDTXS1
"RTN","PRCHRPT1",118,0)
 S ITMNO=$P(ITMY,U,1) G EN^PRCHRPTX
"RTN","PRCHRPT1",119,0)
 Q
"RTN","PRCHRPT1",120,0)
 ;
"RTN","PRCHRPT1",121,0)
QUESTION ;
"RTN","PRCHRPT1",122,0)
 W !!,"Enter 1-9999 or 'S' to sort by PO Date, FCP, etc."
"RTN","PRCHRPT1",123,0)
 Q
"RTN","PRCHRPT1",124,0)
 ;
"RTN","PRCHRPT1",125,0)
WARN ;
"RTN","PRCHRPT1",126,0)
 W @IOF,!?10,"List Transaction History for Specified Item",!!
"RTN","PRCHRPT1",127,0)
 W !,"You may obtain either a listing of a specified number of back transactions",!,"for the item or all transactions (by FCP) within a specified date range."
"RTN","PRCHRPT1",128,0)
 W !!,"Please be aware that the latter involves complex sorting and may",!,"take awhile to complete.  Therefore, it is suggested that it be queued to",!,"a printer to immediately free your workstation.",!
"RTN","PRCHRPT1",129,0)
 Q
"RTN","PRCSD121")
0^3^B19939086
"RTN","PRCSD121",1,0)
PRCSD121 ;WISC/SAW-CONTROL POINT ACTIVITY 2237 DISPLAY CON'T ;4/21/93  08:45
"RTN","PRCSD121",2,0)
 ;;5.1;IFCAP;**70**;Oct 20, 2000
"RTN","PRCSD121",3,0)
 ;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","PRCSD121",4,0)
 ;PRINT ITEMS
"RTN","PRCSD121",5,0)
 I $D(^PRCS(410,DA,1)),$P(^(1),U,5)'="" S P=$P(^(1),U,5),P=$P($G(^PRCS(410.2,P,0)),U) W !,?13,P,":"
"RTN","PRCSD121",6,0)
 S DIWL=13,DIWR=51,DIWF="",P(1)=0
"RTN","PRCSD121",7,0)
 F I=1:1 K ^UTILITY($J,"W") S P(1)=$O(^PRCS(410,DA,"IT",P(1))) G VENDOR:P(1)'?1N.E D ITEM1
"RTN","PRCSD121",8,0)
ITEM1 Q:'$D(^PRCS(410,DA,"IT",P(1),0))  S Z=^(0)
"RTN","PRCSD121",9,0)
 D:IOSL-$Y<3 NEWP Q:Z1=U
"RTN","PRCSD121",10,0)
 S P(4)=$P(Z,U,6) I $L(P(4))>12 W !,$E(P(4),1,13),!,$E(P(4),13,24)
"RTN","PRCSD121",11,0)
 I $L(P(4))<13 W !,P(4)
"RTN","PRCSD121",12,0)
 ;The variable Z is equal to ^PRCS(410,DA,"IT",P(1),0)
"RTN","PRCSD121",13,0)
 S PRCS("SUB")=+$P(Z,U,4),P(3)=$P(Z,U,3) S P(3)=$S($D(^PRCD(420.5,+P(3),0)):$P(^(0),U,1),1:"")
"RTN","PRCSD121",14,0)
 S P(0)=$S($P(Z,U,2)[".":$J($P(Z,U,2),9,2),1:$J($P(Z,U,2),9))_" "_$J(P(3),4)_" "_$S($P(Z,U,7)="N/C":$J("N/C",9),1:$J($P(Z,U,7),9,4))
"RTN","PRCSD121",15,0)
 G PRCARD:$P(Z,U,5)
"RTN","PRCSD121",16,0)
 S P(2)=0 F I=1:1 S P(2)=$O(^PRCS(410,DA,"IT",P(1),1,P(2))) Q:P(2)=""  S X=^(P(2),0) S:I=1 X=$P(^PRCS(410,DA,"IT",P(1),0),U,1)_" "_X D DIWP^PRCUTL($G(DA))
"RTN","PRCSD121",17,0)
ITEM2 I '$D(^UTILITY($J,"W",DIWL)) S ^(DIWL)=1,^(DIWL,1,0)="***NO DESCRIPTION***"
"RTN","PRCSD121",18,0)
 S Z=^UTILITY($J,"W",DIWL)
"RTN","PRCSD121",19,0)
 I Z>1 F J=1:1:(Z-1) W ?13,^UTILITY($J,"W",DIWL,J,0) D:IOSL-$Y<2 NEWP Q:Z1=U  W !
"RTN","PRCSD121",20,0)
 I Z>1 W ?13,^UTILITY($J,"W",DIWL,Z,0),?52,P(0) D:IOSL-$Y<2 NEWP Q:Z1=U  W !
"RTN","PRCSD121",21,0)
 I Z<2 W ?13,^UTILITY($J,"W",DIWL,1,0),?52,P(0) D:IOSL-$Y<2 NEWP Q:Z1=U  W !
"RTN","PRCSD121",22,0)
 Q
"RTN","PRCSD121",23,0)
PRCARD S P("PR")=$P(^PRCS(410,DA,"IT",P(1),0),U,5) G ITEM2:'$D(^PRC(441,P("PR"),1,0))
"RTN","PRCSD121",24,0)
 S P("PR1")=0,X=$P(^PRCS(410,DA,"IT",P(1),0),U)_" ITEM ID NO. "_P("PR") D DIWP^PRCUTL($G(DA)) F I=1:1 S P("PR1")=$O(^PRC(441,P("PR"),1,P("PR1"))) Q:P("PR1")=""  S X=^(P("PR1"),0) D DIWP^PRCUTL($G(DA))
"RTN","PRCSD121",25,0)
 S Z="" S:$P(^PRC(441,P("PR"),0),U,5)'="" Z=Z_" (NSN: "_$P(^(0),U,5)_")" S Z1=$P(^PRCS(410,DA,3),U,4) I Z1,$D(^PRC(441,P("PR"),2,Z1,0)) S:$P(^(0),U,5)'="" Z=Z_" (NDC: "_$P(^(0),U,5)_")" S:$P(^(0),U,3) Z2=$P(^(0),U,3)
"RTN","PRCSD121",26,0)
 S:$P($G(^PRC(441,P("PR"),3)),U,7)'="" Z=Z_" FOOD GROUP: "_$P(^(3),U,7)
"RTN","PRCSD121",27,0)
 I Z1,$D(^PRC(441,P("PR"),2,Z1,0)) S Z=Z_" PKG: "_$P(^(0),U,8)_" per "_$S($D(^PRCD(420.5,+$P(^(0),U,7),0)):$P(^(0),U),1:"")
"RTN","PRCSD121",28,0)
 I Z1,$D(Z2),$D(^PRC(440,Z1,4,Z2,0)),$P(^(0),U,1)'="" S Y=$S($P(^(0),U,2):$P(^(0),U,2),1:"") X:Y ^DD("DD") S Z=Z_" (CONTRACT # "_$P(^PRC(440,Z1,4,Z2,0),U,1)_$S(Y'="":", EXPIRATION DATE: "_Y_")",1:")") K Z2
"RTN","PRCSD121",29,0)
 S X=Z D:$L(X) DIWP^PRCUTL($G(DA)) G ITEM2
"RTN","PRCSD121",30,0)
VENDOR ;PRINT VENDOR AND REQ MESSAGES
"RTN","PRCSD121",31,0)
 N Z0
"RTN","PRCSD121",32,0)
 Q:Z1=U  I IOSL-$Y<3 D NEWP Q:Z1=U
"RTN","PRCSD121",33,0)
 I $D(^PRCS(410,DA,4)),$P(^(4),U,1)'="" W !,?13,"TOTAL COST: ","$"_$J($P(^(4),U,1),0,2)
"RTN","PRCSD121",34,0)
 W !,L I IOSL-$Y<2 D NEWP Q:Z1=U
"RTN","PRCSD121",35,0)
 G RM:'$D(^PRCS(410,DA,2))
"RTN","PRCSD121",36,0)
 I $D(^PRCS(410,DA,2)),$P(^(2),U,1)="" G RM
"RTN","PRCSD121",37,0)
 I IOSL-$Y<7 D NEWP Q:Z1=U
"RTN","PRCSD121",38,0)
 S (X,Z0)=$P(^PRCS(410,DA,3),"^",4),X=$S(X:"VENDOR INFORMATION:    NO: "_X,1:"NEW VENDOR INFORMATION: ") W !,X
"RTN","PRCSD121",39,0)
 I Z0,$D(^PRC(440,Z0,3)),$P(^(3),U,2)="Y" W ?38,"EDI"
"RTN","PRCSD121",40,0)
 I Z0,$D(^PRC(440,Z0,10)),$P(^(10),U,6)'="" W ?46,"FAX: "_$P(^(10),U,6)
"RTN","PRCSD121",41,0)
 W !,"VENDOR: ",$P(^PRCS(410,DA,2),U,1) W:$P(^(2),U,9)'="" ?42,"CONTACT: ",$P(^(2),U,9)
"RTN","PRCSD121",42,0)
 W:$P(^PRCS(410,DA,2),U,2)'="" !,?8,$P(^(2),U,2) W:$P(^(2),U,10)'="" ?44,"PHONE: ",$P(^(2),U,10)
"RTN","PRCSD121",43,0)
 S Z(1)=$Y W:$P(^PRCS(410,DA,2),U,3)'="" !,?8,$P(^(2),U,3) S Z1=$P(^(3),U,4) I Z1,$D(^PRC(440,Z1,2)),$P(^(2),U,1)'="" W:Z(1)=$Y ! W ?42,"ACCT. #: ",$P(^(2),U,1)
"RTN","PRCSD121",44,0)
 W:$P(^PRCS(410,DA,2),U,4)'="" !,?8,$P(^(2),U,4) W:$P(^(2),U,5)'="" !,?8,$P(^(2),U,5)
"RTN","PRCSD121",45,0)
 I $P(^PRCS(410,DA,2),U,6)'="" W !,?8,$P(^(2),U,6) W:+$P(^(2),U,7)'=0 ",",$P($G(^DIC(5,$P(^(2),U,7),0)),U,2) W:$P(^PRCS(410,DA,2),U,8)'="" " ",$P(^(2),U,8)
"RTN","PRCSD121",46,0)
 W !,L W !,"Ref. Voucher Number: ",! I $P($G(^PRCS(410,DA,445)),"^")'="" W $P(^(445),"^"),!
"RTN","PRCSD121",47,0)
RM I IOSL-$Y<4 D NEWP Q:Z1=U
"RTN","PRCSD121",48,0)
 I '$D(^PRCS(410,DA,"RM",0)) G DEL
"RTN","PRCSD121",49,0)
 I $D(^PRCS(410,DA,"RM",0)) W ! S P(1)=0,DIWL=1,DIWR=80,DIWF="" K ^UTILITY($J,"W") S X="SPECIAL REMARKS:" D DIWP^PRCUTL($G(DA)) F J=1:1 S P(1)=$O(^PRCS(410,DA,"RM",P(1))) Q:P(1)=""  S X=^(P(1),0) D DIWP^PRCUTL($G(DA))
"RTN","PRCSD121",50,0)
 S Z=^UTILITY($J,"W",DIWL) F K=1:1:Z D:$Y>62 NEWP^PRCSD121 W !,^UTILITY($J,"W",DIWL,K,0)
"RTN","PRCSD121",51,0)
DEL I $D(^PRCS(410,DA,9)),$P(^(9),U,1)'="" W !,?6,"DELIVER TO: ",$P(^(9),U,1)
"RTN","PRCSD121",52,0)
 W !,L Q
"RTN","PRCSD121",53,0)
NEWP ;PRINT HEADER FOR NEW PAGE
"RTN","PRCSD121",54,0)
 S Z1="" W !,"Press return to continue, uparrow (^) to exit: " R Z1:DTIME S:'$T Z1=U W @IOF Q:Z1=U
"RTN","PRCSD121",55,0)
 W !,?31,$P(^PRCS(410,DA,0),U,1) W !,L
"RTN","PRCSD121",56,0)
 W !,?16,"REQUEST, TURN-IN, AND RECEIPT FOR PROPERTY OR SERVICES" W !,L
"RTN","PRCSD121",57,0)
 Q
"VER")
8.0^22.0
**END**
**END**
