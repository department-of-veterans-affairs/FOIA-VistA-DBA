Released DG*5.3*611 SEQ #619
Extracted from mail message
**KIDS**:DG*5.3*611^

**INSTALL NAME**
DG*5.3*611
"BLD",6021,0)
DG*5.3*611^REGISTRATION^0^3060503^y
"BLD",6021,1,0)
^^1^1^3051206^
"BLD",6021,1,1,0)
FIX MEANS TEST DISPLAY
"BLD",6021,4,0)
^9.64PA^^
"BLD",6021,6.3)
3
"BLD",6021,"KRN",0)
^9.67PA^8989.52^19
"BLD",6021,"KRN",.4,0)
.4
"BLD",6021,"KRN",.401,0)
.401
"BLD",6021,"KRN",.402,0)
.402
"BLD",6021,"KRN",.403,0)
.403
"BLD",6021,"KRN",.5,0)
.5
"BLD",6021,"KRN",.84,0)
.84
"BLD",6021,"KRN",3.6,0)
3.6
"BLD",6021,"KRN",3.8,0)
3.8
"BLD",6021,"KRN",9.2,0)
9.2
"BLD",6021,"KRN",9.8,0)
9.8
"BLD",6021,"KRN",9.8,"NM",0)
^9.68A^2^2
"BLD",6021,"KRN",9.8,"NM",1,0)
DGMTSC^^0^B22224962
"BLD",6021,"KRN",9.8,"NM",2,0)
DGMTSCC^^0^B36081556
"BLD",6021,"KRN",9.8,"NM","B","DGMTSC",1)

"BLD",6021,"KRN",9.8,"NM","B","DGMTSCC",2)

"BLD",6021,"KRN",19,0)
19
"BLD",6021,"KRN",19.1,0)
19.1
"BLD",6021,"KRN",101,0)
101
"BLD",6021,"KRN",409.61,0)
409.61
"BLD",6021,"KRN",771,0)
771
"BLD",6021,"KRN",870,0)
870
"BLD",6021,"KRN",8989.51,0)
8989.51
"BLD",6021,"KRN",8989.52,0)
8989.52
"BLD",6021,"KRN",8994,0)
8994
"BLD",6021,"KRN","B",.4,.4)

"BLD",6021,"KRN","B",.401,.401)

"BLD",6021,"KRN","B",.402,.402)

"BLD",6021,"KRN","B",.403,.403)

"BLD",6021,"KRN","B",.5,.5)

"BLD",6021,"KRN","B",.84,.84)

"BLD",6021,"KRN","B",3.6,3.6)

"BLD",6021,"KRN","B",3.8,3.8)

"BLD",6021,"KRN","B",9.2,9.2)

"BLD",6021,"KRN","B",9.8,9.8)

"BLD",6021,"KRN","B",19,19)

"BLD",6021,"KRN","B",19.1,19.1)

"BLD",6021,"KRN","B",101,101)

"BLD",6021,"KRN","B",409.61,409.61)

"BLD",6021,"KRN","B",771,771)

"BLD",6021,"KRN","B",870,870)

"BLD",6021,"KRN","B",8989.51,8989.51)

"BLD",6021,"KRN","B",8989.52,8989.52)

"BLD",6021,"KRN","B",8994,8994)

"BLD",6021,"QUES",0)
^9.62^^
"BLD",6021,"REQB",0)
^9.611^2^2
"BLD",6021,"REQB",1,0)
DG*5.3*566^2
"BLD",6021,"REQB",2,0)
DG*5.3*624^2
"BLD",6021,"REQB","B","DG*5.3*566",1)

"BLD",6021,"REQB","B","DG*5.3*624",2)

"MBREQ")
0
"PKG",5,-1)
1^1
"PKG",5,0)
REGISTRATION^DG^PATIENT REGISTRATION, ADMISSION, DISCHARGE, EMBOSSER 
"PKG",5,20,0)
^9.402P^^
"PKG",5,22,0)
^9.49I^1^1
"PKG",5,22,1,0)
5.3^2930813
"PKG",5,22,1,"PAH",1,0)
611^3060503
"PKG",5,22,1,"PAH",1,1,0)
^^1^1^3060503
"PKG",5,22,1,"PAH",1,1,1,0)
FIX MEANS TEST DISPLAY
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
2
"RTN","DGMTSC")
0^1^B22224962^B12063858
"RTN","DGMTSC",1,0)
DGMTSC ;ALB/RMO,CAW,RTK,PDJ,LBD,EG - Means Test Screen Driver ;05/02/2006
"RTN","DGMTSC",2,0)
 ;;5.3;Registration;**182,327,372,433,463,540,566,611**;Aug 13, 1993;Build 3
"RTN","DGMTSC",3,0)
 ;
"RTN","DGMTSC",4,0)
 ;A series of screens used to collect the means test data
"RTN","DGMTSC",5,0)
 ; Input  -- DFN      Patient IEN
"RTN","DGMTSC",6,0)
 ;           DGMTACT  Means Test Action  (ie, ADD to Add a Means Test)
"RTN","DGMTSC",7,0)
 ;           DGMTDT   Date of Test
"RTN","DGMTSC",8,0)
 ;           DGMTI    Annual Means Test IEN
"RTN","DGMTSC",9,0)
 ;           DTMTYPT  Type of Test 1=MT 2=COPAY
"RTN","DGMTSC",10,0)
 ;           DGMTROU  Option Routine Return
"RTN","DGMTSC",11,0)
 ; Output -- None
"RTN","DGMTSC",12,0)
 ;
"RTN","DGMTSC",13,0)
 ;DG*5.3*540 - set 408.21 (Idiv. Ann. Income) ien to 0 to prevent from
"RTN","DGMTSC",14,0)
 ;             linking to old test incomes for IVM converted cases.
"RTN","DGMTSC",15,0)
 ;
"RTN","DGMTSC",16,0)
EN ;Entry point for means test screen driver
"RTN","DGMTSC",17,0)
 D PRIOR^DGMTEVT:DGMTACT'="VEW",HOME^%ZIS,SETUP^DGMTSCU I DGERR D MG G Q1
"RTN","DGMTSC",18,0)
 N DGREF,DTOUT,DUOUT,DGCAT,DGREF,ANSPFIN,PROVS
"RTN","DGMTSC",19,0)
 S ANSPFIN="N"
"RTN","DGMTSC",20,0)
 I DGMTACT="ADD"!(DGMTACT="EDT")!(DGMTACT="COM") D DISCF Q:$D(DTOUT)!$D(DUOUT)  I $D(DGREF) D Q Q
"RTN","DGMTSC",21,0)
 ;
"RTN","DGMTSC",22,0)
EN1 ;Entry point to edit means test if incomplete
"RTN","DGMTSC",23,0)
 S DGMTSCI=+$O(DGMTSC(0))
"RTN","DGMTSC",24,0)
 I DGMTI,$$GET1^DIQ(408.31,DGMTI,.23)["IVM" S DGVINI=0     ;DG*5.3*540
"RTN","DGMTSC",25,0)
 G @($$ROU^DGMTSCU(DGMTSCI))
"RTN","DGMTSC",26,0)
 ;
"RTN","DGMTSC",27,0)
 ;
"RTN","DGMTSC",28,0)
Q I DGMTACT'="VEW" D EN^DGMTSCC I DGERR G EN1:$$EDT
"RTN","DGMTSC",29,0)
 ; Added for LTC Co-pay Phase II - DG*5.3*433
"RTN","DGMTSC",30,0)
 I DGMTACT'="VEW",DGMTYPT=4 D  G K
"RTN","DGMTSC",31,0)
 .Q:$P($G(^DGMT(408.31,DGMTI,0)),U,3)=""  ; LTC 4 test is incomplete
"RTN","DGMTSC",32,0)
 .D AFTER^DGMTEVT S DGMTINF=0
"RTN","DGMTSC",33,0)
 .D EN^DGMTAUD,EN^IVMPMTE
"RTN","DGMTSC",34,0)
 .D DATETIME^DGMTU4(DGMTI)
"RTN","DGMTSC",35,0)
 .; If LTC copay exemption test is edited, update LTC copay test
"RTN","DGMTSC",36,0)
 .I DGMTACT="EDT" D UPLTC3^EASECMT(DGMTI)
"RTN","DGMTSC",37,0)
Q1 I DGMTACT'="VEW" D AFTER^DGMTEVT S DGMTINF=0 D EN^DGMTEVT
"RTN","DGMTSC",38,0)
 ;
"RTN","DGMTSC",39,0)
 ;If the veteran has agreed to pay copay after previously refusing,
"RTN","DGMTSC",40,0)
 ;automatically update their Primary Eligibility (327-Ineligible Project)
"RTN","DGMTSC",41,0)
 I $D(DGMTP),$D(DGMTA) D
"RTN","DGMTSC",42,0)
 .I $D(^DPT(DFN,.3)),$P(DGMTP,U,11)=0,$P(DGMTA,U,11)=1 D
"RTN","DGMTSC",43,0)
 ..N DATA
"RTN","DGMTSC",44,0)
 ..I $P(^DPT(DFN,.3),U)="Y" S DATA(.361)=$O(^DIC(8,"B","SC LESS THAN 50%",""))
"RTN","DGMTSC",45,0)
 ..E  S DATA(.361)=$O(^DIC(8,"B","NSC",""))
"RTN","DGMTSC",46,0)
 ..I $$UPD^DGENDBS(2,DFN,.DATA)
"RTN","DGMTSC",47,0)
 .;If the veteran has refused to pay copay, update ENROLLMENT
"RTN","DGMTSC",48,0)
 .;PRIORITY to null.
"RTN","DGMTSC",49,0)
 .I $P(DGMTA,U,11)=0 D
"RTN","DGMTSC",50,0)
 ..S CUR=$$FINDCUR^DGENA(DFN)
"RTN","DGMTSC",51,0)
 ..N DATA S DATA(.07)="@" I $$UPD^DGENDBS(27.11,CUR,.DATA)
"RTN","DGMTSC",52,0)
 ;
"RTN","DGMTSC",53,0)
 ; Added for LTC Copay Phase II (DG*5.2*433)
"RTN","DGMTSC",54,0)
 ; If means test or copay test is edited and has a LTC copay exemption
"RTN","DGMTSC",55,0)
 ; test associated with it, update the LTC copay exemption test.
"RTN","DGMTSC",56,0)
 I DGMTACT="EDT",$O(^DGMT(408.31,"AT",DGMTI,0)) D LTC4^EASECMT(DGMTI)
"RTN","DGMTSC",57,0)
 ;
"RTN","DGMTSC",58,0)
K K %,DGBL,DGDC,DGDEP,DGDR,DGFCOL,DGFL,DGMT0,DGMTA,DGMTINF,DGMTOUT,DGMTP,DGMTPAR,DGMTSC,DGMTSCI,DGREL,DGRNG,DGRPPR,DGSCOL,DGSEL,DGSELTY,DGVI,DGVINI,DGVIRI,DGVO,DGVPRI,DGX,DGY,DTOUT,DUOUT,Y,Z
"RTN","DGMTSC",59,0)
 ;
"RTN","DGMTSC",60,0)
 ; Validate record with consistency checks, when adding, editing, or
"RTN","DGMTSC",61,0)
 ; completing either a means or copay test.
"RTN","DGMTSC",62,0)
 ; For DG*5.3*566 - added a check for Status field to be defined before
"RTN","DGMTSC",63,0)
 ; calling the consistency check API (INCON^DGMTUTL1).
"RTN","DGMTSC",64,0)
 K IVMERR,IVMAR,IVMAR2
"RTN","DGMTSC",65,0)
 ;don't apply consistency checks if user elects to not provide financial information
"RTN","DGMTSC",66,0)
 I DGMTACT'="VEW",$P($G(^DGMT(408.31,DGMTI,0)),U,3),'$D(DGREF) D INCON^DGMTUTL1(DFN,DGMTDT,DGMTI,DGMTYPT,.IVMERR),PROB^IVMCMFB(DGMTDT,.IVMERR,1)
"RTN","DGMTSC",67,0)
 ;
"RTN","DGMTSC",68,0)
 ;Update the TEST-DETERMINED STATUS field (#2.03) in the ANNUAL MEANS
"RTN","DGMTSC",69,0)
 ;TEST file (408.31) when adding a means or copay test, completing a 
"RTN","DGMTSC",70,0)
 ;means test, or editing a means or copay test.
"RTN","DGMTSC",71,0)
 I "ADDCOMEDT"[DGMTACT D SAVESTAT^DGMTU4(DGMTI,DGERR)
"RTN","DGMTSC",72,0)
 K DGERR,IVMERR,ARRAY,ZIC,ZIR,ZMT,ZDP,IVMAR,IVMAR2,DGREF
"RTN","DGMTSC",73,0)
 ;
"RTN","DGMTSC",74,0)
 G @(DGMTROU)
"RTN","DGMTSC",75,0)
 ;
"RTN","DGMTSC",76,0)
MG ;Print set-up error messages
"RTN","DGMTSC",77,0)
 I $D(DGVPRI),DGVPRI'>0 W !!?3,"Patient Relation cannot be setup for patient."
"RTN","DGMTSC",78,0)
 I $D(DGVINI),DGVINI'>0 W !!?3,"Individual Annual Income cannot be setup for patient."
"RTN","DGMTSC",79,0)
 I $D(DGMTPAR),DGMTPAR']"",DGMTYPT=1 W !!?3,"Means Test Thresholds are not defined."
"RTN","DGMTSC",80,0)
 W !?3,*7,"Please contact your site manager."
"RTN","DGMTSC",81,0)
 Q
"RTN","DGMTSC",82,0)
 ;
"RTN","DGMTSC",83,0)
EDT() ;Edit means/copay test if incomplete
"RTN","DGMTSC",84,0)
 N DIR,Y
"RTN","DGMTSC",85,0)
 S DIR("A")="Do you wish to edit the "_$S(DGMTYPT=1:"means",1:"copay exemption")_" test"
"RTN","DGMTSC",86,0)
 S DIR("B")="YES",DIR(0)="Y" D ^DIR
"RTN","DGMTSC",87,0)
 Q +$G(Y)
"RTN","DGMTSC",88,0)
 ;
"RTN","DGMTSC",89,0)
DEDUCT() ;
"RTN","DGMTSC",90,0)
 N DIR,Y
"RTN","DGMTSC",91,0)
 S DIR("A")="Agreed to pay deductible",DIR(0)="Y"
"RTN","DGMTSC",92,0)
 D ^DIR
"RTN","DGMTSC",93,0)
 Q +$G(Y)
"RTN","DGMTSC",94,0)
 ;
"RTN","DGMTSC",95,0)
DISCF ;Check if patient declines to provide income information
"RTN","DGMTSC",96,0)
 ;similar to module REF in program DGMTSCC, but the questions
"RTN","DGMTSC",97,0)
 ;are negatives of each other
"RTN","DGMTSC",98,0)
 N DIR,Y,U,MSG
"RTN","DGMTSC",99,0)
 S U="^"
"RTN","DGMTSC",100,0)
 S MSG(1)=""
"RTN","DGMTSC",101,0)
 S MSG(2)="PROVIDE SPECIFIC INCOME AND/OR ASSET INFORMATION"
"RTN","DGMTSC",102,0)
 S MSG(3)="TO HAVE ELIGIBILITY FOR CARE DETERMINED. <YES>"
"RTN","DGMTSC",103,0)
 S MSG(4)="Continue, and complete the test with last calendar year's information."
"RTN","DGMTSC",104,0)
 S MSG(5)=""
"RTN","DGMTSC",105,0)
 S MSG(6)="PROVIDE MY DETAILED FINANCIAL INFORMATION. <NO>"
"RTN","DGMTSC",106,0)
 S MSG(7)="The appropriate enrollment priority based on nondisclosure of"
"RTN","DGMTSC",107,0)
 S MSG(8)="my financial information will be assigned."
"RTN","DGMTSC",108,0)
 S MSG(9)=""
"RTN","DGMTSC",109,0)
 D BMES^XPDUTL(.MSG)
"RTN","DGMTSC",110,0)
 S DIR("A")="Do you wish to provide financial information? "
"RTN","DGMTSC",111,0)
 ;piece 14 says declines to give income info yes or no
"RTN","DGMTSC",112,0)
 ;if the user declines to give income info, then provide financial information is no
"RTN","DGMTSC",113,0)
 I $P($G(^DGMT(408.31,DGMTI,0)),"^",14)]"" S DIR("B")=$S($P(^DGMT(408.31,DGMTI,0),"^",14):"N",1:"Y")
"RTN","DGMTSC",114,0)
 I '$D(DIR("B")) S DIR("B")="YES"
"RTN","DGMTSC",115,0)
 S DIR(0)="408.31,.14" D ^DIR K DIR I $D(DTOUT)!($D(DUOUT)) Q
"RTN","DGMTSC",116,0)
 S:'Y DGREF="" S ANSPFIN="Y" Q:'$D(DGREF)!($D(DGREF1))!(DGMTYPT'=1)  S DGCAT="C" D STA^DGMTSCU2
"RTN","DGMTSC",117,0)
 Q
"RTN","DGMTSCC")
0^2^B36081556^B31522709
"RTN","DGMTSCC",1,0)
DGMTSCC ;ALB/RMO,CAW,LBD,EG - Means Test Screen Completion ; 03/24/2006
"RTN","DGMTSCC",2,0)
 ;;5.3;Registration;**33,45,130,438,332,433,462,456,610,624,611**;Aug 13, 1993;Build 3
"RTN","DGMTSCC",3,0)
 ;
"RTN","DGMTSCC",4,0)
 ; Input  -- DFN      Patient IEN
"RTN","DGMTSCC",5,0)
 ;           DGMTACT  Means Test Action
"RTN","DGMTSCC",6,0)
 ;           DGMTDT   Date of Test
"RTN","DGMTSCC",7,0)
 ;           DGMTYPT  Type of Test 1=MT 2=COPAY
"RTN","DGMTSCC",8,0)
 ;           DGMTPAR  Annual Means Test Parameters
"RTN","DGMTSCC",9,0)
 ;           DGVINI   Veteran Individual Annual Income IEN
"RTN","DGMTSCC",10,0)
 ;           DGVIRI   Veteran Income Relation IEN
"RTN","DGMTSCC",11,0)
 ;           DGVPRI   Veteran Patient Relation IEN
"RTN","DGMTSCC",12,0)
 ;           DGMTNWC  Net Worth Calculation flag
"RTN","DGMTSCC",13,0)
 ; Output -- DGERR    1=INCOMPLETE and 0=COMPLETE
"RTN","DGMTSCC",14,0)
 ;
"RTN","DGMTSCC",15,0)
EN N DGCAT,DGCOMF,DGDC,DGDET,DGIN0,DGIN1,DGIN2,DGINT,DGINTF,DGMTS,DGNC,DGND,DGNWT,DGNWTF,DGREF1,DGSP,DGTYC,DGTHA,DGTHB,DGVIR0,DGCOPS,DGCOST,DGTHG
"RTN","DGMTSCC",16,0)
 S DGERR=0
"RTN","DGMTSCC",17,0)
 I DGMTACT="ADD" D COM I 'Y!($D(DTOUT))!($D(DUOUT)) G Q
"RTN","DGMTSCC",18,0)
 S DGCOMF=1 D DEP^DGMTSCU2,INC^DGMTSCU3
"RTN","DGMTSCC",19,0)
 ;if ANSPFIN="Y" user already answered to provide financial information (module DISC^DGMTSC)
"RTN","DGMTSCC",20,0)
 I $G(ANSPFIN)="Y",$D(DGREF) D
"RTN","DGMTSCC",21,0)
 . S (DGINTF,DGNWTF)=""
"RTN","DGMTSCC",22,0)
 . W !,"DECLINES TO GIVE INCOME INFORMATION: YES"
"RTN","DGMTSCC",23,0)
 . S DGREF1=""
"RTN","DGMTSCC",24,0)
 . Q
"RTN","DGMTSCC",25,0)
 I ($G(DGINTF)=0),($G(DGNWTF)=0) S DGREF1="" D REF G Q:$D(DTOUT)!($D(DUOUT))
"RTN","DGMTSCC",26,0)
 D CAT^DGMTSCU2,STA^DGMTSCU2
"RTN","DGMTSCC",27,0)
 ;don't try to run validation checks if declining to provide financial information
"RTN","DGMTSCC",28,0)
 I '$D(DGREF) D CHK I DGERR W !?3,*7,$S(DGMTYPT=1:"Means",1:"Copay")_" test cannot be completed." G Q
"RTN","DGMTSCC",29,0)
 I DGMTYPT=1,DGTYC="M",(DGNWT-DGDET)+$S(DGMTNWC:0,1:DGINT)'<$P(DGMTPAR,"^",8) D ADJ G Q:$D(DTOUT)!($D(DUOUT))
"RTN","DGMTSCC",30,0)
 I DGMTYPT=2,DGCAT="P" D ADJ G Q:$D(DTOUT)!($D(DUOUT))
"RTN","DGMTSCC",31,0)
 S DA=DGMTI,DIE="^DGMT(408.31,",DIE("NO^")="",DR="[DGMT ENTER/EDIT COMPLETION]" D ^DIE K DA,DIE,DR I '$D(DGFIN) S DGERR=1 G Q
"RTN","DGMTSCC",32,0)
 I DGMTACT="EDT",DGMTDT>DT D
"RTN","DGMTSCC",33,0)
 . N DATA S (DATA(.01),DATA(.07))=DT,DATA(2)=1 I $$UPD^DGENDBS(408.31,DGMTI,.DATA)
"RTN","DGMTSCC",34,0)
 W:DGMTYPT=1 !?3,"...means test status is ",$P($$MTS^DGMTU(DFN,DGMTS),"^"),"..."
"RTN","DGMTSCC",35,0)
 W:DGMTYPT=2 !?3,"...copay test status is ",$S(DGCAT="E":"EXEMPT",DGCAT="M":"NON-EXEMPT",DGCAT="P":"PENDING ADJUDICATION",1:"INCOMPLETE"),"..."
"RTN","DGMTSCC",36,0)
 D PRT
"RTN","DGMTSCC",37,0)
 ;
"RTN","DGMTSCC",38,0)
Q K DGFIN,DTOUT,DUOUT,Y
"RTN","DGMTSCC",39,0)
 Q
"RTN","DGMTSCC",40,0)
 ;
"RTN","DGMTSCC",41,0)
COM ;Check if user wants to complete the means test
"RTN","DGMTSCC",42,0)
 N DIR
"RTN","DGMTSCC",43,0)
 S DIR("A")="Do you wish to complete the "_$S(DGMTYPT=1:"means",1:"copay exemption")_" test"
"RTN","DGMTSCC",44,0)
 S DIR("B")="YES",DIR(0)="Y" D ^DIR
"RTN","DGMTSCC",45,0)
 ; The following was added for LTC Copay Phase II (DG*5.3*433)
"RTN","DGMTSCC",46,0)
 I DGMTYPT=4,'Y D
"RTN","DGMTSCC",47,0)
 . W !,"NOTE: If you do not complete the LTC copay exemption test, the incomplete test",!?6,"will be deleted."
"RTN","DGMTSCC",48,0)
 . S DIR("A")="Do you wish to complete the copay exemption test"
"RTN","DGMTSCC",49,0)
 . S DIR("B")="YES",DIR(0)="Y" D ^DIR
"RTN","DGMTSCC",50,0)
 Q
"RTN","DGMTSCC",51,0)
 ;
"RTN","DGMTSCC",52,0)
REF ;Check if patient declines to provide income information
"RTN","DGMTSCC",53,0)
 ;ANSPFIN      Y - user already answer this question (see program DGMTSC)       
"RTN","DGMTSCC",54,0)
 N DIR,Y,U
"RTN","DGMTSCC",55,0)
 S U="^"
"RTN","DGMTSCC",56,0)
 S DIR("A")="DECLINES TO GIVE INCOME INFORMATION"
"RTN","DGMTSCC",57,0)
 I $P($G(^DGMT(408.31,DGMTI,0)),"^",14)]"" S DIR("B")=$$YN^DGMTSCU1($P(^(0),"^",14))
"RTN","DGMTSCC",58,0)
 I '$D(DIR("B")),$G(ANSPFIN)'="Y" S DIR("B")="NO"
"RTN","DGMTSCC",59,0)
 ;user answered Y to provide income initially, but didn't provide income information
"RTN","DGMTSCC",60,0)
 I $G(ANSPFIN)="Y" S DIR("B")="YES"
"RTN","DGMTSCC",61,0)
 I $G(DGINTF)=0,$G(DGNWTF)=0 S DIR("B")="YES"
"RTN","DGMTSCC",62,0)
 S DIR(0)="408.31,.14" D ^DIR K DIR G REFQ:$D(DTOUT)!($D(DUOUT))
"RTN","DGMTSCC",63,0)
 S:Y DGREF="" Q:'$D(DGREF)!($D(DGREF1))!(DGMTYPT'=1)  S DGCAT="C" D STA^DGMTSCU2
"RTN","DGMTSCC",64,0)
 S ANSPFIN="Y"
"RTN","DGMTSCC",65,0)
REFQ Q
"RTN","DGMTSCC",66,0)
 ;
"RTN","DGMTSCC",67,0)
CHK ;Check if means test can be completed
"RTN","DGMTSCC",68,0)
 N DGA,DGD,DGDEP,DGREL,DGL,DGM,I
"RTN","DGMTSCC",69,0)
 D GETREL^DGMTU11(DFN,"CS",$$LYR^DGMTSCU1(DGMTDT),$S($G(DGMTI):DGMTI,1:""))
"RTN","DGMTSCC",70,0)
 S DGM=$P(DGVIR0,"^",5),DGL=$P(DGVIR0,"^",6),DGA=$P(DGVIR0,"^",7),DGD=$P(DGVIR0,"^",8)
"RTN","DGMTSCC",71,0)
 I DGM']""!(DGM&(DGL']""))!(DGM&('DGL)&(DGA']"")) W !?3,"Marital section must be completed." S DGERR=1
"RTN","DGMTSCC",72,0)
 I DGM,'$D(DGREL("S")),'$D(DGREF) W !?3,"Married is 'YES'.  An active spouse for this means test does not exist." S DGERR=1
"RTN","DGMTSCC",73,0)
 I 'DGM,$D(DGREL("S")) W !?3,"An active spouse exists for this means test. Married should be 'YES'." S DGERR=1
"RTN","DGMTSCC",74,0)
 I DGD']"" W !?3,"Dependent Children section must be completed." S DGERR=1
"RTN","DGMTSCC",75,0)
 I DGD,'$D(DGREL("C")) W !?3,"Dependent Children is 'YES'.  No active children exist." S DGERR=1
"RTN","DGMTSCC",76,0)
 I 'DGD,$D(DGREL("C")) W !?3,"Active children exist.  Dependent Children should be 'YES'." S DGERR=1
"RTN","DGMTSCC",77,0)
 I DGMTYPT=1,'$D(DGREF),DGTYC="M",'DGNWTF W !?3,"A status of ",$$GETNAME^DGMTH(DGMTS)," requires property information." S DGERR=1
"RTN","DGMTSCC",78,0)
 I DGMTYPT=2,'DGNWTF,DGCAT="E",$$ASKNW^DGMTCOU W !?3,"Patient is in an 'EXEMPT' status and requires property information." S DGERR=1
"RTN","DGMTSCC",79,0)
 I DGDET>DGINT W !?3,"Patient's deductible expenses cannot exceed income." S DGERR=1
"RTN","DGMTSCC",80,0)
 Q:$G(DGERR)
"RTN","DGMTSCC",81,0)
 N CNT,ACT,DGDEP,FLAG,DGINCP
"RTN","DGMTSCC",82,0)
 D INIT^DGDEP S CNT=0 D
"RTN","DGMTSCC",83,0)
 . F  S CNT=$O(DGDEP(CNT)) Q:'CNT  I $P(DGDEP(CNT),U,2)="SPOUSE" D  Q:$G(DGERR)
"RTN","DGMTSCC",84,0)
 . . D GETIENS^DGMTU2(DFN,$P(DGDEP(CNT),U,20),DGMTDT)
"RTN","DGMTSCC",85,0)
 . . S DGINCP=$G(^DGMT(408.22,+DGIRI,"MT")) S:DGINCP FLAG=$G(FLAG)+1
"RTN","DGMTSCC",86,0)
 . . I $G(FLAG)>1 W !?3,"Patient has more than one spouse for this means test." S DGERR=1
"RTN","DGMTSCC",87,0)
 Q
"RTN","DGMTSCC",88,0)
 ;
"RTN","DGMTSCC",89,0)
ADJ ;Adjudicate the means test
"RTN","DGMTSCC",90,0)
 N DIR,Y
"RTN","DGMTSCC",91,0)
 S DIR("?",1)="Since assets exceed the threshold, the "_$S(DGMTYPT=1:"means",1:"copay")_" test can"
"RTN","DGMTSCC",92,0)
 S DIR("?",2)="be sent to adjudication.  If the "_$S(DGMTYPT=1:"means",1:"copay")_" test is not"
"RTN","DGMTSCC",93,0)
 S DIR("?")="adjudicated, the patient will be placed in "_$S(DGMTYPT=1&(DGTHG>DGTHA):"GMT Copay Required",DGMTYPT=1:"MT Copay Required",1:"Non-exempt")_" status."
"RTN","DGMTSCC",94,0)
 S DIR("A")="Do you wish to send this case to adjudication"
"RTN","DGMTSCC",95,0)
 S DIR("B")="YES",DIR(0)="Y" D ^DIR G ADJQ:$D(DTOUT)!($D(DUOUT))
"RTN","DGMTSCC",96,0)
 S DGCAT=$S(Y:"P",DGMTYPT=1&(DGTHG>DGTHA):"G",DGMTYPT=1:"C",1:"N") D STA^DGMTSCU2
"RTN","DGMTSCC",97,0)
ADJQ Q
"RTN","DGMTSCC",98,0)
 ;
"RTN","DGMTSCC",99,0)
 ;DG*5.3*624 - REMOVE 10-10F AND REPLACE WITH 10-10EZ/EZR
"RTN","DGMTSCC",100,0)
PRT ;Print the 10-10EZR or 10-10EZ
"RTN","DGMTSCC",101,0)
 N EZFLAG
"RTN","DGMTSCC",102,0)
 I $D(DGFINOP) DO
"RTN","DGMTSCC",103,0)
 .W !!,"Options for printing financial assessment information will follow."
"RTN","DGMTSCC",104,0)
 .W !,"Generally, you should answer 'YES' to 'PRINT 10-10EZR?' after updating"
"RTN","DGMTSCC",105,0)
 .W !,"patient demographic or financial information.  Answer 'YES' to 'PRINT"
"RTN","DGMTSCC",106,0)
 .W !,"10-10EZ?' after entering new patient demographic and financial information."
"RTN","DGMTSCC",107,0)
 S EZFLAG=$$SEL1010^DG1010P("EZR/EZ")
"RTN","DGMTSCC",108,0)
 Q:(EZFLAG=-1)
"RTN","DGMTSCC",109,0)
 D QUE
"RTN","DGMTSCC",110,0)
 ;
"RTN","DGMTSCC",111,0)
PRTQ Q
"RTN","DGMTSCC",112,0)
 ;
"RTN","DGMTSCC",113,0)
 ;DG*5.3*624 - REMOVE 10-10F AND REPLACE WITH 10-10EZ/EZR
"RTN","DGMTSCC",114,0)
QUE ;
"RTN","DGMTSCC",115,0)
 N X
"RTN","DGMTSCC",116,0)
 I $G(EZFLAG)="EZ" S X=$$ENEZ^EASEZPDG(DFN,DGMTI)
"RTN","DGMTSCC",117,0)
 I $G(EZFLAG)="EZR" S X=$$ENEZR^EASEZPDG(DFN,DGMTI)
"RTN","DGMTSCC",118,0)
 Q
"VER")
8.0^22.0
"BLD",6021,6)
^619
**END**
**END**
