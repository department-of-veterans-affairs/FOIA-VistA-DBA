Released RMPR*3*86 SEQ #69
Extracted from mail message
**KIDS**:RMPR*3.0*86^

**INSTALL NAME**
RMPR*3.0*86
"BLD",4991,0)
RMPR*3.0*86^PROSTHETICS^0^3040303^y
"BLD",4991,1,0)
^^1^1^3040302^
"BLD",4991,1,1,0)
ENCAPSULATION OF IB.  USE OF INSUR API INSIDE PROSTHETICS BILLINGS REPORT.
"BLD",4991,4,0)
^9.64PA^^
"BLD",4991,"KRN",0)
^9.67PA^8989.52^19
"BLD",4991,"KRN",.4,0)
.4
"BLD",4991,"KRN",.401,0)
.401
"BLD",4991,"KRN",.402,0)
.402
"BLD",4991,"KRN",.403,0)
.403
"BLD",4991,"KRN",.5,0)
.5
"BLD",4991,"KRN",.84,0)
.84
"BLD",4991,"KRN",3.6,0)
3.6
"BLD",4991,"KRN",3.8,0)
3.8
"BLD",4991,"KRN",9.2,0)
9.2
"BLD",4991,"KRN",9.8,0)
9.8
"BLD",4991,"KRN",9.8,"NM",0)
^9.68A^1^1
"BLD",4991,"KRN",9.8,"NM",1,0)
RMPRBIL^^0^B30977369
"BLD",4991,"KRN",9.8,"NM","B","RMPRBIL",1)

"BLD",4991,"KRN",19,0)
19
"BLD",4991,"KRN",19.1,0)
19.1
"BLD",4991,"KRN",101,0)
101
"BLD",4991,"KRN",409.61,0)
409.61
"BLD",4991,"KRN",771,0)
771
"BLD",4991,"KRN",870,0)
870
"BLD",4991,"KRN",8989.51,0)
8989.51
"BLD",4991,"KRN",8989.52,0)
8989.52
"BLD",4991,"KRN",8994,0)
8994
"BLD",4991,"KRN","B",.4,.4)

"BLD",4991,"KRN","B",.401,.401)

"BLD",4991,"KRN","B",.402,.402)

"BLD",4991,"KRN","B",.403,.403)

"BLD",4991,"KRN","B",.5,.5)

"BLD",4991,"KRN","B",.84,.84)

"BLD",4991,"KRN","B",3.6,3.6)

"BLD",4991,"KRN","B",3.8,3.8)

"BLD",4991,"KRN","B",9.2,9.2)

"BLD",4991,"KRN","B",9.8,9.8)

"BLD",4991,"KRN","B",19,19)

"BLD",4991,"KRN","B",19.1,19.1)

"BLD",4991,"KRN","B",101,101)

"BLD",4991,"KRN","B",409.61,409.61)

"BLD",4991,"KRN","B",771,771)

"BLD",4991,"KRN","B",870,870)

"BLD",4991,"KRN","B",8989.51,8989.51)

"BLD",4991,"KRN","B",8989.52,8989.52)

"BLD",4991,"KRN","B",8994,8994)

"BLD",4991,"QUES",0)
^9.62^^
"BLD",4991,"REQB",0)
^9.611^1^1
"BLD",4991,"REQB",1,0)
IB*2.0*256^2
"BLD",4991,"REQB","B","IB*2.0*256",1)

"MBREQ")
0
"PKG",280,-1)
1^1
"PKG",280,0)
PROSTHETICS^RMPR^PROSTHETICS VERSION 3.0 ALPHA
"PKG",280,22,0)
^9.49I^1^1
"PKG",280,22,1,0)
3.0^2960209^2970624
"PKG",280,22,1,"PAH",1,0)
86^3040303
"PKG",280,22,1,"PAH",1,1,0)
^^1^1^3040303
"PKG",280,22,1,"PAH",1,1,1,0)
ENCAPSULATION OF IB.  USE OF INSUR API INSIDE PROSTHETICS BILLINGS REPORT.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
1
"RTN","RMPRBIL")
0^1^B30977369
"RTN","RMPRBIL",1,0)
RMPRBIL ;PHX/RFM/JLT-PROSTHETIC BILLINGS ;8/29/1994
"RTN","RMPRBIL",2,0)
 ;;3.0;PROSTHETICS;**44,55,69,86**;Feb 09, 1996
"RTN","RMPRBIL",3,0)
 ;
"RTN","RMPRBIL",4,0)
 ;WLC 3/02/2004 patch #86 - Encapsulation of IB
"RTN","RMPRBIL",5,0)
 ;
"RTN","RMPRBIL",6,0)
 ;RVD 4/29/02 patch #69 - add HCPCS and Short Description in the report.
"RTN","RMPRBIL",7,0)
 ;                        add ICD-9 and description.
"RTN","RMPRBIL",8,0)
 ;                        screen report for station.
"RTN","RMPRBIL",9,0)
 K ^TMP($J)
"RTN","RMPRBIL",10,0)
 N RMI,HDR2 S HDR2=0
"RTN","RMPRBIL",11,0)
 D HOME^%ZIS,DIV4^RMPRSIT G:$D(X) EXIT W !! S %DT("A")="Start With Delivery Date: ",%DT="AEPX" D ^%DT S RMPRBDT=Y G:Y<0 EXIT
"RTN","RMPRBIL",12,0)
 S %DT("A")="End With Delivery Date: ",%DT="AEX" D ^%DT I RMPRBDT>Y W !,$C(7),"Invalid Date Range Selection!!" G RMPRBIL
"RTN","RMPRBIL",13,0)
 S RMPREDT=Y G:Y<0 EXIT S Y=RMPRBDT D DD^%DT S RMPRX=Y,Y=RMPREDT D DD^%DT S RMPRY=Y
"RTN","RMPRBIL",14,0)
 S %ZIS="MQ" K IOP D ^%ZIS G:POP EXIT
"RTN","RMPRBIL",15,0)
 I '$D(IO("Q")) U IO G PRINT
"RTN","RMPRBIL",16,0)
 K IO("Q") S ZTRTN="PRINT^RMPRBIL",ZTIO=ION,ZTSAVE("RMPRBDT")="",ZTSAVE("RMPREDT")="",ZTSAVE("RMPRX")="",ZTSAVE("RMPRY")="",ZTSAVE("RMPR(""STA"")")="",ZTDESC="PRINT MAS BILLING" D ^%ZTLOAD W:$D(ZTSK) !,"REQUEST QUEUED!" H 1 G EXIT
"RTN","RMPRBIL",17,0)
PRINT S X1=RMPRBDT,X2=-1 D C^%DTC S RO=X,RP=0,PAGE=1,RMPRCOUN=0 I IOST["C-" D WAIT^DICD W !,"...PREPARING TO PRINT PROSTHETIC BILLING..." H 1
"RTN","RMPRBIL",18,0)
 F  S RO=$O(^RMPR(660,"CT",RO)) Q:RO'>0!(RO>RMPREDT)  F  S RP=$O(^RMPR(660,"CT",RO,RP)) Q:RP'>0  D CK
"RTN","RMPRBIL",19,0)
 S RMPT="",RMPREND="" F  S FL=1 S RMPT=$O(^TMP($J,RMPT)) Q:RMPT=""!(RMPREND=1)  F RP=0:0 S RP=$O(^TMP($J,RMPT,RP)) Q:RMPREND=1!(RP'>0)  D WRI
"RTN","RMPRBIL",20,0)
 I $D(RMPREDT)&(RMPRCOUN=0) W @IOF D HDR W !!,"NO SELECTIONS MADE DURING THIS DATE RANGE!!"
"RTN","RMPRBIL",21,0)
 I $D(RMPREDT),RMPRCOUN>0,'$D(RMPREND) W !!?32,"END OF REPORT" H 1
"RTN","RMPRBIL",22,0)
EXIT S:'$D(RMPREND) RMPREND="" I $E(IOST)["C"&($Y<20) F  W ! Q:$Y>20
"RTN","RMPRBIL",23,0)
 I $D(RMPREDT),RMPREND'=1,'$D(DTOUT),'$D(DUOUT),$E(IOST)["C",'$D(RMPRFLL) S DIR(0)="E" D ^DIR
"RTN","RMPRBIL",24,0)
EX K ROI,RMPRFLL,IBINS,J,RMPREND,DFN,DGCRINS,DGCRDD,DGCROUTP,DGCRINDT,DUOUT,DIR,RO,RP,RR,RMPRFLAG,FL,IZ,PAGE,RMPRY,RMPRITEM,RMPRCOUN,RMPRX,RMPRBDT,RMPREDT,RMPT,%DT,X,Y,IT,ZTSK,^TMP($J)
"RTN","RMPRBIL",25,0)
 K RMHCIEN,RMHCPCS,RMHCDES,RMPRICC,RMPRICD,RMPRIC9,RMPRA
"RTN","RMPRBIL",26,0)
 D ^%ZISC,KVAR^VADPT Q
"RTN","RMPRBIL",27,0)
CK Q:$S('$D(^RMPR(660,RP,"AM")):1,$P(^RMPR(660,RP,0),U,9)="":1,$P(^(0),U,12)="":1,$P(^(0),U,6)="":1,$P(^(0),U,14)="V":1,$P(^(0),U,2)="":1,$P(^(0),U,15)="*":1,$P(^("AM"),U,3)'=4:1,1:0)
"RTN","RMPRBIL",28,0)
 ;patch #69 (screen for station).
"RTN","RMPRBIL",29,0)
 I $P($G(^RMPR(660,RP,0)),U,10)'=RMPR("STA") Q
"RTN","RMPRBIL",30,0)
 K RMI S DFN=$P(^RMPR(660,RP,0),U,2) K RMI Q:'$$INSUR^IBBAPI(DFN,RO,"RB",.RMI,"*")
"RTN","RMPRBIL",31,0)
 S RMPRCOUN=RMPRCOUN+1,RMPT=$P(^DPT($P(^RMPR(660,RP,0),U,2),0),U,1),^TMP($J,RMPT,RP)=""
"RTN","RMPRBIL",32,0)
 Q
"RTN","RMPRBIL",33,0)
WRI I PAGE=1,'$D(RMPRFLG),$E(IOST)["C" W @IOF D HDR1
"RTN","RMPRBIL",34,0)
 I $Y>(IOSL-8),$E(IOST)["C",$D(RMPRFLAG) W ! S DIR(0)="E" D ^DIR S:Y=""!(Y=0) RMPREND=1 Q:Y=""  S:Y<1 RMPRFLL=1 Q:Y=0  D HDR
"RTN","RMPRBIL",35,0)
 I $Y>(IOSL-8) D HDR
"RTN","RMPRBIL",36,0)
 W ! I FL W !,$E(RMPT,1,20),?22,$E($P(^DPT($P(^RMPR(660,RP,0),U,2),0),U,9),6,9) S DFN=$P(^RMPR(660,RP,0),U,2) K RMI S X=$$INSUR^IBBAPI(DFN,,"RBA",.RMI,"*") I X>0 D DISP E  D ERRORD S FL=0 W !!
"RTN","RMPRBIL",37,0)
 S RMPRA=^RMPR(660,RP,0)
"RTN","RMPRBIL",38,0)
 W $$DAT1^RMPRUTL1($P($P(RMPRA,U,1),".",1))
"RTN","RMPRBIL",39,0)
 ;DELIVERY DATE SORT ON CT X-REF
"RTN","RMPRBIL",40,0)
 W ?9,$$DAT1^RMPRUTL1($P($P(RMPRA,U,12),".",1))
"RTN","RMPRBIL",41,0)
 I $P(RMPRA,U,4)="X" W ?17,"*"
"RTN","RMPRBIL",42,0)
 ;
"RTN","RMPRBIL",43,0)
ITE ;
"RTN","RMPRBIL",44,0)
 ;added by patch #69
"RTN","RMPRBIL",45,0)
HCPCS S (RMHCPCS,RMHCDES)="" K RMHCIEN
"RTN","RMPRBIL",46,0)
 I $D(^RMPR(660,RP,1)) S RMHCIEN=$P(^RMPR(660,RP,1),U,4) D
"RTN","RMPRBIL",47,0)
 .I $G(RMHCIEN) S RMHCPCS=$P($G(^RMPR(661.1,RMHCIEN,0)),U,1),RMHCDES=$P($G(^RMPR(661.1,RMHCIEN,0)),U,2)
"RTN","RMPRBIL",48,0)
ICD9 S (RMPRICC,RMPRICD)="" K RMPRIC9
"RTN","RMPRBIL",49,0)
 S RMPRICC=$G(R19(660,RP,8.8,"E"))
"RTN","RMPRBIL",50,0)
 I $D(^RMPR(660,RP,10)) S RMPRIC9=$P(^RMPR(660,RP,10),U,8)
"RTN","RMPRBIL",51,0)
 I $G(RMPRIC9),$D(^ICD9(RMPRIC9,0)) S RMPRICD=$G(^ICD9(RMPRIC9,1)),RMPRICC=$P($G(^ICD9(RMPRIC9,0)),U,1)
"RTN","RMPRBIL",52,0)
 ;
"RTN","RMPRBIL",53,0)
 I $P(^RMPR(660,RP,0),U,4)'="X" D
"RTN","RMPRBIL",54,0)
 .W ?19,$E($P(^PRC(441,$P(^RMPR(661,$P(^RMPR(660,RP,0),U,6),0),U,1),0),U,2),1,30)
"RTN","RMPRBIL",55,0)
 .W ?52,"QTY: ",$P(^RMPR(660,RP,0),U,7),?59,"TOTAL COST: ",?70,$J($FN($P(^RMPR(660,RP,0),U,16),"P",2),9)
"RTN","RMPRBIL",56,0)
 .W !,"HCPCS: ",RMHCPCS,?19,RMHCDES
"RTN","RMPRBIL",57,0)
 .W !,"ICD-9 Code: ",RMPRICC,?19,$E(RMPRICD,1,55)
"RTN","RMPRBIL",58,0)
 E  D
"RTN","RMPRBIL",59,0)
 .S RMPRITEM=$E($P(^PRC(441,$P(^RMPR(661,$P(^RMPR(660,RP,0),U,6),0),U,1),0),U,2),1,30)
"RTN","RMPRBIL",60,0)
 .I $D(^RMPR(660,RP,1)) W ?19,$E($P(^(1),U,2),1,30)
"RTN","RMPRBIL",61,0)
 .I $D(^RMPR(660,RP,1)),$P(^(1),U,2)="" W ?19,RMPRITEM
"RTN","RMPRBIL",62,0)
 .W ?52,"QTY: ",$P(^RMPR(660,RP,0),U,7),?59,"TOTAL COST: ",?70,$J($FN($P(^RMPR(660,RP,0),U,16),"P",2),9)
"RTN","RMPRBIL",63,0)
 .I '$D(^RMPR(660,RP,1)) W ?19,RMPRITEM
"RTN","RMPRBIL",64,0)
 .W !,"HCPCS: ",RMHCPCS,?19,RMHCDES
"RTN","RMPRBIL",65,0)
 .W !,"ICD-9 Code: ",RMPRICC,?19,$E(RMPRICD,1,55)
"RTN","RMPRBIL",66,0)
 .I $D(^RMPR(660,RP,"DES",0)) S RR=0 F  S RR=$O(^RMPR(660,RP,"DES",RR)) Q:RR'>0  W !,?4,$P(^RMPR(660,RP,"DES",RR,0),U)
"RTN","RMPRBIL",67,0)
 W !
"RTN","RMPRBIL",68,0)
 Q
"RTN","RMPRBIL",69,0)
HDR W:$Y>(IOSL-8) @IOF
"RTN","RMPRBIL",70,0)
HDR1 W !,?5,"PATIENT NAME",?22,"SSN",?38," " S Y=RMPRBDT D DD^%DT W Y,"-" S Y=RMPREDT D DD^%DT W Y,?64,"STA ",$$STA^RMPRUTIL,?73,"PAGE ",PAGE
"RTN","RMPRBIL",71,0)
 S HDR2=0,PAGE=PAGE+1,FL=1,$P(IZ,"-",IOM)="",RMPRFLAG=1 W !,IZ
"RTN","RMPRBIL",72,0)
 Q
"RTN","RMPRBIL",73,0)
 ;
"RTN","RMPRBIL",74,0)
ERRORD ; network error message
"RTN","RMPRBIL",75,0)
 I $D(RMI("IBBAPI","INSUR","ERROR")) D HDR W !!,"AN ERROR WITH INSURANCE RETRIEVAL HAS CAUSED THIS OPTION TO BE TERMINATED.  PLEASE TRY THIS REPORT AT A LATER TIME."
"RTN","RMPRBIL",76,0)
 Q
"RTN","RMPRBIL",77,0)
 ;
"RTN","RMPRBIL",78,0)
DISP ; mimics DISP^IBCNS
"RTN","RMPRBIL",79,0)
 Q:'$D(DFN)  D:'$D(IOF) HOME^%ZIS
"RTN","RMPRBIL",80,0)
 D HDR2
"RTN","RMPRBIL",81,0)
 I '$D(RMI) W !,"    No Insurance Information" Q
"RTN","RMPRBIL",82,0)
 ;
"RTN","RMPRBIL",83,0)
 S X="" F  S X=$O(RMI("IBBAPI","INSUR",X)) Q:'X  D D1
"RTN","RMPRBIL",84,0)
 W !
"RTN","RMPRBIL",85,0)
 Q
"RTN","RMPRBIL",86,0)
 ;
"RTN","RMPRBIL",87,0)
D1 N J,Y,Z,CAT,DAT,DAT1 Q:'$D(RMI("IBBAPI","INSUR",X,1))
"RTN","RMPRBIL",88,0)
 W !?3,$E($P(RMI("IBBAPI","INSUR",X,1),U,2),1,10)
"RTN","RMPRBIL",89,0)
 ; extract COB indicator
"RTN","RMPRBIL",90,0)
 S Z="",J=$P(RMI("IBBAPI","INSUR",X,7),U,2)
"RTN","RMPRBIL",91,0)
 S Y=+(RMI("IBBAPI","INSUR",X,7)) W ?16,$P("p^s^t",U,+(RMI("IBBAPI","INSUR",X,7)))
"RTN","RMPRBIL",92,0)
 W ?19,$E(RMI("IBBAPI","INSUR",X,14),1,16)
"RTN","RMPRBIL",93,0)
 S Y=$$GET1^DIQ(355.3,+RMI("IBBAPI","INSUR",X,8)_",",.04)
"RTN","RMPRBIL",94,0)
 W ?37,$E(Y,1,10)
"RTN","RMPRBIL",95,0)
 W ?49,$P(RMI("IBBAPI","INSUR",X,12),U,2)
"RTN","RMPRBIL",96,0)
 S DAT=RMI("IBBAPI","INSUR",X,10)
"RTN","RMPRBIL",97,0)
 W:DAT'="" ?57,$E(DAT,4,5)_"/"_$E(DAT,6,7)_"/"_$E(DAT,2,3)
"RTN","RMPRBIL",98,0)
 S DAT1=RMI("IBBAPI","INSUR",X,11)
"RTN","RMPRBIL",99,0)
 W:DAT1'="" ?67,$E(DAT1,4,5)_"/"_$E(DAT1,6,7)_"/"_$E(DAT1,2,3)
"RTN","RMPRBIL",100,0)
 I +RMI("IBBAPI","INSUR",X,9)=0 W ?75," *WNR*"
"RTN","RMPRBIL",101,0)
 ; removed for date parameter.
"RTN","RMPRBIL",102,0)
 ;S Z="" F Y=15:1:17 D
"RTN","RMPRBIL",103,0)
 ;. S CAT=$P("r^o^i",U,(Y-14))
"RTN","RMPRBIL",104,0)
 ;. S:+RMI("IBBAPI","INSUR",X,Y)=1 Z=Z_CAT
"RTN","RMPRBIL",105,0)
 ;W ?75,Z
"RTN","RMPRBIL",106,0)
 Q
"RTN","RMPRBIL",107,0)
HDR2 ;
"RTN","RMPRBIL",108,0)
 W !,?2,"Insurance",?15,"COB",?19,"Subscriber ID",?37,"Group",?49,"Holder",?57,"Effective",?67,"Expires"
"RTN","RMPRBIL",109,0)
 N Z S $P(Z,"=",78)="" W !?2,Z
"RTN","RMPRBIL",110,0)
 S HDR2=0
"RTN","RMPRBIL",111,0)
 Q
"RTN","RMPRBIL",112,0)
 ;
"VER")
8.0^22
**END**
**END**
