Released RG*1*37 SEQ #36
Extracted from mail message
**KIDS**:RG*1.0*37^

**INSTALL NAME**
RG*1.0*37
"BLD",2060,0)
RG*1.0*37^CLINICAL INFO RESOURCE NETWORK^0^3040825^y
"BLD",2060,1,0)
^^3^3^3040825^
"BLD",2060,1,1,0)
REMOTE QUERY FAILS DUE TO BOGUS SSN
"BLD",2060,1,2,0)
Refer to patch RG*1.0*37 in the FORUM Patch Module for a complete
"BLD",2060,1,3,0)
description.
"BLD",2060,4,0)
^9.64PA^^
"BLD",2060,"ABNS",0)
^9.66A^^
"BLD",2060,"ABPKG")
^^
"BLD",2060,"KRN",0)
^9.67PA^8989.52^19
"BLD",2060,"KRN",.4,0)
.4
"BLD",2060,"KRN",.4,"NM",0)
^9.68A^^
"BLD",2060,"KRN",.401,0)
.401
"BLD",2060,"KRN",.402,0)
.402
"BLD",2060,"KRN",.403,0)
.403
"BLD",2060,"KRN",.5,0)
.5
"BLD",2060,"KRN",.84,0)
.84
"BLD",2060,"KRN",3.6,0)
3.6
"BLD",2060,"KRN",3.8,0)
3.8
"BLD",2060,"KRN",9.2,0)
9.2
"BLD",2060,"KRN",9.8,0)
9.8
"BLD",2060,"KRN",9.8,"NM",0)
^9.68A^1^1
"BLD",2060,"KRN",9.8,"NM",1,0)
RGMTUT02^^0^B15469048
"BLD",2060,"KRN",9.8,"NM","B","RGMTUT02",1)

"BLD",2060,"KRN",19,0)
19
"BLD",2060,"KRN",19.1,0)
19.1
"BLD",2060,"KRN",101,0)
101
"BLD",2060,"KRN",409.61,0)
409.61
"BLD",2060,"KRN",771,0)
771
"BLD",2060,"KRN",870,0)
870
"BLD",2060,"KRN",8989.51,0)
8989.51
"BLD",2060,"KRN",8989.52,0)
8989.52
"BLD",2060,"KRN",8994,0)
8994
"BLD",2060,"KRN","B",.4,.4)

"BLD",2060,"KRN","B",.401,.401)

"BLD",2060,"KRN","B",.402,.402)

"BLD",2060,"KRN","B",.403,.403)

"BLD",2060,"KRN","B",.5,.5)

"BLD",2060,"KRN","B",.84,.84)

"BLD",2060,"KRN","B",3.6,3.6)

"BLD",2060,"KRN","B",3.8,3.8)

"BLD",2060,"KRN","B",9.2,9.2)

"BLD",2060,"KRN","B",9.8,9.8)

"BLD",2060,"KRN","B",19,19)

"BLD",2060,"KRN","B",19.1,19.1)

"BLD",2060,"KRN","B",101,101)

"BLD",2060,"KRN","B",409.61,409.61)

"BLD",2060,"KRN","B",771,771)

"BLD",2060,"KRN","B",870,870)

"BLD",2060,"KRN","B",8989.51,8989.51)

"BLD",2060,"KRN","B",8989.52,8989.52)

"BLD",2060,"KRN","B",8994,8994)

"BLD",2060,"QUES",0)
^9.62^^
"BLD",2060,"REQB",0)
^9.611^1^1
"BLD",2060,"REQB",1,0)
RG*1.0*20^2
"BLD",2060,"REQB","B","RG*1.0*20",1)

"MBREQ")
0
"PKG",272,-1)
1^1
"PKG",272,0)
CLINICAL INFO RESOURCE NETWORK^RG^CIRN
"PKG",272,20,0)
^9.402P^^0
"PKG",272,22,0)
^9.49I^1^1
"PKG",272,22,1,0)
1.0^2990430^2990601^12555
"PKG",272,22,1,"PAH",1,0)
37^3040825
"PKG",272,22,1,"PAH",1,1,0)
^^3^3^3040825
"PKG",272,22,1,"PAH",1,1,1,0)
REMOTE QUERY FAILS DUE TO BOGUS SSN
"PKG",272,22,1,"PAH",1,1,2,0)
Refer to patch RG*1.0*37 in the FORUM Patch Module for a complete
"PKG",272,22,1,"PAH",1,1,3,0)
description.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
1
"RTN","RGMTUT02")
0^1^B15469048
"RTN","RGMTUT02",1,0)
RGMTUT02 ;BIR/CML-MPI/PD Compile and Correct Data Validation Data for Local Sites (CON'T) ;07/30/02
"RTN","RGMTUT02",2,0)
 ;;1.0;CLINICAL INFO RESOURCE NETWORK;**20,37**;30 Apr 99
"RTN","RGMTUT02",3,0)
 ;
"RTN","RGMTUT02",4,0)
 ;Reference to ^DPT("AICN" & ^DPT("AICNL" supported by IA #2070
"RTN","RGMTUT02",5,0)
 ;Reference to $$SETLOC MPIF001 supported by IA #2705
"RTN","RGMTUT02",6,0)
 ;Reference to EDIT^VAFCPTED supported by IA #2784
"RTN","RGMTUT02",7,0)
 ;
"RTN","RGMTUT02",8,0)
 Q
"RTN","RGMTUT02",9,0)
 ;
"RTN","RGMTUT02",10,0)
REIND ;Correct any existing xref problems:
"RTN","RGMTUT02",11,0)
 ; - missing SSN xref (only if they have a local or national ICN)
"RTN","RGMTUT02",12,0)
 ; - missing AICN xref
"RTN","RGMTUT02",13,0)
 ; - missing AICNL xref and field Locally assigned ICN
"RTN","RGMTUT02",14,0)
 ;Also get counts of national ICNs, Local ICNs and NO ICNs
"RTN","RGMTUT02",15,0)
 ;
"RTN","RGMTUT02",16,0)
 ;NOSSN = number of patients missing an SSN xref (only if they have a local or national ICN)
"RTN","RGMTUT02",17,0)
 ;NOAICN = number of patients missing an AICN xref
"RTN","RGMTUT02",18,0)
 ;NOAICNL = number of patients missing an AICNL xref
"RTN","RGMTUT02",19,0)
 ;NICNCNT = number of patients with a national ICN
"RTN","RGMTUT02",20,0)
 ;LICNCNT = number of patients with a local ICN
"RTN","RGMTUT02",21,0)
 ;NOICNCNT = number of patients no ICN
"RTN","RGMTUT02",22,0)
 ;
"RTN","RGMTUT02",23,0)
 S CURDT=$P($$NOW^XLFDT,".")
"RTN","RGMTUT02",24,0)
 I $G(^XTMP("RGMT","REINDDT"))=CURDT D  Q
"RTN","RGMTUT02",25,0)
 .I '$D(RGHLMQ) W !!,"Check for missing xrefs and counts already run today."
"RTN","RGMTUT02",26,0)
 I $G(^XTMP("RGMT","REINDDT"))'=CURDT K ^XTMP("RGMT","REINDDT")
"RTN","RGMTUT02",27,0)
 I '$D(^XTMP("RGMT","REINDDT")) S ^XTMP("RGMT","REINDDT")=CURDT
"RTN","RGMTUT02",28,0)
 ;
"RTN","RGMTUT02",29,0)
 K ^XTMP("RGMT","UT01","REIND")
"RTN","RGMTUT02",30,0)
 S (NOSSN,NOAICN,NOAICNL,NICNCNT,LICNCNT,NOICNCNT,DFNCNT)=0
"RTN","RGMTUT02",31,0)
 F TYPE="MISSING SSN XREF","MISSING AICN XREF","MISSING AICNL XREF","NATIONAL ICN COUNT","LOCAL ICN COUNT","NO ICN COUNT" D
"RTN","RGMTUT02",32,0)
 .S ^XTMP("RGMT","UT01","REIND",TYPE)=0
"RTN","RGMTUT02",33,0)
 ;
"RTN","RGMTUT02",34,0)
 S SITE=$P($$SITE^VASITE(),"^",3)
"RTN","RGMTUT02",35,0)
 ;
"RTN","RGMTUT02",36,0)
 I '$D(RGHLMQ) D
"RTN","RGMTUT02",37,0)
 .W !!,"Checking for:"
"RTN","RGMTUT02",38,0)
 .W !,"Missing ""SSN"" xrefs in ^DPT"
"RTN","RGMTUT02",39,0)
 .W !,"Missing ""AICN"" xrefs in ^DPT"
"RTN","RGMTUT02",40,0)
 .W !,"Missing ""AICNL"" xrefs in ^DPT"
"RTN","RGMTUT02",41,0)
 .W !,"Counts on total National ICNs"
"RTN","RGMTUT02",42,0)
 .W !,"Counts on total Local ICNs"
"RTN","RGMTUT02",43,0)
 .W !,"Counts on total patients without ICNs"
"RTN","RGMTUT02",44,0)
 ;
"RTN","RGMTUT02",45,0)
 S DFN=0 F  S DFN=$O(^DPT(DFN)) Q:'DFN  S DFNCNT=DFNCNT+1 S MNODE=$G(^DPT(DFN,"MPI")) D
"RTN","RGMTUT02",46,0)
 .I '$D(RGHLMQ),'(DFNCNT#10000) W !,DFN
"RTN","RGMTUT02",47,0)
 .I MNODE="" S NOICNCNT=NOICNCNT+1 Q
"RTN","RGMTUT02",48,0)
 .S ICN=$P(MNODE,"^") I ICN="" S NOICNCNT=NOICNCNT+1 Q
"RTN","RGMTUT02",49,0)
 .S SSN=$P($G(^DPT(DFN,0)),"^",9)
"RTN","RGMTUT02",50,0)
 .I $G(SSN),'$D(^DPT("SSN",SSN,DFN)) S NOSSN=NOSSN+1 D
"RTN","RGMTUT02",51,0)
 ..; if SSN xref exists for a different patient, send exception and quit
"RTN","RGMTUT02",52,0)
 ..; otherwise, edit the field to set the xref
"RTN","RGMTUT02",53,0)
 ..I $D(^DPT("SSN",SSN)) D  Q
"RTN","RGMTUT02",54,0)
 ...D EXC^RGHLLOG(210,"SSN xref does not exist for patient DFN #"_DFN_" for SSN "_SSN_". This SSN appears to exist for a different patient.",DFN)
"RTN","RGMTUT02",55,0)
 ..I $L(SSN)>8 K ARR S ARR(2,.09)=SSN D EDIT^VAFCPTED(DFN,"ARR(2)",".09")
"RTN","RGMTUT02",56,0)
 .I '$D(^DPT("AICN",ICN,DFN)) S NOAICN=NOAICN+1,^DPT("AICN",ICN,DFN)=""
"RTN","RGMTUT02",57,0)
 .I $E(ICN,1,3)'=SITE S NICNCNT=NICNCNT+1 Q
"RTN","RGMTUT02",58,0)
 .I $E(ICN,1,3)=SITE D
"RTN","RGMTUT02",59,0)
 ..S LICNCNT=LICNCNT+1
"RTN","RGMTUT02",60,0)
 ..I '$D(^DPT("AICNL",1,DFN)) S LOCAL=$$SETLOC^MPIF001(DFN,1),^DPT("AICNL",1,DFN)="",NOAICNL=NOAICNL+1
"RTN","RGMTUT02",61,0)
 ;
"RTN","RGMTUT02",62,0)
 S ^XTMP("RGMT","UT01","REIND","MISSING SSN XREF")=NOSSN
"RTN","RGMTUT02",63,0)
 S ^XTMP("RGMT","UT01","REIND","MISSING AICN XREF")=NOAICN
"RTN","RGMTUT02",64,0)
 S ^XTMP("RGMT","UT01","REIND","MISSING AICNL XREF")=NOAICNL
"RTN","RGMTUT02",65,0)
 S ^XTMP("RGMT","UT01","REIND","NATIONAL ICN COUNT")=NICNCNT
"RTN","RGMTUT02",66,0)
 S ^XTMP("RGMT","UT01","REIND","LOCAL ICN COUNT")=LICNCNT
"RTN","RGMTUT02",67,0)
 S ^XTMP("RGMT","UT01","REIND","NO ICN COUNT")=NOICNCNT
"RTN","RGMTUT02",68,0)
 ;
"RTN","RGMTUT02",69,0)
 I '$D(RGHLMQ) D
"RTN","RGMTUT02",70,0)
 .W !!,"Results:"
"RTN","RGMTUT02",71,0)
 .W !?3,"Missing SSN xrefs created",?41,$J(NOSSN,7)
"RTN","RGMTUT02",72,0)
 .W !?3,"Missing AICN xrefs created",?41,$J(NOAICN,7)
"RTN","RGMTUT02",73,0)
 .W !?3,"Missing AICNL xrefs created",?41,$J(NOAICNL,7)
"RTN","RGMTUT02",74,0)
 .W !?3,"Total DFNs processed   : ",$J(DFNCNT,8)
"RTN","RGMTUT02",75,0)
 .W !?6,"Total National ICNs : ",$J(NICNCNT,8)
"RTN","RGMTUT02",76,0)
 .W !?6,"Total Local ICNs    : ",$J(LICNCNT,8)
"RTN","RGMTUT02",77,0)
 .W !?6,"Total without ICNs  : ",$J(NOICNCNT,8)
"RTN","RGMTUT02",78,0)
 .W !!,"(List global ^XTMP(""RGMT"",""UT01"",""REIND"" for data.)"
"RTN","RGMTUT02",79,0)
 ;
"RTN","RGMTUT02",80,0)
 K ARR,CURDT,DFN,DFNCNT,ICN,LICNCNT,LOCAL,MNODE,NICNCNT,NOAICN,NOAICNL,NOICNCNT,NOSSN,SITE,SSN,TYPE
"RTN","RGMTUT02",81,0)
 Q
"VER")
8.0^22.0
**END**
**END**
