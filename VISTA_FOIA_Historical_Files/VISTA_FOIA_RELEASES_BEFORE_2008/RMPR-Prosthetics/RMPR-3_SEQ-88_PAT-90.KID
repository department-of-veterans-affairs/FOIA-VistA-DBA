Released RMPR*3*90 SEQ #88
Extracted from mail message
**KIDS**:RMPR*3.0*90^

**INSTALL NAME**
RMPR*3.0*90
"BLD",5535,0)
RMPR*3.0*90^PROSTHETICS^0^3050822^y
"BLD",5535,4,0)
^9.64PA^669.9^3
"BLD",5535,4,660,0)
660
"BLD",5535,4,660,2,0)
^9.641^660^1
"BLD",5535,4,660,2,660,0)
RECORD OF PROS APPLIANCE/REPAIR  (File-top level)
"BLD",5535,4,660,2,660,1,0)
^9.6411^38.8^4
"BLD",5535,4,660,2,660,1,2,0)
TYPE OF TRANSACTION
"BLD",5535,4,660,2,660,1,38.1,0)
EXCLUDE/WAVER
"BLD",5535,4,660,2,660,1,38.7,0)
CONTRACT #
"BLD",5535,4,660,2,660,1,38.8,0)
NUMBER OF BIDS
"BLD",5535,4,660,222)
y^n^p^^^^n^^n
"BLD",5535,4,660,224)

"BLD",5535,4,664,0)
664
"BLD",5535,4,664,2,0)
^9.641^664^2
"BLD",5535,4,664,2,664,0)
PROSTHETICS 1358  (File-top level)
"BLD",5535,4,664,2,664,1,0)
^9.6411^21.1^1
"BLD",5535,4,664,2,664,1,21.1,0)
DELIVER TO ATTENTION
"BLD",5535,4,664,2,664.02,0)
BILLING ITEM  (sub-file)
"BLD",5535,4,664,2,664.02,1,0)
^9.6411^8^7
"BLD",5535,4,664,2,664.02,1,.01,0)
BILLING ITEM
"BLD",5535,4,664,2,664.02,1,8,0)
TYPE OF TRANSACTION
"BLD",5535,4,664,2,664.02,1,15.2,0)
MAKE
"BLD",5535,4,664,2,664.02,1,15.4,0)
MODEL
"BLD",5535,4,664,2,664.02,1,15.6,0)
LOT #
"BLD",5535,4,664,2,664.02,1,18,0)
EXCLUDE/WAVER
"BLD",5535,4,664,2,664.02,1,19,0)
NUMBER OF BIDS
"BLD",5535,4,664,222)
y^n^p^^^^n^^n
"BLD",5535,4,664,224)

"BLD",5535,4,669.9,0)
669.9
"BLD",5535,4,669.9,222)
y^n^f^^^^n^^n
"BLD",5535,4,669.9,224)

"BLD",5535,4,"APDD",660,660)

"BLD",5535,4,"APDD",660,660,2)

"BLD",5535,4,"APDD",660,660,38.1)

"BLD",5535,4,"APDD",660,660,38.7)

"BLD",5535,4,"APDD",660,660,38.8)

"BLD",5535,4,"APDD",664,664)

"BLD",5535,4,"APDD",664,664,21.1)

"BLD",5535,4,"APDD",664,664.02)

"BLD",5535,4,"APDD",664,664.02,.01)

"BLD",5535,4,"APDD",664,664.02,8)

"BLD",5535,4,"APDD",664,664.02,15.2)

"BLD",5535,4,"APDD",664,664.02,15.4)

"BLD",5535,4,"APDD",664,664.02,15.6)

"BLD",5535,4,"APDD",664,664.02,18)

"BLD",5535,4,"APDD",664,664.02,19)

"BLD",5535,4,"B",660,660)

"BLD",5535,4,"B",664,664)

"BLD",5535,4,"B",669.9,669.9)

"BLD",5535,"ABPKG")
n
"BLD",5535,"INI")

"BLD",5535,"INID")
^^
"BLD",5535,"KRN",0)
^9.67PA^8989.52^19
"BLD",5535,"KRN",.4,0)
.4
"BLD",5535,"KRN",.4,"NM",0)
^9.68A^1^1
"BLD",5535,"KRN",.4,"NM",1,0)
RMPR WH DISPLAY    FILE #664^664^0
"BLD",5535,"KRN",.4,"NM","B","RMPR WH DISPLAY    FILE #664",1)

"BLD",5535,"KRN",.401,0)
.401
"BLD",5535,"KRN",.402,0)
.402
"BLD",5535,"KRN",.402,"NM",0)
^9.68A^2^2
"BLD",5535,"KRN",.402,"NM",1,0)
RMPR ENTER WAVIER EXCLUDE    FILE #660^660^0
"BLD",5535,"KRN",.402,"NM",2,0)
RMPR ENTER CONTRACT    FILE #660^660^0
"BLD",5535,"KRN",.402,"NM","B","RMPR ENTER CONTRACT    FILE #660",2)

"BLD",5535,"KRN",.402,"NM","B","RMPR ENTER WAVIER EXCLUDE    FILE #660",1)

"BLD",5535,"KRN",.403,0)
.403
"BLD",5535,"KRN",.5,0)
.5
"BLD",5535,"KRN",.84,0)
.84
"BLD",5535,"KRN",3.6,0)
3.6
"BLD",5535,"KRN",3.8,0)
3.8
"BLD",5535,"KRN",9.2,0)
9.2
"BLD",5535,"KRN",9.8,0)
9.8
"BLD",5535,"KRN",9.8,"NM",0)
^9.68A^42^38
"BLD",5535,"KRN",9.8,"NM",1,0)
RMPR121B^^0^B17535480
"BLD",5535,"KRN",9.8,"NM",2,0)
RMPR121C^^0^B10766286
"BLD",5535,"KRN",9.8,"NM",3,0)
RMPR9AUT^^0^B19928120
"BLD",5535,"KRN",9.8,"NM",5,0)
RMPR9PCD^^0^B3633017
"BLD",5535,"KRN",9.8,"NM",6,0)
RMPR121A^^0^B1667724
"BLD",5535,"KRN",9.8,"NM",7,0)
RMPR21A^^0^B43366806
"BLD",5535,"KRN",9.8,"NM",9,0)
RMPRSEA^^0^B26605504
"BLD",5535,"KRN",9.8,"NM",10,0)
RMPRESI^^0^B7878670
"BLD",5535,"KRN",9.8,"NM",11,0)
RMPR9CA^^0^B59700154
"BLD",5535,"KRN",9.8,"NM",12,0)
RMPRSIT^^0^B5360286
"BLD",5535,"KRN",9.8,"NM",13,0)
RMPR4M^^0^B29129320
"BLD",5535,"KRN",9.8,"NM",14,0)
RMPRP21^^0^B31670001
"BLD",5535,"KRN",9.8,"NM",15,0)
RMPR4P22^^0^B21879825
"BLD",5535,"KRN",9.8,"NM",16,0)
RMPR4P21^^0^B31209591
"BLD",5535,"KRN",9.8,"NM",18,0)
RMPRUTL4^^0^B1833508
"BLD",5535,"KRN",9.8,"NM",19,0)
RMPRPAT3^^0^B39519148
"BLD",5535,"KRN",9.8,"NM",20,0)
RMPR9LN1^^0^B7433014
"BLD",5535,"KRN",9.8,"NM",21,0)
RMPR9LNP^^0^B7775450
"BLD",5535,"KRN",9.8,"NM",22,0)
RMPR9S4^^0^B29702431
"BLD",5535,"KRN",9.8,"NM",23,0)
RMPR9S4E^^0^B41319639
"BLD",5535,"KRN",9.8,"NM",24,0)
RMPR9DO^^0^B87076103
"BLD",5535,"KRN",9.8,"NM",25,0)
RMPRN6^^0^B84903534
"BLD",5535,"KRN",9.8,"NM",26,0)
RMPRN6S^^0^B4484557
"BLD",5535,"KRN",9.8,"NM",27,0)
RMPRN6XM^^0^B18513866
"BLD",5535,"KRN",9.8,"NM",28,0)
RMPRN7^^0^B74857178
"BLD",5535,"KRN",9.8,"NM",29,0)
RMPR4LI^^0^B14468243
"BLD",5535,"KRN",9.8,"NM",30,0)
RMPRAINQ^^0^B23461371
"BLD",5535,"KRN",9.8,"NM",32,0)
RMPRED6^^0^B47536082
"BLD",5535,"KRN",9.8,"NM",33,0)
RMPRHIS^^0^B12988629
"BLD",5535,"KRN",9.8,"NM",34,0)
RMPRHISD^^0^B8266515
"BLD",5535,"KRN",9.8,"NM",35,0)
RMPRL9^^0^B23118743
"BLD",5535,"KRN",9.8,"NM",36,0)
RMPRLI^^0^B12355017
"BLD",5535,"KRN",9.8,"NM",37,0)
RMPRSE1^^0^B21618180
"BLD",5535,"KRN",9.8,"NM",38,0)
RMPRSE2^^0^B22152998
"BLD",5535,"KRN",9.8,"NM",39,0)
RMPRSE21^^0^B28209992
"BLD",5535,"KRN",9.8,"NM",40,0)
RMPR9P21^^0^B39737289
"BLD",5535,"KRN",9.8,"NM",41,0)
RMPR9P22^^0^B33980681
"BLD",5535,"KRN",9.8,"NM",42,0)
RMPR9S6^^0^B650496
"BLD",5535,"KRN",9.8,"NM","B","RMPR121A",6)

"BLD",5535,"KRN",9.8,"NM","B","RMPR121B",1)

"BLD",5535,"KRN",9.8,"NM","B","RMPR121C",2)

"BLD",5535,"KRN",9.8,"NM","B","RMPR21A",7)

"BLD",5535,"KRN",9.8,"NM","B","RMPR4LI",29)

"BLD",5535,"KRN",9.8,"NM","B","RMPR4M",13)

"BLD",5535,"KRN",9.8,"NM","B","RMPR4P21",16)

"BLD",5535,"KRN",9.8,"NM","B","RMPR4P22",15)

"BLD",5535,"KRN",9.8,"NM","B","RMPR9AUT",3)

"BLD",5535,"KRN",9.8,"NM","B","RMPR9CA",11)

"BLD",5535,"KRN",9.8,"NM","B","RMPR9DO",24)

"BLD",5535,"KRN",9.8,"NM","B","RMPR9LN1",20)

"BLD",5535,"KRN",9.8,"NM","B","RMPR9LNP",21)

"BLD",5535,"KRN",9.8,"NM","B","RMPR9P21",40)

"BLD",5535,"KRN",9.8,"NM","B","RMPR9P22",41)

"BLD",5535,"KRN",9.8,"NM","B","RMPR9PCD",5)

"BLD",5535,"KRN",9.8,"NM","B","RMPR9S4",22)

"BLD",5535,"KRN",9.8,"NM","B","RMPR9S4E",23)

"BLD",5535,"KRN",9.8,"NM","B","RMPR9S6",42)

"BLD",5535,"KRN",9.8,"NM","B","RMPRAINQ",30)

"BLD",5535,"KRN",9.8,"NM","B","RMPRED6",32)

"BLD",5535,"KRN",9.8,"NM","B","RMPRESI",10)

"BLD",5535,"KRN",9.8,"NM","B","RMPRHIS",33)

"BLD",5535,"KRN",9.8,"NM","B","RMPRHISD",34)

"BLD",5535,"KRN",9.8,"NM","B","RMPRL9",35)

"BLD",5535,"KRN",9.8,"NM","B","RMPRLI",36)

"BLD",5535,"KRN",9.8,"NM","B","RMPRN6",25)

"BLD",5535,"KRN",9.8,"NM","B","RMPRN6S",26)

"BLD",5535,"KRN",9.8,"NM","B","RMPRN6XM",27)

"BLD",5535,"KRN",9.8,"NM","B","RMPRN7",28)

"BLD",5535,"KRN",9.8,"NM","B","RMPRP21",14)

"BLD",5535,"KRN",9.8,"NM","B","RMPRPAT3",19)

"BLD",5535,"KRN",9.8,"NM","B","RMPRSE1",37)

"BLD",5535,"KRN",9.8,"NM","B","RMPRSE2",38)

"BLD",5535,"KRN",9.8,"NM","B","RMPRSE21",39)

"BLD",5535,"KRN",9.8,"NM","B","RMPRSEA",9)

"BLD",5535,"KRN",9.8,"NM","B","RMPRSIT",12)

"BLD",5535,"KRN",9.8,"NM","B","RMPRUTL4",18)

"BLD",5535,"KRN",19,0)
19
"BLD",5535,"KRN",19,"NM",0)
^9.68A^13^11
"BLD",5535,"KRN",19,"NM",1,0)
RMPR PURCHASE ORDER GUI^^0
"BLD",5535,"KRN",19,"NM",3,0)
RMPR ENTER WAVIER^^0
"BLD",5535,"KRN",19,"NM",4,0)
RMPR ENTER CONTRACT^^0
"BLD",5535,"KRN",19,"NM",5,0)
RMPR WH DISPLAY^^0
"BLD",5535,"KRN",19,"NM",6,0)
RMPR UTILITIES^^2
"BLD",5535,"KRN",19,"NM",7,0)
RMPR PURCHASING MENU^^2
"BLD",5535,"KRN",19,"NM",9,0)
RMPR PRINT BILL^^0
"BLD",5535,"KRN",19,"NM",10,0)
RMPR NPPD GUI^^0
"BLD",5535,"KRN",19,"NM",11,0)
RMPR OFFICIAL^^2
"BLD",5535,"KRN",19,"NM",12,0)
RMPR CLERK^^2
"BLD",5535,"KRN",19,"NM",13,0)
RMPR4 RPC^^0
"BLD",5535,"KRN",19,"NM","B","RMPR CLERK",12)

"BLD",5535,"KRN",19,"NM","B","RMPR ENTER CONTRACT",4)

"BLD",5535,"KRN",19,"NM","B","RMPR ENTER WAVIER",3)

"BLD",5535,"KRN",19,"NM","B","RMPR NPPD GUI",10)

"BLD",5535,"KRN",19,"NM","B","RMPR OFFICIAL",11)

"BLD",5535,"KRN",19,"NM","B","RMPR PRINT BILL",9)

"BLD",5535,"KRN",19,"NM","B","RMPR PURCHASE ORDER GUI",1)

"BLD",5535,"KRN",19,"NM","B","RMPR PURCHASING MENU",7)

"BLD",5535,"KRN",19,"NM","B","RMPR UTILITIES",6)

"BLD",5535,"KRN",19,"NM","B","RMPR WH DISPLAY",5)

"BLD",5535,"KRN",19,"NM","B","RMPR4 RPC",13)

"BLD",5535,"KRN",19.1,0)
19.1
"BLD",5535,"KRN",19.1,"NM",0)
^9.68A^^
"BLD",5535,"KRN",101,0)
101
"BLD",5535,"KRN",409.61,0)
409.61
"BLD",5535,"KRN",771,0)
771
"BLD",5535,"KRN",870,0)
870
"BLD",5535,"KRN",8989.51,0)
8989.51
"BLD",5535,"KRN",8989.52,0)
8989.52
"BLD",5535,"KRN",8994,0)
8994
"BLD",5535,"KRN",8994,"NM",0)
^9.68A^15^15
"BLD",5535,"KRN",8994,"NM",1,0)
RMPR SUSPENSE ACTIONS^^0
"BLD",5535,"KRN",8994,"NM",2,0)
RMPR CREATE PO^^0
"BLD",5535,"KRN",8994,"NM",3,0)
RMPR CHECK PA AUTHORIZATION^^0
"BLD",5535,"KRN",8994,"NM",4,0)
RMPR OPEN PEN LIST^^0
"BLD",5535,"KRN",8994,"NM",5,0)
RMPR LIST PCARD^^0
"BLD",5535,"KRN",8994,"NM",6,0)
RMPR MANAGER COMMENT^^0
"BLD",5535,"KRN",8994,"NM",7,0)
RMPR DELETE PO^^0
"BLD",5535,"KRN",8994,"NM",8,0)
RMPR PO CREATE VISTA IEN^^0
"BLD",5535,"KRN",8994,"NM",9,0)
RMPR SEND PURCHASE ORDER^^0
"BLD",5535,"KRN",8994,"NM",10,0)
RMPR ENCRYPT PCARD^^0
"BLD",5535,"KRN",8994,"NM",11,0)
RMPR LIST COST CENTER^^0
"BLD",5535,"KRN",8994,"NM",12,0)
RMPR LIST BOC^^0
"BLD",5535,"KRN",8994,"NM",13,0)
RMPR NPPD LIST X^^0
"BLD",5535,"KRN",8994,"NM",14,0)
RMPR CHECK FUND CONTROL POINT^^0
"BLD",5535,"KRN",8994,"NM",15,0)
RMPR PC PO PRINT^^0
"BLD",5535,"KRN",8994,"NM","B","RMPR CHECK FUND CONTROL POINT",14)

"BLD",5535,"KRN",8994,"NM","B","RMPR CHECK PA AUTHORIZATION",3)

"BLD",5535,"KRN",8994,"NM","B","RMPR CREATE PO",2)

"BLD",5535,"KRN",8994,"NM","B","RMPR DELETE PO",7)

"BLD",5535,"KRN",8994,"NM","B","RMPR ENCRYPT PCARD",10)

"BLD",5535,"KRN",8994,"NM","B","RMPR LIST BOC",12)

"BLD",5535,"KRN",8994,"NM","B","RMPR LIST COST CENTER",11)

"BLD",5535,"KRN",8994,"NM","B","RMPR LIST PCARD",5)

"BLD",5535,"KRN",8994,"NM","B","RMPR MANAGER COMMENT",6)

"BLD",5535,"KRN",8994,"NM","B","RMPR NPPD LIST X",13)

"BLD",5535,"KRN",8994,"NM","B","RMPR OPEN PEN LIST",4)

"BLD",5535,"KRN",8994,"NM","B","RMPR PC PO PRINT",15)

"BLD",5535,"KRN",8994,"NM","B","RMPR PO CREATE VISTA IEN",8)

"BLD",5535,"KRN",8994,"NM","B","RMPR SEND PURCHASE ORDER",9)

"BLD",5535,"KRN",8994,"NM","B","RMPR SUSPENSE ACTIONS",1)

"BLD",5535,"KRN","B",.4,.4)

"BLD",5535,"KRN","B",.401,.401)

"BLD",5535,"KRN","B",.402,.402)

"BLD",5535,"KRN","B",.403,.403)

"BLD",5535,"KRN","B",.5,.5)

"BLD",5535,"KRN","B",.84,.84)

"BLD",5535,"KRN","B",3.6,3.6)

"BLD",5535,"KRN","B",3.8,3.8)

"BLD",5535,"KRN","B",9.2,9.2)

"BLD",5535,"KRN","B",9.8,9.8)

"BLD",5535,"KRN","B",19,19)

"BLD",5535,"KRN","B",19.1,19.1)

"BLD",5535,"KRN","B",101,101)

"BLD",5535,"KRN","B",409.61,409.61)

"BLD",5535,"KRN","B",771,771)

"BLD",5535,"KRN","B",870,870)

"BLD",5535,"KRN","B",8989.51,8989.51)

"BLD",5535,"KRN","B",8989.52,8989.52)

"BLD",5535,"KRN","B",8994,8994)

"BLD",5535,"QUES",0)
^9.62^^
"BLD",5535,"REQB",0)
^9.611^9^9
"BLD",5535,"REQB",1,0)
PRC*5.1*68^1
"BLD",5535,"REQB",2,0)
RMPR*3.0*28^1
"BLD",5535,"REQB",3,0)
RMPR*3.0*30^1
"BLD",5535,"REQB",4,0)
RMPR*3.0*34^1
"BLD",5535,"REQB",5,0)
RMPR*3.0*41^1
"BLD",5535,"REQB",6,0)
RMPR*3.0*50^1
"BLD",5535,"REQB",7,0)
RMPR*3.0*51^1
"BLD",5535,"REQB",8,0)
RMPR*3.0*62^1
"BLD",5535,"REQB",9,0)
RMPR*3.0*77^1
"BLD",5535,"REQB","B","PRC*5.1*68",1)

"BLD",5535,"REQB","B","RMPR*3.0*28",2)

"BLD",5535,"REQB","B","RMPR*3.0*30",3)

"BLD",5535,"REQB","B","RMPR*3.0*34",4)

"BLD",5535,"REQB","B","RMPR*3.0*41",5)

"BLD",5535,"REQB","B","RMPR*3.0*50",6)

"BLD",5535,"REQB","B","RMPR*3.0*51",7)

"BLD",5535,"REQB","B","RMPR*3.0*62",8)

"BLD",5535,"REQB","B","RMPR*3.0*77",9)

"FIA",660)
RECORD OF PROS APPLIANCE/REPAIR
"FIA",660,0)
^RMPR(660,
"FIA",660,0,0)
660IOD
"FIA",660,0,1)
y^n^p^^^^n^^n
"FIA",660,0,10)

"FIA",660,0,11)

"FIA",660,0,"RLRO")

"FIA",660,0,"VR")
3.0^RMPR
"FIA",660,660)
1
"FIA",660,660,2)

"FIA",660,660,38.1)

"FIA",660,660,38.7)

"FIA",660,660,38.8)

"FIA",664)
PROSTHETICS 1358
"FIA",664,0)
^RMPR(664,
"FIA",664,0,0)
664ID
"FIA",664,0,1)
y^n^p^^^^n^^n
"FIA",664,0,10)

"FIA",664,0,11)

"FIA",664,0,"RLRO")

"FIA",664,0,"VR")
3.0^RMPR
"FIA",664,664)
1
"FIA",664,664,2)

"FIA",664,664,21.1)

"FIA",664,664.02)
1
"FIA",664,664.02,.01)

"FIA",664,664.02,8)

"FIA",664,664.02,15.2)

"FIA",664,664.02,15.4)

"FIA",664,664.02,15.6)

"FIA",664,664.02,18)

"FIA",664,664.02,19)

"FIA",669.9)
PROSTHETICS SITE PARAMETERS
"FIA",669.9,0)
^RMPR(669.9,
"FIA",669.9,0,0)
669.9
"FIA",669.9,0,1)
y^n^f^^^^n^^n
"FIA",669.9,0,10)

"FIA",669.9,0,11)

"FIA",669.9,0,"RLRO")

"FIA",669.9,0,"VR")
3.0^RMPR
"FIA",669.9,669.9)
0
"FIA",669.9,669.9001)
0
"FIA",669.9,669.9002)
0
"FIA",669.9,669.9003)
0
"FIA",669.9,669.922)
0
"FIA",669.9,669.961)
0
"FIA",669.9,669.962)
0
"FIA",669.9,669.965)
0
"FIA",669.9,669.972)
0
"FIA",669.9,669.974)
0
"KRN",.4,8372,-1)
0^1
"KRN",.4,8372,0)
RMPR WH DISPLAY^3050111.1636^@^664^^@^3050310
"KRN",.4,8372,"F",1)
S DIP(1)=$S($D(^RMPR(664,D0,3)):^(3),1:"") S X="Deliver To: "_$P(DIP(1),U,1) W X K DIP;S1;X;Z;""Deliver To: "_DELIVER TO"~
"KRN",.4,8372,"F",2)
S DIP(1)=$S($D(^RMPR(664,D0,4)):^(4),1:"") S X="     IFCAP Order: "_$P($G(^PRC(442,+$P(DIP(1),U,6),0)),U) W X K DIP;X;Z;""     IFCAP Order: "_IFCAP ORDER"~
"KRN",.4,8372,"F",3)
S DIP(1)=$S($D(^RMPR(664,D0,0)):^(0),1:"") S X="Vendor: "_$P($G(^PRC(440,+$P(DIP(1),U,4),0)),U) W X K DIP;S1;X;Z;""Vendor: "_VENDOR"~
"KRN",.4,8372,"F",4)
S DIP(1)=$S($D(^RMPR(664,D0,0)):^(0),1:"") S X="Initiator: "_$P($G(^VA(200,+$P(DIP(1),U,9),0)),U) W X K DIP;S1;X;Z;""Initiator: "_INITI"~
"KRN",.4,8372,"F",5)
S DIP(1)=$S($D(^RMPR(664,D0,0)):^(0),1:"") S X="Station Name: "_$P($G(^DIC(4,+$P(DIP(1),U,14),0)),U) W X K DIP;S1;X;Z;""Station Name: "_STATION NAME"~
"KRN",.4,8372,"F",6)
2,S DIP(1)=$S($D(^RMPR(664,D0,1,D1,0)):^(0),1:"") S X="Item: "_$$EXTERNAL^DIDU(664.02,.01,"",$P(DIP(1),U,1)) W X K DIP;S1;X;Z;""Item: "_BILLING IT"~
"KRN",.4,8372,"F",7)
2,S DIP(1)=$S($D(^RMPR(664,D0,1,D1,0)):^(0),1:"") S X="Brief Description: "_$P(DIP(1),U,2) W X K DIP;S1;X;Z;""Brief Description: "_BRIEF DES"~
"KRN",.4,8372,"F",8)
2,S DIP(1)=$S($D(^RMPR(664,D0,1,D1,0)):^(0),1:"") S X="Unit Cost: "_$P(DIP(1),U,3) W X K DIP;S1;X;Z;""Unit Cost: "_UNIT COST"~
"KRN",.4,8372,"F",9)
2,S DIP(1)=$S($D(^RMPR(664,D0,1,D1,0)):^(0),1:"") S X="     Qty: "_$P(DIP(1),U,4) W X K DIP;X;Z;""     Qty: "_QTY"~
"KRN",.4,8372,"F",10)
2,S DIP(1)=$S($D(^RMPR(664,D0,1,D1,0)):^(0),1:"") S X="     Unit of Issue: "_$P($G(^PRCD(420.5,+$P(DIP(1),U,5),0)),U) W X K DIP;X;Z;""     Unit of Issue: "_UNIT OF"~
"KRN",.4,8372,"F",11)
2,14,.01;S1;X;m;w~
"KRN",.4,8372,"H")
Prosthetics Display
"KRN",.402,2822,-1)
0^1
"KRN",.402,2822,0)
RMPR ENTER WAVIER EXCLUDE^3050110.1406^@^660^^@^3050203
"KRN",.402,2822,"DR",1,660)
D SERIAL^RMPRUTL4;W !,"Patient Name: "_RMPRX(660,DA_",",.02,"E");W !,"Form: "_RMPRX(660,DA_",",11,"E");W !,"Transaction #: "_RMPRX(660,DA_",",23,"E");W !,"Brief Desc: "_RMPRX(660,DA_",",24,"E");
"KRN",.402,2822,"DR",1,660,1)
W !,"PSAS HCPCS: "_RMPRX(660,DA_",",4.5,"E");W !,"Item: "_RMPRX(660,DA_",",89,"E");W !,"Vendor: "_RMPRX(660,DA_",",7,"E");W !,"Initiator: "_RMPRX(660,DA_",",27,"E");38.1;
"KRN",.402,2823,-1)
0^2
"KRN",.402,2823,0)
RMPR ENTER CONTRACT^3050203.1529^@^660^^@^3050203
"KRN",.402,2823,"DR",1,660)
D SERIAL^RMPRUTL4;W !,"Patient Name: "_RMPRX(660,DA_",",.02,"E");W !,"Form: "_RMPRX(660,DA_",",11,"E");W !,"Transaction #: "_RMPRX(660,DA_",",23,"E");W !,"Brief Desc: "_RMPRX(660,DA_",",24,"E");
"KRN",.402,2823,"DR",1,660,1)
W !,"PSAS HCPCS: "_RMPRX(660,DA_",",4.5,"E");W !,"Item: "_RMPRX(660,DA_",",89,"E");W !,"Vendor: "_RMPRX(660,DA_",",7,"E");W !,"Initiator: "_RMPRX(660,DA_",",27,"E");38.7;
"KRN",19,7383,-1)
2^7
"KRN",19,7383,0)
RMPR PURCHASING MENU^Purchasing^^M^.5^^^^^^^150^^1
"KRN",19,7383,10,0)
^19.01PI^22^22
"KRN",19,7383,10,20,0)
16375^EW
"KRN",19,7383,10,20,"^")
RMPR ENTER WAVIER
"KRN",19,7383,10,21,0)
16376^EC^15
"KRN",19,7383,10,21,"^")
RMPR ENTER CONTRACT
"KRN",19,7383,10,22,0)
16374
"KRN",19,7383,10,22,"^")
RMPR PURCHASE ORDER GUI
"KRN",19,7383,"U")
PURCHASING
"KRN",19,7387,-1)
2^6
"KRN",19,7387,0)
RMPR UTILITIES^Utilities^^M^.5^^^^^^^150
"KRN",19,7387,10,0)
^19.01PI^19^19
"KRN",19,7387,10,19,0)
16377^WD
"KRN",19,7387,10,19,"^")
RMPR WH DISPLAY
"KRN",19,7387,"U")
UTILITIES
"KRN",19,7389,-1)
2^11
"KRN",19,7389,0)
RMPR OFFICIAL^Prosthetic Official's Menu^^M^.5^^^^^^^150^^^
"KRN",19,7389,10,0)
^19.01IP^22^21
"KRN",19,7389,10,1,0)
7383^PU^1
"KRN",19,7389,10,1,"^")
RMPR PURCHASING MENU
"KRN",19,7389,10,3,0)
7387^UT^3
"KRN",19,7389,10,3,"^")
RMPR UTILITIES
"KRN",19,7389,"U")
PROSTHETIC OFFICIAL'S MENU
"KRN",19,7390,-1)
2^12
"KRN",19,7390,0)
RMPR CLERK^Prosthetic Clerk's Menu^^M^.5^^^^^^^150^^1^1
"KRN",19,7390,10,0)
^19.01IP^37^37
"KRN",19,7390,10,15,0)
7383^PU^1
"KRN",19,7390,10,15,"^")
RMPR PURCHASING MENU
"KRN",19,7390,10,17,0)
7387^UT^3
"KRN",19,7390,10,17,"^")
RMPR UTILITIES
"KRN",19,7390,"U")
PROSTHETIC CLERK'S MENU
"KRN",19,7428,-1)
0^9
"KRN",19,7428,0)
RMPR PRINT BILL^Print Prosthetic Billings for MAS^NOT AVAILABLE, USE GUI DISPLAY^R^^^^^^^^PROSTHETICS
"KRN",19,7428,1,0)
^^2^2^2950519^
"KRN",19,7428,1,1,0)
Prints all NSC (non-service connected) items issued to patients for
"KRN",19,7428,1,2,0)
billing purposes.
"KRN",19,7428,25)
RMPRBIL
"KRN",19,7428,99.1)
58946,32766
"KRN",19,7428,"U")
PRINT PROSTHETIC BILLINGS FOR 
"KRN",19,11567,-1)
0^13
"KRN",19,11567,0)
RMPR4 RPC^Reprint a Purchase Card Form^^R^^^^^^^^PROSTHETICS
"KRN",19,11567,1,0)
^^1^1^2960415^
"KRN",19,11567,1,1,0)
Reprint a Purchase Card Transaction. 
"KRN",19,11567,25)
EN^RMPR4P21
"KRN",19,11567,"U")
REPRINT A PURCHASE CARD FORM
"KRN",19,15599,-1)
0^10
"KRN",19,15599,0)
RMPR NPPD GUI^NPPD Detail Display^^B^^^^^^^^PROSTHETICS
"KRN",19,15599,1,0)
^19.06^8^8^3021031^^^^
"KRN",19,15599,1,1,0)
'B' type option for use after installation of RMPR*3*71.
"KRN",19,15599,1,2,0)
For users to be able to use the NPPD Detail Display GUI
"KRN",19,15599,1,3,0)
front-end, this option must be on either their primary
"KRN",19,15599,1,4,0)
or secondary menu options.  This option has also been
"KRN",19,15599,1,5,0)
placed on RMPR NPPD TOOLS to give users who have access
"KRN",19,15599,1,6,0)
to the current NPPD options, access to NPPD GUI Detail
"KRN",19,15599,1,7,0)
Display.  Note: 'B' type options are not visible to roll
"KRN",19,15599,1,8,0)
& scroll users.
"KRN",19,15599,99.1)
59928,28755
"KRN",19,15599,"RPC",0)
^19.05P^2^2
"KRN",19,15599,"RPC",1,0)
RMPR NPPD LIST
"KRN",19,15599,"RPC",2,0)
RMPR NPPD LIST X
"KRN",19,15599,"U")
NPPD DETAIL DISPLAY
"KRN",19,16374,-1)
0^1
"KRN",19,16374,0)
RMPR PURCHASE ORDER GUI^PROSTHETICS PURCHASE ORDER GUI^^B^^^^^^^^PROSTHETICS
"KRN",19,16374,1,0)
^19.06^7^7^3050303^^^^
"KRN",19,16374,1,1,0)
'B' type option for use after installation of RMPR*3&90.
"KRN",19,16374,1,2,0)
For users to be able to use the Purchase Order GUI
"KRN",19,16374,1,3,0)
front-end, this option must be on either their primary
"KRN",19,16374,1,4,0)
placed on RMPR NPPD TOOLS to give users who have access
"KRN",19,16374,1,5,0)
to the current NPPD options, access to NPPD GUI Detail
"KRN",19,16374,1,6,0)
Display.  Note: 'B' type options are not visible to roll
"KRN",19,16374,1,7,0)
& scroll users.
"KRN",19,16374,99.1)
59324,42897
"KRN",19,16374,"RPC",0)
^19.05P^56^56
"KRN",19,16374,"RPC",1,0)
RMPR NPPD LIST
"KRN",19,16374,"RPC",2,0)
XWB GET VARIABLE VALUE
"KRN",19,16374,"RPC",5,0)
RMPR CLINIC ENROLLMENT
"KRN",19,16374,"RPC",6,0)
RMPR CLINIC LETTER DISPLAY
"KRN",19,16374,"RPC",7,0)
RMPR CLINIC LETTER LIST
"KRN",19,16374,"RPC",9,0)
RMPR LAST PT MOVEMENTS
"KRN",19,16374,"RPC",10,0)
RMPR PENDING APPOINTMENTS
"KRN",19,16374,"RPC",11,0)
RMPR TRANS LIST
"KRN",19,16374,"RPC",12,0)
RMPR TRANS HISA
"KRN",19,16374,"RPC",13,0)
RMPR PT ADD
"KRN",19,16374,"RPC",14,0)
RMPR PT DEM
"KRN",19,16374,"RPC",15,0)
RMPR TRANS HOME O2
"KRN",19,16374,"RPC",17,0)
RMPR CRITICAL COM
"KRN",19,16374,"RPC",19,0)
RMPR DIS LIST
"KRN",19,16374,"RPC",20,0)
RMPR OPEN PEN LIST
"KRN",19,16374,"RPC",21,0)
RMPR CPRS DISPLAY
"KRN",19,16374,"RPC",24,0)
RMPR TRANS LIST EXPANDED
"KRN",19,16374,"RPC",25,0)
DDR LISTER
"KRN",19,16374,"RPC",26,0)
DDR FINDER
"KRN",19,16374,"RPC",27,0)
DDR VALIDATOR
"KRN",19,16374,"RPC",28,0)
RMPR VIEW REQ
"KRN",19,16374,"RPC",29,0)
RMPR VIEW REQ DESC
"KRN",19,16374,"RPC",30,0)
RMPR VIEW REQ IA NOTE
"KRN",19,16374,"RPC",31,0)
RMPR VIEW REQ COMP NOTE
"KRN",19,16374,"RPC",32,0)
RMPR TRANS HOME O2 RX
"KRN",19,16374,"RPC",33,0)
RMPR DOR
"KRN",19,16374,"RPC",35,0)
DDR GETS ENTRY DATA
"KRN",19,16374,"RPC",36,0)
DDR FILER
"KRN",19,16374,"RPC",43,0)
RMPR CHECK PA AUTHORIZATION
"KRN",19,16374,"RPC",44,0)
RMPR PO CREATE VISTA IEN
"KRN",19,16374,"RPC",45,0)
RMPR SEND PURCHASE ORDER
"KRN",19,16374,"RPC",46,0)
RMPR ENCRYPT PCARD
"KRN",19,16374,"RPC",47,0)
DDR FIND1
"KRN",19,16374,"RPC",48,0)
RMPR LIST PCARD
"KRN",19,16374,"RPC",49,0)
RMPR LIST COST CENTER
"KRN",19,16374,"RPC",50,0)
RMPR LIST BOC
"KRN",19,16374,"RPC",51,0)
RMPR CREATE PO
"KRN",19,16374,"RPC",52,0)
RMPR SUSPENSE ACTIONS
"KRN",19,16374,"RPC",53,0)
RMPR MANAGER COMMENT
"KRN",19,16374,"RPC",54,0)
RMPR DELETE PO
"KRN",19,16374,"RPC",55,0)
RMPR CHECK FUND CONTROL POINT
"KRN",19,16374,"RPC",56,0)
RMPR PC PO PRINT
"KRN",19,16374,"U")
PROSTHETICS PURCHASE ORDER GUI
"KRN",19,16375,-1)
0^3
"KRN",19,16375,0)
RMPR ENTER WAVIER^Enter Wavier or Excluded Notice^^E^^^^^^^^PROSTHETICS^^^1
"KRN",19,16375,1,0)
^19.06^1^1^3050110^^
"KRN",19,16375,1,1,0)
This menu is designed to allow adding or changing the Wavier Excluded Flag.
"KRN",19,16375,15)
K RMPRX
"KRN",19,16375,30)
RMPR(660,
"KRN",19,16375,31)
AEMQ
"KRN",19,16375,32)
Enter Patient Name or PO Number
"KRN",19,16375,35)
W ?45,$P($G(^(1)),U,2)
"KRN",19,16375,50)
RMPR(660,
"KRN",19,16375,51)
[RMPR ENTER WAVIER EXCLUDE]
"KRN",19,16375,"U")
ENTER WAVIER OR EXCLUDED NOTIC
"KRN",19,16376,-1)
0^4
"KRN",19,16376,0)
RMPR ENTER CONTRACT^Enter/Edit Contract # on 2319^^E^^^^^^^^PROSTHETICS^^^1
"KRN",19,16376,1,0)
^19.06^8^8^3050110^^
"KRN",19,16376,1,1,0)
This menu is designed to allow data entry and edit of the Contract # and the
"KRN",19,16376,1,2,0)
following FPDS data fields:
"KRN",19,16376,1,3,0)

"KRN",19,16376,1,4,0)
      POSSIBLE COMPETITIVE STATUS
"KRN",19,16376,1,5,0)
      PREFERENCE PROGAM
"KRN",19,16376,1,6,0)
      SOURCE CODE
"KRN",19,16376,1,7,0)
      REASON CODE
"KRN",19,16376,1,8,0)
      PURCHASE METHOD
"KRN",19,16376,15)
K RMPRX
"KRN",19,16376,30)
RMPR(660,
"KRN",19,16376,31)
AEMQ
"KRN",19,16376,32)
Enter Patient Name or PO Number
"KRN",19,16376,35)
W ?45,$P($G(^(1)),U,2)
"KRN",19,16376,50)
RMPR(660,
"KRN",19,16376,51)
[RMPR ENTER CONTRACT]
"KRN",19,16376,"U")
ENTER/EDIT CONTRACT # ON 2319
"KRN",19,16377,-1)
0^5
"KRN",19,16377,0)
RMPR WH DISPLAY^Display Prosthetic PO Information^^I^^^^^^^^PROSTHETICS
"KRN",19,16377,1,0)
^^2^2^3050111^
"KRN",19,16377,1,1,0)
This will display purchase order information that does not contain
"KRN",19,16377,1,2,0)
patient name or sensitive information.
"KRN",19,16377,30)
RMPR(664,
"KRN",19,16377,31)
AEMQ
"KRN",19,16377,32)
Enter Purchase Order:
"KRN",19,16377,63)
[RMPR WH DISPLAY]
"KRN",19,16377,80)
RMPR(664,
"KRN",19,16377,"U")
DISPLAY PROSTHETIC PO INFORMAT
"KRN",8994,2311,-1)
0^4
"KRN",8994,2311,0)
RMPR OPEN PEN LIST^EN^RMPR9LST^4^P^0^^1
"KRN",8994,2311,1,0)
^8994.01^2^2^3040304^^^^
"KRN",8994,2311,1,1,0)
T his procedure retrieves the list of the main purchasing grid, file (3668).
"KRN",8994,2311,1,2,0)
No Input Parameters besides SITE needed.
"KRN",8994,2311,3,0)
^8994.03^4^4^3040304^^^^
"KRN",8994,2311,3,1,0)
Returns the list of all open pending consults from file 668.
"KRN",8994,2311,3,2,0)
The array format:
"KRN",8994,2311,3,3,0)
 
"KRN",8994,2311,3,4,0)
RMPR9EO(line number,0)=date^patient name^ssn^type^days^status^des
"KRN",8994,2311,605001)
3685
"KRN",8994,2312,-1)
0^5
"KRN",8994,2312,0)
RMPR LIST PCARD^ENA^RMPR9AUT^2^P^0^^0
"KRN",8994,2312,1,0)
^^1^1^3041027^
"KRN",8994,2312,1,1,0)
RPC to pass all the credit card numbers of a user.  Only credit card numers that belong to a user or surrogate user will be passed by this rpc.
"KRN",8994,2312,1,2,0)
number that belongs to a user or surrogate user will be passed by this
"KRN",8994,2312,1,3,0)
RPC.
"KRN",8994,2312,605001)
3685
"KRN",8994,2313,-1)
0^2
"KRN",8994,2313,0)
RMPR CREATE PO^ENB^RMPR9AUT^2^^0^^0
"KRN",8994,2313,1,0)
^8994.01^1^1^3041101^^
"KRN",8994,2313,1,1,0)
RPC call to get the next Common Numbering Series from 442.6
"KRN",8994,2313,605001)
3685
"KRN",8994,2314,-1)
0^11
"KRN",8994,2314,0)
RMPR LIST COST CENTER^END^RMPR9AUT^2^P^0^^0
"KRN",8994,2314,1,0)
^^1^1^3041027^
"KRN",8994,2314,1,1,0)
RPC to list all available Cost Center(s) for a given fud control point.
"KRN",8994,2314,605001)
3685
"KRN",8994,2315,-1)
0^12
"KRN",8994,2315,0)
RMPR LIST BOC^ENE^RMPR9AUT^2^P^0^^0
"KRN",8994,2315,1,0)
^^1^1^3041027^
"KRN",8994,2315,1,1,0)
RPC to list all available Budget Object Code (BOC)'s for a given Cost Center
"KRN",8994,2315,605001)
3685
"KRN",8994,2316,-1)
0^3
"KRN",8994,2316,0)
RMPR CHECK PA AUTHORIZATION^EN1^RMPR9PCD^2^S^0^^0
"KRN",8994,2316,1,0)
^8994.01^1^1^3041210^^
"KRN",8994,2316,1,1,0)
 
"KRN",8994,2316,2,0)
^8994.02A^1^1
"KRN",8994,2316,2,1,0)
IEN^1^50^1^1
"KRN",8994,2316,2,1,1,0)
^8994.021^1^1^3041210^^
"KRN",8994,2316,2,1,1,1,0)
 
"KRN",8994,2316,2,"B","IEN",1)

"KRN",8994,2316,2,"PARAMSEQ",1,1)

"KRN",8994,2316,3,0)
^8994.03^1^1^3041210^^
"KRN",8994,2316,3,1,0)
 
"KRN",8994,2316,605001)
3685
"KRN",8994,2317,-1)
0^1
"KRN",8994,2317,0)
RMPR SUSPENSE ACTIONS^EN^RMPR9CA^2^R^0^^0
"KRN",8994,2317,1,0)
^8994.01^3^3^3041104^^^^
"KRN",8994,2317,1,1,0)
Remote Procedure for Purchasing Actions.  The firs 2 will be:
"KRN",8994,2317,1,2,0)
Post complete note
"KRN",8994,2317,1,3,0)
Post initial action
"KRN",8994,2317,2,0)
^8994.02A^1^1
"KRN",8994,2317,2,1,0)
RMPRTXT^2^1
"KRN",8994,2317,2,"B","RMPRTXT",1)

"KRN",8994,2317,605001)
3685
"KRN",8994,2318,-1)
0^9
"KRN",8994,2318,0)
RMPR SEND PURCHASE ORDER^GUI^RMPR121B^1^S^0^^0
"KRN",8994,2318,1,0)
^8994.01^2^2^3041210^^^^
"KRN",8994,2318,1,1,0)
This will pass the array from Kernel Broker to CoreFLS to create
"KRN",8994,2318,1,2,0)
a Patient po.  After checking for E-Sig.
"KRN",8994,2318,2,0)
^8994.02A^^0
"KRN",8994,2318,605001)
3685
"KRN",8994,2319,-1)
0^8
"KRN",8994,2319,0)
RMPR PO CREATE VISTA IEN^EN1^RMPR9CS^2^S^0^^0
"KRN",8994,2319,1,0)
^8994.01^2^2^3031030^^^^
"KRN",8994,2319,1,1,0)
This will pass the array from Kernel Broker to create Patient 2319.
"KRN",8994,2319,1,2,0)
Return will be Line Number^Vista IEN^Grouper Number.
"KRN",8994,2319,2,0)
^8994.02A^1^1
"KRN",8994,2319,2,1,0)
OUT^2
"KRN",8994,2319,2,1,1,0)
^^1^1^3031030^
"KRN",8994,2319,2,1,1,1,0)
 
"KRN",8994,2319,2,"B","OUT",1)

"KRN",8994,2319,3,0)
^^3^3^3031030^
"KRN",8994,2319,3,1,0)
 
"KRN",8994,2319,3,2,0)
 
"KRN",8994,2319,3,3,0)
 
"KRN",8994,2319,605001)
3685
"KRN",8994,2320,-1)
0^10
"KRN",8994,2320,0)
RMPR ENCRYPT PCARD^EN^RMPR9ENC^2^S^0^^0
"KRN",8994,2320,1,0)
^8994.01^2^2^3031113^^
"KRN",8994,2320,1,1,0)
Remote Procedure to update the PROSTHETICS 1358 file #664 with the 
"KRN",8994,2320,1,2,0)
encrypted PCARD.
"KRN",8994,2320,2,0)
^8994.02A^3^3
"KRN",8994,2320,2,1,0)
RMPRPCD^1^255
"KRN",8994,2320,2,2,0)
DUZ^1^6
"KRN",8994,2320,2,3,0)
RMPRA^1^30
"KRN",8994,2320,2,"B","DUZ",2)

"KRN",8994,2320,2,"B","RMPRA",3)

"KRN",8994,2320,2,"B","RMPRPCD",1)

"KRN",8994,2320,605001)
3685
"KRN",8994,2321,-1)
0^6
"KRN",8994,2321,0)
RMPR MANAGER COMMENT^MGR^RMPRESI^2^R^0^^0
"KRN",8994,2321,1,0)
^8994.01^1^1^3041228^^^
"KRN",8994,2321,1,1,0)
RPC call to get the Manager Comment from file 669.9.
"KRN",8994,2321,605001)
3685
"KRN",8994,2322,-1)
0^7
"KRN",8994,2322,0)
RMPR DELETE PO^EN1^RMPR9CA^2^R^0^^0
"KRN",8994,2322,1,0)
^8994.01^1^1^3050107^^^^
"KRN",8994,2322,1,1,0)
RPC to delete record in file 664.
"KRN",8994,2322,605001)
3685
"KRN",8994,2323,-1)
0^13
"KRN",8994,2323,0)
RMPR NPPD LIST X^EN^RMPR9LN1^4^A^^^1
"KRN",8994,2323,1,0)
^8994.01^6^6^3050214^^^
"KRN",8994,2323,1,1,0)
GUI REMOTE PROCEDURE, LIST NPPD DATA
"KRN",8994,2323,1,2,0)
 
"KRN",8994,2323,1,3,0)
        ;RESULTS passed to broker in ^TMP($J,
"KRN",8994,2323,1,4,0)
        ;delimited by "^"
"KRN",8994,2323,1,5,0)
        ;piece 1 = DATA TO DISPLAY
"KRN",8994,2323,1,6,0)
        ;piece 2 = FIELD NUMBER
"KRN",8994,2323,2,0)
^8994.02A^^0
"KRN",8994,2323,605001)
3685
"KRN",8994,2324,-1)
0^14
"KRN",8994,2324,0)
RMPR CHECK FUND CONTROL POINT^END^PRCH7PA4^2^P^0^^0
"KRN",8994,2324,1,0)
^^1^1^3050217^
"KRN",8994,2324,1,1,0)
RPC to check user authorization for a Fund Control Point
"KRN",8994,2324,605001)
3685
"KRN",8994,2329,-1)
0^15
"KRN",8994,2329,0)
RMPR PC PO PRINT^PRT^RMPR9P21^2^S^0^^0
"KRN",8994,2329,1,0)
^8994.01^2^2^3050712^^^^
"KRN",8994,2329,1,1,0)
Purchase Order Information to be printed from a PC Device Fax/Printer
"KRN",8994,2329,1,2,0)
 
"KRN",8994,2329,2,0)
^8994.02A^^0
"KRN",8994,2329,605001)
34018
"MBREQ")
0
"ORD",5,.4)
.4;5;;;EDEOUT^DIFROMSO(.4,DA,"",XPDA);FPRE^DIFROMSI(.4,"",XPDA);EPRE^DIFROMSI(.4,DA,$E("N",$G(XPDNEW)),XPDA,"",OLDA);;EPOST^DIFROMSI(.4,DA,"",XPDA);DEL^DIFROMSK(.4,"",%)
"ORD",5,.4,0)
PRINT TEMPLATE
"ORD",7,.402)
.402;7;;;EDEOUT^DIFROMSO(.402,DA,"",XPDA);FPRE^DIFROMSI(.402,"",XPDA);EPRE^DIFROMSI(.402,DA,$E("N",$G(XPDNEW)),XPDA,"",OLDA);;EPOST^DIFROMSI(.402,DA,"",XPDA);DEL^DIFROMSK(.402,"",%)
"ORD",7,.402,0)
INPUT TEMPLATE
"ORD",16,8994)
8994;16;1;;;;;;;RPCDEL^XPDIA1
"ORD",16,8994,0)
REMOTE PROCEDURE
"ORD",18,19)
19;18;;;OPT^XPDTA;OPTF1^XPDIA;OPTE1^XPDIA;OPTF2^XPDIA;;OPTDEL^XPDIA
"ORD",18,19,0)
OPTION
"PKG",150,-1)
1^1
"PKG",150,0)
PROSTHETICS^RMPR^PROSTHETICS VERSION 3.0 ALPHA
"PKG",150,20,0)
^9.402P^^0
"PKG",150,22,0)
^9.49I^1^1
"PKG",150,22,1,0)
3.0^2960209^2960620
"PKG",150,22,1,"PAH",1,0)
90^3050822^3685
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
38
"RTN","RMPR121A")
0^6^B1667724
"RTN","RMPR121A",1,0)
RMPR121A ;PHX/HNC -CREATE GUI PURCHASE CARD TRANSACTION CONT. ;3/1/2003
"RTN","RMPR121A",2,0)
 ;;3.0;PROSTHETICS;**90**;Feb 09, 1996
"RTN","RMPR121A",3,0)
 ;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","RMPR121A",4,0)
 ;04/01/05 Note some codeing for future use such as pt address.
"RTN","RMPR121A",5,0)
DELIV I RMPRY=1 D
"RTN","RMPR121A",6,0)
 .S RMPRDDF="1^Y"
"RTN","RMPR121A",7,0)
 .S DFN=$P(^RMPR(664,RMPRA,0),U,2)
"RTN","RMPR121A",8,0)
 .D ALL^VADPT
"RTN","RMPR121A",9,0)
 .S RMPRADD1=VADM(1)
"RTN","RMPR121A",10,0)
 .S RMPRADD2=VAPA(1)
"RTN","RMPR121A",11,0)
 .S RMPRCITY=VAPA(4)
"RTN","RMPR121A",12,0)
 .S RMPRST=VAPA(5)
"RTN","RMPR121A",13,0)
 .S RMPRZIP=VAPA(6)
"RTN","RMPR121A",14,0)
 .I RMPRZIP="" S RMPRZIP="00000"
"RTN","RMPR121A",15,0)
 I RMPRY=2 S RMPRDDF="2^N"
"RTN","RMPR121A",16,0)
 I RMPRY=3 S RMPRDDF="3^N"
"RTN","RMPR121A",17,0)
 I RMPRY=4 D
"RTN","RMPR121A",18,0)
 .S RMPRDDF="4^Y"
"RTN","RMPR121A",19,0)
 .S RMPRADD1=$P(^RMPR(664,RMPRA,3),U,5)
"RTN","RMPR121A",20,0)
 .S RMPRADD2=$P(^RMPR(664,RMPRA,3),U,6)
"RTN","RMPR121A",21,0)
 .S RMPRCITY=$P(^RMPR(664,RMPRA,3),U,7)
"RTN","RMPR121A",22,0)
 .S RMPRST=$P(^RMPR(664,RMPRA,3),U,8)_"^"_$P(^DIC(5,$P(^RMPR(664,RMPRA,3),U,8),0),U,1)
"RTN","RMPR121A",23,0)
 .S RMPRZIP=$P(^RMPR(664,RMPRA,3),U,9)
"RTN","RMPR121A",24,0)
 ;deliver to other
"RTN","RMPR121A",25,0)
 S RMPRDELN=RMPRY(0),$P(^RMPR(664,RMPRA,3),U)=RMPRDELN
"RTN","RMPR121A",26,0)
 I RMPRY=3 S RMPRDELN=$P(^RMPR(664,RMPRA,3),U,4)
"RTN","RMPR121A",27,0)
 I RMPRY=4 S RMPRDELN=$P(^RMPR(664,RMPRA,3),U,4)
"RTN","RMPR121A",28,0)
 Q
"RTN","RMPR121B")
0^1^B17535480
"RTN","RMPR121B",1,0)
RMPR121B ;PHX/HNC -POST GUI PURCHASE ORDER TRANSACTION ;3/1/2003
"RTN","RMPR121B",2,0)
 ;;3.0;PROSTHETICS;**90**;FEB 09,1996
"RTN","RMPR121B",3,0)
 ;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","RMPR121B",4,0)
A1(SIG,RMPRA,RMPRSITE,RMPRPTR) S RMPRGUI=1 G A2
"RTN","RMPR121B",5,0)
GUI(RESULT,SIG,RMPRA,RMPRSITE,RMPRPTR) ;
"RTN","RMPR121B",6,0)
A2 I (SIG="")!($E(SIG)="^") S RESULT=1_"^"_"Not Valid, Try Again..." Q
"RTN","RMPR121B",7,0)
 K RESULT D SIGN
"RTN","RMPR121B",8,0)
 Q
"RTN","RMPR121B",9,0)
 ;
"RTN","RMPR121B",10,0)
SIGN ; Validate /es/-code
"RTN","RMPR121B",11,0)
 ;
"RTN","RMPR121B",12,0)
 S X=SIG
"RTN","RMPR121B",13,0)
 S RMPRY=0
"RTN","RMPR121B",14,0)
 D HASH^XUSHSHP I X]"",(X=$P($G(^VA(200,+DUZ,20)),U,4)) S RMPRY=1
"RTN","RMPR121B",15,0)
 I RMPRY=0 S RESULT=1_"^"_"Checked signature Not Valid, Try Again..." Q
"RTN","RMPR121B",16,0)
 ;
"RTN","RMPR121B",17,0)
 S RMPRV=$P(^RMPR(664,RMPRA,0),U,4)
"RTN","RMPR121B",18,0)
 S RMPRPER=$P(^RMPR(664,RMPRA,2),U,6)/100
"RTN","RMPR121B",19,0)
 D GUIVAR
"RTN","RMPR121B",20,0)
 S PRCRMPR=1,X=1,PRCRMPR=1
"RTN","RMPR121B",21,0)
 S ^TMP("SPST",0)=PRCA_"^"_PRCB_"^"_PRCC_"^"_PRCSITE_"^"_PRCVEN_"^"_PRCRMPR
"RTN","RMPR121B",22,0)
 S ^TMP("SPST",1)=SIG_"^"_RMPRA_"^"_RMPRSITE_"^"_RMPRPTR
"RTN","RMPR121B",23,0)
 D UP1^PRCH7PUC(.X,PRCA,PRCB,PRCC,PRCSITE,PRCVEN,PRCRMPR)
"RTN","RMPR121B",24,0)
 I X="^" G QUIT
"RTN","RMPR121B",25,0)
 S PRC442=$P(^RMPR(664,RMPRA,4),U,6)
"RTN","RMPR121B",26,0)
 I $P(^PRC(442,PRC442,7),U,1)'=6 G QUT
"RTN","RMPR121B",27,0)
 I $D(RMPRPSC) S $P(^RMPR(664,RMPRA,2),U,5)=RMPRPSC
"RTN","RMPR121B",28,0)
 S DA=RMPRA,DIK="^RMPR(664," D IX1^DIK
"RTN","RMPR121B",29,0)
 ;get AMIS grouper number
"RTN","RMPR121B",30,0)
 L +^RMPR(669.9,RMPRSITE,0):999 I $T=0 S RMPRG=DT_99 G GGC
"RTN","RMPR121B",31,0)
 S RMPRG=$P(^RMPR(669.9,RMPRSITE,0),U,7),RMPRG=RMPRG-1,$P(^(0),U,7)=RMPRG L -^RMPR(669.9,RMPRSITE,0)
"RTN","RMPR121B",32,0)
 ;
"RTN","RMPR121B",33,0)
GGC S B2=0
"RTN","RMPR121B",34,0)
 F  S B2=$O(^RMPR(664,RMPRA,1,B2)) Q:B2'>0  D R19^RMPR121C
"RTN","RMPR121B",35,0)
 K RMPRDP
"RTN","RMPR121B",36,0)
 ; Shipping Record
"RTN","RMPR121B",37,0)
 I +RMPRSH'>0 G NS
"RTN","RMPR121B",38,0)
 K DD,DO S X=DT,DIC="^RMPR(660,",DIC(0)="LZ" D FILE^DICN S (RMPR660,DA)=+Y
"RTN","RMPR121B",39,0)
 S RMPRTRN=$P(^RMPR(664,RMPRA,4),U,5)
"RTN","RMPR121B",40,0)
 S $P(^RMPR(660,RMPR660,4),U,3)=RMPRV
"RTN","RMPR121B",41,0)
 S ^RMPR(660,RMPR660,0)=DT_U_RMPRDFN_U_DT_"^X^^^^^"_U_RMPR("STA")_"^^^14"_U_RMPRS_"^^"_RMPRSH_"^"_RMPRSH_"^^^^^",^("AMS")=RMPRG,^("AM")=U_U_RMPRDIS_U_RMPRSC,$P(^(0),U,27)=DUZ I $D(RMPRWO),RMPRWO S $P(^("AM"),U,2)=1 D
"RTN","RMPR121B",42,0)
 .I $D(^RMPR(664.2,RMPRWO,0)) S $P(^(0),U,6)=$P(^(0),U,6)+RMPRSH
"RTN","RMPR121B",43,0)
 S:$D(RMPRDELN) ^RMPR(660,RMPR660,3)=RMPRDELN S ^(1)=RMPRTRN
"RTN","RMPR121B",44,0)
 S DIK="^RMPR(660," D IX1^DIK S $P(^RMPR(664,RMPRA,0),U,12)=RMPR660 K RMPRDP
"RTN","RMPR121B",45,0)
NS S $P(^RMPR(664,RMPRA,2),U,4)="2421PC"
"RTN","RMPR121B",46,0)
 S RESULT=0_"^"_"PO COMPLETE"
"RTN","RMPR121B",47,0)
 S ^TMP("SPS",0)=RMPRPTR
"RTN","RMPR121B",48,0)
 I RMPRPTR=0 D ^RMPR4P21
"RTN","RMPR121B",49,0)
 I +RMPRPTR>0 D EN1^RMPR4P21(RMPRPTR)
"RTN","RMPR121B",50,0)
 Q
"RTN","RMPR121B",51,0)
QUIT ; Quit where IFCAP encountered a problem
"RTN","RMPR121B",52,0)
 S RESULT=1_"^"_"**STAND BY**  Your IFCAP order may be canceled due to a lack of funds. If you can immediately get an increase of funds re-enter your e-sig and complete this PO.  IF YOU LEAVE THIS SCREEN YOUR PO WILL BE LOST"
"RTN","RMPR121B",53,0)
 Q
"RTN","RMPR121B",54,0)
QUT ;
"RTN","RMPR121B",55,0)
 S RESULT="1^IFCAP did not update your Purchase Order, Please Log out and start over."
"RTN","RMPR121B",56,0)
 Q
"RTN","RMPR121B",57,0)
GUIVAR ; Get variable setup from the GUI application
"RTN","RMPR121B",58,0)
 ; Setup Site Variables
"RTN","RMPR121B",59,0)
 D INF^RMPRSIT
"RTN","RMPR121B",60,0)
 ; Shipping info
"RTN","RMPR121B",61,0)
 S $P(^RMPR(664,RMPRA,0),U,14)=RMPR("STA")
"RTN","RMPR121B",62,0)
 S (R1,RMPRCT,RMPRQT,RMPRTO,RMPRI,RMPRR)=0
"RTN","RMPR121B",63,0)
 S RMPRSH=$S($P(^RMPR(664,RMPRA,0),U,10):$P(^(0),U,10),1:"")
"RTN","RMPR121B",64,0)
 F  S R1=$O(^RMPR(664,RMPRA,1,R1)) Q:R1'>0  D
"RTN","RMPR121B",65,0)
 .S RB=^RMPR(664,RMPRA,1,R1,0)
"RTN","RMPR121B",66,0)
 .S RMPRCT=$P(RB,U,3)
"RTN","RMPR121B",67,0)
 .S RMPRQT=$P(RB,U,4)
"RTN","RMPR121B",68,0)
 .S RMPRR=$P(RB,U,8) ;REMARKS
"RTN","RMPR121B",69,0)
 .S RMPRTO=RMPRTO+$J(RMPRCT*RMPRQT,0,2)
"RTN","RMPR121B",70,0)
 S RMPRTOTC=$P($G(^RMPR(664,RMPRA,4)),U,3)
"RTN","RMPR121B",71,0)
 S RMPRPCD=$P(^RMPR(664,RMPRA,4),U,1),$P(^RMPR(664,RMPRA,4),U,1)=$$ENC^RMPR4LI(RMPRPCD,DUZ,RMPRA)
"RTN","RMPR121B",72,0)
 S PRCA=RMPRA
"RTN","RMPR121B",73,0)
 S PRCB=$P(^RMPR(664,RMPRA,4),U,6)
"RTN","RMPR121B",74,0)
 S PRCC=RMPRTOTC
"RTN","RMPR121B",75,0)
 S PRCSITE=$P(^RMPR(664,RMPRA,0),U,14)
"RTN","RMPR121B",76,0)
 S PRCVEN=$P(^RMPR(664,RMPRA,0),U,4)
"RTN","RMPR121B",77,0)
 S RMPRDFN=$P(^RMPR(664,RMPRA,0),U,2)
"RTN","RMPR121B",78,0)
 S RMPRPPA=$P(^VA(200,DUZ,1),U,9)
"RTN","RMPR121B",79,0)
 ; Setup Delivery to Variables
"RTN","RMPR121B",80,0)
 S RMPRY(0)=$P($G(^RMPR(664,RMPRA,3)),U)
"RTN","RMPR121B",81,0)
TST S RMPRY=$S(RMPRY(0)="VETERAN":1,RMPRY(0)="PROSTHETICS":2,RMPRY(0)="OTHER LOCATION AT THIS SITE":3,RMPRY(0)="OTHER LOCATION NOT AT THIS SITE":4,1:"")
"RTN","RMPR121B",82,0)
 D DELIV^RMPR121A
"RTN","RMPR121B",83,0)
 Q
"RTN","RMPR121C")
0^2^B10766286
"RTN","RMPR121C",1,0)
RMPR121C ;HINES-OI/HNC/SPS - IFCAP GUI TO 2319 ;3/1/2003
"RTN","RMPR121C",2,0)
 ;;3.0;PROSTHETICS;**90**;Feb 09, 1996
"RTN","RMPR121C",3,0)
 ;
"RTN","RMPR121C",4,0)
R19 ;PASS RMPRA AS IEN OF 644, AND B2 AS ITEM MULTIPLE
"RTN","RMPR121C",5,0)
 ;S:$D(RMPRCONT) $P(^RMPR(664,RMPRA,1,B2,0),U,14)=RMPRCONT
"RTN","RMPR121C",6,0)
 S RMPRI=$P(^RMPR(664,RMPRA,1,B2,0),U,1),RMPRCT=$P(^(0),U,3)
"RTN","RMPR121C",7,0)
 S RMPRQT=$P(^RMPR(664,RMPRA,1,B2,0),U,4),RMPRDES=$P(^(0),U,2)
"RTN","RMPR121C",8,0)
 ;contract data
"RTN","RMPR121C",9,0)
 S RMPRCONT=""
"RTN","RMPR121C",10,0)
 S RMPRCONT=$P(^RMPR(664,RMPRA,1,B2,0),U,14)
"RTN","RMPR121C",11,0)
 ;TEMPORARY FIX FOR TRANSACTION TYPE AND PATIENT CATAGORY
"RTN","RMPR121C",12,0)
 S RMPRT=$P(^RMPR(664,RMPRA,1,B2,0),U,9),RMPRR=$P(^(0),U,8),RMPRDIS=$P(^(0),U,10),RMPRS=$P(^(0),U,12),UOI=$P(^(0),U,5),RMPRSLN=$P(^(0),U,15)
"RTN","RMPR121C",13,0)
 ;
"RTN","RMPR121C",14,0)
 I RMPRT="R" S $P(^RMPR(664,RMPRA,1,B2,0),U,9)="X",RMPRT="X"
"RTN","RMPR121C",15,0)
 I RMPRDIS=2 S $P(^RMPR(664,RMPRA,1,B2,0),U,10)=1,RMPRDIS=1
"RTN","RMPR121C",16,0)
 I RMPRDIS=3 S $P(^RMPR(664,RMPRA,1,B2,0),U,10)=4,RMPRDIS=4
"RTN","RMPR121C",17,0)
 S RMPRSC=$P(^RMPR(664,RMPRA,1,B2,0),U,11) ;Special catagory
"RTN","RMPR121C",18,0)
 S RMPRNOB=$P(^RMPR(664,RMPRA,1,B2,0),U,17) ;NUMBER OF BIDS
"RTN","RMPR121C",19,0)
 S RMPRHCPC=$P(^RMPR(664,RMPRA,1,B2,0),U,16) ;PSAS HCPCS
"RTN","RMPR121C",20,0)
 S RMPRMK=$P(^RMPR(664,RMPRA,1,B2,2),U,1),RMPRMD=$P(^(2),U,2),RMPRLTN=$P(^(2),U,3),RMPREW=$P(^(2),U,4) ;MAKE,MODEL,LOT,EXCLUDE/WAVER
"RTN","RMPR121C",21,0)
 S RMCPT=$P($G(^RMPR(664,RMPRA,1,B2,4)),U,2) ;CPT MODIFIER
"RTN","RMPR121C",22,0)
 K DD,DO S DIC="^RMPR(660,",DIC(0)="QL",X=DT,DLAYGO=660
"RTN","RMPR121C",23,0)
 D FILE^DICN K DLAYGO S (RMPR660,DA)=+Y
"RTN","RMPR121C",24,0)
 S $P(^RMPR(664,RMPRA,1,B2,0),U,13)=RMPR660
"RTN","RMPR121C",25,0)
 S DA=RMPRA,DIK="^RMPR(664," D IX1^DIK
"RTN","RMPR121C",26,0)
 S RMPRAMT=(RMPRQT*RMPRCT)
"RTN","RMPR121C",27,0)
 S RMPRDCT=RMPRAMT*RMPRPER
"RTN","RMPR121C",28,0)
 S RMPRTOTL=RMPRAMT-RMPRDCT
"RTN","RMPR121C",29,0)
 ;ctd is unit cost with percent discount applied.
"RTN","RMPR121C",30,0)
 S RMPRCTD=RMPRAMT-RMPRDCT/RMPRQT
"RTN","RMPR121C",31,0)
 ;
"RTN","RMPR121C",32,0)
 S ^RMPR(660,RMPR660,0)=DT_U_RMPRDFN_U_DT_U_RMPRT_U_U_U_RMPRQT_U_UOI_U_RMPRV_U_RMPR("STA")_U_U_U_"14"_U_RMPRS_U_U_$J(RMPRTOTL,0,2)_"^^^^^^"
"RTN","RMPR121C",33,0)
 ;SERIAL#,MAKE,MODEL,LOT#,EXCLUDE/WAVER
"RTN","RMPR121C",34,0)
 S $P(^RMPR(660,RMPR660,0),U,11)=RMPRSLN,$P(^(0),U,24)=RMPRLTN
"RTN","RMPR121C",35,0)
 S $P(^RMPR(660,RMPR660,9),U)=RMPRMK,$P(^(9),U,2)=RMPRMD
"RTN","RMPR121C",36,0)
 S $P(^RMPR(660,RMPR660,2),U,3)=RMPREW
"RTN","RMPR121C",37,0)
 ;CONTRACT #
"RTN","RMPR121C",38,0)
 S $P(^RMPR(660,RMPR660,2),U,9)=$P(^RMPR(664,RMPRA,1,B2,0),U,14)
"RTN","RMPR121C",39,0)
 ; ITEM
"RTN","RMPR121C",40,0)
 S $P(^RMPR(660,RMPR660,0),U,6)=RMPRI
"RTN","RMPR121C",41,0)
 ;NUMBER OF BIDS
"RTN","RMPR121C",42,0)
 S $P(^RMPR(660,RMPR660,2),U,10)=RMPRNOB
"RTN","RMPR121C",43,0)
 ;HCPCS code
"RTN","RMPR121C",44,0)
 S:RMPRHCPC $P(^RMPR(660,RMPR660,0),U,22)=$P(^RMPR(661.1,RMPRHCPC,0),U,4)
"RTN","RMPR121C",45,0)
 ;
"RTN","RMPR121C",46,0)
 S ^RMPR(660,RMPR660,"AMS")=RMPRG,^RMPR(660,RMPR660,"AM")=U_U_RMPRDIS_U_RMPRSC I $D(RMPRWO),RMPRWO S $P(^("AM"),U,2)=1,$P(^RMPR(660,RMPR660,"LB"),U,5)=RMPRWO
"RTN","RMPR121C",47,0)
 S:$D(RMPRR) $P(^RMPR(660,RMPR660,0),U,18)=RMPRR
"RTN","RMPR121C",48,0)
 S RMPRTRN=$P(^RMPR(664,RMPRA,4),U,5)
"RTN","RMPR121C",49,0)
 S $P(^RMPR(660,RMPR660,0),U,27)=DUZ,^(1)=RMPRTRN_U_RMPRDES_"^^"_RMPRHCPC_"^^"_RMCPT
"RTN","RMPR121C",50,0)
 ;note to supplier
"RTN","RMPR121C",51,0)
 ;
"RTN","RMPR121C",52,0)
 S RMPRNS=""
"RTN","RMPR121C",53,0)
 S (D1,RD)=0
"RTN","RMPR121C",54,0)
 F  S RD=$O(^RMPR(664,RMPRA,1,B2,1,RD)) Q:RD=""  D
"RTN","RMPR121C",55,0)
 .S ^RMPR(660,RMPR660,"DES",RD,0)=^RMPR(664,RMPRA,1,B2,1,RD,0)
"RTN","RMPR121C",56,0)
 .I $L(RMPRNS)>160 Q
"RTN","RMPR121C",57,0)
 .S RMPRNS=RMPRNS_" "_^RMPR(664,RMPRA,1,B2,1,RD,0)
"RTN","RMPR121C",58,0)
 .S D1=RD
"RTN","RMPR121C",59,0)
 S ^RMPR(660,RMPR660,"DES",0)="^660.028^"_D1_U_D1
"RTN","RMPR121C",60,0)
 S:$D(RMPRDELN) ^RMPR(660,RMPR660,3)=RMPRDELN
"RTN","RMPR121C",61,0)
 ;modified by #62
"RTN","RMPR121C",62,0)
 S ^TMP($J,"RMPRPCE",660,RMPR660)=RMPRG_"^"_$G(RMPRDFN)
"RTN","RMPR121C",63,0)
 ;set x-refs
"RTN","RMPR121C",64,0)
 S DIK="^RMPR(660,",DA=RMPR660 D IX1^DIK
"RTN","RMPR121C",65,0)
 ;
"RTN","RMPR121C",66,0)
 K RMPRTRN
"RTN","RMPR121C",67,0)
 Q
"RTN","RMPR21A")
0^7^B43366806
"RTN","RMPR21A",1,0)
RMPR21A ;PHX/HNB/JLT-CONT. CREATE 1358 TRANSACTION, POST TO 2319 ;8/29/1994
"RTN","RMPR21A",2,0)
 ;;3.0;PROSTHETICS;**12,41,50,90**;Feb 09, 1996
"RTN","RMPR21A",3,0)
 ;HNC - #90, item to billing item 10/29/04
"RTN","RMPR21A",4,0)
 ;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","RMPR21A",5,0)
P24 ;2421 DATE REQUIRED
"RTN","RMPR21A",6,0)
 S DR="20//T+30" D ^DIE I $D(DTOUT)!($D(Y)'=0) G KILL^RMPR21
"RTN","RMPR21A",7,0)
COT ;2421'S AND NO FORM WITH CONTRACT AUTHORITY1
"RTN","RMPR21A",8,0)
 I '$D(^RMPR(664,RMPRA,3)) S ^(3)=""
"RTN","RMPR21A",9,0)
 S DR="4"
"RTN","RMPR21A",10,0)
COT1 D ^DIE I $D(DTOUT)!($D(Y)'=0) G KILL^RMPR21
"RTN","RMPR21A",11,0)
 S RMPRV=$P($G(^RMPR(664,RMPRA,0)),U,4) G:$G(RMPRV)'>0 TRAN G:'$D(^PRC(440,RMPRV,4)) TRAN K DIR S DIR(0)="PO^PRC(440,"_RMPRV_",4,:QEM" D ^DIR I (Y'>0)&(X'="")&(X'["^") S DIR("B")="" G COT1
"RTN","RMPR21A",12,0)
 I X["^" G KILL^RMPR21
"RTN","RMPR21A",13,0)
 I Y>0,$P(^PRC(440,RMPRV,4,+Y,0),U,2)<DT W $C(7),!,"Sorry, contract has expired.  Enter another contract or `return` to continue." S DR="4//""""" G COT1
"RTN","RMPR21A",14,0)
 K DIR,DA S:Y>0 (RMPRCONT,RMPRCTK)=$P(Y,U,2)
"RTN","RMPR21A",15,0)
L2 ;ENTER/EDIT 2421, NO FORM
"RTN","RMPR21A",16,0)
 W !,"----------------------------------",!
"RTN","RMPR21A",17,0)
TRAN K DIR S DIR(0)="SMAO^I:INITIAL ISSUE;R:REPLACE;S:SPARE;X:REPAIR"
"RTN","RMPR21A",18,0)
 S DIR("A")="TYPE OF TRANSACTION: " D ^DIR
"RTN","RMPR21A",19,0)
 I $D(DUOUT)!$D(DTOUT) G CHK
"RTN","RMPR21A",20,0)
 I (Y="")&($D(^RMPR(664,RMPRA,1))) G CHK
"RTN","RMPR21A",21,0)
 I (Y="")&('$D(^RMPR(664,RMPRA,1))) W !,"Please enter type of Transaction!!" G TRAN
"RTN","RMPR21A",22,0)
 S RMTYPE=Y
"RTN","RMPR21A",23,0)
PCAT K DIR S DIR(0)="SMAO^1:SC/OP;2:SC/IP;3:NSC/IP;4:NSC/OP"
"RTN","RMPR21A",24,0)
 S DIR("A")="PATIENT CATEGORY: " D ^DIR
"RTN","RMPR21A",25,0)
 I $D(DUOUT)!$D(DTOUT) G CHK
"RTN","RMPR21A",26,0)
 I (Y="")&($D(^RMPR(664,RMPRA,1))) G CHK
"RTN","RMPR21A",27,0)
 I (Y="")&('$D(^RMPRA(664,RMPRA,1))) W !,"Please enter Patient Category!!" G PCAT
"RTN","RMPR21A",28,0)
 S RMCAT=Y
"RTN","RMPR21A",29,0)
 K DIR G:RMCAT<4 ITEM
"RTN","RMPR21A",30,0)
SPES S DIR(0)="SMAO^1:SPECIAL LEGISLATION;2:A&A;3:PHC;4:ELIGIBILITY REFORM"
"RTN","RMPR21A",31,0)
 S DIR("A")="SPECIAL CATEGORY: "
"RTN","RMPR21A",32,0)
 I RMCAT=4 D ^DIR I $D(DUOUT)!$D(DTOUT) G CHK
"RTN","RMPR21A",33,0)
 I RMCAT=4 S RMSPE=Y
"RTN","RMPR21A",34,0)
ITEM ;
"RTN","RMPR21A",35,0)
 K DIR S DIR(0)="FO",DIR("A")="Select BILLING ITEM"
"RTN","RMPR21A",36,0)
 S DIR("?")="^S RFL=1 D ZDSP^RMPR21A"
"RTN","RMPR21A",37,0)
 D ^DIR G:$D(DTOUT) KILL^RMPR21 G:$D(DUOUT) CHK
"RTN","RMPR21A",38,0)
 G:$D(DIRUT)&($D(^RMPR(664,RMPRA,1))) CHK
"RTN","RMPR21A",39,0)
 S DIC=661,DIC(0)="EQMZ" D ^DIC G:+Y'>0 ITEM
"RTN","RMPR21A",40,0)
 D EDT^RMPRUTIL G:$D(DTOUT) KILL^RMPR21 G L2
"RTN","RMPR21A",41,0)
 ;
"RTN","RMPR21A",42,0)
CHK K RFL,DIR S FL=1
"RTN","RMPR21A",43,0)
 I '$D(^RMPR(664,RMPRA,1)) W !!,?5,$C(7),"REQUIRED FIELDS DO NOT EXIST ON THIS FORM",! G KILL^RMPR21
"RTN","RMPR21A",44,0)
 I $D(^RMPR(664,RMPRA,1)) S FL=0 F RI=0:0 S RI=$O(^RMPR(664,RMPRA,1,RI)) Q:RI'>0  I $D(^(RI,0)) S FL=1 I $P(^(0),U,3)=""!($P(^(0),U,4)="")!($P(^(0),U,5)="")!($P(^(0),U,9)="")!($P(^(0),U,10)="") S FL=0 Q
"RTN","RMPR21A",45,0)
 I 'FL W !!,?5,$C(7),"REQUIRED FIELDS DO NOT EXIST ON THIS FORM",! G KILL^RMPR21
"RTN","RMPR21A",46,0)
 S $P(^RMPR(664,RMPRA,0),U,9)=DUZ
"RTN","RMPR21A",47,0)
 I $D(DUOUT)&('$D(^RMPR(664,RMPRA,1))) W !,$C(7),$C(7),"Please Try Later!" G KILL^RMPR21
"RTN","RMPR21A",48,0)
 I RMPRF'=8 S DA=RMPRA,DIE=664,DR="11;17" D ^DIE
"RTN","RMPR21A",49,0)
ASK I RMPRF=2 D  D ^DIR K DIR G:$D(DTOUT) KILL^RMPR21 I $D(DIRUT)!(X="") W $C(7),"Delivery is required.  Enter '?' for additional help." G ASK
"RTN","RMPR21A",50,0)
 .K DIR
"RTN","RMPR21A",51,0)
 .S DIR(0)="SAO^1:VETERAN;2:VAMC WAREHOUSE;3:PROSTHETICS;4:OTHER;"
"RTN","RMPR21A",52,0)
 .S DIR("A")="DELIVER TO: "
"RTN","RMPR21A",53,0)
 .;S DIR("B")=$P(^RMPR(664,RMPRA,3),U,1)
"RTN","RMPR21A",54,0)
 .;D ^DIR K DIR G:$D(DTOUT) KILL^RMPR21 I $D(DIRUT) W $C(7)," ??" G ASK
"RTN","RMPR21A",55,0)
 I RMPRF=2 S:Y'=4 RMPRDELN=Y(0),$P(^RMPR(664,RMPRA,3),U)=RMPRDELN I Y=4 D  G:$D(DTOUT) KILL^RMPR21 S RMPRDELN=$P(^RMPR(664,RMPRA,3),U)
"RTN","RMPR21A",56,0)
 .S DIE="^RMPR(664,",DA=RMPRA,DR="19T" D ^DIE
"RTN","RMPR21A",57,0)
 .Q
"RTN","RMPR21A",58,0)
ASK5 S %=2 W !!,"Are you ready to POST to IFCAP and 10-2319 NOW" D YN^DICN G:%=1 FILE^RMPR21B G:$D(DTOUT) KILL^RMPR21
"RTN","RMPR21A",59,0)
 I %=0 W !,"This will Create a Daily Transaction in the 1358 Module of IFCAP,",!,"and Create an Entry on the Prosthetic 10-2319 Record" G ASK5
"RTN","RMPR21A",60,0)
 I %=-1 S %=2 R !,"Do you want to Delete this Transaction" D YN^DICN G:$D(DTOUT)!(%=1) KILL^RMPR21
"RTN","RMPR21A",61,0)
 D ^RMPRLI I RMPRX]"" G ASK5
"RTN","RMPR21A",62,0)
L W !!!,"Enter Item to Edit: " R X:DTIME G:'$T KILL^RMPR21
"RTN","RMPR21A",63,0)
 G:"^"[X ASK5 I X["?" D ZDSP G L
"RTN","RMPR21A",64,0)
 S DA(1)=RMPRA,DIC="^RMPR(664,"_RMPRA_",1,",DIC(0)="EQMZ" D ^DIC I +Y'>0 K DA,Y G L
"RTN","RMPR21A",65,0)
 ;HCPCS code
"RTN","RMPR21A",66,0)
 S:$D(RMPRCTK) RMPRCONT=RMPRCTK
"RTN","RMPR21A",67,0)
 S DA=+Y,DA(1)=RMPRA
"RTN","RMPR21A",68,0)
 S DR="8;9;S RMTYPE=$P($G(^(0)),U,9);I $P(^RMPR(664,DA(1),1,DA,0),U,10)=4 S Y=""@1"";.01;16;1;14;3;2;4;7;S Y="""";@1;10;.01;16;1;14;3;2;4;7"
"RTN","RMPR21A",69,0)
 S DIE="^RMPR(664,"_RMPRA_",1," D ^DIE
"RTN","RMPR21A",70,0)
 ;do a final check for cpt modifier
"RTN","RMPR21A",71,0)
 D CHKCPT
"RTN","RMPR21A",72,0)
 K DA
"RTN","RMPR21A",73,0)
 S FL=1 I $D(^RMPR(664,RMPRA,1)) S FL=0 F RI=0:0 S RI=$O(^RMPR(664,RMPRA,1,RI)) Q:RI'>0  I $D(^(RI,0)) S FL=1 I $P(^(0),U,3)=""!($P(^(0),U,4)="")!($P(^(0),U,5)="")!($P(^(0),U,9)="")!($P(^(0),U,10)="") S FL=0 Q
"RTN","RMPR21A",74,0)
 I 'FL W !!,?5,$C(7),"REQUIRED ITEMS DO NOT EXIST ON THIS FORM",! G KILL^RMPR21
"RTN","RMPR21A",75,0)
 K DA S DIE="^RMPR(664,",DA=RMPRA,DR="11;17" S:RMPRF=2 DR=DR_";20" D ^DIE
"RTN","RMPR21A",76,0)
 I RMPRF=2 D  G:$D(DTOUT) KILL^RMPR21 G:$D(DUOUT) ASK5
"RTN","RMPR21A",77,0)
 .S DIR(0)="SA^1:VETERAN;2:VAMC WAREHOUSE;3:PROSTHETICS;4:OTHER;"
"RTN","RMPR21A",78,0)
 .S DIR("A")="DELIVER TO: "
"RTN","RMPR21A",79,0)
 .;REMOVE DIR(?)
"RTN","RMPR21A",80,0)
 .S DIR("B")=$P(^RMPR(664,DA,3),U,1)
"RTN","RMPR21A",81,0)
 .D ^DIR K DIR
"RTN","RMPR21A",82,0)
 .Q:$D(DTOUT)!($D(DUOUT))
"RTN","RMPR21A",83,0)
 .S RMPRDELN=Y(0)
"RTN","RMPR21A",84,0)
 .I Y=4 S:'$D(^RMPR(664,RMPRA,3)) ^(3)="" S Y1=Y,DIE="^RMPR(664,",DA=RMPRA,DR="19T" D ^DIE
"RTN","RMPR21A",85,0)
 G:$D(DTOUT) KILL^RMPR21 S RMPRDELN=$S($D(Y1):$P(^RMPR(664,RMPRA,3),U),1:RMPRDELN) K Y1 G L
"RTN","RMPR21A",86,0)
 ;
"RTN","RMPR21A",87,0)
ZDSP ;MULTIPLE ITEM DISPLAY FOR PURCHASING AND CLOSE-OUT
"RTN","RMPR21A",88,0)
 K RAC S RMPRI=0 F  S RMPRI=$O(^RMPR(664,RMPRA,1,RMPRI)) Q:RMPRI'>0  S RMPRI1=$P(^(RMPRI,0),U,1),RMPRIT=$P(^RMPR(661,RMPRI1,0),U,1),RAC(RMPRIT)=$P(^PRC(441,RMPRIT,0),U,2)
"RTN","RMPR21A",89,0)
 W ! I $D(RAC) W !,?5,"Answer With Item # or Item Name",! F RI=0:0 S RI=$O(RAC(RI)) Q:RI'>0  W !,?5,RI,?10,RAC(RI)
"RTN","RMPR21A",90,0)
LDIC I $D(RFL) S X="?",DIC=661,DIC(0)="EQM",DIC("W")="W "" "",$P(^PRC(441,$P(^(0),U,1),0),U,2)" D ^DIC K RFL
"RTN","RMPR21A",91,0)
 Q
"RTN","RMPR21A",92,0)
PR1 ;ENTRY POINT FOR  10-2421S   ASKING THE USER IF THEY WANT TO PRINT THE PATIENT NOTIFICATION LETTER
"RTN","RMPR21A",93,0)
 Q:RMPRF'=2
"RTN","RMPR21A",94,0)
 S RMPRPN=0,%=2
"RTN","RMPR21A",95,0)
 R !,"Would you like to print a Patient Notification letter"
"RTN","RMPR21A",96,0)
 D YN^DICN I %=1 S RMPRPN=1 Q
"RTN","RMPR21A",97,0)
 G:%=0 HELP1
"RTN","RMPR21A",98,0)
 Q:(%=2)!(%=-1)
"RTN","RMPR21A",99,0)
 Q
"RTN","RMPR21A",100,0)
HELP1 ;
"RTN","RMPR21A",101,0)
 W !,"Enter `Y` for YES to print the Patient Notification letter",!,"`N` for No if you do not wish to print the letter." G PR1
"RTN","RMPR21A",102,0)
 Q
"RTN","RMPR21A",103,0)
PR ;ENTRY POINT FOR BOTH 10-2421S AND 10-55S ASKING THE USER IF THEY WANT TO PRINT THE PRIVACY ACT STATEMENT
"RTN","RMPR21A",104,0)
 S %=1 R !,"Would you like to print the Privacy Act Statement" D YN^DICN I %=1 S RMPRPRIV=1 D PR1 Q
"RTN","RMPR21A",105,0)
 G:%=0 HELP D:%=2 PR1 Q
"RTN","RMPR21A",106,0)
 Q:%=-1
"RTN","RMPR21A",107,0)
HELP W !,"Enter `Y` for YES to print the Privacy Act Statement",!,"`N` for NO if you do not want to print the statement." G PR
"RTN","RMPR21A",108,0)
 Q
"RTN","RMPR21A",109,0)
 ;
"RTN","RMPR21A",110,0)
CHKCPT ;check for cpt modifier
"RTN","RMPR21A",111,0)
 S RMCPTOLD=$P($G(^RMPR(664,DA(1),1,DA,4)),U,2)
"RTN","RMPR21A",112,0)
 S RMTYNEW=$P(^RMPR(664,DA(1),1,DA,0),U,9)
"RTN","RMPR21A",113,0)
 S RMHCPC=$P(^RMPR(664,DA(1),1,DA,0),U,16) Q:'$G(RMHCPC)
"RTN","RMPR21A",114,0)
 I ((RMTYNEW="R")!(RMTYNEW="X")),(RMCPTOLD'["RP"),($G(^RMPR(661.1,RMHCPC,4))["RP") D ADDRP
"RTN","RMPR21A",115,0)
 I ((RMTYNEW="I")!(RMTYNEW="S")),(RMCPTOLD["RP"),($G(^RMPR(661.1,RMHCPC,4))["RP") D DELRP
"RTN","RMPR21A",116,0)
 K RMCPTOLD,RMTYNEW,RMHCPC,RMF,RMCI,RMC,RMLPIECE,RMCLEN
"RTN","RMPR21A",117,0)
 Q
"RTN","RMPR21A",118,0)
DELRP ;logic for deleting 'RP' modifier with transaction change.
"RTN","RMPR21A",119,0)
 F RMCI=1:1:8 S RMC=$P(RMCPTOLD,",",RMCI) I RMC="RP" S $P(RMCPTOLD,",",RMCI)="" D
"RTN","RMPR21A",120,0)
 .S RMF=$F(RMCPTOLD,",,"),RMFPIECE=$E(RMCPTOLD,1,RMF-2)
"RTN","RMPR21A",121,0)
 .S RMLPIECE=$E(RMCPTOLD,RMF,32),RMCPTOLD=RMFPIECE_RMLPIECE
"RTN","RMPR21A",122,0)
 .S RMCLEN=$L(RMCPTOLD)
"RTN","RMPR21A",123,0)
 .I $E(RMCPTOLD,1)="," S RMCPTOLD=$E(RMCPTOLD,2,RMCLEN)
"RTN","RMPR21A",124,0)
 .I $E(RMCPTOLD,RMCLEN)="," S RMCPTOLD=$E(RMCPTOLD,1,RMCLEN-1)
"RTN","RMPR21A",125,0)
 .S $P(^RMPR(664,DA(1),1,DA,4),U,2)=RMCPTOLD
"RTN","RMPR21A",126,0)
 Q
"RTN","RMPR21A",127,0)
 ;
"RTN","RMPR21A",128,0)
ADDRP ;logic for adding 'RP' modifier with transaction change.
"RTN","RMPR21A",129,0)
 S RMCPTOLD=RMCPTOLD_",RP"
"RTN","RMPR21A",130,0)
 S $P(^RMPR(664,DA(1),1,DA,4),U,2)=RMCPTOLD
"RTN","RMPR21A",131,0)
 Q
"RTN","RMPR21A",132,0)
 ;END
"RTN","RMPR4LI")
0^29^B14468243
"RTN","RMPR4LI",1,0)
RMPR4LI ;PHX/HNB,RVD-DISPLAY ITEMS ON PURCHASE CARD TRANSACTION ;3/1/1996
"RTN","RMPR4LI",2,0)
 ;;3.0;PROSTHETICS;**3,12,19,20,28,30,41,90**;Feb 09, 1996
"RTN","RMPR4LI",3,0)
 ;pass RMPRA
"RTN","RMPR4LI",4,0)
 S:'$D(RMPRDELN) RMPRDELN="" S (RMPRI,RMPRCNT)=0,RMPRX="" D HOME^%ZIS W @IOF S:'$D(RMPRSER) RMPRSER=""
"RTN","RMPR4LI",5,0)
 W !?5,$G(RMPRSSNE)
"RTN","RMPR4LI",6,0)
 W ?55,"Purchase Card",!
"RTN","RMPR4LI",7,0)
 W ?5,$$STA^RMPRUTIL,"-",$P(^RMPR(664,RMPRA,4),U,5)
"RTN","RMPR4LI",8,0)
 I DUZ=$P(^RMPR(664,RMPRA,0),U,9)!($D(^XUSEC("RMPR FCP MANAGER",DUZ))) W ?55,$$DEC($P(^RMPR(664,RMPRA,4),U,1),$P(^RMPR(664,RMPRA,0),U,9),RMPRA)
"RTN","RMPR4LI",9,0)
 E  W ?55,"encrypted"
"RTN","RMPR4LI",10,0)
 W !
"RTN","RMPR4LI",11,0)
 N RBO S RBO=0
"RTN","RMPR4LI",12,0)
 W !,RMPR("L")
"RTN","RMPR4LI",13,0)
LI F  S RMPRI=$O(^RMPR(664,RMPRA,1,RMPRI)) Q:RMPRI'>0  D  G:$G(RMPRX)["^" EXIT
"RTN","RMPR4LI",14,0)
 .S RMPRCNT=RMPRCNT+1
"RTN","RMPR4LI",15,0)
 .S RMPRI1=^RMPR(664,RMPRA,1,RMPRI,0)
"RTN","RMPR4LI",16,0)
 .D PRT
"RTN","RMPR4LI",17,0)
 I $D(^RMPR(664,RMPRA,1)) W !!,?25,"SUB TOTAL: ",?65,"$",$J(RBO,7,2)
"RTN","RMPR4LI",18,0)
 I $D(^RMPR(664,RMPRA,2)),$P(^(2),U,6) S DCT=$P(^(2),U,6),DCT=DCT/100
"RTN","RMPR4LI",19,0)
 I $D(DCT) D
"RTN","RMPR4LI",20,0)
 .W !!,?25,"% DISCOUNT:  "
"RTN","RMPR4LI",21,0)
 .Q:'$D(DCT)
"RTN","RMPR4LI",22,0)
 .W DCT*100
"RTN","RMPR4LI",23,0)
 .S DCTT=$J(RBO*DCT,7,2)
"RTN","RMPR4LI",24,0)
 .W ?65,"$",DCTT
"RTN","RMPR4LI",25,0)
 .S DCTT=$TR(DCTT," ","")
"RTN","RMPR4LI",26,0)
 .S RBO=RBO-DCTT
"RTN","RMPR4LI",27,0)
 .K DCT,DCTT
"RTN","RMPR4LI",28,0)
 W !?25,"SHIPPING CHARGE: "
"RTN","RMPR4LI",29,0)
 S R2=$S($P(^RMPR(664,RMPRA,0),U,11)]"":$P(^(0),U,11),$P(^(0),U,10):$P(^(0),U,10),1:"") W ?65,"$",$J(R2,7,2) W !
"RTN","RMPR4LI",30,0)
 W !,?25,"TOTAL COST: ",?65,"$",$J(R2+RBO,7,2)
"RTN","RMPR4LI",31,0)
 W !,?5,"BANK AUTHORIZATION: ",$P(^RMPR(664,RMPRA,4),U,2)
"RTN","RMPR4LI",32,0)
 G EXIT
"RTN","RMPR4LI",33,0)
PRT I RMPRCNT<0 W !,"NO ITEMS ON FILE" Q
"RTN","RMPR4LI",34,0)
 W !!?5,"ITEM: "
"RTN","RMPR4LI",35,0)
 S RMPRIT=$P(RMPRI1,U,1),RMPRIT1=$P(^RMPR(661,RMPRIT,0),U,1)
"RTN","RMPR4LI",36,0)
 W $P(^PRC(441,RMPRIT1,0),U,1),"   ",$P(^(0),U,2),"   ",?45,"AMIS: " S RMPRAMIS=$S($P(RMPRI1,U,9)'="X":$P(^RMPR(661,RMPRIT,0),U,3),1:$P(^RMPR(661,RMPRIT,0),U,4))
"RTN","RMPR4LI",37,0)
 W $S(RMPRAMIS="":"NO CODE FOR THIS ITEM",1:$P(^RMPR(663,RMPRAMIS,0),U,1))
"RTN","RMPR4LI",38,0)
 W !,?5,"VENDOR TRACKING: ",$P($G(^RMPR(664,RMPRA,1,RMPRI,4)),U,1)
"RTN","RMPR4LI",39,0)
 S RCPT=$P(^RMPR(664,RMPRA,1,RMPRI,0),U,16)
"RTN","RMPR4LI",40,0)
 S:RCPT RMPRCPT=$G(^RMPR(661.1,RCPT,0))
"RTN","RMPR4LI",41,0)
 I $D(RMPRCPT) W !,?5,"PSAS HCPCS CODE: ",$P(RMPRCPT,U,1),?31,$P(RMPRCPT,U,2)
"RTN","RMPR4LI",42,0)
 K RCPT,RMPRCPT
"RTN","RMPR4LI",43,0)
 W !,?5,"CPT MODIFIER: ",$P($G(^RMPR(664,RMPRA,1,RMPRI,4)),U,2)
"RTN","RMPR4LI",44,0)
 I $P(^RMPR(664,RMPRA,1,RMPRI,0),U,8)'="" W !?5,"REMARKS: ",$P(^(0),U,8)
"RTN","RMPR4LI",45,0)
 I $D(RMPRF),RMPRF=2 W !!?5,"DELIVER TO: ",RMPRDELN
"RTN","RMPR4LI",46,0)
 W !!?5,"DESCRIPTION: ",$P(RMPRI1,U,2)
"RTN","RMPR4LI",47,0)
 W !?5,"SERIAL NUMBER: " S RMPRSER=$S($P(^RMPR(664,RMPRA,1,RMPRI,0),U,15)]"":$P(^(0),U,15),$D(^RMPR(660,+$P(^(0),U,13),0)):$P(^(0),U,11),1:"") W RMPRSER
"RTN","RMPR4LI",48,0)
 ;W !?5,"UNIT COST: ",$J($S($P(RMPRI1,U,7):$P(RMPRI1,U,7),1:$P(RMPRI1,U,3)),0,2),?25,"UNIT OF ISSUE: "
"RTN","RMPR4LI",49,0)
 W !,?5,"UNIT COST: " S R1=$P(RMPRI1,U,7) S:R1=""!(R1<0) R1=$P(RMPRI1,U,3) W R1,?25,"UNIT OF ISSUE: "
"RTN","RMPR4LI",50,0)
 S RMPRU=$P(RMPRI1,U,5) W:RMPRU'="" $P(^PRCD(420.5,RMPRU,0),U,1),?45,"QTY: ",$P(RMPRI1,U,4),?55,"ITEM COST: "
"RTN","RMPR4LI",51,0)
 ;S R1=$S($P(RMPRI1,U,7):$P(RMPRI1,U,7),1:$P(RMPRI1,U,3)),R2=$P(RMPRI1,U,4),RBO=RBO+(R1*R2) W $J(R1*R2,0,2)
"RTN","RMPR4LI",52,0)
 S R2=$P(RMPRI1,U,4)
"RTN","RMPR4LI",53,0)
 S RBO=RBO+(R1*R2) W $J(R1*R2,0,2)
"RTN","RMPR4LI",54,0)
 W !?5,"TYPE: ",$S($P(RMPRI1,U,9)="X":"REPAIR",$P(RMPRI1,U,9)="I":"INITIAL",$P(RMPRI1,U,9)="R":"REPLACE",$P(RMPRI1,U,9)="S":"SPARE",$P(RMPRI1,U,9)=5:"RENTAL",1:"")
"RTN","RMPR4LI",55,0)
 W ?25,"CATEGORY: ",$S($P(RMPRI1,U,10)=1:"SC/OP",$P(RMPRI1,U,10)=2:"SC/IP",$P(RMPRI1,U,10)=3:"NSC/IP",$P(RMPRI1,U,10)=4:"NSC/OP",1:"")
"RTN","RMPR4LI",56,0)
 W ?44,"SPECIAL CATEGORY: "
"RTN","RMPR4LI",57,0)
 W $S($P(RMPRI1,U,11)=1:"SPEC/LEG",$P(RMPRI1,U,11)=2:"A&A",$P(RMPRI1,U,11)=3:"PHC",$P(RMPRI1,U,11)=4:"ELIGIBILITY REFORM",1:"")
"RTN","RMPR4LI",58,0)
ASK I $Y>17 R !!,"Enter '^' to Quit Display, <Return> to Continue : ",RMPRX:DTIME S:'$T RMPRX="^" Q:RMPRX="^"
"RTN","RMPR4LI",59,0)
 W:$Y>17 @IOF
"RTN","RMPR4LI",60,0)
 Q
"RTN","RMPR4LI",61,0)
EXIT K RMPRI1,R1,R2,ON,OFF Q
"RTN","RMPR4LI",62,0)
 ;
"RTN","RMPR4LI",63,0)
ENC(X,X1,X2) ;encrypt
"RTN","RMPR4LI",64,0)
 ;x is string to encrypt
"RTN","RMPR4LI",65,0)
 ;x1 duz
"RTN","RMPR4LI",66,0)
 ;x2 is ien to file 664
"RTN","RMPR4LI",67,0)
 D EN^XUSHSHP Q X
"RTN","RMPR4LI",68,0)
DEC(X,X1,X2) ;decript
"RTN","RMPR4LI",69,0)
 ;x is encrypted string
"RTN","RMPR4LI",70,0)
 ;x1 is duz
"RTN","RMPR4LI",71,0)
 ;x2 is ien to file 664
"RTN","RMPR4LI",72,0)
 D DE^XUSHSHP Q X
"RTN","RMPR4LI",73,0)
 ;end
"RTN","RMPR4M")
0^13^B29129320
"RTN","RMPR4M",1,0)
RMPR4M ;PHX/HNB,RVD - PURCHASE CARD MODULE FUNCTIONS ;3/1/1996
"RTN","RMPR4M",2,0)
 ;;3.0;PROSTHETICS;**3,26,28,30,41,62,90**;Feb 09, 1996
"RTN","RMPR4M",3,0)
 ;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","RMPR4M",4,0)
 ;
"RTN","RMPR4M",5,0)
 ; RVD patch #62 - pce and suspense link to 2319
"RTN","RMPR4M",6,0)
POST2 ;*** Posting Data to 2319 *******************************************
"RTN","RMPR4M",7,0)
 ;set global to local table/variables
"RTN","RMPR4M",8,0)
 S R190=$G(^RMPR(664,RMPRA,0))
"RTN","RMPR4M",9,0)
 S R192=$G(^RMPR(664,RMPRA,2))
"RTN","RMPR4M",10,0)
 S R193=$G(^RMPR(664,RMPRA,3))
"RTN","RMPR4M",11,0)
 S R194=$G(^RMPR(664,RMPRA,4))
"RTN","RMPR4M",12,0)
 W !,"...now posting to file 660..."
"RTN","RMPR4M",13,0)
ADD ;for adding new entry in 2319
"RTN","RMPR4M",14,0)
 S RMPHC="" I $D(^TMP("RM",$J,"N")) D
"RTN","RMPR4M",15,0)
 .F I=0:0 S I=$O(^TMP("RM",$J,"N",I)) Q:I'>0  S RMI=$G(^RMPR(664,RMPRA,1,I,0)) I RMI D
"RTN","RMPR4M",16,0)
 ..S RMCPT=$P($G(^RMPR(664,RMPRA,1,I,4)),U,2)
"RTN","RMPR4M",17,0)
 ..S DIC="^RMPR(660,",DIC(0)="L",X=DT
"RTN","RMPR4M",18,0)
 ..K DD,DO D FILE^DICN
"RTN","RMPR4M",19,0)
 ..S $P(^RMPR(664,RMPRA,1,I,0),U,13)=+Y
"RTN","RMPR4M",20,0)
 ..D TOT
"RTN","RMPR4M",21,0)
 ..S:$P(RMI,U,16) RMPHC=$P(^RMPR(661.1,$P(RMI,U,16),0),U,4)
"RTN","RMPR4M",22,0)
 ..S R19A=+Y
"RTN","RMPR4M",23,0)
 ..S R19I=$G(^RMPR(664,RMPRA,1,I,0))
"RTN","RMPR4M",24,0)
 ..S R19(660,R19A_",",8)=RMPR("STA")
"RTN","RMPR4M",25,0)
 ..S R19(660,R19A_",",.02)=$P(R190,U,2)
"RTN","RMPR4M",26,0)
 ..S R19(660,R19A_",",7)=$P(R190,U,4)
"RTN","RMPR4M",27,0)
 ..S R19(660,R19A_",",4.3)=$P(R194,U,2)
"RTN","RMPR4M",28,0)
 ..S R19(660,R19A_",",23)=$P(R194,U,5)
"RTN","RMPR4M",29,0)
 ..S R19(660,R19A_",",1)=$P(R190,U,1)
"RTN","RMPR4M",30,0)
 ..S R19(660,R19A_",",25)=$P(R193,U,1)
"RTN","RMPR4M",31,0)
 ..S R19(660,R19A_",",27)=DUZ
"RTN","RMPR4M",32,0)
 ..S R19(660,R19A_",",2)=$P(R19I,U,9)
"RTN","RMPR4M",33,0)
 ..S R19(660,R19A_",",4)=$P(R19I,U,1)
"RTN","RMPR4M",34,0)
 ..S R19(660,R19A_",",5)=$P(R19I,U,4)
"RTN","RMPR4M",35,0)
 ..S R19(660,R19A_",",4.5)=$P(R19I,U,16)
"RTN","RMPR4M",36,0)
 ..S R19(660,R19A_",",4.7)=RMCPT
"RTN","RMPR4M",37,0)
 ..S R19(660,R19A_",",4.1)=RMPHC
"RTN","RMPR4M",38,0)
 ..S R19(660,R19A_",",12)=$P(R19I,U,12)
"RTN","RMPR4M",39,0)
 ..S R19(660,R19A_",",78)=$P(R19I,U,5)
"RTN","RMPR4M",40,0)
 ..S R19(660,R19A_",",16)=$P(R19I,U,8)
"RTN","RMPR4M",41,0)
 ..S R19(660,R19A_",",24)=$P(R19I,U,2)
"RTN","RMPR4M",42,0)
 ..S R19(660,R19A_",",62)=$P(R19I,U,10)
"RTN","RMPR4M",43,0)
 ..S R19(660,R19A_",",63)=$P(R19I,U,11)
"RTN","RMPR4M",44,0)
 ..S R19(660,R19A_",",24)=$P(R19I,U,2)
"RTN","RMPR4M",45,0)
 ..S R19(660,R19A_",",14)=RMTOT
"RTN","RMPR4M",46,0)
 ..S R19(660,R19A_",",9)=$P(R19I,U,15)
"RTN","RMPR4M",47,0)
 ..S R19(660,R19A_",",11)=14
"RTN","RMPR4M",48,0)
 ..S R19(660,R19A_",",68)=RGRP1
"RTN","RMPR4M",49,0)
 ..S R19(660,R19A_",",8.14)=0
"RTN","RMPR4M",50,0)
 ..D FILE^DIE("K","R19","ERROR")
"RTN","RMPR4M",51,0)
 ..I $D(^RMPR(664,RMPRA,1,I,4)) S $P(^RMPR(660,R19A,4),U,1)=$P(^RMPR(664,RMPRA,1,I,4),U,1)
"RTN","RMPR4M",52,0)
 ..MERGE ^RMPR(660,R19A,"DES")=^RMPR(664,RMPRA,1,I,1)
"RTN","RMPR4M",53,0)
 ..S RMPRDFN=$P(R190,U,2)
"RTN","RMPR4M",54,0)
 ..S RM60LINK(R19A)=""
"RTN","RMPR4M",55,0)
 ..D CHK
"RTN","RMPR4M",56,0)
 ;
"RTN","RMPR4M",57,0)
EDIT ;for editing entry in 2319
"RTN","RMPR4M",58,0)
 S RMPHC="" I $D(^TMP("RM",$J,"E")) D
"RTN","RMPR4M",59,0)
 .F I=0:0 S I=$O(^TMP("RM",$J,"E",I)) Q:I'>0  S RMI=$G(^RMPR(664,RMPRA,1,I,0)),DA=$P(RMI,U,13) I DA D
"RTN","RMPR4M",60,0)
 ..S RMCPT=$P($G(^RMPR(664,RMPRA,1,I,4)),U,2)
"RTN","RMPR4M",61,0)
 ..D TOT
"RTN","RMPR4M",62,0)
 ..S:$P(RMI,U,16) RMPHC=$P(^RMPR(661.1,$P(RMI,U,16),0),U,4)
"RTN","RMPR4M",63,0)
 ..S $P(^RMPR(660,DA,0),U,11)=$P(RMI,U,15)
"RTN","RMPR4M",64,0)
 ..S $P(^RMPR(660,DA,0),U,4)=$P(RMI,U,9)
"RTN","RMPR4M",65,0)
 ..S $P(^RMPR(660,DA,0),U,7)=$P(RMI,U,4)
"RTN","RMPR4M",66,0)
 ..S $P(^RMPR(660,DA,0),U,8)=$P(RMI,U,5)
"RTN","RMPR4M",67,0)
 ..S $P(^RMPR(660,DA,0),U,13)=14
"RTN","RMPR4M",68,0)
 ..S $P(^RMPR(660,DA,0),U,16)=RMTOT
"RTN","RMPR4M",69,0)
 ..S $P(^RMPR(660,DA,"AM"),U,3)=$P(RMI,U,10)
"RTN","RMPR4M",70,0)
 ..S $P(^RMPR(660,DA,"AM"),U,4)=$P(RMI,U,11)
"RTN","RMPR4M",71,0)
 ..S $P(^RMPR(660,DA,0),U,22)=RMPHC
"RTN","RMPR4M",72,0)
 ..S $P(^RMPR(660,DA,1),U,4)=$P(RMI,U,16)
"RTN","RMPR4M",73,0)
 ..S $P(^RMPR(660,DA,1),U,6)=RMCPT
"RTN","RMPR4M",74,0)
 ..S $P(^RMPR(660,DA,0),U,18)=$P(RMI,U,8)
"RTN","RMPR4M",75,0)
 ..;update brief descripton field 24 in 660
"RTN","RMPR4M",76,0)
 ..S $P(^RMPR(660,DA,1),U,2)=$P(RMI,U,2)
"RTN","RMPR4M",77,0)
 ..I $D(^RMPR(664,RMPRA,1,I,4)) S $P(^RMPR(660,DA,4),U,1)=$P(^RMPR(664,RMPRA,1,I,4),U,1)
"RTN","RMPR4M",78,0)
 ..;added by patch #62
"RTN","RMPR4M",79,0)
 ..I $D(^RMPR(660,DA,10)) S RM10STAT=$P(^RMPR(660,DA,10),U,14)
"RTN","RMPR4M",80,0)
 ..I '$D(^RMPR(660,DA,10))!'$G(RM10STAT) D
"RTN","RMPR4M",81,0)
 ...K RM10STAT
"RTN","RMPR4M",82,0)
 ...S RM60LINK(DA)=""
"RTN","RMPR4M",83,0)
 ..MERGE ^RMPR(660,DA,"DES")=^RMPR(664,RMPRA,1,I,1)
"RTN","RMPR4M",84,0)
 ..S DIK="^RMPR(660," D IX1^DIK
"RTN","RMPR4M",85,0)
SHIP ;for shipping entry in 2319
"RTN","RMPR4M",86,0)
 I $G(RMSHIF) S DA=$P(R190,U,12) S:$G(DA) $P(^RMPR(660,DA,0),U,17)=$P(R190,U,11),$P(^RMPR(660,DA,0),U,16)=$P(R190,U,11) I '$G(DA) D
"RTN","RMPR4M",87,0)
 .S DIC="^RMPR(660,",DIC(0)="L",X=DT
"RTN","RMPR4M",88,0)
 .K DD,DO D FILE^DICN
"RTN","RMPR4M",89,0)
 .S $P(^RMPR(664,RMPRA,0),U,12)=+Y
"RTN","RMPR4M",90,0)
 .S R19IEN=$O(^RMPR(664,RMPRA,1,0))
"RTN","RMPR4M",91,0)
 .S R19I=$G(^RMPR(664,RMPRA,1,R19IEN,0))
"RTN","RMPR4M",92,0)
 .S R19A=+Y
"RTN","RMPR4M",93,0)
 .S R19(660,R19A_",",8)=RMPR("STA")
"RTN","RMPR4M",94,0)
 .S R19(660,R19A_",",.02)=$P(R190,U,2)
"RTN","RMPR4M",95,0)
 .S R19(660,R19A_",",7)=$P(R190,U,4)
"RTN","RMPR4M",96,0)
 .S R19(660,R19A_",",4.3)=$P(R194,U,2)
"RTN","RMPR4M",97,0)
 .S R19(660,R19A_",",23)=$P(R194,U,5)
"RTN","RMPR4M",98,0)
 .S R19(660,R19A_",",1)=$P(R190,U,1)
"RTN","RMPR4M",99,0)
 .S R19(660,R19A_",",2)="X"
"RTN","RMPR4M",100,0)
 .S R19(660,R19A_",",25)=$P(R193,U,1)
"RTN","RMPR4M",101,0)
 .S R19(660,R19A_",",27)=DUZ
"RTN","RMPR4M",102,0)
 .S R19(660,R19A_",",6)=$P(R190,U,11)
"RTN","RMPR4M",103,0)
 .S R19(660,R19A_",",14)=$P(R190,U,11)
"RTN","RMPR4M",104,0)
 .S R19(660,R19A_",",11)=14
"RTN","RMPR4M",105,0)
 .S R19(660,R19A_",",12)="C"
"RTN","RMPR4M",106,0)
 .S R19(660,R19A_",",62)=$P(R19I,U,10)
"RTN","RMPR4M",107,0)
 .S R19(660,R19A_",",63)=$P(R19I,U,11)
"RTN","RMPR4M",108,0)
 .S R19(660,R19A_",",68)=RGRP1
"RTN","RMPR4M",109,0)
 .D FILE^DIE("K","R19","ERROR")
"RTN","RMPR4M",110,0)
 .I $D(^RMPR(660,R19A,10)) S RM10STAT=$P(^RMPR(660,R19A,10),U,14)
"RTN","RMPR4M",111,0)
 .I '$D(^RMPR(660,R19A,10))!'$G(RM10STAT) D
"RTN","RMPR4M",112,0)
 ..K RM10STAT
"RTN","RMPR4M",113,0)
 ..S RM60LINK(R19A)=""
"RTN","RMPR4M",114,0)
 ;
"RTN","RMPR4M",115,0)
CAN ;for CANCELING entry in 2319
"RTN","RMPR4M",116,0)
 ;call pce delete if patient encounter was recorded.
"RTN","RMPR4M",117,0)
 I $D(^TMP("RM",$J,"C")) S DIK="^RMPR(660," F RMI=0:0 S RMI=$O(^TMP("RM",$J,"C",RMI)) Q:RMI'>0  D
"RTN","RMPR4M",118,0)
 .I $D(^RMPR(660,RMI,10)),$P(^RMPR(660,RMI,10),U,12) D
"RTN","RMPR4M",119,0)
 ..S RMCHK=0 N RMI
"RTN","RMPR4M",120,0)
 ..S RMCHK=$$DEL^RMPRPCED(RMPRAR)
"RTN","RMPR4M",121,0)
 .S DA=RMI D ^DIK
"RTN","RMPR4M",122,0)
 ;
"RTN","RMPR4M",123,0)
UPD ; Update Percent discount, Bank Authorization and remove shipping entry.
"RTN","RMPR4M",124,0)
 I $G(RMPERF)!$G(RMBANF) D
"RTN","RMPR4M",125,0)
 .F I=0:0 S I=$O(^RMPR(664,RMPRA,1,I)) Q:I'>0  S RMI=$G(^(I,0)),DA=$P(RMI,U,13) I DA D
"RTN","RMPR4M",126,0)
 ..I $G(RMPERF) D TOT S $P(^RMPR(660,DA,0),U,16)=RMTOT
"RTN","RMPR4M",127,0)
 ..S:$G(RMBANF) $P(^RMPR(660,DA,4),U,2)=$P(R194,U,2)
"RTN","RMPR4M",128,0)
 I $G(RMSHIF),($P(^RMPR(664,RMPRA,0),U,11)=0) S DA=$P(^(0),U,12),DIK="^RMPR(660," D ^DIK S $P(^RMPR(664,RMPRA,0),U,12)=""
"RTN","RMPR4M",129,0)
 ;
"RTN","RMPR4M",130,0)
KILL K RMTOT,RMI,R19I,R19A,DR,DA,RMPERF,RMBANF,RMSHIF,RMPHC,RMCPT
"RTN","RMPR4M",131,0)
 Q
"RTN","RMPR4M",132,0)
TOT S RMACT=$P(RMI,U,7),RMUNC=$P(RMI,U,3),RMQTY=$P(RMI,U,4)
"RTN","RMPR4M",133,0)
 I DCT S RMTOT=$S(RMACT=0!(RMACT>0):RMACT-$J(RMACT*DCT,0,2)*RMQTY,1:RMUNC-$J(RMUNC*DCT,0,2)*RMQTY)
"RTN","RMPR4M",134,0)
 I 'DCT S RMTOT=$S(RMACT=0!(RMACT>0):RMACT*RMQTY,1:RMUNC*RMQTY)
"RTN","RMPR4M",135,0)
 Q
"RTN","RMPR4M",136,0)
CHK I '$D(^RMPR(660,R19A,0)) W !!,$C(7),"**** POSTING TO 2319 FOR ITEM.."_I_" FAILED",!,"PLEASE RUN CLOSE-OUT OPTION AGAIN..." G KTMP^RMPR4E21
"RTN","RMPR4M",137,0)
 Q
"RTN","RMPR4P21")
0^16^B31209591
"RTN","RMPR4P21",1,0)
RMPR4P21 ;PHX/HNC,RVD -PRINT PURCHASE CARD ORDER ;3/1/1996
"RTN","RMPR4P21",2,0)
 ;;3.0;PROSTHETICS;**3,15,19,26,55,90**;Feb 09, 1996
"RTN","RMPR4P21",3,0)
 ;
"RTN","RMPR4P21",4,0)
 ; ODJ - patch 55 - 1/29/01 - replace hard code mail route symbol 121
"RTN","RMPR4P21",5,0)
 ;                            with extrinsic call to read site param.
"RTN","RMPR4P21",6,0)
 ;                            (nois AUG-1097-32118)
"RTN","RMPR4P21",7,0)
 ;
"RTN","RMPR4P21",8,0)
 G:$D(RMPRA)&($G(RMPRA)'>0) EN I '$D(RMPR)!'$D(RMPRSITE) D DIV4^RMPRSIT G:$D(X) EX
"RTN","RMPR4P21",9,0)
 I +$P(^RMPR(669.9,RMPRSITE,0),U,5) I $D(RMPRA)&($D(^%ZIS(1,$P(^RMPR(669.9,RMPRSITE,0),U,5),0))) S IOP="Q;"_$P(^(0),U,1) S %ZIS="MQ" D ^%ZIS G:POP EX S ZTIO=ION G PT
"RTN","RMPR4P21",10,0)
 I $D(RMPRA)&('$P(^RMPR(669.9,RMPRSITE,0),U,5)) G ZIS
"RTN","RMPR4P21",11,0)
EN1(RMPRPTR) ;
"RTN","RMPR4P21",12,0)
 I $D(RMPRPTR) I $D(RMPRA)&($D(^%ZIS(1,RMPRPTR,0))) S IOP="Q;"_$P(^(0),U,1) S %ZIS="MQ" D ^%ZIS G:POP EX S ZTIO=ION G PT
"RTN","RMPR4P21",13,0)
EN ;ENTRY POINT FOR REPRINTING- Modified in patch 90 HNC
"RTN","RMPR4P21",14,0)
 I '$D(RMPR)!'$D(RMPRSITE) D DIV4^RMPRSIT G:$D(X) EX
"RTN","RMPR4P21",15,0)
 S RMPRACT=1,DIC="^RMPR(664,",DIC(0)="AEQM",DIC("A")="Select Transaction or Patient Name: ",RMPRF=2
"RTN","RMPR4P21",16,0)
 S DIC("S")="I $D(^(4)) I ('$P(^(0),U,5)),($P(^(0),U,14)=RMPR(""STA""))"
"RTN","RMPR4P21",17,0)
 S DIC("W")="D EN2^RMPR4D1"
"RTN","RMPR4P21",18,0)
 D ^DIC G:Y<0 EX
"RTN","RMPR4P21",19,0)
 S RMPRA=+Y
"RTN","RMPR4P21",20,0)
 ;I $P(^RMPR(664,+Y,0),U,5) D M2^RMPRM
"RTN","RMPR4P21",21,0)
 D PR^RMPR421A I %'>0 G EX
"RTN","RMPR4P21",22,0)
 ;I +$P(^RMPR(669.9,RMPRSITE,0),U,5) I $D(RMPRA)&($D(^%ZIS(1,$P(^RMPR(669.9,RMPRSITE,0),U,5),0))) S IOP="Q;"_$P(^(0),U,1),%ZIS="Q" D ^%ZIS G:POP EX S ZTIO=ION G PT
"RTN","RMPR4P21",23,0)
ZIS S %ZIS="QM" D ^%ZIS G:POP EX
"RTN","RMPR4P21",24,0)
 I '$D(IO("Q")) U IO G PRT
"RTN","RMPR4P21",25,0)
 S ZTIO=ION
"RTN","RMPR4P21",26,0)
PT S ZTDTH=$H,ZTSAVE("RMPRPN")="",ZTSAVE("RMPRA")="",ZTSAVE("RMPRSITE")="",ZTSAVE("RMPR(")="",ZTRTN="PRT^RMPR4P21",ZTDESC="PURCHASE CARD ORDER"
"RTN","RMPR4P21",27,0)
  S:$D(RMPRPRIV) ZTSAVE("RMPRPRIV")="" D ^%ZTLOAD W !,$S($D(ZTSK):"<REQUEST QUEUED>",1:"<REQUEST NOT QUEUED>") D HOME^%ZIS H 3 G EX
"RTN","RMPR4P21",28,0)
PRT ;ENTRY POINT TO PRINT
"RTN","RMPR4P21",29,0)
 S %X="^RMPR(664,RMPRA,",%Y="R664(" D %XY^%RCR K %X,%Y
"RTN","RMPR4P21",30,0)
 S RDUZ=$P(R664(0),U,9),RDUZ=$P(^VA(200,RDUZ,0),U,1),DFN=$P(R664(0),U,2),RTN=$P(R664(0),U,7),CP=$P(R664(0),U,6),RMPRPAGE=2
"RTN","RMPR4P21",31,0)
 D ADD^VADPT,DEM^VADPT,ELIG^VADPT
"RTN","RMPR4P21",32,0)
 W:$Y>0 @IOF W ?20,"OMB Number 2900-0188",?50,"PO#: ",$P($G(^RMPR(664,RMPRA,4)),U,5)
"RTN","RMPR4P21",33,0)
 W !!?7,"***ORIGINAL COPY AND COMMERCIAL INVOICE MUST BE SUBMITTED***",!?15,"TO THE VAMC PROSTHETIC ACTIVITY LISTED BELOW"
"RTN","RMPR4P21",34,0)
HDR ;PRINT HEADER FOR 2421 ADDRESS INFO
"RTN","RMPR4P21",35,0)
 S (RMPRT,RMPRB)="",$P(RMPRT,"_",IOM)="",$P(RMPRB,"-",IOM)="" W !,RMPRT,!,"Department of Veterans Affairs"_"|"_"Prosthetic Authorization for Items or Services",!,RMPRB
"RTN","RMPR4P21",36,0)
 W !,"1. Name and Address of Vendor",?40,"2. Name and Address of VA Facility"
"RTN","RMPR4P21",37,0)
 S RMPRV=$P(R664(0),U,4),RMPRST=""
"RTN","RMPR4P21",38,0)
 I $D(^PRC(440,RMPRV,0)) S RMPRV=^PRC(440,RMPRV,0) D
"RTN","RMPR4P21",39,0)
 .S RMPRST=$P(RMPRV,U,7),RMPRPHON=$P(RMPRV,U,10)
"RTN","RMPR4P21",40,0)
 .S RMPRAD1=$P(RMPRV,U,2),RMPRAD2=$P(RMPRV,U,3)
"RTN","RMPR4P21",41,0)
 .S RMPRCITY=$P(RMPRV,U,6),RMPR90IP=$P(RMPRV,U,8)
"RTN","RMPR4P21",42,0)
 .S RMPRVACN=$P($G(^PRC(440,$P(R664(0),U,4),2)),U,1)
"RTN","RMPR4P21",43,0)
 I $D(^DIC(5,+RMPRST,0)) S RMPRST=$P(^(0),U,2)
"RTN","RMPR4P21",44,0)
 E  S RMPRST="NO STATE ON FILE"
"RTN","RMPR4P21",45,0)
 W !,?5,$E($P(RMPRV,U,1),1,30),?40
"RTN","RMPR4P21",46,0)
 W $E(RMPR("NAME"),1,28)," ","(",$$STA^RMPRUTIL,"/",$$ROU^RMPRUTIL(RMPRSITE),")"
"RTN","RMPR4P21",47,0)
 W !,?5,$E(RMPRAD1,1,35),?40,$E(RMPR("ADD"),1,39)
"RTN","RMPR4P21",48,0)
 I RMPRAD2'="" W !,?5,$E(RMPRAD2,1,35),?40,RMPR("CITY")
"RTN","RMPR4P21",49,0)
 I RMPRAD2="" W !?5,RMPRCITY_","_RMPRST_" "_RMPR90IP,?40,RMPR("CITY")
"RTN","RMPR4P21",50,0)
 I RMPRAD2'="" W !?5,RMPRCITY_","_RMPRST_" "_RMPR90IP
"RTN","RMPR4P21",51,0)
 W !,?5,RMPRPHON
"RTN","RMPR4P21",52,0)
 ;W:$G(RMPRVACN)'="" ?22,"ACCT # ",RMPRVACN
"RTN","RMPR4P21",53,0)
 W ?40,$P(^RMPR(669.9,RMPRSITE,0),U,4),!,RMPRB
"RTN","RMPR4P21",54,0)
 W !,"3. Veterans Name (Last, First, MI)",?40,"4. Date of Authorization"
"RTN","RMPR4P21",55,0)
 W !,?5,VADM(1) S Y=$P(R664(0),U,1) D DD^%DT W ?45,Y
"RTN","RMPR4P21",56,0)
 I $D(RMPRMOR) W !,RMPRB D HDR1 Q
"RTN","RMPR4P21",57,0)
 W !,RMPRB S RMPRODTE=Y
"RTN","RMPR4P21",58,0)
 S RMPRDELD="" I $D(R664(3)),$P(R664(3),U,2)]"" S Y=$P(R664(3),U,2) D DD^%DT S RMPRDELD=Y
"RTN","RMPR4P21",59,0)
 W !,"5. Veterans Address",?40,"6. Date Required",!,?5,VAPA(1),?45,RMPRDELD,!
"RTN","RMPR4P21",60,0)
 I VAPA(2)="" W ?5,VAPA(4)_","_$P(VAPA(5),U,2)_" "_VAPA(6),?40,$E(RMPRB,1,40),!,?40,"9. Authority For Issuance  CFR 17.115",!,?5,VAPA(8),?43,"CHARGE MEDICAL APPROPRIATION"
"RTN","RMPR4P21",61,0)
 I VAPA(2)'="" W ?5,VAPA(2),?40,$E(RMPRB,1,40),!,?5,VAPA(4)_","_$P(VAPA(5),U,2)_" "_VAPA(6),?40,"9. Authority For Issuance  CFR 17.115",!,?5,VAPA(8),?43,"CHARGE MEDICAL APPROPRIATION"
"RTN","RMPR4P21",62,0)
 W !,RMPRB
"RTN","RMPR4P21",63,0)
 W !,"7. Claim Number"_" "_VAEL(7),?40,"8. ID #:"_" "_$P($P(VADM(2),U,2),"-",3),!,RMPRB,!,"10. Statistical Data",?30,"11. FOB Point",?46,"12. Discount",?61,"13. Delivery Time"
"RTN","RMPR4P21",64,0)
 S R664("E")=$O(R664(1,0)),CAT=$P(R664(1,R664("E"),0),U,10)
"RTN","RMPR4P21",65,0)
 S RMPRCAT=$S(CAT=1:"SC/OP",CAT=2:"SC/IP",CAT=3:"NSC/IP",CAT=4:"NSC/OP",1:"")
"RTN","RMPR4P21",66,0)
 S SPE=$P(R664(1,R664("E"),0),U,11)
"RTN","RMPR4P21",67,0)
 S RMPRSCAT=$S(SPE=1:"SPECIAL LEGISLATION",SPE=2:"A&A",SPE=3:"PHC",SPE=4:"ELIGIBILITY REFORM",1:"")
"RTN","RMPR4P21",68,0)
 W !,RMPRCAT_" "_RMPRSCAT S:+$P(R664(0),U,10) RMPRFOB=$P(R664(0),U,10) W ?34,$S($D(RMPRFOB):"ORIGIN",1:"DEST"),?49,"% " I $D(R664(2)) W $P(R664(2),U,6)
"RTN","RMPR4P21",69,0)
 I $D(R664(3)) W ?66,$P(R664(3),U,3)_" Days"
"RTN","RMPR4P21",70,0)
 W !,?30,$E(RMPRB,1,50),!,?30,"14. Delivery To: " W:$D(R664(3)) $P(R664(3),U) W !,RMPRB
"RTN","RMPR4P21",71,0)
HDR1 ;HEADER FOR 10-2421
"RTN","RMPR4P21",72,0)
 W !?17,"15. DESCRIPTION OF ITEMS OR SERVICES AUTHORIZED",!,RMPRB,!,"ITEM NUMBER",?23,"DESCRIPTION",?50,"QUANTITY",?60,"UNIT",?66,"UNIT",?73,"AMOUNT",!,?50,"ORDERED",?66,"PRICE",!,RMPRB Q:$D(RMPRMOR)
"RTN","RMPR4P21",73,0)
 D ^RMPR4P22 D:'$D(RMPRMOR1) CON^RMPR4P22
"RTN","RMPR4P21",74,0)
 S RMPRK=RMPRA
"RTN","RMPR4P21",75,0)
 D:$D(RMPRPRIV) ^RMPR4P23
"RTN","RMPR4P21",76,0)
 W:$G(RMPRPN)=1 @IOF,$$EN^RMPR4P24(RMPRK)
"RTN","RMPR4P21",77,0)
EX ;Common Exit Point
"RTN","RMPR4P21",78,0)
 K VADM,CP,DFN,CAT,DIC,R664,RMPRA,RMPACT,RMPRAD1,RMPRAD2,RMPRAMT,RMPRAMT1,RMPRB,RMPRCAT,RMPRCH,RMPRCITY,RMPRDELD,RMPRI,RMPRI1,RMPRIT,RMPRN,RMPRODTE,RMPRST,RMPRPHON,RMPRT,RMPRTOT,RMPRUT,RMPRV,RMPR90IP,RO,RP,J1,RTN,RMPRMOR1,RMPRPRIV
"RTN","RMPR4P21",79,0)
 K SPE,VA,VAEL,VAPA,VAERR,RZZZ,RX,RX1,RDUZ,RC,RMPRACT,RMPRSCAT,RMPRDISC,RMPRAMTN,DIR,DIRUT,RMPRAMT2,RMPRFOB,RMPRDA,RMPRMOR,RMPRPAGE,RMPRPRIV,RMPRX,RMPR90,J,K,N D ^%ZISC Q
"RTN","RMPR4P22")
0^15^B21879825
"RTN","RMPR4P22",1,0)
RMPR4P22 ;PHX/HNC/RVD-CONT PURCHASE CARD ;3/1/1996
"RTN","RMPR4P22",2,0)
 ;;3.0;PROSTHETICS;**3,20,26,90**;Feb 09, 1996
"RTN","RMPR4P22",3,0)
 S RO=0 F I=1:1 S RO=$O(R664(1,RO)) Q:RO'>0  D  Q:$D(J1)
"RTN","RMPR4P22",4,0)
 .I I>4 S J1=1 W !!,?9,"***SEE ATTACHED CONTINUATION SHEET FOR ITEM DESCRIPTION(S)***",!! Q
"RTN","RMPR4P22",5,0)
 .I $D(R664(1,RO,1,0)) S RP=0 F J=1:1 S RP=$O(R664(1,RO,1,RP)) Q:RP=""  D  Q:$D(J1)
"RTN","RMPR4P22",6,0)
 ..I I>4!((J+I)>4) S J1=1 W !!,?9,"***SEE ATTACHED CONTINUATION SHEET FOR ITEM DESCRIPTION(S)***",!! Q
"RTN","RMPR4P22",7,0)
 D ADD
"RTN","RMPR4P22",8,0)
 S RO=0 F  S RO=$O(R664(1,RO)) Q:RO'>0  D:'$D(RMPRMOR)&($Y>36) CONT D:$D(RMPRMOR)&($Y>58) CONT D:'$D(RMPRMOR) ADD D START
"RTN","RMPR4P22",9,0)
 I '$D(RMPRMOR)&($Y<37) F  W ! Q:$Y>36
"RTN","RMPR4P22",10,0)
 Q
"RTN","RMPR4P22",11,0)
START W !,"#"_RO_"."
"RTN","RMPR4P22",12,0)
 S RMPRI=$S($P(R664(1,RO,0),U,7)'="":$P(R664(1,RO,0),U,7),1:$P(R664(1,RO,0),U,3))
"RTN","RMPR4P22",13,0)
 W ?4,$P(R664(1,RO,0),U,2)
"RTN","RMPR4P22",14,0)
 W ?50,$J($P(R664(1,RO,0),U,4),6) S RMPRUT=$P(R664(1,RO,0),U,5) W:$D(^PRCD(420.5,+RMPRUT,0)) ?61,$P(^PRCD(420.5,+RMPRUT,0),U,1),?65,$J($FN(RMPRI,"P",2),6)
"RTN","RMPR4P22",15,0)
ZWE S RMPRTOT=RMPRI*$P(R664(1,RO,0),U,4) W ?72,$J($FN(RMPRTOT,"P",2),8) D EXT
"RTN","RMPR4P22",16,0)
 Q
"RTN","RMPR4P22",17,0)
EXT ;CHECKING FOR EXTENDED DESCRIPTION
"RTN","RMPR4P22",18,0)
 ;serial number
"RTN","RMPR4P22",19,0)
 N RMPRCNT,RMPRSSM
"RTN","RMPR4P22",20,0)
 S RMPRCNT=0
"RTN","RMPR4P22",21,0)
 S RMPRSSM(1)=$P($G(R664(1,RO,0)),U,15)
"RTN","RMPR4P22",22,0)
 S RMPRSSM(2)=$P($G(R664(1,RO,2)),U,1)
"RTN","RMPR4P22",23,0)
 S RMPRSSM(3)=$P($G(R664(1,RO,2)),U,2)
"RTN","RMPR4P22",24,0)
 S RMPRSSM(4)=$P($G(R664(1,RO,2)),U,3)
"RTN","RMPR4P22",25,0)
 I RMPRSSM(1)'="" S RMPRCNT=RMPRCNT+1
"RTN","RMPR4P22",26,0)
 I RMPRSSM(2)'="" S RMPRCNT=RMPRCNT+1
"RTN","RMPR4P22",27,0)
 I RMPRSSM(3)'="" S RMPRCNT=RMPRCNT+1
"RTN","RMPR4P22",28,0)
 I RMPRSSM(4)'="" S RMPRCNT=RMPRCNT+1
"RTN","RMPR4P22",29,0)
 ;I RMPRCNT>2 D CONT
"RTN","RMPR4P22",30,0)
 W !
"RTN","RMPR4P22",31,0)
 I RMPRSSM(1)'="" W "    Serial Number: "_RMPRSSM(1)
"RTN","RMPR4P22",32,0)
 I RMPRSSM(4)'="" W "    Lot #: "_RMPRSSM(4)
"RTN","RMPR4P22",33,0)
 W !
"RTN","RMPR4P22",34,0)
 I RMPRSSM(3)'="" W "    Model: "_RMPRSSM(3)
"RTN","RMPR4P22",35,0)
 I RMPRSSM(2)'="" W "    Make: "_RMPRSSM(2)
"RTN","RMPR4P22",36,0)
 K RMPRSSM,RMPRCNT
"RTN","RMPR4P22",37,0)
 ;
"RTN","RMPR4P22",38,0)
 S RMPRCH=$G(R664(1,RO,1,0))
"RTN","RMPR4P22",39,0)
 I RMPRCH="" Q
"RTN","RMPR4P22",40,0)
 ;S (RMPR90,RMPRX)=$Q(R664(1,RO,0,0))
"RTN","RMPR4P22",41,0)
 ;S RMPRX=$E(RMPRX,1,10)
"RTN","RMPR4P22",42,0)
 ;Q:RMPR90=""
"RTN","RMPR4P22",43,0)
 S RMPR90=0
"RTN","RMPR4P22",44,0)
 F  S RMPR90=$O(R664(1,RO,1,RMPR90)) Q:RMPR90=""  D
"RTN","RMPR4P22",45,0)
 .D:$D(RMPRMOR)&($Y>58) CONT
"RTN","RMPR4P22",46,0)
 .D:'$D(RMPRMOR)&($Y>36) CONT
"RTN","RMPR4P22",47,0)
 .W !,R664(1,RO,1,RMPR90,0)
"RTN","RMPR4P22",48,0)
 ;F  S RMPR90=$Q(@RMPR90) Q:RMPRX'=$E(RMPR90,1,10)  D:$D(RMPRMOR)&($Y>58) CONT D:'$D(RMPRMOR)&($Y>36) CONT
"RTN","RMPR4P22",49,0)
 ;D WRI
"RTN","RMPR4P22",50,0)
 Q
"RTN","RMPR4P22",51,0)
WRI ;CONTINUATION OF 10-2421
"RTN","RMPR4P22",52,0)
 W !,@RMPR90
"RTN","RMPR4P22",53,0)
 Q
"RTN","RMPR4P22",54,0)
CONT D:'$D(RMPRMOR) CON W @IOF,!,"CONTINUATION OF PURCHASE CARD ",?27,"ORDER NUMBER: ",$P($G(^RMPR(664,RMPRA,4)),U,5),?71,"PAGE ",RMPRPAGE S RMPRMOR=1,RMPRPAGE=RMPRPAGE+1 D HDR^RMPR4P21
"RTN","RMPR4P22",55,0)
 Q
"RTN","RMPR4P22",56,0)
ADD S (RMPRAMT2,RMPRAMT,RMPRAMT1,RMPRAMTN)=0
"RTN","RMPR4P22",57,0)
 S RMSHI=$S($P(R664(0),U,11)'="":$P(R664(0),U,11),1:$P(R664(0),U,10))
"RTN","RMPR4P22",58,0)
 S RC=0 F  S RC=$O(R664(1,RC)) Q:RC=""!(RC["B")  S RMPRI=$S($P(R664(1,RC,0),U,7)'="":$P(R664(1,RC,0),U,7),1:$P(R664(1,RC,0),U,3)) D ADD1
"RTN","RMPR4P22",59,0)
 I $D(R664(2)) S RMPRDISC=$S($P(R664(2),U,6)'="":$P(R664(2),U,6),1:"") I $D(RMPRDISC) S RMPRAMT2=$J(RMPRDISC*RMPRAMT/100,0,2),RMPRAMTN=RMPRAMT-$J(RMPRAMT2,0,2),RMPRAMTN=$J(RMPRAMTN+RMSHI,0,2) Q
"RTN","RMPR4P22",60,0)
 Q
"RTN","RMPR4P22",61,0)
ADD1 S RMPRAMT1=$J($P(R664(1,RC,0),U,4)*RMPRI,0,2) S RMPRAMT=RMPRAMT+RMPRAMT1 Q
"RTN","RMPR4P22",62,0)
CON ;CONTINUATION OF 2421
"RTN","RMPR4P22",63,0)
 W !,RMPRB,!,"16. Contract Number: " S RO("C")=$O(R664(1,0)) W:RO("C") $P(R664(1,RO("C"),0),U,14) W ?61,"Subtotal: ",$J($FN(RMPRAMT,"P",2),8)
"RTN","RMPR4P22",64,0)
 W !,"    ACCT.#: ",RMPRVACN K RMPRVACN
"RTN","RMPR4P22",65,0)
 W ?28,"Discount $" I $D(RMPRAMT2) W $J($FN(RMPRAMT2,"P",2),7)
"RTN","RMPR4P22",66,0)
 W ?45,"Shipping: ",$J($FN(RMSHI,"P",2),5)
"RTN","RMPR4P22",67,0)
 W ?62,"Total",?69,"$",$J($FN(RMPRAMTN,"P",2),9)
"RTN","RMPR4P22",68,0)
 W !,RMPRB,!,"17. Signature of"
"RTN","RMPR4P22",69,0)
 W ?28,"18. DATE",?39,"19. Signature and Title of",?70,"20. Date"
"RTN","RMPR4P22",70,0)
 W !,?5,"Requesting Official",?39,"Contracting/Accountable Officer"
"RTN","RMPR4P22",71,0)
 W !!,?5,RDUZ,?39,RMPR("SIG")
"RTN","RMPR4P22",72,0)
 W !,RMPRB,!?25,"Order and Receipt Action",!,RMPRB
"RTN","RMPR4P22",73,0)
 W !,"21. Order Number",?18,"22. Exp Date",?37,"23. Date Item Received",?62,"24. Date Delivered"
"RTN","RMPR4P22",74,0)
 I DUZ=$P(^RMPR(664,RMPRA,0),U,9)!($D(^XUSEC("RMPR FCP MANAGER",DUZ)))  D
"RTN","RMPR4P22",75,0)
 .;W !,"************"
"RTN","RMPR4P22",76,0)
 .N RMPRPRCD
"RTN","RMPR4P22",77,0)
 .S RMPRPRCD=$$DEC^RMPR4LI($P(^RMPR(664,RMPRA,4),U,1),$P(^RMPR(664,RMPRA,0),U,9),RMPRA)
"RTN","RMPR4P22",78,0)
 .;W $E(RMPRPRCD,13,16)
"RTN","RMPR4P22",79,0)
 .W !,RMPRPRCD
"RTN","RMPR4P22",80,0)
 E  W !,?3,"encrypted"
"RTN","RMPR4P22",81,0)
 ;W !,?3,$$DEC^RMPR4LI($P(^RMPR(664,RMPRA,4),U,1),DUZ,RMPRA)
"RTN","RMPR4P22",82,0)
 ;DATE REMOVED
"RTN","RMPR4P22",83,0)
 W !,RMPRB
"RTN","RMPR4P22",84,0)
 W !,"25. The articles or services listed herein have been received, or rendered",!,"ordered in the quantity and quality specified originally or as shown by"
"RTN","RMPR4P22",85,0)
 W !,"authenticated changes, except as noted.",!!?40,"Signature of Veteran or VA Official",!,RMPRB
"RTN","RMPR4P22",86,0)
 ;W !?30,"VOUCHER AUDIT BLOCK (For use by VA Facility only)",!,RMPRB
"RTN","RMPR4P22",87,0)
 ;W !,"Bank Authorization Number: ",$P(^RMPR(664,RMPRA,4),U,2)
"RTN","RMPR4P22",88,0)
 W !,?$X+6,"Acct. Symbol ",$$STA^RMPRUTIL,"-"_$P($G(^RMPR(664,RMPRA,4)),U,5)
"RTN","RMPR4P22",89,0)
 W !,RMPRB,!,?52,"ADP Form 10-2421PC  APR 1991" S RMPRMOR1=1
"RTN","RMPR4P22",90,0)
 Q
"RTN","RMPR9AUT")
0^3^B19928120
"RTN","RMPR9AUT",1,0)
RMPR9AUT ;HINES IOFO/RVD - DETAILED PO RPC UTILITY ;09/16/03  13:12
"RTN","RMPR9AUT",2,0)
 ;;3.0;PROSTHETICS;**90**;Feb 09, 1996
"RTN","RMPR9AUT",3,0)
 ;input variables:
"RTN","RMPR9AUT",4,0)
 ;DUZ = user
"RTN","RMPR9AUT",5,0)
 ;RMPRSITE = pointer or IEN of file #669.9
"RTN","RMPR9AUT",6,0)
 ;RESULTS = array of all PC number by a user.
"RTN","RMPR9AUT",7,0)
 ;list PC number available to the user
"RTN","RMPR9AUT",8,0)
A1(DUZ,RMPRSITE) G A2
"RTN","RMPR9AUT",9,0)
ENA(RESULTS,DUZ,RMPRSITE) ;broker entry point to list all available PC number.
"RTN","RMPR9AUT",10,0)
A2 ;
"RTN","RMPR9AUT",11,0)
 I $D(^RMPR(669.9,RMPRSITE,4)) S RMIFSITE=$P($G(^RMPR(669.9,RMPRSITE,4)),U,1)
"RTN","RMPR9AUT",12,0)
 I +RMIFSITE'>0 S RESULTS(0)="IFCAP Site is undefined in #669.9" G EXIT1
"RTN","RMPR9AUT",13,0)
 ;call IFCAP routine for the list of PC.
"RTN","RMPR9AUT",14,0)
 D A1^PRCH7PA4(DUZ,RMIFSITE)
"RTN","RMPR9AUT",15,0)
EXIT1 ;exit
"RTN","RMPR9AUT",16,0)
 Q
"RTN","RMPR9AUT",17,0)
 ;
"RTN","RMPR9AUT",18,0)
 ;create file 442.
"RTN","RMPR9AUT",19,0)
 ;DUZ = user or initiator of an order
"RTN","RMPR9AUT",20,0)
 ;RMPRSITE = pointer or IEN of file #669.9
"RTN","RMPR9AUT",21,0)
 ;RESULTS = IEN of file #442 ^ PO number (e.g 499-PA1262)
"RTN","RMPR9AUT",22,0)
B1(DUZ,PRCSITE,RMPRSITE,PRCHXXX,PRCHVEN) G B2
"RTN","RMPR9AUT",23,0)
ENB(RESULTS,DUZ,PRCSITE,RMPRSITE,PRCHXXX,PRCHVEN,PRC4426) ;broker entry point
"RTN","RMPR9AUT",24,0)
B2 ;
"RTN","RMPR9AUT",25,0)
 I $D(^RMPR(669.9,RMPRSITE,4)) S RMIFSITE=$P($G(^RMPR(669.9,RMPRSITE,4)),U,1)
"RTN","RMPR9AUT",26,0)
 I '$D(RMIFSITE) S RESULTS(0)="IFCAP Site is undefined in #669.9" G EXIT2
"RTN","RMPR9AUT",27,0)
 ;call ITCAP routine to create a 442 entry.
"RTN","RMPR9AUT",28,0)
 D AD1^PRCH7PA1(DUZ,RMIFSITE,RMPRSITE,PRCHXXX,PRCHVEN,PRC4426)
"RTN","RMPR9AUT",29,0)
 ;
"RTN","RMPR9AUT",30,0)
EXIT2 ;
"RTN","RMPR9AUT",31,0)
 Q
"RTN","RMPR9AUT",32,0)
 ;
"RTN","RMPR9AUT",33,0)
 ;List all Open detailed Purchased Order
"RTN","RMPR9AUT",34,0)
 ;DUZ = user or initiator of an order
"RTN","RMPR9AUT",35,0)
 ;RMPRSITE = pointer or IEN of file #669.9
"RTN","RMPR9AUT",36,0)
 ;RESULTS = array of all open Detailed PO in file #664.
"RTN","RMPR9AUT",37,0)
C1(DUZ,RMPRSITE) G C2
"RTN","RMPR9AUT",38,0)
ENC(RESULTS,DUZ,RMPRSITE) ;broker entry point
"RTN","RMPR9AUT",39,0)
C2 ;
"RTN","RMPR9AUT",40,0)
 S RMCNT=0
"RTN","RMPR9AUT",41,0)
 F I=0:0 S I=$O(^RMPR(664,"H","DETAILED",I)) Q:I'>0  D
"RTN","RMPR9AUT",42,0)
 .D GETS^DIQ(664,I,".01;.5;8","","RM")
"RTN","RMPR9AUT",43,0)
 .Q:$G(RM(664,I_",",8))
"RTN","RMPR9AUT",44,0)
 .S RMCNT=RMCNT+1
"RTN","RMPR9AUT",45,0)
 .S RESULTS(RMCNT)=RM(664,I_",",.01)_U
"RTN","RMPR9AUT",46,0)
 .S RESULTS(RMCNT)=RESULTS(RMCNT)_$G(RM(664,I_",",.5))_U
"RTN","RMPR9AUT",47,0)
 Q
"RTN","RMPR9AUT",48,0)
 ;
"RTN","RMPR9AUT",49,0)
 ;List all Available Cost Center
"RTN","RMPR9AUT",50,0)
 ;RMFCP = Fund Control Point
"RTN","RMPR9AUT",51,0)
 ;RMPRSITE = pointer or IEN of file #669.9
"RTN","RMPR9AUT",52,0)
 ;RESULTS = array of all Cost Center available in a given FCP.
"RTN","RMPR9AUT",53,0)
D1(RMFCP,RMPRSITE) G D2
"RTN","RMPR9AUT",54,0)
END(RESULTS,RMFCP,RMPRSITE) ;broker entry point
"RTN","RMPR9AUT",55,0)
D2 ;
"RTN","RMPR9AUT",56,0)
 I $D(^RMPR(669.9,RMPRSITE,4)) S RMIFSITE=$P($G(^RMPR(669.9,RMPRSITE,4)),U,1)
"RTN","RMPR9AUT",57,0)
 I '$D(RMIFSITE) S RESULTS(0)="IFCAP Site is undefined in #669.9" Q
"RTN","RMPR9AUT",58,0)
 ;access IFCAP API to list available Cost center.
"RTN","RMPR9AUT",59,0)
 D B1^PRCH7PA4(RMFCP,RMIFSITE)
"RTN","RMPR9AUT",60,0)
 Q
"RTN","RMPR9AUT",61,0)
 ;
"RTN","RMPR9AUT",62,0)
 ;List all Available BOC
"RTN","RMPR9AUT",63,0)
 ;RMCC = Cost Center
"RTN","RMPR9AUT",64,0)
 ;RMPRSITE = pointer or IEN of file #669.9
"RTN","RMPR9AUT",65,0)
 ;RESULTS = array of all available BOC in a given Cost Center.
"RTN","RMPR9AUT",66,0)
E1(RMCC,RMPRSITE) G E2
"RTN","RMPR9AUT",67,0)
ENE(RESULTS,RMCC,RMPRSITE) ;broker entry point
"RTN","RMPR9AUT",68,0)
E2 ;
"RTN","RMPR9AUT",69,0)
 I $D(^RMPR(669.9,RMPRSITE,4)) S RMIFSITE=$P($G(^RMPR(669.9,RMPRSITE,4)),U,1)
"RTN","RMPR9AUT",70,0)
 I '$D(RMIFSITE) S RESULTS(0)="IFCAP Site is undefined in #669.9" Q
"RTN","RMPR9AUT",71,0)
 ;access IFCAP API to list available Budget Object Code.
"RTN","RMPR9AUT",72,0)
 D C1^PRCH7PA4(RMCC,RMIFSITE)
"RTN","RMPR9AUT",73,0)
 Q
"RTN","RMPR9AUT",74,0)
 ;
"RTN","RMPR9AUT",75,0)
 ;List all Available FCP
"RTN","RMPR9AUT",76,0)
 ;DUZ = user
"RTN","RMPR9AUT",77,0)
 ;RMPRSITE = pointer or IEN of file #669.9
"RTN","RMPR9AUT",78,0)
 ;RESULTS = array of all available FCP in a given station.
"RTN","RMPR9AUT",79,0)
F1(DUZ,RMPRSITE) G F2
"RTN","RMPR9AUT",80,0)
ENF(RESULTS,DUZ,RMPRSITE) ;broker entry point
"RTN","RMPR9AUT",81,0)
F2 ;
"RTN","RMPR9AUT",82,0)
 I $D(^RMPR(669.9,RMPRSITE,4)) S RMIFSITE=$P($G(^RMPR(669.9,RMPRSITE,4)),U,1)
"RTN","RMPR9AUT",83,0)
 I '$D(RMIFSITE) S RESULTS(0)="IFCAP Site is undefined in #669.9" Q
"RTN","RMPR9AUT",84,0)
 ;access IFCAP API to list available Fund control Point.
"RTN","RMPR9AUT",85,0)
 D D1^PRCH7PA4(DUZ,RMIFSITE)
"RTN","RMPR9AUT",86,0)
 Q
"RTN","RMPR9AUT",87,0)
 ;
"RTN","RMPR9AUT",88,0)
 ;Broker call to link suspense to 2319
"RTN","RMPR9AUT",89,0)
 ;RMPR64 = ien of file #664
"RTN","RMPR9AUT",90,0)
 ;RMPR68 = ien of file #668
"RTN","RMPR9AUT",91,0)
 ;RESULTS = success or failure message.
"RTN","RMPR9AUT",92,0)
G1(RMPR64,RMPR68) G G2
"RTN","RMPR9AUT",93,0)
ENG(RESULTS,RMPR64,RMPR68) ;broker entry point
"RTN","RMPR9AUT",94,0)
G2 ;
"RTN","RMPR9AUT",95,0)
 N RMAMIS,RMIDAT,RMIEN60,RMERCHK,RMAR
"RTN","RMPR9AUT",96,0)
 S RESULTS=""
"RTN","RMPR9AUT",97,0)
 ;do automatic linking to suspense.
"RTN","RMPR9AUT",98,0)
 ;loop all the item and get the pointer to 660.
"RTN","RMPR9AUT",99,0)
 F I=0:0 S I=$O(^RMPR(664,RMPR64,1,I)) Q:(I'>0)!(RESULTS'="")  D
"RTN","RMPR9AUT",100,0)
 .S RMIDAT=$G(^RMPR(664,RMPR64,1,I,0))
"RTN","RMPR9AUT",101,0)
 .S RMIEN60=$P(RMIDAT,U,13)
"RTN","RMPR9AUT",102,0)
 .Q:'$G(RMIEN60)
"RTN","RMPR9AUT",103,0)
 .S RMAMIS=""
"RTN","RMPR9AUT",104,0)
 .I $D(^RMPR(660,RMIEN60,"AMS")) S RMAMIS=$G(^RMPR(660,RMIEN60,"AMS"))
"RTN","RMPR9AUT",105,0)
 .Q:'$G(RMAMIS)
"RTN","RMPR9AUT",106,0)
 .S RMERCHK=0
"RTN","RMPR9AUT",107,0)
 .S RMERCHK=$$UP60^RMPRPCE1(RMIEN60,RMPR68,1)
"RTN","RMPR9AUT",108,0)
 .I $G(RMERCHK) S RESULTS="Error Linking to file #660" Q
"RTN","RMPR9AUT",109,0)
 .S RMERCHK=$$UP68^RMPRPCE1(RMIEN60,RMPR68,RMAMIS)
"RTN","RMPR9AUT",110,0)
 .I $G(RMERCHK) S RESULTS="Error Linking to file #668" Q
"RTN","RMPR9AUT",111,0)
 I RESULTS="" S RESULTS="PCE linking to suspense is complete"
"RTN","RMPR9AUT",112,0)
 Q
"RTN","RMPR9AUT",113,0)
 ;
"RTN","RMPR9AUT",114,0)
 ;Broker call to list vendor.
"RTN","RMPR9AUT",115,0)
 ;RMPR40 = ien of file #440
"RTN","RMPR9AUT",116,0)
 ;RESULTS = success or failure message.
"RTN","RMPR9AUT",117,0)
H1(RMPR40,RMPRSITE) G H2
"RTN","RMPR9AUT",118,0)
ENH(RESULTS,RMPR40,RMPRSITE) ;broker entry point
"RTN","RMPR9AUT",119,0)
H2 ;
"RTN","RMPR9AUT",120,0)
 I $D(^RMPR(669.9,RMPRSITE,4)) S RMIFSITE=$P($G(^RMPR(669.9,RMPRSITE,4)),U,1)
"RTN","RMPR9AUT",121,0)
 I '$D(RMIFSITE) S RESULTS(0)="IFCAP Site is undefined in #669.9" Q
"RTN","RMPR9AUT",122,0)
 ;call ifcap API for vendor listing.
"RTN","RMPR9AUT",123,0)
 D E1^PRCH7PA4(RMPR40)
"RTN","RMPR9AUT",124,0)
 Q
"RTN","RMPR9AUT",125,0)
 ;broker call to ask for electronic signature code
"RTN","RMPR9AUT",126,0)
 ;DUZ - user IEN
"RTN","RMPR9AUT",127,0)
 ;X - electronic code entered by user.
"RTN","RMPR9AUT",128,0)
 ;RESULTS - failure or success message.
"RTN","RMPR9AUT",129,0)
I1(DUZ,X) G I2
"RTN","RMPR9AUT",130,0)
ENI(RESULTS,DUZ,X) ;broker entry point
"RTN","RMPR9AUT",131,0)
I2 ;
"RTN","RMPR9AUT",132,0)
 N RMCODE
"RTN","RMPR9AUT",133,0)
 S RMCODE=$P($G(^VA(200,DUZ,20)),"^",4)
"RTN","RMPR9AUT",134,0)
 I RMCODE="" S RESULTS="You have no signature code on file." Q
"RTN","RMPR9AUT",135,0)
 ;W !,"Enter Electronic signature Code: "
"RTN","RMPR9AUT",136,0)
 ;X ^%ZOSF("EOFF") R X:60 X ^%ZOSF("EON")
"RTN","RMPR9AUT",137,0)
 ;I '$T S RESULTS="Failure" Q
"RTN","RMPR9AUT",138,0)
 I $E(X)="^" S RESULTS="User up arrowed out." Q
"RTN","RMPR9AUT",139,0)
 S X=$TR(X,"abcdefghijklmnopqrstuvwxyz","ABCDEFGHIJKLMNOPQRSTUVWXYZ")
"RTN","RMPR9AUT",140,0)
 I $$HASH(X)=RMCODE S RESULTS="Thank you." Q
"RTN","RMPR9AUT",141,0)
 S RESULTS="Sorry, but that's not your correct electronic signature code."
"RTN","RMPR9AUT",142,0)
 Q
"RTN","RMPR9AUT",143,0)
HASH(X) D HASH^XUSHSHP
"RTN","RMPR9AUT",144,0)
 Q X
"RTN","RMPR9AUT",145,0)
 ;END
"RTN","RMPR9CA")
0^11^B59700154
"RTN","RMPR9CA",1,0)
RMPR9CA ;OI-HINES/HNC -SUSPENSE RPC;12/27/2004
"RTN","RMPR9CA",2,0)
 ;;3.0;PROSTHETICS;**90**;Feb 09, 1996
"RTN","RMPR9CA",3,0)
A1 ;roll and scroll entry point
"RTN","RMPR9CA",4,0)
 G A2
"RTN","RMPR9CA",5,0)
EN(RESULTS,RMIE68,RMPRDUZ,RMSUSTAT,RMPR664,RMPRTXT) ;RPC entry point
"RTN","RMPR9CA",6,0)
A2 ;
"RTN","RMPR9CA",7,0)
 S RESULTS(0)=""
"RTN","RMPR9CA",8,0)
 K ^TMP($J)
"RTN","RMPR9CA",9,0)
 ;
"RTN","RMPR9CA",10,0)
CONT ;RMSUSTAT is status 1=complete or 0=incomplete or 2=pending (incomplete)
"RTN","RMPR9CA",11,0)
 ;
"RTN","RMPR9CA",12,0)
 S RMIE=0
"RTN","RMPR9CA",13,0)
 F  S RMIE=$O(^RMPR(664,RMPR664,1,RMIE)) Q:RMIE'>0  D
"RTN","RMPR9CA",14,0)
 .S RMIE60=$P(^RMPR(664,RMPR664,1,RMIE,0),U,13)
"RTN","RMPR9CA",15,0)
 .S ^TMP($J,RMIE60)=""
"RTN","RMPR9CA",16,0)
 .D FD,UPD
"RTN","RMPR9CA",17,0)
 I RMSUSTAT=1 D CNOTE,FD
"RTN","RMPR9CA",18,0)
 I RMSUSTAT=0 D INOTE,FD
"RTN","RMPR9CA",19,0)
 I RMSUSTAT=2 D ONOTE,FD
"RTN","RMPR9CA",20,0)
 ;set status
"RTN","RMPR9CA",21,0)
 Q
"RTN","RMPR9CA",22,0)
CNOTE ;(#12) COMPLETION NOTE
"RTN","RMPR9CA",23,0)
 ;set file 668
"RTN","RMPR9CA",24,0)
 ;^RMPR(668,D0,4,0)=^668.012^^
"RTN","RMPR9CA",25,0)
 ;if status is close, or 1
"RTN","RMPR9CA",26,0)
 ;RMPRTXT ;load into field #12
"RTN","RMPR9CA",27,0)
 ;^RMPR(668,D0,4,D1,0)
"RTN","RMPR9CA",28,0)
 ;
"RTN","RMPR9CA",29,0)
 I $P(^RMPR(668,RMIE68,0),U,10)="C" S RESULTS(0)="0^This Suspense has already been Closed!"
"RTN","RMPR9CA",30,0)
 S DA=RMIE68
"RTN","RMPR9CA",31,0)
 D NOW^%DTC S RMPREODT=%,GMRCAD=%
"RTN","RMPR9CA",32,0)
 S DIE="^RMPR(668,"
"RTN","RMPR9CA",33,0)
 S DR="5////^S X=RMPREODT;6////^S X=DUZ;14///^S X=""C""" D ^DIE
"RTN","RMPR9CA",34,0)
 N RMPRC
"RTN","RMPR9CA",35,0)
 S L="",LN=0
"RTN","RMPR9CA",36,0)
 F  S L=$O(RMPRTXT(L)) Q:L=""  D
"RTN","RMPR9CA",37,0)
 . I 'LN D  Q:RMPRC=""  ;strip leading space from 1st line, ignore blank line
"RTN","RMPR9CA",38,0)
 .. S RMPRC=$E($TR(RMPRTXT(L)," ","")) ;1st non space char
"RTN","RMPR9CA",39,0)
 .. S:RMPRC'="" RMPRTXT(L)=$E(RMPRTXT(L),$F(RMPRTXT(L),RMPRC)-1,$L(RMPRTXT(L))) ;extract from 1st non space char to end of line
"RTN","RMPR9CA",40,0)
 .. Q
"RTN","RMPR9CA",41,0)
 . S LN=LN+1,^RMPR(668,RMIE68,4,LN,0)=RMPRTXT(L)
"RTN","RMPR9CA",42,0)
 . Q
"RTN","RMPR9CA",43,0)
 S $P(^RMPR(668,RMIE68,4,0),"^",3)=LN
"RTN","RMPR9CA",44,0)
 K L,LN
"RTN","RMPR9CA",45,0)
 ;S DA=RMIE68,DIK="^RMPR(668," D IX1^DIK
"RTN","RMPR9CA",46,0)
 I '$P(^RMPR(668,DA,0),U,9) D
"RTN","RMPR9CA",47,0)
 .S DIE="^RMPR(668,"
"RTN","RMPR9CA",48,0)
 .S DR="7///^S X=""See Completion Note for Initial Action Taken."""
"RTN","RMPR9CA",49,0)
 .D ^DIE
"RTN","RMPR9CA",50,0)
 .S DR="10////^S X=RMPREODT;16////^S X=DUZ" D ^DIE
"RTN","RMPR9CA",51,0)
 K RMPREODT
"RTN","RMPR9CA",52,0)
 S GMRCO=$P(^RMPR(668,RMIE68,0),U,15)
"RTN","RMPR9CA",53,0)
 I GMRCO="" S RESULTS(0)="0^Completed Manual Suspense Action.  Suspense status has been updated to CLOSED." Q
"RTN","RMPR9CA",54,0)
 S RMPRCOM=0
"RTN","RMPR9CA",55,0)
 F  S RMPRCOM=$O(^RMPR(668,RMIE68,4,RMPRCOM)) Q:RMPRCOM=""  D
"RTN","RMPR9CA",56,0)
 .S GMRCOM(RMPRCOM)=^RMPR(668,RMIE68,4,RMPRCOM,0)
"RTN","RMPR9CA",57,0)
 I $G(GMRCOM)="" S GMRCOM="Not Noted"
"RTN","RMPR9CA",58,0)
 S GMRCSF="U"
"RTN","RMPR9CA",59,0)
 S GMRCA=10
"RTN","RMPR9CA",60,0)
 S GMRCALF="N"
"RTN","RMPR9CA",61,0)
 S GMRCATO=""
"RTN","RMPR9CA",62,0)
 S (GMRCORNP,GMRCDUZ)=DUZ
"RTN","RMPR9CA",63,0)
 S BDC=$$SFILE^GMRCGUIB(.GMRCO,.GMRCA,.GMRCSF,.GMRCORNP,.GMRCDUZ,.GMRCOM,.GMRCALF,.GMRCATO,.GMRCAD)
"RTN","RMPR9CA",64,0)
 I +BDC=1 S RESULTS(0)=1_"^"_$P(BDC,U,2)
"RTN","RMPR9CA",65,0)
 K GMRCO,GMRCA,GMRCSF,GMRCORNP,GMRCDUZ,GMRCOM,GMRCALF,GMRCATO,GMRCAD
"RTN","RMPR9CA",66,0)
 I RESULTS(0)="" S RESULTS(0)="0^Completed Suspense Action, and Posted note to CPRS Consult.  Suspense status has been updated to CLOSED."
"RTN","RMPR9CA",67,0)
 Q
"RTN","RMPR9CA",68,0)
ONOTE ;Other note
"RTN","RMPR9CA",69,0)
 ;set file 668
"RTN","RMPR9CA",70,0)
 ;^RMPR(668,D0,4,0)=^668.012^^
"RTN","RMPR9CA",71,0)
 ;if status is pending, and already initial action note or 0
"RTN","RMPR9CA",72,0)
 ;^RMPR(668,D0,1,D1,0)= (#.01) ACTION DATE [1D] 
"RTN","RMPR9CA",73,0)
 ;RMPRTXT ;load into field #11, #1
"RTN","RMPR9CA",74,0)
 ;^RMPR(668,D0,1,D1,1,0)=^668.111^^  
"RTN","RMPR9CA",75,0)
 ;
"RTN","RMPR9CA",76,0)
 S RMPRDA1=RMIE68,DA(1)=RMIE68,DA=RMIE68
"RTN","RMPR9CA",77,0)
 D NOW^%DTC S X=%,GMRCWHN=%
"RTN","RMPR9CA",78,0)
 S DIC="^RMPR(668,"_RMIE68_",1,"
"RTN","RMPR9CA",79,0)
 S DIC(0)="CQL"
"RTN","RMPR9CA",80,0)
 S DIC("P")="668.011DA"
"RTN","RMPR9CA",81,0)
 S DLAYGO=668
"RTN","RMPR9CA",82,0)
 D ^DIC
"RTN","RMPR9CA",83,0)
 I Y=-1 S RESULTS(0)="1^Error Modifying Record!" Q
"RTN","RMPR9CA",84,0)
 ;S DIE=DIC K DIC
"RTN","RMPR9CA",85,0)
 S (DA,RMPRDA2)=+Y
"RTN","RMPR9CA",86,0)
 ;S DR="1" D ^DIE
"RTN","RMPR9CA",87,0)
 K DIE,DR,Y
"RTN","RMPR9CA",88,0)
 ;S ^RMPR(668,RMIE68,1,0)="^668.011DA^1^1"
"RTN","RMPR9CA",89,0)
 N RMPRC
"RTN","RMPR9CA",90,0)
 S L="",LN=0
"RTN","RMPR9CA",91,0)
 F  S L=$O(RMPRTXT(L)) Q:L=""  D
"RTN","RMPR9CA",92,0)
 . I 'LN D  Q:RMPRC=""  ;strip leading space from 1st line, ignore blank  line
"RTN","RMPR9CA",93,0)
 .. S RMPRC=$E($TR(RMPRTXT(L)," ","")) ;1st non space char
"RTN","RMPR9CA",94,0)
 .. S:RMPRC'="" RMPRTXT(L)=$E(RMPRTXT(L),$F(RMPRTXT(L),RMPRC)-1,$L(RMPRTXT(L))) ;extract from 1st non space char to end of line
"RTN","RMPR9CA",95,0)
 .. Q
"RTN","RMPR9CA",96,0)
 . S LN=LN+1,^RMPR(668,RMIE68,1,RMPRDA2,1,LN,0)=RMPRTXT(L)
"RTN","RMPR9CA",97,0)
 . Q
"RTN","RMPR9CA",98,0)
 S $P(^RMPR(668,RMIE68,1,RMPRDA2,1,0),"^",3)=LN
"RTN","RMPR9CA",99,0)
 K L,LN
"RTN","RMPR9CA",100,0)
 S GMRCO=$P(^RMPR(668,RMIE68,0),U,15)
"RTN","RMPR9CA",101,0)
 I GMRCO="" S RESULTS(0)="0^Completed Manual Suspense Action.  Suspense status has not changed." Q
"RTN","RMPR9CA",102,0)
 S RMPRCOM=0
"RTN","RMPR9CA",103,0)
 F  S RMPRCOM=$O(^RMPR(668,RMIE68,1,RMPRDA2,1,RMPRCOM)) Q:RMPRCOM=""  D
"RTN","RMPR9CA",104,0)
 .S GMRCOM(RMPRCOM)=^RMPR(668,RMIE68,1,RMPRDA2,1,RMPRCOM,0)
"RTN","RMPR9CA",105,0)
 D CMT^GMRCGUIB(.GMRCO,.GMRCOM,"",GMRCWHN,DUZ)
"RTN","RMPR9CA",106,0)
 K DA,RMPRDA1,RMPRDA2,RMPRCOM,GMRCOM,GMRCO,GMRCWHN
"RTN","RMPR9CA",107,0)
 S RESULTS(0)="0^Completed Suspense Action, and Posted note to CPRS Consult.  Suspense status has not changed."
"RTN","RMPR9CA",108,0)
 Q
"RTN","RMPR9CA",109,0)
INOTE ;initial action note
"RTN","RMPR9CA",110,0)
 ;set file 668
"RTN","RMPR9CA",111,0)
 ;^RMPR(668,D0,3,0)=^668.07^^
"RTN","RMPR9CA",112,0)
 ;if status is pending, or 0
"RTN","RMPR9CA",113,0)
 ;RMPRTXT ;load into field #7
"RTN","RMPR9CA",114,0)
 ;^RMPR(668,D0,3,0)=^668.07^^
"RTN","RMPR9CA",115,0)
 ;
"RTN","RMPR9CA",116,0)
 I $D(^RMPR(668,RMIE68,3,1,0)) S RESULTS(0)="1^Initial Action Note Already Posted!" Q
"RTN","RMPR9CA",117,0)
 D NOW^%DTC S RMPREODT=%
"RTN","RMPR9CA",118,0)
 N RMPRC
"RTN","RMPR9CA",119,0)
 S ^RMPR(668,RMIE68,3,0)="^^^"_DT_"^"
"RTN","RMPR9CA",120,0)
 S L="",LN=0
"RTN","RMPR9CA",121,0)
 F  S L=$O(RMPRTXT(L)) Q:L=""  D
"RTN","RMPR9CA",122,0)
 . I 'LN D  Q:RMPRC=""  ;strip leading space from 1st line, ignore blank  line
"RTN","RMPR9CA",123,0)
 .. S RMPRC=$E($TR(RMPRTXT(L)," ","")) ;1st non space char
"RTN","RMPR9CA",124,0)
 .. S:RMPRC'="" RMPRTXT(L)=$E(RMPRTXT(L),$F(RMPRTXT(L),RMPRC)-1,$L(RMPRTXT(L))) ;extract from 1st non space char to end of line
"RTN","RMPR9CA",125,0)
 .. Q
"RTN","RMPR9CA",126,0)
 . S LN=LN+1,^RMPR(668,RMIE68,3,LN,0)=RMPRTXT(L)
"RTN","RMPR9CA",127,0)
 . Q
"RTN","RMPR9CA",128,0)
 S $P(^RMPR(668,RMIE68,3,0),"^",3)=LN
"RTN","RMPR9CA",129,0)
 K L,LN
"RTN","RMPR9CA",130,0)
 S DIE="^RMPR(668,"
"RTN","RMPR9CA",131,0)
 S DA=RMIE68
"RTN","RMPR9CA",132,0)
 S DR="10////^S X=RMPREODT;16////^S X=DUZ;14///^S X=""P"""
"RTN","RMPR9CA",133,0)
 D ^DIE
"RTN","RMPR9CA",134,0)
 S GMRCO=$P(^RMPR(668,RMIE68,0),U,15)
"RTN","RMPR9CA",135,0)
 I GMRCO="" S RESULTS(0)="0^Completed Manual Suspense Action.  Suspense status has been updated to PENDING" Q
"RTN","RMPR9CA",136,0)
 S RMPRCMT=0
"RTN","RMPR9CA",137,0)
 F  S RMPRCMT=$O(^RMPR(668,RMIE68,3,RMPRCMT)) Q:RMPRCMT=""  D
"RTN","RMPR9CA",138,0)
 .S GMRCMT(RMPRCMT)=^RMPR(668,RMIE68,3,RMPRCMT,0)
"RTN","RMPR9CA",139,0)
 S RMGMRCO=$$RC^GMRCGUIA(.GMRCO,DUZ,RMPREODT,.GMRCMT,DUZ)
"RTN","RMPR9CA",140,0)
 K RMPREODT,GMRCO,RMGMRCO,GMRCMT,RMPRCMT
"RTN","RMPR9CA",141,0)
 S RESULTS(0)="0^Completed Suspense Action, and Posted note to CPRS Consult.  Suspense status has changed to PENDING."
"RTN","RMPR9CA",142,0)
 Q
"RTN","RMPR9CA",143,0)
 ;
"RTN","RMPR9CA",144,0)
FD ;file date
"RTN","RMPR9CA",145,0)
 N DIE,DIC,I,J,Y,RMDFN,RMI,RMDATE,RM680,RM6810,RMERROR,RM60L,RC
"RTN","RMPR9CA",146,0)
 N RMERR,RMCHK,DLAYGO,X,DR,RM668,RM60DAT,RMSTATUS
"RTN","RMPR9CA",147,0)
 N RM68CNT,RM60CNT,RMSI,RMSAMIS,RM68IEN,RM60IEN,RMSUS60,RMSUS68,RMD
"RTN","RMPR9CA",148,0)
 N RM68DATA,RM60TYP,RM68D,RM68TRAN,RMPRPRC,RM60IT,RMENTSUS,RMQUIT
"RTN","RMPR9CA",149,0)
 ;
"RTN","RMPR9CA",150,0)
 S RMERR=0
"RTN","RMPR9CA",151,0)
 S:RMSUSTAT="" RMSUSTAT=0
"RTN","RMPR9CA",152,0)
 L +^RMPR(660,RMIE60):2
"RTN","RMPR9CA",153,0)
 I $T=0 S RESULTS(0)="1^Someone else is Editing this entry!" G EXIT
"RTN","RMPR9CA",154,0)
 S RM680=$G(^RMPR(668,RMIE68,0))
"RTN","RMPR9CA",155,0)
 S RM688=$G(^RMPR(668,RMIE68,8))
"RTN","RMPR9CA",156,0)
 S RM6810=$G(^RMPR(668,RMIE68,10))
"RTN","RMPR9CA",157,0)
 S RMAMIS=$P($G(^RMPR(660,RMIE60,"AMS")),U,1)
"RTN","RMPR9CA",158,0)
 ;code here for 668 fields
"RTN","RMPR9CA",159,0)
 S RMDATE=$P(RM680,U,1)
"RTN","RMPR9CA",160,0)
 S RMCODT=$P(RM680,U,5)
"RTN","RMPR9CA",161,0)
 S RMINDT=$P(RM680,U,9)
"RTN","RMPR9CA",162,0)
 S RMPRCO=$P(RM680,U,15)
"RTN","RMPR9CA",163,0)
 S RMDWRT=$P(RM680,U,16)
"RTN","RMPR9CA",164,0)
 S RMSTAT=$P(RM680,U,7)
"RTN","RMPR9CA",165,0)
 S RMTRES=$P(RM680,U,8)
"RTN","RMPR9CA",166,0)
 S RMTYRE=$S(RMTRES=1:"ROUTINE",RMTRES=2:"EYEGLASS",RMTRES=3:"CONTACT LENS",RMTRES=4:"OXYGEN",RMTRES=5:"MANUAL",1:"")
"RTN","RMPR9CA",167,0)
 S RMREQU=$P(RM680,U,11)
"RTN","RMPR9CA",168,0)
 S RMSERV=""
"RTN","RMPR9CA",169,0)
 I $G(RMREQU) D GETS^DIQ(200,RMREQU,"29","E","RMAA") S RMSERV=RMAA(200,RMREQU_",",29,"E")
"RTN","RMPR9CA",170,0)
 S RMPRDI=$E($P(RM688,U,2),1,16)
"RTN","RMPR9CA",171,0)
 S RMICD9=$P(RM688,U,3)
"RTN","RMPR9CA",172,0)
 ;
"RTN","RMPR9CA",173,0)
 S RMDAT(660,RMIE60_",",8.1)=RMDATE
"RTN","RMPR9CA",174,0)
 S RMDAT(660,RMIE60_",",8.2)=RMDWRT
"RTN","RMPR9CA",175,0)
 S RMDAT(660,RMIE60_",",8.3)=RMINDT
"RTN","RMPR9CA",176,0)
 S RMDAT(660,RMIE60_",",8.4)=RMCODT
"RTN","RMPR9CA",177,0)
 S RMDAT(660,RMIE60_",",8.5)=RMTYRE
"RTN","RMPR9CA",178,0)
 S RMDAT(660,RMIE60_",",8.6)=RMREQU
"RTN","RMPR9CA",179,0)
 S RMDAT(660,RMIE60_",",8.61)=RMSERV
"RTN","RMPR9CA",180,0)
 S RMDAT(660,RMIE60_",",8.7)=RMPRDI
"RTN","RMPR9CA",181,0)
 S RMDAT(660,RMIE60_",",8.8)=RMICD9
"RTN","RMPR9CA",182,0)
 S RMDAT(660,RMIE60_",",8.9)=RMPRCO
"RTN","RMPR9CA",183,0)
 S RMDAT(660,RMIE60_",",8.11)=RMSTAT
"RTN","RMPR9CA",184,0)
 I RMSUSTAT=2 S RMDAT(660,RMIE60_",",8.14)=0
"RTN","RMPR9CA",185,0)
 I RMSUSTAT'=2 S RMDAT(660,RMIE60_",",8.14)=RMSUSTAT
"RTN","RMPR9CA",186,0)
 D FILE^DIE("","RMDAT","RMERROR")
"RTN","RMPR9CA",187,0)
 I $D(RMERROR) S RMERR=1 D ERR
"RTN","RMPR9CA",188,0)
 ;
"RTN","RMPR9CA",189,0)
 L -^RMPR(660,RMIE60)
"RTN","RMPR9CA",190,0)
 Q
"RTN","RMPR9CA",191,0)
UPD ;update file 668 with 2319 records
"RTN","RMPR9CA",192,0)
 S DA(1)=RMIE68
"RTN","RMPR9CA",193,0)
 S DIC="^RMPR(668,"_DA(1)_","_"10,"
"RTN","RMPR9CA",194,0)
 S DIC(0)="L",DLAYGO=668,X=RMIE60
"RTN","RMPR9CA",195,0)
 D FILE^DICN
"RTN","RMPR9CA",196,0)
 S DA(1)=RMIE68
"RTN","RMPR9CA",197,0)
 S DIC="^RMPR(668,"_DA(1)_","_"11,"
"RTN","RMPR9CA",198,0)
 S X=RMAMIS
"RTN","RMPR9CA",199,0)
 D FILE^DICN
"RTN","RMPR9CA",200,0)
 K DIC,X,DLAYGO
"RTN","RMPR9CA",201,0)
 Q
"RTN","RMPR9CA",202,0)
A3 G A4
"RTN","RMPR9CA",203,0)
EN1(RESULTS,DA) ;Broker entry to kill PO
"RTN","RMPR9CA",204,0)
 ;DA is passed
"RTN","RMPR9CA",205,0)
 S DIK="^RMPR(664," D ^DIK
"RTN","RMPR9CA",206,0)
 K DIK
"RTN","RMPR9CA",207,0)
A4 ;
"RTN","RMPR9CA",208,0)
 Q
"RTN","RMPR9CA",209,0)
ERR ;exit on error
"RTN","RMPR9CA",210,0)
EXIT ;
"RTN","RMPR9CA",211,0)
 K RMTYRE,RMTRES,RMSUSTAT,RMSTAT,RMSERV,RMEQU,RMPRTST,RMPRDUZ,RMPRDI,RMPRCO,RMPR664,RMIE68
"RTN","RMPR9CA",212,0)
 K RMIE60,RMIE,RMICD9,RMDWRT,RMDAT,RMCODT,RMAMIS,RMAA,RM688,RMPRTXT
"RTN","RMPR9CA",213,0)
 K BDC,BAD,%,RMINDT,RMPREQU
"RTN","RMPR9DO")
0^24^B87076103
"RTN","RMPR9DO",1,0)
RMPR9DO ;HOIFO/HNC -  ORDER CONROL PROCESSING-REMOTE PROCEDURE ;9/8/03  07:12
"RTN","RMPR9DO",2,0)
 ;;3.0;PROSTHETICS;**59,77,90**;Feb 09, 1996
"RTN","RMPR9DO",3,0)
 ;
"RTN","RMPR9DO",4,0)
 ;8/5/03 Make sure no dups, HNC patch 77
"RTN","RMPR9DO",5,0)
 ;
"RTN","RMPR9DO",6,0)
A1(START,STOP,SITE,SORT,DATE,WHAT) ;entry point for rollup
"RTN","RMPR9DO",7,0)
 ;activated from (option name)
"RTN","RMPR9DO",8,0)
 I WHAT="S" D
"RTN","RMPR9DO",9,0)
 .S STN1=0
"RTN","RMPR9DO",10,0)
 .F  S STN1=$O(^RMPR(669.9,STN1)) Q:STN1'>0  D
"RTN","RMPR9DO",11,0)
 . .S SITE=STN1
"RTN","RMPR9DO",12,0)
 . .D A2
"RTN","RMPR9DO",13,0)
 I WHAT="ALL" G A2
"RTN","RMPR9DO",14,0)
 Q
"RTN","RMPR9DO",15,0)
EN(RESULT,DUZ,START,STOP,SITE,SORT,DATE,RMPRPRSN) ; -- Broker callback to get list to display
"RTN","RMPR9DO",16,0)
 ;entry to send to PCM, WHAT=ALL or S for Summary Only
"RTN","RMPR9DO",17,0)
 ;RMPRPRSN=P for Purchasing D for Delayed Order Report
"RTN","RMPR9DO",18,0)
 S (WHO,RMPRSC)=""
"RTN","RMPR9DO",19,0)
 I RMPRPRSN="P" S RMPRSC=$O(^RMPR(669.9,"PA",DUZ,RMPRSC)) Q:(RMPRSC="")!(WHO'="")  D
"RTN","RMPR9DO",20,0)
 . I '$D(^RMPR(669.9,RMPRSC,0)) Q
"RTN","RMPR9DO",21,0)
 . I '$D(^RMPR(669.9,RMPRSC,5,"B",DUZ)) Q
"RTN","RMPR9DO",22,0)
 . S WHO=$O(^RMPR(669.9,RMPRSC,5,"B",DUZ,""))
"RTN","RMPR9DO",23,0)
 . I START="" S START=$P(^RMPR(669.9,RMPRSC,5,WHO,0),U,2)
"RTN","RMPR9DO",24,0)
 . I STOP="" S STOP=$P(^RMPR(669.9,RMPRSC,5,WHO,0),U,3)
"RTN","RMPR9DO",25,0)
A2 N STRING,CLREND,COLUMN,ON,OFF
"RTN","RMPR9DO",26,0)
 Q:SORT=""
"RTN","RMPR9DO",27,0)
 Q:DATE=""
"RTN","RMPR9DO",28,0)
 Q:START=""
"RTN","RMPR9DO",29,0)
 Q:STOP=""
"RTN","RMPR9DO",30,0)
 Q:SITE=""
"RTN","RMPR9DO",31,0)
 I SITE'="ALL" S SITE=$P(^RMPR(669.9,SITE,0),U,2)
"RTN","RMPR9DO",32,0)
 K ^TMP($J)
"RTN","RMPR9DO",33,0)
 N RMPRA,CDATE,X
"RTN","RMPR9DO",34,0)
 K ADATE,PDAY,RMPRCD
"RTN","RMPR9DO",35,0)
 S VALMCNT=0,RRX=""
"RTN","RMPR9DO",36,0)
 ;if sort for open or pending include all regardless of date
"RTN","RMPR9DO",37,0)
 ;if sort for cancelled or closed include from date passed forward
"RTN","RMPR9DO",38,0)
 ;
"RTN","RMPR9DO",39,0)
 ;PPD# status=pending before date, total days create to 1st action
"RTN","RMPR9DO",40,0)
 ;MHD# manual totals days create to 1st action
"RTN","RMPR9DO",41,0)
 ;CHD# consult totals days create to 1st action
"RTN","RMPR9DO",42,0)
 ;PPDD# status=pending before date, total days in pending state, 1st
"RTN","RMPR9DO",43,0)
 ;      action to current date
"RTN","RMPR9DO",44,0)
 ;
"RTN","RMPR9DO",45,0)
 S (LINE,MHD1,MHD2,MHD3,MHD4,MHD5,CHD1,CHD2,CHD3,CHD4,CHD5,CLNK,MLNK)=0
"RTN","RMPR9DO",46,0)
 S (PPDAY,PPD,PPD1,PPD2,PPD3,PPD4,PPD5)=0
"RTN","RMPR9DO",47,0)
 S (PPDDAY,PPDD1,PPDD2,PPDD3,PPDD4,PPDD5)=0
"RTN","RMPR9DO",48,0)
 I SORT["O"!(SORT["P") D ALL
"RTN","RMPR9DO",49,0)
 I SORT["C"!(SORT["X") D DTFWD
"RTN","RMPR9DO",50,0)
 ;S LINE=LINE+1
"RTN","RMPR9DO",51,0)
 S ^TMP($J,"A1")="^^^^^^^^"_MHD1_U_MHD2_U_MHD3_U_MHD4_U_MHD5_"^^^^"_MLNK_U_0
"RTN","RMPR9DO",52,0)
 I $G(WHAT)="S" S RMPRXM(1)=MHD1_U_MHD2_U_MHD3_U_MHD4_U_MHD5_U_MLNK_U_0
"RTN","RMPR9DO",53,0)
 ;S LINE=LINE+1
"RTN","RMPR9DO",54,0)
 S ^TMP($J,"A2")="^^^^^^^^"_CHD1_U_CHD2_U_CHD3_U_CHD4_U_CHD5_"^^^^"_CLNK_U_1
"RTN","RMPR9DO",55,0)
 I $G(WHAT)="S" S RMPRXM(2)=CHD1_U_CHD2_U_CHD3_U_CHD4_U_CHD5_U_CLNK_U_1
"RTN","RMPR9DO",56,0)
 ;S LINE=LINE+1
"RTN","RMPR9DO",57,0)
 I $G(WHAT)="S" S RMPRXM(3)=PPD1_U_PPD2_U_PPD3_U_PPD4_U_PPD5_U_U_2
"RTN","RMPR9DO",58,0)
 S ^TMP($J,"A3")="^^^^^^^^"_PPDD1_U_PPDD2_U_PPDD3_U_PPDD4_U_PPDD5_"^^^^^"_2
"RTN","RMPR9DO",59,0)
 ;S LINE=LINE+1
"RTN","RMPR9DO",60,0)
 S ^TMP($J,"A4")="^^^^^^^^"_PPD1_U_PPD2_U_PPD3_U_PPD4_U_PPD5_"^^^^^"_3
"RTN","RMPR9DO",61,0)
 ;quarter rollup with full data
"RTN","RMPR9DO",62,0)
 I $G(WHAT)="Q" D MAIL
"RTN","RMPR9DO",63,0)
 ;summary only
"RTN","RMPR9DO",64,0)
 I $G(WHAT)="S" D MAILG
"RTN","RMPR9DO",65,0)
 I $G(WHAT)="ALL" D MAILG,MAIL
"RTN","RMPR9DO",66,0)
 I '$G(WHAT) G EXIT
"RTN","RMPR9DO",67,0)
 Q
"RTN","RMPR9DO",68,0)
ALL ;all open pending records regardless of date passed
"RTN","RMPR9DO",69,0)
 S RMPRI1=0
"RTN","RMPR9DO",70,0)
 F RMPRI1=START:1:STOP D
"RTN","RMPR9DO",71,0)
 .I $L(RMPRI1)=1 S RMPRI=0_RMPRI1
"RTN","RMPR9DO",72,0)
 .E  S RMPRI=RMPRI1
"RTN","RMPR9DO",73,0)
 .S RMPRST=""
"RTN","RMPR9DO",74,0)
 .F  S RMPRST=$O(^RMPR(668,"L1",RMPRI,RMPRST)) Q:RMPRST=""  D
"RTN","RMPR9DO",75,0)
 . .Q:RMPRST="X"
"RTN","RMPR9DO",76,0)
 . .Q:RMPRST="C"
"RTN","RMPR9DO",77,0)
 . .I SORT'["P"&(RMPRST="P") Q
"RTN","RMPR9DO",78,0)
 . .S RMPRA=0
"RTN","RMPR9DO",79,0)
 . .F  S RMPRA=$O(^RMPR(668,"L1",RMPRI,RMPRST,RMPRA)) Q:RMPRA'>0  D
"RTN","RMPR9DO",80,0)
 . . .S STN=$P(^RMPR(668,RMPRA,0),U,7)
"RTN","RMPR9DO",81,0)
 . . .I SITE'="ALL"&(SITE'=STN) Q
"RTN","RMPR9DO",82,0)
 . . .S STNX=$$STATN^RMPRUTIL(STN)
"RTN","RMPR9DO",83,0)
 . . .I $G(WHAT)="S" S VISNX=$P($G(^RMPR(669.9,STN1,"INV")),U,2)
"RTN","RMPR9DO",84,0)
 . . .S STS=$P(^RMPR(668,RMPRA,0),U,10)
"RTN","RMPR9DO",85,0)
 . . .Q:STS["X"
"RTN","RMPR9DO",86,0)
 . . .Q:STS["C"
"RTN","RMPR9DO",87,0)
 . . .I SORT'["O"&(STS="O") Q
"RTN","RMPR9DO",88,0)
 . . .I SORT'["P"&(STS="P") Q
"RTN","RMPR9DO",89,0)
 . . .D REC
"RTN","RMPR9DO",90,0)
 Q
"RTN","RMPR9DO",91,0)
DTFWD ;from date passed forward
"RTN","RMPR9DO",92,0)
 S RMPRI1=0
"RTN","RMPR9DO",93,0)
 F RMPRI1=START:1:STOP D
"RTN","RMPR9DO",94,0)
 .I $L(RMPRI1)=1 S RMPRI=0_RMPRI1
"RTN","RMPR9DO",95,0)
 .E  S RMPRI=RMPRI1
"RTN","RMPR9DO",96,0)
 .S RMPRDTM=""
"RTN","RMPR9DO",97,0)
 .F  S RMPRDTM=$O(^RMPR(668,"L",RMPRI,RMPRDTM)) Q:RMPRDTM=""  D
"RTN","RMPR9DO",98,0)
 ..Q:RMPRDTM=""
"RTN","RMPR9DO",99,0)
 ..Q:RMPRDTM<DATE
"RTN","RMPR9DO",100,0)
 ..S RMPRST=""
"RTN","RMPR9DO",101,0)
 ..F  S RMPRST=$O(^RMPR(668,"L",RMPRI,RMPRDTM,RMPRST)) Q:RMPRST=""  D
"RTN","RMPR9DO",102,0)
 .. .Q:RMPRST="O"
"RTN","RMPR9DO",103,0)
 .. .Q:RMPRST="P"
"RTN","RMPR9DO",104,0)
 .. .I SORT'["X"&(RMPRST="X") Q
"RTN","RMPR9DO",105,0)
 .. .I SORT'["C"&(RMPRST="C") Q
"RTN","RMPR9DO",106,0)
 .. .S RMPRA=0
"RTN","RMPR9DO",107,0)
 .. .F  S RMPRA=$O(^RMPR(668,"L",RMPRI,RMPRDTM,RMPRST,RMPRA)) Q:RMPRA'>0  D
"RTN","RMPR9DO",108,0)
 .. . .Q:RMPRA=""
"RTN","RMPR9DO",109,0)
 .. . .S STN=$P(^RMPR(668,RMPRA,0),U,7)
"RTN","RMPR9DO",110,0)
 .. . .I SITE'="ALL"&(SITE'=STN) Q
"RTN","RMPR9DO",111,0)
 .. . .S STNX=$$STATN^RMPRUTIL(STN)
"RTN","RMPR9DO",112,0)
 .. . .I $G(WHAT)'="" S VISNX=$P($G(^RMPR(669.9,SITE,"INV")),U,2)
"RTN","RMPR9DO",113,0)
 .. . .S STS=$P(^RMPR(668,RMPRA,0),U,10)
"RTN","RMPR9DO",114,0)
 .. . .Q:STS["O"
"RTN","RMPR9DO",115,0)
 .. . .Q:STS["P"
"RTN","RMPR9DO",116,0)
 .. . .I SORT'["C"&(STS="C") Q
"RTN","RMPR9DO",117,0)
 .. . .I SORT'["X"&(STS="X") Q
"RTN","RMPR9DO",118,0)
 .. . .D REC
"RTN","RMPR9DO",119,0)
 S RMPRDTC=$P(DATE,".",1)
"RTN","RMPR9DO",120,0)
 F  S RMPRDTC=$O(^RMPR(668,"CD",RMPRDTC)) Q:RMPRDTC=""  D
"RTN","RMPR9DO",121,0)
 .Q:RMPRDTC<DATE
"RTN","RMPR9DO",122,0)
 .S RMPRDYS=0
"RTN","RMPR9DO",123,0)
 .F  S RMPRDYS=$O(^RMPR(668,"CD",RMPRDTC,RMPRDYS)) Q:RMPRDYS=""  D
"RTN","RMPR9DO",124,0)
 . .Q:RMPRDYS'>5
"RTN","RMPR9DO",125,0)
 . .S RMPRA=0
"RTN","RMPR9DO",126,0)
 . .F  S RMPRA=$O(^RMPR(668,"CD",RMPRDTC,RMPRDYS,RMPRA)) Q:RMPRA'>0  D
"RTN","RMPR9DO",127,0)
 . . .;check site
"RTN","RMPR9DO",128,0)
 . . .S STN=$P(^RMPR(668,RMPRA,0),U,7)
"RTN","RMPR9DO",129,0)
 . . .I SITE'="ALL"&(SITE'=STN) Q
"RTN","RMPR9DO",130,0)
 . . .S STNX=$$STATN^RMPRUTIL(STN)
"RTN","RMPR9DO",131,0)
 . . .;check status
"RTN","RMPR9DO",132,0)
 . . .S STS=$P(^RMPR(668,RMPRA,0),U,10)
"RTN","RMPR9DO",133,0)
 . . .I SORT'["O"&(STS="O") Q
"RTN","RMPR9DO",134,0)
 . . .I SORT'["P"&(STS="P") Q
"RTN","RMPR9DO",135,0)
 . . .I SORT'["C"&(STS="C") Q
"RTN","RMPR9DO",136,0)
 . . .I SORT'["X"&(STS="X") Q
"RTN","RMPR9DO",137,0)
 . . .;ssn range filter
"RTN","RMPR9DO",138,0)
 . . .S DFN=$P(^RMPR(668,RMPRA,0),U,2)
"RTN","RMPR9DO",139,0)
 . . .D DEM^VADPT
"RTN","RMPR9DO",140,0)
 . . .S SSNEN=$E($P(VADM(2),"^",2),10,11)
"RTN","RMPR9DO",141,0)
 . . .I SSNEN>STOP Q
"RTN","RMPR9DO",142,0)
 . . .I SSNEN<START Q
"RTN","RMPR9DO",143,0)
 . . .K SSNEN,VADM
"RTN","RMPR9DO",144,0)
 . . .D REC
"RTN","RMPR9DO",145,0)
 Q
"RTN","RMPR9DO",146,0)
REC ;records to grid
"RTN","RMPR9DO",147,0)
 ;stop date, init action date
"RTN","RMPR9DO",148,0)
 ;check ien, patch 77
"RTN","RMPR9DO",149,0)
 ;
"RTN","RMPR9DO",150,0)
 Q:$D(^TMP($J,RMPRA))
"RTN","RMPR9DO",151,0)
 ;
"RTN","RMPR9DO",152,0)
 N DIC,DIQ,DR,STOPDT
"RTN","RMPR9DO",153,0)
 S DA=RMPRA
"RTN","RMPR9DO",154,0)
 S DIC=668,DIQ="RE",DR=10,DIQ(0)="EN" D EN^DIQ1
"RTN","RMPR9DO",155,0)
 S STOPDT=$P($G(^RMPR(668,RMPRA,0)),U,9),STOPDT=$$DAT2^RMPRUTL1(STOPDT)
"RTN","RMPR9DO",156,0)
 S LINE=LINE+1
"RTN","RMPR9DO",157,0)
 S CDATE=$P(^RMPR(668,RMPRA,0),U,1),CDATE=$$DAT2^RMPRUTL1(CDATE)
"RTN","RMPR9DO",158,0)
 S DFN=$P(^RMPR(668,RMPRA,0),U,2) Q:DFN=""
"RTN","RMPR9DO",159,0)
 N VA,VADM
"RTN","RMPR9DO",160,0)
 D DEM^VADPT
"RTN","RMPR9DO",161,0)
 S WHO=VADM(1)
"RTN","RMPR9DO",162,0)
 S SSN=VADM(2)
"RTN","RMPR9DO",163,0)
 D KVAR^VADPT
"RTN","RMPR9DO",164,0)
 ;type
"RTN","RMPR9DO",165,0)
 S TYPE=$$TYPE^RMPREOU(RMPRA,8)
"RTN","RMPR9DO",166,0)
 ;display description if manual
"RTN","RMPR9DO",167,0)
 S DES=$$DES^RMPREOU(RMPRA,22)
"RTN","RMPR9DO",168,0)
 S DES=$TR(DES,"^","*")
"RTN","RMPR9DO",169,0)
 S DES=$TR(DES,"""","'")
"RTN","RMPR9DO",170,0)
 ;init action date
"RTN","RMPR9DO",171,0)
 S ADATE="",PDAY="",WRKDAY=""
"RTN","RMPR9DO",172,0)
 S ADATE=$P(^RMPR(668,RMPRA,0),U,9)
"RTN","RMPR9DO",173,0)
 ;PPD=1 for previous pending
"RTN","RMPR9DO",174,0)
 I ADATE'="" S (PDAY,WRKDAY)=$$WRKDAY^RMPREOU(RMPRA)
"RTN","RMPR9DO",175,0)
 I ADATE="" S (PDAY,WRKDAY)=$$CWRKDAY^RMPREOU(RMPRA)
"RTN","RMPR9DO",176,0)
 I ADATE'="" S CDAY=$$PDAY^RMPREOU(RMPRA)
"RTN","RMPR9DO",177,0)
 ;
"RTN","RMPR9DO",178,0)
 S STATUS=$$STATUS^RMPREOU(RMPRA)
"RTN","RMPR9DO",179,0)
 I STATUS["PENDING" D
"RTN","RMPR9DO",180,0)
 .I ADATE'=""&(ADATE<DATE) S PPD=1
"RTN","RMPR9DO",181,0)
 .S PPDAY=$$PWRKDAY^RMPREOU(RMPRA)
"RTN","RMPR9DO",182,0)
 S LINKED=$P($G(^RMPR(668,RMPRA,10,0)),U,4)
"RTN","RMPR9DO",183,0)
 I LINKED="" S LINKED=0
"RTN","RMPR9DO",184,0)
 ;
"RTN","RMPR9DO",185,0)
 S ^TMP($J,RMPRA)=CDATE_U_WHO_U_SSN_U_TYPE_U_DES_U
"RTN","RMPR9DO",186,0)
 ;look at pday and parse
"RTN","RMPR9DO",187,0)
 S (HD1,HD2,HD3,HD4,HD5,DH6)=""
"RTN","RMPR9DO",188,0)
 ;SD Working Days in Pending Status
"RTN","RMPR9DO",189,0)
 S (SD1,SD2,SD3,SD4,SD5)=0
"RTN","RMPR9DO",190,0)
 I (PDAY>0)&(PDAY<6)!(PDAY=0) S HD1=PDAY,DH6="NO"
"RTN","RMPR9DO",191,0)
 I (PPDAY>0)&(PPDAY<6)!(PPDAY=0) S SD1=PPDAY
"RTN","RMPR9DO",192,0)
 I (PDAY>0)&(PDAY<6)&(TYPE["MANUAL")!(PDAY=0)&(TYPE["MANUAL") S MHD1=MHD1+1
"RTN","RMPR9DO",193,0)
 I (PDAY>0)&(PDAY<6)&(TYPE'["MANUAL")!(PDAY=0)&(TYPE'["MANUAL") S CHD1=CHD1+1
"RTN","RMPR9DO",194,0)
 I (PPDAY>0)&(PPDAY<6)&(STATUS["PENDING") S PPDD1=PPDD1+1
"RTN","RMPR9DO",195,0)
 I (PDAY>0)&(PDAY<6)&(PPD=1) S PPD1=PPD1+1
"RTN","RMPR9DO",196,0)
 I HD1=""  S HD1=0
"RTN","RMPR9DO",197,0)
 I (PDAY>5)&(PDAY<10) S HD2=PDAY,DH6="YES"
"RTN","RMPR9DO",198,0)
 I (PPDAY>5)&(PPDAY<10) S SD2=PPDAY
"RTN","RMPR9DO",199,0)
 I (PDAY>5)&(PDAY<10)&(TYPE["MANUAL") S MHD2=MHD2+1
"RTN","RMPR9DO",200,0)
 I (PDAY>5)&(PDAY<10)&(TYPE'["MANUAL") S CHD2=CHD2+1
"RTN","RMPR9DO",201,0)
 I (PPDAY>5)&(PPDAY<10)&(STATUS["PENDING") S PPDD2=PPDD2+1
"RTN","RMPR9DO",202,0)
 I (PDAY>5)&(PDAY<10)&(PPD=1) S PPD2=PPD2+1
"RTN","RMPR9DO",203,0)
 I HD2="" S HD2=0
"RTN","RMPR9DO",204,0)
 I (PDAY>9)&(PDAY<30) S HD3=PDAY,DH6="YES"
"RTN","RMPR9DO",205,0)
 I (PPDAY>9)&(PPDAY<30) S SD3=PPDAY
"RTN","RMPR9DO",206,0)
 I (PDAY>9)&(PDAY<30)&(TYPE["MANUAL") S MHD3=MHD3+1
"RTN","RMPR9DO",207,0)
 I (PDAY>9)&(PDAY<30)&(TYPE'["MANUAL") S CHD3=CHD3+1
"RTN","RMPR9DO",208,0)
 I (PPDAY>9)&(PPDAY<30)&(STATUS["PENDING") S PPDD3=PPDD3+1
"RTN","RMPR9DO",209,0)
 I (PDAY>9)&(PDAY<30)&(PPD=1) S PPD3=PPD3+1
"RTN","RMPR9DO",210,0)
 I HD3="" S HD3=0
"RTN","RMPR9DO",211,0)
 I (PDAY>29)&(PDAY<90) S HD4=PDAY,DH6="YES"
"RTN","RMPR9DO",212,0)
 I (PPDAY>29)&(PPDAY<90) S SD4=PPDAY
"RTN","RMPR9DO",213,0)
 I (PDAY>29)&(PDAY<90)&(TYPE["MANUAL") S MHD4=MHD4+1
"RTN","RMPR9DO",214,0)
 I (PDAY>29)&(PDAY<90)&(TYPE'["MANUAL") S CHD4=CHD4+1
"RTN","RMPR9DO",215,0)
 I (PPDAY>29)&(PPDAY<90)&(STATUS["PENDING") S PPDD4=PPDD4+1
"RTN","RMPR9DO",216,0)
 I (PDAY>29)&(PDAY<90)&(PPD=1) S PPD4=PPD4+1
"RTN","RMPR9DO",217,0)
 I HD4="" S HD4=0
"RTN","RMPR9DO",218,0)
 I PDAY>89 S HD5=PDAY,DH6="YES"
"RTN","RMPR9DO",219,0)
 I PPDAY>89 S SD5=PPDAY
"RTN","RMPR9DO",220,0)
 I (PDAY>89)&(TYPE["MANUAL") S MHD5=MHD5+1
"RTN","RMPR9DO",221,0)
 I (PDAY>89)&(TYPE'["MANUAL") S CHD5=CHD5+1
"RTN","RMPR9DO",222,0)
 I (PPDAY>89)&(STATUS["PENDING") S PPDD5=PPDD5+1
"RTN","RMPR9DO",223,0)
 I (PDAY>89)&(PPD=1) S PPD5=PPD5+1
"RTN","RMPR9DO",224,0)
 I HD5="" S HD5=0
"RTN","RMPR9DO",225,0)
 S (PPD,PPDAY)=0
"RTN","RMPR9DO",226,0)
 I LINKED'=0&(TYPE["MANUAL") S MLNK=MLNK+1
"RTN","RMPR9DO",227,0)
 I LINKED'=0&(TYPE'["MANUAL") S CLNK=CLNK+1
"RTN","RMPR9DO",228,0)
 S ^TMP($J,RMPRA)=^TMP($J,RMPRA)_STOPDT_U_DH6_U_HD1_U_HD2_U_HD3_U_HD4_U_HD5
"RTN","RMPR9DO",229,0)
 S ^TMP($J,RMPRA)=^TMP($J,RMPRA)_U_STATUS_U_RMPRA_U_STNX_U_LINKED
"RTN","RMPR9DO",230,0)
 S ^TMP($J,RMPRA)=^TMP($J,RMPRA)_U_U_SD1_U_SD2_U_SD3_U_SD4_U_SD5
"RTN","RMPR9DO",231,0)
 K CDATE,WHO,SSN,TYPE,DES,PDAY,STATUS,ADATE
"RTN","RMPR9DO",232,0)
 ;PUT RESULTS IN GLOBAL!!
"RTN","RMPR9DO",233,0)
 Q
"RTN","RMPR9DO",234,0)
EXIT ;common exit point
"RTN","RMPR9DO",235,0)
 S RESULT=$NA(^TMP($J))
"RTN","RMPR9DO",236,0)
 Q
"RTN","RMPR9DO",237,0)
MAIL ;send to PCM full dataset
"RTN","RMPR9DO",238,0)
 S XMY("G.RMPR SERVER")=""
"RTN","RMPR9DO",239,0)
 S XMY("G.PROSTHETICS@PSAS.MED.VA.GOV")=""
"RTN","RMPR9DO",240,0)
 S XMDUZ=.5
"RTN","RMPR9DO",241,0)
 S XMSUB="Full DOR From Station: "_STNX
"RTN","RMPR9DO",242,0)
 N LASTIEN
"RTN","RMPR9DO",243,0)
 S LASTIEN="A1",LASTIEN=$O(^TMP($J,LASTIEN),-1)
"RTN","RMPR9DO",244,0)
 S ^TMP($J,LASTIEN+1)=^TMP($J,"A1")
"RTN","RMPR9DO",245,0)
 S ^TMP($J,LASTIEN+2)=^TMP($J,"A2")
"RTN","RMPR9DO",246,0)
 S ^TMP($J,LASTIEN+3)=^TMP($J,"A3")
"RTN","RMPR9DO",247,0)
 S ^TMP($J,LASTIEN+4)=^TMP($J,"A4")
"RTN","RMPR9DO",248,0)
 K ^TMP($J,"A1")
"RTN","RMPR9DO",249,0)
 K ^TMP($J,"A2")
"RTN","RMPR9DO",250,0)
 K ^TMP($J,"A3")
"RTN","RMPR9DO",251,0)
 K ^TMP($J,"A4")
"RTN","RMPR9DO",252,0)
 S XMTEXT="^TMP($J,"
"RTN","RMPR9DO",253,0)
 D ^XMD
"RTN","RMPR9DO",254,0)
 Q
"RTN","RMPR9DO",255,0)
MAILG ;Mail message to local staff
"RTN","RMPR9DO",256,0)
 S XMDUZ=.5
"RTN","RMPR9DO",257,0)
 S XMY("G.RMPR SERVER")=""
"RTN","RMPR9DO",258,0)
 S XMY("VHACOPSASPIPReport@MED.VA.GOV")=""
"RTN","RMPR9DO",259,0)
 S XMSUB="DOR From Station: "_STNX
"RTN","RMPR9DO",260,0)
 S RMPRMSG(1)="The Automated Delayed Order Report has transmitted to Prosthetics HQ."
"RTN","RMPR9DO",261,0)
 S RMPRMSG(2)="This was activated by "_$P(XMFROM,"@",1)
"RTN","RMPR9DO",262,0)
 S RMPRMSG(3)=""
"RTN","RMPR9DO",263,0)
 S RMPRMSG(4)="Summary Data Transmitted, includes the following:"
"RTN","RMPR9DO",264,0)
 S RMPRMSG(5)="Totals for site "_STNX_" listed in the order of 0-5, 6-9, 10-29, 30-89, 90+"
"RTN","RMPR9DO",265,0)
 S RMPRMSG(6)="Seperated by ;"
"RTN","RMPR9DO",266,0)
 S RMPRMSG(7)="***Number of MANUALS      ;;"_STNX_";"_MHD1_";"_MHD2_";"_MHD3_";"_MHD4_";"_MHD5
"RTN","RMPR9DO",267,0)
 S RMPRMSG(8)="***Number of CONSULTS     ;;"_STNX_";"_CHD1_";"_CHD2_";"_CHD3_";"_CHD4_";"_CHD5
"RTN","RMPR9DO",268,0)
 S RMPRMSG(9)="***Minus Previous Pending ;;"_STNX_";"_PPD1_";"_PPD2_";"_PPD3_";"_PPD4_";"_PPD5
"RTN","RMPR9DO",269,0)
 S RMPRMSG(10)=""
"RTN","RMPR9DO",270,0)
 S XMTEXT="RMPRMSG("
"RTN","RMPR9DO",271,0)
 D ^XMD
"RTN","RMPR9DO",272,0)
 Q
"RTN","RMPR9LN1")
0^20^B7433014
"RTN","RMPR9LN1",1,0)
RMPR9LN1 ;HOIFO/HNC -  FLEX FIELD SORT;9/18/02 11:38
"RTN","RMPR9LN1",2,0)
 ;;3.0;PROSTHETICS;**90**;Feb 09, 1996
"RTN","RMPR9LN1",3,0)
EN(RESULT) ;
"RTN","RMPR9LN1",4,0)
 ; RESULT passed to broker in ^TMP($J,
"RTN","RMPR9LN1",5,0)
 ; delimited by "^"
"RTN","RMPR9LN1",6,0)
 K ^TMP($J)
"RTN","RMPR9LN1",7,0)
 N RMPRII,RMPRLN
"RTN","RMPR9LN1",8,0)
 S CNT=0
"RTN","RMPR9LN1",9,0)
 F RMPRII=1:1 S RMPRLN=$P($T(HLST+RMPRII),";",4) Q:RMPRLN=""  D
"RTN","RMPR9LN1",10,0)
 .S RMPRFLD=$P($T(HLST+RMPRII),";",3)
"RTN","RMPR9LN1",11,0)
 .S CNT=CNT+1
"RTN","RMPR9LN1",12,0)
 .S ^TMP($J,"RMPR",CNT)=RMPRLN_U_RMPRFLD
"RTN","RMPR9LN1",13,0)
 S RESULT=$NA(^TMP($J))
"RTN","RMPR9LN1",14,0)
 Q
"RTN","RMPR9LN1",15,0)
HLST ;pick list
"RTN","RMPR9LN1",16,0)
 ;;0;*** COMMON/PURCHASING ***
"RTN","RMPR9LN1",17,0)
 ;;1;Date Item Added To PO
"RTN","RMPR9LN1",18,0)
 ;;2;Type Of Transaction
"RTN","RMPR9LN1",19,0)
 ;;4;Billing Item
"RTN","RMPR9LN1",20,0)
 ;;10;Delivery Date
"RTN","RMPR9LN1",21,0)
 ;;11;Form
"RTN","RMPR9LN1",22,0)
 ;;12;Souce
"RTN","RMPR9LN1",23,0)
 ;;14;Total Cost
"RTN","RMPR9LN1",24,0)
 ;;16;Remarks
"RTN","RMPR9LN1",25,0)
 ;;23;Transaction Number or PO Number
"RTN","RMPR9LN1",26,0)
 ;;24;Brief Description
"RTN","RMPR9LN1",27,0)
 ;;25;Deliver To
"RTN","RMPR9LN1",28,0)
 ;;27;Initiator
"RTN","RMPR9LN1",29,0)
 ;;38.1;Exclude/Waiver
"RTN","RMPR9LN1",30,0)
 ;;38.7;Contract #
"RTN","RMPR9LN1",31,0)
 ;;62;Patient Category
"RTN","RMPR9LN1",32,0)
 ;;63;Special Category
"RTN","RMPR9LN1",33,0)
 ;;78;Unit Of Issue
"RTN","RMPR9LN1",34,0)
 ;;89;Saved Item Description
"RTN","RMPR9LN1",35,0)
 ;;0;*** INVENTORY ***
"RTN","RMPR9LN1",36,0)
 ;;4.6;Stock Issue Date
"RTN","RMPR9LN1",37,0)
 ;;37;PIP Item Description
"RTN","RMPR9LN1",38,0)
 ;;38;HCPCS PIP Description
"RTN","RMPR9LN1",39,0)
 ;;0;*** PRODUCT INFORMATION ***
"RTN","RMPR9LN1",40,0)
 ;;4.9;Coding Error Flag
"RTN","RMPR9LN1",41,0)
 ;;4.91;Coding Flag Date
"RTN","RMPR9LN1",42,0)
 ;;8.12;PCE
"RTN","RMPR9LN1",43,0)
 ;;8.13;PCE Date
"RTN","RMPR9LN1",44,0)
 ;;9;Serial Number
"RTN","RMPR9LN1",45,0)
 ;;9.1;Product Description
"RTN","RMPR9LN1",46,0)
 ;;9.2;Product Model
"RTN","RMPR9LN1",47,0)
 ;;21;Lot Number
"RTN","RMPR9LN1",48,0)
 ;;35;Who Edit 2319
"RTN","RMPR9LN1",49,0)
 ;;36;Date of Edit 2319
"RTN","RMPR9LN1",50,0)
 ;;0;*** SUSPENSE ***
"RTN","RMPR9LN1",51,0)
 ;;8.1;Suspense Date
"RTN","RMPR9LN1",52,0)
 ;;8.11;Suspense Station
"RTN","RMPR9LN1",53,0)
 ;;8.14;Suspense Status
"RTN","RMPR9LN1",54,0)
 ;;8.2;Date RX Written
"RTN","RMPR9LN1",55,0)
 ;;8.3;Initial Action Date
"RTN","RMPR9LN1",56,0)
 ;;8.4;Completion Date
"RTN","RMPR9LN1",57,0)
 ;;8.5;Type of Request
"RTN","RMPR9LN1",58,0)
 ;;8.6;Suspense Requestor
"RTN","RMPR9LN1",59,0)
 ;;8.61;Consult Request Service
"RTN","RMPR9LN1",60,0)
 ;;8.7;Provisional Diagnosis
"RTN","RMPR9LN1",61,0)
 ;;8.8;Suspense ICD9
"RTN","RMPR9LN1",62,0)
 ;;8.9;Consult Date
"RTN","RMPR9LN1",63,0)
 ;;0;*** RETURNED ITEMS ***
"RTN","RMPR9LN1",64,0)
 ;;13;Action
"RTN","RMPR9LN1",65,0)
 ;;17;Returned Status
"RTN","RMPR9LN1",66,0)
 ;;17.5;Retruned Status Date
"RTN","RMPR9LN1",67,0)
 ;;0;*** ORTHO LAB ***
"RTN","RMPR9LN1",68,0)
 ;;40;Lab Requesting Station
"RTN","RMPR9LN1",69,0)
 ;;45;Total Lab Labor Hours
"RTN","RMPR9LN1",70,0)
 ;;46;Total Lab Labor Cost
"RTN","RMPR9LN1",71,0)
 ;;47;Total Lab Material Cost
"RTN","RMPR9LN1",72,0)
 ;;48;Total Lab Cost
"RTN","RMPR9LN1",73,0)
 ;;50;Lab Completion Date
"RTN","RMPR9LN1",74,0)
 ;;51;Lab Remarks
"RTN","RMPR9LN1",75,0)
 ;;69;Source of Procurement
"RTN","RMPR9LN1",76,0)
 ;;70;Receiving Station
"RTN","RMPR9LN1",77,0)
 ;;71;Work Order Number
"RTN","RMPR9LN1",78,0)
 ;;72;2529-3 Date
"RTN","RMPR9LN1",79,0)
 ;;80;Lab Work for Other Station
"RTN","RMPR9LN1",80,0)
 ;END
"RTN","RMPR9LNP")
0^21^B7775450
"RTN","RMPR9LNP",1,0)
RMPR9LNP ;Hines OIFO/HNC - REMOTE PROCEDURE, LIST NPPD DATA ;9/8/03  07:23
"RTN","RMPR9LNP",2,0)
 ;;3.0;PROSTHETICS;**71,77,90**;Feb 09, 1996
"RTN","RMPR9LNP",3,0)
 ;
"RTN","RMPR9LNP",4,0)
 ;    HNC - Sept 2, 2003 - patch 77 remove the " for Excel CSV
"RTN","RMPR9LNP",5,0)
 ;    HNC - Feb 14, 2005 - patch 90 add flex field to GUI display
"RTN","RMPR9LNP",6,0)
 ;
"RTN","RMPR9LNP",7,0)
 ;RESULTS passed to broker in ^TMP($J,
"RTN","RMPR9LNP",8,0)
 ;delimited by "^"
"RTN","RMPR9LNP",9,0)
 ;piece 1 = ENTRY DATE
"RTN","RMPR9LNP",10,0)
 ;piece 2 = PATIENT NAME
"RTN","RMPR9LNP",11,0)
 ;piece 3 = PSAS HCPCS with * if hcpcs has Calculation Flag
"RTN","RMPR9LNP",12,0)
 ;piece 4 = QTY
"RTN","RMPR9LNP",13,0)
 ;piece 5 = VENDOR
"RTN","RMPR9LNP",14,0)
 ;piece 6 = INITIAL ACTION DATE
"RTN","RMPR9LNP",15,0)
 ;piece 7 = TOTAL COST
"RTN","RMPR9LNP",16,0)
 ;piece 8 = DESCRIPTION
"RTN","RMPR9LNP",17,0)
 ;piece 9 = INITIATOR
"RTN","RMPR9LNP",18,0)
 ;piece 10 = NPPD LINE BEFORE GROUPER
"RTN","RMPR9LNP",19,0)
 ;piece 11 = STATION
"RTN","RMPR9LNP",20,0)
 ;piece 12 = GROUPER NUMBER
"RTN","RMPR9LNP",21,0)
 ;piece 13 = FORM REQUESTED ON
"RTN","RMPR9LNP",22,0)
 ;piece 14 = TYPE OF TRANSACTION
"RTN","RMPR9LNP",23,0)
 ;piece 15 = SSN
"RTN","RMPR9LNP",24,0)
 ;piece 16 = IEN TO FILE 660
"RTN","RMPR9LNP",25,0)
 ;piece 17 = HCPCS SHORT DESCRIPTION
"RTN","RMPR9LNP",26,0)
 ;piece 18 = SOURCE
"RTN","RMPR9LNP",27,0)
 ;piece 19 = Optional Flex Field
"RTN","RMPR9LNP",28,0)
 Q
"RTN","RMPR9LNP",29,0)
 ;
"RTN","RMPR9LNP",30,0)
EN(RESULT,DATE1,DATE2,FLEXF) ;broker entry point
"RTN","RMPR9LNP",31,0)
 ;
"RTN","RMPR9LNP",32,0)
 K ^TMP($J)
"RTN","RMPR9LNP",33,0)
 I '$D(DATE1)!('$D(DATE2)) G EXIT
"RTN","RMPR9LNP",34,0)
 S DATE=DATE1-1
"RTN","RMPR9LNP",35,0)
 F  S DATE=$O(^RMPR(660,"B",DATE)) Q:(DATE="")!($P(DATE,".",1)>DATE2)  D
"RTN","RMPR9LNP",36,0)
 .S RMPRB=0
"RTN","RMPR9LNP",37,0)
 .F  S RMPRB=$O(^RMPR(660,"B",DATE,RMPRB)) Q:RMPRB=""  D
"RTN","RMPR9LNP",38,0)
 ..Q:$P(^RMPR(660,RMPRB,0),U,15)["*"
"RTN","RMPR9LNP",39,0)
 ..S PHCPCS=$P($G(^RMPR(660,RMPRB,1)),U,4)
"RTN","RMPR9LNP",40,0)
 ..Q:PHCPCS=""
"RTN","RMPR9LNP",41,0)
 ..Q:PHCPCS'>0
"RTN","RMPR9LNP",42,0)
 ..S HDES=$P(^RMPR(661.1,PHCPCS,0),U,2)
"RTN","RMPR9LNP",43,0)
 ..S TYPE=$P($G(^RMPR(660,RMPRB,0)),U,4)
"RTN","RMPR9LNP",44,0)
 ..I TYPE'="X" S LINE=$P(^RMPR(661.1,PHCPCS,0),U,7)
"RTN","RMPR9LNP",45,0)
 ..I TYPE="X" S LINE=$P(^RMPR(661.1,PHCPCS,0),U,6)
"RTN","RMPR9LNP",46,0)
 ..S CAL=$P(^RMPR(661.1,PHCPCS,0),U,8)
"RTN","RMPR9LNP",47,0)
 ..I CAL'="" S CAL="*"
"RTN","RMPR9LNP",48,0)
 ..S DFN=$P(^RMPR(660,RMPRB,0),U,2)
"RTN","RMPR9LNP",49,0)
 ..D DEM^VADPT
"RTN","RMPR9LNP",50,0)
 ..D DATA
"RTN","RMPR9LNP",51,0)
 S RESULT=$NA(^TMP($J))
"RTN","RMPR9LNP",52,0)
 Q
"RTN","RMPR9LNP",53,0)
 ;
"RTN","RMPR9LNP",54,0)
DATA ;
"RTN","RMPR9LNP",55,0)
 S B=RMPRB
"RTN","RMPR9LNP",56,0)
 I FLEXF'="" S RMPRFLD=".01;.02;4.5;5;7;8;8.3;11;12;14;24;27;68;"_FLEXF
"RTN","RMPR9LNP",57,0)
 I FLEXF="" S RMPRFLD=".01;.02;4.5;5;7;8;8.3;11;12;14;24;27;68"
"RTN","RMPR9LNP",58,0)
 D GETS^DIQ(660,B,RMPRFLD,"","RMXM")
"RTN","RMPR9LNP",59,0)
 S $P(^TMP($J,B),U,1)=$G(RMXM(660,B_",",.01))
"RTN","RMPR9LNP",60,0)
 S $P(^TMP($J,B),U,2)=$G(RMXM(660,B_",",.02))
"RTN","RMPR9LNP",61,0)
 S $P(^TMP($J,B),U,3)=$G(RMXM(660,B_",",4.5))_CAL
"RTN","RMPR9LNP",62,0)
 S $P(^TMP($J,B),U,4)=$G(RMXM(660,B_",",5))
"RTN","RMPR9LNP",63,0)
 S $P(^TMP($J,B),U,5)=$G(RMXM(660,B_",",7))
"RTN","RMPR9LNP",64,0)
 S $P(^TMP($J,B),U,6)=$G(RMXM(660,B_",",8.3))
"RTN","RMPR9LNP",65,0)
 S $P(^TMP($J,B),U,7)=$G(RMXM(660,B_",",14))
"RTN","RMPR9LNP",66,0)
 ;patch 77 remove the " for Excel CSV
"RTN","RMPR9LNP",67,0)
 S $P(^TMP($J,B),U,8)=$TR($G(RMXM(660,B_",",24)),"""","'")
"RTN","RMPR9LNP",68,0)
 S $P(^TMP($J,B),U,9)=$G(RMXM(660,B_",",27))
"RTN","RMPR9LNP",69,0)
 S $P(^TMP($J,B),U,10)=LINE
"RTN","RMPR9LNP",70,0)
 S $P(^TMP($J,B),U,11)=$G(RMXM(660,B_",",8))
"RTN","RMPR9LNP",71,0)
 S $P(^TMP($J,B),U,12)=$G(RMXM(660,B_",",68))
"RTN","RMPR9LNP",72,0)
 S $P(^TMP($J,B),U,13)=$G(RMXM(660,B_",",11))
"RTN","RMPR9LNP",73,0)
 S $P(^TMP($J,B),U,14)=TYPE
"RTN","RMPR9LNP",74,0)
 S $P(^TMP($J,B),U,15)=$P(VADM(2),U,2)
"RTN","RMPR9LNP",75,0)
 S $P(^TMP($J,B),U,16)=B
"RTN","RMPR9LNP",76,0)
 S $P(^TMP($J,B),U,17)=HDES
"RTN","RMPR9LNP",77,0)
 S $P(^TMP($J,B),U,18)=$E($G(RMXM(660,B_",",12)),0,1)
"RTN","RMPR9LNP",78,0)
 I FLEXF'="" S $P(^TMP($J,B),U,19)=$G(RMXM(660,B_",",FLEXF))
"RTN","RMPR9LNP",79,0)
 I FLEXF="" S $P(^TMP($J,B),U,19)=""
"RTN","RMPR9LNP",80,0)
 K RMXM,VADM,CAL
"RTN","RMPR9LNP",81,0)
 Q
"RTN","RMPR9LNP",82,0)
EXIT ;common exit point
"RTN","RMPR9LNP",83,0)
 Q
"RTN","RMPR9LNP",84,0)
 ;END
"RTN","RMPR9P21")
0^40^B39737289
"RTN","RMPR9P21",1,0)
RMPR9P21 ;PHX/SPS,HNC,RVD -SEND DATA TO PC TO PRINT PURCHASE CARD ORDER ;4/27/05
"RTN","RMPR9P21",2,0)
 ;;3.0;PROSTHETICS;**90**;Feb 09, 1996
"RTN","RMPR9P21",3,0)
 ;
"RTN","RMPR9P21",4,0)
EN(RMPRA,RMPRSITE,RMPRPTR) ;ENTRY POINT FOR VISTA ROLL AND SCROLL
"RTN","RMPR9P21",5,0)
 G EN2
"RTN","RMPR9P21",6,0)
 ;
"RTN","RMPR9P21",7,0)
PRT(RESULTS,RMPRA,RMPRSITE,RMPRPTR) ;GUI ENTRY POINT TO PRINT
"RTN","RMPR9P21",8,0)
EN2 I RMPRPTR'="WINDOWS" Q
"RTN","RMPR9P21",9,0)
 K ^TMP($J,"RMPRPRT"),RESULTS
"RTN","RMPR9P21",10,0)
 D INF^RMPRSIT
"RTN","RMPR9P21",11,0)
 S %X="^RMPR(664,RMPRA,",%Y="R664(" D %XY^%RCR K %X,%Y,^TMP($J,"RMPRPRT")
"RTN","RMPR9P21",12,0)
 S RDUZ=$P(R664(0),U,9),RDUZ=$P(^VA(200,RDUZ,0),U,1),DFN=$P(R664(0),U,2),RTN=$P(R664(0),U,7),CP=$P(R664(0),U,6),RMPRPAGE=2
"RTN","RMPR9P21",13,0)
 D ADD^VADPT,DEM^VADPT,ELIG^VADPT
"RTN","RMPR9P21",14,0)
 S ^TMP($J,"RMPRPRT",0)="                           OMB Number 2900-0188                    PO#: "_$P($G(^RMPR(664,RMPRA,4)),U,5)
"RTN","RMPR9P21",15,0)
 S ^TMP($J,"RMPRPRT",1)=""
"RTN","RMPR9P21",16,0)
 S ^TMP($J,"RMPRPRT",2)=""
"RTN","RMPR9P21",17,0)
 S ^TMP($J,"RMPRPRT",3)="       ***ORIGINAL COPY AND COMMERCIAL INVOICE MUST BE SUBMITTED***"
"RTN","RMPR9P21",18,0)
 S ^TMP($J,"RMPRPRT",4)="               TO THE VAMC PROSTHETIC ACTIVITY LISTED BELOW"
"RTN","RMPR9P21",19,0)
HDR ;PRINT HEADER FOR 2421 ADDRESS INFO
"RTN","RMPR9P21",20,0)
 S K="" F  S K=$O(^TMP($J,"RMPRPRT",K)) Q:K=""  S CNT=K
"RTN","RMPR9P21",21,0)
 S (RMPRT,RMPRB)="",$P(RMPRT,"_",80)="",$P(RMPRB,"-",80)=""
"RTN","RMPR9P21",22,0)
 S ^TMP($J,"RMPRPRT",CNT+1)=RMPRT
"RTN","RMPR9P21",23,0)
 S ^TMP($J,"RMPRPRT",CNT+2)="Department of Veterans Affairs"_"|"_"Prosthetic Authorization for Items or Services"
"RTN","RMPR9P21",24,0)
 S ^TMP($J,"RMPRPRT",CNT+3)=RMPRB
"RTN","RMPR9P21",25,0)
 S ^TMP($J,"RMPRPRT",CNT+4)="1. Name and Address of Vendor          2. Name and Address of VA Facility"
"RTN","RMPR9P21",26,0)
 S RMPRV=$P(R664(0),U,4),RMPRST=""
"RTN","RMPR9P21",27,0)
 I $D(^PRC(440,RMPRV,0)) S RMPRV=^PRC(440,RMPRV,0) D
"RTN","RMPR9P21",28,0)
 .S RMPRST=$P(RMPRV,U,7),RMPRPHON=$P(RMPRV,U,10)
"RTN","RMPR9P21",29,0)
 .S RMPRAD1=$P(RMPRV,U,2),RMPRAD2=$P(RMPRV,U,3)
"RTN","RMPR9P21",30,0)
 .S RMPRCITY=$P(RMPRV,U,6),RMPR90IP=$P(RMPRV,U,8)
"RTN","RMPR9P21",31,0)
 .S RMPRVACN=$P($G(^PRC(440,$P(R664(0),U,4),2)),U,1)
"RTN","RMPR9P21",32,0)
 I $D(^DIC(5,+RMPRST,0)) S RMPRST=$P(^(0),U,2)
"RTN","RMPR9P21",33,0)
 E  S RMPRST="NO STATE ON FILE"
"RTN","RMPR9P21",34,0)
 S SPACE="",LRMPRV=$L($E($P(RMPRV,U,1),1,30)),$P(SPACE," ",40-LRMPRV)=""
"RTN","RMPR9P21",35,0)
 S ^TMP($J,"RMPRPRT",CNT+5)="    "_$E($P(RMPRV,U,1),1,30)_SPACE_$E(RMPR("NAME"),1,28)_" ,("_$$STA^RMPRUTIL_"/"_$$ROU^RMPRUTIL(RMPRSITE)_")"
"RTN","RMPR9P21",36,0)
 S LRMPRCTY=$L(RMPRCITY),LRMPRST=$L(RMPRST),LRMPRAD1=$L($E(RMPRAD1,1,35))
"RTN","RMPR9P21",37,0)
 S SPACE="",$P(SPACE," ",40-LRMPRAD1)=""
"RTN","RMPR9P21",38,0)
 S ^TMP($J,"RMPRPRT",CNT+6)="    "_$E(RMPRAD1,1,35)_SPACE_$E(RMPR("ADD"),1,39)
"RTN","RMPR9P21",39,0)
 S SPACE="",LRMPRAD2=$L($E(RMPRAD2,1,35)),$P(SPACE," ",45-LRMPRAD1)=""
"RTN","RMPR9P21",40,0)
 I RMPRAD2'="" S ^TMP($J,"RMPRPRT",CNT+7)="    "_$E(RMPRAD2,1,35)_SPACE_RMPR("CITY")
"RTN","RMPR9P21",41,0)
 S SPACE="",$P(SPACE," ",33-LRMPRCTY-LRMPRST)=""
"RTN","RMPR9P21",42,0)
 I RMPRAD2="" S ^TMP($J,"RMPRPRT",CNT+7)="    "_RMPRCITY_","_RMPRST_" "_RMPR90IP_SPACE_RMPR("CITY")
"RTN","RMPR9P21",43,0)
 I RMPRAD2'="" S ^TMP($J,"RMPRPRT",CNT+8)="    "_RMPRCITY_","_RMPRST_" "_RMPR90IP
"RTN","RMPR9P21",44,0)
 S K="" F  S K=$O(^TMP($J,"RMPRPRT",K)) Q:K=""  S CNT=K
"RTN","RMPR9P21",45,0)
 S ^TMP($J,"RMPRPRT",CNT+1)="    "_RMPRPHON_"                          "_$P(^RMPR(669.9,RMPRSITE,0),U,4)
"RTN","RMPR9P21",46,0)
 S ^TMP($J,"RMPRPRT",CNT+2)=RMPRB
"RTN","RMPR9P21",47,0)
 S ^TMP($J,"RMPRPRT",CNT+3)="3. Veterans Name (Last, First, MI)     4. Date of Authorization"
"RTN","RMPR9P21",48,0)
 S SPACE="",VADM1=$L(VADM(1))
"RTN","RMPR9P21",49,0)
 S ^TMP($J,"RMPRPRT",CNT+4)="    "_VADM(1) S Y=$P(R664(0),U,1) D DD^%DT
"RTN","RMPR9P21",50,0)
 S SPACE="",$P(SPACE," ",40-VADM1)=""
"RTN","RMPR9P21",51,0)
 S ^TMP($J,"RMPRPRT",CNT+4)=^TMP($J,"RMPRPRT",CNT+4)_SPACE_Y
"RTN","RMPR9P21",52,0)
 I $D(RMPRMOR) S ^TMP($J,"RMPRPRT",CNT+5)=RMPRB D HDR1 Q
"RTN","RMPR9P21",53,0)
 S ^TMP($J,"RMPRPRT",CNT+5)=RMPRB S RMPRODTE=Y
"RTN","RMPR9P21",54,0)
 S RMPRDELD="" I $D(R664(3)),$P(R664(3),U,2)]"" S Y=$P(R664(3),U,2) D DD^%DT S RMPRDELD=Y
"RTN","RMPR9P21",55,0)
 S ^TMP($J,"RMPRPRT",CNT+6)="5. Veterans Address                    6. Date Required"
"RTN","RMPR9P21",56,0)
 S SPACE="",VAPA1=$L(VAPA(1)),$P(SPACE," ",40-VAPA1)=""
"RTN","RMPR9P21",57,0)
 S ^TMP($J,"RMPRPRT",CNT+7)="    "_VAPA(1)_SPACE_RMPRDELD
"RTN","RMPR9P21",58,0)
 S SPACE="",VAPA4=$L(VAPA(4)),VAPA5=$P($L(VAPA(5)),U,2),VAPA6=$L(VAPA(6)),$P(SPACE," ",27-VAPA4-VAPA5-VAPA6)=""
"RTN","RMPR9P21",59,0)
 I VAPA(2)="" S ^TMP($J,"RMPRPRT",CNT+8)="    "_VAPA(4)_","_$P(VAPA(5),U,2)_" "_VAPA(6)_SPACE_$E(RMPRB,1,40)
"RTN","RMPR9P21",60,0)
 I VAPA(2)="" S ^TMP($J,"RMPRPRT",CNT+9)="                                        9. Authority For Issuance  CFR 17.115"
"RTN","RMPR9P21",61,0)
 S SPACE="",VAPA8=$L(VAPA(8)),$P(SPACE," ",40-VAPA8)=""
"RTN","RMPR9P21",62,0)
 I VAPA(2)="" S ^TMP($J,"RMPRPRT",CNT+10)="    "_VAPA(8)_SPACE_"CHARGE MEDICAL APPROPRIATION"
"RTN","RMPR9P21",63,0)
 S SPACE="",VAPA2=$L(VAPA(2)),$P(SPACE," ",31-VAPA2)=""
"RTN","RMPR9P21",64,0)
 I VAPA(2)'="" S ^TMP($J,"RMPRPRT",CNT+8)="    "_VAPA(2)_SPACE_$E(RMPRB,1,40)
"RTN","RMPR9P21",65,0)
 S SPACE="",$P(SPACE," ",30-VAPA4-VAPA5-VAPA6)=""
"RTN","RMPR9P21",66,0)
 I VAPA(2)'="" S ^TMP($J,"RMPRPRT",CNT+9)="    "_VAPA(4)_","_$P(VAPA(5),U,2)_" "_VAPA(6)_SPACE_"9. Authority For Issuance  CFR 17.115"
"RTN","RMPR9P21",67,0)
 S SPACE="",$P(SPACE," ",40-VAPA8)=""
"RTN","RMPR9P21",68,0)
 I VAPA(2)'="" S ^TMP($J,"RMPRPRT",CNT+10)="    "_VAPA(8)_SPACE_"CHARGE MEDICAL APPROPRIATION"
"RTN","RMPR9P21",69,0)
 S ^TMP($J,"RMPRPRT",CNT+11)=RMPRB
"RTN","RMPR9P21",70,0)
 S ^TMP($J,"RMPRPRT",CNT+12)="7. Claim Number   "_VAEL(7)_"             8. ID #:"_" "_$P($P(VADM(2),U,2),"-",3)
"RTN","RMPR9P21",71,0)
 S ^TMP($J,"RMPRPRT",CNT+13)=RMPRB
"RTN","RMPR9P21",72,0)
 S ^TMP($J,"RMPRPRT",CNT+14)="10. Statistical Data         11. FOB Point    12. Discount    13. Delivery Time"
"RTN","RMPR9P21",73,0)
 S R664("E")=$O(R664(1,0)),CAT=$P(R664(1,R664("E"),0),U,10)
"RTN","RMPR9P21",74,0)
 S RMPRCAT=$S(CAT=1:"SC/OP",CAT=2:"SC/IP",CAT=3:"NSC/IP",CAT=4:"NSC/OP",1:"")
"RTN","RMPR9P21",75,0)
 S SPE=$P(R664(1,R664("E"),0),U,11)
"RTN","RMPR9P21",76,0)
 S RMPRSCAT=$S(SPE=1:"SPECIAL LEGISLATION",SPE=2:"A&A",SPE=3:"PHC",SPE=4:"ELIGIBILITY REFORM",1:"")
"RTN","RMPR9P21",77,0)
 S ^TMP($J,"RMPRPRT",CNT+15)="    "_RMPRCAT_" "_RMPRSCAT S:+$P(R664(0),U,10) RMPRFOB=$P(R664(0),U,10)
"RTN","RMPR9P21",78,0)
 S SPACE="",LRMPRCAT=$L(RMPRCAT),LRMPSCAT=$L(RMPRSCAT),$P(SPACE," ",29-LRMPRCAT-LRMPSCAT)=""
"RTN","RMPR9P21",79,0)
 S ^TMP($J,"RMPRPRT",CNT+15)=^TMP($J,"RMPRPRT",CNT+15)_SPACE_$S($D(RMPRFOB):"ORIGIN",1:"DEST ")_"              % "
"RTN","RMPR9P21",80,0)
 I $D(R664(2)) S ^TMP($J,"RMPRPRT",CNT+15)=^TMP($J,"RMPRPRT",CNT+15)_$P(R664(2),U,6)
"RTN","RMPR9P21",81,0)
 I $D(R664(3)) S ^TMP($J,"RMPRPRT",CNT+15)=^TMP($J,"RMPRPRT",CNT+15)_"             "_$P(R664(3),U,3)_" Days"
"RTN","RMPR9P21",82,0)
 S ^TMP($J,"RMPRPRT",CNT+16)=RMPRB
"RTN","RMPR9P21",83,0)
 ;S ^TMP($J,"RMPRPRT",CNT+16)="                             "_$E(RMPRB,1,50)
"RTN","RMPR9P21",84,0)
 S ^TMP($J,"RMPRPRT",CNT+17)="14. Delivery To: "
"RTN","RMPR9P21",85,0)
 S:$D(R664(3)) ^TMP($J,"RMPRPRT",CNT+17)=^TMP($J,"RMPRPRT",CNT+17)_$P(R664(3),U,4)
"RTN","RMPR9P21",86,0)
 S ^TMP($J,"RMPRPRT",CNT+18)=RMPRB
"RTN","RMPR9P21",87,0)
HDR1 ;HEADER FOR 10-2421
"RTN","RMPR9P21",88,0)
 S K="" F  S K=$O(^TMP($J,"RMPRPRT",K)) Q:K=""  S CNT=K
"RTN","RMPR9P21",89,0)
 S ^TMP($J,"RMPRPRT",CNT+1)="                15. DESCRIPTION OF ITEMS OR SERVICES AUTHORIZED"
"RTN","RMPR9P21",90,0)
 S ^TMP($J,"RMPRPRT",CNT+2)=RMPRB
"RTN","RMPR9P21",91,0)
 S ^TMP($J,"RMPRPRT",CNT+3)="ITEM NUMBER           DESCRIPTION              QUANTITY  UNIT  UNIT     AMOUNT"
"RTN","RMPR9P21",92,0)
 S ^TMP($J,"RMPRPRT",CNT+4)="                                               ORDERED         PRICE"
"RTN","RMPR9P21",93,0)
 S ^TMP($J,"RMPRPRT",CNT+5)=RMPRB
"RTN","RMPR9P21",94,0)
 Q:$D(RMPRMOR)
"RTN","RMPR9P21",95,0)
 S K="" F  S K=$O(^TMP($J,"RMPRPRT",K)) Q:K=""  S CNT=K
"RTN","RMPR9P21",96,0)
 D ^RMPR9P22
"RTN","RMPR9P21",97,0)
 D:'$D(RMPRMOR1) CON^RMPR9P22
"RTN","RMPR9P21",98,0)
 M RESULTS=^TMP($J,"RMPRPRT")
"RTN","RMPR9P21",99,0)
EX ;Common Exit Point
"RTN","RMPR9P21",100,0)
 K VADM,CP,DFN,CAT,DIC,R664,RMPRA,RMPACT,RMPRAD1,RMPRAD2,RMPRAMT,RMPRAMT1,RMPRB,RMPRCAT,RMPRCH,RMPRCITY,RMPRDELD,RMPRI,RMPRI1,RMPRIT,RMPRN,RMPRODTE,RMPRST,RMPRPHON,RMPRT,RMPRTOT,RMPRUT,RMPRV,RMPR90IP,RO,RP,J1,RTN,RMPRMOR1,RMPRPRIV
"RTN","RMPR9P21",101,0)
 K SPE,VA,VAEL,VAPA,VAERR,RZZZ,RX,RX1,RDUZ,RC,RMPRACT,RMPRSCAT,RMPRDISC,RMPRAMTN,DIR,DIRUT,RMPRAMT2,RMPRFOB,RMPRDA,RMPRMOR,RMPRPAGE,RMPRPRIV,RMPRX,RMPR90,J,K,N D ^%ZISC Q
"RTN","RMPR9P22")
0^41^B33980681
"RTN","RMPR9P22",1,0)
RMPR9P22 ;PHX/HNC/RVD/SPS-CONT GUI PC PRINTER/FAX PURCHASE CARD ;4/27/2005
"RTN","RMPR9P22",2,0)
 ;;3.0;PROSTHETICS;**90**;Feb 09, 1996
"RTN","RMPR9P22",3,0)
 S K="" F  S K=$O(^TMP($J,"RMPRPRT",K)) Q:K=""  S CNT=K
"RTN","RMPR9P22",4,0)
 D ADD
"RTN","RMPR9P22",5,0)
 S RO=0 F  S RO=$O(R664(1,RO)) Q:RO'>0  D:$D(RMPRMOR)&(CNT>58) CONT D:'$D(RMPRMOR) ADD D START
"RTN","RMPR9P22",6,0)
 Q
"RTN","RMPR9P22",7,0)
START S K="" F  S K=$O(^TMP($J,"RMPRPRT",K)) Q:K=""  S CNT=K
"RTN","RMPR9P22",8,0)
 S ^TMP($J,"RMPRPRT",CNT+1)="#"_RO_"."
"RTN","RMPR9P22",9,0)
 S RMPRI=$S($P(R664(1,RO,0),U,7)'="":$P(R664(1,RO,0),U,7),1:$P(R664(1,RO,0),U,3))
"RTN","RMPR9P22",10,0)
 S SPACE="",RMPRBDL=$P(R664(1,RO,0),U,2),RMPRBDL=$L(RMPRBDL),$P(SPACE," ",47)=""
"RTN","RMPR9P22",11,0)
 S ^TMP($J,"RMPRPRT",CNT+1)=^TMP($J,"RMPRPRT",CNT+1)_$P(R664(1,RO,0),U,2)
"RTN","RMPR9P22",12,0)
 S ^TMP($J,"RMPRPRT",CNT+2)=SPACE_$J($P(R664(1,RO,0),U,4),6) S RMPRUT=$P(R664(1,RO,0),U,5)
"RTN","RMPR9P22",13,0)
 I $D(^PRCD(420.5,+RMPRUT,0)) S ^TMP($J,"RMPRPRT",CNT+2)=^TMP($J,"RMPRPRT",CNT+2)_"      "_$P(^PRCD(420.5,+RMPRUT,0),U,1)_" "_$J($FN(RMPRI,"P",2),6)
"RTN","RMPR9P22",14,0)
ZWE S RMPRTOT=RMPRI*$P(R664(1,RO,0),U,4),RMPRTOTJ=$J($FN(RMPRTOT,"P",2),8) S ^TMP($J,"RMPRPRT",CNT+2)=^TMP($J,"RMPRPRT",CNT+2)_" "_RMPRTOTJ
"RTN","RMPR9P22",15,0)
 S ^TMP($J,"RMPRPRT",CNT+3)=""
"RTN","RMPR9P22",16,0)
 D EXT
"RTN","RMPR9P22",17,0)
 Q
"RTN","RMPR9P22",18,0)
EXT ;CHECKING FOR EXTENDED DESCRIPTION
"RTN","RMPR9P22",19,0)
 ;serial number
"RTN","RMPR9P22",20,0)
 S K="" F  S K=$O(^TMP($J,"RMPRPRT",K)) Q:K=""  S CNT=K
"RTN","RMPR9P22",21,0)
 N RMPRCNT,RMPRSSM
"RTN","RMPR9P22",22,0)
 S RMPRCNT=0
"RTN","RMPR9P22",23,0)
 S RMPRSSM(1)=$P($G(R664(1,RO,0)),U,15)
"RTN","RMPR9P22",24,0)
 S RMPRSSM(2)=$P($G(R664(1,RO,2)),U,1)
"RTN","RMPR9P22",25,0)
 S RMPRSSM(3)=$P($G(R664(1,RO,2)),U,2)
"RTN","RMPR9P22",26,0)
 S RMPRSSM(4)=$P($G(R664(1,RO,2)),U,3)
"RTN","RMPR9P22",27,0)
 I RMPRSSM(1)'="" S RMPRCNT=RMPRCNT+1
"RTN","RMPR9P22",28,0)
 I RMPRSSM(2)'="" S RMPRCNT=RMPRCNT+1
"RTN","RMPR9P22",29,0)
 I RMPRSSM(3)'="" S RMPRCNT=RMPRCNT+1
"RTN","RMPR9P22",30,0)
 I RMPRSSM(4)'="" S RMPRCNT=RMPRCNT+1
"RTN","RMPR9P22",31,0)
 I RMPRSSM(1)'="" S ^TMP($J,"RMPRPRT",CNT+1)="    Serial Number: "_RMPRSSM(1)
"RTN","RMPR9P22",32,0)
 I RMPRSSM(4)'="" S ^TMP($J,"RMPRPRT",CNT+1)=^TMP($J,"RMPRPRT",CNT+1)_"    Lot #: "_RMPRSSM(4)
"RTN","RMPR9P22",33,0)
 S ^TMP($J,"RMPRPRT",CNT+2)=""
"RTN","RMPR9P22",34,0)
 I RMPRSSM(3)'="" S ^TMP($J,"RMPRPRT",CNT+3)="    Model: "_RMPRSSM(3)
"RTN","RMPR9P22",35,0)
 I RMPRSSM(2)'="" S ^TMP($J,"RMPRPRT",CNT+3)=^TMP($J,"RMPRPRT",CNT+3)_"    Make: "_RMPRSSM(2)
"RTN","RMPR9P22",36,0)
 K RMPRSSM,RMPRCNT
"RTN","RMPR9P22",37,0)
 ;
"RTN","RMPR9P22",38,0)
 S RMPRCH=$G(R664(1,RO,1,0))
"RTN","RMPR9P22",39,0)
 I RMPRCH="" Q
"RTN","RMPR9P22",40,0)
 S RMPR90=0
"RTN","RMPR9P22",41,0)
 S K="" F  S K=$O(^TMP($J,"RMPRPRT",K)) Q:K=""  S CNT=K
"RTN","RMPR9P22",42,0)
 F  S RMPR90=$O(R664(1,RO,1,RMPR90)) Q:RMPR90=""  D
"RTN","RMPR9P22",43,0)
 .D:$D(RMPRMOR)&(CNT>60) CONT
"RTN","RMPR9P22",44,0)
 .;D:'$D(RMPRMOR)&(CNT>38) CONT
"RTN","RMPR9P22",45,0)
 .S CNT=CNT+1
"RTN","RMPR9P22",46,0)
 .S ^TMP($J,"RMPRPRT",CNT)=R664(1,RO,1,RMPR90,0)
"RTN","RMPR9P22",47,0)
 Q
"RTN","RMPR9P22",48,0)
WRI ;CONTINUATION OF 10-2421
"RTN","RMPR9P22",49,0)
 W !,@RMPR90
"RTN","RMPR9P22",50,0)
 Q
"RTN","RMPR9P22",51,0)
CONT ;
"RTN","RMPR9P22",52,0)
 D:'$D(RMPRMOR) CON
"RTN","RMPR9P22",53,0)
 S K="" F  S K=$O(^TMP($J,"RMPRPRT",K)) Q:K=""  S CNT=K
"RTN","RMPR9P22",54,0)
 S ^TMP($J,"RMPRPRT",CNT+1)="CONTINUATION OF PURCHASE CARD ORDER NUMBER: "_$P($G(^RMPR(664,RMPRA,4)),U,5)_"                           PAGE "_RMPRPAGE S RMPRMOR=1,RMPRPAGE=RMPRPAGE+1 D HDR^RMPR9P21
"RTN","RMPR9P22",55,0)
 Q
"RTN","RMPR9P22",56,0)
ADD S (RMPRAMT2,RMPRAMT,RMPRAMT1,RMPRAMTN)=0
"RTN","RMPR9P22",57,0)
 S RMSHI=$S($P(R664(0),U,11)'="":$P(R664(0),U,11),1:$P(R664(0),U,10))
"RTN","RMPR9P22",58,0)
 S RC=0 F  S RC=$O(R664(1,RC)) Q:RC=""!(RC["B")  S RMPRI=$S($P(R664(1,RC,0),U,7)'="":$P(R664(1,RC,0),U,7),1:$P(R664(1,RC,0),U,3)) D ADD1
"RTN","RMPR9P22",59,0)
 I $D(R664(2)) S RMPRDISC=$S($P(R664(2),U,6)'="":$P(R664(2),U,6),1:"") I $D(RMPRDISC) S RMPRAMT2=$J(RMPRDISC*RMPRAMT/100,0,2),RMPRAMTN=RMPRAMT-$J(RMPRAMT2,0,2),RMPRAMTN=$J(RMPRAMTN+RMSHI,0,2) Q
"RTN","RMPR9P22",60,0)
 Q
"RTN","RMPR9P22",61,0)
ADD1 S RMPRAMT1=$J($P(R664(1,RC,0),U,4)*RMPRI,0,2) S RMPRAMT=RMPRAMT+RMPRAMT1 Q
"RTN","RMPR9P22",62,0)
CON ;CONTINUATION OF 2421
"RTN","RMPR9P22",63,0)
 S K="" F  S K=$O(^TMP($J,"RMPRPRT",K)) Q:K=""  S CNT=K
"RTN","RMPR9P22",64,0)
 S ^TMP($J,"RMPRPRT",CNT+1)=RMPRB
"RTN","RMPR9P22",65,0)
 S ^TMP($J,"RMPRPRT",CNT+2)="16. Contract Number: "
"RTN","RMPR9P22",66,0)
 S RO("C")=$O(R664(1,0)),ROCL=$P($G(R664(1,RO("C"),0)),U,14)
"RTN","RMPR9P22",67,0)
 I RO("C") S ^TMP($J,"RMPRPRT",CNT+2)=^TMP($J,"RMPRPRT",CNT+2)_$P(R664(1,RO("C"),0),U,14)
"RTN","RMPR9P22",68,0)
 S SPACE="",ROCL=$L(ROCL),$P(SPACE," ",39-ROCL)=""
"RTN","RMPR9P22",69,0)
 S RMPRAMTJ=$J($FN(RMPRAMT,"P",2),9)
"RTN","RMPR9P22",70,0)
 S ^TMP($J,"RMPRPRT",CNT+2)=^TMP($J,"RMPRPRT",CNT+2)_SPACE_"Subtotal: $"_RMPRAMTJ
"RTN","RMPR9P22",71,0)
 S ^TMP($J,"RMPRPRT",CNT+3)="    ACCT.#: "_RMPRVACN K RMPRVACN
"RTN","RMPR9P22",72,0)
 S ^TMP($J,"RMPRPRT",CNT+3)=^TMP($J,"RMPRPRT",CNT+3)_"     Discount: $"
"RTN","RMPR9P22",73,0)
 I $D(RMPRAMT2) S RMPRMT2J=$J($FN(RMPRAMT2,"P",2),7),^TMP($J,"RMPRPRT",CNT+3)=^TMP($J,"RMPRPRT",CNT+3)_RMPRMT2J
"RTN","RMPR9P22",74,0)
 S RMSHIJ=$J($FN(RMSHI,"P",2),5)
"RTN","RMPR9P22",75,0)
 S ^TMP($J,"RMPRPRT",CNT+3)=^TMP($J,"RMPRPRT",CNT+3)_"  Shipping: $"_RMSHIJ
"RTN","RMPR9P22",76,0)
 S RMPRMTNJ=$J($FN(RMPRAMTN,"P",2),9)
"RTN","RMPR9P22",77,0)
 S ^TMP($J,"RMPRPRT",CNT+3)=^TMP($J,"RMPRPRT",CNT+3)_"   Total: $"_RMPRMTNJ
"RTN","RMPR9P22",78,0)
 S ^TMP($J,"RMPRPRT",CNT+4)=RMPRB
"RTN","RMPR9P22",79,0)
 S ^TMP($J,"RMPRPRT",CNT+5)="17. Signature of"
"RTN","RMPR9P22",80,0)
 S ^TMP($J,"RMPRPRT",CNT+5)=^TMP($J,"RMPRPRT",CNT+5)_"         18. DATE   19. Signature and Title of        20. Date"
"RTN","RMPR9P22",81,0)
 S ^TMP($J,"RMPRPRT",CNT+6)="    Requesting Official              Contracting/Accountable Officer"
"RTN","RMPR9P22",82,0)
 S ^TMP($J,"RMPRPRT",CNT+7)="    "_RDUZ_"                            "_RMPR("SIG")
"RTN","RMPR9P22",83,0)
 S ^TMP($J,"RMPRPRT",CNT+8)=RMPRB
"RTN","RMPR9P22",84,0)
 S ^TMP($J,"RMPRPRT",CNT+9)="                        Order and Receipt Action"
"RTN","RMPR9P22",85,0)
 S ^TMP($J,"RMPRPRT",CNT+10)=RMPRB
"RTN","RMPR9P22",86,0)
 S ^TMP($J,"RMPRPRT",CNT+11)="21. Order Number 22. Exp Date      23. Date Item Received   24. Date Delivered"
"RTN","RMPR9P22",87,0)
 I DUZ=$P(^RMPR(664,RMPRA,0),U,9)!($D(^XUSEC("RMPR FCP MANAGER",DUZ)))  D
"RTN","RMPR9P22",88,0)
 .N RMPRPRCD
"RTN","RMPR9P22",89,0)
 .S RMPRPRCD=$$DEC^RMPR4LI($P(^RMPR(664,RMPRA,4),U,1),$P(^RMPR(664,RMPRA,0),U,9),RMPRA)
"RTN","RMPR9P22",90,0)
 .S ^TMP($J,"RMPRPRT",CNT+12)=RMPRPRCD
"RTN","RMPR9P22",91,0)
 E  S ^TMP($J,"RMPRPRT",CNT+12)=" encrypted"
"RTN","RMPR9P22",92,0)
 S ^TMP($J,"RMPRPRT",CNT+13)=RMPRB
"RTN","RMPR9P22",93,0)
 S ^TMP($J,"RMPRPRT",CNT+14)="25. The articles or services listed herein have been received, or rendered"
"RTN","RMPR9P22",94,0)
 S ^TMP($J,"RMPRPRT",CNT+15)="ordered in the quantity and quality specified originally or as shown by"
"RTN","RMPR9P22",95,0)
 S ^TMP($J,"RMPRPRT",CNT+16)="authenticated changes, except as noted."
"RTN","RMPR9P22",96,0)
 S ^TMP($J,"RMPRPRT",CNT+17)=""
"RTN","RMPR9P22",97,0)
 S ^TMP($J,"RMPRPRT",CNT+18)="                                        Signature of Veteran or VA Official"
"RTN","RMPR9P22",98,0)
 S ^TMP($J,"RMPRPRT",CNT+19)=RMPRB
"RTN","RMPR9P22",99,0)
 S ^TMP($J,"RMPRPRT",CNT+20)="     Acct. Symbol "_$$STA^RMPRUTIL_"-"_$P($G(^RMPR(664,RMPRA,4)),U,5)
"RTN","RMPR9P22",100,0)
 S ^TMP($J,"RMPRPRT",CNT+21)=RMPRB
"RTN","RMPR9P22",101,0)
 S ^TMP($J,"RMPRPRT",CNT+22)="                                                    ADP Form 10-2421PC  APR 1991" S RMPRMOR1=1
"RTN","RMPR9P22",102,0)
 Q
"RTN","RMPR9PCD")
0^5^B3633017
"RTN","RMPR9PCD",1,0)
RMPR9PCD ;HOIFO/HNC - PURCHASE ORDER CHECK PA AUTHORIZATION ;JAN 2003
"RTN","RMPR9PCD",2,0)
 ;;3.0;PROSTHETICS;**90**;Feb 09, 1996
"RTN","RMPR9PCD",3,0)
 ;
"RTN","RMPR9PCD",4,0)
 Q
"RTN","RMPR9PCD",5,0)
B1(DUZ,SITE,RMPR668) G B2
"RTN","RMPR9PCD",6,0)
EN1(RESULTS,DUZ,SITE,RMPR668) ;broker entry point
"RTN","RMPR9PCD",7,0)
B2      ;
"RTN","RMPR9PCD",8,0)
 I '$D(^PRC(440.5,"H",DUZ)),'$D(^PRC(440.5,"C",DUZ)) S RESULTS(0)="1^You are not an authorized Purchase Card User, CONTACT FISCAL!"
"RTN","RMPR9PCD",9,0)
 S RMPRDFN=$P(^RMPR(668,RMPR668,0),U,2)
"RTN","RMPR9PCD",10,0)
 I '$D(^RMPR(665,RMPRDFN,0)) S RESULTS(0)="1^Patient not defined in PROSTHETICS PATIENT FILE please use the option: AP     Add/Edit Patient to Prosthetics and try again." Q
"RTN","RMPR9PCD",11,0)
 S (RMPRWHO,RMPRSC)="",(LINE,ALL)=0
"RTN","RMPR9PCD",12,0)
 S RMPRSC=$O(^RMPR(669.9,"PA",DUZ,RMPRSC)) Q:RMPRSC=""  D
"RTN","RMPR9PCD",13,0)
 . I '$D(^RMPR(669.9,RMPRSC,0)) Q
"RTN","RMPR9PCD",14,0)
 . I '$D(^RMPR(669.9,RMPRSC,5,"B",DUZ)) Q
"RTN","RMPR9PCD",15,0)
 . S RMPRWHO=$O(^RMPR(669.9,RMPRSC,5,"B",DUZ,""))
"RTN","RMPR9PCD",16,0)
 I RMPRWHO="" S RESULTS(0)="1^User Not Defined in Site Parmeters File." Q
"RTN","RMPR9PCD",17,0)
 S PPASSN=$P($G(^VA(200,DUZ,1)),U,9)
"RTN","RMPR9PCD",18,0)
 I PPASSN="" S RESULTS(0)="1^User Does Not have an SSN in File 200." Q
"RTN","RMPR9PCD",19,0)
 ;
"RTN","RMPR9PCD",20,0)
 D NOW^%DTC
"RTN","RMPR9PCD",21,0)
 K DD,DO
"RTN","RMPR9PCD",22,0)
 ;purchasing agent SSN
"RTN","RMPR9PCD",23,0)
 S $P(RESULTS(0),U,1)=PPASSN
"RTN","RMPR9PCD",24,0)
 S $P(RESULTS(0),U,2)=RMPRWHO
"RTN","RMPR9PCD",25,0)
 S $P(RESULTS(0),U,3)=RMPRDFN
"RTN","RMPR9PCD",26,0)
 Q
"RTN","RMPR9PCD",27,0)
EXIT ;common exit point
"RTN","RMPR9PCD",28,0)
 ;END
"RTN","RMPR9S4")
0^22^B29702431
"RTN","RMPR9S4",1,0)
RMPR9S4 ;HOIFO/HNC - GUI 2319ITEM TRANSACTIONS LIST ;9/10/02  08:42
"RTN","RMPR9S4",2,0)
 ;;3.0;PROSTHETICS;**59,99,90**;Feb 09, 1996
"RTN","RMPR9S4",3,0)
 ;IEN = INTERNAL ENTRY NUMBER OF FILE 668
"RTN","RMPR9S4",4,0)
 Q
"RTN","RMPR9S4",5,0)
A1(IEN) G A2
"RTN","RMPR9S4",6,0)
EN(RESULTS,IEN) ;broker
"RTN","RMPR9S4",7,0)
A2 S (RA,AN,ANS,RK,RZ)=0 K ^TMP($J,"TT"),^TMP($J,"AG"),IT
"RTN","RMPR9S4",8,0)
 K ^TMP($J,"RMPRB")
"RTN","RMPR9S4",9,0)
 K ^TMP($J,"RMPRC"),RMPRLPRO
"RTN","RMPR9S4",10,0)
 ;IT IS RESULTS
"RTN","RMPR9S4",11,0)
 ;0;2 DFN in 668
"RTN","RMPR9S4",12,0)
 S RMPRDFN=$P($G(^RMPR(668,IEN,0)),U,2)
"RTN","RMPR9S4",13,0)
 I RMPRDFN="" S ^TMP($J,"RMPRB",1)="PATIENT NOT KNOWN" Q
"RTN","RMPR9S4",14,0)
 MERGE ^TMP($J,"TT")=^RMPR(660,"AC",RMPRDFN)
"RTN","RMPR9S4",15,0)
 S B=0
"RTN","RMPR9S4",16,0)
 F  S B=$O(^TMP($J,"TT",B)) Q:B'>0  D
"RTN","RMPR9S4",17,0)
 . S BC=0
"RTN","RMPR9S4",18,0)
 . F  S BC=$O(^TMP($J,"TT",B,BC)) Q:BC'>0  D
"RTN","RMPR9S4",19,0)
 . .;Q:$P($G(^RMPR(660,BC,0)),U,10)'=RMPR("STA")
"RTN","RMPR9S4",20,0)
 . .S GN=$P($G(^RMPR(660,BC,"AMS")),U,1)
"RTN","RMPR9S4",21,0)
 . .S ND=$P($G(^RMPR(660,BC,1)),U,4)
"RTN","RMPR9S4",22,0)
 . .I ND S ND=$P(^RMPR(661.1,ND,0),U,8)
"RTN","RMPR9S4",23,0)
 . .S:ND="" ND=2
"RTN","RMPR9S4",24,0)
 . .S:GN="" GN=BC
"RTN","RMPR9S4",25,0)
 . .S ^TMP($J,"AG",GN,ND,BC)=B
"RTN","RMPR9S4",26,0)
 S B=""
"RTN","RMPR9S4",27,0)
 F  S B=$O(^TMP($J,"AG",B)) Q:B'>0  D
"RTN","RMPR9S4",28,0)
 .S BC=""
"RTN","RMPR9S4",29,0)
 .F  S BC=$O(^TMP($J,"AG",B,BC)) Q:BC'>0  D
"RTN","RMPR9S4",30,0)
 . .Q:BC=2
"RTN","RMPR9S4",31,0)
 . .MERGE ^TMP($J,"AGG")=^TMP($J,"AG",B)
"RTN","RMPR9S4",32,0)
 . .S HC="",GTCST=0
"RTN","RMPR9S4",33,0)
 . .K HCC1
"RTN","RMPR9S4",34,0)
 . .F  S HC=$O(^TMP($J,"AGG",HC)) Q:HC'>0  D
"RTN","RMPR9S4",35,0)
 . . .S HCC=0
"RTN","RMPR9S4",36,0)
 . . .;changes for Surgical Implants
"RTN","RMPR9S4",37,0)
 . . .S BDC=""
"RTN","RMPR9S4",38,0)
 . . .F BDC=1:1 S HCC=$O(^TMP($J,"AGG",HC,HCC)) Q:HCC'>0  D
"RTN","RMPR9S4",39,0)
 . . . .S GTCST=GTCST+$P(^RMPR(660,HCC,0),U,16)
"RTN","RMPR9S4",40,0)
 . . . .I BDC=1&(HC'=2) S HCC1=HCC
"RTN","RMPR9S4",41,0)
 . . . .I BDC'=1 K ^TMP($J,"TT",^TMP($J,"AGG",HC,HCC),HCC)
"RTN","RMPR9S4",42,0)
 . . . .I HC=2 K ^TMP($J,"TT",^TMP($J,"AGG",HC,HCC),HCC)
"RTN","RMPR9S4",43,0)
 . .I $G(HCC1) S $P(^TMP($J,"TT",^TMP($J,"AGG",1,HCC1),HCC1),U,3)=GTCST K HCC1
"RTN","RMPR9S4",44,0)
 . .K GTCST,^TMP($J,"AGG")
"RTN","RMPR9S4",45,0)
 K ^TMP($J,"AG"),BDC
"RTN","RMPR9S4",46,0)
 S B=0,RC=1
"RTN","RMPR9S4",47,0)
 F  S B=$O(^TMP($J,"TT",B)) Q:B'>0  D
"RTN","RMPR9S4",48,0)
 .S RK=0
"RTN","RMPR9S4",49,0)
 .F  S RK=$O(^TMP($J,"TT",B,RK)) Q:RK'>0  D
"RTN","RMPR9S4",50,0)
 . .Q:$D(^RMPO(665.72,"AC",RK))
"RTN","RMPR9S4",51,0)
 . .S ^TMP($J,"RMPRC",RC)=RK
"RTN","RMPR9S4",52,0)
 . .I $P(^TMP($J,"TT",B,RK),U,3) S $P(^TMP($J,"RMPRC",RC),U,3)=$P(^TMP($J,"TT",B,RK),U,3)
"RTN","RMPR9S4",53,0)
 . .S RC=RC+1
"RTN","RMPR9S4",54,0)
 S RK=0,RZ=0
"RTN","RMPR9S4",55,0)
 K ^TMP($J,"TT"),B
"RTN","RMPR9S4",56,0)
 ;
"RTN","RMPR9S4",57,0)
 G:'$D(^TMP($J,"RMPRC")) END
"RTN","RMPR9S4",58,0)
 ;
"RTN","RMPR9S4",59,0)
DIS ;format data string - ALL
"RTN","RMPR9S4",60,0)
 S RC=""
"RTN","RMPR9S4",61,0)
 S RK=0
"RTN","RMPR9S4",62,0)
 F  S RK=$O(^TMP($J,"RMPRC",RK)) Q:RK=""  D
"RTN","RMPR9S4",63,0)
 .S AN=+^TMP($J,"RMPRC",RK)
"RTN","RMPR9S4",64,0)
 .S RMPRY=$G(^RMPR(660,AN,0))
"RTN","RMPR9S4",65,0)
 .I RMPRY'="" D PRT
"RTN","RMPR9S4",66,0)
 .Q
"RTN","RMPR9S4",67,0)
 ;
"RTN","RMPR9S4",68,0)
 ;
"RTN","RMPR9S4",69,0)
END I RC=0 S ^TMP($J,"RMPRB",1)="NOTHING TO REPORT" G EXIT
"RTN","RMPR9S4",70,0)
 ;
"RTN","RMPR9S4",71,0)
 ;
"RTN","RMPR9S4",72,0)
EXIT ;common exit point
"RTN","RMPR9S4",73,0)
 ;pass to broker
"RTN","RMPR9S4",74,0)
 K ^TMP($J,"RMPRC")
"RTN","RMPR9S4",75,0)
 ;S RESULT=$NA(^TMP($J))
"RTN","RMPR9S4",76,0)
 M RESULTS=^TMP($J,"RMPRB")
"RTN","RMPR9S4",77,0)
 I '$D(RESULTS) S RESULTS(0)="NOTHING TO REPORT"
"RTN","RMPR9S4",78,0)
 K I,J,L,R0,RA
"RTN","RMPR9S4",79,0)
 Q
"RTN","RMPR9S4",80,0)
PRT ;
"RTN","RMPR9S4",81,0)
 S DATE=$P(RMPRY,U,3),TYPE=$P(RMPRY,U,6),QTY=$P(RMPRY,U,7)
"RTN","RMPR9S4",82,0)
 S VEN=$P(RMPRY,U,9),TRANS=$P(RMPRY,U,4),STA=$P(RMPRY,U,10),SN=$P(RMPRY,U,11)
"RTN","RMPR9S4",83,0)
 S DEL=$P(RMPRY,U,12)
"RTN","RMPR9S4",84,0)
 S CST=$S($P(RMPRY,U,16)'="":$P(RMPRY,U,16),$D(^RMPR(660,AN,"LB")):$P(^RMPR(660,AN,"LB"),U,9),1:"")
"RTN","RMPR9S4",85,0)
 ;lab source of procurement
"RTN","RMPR9S4",86,0)
 I $D(^RMPR(660,AN,"LB")) S RMPRLPRO=$P(^("LB"),U,3) D
"RTN","RMPR9S4",87,0)
 .I RMPRLPRO="O" S RMPRLPRO="ORTHOTIC" Q
"RTN","RMPR9S4",88,0)
 .I RMPRLPRO="R" S RMPRLPRO="RESTORATION" Q
"RTN","RMPR9S4",89,0)
 .I RMPRLPRO="S" S RMPRLPRO="SHOE" Q
"RTN","RMPR9S4",90,0)
 .I RMPRLPRO="W" S RMPRLPRO="WHEELCHAIR" Q
"RTN","RMPR9S4",91,0)
 .I RMPRLPRO="N" S RMPRLPRO="FOOT CENTER" Q
"RTN","RMPR9S4",92,0)
 .I RMPRLPRO="D" S RMPRLPRO="DDC" Q
"RTN","RMPR9S4",93,0)
 ;form requested on
"RTN","RMPR9S4",94,0)
 S FRM=$P(RMPRY,U,13),REM=$P(RMPRY,U,18)
"RTN","RMPR9S4",95,0)
 S DATE=$$DAT2^RMPRUTL1(DATE)
"RTN","RMPR9S4",96,0)
 S TYPE=$P($G(^RMPR(660,AN,1)),U,4)
"RTN","RMPR9S4",97,0)
 ;S TYPE=$S(TYPE="":"",$D(^RMPR(661,TYPE,0)):$P(^(0),U,1),1:"")
"RTN","RMPR9S4",98,0)
 S AMIS=$P(RMPRY,U,15),VEN=$S(VEN="":"",$D(^PRC(440,VEN,0)):$P(^(0),U,1),1:"")
"RTN","RMPR9S4",99,0)
 I $D(^RMPR(660.1,"AC",AN)),$P(^RMPR(660.1,$O(^RMPR(660.1,"AC",AN,0)),0),U,11)]"" S AMIS=AMIS_"+"
"RTN","RMPR9S4",100,0)
 S TRANS=$S(TRANS]"":TRANS,1:""),TRANS1="" S:TRANS="X" TRANS1=TRANS,TRANS=""
"RTN","RMPR9S4",101,0)
 S DEL=$E(DEL,4,5)_"/"_$E(DEL,6,7)_"/"_$E(DEL,2,3) S:DEL="//" DEL=""
"RTN","RMPR9S4",102,0)
 ;
"RTN","RMPR9S4",103,0)
 ;set results array
"RTN","RMPR9S4",104,0)
 ;
"RTN","RMPR9S4",105,0)
 S HTYPE=""
"RTN","RMPR9S4",106,0)
 I $D(^RMPR(660,$P(^TMP($J,"RMPRC",RK),U,1),"HST")) S HTYPE=$E(^RMPR(660,$P(^TMP($J,"RMPRC",RK),U,1),"HST"),1,15)
"RTN","RMPR9S4",107,0)
 S ITEM=AMIS_$S(TYPE'="":$P($G(^RMPR(661.1,TYPE,0)),U,2),$P(RMPRY,U,26)="D":"DELIVERY",$P(RMPRY,U,26)="P":"PICKUP",$P(RMPRY,U,17):"SHIPPING",HTYPE'="":HTYPE,1:"")
"RTN","RMPR9S4",108,0)
 K HTYPE
"RTN","RMPR9S4",109,0)
 ;
"RTN","RMPR9S4",110,0)
 S HCPCS=$P($G(^RMPR(660,$P(^TMP($J,"RMPRC",RK),U,1),1)),U,4)
"RTN","RMPR9S4",111,0)
 I HCPCS'="" S HCPCS=$P($G(^RMPR(661.1,HCPCS,0)),U,1)
"RTN","RMPR9S4",112,0)
 ;
"RTN","RMPR9S4",113,0)
 S ^TMP($J,"RMPRB",RK)=$P(^TMP($J,"RMPRC",RK),U,1)_U_DATE_U_QTY_U_ITEM
"RTN","RMPR9S4",114,0)
 S ^TMP($J,"RMPRB",RK)=^TMP($J,"RMPRB",RK)_U_HCPCS_U_TRANS_TRANS1
"RTN","RMPR9S4",115,0)
 ;
"RTN","RMPR9S4",116,0)
 ;display source of procurement for 2529-3 under vendor header
"RTN","RMPR9S4",117,0)
 I $D(RMPRLPRO) S ^TMP($J,"RMPRB",RK)=^TMP($J,"RMPRB",RK)_U_RMPRLPRO
"RTN","RMPR9S4",118,0)
 ;E  S ^TMP($J,"RMPRB",RK)=^TMP($J,"RMPRB",RK)_U_VEN
"RTN","RMPR9S4",119,0)
 ;I '$D(RMPRLPRO),VEN'="" 
"RTN","RMPR9S4",120,0)
 E  S:VEN'="" ^TMP($J,"RMPRB",RK)=^TMP($J,"RMPRB",RK)_U_$E(VEN,1,10)
"RTN","RMPR9S4",121,0)
 I VEN=""&'$D(RMPRLPRO) S:'$D(^RMPR(660,$P(^TMP($J,"RMPRC",RK),U,1),"HST")) ^TMP($J,"RMPRB",RK)=^TMP($J,"RMPRB",RK)_U_$E(VEN,1,10)
"RTN","RMPR9S4",122,0)
 I VEN=""&'$D(RMPRLPRO) S:$D(^RMPR(660,$P(^TMP($J,"RMPRC",RK),U,1),"HST")) ^TMP($J,"RMPRB",RK)=^TMP($J,"RMPRB",RK)_U_$E($P(^RMPR(660,$P(^TMP($J,"RMPRC",RK),U,1),"HST"),U,3),1,10)
"RTN","RMPR9S4",123,0)
 ;
"RTN","RMPR9S4",124,0)
 I STA'="" S ^TMP($J,"RMPRB",RK)=^TMP($J,"RMPRB",RK)_U_$P($G(^DIC(4,STA,99)),U,1)
"RTN","RMPR9S4",125,0)
 I STA="" S ^TMP($J,"RMPRB",RK)=^TMP($J,"RMPRB",RK)_U_"UNKNOWN"
"RTN","RMPR9S4",126,0)
 S ^TMP($J,"RMPRB",RK)=^TMP($J,"RMPRB",RK)_U_SN_U_DEL
"RTN","RMPR9S4",127,0)
 I $P(^TMP($J,"RMPRC",RK),U,3) S CST=$P(^TMP($J,"RMPRC",RK),U,3)
"RTN","RMPR9S4",128,0)
 S COST=$J($FN($S(CST'="":CST,$P(RMPRY,U,17):$P(RMPRY,U,17),1:""),"T",2),9)
"RTN","RMPR9S4",129,0)
 ;
"RTN","RMPR9S4",130,0)
 S ^TMP($J,"RMPRB",RK)=^TMP($J,"RMPRB",RK)_U_COST_U_REM
"RTN","RMPR9S4",131,0)
 ;
"RTN","RMPR9S4",132,0)
 I $P(^TMP($J,"RMPRC",RK),U,2)="" S $P(^TMP($J,"RMPRC",RK),U,2)=RZ
"RTN","RMPR9S4",133,0)
 K DATE,QTY,ITEM,HCPSC,RMPRLPRO,VEN,SN,DEL,COST,REM
"RTN","RMPR9S4",134,0)
 ;
"RTN","RMPR9S4",135,0)
 Q
"RTN","RMPR9S4",136,0)
 ;END
"RTN","RMPR9S4E")
0^23^B41319639
"RTN","RMPR9S4E",1,0)
RMPR9S4E ;HOIFO/SPS-GUI 2319 Extended Display Transaction screen 4 ;12/17/02  09:35
"RTN","RMPR9S4E",2,0)
 ;;3.0;PROSTHETICS;**59,92,99,90**;Feb 09, 1996
"RTN","RMPR9S4E",3,0)
 ;
"RTN","RMPR9S4E",4,0)
 ;         (IEN)=ien of file 660
"RTN","RMPR9S4E",5,0)
 ;
"RTN","RMPR9S4E",6,0)
 ;AAC Patch 92 08/04/04 - Code Set Versioning (CSV)
"RTN","RMPR9S4E",7,0)
 ;Used API=ICDDX^ICDCODE to replace direct calls to global ICD9(80)
"RTN","RMPR9S4E",8,0)
 ;
"RTN","RMPR9S4E",9,0)
 ;
"RTN","RMPR9S4E",10,0)
 ;display detailed record
"RTN","RMPR9S4E",11,0)
A1(IEN) G A2
"RTN","RMPR9S4E",12,0)
EN(RESULTS,IEN) ;Broker
"RTN","RMPR9S4E",13,0)
A2 ;
"RTN","RMPR9S4E",14,0)
 I +IEN'>0 S RESULTS(0)="NOTHING TO REPORT" G EXIT
"RTN","RMPR9S4E",15,0)
 I '$D(^RMPR(660,IEN)) S RESULTS(0)="NOTHING TO REPORT" G EXIT
"RTN","RMPR9S4E",16,0)
 N DIC,DIQ,DR,DA,RMPRV,RMPRDA,RV
"RTN","RMPR9S4E",17,0)
 S DIC=660,DIQ="R19",DR=".01:96",DIQ(0)="EN"
"RTN","RMPR9S4E",18,0)
 S (RMPRDA,DA)=(IEN)
"RTN","RMPR9S4E",19,0)
 D EN^DIQ1
"RTN","RMPR9S4E",20,0)
 S DIQ="R19",DR=72,DIQ(0)="I" D EN^DIQ1
"RTN","RMPR9S4E",21,0)
 ;get vendor info
"RTN","RMPR9S4E",22,0)
 S DA=$P(^RMPR(660,RMPRDA,0),U,9)
"RTN","RMPR9S4E",23,0)
 I DA D
"RTN","RMPR9S4E",24,0)
 .S DIC=440,DIQ="RV",DR=".01:6",DIQ(0)="EN"
"RTN","RMPR9S4E",25,0)
 .S (RMPRV,DA)=$P(^RMPR(660,RMPRDA,0),U,9)
"RTN","RMPR9S4E",26,0)
 .D EN^DIQ1
"RTN","RMPR9S4E",27,0)
 ;
"RTN","RMPR9S4E",28,0)
 ;array defined for record in following format:
"RTN","RMPR9S4E",29,0)
 ;R19(filenumber,ien,field,E)=external form of data
"RTN","RMPR9S4E",30,0)
 ;RV(filenumber,ien,field,E)=external form of data
"RTN","RMPR9S4E",31,0)
 ;example:
"RTN","RMPR9S4E",32,0)
 ;R19(660,100,.01,"E")=APR 27, 1995
"RTN","RMPR9S4E",33,0)
 ;R19(660,100,.02,"E")=NAME,PATIENT
"RTN","RMPR9S4E",34,0)
 ;RV(440,131,.01,"E")=ORTHOTIC LAB
"RTN","RMPR9S4E",35,0)
 S RMPRDFN=$P(^RMPR(660,RMPRDA,0),U,2)
"RTN","RMPR9S4E",36,0)
 S RMPRNAM=$P(^DPT(RMPRDFN,0),U),RMPRSSN=$P(^(0),U,9),RMPRDOB=$P(^(0),U,3)
"RTN","RMPR9S4E",37,0)
 ;
"RTN","RMPR9S4E",38,0)
 D HDR
"RTN","RMPR9S4E",39,0)
 ; "TYPE OF FORM: ",
"RTN","RMPR9S4E",40,0)
 S RESULTS(5)=$G(R19(660,RMPRDA,11,"E"))
"RTN","RMPR9S4E",41,0)
 ; "INITIATOR: ",
"RTN","RMPR9S4E",42,0)
 S RESULTS(6)=$G(R19(660,RMPRDA,27,"E"))
"RTN","RMPR9S4E",43,0)
 ; "DATE: ",
"RTN","RMPR9S4E",44,0)
 S RESULTS(7)=$G(R19(660,RMPRDA,1,"E"))
"RTN","RMPR9S4E",45,0)
 ; "DELIVER TO: ",
"RTN","RMPR9S4E",46,0)
 S RESULTS(8)=$G(R19(660,RMPRDA,25,"E"))
"RTN","RMPR9S4E",47,0)
 ; "TYPE TRANS: ",
"RTN","RMPR9S4E",48,0)
 S RESULTS(9)=$G(R19(660,RMPRDA,2,"E"))
"RTN","RMPR9S4E",49,0)
 ; "QTY: ",
"RTN","RMPR9S4E",50,0)
 S RESULTS(10)=$G(R19(660,RMPRDA,5,"E"))
"RTN","RMPR9S4E",51,0)
 ; "INVENTORY POINT: "
"RTN","RMPR9S4E",52,0)
 S RESULTS(11)=$G(R19(660,RMPRDA,29,"E"))
"RTN","RMPR9S4E",53,0)
 ; "SOURCE: ",
"RTN","RMPR9S4E",54,0)
 S RESULTS(12)=$G(R19(660,RMPRDA,12,"E"))
"RTN","RMPR9S4E",55,0)
 ;vendor tracking number
"RTN","RMPR9S4E",56,0)
 S (RESULTS(13),RESULTS(14))=""
"RTN","RMPR9S4E",57,0)
 I $G(R19(660,RMPRDA,11,"E"))="VISA" D
"RTN","RMPR9S4E",58,0)
 .; "VENDOR TRACKING: ",
"RTN","RMPR9S4E",59,0)
 .S RESULTS(13)=$G(R19(660,RMPRDA,4.2,"E"))
"RTN","RMPR9S4E",60,0)
 .; "BANK AUTHORIZATION: ",
"RTN","RMPR9S4E",61,0)
 .S RESULTS(14)=$G(R19(660,RMPRDA,38.7,"E"))
"RTN","RMPR9S4E",62,0)
 ; "VENDOR: ",
"RTN","RMPR9S4E",63,0)
 S RESULTS(15)=$G(R19(660,RMPRDA,7,"E"))
"RTN","RMPR9S4E",64,0)
 ; VENDOR PHONE AND ADDRESS INFO
"RTN","RMPR9S4E",65,0)
 F I=16:1:20 S RESULTS(I)=""
"RTN","RMPR9S4E",66,0)
 I $D(RV) D
"RTN","RMPR9S4E",67,0)
 .; "VENDOR PHONE: and Address ",
"RTN","RMPR9S4E",68,0)
 .S RESULTS(16)=$G(RV(440,RMPRV,5,"E"))
"RTN","RMPR9S4E",69,0)
 .S RESULTS(17)=$G(RV(440,RMPRV,1,"E"))
"RTN","RMPR9S4E",70,0)
 .S RESULTS(18)=$G(RV(440,RMPRV,4.2,"E"))
"RTN","RMPR9S4E",71,0)
 .S RESULTS(19)=$G(RV(440,RMPRV,4.4,"E"))
"RTN","RMPR9S4E",72,0)
 .S RESULTS(20)=$G(RV(440,RMPRV,4.6,"E"))
"RTN","RMPR9S4E",73,0)
 ; "DELIVERY DATE: "
"RTN","RMPR9S4E",74,0)
 S RESULTS(21)=$G(R19(660,RMPRDA,10,"E"))
"RTN","RMPR9S4E",75,0)
 ; "TOTAL COST: "
"RTN","RMPR9S4E",76,0)
 S RESULTS(22)=0.00
"RTN","RMPR9S4E",77,0)
 I $G(R19(660,RMPRDA,14,"E"))'="" S RESULTS(22)="$"_$FN(R19(660,RMPRDA,14,"E"),"T",2)
"RTN","RMPR9S4E",78,0)
 I $G(R19(660,RMPRDA,14,"E"))="" S RESULTS(22)=$S($G(R19(660,RMPRDA,6,"E"))'="":"$"_$FN(R19(660,RMPRDA,6,"E"),"T",2),$G(R19(660,RMPRDA,48,"E"))'="":"$"_$FN(R19(660,RMPRDA,48,"E"),"T",2),1:"")
"RTN","RMPR9S4E",79,0)
 ; "OBL: ",
"RTN","RMPR9S4E",80,0)
 S RESULTS(23)=$G(R19(660,RMPRDA,23,"E"))
"RTN","RMPR9S4E",81,0)
 ;
"RTN","RMPR9S4E",82,0)
 ;lab data
"RTN","RMPR9S4E",83,0)
 F I=24:1:32 S RESULTS(I)=""
"RTN","RMPR9S4E",84,0)
 I $D(^RMPR(660,RMPRDA,"LB")) D
"RTN","RMPR9S4E",85,0)
 .N DIC,DIQ,DR,L19,DA
"RTN","RMPR9S4E",86,0)
 .S (DA,RMPRLA)=$P(^RMPR(660,RMPRDA,"LB"),U,10)
"RTN","RMPR9S4E",87,0)
 .Q:DA=""
"RTN","RMPR9S4E",88,0)
 .S DIC=664.1,DIQ="L19",DR="15",DIQ(0)="E"
"RTN","RMPR9S4E",89,0)
 .D EN^DIQ1
"RTN","RMPR9S4E",90,0)
 .; "WORK ORDER: ",
"RTN","RMPR9S4E",91,0)
 .S RESULTS(24)=$G(R19(660,RMPRDA,71,"E"))
"RTN","RMPR9S4E",92,0)
 .; "RECEIVING STATION: ",
"RTN","RMPR9S4E",93,0)
 .S RESULTS(25)=$G(R19(660,RMPRDA,70,"E"))
"RTN","RMPR9S4E",94,0)
 .; "TECHNICIAN: ",
"RTN","RMPR9S4E",95,0)
 .S RESULTS(26)=$G(L19(664.1,RMPRLA,15,"E"))
"RTN","RMPR9S4E",96,0)
 .; "TOTAL LABOR HOURS: ",
"RTN","RMPR9S4E",97,0)
 .S RESULTS(27)=$G(R19(660,RMPRDA,45,"E"))
"RTN","RMPR9S4E",98,0)
 .; "TOTAL LABOR COST: ",
"RTN","RMPR9S4E",99,0)
 .S RESULTS(28)=$G(R19(660,RMPRDA,46,"E"))
"RTN","RMPR9S4E",100,0)
 .; "TOTAL MATERIAL COST: ",
"RTN","RMPR9S4E",101,0)
 .S RESULTS(29)=$G(R19(660,RMPRDA,47,"E"))
"RTN","RMPR9S4E",102,0)
 .; "TOTAL LAB COST: ",
"RTN","RMPR9S4E",103,0)
 .S RESULTS(30)=$G(R19(660,RMPRDA,48,"E"))
"RTN","RMPR9S4E",104,0)
 .; "COMPLETION DATE: ",
"RTN","RMPR9S4E",105,0)
 .S RESULTS(31)=$G(R19(660,RMPRDA,50,"E"))
"RTN","RMPR9S4E",106,0)
 .; "LAB REMARKS: ",
"RTN","RMPR9S4E",107,0)
 .S RESULTS(32)=$G(R19(660,RMPRDA,51,"E"))
"RTN","RMPR9S4E",108,0)
 ; "REMARKS: ",
"RTN","RMPR9S4E",109,0)
 S RESULTS(33)=$G(R19(660,RMPRDA,16,"E"))
"RTN","RMPR9S4E",110,0)
 ; "RETURN STATUS: ",
"RTN","RMPR9S4E",111,0)
 S RESULTS(34)=$G(R19(660,RMPRDA,17.5,"E"))
"RTN","RMPR9S4E",112,0)
 ;
"RTN","RMPR9S4E",113,0)
 ; CoreFLS Data used to be/and same as historical data
"RTN","RMPR9S4E",114,0)
 F I=35:1:42 S RESULTS(I)=""
"RTN","RMPR9S4E",115,0)
 I $G(R19(660,RMPRDA,15,"E"))["*" D
"RTN","RMPR9S4E",116,0)
 .;include records that have been merged
"RTN","RMPR9S4E",117,0)
 .; "COREFLS/HISTORICAL DATA",!
"RTN","RMPR9S4E",118,0)
 .Q:'$D(R19(660,RMPRDA,89))
"RTN","RMPR9S4E",119,0)
 .; "ITEM: ",
"RTN","RMPR9S4E",120,0)
 .S RESULTS(35)=$G(R19(660,RMPRDA,89,"E"))
"RTN","RMPR9S4E",121,0)
 .; "STATION: ",
"RTN","RMPR9S4E",122,0)
 .S RESULTS(36)=$G(R19(660,RMPRDA,90,"E"))
"RTN","RMPR9S4E",123,0)
 .; "VENDOR: ",
"RTN","RMPR9S4E",124,0)
 .S RESULTS(37)=$G(R19(660,RMPRDA,91,"E"))
"RTN","RMPR9S4E",125,0)
 .; "   PHONE: ",
"RTN","RMPR9S4E",126,0)
 .S RESULTS(38)=$G(R19(660,RMPRDA,92,"E"))
"RTN","RMPR9S4E",127,0)
 .; " STREET
"RTN","RMPR9S4E",128,0)
 .S RESULTS(39)=$G(R19(660,RMPRDA,93,"E"))
"RTN","RMPR9S4E",129,0)
 .; CITY
"RTN","RMPR9S4E",130,0)
 .S RESULTS(40)=$G(R19(660,RMPRDA,94,"E"))
"RTN","RMPR9S4E",131,0)
 .; STATE
"RTN","RMPR9S4E",132,0)
 .S RESULTS(41)=$G(R19(660,RMPRDA,95,"E"))
"RTN","RMPR9S4E",133,0)
 .; ZIP
"RTN","RMPR9S4E",134,0)
 .S RESULTS(42)=$G(R19(660,RMPRDA,96,"E"))
"RTN","RMPR9S4E",135,0)
 ;put in lab display here fields 45,46,47,48 and 51
"RTN","RMPR9S4E",136,0)
 ;lab amis
"RTN","RMPR9S4E",137,0)
 F I=43:1:44 S RESULTS(I)=""
"RTN","RMPR9S4E",138,0)
 I $G(R19(660,RMPRDA,73,"E")) D
"RTN","RMPR9S4E",139,0)
 .; "ORTHOTICS LAB CODE: "
"RTN","RMPR9S4E",140,0)
 .S RESULTS(43)=$S($D(R19(660,RMPRDA,74,"E")):R19(660,RMPRDA,74,"E"),$D(R19(660,RMPRDA,75,"E")):R19(660,RMPRDA,75,"E"),1:"")
"RTN","RMPR9S4E",141,0)
 .; "RESTORATIONS LAB CODE: "
"RTN","RMPR9S4E",142,0)
 .S RESULTS(44)=$S($D(R19(660,RMPRDA,76,"E")):R19(660,RMPRDA,76,"E"),$D(R19(660,RMPRDA,77,"E")):R19(660,RMPRDA,77,"E"),1:"")
"RTN","RMPR9S4E",143,0)
 ;purchasing and issue from stock amis
"RTN","RMPR9S4E",144,0)
 ; "DISABILITY SERVED: ",
"RTN","RMPR9S4E",145,0)
 S RESULTS(45)=$G(R19(660,RMPRDA,62,"E"))
"RTN","RMPR9S4E",146,0)
 ;appliance/item information
"RTN","RMPR9S4E",147,0)
 ; "APPLIANCE: ",
"RTN","RMPR9S4E",148,0)
 ;S RESULTS(46)=$G(R19(660,RMPRDA,4,"E"))
"RTN","RMPR9S4E",149,0)
 S RESULTS(46)=$G(R19(660,RMPRDA,89,"E"))
"RTN","RMPR9S4E",150,0)
 ; "PSAS HCPCS: ",
"RTN","RMPR9S4E",151,0)
 S RESULTS(47)=$G(R19(660,RMPRDA,4.5,"E"))
"RTN","RMPR9S4E",152,0)
 ; "PSAS HCPCS DESC.
"RTN","RMPR9S4E",153,0)
 S RESULTS(48)=""
"RTN","RMPR9S4E",154,0)
 I $P($G(^RMPR(660,RMPRDA,1)),U,4) S RESULTS(48)=$P($G(^RMPR(661.1,$P(^RMPR(660,RMPRDA,1),U,4),0)),U,2)
"RTN","RMPR9S4E",155,0)
 ;added by #69
"RTN","RMPR9S4E",156,0)
 ;
"RTN","RMPR9S4E",157,0)
 ; Patch 92 - Code Set Versioning (CSV) changes below inserted afer the line above for #69
"RTN","RMPR9S4E",158,0)
 ; AAC - 08/04/04
"RTN","RMPR9S4E",159,0)
 ;
"RTN","RMPR9S4E",160,0)
 S (RMPRICD,RMPRIC0,RMPRCOD,RMPRIC9,RESULTS(49))="" S RMPRERR=0
"RTN","RMPR9S4E",161,0)
 S RMPRDAT=$G(R19(660,RMPRDA,.01,"E"))
"RTN","RMPR9S4E",162,0)
 I $D(^RMPR(660,RMPRDA,10)) S RMPRIC9=$P(^RMPR(660,RMPRDA,10),U,8)
"RTN","RMPR9S4E",163,0)
 I RMPRIC9'=""  D
"RTN","RMPR9S4E",164,0)
 .S RMPRICD=$$ICDDX^ICDCODE(RMPRIC9,RMPRDAT)
"RTN","RMPR9S4E",165,0)
 .S RMPRERR=$P(RMPRICD,U,1)
"RTN","RMPR9S4E",166,0)
 .I RMPRERR<0 S RESULTS(49)=$P(RMPRICD,U,2)
"RTN","RMPR9S4E",167,0)
ZZ ;
"RTN","RMPR9S4E",168,0)
 I RMPRERR>0 S RESULTS(49)=$P(RMPRICD,U,2)_" "_$E($P(RMPRICD,U,4),1,55) I $P(RMPRICD,U,10)'>0 S RESULTS(49)=RESULTS(49)_" "_"** Inactive ** Date: " S Y=$P(RMPRICD,U,12) D DD^%DT S RESULTS(49)=RESULTS(49)_" "_Y
"RTN","RMPR9S4E",169,0)
 ; "ICD-9 Code: ",
"RTN","RMPR9S4E",170,0)
 ; S RESULTS(49)=RMPRICC_"    "_$E($G(^ICD9(RMPRIC9,1)),1,55)
"RTN","RMPR9S4E",171,0)
 ;
"RTN","RMPR9S4E",172,0)
 ; End Patch 92
"RTN","RMPR9S4E",173,0)
 ;
"RTN","RMPR9S4E",174,0)
 ; "CPT MODIFIER: ",
"RTN","RMPR9S4E",175,0)
 S RESULTS(50)=$G(R19(660,RMPRDA,38.1,"E"))
"RTN","RMPR9S4E",176,0)
 ; "DESCRIPTION: ",
"RTN","RMPR9S4E",177,0)
 S RESULTS(51)=$G(R19(660,RMPRDA,24,"E"))
"RTN","RMPR9S4E",178,0)
 ; ,"EXTENDED DESCRIPTION: ",!
"RTN","RMPR9S4E",179,0)
 N R28
"RTN","RMPR9S4E",180,0)
 I $D(R19(660,RMPRDA,28)) D
"RTN","RMPR9S4E",181,0)
 .;command part of new standards
"RTN","RMPR9S4E",182,0)
 .MERGE R28=R19(660,RMPRDA,28)
"RTN","RMPR9S4E",183,0)
 S LN=0,CNT=52
"RTN","RMPR9S4E",184,0)
 F  S LN=$O(R28(LN)) Q:LN'>0  D
"RTN","RMPR9S4E",185,0)
 .S RESULTS(CNT)=R28(LN)
"RTN","RMPR9S4E",186,0)
 .S CNT=CNT+1
"RTN","RMPR9S4E",187,0)
 G EXIT
"RTN","RMPR9S4E",188,0)
 ;
"RTN","RMPR9S4E",189,0)
HDR ;display heading
"RTN","RMPR9S4E",190,0)
 S RESULTS(1)=RMPRNAM
"RTN","RMPR9S4E",191,0)
 ; " SSN: "
"RTN","RMPR9S4E",192,0)
 S RESULTS(2)=$E(RMPRSSN,1,3)_"-"_$E(RMPRSSN,4,5)_"-"_$E(RMPRSSN,6,10)
"RTN","RMPR9S4E",193,0)
 S RESULTS(3)=$G(R19(660,RMPRDA,8,"E"))
"RTN","RMPR9S4E",194,0)
 ; "DOB: "
"RTN","RMPR9S4E",195,0)
 S RESULTS(4)=$S(RMPRDOB:$E(RMPRDOB,4,5)_"-"_$E(RMPRDOB,6,7)_"-"_(1700+$E(RMPRDOB,1,3)),1:"Unknown")
"RTN","RMPR9S4E",196,0)
 Q
"RTN","RMPR9S4E",197,0)
EXIT ;common exit point
"RTN","RMPR9S4E",198,0)
 I '$D(RESULTS) S RESULTS(0)="NOTHING TO REPORT"
"RTN","RMPR9S4E",199,0)
 K R19,RV,RMPRICC,RMPRICD,RMPRIC9,RMPRCOD,RMPRDAT,RMPRERR,RMPRIC0,Y
"RTN","RMPR9S4E",200,0)
 Q
"RTN","RMPR9S4E",201,0)
 ;end
"RTN","RMPR9S6")
0^42^B650496
"RTN","RMPR9S6",1,0)
RMPR9S6 ;HOIFO/HNC - GUI 2319 CRITICAL COMMENTS ;9/23/02  08:25
"RTN","RMPR9S6",2,0)
 ;;3.0;PROSTHETICS;**59,90**;Feb 09, 1996
"RTN","RMPR9S6",3,0)
A1(IEN) G A2
"RTN","RMPR9S6",4,0)
EN(RESULTS,IEN) ;broker entry point
"RTN","RMPR9S6",5,0)
A2 ;
"RTN","RMPR9S6",6,0)
 S RMPRDFN=$P($G(^RMPR(668,IEN,0)),U,2)
"RTN","RMPR9S6",7,0)
 I RMPRDFN="" S RESULTS(0)="NOTHING TO REPORT" G EXIT
"RTN","RMPR9S6",8,0)
 ;
"RTN","RMPR9S6",9,0)
 D GETS^DIQ(665,RMPRDFN,"30","E","RA")
"RTN","RMPR9S6",10,0)
 I '$D(RA) S RESULTS(0)="NOTHING TO REPORT" G EXIT
"RTN","RMPR9S6",11,0)
 ;
"RTN","RMPR9S6",12,0)
 ;RA(665,"RMPRDFN,",30,1)=THIS IS LINE ONE
"RTN","RMPR9S6",13,0)
 ;
"RTN","RMPR9S6",14,0)
 S LN=0,CNT=0
"RTN","RMPR9S6",15,0)
 F  S LN=$O(RA(665,RMPRDFN_",",30,LN)) Q:LN'>0  D
"RTN","RMPR9S6",16,0)
 .S RESULTS(CNT)=RA(665,RMPRDFN_",",30,LN)
"RTN","RMPR9S6",17,0)
 .S CNT=CNT+1
"RTN","RMPR9S6",18,0)
 ;
"RTN","RMPR9S6",19,0)
EXIT ;common exit point
"RTN","RMPR9S6",20,0)
 K RA,LN,CNT
"RTN","RMPR9S6",21,0)
 ;END
"RTN","RMPRAINQ")
0^30^B23461371
"RTN","RMPRAINQ",1,0)
RMPRAINQ ;PHX/JLT/HNB  -Print History, Vehicle of Reg. ;1/30/1995
"RTN","RMPRAINQ",2,0)
 ;;3.0;PROSTHETICS;**20,90**;Feb 09, 1996
"RTN","RMPRAINQ",3,0)
 D GETPAT^RMPRUTIL Q:'$D(RMPRDFN)
"RTN","RMPRAINQ",4,0)
 S %ZIS="QM" D ^%ZIS G:POP EXIT
"RTN","RMPRAINQ",5,0)
 I $D(IO("Q")) K IO("Q") D
"RTN","RMPRAINQ",6,0)
 .S ZTRTN="DU^RMPRAINQ",ZTDESC="PROSTHETICS INQUIRE TO PATIENT VEHICLE OF RECORD",ZTIO=ION
"RTN","RMPRAINQ",7,0)
 .F RMPRB="RMPRDFN","RMPRNAM","RMPRSSN" S ZTSAVE(RMPRB)=""
"RTN","RMPRAINQ",8,0)
 .D ^%ZTLOAD
"RTN","RMPRAINQ",9,0)
 I $D(ZTSK) G EXIT
"RTN","RMPRAINQ",10,0)
DU ;PRINT AUTO-ADAPTIVE EQUIPMENT, entry point from ??
"RTN","RMPRAINQ",11,0)
 N PAGE,RMPRL,RMPRI,RMPRT,RMPRD,RDAT,RMPRB,FL
"RTN","RMPRAINQ",12,0)
 ;K RMPRBACK
"RTN","RMPRAINQ",13,0)
 S DFN=RMPRDFN D ELIG^VADPT S RMPRCNUM=VAEL(7) K VAEL
"RTN","RMPRAINQ",14,0)
 S PAGE=0,RMPRI=0,$P(RMPRL,"-",IOM)=""
"RTN","RMPRAINQ",15,0)
 U IO D HDR
"RTN","RMPRAINQ",16,0)
 F  S RMPRI=$O(^RMPR(667,"C",RMPRDFN,RMPRI)) Q:RMPRI'>0!($D(FL))  D
"RTN","RMPRAINQ",17,0)
 .S RMPRB=^RMPR(667,RMPRI,0)
"RTN","RMPRAINQ",18,0)
 .S RMPRT=$O(^RMPR(667,"B",$P(RMPRB,U,1),0)),RMPRD=$P(^RMPR(667,RMPRT,0),U,3)
"RTN","RMPRAINQ",19,0)
 .;vehicle
"RTN","RMPRAINQ",20,0)
 .I $D(^RMPR(667.3,"C",RMPRT)) D LP Q
"RTN","RMPRAINQ",21,0)
 .;vehicle, no transactions
"RTN","RMPRAINQ",22,0)
 .S RDAT=1 D ONE
"RTN","RMPRAINQ",23,0)
 W:'$D(RDAT) !!,?15,"NO VEHICLE OF RECORD FOR THIS PATIENT",!
"RTN","RMPRAINQ",24,0)
 I IOST["C-" I $Y<IOSL-5 F  W ! Q:$Y>IOSL-5 
"RTN","RMPRAINQ",25,0)
 I IOST["C-"&('$D(FL)) K DIR S DIR(0)="E" D ^DIR
"RTN","RMPRAINQ",26,0)
 W @IOF
"RTN","RMPRAINQ",27,0)
 ;
"RTN","RMPRAINQ",28,0)
EXIT K DIC,RMPRINFO,RA,RK,RI,FL,DIR,Y,RMPRB D ^%ZISC
"RTN","RMPRAINQ",29,0)
 I $D(RMPRBACK)!($D(RMPRBAC1)) G ASK1^RMPRPAT
"RTN","RMPRAINQ",30,0)
 ;E  K RMPRDFN,RMPRNAM,RMPRSSN,RMPRDOB,RMPRCNUM
"RTN","RMPRAINQ",31,0)
 Q
"RTN","RMPRAINQ",32,0)
LP ;find vehicle entries
"RTN","RMPRAINQ",33,0)
 D WR W ! N CNT,RPREV S RK=0,CNT=0,RPREV=0
"RTN","RMPRAINQ",34,0)
 F  S RK=$O(^RMPR(667.3,"C",RMPRT,RK)) Q:RK'>0!($D(FL))  D
"RTN","RMPRAINQ",35,0)
 .S RDAT=1 D WR1
"RTN","RMPRAINQ",36,0)
 D TOT
"RTN","RMPRAINQ",37,0)
 Q
"RTN","RMPRAINQ",38,0)
HDR S PAGE=PAGE+1
"RTN","RMPRAINQ",39,0)
 W @IOF,!,"NAME: ",RMPRNAM,?33,"SSN: ",RMPRSSN
"RTN","RMPRAINQ",40,0)
 W ?50,"CLAIM NO. ",RMPRCNUM
"RTN","RMPRAINQ",41,0)
 W !,"VEHICLE ID#",?20,"YEAR",?25,"PURCHASE DATE",?40,"MAKE"
"RTN","RMPRAINQ",42,0)
 W ?51,"MODEL",?70,"PAGE ",PAGE
"RTN","RMPRAINQ",43,0)
 W !,"PROCESS DATE",?15,"ITEM",?40,"QTY",?51,"COST",?62,"AMIS"
"RTN","RMPRAINQ",44,0)
 W ?72,"TYPE",!?30,"'*' Denotes Inactive Vehicle of Record",!,RMPRL
"RTN","RMPRAINQ",45,0)
 Q
"RTN","RMPRAINQ",46,0)
WR I IOST["C-"&($Y+6>IOSL) S DIR(0)="E" D ^DIR I 'Y S FL=1 Q
"RTN","RMPRAINQ",47,0)
 D:$Y+6>IOSL HDR I $D(^RMPR(667,RMPRT,2)),$P(^(2),U)=0 S RMPRB="*"_RMPRB
"RTN","RMPRAINQ",48,0)
PG ;display auto, no items
"RTN","RMPRAINQ",49,0)
 W !,$E($P(RMPRB,U,1),1,19),?20,$P(RMPRB,U,5)
"RTN","RMPRAINQ",50,0)
 S Y=$P(RMPRB,U,4) D DD^%DT W ?25,Y
"RTN","RMPRAINQ",51,0)
 W:+$P(RMPRB,U,6) ?40,$E(^RMPR(667.2,$P(RMPRB,U,6),0),1,9)
"RTN","RMPRAINQ",52,0)
 W ?51,$E($P(RMPRB,U,7),1,9)
"RTN","RMPRAINQ",53,0)
 I RMPRD S Y=RMPRD D DD^%DT W ?62,"4502: ",Y
"RTN","RMPRAINQ",54,0)
 W ?62,$S($P(RMPRB,U,9)="A":"ANKYLOSIS",$P(RMPRB,U,9)="V":"VOC REHAB",1:"")
"RTN","RMPRAINQ",55,0)
 I $D(^RMPR(667,RMPRT,1,0)) S RA=0 F  S RA=$O(^RMPR(667,RMPRT,1,RA)) Q:RA'>0  W !,^(RA,0)
"RTN","RMPRAINQ",56,0)
 Q
"RTN","RMPRAINQ",57,0)
WR1 ;items, or transactions
"RTN","RMPRAINQ",58,0)
 I IOST["C-"&($Y+6>IOSL) S DIR(0)="E" D ^DIR I 'Y S FL=1 Q
"RTN","RMPRAINQ",59,0)
 I $Y+6>IOSL D HDR,PG W !
"RTN","RMPRAINQ",60,0)
 S RMPRINFO=^RMPR(667.3,RK,0),$P(RMPRINFO,U,15)=+$P(RMPRINFO,U,4)*+$P(RMPRINFO,U,7)
"RTN","RMPRAINQ",61,0)
 S:'$P(RMPRINFO,U,15) $P(RMPRINFO,U,15)=$P(RMPRINFO,U,4)
"RTN","RMPRAINQ",62,0)
 S Y=$P(RMPRINFO,U) D DD^%DT
"RTN","RMPRAINQ",63,0)
 ;print total if process date different
"RTN","RMPRAINQ",64,0)
 I RPREV'=Y&(RPREV'=0) D TOT
"RTN","RMPRAINQ",65,0)
 S RPREV=Y
"RTN","RMPRAINQ",66,0)
 W !,Y
"RTN","RMPRAINQ",67,0)
 W ?15,$S($D(^RMPR(667.1,+$P(RMPRINFO,U,3),0)):$E(^RMPR(667.1,$P(RMPRINFO,U,3),0),1,20),1:"UNK")
"RTN","RMPRAINQ",68,0)
 W ?40,$P(RMPRINFO,U,7),?48
"RTN","RMPRAINQ",69,0)
 W ?48+(10-($L($FN($P(RMPRINFO,U,15),",",2)))),"$",$FN($P(RMPRINFO,U,15),",",2)
"RTN","RMPRAINQ",70,0)
 S CNT=CNT+$P(RMPRINFO,U,15)
"RTN","RMPRAINQ",71,0)
 W ?62,$S($P(RMPRINFO,U,5)["R":"REPAIR",$P(RMPRINFO,U,5)["A":"VAN MOD",$P(RMPRINFO,U,5)["B":"ADAP EQP",1:"")
"RTN","RMPRAINQ",72,0)
 W ?72,$S($P(RMPRINFO,U,8)="I":"INITIAL",$P(RMPRINFO,U,8)="R":"REPLACE",$P(RMPRINFO,U,8)="X":"REPAIR",$P(RMPRINFO,U,8)="S":"SPARE",$P(RMPRINFO,U,8)=5:"RENTAL",1:"")
"RTN","RMPRAINQ",73,0)
 I $D(^RMPR(667.3,RK,1,0)) D
"RTN","RMPRAINQ",74,0)
 .S RA=0
"RTN","RMPRAINQ",75,0)
 .F  S RA=$O(^RMPR(667.3,RK,1,RA)) Q:RA'>0  W !,^(RA,0)
"RTN","RMPRAINQ",76,0)
 Q
"RTN","RMPRAINQ",77,0)
TOT Q:$D(FL)
"RTN","RMPRAINQ",78,0)
 W !!?31,"Total/Date:"
"RTN","RMPRAINQ",79,0)
 W ?48+(10-$L($FN(CNT,",",2))),"$",$FN(CNT,",",2),!
"RTN","RMPRAINQ",80,0)
 S CNT=0
"RTN","RMPRAINQ",81,0)
 Q
"RTN","RMPRAINQ",82,0)
ONE ;vehicle, no items.
"RTN","RMPRAINQ",83,0)
 I IOST["C-"&($Y+6>IOSL) S DIR(0)="E" D ^DIR I 'Y S FL=1 Q
"RTN","RMPRAINQ",84,0)
 D:$Y+6>IOSL HDR
"RTN","RMPRAINQ",85,0)
 I $D(^RMPR(667,RMPRT,2)),$P(^(2),U)=0 S RMPRB="*"_RMPRB
"RTN","RMPRAINQ",86,0)
 W !,$E($P(RMPRB,U,1),1,19),?20,$P(RMPRB,U,5)
"RTN","RMPRAINQ",87,0)
 S Y=$P(RMPRB,U,4) D DD^%DT W ?25,Y
"RTN","RMPRAINQ",88,0)
 W:$P(RMPRB,U,6) ?40,$S($D(^RMPR(667.2,+$P(RMPRB,U,6),0)):$E(^RMPR(667.2,$P(RMPRB,U,6),0),1,9),1:"UNK")
"RTN","RMPRAINQ",89,0)
 W ?51,$E($P(RMPRB,U,7),1,9)
"RTN","RMPRAINQ",90,0)
 I RMPRD S Y=RMPRD D DD^%DT W ?62,"4502: ",Y
"RTN","RMPRAINQ",91,0)
 W ?62,$S($P(RMPRB,U,9)="A":"ANKYLOSIS",$P(RMPRB,U,9)="V":"VOC REHAB",1:"")
"RTN","RMPRAINQ",92,0)
 I $D(^RMPR(667,RMPRT,1,0)) S RA=0 F  S RA=$O(^RMPR(667,RMPRT,1,RA)) Q:RA'>0  W !,^(RA,0)
"RTN","RMPRAINQ",93,0)
 W !?15,"NO ITEMS ON THIS VEHICLE OF RECORD",!,RMPRL ;K DIR S DIR(0)="E" D ^DIR Q:$D(DUOUT)!($D(DTOUT))  W @IOF
"RTN","RMPRAINQ",94,0)
 Q
"RTN","RMPRAINQ",95,0)
VOR ;EDIT/DELETE VEHICLE OF RECORD
"RTN","RMPRAINQ",96,0)
 K DIC,DIE,DA,DIK,RMPRA,DR D DIV4^RMPRSIT I $D(X) Q
"RTN","RMPRAINQ",97,0)
VH S DIC=667,DIC(0)="AEQMNZ"
"RTN","RMPRAINQ",98,0)
 S DIC("A")="Please Enter Patient Name or Vehicle ID#: "
"RTN","RMPRAINQ",99,0)
 S DIC("W")="D LK^RMPRAVR"
"RTN","RMPRAINQ",100,0)
 S DIC("S")="I $P(^(0),U,10)=RMPR(""STA"")"
"RTN","RMPRAINQ",101,0)
 I RMPRSITE=1 S DIC("S")=DIC("S")_"!($P(^(0),U,10)="""")"
"RTN","RMPRAINQ",102,0)
 D ^DIC I +Y'>0 K DIC,Y Q
"RTN","RMPRAINQ",103,0)
 L +^RMPR(667,+Y,0):1
"RTN","RMPRAINQ",104,0)
 I $T=0 W ?5,$C(7),!,"Someone else is Editing this Entry!" K DIC,Y Q
"RTN","RMPRAINQ",105,0)
 S (RMPRDA,DA)=+Y,DR=".01;9STATUS;10;2;2.1;3;4;5;6;7;11;2.2;2.3;I $P(^RMPR(667,DA,2),U,3)'=4 S Y="""";2.4"
"RTN","RMPRAINQ",106,0)
 S DIE=DIC D ^DIE
"RTN","RMPRAINQ",107,0)
 I '$D(DA) S RI=0 F  S RI=$O(^RMPR(667.3,"C",RMPRDA,RI)) Q:RI'>0  S DA=RI,DIK="^RMPR(667.3," D ^DIK
"RTN","RMPRAINQ",108,0)
 W ! L -^RMPR(667,RMPRDA,0) K DR,DIE G VH
"RTN","RMPRED6")
0^32^B47536082
"RTN","RMPRED6",1,0)
RMPRED6 ;PHX/RFM,RVD-EDIT ISSUE FROM STOCK ;9/29/1994
"RTN","RMPRED6",2,0)
 ;;3.0;PROSTHETICS;**19,33,35,46,41,53,90**;Feb 09, 1996
"RTN","RMPRED6",3,0)
EN ;EDIT STOCK ISSUES
"RTN","RMPRED6",4,0)
 D HOME^%ZIS,DIV4^RMPRSIT G:$D(X) EXIT^RMPRED4
"RTN","RMPRED6",5,0)
 S DIC("S")="I ($P(^(0),U,13)=11!($P(^(0),U,13)=12)) I $P(^(0),U,10)=RMPR(""STA"")" I RMPRSITE=1 S DIC("S")=DIC("S")_"!($P(^(0),U,10)="""")"
"RTN","RMPRED6",6,0)
 S DIC="^RMPR(660,",DIC(0)="AEMQ",DIC("A")="Select PATIENT: ",DIC("W")="D ^RMPRD1" D ^DIC G:Y<0 EXIT^RMPRED4
"RTN","RMPRED6",7,0)
 S RMPRIEN=+Y
"RTN","RMPRED6",8,0)
 L +^RMPR(660,+Y):1 I $T=0 W !,?5,$C(7),"Someone else is Editing this entry!" G EXIT^RMPRED4
"RTN","RMPRED6",9,0)
 S (RMDFN,DFN)=$P(^RMPR(660,+Y,0),U,2)
"RTN","RMPRED6",10,0)
 S RMPRF=$P(^RMPR(660,+Y,0),U,13)
"RTN","RMPRED6",11,0)
INVSE S %X=DIC_+Y_",",%Y="R1(" D %XY^%RCR
"RTN","RMPRED6",12,0)
 S:'$D(R1(2)) R1(2)=""
"RTN","RMPRED6",13,0)
 D DEM^VADPT
"RTN","RMPRED6",14,0)
 S RMPRNAM=$P(VADM(1),U),RMPRSSN=$P(VADM(2),U)
"RTN","RMPRED6",15,0)
 S (RMHCPC,RMHCNEW,RMHCOLD)=$P($G(R1(1)),U,4),REDIT=1,RMPRUCST=0
"RTN","RMPRED6",16,0)
 S (RMQNEW,RMQOLD)=$P($G(R1(0)),U,7)
"RTN","RMPRED6",17,0)
 S (RMLOCNEW,RMLOCOLD,RMITNEW,RMITOLD)=""
"RTN","RMPRED6",18,0)
 S RMSTOCK=$P($G(R1(1)),U,5)
"RTN","RMPRED6",19,0)
 I $G(RMSTOCK) S R6612=$G(^RMPR(661.2,RMSTOCK,0)),(RMLOC,RMLOCNEW,RMLOCOLD)=$P(R6612,U,16),(RMIT,RMITNEW,RMITOLD)=$P(R6612,U,9)
"RTN","RMPRED6",20,0)
 S R12(0)=R1(0),RMPRREL=$P(R1(0),U,16)
"RTN","RMPRED6",21,0)
 I $D(^RMPR(660,RMPRIEN,1)),+$P(^RMPR(660,RMPRIEN,1),U,3) S (RMPRIP,RIPOLD)=$P(^PRCP(445,$P(^RMPR(660,RMPRIEN,1),U,3),0),U)
"RTN","RMPRED6",22,0)
 K DIC S R3("D")="",R4("D")=""
"RTN","RMPRED6",23,0)
 G SET
"RTN","RMPRED6",24,0)
 ;
"RTN","RMPRED6",25,0)
CO ;DISPLAYS STOCK ISSUE
"RTN","RMPRED6",26,0)
 D CHK^RMPRED5
"RTN","RMPRED6",27,0)
 D NODE2^RMPRSTI
"RTN","RMPRED6",28,0)
 D ^RMPRST2
"RTN","RMPRED6",29,0)
EDX ;POST
"RTN","RMPRED6",30,0)
 S DIR(0)="SBO^P:POST;E:EDIT;D:DELETE"
"RTN","RMPRED6",31,0)
 S DIR("A")="Woul you like to POST/EDIT/DELETE this entry",DIR("B")="P",DIR("?")="Answer `P` to post the transaction, `E` to edit the transaction,'D' to delete the transaction"
"RTN","RMPRED6",32,0)
 D ^DIR K DIR G:Y="P" POST^RMPRED4 G:Y="D" DEL1^RMPRED4
"RTN","RMPRED6",33,0)
 G:Y="E" EDT
"RTN","RMPRED6",34,0)
 I $D(DIRUT)!$D(DUOUT)!$D(DTOUT) G EXIT^RMPRED4
"RTN","RMPRED6",35,0)
DEL ;
"RTN","RMPRED6",36,0)
 S DIR(0)="SBO^E:EDIT;D:DELETE",DIR("B")="E"
"RTN","RMPRED6",37,0)
 S DIR("A")="Would you like to EDIT/DELETE this Transaction",DIR("?")="Answer 'E' to EDIT the transaction or 'D' to DELETE the transaction." D ^DIR G:$D(DIRUT) EXIT^RMPRED4
"RTN","RMPRED6",38,0)
 I Y="E" G EDT
"RTN","RMPRED6",39,0)
 I Y="D" G DEL1^RMPRED4
"RTN","RMPRED6",40,0)
 ;
"RTN","RMPRED6",41,0)
EDT ;edit patient 2319
"RTN","RMPRED6",42,0)
 W @IOF,!?30,RMPRNAM,!
"RTN","RMPRED6",43,0)
 ;
"RTN","RMPRED6",44,0)
EDU S RMTY=$P(R1(0),U,4)
"RTN","RMPRED6",45,0)
 K DIR W ! S DIR(0)="660,2",DIR("B")=$S(RMTY="I":"INITIAL ISSUE",RMTY="X":"REPAIR",RMTY="R":"REPLACE",RMTY="S":"SPARE",RMTY=5:"RENTAL",1:"")
"RTN","RMPRED6",46,0)
 D ^DIR G:$D(DIRUT) CO S $P(R1(0),U,4)=Y,$P(R3("D"),U,4)=$S(Y="I":"INITIAL ISSUE",Y="X":"REPAIR",Y="R":"REPLACE",Y="S":"SPARE",Y=5:"RENTAL",1:"")
"RTN","RMPRED6",47,0)
 S DIR(0)="660,62",DIR("B")=$P(R4("D"),U,3) D ^DIR G:$D(DIRUT) CO S $P(R1("AM"),U,3)=Y,$P(R4("D"),U,3)=$S(Y=1:"SC/OP",Y=2:"SC/IP",Y=3:"NSC/IP",Y=4:"NSC/OP",1:"")
"RTN","RMPRED6",48,0)
 I Y<4 S $P(R1("AM"),U,4)="",$P(R4("D"),U,4)="" G 2
"RTN","RMPRED6",49,0)
 K DIR I Y=4 S DIR(0)="660,63" S:$P(R1("AM"),U,4)?1N.N DIR("B")=$P(R4("D"),U,4) D ^DIR G:$D(DUOUT)!$D(DTOUT) CO G:$D(DIRUT)!(X="") 2
"RTN","RMPRED6",50,0)
 I $P(R1("AM"),U,3)=4 S $P(R1("AM"),U,4)=Y,$P(R4("D"),U,4)=$S(Y=1:"SPECIAL LEGISLATION",Y=2:"A&A",Y=3:"PHC",Y=4:"ELIGIBILITY REFORM",1:"")
"RTN","RMPRED6",51,0)
 ;
"RTN","RMPRED6",52,0)
2 S DIC(0)="AEQM",DIC=661 S:$P(R1(0),U,6) DIC("B")=$P(^RMPR(661,$P(R1(0),U,6),0),U) S DIC("A")="ITEM: "
"RTN","RMPRED6",53,0)
 K DIC("S") D ^DIC
"RTN","RMPRED6",54,0)
 I $P(R3("D"),U,6)&$D(DUOUT) G CO
"RTN","RMPRED6",55,0)
 I $D(DUOUT)!$D(DTOUT) G CO
"RTN","RMPRED6",56,0)
 I +Y'>0 W !!,?5,$C(7),"This is a required response.  Enter '^' to exit",! G 2
"RTN","RMPRED6",57,0)
 S $P(R1(0),U,6)=+Y,$P(R3("D"),U,6)=$P(Y,U,2) K DIC,Y,X
"RTN","RMPRED6",58,0)
 ;
"RTN","RMPRED6",59,0)
LOC ;ask for location
"RTN","RMPRED6",60,0)
 S (RMITFLG,RMHCFLG,RMHCDA,RMITDA,RMAV,RMAVA,RMCO,RMBAL)=0
"RTN","RMPRED6",61,0)
 K DIC,Y,X,RQUIT,DTOUT,DUOUT
"RTN","RMPRED6",62,0)
 S DZ="??",D="B",DIC("S")="I $P(^RMPR(661.3,+Y,0),U,3)=RMPR(""STA"")"
"RTN","RMPRED6",63,0)
 S:RMLOCOLD'="" DIC("B")=RMLOCOLD
"RTN","RMPRED6",64,0)
 S DIC="^RMPR(661.3,",DIC(0)="AEQM"
"RTN","RMPRED6",65,0)
 S DIC("A")="Enter Pros Location: " D MIX^DIC1
"RTN","RMPRED6",66,0)
 I $D(DUOUT)!$D(DTOUT) G CO
"RTN","RMPRED6",67,0)
 I X="" W !,"This is a mandatory field!!!",! G LOC
"RTN","RMPRED6",68,0)
 S RMLOC=+Y
"RTN","RMPRED6",69,0)
 G:'$D(^RMPR(661.3,RMLOC,0)) LOC
"RTN","RMPRED6",70,0)
 ;
"RTN","RMPRED6",71,0)
HCPCS ;HCPCS code
"RTN","RMPRED6",72,0)
 K DIC,RMR,RMX,RQUIT S DIC("A")="PSAS HCPCS: ",DA(1)=RMLOC,RMF=1
"RTN","RMPRED6",73,0)
 I $P(R1(1),U,4)&(RMLOCOLD=RMLOC) S DIC("B")=$P(R1(1),U,4)
"RTN","RMPRED6",74,0)
 S DIC="^RMPR(661.3,"_DA(1)_",1,",DIC(0)="AEMNZ"
"RTN","RMPRED6",75,0)
 S DIC("W")="S RZ=$P(^RMPR(661.3,RMLOC,1,+Y,0),U,1) I RZ W ?30,$P(^RMPR(661.1,RZ,0),U,2)"
"RTN","RMPRED6",76,0)
 D ^DIC I $D(DUOUT)!$D(DTOUT) G LOC
"RTN","RMPRED6",77,0)
 I X="" W !,"This is a mandatory field!!!",! G HCPCS
"RTN","RMPRED6",78,0)
 S (RMHCNEW,RMDAHC)=$P($G(^RMPR(661.3,RMLOC,1,+Y,0)),U,1)
"RTN","RMPRED6",79,0)
 I $G(RMDAHC),$P(^RMPR(661.1,RMDAHC,0),U,5)'=1 D INACT^RMPRSTI G HCPCS
"RTN","RMPRED6",80,0)
 S RMHCPC=$P(^RMPR(661.1,RMDAHC,0),U,1),RMHCDA=+Y
"RTN","RMPRED6",81,0)
 S RDES=$P(^RMPR(661.1,RMDAHC,0),U,2)
"RTN","RMPRED6",82,0)
 ;
"RTN","RMPRED6",83,0)
CPT ;ask for CPT Modifier
"RTN","RMPRED6",84,0)
 K DIC,Y,RQUIT
"RTN","RMPRED6",85,0)
 S RDA=RMDAHC_"^"_$P(R1(0),U,4)_"^"_$P(R1(0),U,14)_"^"_660
"RTN","RMPRED6",86,0)
 D:$D(RMCPT) CHK^RMPRED5
"RTN","RMPRED6",87,0)
 W:$G(REDIT) !,"OLD CPT MODIFIER: ",$P(R1(1),U,6)
"RTN","RMPRED6",88,0)
 I RMHCOLD'=RMDAHC D CPT^RMPRCPTU(RDA) G:$D(DUOUT)!$D(DTOUT) LIST^RMPRSTE S $P(R1(1),U,6)=$G(RMCPT) W:$G(REDIT) !,"NEW CPT MODIFIER: ",$G(RMCPT)
"RTN","RMPRED6",89,0)
 I RMHCOLD'="",(RMHCOLD=RMDAHC),$G(REDIT) D
"RTN","RMPRED6",90,0)
 .S DIR(0)="Y",DIR("A")="Would you like to Edit CPT MODIFIER Entry  ",DIR("B")="N" D ^DIR Q:$D(DTOUT)!$D(DUOUT)
"RTN","RMPRED6",91,0)
 .I $G(Y) D CPT^RMPRCPTU(RDA) Q:$D(DUOUT)!$D(DUOUT)  S $P(R1(1),U,6)=$G(RMCPT) W !,"NEW CPT MODIFIER: ",$G(RMCPT)
"RTN","RMPRED6",92,0)
 K DIR
"RTN","RMPRED6",93,0)
 ;
"RTN","RMPRED6",94,0)
 ;D ITEM^RMPR5NU1(REDIT,RMLOC,RMLOCOLD,RMDAHC,RMHCOLD,RMHCDA,RMIT)
"RTN","RMPRED6",95,0)
 ;
"RTN","RMPRED6",96,0)
ITEM ;ask for PSAS Item to to edit.
"RTN","RMPRED6",97,0)
 S DA(2)=RMLOC,DA(1)=RMHCDA K DIC,RMU3,RMUBA,RQUIT
"RTN","RMPRED6",98,0)
 S DIC("A")="Enter PSAS Item: ",DIC(0)="AEMNQ"
"RTN","RMPRED6",99,0)
 I RMDAHC=RMHCOLD S DIC("B")=$G(RMIT)
"RTN","RMPRED6",100,0)
 S DIC="^RMPR(661.3,"_DA(2)_",1,"_DA(1)_",1,"
"RTN","RMPRED6",101,0)
 D ^DIC I $D(DUOUT)!$D(DTOUT) G LOC
"RTN","RMPRED6",102,0)
 I X="" W !,"This is a mandatory field!!!",! G ITEM
"RTN","RMPRED6",103,0)
 S RMITDA=+Y,RMU3=$G(^RMPR(661.3,RMLOC,1,RMHCDA,1,RMITDA,0))
"RTN","RMPRED6",104,0)
 S RMUBA=$P(RMU3,U,2)
"RTN","RMPRED6",105,0)
 S (RMITNEW,RMIT)=$P(RMU3,U,1),RMDES=RMIT K DIC("B"),DIC("S")
"RTN","RMPRED6",106,0)
 I (RMITNEW'=RMITOLD),(RMUBA<1) D LOWBA^RMPRSTI G LOC
"RTN","RMPRED6",107,0)
 ;
"RTN","RMPRED6",108,0)
 I $D(RMLOC),$D(RMHCDA),$D(RMITDA) S RMSO=$$SOURCE^RMPR5NU1
"RTN","RMPRED6",109,0)
 I $D(RMSO),RMSO="" D MESSO^RMPRSTI G LOC
"RTN","RMPRED6",110,0)
 S:$D(RMSO) $P(R1(0),U,14)=RMSO
"RTN","RMPRED6",111,0)
 S $P(R3("D"),U,14)=$S(RMSO="C":"COMMERCIAL",RMSO="V":"VA",1:"")
"RTN","RMPRED6",112,0)
 I $P(R1(1),U,4)'="",$D(DUOUT) G CO
"RTN","RMPRED6",113,0)
 I $G(RMLOC),'($G(RMHCDA)&$G(RMITDA)) W !,"PSAS Item was not selected!!" G LOC
"RTN","RMPRED6",114,0)
 I $G(RMLOC),$G(RMHCDA),$G(RMITDA) S RMPRUCST=$$COST^RMPR5NU1
"RTN","RMPRED6",115,0)
 I '$G(RMPRUCST) D MESSI^RMPRSTI G LOC
"RTN","RMPRED6",116,0)
 S:$G(REDIT) $P(R1(0),U,16)=RMPRUCST*$P(R1(0),U,7),$P(R3("D"),U,16)=RMPRUCST*$P(R1(0),U,7)
"RTN","RMPRED6",117,0)
 S $P(R1(1),U,4)=RMDAHC,$P(R1(0),U,22)=$P(^RMPR(661.1,RMDAHC,0),U,4)
"RTN","RMPRED6",118,0)
 S RMLOCNEW=RMLOC,RMHCNEW=RMDAHC
"RTN","RMPRED6",119,0)
 D NODE2^RMPRSTI
"RTN","RMPRED6",120,0)
 K DIC
"RTN","RMPRED6",121,0)
 ;
"RTN","RMPRED6",122,0)
VEN0 ;process vendor
"RTN","RMPRED6",123,0)
 K DIC,DIR
"RTN","RMPRED6",124,0)
 I $D(RMLOC),$D(RMHCDA),$D(RMITDA) S DIC("B")=$$VEND^RMPR5NU1
"RTN","RMPRED6",125,0)
 S DIC="^PRC(440,",DIC(0)="AEQM" D ^DIC I $D(DUOUT)!$D(DTOUT) G CO
"RTN","RMPRED6",126,0)
 G:+Y<0 VEN0
"RTN","RMPRED6",127,0)
 S $P(R1(0),U,9)=+Y,$P(R3("D"),U,9)=$P(Y,U,2) K DIR,DIC
"RTN","RMPRED6",128,0)
CP G ^RMPRED4
"RTN","RMPRED6",129,0)
 ;
"RTN","RMPRED6",130,0)
SET ;set the original variables.
"RTN","RMPRED6",131,0)
 S $P(R3("D"),U,14)=$S($P(R1(0),U,14)="V":"VA",$P(R1(0),U,14)="C":"COMMERCIAL",1:"")
"RTN","RMPRED6",132,0)
 S $P(R3("D"),U,4)=$S($P(R1(0),U,4)="I":"INITIAL ISSUE",$P(R1(0),U,4)="X":"REPAIR",$P(R1(0),U,4)="R":"REPLACE",$P(R1(0),U,4)="S":"SPARE",$P(R1(0),U,4)="5":"RENTAL",1:"")
"RTN","RMPRED6",133,0)
 S $P(R4("D"),U,3)=$S($P(R1("AM"),U,3)=1:"SC/OP",$P(R1("AM"),U,3)=2:"SC/IP",$P(R1("AM"),U,3)=3:"NSC/IP",$P(R1("AM"),U,3)=4:"NSC/OP")
"RTN","RMPRED6",134,0)
 S:$P(R1("AM"),U,3)=4&($P(R1("AM"),U,4)) $P(R4("D"),U,4)=$S($P(R1("AM"),U,4)=1:"SPECIAL LEGISLATION",$P(R1("AM"),U,4)=2:"A&A",$P(R1("AM"),U,4)=3:"PHC",$P(R1("AM"),U,4)=4:"ELIGIBILITY REFORM",1:"")
"RTN","RMPRED6",135,0)
 S RMHCOLD=$P($G(R1(1)),U,4),RMPRPF=$P(R1(0),U,13),RMQOLD=$P(R1(0),U,7)
"RTN","RMPRED6",136,0)
 S RMSO=$P(R1(0),U,14)
"RTN","RMPRED6",137,0)
 I $G(RMQOLD),$P($G(R1(0)),U,16) S RMPRUCST=$P(R1(0),U,16)/RMQOLD
"RTN","RMPRED6",138,0)
 S $P(R3("D"),U,6)=$P(^RMPR(661,$P(R1(0),U,6),0),U,1),RITOLD=$P(R1(0),U,6),RMQOLD=$P(R1(0),U,7),Y=$P(R1(0),U,12) G:Y="" CO D DD^%DT S $P(R3("D"),U,12)=Y
"RTN","RMPRED6",139,0)
 D ^RMPRST2 G DEL
"RTN","RMPRED6",140,0)
 Q
"RTN","RMPRESI")
0^10^B7878670
"RTN","RMPRESI",1,0)
RMPRESI ;PHX/JLT-ENTER/EDIT SITE PARAMETERS ROUTINE ;8/29/1994
"RTN","RMPRESI",2,0)
 ;;3.0;PROSTHETICS;**51,55,62,90**;Feb 09, 1996
"RTN","RMPRESI",3,0)
 ;
"RTN","RMPRESI",4,0)
 ; ODJ - patch 55 - 1/29/01 - Add prompt for field 34 in 669.9
"RTN","RMPRESI",5,0)
 ;                            mail routing code (see AUG-1097-32118)
"RTN","RMPRESI",6,0)
 ;
"RTN","RMPRESI",7,0)
 ; RVD patch #62  - added PCE Hospital Location prompt
"RTN","RMPRESI",8,0)
 ;
"RTN","RMPRESI",9,0)
DIR K Y,DA,DIR S DIR(0)="FO^3:30",DIR("?")="^S X=""?"" D INS^RMPRESI",DIR("A")="Select PROSTHETICS SITE PARAMETER SITE NAME" D ^DIR G:$D(DIRUT)!$D(DTOUT) EXIT
"RTN","RMPRESI",10,0)
 S DIC=669.9,DIC(0)="EMZ",RMPRX=X D ^DIC I +Y>0 S RMPRIEN=+Y G EDIT
"RTN","RMPRESI",11,0)
 S X=RMPRX,DIC=4,DIC(0)="EQMZ" D ^DIC G:+Y'>0 DIR S SITE=+Y
"RTN","RMPRESI",12,0)
START S RMPRA=^DIC(4,SITE,0),RMPRB=$S($D(^DIC(4,SITE,1)):^(1),1:" "),SIG="",ST=$P(^DIC(4,SITE,0),U,2)
"RTN","RMPRESI",13,0)
 S DIC=669.9,DIC(0)="EQZL",DLAYGO=669.9,X=$P($P(RMPRA,","),U)_" VAMC",DIC("DR")="1////^S X=SITE" D ^DIC K DLAYGO G:+Y'>0 DIR S RMPRIEN=+Y
"RTN","RMPRESI",14,0)
 S STRT=$P(RMPRB,U,1)
"RTN","RMPRESI",15,0)
 S CITY=$P(RMPRB,U,3),RIP=$P(RMPRB,U,4),ART=125,WCHR=100,BRSS=75,BAS=75,PG=90,COP=90,CDP=90
"RTN","RMPRESI",16,0)
CON S RMPRSITE=$O(^RMPR(669.9,0)),AIN=$P(^RMPR(669.9,RMPRSITE,0),U,3) I $D(^(2)) S SIG=$P(^(2),U,6),SBT=$P(^(2),U,1)
"RTN","RMPRESI",17,0)
 S DA=RMPRIEN,DIE="^RMPR(669.9,"
"RTN","RMPRESI",18,0)
 S DR="2////^S X=AIN;4////^S X=STRT;5////^S X=CITY;6////^S X=ST;7////^S X=RIP;8////^S X=SIG;8.5///^S X=SBT;11////^S X=99999999;15////^S X=ART;16////^S X=WCHR;17////^S X=BRSS;18////^S X=BAS;19////^S X=PG;20////^S X=COP;21////^S X=CDP" D ^DIE
"RTN","RMPRESI",19,0)
EDIT ;EDIT SITE PARAMENTERS
"RTN","RMPRESI",20,0)
 ; Added fields 8.1 and 10 in patch 90
"RTN","RMPRESI",21,0)
 S DIE="^RMPR(669.9,",DA=RMPRIEN,DR=".01;40;3;4;5;6;7;7.1;8;8.1;10;8.5;2;31;32;33;34;9;27;28;29;30;19;20;21;15;16;17;18;22;52" D ^DIE G DIR
"RTN","RMPRESI",22,0)
EXIT N RMPRSITE,RMPR D KILL^XUSCLEAN Q
"RTN","RMPRESI",23,0)
INS S RI="" F  S RI=$O(^RMPR(669.9,"B",RI)) Q:RI=""  S RRMPR=$O(^RMPR(669.9,"B",RI,0)),RRMPR=^RMPR(669.9,RRMPR,0) W !,?5,$P(RRMPR,U)," ",?50,$P(^DIC(4,$P(RRMPR,U,2),99),U)
"RTN","RMPRESI",24,0)
 S DIC=4,DIC(0)="EQMZ" D ^DIC Q
"RTN","RMPRESI",25,0)
 ;
"RTN","RMPRESI",26,0)
 Q
"RTN","RMPRESI",27,0)
A1 G A2
"RTN","RMPRESI",28,0)
MGR(RESULTS) ;RPC to display manger comment
"RTN","RMPRESI",29,0)
A2 ;
"RTN","RMPRESI",30,0)
 S RMPRS=0,RESULTS(0)=""
"RTN","RMPRESI",31,0)
 F  S RMPRS=$O(^RMPR(669.9,RMPRS)) Q:RMPRS=""  D
"RTN","RMPRESI",32,0)
 .S RESULTS(0)=RESULTS(0)_" "_$P($G(^RMPR(669.9,RMPRS,6)),U,1)
"RTN","RMPRESI",33,0)
 K RMPRS
"RTN","RMPRESI",34,0)
 Q
"RTN","RMPRHIS")
0^33^B12988629
"RTN","RMPRHIS",1,0)
RMPRHIS ;PHX/RFM-ADD HISTORICAL DATA ;8/29/1994
"RTN","RMPRHIS",2,0)
 ;;3.0;PROSTHETICS;**19,45,90**;Feb 09, 1996
"RTN","RMPRHIS",3,0)
 K RMPRDFN,RMPRSSN,RMPRNAM,RMPRDOB,DIR D HOME^%ZIS S RMPRF=""
"RTN","RMPRHIS",4,0)
 W @IOF D DIV4^RMPRSIT G:$D(X) EXIT^RMPRHISL D:'$D(RMPRHIS) GETPAT^RMPRUTIL G:'$D(RMPRDFN) EXIT^RMPRHISL
"RTN","RMPRHIS",5,0)
VIEW D ^RMPRPAT I $D(RMPRKILL) W !,$C(7),"Deleted..." G EXIT^RMPRHISL
"RTN","RMPRHIS",6,0)
RES ;ADDS ANOTHER ITEM FOR HISTORICAL DATA
"RTN","RMPRHIS",7,0)
 S CK="W:$D(DUOUT) @IOF,$C(7),!!?28,""Deleted..."" H 3 W:$D(DUOUT) @IOF G:$D(DUOUT) RES^RMPRHIS G:$D(DIRUT) EXIT^RMPRHISL"
"RTN","RMPRHIS",8,0)
 K R1,DA,DD,DIC,PRC,X,Y
"RTN","RMPRHIS",9,0)
 S R1(0)=DT_U_RMPRDFN,$P(R1(0),U,10)=RMPR("STA"),$P(R1(0),U,15)="*",$P(R1(0),U,13)=13,$P(R1(0),U,27)=DUZ,R1("AM")=""
"RTN","RMPRHIS",10,0)
 ;DISPLAY VARIABLE
"RTN","RMPRHIS",11,0)
 S (R3("D"),R4("D"))="",RMPRHISD=1
"RTN","RMPRHIS",12,0)
1 ;ENTRY POINT TO EDIT AN ITEM
"RTN","RMPRHIS",13,0)
 W @IOF
"RTN","RMPRHIS",14,0)
 W !?30,RMPRNAM,! S:$P(R1(0),U,3) %DT("B")=$P(R3("D"),U,3) S %DT("A")="DATE OF REQUEST: ",%DT="AEXP" D ^%DT G:X="" ^RMPRHIS G:X="^"&$P(R3("D"),U,3) LIST^RMPRHISL G:X="^" EXIT^RMPRHISL
"RTN","RMPRHIS",15,0)
 S:Y>0 $P(R1(0),U,3)=Y D DD^%DT S $P(R3("D"),U,3)=Y
"RTN","RMPRHIS",16,0)
 S DIR("?")="Enter V for VA or C for Commercial"
"RTN","RMPRHIS",17,0)
LI S DIR(0)="SBO^V:VA;C:COMMERCIAL"
"RTN","RMPRHIS",18,0)
 S DIR("A")="Select VA or COMMERCIAL SOURCE"
"RTN","RMPRHIS",19,0)
 S:$P(R3("D"),U,14)?.A&($P(R3("D"),U,14)'="") DIR("B")=$P(R3("D"),U,14)
"RTN","RMPRHIS",20,0)
 D ^DIR
"RTN","RMPRHIS",21,0)
 I $P(R3("D"),U,14)?1A.A&($D(DUOUT)) K DIR G LIST^RMPRHISL
"RTN","RMPRHIS",22,0)
 G:$D(DTOUT) EXIT^RMPRHISL
"RTN","RMPRHIS",23,0)
 G:X=""!($D(DUOUT)) ^RMPRHIS
"RTN","RMPRHIS",24,0)
 G:$D(DIRUT) EXIT^RMPRHISL S $P(R1(0),U,14)=Y K DIR
"RTN","RMPRHIS",25,0)
 S $P(R3("D"),U,14)=$S(Y="C":"COMMERCIAL",Y="V":"VA",1:"")
"RTN","RMPRHIS",26,0)
2 ;
"RTN","RMPRHIS",27,0)
 S DIC=661,DIC(0)="AEQM",DIC("A")="ITEM: "
"RTN","RMPRHIS",28,0)
 S:$P(R1(0),U,6) DIC("B")=$P(R1(0),U,6)
"RTN","RMPRHIS",29,0)
 D ^DIC
"RTN","RMPRHIS",30,0)
 I $P(R3("D"),U,6)'=""&$D(DUOUT) K DIC G LIST^RMPRHISL
"RTN","RMPRHIS",31,0)
 X:$D(DUOUT) CK Q:'$D(R1(0))
"RTN","RMPRHIS",32,0)
 G:(+Y'>0)&($D(DTOUT)) EXIT^RMPRHISL
"RTN","RMPRHIS",33,0)
 I +Y'>0 W !!,?5,$C(7),"This is a required response.  Enter '^' to exit",! G 2
"RTN","RMPRHIS",34,0)
 S $P(R1(0),U,6)=+Y,$P(R3("D"),U,6)=$P(Y,U,2) K DIC
"RTN","RMPRHIS",35,0)
V ;
"RTN","RMPRHIS",36,0)
 S DIC=440,DIC(0)="AEQM",DIC("A")="VENDOR: "
"RTN","RMPRHIS",37,0)
 S:$P(R1(0),U,9) DIC("B")=$P(R1(0),U,9)
"RTN","RMPRHIS",38,0)
 D ^DIC
"RTN","RMPRHIS",39,0)
 I $P(R3("D"),U,9)'=""&$D(DUOUT) K DIC G LIST^RMPRHISL
"RTN","RMPRHIS",40,0)
 X:$D(DUOUT) CK Q:'$D(R1(0))
"RTN","RMPRHIS",41,0)
 G:(+Y'>0)&($D(DTOUT)) EXIT^RMPRHISL
"RTN","RMPRHIS",42,0)
 I +Y'>0 W !!,?5,$C(7),"This is a required response.  Enter '^' to exit",! G V
"RTN","RMPRHIS",43,0)
 S $P(R1(0),U,9)=+Y,$P(R3("D"),U,9)=$P(Y,U,2) K DIC
"RTN","RMPRHIS",44,0)
 W ! S DIR(0)="660,2"
"RTN","RMPRHIS",45,0)
 S:$P(R1(0),U,4)?.E&($P(R3("D"),U,4)'="") DIR("B")=$P(R3("D"),U,4)
"RTN","RMPRHIS",46,0)
 D ^DIR
"RTN","RMPRHIS",47,0)
 I $P(R3("D"),U,4)'=""&($D(DUOUT)) K DIR G LIST^RMPRHISL
"RTN","RMPRHIS",48,0)
 X:$D(DIRUT) CK Q:'$D(R1(0))  S $P(R1(0),U,4)=Y K DIR
"RTN","RMPRHIS",49,0)
 S $P(R3("D"),U,4)=$S(Y="I":"INITIAL ISSUE",Y="X":"REPAIR",Y="R":"REPLACE",Y="S":"SPARE",Y=5:"RENTAL",1:"")
"RTN","RMPRHIS",50,0)
 S DIR(0)="660,62"
"RTN","RMPRHIS",51,0)
 S:$P(R1("AM"),U,3)?1N.N DIR("B")=$P(R4("D"),U,3) D ^DIR G:$P(R1("AM"),U,3)'=""&($D(DUOUT)) LIST^RMPRHISL X:$D(DIRUT) CK Q:'$D(R1(0))
"RTN","RMPRHIS",52,0)
 S $P(R1("AM"),U,3)=Y
"RTN","RMPRHIS",53,0)
 S $P(R4("D"),U,3)=$S(Y=1:"SC/OP",Y=2:"SC/IP",Y=3:"NSC/IP",Y=4:"NSC/OP",1:"")
"RTN","RMPRHIS",54,0)
 K DIR
"RTN","RMPRHIS",55,0)
 I Y<4 S $P(R1("AM"),U,4)="",$P(R4("D"),U,4)="" G ^RMPRHISL
"RTN","RMPRHIS",56,0)
 I Y=4 S DIR(0)="660,63" S:$P(R1("AM"),U,4)?1N.N DIR("B")=$P(R4("D"),U,4) D ^DIR G:X="" NEX^RMPRHISL I $D(DUOUT)&($P(R1(0),U,7)) K DIR G LIST^RMPRHISL G:$D(DIRUT) EXIT^RMPRHISL
"RTN","RMPRHIS",57,0)
 I $P(R1("AM"),U,3)=4 S $P(R1("AM"),U,4)=Y,$P(R4("D"),U,4)=$S(Y=1:"SPECIAL LEGISLATION",Y=2:"A&A",Y=3:"PHC",Y=4:"ELIGIBILITY REFORM",1:"") G ^RMPRHISL
"RTN","RMPRHISD")
0^34^B8266515
"RTN","RMPRHISD",1,0)
RMPRHISD ;PHX/RFM-DELETE HISTORICAL DATA ENTRY ;8/29/1994
"RTN","RMPRHISD",2,0)
 ;;3.0;PROSTHETICS;**19,90**;Feb 09, 1996
"RTN","RMPRHISD",3,0)
EN D DIV4^RMPRSIT G:$D(X) EXIT D HOME^%ZIS
"RTN","RMPRHISD",4,0)
 S DIC("S")="I $P(^(0),U,13)=13,$P(^(0),U,10)=RMPR(""STA"")"
"RTN","RMPRHISD",5,0)
 S DIC="^RMPR(660,",DIC(0)="AEMQ",DIC("A")="Select PATIENT: ",DIC("W")="D ^RMPRD1" D ^DIC G:Y<0 EXIT
"RTN","RMPRHISD",6,0)
 S %X=DIC_+Y_",",%Y="R1(" D %XY^%RCR K DIC
"RTN","RMPRHISD",7,0)
 S RMPRIEN=+Y,RMPRNAM=$P(^DPT($P(R1(0),U,2),0),U,1),RMPRSSN=$P(^DPT($P(R1(0),U,2),0),U,9)
"RTN","RMPRHISD",8,0)
 S R3("D")="",R4("D")="",RMPRHISD=1
"RTN","RMPRHISD",9,0)
 S $P(R3("D"),U,14)=$S($P(R1(0),U,14)="C":"COMMERCIAL",$P(R1(0),U,14)="V":"VA",1:"")
"RTN","RMPRHISD",10,0)
 S $P(R3("D"),U,4)=$S($P(R1(0),U,4)="I":"INITIAL ISSUE",$P(R1(0),U,4)="X":"REPAIR",$P(R1(0),U,4)="R":"REPLACE",$P(R1(0),U,4)="S":"SPARE",$P(R1(0),U,4)="5":"RENTAL",1:"")
"RTN","RMPRHISD",11,0)
 S $P(R4("D"),U,3)=$S($P(R1("AM"),U,3)=1:"SC/OP",$P(R1("AM"),U,3)=2:"SC/IP",$P(R1("AM"),U,3)=3:"NSC/IP",$P(R1("AM"),U,3)=4:"NSC/OP")
"RTN","RMPRHISD",12,0)
 S:$P(R1("AM"),U,3)=4&($P(R1("AM"),U,4)) $P(R4("D"),U,4)=$S($P(R1("AM"),U,4)=1:"SPECIAL LEGISLATION",$P(R1("AM"),U,4)=2:"A&A",$P(R1("AM"),U,4)=3:"PHC",$P(R1("AM"),U,4)=4:"ELIGIBILITY REFORM",1:"")
"RTN","RMPRHISD",13,0)
 S $P(R3("D"),U,6)=$P(^RMPR(661,$P(R1(0),U,6),0),U,1),RMPROIT=$P(R3("D"),U,6),Y=$P(R1(0),U,12) G:Y="" CO D DD^%DT S $P(R3("D"),U,12)=Y,RMPROQT=$P(R1(0),U,7)
"RTN","RMPRHISD",14,0)
CO D ^RMPRST2
"RTN","RMPRHISD",15,0)
DEL S DIR(0)="Y",DIR("B")="NO",DIR("A")="Would you like to Delete this Transaction" D ^DIR G:$D(DIRUT) EXIT I +Y=1 S DIK="^RMPR(660,",DA=RMPRIEN D ^DIK W !?10,"Deleted..." H 1 G EXIT
"RTN","RMPRHISD",16,0)
 K DIR,Y S DIR(0)="Y",DIR("B")="YES",DIR("A")="Would you like to Edit this Transaction" D ^DIR G:$D(DIRUT) EXIT I +Y=1 S DIE="^RMPR(660,",DA=RMPRIEN,DR="1R;12R;4R;7R;2R;62R;63;14R~UNIT COST;5R;10;9;21" D ^DIE G CO
"RTN","RMPRHISD",17,0)
EXIT K DIK,J,DIC,DIR,DA,%,HL,RMPRNAM,RMPRSSN,RMPRHISD,RMPRIEN,RMPROIT,RMPROQT,RMPRIPT,R1,R3,R4,Y,X,RZZZ,%X,%Y Q
"RTN","RMPRL9")
0^35^B23118743
"RTN","RMPRL9",1,0)
RMPRL9 ;PHX/HNB-DISPLAY ITEMS ON 1358 TRANSACTION ;8/29/1994
"RTN","RMPRL9",2,0)
 ;;3.0;PROSTHETICS;**19,90**;Feb 09, 1996
"RTN","RMPRL9",3,0)
 S:'$D(RMPRDELN) RMPRDELN="" S (RMPRI,RMPRCNT)=0,RMPRX="" D HOME^%ZIS W @IOF S:'$D(RMPRSER) RMPRSER=""
"RTN","RMPRL9",4,0)
 W ?0,$E($G(^UTILITY("DIQ1",$J,664.1,RMPRDA,.02)),1,30),?40,"WORK ORDER #: ",$G(^UTILITY("DIQ1",$J,664.1,RMPRDA,4))
"RTN","RMPRL9",5,0)
 S $P(LINE,"=",IOM)="",RZZZ=0
"RTN","RMPRL9",6,0)
 W !,LINE
"RTN","RMPRL9",7,0)
LI F  S RMPRI=$O(^RMPR(664,RMPRA,1,RMPRI)) Q:RMPRI'>0!($G(RMPRX)="^")  S RMPRCNT=RMPRCNT+1,RMPRI1=^RMPR(664,RMPRA,1,RMPRI,0) D PRT
"RTN","RMPRL9",8,0)
 I $G(RMPRX)="^" I $Y<17 F  W ! Q:$Y>17
"RTN","RMPRL9",9,0)
 I $G(RMPRX)="^" Q
"RTN","RMPRL9",10,0)
 W !,?25,"TOTAL COST: ",?65,"$",$J(RZZZ,0,2)
"RTN","RMPRL9",11,0)
 I $Y<17 F  W ! Q:$Y>17
"RTN","RMPRL9",12,0)
 Q
"RTN","RMPRL9",13,0)
PRT I RMPRCNT<0 W !,"NO ITEMS ON FILE" Q
"RTN","RMPRL9",14,0)
 W !!?5,"ITEM: "
"RTN","RMPRL9",15,0)
 S RMPRIT=$P(RMPRI1,U,1),RMPRIT1=$P(^RMPR(661,RMPRIT,0),U,1)
"RTN","RMPRL9",16,0)
 W $P(^PRC(441,RMPRIT1,0),U,1),"   ",$P(^(0),U,2),"   ",?45,"AMIS: " S RMPRAMIS=$S($P(RMPRI1,U,9)'="X":$P(^RMPR(661,RMPRIT,0),U,3),1:$P(^RMPR(661,RMPRIT,0),U,4))
"RTN","RMPRL9",17,0)
 W !!?5,"DESCRIPTION: ",$P(RMPRI1,U,2)
"RTN","RMPRL9",18,0)
 W !?5,"SERIAL NUMBER: " S RMPRSER=$S($P(^RMPR(664,RMPRA,1,RMPRI,0),U,15)]"":$P(^(0),U,15),$D(^RMPR(660,+$P(^(0),U,13),0)):$P(^(0),U,11),1:"") W RMPRSER
"RTN","RMPRL9",19,0)
 W !?5,"UNIT COST: ",$J($S($P(RMPRI1,U,7):$P(RMPRI1,U,7),1:$P(RMPRI1,U,3)),0,2),?25,"UNIT OF ISSUE: "
"RTN","RMPRL9",20,0)
 S RMPRU=$P(RMPRI1,U,5) W:RMPRU'="" $P(^PRCD(420.5,RMPRU,0),U,1),?45,"QTY: ",$P(RMPRI1,U,4),?55,"ITEM COST: "
"RTN","RMPRL9",21,0)
 S R1=$S($P(RMPRI1,U,7):$P(RMPRI1,U,7),1:$P(RMPRI1,U,3)),R2=$P(RMPRI1,U,4),RZZZ=RZZZ+(R1*R2) W $J(R1*R2,0,2)
"RTN","RMPRL9",22,0)
 W !?5,"TYPE: ",$S($P(RMPRI1,U,9)="X":"REPAIR",$P(RMPRI1,U,9)="I":"INITIAL",$P(RMPRI1,U,9)="R":"REPLACE",$P(RMPRI1,U,9)="S":"SPARE",$P(RMPRI1,U,9)="5":"RENTAL",1:"")
"RTN","RMPRL9",23,0)
 W ?25,"CATEGORY: ",$S($P(RMPRI1,U,10)=1:"SC/OP",$P(RMPRI1,U,10)=2:"SC/IP",$P(RMPRI1,U,10)=3:"NSC/IP",$P(RMPRI1,U,10)=4:"NSC/OP",1:"")
"RTN","RMPRL9",24,0)
 W ?44,"SPECIAL CATEGORY: "
"RTN","RMPRL9",25,0)
 W $S($P(RMPRI1,U,11)=1:"SPEC/LEG",$P(RMPRI1,U,11)=2:"A&A",$P(RMPRI1,U,11)=3:"PHC",$P(RMPRI1,U,11)=4:"ELIG/REF",1:"")
"RTN","RMPRL9",26,0)
ASK I $Y>17 R !!,"Enter '^' to Quit Display, <Return> to Continue : ",RMPRX:DTIME S:'$T RMPRX="^" Q:RMPRX="^"
"RTN","RMPRL9",27,0)
 Q
"RTN","RMPRL9",28,0)
C21 ;COMPLETE 2421 REQUEST FROM LAB
"RTN","RMPRL9",29,0)
 S RT=$O(^RMPR(664,RMPRA,1,0)) I RT>0,$D(^(RT,0)) S:$G(RMPRCONT)="" RMPRCONT=$P(^(0),U,14)
"RTN","RMPRL9",30,0)
 K FL D ^RMPRLI I RMPRX]"" G CHK
"RTN","RMPRL9",31,0)
L2 W !! K DIR S DIR(0)="FO",DIR("A")="Select Item to Edit",DIR("?")="^S ZFL=1 D ZDSP^RMPR21A" D ^DIR G:$D(DTOUT) EXIT G:$D(DIRUT) COT S DIC="^RMPR(661,",DIC(0)="EQMZ" D ^DIC G:+Y'>0 L2
"RTN","RMPRL9",32,0)
 D EDT^RMPRUTIL G:$D(DTOUT) EXIT G L2
"RTN","RMPRL9",33,0)
COT S DIE="^RMPR(664,",DR="4",DA=RMPRA D ^DIE I $D(DTOUT)!($D(Y)'=0) G CHK
"RTN","RMPRL9",34,0)
 S RMPRV=$P(^RMPR(664,RMPRA,0),U,4) G:'$D(^PRC(440,RMPRV,4)) L2 K DIR S DIR(0)="PO^PRC(440,"_RMPRV_",4,:QEM" S:$G(RMPRCONT)'="" DIR("B")=RMPRCONT D ^DIR I (Y'>0)&(X'="")&(X'["^") G COT
"RTN","RMPRL9",35,0)
 I X["^" G CHK
"RTN","RMPRL9",36,0)
 I Y>0,$P(^PRC(440,RMPRV,4,+Y,0),U,2)<DT W $C(7),!,"Sorry, contract has expired.  Enter another contract or `return` to continue." G COT
"RTN","RMPRL9",37,0)
 K DIR,DA S:Y>0 (RMPRCONT,RMPRCTK)=$P(Y,U,2)
"RTN","RMPRL9",38,0)
 K DA S DIE="^RMPR(664,",DA=RMPRA,DR="11;17;20" D ^DIE G:$D(Y) CHK G:$D(DTOUT) EXIT
"RTN","RMPRL9",39,0)
 K DIR S:$G(RMPRDELN)'="" DIR("B")=RMPRDELN
"RTN","RMPRL9",40,0)
 S DIR(0)="SA^1:VETERAN;2:VAMC WAREHOUSE;3:PROSTHETICS;4:OTHER;",DIR("A")="DELIVER TO: "
"RTN","RMPRL9",41,0)
 D ^DIR G:$D(DIRUT) CHK G:$D(DTOUT) EXIT
"RTN","RMPRL9",42,0)
 S RMPRDELN=Y(0) I Y'=4 S $P(^RMPR(664,RMPRA,3),U)=RMPRDELN K RMPRDLC G CHK
"RTN","RMPRL9",43,0)
 S $P(^RMPR(664,RMPRA,3),U)=$S($G(RMPRDLC)'="":RMPRDLC,1:""),DIE="^RMPR(664,",DA=RMPRA,DR="19T" D ^DIE G:$D(DTOUT) EXIT S RMPRDLC=$P(^RMPR(664,RMPRA,3),U)
"RTN","RMPRL9",44,0)
CHK S FL=1 I $D(^RMPR(664,RMPRA,1)) S FL=0 F RI=0:0 S RI=$O(^RMPR(664,RMPRA,1,RI)) Q:RI'>0  I $D(^(RI,0)) S FL=1 I $P(^(0),U,4)=""!($P(^(0),U,5)="")!($P(^(0),U,9)="")!($P(^(0),U,10)="") S FL=0 Q
"RTN","RMPRL9",45,0)
 I $P($G(^RMPR(664,RMPRA,3)),U)="" W !!,$C(7),"Deliver To information is Missing!!  2421 is incomplete" G EXIT
"RTN","RMPRL9",46,0)
 I 'FL W !!,?5,$C(7),"REQUIRED ITEM INFORMATION IS MISSING",! G EXIT
"RTN","RMPRL9",47,0)
ASK5 S %=2 W !!,"Are you ready to POST to IFCAP and 10-2319 NOW" D YN^DICN G:%=1 FILE^RMPR21B G:$D(DTOUT) EXIT
"RTN","RMPRL9",48,0)
 I %=0 W !,"This will Create a Daily Transaction in the 1358 Module of IFCAP,",!,"and Create an Entry on the Prosthetic 10-2319 Record" G ASK5
"RTN","RMPRL9",49,0)
 I %'>0 S %=2 R !,"Do you want to delete the 2421 Request" D YN^DICN I $D(DTOUT)!(%=1) D DEL^RMPR29M(RMPRA) G KILL^RMPR21
"RTN","RMPRL9",50,0)
 G C21
"RTN","RMPRL9",51,0)
EXIT I '$D(DTOUT) K DIR S DIR(0)="Y",DIR("B")="NO",DIR("A")="Do You want to delete the 2421 Request" D ^DIR Q:$D(DTOUT)  I +Y=1 D DEL^RMPR29M(RMPRA) G KILL^RMPR21
"RTN","RMPRL9",52,0)
 Q
"RTN","RMPRLI")
0^36^B12355017
"RTN","RMPRLI",1,0)
RMPRLI ;PHX/HNB,RVD-DISPLAY ITEMS ON 1358 TRANSACTION ;10/19/1993
"RTN","RMPRLI",2,0)
 ;;3.0;PROSTHETICS;**12,19,28,41,90**;Feb 09, 1996
"RTN","RMPRLI",3,0)
 ;pass RMPRSSN,RMPRNAM,RMPRA,RMPROB
"RTN","RMPRLI",4,0)
 S:'$D(RMPRDELN) RMPRDELN="" S (RMPRI,RMPRCNT)=0,RMPRX="" D HOME^%ZIS W @IOF S:'$D(RMPRSER) RMPRSER=""
"RTN","RMPRLI",5,0)
 W !?5,RMPRNAM,?35,$E(RMPRSSN,1,3)_"-"_$E(RMPRSSN,4,5)_"-"_$E(RMPRSSN,6,9),?55,RMPROB,!
"RTN","RMPRLI",6,0)
 N RBO S RBO=0
"RTN","RMPRLI",7,0)
 W !,RMPR("L")
"RTN","RMPRLI",8,0)
LI F  S RMPRI=$O(^RMPR(664,RMPRA,1,RMPRI)) Q:RMPRI'>0  D  G:$G(RMPRX)["^" EXIT
"RTN","RMPRLI",9,0)
 .S RMPRCNT=RMPRCNT+1
"RTN","RMPRLI",10,0)
 .S RMPRI1=^RMPR(664,RMPRA,1,RMPRI,0)
"RTN","RMPRLI",11,0)
 .D PRT
"RTN","RMPRLI",12,0)
 I $D(^RMPR(664,RMPRA,1)) W !!,?25,"SUB TOTAL: ",?65,"$",$J(RBO,7,2)
"RTN","RMPRLI",13,0)
 I $D(^RMPR(664,RMPRA,2)),$P(^(2),U,6) S DCT=$P(^(2),U,6),DCT=DCT/100
"RTN","RMPRLI",14,0)
 I $D(RMPRF) I ((RMPRF=9)!(RMPRF=2)!(RMPRF="E")),$D(^RMPR(664,RMPRA,1)) D
"RTN","RMPRLI",15,0)
 .W !!,?25,"% DISCOUNT:  "
"RTN","RMPRLI",16,0)
 .Q:'$D(DCT)
"RTN","RMPRLI",17,0)
 .W DCT*100
"RTN","RMPRLI",18,0)
 .S DCTT=$J(RBO*DCT,7,2)
"RTN","RMPRLI",19,0)
 .W ?65,"$",DCTT
"RTN","RMPRLI",20,0)
 .S DCTT=$TR(DCTT," ","")
"RTN","RMPRLI",21,0)
 .S RBO=RBO-DCTT
"RTN","RMPRLI",22,0)
 .K DCT,DCTT
"RTN","RMPRLI",23,0)
 W !?25,"SHIPPING CHARGE: "
"RTN","RMPRLI",24,0)
 S R2=$S($P(^RMPR(664,RMPRA,0),U,11)]"":$P(^(0),U,11),$P(^(0),U,10):$P(^(0),U,10),1:"") W ?65,"$",$J(R2,7,2) W !
"RTN","RMPRLI",25,0)
 W !,?25,"TOTAL COST: ",?65,"$",$J(R2+RBO,7,2)
"RTN","RMPRLI",26,0)
 G EXIT
"RTN","RMPRLI",27,0)
PRT I RMPRCNT<0 W !,"NO ITEMS ON FILE" Q
"RTN","RMPRLI",28,0)
 W !!?5,"ITEM: "
"RTN","RMPRLI",29,0)
 S RMPRIT=$P(RMPRI1,U,1),RMPRIT1=$P(^RMPR(661,RMPRIT,0),U,1)
"RTN","RMPRLI",30,0)
 W $P(^PRC(441,RMPRIT1,0),U,1),"   ",$P(^(0),U,2),"   ",?45,"AMIS: " S RMPRAMIS=$S($P(RMPRI1,U,9)'="X":$P(^RMPR(661,RMPRIT,0),U,3),1:$P(^RMPR(661,RMPRIT,0),U,4))
"RTN","RMPRLI",31,0)
 W $S(RMPRAMIS="":"NO CODE FOR THIS ITEM",1:$P(^RMPR(663,RMPRAMIS,0),U,1))
"RTN","RMPRLI",32,0)
 S RCPT=$P(^RMPR(664,RMPRA,1,RMPRI,0),U,16)
"RTN","RMPRLI",33,0)
 S:RCPT RMPRCPT=$G(^RMPR(661.1,RCPT,0))
"RTN","RMPRLI",34,0)
 I $D(RMPRCPT) W !,?5,"PSAS HCPCS CODE: ",$P(RMPRCPT,U,1),?29,$P(RMPRCPT,U,2)
"RTN","RMPRLI",35,0)
 W !,?5,"CPT MODIFIER: ",$P($G(^RMPR(664,RMPRA,1,RMPRI,4)),U,2)
"RTN","RMPRLI",36,0)
 K RCPT,RMPRCPT
"RTN","RMPRLI",37,0)
 I $P(^RMPR(664,RMPRA,1,RMPRI,0),U,8)'="" W !?5,"REMARKS: ",$P(^(0),U,8)
"RTN","RMPRLI",38,0)
 I $D(RMPRF),RMPRF=2 W !!?5,"DELIVER TO: ",RMPRDELN
"RTN","RMPRLI",39,0)
 W !!?5,"DESCRIPTION: ",$P(RMPRI1,U,2)
"RTN","RMPRLI",40,0)
 W !?5,"SERIAL NUMBER: " S RMPRSER=$S($P(^RMPR(664,RMPRA,1,RMPRI,0),U,15)]"":$P(^(0),U,15),$D(^RMPR(660,+$P(^(0),U,13),0)):$P(^(0),U,11),1:"") W RMPRSER
"RTN","RMPRLI",41,0)
 ;W !?5,"UNIT COST: ",$J($S($P(RMPRI1,U,7):$P(RMPRI1,U,7),1:$P(RMPRI1,U,3)),0,2),?25,"UNIT OF ISSUE: "
"RTN","RMPRLI",42,0)
 W !,?5,"UNIT COST: " S R1=$P(RMPRI1,U,7) S:R1=""!(R1<0) R1=$P(RMPRI1,U,3) W R1,?25,"UNIT OF ISSUE: "
"RTN","RMPRLI",43,0)
 S RMPRU=$P(RMPRI1,U,5) W:RMPRU'="" $P(^PRCD(420.5,RMPRU,0),U,1),?45,"QTY: ",$P(RMPRI1,U,4),?55,"ITEM COST: "
"RTN","RMPRLI",44,0)
 ;S R1=$S($P(RMPRI1,U,7):$P(RMPRI1,U,7),1:$P(RMPRI1,U,3)),R2=$P(RMPRI1,U,4),RBO=RBO+(R1*R2) W $J(R1*R2,0,2)
"RTN","RMPRLI",45,0)
 S R2=$P(RMPRI1,U,4)
"RTN","RMPRLI",46,0)
 S RBO=RBO+(R1*R2) W $J(R1*R2,0,2)
"RTN","RMPRLI",47,0)
 W !?5,"TYPE: ",$S($P(RMPRI1,U,9)="X":"REPAIR",$P(RMPRI1,U,9)="I":"INITIAL",$P(RMPRI1,U,9)="R":"REPLACE",$P(RMPRI1,U,9)="S":"SPARE",$P(RMPRI1,U,9)="5":"RENTAL",1:"")
"RTN","RMPRLI",48,0)
 W ?25,"CATEGORY: ",$S($P(RMPRI1,U,10)=1:"SC/OP",$P(RMPRI1,U,10)=2:"SC/IP",$P(RMPRI1,U,10)=3:"NSC/IP",$P(RMPRI1,U,10)=4:"NSC/OP",1:"")
"RTN","RMPRLI",49,0)
 W ?44,"SPECIAL CATEGORY: "
"RTN","RMPRLI",50,0)
 W $S($P(RMPRI1,U,11)=1:"SPEC/LEG",$P(RMPRI1,U,11)=2:"A&A",$P(RMPRI1,U,11)=3:"PHC",$P(RMPRI1,U,11)=4:"ELIGIBILITY REFORM",1:"")
"RTN","RMPRLI",51,0)
ASK I $Y>17 R !!,"Enter '^' to Quit Display, <Return> to Continue : ",RMPRX:DTIME S:'$T RMPRX="^" Q:RMPRX="^"
"RTN","RMPRLI",52,0)
 W:$Y>17 @IOF
"RTN","RMPRLI",53,0)
 Q
"RTN","RMPRLI",54,0)
EXIT K RMPRI1,R1,R2,ON,OFF Q
"RTN","RMPRN6")
0^25^B84903534
"RTN","RMPRN6",1,0)
RMPRN6 ;Hines OIFO/HNC-PRINT NPPD LOCAL DATA ;3/17/03  11:38
"RTN","RMPRN6",2,0)
 ;;3.0;PROSTHETICS;**31,32,34,36,39,48,51,70,77,90**;Feb 09, 1996
"RTN","RMPRN6",3,0)
 ;RVD 3/17/03 patch #77 - fix undefined and closing device.
"RTN","RMPRN6",4,0)
 ;SPS 5/24/05 Patch #90 - check for type of 5 Rental.
"RTN","RMPRN6",5,0)
 D DIV4^RMPRSIT G:$D(X) EXIT
"RTN","RMPRN6",6,0)
DATE S %DT="XEA",%DT("A")="Enter Date to Start NPPD Calculations From: " D ^%DT G:X[U!(X="")!($D(DTOUT)) EXIT
"RTN","RMPRN6",7,0)
 S DATE(1)=+Y
"RTN","RMPRN6",8,0)
 S %DT="XEA",%DT("A")="Enter End Date: " D ^%DT G:X[U!(X="")!($D(DTOUT)) EXIT S DATE(2)=+Y
"RTN","RMPRN6",9,0)
 I DATE(1)>DATE(2) W !!,$C(7),"ENDING DATE RANGE IS LESS THAN BEGINNING DATE RANGE",! G DATE
"RTN","RMPRN6",10,0)
 Q:$D(RMPRCDE)
"RTN","RMPRN6",11,0)
DET ;select detail or brief
"RTN","RMPRN6",12,0)
 D DISP^RMPRN6S
"RTN","RMPRN6",13,0)
 K DIR
"RTN","RMPRN6",14,0)
 ;S DIR(0)="S^D:DETAIL;B:BRIEF"
"RTN","RMPRN6",15,0)
 S DIR(0)="S^1:BRIEF NEW SUMMARY;2:BRIEF USED SUMMARY;3:BRIEF BOTH SUMMARY;4:DETAIL & NEW SUMMARY;5:DETAIL & USED SUMMARY;6:DETAIL & BOTH SUMMARY"
"RTN","RMPRN6",16,0)
 S DIR("A")="Type of Report",DIR("B")="DETAIL & NEW SUMMARY" D ^DIR
"RTN","RMPRN6",17,0)
 Q:$D(DIRUT)!($D(DTOUT))
"RTN","RMPRN6",18,0)
 S RMPRDET=Y
"RTN","RMPRN6",19,0)
DEV ;device
"RTN","RMPRN6",20,0)
 S %ZIS="Q" D ^%ZIS G:POP EXIT K IOP I $E(IOST,1,2)["C-" G PRT
"RTN","RMPRN6",21,0)
 I $D(IO("Q")) S ZTIO=ION,ZTSAVE("RMPRSITE")="",ZTSAVE("RMPR(")=""
"RTN","RMPRN6",22,0)
 I  S ZTSAVE("DATE(")="",ZTSAVE("RMPRZ")="",ZTSAVE("RMPRDET")=""
"RTN","RMPRN6",23,0)
 I  S ZTRTN="PRT^RMPRN6",ZTDESC="Prosthetic NPPD" D ^%ZTLOAD K ZTDESC,ZTIO,ZTRTN,ZTSAVE G EXIT
"RTN","RMPRN6",24,0)
PRT ;print
"RTN","RMPRN6",25,0)
 I '$D(IO("Q")) U IO
"RTN","RMPRN6",26,0)
 D GNP,GNPC
"RTN","RMPRN6",27,0)
 Q
"RTN","RMPRN6",28,0)
ENL ;entry point for one line
"RTN","RMPRN6",29,0)
 D DIV4^RMPRSIT G:$D(X) EXIT
"RTN","RMPRN6",30,0)
 S RMPRCDE=1
"RTN","RMPRN6",31,0)
 D DATE
"RTN","RMPRN6",32,0)
 G:'$D(DATE(1))!('$D(DATE(2))) EXIT
"RTN","RMPRN6",33,0)
 ;single line always new and used (BOTH) sort
"RTN","RMPRN6",34,0)
 S RMPRDET=6
"RTN","RMPRN6",35,0)
 D GNPCC,EXIT
"RTN","RMPRN6",36,0)
 Q
"RTN","RMPRN6",37,0)
GNP ;gather nppd data
"RTN","RMPRN6",38,0)
 S $P(LN,"-",IOM)=""
"RTN","RMPRN6",39,0)
 S DATE=DATE(1)-1
"RTN","RMPRN6",40,0)
 K ^TMP($J)
"RTN","RMPRN6",41,0)
 F  S DATE=$O(^RMPR(660,"B",DATE)) Q:(DATE="")!($P(DATE,".",1)>DATE(2))  D
"RTN","RMPRN6",42,0)
 .S RMPRB=0
"RTN","RMPRN6",43,0)
 .F  S RMPRB=$O(^RMPR(660,"B",DATE,RMPRB)) Q:RMPRB'>0  D
"RTN","RMPRN6",44,0)
 ..;define variables for record
"RTN","RMPRN6",45,0)
 ..S REC=$G(^RMPR(660,RMPRB,0)) Q:REC=""
"RTN","RMPRN6",46,0)
 ..Q:$P(REC,U,15)["*"
"RTN","RMPRN6",47,0)
 ..Q:$P(REC,U,10)'=RMPR("STA")
"RTN","RMPRN6",48,0)
 ..;check for used pip
"RTN","RMPRN6",49,0)
 ..;if used pip sort, not pip, not va, quit
"RTN","RMPRN6",50,0)
 ..I $G(RMPRDET)=2&($P($G(^RMPR(660,RMPRB,1)),U,5)'="")&($P(REC,U,14)'="V") Q
"RTN","RMPRN6",51,0)
 ..I $G(RMPRDET)=5&($P($G(^RMPR(660,RMPRB,1)),U,5)'="")&($P(REC,U,14)'="V") Q
"RTN","RMPRN6",52,0)
 ..S TYPE=$P(REC,U,4)
"RTN","RMPRN6",53,0)
 ..S TY=$S(TYPE="X":2,TYPE=5:2,TYPE="I":1,1:3)
"RTN","RMPRN6",54,0)
 ..S MR=$P($G(^RMPR(660,RMPRB,1)),U,4)
"RTN","RMPRN6",55,0)
 ..I $P(^RMPR(660,RMPRB,0),U,17)'=""&($P(^(0),U,26)="") S TY=2,LINE="R90 A",MR=2676
"RTN","RMPRN6",56,0)
 ..;PICKUP AND DELIVERY
"RTN","RMPRN6",57,0)
 ..I $P(^RMPR(660,RMPRB,0),U,26)'="" S TY=2,LINE="R80 D",MR=2951
"RTN","RMPRN6",58,0)
 ..Q:MR=""
"RTN","RMPRN6",59,0)
 ..;        PATCH 70             Auto-fix
"RTN","RMPRN6",60,0)
 ..K LINE
"RTN","RMPRN6",61,0)
 ..I TY'=2 S LINE=$P(^RMPR(661.1,MR,0),U,7)
"RTN","RMPRN6",62,0)
 ..I TY'=2&($G(LINE)="") D
"RTN","RMPRN6",63,0)
 ...; I TYPE=5 Q
"RTN","RMPRN6",64,0)
 ...S ERR=""
"RTN","RMPRN6",65,0)
 ...S LINE=$P(^RMPR(661.1,MR,0),U,6)
"RTN","RMPRN6",66,0)
 ...S TYPE="X"
"RTN","RMPRN6",67,0)
 ...S DIE="^RMPR(660,",DA=RMPRB,DR="2///^S X=TYPE"
"RTN","RMPRN6",68,0)
 ...L +^RMPR(660,RMPRB):1 I '$T S ERR=1
"RTN","RMPRN6",69,0)
 ...I ERR="" D ^DIE L -^RMPR(660,RMPRB)
"RTN","RMPRN6",70,0)
 ...K DIE,DA,DR
"RTN","RMPRN6",71,0)
 ...I ERR=1 S ^TMP($J,"RMPRA",RMPRB)="NO UPDATE!"
"RTN","RMPRN6",72,0)
 ...I ERR="" S ^TMP($J,"RMPRA",RMPRB)="NEW TO REPAIR"
"RTN","RMPRN6",73,0)
 ...S B=RMPRB D DATA^RMPRN6XM
"RTN","RMPRN6",74,0)
 ..I TY=2 S LINE=$P(^RMPR(661.1,MR,0),U,6)
"RTN","RMPRN6",75,0)
 ..I TY=2&($G(LINE)="") D
"RTN","RMPRN6",76,0)
 ...; I TYPE=5 Q
"RTN","RMPRN6",77,0)
 ...S ERR=""
"RTN","RMPRN6",78,0)
 ...S LINE=$P(^RMPR(661.1,MR,0),U,7)
"RTN","RMPRN6",79,0)
 ...S TYPE="I"
"RTN","RMPRN6",80,0)
 ...S DIE="^RMPR(660,",DA=RMPRB,DR="2///^S X=TYPE"
"RTN","RMPRN6",81,0)
 ...L +^RMPR(660,RMPRB):1 I '$T S ERR=1
"RTN","RMPRN6",82,0)
 ...I ERR="" D ^DIE L -^RMPR(660,RMPRB)
"RTN","RMPRN6",83,0)
 ...K DIE,DA,DR
"RTN","RMPRN6",84,0)
 ...I ERR=1 S ^TMP($J,"RMPRA",RMPRB)="NO UPDATE!"
"RTN","RMPRN6",85,0)
 ...I ERR="" S ^TMP($J,"RMPRA",RMPRB)="REPAIR TO NEW"
"RTN","RMPRN6",86,0)
 ...S B=RMPRB D DATA^RMPRN6XM
"RTN","RMPRN6",87,0)
 ..;
"RTN","RMPRN6",88,0)
 ..I LINE="" W !,"Line is null, something wrong with file 661.1  :",MR
"RTN","RMPRN6",89,0)
 ..;set to 999 group if null
"RTN","RMPRN6",90,0)
 ..S FLAG=$P(^RMPR(661.1,MR,0),U,8)
"RTN","RMPRN6",91,0)
 ..I FLAG="" S FLAG=2
"RTN","RMPRN6",92,0)
 ..S CATEGRY=$P($G(^RMPR(660,RMPRB,"AM")),U,3),SPEC=$P($G(^("AM")),U,4),GN=$P($G(^("AMS")),U,1)
"RTN","RMPRN6",93,0)
 ..Q:GN=""
"RTN","RMPRN6",94,0)
 ..D SET
"RTN","RMPRN6",95,0)
 D FMT^RMPRN6XM,MAIL^RMPRN6XM
"RTN","RMPRN6",96,0)
 Q
"RTN","RMPRN6",97,0)
GNPC ;worksheet/detail
"RTN","RMPRN6",98,0)
 S STN=RMPR("NAME")
"RTN","RMPRN6",99,0)
 D CAL^RMPRN6
"RTN","RMPRN6",100,0)
 S PAGE=0,FL=""
"RTN","RMPRN6",101,0)
 D ^RMPRN6PT
"RTN","RMPRN6",102,0)
 G:FL=1 EXIT
"RTN","RMPRN6",103,0)
 D ^RMPRN6PR
"RTN","RMPRN6",104,0)
 G:FL=1 EXIT
"RTN","RMPRN6",105,0)
 I RMPRDET<4 G EXIT
"RTN","RMPRN6",106,0)
 D DESP^RMPRN63
"RTN","RMPRN6",107,0)
 D DESPR^RMPRN63
"RTN","RMPRN6",108,0)
EXIT ;commom exit point
"RTN","RMPRN6",109,0)
 D ^%ZISC
"RTN","RMPRN6",110,0)
 N RMPR,RMPRSITE
"RTN","RMPRN6",111,0)
 K ^TMP($J) D KILL^XUSCLEAN
"RTN","RMPRN6",112,0)
 Q
"RTN","RMPRN6",113,0)
GNPCC ;one line only
"RTN","RMPRN6",114,0)
 S STN=RMPR("NAME")
"RTN","RMPRN6",115,0)
 D CODE^RMPRN63
"RTN","RMPRN6",116,0)
 D ^RMPRN6UT
"RTN","RMPRN6",117,0)
 G:$D(DIRUT)!($D(DTOUT)) EXIT
"RTN","RMPRN6",118,0)
 I $G(RMPRCDE)="" S RMPRCDE="",RMPRCDE=$O(BRA(Y,RMPRCDE))
"RTN","RMPRN6",119,0)
 S Y=DATE(1) D DD^%DT S DATE(3)=Y,Y=DATE(2) D DD^%DT S DATE(4)=Y
"RTN","RMPRN6",120,0)
 S %ZIS="Q" D ^%ZIS G:POP EXIT K IOP I $E(IOST,1,2)["C-" G PRTL
"RTN","RMPRN6",121,0)
 I $D(IO("Q")) S ZTIO=ION,ZTSAVE("RMPRSITE")="",ZTSAVE("RMPR(")=""
"RTN","RMPRN6",122,0)
 I  S ZTSAVE("DATE(")="",ZTSAVE("RMPRZ")="",ZTSAVE("RMPRDET")="",ZTSAVE("RMPRCDE")=""
"RTN","RMPRN6",123,0)
 I  S ZTRTN="PRTL^RMPRN6",ZTDESC="Prosthetic NPPD" D ^%ZTLOAD K ZTDESC,ZTIO,ZTRTN,ZTSAVE G EXIT
"RTN","RMPRN6",124,0)
PRTL ;print one line entry from taskman
"RTN","RMPRN6",125,0)
 I '$D(IO("Q")) U IO
"RTN","RMPRN6",126,0)
 D GNP
"RTN","RMPRN6",127,0)
 D CAL^RMPRN6
"RTN","RMPRN6",128,0)
 S PAGE=0,FL=""
"RTN","RMPRN6",129,0)
 S CODE=RMPRCDE
"RTN","RMPRN6",130,0)
 D DESP^RMPRN6PL
"RTN","RMPRN6",131,0)
 Q
"RTN","RMPRN6",132,0)
SET ;set temp global
"RTN","RMPRN6",133,0)
 S STN=RMPR("NAME")
"RTN","RMPRN6",134,0)
 S ^TMP($J,"RMPRGN",STN,GN,FLAG,LINE,RMPRB)=""
"RTN","RMPRN6",135,0)
 S RMSSN=$P(^RMPR(660,RMPRB,0),U,2) I RMSSN S RMSSN=$P(^DPT(RMSSN,0),U,9)
"RTN","RMPRN6",136,0)
 I RMSSN'="" S ^TMP($J,"A",RMSSN)=""
"RTN","RMPRN6",137,0)
 K RMSSN
"RTN","RMPRN6",138,0)
 Q
"RTN","RMPRN6",139,0)
 ;
"RTN","RMPRN6",140,0)
LOOP ;sort on hcpcs key and grouper is complete
"RTN","RMPRN6",141,0)
 ;store in tmp($j,"N",station) or "R"
"RTN","RMPRN6",142,0)
 S (TAM,T1,RMPRB,COUNT,CODE,RMPRAD,DATE,RMPRFG,RMPRT,RMPRI,RMPRNW,RMPRRPR)=0
"RTN","RMPRN6",143,0)
 S (TQTY,RMPROTH,CC,RMPRC,RMPRN,TT,RMPRPSC,VA,CM,RMPRCT1,SO,SI,DIS,RMPRCT,RMPR21,CODE,RMPRB,FM,LEG,RMPRNI,RMPRNO,RMPRSL,RMPRAA,RMPRPHC)=0
"RTN","RMPRN6",144,0)
 S DATE=DATE(1),RMPRB=0
"RTN","RMPRN6",145,0)
CAL ;loop through grouper key sort
"RTN","RMPRN6",146,0)
 S STN=RMPR("NAME")
"RTN","RMPRN6",147,0)
 D CODE^RMPRN63
"RTN","RMPRN6",148,0)
 S GN=""
"RTN","RMPRN6",149,0)
 F  S GN=$O(^TMP($J,"RMPRGN",STN,GN)) Q:GN=""  D
"RTN","RMPRN6",150,0)
 .S FLG=0
"RTN","RMPRN6",151,0)
 .F  S FLG=$O(^TMP($J,"RMPRGN",STN,GN,FLG)) Q:FLG'>0  D  I FLG=1&(RMPRDET'=2)!(RMPRDET'=5) Q
"RTN","RMPRN6",152,0)
 ..;used items never get grouped
"RTN","RMPRN6",153,0)
 ..I FLG=1&(RMPRDET'=2)&(RMPRDET'=5) D GROUP Q
"RTN","RMPRN6",154,0)
 ..;I FLG=1 D GROUP Q
"RTN","RMPRN6",155,0)
 ..S CODE=0
"RTN","RMPRN6",156,0)
 ..F  S CODE=$O(^TMP($J,"RMPRGN",STN,GN,FLG,CODE)) Q:CODE=""  D
"RTN","RMPRN6",157,0)
 ...S RD=0
"RTN","RMPRN6",158,0)
 ...F  S RD=$O(^TMP($J,"RMPRGN",STN,GN,FLG,CODE,RD)) Q:RD'>0  D
"RTN","RMPRN6",159,0)
 ....I RMPRDET=1!(RMPRDET=4) D SORT Q
"RTN","RMPRN6",160,0)
 ....I RMPRDET=2!(RMPRDET=5) D SORTUSED^RMPRN6S Q
"RTN","RMPRN6",161,0)
 ....I RMPRDET=3!(RMPRDET=6) D SORTBOTH^RMPRN6S Q
"RTN","RMPRN6",162,0)
 ....;D SORT
"RTN","RMPRN6",163,0)
 Q
"RTN","RMPRN6",164,0)
GROUP ;total grouper to main key
"RTN","RMPRN6",165,0)
 M BC=^TMP($J,"RMPRGN",STN,GN)
"RTN","RMPRN6",166,0)
 S BF=0,BTCOST=0,SRD=""
"RTN","RMPRN6",167,0)
 ;bc array is entrie PO 2421
"RTN","RMPRN6",168,0)
 F  S BF=$O(BC(BF)) Q:BF'>0  D
"RTN","RMPRN6",169,0)
 .;b1 is line,or code
"RTN","RMPRN6",170,0)
 .S BL=0
"RTN","RMPRN6",171,0)
 .F  S BL=$O(BC(BF,BL)) Q:BL=""  D
"RTN","RMPRN6",172,0)
 ..S BR=0
"RTN","RMPRN6",173,0)
 ..;BR is record number
"RTN","RMPRN6",174,0)
 ..F  S BR=$O(BC(BF,BL,BR)) Q:BR'>0  D
"RTN","RMPRN6",175,0)
 ...S BCOST=$P(^RMPR(660,BR,0),U,16)
"RTN","RMPRN6",176,0)
 ...S BTCOST=BTCOST+BCOST
"RTN","RMPRN6",177,0)
 ...I (BF=1)&(SRD="") S SRD=BR,CODE="",CODE=$O(BC(1,CODE))
"RTN","RMPRN6",178,0)
 K BC
"RTN","RMPRN6",179,0)
 Q:SRD=""
"RTN","RMPRN6",180,0)
 ;calculate based on primary
"RTN","RMPRN6",181,0)
 S TYPE=$P(^RMPR(660,SRD,0),U,4)
"RTN","RMPRN6",182,0)
 S TY=$S(TYPE="X":2,TYPE=5:2,TYPE="I":1,1:3)
"RTN","RMPRN6",183,0)
 S SOURCE=$P(^RMPR(660,SRD,0),U,14)
"RTN","RMPRN6",184,0)
 S COST=BTCOST
"RTN","RMPRN6",185,0)
 ;stock issue display and calculate zero used cost if VA source
"RTN","RMPRN6",186,0)
 I $P(^RMPR(660,SRD,1),U,5)'=""&(SOURCE["V") S BTCOST=0,COST=0
"RTN","RMPRN6",187,0)
 I $P(^RMPR(660,SRD,0),U,13)["-3" S COST=0,SOURCE="VA",BTCOST=0
"RTN","RMPRN6",188,0)
 S QTY=$P(^RMPR(660,SRD,0),U,7)
"RTN","RMPRN6",189,0)
 S ^TMP($J,CODE,SRD)=COST
"RTN","RMPRN6",190,0)
 S CATEGRY=$P($G(^RMPR(660,SRD,"AM")),U,3),SPEC=$P($G(^("AM")),U,4),GN=$P(^("AMS"),U,1)
"RTN","RMPRN6",191,0)
 ;new or repair code
"RTN","RMPRN6",192,0)
 S B1=SRD
"RTN","RMPRN6",193,0)
 I TY=2 D REP
"RTN","RMPRN6",194,0)
 I TY'=2 D NEW
"RTN","RMPRN6",195,0)
 Q
"RTN","RMPRN6",196,0)
SORT ;main data for worksheets
"RTN","RMPRN6",197,0)
 S TYPE=$P(^RMPR(660,RD,0),U,4)
"RTN","RMPRN6",198,0)
 S TY=$S(TYPE="X":2,TYPE=5:2,TYPE="I":1,1:3)
"RTN","RMPRN6",199,0)
 S SOURCE=$P(^RMPR(660,RD,0),U,14)
"RTN","RMPRN6",200,0)
 I SOURCE="" S SOURCE="C"
"RTN","RMPRN6",201,0)
 S CATEGRY=$P($G(^RMPR(660,RD,"AM")),U,3),SPEC=$P($G(^("AM")),U,4),GN=$P(^("AMS"),U,1)
"RTN","RMPRN6",202,0)
 S COST=$P(^RMPR(660,RD,0),U,16)
"RTN","RMPRN6",203,0)
 ;stock issue source VA, used cost calculation is zero
"RTN","RMPRN6",204,0)
 I $P(^RMPR(660,RD,1),U,5)'=""&(SOURCE["V") S COST=0
"RTN","RMPRN6",205,0)
 ;form
"RTN","RMPRN6",206,0)
 S FORM=$P(^RMPR(660,RD,0),U,13)
"RTN","RMPRN6",207,0)
 I (FORM=4)!(FORM=15) S COST=0,SOURCE="V"
"RTN","RMPRN6",208,0)
 S QTY=$P(^RMPR(660,RD,0),U,7)
"RTN","RMPRN6",209,0)
 S B1=RD
"RTN","RMPRN6",210,0)
 S ^TMP($J,CODE,RD)=COST
"RTN","RMPRN6",211,0)
 I TY=2 D REP
"RTN","RMPRN6",212,0)
 I TY'=2 D NEW
"RTN","RMPRN6",213,0)
 Q
"RTN","RMPRN6",214,0)
REP ;calculate repair cost
"RTN","RMPRN6",215,0)
 ;I $G(RD)'="" D
"RTN","RMPRN6",216,0)
 ;.S SSN=$P(^RMPR(660,RD,0),U,2) I SSN S SSN=$P(^DPT(SSN,0),U,9)
"RTN","RMPRN6",217,0)
 ;.I SSN'="" S ^TMP($J,"A",SSN)=""
"RTN","RMPRN6",218,0)
 ;.K SSN
"RTN","RMPRN6",219,0)
 S LINE=CODE
"RTN","RMPRN6",220,0)
 I LINE="R90 A" S SOURCE="C",QTY=1
"RTN","RMPRN6",221,0)
 I $G(^TMP($J,"R",STN,LINE))="" S ^TMP($J,"R",STN,LINE)=""
"RTN","RMPRN6",222,0)
 I SOURCE["V" S $P(^TMP($J,"R",STN,LINE),U,1)=$P(^TMP($J,"R",STN,LINE),U,1)+QTY
"RTN","RMPRN6",223,0)
 I SOURCE["C" S $P(^TMP($J,"R",STN,LINE),U,2)=$P(^TMP($J,"R",STN,LINE),U,2)+QTY
"RTN","RMPRN6",224,0)
 ;
"RTN","RMPRN6",225,0)
 S $P(^TMP($J,"R",STN,LINE),U,3)=$P(^TMP($J,"R",STN,LINE),U,3)+COST
"RTN","RMPRN6",226,0)
 I CATEGRY=1 S $P(^TMP($J,"R",STN,LINE),U,4)=$P(^TMP($J,"R",STN,LINE),U,4)+1
"RTN","RMPRN6",227,0)
 I CATEGRY=4 S $P(^TMP($J,"R",STN,LINE),U,5)=$P(^TMP($J,"R",STN,LINE),U,5)+1
"RTN","RMPRN6",228,0)
 I CATEGRY=2 S $P(^TMP($J,"R",STN,LINE),U,6)=$P(^TMP($J,"R",STN,LINE),U,6)+1
"RTN","RMPRN6",229,0)
 I CATEGRY=3 S $P(^TMP($J,"R",STN,LINE),U,7)=$P(^TMP($J,"R",STN,LINE),U,7)+1
"RTN","RMPRN6",230,0)
 I SPEC=1 S $P(^TMP($J,"R",STN,LINE),U,8)=$P(^TMP($J,"R",STN,LINE),U,8)+1
"RTN","RMPRN6",231,0)
 I SPEC=2 S $P(^TMP($J,"R",STN,LINE),U,9)=$P(^TMP($J,"R",STN,LINE),U,9)+1
"RTN","RMPRN6",232,0)
 I SPEC=3 S $P(^TMP($J,"R",STN,LINE),U,10)=$P(^TMP($J,"R",STN,LINE),U,10)+1
"RTN","RMPRN6",233,0)
 I SPEC=4 S $P(^TMP($J,"R",STN,LINE),U,11)=$P(^TMP($J,"R",STN,LINE),U,11)+1,$P(^(LINE),U,16)=$P(^(LINE),U,16)+COST
"RTN","RMPRN6",234,0)
 I TYPE="I" S $P(^TMP($J,"R",STN,LINE),U,12)=$P(^TMP($J,"R",STN,LINE),U,12)+1
"RTN","RMPRN6",235,0)
 Q
"RTN","RMPRN6",236,0)
 ;
"RTN","RMPRN6",237,0)
NEW ;calculate new costs
"RTN","RMPRN6",238,0)
 ;I $G(RD)'="" D
"RTN","RMPRN6",239,0)
 ;.S SSN=$P(^RMPR(660,RD,0),U,2) I SSN S SSN=$P(^DPT(SSN,0),U,9)
"RTN","RMPRN6",240,0)
 ;.I SSN'="" S ^TMP($J,"A",SSN)=""
"RTN","RMPRN6",241,0)
 ;.K SSN
"RTN","RMPRN6",242,0)
 S LINE=CODE
"RTN","RMPRN6",243,0)
 I $G(^TMP($J,"N",STN,LINE))="" S ^TMP($J,"N",STN,LINE)=""
"RTN","RMPRN6",244,0)
 I SOURCE["V" S $P(^TMP($J,"N",STN,LINE),U,1)=$P(^TMP($J,"N",STN,LINE),U,1)+QTY
"RTN","RMPRN6",245,0)
 I SOURCE["C" S $P(^TMP($J,"N",STN,LINE),U,2)=$P(^TMP($J,"N",STN,LINE),U,2)+QTY
"RTN","RMPRN6",246,0)
 S $P(^TMP($J,"N",STN,LINE),U,3)=$P(^TMP($J,"N",STN,LINE),U,3)+COST
"RTN","RMPRN6",247,0)
 I CATEGRY=1 S $P(^TMP($J,"N",STN,LINE),U,4)=$P(^TMP($J,"N",STN,LINE),U,4)+1
"RTN","RMPRN6",248,0)
 I CATEGRY=4 S $P(^TMP($J,"N",STN,LINE),U,5)=$P(^TMP($J,"N",STN,LINE),U,5)+1
"RTN","RMPRN6",249,0)
 I CATEGRY=2 S $P(^TMP($J,"N",STN,LINE),U,6)=$P(^TMP($J,"N",STN,LINE),U,6)+1
"RTN","RMPRN6",250,0)
 I CATEGRY=3 S $P(^TMP($J,"N",STN,LINE),U,7)=$P(^TMP($J,"N",STN,LINE),U,7)+1
"RTN","RMPRN6",251,0)
 I SPEC=1 S $P(^TMP($J,"N",STN,LINE),U,8)=$P(^TMP($J,"N",STN,LINE),U,8)+1
"RTN","RMPRN6",252,0)
 I SPEC=2 S $P(^TMP($J,"N",STN,LINE),U,9)=$P(^TMP($J,"N",STN,LINE),U,9)+1
"RTN","RMPRN6",253,0)
 I SPEC=3 S $P(^TMP($J,"N",STN,LINE),U,10)=$P(^TMP($J,"N",STN,LINE),U,10)+1
"RTN","RMPRN6",254,0)
 I SPEC=4 S $P(^TMP($J,"N",STN,LINE),U,11)=$P(^TMP($J,"N",STN,LINE),U,11)+1,$P(^(LINE),U,16)=$P(^(LINE),U,16)+COST
"RTN","RMPRN6",255,0)
 I TYPE="I" S $P(^TMP($J,"N",STN,LINE),U,12)=$P(^TMP($J,"N",STN,LINE),U,12)+1
"RTN","RMPRN6",256,0)
 Q
"RTN","RMPRN6S")
0^26^B4484557
"RTN","RMPRN6S",1,0)
RMPRN6S ;HINES IOFO/HNC ;NPPD SORT LOGIC - 11/10/00
"RTN","RMPRN6S",2,0)
 ;;3.0;PROSTHETICS;**51,90**;Feb 09, 1996
"RTN","RMPRN6S",3,0)
 ;
"RTN","RMPRN6S",4,0)
 ;
"RTN","RMPRN6S",5,0)
DISP ;display info before dir call
"RTN","RMPRN6S",6,0)
 W !
"RTN","RMPRN6S",7,0)
 W !,?6,"Sort Options"
"RTN","RMPRN6S",8,0)
 W !,?6,"------------"
"RTN","RMPRN6S",9,0)
 W !,?6,"2 or 5 = USED INVENTORY ONLY (NEW REPORT)"
"RTN","RMPRN6S",10,0)
 W !!,?6,"1 or 4 = NEW ITEM COSTS, USED INVENTORY (VA) COST AS ZERO,"
"RTN","RMPRN6S",11,0)
 W !,?6,"         (PREVIOUS BRIEF/DETAILED NPPD REPORT)"
"RTN","RMPRN6S",12,0)
 W !!,?6,"3 or 6 = NEW AND USED COST, BOTH DOLLAR AMOUNTS TOTALED (NEW REPORT)"
"RTN","RMPRN6S",13,0)
 Q
"RTN","RMPRN6S",14,0)
SORTUSED ;sort only recovered items cost from PIP
"RTN","RMPRN6S",15,0)
 ;
"RTN","RMPRN6S",16,0)
 S TYPE=$P(^RMPR(660,RD,0),U,4)
"RTN","RMPRN6S",17,0)
 S TY=$S(TYPE="X":2,TYPE=5:2,TYPE="I":1,1:3)
"RTN","RMPRN6S",18,0)
 S SOURCE=$P(^RMPR(660,RD,0),U,14)
"RTN","RMPRN6S",19,0)
 ;only va, or used, recovered items
"RTN","RMPRN6S",20,0)
 Q:SOURCE'="V"
"RTN","RMPRN6S",21,0)
 ;stock issue null (not PIP) and source VA (used)
"RTN","RMPRN6S",22,0)
 I $P(^RMPR(660,RD,1),U,5)="" Q
"RTN","RMPRN6S",23,0)
 S CATEGRY=$P($G(^RMPR(660,RD,"AM")),U,3),SPEC=$P($G(^("AM")),U,4),GN=$P(^("AMS"),U,1)
"RTN","RMPRN6S",24,0)
 S COST=$P(^RMPR(660,RD,0),U,16)
"RTN","RMPRN6S",25,0)
 ;form
"RTN","RMPRN6S",26,0)
 ;S FORM=$P(^RMPR(660,RD,0),U,13)
"RTN","RMPRN6S",27,0)
 ;I (FORM=4)!(FORM=15) S COST=0,SOURCE="V"
"RTN","RMPRN6S",28,0)
 S QTY=$P(^RMPR(660,RD,0),U,7)
"RTN","RMPRN6S",29,0)
 S B1=RD
"RTN","RMPRN6S",30,0)
 S ^TMP($J,CODE,RD)=COST
"RTN","RMPRN6S",31,0)
 I TY=2 D REP^RMPRN6
"RTN","RMPRN6S",32,0)
 I TY'=2 D NEW^RMPRN6
"RTN","RMPRN6S",33,0)
 Q
"RTN","RMPRN6S",34,0)
 ;
"RTN","RMPRN6S",35,0)
 ;
"RTN","RMPRN6S",36,0)
 ;
"RTN","RMPRN6S",37,0)
SORTBOTH ;sort both new and used recovered items cost
"RTN","RMPRN6S",38,0)
 S TYPE=$P(^RMPR(660,RD,0),U,4)
"RTN","RMPRN6S",39,0)
 S TY=$S(TYPE="X":2,TYPE=5:2,TYPE="I":1,1:3)
"RTN","RMPRN6S",40,0)
 S SOURCE=$P(^RMPR(660,RD,0),U,14)
"RTN","RMPRN6S",41,0)
 ;
"RTN","RMPRN6S",42,0)
 S CATEGRY=$P($G(^RMPR(660,RD,"AM")),U,3),SPEC=$P($G(^("AM")),U,4),GN=$P(^("AMS"),U,1)
"RTN","RMPRN6S",43,0)
 S COST=$P(^RMPR(660,RD,0),U,16)
"RTN","RMPRN6S",44,0)
 ;stock issue source VA, used cost calculation is ACTUAL FOR BOTH
"RTN","RMPRN6S",45,0)
 ;I $P(^RMPR(660,RD,1),U,5)'=""&(SOURCE["V") S COST=0
"RTN","RMPRN6S",46,0)
 ;form
"RTN","RMPRN6S",47,0)
 S FORM=$P(^RMPR(660,RD,0),U,13)
"RTN","RMPRN6S",48,0)
 I (FORM=4)!(FORM=15) S COST=0,SOURCE="V"
"RTN","RMPRN6S",49,0)
 S QTY=$P(^RMPR(660,RD,0),U,7)
"RTN","RMPRN6S",50,0)
 S B1=RD
"RTN","RMPRN6S",51,0)
 S ^TMP($J,CODE,RD)=COST
"RTN","RMPRN6S",52,0)
 I TY=2 D REP^RMPRN6
"RTN","RMPRN6S",53,0)
 I TY'=2 D NEW^RMPRN6
"RTN","RMPRN6S",54,0)
 Q
"RTN","RMPRN6S",55,0)
HDR(X) ;display nppd sort header new or used
"RTN","RMPRN6S",56,0)
 I X=2!(X=5) S X="USED INVENTORY ONLY"
"RTN","RMPRN6S",57,0)
 I X=1!(X=4) S X="NEW ITEM COSTS, USED INVENTORY (VA) COST AS ZERO"
"RTN","RMPRN6S",58,0)
 I X=3!(X=6) S X="NEW AND USED COST, BOTH DOLLAR AMOUNTS TOTALED"
"RTN","RMPRN6S",59,0)
 Q X
"RTN","RMPRN6S",60,0)
END ;
"RTN","RMPRN6XM")
0^27^B18513866
"RTN","RMPRN6XM",1,0)
RMPRN6XM ;Hines OIFO/HNC - NPPD Auto-Fix ;9/16/02  11:14
"RTN","RMPRN6XM",2,0)
 ;;3.0;PROSTHETICS;**70,90**;Feb 09, 1996
"RTN","RMPRN6XM",3,0)
 Q
"RTN","RMPRN6XM",4,0)
TASK ;main entry point
"RTN","RMPRN6XM",5,0)
 ;look at file 660, field #2 Type.
"RTN","RMPRN6XM",6,0)
 ;this will need to be updated with 1=new and 2=repair.
"RTN","RMPRN6XM",7,0)
 ;
"RTN","RMPRN6XM",8,0)
 ;"I" = initial issue = new
"RTN","RMPRN6XM",9,0)
 ;"R" = replace = new
"RTN","RMPRN6XM",10,0)
 ;"S" = spare = new
"RTN","RMPRN6XM",11,0)
 ;"X" = repair = repair
"RTN","RMPRN6XM",12,0)
 ; 5  = rental = repair added with patch 90
"RTN","RMPRN6XM",13,0)
 ;
"RTN","RMPRN6XM",14,0)
 K ^TMP($J)
"RTN","RMPRN6XM",15,0)
 S B=0,LINE=""
"RTN","RMPRN6XM",16,0)
 F  S B=$O(^RMPR(660,B)) Q:B'>0  D
"RTN","RMPRN6XM",17,0)
 .S TYPE=$P($G(^RMPR(660,B,0)),U,4)
"RTN","RMPRN6XM",18,0)
 .I TYPE=5 Q  ;No change if Rental just quit.
"RTN","RMPRN6XM",19,0)
 .;if type is null, then Home Oxygen Posted with no type, and that is
"RTN","RMPRN6XM",20,0)
 .;a repair NPPD line. Or, shipping and that is repair.
"RTN","RMPRN6XM",21,0)
 .I TYPE="" S TYPE="X"
"RTN","RMPRN6XM",22,0)
 .S PHCPCS=$P($G(^RMPR(660,B,1)),U,4)
"RTN","RMPRN6XM",23,0)
 .;junk in the global - alpha
"RTN","RMPRN6XM",24,0)
 .Q:PHCPCS'>0
"RTN","RMPRN6XM",25,0)
 .Q:PHCPCS=""
"RTN","RMPRN6XM",26,0)
 .I TYPE'="X" S LINE=$P(^RMPR(661.1,PHCPCS,0),U,7)
"RTN","RMPRN6XM",27,0)
 .I LINE="" D
"RTN","RMPRN6XM",28,0)
 .    .S ERR=""
"RTN","RMPRN6XM",29,0)
 .    .S LINE=$P(^RMPR(661.1,PHCPCS,0),U,6)
"RTN","RMPRN6XM",30,0)
 .    .S TYPE="X"
"RTN","RMPRN6XM",31,0)
 .    .S DIE="^RMPR(660,",DA=B,DR="2///^S X=TYPE"
"RTN","RMPRN6XM",32,0)
 .    .L +^RMPR(660,B):1 I '$T S ERR=1
"RTN","RMPRN6XM",33,0)
 .    .W !,B,"  ",ERR
"RTN","RMPRN6XM",34,0)
 .    .I ERR=1 S ^TMP($J,"RMPRA",B)="NO UPDATE!"
"RTN","RMPRN6XM",35,0)
 .    .I ERR="" D ^DIE L -^RMPR(660,B)
"RTN","RMPRN6XM",36,0)
 .    .K DIE,DA,DR
"RTN","RMPRN6XM",37,0)
 .    .I ERR="" S ^TMP($J,"RMPRA",B)="NEW TO REPAIR"
"RTN","RMPRN6XM",38,0)
 .    .D DATA
"RTN","RMPRN6XM",39,0)
 .I TYPE="X" S LINE=$P(^RMPR(661.1,PHCPCS,0),U,6)
"RTN","RMPRN6XM",40,0)
 .I LINE="" D
"RTN","RMPRN6XM",41,0)
 .    .S ERR=""
"RTN","RMPRN6XM",42,0)
 .    .S LINE=$P(^RMPR(661.1,PHCPCS,0),U,7)
"RTN","RMPRN6XM",43,0)
 .    .S TYPE="I"
"RTN","RMPRN6XM",44,0)
 .    .S DIE="^RMPR(660,",DA=B,DR="2///^S X=TYPE"
"RTN","RMPRN6XM",45,0)
 .    .L +^RMPR(660,B):1 I '$T S ERR=1
"RTN","RMPRN6XM",46,0)
 .    .I ERR=1 S ^TMP($J,"RMPRA",B)="NO UPDATE!"
"RTN","RMPRN6XM",47,0)
 .    .I ERR="" D ^DIE L -^RMPR(660,B)
"RTN","RMPRN6XM",48,0)
 .    .K DIE,DA,DR
"RTN","RMPRN6XM",49,0)
 .    .I ERR="" S ^TMP($J,"RMPRA",B)="REPAIR TO NEW "
"RTN","RMPRN6XM",50,0)
 .    .D DATA
"RTN","RMPRN6XM",51,0)
 K B,LINE,PHCPCS,TYPE
"RTN","RMPRN6XM",52,0)
 D FMT
"RTN","RMPRN6XM",53,0)
 I $D(^TMP($J,"RMPR")) D MAIL
"RTN","RMPRN6XM",54,0)
 G EXIT
"RTN","RMPRN6XM",55,0)
 Q
"RTN","RMPRN6XM",56,0)
DATA ;delimited tmp with data
"RTN","RMPRN6XM",57,0)
 D GETS^DIQ(660,B,".01;.02;4.5;5;7;8.3;14;4;24;27","","RMXM")
"RTN","RMPRN6XM",58,0)
 S $P(^TMP($J,"RMPRA",B),U,2)=$G(RMXM(660,B_",",.01))
"RTN","RMPRN6XM",59,0)
 S $P(^TMP($J,"RMPRA",B),U,3)=$G(RMXM(660,B_",",.02))
"RTN","RMPRN6XM",60,0)
 S $P(^TMP($J,"RMPRA",B),U,4)=$G(RMXM(660,B_",",4.5))
"RTN","RMPRN6XM",61,0)
 S $P(^TMP($J,"RMPRA",B),U,5)=$G(RMXM(660,B_",",5))
"RTN","RMPRN6XM",62,0)
 S $P(^TMP($J,"RMPRA",B),U,6)=$G(RMXM(660,B_",",7))
"RTN","RMPRN6XM",63,0)
 S $P(^TMP($J,"RMPRA",B),U,7)=$G(RMXM(660,B_",",8.3))
"RTN","RMPRN6XM",64,0)
 S $P(^TMP($J,"RMPRA",B),U,8)=$G(RMXM(660,B_",",14))
"RTN","RMPRN6XM",65,0)
 S $P(^TMP($J,"RMPRA",B),U,9)=$G(RMXM(660,B_",",4))
"RTN","RMPRN6XM",66,0)
 S $P(^TMP($J,"RMPRA",B),U,10)=$G(RMXM(660,B_",",27))
"RTN","RMPRN6XM",67,0)
 S $P(^TMP($J,"RMPRA",B),U,11)=LINE
"RTN","RMPRN6XM",68,0)
 S $P(^TMP($J,"RMPRA",B),U,12)=$G(RMXM(660,B_",",24))
"RTN","RMPRN6XM",69,0)
 K RMXM
"RTN","RMPRN6XM",70,0)
 Q
"RTN","RMPRN6XM",71,0)
FMT ;format the records for report display
"RTN","RMPRN6XM",72,0)
 S B=0,^TMP($J,"RMPRFMT")="",CNT=0
"RTN","RMPRN6XM",73,0)
 F  S B=$O(^TMP($J,"RMPRA",B)) Q:B'>0  D
"RTN","RMPRN6XM",74,0)
 .S DATA=^TMP($J,"RMPRA",B)
"RTN","RMPRN6XM",75,0)
 .S (B1,BX,B3,B4,B5,B6,B7,B8)=""
"RTN","RMPRN6XM",76,0)
 .S B2="^TMP($J,""RMPRFMT"")"
"RTN","RMPRN6XM",77,0)
 .S B1=$$SETSTR^VALM1($P(DATA,U,1),@B2,1,14)
"RTN","RMPRN6XM",78,0)
 .S BX=$$SETSTR^VALM1($P(DATA,U,2),@B2,1,14)
"RTN","RMPRN6XM",79,0)
 .S B3=$$SETSTR^VALM1($P(DATA,U,3),@B2,1,11)
"RTN","RMPRN6XM",80,0)
 .S B4=$$SETSTR^VALM1($P(DATA,U,4),@B2,1,6)
"RTN","RMPRN6XM",81,0)
 .S B5=$$SETSTR^VALM1($P(DATA,U,9),@B2,1,10)
"RTN","RMPRN6XM",82,0)
 .S B6=$$SETSTR^VALM1($P(DATA,U,6),@B2,2,11)
"RTN","RMPRN6XM",83,0)
 .S B7=$$SETSTR^VALM1($P(DATA,U,10),@B2,2,12)
"RTN","RMPRN6XM",84,0)
 .S OLDLN=$P(DATA,U,1)
"RTN","RMPRN6XM",85,0)
 .I OLDLN["REPAIR TO NEW" S OLDLN="R99 X"
"RTN","RMPRN6XM",86,0)
 .I OLDLN["NEW TO REPAIR" S OLDLN="999 X"
"RTN","RMPRN6XM",87,0)
 .I OLDLN["NO UPDATE!" S OLDLN="????"
"RTN","RMPRN6XM",88,0)
 .;
"RTN","RMPRN6XM",89,0)
 .S CNT=CNT+1
"RTN","RMPRN6XM",90,0)
 .S ^TMP($J,"RMPR",CNT)=B1
"RTN","RMPRN6XM",91,0)
 .S CNT=CNT+1
"RTN","RMPRN6XM",92,0)
 .S ^TMP($J,"RMPR",CNT)="Create Date   Patient    HCPCS Item       Vendor      PA"
"RTN","RMPRN6XM",93,0)
 .S CNT=CNT+1
"RTN","RMPRN6XM",94,0)
 .S ^TMP($J,"RMPR",CNT)=BX_B3_B4_B8_B5_B6_B7
"RTN","RMPRN6XM",95,0)
 .S CNT=CNT+1
"RTN","RMPRN6XM",96,0)
 .S ^TMP($J,"RMPR",CNT)=""
"RTN","RMPRN6XM",97,0)
 .S CNT=CNT+1
"RTN","RMPRN6XM",98,0)
 .S ^TMP($J,"RMPR",CNT)="Brief Description: "_$P(DATA,U,12)
"RTN","RMPRN6XM",99,0)
 .S CNT=CNT+1
"RTN","RMPRN6XM",100,0)
 .S ^TMP($J,"RMPR",CNT)=""
"RTN","RMPRN6XM",101,0)
 .S CNT=CNT+1
"RTN","RMPRN6XM",102,0)
 .I OLDLN'="????" S ^TMP($J,"RMPR",CNT)="Changed From Line "_OLDLN_" To NPPD Line: "_$P(DATA,U,11)_"  Local Record #:"_B
"RTN","RMPRN6XM",103,0)
 .I OLDLN="????" S ^TMP($J,"RMPR",CNT)="Nothing Changed, Someone Was Editing Record.  Local Record #:"_B
"RTN","RMPRN6XM",104,0)
 .S CNT=CNT+1
"RTN","RMPRN6XM",105,0)
 .S ^TMP($J,"RMPR",CNT)="-------------------------------------------------------------------------------"
"RTN","RMPRN6XM",106,0)
 Q
"RTN","RMPRN6XM",107,0)
 ;
"RTN","RMPRN6XM",108,0)
MAIL ;send report via message to mail group RMPR INVENTORY
"RTN","RMPRN6XM",109,0)
 ;
"RTN","RMPRN6XM",110,0)
 S XMY("G.RMPR INVENTORY")=""
"RTN","RMPRN6XM",111,0)
 S XMDUZ=.5
"RTN","RMPRN6XM",112,0)
 S XMTEXT="^TMP($J,""RMPR"","
"RTN","RMPRN6XM",113,0)
 S XMSUB="Prosthetics Auto-Fix"
"RTN","RMPRN6XM",114,0)
 D ^XMD
"RTN","RMPRN6XM",115,0)
 Q
"RTN","RMPRN6XM",116,0)
 ;
"RTN","RMPRN6XM",117,0)
EXIT ;common exit point
"RTN","RMPRN6XM",118,0)
 K ^TMP($J,"RMPRA"),^TMP($J,"RMPR")
"RTN","RMPRN6XM",119,0)
 Q
"RTN","RMPRN6XM",120,0)
 ;END
"RTN","RMPRN7")
0^28^B74857178
"RTN","RMPRN7",1,0)
RMPRN7 ;Hines OIFO/HNC-PRINT NPPD LOCAL DATA ;9/16/02  11:35
"RTN","RMPRN7",2,0)
 ;;3.0;PROSTHETICS;**57,70,90**;Feb 09, 1996
"RTN","RMPRN7",3,0)
 D DIV4^RMPRSIT G:$D(X) EXIT
"RTN","RMPRN7",4,0)
DATE S %DT="XEA",%DT("A")="Enter Date to Start NPPD Calculations From: " D ^%DT G:X[U!(X="")!($D(DTOUT)) EXIT
"RTN","RMPRN7",5,0)
 S DATE(1)=+Y
"RTN","RMPRN7",6,0)
 S %DT="XEA",%DT("A")="Enter End Date: " D ^%DT G:X[U!(X="")!($D(DTOUT)) EXIT S DATE(2)=+Y
"RTN","RMPRN7",7,0)
 I DATE(1)>DATE(2) W !!,$C(7),"ENDING DATE RANGE IS LESS THAN BEGINNING DATE RANGE",! G DATE
"RTN","RMPRN7",8,0)
 Q:$D(RMPRCDE)
"RTN","RMPRN7",9,0)
DET ;select detail or brief
"RTN","RMPRN7",10,0)
 D DISP^RMPRN7S
"RTN","RMPRN7",11,0)
 K DIR
"RTN","RMPRN7",12,0)
 S DIR(0)="S^D:DETAIL;B:BRIEF"
"RTN","RMPRN7",13,0)
 S DIR("A")="Type of Report",DIR("B")="DETAIL" D ^DIR
"RTN","RMPRN7",14,0)
 Q:$D(DIRUT)!($D(DTOUT))
"RTN","RMPRN7",15,0)
 S RMPRDET=Y
"RTN","RMPRN7",16,0)
DEV ;device
"RTN","RMPRN7",17,0)
 S %ZIS="Q" D ^%ZIS G:POP EXIT K IOP I $E(IOST,1,2)["C-" G PRT
"RTN","RMPRN7",18,0)
 I $D(IO("Q")) S ZTIO=ION,ZTSAVE("RMPRSITE")="",ZTSAVE("RMPR(")=""
"RTN","RMPRN7",19,0)
 I  S ZTSAVE("DATE(")="",ZTSAVE("RMPRZ")="",ZTSAVE("RMPRDET")=""
"RTN","RMPRN7",20,0)
 I  S ZTRTN="PRT^RMPRN7",ZTDESC="Prosthetic 2529-3 NPPD" D ^%ZTLOAD K ZTDESC,ZTIO,ZTRTN,ZTSAVE G EXIT
"RTN","RMPRN7",21,0)
PRT ;print
"RTN","RMPRN7",22,0)
 I '$D(IO("Q")) U IO
"RTN","RMPRN7",23,0)
 D GNP,GNPC
"RTN","RMPRN7",24,0)
 Q
"RTN","RMPRN7",25,0)
ENL ;entry point for one line
"RTN","RMPRN7",26,0)
 D DIV4^RMPRSIT G:$D(X) EXIT
"RTN","RMPRN7",27,0)
 S RMPRCDE=1
"RTN","RMPRN7",28,0)
 D DATE
"RTN","RMPRN7",29,0)
 G:'$D(DATE(1))!('$D(DATE(2))) EXIT
"RTN","RMPRN7",30,0)
 ;single line always new and used (BOTH) sort
"RTN","RMPRN7",31,0)
 S RMPRDET="D"
"RTN","RMPRN7",32,0)
 D GNPCC,EXIT
"RTN","RMPRN7",33,0)
 Q
"RTN","RMPRN7",34,0)
GNP ;gather nppd data
"RTN","RMPRN7",35,0)
 S $P(LN,"-",IOM)=""
"RTN","RMPRN7",36,0)
 S DATE=DATE(1)-1
"RTN","RMPRN7",37,0)
 K ^TMP($J)
"RTN","RMPRN7",38,0)
 F  S DATE=$O(^RMPR(660,"B",DATE)) Q:(DATE="")!($P(DATE,".",1)>DATE(2))  D
"RTN","RMPRN7",39,0)
 .S RMPRB=0
"RTN","RMPRN7",40,0)
 .F  S RMPRB=$O(^RMPR(660,"B",DATE,RMPRB)) Q:RMPRB'>0  D
"RTN","RMPRN7",41,0)
 ..;define variables for record
"RTN","RMPRN7",42,0)
 ..S REC=$G(^RMPR(660,RMPRB,0)) Q:REC=""
"RTN","RMPRN7",43,0)
 ..Q:$P(REC,U,15)["*"
"RTN","RMPRN7",44,0)
 ..Q:$P(REC,U,10)'=RMPR("STA")
"RTN","RMPRN7",45,0)
 ..;check for used pip
"RTN","RMPRN7",46,0)
 ..;if not LAB, quit
"RTN","RMPRN7",47,0)
 ..I $P(REC,U,13)'=15&($P(REC,U,13)'=4) Q
"RTN","RMPRN7",48,0)
 ..S TYPE=$P(REC,U,4)
"RTN","RMPRN7",49,0)
 ..S TY=$S(TYPE="X":2,TYPE=5:2,TYPE="I":1,1:3)
"RTN","RMPRN7",50,0)
 ..S MR=$P($G(^RMPR(660,RMPRB,1)),U,4)
"RTN","RMPRN7",51,0)
 ..I $P(^RMPR(660,RMPRB,0),U,17)'=""&($P(^(0),U,26)="") S TY=2,LINE="R90 A",MR=2676
"RTN","RMPRN7",52,0)
 ..;PICKUP AND DELIVERY
"RTN","RMPRN7",53,0)
 ..I $P(^RMPR(660,RMPRB,0),U,26)'="" S TY=2,LINE="R80 D",MR=2951
"RTN","RMPRN7",54,0)
 ..Q:MR=""
"RTN","RMPRN7",55,0)
 ..;    PATCH 70         Auto-fix
"RTN","RMPRN7",56,0)
 ..K LINE
"RTN","RMPRN7",57,0)
 ..I TY'=2 S LINE=$P(^RMPR(661.1,MR,0),U,7)
"RTN","RMPRN7",58,0)
 ..I TY'=2&($G(LINE)="") D
"RTN","RMPRN7",59,0)
 ...I TYPE=5 Q
"RTN","RMPRN7",60,0)
 ...S ERR=""
"RTN","RMPRN7",61,0)
 ...S LINE=$P(^RMPR(661.1,MR,0),U,6)
"RTN","RMPRN7",62,0)
 ...S TYPE="X"
"RTN","RMPRN7",63,0)
 ...S DIE="^RMPR(660,",DA=RMPRB,DR="2///^S X=TYPE"
"RTN","RMPRN7",64,0)
 ...L +^RMPR(660,RMPRB):1 I '$T S ERR=1
"RTN","RMPRN7",65,0)
 ...I ERR="" D ^DIE L -^RMPR(660,RMPRB)
"RTN","RMPRN7",66,0)
 ...K DIE,DA,DR
"RTN","RMPRN7",67,0)
 ...I ERR=1 S ^TMP($J,RMPRB)="NO UPDATE!"
"RTN","RMPRN7",68,0)
 ...S ^TMP($J,RMPRB)="NEW TO REPAIR"
"RTN","RMPRN7",69,0)
 ...S B=RMPRB D DATA^RMPRN6XM
"RTN","RMPRN7",70,0)
 ..I TY=2 S LINE=$P(^RMPR(661.1,MR,0),U,6)
"RTN","RMPRN7",71,0)
 ..I TY=2&($G(LINE)="") D
"RTN","RMPRN7",72,0)
 ...I TYPE=5 Q
"RTN","RMPRN7",73,0)
 ...S ERR=""
"RTN","RMPRN7",74,0)
 ...S LINE=$P(^RMPR(661.1,MR,0),U,7)
"RTN","RMPRN7",75,0)
 ...S TYPE="I"
"RTN","RMPRN7",76,0)
 ...S DIE="^RMPR(660,",DA=RMPRB,DR="2///^S X=TYPE"
"RTN","RMPRN7",77,0)
 ...L +^RMPR(660,RMPRB):1 I '$T S ERR=1
"RTN","RMPRN7",78,0)
 ...I ERR="" D ^DIE L -^RMPR(660,RMPRB)
"RTN","RMPRN7",79,0)
 ...K DIE,DA,DR
"RTN","RMPRN7",80,0)
 ...I ERR=1 S ^TMP($J,RMPRB)="NO UPDATE!"
"RTN","RMPRN7",81,0)
 ...S ^TMP($J,"RMPRA",RMPRB)="REPAIR TO NEW"
"RTN","RMPRN7",82,0)
 ...S B=RMPRB D DATA^RMPRN6XM
"RTN","RMPRN7",83,0)
 ..;
"RTN","RMPRN7",84,0)
 ..;set to 999 group if null
"RTN","RMPRN7",85,0)
 ..S FLAG=$P(^RMPR(661.1,MR,0),U,8)
"RTN","RMPRN7",86,0)
 ..I FLAG="" S FLAG=2
"RTN","RMPRN7",87,0)
 ..S CATEGRY=$P($G(^RMPR(660,RMPRB,"AM")),U,3),SPEC=$P($G(^("AM")),U,4),GN=$P($G(^("AMS")),U,1)
"RTN","RMPRN7",88,0)
 ..Q:GN=""
"RTN","RMPRN7",89,0)
 ..D SET
"RTN","RMPRN7",90,0)
 D FMT^RMPRN6XM,MAIL^RMPRN6XM
"RTN","RMPRN7",91,0)
 Q
"RTN","RMPRN7",92,0)
GNPC ;worksheet/detail
"RTN","RMPRN7",93,0)
 S STN=RMPR("NAME")
"RTN","RMPRN7",94,0)
 D CAL^RMPRN7
"RTN","RMPRN7",95,0)
 S PAGE=0,FL=""
"RTN","RMPRN7",96,0)
 D ^RMPRN7PT
"RTN","RMPRN7",97,0)
 G:FL=1 EXIT
"RTN","RMPRN7",98,0)
 D ^RMPRN7PR
"RTN","RMPRN7",99,0)
 G:FL=1 EXIT
"RTN","RMPRN7",100,0)
 I RMPRDET'="D" G EXIT
"RTN","RMPRN7",101,0)
 D DESP^RMPRN73
"RTN","RMPRN7",102,0)
 D DESPR^RMPRN73
"RTN","RMPRN7",103,0)
EXIT ;commom exit point
"RTN","RMPRN7",104,0)
 K ^TMP($J) D KILL^XUSCLEAN
"RTN","RMPRN7",105,0)
 D ^%ZISC
"RTN","RMPRN7",106,0)
 Q
"RTN","RMPRN7",107,0)
GNPCC ;one line only
"RTN","RMPRN7",108,0)
 S STN=RMPR("NAME")
"RTN","RMPRN7",109,0)
 D CODE^RMPRN73
"RTN","RMPRN7",110,0)
 D ^RMPRN7UT
"RTN","RMPRN7",111,0)
 G:$D(DIRUT)!($D(DTOUT)) EXIT
"RTN","RMPRN7",112,0)
 I $G(RMPRCDE)="" S RMPRCDE="",RMPRCDE=$O(BRA(Y,RMPRCDE))
"RTN","RMPRN7",113,0)
 S Y=DATE(1) D DD^%DT S DATE(3)=Y,Y=DATE(2) D DD^%DT S DATE(4)=Y
"RTN","RMPRN7",114,0)
 S %ZIS="Q" D ^%ZIS G:POP EXIT K IOP I $E(IOST,1,2)["C-" G PRTL
"RTN","RMPRN7",115,0)
 I $D(IO("Q")) S ZTIO=ION,ZTSAVE("RMPRSITE")="",ZTSAVE("RMPR(")=""
"RTN","RMPRN7",116,0)
 I  S ZTSAVE("DATE(")="",ZTSAVE("RMPRZ")="",ZTSAVE("RMPRDET")="",ZTSAVE("RMPRCDE")=""
"RTN","RMPRN7",117,0)
 I  S ZTRTN="PRTL^RMPRN7",ZTDESC="Prosthetic 2529-3 NPPD" D ^%ZTLOAD K ZTDESC,ZTIO,ZTRTN,ZTSAVE G EXIT
"RTN","RMPRN7",118,0)
PRTL ;print one line entry from taskman
"RTN","RMPRN7",119,0)
 I '$D(IO("Q")) U IO
"RTN","RMPRN7",120,0)
 D GNP
"RTN","RMPRN7",121,0)
 D CAL^RMPRN7
"RTN","RMPRN7",122,0)
 S PAGE=0,FL=""
"RTN","RMPRN7",123,0)
 S CODE=RMPRCDE
"RTN","RMPRN7",124,0)
 D DESP^RMPRN7PL
"RTN","RMPRN7",125,0)
 Q
"RTN","RMPRN7",126,0)
SET ;set temp global
"RTN","RMPRN7",127,0)
 S STN=RMPR("NAME")
"RTN","RMPRN7",128,0)
 S ^TMP($J,"RMPRGN",STN,GN,FLAG,LINE_"L",RMPRB)=""
"RTN","RMPRN7",129,0)
 S RMSSN=$P(^RMPR(660,RMPRB,0),U,2) I RMSSN S RMSSN=$P(^DPT(RMSSN,0),U,9)
"RTN","RMPRN7",130,0)
 I RMSSN'="" S ^TMP($J,"A",RMSSN)=""
"RTN","RMPRN7",131,0)
 K RMSSN
"RTN","RMPRN7",132,0)
 Q
"RTN","RMPRN7",133,0)
 ;
"RTN","RMPRN7",134,0)
LOOP ;sort on hcpcs key and grouper is complete
"RTN","RMPRN7",135,0)
 ;store in tmp($j,"N",station) or "R"
"RTN","RMPRN7",136,0)
 S (TAM,T1,RMPRB,COUNT,CODE,RMPRAD,DATE,RMPRFG,RMPRT,RMPRI,RMPRNW,RMPRRPR)=0
"RTN","RMPRN7",137,0)
 S (TQTY,RMPROTH,CC,RMPRC,RMPRN,TT,RMPRPSC,VA,CM,RMPRCT1,SO,SI,DIS,RMPRCT,RMPR21,CODE,RMPRB,FM,LEG,RMPRNI,RMPRNO,RMPRSL,RMPRAA,RMPRPHC)=0
"RTN","RMPRN7",138,0)
 S DATE=DATE(1),RMPRB=0
"RTN","RMPRN7",139,0)
CAL ;loop through grouper key sort
"RTN","RMPRN7",140,0)
 S STN=RMPR("NAME")
"RTN","RMPRN7",141,0)
 D CODE^RMPRN73
"RTN","RMPRN7",142,0)
 S GN=""
"RTN","RMPRN7",143,0)
 F  S GN=$O(^TMP($J,"RMPRGN",STN,GN)) Q:GN=""  D
"RTN","RMPRN7",144,0)
 .S FLG=0
"RTN","RMPRN7",145,0)
 .F  S FLG=$O(^TMP($J,"RMPRGN",STN,GN,FLG)) Q:FLG'>0  D  I FLG=1&(RMPRDET'=2)!(RMPRDET'=5) Q
"RTN","RMPRN7",146,0)
 ..;used items never get grouped
"RTN","RMPRN7",147,0)
 ..I FLG=1&(RMPRDET'=2)&(RMPRDET'=5) D GROUP Q
"RTN","RMPRN7",148,0)
 ..;I FLG=1 D GROUP Q
"RTN","RMPRN7",149,0)
 ..S CODE=0
"RTN","RMPRN7",150,0)
 ..F  S CODE=$O(^TMP($J,"RMPRGN",STN,GN,FLG,CODE)) Q:CODE=""  D
"RTN","RMPRN7",151,0)
 ...S RD=0
"RTN","RMPRN7",152,0)
 ...F  S RD=$O(^TMP($J,"RMPRGN",STN,GN,FLG,CODE,RD)) Q:RD'>0  D
"RTN","RMPRN7",153,0)
 ....D SORT Q
"RTN","RMPRN7",154,0)
 Q
"RTN","RMPRN7",155,0)
GROUP ;total grouper to main key
"RTN","RMPRN7",156,0)
 M BC=^TMP($J,"RMPRGN",STN,GN)
"RTN","RMPRN7",157,0)
 S BF=0,BTCOST=0,SRD=""
"RTN","RMPRN7",158,0)
 ;bc array is entrie PO 2421
"RTN","RMPRN7",159,0)
 F  S BF=$O(BC(BF)) Q:BF'>0  D
"RTN","RMPRN7",160,0)
 .;b1 is line,or code
"RTN","RMPRN7",161,0)
 .S BL=0
"RTN","RMPRN7",162,0)
 .F  S BL=$O(BC(BF,BL)) Q:BL=""  D
"RTN","RMPRN7",163,0)
 ..S BR=0
"RTN","RMPRN7",164,0)
 ..;BR is record number
"RTN","RMPRN7",165,0)
 ..F  S BR=$O(BC(BF,BL,BR)) Q:BR'>0  D
"RTN","RMPRN7",166,0)
 ...S BCOST=$P(^RMPR(660,BR,"LB"),U,9)
"RTN","RMPRN7",167,0)
 ...S BTCOST=BTCOST+BCOST
"RTN","RMPRN7",168,0)
 ...I (BF=1)&(SRD="") S SRD=BR,CODE="",CODE=$O(BC(1,CODE))
"RTN","RMPRN7",169,0)
 K BC
"RTN","RMPRN7",170,0)
 Q:SRD=""
"RTN","RMPRN7",171,0)
 ;calculate based on primary
"RTN","RMPRN7",172,0)
 S TYPE=$P(^RMPR(660,SRD,0),U,4)
"RTN","RMPRN7",173,0)
 S TY=$S(TYPE="X":2,TYPE=5:2,TYPE="I":1,1:3)
"RTN","RMPRN7",174,0)
 S SOURCE=$P(^RMPR(660,SRD,0),U,14)
"RTN","RMPRN7",175,0)
 S COST=BTCOST
"RTN","RMPRN7",176,0)
 ;stock issue display and calculate zero used cost if VA source
"RTN","RMPRN7",177,0)
 ;I $P(^RMPR(660,SRD,1),U,5)'=""&(SOURCE["V") S BTCOST=0,COST=0
"RTN","RMPRN7",178,0)
 ;I $P(^RMPR(660,SRD,0),U,13)["-3" S COST=0,SOURCE="VA",BTCOST=0
"RTN","RMPRN7",179,0)
 S QTY=$P(^RMPR(660,SRD,0),U,7)
"RTN","RMPRN7",180,0)
 S ^TMP($J,CODE,SRD)=COST
"RTN","RMPRN7",181,0)
 S CATEGRY=$P($G(^RMPR(660,SRD,"AM")),U,3),SPEC=$P($G(^("AM")),U,4),GN=$P(^("AMS"),U,1)
"RTN","RMPRN7",182,0)
 ;new or repair code
"RTN","RMPRN7",183,0)
 S B1=SRD
"RTN","RMPRN7",184,0)
 I TY=2 D REP
"RTN","RMPRN7",185,0)
 I TY'=2 D NEW
"RTN","RMPRN7",186,0)
 Q
"RTN","RMPRN7",187,0)
SORT ;main data for worksheets
"RTN","RMPRN7",188,0)
 S TYPE=$P(^RMPR(660,RD,0),U,4)
"RTN","RMPRN7",189,0)
 S TY=$S(TYPE="X":2,TYPE=5:2,TYPE="I":1,1:3)
"RTN","RMPRN7",190,0)
 S SOURCE=$P(^RMPR(660,RD,0),U,14)
"RTN","RMPRN7",191,0)
 I SOURCE="" S SOURCE="C"
"RTN","RMPRN7",192,0)
 S CATEGRY=$P($G(^RMPR(660,RD,"AM")),U,3),SPEC=$P($G(^("AM")),U,4),GN=$P(^("AMS"),U,1)
"RTN","RMPRN7",193,0)
 S COST=$P(^RMPR(660,RD,"LB"),U,9)
"RTN","RMPRN7",194,0)
 ;stock issue source VA, used cost calculation is zero
"RTN","RMPRN7",195,0)
 ;I $P(^RMPR(660,RD,1),U,5)'=""&(SOURCE["V") S COST=0
"RTN","RMPRN7",196,0)
 ;form
"RTN","RMPRN7",197,0)
 S FORM=$P(^RMPR(660,RD,0),U,13)
"RTN","RMPRN7",198,0)
 ;I (FORM=4)!(FORM=15) S COST=0,SOURCE="V"
"RTN","RMPRN7",199,0)
 S QTY=$P(^RMPR(660,RD,0),U,7)
"RTN","RMPRN7",200,0)
 S B1=RD
"RTN","RMPRN7",201,0)
 S ^TMP($J,CODE,RD)=COST
"RTN","RMPRN7",202,0)
 I TY=2 D REP
"RTN","RMPRN7",203,0)
 I TY'=2 D NEW
"RTN","RMPRN7",204,0)
 Q
"RTN","RMPRN7",205,0)
REP ;calculate repair cost
"RTN","RMPRN7",206,0)
 ;I $G(RD)'="" D
"RTN","RMPRN7",207,0)
 ;.S SSN=$P(^RMPR(660,RD,0),U,2) I SSN S SSN=$P(^DPT(SSN,0),U,9)
"RTN","RMPRN7",208,0)
 ;.I SSN'="" S ^TMP($J,"A",SSN)=""
"RTN","RMPRN7",209,0)
 ;.K SSN
"RTN","RMPRN7",210,0)
 S LINE=CODE
"RTN","RMPRN7",211,0)
 I LINE="R90 A" S SOURCE="C",QTY=1
"RTN","RMPRN7",212,0)
 I $G(^TMP($J,"R",STN,LINE))="" S ^TMP($J,"R",STN,LINE)=""
"RTN","RMPRN7",213,0)
 I SOURCE["V" S $P(^TMP($J,"R",STN,LINE),U,1)=$P(^TMP($J,"R",STN,LINE),U,1)+QTY
"RTN","RMPRN7",214,0)
 I SOURCE["C" S $P(^TMP($J,"R",STN,LINE),U,2)=$P(^TMP($J,"R",STN,LINE),U,2)+QTY
"RTN","RMPRN7",215,0)
 ;
"RTN","RMPRN7",216,0)
 S $P(^TMP($J,"R",STN,LINE),U,3)=$P(^TMP($J,"R",STN,LINE),U,3)+COST
"RTN","RMPRN7",217,0)
 I CATEGRY=1 S $P(^TMP($J,"R",STN,LINE),U,4)=$P(^TMP($J,"R",STN,LINE),U,4)+1
"RTN","RMPRN7",218,0)
 I CATEGRY=4 S $P(^TMP($J,"R",STN,LINE),U,5)=$P(^TMP($J,"R",STN,LINE),U,5)+1
"RTN","RMPRN7",219,0)
 I CATEGRY=2 S $P(^TMP($J,"R",STN,LINE),U,6)=$P(^TMP($J,"R",STN,LINE),U,6)+1
"RTN","RMPRN7",220,0)
 I CATEGRY=3 S $P(^TMP($J,"R",STN,LINE),U,7)=$P(^TMP($J,"R",STN,LINE),U,7)+1
"RTN","RMPRN7",221,0)
 I SPEC=1 S $P(^TMP($J,"R",STN,LINE),U,8)=$P(^TMP($J,"R",STN,LINE),U,8)+1
"RTN","RMPRN7",222,0)
 I SPEC=2 S $P(^TMP($J,"R",STN,LINE),U,9)=$P(^TMP($J,"R",STN,LINE),U,9)+1
"RTN","RMPRN7",223,0)
 I SPEC=3 S $P(^TMP($J,"R",STN,LINE),U,10)=$P(^TMP($J,"R",STN,LINE),U,10)+1
"RTN","RMPRN7",224,0)
 I SPEC=4 S $P(^TMP($J,"R",STN,LINE),U,11)=$P(^TMP($J,"R",STN,LINE),U,11)+1,$P(^(LINE),U,16)=$P(^(LINE),U,16)+COST
"RTN","RMPRN7",225,0)
 I TYPE="I" S $P(^TMP($J,"R",STN,LINE),U,12)=$P(^TMP($J,"R",STN,LINE),U,12)+1
"RTN","RMPRN7",226,0)
 Q
"RTN","RMPRN7",227,0)
 ;
"RTN","RMPRN7",228,0)
NEW ;calculate new costs
"RTN","RMPRN7",229,0)
 ;I $G(RD)'="" D
"RTN","RMPRN7",230,0)
 ;.S SSN=$P(^RMPR(660,RD,0),U,2) I SSN S SSN=$P(^DPT(SSN,0),U,9)
"RTN","RMPRN7",231,0)
 ;.I SSN'="" S ^TMP($J,"A",SSN)=""
"RTN","RMPRN7",232,0)
 ;.K SSN
"RTN","RMPRN7",233,0)
 S LINE=CODE
"RTN","RMPRN7",234,0)
 I $G(^TMP($J,"N",STN,LINE))="" S ^TMP($J,"N",STN,LINE)=""
"RTN","RMPRN7",235,0)
 I SOURCE["V" S $P(^TMP($J,"N",STN,LINE),U,1)=$P(^TMP($J,"N",STN,LINE),U,1)+QTY
"RTN","RMPRN7",236,0)
 I SOURCE["C" S $P(^TMP($J,"N",STN,LINE),U,2)=$P(^TMP($J,"N",STN,LINE),U,2)+QTY
"RTN","RMPRN7",237,0)
 S $P(^TMP($J,"N",STN,LINE),U,3)=$P(^TMP($J,"N",STN,LINE),U,3)+COST
"RTN","RMPRN7",238,0)
 I CATEGRY=1 S $P(^TMP($J,"N",STN,LINE),U,4)=$P(^TMP($J,"N",STN,LINE),U,4)+1
"RTN","RMPRN7",239,0)
 I CATEGRY=4 S $P(^TMP($J,"N",STN,LINE),U,5)=$P(^TMP($J,"N",STN,LINE),U,5)+1
"RTN","RMPRN7",240,0)
 I CATEGRY=2 S $P(^TMP($J,"N",STN,LINE),U,6)=$P(^TMP($J,"N",STN,LINE),U,6)+1
"RTN","RMPRN7",241,0)
 I CATEGRY=3 S $P(^TMP($J,"N",STN,LINE),U,7)=$P(^TMP($J,"N",STN,LINE),U,7)+1
"RTN","RMPRN7",242,0)
 I SPEC=1 S $P(^TMP($J,"N",STN,LINE),U,8)=$P(^TMP($J,"N",STN,LINE),U,8)+1
"RTN","RMPRN7",243,0)
 I SPEC=2 S $P(^TMP($J,"N",STN,LINE),U,9)=$P(^TMP($J,"N",STN,LINE),U,9)+1
"RTN","RMPRN7",244,0)
 I SPEC=3 S $P(^TMP($J,"N",STN,LINE),U,10)=$P(^TMP($J,"N",STN,LINE),U,10)+1
"RTN","RMPRN7",245,0)
 I SPEC=4 S $P(^TMP($J,"N",STN,LINE),U,11)=$P(^TMP($J,"N",STN,LINE),U,11)+1,$P(^(LINE),U,16)=$P(^(LINE),U,16)+COST
"RTN","RMPRN7",246,0)
 I TYPE="I" S $P(^TMP($J,"N",STN,LINE),U,12)=$P(^TMP($J,"N",STN,LINE),U,12)+1
"RTN","RMPRN7",247,0)
 Q
"RTN","RMPRP21")
0^14^B31670001
"RTN","RMPRP21",1,0)
RMPRP21 ;PHX/RFM-PRINT 10-2421 ;8/29/1994
"RTN","RMPRP21",2,0)
 ;;3.0;PROSTHETICS;**3,19,55,90**;Feb 09, 1996
"RTN","RMPRP21",3,0)
 ;
"RTN","RMPRP21",4,0)
 ; ODJ - patch 55 - 1/29/01 - extrinsic to get mail routing code
"RTN","RMPRP21",5,0)
 ;                            from site param. replaces hard code 121
"RTN","RMPRP21",6,0)
 ;                            nois AUG-1097-32118
"RTN","RMPRP21",7,0)
 ;
"RTN","RMPRP21",8,0)
 I '$D(RMPR) D DIV4^RMPRSIT Q:$D(X)
"RTN","RMPRP21",9,0)
 I +$P(^RMPR(669.9,RMPRSITE,0),U,5) I $D(RMPRA)&($D(^%ZIS(1,$P(^RMPR(669.9,RMPRSITE,0),U,5),0))) S IOP="Q;"_$P(^(0),U,1) S %ZIS="MQ" D ^%ZIS G:POP EX S ZTIO=ION G PT
"RTN","RMPRP21",10,0)
 I $D(RMPRA)&('$P(^RMPR(669.9,RMPRSITE,0),U,5)) G ZIS
"RTN","RMPRP21",11,0)
EN ;ENTRY POINT FOR REPRINTING A 10-2421 FORM
"RTN","RMPRP21",12,0)
 I '$D(RMPR) D DIV4^RMPRSIT G:$D(X) EX
"RTN","RMPRP21",13,0)
 S RMPRACT=1,DIC="^RMPR(664,",DIC(0)="AEQM",DIC("A")="Select Transaction or Patient Name: ",RMPRF=2
"RTN","RMPRP21",14,0)
 S DIC("S")="I $D(^RMPR(664,Y,1)) S RZZZ=$O(^RMPR(664,Y,1,0)) I RZZZ S RX=$P(^(RZZZ,0),U,13) S:$D(^RMPR(660,+RX,0)) RX=$P(^(0),U,13) I RX=2,'$D(^RMPR(664,""AP"",RMPR(""STA""),Y))"
"RTN","RMPRP21",15,0)
 S DIC("W")="D EN2^RMPRD1" D ^DIC G:Y<0 EX S RMPRA=+Y I $P(^RMPR(664,+Y,0),U,5) D M2^RMPRM
"RTN","RMPRP21",16,0)
 D PR^RMPR21A I %'>0 G EX
"RTN","RMPRP21",17,0)
 I +$P(^RMPR(669.9,RMPRSITE,0),U,5) I $D(RMPRA)&($D(^%ZIS(1,$P(^RMPR(669.9,RMPRSITE,0),U,5),0))) S IOP="Q;"_$P(^(0),U,1),%ZIS="Q" D ^%ZIS G:POP EX S ZTIO=ION G PT
"RTN","RMPRP21",18,0)
ZIS S %ZIS="QM" D ^%ZIS G:POP EX
"RTN","RMPRP21",19,0)
 I '$D(IO("Q")) U IO G PRT
"RTN","RMPRP21",20,0)
 S ZTIO=ION
"RTN","RMPRP21",21,0)
PT S ZTDTH=$H,ZTSAVE("RMPRPN")="",ZTSAVE("RMPRA")="",ZTSAVE("RMPRSITE")="",ZTSAVE("RMPR(")="",ZTRTN="PRT^RMPRP21",ZTDESC="2421 FORM"
"RTN","RMPRP21",22,0)
  S:$D(RMPRPRIV) ZTSAVE("RMPRPRIV")="" D ^%ZTLOAD W !,$S($D(ZTSK):"<REQUEST QUEUED>",1:"<REQUEST NOT QUEUED>") D HOME^%ZIS H 3 G EX
"RTN","RMPRP21",23,0)
PRT ;ENTRY POINT TO PRINT 2421S
"RTN","RMPRP21",24,0)
 S %X="^RMPR(664,RMPRA,",%Y="R664(" D %XY^%RCR K %X,%Y
"RTN","RMPRP21",25,0)
 S RDUZ=$P(R664(0),U,9),RDUZ=$P(^VA(200,RDUZ,0),U,1),DFN=$P(R664(0),U,2),RTN=$P(R664(0),U,7),CP=$P(R664(0),U,6),CP=$P(^PRCS(410,CP,0),U,1),RMPRPAGE=2
"RTN","RMPRP21",26,0)
 D ADD^VADPT,DEM^VADPT,ELIG^VADPT
"RTN","RMPRP21",27,0)
 W:$Y>0 @IOF W ?20,"OMB Number 2900-0188",?50,"PO#: "
"RTN","RMPRP21",28,0)
 W !!?7,"***ORIGINAL COPY AND COMMERCIAL INVOICE MUST BE SUBMITTED***",!?15,"TO THE VAMC PROSTHETIC ACTIVITY LISTED BELOW"
"RTN","RMPRP21",29,0)
HDR ;PRINT HEADER FOR 2421 ADDRESS INFO
"RTN","RMPRP21",30,0)
 I $P($G(R664(4)),U,8) W !,?30,"***WORKING COPY***"
"RTN","RMPRP21",31,0)
 S (RMPRT,RMPRB)="",$P(RMPRT,"_",IOM)="",$P(RMPRB,"-",IOM)="" W !,RMPRT,!,"Department of Veterans Affairs"_"|"_"Prosthetic Authorization for Items or Services",!,RMPRB
"RTN","RMPRP21",32,0)
 W !,"1. Name and Address of Vendor",?40,"2. Name and Address of VA Facility"
"RTN","RMPRP21",33,0)
 S RMPRV=$P(R664(0),U,4),RMPRST=""
"RTN","RMPRP21",34,0)
 I $D(^PRC(440,RMPRV,0)) S RMPRV=^PRC(440,RMPRV,0) D
"RTN","RMPRP21",35,0)
 .S RMPRST=$P(RMPRV,U,7),RMPRPHON=$P(RMPRV,U,10)
"RTN","RMPRP21",36,0)
 .S RMPRAD1=$P(RMPRV,U,2),RMPRAD2=$P(RMPRV,U,3)
"RTN","RMPRP21",37,0)
 .S RMPRCITY=$P(RMPRV,U,6),RMPR90IP=$P(RMPRV,U,8)
"RTN","RMPRP21",38,0)
 .S RMPRVACN=$P($G(^PRC(440,$P(R664(0),U,4),2)),U,1)
"RTN","RMPRP21",39,0)
 I $D(^DIC(5,+RMPRST,0)) S RMPRST=$P(^(0),U,2)
"RTN","RMPRP21",40,0)
 E  S RMPRST="NO STATE ON FILE"
"RTN","RMPRP21",41,0)
 W !,?5,$E($P(RMPRV,U,1),1,30),?40
"RTN","RMPRP21",42,0)
 W $E(RMPR("NAME"),1,28)," ","(",$$STA^RMPRUTIL,"/",$$ROU^RMPRUTIL(RMPRSITE),")"
"RTN","RMPRP21",43,0)
 W !,?5,$E(RMPRAD1,1,35),?40,$E(RMPR("ADD"),1,39)
"RTN","RMPRP21",44,0)
 I RMPRAD2'="" W !,?5,$E(RMPRAD2,1,35),?40,RMPR("CITY")
"RTN","RMPRP21",45,0)
 I RMPRAD2="" W !?5,RMPRCITY_","_RMPRST_" "_RMPR90IP,?40,RMPR("CITY")
"RTN","RMPRP21",46,0)
 I RMPRAD2'="" W !?5,RMPRCITY_","_RMPRST_" "_RMPR90IP
"RTN","RMPRP21",47,0)
 W !,?5,RMPRPHON
"RTN","RMPRP21",48,0)
 ;W:$G(RMPRVACN)'="" ?22,"ACCT # ",RMPRVACN
"RTN","RMPRP21",49,0)
 W ?40,$P(^RMPR(669.9,RMPRSITE,0),U,4),!,RMPRB
"RTN","RMPRP21",50,0)
 W !,"3. Veterans Name (Last, First, MI)",?40,"4. Date of Authorization"
"RTN","RMPRP21",51,0)
 W !,?5,VADM(1) S Y=$P(R664(0),U,1) D DD^%DT W ?45,Y
"RTN","RMPRP21",52,0)
 I $D(RMPRMOR) W !,RMPRB D HDR1 Q
"RTN","RMPRP21",53,0)
 W !,RMPRB S RMPRODTE=Y
"RTN","RMPRP21",54,0)
 S RMPRDELD="" I $D(R664(3)),$P(R664(3),U,2)]"" S Y=$P(R664(3),U,2) D DD^%DT S RMPRDELD=Y
"RTN","RMPRP21",55,0)
 W !,"5. Veterans Address",?40,"6. Date Required",!,?5,VAPA(1),?45,RMPRDELD,!
"RTN","RMPRP21",56,0)
 I VAPA(2)="" W ?5,VAPA(4)_","_$P(VAPA(5),U,2)_" "_VAPA(6),?40,$E(RMPRB,1,40),!,?40,"9. Authority For Issuance  CFR 17.115",!,?5,VAPA(8),?43,"CHARGE MEDICAL APPROPRIATION"
"RTN","RMPRP21",57,0)
 I VAPA(2)'="" W ?5,VAPA(2),?40,$E(RMPRB,1,40),!,?5,VAPA(4)_","_$P(VAPA(5),U,2)_" "_VAPA(6),?40,"9. Authority For Issuance  CFR 17.115",!,?5,VAPA(8),?43,"CHARGE MEDICAL APPROPRIATION"
"RTN","RMPRP21",58,0)
 W !,RMPRB
"RTN","RMPRP21",59,0)
 W !,"7. Claim Number"_" "_VAEL(7),?40,"8. SSN"_" "_$P(VADM(2),U,2),!,RMPRB,!,"10. Statistical Data",?30,"11. FOB Point",?46,"12. Discount",?61,"13. Delivery Time"
"RTN","RMPRP21",60,0)
 S R664("E")=$O(R664(1,0)),CAT=$P(R664(1,R664("E"),0),U,10)
"RTN","RMPRP21",61,0)
 S RMPRCAT=$S(CAT=1:"SC/OP",CAT=2:"SC/IP",CAT=3:"NSC/IP",CAT=4:"NSC/OP",1:"") S SPE=$P(R664(1,R664("E"),0),U,11)
"RTN","RMPRP21",62,0)
 S RMPRSCAT=$S(SPE=1:"SPECIAL LEGISLATION",SPE=2:"A&A",SPE=3:"PHC",SPE=4:"ELIGIBILITY REFORM",1:"")
"RTN","RMPRP21",63,0)
 W !,RMPRCAT_" "_RMPRSCAT S:+$P(R664(0),U,10) RMPRFOB=$P(R664(0),U,10) W ?34,$S($D(RMPRFOB):"ORIGIN",1:"DEST"),?49,"% " I $D(R664(2)) W $P(R664(2),U,6)
"RTN","RMPRP21",64,0)
 I $D(R664(3)) W ?66,$P(R664(3),U,3)_" Days"
"RTN","RMPRP21",65,0)
 W !,?30,$E(RMPRB,1,50),!,?30,"14. Delivery To: " W:$D(R664(3)) $P(R664(3),U) W !,RMPRB
"RTN","RMPRP21",66,0)
HDR1 ;HEADER FOR 10-2421
"RTN","RMPRP21",67,0)
 W !?17,"15. DESCRIPTION OF ITEMS OR SERVICES AUTHORIZED",!,RMPRB,!,"ITEM NUMBER",?23,"DESCRIPTION/NOMENCLATURE",?50,"QUANTITY",?60,"UNIT",?66,"UNIT",?73,"AMOUNT",!,?50,"ORDERED",?66,"PRICE",!,RMPRB Q:$D(RMPRMOR)
"RTN","RMPRP21",68,0)
 D ^RMPRP22 D:'$D(RMPRMOR1) CON^RMPRP22
"RTN","RMPRP21",69,0)
 S RMPRK=RMPRA
"RTN","RMPRP21",70,0)
 D:$D(RMPRPRIV) ^RMPRP23
"RTN","RMPRP21",71,0)
 W:$G(RMPRPN)=1 @IOF,$$EN^RMPRP24(RMPRK)
"RTN","RMPRP21",72,0)
EX ;KILL VARIABLES AND EXIT ROUTINE
"RTN","RMPRP21",73,0)
 K VADM,CP,DFN,CAT,DIC,R664,RMPRA,RMPACT,RMPRAD1,RMPRAD2,RMPRAMT,RMPRAMT1,RMPRB,RMPRCAT,RMPRCH,RMPRCITY,RMPRDELD,RMPRI,RMPRI1,RMPRIT,RMPRN,RMPRODTE,RMPRST,RMPRPHON,RMPRT,RMPRTOT,RMPRUT,RMPRV,RMPR90IP,RO,RP,J1,RTN,RMPRMOR1,RMPRPRIV
"RTN","RMPRP21",74,0)
 K SPE,VA,VAEL,VAPA,VAERR,RZZZ,RX,RX1,RDUZ,RC,RMPRACT,RMPRSCAT,RMPRDISC,RMPRAMTN,DIR,DIRUT,RMPRAMT2,RMPRFOB,RMPRDA,RMPRMOR,RMPRPAGE,RMPRPRIV,RMPRX,RMPR90,J,K,N D ^%ZISC Q
"RTN","RMPRPAT3")
0^19^B39519148
"RTN","RMPRPAT3",1,0)
RMPRPAT3 ;HINES-CIOFO/HNC,RVD - Detail Display Patient 10-2319 Transaction ;11/03/04
"RTN","RMPRPAT3",2,0)
 ;;3.0;PROSTHETICS;**3,12,25,28,32,41,69,92,99,90**;Feb 09, 1996
"RTN","RMPRPAT3",3,0)
 ;
"RTN","RMPRPAT3",4,0)
 ; RVD 4/30/02 patch #69 - add ICD-9 CODE and description in the display.
"RTN","RMPRPAT3",5,0)
 ;                         add HCPCS and Short Description.
"RTN","RMPRPAT3",6,0)
 ; AAC 08/03/04 Patch 92 - Code Set Versioning (CSV)
"RTN","RMPRPAT3",7,0)
 ;Used API=ICDDX^ICDCODE to replace direct calls to global ICD9(80).
"RTN","RMPRPAT3",8,0)
 ;
"RTN","RMPRPAT3",9,0)
 ;expect ANS,IT(ANS)
"RTN","RMPRPAT3",10,0)
 ;          +IT(ANS)=ien of file 660
"RTN","RMPRPAT3",11,0)
 ;expect variables from GETPAT^RMPRUTIL
"RTN","RMPRPAT3",12,0)
 ;    RMPRSSNE (external form of SSN)
"RTN","RMPRPAT3",13,0)
 ;    RMPRNAM (name of patient)
"RTN","RMPRPAT3",14,0)
 ;    RMPRDOB
"RTN","RMPRPAT3",15,0)
 ;display detailed record
"RTN","RMPRPAT3",16,0)
PRINT ;called from RMPRPAT2
"RTN","RMPRPAT3",17,0)
 ;get 2319 transaction
"RTN","RMPRPAT3",18,0)
 ;
"RTN","RMPRPAT3",19,0)
 N DIC,DIQ,DR,DA,RMPRV,RMPRDA,RV
"RTN","RMPRPAT3",20,0)
 S DIC=660,DIQ="R19",DR=".01:96",DIQ(0)="EN"
"RTN","RMPRPAT3",21,0)
 S (RMPRDA,DA)=+IT(ANS)
"RTN","RMPRPAT3",22,0)
 D EN^DIQ1
"RTN","RMPRPAT3",23,0)
 S DIQ="R19",DR=72,DIQ(0)="I" D EN^DIQ1
"RTN","RMPRPAT3",24,0)
 ;get vendor info
"RTN","RMPRPAT3",25,0)
 S DA=$P(^RMPR(660,RMPRDA,0),U,9)
"RTN","RMPRPAT3",26,0)
 I DA D
"RTN","RMPRPAT3",27,0)
 .S DIC=440,DIQ="RV",DR=".01:6",DIQ(0)="EN"
"RTN","RMPRPAT3",28,0)
 .S (RMPRV,DA)=$P(^RMPR(660,RMPRDA,0),U,9)
"RTN","RMPRPAT3",29,0)
 .D EN^DIQ1
"RTN","RMPRPAT3",30,0)
 ;
"RTN","RMPRPAT3",31,0)
 ;array defined for record in following format:
"RTN","RMPRPAT3",32,0)
 ;R19(filenumber,ien,field,E)=external form of data
"RTN","RMPRPAT3",33,0)
 ;RV(filenumber,ien,field,E)=external form of data
"RTN","RMPRPAT3",34,0)
 ;example:
"RTN","RMPRPAT3",35,0)
 ;R19(660,100,.01,"E")=APR 27, 1995
"RTN","RMPRPAT3",36,0)
 ;R19(660,100,.02,"E")=FUDGE,CHOCOLATE
"RTN","RMPRPAT3",37,0)
 ;RV(440,131,.01,"E")=ORTHOTIC LAB
"RTN","RMPRPAT3",38,0)
 ;
"RTN","RMPRPAT3",39,0)
 D HDR
"RTN","RMPRPAT3",40,0)
 W !,"TYPE OF FORM: ",$G(R19(660,RMPRDA,11,"E"))
"RTN","RMPRPAT3",41,0)
 W ?25,"INITIATOR: ",$G(R19(660,RMPRDA,27,"E"))
"RTN","RMPRPAT3",42,0)
 W ?55,"DATE: ",$G(R19(660,RMPRDA,1,"E"))
"RTN","RMPRPAT3",43,0)
 ;historical/original item
"RTN","RMPRPAT3",44,0)
 ;W !,"ITEM DESCRIPTION: ",$G(R19(660,RMPRDA,89,"E"))
"RTN","RMPRPAT3",45,0)
 W !,"DELIVER TO: ",$G(R19(660,RMPRDA,25,"E"))
"RTN","RMPRPAT3",46,0)
 W !,"TYPE TRANS: ",$G(R19(660,RMPRDA,2,"E"))
"RTN","RMPRPAT3",47,0)
 W ?30,"QTY: ",$G(R19(660,RMPRDA,5,"E"))
"RTN","RMPRPAT3",48,0)
 W:$G(R19(660,RMPRDA,29,"E")) ?40,"INVENTORY POINT: ",R19(660,RMPRDA,29,"E"),!
"RTN","RMPRPAT3",49,0)
 W ?40,"SOURCE: ",$G(R19(660,RMPRDA,12,"E"))
"RTN","RMPRPAT3",50,0)
 ;vendor tracking number
"RTN","RMPRPAT3",51,0)
 I $G(R19(660,RMPRDA,11,"E"))="VISA" D
"RTN","RMPRPAT3",52,0)
 .W !,"VENDOR TRACKING: ",$G(R19(660,RMPRDA,4.2,"E"))
"RTN","RMPRPAT3",53,0)
 .W ?38,"BANK AUTHORIZATION: ",$G(R19(660,RMPRDA,4.3,"E"))
"RTN","RMPRPAT3",54,0)
 W !,"VENDOR: ",?15,$G(R19(660,RMPRDA,7,"E"))
"RTN","RMPRPAT3",55,0)
 I $D(RV) D
"RTN","RMPRPAT3",56,0)
 .W !,"VENDOR PHONE: ",?15,$G(RV(440,RMPRV,5,"E"))
"RTN","RMPRPAT3",57,0)
 .W !?15,$G(RV(440,RMPRV,1,"E"))
"RTN","RMPRPAT3",58,0)
 .W !?15,$G(RV(440,RMPRV,4.2,"E")),","
"RTN","RMPRPAT3",59,0)
 .W ?$X+3,$G(RV(440,RMPRV,4.4,"E")),?$X+5,$G(RV(440,RMPRV,4.6,"E"))
"RTN","RMPRPAT3",60,0)
 W !,"DELIVERY DATE: "
"RTN","RMPRPAT3",61,0)
 I $D(R19(660,RMPRDA,10,"E")) W R19(660,RMPRDA,10,"E")
"RTN","RMPRPAT3",62,0)
 W !
"RTN","RMPRPAT3",63,0)
 I '$P(IT(AN),U,3) D
"RTN","RMPRPAT3",64,0)
 .W "TOTAL COST: "
"RTN","RMPRPAT3",65,0)
 .I $G(R19(660,RMPRDA,14,"E"))'="" W "$"_$J(R19(660,RMPRDA,14,"E"),2)
"RTN","RMPRPAT3",66,0)
 .I $G(R19(660,RMPRDA,14,"E"))="" W $S($G(R19(660,RMPRDA,6,"E"))'="":"$"_$J(R19(660,RMPRDA,6,"E"),2),$G(R19(660,RMPRDA,48,"E"))'="":"$"_$J(R19(660,RMPRDA,48,"E"),2),1:"")
"RTN","RMPRPAT3",67,0)
 W ?30,"OBL: ",$G(R19(660,RMPRDA,23,"E"))
"RTN","RMPRPAT3",68,0)
 ;
"RTN","RMPRPAT3",69,0)
 ;lab data
"RTN","RMPRPAT3",70,0)
 I $D(^RMPR(660,RMPRDA,"LB")) D
"RTN","RMPRPAT3",71,0)
 .N DIC,DIQ,DR,L19,DA
"RTN","RMPRPAT3",72,0)
 .S (DA,RMPRLA)=$P(^RMPR(660,RMPRDA,"LB"),U,10)
"RTN","RMPRPAT3",73,0)
 .Q:DA=""
"RTN","RMPRPAT3",74,0)
 .S DIC=664.1,DIQ="L19",DR="15",DIQ(0)="E"
"RTN","RMPRPAT3",75,0)
 .D EN^DIQ1
"RTN","RMPRPAT3",76,0)
 .W !,"WORK ORDER: ",$G(R19(660,RMPRDA,71,"E"))
"RTN","RMPRPAT3",77,0)
 .W ?40,"RECEIVING STATION: ",$G(R19(660,RMPRDA,70,"E"))
"RTN","RMPRPAT3",78,0)
 .W !,"TECHNICIAN: ",$G(L19(664.1,RMPRLA,15,"E"))
"RTN","RMPRPAT3",79,0)
 .W !,"TOTAL LABOR HOURS: ",$G(R19(660,RMPRDA,45,"E"))
"RTN","RMPRPAT3",80,0)
 .W ?40,"TOTAL LABOR COST: ",$G(R19(660,RMPRDA,46,"E"))
"RTN","RMPRPAT3",81,0)
 .W !,"TOTAL MATERIAL COST: ",$G(R19(660,RMPRDA,47,"E"))
"RTN","RMPRPAT3",82,0)
 .W ?40,"TOTAL LAB COST: ",$G(R19(660,RMPRDA,48,"E"))
"RTN","RMPRPAT3",83,0)
 .W !,"COMPLETION DATE: ",$G(R19(660,RMPRDA,50,"E"))
"RTN","RMPRPAT3",84,0)
 .W ?40,"LAB REMARKS: ",$G(R19(660,RMPRDA,51,"E"))
"RTN","RMPRPAT3",85,0)
 W !,"REMARKS: ",?15,$G(R19(660,RMPRDA,16,"E"))
"RTN","RMPRPAT3",86,0)
 I $G(R19(660,RMPRDA,17.5,"E")) W ?40,"RETURN STATUS: ",R19(660,RMPRDA,17.5,"E")
"RTN","RMPRPAT3",87,0)
 ;
"RTN","RMPRPAT3",88,0)
 ;historical data
"RTN","RMPRPAT3",89,0)
 I $G(R19(660,RMPRDA,15,"E"))["*" D
"RTN","RMPRPAT3",90,0)
 .;include records that have been merged
"RTN","RMPRPAT3",91,0)
 .W !!,"HISTORICAL DATA",!
"RTN","RMPRPAT3",92,0)
 .Q:'$D(R19(660,RMPRDA,89))
"RTN","RMPRPAT3",93,0)
 .W !,?15,"ITEM: ",$G(R19(660,RMPRDA,89,"E"))
"RTN","RMPRPAT3",94,0)
 .W !,?15,"STATION: ",$G(R19(660,RMPRDA,90,"E"))
"RTN","RMPRPAT3",95,0)
 .W !,?15,"VENDOR: ",$G(R19(660,RMPRDA,91,"E")),"   PHONE: ",$G(R19(660,RMPRDA,92,"E"))
"RTN","RMPRPAT3",96,0)
 .W !,?23,$G(R19(660,RMPRDA,93,"E")),!,?23,$G(R19(660,RMPRDA,94,"E"))
"RTN","RMPRPAT3",97,0)
 .W "   ",$G(R19(660,RMPRDA,95,"E")),"  ",$G(R19(660,RMPRDA,96,"E"))
"RTN","RMPRPAT3",98,0)
 ;put in lab display here fields 45,46,47,48 and 51
"RTN","RMPRPAT3",99,0)
 ;lab amis
"RTN","RMPRPAT3",100,0)
 I $G(R19(660,RMPRDA,73,"E")) D
"RTN","RMPRPAT3",101,0)
 .W ?40,"ORTHOTICS LAB CODE: "
"RTN","RMPRPAT3",102,0)
 .W $S($D(R19(660,RMPRDA,74,"E")):R19(660,RMPRDA,74,"E"),$D(R19(660,RMPRDA,75,"E")):R19(660,RMPRDA,75,"E"),1:"")
"RTN","RMPRPAT3",103,0)
 .W !?40,"RESTORATIONS LAB CODE: "
"RTN","RMPRPAT3",104,0)
 .W $S($D(R19(660,RMPRDA,76,"E")):R19(660,RMPRDA,76,"E"),$D(R19(660,RMPRDA,77,"E")):R19(660,RMPRDA,77,"E"),1:"")
"RTN","RMPRPAT3",105,0)
 ;purchasing and issue from stock amis
"RTN","RMPRPAT3",106,0)
 W !,"DISABILITY SERVED: ",$G(R19(660,RMPRDA,62,"E"))
"RTN","RMPRPAT3",107,0)
 ;appliance/item information
"RTN","RMPRPAT3",108,0)
 ;historical/original item
"RTN","RMPRPAT3",109,0)
 W !,"ITEM DESCRIPTION: ",$G(R19(660,RMPRDA,89,"E"))
"RTN","RMPRPAT3",110,0)
 ;check for item description changes
"RTN","RMPRPAT3",111,0)
 I $G(R19(660,RMPRDA,89,"E"))'=$G(R19(660,RMPRDA,4,"E")) W !,"*** See Above For Original Item Description ***"
"RTN","RMPRPAT3",112,0)
 W !,"APPLIANCE: ",$G(R19(660,RMPRDA,4,"E"))
"RTN","RMPRPAT3",113,0)
 W !,"CONTRACT #: ",$G(R19(660,RMPRDA,38.7,"E"))
"RTN","RMPRPAT3",114,0)
 W !,"EXCLUDED/WAIVER: ",$G(R19(660,RMPRDA,38.1,"E"))
"RTN","RMPRPAT3",115,0)
 W !,"PSAS HCPCS: ",$G(R19(660,RMPRDA,4.5,"E"))
"RTN","RMPRPAT3",116,0)
 I $P($G(^RMPR(660,RMPRDA,1)),U,4) W ?22,$P($G(^RMPR(661.1,$P(^RMPR(660,RMPRDA,1),U,4),0)),U,2)
"RTN","RMPRPAT3",117,0)
 ;added by #69
"RTN","RMPRPAT3",118,0)
 ;
"RTN","RMPRPAT3",119,0)
 ; PATCH 92 - Code Set Versioning (CSV) changes below
"RTN","RMPRPAT3",120,0)
 ; AAC      - 08/03/04
"RTN","RMPRPAT3",121,0)
 ;
"RTN","RMPRPAT3",122,0)
 S (RMPRICD,RMPRIC9,RMPRCOD,RMPRDAT)="" S RMPRERR=0
"RTN","RMPRPAT3",123,0)
 S RMPRDAT=$P($G(^RMPR(660,RMPRDA,0)),U,1)
"RTN","RMPRPAT3",124,0)
 I $D(^RMPR(660,RMPRDA,10)) S RMPRIC9=$P(^RMPR(660,RMPRDA,10),U,8)
"RTN","RMPRPAT3",125,0)
 I RMPRIC9'="" D
"RTN","RMPRPAT3",126,0)
 .S RMPRICD=$$ICDDX^ICDCODE(RMPRIC9,RMPRDAT)
"RTN","RMPRPAT3",127,0)
 .S RMPRERR=$P(RMPRICD,U,1)
"RTN","RMPRPAT3",128,0)
 .I RMPRERR<0 W !,"ICD-9 Message: ",$P(RMPRICD,U,2)
"RTN","RMPRPAT3",129,0)
 W !,"ICD-9 Code: "
"RTN","RMPRPAT3",130,0)
 I $G(RMPRICD)'="" W $P(RMPRICD,U,2),?19,$E($P(RMPRICD,U,4),1,55) I $P(RMPRICD,U,10)'>0 W " ","** Inactive ** Date: " S Y=$P(RMPRICD,U,12) D DD^%DT W Y
"RTN","RMPRPAT3",131,0)
 ;
"RTN","RMPRPAT3",132,0)
 ; End of Patch 92
"RTN","RMPRPAT3",133,0)
 ;
"RTN","RMPRPAT3",134,0)
 W !,"CPT MODIFIER: ",$G(R19(660,RMPRDA,4.7,"E"))
"RTN","RMPRPAT3",135,0)
 W !,"DESCRIPTION: ",$G(R19(660,RMPRDA,24,"E"))
"RTN","RMPRPAT3",136,0)
 W !,"EXTENDED DESCRIPTION: ",!
"RTN","RMPRPAT3",137,0)
 I $D(R19(660,RMPRDA,28)) D  G:$D(DUOUT)!$D(DTOUT) EX1
"RTN","RMPRPAT3",138,0)
 .N R28
"RTN","RMPRPAT3",139,0)
 .;command part of new standards
"RTN","RMPRPAT3",140,0)
 .MERGE R28=R19(660,RMPRDA,28)
"RTN","RMPRPAT3",141,0)
 .I $P($G(^RMPR(660,RMPRDA,"DES",0)),U,3)>1 N DIR S DIR(0)="E" D ^DIR Q:$D(DUOUT)!$D(DTOUT)  D HDR W !,"EXTENDED DESCRIPTION: ",!
"RTN","RMPRPAT3",142,0)
 .D EN^DDIOL(.R28)
"RTN","RMPRPAT3",143,0)
 ;NPPD key items consolidated, example L5300 limb order
"RTN","RMPRPAT3",144,0)
 I $P(IT(AN),U,3) W !!,"*** Return For DETAIL REPORT ***" N DIR S DIR(0)="E" D ^DIR G:$D(DUOUT)!$D(DTOUT) EX1  W @IOF D HDR,^RMPRPAT7
"RTN","RMPRPAT3",145,0)
 ;display work order if it is a 2529-3 form
"RTN","RMPRPAT3",146,0)
 ;must pass ien to file 664.1 NOT 664.2
"RTN","RMPRPAT3",147,0)
 I $G(R19(660,RMPRDA,72,"I"))'="" D  G EX1
"RTN","RMPRPAT3",148,0)
 .S DIR(0)="E" D ^DIR Q:$D(DTOUT)!$D(DUOUT)
"RTN","RMPRPAT3",149,0)
 .S RMPRBCK=RMPRDA
"RTN","RMPRPAT3",150,0)
 .N DIC
"RTN","RMPRPAT3",151,0)
 .S RMPRDA=R19(660,RMPRBCK,72,"I")
"RTN","RMPRPAT3",152,0)
 .D DISP^RMPR293(RMPRDA)
"RTN","RMPRPAT3",153,0)
 .S RMPRDA=RMPRBCK K RMPRBCK
"RTN","RMPRPAT3",154,0)
 ;return from work order
"RTN","RMPRPAT3",155,0)
 G EXIT
"RTN","RMPRPAT3",156,0)
 ;
"RTN","RMPRPAT3",157,0)
HDR ;display heading
"RTN","RMPRPAT3",158,0)
 W @IOF,RMPRNAM,?30," SSN: "
"RTN","RMPRPAT3",159,0)
 W $E(RMPRSSN,1,3)_"-"_$E(RMPRSSN,4,5)_"-"_$E(RMPRSSN,6,10),?50
"RTN","RMPRPAT3",160,0)
 W $G(R19(660,RMPRDA,8,"E")),?70,"DOB: "
"RTN","RMPRPAT3",161,0)
 W $S(RMPRDOB:$E(RMPRDOB,4,5)_"-"_$E(RMPRDOB,6,7)_"-"_(1700+$E(RMPRDOB,1,3)),1:"Unknown")
"RTN","RMPRPAT3",162,0)
 W !?20,"APPLIANCE/REPAIR LINE ITEM DETAIL ",?70,"<4-",ANS,">",!
"RTN","RMPRPAT3",163,0)
 Q
"RTN","RMPRPAT3",164,0)
EXIT ;common exit point
"RTN","RMPRPAT3",165,0)
 I $Y>(IOSL-4) F  W ! Q:$Y>(IOSL-3)
"RTN","RMPRPAT3",166,0)
 N DIR S DIR(0)="E" D ^DIR
"RTN","RMPRPAT3",167,0)
 ;duout,dtout is evaluated in dis+1^rmprpat2
"RTN","RMPRPAT3",168,0)
EX1 ;back out through that point to clean up
"RTN","RMPRPAT3",169,0)
 K R19,RV,RMPRICD,RMPRIC9,RMPRICD,RMPRIC9,MSGICD,RMPRCOD,RMPRERR,RMPRDAT,Y W @IOF
"RTN","RMPRPAT3",170,0)
 Q
"RTN","RMPRPAT3",171,0)
 ;end
"RTN","RMPRSE1")
0^37^B21618180
"RTN","RMPRSE1",1,0)
RMPRSE1 ;PHX/RFM-SEARCH FILE 660 ENTRIES FOR ITEM HISTORY ;8/29/1994
"RTN","RMPRSE1",2,0)
 ;;3.0;PROSTHETICS;**20,57,77,90**;Feb 09, 1996
"RTN","RMPRSE1",3,0)
 ;RVD 3/17/03 patch #77 - allow queing to p-message.  IO to ION.
"RTN","RMPRSE1",4,0)
 ;                      - use RMPR("STA") instead of $$STA^RMPRUTIL.
"RTN","RMPRSE1",5,0)
 ;
"RTN","RMPRSE1",6,0)
EN N ITEM,RMPRARR,RMPRI D HOME^%ZIS,DIV4^RMPRSIT G:$D(X) EXIT1 S DIC="^RMPR(661,",DIC(0)="AEQM" F ITEM=1:1 S DIC("A")="Select ITEM "_ITEM_": " D ^DIC G:$D(DTOUT)!(X["^")!(X=""&(ITEM=1)) EXIT1 Q:X=""  D
"RTN","RMPRSE1",7,0)
 .I $D(RMPRI(+Y)) W $C(7)," ??",?40,"..Duplicate Item" S ITEM=ITEM-1 Q
"RTN","RMPRSE1",8,0)
 .S RMPRARR(ITEM)=+Y,RMPRI(+Y)=""
"RTN","RMPRSE1",9,0)
 S RMPRCOUN=0 W !! S %DT("A")="Beginning Date: ",%DT="AEPX",%DT("B")="T-30" D ^%DT S RMPRBDT=Y G:Y<0 EXIT1
"RTN","RMPRSE1",10,0)
ENDATE S %DT("A")="Ending Date: ",%DT="AEX",%DT("B")="TODAY" D ^%DT G:Y<0 EXIT1 I RMPRBDT>Y W !,$C(7),"Invalid Date Range Selection!!" G ENDATE
"RTN","RMPRSE1",11,0)
 G:Y<0 EXIT S RMPREDT=Y,Y=RMPRBDT D DD^%DT S RMPRX=Y,Y=RMPREDT D DD^%DT S RMPRY=Y
"RTN","RMPRSE1",12,0)
 S %ZIS="MQ" K IOP D ^%ZIS G:POP EXIT
"RTN","RMPRSE1",13,0)
 I '$D(IO("Q")) U IO G PRINT
"RTN","RMPRSE1",14,0)
 K IO("Q") S ZTDESC="SEARCH FOR RECALLED ITEM",ZTRTN="PRINT^RMPRSE1",ZTIO=ION,ZTSAVE("RMPRBDT")="",ZTSAVE("RMPREDT")="",ZTSAVE("RMPRI(")="",ZTSAVE("RMPRX")="",ZTSAVE("RMPRY")="",ZTSAVE("RMPR(""STA"")")="",ZTSAVE("RMPRARR(")=""
"RTN","RMPRSE1",15,0)
 D ^%ZTLOAD W:$D(ZTSK) !,"REQUEST QUEUED!" H 1 G EXIT1
"RTN","RMPRSE1",16,0)
PRINT ;ENTRY POINT FOR PRINTING REPORT
"RTN","RMPRSE1",17,0)
 S PAGE=1,(RMPRCOUN,RP,QTYT,COSTT)=0 I IOST["C-" D WAIT^DICD
"RTN","RMPRSE1",18,0)
PRI S RQ=0 F  S RQ=$O(RMPRARR(RQ)) Q:RQ=""!($D(KILL))  S RO=$P(RMPRARR(RQ),U),RO=RO-1 D PRI1
"RTN","RMPRSE1",19,0)
 G EXIT
"RTN","RMPRSE1",20,0)
PRI1 F  S RO=$O(^RMPR(660,"AD",RO)) D:RO=""!(RO'=$P(RMPRARR(RQ),U)) REST Q:RO=""!(RO'=$P(RMPRARR(RQ),U))!($D(KILL))  K ENDD F  S RP=$O(^RMPR(660,"AD",RO,RP)) Q:RP=""!($D(KILL))  D CK
"RTN","RMPRSE1",21,0)
 Q
"RTN","RMPRSE1",22,0)
EXIT ;EXIT FROM REPORT HERE
"RTN","RMPRSE1",23,0)
 I RMPRCOUN>0,$D(RMPREDT),'$D(KILL) W !!?32,"END OF REPORT"
"RTN","RMPRSE1",24,0)
 I $E(IOST)["C"&($Y<22),'$D(ENDD) F  W ! Q:$Y>20
"RTN","RMPRSE1",25,0)
 I $D(RMPREDT),$E(IOST)["C",'$D(RMPRFLL),'$D(KILL),'$D(DUOUT),'$D(DTOUT),'$D(ENDD) K DIR S DIR(0)="E" D ^DIR
"RTN","RMPRSE1",26,0)
EXIT1 K RMPRARR,%DT,GOTO,QTYT,ITEM,KILL,ENDD,RQ,RP,RO,ITEM,RMPRI,COSTT,DIC,DIR,PAGE,RO,RMPRCOUN,RMPRSE,RMPRBDT,RMPREDT,RMPRX,RMPRY D ^%ZISC
"RTN","RMPRSE1",27,0)
 Q
"RTN","RMPRSE1",28,0)
CK Q:'$D(^RMPR(660,RP,0))
"RTN","RMPRSE1",29,0)
 I $P(^RMPR(660,RP,0),U,10)'=RMPR("STA") Q
"RTN","RMPRSE1",30,0)
 I ($P(^(0),U,4)="X")!('$P(^(0),U,6))!($P(^(0),U,3)<RMPRBDT)!($P(^(0),U,3)>RMPREDT)  Q  I '$D(^PRC(441,$P(^RMPR(661,$P(^(0),U,6),0),U))) Q
"RTN","RMPRSE1",31,0)
 I $P(RMPRARR(RQ),U)=$P(^RMPR(660,RP,0),U,6) D CON
"RTN","RMPRSE1",32,0)
 Q
"RTN","RMPRSE1",33,0)
CON I $Y>(IOSL-6),PAGE=1,'RMPRCOUN W @IOF
"RTN","RMPRSE1",34,0)
 D HEAD S RMPRCOUN=RMPRCOUN+1
"RTN","RMPRSE1",35,0)
 S Y=$P(^RMPR(660,RP,0),U,3) D DD^%DT W !,Y,?15,$E($P(^DPT($P(^RMPR(660,RP,0),U,2),0),U,1),1,13),?30,$E($P(^DPT($P(^RMPR(660,RP,0),U,2),0),U,9),6,9)
"RTN","RMPRSE1",36,0)
 W:$P(^RMPR(660,RP,0),U,9)'="" ?36,$E($P(^PRC(440,$P(^RMPR(660,RP,0),U,9),0),U,1),1,35)
"RTN","RMPRSE1",37,0)
 W !,"SERIAL NBR:",?12,$E($P(^RMPR(660,RP,0),U,11),1,12),?25,"QTY: ",$J($P(^(0),U,7),4),?38,"TOTAL COST: ",$J($FN($P(^(0),U,16),"P",2),8) S QTYT=QTYT+$P(^(0),U,7),COSTT=COSTT+$P(^(0),U,16)
"RTN","RMPRSE1",38,0)
 W ?60,$S($P(^RMPR(660,RP,0),U,4)="I":"INITIAL ISSUE",$P(^(0),U,4)="R":"REPLACEMENT",$P(^(0),U,4)="S":"SPARE",$P(^(0),U,4)="X":"REPAIR",$P(^(0),U,4)="5":"RENTAL",1:"UNK"),!,"INITIATOR: "
"RTN","RMPRSE1",39,0)
 I $P(^RMPR(660,RP,0),U,27),$D(^VA(200,$P(^(0),U,27),0)) W ?15,$P(^(0),U),!
"RTN","RMPRSE1",40,0)
 I $E(IOST)["C"&($Y>(IOSL-6)) S DIR(0)="E" D ^DIR S:Y<1 KILL=1 Q:Y<1  K DIR W @IOF D HEAD Q
"RTN","RMPRSE1",41,0)
 I $Y>(IOSL-6) W @IOF D HEAD
"RTN","RMPRSE1",42,0)
 Q
"RTN","RMPRSE1",43,0)
HEAD I $Y<2!(PAGE=1) W !,"ITEM HISTORY:",?15,$E($P(^PRC(441,$P(^RMPR(661,$P(^RMPR(660,RP,0),U,6),0),U,1),0),U,2),1,39),?63,"STA ",RMPR("STA"),?72,"PAGE ",PAGE S PAGE=PAGE+1
"RTN","RMPRSE1",44,0)
 I  W !!,"REQUEST DATE",?15,"PATIENT NAME",?30,"SSN",?36,"VENDOR" S Y=RMPRBDT D DD^%DT W ?55,Y,"-" S Y=RMPREDT D DD^%DT W Y
"RTN","RMPRSE1",45,0)
 Q
"RTN","RMPRSE1",46,0)
REST D:'RMPRCOUN NONE Q:$D(KILL)!('RMPRCOUN)  W !,"TOTAL DOLLARS SPENT ON THIS ITEM: ","$"_$J($FN(COSTT,"P",2),9),?45,"TOTAL QUANTITY ISSUED: ",$J(QTYT,4) I $O(RMPRARR(RQ)),$E(IOST)["C" W ! K DIR S DIR(0)="E" D ^DIR S:Y<1 KILL=1 W:'$D(KILL) @IOF
"RTN","RMPRSE1",47,0)
 I $E(IOST)'["C",$O(RMPRARR(RQ)) W @IOF
"RTN","RMPRSE1",48,0)
 S (COSTT,QTYT,RMPRCOUN)="" Q
"RTN","RMPRSE1",49,0)
NONE W @IOF,!!,"No Item History for this date range for:",!,$P(^PRC(441,$P(^RMPR(661,$P(RMPRARR(RQ),U),0),U),0),U,2) I $E(IOST)["C" K DIR S DIR(0)="E" W !!!! D ^DIR S:Y<1 KILL=1 S ENDD=1
"RTN","RMPRSE1",50,0)
 Q
"RTN","RMPRSE2")
0^38^B22152998
"RTN","RMPRSE2",1,0)
RMPRSE2 ;PHX/RFM/HNB -SEARCH FILE 660 ENTRIES FOR HCPCS HISTORY ;1/23/1998
"RTN","RMPRSE2",2,0)
 ;;3.0;PROSTHETICS;**28,30,32,36,46,77,90**;Feb 09, 1996
"RTN","RMPRSE2",3,0)
 ;RVD 3/17/03 patch #77 - allow queing to p-message.  IO to ION.
"RTN","RMPRSE2",4,0)
 ;this routine is modified for future patch
"RTN","RMPRSE2",5,0)
EN S (ITEM,RMPRARR,RMPRI)=""
"RTN","RMPRSE2",6,0)
 K KILL
"RTN","RMPRSE2",7,0)
 D HOME^%ZIS,DIV4^RMPRSIT G:$D(X) EXIT1
"RTN","RMPRSE2",8,0)
 W !!!
"RTN","RMPRSE2",9,0)
 S DIC="^ICPT(",DIC(0)="AEQM"
"RTN","RMPRSE2",10,0)
 F ITEM=1:1 S DIC("A")="Select HCPCS ("_ITEM_"): " D ^DIC G:$D(DTOUT)!(X["^")!(X=""&(ITEM=1)) EXIT1 Q:X=""  D
"RTN","RMPRSE2",11,0)
 .I $D(RMPRI(+Y)) W !,$C(7)," ??",?40,"..Duplicate HCPCS" S ITEM=ITEM-1 Q
"RTN","RMPRSE2",12,0)
 .S RMPRARR(ITEM)=+Y,RMPRI(+Y)=""
"RTN","RMPRSE2",13,0)
 S RMPRCOUN=0 W !! S %DT("A")="Beginning Date: ",%DT="AEPX",%DT("B")="T-30" D ^%DT S RMPRBDT=Y G:Y<0 EXIT1
"RTN","RMPRSE2",14,0)
ENDATE S %DT("A")="Ending Date: ",%DT="AEX",%DT("B")="TODAY"
"RTN","RMPRSE2",15,0)
 D ^%DT G:Y<0 EXIT1
"RTN","RMPRSE2",16,0)
 I RMPRBDT>Y W !,$C(7),"Invalid Date Range Selection!!" G ENDATE
"RTN","RMPRSE2",17,0)
 G:Y<0 EXIT
"RTN","RMPRSE2",18,0)
 S RMPREDT=Y,Y=RMPRBDT D DD^%DT S RMPRX=Y,Y=RMPREDT D DD^%DT S RMPRY=Y
"RTN","RMPRSE2",19,0)
 S %ZIS="MQ" K IOP D ^%ZIS G:POP EXIT
"RTN","RMPRSE2",20,0)
 I '$D(IO("Q")) U IO G PRINT
"RTN","RMPRSE2",21,0)
 K IO("Q") S ZTDESC="SEARCH FOR RECALLED ITEM",ZTRTN="PRINT^RMPRSE2",ZTIO=ION,ZTSAVE("RMPRBDT")="",ZTSAVE("RMPREDT")="",ZTSAVE("RMPRI(")="",ZTSAVE("RMPRX")="",ZTSAVE("RMPRY")="",ZTSAVE("RMPR(""STA"")")="",ZTSAVE("RMPRARR(")=""
"RTN","RMPRSE2",22,0)
 S ZTSAVE("RMPRSITE")=""
"RTN","RMPRSE2",23,0)
 D ^%ZTLOAD W:$D(ZTSK) !,"REQUEST QUEUED!" H 1 G EXIT1
"RTN","RMPRSE2",24,0)
PRINT ;ENTRY POINT FOR PRINTING REPORT
"RTN","RMPRSE2",25,0)
 S PAGE=1,(RMPRCOUN,RP,QTYT,COSTT)=0
"RTN","RMPRSE2",26,0)
 S RQ=0
"RTN","RMPRSE2",27,0)
 F  S RQ=$O(RMPRARR(RQ)) Q:RQ'>0!($D(KILL))  D  D REST
"RTN","RMPRSE2",28,0)
 .S RO=$P(RMPRARR(RQ),U,1),RO=RO-1
"RTN","RMPRSE2",29,0)
 .F  S RO=$O(^RMPR(660,"G",RO)) Q:RO'>0  D
"RTN","RMPRSE2",30,0)
 . .Q:RO=""!(RO'=$P(RMPRARR(RQ),U))!($D(KILL))
"RTN","RMPRSE2",31,0)
 . .K ENDD
"RTN","RMPRSE2",32,0)
 . .F  S RP=$O(^RMPR(660,"G",RO,RP)) Q:RP=""!($D(KILL))  D CK
"RTN","RMPRSE2",33,0)
 G EXIT
"RTN","RMPRSE2",34,0)
 Q
"RTN","RMPRSE2",35,0)
EXIT ;EXIT FROM REPORT HERE
"RTN","RMPRSE2",36,0)
 I RMPRCOUN>0,$D(RMPREDT),'$D(KILL) W !!?32,"END OF REPORT"
"RTN","RMPRSE2",37,0)
 I $E(IOST)["C"&($Y<22),'$D(ENDD) F  W ! Q:$Y>20
"RTN","RMPRSE2",38,0)
 I $D(RMPREDT),$E(IOST)["C",'$D(RMPRFLL),'$D(KILL),'$D(DUOUT),'$D(DTOUT),'$D(ENDD) K DIR S DIR(0)="E" D ^DIR
"RTN","RMPRSE2",39,0)
EXIT1 K RMPRARR,%DT,GOTO,QTYT,ITEM,KILL,ENDD,RQ,RP,RO,ITEM,RMPRI,COSTT,DIC,DIR,PAGE,RO,RMPRCOUN,RMPRSE,RMPRBDT,RMPREDT,RMPRX,RMPRY D ^%ZISC
"RTN","RMPRSE2",40,0)
 Q
"RTN","RMPRSE2",41,0)
CK Q:'$D(^RMPR(660,RP,0))
"RTN","RMPRSE2",42,0)
 ;hcpcs
"RTN","RMPRSE2",43,0)
 I ('$P(^(0),U,22))!($P(^(0),U,3)<RMPRBDT)!($P(^(0),U,3)>RMPREDT)  Q
"RTN","RMPRSE2",44,0)
 I $P(^RMPR(660,RP,0),U,10)'=RMPR("STA") Q
"RTN","RMPRSE2",45,0)
 ;I '$D(^PRC(441,$P(^RMPR(661,$P(^(0),U,6),0),U))) Q
"RTN","RMPRSE2",46,0)
 I $P(RMPRARR(RQ),U,1)=$P(^RMPR(660,RP,0),U,22) D CON
"RTN","RMPRSE2",47,0)
 Q
"RTN","RMPRSE2",48,0)
 ;
"RTN","RMPRSE2",49,0)
CON I $Y>(IOSL-6),PAGE=1,'RMPRCOUN W @IOF
"RTN","RMPRSE2",50,0)
 D HEAD S RMPRCOUN=RMPRCOUN+1
"RTN","RMPRSE2",51,0)
 S Y=$P(^RMPR(660,RP,0),U,3) D DD^%DT
"RTN","RMPRSE2",52,0)
 W !,Y,?15,$E($P(^DPT($P(^RMPR(660,RP,0),U,2),0),U,1),1,13),?30,$E($P(^DPT($P(^RMPR(660,RP,0),U,2),0),U,9),6,9)
"RTN","RMPRSE2",53,0)
 W:$P(^RMPR(660,RP,0),U,9)'="" ?36,$E($P(^PRC(440,$P(^RMPR(660,RP,0),U,9),0),U,1),1,35)
"RTN","RMPRSE2",54,0)
 W !,"ITEM: " S ITMP=$P(^RMPR(660,RP,0),U,6)
"RTN","RMPRSE2",55,0)
 W:ITMP'="" $E($P(^PRC(441,$P(^RMPR(661,ITMP,0),U,1),0),U,2),1,20)
"RTN","RMPRSE2",56,0)
 K ITMP
"RTN","RMPRSE2",57,0)
 I $P(^RMPR(660,RP,0),U,13)=4 D
"RTN","RMPRSE2",58,0)
 .W ?27,"QTY: ",$J($P(^RMPR(660,RP,0),U,7),4),?38,"TOTAL COST: ",$J($FN($P(^("LB"),U,9),"P",2),8) S QTYT=QTYT+$P(^(0),U,7),COSTT=COSTT+$P(^("LB"),U,9)
"RTN","RMPRSE2",59,0)
 I $P(^RMPR(660,RP,0),U,13)'=4 W ?27,"QTY: ",$J($P(^RMPR(660,RP,0),U,7),4),?38,"TOTAL COST: ",$J($FN($P(^(0),U,16),"P",2),8) S QTYT=QTYT+$P(^(0),U,7),COSTT=COSTT+$P(^(0),U,16)
"RTN","RMPRSE2",60,0)
 W ?60,$S($P(^RMPR(660,RP,0),U,4)="I":"INITIAL ISSUE",$P(^(0),U,4)="R":"REPLACEMENT",$P(^(0),U,4)="S":"SPARE",$P(^(0),U,4)="X":"REPAIR",$P(^(0),U,4)="5":"RENTAL",1:"UNK"),!,"INITIATOR: "
"RTN","RMPRSE2",61,0)
 I $P(^RMPR(660,RP,0),U,27),$D(^VA(200,$P(^(0),U,27),0)) W ?15,$P(^(0),U),!
"RTN","RMPRSE2",62,0)
 I $E(IOST)["C"&($Y>(IOSL-6)) S DIR(0)="E" D ^DIR S:Y<1 KILL=1 Q:Y<1  K DIR W @IOF D HEAD Q
"RTN","RMPRSE2",63,0)
 I $Y>(IOSL-6) W @IOF D HEAD
"RTN","RMPRSE2",64,0)
 Q
"RTN","RMPRSE2",65,0)
 ;
"RTN","RMPRSE2",66,0)
HEAD I $Y<2!(PAGE=1) D
"RTN","RMPRSE2",67,0)
 .W !,"HCPCS HISTORY:",?15
"RTN","RMPRSE2",68,0)
 .W $E($P(^ICPT($P(^RMPR(660,RP,0),U,22),0),U,1),1,39)
"RTN","RMPRSE2",69,0)
 .W ?63,"STA ",$$STA^RMPRUTIL,?72,"PAGE ",PAGE S PAGE=PAGE+1
"RTN","RMPRSE2",70,0)
 .W !!,"REQUEST DATE",?15,"PATIENT NAME",?30,"SSN",?36,"VENDOR"
"RTN","RMPRSE2",71,0)
 .S Y=RMPRBDT D DD^%DT W ?55,Y,"-" S Y=RMPREDT D DD^%DT W Y
"RTN","RMPRSE2",72,0)
 .W ! F BH=1:1:IOM W "="
"RTN","RMPRSE2",73,0)
 Q
"RTN","RMPRSE2",74,0)
 ;
"RTN","RMPRSE2",75,0)
REST D:'RMPRCOUN NONE Q:$D(KILL)!('RMPRCOUN)  W !,"TOTAL DOLLARS SPENT ON THIS HCPCS: ","$"_$J($FN(COSTT,"P",2),9),?45,"TOTAL QUANTITY ISSUED: ",$J(QTYT,4)
"RTN","RMPRSE2",76,0)
 I $O(RMPRARR(RQ)),$E(IOST)["C" W ! K DIR S DIR(0)="E" D ^DIR S:Y<1 KILL=1 W:'$D(KILL) @IOF
"RTN","RMPRSE2",77,0)
 I $E(IOST)'["C",$O(RMPRARR(RQ)) W @IOF
"RTN","RMPRSE2",78,0)
 S (COSTT,QTYT,RMPRCOUN)=""
"RTN","RMPRSE2",79,0)
 Q
"RTN","RMPRSE2",80,0)
 ;
"RTN","RMPRSE2",81,0)
NONE W @IOF,!!,"No '",$P(^ICPT(RMPRARR(RQ),0),U,1),"' HCPCS History for this date range.",!
"RTN","RMPRSE2",82,0)
 ;,$P(^PRC(441,$P(^RMPR(661,$P(RMPRARR(RQ),U),0),U),0),U,2)
"RTN","RMPRSE2",83,0)
 I $E(IOST)["C" K DIR S DIR(0)="E" W !!!! D ^DIR W @IOF S:Y<1 KILL=1 S ENDD=1
"RTN","RMPRSE2",84,0)
 Q
"RTN","RMPRSE2",85,0)
XREF ;set new x-ref for the field HCPCS in 660
"RTN","RMPRSE2",86,0)
 W !!,"New Cross Reference for HCPCS..."
"RTN","RMPRSE2",87,0)
 S DIK="^RMPR(660,",DIK(1)="4.1^G" D ENALL^DIK
"RTN","RMPRSE2",88,0)
 Q
"RTN","RMPRSE2",89,0)
 ;END
"RTN","RMPRSE21")
0^39^B28209992
"RTN","RMPRSE21",1,0)
RMPRSE21 ;HINES CIOFO/HNB-SEARCH FILE 660 ENTRIES PSAS HCPCS HISTORY;1/23/1998
"RTN","RMPRSE21",2,0)
 ;;3.0;PROSTHETICS;**36,62,77,92,90**;Feb 09, 1996
"RTN","RMPRSE21",3,0)
 ; RVD patch #62 - add ICD9 code and Description in the output
"RTN","RMPRSE21",4,0)
 ; RVD patch #77 3/17/03 - use RMPR("STA") instead of $$STA^RMPRUTIL
"RTN","RMPRSE21",5,0)
 ;
"RTN","RMPRSE21",6,0)
 ; AAC Patch 92 08/03/04 - Code Set Versioning (CSV)
"RTN","RMPRSE21",7,0)
 ;                       - Used API=ICDDX^ICDCODE to replace direct calls to global ICD9(80).
"RTN","RMPRSE21",8,0)
 ;
"RTN","RMPRSE21",9,0)
EN S (ITEM,RMPRARR,RMPRI,RMPRDA)=""
"RTN","RMPRSE21",10,0)
 K KILL
"RTN","RMPRSE21",11,0)
 D HOME^%ZIS,DIV4^RMPRSIT G:$D(X) EXIT1
"RTN","RMPRSE21",12,0)
 W !!!
"RTN","RMPRSE21",13,0)
 S DIC="^RMPR(661.1,",DIC(0)="AEQM"
"RTN","RMPRSE21",14,0)
 F ITEM=1:1 S DIC("A")="Select PSAS HCPCS ("_ITEM_"): " D ^DIC G:$D(DTOUT)!(X["^")!(X=""&(ITEM=1)) EXIT1 Q:X=""  D
"RTN","RMPRSE21",15,0)
 .I $D(RMPRI(+Y)) W !,$C(7)," ??",?40,"..Duplicate PSAS HCPCS" S ITEM=ITEM-1 Q
"RTN","RMPRSE21",16,0)
 .S RMPRARR(ITEM)=+Y,RMPRI(+Y)=""
"RTN","RMPRSE21",17,0)
 S RMPRCOUN=0 W !! S %DT("A")="Beginning Date: ",%DT="AEPX",%DT("B")="T-30" D ^%DT S RMPRBDT=Y G:Y<0 EXIT1
"RTN","RMPRSE21",18,0)
ENDATE S %DT("A")="Ending Date: ",%DT="AEX",%DT("B")="TODAY"
"RTN","RMPRSE21",19,0)
 D ^%DT G:Y<0 EXIT1
"RTN","RMPRSE21",20,0)
 I RMPRBDT>Y W !,$C(7),"Invalid Date Range Selection!!" G ENDATE
"RTN","RMPRSE21",21,0)
 G:Y<0 EXIT
"RTN","RMPRSE21",22,0)
 S RMPREDT=Y,Y=RMPRBDT D DD^%DT S RMPRX=Y,Y=RMPREDT  D DD^%DT S RMPRY=Y
"RTN","RMPRSE21",23,0)
 S %ZIS="MQ" K IOP D ^%ZIS G:POP EXIT
"RTN","RMPRSE21",24,0)
 I '$D(IO("Q")) U IO G PRINT
"RTN","RMPRSE21",25,0)
 K IO("Q") S ZTDESC="SEARCH FOR PSAS HCPCS",ZTRTN="PRINT^RMPRSE21",ZTIO=ION,ZTSAVE("RMPRBDT")="",ZTSAVE("RMPREDT")="",ZTSAVE("RMPRI(")="",ZTSAVE("RMPRX")="",ZTSAVE("RMPRY")="",ZTSAVE("RMPR(""STA"")")="",ZTSAVE("RMPRARR(")=""
"RTN","RMPRSE21",26,0)
 S ZTSAVE("RMPR(")="",ZTSAVE("RMPRSITE")=""
"RTN","RMPRSE21",27,0)
 D ^%ZTLOAD W:$D(ZTSK) !,"REQUEST QUEUED!" H 1 G EXIT1
"RTN","RMPRSE21",28,0)
PRINT ;ENTRY POINT FOR PRINTING REPORT
"RTN","RMPRSE21",29,0)
 S PAGE=1,(RMPRCOUN,RP,QTYT,COSTT)=0
"RTN","RMPRSE21",30,0)
 S RQ=0
"RTN","RMPRSE21",31,0)
 F  S RQ=$O(RMPRARR(RQ)) Q:RQ'>0!($D(KILL))  D  D REST
"RTN","RMPRSE21",32,0)
 .S RO=$P(RMPRARR(RQ),U,1),RO=RO-1
"RTN","RMPRSE21",33,0)
 .F  S RO=$O(^RMPR(660,"H",RO)) Q:RO'>0  D
"RTN","RMPRSE21",34,0)
 . .Q:RO=""!(RO'=$P(RMPRARR(RQ),U))!($D(KILL))
"RTN","RMPRSE21",35,0)
 . .K ENDD
"RTN","RMPRSE21",36,0)
 . .F  S RP=$O(^RMPR(660,"H",RO,RP)) Q:RP=""!($D(KILL))  D CK
"RTN","RMPRSE21",37,0)
 G EXIT
"RTN","RMPRSE21",38,0)
 Q
"RTN","RMPRSE21",39,0)
EXIT ;EXIT FROM REPORT HERE
"RTN","RMPRSE21",40,0)
 I RMPRCOUN>0,$D(RMPREDT),'$D(KILL) W !!?32,"END OF REPORT"
"RTN","RMPRSE21",41,0)
 I $E(IOST)["C"&($Y<22),'$D(ENDD) F  W ! Q:$Y>20
"RTN","RMPRSE21",42,0)
 I $D(RMPREDT),$E(IOST)["C",'$D(RMPRFLL),'$D(KILL),'$D(DUOUT),'$D(DTOUT),'$D(ENDD) K DIR S DIR(0)="E" D ^DIR
"RTN","RMPRSE21",43,0)
EXIT1 K RMPRARR,%DT,GOTO,QTYT,ITEM,KILL,ENDD,RQ,RP,RO,ITEM,RMPRI,COSTT,DIC,DIR,PAGE,RO,RMPRCOUN,RMPRSE,RMPRBDT,RMPREDT,RMPRX,RMPRY D ^%ZISC
"RTN","RMPRSE21",44,0)
 Q
"RTN","RMPRSE21",45,0)
CK Q:'$D(^RMPR(660,RP,0))
"RTN","RMPRSE21",46,0)
 ;hcpcs
"RTN","RMPRSE21",47,0)
 I ('$P(^RMPR(660,RP,1),U,4))!($P(^(0),U,3)<RMPRBDT)!($P(^(0),U,3)>RMPREDT)  Q
"RTN","RMPRSE21",48,0)
 I $P(^RMPR(660,RP,0),U,10)'=RMPR("STA") Q
"RTN","RMPRSE21",49,0)
 ;
"RTN","RMPRSE21",50,0)
 I $P(RMPRARR(RQ),U,1)=$P(^RMPR(660,RP,1),U,4) D CON
"RTN","RMPRSE21",51,0)
 Q
"RTN","RMPRSE21",52,0)
 ;
"RTN","RMPRSE21",53,0)
CON I $Y>(IOSL-6),PAGE=1,'RMPRCOUN W @IOF
"RTN","RMPRSE21",54,0)
 D HEAD S RMPRCOUN=RMPRCOUN+1
"RTN","RMPRSE21",55,0)
 S (RMPRDA,Y)=$P(^RMPR(660,RP,0),U,3) D DD^%DT
"RTN","RMPRSE21",56,0)
 W !,Y,?15,$E($P(^DPT($P(^RMPR(660,RP,0),U,2),0),U,1),1,13),?30,$E($P(^DPT($P(^RMPR(660,RP,0),U,2),0),U,9),6,9)
"RTN","RMPRSE21",57,0)
 W:$P(^RMPR(660,RP,0),U,9)'="" ?36,$E($P(^PRC(440,$P(^RMPR(660,RP,0),U,9),0),U,1),1,35)
"RTN","RMPRSE21",58,0)
 W !,"ITEM: " S ITMP=$P(^RMPR(660,RP,0),U,6)
"RTN","RMPRSE21",59,0)
 W:ITMP'="" $E($P(^PRC(441,$P(^RMPR(661,ITMP,0),U,1),0),U,2),1,20)
"RTN","RMPRSE21",60,0)
 K ITMP
"RTN","RMPRSE21",61,0)
 I $P(^RMPR(660,RP,0),U,13)=4 D
"RTN","RMPRSE21",62,0)
 .W ?27,"QTY: ",$J($P(^RMPR(660,RP,0),U,7),4),?38,"TOTAL COST: ",$J($FN($P(^("LB"),U,9),"P",2),8) S QTYT=QTYT+$P(^(0),U,7),COSTT=COSTT+$P(^("LB"),U,9)
"RTN","RMPRSE21",63,0)
 I $P(^RMPR(660,RP,0),U,13)'=4 W ?27,"QTY: ",$J($P(^RMPR(660,RP,0),U,7),4),?38,"TOTAL COST: ",$J($FN($P(^(0),U,16),"P",2),8) S QTYT=QTYT+$P(^(0),U,7),COSTT=COSTT+$P(^(0),U,16)
"RTN","RMPRSE21",64,0)
 W ?60,$S($P(^RMPR(660,RP,0),U,4)="I":"INITIAL ISSUE",$P(^(0),U,4)="R":"REPLACEMENT",$P(^(0),U,4)="S":"SPARE",$P(^(0),U,4)="X":"REPAIR",$P(^(0),U,4)="5":"RENTAL",1:"UNK"),!,"INITIATOR: "
"RTN","RMPRSE21",65,0)
 I $P(^RMPR(660,RP,0),U,27),$D(^VA(200,$P(^(0),U,27),0)) W ?15,$P(^(0),U)
"RTN","RMPRSE21",66,0)
 ;
"RTN","RMPRSE21",67,0)
 ; Patch 92 - Code Set Versioning (CSV) changes below
"RTN","RMPRSE21",68,0)
 ; AAC - 08/03/04
"RTN","RMPRSE21",69,0)
 ;
"RTN","RMPRSE21",70,0)
 S (RMPRICD,RMPRIC9,RMPRCOD,RMPRDAT)="" S RMPRERR=0
"RTN","RMPRSE21",71,0)
 S RMPRDAT=$P($G(^RMPR(660,RP,0)),U,1)
"RTN","RMPRSE21",72,0)
 I $D(^RMPR(660,RP,10)) S RMPRIC9=$P(^RMPR(660,RP,10),U,8)
"RTN","RMPRSE21",73,0)
 I RMPRIC9'=""  D
"RTN","RMPRSE21",74,0)
 .S RMPRICD=$$ICDDX^ICDCODE(RMPRIC9,RMPRDAT)
"RTN","RMPRSE21",75,0)
 .S RMPRERR=$P(RMPRICD,U,1)
"RTN","RMPRSE21",76,0)
 .I RMPRERR<0 W !,"ICD-9 Message: ",$P(RMPRICD,U,2)
"RTN","RMPRSE21",77,0)
 W !,"ICD-9 Code: "
"RTN","RMPRSE21",78,0)
 I $G(RMPRICD)'="" W $P(RMPRICD,U,2),?19,$E($P(RMPRICD,U,4),1,55) I $P(RMPRICD,U,10)'>0 W " ","** Inactive ** Date: " S Y=$P(RMPRICD,U,12) D DD^%DT W Y
"RTN","RMPRSE21",79,0)
 W !
"RTN","RMPRSE21",80,0)
 ;
"RTN","RMPRSE21",81,0)
 ; END PATCH 92
"RTN","RMPRSE21",82,0)
 ;
"RTN","RMPRSE21",83,0)
 I $E(IOST)["C"&($Y>(IOSL-6)) S DIR(0)="E" D ^DIR S:Y<1 KILL=1 Q:Y<1  K DIR W @IOF D HEAD Q
"RTN","RMPRSE21",84,0)
 I $Y>(IOSL-6) W @IOF D HEAD
"RTN","RMPRSE21",85,0)
 Q
"RTN","RMPRSE21",86,0)
 ;
"RTN","RMPRSE21",87,0)
HEAD I $Y<2!(PAGE=1) D
"RTN","RMPRSE21",88,0)
 .W !,"PSAS HCPCS HISTORY:",?15
"RTN","RMPRSE21",89,0)
 .W $E($P(^RMPR(661.1,$P(^RMPR(660,RP,1),U,4),0),U,1),1,39)
"RTN","RMPRSE21",90,0)
 .W ?63,"STA ",RMPR("STA"),?72,"PAGE ",PAGE S PAGE=PAGE+1
"RTN","RMPRSE21",91,0)
 .W !!,"REQUEST DATE",?15,"PATIENT NAME",?30,"SSN",?36,"VENDOR"
"RTN","RMPRSE21",92,0)
 .S Y=RMPRBDT D DD^%DT W ?55,Y,"-" S Y=RMPREDT D DD^%DT W Y
"RTN","RMPRSE21",93,0)
 .W ! F BH=1:1:IOM W "="
"RTN","RMPRSE21",94,0)
 Q
"RTN","RMPRSE21",95,0)
 ;
"RTN","RMPRSE21",96,0)
REST D:'RMPRCOUN NONE Q:$D(KILL)!('RMPRCOUN)  W !,"TOTAL DOLLARS SPENT ON THIS HCPCS: ","$"_$J($FN(COSTT,"P",2),9),?45,"TOTAL QUANTITY ISSUED: ",$J(QTYT,4)
"RTN","RMPRSE21",97,0)
 I $O(RMPRARR(RQ)),$E(IOST)["C" W ! K DIR S DIR(0)="E" D ^DIR S:Y<1 KILL=1 W:'$D(KILL) @IOF
"RTN","RMPRSE21",98,0)
 I $E(IOST)'["C",$O(RMPRARR(RQ)) W @IOF
"RTN","RMPRSE21",99,0)
 S (COSTT,QTYT,RMPRCOUN)=""
"RTN","RMPRSE21",100,0)
 Q
"RTN","RMPRSE21",101,0)
 ;
"RTN","RMPRSE21",102,0)
NONE W @IOF,!!,"No '",$P(^RMPR(661.1,RMPRARR(RQ),0),U,1),"' PSAS HCPCS History for this date range.",!
"RTN","RMPRSE21",103,0)
 ;,$P(^PRC(441,$P(^RMPR(661,$P(RMPRARR(RQ),U),0),U),0),U,2)
"RTN","RMPRSE21",104,0)
 I $E(IOST)["C" K DIR S DIR(0)="E" W !!!! D ^DIR W @IOF S:Y<1 KILL=1 S ENDD=1
"RTN","RMPRSE21",105,0)
 Q
"RTN","RMPRSE21",106,0)
XREF ;set new x-ref for the field HCPCS in 660
"RTN","RMPRSE21",107,0)
 ;fix HCPCS VA117, REMOVE BLANK SPACE IN R90
"RTN","RMPRSE21",108,0)
 S $P(^RMPR(661.1,2801,0),U,6)="R90"
"RTN","RMPRSE21",109,0)
 W !!,"New Cross Reference for HCPCS..."
"RTN","RMPRSE21",110,0)
 S DIK="^RMPR(660,",DIK(1)="4.5^H" D ENALL^DIK
"RTN","RMPRSE21",111,0)
 W !!,"Done"
"RTN","RMPRSE21",112,0)
 Q
"RTN","RMPRSE21",113,0)
 ;END
"RTN","RMPRSEA")
0^9^B26605504
"RTN","RMPRSEA",1,0)
RMPRSEA ;PHX/RFM-SEARCH FILE 660 ENTRIES FOR RECALLED ITEM ;8/29/1994
"RTN","RMPRSEA",2,0)
 ;;3.0;PROSTHETICS;**77,90**;Feb 09, 1996
"RTN","RMPRSEA",3,0)
 ;RVD 3/17/03 patch #77 - allow queing to p-message.  IO to ION
"RTN","RMPRSEA",4,0)
 ;HNC 10/29/04 #90 - ITEM to BILLING ITEM
"RTN","RMPRSEA",5,0)
 D HOME^%ZIS,DIV4^RMPRSIT G:$D(X) EXIT S RMPRCOUN=0,RMPREND="" W !! S %DT("A")="Beginning Date: ",%DT="AEPX" D ^%DT S RMPRBDT=Y G:Y<0 EXIT
"RTN","RMPRSEA",6,0)
ENDATE S %DT("A")="Ending Date: ",%DT="AEX" D ^%DT G:Y<0 EXIT I RMPRBDT>Y W !,$C(7),"Invalid Date Range Selection!!" G ENDATE
"RTN","RMPRSEA",7,0)
 G:Y<0 EXIT S RMPREDT=Y,Y=RMPRBDT D DD^%DT S RMPRX=Y,Y=RMPREDT D DD^%DT S RMPRY=Y
"RTN","RMPRSEA",8,0)
 K DIR S DIR(0)="S^1:Search by Serial Number or Lot Number;2:Search by Billing Item;" D ^DIR G:$D(DIRUT) EXIT S GOTO=$S(Y=1:"SERIAL",Y=2:"ITEM") D @GOTO G:$D(DIRUT) EXIT1
"RTN","RMPRSEA",9,0)
 S %ZIS="MQ" K IOP D ^%ZIS G:POP EXIT
"RTN","RMPRSEA",10,0)
 I '$D(IO("Q")) U IO G PRINT
"RTN","RMPRSEA",11,0)
 S ZTDESC="SEARCH FOR RECALLED ITEM",ZTRTN="PRINT^RMPRSEA",ZTIO=ION,ZTSAVE("RMPRBDT")="",ZTSAVE("RMPREDT")="",ZTSAVE("RMPRSE")="",ZTSAVE("RMPRX")="",ZTSAVE("RMPRY")="",ZTSAVE("GOTO")="",ZTSAVE("RMPR(""STA"")")=""
"RTN","RMPRSEA",12,0)
 D ^%ZTLOAD W:$D(ZTSK) !,"REQUEST QUEUED!" H 1 G EXIT
"RTN","RMPRSEA",13,0)
PRINT S X1=RMPRBDT,X2=-1 D C^%DTC S RO=X,RP=0,PAGE=1,RMPRCOUN=0,RMPREND="" I $E(IOST)["C" D WAIT^DICD
"RTN","RMPRSEA",14,0)
PRI F J=0:0 S RO=$O(^RMPR(660,"B",RO)) Q:RO'>0!(RO>RMPREDT)  Q:RMPREND=1  F K=0:0 S RP=$O(^RMPR(660,"B",RO,RP)) Q:RP'>0  Q:RMPREND=1  D CK G:$D(DUOUT) EXIT
"RTN","RMPRSEA",15,0)
 I $D(RMPREDT),'POP,'RMPRCOUN W @IOF D HEAD W $C(7),!!,"NO SELECTIONS MADE DURING THIS DATE RANGE!!"
"RTN","RMPRSEA",16,0)
 I RMPRCOUN,$D(RMPREDT),RMPREND'=1 W !!?32,"END OF REPORT"
"RTN","RMPRSEA",17,0)
EXIT I IOST["C-"&($Y<22) F  W ! Q:$Y>20
"RTN","RMPRSEA",18,0)
 I $D(RMPREDT),IOST["C-",'$D(RMPRFLL),RMPREND'=1,'$D(DUOUT),'$D(DTOUT) K DIR S DIR(0)="E" D ^DIR
"RTN","RMPRSEA",19,0)
EXIT1 K GOTO,DIC,DIR,DIRUT,DTOUT,DUOUT,RMPREND,PAGE,RMPRFLL,RAUT,RPAT,LI,RO,RMPRCOUN,RMPRSE,RMPRBDT,RMPREDT,RMPRX,RMPRY,RP,Y,K,X,J D ^%ZISC
"RTN","RMPRSEA",20,0)
 Q
"RTN","RMPRSEA",21,0)
CK Q:'$D(^RMPR(660,RP,0))  Q:$P(^(0),U,4)="X"!('$P(^(0),U,6))  Q:'$D(^PRC(441,$P(^RMPR(661,+$P(^(0),U,6),0),U)))
"RTN","RMPRSEA",22,0)
 I GOTO["SERIAL",$P(^RMPR(660,RP,0),U,11)[RMPRSE!($P(^(0),U,24)[RMPRSE) D CON
"RTN","RMPRSEA",23,0)
 I GOTO["ITEM",RMPRSE=$P(^PRC(441,$P(^RMPR(661,$P(^RMPR(660,RP,0),U,6),0),U),0),U) D CON
"RTN","RMPRSEA",24,0)
 Q
"RTN","RMPRSEA",25,0)
CON I $Y>(IOSL-6),PAGE=1,'RMPRCOUN W @IOF
"RTN","RMPRSEA",26,0)
 D HEAD S RMPRCOUN=RMPRCOUN+1
"RTN","RMPRSEA",27,0)
 S Y=$P(^RMPR(660,RP,0),U,3) D DD^%DT W !,Y,?15,$E($P(^DPT($P(^RMPR(660,RP,0),U,2),0),U,1),1,13),?30,$E($P(^DPT($P(^RMPR(660,RP,0),U,2),0),U,9),6,9),?36,$E($P(^PRC(441,$P(^RMPR(661,$P(^RMPR(660,RP,0),U,6),0),U,1),0),U,2),1,17)
"RTN","RMPRSEA",28,0)
 W:$P(^RMPR(660,RP,0),U,9)'="" ?55,$E($P(^PRC(440,$P(^RMPR(660,RP,0),U,9),0),U,1),1,25)
"RTN","RMPRSEA",29,0)
 W !,"LOT NBR:",?10,$P(^RMPR(660,RP,0),U,24),?25,"SERIAL NBR:",?37,$P(^RMPR(660,RP,0),U,11),!
"RTN","RMPRSEA",30,0)
 I IOST["C-"&($Y>(IOSL-6)) S DUOUT=1,DIR(0)="E" D ^DIR S:Y="" RMPREND=1 Q:Y=""  S:Y<1 RMPRFLL=1 Q:Y<1  K DIR W @IOF D HEAD Q
"RTN","RMPRSEA",31,0)
 I $Y>(IOSL-6) W @IOF D HEAD
"RTN","RMPRSEA",32,0)
 Q
"RTN","RMPRSEA",33,0)
HEAD I $Y<2 W !,?10,"RECALLED ITEM REPORT" S Y=RMPRBDT D DD^%DT W ?39,Y_"-" S Y=RMPREDT D DD^%DT W Y_"  "_"STA ",$$STA^RMPRUTIL_"  "_"PAGE ",PAGE,!,"REQUEST DATE",?15,"PATIENT NAME",?30,"SSN",?36,"ITEM",?55,"VENDOR",! S PAGE=PAGE+1 Q
"RTN","RMPRSEA",34,0)
 Q
"RTN","RMPRSEA",35,0)
AUT ;AUTOMOTIVE EQUIPMENT SEARCH
"RTN","RMPRSEA",36,0)
 S RMPRCOUN=0,RMPREND="" W !! S %DT("A")="Beginning Date: ",%DT="AEPX" D ^%DT S RMPRBDT=Y G:Y<0 EXIT
"RTN","RMPRSEA",37,0)
 S %DT("A")="Ending Date: ",%DT="AEX" D ^%DT G:Y<0 EXIT I RMPRBDT>Y W !,$C(7),"Invalid Date Range Selection!!" G AUT
"RTN","RMPRSEA",38,0)
 G:Y<0 EXIT S RMPREDT=Y,Y=RMPREDT D DD^%DT S RMPRX=Y,Y=RMPREDT D DD^%DT S RMPRY=Y
"RTN","RMPRSEA",39,0)
 S DIR(0)="F^1:20^K:$E(X)="" "" X",DIR("A")="Enter Serial Number" D ^DIR G:$D(DIRUT) EXIT S RMPRSE=X K DIR
"RTN","RMPRSEA",40,0)
 S %ZIS="MQ" K IOP D ^%ZIS G:POP EXIT
"RTN","RMPRSEA",41,0)
 I '$D(IO("Q")) U IO G PRINTA
"RTN","RMPRSEA",42,0)
 K IO("Q") S ZTDESC="SEARCH FOR RECALLED AUTO ITEM",ZTRTN="PRINTA^RMPRSEA",ZTIO=ION,ZTSAVE("RMPRBDT")="",ZTSAVE("RMPREDT")="",ZTSAVE("RMPRSE")="",ZTSAVE("RMPRX")="",ZTSAVE("RMPRY")="" D ^%ZTLOAD G EXIT
"RTN","RMPRSEA",43,0)
PRINTA S X1=RMPRBDT,X2=-1 D C^%DTC S RO=X,RP=0,RMPRCOUN=0,PAGE=1,RMPREND="" D HDR
"RTN","RMPRSEA",44,0)
 F J=0:0 S RO=$O(^RMPR(667.3,"B",RO)) Q:RO'>0  Q:RO>RMPREDT  Q:RMPREND=1  F K=0:0 S RP=$O(^RMPR(667.3,"B",RO,RP)) Q:RP'>0  Q:RMPREND=1  D CK1 G:$D(DUOUT) EXIT
"RTN","RMPRSEA",45,0)
 I RMPRCOUN=0 W !!,"NO SELECTION MADE DURING THIS DATE RANGE!!"
"RTN","RMPRSEA",46,0)
 G EXIT
"RTN","RMPRSEA",47,0)
CK1 Q:'$D(^RMPR(667.3,RP,0))  G:$P(^RMPR(667.3,RP,0),U,6)[RMPRSE INF
"RTN","RMPRSEA",48,0)
 Q
"RTN","RMPRSEA",49,0)
INF S RMPRCOUN=RMPRCOUN+1,Y=$P(^RMPR(667.3,RP,0),U,1) S RAUT=^(0),RPAT=$P(^RMPR(667,$P(RAUT,U,2),0),U,2)
"RTN","RMPRSEA",50,0)
 D DD^%DT W !,Y,?15,$E($P(^DPT(RPAT,0),U,1),1,13),?30,$E($P(^DPT(RPAT,0),U,9),6,9),?36,$P(^RMPR(667.1,$P(RAUT,U,3),0),U,1)
"RTN","RMPRSEA",51,0)
 W !,"VEHICLE ID# ",$P(^RMPR(667,$P(RAUT,U,2),0),U,1),?50,"SERIAL # ",$P(RAUT,U,6) S $P(LI,"-",IOM)="" W !,LI
"RTN","RMPRSEA",52,0)
 I IOST?1"C-".E&($Y>(IOSL-4)) S DUOUT=1,DIR(0)="E" D ^DIR S:Y<1 RMPREND=1 Q:Y=""  S:Y<1 RMPRFLL=1 Q:Y<1  K DIR D HDR Q
"RTN","RMPRSEA",53,0)
 I $Y'>(IOSL-4) Q
"RTN","RMPRSEA",54,0)
HDR W @IOF,!,"REQUEST DATE",?15,"PATIENT NAME",?30,"SSN",?36,"ITEM",?70,"PAGE ",PAGE S $P(LI,"-",IOM)="",PAGE=PAGE+1 W !,LI
"RTN","RMPRSEA",55,0)
 Q
"RTN","RMPRSEA",56,0)
SERIAL S DIR(0)="F^1:20",DIR("A")="Enter Serial Number or Lot Number" D ^DIR Q:$D(DIRUT)  S RMPRSE=X K DIR
"RTN","RMPRSEA",57,0)
 Q
"RTN","RMPRSEA",58,0)
ITEM S DIC="^RMPR(661,",DIC(0)="AEQM",DIC("A")="Select BILLING ITEM: " D ^DIC I Y<0 S DIRUT=1 Q 
"RTN","RMPRSEA",59,0)
 S RMPRSE=$P(Y,U,2)
"RTN","RMPRSEA",60,0)
 Q
"RTN","RMPRSIT")
0^12^B5360286
"RTN","RMPRSIT",1,0)
RMPRSIT ;PHX/HNC-SET UP SITE PARAMETERS ;8/29/1994
"RTN","RMPRSIT",2,0)
 ;;3.0;PROSTHETICS;**46,90**;Feb 09, 1996
"RTN","RMPRSIT",3,0)
 ;modified to accomodate a NULL chief signature block
"RTN","RMPRSIT",4,0)
 I '$D(RMPRSITE) S X=" ",DIC=669.9,DIC(0)="ZM" D ^DIC S:+Y>0 RMPRSITE=+Y S:+Y'>0 RMPRSITE=$O(^RMPR(669.9,0)) Q:+RMPRSITE'>0  D INF Q
"RTN","RMPRSIT",5,0)
 I '$D(^RMPR(669.9,RMPRSITE)) S RMPRSITE=$O(^RMPR(669.9,0))
"RTN","RMPRSIT",6,0)
 D INF Q
"RTN","RMPRSIT",7,0)
DIV4 ;SET UP RMPR ARRAY FOR SINGLE AND MULT-DIVISIONAL SITES
"RTN","RMPRSIT",8,0)
 ;RMPR("STA") IS SET TO A VALUE THAT POINTS INTO THE ENTRY IN FILE 669.9
"RTN","RMPRSIT",9,0)
 ;VARIABLES REQUIRED: NOME
"RTN","RMPRSIT",10,0)
 ;Q:$G(RMPRSITE)>0
"RTN","RMPRSIT",11,0)
 S RMPRSITE=0 F RI=1:1 S RMPRSITE=$O(^RMPR(669.9,RMPRSITE)) Q:RMPRSITE'>0
"RTN","RMPRSIT",12,0)
 I RI=2 S RMPRSITE=0,RMPRSITE=$O(^RMPR(669.9,RMPRSITE)) S RMPR("STA")=$P(^RMPR(669.9,RMPRSITE,0),U,2)
"RTN","RMPRSIT",13,0)
 K DIC,Y S X=" ",DIC=669.9,DIC(0)="MZ" D ^DIC I +Y>0 S DIC("B")=Y(0,0)
"RTN","RMPRSIT",14,0)
 I RI>2 K RMPRSITE S DIC="^RMPR(669.9,",DIC(0)="AEQM",DIC("A")="SITE: ",DIC("W")="W ?50,$S($D(^DIC(4,$P(^(0),U,2),99)):$P(^(99),U),1:"""")" D ^DIC Q:+Y<0  S RMPRSITE=+Y
"RTN","RMPRSIT",15,0)
INF S RMPR("ADD")=$S($D(^RMPR(669.9,RMPRSITE,2)):$P(^RMPR(669.9,RMPRSITE,2),U,2),1:"")
"RTN","RMPRSIT",16,0)
 S RMPR("CITY")=$S($D(^RMPR(669.9,RMPRSITE,2)):$P(^RMPR(669.9,RMPRSITE,2),U,3)_", "_$S(+$P(^(2),U,4)>0:$P(^DIC(5,$P(^(2),U,4),0),U,2),1:""),1:"")
"RTN","RMPRSIT",17,0)
 I $D(^RMPR(669.9,RMPRSITE,2)) I $P(^RMPR(669.9,RMPRSITE,2),U,4)'>0 S RMPR("CITY")=$P(^DIC(4,$P(^RMPR(669.9,RMPRSITE,0),U,2),0),U,1)
"RTN","RMPRSIT",18,0)
 S RMPR("CITY")=RMPR("CITY")_"  "_$S($D(^RMPR(669.9,RMPRSITE,2)):$P(^RMPR(669.9,RMPRSITE,2),U,5),1:"")
"RTN","RMPRSIT",19,0)
 ;S RMPR("NAME")=$P(^RMPR(669.9,RMPRSITE,0),U,1) I $D(^RMPR(669.9,RMPRSITE,2)) S RMPR("SIG")=$P(^RMPR(669.9,RMPRSITE,2),U,6),RMPR("SBT")=$P(^(2),U,1)
"RTN","RMPRSIT",20,0)
 S RMPR("NAME")=$P(^RMPR(669.9,RMPRSITE,0),U,1)
"RTN","RMPRSIT",21,0)
 S RMPR("SIG")=$P($G(^RMPR(669.9,RMPRSITE,2)),U,6),RMPR("SBT")=$P($G(^(2)),U,1)
"RTN","RMPRSIT",22,0)
 S RMPR("STA")=$P(^RMPR(669.9,RMPRSITE,0),U,2)
"RTN","RMPRSIT",23,0)
 S RMPR("PHONE")=$P(^RMPR(669.9,RMPRSITE,0),U,4)
"RTN","RMPRSIT",24,0)
 S $P(RMPR("L"),"-",IOM)=""
"RTN","RMPRSIT",25,0)
 K X,Y,I,DIC,RI Q
"RTN","RMPRUTL4")
0^18^B1833508
"RTN","RMPRUTL4",1,0)
RMPRUTL4 ;HINES CIOFO/HNC - FIX RECORDS IN FILE 660 WITH NO AMIS GROUPER ;3/25/04  12:47
"RTN","RMPRUTL4",2,0)
 ;;3.0;PROSTHETICS;**34,35,87,90**;Feb 09, 1996
"RTN","RMPRUTL4",3,0)
 ;post init
"RTN","RMPRUTL4",4,0)
 I '$D(DUZ) W !,"DUZ NOT DEFINED!" Q
"RTN","RMPRUTL4",5,0)
 D DIV4^RMPRSIT,HOME^%ZIS G:$D(X) END
"RTN","RMPRUTL4",6,0)
 S RMPRA=0
"RTN","RMPRUTL4",7,0)
 F  S RMPRA=$O(^RMPR(660,RMPRA)) Q:RMPRA'>0  D
"RTN","RMPRUTL4",8,0)
 .Q:$G(^RMPR(660,RMPRA,"AMS"))'=""
"RTN","RMPRUTL4",9,0)
 .Q:$G(^RMPR(660,RMPRA,0))=""
"RTN","RMPRUTL4",10,0)
 .Q:$P(^RMPR(660,RMPRA,0),U,15)["*"
"RTN","RMPRUTL4",11,0)
 .Q:$P(^RMPR(660,RMPRA,0),U,10)'=RMPR("STA")
"RTN","RMPRUTL4",12,0)
 .W "."
"RTN","RMPRUTL4",13,0)
 .L +^RMPR(669.9,RMPRSITE,0):9999 I $T=0 S RMPRG=DT_98
"RTN","RMPRUTL4",14,0)
 .I '$G(RMPRG) S RMPRG=$P(^RMPR(669.9,RMPRSITE,0),U,7),RMPRG=RMPRG-1,$P(^RMPR(669.9,RMPRSITE,0),U,7)=RMPRG L -^RMPR(669.9,RMPRSITE,0)
"RTN","RMPRUTL4",15,0)
 .W RMPRG
"RTN","RMPRUTL4",16,0)
 .S $P(^RMPR(660,RMPRA,"AMS"),U,1)=RMPRG
"RTN","RMPRUTL4",17,0)
 .K RMPRG
"RTN","RMPRUTL4",18,0)
 W !,"ALL DONE"
"RTN","RMPRUTL4",19,0)
 K RMPRA,RMPR,RMPRSITE Q
"RTN","RMPRUTL4",20,0)
CHG ;change nppd line ; HCPCS
"RTN","RMPRUTL4",21,0)
 S $P(^RMPR(661.1,2757,0),U,6)="R90 A"
"RTN","RMPRUTL4",22,0)
 S $P(^RMPR(661.1,2757,0),U,7)=""
"RTN","RMPRUTL4",23,0)
 Q
"RTN","RMPRUTL4",24,0)
SERIAL ;enter product info for recall
"RTN","RMPRUTL4",25,0)
 D GETS^DIQ(660,DA,".02;4;4.5;7;11;23;24;27;89","E","RMPRX")
"RTN","RMPRUTL4",26,0)
 Q
"RTN","RMPRUTL4",27,0)
END ;END
"UP",664,664.02,-1)
664^1
"UP",664,664.02,0)
664.02
"VER")
8.0^22.0
"^DD",660,660,2,0)
TYPE OF TRANSACTION^RS^I:INITIAL ISSUE;R:REPLACE;S:SPARE;X:REPAIR;5:RENTAL;^0;4^Q
"^DD",660,660,2,.1)
LABEL
"^DD",660,660,2,3)
Please enter the appropriate code indicating the type of transaction.
"^DD",660,660,2,21,0)
^.001^3^3^3050503^^^^
"^DD",660,660,2,21,1,0)
This set of codes will tell what kind of transaction this request
"^DD",660,660,2,21,2,0)
is.  The possibilities all fall under the VAF 10-7306a listings
"^DD",660,660,2,21,3,0)
 except for the repair.
"^DD",660,660,2,"DT")
3050503
"^DD",660,660,38.1,0)
EXCLUDE/WAIVER^S^E:EXCLUDED;W:WAIVER;^2;3^Q
"^DD",660,660,38.1,21,0)
^^1^1^3041213^
"^DD",660,660,38.1,21,1,0)
This field determines if the item is EXCLUDED or Waver off of a National Contract
"^DD",660,660,38.1,"DT")
3050223
"^DD",660,660,38.7,0)
CONTRACT #^F^^2;9^K:$L(X)>30!($L(X)<1) X
"^DD",660,660,38.7,3)
Answer must be 1-30 characters in length.
"^DD",660,660,38.7,21,0)
^^1^1^3041228^
"^DD",660,660,38.7,21,1,0)
This field stores the Contract Number.
"^DD",660,660,38.7,"DT")
3041228
"^DD",660,660,38.8,0)
NUMBER OF BIDS^NJ3,0^^2;10^K:+X'=X!(X>999)!(X<0)!(X?.E1"."1N.N) X
"^DD",660,660,38.8,3)
Type a Number between 0 and 999, 0 Decimal Digits
"^DD",660,660,38.8,21,0)
^^1^1^3050420^
"^DD",660,660,38.8,21,1,0)
The number of bids recieved for a particular item.
"^DD",660,660,38.8,"DT")
3050420
"^DD",664,664,2,0)
BILLING ITEM^664.02PA^^1;0
"^DD",664,664,2,21,0)
^.001^1^1^3050623^^^^
"^DD",664,664,2,21,1,0)
This is the item that will be posted to the RECORD OF APPLIANCE/REPAIR file.
"^DD",664,664,2,"DT")
3041029
"^DD",664,664,21.1,0)
DELIVER TO ATTENTION^F^^3;4^K:$L(X)>45!($L(X)<1) X
"^DD",664,664,21.1,3)
Answer must be 1-45 characters in length.
"^DD",664,664,21.1,21,0)
^^1^1^3040427^
"^DD",664,664,21.1,21,1,0)
Attention to:  line for delivery 
"^DD",664,664,21.1,"DT")
3040427
"^DD",664,664.02,0)
BILLING ITEM SUB-FIELD^^19^24
"^DD",664,664.02,0,"NM","BILLING ITEM")

"^DD",664,664.02,.01,0)
BILLING ITEM^MRP661'XO^RMPR(661,^0;1^D EN1^RMPRCT
"^DD",664,664.02,.01,1,0)
^.1
"^DD",664,664.02,.01,1,1,0)
664.02^B
"^DD",664,664.02,.01,1,1,1)
S ^RMPR(664,DA(1),1,"B",$E(X,1,30),DA)=""
"^DD",664,664.02,.01,1,1,2)
K ^RMPR(664,DA(1),1,"B",$E(X,1,30),DA)
"^DD",664,664.02,.01,2)
S Y(0)=Y X ^DD(664.02,.01,2,9.2) S D0=$P(Y(101),U,1) S:'$D(^PRC(441,+D0,0)) D0=-1 S Y(201)=$S($D(^PRC(441,D0,0)):^(0),1:"") S X=$P(Y(201),U,2) S D0=I(0,0) S D1=I(1,0) S Y=X
"^DD",664,664.02,.01,2,9.2)
S I(1,0)=$S($D(D1):D1,1:""),I(0,0)=$S($D(D0):D0,1:""),D0=Y(0) S:'$D(^RMPR(661,+D0,0)) D0=-1 S I(100,0)=$S($D(D0):D0,1:""),Y(101)=$S($D(^RMPR(661,D0,0)):^(0),1:"")
"^DD",664,664.02,.01,2.1)
ITEM:NAME:SHORT DESCRIPTION
"^DD",664,664.02,.01,3)
Please Enter the Item.
"^DD",664,664.02,.01,21,0)
^^1^1^2930416^^^
"^DD",664,664.02,.01,21,1,0)
Pointer to the Prosthetics ITEM file #661
"^DD",664,664.02,.01,"DT")
3041029
"^DD",664,664.02,8,0)
TYPE OF TRANSACTION^RS^I:INITIAL ISSUE;R:REPLACE;S:SPARE;X:REPAIR;5:RENTAL;^0;9^Q
"^DD",664,664.02,8,3)
Enter the Type of Transaction for this issue.
"^DD",664,664.02,8,21,0)
^.001^1^1^3050503^^
"^DD",664,664.02,8,21,1,0)
This field is the Type of Transaction for the item issued.
"^DD",664,664.02,8,"DT")
3050503
"^DD",664,664.02,15.2,0)
MANUFACTURER^F^^2;1^K:$L(X)>30!($L(X)<1) X
"^DD",664,664.02,15.2,3)
Answer must be 1-30 characters in length.
"^DD",664,664.02,15.2,21,0)
^.001^1^1^3050623^^^
"^DD",664,664.02,15.2,21,1,0)
This is the name of the Manufacturer that supplied the item.
"^DD",664,664.02,15.2,"DT")
3041221
"^DD",664,664.02,15.4,0)
MODEL^F^^2;2^K:$L(X)>30!($L(X)<1) X
"^DD",664,664.02,15.4,3)
Answer must be 1-30 characters in length.
"^DD",664,664.02,15.4,21,0)
^^1^1^3050622^
"^DD",664,664.02,15.4,21,1,0)
The Model name or number of the item.
"^DD",664,664.02,15.4,"DT")
3041104
"^DD",664,664.02,15.6,0)
LOT #^F^^2;3^K:$L(X)>30!($L(X)<1) X
"^DD",664,664.02,15.6,3)
Answer must be 1-30 characters in length.
"^DD",664,664.02,15.6,21,0)
^^1^1^3050622^
"^DD",664,664.02,15.6,21,1,0)
The lot # of the item.
"^DD",664,664.02,15.6,"DT")
3041104
"^DD",664,664.02,18,0)
EXCLUDE/WAIVER^S^E:EXCLUDE;W:WAIVER;^2;4^Q
"^DD",664,664.02,18,21,0)
^.001^1^1^3050623^^
"^DD",664,664.02,18,21,1,0)
Set of codes field E for Exclude W for Waiver pertaining to contracts.
"^DD",664,664.02,18,"DT")
3050622
"^DD",664,664.02,19,0)
NUMBER OF BIDS^NJ3,0^^0;17^K:+X'=X!(X>999)!(X<0)!(X?.E1"."1N.N) X
"^DD",664,664.02,19,3)
Type a Number between 0 and 999, 0 Decimal Digits
"^DD",664,664.02,19,21,0)
^.001^1^1^3050623^^
"^DD",664,664.02,19,21,1,0)
The number of bids if any for an item. Some items the number of bids is mandatory.
"^DD",664,664.02,19,"DT")
3050413
"^DD",669.9,669.9,0)
FIELD^^74^47
"^DD",669.9,669.9,0,"DDA")
N
"^DD",669.9,669.9,0,"DT")
3041228
"^DD",669.9,669.9,0,"IX","ALTDY",669.965,2)

"^DD",669.9,669.9,0,"IX","B",669.9,.01)

"^DD",669.9,669.9,0,"IX","C",669.9,1)

"^DD",669.9,669.9,0,"IX","PA",669.9003,.01)

"^DD",669.9,669.9,0,"NM","PROSTHETICS SITE PARAMETERS")

"^DD",669.9,669.9,0,"PT",665,19.12)

"^DD",669.9,669.9,0,"PT",665.72,.01)

"^DD",669.9,669.9,0,"VRPK")
RMPR
"^DD",669.9,669.9,.01,0)
SITE NAME^RFX^^0;1^K:($L(X)<3)!($L(X)>50)!(X'?1U.E) X
"^DD",669.9,669.9,.01,1,0)
^.1
"^DD",669.9,669.9,.01,1,1,0)
669.9^B
"^DD",669.9,669.9,.01,1,1,1)
S ^RMPR(669.9,"B",$E(X,1,30),DA)=""
"^DD",669.9,669.9,.01,1,1,2)
K ^RMPR(669.9,"B",$E(X,1,30),DA)
"^DD",669.9,669.9,.01,3)
ANSWER MUST BE 3-50 CHARACTERS IN LENGTH AND BEGIN WITH A CAPITAL LETTER
"^DD",669.9,669.9,.01,21,0)
^^4^4^2920130^^^
"^DD",669.9,669.9,.01,21,1,0)
The site name can be either uppercase, or a combination of upper and lower.
"^DD",669.9,669.9,.01,21,2,0)
This is the name of your Medical Center, and should be entered the way
"^DD",669.9,669.9,.01,21,3,0)
you would like to have it print on your forms.  For example:
"^DD",669.9,669.9,.01,21,4,0)
Carl T. Hayden VAMC.
"^DD",669.9,669.9,.01,"DT")
2950803
"^DD",669.9,669.9,1,0)
STATION^P4'^DIC(4,^0;2^Q
"^DD",669.9,669.9,1,1,0)
^.1
"^DD",669.9,669.9,1,1,1,0)
669.9^C
"^DD",669.9,669.9,1,1,1,1)
S ^RMPR(669.9,"C",$E(X,1,30),DA)=""
"^DD",669.9,669.9,1,1,1,2)
K ^RMPR(669.9,"C",$E(X,1,30),DA)
"^DD",669.9,669.9,1,1,1,"%D",0)
^^1^1^2921103^
"^DD",669.9,669.9,1,1,1,"%D",1,0)
Lookup Site Name by Station Number.
"^DD",669.9,669.9,1,1,1,"DT")
2921103
"^DD",669.9,669.9,1,3)
Enter the Station Name or Station Number from the Institution File.
"^DD",669.9,669.9,1,21,0)
^^1^1^2950510^^^
"^DD",669.9,669.9,1,21,1,0)
This is your station number.
"^DD",669.9,669.9,1,"DT")
2921103
"^DD",669.9,669.9,1.1,0)
IFCAP SITE^FX^^4;1^K:$L(X)>6!($L(X)<3) X
"^DD",669.9,669.9,1.1,3)
Answer must be 3-6 characters in length.
"^DD",669.9,669.9,1.1,21,0)
^^1^1^2961216^
"^DD",669.9,669.9,1.1,21,1,0)
This field should contain the current IFCAP site location.
"^DD",669.9,669.9,1.1,"DT")
2961216
"^DD",669.9,669.9,2,0)
AUTOMATED INVENTORY (GIP)^RS^1:YES;0:NO;^0;3^Q
"^DD",669.9,669.9,2,21,0)
^^3^3^2910915^^
"^DD",669.9,669.9,2,21,1,0)
When you first install Prosthetics, this should be set to no.  When you
"^DD",669.9,669.9,2,21,2,0)
are ready to start using the inventory package, you should change this
"^DD",669.9,669.9,2,21,3,0)
to yes.
"^DD",669.9,669.9,2,"DT")
2910306
"^DD",669.9,669.9,3,0)
PHONE NUMBER^F^^0;4^K:$L(X)>24!($L(X)<3) X
"^DD",669.9,669.9,3,3)
Answer must be 3-24 characters in length.
"^DD",669.9,669.9,3,21,0)
^^4^4^2950911^^^^
"^DD",669.9,669.9,3,21,1,0)
This field stores the phone number of Prosthetics. This phone number will
"^DD",669.9,669.9,3,21,2,0)
print on all 2421 forms.
"^DD",669.9,669.9,3,21,3,0)
24 spaces are allotted for phone number which should allow for entry of both
"^DD",669.9,669.9,3,21,4,0)
area code and a four digit extension, if desired.
"^DD",669.9,669.9,3,"DT")
2950911
"^DD",669.9,669.9,4,0)
STREET ADD1^RF^^2;2^K:$L(X)>60!($L(X)<6) X
"^DD",669.9,669.9,4,3)
Answer with the street address for letterhead, and the address correspondence should be sent to.
"^DD",669.9,669.9,4,21,0)
^^2^2^2910915^^
"^DD",669.9,669.9,4,21,1,0)
This should be the street address of your Prosthetics Service, or the
"^DD",669.9,669.9,4,21,2,0)
address you would like printed on your forms.
"^DD",669.9,669.9,4,"DT")
2900515
"^DD",669.9,669.9,5,0)
CITY^RF^^2;3^K:$L(X)>15!($L(X)<3) X
"^DD",669.9,669.9,5,3)
Answer must be 3-15 characters in length.
"^DD",669.9,669.9,5,21,0)
^^2^2^2910915^^
"^DD",669.9,669.9,5,21,1,0)
This is the city to go with the STREET ADD1 field.  This is the city
"^DD",669.9,669.9,5,21,2,0)
of your Prosthetics Service.
"^DD",669.9,669.9,5,"DT")
2900515
"^DD",669.9,669.9,6,0)
STATE^RP5^DIC(5,^2;4^Q
"^DD",669.9,669.9,6,3)
Please enter the State where your Institution resides.
"^DD",669.9,669.9,6,21,0)
^^1^1^2930306^
"^DD",669.9,669.9,6,21,1,0)
Pointer to the State file #5.
"^DD",669.9,669.9,6,"DT")
2920128
"^DD",669.9,669.9,7,0)
ZIP CODE^RF^^2;5^K:$L(X)>10!($L(X)<5) X
"^DD",669.9,669.9,7,3)
Answer must be 5-10 characters in length.
"^DD",669.9,669.9,7,21,0)
^^1^1^2910726^
"^DD",669.9,669.9,7,21,1,0)
This is the zip code to go with the street address and city.
"^DD",669.9,669.9,7,"DT")
2900515
"^DD",669.9,669.9,7.1,0)
MANAGER COMMENT^F^^6;1^K:$L(X)>80!($L(X)<1) X
"^DD",669.9,669.9,7.1,3)
Answer must be 1-80 characters in length.
"^DD",669.9,669.9,7.1,21,0)
^^1^1^3041228^
"^DD",669.9,669.9,7.1,21,1,0)
This comment will display on GUI Purchasing Page.
"^DD",669.9,669.9,7.1,"DT")
3041228
"^DD",669.9,669.9,8,0)
CHIEF SIG BLOCK^RF^^2;6^K:$L(X)>55!($L(X)<5) X
"^DD",669.9,669.9,8,3)
Answer must be 5-55 characters in length.
"^DD",669.9,669.9,8,21,0)
^^1^1^2910726^
"^DD",669.9,669.9,8,21,1,0)
This is the name of the Fund Control Point Official that signs.
"^DD",669.9,669.9,8,"DT")
2900529
"^DD",669.9,669.9,8.1,0)
PURCHASING AGENT^669.9003PA^^5;0
"^DD",669.9,669.9,8.1,21,0)
^.001^1^1^3050623^^
"^DD",669.9,669.9,8.1,21,1,0)
This is a list of persons who are allowed to serve as purchasing agents for prosthetics.
"^DD",669.9,669.9,8.5,0)
SIGNATURE BLOCK TITLE^F^^2;1^K:$L(X)>55!($L(X)<5) X
"^DD",669.9,669.9,8.5,3)
Answer must be 5-55 characters in length.
"^DD",669.9,669.9,8.5,21,0)
^^2^2^2921230^
"^DD",669.9,669.9,8.5,21,1,0)
Signature Block Title is used to describe the Prosthetics Service as a
"^DD",669.9,669.9,8.5,21,2,0)
P&SAS or PTC.
"^DD",669.9,669.9,8.5,"DT")
2921230
"^DD",669.9,669.9,9,0)
PURCHASING DEVICE^P3.5'^%ZIS(1,^0;5^Q
"^DD",669.9,669.9,9,3)
Please Enter the Device Name that will be used for Printing Purchasing Forms for Prosthetics.
"^DD",669.9,669.9,9,21,0)
^^1^1^2910915^^
"^DD",669.9,669.9,9,21,1,0)
This is the device all VAF 10-2421s and 10-55's will be printed on.
"^DD",669.9,669.9,9,"DT")
2920805
"^DD",669.9,669.9,10,0)
COMMON NUMBERING SERIES^P442.6'^PRC(442.6,^4;2^Q
"^DD",669.9,669.9,10,21,0)
^^1^1^3050602^
"^DD",669.9,669.9,10,21,1,0)
This is the Numbering Series given by Fiscal so each PO # will be unique.
"^DD",669.9,669.9,10,"DT")
3041122
"^DD",669.9,669.9,11,0)
GROUPER COUNTER^NJ8,0I^^0;7^K:+X'=X!(X>99999999)!(X<1)!(X?.E1"."1N.N) X
"^DD",669.9,669.9,11,3)
Type a Number between 1 and 99999999, 0 Decimal Digits
"^DD",669.9,669.9,11,21,0)
^^3^3^2910915^^^^
"^DD",669.9,669.9,11,21,1,0)
GROUPER COUNTER is used in the calculation of AMIS reports
"^DD",669.9,669.9,11,21,2,0)
both in Purchasing and Issue from Stock Modules.  This field should
"^DD",669.9,669.9,11,21,3,0)
NEVER BE CHANGED!
"^DD",669.9,669.9,11,23,0)
^^3^3^2910915^^^
"^DD",669.9,669.9,11,23,1,0)
Counted backwards from 99999999 and placed in file 660 in the AMIS 
"^DD",669.9,669.9,11,23,2,0)
GROUPER field, to be used in AMIS calculations from Purchasing and
"^DD",669.9,669.9,11,23,3,0)
Issue from Stock.
"^DD",669.9,669.9,11,"DT")
2910211
"^DD",669.9,669.9,15,0)
ART LIMBS PSC AMOUNT^NJ6,2^^2;7^S:X["$" X=$P(X,"$",2) K:X'?.N.1".".2N!(X>999)!(X<2) X
"^DD",669.9,669.9,15,3)
Type a Dollar Amount between 2 and 999, 2 Decimal Digits
"^DD",669.9,669.9,15,21,0)
^^1^1^2910915^^
"^DD",669.9,669.9,15,21,1,0)
When a 10-2520 is issued, certain dollar limits are set for artifical limbs.
"^DD",669.9,669.9,15,"DT")
2900914
"^DD",669.9,669.9,16,0)
WHEELCHAIR PSC AMOUNT^NJ6,2^^2;8^S:X["$" X=$P(X,"$",2) K:X'?.N.1".".2N!(X>999)!(X<2) X
"^DD",669.9,669.9,16,3)
Type a Dollar Amount between 2 and 999, 2 Decimal Digits
"^DD",669.9,669.9,16,21,0)
^^1^1^2910915^^
"^DD",669.9,669.9,16,21,1,0)
When a 10-2520 is issued, certain dollar limits are set for wheelchairs.
"^DD",669.9,669.9,16,"DT")
2900914
"^DD",669.9,669.9,17,0)
BRACES PSC AMOUNT^NJ6,2^^2;9^S:X["$" X=$P(X,"$",2) K:X'?.N.1".".2N!(X>999)!(X<2) X
"^DD",669.9,669.9,17,3)
Type a Dollar Amount between 2 and 999, 2 Decimal Digits
"^DD",669.9,669.9,17,21,0)
^^1^1^2910915^^
"^DD",669.9,669.9,17,21,1,0)
When a 10-2520 is issued, certain dollar limits are set for braces.
"^DD",669.9,669.9,17,"DT")
2900914
"^DD",669.9,669.9,18,0)
BLIND AIDS PSC AMOUNT^NJ6,2^^2;10^S:X["$" X=$P(X,"$",2) K:X'?.N.1".".2N!(X>999)!(X<2) X
"^DD",669.9,669.9,18,3)
Type a Dollar Amount between 2 and 999, 2 Decimal Digits
"^DD",669.9,669.9,18,21,0)
^^1^1^2910915^^
"^DD",669.9,669.9,18,21,1,0)
When a 10-2520 is issued, certain dollar limits are set for blind aids.
"^DD",669.9,669.9,18,"DT")
2900914
"^DD",669.9,669.9,19,0)
SUSPENSE PURGE^RNJ3,0^^0;8^K:+X'=X!(X>730)!(X<90)!(X?.E1"."1N.N) X
"^DD",669.9,669.9,19,.1)
NUMBER OF DAYS TO RETAIN CLOSED SUSPENSE
"^DD",669.9,669.9,19,3)
Type a Number between 90 and 730, 0 Decimal Digits
"^DD",669.9,669.9,19,21,0)
^^2^2^2910717^^^^
"^DD",669.9,669.9,19,21,1,0)
This is the number of days for the suspense records to remain in the file
"^DD",669.9,669.9,19,21,2,0)
once they have been completed.
"^DD",669.9,669.9,19,"DT")
2910717
"^DD",669.9,669.9,20,0)
CLOSE-OUT PURCHASING PURGE^RNJ3,0^^0;9^K:+X'=X!(X>730)!(X<120)!(X?.E1"."1N.N) X
"^DD",669.9,669.9,20,.1)
NUMBER OF DAYS TO RETAIN CLOSED PURCHASING TRANSACTIONS
"^DD",669.9,669.9,20,3)
Type a Number between 120 and 730, 0 Decimal Digits
"^DD",669.9,669.9,20,21,0)
^^2^2^2950911^
"^DD",669.9,669.9,20,21,1,0)
This is the number of days to keep old transactions in the file.
"^DD",669.9,669.9,20,21,2,0)
It is recommended that this be set to 120 days. days.
"^DD",669.9,669.9,20,"DT")
2950911
"^DD",669.9,669.9,21,0)
CANCELLATION PURCHASING PURGE^RNJ3,0^^0;10^K:+X'=X!(X>730)!(X<120)!(X?.E1"."1N.N) X
"^DD",669.9,669.9,21,.1)
NUMBER OF DAYS TO RETAIN CANCELLED TRANSACTIONS
"^DD",669.9,669.9,21,3)
Type a Number between 120 and 730, 0 Decimal Digits
"^DD",669.9,669.9,21,21,0)
^^2^2^2950911^
"^DD",669.9,669.9,21,21,1,0)
This is the number of days to keep transactions that have been cancelled.
"^DD",669.9,669.9,21,21,2,0)
It is recommended that this be set to 120 days.
"^DD",669.9,669.9,21,"DT")
2950911
"^DD",669.9,669.9,22,0)
PROSTHETICS CLINIC^669.922PA^^1;0
"^DD",669.9,669.9,27,0)
ORTHOTIC LAB DEVICE^P3.5'^%ZIS(1,^DEV;2^Q
"^DD",669.9,669.9,27,3)
Enter the Name of the Device that will print the 2529-3 for the Orthotic Lab
"^DD",669.9,669.9,27,21,0)
^^3^3^2960122^
"^DD",669.9,669.9,27,21,1,0)
This is an optional entry.  If a device name is entered, it will be the
"^DD",669.9,669.9,27,21,2,0)
device the 2529-3s will print on for the Orthostics Lab.
"^DD",669.9,669.9,27,21,3,0)
If the field is left null the user will be prompted to enter a device.
"^DD",669.9,669.9,27,"DT")
2940816
"^DD",669.9,669.9,28,0)
RESTORATION CLINIC DEVICE^P3.5'^%ZIS(1,^DEV;3^Q
"^DD",669.9,669.9,28,3)
Enter the Name of the Device that will print the 2529-3 for the Restoration Clinic
"^DD",669.9,669.9,28,21,0)
^^3^3^2960122^^
"^DD",669.9,669.9,28,21,1,0)
Entry of a DEVICE is optional.  If a device name is entered, the device
"^DD",669.9,669.9,28,21,2,0)
will print 2529-3s for the Restoration Clinic.  If the field is null, the
"^DD",669.9,669.9,28,21,3,0)
users will be prompted to enter a device.
"^DD",669.9,669.9,28,"DT")
2940816
"^DD",669.9,669.9,29,0)
SHOE LAST CLINIC DEVICE^P3.5'^%ZIS(1,^DEV;4^Q
"^DD",669.9,669.9,29,3)
Enter the Name of the Device that will print the 2529-3 for the Shoe Last Clinic
"^DD",669.9,669.9,29,21,0)
^^2^2^2960122^
"^DD",669.9,669.9,29,21,1,0)
This is th e device that will print the 2529-3 for the Shoe Last Clinic.
"^DD",669.9,669.9,29,21,2,0)
If the field is null, the user will be prompted to enter the device.
"^DD",669.9,669.9,29,"DT")
2940830
"^DD",669.9,669.9,30,0)
WHEELCHAIR REPAIR SHOP DEVICE^P3.5'^%ZIS(1,^DEV;5^Q
"^DD",669.9,669.9,30,3)
Enter the Name of the Device that will print the 2529-3 for the WheelChair Repair Shop.
"^DD",669.9,669.9,30,21,0)
^^2^2^2960122^
"^DD",669.9,669.9,30,21,1,0)
This is the device that will print the 2529-3s for the Wheelchair Repair
"^DD",669.9,669.9,30,21,2,0)
Shop.  If this field is null, the user will be asked to enter the device.
"^DD",669.9,669.9,30,"DT")
2940830
"^DD",669.9,669.9,31,0)
LAB^S^1:YES;0:NO;^0;6^Q
"^DD",669.9,669.9,31,3)
Enter '1' if your are an Orthotic Lab, Restoration Clinic, WheelChair Repair Shop, Ect.
"^DD",669.9,669.9,31,21,0)
^^2^2^2980429^^^
"^DD",669.9,669.9,31,21,1,0)
This field turns on the lab module.  The Labs are on if ths field is set
"^DD",669.9,669.9,31,21,2,0)
to 'yes'.
"^DD",669.9,669.9,31,"DT")
2950725
"^DD",669.9,669.9,32,0)
ORTHOTICS LAB ACTIVATED?^S^1:YES;^0;11^Q
"^DD",669.9,669.9,32,3)
Enter 'Yes' or 'Y'  or 1 if the Orthotics Lab is activated at this station.
"^DD",669.9,669.9,32,21,0)
^^2^2^2960122^
"^DD",669.9,669.9,32,21,1,0)
This field will contain a 1 if the Orthotics Lab has been activated at
"^DD",669.9,669.9,32,21,2,0)
this station.
"^DD",669.9,669.9,32,"DT")
2950405
"^DD",669.9,669.9,33,0)
RESTORATION LAB ACTIVATED?^S^1:YES;^0;12^Q
"^DD",669.9,669.9,33,3)
Enter 'Yes' or 'Y' or '1' to indicate Shoe Last Clinic should be activated.
"^DD",669.9,669.9,33,21,0)
^^2^2^2960122^^
"^DD",669.9,669.9,33,21,1,0)
A '1' in this field indicates that Restoration Clinic has been activated
"^DD",669.9,669.9,33,21,2,0)
at this station.
"^DD",669.9,669.9,33,"DT")
2950406
"^DD",669.9,669.9,34,0)
ROUTING NUMBER^F^^0;13^K:$L(X)>7!($L(X)<1) X
"^DD",669.9,669.9,34,3)
Answer must be 1-7 characters in length
"^DD",669.9,669.9,34,21,0)
^^3^3^3010213^
"^DD",669.9,669.9,34,21,1,0)
This field is the mail routing symbol, which is printed on purchasing
"^DD",669.9,669.9,34,21,2,0)
forms.  The mail routing symbol '121' is being replaced by the value
"^DD",669.9,669.9,34,21,3,0)
entered in this field.
"^DD",669.9,669.9,34,"DT")
3010213
"^DD",669.9,669.9,35,0)
INVENTORY DEVICE^P3.5'^%ZIS(1,^INV;1^Q
"^DD",669.9,669.9,35,21,0)
^^2^2^2980904^
"^DD",669.9,669.9,35,21,1,0)
This is a device that will print a Notification letter for Items below the
"^DD",669.9,669.9,35,21,2,0)
re-order level.
"^DD",669.9,669.9,35,"DT")
2980904
"^DD",669.9,669.9,37,0)
NOTIFICATION DATE^D^^INV;3^S %DT="E" D ^%DT S X=Y K:Y<1 X
"^DD",669.9,669.9,37,21,0)
^^2^2^2980904^
"^DD",669.9,669.9,37,21,1,0)
This is the date that a taskman job runs for the Notification
"^DD",669.9,669.9,37,21,2,0)
letter.
"^DD",669.9,669.9,37,"DT")
2980904
"^DD",669.9,669.9,38,0)
HQ MAIL ADDRESS^F^^INV;4^K:$L(X)>45!($L(X)<12) X
"^DD",669.9,669.9,38,3)
Answer must be 12-45 characters in length.
"^DD",669.9,669.9,38,21,0)
^.001^1^1^3001011^^
"^DD",669.9,669.9,38,21,1,0)
This is an exchange address for HQ personnel who will receive the PIP reports.
"^DD",669.9,669.9,38,"DT")
3001011
"^DD",669.9,669.9,39,0)
HQ REPORT DATE^D^^INV;5^S %DT="E" D ^%DT S X=Y K:Y<1 X
"^DD",669.9,669.9,39,21,0)
^^1^1^3000804^
"^DD",669.9,669.9,39,21,1,0)
Date when PIP report was ran for HQ.
"^DD",669.9,669.9,39,"DT")
3000804
"^DD",669.9,669.9,40,0)
VISN^NJ2,0^^INV;2^K:+X'=X!(X>40)!(X<1)!(X?.E1"."1N.N) X
"^DD",669.9,669.9,40,3)
Type a Number between 1 and 40, 0 Decimal Digits
"^DD",669.9,669.9,40,21,0)
^^1^1^3001013^
"^DD",669.9,669.9,40,21,1,0)
This is the VISN where this station belong to.
"^DD",669.9,669.9,40,"DT")
3001013
"^DD",669.9,669.9,50,0)
PCE START DATE^D^^PCE;1^S %DT="ETR" D ^%DT S X=Y K:Y<1 X
"^DD",669.9,669.9,50,21,0)
^^1^1^3010716^
"^DD",669.9,669.9,50,21,1,0)
PCE START DATE is the starting date and time the background job runs.
"^DD",669.9,669.9,50,"DT")
3010716
"^DD",669.9,669.9,51,0)
PCE END DATE^D^^PCE;2^S %DT="ETR" D ^%DT S X=Y K:Y<1 X
"^DD",669.9,669.9,51,21,0)
^^2^2^3010716^
"^DD",669.9,669.9,51,21,1,0)
PCE END DATE  is the date and time the PCE background job finish to
"^DD",669.9,669.9,51,21,2,0)
completion.
"^DD",669.9,669.9,51,"DT")
3010716
"^DD",669.9,669.9,52,0)
PCE HOSPITAL LOCATION^P44'^SC(^PCE;3^Q
"^DD",669.9,669.9,52,21,0)
^.001^2^2^3011016^^
"^DD",669.9,669.9,52,21,1,0)
This is a pointer to Hopital Location file (#44), a clinic, where 
"^DD",669.9,669.9,52,21,2,0)
prosthetics outpatient encounter is scheduled.
"^DD",669.9,669.9,52,"DT")
3011015
"^DD",669.9,669.9,60,0)
HOME OXYGEN PRESCRIPTION^669.9001^^RMPORXN;0
"^DD",669.9,669.9,60,"DT")
2981214
"^DD",669.9,669.9,61,0)
HOME OXYGEN FUND CONTROL POINT^669.961^^RMPOFCP;0
"^DD",669.9,669.9,61,21,0)
^.001^1^1^3041122^^^
"^DD",669.9,669.9,61,21,1,0)
This field contains the fund control points used by home oxygen.
"^DD",669.9,669.9,61,"DT")
2981215
"^DD",669.9,669.9,62,0)
HOME OXYGEN VENDOR^669.962P^^RMPOVDR;0
"^DD",669.9,669.9,62,21,0)
^^2^2^2990318^
"^DD",669.9,669.9,62,21,1,0)
This field contains the vendors that supply devices and services for home
"^DD",669.9,669.9,62,21,2,0)
oxygen.
"^DD",669.9,669.9,62,"DT")
2981214
"^DD",669.9,669.9,65,0)
HOME OXYGEN LETTER^669.965P^^RMPOLET;0
"^DD",669.9,669.9,65,21,0)
^^2^2^2990318^
"^DD",669.9,669.9,65,21,1,0)
This field contains the letter types that are sent to patient receiving
"^DD",669.9,669.9,65,21,2,0)
home oxygen.
"^DD",669.9,669.9,70,0)
HO LETTER 1 LIST^669.9002P^^RMPOXBAT1;0
"^DD",669.9,669.9,70,21,0)
^^1^1^2990614^
"^DD",669.9,669.9,70,21,1,0)
List of all patients who get Home Oxygen letter 1.
"^DD",669.9,669.9,70,"DT")
2990614
"^DD",669.9,669.9,72,0)
HO LETTER 2 LIST^669.972P^^RMPOXBAT2;0
"^DD",669.9,669.9,72,21,0)
^^1^1^2990614^
"^DD",669.9,669.9,72,21,1,0)
List of all patients who get Home Oxygen letter 2.
"^DD",669.9,669.9,72,"DT")
2990614
"^DD",669.9,669.9,74,0)
HO LETTER 3 LIST^669.974P^^RMPOXBAT3;0
"^DD",669.9,669.9,74,21,0)
^^1^1^2990614^
"^DD",669.9,669.9,74,21,1,0)
List of all patient who get Home Oxygen letter 3.
"^DD",669.9,669.9,74,"DT")
2990614
"^DD",669.9,669.9001,0)
HOME OXYGEN PRESCRIPTION SUB-FIELD^^1^2
"^DD",669.9,669.9001,0,"DT")
2990701
"^DD",669.9,669.9001,0,"IX","B",669.9001,.01)

"^DD",669.9,669.9001,0,"NM","HOME OXYGEN PRESCRIPTION")

"^DD",669.9,669.9001,0,"UP")
669.9
"^DD",669.9,669.9001,.01,0)
PRESCRIPTION SEQUENCE NUMBER^MNJ3,0^^0;1^K:+X'=X!(X>999)!(X<1)!(X?.E1"."1N.N) X
"^DD",669.9,669.9001,.01,.1)

"^DD",669.9,669.9001,.01,1,0)
^.1
"^DD",669.9,669.9001,.01,1,1,0)
669.9001^B
"^DD",669.9,669.9001,.01,1,1,1)
S ^RMPR(669.9,DA(1),"RMPORXN","B",$E(X,1,30),DA)=""
"^DD",669.9,669.9001,.01,1,1,2)
K ^RMPR(669.9,DA(1),"RMPORXN","B",$E(X,1,30),DA)
"^DD",669.9,669.9001,.01,3)
Type a Number between 1 and 999, 0 Decimal Digits
"^DD",669.9,669.9001,.01,21,0)
^^5^5^2990701^^
"^DD",669.9,669.9001,.01,21,1,0)
Prescriptions arrive for each patient, either in regular intervals
"^DD",669.9,669.9001,.01,21,2,0)
or as amendments to the current prescription.  The PRESCRIPTION SEQUENCE 
"^DD",669.9,669.9001,.01,21,3,0)
NUMBER denotes the order in which they arrive.  Therefore, the
"^DD",669.9,669.9001,.01,21,4,0)
prescription number that is the highest usually is the one that expires
"^DD",669.9,669.9001,.01,21,5,0)
last.
"^DD",669.9,669.9001,.01,"DT")
2990701
"^DD",669.9,669.9001,1,0)
DEFAULT DAYS TO EXPIRATION^NJ3,0^^0;2^K:+X'=X!(X>999)!(X<0)!(X?.E1"."1N.N) X
"^DD",669.9,669.9001,1,3)
Type a Number between 0 and 999, 0 Decimal Digits
"^DD",669.9,669.9001,1,21,0)
^^7^7^2990317^
"^DD",669.9,669.9001,1,21,1,0)
Each prescription expires on a certain date (legally and by policy).
"^DD",669.9,669.9001,1,21,2,0)
Usually, the first prescription expires 6 months after it is written,
"^DD",669.9,669.9001,1,21,3,0)
the second prescription expires 6 months after it is written, and the
"^DD",669.9,669.9001,1,21,4,0)
third precription and all subsequent prescriptions expires one year after 
"^DD",669.9,669.9001,1,21,5,0)
they are written.  The value of this field is used to determine a default
"^DD",669.9,669.9001,1,21,6,0)
answer for the expiration date of a prescription when a new prescription
"^DD",669.9,669.9001,1,21,7,0)
record is created.
"^DD",669.9,669.9001,1,23,0)
^^4^4^2990317^^^
"^DD",669.9,669.9001,1,23,1,0)
When the user is prompted for an expiration date for a prescription,
"^DD",669.9,669.9001,1,23,2,0)
the system calculates this date by adding the value of this field to
"^DD",669.9,669.9001,1,23,3,0)
the ACTIVATION DATE of the prescription.  The result is used to prompt
"^DD",669.9,669.9001,1,23,4,0)
the user for a default date of expiration for prescriptions.
"^DD",669.9,669.9001,1,"DT")
2980512
"^DD",669.9,669.9002,0)
HO LETTER 1 LIST SUB-FIELD^^.01^1
"^DD",669.9,669.9002,0,"DT")
2990614
"^DD",669.9,669.9002,0,"IX","B",669.9002,.01)

"^DD",669.9,669.9002,0,"NM","HO LETTER 1 LIST")

"^DD",669.9,669.9002,0,"UP")
669.9
"^DD",669.9,669.9002,.01,0)
PATIENT^P665^RMPR(665,^0;1^Q
"^DD",669.9,669.9002,.01,1,0)
^.1
"^DD",669.9,669.9002,.01,1,1,0)
669.9002^B
"^DD",669.9,669.9002,.01,1,1,1)
S ^RMPR(669.9,DA(1),"RMPOXBAT1","B",$E(X,1,30),DA)=""
"^DD",669.9,669.9002,.01,1,1,2)
K ^RMPR(669.9,DA(1),"RMPOXBAT1","B",$E(X,1,30),DA)
"^DD",669.9,669.9002,.01,21,0)
^^1^1^2990614^^
"^DD",669.9,669.9002,.01,21,1,0)
This is the patient who gets Home Oxygen letter 1.
"^DD",669.9,669.9002,.01,"DT")
2990614
"^DD",669.9,669.9003,0)
PURCHASING AGENT SUB-FIELD^^2^3
"^DD",669.9,669.9003,0,"DT")
3031125
"^DD",669.9,669.9003,0,"IX","B",669.9003,.01)

"^DD",669.9,669.9003,0,"NM","PURCHASING AGENT")

"^DD",669.9,669.9003,0,"UP")
669.9
"^DD",669.9,669.9003,.01,0)
PURCHASING AGENT^P200'^VA(200,^0;1^Q
"^DD",669.9,669.9003,.01,1,0)
^.1
"^DD",669.9,669.9003,.01,1,1,0)
669.9003^B
"^DD",669.9,669.9003,.01,1,1,1)
S ^RMPR(669.9,DA(1),5,"B",$E(X,1,30),DA)=""
"^DD",669.9,669.9003,.01,1,1,2)
K ^RMPR(669.9,DA(1),5,"B",$E(X,1,30),DA)
"^DD",669.9,669.9003,.01,1,2,0)
669.9^PA^MUMPS
"^DD",669.9,669.9003,.01,1,2,1)
D EN1^RMPR9X
"^DD",669.9,669.9003,.01,1,2,2)
D KILL1^RMPR9X
"^DD",669.9,669.9003,.01,1,2,"DT")
3020918
"^DD",669.9,669.9003,.01,21,0)
^.001^1^1^3050623^^
"^DD",669.9,669.9003,.01,21,1,0)
This is a person who is allowed to serve as a purchasing agent for prosthetics.
"^DD",669.9,669.9003,.01,"DT")
3020918
"^DD",669.9,669.9003,1,0)
START RANGE^NJ2,0^^0;2^K:+X'=X!(X>99)!(X<0)!(X?.E1"."1N.N) X
"^DD",669.9,669.9003,1,3)
Type a Number between 0 and 99, 0 Decimal Digits
"^DD",669.9,669.9003,1,21,0)
^^1^1^3050602^
"^DD",669.9,669.9003,1,21,1,0)
The 2 digit number for the Purchasing Agents starting SSN range 00-99.
"^DD",669.9,669.9003,1,"DT")
3020828
"^DD",669.9,669.9003,2,0)
STOP RANGE^NJ2,0^^0;3^K:+X'=X!(X>99)!(X<0)!(X?.E1"."1N.N) X
"^DD",669.9,669.9003,2,3)
Type a Number between 0 and 99, 0 Decimal Digits
"^DD",669.9,669.9003,2,21,0)
^^1^1^3050602^
"^DD",669.9,669.9003,2,21,1,0)
The 2 digit number for the Purchasing Agents ending SSN range 00-99.
"^DD",669.9,669.9003,2,"DT")
3020828
"^DD",669.9,669.922,0)
PROSTHETICS CLINIC SUB-FIELD^^.01^1
"^DD",669.9,669.922,0,"IX","AC",669.922,.01)

"^DD",669.9,669.922,0,"IX","B",669.922,.01)

"^DD",669.9,669.922,0,"NM","PROSTHETICS CLINIC")

"^DD",669.9,669.922,0,"UP")
669.9
"^DD",669.9,669.922,.01,0)
PROSTHETICS CLINIC^M*P44'^SC(^0;1^S DIC("S")="I $P(^(0),U,3)[""C"" S ZT=$G(^(""I"")),ZV=1 S:$P(ZT,U,2>DT) ZV=0 S:$P(ZT,U)&($P(ZT,U)'>DT)&('$P(ZT,U,2)) ZV=0 I ZV=1" D ^DIC K DIC S DIC=DIE,X=+Y K:Y<0 X
"^DD",669.9,669.922,.01,1,0)
^.1
"^DD",669.9,669.922,.01,1,1,0)
669.922^B
"^DD",669.9,669.922,.01,1,1,1)
S ^RMPR(669.9,DA(1),1,"B",$E(X,1,30),DA)=""
"^DD",669.9,669.922,.01,1,1,2)
K ^RMPR(669.9,DA(1),1,"B",$E(X,1,30),DA)
"^DD",669.9,669.922,.01,1,2,0)
669.922^AC^MUMPS
"^DD",669.9,669.922,.01,1,2,1)
I $D(^RMPR(669.9,DA(1),0)) S ZST=$P(^(0),U,2) S:ZST ^RMPR(669.9,"AC",X,ZST,DA(1),DA)="" K ZST
"^DD",669.9,669.922,.01,1,2,2)
I $D(^RMPR(669.9,DA(1),0)) S ZST=$P(^(0),U,2) K:ZST ^RMPR(669.9,"AC",X,ZST,DA(1),DA) K ZST
"^DD",669.9,669.922,.01,1,2,"%D",0)
^^2^2^2930519^^^^
"^DD",669.9,669.922,.01,1,2,"%D",1,0)
This x-ref is used by the RMPRSC routine to check if the MAS appointment 
"^DD",669.9,669.922,.01,1,2,"%D",2,0)
being entered or changed is for a Prosthetics Clinic.
"^DD",669.9,669.922,.01,1,2,"DT")
2930315
"^DD",669.9,669.922,.01,3)
Enter the name of the Prosthetics Scheduled Clinics
"^DD",669.9,669.922,.01,12)
Entry must be an active clinic
"^DD",669.9,669.922,.01,12.1)
S DIC("S")="I $P(^(0),U,3)[""C"" S ZT=$G(^(""I"")),ZV=1 S:$P(ZT,U,2>DT) ZV=0 S:$P(ZT,U)&($P(ZT,U)'>DT)&('$P(ZT,U,2)) ZV=0 I ZV=1"
"^DD",669.9,669.922,.01,"DT")
2940112
"^DD",669.9,669.961,0)
HOME OXYGEN FUND CONTROL POINT SUB-FIELD^^2^3
"^DD",669.9,669.961,0,"DT")
3031027
"^DD",669.9,669.961,0,"IX","B",669.961,.01)

"^DD",669.9,669.961,0,"NM","HOME OXYGEN FUND CONTROL POINT")

"^DD",669.9,669.961,0,"UP")
669.9
"^DD",669.9,669.961,.01,0)
FUND CONTROL POINT^MFX^^0;1^D FCPIX^RMPOPED
"^DD",669.9,669.961,.01,1,0)
^.1
"^DD",669.9,669.961,.01,1,1,0)
669.961^B
"^DD",669.9,669.961,.01,1,1,1)
S ^RMPR(669.9,DA(1),"RMPOFCP","B",$E(X,1,30),DA)=""
"^DD",669.9,669.961,.01,1,1,2)
K ^RMPR(669.9,DA(1),"RMPOFCP","B",$E(X,1,30),DA)
"^DD",669.9,669.961,.01,3)
Enter a Fund Control Point
"^DD",669.9,669.961,.01,4)

"^DD",669.9,669.961,.01,21,0)
^^1^1^2990701^^^
"^DD",669.9,669.961,.01,21,1,0)
This is a Fund Control Point used for home oxygen.
"^DD",669.9,669.961,.01,"DT")
2990217
"^DD",669.9,669.961,1,0)
PSAS?^S^Y:YES, PSAS FCP;N:NO, OTHER FCP;^0;2^Q
"^DD",669.9,669.961,1,3)
Enter 'Y' if this is a PSAS FCP.
"^DD",669.9,669.961,1,21,0)
^^2^2^2990318^^
"^DD",669.9,669.961,1,21,1,0)
If this is a PSAS Fund Control Point, then enter 'Y'.  If this isn't a
"^DD",669.9,669.961,1,21,2,0)
PSAS Fund Control Point, then enter 'N'.
"^DD",669.9,669.961,1,"DT")
2981214
"^DD",669.9,669.961,2,0)
PURCHASE CARD NUMBER^F^^0;3^K:$L(X)>16!($L(X)<16) X
"^DD",669.9,669.961,2,3)
Answer must be 16 characters in length.
"^DD",669.9,669.961,2,"DT")
3020212
"^DD",669.9,669.962,0)
HOME OXYGEN VENDOR SUB-FIELD^^.01^1
"^DD",669.9,669.962,0,"DT")
2981214
"^DD",669.9,669.962,0,"IX","B",669.962,.01)

"^DD",669.9,669.962,0,"NM","HOME OXYGEN VENDOR")

"^DD",669.9,669.962,0,"UP")
669.9
"^DD",669.9,669.962,.01,0)
HOME OXYGEN VENDORS^MP440'X^PRC(440,^0;1^S DINUM=X
"^DD",669.9,669.962,.01,1,0)
^.1
"^DD",669.9,669.962,.01,1,1,0)
669.962^B
"^DD",669.9,669.962,.01,1,1,1)
S ^RMPR(669.9,DA(1),"RMPOVDR","B",$E(X,1,30),DA)=""
"^DD",669.9,669.962,.01,1,1,2)
K ^RMPR(669.9,DA(1),"RMPOVDR","B",$E(X,1,30),DA)
"^DD",669.9,669.962,.01,3)
Enter a vendor that provides home oxygen.
"^DD",669.9,669.962,.01,21,0)
^^1^1^2990318^
"^DD",669.9,669.962,.01,21,1,0)
This is a vendor that provides home oxygen devices and services.
"^DD",669.9,669.962,.01,"DT")
2981214
"^DD",669.9,669.965,0)
HOME OXYGEN LETTER SUB-FIELD^^4^5
"^DD",669.9,669.965,0,"DT")
2990616
"^DD",669.9,669.965,0,"IX","B",669.965,.01)

"^DD",669.9,669.965,0,"NM","HOME OXYGEN LETTER")

"^DD",669.9,669.965,0,"UP")
669.9
"^DD",669.9,669.965,.01,0)
HOME OXYGEN LETTER^MP665.2^RMPR(665.2,^0;1^Q
"^DD",669.9,669.965,.01,1,0)
^.1
"^DD",669.9,669.965,.01,1,1,0)
669.965^B
"^DD",669.9,669.965,.01,1,1,1)
S ^RMPR(669.9,DA(1),"RMPOLET","B",$E(X,1,30),DA)=""
"^DD",669.9,669.965,.01,1,1,2)
K ^RMPR(669.9,DA(1),"RMPOLET","B",$E(X,1,30),DA)
"^DD",669.9,669.965,.01,3)
Select a home oxygen letter.
"^DD",669.9,669.965,.01,21,0)
^^4^4^2990318^
"^DD",669.9,669.965,.01,21,1,0)
This is the name of a letter that will be sent to a patient to welcome
"^DD",669.9,669.965,.01,21,2,0)
that patient to the home oxygen program, remind the patient to renew the
"^DD",669.9,669.965,.01,21,3,0)
prescription, or to tell the patient that s/he is no longer in the home
"^DD",669.9,669.965,.01,21,4,0)
oxygen program.
"^DD",669.9,669.965,.01,"DT")
2980512
"^DD",669.9,669.965,1,0)
LETTER CODE^S^A:LETTER 1;B:LETTER 2;C:LETTER 3;^0;2^Q
"^DD",669.9,669.965,1,1,0)
^.1^^0
"^DD",669.9,669.965,1,3)
Select the code for the letter.
"^DD",669.9,669.965,1,21,0)
^^3^3^2990616^^
"^DD",669.9,669.965,1,21,1,0)
Each letter has a letter code for quick reference, instead of its
"^DD",669.9,669.965,1,21,2,0)
potentially very long name.  This is the code that summarizes what the
"^DD",669.9,669.965,1,21,3,0)
letter will be used for.
"^DD",669.9,669.965,1,"DT")
2990616
"^DD",669.9,669.965,2,0)
DAYS TO PRESCRIPTION EXPIRY^NJ3,0^^0;3^K:+X'=X!(X>999)!(X<0)!(X?.E1"."1N.N) X
"^DD",669.9,669.965,2,1,0)
^.1
"^DD",669.9,669.965,2,1,1,0)
669.9^ALTDY
"^DD",669.9,669.965,2,1,1,1)
S ^RMPR(669.9,"ALTDY",$E(X,1,30),DA(1),DA)=""
"^DD",669.9,669.965,2,1,1,2)
K ^RMPR(669.9,"ALTDY",$E(X,1,30),DA(1),DA)
"^DD",669.9,669.965,2,1,1,"DT")
2981115
"^DD",669.9,669.965,2,3)
Type a Number between 0 and 999, 0 Decimal Digits
"^DD",669.9,669.965,2,21,0)
^^4^4^2990318^
"^DD",669.9,669.965,2,21,1,0)
The letter for pending prescription expiry is produced when there are at
"^DD",669.9,669.965,2,21,2,0)
most this number of days until the prescription expires. If this is a
"^DD",669.9,669.965,2,21,3,0)
welcome letter, enter '0' so the letter will be generated the day the
"^DD",669.9,669.965,2,21,4,0)
patient is activated.
"^DD",669.9,669.965,2,"DT")
2981115
"^DD",669.9,669.965,3,0)
AUTOGENERATE LETTER^RS^1:YES;0:NO;^0;4^Q
"^DD",669.9,669.965,3,3)
Enter "Y" to autogenerate letter.
"^DD",669.9,669.965,3,21,0)
^^3^3^2990318^
"^DD",669.9,669.965,3,21,1,0)
If you want the patient to appear on a list of patients who are due to
"^DD",669.9,669.965,3,21,2,0)
receive letters, enter 1 for YES at this prompt.  If not, enter 0 for NO.
"^DD",669.9,669.965,3,21,3,0)
If YES, the letter is autogenerated and ready fo be printed.
"^DD",669.9,669.965,3,"DT")
2981202
"^DD",669.9,669.965,4,0)
PRINT LETTER HEADER^RS^1:YES;0:NO;^0;5^Q
"^DD",669.9,669.965,4,3)
Enter "Y" to include letter header.
"^DD",669.9,669.965,4,21,0)
^^3^3^2990318^
"^DD",669.9,669.965,4,21,1,0)
If you print your letters to paper that contains a letterhead, then enter
"^DD",669.9,669.965,4,21,2,0)
0 for NO at this prompt.  If you want the program to print the header
"^DD",669.9,669.965,4,21,3,0)
information, enter 1 for YES at this prompt.
"^DD",669.9,669.965,4,"DT")
2981202
"^DD",669.9,669.972,0)
HO LETTER 2 LIST SUB-FIELD^^.01^1
"^DD",669.9,669.972,0,"DT")
2990614
"^DD",669.9,669.972,0,"IX","B",669.972,.01)

"^DD",669.9,669.972,0,"NM","HO LETTER 2 LIST")

"^DD",669.9,669.972,0,"UP")
669.9
"^DD",669.9,669.972,.01,0)
PATIENT^P665'^RMPR(665,^0;1^Q
"^DD",669.9,669.972,.01,1,0)
^.1
"^DD",669.9,669.972,.01,1,1,0)
669.972^B
"^DD",669.9,669.972,.01,1,1,1)
S ^RMPR(669.9,DA(1),"RMPOXBAT2","B",$E(X,1,30),DA)=""
"^DD",669.9,669.972,.01,1,1,2)
K ^RMPR(669.9,DA(1),"RMPOXBAT2","B",$E(X,1,30),DA)
"^DD",669.9,669.972,.01,21,0)
^^1^1^2990614^
"^DD",669.9,669.972,.01,21,1,0)
This is the patient who gets Home Oxygen letter 2.
"^DD",669.9,669.972,.01,"DT")
2990614
"^DD",669.9,669.974,0)
HO LETTER 3 LIST SUB-FIELD^^.01^1
"^DD",669.9,669.974,0,"DT")
2990614
"^DD",669.9,669.974,0,"IX","B",669.974,.01)

"^DD",669.9,669.974,0,"NM","HO LETTER 3 LIST")

"^DD",669.9,669.974,0,"UP")
669.9
"^DD",669.9,669.974,.01,0)
PATIENT^RP665'^RMPR(665,^0;1^Q
"^DD",669.9,669.974,.01,1,0)
^.1
"^DD",669.9,669.974,.01,1,1,0)
669.974^B
"^DD",669.9,669.974,.01,1,1,1)
S ^RMPR(669.9,DA(1),"RMPOXBAT3","B",$E(X,1,30),DA)=""
"^DD",669.9,669.974,.01,1,1,2)
K ^RMPR(669.9,DA(1),"RMPOXBAT3","B",$E(X,1,30),DA)
"^DD",669.9,669.974,.01,21,0)
^^1^1^2990614^^
"^DD",669.9,669.974,.01,21,1,0)
This is the patient who gets Home Oxygen letter 2.
"^DD",669.9,669.974,.01,"DT")
2990614
"^DIC",669.9,669.9,0)
PROSTHETICS SITE PARAMETERS^669.9
"^DIC",669.9,669.9,0,"GL")
^RMPR(669.9,
"^DIC",669.9,669.9,"%D",0)
^^11^11^2950803^
"^DIC",669.9,669.9,"%D",1,0)
This file holds the list of parameters which can change the operation
"^DIC",669.9,669.9,"%D",2,0)
of the prosthetics package at a site.  
"^DIC",669.9,669.9,"%D",3,0)
It should be noted that these parameters are generally copied into a
"^DIC",669.9,669.9,"%D",4,0)
local variable when entering the prosthetics program.  This means that,
"^DIC",669.9,669.9,"%D",5,0)
in general, a change to this file will not take effect until the users
"^DIC",669.9,669.9,"%D",6,0)
currently using the package leave the prosthetics system and come back
"^DIC",669.9,669.9,"%D",7,0)
into it again.
"^DIC",669.9,669.9,"%D",8,0)
This file may have one or more entries.  During the installation process,
"^DIC",669.9,669.9,"%D",9,0)
some of the parameters for the first site may be set for you.
"^DIC",669.9,669.9,"%D",10,0)
Never edit or delete the AMIS GROUPER field.
"^DIC",669.9,669.9,"%D",11,0)
Never delete an entry in this file, only edit it.
"^DIC",669.9,"B","PROSTHETICS SITE PARAMETERS",669.9)

"BLD",5535,6)
^SEQ #88
**END**
**END**
