Released SD*5.3*414 SEQ #336
Extracted from mail message
**KIDS**:SD*5.3*414^

**INSTALL NAME**
SD*5.3*414
"BLD",5991,0)
SD*5.3*414^SCHEDULING^0^3050302^y
"BLD",5991,1,0)
^^2^2^3050124^
"BLD",5991,1,1,0)
APPT W/L OVERDUE REPORT
"BLD",5991,1,2,0)
EWL QUESTIONS
"BLD",5991,4,0)
^9.64PA^^
"BLD",5991,"ABPKG")
n
"BLD",5991,"KRN",0)
^9.67PA^8989.52^19
"BLD",5991,"KRN",.4,0)
.4
"BLD",5991,"KRN",.401,0)
.401
"BLD",5991,"KRN",.402,0)
.402
"BLD",5991,"KRN",.403,0)
.403
"BLD",5991,"KRN",.5,0)
.5
"BLD",5991,"KRN",.84,0)
.84
"BLD",5991,"KRN",3.6,0)
3.6
"BLD",5991,"KRN",3.8,0)
3.8
"BLD",5991,"KRN",9.2,0)
9.2
"BLD",5991,"KRN",9.8,0)
9.8
"BLD",5991,"KRN",9.8,"NM",0)
^9.68A^4^4
"BLD",5991,"KRN",9.8,"NM",1,0)
SDAMC^^0^B12291677
"BLD",5991,"KRN",9.8,"NM",2,0)
SDWLROF^^0^B30475987
"BLD",5991,"KRN",9.8,"NM",3,0)
SDWLROS^^0^B33019881
"BLD",5991,"KRN",9.8,"NM",4,0)
SDWLQOF^^0^B25890160
"BLD",5991,"KRN",9.8,"NM","B","SDAMC",1)

"BLD",5991,"KRN",9.8,"NM","B","SDWLQOF",4)

"BLD",5991,"KRN",9.8,"NM","B","SDWLROF",2)

"BLD",5991,"KRN",9.8,"NM","B","SDWLROS",3)

"BLD",5991,"KRN",19,0)
19
"BLD",5991,"KRN",19.1,0)
19.1
"BLD",5991,"KRN",101,0)
101
"BLD",5991,"KRN",409.61,0)
409.61
"BLD",5991,"KRN",771,0)
771
"BLD",5991,"KRN",870,0)
870
"BLD",5991,"KRN",8989.51,0)
8989.51
"BLD",5991,"KRN",8989.52,0)
8989.52
"BLD",5991,"KRN",8994,0)
8994
"BLD",5991,"KRN","B",.4,.4)

"BLD",5991,"KRN","B",.401,.401)

"BLD",5991,"KRN","B",.402,.402)

"BLD",5991,"KRN","B",.403,.403)

"BLD",5991,"KRN","B",.5,.5)

"BLD",5991,"KRN","B",.84,.84)

"BLD",5991,"KRN","B",3.6,3.6)

"BLD",5991,"KRN","B",3.8,3.8)

"BLD",5991,"KRN","B",9.2,9.2)

"BLD",5991,"KRN","B",9.8,9.8)

"BLD",5991,"KRN","B",19,19)

"BLD",5991,"KRN","B",19.1,19.1)

"BLD",5991,"KRN","B",101,101)

"BLD",5991,"KRN","B",409.61,409.61)

"BLD",5991,"KRN","B",771,771)

"BLD",5991,"KRN","B",870,870)

"BLD",5991,"KRN","B",8989.51,8989.51)

"BLD",5991,"KRN","B",8989.52,8989.52)

"BLD",5991,"KRN","B",8994,8994)

"BLD",5991,"QUES",0)
^9.62^^
"BLD",5991,"REQB",0)
^9.611^1^1
"BLD",5991,"REQB",1,0)
SD*5.3*263^1
"BLD",5991,"REQB","B","SD*5.3*263",1)

"MBREQ")
0
"PKG",16,-1)
1^1
"PKG",16,0)
SCHEDULING^SD^APPOINTMENTS,PROFILES,LETTERS,AMIS REPORTS
"PKG",16,20,0)
^9.402P^^
"PKG",16,22,0)
^9.49I^1^1
"PKG",16,22,1,0)
5.3^2930813
"PKG",16,22,1,"PAH",1,0)
414^3050302
"PKG",16,22,1,"PAH",1,1,0)
^^2^2^3050302
"PKG",16,22,1,"PAH",1,1,1,0)
APPT W/L OVERDUE REPORT
"PKG",16,22,1,"PAH",1,1,2,0)
EWL QUESTIONS
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
4
"RTN","SDAMC")
0^1^B12291677
"RTN","SDAMC",1,0)
SDAMC ;ALB/MJK - Cancel Appt Action ; 2/4/92
"RTN","SDAMC",2,0)
 ;;5.3;Scheduling;**20,28,32,46,263,414**;Aug 13, 1993
"RTN","SDAMC",3,0)
 ;
"RTN","SDAMC",4,0)
EN ; -- protocol SDAM APPT CANCEL entry pt
"RTN","SDAMC",5,0)
 ; input:  VALMY := array entries
"RTN","SDAMC",6,0)
 ;
"RTN","SDAMC",7,0)
 N SDI,SDAT,VALMY,SDAMCIDT,CNT,L,SDWH,SDCP,SDREM,SDSCR,SDMSG,SCLHOLD
"RTN","SDAMC",8,0)
 K ^UTILITY($J)
"RTN","SDAMC",9,0)
 ;
"RTN","SDAMC",10,0)
 ;
"RTN","SDAMC",11,0)
 I '$D(DFN),$G(SDFN),($G(SDAMTYP)="P") S DFN=SDFN
"RTN","SDAMC",12,0)
 ;
"RTN","SDAMC",13,0)
 S VALMBCK=""
"RTN","SDAMC",14,0)
 D SEL^VALM2,CHK G ENQ:'$O(VALMY(0))
"RTN","SDAMC",15,0)
 D FULL^VALM1 S VALMBCK="R"
"RTN","SDAMC",16,0)
 S SDWH=$$WHO,SDCP=$S(SDWH="C":0,1:1) G ENQ:SDWH=-1
"RTN","SDAMC",17,0)
 S SDSCR=$$RSN(SDWH) G ENQ:SDSCR=-1
"RTN","SDAMC",18,0)
 S SDREM=$$REM G ENQ:SDREM=-1
"RTN","SDAMC",19,0)
 S (SDI,CNT,L)=0
"RTN","SDAMC",20,0)
 F  S SDI=$O(VALMY(SDI)) Q:'SDI  I $D(^TMP("SDAMIDX",$J,SDI)) K SDAT S SDAT=^(SDI) W !,^TMP("SDAM",$J,+SDAT,0) D CAN($P(SDAT,U,2),$P(SDAT,U,3),.CNT,.L,SDWH,SDCP,SDSCR,SDREM)
"RTN","SDAMC",21,0)
 I SDAMTYP="P" D BLD^SDAM1
"RTN","SDAMC",22,0)
 I SDAMTYP="C" D BLD^SDAM3
"RTN","SDAMC",23,0)
ENQ Q
"RTN","SDAMC",24,0)
 ;
"RTN","SDAMC",25,0)
CAN(DFN,SDT,CNT,L,SDWH,SDCP,SDSCR,SDREM) ;
"RTN","SDAMC",26,0)
 N A1,NDT S NDT=SDT
"RTN","SDAMC",27,0)
 I $P($G(^DPT(DFN,"S",NDT,0)),U,2)["C" W !!,"Appointment already cancelled" H 2 G CANQ
"RTN","SDAMC",28,0)
 I $D(^DPT(DFN,"S",NDT,0)) S SD0=^(0) I $P(SD0,"^",2)'["C" S SC=+SD0,L=L\1+1,APL="" D FLEN^SDCNP1A S ^UTILITY($J,"SDCNP",L)=NDT_"^"_SC_"^"_COV_"^"_APL_"^^"_APL D CHKSO^SDCNP0
"RTN","SDAMC",29,0)
 ;SD*5.3*414 next line added to set hold variable SCLHOLD for clinic ptr
"RTN","SDAMC",30,0)
 S APP=1,A1=L\1 S SCLHOLD=$P(^UTILITY($J,"SDCNP",A1),U,2) D BEGD^SDCNP0
"RTN","SDAMC",31,0)
 D MES,NOPE W ! S (CNT,L)=0 K ^UTILITY($J,"SDCNP")
"RTN","SDAMC",32,0)
CANQ ;
"RTN","SDAMC",33,0)
 ;Wait List Message
"RTN","SDAMC",34,0)
 ;
"RTN","SDAMC",35,0)
 S:'$D(SDCLN) SDCLN=SCLHOLD  ; SD*5.3*414
"RTN","SDAMC",36,0)
 I $D(SDCLN),$D(^SDWL(409.3,"SC",SDCLN)) D
"RTN","SDAMC",37,0)
 .W !,?1,"There are Patients on the Wait List waiting for an Appointment in the",!?1,$P(^SC(SDCLN,0),U,1)," Clinic.",!
"RTN","SDAMC",38,0)
 S DIR(0)="E" D ^DIR W !
"RTN","SDAMC",39,0)
 K:SDAMTYP="P" SDCLN
"RTN","SDAMC",40,0)
 K SCLHOLD
"RTN","SDAMC",41,0)
 Q
"RTN","SDAMC",42,0)
MES ; -- set error message
"RTN","SDAMC",43,0)
 S SDMSG="W !,""Enter appt. numbers separated by commas and/or a range separated"",!,""by dashes (ie 2,4,6-9)"" H 2"
"RTN","SDAMC",44,0)
 Q
"RTN","SDAMC",45,0)
 ;
"RTN","SDAMC",46,0)
WHO() ;
"RTN","SDAMC",47,0)
 W ! S DIR(0)="SOA^PC:PATIENT;C:CLINIC",DIR("A")="Appointments cancelled by (P)atient or (C)linic: ",DIR("B")="Patient"
"RTN","SDAMC",48,0)
 D ^DIR K DIR
"RTN","SDAMC",49,0)
 Q $S(Y=""!(Y="^"):-1,1:Y)
"RTN","SDAMC",50,0)
 ;
"RTN","SDAMC",51,0)
RSN(SDWH) ;
"RTN","SDAMC",52,0)
RSN1 W ! S DIC="^SD(409.2,",DIC(0)="AEMQ",DIC("S")="I '$P(^(0),U,4),"""_$E(SDWH)_"B""[$P(^(0),U,2)" D ^DIC K DIC
"RTN","SDAMC",53,0)
 I X["^" G RSNQ
"RTN","SDAMC",54,0)
 I Y<0 W *7 G RSN1
"RTN","SDAMC",55,0)
RSNQ Q +Y
"RTN","SDAMC",56,0)
 ;
"RTN","SDAMC",57,0)
REM() ;
"RTN","SDAMC",58,0)
 W ! S DIR(0)="2.98,17" D ^DIR K DIR
"RTN","SDAMC",59,0)
 I $E(X)="^" S Y=-1
"RTN","SDAMC",60,0)
 Q Y
"RTN","SDAMC",61,0)
 ;
"RTN","SDAMC",62,0)
NOPE ;
"RTN","SDAMC",63,0)
 N SDEND,SDPAUSE
"RTN","SDAMC",64,0)
 S:'CNT SDPAUSE=1
"RTN","SDAMC",65,0)
 D NOPE^SDCNP1
"RTN","SDAMC",66,0)
 D:$G(SDPAUSE) PAUSE^VALM1
"RTN","SDAMC",67,0)
 Q
"RTN","SDAMC",68,0)
 ;
"RTN","SDAMC",69,0)
CHK ; -- check if status of appt permits cancelling
"RTN","SDAMC",70,0)
 N SDI S SDI=0
"RTN","SDAMC",71,0)
 F  S SDI=$O(VALMY(SDI)) Q:'SDI  I $D(^TMP("SDAMIDX",$J,SDI)) K SDAT S SDAT=^(SDI) I '$D(^SD(409.63,"ACAN",1,+$$STATUS^SDAM1($P(SDAT,U,2),$P(SDAT,U,3),+$G(^DPT(+$P(SDAT,U,2),"S",+$P(SDAT,U,3),0)),$G(^(0))))) D
"RTN","SDAMC",72,0)
 .W !,^TMP("SDAM",$J,+SDAT,0),!!,*7,"You cannot cancel this appointment."
"RTN","SDAMC",73,0)
 .K VALMY(SDI) D PAUSE^VALM1
"RTN","SDAMC",74,0)
 Q
"RTN","SDWLQOF")
0^4^B25890160
"RTN","SDWLQOF",1,0)
SDWLQOF ;;IOFO BAY PINES/TEH - OVERDUE APPOINTMENT
"RTN","SDWLQOF",2,0)
 ;;5.3;scheduling;**263,414**;AUG 13 1993
"RTN","SDWLQOF",3,0)
 ;
"RTN","SDWLQOF",4,0)
 ;
"RTN","SDWLQOF",5,0)
 ;******************************************************************
"RTN","SDWLQOF",6,0)
 ;                             CHANGE LOG
"RTN","SDWLQOF",7,0)
 ;                                               
"RTN","SDWLQOF",8,0)
 ;   DATE                        PATCH                   DESCRIPTION
"RTN","SDWLQOF",9,0)
 ;   ----                        -----                   -----------
"RTN","SDWLQOF",10,0)
 ;
"RTN","SDWLQOF",11,0)
EN ;Header
"RTN","SDWLQOF",12,0)
 N ZCODE,ZTDESC,ZTDTH,ZTIO,ZTQUEDED,ZTREQ,ZTRTN,ZTSAVE,ZTSK
"RTN","SDWLQOF",13,0)
 D HD
"RTN","SDWLQOF",14,0)
 S SDWLINST="",SDWLERR=0 K ^TMP("SDWLQOF",$J),DIC,DIR,DR,DIE
"RTN","SDWLQOF",15,0)
1 D INS G END:$D(DUOUT)
"RTN","SDWLQOF",16,0)
2 D CAT G 1:SDWLERR,END:$D(DUOUT)
"RTN","SDWLQOF",17,0)
3 D FORM G 2:SDWLERR,END:$D(DUOUT)
"RTN","SDWLQOF",18,0)
4 D DIS G EN:SDWLERR=1,END:SDWLERR=2
"RTN","SDWLQOF",19,0)
 D QUE
"RTN","SDWLQOF",20,0)
 Q
"RTN","SDWLQOF",21,0)
INS ;Get Institution
"RTN","SDWLQOF",22,0)
 S SDWLERR=0,SDWLPROM="Select Institution ALL // "
"RTN","SDWLQOF",23,0)
IN W ! S DIC(0)="QEMA",DIC("A")=SDWLPROM,DIC=4,DIC("S")="I $D(^SDWL(409.32,""C"",+Y))!($D(^SDWL(409.31,""E"",+Y)))" D ^DIC I Y<0,'SDWLERR Q:$D(DUOUT)  S Y="ALL"
"RTN","SDWLQOF",24,0)
 G IN2:Y<0 Q:$D(DUOUT)
"RTN","SDWLQOF",25,0)
 I Y<0 S SDWLINST=$S(Y="ALL":"ALL",Y="":"ALL",Y="all":"ALL",Y="All":"ALL",Y["A":"ALL",Y["a":"ALL")
"RTN","SDWLQOF",26,0)
 I Y="All"!(Y="")!(Y="all")!(Y="ALL") S SDWLINST="ALL",^TMP("SDWLQOF",$J,"INS")="ALL" G IN3
"RTN","SDWLQOF",27,0)
 S SDWLPROM="Another Institution: ",SDWLERR=1
"RTN","SDWLQOF",28,0)
 G IN:$D(SDWLIN(+Y)) S SDWLIN(+Y)=""
"RTN","SDWLQOF",29,0)
 S SDWLINST=SDWLINST_Y_";",SDWLPROM="Another Institution: ",SDWLERR=1 G IN
"RTN","SDWLQOF",30,0)
IN2 S ^TMP("SDWLQOF",$J,"INS")=SDWLINST
"RTN","SDWLQOF",31,0)
IN3 Q
"RTN","SDWLQOF",32,0)
CAT ;Report category selection
"RTN","SDWLQOF",33,0)
 K DIR,DIE,DR,DIC
"RTN","SDWLQOF",34,0)
 W !!,"    *** Report Category Selection ***" S SDWLERR=0
"RTN","SDWLQOF",35,0)
 S SDWLERR=0,SDWLCAT="",DIR(0)="SO^1:Clinic;2:Select Service/Specialty",DIR("L",1)="     1. Clinic",DIR("L")="     2. Service/Specialty"
"RTN","SDWLQOF",36,0)
 D ^DIR
"RTN","SDWLQOF",37,0)
 I X="^" S SDWLERR=1 W *7 Q
"RTN","SDWLQOF",38,0)
 I X="" S SDWLERR=1 W *7 Q
"RTN","SDWLQOF",39,0)
 S X=$S(X["C":"C",X["c":"C",X["S":"S",X["s":"S",X=1:"C",X=2:"S",1:"")
"RTN","SDWLQOF",40,0)
 I X="" W *7," Invalid Selection." G CAT
"RTN","SDWLQOF",41,0)
 W !!,"Select Category for Report Output",!
"RTN","SDWLQOF",42,0)
 S SDWLX=$S(X="C":"Clinic: ALL/ ",X="S":"Service/Specialty: ALL/ ")
"RTN","SDWLQOF",43,0)
 S SDWLF=$S(X["C":409.32,X["S":409.31,X["c":409.32,X["s":409.31)
"RTN","SDWLQOF",44,0)
 S SDWLFD=$S(X="C":8,1:7)
"RTN","SDWLQOF",45,0)
 S SDWLCTX=X
"RTN","SDWLQOF",46,0)
 K DIR,DIC,DR
"RTN","SDWLQOF",47,0)
 S ^TMP("SDWLQOF",$J,"CT1")=SDWLCTX_"^"_SDWLF_"^"_SDWLFD,DIC("A")=SDWLX,SDWLE=0
"RTN","SDWLQOF",48,0)
CT1 W ! S DIC(0)="QEMNZA",DIC=SDWLF D ^DIC I 'SDWLE,Y<1 S ^TMP("SDWLQOF",$J,"CT2")="ALL" G CT3
"RTN","SDWLQOF",49,0)
 I Y<0,'$D(^TMP("SDWLQOF",$J,"CT1")) W !,"This Entry is Required." G CAT
"RTN","SDWLQOF",50,0)
 G CT2:Y<0
"RTN","SDWLQOF",51,0)
 S SDWLCAT=SDWLCAT_Y_";",DIC("A")="Another "_$P(SDWLX,":",1)_": ",SDWLE=1 G CT1
"RTN","SDWLQOF",52,0)
CT2 G CT1:'$D(SDWLCAT) S ^TMP("SDWLQOF",$J,"CT2")=SDWLCAT
"RTN","SDWLQOF",53,0)
CT3 Q
"RTN","SDWLQOF",54,0)
FORM ;Report Format
"RTN","SDWLQOF",55,0)
 S SDWLERR=0,DIR(0)="SO^1:D:Detailed;S:Summary",DIR("L",2)="     D Detailed"
"RTN","SDWLQOF",56,0)
 S DIR("L")="     S Summary",DIR("L",1)="Select One of the Following: "
"RTN","SDWLQOF",57,0)
 D ^DIR
"RTN","SDWLQOF",58,0)
 I X="^" S DUOUT=1 Q
"RTN","SDWLQOF",59,0)
 S SDWLFORM=$S(X["D":"D",X["d":"D",X["S":"S",X["s":"S",1:"")
"RTN","SDWLQOF",60,0)
 I X="" W !,"Required!" G FORM
"RTN","SDWLQOF",61,0)
 S ^TMP("SDWLQOF",$J,"FORM")=SDWLFORM
"RTN","SDWLQOF",62,0)
 Q
"RTN","SDWLQOF",63,0)
DIS ;Display Parameters
"RTN","SDWLQOF",64,0)
 S SDWLERR=0 W !!,?80-$L("*** Selected Report Parameters ***")\2,"*** Selected Report Parameters ***",!
"RTN","SDWLQOF",65,0)
 F SDWLI="INS","CT1","CT2","FORM" D
"RTN","SDWLQOF",66,0)
 .S X="SDWL"_SDWLI,@X=$G(^TMP("SDWLQOF",$J,SDWLI))
"RTN","SDWLQOF",67,0)
 F SDWLTAG="IS","CT","OP" D @SDWLTAG
"RTN","SDWLQOF",68,0)
 Q
"RTN","SDWLQOF",69,0)
IS I SDWLINS'["ALL" D
"RTN","SDWLQOF",70,0)
 .K SDWLY F I=1:1 S SDWLY=$P($P(SDWLINS,";",I),U,2) Q:SDWLY=""  S SDWLY(I)=SDWLY
"RTN","SDWLQOF",71,0)
 .W !,?20,"Institution: "
"RTN","SDWLQOF",72,0)
 .I $D(SDWLY) S I="" F  S I=$O(SDWLY(I)) Q:I=""  W:I>1 !,?33 W SDWLY(I)
"RTN","SDWLQOF",73,0)
 .K SDWLY
"RTN","SDWLQOF",74,0)
 I SDWLINS["ALL" W !,?20,"Institution: ALL "
"RTN","SDWLQOF",75,0)
 Q
"RTN","SDWLQOF",76,0)
CT I SDWLCT2'["ALL" D
"RTN","SDWLQOF",77,0)
 .S SDWLF=$P(SDWLCT1,U,2)
"RTN","SDWLQOF",78,0)
 .K SDWLY F I=1:1 S SDWLY=$P($P(SDWLCT2,";",I),U,2) Q:SDWLY=""  S SDWLY(I)=SDWLY
"RTN","SDWLQOF",79,0)
 .W !,?16,"Report Category: " W $S(SDWLCT1["C":"Clinic",1:"Service Specialty"),!,?36 I @X="ALL" W "All "
"RTN","SDWLQOF",80,0)
 .I $D(SDWLY) S I="" F   S I=$O(SDWLY(I)) Q:I=""  W:I>1 !,?35 W $$EXTERNAL^DILFD(SDWLF,.01,,SDWLY(I))
"RTN","SDWLQOF",81,0)
 I SDWLCT2["ALL" W !,?16,"Report Category: " W $S(SDWLCT1["C":"Clinic",1:"Service Specialty"),!,?36 W "ALL "
"RTN","SDWLQOF",82,0)
 Q
"RTN","SDWLQOF",83,0)
OP W !,?18,"Output Format: ",$S(SDWLFORM="D":" Detailed",1:" Summary")
"RTN","SDWLQOF",84,0)
 Q
"RTN","SDWLQOF",85,0)
 S %=1 W !!,"Are these Parameters Correct " D YN^DICN I %=2 S SDWLERR=1 W !,"  This Report will NOT be queued to print."
"RTN","SDWLQOF",86,0)
 I SDWLERR S DIR(0)="E" D ^DIR I X["^" S SDWLERR=2
"RTN","SDWLQOF",87,0)
 Q
"RTN","SDWLQOF",88,0)
QUE ;Queue Report
"RTN","SDWLQOF",89,0)
 N ZTQUEUED,POP
"RTN","SDWLQOF",90,0)
 K %ZIS,IOP,IOC,ZTIO,SDWLSPT S %ZIS="MQ" D ^%ZIS G:POP QUE1
"RTN","SDWLQOF",91,0)
 S ZTRTN=$S(SDWLFORM="D":"EN^SDWLROF",1:"EN^SDWLROS"),ZTDTH=$H,ZTDESC="WAIT LIST OVERDUE REPORT"
"RTN","SDWLQOF",92,0)
 S SDWLTASK="" F  S SDWLTASK=$O(^TMP("SDWLQOF",$J,SDWLTASK)) Q:SDWLTASK=""  D
"RTN","SDWLQOF",93,0)
 .S SDWLTK=$G(^TMP("SDWLQOF",$J,SDWLTASK))
"RTN","SDWLQOF",94,0)
 .S ZTSAVE(SDWLTASK)=SDWLTK
"RTN","SDWLQOF",95,0)
 I $D(IO("Q")) K IO("Q") D ^%ZTLOAD W !,"REQUEST QUEUED" G END
"RTN","SDWLQOF",96,0)
QUE1 S:$E(IOST,1,2)="C-" SDWLSPT=1 I $D(ZTRTN) U IO D @ZTRTN
"RTN","SDWLQOF",97,0)
 ;
"RTN","SDWLQOF",98,0)
END ;
"RTN","SDWLQOF",99,0)
 K SDWLTASK,SDWLY,SDWLED,WDWLBD,SDWLOPEN,SDWLDATE,SDWLFORM,SDWLPRI,I
"RTN","SDWLQOF",100,0)
 K DIR,DIC,DR,DIE
"RTN","SDWLQOF",101,0)
 D ^%ZISC S:$D(ZTQUEUED) ZTREQ="@"
"RTN","SDWLQOF",102,0)
 Q
"RTN","SDWLQOF",103,0)
HD W:$D(IOF) @IOF W !,?80-$L("Overdue Appointment Wait List Report")\2,"Overdue Appointment Wait List Report"
"RTN","SDWLQOF",104,0)
 Q
"RTN","SDWLROF")
0^2^B30475987
"RTN","SDWLROF",1,0)
SDWLROF ;;IOFO BAY PINES/TEH - WAIT LIST OVERDUE REPORT 1;06/12/2002 ; 29 Aug 2002  2:54 PM
"RTN","SDWLROF",2,0)
 ;;5.3;scheduling;**263,414**;AUG 13 1993
"RTN","SDWLROF",3,0)
 ;
"RTN","SDWLROF",4,0)
 ;
"RTN","SDWLROF",5,0)
 ;******************************************************************
"RTN","SDWLROF",6,0)
 ;                             CHANGE LOG
"RTN","SDWLROF",7,0)
 ;                                               
"RTN","SDWLROF",8,0)
 ;   DATE                        PATCH                   DESCRIPTION
"RTN","SDWLROF",9,0)
 ;   ----                        -----                   -----------
"RTN","SDWLROF",10,0)
 ;   
"RTN","SDWLROF",11,0)
 ;   
"RTN","SDWLROF",12,0)
 ;   
"RTN","SDWLROF",13,0)
 ;
"RTN","SDWLROF",14,0)
EN D INIT
"RTN","SDWLROF",15,0)
 I $$S^%ZTLOAD G END
"RTN","SDWLROF",16,0)
 D SORT
"RTN","SDWLROF",17,0)
 I $$S^%ZTLOAD G END
"RTN","SDWLROF",18,0)
 D PRINT
"RTN","SDWLROF",19,0)
 I $$S^%ZTLOAD G END
"RTN","SDWLROF",20,0)
 K ^TMP("SDWLQOF",$J)
"RTN","SDWLROF",21,0)
 Q
"RTN","SDWLROF",22,0)
INIT ;Initialize variables
"RTN","SDWLROF",23,0)
 ;
"RTN","SDWLROF",24,0)
 I $D(CT1) S SDWLCT1=CT1
"RTN","SDWLROF",25,0)
 I $D(CT2) S SDWLCT2=CT2
"RTN","SDWLROF",26,0)
 I $D(DATE) S SDWLDATE=DATE
"RTN","SDWLROF",27,0)
 I $D(FORM) S SDWLFORM=FORM
"RTN","SDWLROF",28,0)
 I $D(INS) S SDWLINS=INS
"RTN","SDWLROF",29,0)
 S SDWLPG=0
"RTN","SDWLROF",30,0)
 I $D(ZTSAVE) D
"RTN","SDWLROF",31,0)
 .F SDWLI="CT1","CT2","FORM","INS" S SDWL="SDWL"_SDWLI,@SDWL=$G(ZTSAVE(SDWLI))
"RTN","SDWLROF",32,0)
 I SDWLINS="ALL" S SDWLIN("ALL")=""
"RTN","SDWLROF",33,0)
 S SDWLTXP=$P(SDWLCT1,U,3),SDWLF=$P(SDWLCT1,U,2)
"RTN","SDWLROF",34,0)
 I SDWLINS'="ALL" F SDWLI=1:1 S SDWLIN=$P($P(SDWLINS,";",SDWLI),U,1) Q:SDWLIN=""  S SDWLIN(SDWLIN)="",^TMP("SDWLQOF",$J,SDWLIN)=0
"RTN","SDWLROF",35,0)
 I SDWLCT2'="ALL" F SDWLI=1:1 S SDWLCL=$P($P(SDWLCT2,";",SDWLI),U,1) Q:SDWLCL=""  S SDWLCT2(SDWLCL)=""
"RTN","SDWLROF",36,0)
 D NOW^%DTC S Y=% D DD^%DT S SDWLDTP=Y
"RTN","SDWLROF",37,0)
 Q
"RTN","SDWLROF",38,0)
SORT ;Sort Records
"RTN","SDWLROF",39,0)
 K ^TMP("SDWLROF",$J)
"RTN","SDWLROF",40,0)
 S SDWLDA=0,SDWLCNT=0 F  S SDWLDA=$O(^SDWL(409.3,SDWLDA)) Q:SDWLDA<1  D
"RTN","SDWLROF",41,0)
 .S SDWLX=$G(^SDWL(409.3,SDWLDA,0)),SDWLERR=0,SDWLDFN=+SDWLX I 'SDWLDFN Q
"RTN","SDWLROF",42,0)
 .;-Check for Institution Sort
"RTN","SDWLROF",43,0)
 .I SDWLINS'="ALL" D
"RTN","SDWLROF",44,0)
 ..I '$D(SDWLIN(+$P(SDWLX,U,3))) S SDWLERR=1
"RTN","SDWLROF",45,0)
 .;-Check for Date Range Compliance
"RTN","SDWLROF",46,0)
 .I $P(SDWLX,U,16)'<DT,$P(SDWLX,U,16)'=DT S SDWLERR=2
"RTN","SDWLROF",47,0)
 .S SDWLTYP=$P(SDWLCT1,U,1),SDWLTYPE=$S(SDWLTYP="C":+$P(SDWLX,U,9),1:+$P(SDWLX,U,8)) I SDWLTYPE=""!('SDWLTYPE) S SDWLERR=7 Q
"RTN","SDWLROF",48,0)
 .I SDWLCT2'="ALL" D
"RTN","SDWLROF",49,0)
 ..I '$D(SDWLCT2(SDWLTYPE)) S SDWLERR=3
"RTN","SDWLROF",50,0)
 .I SDWLTYP="" S SDWLERR=4
"RTN","SDWLROF",51,0)
 .I $P(SDWLX,U,17)["C" S SDWLERR=6
"RTN","SDWLROF",52,0)
 .Q:SDWLERR  D
"RTN","SDWLROF",53,0)
 ..S SDWLSCC=2,DFN=SDWLDFN D ELIG^VADPT I $D(VAEL(3)) S SDWLSCN=$P(VAEL(3),U,2) I SDWLSCN>49 S SDWLSCC=1
"RTN","SDWLROF",54,0)
 ..S ^TMP("SDWLROF",$J,+$P(SDWLX,U,3),SDWLTYPE,SDWLSCC,SDWLDA)=""
"RTN","SDWLROF",55,0)
 ..S SDWLCNT=SDWLCNT+1,^TMP("SDWLROF",$J,+$P(SDWLX,U,3))=SDWLCNT
"RTN","SDWLROF",56,0)
 Q
"RTN","SDWLROF",57,0)
PRINT ;Print Report
"RTN","SDWLROF",58,0)
 D HD S SDWLCNT=0 I '$D(^TMP("SDWLROF",$J)) W !!,?80-$L("*** No Patient Records to Report ***")\2,"*** No Patient Records to Report ***" Q
"RTN","SDWLROF",59,0)
 S SDWLA="" F  S SDWLA=$O(^TMP("SDWLROF",$J,SDWLA)) G END:$$S^%ZTLOAD Q:SDWLA=""  D  Q:$D(DUOUT)
"RTN","SDWLROF",60,0)
 .D LINE W !!,"Institution: " S X=$$EXTERNAL^DILFD(409.3,2,,SDWLA) W X I '$G(^TMP("SDWLROF",$J,SDWLA)) W !!,"*** No Patient Records to Report ***"
"RTN","SDWLROF",61,0)
 .S SDWLB="" F  S SDWLB=$O(^TMP("SDWLROF",$J,SDWLA,SDWLB)) Q:SDWLB=""  D  Q:$D(DUOUT)
"RTN","SDWLROF",62,0)
 ..W !!,"Clinic/Service: " S X=$$EXTERNAL^DILFD(409.3,SDWLTXP,,SDWLB) W X,! Q:$D(DUOUT)
"RTN","SDWLROF",63,0)
 ..S SDWLC="" F  S SDWLC=$O(^TMP("SDWLROF",$J,SDWLA,SDWLB,SDWLC)) Q:SDWLC=""  D  Q:$D(DUOUT)
"RTN","SDWLROF",64,0)
 ...S SDWLD="" F  S SDWLD=$O(^TMP("SDWLROF",$J,SDWLA,SDWLB,SDWLC,SDWLD)) Q:SDWLD=""  D  Q:$D(DUOUT)
"RTN","SDWLROF",65,0)
 ....S (DFN,SDWLDFN)=$P($G(^SDWL(409.3,SDWLD,0)),U,1) D 1^VADPT,DEM^VADPT,ELIG^VADPT,ADD^VADPT
"RTN","SDWLROF",66,0)
 ....S SDWLELIG=$P(VAEL(1),U,2)
"RTN","SDWLROF",67,0)
 ....S SDWLNAM=VADM(1),SDWLSSN=VA("BID")
"RTN","SDWLROF",68,0)
 ....S SDWLDEAD=1
"RTN","SDWLROF",69,0)
 ....S SDWLAPTD=$P(^SDWL(409.3,SDWLD,0),U,16),SDWLCOM=$P(^SDWL(409.3,SDWLD,0),U,18)
"RTN","SDWLROF",70,0)
 ....S SDWLRBY=$P(^SDWL(409.3,SDWLD,0),U,12),SDWLRPV=$P(^SDWL(409.3,SDWLD,0),U,13)
"RTN","SDWLROF",71,0)
 ....S SDWLPH=$G(VAPA(8))
"RTN","SDWLROF",72,0)
 ....I SDWLAPTD'="" S Y=SDWLAPTD D DD^%DT S SDWLAPTD=Y
"RTN","SDWLROF",73,0)
 ....W !!,SDWLNAM
"RTN","SDWLROF",74,0)
 ....W ?35,SDWLSSN I SDWLAPTD'="" W ?50,"Desired Date: ",SDWLAPTD
"RTN","SDWLROF",75,0)
 ....W !,"Primary Eligibility: ",SDWLELIG
"RTN","SDWLROF",76,0)
 ....W !,"Comments: ",SDWLCOM,!
"RTN","SDWLROF",77,0)
 ....I SDWLRBY W !,"Requested by: ",$$EXTERNAL^DILFD(409.3,11,,SDWLRBY)
"RTN","SDWLROF",78,0)
 ....I SDWLRPV W ?35,"Requesting Provider: " S X=$$EXTERNAL^DILFD(409.3,12,,SDWLRPV) W X
"RTN","SDWLROF",79,0)
 ....W !,"Telephone (Home): ",$P(SDWLPH,U,1) I $P(SDWLPH,U,2) W !,?10,"(Work): ",$P(SDWLPH,U,2)
"RTN","SDWLROF",80,0)
 ....W !,"*****"
"RTN","SDWLROF",81,0)
 ....I $D(SDWLSPT) S DIR(0)="E" D ^DIR I X["^" S DUOUT=1 Q
"RTN","SDWLROF",82,0)
 ....I '$D(SDWLSPT),'$D(DUOUT),$Y>(IOSL-5) D HD
"RTN","SDWLROF",83,0)
 ....K VAEL,VADM,VA,VAPA
"RTN","SDWLROF",84,0)
 W !!,"** End of Report **"
"RTN","SDWLROF",85,0)
 Q
"RTN","SDWLROF",86,0)
LINE ;Draw Line
"RTN","SDWLROF",87,0)
 W !,"_______________________________________________________________________________"
"RTN","SDWLROF",88,0)
 Q
"RTN","SDWLROF",89,0)
HD ;Header
"RTN","SDWLROF",90,0)
 W:$D(IOF) @IOF W !,SDWLDTP,?80-$L("Appt Wait List Overdue Report")\2,"Appt Wait List Overdue Report"
"RTN","SDWLROF",91,0)
 S Y=DT D DD^%DT S SDWLPD=Y W ?57,SDWLPD S SDWLPG=SDWLPG+1 W ?72,"Page: ",SDWLPG
"RTN","SDWLROF",92,0)
 W !!,?30,"Institution: " I SDWLINS="ALL" D
"RTN","SDWLROF",93,0)
 .W ?45,SDWLINS
"RTN","SDWLROF",94,0)
 F I=1:1 S X=$P($P(SDWLINS,";",I),"^",2) Q:X=""  W:I>1 ! W ?45,X
"RTN","SDWLROF",95,0)
 S X=$P(SDWLCT2,U,2)
"RTN","SDWLROF",96,0)
 W !?26,"Report Category: ",$S($P(SDWLCT1,U,1)="C":"CLINIC",1:"SPECIALTY") I X="ALL" W " ALL"
"RTN","SDWLROF",97,0)
 I X'="ALL" D
"RTN","SDWLROF",98,0)
 .F I=1:1 S X=$P($P(SDWLCT2,";",I),"^",2) Q:X=""  W !,?45,$$EXTERNAL^DILFD(SDWLF,.01,,X)
"RTN","SDWLROF",99,0)
 S X=$G(SDWLFORM) W !,?28,"Output Format: ",$S(SDWLFORM="S":"Summary",1:"Detailed")
"RTN","SDWLROF",100,0)
 Q
"RTN","SDWLROF",101,0)
END K SDWL,SDWLA,SDWLAPTD,SDWLB,SDWLBD,SDWLBDT,SDWLC,SDWLCAT,SDWLCNT,SDWLCOM,SDWLCT1,SDWLCT2,SDWLCTX,SDWLD
"RTN","SDWLROF",102,0)
 K SDLWDA,SDLWDEAD,SDWLDFN,SDWLE,SDWLEDT,SDWLELIG,SDWLERR,SDWLF,SDWLFD,SDWLI,SDWLIN,SDWLINS,SDWLINST
"RTN","SDWLROF",103,0)
 K SDWLNAM,SDWLPD,SDWLPG,SDWLPH,SDWLPROM,SDWLRBY,SDWLPRV,SDWLSCC,SDWLSPT,SDWLSSN,SDWLTAG,SDLTK,SDWLTXP
"RTN","SDWLROF",104,0)
 K SDWLTYP,SDWLTYPE,SDWLX,CT1,CT2,DATE,I,INS,OPEN,FORM
"RTN","SDWLROF",105,0)
 Q
"RTN","SDWLROS")
0^3^B33019881
"RTN","SDWLROS",1,0)
SDWLROS ;;IOFO BAY PINES/TEH - WAIT LIST OVERDUE REPORT-SUMMARY;06/12/2002 ; 20 Aug 2002  2:10 PM
"RTN","SDWLROS",2,0)
 ;;5.3;scheduling;**263,414**;AUG 13 1993
"RTN","SDWLROS",3,0)
 ;
"RTN","SDWLROS",4,0)
 ;
"RTN","SDWLROS",5,0)
 ;******************************************************************
"RTN","SDWLROS",6,0)
 ;                             CHANGE LOG
"RTN","SDWLROS",7,0)
 ;                                               
"RTN","SDWLROS",8,0)
 ;   DATE                        PATCH                   DESCRIPTION
"RTN","SDWLROS",9,0)
 ;   ----                        -----                   -----------
"RTN","SDWLROS",10,0)
 ;   
"RTN","SDWLROS",11,0)
 ;   
"RTN","SDWLROS",12,0)
 ;   
"RTN","SDWLROS",13,0)
 ;
"RTN","SDWLROS",14,0)
EN ;
"RTN","SDWLROS",15,0)
 D INIT
"RTN","SDWLROS",16,0)
 I $$S^%ZTLOAD G END
"RTN","SDWLROS",17,0)
 D HD
"RTN","SDWLROS",18,0)
 D SORT
"RTN","SDWLROS",19,0)
 I $$S^%ZTLOAD G END
"RTN","SDWLROS",20,0)
 D PRT
"RTN","SDWLROS",21,0)
 I $$S^%ZTLOAD G END
"RTN","SDWLROS",22,0)
 D PRT1
"RTN","SDWLROS",23,0)
 K ^TMP("SDWLROS",$J)
"RTN","SDWLROS",24,0)
 Q
"RTN","SDWLROS",25,0)
INIT ;Initialize variables
"RTN","SDWLROS",26,0)
 ;
"RTN","SDWLROS",27,0)
 I $D(CT1) S SDWLCT1=CT1
"RTN","SDWLROS",28,0)
 I $D(CT2) S SDWLCT2=CT2
"RTN","SDWLROS",29,0)
 I $D(FORM) S SDWLFORM=FORM
"RTN","SDWLROS",30,0)
 I $D(INS) S SDWLINS=INS
"RTN","SDWLROS",31,0)
 S SDWLPG=0
"RTN","SDWLROS",32,0)
 I $D(ZTSAVE) D
"RTN","SDWLROS",33,0)
 .F SDWLI="CT1","CT2","FORM","INS" S SDWL="SDWL"_SDWLI,@SDWL=$G(ZTSAVE(SDWLI))
"RTN","SDWLROS",34,0)
 I SDWLINS="ALL" S SDWLIN("ALL")=""
"RTN","SDWLROS",35,0)
 S SDWLTXP=$P(SDWLCT1,U,3),SDWLF=$P(SDWLCT1,U,2)
"RTN","SDWLROS",36,0)
 I SDWLINS'="ALL" F SDWLI=1:1 S SDWLIN=$P($P(SDWLINS,";",SDWLI),U,1) Q:SDWLIN=""  S SDWLIN(SDWLIN)=""
"RTN","SDWLROS",37,0)
 I SDWLCT2'="ALL" F SDWLI=1:1 S SDWLCL=$P($P(SDWLCT2,";",SDWLI),U,1) Q:SDWLCL=""  S SDWLCT2(SDWLCL)=""
"RTN","SDWLROS",38,0)
 D NOW^%DTC S Y=% D DD^%DT S SDWLDTP=Y
"RTN","SDWLROS",39,0)
 Q
"RTN","SDWLROS",40,0)
SORT ;Sort Records
"RTN","SDWLROS",41,0)
 K ^TMP("SDWLROS",$J)
"RTN","SDWLROS",42,0)
 S SDWLDA=0 F  S SDWLDA=$O(^SDWL(409.3,SDWLDA)) Q:SDWLDA<1  D
"RTN","SDWLROS",43,0)
 .S SDWLX=$G(^SDWL(409.3,SDWLDA,0)),SDWLERR=0,SDWLDFN=+SDWLX I 'SDWLDFN Q
"RTN","SDWLROS",44,0)
 .;-Check for Institution Sort
"RTN","SDWLROS",45,0)
 .I SDWLINS'="ALL" D
"RTN","SDWLROS",46,0)
 ..I '$D(SDWLIN(+$P(SDWLX,U,3))) S SDWLERR=1 Q
"RTN","SDWLROS",47,0)
 .I $P(SDWLX,U,16)'<DT,$P(SDWLX,U,16)'=DT S SDWLERR=2
"RTN","SDWLROS",48,0)
 .S SDWLAPDT=$P(SDWLX,U,16),SDWLOPDT=$P(SDWLX,U,2) S X1=DT,X2=SDWLAPDT D ^%DTC S SDWLDWT=+X
"RTN","SDWLROS",49,0)
 .S SDWLTYP=$P(SDWLCT1,U,1),SDWLTYPE=$S(SDWLTYP="C":+$P(SDWLX,U,9),1:+$P(SDWLX,U,8)) I SDWLTYPE=""!('SDWLTYPE) S SDWLERR=7 Q
"RTN","SDWLROS",50,0)
 .S SDWLF=$P(SDWLCT1,U,2)
"RTN","SDWLROS",51,0)
 .I SDWLCT2'="ALL" D
"RTN","SDWLROS",52,0)
 ..I '$D(SDWLCT2(SDWLTYPE)) S SDWLERR=3
"RTN","SDWLROS",53,0)
 .I SDWLTYP="" S SDWLERR=4 Q
"RTN","SDWLROS",54,0)
 .I $P(SDWLX,U,17)["C" S SDWLERR=6 Q
"RTN","SDWLROS",55,0)
 .Q:SDWLERR  D
"RTN","SDWLROS",56,0)
 ..S SDWLSCC=2,DFN=SDWLDFN D ELIG^VADPT I $D(VAEL(3)) S SDWLSCN=$P(VAEL(3),U,2) I SDWLSCN>49 S SDWLSCC=1
"RTN","SDWLROS",57,0)
 ..S:'$D(^TMP("SDWLROS",$J,"A",+$P(SDWLX,U,3),SDWLTYPE)) ^(SDWLTYPE)=0
"RTN","SDWLROS",58,0)
 ..S ^TMP("SDWLROS",$J,"A",+$P(SDWLX,U,3),SDWLTYPE)=^(SDWLTYPE)+1
"RTN","SDWLROS",59,0)
 ..S:'$D(^TMP("SDWLROS",$J,"B",+$P(SDWLX,U,3),SDWLTYPE,SDWLDFN)) ^(SDWLDFN)=0 S ^TMP("SDWLROS",$J,"B",+$P(SDWLX,U,3),SDWLTYPE,SDWLDFN)=^(SDWLDFN)+1
"RTN","SDWLROS",60,0)
 ..S:'$D(^TMP("SDWLROS",$J,"C",SDWLSCC,+$P(SDWLX,U,3),SDWLTYPE)) ^TMP("SDWLROS",$J,"C",SDWLSCC,+$P(SDWLX,U,3),SDWLTYPE)=0
"RTN","SDWLROS",61,0)
 ..S ^TMP("SDWLROS",$J,"C",SDWLSCC,+$P(SDWLX,U,3),SDWLTYPE)=^(SDWLTYPE)+1
"RTN","SDWLROS",62,0)
 ..S ^TMP("SDWLROS",$J,"D",SDWLSCC,+$P(SDWLX,U,3),SDWLTYPE,SDWLDWT,SDWLDA)=""
"RTN","SDWLROS",63,0)
 Q
"RTN","SDWLROS",64,0)
PRT ;
"RTN","SDWLROS",65,0)
 S SDWLIN=0 F  S SDWLIN=$O(^TMP("SDWLROS",$J,"A",SDWLIN)) Q:SDWLIN=""  W !,"Institution: ",$P($G(^DIC(4,SDWLIN,0)),U,1),! D
"RTN","SDWLROS",66,0)
 .D PRA
"RTN","SDWLROS",67,0)
 Q
"RTN","SDWLROS",68,0)
PRA ;
"RTN","SDWLROS",69,0)
 S SDWLSC=0,(SDWLX,SDWLXT,SDWLXTT)=0 F  S SDWLSC=$O(^TMP("SDWLROS",$J,"A",SDWLIN,SDWLSC)) Q:SDWLSC=""  D
"RTN","SDWLROS",70,0)
 .S SDWLX=$G(^TMP("SDWLROS",$J,"A",SDWLIN,SDWLSC)),SDWLXT=SDWLXT+SDWLX W !,$$EXTERNAL^DILFD(SDWLF,.01,,$P(^SDWL(SDWLF,SDWLSC,0),U,1)),?30,SDWLX
"RTN","SDWLROS",71,0)
 .S SDWLDFNX=0 F  S SDWLDFNX=$O(^TMP("SDWLROS",$J,"B",SDWLIN,SDWLSC,SDWLDFNX)) Q:SDWLDFNX=""  S SDWLXTT=SDWLXTT+1
"RTN","SDWLROS",72,0)
 W !,?20,"Total #: ",SDWLXT
"RTN","SDWLROS",73,0)
 ;W !,?4,"Total # Unique Patients: ",SDWLXTT,!!
"RTN","SDWLROS",74,0)
 I $D(SDWLSPT),$Y>IOSL S DIR(0)="E" D ^DIR I X="^" Q
"RTN","SDWLROS",75,0)
 Q
"RTN","SDWLROS",76,0)
PRT1 ;
"RTN","SDWLROS",77,0)
 D HD,HD1
"RTN","SDWLROS",78,0)
 S SDWLSCC=0 F  S SDWLSCC=$O(^TMP("SDWLROS",$J,"D",SDWLSCC)) Q:SDWLSCC=""  Q:$$S^%ZTLOAD  D  I $D(DUOUT) Q
"RTN","SDWLROS",79,0)
 .W !,"******* ",SDWLSCC," *******",!
"RTN","SDWLROS",80,0)
 .S SDWLINS=0 F  S SDWLINS=$O(^TMP("SDWLROS",$J,"D",SDWLSCC,SDWLINS)) Q:SDWLINS=""  D  W ! I $D(DUOUT) Q
"RTN","SDWLROS",81,0)
 ..W !,$P($G(^DIC(4,SDWLINS,0)),U,1),!
"RTN","SDWLROS",82,0)
 ..S SDWLSC=0 F  S SDWLSC=$O(^TMP("SDWLROS",$J,"D",SDWLSCC,SDWLINS,SDWLSC)) Q:SDWLSC=""  D  I $D(DUOUT) Q
"RTN","SDWLROS",83,0)
 ...W !,$$EXTERNAL^DILFD(SDWLF,.01,,$P(^SDWL(SDWLF,SDWLSC,0),U,1))
"RTN","SDWLROS",84,0)
 ...S SDWLWT="" F  S SDWLWT=$O(^TMP("SDWLROS",$J,"D",SDWLSCC,SDWLINS,SDWLSC,SDWLWT)) Q:SDWLWT=""  D  I $D(DUOUT) Q
"RTN","SDWLROS",85,0)
 ....S SDWLDA=0 F  S SDWLDA=$O(^TMP("SDWLROS",$J,"D",SDWLSCC,SDWLINS,SDWLSC,SDWLWT,SDWLDA)) Q:SDWLDA=""  D  I $D(DUOUT) Q
"RTN","SDWLROS",86,0)
 .....S X=$G(^SDWL(409.3,SDWLDA,0)),SDWLODT=$P(X,U,2),SDWLDDT=$P(X,U,16) D
"RTN","SDWLROS",87,0)
 ......S DFN=+X D 1^VADPT,DEM^VADPT
"RTN","SDWLROS",88,0)
 ......W !,VA("BID"),?6,$E(VADM(1),1,25),?32,$E(SDWLODT,4,5),"/",$E(SDWLODT,6,7),"/",($E(SDWLODT,1,3)+1700)
"RTN","SDWLROS",89,0)
 ......W ?47,$E(SDWLDDT,4,5),"/",$E(SDWLDDT,6,7),"/",($E(SDWLDDT,1,3)+1700),?60,$J(SDWLWT,5) K VA,VADM
"RTN","SDWLROS",90,0)
 ......I $D(SDWLSPT),$Y>(IOSL+3) S DIR(0)="E" D ^DIR I X="^" S DUOUT=1 Q
"RTN","SDWLROS",91,0)
 ......I $Y>(IOSL+3) D HD,HD1
"RTN","SDWLROS",92,0)
 .W !
"RTN","SDWLROS",93,0)
 Q
"RTN","SDWLROS",94,0)
LINE ;Draw Line
"RTN","SDWLROS",95,0)
 W !,"_______________________________________________________________________________"
"RTN","SDWLROS",96,0)
 Q
"RTN","SDWLROS",97,0)
HD ;Header
"RTN","SDWLROS",98,0)
 W:$D(IOF) @IOF W !,SDWLDTP,?80-$L("Appointment Wait List Overdue Report")\2,"Appointment Wait List Overdue Report"
"RTN","SDWLROS",99,0)
 S Y=DT D DD^%DT S SDWLPD=Y W ?59,SDWLPD S SDWLPG=SDWLPG+1 W ?72,"Page: ",SDWLPG
"RTN","SDWLROS",100,0)
 W !!,?30,"Institution: " I SDWLINS="ALL" D
"RTN","SDWLROS",101,0)
 .W ?45,SDWLINS
"RTN","SDWLROS",102,0)
 F I=1:1 S X=$P($P(SDWLINS,";",I),"^",2) Q:X=""  W:I>1 ! W ?45,X
"RTN","SDWLROS",103,0)
 S X=$P(SDWLCT1,U,1)
"RTN","SDWLROS",104,0)
 W !?27,"Report Category: ",$S($P(SDWLCT1,U,1)="C":"CLINIC",1:"SPECIALTY") I X="ALL" W " ALL"
"RTN","SDWLROS",105,0)
 I X'="ALL" D
"RTN","SDWLROS",106,0)
 .F I=1:1 S X=$P($P(SDWLCT2,";",I),"^",2) Q:X=""  W !,?45,$$EXTERNAL^DILFD(SDWLF,.01,,X)
"RTN","SDWLROS",107,0)
 S X=$G(SDWLFORM) W !,?28,"Output Format: ",$S(SDWLFORM="S":"Summary",1:"Detailed")
"RTN","SDWLROS",108,0)
 Q
"RTN","SDWLROS",109,0)
HD1 ;
"RTN","SDWLROS",110,0)
 W !!,"Name",?30,"Date Entered",?45,"Date Desired",?60,"# of Days Waiting",!!
"RTN","SDWLROS",111,0)
 Q
"RTN","SDWLROS",112,0)
END K X1,X2,SDWLAPDT,CT,CT1,CT2,I,OPEN,INS,FORM,VADM Q
"VER")
8.0^22.0
**END**
**END**
