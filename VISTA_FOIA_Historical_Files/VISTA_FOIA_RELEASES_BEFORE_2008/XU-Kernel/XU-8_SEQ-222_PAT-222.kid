Released XU*8*222 SEQ #222
Extracted from mail message
**KIDS**:XU*8.0*222^

**INSTALL NAME**
XU*8.0*222
"BLD",549,0)
XU*8.0*222^KERNEL^0^3021106^y
"BLD",549,1,0)
^^2^2^3021106^
"BLD",549,1,1,0)
Please refer to the Description in FORUM Patch Module for details.
"BLD",549,1,2,0)
XU*8*222 7 NOIS AND 2 E3R
"BLD",549,4,0)
^9.64PA^200^1
"BLD",549,4,200,0)
200
"BLD",549,4,200,2,0)
^9.641^200.03^2
"BLD",549,4,200,2,200,0)
NEW PERSON  (File-top level)
"BLD",549,4,200,2,200,1,0)
^9.6411^201^2
"BLD",549,4,200,2,200,1,7,0)
DISUSER
"BLD",549,4,200,2,200,1,201,0)
PRIMARY MENU OPTION
"BLD",549,4,200,2,200.03,0)
SECONDARY MENU OPTIONS  (sub-file)
"BLD",549,4,200,2,200.03,1,0)
^9.6411^.01^1
"BLD",549,4,200,2,200.03,1,.01,0)
SECONDARY MENU OPTIONS
"BLD",549,4,200,222)
y^y^p^^^^n
"BLD",549,4,"APDD",200,200)

"BLD",549,4,"APDD",200,200,7)

"BLD",549,4,"APDD",200,200,201)

"BLD",549,4,"APDD",200,200.03)

"BLD",549,4,"APDD",200,200.03,.01)

"BLD",549,4,"B",200,200)

"BLD",549,"KRN",0)
^9.67PA^8989.52^20
"BLD",549,"KRN",.4,0)
.4
"BLD",549,"KRN",.4,"NM",0)
^9.68A^1^1
"BLD",549,"KRN",.4,"NM",1,0)
XUSERINQ    FILE #200^200^0
"BLD",549,"KRN",.4,"NM","B","XUSERINQ    FILE #200",1)

"BLD",549,"KRN",.401,0)
.401
"BLD",549,"KRN",.402,0)
.402
"BLD",549,"KRN",.403,0)
.403
"BLD",549,"KRN",.5,0)
.5
"BLD",549,"KRN",.84,0)
.84
"BLD",549,"KRN",3.6,0)
3.6
"BLD",549,"KRN",3.8,0)
3.8
"BLD",549,"KRN",9.2,0)
9.2
"BLD",549,"KRN",9.8,0)
9.8
"BLD",549,"KRN",9.8,"NM",0)
^9.68A^6^5
"BLD",549,"KRN",9.8,"NM",1,0)
XUSER1^^0^B7947642
"BLD",549,"KRN",9.8,"NM",2,0)
XUTMK^^0^B32900638
"BLD",549,"KRN",9.8,"NM",4,0)
XUSTERM1^^0^B20273244
"BLD",549,"KRN",9.8,"NM",5,0)
XUSTERM^^0^B27759476
"BLD",549,"KRN",9.8,"NM",6,0)
XUA4A72^^0^B14112901
"BLD",549,"KRN",9.8,"NM","B","XUA4A72",6)

"BLD",549,"KRN",9.8,"NM","B","XUSER1",1)

"BLD",549,"KRN",9.8,"NM","B","XUSTERM",5)

"BLD",549,"KRN",9.8,"NM","B","XUSTERM1",4)

"BLD",549,"KRN",9.8,"NM","B","XUTMK",2)

"BLD",549,"KRN",19,0)
19
"BLD",549,"KRN",19,"NM",0)
^9.68A^2^2
"BLD",549,"KRN",19,"NM",1,0)
XUROUTINE OUT^^0
"BLD",549,"KRN",19,"NM",2,0)
XUROUTINE IN^^0
"BLD",549,"KRN",19,"NM","B","XUROUTINE IN",2)

"BLD",549,"KRN",19,"NM","B","XUROUTINE OUT",1)

"BLD",549,"KRN",19.1,0)
19.1
"BLD",549,"KRN",101,0)
101
"BLD",549,"KRN",409.61,0)
409.61
"BLD",549,"KRN",771,0)
771
"BLD",549,"KRN",870,0)
870
"BLD",549,"KRN",8989.51,0)
8989.51
"BLD",549,"KRN",8989.51,"NM",0)
^9.68A^^0
"BLD",549,"KRN",8989.52,0)
8989.52
"BLD",549,"KRN",8989.52,"NM",0)
^9.68A^^
"BLD",549,"KRN",8994,0)
8994
"BLD",549,"KRN",8994.2,0)
8994.2
"BLD",549,"KRN","B",.4,.4)

"BLD",549,"KRN","B",.401,.401)

"BLD",549,"KRN","B",.402,.402)

"BLD",549,"KRN","B",.403,.403)

"BLD",549,"KRN","B",.5,.5)

"BLD",549,"KRN","B",.84,.84)

"BLD",549,"KRN","B",3.6,3.6)

"BLD",549,"KRN","B",3.8,3.8)

"BLD",549,"KRN","B",9.2,9.2)

"BLD",549,"KRN","B",9.8,9.8)

"BLD",549,"KRN","B",19,19)

"BLD",549,"KRN","B",19.1,19.1)

"BLD",549,"KRN","B",101,101)

"BLD",549,"KRN","B",409.61,409.61)

"BLD",549,"KRN","B",771,771)

"BLD",549,"KRN","B",870,870)

"BLD",549,"KRN","B",8989.51,8989.51)

"BLD",549,"KRN","B",8989.52,8989.52)

"BLD",549,"KRN","B",8994,8994)

"BLD",549,"KRN","B",8994.2,8994.2)

"BLD",549,"QUES",0)
^9.62^^
"BLD",549,"REQB",0)
^9.611^4^4
"BLD",549,"REQB",1,0)
XU*8.0*132^2
"BLD",549,"REQB",2,0)
XU*8.0*208^2
"BLD",549,"REQB",3,0)
XU*8.0*210^2
"BLD",549,"REQB",4,0)
XU*8.0*157^2
"BLD",549,"REQB","B","XU*8.0*132",1)

"BLD",549,"REQB","B","XU*8.0*157",4)

"BLD",549,"REQB","B","XU*8.0*208",2)

"BLD",549,"REQB","B","XU*8.0*210",3)

"FIA",200)
NEW PERSON
"FIA",200,0)
^VA(200,
"FIA",200,0,0)
200I
"FIA",200,0,1)
y^y^p^^^^n
"FIA",200,0,10)

"FIA",200,0,11)

"FIA",200,0,"RLRO")

"FIA",200,0,"VR")
8.0^XU
"FIA",200,200)
1
"FIA",200,200,7)

"FIA",200,200,201)

"FIA",200,200,203)

"FIA",200,200.03)
1
"FIA",200,200.03,.01)

"KRN",.4,27,-1)
0^1
"KRN",.4,27,0)
XUSERINQ^3020916.1029^^200^^@^3021024
"KRN",.4,27,"DXS",1,9.2)
S DIP(1)=$S($D(^VA(200,D0,0)):^(0),1:"") S X=$P(DIP(1),U,1)_"  (#"_$S('$D(D0):"",D0<0:"",1:D0)_")"
"KRN",.4,27,"DXS",2,9.2)
S DIP(1)=$S($D(^VA(200,D0,0)):^(0),1:"") S X=$P(DIP(1),U,11),DIP(2)=$G(X) S X=1,X1=DIP(2) S X=$$FMTE^XLFDT(X1,X) S X=X,DIP(3)=$G(X) S X="TD"
"KRN",.4,27,"DXS",3,9.2)
S DIP(2)=$C(59)_$P($G(^DD(200,7,0)),U,3),DIP(1)=$S($D(^VA(200,D0,0)):^(0),1:"") S X=$P($P(DIP(2),$C(59)_$P(DIP(1),U,7)_":",2),$C(59)),DIP(3)=$G(X) S X="DIS"
"KRN",.4,27,"DXS",4,9.2)
S DIP(1)=$S($D(^VA(200,D0,1)):^(1),1:"") S X=$P($G(^VA(200,+$P(DIP(1),U,8),0)),U),DIP(2)=$G(X) S X=19
"KRN",.4,27,"DXS",5,9.2)
S DIP(1)=$S($D(^VA(200,D0,1)):^(1),1:"") S X=$P(DIP(1),U,7),DIP(2)=$G(X) S X=1,X1=DIP(2) S X=$$FMTE^XLFDT(X1,X) S X=X,DIP(3)=$G(X) S X=62
"KRN",.4,27,"DXS",6,9.2)
S DIP(2)=$C(59)_$P($G(^DD(200,200.04,0)),U,3),DIP(1)=$S($D(^VA(200,D0,200)):^(200),1:"") S X=$P($P(DIP(2),$C(59)_$P(DIP(1),U,4)_":",2),$C(59)),DIP(3)=$G(X) S X=19
"KRN",.4,27,"DXS",7,9.2)
S DIP(1)=$S($D(^VA(200,D0,0)):^(0),1:"") S X=$P(DIP(1),U,4),DIP(2)=$G(X) S X=62
"KRN",.4,27,"DXS",8,9.2)
S DIP(1)=$S($D(^VA(200,D0,200)):^(200),1:"") S X=$P(DIP(1),U,10),DIP(2)=$G(X) S X=19
"KRN",.4,27,"DXS",9,9.2)
S DIP(2)=$C(59)_$P($G(^DD(200,200.09,0)),U,3),DIP(1)=$S($D(^VA(200,D0,200)):^(200),1:"") S X=$P($P(DIP(2),$C(59)_$P(DIP(1),U,9)_":",2),$C(59)),DIP(3)=$G(X) S X=62
"KRN",.4,27,"DXS",10,9.2)
S DIP(1)=$S($D(^VA(200,D0,0)):^(0),1:"") S X=$P($G(^DIC(3.1,+$P(DIP(1),U,9),0)),U),DIP(2)=$G(X) S X=19
"KRN",.4,27,"DXS",11,9.2)
S DIP(1)=$S($D(^VA(200,D0,.13)):^(.13),1:"") S X=$P(DIP(1),U,2),DIP(2)=$G(X) S X=62
"KRN",.4,27,"DXS",12,9.2)
S DIP(2)=$C(59)_$P($G(^DD(200,200.06,0)),U,3),DIP(1)=$S($D(^VA(200,D0,200)):^(200),1:"") S X=$P($P(DIP(2),$C(59)_$P(DIP(1),U,6)_":",2),$C(59)),DIP(3)=$G(X) S X=19
"KRN",.4,27,"DXS",13,9.2)
S DIP(1)=$S($D(^VA(200,D0,.13)):^(.13),1:"") S X=$P(DIP(1),U,7),DIP(2)=$G(X) S X=62
"KRN",.4,27,"DXS",14,9.2)
S DIP(1)=$S($D(^VA(200,D0,1.1)):^(1.1),1:"") S X=$P(DIP(1),U,1),DIP(2)=$G(X) S X="1D",X1=DIP(2) S X=$$FMTE^XLFDT(X1,X) S X=X,DIP(3)=$G(X) S X=19
"KRN",.4,27,"DXS",15,9.2)
S DIP(1)=$S($D(^VA(200,D0,.13)):^(.13),1:"") S X=$P(DIP(1),U,8),DIP(2)=$G(X) S X=62
"KRN",.4,27,"DXS",16,9.2)
S X="ESIG",X=$S(X=""!(X'?.ANP):"",$D(DIPA($E(X,1,30))):DIPA($E(X,1,30)),1:"") S X=X,DIP(1)=$G(X) S X=19
"KRN",.4,27,"DXS",17,9.2)
S DIP(2)=$C(59)_$P($G(^DD(200,53.1,0)),U,3),DIP(1)=$S($D(^VA(200,D0,"PS")):^("PS"),1:"") S X=$P($P(DIP(2),$C(59)_$P(DIP(1),U,1)_":",2),$C(59)),DIP(3)=$G(X) S X=62
"KRN",.4,27,"DXS",18,9.2)
S DIP(1)=$S($D(^VA(200,D0,12)):^(12),1:"") S X=$P(DIP(1),U,2),X=X S X=X,DIP(2)=$G(X) S X="POS"
"KRN",.4,27,"DXS",19,9.2)
S X="POS",X=$S(X=""!(X'?.ANP):"",$D(DIPA($E(X,1,30))):DIPA($E(X,1,30)),1:"") S X=X,DIP(1)=$G(X) S X="Clinical Trainee Data",DIP(2)=$G(X) S X=1,DIP(3)=$G(X) S X=""
"KRN",.4,27,"DXS",20,9)
X DXS(20,9.2) S X1=DIP(3) S %=X,X="" S:X1]"" $P(X,X1,%\$L(X1)+1)=X1,X=$E(X,1,%) S X=X,DIP(4)=$G(X) S X=1,DIP(5)=$G(X) S X="",X=$S(DIP(1):DIP(4),DIP(5):X)
"KRN",.4,27,"DXS",20,9.2)
S X="POS",X=$S(X=""!(X'?.ANP):"",$D(DIPA($E(X,1,30))):DIPA($E(X,1,30)),1:"") S X=X,DIP(1)=$G(X),DIP(2)=$G(X) S X="-",DIP(3)=$G(X) S X=21
"KRN",.4,27,"DXS",21,9.2)
S DIP(3)=$C(59)_$P($G(^DD(200,12.1,0)),U,3),DIP(2)=$S($D(^VA(200,D0,12)):^(12),1:"") S X="POS"
"KRN",.4,27,"DXS",21,9.3)
X DXS(21,9.2) S X=$S(X=""!(X'?.ANP):"",$D(DIPA($E(X,1,30))):DIPA($E(X,1,30)),1:"") S X=X,DIP(1)=$G(X) S X="        Degree level: "_$P($P(DIP(3),$C(59)_$P(DIP(2),U,1)_":",2),$C(59))
"KRN",.4,27,"DXS",22,9)
X DXS(22,9.2) S X=X_$P($G(^USC(8932.2,+$P(DIP(2),U,2),0)),U),DIP(3)=$G(X) S X=1,DIP(4)=$G(X) S X="",X=$S(DIP(1):DIP(3),DIP(4):X)
"KRN",.4,27,"DXS",22,9.2)
S DIP(2)=$S($D(^VA(200,D0,12)):^(12),1:"") S X="POS",X=$S(X=""!(X'?.ANP):"",$D(DIPA($E(X,1,30))):DIPA($E(X,1,30)),1:"") S X=X,DIP(1)=$G(X) S X="    Program of Study: "
"KRN",.4,27,"DXS",23,9.2)
S DIP(2)=$S($D(^VA(200,D0,12)):^(12),1:"") S X="POS",X=$S(X=""!(X'?.ANP):"",$D(DIPA($E(X,1,30))):DIPA($E(X,1,30)),1:"") S X=X,DIP(1)=$G(X) S X="  Last Training Year: "
"KRN",.4,27,"DXS",24,9.2)
S X="POS",X=$S(X=""!(X'?.ANP):"",$D(DIPA($E(X,1,30))):DIPA($E(X,1,30)),1:"") S X=X,DIP(1)=$G(X) S X=" ",DIP(2)=$G(X) S X=1,DIP(3)=$G(X) S X=""
"KRN",.4,27,"DXS",25,9.2)
S I(0,0)=$G(D0),DIP(1)=$S($D(^VA(200,D0,201)):^(201),1:""),D0=$P(DIP(1),U,1) S:'D0!'$D(^DIC(19,+D0,0)) D0=-1 S DIP(101)=$S($D(^DIC(19,D0,0)):^(0),1:"")
"KRN",.4,27,"DXS",26,9.2)
S I(1,0)=$G(D1),I(0,0)=$G(D0),DIP(1)=$S($D(^VA(200,D0,203,D1,0)):^(0),1:""),D0=$P(DIP(1),U,1) S:'D0!'$D(^DIC(19,+D0,0)) D0=-1 S DIP(101)=$S($D(^DIC(19,D0,0)):^(0),1:"")
"KRN",.4,27,"DXS",27,9)
W:$O(^VA(200,D0,"ORD",0)) !?2,"Name  Description",?46,"Effective   Expiration",!?2,"----  -----------",?46,"---------   ----------"
"KRN",.4,27,"DXS",28,9.2)
S I(1,0)=$G(D1),I(0,0)=$G(D0),DIP(1)=$S($D(^VA(200,D0,"ORD",D1,0)):^(0),1:""),D0=$P(DIP(1),U,1) S:'D0!'$D(^ORD(101.13,+D0,0)) D0=-1 S DIP(101)=$S($D(^ORD(101.13,D0,0)):^(0),1:"")
"KRN",.4,27,"DXS",29,0)
NO
"KRN",.4,27,"DXS",29,1)
YES
"KRN",.4,27,"F",1)
X DXS(1,9.2) S %=$L(X),%1=$X,$P(%2,"-",%)="-" W X,!,?%1,%2 K %1,%2 S X="" W X K DIP;C1;"";Z;"XUDASH(NAME_"  (#"_NUMBER_")")"~
"KRN",.4,27,"F",2)
X DXS(2,9.2) S X1=DIP(3) S:X]""&(X?.ANP)&(X1'[U)&(X1'["$C(94)") DIPA($E(X,1,30))=X1 S X="" W X K DIP;"";X;Z;"SETPARAM(XUFMTOEX(TERMINATION DATE,1),"TD")"~
"KRN",.4,27,"F",3)
W:$L($P(^VA(200,D0,0),U,11)) !,*7,?3,"Terminated: ",DIPA("TD");Z;"W:$L($P(^VA(200,D0,0),U,11)) !,*7,?3,"Terminated: ",DIPA("TD")"~
"KRN",.4,27,"F",4)
X DXS(3,9.2) S X1=DIP(3) S:X]""&(X?.ANP)&(X1'[U)&(X1'["$C(94)") DIPA($E(X,1,30))=X1 S X="" W X K DIP;"";X;Z;"SETPARAM(DISUSER,"DIS")"~
"KRN",.4,27,"F",5)
W:DIPA("DIS")["Y" !,?3,"Disuser: ",DIPA("DIS");Z;"W:DIPA("DIS")["Y" !,?3,"Disuser: ",DIPA("DIS")"~D INQ^XUS9 S X="";Z;"D INQ^XUS9 S X="""~
"KRN",.4,27,"F",6)
S X="ATTRIBUTES",%=$L(X),%1=$X,$P(%2,"-",%)="-" W X,!,?%1,%2 K %1,%2 S X="" W X K DIP;C1;S1;Z;"XUDASH("ATTRIBUTES")"~"Creator";C3;""~
"KRN",.4,27,"F",7)
X DXS(4,9.2) S X1=DIP(2) S %=$X,%1=$S(X>%:X-%,1:0),%="",$P(%,".",%1)="." W %,X1 K %,%1 S (X,X1)="" W X K DIP;"";Z;"XUDOTTAB(CREATOR,19)"~
"KRN",.4,27,"F",8)
S X="Date entered" W X K DIP;C43;";Z;""Date entered""~
"KRN",.4,27,"F",9)
X DXS(5,9.2) S X1=DIP(3) S %=$X,%1=$S(X>%:X-%,1:0),%="",$P(%,".",%1)="." W %,X1 K %,%1 S (X,X1)="" W X K DIP;"";Z;"XUDOTTAB(XUFMTOEX(DATE ENTERED,1),62)"~
"KRN",.4,27,"F",10)
"Mult Sign-on";C3~
"KRN",.4,27,"F",11)
X DXS(6,9.2) S X1=DIP(3) S %=$X,%1=$S(X>%:X-%,1:0),%="",$P(%,".",%1)="." W %,X1 K %,%1 S (X,X1)="" W X K DIP;"";Z;"XUDOTTAB(MULTIPLE SIGN-ON,19)"~
"KRN",.4,27,"F",12)
"Fileman codes";C43~
"KRN",.4,27,"F",13)
X DXS(7,9.2) S X1=DIP(2) S %=$X,%1=$S(X>%:X-%,1:0),%="",$P(%,".",%1)="." W %,X1 K %,%1 S (X,X1)="" W X K DIP;"";Z;"XUDOTTAB(FILE MANAGER ACCESS CODE,62)"~
"KRN",.4,27,"F",14)
"Time-out";C3~
"KRN",.4,27,"F",15)
X DXS(8,9.2) S X1=DIP(2) S %=$X,%1=$S(X>%:X-%,1:0),%="",$P(%,".",%1)="." W %,X1 K %,%1 S (X,X1)="" W X K DIP;"";Z;"XUDOTTAB(TIMED READ,19)"~
"KRN",.4,27,"F",16)
"Type-ahead";C43~
"KRN",.4,27,"F",17)
X DXS(9,9.2) S X1=DIP(3) S %=$X,%1=$S(X>%:X-%,1:0),%="",$P(%,".",%1)="." W %,X1 K %,%1 S (X,X1)="" W X K DIP;"";Z;"XUDOTTAB(TYPE-AHEAD,62)"~
"KRN",.4,27,"F",18)
"Title";C3;""~X DXS(10,9.2) S X1=DIP(2) S %=$X,%1=$S(X>%:X-%,1:0),%="",$P(%,".",%1)="." W %,X1 K %,%1 S (X,X1)="" W X K DIP;"";Z;"XUDOTTAB(TITLE,19)"~
"KRN",.4,27,"F",19)
"Office Phone";C43~
"KRN",.4,27,"F",20)
X DXS(11,9.2) S X1=DIP(2) S %=$X,%1=$S(X>%:X-%,1:0),%="",$P(%,".",%1)="." W %,X1 K %,%1 S (X,X1)="" W X K DIP;"";Z;"XUDOTTAB(OFFICE PHONE,62)"~
"KRN",.4,27,"F",21)
"Auto-Menu";C3;""~
"KRN",.4,27,"F",22)
X DXS(12,9.2) S X1=DIP(3) S %=$X,%1=$S(X>%:X-%,1:0),%="",$P(%,".",%1)="." W %,X1 K %,%1 S (X,X1)="" W X K DIP;"";Z;"XUDOTTAB(AUTO MENU,19)"~
"KRN",.4,27,"F",23)
"Voice Pager";C43~
"KRN",.4,27,"F",24)
X DXS(13,9.2) S X1=DIP(2) S %=$X,%1=$S(X>%:X-%,1:0),%="",$P(%,".",%1)="." W %,X1 K %,%1 S (X,X1)="" W X K DIP;"";Z;"XUDOTTAB(VOICE PAGER,62)"~
"KRN",.4,27,"F",25)
"Last Sign-on";C3~
"KRN",.4,27,"F",26)
X DXS(14,9.2) S X1=DIP(3) S %=$X,%1=$S(X>%:X-%,1:0),%="",$P(%,".",%1)="." W %,X1 K %,%1 S (X,X1)="" W X K DIP;"";Z;"XUDOTTAB(XUFMTOEX(LAST SIGN,"1D"),19)"~
"KRN",.4,27,"F",27)
"Digital Pager";C43~
"KRN",.4,27,"F",28)
X DXS(15,9.2) S X1=DIP(2) S %=$X,%1=$S(X>%:X-%,1:0),%="",$P(%,".",%1)="." W %,X1 K %,%1 S (X,X1)="" W X K DIP;"";Z;"XUDOTTAB(DIGITAL PAGER,62)"~
"KRN",.4,27,"F",29)
"Has a E-SIG";C3~
"KRN",.4,27,"F",30)
S DIPA("ESIG")=$S($L($P($G(^VA(200,D0,20)),U,4)):"Yes",1:"No");"";X;Z;"S DIPA("ESIG")=$S($L($P($G(^VA(200,D0,20)),U,4)):"Yes",1:"No")"~
"KRN",.4,27,"F",31)
X DXS(16,9.2) S X1=DIP(1) S %=$X,%1=$S(X>%:X-%,1:0),%="",$P(%,".",%1)="." W %,X1 K %,%1 S (X,X1)="" W X K DIP;"";Z;"XUDOTTAB(PARAM("ESIG"),19)"~
"KRN",.4,27,"F",32)
"Write Med's";C43~
"KRN",.4,27,"F",33)
X DXS(17,9.2) S X1=DIP(3) S %=$X,%1=$S(X>%:X-%,1:0),%="",$P(%,".",%1)="." W %,X1 K %,%1 S (X,X1)="" W X K DIP;"";Z;"XUDOTTAB(AUTHORIZED TO WRITE,62)"~
"KRN",.4,27,"F",34)
" ";C1~"Person Class: ";C3~D SHPC^XUSER1(D0);Z;"D SHPC^XUSER1(D0)"~" ";C1~
"KRN",.4,27,"F",35)
X DXS(18,9.2) S X1=DIP(2) S:X]""&(X?.ANP)&(X1'[U)&(X1'["$C(94)") DIPA($E(X,1,30))=X1 S X="" W X K DIP;X;Z;"SETPARAM(INTERNAL(#12.2),"POS")"~
"KRN",.4,27,"F",36)
X DXS(19,9.2) S X=$S(DIP(1):DIP(2),DIP(3):X) W X K DIP;X;C1;Z;"$S(PARAM("POS"):"Clinical Trainee Data",1:"")"~
"KRN",.4,27,"F",37)
X DXS(20,9) W X K DIP;X;C1;Z;"$S(PARAM("POS"):DUP("-",21),1:"")"~
"KRN",.4,27,"F",38)
X DXS(21,9.3) S DIP(4)=$G(X) S X=1,DIP(5)=$G(X) S X="",X=$S(DIP(1):DIP(4),DIP(5):X) W X K DIP;X;C1;Z;"$S(PARAM("POS"):"        Degree level: "_#12.1,1:"")"~
"KRN",.4,27,"F",39)
X DXS(22,9) W X K DIP;X;C1;Z;"$S(PARAM("POS"):"    Program of Study: "_#12.2,1:"")"~
"KRN",.4,27,"F",40)
X DXS(23,9.2) S X=X_$P(DIP(2),U,3),DIP(3)=$G(X) S X=1,DIP(4)=$G(X) S X="",X=$S(DIP(1):DIP(3),DIP(4):X) W X K DIP;X;C1;Z;"$S(PARAM("POS"):"  Last Training Year: "_#12.3,1:"")"~
"KRN",.4,27,"F",41)
X DXS(24,9.2) S X=$S(DIP(1):DIP(2),DIP(3):X) W X K DIP;X;C1;Z;"$S(PARAM("POS"):" ",1:"")"~
"KRN",.4,27,"F",42)
S DIP(1)=$S($D(^VA(200,D0,201)):^(201),1:"") S X="Primary Menu: "_$P($G(^DIC(19,+$P(DIP(1),U,1),0)),U) W X K DIP;C1;Z;""Primary Menu: "_PRIMARY MENU"~
"KRN",.4,27,"F",43)
X DXS(25,9.2) S X=$P(DIP(101),U,2) S D0=I(0,0) W X K DIP;C40;"";Z;"PRIMARY MENU:MENU TEXT"~
"KRN",.4,27,"F",44)
S X="Secondary Menu(s)",%=$L(X),%1=$X,$P(%2,"-",%)="-" W X,!,?%1,%2 K %1,%2 S X="" W X K DIP;C1;Z;"XUDASH("Secondary Menu(s)")"~203,2;C2;""~
"KRN",.4,27,"F",45)
203,S DIP(1)=$S($D(^VA(200,D0,203,D1,0)):^(0),1:"") S X="["_$P($G(^DIC(19,+$P(DIP(1),U,1),0)),U)_"]" W X K DIP;C8;"";Z;""["_SECONDARY MENU OPTIONS_"]""~
"KRN",.4,27,"F",46)
203,X DXS(26,9.2) S X=$P(DIP(101),U,2) S D0=I(0,0) S D1=I(1,0) W X K DIP;C42;"";Z;".01:MENU TEXT"~
"KRN",.4,27,"F",47)
S X="Keys Held",%=$L(X),%1=$X,$P(%2,"-",%)="-" W X,!,?%1,%2 K %1,%2 S X="" W X K DIP;S1;Z;"XUDASH("Keys Held")"~
"KRN",.4,27,"F",48)
D GKEYS^XUSER1(D0,.DIP),SHLIST^XUSER1(.DIP,3,4);Z;"D GKEYS^XUSER1(D0,.DIP),SHLIST^XUSER1(.DIP,3,4)"~
"KRN",.4,27,"F",49)
S X="Patient Selection",%=$L(X),%1=$X,$P(%2,"-",%)="-" W X,!,?%1,%2 K %1,%2 S X="" W X K DIP;S1;Z;"XUDASH("Patient Selection")"~"Restrict?:";C3~
"KRN",.4,27,"F",50)
101.01;C14~"OE/RR List:";C2~101.02;C14;""~
"KRN",.4,27,"F",51)
S X="CPRS Access Tabs",%=$L(X),%1=$X,$P(%2,"-",%)="-" W X,!,?%1,%2 K %1,%2 S X="" W X K DIP;S1;Z;"XUDASH("CPRS Access Tabs")"~
"KRN",.4,27,"F",52)
X DXS(27,9);Z;"W:$O(^VA(200,D0,"ORD",0)) !?2,"Name  Description",?46,"Effective   Expiration",!?2,"----  -----------",?46,"---------   ----------""~
"KRN",.4,27,"F",53)
101.13,.01;C3;X~101.13,X DXS(28,9.2) S X=$P(DIP(101),U,2) S D0=I(0,0) S D1=I(1,0) W X K DIP;C9;X;Z;"CPRS TAB:TAB DESCRIPTION"~101.13,.02;C46;X~
"KRN",.4,27,"F",54)
101.13,.03;C59;X~S X="CPRS Parameter info (User Specific)",%=$L(X),%1=$X,$P(%2,"-",%)="-" W X,!,?%1,%2 K %1,%2 S X="" W X K DIP;S1;Z;"XUDASH("CPRS Parameter info (User Specific)")"~
"KRN",.4,27,"F",55)
D GPARAM^XUSER1(D0,"ORWOR WRITE ORDERS LIST",.DIP),SHLIST^XUSER1(.DIP,3,3);"";Z;"D GPARAM^XUSER1(D0,"ORWOR WRITE ORDERS LIST",.DIP),SHLIST^XUSER1(.DIP,3,3)"~
"KRN",.4,27,"F",56)
D GPARAM^XUSER1(D0,"ORWDX WRITE ORDERS LIST",.DIP),SHLIST^XUSER1(.DIP,3,3);"";Z;"D GPARAM^XUSER1(D0,"ORWDX WRITE ORDERS LIST",.DIP),SHLIST^XUSER1(.DIP,3,3)"~
"KRN",.4,27,"F",57)
D GPARAM^XUSER1(D0,"OR ADD ORDERS MENU",.DIP),SHLIST^XUSER1(.DIP,3,3);Z;"D GPARAM^XUSER1(D0,"OR ADD ORDERS MENU",.DIP),SHLIST^XUSER1(.DIP,3,3)"~"";S1~
"KRN",.4,27,"F",58)
S Y=IOSL N IOSL S IOSL=$S(IOST["P-":999,1:Y),Y=D0 D EN^XMA7;Z;"S Y=IOSL N IOSL S IOSL=$S(IOST["P-":999,1:Y),Y=D0 D EN^XMA7"~"";S1~
"KRN",.4,27,"H")
@
"KRN",.4,27,"IOM")
80
"KRN",.4,27,"LAST")
1
"KRN",.4,27,"ROU")
^XUCT01
"KRN",.4,27,"ROUOLD")
XUCT01
"KRN",.4,27,"SUB")
1
"KRN",19,491,-1)
0^1
"KRN",19,491,0)
XUROUTINE OUT^Output routines^^A^^^^^^^^^n^1^^
"KRN",19,491,1,0)
^^1^1^2890608^^^^
"KRN",19,491,1,1,0)
This routine will output routines to an external device such as a magtape.
"KRN",19,491,20)
D @$S('$D(^%ZOSF("OS")):"^%RS",^("OS")["OpenM":"^%RO",^("OS")["DTM":"^%rsave",1:"^%RS")
"KRN",19,491,"U")
OUTPUT ROUTINES
"KRN",19,492,-1)
0^2
"KRN",19,492,0)
XUROUTINE IN^Input routines^^A^^XUPROG^^^^^^^n^1^^
"KRN",19,492,1,0)
^^2^2^2880401^^^
"KRN",19,492,1,1,0)
Loads routines from an external device, like magtape.
"KRN",19,492,1,2,0)
**DO NOT USE THIS OPTION IF YOU AREN'T SURE HOW TO RUN IT!!**
"KRN",19,492,20)
D @$S('$D(^%ZOSF("OS")):"^%RR",^("OS")["OpenM":"^%RI",^("OS")["DTM":"^%rload",1:"^%RR")
"KRN",19,492,"U")
INPUT ROUTINES
"MBREQ")
0
"ORD",5,.4)
.4;5;;;EDEOUT^DIFROMSO(.4,DA,"",XPDA);FPRE^DIFROMSI(.4,"",XPDA);EPRE^DIFROMSI(.4,DA,$E("N",$G(XPDNEW)),XPDA,"",OLDA);;EPOST^DIFROMSI(.4,DA,"",XPDA);DEL^DIFROMSK(.4,"",%)
"ORD",5,.4,0)
PRINT TEMPLATE
"ORD",18,19)
19;18;;;OPT^XPDTA;OPTF1^XPDIA;OPTE1^XPDIA;OPTF2^XPDIA;;OPTDEL^XPDIA
"ORD",18,19,0)
OPTION
"PKG",3,-1)
1^1
"PKG",3,0)
KERNEL^XU^SIGN-ON, SECURITY, MENU DRIVER, DEVICES, TASKMAN^
"PKG",3,20,0)
^9.402P^^0
"PKG",3,22,0)
^9.49I^1^1
"PKG",3,22,1,0)
8.0^2950703^2970507^.5
"PKG",3,22,1,"PAH",1,0)
222^3021106^2
"PKG",3,22,1,"PAH",1,1,0)
^^2^2^3021106
"PKG",3,22,1,"PAH",1,1,1,0)
Please refer to the Description in FORUM Patch Module for details.
"PKG",3,22,1,"PAH",1,1,2,0)
XU*8*222 7 NOIS AND 2 E3R
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
5
"RTN","XUA4A72")
0^6^B14112901
"RTN","XUA4A72",1,0)
XUA4A72 ;SFISC/RWF - Person class API's ;09/09/2002  14:09
"RTN","XUA4A72",2,0)
 ;;8.0;KERNEL;**27,49,74,132,222**;Jul 10, 1995
"RTN","XUA4A72",3,0)
 Q  ;No access from top.
"RTN","XUA4A72",4,0)
GET(IEN,DATE) ;sr. Get the active class on a date
"RTN","XUA4A72",5,0)
 ;IEN of user.
"RTN","XUA4A72",6,0)
 N X1,Y1,D
"RTN","XUA4A72",7,0)
 S:$G(DATE)="" DATE=DT S D=DATE
"RTN","XUA4A72",8,0)
 ;The return is file 200 ien_^_NODE
"RTN","XUA4A72",9,0)
 S X1=$$GETUE(IEN,DATE) I X1'>0 Q X1
"RTN","XUA4A72",10,0)
 S X1=$P(X1,"^",2,99) ;or X1=^VA(200,IEN,"USC1",+X1,0)
"RTN","XUA4A72",11,0)
 S Y1=$G(^USC(8932.1,+X1,0))
"RTN","XUA4A72",12,0)
 ;IEN^Occupation^specialty^sub-specialty^Effective date^expiration date^VA Code^specialty code
"RTN","XUA4A72",13,0)
 Q +X1_U_$P(Y1,U,1,3)_U_$P(X1,U,2,3)_U_$P(Y1,U,6)_U_$P(Y1,U,9)
"RTN","XUA4A72",14,0)
 ;
"RTN","XUA4A72",15,0)
IEN2CODE(IEN) ;sr. Get the code for an IEN
"RTN","XUA4A72",16,0)
 Q $P($G(^USC(8932.1,+$G(IEN),0)),U,6)
"RTN","XUA4A72",17,0)
 ;
"RTN","XUA4A72",18,0)
IEN2DATA(IEN) ;Get person class data for an IEN
"RTN","XUA4A72",19,0)
 Q $G(^USC(8932.1,+$G(IEN),0))
"RTN","XUA4A72",20,0)
 ;
"RTN","XUA4A72",21,0)
CODE2TXT(CODE) ;sr. Convert IEN or V-code to text
"RTN","XUA4A72",22,0)
 I CODE?1"V"1.N S CODE=$$VCLK(CODE)
"RTN","XUA4A72",23,0)
 Q $P($G(^USC(8932.1,+CODE,0)),U,1,3)
"RTN","XUA4A72",24,0)
 ;
"RTN","XUA4A72",25,0)
VCLK(X) ;Lookup a V-code, Return IEN
"RTN","XUA4A72",26,0)
 Q $O(^USC(8932.1,"F",X,0))
"RTN","XUA4A72",27,0)
 ;
"RTN","XUA4A72",28,0)
GETUE(IEN,DATE) ;private, Get the user entry
"RTN","XUA4A72",29,0)
 N D,X,Y
"RTN","XUA4A72",30,0)
 S D=DATE
"RTN","XUA4A72",31,0)
 Q:'$D(^VA(200,+$G(IEN),0)) -1
"RTN","XUA4A72",32,0)
 Q:$O(^VA(200,IEN,"USC1",0))="" -1
"RTN","XUA4A72",33,0)
 S:'$D(^VA(200,IEN,"USC1","AD",D)) D=$O(^VA(200,IEN,"USC1","AD",D),-1)
"RTN","XUA4A72",34,0)
 S Y=$O(^VA(200,IEN,"USC1","AD",+D,""),-1) Q:Y'>0 -2
"RTN","XUA4A72",35,0)
 ;Check that class was active on this date
"RTN","XUA4A72",36,0)
 S X=$G(^VA(200,IEN,"USC1",+Y,0))_"^^" I $P(X,U,3),$P(X,U,3)<DATE Q -2
"RTN","XUA4A72",37,0)
 Q +Y_"^"_X
"RTN","XUA4A72",38,0)
 ;
"RTN","XUA4A72",39,0)
REMOVE ;Allow privileged user to remove a wrong entry in the users file.
"RTN","XUA4A72",40,0)
 N XUDA,XUDA1,XUWT,%
"RTN","XUA4A72",41,0)
 S XUDA1=+$$LOOKUP^XUSER Q:XUDA1'>0
"RTN","XUA4A72",42,0)
 W !,"This user has the following Person Class enties:"
"RTN","XUA4A72",43,0)
 S XUWT=^DD(8932.1,0,"ID","WRITE")
"RTN","XUA4A72",44,0)
 F XUDA=0:0 S XUDA=$O(^VA(200,XUDA1,"USC1",XUDA)) Q:XUDA'>0  S %=+$G(^(XUDA,0)) I %>0 W !,$P(^USC(8932.1,%,0),U) X XUWT
"RTN","XUA4A72",45,0)
 S DIR(0)="Y",DIR("A")="Are you sure you want to remove ALL these entries" D ^DIR Q:$D(DIRUT)!(Y'=1)
"RTN","XUA4A72",46,0)
 F XUDA=0:0 S XUDA=$O(^VA(200,XUDA1,"USC1",XUDA)) Q:XUDA'>0  S DIK="^VA(200,DA(1),""USC1"",",DA=XUDA,DA(1)=XUDA1 D ^DIK
"RTN","XUA4A72",47,0)
 Q
"RTN","XUA4A72",48,0)
 ;
"RTN","XUA4A72",49,0)
TERM(IEN,DATE) ;Called from XUSTERM, Set the expiration date for a user being terminated.
"RTN","XUA4A72",50,0)
 N Y1
"RTN","XUA4A72",51,0)
 Q:$G(DATE)'>0
"RTN","XUA4A72",52,0)
 S Y1=$$GETUE(IEN,DATE)
"RTN","XUA4A72",53,0)
 I $L($P(Y1,"^",4)) Q
"RTN","XUA4A72",54,0)
 D OLD(IEN,+Y1,DATE)
"RTN","XUA4A72",55,0)
 Q
"RTN","XUA4A72",56,0)
 ;
"RTN","XUA4A72",57,0)
SET01 ;Called from the X-ref on the .01 field
"RTN","XUA4A72",58,0)
 Q:$P(^VA(200,DA(1),"USC1",DA,0),U,2)>0
"RTN","XUA4A72",59,0)
 S $P(^VA(200,DA(1),"USC1",DA,0),U,2)=DT ;Trigger date
"RTN","XUA4A72",60,0)
 D UPDATE(200.05,2,DT)
"RTN","XUA4A72",61,0)
 ;
"RTN","XUA4A72",62,0)
SET2 ;Call from the X-ref on the Effective Date field
"RTN","XUA4A72",63,0)
 N L
"RTN","XUA4A72",64,0)
 S L=$O(^VA(200,DA(1),"USC1",DA),-1) Q:L'>0
"RTN","XUA4A72",65,0)
 I $P(^VA(200,DA(1),"USC1",L,0),U,3)="" D OLD(DA(1),L,X) ;Inactivate the old one
"RTN","XUA4A72",66,0)
 Q
"RTN","XUA4A72",67,0)
KILL2 ;Call from the X-ref on the Effective Date field
"RTN","XUA4A72",68,0)
 N L
"RTN","XUA4A72",69,0)
 S L=$O(^VA(200,DA(1),"USC1",DA),-1) Q:L'>0
"RTN","XUA4A72",70,0)
 I $P(^VA(200,DA(1),"USC1",L,0),U,3)=X D OLD(DA(1),L,"")
"RTN","XUA4A72",71,0)
 Q
"RTN","XUA4A72",72,0)
 ;
"RTN","XUA4A72",73,0)
OLD(D0,D1,DATE) ;Inactivate the old one (Expiration Date)
"RTN","XUA4A72",74,0)
 N DA,X
"RTN","XUA4A72",75,0)
 S $P(^VA(200,D0,"USC1",D1,0),U,3)=DATE ;Inactivate the old one
"RTN","XUA4A72",76,0)
 S DA(1)=D0,DA=D1 D UPDATE(200.05,3,DATE)
"RTN","XUA4A72",77,0)
 Q
"RTN","XUA4A72",78,0)
UPDATE(DIH,DIG,DIV,DIU) ;file,field,new value,old value
"RTN","XUA4A72",79,0)
 S DIV=$G(DIV),DIU=$G(DIU),DIV(0)=DA(1),DIV(1)=DA
"RTN","XUA4A72",80,0)
 D ^DICR:$O(^DD(DIH,DIG,1,0))>0
"RTN","XUA4A72",81,0)
 Q
"RTN","XUA4A72",82,0)
DDS1 ;Called from Pre-action person class field
"RTN","XUA4A72",83,0)
 N %,XUDA,XU
"RTN","XUA4A72",84,0)
 I X]"" S %=^USC(8932.1,X,0),XU(1)=$P(%,U,1),XU(2)="  "_$P(%,U,2),XU(3)="    "_$P(%,U,3) D HLP^DDSUTL(.XU)
"RTN","XUA4A72",85,0)
 Q:DA'>0  M XUDA=DA N DA ;Hide DA
"RTN","XUA4A72",86,0)
 S %=$$GET^DDSVAL(DIE,.XUDA,3,"","I"),%=$S(%>0:1,1:0)
"RTN","XUA4A72",87,0)
 D UNED^DDSUTL(2,,,%),UNED^DDSUTL(3,,,%)
"RTN","XUA4A72",88,0)
 Q
"RTN","XUA4A72",89,0)
DDS2 ;Called from effective date on form
"RTN","XUA4A72",90,0)
 N %,XUDA M XUDA=DA N DA ;Hide DA
"RTN","XUA4A72",91,0)
 S XUDA=$O(^VA(200,XUDA(1),"USC1",XUDA),-1) Q:XUDA'>0
"RTN","XUA4A72",92,0)
 S %=$$GET^DDSVAL(DIE,.XUDA,3,"","I") Q:%&(%<X)  ;Already has value
"RTN","XUA4A72",93,0)
 D PUT^DDSVAL(DIE,.XUDA,3,X,"","I")
"RTN","XUA4A72",94,0)
 Q
"RTN","XUA4A72",95,0)
DDS3(%) ;Data validation
"RTN","XUA4A72",96,0)
 I %=2,$$GET^DDSVAL(DIE,.DA,3,"","I")]"" D
"RTN","XUA4A72",97,0)
 . S DDSERROR=1
"RTN","XUA4A72",98,0)
 . D HLP^DDSUTL("This field is uneditable because Expired Date already has data")
"RTN","XUA4A72",99,0)
 . Q
"RTN","XUA4A72",100,0)
 I %=3,DDSOLD]"",X'=DDSOLD D
"RTN","XUA4A72",101,0)
 . S DDSERROR=1
"RTN","XUA4A72",102,0)
 . D HLP^DDSUTL("You cannot change the value of this field.")
"RTN","XUA4A72",103,0)
 . Q
"RTN","XUA4A72",104,0)
 Q
"RTN","XUSER1")
0^1^B7947642
"RTN","XUSER1",1,0)
XUSER1 ;ISF/RWF - User file Utilities ;10/24/2002  15:57
"RTN","XUSER1",2,0)
 ;;8.0;KERNEL;**169,210,222**;Jul 10, 1995
"RTN","XUSER1",3,0)
 Q
"RTN","XUSER1",4,0)
 ;
"RTN","XUSER1",5,0)
PAGE() ;Do a page break; Return 0 if ok to continue, 1 if to abort
"RTN","XUSER1",6,0)
 N DIR
"RTN","XUSER1",7,0)
 S DIR(0)="E" D ^DIR:($E(IOST,1,2)["C-")
"RTN","XUSER1",8,0)
 Q:$D(DIRUT) 1 W @IOF S ($X,$Y)=0
"RTN","XUSER1",9,0)
 Q 0
"RTN","XUSER1",10,0)
 ;
"RTN","XUSER1",11,0)
GKEYS(IE,XUA) ;Get the keys held. IE=user
"RTN","XUSER1",12,0)
 N %,V,XUB
"RTN","XUSER1",13,0)
 S %=0 ;Sort list alphabetical
"RTN","XUSER1",14,0)
 F  S %=$O(^VA(200,IE,51,%)) Q:(%'>0)  S V=$P($G(^DIC(19.1,%,0)),U,1) I $L(V) S XUB(V)=""
"RTN","XUSER1",15,0)
 S V="" ;return to user
"RTN","XUSER1",16,0)
 F %=1:1 S V=$O(XUB(V)) Q:'$L(V)  S XUA(%)=V
"RTN","XUSER1",17,0)
 Q
"RTN","XUSER1",18,0)
 ;
"RTN","XUSER1",19,0)
SHLIST(ARRAY,LM,SP) ; Show a list, Array=list, LM=Left Margin, SP=spacing
"RTN","XUSER1",20,0)
 ;Set DN=0 to get FM22 to stop the print
"RTN","XUSER1",21,0)
 N %,Y2,Y4,Y5,Y6,DIR
"RTN","XUSER1",22,0)
 I $Y+4>IOSL,$$PAGE S DN=0 Q
"RTN","XUSER1",23,0)
 S Y4=-1,%=0,Y2=IOM-LM\SP,Y5=0
"RTN","XUSER1",24,0)
 F  S %=$O(ARRAY(%)),Y4=Y4+1 Q:(%'>0)!$D(DIRUT)  S Y6=$G(ARRAY(%)) D:$L(Y6)
"RTN","XUSER1",25,0)
 . S:Y4'<SP Y4=0 S Y5=(Y4*Y2+LM)
"RTN","XUSER1",26,0)
 . I $X>0,Y5+$L(Y6)'<IOM S Y4=0,Y5=(Y4*Y2+LM)
"RTN","XUSER1",27,0)
 . I 'Y4 W ! I $Y+3>IOSL S Y4=0,Y5=(Y4*Y2+LM) I $$PAGE S DN=0 Q
"RTN","XUSER1",28,0)
 . W ?Y5,Y6 S:(($X+1)>(Y5+Y2)) Y4=Y4+1
"RTN","XUSER1",29,0)
 . Q
"RTN","XUSER1",30,0)
 Q
"RTN","XUSER1",31,0)
 ;
"RTN","XUSER1",32,0)
SHPC(IE) ;Show the Person Class
"RTN","XUSER1",33,0)
 N %,Y S:'$D(DT) DT=$$DT^XLFDT
"RTN","XUSER1",34,0)
 S %=$X,Y=$$GET^XUA4A72(IE,DT)
"RTN","XUSER1",35,0)
 I $L(Y) W $P(Y,U,2) I $L($P(Y,U,3)) W !,?(%+2),$P(Y,U,3) I $L($P(Y,U,4)) W !,?(%+4),$P(Y,U,4)
"RTN","XUSER1",36,0)
 Q
"RTN","XUSER1",37,0)
GMG(IE,XUA) ;Get mail groups
"RTN","XUSER1",38,0)
 N %,Y,XUI,Y4,Y2,XUK
"RTN","XUSER1",39,0)
 S %=0
"RTN","XUSER1",40,0)
 F  S %=$O(^XMB(3.8,"AB",IE,%)) Q:%'>0  S XUA(%)=$P($G(^XMB(3.8,%,0)),U,1)
"RTN","XUSER1",41,0)
 Q
"RTN","XUSER1",42,0)
GPARAM(IE,PRAM,XUA) ;Get an entry from the Parameter tool
"RTN","XUSER1",43,0)
 ;IE is the user to get the list for. PARAM what parameter, XUA return array.
"RTN","XUSER1",44,0)
 N XUENT,XUX,XUERR,XU1
"RTN","XUSER1",45,0)
 S XUENT=IE_";VA(200,"_$S($G(^VA(200,IE,5)):"^SRV.`"_+$G(^(5)),1:""),XUA=""
"RTN","XUSER1",46,0)
 D GETLST^XPAR(.XUX,XUENT,PRAM,"E",.XUERR)
"RTN","XUSER1",47,0)
 Q:XUX'>0
"RTN","XUSER1",48,0)
 S XUA(.5)=PRAM_":"
"RTN","XUSER1",49,0)
 F %=1:1:XUX S XUA(%)=$P(XUX(%),U,2)
"RTN","XUSER1",50,0)
 Q
"RTN","XUSER1",51,0)
 ;
"RTN","XUSER1",52,0)
DIVCHG ;Allow user to change Division [DUZ(2)] value
"RTN","XUSER1",53,0)
 ;Called from option: XUSER DIV CHG
"RTN","XUSER1",54,0)
 N Y,X,DIC,I,CD
"RTN","XUSER1",55,0)
 I '$D(^VA(200,+$G(DUZ),0))#2 W !,"You are not a valid user.",!!,$C(7) Q
"RTN","XUSER1",56,0)
 I $G(DUZ(2))="" D  ;Should not happen
"RTN","XUSER1",57,0)
 . N XOPT D XOPT^XUS1A S DUZ(2)=$P(XOPT,U,17)
"RTN","XUSER1",58,0)
 S CD=$$NS^XUAF4(DUZ(2))
"RTN","XUSER1",59,0)
 W !,"Your current Division is ",$P(CD,U)_"  "_$P(CD,U,2)
"RTN","XUSER1",60,0)
 S X=+$O(^VA(200,DUZ,2,0)),Y=+$O(^(X))
"RTN","XUSER1",61,0)
 I 'Y W !,"You do not have any choices. ",!," Change is not possible.",!! Q
"RTN","XUSER1",62,0)
 K DIC S DIC="^VA(200,DUZ,2,",DIC(0)="AEMNQ"
"RTN","XUSER1",63,0)
 S DIC("S")="I $G(^DIC(4,+Y,99))"
"RTN","XUSER1",64,0)
 ;Check if user has a default
"RTN","XUSER1",65,0)
 S X=$O(^VA(200,DUZ,2,"AX1",1,0)) S:X>0 DIC("B")=$P($$NS^XUAF4(X),U)
"RTN","XUSER1",66,0)
 D ^DIC K DIC
"RTN","XUSER1",67,0)
 I Y'>0 D  Q
"RTN","XUSER1",68,0)
 .W !,$C(7),"Division Unchanged - Currently you are assigned to "
"RTN","XUSER1",69,0)
 .W $P(CD,U)_"  "_$P(CD,U,2),!
"RTN","XUSER1",70,0)
 S DUZ(2)=+Y,CD=$$NS^XUAF4(DUZ(2))
"RTN","XUSER1",71,0)
 W !?5,"Division is now set to [ ",$P(CD,U)_"  "_$P(CD,U,2)," ]",!
"RTN","XUSER1",72,0)
 Q
"RTN","XUSTERM")
0^5^B27759476
"RTN","XUSTERM",1,0)
XUSTERM ;SEA/AMF/WDE - DEACTIVATE USER ;10/24/2002  16:11
"RTN","XUSTERM",2,0)
 ;;8.0;KERNEL;**36,73,135,148,169,222**;Jul 10, 1995
"RTN","XUSTERM",3,0)
LKUP K DIRUT,DIC
"RTN","XUSTERM",4,0)
 S DIC=200,DIC("S")="I $L($P(^(0),U,3))",DIC(0)="AEQMZ",DIC("A")="Select USER to be deactivated: "
"RTN","XUSTERM",5,0)
 D ^DIC K DIC G END:Y<0 S XUDA=+Y
"RTN","XUSTERM",6,0)
 D INQ Q:$D(DIRUT)
"RTN","XUSTERM",7,0)
 S DIE=200,DR="["_$$GET^XUPARAM("XUSERDEACT","N")_"]" D GET,XUDIE^XUS5
"RTN","XUSTERM",8,0)
 S XUDT=$P(^VA(200,DA,0),U,11),XUACT=XUDT&(XUDT>DT) G END:'XUDT
"RTN","XUSTERM",9,0)
 ;
"RTN","XUSTERM",10,0)
WHEN I XUACT W !!,XUNAM," will be deactivated on date specified." S ZTDTH=XUDT,ZTRTN="DQ1^XUSTERM1",ZTDESC="DEACTIVATE USER",ZTSAVE("XUDA")="",ZTIO="" D ^%ZTLOAD G END
"RTN","XUSTERM",11,0)
NOW S DIR("A")=XUNAM_" will be deactivated now.  Do you wish to proceed",DIR("B")="YES",DIR("??")="XUUSER-DEACT",DIR(0)="Y" D ^DIR G:"Yy"'[$E(X_U) END
"RTN","XUSTERM",12,0)
 W ! S XUVE=1 D ACT G END
"RTN","XUSTERM",13,0)
 ;
"RTN","XUSTERM",14,0)
INQ ;Ask to show User Inquiry
"RTN","XUSTERM",15,0)
 N DIR,DIC,FLDS,BY,FR,TO,Y,L
"RTN","XUSTERM",16,0)
 S DIR(0)="Y",DIR("A")="View/Print User Inquiry Data",DIR("B")="Yes" D ^DIR Q:$D(DIRUT)!('Y)
"RTN","XUSTERM",17,0)
 S L=0,DIC=200,FLDS="[XUSERINQ]",BY="NUMBER",(TO,FR)=XUDA D EN1^DIP K DIC
"RTN","XUSTERM",18,0)
 K DIR S DIR(0)="E" D ^DIR
"RTN","XUSTERM",19,0)
 Q
"RTN","XUSTERM",20,0)
GET ;XUGRP=mail group, XUKEY=keys, XUSUR=mail surrogates, XUJ=# baskets, XUK=# mail msg, XUIN=# in-basket msg
"RTN","XUSTERM",21,0)
 ;XUTX1, XUTX2 used in edit templates
"RTN","XUSTERM",22,0)
 K XUGRP,XUKEY,XUSUR,XUTX1,XUTX2 N %,XU10,XU11,XU20,XU21,XU30
"RTN","XUSTERM",23,0)
 S (XU10,XU20)=0,(XU11,XU21,XU31)=""
"RTN","XUSTERM",24,0)
 S DA=XUDA,XUNAM=$P(^VA(200,XUDA,0),U,1)
"RTN","XUSTERM",25,0)
 F XUI=0:0 S XUI=$O(^XMB(3.8,"AB",XUDA,XUI)) Q:XUI'>0  D  ;Mail groups
"RTN","XUSTERM",26,0)
 . S XUK=^XMB(3.8,XUI,0) S:'$L($P(XUK,U,2)) $P(XUK,U,2)="PU"
"RTN","XUSTERM",27,0)
 . S XUGRP(XUI)=$P(XUK,U,1,2)_U_$S('$D(^XMB(3.8,XUI,3)):0,1:^(3)=XUDA)
"RTN","XUSTERM",28,0)
 . S XU10=XU10+1 S:$L(XU11)<70 XU11=XU11_","_$P(XUK,U)
"RTN","XUSTERM",29,0)
 F XUI=0:0 S XUI=$O(^VA(200,XUDA,51,XUI)) Q:XUI'>0  D  ;Get keys
"RTN","XUSTERM",30,0)
 . S %=$G(^DIC(19.1,XUI,0)),XU20=XU20+1
"RTN","XUSTERM",31,0)
 . S:$L(XU21)<70 XU21=XU21_","_$P(%,U)
"RTN","XUSTERM",32,0)
 . Q:$P(%,U,4)="y"  ;Don't count keep at terminate keys
"RTN","XUSTERM",33,0)
 . S XUKEY(XUI)=""
"RTN","XUSTERM",34,0)
 F XUI=0:0 S XUI=$O(^XMB(3.7,"AB",XUDA,XUI)) Q:XUI'>0  D
"RTN","XUSTERM",35,0)
 . S XUSUR(XUI)="" S:$L(XU31)<70 XU31=XU31_","_$P(^VA(200,XUI,0),U)
"RTN","XUSTERM",36,0)
 S (XUJ,XUK,XUIN,XUNUM)=0
"RTN","XUSTERM",37,0)
 F I=.9:0 S I=$O(^XMB(3.7,XUDA,2,I)) Q:I'>0  D
"RTN","XUSTERM",38,0)
 . S XUJ=XUJ+1,XUNUM=$P($G(^XMB(3.7,XUDA,2,I,1,0)),U,4)
"RTN","XUSTERM",39,0)
 . S:XUNUM>0 XUK=XUK+XUNUM S:I=1 XUIN=XUNUM
"RTN","XUSTERM",40,0)
 . Q
"RTN","XUSTERM",41,0)
 S XUTX1(1)="User has "_XUK_" messages in "_XUJ_" baskets, Member of "_XU10_" Mail Groups."
"RTN","XUSTERM",42,0)
 S:XU10 XUTX1(2)="Mail Groups: "_$E(XU11,2,80) S:$L(XU31) XUTX1(3)="Surrogate for: "_$E(XU31,2,80)
"RTN","XUSTERM",43,0)
 S XUTX2(1)="User has "_XU20_" keys" S:XU20 XUTX2(2)=$E(XU21,2,80)
"RTN","XUSTERM",44,0)
 S XUEMP='($D(XUSUR)!$D(XUKEY)!$D(XUGRP)!XUJ!XUK!XUIN!$L($P(^VA(200,XUDA,0),U,3)))
"RTN","XUSTERM",45,0)
 Q
"RTN","XUSTERM",46,0)
ACT ;First let others clean-up, Then do our part.
"RTN","XUSTERM",47,0)
 D ^XUSTERM2 ;Cleanup by other packages.
"RTN","XUSTERM",48,0)
 K DIC S DA=XUDA,XUJ=^VA(200,XUDA,0),XUNAM=$P(XUJ,U,1),XUACT(19)=$S($D(^VA(200,XUDA,19)):^(19),1:"") F XUI=5,6,10 S XUACT(XUI)=$P(XUJ,U,XUI)
"RTN","XUSTERM",49,0)
ACT1 K ^DISV(XUDA) ; WARNING: This only gets ^DISV entries on current CPU
"RTN","XUSTERM",50,0)
 ;keys
"RTN","XUSTERM",51,0)
 I XUACT(6)="y" F XUI=0:0 S XUI=$O(^VA(200,XUDA,51,XUI)) Q:XUI'>0  I $P($G(^DIC(19.1,XUI,0)),U,4)'="y" S DA=XUI,DA(1)=XUDA,DIK="^VA(200,XUDA,51," D ^DIK W:XUVE "..."
"RTN","XUSTERM",52,0)
 ;delegated keys
"RTN","XUSTERM",53,0)
 I XUACT(6)="y" F XUI=0:0 S XUI=$O(^VA(200,XUDA,52,XUI)) Q:XUI'>0  S DA=XUI,DA(1)=XUDA,DIK="^VA(200,XUDA,52," D ^DIK W:XUVE "..."
"RTN","XUSTERM",54,0)
 ;Access;Verify;PAC;Last signon;SMD delegate;electronic signature,Primary menu,Hinq Employee #
"RTN","XUSTERM",55,0)
 S DIE=200,DA=XUDA,DR="2///@;11///@;14///@;1.1///@;19///@;19.2///@;20.4///@;201///@;14.9///@" D ^DIE
"RTN","XUSTERM",56,0)
 ;Delegated options
"RTN","XUSTERM",57,0)
 S DIK="^VA(200,XUDA,19.5,",DA(1)=XUDA F XUI=0:0 S XUI=$O(^VA(200,XUDA,19.5,XUI)) Q:XUI'>0  S DA=XUI D ^DIK
"RTN","XUSTERM",58,0)
 ;Menu templates
"RTN","XUSTERM",59,0)
 S DIK="^VA(200,XUDA,19.8,",DA(1)=XUDA F XUI=0:0 S XUI=$O(^VA(200,XUDA,19.8,XUI)) Q:XUI'>0  S DA=XUI D ^DIK
"RTN","XUSTERM",60,0)
 ;Secondary Menus
"RTN","XUSTERM",61,0)
 S DIK="^VA(200,XUDA,203,",DA(1)=XUDA F XUI=0:0 S XUI=$O(^VA(200,XUDA,203,XUI)) Q:XUI'>0  S DA=XUI D ^DIK
"RTN","XUSTERM",62,0)
 S DA=0,DA(1)=XUDA D D2^XUFILE1 ;Remove all access to files.
"RTN","XUSTERM",63,0)
 ;Terminate Person Class
"RTN","XUSTERM",64,0)
 I $L($T(TERM^XUA4A72)) D TERM^XUA4A72(XUDA,XUDT)
"RTN","XUSTERM",65,0)
 ;Remove all parameters for the user.
"RTN","XUSTERM",66,0)
 I $L($T(DELUSR^XPAR3)) D DELUSR^XPAR3(XUDA)
"RTN","XUSTERM",67,0)
 ;
"RTN","XUSTERM",68,0)
ACT2 ;XUACT(5) All Mail access,  Mail groups
"RTN","XUSTERM",69,0)
 D MAIL
"RTN","XUSTERM",70,0)
 W:XUVE "... DONE" Q
"RTN","XUSTERM",71,0)
END K C,D,D0,DI,DR,DIC,DIE,DA,DIR,XUEMP,XUDA,XUI,XUJ,XUK,XUACT,XUKEY,XUGRP,XUSUR,XUNAM,XUF,XUDT,XUIN,DIC,XUDB,XUDC,XUDP,XUGP,XUNUM,XUVE,Y
"RTN","XUSTERM",72,0)
 K XUTX1,XUTX2,DIRUT,DIR
"RTN","XUSTERM",73,0)
 Q
"RTN","XUSTERM",74,0)
MAIL ;Remove mail access
"RTN","XUSTERM",75,0)
 I XUACT(5)="y",$T(TERMINAT^XMUTERM1)]"" D TERMINAT^XMUTERM1(XUDA) Q
"RTN","XUSTERM",76,0)
 ;Do it the old way
"RTN","XUSTERM",77,0)
 I XUACT(5)="y" F XUI=0:0 S XUI=$O(XUGRP(XUI)) Q:XUI=""  F XUJ=0:0 S XUJ=$O(^XMB(3.8,"AB",XUDA,XUI,XUJ)) Q:XUJ'>0  S DA=XUJ,DA(1)=XUI,DIK="^XMB(3.8,XUI,1," D ^DIK W:XUVE "..."
"RTN","XUSTERM",78,0)
 ; Personal Mail Groups
"RTN","XUSTERM",79,0)
 I XUACT(5)="y" F XUI=0:0 S XUI=$O(^XMB(3.8,XUI)) Q:XUI'>0  I $P(^(XUI,0),U,6)=1,$D(^(3))#2,^(3)=XUDA S DA=XUI,DIK="^XMB(3.8," D ^DIK W:XUVE "..."
"RTN","XUSTERM",80,0)
 ;Always remove as authorized sender
"RTN","XUSTERM",81,0)
 S XUGP=0 F I=1:1 S XUGP=$O(^XMB(3.8,XUGP)) Q:+XUGP'=XUGP  S DIC="^XMB(3.8,"_XUGP_",4,",DA=$O(@(DIC_"""B"",XUDA,0)")) I +DA>0 S DIK=DIC,DA(1)=XUGP D ^DIK W:XUVE "..."
"RTN","XUSTERM",82,0)
 ;Remove as mail surrogate
"RTN","XUSTERM",83,0)
 F XUDB=0:0 S XUDB=$O(^XMB(3.7,"AB",XUDA,XUDB)) Q:XUDB'>0  S DA=$O(^XMB(3.7,"AB",XUDA,XUDB,0)),%=$D(^XMB(3.7,XUDB,9,DA,0)) K:%=0 ^XMB(3.7,"AB",XUDA,XUDB) I % S DA(1)=XUDB,DIK="^XMB(3.7,XUDB,9," D ^DIK
"RTN","XUSTERM",84,0)
 ;Mail basket
"RTN","XUSTERM",85,0)
 I XUACT(5)="y",$D(^XMB(3.7,XUDA,0)) W:XUVE "..." S DIK="^XMB(3.7,",DA=XUDA D ^DIK K DIK
"RTN","XUSTERM",86,0)
 ;Remove latered messages
"RTN","XUSTERM",87,0)
 I XUACT(5)="y" S DA=0 F  S DA=$O(^XMB(3.73,"C",XUDA,DA)) Q:DA'>0  S DIK="^XMB(3.73," D ^DIK K DIK
"RTN","XUSTERM",88,0)
 K ^XMB(3.7,"AB",XUDA) K:XUACT(5)="y" ^XMB(3.8,"AB",XUDA) ;Clean up X-refs
"RTN","XUSTERM",89,0)
 Q
"RTN","XUSTERM1")
0^4^B20273244
"RTN","XUSTERM1",1,0)
XUSTERM1 ;SEA/WDE - DEACTIVATE USER ;04/11/2002  14:04
"RTN","XUSTERM1",2,0)
 ;;8.0;KERNEL;**102,180,208,222**;Jul 10, 1995
"RTN","XUSTERM1",3,0)
ENALL ;Interactive scan all
"RTN","XUSTERM1",4,0)
 S U="^",DTIME=$G(DTIME,60)
"RTN","XUSTERM1",5,0)
 W !!,"This option can purge all access & verify codes, mail baskets, messages,",!,"authorized senders access, keys, and electronic signature codes of users who have been terminated."
"RTN","XUSTERM1",6,0)
RD1 W !!,"Do you wish to proceed "
"RTN","XUSTERM1",7,0)
 S %=2 D YN^DICN G:%=2!(%=-1) END I %=0 S XQH="XUUSER-PURGEATT" D EN^XQH G RD1
"RTN","XUSTERM1",8,0)
RD2 W !,"Do you wish to verify each user "
"RTN","XUSTERM1",9,0)
 S %=2,XUVE=0 D YN^DICN S:%=1 XUVE=1 G:%=1 CHECK G:%=-1 END I %=0 S XQH="XUUSER-PURGEATT-VER" D EN^XQH G RD2
"RTN","XUSTERM1",10,0)
QUE W !,"Do you wish to have this queued for a later time "
"RTN","XUSTERM1",11,0)
 S %=1 D YN^DICN I %=1 D  Q
"RTN","XUSTERM1",12,0)
 . S ZTDESC="USER DEACTIVATION",ZTRTN="CHECK^XUSTERM1",ZTIO="",ZTSAVE("DUZ*")=""
"RTN","XUSTERM1",13,0)
 . D ^%ZTLOAD Q
"RTN","XUSTERM1",14,0)
 I %=0 K X,XUVE Q
"RTN","XUSTERM1",15,0)
 ;Fall thru if user doesn't queue
"RTN","XUSTERM1",16,0)
CHECK ;Entry point for taskman.
"RTN","XUSTERM1",17,0)
 N XUDT90,XUDT30,FDA,XUDT
"RTN","XUSTERM1",18,0)
 S U="^",DT=$$DT^XLFDT(),XUDT90=$$HTFM^XLFDT($H-90,1),XUDT30=$$HTFM^XLFDT($H-30,1)
"RTN","XUSTERM1",19,0)
 S XUDA=.6,XUVE=$G(XUVE,0)
"RTN","XUSTERM1",20,0)
 F  S XUDA=$O(^VA(200,XUDA)) Q:XUDA'>0  S XUJ=$G(^(XUDA,0)) D
"RTN","XUSTERM1",21,0)
 . S XUDT=$P(XUJ,U,11)
"RTN","XUSTERM1",22,0)
 . I $P(XUJ,U,3)]"",$L(XUDT),(XUDT'>DT) D
"RTN","XUSTERM1",23,0)
 . . D GET
"RTN","XUSTERM1",24,0)
 . . I 'XUEMP K Y D:XUVE DISP Q:$D(Y)  D ACT ;XUEMP=any data to remove
"RTN","XUSTERM1",25,0)
 . I $P(XUJ,U,3)]"",'$P(XUJ,U,8),$$NOSIGNON D DISUSER(XUDA)
"RTN","XUSTERM1",26,0)
 . Q
"RTN","XUSTERM1",27,0)
 ;
"RTN","XUSTERM1",28,0)
END K XUEMP,XUDA,XUI,XUJ,XUK,XUACT,XUKEY,XUGRP,XUSUR,XUNAM,XUF,XUDT,XUIN,XUVE,X,DIC,XUDB,XUDC,XUDP
"RTN","XUSTERM1",29,0)
 Q
"RTN","XUSTERM1",30,0)
DISUSER(XUDA) ;Set DISUSER flag and reason, Remove last menu option
"RTN","XUSTERM1",31,0)
 N %,FDA S %=XUDA_","
"RTN","XUSTERM1",32,0)
 S FDA(200,%,7)=1,FDA(200,%,9.4)="User Inactive for too long"
"RTN","XUSTERM1",33,0)
 D FILE^DIE("","FDA"),CONTCL(XUDA) ;Set Disuser
"RTN","XUSTERM1",34,0)
 Q
"RTN","XUSTERM1",35,0)
 ;
"RTN","XUSTERM1",36,0)
NOSIGNON() ;Check last signon. Return 1 if should disable account
"RTN","XUSTERM1",37,0)
 N Q S Q=$P($G(^VA(200,XUDA,1.1)),U) ;Get last sign-on
"RTN","XUSTERM1",38,0)
 I $L(Q),Q>XUDT90 Q 0 ;Last sign-on within 90 days
"RTN","XUSTERM1",39,0)
 S Q=$P($G(^VA(200,XUDA,1.1)),U,4) ;Get last Edit date
"RTN","XUSTERM1",40,0)
 I $L(Q),Q>XUDT30 Q 0 ;User edited in last 30 days
"RTN","XUSTERM1",41,0)
 S Q=$P($G(^VA(200,XUDA,1)),U,7) ;Create Date
"RTN","XUSTERM1",42,0)
 I $L(Q),Q>XUDT30 Q 0 ;User set up in last 30 days
"RTN","XUSTERM1",43,0)
 S Q=$P($G(^VA(200,XUDA,.1)),U) ;Get verify code change date
"RTN","XUSTERM1",44,0)
 I $L(Q),(Q+30)>$H Q 0 ;Verify code changed in last 30 days
"RTN","XUSTERM1",45,0)
 Q 1
"RTN","XUSTERM1",46,0)
 ;
"RTN","XUSTERM1",47,0)
CONTCL(XUDA) ;Clear the fields for Menu "Continue"
"RTN","XUSTERM1",48,0)
 N FDA
"RTN","XUSTERM1",49,0)
 S FDA(200,XUDA_",",202.1)="@",FDA(200,XUDA_",",202.2)="@"
"RTN","XUSTERM1",50,0)
        D FILE^DIE("","FDA") ;Clear 202.1 and 202.2
"RTN","XUSTERM1",51,0)
 Q
"RTN","XUSTERM1",52,0)
ACT D ACT^XUSTERM
"RTN","XUSTERM1",53,0)
 Q
"RTN","XUSTERM1",54,0)
 ;
"RTN","XUSTERM1",55,0)
GET ;Kill ^DISV entries each time, should get all CPUs at some point
"RTN","XUSTERM1",56,0)
 D GET^XUSTERM K ^DISV(XUDA),Y
"RTN","XUSTERM1",57,0)
 Q
"RTN","XUSTERM1",58,0)
DISP W !!,XUNAM," currently has:",!?3,XUJ," baskets",?25,XUK," total messages",?50,XUIN," IN basket messages",! S DR="9.21//YES",DIE=200 D ^DIE Q:$D(Y)  G:'$D(XUSUR) KEYS W !!,XUNAM," acts as surrogate for the following users:"
"RTN","XUSTERM1",59,0)
 S XUJ=0,XUI=3 F XUK=0:1 S XUJ=$O(XUSUR(XUJ)) Q:XUJ'>0  W:'(XUK#XUI) ! W ?(XUK#XUI*26),$P(^VA(200,XUJ,0),U,1) W !,"These surrogate privileges will be deleted on deactivation."
"RTN","XUSTERM1",60,0)
KEYS ;This section checks for authorized senders of mail groups and security keys.
"RTN","XUSTERM1",61,0)
 W !,"User will no longer be an authorized sender to any mail groups."
"RTN","XUSTERM1",62,0)
 I '$D(XUKEY) W !!,XUNAM," currently holds no keys." G KEYS1
"RTN","XUSTERM1",63,0)
 W !!,XUNAM," holds the following keys: " S XUJ=0,XUI=5 F XUK=0:1 S XUJ=$O(XUKEY(XUJ)) Q:XUJ'>0  W:'(XUK#XUI) ! W ?(XUK#XUI*15),$P($G(^DIC(19.1,XUJ,0)),U,1)
"RTN","XUSTERM1",64,0)
KEYS1 W ! S DR="9.22//YES" D ^DIE Q:$D(Y)
"RTN","XUSTERM1",65,0)
GROUP I '$D(XUGRP) W !!,XUNAM," currently is not a member of any MAIL GROUP." G GROUP1
"RTN","XUSTERM1",66,0)
 W !!,XUNAM," is a member of the following Mail Groups:"
"RTN","XUSTERM1",67,0)
 S XUI="" F XUI=0:0 S XUI=$O(XUGRP(XUI)) Q:XUI'>0  S XUJ=XUGRP(XUI) I $P(XUJ,U,2)="PU"!$D(^XMB(3.8,"AB",XUDA,XUI)) W !?2,$P(XUJ,U,1) W:$P(XUJ,U,3) " (Organizer)" W ?40,$S(($P(XUJ,U,2)="PR"):"(Private)",1:"(Public)")
"RTN","XUSTERM1",68,0)
GROUP1 W ! S DR="9.23//YES" D ^DIE Q:$D(Y)
"RTN","XUSTERM1",69,0)
 Q
"RTN","XUSTERM1",70,0)
DQ1 ;Terminate one person.
"RTN","XUSTERM1",71,0)
 S XUJ=$G(^VA(200,XUDA,0)) I $P(XUJ,U,11),($P(XUJ,U,11)'>DT) D
"RTN","XUSTERM1",72,0)
 . S XUVE=0 D GET I 'XUEMP D ACT
"RTN","XUSTERM1",73,0)
 . Q
"RTN","XUSTERM1",74,0)
 Q
"RTN","XUTMK")
0^2^B32900638
"RTN","XUTMK",1,0)
XUTMK ;SEA/RDS - Taskman: Option, ZTMCLEAN/ZTMQCLEAN ;02/11/2002  11:02
"RTN","XUTMK",2,0)
 ;;8.0;KERNEL;**49,67,118,169,222**;Jul 10, 1995
"RTN","XUTMK",3,0)
 ;
"RTN","XUTMK",4,0)
SETUP ;Setup Variables And Synchronize ^%ZTSK With ^%ZTSCH
"RTN","XUTMK",5,0)
 S ZTDTH=0
"RTN","XUTMK",6,0)
 F  S ZTDTH=$O(^%ZTSCH(ZTDTH)) Q:'ZTDTH  F ZTS=0:0 S ZTS=$O(^%ZTSCH(ZTDTH,ZTS)) Q:'ZTS  D
"RTN","XUTMK",7,0)
 . L +^%ZTSK(ZTS):2 Q:'$T  K:$D(^%ZTSK(ZTS,0))[0 ^%ZTSK(ZTS),^%ZTSCH(ZTDTH,ZTS)
"RTN","XUTMK",8,0)
 . S:$D(^%ZTSK(ZTS,0))#2 $P(^(0),U,6)=$$H0^%ZTM(ZTDTH)
"RTN","XUTMK",9,0)
 . L -^%ZTSK(ZTS) Q
"RTN","XUTMK",10,0)
 I $D(ZTKEEP)#2 G SX
"RTN","XUTMK",11,0)
 S ZTKEEP="",ZTV=^%ZOSF("VOL"),ZTI=$O(^%ZIS(14.5,"B",ZTV,""))
"RTN","XUTMK",12,0)
 I ZTI]"",$D(^%ZIS(14.5,ZTI,0))#2 S ZTKEEP=$P(^(0),U,9)
"RTN","XUTMK",13,0)
SX S:ZTKEEP="" ZTKEEP=7 S ZTKEEP=$H-ZTKEEP,ZTCNT=0,ZTMAX=100,ZTS=.9
"RTN","XUTMK",14,0)
 ;
"RTN","XUTMK",15,0)
CLEAN ;Delete Obsolete Entries
"RTN","XUTMK",16,0)
 I '(ZTCNT#20),$$S^%ZTLOAD S ZTSTOP=1 Q
"RTN","XUTMK",17,0)
 S ZTS=$O(^%ZTSK(ZTS)) I 'ZTS G FINAL
"RTN","XUTMK",18,0)
 S ZTMAX=ZTS,ZTCNT=ZTCNT+1
"RTN","XUTMK",19,0)
 L +^%ZTSK(ZTS):0 I '$T G CLEAN
"RTN","XUTMK",20,0)
 I $D(^%ZTSK(ZTS,0))[0 K ^%ZTSK(ZTS) W:'$D(ZTQUEUED) "." G NEXT
"RTN","XUTMK",21,0)
 ;
"RTN","XUTMK",22,0)
1 ;keep active tasks
"RTN","XUTMK",23,0)
 I $D(^%ZTSCH("TASK",ZTS)) G NEXT
"RTN","XUTMK",24,0)
 S ZTREC=^%ZTSK(ZTS,0),ZTDTH=$P(ZTREC,U,6) I ZTDTH="" G 2
"RTN","XUTMK",25,0)
 S:ZTDTH'["," ZTDTH=$$H0^%ZTM(ZTDTH) S ZTDTH3=$$H3^%ZTM(ZTDTH)
"RTN","XUTMK",26,0)
 I $D(^%ZTSCH(ZTDTH3,ZTS)) G NEXT
"RTN","XUTMK",27,0)
 I $D(^%ZTSCH("JOB",ZTDTH3,ZTS)) G NEXT
"RTN","XUTMK",28,0)
 S ZTCNTPU=$P(ZTREC,U,14),ZTIO=$P($G(^%ZTSK(ZTS,.2)),U,2)
"RTN","XUTMK",29,0)
 I ZTCNTPU]"",$D(^%ZTSCH("LINK",ZTCNTPU,ZTDTH3,ZTS)) G NEXT
"RTN","XUTMK",30,0)
 I ZTIO]"",$D(^%ZTSCH("IO",ZTIO,ZTDTH3,ZTS)) G NEXT
"RTN","XUTMK",31,0)
 ;
"RTN","XUTMK",32,0)
2 ;keep young inactive tasks
"RTN","XUTMK",33,0)
 S Z1=$G(^%ZTSK(ZTS,.1))
"RTN","XUTMK",34,0)
 I Z1]"",$P(Z1,U,8),$H'>$P(Z1,U,8) G NEXT ;Remember Until
"RTN","XUTMK",35,0)
 S ZTF=$S($P(Z1,U)="":0,"135AG"[$P(Z1,U):0,1:$P(Z1,U,2)'<ZTKEEP) ;Last status update
"RTN","XUTMK",36,0)
 S ZTF=$S(ZTF:ZTF,ZTDTH="":0,1:ZTDTH'<+ZTKEEP) ;Run time
"RTN","XUTMK",37,0)
 S ZTF=$S(ZTF:ZTF,$P(ZTREC,U,5)="":0,1:$P(ZTREC,U,5)'<+ZTKEEP) ;creation date
"RTN","XUTMK",38,0)
 I ZTF G NEXT
"RTN","XUTMK",39,0)
 ;
"RTN","XUTMK",40,0)
3 ;delete old inactive tasks
"RTN","XUTMK",41,0)
 K ^%ZTSK(ZTS) W:'$D(ZTQUEUED) "."
"RTN","XUTMK",42,0)
 ;
"RTN","XUTMK",43,0)
NEXT L -^%ZTSK(ZTS)
"RTN","XUTMK",44,0)
 G CLEAN
"RTN","XUTMK",45,0)
 ;
"RTN","XUTMK",46,0)
FINAL ;Final Steps.
"RTN","XUTMK",47,0)
 L +^%ZTSK(-1) ;lock top
"RTN","XUTMK",48,0)
 S $P(^%ZTSK(0),"^",3,4)=ZTMAX_"^"_ZTCNT
"RTN","XUTMK",49,0)
 I ^%ZTSK(-1)>9000000 S ^%ZTSK(-1)=100
"RTN","XUTMK",50,0)
 L -^%ZTSK(-1)
"RTN","XUTMK",51,0)
 D CLIST,TASK,SUB,CLEARIO,MONITOR
"RTN","XUTMK",52,0)
 ;Call TM error purge
"RTN","XUTMK",53,0)
 S %=$$PURGE^XUTMKE(0,ZTKEEP,"")
"RTN","XUTMK",54,0)
 K ZT,ZTDTH,ZTF,ZTI,ZTKEEP,ZTS,ZTV
"RTN","XUTMK",55,0)
 Q
"RTN","XUTMK",56,0)
 ;
"RTN","XUTMK",57,0)
CLIST ;Clean up the C list
"RTN","XUTMK",58,0)
 S ZT1=""
"RTN","XUTMK",59,0)
 F  S ZT1=$O(^%ZTSCH("C",ZT1)),ZT2="" Q:ZT1=""  F  S ZT2=$O(^%ZTSCH("C",ZT1,ZT2)),ZT3="" Q:ZT2=""  D
"RTN","XUTMK",60,0)
 . F  S ZT3=$O(^%ZTSCH("C",ZT1,ZT2,ZT3)) Q:ZT3=""  I $D(^%ZTSK(ZT3,0))[0 K ^%ZTSCH("C",ZT1,ZT2,ZT3)
"RTN","XUTMK",61,0)
 . Q
"RTN","XUTMK",62,0)
 Q
"RTN","XUTMK",63,0)
TASK ;Clean the TASK nodes.
"RTN","XUTMK",64,0)
 N ZT1,ZT2
"RTN","XUTMK",65,0)
 F ZT1=0:0 S ZT1=$O(^%ZTSCH("TASK",ZT1)) Q:ZT1'>0  D
"RTN","XUTMK",66,0)
 . L +^%ZTSCH("TASK",ZT1):0 Q:'$T
"RTN","XUTMK",67,0)
 . S ZT2=$G(^%ZTSCH("TASK",ZT1)),$P(ZT2,U,5)=$G(^(ZT1,1))
"RTN","XUTMK",68,0)
 . L -^%ZTSCH("TASK",ZT1)
"RTN","XUTMK",69,0)
 . I ZT2="^^^^" K ^%ZTSCH("TASK",ZT1) Q
"RTN","XUTMK",70,0)
 . I $D(^%ZTSCH("TASK",ZT1,"P")) Q  ;Persistent tasks
"RTN","XUTMK",71,0)
 . I "^XMAD^"[(U_$E($P(ZT2,U,2),1,4)_U) Q
"RTN","XUTMK",72,0)
 . I $H-$P(ZT2,U,5)>4  K ^%ZTSCH("TASK",ZT1)
"RTN","XUTMK",73,0)
 . Q
"RTN","XUTMK",74,0)
 Q
"RTN","XUTMK",75,0)
 ;
"RTN","XUTMK",76,0)
SUB ;Sync the SUB nodes
"RTN","XUTMK",77,0)
 N ZT1,ZT2,ZT3,CNT,ZTIME S ZT1="",ZTIME=$$H3^%ZTM($H)
"RTN","XUTMK",78,0)
 F  S ZT1=$O(^%ZTSCH("SUB",ZT1)),CNT=0,ZT2=0 Q:ZT1=""  D
"RTN","XUTMK",79,0)
 . L +^%ZTSCH("SUB",ZT1):5 Q:'$T
"RTN","XUTMK",80,0)
 . F  S ZT2=$O(^%ZTSCH("SUB",ZT1,ZT2)) Q:ZT2'>0  S ZT3=^(ZT2) D
"RTN","XUTMK",81,0)
 . . S ZT3=$$H3^%ZTM(ZT3) I (ZT3+60)<ZTIME K ^%ZTSCH("SUB",ZT1,ZT2) Q
"RTN","XUTMK",82,0)
 . . S CNT=CNT+1
"RTN","XUTMK",83,0)
 . . Q
"RTN","XUTMK",84,0)
 . S ^%ZTSCH("SUB",ZT1)=CNT L -^%ZTSCH("SUB",ZT1)
"RTN","XUTMK",85,0)
 . Q
"RTN","XUTMK",86,0)
 Q
"RTN","XUTMK",87,0)
CLEARIO ;Clear any empty IO lists
"RTN","XUTMK",88,0)
 L +^%ZTSCH("IO"):2 Q:'$T
"RTN","XUTMK",89,0)
 S ^%ZTSCH("WAIT","MGR")="XUTMK",^%ZTSCH("WAIT","SUB")="XUTMK"
"RTN","XUTMK",90,0)
 L -^%ZTSCH("IO")
"RTN","XUTMK",91,0)
 N %ZTIO,%ZTPAIR S %ZTIO="" H 10 ;Let jobs see flag
"RTN","XUTMK",92,0)
 F  S %ZTIO=$O(^%ZTSCH("IO",%ZTIO)) Q:%ZTIO=""  D
"RTN","XUTMK",93,0)
 . I $D(^%ZTSCH("IO",%ZTIO))=1 K ^%ZTSCH("IO",%ZTIO),^%ZTSCH("DEVTRY",%ZTIO)
"RTN","XUTMK",94,0)
 . Q
"RTN","XUTMK",95,0)
 ;Now Clear and empty "C" lists
"RTN","XUTMK",96,0)
 S %ZTPAIR=""
"RTN","XUTMK",97,0)
 F  S %ZTPAIR=$O(^%ZTSCH("C",%ZTPAIR)) Q:%ZTPAIR=""  D
"RTN","XUTMK",98,0)
 . I $O(^%ZTSCH("C",%ZTPAIR,0))="" K ^%ZTSCH("C",%ZTPAIR)
"RTN","XUTMK",99,0)
 . Q
"RTN","XUTMK",100,0)
 K ^%ZTSCH("WAIT","MGR"),^%ZTSCH("WAIT","SUB")
"RTN","XUTMK",101,0)
 Q
"RTN","XUTMK",102,0)
 ;
"RTN","XUTMK",103,0)
MONITOR ;Move any Monitor data,
"RTN","XUTMK",104,0)
 N ZT1,ZT2,ZR,ZR2,IEN,ZFDA,X
"RTN","XUTMK",105,0)
 S ZT1="",IEN=0,ZR=$NA(^%ZTSCH("MON"))
"RTN","XUTMK",106,0)
 F  S ZT1=$O(@ZR@(ZT1)),ZT2=0 Q:ZT1=""  D
"RTN","XUTMK",107,0)
 . F  S ZT2=$O(@ZR@(ZT1,ZT2)) Q:ZT2=""  D
"RTN","XUTMK",108,0)
 . . S IEN=IEN+1,ZR2=$NA(ZFDA(14.71,"+"_IEN_","))
"RTN","XUTMK",109,0)
 . . S Y=@ZR@(ZT1,ZT2)
"RTN","XUTMK",110,0)
 . . S @ZR2@(.01)=$$HTFM^XLFDT(ZT2),@ZR2@(2)=ZT1
"RTN","XUTMK",111,0)
 . . F I=3:1:26 S @ZR2@(I)=$P(Y,U,I-2)
"RTN","XUTMK",112,0)
 . . D UPDATE^DIE("","ZFDA")
"RTN","XUTMK",113,0)
 . . K @ZR@(ZT1,ZT2),ZFDA ;Clear Global and Local.
"RTN","XUTMK",114,0)
 . . Q
"RTN","XUTMK",115,0)
 . Q
"RTN","XUTMK",116,0)
 Q
"RTN","XUTMK",117,0)
 ;
"RTN","XUTMK",118,0)
OPTION ;Entry Point For ZTMCLEAN Option
"RTN","XUTMK",119,0)
 W !!,"This option queues a task to clean up the Task file."
"RTN","XUTMK",120,0)
 W !,"All tasks that have been inactive for a certain number of days are deleted.",!
"RTN","XUTMK",121,0)
 ;
"RTN","XUTMK",122,0)
ZTKEEP ;ask user how long to keep inactive tasks
"RTN","XUTMK",123,0)
 S DIR(0)="NA^0:365",DIR("A")="Number of days to save inactive tasks: ",DIR("B")=""
"RTN","XUTMK",124,0)
 S ZTV=^%ZOSF("VOL"),ZTI=$O(^%ZIS(14.5,"B",ZTV,""))
"RTN","XUTMK",125,0)
 I ZTI]"",$D(^%ZIS(14.5,ZTI,0))#2 S DIR("B")=$P(^(0),U,9)
"RTN","XUTMK",126,0)
 I DIR("B")="" S DIR("B")=7
"RTN","XUTMK",127,0)
 S DIR("?")="     Answer must be an integer between 0 and 365",DIR("??")="^D HELP1^XUTMK"
"RTN","XUTMK",128,0)
 D ^DIR W:$D(DTOUT) $C(7)
"RTN","XUTMK",129,0)
 K DIR,DIRUT,DTOUT,DUOUT,ZTI,ZTV
"RTN","XUTMK",130,0)
 I Y'=0&'Y K %,X,Y D NOTQED Q
"RTN","XUTMK",131,0)
 S ZTKEEP=Y
"RTN","XUTMK",132,0)
 ;
"RTN","XUTMK",133,0)
ZTDTH ;ask user when to start the cleanup
"RTN","XUTMK",134,0)
 S DIR(0)="DA^::AERSX",DIR("A")="Start time for cleanup task: ",DIR("B")="NOW"
"RTN","XUTMK",135,0)
 S DIR("?")="     Answer must be a date and time",DIR("??")="^D HELP2^XUTMK"
"RTN","XUTMK",136,0)
 D ^DIR W:$D(DTOUT) $C(7)
"RTN","XUTMK",137,0)
 K DIR,DIRUT,DTOUT,DUOUT
"RTN","XUTMK",138,0)
 I 'Y K %,X,Y D NOTQED Q
"RTN","XUTMK",139,0)
 S ZTDTH=Y
"RTN","XUTMK",140,0)
 ;
"RTN","XUTMK",141,0)
QUEUE ;queue the cleanup task
"RTN","XUTMK",142,0)
 S ZTRTN="XUTMK",ZTIO="",ZTDESC="TaskMan: clean the Task file",ZTSAVE("ZTKEEP")=""
"RTN","XUTMK",143,0)
 D ^%ZTLOAD
"RTN","XUTMK",144,0)
 W !!?5,"Task file cleanup queued!" H 1
"RTN","XUTMK",145,0)
 K ZTSK Q
"RTN","XUTMK",146,0)
 ;
"RTN","XUTMK",147,0)
HELP1 ;ZTKEEP--?? help for first prompt
"RTN","XUTMK",148,0)
 W !!?5,"Answer how many days inactive tasks should be kept."
"RTN","XUTMK",149,0)
 W !?5,"Any task currently scheduled, waiting, or running is still active."
"RTN","XUTMK",150,0)
 Q
"RTN","XUTMK",151,0)
 ;
"RTN","XUTMK",152,0)
HELP2 ;ZTDTH--?? help for second prompt
"RTN","XUTMK",153,0)
 W !!?5,"Answer exactly when the task should begin the cleanup."
"RTN","XUTMK",154,0)
 Q
"RTN","XUTMK",155,0)
 ;
"RTN","XUTMK",156,0)
NOTQED ;OPTION--feedback when task is canceled
"RTN","XUTMK",157,0)
 W !!?5,"Task file cleanup NOT queued!" H 1
"RTN","XUTMK",158,0)
 Q
"RTN","XUTMK",159,0)
 ;
"UP",200,200.03,-1)
200^203
"UP",200,200.03,0)
200.03
"VER")
8.0^22.0
"^DD",200,200,7,0)
DISUSER^S^0:NO;1:YES;^0;7^Q
"^DD",200,200,7,1,0)
^.1
"^DD",200,200,7,1,1,0)
^^TRIGGER^200^202.04
"^DD",200,200,7,1,1,1)
K DIV S DIV=X,D0=DA,DIV(0)=D0 S Y(1)=$S($D(^VA(200,D0,1.1)):^(1.1),1:"") S X=$P(Y(1),U,4),X=X S DIU=X K Y S X=DIV S X=DT S DIH=$G(^VA(200,DIV(0),1.1)),DIV=X S $P(^(1.1),U,4)=DIV,DIH=200,DIG=202.04 D ^DICR
"^DD",200,200,7,1,1,2)
K DIV S DIV=X,D0=DA,DIV(0)=D0 S Y(1)=$S($D(^VA(200,D0,1.1)):^(1.1),1:"") S X=$P(Y(1),U,4),X=X S DIU=X K Y S X=DIV S X=DT S DIH=$G(^VA(200,DIV(0),1.1)),DIV=X S $P(^(1.1),U,4)=DIV,DIH=200,DIG=202.04 D ^DICR
"^DD",200,200,7,1,1,3)
Keep users from repeat lockout.
"^DD",200,200,7,1,1,"%D",0)
^^3^3^3020213^
"^DD",200,200,7,1,1,"%D",1,0)
This cross reference sets the todays date into field 202.04 to keep the
"^DD",200,200,7,1,1,"%D",2,0)
XUAUTODEACTIVATE from setting the DISUSER flag after being cleared if the
"^DD",200,200,7,1,1,"%D",3,0)
user doesn't sign-on that day.
"^DD",200,200,7,1,1,"CREATE VALUE")
TODAY
"^DD",200,200,7,1,1,"DELETE VALUE")
TODAY
"^DD",200,200,7,1,1,"DT")
3020213
"^DD",200,200,7,1,1,"FIELD")
#202.04
"^DD",200,200,7,3)
Enter YES to disable this user from login-on to the system.
"^DD",200,200,7,21,0)
^^7^7^2940419^
"^DD",200,200,7,21,1,0)
This field, if set to YES (1), marks a user that is not allowed to
"^DD",200,200,7,21,2,0)
log on to this system.  It will leave all Menus, Keys and other attributes
"^DD",200,200,7,21,3,0)
exabled for the user.
"^DD",200,200,7,21,4,0)
An example would be an external support person
"^DD",200,200,7,21,5,0)
that you only want to be able to log on to your system when you are
"^DD",200,200,7,21,6,0)
monitoring them.  Setting this field would prevent them from loging
"^DD",200,200,7,21,7,0)
on to the system untill you cleared the field.
"^DD",200,200,7,"DT")
3020213
"^DD",200,200,201,0)
PRIMARY MENU OPTION^*P19'X^DIC(19,^201;1^S DIC("S")="I $D(^XUSEC(""XUMGR"",DUZ))!$D(^VA(200,DUZ,19.5,+Y,0))" D ^DIC K DIC S DIC=DIE,X=+Y K:Y<0 X
"^DD",200,200,201,1,0)
^.1
"^DD",200,200,201,1,1,0)
200^AP
"^DD",200,200,201,1,1,1)
S ^VA(200,"AP",$E(X,1,30),DA)=""
"^DD",200,200,201,1,1,2)
K ^VA(200,"AP",$E(X,1,30),DA)
"^DD",200,200,201,1,2,0)
200^AI^MUMPS
"^DD",200,200,201,1,2,1)
D REDOXP^XQ7 Q
"^DD",200,200,201,1,2,2)
Q
"^DD",200,200,201,1,2,3)
This x-ref is used to facilitate microsurgery of the compiled menu trees.
"^DD",200,200,201,1,2,"%D",0)
^^4^4^2930303^
"^DD",200,200,201,1,2,"%D",1,0)
This cross-reference causes a node to be set in the "AT" cross-reference
"^DD",200,200,201,1,2,"%D",2,0)
of file 19, if there is not currently a "P" node for this option number
"^DD",200,200,201,1,2,"%D",3,0)
in ^XUTL("XQO","Pnum",    so that a tree will be built for this primary
"^DD",200,200,201,1,2,"%D",4,0)
menu.
"^DD",200,200,201,1,2,"DT")
2930303
"^DD",200,200,201,1,3,0)
200^AF^MUMPS
"^DD",200,200,201,1,3,1)
D CONTCL^XUSTERM1(DA)
"^DD",200,200,201,1,3,2)
D CONTCL^XUSTERM1(DA)
"^DD",200,200,201,1,3,3)
Clear Continue
"^DD",200,200,201,1,3,"%D",0)
^.101^3^3^3020725^^^
"^DD",200,200,201,1,3,"%D",1,0)
This X-ref calls code to clear the following fields  LAST OPTION ACCESSED
"^DD",200,200,201,1,3,"%D",2,0)
(202.1) and LAST OPTION MAIN MENU (202.2). This is too keep users from
"^DD",200,200,201,1,3,"%D",3,0)
getting asked to continue if there menu has changed.
"^DD",200,200,201,1,3,"DT")
3020411
"^DD",200,200,201,3)
IF NO PRIMARY MENU FOR TERMINAL, SIGN-ON WILL BRANCH TO THIS OPTION
"^DD",200,200,201,12)
Can only be edited by Site manager staff or SMD user.
"^DD",200,200,201,12.1)
S DIC("S")="I $D(^XUSEC(""XUMGR"",DUZ))!$D(^VA(200,DUZ,19.5,+Y,0))"
"^DD",200,200,201,21,0)
^^3^3^2940804^^^^
"^DD",200,200,201,21,1,0)
This is the menu option that this user will be dropped into
"^DD",200,200,201,21,2,0)
if none of the following are set: (in the order checked)
"^DD",200,200,201,21,3,0)
Tied routine, Device primary menu.
"^DD",200,200,201,"DT")
3020411
"^DD",200,200,203,0)
SECONDARY MENU OPTIONS^200.03IP^^203;0
"^DD",200,200,203,21,0)
^^1^1^2930415^^^
"^DD",200,200,203,21,1,0)
Options awarded a user not on his or her primary menu option
"^DD",200,200.03,0)
SECONDARY MENU OPTIONS SUB-FIELD^NL^2^2
"^DD",200,200.03,0,"NM","SECONDARY MENU OPTIONS")

"^DD",200,200.03,.01,0)
SECONDARY MENU OPTIONS^M*P19'^DIC(19,^0;1^S DIC("S")="I $D(^XUSEC(""XUMGR"",DUZ))!$D(^VA(200,DUZ,19.5,+Y,0))" D ^DIC K DIC S DIC=DIE,X=+Y K:Y<0 X
"^DD",200,200.03,.01,1,0)
^.1
"^DD",200,200.03,.01,1,1,0)
200^AD
"^DD",200,200.03,.01,1,1,1)
S ^VA(200,"AD",$E(X,1,30),DA(1),DA)=""
"^DD",200,200.03,.01,1,1,2)
K ^VA(200,"AD",$E(X,1,30),DA(1),DA)
"^DD",200,200.03,.01,1,2,0)
200^AOA^MUMPS
"^DD",200,200.03,.01,1,2,1)
S ^VA(200,DA(1),203.1)=$H
"^DD",200,200.03,.01,1,2,2)
S ^VA(200,DA(1),203.1)=$H
"^DD",200,200.03,.01,1,2,3)
Updates the timestamp field.
"^DD",200,200.03,.01,1,3,0)
200.03^AOB^MUMPS
"^DD",200,200.03,.01,1,3,1)
D REDOXP^XQ7
"^DD",200,200.03,.01,1,3,2)
Q
"^DD",200,200.03,.01,1,3,"%D",0)
^^5^5^2930415^^
"^DD",200,200.03,.01,1,3,"%D",1,0)
This cross reference checks for whether this entry creates a new
"^DD",200,200.03,.01,1,3,"%D",2,0)
entry in the compiled menu tree in XUTL("XQO",  If it is a new
"^DD",200,200.03,.01,1,3,"%D",3,0)
entry then a flag will be set by the code in XQ7 in the "AT"
"^DD",200,200.03,.01,1,3,"%D",4,0)
cross reference of the option file (^DIC(19,"AT",  to cause the
"^DD",200,200.03,.01,1,3,"%D",5,0)
menu tree to be generated.
"^DD",200,200.03,.01,1,3,"DT")
2900126
"^DD",200,200.03,.01,1,4,0)
200.03^B
"^DD",200,200.03,.01,1,4,1)
S ^VA(200,DA(1),203,"B",$E(X,1,30),DA)=""
"^DD",200,200.03,.01,1,4,2)
K ^VA(200,DA(1),203,"B",$E(X,1,30),DA)
"^DD",200,200.03,.01,1,4,"DT")
2960209
"^DD",200,200.03,.01,1,5,0)
200.03^AC^MUMPS
"^DD",200,200.03,.01,1,5,1)
D CONTCL^XUSTERM1(DA(1))
"^DD",200,200.03,.01,1,5,2)
D CONTCL^XUSTERM1(DA(1))
"^DD",200,200.03,.01,1,5,3)
Clear Continue
"^DD",200,200.03,.01,1,5,"%D",0)
^.101^3^3^3020411^^
"^DD",200,200.03,.01,1,5,"%D",1,0)
This X-ref calls code to clear the following fields  LAST OPTION ACCESSED
"^DD",200,200.03,.01,1,5,"%D",2,0)
(202.1) and LAST OPTION MAIN MENU (202.2). This is too keep users from
"^DD",200,200.03,.01,1,5,"%D",3,0)
getting asked to continue if there menu has changed.
"^DD",200,200.03,.01,1,5,"DT")
3020411
"^DD",200,200.03,.01,3)
Please enter a menu-type option.
"^DD",200,200.03,.01,12)
YOU MUST HAVE XUMGR OR HAVE BEEN DELEGATED THAT OPTION.
"^DD",200,200.03,.01,12.1)
S DIC("S")="I $D(^XUSEC(""XUMGR"",DUZ))!$D(^VA(200,DUZ,19.5,+Y,0))"
"^DD",200,200.03,.01,21,0)
^^3^3^2930415^^^^
"^DD",200,200.03,.01,21,1,0)
This is an option which is merged with the users primary menu
"^DD",200,200.03,.01,21,2,0)
and XUCOMMAND option, giving the user this option on all of her/his
"^DD",200,200.03,.01,21,3,0)
menus.
"^DD",200,200.03,.01,"DT")
3020411
**END**
**END**
