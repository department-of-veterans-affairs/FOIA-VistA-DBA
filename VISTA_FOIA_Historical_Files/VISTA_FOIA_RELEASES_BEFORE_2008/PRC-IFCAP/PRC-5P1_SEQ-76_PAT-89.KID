Released PRC*5.1*89 SEQ #76
Extracted from mail message
**KIDS**:PRC*5.1*89^

**INSTALL NAME**
PRC*5.1*89
"BLD",4934,0)
PRC*5.1*89^IFCAP^0^3051027^y
"BLD",4934,1,0)
^^3^3^3051027^
"BLD",4934,1,1,0)
This patchs corrects a problem with the PUBLIC LAW 100-322 REPORT.
"BLD",4934,1,2,0)
The report failed with a Null Subscript error if there were no
"BLD",4934,1,3,0)
records to report.
"BLD",4934,4,0)
^9.64PA^^
"BLD",4934,"KRN",0)
^9.67PA^8989.52^19
"BLD",4934,"KRN",.4,0)
.4
"BLD",4934,"KRN",.401,0)
.401
"BLD",4934,"KRN",.402,0)
.402
"BLD",4934,"KRN",.403,0)
.403
"BLD",4934,"KRN",.5,0)
.5
"BLD",4934,"KRN",.84,0)
.84
"BLD",4934,"KRN",3.6,0)
3.6
"BLD",4934,"KRN",3.8,0)
3.8
"BLD",4934,"KRN",9.2,0)
9.2
"BLD",4934,"KRN",9.8,0)
9.8
"BLD",4934,"KRN",9.8,"NM",0)
^9.68A^2^2
"BLD",4934,"KRN",9.8,"NM",1,0)
PRCHRPT9^^0^B22214451
"BLD",4934,"KRN",9.8,"NM",2,0)
PRCHRPTA^^0^B19570374
"BLD",4934,"KRN",9.8,"NM","B","PRCHRPT9",1)

"BLD",4934,"KRN",9.8,"NM","B","PRCHRPTA",2)

"BLD",4934,"KRN",19,0)
19
"BLD",4934,"KRN",19.1,0)
19.1
"BLD",4934,"KRN",101,0)
101
"BLD",4934,"KRN",409.61,0)
409.61
"BLD",4934,"KRN",771,0)
771
"BLD",4934,"KRN",870,0)
870
"BLD",4934,"KRN",8989.51,0)
8989.51
"BLD",4934,"KRN",8989.52,0)
8989.52
"BLD",4934,"KRN",8994,0)
8994
"BLD",4934,"KRN","B",.4,.4)

"BLD",4934,"KRN","B",.401,.401)

"BLD",4934,"KRN","B",.402,.402)

"BLD",4934,"KRN","B",.403,.403)

"BLD",4934,"KRN","B",.5,.5)

"BLD",4934,"KRN","B",.84,.84)

"BLD",4934,"KRN","B",3.6,3.6)

"BLD",4934,"KRN","B",3.8,3.8)

"BLD",4934,"KRN","B",9.2,9.2)

"BLD",4934,"KRN","B",9.8,9.8)

"BLD",4934,"KRN","B",19,19)

"BLD",4934,"KRN","B",19.1,19.1)

"BLD",4934,"KRN","B",101,101)

"BLD",4934,"KRN","B",409.61,409.61)

"BLD",4934,"KRN","B",771,771)

"BLD",4934,"KRN","B",870,870)

"BLD",4934,"KRN","B",8989.51,8989.51)

"BLD",4934,"KRN","B",8989.52,8989.52)

"BLD",4934,"KRN","B",8994,8994)

"BLD",4934,"QUES",0)
^9.62^^
"MBREQ")
0
"PKG",455,-1)
1^1
"PKG",455,0)
IFCAP^PRC^IFCAP System Files
"PKG",455,20,0)
^9.402P^^
"PKG",455,22,0)
^9.49I^1^1
"PKG",455,22,1,0)
5.1^3001012^3001019^68
"PKG",455,22,1,"PAH",1,0)
89^3051027
"PKG",455,22,1,"PAH",1,1,0)
^^3^3^3051027
"PKG",455,22,1,"PAH",1,1,1,0)
This patchs corrects a problem with the PUBLIC LAW 100-322 REPORT.
"PKG",455,22,1,"PAH",1,1,2,0)
The report failed with a Null Subscript error if there were no
"PKG",455,22,1,"PAH",1,1,3,0)
records to report.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
2
"RTN","PRCHRPT9")
0^1^B22214451
"RTN","PRCHRPT9",1,0)
PRCHRPT9 ;SF/TKW/WISC/CLH,AKS-PUBLIC LAW 100-322 REPORT ;3/19/93  16:41
"RTN","PRCHRPT9",2,0)
V ;;5.1;IFCAP;*89*;Oct 20, 2000
"RTN","PRCHRPT9",3,0)
 ;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","PRCHRPT9",4,0)
 ;
"RTN","PRCHRPT9",5,0)
EN1 S PRCF("X")="SP" D ^PRCFSITE Q:'$D(PRC("SITE"))
"RTN","PRCHRPT9",6,0)
 ;
"RTN","PRCHRPT9",7,0)
EN10 S PRCHD="DATE",M="DATE RECEIVED" D RNG^PRCHRPT1 G Q:FR["^"!(TO["^") I FR["?"!(TO["?") W $C(7),!!,"Enter a beginning and ending RECEIPT DATE range for this report." G EN10
"RTN","PRCHRPT9",8,0)
 S PRCHNULL=0 I (FR["@")!(TO["@") S PRCHNULL=1 S:FR["@" FR="" S:TO["@" TO="z"
"RTN","PRCHRPT9",9,0)
 W !! S PRCHDET=0,%A="Print Detail Report as well as Summary ",%B="Answer 'YES' to if you wish to print the Detail Report as well as",%B(1)="the Summary, 'NO' if you wish to print ONLY the summary.",%=1 D YN^PRCFYN G:%=-1 Q S:%=1 PRCHDET=1
"RTN","PRCHRPT9",10,0)
 ;
"RTN","PRCHRPT9",11,0)
EN11 K PRCHQ S PRCHQ="EN2^PRCHRPT9" D ^PRCHQUE
"RTN","PRCHRPT9",12,0)
 G Q
"RTN","PRCHRPT9",13,0)
 ;
"RTN","PRCHRPT9",14,0)
EN2 D NOW^%DTC S Y=% D DD^%DT S PRCHPDAT=Y K ^TMP($J) S PRCHSITE="** INVALID STATION **",X=$O(^PRC(411,"B",PRC("SITE"),0)) I $D(^PRC(411,+X,0)),$D(^DIC(4,+$P(^(0),U,10),0)) S PRCHSITE=$P(^(0),U,1)
"RTN","PRCHRPT9",15,0)
 S PRCHFT="ALL DATES" I FR S Y=FR D DD^%DT S PRCHFT=Y_" through "
"RTN","PRCHRPT9",16,0)
 S:'TO PRCHFT=PRCHFT_" LAST date" I TO S Y=TO D DD^%DT S PRCHFT=PRCHFT_Y
"RTN","PRCHRPT9",17,0)
 ;**** NOTE: FSC CODES SELECTED ARE SET HERE--CAN BE CHANGED BY ADDING OR DELETING FROM LIST IN TMP
"RTN","PRCHRPT9",18,0)
 F I=65,66,73 S ^TMP($J,"FSCG",I)=$P($G(^PRC(441.3,+I,0)),U,2)
"RTN","PRCHRPT9",19,0)
 S (PRCHPO,PRCHCNT)=0 D RD
"RTN","PRCHRPT9",20,0)
 ;
"RTN","PRCHRPT9",21,0)
P S PRCHPAGE=0,PRCHDY=99
"RTN","PRCHRPT9",22,0)
 I '$D(^TMP($J,"FSC")) D NONE^PRCHRPTA
"RTN","PRCHRPT9",23,0)
 I $D(^TMP($J,"FSC")) D:PRCHDET EN^PRCHRPTA S PRCHPAGE=0 D EN2^PRCHRPTA
"RTN","PRCHRPT9",24,0)
 W !,$C(13) D:$D(ZTSK) KILL^%ZTLOAD K ZTSK,ZTSKT
"RTN","PRCHRPT9",25,0)
 G Q
"RTN","PRCHRPT9",26,0)
 ;
"RTN","PRCHRPT9",27,0)
RD S PRCHPO=$O(^PRC(442,PRCHPO)) Q:'PRCHPO  G:'$D(^(PRCHPO,0)) RD G:'$D(^(1)) RD S PRCH0=^(0),X=^(1) G:+PRCH0'=PRC("SITE") RD G:'$O(^PRC(442,PRCHPO,11,0)) RD G:"13478"'[($P(PRCH0,U,2)) RD
"RTN","PRCHRPT9",28,0)
 G:$P(X,U,18)="N" RD S PRCHDT=$P(X,U,15) G:PRCHDT]TO RD
"RTN","PRCHRPT9",29,0)
 S PRCHV=+X,PRCHEMG=$P(X,U,17),PRCHSRC=$P($G(^PRCD(420.8,+$P(X,U,7),0)),U,1)
"RTN","PRCHRPT9",30,0)
 S PRCHI=0 D RD1
"RTN","PRCHRPT9",31,0)
 G RD
"RTN","PRCHRPT9",32,0)
 ;
"RTN","PRCHRPT9",33,0)
RD1 S PRCHI=$O(^PRC(442,PRCHPO,2,PRCHI)) Q:'PRCHI  G:'$O(^(PRCHI,3,0)) RD1 S PRCHI0=^PRC(442,PRCHPO,2,PRCHI,0)
"RTN","PRCHRPT9",34,0)
 I $D(^PRC(442,PRCHPO,2,PRCHI,2)) S X=+$P(^(2),U,3) I $D(^TMP($J,"FSCG",$E(X,1,2))) S PRCHFSC=X S:'$D(^TMP($J,"FSC",X)) ^TMP($J,"FSC",X)=$P($G(^PRC(441.2,X,0)),U,2) S PRCHR=0 D RD2
"RTN","PRCHRPT9",35,0)
 G RD1
"RTN","PRCHRPT9",36,0)
 ;
"RTN","PRCHRPT9",37,0)
RD2 S PRCHR=$O(^PRC(442,PRCHPO,2,PRCHI,3,PRCHR)) Q:'PRCHR  G:'$D(^(PRCHR,0)) RD2 S PRCHD0=^(0),PRCHRDT=$P(^(0),U,1) G:FR]PRCHRDT!(PRCHRDT]TO) RD2 D BLD
"RTN","PRCHRPT9",38,0)
 G RD2
"RTN","PRCHRPT9",39,0)
 ;
"RTN","PRCHRPT9",40,0)
BLD I '$D(^TMP($J,"V",PRCHV)) S:$D(^PRC(440,+PRCHV,0)) ^TMP($J,"V",PRCHV)=$P(^(0),U,1) S:'$D(^TMP($J,"V",PRCHV)) ^(PRCHV)="**INVALID VENDOR**"
"RTN","PRCHRPT9",41,0)
 S (PRCHDESC,ITEMNO)="",UNIT=0
"RTN","PRCHRPT9",42,0)
 I $D(^PRC(441,+$P(PRCHI0,U,5),0)) S PRCHDESC=$P(^(0),U,2),ITEMNO=$P(^(0),U,1)
"RTN","PRCHRPT9",43,0)
 I $D(^PRC(442,PRCHPO,2,PRCHI,0)) S UNIT=$P(^(0),U,3) S:UNIT'="" UNIT=$G(^PRCD(420.5,UNIT,0)),UNIT=$P(UNIT,U) S:UNIT="" UNIT=0
"RTN","PRCHRPT9",44,0)
 I PRCHDESC="" S X=$O(^PRC(442,PRCHPO,2,PRCHI,1,0)) I X,$D(^(X,0)) S PRCHDESC=^(0)
"RTN","PRCHRPT9",45,0)
 S:PRCHDESC="" PRCHDESC="** MISSING ITEM DESCRIPTION **"
"RTN","PRCHRPT9",46,0)
 S PRCHCNT=PRCHCNT+1,PRCHTOT=$P(PRCHD0,U,3),(X,PRCHNIIN)=$P(PRCHI0,U,13) I X]"" S PRCHNIIN=$P(X,"-",2)_"-"_$P(X,"-",3)_"-"_$P(X,"-",4)
"RTN","PRCHRPT9",47,0)
 I X']"" S PRCHNIIN=0
"RTN","PRCHRPT9",48,0)
 S FLG=0 I PRCHSRC=2 S FLG=1
"RTN","PRCHRPT9",49,0)
 I PRCHSRC="B"&($P($G(^PRC(442,PRCHPO,2,PRCHI,2)),U,2)="") S FLG=1
"RTN","PRCHRPT9",50,0)
 I 'FLG D SUM Q
"RTN","PRCHRPT9",51,0)
 S X=$G(^TMP($J,"R",PRCHFSC,$E(PRCHDESC,1,30),UNIT,PRCHNIIN,PRCHSRC))
"RTN","PRCHRPT9",52,0)
 S $P(X,U,2)=PRCHNIIN,$P(X,U,4)=$P(X,U,4)+$P(PRCHD0,U,2)
"RTN","PRCHRPT9",53,0)
 S $P(X,U,6)=$P(X,U,6)+PRCHTOT,$P(X,U,9)=PRCHSRC
"RTN","PRCHRPT9",54,0)
 S:$P(X,U,10)="" $P(X,U,10)=$P(PRCHI0,U,9)
"RTN","PRCHRPT9",55,0)
 I $P(PRCHI0,U,9)<$P(X,U,10) S $P(X,U,10)=$P(PRCHI0,U,9)
"RTN","PRCHRPT9",56,0)
 I $P(PRCHI0,U,9)>$P(X,U,11) S $P(X,U,11)=$P(PRCHI0,U,9)
"RTN","PRCHRPT9",57,0)
 S $P(X,U,12)=ITEMNO
"RTN","PRCHRPT9",58,0)
 S ^TMP($J,"R",PRCHFSC,$E(PRCHDESC,1,30),UNIT,PRCHNIIN,PRCHSRC)=X D SUM
"RTN","PRCHRPT9",59,0)
 Q
"RTN","PRCHRPT9",60,0)
 ;
"RTN","PRCHRPT9",61,0)
SUM S X=^TMP($J,"FSC",PRCHFSC),$P(X,U,2)=$P(X,U,2)+PRCHTOT I 'FLG S ^TMP($J,"FSC",PRCHFSC)=X Q
"RTN","PRCHRPT9",62,0)
 I FLG S $P(X,U,3)=$P(X,U,3)+PRCHTOT S I=$S(PRCHEMG="Y":4,1:5),$P(X,U,I)=$P(X,U,I)+PRCHTOT S ^TMP($J,"FSC",PRCHFSC)=X
"RTN","PRCHRPT9",63,0)
 Q
"RTN","PRCHRPT9",64,0)
 ;
"RTN","PRCHRPT9",65,0)
Q K %,%ZIS,IO("Q"),IOP,I,J,K,L,M,PRC,PRCF,PRCH0,PRCHCNT,PRCHD,PRCHD0,PRCHDESC,PRCHDET,PRCHDT,PRCHDY,PRCHEMG,PRCHFSC,PRCHFSCG,PRCHFT,PRCHGT,PRCHI
"RTN","PRCHRPT9",66,0)
 K PRCHPAGE,PRCHPDAT,PRCHPO,PRCHQ,PRCHR,PRCHRDT,PRCHSITE,PRCHSRC,PRCHT,PRCHTOT,PRCHV,ZTRTN,^TMP($J),FLG,PRCHTOTD,PRCHI0,PRCHNIIN,PRCHNULL
"RTN","PRCHRPT9",67,0)
 Q
"RTN","PRCHRPTA")
0^2^B19570374
"RTN","PRCHRPTA",1,0)
PRCHRPTA ;WISC/TKW-PUBLIC LAW 100-322 REPORT--CONTINUED ;4/13/93  11:15
"RTN","PRCHRPTA",2,0)
V ;;5.1;IFCAP;*89*;Oct 20, 2000
"RTN","PRCHRPTA",3,0)
 ;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","PRCHRPTA",4,0)
 ;
"RTN","PRCHRPTA",5,0)
EN S (PRCHTOT,PRCHTOTD)=0 D RD1 W $C(13) Q  ;W ?132,"___________",!!,?120,"**TOTAL**",?132,$J(PRCHTOT,11,2),!,$C(13)
"RTN","PRCHRPTA",6,0)
 Q
"RTN","PRCHRPTA",7,0)
 ;
"RTN","PRCHRPTA",8,0)
RD1 ;PRINT DETAILED REPORT
"RTN","PRCHRPTA",9,0)
 S PRCHFSC="" F J=1:1 S PRCHFSC=$O(^TMP($J,"R",PRCHFSC)) G:PRCHFSC="" Q D:PRCHDY>55 HDR S PRCHDY=PRCHDY+1 D RD2
"RTN","PRCHRPTA",10,0)
 Q
"RTN","PRCHRPTA",11,0)
 ;
"RTN","PRCHRPTA",12,0)
RD2 S PRCHDESC=0 F  S PRCHDESC=$O(^TMP($J,"R",PRCHFSC,PRCHDESC)) Q:PRCHDESC=""  D RD3
"RTN","PRCHRPTA",13,0)
 Q
"RTN","PRCHRPTA",14,0)
 ;
"RTN","PRCHRPTA",15,0)
RD3 S (PRCHV,L)="" F  S PRCHV=$O(^TMP($J,"R",PRCHFSC,PRCHDESC,PRCHV)) Q:PRCHV=""  F  S L=$O(^TMP($J,"R",PRCHFSC,PRCHDESC,PRCHV,L)) Q:L=""  S PRCHSRC="" D
"RTN","PRCHRPTA",16,0)
   . F  S PRCHSRC=$O(^TMP($J,"R",PRCHFSC,PRCHDESC,PRCHV,L,PRCHSRC)) Q:PRCHSRC=""  S X=^(PRCHSRC) I "2B"[$P(X,U,9) S AVRG=$S($P(X,U,4)'=0:($P(X,U,6))/($P(X,U,4)),1:0) S PRCHTOTD=PRCHTOTD+$P(X,U,6) D PRT
"RTN","PRCHRPTA",17,0)
 Q
"RTN","PRCHRPTA",18,0)
 ;
"RTN","PRCHRPTA",19,0)
PRT D:PRCHDY>60 HDR W PRCHDESC,?32,$J($P(X,U,12),5),?39,PRCHFSC,?46,$S($P(X,U,2)'=0:$P(X,U,2),1:"-"),?61,$J($FN($P(X,U,4),","),7),?73,$S(PRCHV'=0:PRCHV,1:"-")
"RTN","PRCHRPTA",20,0)
 W ?77,$J($P(X,U,6),11,2),?90,$J($P(X,U,10),9,2),?101,$J($P(X,U,11),9,2),?112,$J(AVRG,9,2),!
"RTN","PRCHRPTA",21,0)
 S PRCHTOT=PRCHTOT+$P(X,U,6),PRCHDY=PRCHDY+1
"RTN","PRCHRPTA",22,0)
 Q
"RTN","PRCHRPTA",23,0)
 ;
"RTN","PRCHRPTA",24,0)
HDR S PRCHPAGE=PRCHPAGE+1 W @IOF,?55,"P.L. 100-322 Local Procurement",!,?56,"Aggregated Item Detail Report",!,?108,$P(PRCHPDAT,"@"),?122,"PAGE ",PRCHPAGE,!
"RTN","PRCHRPTA",25,0)
 W ?4,"STATION: "_PRC("SITE")_"-"_PRCHSITE,!,"Dates Received: "_PRCHFT_"    FSC CODES: " F I=0:0 S I=$O(^TMP($J,"FSCG",I)) Q:'I  W I_" "
"RTN","PRCHRPTA",26,0)
 W "    Non-Expendable Purchases NOT Included",!
"RTN","PRCHRPTA",27,0)
 W ?33,"ITEM",?63,"TOTAL",?82,"TOTAL",?96,"LOW",?106,"HIGH",?115,"AVERAGE",!
"RTN","PRCHRPTA",28,0)
 W "DESCRIPTION",?32,"NUMBER",?40,"FSC",?48,"N.I.I.N",?62,"QUANTITY",?72,"UNIT",?81,"DOLLARS",?95,"COST",?106,"COST",?116,"COST",!
"RTN","PRCHRPTA",29,0)
 F I=0:1:(IOM-2) W "-"
"RTN","PRCHRPTA",30,0)
 W !! S PRCHDY=7
"RTN","PRCHRPTA",31,0)
 Q
"RTN","PRCHRPTA",32,0)
 ;
"RTN","PRCHRPTA",33,0)
EN2 ;PRINT SUMMARY TOTALS
"RTN","PRCHRPTA",34,0)
 D HDR2,RDS
"RTN","PRCHRPTA",35,0)
 Q
"RTN","PRCHRPTA",36,0)
 ;
"RTN","PRCHRPTA",37,0)
RDS S (PRCHFSCG,PRCHGT,PRCHT)="" F PRCHFSC=0:0 S PRCHFSC=$O(^TMP($J,"FSC",PRCHFSC)) Q:'PRCHFSC  D:$E(PRCHFSC,1,2)'=PRCHFSCG GT S X=^TMP($J,"FSC",PRCHFSC) D ACM W PRCHFSC_" "_$P(^TMP($J,"FSC",PRCHFSC),U,1) D PRT2
"RTN","PRCHRPTA",38,0)
 S:PRCHFSCG]"" PRCHFSCG="END" D GT,T
"RTN","PRCHRPTA",39,0)
 Q
"RTN","PRCHRPTA",40,0)
 ;
"RTN","PRCHRPTA",41,0)
PRT2 S PRCHTOT=+$P(X,U,2)
"RTN","PRCHRPTA",42,0)
 W ?41,$J(PRCHTOT,11,2) I PRCHTOT W ?60,$J($P(X,U,3),11,2),?79,$J((($P(X,U,3)/PRCHTOT)*100),6,2),?91,$J($P(X,U,4),11,2),?110,$J((($P(X,U,4)/PRCHTOT)*100),6,2),?122,$J($P(X,U,5),11,2),?141,$J((($P(X,U,5)/PRCHTOT)*100),6,2)
"RTN","PRCHRPTA",43,0)
 W ! S PRCHDY=PRCHDY+1
"RTN","PRCHRPTA",44,0)
 Q
"RTN","PRCHRPTA",45,0)
 ;
"RTN","PRCHRPTA",46,0)
GT ;PRINT GROUP SUB-TOTALS
"RTN","PRCHRPTA",47,0)
 D:PRCHDY>55 HDR2 I PRCHFSCG="" G GT1
"RTN","PRCHRPTA",48,0)
 W ?2,"SUB-TOTAL" S X=PRCHGT D PRT2 Q:PRCHFSCG="END"
"RTN","PRCHRPTA",49,0)
 ;
"RTN","PRCHRPTA",50,0)
GT1 S PRCHGT="",PRCHFSCG=$E(PRCHFSC,1,2)
"RTN","PRCHRPTA",51,0)
 W !,?2,"FSC GROUP: "_$S($D(^TMP($J,"FSCG",PRCHFSCG)):^(PRCHFSCG),1:"**INVALID**"),! S PRCHDY=PRCHDY+2
"RTN","PRCHRPTA",52,0)
 Q
"RTN","PRCHRPTA",53,0)
 ;
"RTN","PRCHRPTA",54,0)
ACM F I=2:1:5 S $P(PRCHGT,U,I)=$P(PRCHGT,U,I)+$P(X,U,I),$P(PRCHT,U,I)=$P(PRCHT,U,I)+$P(X,U,I)
"RTN","PRCHRPTA",55,0)
 Q
"RTN","PRCHRPTA",56,0)
 ;
"RTN","PRCHRPTA",57,0)
T S I="___________" W ?41,I,?60,I,?79,$E(I,1,6),?91,I,?110,$E(I,1,6),?122,I,?141,$E(I,1,6),!
"RTN","PRCHRPTA",58,0)
 S PRCHDY=PRCHDY+1,X=PRCHT W ?1,"* TOTAL *" D PRT2
"RTN","PRCHRPTA",59,0)
 Q
"RTN","PRCHRPTA",60,0)
 ;
"RTN","PRCHRPTA",61,0)
HDR2 S PRCHPAGE=PRCHPAGE+1 W @IOF,?55,"P.L. 100-322 SUMMARY TOTALS REPORT",?108,$P(PRCHPDAT,"@"),?122,"PAGE ",PRCHPAGE,!
"RTN","PRCHRPTA",62,0)
 W ?4,"STATION: "_PRC("SITE")_"-"_PRCHSITE,!,"Dates Received: "_PRCHFT_"      FSC CODES: " F I=0:0 S I=$O(^TMP($J,"FSCG",I)) Q:'I  W I_" "
"RTN","PRCHRPTA",63,0)
 W "     Non-Expendable Purchases NOT Included",!!
"RTN","PRCHRPTA",64,0)
 W ?63,"ALL OPEN",?81,"% OF",?94,"OPEN MKT",?112,"% OF",?123,"OPEN MARKET",?143,"% OF",!
"RTN","PRCHRPTA",65,0)
 W "FSC",?47,"TOTAL",?65,"MARKET",?80,"TOTAL",?93,"EMERGENCY",?111,"TOTAL",?120,"LESS EMERGENCY",?142,"TOTAL",!
"RTN","PRCHRPTA",66,0)
 F J=0:1:(IOM-2) W "-"
"RTN","PRCHRPTA",67,0)
 W !! S PRCHDY=8
"RTN","PRCHRPTA",68,0)
 Q
"RTN","PRCHRPTA",69,0)
 ;
"RTN","PRCHRPTA",70,0)
NONE ; perform this if no records were gathered
"RTN","PRCHRPTA",71,0)
 D HDR
"RTN","PRCHRPTA",72,0)
 W !,"No records matched the selected criteria.",!
"RTN","PRCHRPTA",73,0)
 Q
"RTN","PRCHRPTA",74,0)
 ;
"RTN","PRCHRPTA",75,0)
Q D:PRCHDY>55 HDR S PRCHDY=PRCHDY+1 W ?77,"___________",!," * TOTAL *",?80,PRCHTOTD
"RTN","PRCHRPTA",76,0)
 Q
"VER")
8.0^22.0
"BLD",4934,6)
^76
**END**
**END**
