Released DG*5.3*684 SEQ #593
Extracted from mail message
**KIDS**:DG*5.3*684^

**INSTALL NAME**
DG*5.3*684
"BLD",5786,0)
DG*5.3*684^REGISTRATION^0^3051026^y
"BLD",5786,1,0)
^^2^2^3051026^
"BLD",5786,1,1,0)
Please refer to patch DG*5.3*684 in the National Patch Module for a
"BLD",5786,1,2,0)
complete description of this patch.
"BLD",5786,4,0)
^9.64PA^^
"BLD",5786,"KRN",0)
^9.67PA^8989.52^19
"BLD",5786,"KRN",.4,0)
.4
"BLD",5786,"KRN",.401,0)
.401
"BLD",5786,"KRN",.402,0)
.402
"BLD",5786,"KRN",.403,0)
.403
"BLD",5786,"KRN",.5,0)
.5
"BLD",5786,"KRN",.84,0)
.84
"BLD",5786,"KRN",3.6,0)
3.6
"BLD",5786,"KRN",3.8,0)
3.8
"BLD",5786,"KRN",9.2,0)
9.2
"BLD",5786,"KRN",9.8,0)
9.8
"BLD",5786,"KRN",9.8,"NM",0)
^9.68A^1^1
"BLD",5786,"KRN",9.8,"NM",1,0)
DGSEC4^^0^B41969635
"BLD",5786,"KRN",9.8,"NM","B","DGSEC4",1)

"BLD",5786,"KRN",19,0)
19
"BLD",5786,"KRN",19.1,0)
19.1
"BLD",5786,"KRN",101,0)
101
"BLD",5786,"KRN",409.61,0)
409.61
"BLD",5786,"KRN",771,0)
771
"BLD",5786,"KRN",870,0)
870
"BLD",5786,"KRN",8989.51,0)
8989.51
"BLD",5786,"KRN",8989.52,0)
8989.52
"BLD",5786,"KRN",8994,0)
8994
"BLD",5786,"KRN","B",.4,.4)

"BLD",5786,"KRN","B",.401,.401)

"BLD",5786,"KRN","B",.402,.402)

"BLD",5786,"KRN","B",.403,.403)

"BLD",5786,"KRN","B",.5,.5)

"BLD",5786,"KRN","B",.84,.84)

"BLD",5786,"KRN","B",3.6,3.6)

"BLD",5786,"KRN","B",3.8,3.8)

"BLD",5786,"KRN","B",9.2,9.2)

"BLD",5786,"KRN","B",9.8,9.8)

"BLD",5786,"KRN","B",19,19)

"BLD",5786,"KRN","B",19.1,19.1)

"BLD",5786,"KRN","B",101,101)

"BLD",5786,"KRN","B",409.61,409.61)

"BLD",5786,"KRN","B",771,771)

"BLD",5786,"KRN","B",870,870)

"BLD",5786,"KRN","B",8989.51,8989.51)

"BLD",5786,"KRN","B",8989.52,8989.52)

"BLD",5786,"KRN","B",8994,8994)

"BLD",5786,"QUES",0)
^9.62^^
"BLD",5786,"REQB",0)
^9.611^1^1
"BLD",5786,"REQB",1,0)
DG*5.3*471^2
"BLD",5786,"REQB","B","DG*5.3*471",1)

"MBREQ")
0
"PKG",5,-1)
1^1
"PKG",5,0)
REGISTRATION^DG^PATIENT REGISTRATION, ADMISSION, DISCHARGE, EMBOSSER 
"PKG",5,20,0)
^9.402P^^
"PKG",5,22,0)
^9.49I^1^1
"PKG",5,22,1,0)
5.3^2941102^2941102
"PKG",5,22,1,"PAH",1,0)
684^3051026
"PKG",5,22,1,"PAH",1,1,0)
^^2^2^3051026
"PKG",5,22,1,"PAH",1,1,1,0)
Please refer to patch DG*5.3*684 in the National Patch Module for a
"PKG",5,22,1,"PAH",1,1,2,0)
complete description of this patch.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
1
"RTN","DGSEC4")
0^1^B41969635
"RTN","DGSEC4",1,0)
DGSEC4 ;ALB/MM,JAP - Utilities for record access & sensitive record processing;10/6/99 ; 10/26/05 12:46pm
"RTN","DGSEC4",2,0)
 ;;5.3;Registration;**249,281,391,471,684**;Aug 13, 1993
"RTN","DGSEC4",3,0)
 ;
"RTN","DGSEC4",4,0)
 ;Line tags OWNREC & SENS moved from DGSEC in DG*5.3*249 when DGSEC 
"RTN","DGSEC4",5,0)
 ;reached the maximum routine size.
"RTN","DGSEC4",6,0)
 ;
"RTN","DGSEC4",7,0)
PTSEC(RESULT,DFN,DGMSG,DGOPT) ;RPC/API entry point for patient sensitive & record access checks
"RTN","DGSEC4",8,0)
 ;Output array (Required)
"RTN","DGSEC4",9,0)
 ;    RESULT(1)= -1-RPC/API failed
"RTN","DGSEC4",10,0)
 ;                  Required variable not defined
"RTN","DGSEC4",11,0)
 ;                0-No display/action required
"RTN","DGSEC4",12,0)
 ;                  Not accessing own, employee, or sensitive record
"RTN","DGSEC4",13,0)
 ;                1-Display warning message
"RTN","DGSEC4",14,0)
 ;                  Sensitive and DG SENSITIVITY key holder
"RTN","DGSEC4",15,0)
 ;                  or Employee and DG SECURITY OFFICER key holder
"RTN","DGSEC4",16,0)
 ;                2-Display warning message/require OK to continue
"RTN","DGSEC4",17,0)
 ;                  Sensitive and not a DG SENSITIVITY key holder
"RTN","DGSEC4",18,0)
 ;                  Employee and not a DG SECURITY OFFICER key holder
"RTN","DGSEC4",19,0)
 ;                3-Access to record denied
"RTN","DGSEC4",20,0)
 ;                  Accessing own record
"RTN","DGSEC4",21,0)
 ;                4-Access to Patient (#2) file records denied
"RTN","DGSEC4",22,0)
 ;                  SSN not defined
"RTN","DGSEC4",23,0)
 ;   RESULT(2-10) = error or display messages
"RTN","DGSEC4",24,0)
 ;
"RTN","DGSEC4",25,0)
 ;Input parameters: DFN = Patient file entry (Required)
"RTN","DGSEC4",26,0)
 ;                  DGMSG = If 1, generate message (optional)
"RTN","DGSEC4",27,0)
 ;                  DGOPT  = Option name^Menu text (Optional)
"RTN","DGSEC4",28,0)
 ;
"RTN","DGSEC4",29,0)
 K RESULT
"RTN","DGSEC4",30,0)
 I $G(DFN)="" D  Q
"RTN","DGSEC4",31,0)
 .S RESULT(1)=-1
"RTN","DGSEC4",32,0)
 .S RESULT(2)="Required variable missing."
"RTN","DGSEC4",33,0)
 S DGMSG=$G(DGMSG)
"RTN","DGSEC4",34,0)
 D OWNREC(.RESULT,DFN,$G(DUZ),DGMSG)
"RTN","DGSEC4",35,0)
 I RESULT(1)=1 S RESULT(1)=3 Q
"RTN","DGSEC4",36,0)
 I RESULT(1)=2 S RESULT(1)=4 Q
"RTN","DGSEC4",37,0)
 K RESULT
"RTN","DGSEC4",38,0)
 D SENS(.RESULT,DFN,$G(DUZ))
"RTN","DGSEC4",39,0)
 I RESULT(1)=1 D
"RTN","DGSEC4",40,0)
 .I $G(DUZ)="" D  Q
"RTN","DGSEC4",41,0)
 ..;DUZ must be defined to access sensitive record & update DG Security log
"RTN","DGSEC4",42,0)
 ..S RESULT(1)=-1
"RTN","DGSEC4",43,0)
 ..S RESULT(2)="Your user code is undefined.  This must be defined to access a restricted patient record."
"RTN","DGSEC4",44,0)
 .D SETLOG1^DGSEC(DFN,DUZ,,$G(DGOPT))
"RTN","DGSEC4",45,0)
 Q
"RTN","DGSEC4",46,0)
NOTICE(RESULT,DFN,DGOPT,ACTION) ;RPC/API entry point for log entry and message generation
"RTN","DGSEC4",47,0)
 ;Input parameters:  
"RTN","DGSEC4",48,0)
 ;  DFN    = Patient file DFN
"RTN","DGSEC4",49,0)
 ;  DGOPT  = Option name^Menu text (Optional)
"RTN","DGSEC4",50,0)
 ;  ACTION = 1 - Set DG Security Log entry, 2 - Generate mail 
"RTN","DGSEC4",51,0)
 ;           message, 3 - Both (Optional - Defaults to both)
"RTN","DGSEC4",52,0)
 ;
"RTN","DGSEC4",53,0)
 ;Output:  RESULT = 1 - DG Security Log updated and/or Sensitive Record msg sent (Determined by ACTION value)
"RTN","DGSEC4",54,0)
 ;                  0 - Required variable undefined
"RTN","DGSEC4",55,0)
 ;
"RTN","DGSEC4",56,0)
 I $G(DFN)="" S RESULT=0 Q
"RTN","DGSEC4",57,0)
 I $G(DUZ)="" S RESULT=0 Q
"RTN","DGSEC4",58,0)
 S DGOPT=$G(DGOPT)
"RTN","DGSEC4",59,0)
 I $G(ACTION)="" S ACTION=3
"RTN","DGSEC4",60,0)
 I ACTION'=1 D BULTIN1^DGSEC(DFN,DUZ,DGOPT)
"RTN","DGSEC4",61,0)
 I ACTION'=2 D SETLOG1^DGSEC(DFN,DUZ,,DGOPT)
"RTN","DGSEC4",62,0)
 S RESULT=1
"RTN","DGSEC4",63,0)
 Q
"RTN","DGSEC4",64,0)
 ;
"RTN","DGSEC4",65,0)
OWNREC(DGREC,DFN,DGDUZ,DGMSG,DGNEWPT,DGPTSSN) ;Determine if user accessing his/her own Patient file (#2) record
"RTN","DGSEC4",66,0)
 ;Input:
"RTN","DGSEC4",67,0)
 ; DGREC - Array name passed by reference
"RTN","DGSEC4",68,0)
 ; DFN - Patient (#2) file IEN
"RTN","DGSEC4",69,0)
 ; DGDUZ - New Person (#200) file IEN (Not required. If not sent will return 0.)
"RTN","DGSEC4",70,0)
 ; DGMSG - If 1, generate message (Optional) Will default to 1
"RTN","DGSEC4",71,0)
 ; DGNEWPT - Set to 1 when adding a new entry to the Patient file
"RTN","DGSEC4",72,0)
 ; DGPTSSN - new patient's SSN
"RTN","DGSEC4",73,0)
 ;   DGNEWPT & DGPTSSN parameters only defined if DPTLK is adding
"RTN","DGSEC4",74,0)
 ;   a new Patient (#2) file entry  
"RTN","DGSEC4",75,0)
 ;
"RTN","DGSEC4",76,0)
 ;Output:
"RTN","DGSEC4",77,0)
 ; DGREC(1)=0 - Not attempting to access own Patient (#2) file record, 
"RTN","DGSEC4",78,0)
 ;            DUZ not defined, RESTRICT PATIENT RECORD ACCESS parameter
"RTN","DGSEC4",79,0)
 ;            in MAS Parameters (#43) file not set to yes, or user holds
"RTN","DGSEC4",80,0)
 ;            DG RECORD ACCESS security key.
"RTN","DGSEC4",81,0)
 ;         =1 - Attempting to access own Patient file record
"RTN","DGSEC4",82,0)
 ;         =2 - SSN undefined
"RTN","DGSEC4",83,0)
 ;         =-1 - Required variable not defined.
"RTN","DGSEC4",84,0)
 ; Other nodes in array will contain error message text.
"RTN","DGSEC4",85,0)
 ;
"RTN","DGSEC4",86,0)
 ;DFN required
"RTN","DGSEC4",87,0)
 I '$D(DFN),($G(DGNEWPT)'=1) D  Q
"RTN","DGSEC4",88,0)
 .S DGREC(1)=-1
"RTN","DGSEC4",89,0)
 .S DGREC(2)="DFN not defined."
"RTN","DGSEC4",90,0)
 S DGREC(1)=0
"RTN","DGSEC4",91,0)
 ;Check if parameter is on
"RTN","DGSEC4",92,0)
 I +$P($G(^DG(43,1,"REC")),U)=0 Q
"RTN","DGSEC4",93,0)
 N DGNPSSN
"RTN","DGSEC4",94,0)
 ;I $D(DUZ)=0 Q
"RTN","DGSEC4",95,0)
 I (+$G(DGDUZ))<1 Q
"RTN","DGSEC4",96,0)
 ;Check if user holds security key
"RTN","DGSEC4",97,0)
 I $D(^XUSEC("DG RECORD ACCESS",DGDUZ)) Q
"RTN","DGSEC4",98,0)
 I $G(DGMSG)="" S DGMSG=1
"RTN","DGSEC4",99,0)
 N DGNPERR
"RTN","DGSEC4",100,0)
 S DGNPSSN=$$GET1^DIQ(200,DGDUZ_",",9,"I","","DGNPERR")
"RTN","DGSEC4",101,0)
 I 'DGNPSSN D  Q
"RTN","DGSEC4",102,0)
 .S DGREC(1)=2
"RTN","DGSEC4",103,0)
 .S DGREC(2)="Your SSN is missing from the NEW PERSON file.  Contact your ADP Coordinator."
"RTN","DGSEC4",104,0)
 .;Only send message if parameter set to 1
"RTN","DGSEC4",105,0)
 .I DGMSG=1 D MSG(DGDUZ)
"RTN","DGSEC4",106,0)
 I +$G(DGNEWPT)'=1 S DGPTSSN=$P($G(^DPT(DFN,0)),U,9)
"RTN","DGSEC4",107,0)
 I +$G(DGNEWPT)=1 S DGPTSSN=$TR(DGPTSSN,"-","")
"RTN","DGSEC4",108,0)
 I DGNPSSN=DGPTSSN D  Q
"RTN","DGSEC4",109,0)
 .S DGREC(1)=1
"RTN","DGSEC4",110,0)
 .S DGREC(2)="Security regulations prohibit computer access to your own medical record."
"RTN","DGSEC4",111,0)
 Q
"RTN","DGSEC4",112,0)
MSG(DGDUZ) ;Send Missing SSN in New Person file message to mailgroup
"RTN","DGSEC4",113,0)
 ;Input:  DGDUZ - New Person (#200) file IEN (Required)
"RTN","DGSEC4",114,0)
 ;
"RTN","DGSEC4",115,0)
 N DGNPERR,DGNPNAME,DGTEXT,XMCHAN,XMDUZ,XMSUB,XMTEXT,XMY,XMZ
"RTN","DGSEC4",116,0)
 S DGNPNAME=$$GET1^DIQ(200,DGDUZ_",",.01,"","DGNPERR")
"RTN","DGSEC4",117,0)
 S XMSUB="MISSING SSN IN NEW PERSON FILE"
"RTN","DGSEC4",118,0)
 S DGTEXT(1)="The following NEW PERSON record does not contain a Social Security Number."
"RTN","DGSEC4",119,0)
 S DGTEXT(2)="This is required to access PATIENT file entries."
"RTN","DGSEC4",120,0)
 S DGTEXT(3)=""
"RTN","DGSEC4",121,0)
 S DGTEXT(4)=$S(DGNPNAME'="":DGNPNAME,1:"UNKNOWN")
"RTN","DGSEC4",122,0)
 S DGTEXT(5)="NEW PERSON (#200) File Internal Entry Number (DUZ):  "_+DGDUZ
"RTN","DGSEC4",123,0)
 S DGTEXT(6)=""
"RTN","DGSEC4",124,0)
 S DGTEXT(7)="This message has been sent to DG MISSING NEW PERSON SSN mail group."
"RTN","DGSEC4",125,0)
 S DGTEXT(8)="Please take appropriate action."
"RTN","DGSEC4",126,0)
 S XMTEXT="DGTEXT("
"RTN","DGSEC4",127,0)
 S XMDUZ=$S(DGNPNAME'="":DGNPNAME,1:.5)
"RTN","DGSEC4",128,0)
 S XMY("G.DG MISSING NEW PERSON SSN")=""
"RTN","DGSEC4",129,0)
 S XMCHAN=1
"RTN","DGSEC4",130,0)
 D ^XMD
"RTN","DGSEC4",131,0)
 Q
"RTN","DGSEC4",132,0)
SENS(DGSENS,DFN,DGDUZ,DDS,DGSENFLG) ;Determine if sensitive record
"RTN","DGSEC4",133,0)
 ;Input:
"RTN","DGSEC4",134,0)
 ;  DGSENS - Array name passed by reference
"RTN","DGSEC4",135,0)
 ;  DFN - Patient (#2) file IEN (Required)
"RTN","DGSEC4",136,0)
 ;  DGDUZ - New Person (#200) file IEN
"RTN","DGSEC4",137,0)
 ;  DDS - Screenman variable
"RTN","DGSEC4",138,0)
 ;  DGSENFLG - If defined, patient record sensitivity not checked
"RTN","DGSEC4",139,0)
 ;
"RTN","DGSEC4",140,0)
 ;Output:
"RTN","DGSEC4",141,0)
 ;  DGSENS(1)=0 - Record is not sensitive or DGSENFLG set
"RTN","DGSEC4",142,0)
 ;           =1 - Sensitive record and user holds DG SENSITIVITY key
"RTN","DGSEC4",143,0)
 ;              - Employee and user holds DG SECURITY OFFICER key
"RTN","DGSEC4",144,0)
 ;           =2 - Sensitive record and user does not hold key
"RTN","DGSEC4",145,0)
 ;              - Employee and user does not hold key
"RTN","DGSEC4",146,0)
 ;           =-1 - Required input variable not defined
"RTN","DGSEC4",147,0)
 ;  If 1, 2 or -1, array will contain error/display message
"RTN","DGSEC4",148,0)
 ;
"RTN","DGSEC4",149,0)
 N DGMSG,DGA1,DG1,DGDATE,DGLNE,DGT,DGTIME,DGEMPLEE
"RTN","DGSEC4",150,0)
 ;Patient file DFN must be defined.
"RTN","DGSEC4",151,0)
 I '$D(DFN) D  Q 
"RTN","DGSEC4",152,0)
 .S DGSENS(1)=-1
"RTN","DGSEC4",153,0)
 .S DGSENS(2)="DFN not defined."
"RTN","DGSEC4",154,0)
 S DGSENS(1)=0
"RTN","DGSEC4",155,0)
 I $D(DGSENFLG) Q
"RTN","DGSEC4",156,0)
 ;Determine if patient is employee
"RTN","DGSEC4",157,0)
 S DGEMPLEE=$$EMPL(DFN)
"RTN","DGSEC4",158,0)
 ;Quit if not an employee & not found in DG Security Log file
"RTN","DGSEC4",159,0)
 I 'DGEMPLEE,('$D(^DGSL(38.1,+DFN,0))) Q
"RTN","DGSEC4",160,0)
 ;Quit if not an employee and not flagged as sensitive
"RTN","DGSEC4",161,0)
 I 'DGEMPLEE,($P($G(^DGSL(38.1,+DFN,0)),U,2)'=1) Q
"RTN","DGSEC4",162,0)
 ;DUZ & user name must be defined
"RTN","DGSEC4",163,0)
 S DGMSG=$S('$G(DGDUZ):"user code",'$D(^VA(200,DGDUZ,0)):"user name",1:"")
"RTN","DGSEC4",164,0)
 I DGMSG'="" D  Q
"RTN","DGSEC4",165,0)
 .S DGSENS(1)=-1
"RTN","DGSEC4",166,0)
 .S DGSENS(2)="Your "_DGMSG_" is undefined.  This must be defined to access"
"RTN","DGSEC4",167,0)
 .S DGSENS(3)=" a restricted patient record."
"RTN","DGSEC4",168,0)
 S DGSENS(1)=1
"RTN","DGSEC4",169,0)
 ;Inpatient check - no longer used (kept for future reference)
"RTN","DGSEC4",170,0)
 ;D H^DGUTL S DGT=DGTIME D ^DGPMSTAT
"RTN","DGSEC4",171,0)
 S DGSENS(2)="***WARNING***"
"RTN","DGSEC4",172,0)
 I $G(DDS)'="" S DGSENS(2)=DGSENS(2)_"  ***RESTRICTED RECORD***"
"RTN","DGSEC4",173,0)
 I $G(DDS)="" S DGSENS(3)="***RESTRICTED RECORD***"
"RTN","DGSEC4",174,0)
 I DGEMPLEE,('$D(^XUSEC("DG SECURITY OFFICER",+$G(DGDUZ)))) D  Q
"RTN","DGSEC4",175,0)
 .S DGSENS(1)=2
"RTN","DGSEC4",176,0)
 .D PRIV
"RTN","DGSEC4",177,0)
 I '$D(^XUSEC("DG SENSITIVITY",+$G(DGDUZ))) D
"RTN","DGSEC4",178,0)
 .S DGSENS(1)=2
"RTN","DGSEC4",179,0)
 .D PRIV
"RTN","DGSEC4",180,0)
 Q
"RTN","DGSEC4",181,0)
PRIV ;Privacy Act statement for DGSENS array
"RTN","DGSEC4",182,0)
 S $P(DGLNE,"* ",38)=""
"RTN","DGSEC4",183,0)
 I $G(DDS)="" S DGSENS(4)=DGLNE
"RTN","DGSEC4",184,0)
 S DGSENS(5)="* This record is protected by the Privacy Act of 1974 and the Health    *"
"RTN","DGSEC4",185,0)
 S DGSENS(6)="* Insurance Portability and Accountability Act of 1996. If you elect    *"
"RTN","DGSEC4",186,0)
 S DGSENS(7)="* to proceed, you will be required to prove you have a need to know.    *"
"RTN","DGSEC4",187,0)
 S DGSENS(8)="* Accessing this patient is tracked, and your station Security Officer  *"
"RTN","DGSEC4",188,0)
 S DGSENS(9)="* will contact you for your justification.                              *"
"RTN","DGSEC4",189,0)
 I $G(DDS)="" S DGSENS(10)=DGLNE
"RTN","DGSEC4",190,0)
EMPL(DFN,DGCHELIG) ;Does patient have any eligibility codes equal to
"RTN","DGSEC4",191,0)
 ;                EMPLOYEE
"RTN","DGSEC4",192,0)
 ;Input:
"RTN","DGSEC4",193,0)
 ;       DFN - Patient (#2) file IEN (required).
"RTN","DGSEC4",194,0)
 ;  DGCHELIG - Flags to determine mode of execution (optional).
"RTN","DGSEC4",195,0)
 ;             Value of the parameter can contain any combination
"RTN","DGSEC4",196,0)
 ;             of the following characters:
"RTN","DGSEC4",197,0)
 ;               "P" - check primary eligibility code
"RTN","DGSEC4",198,0)
 ;               "S" - check secondary eligibility codes
"RTN","DGSEC4",199,0)
 ;
"RTN","DGSEC4",200,0)
 ;             If this parameter is either not defined or set to an
"RTN","DGSEC4",201,0)
 ;             illegal value, the value of "PS" will be assumed.
"RTN","DGSEC4",202,0)
 ;Output:
"RTN","DGSEC4",203,0)
 ;         1 - Patient has EMPLOYEE as an eligibility code
"RTN","DGSEC4",204,0)
 ;         0 - Patient doesn't have EMPLOYEE as an eligibility code
"RTN","DGSEC4",205,0)
 ;
"RTN","DGSEC4",206,0)
 ;Notes: EMPLOYEE is entry 14 in the MAS ELIGIBILITY CODE file (#8.1)
"RTN","DGSEC4",207,0)
 N DGELIG,DGEMPLEE
"RTN","DGSEC4",208,0)
 S DGEMPLEE=0
"RTN","DGSEC4",209,0)
 I $G(DGCHELIG)'["P",$G(DGCHELIG)'["S" S DGCHELIG="PS"
"RTN","DGSEC4",210,0)
 ;Check primary eligibility
"RTN","DGSEC4",211,0)
 I DGCHELIG["P" D
"RTN","DGSEC4",212,0)
 .S DGELIG=+$G(^DPT(DFN,.36))
"RTN","DGSEC4",213,0)
 .I $D(^DIC(8,"D",14,DGELIG)) S DGEMPLEE=1
"RTN","DGSEC4",214,0)
 ;Check secondary eligibilities (if needed)
"RTN","DGSEC4",215,0)
 I DGCHELIG["S",'DGEMPLEE D
"RTN","DGSEC4",216,0)
 .S DGELIG=0
"RTN","DGSEC4",217,0)
 .F  S DGELIG=+$O(^DPT("AEL",DFN,DGELIG)) Q:'DGELIG  I $D(^DIC(8,"D",14,DGELIG)) S DGEMPLEE=1 Q
"RTN","DGSEC4",218,0)
 Q DGEMPLEE
"VER")
8.0^22.0
"BLD",5786,6)
^593
**END**
**END**
