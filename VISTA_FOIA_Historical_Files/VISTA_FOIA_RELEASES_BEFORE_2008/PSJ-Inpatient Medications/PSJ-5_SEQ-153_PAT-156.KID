EMERGENCY Released PSJ*5*156 SEQ #153
Extracted from mail message
**KIDS**:PSJ*5.0*156^

**INSTALL NAME**
PSJ*5.0*156
"BLD",6417,0)
PSJ*5.0*156^INPATIENT MEDICATIONS^0^3060418^y
"BLD",6417,1,0)
^^11^11^3060405^
"BLD",6417,1,1,0)
A provider entered a medication through CPRS with the intent of the order 
"BLD",6417,1,2,0)
being administered on a QD0600 continuous schedule.  The medication 
"BLD",6417,1,3,0)
ordered, however, had a default schedule type of PRN.  Therefore, when 
"BLD",6417,1,4,0)
the pharmacist finished the order backdoor, the default schedule type of 
"BLD",6417,1,5,0)
PRN overrode the Provider's intent of a continuous schedule.  Because the 
"BLD",6417,1,6,0)
medication was finished as PRN, the patient missed a dose of the 
"BLD",6417,1,7,0)
medication.
"BLD",6417,1,8,0)
 
"BLD",6417,1,9,0)
This patch addresses this issue by only allowing the backdoor default
"BLD",6417,1,10,0)
schedule type to override the incoming CPRS schedule type if the backdoor
"BLD",6417,1,11,0)
default is "Fill on Request".
"BLD",6417,4,0)
^9.64PA^^
"BLD",6417,"KRN",0)
^9.67PA^8989.52^19
"BLD",6417,"KRN",.4,0)
.4
"BLD",6417,"KRN",.4,"NM",0)
^9.68A^^0
"BLD",6417,"KRN",.401,0)
.401
"BLD",6417,"KRN",.402,0)
.402
"BLD",6417,"KRN",.402,"NM",0)
^9.68A^^0
"BLD",6417,"KRN",.403,0)
.403
"BLD",6417,"KRN",.5,0)
.5
"BLD",6417,"KRN",.84,0)
.84
"BLD",6417,"KRN",3.6,0)
3.6
"BLD",6417,"KRN",3.6,"NM",0)
^9.68A^^0
"BLD",6417,"KRN",3.8,0)
3.8
"BLD",6417,"KRN",3.8,"NM",0)
^9.68A^^0
"BLD",6417,"KRN",9.2,0)
9.2
"BLD",6417,"KRN",9.8,0)
9.8
"BLD",6417,"KRN",9.8,"NM",0)
^9.68A^1^1
"BLD",6417,"KRN",9.8,"NM",1,0)
PSGOE6^^0^23062511
"BLD",6417,"KRN",9.8,"NM","B","PSGOE6",1)

"BLD",6417,"KRN",19,0)
19
"BLD",6417,"KRN",19,"NM",0)
^9.68A^^0
"BLD",6417,"KRN",19.1,0)
19.1
"BLD",6417,"KRN",19.1,"NM",0)
^9.68A^^0
"BLD",6417,"KRN",101,0)
101
"BLD",6417,"KRN",101,"NM",0)
^9.68A^^0
"BLD",6417,"KRN",409.61,0)
409.61
"BLD",6417,"KRN",409.61,"NM",0)
^9.68A^^0
"BLD",6417,"KRN",771,0)
771
"BLD",6417,"KRN",870,0)
870
"BLD",6417,"KRN",8989.51,0)
8989.51
"BLD",6417,"KRN",8989.52,0)
8989.52
"BLD",6417,"KRN",8994,0)
8994
"BLD",6417,"KRN","B",.4,.4)

"BLD",6417,"KRN","B",.401,.401)

"BLD",6417,"KRN","B",.402,.402)

"BLD",6417,"KRN","B",.403,.403)

"BLD",6417,"KRN","B",.5,.5)

"BLD",6417,"KRN","B",.84,.84)

"BLD",6417,"KRN","B",3.6,3.6)

"BLD",6417,"KRN","B",3.8,3.8)

"BLD",6417,"KRN","B",9.2,9.2)

"BLD",6417,"KRN","B",9.8,9.8)

"BLD",6417,"KRN","B",19,19)

"BLD",6417,"KRN","B",19.1,19.1)

"BLD",6417,"KRN","B",101,101)

"BLD",6417,"KRN","B",409.61,409.61)

"BLD",6417,"KRN","B",771,771)

"BLD",6417,"KRN","B",870,870)

"BLD",6417,"KRN","B",8989.51,8989.51)

"BLD",6417,"KRN","B",8989.52,8989.52)

"BLD",6417,"KRN","B",8994,8994)

"BLD",6417,"QUES",0)
^9.62^^
"BLD",6417,"REQB",0)
^9.611^1^1
"BLD",6417,"REQB",1,0)
PSJ*5.0*81^1
"BLD",6417,"REQB","B","PSJ*5.0*81",1)

"MBREQ")
0
"PKG",203,-1)
1^1
"PKG",203,0)
INPATIENT MEDICATIONS^PSJ^UNIT DOSE AND IVS
"PKG",203,20,0)
^9.402P^^
"PKG",203,22,0)
^9.49I^1^1
"PKG",203,22,1,0)
5.0^2971215^2980417^1271
"PKG",203,22,1,"PAH",1,0)
156^3060418^33234
"PKG",203,22,1,"PAH",1,1,0)
^^11^11^3060418
"PKG",203,22,1,"PAH",1,1,1,0)
A provider entered a medication through CPRS with the intent of the order 
"PKG",203,22,1,"PAH",1,1,2,0)
being administered on a QD0600 continuous schedule.  The medication 
"PKG",203,22,1,"PAH",1,1,3,0)
ordered, however, had a default schedule type of PRN.  Therefore, when 
"PKG",203,22,1,"PAH",1,1,4,0)
the pharmacist finished the order backdoor, the default schedule type of 
"PKG",203,22,1,"PAH",1,1,5,0)
PRN overrode the Provider's intent of a continuous schedule.  Because the 
"PKG",203,22,1,"PAH",1,1,6,0)
medication was finished as PRN, the patient missed a dose of the 
"PKG",203,22,1,"PAH",1,1,7,0)
medication.
"PKG",203,22,1,"PAH",1,1,8,0)
 
"PKG",203,22,1,"PAH",1,1,9,0)
This patch addresses this issue by only allowing the backdoor default
"PKG",203,22,1,"PAH",1,1,10,0)
schedule type to override the incoming CPRS schedule type if the backdoor
"PKG",203,22,1,"PAH",1,1,11,0)
default is "Fill on Request".
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
1
"RTN","PSGOE6")
0^1^B23062511^B19268349
"RTN","PSGOE6",1,0)
PSGOE6 ;BIR/CML3-ORDER ENTRY THROUGH OE/RR ;10 Mar 98 / 2:35 PM
"RTN","PSGOE6",2,0)
 ;;5.0; INPATIENT MEDICATIONS ;**3,7,39,45,65,58,81,156**;16 DEC 97
"RTN","PSGOE6",3,0)
 ;
"RTN","PSGOE6",4,0)
 ; Reference to ^PS(50.7 supported by DBIA #2180.
"RTN","PSGOE6",5,0)
 ; Reference to ^PS(51.1 is supported by DBIA #2177.
"RTN","PSGOE6",6,0)
 ; Reference to ^PS(51.2 is supported by DBIA #2178.
"RTN","PSGOE6",7,0)
 ; Reference to ^PS(55 is supported by DBIA #2191.
"RTN","PSGOE6",8,0)
 ; Reference to ^DD(53.1 is supported by DBIA #2256.
"RTN","PSGOE6",9,0)
 ; Reference to ^VA(200 is supported by DBIA #10060.
"RTN","PSGOE6",10,0)
 ; Reference to ^DICN is supported by DBIA #10009.
"RTN","PSGOE6",11,0)
 ;
"RTN","PSGOE6",12,0)
 K PSGFOK S F1=53.1,PSGPR=$S($D(PSGOERR):PSJORPV,1:PSGOEPR),PSGMR=$S($P(PSGNEDFD,"^",2):$P(PSGNEDFD,"^",2),1:PSGOEDMR),PSGSCH=$P(PSGNEDFD,"^",4),(PSGOROE1,PSGSI,SDT,PSGMRN,PSGSM,PSGHSM,PSGUD,PSGSD,PSGFD,PSGSI,PSGNEFD,PSGNESD)=""
"RTN","PSGOE6",13,0)
 S:PSGMR PSGMRN=$S('$P(PSGNEDFD,"^",2):"ORAL",'$D(^PS(51.2,PSGMR,0)):PSGMR,$P(^(0),"^")]"":$P(^(0),"^"),1:PSGMR) I PSGPR S PSGPRN=$P($G(^VA(200,PSGPR,0)),"^") S:PSGPRN="" PSGPRN=PSGPR
"RTN","PSGOE6",14,0)
 S PSGST=$S($P(PSGNEDFD,"^",3)]"":$P(PSGNEDFD,"^",3),1:"C")
"RTN","PSGOE6",15,0)
 K ^PS(53.45,PSJSYSP,1),^(2) I PSGDRG S ^(2,0)="^53.4502P^"_PSGDRG_"^1",^(1,0)=PSGDRG,^PS(53.45,PSJSYSP,2,"B",PSGDRG,1)=""
"RTN","PSGOE6",16,0)
 ;
"RTN","PSGOE6",17,0)
109 ; dosage ordered
"RTN","PSGOE6",18,0)
 W !,"DOSAGE ORDERED: ",$S(PSGDO]"":PSGDO_"// ",1:"") R X:DTIME I X="^"!'$T W:'$T $C(7) S PSGOROE1=1 G DONE
"RTN","PSGOE6",19,0)
 I X="" S X=PSGDO I X="" W $C(7),"  (Required)" G 109
"RTN","PSGOE6",20,0)
 S PSGF2=109 I X="@" W $C(7),"  (Required)" G 109
"RTN","PSGOE6",21,0)
 I X?1."?" S F1=53.1 D ENHLP^PSGOEM(53.1,109) G 109
"RTN","PSGOE6",22,0)
 I $E(X)="^" D FF G:Y>0 @Y G 109
"RTN","PSGOE6",23,0)
 I $E(X,$L(X))=" " F  S X=$E(X,1,$L(X)-1) Q:$E(X,$L(X))'=" "
"RTN","PSGOE6",24,0)
 I $S(X?.E1C.E:1,$L(X)>20:1,X="":1,X["^":1,X?1.P:1,1:X=+X) W $C(7),"  ",$S(X?1.P!(X=""):"(Required)",1:"??") S X="?" D ENHLP^PSGOEM(53.1,109) G 109
"RTN","PSGOE6",25,0)
 S PSGDO=X,PSGFOK(109)=""
"RTN","PSGOE6",26,0)
 ;
"RTN","PSGOE6",27,0)
3 ; med route
"RTN","PSGOE6",28,0)
 W !,"MED ROUTE: ",$S(PSGMR:PSGMRN_"// ",1:"") R X:DTIME I X="^"!'$T W:'$T $C(7) S PSGOROE1=1 G DONE
"RTN","PSGOE6",29,0)
 I X="",PSGMR S X=PSGMRN I PSGMR'=PSGMRN,$D(^PS(51.2,PSGMR,0)) W "  "_$P(^(0),"^",3) S PSGFOK(3)="" G 26
"RTN","PSGOE6",30,0)
 S PSGF2=3 I $S(X="@":1,X]"":0,1:'PSGMR) W $C(7),"  (Required)" S X="?" D ENHLP^PSGOEM(53.1,3) G 3
"RTN","PSGOE6",31,0)
 I X?1."?" D ENHLP^PSGOEM(53.1,3)
"RTN","PSGOE6",32,0)
 I $E(X)="^" D FF G:Y>0 @Y G 3
"RTN","PSGOE6",33,0)
 K DIC S DIC="^PS(51.2,",DIC(0)="EMQZ",DIC("S")="I $P(^(0),""^"",4)" D ^DIC K DIC I Y'>0 G 3
"RTN","PSGOE6",34,0)
 S PSGMR=+Y,PSGMRN=Y(0,0),PSGFOK(3)=""
"RTN","PSGOE6",35,0)
 ;
"RTN","PSGOE6",36,0)
26 ; schedule
"RTN","PSGOE6",37,0)
 W !,"SCHEDULE: ",$S(PSGSCH]"":PSGSCH_"// ",1:"") R X:DTIME I X="^"!'$T W:'$T $C(7) S PSGOROE1=1 G DONE
"RTN","PSGOE6",38,0)
 S:X="" X=PSGSCH S PSGF2=26 ; I "@"[X W $C(7),"  (Required)" S X="?" D ENHLP^PSGOEM(53.1,26) G 26
"RTN","PSGOE6",39,0)
 I X?1."?" D ENHLP^PSGOEM(53.1,26) G 26
"RTN","PSGOE6",40,0)
 I $E(X)="^" D FF G:Y>0 @Y G 26
"RTN","PSGOE6",41,0)
 I X="" S (PSGS0XT,PSGS0Y,PSGST)=""
"RTN","PSGOE6",42,0)
 E  D EN^PSGS0 I '$D(X) W $C(7),"  ??" S X="?" D ENHLP^PSGOEM(53.1,26) G 26
"RTN","PSGOE6",43,0)
 S PSGSCH=X,(PSGFOK(26),PSGST)="",PSGOES=1 S:PSGS0XT="O" $P(PSGNEDFD,"^",3)="O",PSGST="O" D ^PSGNE3 K PSGOES
"RTN","PSGOE6",44,0)
 ;
"RTN","PSGOE6",45,0)
66 ; provider's comments
"RTN","PSGOE6",46,0)
 ;S DA=PSJSYSP,DIE="^PS(53.45,",DR=4 D ^DIE K DA,DIE,DR
"RTN","PSGOE6",47,0)
 ;S PSGFOK(66)="",Y=1
"RTN","PSGOE6",48,0)
 ;
"RTN","PSGOE6",49,0)
 ;
"RTN","PSGOE6",50,0)
DONE ;
"RTN","PSGOE6",51,0)
 I PSGOROE1 K Y W $C(7),"  ...order not entered..."
"RTN","PSGOE6",52,0)
 K F,F0,F1,PSGF2,F3,PSGFOK,SDT Q
"RTN","PSGOE6",53,0)
 ;
"RTN","PSGOE6",54,0)
FF ; up-arrow to another field
"RTN","PSGOE6",55,0)
 S Y=-1 I '$D(PSGFOK) W $C(7),"  ??" Q
"RTN","PSGOE6",56,0)
 S X=$E(X,2,99) I X=+X S Y=$S($D(PSGFOK(X)):X,1:-1) W "  " W:Y>0 $$CODES2^PSIVUTL(53.1,X) W:Y'>0 $C(7),"??" Q
"RTN","PSGOE6",57,0)
 K DIC S DIC="^DD(53.1,",DIC(0)="QEM",DIC("S")="I $D(PSGFOK(+Y))" D ^DIC K DIC S Y=+Y
"RTN","PSGOE6",58,0)
 Q
"RTN","PSGOE6",59,0)
 ;
"RTN","PSGOE6",60,0)
DEL ;
"RTN","PSGOE6",61,0)
 W !?3,"SURE YOU WANT TO DELETE" S %=0 D YN^DICN I %'=1 W "  <NOTHING DELETED>"
"RTN","PSGOE6",62,0)
 Q
"RTN","PSGOE6",63,0)
 ;
"RTN","PSGOE6",64,0)
GTST(ON) ; Find schedule type for pending order.
"RTN","PSGOE6",65,0)
 N PD,PDAP,ST,X S ST="" I $P($G(^PS(53.1,+ON,0)),U,24)="R" D
"RTN","PSGOE6",66,0)
 .; naked ref below is from line above, ^PS(53.1,ON,0)
"RTN","PSGOE6",67,0)
 .S X=$P(^(0),U,25) S ST=$S(X["N"!(X["P"):$P($G(^PS(53.1,+X,0)),U,7),X["V":"C",1:$P($G(^PS(55,PSGP,5,+X,0)),U,7))
"RTN","PSGOE6",68,0)
 .I ST]"" S (PSGOST,PSGST)=ST,PSGSTN=$$ENSTN^PSGMI(ST) Q
"RTN","PSGOE6",69,0)
 I ST="" D
"RTN","PSGOE6",70,0)
 . ;PSJ*5*156 - Don't allow backdoor to override intended schedule type from CPRS unless the default
"RTN","PSGOE6",71,0)
 . ;            schedule type (if any) is "Fill on Request".
"RTN","PSGOE6",72,0)
 . S PD=+$G(^PS(53.1,+ON,.2)) S X=$G(^PS(50.7,PD,0)),ST=$P(X,U,7)  ;see if there is a default schedule type.
"RTN","PSGOE6",73,0)
 . I ST="R" Q  ;Fill on Request default schedule type will override incoming schedule type from CPRS
"RTN","PSGOE6",74,0)
 . S ST=""  ;Reset to null in case default schedule type other than Fill on Request is defined.
"RTN","PSGOE6",75,0)
 . D OTS I ST="O" Q
"RTN","PSGOE6",76,0)
 . I PSGSCH="ON CALL"!(PSGSCH="ONCALL")!(PSGSCH="ON-CALL") S ST="OC" Q
"RTN","PSGOE6",77,0)
 . I PSGSCH["PRN" S ST="P" Q
"RTN","PSGOE6",78,0)
 . S ST="C"
"RTN","PSGOE6",79,0)
 S (PSGOST,PSGST)=ST,PSGSTN=$$ENSTN^PSGMI(ST)
"RTN","PSGOE6",80,0)
 Q
"RTN","PSGOE6",81,0)
OTS I PSGSCH]"" S X=+$O(^PS(51.1,"B",PSGSCH,0)) I $P($G(^PS(51.1,X,0)),"^",5)="O" S ST="O" Q
"RTN","PSGOE6",82,0)
 I PSGSCH="TODAY"!(PSGSCH="NOW")!(PSGSCH="STAT")!(PSGSCH="ONCE")!(PSGSCH="ONE TIME")!(PSGSCH="ONE-TIME")!(PSGSCH="ONETIME")!(PSGSCH="1TIME")!(PSGSCH="1 TIME")!(PSGSCH="1-TIME") S ST="O"
"RTN","PSGOE6",83,0)
 Q
"VER")
8.0^22.0
"BLD",6417,6)
^153
**END**
**END**
