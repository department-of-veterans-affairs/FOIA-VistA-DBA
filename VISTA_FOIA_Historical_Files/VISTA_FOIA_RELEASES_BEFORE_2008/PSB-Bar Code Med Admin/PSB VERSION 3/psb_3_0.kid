KIDS Distribution saved on Feb 24, 2004@12:07:55
BAR CODE MED ADMIN Version 3.0
**KIDS**:PSB 3.0^

**INSTALL NAME**
PSB 3.0
"BLD",4653,0)
PSB 3.0^BAR CODE MED ADMIN^0^3040224^y
"BLD",4653,1,0)
^^101^101^3040211^
"BLD",4653,1,1,0)
*** Bar Code Medication Administration (BCMA) Version 3.0 ***
"BLD",4653,1,2,0)
 
"BLD",4653,1,3,0)
This build consists of BCMA Version 3.0 rollover code and resolution to a 
"BLD",4653,1,4,0)
few outstanding BCMA defects.
"BLD",4653,1,5,0)
 
"BLD",4653,1,6,0)
Listed below are primary National Online Information Sharing ticket 
"BLD",4653,1,7,0)
(NOIS) identification information representing BCMA defects/problems
"BLD",4653,1,8,0)
and their respective corrective action.
"BLD",4653,1,9,0)
 
"BLD",4653,1,10,0)
1. Problem: NOIS ISB-0603-31561
"BLD",4653,1,11,0)
A medication order that has administration times set for today, but 
"BLD",4653,1,12,0)
before the Start Time of the order, displays on the Bar Code Medication 
"BLD",4653,1,13,0)
Administration (BCMA) Due List Report.
"BLD",4653,1,14,0)
 
"BLD",4653,1,15,0)
Corrective Action:
"BLD",4653,1,16,0)
The Due List Report will not display medication orders until the Start 
"BLD",4653,1,17,0)
Date/Time of the medication order takes affect.
"BLD",4653,1,18,0)
 
"BLD",4653,1,19,0)
2. Problem: NOIS ISB-0903-31964
"BLD",4653,1,20,0)
When the user selects a time frame for the Medication Administration 
"BLD",4653,1,21,0)
History (MAH) Report and no administrations are due, the report lists the 
"BLD",4653,1,22,0)
medication order number from Inpatient Medications V. 5.0 under the 
"BLD",4653,1,23,0)
"Initial-Name Legend" section.
"BLD",4653,1,24,0)
 
"BLD",4653,1,25,0)
Corrective Action: 
"BLD",4653,1,26,0)
The MAH Report will not display the order number from Inpatient 
"BLD",4653,1,27,0)
Medications V. 5.0 under the "Initial-Name Legend" section when no 
"BLD",4653,1,28,0)
administrations are due for a specific time frame.
"BLD",4653,1,29,0)
 
"BLD",4653,1,30,0)
3. Problem: NOIS LAH-1203-61493
"BLD",4653,1,31,0)
The user receives the following error message, "BCMA failed to 
"BLD",4653,1,32,0)
communicate with VISTA," if the Graphical User Interface (GUI) BCMA times
"BLD",4653,1,33,0)
out and is unable to connect to the server.
"BLD",4653,1,34,0)
 
"BLD",4653,1,35,0)
Corrective Action: 
"BLD",4653,1,36,0)
The processing time for the GUI BCMA software to display the patient s 
"BLD",4653,1,37,0)
record on the BCMA Virtual Due List (VDL) has been reduced.
"BLD",4653,1,38,0)
 
"BLD",4653,1,39,0)
4. Problem: NOIS LIT-0603-71923
"BLD",4653,1,40,0)
Users sometimes receive an "allocation failure" error message when 
"BLD",4653,1,41,0)
accessing a patient s record using the GUI BCMA.
"BLD",4653,1,42,0)
 
"BLD",4653,1,43,0)
Corrective Action: 
"BLD",4653,1,44,0)
The "allocation failure" error message has been corrected.
"BLD",4653,1,45,0)
 
"BLD",4653,1,46,0)
5. Problem: NOIS MAD-1203-42204
"BLD",4653,1,47,0)
The MAH Report takes an extended amount of time to run if the Start Date 
"BLD",4653,1,48,0)
and the Stop Date of the report, requested by the user, are for different 
"BLD",4653,1,49,0)
years. For example, if the Start Date is 12/28/03 and the Stop Date is 
"BLD",4653,1,50,0)
01/03/04.
"BLD",4653,1,51,0)
 
"BLD",4653,1,52,0)
Corrective Action: 
"BLD",4653,1,53,0)
The user can now request different years for the MAH Report without 
"BLD",4653,1,54,0)
experiencing extended delays as BCMA accesses the data. 
"BLD",4653,1,55,0)
 
"BLD",4653,1,56,0)
6. Problem: NOIS MIN-1203-41637
"BLD",4653,1,57,0)
Users sometimes experience an "Invalid Medication Lookup" error message 
"BLD",4653,1,58,0)
after scanning a medication in the "Scan Medication Bar Code:" field of 
"BLD",4653,1,59,0)
the "Order Manager"  dialog box when using the BCMA Med Order Button in 
"BLD",4653,1,60,0)
GUI BCMA.
"BLD",4653,1,61,0)
 
"BLD",4653,1,62,0)
Corrective Action: 
"BLD",4653,1,63,0)
The BCMA medication lookup process has been corrected to properly 
"BLD",4653,1,64,0)
validate the medications scanned in the "Scan Medication Bar Code:" field 
"BLD",4653,1,65,0)
of the "Order Manager" dialog box in GUI BCMA.
"BLD",4653,1,66,0)
 
"BLD",4653,1,67,0)
7. Problem: NOIS UNY-0104-10174
"BLD",4653,1,68,0)
Multiple IV medication orders display as merged on the IV Medication Tab 
"BLD",4653,1,69,0)
after an order is discontinued, but the IV bag is still infusing.
"BLD",4653,1,70,0)
 
"BLD",4653,1,71,0)
Corrective Action: 
"BLD",4653,1,72,0)
Multiple IV medication orders will display properly on the IV Medication 
"BLD",4653,1,73,0)
Tab.  
"BLD",4653,1,74,0)
 
"BLD",4653,1,75,0)
8. Problem: NOIS TNV-0104-30647
"BLD",4653,1,76,0)
Users sometimes experience the following error message, "ERROR: 16^Server 
"BLD",4653,1,77,0)
Protocol Disabled," when using the Edit Medication Log [PSB MED LOG EDIT] 
"BLD",4653,1,78,0)
option. This occurs when the PSB BCMA RASO17 SRV Health Level Seven (HL7) 
"BLD",4653,1,79,0)
server protocol is being disabled.
"BLD",4653,1,80,0)
 
"BLD",4653,1,81,0)
Corrective Action:
"BLD",4653,1,82,0)
The error message is only intended to notify the BCMA software that the 
"BLD",4653,1,83,0)
protocol is being disabled. BCMA will now validate the message and not 
"BLD",4653,1,84,0)
display it to users. 
"BLD",4653,1,85,0)
 
"BLD",4653,1,86,0)
9. Problem: NOIS ISB-0104-31384
"BLD",4653,1,87,0)
When an IV medication order with an infusing bag is "Renewed," the 
"BLD",4653,1,88,0)
renewed order continues to display on the IV Medication Tab of the BCMA  
"BLD",4653,1,89,0)
VDL  until the infusing bag is "Completed," even if the "Renewed" order's
"BLD",4653,1,90,0)
Start Date/Time has expired.
"BLD",4653,1,91,0)
 
"BLD",4653,1,92,0)
Corrective Action:
"BLD",4653,1,93,0)
When an IV medication order with an infusing bag is "Renewed," the 
"BLD",4653,1,94,0)
renewed order will continue to display on the IV Medication Tab of the 
"BLD",4653,1,95,0)
BCMA VDL until the infusing bag is "Completed," or until the Start 
"BLD",4653,1,96,0)
Date/Time of the new order that was created during the renewal process. 
"BLD",4653,1,97,0)
Once the new order is active, the infusing bag from the previous order 
"BLD",4653,1,98,0)
will display on the BCMA VDL with the new order, along with any 
"BLD",4653,1,99,0)
additional bags created from the new order. Any available bags from the 
"BLD",4653,1,100,0)
previous order will display on the new order based on the IV Site 
"BLD",4653,1,101,0)
Parameter settings in the GUI BCMA Site Parameters application.
"BLD",4653,4,0)
^9.64PA^53.79^5
"BLD",4653,4,53.66,0)
53.66
"BLD",4653,4,53.66,222)
y^y^f^^^^n
"BLD",4653,4,53.68,0)
53.68
"BLD",4653,4,53.68,222)
y^y^f^^^^n
"BLD",4653,4,53.69,0)
53.69
"BLD",4653,4,53.69,222)
y^y^f^^^^n
"BLD",4653,4,53.78,0)
53.78
"BLD",4653,4,53.78,222)
y^y^f^^^^n
"BLD",4653,4,53.79,0)
53.79
"BLD",4653,4,53.79,222)
y^y^f^^^^n
"BLD",4653,4,"B",53.66,53.66)

"BLD",4653,4,"B",53.68,53.68)

"BLD",4653,4,"B",53.69,53.69)

"BLD",4653,4,"B",53.78,53.78)

"BLD",4653,4,"B",53.79,53.79)

"BLD",4653,"ABPKG")
n
"BLD",4653,"KRN",0)
^9.67PA^8989.52^19
"BLD",4653,"KRN",.4,0)
.4
"BLD",4653,"KRN",.401,0)
.401
"BLD",4653,"KRN",.402,0)
.402
"BLD",4653,"KRN",.403,0)
.403
"BLD",4653,"KRN",.403,"NM",0)
^9.68A^16^16
"BLD",4653,"KRN",.403,"NM",1,0)
PSB MED LOG EDIT    FILE #53.79^53.79^0
"BLD",4653,"KRN",.403,"NM",2,0)
PSB MED LOG EDIT IV    FILE #53.79^53.79^0
"BLD",4653,"KRN",.403,"NM",3,0)
PSB MISSING DOSE FOLLOWUP    FILE #53.68^53.68^0
"BLD",4653,"KRN",.403,"NM",4,0)
PSB MISSING DOSE REQUEST    FILE #53.68^53.68^0
"BLD",4653,"KRN",.403,"NM",5,0)
PSB NEW IV ENTRY    FILE #53.79^53.79^0
"BLD",4653,"KRN",.403,"NM",6,0)
PSB NEW UD ENTRY    FILE #53.79^53.79^0
"BLD",4653,"KRN",.403,"NM",7,0)
PSB PRN EFFECTIVENESS    FILE #53.79^53.79^0
"BLD",4653,"KRN",.403,"NM",8,0)
PSBO BL    FILE #53.69^53.69^0
"BLD",4653,"KRN",.403,"NM",9,0)
PSBO DL    FILE #53.69^53.69^0
"BLD",4653,"KRN",.403,"NM",10,0)
PSBO MD    FILE #53.69^53.69^0
"BLD",4653,"KRN",.403,"NM",11,0)
PSBO MH    FILE #53.69^53.69^0
"BLD",4653,"KRN",.403,"NM",12,0)
PSBO ML    FILE #53.69^53.69^0
"BLD",4653,"KRN",.403,"NM",13,0)
PSBO MM    FILE #53.69^53.69^0
"BLD",4653,"KRN",.403,"NM",14,0)
PSBO MV    FILE #53.69^53.69^0
"BLD",4653,"KRN",.403,"NM",15,0)
PSBO PE    FILE #53.69^53.69^0
"BLD",4653,"KRN",.403,"NM",16,0)
PSBO WA    FILE #53.69^53.69^0
"BLD",4653,"KRN",.403,"NM","B","PSB MED LOG EDIT    FILE #53.79",1)

"BLD",4653,"KRN",.403,"NM","B","PSB MED LOG EDIT IV    FILE #53.79",2)

"BLD",4653,"KRN",.403,"NM","B","PSB MISSING DOSE FOLLOWUP    FILE #53.68",3)

"BLD",4653,"KRN",.403,"NM","B","PSB MISSING DOSE REQUEST    FILE #53.68",4)

"BLD",4653,"KRN",.403,"NM","B","PSB NEW IV ENTRY    FILE #53.79",5)

"BLD",4653,"KRN",.403,"NM","B","PSB NEW UD ENTRY    FILE #53.79",6)

"BLD",4653,"KRN",.403,"NM","B","PSB PRN EFFECTIVENESS    FILE #53.79",7)

"BLD",4653,"KRN",.403,"NM","B","PSBO BL    FILE #53.69",8)

"BLD",4653,"KRN",.403,"NM","B","PSBO DL    FILE #53.69",9)

"BLD",4653,"KRN",.403,"NM","B","PSBO MD    FILE #53.69",10)

"BLD",4653,"KRN",.403,"NM","B","PSBO MH    FILE #53.69",11)

"BLD",4653,"KRN",.403,"NM","B","PSBO ML    FILE #53.69",12)

"BLD",4653,"KRN",.403,"NM","B","PSBO MM    FILE #53.69",13)

"BLD",4653,"KRN",.403,"NM","B","PSBO MV    FILE #53.69",14)

"BLD",4653,"KRN",.403,"NM","B","PSBO PE    FILE #53.69",15)

"BLD",4653,"KRN",.403,"NM","B","PSBO WA    FILE #53.69",16)

"BLD",4653,"KRN",.5,0)
.5
"BLD",4653,"KRN",.84,0)
.84
"BLD",4653,"KRN",3.6,0)
3.6
"BLD",4653,"KRN",3.8,0)
3.8
"BLD",4653,"KRN",3.8,"NM",0)
^9.68A^^0
"BLD",4653,"KRN",9.2,0)
9.2
"BLD",4653,"KRN",9.8,0)
9.8
"BLD",4653,"KRN",9.8,"NM",0)
^9.68A^61^60
"BLD",4653,"KRN",9.8,"NM",1,0)
PSBALL^^0^B2340007
"BLD",4653,"KRN",9.8,"NM",2,0)
PSBAPIPM^^0^B17290164
"BLD",4653,"KRN",9.8,"NM",3,0)
PSBCHIVH^^0^B1575231
"BLD",4653,"KRN",9.8,"NM",4,0)
PSBCHKIV^^0^B77606610
"BLD",4653,"KRN",9.8,"NM",5,0)
PSBMD^^0^B70799803
"BLD",4653,"KRN",9.8,"NM",6,0)
PSBML^^0^B78825468
"BLD",4653,"KRN",9.8,"NM",7,0)
PSBML1^^0^B16504539
"BLD",4653,"KRN",9.8,"NM",8,0)
PSBMLEN^^0^B68152938
"BLD",4653,"KRN",9.8,"NM",9,0)
PSBMLEN1^^0^B25227355
"BLD",4653,"KRN",9.8,"NM",10,0)
PSBMLHS^^0^B5390112
"BLD",4653,"KRN",9.8,"NM",11,0)
PSBMLTS^^0^B28541304
"BLD",4653,"KRN",9.8,"NM",12,0)
PSBMLU^^0^B2979361
"BLD",4653,"KRN",9.8,"NM",13,0)
PSBMLVAL^^0^B28829804
"BLD",4653,"KRN",9.8,"NM",14,0)
PSBO^^0^B63302774
"BLD",4653,"KRN",9.8,"NM",15,0)
PSBO1^^0^B5034282
"BLD",4653,"KRN",9.8,"NM",16,0)
PSBOAL^^0^B3441783
"BLD",4653,"KRN",9.8,"NM",17,0)
PSBOBL^^0^B9096254
"BLD",4653,"KRN",9.8,"NM",18,0)
PSBODL^^0^B82184465
"BLD",4653,"KRN",9.8,"NM",19,0)
PSBODL1^^0^B23809238
"BLD",4653,"KRN",9.8,"NM",20,0)
PSBODO^^0^B8273378
"BLD",4653,"KRN",9.8,"NM",21,0)
PSBOHDR^^0^B15604534
"BLD",4653,"KRN",9.8,"NM",22,0)
PSBOMD^^0^B11558325
"BLD",4653,"KRN",9.8,"NM",23,0)
PSBOMH^^0^B84859472
"BLD",4653,"KRN",9.8,"NM",24,0)
PSBOMH1^^0^B47198831
"BLD",4653,"KRN",9.8,"NM",25,0)
PSBOMH2^^0^B22139777
"BLD",4653,"KRN",9.8,"NM",26,0)
PSBOML^^0^B31969332
"BLD",4653,"KRN",9.8,"NM",27,0)
PSBOMM^^0^B85447995
"BLD",4653,"KRN",9.8,"NM",28,0)
PSBOMV^^0^B41185550
"BLD",4653,"KRN",9.8,"NM",29,0)
PSBOPE^^0^B17070369
"BLD",4653,"KRN",9.8,"NM",30,0)
PSBOPI^^0^B405147
"BLD",4653,"KRN",9.8,"NM",31,0)
PSBOPM^^0^B11547930
"BLD",4653,"KRN",9.8,"NM",32,0)
PSBOVT^^0^B1375415
"BLD",4653,"KRN",9.8,"NM",33,0)
PSBOWA^^0^B46636390
"BLD",4653,"KRN",9.8,"NM",34,0)
PSBPAR^^0^B19006745
"BLD",4653,"KRN",9.8,"NM",35,0)
PSBPARIV^^0^B48555967
"BLD",4653,"KRN",9.8,"NM",36,0)
PSBPOIV^^0^B63173944
"BLD",4653,"KRN",9.8,"NM",37,0)
PSBPRN^^0^B19286940
"BLD",4653,"KRN",9.8,"NM",39,0)
PSBRPC^^0^B58150242
"BLD",4653,"KRN",9.8,"NM",40,0)
PSBRPC1^^0^B9800054
"BLD",4653,"KRN",9.8,"NM",41,0)
PSBRPC2^^0^B43763791
"BLD",4653,"KRN",9.8,"NM",42,0)
PSBRPC3^^0^B316279
"BLD",4653,"KRN",9.8,"NM",43,0)
PSBRPCMO^^0^B57699601
"BLD",4653,"KRN",9.8,"NM",44,0)
PSBRPCXM^^0^B3744891
"BLD",4653,"KRN",9.8,"NM",45,0)
PSBSAGG^^0^B2908625
"BLD",4653,"KRN",9.8,"NM",46,0)
PSBSVHL7^^0^B79888085
"BLD",4653,"KRN",9.8,"NM",47,0)
PSBUTL^^0^B55203517
"BLD",4653,"KRN",9.8,"NM",48,0)
PSBVAR^^0^B13394171
"BLD",4653,"KRN",9.8,"NM",49,0)
PSBVDLIV^^0^B63524635
"BLD",4653,"KRN",9.8,"NM",50,0)
PSBVDLPA^^0^B6723611
"BLD",4653,"KRN",9.8,"NM",51,0)
PSBVDLPB^^0^B71736852
"BLD",4653,"KRN",9.8,"NM",52,0)
PSBVDLTB^^0^B7436456
"BLD",4653,"KRN",9.8,"NM",53,0)
PSBVDLU1^^0^B53853310
"BLD",4653,"KRN",9.8,"NM",54,0)
PSBVDLU2^^0^B6421023
"BLD",4653,"KRN",9.8,"NM",55,0)
PSBVDLU3^^0^B7773577
"BLD",4653,"KRN",9.8,"NM",56,0)
PSBVDLUD^^0^B65830028
"BLD",4653,"KRN",9.8,"NM",57,0)
PSBVDLVL^^0^B54738502
"BLD",4653,"KRN",9.8,"NM",58,0)
PSBVITFL^^0^B4261599
"BLD",4653,"KRN",9.8,"NM",59,0)
PSBVT^^0^B74909012
"BLD",4653,"KRN",9.8,"NM",60,0)
PSBVT1^^0^B1122204
"BLD",4653,"KRN",9.8,"NM",61,0)
PSBXMRG^^0^B2968246
"BLD",4653,"KRN",9.8,"NM","B","PSBALL",1)

"BLD",4653,"KRN",9.8,"NM","B","PSBAPIPM",2)

"BLD",4653,"KRN",9.8,"NM","B","PSBCHIVH",3)

"BLD",4653,"KRN",9.8,"NM","B","PSBCHKIV",4)

"BLD",4653,"KRN",9.8,"NM","B","PSBMD",5)

"BLD",4653,"KRN",9.8,"NM","B","PSBML",6)

"BLD",4653,"KRN",9.8,"NM","B","PSBML1",7)

"BLD",4653,"KRN",9.8,"NM","B","PSBMLEN",8)

"BLD",4653,"KRN",9.8,"NM","B","PSBMLEN1",9)

"BLD",4653,"KRN",9.8,"NM","B","PSBMLHS",10)

"BLD",4653,"KRN",9.8,"NM","B","PSBMLTS",11)

"BLD",4653,"KRN",9.8,"NM","B","PSBMLU",12)

"BLD",4653,"KRN",9.8,"NM","B","PSBMLVAL",13)

"BLD",4653,"KRN",9.8,"NM","B","PSBO",14)

"BLD",4653,"KRN",9.8,"NM","B","PSBO1",15)

"BLD",4653,"KRN",9.8,"NM","B","PSBOAL",16)

"BLD",4653,"KRN",9.8,"NM","B","PSBOBL",17)

"BLD",4653,"KRN",9.8,"NM","B","PSBODL",18)

"BLD",4653,"KRN",9.8,"NM","B","PSBODL1",19)

"BLD",4653,"KRN",9.8,"NM","B","PSBODO",20)

"BLD",4653,"KRN",9.8,"NM","B","PSBOHDR",21)

"BLD",4653,"KRN",9.8,"NM","B","PSBOMD",22)

"BLD",4653,"KRN",9.8,"NM","B","PSBOMH",23)

"BLD",4653,"KRN",9.8,"NM","B","PSBOMH1",24)

"BLD",4653,"KRN",9.8,"NM","B","PSBOMH2",25)

"BLD",4653,"KRN",9.8,"NM","B","PSBOML",26)

"BLD",4653,"KRN",9.8,"NM","B","PSBOMM",27)

"BLD",4653,"KRN",9.8,"NM","B","PSBOMV",28)

"BLD",4653,"KRN",9.8,"NM","B","PSBOPE",29)

"BLD",4653,"KRN",9.8,"NM","B","PSBOPI",30)

"BLD",4653,"KRN",9.8,"NM","B","PSBOPM",31)

"BLD",4653,"KRN",9.8,"NM","B","PSBOVT",32)

"BLD",4653,"KRN",9.8,"NM","B","PSBOWA",33)

"BLD",4653,"KRN",9.8,"NM","B","PSBPAR",34)

"BLD",4653,"KRN",9.8,"NM","B","PSBPARIV",35)

"BLD",4653,"KRN",9.8,"NM","B","PSBPOIV",36)

"BLD",4653,"KRN",9.8,"NM","B","PSBPRN",37)

"BLD",4653,"KRN",9.8,"NM","B","PSBRPC",39)

"BLD",4653,"KRN",9.8,"NM","B","PSBRPC1",40)

"BLD",4653,"KRN",9.8,"NM","B","PSBRPC2",41)

"BLD",4653,"KRN",9.8,"NM","B","PSBRPC3",42)

"BLD",4653,"KRN",9.8,"NM","B","PSBRPCMO",43)

"BLD",4653,"KRN",9.8,"NM","B","PSBRPCXM",44)

"BLD",4653,"KRN",9.8,"NM","B","PSBSAGG",45)

"BLD",4653,"KRN",9.8,"NM","B","PSBSVHL7",46)

"BLD",4653,"KRN",9.8,"NM","B","PSBUTL",47)

"BLD",4653,"KRN",9.8,"NM","B","PSBVAR",48)

"BLD",4653,"KRN",9.8,"NM","B","PSBVDLIV",49)

"BLD",4653,"KRN",9.8,"NM","B","PSBVDLPA",50)

"BLD",4653,"KRN",9.8,"NM","B","PSBVDLPB",51)

"BLD",4653,"KRN",9.8,"NM","B","PSBVDLTB",52)

"BLD",4653,"KRN",9.8,"NM","B","PSBVDLU1",53)

"BLD",4653,"KRN",9.8,"NM","B","PSBVDLU2",54)

"BLD",4653,"KRN",9.8,"NM","B","PSBVDLU3",55)

"BLD",4653,"KRN",9.8,"NM","B","PSBVDLUD",56)

"BLD",4653,"KRN",9.8,"NM","B","PSBVDLVL",57)

"BLD",4653,"KRN",9.8,"NM","B","PSBVITFL",58)

"BLD",4653,"KRN",9.8,"NM","B","PSBVT",59)

"BLD",4653,"KRN",9.8,"NM","B","PSBVT1",60)

"BLD",4653,"KRN",9.8,"NM","B","PSBXMRG",61)

"BLD",4653,"KRN",19,0)
19
"BLD",4653,"KRN",19,"NM",0)
^9.68A^42^42
"BLD",4653,"KRN",19,"NM",1,0)
PSB BCBU ERROR LOG^^0
"BLD",4653,"KRN",19,"NM",2,0)
PSB BCBU INIT SINGLE PT^^0
"BLD",4653,"KRN",19,"NM",3,0)
PSB BCBU INIT WRKSTN DFT^^0
"BLD",4653,"KRN",19,"NM",4,0)
PSB BCBU INIT WRKSTN DIV^^0
"BLD",4653,"KRN",19,"NM",5,0)
PSB BCBU LINK ASSOCIATIONS^^0
"BLD",4653,"KRN",19,"NM",6,0)
PSB BCBU MANAGEMENT MENU^^0
"BLD",4653,"KRN",19,"NM",7,0)
PSB BCBU PMU MESSAGE BUILDER^^0
"BLD",4653,"KRN",19,"NM",8,0)
PSB BCBU PRINT BLK MAR^^0
"BLD",4653,"KRN",19,"NM",9,0)
PSB BCBU PRINT MAR ALL^^0
"BLD",4653,"KRN",19,"NM",10,0)
PSB BCBU PRINT MAR PATIENT^^0
"BLD",4653,"KRN",19,"NM",11,0)
PSB BCBU PRINT MAR WARD^^0
"BLD",4653,"KRN",19,"NM",12,0)
PSB BCBU SHOW PATIENT^^0
"BLD",4653,"KRN",19,"NM",13,0)
PSB BCBU SHOW WARD^^0
"BLD",4653,"KRN",19,"NM",14,0)
PSB BCBU USER INIT^^0
"BLD",4653,"KRN",19,"NM",15,0)
PSB BCBU VISTA MAIN^^0
"BLD",4653,"KRN",19,"NM",16,0)
PSB BCBU WARD LIST^^0
"BLD",4653,"KRN",19,"NM",17,0)
PSB BCBU WRKSTN MAIN^^0
"BLD",4653,"KRN",19,"NM",18,0)
PSB DRUG INQUIRY^^0
"BLD",4653,"KRN",19,"NM",19,0)
PSB GUI CONTEXT - USER^^0
"BLD",4653,"KRN",19,"NM",20,0)
PSB MED LOG EDIT^^0
"BLD",4653,"KRN",19,"NM",21,0)
PSB MED LOG NEW ENTRY^^0
"BLD",4653,"KRN",19,"NM",22,0)
PSB MED LOG PRN EFFECT^^0
"BLD",4653,"KRN",19,"NM",23,0)
PSB MED LOG TROUBLE SHOOTER^^0
"BLD",4653,"KRN",19,"NM",24,0)
PSB MGR^^0
"BLD",4653,"KRN",19,"NM",25,0)
PSB MISSING DOSE FOLLOWUP^^0
"BLD",4653,"KRN",19,"NM",26,0)
PSB MISSING DOSE REQUEST^^0
"BLD",4653,"KRN",19,"NM",27,0)
PSB NURSE^^0
"BLD",4653,"KRN",19,"NM",28,0)
PSB PHARMACY^^0
"BLD",4653,"KRN",19,"NM",29,0)
PSB PRN DOCUMENTING^^0
"BLD",4653,"KRN",19,"NM",30,0)
PSB SAGG MONTHLY REPORT^^0
"BLD",4653,"KRN",19,"NM",31,0)
PSB USER^^0
"BLD",4653,"KRN",19,"NM",32,0)
PSB USER PARAM RESET^^0
"BLD",4653,"KRN",19,"NM",33,0)
PSBO^^0
"BLD",4653,"KRN",19,"NM",34,0)
PSBO BL^^0
"BLD",4653,"KRN",19,"NM",35,0)
PSBO DL^^0
"BLD",4653,"KRN",19,"NM",36,0)
PSBO MD^^0
"BLD",4653,"KRN",19,"NM",37,0)
PSBO MH^^0
"BLD",4653,"KRN",19,"NM",38,0)
PSBO ML^^0
"BLD",4653,"KRN",19,"NM",39,0)
PSBO MM^^0
"BLD",4653,"KRN",19,"NM",40,0)
PSBO MV^^0
"BLD",4653,"KRN",19,"NM",41,0)
PSBO PE^^0
"BLD",4653,"KRN",19,"NM",42,0)
PSBO WA^^0
"BLD",4653,"KRN",19,"NM","B","PSB BCBU ERROR LOG",1)

"BLD",4653,"KRN",19,"NM","B","PSB BCBU INIT SINGLE PT",2)

"BLD",4653,"KRN",19,"NM","B","PSB BCBU INIT WRKSTN DFT",3)

"BLD",4653,"KRN",19,"NM","B","PSB BCBU INIT WRKSTN DIV",4)

"BLD",4653,"KRN",19,"NM","B","PSB BCBU LINK ASSOCIATIONS",5)

"BLD",4653,"KRN",19,"NM","B","PSB BCBU MANAGEMENT MENU",6)

"BLD",4653,"KRN",19,"NM","B","PSB BCBU PMU MESSAGE BUILDER",7)

"BLD",4653,"KRN",19,"NM","B","PSB BCBU PRINT BLK MAR",8)

"BLD",4653,"KRN",19,"NM","B","PSB BCBU PRINT MAR ALL",9)

"BLD",4653,"KRN",19,"NM","B","PSB BCBU PRINT MAR PATIENT",10)

"BLD",4653,"KRN",19,"NM","B","PSB BCBU PRINT MAR WARD",11)

"BLD",4653,"KRN",19,"NM","B","PSB BCBU SHOW PATIENT",12)

"BLD",4653,"KRN",19,"NM","B","PSB BCBU SHOW WARD",13)

"BLD",4653,"KRN",19,"NM","B","PSB BCBU USER INIT",14)

"BLD",4653,"KRN",19,"NM","B","PSB BCBU VISTA MAIN",15)

"BLD",4653,"KRN",19,"NM","B","PSB BCBU WARD LIST",16)

"BLD",4653,"KRN",19,"NM","B","PSB BCBU WRKSTN MAIN",17)

"BLD",4653,"KRN",19,"NM","B","PSB DRUG INQUIRY",18)

"BLD",4653,"KRN",19,"NM","B","PSB GUI CONTEXT - USER",19)

"BLD",4653,"KRN",19,"NM","B","PSB MED LOG EDIT",20)

"BLD",4653,"KRN",19,"NM","B","PSB MED LOG NEW ENTRY",21)

"BLD",4653,"KRN",19,"NM","B","PSB MED LOG PRN EFFECT",22)

"BLD",4653,"KRN",19,"NM","B","PSB MED LOG TROUBLE SHOOTER",23)

"BLD",4653,"KRN",19,"NM","B","PSB MGR",24)

"BLD",4653,"KRN",19,"NM","B","PSB MISSING DOSE FOLLOWUP",25)

"BLD",4653,"KRN",19,"NM","B","PSB MISSING DOSE REQUEST",26)

"BLD",4653,"KRN",19,"NM","B","PSB NURSE",27)

"BLD",4653,"KRN",19,"NM","B","PSB PHARMACY",28)

"BLD",4653,"KRN",19,"NM","B","PSB PRN DOCUMENTING",29)

"BLD",4653,"KRN",19,"NM","B","PSB SAGG MONTHLY REPORT",30)

"BLD",4653,"KRN",19,"NM","B","PSB USER",31)

"BLD",4653,"KRN",19,"NM","B","PSB USER PARAM RESET",32)

"BLD",4653,"KRN",19,"NM","B","PSBO",33)

"BLD",4653,"KRN",19,"NM","B","PSBO BL",34)

"BLD",4653,"KRN",19,"NM","B","PSBO DL",35)

"BLD",4653,"KRN",19,"NM","B","PSBO MD",36)

"BLD",4653,"KRN",19,"NM","B","PSBO MH",37)

"BLD",4653,"KRN",19,"NM","B","PSBO ML",38)

"BLD",4653,"KRN",19,"NM","B","PSBO MM",39)

"BLD",4653,"KRN",19,"NM","B","PSBO MV",40)

"BLD",4653,"KRN",19,"NM","B","PSBO PE",41)

"BLD",4653,"KRN",19,"NM","B","PSBO WA",42)

"BLD",4653,"KRN",19.1,0)
19.1
"BLD",4653,"KRN",19.1,"NM",0)
^9.68A^5^5
"BLD",4653,"KRN",19.1,"NM",1,0)
PSB BUMGR^^0
"BLD",4653,"KRN",19.1,"NM",2,0)
PSB CPRS MED BUTTON^^0
"BLD",4653,"KRN",19.1,"NM",3,0)
PSB INSTRUCTOR^^0
"BLD",4653,"KRN",19.1,"NM",4,0)
PSB MANAGER^^0
"BLD",4653,"KRN",19.1,"NM",5,0)
PSB STUDENT^^0
"BLD",4653,"KRN",19.1,"NM","B","PSB BUMGR",1)

"BLD",4653,"KRN",19.1,"NM","B","PSB CPRS MED BUTTON",2)

"BLD",4653,"KRN",19.1,"NM","B","PSB INSTRUCTOR",3)

"BLD",4653,"KRN",19.1,"NM","B","PSB MANAGER",4)

"BLD",4653,"KRN",19.1,"NM","B","PSB STUDENT",5)

"BLD",4653,"KRN",101,0)
101
"BLD",4653,"KRN",101,"NM",0)
^9.68A^21^13
"BLD",4653,"KRN",101,"NM",9,0)
PSB BCMA RASO17 SRV^^0
"BLD",4653,"KRN",101,"NM",10,0)
PSB BCMA RASO17 SUB^^0
"BLD",4653,"KRN",101,"NM",11,0)
PSB ERR LOG DEL ALL^^0
"BLD",4653,"KRN",101,"NM",12,0)
PSB ERR LOG DEL ONE^^0
"BLD",4653,"KRN",101,"NM",13,0)
PSB ERROR LOG MENU^^0
"BLD",4653,"KRN",101,"NM",14,0)
PSB ORDERS MENU^^0
"BLD",4653,"KRN",101,"NM",15,0)
PSB PATIENT MENU^^0
"BLD",4653,"KRN",101,"NM",16,0)
PSB SELECT ORDER^^0
"BLD",4653,"KRN",101,"NM",17,0)
PSB SELECT ORDER ACTIVE^^0
"BLD",4653,"KRN",101,"NM",18,0)
PSB SELECT ORDER ALL^^0
"BLD",4653,"KRN",101,"NM",19,0)
PSB SELECT PATIENT^^0
"BLD",4653,"KRN",101,"NM",20,0)
PSB SELECT PATIENT ALL^^0
"BLD",4653,"KRN",101,"NM",21,0)
PSB SELECT PATIENT WARD^^0
"BLD",4653,"KRN",101,"NM","B","PSB BCMA RASO17 SRV",9)

"BLD",4653,"KRN",101,"NM","B","PSB BCMA RASO17 SUB",10)

"BLD",4653,"KRN",101,"NM","B","PSB ERR LOG DEL ALL",11)

"BLD",4653,"KRN",101,"NM","B","PSB ERR LOG DEL ONE",12)

"BLD",4653,"KRN",101,"NM","B","PSB ERROR LOG MENU",13)

"BLD",4653,"KRN",101,"NM","B","PSB ORDERS MENU",14)

"BLD",4653,"KRN",101,"NM","B","PSB PATIENT MENU",15)

"BLD",4653,"KRN",101,"NM","B","PSB SELECT ORDER",16)

"BLD",4653,"KRN",101,"NM","B","PSB SELECT ORDER ACTIVE",17)

"BLD",4653,"KRN",101,"NM","B","PSB SELECT ORDER ALL",18)

"BLD",4653,"KRN",101,"NM","B","PSB SELECT PATIENT",19)

"BLD",4653,"KRN",101,"NM","B","PSB SELECT PATIENT ALL",20)

"BLD",4653,"KRN",101,"NM","B","PSB SELECT PATIENT WARD",21)

"BLD",4653,"KRN",409.61,0)
409.61
"BLD",4653,"KRN",409.61,"NM",0)
^9.68A^4^4
"BLD",4653,"KRN",409.61,"NM",1,0)
PSB ERROR LOG^^0
"BLD",4653,"KRN",409.61,"NM",2,0)
PSB SELECT ORDERS^^0
"BLD",4653,"KRN",409.61,"NM",3,0)
PSB SELECT PATIENT^^0
"BLD",4653,"KRN",409.61,"NM",4,0)
PSB SHOW ORDERS^^0
"BLD",4653,"KRN",409.61,"NM","B","PSB ERROR LOG",1)

"BLD",4653,"KRN",409.61,"NM","B","PSB SELECT ORDERS",2)

"BLD",4653,"KRN",409.61,"NM","B","PSB SELECT PATIENT",3)

"BLD",4653,"KRN",409.61,"NM","B","PSB SHOW ORDERS",4)

"BLD",4653,"KRN",771,0)
771
"BLD",4653,"KRN",771,"NM",0)
^9.68A^4^2
"BLD",4653,"KRN",771,"NM",3,0)
PSB HL7 SRV^^0
"BLD",4653,"KRN",771,"NM",4,0)
PSB HL7 SUB^^0
"BLD",4653,"KRN",771,"NM","B","PSB HL7 SRV",3)

"BLD",4653,"KRN",771,"NM","B","PSB HL7 SUB",4)

"BLD",4653,"KRN",870,0)
870
"BLD",4653,"KRN",870,"NM",0)
^9.68A^1^1
"BLD",4653,"KRN",870,"NM",1,0)
PSBCOTS1^^0
"BLD",4653,"KRN",870,"NM","B","PSBCOTS1",1)

"BLD",4653,"KRN",8989.51,0)
8989.51
"BLD",4653,"KRN",8989.51,"NM",0)
^9.68A^69^69
"BLD",4653,"KRN",8989.51,"NM",1,0)
PSB ADMIN AFTER^^0
"BLD",4653,"KRN",8989.51,"NM",2,0)
PSB ADMIN BEFORE^^0
"BLD",4653,"KRN",8989.51,"NM",3,0)
PSB ADMIN ESIG^^0
"BLD",4653,"KRN",8989.51,"NM",4,0)
PSB ADMIN MULTIPLE ONCALL^^0
"BLD",4653,"KRN",8989.51,"NM",5,0)
PSB ADMIN PRN EFFECT^^0
"BLD",4653,"KRN",8989.51,"NM",6,0)
PSB AUTOUPDATE SERVER^^0
"BLD",4653,"KRN",8989.51,"NM",7,0)
PSB BKUP DEFAULT^^0
"BLD",4653,"KRN",8989.51,"NM",8,0)
PSB BKUP IPH^^0
"BLD",4653,"KRN",8989.51,"NM",9,0)
PSB BKUP MACHINES^^0
"BLD",4653,"KRN",8989.51,"NM",10,0)
PSB BKUP MEDLG^^0
"BLD",4653,"KRN",8989.51,"NM",11,0)
PSB BKUP ONLINE^^0
"BLD",4653,"KRN",8989.51,"NM",12,0)
PSB DEFAULT BARCODE FORMAT^^0
"BLD",4653,"KRN",8989.51,"NM",13,0)
PSB DEFAULT BARCODE PREFIX^^0
"BLD",4653,"KRN",8989.51,"NM",14,0)
PSB DEFAULT BARCODE SITE^^0
"BLD",4653,"KRN",8989.51,"NM",15,0)
PSB DRUG INPUT TFORM^^0
"BLD",4653,"KRN",8989.51,"NM",16,0)
PSB GUI COLUMN WIDTHS^^0
"BLD",4653,"KRN",8989.51,"NM",17,0)
PSB GUI DEFAULT PRINTER^^0
"BLD",4653,"KRN",8989.51,"NM",18,0)
PSB HFS BACKUP^^0
"BLD",4653,"KRN",8989.51,"NM",19,0)
PSB HFS SCRATCH^^0
"BLD",4653,"KRN",8989.51,"NM",20,0)
PSB HKEY^^0
"BLD",4653,"KRN",8989.51,"NM",21,0)
PSB IDLE TIMEOUT^^0
"BLD",4653,"KRN",8989.51,"NM",22,0)
PSB IV COLUMN WIDTHS^^0
"BLD",4653,"KRN",8989.51,"NM",23,0)
PSB IVPB COLUMN WIDTHS^^0
"BLD",4653,"KRN",8989.51,"NM",24,0)
PSB LIST INJECTION SITES^^0
"BLD",4653,"KRN",8989.51,"NM",25,0)
PSB LIST REASONS GIVEN PRN^^0
"BLD",4653,"KRN",8989.51,"NM",26,0)
PSB LIST REASONS HELD^^0
"BLD",4653,"KRN",8989.51,"NM",27,0)
PSB LIST REASONS REFUSED^^0
"BLD",4653,"KRN",8989.51,"NM",28,0)
PSB MG AUTOUPDATE^^0
"BLD",4653,"KRN",8989.51,"NM",29,0)
PSB MG DUE LIST ERROR^^0
"BLD",4653,"KRN",8989.51,"NM",30,0)
PSB MG MISSING DOSE^^0
"BLD",4653,"KRN",8989.51,"NM",31,0)
PSB MG SYSTEM ERROR^^0
"BLD",4653,"KRN",8989.51,"NM",32,0)
PSB ONLINE^^0
"BLD",4653,"KRN",8989.51,"NM",33,0)
PSB PATIENT TRANSFER^^0
"BLD",4653,"KRN",8989.51,"NM",34,0)
PSB PRINTER MISSING DOSE^^0
"BLD",4653,"KRN",8989.51,"NM",35,0)
PSB PRINTER USER DEFAULT^^0
"BLD",4653,"KRN",8989.51,"NM",36,0)
PSB PRN DOCUMENTATION^^0
"BLD",4653,"KRN",8989.51,"NM",37,0)
PSB ROBOT RX^^0
"BLD",4653,"KRN",8989.51,"NM",38,0)
PSB SERVER CLOCK VARIANCE^^0
"BLD",4653,"KRN",8989.51,"NM",39,0)
PSB UNIT DOSE COLUMN WIDTHS^^0
"BLD",4653,"KRN",8989.51,"NM",40,0)
PSB VDL INCL BLANKS^^0
"BLD",4653,"KRN",8989.51,"NM",41,0)
PSB VDL INCL CONT^^0
"BLD",4653,"KRN",8989.51,"NM",42,0)
PSB VDL INCL IV MEDS^^0
"BLD",4653,"KRN",8989.51,"NM",43,0)
PSB VDL INCL ON-CALL^^0
"BLD",4653,"KRN",8989.51,"NM",44,0)
PSB VDL INCL ONE-TIME^^0
"BLD",4653,"KRN",8989.51,"NM",45,0)
PSB VDL INCL PRN^^0
"BLD",4653,"KRN",8989.51,"NM",46,0)
PSB VDL INCL UD MEDS^^0
"BLD",4653,"KRN",8989.51,"NM",47,0)
PSB VDL IV SORT COLUMN^^0
"BLD",4653,"KRN",8989.51,"NM",48,0)
PSB VDL ONE-TIME^^0
"BLD",4653,"KRN",8989.51,"NM",49,0)
PSB VDL PB SORT COLUMN^^0
"BLD",4653,"KRN",8989.51,"NM",50,0)
PSB VDL SORT COLUMN^^0
"BLD",4653,"KRN",8989.51,"NM",51,0)
PSB VDL START TIME^^0
"BLD",4653,"KRN",8989.51,"NM",52,0)
PSB VDL STOP TIME^^0
"BLD",4653,"KRN",8989.51,"NM",53,0)
PSB WINDOW^^0
"BLD",4653,"KRN",8989.51,"NM",54,0)
PSBIV ADDITIVE^^0
"BLD",4653,"KRN",8989.51,"NM",55,0)
PSBIV ADMIN TIME^^0
"BLD",4653,"KRN",8989.51,"NM",56,0)
PSBIV BOTTLE^^0
"BLD",4653,"KRN",8989.51,"NM",57,0)
PSBIV COLUMN WIDTH^^0
"BLD",4653,"KRN",8989.51,"NM",58,0)
PSBIV INFUSION RATE^^0
"BLD",4653,"KRN",8989.51,"NM",59,0)
PSBIV MED ROUTE^^0
"BLD",4653,"KRN",8989.51,"NM",60,0)
PSBIV OTHER PRINT INFO^^0
"BLD",4653,"KRN",8989.51,"NM",61,0)
PSBIV PROVIDER^^0
"BLD",4653,"KRN",8989.51,"NM",62,0)
PSBIV PROVIDER COMMENTS^^0
"BLD",4653,"KRN",8989.51,"NM",63,0)
PSBIV REMARKS^^0
"BLD",4653,"KRN",8989.51,"NM",64,0)
PSBIV SCHEDULE^^0
"BLD",4653,"KRN",8989.51,"NM",65,0)
PSBIV SOLUTION^^0
"BLD",4653,"KRN",8989.51,"NM",66,0)
PSBIV START DATE/TIME^^0
"BLD",4653,"KRN",8989.51,"NM",67,0)
PSBIV STOP DATE/TIME^^0
"BLD",4653,"KRN",8989.51,"NM",68,0)
PSBIV STRENGTH^^0
"BLD",4653,"KRN",8989.51,"NM",69,0)
PSBIV VOLUME^^0
"BLD",4653,"KRN",8989.51,"NM","B","PSB ADMIN AFTER",1)

"BLD",4653,"KRN",8989.51,"NM","B","PSB ADMIN BEFORE",2)

"BLD",4653,"KRN",8989.51,"NM","B","PSB ADMIN ESIG",3)

"BLD",4653,"KRN",8989.51,"NM","B","PSB ADMIN MULTIPLE ONCALL",4)

"BLD",4653,"KRN",8989.51,"NM","B","PSB ADMIN PRN EFFECT",5)

"BLD",4653,"KRN",8989.51,"NM","B","PSB AUTOUPDATE SERVER",6)

"BLD",4653,"KRN",8989.51,"NM","B","PSB BKUP DEFAULT",7)

"BLD",4653,"KRN",8989.51,"NM","B","PSB BKUP IPH",8)

"BLD",4653,"KRN",8989.51,"NM","B","PSB BKUP MACHINES",9)

"BLD",4653,"KRN",8989.51,"NM","B","PSB BKUP MEDLG",10)

"BLD",4653,"KRN",8989.51,"NM","B","PSB BKUP ONLINE",11)

"BLD",4653,"KRN",8989.51,"NM","B","PSB DEFAULT BARCODE FORMAT",12)

"BLD",4653,"KRN",8989.51,"NM","B","PSB DEFAULT BARCODE PREFIX",13)

"BLD",4653,"KRN",8989.51,"NM","B","PSB DEFAULT BARCODE SITE",14)

"BLD",4653,"KRN",8989.51,"NM","B","PSB DRUG INPUT TFORM",15)

"BLD",4653,"KRN",8989.51,"NM","B","PSB GUI COLUMN WIDTHS",16)

"BLD",4653,"KRN",8989.51,"NM","B","PSB GUI DEFAULT PRINTER",17)

"BLD",4653,"KRN",8989.51,"NM","B","PSB HFS BACKUP",18)

"BLD",4653,"KRN",8989.51,"NM","B","PSB HFS SCRATCH",19)

"BLD",4653,"KRN",8989.51,"NM","B","PSB HKEY",20)

"BLD",4653,"KRN",8989.51,"NM","B","PSB IDLE TIMEOUT",21)

"BLD",4653,"KRN",8989.51,"NM","B","PSB IV COLUMN WIDTHS",22)

"BLD",4653,"KRN",8989.51,"NM","B","PSB IVPB COLUMN WIDTHS",23)

"BLD",4653,"KRN",8989.51,"NM","B","PSB LIST INJECTION SITES",24)

"BLD",4653,"KRN",8989.51,"NM","B","PSB LIST REASONS GIVEN PRN",25)

"BLD",4653,"KRN",8989.51,"NM","B","PSB LIST REASONS HELD",26)

"BLD",4653,"KRN",8989.51,"NM","B","PSB LIST REASONS REFUSED",27)

"BLD",4653,"KRN",8989.51,"NM","B","PSB MG AUTOUPDATE",28)

"BLD",4653,"KRN",8989.51,"NM","B","PSB MG DUE LIST ERROR",29)

"BLD",4653,"KRN",8989.51,"NM","B","PSB MG MISSING DOSE",30)

"BLD",4653,"KRN",8989.51,"NM","B","PSB MG SYSTEM ERROR",31)

"BLD",4653,"KRN",8989.51,"NM","B","PSB ONLINE",32)

"BLD",4653,"KRN",8989.51,"NM","B","PSB PATIENT TRANSFER",33)

"BLD",4653,"KRN",8989.51,"NM","B","PSB PRINTER MISSING DOSE",34)

"BLD",4653,"KRN",8989.51,"NM","B","PSB PRINTER USER DEFAULT",35)

"BLD",4653,"KRN",8989.51,"NM","B","PSB PRN DOCUMENTATION",36)

"BLD",4653,"KRN",8989.51,"NM","B","PSB ROBOT RX",37)

"BLD",4653,"KRN",8989.51,"NM","B","PSB SERVER CLOCK VARIANCE",38)

"BLD",4653,"KRN",8989.51,"NM","B","PSB UNIT DOSE COLUMN WIDTHS",39)

"BLD",4653,"KRN",8989.51,"NM","B","PSB VDL INCL BLANKS",40)

"BLD",4653,"KRN",8989.51,"NM","B","PSB VDL INCL CONT",41)

"BLD",4653,"KRN",8989.51,"NM","B","PSB VDL INCL IV MEDS",42)

"BLD",4653,"KRN",8989.51,"NM","B","PSB VDL INCL ON-CALL",43)

"BLD",4653,"KRN",8989.51,"NM","B","PSB VDL INCL ONE-TIME",44)

"BLD",4653,"KRN",8989.51,"NM","B","PSB VDL INCL PRN",45)

"BLD",4653,"KRN",8989.51,"NM","B","PSB VDL INCL UD MEDS",46)

"BLD",4653,"KRN",8989.51,"NM","B","PSB VDL IV SORT COLUMN",47)

"BLD",4653,"KRN",8989.51,"NM","B","PSB VDL ONE-TIME",48)

"BLD",4653,"KRN",8989.51,"NM","B","PSB VDL PB SORT COLUMN",49)

"BLD",4653,"KRN",8989.51,"NM","B","PSB VDL SORT COLUMN",50)

"BLD",4653,"KRN",8989.51,"NM","B","PSB VDL START TIME",51)

"BLD",4653,"KRN",8989.51,"NM","B","PSB VDL STOP TIME",52)

"BLD",4653,"KRN",8989.51,"NM","B","PSB WINDOW",53)

"BLD",4653,"KRN",8989.51,"NM","B","PSBIV ADDITIVE",54)

"BLD",4653,"KRN",8989.51,"NM","B","PSBIV ADMIN TIME",55)

"BLD",4653,"KRN",8989.51,"NM","B","PSBIV BOTTLE",56)

"BLD",4653,"KRN",8989.51,"NM","B","PSBIV COLUMN WIDTH",57)

"BLD",4653,"KRN",8989.51,"NM","B","PSBIV INFUSION RATE",58)

"BLD",4653,"KRN",8989.51,"NM","B","PSBIV MED ROUTE",59)

"BLD",4653,"KRN",8989.51,"NM","B","PSBIV OTHER PRINT INFO",60)

"BLD",4653,"KRN",8989.51,"NM","B","PSBIV PROVIDER",61)

"BLD",4653,"KRN",8989.51,"NM","B","PSBIV PROVIDER COMMENTS",62)

"BLD",4653,"KRN",8989.51,"NM","B","PSBIV REMARKS",63)

"BLD",4653,"KRN",8989.51,"NM","B","PSBIV SCHEDULE",64)

"BLD",4653,"KRN",8989.51,"NM","B","PSBIV SOLUTION",65)

"BLD",4653,"KRN",8989.51,"NM","B","PSBIV START DATE/TIME",66)

"BLD",4653,"KRN",8989.51,"NM","B","PSBIV STOP DATE/TIME",67)

"BLD",4653,"KRN",8989.51,"NM","B","PSBIV STRENGTH",68)

"BLD",4653,"KRN",8989.51,"NM","B","PSBIV VOLUME",69)

"BLD",4653,"KRN",8989.52,0)
8989.52
"BLD",4653,"KRN",8989.52,"NM",0)
^9.68A^6^6
"BLD",4653,"KRN",8989.52,"NM",1,0)
PSB DIVISION^^0
"BLD",4653,"KRN",8989.52,"NM",2,0)
PSB LIST INJECTION SITES^^0
"BLD",4653,"KRN",8989.52,"NM",3,0)
PSB LIST REASONS GIVEN PRN^^0
"BLD",4653,"KRN",8989.52,"NM",4,0)
PSB LIST REASONS HELD^^0
"BLD",4653,"KRN",8989.52,"NM",5,0)
PSB LIST REASONS REFUSED^^0
"BLD",4653,"KRN",8989.52,"NM",6,0)
PSB ONE-TIME^^0
"BLD",4653,"KRN",8989.52,"NM","B","PSB DIVISION",1)

"BLD",4653,"KRN",8989.52,"NM","B","PSB LIST INJECTION SITES",2)

"BLD",4653,"KRN",8989.52,"NM","B","PSB LIST REASONS GIVEN PRN",3)

"BLD",4653,"KRN",8989.52,"NM","B","PSB LIST REASONS HELD",4)

"BLD",4653,"KRN",8989.52,"NM","B","PSB LIST REASONS REFUSED",5)

"BLD",4653,"KRN",8989.52,"NM","B","PSB ONE-TIME",6)

"BLD",4653,"KRN",8994,0)
8994
"BLD",4653,"KRN",8994,"NM",0)
^9.68A^35^35
"BLD",4653,"KRN",8994,"NM",1,0)
PSB ALLERGY^^0
"BLD",4653,"KRN",8994,"NM",2,0)
PSB BAG DETAIL^^0
"BLD",4653,"KRN",8994,"NM",3,0)
PSB CHECK IV^^0
"BLD",4653,"KRN",8994,"NM",4,0)
PSB CHECK SERVER^^0
"BLD",4653,"KRN",8994,"NM",5,0)
PSB CPRS ORDER^^0
"BLD",4653,"KRN",8994,"NM",6,0)
PSB DEVICE^^0
"BLD",4653,"KRN",8994,"NM",7,0)
PSB FMDATE^^0
"BLD",4653,"KRN",8994,"NM",8,0)
PSB GETIVPAR^^0
"BLD",4653,"KRN",8994,"NM",9,0)
PSB GETORDERTAB^^0
"BLD",4653,"KRN",8994,"NM",10,0)
PSB GETPRNS^^0
"BLD",4653,"KRN",8994,"NM",11,0)
PSB GETPROVIDER^^0
"BLD",4653,"KRN",8994,"NM",12,0)
PSB INSTRUCTOR^^0
"BLD",4653,"KRN",8994,"NM",13,0)
PSB IV ORDER HISTORY^^0
"BLD",4653,"KRN",8994,"NM",14,0)
PSB LOCK^^0
"BLD",4653,"KRN",8994,"NM",15,0)
PSB MAIL^^0
"BLD",4653,"KRN",8994,"NM",16,0)
PSB MAXDAYS^^0
"BLD",4653,"KRN",8994,"NM",17,0)
PSB MEDICATION HISTORY^^0
"BLD",4653,"KRN",8994,"NM",18,0)
PSB MOB DRUG LIST^^0
"BLD",4653,"KRN",8994,"NM",19,0)
PSB NURS WARDLIST^^0
"BLD",4653,"KRN",8994,"NM",20,0)
PSB PARAMETER^^0
"BLD",4653,"KRN",8994,"NM",21,0)
PSB PUTIVPAR^^0
"BLD",4653,"KRN",8994,"NM",22,0)
PSB REPORT^^0
"BLD",4653,"KRN",8994,"NM",23,0)
PSB SCANMED^^0
"BLD",4653,"KRN",8994,"NM",24,0)
PSB SCANPT^^0
"BLD",4653,"KRN",8994,"NM",25,0)
PSB SERVER CLOCK VARIANCE^^0
"BLD",4653,"KRN",8994,"NM",26,0)
PSB SUBMIT MISSING DOSE^^0
"BLD",4653,"KRN",8994,"NM",27,0)
PSB TRANSACTION^^0
"BLD",4653,"KRN",8994,"NM",28,0)
PSB USERLOAD^^0
"BLD",4653,"KRN",8994,"NM",29,0)
PSB USERSAVE^^0
"BLD",4653,"KRN",8994,"NM",30,0)
PSB VALIDATE ESIG^^0
"BLD",4653,"KRN",8994,"NM",31,0)
PSB VALIDATE ORDER^^0
"BLD",4653,"KRN",8994,"NM",32,0)
PSB VERSION CHECK^^0
"BLD",4653,"KRN",8994,"NM",33,0)
PSB VITAL MEAS FILE^^0
"BLD",4653,"KRN",8994,"NM",34,0)
PSB VITALS^^0
"BLD",4653,"KRN",8994,"NM",35,0)
PSB WARDLIST^^0
"BLD",4653,"KRN",8994,"NM","B","PSB ALLERGY",1)

"BLD",4653,"KRN",8994,"NM","B","PSB BAG DETAIL",2)

"BLD",4653,"KRN",8994,"NM","B","PSB CHECK IV",3)

"BLD",4653,"KRN",8994,"NM","B","PSB CHECK SERVER",4)

"BLD",4653,"KRN",8994,"NM","B","PSB CPRS ORDER",5)

"BLD",4653,"KRN",8994,"NM","B","PSB DEVICE",6)

"BLD",4653,"KRN",8994,"NM","B","PSB FMDATE",7)

"BLD",4653,"KRN",8994,"NM","B","PSB GETIVPAR",8)

"BLD",4653,"KRN",8994,"NM","B","PSB GETORDERTAB",9)

"BLD",4653,"KRN",8994,"NM","B","PSB GETPRNS",10)

"BLD",4653,"KRN",8994,"NM","B","PSB GETPROVIDER",11)

"BLD",4653,"KRN",8994,"NM","B","PSB INSTRUCTOR",12)

"BLD",4653,"KRN",8994,"NM","B","PSB IV ORDER HISTORY",13)

"BLD",4653,"KRN",8994,"NM","B","PSB LOCK",14)

"BLD",4653,"KRN",8994,"NM","B","PSB MAIL",15)

"BLD",4653,"KRN",8994,"NM","B","PSB MAXDAYS",16)

"BLD",4653,"KRN",8994,"NM","B","PSB MEDICATION HISTORY",17)

"BLD",4653,"KRN",8994,"NM","B","PSB MOB DRUG LIST",18)

"BLD",4653,"KRN",8994,"NM","B","PSB NURS WARDLIST",19)

"BLD",4653,"KRN",8994,"NM","B","PSB PARAMETER",20)

"BLD",4653,"KRN",8994,"NM","B","PSB PUTIVPAR",21)

"BLD",4653,"KRN",8994,"NM","B","PSB REPORT",22)

"BLD",4653,"KRN",8994,"NM","B","PSB SCANMED",23)

"BLD",4653,"KRN",8994,"NM","B","PSB SCANPT",24)

"BLD",4653,"KRN",8994,"NM","B","PSB SERVER CLOCK VARIANCE",25)

"BLD",4653,"KRN",8994,"NM","B","PSB SUBMIT MISSING DOSE",26)

"BLD",4653,"KRN",8994,"NM","B","PSB TRANSACTION",27)

"BLD",4653,"KRN",8994,"NM","B","PSB USERLOAD",28)

"BLD",4653,"KRN",8994,"NM","B","PSB USERSAVE",29)

"BLD",4653,"KRN",8994,"NM","B","PSB VALIDATE ESIG",30)

"BLD",4653,"KRN",8994,"NM","B","PSB VALIDATE ORDER",31)

"BLD",4653,"KRN",8994,"NM","B","PSB VERSION CHECK",32)

"BLD",4653,"KRN",8994,"NM","B","PSB VITAL MEAS FILE",33)

"BLD",4653,"KRN",8994,"NM","B","PSB VITALS",34)

"BLD",4653,"KRN",8994,"NM","B","PSB WARDLIST",35)

"BLD",4653,"KRN","B",.4,.4)

"BLD",4653,"KRN","B",.401,.401)

"BLD",4653,"KRN","B",.402,.402)

"BLD",4653,"KRN","B",.403,.403)

"BLD",4653,"KRN","B",.5,.5)

"BLD",4653,"KRN","B",.84,.84)

"BLD",4653,"KRN","B",3.6,3.6)

"BLD",4653,"KRN","B",3.8,3.8)

"BLD",4653,"KRN","B",9.2,9.2)

"BLD",4653,"KRN","B",9.8,9.8)

"BLD",4653,"KRN","B",19,19)

"BLD",4653,"KRN","B",19.1,19.1)

"BLD",4653,"KRN","B",101,101)

"BLD",4653,"KRN","B",409.61,409.61)

"BLD",4653,"KRN","B",771,771)

"BLD",4653,"KRN","B",870,870)

"BLD",4653,"KRN","B",8989.51,8989.51)

"BLD",4653,"KRN","B",8989.52,8989.52)

"BLD",4653,"KRN","B",8994,8994)

"BLD",4653,"QUES",0)
^9.62^^
"BLD",4653,"REQB",0)
^9.611^^
"FIA",53.66)
BCMA IV PARAMETERS
"FIA",53.66,0)
^PSB(53.66,
"FIA",53.66,0,0)
53.66P
"FIA",53.66,0,1)
y^y^f^^^^n
"FIA",53.66,0,10)

"FIA",53.66,0,11)

"FIA",53.66,0,"RLRO")

"FIA",53.66,0,"VR")
3.0^PSB
"FIA",53.66,53.66)
0
"FIA",53.66,53.67)
0
"FIA",53.68)
BCMA MISSING DOSE REQUEST
"FIA",53.68,0)
^PSB(53.68,
"FIA",53.68,0,0)
53.68
"FIA",53.68,0,1)
y^y^f^^^^n
"FIA",53.68,0,10)

"FIA",53.68,0,11)

"FIA",53.68,0,"RLRO")

"FIA",53.68,0,"VR")
3.0^PSB
"FIA",53.68,53.68)
0
"FIA",53.68,53.686)
0
"FIA",53.68,53.687)
0
"FIA",53.69)
BCMA REPORT REQUEST
"FIA",53.69,0)
^PSB(53.69,
"FIA",53.69,0,0)
53.69
"FIA",53.69,0,1)
y^y^f^^^^n
"FIA",53.69,0,10)

"FIA",53.69,0,11)

"FIA",53.69,0,"RLRO")

"FIA",53.69,0,"VR")
3.0^PSB
"FIA",53.69,53.69)
0
"FIA",53.78)
BCMA MEDICATION VARIANCE LOG
"FIA",53.78,0)
^PSB(53.78,
"FIA",53.78,0,0)
53.78PAO
"FIA",53.78,0,1)
y^y^f^^^^n
"FIA",53.78,0,10)

"FIA",53.78,0,11)

"FIA",53.78,0,"RLRO")

"FIA",53.78,0,"VR")
3.0^PSB
"FIA",53.78,53.78)
0
"FIA",53.79)
BCMA MEDICATION LOG
"FIA",53.79,0)
^PSB(53.79,
"FIA",53.79,0,0)
53.79PI
"FIA",53.79,0,1)
y^y^f^^^^n
"FIA",53.79,0,10)

"FIA",53.79,0,11)

"FIA",53.79,0,"RLRO")

"FIA",53.79,0,"VR")
3.0^PSB
"FIA",53.79,53.79)
0
"FIA",53.79,53.793)
0
"FIA",53.79,53.795)
0
"FIA",53.79,53.796)
0
"FIA",53.79,53.797)
0
"FIA",53.79,53.799)
0
"IX",53.79,53.79,"AORDX",0)
53.79^AORDX^DFN,ORDER NUMBER,ADMIN DATE/TIME^R^^R^IR^I^53.79^^^^^S
"IX",53.79,53.79,"AORDX",.1,0)
^^2^2^3001106^
"IX",53.79,53.79,"AORDX",.1,1,0)
Cross reference by; .01 PATIENT NAME; .11 ORDER REFERENCE NUMBER; and .06
"IX",53.79,53.79,"AORDX",.1,2,0)
ADMINISTRATION DATE/TIME.
"IX",53.79,53.79,"AORDX",1)
S ^PSB(53.79,"AORDX",$E(X(1),1,30),$E(X(2),1,15),$E(X(3),1,15),DA)=""
"IX",53.79,53.79,"AORDX",2)
K ^PSB(53.79,"AORDX",$E(X(1),1,30),$E(X(2),1,15),$E(X(3),1,15),DA)
"IX",53.79,53.79,"AORDX",2.5)
K ^PSB(53.79,"AORDX")
"IX",53.79,53.79,"AORDX",11.1,0)
^.114IA^3^3
"IX",53.79,53.79,"AORDX",11.1,1,0)
1^F^53.79^.01^30^1^F
"IX",53.79,53.79,"AORDX",11.1,2,0)
2^F^53.79^.11^15^2^F
"IX",53.79,53.79,"AORDX",11.1,3,0)
3^F^53.79^.06^15^3^F
"IX",53.79,53.79,"APATCH",0)
53.79^APATCH^Updates APATCH when DFN or admin date/time changes.^R^^F^IR^I^53.79^^^^^S
"IX",53.79,53.79,"APATCH",1)
S ^PSB(53.79,"APATCH",X(1),X(2),DA)=""
"IX",53.79,53.79,"APATCH",1.4)
S X=0 N I S I=0 F  S I=$O(^PSB(53.79,DA,.5,I)) Q:'I  I ($P($G(^(I,0)),U,4)="PATCH")&($P(^PSB(53.79,DA,0),U,9)="G") S X=1 Q
"IX",53.79,53.79,"APATCH",2)
K ^PSB(53.79,"APATCH",X(1),X(2),DA)
"IX",53.79,53.79,"APATCH",2.4)
S X=0 N I S I=0 F  S I=$O(^PSB(53.79,DA,.5,I)) Q:'I  I $P($G(^(I,0)),U,4)="PATCH" S X=1 Q
"IX",53.79,53.79,"APATCH",2.5)
K ^PSB(53.79,"APATCH")
"IX",53.79,53.79,"APATCH",11.1,0)
^.114IA^2^2
"IX",53.79,53.79,"APATCH",11.1,1,0)
1^F^53.79^.01^^1^F
"IX",53.79,53.79,"APATCH",11.1,2,0)
2^F^53.79^.06^^2^F
"IX",53.79,53.79,"AUID",0)
53.79^AUID^cross reference of dfn, order number, and unique id^R^^R^IR^I^53.79^^^^^S
"IX",53.79,53.79,"AUID",1)
S ^PSB(53.79,"AUID",X(1),$E(X(2),1,30),$E(X(3),1,30),DA)=""
"IX",53.79,53.79,"AUID",2)
K ^PSB(53.79,"AUID",X(1),$E(X(2),1,30),$E(X(3),1,30),DA)
"IX",53.79,53.79,"AUID",2.5)
K ^PSB(53.79,"AUID")
"IX",53.79,53.79,"AUID",11.1,0)
^.114IA^3^3
"IX",53.79,53.79,"AUID",11.1,1,0)
1^F^53.79^.01^^1^F
"IX",53.79,53.79,"AUID",11.1,1,3)

"IX",53.79,53.79,"AUID",11.1,2,0)
2^F^53.79^.11^30^2^F
"IX",53.79,53.79,"AUID",11.1,2,3)

"IX",53.79,53.79,"AUID",11.1,3,0)
3^F^53.79^.26^30^3^F
"IX",53.79,53.79,"AUID",11.1,3,3)

"IX",53.79,53.795,"APATCH",0)
53.795^APATCH^Sets the APATCH cross-reference when unit of administration is PATCH^MU^^F^IR^I^53.795^^^^^A
"IX",53.79,53.795,"APATCH",1)
N I S I=0 X "F  S I=$O(^PSB(53.79,DA(1),.5,I)) Q:'I  Q:$P($G(^(I,0)),U,4)=""PATCH""  Q:$P(^PSB(53.79,DA(1),0),U,9)'=""G""" S:I ^PSB(53.79,"APATCH",X(1),X(2),DA(1))="" K:'I ^PSB(53.79,"APATCH",X(1),X(2),DA(1))
"IX",53.79,53.795,"APATCH",1.4)
S X=X1(3)="PATCH"!(X2(3)="PATCH")&(X2(3)]"")
"IX",53.79,53.795,"APATCH",2)
N I S I=0 X "F  S I=$O(^PSB(53.79,DA(1),.5,I)) Q:'I  Q:$P($G(^(I,0)),U,4)=""PATCH""&(I'=DA)" S:I ^PSB(53.79,"APATCH",X(1),X(2),DA(1))="" K:'I ^PSB(53.79,"APATCH",X(1),X(2),DA(1))
"IX",53.79,53.795,"APATCH",2.4)
S X=X1(3)="PATCH"&(X2(3)="")
"IX",53.79,53.795,"APATCH",11.1,0)
^.114IA^3^3
"IX",53.79,53.795,"APATCH",11.1,1,0)
1^C^^^^1
"IX",53.79,53.795,"APATCH",11.1,1,1.5)
S X=$P(^PSB(53.79,DA(1),0),U)
"IX",53.79,53.795,"APATCH",11.1,2,0)
2^C^^^^2
"IX",53.79,53.795,"APATCH",11.1,2,1.5)
S X=$P(^PSB(53.79,DA(1),0),U,6)
"IX",53.79,53.795,"APATCH",11.1,3,0)
3^F^53.795^.04^^3^F
"KRN",.403,3,-1)
0^7
"KRN",.403,3,0)
PSB PRN EFFECTIVENESS^@^@^^2990322.143^^^53.79^0^0^1
"KRN",.403,3,12)
D REFRESH^DDSUTL
"KRN",.403,3,40,0)
^.4031I^1^1
"KRN",.403,3,40,1,0)
1^^1,1
"KRN",.403,3,40,1,1)
Page 1
"KRN",.403,3,40,1,40,0)
^.4032IP^316^1
"KRN",.403,3,40,1,40,316,0)
PSB PRN EFFECTIVENESS^1^1,1^e
"KRN",.403,5,-1)
0^1
"KRN",.403,5,0)
PSB MED LOG EDIT^@^@^^2990323.1252^^^53.79^0^0^1
"KRN",.403,5,40,0)
^.4031I^2^2
"KRN",.403,5,40,1,0)
1^^1,1
"KRN",.403,5,40,1,1)
Page 1
"KRN",.403,5,40,1,40,0)
^.4032IP^317^1
"KRN",.403,5,40,1,40,317,0)
PSB MED LOG EDIT^1^1,1^e
"KRN",.403,5,40,2,0)
2^^5,5^^^1^15,75
"KRN",.403,5,40,2,1)
Page 2
"KRN",.403,5,40,2,40,0)
^.4032IP^319^2
"KRN",.403,5,40,2,40,318,0)
PSB MED LOG EDIT DD HDR^1^1,1^d
"KRN",.403,5,40,2,40,319,0)
PSB MED LOG EDIT DD^2^4,3^e
"KRN",.403,5,40,2,40,319,2)
3^B^f^0
"KRN",.403,81,-1)
0^9
"KRN",.403,81,0)
PSBO DL^^^^2990313.1144^^Due List^53.69^0^0^1
"KRN",.403,81,11)
S PSBSAVE=0
"KRN",.403,81,14)
S PSBSAVE=1
"KRN",.403,81,20)
D VAL^PSBO(".16;.17;.19;.11;.12;.13;.15;.21;.22;.23;.24;.25;.26;.27;.06;.07")
"KRN",.403,81,40,0)
^.4031I^1^1
"KRN",.403,81,40,1,0)
1^^1,1
"KRN",.403,81,40,1,1)
Page 1
"KRN",.403,81,40,1,40,0)
^.4032IP^327^5
"KRN",.403,81,40,1,40,301,0)
PSBO HDR^1^1,1^d
"KRN",.403,81,40,1,40,302,0)
PSBO DL^4^10,1^e
"KRN",.403,81,40,1,40,303,0)
PSBO FTR^5^15,1^e
"KRN",.403,81,40,1,40,315,0)
PSBO PT OR WARD^3^6,1^e
"KRN",.403,81,40,1,40,327,0)
PSBO DATE DL^2^3,1^e
"KRN",.403,82,-1)
0^16
"KRN",.403,82,0)
PSBO WA^^^^2990313.121^^Ward Administration Times^53.69^0^0^1
"KRN",.403,82,11)
S PSBSAVE=0
"KRN",.403,82,14)
S PSBSAVE=1
"KRN",.403,82,20)
D VAL^PSBO(".16;.11;.12;.13;.15;.06;.07")
"KRN",.403,82,40,0)
^.4031I^1^1
"KRN",.403,82,40,1,0)
1^^1,1
"KRN",.403,82,40,1,1)
Page 1
"KRN",.403,82,40,1,40,0)
^.4032IP^315^4
"KRN",.403,82,40,1,40,301,0)
PSBO HDR^1^1,1^d
"KRN",.403,82,40,1,40,303,0)
PSBO FTR^4^15,1^e
"KRN",.403,82,40,1,40,304,0)
PSBO WA^2^3,1^e
"KRN",.403,82,40,1,40,315,0)
PSBO PT OR WARD^3^6,1^e
"KRN",.403,83,-1)
0^12
"KRN",.403,83,0)
PSBO ML^^^^2990313.1858^^Medication Log^53.69^0^0^1
"KRN",.403,83,11)
S PSBSAVE=0
"KRN",.403,83,14)
S PSBSAVE=1
"KRN",.403,83,20)
D VAL^PSBO(".16;.17;.18;.19;.11;.12;.13;.15;.06;.07")
"KRN",.403,83,40,0)
^.4031I^1^1
"KRN",.403,83,40,1,0)
1^^1,1
"KRN",.403,83,40,1,1)
Page 1
"KRN",.403,83,40,1,40,0)
^.4032IP^326^5
"KRN",.403,83,40,1,40,301,0)
PSBO HDR^1^1,1^d
"KRN",.403,83,40,1,40,303,0)
PSBO FTR^5^15,1^e
"KRN",.403,83,40,1,40,314,0)
PSBO DATES^2^3,1^e
"KRN",.403,83,40,1,40,315,0)
PSBO PT OR WARD^3^6,1^e
"KRN",.403,83,40,1,40,326,0)
PSBO ML^4^10,1^e
"KRN",.403,84,-1)
0^13
"KRN",.403,84,0)
PSBO MM^^^^2990313.1907^^Missed Medications^53.69^0^0^1
"KRN",.403,84,11)
S PSBSAVE=0
"KRN",.403,84,14)
S PSBSAVE=1
"KRN",.403,84,20)
D VAL^PSBO(".16;.17;.19;.11;.12;.13;.15;.06;.07")
"KRN",.403,84,40,0)
^.4031I^1^1
"KRN",.403,84,40,1,0)
1^^1,1
"KRN",.403,84,40,1,1)
Page 1
"KRN",.403,84,40,1,40,0)
^.4032IP^315^4
"KRN",.403,84,40,1,40,301,0)
PSBO HDR^1^1,1^d
"KRN",.403,84,40,1,40,303,0)
PSBO FTR^4^15,1^e
"KRN",.403,84,40,1,40,305,0)
PSBO MM^2^3,1^e
"KRN",.403,84,40,1,40,315,0)
PSBO PT OR WARD^3^6,1^e
"KRN",.403,85,-1)
0^15
"KRN",.403,85,0)
PSBO PE^^^^2990313.1924^^PRN Effectiveness^53.69^0^0^1
"KRN",.403,85,11)
S PSBSAVE=0
"KRN",.403,85,14)
S PSBSAVE=1
"KRN",.403,85,20)
D VAL^PSBO(".16;.17;.18;.19;.11;.12;.13;.15;.06;.07")
"KRN",.403,85,40,0)
^.4031I^1^1
"KRN",.403,85,40,1,0)
1^^1,1
"KRN",.403,85,40,1,1)
Page 1
"KRN",.403,85,40,1,40,0)
^.4032IP^315^4
"KRN",.403,85,40,1,40,301,0)
PSBO HDR^1^1,1^d
"KRN",.403,85,40,1,40,303,0)
PSBO FTR^4^15,1^e
"KRN",.403,85,40,1,40,306,0)
PSBO PE^2^3,1^e
"KRN",.403,85,40,1,40,315,0)
PSBO PT OR WARD^3^6,1^e
"KRN",.403,86,-1)
0^4
"KRN",.403,86,0)
PSB MISSING DOSE REQUEST^^^^2990313.1948^^Missing Dose Request^53.68^0^0^1
"KRN",.403,86,11)
S PSBSAVE=0
"KRN",.403,86,14)
S PSBSAVE=1
"KRN",.403,86,20)
D VAL^PSBMD(".11;.12;.13;.14;.15;.16;.17;.18")
"KRN",.403,86,40,0)
^.4031I^1^1
"KRN",.403,86,40,1,0)
1^^1,1
"KRN",.403,86,40,1,1)
Page 1
"KRN",.403,86,40,1,40,0)
^.4032IP^309^2
"KRN",.403,86,40,1,40,307,0)
PSB MISSING DOSE HDR^1^1,1^d
"KRN",.403,86,40,1,40,309,0)
PSB MISSING DOSE REQUEST^2^5,1^e
"KRN",.403,87,-1)
0^11
"KRN",.403,87,0)
PSBO MH^^^^2990313.2033^^Medication Administration History^53.69^0^0^1
"KRN",.403,87,11)
S PSBSAVE=0
"KRN",.403,87,14)
S PSBSAVE=1
"KRN",.403,87,20)
D VAL^PSBO(".16;.18;.11;.12;.13;.15;.06;.07")
"KRN",.403,87,40,0)
^.4031I^1^1
"KRN",.403,87,40,1,0)
1^^1,1
"KRN",.403,87,40,1,1)
Page 1
"KRN",.403,87,40,1,40,0)
^.4032IP^315^4
"KRN",.403,87,40,1,40,301,0)
PSBO HDR^1^1,1^d
"KRN",.403,87,40,1,40,303,0)
PSBO FTR^4^15,1^e
"KRN",.403,87,40,1,40,308,0)
PSBO MH^2^3,1^e
"KRN",.403,87,40,1,40,315,0)
PSBO PT OR WARD^3^6,1^e
"KRN",.403,88,-1)
0^14
"KRN",.403,88,0)
PSBO MV^^^^2990313.232^^Medication Variance Log^53.69^0^0^1
"KRN",.403,88,11)
S PSBSAVE=0
"KRN",.403,88,14)
S PSBSAVE=1
"KRN",.403,88,20)
D VAL^PSBO(".16;.17;.18;.19;.11;.12;.13;.15;.06;.07")
"KRN",.403,88,40,0)
^.4031I^1^1
"KRN",.403,88,40,1,0)
1^^1,1
"KRN",.403,88,40,1,1)
Page 1
"KRN",.403,88,40,1,40,0)
^.4032IP^315^4
"KRN",.403,88,40,1,40,301,0)
PSBO HDR^1^1,1^d
"KRN",.403,88,40,1,40,303,0)
PSBO FTR^4^15,1^e
"KRN",.403,88,40,1,40,310,0)
PSBO MV^2^3,1^e
"KRN",.403,88,40,1,40,315,0)
PSBO PT OR WARD^3^6,1^e
"KRN",.403,89,-1)
0^3
"KRN",.403,89,0)
PSB MISSING DOSE FOLLOWUP^^^^2990313.2347^^Missing Dose Followup^53.68^0^0^1
"KRN",.403,89,11)
S PSBSAVE=0
"KRN",.403,89,14)
S PSBSAVE=1
"KRN",.403,89,20)
D VAL^PSBMD(".21;.24;.17")
"KRN",.403,89,40,0)
^.4031I^1^1
"KRN",.403,89,40,1,0)
1^^1,1
"KRN",.403,89,40,1,1)
Page 1
"KRN",.403,89,40,1,40,0)
^.4032IP^311^2
"KRN",.403,89,40,1,40,307,0)
PSB MISSING DOSE HDR^1^1,1^d
"KRN",.403,89,40,1,40,311,0)
PSB MISSING DOSE FOLLOWUP^2^5,1^e
"KRN",.403,90,-1)
0^8
"KRN",.403,90,0)
PSBO BL^^^^2990318.1536^^^53.69^0^0^1
"KRN",.403,90,11)
S PSBSAVE=0
"KRN",.403,90,14)
S PSBSAVE=1
"KRN",.403,90,20)
D VAL^PSBO(".31;.36;.37;.06")
"KRN",.403,90,40,0)
^.4031I^1^1
"KRN",.403,90,40,1,0)
1^^1,1
"KRN",.403,90,40,1,1)
Page 1
"KRN",.403,90,40,1,40,0)
^.4032IP^312^3
"KRN",.403,90,40,1,40,301,0)
PSBO HDR^1^1,1^d
"KRN",.403,90,40,1,40,303,0)
PSBO FTR^3^15,1^e
"KRN",.403,90,40,1,40,312,0)
PSBO BL^2^3,1^e
"KRN",.403,91,-1)
0^10
"KRN",.403,91,0)
PSBO MD^^^^2990318.1618^^^53.69^0^0^1
"KRN",.403,91,11)
S PSBSAVE=0
"KRN",.403,91,14)
S PSBSAVE=1
"KRN",.403,91,20)
D VAL^PSBO(".16;.17;.18;.19")
"KRN",.403,91,40,0)
^.4031I^1^1
"KRN",.403,91,40,1,0)
1^^1,1
"KRN",.403,91,40,1,1)
Page 1
"KRN",.403,91,40,1,40,0)
^.4032IP^313^3
"KRN",.403,91,40,1,40,301,0)
PSBO HDR^1^1,1^d
"KRN",.403,91,40,1,40,303,0)
PSBO FTR^3^15,1^e
"KRN",.403,91,40,1,40,313,0)
PSBO MD^2^3,1^e
"KRN",.403,92,-1)
0^6
"KRN",.403,92,0)
PSB NEW UD ENTRY^^@^^2990323.1252^^^53.79^0^0^1
"KRN",.403,92,11)
S PSBSAVE=0
"KRN",.403,92,12)

"KRN",.403,92,14)
S PSBSAVE=1
"KRN",.403,92,20)

"KRN",.403,92,40,0)
^.4031I^2^2
"KRN",.403,92,40,1,0)
1^^1,1
"KRN",.403,92,40,1,1)
Page 1
"KRN",.403,92,40,1,40,0)
^.4032IP^320^1
"KRN",.403,92,40,1,40,320,0)
PSB NEW UD ENTRY^1^1,1^e
"KRN",.403,92,40,2,0)
2^^5,5^^^1^15,75
"KRN",.403,92,40,2,1)
Page 2
"KRN",.403,92,40,2,40,0)
^.4032IP^322^2
"KRN",.403,92,40,2,40,321,0)
PSB NEW UD ENTRY DD HDR^1^1,1^d
"KRN",.403,92,40,2,40,322,0)
PSB NEW UD ENTRY DD^2^4,3^e
"KRN",.403,92,40,2,40,322,2)
3^B^f^1
"KRN",.403,93,-1)
0^5
"KRN",.403,93,0)
PSB NEW IV ENTRY^^^^2990323.1252^^^53.79^0^0^1
"KRN",.403,93,11)
S PSBSAVE=0
"KRN",.403,93,14)
S PSBSAVE=1
"KRN",.403,93,20)
S PSBSAVE=0
"KRN",.403,93,40,0)
^.4031I^2^2
"KRN",.403,93,40,1,0)
1^^1,1
"KRN",.403,93,40,1,1)
Page 1
"KRN",.403,93,40,1,40,0)
^.4032IP^323^1
"KRN",.403,93,40,1,40,323,0)
PSB NEW IV ENTRY^1^1,1^e
"KRN",.403,93,40,2,0)
2^^5,5^^^1^15,75
"KRN",.403,93,40,2,1)
Page 2
"KRN",.403,93,40,2,40,0)
^.4032IP^325^2
"KRN",.403,93,40,2,40,324,0)
PSB NEW IV ENTRY ADD HDR^1^1,1^d
"KRN",.403,93,40,2,40,325,0)
PSB NEW IV ENTRY ADD^2^4,3^e
"KRN",.403,93,40,2,40,325,2)
3^B^f^1
"KRN",.403,98,-1)
0^2
"KRN",.403,98,0)
PSB MED LOG EDIT IV^@^@^^2990323.1252^^^53.79^0^0^1
"KRN",.403,98,40,0)
^.4031I^2^2
"KRN",.403,98,40,1,0)
1^^1,1
"KRN",.403,98,40,1,1)
Page 1
"KRN",.403,98,40,1,40,0)
^.4032IP^364^1
"KRN",.403,98,40,1,40,364,0)
PSB MED LOG EDIT IV^1^1,1^e
"KRN",.403,98,40,2,0)
2^^5,5^^^1^15,75
"KRN",.403,98,40,2,1)
Page 2
"KRN",.403,98,40,2,40,0)
^.4032IP^366^2
"KRN",.403,98,40,2,40,365,0)
PSB MED LOG EDIT IV HDR^1^1,1^d
"KRN",.403,98,40,2,40,366,0)
PSB MED LOG EDIT DD IV^2^4,3^e
"KRN",.403,98,40,2,40,366,2)
3^B^f^0
"KRN",.404,301,0)
PSBO HDR^53.69^
"KRN",.404,301,40,0)
^.4044I^4^3
"KRN",.404,301,40,1,0)
1^!M^1
"KRN",.404,301,40,1,.1)
S Y="Request #: "_$P(^PSB(53.69,DA,0),U)
"KRN",.404,301,40,1,2)
^^1,1
"KRN",.404,301,40,3,0)
3^!M^1
"KRN",.404,301,40,3,.1)
S Y=$TR($J("",80)," ","-")
"KRN",.404,301,40,3,2)
^^2,1
"KRN",.404,301,40,4,0)
2^!M^1
"KRN",.404,301,40,4,.1)
S Y=$J($$GET1^DIQ(53.69,DA_",",.05),40)
"KRN",.404,301,40,4,2)
^^1,41
"KRN",.404,302,0)
PSBO DL^53.69
"KRN",.404,302,40,0)
^.4044I^14^7
"KRN",.404,302,40,7,0)
8^Include Schedule - Continuous^3
"KRN",.404,302,40,7,1)
.21
"KRN",.404,302,40,7,2)
1,33^3^1,2
"KRN",.404,302,40,7,3)
!M
"KRN",.404,302,40,7,3.1)
S Y=+$$GET^XPAR("ALL","PSB VDL INCL CONT")
"KRN",.404,302,40,7,13)
D EN^XPAR("USR","PSB VDL INCL CONT",1,DDSEXT)
"KRN",.404,302,40,8,0)
9^PRN^3
"KRN",.404,302,40,8,1)
.22
"KRN",.404,302,40,8,2)
2,33^3^2,28
"KRN",.404,302,40,8,3)
!M
"KRN",.404,302,40,8,3.1)
S Y=+$$GET^XPAR("ALL","PSB VDL INCL PRN")
"KRN",.404,302,40,8,13)
D EN^XPAR("USR","PSB VDL INCL PRN",1,DDSEXT)
"KRN",.404,302,40,9,0)
10^On Call^3
"KRN",.404,302,40,9,1)
.23
"KRN",.404,302,40,9,2)
3,33^3^3,24
"KRN",.404,302,40,9,3)
!M
"KRN",.404,302,40,9,3.1)
S Y=+$$GET^XPAR("ALL","PSB VDL INCL ON-CALL")
"KRN",.404,302,40,9,13)
D EN^XPAR("USR","PSB VDL INCL ON-CALL",1,DDSEXT)
"KRN",.404,302,40,10,0)
11^One-Time^3
"KRN",.404,302,40,10,1)
.24
"KRN",.404,302,40,10,2)
4,33^3^4,23
"KRN",.404,302,40,10,3)
!M
"KRN",.404,302,40,10,3.1)
S Y=+$$GET^XPAR("ALL","PSB VDL INCL ONE-TIME")
"KRN",.404,302,40,10,13)
D EN^XPAR("USR","PSB VDL INCL ONE-TIME",1,DDSEXT)
"KRN",.404,302,40,12,0)
15^Include Addendums^3
"KRN",.404,302,40,12,1)
.25
"KRN",.404,302,40,12,2)
4,64^3^4,45
"KRN",.404,302,40,12,3)
!M
"KRN",.404,302,40,12,3.1)
S Y=+$$GET^XPAR("ALL","PSB VDL INCL BLANKS")
"KRN",.404,302,40,12,13)
D EN^XPAR("USR","PSB VDL INCL BLANKS",1,DDSEXT)
"KRN",.404,302,40,13,0)
12^Include Order Types - IV^3
"KRN",.404,302,40,13,1)
.26
"KRN",.404,302,40,13,2)
1,64^3^1,38
"KRN",.404,302,40,13,3)
!M
"KRN",.404,302,40,13,3.1)
S Y=+$$GET^XPAR("ALL","PSB VDL INCL IV MEDS")
"KRN",.404,302,40,13,13)
D EN^XPAR("USR","PSB VDL INCL IV MEDS",1,DDSEXT)
"KRN",.404,302,40,14,0)
13^Unit Dose^3
"KRN",.404,302,40,14,1)
.27
"KRN",.404,302,40,14,2)
2,64^3^2,53
"KRN",.404,302,40,14,3)
!M
"KRN",.404,302,40,14,3.1)
S Y=+$$GET^XPAR("ALL","PSB VDL INCL UD MEDS")
"KRN",.404,302,40,14,13)
D EN^XPAR("USR","PSB VDL INCL UD MEDS",1,DDSEXT)
"KRN",.404,303,0)
PSBO FTR^53.69
"KRN",.404,303,40,0)
^.4044I^3^3
"KRN",.404,303,40,1,0)
1^Print to DEVICE^3
"KRN",.404,303,40,1,1)
.06
"KRN",.404,303,40,1,2)
1,59^22^1,42
"KRN",.404,303,40,1,3)
!M
"KRN",.404,303,40,1,3.1)
S Y=$$GET^XPAR("USR","PSB PRINTER USER DEFAULT",1,"E")
"KRN",.404,303,40,1,13)
D EN^XPAR("USR","PSB PRINTER USER DEFAULT",1,"`"_X)
"KRN",.404,303,40,2,0)
2^Queue To Run At^3
"KRN",.404,303,40,2,1)
.07
"KRN",.404,303,40,2,2)
2,59^17^2,42
"KRN",.404,303,40,2,3)
NOW
"KRN",.404,303,40,3,0)
3^Instructions: PF1-E Submit   PF1-Q Cancel   PF1-R Refresh   <Ret> Re-Edit^2
"KRN",.404,303,40,3,2)
3,76^1^3,1
"KRN",.404,303,40,3,10)
S DDSBR="1^2^1" ; Return to field 1 block 2
"KRN",.404,303,40,3,20)
F^^1:1
"KRN",.404,304,0)
PSBO WA^53.69
"KRN",.404,304,40,0)
^.4044I^1^1
"KRN",.404,304,40,1,0)
1^Date for Report^3
"KRN",.404,304,40,1,1)
.16
"KRN",.404,304,40,1,2)
2,19^11^2,2
"KRN",.404,304,40,1,3)
TODAY
"KRN",.404,305,0)
PSBO MM^53.69
"KRN",.404,305,40,0)
^.4044I^1^3
"KRN",.404,305,40,1,0)
1^Date for Report^3
"KRN",.404,305,40,1,1)
.16
"KRN",.404,305,40,1,2)
2,19^11^2,2
"KRN",.404,305,40,2,0)
2^Start Time^3
"KRN",.404,305,40,2,1)
.17
"KRN",.404,305,40,2,2)
2,44^6^2,32
"KRN",.404,305,40,3,0)
3^Stop Time^3
"KRN",.404,305,40,3,1)
.19
"KRN",.404,305,40,3,2)
2,63^6^2,52
"KRN",.404,306,0)
PSBO PE^53.69
"KRN",.404,306,40,0)
^.4044I^4^4
"KRN",.404,306,40,1,0)
1^Start Date^3
"KRN",.404,306,40,1,1)
.16
"KRN",.404,306,40,1,2)
2,14^11^2,2
"KRN",.404,306,40,2,0)
2^Time^3
"KRN",.404,306,40,2,1)
.17
"KRN",.404,306,40,2,2)
2,33^6^2,27
"KRN",.404,306,40,3,0)
4^Time^3
"KRN",.404,306,40,3,1)
.19
"KRN",.404,306,40,3,2)
2,71^6^2,65
"KRN",.404,306,40,4,0)
3^Stop Date^3
"KRN",.404,306,40,4,1)
.18
"KRN",.404,306,40,4,2)
2,52^11^2,41
"KRN",.404,307,0)
PSB MISSING DOSE HDR^53.68^
"KRN",.404,307,40,0)
^.4044I^6^6
"KRN",.404,307,40,1,0)
1^!M^1
"KRN",.404,307,40,1,.1)
S Y="Request #: "_$$GET1^DIQ(53.68,DA_",",.01)
"KRN",.404,307,40,1,2)
^^1,1
"KRN",.404,307,40,2,0)
2^Missing Dose Request^1
"KRN",.404,307,40,2,2)
^^1,60
"KRN",.404,307,40,3,0)
3^!M^1
"KRN",.404,307,40,3,.1)
S Y=$TR($J("",80)," ","-")
"KRN",.404,307,40,3,2)
^^2,1
"KRN",.404,307,40,4,0)
4^Requesting User^3
"KRN",.404,307,40,4,1)
.03
"KRN",.404,307,40,4,2)
3,20^30^3,1
"KRN",.404,307,40,5,0)
5^Division^3
"KRN",.404,307,40,5,1)
.04
"KRN",.404,307,40,5,2)
3,62^18^3,52
"KRN",.404,307,40,6,0)
6^Request Date/Time^3
"KRN",.404,307,40,6,1)
.02
"KRN",.404,307,40,6,2)
4,20^17^4,1
"KRN",.404,308,0)
PSBO MH^53.69
"KRN",.404,308,40,0)
^.4044I^1^2
"KRN",.404,308,40,1,0)
1^Start Date^3
"KRN",.404,308,40,1,1)
.16
"KRN",.404,308,40,1,2)
2,14^11^2,2
"KRN",.404,308,40,2,0)
2^Stop Date^3
"KRN",.404,308,40,2,1)
.18
"KRN",.404,308,40,2,2)
2,38^11^2,27
"KRN",.404,309,0)
PSB MISSING DOSE REQUEST^53.68
"KRN",.404,309,40,0)
^.4044I^9^9
"KRN",.404,309,40,1,0)
1^Patient Name^3
"KRN",.404,309,40,1,1)
.11
"KRN",.404,309,40,1,2)
2,18^30^2,3
"KRN",.404,309,40,1,13)
D REFRESH^DDSUTL
"KRN",.404,309,40,2,0)
2^Ward Location^3
"KRN",.404,309,40,2,1)
.12
"KRN",.404,309,40,2,2)
3,18^30^3,3
"KRN",.404,309,40,3,0)
4^Missing Drug^3
"KRN",.404,309,40,3,1)
.13
"KRN",.404,309,40,3,2)
6,18^30^6,3
"KRN",.404,309,40,4,0)
5^Dosage Needed^3
"KRN",.404,309,40,4,1)
.14
"KRN",.404,309,40,4,2)
7,18^30^7,3
"KRN",.404,309,40,5,0)
6^Reason Needed^3
"KRN",.404,309,40,5,1)
.15
"KRN",.404,309,40,5,2)
8,18^25^8,3
"KRN",.404,309,40,6,0)
8^Administration Date/Time^3
"KRN",.404,309,40,6,1)
.16
"KRN",.404,309,40,6,2)
11,29^17^11,3
"KRN",.404,309,40,7,0)
9^Needed by Date/Time^3
"KRN",.404,309,40,7,1)
.17
"KRN",.404,309,40,7,2)
12,29^17^12,3
"KRN",.404,309,40,8,0)
3^Room/Bed^3
"KRN",.404,309,40,8,1)
.18
"KRN",.404,309,40,8,2)
4,13^30^4,3
"KRN",.404,309,40,9,0)
7^Schedule^3
"KRN",.404,309,40,9,1)
.19
"KRN",.404,309,40,9,2)
10,13^25^10,3
"KRN",.404,309,40,9,4)
1
"KRN",.404,310,0)
PSBO MV^53.69^
"KRN",.404,310,40,0)
^.4044I^2^4
"KRN",.404,310,40,1,0)
1^Start Date^3
"KRN",.404,310,40,1,1)
.16
"KRN",.404,310,40,1,2)
2,14^11^2,2
"KRN",.404,310,40,2,0)
2^Time^3
"KRN",.404,310,40,2,1)
.17
"KRN",.404,310,40,2,2)
2,33^6^2,27
"KRN",.404,310,40,3,0)
3^Stop Date^3
"KRN",.404,310,40,3,1)
.18
"KRN",.404,310,40,3,2)
2,52^11^2,41
"KRN",.404,310,40,4,0)
4^Time^3
"KRN",.404,310,40,4,1)
.19
"KRN",.404,310,40,4,2)
2,71^6^2,65
"KRN",.404,311,0)
PSB MISSING DOSE FOLLOWUP^53.68
"KRN",.404,311,40,0)
^.4044I^9^9
"KRN",.404,311,40,1,0)
1^Patient Name^3
"KRN",.404,311,40,1,1)
.11
"KRN",.404,311,40,1,2)
2,17^30^2,1
"KRN",.404,311,40,1,4)
^^^1
"KRN",.404,311,40,2,0)
2^Ward^3
"KRN",.404,311,40,2,1)
.12
"KRN",.404,311,40,2,2)
2,55^18^2,49
"KRN",.404,311,40,2,4)
^^^1
"KRN",.404,311,40,3,0)
3^Drug Requested^3
"KRN",.404,311,40,3,1)
.13
"KRN",.404,311,40,3,2)
3,17^30^3,1
"KRN",.404,311,40,3,4)
^^^1
"KRN",.404,311,40,4,0)
6^Dose Delivered^3
"KRN",.404,311,40,4,1)
.21
"KRN",.404,311,40,4,2)
7,27^3^7,3
"KRN",.404,311,40,5,0)
7^Delivered By^3
"KRN",.404,311,40,5,1)
.22
"KRN",.404,311,40,5,2)
8,27^35^8,3
"KRN",.404,311,40,5,3)
!M
"KRN",.404,311,40,5,3.1)
S Y="`"_DUZ
"KRN",.404,311,40,6,0)
8^Delivery Date/Time^3
"KRN",.404,311,40,6,1)
.23
"KRN",.404,311,40,6,2)
9,27^17^9,3
"KRN",.404,311,40,7,0)
9^Pharmacy Reason Needed^3
"KRN",.404,311,40,7,1)
.24
"KRN",.404,311,40,7,2)
10,27^25^10,3
"KRN",.404,311,40,8,0)
5^***** Pharmacy Followup Information *****^1
"KRN",.404,311,40,8,2)
^^5,17
"KRN",.404,311,40,9,0)
4^Room/Bed^3
"KRN",.404,311,40,9,1)
.18
"KRN",.404,311,40,9,2)
3,59^15^3,49
"KRN",.404,311,40,9,4)
^^^1
"KRN",.404,312,0)
PSBO BL^53.69
"KRN",.404,312,40,0)
^.4044I^10^10
"KRN",.404,312,40,1,0)
1^Drug Name^3
"KRN",.404,312,40,1,1)
.31
"KRN",.404,312,40,1,2)
2,13^40^2,2
"KRN",.404,312,40,2,0)
2^Lot #^3
"KRN",.404,312,40,2,1)
.32
"KRN",.404,312,40,2,2)
3,19^15^3,12
"KRN",.404,312,40,3,0)
3^Expiration Date^3
"KRN",.404,312,40,3,1)
.33
"KRN",.404,312,40,3,2)
4,19^11^4,2
"KRN",.404,312,40,4,0)
4^Manufacturer^3
"KRN",.404,312,40,4,1)
.34
"KRN",.404,312,40,4,2)
5,19^30^5,5
"KRN",.404,312,40,5,0)
5^Quantity^3
"KRN",.404,312,40,5,1)
.35
"KRN",.404,312,40,5,2)
7,19^7^7,9
"KRN",.404,312,40,6,0)
6^Filled By^3
"KRN",.404,312,40,6,1)
.36
"KRN",.404,312,40,6,2)
8,19^5^8,8
"KRN",.404,312,40,7,0)
7^Checked By^3
"KRN",.404,312,40,7,1)
.37
"KRN",.404,312,40,7,2)
9,19^5^9,7
"KRN",.404,312,40,8,0)
8^# Labels^3
"KRN",.404,312,40,8,1)
.38
"KRN",.404,312,40,8,2)
10,19^7^10,9
"KRN",.404,312,40,8,3)
1
"KRN",.404,312,40,9,0)
9^Patient Name^3
"KRN",.404,312,40,9,1)
.12
"KRN",.404,312,40,9,2)
11,19^30^11,5
"KRN",.404,312,40,10,0)
10^Dosage^3
"KRN",.404,312,40,10,1)
.39
"KRN",.404,312,40,10,2)
12,19^30^12,11
"KRN",.404,313,0)
PSBO MD^53.69
"KRN",.404,313,40,0)
^.4044I^5^5
"KRN",.404,313,40,1,0)
1^Start Date^3
"KRN",.404,313,40,1,1)
.16
"KRN",.404,313,40,1,2)
2,14^11^2,2
"KRN",.404,313,40,2,0)
2^At^3
"KRN",.404,313,40,2,1)
.17
"KRN",.404,313,40,2,2)
2,31^6^2,27
"KRN",.404,313,40,3,0)
3^Stop Date^3
"KRN",.404,313,40,3,1)
.18
"KRN",.404,313,40,3,2)
4,14^11^4,3
"KRN",.404,313,40,4,0)
4^At^3
"KRN",.404,313,40,4,1)
.19
"KRN",.404,313,40,4,2)
4,31^6^4,27
"KRN",.404,313,40,5,0)
5^Ward (Return for All)^3
"KRN",.404,313,40,5,1)
.13
"KRN",.404,313,40,5,2)
6,31^30^6,8
"KRN",.404,314,0)
PSBO DATES^53.69
"KRN",.404,314,40,0)
^.4044I^4^4
"KRN",.404,314,40,1,0)
1^Start Date^3
"KRN",.404,314,40,1,1)
.16
"KRN",.404,314,40,1,2)
2,14^11^2,2
"KRN",.404,314,40,2,0)
2^At^3
"KRN",.404,314,40,2,1)
.17
"KRN",.404,314,40,2,2)
2,31^6^2,27
"KRN",.404,314,40,3,0)
3^Stop Date^3
"KRN",.404,314,40,3,1)
.18
"KRN",.404,314,40,3,2)
2,50^11^2,39
"KRN",.404,314,40,4,0)
4^At^3
"KRN",.404,314,40,4,1)
.19
"KRN",.404,314,40,4,2)
2,67^6^2,63
"KRN",.404,315,0)
PSBO PT OR WARD^53.69
"KRN",.404,315,40,0)
^.4044I^4^4
"KRN",.404,315,40,1,0)
1^Run by Patient or Ward^3
"KRN",.404,315,40,1,1)
.11
"KRN",.404,315,40,1,2)
1,26^7^1,2
"KRN",.404,315,40,1,10)
S DDSBR=$S(X="P":2,1:3)
"KRN",.404,315,40,1,13)
D UNED^DDSUTL(2,,,X'="P"),UNED^DDSUTL(3,,,X'="W"),UNED^DDSUTL(4,,,X'="W") D:X="P" PUT^DDSVAL(53.69,.DA,.13,""),PUT^DDSVAL(53.69,.DA,.15,"") D:X="W" PUT^DDSVAL(53.69,.DA,.12,"")
"KRN",.404,315,40,2,0)
2^Patient Name^3
"KRN",.404,315,40,2,1)
.12
"KRN",.404,315,40,2,2)
2,26^30^2,12
"KRN",.404,315,40,2,12)
D REFRESH^DDSUTL
"KRN",.404,315,40,3,0)
3^Ward Location^3
"KRN",.404,315,40,3,1)
.13
"KRN",.404,315,40,3,2)
3,26^20^3,11
"KRN",.404,315,40,4,0)
4^Sort by Pt or Room-Bed^3
"KRN",.404,315,40,4,1)
.15
"KRN",.404,315,40,4,2)
3,72^8^3,48
"KRN",.404,316,0)
PSB PRN EFFECTIVENESS^53.79
"KRN",.404,316,40,0)
^.4044I^10^10
"KRN",.404,316,40,1,0)
1^Patient^3
"KRN",.404,316,40,1,1)
.01
"KRN",.404,316,40,1,2)
4,10^30^4,1
"KRN",.404,316,40,1,4)
^^^1
"KRN",.404,316,40,2,0)
2^Location^3
"KRN",.404,316,40,2,1)
.02
"KRN",.404,316,40,2,2)
5,11^20^5,1
"KRN",.404,316,40,2,4)
^^^1
"KRN",.404,316,40,3,0)
3^Division^3
"KRN",.404,316,40,3,1)
.03
"KRN",.404,316,40,3,2)
5,43^30^5,33
"KRN",.404,316,40,3,4)
^^^1
"KRN",.404,316,40,4,0)
4^Administration Date/Time^3
"KRN",.404,316,40,4,1)
.06
"KRN",.404,316,40,4,2)
8,27^20^8,1
"KRN",.404,316,40,4,4)
^^^1
"KRN",.404,316,40,5,0)
5^Administration By^3
"KRN",.404,316,40,5,1)
.07
"KRN",.404,316,40,5,2)
9,27^35^9,8
"KRN",.404,316,40,5,4)
^^^1
"KRN",.404,316,40,6,0)
6^PRN Reason^3
"KRN",.404,316,40,6,1)
.21
"KRN",.404,316,40,6,2)
12,2^78^11,1
"KRN",.404,316,40,6,4)
^^^1
"KRN",.404,316,40,7,0)
7^PRN Effectiveness^3
"KRN",.404,316,40,7,1)
.22
"KRN",.404,316,40,7,2)
15,2^78^14,1
"KRN",.404,316,40,8,0)
8^PRN Effectiveness Entry^1
"KRN",.404,316,40,8,2)
^^1,1
"KRN",.404,316,40,9,0)
9^!M^1
"KRN",.404,316,40,9,.1)
S Y=$TR($J("",IOM)," ","-")
"KRN",.404,316,40,9,2)
^^2,1
"KRN",.404,316,40,10,0)
10^Medication^3
"KRN",.404,316,40,10,1)
.08
"KRN",.404,316,40,10,2)
7,27^40^7,15
"KRN",.404,316,40,10,4)
^^^1
"KRN",.404,317,0)
PSB MED LOG EDIT^53.79
"KRN",.404,317,40,0)
^.4044I^13^13
"KRN",.404,317,40,1,0)
4^^3
"KRN",.404,317,40,1,1)
.01
"KRN",.404,317,40,1,2)
4,16^30
"KRN",.404,317,40,1,4)
0^^^1
"KRN",.404,317,40,2,0)
1^Medication Log Edit UD/PB^1
"KRN",.404,317,40,2,2)
^^1,1
"KRN",.404,317,40,3,0)
2^!M^1
"KRN",.404,317,40,3,.1)
S Y=$TR($J("",IOM)," ","-")
"KRN",.404,317,40,3,2)
^^2,1
"KRN",.404,317,40,4,0)
5^!M^1
"KRN",.404,317,40,4,.1)
S Y="SSN: "_$$GET1^DIQ(2,$P(^PSB(53.79,DA,0),U)_",",.09)
"KRN",.404,317,40,4,2)
^^4,47
"KRN",.404,317,40,5,0)
7^Admin Status^3
"KRN",.404,317,40,5,1)
.09
"KRN",.404,317,40,5,2)
7,18^7^7,2
"KRN",.404,317,40,5,14)
D VALID^PSBMLEN
"KRN",.404,317,40,6,0)
8^Admin Date/Time^3
"KRN",.404,317,40,6,1)
.06
"KRN",.404,317,40,6,2)
7,44^20^7,27
"KRN",.404,317,40,7,0)
10^PRN Reason^3
"KRN",.404,317,40,7,1)
.21
"KRN",.404,317,40,7,2)
10,22^58^10,2
"KRN",.404,317,40,8,0)
11^PRN Effectiveness^3
"KRN",.404,317,40,8,1)
.22
"KRN",.404,317,40,8,2)
11,22^58^11,2
"KRN",.404,317,40,9,0)
13^Comment (Required)^2
"KRN",.404,317,40,9,2)
16,2^78^15,2
"KRN",.404,317,40,9,4)
1
"KRN",.404,317,40,9,20)
F^^1:150
"KRN",.404,317,40,9,23)
D COMMENT^PSBML(DA,X)
"KRN",.404,317,40,10,0)
6^Medication^3
"KRN",.404,317,40,10,1)
.08
"KRN",.404,317,40,10,2)
5,16^40^5,2
"KRN",.404,317,40,10,4)
^^^1
"KRN",.404,317,40,11,0)
3^Patient:^1
"KRN",.404,317,40,11,2)
^^4,2
"KRN",.404,317,40,12,0)
9^Injection Site^3
"KRN",.404,317,40,12,1)
.16
"KRN",.404,317,40,12,2)
8,18^30^8,2
"KRN",.404,317,40,13,0)
12^Dispense Drugs...^2
"KRN",.404,317,40,13,2)
13,22^1^13,2^1
"KRN",.404,317,40,13,7)
^2
"KRN",.404,317,40,13,20)
F^^1:1
"KRN",.404,318,0)
PSB MED LOG EDIT DD HDR^53.79^
"KRN",.404,318,40,0)
^.4044I^3^3
"KRN",.404,318,40,1,0)
1^ Dispense Drugs ^1
"KRN",.404,318,40,1,2)
^^1,2
"KRN",.404,318,40,2,0)
2^Drug Name                        Order   Given  Units^1
"KRN",.404,318,40,2,2)
^^3,3
"KRN",.404,318,40,3,0)
3^Units   Units^1
"KRN",.404,318,40,3,2)
^^2,36
"KRN",.404,319,0)
PSB MED LOG EDIT DD^53.795
"KRN",.404,319,40,0)
^.4044I^4^4
"KRN",.404,319,40,1,0)
1^^3
"KRN",.404,319,40,1,1)
.01
"KRN",.404,319,40,1,2)
1,1^30
"KRN",.404,319,40,1,4)
^^^0
"KRN",.404,319,40,2,0)
2^^3
"KRN",.404,319,40,2,1)
.02
"KRN",.404,319,40,2,2)
1,33^6
"KRN",.404,319,40,2,4)
^^1^1
"KRN",.404,319,40,3,0)
3^^3
"KRN",.404,319,40,3,1)
.03
"KRN",.404,319,40,3,2)
1,41^6
"KRN",.404,319,40,3,4)
1^^1
"KRN",.404,319,40,4,0)
4^^3
"KRN",.404,319,40,4,1)
.04
"KRN",.404,319,40,4,2)
1,49^10
"KRN",.404,319,40,4,4)
1
"KRN",.404,320,0)
PSB NEW UD ENTRY^53.79
"KRN",.404,320,40,0)
^.4044I^13^13
"KRN",.404,320,40,1,0)
4^^3
"KRN",.404,320,40,1,1)
.01
"KRN",.404,320,40,1,2)
4,16^30
"KRN",.404,320,40,1,4)
0^^^1
"KRN",.404,320,40,2,0)
1^Medication Log Manual Entry - Unit Dose Order^1
"KRN",.404,320,40,2,2)
^^1,1
"KRN",.404,320,40,3,0)
2^!M^1
"KRN",.404,320,40,3,.1)
S Y=$TR($J("",IOM)," ","-")
"KRN",.404,320,40,3,2)
^^2,1
"KRN",.404,320,40,4,0)
5^!M^1
"KRN",.404,320,40,4,.1)
S Y="SSN: "_$$GET1^DIQ(2,$P(^PSB(53.79,DA,0),U)_",",.09)
"KRN",.404,320,40,4,2)
^^4,47
"KRN",.404,320,40,5,0)
7^Admin Status^3
"KRN",.404,320,40,5,1)
.09
"KRN",.404,320,40,5,2)
7,18^7^7,2
"KRN",.404,320,40,5,14)
D VALID^PSBMLEN
"KRN",.404,320,40,6,0)
8^Admin Date/Time^3
"KRN",.404,320,40,6,1)
.06
"KRN",.404,320,40,6,2)
7,44^20^7,27
"KRN",.404,320,40,6,4)
1^^^0
"KRN",.404,320,40,6,14)
D FDATE^PSBMLEN1
"KRN",.404,320,40,7,0)
10^PRN Reason^3
"KRN",.404,320,40,7,1)
.21
"KRN",.404,320,40,7,2)
10,22^58^10,2
"KRN",.404,320,40,8,0)
11^PRN Effectiveness^3
"KRN",.404,320,40,8,1)
.22
"KRN",.404,320,40,8,2)
11,22^58^11,2
"KRN",.404,320,40,9,0)
13^Comment (Required)^2
"KRN",.404,320,40,9,2)
16,2^78^15,2
"KRN",.404,320,40,9,4)
1
"KRN",.404,320,40,9,20)
F^^1:150
"KRN",.404,320,40,9,23)
D COMMENT^PSBML(DA,X)
"KRN",.404,320,40,10,0)
6^Medication^3
"KRN",.404,320,40,10,1)
.08
"KRN",.404,320,40,10,2)
5,16^40^5,2
"KRN",.404,320,40,10,4)
^^^1
"KRN",.404,320,40,11,0)
3^Patient:^1
"KRN",.404,320,40,11,2)
^^4,2
"KRN",.404,320,40,12,0)
9^Injection Site^3
"KRN",.404,320,40,12,1)
.16
"KRN",.404,320,40,12,2)
8,18^30^8,2
"KRN",.404,320,40,13,0)
12^Dispense Drugs...^2
"KRN",.404,320,40,13,2)
13,22^1^13,2^1
"KRN",.404,320,40,13,7)
^2
"KRN",.404,320,40,13,20)
F^^1:1
"KRN",.404,321,0)
PSB NEW UD ENTRY DD HDR^53.79^
"KRN",.404,321,40,0)
^.4044I^3^3
"KRN",.404,321,40,1,0)
1^ Dispense Drugs ^1
"KRN",.404,321,40,1,2)
^^1,2
"KRN",.404,321,40,2,0)
2^Drug Name                        Order   Given  Units^1
"KRN",.404,321,40,2,2)
^^3,3
"KRN",.404,321,40,3,0)
3^Units   Units^1
"KRN",.404,321,40,3,2)
^^2,36
"KRN",.404,322,0)
PSB NEW UD ENTRY DD^53.795
"KRN",.404,322,40,0)
^.4044I^4^4
"KRN",.404,322,40,1,0)
1^^3
"KRN",.404,322,40,1,1)
.01
"KRN",.404,322,40,1,2)
1,1^30
"KRN",.404,322,40,1,4)
^^^1
"KRN",.404,322,40,2,0)
2^^3
"KRN",.404,322,40,2,1)
.02
"KRN",.404,322,40,2,2)
1,33^6
"KRN",.404,322,40,2,4)
^^1^1
"KRN",.404,322,40,3,0)
3^^3
"KRN",.404,322,40,3,1)
.03
"KRN",.404,322,40,3,2)
1,41^6
"KRN",.404,322,40,3,4)
1^^1
"KRN",.404,322,40,4,0)
4^^3
"KRN",.404,322,40,4,1)
.04
"KRN",.404,322,40,4,2)
1,49^10
"KRN",.404,322,40,4,4)
1
"KRN",.404,323,0)
PSB NEW IV ENTRY^53.79
"KRN",.404,323,40,0)
^.4044I^13^13
"KRN",.404,323,40,1,0)
4^^3
"KRN",.404,323,40,1,1)
.01
"KRN",.404,323,40,1,2)
4,16^30
"KRN",.404,323,40,1,4)
0^^^1
"KRN",.404,323,40,2,0)
1^Medication Log Manual Entry - IV Order^1
"KRN",.404,323,40,2,2)
^^1,1
"KRN",.404,323,40,3,0)
2^!M^1
"KRN",.404,323,40,3,.1)
S Y=$TR($J("",IOM)," ","-")
"KRN",.404,323,40,3,2)
^^2,1
"KRN",.404,323,40,4,0)
5^!M^1
"KRN",.404,323,40,4,.1)
S Y="SSN: "_$$GET1^DIQ(2,$P(^PSB(53.79,DA,0),U)_",",.09)
"KRN",.404,323,40,4,2)
^^4,47
"KRN",.404,323,40,5,0)
7^Admin Status^3
"KRN",.404,323,40,5,1)
.09
"KRN",.404,323,40,5,2)
7,18^7^7,2
"KRN",.404,323,40,5,4)
^^^1
"KRN",.404,323,40,6,0)
8^Admin Date/Time^3
"KRN",.404,323,40,6,1)
.06
"KRN",.404,323,40,6,2)
7,44^20^7,27
"KRN",.404,323,40,6,4)
1
"KRN",.404,323,40,6,14)
D FDATE^PSBMLEN1
"KRN",.404,323,40,7,0)
10^PRN Reason^3
"KRN",.404,323,40,7,1)
.21
"KRN",.404,323,40,7,2)
10,22^58^10,2
"KRN",.404,323,40,8,0)
11^PRN Effectiveness^3
"KRN",.404,323,40,8,1)
.22
"KRN",.404,323,40,8,2)
11,22^58^11,2
"KRN",.404,323,40,9,0)
13^Comment (Required)^2
"KRN",.404,323,40,9,2)
16,2^78^15,2
"KRN",.404,323,40,9,4)
1
"KRN",.404,323,40,9,20)
F^^1:150
"KRN",.404,323,40,9,23)
D COMMENT^PSBML(DA,X)
"KRN",.404,323,40,10,0)
6^Medication^3
"KRN",.404,323,40,10,1)
.08
"KRN",.404,323,40,10,2)
5,16^40^5,2
"KRN",.404,323,40,10,4)
^^^1
"KRN",.404,323,40,11,0)
3^Patient:^1
"KRN",.404,323,40,11,2)
^^4,2
"KRN",.404,323,40,12,0)
9^Injection Site^3
"KRN",.404,323,40,12,1)
.16
"KRN",.404,323,40,12,2)
8,18^30^8,2
"KRN",.404,323,40,13,0)
12^Additives...^2
"KRN",.404,323,40,13,2)
13,17^1^13,2^1
"KRN",.404,323,40,13,7)
^2
"KRN",.404,323,40,13,20)
F^^1:1
"KRN",.404,324,0)
PSB NEW IV ENTRY ADD HDR^53.79^
"KRN",.404,324,40,0)
^.4044I^3^3
"KRN",.404,324,40,1,0)
1^ Additives ^1
"KRN",.404,324,40,1,2)
^^1,2
"KRN",.404,324,40,2,0)
2^Additives                        Order   Given  Units^1
"KRN",.404,324,40,2,2)
^^3,3
"KRN",.404,324,40,3,0)
3^Units   Units^1
"KRN",.404,324,40,3,2)
^^2,36
"KRN",.404,325,0)
PSB NEW IV ENTRY ADD^53.796
"KRN",.404,325,40,0)
^.4044I^4^4
"KRN",.404,325,40,1,0)
1^^3
"KRN",.404,325,40,1,1)
.01
"KRN",.404,325,40,1,2)
1,1^30
"KRN",.404,325,40,1,4)
^^^1
"KRN",.404,325,40,2,0)
2^^3
"KRN",.404,325,40,2,1)
.02
"KRN",.404,325,40,2,2)
1,33^6
"KRN",.404,325,40,2,4)
^^1^1
"KRN",.404,325,40,3,0)
3^^3
"KRN",.404,325,40,3,1)
.03
"KRN",.404,325,40,3,2)
1,41^6
"KRN",.404,325,40,3,4)
1^^1
"KRN",.404,325,40,4,0)
4^^3
"KRN",.404,325,40,4,1)
.04
"KRN",.404,325,40,4,2)
1,49^10
"KRN",.404,325,40,4,4)
1
"KRN",.404,326,0)
PSBO ML^53.69
"KRN",.404,326,40,0)
^.4044I^2^2
"KRN",.404,326,40,1,0)
1^Include Comments^3
"KRN",.404,326,40,1,1)
.28
"KRN",.404,326,40,1,2)
1,66^3^1,48
"KRN",.404,326,40,2,0)
2^Include Audits^3
"KRN",.404,326,40,2,1)
.29
"KRN",.404,326,40,2,2)
2,66^3^2,48
"KRN",.404,327,0)
PSBO DATE DL^53.69
"KRN",.404,327,40,0)
^.4044I^4^3
"KRN",.404,327,40,1,0)
1^Start Date^3
"KRN",.404,327,40,1,1)
.16
"KRN",.404,327,40,1,2)
2,14^11^2,2
"KRN",.404,327,40,2,0)
2^Start Time^3
"KRN",.404,327,40,2,1)
.17
"KRN",.404,327,40,2,2)
2,39^6^2,27
"KRN",.404,327,40,4,0)
4^Stop Time^3
"KRN",.404,327,40,4,1)
.19
"KRN",.404,327,40,4,2)
2,57^6^2,46
"KRN",.404,364,0)
PSB MED LOG EDIT IV^53.79
"KRN",.404,364,40,0)
^.4044I^14^14
"KRN",.404,364,40,1,0)
4^^3
"KRN",.404,364,40,1,1)
.01
"KRN",.404,364,40,1,2)
4,16^30
"KRN",.404,364,40,1,4)
0^^^1
"KRN",.404,364,40,2,0)
1^Medication Log Edit IV^1
"KRN",.404,364,40,2,2)
^^1,1
"KRN",.404,364,40,3,0)
2^!M^1
"KRN",.404,364,40,3,.1)
S Y=$TR($J("",IOM)," ","-")
"KRN",.404,364,40,3,2)
^^2,1
"KRN",.404,364,40,4,0)
5^!M^1
"KRN",.404,364,40,4,.1)
S Y="SSN: "_$$GET1^DIQ(2,$P(^PSB(53.79,DA,0),U)_",",.09)
"KRN",.404,364,40,4,2)
^^4,47
"KRN",.404,364,40,5,0)
7^Admin Status^3
"KRN",.404,364,40,5,1)
.09
"KRN",.404,364,40,5,2)
7,18^7^7,2
"KRN",.404,364,40,5,14)
I "^I^S^C^H^R^"'[("^"_X_"^") W $C(7) S DDSERROR=1 D HLP^DDSUTL("Allowed status codes are Infusing, Stopped, Completed, Held, and Refused.")
"KRN",.404,364,40,6,0)
8^Admin Date/Time^3
"KRN",.404,364,40,6,1)
.06
"KRN",.404,364,40,6,2)
7,44^20^7,27
"KRN",.404,364,40,7,0)
10^PRN Reason^3
"KRN",.404,364,40,7,1)
.21
"KRN",.404,364,40,7,2)
10,22^58^10,2
"KRN",.404,364,40,8,0)
11^PRN Effectiveness^3
"KRN",.404,364,40,8,1)
.22
"KRN",.404,364,40,8,2)
11,22^58^11,2
"KRN",.404,364,40,9,0)
13^Comment (Required)^2
"KRN",.404,364,40,9,2)
16,2^78^15,2
"KRN",.404,364,40,9,4)
1
"KRN",.404,364,40,9,20)
F^^1:150
"KRN",.404,364,40,9,23)
D COMMENT^PSBML(DA,X)
"KRN",.404,364,40,10,0)
6^Medication^3
"KRN",.404,364,40,10,1)
.08
"KRN",.404,364,40,10,2)
5,16^40^5,2
"KRN",.404,364,40,10,4)
^^^1
"KRN",.404,364,40,11,0)
3^Patient:^1
"KRN",.404,364,40,11,2)
^^4,2
"KRN",.404,364,40,12,0)
9^Injection Site^3
"KRN",.404,364,40,12,1)
.16
"KRN",.404,364,40,12,2)
8,18^30^8,2
"KRN",.404,364,40,13,0)
12^Dispense Drugs...^2
"KRN",.404,364,40,13,2)
13,22^1^13,2^1
"KRN",.404,364,40,13,7)
^2
"KRN",.404,364,40,13,20)
F^^1:1
"KRN",.404,364,40,14,0)
14^!M^1
"KRN",.404,364,40,14,.1)
S Y="Bag ID: "_$$GET1^DIQ(53.79,DA_",",.26)
"KRN",.404,364,40,14,2)
^^5,59
"KRN",.404,365,0)
PSB MED LOG EDIT IV HDR^53.79^
"KRN",.404,365,40,0)
^.4044I^3^3
"KRN",.404,365,40,1,0)
1^ Dispense Drugs ^1
"KRN",.404,365,40,1,2)
^^1,2
"KRN",.404,365,40,2,0)
2^Drug Name                        Order   Given  Units^1
"KRN",.404,365,40,2,2)
^^3,3
"KRN",.404,365,40,3,0)
3^Units   Units^1
"KRN",.404,365,40,3,2)
^^2,36
"KRN",.404,366,0)
PSB MED LOG EDIT DD IV^53.795
"KRN",.404,366,40,0)
^.4044I^4^4
"KRN",.404,366,40,1,0)
1^^3
"KRN",.404,366,40,1,1)
.01
"KRN",.404,366,40,1,2)
1,1^30
"KRN",.404,366,40,1,4)
^^^0
"KRN",.404,366,40,2,0)
2^^3
"KRN",.404,366,40,2,1)
.02
"KRN",.404,366,40,2,2)
1,33^6
"KRN",.404,366,40,2,4)
^^1^1
"KRN",.404,366,40,3,0)
3^^3
"KRN",.404,366,40,3,1)
.03
"KRN",.404,366,40,3,2)
1,41^6
"KRN",.404,366,40,3,4)
1^^1
"KRN",.404,366,40,4,0)
4^^3
"KRN",.404,366,40,4,1)
.04
"KRN",.404,366,40,4,2)
1,49^10
"KRN",.404,366,40,4,4)
1
"KRN",19,11585,-1)
0^19
"KRN",19,11585,0)
PSB GUI CONTEXT - USER^BCMA Client Context^^B^^^^^^^^
"KRN",19,11585,99)
58863,41997
"KRN",19,11585,99.1)
59449,53915
"KRN",19,11585,"RPC",0)
^19.05P^48^48
"KRN",19,11585,"RPC",2,0)
PSB FMDATE
"KRN",19,11585,"RPC",4,0)
PSB GETPRNS
"KRN",19,11585,"RPC",5,0)
PSB INSTRUCTOR
"KRN",19,11585,"RPC",7,0)
PSB MEDICATION HISTORY
"KRN",19,11585,"RPC",8,0)
PSB PARAMETER
"KRN",19,11585,"RPC",12,0)
PSB SCANMED
"KRN",19,11585,"RPC",13,0)
PSB SCANPT
"KRN",19,11585,"RPC",14,0)
PSB SERVER CLOCK VARIANCE
"KRN",19,11585,"RPC",15,0)
PSB SUBMIT MISSING DOSE
"KRN",19,11585,"RPC",16,0)
PSB TRANSACTION
"KRN",19,11585,"RPC",17,0)
PSB USERLOAD
"KRN",19,11585,"RPC",18,0)
PSB USERSAVE
"KRN",19,11585,"RPC",19,0)
PSB VALIDATE ESIG
"KRN",19,11585,"RPC",20,0)
PSB VALIDATE ORDER
"KRN",19,11585,"RPC",21,0)
PSB CHECK SERVER
"KRN",19,11585,"RPC",23,0)
DG SENSITIVE RECORD BULLETIN
"KRN",19,11585,"RPC",24,0)
DG SENSITIVE RECORD ACCESS
"KRN",19,11585,"RPC",26,0)
PSB GETORDERTAB
"KRN",19,11585,"RPC",27,0)
PSB GETIVPAR
"KRN",19,11585,"RPC",28,0)
PSB PUTIVPAR
"KRN",19,11585,"RPC",29,0)
PSB DEVICE
"KRN",19,11585,"RPC",30,0)
PSB IV ORDER HISTORY
"KRN",19,11585,"RPC",31,0)
PSB BAG DETAIL
"KRN",19,11585,"RPC",32,0)
PSB WARDLIST
"KRN",19,11585,"RPC",33,0)
PSB MAIL
"KRN",19,11585,"RPC",34,0)
PSB ALLERGY
"KRN",19,11585,"RPC",35,0)
PSB GETPROVIDER
"KRN",19,11585,"RPC",36,0)
PSB REPORT
"KRN",19,11585,"RPC",37,0)
PSB MOB DRUG LIST
"KRN",19,11585,"RPC",38,0)
PSB MAXDAYS
"KRN",19,11585,"RPC",39,0)
PSB NURS WARDLIST
"KRN",19,11585,"RPC",40,0)
PSB CPRS ORDER
"KRN",19,11585,"RPC",41,0)
ORWUBCMA USERINFO
"KRN",19,11585,"RPC",43,0)
ORBCMA5 GETUDID
"KRN",19,11585,"RPC",44,0)
ORBCMA5 GETIVID
"KRN",19,11585,"RPC",45,0)
PSB VERSION CHECK
"KRN",19,11585,"RPC",46,0)
PSB CHECK IV
"KRN",19,11585,"RPC",47,0)
PSB VITALS
"KRN",19,11585,"RPC",48,0)
PSB VITAL MEAS FILE
"KRN",19,11585,"U")
BCMA CLIENT CONTEXT
"KRN",19,11586,-1)
0^33
"KRN",19,11586,0)
PSBO^Reports^^M^^^^^^^^BAR CODE MED ADMIN
"KRN",19,11586,10,0)
^19.01IP^7^7
"KRN",19,11586,10,1,0)
11587^DL
"KRN",19,11586,10,1,"^")
PSBO DL
"KRN",19,11586,10,2,0)
11588^MH
"KRN",19,11586,10,2,"^")
PSBO MH
"KRN",19,11586,10,3,0)
11589^ML
"KRN",19,11586,10,3,"^")
PSBO ML
"KRN",19,11586,10,4,0)
11590^MM
"KRN",19,11586,10,4,"^")
PSBO MM
"KRN",19,11586,10,5,0)
11591^PE
"KRN",19,11586,10,5,"^")
PSBO PE
"KRN",19,11586,10,6,0)
11592^WA
"KRN",19,11586,10,6,"^")
PSBO WA
"KRN",19,11586,10,7,0)
11596^MV
"KRN",19,11586,10,7,"^")
PSBO MV
"KRN",19,11586,99)
59569,46477
"KRN",19,11586,"U")
REPORTS
"KRN",19,11587,-1)
0^35
"KRN",19,11587,0)
PSBO DL^Due List^^R^^^^^^^^BAR CODE MED ADMIN
"KRN",19,11587,25)
XQ^PSBO("DL")
"KRN",19,11587,"U")
DUE LIST
"KRN",19,11588,-1)
0^37
"KRN",19,11588,0)
PSBO MH^Medication Administration History (MAH)^^R^^^^^^^^BAR CODE MED ADMIN
"KRN",19,11588,25)
XQ^PSBO("MH")
"KRN",19,11588,"U")
MEDICATION ADMINISTRATION HIST
"KRN",19,11589,-1)
0^38
"KRN",19,11589,0)
PSBO ML^Medication Administration Log^^R^^^^^^^^BAR CODE MED ADMIN
"KRN",19,11589,25)
XQ^PSBO("ML")
"KRN",19,11589,"U")
MEDICATION ADMINISTRATION LOG
"KRN",19,11590,-1)
0^39
"KRN",19,11590,0)
PSBO MM^Missed Medications^^R^^^^^^^^BAR CODE MED ADMIN
"KRN",19,11590,25)
XQ^PSBO("MM")
"KRN",19,11590,"U")
MISSED MEDICATIONS
"KRN",19,11591,-1)
0^41
"KRN",19,11591,0)
PSBO PE^PRN Effectiveness List^^R^^^^^^^^BAR CODE MED ADMIN
"KRN",19,11591,25)
XQ^PSBO("PE")
"KRN",19,11591,"U")
PRN EFFECTIVENESS LIST
"KRN",19,11592,-1)
0^42
"KRN",19,11592,0)
PSBO WA^Ward Administration Times^^R^^^^^^^^BAR CODE MED ADMIN
"KRN",19,11592,25)
XQ^PSBO("WA")
"KRN",19,11592,"U")
WARD ADMINISTRATION TIMES
"KRN",19,11593,-1)
0^31
"KRN",19,11593,0)
PSB USER^Bar Code Medication Administration^^M^^^^^^^^BAR CODE MED ADMIN
"KRN",19,11593,10,0)
^19.01IP^5^5
"KRN",19,11593,10,1,0)
11586
"KRN",19,11593,10,1,"^")
PSBO
"KRN",19,11593,10,2,0)
11594
"KRN",19,11593,10,2,"^")
PSB MISSING DOSE REQUEST
"KRN",19,11593,10,3,0)
11599
"KRN",19,11593,10,3,"^")
PSB MED LOG EDIT
"KRN",19,11593,10,4,0)
11600
"KRN",19,11593,10,4,"^")
PSB MED LOG PRN EFFECT
"KRN",19,11593,10,5,0)
11601
"KRN",19,11593,10,5,"^")
PSB MED LOG NEW ENTRY
"KRN",19,11593,99)
59569,46477
"KRN",19,11593,"U")
BAR CODE MEDICATION ADMINISTRA
"KRN",19,11594,-1)
0^26
"KRN",19,11594,0)
PSB MISSING DOSE REQUEST^Missing Dose Request^^R^^^^^^^^BAR CODE MED ADMIN
"KRN",19,11594,25)
XQ^PSBMD
"KRN",19,11594,"U")
MISSING DOSE REQUEST
"KRN",19,11595,-1)
0^25
"KRN",19,11595,0)
PSB MISSING DOSE FOLLOWUP^Missing Dose Followup^^R^^^^^^^^BAR CODE MED ADMIN
"KRN",19,11595,25)
FLWUP^PSBMD
"KRN",19,11595,"U")
MISSING DOSE FOLLOWUP
"KRN",19,11596,-1)
0^40
"KRN",19,11596,0)
PSBO MV^Medication Variance Log^^R^^PSB MANAGER^^^^^^BAR CODE MED ADMIN
"KRN",19,11596,25)
XQ^PSBO("MV")
"KRN",19,11596,"U")
MEDICATION VARIANCE LOG
"KRN",19,11597,-1)
0^24
"KRN",19,11597,0)
PSB MGR^Bar Code Medication Administration Manager^^M^^PSB MANAGER^^^^^^BAR CODE MED ADMIN
"KRN",19,11597,10,0)
^19.01IP^8^7
"KRN",19,11597,10,1,0)
11603^
"KRN",19,11597,10,1,"^")
PSB NURSE
"KRN",19,11597,10,2,0)
11598
"KRN",19,11597,10,2,"^")
PSB DRUG INQUIRY
"KRN",19,11597,10,3,0)
11595
"KRN",19,11597,10,3,"^")
PSB MISSING DOSE FOLLOWUP
"KRN",19,11597,10,4,0)
11602
"KRN",19,11597,10,4,"^")
PSB USER PARAM RESET
"KRN",19,11597,10,5,0)
11604
"KRN",19,11597,10,5,"^")
PSB PHARMACY
"KRN",19,11597,10,6,0)
11607
"KRN",19,11597,10,6,"^")
PSB MED LOG TROUBLE SHOOTER
"KRN",19,11597,10,8,0)
12307
"KRN",19,11597,10,8,"^")
PSB PRN DOCUMENTING
"KRN",19,11597,99)
59569,46478
"KRN",19,11597,99.1)
59570,52713
"KRN",19,11597,"U")
BAR CODE MEDICATION ADMINISTRA
"KRN",19,11598,-1)
0^18
"KRN",19,11598,0)
PSB DRUG INQUIRY^Drug File Inquiry^^R^^^^^^^^BAR CODE MED ADMIN
"KRN",19,11598,25)
DRUGINQ^PSBUTL
"KRN",19,11598,"U")
DRUG FILE INQUIRY
"KRN",19,11599,-1)
0^20
"KRN",19,11599,0)
PSB MED LOG EDIT^Edit Medication Log^^R^^^^^^^^BAR CODE MED ADMIN
"KRN",19,11599,25)
EDIT^PSBMLEN
"KRN",19,11599,"U")
EDIT MEDICATION LOG
"KRN",19,11600,-1)
0^22
"KRN",19,11600,0)
PSB MED LOG PRN EFFECT^Enter PRN Effectiveness^^R^^^^^^^^BAR CODE MED ADMIN
"KRN",19,11600,25)
EDIT^PSBPRN
"KRN",19,11600,"U")
ENTER PRN EFFECTIVENESS
"KRN",19,11601,-1)
0^21
"KRN",19,11601,0)
PSB MED LOG NEW ENTRY^Manual Medication Entry^^R^^^^^^^^BAR CODE MED ADMIN
"KRN",19,11601,25)
EN^PSBMLEN
"KRN",19,11601,"U")
MANUAL MEDICATION ENTRY
"KRN",19,11602,-1)
0^32
"KRN",19,11602,0)
PSB USER PARAM RESET^Reset User Parameters^^R^^^^^^^^BAR CODE MED ADMIN
"KRN",19,11602,25)
RSTUSR^PSBPAR
"KRN",19,11602,99.1)
57803,42810
"KRN",19,11602,"U")
RESET USER PARAMETERS
"KRN",19,11603,-1)
0^27
"KRN",19,11603,0)
PSB NURSE^Medication Administration Menu Nursing^^M^^^^^^^^BAR CODE MED ADMIN
"KRN",19,11603,10,0)
^19.01IP^13^13
"KRN",19,11603,10,2,0)
11594^10
"KRN",19,11603,10,2,"^")
PSB MISSING DOSE REQUEST
"KRN",19,11603,10,3,0)
11599^3
"KRN",19,11603,10,3,"^")
PSB MED LOG EDIT
"KRN",19,11603,10,4,0)
11600^7
"KRN",19,11603,10,4,"^")
PSB MED LOG PRN EFFECT
"KRN",19,11603,10,5,0)
11601^8
"KRN",19,11603,10,5,"^")
PSB MED LOG NEW ENTRY
"KRN",19,11603,10,6,0)
11589^1
"KRN",19,11603,10,6,"^")
PSBO ML
"KRN",19,11603,10,7,0)
11590^2
"KRN",19,11603,10,7,"^")
PSBO MM
"KRN",19,11603,10,8,0)
11592^4
"KRN",19,11603,10,8,"^")
PSBO WA
"KRN",19,11603,10,9,0)
11587^5
"KRN",19,11603,10,9,"^")
PSBO DL
"KRN",19,11603,10,10,0)
11591^6
"KRN",19,11603,10,10,"^")
PSBO PE
"KRN",19,11603,10,11,0)
11588^9
"KRN",19,11603,10,11,"^")
PSBO MH
"KRN",19,11603,10,12,0)
11596^11
"KRN",19,11603,10,12,"^")
PSBO MV
"KRN",19,11603,10,13,0)
11598^12
"KRN",19,11603,10,13,"^")
PSB DRUG INQUIRY
"KRN",19,11603,99)
59569,46477
"KRN",19,11603,99.1)
59570,52713
"KRN",19,11603,"U")
MEDICATION ADMINISTRATION MENU
"KRN",19,11604,-1)
0^28
"KRN",19,11604,0)
PSB PHARMACY^Medication Administration Menu Pharmacy^^M^^^^^^^^BAR CODE MED ADMIN
"KRN",19,11604,10,0)
^19.01IP^9^9
"KRN",19,11604,10,1,0)
11589^1
"KRN",19,11604,10,1,"^")
PSBO ML
"KRN",19,11604,10,2,0)
11590^2
"KRN",19,11604,10,2,"^")
PSBO MM
"KRN",19,11604,10,3,0)
11587^3
"KRN",19,11604,10,3,"^")
PSBO DL
"KRN",19,11604,10,4,0)
11588^4
"KRN",19,11604,10,4,"^")
PSBO MH
"KRN",19,11604,10,5,0)
11594^5
"KRN",19,11604,10,5,"^")
PSB MISSING DOSE REQUEST
"KRN",19,11604,10,6,0)
11595^6
"KRN",19,11604,10,6,"^")
PSB MISSING DOSE FOLLOWUP
"KRN",19,11604,10,7,0)
11605^7
"KRN",19,11604,10,7,"^")
PSBO MD
"KRN",19,11604,10,8,0)
11606^8
"KRN",19,11604,10,8,"^")
PSBO BL
"KRN",19,11604,10,9,0)
11598^9
"KRN",19,11604,10,9,"^")
PSB DRUG INQUIRY
"KRN",19,11604,99)
59569,46477
"KRN",19,11604,99.1)
57805,49014
"KRN",19,11604,"U")
MEDICATION ADMINISTRATION MENU
"KRN",19,11605,-1)
0^36
"KRN",19,11605,0)
PSBO MD^Missing Dose Report^^R^^^^^^^^BAR CODE MED ADMIN
"KRN",19,11605,25)
XQ^PSBO("MD")
"KRN",19,11605,"U")
MISSING DOSE REPORT
"KRN",19,11606,-1)
0^34
"KRN",19,11606,0)
PSBO BL^Label Print^^R^^^^^^^^BAR CODE MED ADMIN
"KRN",19,11606,25)
XQ^PSBO("BL")
"KRN",19,11606,"U")
LABEL PRINT
"KRN",19,11607,-1)
0^23
"KRN",19,11607,0)
PSB MED LOG TROUBLE SHOOTER^Trouble Shoot Med Log^^R^^^^^^^^BAR CODE MED ADMIN
"KRN",19,11607,25)
EN^PSBMLTS
"KRN",19,11607,"U")
TROUBLE SHOOT MED LOG
"KRN",19,11609,-1)
0^30
"KRN",19,11609,0)
PSB SAGG MONTHLY REPORT^Monthly SAGG Report^^R^^^^^^^^BAR CODE MED ADMIN
"KRN",19,11609,25)
EN^PSBSAGG
"KRN",19,11609,"U")
MONTHLY SAGG REPORT
"KRN",19,12235,-1)
0^5
"KRN",19,12235,0)
PSB BCBU LINK ASSOCIATIONS^Associate Backup Workstations with a Division^^R^^^^^^^^BAR CODE MED ADMIN
"KRN",19,12235,1,0)
^19.06^8^8^3030808^^
"KRN",19,12235,1,1,0)
For sites running the REALTIME BCMA BACKUP interface, use this option to 
"KRN",19,12235,1,2,0)
assign your backup workstations to specific divisions. If you are not a 
"KRN",19,12235,1,3,0)
multidivisional site, associate all backup workstations with a single 
"KRN",19,12235,1,4,0)
division.
"KRN",19,12235,1,5,0)
 
"KRN",19,12235,1,6,0)
When HL7 events occur, the division associated with the patient will be 
"KRN",19,12235,1,7,0)
used to determine which workstations will get the message.
"KRN",19,12235,1,8,0)
(Vista Menu)
"KRN",19,12235,25)
ALPBPARM
"KRN",19,12235,"U")
ASSOCIATE BACKUP WORKSTATIONS 
"KRN",19,12236,-1)
0^16
"KRN",19,12236,0)
PSB BCBU WARD LIST^List of Wards in BCMA Backup File^^R^^^^^^^^BAR CODE MED ADMIN
"KRN",19,12236,1,0)
^19.06^2^2^3030808^^^^
"KRN",19,12236,1,1,0)
This option will display all the wards available on the workstation.
"KRN",19,12236,1,2,0)
(Workstation Menu)
"KRN",19,12236,25)
WARDLIST^ALPBUTL("C")
"KRN",19,12236,"U")
LIST OF WARDS IN BCMA BACKUP F
"KRN",19,12237,-1)
0^17
"KRN",19,12237,0)
PSB BCBU WRKSTN MAIN^BCMA Backup System (Wrkstn)^^M^^^^^^^^BAR CODE MED ADMIN^^1
"KRN",19,12237,1,0)
^19.06^2^2^3030808^^^^
"KRN",19,12237,1,1,0)
This is the main menu for the BCMA Backup system -- the ward workstation
"KRN",19,12237,1,2,0)
containing the BCMA backup/contingency data. (Workstation Menu)
"KRN",19,12237,10,0)
^19.01IP^8^8
"KRN",19,12237,10,1,0)
12241^SO^1
"KRN",19,12237,10,1,"^")
PSB BCBU SHOW PATIENT
"KRN",19,12237,10,3,0)
12238^PA^2
"KRN",19,12237,10,3,"^")
PSB BCBU PRINT MAR ALL
"KRN",19,12237,10,4,0)
12240^PP^3
"KRN",19,12237,10,4,"^")
PSB BCBU PRINT MAR PATIENT
"KRN",19,12237,10,5,0)
12239^PW^4
"KRN",19,12237,10,5,"^")
PSB BCBU PRINT MAR WARD
"KRN",19,12237,10,6,0)
12243^MM^7
"KRN",19,12237,10,6,"^")
PSB BCBU MANAGEMENT MENU
"KRN",19,12237,10,7,0)
12236^WL^6
"KRN",19,12237,10,7,"^")
PSB BCBU WARD LIST
"KRN",19,12237,10,8,0)
12308^BL^5
"KRN",19,12237,10,8,"^")
PSB BCBU PRINT BLK MAR
"KRN",19,12237,20)
S X="ALPBUTL" X ^%ZOSF("TEST") I $T D STATUS^ALPBUTL
"KRN",19,12237,99)
59569,46478
"KRN",19,12237,"U")
BCMA BACKUP SYSTEM (WRKSTN)
"KRN",19,12238,-1)
0^9
"KRN",19,12238,0)
PSB BCBU PRINT MAR ALL^Print MAR for All Wards^^R^^^^^^^^BAR CODE MED ADMIN
"KRN",19,12238,1,0)
^19.06^2^2^3030808^^
"KRN",19,12238,1,1,0)
This option prints a MAR report for all wards.
"KRN",19,12238,1,2,0)
(Workstation Menu)
"KRN",19,12238,25)
ALPBPALL
"KRN",19,12238,"U")
PRINT MAR FOR ALL WARDS
"KRN",19,12239,-1)
0^11
"KRN",19,12239,0)
PSB BCBU PRINT MAR WARD^Print MAR for Selected Ward^^R^^^^^^^^BAR CODE MED ADMIN
"KRN",19,12239,1,0)
^19.06^2^2^3030808^^
"KRN",19,12239,1,1,0)
This option prints a MAR report by individual wards.          
"KRN",19,12239,1,2,0)
(Workstation Menu)
"KRN",19,12239,25)
ALPBPWRD
"KRN",19,12239,"U")
PRINT MAR FOR SELECTED WARD
"KRN",19,12240,-1)
0^10
"KRN",19,12240,0)
PSB BCBU PRINT MAR PATIENT^Print MAR for Selected Patient^^R^^^^^^^^BAR CODE MED ADMIN
"KRN",19,12240,1,0)
^19.06^2^2^3030808^^
"KRN",19,12240,1,1,0)
This option prints a MAR report by individual patients.
"KRN",19,12240,1,2,0)
(Workstation Menu)
"KRN",19,12240,25)
ALPBPPAT
"KRN",19,12240,"U")
PRINT MAR FOR SELECTED PATIENT
"KRN",19,12241,-1)
0^12
"KRN",19,12241,0)
PSB BCBU SHOW PATIENT^List/Display Orders^^R^^^^^^^^BAR CODE MED ADMIN
"KRN",19,12241,1,0)
^19.06^2^2^3030808^^
"KRN",19,12241,1,1,0)
This option will display orders to the screen by individual patient or
"KRN",19,12241,1,2,0)
ward. (Workstation Menu)
"KRN",19,12241,25)
ALPBSPAT
"KRN",19,12241,"U")
LIST/DISPLAY ORDERS
"KRN",19,12242,-1)
0^13
"KRN",19,12242,0)
PSB BCBU SHOW WARD^Display Orders for Selected Ward^^R^^^^^^^^BAR CODE MED ADMIN
"KRN",19,12242,1,0)
^19.06^2^2^3030808^^
"KRN",19,12242,1,1,0)
 This option will display orders to the screen by Ward.
"KRN",19,12242,1,2,0)
(Workstation Menu)
"KRN",19,12242,25)
ALPBSWRD
"KRN",19,12242,"U")
DISPLAY ORDERS FOR SELECTED WA
"KRN",19,12243,-1)
0^6
"KRN",19,12243,0)
PSB BCBU MANAGEMENT MENU^BCMA Backup System Management Menu^^M^^PSB BUMGR^^^^^^BAR CODE MED ADMIN
"KRN",19,12243,1,0)
^19.06^2^2^3030808^^^
"KRN",19,12243,1,1,0)
This Menu contains all Management options for the BCMA Contingency 
"KRN",19,12243,1,2,0)
(Workstation Menu)
"KRN",19,12243,10,0)
^19.01IP^1^1
"KRN",19,12243,10,1,0)
12244^EL
"KRN",19,12243,10,1,"^")
PSB BCBU ERROR LOG
"KRN",19,12243,99)
59569,46478
"KRN",19,12243,"U")
BCMA BACKUP SYSTEM MANAGEMENT 
"KRN",19,12244,-1)
0^1
"KRN",19,12244,0)
PSB BCBU ERROR LOG^BCMA Backup System Error Log^^R^^^^^^^^BAR CODE MED ADMIN
"KRN",19,12244,1,0)
^19.06^1^1^3030808^^
"KRN",19,12244,1,1,0)
This option is used to view the Error Log. (Workstation Menu)
"KRN",19,12244,25)
ALPBELOG
"KRN",19,12244,"U")
BCMA BACKUP SYSTEM ERROR LOG
"KRN",19,12245,-1)
0^14
"KRN",19,12245,0)
PSB BCBU USER INIT^Initialize a Backup Workstation with BCMA Users^^R^^^^^^^^BAR CODE MED ADMIN
"KRN",19,12245,1,0)
^19.06^4^4^3030808^^
"KRN",19,12245,1,1,0)
This option searches the VISTA New Person file for authorized BCMA users 
"KRN",19,12245,1,2,0)
and generates a version 2.4 HL7 message. Messages are addressed 
"KRN",19,12245,1,3,0)
dynamically based on the parameter definitions for BCMA Backup using 
"KRN",19,12245,1,4,0)
divisions or the default group.
"KRN",19,12245,25)
INIT^ALPBGEN2
"KRN",19,12245,"U")
INITIALIZE A BACKUP WORKSTATIO
"KRN",19,12246,-1)
0^3
"KRN",19,12246,0)
PSB BCBU INIT WRKSTN DFT^Default Workstation Initialize^^R^^^^^^^^BAR CODE MED ADMIN
"KRN",19,12246,1,0)
^19.06^2^2^3030808^^
"KRN",19,12246,1,1,0)
This option is used to initialize Workstations that are linked as default.  
"KRN",19,12246,1,2,0)
(Vista Option)
"KRN",19,12246,25)
OPT^ALPBIND
"KRN",19,12246,"U")
DEFAULT WORKSTATION INITIALIZE
"KRN",19,12247,-1)
0^4
"KRN",19,12247,0)
PSB BCBU INIT WRKSTN DIV^Divisional Workstation Initialize^^R^^^^^^^^BAR CODE MED ADMIN
"KRN",19,12247,1,0)
^19.06^2^2^3030808^^
"KRN",19,12247,1,1,0)
This option is used to initialize Workstations that are linked by
"KRN",19,12247,1,2,0)
Division.  (Vista Option)
"KRN",19,12247,25)
OPT^ALPBIN
"KRN",19,12247,"U")
DIVISIONAL WORKSTATION INITIAL
"KRN",19,12248,-1)
0^15
"KRN",19,12248,0)
PSB BCBU VISTA MAIN^BCMA Backup System (Vista)^^M^^PSB BUMGR^^^^^^BAR CODE MED ADMIN
"KRN",19,12248,1,0)
^19.06^2^2^3030808^^^^
"KRN",19,12248,1,1,0)
This is the Primary Menu for the BCMA Backup Contingency.
"KRN",19,12248,1,2,0)
(Vista Menu)
"KRN",19,12248,10,0)
^19.01IP^5^5
"KRN",19,12248,10,1,0)
12246^DFT^2
"KRN",19,12248,10,1,"^")
PSB BCBU INIT WRKSTN DFT
"KRN",19,12248,10,2,0)
12247^DIV^3
"KRN",19,12248,10,2,"^")
PSB BCBU INIT WRKSTN DIV
"KRN",19,12248,10,3,0)
12235^LNK^1
"KRN",19,12248,10,3,"^")
PSB BCBU LINK ASSOCIATIONS
"KRN",19,12248,10,4,0)
12245^USR^4
"KRN",19,12248,10,4,"^")
PSB BCBU USER INIT
"KRN",19,12248,10,5,0)
12249^PAT
"KRN",19,12248,10,5,"^")
PSB BCBU INIT SINGLE PT
"KRN",19,12248,99)
59569,46478
"KRN",19,12248,"U")
BCMA BACKUP SYSTEM (VISTA)
"KRN",19,12249,-1)
0^2
"KRN",19,12249,0)
PSB BCBU INIT SINGLE PT^Single Patient Init^^R^^^^^^^^BAR CODE MED ADMIN
"KRN",19,12249,1,0)
^19.06^2^2^3030808^^
"KRN",19,12249,1,1,0)
This option will send inpatient orders to the BCMA Contingency 
"KRN",19,12249,1,2,0)
workstation for a single patient.
"KRN",19,12249,25)
SNDPT^ALPBIND
"KRN",19,12249,"U")
SINGLE PATIENT INIT
"KRN",19,12250,-1)
0^7
"KRN",19,12250,0)
PSB BCBU PMU MESSAGE BUILDER^Build a PMU B01/B02 Message^^A^^^^^^^^BAR CODE MED ADMIN^^1
"KRN",19,12250,1,0)
^19.06^8^8^3030808^^
"KRN",19,12250,1,1,0)
This is a subscriber to the Kernel options, XU USER ADD, XU USER 
"KRN",19,12250,1,2,0)
TERMINATE, AND XU USER CHANGE for generating an HL7 PMU message for the 
"KRN",19,12250,1,3,0)
BCMA contingency workstations.
"KRN",19,12250,1,4,0)
 
"KRN",19,12250,1,5,0)
If the event was to Add or Create a New Person File entry, a B01 message
"KRN",19,12250,1,6,0)
is generated. If the action was an edit of an existing entry, such as
"KRN",19,12250,1,7,0)
changing access/verify codes, termination or disuser/nodisuser, a B02 
"KRN",19,12250,1,8,0)
message is generated.
"KRN",19,12250,20)
I $D(XUIEN),$D(XUSR) D HL7^ALPBGEN(XUIEN,XUFLG,.XUSR) K HL,XUSR,XUNAME
"KRN",19,12250,"U")
BUILD A PMU B01/B02 MESSAGE
"KRN",19,12307,-1)
0^29
"KRN",19,12307,0)
PSB PRN DOCUMENTING^Documenting Backlog PRNs^^R^^^^^^^^
"KRN",19,12307,25)
PSBPRNS^PSBPRND
"KRN",19,12307,"U")
DOCUMENTING BACKLOG PRNS
"KRN",19,12308,-1)
0^8
"KRN",19,12308,0)
PSB BCBU PRINT BLK MAR^Print Blank Mar for Selected Patient^^R^^^^^^^^BAR CODE MED ADMIN
"KRN",19,12308,1,0)
^19.06^2^2^3030808^^
"KRN",19,12308,1,1,0)
This option allows the user to select a patient from the BCMA contingecy
"KRN",19,12308,1,2,0)
and print a blank 3 or 7 day MAR. The MAR will only contain patient info.
"KRN",19,12308,25)
ALPBBK
"KRN",19,12308,"U")
PRINT BLANK MAR FOR SELECTED P
"KRN",19.1,452,-1)
0^3
"KRN",19.1,452,0)
PSB INSTRUCTOR^BCMA Instructor
"KRN",19.1,452,1,0)
^19.11^2^2^3011203^^^^
"KRN",19.1,452,1,1,0)
Determines if the user is able to co-sign on the BCMA GUI product
"KRN",19.1,452,1,2,0)
for a student.
"KRN",19.1,453,-1)
0^4
"KRN",19.1,453,0)
PSB MANAGER^BCMA Systems Manager
"KRN",19.1,453,1,0)
^19.11^2^2^3011203^^^
"KRN",19.1,453,1,1,0)
If a user has this key they are allowed to run the BCMA Parameters 
"KRN",19.1,453,1,2,0)
application and setup/change the system paramters.
"KRN",19.1,454,-1)
0^5
"KRN",19.1,454,0)
PSB STUDENT^BCMA STUDENT LEVEL ACCESS
"KRN",19.1,476,-1)
0^2
"KRN",19.1,476,0)
PSB CPRS MED BUTTON^User of the CPRS Med Button
"KRN",19.1,476,1,0)
^19.11^3^3^3011207^^
"KRN",19.1,476,1,1,0)
This key designates the holder as a nurse who can document 
"KRN",19.1,476,1,2,0)
administered verbal an phont-type STAT and NOW orders using the CPRS 
"KRN",19.1,476,1,3,0)
Med Order Button on the BCMA Virtual Due List (VDL).
"KRN",19.1,489,-1)
0^1
"KRN",19.1,489,0)
PSB BUMGR^Key for PSB MANAGEMENT MENU
"KRN",19.1,489,1,0)
^^2^2^3030130^
"KRN",19.1,489,1,1,0)
This key is used to control access to the PSB MANAGEMENT MENU BCMA Backup 
"KRN",19.1,489,1,2,0)
System Management Menu
"KRN",101,4918,-1)
0^16
"KRN",101,4918,0)
PSB SELECT ORDER^Select Order^^A^^^^^^^^
"KRN",101,4918,1,0)
^101.06^3^3^3030808^^^^
"KRN",101,4918,1,1,0)
Lists a BCBU patient's orders and allows selection of one or several 
"KRN",101,4918,1,2,0)
orders which are then displayed. This protocol is used on the workstation 
"KRN",101,4918,1,3,0)
only.
"KRN",101,4918,4)
^4
"KRN",101,4918,15)
S VALMBCK="R"
"KRN",101,4918,20)
D SELORD^ALPBSP1
"KRN",101,4918,99)
59569,46475
"KRN",101,4919,-1)
0^14
"KRN",101,4919,0)
PSB ORDERS MENU^PSB Protocols^^M^^^^^^^^
"KRN",101,4919,1,0)
^101.06^1^1^3030808^^^
"KRN",101,4919,1,1,0)
Protocol menu containing protocol PSB SELECT ORDER.
"KRN",101,4919,4)
25^4
"KRN",101,4919,10,0)
^101.01PA^3^3
"KRN",101,4919,10,1,0)
4918^SO^1^
"KRN",101,4919,10,1,"^")
PSB SELECT ORDER
"KRN",101,4919,10,2,0)
4931^L1^2^
"KRN",101,4919,10,2,"^")
PSB SELECT ORDER ACTIVE
"KRN",101,4919,10,3,0)
4932^L2^3^
"KRN",101,4919,10,3,"^")
PSB SELECT ORDER ALL
"KRN",101,4919,15)

"KRN",101,4919,26)
D SHOW^VALM
"KRN",101,4919,28)
Select Action: 
"KRN",101,4919,99)
59569,46475
"KRN",101,4920,-1)
0^19
"KRN",101,4920,0)
PSB SELECT PATIENT^Select Patient^^A^^^^^^^^
"KRN",101,4920,1,0)
^101.06^3^3^3030808^^
"KRN",101,4920,1,1,0)
List all BCBU patients by name.  Allows selection of a patient and then 
"KRN",101,4920,1,2,0)
branches to PSB SELECT ORDER. This protocol is used on the workstation 
"KRN",101,4920,1,3,0)
only.
"KRN",101,4920,15)
S VALMBCK="R"
"KRN",101,4920,20)
D SELPAT^ALPBSPAT
"KRN",101,4920,26)
W ""
"KRN",101,4920,99)
59569,46475
"KRN",101,4921,-1)
0^15
"KRN",101,4921,0)
PSB PATIENT MENU^PSB Patient List/Select^^M^^^^^^^^
"KRN",101,4921,1,0)
^101.06^1^1^3030808^^^
"KRN",101,4921,1,1,0)
Protocol menu containing protocol PSB SELECT PATIENT.
"KRN",101,4921,4)
26^5
"KRN",101,4921,10,0)
^101.01PA^3^3
"KRN",101,4921,10,1,0)
4920^SP^1^
"KRN",101,4921,10,1,"^")
PSB SELECT PATIENT
"KRN",101,4921,10,2,0)
4929^LW^2^
"KRN",101,4921,10,2,"^")
PSB SELECT PATIENT WARD
"KRN",101,4921,10,3,0)
4930^LA^3^
"KRN",101,4921,10,3,"^")
PSB SELECT PATIENT ALL
"KRN",101,4921,15)

"KRN",101,4921,26)
D SHOW^VALM
"KRN",101,4921,99)
59569,46475
"KRN",101,4922,-1)
0^12
"KRN",101,4922,0)
PSB ERR LOG DEL ONE^Delete One Entry^^A^^^^^^^^
"KRN",101,4922,1,0)
^101.06^2^2^3030808^^^
"KRN",101,4922,1,1,0)
Deletes a selected entry or range of entries from the BCBU Error Log in 
"KRN",101,4922,1,2,0)
file 53.71.
"KRN",101,4922,15)
S VALMBCK="R"
"KRN",101,4922,20)
D DELONE^ALPBELOG
"KRN",101,4922,99)
59569,46475
"KRN",101,4923,-1)
0^13
"KRN",101,4923,0)
PSB ERROR LOG MENU^PSB Error Log Protocols^^M^^^^^^^^
"KRN",101,4923,1,0)
^101.06^2^2^3030808^^^^
"KRN",101,4923,1,1,0)
Protocol menu containing protocols PSB ERR LOG DEL ALL and PSB ERR LOG
"KRN",101,4923,1,2,0)
DEL ONE.
"KRN",101,4923,4)
25^4
"KRN",101,4923,10,0)
^101.01PA^2^2
"KRN",101,4923,10,1,0)
4922^D1^1^
"KRN",101,4923,10,1,"^")
PSB ERR LOG DEL ONE
"KRN",101,4923,10,2,0)
4924^DA^2^
"KRN",101,4923,10,2,"^")
PSB ERR LOG DEL ALL
"KRN",101,4923,26)
D SHOW^VALM
"KRN",101,4923,28)
Select Action: 
"KRN",101,4923,99)
59569,46475
"KRN",101,4924,-1)
0^11
"KRN",101,4924,0)
PSB ERR LOG DEL ALL^Delete All Entries^^A^^^^^^^^
"KRN",101,4924,1,0)
^101.06^1^1^3030808^^^
"KRN",101,4924,1,1,0)
Delete all entries from the BCBU Error Log in file 53.71.
"KRN",101,4924,15)
S VALMBCK="R"
"KRN",101,4924,20)
D DELALL^ALPBELOG
"KRN",101,4924,99)
59569,46475
"KRN",101,4929,-1)
0^21
"KRN",101,4929,0)
PSB SELECT PATIENT WARD^List by Ward^^A^^^^^^^^
"KRN",101,4929,1,0)
^101.06^1^1^3030808^^^
"KRN",101,4929,1,1,0)
Allows the user to list patients on selected wards.
"KRN",101,4929,15)
S VALMBCK="R"
"KRN",101,4929,20)
D SELWARD^ALPBSPAT
"KRN",101,4929,99)
59569,46475
"KRN",101,4930,-1)
0^20
"KRN",101,4930,0)
PSB SELECT PATIENT ALL^List All Patients^^A^^^^^^^^
"KRN",101,4930,1,0)
^101.06^2^2^3030808^^^
"KRN",101,4930,1,1,0)
List all BCBU patients by name. Allows user to select by patient's name,
"KRN",101,4930,1,2,0)
 patient's SSN, or first letter lastname+last 4 of SSN.
"KRN",101,4930,15)
S VALMBCK="R"
"KRN",101,4930,20)
D SELALL^ALPBSPAT
"KRN",101,4930,99)
59569,46475
"KRN",101,4931,-1)
0^17
"KRN",101,4931,0)
PSB SELECT ORDER ACTIVE^List Active Orders^^A^^^^^^^^
"KRN",101,4931,1,0)
^101.06^2^2^3030812^^
"KRN",101,4931,1,1,0)
List all active orders for a selected patient.
"KRN",101,4931,1,2,0)
Also allows for the selection of a order to be viewied.
"KRN",101,4931,15)
S VALMBCK="R"
"KRN",101,4931,20)
D SELACT^ALPBSP1
"KRN",101,4931,99)
59569,46475
"KRN",101,4932,-1)
0^18
"KRN",101,4932,0)
PSB SELECT ORDER ALL^List All Orders^^A^^^^^^^^
"KRN",101,4932,1,0)
^^2^2^3030812^
"KRN",101,4932,1,1,0)
List all orders for a selected patient regardless of the order status.
"KRN",101,4932,1,2,0)
Also allows for the selection of a order to be viewied.
"KRN",101,4932,15)
S VALMBCK="R"
"KRN",101,4932,20)
D SELALL^ALPBSP1
"KRN",101,4932,99)
59569,46475
"KRN",101,5016,-1)
0^9
"KRN",101,5016,0)
PSB BCMA RASO17 SRV^PSB BCMA RASO17 SERVER^DO NOT SEND MESSAGES^E^^^^^^^^
"KRN",101,5016,1,0)
^^3^3^3031217^^
"KRN",101,5016,1,1,0)
This is a test event driver protocol for PSB (BCMA).  This protocol is to 
"KRN",101,5016,1,2,0)
serve the RAS/O17 event.  The trigger event in general is a MEDPASS or 
"KRN",101,5016,1,3,0)
administration of a ORDER/Medication.
"KRN",101,5016,99)
59569,46475
"KRN",101,5016,770)
PSB HL7 SRV^^RAS^O17^^D^^AL^NE^2.4^
"KRN",101,5016,775,0)
^101.0775PA^1^1
"KRN",101,5016,775,1,0)
5017
"KRN",101,5016,775,1,"^")
PSB BCMA RASO17 SUB
"KRN",101,5017,-1)
0^10
"KRN",101,5017,0)
PSB BCMA RASO17 SUB^PSB BCMA RASO17 SUBSCRIBER^^S^^^^^^^^
"KRN",101,5017,99)
59569,46475
"KRN",101,5017,770)
^PSB HL7 SUB^^O01^^^PSBCOTS1^^^^ACK
"KRN",101,5017,774)

"KRN",409.61,616,-1)
0^2
"KRN",409.61,616,0)
PSB SELECT ORDERS^1^^80^7^19^1^1^^PSB ORDERS MENU^BCMAbu ACTIVE Orders List^1^^
"KRN",409.61,616,1)
^VALM HIDDEN ACTIONS
"KRN",409.61,616,"ARRAY")
 ^TMP("ALPBORDS",$J)
"KRN",409.61,616,"COL",0)
^409.621^4^4
"KRN",409.61,616,"COL",1,0)
OrderNum^2^10^Order No.
"KRN",409.61,616,"COL",2,0)
OrderType^22^4^Type
"KRN",409.61,616,"COL",3,0)
Status^14^7^Status
"KRN",409.61,616,"COL",4,0)
Meds^28^45^Medication(s)
"KRN",409.61,616,"COL","B","Meds",4)

"KRN",409.61,616,"COL","B","OrderNum",1)

"KRN",409.61,616,"COL","B","OrderType",2)

"KRN",409.61,616,"COL","B","Status",3)

"KRN",409.61,616,"FNL")
D EXIT^ALPBSP1
"KRN",409.61,616,"HDR")
D HDR^ALPBSP1
"KRN",409.61,616,"HLP")
D HELP^ALPBSP1
"KRN",409.61,616,"INIT")
D INIT^ALPBSP1
"KRN",409.61,617,-1)
0^4
"KRN",409.61,617,0)
PSB SHOW ORDERS^2^^80^7^20^1^1^^^BCMAbu Selected Order(s)^1^^1
"KRN",409.61,617,1)
^VALM HIDDEN ACTIONS
"KRN",409.61,617,"ARRAY")
 ^TMP("ALPBFORM",$J)
"KRN",409.61,617,"FNL")
D EXIT^ALPBSP2
"KRN",409.61,617,"HDR")
D HDR^ALPBSP2
"KRN",409.61,617,"HLP")
D HELP^ALPBSP2
"KRN",409.61,617,"INIT")
D INIT^ALPBSP2
"KRN",409.61,618,-1)
0^3
"KRN",409.61,618,0)
PSB SELECT PATIENT^1^^80^4^15^1^1^^PSB PATIENT MENU^BCMAbu Patient List (All)^1^^
"KRN",409.61,618,1)
^VALM HIDDEN ACTIONS
"KRN",409.61,618,"ARRAY")
 ^TMP("ALPBPLIST",$J)
"KRN",409.61,618,"COL",0)
^409.621^6^5
"KRN",409.61,618,"COL",2,0)
Patient^2^30^Patient
"KRN",409.61,618,"COL",3,0)
SSN^33^9^SSN
"KRN",409.61,618,"COL",4,0)
WARD^43^15^Ward
"KRN",409.61,618,"COL",5,0)
ROOM^62^5^Room
"KRN",409.61,618,"COL",6,0)
BED^72^5^Bed
"KRN",409.61,618,"COL","B","BED",6)

"KRN",409.61,618,"COL","B","Patient",2)

"KRN",409.61,618,"COL","B","ROOM",5)

"KRN",409.61,618,"COL","B","SSN",3)

"KRN",409.61,618,"COL","B","WARD",4)

"KRN",409.61,618,"FNL")
D EXIT^ALPBSPAT
"KRN",409.61,618,"HDR")
D HDR^ALPBSPAT
"KRN",409.61,618,"HLP")
D HELP^ALPBSPAT
"KRN",409.61,618,"INIT")
D INIT^ALPBSPAT
"KRN",409.61,619,-1)
0^1
"KRN",409.61,619,0)
PSB ERROR LOG^1^^80^4^20^1^1^^PSB ERROR LOG MENU^BCMAbu Error Log^1^^1
"KRN",409.61,619,1)
^VALM HIDDEN ACTIONS
"KRN",409.61,619,"ARRAY")
 ^TMP("ALPBELOG",$J)
"KRN",409.61,619,"COL",0)
^409.621^^0
"KRN",409.61,619,"FNL")
D EXIT^ALPBELOG
"KRN",409.61,619,"HDR")
D HDR^ALPBELOG
"KRN",409.61,619,"HLP")
D HELP^ALPBELOG
"KRN",409.61,619,"INIT")
D INIT^ALPBELOG
"KRN",771,110,-1)
0^4
"KRN",771,110,0)
PSB HL7 SUB^a^^BCMA HL7 MAIL^^^US
"KRN",771,110,"EC")
~|\&
"KRN",771,111,-1)
0^3
"KRN",771,111,0)
PSB HL7 SRV^a^^BCMA HL7 MAIL^^^US
"KRN",771,111,"EC")
~|\&
"KRN",870,193,-1)
0^1
"KRN",870,193,0)
PSBCOTS1^^TCP^^^^^^^^^^^^^^^^^^10
"KRN",870,193,200)
^2^256^10^10^^^^^R
"KRN",870,193,400)
10.6.208.7^10000^C^N^120^
"KRN",8989.5,3888,0)
536;DIC(9.4,^PSB BKUP ONLINE^1
"KRN",8989.5,3889,0)
536;DIC(9.4,^PSB BKUP MEDLG^1
"KRN",8989.5,3890,0)
536;DIC(9.4,^PSB BKUP IPH^1
"KRN",8989.51,34,-1)
0^43
"KRN",8989.51,34,0)
PSB VDL INCL ON-CALL^Include On Call Meds^0^^INCLUDE ON CALL MEDS ON DUE LIST^0
"KRN",8989.51,34,1)
Y^^Enter 'Y' to have On-Call Meds included in the initial VDL
"KRN",8989.51,34,20,0)
^8989.512^2^2^3030509^^
"KRN",8989.51,34,20,1,0)
Determines wether initial Due List View contains On Call
"KRN",8989.51,34,20,2,0)
medications.
"KRN",8989.51,34,30,0)
^8989.513I^1^1
"KRN",8989.51,34,30,1,0)
1^4
"KRN",8989.51,35,-1)
0^32
"KRN",8989.51,35,0)
PSB ONLINE^Is BCMA System On-Line^0^^IS BCMA ON-LINE^0
"KRN",8989.51,35,1)
Y
"KRN",8989.51,35,20,0)
^^2^2^2990323^^^^
"KRN",8989.51,35,20,1,0)
Used by the M Server and/or Application GUI Server administrator to 
"KRN",8989.51,35,20,2,0)
flag all client BCMA processes to stop.
"KRN",8989.51,35,30,0)
^8989.513I^1^1
"KRN",8989.51,35,30,1,0)
1^4
"KRN",8989.51,36,-1)
0^51
"KRN",8989.51,36,0)
PSB VDL START TIME^Default hours prior to NOW for the VDL^0^^HOURS PRIOR TO NOW FOR VDL^0
"KRN",8989.51,36,1)
N^0:24:0^Enter the number of hours prior to NOW that the VDL will initially display
"KRN",8989.51,36,20,0)
^^2^2^2990323^
"KRN",8989.51,36,20,1,0)
Default number of hours prior to NOW that the VDL will display when 
"KRN",8989.51,36,20,2,0)
initially displayed.
"KRN",8989.51,36,30,0)
^8989.513I^2^2
"KRN",8989.51,36,30,1,0)
1^200
"KRN",8989.51,36,30,2,0)
2^4
"KRN",8989.51,37,-1)
0^41
"KRN",8989.51,37,0)
PSB VDL INCL CONT^Include Continuous Meds^0^^INCLUDE CONTINUOUS MEDS ON DUE LIST^0
"KRN",8989.51,37,1)
Y^^Enter 'Y' to have Continuous Meds included in the initial VDL
"KRN",8989.51,37,20,0)
^8989.512^2^2^3030509^^
"KRN",8989.51,37,20,1,0)
Determines wheter initial Due List View contains continuous 
"KRN",8989.51,37,20,2,0)
medications.
"KRN",8989.51,37,30,0)
^8989.513I^1^1
"KRN",8989.51,37,30,1,0)
1^4
"KRN",8989.51,38,-1)
0^15
"KRN",8989.51,38,0)
PSB DRUG INPUT TFORM^INPUT TEXT^0
"KRN",8989.51,38,1)
M
"KRN",8989.51,38,30,0)
^8989.513I^1^1
"KRN",8989.51,38,30,1,0)
1^4
"KRN",8989.51,39,-1)
0^37
"KRN",8989.51,39,0)
PSB ROBOT RX^Using Robot RX^0^^USING ROBOT RX^0
"KRN",8989.51,39,1)
Y
"KRN",8989.51,39,20,0)
^8989.512^1^1^3010726^^^
"KRN",8989.51,39,20,1,0)
Parameter should be "yes" if site is using the robot RX.
"KRN",8989.51,39,30,0)
^8989.513I^1^1
"KRN",8989.51,39,30,1,0)
1^4
"KRN",8989.51,101,-1)
0^6
"KRN",8989.51,101,0)
PSB AUTOUPDATE SERVER^The UNC of the Auto-update Server^0^^UNC OF THE AUTOUPDATE SERVER
"KRN",8989.51,101,1)
F^0:50^Enter a Microsoft UNC for server
"KRN",8989.51,101,20,0)
^8989.512^2^2^3000726^^
"KRN",8989.51,101,20,1,0)
The Microsoft UNC path to the BCMA autoupdate server that will contain
"KRN",8989.51,101,20,2,0)
the source files for the update.
"KRN",8989.51,101,30,0)
^8989.513I^1^1
"KRN",8989.51,101,30,1,0)
1^4
"KRN",8989.51,103,-1)
0^28
"KRN",8989.51,103,0)
PSB MG AUTOUPDATE^Autoupdate Notification Mail Group^0^^AUTOUPDATE NOTIFICATION MAIL GROUP^0
"KRN",8989.51,103,1)
P^3.8
"KRN",8989.51,103,20,0)
^8989.512^1^1^3000712^
"KRN",8989.51,103,20,1,0)
Mailgroup to notify when updates or update errors occur.
"KRN",8989.51,103,30,0)
^8989.513I^1^1
"KRN",8989.51,103,30,1,0)
1^4
"KRN",8989.51,121,-1)
0^39
"KRN",8989.51,121,0)
PSB UNIT DOSE COLUMN WIDTHS^GUI Unit Dose display column widths^0^^UNIT DOSE COLUMN WIDTHS
"KRN",8989.51,121,1)
F^^entry is made automatically based on changes to the Unit Dose columns
"KRN",8989.51,121,20,0)
^8989.512^2^2^3010404^^^^
"KRN",8989.51,121,20,1,0)
This paramater is set by the users adjusting the Unit Dose column width.
"KRN",8989.51,121,20,2,0)
It is stored in the format nnn/nnn/nnn/nnn/nnn/nnn/nnn/nnn/nnn.
"KRN",8989.51,121,30,0)
^8989.513I^1^1
"KRN",8989.51,121,30,1,0)
1^200
"KRN",8989.51,122,-1)
0^54
"KRN",8989.51,122,0)
PSBIV ADDITIVE^IV Additive^1^IV Type^IV Additive^0
"KRN",8989.51,122,1)
S^1:W-Display Warning Message;2:N-NO Warning Message;3:I-Invalid IV Bag
"KRN",8989.51,122,2)
I X=1!(X=2) W !!?5,"The recommended response for this parameter is 3  I-Invalid IV Bag.",!
"KRN",8989.51,122,6)
S^1:A;2:P;3:H;4:S;5:C
"KRN",8989.51,122,30,0)
^8989.513I^2^1
"KRN",8989.51,122,30,2,0)
1^4
"KRN",8989.51,134,-1)
0^22
"KRN",8989.51,134,0)
PSB IV COLUMN WIDTHS^IV Column Widths^0^^IV COLUMN WIDTHS
"KRN",8989.51,134,1)
F^^entry is made automatically based on changes to the IV columns
"KRN",8989.51,134,20,0)
^8989.512^2^2^3010508^^^^
"KRN",8989.51,134,20,1,0)
This paramater is set by the users adjusting the IV column width
"KRN",8989.51,134,20,2,0)
It is stored in the format nnn/nnn/nnn/nnn/nnn/nnn/nnn/nnn/nnn
"KRN",8989.51,134,30,0)
^8989.513I^1^1
"KRN",8989.51,134,30,1,0)
1^200
"KRN",8989.51,152,-1)
0^49
"KRN",8989.51,152,0)
PSB VDL PB SORT COLUMN^Sorted PB column on Virtual Due List^0^^PB SORTED COLUMN ON VDL
"KRN",8989.51,152,1)
N^0:10:0^Enter a number between 0 and 10
"KRN",8989.51,152,20,0)
^^1^1^3010514^
"KRN",8989.51,152,20,1,0)
Contains the integer value of the last PB sorted column on the VDL
"KRN",8989.51,152,30,0)
^8989.513I^1^1
"KRN",8989.51,152,30,1,0)
1^200
"KRN",8989.51,173,-1)
0^47
"KRN",8989.51,173,0)
PSB VDL IV SORT COLUMN^Sorted IV column on Virtual Due List^0^^IV SORTED COLUMN ON VDL
"KRN",8989.51,173,1)
N^0:10:0^Enter a number between 0 and 10
"KRN",8989.51,173,20,0)
^8989.512^1^1^3010514^^
"KRN",8989.51,173,20,1,0)
Contains the integer value of the last IV sorted column on the VDL
"KRN",8989.51,173,30,0)
^8989.513I^1^1
"KRN",8989.51,173,30,1,0)
1^200
"KRN",8989.51,199,-1)
0^20
"KRN",8989.51,199,0)
PSB HKEY^Enable CPRS Med Order Button^0^^ENABLE CPRS MED ORDER BUTTON^0
"KRN",8989.51,199,1)
Y
"KRN",8989.51,199,20,0)
^^1^1^3010802^
"KRN",8989.51,199,20,1,0)
Used by the GUI application to determine if the division is using the CPRS Med Order Button.
"KRN",8989.51,199,30,0)
^8989.513I^1^1
"KRN",8989.51,199,30,1,0)
1^4
"KRN",8989.51,200,-1)
0^21
"KRN",8989.51,200,0)
PSB IDLE TIMEOUT^BCMA Idle Timeout^0^^BCMA Idle Timeout^0
"KRN",8989.51,200,1)
N^1:1440
"KRN",8989.51,200,20,0)
^8989.512^1^1^3030508^^^^
"KRN",8989.51,200,20,1,0)
This is used by the GUI to determine the number of minutes the VDL shall remain idle before shutting down.
"KRN",8989.51,200,30,0)
^8989.513I^1^1
"KRN",8989.51,200,30,1,0)
1^4
"KRN",8989.51,226,-1)
0^36
"KRN",8989.51,226,0)
PSB PRN DOCUMENTATION^PRN Documentation Timeframe^0
"KRN",8989.51,226,1)
N^1:999^Enter number of hours (1-999, 72 is default)
"KRN",8989.51,226,20,0)
^8989.512^1^1^3030401^^
"KRN",8989.51,226,20,1,0)
This will store the number of hours for the PRN Documentation Timeframe on the BCMA Site Parameters screen.
"KRN",8989.51,226,30,0)
^8989.513I^1^1
"KRN",8989.51,226,30,1,0)
1^4
"KRN",8989.51,231,-1)
0^9
"KRN",8989.51,231,0)
PSB BKUP MACHINES^Division-specific Logical Links^1^Logical Link
"KRN",8989.51,231,1)
P^870^Enter the HL7 Logical Link
"KRN",8989.51,231,6)
P^870^Enter the HL7 Logical Link
"KRN",8989.51,231,20,0)
^8989.512^3^3^3021217^^
"KRN",8989.51,231,20,1,0)
This parameter defines the BCMA Backup Logical Links that may be 
"KRN",8989.51,231,20,2,0)
associated with a division when there are one or more
"KRN",8989.51,231,20,3,0)
divisions at a site.
"KRN",8989.51,231,30,0)
^8989.513I^1^1
"KRN",8989.51,231,30,1,0)
1^4
"KRN",8989.51,245,-1)
0^7
"KRN",8989.51,245,0)
PSB BKUP DEFAULT^Package-specific 'default' Logical Links^1^Logical Link
"KRN",8989.51,245,1)
P^870^Enter the HL7 logical link
"KRN",8989.51,245,6)
P^870^Enter the HL7 logical link
"KRN",8989.51,245,20,0)
^^10^10^3030102^
"KRN",8989.51,245,20,1,0)
This parameter is used by the BCMA Backup system to route messages to a 
"KRN",8989.51,245,20,2,0)
"default" group of HL7 Logical Links that are associated with the BCMA
"KRN",8989.51,245,20,3,0)
package rather than individual divisions. When the default group is 
"KRN",8989.51,245,20,4,0)
defined all messages will be routed to this group rather than using 
"KRN",8989.51,245,20,5,0)
division-based groupings under the following conditions:
"KRN",8989.51,245,20,6,0)
 
"KRN",8989.51,245,20,7,0)
1. If a call is made to the api, GET^ALPBPARM, and the division parameter 
"KRN",8989.51,245,20,8,0)
is not present or null.
"KRN",8989.51,245,20,9,0)
2. If a call is made to the api, GET^ALPBPARM, and the division specified 
"KRN",8989.51,245,20,10,0)
has no logical links associated with it.
"KRN",8989.51,245,30,0)
^8989.513I^1^1
"KRN",8989.51,245,30,1,0)
.5^9.4
"KRN",8989.51,249,-1)
0^11
"KRN",8989.51,249,0)
PSB BKUP ONLINE^BCMA Contingency Online
"KRN",8989.51,249,1)
Y
"KRN",8989.51,249,20,0)
^^4^4^3030404^
"KRN",8989.51,249,20,1,0)
This parameter is used by the BCMA Backup system to activate the 
"KRN",8989.51,249,20,2,0)
Contingency software. If the value is set to NO then no HL7 messages will 
"KRN",8989.51,249,20,3,0)
be sent to the Workstation. This does not affect the workstation 
"KRN",8989.51,249,20,4,0)
initialization option.
"KRN",8989.51,249,30,0)
^8989.513I^1^1
"KRN",8989.51,249,30,1,0)
1^9.4
"KRN",8989.51,251,-1)
0^8
"KRN",8989.51,251,0)
PSB BKUP IPH^BCMA Contingency Active Pharm Order^^
"KRN",8989.51,251,1)
N
"KRN",8989.51,251,6)

"KRN",8989.51,251,20,0)
^8989.512^4^4^3030404^^
"KRN",8989.51,251,20,1,0)
The BCMA Backup Contingency software uses this parameter. During the 
"KRN",8989.51,251,20,2,0)
Workstation initialization process this tell the process how many days of 
"KRN",8989.51,251,20,3,0)
historic Inpatient Medication Orders to capture. It is based off the fact 
"KRN",8989.51,251,20,4,0)
the order was active during that time.
"KRN",8989.51,251,30,0)
^8989.513I^1^1
"KRN",8989.51,251,30,1,0)
1^9.4
"KRN",8989.51,260,-1)
0^10
"KRN",8989.51,260,0)
PSB BKUP MEDLG^BCMA Contingency MedLog DFT
"KRN",8989.51,260,1)
N
"KRN",8989.51,260,20,0)
^^3^3^3030404^
"KRN",8989.51,260,20,1,0)
The BCMA Backup Contingency software uses this parameter. During the 
"KRN",8989.51,260,20,2,0)
Workstation initialization process this tell the process how many days of 
"KRN",8989.51,260,20,3,0)
historic Med Log entries of Inpatient Medication Orders to capture.
"KRN",8989.51,260,30,0)
^8989.513I^1^1
"KRN",8989.51,260,30,1,0)
1^9.4
"KRN",8989.51,264,-1)
0^52
"KRN",8989.51,264,0)
PSB VDL STOP TIME^Default hours after NOW for the VDL^0^zzinstance^HOURS AFTER NOW FOR VDL^0
"KRN",8989.51,264,1)
N^0:24:0^Enter the number of hours after NOW that the VDL will initially display
"KRN",8989.51,264,20,0)
^^2^2^2990323^
"KRN",8989.51,264,20,1,0)
Default number of hours after NOW that the VDL will display when 
"KRN",8989.51,264,20,2,0)
initially displayed.
"KRN",8989.51,264,30,0)
^8989.513I^2^2
"KRN",8989.51,264,30,1,0)
1^200
"KRN",8989.51,264,30,2,0)
2^4
"KRN",8989.51,266,-1)
0^45
"KRN",8989.51,266,0)
PSB VDL INCL PRN^Include PRN Meds^0^^INCLUDE PRN MEDS ON DUE LIST^0
"KRN",8989.51,266,1)
Y^^Enter 'Y' to have PRN Meds included in the initial VDL
"KRN",8989.51,266,20,0)
^8989.512^1^1^3030509^^^^
"KRN",8989.51,266,20,1,0)
Determines wether initial Due List View contains PRN medications.
"KRN",8989.51,266,30,0)
^8989.513I^3^1
"KRN",8989.51,266,30,3,0)
1^4
"KRN",8989.51,267,-1)
0^44
"KRN",8989.51,267,0)
PSB VDL INCL ONE-TIME^Include One-Time Meds^0^^INCLUDE ONE-TIME MEDS ON DUE LIST^0
"KRN",8989.51,267,1)
Y^^Enter 'Y' to have One-Time Meds included in the initial VDL
"KRN",8989.51,267,20,0)
^8989.512^2^2^3030509^^
"KRN",8989.51,267,20,1,0)
Determines wether initial Due List View contains One-Time
"KRN",8989.51,267,20,2,0)
medications.
"KRN",8989.51,267,30,0)
^8989.513I^1^1
"KRN",8989.51,267,30,1,0)
1^4
"KRN",8989.51,269,-1)
0^25
"KRN",8989.51,269,0)
PSB LIST REASONS GIVEN PRN^Reasons a Med is given PRN^1^Reason #^Reason Given PRN^0
"KRN",8989.51,269,1)
F^1:32
"KRN",8989.51,269,6)
N^1:100
"KRN",8989.51,269,20,0)
^8989.512^2^2^3031126^^^^
"KRN",8989.51,269,20,1,0)
Listing of division specific reasons why a meication is given PRN.  Up 
"KRN",8989.51,269,20,2,0)
to 100 reasons are allowed.
"KRN",8989.51,269,30,0)
^8989.513I^1^1
"KRN",8989.51,269,30,1,0)
1^4
"KRN",8989.51,270,-1)
0^26
"KRN",8989.51,270,0)
PSB LIST REASONS HELD^Reasons a Med is Held^1^Reason #^Reason Medication Held^0
"KRN",8989.51,270,1)
F^1:30
"KRN",8989.51,270,6)
N^1:100
"KRN",8989.51,270,20,0)
^^2^2^3031002^
"KRN",8989.51,270,20,1,0)
Listing of division specific reasons why a medication is held.  Up 
"KRN",8989.51,270,20,2,0)
to 100 reasons are allowed.
"KRN",8989.51,270,30,0)
^8989.513I^1^1
"KRN",8989.51,270,30,1,0)
1^4
"KRN",8989.51,271,-1)
0^29
"KRN",8989.51,271,0)
PSB MG DUE LIST ERROR^Due List Error Notification Mail Group^0^^DUE LIST ERRORS MAIL GROUP^0
"KRN",8989.51,271,1)
P^3.8
"KRN",8989.51,271,20,0)
^^2^2^2990518^^
"KRN",8989.51,271,20,1,0)
Mailgroup to notify when an order is unable to be validated and placed 
"KRN",8989.51,271,20,2,0)
on the Due List.
"KRN",8989.51,271,30,0)
^8989.513I^1^1
"KRN",8989.51,271,30,1,0)
1^4
"KRN",8989.51,272,-1)
0^3
"KRN",8989.51,272,0)
PSB ADMIN ESIG^Require E-Sig to Administer^0^^REQUIRE ESIG TO ADMINISTER^0
"KRN",8989.51,272,1)
Y
"KRN",8989.51,272,20,0)
^^2^2^2990323^^^^
"KRN",8989.51,272,20,1,0)
Determines if a user must supply their electronic signature code prior 
"KRN",8989.51,272,20,2,0)
to administering any medications.
"KRN",8989.51,272,30,0)
^8989.513I^1^1
"KRN",8989.51,272,30,1,0)
1^4
"KRN",8989.51,273,-1)
0^2
"KRN",8989.51,273,0)
PSB ADMIN BEFORE^Allowed Mins Before Sched Admin^0^^ALLOWED MINS BEFORE SCHED TIME
"KRN",8989.51,273,1)
N^10:240:0^enter a number between 10-240 on even ten minute increments.
"KRN",8989.51,273,2)
K:X#10 X
"KRN",8989.51,273,20,0)
^^2^2^2990325^^
"KRN",8989.51,273,20,1,0)
This parameter contains the number of minutes before a scheduled 
"KRN",8989.51,273,20,2,0)
administration time is allowed without filing a variance.
"KRN",8989.51,273,30,0)
^8989.513I^1^1
"KRN",8989.51,273,30,1,0)
1^4
"KRN",8989.51,274,-1)
0^1
"KRN",8989.51,274,0)
PSB ADMIN AFTER^Allowed Mins After Sched Admin^0^^ALLOWED MINS AFTER SCHED TIME
"KRN",8989.51,274,1)
N^10:240:0^enter a number between 10-240 on even ten minute increments.
"KRN",8989.51,274,2)
K:X#10 X
"KRN",8989.51,274,20,0)
^8989.512^2^2^3021114^^^^
"KRN",8989.51,274,20,1,0)
This parameter contains the number of minutes after a scheduled 
"KRN",8989.51,274,20,2,0)
administration time is allowed without filing a variance.
"KRN",8989.51,274,30,0)
^8989.513I^1^1
"KRN",8989.51,274,30,1,0)
1^4
"KRN",8989.51,275,-1)
0^5
"KRN",8989.51,275,0)
PSB ADMIN PRN EFFECT^Allowed Mins to Enter PRN Effect^0^^ALLOWED MINS FOR PRN EFFECT
"KRN",8989.51,275,1)
N^10:240:0^enter a number between 10-240 on even ten minute increments.
"KRN",8989.51,275,2)
K:X#10 X
"KRN",8989.51,275,20,0)
^^2^2^2990323^
"KRN",8989.51,275,20,1,0)
The number of minutes allowed to elapse between PRN administration and 
"KRN",8989.51,275,20,2,0)
entry of PRN Effectiveness.
"KRN",8989.51,275,30,0)
^8989.513I^1^1
"KRN",8989.51,275,30,1,0)
1^4
"KRN",8989.51,276,-1)
0^19
"KRN",8989.51,276,0)
PSB HFS SCRATCH^Scratch HFS Directory^0^^SCRATCH HFS DIRECTORY^0
"KRN",8989.51,276,1)
F^1:50^Enter a valid HFS Directory Name
"KRN",8989.51,276,20,0)
^^2^2^2990323^
"KRN",8989.51,276,20,1,0)
Name of an HFS directory that all BCMA processes will be able to 
"KRN",8989.51,276,20,2,0)
access through ^%ZISH for printing documents.
"KRN",8989.51,276,30,0)
^8989.513I^1^1
"KRN",8989.51,276,30,1,0)
1^4
"KRN",8989.51,277,-1)
0^18
"KRN",8989.51,277,0)
PSB HFS BACKUP^Backup HFS Directory^0^^BACKUP HFS DIRECTORY^0
"KRN",8989.51,277,1)
F^1:50^Enter a valid HFS Directory Name
"KRN",8989.51,277,20,0)
^^2^2^2990323^
"KRN",8989.51,277,20,1,0)
Name of an HFS directory that all BCMA processes will be able to 
"KRN",8989.51,277,20,2,0)
access through ^%ZISH for printing documents.
"KRN",8989.51,277,30,0)
^8989.513I^1^1
"KRN",8989.51,277,30,1,0)
1^4
"KRN",8989.51,278,-1)
0^31
"KRN",8989.51,278,0)
PSB MG SYSTEM ERROR^System Error Notification Mail Group^0^^SYSTEM ERRORS MAIL GROUP^0
"KRN",8989.51,278,1)
P^3.8
"KRN",8989.51,278,20,0)
^^2^2^2990323^
"KRN",8989.51,278,20,1,0)
Mailgroup to notify when an unexplained error occurs with the 
"KRN",8989.51,278,20,2,0)
software.
"KRN",8989.51,278,30,0)
^8989.513I^1^1
"KRN",8989.51,278,30,1,0)
1^4
"KRN",8989.51,279,-1)
0^30
"KRN",8989.51,279,0)
PSB MG MISSING DOSE^Missing Dose Notification Mail Group^0^^MISSING DOSE MAIL GROUP^0
"KRN",8989.51,279,1)
P^3.8
"KRN",8989.51,279,20,0)
^^1^1^2990323^
"KRN",8989.51,279,20,1,0)
Mailgroup to notify when a missing dose is requested.
"KRN",8989.51,279,30,0)
^8989.513I^2^2
"KRN",8989.51,279,30,1,0)
1^44
"KRN",8989.51,279,30,2,0)
2^4
"KRN",8989.51,280,-1)
0^27
"KRN",8989.51,280,0)
PSB LIST REASONS REFUSED^Reasons a Med is Refused^1^Reason #^Reason Medication is Refused^0
"KRN",8989.51,280,1)
F^1:30
"KRN",8989.51,280,6)
N^1:100
"KRN",8989.51,280,20,0)
^^2^2^3031002^
"KRN",8989.51,280,20,1,0)
Listing of division specific reasons why a medication is refused.  Up 
"KRN",8989.51,280,20,2,0)
to 100 reasons are allowed.
"KRN",8989.51,280,30,0)
^8989.513I^1^1
"KRN",8989.51,280,30,1,0)
1^4
"KRN",8989.51,281,-1)
0^4
"KRN",8989.51,281,0)
PSB ADMIN MULTIPLE ONCALL^Allow Multi Admin On-Call^0^^ALLOW MULTIPLE ON CALL ADMINS^0
"KRN",8989.51,281,1)
Y
"KRN",8989.51,281,20,0)
^^2^2^2990323^^^
"KRN",8989.51,281,20,1,0)
Determines if this Division will allow multiple administrations against an
"KRN",8989.51,281,20,2,0)
On-Call order.
"KRN",8989.51,281,30,0)
^8989.513I^1^1
"KRN",8989.51,281,30,1,0)
1^4
"KRN",8989.51,282,-1)
0^34
"KRN",8989.51,282,0)
PSB PRINTER MISSING DOSE^Missing Dose Printer^0^Printer DEVICE^MISSING DOSE PRINTER^0
"KRN",8989.51,282,1)
P^3.5
"KRN",8989.51,282,20,0)
^^1^1^2990323^
"KRN",8989.51,282,20,1,0)
Device to print to when a missing dose is requested.
"KRN",8989.51,282,30,0)
^8989.513I^2^2
"KRN",8989.51,282,30,1,0)
1^44
"KRN",8989.51,282,30,2,0)
2^4
"KRN",8989.51,283,-1)
0^42
"KRN",8989.51,283,0)
PSB VDL INCL IV MEDS^Include IV Med Orders^0^^INCLUDE IV MEDS ON DUE LIST^0
"KRN",8989.51,283,1)
Y^^Enter 'Y' to have IV Order Meds included in the initial VDL
"KRN",8989.51,283,20,0)
^^1^1^2990323^
"KRN",8989.51,283,20,1,0)
Determines wether initial Due List View contains IV Medications.
"KRN",8989.51,283,30,0)
^8989.513I^2^2
"KRN",8989.51,283,30,1,0)
1^200
"KRN",8989.51,283,30,2,0)
2^4
"KRN",8989.51,284,-1)
0^46
"KRN",8989.51,284,0)
PSB VDL INCL UD MEDS^Include Unit Dose Med Orders^0^^INCLUDE UNIT DOSE MEDS ON DUE LIST^0
"KRN",8989.51,284,1)
Y^^Enter 'Y' to have Unit Dose Meds included in the initial VDL
"KRN",8989.51,284,20,0)
^^2^2^2990323^
"KRN",8989.51,284,20,1,0)
Determines wether initial Due List View contains Unit Dose
"KRN",8989.51,284,20,2,0)
medications.
"KRN",8989.51,284,30,0)
^8989.513I^2^2
"KRN",8989.51,284,30,1,0)
1^200
"KRN",8989.51,284,30,2,0)
2^4
"KRN",8989.51,285,-1)
0^40
"KRN",8989.51,285,0)
PSB VDL INCL BLANKS^Include Blank Addendums at end^0^^INCLUDE BLANKS ADDENDUMS ON DUE LIST^0
"KRN",8989.51,285,1)
Y^^Enter 'Y' to have Addendums print at end of DL
"KRN",8989.51,285,20,0)
^^2^2^2990323^
"KRN",8989.51,285,20,1,0)
Used to flag wether or not to print the blank order requests at the 
"KRN",8989.51,285,20,2,0)
bottom of the printed DUE LIST.
"KRN",8989.51,285,30,0)
^8989.513I^2^2
"KRN",8989.51,285,30,1,0)
1^200
"KRN",8989.51,285,30,2,0)
2^4
"KRN",8989.51,286,-1)
0^35
"KRN",8989.51,286,0)
PSB PRINTER USER DEFAULT^Default Report Device^0^DEVICE^USERS DEFAULT PRINTER^0
"KRN",8989.51,286,1)
P^3.5
"KRN",8989.51,286,20,0)
^^1^1^2990323^
"KRN",8989.51,286,20,1,0)
Default device the user uses for printing BCMA reports.
"KRN",8989.51,286,30,0)
^8989.513I^1^1
"KRN",8989.51,286,30,1,0)
1^200
"KRN",8989.51,287,-1)
0^38
"KRN",8989.51,287,0)
PSB SERVER CLOCK VARIANCE^Allowable client-server time variance^0^^ALLOWABLE SERVER CLOCK VARIANCE
"KRN",8989.51,287,1)
N^0:30:0^Enter a number between 0 and 30
"KRN",8989.51,287,20,0)
^^3^3^2990323^
"KRN",8989.51,287,20,1,0)
Used by the client at application startup to ensure that the client 
"KRN",8989.51,287,20,2,0)
clock is within a predetermined number of minutes of the server time 
"KRN",8989.51,287,20,3,0)
before allowing the client to proceed.
"KRN",8989.51,287,30,0)
^8989.513I^1^1
"KRN",8989.51,287,30,1,0)
1^4
"KRN",8989.51,288,-1)
0^24
"KRN",8989.51,288,0)
PSB LIST INJECTION SITES^Injection Sites^1^Injection Site #^Injection Site^0
"KRN",8989.51,288,1)
F^1:30
"KRN",8989.51,288,6)
N^1:100
"KRN",8989.51,288,20,0)
^^2^2^3031002^
"KRN",8989.51,288,20,1,0)
Listing of division specific injection sites for a medication.
"KRN",8989.51,288,20,2,0)
Up to 100 sites are allowed.
"KRN",8989.51,288,30,0)
^8989.513I^1^1
"KRN",8989.51,288,30,1,0)
1^4
"KRN",8989.51,289,-1)
0^53
"KRN",8989.51,289,0)
PSB WINDOW^Initial Window Display^0^^USER WINDOW PARAMETERS
"KRN",8989.51,289,1)
F^1:30
"KRN",8989.51,289,30,0)
^8989.513I^1^1
"KRN",8989.51,289,30,1,0)
1^200
"KRN",8989.51,290,-1)
0^50
"KRN",8989.51,290,0)
PSB VDL SORT COLUMN^Sorted Column on Virtual Due List^0^^SORTED COL ON VDL
"KRN",8989.51,290,1)
N^0:10:0^Enter a number between 0 and 10
"KRN",8989.51,290,20,0)
^^2^2^2990406^^^^
"KRN",8989.51,290,20,1,0)
Contains the integer value of the last sorted column on the Virtual 
"KRN",8989.51,290,20,2,0)
Due List.
"KRN",8989.51,290,30,0)
^8989.513I^1^1
"KRN",8989.51,290,30,1,0)
1^200
"KRN",8989.51,4649,-1)
0^12
"KRN",8989.51,4649,0)
PSB DEFAULT BARCODE FORMAT^Default Bar Code Format^0^DEFAULT BARCODE FORMAT^DEFAULT BARCODE FORMAT^0
"KRN",8989.51,4649,1)
S^1:C39;2:128;3:I25
"KRN",8989.51,4649,20,0)
^^1^1^2990731^^^
"KRN",8989.51,4649,20,1,0)
Select the desired bar code format to produce on the Zebra Label Printer.
"KRN",8989.51,4649,30,0)
^8989.513I^1^1
"KRN",8989.51,4649,30,1,0)
1^4
"KRN",8989.51,4651,-1)
0^14
"KRN",8989.51,4651,0)
PSB DEFAULT BARCODE SITE^Include Site Number in Barcode^0^^INCLUDE SITE NUMBER IN BARCODE^0
"KRN",8989.51,4651,1)
Y^^Enter 'Y' to have Site Number printed on barcodes
"KRN",8989.51,4651,20,0)
^^4^4^2990817^
"KRN",8989.51,4651,20,1,0)
Used to flag whether or not to print the Site Number on the labels
"KRN",8989.51,4651,20,2,0)
generated with the PSBO BL Option.  If Yes then the barcode will include
"KRN",8989.51,4651,20,3,0)
the station number - Drug IEN (i.e. 677-263 for drug 263 at station 677)
"KRN",8989.51,4651,20,4,0)
If the answer is No then only the Drug IEN will print (i.e. 263).
"KRN",8989.51,4651,30,0)
^8989.513I^1^1
"KRN",8989.51,4651,30,1,0)
1^4
"KRN",8989.51,4659,-1)
0^13
"KRN",8989.51,4659,0)
PSB DEFAULT BARCODE PREFIX^Default Barcode Prefix^0^^DEFAULT BARCODE PREFIX
"KRN",8989.51,4659,1)
F^0:5^Will accept a null or up to 5 alphanumeric characters.
"KRN",8989.51,4659,20,0)
^8989.512^1^1^3021024^^^^
"KRN",8989.51,4659,20,1,0)
Text to prefix when printing a label on the Zebra Barcode Printer.
"KRN",8989.51,4659,30,0)
^8989.513I^1^1
"KRN",8989.51,4659,30,1,0)
1^4
"KRN",8989.51,4666,-1)
0^16
"KRN",8989.51,4666,0)
PSB GUI COLUMN WIDTHS^GUI Display Column Widths^0^^GUI COLUMN WIDTHS
"KRN",8989.51,4666,1)
F^^entry is made automatically based on changes to the GUI columns
"KRN",8989.51,4666,20,0)
^8989.512^2^2^3010328^^^
"KRN",8989.51,4666,20,1,0)
This paramater is set by the users adjusting the columns on the GUI display.
"KRN",8989.51,4666,20,2,0)
It is stored in the format nnn/nnn/nnn/nnn/nnn/nnn/nnn/nnn/nnn.
"KRN",8989.51,4666,30,0)
^8989.513I^1^1
"KRN",8989.51,4666,30,1,0)
1^200
"KRN",8989.51,4685,-1)
0^48
"KRN",8989.51,4685,0)
PSB VDL ONE-TIME^One Time Parameter^0^^HOURS ONE-TIME MEDS DISPLAYED ON VDL^0
"KRN",8989.51,4685,1)
N^0:8760^Enter a number between 1 and 8760 hrs.
"KRN",8989.51,4685,30,0)
^8989.513I^1^1
"KRN",8989.51,4685,30,1,0)
1^4
"KRN",8989.51,4687,-1)
0^55
"KRN",8989.51,4687,0)
PSBIV ADMIN TIME^IV Admin Time^1^IV type^IV Admin Time^0
"KRN",8989.51,4687,1)
S^1:W-Display Warning Message;2:N-NO Warning Message;3:I-Invalid IV Bag
"KRN",8989.51,4687,2)
I X=1!(X=2) W !!?5,"The recommended response for this parameter is 3  I-Invalid IV Bag.",!
"KRN",8989.51,4687,6)
S^1:A;2:P;3:H;4:S;5:C
"KRN",8989.51,4687,30,0)
^8989.513I^1^1
"KRN",8989.51,4687,30,1,0)
1^4
"KRN",8989.51,4688,-1)
0^56
"KRN",8989.51,4688,0)
PSBIV BOTTLE^IV Bottle^1^IV Type^IV Bottle^0
"KRN",8989.51,4688,1)
S^1:W-Display Warning Message;2:N-NO Warning Message;3:I-Invalid IV Bag
"KRN",8989.51,4688,2)
I X=1!(X=2) W !!?5,"The recommended response for this parameter is 3  I-Invalid IV Bag.",!
"KRN",8989.51,4688,6)
S^1:A;2:P;3:H;4:S;5:C
"KRN",8989.51,4688,30,0)
^8989.513I^1^1
"KRN",8989.51,4688,30,1,0)
1^4
"KRN",8989.51,4689,-1)
0^58
"KRN",8989.51,4689,0)
PSBIV INFUSION RATE^IV Infusion Rate^1^IV Type^IV Infusion Rate^0
"KRN",8989.51,4689,1)
S^1:W-Display Warning Message;2:N-NO Warning Message;3:I-Invalid IV Bag
"KRN",8989.51,4689,2)
I X=2!(X=3) W !!?5,"The recommended response for this parameter is 1:W-Display Warning Message.",!
"KRN",8989.51,4689,6)
S^1:A;2:P;3:H;4:S;5:C
"KRN",8989.51,4689,30,0)
^8989.513I^1^1
"KRN",8989.51,4689,30,1,0)
1^4
"KRN",8989.51,4690,-1)
0^59
"KRN",8989.51,4690,0)
PSBIV MED ROUTE^IV Med Route^1^IV Type^IV Med Route
"KRN",8989.51,4690,1)
S^1:W-Display Warning Message;2:N-NO Warning Message;3:I-Invalid IV Bag
"KRN",8989.51,4690,2)
I X=1!(X=2) W !!?5,"The recommended response for this parameter is 3  I-Invalid IV Bag.",!
"KRN",8989.51,4690,6)
S^1:A;2:P;3:H;4:S;5:C
"KRN",8989.51,4690,30,0)
^8989.513I^1^1
"KRN",8989.51,4690,30,1,0)
1^4
"KRN",8989.51,4691,-1)
0^60
"KRN",8989.51,4691,0)
PSBIV OTHER PRINT INFO^IV Other Print Info^1^IV Type^IV Other Print Info^0
"KRN",8989.51,4691,1)
S^1:W-Display Warning Message;2:N-NO Warning Message;3:I-Invalid IV Bag
"KRN",8989.51,4691,2)
I X=2!(X=3) W !!?5,"The recommended response for this parameter is 1:W-Display Warning Message.",!
"KRN",8989.51,4691,6)
S^1:A;2:P;3:H;4:S;5:C
"KRN",8989.51,4691,30,0)
^8989.513I^1^1
"KRN",8989.51,4691,30,1,0)
1^4
"KRN",8989.51,4692,-1)
0^61
"KRN",8989.51,4692,0)
PSBIV PROVIDER^IV Provider^1^IV Type^IV Provider^0
"KRN",8989.51,4692,1)
S^1:W-Display Warning Message;2:N-NO Warning Message;3:I-Invalid IV Bag
"KRN",8989.51,4692,2)
I X=1!(X=2) W !!?5,"The recommended response for this parameter is 3  I-Invalid IV Bag.",!
"KRN",8989.51,4692,6)
S^1:A;2:P;3:H;4:S;5:C
"KRN",8989.51,4692,30,0)
^8989.513I^1^1
"KRN",8989.51,4692,30,1,0)
1^4
"KRN",8989.51,4693,-1)
0^62
"KRN",8989.51,4693,0)
PSBIV PROVIDER COMMENTS^IV Provider Comments^1^IV Type^IV Provider Comments^0
"KRN",8989.51,4693,1)
S^1:W-Display Warning Message;2:N-NO Warning Message;3:I-Invalid IV Bag
"KRN",8989.51,4693,2)
I X=1!(X=2) W !!?5,"The recommended response for this parameter is 3  I-Invalid IV Bag.",!
"KRN",8989.51,4693,6)
S^1:A;2:P;3:H;4:S;5:C
"KRN",8989.51,4693,30,0)
^8989.513I^1^1
"KRN",8989.51,4693,30,1,0)
1^4
"KRN",8989.51,4694,-1)
0^63
"KRN",8989.51,4694,0)
PSBIV REMARKS^IV Remarks^1^IV Type^IV Remarks^0
"KRN",8989.51,4694,1)
S^1:W-Display Warning Message;2:N-NO Warning Message;3:I-Invalid IV Bag
"KRN",8989.51,4694,2)
I X=1!(X=2) W !!?5,"The recommended response for this parameter is 3  I-Invalid IV Bag.",!
"KRN",8989.51,4694,6)
S^1:A;2:P;3:H;4:S;5:C
"KRN",8989.51,4694,30,0)
^8989.513I^1^1
"KRN",8989.51,4694,30,1,0)
1^4
"KRN",8989.51,4695,-1)
0^64
"KRN",8989.51,4695,0)
PSBIV SCHEDULE^IV Schedule^1^IV Type^IV Schedule^0
"KRN",8989.51,4695,1)
S^1:W-Display Warning Message;2:N-NO Warning Message;3:I-Invalid IV Bag
"KRN",8989.51,4695,2)
I X=1!(X=2) W !!?5,"The recommended response for this parameter is 3  I-Invalid IV Bag.",!
"KRN",8989.51,4695,6)
S^1:A;2:P;3:H;4:S;5:C
"KRN",8989.51,4695,30,0)
^8989.513I^1^1
"KRN",8989.51,4695,30,1,0)
1^4
"KRN",8989.51,4696,-1)
0^65
"KRN",8989.51,4696,0)
PSBIV SOLUTION^IV Solution^1^IV Type^IV Solution^0
"KRN",8989.51,4696,1)
S^1:W-Display Warning Message;2:N-NO Warning Message;3:I-Invalid IV Bag
"KRN",8989.51,4696,2)
I X=1!(X=2) W !!?5,"The recommended response for this parameter is 3  I-Invalid IV Bag.",!
"KRN",8989.51,4696,6)
S^1:A;2:P;3:H;4:S;5:C
"KRN",8989.51,4696,30,0)
^8989.513I^1^1
"KRN",8989.51,4696,30,1,0)
1^4
"KRN",8989.51,4697,-1)
0^66
"KRN",8989.51,4697,0)
PSBIV START DATE/TIME^IV Start Date/Time^1^IV Type^IV Start Date/Time^0
"KRN",8989.51,4697,1)
S^1:W-Display Warning Message;2:N-NO Warning Message;3:I-Invalid IV Bag
"KRN",8989.51,4697,2)
I X=1!(X=2) W !!?5,"The recommended response for this parameter is 3  I-Invalid IV Bag.",!
"KRN",8989.51,4697,6)
S^1:A;2:P;3:H;4:S;5:C
"KRN",8989.51,4697,30,0)
^8989.513I^1^1
"KRN",8989.51,4697,30,1,0)
1^4
"KRN",8989.51,4698,-1)
0^67
"KRN",8989.51,4698,0)
PSBIV STOP DATE/TIME^IV Stop Date/Time^1^IV Type^IV Stop Date/Time^0
"KRN",8989.51,4698,1)
S^1:W-Display Warning Message;2:N-NO Warning Message;3:I-Invalid IV Bag
"KRN",8989.51,4698,2)
I X=1!(X=2) W !!?5,"The recommended response for this parameter is 3  I-Invalid IV Bag.",!
"KRN",8989.51,4698,6)
S^1:A;2:P;3:H;4:S;5:C
"KRN",8989.51,4698,30,0)
^8989.513I^1^1
"KRN",8989.51,4698,30,1,0)
1^4
"KRN",8989.51,4699,-1)
0^68
"KRN",8989.51,4699,0)
PSBIV STRENGTH^IV Strength^1^IV Type^IV Strength^0
"KRN",8989.51,4699,1)
S^1:W-Display Warning Message;2:N-NO Warning Message;3:I-Invalid IV Bag
"KRN",8989.51,4699,2)
I X=1!(X=2) W !!?5,"The recommended response for this parameter is 3  I-Invalid IV Bag.",!
"KRN",8989.51,4699,6)
S^1:A;2:P;3:H;4:S;5:C
"KRN",8989.51,4699,30,0)
^8989.513I^1^1
"KRN",8989.51,4699,30,1,0)
1^4
"KRN",8989.51,4700,-1)
0^69
"KRN",8989.51,4700,0)
PSBIV VOLUME^IV Volume^1^IV Type^IV Volume^0
"KRN",8989.51,4700,1)
S^1:W-Display Warning Message;2:N-NO Warning Message;3:I-Invalid IV Bag
"KRN",8989.51,4700,2)
I X=1!(X=2) W !!?5,"The recommended response for this parameter is 3  I-Invalid IV Bag.",!
"KRN",8989.51,4700,6)
S^1:A;2:P;3:H;4:S;5:C
"KRN",8989.51,4700,30,0)
^8989.513I^1^1
"KRN",8989.51,4700,30,1,0)
1^4
"KRN",8989.51,4711,-1)
0^57
"KRN",8989.51,4711,0)
PSBIV COLUMN WIDTH
"KRN",8989.51,4712,-1)
0^23
"KRN",8989.51,4712,0)
PSB IVPB COLUMN WIDTHS^IVPD display column widths^0^^IVPB COLUMN WIDTHS
"KRN",8989.51,4712,1)
F^^entry is made automatically based on changes to the IVPB columns
"KRN",8989.51,4712,20,0)
^^2^2^3010404^
"KRN",8989.51,4712,20,1,0)
This paramater is set by the users adjusting the IVPB column width
"KRN",8989.51,4712,20,2,0)
It is stored in the format nnn/nnn/nnn/nnn/nnn/nnn/nnn/nnn/nnn.
"KRN",8989.51,4712,30,0)
^8989.513I^1^1
"KRN",8989.51,4712,30,1,0)
1^200
"KRN",8989.51,4760,-1)
0^33
"KRN",8989.51,4760,0)
PSB PATIENT TRANSFER^Patient Transfer Notification Timeframe^0^^^0
"KRN",8989.51,4760,1)
N^2:99^Enter number of hours (2-99, 72 is default)
"KRN",8989.51,4760,20,0)
^^1^1^3030106^
"KRN",8989.51,4760,20,1,0)
This will store the number of hours for the Patient transfer notification timeframe on the BCMA Site Parameters screen.
"KRN",8989.51,4760,30,0)
^8989.513I^1^1
"KRN",8989.51,4760,30,1,0)
1^4
"KRN",8989.51,4763,-1)
0^17
"KRN",8989.51,4763,0)
PSB GUI DEFAULT PRINTER^Gui Default Report Device
"KRN",8989.51,4763,1)
F^1:50
"KRN",8989.51,4763,20,0)
^8989.512^1^1^3021205^^
"KRN",8989.51,4763,20,1,0)
Default device the user uses for printing BCMA reports from GUI.
"KRN",8989.51,4763,30,0)
^8989.513I^1^1
"KRN",8989.51,4763,30,1,0)
1^200
"KRN",8989.52,25,-1)
0^3
"KRN",8989.52,25,0)
PSB LIST REASONS GIVEN PRN^Reasons Given PRN^4
"KRN",8989.52,25,10,0)
^8989.521IA^1^1
"KRN",8989.52,25,10,1,0)
1^PSB LIST REASONS GIVEN PRN
"KRN",8989.52,36,-1)
0^4
"KRN",8989.52,36,0)
PSB LIST REASONS HELD^Reasons Held^4
"KRN",8989.52,36,10,0)
^8989.521IA^1^1
"KRN",8989.52,36,10,1,0)
1^PSB LIST REASONS HELD
"KRN",8989.52,37,-1)
0^5
"KRN",8989.52,37,0)
PSB LIST REASONS REFUSED^Reason Refused^4
"KRN",8989.52,37,10,0)
^8989.521IA^1^1
"KRN",8989.52,37,10,1,0)
1^PSB LIST REASONS REFUSED
"KRN",8989.52,38,-1)
0^1
"KRN",8989.52,38,0)
PSB DIVISION^BCMA Divisional Parameters^4
"KRN",8989.52,38,10,0)
^8989.521IA^32^27
"KRN",8989.52,38,10,1,0)
1^PSB ONLINE
"KRN",8989.52,38,10,6,0)
6^PSB ADMIN AFTER
"KRN",8989.52,38,10,7,0)
7^PSB ADMIN BEFORE
"KRN",8989.52,38,10,8,0)
8^PSB ADMIN ESIG
"KRN",8989.52,38,10,9,0)
9^PSB ADMIN MULTIPLE ONCALL
"KRN",8989.52,38,10,10,0)
10^PSB ADMIN PRN EFFECT
"KRN",8989.52,38,10,12,0)
12^PSB HFS SCRATCH
"KRN",8989.52,38,10,13,0)
13^PSB MG DUE LIST ERROR
"KRN",8989.52,38,10,14,0)
14^PSB MG MISSING DOSE
"KRN",8989.52,38,10,15,0)
15^PSB MG SYSTEM ERROR
"KRN",8989.52,38,10,16,0)
16^PSB PRINTER MISSING DOSE
"KRN",8989.52,38,10,17,0)
17^PSB SERVER CLOCK VARIANCE
"KRN",8989.52,38,10,18,0)
18^PSB VDL INCL BLANKS
"KRN",8989.52,38,10,19,0)
19^PSB VDL INCL CONT
"KRN",8989.52,38,10,20,0)
20^PSB VDL INCL IV MEDS
"KRN",8989.52,38,10,21,0)
21^PSB VDL INCL ON-CALL
"KRN",8989.52,38,10,22,0)
22^PSB VDL INCL ONE-TIME
"KRN",8989.52,38,10,23,0)
23^PSB VDL INCL PRN
"KRN",8989.52,38,10,24,0)
24^PSB VDL INCL UD MEDS
"KRN",8989.52,38,10,25,0)
25^PSB VDL START TIME
"KRN",8989.52,38,10,26,0)
26^PSB VDL STOP TIME
"KRN",8989.52,38,10,27,0)
2^PSB DEFAULT BARCODE FORMAT
"KRN",8989.52,38,10,28,0)
3^PSB DEFAULT BARCODE PREFIX
"KRN",8989.52,38,10,29,0)
4^PSB ROBOT RX
"KRN",8989.52,38,10,30,0)
27^PSB AUTOUPDATE SERVER
"KRN",8989.52,38,10,31,0)
28^PSB MG AUTOUPDATE
"KRN",8989.52,38,10,32,0)
29^PSBIV PROVIDER COMMENTS
"KRN",8989.52,39,-1)
0^2
"KRN",8989.52,39,0)
PSB LIST INJECTION SITES^Injection Sites^4
"KRN",8989.52,39,10,0)
^8989.521IA^1^1
"KRN",8989.52,39,10,1,0)
1^PSB LIST INJECTION SITES
"KRN",8989.52,44,-1)
0^6
"KRN",8989.52,44,0)
PSB ONE-TIME^ONE TIME PARAMETER^8930
"KRN",8994,677,-1)
0^24
"KRN",8994,677,0)
PSB SCANPT^SCANPT^PSBRPC^2^P^^^^2
"KRN",8994,677,1,0)
^8994.01^8^8^3030317^^^^
"KRN",8994,677,1,1,0)
This RPC is used to validate the data scanned in at the scan patient 
"KRN",8994,677,1,2,0)
wristband prompt of the mnOpenPatient component.  The value passed in 
"KRN",8994,677,1,3,0)
is either the full SSN scanned in from the patient wristband -or- the 
"KRN",8994,677,1,4,0)
1U4N syntax of the patient lookup.  In either case the call must 
"KRN",8994,677,1,5,0)
return only one patient from the lookup.  If the 1U4N syntax is used 
"KRN",8994,677,1,6,0)
and multiple patients are found the call returns an error.  If only 
"KRN",8994,677,1,7,0)
one patient is found the RESULTS( ) array is loaded with the patient 
"KRN",8994,677,1,8,0)
data and passed back to the client for verification.
"KRN",8994,677,2,0)
^8994.02A^1^1
"KRN",8994,677,2,1,0)
PSBDATA^1^^1^1
"KRN",8994,677,2,1,1,0)
^^1^1^3030314^
"KRN",8994,677,2,1,1,1,0)
This is the scanned valued passed by the client.
"KRN",8994,677,2,1,1,2,0)
wristband prompt of the mnOpenPatient component.  The value passed in
"KRN",8994,677,2,1,1,3,0)
is either the full SSN scanned in from the patient wristband -or- the
"KRN",8994,677,2,1,1,4,0)
1U4N syntax of the patient lookup.  In either case the call must
"KRN",8994,677,2,1,1,5,0)
return only one patient from the lookup.  If the 1U4N syntax is used
"KRN",8994,677,2,1,1,6,0)
and multiple patients are found the call returns an error.  If only
"KRN",8994,677,2,1,1,7,0)
one patient is found the RESULTS( ) array is loaded with the patient
"KRN",8994,677,2,1,1,8,0)
data and passed back to the client for verification.
"KRN",8994,677,2,"B","PSBDATA",1)

"KRN",8994,677,2,"B","PSBSSN",1)

"KRN",8994,677,2,"PARAMSEQ",1,1)

"KRN",8994,677,3,0)
^8994.03^27^27^3030314^^
"KRN",8994,677,3,1,0)
If no patient or multiple patients are found with the scan value an 
"KRN",8994,677,3,2,0)
error is returned in the following format:
"KRN",8994,677,3,3,0)
 
"KRN",8994,677,3,4,0)
   Results[0] = '-1^Unable to Determine Patient ID'
"KRN",8994,677,3,5,0)
 
"KRN",8994,677,3,6,0)
If a unique patient is found the following data is returned to the 
"KRN",8994,677,3,7,0)
user:
"KRN",8994,677,3,8,0)
 
"KRN",8994,677,3,9,0)
   Results[0]  = DFN
"KRN",8994,677,3,10,0)
   Results[1]  = Name
"KRN",8994,677,3,11,0)
   Results[2]  = SSN^Dashed SSN
"KRN",8994,677,3,12,0)
   Results[3]  = Internal DOB^External DOB
"KRN",8994,677,3,13,0)
   Results[4]  = Age
"KRN",8994,677,3,14,0)
   Results[5]  = Internal Sex^External Sex
"KRN",8994,677,3,15,0)
   Results[6]  = Internal Last Mvmt^External Last Mvmt
"KRN",8994,677,3,16,0)
   Results[7]  = Internal Type Mvmt^External Type Mvmt
"KRN",8994,677,3,17,0)
   Results[8]  = Internal Ward Location^External Ward Location
"KRN",8994,677,3,18,0)
   Results[9]  = Internal Bed Location^External Bed Location
"KRN",8994,677,3,19,0)
   Results[10] = Internal P-Care Physician^External P-Care Physician
"KRN",8994,677,3,20,0)
   Results[11] = Internal Treating Speciality^External Treating Speciality
"KRN",8994,677,3,21,0)
   Results[12] = Movement Diagnosis
"KRN",8994,677,3,22,0)
   Results[13] = 1 if in Bed Status 0 if not in Bed Status (i.e. Pass)
"KRN",8994,677,3,23,0)
   Results[14] = Expected return date from Pass
"KRN",8994,677,3,24,0)
   Results[15] = Reactions
"KRN",8994,677,3,25,0)
   Results[16] = Height
"KRN",8994,677,3,26,0)
   Results[17] = Weight
"KRN",8994,677,3,27,0)
   Results[18] = Means Tests
"KRN",8994,679,-1)
0^12
"KRN",8994,679,0)
PSB INSTRUCTOR^INST^PSBRPC^2^P^^^^2
"KRN",8994,679,1,0)
^8994.01^6^6^3031006^^
"KRN",8994,679,1,1,0)
Used by frmInstructor to validate that an instructor is at the client 
"KRN",8994,679,1,2,0)
with a student.  Validation is acheived via the instructor entering 
"KRN",8994,679,1,3,0)
their SSN and electronic signature code.  This is then validated 
"KRN",8994,679,1,4,0)
against the NEW PERSON file (#200).  If a valid user is obtained, 
"KRN",8994,679,1,5,0)
that user must posses the PSB INSTRUCTOR key to be passed back as an 
"KRN",8994,679,1,6,0)
eligible instructor for the student.
"KRN",8994,679,2,0)
^8994.02A^2^2
"KRN",8994,679,2,1,0)
PSBACC^1^^1^1
"KRN",8994,679,2,1,1,0)
^^1^1^3030318^
"KRN",8994,679,2,1,1,1,0)
Access Code 
"KRN",8994,679,2,1,1,2,0)
edtSSN component on frmInstructor.
"KRN",8994,679,2,2,0)
PSBVER^^^1^2
"KRN",8994,679,2,2,1,0)
^^1^1^3030318^
"KRN",8994,679,2,2,1,1,0)
Verify Code
"KRN",8994,679,2,2,1,2,0)
instructor into the edtESIG component on frmInstructor.
"KRN",8994,679,2,"B","IESIG",2)

"KRN",8994,679,2,"B","ISSN",1)

"KRN",8994,679,2,"B","PSBACC",1)

"KRN",8994,679,2,"B","PSBVER",2)

"KRN",8994,679,2,"PARAMSEQ",1,1)

"KRN",8994,679,2,"PARAMSEQ",2,2)

"KRN",8994,679,3,0)
^^12^12^3030318^
"KRN",8994,679,3,1,0)
Results array is returned in the following forms:
"KRN",8994,679,3,2,0)
 
"KRN",8994,679,3,3,0)
Valid authorization of instructor.
"KRN",8994,679,3,4,0)
 
"KRN",8994,679,3,5,0)
    Results[0] = 'Instructors DUZ^Instructors Name'
"KRN",8994,679,3,6,0)
 
"KRN",8994,679,3,7,0)
Invalid authorization of instructor.
"KRN",8994,679,3,8,0)
 
"KRN",8994,679,3,9,0)
    Results[0] = '-1^Invalid Instructor Access'
"KRN",8994,679,3,10,0)
 
"KRN",8994,679,3,11,0)
Success of the call is validated by the first up-arrow piece of data 
"KRN",8994,679,3,12,0)
being greater than 0.
"KRN",8994,680,-1)
0^28
"KRN",8994,680,0)
PSB USERLOAD^USRLOAD^PSBRPC^2^P^^^^2
"KRN",8994,680,1,0)
^8994.01^3^3^3030318^^^^
"KRN",8994,680,1,1,0)
This RPC is called at application startup to populate the BCMA_User 
"KRN",8994,680,1,2,0)
object with the users defaults.  No paramters are passed, the current 
"KRN",8994,680,1,3,0)
DUZ is assumed.
"KRN",8994,680,3,0)
^8994.03^26^26^3030318^^^^
"KRN",8994,680,3,1,0)
(0) = -1^Error Description
"KRN",8994,680,3,2,0)
 
"KRN",8994,680,3,3,0)
or
"KRN",8994,680,3,4,0)
 
"KRN",8994,680,3,5,0)
(0) = DUZ
"KRN",8994,680,3,6,0)
(1) = User name
"KRN",8994,680,3,7,0)
(2) = Student Key Flag
"KRN",8994,680,3,8,0)
(3) = Manager Key flag
"KRN",8994,680,3,9,0)
(4) = CPRS Med Order Button Key Flag     
"KRN",8994,680,3,10,0)
(5) = Window settings
"KRN",8994,680,3,11,0)
      Window Left
"KRN",8994,680,3,12,0)
      Window Height
"KRN",8994,680,3,13,0)
      Window Top
"KRN",8994,680,3,14,0)
      Window Width
"KRN",8994,680,3,15,0)
(6) = Virtual Due List Setup
"KRN",8994,680,3,16,0)
(7) = Division number
"KRN",8994,680,3,17,0)
(8) = Division name
"KRN",8994,680,3,18,0)
(9) = ESIG flag 
"KRN",8994,680,3,19,0)
(10) = BCMA Online flag
"KRN",8994,680,3,20,0)
(11) = Time      
"KRN",8994,680,3,21,0)
(12) = Unit Dose column widths
"KRN",8994,680,3,22,0)
(13) = Check digit
"KRN",8994,680,3,23,0)
(14) = IVPB column widths
"KRN",8994,680,3,24,0)
(15) = IV column widths
"KRN",8994,680,3,25,0)
(16) = Printer user default IEN
"KRN",8994,680,3,26,0)
(17) = Printer user default IEN^Name           
"KRN",8994,681,-1)
0^29
"KRN",8994,681,0)
PSB USERSAVE^USRSAVE^PSBRPC^2^^^^^2
"KRN",8994,681,1,0)
^8994.01^1^1^3010910^^^
"KRN",8994,681,1,1,0)
Save the users current window settings for the next session.
"KRN",8994,681,2,0)
^8994.02A^6^6
"KRN",8994,681,2,1,0)
PSBWIN^1^30^1^1
"KRN",8994,681,2,1,1,0)
^8994.021^6^6^3010910^^^^
"KRN",8994,681,2,1,1,1,0)
Contains the current window settings so that the next time the user 
"KRN",8994,681,2,1,1,2,0)
activates the application the window will reappear in the same format.
"KRN",8994,681,2,1,1,3,0)

"KRN",8994,681,2,1,1,4,0)
Data is in the following format:
"KRN",8994,681,2,1,1,5,0)

"KRN",8994,681,2,1,1,6,0)
   Window Top;Window Left;Window Height;Window Width;Window State
"KRN",8994,681,2,2,0)
PSBVDL^1^^1^2
"KRN",8994,681,2,2,1,0)
^^1^1^3010910^
"KRN",8994,681,2,2,1,1,0)
VDL settings
"KRN",8994,681,2,3,0)
PSBUDCW ^1^^1^3
"KRN",8994,681,2,3,1,0)
^^1^1^3010910^
"KRN",8994,681,2,3,1,1,0)
UD tab column settings
"KRN",8994,681,2,4,0)
PSBPBCW^1^^1^4
"KRN",8994,681,2,4,1,0)
^^1^1^3010910^
"KRN",8994,681,2,4,1,1,0)
PB tab column settings 
"KRN",8994,681,2,5,0)
PSBIVCW^1^^1^5
"KRN",8994,681,2,5,1,0)
^^1^1^3010910^
"KRN",8994,681,2,5,1,1,0)
IV tab column settings   
"KRN",8994,681,2,6,0)
PSBDEV^1^^1^6
"KRN",8994,681,2,6,1,0)
^^1^1^3010910^
"KRN",8994,681,2,6,1,1,0)
Last print device used.
"KRN",8994,681,2,"B","PSBDEV",6)

"KRN",8994,681,2,"B","PSBIVCW",5)

"KRN",8994,681,2,"B","PSBPBCW",4)

"KRN",8994,681,2,"B","PSBUDCW ",3)

"KRN",8994,681,2,"B","PSBVDL",2)

"KRN",8994,681,2,"B","PSBWIN",1)

"KRN",8994,681,2,"PARAMSEQ",1,1)

"KRN",8994,681,2,"PARAMSEQ",2,2)

"KRN",8994,681,2,"PARAMSEQ",3,3)

"KRN",8994,681,2,"PARAMSEQ",4,4)

"KRN",8994,681,2,"PARAMSEQ",5,5)

"KRN",8994,681,2,"PARAMSEQ",6,6)

"KRN",8994,681,3,0)
^8994.03^4^4^3010910^^^
"KRN",8994,681,3,1,0)
Returns
"KRN",8994,681,3,2,0)

"KRN",8994,681,3,3,0)
  Results[0]='1^Saved'
"KRN",8994,681,3,4,0)
  Results[0]='-1^Unable to save settings' if an error occurs in filing.
"KRN",8994,682,-1)
0^7
"KRN",8994,682,0)
PSB FMDATE^FMDATE^PSBRPC^2^P^^^^2
"KRN",8994,682,1,0)
^8994.01^1^1^3031006^^^^
"KRN",8994,682,1,1,0)
Used to validate Fileman dates.
"KRN",8994,682,2,0)
^8994.02A^1^1
"KRN",8994,682,2,1,0)
PSBVAL^1^30^1^1
"KRN",8994,682,2,1,1,0)
^8994.021^1^1^3030317^^^^
"KRN",8994,682,2,1,1,1,0)
The user supplied input for a date.
"KRN",8994,682,2,"B","PSBVAL",1)

"KRN",8994,682,2,"PARAMSEQ",1,1)

"KRN",8994,682,3,0)
^8994.03^7^7^3030317^^^^
"KRN",8994,682,3,1,0)
If validation fails the following is returned to the client:
"KRN",8994,682,3,2,0)

"KRN",8994,682,3,3,0)
  Results[0]   = '-1^Validation Falure'
"KRN",8994,682,3,4,0)

"KRN",8994,682,3,5,0)
If validation is successful the following is returned to the client:
"KRN",8994,682,3,6,0)

"KRN",8994,682,3,7,0)
  Results[0] = internal FM Date/Time^External FM Date/Time
"KRN",8994,684,-1)
0^23
"KRN",8994,684,0)
PSB SCANMED^SCANMED^PSBRPC2^2^P^^^^2
"KRN",8994,684,1,0)
^8994.01^3^3^3030317^^^^
"KRN",8994,684,1,1,0)
Takes the scanned valued from the medication and does a lookup on file 
"KRN",8994,684,1,2,0)
50 for an exact match.  If more than one or less than one entry are 
"KRN",8994,684,1,3,0)
found for the lookup an error is returned to the client.
"KRN",8994,684,2,0)
^8994.02A^3^2
"KRN",8994,684,2,1,0)
SCANVAL^1^30^1^1
"KRN",8994,684,2,1,1,0)
^^1^1^2990216^
"KRN",8994,684,2,1,1,1,0)
This is the data received from the client scanning the medication.
"KRN",8994,684,2,2,0)
PSBDIEN^1^^1^1
"KRN",8994,684,2,2,1,0)
^8994.021^3^3^3030312^^
"KRN",8994,684,2,2,1,1,0)
Takes the scanned valued from the medication and does a lookup on file
"KRN",8994,684,2,2,1,2,0)
50 for an exact match.  If more than one or less than one entry are
"KRN",8994,684,2,2,1,3,0)
found for the lookup an error is returned to the client.
"KRN",8994,684,2,3,0)
PSBTAB^1^20^1^2
"KRN",8994,684,2,3,1,0)
^8994.021^1^1^3030317^^^^
"KRN",8994,684,2,3,1,1,0)
This is the current tab the user is on.
"KRN",8994,684,2,"B","PSBDIEN",2)

"KRN",8994,684,2,"B","PSBTAB",3)

"KRN",8994,684,2,"B","SCANVAL",1)

"KRN",8994,684,2,"PARAMSEQ",1,1)

"KRN",8994,684,2,"PARAMSEQ",1,2)

"KRN",8994,684,2,"PARAMSEQ",2,3)

"KRN",8994,684,3,0)
^^10^10^3030317^
"KRN",8994,684,3,1,0)
Return on error:
"KRN",8994,684,3,2,0)
 
"KRN",8994,684,3,3,0)
  Results[0] = '-1^Unable to determine exact medication'
"KRN",8994,684,3,4,0)
 
"KRN",8994,684,3,5,0)
Return on successful scan:
"KRN",8994,684,3,6,0)
 
"KRN",8994,684,3,7,0)
  Results[0] = number of items returned in the results array.
"KRN",8994,684,3,8,0)
  Results[1] = DD^IEN^Generic Name
"KRN",8994,684,3,9,0)
               SOL^IEN^Generic Name
"KRN",8994,684,3,10,0)
               ADD^IEN^Generic Name
"KRN",8994,685,-1)
0^20
"KRN",8994,685,0)
PSB PARAMETER^RPC^PSBPAR^2^P^^^^2
"KRN",8994,685,1,0)
^8994.01^1^1^3040127^^^^
"KRN",8994,685,1,1,0)
Called by client to return or set parameters
"KRN",8994,685,2,0)
^8994.02A^5^5
"KRN",8994,685,2,1,0)
PSBCMD^1^6^1^1
"KRN",8994,685,2,1,1,0)
^8994.021^6^6^3030728^^^^
"KRN",8994,685,2,1,1,1,0)
Contains the command to perform against the system parameters.
"KRN",8994,685,2,1,1,2,0)

"KRN",8994,685,2,1,1,3,0)
GETPAR: Get a single instance of a parameter
"KRN",8994,685,2,1,1,4,0)
GETLST: Get all instances of a multiple valued parameter
"KRN",8994,685,2,1,1,5,0)
SETPAR: Set a single instance of a parameter
"KRN",8994,685,2,1,1,6,0)
CLRLST: Clear all instances of parameters in a list
"KRN",8994,685,2,2,0)
PSBENT^1^30^1^2
"KRN",8994,685,2,2,1,0)
^8994.021^1^1^3030728^^^
"KRN",8994,685,2,2,1,1,0)
Contains the entity to act upon.  Usually "###;DIC(4," for division.
"KRN",8994,685,2,3,0)
PSBPAR^1^30^1^3
"KRN",8994,685,2,3,1,0)
^8994.021^1^1^3030728^^^
"KRN",8994,685,2,3,1,1,0)
The parameter as defined in file 8989.51.
"KRN",8994,685,2,4,0)
PSBINS^1^30^0^4
"KRN",8994,685,2,4,1,0)
^8994.021^1^1^3030728^^^
"KRN",8994,685,2,4,1,1,0)
The instance of the parameter that you want to return.  Defaults to 1.
"KRN",8994,685,2,5,0)
PSBVAL^1^80^0^5
"KRN",8994,685,2,5,1,0)
^8994.021^2^2^3040127^^^^
"KRN",8994,685,2,5,1,1,0)
If setting a parameter this contains the data value to place in the 
"KRN",8994,685,2,5,1,2,0)
parameter.
"KRN",8994,685,2,"B","PSBCMD",1)

"KRN",8994,685,2,"B","PSBENT",2)

"KRN",8994,685,2,"B","PSBINS",4)

"KRN",8994,685,2,"B","PSBPAR",3)

"KRN",8994,685,2,"B","PSBVAL",5)

"KRN",8994,685,2,"PARAMSEQ",1,1)

"KRN",8994,685,2,"PARAMSEQ",2,2)

"KRN",8994,685,2,"PARAMSEQ",3,3)

"KRN",8994,685,2,"PARAMSEQ",4,4)

"KRN",8994,685,2,"PARAMSEQ",5,5)

"KRN",8994,686,-1)
0^27
"KRN",8994,686,0)
PSB TRANSACTION^RPC^PSBML^2^P^^^^2
"KRN",8994,686,1,0)
^8994.01^98^98^3031114^^
"KRN",8994,686,1,1,0)
This is the filing RPC for all data returning from the client
"KRN",8994,686,1,2,0)
regarding the medication log.  Filing is handled by business rules on
"KRN",8994,686,1,3,0)
the server and this RPC will return either '1^Data Filed' or
"KRN",8994,686,1,4,0)
'-1^reason for not filing data' to the client. 
"KRN",8994,686,1,5,0)
 
"KRN",8994,686,1,6,0)
Business rules are conducted via the [0] node data.  If a '+1^MEDPASS'
"KRN",8994,686,1,7,0)
is encountered it is a complete new med pass and is validated as such.
"KRN",8994,686,1,8,0)
Transaction type MEDPASS is the only type that requires a +1 in the 
"KRN",8994,686,1,9,0)
first piece of the header, all other transactions MUST supply a valid 
"KRN",8994,686,1,10,0)
medication log entry in the IENS.
"KRN",8994,686,1,11,0)
 
"KRN",8994,686,1,12,0)
The data for filing is passed in as a list in Param[1] as shown below.
"KRN",8994,686,1,13,0)
 
"KRN",8994,686,1,14,0)
Example Delphi Call
"KRN",8994,686,1,15,0)
 
"KRN",8994,686,1,16,0)
  with RPCBroker1 do
"KRN",8994,686,1,17,0)
    begin
"KRN",8994,686,1,18,0)
    RemoteProcedure := 'PSB TRANSACTION';
"KRN",8994,686,1,19,0)
    Param[0].Value := '88484^COMMENT';
"KRN",8994,686,1,20,0)
    Param[0].PType := Literal;
"KRN",8994,686,1,21,0)
    Param[1].Mult['0'] := 'Comment for the med pass';
"KRN",8994,686,1,22,0)
    Param[1].Ptype := List;
"KRN",8994,686,1,23,0)
    Call;
"KRN",8994,686,1,24,0)
    end;
"KRN",8994,686,1,25,0)
 
"KRN",8994,686,1,26,0)
-------------------------------------------------------------------------
"KRN",8994,686,1,27,0)
TRANSACTION = MEDPASS
"KRN",8994,686,1,28,0)
   Note: Entries 1-6 are required, 7,8,9 are required depending on 
"KRN",8994,686,1,29,0)
         item [2] order type...
"KRN",8994,686,1,30,0)
 
"KRN",8994,686,1,31,0)
 [0] = Patient IEN
"KRN",8994,686,1,32,0)
 
"KRN",8994,686,1,33,0)
 [1] = IV/Unit Dose Order Number
"KRN",8994,686,1,34,0)
   Note: will be passed in as I;#### for IV and U;#### for Unit Dose
"KRN",8994,686,1,35,0)
         future release will allow P;#### for pending
"KRN",8994,686,1,36,0)
 
"KRN",8994,686,1,37,0)
 [2] = Schedule
"KRN",8994,686,1,38,0)
   Note: C:Continuous P:PRN 1:One Time O:On Call
"KRN",8994,686,1,39,0)
 
"KRN",8994,686,1,40,0)
 [3] = Status
"KRN",8994,686,1,41,0)
   Note: G:Given H:Held R:Refused
"KRN",8994,686,1,42,0)
 
"KRN",8994,686,1,43,0)
 [4] = Orderable Item
"KRN",8994,686,1,44,0)
   Note: IEN to 'PHARMACY ORDERABLE ITEM' (#50.7)
"KRN",8994,686,1,45,0)
 
"KRN",8994,686,1,46,0)
 [5] = Scheduled Administration Date/Time
"KRN",8994,686,1,47,0)
   Note: This is when the med is scheduled, med is entered as GIVEN NOW!
"KRN",8994,686,1,48,0)
 
"KRN",8994,686,1,49,0)
 [6] = Reason Given PRN^PRN Reason Flag
"KRN",8994,686,1,50,0)
   Note: Required if given PRN must be null if not PRN
"KRN",8994,686,1,51,0)
 
"KRN",8994,686,1,52,0)
 [7] = Comment
"KRN",8994,686,1,53,0)
   Note: 1-200 characters
"KRN",8994,686,1,54,0)
 
"KRN",8994,686,1,55,0)
 [8] = Injection Site
"KRN",8994,686,1,56,0)
 [9] = Tab^Unique ID #
"KRN",8994,686,1,57,0)
 
"KRN",8994,686,1,58,0)
 [10..n]= RecordType^IEN^Units Ordered^Units Given^Units Type
"KRN",8994,686,1,59,0)
 
"KRN",8994,686,1,60,0)
          Record Type = DD:  Dispense Drug
"KRN",8994,686,1,61,0)
                        SOL: Solution
"KRN",8994,686,1,62,0)
                        ADD: Additive
"KRN",8994,686,1,63,0)
 
"KRN",8994,686,1,64,0)
          IEN = Internal Entry Number of the following
"KRN",8994,686,1,65,0)
                if Record Type = DD:  DRUG (FILE #50)  
"KRN",8994,686,1,66,0)
                                SOL: IV SOLUTIONS (FILE #??)
"KRN",8994,686,1,67,0)
                                ADD: IV ADDITIVES (FILE #??)
"KRN",8994,686,1,68,0)
 
"KRN",8994,686,1,69,0)
          Units Ordered = Number of units in the Inpt Meds Order
"KRN",8994,686,1,70,0)
 
"KRN",8994,686,1,71,0)
          Units Given = Number of units scanned/entered by the user
"KRN",8994,686,1,72,0)
 
"KRN",8994,686,1,73,0)
          Units Type = Type of administration unit (i.e. TAB, CAPLET, ML)
"KRN",8994,686,1,74,0)
 
"KRN",8994,686,1,75,0)
-------------------------------------------------------------------------
"KRN",8994,686,1,76,0)
TRANSACTION = COMMENT
"KRN",8994,686,1,77,0)
 
"KRN",8994,686,1,78,0)
 [0] = Comment to append to the log entry
"KRN",8994,686,1,79,0)
   Note: Will be appended to the log with user ien and NOW as a date
"KRN",8994,686,1,80,0)
 
"KRN",8994,686,1,81,0)
-------------------------------------------------------------------------
"KRN",8994,686,1,82,0)
TRANSACTION = PRN EFFECTIVENESS
"KRN",8994,686,1,83,0)
 
"KRN",8994,686,1,84,0)
 [0] = Effective Comment
"KRN",8994,686,1,85,0)
   Note: will be filed as entered now by current user
"KRN",8994,686,1,86,0)
 
"KRN",8994,686,1,87,0)
-------------------------------------------------------------------------
"KRN",8994,686,1,88,0)
TRANSACTION = STATUS UPDATE
"KRN",8994,686,1,89,0)
 
"KRN",8994,686,1,90,0)
 [0] = New Status
"KRN",8994,686,1,91,0)
   Note: If status is Given, Date/Time administered D/T will be set to NOW
"KRN",8994,686,1,92,0)
         If status is Held/Refused administered D/T will be set to null
"KRN",8994,686,1,93,0)
         Status on med log must be <> null to execute.
"KRN",8994,686,1,94,0)
         New status must NOT match current status or G will overwrite 
"KRN",8994,686,1,95,0)
         administration DT.
"KRN",8994,686,1,96,0)
 
"KRN",8994,686,1,97,0)
 [1] = Comment
"KRN",8994,686,1,98,0)
   Note: Comment *IS* Required
"KRN",8994,686,2,0)
^8994.02A^2^2
"KRN",8994,686,2,1,0)
PSBHDR^1^^1^1
"KRN",8994,686,2,1,1,0)
^^1^1^2990309^
"KRN",8994,686,2,1,1,1,0)
Contains the IEN or +1 up-arrow transaction.  See RPC description.
"KRN",8994,686,2,2,0)
PSBREC^2^^1^2
"KRN",8994,686,2,2,1,0)
^8994.021^1^1^3031114^^^^
"KRN",8994,686,2,2,1,1,0)
See description.
"KRN",8994,686,2,"B","PSBHDR",1)

"KRN",8994,686,2,"B","PSBREC",2)

"KRN",8994,686,2,"PARAMSEQ",1,1)

"KRN",8994,686,2,"PARAMSEQ",2,2)

"KRN",8994,686,3,0)
^8994.03^1^1^3031114^^^^
"KRN",8994,686,3,1,0)
See description.
"KRN",8994,687,-1)
0^31
"KRN",8994,687,0)
PSB VALIDATE ORDER^EN^PSBVDLVL^2^P^^^^2
"KRN",8994,687,2,0)
^8994.02A^10^10
"KRN",8994,687,2,1,0)
DFN^1^10^1^1
"KRN",8994,687,2,1,1,0)
^8994.021^1^1^3030318^^
"KRN",8994,687,2,1,1,1,0)
Patient IEN
"KRN",8994,687,2,2,0)
PSBIEN^1^^1^2
"KRN",8994,687,2,2,1,0)
^8994.021^1^1^3030728^^^
"KRN",8994,687,2,2,1,1,0)
Medication Order Number
"KRN",8994,687,2,3,0)
PSBTYPE^1^2^1^3
"KRN",8994,687,2,3,1,0)
^8994.021^4^4^3030728^^
"KRN",8994,687,2,3,1,1,0)
Order Type
"KRN",8994,687,2,3,1,2,0)
 
"KRN",8994,687,2,3,1,3,0)
U for unit dose order
"KRN",8994,687,2,3,1,4,0)
V for IV order
"KRN",8994,687,2,4,0)
PSBADMIN^1^^0^4
"KRN",8994,687,2,4,1,0)
^8994.021^1^1^3030728^^^
"KRN",8994,687,2,4,1,1,0)
Administration date/time, if one is present.
"KRN",8994,687,2,5,0)
PSBTAB^1^10^1^5
"KRN",8994,687,2,5,1,0)
^8994.021^1^1^3030728^^
"KRN",8994,687,2,5,1,1,0)
Medication tab the order is on.
"KRN",8994,687,2,6,0)
PSBUID^1^^1^6
"KRN",8994,687,2,6,1,0)
^8994.021^1^1^3030728^^
"KRN",8994,687,2,6,1,1,0)
The actual scan value.
"KRN",8994,687,2,7,0)
PSBASTS^1^^0^7
"KRN",8994,687,2,7,1,0)
^8994.021^1^1^3030728^^^^
"KRN",8994,687,2,7,1,1,0)
Current scan status of the VDL of the medication.
"KRN",8994,687,2,8,0)
PSBORSTS^1^^1^8
"KRN",8994,687,2,8,1,0)
^8994.021^1^1^3030728^^
"KRN",8994,687,2,8,1,1,0)
Current order status on the VDL>
"KRN",8994,687,2,9,0)
PSBRMV^^^0^9
"KRN",8994,687,2,9,1,0)
^8994.021^1^1^3030728^^^^
"KRN",8994,687,2,9,1,1,0)
Action the user is trying to take.
"KRN",8994,687,2,10,0)
psbdien
"KRN",8994,687,2,"B","DFN",1)

"KRN",8994,687,2,"B","PSBADMIN",4)

"KRN",8994,687,2,"B","PSBASTS",7)

"KRN",8994,687,2,"B","PSBIEN",2)

"KRN",8994,687,2,"B","PSBORSTS",8)

"KRN",8994,687,2,"B","PSBRMV",9)

"KRN",8994,687,2,"B","PSBTAB",5)

"KRN",8994,687,2,"B","PSBTYPE",3)

"KRN",8994,687,2,"B","PSBUID",6)

"KRN",8994,687,2,"B","psbdien",10)

"KRN",8994,687,2,"PARAMSEQ",1,1)

"KRN",8994,687,2,"PARAMSEQ",2,2)

"KRN",8994,687,2,"PARAMSEQ",3,3)

"KRN",8994,687,2,"PARAMSEQ",4,4)

"KRN",8994,687,2,"PARAMSEQ",5,5)

"KRN",8994,687,2,"PARAMSEQ",6,6)

"KRN",8994,687,2,"PARAMSEQ",7,7)

"KRN",8994,687,2,"PARAMSEQ",8,8)

"KRN",8994,687,2,"PARAMSEQ",9,9)

"KRN",8994,687,3,0)
^8994.03^21^21^3030728^^^^
"KRN",8994,687,3,1,0)
Results[0] = number of nodes
"KRN",8994,687,3,2,0)
 
"KRN",8994,687,3,3,0)
Results[0] = 1^Data Successfully Filed^Med Log IEN
"KRN",8994,687,3,4,0)
                       or
"KRN",8994,687,3,5,0)
               Message
"KRN",8994,687,3,6,0)
 
"KRN",8994,687,3,7,0)
            -1^Error message
"KRN",8994,687,3,8,0)
 
"KRN",8994,687,3,9,0)
 
"KRN",8994,687,3,10,0)
For PRN medication order:
"KRN",8994,687,3,11,0)
Results[0] = number of nodes
"KRN",8994,687,3,12,0)
 
"KRN",8994,687,3,13,0)
Results[1] = 1^Brief Adminstration History
"KRN",8994,687,3,14,0)
Results[2] = 1^ 1
"KRN",8994,687,3,15,0)
             2^ Admin date&time (Fileman format)
"KRN",8994,687,3,16,0)
             3^ Admin status
"KRN",8994,687,3,17,0)
             4^ Schedule Type
"KRN",8994,687,3,18,0)
             5^ Reason
"KRN",8994,687,3,19,0)
             6^ Injection site
"KRN",8994,687,3,20,0)
             7^ Doses given
"KRN",8994,687,3,21,0)
             8^ Unit of administration (free text)
"KRN",8994,688,-1)
0^25
"KRN",8994,688,0)
PSB SERVER CLOCK VARIANCE^CLOCK^PSBUTL^2^P^^^^2
"KRN",8994,688,1,0)
^8994.01^2^2^3030314^^
"KRN",8994,688,1,1,0)
Client date/time in external FileMan format. Returns the variance from the
"KRN",8994,688,1,2,0)
server to the client in minutes.
"KRN",8994,688,2,0)
^8994.02A^1^1
"KRN",8994,688,2,1,0)
PSBX^1^^1^1
"KRN",8994,688,2,1,1,0)
^8994.021^1^1^3030314^^
"KRN",8994,688,2,1,1,1,0)
Client date/time in external fileman format.
"KRN",8994,688,2,"B","CDATE",1)

"KRN",8994,688,2,"B","PSBX",1)

"KRN",8994,688,2,"PARAMSEQ",1,1)

"KRN",8994,688,3,0)
^8994.03^1^1^3030314^^
"KRN",8994,688,3,1,0)
A number in minutes.
"KRN",8994,690,-1)
0^17
"KRN",8994,690,0)
PSB MEDICATION HISTORY^HISTORY^PSBMLHS^4^P^^^1^2
"KRN",8994,690,1,0)
^8994.01^1^1^3031006^^^^
"KRN",8994,690,1,1,0)
Returns the history of a medication for a patient from the orderable item.
"KRN",8994,690,2,0)
^8994.02A^2^2
"KRN",8994,690,2,1,0)
DFN^1^^1^1
"KRN",8994,690,2,1,1,0)
^^1^1^3010907^
"KRN",8994,690,2,1,1,1,0)
Patient IEN number.
"KRN",8994,690,2,2,0)
PSBOI^1^^1^2
"KRN",8994,690,2,2,1,0)
^8994.021^1^1^3030728^^^
"KRN",8994,690,2,2,1,1,0)
Orderable Item #
"KRN",8994,690,2,"B","DFN",1)

"KRN",8994,690,2,"B","PSBOI",2)

"KRN",8994,690,2,"PARAMSEQ",1,1)

"KRN",8994,690,2,"PARAMSEQ",2,2)

"KRN",8994,690,3,0)
^8994.03^12^12^3030728^^
"KRN",8994,690,3,1,0)
Results[1] = Text "Medication Administration History"
"KRN",8994,690,3,2,0)
Results[2] = 
"KRN",8994,690,3,3,0)
Results[3] = Text "PATIENT:    " Patient Name
"KRN",8994,690,3,4,0)
Results[4] = Text "MEDICATION:"  Orderable Item Name
"KRN",8994,690,3,5,0)
Results[5] = 
"KRN",8994,690,3,6,0)
Results[6] = Text "Location  St Sch Administration Date Admin By  I
"KRN",8994,690,3,7,0)
njection Site"
"KRN",8994,690,3,8,0)
Results[7] = Text "Medication & Dosage"
"KRN",8994,690,3,9,0)
Results[8] =
"KRN",8994,690,3,10,0)
Results[9] = Location^Status^Schedule^Action date/time^Action by
"KRN",8994,690,3,11,0)
Results[10] = Medication^Dosage
"KRN",8994,690,3,12,0)
Results[11] = 
"KRN",8994,691,-1)
0^10
"KRN",8994,691,0)
PSB GETPRNS^GETPRNS^PSBPRN^4^P^^^1^2
"KRN",8994,691,1,0)
^8994.01^6^6^3031114^^
"KRN",8994,691,1,1,0)
Returns all administrations of a PRN order that have NOT had the PRN
"KRN",8994,691,1,2,0)
Effectiveness documented in the current admission or within the hours 
"KRN",8994,691,1,3,0)
defined in PRN documentation site parameter whichever is greater of the 
"KRN",8994,691,1,4,0)
two.  When the PRN medication is administered a flag is set based on the 
"KRN",8994,691,1,5,0)
given PRN Reason.  This flag will dictate whether BCMA will mandate a
"KRN",8994,691,1,6,0)
PAIN SCORE measurement with PRN documentation.
"KRN",8994,691,2,0)
^8994.02A^2^2
"KRN",8994,691,2,1,0)
DFN^1^^1^1
"KRN",8994,691,2,1,1,0)
^^1^1^3010907^
"KRN",8994,691,2,1,1,1,0)
Patient IEN number.
"KRN",8994,691,2,2,0)
PSBORD^1^^0^2
"KRN",8994,691,2,2,1,0)
^8994.021^5^5^3031114^^^^
"KRN",8994,691,2,2,1,1,0)
Order number from Inpatient Medications. If order number is passed then 
"KRN",8994,691,2,2,1,2,0)
returns all PRN effectiveness not documented for that order.
"KRN",8994,691,2,2,1,3,0)
 
"KRN",8994,691,2,2,1,4,0)
If order number is NOT passed, then returns all PRN effectiveness not 
"KRN",8994,691,2,2,1,5,0)
documented for that patient.
"KRN",8994,691,2,"B","DFN",1)

"KRN",8994,691,2,"B","PSBORD",2)

"KRN",8994,691,2,"PARAMSEQ",1,1)

"KRN",8994,691,2,"PARAMSEQ",2,2)

"KRN",8994,691,3,0)
^8994.03^17^17^3031114^^
"KRN",8994,691,3,1,0)
Results[0] = Number of Nodes.
"KRN",8994,691,3,2,0)
Results[1]= ^1  Med Log IEN
"KRN",8994,691,3,3,0)
            ^2  Patient IEN
"KRN",8994,691,3,4,0)
            ^3  Patient Location
"KRN",8994,691,3,5,0)
            ^4  Administration Date/Time (Fileman format)
"KRN",8994,691,3,6,0)
            ^5  Action By
"KRN",8994,691,3,7,0)
            ^6  Administration Medication
"KRN",8994,691,3,8,0)
            ^7  PRN Reason
"KRN",8994,691,3,9,0)
            ^8  Orderable item IEN
"KRN",8994,691,3,10,0)
            ^9  Order Number
"KRN",8994,691,3,11,0)
            ^10 PRN Reason Flag
"KRN",8994,691,3,12,0)
Results[2]= ^1  Special Instructions
"KRN",8994,691,3,13,0)
Results[3]= ^1  "DD/ADD/SOL"
"KRN",8994,691,3,14,0)
            ^2  Name of dispense drug/additive/solution
"KRN",8994,691,3,15,0)
            ^3  Dose given
"KRN",8994,691,3,16,0)
            ^4  Unit of administration (free text)
"KRN",8994,691,3,17,0)
Results[4]= ^1  "END"
"KRN",8994,692,-1)
0^22
"KRN",8994,692,0)
PSB REPORT^RPC^PSBO^4^P^^^1^2
"KRN",8994,692,1,0)
^8994.01^2^2^3040206^^^^
"KRN",8994,692,1,1,0)
Return the text for the specified report and the user has the option to 
"KRN",8994,692,1,2,0)
print the reports.
"KRN",8994,692,2,0)
^8994.02A^12^12
"KRN",8994,692,2,1,0)
PSBTYPE^1^2^1^1
"KRN",8994,692,2,1,1,0)
^8994.021^15^15^3030210^^^^
"KRN",8994,692,2,1,1,1,0)
Contains the character designation for the needed report
"KRN",8994,692,2,1,1,2,0)
DL: Due Lisgt
"KRN",8994,692,2,1,1,3,0)
MH: Medication Administration History
"KRN",8994,692,2,1,1,4,0)
ML: Medication Log
"KRN",8994,692,2,1,1,5,0)
WA: Ward Administration Times
"KRN",8994,692,2,1,1,6,0)
MM: Missed Medication
"KRN",8994,692,2,1,1,7,0)
PE: PRN Effectiveness
"KRN",8994,692,2,1,1,8,0)
PM: Patient Medication History
"KRN",8994,692,2,1,1,9,0)
WA: Ward Administration Times
"KRN",8994,692,2,1,1,10,0)
MV: Medication Variance Log
"KRN",8994,692,2,1,1,11,0)
BL: Bar Code Label
"KRN",8994,692,2,1,1,12,0)
MD: Missing Dose by Ward
"KRN",8994,692,2,1,1,13,0)
AL: Allergy Request
"KRN",8994,692,2,1,1,14,0)
PI: Patient Inquiry
"KRN",8994,692,2,1,1,15,0)
DO: Display Order
"KRN",8994,692,2,2,0)
PSBDFN^1^10^1^2
"KRN",8994,692,2,2,1,0)
^8994.021^1^1^3030317^^
"KRN",8994,692,2,2,1,1,0)
Patient IEN
"KRN",8994,692,2,3,0)
PSBSTRT^1^20^1^3
"KRN",8994,692,2,3,1,0)
^^1^1^3011127^
"KRN",8994,692,2,3,1,1,0)
Internal Fileman Start Date/Time
"KRN",8994,692,2,4,0)
PSBSTOP^1^20^1^4
"KRN",8994,692,2,4,1,0)
^^1^1^3011127^
"KRN",8994,692,2,4,1,1,0)
Fileman Stop Date/Time
"KRN",8994,692,2,5,0)
PSBINCL^1^1^1^5
"KRN",8994,692,2,5,1,0)
^8994.021^8^8^3020904^^^^
"KRN",8994,692,2,5,1,1,0)
Contains the parameters for a Due List in up-arrow pieces.
"KRN",8994,692,2,5,1,2,0)
 
"KRN",8994,692,2,5,1,3,0)
Piece   1: 1/0 Include Continuous Meds
"KRN",8994,692,2,5,1,4,0)
        2: 1/0 Include PRN Meds
"KRN",8994,692,2,5,1,5,0)
        3: 1/0 Include OnCall Meds
"KRN",8994,692,2,5,1,6,0)
        4: 1/0 Include OneTime Meds
"KRN",8994,692,2,5,1,7,0)
        5: 1/0 Include Comments
"KRN",8994,692,2,5,1,8,0)
        6: 1/0 Include Audits
"KRN",8994,692,2,5,1,9,0)
blanks at the end of the report.
"KRN",8994,692,2,6,0)
PSBDEV^1^30^0^6
"KRN",8994,692,2,6,1,0)
^^1^1^3011127^
"KRN",8994,692,2,6,1,1,0)
Contains the name of the device that the report prints to.
"KRN",8994,692,2,7,0)
PSBSORT^1^1^1^7
"KRN",8994,692,2,7,1,0)
^^1^1^3011127^
"KRN",8994,692,2,7,1,1,0)
Sorts the report by patient or by ward
"KRN",8994,692,2,8,0)
PSBOI^1^7^1^8
"KRN",8994,692,2,8,1,0)
^8994.021^1^1^3030210^^
"KRN",8994,692,2,8,1,1,0)
Order/Orderable Item number. 
"KRN",8994,692,2,9,0)
PSBWLOC^1^30^0^8
"KRN",8994,692,2,9,1,0)
^8994.021^1^1^3040206^^
"KRN",8994,692,2,9,1,1,0)
Ward Location 
"KRN",8994,692,2,10,0)
PSBWSORT^1^1^0^10
"KRN",8994,692,2,10,1,0)
^^2^2^3011127^
"KRN",8994,692,2,10,1,1,0)
Sort By Patient - "P"
"KRN",8994,692,2,10,1,2,0)
  or By Bed     - "B"
"KRN",8994,692,2,11,0)
PSBFUT^1^1^1^11
"KRN",8994,692,2,11,1,0)
^8994.021^6^6^3030326^^^^
"KRN",8994,692,2,11,1,1,0)
Contains the parameters for Due list in up-arrow pieces
"KRN",8994,692,2,11,1,2,0)
 
"KRN",8994,692,2,11,1,3,0)
Piece   1: 1/0 Include Blanks (Changes/Addendums)
"KRN",8994,692,2,11,1,4,0)
        2: 1/0 Include IV Meds
"KRN",8994,692,2,11,1,5,0)
        3: 1/0 Include Unit Dose Meds
"KRN",8994,692,2,11,1,6,0)
        4: 1/0 Include Future Orders
"KRN",8994,692,2,12,0)
PSBORDNUM^1^^^12
"KRN",8994,692,2,12,1,0)
^8994.021^7^7^3031209^^^^
"KRN",8994,692,2,12,1,1,0)
The PSBORDNUM is the pharmacy order number from the Inpatient Medications
"KRN",8994,692,2,12,1,2,0)
package.
"KRN",8994,692,2,12,1,3,0)
 
"KRN",8994,692,2,12,1,4,0)
Example: 10U or 10V
"KRN",8994,692,2,12,1,5,0)
 
"KRN",8994,692,2,12,1,6,0)
This order number is used to do a lookup of medications by orderable item 
"KRN",8994,692,2,12,1,7,0)
for the medication history report.
"KRN",8994,692,2,"B","PSBDEV",6)

"KRN",8994,692,2,"B","PSBDFN",2)

"KRN",8994,692,2,"B","PSBDL",5)

"KRN",8994,692,2,"B","PSBFUT",11)

"KRN",8994,692,2,"B","PSBINCL",5)

"KRN",8994,692,2,"B","PSBOI",8)

"KRN",8994,692,2,"B","PSBORDNUM",12)

"KRN",8994,692,2,"B","PSBSORT",7)

"KRN",8994,692,2,"B","PSBSTOP",4)

"KRN",8994,692,2,"B","PSBSTRT",3)

"KRN",8994,692,2,"B","PSBTYPE",1)

"KRN",8994,692,2,"B","PSBWLOC",9)

"KRN",8994,692,2,"B","PSBWSORT",10)

"KRN",8994,692,2,"PARAMSEQ",1,1)

"KRN",8994,692,2,"PARAMSEQ",2,2)

"KRN",8994,692,2,"PARAMSEQ",3,3)

"KRN",8994,692,2,"PARAMSEQ",4,4)

"KRN",8994,692,2,"PARAMSEQ",5,5)

"KRN",8994,692,2,"PARAMSEQ",6,6)

"KRN",8994,692,2,"PARAMSEQ",7,7)

"KRN",8994,692,2,"PARAMSEQ",8,8)

"KRN",8994,692,2,"PARAMSEQ",8,9)

"KRN",8994,692,2,"PARAMSEQ",10,10)

"KRN",8994,692,2,"PARAMSEQ",11,11)

"KRN",8994,692,2,"PARAMSEQ",12,12)

"KRN",8994,692,3,0)
^8994.03^1^1^3040206^^^^
"KRN",8994,692,3,1,0)
Text of report.
"KRN",8994,694,-1)
0^26
"KRN",8994,694,0)
PSB SUBMIT MISSING DOSE^RPC^PSBMD^2^P^^^1^2
"KRN",8994,694,1,0)
^8994.01^1^1^3030728^^^^
"KRN",8994,694,1,1,0)
Allows the client to submit a missing dose interactively.
"KRN",8994,694,2,0)
^8994.02A^9^9
"KRN",8994,694,2,1,0)
PSBDFN^1^^1^1
"KRN",8994,694,2,1,1,0)
^^1^1^3030319^
"KRN",8994,694,2,1,1,1,0)
Patient DFN (IEN)
"KRN",8994,694,2,2,0)
PSBDRUG^1^^1^2
"KRN",8994,694,2,2,1,0)
^8994.021^1^1^3030728^^
"KRN",8994,694,2,2,1,1,0)
This is the IEN of the drug from File #50.
"KRN",8994,694,2,3,0)
PSBDOSE^1^^^3
"KRN",8994,694,2,3,1,0)
^8994.021^1^1^3030728^^
"KRN",8994,694,2,3,1,1,0)
Dosage.
"KRN",8994,694,2,4,0)
PSBRSN^1^^0^4
"KRN",8994,694,2,4,1,0)
^8994.021^6^6^3030728^^
"KRN",8994,694,2,4,1,1,0)
Missing Dose reason.
"KRN",8994,694,2,4,1,2,0)
 
"KRN",8994,694,2,4,1,3,0)
INTERNALLY-STORED CODE: 1   WILL STAND FOR: DROPPED
"KRN",8994,694,2,4,1,4,0)
INTERNALLY-STORED CODE: 2   WILL STAND FOR: EMPTY PACKAGE
"KRN",8994,694,2,4,1,5,0)
INTERNALLY-STORED CODE: 3   WILL STAND FOR: NOT AVAILABLE
"KRN",8994,694,2,4,1,6,0)
INTERNALLY-STORED CODE: 4   WILL STAND FOR: WRONG DOSE/DRUG DELIVERED
"KRN",8994,694,2,5,0)
PSBADMIN^1^^0^5
"KRN",8994,694,2,5,1,0)
^8994.021^1^1^3030728^^
"KRN",8994,694,2,5,1,1,0)
Administration time of the medication.
"KRN",8994,694,2,6,0)
PSBNEED^1^^1^6
"KRN",8994,694,2,6,1,0)
^8994.021^1^1^3030728^^
"KRN",8994,694,2,6,1,1,0)
Needed date/time of the medication
"KRN",8994,694,2,7,0)
PSBUID^1^^0^7
"KRN",8994,694,2,7,1,0)
^8994.021^1^1^3030728^^
"KRN",8994,694,2,7,1,1,0)
Unique ID of an IV bag if it's an IV order.
"KRN",8994,694,2,8,0)
PSBON^1^^1^8
"KRN",8994,694,2,8,1,0)
^8994.021^1^1^3030728^^
"KRN",8994,694,2,8,1,1,0)
Order Number
"KRN",8994,694,2,9,0)
PSBSCHD^1^^0^9
"KRN",8994,694,2,9,1,0)
^8994.021^1^1^3030728^^
"KRN",8994,694,2,9,1,1,0)
Medication Schedule.
"KRN",8994,694,2,"B","PSBADMIN",5)

"KRN",8994,694,2,"B","PSBDFN",1)

"KRN",8994,694,2,"B","PSBDOSE",3)

"KRN",8994,694,2,"B","PSBDRUG",2)

"KRN",8994,694,2,"B","PSBNEED",6)

"KRN",8994,694,2,"B","PSBON",8)

"KRN",8994,694,2,"B","PSBRSN",4)

"KRN",8994,694,2,"B","PSBSCHD",9)

"KRN",8994,694,2,"B","PSBUID",7)

"KRN",8994,694,2,"PARAMSEQ",1,1)

"KRN",8994,694,2,"PARAMSEQ",2,2)

"KRN",8994,694,2,"PARAMSEQ",3,3)

"KRN",8994,694,2,"PARAMSEQ",4,4)

"KRN",8994,694,2,"PARAMSEQ",5,5)

"KRN",8994,694,2,"PARAMSEQ",6,6)

"KRN",8994,694,2,"PARAMSEQ",7,7)

"KRN",8994,694,2,"PARAMSEQ",8,8)

"KRN",8994,694,2,"PARAMSEQ",9,9)

"KRN",8994,694,3,0)
^8994.03^1^1^3030728^^^
"KRN",8994,694,3,1,0)
Results[0] = 1^Missing Dose Submitted^351
"KRN",8994,695,-1)
0^30
"KRN",8994,695,0)
PSB VALIDATE ESIG^ESIG^PSBRPC^2^P^^^^2
"KRN",8994,695,1,0)
^8994.01^1^1^3030318^^
"KRN",8994,695,1,1,0)
Validate the data in PSBESIG against the user currently signed on (DUZ)
"KRN",8994,695,2,0)
^8994.02A^1^1
"KRN",8994,695,2,1,0)
PSBESIG^1^^1^1
"KRN",8994,695,2,1,1,0)
^^1^1^3030318^
"KRN",8994,695,2,1,1,1,0)
Data typed in by the user, which validates the E-SIG.
"KRN",8994,695,2,"B","PSBESIG",1)

"KRN",8994,695,2,"PARAMSEQ",1,1)

"KRN",8994,695,3,0)
^8994.03^5^5^3030318^^
"KRN",8994,695,3,1,0)
(0)= -1 (1-n)= Error Description
"KRN",8994,695,3,2,0)
 
"KRN",8994,695,3,3,0)
or
"KRN",8994,695,3,4,0)
 
"KRN",8994,695,3,5,0)
(0)= 1^ESig Verified
"KRN",8994,697,-1)
0^4
"KRN",8994,697,0)
PSB CHECK SERVER^CHECK^PSBUTL^2^^^^^2
"KRN",8994,697,1,0)
^8994.01^1^1^3031006^^^^
"KRN",8994,697,1,1,0)
Returns -1 or 1 when checking for patches and build on the server.
"KRN",8994,697,2,0)
^8994.02A^2^2
"KRN",8994,697,2,1,0)
PSBWHAT^2^^1^1
"KRN",8994,697,2,1,1,0)
^8994.021^2^2^3030314^^^^
"KRN",8994,697,2,1,1,1,0)
B = Returns Build Version for packages by Namespace
"KRN",8994,697,2,1,1,2,0)
P = Returns if Patch is installed
"KRN",8994,697,2,2,0)
PSBDATA^2^^1^2
"KRN",8994,697,2,2,1,0)
^8994.021^1^1^3030314^^^^
"KRN",8994,697,2,2,1,1,0)
Build/Package namespace (i.e. PSB) or Patch Number
"KRN",8994,697,2,"B","PSBDATA",2)

"KRN",8994,697,2,"B","PSBWHAT",1)

"KRN",8994,697,2,"PARAMSEQ",1,1)

"KRN",8994,697,2,"PARAMSEQ",2,2)

"KRN",8994,697,3,0)
^8994.03^3^3^3030314^^^^
"KRN",8994,697,3,1,0)
(0)=   -1^Error Description                      
"KRN",8994,697,3,2,0)
OR
"KRN",8994,697,3,3,0)
(0)=   1^Successful
"KRN",8994,715,-1)
0^14
"KRN",8994,715,0)
PSB LOCK^LOCK^PSBRPC^2
"KRN",8994,715,1,0)
^8994.01^2^2^3010910^^
"KRN",8994,715,1,1,0)
LOCKING NO LONGER USED AS OF PATCH 7.  INCLUDED FOR BACKWARD COMPATABILITY
"KRN",8994,715,1,2,0)
WITH GUI.  CALL WILL BE REMOVED IN PATCH 8.
"KRN",8994,852,-1)
0^15
"KRN",8994,852,0)
PSB MAIL^RPC^PSBRPCXM^4^P^^^^2
"KRN",8994,852,1,0)
^8994.01^2^2^3020326^^^^
"KRN",8994,852,1,1,0)
A call is made that allows the GUI to send its' own formatted mail
"KRN",8994,852,1,2,0)
message.
"KRN",8994,852,2,0)
^8994.02A^2^2
"KRN",8994,852,2,1,0)
PSBCMD^1^30^1^1
"KRN",8994,852,2,1,1,0)
^8994.021^6^6^3010911^^
"KRN",8994,852,2,1,1,1,0)
The type of action being attempted:
"KRN",8994,852,2,1,1,2,0)
        "CREATE"
"KRN",8994,852,2,1,1,3,0)
        "APPEND"
"KRN",8994,852,2,1,1,4,0)
        "SUBJECT"
"KRN",8994,852,2,1,1,5,0)
        "SENDTO"
"KRN",8994,852,2,1,1,6,0)
        "EXECUTE"
"KRN",8994,852,2,2,0)
PSBDATA^4^80^1^2
"KRN",8994,852,2,2,1,0)
^8994.021^1^1^3010911^^^^
"KRN",8994,852,2,2,1,1,0)
The text to be acted on.
"KRN",8994,852,2,"B","PSBCMD",1)

"KRN",8994,852,2,"B","PSBDATA",2)

"KRN",8994,852,2,"PARAMSEQ",1,1)

"KRN",8994,852,2,"PARAMSEQ",2,2)

"KRN",8994,852,3,0)
^8994.03^1^1^3020326^^^^
"KRN",8994,852,3,1,0)
Various success or failure tags depending on action.
"KRN",8994,1054,-1)
0^16
"KRN",8994,1054,0)
PSB MAXDAYS^MAX^PSBRPC^2^P^^^1^2
"KRN",8994,1054,1,0)
^^2^2^3030314^
"KRN",8994,1054,1,1,0)
This RPC returns the maximum number of days a user can view or print the 
"KRN",8994,1054,1,2,0)
MAH report. This parameter is set using CPRS and is call ORRP BCMA MAH.
"KRN",8994,1223,-1)
0^9
"KRN",8994,1223,0)
PSB GETORDERTAB^RPC^PSBVDLTB^4^P^^^1^2
"KRN",8994,1223,1,0)
^8994.01^1^1^3040217^^^^
"KRN",8994,1223,1,1,0)
Gives the client VDL information for the specified patient and time frame.
"KRN",8994,1223,2,0)
^8994.02A^3^3
"KRN",8994,1223,2,1,0)
DFN^1^30^1^1
"KRN",8994,1223,2,1,1,0)
^8994.021^1^1^3030314^^^
"KRN",8994,1223,2,1,1,1,0)
The patient IEN from ^DPT.
"KRN",8994,1223,2,2,0)
VDL TAB^1^30^1^2
"KRN",8994,1223,2,2,1,0)
^8994.021^1^1^3010907^^
"KRN",8994,1223,2,2,1,1,0)
The tab from the VDL that is being requested.
"KRN",8994,1223,2,3,0)
VDL DATE^1^30^0^3
"KRN",8994,1223,2,3,1,0)
^8994.021^2^2^3040217^^^^
"KRN",8994,1223,2,3,1,1,0)
The date of the requested data.  If not passed then current date/time are
"KRN",8994,1223,2,3,1,2,0)
used.
"KRN",8994,1223,2,"B","DFN",1)

"KRN",8994,1223,2,"B","VDL DATE",3)

"KRN",8994,1223,2,"B","VDL TAB",2)

"KRN",8994,1223,2,"PARAMSEQ",1,1)

"KRN",8994,1223,2,"PARAMSEQ",2,2)

"KRN",8994,1223,2,"PARAMSEQ",3,3)

"KRN",8994,1223,3,0)
^8994.03^64^64^3040217^^^
"KRN",8994,1223,3,1,0)
 
"KRN",8994,1223,3,2,0)
If a valid list of orders are found they are returned in a block format
"KRN",8994,1223,3,3,0)
with the word 'END' delimiting orders/administrations.  Lines for
"KRN",8994,1223,3,4,0)
subequent block are numbered sequential.  They are not reset to 1 for each
"KRN",8994,1223,3,5,0)
block.
"KRN",8994,1223,3,6,0)
 
"KRN",8994,1223,3,7,0)
 
"KRN",8994,1223,3,8,0)
 
"KRN",8994,1223,3,9,0)
  Results[0] =  ^1      The number of lines returned(count)
"KRN",8994,1223,3,10,0)
  Results[1] =  ^1      Data for the Unit Dose tab (0=no, 1=yes)
"KRN",8994,1223,3,11,0)
                ^2      Data for the Piggy Back tab (0=no, 1=yes)
"KRN",8994,1223,3,12,0)
                ^3      Data for the IV tab (0=no, 1=yes)
"KRN",8994,1223,3,13,0)
                ^4      Transfer type if there was a patient movement
"KRN",8994,1223,3,14,0)
                ^5      Movement type if there was a patient movement
"KRN",8994,1223,3,15,0)
  Results[2] =  ^1      DFN
"KRN",8994,1223,3,16,0)
                ^2      ORDER NUMBER (20V)
"KRN",8994,1223,3,17,0)
                ^3      NUMERIC PORTION OF ORDER NUMBER (20)
"KRN",8994,1223,3,18,0)
                ^4      ALPHA PORTION OF ORDER NUMBER (V)
"KRN",8994,1223,3,19,0)
                ^5      SCHEDULE TYPE (prn/continuous)
"KRN",8994,1223,3,20,0)
                ^6      SCHEDULE (Q4H)
"KRN",8994,1223,3,21,0)
                ^7      SELF MED (SM or HSM)
"KRN",8994,1223,3,22,0)
                ^8      DRUG NAME
"KRN",8994,1223,3,23,0)
                ^9      DOSAGE/FLOW RATE
"KRN",8994,1223,3,24,0)
                ^10     MED ROUTE
"KRN",8994,1223,3,25,0)
                ^11     LAST ACTION DATE/TIME (FM format)
"KRN",8994,1223,3,26,0)
                ^12     MED LOG IEN (blank if no action)
"KRN",8994,1223,3,27,0)
                ^13     LAST ACTION STATUS (this entry)
"KRN",8994,1223,3,28,0)
 
"KRN",8994,1223,3,29,0)
                ^14     SCHEDULED ADMIN DATE/TIME
"KRN",8994,1223,3,30,0)
                ^15     ORDERABLE ITEM IEN (^ORD(101.43)
"KRN",8994,1223,3,31,0)
                ^16     INJECTABLE (0=no, 1=yes)
"KRN",8994,1223,3,32,0)
                ^17     VARIABLE DOSE (0=no, 1=yes)
"KRN",8994,1223,3,33,0)
                ^18     DOSEAGE FORM
"KRN",8994,1223,3,34,0)
                ^19     VERIFYING NURSE INITIALS (*** if none)
"KRN",8994,1223,3,35,0)
                ^20     LAST ACTION STATUS (whole order)
"KRN",8994,1223,3,36,0)
                ^21     ORDER START DATE/TIME (FM)
"KRN",8994,1223,3,37,0)
                ^22     ORDER STATUS
"KRN",8994,1223,3,38,0)
                ^23     UNIQUE ID OF BAG
"KRN",8994,1223,3,39,0)
                ^24     NURSES IEN
"KRN",8994,1223,3,40,0)
                ^25     TRANSACTION TYPE
"KRN",8994,1223,3,41,0)
  ^Results[2] = ^1      SPECIAL INSTRUCTIONS
"KRN",8994,1223,3,42,0)
  ^Results[n] =
"KRN",8994,1223,3,43,0)
   Dispense Drug  ^1     LITERAL "DD"
"KRN",8994,1223,3,44,0)
                  ^2     DISPENSE DRUG IEN
"KRN",8994,1223,3,45,0)
                  ^3     DISPENSE DRUG NAME
"KRN",8994,1223,3,46,0)
                  ^4     UNITS PER DOSE
"KRN",8994,1223,3,47,0)
                  ^5     INACTIVE DATE
"KRN",8994,1223,3,48,0)
  ^Results[n]
"KRN",8994,1223,3,49,0)
   Additive       ^1    LITERAL "ADD"
"KRN",8994,1223,3,50,0)
                  ^2    ADDITIVE IEN
"KRN",8994,1223,3,51,0)
                  ^3    ADDITIVE NAME
"KRN",8994,1223,3,52,0)
                  ^4    STRENGTH
"KRN",8994,1223,3,53,0)
                  ^5    BOTTLE
"KRN",8994,1223,3,54,0)
  ^Results[n]
"KRN",8994,1223,3,55,0)
   Solution       ^1    LITERAL "SOL"
"KRN",8994,1223,3,56,0)
                  ^2    SOLUTION IEN
"KRN",8994,1223,3,57,0)
                  ^3    SOLUTION NAME
"KRN",8994,1223,3,58,0)
                  ^4    VOLUME
"KRN",8994,1223,3,59,0)
  ^Results[n]
"KRN",8994,1223,3,60,0)
   ID list        ^1    LITERAL "ID"
"KRN",8994,1223,3,61,0)
                  ^2    ID NUMBER
"KRN",8994,1223,3,62,0)
                  ^3    ADDITIVE IEN
"KRN",8994,1223,3,63,0)
                  ^...  EACH ADDITIONAL ADDITIVE IEN
"KRN",8994,1223,3,64,0)
  ^Results[n]     ^1    LITERAL "END" TO INDICATE END OF BLOCK
"KRN",8994,1223,3,65,0)
                  ^2    ID NUMBER
"KRN",8994,1223,3,66,0)
                  ^3    ADDITIVE IEN
"KRN",8994,1223,3,67,0)
                  ^...  EACH ADDITIONAL ADDITIVE IEN
"KRN",8994,1223,3,68,0)
  ^Results[n]     ^1    LITERAL "END" TO INDICATE END OF BLOCK
"KRN",8994,1224,-1)
0^35
"KRN",8994,1224,0)
PSB WARDLIST^WLIST^PSBPARIV^4^P^^^1^2
"KRN",8994,1224,1,0)
^8994.01^4^4^3031006^^
"KRN",8994,1224,1,1,0)
Returns a list of active wards that are available
"KRN",8994,1224,1,2,0)
for the definition of IV parameters in the BCMA IV PARAMETERS file 53.66.
"KRN",8994,1224,1,3,0)
Wards already in file 53.66 are returned with the type of IV PARAMETERS
"KRN",8994,1224,1,4,0)
defined.
"KRN",8994,1224,2,0)
^8994.02A^1^1
"KRN",8994,1224,2,1,0)
PSBEDIV^1^10^1^1
"KRN",8994,1224,2,1,1,0)
^^1^1^3030317^
"KRN",8994,1224,2,1,1,1,0)
Division
"KRN",8994,1224,2,"B","PSBEDIV",1)

"KRN",8994,1224,2,"PARAMSEQ",1,1)

"KRN",8994,1224,3,0)
^8994.03^10^10^3030317^^^^
"KRN",8994,1224,3,1,0)
Results(0)      =       ^1 the number of wards returned
"KRN",8994,1224,3,2,0)
Results(1,2...) =       ^1 the ward name
"KRN",8994,1224,3,3,0)
                        ^2 "1" for BOLD (ward is defined in 53.66)
"KRN",8994,1224,3,4,0)
                           "0" for NOBOLD (ward is not in 53.66)
"KRN",8994,1224,3,5,0)
                        ^3 IEN number from file 53.66
"KRN",8994,1224,3,6,0)
                        ^4 "A" if Admixture parameters in 53.66
"KRN",8994,1224,3,7,0)
                        ^5 "C" if Chemo parameters in 53.66
"KRN",8994,1224,3,8,0)
                        ^6 "H" if Hyperal parameters in 53.66
"KRN",8994,1224,3,9,0)
                        ^7 "P" if Piggyback parameters in 53.66
"KRN",8994,1224,3,10,0)
                        ^8 "S" if Syringe parameters in 53.66
"KRN",8994,1225,-1)
0^8
"KRN",8994,1225,0)
PSB GETIVPAR^GETPAR^PSBPARIV^4^P^^^1^2
"KRN",8994,1225,1,0)
^8994.01^1^1^3031006^^^^
"KRN",8994,1225,1,1,0)
Returns the IV parameters by IV type, as defined for a ward in file 53.66.
"KRN",8994,1225,2,0)
^8994.02A^3^3
"KRN",8994,1225,2,1,0)
PSBWARD^1^10^1^1
"KRN",8994,1225,2,1,1,0)
^8994.021^1^1^3010907^^
"KRN",8994,1225,2,1,1,1,0)
The IEN of the ward from file 53.66 or the word 'ALL'.
"KRN",8994,1225,2,2,0)
PSBIVPT^1^1^1^2
"KRN",8994,1225,2,2,1,0)
^8994.021^5^5^3010907^^^^
"KRN",8994,1225,2,2,1,1,0)
The IV type - 'A' for Additive
"KRN",8994,1225,2,2,1,2,0)
              'P' for Piggyback
"KRN",8994,1225,2,2,1,3,0)
              'H' for Hyperal
"KRN",8994,1225,2,2,1,4,0)
              'C' for Chemo
"KRN",8994,1225,2,2,1,5,0)
              'S' for Syringe
"KRN",8994,1225,2,3,0)
PSBDIV^1^1^0^3
"KRN",8994,1225,2,3,1,0)
^8994.021^1^1^3030311^^
"KRN",8994,1225,2,3,1,1,0)
^1=IEN of division as in the Ward Location file (File #42)
"KRN",8994,1225,2,"B","PSBDIV",3)

"KRN",8994,1225,2,"B","PSBIVPT",2)

"KRN",8994,1225,2,"B","PSBWARD",1)

"KRN",8994,1225,2,"PARAMSEQ",1,1)

"KRN",8994,1225,2,"PARAMSEQ",2,2)

"KRN",8994,1225,2,"PARAMSEQ",3,3)

"KRN",8994,1225,3,0)
^8994.03^19^19^3030311^^^^
"KRN",8994,1225,3,1,0)
A delimited string with the IV type and the defined parameters.
"KRN",8994,1225,3,2,0)
1=Warning, 2=No Warning, 3=Invalid.
"KRN",8994,1225,3,3,0)
 
"KRN",8994,1225,3,4,0)
        ^1=IV type
"KRN",8994,1225,3,5,0)
        ^2=Additive
"KRN",8994,1225,3,6,0)
        ^3=Strength
"KRN",8994,1225,3,7,0)
        ^4=Bottle
"KRN",8994,1225,3,8,0)
        ^5=Solution
"KRN",8994,1225,3,9,0)
        ^6=Volume
"KRN",8994,1225,3,10,0)
        ^7=Infusion Rate
"KRN",8994,1225,3,11,0)
        ^8=Med Route
"KRN",8994,1225,3,12,0)
        ^9=Schedule
"KRN",8994,1225,3,13,0)
        ^10=Admin Time
"KRN",8994,1225,3,14,0)
        ^11=Remarks
"KRN",8994,1225,3,15,0)
        ^12=Other Print Info
"KRN",8994,1225,3,16,0)
        ^13=Provider
"KRN",8994,1225,3,17,0)
        ^14=Start Date/Time
"KRN",8994,1225,3,18,0)
        ^15=Stop Date/Time
"KRN",8994,1225,3,19,0)
        ^16=Provider Comments
"KRN",8994,1226,-1)
0^6
"KRN",8994,1226,0)
PSB DEVICE^DEVICE^PSBRPC1^2^^^^^2
"KRN",8994,1226,1,0)
^8994.01^1^1^3031023^^^^
"KRN",8994,1226,1,1,0)
Allows user to select a Printer from the GUI.
"KRN",8994,1226,2,0)
^8994.02A^2^2
"KRN",8994,1226,2,1,0)
FROM^1^^^1
"KRN",8994,1226,2,1,1,0)
^^1^1^3020925^
"KRN",8994,1226,2,1,1,1,0)
Text to $O from
"KRN",8994,1226,2,2,0)
DIR^1^1^^2
"KRN",8994,1226,2,2,1,0)
^8994.021^1^1^3031023^^^
"KRN",8994,1226,2,2,1,1,0)
$O Direction
"KRN",8994,1226,2,"B","DIR",2)

"KRN",8994,1226,2,"B","FROM",1)

"KRN",8994,1226,2,"PARAMSEQ",1,1)

"KRN",8994,1226,2,"PARAMSEQ",2,2)

"KRN",8994,1226,3,0)
^8994.03^1^1^3020925^^^^
"KRN",8994,1226,3,1,0)
Results(1)=IEN;Name^DisplayName^Location^RMargin^PLength
"KRN",8994,1227,-1)
0^21
"KRN",8994,1227,0)
PSB PUTIVPAR^PUTPAR^PSBPARIV^4^P^^^1^2
"KRN",8994,1227,1,0)
^8994.01^1^1^3030318^^^^
"KRN",8994,1227,1,1,0)
Sets 53.66 or parameters file w/input from 53.66 if ward is not "ALL"
"KRN",8994,1227,2,0)
^8994.02A^3^3
"KRN",8994,1227,2,1,0)
PSBWARD^1^1^1^1
"KRN",8994,1227,2,1,1,0)
^^2^2^3010912^
"KRN",8994,1227,2,1,1,1,0)
^1=Ward name
"KRN",8994,1227,2,1,1,2,0)
^2=IEN of ward as in file 53.66
"KRN",8994,1227,2,2,0)
PSBPARS^1^1^1^2
"KRN",8994,1227,2,2,1,0)
^8994.021^5^5^3030318^^
"KRN",8994,1227,2,2,1,1,0)
IV type - "A" for Additive
"KRN",8994,1227,2,2,1,2,0)
          "P" for Piggyback
"KRN",8994,1227,2,2,1,3,0)
          "H" for Hyperal
"KRN",8994,1227,2,2,1,4,0)
          "C" for Chemo
"KRN",8994,1227,2,2,1,5,0)
          "S" for Syringe
"KRN",8994,1227,2,2,1,6,0)
          "S" for Syringe
"KRN",8994,1227,2,2,1,7,0)
 
"KRN",8994,1227,2,2,1,8,0)
^2-^16 Setting
"KRN",8994,1227,2,2,1,9,0)
     1 for Warning
"KRN",8994,1227,2,2,1,10,0)
     2 for Non-Verify
"KRN",8994,1227,2,2,1,11,0)
     3 for Invalid
"KRN",8994,1227,2,3,0)
PSBDIV^1^1^0^3
"KRN",8994,1227,2,3,1,0)
^8994.021^1^1^3030318^^^^
"KRN",8994,1227,2,3,1,1,0)
^1=IEN of division as in the Ward Location file (File #42)
"KRN",8994,1227,2,"B","PSBDIV",3)

"KRN",8994,1227,2,"B","PSBPARS",2)

"KRN",8994,1227,2,"B","PSBWARD",1)

"KRN",8994,1227,2,"PARAMSEQ",1,1)

"KRN",8994,1227,2,"PARAMSEQ",2,2)

"KRN",8994,1227,2,"PARAMSEQ",3,3)

"KRN",8994,1227,3,0)
^8994.03^19^19^3030318^^^^
"KRN",8994,1227,3,1,0)
The IV type - "A" for Additive
"KRN",8994,1227,3,2,0)
              "P" for Piggyback
"KRN",8994,1227,3,3,0)
              "H" for Hyperal
"KRN",8994,1227,3,4,0)
              "C" for Chemo
"KRN",8994,1227,3,5,0)
              "S" for Syringe
"KRN",8994,1227,3,6,0)
^2=Additive
"KRN",8994,1227,3,7,0)
^3=Strength
"KRN",8994,1227,3,8,0)
^4=Bottle
"KRN",8994,1227,3,9,0)
^5=Solution
"KRN",8994,1227,3,10,0)
^6=Volume
"KRN",8994,1227,3,11,0)
^7=Infusion rate
"KRN",8994,1227,3,12,0)
^8=Med route
"KRN",8994,1227,3,13,0)
^9=Schedule
"KRN",8994,1227,3,14,0)
^10=Admin time
"KRN",8994,1227,3,15,0)
^11=Remarks
"KRN",8994,1227,3,16,0)
^12=Other Print Info
"KRN",8994,1227,3,17,0)
^13=Provider
"KRN",8994,1227,3,18,0)
^14=Start Date/time
"KRN",8994,1227,3,19,0)
^15=Provider comments
"KRN",8994,1228,-1)
0^13
"KRN",8994,1228,0)
PSB IV ORDER HISTORY^GETOHIST^PSBRPC2^4^P^^^1^2
"KRN",8994,1228,1,0)
^8994.01^1^1^3031006^^^^
"KRN",8994,1228,1,1,0)
Returns individual detailed bag history.
"KRN",8994,1228,2,0)
^8994.02A^2^2
"KRN",8994,1228,2,1,0)
DFN^1^^1^1
"KRN",8994,1228,2,1,1,0)
^^1^1^3010911^
"KRN",8994,1228,2,1,1,1,0)
Patients IEN number
"KRN",8994,1228,2,2,0)
PSBORD^1^^1^2
"KRN",8994,1228,2,2,1,0)
^8994.021^1^1^3030314^^^^
"KRN",8994,1228,2,2,1,1,0)
Order number from Inpatient Medications
"KRN",8994,1228,2,"B","DFN",1)

"KRN",8994,1228,2,"B","PSBORD",2)

"KRN",8994,1228,2,"PARAMSEQ",1,1)

"KRN",8994,1228,2,"PARAMSEQ",2,2)

"KRN",8994,1228,3,0)
^^42^42^3030314^
"KRN",8994,1228,3,1,0)
Results(0) is the total line count or "-1^No bags available for this 
"KRN",8994,1228,3,2,0)
order"
"KRN",8994,1228,3,3,0)
 
"KRN",8994,1228,3,4,0)
Starting at Results(1) each bag will generate varying numbers of lines 
"KRN",8994,1228,3,5,0)
depending on the number of additives and solutions.  Each bag is 
"KRN",8994,1228,3,6,0)
delimited by a line that consists only of the word "END".
"KRN",8994,1228,3,7,0)
 
"KRN",8994,1228,3,8,0)
The first line for a bag that has an entry in the med log indicating an 
"KRN",8994,1228,3,9,0)
action has been taken -
"KRN",8994,1228,3,10,0)
 
"KRN",8994,1228,3,11,0)
        Pharmacy order number
"KRN",8994,1228,3,12,0)
        Bags unique ID number
"KRN",8994,1228,3,13,0)
        The ien from the med log, File 53.79
"KRN",8994,1228,3,14,0)
        The date/time of the last action
"KRN",8994,1228,3,15,0)
        The status of the last action
"KRN",8994,1228,3,16,0)
        The injection site
"KRN",8994,1228,3,17,0)
 
"KRN",8994,1228,3,18,0)
The first line for a bag that has NO entry in the medlog
"KRN",8994,1228,3,19,0)
 
"KRN",8994,1228,3,20,0)
        Pharmacy order number
"KRN",8994,1228,3,21,0)
        Bags unique ID number
"KRN",8994,1228,3,22,0)
        null
"KRN",8994,1228,3,23,0)
        Current date
"KRN",8994,1228,3,24,0)
        Letter "A" (this indicates a status of Available)
"KRN",8994,1228,3,25,0)
 
"KRN",8994,1228,3,26,0)
For a bag from a prior order still available for use (passes IV 
"KRN",8994,1228,3,27,0)
parameters tests)
"KRN",8994,1228,3,28,0)
 
"KRN",8994,1228,3,29,0)
        Current pharmacy order number
"KRN",8994,1228,3,30,0)
        Bags unique ID number
"KRN",8994,1228,3,31,0)
        null
"KRN",8994,1228,3,32,0)
        Current date
"KRN",8994,1228,3,33,0)
        Letter "A" 
"KRN",8994,1228,3,34,0)
        Prior pharmacy order number
"KRN",8994,1228,3,35,0)
 
"KRN",8994,1228,3,36,0)
Additional line indicate additives and solutions first piece will be ADD 
"KRN",8994,1228,3,37,0)
for additive and SOL for solutions
"KRN",8994,1228,3,38,0)
 
"KRN",8994,1228,3,39,0)
        ADD or SOL
"KRN",8994,1228,3,40,0)
        IEN from the additives or solutions file
"KRN",8994,1228,3,41,0)
        Additive or solution name
"KRN",8994,1228,3,42,0)
        Dosage ordered
"KRN",8994,1229,-1)
0^2
"KRN",8994,1229,0)
PSB BAG DETAIL^BAGDTL^PSBRPC2^2^P^^^^2
"KRN",8994,1229,1,0)
^8994.01^8^8^3031006^^^^
"KRN",8994,1229,1,1,0)
Returns a chronological detailed history on each specific IV bag that is
"KRN",8994,1229,1,2,0)
selected.
"KRN",8994,1229,1,3,0)
 
"KRN",8994,1229,1,4,0)
 
"KRN",8994,1229,1,5,0)
[0] = -1^No History On File             
"KRN",8994,1229,1,6,0)
 
"KRN",8994,1229,1,7,0)
[0] = Number of Nodes
"KRN",8994,1229,1,8,0)
[1] = Action Date/Time^User ID^Action Status^Comments
"KRN",8994,1229,2,0)
^8994.02A^2^2
"KRN",8994,1229,2,1,0)
PSBUID^1^^1^1
"KRN",8994,1229,2,1,1,0)
^8994.021^1^1^3010907^^
"KRN",8994,1229,2,1,1,1,0)
IV unique ID number.
"KRN",8994,1229,2,2,0)
PSBORD^1^^1^2
"KRN",8994,1229,2,2,1,0)
^^1^1^3010907^
"KRN",8994,1229,2,2,1,1,0)
IPM order number
"KRN",8994,1229,2,"B","PSBORD",2)

"KRN",8994,1229,2,"B","PSBUID",1)

"KRN",8994,1229,2,"PARAMSEQ",1,1)

"KRN",8994,1229,2,"PARAMSEQ",2,2)

"KRN",8994,1230,-1)
0^1
"KRN",8994,1230,0)
PSB ALLERGY^ALLR^PSBALL^2^P^^^^2
"KRN",8994,1230,1,0)
^8994.01^1^1^3031006^^^^
"KRN",8994,1230,1,1,0)
Returns a list of allergies for a patient.
"KRN",8994,1230,2,0)
^8994.02A^1^1
"KRN",8994,1230,2,1,0)
 PATIENT ID^1^16^1
"KRN",8994,1230,2,1,1,0)
^8994.021^1^1^3030725^^^^
"KRN",8994,1230,2,1,1,1,0)
The record number of the patient (DFN) from the Patient file (#2).
"KRN",8994,1230,2,"B"," PATIENT ID",1)

"KRN",8994,1230,3,0)
^8994.03^4^4^3030725^^^^
"KRN",8994,1230,3,1,0)
Array of patient allergies.  Returned data is delimited by "^" and
"KRN",8994,1230,3,2,0)
includes: allergen/reactant, reactions/symptoms (multiple symptoms/
"KRN",8994,1230,3,3,0)
reactions are possible - delimited by ";"), severity, allergy id (record
"KRN",8994,1230,3,4,0)
number from the Patient Allergies file (#120.8).
"KRN",8994,1231,-1)
0^11
"KRN",8994,1231,0)
PSB GETPROVIDER^PROVLST^PSBRPCMO^2^P^^^1^2
"KRN",8994,1231,1,0)
^8994.01^1^1^3030317^^^^
"KRN",8994,1231,1,1,0)
Used to get a list of active providers.
"KRN",8994,1231,2,0)
^8994.02A^1^1
"KRN",8994,1231,2,1,0)
PSBIN^1^^1^1
"KRN",8994,1231,2,1,1,0)
^^1^1^3030317^
"KRN",8994,1231,2,1,1,1,0)
This is the data that is passed to perform a lookup on the provider.
"KRN",8994,1231,2,"B","NONE",1)

"KRN",8994,1231,2,"B","PSBIN",1)

"KRN",8994,1231,2,"PARAMSEQ",1,1)

"KRN",8994,1231,3,0)
^^4^4^3030317^
"KRN",8994,1231,3,1,0)
An array is returned in the format:
"KRN",8994,1231,3,2,0)
 
"KRN",8994,1231,3,3,0)
(0)     line count of array
"KRN",8994,1231,3,4,0)
(1...n) IEN from VA(200^provider name
"KRN",8994,1232,-1)
0^18
"KRN",8994,1232,0)
PSB MOB DRUG LIST^OILST^PSBRPCMO^2^P^^^1^2
"KRN",8994,1232,1,0)
^8994.01^1^1^3030319^^^^
"KRN",8994,1232,1,1,0)
Used by the BCMA/CPRS Med Order Button to return an array of drug.
"KRN",8994,1232,2,0)
^8994.02A^2^2
"KRN",8994,1232,2,1,0)
PSBSCAN^1^40^1^1
"KRN",8994,1232,2,1,1,0)
^8994.021^1^1^3030319^^^^
"KRN",8994,1232,2,1,1,1,0)
PSBSCAN is the value that has been scanned or entered by the user.
"KRN",8994,1232,2,2,0)
PSBOTYP^1^30^1^2
"KRN",8994,1232,2,2,1,0)
^8994.021^1^1^3030319^^^^
"KRN",8994,1232,2,2,1,1,0)
Type of order, "UD" or "IV".
"KRN",8994,1232,2,"B","PSBOTYP",2)

"KRN",8994,1232,2,"B","PSBSCAN",1)

"KRN",8994,1232,2,"PARAMSEQ",1,1)

"KRN",8994,1232,2,"PARAMSEQ",2,2)

"KRN",8994,1232,3,0)
^^13^13^3030319^
"KRN",8994,1232,3,1,0)
Results[0] = 1
"KRN",8994,1232,3,2,0)
Results[1] = -1^Invalid Medication Lookup
"KRN",8994,1232,3,3,0)
 
"KRN",8994,1232,3,4,0)
or
"KRN",8994,1232,3,5,0)
 
"KRN",8994,1232,3,6,0)
Results[0] = the number of items passed in the array
"KRN",8994,1232,3,7,0)
Results[1] = ^1 either DD, SOL, ADD
"KRN",8994,1232,3,8,0)
             ^2 IEN from drug file 50
"KRN",8994,1232,3,9,0)
             ^3 Drug Name
"KRN",8994,1232,3,10,0)
             ^4 Pharmacy Orderable Item IEN 
"KRN",8994,1232,3,11,0)
             ^5 Pharmacy Orderable Item Name
"KRN",8994,1232,3,12,0)
             ^6 CPRS Orderable Item IEN
"KRN",8994,1232,3,13,0)
             ^7 CPRS Orderable Item Name
"KRN",8994,1233,-1)
0^5
"KRN",8994,1233,0)
PSB CPRS ORDER^ORDER^PSBRPCMO^2^P^^^1^2
"KRN",8994,1233,1,0)
^8994.01^2^2^3031006^^
"KRN",8994,1233,1,1,0)
This RPC sets results of a Med Order Button transaction in a global for 
"KRN",8994,1233,1,2,0)
Inpatient Pharmacy to pick up.
"KRN",8994,1233,2,0)
^8994.02A^2^2
"KRN",8994,1233,2,1,0)
PSBHDR^1^^1^1
"KRN",8994,1233,2,2,0)
PSBREC^2^^1^2
"KRN",8994,1233,2,"B","PSBHDR",1)

"KRN",8994,1233,2,"B","PSBREC",2)

"KRN",8994,1233,2,"PARAMSEQ",1,1)

"KRN",8994,1233,2,"PARAMSEQ",2,2)

"KRN",8994,1233,3,0)
^^5^5^3030319^
"KRN",8994,1233,3,1,0)
Results[0] = Number of items in the array
"KRN",8994,1233,3,2,0)
 
"KRN",8994,1233,3,3,0)
Results[1] = 1^Data successfully filed
"KRN",8994,1233,3,4,0)
             or
"KRN",8994,1233,3,5,0)
             1-^Data not filed
"KRN",8994,1234,-1)
0^19
"KRN",8994,1234,0)
PSB NURS WARDLIST^NWLIST^PSBRPC^2^P^^^1^2
"KRN",8994,1234,1,0)
^8994.01^1^1^3031008^^^^
"KRN",8994,1234,1,1,0)
This will return a list of active ward from the NURS LOCATION, file 211.4.
"KRN",8994,1234,2,0)
^8994.02A^1^1
"KRN",8994,1234,2,1,0)
none
"KRN",8994,1234,2,"B","none",1)

"KRN",8994,1234,3,0)
^8994.03^2^2^3030317^^
"KRN",8994,1234,3,1,0)
RESULTS(0)      =       Number of nodes returned.
"KRN",8994,1234,3,2,0)
RESULTS(1...n)  =       IEN from file 211.4^NAME
"KRN",8994,1290,-1)
0^32
"KRN",8994,1290,0)
PSB VERSION CHECK^GUICHK^PSBRPC3^2^P^^^^2
"KRN",8994,1290,1,0)
^8994.01^1^1^3031006^^^^
"KRN",8994,1290,1,1,0)
This RPC is called at startup. No parameters are passed.
"KRN",8994,1290,3,0)
^8994.03^2^2^3030314^^^^
"KRN",8994,1290,3,1,0)
(0) = Count
"KRN",8994,1290,3,2,0)
(1) = Current Gui Version_U_Previous Gui Version
"KRN",8994,1429,-1)
0^34
"KRN",8994,1429,0)
PSB VITALS^VITALS^PSBRPC^2^P^^^1^2
"KRN",8994,1429,1,0)
^8994.01^1^1^3031208^^^^
"KRN",8994,1429,1,1,0)
Passes array of Vital entries - Temp,Pulse,Resp,BP,Pain in the last 7 days
"KRN",8994,1429,2,0)
^8994.02A^1^1
"KRN",8994,1429,2,1,0)
DFN^1^30^1^1
"KRN",8994,1429,2,1,1,0)
^8994.021^1^1^3031208^^^^
"KRN",8994,1429,2,1,1,1,0)
Patient IEN
"KRN",8994,1429,2,"B","DFN",1)

"KRN",8994,1429,2,"PARAMSEQ",1,1)

"KRN",8994,1429,3,0)
^8994.03^2^2^3031208^^^^
"KRN",8994,1429,3,1,0)
Results(0)=count
"KRN",8994,1429,3,2,0)
Results(1)=Vital Type^Date/Time vital taken^DFN^vital value
"KRN",8994,1476,-1)
0^3
"KRN",8994,1476,0)
PSB CHECK IV^RPC^PSBCHKIV^2^P^0^^^1
"KRN",8994,1476,1,0)
^8994.01^4^4^3031020^^^^
"KRN",8994,1476,1,1,0)
RPC PSB CHECK IV - When given a patient's data file number(DFN), this 
"KRN",8994,1476,1,2,0)
process will return infusing IV information pertaining to the given 
"KRN",8994,1476,1,3,0)
DFN.  The information will be returned at the location presented by
"KRN",8994,1476,1,4,0)
the "RESULTS" parameter.
"KRN",8994,1476,2,0)
^8994.02A^2^2
"KRN",8994,1476,2,1,0)
DFN^1^^1^1
"KRN",8994,1476,2,1,1,0)
^8994.021^1^1^3031020^^^
"KRN",8994,1476,2,1,1,1,0)
Patient IEN
"KRN",8994,1476,2,1,1,2,0)
entry number (IEN) and a pointer to the PATIENT FILE (File#2 - ^DPT).
"KRN",8994,1476,2,2,0)
ORDIV^2^^1^2
"KRN",8994,1476,2,2,1,0)
^8994.021^1^1^3031020^^^
"KRN",8994,1476,2,2,1,1,0)
LIST OF ORDER NUMBERS
"KRN",8994,1476,2,2,1,2,0)
to contain the output from PSB CHECK IV processing.
"KRN",8994,1476,2,"B","DFN",1)

"KRN",8994,1476,2,"B","ORDIV",2)

"KRN",8994,1476,2,"B","RESULTS",2)

"KRN",8994,1476,2,"PARAMSEQ",1,1)

"KRN",8994,1476,2,"PARAMSEQ",1,2)

"KRN",8994,1476,2,"PARAMSEQ",2,1)

"KRN",8994,1476,2,"PARAMSEQ",2,2)

"KRN",8994,1476,3,0)
^8994.03^3^3^3031020^^^^
"KRN",8994,1476,3,1,0)
RESULTS is an output array which will contain informaion about infusing 
"KRN",8994,1476,3,2,0)
IVs.  The infusing IVs information will be relative to the given patient 
"KRN",8994,1476,3,3,0)
data file number (DFN).
"KRN",8994,1539,-1)
0^33
"KRN",8994,1539,0)
PSB VITAL MEAS FILE^RPC^PSBVITFL^2^P^0
"KRN",8994,1539,1,0)
^8994.01^25^25^3031218^
"KRN",8994,1539,1,1,0)
This RPC has been built specifically to process the filing of BCMA 
"KRN",8994,1539,1,2,0)
Pain Score data. The processing of other VITAL type may be incorporated 
"KRN",8994,1539,1,3,0)
with some adjustments.
"KRN",8994,1539,1,4,0)
 
"KRN",8994,1539,1,5,0)
 
"KRN",8994,1539,1,6,0)
  This routine is to service BCMA 3.0 functionality and store VITALs'
"KRN",8994,1539,1,7,0)
  data into the VITAL MEASUREMENT FILE - ^GMR(120.5  using the API
"KRN",8994,1539,1,8,0)
  GMRVPCE0
"KRN",8994,1539,1,9,0)
  
"KRN",8994,1539,1,10,0)
  Parameters:
"KRN",8994,1539,1,11,0)
        Input  -        
"KRN",8994,1539,1,12,0)
                        DFN   (r) Pointer to the PATIENT (#2) file
"KRN",8994,1539,1,13,0)
                        RATE  (r)  BCMA trigger event/transaction
"KRN",8994,1539,1,14,0)
                        VTYPE (o) Pointer to GMRV VITAL TYPE FILE (#120.51)
"KRN",8994,1539,1,15,0)
                                  (default = Pain ["PN"])
"KRN",8994,1539,1,16,0)
                        DTTKN (o) Date/time (FileMan) measurment was taken
"KRN",8994,1539,1,17,0)
                                  (default = $$NOW^XLFDT())
"KRN",8994,1539,1,18,0)
 
"KRN",8994,1539,1,19,0)
       Output -         RESULTS(0) = 1
"KRN",8994,1539,1,20,0)
                        RESULTS(1) ="1^Pain Score successfully filed"
"KRN",8994,1539,1,21,0)
                  or    RESULTS(1) ="-1^ERROR * Pain Score NOT filed 
"KRN",8994,1539,1,22,0)
                                     successfully"
"KRN",8994,1539,1,23,0)
 
"KRN",8994,1539,1,24,0)
     Process results in the storing of VITAL Measurement rate into the VITAL
"KRN",8994,1539,1,25,0)
     MEASUREMENT FILE per the given patient and vital type.
"KRN",8994,1539,2,0)
^8994.02A^4^4
"KRN",8994,1539,2,1,0)
PSBDFN^1^^1^1
"KRN",8994,1539,2,1,1,0)
^^2^2^3031104^
"KRN",8994,1539,2,1,1,1,0)
PSBDFN presents the Pointer to the PATIENT File (#2) of the patient for 
"KRN",8994,1539,2,1,1,2,0)
whom this vital measurement data was entered.
"KRN",8994,1539,2,2,0)
PSBRATE^1^^1^2
"KRN",8994,1539,2,2,1,0)
^8994.021^2^2^3031208^^
"KRN",8994,1539,2,2,1,1,0)
PSBRATE presents the numeric value associated with this vital 
"KRN",8994,1539,2,2,1,2,0)
measurement.
"KRN",8994,1539,2,3,0)
PSBVTYPE^1^^0^3
"KRN",8994,1539,2,3,1,0)
^8994.021^2^2^3031208^^^^
"KRN",8994,1539,2,3,1,1,0)
PSBVTYPE presents the type of measurement for this record and is a 
"KRN",8994,1539,2,3,1,2,0)
pointer to the GMRV VITAL TYPE File (#120.51)
"KRN",8994,1539,2,4,0)
PSBDTTKN^1^^0^4
"KRN",8994,1539,2,4,1,0)
^8994.021^1^1^3031218^^^
"KRN",8994,1539,2,4,1,1,0)
DTTKN   (o) Date/time (FileMan) measurment was taken.  The default is NOW.
"KRN",8994,1539,2,"B","PSBDFN",1)

"KRN",8994,1539,2,"B","PSBDTTKN",4)

"KRN",8994,1539,2,"B","PSBRATE",2)

"KRN",8994,1539,2,"B","PSBVTYPE",3)

"KRN",8994,1539,2,"PARAMSEQ",1,1)

"KRN",8994,1539,2,"PARAMSEQ",2,2)

"KRN",8994,1539,2,"PARAMSEQ",3,3)

"KRN",8994,1539,2,"PARAMSEQ",4,4)

"MBREQ")
0
"ORD",3,19.1)
19.1;3;1;;KEY^XPDTA1;;;KEYF2^XPDIA1;;KEYDEL^XPDIA1
"ORD",3,19.1,0)
SECURITY KEY
"ORD",8,.403)
.403;8;;;EDEOUT^DIFROMSO(.403,DA,"",XPDA);FPRE^DIFROMSI(.403,"",XPDA);EPRE^DIFROMSI(.403,DA,$E("N",$G(XPDNEW)),XPDA,"",OLDA);;EPOST^DIFROMSI(.403,DA,"",XPDA);DEL^DIFROMSK(.403,"",%)
"ORD",8,.403,0)
FORM
"ORD",13,870)
870;13;1;;HLLL^XPDTA1;;HLLLE^XPDIA1;;;HLLLDEL^XPDIA1(%)
"ORD",13,870,0)
HL LOGICAL LINK
"ORD",14,771)
771;14;;;HLAP^XPDTA1;HLAPF1^XPDIA1;HLAPE1^XPDIA1;HLAPF2^XPDIA1;;HLAPDEL^XPDIA1(%)
"ORD",14,771,0)
HL7 APPLICATION PARAMETER
"ORD",15,101)
101;15;;;PRO^XPDTA;PROF1^XPDIA;PROE1^XPDIA;PROF2^XPDIA;;PRODEL^XPDIA
"ORD",15,101,0)
PROTOCOL
"ORD",16,8994)
8994;16;1;;;;;;;RPCDEL^XPDIA1
"ORD",16,8994,0)
REMOTE PROCEDURE
"ORD",17,409.61)
409.61;17;1;;;;;;;LMDEL^XPDIA1
"ORD",17,409.61,0)
LIST TEMPLATE
"ORD",18,19)
19;18;;;OPT^XPDTA;OPTF1^XPDIA;OPTE1^XPDIA;OPTF2^XPDIA;;OPTDEL^XPDIA
"ORD",18,19,0)
OPTION
"ORD",20,8989.51)
8989.51;20;;;PAR1E1^XPDTA2;PAR1F1^XPDIA3;PAR1E1^XPDIA3;PAR1F2^XPDIA3;;PAR1DEL^XPDIA3(%)
"ORD",20,8989.51,0)
PARAMETER DEFINITION
"ORD",21,8989.52)
8989.52;21;1;;PAR2E1^XPDTA2;PAR2F1^XPDIA3;PAR2E1^XPDIA3;PAR2F2^XPDIA3;;PAR2DEL^XPDIA3(%)
"ORD",21,8989.52,0)
PARAMETER TEMPLATE
"PKG",536,-1)
1^1
"PKG",536,0)
BAR CODE MED ADMIN^PSB^BAR CODE MEDICATION ADMINISTRATION
"PKG",536,20,0)
^9.402P^^
"PKG",536,22,0)
^9.49I^1^1
"PKG",536,22,1,0)
3.0^3040224^3040204^10000000043
"PKG",536,22,1,1,0)
^^101^101^3040224
"PKG",536,22,1,1,1,0)
*** Bar Code Medication Administration (BCMA) Version 3.0 ***
"PKG",536,22,1,1,2,0)
 
"PKG",536,22,1,1,3,0)
This build consists of BCMA Version 3.0 rollover code and resolution to a 
"PKG",536,22,1,1,4,0)
few outstanding BCMA defects.
"PKG",536,22,1,1,5,0)
 
"PKG",536,22,1,1,6,0)
Listed below are primary National Online Information Sharing ticket 
"PKG",536,22,1,1,7,0)
(NOIS) identification information representing BCMA defects/problems
"PKG",536,22,1,1,8,0)
and their respective corrective action.
"PKG",536,22,1,1,9,0)
 
"PKG",536,22,1,1,10,0)
1. Problem: NOIS ISB-0603-31561
"PKG",536,22,1,1,11,0)
A medication order that has administration times set for today, but 
"PKG",536,22,1,1,12,0)
before the Start Time of the order, displays on the Bar Code Medication 
"PKG",536,22,1,1,13,0)
Administration (BCMA) Due List Report.
"PKG",536,22,1,1,14,0)
 
"PKG",536,22,1,1,15,0)
Corrective Action:
"PKG",536,22,1,1,16,0)
The Due List Report will not display medication orders until the Start 
"PKG",536,22,1,1,17,0)
Date/Time of the medication order takes affect.
"PKG",536,22,1,1,18,0)
 
"PKG",536,22,1,1,19,0)
2. Problem: NOIS ISB-0903-31964
"PKG",536,22,1,1,20,0)
When the user selects a time frame for the Medication Administration 
"PKG",536,22,1,1,21,0)
History (MAH) Report and no administrations are due, the report lists the 
"PKG",536,22,1,1,22,0)
medication order number from Inpatient Medications V. 5.0 under the 
"PKG",536,22,1,1,23,0)
"Initial-Name Legend" section.
"PKG",536,22,1,1,24,0)
 
"PKG",536,22,1,1,25,0)
Corrective Action: 
"PKG",536,22,1,1,26,0)
The MAH Report will not display the order number from Inpatient 
"PKG",536,22,1,1,27,0)
Medications V. 5.0 under the "Initial-Name Legend" section when no 
"PKG",536,22,1,1,28,0)
administrations are due for a specific time frame.
"PKG",536,22,1,1,29,0)
 
"PKG",536,22,1,1,30,0)
3. Problem: NOIS LAH-1203-61493
"PKG",536,22,1,1,31,0)
The user receives the following error message, "BCMA failed to 
"PKG",536,22,1,1,32,0)
communicate with VISTA," if the Graphical User Interface (GUI) BCMA times
"PKG",536,22,1,1,33,0)
out and is unable to connect to the server.
"PKG",536,22,1,1,34,0)
 
"PKG",536,22,1,1,35,0)
Corrective Action: 
"PKG",536,22,1,1,36,0)
The processing time for the GUI BCMA software to display the patient s 
"PKG",536,22,1,1,37,0)
record on the BCMA Virtual Due List (VDL) has been reduced.
"PKG",536,22,1,1,38,0)
 
"PKG",536,22,1,1,39,0)
4. Problem: NOIS LIT-0603-71923
"PKG",536,22,1,1,40,0)
Users sometimes receive an "allocation failure" error message when 
"PKG",536,22,1,1,41,0)
accessing a patient s record using the GUI BCMA.
"PKG",536,22,1,1,42,0)
 
"PKG",536,22,1,1,43,0)
Corrective Action: 
"PKG",536,22,1,1,44,0)
The "allocation failure" error message has been corrected.
"PKG",536,22,1,1,45,0)
 
"PKG",536,22,1,1,46,0)
5. Problem: NOIS MAD-1203-42204
"PKG",536,22,1,1,47,0)
The MAH Report takes an extended amount of time to run if the Start Date 
"PKG",536,22,1,1,48,0)
and the Stop Date of the report, requested by the user, are for different 
"PKG",536,22,1,1,49,0)
years. For example, if the Start Date is 12/28/03 and the Stop Date is 
"PKG",536,22,1,1,50,0)
01/03/04.
"PKG",536,22,1,1,51,0)
 
"PKG",536,22,1,1,52,0)
Corrective Action: 
"PKG",536,22,1,1,53,0)
The user can now request different years for the MAH Report without 
"PKG",536,22,1,1,54,0)
experiencing extended delays as BCMA accesses the data. 
"PKG",536,22,1,1,55,0)
 
"PKG",536,22,1,1,56,0)
6. Problem: NOIS MIN-1203-41637
"PKG",536,22,1,1,57,0)
Users sometimes experience an "Invalid Medication Lookup" error message 
"PKG",536,22,1,1,58,0)
after scanning a medication in the "Scan Medication Bar Code:" field of 
"PKG",536,22,1,1,59,0)
the "Order Manager"  dialog box when using the BCMA Med Order Button in 
"PKG",536,22,1,1,60,0)
GUI BCMA.
"PKG",536,22,1,1,61,0)
 
"PKG",536,22,1,1,62,0)
Corrective Action: 
"PKG",536,22,1,1,63,0)
The BCMA medication lookup process has been corrected to properly 
"PKG",536,22,1,1,64,0)
validate the medications scanned in the "Scan Medication Bar Code:" field 
"PKG",536,22,1,1,65,0)
of the "Order Manager" dialog box in GUI BCMA.
"PKG",536,22,1,1,66,0)
 
"PKG",536,22,1,1,67,0)
7. Problem: NOIS UNY-0104-10174
"PKG",536,22,1,1,68,0)
Multiple IV medication orders display as merged on the IV Medication Tab 
"PKG",536,22,1,1,69,0)
after an order is discontinued, but the IV bag is still infusing.
"PKG",536,22,1,1,70,0)
 
"PKG",536,22,1,1,71,0)
Corrective Action: 
"PKG",536,22,1,1,72,0)
Multiple IV medication orders will display properly on the IV Medication 
"PKG",536,22,1,1,73,0)
Tab.  
"PKG",536,22,1,1,74,0)
 
"PKG",536,22,1,1,75,0)
8. Problem: NOIS TNV-0104-30647
"PKG",536,22,1,1,76,0)
Users sometimes experience the following error message, "ERROR: 16^Server 
"PKG",536,22,1,1,77,0)
Protocol Disabled," when using the Edit Medication Log [PSB MED LOG EDIT] 
"PKG",536,22,1,1,78,0)
option. This occurs when the PSB BCMA RASO17 SRV Health Level Seven (HL7) 
"PKG",536,22,1,1,79,0)
server protocol is being disabled.
"PKG",536,22,1,1,80,0)
 
"PKG",536,22,1,1,81,0)
Corrective Action:
"PKG",536,22,1,1,82,0)
The error message is only intended to notify the BCMA software that the 
"PKG",536,22,1,1,83,0)
protocol is being disabled. BCMA will now validate the message and not 
"PKG",536,22,1,1,84,0)
display it to users. 
"PKG",536,22,1,1,85,0)
 
"PKG",536,22,1,1,86,0)
9. Problem: NOIS ISB-0104-31384
"PKG",536,22,1,1,87,0)
When an IV medication order with an infusing bag is "Renewed," the 
"PKG",536,22,1,1,88,0)
renewed order continues to display on the IV Medication Tab of the BCMA  
"PKG",536,22,1,1,89,0)
VDL  until the infusing bag is "Completed," even if the "Renewed" order's
"PKG",536,22,1,1,90,0)
Start Date/Time has expired.
"PKG",536,22,1,1,91,0)
 
"PKG",536,22,1,1,92,0)
Corrective Action:
"PKG",536,22,1,1,93,0)
When an IV medication order with an infusing bag is "Renewed," the 
"PKG",536,22,1,1,94,0)
renewed order will continue to display on the IV Medication Tab of the 
"PKG",536,22,1,1,95,0)
BCMA VDL until the infusing bag is "Completed," or until the Start 
"PKG",536,22,1,1,96,0)
Date/Time of the new order that was created during the renewal process. 
"PKG",536,22,1,1,97,0)
Once the new order is active, the infusing bag from the previous order 
"PKG",536,22,1,1,98,0)
will display on the BCMA VDL with the new order, along with any 
"PKG",536,22,1,1,99,0)
additional bags created from the new order. Any available bags from the 
"PKG",536,22,1,1,100,0)
previous order will display on the new order based on the IV Site 
"PKG",536,22,1,1,101,0)
Parameter settings in the GUI BCMA Site Parameters application.
"PKG",536,"VERSION")
3.0
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
60
"RTN","PSBALL")
0^1^B2340007
"RTN","PSBALL",1,0)
PSBALL ;BIRMINGHAM/VRN-BCMA RPC BROKER CALLS ;Mar 2004
"RTN","PSBALL",2,0)
 ;;3.0;BAR CODE MED ADMIN;;Mar 2004
"RTN","PSBALL",3,0)
 ;
"RTN","PSBALL",4,0)
 ; Reference/IA
"RTN","PSBALL",5,0)
 ; EN1^GMRADPT/10099
"RTN","PSBALL",6,0)
 ;
"RTN","PSBALL",7,0)
ALLR(RESULTS,DFN) ; Return array of patient allergies/adverse reactions
"RTN","PSBALL",8,0)
 ;
"RTN","PSBALL",9,0)
 ;RPC: PSB ALLERGY
"RTN","PSBALL",10,0)
 ;
"RTN","PSBALL",11,0)
 D SORT
"RTN","PSBALL",12,0)
 Q
"RTN","PSBALL",13,0)
 ;
"RTN","PSBALL",14,0)
SORT ;*** Set up the allergies and adv. reactions arrays.
"RTN","PSBALL",15,0)
 S PSBCNT=1,(PSBALC,PSBARC)=0
"RTN","PSBALL",16,0)
 S GMRA="0^0^111" D EN1^GMRADPT
"RTN","PSBALL",17,0)
 I GMRAL="" S RESULTS(0)=1,RESULTS(1)="ALL"_U_"No Allergy Assessment" Q
"RTN","PSBALL",18,0)
 I GMRAL=0 S RESULTS(0)=1,RESULTS(1)="ALL"_U_"No Known Allergies" Q
"RTN","PSBALL",19,0)
 F X=0:0 S X=$O(GMRAL(X)) Q:'X  S PSBTYP=$P(GMRAL(X),U,5),PSBNM=$P(GMRAL(X),U,2) D
"RTN","PSBALL",20,0)
 .S:PSBTYP=0 PSBALC=PSBALC+1,PSBALG(PSBNM)=""
"RTN","PSBALL",21,0)
 .S:PSBTYP>0 PSBARC=PSBARC+1,PSBADR(PSBNM)=""
"RTN","PSBALL",22,0)
 S (X,Y)="" F  S X=$O(PSBALG(X)) Q:X=""  S Y="ALL"_U_X,RESULTS(PSBCNT)=Y,PSBCNT=PSBCNT+1
"RTN","PSBALL",23,0)
 S (X,Y)="" F  S X=$O(PSBADR(X)) Q:X=""  S Y="ADR"_U_X,RESULTS(PSBCNT)=Y,PSBCNT=PSBCNT+1
"RTN","PSBALL",24,0)
 S RESULTS(0)=PSBCNT-1
"RTN","PSBALL",25,0)
 K GMRA,GMRAL,PSBADR,PSBALC,PSBALG,PSBARC,PSBCNT,PSBNM,PSBTYP
"RTN","PSBALL",26,0)
 Q
"RTN","PSBALL",27,0)
 ;
"RTN","PSBAPIPM")
0^2^B17290164
"RTN","PSBAPIPM",1,0)
PSBAPIPM ;BIRMINGHAM/EFC-BCMA API TO IPM FOR ORDER RENEWAL ;Mar 2004
"RTN","PSBAPIPM",2,0)
 ;;3.0;BAR CODE MED ADMIN;;Mar 2004
"RTN","PSBAPIPM",3,0)
 ;
"RTN","PSBAPIPM",4,0)
 ;
"RTN","PSBAPIPM",5,0)
EN(PSBDFN,PSBORDX) ;
"RTN","PSBAPIPM",6,0)
 ;
"RTN","PSBAPIPM",7,0)
 ; PSBLADT=date/time of the last action
"RTN","PSBAPIPM",8,0)
 ; PSBADMDT=scheduled time of the last action
"RTN","PSBAPIPM",9,0)
 ; PSBSTUS=last action (given, held, refused, etc.)
"RTN","PSBAPIPM",10,0)
 ;
"RTN","PSBAPIPM",11,0)
 ;
"RTN","PSBAPIPM",12,0)
 S (PSBCNT,PSBFLAG)=0,Y=""
"RTN","PSBAPIPM",13,0)
 S PSBSTR=""
"RTN","PSBAPIPM",14,0)
 I '$D(^PSB(53.79,"AORDX",PSBDFN,PSBORDX)) Q ""
"RTN","PSBAPIPM",15,0)
 F  S Y=$O(^PSB(53.79,"AORDX",PSBDFN,PSBORDX,Y),-1) Q:Y=""  Q:PSBFLAG=1  D
"RTN","PSBAPIPM",16,0)
 .S PSBLADT=$S(Y:Y,1:"")
"RTN","PSBAPIPM",17,0)
 .S X="" F  S X=$O(^PSB(53.79,"AORDX",PSBDFN,PSBORDX,Y,X),-1) Q:X=""  D
"RTN","PSBAPIPM",18,0)
 ..S PSBSTUS=$P(^PSB(53.79,X,0),U,9) I PSBSTUS'="N" S PSBFLAG=1
"RTN","PSBAPIPM",19,0)
 ..S PSBADMDT=$P(^PSB(53.79,X,.1),U,3)
"RTN","PSBAPIPM",20,0)
 ..D:PSBSTUS="N"
"RTN","PSBAPIPM",21,0)
 ...S (PSBLADT,PSBSTUS,PSBADMDT)=""
"RTN","PSBAPIPM",22,0)
 ...S Z="" F  S Z=$O(^PSB(53.79,X,.9,Z),-1) Q:'Z  Q:PSBFLAG=1  S PSBDATA=$G(^(Z,0)) D
"RTN","PSBAPIPM",23,0)
 ....I (PSBDATA["Set to 'NOT GIVEN'")!(PSBDATA["Set to 'GIVEN'")!(PSBDATA["Set to 'REFUSED'")!(PSBDATA["Set to 'HELD'")!(PSBDATA["Set to 'MISSING DOSE'")!(PSBDATA["Set to 'REMOVED'") S PSBCNT=PSBCNT+1
"RTN","PSBAPIPM",24,0)
 ....I (PSBDATA["STATUS 'HELD'")!(PSBDATA["STATUS 'GIVEN'")!(PSBDATA["STATUS 'REFUSED'")!(PSBDATA["STATUS 'MISSING DOSE'")!(PSBDATA["STATUS 'REMOVED'") S PSBCNT=PSBCNT+1
"RTN","PSBAPIPM",25,0)
 ....I PSBCNT#2=0,PSBDATA["'REFUSED'" S PSBSTUS="R",PSBADMDT=$P(^PSB(53.79,X,.1),U,3) D LAST
"RTN","PSBAPIPM",26,0)
 ....I PSBCNT#2=0,PSBDATA["'HELD'" S PSBSTUS="H",PSBADMDT=$P(^PSB(53.79,X,.1),U,3) D LAST
"RTN","PSBAPIPM",27,0)
 ....I PSBCNT#2=0,PSBDATA["'MISSING DOSE'" S PSBSTUS="M",PSBADMDT=$P(^PSB(53.79,X,.1),U,3) D LAST
"RTN","PSBAPIPM",28,0)
 ....I PSBCNT#2=0,PSBDATA["'REMOVED'" S PSBSTUS="RM",PSBADMDT=$P(^PSB(53.79,X,.1),U,3) D LAST
"RTN","PSBAPIPM",29,0)
 I PSBSTUS'="" S PSBSTR=PSBADMDT_U_PSBLADT_U_PSBSTUS
"RTN","PSBAPIPM",30,0)
 Q PSBSTR
"RTN","PSBAPIPM",31,0)
 ;
"RTN","PSBAPIPM",32,0)
LAST ;
"RTN","PSBAPIPM",33,0)
 S PSBCC=0
"RTN","PSBAPIPM",34,0)
 S ZZ="" F  S ZZ=$O(^PSB(53.79,X,.3,ZZ),-1) Q:'ZZ  Q:PSBFLAG=1  S PSBDATA2=$G(^(ZZ,0)) D
"RTN","PSBAPIPM",35,0)
 .S PSBCC=PSBCC+1
"RTN","PSBAPIPM",36,0)
 .I PSBCC=2 S PSBLADT=$P(PSBDATA2,U,3),PSBFLAG=1
"RTN","PSBAPIPM",37,0)
 Q
"RTN","PSBAPIPM",38,0)
MOB(PSBDFN,PSBCORN) ;
"RTN","PSBAPIPM",39,0)
 I '$D(^TMP("PSBMO",$J,PSBDFN,PSBCORN)) S ^TMP("PSB",$J,0)=-1 Q
"RTN","PSBAPIPM",40,0)
 M ^TMP("PSB",$J)=^TMP("PSBMO",$J,PSBDFN,PSBCORN)
"RTN","PSBAPIPM",41,0)
 K ^TMP("PSB",$J,"PSB")
"RTN","PSBAPIPM",42,0)
 Q
"RTN","PSBAPIPM",43,0)
 ;
"RTN","PSBAPIPM",44,0)
MOBR(PSBDFN,PSBCORN,PSBORDN) ;
"RTN","PSBAPIPM",45,0)
 I $G(PSBORDN)="" K ^TMP("PSB",$J) Q
"RTN","PSBAPIPM",46,0)
 S PSBDUZ=DUZ,PSBDUZ(2)=DUZ(2),DFN=PSBDFN
"RTN","PSBAPIPM",47,0)
 S DUZ=$P(^TMP("PSBMO",$J,PSBDFN,PSBCORN,"PSB"),U,1),DUZ(2)=$P(^TMP("PSBMO",$J,PSBDFN,PSBCORN,"PSB"),U,2),PSBISITE=$P(^TMP("PSBMO",$J,PSBDFN,PSBCORN,"PSB"),U,3)
"RTN","PSBAPIPM",48,0)
 D PSJ1^PSBVT(PSBDFN,PSBORDN)
"RTN","PSBAPIPM",49,0)
 S PSBREC(0)=PSBDFN
"RTN","PSBAPIPM",50,0)
 S PSBREC(1)=PSBONX
"RTN","PSBAPIPM",51,0)
 S PSBREC(2)=PSBSCHT
"RTN","PSBAPIPM",52,0)
 S PSBREC(4)=PSBOIT
"RTN","PSBAPIPM",53,0)
 S PSBREC(5)=$P(^TMP("PSBMO",$J,PSBDFN,PSBCORN,0),U,5)
"RTN","PSBAPIPM",54,0)
 S PSBREC(6)=""
"RTN","PSBAPIPM",55,0)
 S PSBREC(7)="BCMA/CPRS Interface Entry."
"RTN","PSBAPIPM",56,0)
 S PSBREC(8)=PSBISITE
"RTN","PSBAPIPM",57,0)
 I PSBONX["U" S PSBREC(9)="UDTAB^",PSBREC(3)="G"
"RTN","PSBAPIPM",58,0)
 I PSBONX["V" D
"RTN","PSBAPIPM",59,0)
 .I "PCS"'[PSBIVT S PSBREC(9)="IVTAB"_U_$$GETWSID^PSBVDLU2(PSBDFN,PSBORDN),PSBREC(3)="I" Q
"RTN","PSBAPIPM",60,0)
 .I PSBIVT["S",PSBISYR=0 S PSBREC(9)="IVTAB"_U_$$GETWSID^PSBVDLU2(PSBDFN,PSBORDN),PSBREC(3)="I" Q
"RTN","PSBAPIPM",61,0)
 .I PSBIVT["C",PSBISYR=0 S PSBREC(9)="IVTAB"_U_$$GETWSID^PSBVDLU2(PSBDFN,PSBORDN),PSBREC(3)="I" Q
"RTN","PSBAPIPM",62,0)
 .S PSBREC(9)="PBTAB"_U_$$GETWSID^PSBVDLU2(PSBDFN,PSBORDN),PSBREC(3)="G" Q
"RTN","PSBAPIPM",63,0)
 S PSBINDX=10
"RTN","PSBAPIPM",64,0)
 S X="" F  S X=$O(PSBDDA(X)) Q:X=""  S PSBREC(PSBINDX)=$P(PSBDDA(X),U,1,2)_U_$P(PSBDDA(X),U,4)_U_$P(PSBDDA(X),U,4)_U_PSBDOSEF,PSBINDX=PSBINDX+1
"RTN","PSBAPIPM",65,0)
 S X="" F  S X=$O(PSBADA(X)) Q:X=""  S PSBREC(PSBINDX)=PSBADA(X),PSBINDX=PSBINDX+1
"RTN","PSBAPIPM",66,0)
 S X="" F  S X=$O(PSBSOLA(X)) Q:X=""  S PSBREC(PSBINDX)=PSBSOLA(X),PSBINDX=PSBINDX+1
"RTN","PSBAPIPM",67,0)
 D RPC^PSBML(.PSB,"+1^MEDPASS",.PSBREC)
"RTN","PSBAPIPM",68,0)
 I +PSB(0)<1 D  Q
"RTN","PSBAPIPM",69,0)
 .S X=0 F  S X=$O(PSB(X)) Q:X=""  W !,$J(X,2),". ",PSB(X)
"RTN","PSBAPIPM",70,0)
 .K DIR S DIR(0)="E" D ^DIR
"RTN","PSBAPIPM",71,0)
 S DUZ=PSBDUZ,DUZ(2)=PSBDUZ(2)  K PSBDUZ,PSBDUZ(2),^TMP("PSBMO",$J,PSBDFN,PSBCORN),^TMP("PSB",$J) D CLEAN^PSBVT
"RTN","PSBAPIPM",72,0)
 Q
"RTN","PSBCHIVH")
0^3^B1575231
"RTN","PSBCHIVH",1,0)
PSBCHIVH ;BIRMINGHAM/BSR-BCMA CHECK IV ROUTINE ;Mar 2004
"RTN","PSBCHIVH",2,0)
 ;;3.0;BAR CODE MED ADMIN;;Mar 2004
"RTN","PSBCHIVH",3,0)
 ;
"RTN","PSBCHIVH",4,0)
 ;This routine will retrievehistory order numbers. 
"RTN","PSBCHIVH",5,0)
 ;
"RTN","PSBCHIVH",6,0)
GETORD(PSBORD)    ;
"RTN","PSBCHIVH",7,0)
 S PSBONXS=PSBORD_"^"
"RTN","PSBCHIVH",8,0)
 F PSBC1=1:1 Q:$P(PSBONXS,U,PSBC1)=""  D  ; process all orders
"RTN","PSBCHIVH",9,0)
 .D CLEAN^PSBVT,PSJ1^PSBVT(DFN,$P(PSBONXS,U,PSBC1))
"RTN","PSBCHIVH",10,0)
 .I $G(PSBPONX)]"",$G(PSBPONX)["P" S PSBPONX2=PSBPONX D  ; Must compare
"RTN","PSBCHIVH",11,0)
 ..F  D CLEAN^PSBVT,PSJ1^PSBVT(DFN,PSBPONX2) S PSBPONX2=PSBPONX  Q:(PSBPONX2="")!(PSBPONX2'["P")  ;
"RTN","PSBCHIVH",12,0)
 ..D CLEAN^PSBVT,PSJ1^PSBVT(DFN,$P(PSBONXS,U,PSBC1))  ; Refresh data
"RTN","PSBCHIVH",13,0)
 ..S:$D(PSBPONX2) PSBPONX=PSBPONX2 K PSBPONX2
"RTN","PSBCHIVH",14,0)
 .Q:($L(U_PSBONXS,U_PSBPONX_U)-1)>0
"RTN","PSBCHIVH",15,0)
 .I $G(PSBPONX)]"" S PSBONXS=PSBONXS_PSBPONX_U
"RTN","PSBCHIVH",16,0)
 S PSBONXSB=PSBONXS
"RTN","PSBCHIVH",17,0)
 Q
"RTN","PSBCHIVH",18,0)
 ;
"RTN","PSBCHKIV")
0^4^B77606610
"RTN","PSBCHKIV",1,0)
PSBCHKIV ;BIRMINGHAM/TEJ-BCMA CHECK IV ROUTINE ;Mar 2004
"RTN","PSBCHKIV",2,0)
 ;;3.0;BAR CODE MED ADMIN;;Mar 2004
"RTN","PSBCHKIV",3,0)
 ;
"RTN","PSBCHKIV",4,0)
 ;This routine will provide "change" details for infus or stopped IV bags. 
"RTN","PSBCHKIV",5,0)
 ;
"RTN","PSBCHKIV",6,0)
 ; Reference/IA
"RTN","PSBCHKIV",7,0)
 ; EN^PSJBCMA1/2829
"RTN","PSBCHKIV",8,0)
 ; EN^PSJBCMA2/2830
"RTN","PSBCHKIV",9,0)
 ;
"RTN","PSBCHKIV",10,0)
RPC(RESULTS,DFN,ORDIV)  ;
"RTN","PSBCHKIV",11,0)
 N PSBGNODE,PSBPIN,PSBXX,PSBX,PSBBUIDS,PSBBUID K PSBBAGD,PSBADDS,PSBSOLS,RESULTS
"RTN","PSBCHKIV",12,0)
 D NOW^%DTC S X1=X,X2=-3 D C^%DTC S PSBDT=X
"RTN","PSBCHKIV",13,0)
 S PSBPIN=DFN
"RTN","PSBCHKIV",14,0)
 S Z="" F  S Z=$O(ORDIV(Z)) Q:Z=""  D
"RTN","PSBCHKIV",15,0)
 .D GETORD^PSBCHIVH(ORDIV(Z))
"RTN","PSBCHKIV",16,0)
 .F S=1:1 Q:$P(PSBONXSB,"^",S)=""  D
"RTN","PSBCHKIV",17,0)
 ..S PSBORD=$P(PSBONXSB,"^",S)
"RTN","PSBCHKIV",18,0)
 ..S PSBGNODE="^PSB(53.79,"_"""AUID"""_","_DFN_")"
"RTN","PSBCHKIV",19,0)
 ..F  S PSBGNODE=$Q(@PSBGNODE) Q:PSBGNODE=""  Q:$QS(PSBGNODE,3)'=DFN  D
"RTN","PSBCHKIV",20,0)
 ...I $QS(PSBGNODE,4)=PSBORD  D
"RTN","PSBCHKIV",21,0)
 ....S PSBBIEN=$QS(PSBGNODE,6)
"RTN","PSBCHKIV",22,0)
 ....S PSBSTATS=$P(^PSB(53.79,PSBBIEN,0),U,9) D:(PSBSTATS="I")!(PSBSTATS="S")  Q
"RTN","PSBCHKIV",23,0)
 .....S PSBBUID=$QS(PSBGNODE,5),PSBOR=$$FNDLBLO^PSBVDLU2(PSBPIN,$QS(PSBGNODE,4),PSBBUID),(PSBXOR,PSBLOR)=PSBOR
"RTN","PSBCHKIV",24,0)
 .....; G IV bag
"RTN","PSBCHKIV",25,0)
 .....; IS ORD is "live"
"RTN","PSBCHKIV",26,0)
 .....S PSBNXOR=PSBOR
"RTN","PSBCHKIV",27,0)
 .....S PSBSTOP=0 F  K ^TMP("PSJ1",$J) D EN^PSJBCMA1(DFN,PSBNXOR,1) S:($P(^TMP("PSJ1",$J,0),U,5)']"")&($P($G(^TMP("PSJ1",$J,4)),U,7)<PSBDT) PSBSTOP=1 Q:PSBNXOR=$P(^TMP("PSJ1",$J,0),U,5)  S PSBNXOR=$P(^TMP("PSJ1",$J,0),U,5) Q:PSBNXOR']""
"RTN","PSBCHKIV",28,0)
 .....I 'PSBSTOP F PSBXX=1:1 D  K ^TMP("PSJ1",$J) S:PSBOR="" PSBCO(PSBXOR)=PSBLOR Q:PSBOR=""  ;
"RTN","PSBCHKIV",29,0)
 ......K ^TMP("PSJ1",$J) D EN^PSJBCMA1(DFN,PSBOR,1)
"RTN","PSBCHKIV",30,0)
 ......S PSBDX="" F  S PSBDX=$O(^TMP("PSJ1",$J,PSBDX)) Q:PSBDX=""  I $D(^TMP("PSJ1",$J,PSBDX,1000,PSBBUID)) S PSBLABDT=$P(^TMP("PSJ1",$J,PSBDX,1000,PSBBUID,0),U) Q
"RTN","PSBCHKIV",31,0)
 ......K ^TMP("PSJ2",$J) D EN^PSJBCMA2(DFN,PSBOR,1) D:$D(^TMP("PSJ2",$J))
"RTN","PSBCHKIV",32,0)
 .......S PSBX=0 F  S PSBX=$O(^TMP("PSJ2",$J,PSBX)) Q:PSBX=""  D:$P(^TMP("PSJ2",$J,PSBX,1),U,3)]""
"RTN","PSBCHKIV",33,0)
 ........S PSBCHGDT=$P(^TMP("PSJ2",$J,PSBX,1),U),PSBPARAM=$P(^TMP("PSJ2",$J,PSBX,1),U,3)
"RTN","PSBCHKIV",34,0)
 ........I ($P(^TMP("PSJ2",$J,PSBX,1),U)'<$G(PSBLABDT)) S PSBIVCHG(PSBXOR,PSBCHGDT,PSBPARAM)=" changed to ",PSBIVCHG(PSBXOR,PSBCHGDT,PSBPARAM)=PSBIVCHG(PSBXOR,PSBCHGDT,PSBPARAM)_$$NEWDATA(PSBPARAM)
"RTN","PSBCHKIV",35,0)
 ......M PSBBAGD(PSBXOR,PSBXX,0)=^TMP("PSJ1",$J,0),PSBBAGD(PSBXOR,PSBXX,4)=^TMP("PSJ1",$J,4),PSBBAGD(PSBXOR,PSBXX,2)=^TMP("PSJ1",$J,2)
"RTN","PSBCHKIV",36,0)
 ......F PSBX=800,850,900,950,1000 D
"RTN","PSBCHKIV",37,0)
 .......I "800900"[PSBX M PSBBAGD(PSBXOR,PSBXX,PSBX,PSBBUID)=^TMP("PSJ1",$J,PSBX,PSBBUID)
"RTN","PSBCHKIV",38,0)
 .......I ("850950"[PSBX),'$D(PSBBAGD(PSBXOR,PSBXX,(PSBX-50),PSBBUID)) M PSBBAGD(PSBXOR,PSBXX,PSBX,PSBBUID)=^TMP("PSJ1",$J,PSBX)
"RTN","PSBCHKIV",39,0)
 .......S:PSBXX=1 PSBBUIDS(PSBXOR,PSBBUID)=PSBXOR_U_PSBBUID_U_($P(PSBBAGD(PSBXOR,PSBXX,2),U,2))_U_PSBSTATS
"RTN","PSBCHKIV",40,0)
 .......D:(PSBXX=1)
"RTN","PSBCHKIV",41,0)
 ........I (PSBX=800) F PSBXY=0 S PSBXY=$O(PSBBAGD(PSBXOR,1,800,PSBBUID,PSBXY)) Q:PSBXY=""  S PSBBUIDS(PSBXOR,PSBBUID,"ADD",PSBXY)="ADD"_U_PSBBAGD(PSBXOR,1,800,PSBBUID,PSBXY)
"RTN","PSBCHKIV",42,0)
 ........I (PSBX=900) F PSBXY=0 S PSBXY=$O(PSBBAGD(PSBXOR,1,900,PSBBUID,PSBXY)) Q:PSBXY=""  S PSBBUIDS(PSBXOR,PSBBUID,"SOL",PSBXY)="SOL"_U_PSBBAGD(PSBXOR,1,900,PSBBUID,PSBXY)
"RTN","PSBCHKIV",43,0)
 ........I (PSBX=850) F PSBXY=0 S PSBXY=$O(PSBBAGD(PSBXOR,1,850,PSBBUID,PSBXY)) Q:PSBXY=""  S PSBBUIDS(PSBXOR,PSBBUID,"ADD",PSBXY)="ADD"_U_PSBBAGD(PSBXOR,1,850,PSBBUID,PSBXY,0)
"RTN","PSBCHKIV",44,0)
 ........I (PSBX=950) F PSBXY=0 S PSBXY=$O(PSBBAGD(PSBXOR,1,950,PSBBUID,PSBXY)) Q:PSBXY=""  S PSBBUIDS(PSBXOR,PSBBUID,"SOL",PSBXY)="SOL"_U_PSBBAGD(PSBXOR,1,950,PSBBUID,PSBXY,0)
"RTN","PSBCHKIV",45,0)
 ......S PSBLOR=$P(^TMP("PSJ1",$J,0),U,3),PSBOR=$P(^TMP("PSJ1",$J,0),U,5) K ^TMP("PSJ1",$J)
"RTN","PSBCHKIV",46,0)
 ......I PSBOR["P" S PSBOR=$$PSBNXACT(PSBPIN,PSBOR)
"RTN","PSBCHKIV",47,0)
 S (PSBLINES,RESULTS(0))=0
"RTN","PSBCHKIV",48,0)
 Q:$G(PSBGNODE)=""
"RTN","PSBCHKIV",49,0)
 I $D(PSBBAGD) S PSBXOR="" F  S PSBXOR=$O(PSBBAGD(PSBXOR)) Q:PSBXOR=""  D
"RTN","PSBCHKIV",50,0)
 .S PSBXX=$O(PSBBAGD(PSBXOR,""),-1)
"RTN","PSBCHKIV",51,0)
 .I $P(PSBBAGD(PSBXOR,PSBXX,4),U,7)<PSBDT S PSBLINES=0 Q  ; "Whole of" order exp 3 dAYS ago proc nxt
"RTN","PSBCHKIV",52,0)
 .F PSBXX=1:1:($O(PSBBAGD(PSBXOR,""),-1)-1) S PSBXY=PSBXX+1 D:$D(PSBBAGD(PSBXOR,PSBXY))
"RTN","PSBCHKIV",53,0)
 ..D CLEAN^PSBVT,PSJ1^PSBVT(PSBPIN,$P(PSBBAGD(PSBXOR,PSBXX,0),U,3))
"RTN","PSBCHKIV",54,0)
 ..K PSBOTMP
"RTN","PSBCHKIV",55,0)
 ..I $D(PSBADA) M PSBOTMP("ADD")=PSBADA E  S PSBOTMP("ADD")=""
"RTN","PSBCHKIV",56,0)
 ..I $D(PSBSOLA) M PSBOTMP("SOL")=PSBSOLA E  S PSBOTMP("SOL")=""  ;solut,vol
"RTN","PSBCHKIV",57,0)
 ..K PSBADA,PSBSOLA
"RTN","PSBCHKIV",58,0)
 ..S PSBOTMP("INFUSION RATE")=$G(PSBIFR)
"RTN","PSBCHKIV",59,0)
 ..S PSBOTMP("MED ROUTE")=$G(PSBMR)
"RTN","PSBCHKIV",60,0)
 ..S PSBOTMP("REMARKS")=$G(PSBRMRK)
"RTN","PSBCHKIV",61,0)
 ..S PSBOTMP("OTHER PRINT INFO")=$G(PSBOTXT)
"RTN","PSBCHKIV",62,0)
 ..S PSBOTMP("PROVIDER")=PSBMD
"RTN","PSBCHKIV",63,0)
 ..S PSBOTMP("START DATE/TIME")=PSBOST
"RTN","PSBCHKIV",64,0)
 ..S PSBOTMP("STOP DATE/TIME")=PSBOSP
"RTN","PSBCHKIV",65,0)
 ..D CLEAN^PSBVT,PSJ1^PSBVT(PSBPIN,$P(PSBBAGD(PSBXOR,PSBXY,0),U,3))
"RTN","PSBCHKIV",66,0)
 ..D EN^PSJBCMA2(PSBPIN,$P(PSBBAGD(PSBXOR,PSBXY,0),U,3),1) S:$P(^TMP("PSJ2",$J,1,1),U)]"" PSBCHGDT=$P(^TMP("PSJ2",$J,1,1),U)
"RTN","PSBCHKIV",67,0)
 ..I $D(PSBADA)!($D(PSBOTMP("ADD"))) D CHKADD
"RTN","PSBCHKIV",68,0)
 ..I $D(PSBSOLA)!($D(PSBOTMP("SOL"))) D CHKSOL
"RTN","PSBCHKIV",69,0)
 ..I PSBIFR'=PSBOTMP("INFUSION RATE") S:PSBOTMP("INFUSION RATE")]"" PSBIVCHG(PSBXOR,PSBCHGDT,"INFUSION RATE")=" changed to "_PSBIFR
"RTN","PSBCHKIV",70,0)
 ..I PSBMR'=PSBOTMP("MED ROUTE") S:PSBMR'=PSBOTMP("MED ROUTE")]"" PSBIVCHG(PSBXOR,PSBCHGDT,"MED ROUTE")=" changed to "_PSBMR
"RTN","PSBCHKIV",71,0)
 ..I PSBRMRK'=PSBOTMP("REMARKS") S:PSBOTMP("REMARKS")]"" PSBIVCHG(PSBXOR,PSBCHGDT,"REMARKS")=" changed to "_PSBRMRK
"RTN","PSBCHKIV",72,0)
 ..I PSBOTXT'=PSBOTMP("OTHER PRINT INFO") S:PSBOTMP("OTHER PRINT INFO")]"" PSBIVCHG(PSBXOR,PSBCHGDT,"OTHER PRINT INFO")=" changed to "_PSBOTXT
"RTN","PSBCHKIV",73,0)
 ..I PSBMD'=PSBOTMP("PROVIDER") S:PSBOTMP("PROVIDER")]"" PSBIVCHG(PSBXOR,PSBCHGDT,"PROVIDER")=" changed to "_PSBMDX
"RTN","PSBCHKIV",74,0)
 ..I $E(PSBOST,1,12)'=$E(PSBOTMP("START DATE/TIME"),1,12) S PSBIVCHG(PSBXOR,PSBCHGDT,"START DATE/TIME")=" changed to "_PSBOSTX
"RTN","PSBCHKIV",75,0)
 ..I $E(PSBOSP,1,12)'=$E(PSBOTMP("STOP DATE/TIME"),1,12) S PSBIVCHG(PSBXOR,PSBCHGDT,"STOP DATE/TIME")=" changed to "_PSBOSPX
"RTN","PSBCHKIV",76,0)
 ..D CLEAN^PSBVT
"RTN","PSBCHKIV",77,0)
 ; Get RESULTS
"RTN","PSBCHKIV",78,0)
 D:$D(PSBIVCHG)
"RTN","PSBCHKIV",79,0)
 .S PSBXX="" F  S PSBXX=$O(PSBIVCHG(PSBXX)) S:PSBLINES>0 PSBLINES=PSBLINES+1,RESULTS(PSBLINES)="END",RESULTS(0)=PSBLINES Q:PSBXX=""  D
"RTN","PSBCHKIV",80,0)
 ..S PSBXY="" F  S PSBXY=$O(PSBBUIDS(PSBXX,PSBXY)) Q:PSBXY=""  D
"RTN","PSBCHKIV",81,0)
 ...S PSBLINES=PSBLINES+1,RESULTS(PSBLINES)=PSBBUIDS(PSBXX,PSBXY)_U_PSBCO(PSBXX)
"RTN","PSBCHKIV",82,0)
 ...S PSBXZ=0 F  S PSBXZ=$O(PSBBUIDS(PSBXX,PSBXY,"ADD",PSBXZ)) Q:PSBXZ=""  S PSBLINES=PSBLINES+1,RESULTS(PSBLINES)=PSBBUIDS(PSBXX,PSBXY,"ADD",PSBXZ)
"RTN","PSBCHKIV",83,0)
 ...S PSBXZ=0 F  S PSBXZ=$O(PSBBUIDS(PSBXX,PSBXY,"SOL",PSBXZ)) Q:PSBXZ=""  S PSBLINES=PSBLINES+1,RESULTS(PSBLINES)=PSBBUIDS(PSBXX,PSBXY,"SOL",PSBXZ)
"RTN","PSBCHKIV",84,0)
 ..S PSBXY="" F  S PSBXY=$O(PSBIVCHG(PSBXX,PSBXY),-1) Q:PSBXY=""  D
"RTN","PSBCHKIV",85,0)
 ...S PSBXZ="" F  S PSBXZ=$O(PSBIVCHG(PSBXX,PSBXY,PSBXZ)) Q:PSBXZ=""  D
"RTN","PSBCHKIV",86,0)
 ....I '("ADDITIVE STRENGTH SOLUTION VOLUME "[PSBXZ) S PSBLINES=PSBLINES+1,RESULTS(PSBLINES)="CD"_U_PSBXY_U_PSBXZ_PSBIVCHG(PSBXX,PSBXY,PSBXZ)
"RTN","PSBCHKIV",87,0)
 ....I "ADDITIVE STRENGTH SOLUTION VOLUME "[PSBXZ S PSBZX="" F  S PSBZX=$O(PSBIVCHG(PSBXX,PSBXY,PSBXZ,PSBZX)) Q:PSBZX=""  S PSBLINES=PSBLINES+1,RESULTS(PSBLINES)="CD"_U_PSBXY_U_PSBXZ_PSBIVCHG(PSBXX,PSBXY,PSBXZ,PSBZX)
"RTN","PSBCHKIV",88,0)
 K PSBIVCHG,PSBLINES,PSBBAGD,PSBAD,PSBSOL
"RTN","PSBCHKIV",89,0)
 Q
"RTN","PSBCHKIV",90,0)
CHKADD N X,PSBADDS ; Check addit(s)
"RTN","PSBCHKIV",91,0)
 I '$D(PSBADA),'$D(PSBOTMP("ADD")) Q  ; no adds
"RTN","PSBCHKIV",92,0)
 S X="" F  S X=$O(PSBOTMP("ADD",X)) Q:X=""  K PSBAD,PSBSTR S PSBAD=$P(PSBOTMP("ADD",X),U,2),PSBSTR=$P(PSBOTMP("ADD",X),U,4),PSBADDS(PSBAD,PSBSTR)=PSBOTMP("ADD",X)
"RTN","PSBCHKIV",93,0)
 S X="" F  S X=$O(PSBADA(X)) Q:X=""  D
"RTN","PSBCHKIV",94,0)
 .K PSBAD,PSBSTR S PSBAD=$P(PSBADA(X),U,2),PSBSTR=$P(PSBADA(X),U,4)
"RTN","PSBCHKIV",95,0)
 .I $D(PSBADDS(PSBAD,PSBSTR)) K PSBADDS(PSBAD,PSBSTR) Q
"RTN","PSBCHKIV",96,0)
 .I '$D(PSBADDS(PSBAD)) S PSBTXT=PSBADA(X),$P(PSBTXT,U,1)="",$P(PSBTXT,U,2)="",PSBIVCHG(PSBXOR,PSBCHGDT,"ADDITIVE",PSBAD)=" added"_$TR(PSBTXT,U," ")
"RTN","PSBCHKIV",97,0)
 .E  K PSBADDS(PSBAD) S PSBIVCHG(PSBXOR,PSBCHGDT,"STRENGTH ",PSBAD)=$P(PSBADA(X),U,3)_" changed to "_$P(PSBADA(X),U,4)
"RTN","PSBCHKIV",98,0)
 S X="" F  S X=$O(PSBADDS(X)) Q:X=""  I '$D(PSBIVCHG(PSBXOR,PSBCHGDT,"ADDITIVE",X)) S PSBTXT=PSBADDS(X,($O(PSBADDS(X,"")))),$P(PSBTXT,U,1)="",$P(PSBTXT,U,2)="",PSBIVCHG(PSBXOR,PSBOST,"ADDITIVE",X)=" deleted"_$TR(PSBTXT,U," ")
"RTN","PSBCHKIV",99,0)
 Q
"RTN","PSBCHKIV",100,0)
CHKSOL N Y,PSBSOLS ; Check solut(s)
"RTN","PSBCHKIV",101,0)
 I '$D(PSBSOLA),'$D(PSBOTMP("SOL")) Q  ; no sols
"RTN","PSBCHKIV",102,0)
 S Y="" F  S Y=$O(PSBOTMP("SOL",Y)) Q:Y=""  K PSBSOL,PSBVOL S PSBSOL=$P(PSBOTMP("SOL",Y),U,2),PSBVOL=$P(PSBOTMP("SOL",Y),U,4),PSBSOLS(PSBSOL,PSBVOL)=PSBOTMP("SOL",Y)
"RTN","PSBCHKIV",103,0)
 S Y="" F  S Y=$O(PSBSOLA(Y)) Q:Y=""  D
"RTN","PSBCHKIV",104,0)
 .K PSBSOL,PSBVOL S PSBSOL=$P(PSBSOLA(Y),U,2),PSBVOL=$P(PSBSOLA(Y),U,4)
"RTN","PSBCHKIV",105,0)
 .I $D(PSBSOLS(PSBSOL,PSBVOL)) K PSBSOLS(PSBSOL,PSBVOL) Q
"RTN","PSBCHKIV",106,0)
 .I '$D(PSBSOLS(PSBSOL)) S PSBTXT=PSBSOLA(Y),$P(PSBTXT,U,1)="",$P(PSBTXT,U,2)="",PSBIVCHG(PSBXOR,PSBCHGDT,"SOLUTION",PSBSOL)=" added"_$TR(PSBTXT,U," ")
"RTN","PSBCHKIV",107,0)
 .E  K PSBSOLS(PSBSOL) S PSBIVCHG(PSBXOR,PSBCHGDT,"VOLUME ",PSBSOL)=$P(PSBSOLA(Y),U,3)_" changed to "_$P(PSBSOLA(Y),U,4)
"RTN","PSBCHKIV",108,0)
 S Y="" F  S Y=$O(PSBSOLS(Y)) Q:Y=""  S:'$D(PSBIVCHG(PSBXOR,PSBCHGDT,"SOLUTION",Y)) PSBTXT=PSBSOLS(Y,($O(PSBSOLS(Y,"")))),$P(PSBTXT,U,1)="",$P(PSBTXT,U,2)="",PSBIVCHG(PSBXOR,PSBCHGDT,"SOLUTION",Y)=" deleted"_$TR(PSBTXT,U," ")
"RTN","PSBCHKIV",109,0)
 Q
"RTN","PSBCHKIV",110,0)
PSBNXACT(DFN,PORDN) ;
"RTN","PSBCHKIV",111,0)
 N PSBDFN,PSBOR S PSBDFN=DFN,PSBOR=PORDN K PSBDID
"RTN","PSBCHKIV",112,0)
 S PSBNXACT="" I (PSBDFN="")!(PSBOR="")!(PSBOR'["P") Q PSBNXACT
"RTN","PSBCHKIV",113,0)
 F  Q:PSBOR=""  Q:$D(PSBDID(PSBOR))  D
"RTN","PSBCHKIV",114,0)
 .K ^TMP("PSJ1",$J) D EN^PSJBCMA1(PSBDFN,PSBOR,1) S PSBOR=$P(^TMP("PSJ1",$J,0),U,5) K ^TMP("PSJ1",$J)
"RTN","PSBCHKIV",115,0)
 .I $G(PSBOR)]"",$G(PSBOR)'["P" S PSBNXACT=PSBOR S PSBOR=""
"RTN","PSBCHKIV",116,0)
 .E  S:$G(PSBOR)]"" (PSBNXACT,PSBDID($G(PSBOR)))=""
"RTN","PSBCHKIV",117,0)
 .K ^TMP("PSJ1",$J)
"RTN","PSBCHKIV",118,0)
 I PSBNXACT="" D EN^PSJBCMA1(PSBDFN,PSBLOR,1) I $P(^TMP("PSJ1",$J,4),U,7)<PSBDT K PSBBAGD(PSBXOR),PSBBUIDS(PSBXOR),PSBIVCHG(PSBXOR)
"RTN","PSBCHKIV",119,0)
 Q PSBNXACT
"RTN","PSBCHKIV",120,0)
NEWDATA(PSBPARM) ;
"RTN","PSBCHKIV",121,0)
 S NEWDATA="" N PSBDX S PSBDX="",PSBDX=$O(PSBIVCHG(PSBXOR,PSBDX),-1)
"RTN","PSBCHKIV",122,0)
 F  S PSBDX=$O(PSBIVCHG(PSBXOR,PSBDX),-1) Q:PSBDX=""  D:$D(PSBIVCHG(PSBXOR,PSBDX,PSBPARM))  Q:PSBDX=""
"RTN","PSBCHKIV",123,0)
 .S PSBIVCHG(PSBXOR,PSBDX,PSBPARM)=" changed to "_$G(^TMP("PSJ2",$J,PSBX,2)),PSBDX=""
"RTN","PSBCHKIV",124,0)
 I $G(PSBPARM)="INFUSION RATE" Q $P(^TMP("PSJ1",$J,2),U,4)
"RTN","PSBCHKIV",125,0)
 I $G(PSBPARM)="MED ROUTE" Q $P(^TMP("PSJ1",$J,1),U,13)
"RTN","PSBCHKIV",126,0)
 I $G(PSBPARM)="PROVIDER" Q $P(^TMP("PSJ1",$J,1),U,2)
"RTN","PSBCHKIV",127,0)
 I $G(PSBPARM)="REMARKS" Q $G(^TMP("PSJ1",$J,6))
"RTN","PSBCHKIV",128,0)
 I $G(PSBPARM)="OTHER PRINT INFO" Q $G(^TMP("PSJ1",$J,3))
"RTN","PSBCHKIV",129,0)
 I $G(PSBPARM)="STOP DATE/TIME" Q $P(^TMP("PSJ1",$J,4),U,8)
"RTN","PSBCHKIV",130,0)
 I $G(PSBPARM)="START DATE/TIME" Q $P(^TMP("PSJ1",$J,4),U,6)
"RTN","PSBCHKIV",131,0)
 Q NEWDATA
"RTN","PSBMD")
0^5^B70799803
"RTN","PSBMD",1,0)
PSBMD ;BIRMINGHAM/EFC-BCMA MISSING DOSE FUNCTIONS ;Mar 2004
"RTN","PSBMD",2,0)
 ;;3.0;BAR CODE MED ADMIN;;Mar 2004
"RTN","PSBMD",3,0)
 ;
"RTN","PSBMD",4,0)
 ; Reference/IA
"RTN","PSBMD",5,0)
 ; ^DIC(42/10039
"RTN","PSBMD",6,0)
 ; ^DPT(/10035
"RTN","PSBMD",7,0)
 ; IN5^VADPT/10061
"RTN","PSBMD",8,0)
 ; ^XMB/10070
"RTN","PSBMD",9,0)
 ; 52.6/436
"RTN","PSBMD",10,0)
 ; 52.7/437
"RTN","PSBMD",11,0)
 ;
"RTN","PSBMD",12,0)
RPC(RESULTS,PSBDFN,PSBDRUG,PSBDOSE,PSBRSN,PSBADMIN,PSBNEED,PSBUID,PSBON,PSBSCHD) ;
"RTN","PSBMD",13,0)
 ;
"RTN","PSBMD",14,0)
 ; RPC: PSB SUBMIT MISSING DOSE
"RTN","PSBMD",15,0)
 ;
"RTN","PSBMD",16,0)
 ; Description:
"RTN","PSBMD",17,0)
 ; Allows the client to submit a missing dose interactively
"RTN","PSBMD",18,0)
 ;
"RTN","PSBMD",19,0)
 N DFN,PSBNOW,PSBFDA,PSBIENS,PSBMD,PSBMSG
"RTN","PSBMD",20,0)
 D NEW(.PSBMD)
"RTN","PSBMD",21,0)
 I +PSBMD(0)<1 S RESULTS(0)="-1^Unable to create missing dose request"  Q
"RTN","PSBMD",22,0)
 S PSBIENS=+PSBMD(0)_","
"RTN","PSBMD",23,0)
 D NOW^%DTC S PSBNOW=%
"RTN","PSBMD",24,0)
 S PSBFDA(53.68,PSBIENS,.02)=PSBNOW
"RTN","PSBMD",25,0)
 S PSBFDA(53.68,PSBIENS,.03)=DUZ
"RTN","PSBMD",26,0)
 S PSBFDA(53.68,PSBIENS,.04)=DUZ(2)
"RTN","PSBMD",27,0)
 S PSBFDA(53.68,PSBIENS,.11)=PSBDFN
"RTN","PSBMD",28,0)
 S X=$G(^DPT(PSBDFN,.1)) I X]"" S X=$O(^DIC(42,"B",X,0)) S:X PSBFDA(53.68,PSBIENS,.12)=X
"RTN","PSBMD",29,0)
 S PSBFDA(53.68,PSBIENS,.13)=PSBDRUG
"RTN","PSBMD",30,0)
 S PSBFDA(53.68,PSBIENS,.14)=PSBDOSE
"RTN","PSBMD",31,0)
 S PSBFDA(53.68,PSBIENS,.15)=PSBRSN
"RTN","PSBMD",32,0)
 S PSBFDA(53.68,PSBIENS,.16)=PSBADMIN
"RTN","PSBMD",33,0)
 S PSBFDA(53.68,PSBIENS,.17)=PSBNEED
"RTN","PSBMD",34,0)
 S PSBFDA(53.68,PSBIENS,.19)=PSBSCHD
"RTN","PSBMD",35,0)
 S PSBFDA(53.68,PSBIENS,.25)=PSBUID
"RTN","PSBMD",36,0)
 S DFN=PSBDFN D IN5^VADPT S PSBFDA(53.68,PSBIENS,.18)=$P(VAIP(6),U,1)
"RTN","PSBMD",37,0)
 D FILE^DIE("","PSBFDA","PSBMSG")
"RTN","PSBMD",38,0)
 I $G(PSBUID)'="" D
"RTN","PSBMD",39,0)
 .D PSJ1^PSBVT(PSBDFN,PSBON) K PSBADA,PSBSOLA
"RTN","PSBMD",40,0)
 .I '$D(PSBUIDA(PSBUID)) F  D PSJ1^PSBVT(PSBDFN,PSBPONX) K PSBADA,PSBSOLA Q:$D(PSBUIDA(PSBUID))  Q:PSBPONX=""
"RTN","PSBMD",41,0)
 .F I=1:1 S PSBAD=$P(PSBUIDA(PSBUID),U,I) Q:PSBAD=""  I PSBAD["ADD" S PSBADA($P(PSBAD,";",2))=""
"RTN","PSBMD",42,0)
 .I $D(PSBADA) S X="" F I=1:1 S X=$O(PSBADA(X)) Q:X=""  S PSBFDA(53.686,I_","_PSBIENS,.01)=X,^PSB(53.68,+PSBIENS,.6,I,0)=I
"RTN","PSBMD",43,0)
 .F I=1:1 S PSBSOL=$P(PSBUIDA(PSBUID),U,I) Q:PSBSOL=""  I PSBSOL["SOL" S PSBSOLA($P(PSBSOL,";",2))=""
"RTN","PSBMD",44,0)
 .I $D(PSBSOLA) S X="" F I=1:1 S X=$O(PSBSOLA(X)) Q:X=""  S PSBFDA(53.687,I_","_PSBIENS,.01)=X,^PSB(53.68,+PSBIENS,.7,I,0)=I
"RTN","PSBMD",45,0)
 I $G(PSBUID)="",$G(PSBDRUG)="" D
"RTN","PSBMD",46,0)
 .D PSJ1^PSBVT(PSBDFN,PSBON)
"RTN","PSBMD",47,0)
 .I $D(PSBADA) S X="" F I=1:1 S X=$O(PSBADA(X)) Q:X=""  S PSBFDA(53.686,I_","_PSBIENS,.01)=$P(PSBADA(X),U,2),^PSB(53.68,+PSBIENS,.6,I,0)=X
"RTN","PSBMD",48,0)
 .I $D(PSBSOLA) S X="" F I=1:1 S X=$O(PSBSOLA(X)) Q:X=""  S PSBFDA(53.687,I_","_PSBIENS,.01)=$P(PSBSOLA(X),U,2),^PSB(53.68,+PSBIENS,.7,I,0)=X
"RTN","PSBMD",49,0)
 D FILE^DIE("","PSBFDA","PSBMSG")
"RTN","PSBMD",50,0)
 D SUBMIT(+PSBIENS)
"RTN","PSBMD",51,0)
 S RESULTS(0)="1^Missing Dose Submitted^"_+PSBIENS
"RTN","PSBMD",52,0)
 D CLEAN^PSBVT
"RTN","PSBMD",53,0)
 Q
"RTN","PSBMD",54,0)
 ;
"RTN","PSBMD",55,0)
XQ ; Called via Kernel Menus
"RTN","PSBMD",56,0)
 N PSBMD,PSBSAVE,DA,DIK,DR,DDSFILE,XMY,XMTEXT,XMSUB
"RTN","PSBMD",57,0)
 D NEW(.PSBMD)
"RTN","PSBMD",58,0)
 I +PSBMD(0)<1 W !,"Error: ",$P(PSBMD(0),U,2) S DIR(0)="E" D ^DIR Q
"RTN","PSBMD",59,0)
 S DA=+PSBMD(0),DR="[PSB MISSING DOSE REQUEST]",DDSFILE=53.68 D ^DDS
"RTN","PSBMD",60,0)
 W @IOF
"RTN","PSBMD",61,0)
 I 'PSBSAVE W !,"Cancelling Request..." S DIK="^PSB(53.68," D ^DIK W "Cancelled!"
"RTN","PSBMD",62,0)
 D:PSBSAVE SUBMIT(DA)
"RTN","PSBMD",63,0)
 Q
"RTN","PSBMD",64,0)
 ;
"RTN","PSBMD",65,0)
SUBMIT(DA) ; Submit Request to Pharmacy
"RTN","PSBMD",66,0)
 N PSBWRD,PSBMG,PSBPRT
"RTN","PSBMD",67,0)
 S PSBWRD=$P(^PSB(53.68,DA,.1),U,2)
"RTN","PSBMD",68,0)
 S PSBWRD=+$G(^DIC(42,+PSBWRD,44))
"RTN","PSBMD",69,0)
 ;
"RTN","PSBMD",70,0)
 ; Get Mail Group
"RTN","PSBMD",71,0)
 ;
"RTN","PSBMD",72,0)
 S PSBMG=$$GET^XPAR(PSBWRD_";SC(","PSB MG MISSING DOSE",,"E")
"RTN","PSBMD",73,0)
 S:PSBMG="" PSBMG=$$GET^XPAR("DIV","PSB MG MISSING DOSE",,"E")
"RTN","PSBMD",74,0)
 S $P(^PSB(53.68,DA,0),U,5)=PSBMG ; Add MG to notification
"RTN","PSBMD",75,0)
 ;
"RTN","PSBMD",76,0)
 ; Get Printer
"RTN","PSBMD",77,0)
 ;
"RTN","PSBMD",78,0)
 S PSBPRT=$$GET^XPAR(PSBWRD_";SC(","PSB PRINTER MISSING DOSE",,"E")
"RTN","PSBMD",79,0)
 S:PSBPRT="" PSBPRT=$$GET^XPAR("DIV","PSB PRINTER MISSING DOSE",,"E")
"RTN","PSBMD",80,0)
 S $P(^PSB(53.68,DA,0),U,6)=PSBPRT ; Add MG to notification
"RTN","PSBMD",81,0)
 ;
"RTN","PSBMD",82,0)
 ; Send the report to the specified printer
"RTN","PSBMD",83,0)
 ;
"RTN","PSBMD",84,0)
 D:PSBPRT]""
"RTN","PSBMD",85,0)
 .W !,"Submitting Request To Pharmacy on device ",PSBPRT,"..."
"RTN","PSBMD",86,0)
 .D NOW^%DTC
"RTN","PSBMD",87,0)
 .S ZTIO=PSBPRT
"RTN","PSBMD",88,0)
 .S ZTDTH=%
"RTN","PSBMD",89,0)
 .S ZTDESC="BCMA - MISSING DOSE REQUEST"
"RTN","PSBMD",90,0)
 .S ZTRTN="DQ^PSBMD("_DA_")"
"RTN","PSBMD",91,0)
 .D ^%ZTLOAD
"RTN","PSBMD",92,0)
 .W "Done!"
"RTN","PSBMD",93,0)
 ;
"RTN","PSBMD",94,0)
 ; Send the same stuff to the mail group
"RTN","PSBMD",95,0)
 ;
"RTN","PSBMD",96,0)
 D:PSBMG]""
"RTN","PSBMD",97,0)
 .W !,"Notifying Pharmacy via Mail Group ",PSBMG,"..."
"RTN","PSBMD",98,0)
 .D HFSOPEN^PSBUTL("MISSING DOSE")
"RTN","PSBMD",99,0)
 .U IO D DQ(DA,1)
"RTN","PSBMD",100,0)
 .D HFSCLOSE^PSBUTL("MISSING DOSE")
"RTN","PSBMD",101,0)
 .S XMY("G."_PSBMG)="",XMTEXT="^TMP(""PSBO"",$J,"
"RTN","PSBMD",102,0)
 .S XMSUB="BCMA - Missing Dose Request"
"RTN","PSBMD",103,0)
 .D ^XMD
"RTN","PSBMD",104,0)
 .W "Done!"
"RTN","PSBMD",105,0)
 Q
"RTN","PSBMD",106,0)
 ;
"RTN","PSBMD",107,0)
DQ(PSBMD,PSBMM) ; Dequeue report from Taskman
"RTN","PSBMD",108,0)
 N PSBFLD,PSBRET
"RTN","PSBMD",109,0)
 Q:'$D(^PSB(53.68,PSBMD,0))  ; No Such Report
"RTN","PSBMD",110,0)
 S PSBCFLD=$P(^PSB(53.68,PSBMD,.1),U,3)
"RTN","PSBMD",111,0)
 D:'$G(PSBMM)  ; It is not a mail message
"RTN","PSBMD",112,0)
 .W !,$TR($J("",75)," ","=")
"RTN","PSBMD",113,0)
 .W !,"Report:       MISSING DOSE REQUEST"
"RTN","PSBMD",114,0)
 .W !,"Date Created: " D NOW^%DTC S Y=% D D^DIQ W Y
"RTN","PSBMD",115,0)
 .W !,$TR($J("",75)," ","="),!
"RTN","PSBMD",116,0)
 I $G(PSBCFLD)'="" F PSBFLD=.01,.02,.03,.04,.05,.06,.11,.12,.18,.13,.14,.19,.15,.16,.17 D OUT
"RTN","PSBMD",117,0)
 I $G(PSBCFLD)="" F PSBFLD=.01,.02,.03,.04,.05,.06,.11,.12,.18,.25,.15,.19,.16,.17 D OUT
"RTN","PSBMD",118,0)
 I $D(^PSB(53.68,PSBMD,.6)) S X=0 F  S X=$O(^PSB(53.68,PSBMD,.6,X)) Q:'X  W !?3,"ADDITIVE:  ",$$GET1^DIQ(52.6,+^PSB(53.68,PSBMD,.6,X,0),.01)
"RTN","PSBMD",119,0)
 I $D(^PSB(53.68,PSBMD,.7)) S X=0 F  S X=$O(^PSB(53.68,PSBMD,.7,X)) Q:'X  W !?3,"SOLUTION:  ",$$GET1^DIQ(52.7,+^PSB(53.68,PSBMD,.7,X,0),.01)
"RTN","PSBMD",120,0)
 Q
"RTN","PSBMD",121,0)
OUT ;
"RTN","PSBMD",122,0)
 D FIELD^DID(53.68,PSBFLD,"","LABEL","PSBRET")
"RTN","PSBMD",123,0)
 W !?3,PSBRET("LABEL"),":" F  Q:$X>30  W "."
"RTN","PSBMD",124,0)
 W $$GET1^DIQ(53.68,PSBMD_",",PSBFLD)
"RTN","PSBMD",125,0)
 I PSBFLD=.11 D
"RTN","PSBMD",126,0)
 .S PSBDFN=$$GET1^DIQ(53.68,PSBMD_",",.11,"I")
"RTN","PSBMD",127,0)
 .W !?3,"SSN (LAST 4 NUMBERS):" F  Q:$X>30  W "."
"RTN","PSBMD",128,0)
 .W $E($$GET1^DIQ(2,PSBDFN_",",.09),6,9)
"RTN","PSBMD",129,0)
 W:PSBFLD=.13 " ("_$P($G(^PSB(53.68,PSBMD,.1)),U,3)_")"
"RTN","PSBMD",130,0)
 S ZTREQ="@"
"RTN","PSBMD",131,0)
 Q
"RTN","PSBMD",132,0)
 ;
"RTN","PSBMD",133,0)
NEW(RESULTS) ; Create a new missing dose request
"RTN","PSBMD",134,0)
 ; Called interactively and via RPCBroker
"RTN","PSBMD",135,0)
 N DIC
"RTN","PSBMD",136,0)
 K RESULTS
"RTN","PSBMD",137,0)
 I '+$G(DUZ) S RESULTS(0)="-1^Undefined User" Q
"RTN","PSBMD",138,0)
 I '$G(DUZ(2)) S RESULTS(0)="-1^Undefined Division" Q
"RTN","PSBMD",139,0)
 ; Lock Log
"RTN","PSBMD",140,0)
 L +^PSB(53.68,0):3
"RTN","PSBMD",141,0)
 E  S RESULTS(0)="-1^Request Log Locked" Q
"RTN","PSBMD",142,0)
 ; Generate Unique Entry and Create
"RTN","PSBMD",143,0)
 F  D NOW^%DTC S X=$E(%_"000000",1,14),X=(1700+$E(X,1,3))_$E(X,4,14),X="MD-"_$TR(X,".","-") Q:'$D(^PSB(53.68,"B",X))
"RTN","PSBMD",144,0)
 S DIC="^PSB(53.68,",DIC(0)="L"
"RTN","PSBMD",145,0)
 S DIC("DR")=".02///N;.03////^S X=DUZ;.04////^S X=DUZ(2);.07///1"
"RTN","PSBMD",146,0)
 K D0         ;VRN
"RTN","PSBMD",147,0)
 D FILE^DICN
"RTN","PSBMD",148,0)
 L -^PSB(53.68,0)
"RTN","PSBMD",149,0)
 ; Okay, setup return and Boogie
"RTN","PSBMD",150,0)
 I +Y<1 S RESULTS(0)="-1^Error Creating Request"
"RTN","PSBMD",151,0)
 E  S RESULTS(0)=Y
"RTN","PSBMD",152,0)
 Q
"RTN","PSBMD",153,0)
 ;
"RTN","PSBMD",154,0)
VAL(PSBFLDS) ; Validate that fields in PSBFLDS are filled in
"RTN","PSBMD",155,0)
 N PSB,PSBFLD,PSBMSG
"RTN","PSBMD",156,0)
 F PSB=1:1 Q:$P(PSBFLDS,";",PSB)=""  S PSBFLD=$P(PSBFLDS,";",PSB),PSBFLD(PSBFLD)=$$GET^DDSVAL(53.68,DA,PSBFLD)
"RTN","PSBMD",157,0)
 I $D(PSBFLD(.21)) K:PSBFLD(.21)="N" PSBFLD(.22),PSBFLD(.23)
"RTN","PSBMD",158,0)
 S PSB=""  F  S PSB=$O(PSBFLD(PSB)) Q:PSB=""  D:PSBFLD(PSB)=""
"RTN","PSBMD",159,0)
 .I '$D(PSBMSG) S PSBMSG(0)="UNABLE TO FILE REQUEST",PSBMSG(1)=" ",PSBMSG(2)="ERROR: MISSING DATA - ALL FIELDS ARE REQUIRED"
"RTN","PSBMD",160,0)
 .D FIELD^DID(53.68,PSB,"","TITLE;LABEL","PSB")
"RTN","PSBMD",161,0)
 .S X="  Missing Field: "_$S(PSB("TITLE")]"":PSB("TITLE"),1:PSB("LABEL")),PSBMSG($O(PSBMSG(""),-1)+1)=X
"RTN","PSBMD",162,0)
 Q:'$D(PSBMSG)  ; All is well
"RTN","PSBMD",163,0)
 D MSG^DDSUTL(.PSBMSG)
"RTN","PSBMD",164,0)
 S DDSERROR=1
"RTN","PSBMD",165,0)
 Q
"RTN","PSBMD",166,0)
 ;
"RTN","PSBMD",167,0)
FLWUP ; Follow-Up on missing dose
"RTN","PSBMD",168,0)
 N DIR,PSBIEN,PSBX,DA,DR,DDSFILE,PSBHDR,PSBDRUG
"RTN","PSBMD",169,0)
 S Y="" F  Q:Y="^"  D
"RTN","PSBMD",170,0)
 .K ^TMP("PSB",$J) S X=""
"RTN","PSBMD",171,0)
 .F  S X=$O(^PSB(53.68,"AS",1,X),-1) Q:'X  S Y=$O(^TMP("PSB",$J,""),-1)+1,^TMP("PSB",$J,Y)=X,^TMP("PSB",$J,0)=Y
"RTN","PSBMD",172,0)
 .I '$O(^TMP("PSB",$J,0)) W !!,"No Unresolved Missing Dose Requests Found." S Y="^" Q
"RTN","PSBMD",173,0)
 .S PSBHDR="Currently Unresolved Missing Dose Requests"
"RTN","PSBMD",174,0)
 .W @IOF,PSBHDR,!,$TR($J("",IOM)," ","-")
"RTN","PSBMD",175,0)
 .F PSBX=0:0 S PSBX=$O(^TMP("PSB",$J,PSBX)) Q:'PSBX!(Y="^")  S PSBIEN=^(PSBX)_"," D
"RTN","PSBMD",176,0)
 ..W !,$J(PSBX,2),". ",$$GET1^DIQ(53.68,PSBIEN,.01)
"RTN","PSBMD",177,0)
 ..W ?25,$$GET1^DIQ(53.68,PSBIEN,.11)
"RTN","PSBMD",178,0)
 ..W ?57,$$GET1^DIQ(53.68,PSBIEN,.12)
"RTN","PSBMD",179,0)
 ..S PSBDRUG=$$GET1^DIQ(53.68,PSBIEN,.13)
"RTN","PSBMD",180,0)
 ..I PSBDRUG]"" W !?5,PSBDRUG
"RTN","PSBMD",181,0)
 ..I PSBDRUG="" D
"RTN","PSBMD",182,0)
 ...W !?5,"UNIQUE ID: ",$$GET1^DIQ(53.68,PSBIEN,.25)
"RTN","PSBMD",183,0)
 ...S X=0 F  S X=$O(^PSB(53.68,+PSBIEN,.6,X)) Q:'X  W !?10,"ADDITIVES:  ",$$GET1^DIQ(52.6,+^PSB(53.68,+PSBIEN,.6,X,0),.01)
"RTN","PSBMD",184,0)
 ...S X=0 F  S X=$O(^PSB(53.68,+PSBIEN,.7,X)) Q:'X  W !?10,"SOLUTIONS:  ",$$GET1^DIQ(52.7,+^PSB(53.68,+PSBIEN,.7,X,0),.01)
"RTN","PSBMD",185,0)
 ..S:$Y>(IOSL-4) Y=$$PAGE(PSBX)
"RTN","PSBMD",186,0)
 .S:Y'="^" Y=$$PAGE(PSBX)
"RTN","PSBMD",187,0)
 Q
"RTN","PSBMD",188,0)
PAGE(PSBIX) ;
"RTN","PSBMD",189,0)
 ;
"RTN","PSBMD",190,0)
 N X,X1,PSBCX,PSBDX
"RTN","PSBMD",191,0)
 S DIR("A")="Select Missing Dose Request # (<RET> to continue, '^' to quit)"
"RTN","PSBMD",192,0)
 I PSBIX="" S DIR("A")="Select Missing Dose Request # (<RET> or '^' to quit)"
"RTN","PSBMD",193,0)
 S DIR(0)="NO^1:"_$S(PSBIX="":$O(^TMP("PSB",$J,PSBX),-1),1:PSBIX)_":0"
"RTN","PSBMD",194,0)
 D ^DIR S PSBDX=+Y
"RTN","PSBMD",195,0)
 I PSBIX="",Y="" S Y="^" Q Y
"RTN","PSBMD",196,0)
 I $G(DTOUT) S Y="^" Q Y
"RTN","PSBMD",197,0)
 I Y="^" Q Y
"RTN","PSBMD",198,0)
 I Y="" W @IOF,PSBHDR,!,$TR($J("",IOM)," ","-") Q Y
"RTN","PSBMD",199,0)
 S (DA,PSBCX)=^TMP("PSB",$J,+Y),DR="[PSB MISSING DOSE FOLLOWUP]",DDSFILE=53.68
"RTN","PSBMD",200,0)
 D  Q Y
"RTN","PSBMD",201,0)
 .D ^DDS
"RTN","PSBMD",202,0)
 .I $D(^PSB(53.68,"AS",0,PSBCX)) K ^TMP("PSB",$J) S X="" F  S X=$O(^PSB(53.68,"AS",1,X),-1) Q:'X  S X1=$O(^TMP("PSB",$J,""),-1)+1,^TMP("PSB",$J,X1)=X,^TMP("PSB",$J,0)=X1
"RTN","PSBMD",203,0)
 .S PSBX=0 W @IOF,PSBHDR,!,$TR($J("",IOM)," ","-")
"RTN","PSBMD",204,0)
 ;
"RTN","PSBMD",205,0)
POST ;call from 'Patient' field of screenman form PSB MISSING DOSE REQUEST
"RTN","PSBMD",206,0)
 ; 
"RTN","PSBMD",207,0)
 N DFN
"RTN","PSBMD",208,0)
 S DFN=X D IN5^VADPT
"RTN","PSBMD",209,0)
 D PUT^DDSVAL(DIE,.DA,.12,$P(VAIP(5),U,2))  ; value of DIE is 53.68, BCMA MISSING DOSE REQUEST FILE called from ScreenMan
"RTN","PSBMD",210,0)
 D PUT^DDSVAL(DIE,.DA,.18,$P(VAIP(6),U,1),"","I")  ; value of DIE is 53.68, BCMA MISSING DOSE REQUEST FILE called from ScreenMan
"RTN","PSBMD",211,0)
 D REFRESH^DDSUTL
"RTN","PSBMD",212,0)
 Q
"RTN","PSBML")
0^6^B78825468
"RTN","PSBML",1,0)
PSBML ;BIRMINGHAM/EFC-BCMA MED LOG FUNCTIONS ;Mar 2004
"RTN","PSBML",2,0)
 ;;3.0;BAR CODE MED ADMIN;;Mar 2004
"RTN","PSBML",3,0)
 ;
"RTN","PSBML",4,0)
 ; Reference/IA
"RTN","PSBML",5,0)
 ; ^DPT/10035
"RTN","PSBML",6,0)
 ; DIC(42/10039
"RTN","PSBML",7,0)
 ; DIC(42/2440
"RTN","PSBML",8,0)
 ; File 200/10060
"RTN","PSBML",9,0)
 ; EN^PSJBCMA3/3320
"RTN","PSBML",10,0)
 ; $$SITE^VASITE/10112
"RTN","PSBML",11,0)
 ;
"RTN","PSBML",12,0)
RPC(RESULTS,PSBHDR,PSBREC) ; Main Client Filing Point
"RTN","PSBML",13,0)
 ;
"RTN","PSBML",14,0)
 ; RPC: PSB TRANSACTION
"RTN","PSBML",15,0)
 ;
"RTN","PSBML",16,0)
 ; Description:
"RTN","PSBML",17,0)
 ; This is the ONLY place that the client is able to file data
"RTN","PSBML",18,0)
 ; into the MED LOG and the ONLY Place in the whole BCMA that an
"RTN","PSBML",19,0)
 ; entry into the med log is made.
"RTN","PSBML",20,0)
 ;
"RTN","PSBML",21,0)
 N PSBORD,PSBTRAN,PSBFDA      ;VRN
"RTN","PSBML",22,0)
 K PSBIEN,PSBHL7
"RTN","PSBML",23,0)
 S PSBIEN=$P(PSBHDR,U,1)
"RTN","PSBML",24,0)
 S PSBTRAN=$P(PSBHDR,U,2),PSBHL7=PSBTRAN
"RTN","PSBML",25,0)
 S PSBAUDIT=$S(PSBIEN="+1":0,1:1)
"RTN","PSBML",26,0)
 D NOW^%DTC S PSBNOW=%
"RTN","PSBML",27,0)
 ;
"RTN","PSBML",28,0)
 I PSBTRAN="ADD COMMENT" D COMMENT^PSBML1 Q
"RTN","PSBML",29,0)
 ;
"RTN","PSBML",30,0)
 I PSBTRAN="PRN EFFECTIVENESS" D PRN^PSBML1 Q
"RTN","PSBML",31,0)
 ;
"RTN","PSBML",32,0)
 I PSBTRAN="UPDATE STATUS" D UPDATE^PSBML1 Q
"RTN","PSBML",33,0)
 ;
"RTN","PSBML",34,0)
 ; BEGINNING OF THE SAGG TYPE TRACKING MECHANISM
"RTN","PSBML",35,0)
 N PSBWARD S PSBWARD=$G(^DPT(+$G(PSBREC(0)),.1),"UNKNOWN"),^PSB("SAGG",PSBWARD,DT)=$G(^PSB("SAGG",PSBWARD,DT))+1
"RTN","PSBML",36,0)
 ; END OF SAGG TYPE TRACKING
"RTN","PSBML",37,0)
 ;
"RTN","PSBML",38,0)
 ; SETUP FOR MED PASS, THE ONLY TYPE LEFT
"RTN","PSBML",39,0)
 I PSBREC(1)?1U1";"1.6N S PSBREC(1)=$P(PSBREC(1),";",1)_$E(PSBREC(1))
"RTN","PSBML",40,0)
 D PSJ1^PSBVT(PSBREC(0),$P(PSBREC(1),";",2)_$P(PSBREC(1),";",1))
"RTN","PSBML",41,0)
 S PSBTAB=$P(PSBREC(9),U,1),PSBUID=$P(PSBREC(9),U,2)
"RTN","PSBML",42,0)
 ;
"RTN","PSBML",43,0)
 D:PSBTRAN="MEDPASS"
"RTN","PSBML",44,0)
 .I PSBREC(7)="BCMA/CPRS Interface Entry." S PSBNOW=PSBREC(5)         ;Med order button admin time
"RTN","PSBML",45,0)
 .F X=0:1:9 S PSBREC(X)=$G(PSBREC(X))
"RTN","PSBML",46,0)
 .I PSBREC(1)?1U1";".N S PSBREC(1)=$P(PSBREC(1),";",2)_$P(PSBREC(1),";",1)
"RTN","PSBML",47,0)
 .I PSBREC(1)["V",+PSBREC(5)>0,+$P(PSBREC(5),".",2)=0,PSBIVT'["P" D NOW^%DTC S PSBREC(5)=$P(PSBREC(5),".",1)_"."_$P(%,".",2)
"RTN","PSBML",48,0)
 .I $P(PSBREC(9),U,1)="IVTAB",$P(PSBREC(9),U,2)="" S PSBUID=$$GETWSID^PSBVDLU2(PSBREC(0),PSBREC(1))
"RTN","PSBML",49,0)
 .I $P(PSBREC(9),U,1)="PBTAB",$P(PSBREC(9),U,2)="",PSBREC(3)'="M",PSBREC(3)'="R",PSBREC(3)'="H" S PSBUID=$$GETWSID^PSBVDLU2(PSBREC(0),PSBREC(1))
"RTN","PSBML",50,0)
 .; Check Business Rules
"RTN","PSBML",51,0)
 .; On-Call Rule
"RTN","PSBML",52,0)
 .D:PSBREC(2)="OC"
"RTN","PSBML",53,0)
 ..S X=$O(^PSB(53.79,"AORD",PSBREC(0),PSBREC(1),"")) Q:X=""
"RTN","PSBML",54,0)
 ..S Y=$O(^PSB(53.79,"AORD",PSBREC(0),PSBREC(1),X,0))
"RTN","PSBML",55,0)
 ..I $P(^PSB(53.79,Y,0),U,9)="G"&('$$GET^XPAR("DIV","PSB ADMIN MULTIPLE ONCALL")) D ERR(1,"On-Call already given")
"RTN","PSBML",56,0)
 .; One Time Rule
"RTN","PSBML",57,0)
 .D:PSBREC(2)="O"
"RTN","PSBML",58,0)
 ..S X=$O(^PSB(53.79,"AORD",PSBREC(0),PSBREC(1),"")) Q:X=""
"RTN","PSBML",59,0)
 ..S Y=$O(^PSB(53.79,"AORD",PSBREC(0),PSBREC(1),X,0))
"RTN","PSBML",60,0)
 ..I $P(^PSB(53.79,Y,0),U,9)="G" D ERR(1,"One Time already Given")
"RTN","PSBML",61,0)
 .; PRN Schedule Rules
"RTN","PSBML",62,0)
 .I PSBREC(2)="P",PSBREC(3)'="M",$P(PSBREC(9),U,1)'="IVTAB" D
"RTN","PSBML",63,0)
 ..I PSBREC(6)="" D ERR(1,"PRN Medications MUST Have a PRN Reason")
"RTN","PSBML",64,0)
 ..I PSBREC(5)]"" D ERR(1,"PRN Orders don't have scheduled times")
"RTN","PSBML",65,0)
 ..I PSBREC(3)'="G" D ERR(1,"PRN Orders cannot be marked NOT Given")
"RTN","PSBML",66,0)
 .; Continuous Schedule Rules
"RTN","PSBML",67,0)
 .I PSBREC(2)="C",PSBTAB'="IVTAB" D
"RTN","PSBML",68,0)
 ..D:PSBREC(5)="" ERR(1,"Continuous Order MUST have admin time")
"RTN","PSBML",69,0)
 ..D:PSBREC(6)]"" ERR(1,"No PRN Reason allowed on Continuous Orders")
"RTN","PSBML",70,0)
 .I PSBREC(2)="C",$D(^PSB(53.79,"AORD",PSBREC(0),PSBREC(1),+PSBREC(5))),PSBIEN="+1" D  K PSBADMBY,PSBADMAT Q:$P(^PSB(53.79,PSBSIEN,0),U,9)'="N"
"RTN","PSBML",71,0)
 ..N PSBDTX S PSBDTX=$O(^PSB(53.79,"AORDX",PSBREC(0),PSBREC(1),""),-1)   ; Get Latest Action/Order Date
"RTN","PSBML",72,0)
 ..S PSBSIEN=$O(^PSB(53.79,"AORDX",PSBREC(0),PSBREC(1),PSBDTX,""),-1)    ; Get Last Action/Order
"RTN","PSBML",73,0)
 ..D:$P(^PSB(53.79,PSBSIEN,0),U,9)'="N"
"RTN","PSBML",74,0)
 ...S Y=$P(^PSB(53.79,PSBSIEN,0),U,6) D DD^%DT S PSBADMAT=Y
"RTN","PSBML",75,0)
 ...S PSBADMBY=$$GET1^DIQ(200,$P(^PSB(53.79,PSBSIEN,0),U,7),.01,)
"RTN","PSBML",76,0)
 ...S RESULTS(0)="-2^Error Filing Transaction MEDPASS"
"RTN","PSBML",77,0)
 ...S RESULTS(1)="Continuous Administration Date/Time already on file."
"RTN","PSBML",78,0)
 ...S RESULTS(2)="Administered by "_PSBADMBY_" at "_PSBADMAT_"."
"RTN","PSBML",79,0)
 ...I $D(XWB) S RESULTS(3)="                                         ",RESULTS(4)="            VDL will now be updated."
"RTN","PSBML",80,0)
 .; Non-Given Status Rules
"RTN","PSBML",81,0)
 .I PSBREC(3)'="G",PSBREC(3)'="M",PSBUID'["V",PSBUID'["W" D
"RTN","PSBML",82,0)
 ..I PSBREC(7)="",PSBTAB'="IVTAB" D ERR(1,"Comments Required if Not Marked Given")
"RTN","PSBML",83,0)
 ..I PSBREC(7)="",PSBTAB="IVTAB" D ERR(1,"Comments Required if Not Marked Completed")
"RTN","PSBML",84,0)
 .S:PSBREC(3)="H" PSBREC(7)="Held: "_PSBREC(7) ; Update Comment
"RTN","PSBML",85,0)
 .S:PSBREC(3)="R" PSBREC(7)="Refused: "_PSBREC(7) ; Update Comment
"RTN","PSBML",86,0)
 .S:PSBREC(3)="S" PSBREC(7)="Stopped: "_PSBREC(7) ; Update Comment
"RTN","PSBML",87,0)
 .; Check data for validity
"RTN","PSBML",88,0)
 .I $G(PSBSIEN)'="" I $D(^PSB(53.79,PSBSIEN,0)) I $P(^PSB(53.79,PSBSIEN,0),U,9)="N" S PSBIEN=+PSBSIEN_",",$P(PSBHDR,U)=PSBIEN,PSBTRAN="UPDATE STATUS",PSBAUDIT=1   ; Last act "not given" - UPDATE not CREATE
"RTN","PSBML",89,0)
 .D:PSBIEN="+1"  ; Items applied only if new entry
"RTN","PSBML",90,0)
 ..D VAL(53.79,PSBIEN,.01,"`"_PSBREC(0)) ;  Pt IEN
"RTN","PSBML",91,0)
 ..S X=$G(^DPT(PSBREC(0),.1))_" "_$G(^(.101)) ; Build Ward/Room Bed
"RTN","PSBML",92,0)
 ..D VAL(53.79,PSBIEN,.02,X) ;              Pt Location
"RTN","PSBML",93,0)
 ..D:$G(^DPT(PSBREC(0),.1))'=""
"RTN","PSBML",94,0)
 ...S Y=$O(^DIC(42,"B",$G(^DPT(PSBREC(0),.1)),"")),Y=$$GET1^DIQ(42,Y,.015,"I"),PSBDIV=$$SITE^VASITE(DT,Y)
"RTN","PSBML",95,0)
 ...D VAL(53.79,PSBIEN,.03,"`"_$P(PSBDIV,U,1)) ;     Division
"RTN","PSBML",96,0)
 ..D VAL(53.79,PSBIEN,.04,PSBNOW) ;         Entered DT
"RTN","PSBML",97,0)
 ..D VAL(53.79,PSBIEN,.05,"`"_DUZ) ;        Entered By
"RTN","PSBML",98,0)
 ..D VAL(53.79,PSBIEN,.06,PSBNOW) ;         Administered D/T
"RTN","PSBML",99,0)
 ..D VAL(53.79,PSBIEN,.07,"`"_DUZ) ;        Administered By
"RTN","PSBML",100,0)
 ..D VAL(53.79,PSBIEN,.08,"`"_PSBREC(4)) ;  Orderable Item
"RTN","PSBML",101,0)
 ..D VAL(53.79,PSBIEN,.11,PSBREC(1)) ;      Order Type;IEN
"RTN","PSBML",102,0)
 ..D VAL(53.79,PSBIEN,.12,PSBREC(2)) ;      Order Schedule Type (ie PRN)
"RTN","PSBML",103,0)
 ..D VAL(53.79,PSBIEN,.13,PSBREC(5)) ;      Scheduled Admin D/T
"RTN","PSBML",104,0)
 ..D:PSBTAB'="UDTAB" VAL(53.79,PSBIEN,.26,PSBUID) ;  Unique ID number
"RTN","PSBML",105,0)
 ..D:PSBTAB="IVTAB" VAL(53.79,PSBIEN,.13,"")  ;no Scheduled Admin D/T for continuous, non-PiggyBack IV
"RTN","PSBML",106,0)
 ..D:PSBREC(1)?.N1"U" VAL(53.79,PSBIEN,.15,PSBDOSE) ; Unit Dose Dosage
"RTN","PSBML",107,0)
 ..D:PSBREC(1)?.N1"V" VAL(53.79,PSBIEN,.35,PSBIFR) ; IV Infusion Rate
"RTN","PSBML",108,0)
 .; These Items are overwritten if order exists
"RTN","PSBML",109,0)
 .I PSBREC(3)="G"!(PSBREC(3))="C" D  ;                       Only if being sent as Given or Completed
"RTN","PSBML",110,0)
 ..D VAL(53.79,PSBIEN,.06,PSBNOW) ;         Administered D/T
"RTN","PSBML",111,0)
 ..D VAL(53.79,PSBIEN,.07,"`"_DUZ) ;        Administered By
"RTN","PSBML",112,0)
 .D:PSBREC(8)]"" VAL(53.79,PSBIEN,.16,PSBREC(8)) ;    Injection Site Sent Back
"RTN","PSBML",113,0)
 .D VAL(53.79,PSBIEN,.09,PSBREC(3)) ;      Status of Admin
"RTN","PSBML",114,0)
 .D:PSBREC(6)]"" VAL(53.79,PSBIEN,.21,$P(PSBREC(6),U)),VAL(53.79,PSBIEN,.27,$P(PSBREC(6),U,2)) ;     PRN Reason
"RTN","PSBML",115,0)
 .; Comment?
"RTN","PSBML",116,0)
 .D:PSBREC(7)]""
"RTN","PSBML",117,0)
 ..D VAL(53.793,"+2,"_PSBIEN,.01,PSBREC(7)) ; Comment
"RTN","PSBML",118,0)
 ..D VAL(53.793,"+2,"_PSBIEN,.02,"`"_DUZ) ;   Who Entered
"RTN","PSBML",119,0)
 ..D VAL(53.793,"+2,"_PSBIEN,.03,PSBNOW) ;    When Entered
"RTN","PSBML",120,0)
 .; DD/SOL/ADD
"RTN","PSBML",121,0)
 .I PSBREC(3)="G"!(PSBREC(3)="I")!(PSBREC(3)="H")!(PSBREC(3)="R")!(PSBREC(3)="M") D  ; Only apply if given or infusing
"RTN","PSBML",122,0)
 ..I PSBTRAN="UPDATE STATUS" K ^PSB(53.79,+PSBIEN,.5),^PSB(53.79,+PSBIEN,.6),^PSB(53.79,+PSBIEN,.7)
"RTN","PSBML",123,0)
 ..F PSBCNT=10:1 Q:'$D(PSBREC(PSBCNT))  D
"RTN","PSBML",124,0)
 ...S Y=$P(PSBREC(PSBCNT),U)
"RTN","PSBML",125,0)
 ...S PSBDD=$S(Y="DD":53.795,Y="ADD":53.796,Y="SOL":53.797,1:0)
"RTN","PSBML",126,0)
 ...Q:'PSBDD
"RTN","PSBML",127,0)
 ...S PSBIENS="+"_PSBCNT_","_PSBIEN
"RTN","PSBML",128,0)
 ...D VAL(PSBDD,PSBIENS,.01,"`"_$P(PSBREC(PSBCNT),U,2))
"RTN","PSBML",129,0)
 ...D VAL(PSBDD,PSBIENS,.02,$P(PSBREC(PSBCNT),U,3))
"RTN","PSBML",130,0)
 ...D VAL(PSBDD,PSBIENS,.03,$P(PSBREC(PSBCNT),U,4))
"RTN","PSBML",131,0)
 ...D:(PSBTAB="UDTAB")!(PSBTAB="PBTAB") VAL(PSBDD,PSBIENS,.04,$P(PSBREC(PSBCNT),U,5))
"RTN","PSBML",132,0)
 .I $O(RESULTS("")) S RESULTS(0)="-1^Error(s) Filing Transaction MEDPASS"  Q
"RTN","PSBML",133,0)
 .D FILEIT
"RTN","PSBML",134,0)
 .D:(PSBREC(2)="O")&(PSBREC(3)="G") EXPIRE^PSBML1  ;One time order expired if given
"RTN","PSBML",135,0)
 .I $P(RESULTS(0),U,1)=1,PSBTAB'="UDTAB",PSBUID]"",PSBUID'["WS" S PSBON=+PSBREC(1) D EN^PSJBCMA3(PSBREC(0),PSBON,PSBUID,PSBREC(3),PSBNOW)
"RTN","PSBML",136,0)
 Q
"RTN","PSBML",137,0)
BCBU ;Check and send to Backup Contingency
"RTN","PSBML",138,0)
 Q:+$G(RESULTS(0))'>0
"RTN","PSBML",139,0)
 ; Set PSBIEN1 for National Contingency and backup
"RTN","PSBML",140,0)
 N PSBIEN1 S PSBIEN1=$S($P(PSBIEN,",",2)'="":+$P(PSBIEN,",",2),$G(PSBIEN)="+1":PSBIEN(1),1:+$G(PSBIEN))
"RTN","PSBML",141,0)
 I $G(PSBIEN1)="" S RESULTS(0)="-1^Data contingency not processed" Q
"RTN","PSBML",142,0)
 I $G(PSBIEN)="+1" S PSBHL7="MEDPASS"
"RTN","PSBML",143,0)
 E  S:$G(PSBHL7)="" PSBHL7="UPDATE STATUS"
"RTN","PSBML",144,0)
 D:('$D(Y(0))!($G(Y(0))="SAVE")!($G(Y(0))="YES")) EN^PSBSVHL7(+PSBIEN1,PSBHL7),MEDL^ALPBCBU(+PSBIEN1) K PSBHL7,PSBIEN1 ; Broadcast HL7 , Send to BCMA Contingency
"RTN","PSBML",145,0)
 Q
"RTN","PSBML",146,0)
 ;
"RTN","PSBML",147,0)
VAL(PSBDD,PSBIEN,PSBFLD,PSBVAL) ;
"RTN","PSBML",148,0)
 K ^TMP("DIERR",$J),PSBRET
"RTN","PSBML",149,0)
 D VAL^DIE(PSBDD,PSBIEN,PSBFLD,"F",PSBVAL,.PSBRET,"PSBFDA")
"RTN","PSBML",150,0)
 I PSBRET="^" F X=0:0 S X=$O(^TMP("DIERR",$J,X)) Q:'X  D ERR(2,^TMP("DIERR",$J,X)_": "_$G(^(X,"TEXT",1),"**"))
"RTN","PSBML",151,0)
 K ^TMP("DIERR",$J),PSBRET
"RTN","PSBML",152,0)
 Q
"RTN","PSBML",153,0)
 ;
"RTN","PSBML",154,0)
FILEIT ; Call UPDATE^DIE and set Results(0)
"RTN","PSBML",155,0)
 N PSBMSG,PSBAUD
"RTN","PSBML",156,0)
 I $D(PSBTRAN),PSBTRAN["UPDATE",$D(^PSB(53.79,+PSBIEN,.5,1,0)) D
"RTN","PSBML",157,0)
 .I $P(^PSB(53.79,+PSBIEN,.5,1,0),U,4)="PATCH",PSBOLSTS="G",PSBREC(0)="N" K ^PSB(53.79,"APATCH",$P(^PSB(53.79,+PSBIEN,0),U),$P(^PSB(53.79,+PSBIEN,0),U,6),+PSBIEN)
"RTN","PSBML",158,0)
 ;
"RTN","PSBML",159,0)
 D CLEAN^DILF
"RTN","PSBML",160,0)
 D UPDATE^DIE("","PSBFDA","PSBIEN","PSBMSG")
"RTN","PSBML",161,0)
 I $D(PSBHDR) D:"NHRM"[$P(^PSB(53.79,$S($P(PSBHDR,"^",1)="+1":PSBIEN(1),1:+PSBIEN),0),U,9)
"RTN","PSBML",162,0)
 .N PSBINDX S PSBINDX=$S($P(PSBHDR,"^",1)="+1":PSBIEN(1),1:+PSBIEN)
"RTN","PSBML",163,0)
 .K ^PSB(53.79,"APATCH",$P(^PSB(53.79,PSBINDX,0),U),$P(^PSB(53.79,PSBINDX,0),U,6),PSBINDX)
"RTN","PSBML",164,0)
 I $D(PSBMSG("DIERR")) S RESULTS(0)="-1^"_PSBMSG("DIERR",1)_": "_PSBMSG("DIERR",1,"TEXT",1)  Q
"RTN","PSBML",165,0)
 ; Data went through, is there an instructor???
"RTN","PSBML",166,0)
 S RESULTS(0)="1^Data Successfully Filed^"_$S($G(PSBIEN(1))'="":$G(PSBIEN(1)),1:+$G(PSBIEN))
"RTN","PSBML",167,0)
 D BCBU     ; Process contingency and backup
"RTN","PSBML",168,0)
 I $G(PSBINST,0) S PSBAUD=$S($P(PSBHDR,"^",1)="+1":PSBIEN(1),1:$P(PSBHDR,"^",1)) D AUDIT^PSBMLU(PSBAUD,"Instructor "_PSBINST(0)_" present.")
"RTN","PSBML",169,0)
 Q
"RTN","PSBML",170,0)
 ;
"RTN","PSBML",171,0)
ERR(X,Y) ;
"RTN","PSBML",172,0)
 S X=$P("Business Logic Error^Data Validation Error",U,X)
"RTN","PSBML",173,0)
 S RESULTS($O(RESULTS(""),-1)+1)=X_": "_Y
"RTN","PSBML",174,0)
 Q
"RTN","PSBML",175,0)
 ;
"RTN","PSBML",176,0)
COMMENT(DA,PSBCMT) ; Blind Comment Add from DDS
"RTN","PSBML",177,0)
 N PSBFDA,PSBIEN,PSBNOW
"RTN","PSBML",178,0)
 S PSBIEN="+1,"_DA_","
"RTN","PSBML",179,0)
 D NOW^%DTC S PSBNOW=%
"RTN","PSBML",180,0)
 D VAL(53.793,PSBIEN,.01,PSBCMT)
"RTN","PSBML",181,0)
 S PSBFDA(53.793,PSBIEN,.02)=DUZ
"RTN","PSBML",182,0)
 S PSBFDA(53.793,PSBIEN,.03)=PSBNOW
"RTN","PSBML",183,0)
 D FILEIT
"RTN","PSBML",184,0)
 Q
"RTN","PSBML",185,0)
 ;
"RTN","PSBML1")
0^7^B16504539
"RTN","PSBML1",1,0)
PSBML1 ;BIRMINGHAM/VRN-BCMA API TO IPM FOR EXPIRING ONE-TIME ORDERS ;Mar 2004
"RTN","PSBML1",2,0)
 ;;3.0;BAR CODE MED ADMIN;;Mar 2004
"RTN","PSBML1",3,0)
 ;
"RTN","PSBML1",4,0)
 ; Reference/IA
"RTN","PSBML1",5,0)
 ; EN^PSJBCMA3/3320
"RTN","PSBML1",6,0)
 ; ENE^PSJBCMA4/3416
"RTN","PSBML1",7,0)
 ; ENR^PSJBCMA4/3416
"RTN","PSBML1",8,0)
 ;
"RTN","PSBML1",9,0)
EXPIRE ;
"RTN","PSBML1",10,0)
 S PSBFLAG=0,(X,Y)=""
"RTN","PSBML1",11,0)
 F  S X=$O(^PSB(53.79,"AOIP",PSBREC(0),PSBREC(4),X),-1) Q:X=""  D
"RTN","PSBML1",12,0)
 .F  S Y=$O(^PSB(53.79,"AOIP",PSBREC(0),PSBREC(4),X,Y),-1) Q:'Y  D
"RTN","PSBML1",13,0)
 ..I $D(^PSB(53.79,Y,.3)),$G(^PSB(53.79,Y,.3,1,0))["Manual" S PSBFLAG=1
"RTN","PSBML1",14,0)
 ..D:('PSBFLAG)&($P(^PSB(53.79,Y,0),U,9)="G") ENE^PSJBCMA4(PSBREC(0),PSBREC(1)) S (X,Y)=0
"RTN","PSBML1",15,0)
 Q
"RTN","PSBML1",16,0)
 ;
"RTN","PSBML1",17,0)
COMMENT ;
"RTN","PSBML1",18,0)
 S PSBIEN="+1,"_PSBIEN_","
"RTN","PSBML1",19,0)
 D VAL^PSBML(53.793,PSBIEN,.01,PSBREC(0))
"RTN","PSBML1",20,0)
 S PSBFDA(53.793,PSBIEN,.02)=DUZ
"RTN","PSBML1",21,0)
 S PSBFDA(53.793,PSBIEN,.03)=PSBNOW
"RTN","PSBML1",22,0)
 D FILEIT^PSBML
"RTN","PSBML1",23,0)
 Q
"RTN","PSBML1",24,0)
 ;
"RTN","PSBML1",25,0)
PRN ;
"RTN","PSBML1",26,0)
 S PSBIEN=PSBIEN_","
"RTN","PSBML1",27,0)
 D VAL^PSBML(53.79,PSBIEN,.22,PSBREC(0))
"RTN","PSBML1",28,0)
 D FILEIT^PSBML
"RTN","PSBML1",29,0)
 Q
"RTN","PSBML1",30,0)
UPDATE ;
"RTN","PSBML1",31,0)
 S PSBIEN=PSBIEN_","
"RTN","PSBML1",32,0)
 I "^G^N^H^R^RM^S^C^I^"[U_PSBREC(0)_U D
"RTN","PSBML1",33,0)
 .D VAL^PSBML(53.79,PSBIEN,.06,PSBNOW)
"RTN","PSBML1",34,0)
 .D VAL^PSBML(53.79,PSBIEN,.07,"`"_DUZ)
"RTN","PSBML1",35,0)
 .D VAL^PSBML(53.79,PSBIEN,.09,PSBREC(0))
"RTN","PSBML1",36,0)
 .I $D(PSBREC(3)),PSBREC(3)]"" D VAL^PSBML(53.79,PSBIEN,.26,PSBREC(3))
"RTN","PSBML1",37,0)
 D:PSBREC(1)]""
"RTN","PSBML1",38,0)
 .S:PSBREC(0)="N" PSBREC(1)="Not Given: "_PSBREC(1)
"RTN","PSBML1",39,0)
 .S:PSBREC(0)="H" PSBREC(1)="Held: "_PSBREC(1)
"RTN","PSBML1",40,0)
 .S:PSBREC(0)="R" PSBREC(1)="Refused: "_PSBREC(1)
"RTN","PSBML1",41,0)
 .S:PSBREC(0)="RM" PSBREC(1)="Removed: "_PSBREC(1)
"RTN","PSBML1",42,0)
 .D VAL^PSBML(53.793,"+2,"_PSBIEN,.01,PSBREC(1))
"RTN","PSBML1",43,0)
 .D VAL^PSBML(53.793,"+2,"_PSBIEN,.02,"`"_DUZ)
"RTN","PSBML1",44,0)
 .D VAL^PSBML(53.793,"+2,"_PSBIEN,.03,PSBNOW)
"RTN","PSBML1",45,0)
 ;If set to not given then set dose given to 0
"RTN","PSBML1",46,0)
 I PSBREC(0)="N" S $P(^PSB(53.79,$P(PSBIEN,","),.5,1,0),"^",3)="0"
"RTN","PSBML1",47,0)
 I $G(PSBREC(2))]"" D VAL^PSBML(53.79,PSBIEN,.16,PSBREC(2))
"RTN","PSBML1",48,0)
 S PSBOLDUZ=$P(^PSB(53.79,+PSBIEN,0),U,7),PSBOLSTS=$P(^PSB(53.79,+PSBIEN,0),U,9)
"RTN","PSBML1",49,0)
 I $G(PSBREC(4))]"" D  ; DD/SOL/ADD
"RTN","PSBML1",50,0)
 .I PSBREC(0)="G"!(PSBREC(0)="I")!(PSBREC(0)="H")!(PSBREC(0)="R")!(PSBREC(0)="M") D  ; Only apply if given or infusing
"RTN","PSBML1",51,0)
 ..K ^PSB(53.79,+PSBIEN,.5),^PSB(53.79,+PSBIEN,.6),^PSB(53.79,+PSBIEN,.7)
"RTN","PSBML1",52,0)
 ..F PSBCNT=4:1 Q:'$D(PSBREC(PSBCNT))  D
"RTN","PSBML1",53,0)
 ...S Y=$P(PSBREC(PSBCNT),U)
"RTN","PSBML1",54,0)
 ...S PSBDD=$S(Y="DD":53.795,Y="ADD":53.796,Y="SOL":53.797,1:0)
"RTN","PSBML1",55,0)
 ...Q:'PSBDD
"RTN","PSBML1",56,0)
 ...S PSBIENS="+"_PSBCNT_","_PSBIEN
"RTN","PSBML1",57,0)
 ...D VAL^PSBML(PSBDD,PSBIENS,.01,"`"_$P(PSBREC(PSBCNT),U,2))
"RTN","PSBML1",58,0)
 ...D VAL^PSBML(PSBDD,PSBIENS,.02,$P(PSBREC(PSBCNT),U,3))
"RTN","PSBML1",59,0)
 ...D VAL^PSBML(PSBDD,PSBIENS,.03,$P(PSBREC(PSBCNT),U,4))
"RTN","PSBML1",60,0)
 ...D:Y="DD" VAL^PSBML(PSBDD,PSBIENS,.04,$P(PSBREC(PSBCNT),U,5))
"RTN","PSBML1",61,0)
 D FILEIT^PSBML
"RTN","PSBML1",62,0)
 ; add audit for change of status
"RTN","PSBML1",63,0)
 ; tell pharmacy if change of status on pharmacy generated UID
"RTN","PSBML1",64,0)
 I $P(RESULTS(0),U,1)=1 D
"RTN","PSBML1",65,0)
 .S PSBUID=$P(^PSB(53.79,+PSBIEN,0),U,10) I PSBUID]"",PSBUID'["WS" D
"RTN","PSBML1",66,0)
 ..S PSBON=$P(^PSB(53.79,+PSBIEN,.1),U,1)
"RTN","PSBML1",67,0)
 ..S PSBDFN=$P(^PSB(53.79,+PSBIEN,0),U,1)
"RTN","PSBML1",68,0)
 ..I PSBREC(0)="N" S PSBREC(0)="" D
"RTN","PSBML1",69,0)
 ...M PSBAR=^PSB(53.79,+PSBIEN,.9)
"RTN","PSBML1",70,0)
 ...S (PSBDN,X)="" F  S X=$O(PSBAR(X),-1) Q:X=0!(PSBDN=1)  D
"RTN","PSBML1",71,0)
 ....I PSBAR(X,0)["ACTION STATUS",PSBAR(X,0)["deleted",PSBAR(X,0)'["GIVEN" D
"RTN","PSBML1",72,0)
 .....S PSBTS=$P($P(PSBAR(X,0),"'",2),"'",1)
"RTN","PSBML1",73,0)
 .....S PSBREC(0)=$S(PSBTS="HELD":"H",PSBTS="REFUSED":"R",PSBTS="REMOVED":"RM",PSBTS="MISSING":"M",1:""),PSBDN=1
"RTN","PSBML1",74,0)
 ..I PSBREC(0)="" D VAL^PSBML(53.79,PSBIEN,.26,"") D CLEAN^DILF,UPDATE^DIE("","PSBFDA","PSBIEN","PSBMSG")
"RTN","PSBML1",75,0)
 ..D EN^PSJBCMA3(PSBDFN,+PSBON,PSBUID,PSBREC(0),PSBNOW)
"RTN","PSBML1",76,0)
 I ($$GET1^DIQ(53.79,+PSBIEN,.12,"I")="O")&($$GET1^DIQ(53.79,+PSBIEN,.09,"I")="N") S PSBDFN=$$GET1^DIQ(53.79,+PSBIEN,.01,"I") D ENR^PSJBCMA4(PSBDFN,$$GET1^DIQ(53.79,+PSBIEN,.11))
"RTN","PSBML1",77,0)
 I ($$GET1^DIQ(53.79,+PSBIEN,.12,"I")="O")&($$GET1^DIQ(53.79,+PSBIEN,.09,"I")="G") S PSBDFN=$$GET1^DIQ(53.79,+PSBIEN,.01,"I") D ENE^PSJBCMA4(PSBDFN,$$GET1^DIQ(53.79,+PSBIEN,.11))
"RTN","PSBML1",78,0)
 Q
"RTN","PSBMLEN")
0^8^B68152938
"RTN","PSBMLEN",1,0)
PSBMLEN ;BIRMINGHAM/EFC-BCMA MEDICATION LOG FUNCTIONS ;Mar 2004
"RTN","PSBMLEN",2,0)
 ;;3.0;BAR CODE MED ADMIN;;Mar 2004
"RTN","PSBMLEN",3,0)
 ;
"RTN","PSBMLEN",4,0)
 ; Reference/IA
"RTN","PSBMLEN",5,0)
 ; EN^PSJBCMA/2828
"RTN","PSBMLEN",6,0)
 ; ENE^PSJBCMA4/3416
"RTN","PSBMLEN",7,0)
 ; ENR^PSJBCMA4/3416
"RTN","PSBMLEN",8,0)
 ; ^XUSEC/10076
"RTN","PSBMLEN",9,0)
 ;
"RTN","PSBMLEN",10,0)
EN ;
"RTN","PSBMLEN",11,0)
 N PSBCNT,PSBDT,PSBERR,PSBFORM,PSBMED,PSBNOW,PSBSCHT,PSBVARD,PSBX,PSBFREQ,PSBFLAG
"RTN","PSBMLEN",12,0)
 K ^TMP("PSB",$J),^TMP("PSJ",$J),PSBREC
"RTN","PSBMLEN",13,0)
 W @IOF,!,"Manual Medication Entry",!
"RTN","PSBMLEN",14,0)
 W !,"Notice: No validation of medications is done with this option."
"RTN","PSBMLEN",15,0)
 W !,"Entries in the Med Log created with this option will reflect this"
"RTN","PSBMLEN",16,0)
 W !,"in the comments.",!!
"RTN","PSBMLEN",17,0)
 S DIC="^DPT(",DIC(0)="AEQM",DIC("A")="Select PATIENT: "
"RTN","PSBMLEN",18,0)
 D ^DIC K DIC Q:+Y<1
"RTN","PSBMLEN",19,0)
 S DFN=+Y
"RTN","PSBMLEN",20,0)
 D EN1
"RTN","PSBMLEN",21,0)
 K ^TMP("PSBO",$J)
"RTN","PSBMLEN",22,0)
 Q
"RTN","PSBMLEN",23,0)
 ;
"RTN","PSBMLEN",24,0)
EN1 ;
"RTN","PSBMLEN",25,0)
 S %DT="AEQ",%DT("B")="Today",%DT("A")="Select Orders From Date: "
"RTN","PSBMLEN",26,0)
 D ^%DT Q:+Y<1  S PSBDT=+Y
"RTN","PSBMLEN",27,0)
 W !,"Searching for Orders..."
"RTN","PSBMLEN",28,0)
 K ^TMP("PSJ",$J)
"RTN","PSBMLEN",29,0)
 D EN^PSJBCMA(DFN,PSBDT,"")
"RTN","PSBMLEN",30,0)
 Q:$G(^TMP("PSJ",$J,1,0))=-1
"RTN","PSBMLEN",31,0)
 S PSBERR=0
"RTN","PSBMLEN",32,0)
 D NOW^%DTC S PSBNOW=%
"RTN","PSBMLEN",33,0)
 F PSBX=0:0 S PSBX=$O(^TMP("PSJ",$J,PSBX)) Q:'PSBX  D
"RTN","PSBMLEN",34,0)
 .D CLEAN^PSBVT
"RTN","PSBMLEN",35,0)
 .D PSJ^PSBVT(PSBX)
"RTN","PSBMLEN",36,0)
 .Q:PSBONX?.N1"P"  ; No Pending Yet
"RTN","PSBMLEN",37,0)
 .I "PCS"'[PSBIVT,PSBONX'["U" Q
"RTN","PSBMLEN",38,0)
 .I PSBIVT["S",PSBISYR'=1 Q  ;    allow intermittent syringe only
"RTN","PSBMLEN",39,0)
 .I PSBIVT["C",PSBCHEMT'="P",PSBISYR'=1 Q
"RTN","PSBMLEN",40,0)
 .I PSBIVT["C",PSBCHEMT="A" Q  ;     allow Chemo with intermittent syringe or Piggyback type only
"RTN","PSBMLEN",41,0)
 .K ^TMP("PSBO",$J)
"RTN","PSBMLEN",42,0)
 .S PSBOUT=0
"RTN","PSBMLEN",43,0)
 .D:PSBSCHT="C"
"RTN","PSBMLEN",44,0)
 ..;Calculate admin times based on Frequency from IPM **PSB*2.0*6**
"RTN","PSBMLEN",45,0)
 ..S (PSBYES,PSBODD)=0
"RTN","PSBMLEN",46,0)
 ..S:$$PSBDCHK1^PSBVT1(PSBSCH) PSBYES=1
"RTN","PSBMLEN",47,0)
 ..I PSBYES,PSBADST="" S PSBOUT=1 Q
"RTN","PSBMLEN",48,0)
 ..I PSBSCH?2.4N.E S PSBYES=1
"RTN","PSBMLEN",49,0)
 ..S PSBFREQ=$$GETFREQ^PSBVDLU1(DFN,PSBONX)
"RTN","PSBMLEN",50,0)
 ..I PSBFREQ="O" S PSBYES=1
"RTN","PSBMLEN",51,0)
 ..I 'PSBYES,PSBADST="",PSBFREQ<1 S PSBOUT=1 Q
"RTN","PSBMLEN",52,0)
 ..I (PSBFREQ#1440'=0),(1440#PSBFREQ'=0) S PSBODD=1
"RTN","PSBMLEN",53,0)
 ..I PSBODD,PSBADST'="" S PSBOUT=1 Q
"RTN","PSBMLEN",54,0)
 ..I PSBADST="" S PSBADST=$$GETADMIN^PSBVDLU1(DFN,PSBONX,PSBOST,PSBFREQ,PSBDT)
"RTN","PSBMLEN",55,0)
 ..E  K ^TMP("PSB",$J,"GETADMIN") S ^TMP("PSB",$J,"GETADMIN",0)=PSBADST
"RTN","PSBMLEN",56,0)
 ..;For invalid admin times
"RTN","PSBMLEN",57,0)
 ..F PSBY=1:1 Q:$P(PSBADST,"-",PSBY)=""  D
"RTN","PSBMLEN",58,0)
 ...Q:($P(PSBADST,"-",PSBY)'?2N)&($P(PSBADST,"-",PSBY)'?4N)
"RTN","PSBMLEN",59,0)
 .Q:PSBOUT
"RTN","PSBMLEN",60,0)
 .Q:PSBOST>PSBNOW  ; Future Start Date
"RTN","PSBMLEN",61,0)
 .I PSBSCHT="O" S (PSBGVN,X,Y)="" D  I (PSBGVN)!(PSBNGF) K PSBGVN,X,Y Q
"RTN","PSBMLEN",62,0)
 ..F  S X=$O(^PSB(53.79,"AOIP",DFN,PSBOIT,X),-1) Q:'X  D
"RTN","PSBMLEN",63,0)
 ...F  S Y=$O(^PSB(53.79,"AOIP",DFN,PSBOIT,X,Y),-1) Q:'Y  S:($P(^PSB(53.79,Y,.1),U)=PSBONX)&($P(^PSB(53.79,Y,0),U,9)'="N") PSBGVN=1,(X,Y)=0
"RTN","PSBMLEN",64,0)
 .I PSBSCHT="OC" S (PSBGVN,X,Y)="" D  I PSBGVN K PSBGVN,X,Y Q
"RTN","PSBMLEN",65,0)
 ..F  S X=$O(^PSB(53.79,"AOIP",DFN,PSBOIT,X),-1) Q:'X  D
"RTN","PSBMLEN",66,0)
 ...F  S Y=$O(^PSB(53.79,"AOIP",DFN,PSBOIT,X,Y),-1) Q:'Y  S:($P(^PSB(53.79,Y,.1),U)=PSBONX)&($P(^PSB(53.79,Y,0),U,9)'="N") PSBGVN=1,(X,Y)=0
"RTN","PSBMLEN",67,0)
 ..S PSBGVN=PSBGVN&('$$GET^XPAR("DIV","PSB ADMIN MULTIPLE ONCALL")) Q:PSBGVN
"RTN","PSBMLEN",68,0)
 ..I PSBOSTS'="A"&(PSBOSTS'="R") S PSBGVN=1 Q
"RTN","PSBMLEN",69,0)
 ..I PSBNGF S PSBGVN=1 Q
"RTN","PSBMLEN",70,0)
 .S ^TMP("PSB",$J,PSBSCHT,PSBOITX,PSBX)=PSBONX_U_PSBADST_U_PSBOST_U_PSBOSP_U_PSBOSTS
"RTN","PSBMLEN",71,0)
 I PSBERR W ! K DIR S DIR(0)="E" D ^DIR Q:Y="^"
"RTN","PSBMLEN",72,0)
 ;
"RTN","PSBMLEN",73,0)
EN2 ;
"RTN","PSBMLEN",74,0)
 W $$HDR() I '$D(^TMP("PSB",$J)) W !!?5,"No Med Orders Found!",!  Q
"RTN","PSBMLEN",75,0)
 S PSBSCHT="",PSBCNT=0
"RTN","PSBMLEN",76,0)
 F  S PSBSCHT=$O(^TMP("PSB",$J,PSBSCHT)) Q:PSBSCHT=""  D
"RTN","PSBMLEN",77,0)
 .W !  ; Line between order types
"RTN","PSBMLEN",78,0)
 .S PSBMED=""
"RTN","PSBMLEN",79,0)
 .F  S PSBMED=$O(^TMP("PSB",$J,PSBSCHT,PSBMED)) Q:PSBMED=""  D
"RTN","PSBMLEN",80,0)
 ..F PSBX=0:0 S PSBX=$O(^TMP("PSB",$J,PSBSCHT,PSBMED,PSBX)) Q:'PSBX  D
"RTN","PSBMLEN",81,0)
 ...I $Y>(IOSL-6) W ! K DIR S DIR(0)="E" D ^DIR W:Y $$HDR() I 'Y S PSBSCHT="Z" Q
"RTN","PSBMLEN",82,0)
 ...S PSBCNT=PSBCNT+1
"RTN","PSBMLEN",83,0)
 ...W !,$J(PSBCNT,2),". ",PSBSCHT,?7,PSBMED
"RTN","PSBMLEN",84,0)
 ...W ?40," (",$P(^TMP("PSB",$J,PSBSCHT,PSBMED,PSBX),U,5),")"
"RTN","PSBMLEN",85,0)
 ...S Y=$P(^TMP("PSB",$J,PSBSCHT,PSBMED,PSBX),U,3)
"RTN","PSBMLEN",86,0)
 ...W:$X>44 !
"RTN","PSBMLEN",87,0)
 ...W ?45,"Start: ",$E(Y,4,5)_"/"_$E(Y,6,7)_"/"_(1700+$E(Y,1,3))_" "
"RTN","PSBMLEN",88,0)
 ...W $E($P(Y,".",2)_"0000",1,4)
"RTN","PSBMLEN",89,0)
 ...S Y=$P(^TMP("PSB",$J,PSBSCHT,PSBMED,PSBX),U,4)
"RTN","PSBMLEN",90,0)
 ...W !?45," Stop: ",$E(Y,4,5)_"/"_$E(Y,6,7)_"/"_(1700+$E(Y,1,3))_" "
"RTN","PSBMLEN",91,0)
 ...W $E($P(Y,".",2)_"0000",1,4)
"RTN","PSBMLEN",92,0)
 ...I $P(^TMP("PSB",$J,PSBSCHT,PSBMED,PSBX),U,2)]"" W !?7,"Admin Times: ",$P(^TMP("PSB",$J,PSBSCHT,PSBMED,PSBX),U,2)
"RTN","PSBMLEN",93,0)
 ...W !
"RTN","PSBMLEN",94,0)
 ...S ^TMP("PSBO",$J,PSBCNT)=$P(^TMP("PSB",$J,PSBSCHT,PSBMED,PSBX),U,1)
"RTN","PSBMLEN",95,0)
 F  Q:$Y>(IOSL-5)  W !
"RTN","PSBMLEN",96,0)
 K DIR S DIR(0)="NO^1:"_PSBCNT_":0" D ^DIR
"RTN","PSBMLEN",97,0)
 I Y S Y=^TMP("PSBO",$J,Y) D NEW^PSBMLEN1(Y) G EN2
"RTN","PSBMLEN",98,0)
 Q
"RTN","PSBMLEN",99,0)
 ;
"RTN","PSBMLEN",100,0)
 ;
"RTN","PSBMLEN",101,0)
HDR() ;
"RTN","PSBMLEN",102,0)
 W @IOF,"Manual Medication Entry",!," #",?4,"Sc",?7,"Medication",?41,"St"
"RTN","PSBMLEN",103,0)
 W !,$TR($J("",IOM)," ","-")
"RTN","PSBMLEN",104,0)
 Q ""
"RTN","PSBMLEN",105,0)
 ;
"RTN","PSBMLEN",106,0)
EDIT    ; Edit Medication Log
"RTN","PSBMLEN",107,0)
 N PSBAUDIT
"RTN","PSBMLEN",108,0)
 S PSBAUDIT=1
"RTN","PSBMLEN",109,0)
 W:'$D(^XUSEC("PSB MANAGER",DUZ)) !!?5,"Notice: You are restricted from editing any entries other than",!,"        those that you have created.",!
"RTN","PSBMLEN",110,0)
 S DA=""
"RTN","PSBMLEN",111,0)
 S DIC="^DPT(",DIC(0)="AEQM",DIC("A")="Select Patient Name: "
"RTN","PSBMLEN",112,0)
 D ^DIC K DIC Q:+Y<1
"RTN","PSBMLEN",113,0)
 S DFN=+Y
"RTN","PSBMLEN",114,0)
 D EDIT1
"RTN","PSBMLEN",115,0)
 K PSBCNT,PSBDT,PSBIEN,PSBSRCH,PSBTMP,DA,DFN,DR,DDSFILE
"RTN","PSBMLEN",116,0)
 G EDIT
"RTN","PSBMLEN",117,0)
 ;
"RTN","PSBMLEN",118,0)
EDIT1   ; 
"RTN","PSBMLEN",119,0)
 S %DT="AEQ",%DT("A")="Select Date to Begin Searching Back From: "
"RTN","PSBMLEN",120,0)
 W !! S %DT("B")="TODAY" D ^%DT Q:+Y<1  S PSBDT=Y
"RTN","PSBMLEN",121,0)
 F  D  Q:'PSBDT
"RTN","PSBMLEN",122,0)
 .W @IOF,!,"Searching Date " S Y=PSBDT D D^DIQ W Y
"RTN","PSBMLEN",123,0)
 .W !," #  Medication",?45,"St",?50,"D/T Given",?75,"Int"
"RTN","PSBMLEN",124,0)
 .W !,$TR($J("",IOM)," ","-")
"RTN","PSBMLEN",125,0)
 .S PSBSRCH=PSBDT+.9,PSBCNT=0
"RTN","PSBMLEN",126,0)
 .K PSBTMP
"RTN","PSBMLEN",127,0)
 .F  S PSBSRCH=$O(^PSB(53.79,"AEDT",DFN,PSBSRCH),-1) Q:'PSBSRCH!(PSBSRCH<PSBDT)  D
"RTN","PSBMLEN",128,0)
 ..S PSBIEN=""
"RTN","PSBMLEN",129,0)
 ..F  S PSBIEN=$O(^PSB(53.79,"AEDT",DFN,PSBSRCH,PSBIEN),-1) Q:'PSBIEN  D:$P(^PSB(53.79,PSBIEN,0),U,7)=DUZ!($D(^XUSEC("PSB MANAGER",DUZ)))
"RTN","PSBMLEN",130,0)
 ...Q:$P(^PSB(53.79,PSBIEN,0),U,9)="N"
"RTN","PSBMLEN",131,0)
 ...S PSBCNT=PSBCNT+1,PSBTMP(PSBCNT)=PSBIEN
"RTN","PSBMLEN",132,0)
 ...D:$Y>19
"RTN","PSBMLEN",133,0)
 ....W ! S DIR(0)="E" D ^DIR
"RTN","PSBMLEN",134,0)
 ....W @IOF,!,"Searching Date " S Y=PSBDT D D^DIQ W Y
"RTN","PSBMLEN",135,0)
 ....W !," #  Medication",?45,"St",?50,"D/T Given",?75,"Int"
"RTN","PSBMLEN",136,0)
 ....W !,$TR($J("",IOM)," ","-")
"RTN","PSBMLEN",137,0)
 ...W !,$J(PSBCNT,2),". "
"RTN","PSBMLEN",138,0)
 ...W ?5,$$GET1^DIQ(53.79,PSBIEN_",",.08)
"RTN","PSBMLEN",139,0)
 ...I $$GET1^DIQ(53.79,PSBIEN_",",.26) W ?5," ("_$$GET1^DIQ(53.79,PSBIEN_",",.26)_")"
"RTN","PSBMLEN",140,0)
 ...W ?45,$P(^PSB(53.79,PSBIEN,0),U,9)
"RTN","PSBMLEN",141,0)
 ...W ?50,$$GET1^DIQ(53.79,PSBIEN_",",.06)
"RTN","PSBMLEN",142,0)
 ...W ?75,$$GET1^DIQ(53.79,PSBIEN_",","ACTION BY:INITIAL")
"RTN","PSBMLEN",143,0)
 .I PSBCNT D  Q:Y
"RTN","PSBMLEN",144,0)
 ..W ! S DIR(0)="NO^1:"_PSBCNT_":0" D ^DIR
"RTN","PSBMLEN",145,0)
 ..I Y S DA=PSBTMP(Y),PSBDT=""
"RTN","PSBMLEN",146,0)
 .I 'PSBCNT W !!?5,"No Meds Found!"
"RTN","PSBMLEN",147,0)
 .S X1=PSBDT,X2=-1 D C^%DTC S (PSBDT,Y)=X D D^DIQ
"RTN","PSBMLEN",148,0)
 .W !!,"Continue With ",Y
"RTN","PSBMLEN",149,0)
 .S %=1 D YN^DICN I %'=1 S PSBDT=0
"RTN","PSBMLEN",150,0)
 I DA D
"RTN","PSBMLEN",151,0)
 .S PSBCOMP="",PSBDFN=$$GET1^DIQ(53.79,DA_",",.01,"I"),PSBONX=$$GET1^DIQ(53.79,DA_",",.11),PSBSTUS=$$GET1^DIQ(53.79,DA_",",.09,"I")
"RTN","PSBMLEN",152,0)
 .I PSBONX["V",PSBSTUS'="G" D  Q:PSBCOMP=1
"RTN","PSBMLEN",153,0)
 ..S PSBBAGN=$$GET1^DIQ(53.79,DA_",",.26) D INFUSING^PSBVDLU2 Q:PSBCOMP=0
"RTN","PSBMLEN",154,0)
 ..I $D(PSBPORA(PSBONX)) S X="" F  S X=$O(PSBPORA(PSBONX,X)),PSBBAG2=$P(PSBPORA(PSBONX,X),U,1),PSBBAGST=$P(PSBPORA(PSBONX,X),U,2) Q:PSBBAG2]""
"RTN","PSBMLEN",155,0)
 ..I PSBBAGN=PSBBAG2 S PSBCOMP=0 Q
"RTN","PSBMLEN",156,0)
 ..I (PSBBAGN'=PSBBAG2),PSBBAGST'="C" D 
"RTN","PSBMLEN",157,0)
 ...W !!,"Bag "_PSBBAG2_" is marked as ",$S(PSBBAGST="I":"Infusing",PSBBAGST="S":"Stopped",1:"unk")
"RTN","PSBMLEN",158,0)
 ...W !,"This bag must be completed before bag "_PSBBAGN_" can be edited.",!!
"RTN","PSBMLEN",159,0)
 ...K PSBORA,PSBBAGN,PSBBAG2,PSBBAGST
"RTN","PSBMLEN",160,0)
 .I PSBONX["V" D PSJ1^PSBVT(PSBDFN,PSBONX)
"RTN","PSBMLEN",161,0)
 .S DDSFILE=53.79 D
"RTN","PSBMLEN",162,0)
 ..I PSBONX["U" S DR="[PSB MED LOG EDIT]" Q
"RTN","PSBMLEN",163,0)
 ..I PSBIVT["P" S DR="[PSB MED LOG EDIT]" Q
"RTN","PSBMLEN",164,0)
 ..I PSBIVT["S",PSBISYR=1  S DR="[PSB MED LOG EDIT]" Q
"RTN","PSBMLEN",165,0)
 ..I PSBIVT["C",PSBISYR=1  S DR="[PSB MED LOG EDIT]" Q
"RTN","PSBMLEN",166,0)
 ..I PSBIVT["C",PSBCHEMT="P"  S DR="[PSB MED LOG EDIT]" Q
"RTN","PSBMLEN",167,0)
 ..S DR="[PSB MED LOG EDIT IV]" Q
"RTN","PSBMLEN",168,0)
 .D ^DDS
"RTN","PSBMLEN",169,0)
 .;One time order reinstated if not given
"RTN","PSBMLEN",170,0)
 .D:($P(^PSB(53.79,DA,.1),U,2)="O")&($P(^PSB(53.79,DA,0),U,9)="N") ENR^PSJBCMA4(DFN,$P(^PSB(53.79,DA,.1),U,1))
"RTN","PSBMLEN",171,0)
 .D:($P(^PSB(53.79,DA,.1),U,2)="O")&($P(^PSB(53.79,DA,0),U,9)="G") ENE^PSJBCMA4(DFN,$P(^PSB(53.79,DA,.1),U,1))
"RTN","PSBMLEN",172,0)
 Q
"RTN","PSBMLEN",173,0)
 ;
"RTN","PSBMLEN",174,0)
VALID ;
"RTN","PSBMLEN",175,0)
 I $G(PSBSTUS)="RM","^RM^"'[("^"_X_"^") W $C(7) S DDSERROR=1 D HLP^DDSUTL("Status of Removed cannot be changed.") Q
"RTN","PSBMLEN",176,0)
 I $G(PSBREC(7))'="Entry created with 'Manual Medication Entry' option." D  Q
"RTN","PSBMLEN",177,0)
 .I ($D(^PSB(53.79,DA,.5,1,0))),($P($G(^PSB(53.79,DA,.5,1,0)),U,4)="PATCH") D  Q
"RTN","PSBMLEN",178,0)
 ..I "^G^N^H^R^RM^"'[("^"_X_"^") W $C(7) S DDSERROR=1 D HLP^DDSUTL("Allowed status codes are Given, Not Given, Held, Refused and Removed.")
"RTN","PSBMLEN",179,0)
 .I "^G^N^H^R^"'[("^"_X_"^") W $C(7) S DDSERROR=1 D HLP^DDSUTL("Allowed status codes are Given, Not Given, Held, and Refused.")
"RTN","PSBMLEN",180,0)
 I "^G^H^R^"'[("^"_X_"^") W $C(7) S DDSERROR=1 D HLP^DDSUTL("Allowed status codes are Given, Held, and Refused.") Q
"RTN","PSBMLEN",181,0)
 ;
"RTN","PSBMLEN",182,0)
 ;
"RTN","PSBMLEN1")
0^9^B25227355
"RTN","PSBMLEN1",1,0)
PSBMLEN1 ;BIRMINGHAM/EFC-BCMA MEDICATION LOG FUNCTIONS ;Mar 2004
"RTN","PSBMLEN1",2,0)
 ;;3.0;BAR CODE MED ADMIN;;Mar 2004
"RTN","PSBMLEN1",3,0)
 ;
"RTN","PSBMLEN1",4,0)
 ; Reference/IA
"RTN","PSBMLEN1",5,0)
 ; ENE^PSJBCMA4/3416
"RTN","PSBMLEN1",6,0)
 ;
"RTN","PSBMLEN1",7,0)
NEW(Y) ; Create the new entry
"RTN","PSBMLEN1",8,0)
 N PSBREC,PSB,PSBADST,PSBFREQ
"RTN","PSBMLEN1",9,0)
 W @IOF D CLEAN^PSBVT,PSJ1^PSBVT(DFN,Y)
"RTN","PSBMLEN1",10,0)
 D NOW^%DTC
"RTN","PSBMLEN1",11,0)
 I PSBOSP<% D  Q:%'=1
"RTN","PSBMLEN1",12,0)
 .W @IOF,$C(7)
"RTN","PSBMLEN1",13,0)
 .W !,"NOTICE: This order is NOT currently active."
"RTN","PSBMLEN1",14,0)
 .W !,"        Are You Sure You Want To Continue"
"RTN","PSBMLEN1",15,0)
 .S %=2 D YN^DICN
"RTN","PSBMLEN1",16,0)
 I PSBADST="" S PSBFREQ=$$GETFREQ^PSBVDLU1(DFN,PSBONX),PSBADST=$$GETADMIN^PSBVDLU1(DFN,PSBONX,PSBOST,PSBFREQ,PSBDT)
"RTN","PSBMLEN1",17,0)
 E  K ^TMP("PSB",$J,"GETADMIN") S ^TMP("PSB",$J,"GETADMIN",0)=PSBADST
"RTN","PSBMLEN1",18,0)
 W !,"Order:       ",PSBONX
"RTN","PSBMLEN1",19,0)
 W !,"Medication:  ",PSBOITX
"RTN","PSBMLEN1",20,0)
 W !,"Dosage:      ",PSBDOSE
"RTN","PSBMLEN1",21,0)
 W !,"Schedule:    ",PSBSCH
"RTN","PSBMLEN1",22,0)
 W !,"Admin Times: ",PSBADST
"RTN","PSBMLEN1",23,0)
 W !!,"Is this the correct Order" S %=1 D YN^DICN Q:%'=1
"RTN","PSBMLEN1",24,0)
 ;
"RTN","PSBMLEN1",25,0)
 ; PRN, One-Time, On Call orders
"RTN","PSBMLEN1",26,0)
 ;
"RTN","PSBMLEN1",27,0)
 I PSBSCHT'="C" D
"RTN","PSBMLEN1",28,0)
 .D VAL^PSBMLVAL(.PSB,DFN,+PSBONX,$E(PSBONX,$L(PSBONX)))
"RTN","PSBMLEN1",29,0)
 .I PSBSCHT="P",($D(PSB(1))) W !!,"Brief Administration History:  ",! S X=$O(PSB(" "),-1),X=$S(X>4:4,1:X) F I=1:1:X W !,?5,PSB(I)
"RTN","PSBMLEN1",30,0)
 .W !!,"Create an administration for this order" S %=1 D YN^DICN Q:%'=1
"RTN","PSBMLEN1",31,0)
 .I PSBSCHT="P" D  Q:Y=""!(Y["^")
"RTN","PSBMLEN1",32,0)
 ..K DIR S DIR(0)="FB^1:30",DIR("A")="PRN Reason (1-30 characters)"
"RTN","PSBMLEN1",33,0)
 ..W !!,"NOTICE: PRN Reason is Required for ALL PRN Entries",!
"RTN","PSBMLEN1",34,0)
 ..D ^DIR
"RTN","PSBMLEN1",35,0)
 ..I Y=""!(Y["^") W !!,"Sorry, Reason is required, No Entry Made!" Q
"RTN","PSBMLEN1",36,0)
 ..S PSBREC(6)=$P(Y,"|")
"RTN","PSBMLEN1",37,0)
 .; Build the form of dosage to CAP or TAB or null
"RTN","PSBMLEN1",38,0)
 .S:(PSBDOSEF'?1"CAP".E)&(PSBDOSEF'?1"TAB".E)&(PSBDOSEF'?1"PATCH".E) PSBDOSEF=""
"RTN","PSBMLEN1",39,0)
 .; Build the variable dose check #####-#####MG
"RTN","PSBMLEN1",40,0)
 .S PSBVARD=$S(PSBDOSE?1.5N1"-"1.5N.E:1,1:0)
"RTN","PSBMLEN1",41,0)
 .S PSBREC(0)=DFN
"RTN","PSBMLEN1",42,0)
 .S PSBREC(1)=PSBONX
"RTN","PSBMLEN1",43,0)
 .S PSBREC(2)=PSBSCHT
"RTN","PSBMLEN1",44,0)
 .S PSBREC(3)="G"
"RTN","PSBMLEN1",45,0)
 .S PSBREC(4)=PSBOIT
"RTN","PSBMLEN1",46,0)
 .S PSBREC(5)=""
"RTN","PSBMLEN1",47,0)
 .S PSBREC(7)="Entry created with 'Manual Medication Entry' option."
"RTN","PSBMLEN1",48,0)
 .S PSBREC(8)=""
"RTN","PSBMLEN1",49,0)
 .S PSBREC(9)=$S(PSBONX["U":"UDTAB",1:"PBTAB")
"RTN","PSBMLEN1",50,0)
 .S PSBINDX=10
"RTN","PSBMLEN1",51,0)
 .S X="" F  S X=$O(PSBDDA(X)) Q:X=""  S PSBREC(PSBINDX)=$P(PSBDDA(X),U,1,2)_U_$P(PSBDDA(X),U,4)_U_$P(PSBDDA(X),U,4)_U_PSBDOSEF,PSBINDX=PSBINDX+1
"RTN","PSBMLEN1",52,0)
 .S X="" F  S X=$O(PSBADA(X)) Q:X=""  S PSBREC(PSBINDX)=PSBADA(X),PSBINDX=PSBINDX+1
"RTN","PSBMLEN1",53,0)
 .S X="" F  S X=$O(PSBSOLA(X)) Q:X=""  S PSBREC(PSBINDX)=PSBSOLA(X),PSBINDX=PSBINDX+1
"RTN","PSBMLEN1",54,0)
 .D FILE
"RTN","PSBMLEN1",55,0)
 .I $G(DA),PSBREC(2)="O",$D(^PSB(53.79,DA)) I $P(^PSB(53.79,DA,0),U,9)="G" D ENE^PSJBCMA4(PSBREC(0),PSBREC(1))
"RTN","PSBMLEN1",56,0)
 ;
"RTN","PSBMLEN1",57,0)
 ; Continuous Meds
"RTN","PSBMLEN1",58,0)
 ;
"RTN","PSBMLEN1",59,0)
 I PSBSCHT="C" D
"RTN","PSBMLEN1",60,0)
 .W ! S %DT="AEQ",%DT("A")="Enter the DATE of Administration: "
"RTN","PSBMLEN1",61,0)
 .S %DT("B")="Today" D ^%DT Q:Y<1  S PSBDT=Y D D^DIQ
"RTN","PSBMLEN1",62,0)
 .F PSBXX=0:1 Q:$G(^TMP("PSB",$J,"GETADMIN",PSBXX))=""  D
"RTN","PSBMLEN1",63,0)
 ..S X="",Y=$G(^TMP("PSB",$J,"GETADMIN",PSBXX))
"RTN","PSBMLEN1",64,0)
 ..F Z=1:1:$L(Y,"-") S X=X_$S(X]"":";",1:"")_Z_":"_$P(Y,"-",Z)
"RTN","PSBMLEN1",65,0)
 .K DIR S DIR(0)="S^"_X,DIR("A")="Select Administration Time"
"RTN","PSBMLEN1",66,0)
 .D ^DIR Q:Y<1
"RTN","PSBMLEN1",67,0)
 .S PSBDT=+(PSBDT_"."_Y(0))
"RTN","PSBMLEN1",68,0)
 .S Y=PSBDT D D^DIQ
"RTN","PSBMLEN1",69,0)
 .W !!,"Create an administration for ",Y S %=1 D YN^DICN  Q:%'=1
"RTN","PSBMLEN1",70,0)
FORUM .; Build the form of dosage to CAP or TAB or null
"RTN","PSBMLEN1",71,0)
 .S PSBDOSEF=PSBDOSEF
"RTN","PSBMLEN1",72,0)
 .S:(PSBDOSEF'?1"CAP".E)&(PSBDOSEF'?1"TAB".E)&(PSBDOSEF'?1"PATCH".E) PSBDOSEF=""
"RTN","PSBMLEN1",73,0)
 .; Build the variable dose check #####-#####MG
"RTN","PSBMLEN1",74,0)
 .S PSBVARD=$S(PSBDOSE?1.5N1"-"1.5N.E:1,1:0)
"RTN","PSBMLEN1",75,0)
 .S PSBREC(0)=DFN
"RTN","PSBMLEN1",76,0)
 .S PSBREC(1)=PSBONX
"RTN","PSBMLEN1",77,0)
 .S PSBREC(2)=PSBSCHT
"RTN","PSBMLEN1",78,0)
 .S PSBREC(3)="G"
"RTN","PSBMLEN1",79,0)
 .S PSBREC(4)=PSBOIT
"RTN","PSBMLEN1",80,0)
 .S PSBREC(5)=PSBDT
"RTN","PSBMLEN1",81,0)
 .S PSBREC(6)=""
"RTN","PSBMLEN1",82,0)
 .S PSBREC(7)="Entry created with 'Manual Medication Entry' option."
"RTN","PSBMLEN1",83,0)
 .S PSBREC(8)=""
"RTN","PSBMLEN1",84,0)
 .S PSBREC(9)=$S(PSBONX["U":"UDTAB",1:"PBTAB")
"RTN","PSBMLEN1",85,0)
 .S PSBINDX=10
"RTN","PSBMLEN1",86,0)
 .S X="" F  S X=$O(PSBDDA(X)) Q:X=""  S PSBREC(PSBINDX)=$P(PSBDDA(X),U,1,2)_U_$P(PSBDDA(X),U,4)_U_$P(PSBDDA(X),U,4)_U_PSBDOSEF,PSBINDX=PSBINDX+1
"RTN","PSBMLEN1",87,0)
 .S X="" F  S X=$O(PSBADA(X)) Q:X=""  S PSBREC(PSBINDX)=PSBADA(X),PSBINDX=PSBINDX+1
"RTN","PSBMLEN1",88,0)
 .S X="" F  S X=$O(PSBSOLA(X)) Q:X=""  S PSBREC(PSBINDX)=PSBSOLA(X),PSBINDX=PSBINDX+1
"RTN","PSBMLEN1",89,0)
 .D FILE
"RTN","PSBMLEN1",90,0)
 Q
"RTN","PSBMLEN1",91,0)
 ;
"RTN","PSBMLEN1",92,0)
FILE ; Call the med log RPC to file it and DDS to edit it
"RTN","PSBMLEN1",93,0)
 N PSB,PSBSAVE,PSBAUDIT
"RTN","PSBMLEN1",94,0)
 D RPC^PSBML(.PSB,"+1^MEDPASS",.PSBREC)
"RTN","PSBMLEN1",95,0)
 I +PSB(0)<1 D  Q
"RTN","PSBMLEN1",96,0)
 .W @IOF,!,"Error(s) Creating Med Log Entry",!
"RTN","PSBMLEN1",97,0)
 .S X=0 F  S X=$O(PSB(X)) Q:X=""  W !,$J(X,2),". ",PSB(X)
"RTN","PSBMLEN1",98,0)
 .W !!,"No Med Log Entry Created.",!!
"RTN","PSBMLEN1",99,0)
 .K DIR S DIR(0)="E" D ^DIR
"RTN","PSBMLEN1",100,0)
 S PSBSAVE=0,PSBAUDIT=1
"RTN","PSBMLEN1",101,0)
 S DA=$P(PSB(0),U,3),DDSFILE=53.79
"RTN","PSBMLEN1",102,0)
 I $P(^PSB(53.79,DA,.1),U,1)?.N1"U" S DR="[PSB NEW UD ENTRY]"
"RTN","PSBMLEN1",103,0)
 I $P(^PSB(53.79,DA,.1),U,1)?.N1"V" S DR="[PSB NEW IV ENTRY]"
"RTN","PSBMLEN1",104,0)
 D ^DDS
"RTN","PSBMLEN1",105,0)
 I PSBSAVE'=1 D
"RTN","PSBMLEN1",106,0)
 .W !,"Incomplete Med Log Entry, Deleting...#",DA S A=^PSB(53.79,DA,0),DFN=$P(A,U,1),AADT=$P(A,U,6)
"RTN","PSBMLEN1",107,0)
 .K ^PSB(53.79,"AADT",DFN,AADT,DA) S DIK="^PSB(53.79," D ^DIK
"RTN","PSBMLEN1",108,0)
 Q
"RTN","PSBMLEN1",109,0)
 ;
"RTN","PSBMLEN1",110,0)
FDATE ;Check Admin Time for future date/time.
"RTN","PSBMLEN1",111,0)
 N PSBTIMX
"RTN","PSBMLEN1",112,0)
 S PSBTIMX=X D NOW^%DTC
"RTN","PSBMLEN1",113,0)
 I PSBTIMX>% W $C(7) S (DDSERROR,DDSBR)=1 D HLP^DDSUTL("Future date/time is not allowed")
"RTN","PSBMLEN1",114,0)
 Q
"RTN","PSBMLEN1",115,0)
 ;
"RTN","PSBMLHS")
0^10^B5390112
"RTN","PSBMLHS",1,0)
PSBMLHS ;BIRMINGHAM/EFC-BCMA OIT HISTORY ;Mar 2004
"RTN","PSBMLHS",2,0)
 ;;3.0;BAR CODE MED ADMIN;;Mar 2004
"RTN","PSBMLHS",3,0)
 ;
"RTN","PSBMLHS",4,0)
 ; Reference/IA
"RTN","PSBMLHS",5,0)
 ; ^DPT/10035
"RTN","PSBMLHS",6,0)
 ; File 50.7/2880
"RTN","PSBMLHS",7,0)
 ;
"RTN","PSBMLHS",8,0)
 ;
"RTN","PSBMLHS",9,0)
HISTORY(RESULTS,DFN,PSBOI) ; Returns Orderable Item History
"RTN","PSBMLHS",10,0)
 ;
"RTN","PSBMLHS",11,0)
 ; RPC: PSB MEDICATION HISTORY
"RTN","PSBMLHS",12,0)
 ;
"RTN","PSBMLHS",13,0)
 N PSBDT,PSBIEN,PSBIENS,PSBNODE,PSBSPC,PSBY
"RTN","PSBMLHS",14,0)
 I '$G(DFN) D ADD("Error: No Patient IEN") Q
"RTN","PSBMLHS",15,0)
 I '$G(PSBOI) D ADD("Error: No Orderable Item") Q
"RTN","PSBMLHS",16,0)
 K ^TMP("PSB",$J)
"RTN","PSBMLHS",17,0)
 D ADD("Medication Administration History")
"RTN","PSBMLHS",18,0)
 D ADD("")
"RTN","PSBMLHS",19,0)
 D ADD("PATIENT:    "_$$GET1^DIQ(2,DFN_",",.01))
"RTN","PSBMLHS",20,0)
 D ADD("MEDICATION: "_$$GET1^DIQ(50.7,PSBOI_",",.01))
"RTN","PSBMLHS",21,0)
 D ADD("")
"RTN","PSBMLHS",22,0)
 D ADD("Location            St Sch Administration Date        Admin By  Injection Site")
"RTN","PSBMLHS",23,0)
 D ADD($J("",60)_"Medication & Dosage")
"RTN","PSBMLHS",24,0)
 D ADD($TR($J("",110)," ","-"))
"RTN","PSBMLHS",25,0)
 S PSBDT="",PSBSPC=$J("",80)
"RTN","PSBMLHS",26,0)
 F  S PSBDT=$O(^PSB(53.79,"AOIP",DFN,PSBOI,PSBDT),-1) Q:'PSBDT  D
"RTN","PSBMLHS",27,0)
 .S PSBIEN=""
"RTN","PSBMLHS",28,0)
 .F  S PSBIEN=$O(^PSB(53.79,"AOIP",DFN,PSBOI,PSBDT,PSBIEN)) Q:'PSBIEN  D
"RTN","PSBMLHS",29,0)
 ..Q:$P(^PSB(53.79,PSBIEN,0),U,9)="N"
"RTN","PSBMLHS",30,0)
 ..S PSBIENS=PSBIEN_","
"RTN","PSBMLHS",31,0)
 ..S Y=$E($$GET1^DIQ(53.79,PSBIENS,.02)_PSBSPC,1,20)
"RTN","PSBMLHS",32,0)
 ..S Y=Y_$P(^PSB(53.79,PSBIEN,0),U,9)_"  "
"RTN","PSBMLHS",33,0)
 ..S Y=Y_$E($P($G(^PSB(53.79,PSBIEN,.1)),U,2)_PSBSPC,1,2)_"  "
"RTN","PSBMLHS",34,0)
 ..S Y=Y_$E($$GET1^DIQ(53.79,PSBIENS,.06)_PSBSPC,1,25)_"  "
"RTN","PSBMLHS",35,0)
 ..S Y=Y_$E($$GET1^DIQ(53.79,PSBIENS,"ACTION BY:INITIAL")_PSBSPC,1,10)_"  "
"RTN","PSBMLHS",36,0)
 ..S Y=Y_$$GET1^DIQ(53.79,PSBIENS,.16)
"RTN","PSBMLHS",37,0)
 ..D ADD(Y)
"RTN","PSBMLHS",38,0)
 ..F PSBNODE=.5,.6,.7 D
"RTN","PSBMLHS",39,0)
 ...S PSBDD=$S(PSBNODE=.5:53.795,PSBNODE=.6:53.796,1:53.797)
"RTN","PSBMLHS",40,0)
 ...F PSBY=0:0 S PSBY=$O(^PSB(53.79,PSBIEN,PSBNODE,PSBY)) Q:'PSBY  D
"RTN","PSBMLHS",41,0)
 ....S Y=$$GET1^DIQ(PSBDD,PSBY_","_PSBIENS,.01)_"  "
"RTN","PSBMLHS",42,0)
 ....S Y=Y_$$GET1^DIQ(PSBDD,PSBY_","_PSBIENS,.03)_"  "
"RTN","PSBMLHS",43,0)
 ....S Y=Y_$$GET1^DIQ(PSBDD,PSBY_","_PSBIENS,.04)_"  "
"RTN","PSBMLHS",44,0)
 ....D ADD($J("",60)_Y)
"RTN","PSBMLHS",45,0)
 ..D ADD("")
"RTN","PSBMLHS",46,0)
 .S ^TMP("PSB",$J,0)=""
"RTN","PSBMLHS",47,0)
 S RESULTS=$NAME(^TMP("PSB",$J))
"RTN","PSBMLHS",48,0)
 Q
"RTN","PSBMLHS",49,0)
 ;
"RTN","PSBMLHS",50,0)
ADD(X) ;
"RTN","PSBMLHS",51,0)
 S ^TMP("PSB",$J,$O(^TMP("PSB",$J,""),-1)+1)=X
"RTN","PSBMLHS",52,0)
 Q
"RTN","PSBMLHS",53,0)
 ;
"RTN","PSBMLTS")
0^11^B28541304
"RTN","PSBMLTS",1,0)
PSBMLTS ;BIRMINGHAM/EFC-BCMA MEDICATION LOG FUNCTIONS ;Mar 2004
"RTN","PSBMLTS",2,0)
 ;;3.0;BAR CODE MED ADMIN;;Mar 2004
"RTN","PSBMLTS",3,0)
 ;
"RTN","PSBMLTS",4,0)
 ; Reference/IA
"RTN","PSBMLTS",5,0)
 ; EN^PSJBCMA/2828
"RTN","PSBMLTS",6,0)
 ; EN^PSJBCMA1/2829
"RTN","PSBMLTS",7,0)
 ; File 50/221
"RTN","PSBMLTS",8,0)
 ;
"RTN","PSBMLTS",9,0)
EN ;
"RTN","PSBMLTS",10,0)
 N DFN,PSBCNT,PSBDT,PSBERR,PSBMED,PSBNOW,PSBSCHD,PSBVDT
"RTN","PSBMLTS",11,0)
 K ^TMP("PSB",$J),^TMP("PSJ",$J),PSBORD,PSBREC
"RTN","PSBMLTS",12,0)
 W @IOF,!,"Manual Medication Log Trouble Shooter",!!
"RTN","PSBMLTS",13,0)
 S DIC="^DPT(",DIC(0)="AEQM",DIC("A")="Select PATIENT: "
"RTN","PSBMLTS",14,0)
 D ^DIC K DIC Q:+Y<1  S DFN=+Y
"RTN","PSBMLTS",15,0)
 K DIR S DIR(0)="DO^",DIR("A")="Select Date To Validate"
"RTN","PSBMLTS",16,0)
 D ^DIR Q:+Y<1
"RTN","PSBMLTS",17,0)
 S PSBVDT=+Y
"RTN","PSBMLTS",18,0)
 W !,"Searching for Orders..."
"RTN","PSBMLTS",19,0)
 K ^TMP("PSJ",$J)
"RTN","PSBMLTS",20,0)
 D EN^PSJBCMA(DFN,PSBVDT,"")
"RTN","PSBMLTS",21,0)
 Q:$G(^TMP("PSJ",$J,1,0))=-1
"RTN","PSBMLTS",22,0)
 S PSBERR=0
"RTN","PSBMLTS",23,0)
 D NOW^%DTC S PSBNOW=%
"RTN","PSBMLTS",24,0)
 F PSBX=0:0 S PSBX=$O(^TMP("PSJ",$J,PSBX)) Q:'PSBX  D
"RTN","PSBMLTS",25,0)
 .Q:$P(^TMP("PSJ",$J,PSBX,0),U,3)?.N1"P"  ; No Pending Yet
"RTN","PSBMLTS",26,0)
 .K PSBORD,^TMP("PSBTMP",$J)
"RTN","PSBMLTS",27,0)
 .M PSBORD=^TMP("PSJ",$J,PSBX)
"RTN","PSBMLTS",28,0)
 .S PSBSCHD=$P(PSBORD(1),U,2)
"RTN","PSBMLTS",29,0)
 .I PSBSCHD="" D  Q
"RTN","PSBMLTS",30,0)
 .I PSBSCHD="C"&($P(PSBORD(1),U,6)="") D  Q
"RTN","PSBMLTS",31,0)
 ..W !!,"Notice: Order #",+$P(PSBORD(0),U,3)
"RTN","PSBMLTS",32,0)
 ..W $S($P(PSBORD(0),U,3)?.N1"U":" (UNIT DOSE) ",$P(PSBORD(0),U,3)?.N1"V":" (IV) ",1:"")
"RTN","PSBMLTS",33,0)
 ..W " doesn't have administration times"
"RTN","PSBMLTS",34,0)
 .S ^TMP("PSB",$J,PSBSCHD,$P(PSBORD(3),U,2),PSBX)=$P(PSBORD(0),U,3)_U_$P(PSBORD(1),U,6)
"RTN","PSBMLTS",35,0)
 D EN1 G EN
"RTN","PSBMLTS",36,0)
 ;
"RTN","PSBMLTS",37,0)
EN1 ;
"RTN","PSBMLTS",38,0)
 W $$HDR() I '$D(^TMP("PSB",$J)) W !!?5,"No Med Orders Found!",! Q
"RTN","PSBMLTS",39,0)
 S PSBSCHD="",PSBCNT=0
"RTN","PSBMLTS",40,0)
 F  S PSBSCHD=$O(^TMP("PSB",$J,PSBSCHD)) Q:PSBSCHD=""  D
"RTN","PSBMLTS",41,0)
 .W !  ; Line between order types
"RTN","PSBMLTS",42,0)
 .S PSBMED=""
"RTN","PSBMLTS",43,0)
 .F  S PSBMED=$O(^TMP("PSB",$J,PSBSCHD,PSBMED)) Q:PSBMED=""  D
"RTN","PSBMLTS",44,0)
 ..F PSBX=0:0 S PSBX=$O(^TMP("PSB",$J,PSBSCHD,PSBMED,PSBX)) Q:'PSBX  D
"RTN","PSBMLTS",45,0)
 ...I $Y>(IOSL-6) W ! K DIR S DIR(0)="E" D ^DIR W:Y $$HDR() I 'Y S PSBSCHD="Z" Q
"RTN","PSBMLTS",46,0)
 ...S PSBCNT=PSBCNT+1
"RTN","PSBMLTS",47,0)
 ...W !,$J(PSBCNT,2),". ",PSBSCHD,?8,PSBMED
"RTN","PSBMLTS",48,0)
 ...W ?40,$P(^TMP("PSB",$J,PSBSCHD,PSBMED,PSBX),U,1),?50,$P(^(PSBX),U,2)
"RTN","PSBMLTS",49,0)
 ...S ^TMP("PSBTMP",$J,PSBCNT)=$P(^TMP("PSB",$J,PSBSCHD,PSBMED,PSBX),U,1)
"RTN","PSBMLTS",50,0)
 F  Q:$Y>(IOSL-5)  W !
"RTN","PSBMLTS",51,0)
 K DIR S DIR(0)="NO^1:"_PSBCNT_":0" D ^DIR
"RTN","PSBMLTS",52,0)
 I Y S Y=^TMP("PSBTMP",$J,Y) D NEW(Y) K ^TMP("PSBTMP",$J) G EN1
"RTN","PSBMLTS",53,0)
 Q
"RTN","PSBMLTS",54,0)
 ;
"RTN","PSBMLTS",55,0)
NEW(Y) ; Create the new entry
"RTN","PSBMLTS",56,0)
 N PSBREC
"RTN","PSBMLTS",57,0)
 K ^TMP("PSJ",$J),RESULTS
"RTN","PSBMLTS",58,0)
 W @IOF D EN^PSJBCMA1(DFN,Y)
"RTN","PSBMLTS",59,0)
 K PSBORD M PSBORD=^TMP("PSJ",$J)
"RTN","PSBMLTS",60,0)
 W !,"Order:       ",$P(PSBORD(0),U,3)
"RTN","PSBMLTS",61,0)
 W !,"Medication:  ",$P(PSBORD(2),U,2)
"RTN","PSBMLTS",62,0)
 W !,"Dosage:      ",$P(PSBORD(2),U,3)
"RTN","PSBMLTS",63,0)
 W !,"Schedule:    ",$P(PSBORD(4),U,2)
"RTN","PSBMLTS",64,0)
 W !,"Admin Times: ",$P(PSBORD(4),U,9)
"RTN","PSBMLTS",65,0)
 W !,"Start D/T:   "
"RTN","PSBMLTS",66,0)
 W !,"Stop D/T:    "
"RTN","PSBMLTS",67,0)
 W !!,"Is this the correct Order" S %=1 D YN^DICN Q:%'=1
"RTN","PSBMLTS",68,0)
 ;
"RTN","PSBMLTS",69,0)
 ; PRN, One-Time, On Call orders
"RTN","PSBMLTS",70,0)
 ;
"RTN","PSBMLTS",71,0)
 I $P(PSBORD(4),U,1)'="C" D
"RTN","PSBMLTS",72,0)
 .W ! S %DT="AEQR",%DT("A")="Enter the DATE/TIME of Administration: "
"RTN","PSBMLTS",73,0)
 .S %DT("B")="Now" D ^%DT Q:Y<1  S PSBDT=Y D D^DIQ
"RTN","PSBMLTS",74,0)
 .D FILE
"RTN","PSBMLTS",75,0)
 ;
"RTN","PSBMLTS",76,0)
 ; Continuous Meds
"RTN","PSBMLTS",77,0)
 ;
"RTN","PSBMLTS",78,0)
 I $P(PSBORD(4),U,1)="C" D
"RTN","PSBMLTS",79,0)
 .W ! S %DT="AEQ",%DT("A")="Enter the DATE of Administration: "
"RTN","PSBMLTS",80,0)
 .S %DT("B")="Today" D ^%DT Q:Y<1  S PSBDT=Y D D^DIQ
"RTN","PSBMLTS",81,0)
 .S X="",Y=$P(PSBORD(4),U,9)
"RTN","PSBMLTS",82,0)
 .F Z=1:1:$L(Y,"-") D
"RTN","PSBMLTS",83,0)
 ..S X=X_$S(X]"":";",1:"")_Z_":"_$P(Y,"-",Z)
"RTN","PSBMLTS",84,0)
 .K DIR S DIR(0)="S^"_X,DIR("A")="Select Administration Time"
"RTN","PSBMLTS",85,0)
 .D ^DIR Q:Y<1
"RTN","PSBMLTS",86,0)
 .S PSBDT=+(PSBDT_"."_Y(0))
"RTN","PSBMLTS",87,0)
 .S Y=PSBDT D D^DIQ
"RTN","PSBMLTS",88,0)
 .D FILE
"RTN","PSBMLTS",89,0)
 Q
"RTN","PSBMLTS",90,0)
 ;
"RTN","PSBMLTS",91,0)
FILE ; Call the med log RPC to validate and order
"RTN","PSBMLTS",92,0)
 I $D(^PSB(53.79,"AORD",DFN,$P(PSBORD(0),U,3),PSBDT)) W !,"-1^Medication is already logged!"
"RTN","PSBMLTS",93,0)
 E  D VAL^PSBMLVAL(.RESULTS,DFN,+$P(PSBORD(0),U,3),$E($P(PSBORD(0),U,3),$L($P(PSBORD(0),U,3))),PSBDT) S X="" F  S X=$O(RESULTS(X)) Q:X=""  W !,RESULTS(X)
"RTN","PSBMLTS",94,0)
 K DIR S DIR(0)="E" D ^DIR
"RTN","PSBMLTS",95,0)
 Q
"RTN","PSBMLTS",96,0)
 ;
"RTN","PSBMLTS",97,0)
HDR() ;
"RTN","PSBMLTS",98,0)
 W @IOF,"Medication Log Trouble Shooter",!,"  #  "
"RTN","PSBMLTS",99,0)
 W !,$TR($J("",IOM)," ","-")
"RTN","PSBMLTS",100,0)
 Q ""
"RTN","PSBMLTS",101,0)
 ;
"RTN","PSBMLTS",102,0)
SCANNER ; This checks the scanning mechanism
"RTN","PSBMLTS",103,0)
 N PSBVAL,PSBSCAN,PSBX,PSBFLD
"RTN","PSBMLTS",104,0)
 W ! K DIR
"RTN","PSBMLTS",105,0)
 S DIR(0)="FO^1:45",DIR("A")="Scan Medication" D ^DIR Q:Y["^"!(Y="")
"RTN","PSBMLTS",106,0)
 S PSBVAL=X K DIR
"RTN","PSBMLTS",107,0)
 W !!,"Performing 'Exact Matches' scan of Drug File..."
"RTN","PSBMLTS",108,0)
 K PSBSCAN D SMED(.PSBSCAN,X)
"RTN","PSBMLTS",109,0)
 W !!,"Results of Scan:"
"RTN","PSBMLTS",110,0)
 W $S(+PSBSCAN(0)>0:" Good",1:" Invalid")," scan value."
"RTN","PSBMLTS",111,0)
 S X="" F  S X=$O(PSBSCAN(X)) Q:X=""  W !!?5,PSBSCAN(X)
"RTN","PSBMLTS",112,0)
 G:+PSBSCAN(0)>0 SCANNER
"RTN","PSBMLTS",113,0)
 W !!,"Performing 'Non-Exact Match' scan on the Drug File...",!
"RTN","PSBMLTS",114,0)
 K ^TMP("DILIST",$J)
"RTN","PSBMLTS",115,0)
 ;
"RTN","PSBMLTS",116,0)
 D FIND^DIC(50,"","","AX",PSBVAL,"*","B^C")
"RTN","PSBMLTS",117,0)
 ;
"RTN","PSBMLTS",118,0)
 I +$G(^TMP("DILIST",$J,0))<1 W !!,"Nothing found in drug file matching '",PSBVAL,"'." G SCANNER
"RTN","PSBMLTS",119,0)
 W !,"There are ",+^TMP("DILIST",$J,0)," matches to '",PSBVAL,"'."
"RTN","PSBMLTS",120,0)
 F PSBX=0:0 S PSBX=$O(^TMP("DILIST",$J,2,PSBX)) Q:'PSBX  D
"RTN","PSBMLTS",121,0)
 .W !!,"MATCH #:..................",PSBX
"RTN","PSBMLTS",122,0)
 .W !,"IEN:......................",^TMP("DILIST",$J,2,PSBX)
"RTN","PSBMLTS",123,0)
 .W !,"NAME:.....................",^TMP("DILIST",$J,1,PSBX)
"RTN","PSBMLTS",124,0)
 .S PSBFLD=0
"RTN","PSBMLTS",125,0)
 .F  S PSBFLD=$O(^TMP("DILIST",$J,"ID",PSBX,PSBFLD)) Q:'PSBFLD  D
"RTN","PSBMLTS",126,0)
 ..D FIELD^DID(50,PSBFLD,"","LABEL","PSBFLD")
"RTN","PSBMLTS",127,0)
 ..W !,PSBFLD("LABEL"),":" F  Q:$X>25  W "."
"RTN","PSBMLTS",128,0)
 ..W ^TMP("DILIST",$J,"ID",PSBX,PSBFLD)
"RTN","PSBMLTS",129,0)
 K ^TMP("DILIST",$J)
"RTN","PSBMLTS",130,0)
 Q
"RTN","PSBMLTS",131,0)
 ;
"RTN","PSBMLTS",132,0)
SMED(RESULTS,PSBDATA) ; Lookup Medication
"RTN","PSBMLTS",133,0)
 I $$GET^XPAR("DIV","PSB ROBOT RX"),PSBDATA?1"3"15N!(PSBDATA?1"3"17N),123[$E(PSBDATA,12) S PSBDATA=$E(PSBDATA,2,11)
"RTN","PSBMLTS",134,0)
 S X=$$FIND1^DIC(50,"","AX",PSBDATA,"B^C")
"RTN","PSBMLTS",135,0)
 I X<1 S RESULTS(0)="-1^Invalid Medication Lookup"
"RTN","PSBMLTS",136,0)
 E  S RESULTS(0)=X_U_$$GET1^DIQ(50,X_",",.01)
"RTN","PSBMLTS",137,0)
 Q
"RTN","PSBMLU")
0^12^B2979361
"RTN","PSBMLU",1,0)
PSBMLU ;BIRMINGHAM/EFC-BCMA MEDICATION LOG FUNCTIONS ;Mar 2004
"RTN","PSBMLU",2,0)
 ;;3.0;BAR CODE MED ADMIN;;Mar 2004
"RTN","PSBMLU",3,0)
 ;;
"RTN","PSBMLU",4,0)
 ; Reference/IA
"RTN","PSBMLU",5,0)
 ; ^DPT/10035
"RTN","PSBMLU",6,0)
 ; ^XMD/10070
"RTN","PSBMLU",7,0)
EN ;
"RTN","PSBMLU",8,0)
 Q
"RTN","PSBMLU",9,0)
 ;
"RTN","PSBMLU",10,0)
AUDIT(IEN,TXT) ; Append and Audit
"RTN","PSBMLU",11,0)
 N X
"RTN","PSBMLU",12,0)
 S:'$D(^PSB(53.79,IEN,.9,0)) ^(0)="^53.799D^^"
"RTN","PSBMLU",13,0)
 S X=$O(^PSB(53.79,IEN,.9,"A"),-1)+1
"RTN","PSBMLU",14,0)
 D NOW^%DTC
"RTN","PSBMLU",15,0)
 S ^PSB(53.79,IEN,.9,X,0)=%_U_DUZ_U_TXT
"RTN","PSBMLU",16,0)
 Q
"RTN","PSBMLU",17,0)
 ;
"RTN","PSBMLU",18,0)
ERROR(PSB1,PSB2,DFN,PSB3,PSB4) ;
"RTN","PSBMLU",19,0)
 ; PSB1 = order #
"RTN","PSBMLU",20,0)
 ; PSB2 = orderable item
"RTN","PSBMLU",21,0)
 ; PSB3 = message to be sent
"RTN","PSBMLU",22,0)
 ; PSB4 = schedule
"RTN","PSBMLU",23,0)
 ; Send Error Msg about problems
"RTN","PSBMLU",24,0)
 S PSBMG=$$GET^XPAR("DIV","PSB MG DUE LIST ERROR",,"E")
"RTN","PSBMLU",25,0)
 Q:PSBMG=""
"RTN","PSBMLU",26,0)
 S PSBMSG(1)="  The following order was NOT displayed"
"RTN","PSBMLU",27,0)
 S PSBMSG(2)="  on the Virtual Due List"
"RTN","PSBMLU",28,0)
 S PSBMSG(3)=" "
"RTN","PSBMLU",29,0)
 S PSBMSG(4)="  Order Number....: "_PSB1
"RTN","PSBMLU",30,0)
 S PSBMSG(5)="  Orderable Item..: "_PSB2
"RTN","PSBMLU",31,0)
 S PSBMSG(6)="  Patient.........: "_$$GET1^DIQ(2,DFN_",",.01)_" ("_$$GET1^DIQ(2,DFN_",",.09)_")"
"RTN","PSBMLU",32,0)
 S PSBMSG(7)="  Ward/Bed........: "_$$GET1^DIQ(2,DFN_",",.1)_"/"_$$GET1^DIQ(2,DFN_",",.101)
"RTN","PSBMLU",33,0)
 S PSBMSG(8)="  Reason..........: "_PSB3
"RTN","PSBMLU",34,0)
 S PSBMSG(9)="  Schedule........: "_PSB4
"RTN","PSBMLU",35,0)
 S XMY("G."_PSBMG)="",XMTEXT="PSBMSG(",XMSUB="BCMA - Order Problem"
"RTN","PSBMLU",36,0)
 D ^XMD
"RTN","PSBMLU",37,0)
 K PSB1,PSB2,PSB3,PSB4,PSBMSG,PSBMG,XMY,XMSUB,XMTEXT
"RTN","PSBMLU",38,0)
 Q
"RTN","PSBMLU",39,0)
 ;
"RTN","PSBMLVAL")
0^13^B28829804
"RTN","PSBMLVAL",1,0)
PSBMLVAL ;BIRMINGHAM/EFC-BCMA MED LOG VALIDATION ;Mar 2004
"RTN","PSBMLVAL",2,0)
 ;;3.0;BAR CODE MED ADMIN;;Mar 2004
"RTN","PSBMLVAL",3,0)
 ;
"RTN","PSBMLVAL",4,0)
 ;
"RTN","PSBMLVAL",5,0)
 ;
"RTN","PSBMLVAL",6,0)
VAL(RESULTS,DFN,PSBIEN,PSBTYPE,PSBADMIN) ;
"RTN","PSBMLVAL",7,0)
 ;
"RTN","PSBMLVAL",8,0)
 ; RPC: PSB VALIDATE ORDER
"RTN","PSBMLVAL",9,0)
 ;
"RTN","PSBMLVAL",10,0)
 ; Description: Final check of order against an actual administration
"RTN","PSBMLVAL",11,0)
 ;              date/time used immediately after scanned med has been
"RTN","PSBMLVAL",12,0)
 ;              validated to be a good unadministered order and by the
"RTN","PSBMLVAL",13,0)
 ;              PSBODL (Due List) output.
"RTN","PSBMLVAL",14,0)
 ;
"RTN","PSBMLVAL",15,0)
 ; Variables:   DFN:      Patient IEN
"RTN","PSBMLVAL",16,0)
 ;              PSBIEN:   Order IEN
"RTN","PSBMLVAL",17,0)
 ;              PSBTYPE:  U:Unit Dose/V:IV
"RTN","PSBMLVAL",18,0)
 ;              PSBADMIN: Scheduled Administration Time
"RTN","PSBMLVAL",19,0)
 ;
"RTN","PSBMLVAL",20,0)
 N PSBOKAY,PSBORD,PSBSCHT,PSBOST,PSBOSP,PSBDT,PSBDA,PSBNOW
"RTN","PSBMLVAL",21,0)
 ;
"RTN","PSBMLVAL",22,0)
 K PSBORD
"RTN","PSBMLVAL",23,0)
 D PSJ1^PSBVT(DFN,PSBIEN_PSBTYPE)
"RTN","PSBMLVAL",24,0)
 S PSBCNT=0
"RTN","PSBMLVAL",25,0)
 S PSBOKAY="-1^***Unable to determine administration" ; Default Flag
"RTN","PSBMLVAL",26,0)
 D NOW^%DTC
"RTN","PSBMLVAL",27,0)
 ;
"RTN","PSBMLVAL",28,0)
 ;
"RTN","PSBMLVAL",29,0)
 I PSBSCHT'="O"&(%>PSBOSP) S RESULTS(0)="-1^Order Not Active",PSBCNT=2 Q
"RTN","PSBMLVAL",30,0)
 ; Validate an IV
"RTN","PSBMLVAL",31,0)
 I PSBONX?.N1"V" D  S RESULTS(0)=PSBOKAY Q
"RTN","PSBMLVAL",32,0)
 .I PSBOSTS'="A"&(PSBOSTS'="R") S PSBOKAY="-1^Order Not Active",PSBCNT=2 Q
"RTN","PSBMLVAL",33,0)
 .I PSBNGF S PSBOKAY="-1^marked DO NOT GIVE",PSBCNT=2 Q
"RTN","PSBMLVAL",34,0)
 .I PSBSCHT="O" D  Q  ; Make sure One Time is not given.
"RTN","PSBMLVAL",35,0)
 ..I $D(^PSB(53.79,"AORD",DFN,PSBONX)) S PSBOKAY="-1^Already Given",PSBCNT=2
"RTN","PSBMLVAL",36,0)
 ..E  S PSBOKAY="0^Okay to administer"
"RTN","PSBMLVAL",37,0)
 .S PSBOKAY="0^Okay to administer"
"RTN","PSBMLVAL",38,0)
 ; Validate a Continuous Order
"RTN","PSBMLVAL",39,0)
 D:PSBSCHT="C"
"RTN","PSBMLVAL",40,0)
 .S (PSBGVN,X,Y)=""
"RTN","PSBMLVAL",41,0)
 .I PSBOSTS'="A"&(PSBOSTS'="R") S PSBOKAY="-1^Order Not Active",PSBCNT=2 Q
"RTN","PSBMLVAL",42,0)
 .I PSBNGF S PSBOKAY="-1^marked DO NOT GIVE",PSBCNT=2 Q
"RTN","PSBMLVAL",43,0)
 .I $D(^PSB(53.79,"AORD",DFN,PSBIEN_PSBTYPE,PSBADMIN)) D  Q:X
"RTN","PSBMLVAL",44,0)
 ..S X=$O(^PSB(53.79,"AORD",DFN,PSBIEN_PSBTYPE,PSBADMIN,X)) Q:'X
"RTN","PSBMLVAL",45,0)
 ..S X=$S($P($G(^PSB(53.79,+X,0)),U,9)="G":1,1:0) Q:'X
"RTN","PSBMLVAL",46,0)
 ..S PSBOKAY="-1^Dose already on medication log",PSBCNT=2
"RTN","PSBMLVAL",47,0)
 .; Minutes before
"RTN","PSBMLVAL",48,0)
 .S PSBWIN1=$$GET^XPAR("DIV","PSB ADMIN BEFORE")*-1
"RTN","PSBMLVAL",49,0)
 .; Minutes After
"RTN","PSBMLVAL",50,0)
 .S PSBWIN2=$$GET^XPAR("DIV","PSB ADMIN AFTER")
"RTN","PSBMLVAL",51,0)
 .D NOW^%DTC S PSBMIN=$$DIFF^PSBUTL(PSBADMIN,%)
"RTN","PSBMLVAL",52,0)
 .; PENDING A PC SOLUTION!
"RTN","PSBMLVAL",53,0)
 .I PSBMIN<PSBWIN1 S PSBOKAY="1^Admin is "_(PSBMIN*-1)_" minutes before the scheduled administration time" Q
"RTN","PSBMLVAL",54,0)
 .I PSBMIN>PSBWIN2 S PSBOKAY="1^Admin is "_(PSBMIN)_" minutes after the scheduled administration time" Q
"RTN","PSBMLVAL",55,0)
 .S PSBOKAY="0^Okay to administer"
"RTN","PSBMLVAL",56,0)
 ; Validate a PRN Order
"RTN","PSBMLVAL",57,0)
 D:PSBSCHT="P"
"RTN","PSBMLVAL",58,0)
 .I PSBOSTS'="A"&(PSBOSTS'="R") S PSBOKAY="-1^Order Not Active",PSBCNT=2 Q
"RTN","PSBMLVAL",59,0)
 .I PSBNGF S PSBOKAY="-1^marked DO NOT GIVE",PSBCNT=2 Q
"RTN","PSBMLVAL",60,0)
 .; CHECK Q4H STUFF SEND 1^TO SOON IF TOO SOON.
"RTN","PSBMLVAL",61,0)
 .S PSBOKAY="1^Brief Administration History"
"RTN","PSBMLVAL",62,0)
 .; Get Last Four Givens
"RTN","PSBMLVAL",63,0)
 .S PSBDT=""
"RTN","PSBMLVAL",64,0)
 .F  S PSBDT=$O(^PSB(53.79,"AOIP",DFN,PSBOIT,PSBDT),-1) Q:PSBDT=""  D
"RTN","PSBMLVAL",65,0)
 ..S PSBDA=""
"RTN","PSBMLVAL",66,0)
 ..F  S PSBDA=$O(^PSB(53.79,"AOIP",DFN,PSBOIT,PSBDT,PSBDA),-1) Q:'PSBDA  D
"RTN","PSBMLVAL",67,0)
 ...Q:$P(^PSB(53.79,PSBDA,0),U,9)="N"
"RTN","PSBMLVAL",68,0)
 ...S X=$$GET1^DIQ(53.79,PSBDA_",",.06)_"  "
"RTN","PSBMLVAL",69,0)
 ...S X=X_$$GET1^DIQ(53.79,PSBDA_",",.09)_"  "
"RTN","PSBMLVAL",70,0)
 ...S X=X_$$GET1^DIQ(53.79,PSBDA_",",.12)_"  "
"RTN","PSBMLVAL",71,0)
 ...S X=X_$$GET1^DIQ(53.79,PSBDA_",",.21)_"  "
"RTN","PSBMLVAL",72,0)
 ...S X=X_$$GET1^DIQ(53.79,PSBDA_",",.16)_"  "
"RTN","PSBMLVAL",73,0)
 ...S PSBOKAY($O(PSBOKAY(""),-1)+1)=X
"RTN","PSBMLVAL",74,0)
 ...S:$D(PSBOKAY(4)) PSBDT=0
"RTN","PSBMLVAL",75,0)
 ; Validate a One-Time Order
"RTN","PSBMLVAL",76,0)
 D:PSBSCHT="O"
"RTN","PSBMLVAL",77,0)
 .S (PSBGVN,X,Y)=""
"RTN","PSBMLVAL",78,0)
 .F  S X=$O(^PSB(53.79,"AOIP",DFN,PSBOIT,X),-1)  Q:'X  D
"RTN","PSBMLVAL",79,0)
 ..F  S Y=$O(^PSB(53.79,"AOIP",DFN,PSBOIT,X,Y),-1) Q:'Y  S:($P(^PSB(53.79,Y,.1),U)=PSBONX)&($P(^PSB(53.79,Y,0),U,9)="G") PSBGVN=1,(X,Y)=0
"RTN","PSBMLVAL",80,0)
 .I PSBGVN S PSBOKAY="-1^Dose Already on medication Log",PSBCNT=2 Q
"RTN","PSBMLVAL",81,0)
 .; One Time are automatically expired so we don't check STATUS here
"RTN","PSBMLVAL",82,0)
 .I PSBNGF S PSBOKAY="-1^marked DO NOT GIVE",PSBCNT=2 Q
"RTN","PSBMLVAL",83,0)
 .S PSBOKAY="0^Okay to administer"
"RTN","PSBMLVAL",84,0)
 ; Validate an On Call Order
"RTN","PSBMLVAL",85,0)
 D:PSBSCHT="OC"
"RTN","PSBMLVAL",86,0)
 .S PSBOKAY="0^Okay to administer",(PSBGVN,X,Y)=""
"RTN","PSBMLVAL",87,0)
 .F  S X=$O(^PSB(53.79,"AOIP",DFN,PSBOIT,X),-1)  Q:'X  D
"RTN","PSBMLVAL",88,0)
 ..F  S Y=$O(^PSB(53.79,"AOIP",DFN,PSBOIT,X,Y),-1) Q:'Y  S:$P(^PSB(53.79,Y,.1),U)=PSBONX PSBGVN=1,(X,Y)=0
"RTN","PSBMLVAL",89,0)
 .I PSBGVN&('$$GET^XPAR("DIV","PSB ADMIN MULTIPLE ONCALL")) S PSBOKAY="-1^Dose Already on medication Log",PSBCNT=2 Q
"RTN","PSBMLVAL",90,0)
 .I PSBOSTS'="A"&(PSBOSTS'="R") S PSBOKAY="-1^Order Not Active",PSBCNT=2 Q
"RTN","PSBMLVAL",91,0)
 .I PSBNGF S PSBOKAY="-1^marked DO NOT GIVE",PSBCNT=2 Q
"RTN","PSBMLVAL",92,0)
 .S PSBOKAY="0^Okay to administer"
"RTN","PSBMLVAL",93,0)
 ;
"RTN","PSBMLVAL",94,0)
 D:+PSBOKAY'=-1
"RTN","PSBMLVAL",95,0)
 .N PSBDIFF,Y,X,PSBSTUS
"RTN","PSBMLVAL",96,0)
 .; Ok, now we know it is on-call or cont and not on the log.
"RTN","PSBMLVAL",97,0)
 .D:(PSBSCHT="C")!(PSBSCHT="OC"&('$G(PSBGVN)))
"RTN","PSBMLVAL",98,0)
 ..S Y=$O(^PSB(53.79,"AOIP",DFN,PSBOIT,""),-1)
"RTN","PSBMLVAL",99,0)
 ..S PSBDIFF=$$FMDIFF^XLFDT($$NOW^XLFDT(),Y,2)
"RTN","PSBMLVAL",100,0)
 ..Q:PSBDIFF>7200  ; Greater than 2 hours
"RTN","PSBMLVAL",101,0)
 ..;Check for the status of the medication and insert status in the text
"RTN","PSBMLVAL",102,0)
 ..I Y]"" S X=$O(^PSB(53.79,"AOIP",DFN,PSBOIT,Y,""),-1),PSBSTUS=$P(^PSB(53.79,X,0),U,9)
"RTN","PSBMLVAL",103,0)
 ..S PSBSTUS=$S(PSBSTUS="G":"GIVEN",PSBSTUS="H":"HELD",1:"REFUSED")
"RTN","PSBMLVAL",104,0)
 ..S Y="*** NOTICE, "_PSBOITX_" was "_PSBSTUS_" "_(PSBDIFF\60)_" minutes ago."
"RTN","PSBMLVAL",105,0)
 ..I +PSBOKAY=1 S PSBOKAY(1)=Y
"RTN","PSBMLVAL",106,0)
 ..E  S PSBOKAY="1^"_Y
"RTN","PSBMLVAL",107,0)
 ;
"RTN","PSBMLVAL",108,0)
 D NOW^%DTC
"RTN","PSBMLVAL",109,0)
 I PSBSCHT'="O"&(%<($$FMADD^XLFDT(PSBOST,"","",$$GET^XPAR("ALL","PSB ADMIN BEFORE")*-1))) S RESULTS(0)="-1^Order Not Active" I PSBCNT=0 S PSBCNT=1 Q
"RTN","PSBMLVAL",110,0)
 ;
"RTN","PSBMLVAL",111,0)
 S RESULTS(0)=PSBOKAY
"RTN","PSBMLVAL",112,0)
 F X=1:1 Q:'$D(PSBOKAY(X))  S RESULTS($O(RESULTS(""),-1)+1)=PSBOKAY(X)
"RTN","PSBMLVAL",113,0)
 Q
"RTN","PSBMLVAL",114,0)
 ;
"RTN","PSBO")
0^14^B63302774
"RTN","PSBO",1,0)
PSBO ;BIRMINGHAM/EFC-BCMA OUTPUTS ;Mar 2004
"RTN","PSBO",2,0)
 ;;3.0;BAR CODE MED ADMIN;;Mar 2004
"RTN","PSBO",3,0)
 ;
"RTN","PSBO",4,0)
 ; Reference/IA
"RTN","PSBO",5,0)
 ; ^DPT(/10035
"RTN","PSBO",6,0)
 ; WARD^NURSUT5/3052
"RTN","PSBO",7,0)
 ; EN^PSJBCMA/2828
"RTN","PSBO",8,0)
 ; ^ORD(101.24/3429
"RTN","PSBO",9,0)
 ; ^PSDRUG(/221
"RTN","PSBO",10,0)
 ;
"RTN","PSBO",11,0)
 ;
"RTN","PSBO",12,0)
RPC(RESULTS,PSBTYPE,PSBDFN,PSBSTRT,PSBSTOP,PSBINCL,PSBDEV,PSBSORT,PSBOI,PSBWLOC,PSBWSORT,PSBFUTR,PSBORDNM) ;
"RTN","PSBO",13,0)
 ;
"RTN","PSBO",14,0)
 ; RPC: PSB REPORT
"RTN","PSBO",15,0)
 ;
"RTN","PSBO",16,0)
 ; Description:
"RTN","PSBO",17,0)
 ; Used by the client to create individual patient extracts of
"RTN","PSBO",18,0)
 ; CHUI report options to display on the client.
"RTN","PSBO",19,0)
 ;
"RTN","PSBO",20,0)
 S RESULTS=$NAME(^TMP("PSBO",$J))
"RTN","PSBO",21,0)
 N PSBIENS,PSBRPT,PSBFDA,DIC,PSBANS
"RTN","PSBO",22,0)
 K ^TMP("PSBO",$J) S ^TMP("PSBO",$J,1)="-1^"
"RTN","PSBO",23,0)
 S DFN=PSBDFN
"RTN","PSBO",24,0)
 D NEW^PSBO1(.PSBRPT,PSBTYPE)
"RTN","PSBO",25,0)
 I +PSBRPT(0)<1 S ^TMP("PSBO",$J,1)="-1^Error: "_$P(PSBRPT(0),U,2) Q
"RTN","PSBO",26,0)
 S PSBIENS=+PSBRPT(0)_","
"RTN","PSBO",27,0)
 S PSBSTRT(0)=$E($P(PSBSTRT,".",2)_"0000",1,4),PSBSTRT=PSBSTRT\1
"RTN","PSBO",28,0)
 S PSBSTOP(0)=$E($P(PSBSTOP,".",2)_"0000",1,4),PSBSTOP=PSBSTOP\1
"RTN","PSBO",29,0)
 D:$G(PSBDEV)]""
"RTN","PSBO",30,0)
 .D NOW^%DTC
"RTN","PSBO",31,0)
 .I $P(PSBDEV,U,2)="" D VAL^DIE(53.69,PSBIENS,.06,"F",PSBDEV,"PSBRET","PSBFDA")
"RTN","PSBO",32,0)
 .I $P(PSBDEV,U,2)'="" D VAL^DIE(53.69,PSBIENS,.06,"F","`"_$P(PSBDEV,U,2),"PSBRET","PSBFDA")
"RTN","PSBO",33,0)
 .D VAL^DIE(53.69,PSBIENS,.07,"F",%,"PSBRET","PSBFDA")
"RTN","PSBO",34,0)
 D:$G(PSBOI)]"" VAL^DIE(53.69,PSBIENS,.09,"F",PSBOI,"PSBRET","PSBFDA")
"RTN","PSBO",35,0)
 D VAL^DIE(53.69,PSBIENS,.11,"F","P","PSBRET","PSBFDA")
"RTN","PSBO",36,0)
 D:$G(PSBSORT)]"" VAL^DIE(53.69,PSBIENS,.11,"F",PSBSORT,"PSBRET","PSBFDA")
"RTN","PSBO",37,0)
 D VAL^DIE(53.69,PSBIENS,.12,"F","`"_PSBDFN,"PSBRET","PSBFDA")
"RTN","PSBO",38,0)
 I $G(PSBWLOC)]"" S PSBFDA(53.69,PSBIENS,.13)=PSBWLOC
"RTN","PSBO",39,0)
 D:$G(PSBWSORT)]"" VAL^DIE(53.69,PSBIENS,.15,"F",PSBWSORT,"PSBRET","PSBFDA")
"RTN","PSBO",40,0)
 D VAL^DIE(53.69,PSBIENS,.16,"F",PSBSTRT,"PSBRET","PSBFDA")
"RTN","PSBO",41,0)
 D VAL^DIE(53.69,PSBIENS,.17,"F",PSBSTRT(0),"PSBRET","PSBFDA")
"RTN","PSBO",42,0)
 D VAL^DIE(53.69,PSBIENS,.18,"F",PSBSTOP,"PSBRET","PSBFDA")
"RTN","PSBO",43,0)
 D VAL^DIE(53.69,PSBIENS,.19,"F",PSBSTOP(0),"PSBRET","PSBFDA")
"RTN","PSBO",44,0)
 D:$G(PSBINCL)]""
"RTN","PSBO",45,0)
 .D VAL^DIE(53.69,PSBIENS,.21,"F",+$P(PSBINCL,"^",1),"PSBRET","PSBFDA")
"RTN","PSBO",46,0)
 .D VAL^DIE(53.69,PSBIENS,.22,"F",+$P(PSBINCL,"^",2),"PSBRET","PSBFDA")
"RTN","PSBO",47,0)
 .D VAL^DIE(53.69,PSBIENS,.23,"F",+$P(PSBINCL,"^",3),"PSBRET","PSBFDA")
"RTN","PSBO",48,0)
 .D VAL^DIE(53.69,PSBIENS,.24,"F",+$P(PSBINCL,"^",4),"PSBRET","PSBFDA")
"RTN","PSBO",49,0)
 .D VAL^DIE(53.69,PSBIENS,.28,"F",+$P(PSBINCL,"^",5),"PSBRET","PSBFDA")
"RTN","PSBO",50,0)
 .D VAL^DIE(53.69,PSBIENS,.29,"F",+$P(PSBINCL,"^",6),"PSBRET","PSBFDA")
"RTN","PSBO",51,0)
 D:$G(PSBFUTR)]""
"RTN","PSBO",52,0)
 .D VAL^DIE(53.69,PSBIENS,.25,"F",+$P(PSBFUTR,"^",1),"PSBRET","PSBFDA")
"RTN","PSBO",53,0)
 .D VAL^DIE(53.69,PSBIENS,.26,"F",+$P(PSBFUTR,"^",2),"PSBRET","PSBFDA")
"RTN","PSBO",54,0)
 .D VAL^DIE(53.69,PSBIENS,.27,"F",+$P(PSBFUTR,"^",3),"PSBRET","PSBFDA")
"RTN","PSBO",55,0)
 .D VAL^DIE(53.69,PSBIENS,.41,"F",+$P(PSBFUTR,"^",4),"PSBRET","PSBFDA")
"RTN","PSBO",56,0)
 D FILE^DIE("","PSBFDA")
"RTN","PSBO",57,0)
 I $G(PSBDEV)]"" D PRINT^PSBO1 S RESULTS=$NAME(^TMP("PSBO",$J)) Q
"RTN","PSBO",58,0)
 D HFSOPEN^PSBUTL("RPC") I POP S ^TMP("PSBO",$J,1)="ERROR: UNABLE TO ACCESS HFS DIRECTORY "_$$GET^XPAR("DIV","PSB HFS SCRATCH"),^TMP("PSBO",$J,2)="PLEASE CHECK DIRECTORY WRITE PRIVILEDGES." Q
"RTN","PSBO",59,0)
 U IO D DQ(+PSBIENS)
"RTN","PSBO",60,0)
 D HFSCLOSE^PSBUTL("RPC")
"RTN","PSBO",61,0)
 S RESULTS=$NAME(^TMP("PSBO",$J))
"RTN","PSBO",62,0)
 D:$G(PSBDEV)]"" PRINT^PSBO1
"RTN","PSBO",63,0)
 Q
"RTN","PSBO",64,0)
 ;
"RTN","PSBO",65,0)
XQ(PSBTYPE) ; Called via Kernel Menus
"RTN","PSBO",66,0)
 N PSBANS,PSBANS1,PSBRPT,PSBSAVE,DA,DIK,DR,DDSFILE
"RTN","PSBO",67,0)
 D NEW^PSBO1(.PSBRPT,PSBTYPE)
"RTN","PSBO",68,0)
 I +PSBRPT(0)<1 W !,"Error: ",$P(PSBRPT(0),U,2) S DIR(0)="E" D ^DIR Q
"RTN","PSBO",69,0)
 S DA=+PSBRPT(0),DR="[PSBO "_PSBTYPE_"]",DDSFILE=53.69 D ^DDS
"RTN","PSBO",70,0)
 W @IOF
"RTN","PSBO",71,0)
 I 'PSBSAVE W !,"Cancelling Request..." S DIK="^PSB(53.69," D ^DIK W "Cancelled!"
"RTN","PSBO",72,0)
 D:PSBSAVE
"RTN","PSBO",73,0)
 .;Check Drug to Patient Relationship.
"RTN","PSBO",74,0)
 .I PSBTYPE="BL" S PSBANS="" D CHECK  I PSBANS=0!($D(DIRUT)) W !,"Cancelling Request..." S DIK="^PSB(53.69," D ^DIK W "Cancelled!" Q
"RTN","PSBO",75,0)
 .;
"RTN","PSBO",76,0)
 .;Allow "'BROWSER" Device
"RTN","PSBO",77,0)
 .S IOP=$$GET1^DIQ(53.69,DA_",",.06,"I"),PSBSIO=0 I IOP]"" D
"RTN","PSBO",78,0)
 ..S IOP="`"_IOP,%ZIS="N"
"RTN","PSBO",79,0)
 ..D ^%ZIS
"RTN","PSBO",80,0)
 ..I IO=IO(0) S PSBSIO=1
"RTN","PSBO",81,0)
 ..D HOME^%ZIS K IOP
"RTN","PSBO",82,0)
 .I $$GET1^DIQ(53.69,DA_",",.06)["BROWSER"!(PSBSIO=1) S IOP=$$GET1^DIQ(53.69,DA_",",.06)_";132" D ^%ZIS U IO D DQ(DA) D ^%ZISC K IOP Q
"RTN","PSBO",83,0)
 .W @IOF,"Submitting Your Report Request to Taskman..."
"RTN","PSBO",84,0)
 .S ZTIO=$$GET1^DIQ(53.69,DA_",",.06)
"RTN","PSBO",85,0)
 .S ZTDTH=$P(^PSB(53.69,DA,0),U,7)
"RTN","PSBO",86,0)
 .S ZTDESC="BCMA - "_$$GET1^DIQ(53.69,DA_",",.05)
"RTN","PSBO",87,0)
 .S ZTRTN="DQ^PSBO("_DA_")"
"RTN","PSBO",88,0)
 .D ^%ZTLOAD
"RTN","PSBO",89,0)
 .W "Submitted!",!,"Your Task Number Is: ",$G(ZTSK),!
"RTN","PSBO",90,0)
 K ^TMP("PSBO",$J)
"RTN","PSBO",91,0)
 Q
"RTN","PSBO",92,0)
 ;
"RTN","PSBO",93,0)
DQ(PSBRPT) ; Dequeue report from Taskman
"RTN","PSBO",94,0)
 N PSBWRD,PSBDFN
"RTN","PSBO",95,0)
 Q:'$D(^PSB(53.69,PSBRPT,0))  ; No Such Report
"RTN","PSBO",96,0)
 S $P(^PSB(53.69,PSBRPT,0),U,8)=$G(ZTSK,"RPC")
"RTN","PSBO",97,0)
 D:$$SETUP @("EN^PSBO"_$P(PSBRPT(0),U,5))
"RTN","PSBO",98,0)
 K ^TMP("PSBO",$J)
"RTN","PSBO",99,0)
 S ZTREQ="@"
"RTN","PSBO",100,0)
 Q
"RTN","PSBO",101,0)
 ;
"RTN","PSBO",102,0)
IOM() ; Returns good margin or not
"RTN","PSBO",103,0)
 Q:IOM'<132 1
"RTN","PSBO",104,0)
 W !,"**************************************************************"
"RTN","PSBO",105,0)
 W !,"* SORRY, Your selected DEVICE does not print 132 columns.    *"
"RTN","PSBO",106,0)
 W !,"**************************************************************"
"RTN","PSBO",107,0)
 W !
"RTN","PSBO",108,0)
 Q 0
"RTN","PSBO",109,0)
 ;
"RTN","PSBO",110,0)
VAL(PSBFLDS) ; Validate that fields in PSBFLDS are filled in
"RTN","PSBO",111,0)
 N PSB,PSBFLD,PSBMSG,PSBSTOP,PSBST,PSBDAYS S PSBSTRT=""
"RTN","PSBO",112,0)
 F PSB=1:1 Q:$P(PSBFLDS,";",PSB)=""  S PSBFLD=$P(PSBFLDS,";",PSB),PSBFLD(PSBFLD)=$$GET^DDSVAL(53.69,DA,PSBFLD)
"RTN","PSBO",113,0)
 I $D(PSBFLD(.11)) K:$E(PSBFLD(.11))="P" PSBFLD(.13),PSBFLD(.15) K:$E(PSBFLD(.11))="W" PSBFLD(.12)
"RTN","PSBO",114,0)
 S PSB=""  F  S PSB=$O(PSBFLD(PSB)) Q:PSB=""  D:PSBFLD(PSB)=""
"RTN","PSBO",115,0)
 .I '$D(PSBMSG) S PSBMSG(0)="UNABLE TO FILE REQUEST",PSBMSG(1)=" ",PSBMSG(2)="ERROR: MISSING DATA - ALL FIELDS ARE REQUIRED",PSBMSG(3)=" "
"RTN","PSBO",116,0)
 .D FIELD^DID(53.69,PSB,"","TITLE;LABEL","PSB")
"RTN","PSBO",117,0)
 .S Z="  Missing Field: "_$S(PSB("TITLE")]"":PSB("TITLE"),1:PSB("LABEL"))
"RTN","PSBO",118,0)
 .S PSBMSG($O(PSBMSG(""),-1)+1)=Z
"RTN","PSBO",119,0)
 ; Check Times
"RTN","PSBO",120,0)
 D:$G(PSBFLD(.16))
"RTN","PSBO",121,0)
 .S PSBSTRT=PSBFLD(.16)+$G(PSBFLD(.17))
"RTN","PSBO",122,0)
 .D:$P($$GET1^DIQ(53.69,DA_",",.01),U)["MH"
"RTN","PSBO",123,0)
 ..S PSBDAYS=$$GET1^DIQ(101.24,$$FIND1^DIC(101.24,"","X","ORRP BCMA MAH","B")_",",.42)  ;check maxdays
"RTN","PSBO",124,0)
 ..S:PSBDAYS="" PSBDAYS=7
"RTN","PSBO",125,0)
 ..S X=PSBSTRT\1 D H^%DTC S PSBST=%H+PSBDAYS    ;Determine stop date
"RTN","PSBO",126,0)
 .S PSBSTOP=$S($G(PSBFLD(.18)):PSBFLD(.18),1:PSBFLD(.16))+$G(PSBFLD(.19))
"RTN","PSBO",127,0)
 .I PSBSTOP<PSBSTRT S Y=$O(PSBMSG(""),-1)+1,PSBMSG(Y)="  Date: Stop Date/Time is before Start Date/Time"
"RTN","PSBO",128,0)
 .I $P($$GET1^DIQ(53.69,DA_",",.01),U)["MH" S X=PSBSTOP\1 D H^%DTC I %H>PSBST S Y=$O(PSBMSG(""),-1)+1,PSBMSG(Y)="  The date range cannot exceed "_PSBDAYS_" day(s) as defined in the CPRS 'MAXIMUM DAYS BACK' parameter"
"RTN","PSBO",129,0)
 Q:'$D(PSBMSG)  ; All is well
"RTN","PSBO",130,0)
 D MSG^DDSUTL(.PSBMSG)
"RTN","PSBO",131,0)
 S DDSERROR=1
"RTN","PSBO",132,0)
 Q
"RTN","PSBO",133,0)
 ;
"RTN","PSBO",134,0)
SETUP() ; Setup parameters for the report in PSBRPT
"RTN","PSBO",135,0)
 N PSBWRDL,PSBINDX,PSBWRDA
"RTN","PSBO",136,0)
 K ^TMP("PSBO",$J)
"RTN","PSBO",137,0)
 F X=0,.1,.2,.3,.4 S PSBRPT(X)=$G(^PSB(53.69,PSBRPT,X))
"RTN","PSBO",138,0)
 I $P(PSBRPT(.1),U,1)="P" S PSBDFN=+$P(PSBRPT(.1),U,2) Q:'PSBDFN  S ^TMP("PSBO",$J,PSBDFN,0)=$P(^DPT(PSBDFN,0),U)_U_$P(^DPT(PSBDFN,0),U,9),^TMP("PSBO",$J,"B",$P(^DPT(PSBDFN,0),U),PSBDFN)=""
"RTN","PSBO",139,0)
 D:$P(PSBRPT(.1),U,1)="W"
"RTN","PSBO",140,0)
 .S PSBWRD=$P(PSBRPT(.1),U,3) Q:'PSBWRD  D WARD^NURSUT5("L^"_PSBWRD,.PSBWRDA)
"RTN","PSBO",141,0)
 .S X="" F  S X=$O(PSBWRDA(PSBWRD,2,X)) Q:X=""   S PSBWRDL=$P(PSBWRDA(PSBWRD,2,X,.01),U,2) D
"RTN","PSBO",142,0)
 ..F PSBDFN=0:0 S PSBDFN=$O(^DPT("CN",PSBWRDL,PSBDFN)) Q:'PSBDFN  D
"RTN","PSBO",143,0)
 ...S ^TMP("PSBO",$J,PSBDFN,0)=$P(^DPT(PSBDFN,0),U)_U_$P(^DPT(PSBDFN,0),U,9)
"RTN","PSBO",144,0)
 ...; Determine Sort or default to Pt Name...
"RTN","PSBO",145,0)
 ...S:$P(PSBRPT(.1),U,5)="P" PSBINDX=$P(^DPT(PSBDFN,0),U)
"RTN","PSBO",146,0)
 ...I $P(PSBRPT(.1),U,5)="B" S PSBINDX=$P($G(^DPT(PSBDFN,.101)),U) S:PSBINDX="" PSBINDX="** NO ROOM BED **"
"RTN","PSBO",147,0)
 ...S:$P(PSBRPT(.1),U,5)="" PSBINDX=$P(^DPT(PSBDFN,0),U)
"RTN","PSBO",148,0)
 ...S:$G(PSBINDX)="" PSBINDX=$P(^DPT(PSBDFN,0),U)
"RTN","PSBO",149,0)
 ...S ^TMP("PSBO",$J,"B",PSBINDX,PSBDFN)=""
"RTN","PSBO",150,0)
 Q 1
"RTN","PSBO",151,0)
 ;
"RTN","PSBO",152,0)
WRAP(X,Y,Z)    ; Quick text wrap
"RTN","PSBO",153,0)
 ;
"RTN","PSBO",154,0)
 ; Input Parameters Description:
"RTN","PSBO",155,0)
 ;  X: Left Column of display [Optional]
"RTN","PSBO",156,0)
 ;  Y: Cols to wrap in [Optional]
"RTN","PSBO",157,0)
 ;  Z: Text to wrap [Optional]
"RTN","PSBO",158,0)
 ;
"RTN","PSBO",159,0)
 N PSB
"RTN","PSBO",160,0)
 F  Q:'$L(Z)  D
"RTN","PSBO",161,0)
 .W:$X>X !
"RTN","PSBO",162,0)
 .W:$X<X ?X
"RTN","PSBO",163,0)
 .I $L(Z)<Y W Z S Z="" Q
"RTN","PSBO",164,0)
 .F PSB=Y:-1:0 Q:$E(Z,PSB)=" "
"RTN","PSBO",165,0)
 .S:PSB<1 PSB=Y
"RTN","PSBO",166,0)
 .W $E(Z,1,PSB)
"RTN","PSBO",167,0)
 .S Z=$E(Z,PSB+1,250)
"RTN","PSBO",168,0)
 Q ""
"RTN","PSBO",169,0)
 ;
"RTN","PSBO",170,0)
CHECK ;Beginning of PSB*1*10
"RTN","PSBO",171,0)
 K ^TMP("PSJ",$J)
"RTN","PSBO",172,0)
 N PSBDFN,PSBBAR,PSBDRUG,PSBFLAG,PSBPNM,PSBNDX,PSBX
"RTN","PSBO",173,0)
 S PSBFLAG="",PSBBAR=$P($P($G(^PSB(53.69,DA,.3)),U,1),"~",2)
"RTN","PSBO",174,0)
 S PSBDRUG=$$GET1^DIQ(53.69,DA_",",.31)
"RTN","PSBO",175,0)
 S PSBDFN=$$GET1^DIQ(53.69,DA_",",.12,"I") S:$G(PSBDFN) PSBFLAG=1
"RTN","PSBO",176,0)
 D EN^PSJBCMA(PSBDFN)
"RTN","PSBO",177,0)
 F PSBX=0:0 S PSBX=$O(^TMP("PSJ",$J,PSBX)) Q:'PSBX  D
"RTN","PSBO",178,0)
 .K Y,PSBORD,PSBPNM,PSBNDX
"RTN","PSBO",179,0)
 .M PSBORD=^TMP("PSJ",$J,PSBX)
"RTN","PSBO",180,0)
 .F PSBNDX=700,850,950  D
"RTN","PSBO",181,0)
 ..F Y=0:0 S Y=$O(PSBORD(PSBNDX,Y)) Q:'Y  D
"RTN","PSBO",182,0)
 ...I $P($G(PSBORD(1)),U,7)'="A" Q
"RTN","PSBO",183,0)
 ...S PSBPNM=$P(PSBORD(PSBNDX,Y,0),U,1)
"RTN","PSBO",184,0)
 ...I PSBNDX=700,PSBPNM=PSBBAR S PSBFLAG=0 Q
"RTN","PSBO",185,0)
 ...I PSBNDX=850,$D(^PSDRUG("A526",PSBBAR,PSBPNM)) S PSBFLAG=0 Q
"RTN","PSBO",186,0)
 ...I PSBNDX=950,$D(^PSDRUG("A527",PSBBAR,PSBPNM)) S PSBFLAG=0
"RTN","PSBO",187,0)
 I PSBFLAG=1 D
"RTN","PSBO",188,0)
 .W !,"Patient is not currently on medication: ",PSBDRUG
"RTN","PSBO",189,0)
 .K DIRUT,DIR
"RTN","PSBO",190,0)
 .S DIR("A")="Do you want to continue"
"RTN","PSBO",191,0)
 .S DIR(0)="Y"
"RTN","PSBO",192,0)
 .D ^DIR
"RTN","PSBO",193,0)
 .S PSBANS=+Y W !
"RTN","PSBO1")
0^15^B5034282
"RTN","PSBO1",1,0)
PSBO1 ;BIRMINGHAM/EFC-BCMA OUTPUTS ;Mar 2004
"RTN","PSBO1",2,0)
 ;;3.0;BAR CODE MED ADMIN;;Mar 2004
"RTN","PSBO1",3,0)
 ;
"RTN","PSBO1",4,0)
NEW(RESULTS,PSBRTYP) ; Create a new report request
"RTN","PSBO1",5,0)
 ; Called interactively and via RPCBroker
"RTN","PSBO1",6,0)
 K RESULTS
"RTN","PSBO1",7,0)
 ; Check Type
"RTN","PSBO1",8,0)
 I '$F("DL^MD^MH^ML^MM^MV^PE^PM^WA^BL^PI^AL^DO^VT",PSBRTYP) S RESULTS(0)="-1^Invalid Report Type" Q
"RTN","PSBO1",9,0)
 I '+$G(DUZ) S RESULTS(0)="-1^Undefined User" Q
"RTN","PSBO1",10,0)
 I '$G(DUZ(2)) S RESULTS(0)="-1^Undefined Division" Q
"RTN","PSBO1",11,0)
 ; Lock Log
"RTN","PSBO1",12,0)
 L +(^PSB(53.69,0)):30
"RTN","PSBO1",13,0)
 E  S RESULTS(0)="-1^Request Log Locked" Q
"RTN","PSBO1",14,0)
 ; Generate Unique Entry and Create
"RTN","PSBO1",15,0)
 F  D NOW^%DTC S X=$E(%_"000000",1,14) S X=(1700+$E(X,1,3))_$E(X,4,14),X=PSBRTYP_"-"_$TR(X,".","-") Q:'$D(^PSB(53.69,"B",X))
"RTN","PSBO1",16,0)
 S DIC="^PSB(53.69,",DIC(0)="L"
"RTN","PSBO1",17,0)
 S DIC("DR")=".02///N;.03////^S X=DUZ;.04////^S X=DUZ(2);.05///^S X=PSBRTYP"
"RTN","PSBO1",18,0)
 K DD,DO D FILE^DICN
"RTN","PSBO1",19,0)
 L -(^PSB(53.69,0))
"RTN","PSBO1",20,0)
 ; Okay, setup return and Boogie
"RTN","PSBO1",21,0)
 I +Y<1 S RESULTS(0)="-1^Error Creating Request"
"RTN","PSBO1",22,0)
 E  S RESULTS(0)=Y
"RTN","PSBO1",23,0)
 Q
"RTN","PSBO1",24,0)
 ;
"RTN","PSBO1",25,0)
PRINT ;
"RTN","PSBO1",26,0)
 N ZTDTH,ZTRTN,ZTSK,ZTDESC,ZTSAVE,DA
"RTN","PSBO1",27,0)
 S DA=+PSBRPT(0)
"RTN","PSBO1",28,0)
 S IOP=$$GET1^DIQ(53.69,DA_",",.06,"I"),PSBSIO=0 I IOP]"" D
"RTN","PSBO1",29,0)
 .S IOP="`"_IOP,%ZIS="N"
"RTN","PSBO1",30,0)
 .D ^%ZIS
"RTN","PSBO1",31,0)
 .I IO=IO(0) S PSBSIO=1
"RTN","PSBO1",32,0)
 .D HOME^%ZIS K IOP
"RTN","PSBO1",33,0)
 I $$GET1^DIQ(53.69,DA_",",.06)["BROWSER"!(PSBSIO=1) S IOP=$$GET1^DIQ(53.69,DA_",",.06)_";132" D ^%ZIS U IO D DQ^PSBO(DA) D ^%ZISC K IOP Q
"RTN","PSBO1",34,0)
 W @IOF,"Submitting Your Report Request to Taskman..."
"RTN","PSBO1",35,0)
 S ZTIO=$$GET1^DIQ(53.69,DA_",",.06)_";132"
"RTN","PSBO1",36,0)
 S ZTDTH=$H
"RTN","PSBO1",37,0)
 S ZTDESC="BCMA - "_$$GET1^DIQ(53.69,DA_",",.05)
"RTN","PSBO1",38,0)
 S ZTRTN="DQ^PSBO("_DA_")"
"RTN","PSBO1",39,0)
 F I="PSBDFN","PSBTYPE" S ZTSAVE(I)=""
"RTN","PSBO1",40,0)
 I $G(PSBORDNM)]"" S ZTSAVE("PSBORDNM")=""
"RTN","PSBO1",41,0)
 D ^%ZTLOAD
"RTN","PSBO1",42,0)
 I $D(ZTSK) S ^TMP("PSBO",$J,1)="0^Report queued. (Task #"_ZTSK_")"
"RTN","PSBO1",43,0)
 E  S ^TMP("PSBO",$J,1)="-1^Task Rejected."
"RTN","PSBO1",44,0)
 Q
"RTN","PSBO1",45,0)
  
"RTN","PSBOAL")
0^16^B3441783
"RTN","PSBOAL",1,0)
PSBOAL ;BIRMINGHAM/EFC-BCMA UTILITIES ;Mar 2004
"RTN","PSBOAL",2,0)
 ;;3.0;BAR CODE MED ADMIN;;Mar 2004
"RTN","PSBOAL",3,0)
 ;
"RTN","PSBOAL",4,0)
 ; Reference/IA
"RTN","PSBOAL",5,0)
 ; ^GMRADPT/10099
"RTN","PSBOAL",6,0)
 ; ^GMRAOR2/2422
"RTN","PSBOAL",7,0)
EN ;
"RTN","PSBOAL",8,0)
 N PSBLIST,PSBGBL,DFN
"RTN","PSBOAL",9,0)
 S PSBGBL="^TMP(""PSBO"",$J,""B"")"
"RTN","PSBOAL",10,0)
 F  S PSBGBL=$Q(@PSBGBL) Q:PSBGBL=""  Q:$QS(PSBGBL,2)'=$J  Q:$QS(PSBGBL,1)'["PSBO"  D
"RTN","PSBOAL",11,0)
 .S DFN=$QS(PSBGBL,5)
"RTN","PSBOAL",12,0)
 .D EN1
"RTN","PSBOAL",13,0)
 K ^TMP("PSBO",$J)
"RTN","PSBOAL",14,0)
 Q
"RTN","PSBOAL",15,0)
 ;
"RTN","PSBOAL",16,0)
EN1 ;
"RTN","PSBOAL",17,0)
 S GMRA="0^0^111" S PSBLIST=""
"RTN","PSBOAL",18,0)
 D EN1^GMRADPT
"RTN","PSBOAL",19,0)
 F  S PSBLIST=$O(GMRAL(PSBLIST)) Q:'PSBLIST  D
"RTN","PSBOAL",20,0)
 .K PSBARRY
"RTN","PSBOAL",21,0)
 .D EN1^GMRAOR2(PSBLIST,"PSBARRY")
"RTN","PSBOAL",22,0)
 .W !,""
"RTN","PSBOAL",23,0)
 .W !,"   Causative agent      : "_$P(PSBARRY,U)
"RTN","PSBOAL",24,0)
 .W !,""
"RTN","PSBOAL",25,0)
 .I $D(PSBARRY("S",1)) D SYMP
"RTN","PSBOAL",26,0)
 .I $D(PSBARRY("V",1)) D CLAS
"RTN","PSBOAL",27,0)
 .W !,"   Verified             : "_$S($P(PSBARRY,U,4)="VERIFIED":"Yes",1:"No")
"RTN","PSBOAL",28,0)
 .W !,"   Observed/Historical  : "_$S($P(PSBARRY,U,5)="OBSERVED":"Observed",$P(PSBARRY,U,5)="HISTORICAL":"Historical",1:"")
"RTN","PSBOAL",29,0)
 .W !,"   ******************************************"
"RTN","PSBOAL",30,0)
 Q
"RTN","PSBOAL",31,0)
 ;
"RTN","PSBOAL",32,0)
SYMP ;
"RTN","PSBOAL",33,0)
 S K=0,N=0 F  S K=$O(PSBARRY("S",K)) Q:K'>0  D
"RTN","PSBOAL",34,0)
 .I N=0 W !,"   Signs/symptoms       : "_PSBARRY("S",K)
"RTN","PSBOAL",35,0)
 .E  W !,"              "_PSBARRY("S",K)
"RTN","PSBOAL",36,0)
 .S N=N+1
"RTN","PSBOAL",37,0)
 W !
"RTN","PSBOAL",38,0)
 K N,K
"RTN","PSBOAL",39,0)
 Q
"RTN","PSBOAL",40,0)
CLAS ;
"RTN","PSBOAL",41,0)
 S K=0,N=0 F  S K=$O(PSBARRY("V",K)) Q:K'>0  D
"RTN","PSBOAL",42,0)
 .I N=0 W !,"   Drug Classes         : "_$P(PSBARRY("V",K),U,2)
"RTN","PSBOAL",43,0)
 .E  W !,"     "_$P(PSBARRY("V",K),U,2)
"RTN","PSBOAL",44,0)
 .S N=N+1
"RTN","PSBOAL",45,0)
 W !
"RTN","PSBOAL",46,0)
 K N,K
"RTN","PSBOAL",47,0)
 Q
"RTN","PSBOBL")
0^17^B9096254
"RTN","PSBOBL",1,0)
PSBOBL ;BIRMINGHAM/EFC-BAR CODE LABELS (ZEBRA SPECIFIC) ;Mar 2004
"RTN","PSBOBL",2,0)
 ;;3.0;BAR CODE MED ADMIN;;Mar 2004
"RTN","PSBOBL",3,0)
 ;
"RTN","PSBOBL",4,0)
 ; Reference/IA
"RTN","PSBOBL",5,0)
 ; File 50/221
"RTN","PSBOBL",6,0)
 ;
"RTN","PSBOBL",7,0)
EN ;
"RTN","PSBOBL",8,0)
 N PSBIENS,PSBBAR,PSBDRUG,PSBQTY,PSBDOSE,PSBNAME,PSBWARD,PSBLOT
"RTN","PSBOBL",9,0)
 N PSBEXP,PSBMFG,PSBFCB,PSBSYM,PSBCNT,PSBANS,PSBORD
"RTN","PSBOBL",10,0)
 S PSBIENS=PSBRPT_","
"RTN","PSBOBL",11,0)
 S PSBBAR=$P($P($G(^PSB(53.69,PSBRPT,.3)),U,1),"~",2)
"RTN","PSBOBL",12,0)
 ;
"RTN","PSBOBL",13,0)
 S PSBPRE=$$GET^XPAR("DIV","PSB DEFAULT BARCODE PREFIX")
"RTN","PSBOBL",14,0)
 S:PSBPRE]"" PSBBAR=PSBPRE_$S(PSBPRE?1.N:"-",1:"")_PSBBAR
"RTN","PSBOBL",15,0)
 ;
"RTN","PSBOBL",16,0)
 S PSBDRUG=$$GET1^DIQ(53.69,PSBIENS,.31)
"RTN","PSBOBL",17,0)
 S PSBQTY=+$$GET1^DIQ(53.69,PSBIENS,.35)
"RTN","PSBOBL",18,0)
 S:PSBQTY PSBDRUG=PSBDRUG_" (Qty: "_PSBQTY_")"
"RTN","PSBOBL",19,0)
 S PSBDOSE=$$GET1^DIQ(53.69,PSBIENS,.39)
"RTN","PSBOBL",20,0)
 S PSBNAME=$$GET1^DIQ(53.69,PSBIENS,.12)
"RTN","PSBOBL",21,0)
 I PSBNAME]"" S PSBNAME=PSBNAME_" ("_$E($$GET1^DIQ(53.69,PSBIENS,.121),6,9)_")"
"RTN","PSBOBL",22,0)
 S PSBWARD=$$GET1^DIQ(53.69,PSBIENS,.122)
"RTN","PSBOBL",23,0)
 S PSBLOT=$$GET1^DIQ(53.69,PSBIENS,.32)
"RTN","PSBOBL",24,0)
 S PSBEXP=$$GET1^DIQ(53.69,PSBIENS,.33)
"RTN","PSBOBL",25,0)
 S PSBMFG=$$GET1^DIQ(53.69,PSBIENS,.34)
"RTN","PSBOBL",26,0)
 S PSBFCB=$$GET1^DIQ(53.69,PSBIENS,.36)_"/"_$$GET1^DIQ(53.69,PSBIENS,.37)
"RTN","PSBOBL",27,0)
 S PSBSYM=$$GET^XPAR("DIV","PSB DEFAULT BARCODE FORMAT",,"E")
"RTN","PSBOBL",28,0)
 F PSBCNT=1:1:+$P(PSBRPT(.3),U,8) D LABEL
"RTN","PSBOBL",29,0)
 Q
"RTN","PSBOBL",30,0)
 ;
"RTN","PSBOBL",31,0)
LABEL ; Print the Label
"RTN","PSBOBL",32,0)
 W "^XA"
"RTN","PSBOBL",33,0)
 W !,"^LH0,0^FS"
"RTN","PSBOBL",34,0)
 W $$DATA(20,25,"Drug:")
"RTN","PSBOBL",35,0)
 W $$DATA(100,25,PSBDRUG)
"RTN","PSBOBL",36,0)
 I PSBDOSE]"" W $$DATA(20,60,"Dosage:") W $$DATA(100,60,PSBDOSE)
"RTN","PSBOBL",37,0)
 I PSBNAME]"" W $$DATA(350,60,PSBNAME)
"RTN","PSBOBL",38,0)
 I PSBWARD]"" W $$DATA(350,90,"Ward:") W $$DATA(400,90,PSBWARD)
"RTN","PSBOBL",39,0)
 I PSBLOT]"" W $$DATA(350,120,"Lot#:") W $$DATA(400,120,PSBLOT)
"RTN","PSBOBL",40,0)
 I PSBEXP]"" W $$DATA(500,120,"Exp:") W $$DATA(550,120,PSBEXP)
"RTN","PSBOBL",41,0)
 I PSBMFG]"" W $$DATA(350,150,"Mfg:") W $$DATA(400,150,PSBMFG)
"RTN","PSBOBL",42,0)
 W $$DATA(350,180,"Filled/Checked By:") W $$DATA(520,180,PSBFCB)
"RTN","PSBOBL",43,0)
 ;
"RTN","PSBOBL",44,0)
 ; Code 39
"RTN","PSBOBL",45,0)
 I PSBSYM="C39" W !,"^BY2,3.0^FO20,100^B3N,N,80,Y,N^FR^FD"_PSBBAR_"^FS"
"RTN","PSBOBL",46,0)
 ;
"RTN","PSBOBL",47,0)
 ; Code 128
"RTN","PSBOBL",48,0)
 I PSBSYM="128" W !,"^BY2,3.0^FO20,100^BCN,80,Y,N,N^FR^FD>:"_PSBBAR_"^FS"
"RTN","PSBOBL",49,0)
 ;
"RTN","PSBOBL",50,0)
 ; Code I 2 of 5
"RTN","PSBOBL",51,0)
 I PSBSYM="I25" W !,"^BY2,3.0^FO20,100^B2N,80,Y,N,N^FR^FD"_PSBBAR_"^FS"
"RTN","PSBOBL",52,0)
 ;
"RTN","PSBOBL",53,0)
 I PSBSYM="" W $$DATA(20,100,"PSB DEFAULT BARCODE FORMAT Undefined.")
"RTN","PSBOBL",54,0)
 ;
"RTN","PSBOBL",55,0)
 ; Close Label
"RTN","PSBOBL",56,0)
 W !,"^XZ",!
"RTN","PSBOBL",57,0)
 H 2
"RTN","PSBOBL",58,0)
 Q
"RTN","PSBOBL",59,0)
 ;
"RTN","PSBOBL",60,0)
DATA(X,Y,TEXT) ; Code to place the data on the label
"RTN","PSBOBL",61,0)
 W !,"^FO"_X_","_Y_"^A0N,30,20^CI13^FR^FD"_TEXT_"^FS"
"RTN","PSBOBL",62,0)
 Q ""
"RTN","PSBOBL",63,0)
 ;
"RTN","PSBOBL",64,0)
INPTR ;Input transform for DRUG field (#.31) in file 53.69.
"RTN","PSBOBL",65,0)
 K:$L(X)>40!($L(X)<1) X I $D(X) D
"RTN","PSBOBL",66,0)
 .S X=$TR(X,"abcdefghijklmnopqrstuvwxyz","ABCDEFGHIJKLMNOPQRSTUVWXYZ")
"RTN","PSBOBL",67,0)
 .N DIC S DIC="^PSDRUG(",DIC(0)="EQNM",D="B^C^VAPN^VAC^NDC^XATC"
"RTN","PSBOBL",68,0)
 .S DIC("S")="I '$G(^PSDRUG(+Y,""I""))!($G(^(""I""))>DT),$P($G(^PSDRUG(+Y,2)),U,3)[""I""!($P($G(^PSDRUG(+Y,2)),U,3)[""U"")"
"RTN","PSBOBL",69,0)
 .D:+X'>0 MIX^DIC1
"RTN","PSBOBL",70,0)
 .D:+X>0 ^DIC
"RTN","PSBOBL",71,0)
 .S:+Y>0 X=$$GET1^DIQ(50,+Y_",",.01)_"~"_+Y K:+Y<1 X
"RTN","PSBOBL",72,0)
 Q
"RTN","PSBOBL",73,0)
 ;
"RTN","PSBODL")
0^18^B82184465
"RTN","PSBODL",1,0)
PSBODL ;BIRMINGHAM/EFC-DUE LIST ;Mar 2004
"RTN","PSBODL",2,0)
 ;;3.0;BAR CODE MED ADMIN;;Mar 2004 
"RTN","PSBODL",3,0)
 ;
"RTN","PSBODL",4,0)
 ; Reference/IA
"RTN","PSBODL",5,0)
 ; EN^PSJBCMA/2828
"RTN","PSBODL",6,0)
 ;
"RTN","PSBODL",7,0)
EN ; Print DL
"RTN","PSBODL",8,0)
 ;
"RTN","PSBODL",9,0)
 N PSBGBL,PSBHDR,IOINHI,IOINORM,PSBGIVEN,PSBIEN,PSBLGDT,PSBEVDT,DFN,PSBFLAG
"RTN","PSBODL",10,0)
 S X="IOINHI;IOINORM" D ENDR^%ZISS S X=""
"RTN","PSBODL",11,0)
 S PSBGBL="^TMP(""PSBO"",$J,""B"")"
"RTN","PSBODL",12,0)
 F  S PSBGBL=$Q(@PSBGBL) Q:PSBGBL=""  Q:$QS(PSBGBL,1)'="PSBO"!($QS(PSBGBL,2)'=$J)  D
"RTN","PSBODL",13,0)
 .S DFN=$QS(PSBGBL,5)
"RTN","PSBODL",14,0)
 .K PSBHDR
"RTN","PSBODL",15,0)
 .S PSBHDR(1)="MEDICATION DUE LIST for "
"RTN","PSBODL",16,0)
 .S (Y,PSBEVDT)=$P(PSBRPT(.1),U,6) D D^DIQ S PSBHDR(1)=PSBHDR(1)_Y_"  "
"RTN","PSBODL",17,0)
 .S Y=$P(PSBRPT(.1),U,7) S PSBHDR(1)=PSBHDR(1)_$E(Y_"0000",2,5)_"-"
"RTN","PSBODL",18,0)
 .S Y=$P(PSBRPT(.1),U,9) S PSBHDR(1)=PSBHDR(1)_$E(Y_"0000",2,5)
"RTN","PSBODL",19,0)
 .S:$P(PSBRPT(.2),U,6) X="IV "
"RTN","PSBODL",20,0)
 .S:$P(PSBRPT(.2),U,7) X=X_$S(X]"":"& ",1:"")_"Unit Dose "
"RTN","PSBODL",21,0)
 .S PSBHDR(2)="Order Type(s): "_X_" -- "
"RTN","PSBODL",22,0)
 .F Y=1:1:4 S:$P(PSBRPT(.2),U,Y) PSBHDR(2)=PSBHDR(2)_$P("Continuous^PRN^On-Call^One-Time",U,Y)_" "
"RTN","PSBODL",23,0)
 .D PRINT(DFN)
"RTN","PSBODL",24,0)
 K ^TMP("PSJ",$J),^TMP("PSB",$J),^TMP("PSBO",$J)
"RTN","PSBODL",25,0)
 Q
"RTN","PSBODL",26,0)
 ;
"RTN","PSBODL",27,0)
PRINT(DFN) ;P ^TMP($J.
"RTN","PSBODL",28,0)
 ; Mult calls I all wds
"RTN","PSBODL",29,0)
 N PSBGBL,PSBOSTRT,PSBOSTOP,PSBODATE,PSBINDX,PSBTYPE,PSBSCH,PSBSCHT
"RTN","PSBODL",30,0)
 N PSBMED,PSBORD,PSB,PSBX,PSBY,PSBZ,PSBSTOP,PSBSTRT,PSBSM,PSBNUM,PSBAT
"RTN","PSBODL",31,0)
 N PSBADMIN,PSBADM,PSBSTAT,PSBWFLAG
"RTN","PSBODL",32,0)
 W $$HDR()
"RTN","PSBODL",33,0)
 S PSBOSTRT=$P(PSBRPT(.1),U,6)+$P(PSBRPT(.1),U,7)
"RTN","PSBODL",34,0)
 S PSBOSTOP=$P(PSBRPT(.1),U,6)+$P(PSBRPT(.1),U,9)
"RTN","PSBODL",35,0)
 S PSBODATE=$P(PSBRPT(.1),U,6)
"RTN","PSBODL",36,0)
 K ^TMP("PSJ",$J),^TMP("PSB",$J)
"RTN","PSBODL",37,0)
 D EN^PSJBCMA(DFN,PSBOSTRT,"")
"RTN","PSBODL",38,0)
 I $G(^TMP("PSJ",$J,1,0))=-1 D  Q
"RTN","PSBODL",39,0)
 .W !!?10,"** NO SPECIFIED MEDICATIONS TO PRINT **"
"RTN","PSBODL",40,0)
 .W !,$$BLANKS(),$$FTR()
"RTN","PSBODL",41,0)
 S PSBINDX=0
"RTN","PSBODL",42,0)
 F  S PSBINDX=$O(^TMP("PSJ",$J,PSBINDX)) Q:'PSBINDX  D
"RTN","PSBODL",43,0)
 .S PSBTYPE=$P(^TMP("PSJ",$J,PSBINDX,0),U,3),PSBTYPE=$E(PSBTYPE,$L(PSBTYPE))
"RTN","PSBODL",44,0)
 .Q:PSBTYPE=""!(PSBTYPE="P")  ; No Pend this ver
"RTN","PSBODL",45,0)
 .S PSBSTAT=^TMP("PSJ",$J,PSBINDX,1)
"RTN","PSBODL",46,0)
 .I $P(PSBSTAT,U,7)["D"!($P(PSBSTAT,U,8)) Q
"RTN","PSBODL",47,0)
 .Q:PSBTYPE="U"&('$P(PSBRPT(.2),U,7))
"RTN","PSBODL",48,0)
 .Q:PSBTYPE="V"&('$P(PSBRPT(.2),U,6))
"RTN","PSBODL",49,0)
 .S PSBTYPE=$S(PSBTYPE="U":"UD-",PSBTYPE="V":"IV-",1:"**")
"RTN","PSBODL",50,0)
 .S Y=$P(PSBSTAT,U,2)
"RTN","PSBODL",51,0)
 .Q:Y="C"&('$P(PSBRPT(.2),U,1))
"RTN","PSBODL",52,0)
 .Q:Y="P"&('$P(PSBRPT(.2),U,2))
"RTN","PSBODL",53,0)
 .Q:Y="OC"&('$P(PSBRPT(.2),U,3))
"RTN","PSBODL",54,0)
 .Q:Y="O"&('$P(PSBRPT(.2),U,4))
"RTN","PSBODL",55,0)
 .S PSBSCHT=Y
"RTN","PSBODL",56,0)
 .S:PSBSCHT="" PSBSCHT="*"
"RTN","PSBODL",57,0)
 .S PSBMED=$P(^TMP("PSJ",$J,PSBINDX,3),U,2)
"RTN","PSBODL",58,0)
 .S PSBORD=$P(^TMP("PSJ",$J,PSBINDX,0),U,3)
"RTN","PSBODL",59,0)
 .S ^TMP("PSB",$J,"B",PSBTYPE,PSBSCHT,PSBMED,PSBORD)=""
"RTN","PSBODL",60,0)
 I '$D(^TMP("PSB",$J,"B")) W !!?10,"** NO SPECIFIED MEDICATIONS TO PRINT **" W !,$$BLANKS(),$$FTR() Q
"RTN","PSBODL",61,0)
 S PSBGBL=$NAME(^TMP("PSB",$J,"B")),PSBWFLAG=0
"RTN","PSBODL",62,0)
 F  S PSBGBL=$Q(@PSBGBL) Q:PSBGBL=""  Q:($QS(PSBGBL,1)'="PSB")!($QS(PSBGBL,2)'=$J)!($QS(PSBGBL,3)'="B")  D
"RTN","PSBODL",63,0)
 .K PSBORD
"RTN","PSBODL",64,0)
 .S PSBTYPE=$QS(PSBGBL,4)
"RTN","PSBODL",65,0)
 .S PSBSCHT=$QS(PSBGBL,5)
"RTN","PSBODL",66,0)
 .S PSBMED=$QS(PSBGBL,6)
"RTN","PSBODL",67,0)
 .S PSBORD=$QS(PSBGBL,7)
"RTN","PSBODL",68,0)
 .D CLEAN^PSBVT
"RTN","PSBODL",69,0)
 .D PSJ1^PSBVT(DFN,PSBORD)
"RTN","PSBODL",70,0)
 .D NOW^%DTC S PSBNOW=%
"RTN","PSBODL",71,0)
 .Q:PSBOSP<PSBOSTRT  ;
"RTN","PSBODL",72,0)
 .Q:(PSBOSP<PSBOSTRT!(PSBOST>PSBOSTOP))&(PSBSCHT'="O")
"RTN","PSBODL",73,0)
 .S X=$$GET^XPAR("DIV","PSB ADMIN BEFORE")
"RTN","PSBODL",74,0)
 .; strt DT > DL Stp DT + adm b
"RTN","PSBODL",75,0)
 .Q:PSBSCHT="O"&(PSBOST>$$FMADD^XLFDT(PSBOSTOP,"","",+X))
"RTN","PSBODL",76,0)
 .S (PSBYES,PSBODD,PSBDAYB,PSBSCBR)=0
"RTN","PSBODL",77,0)
 .S:$$PSBDCHK1^PSBVT1(PSBSCH) PSBYES=1,PSBDAYB=1
"RTN","PSBODL",78,0)
 .F I=1:1 Q:$P(PSBSCH,"-",I)=""  I $P(PSBSCH,"-",I)?2N!($P(PSBSCH,"-",I)?4N) S PSBYES=1,PSBSCBR=1
"RTN","PSBODL",79,0)
 .I PSBYES,PSBADST="",PSBSCHT'="O",PSBSCHT'="OC",PSBSCHT'="P" D  Q
"RTN","PSBODL",80,0)
 ..D ERROR^PSBMLU(PSBONX,PSBOITX,DFN,"Admin times required",PSBSCH)
"RTN","PSBODL",81,0)
 .I PSBSCHT="OC" S PSBYES=1
"RTN","PSBODL",82,0)
 .I PSBSCHT="P" S PSBYES=1
"RTN","PSBODL",83,0)
 .I "PCS"'[PSBIVT S PSBYES=1
"RTN","PSBODL",84,0)
 .I PSBIVT["S",PSBISYR'=1 S PSBYES=1
"RTN","PSBODL",85,0)
 .I PSBIVT["C",PSBCHEMT'="P",PSBISYR'=1 S PSBYES=1
"RTN","PSBODL",86,0)
 .I PSBIVT["C",PSBCHEMT="A" S PSBYES=1
"RTN","PSBODL",87,0)
 .I PSBFREQ="O" S PSBFREQ=1440
"RTN","PSBODL",88,0)
 .I PSBFREQ="D" S PSBFREQ=""
"RTN","PSBODL",89,0)
 .I PSBSCHT="P" S PSBFREQ=1440
"RTN","PSBODL",90,0)
 .I PSBSCHT="O" S PSBFREQ=1440
"RTN","PSBODL",91,0)
 .I 'PSBYES,PSBFREQ<1 D  Q
"RTN","PSBODL",92,0)
 ..D ERROR^PSBMLU(PSBONX,PSBOITX,DFN,"Invalid frequency received from order",PSBSCH)
"RTN","PSBODL",93,0)
 .S PSBVALB=$$IVPTAB^PSBVDLU3(PSBOTYP,PSBIVT,PSBISYR,PSBCHEMT,PSBMRAB)
"RTN","PSBODL",94,0)
 .I 'PSBDAYB,'PSBSCBR,PSBSCHT="C",PSBVALB="1",PSBADST'="",PSBFREQ<1 D  Q   ;B
"RTN","PSBODL",95,0)
 ..D ERROR^PSBMLU(PSBONX,PSBOITX,DFN,"Invalid frequency received from order",PSBSCH)
"RTN","PSBODL",96,0)
 .I +PSBFREQ>0 I (PSBFREQ#1440'=0),(1440#PSBFREQ'=0) S PSBODD=1
"RTN","PSBODL",97,0)
 .I PSBODD,PSBADST'="" D  Q
"RTN","PSBODL",98,0)
 ..D ERROR^PSBMLU(PSBONX,PSBOITX,DFN,"Administration Times on ODD SCHEDULE",PSBSCH)
"RTN","PSBODL",99,0)
 .I PSBADST'="" D
"RTN","PSBODL",100,0)
 ..F PSBY=1:1:$L(PSBADST,"-")  D
"RTN","PSBODL",101,0)
 ...;Inv ADM
"RTN","PSBODL",102,0)
 ...D:($P(PSBADST,"-",PSBY)'?2N)&($P(PSBADST,"-",PSBY)'?4N)
"RTN","PSBODL",103,0)
 ....D ERROR^PSBMLU(PSBONX,PSBOITX,DFN,"Invalid Admin times",PSBSCH)
"RTN","PSBODL",104,0)
 .I PSBSCHT="C",PSBOTYP="U" Q:'$$OKAY^PSBVDLU1(PSBOST,PSBODATE,PSBSCH,PSBONX,PSBOITX,PSBFREQ,)
"RTN","PSBODL",105,0)
 .I PSBSCHT="C",$$IVPTAB^PSBVDLU3(PSBOTYP,PSBIVT,PSBISYR,PSBCHEMT,PSBMR),'$$OKAY^PSBVDLU1(PSBOST,PSBODATE,PSBSCH,PSBONX,PSBOITX,PSBFREQ) Q
"RTN","PSBODL",106,0)
 .I PSBSCHT="O" D  Q:PSBGVN
"RTN","PSBODL",107,0)
 ..S (PSBGVN,X,Y)=""
"RTN","PSBODL",108,0)
 ..F  S X=$O(^PSB(53.79,"AOIP",DFN,PSBOIT,X),-1) Q:'X  D
"RTN","PSBODL",109,0)
 ...F  S Y=$O(^PSB(53.79,"AOIP",DFN,PSBOIT,X,Y),-1) Q:'Y  D
"RTN","PSBODL",110,0)
 ....I $P(^PSB(53.79,Y,.1),U)=PSBONX,$P(^PSB(53.79,Y,0),U,9)="G" S PSBGVN=1,(X,Y)=0
"RTN","PSBODL",111,0)
 .S PSBRMN=1
"RTN","PSBODL",112,0)
 .I PSBSCHT="O",PSBOST'=PSBOSP,PSBOSP<PSBOSTRT S PSBRMN=0
"RTN","PSBODL",113,0)
 .Q:'PSBRMN
"RTN","PSBODL",114,0)
 .I PSBSCHT="OC" D  Q:PSBGVN&('$$GET^XPAR("DIV","PSB ADMIN MULTIPLE ONCALL"))
"RTN","PSBODL",115,0)
 ..S (PSBGVN,X,Y)=""
"RTN","PSBODL",116,0)
 ..F  S X=$O(^PSB(53.79,"AOIP",DFN,PSBOIT,X),-1) Q:'X  D
"RTN","PSBODL",117,0)
 ...F  S Y=$O(^PSB(53.79,"AOIP",DFN,PSBOIT,X,Y),-1) Q:'Y  D
"RTN","PSBODL",118,0)
 ....I $P(^PSB(53.79,Y,.1),U)=PSBONX,$P(^PSB(53.79,Y,0),U,9)="G" S PSBGVN=1,(X,Y)=0
"RTN","PSBODL",119,0)
 .S PSBLGDT="",X=""
"RTN","PSBODL",120,0)
 .F  S X=$O(^PSB(53.79,"AOIP",DFN,+PSBOIT,X),-1) Q:'X  D  Q:PSBLGDT
"RTN","PSBODL",121,0)
 ..S PSBIEN=""
"RTN","PSBODL",122,0)
 ..F  S PSBIEN=$O(^PSB(53.79,"AOIP",DFN,+PSBOIT,X,PSBIEN),-1) Q:PSBIEN=""  D  Q:PSBLGDT
"RTN","PSBODL",123,0)
 ...S:$P($G(^PSB(53.79,PSBIEN,0)),U,9)="G" PSBLGDT=X
"RTN","PSBODL",124,0)
 .S PSBADMIN="" K ^TMP("PSB",$J,"GETADMIN")
"RTN","PSBODL",125,0)
 .I PSBSCHT="C" D  Q:PSBADMIN=""
"RTN","PSBODL",126,0)
 ..S PSBX=PSBADST,PSBFLAG=1
"RTN","PSBODL",127,0)
 ..D:PSBX=""
"RTN","PSBODL",128,0)
 ...I PSBIVT="C",PSBCHEMT="A" S PSBX="0000",PSBFLAG=0
"RTN","PSBODL",129,0)
 ...I PSBIVT="C",PSBISYR=0 S PSBX="0000",PSBFLAG=0
"RTN","PSBODL",130,0)
 ...I PSBIVT="S",PSBISYR'=1 S PSBX="0000",PSBFLAG=0
"RTN","PSBODL",131,0)
 ...I "HA"[PSBIVT S PSBX="0000",PSBFLAG=0
"RTN","PSBODL",132,0)
 ..I ((PSBIVT="S")!(PSBIVT="C")),(PSBISYR=1) S:+($G(PSBX))=0 PSBX=""
"RTN","PSBODL",133,0)
 ..I (PSBIVT="C"),(PSBCHEMT="P") S:+($G(PSBX))=0 PSBX=""
"RTN","PSBODL",134,0)
 ..I PSBOTYP="U",PSBX="0000" S PSBX=""
"RTN","PSBODL",135,0)
 ..I PSBIVT="P" S:+($G(PSBX))=0 PSBX=""
"RTN","PSBODL",136,0)
 ..I PSBX="" D
"RTN","PSBODL",137,0)
 ...S:($G(PSBFREQ)>29)!(PSBFREQ="D") PSBX=$$GETADMIN^PSBVDLU1(DFN,PSBONX,PSBOST,PSBFREQ,PSBEVDT)
"RTN","PSBODL",138,0)
 ..E  S ^TMP("PSB",$J,"GETADMIN",0)=PSBX
"RTN","PSBODL",139,0)
 ..D:PSBX'=""
"RTN","PSBODL",140,0)
 ...F PSBXX=0:1 Q:'$D(^TMP("PSB",$J,"GETADMIN",PSBXX))  S PSBX=$G(^TMP("PSB",$J,"GETADMIN",PSBXX)) D
"RTN","PSBODL",141,0)
 ....F PSBY=1:1:$L(PSBX,"-")  D
"RTN","PSBODL",142,0)
 .....S PSBAT=+(PSBODATE_"."_$P(PSBX,"-",PSBY))
"RTN","PSBODL",143,0)
 .....I PSBFLAG Q:PSBAT<PSBOSTRT!(PSBAT>PSBOSTOP)
"RTN","PSBODL",144,0)
 .....D VAL^PSBMLVAL(.PSBZ,DFN,PSBON,PSBOTYP,PSBAT)
"RTN","PSBODL",145,0)
 .....S:(+PSBZ(0)<0)&(PSBCNT=1) ^TMP("PSBO",$J,DFN,PSBORD,PSBTYPE,PSBAT)=""
"RTN","PSBODL",146,0)
 .....Q:+PSBZ(0)<0
"RTN","PSBODL",147,0)
 .....S:$G(PSBOST)'>$G(PSBAT) PSBADMIN=PSBADMIN_$S(PSBADMIN]"":"-",1:"")_$P(PSBX,"-",PSBY)
"RTN","PSBODL",148,0)
 ..I +$G(PSBFREQ)>0,$G(PSBFREQ)<30,PSBADMIN'="0000" S PSBADMIN="Due every "_$G(PSBFREQ)_" minutes."
"RTN","PSBODL",149,0)
 .D:$Y>(IOSL-(12+($L(PSBADMIN)/27)))
"RTN","PSBODL",150,0)
 ..W !?(IOM-36\2),"(Medications Continued on Next Page)"
"RTN","PSBODL",151,0)
 ..W $$FTR()
"RTN","PSBODL",152,0)
 ..W $$HDR()
"RTN","PSBODL",153,0)
 .I PSBSM S PSBSM=$S(PSBSMX:"H",1:"")_"SM"
"RTN","PSBODL",154,0)
 .E  S PSBSM=""
"RTN","PSBODL",155,0)
 .W !,$J(PSBSM,3),?6,PSBTYPE,$E(PSBSCHT,1,4),?12 S PSBWFLAG=1
"RTN","PSBODL",156,0)
 .S X="",Y=0
"RTN","PSBODL",157,0)
 .W $$WRAP(14,34,PSBMED)
"RTN","PSBODL",158,0)
 .S PSBADM="Give: "_PSBDOSE_"  "_PSBSCH
"RTN","PSBODL",159,0)
 .W $$WRAP(50,27,PSBADM)
"RTN","PSBODL",160,0)
 .W ?78,PSBMRAB
"RTN","PSBODL",161,0)
 .W ?85 D:PSBLGDT
"RTN","PSBODL",162,0)
 ..W $E(PSBLGDT,4,5),"/",$E(PSBLGDT,6,7),"/",$E(PSBLGDT,2,3)
"RTN","PSBODL",163,0)
 ..W "@",$E($P(PSBLGDT,".",2)_"0000",1,4)
"RTN","PSBODL",164,0)
 .W ?100,$P($TR($$FMTE^XLFDT(PSBOST,2),"@"," ")," ")
"RTN","PSBODL",165,0)
 .W ?110,$P($TR($$FMTE^XLFDT(PSBOSP,2),"@"," ")," ")
"RTN","PSBODL",166,0)
 .W ?120
"RTN","PSBODL",167,0)
 .W $S(PSBVPHI]"":PSBVPHI,1:"***"),"/"
"RTN","PSBODL",168,0)
 .W $S(PSBVNI]"":PSBVNI,1:"***")
"RTN","PSBODL",169,0)
 .W !,?100,"@"_$P(PSBOSTX,"  ",2)
"RTN","PSBODL",170,0)
 .W ?110,"@"_$P(PSBOSPX,"  ",2)
"RTN","PSBODL",171,0)
 .W IOINHI
"RTN","PSBODL",172,0)
 .I $D(PSBDDA) S Y=0 F  S Y=$O(PSBDDA(Y)) Q:'Y  D
"RTN","PSBODL",173,0)
 ..Q:$P(PSBDDA(Y),U,5)&($P(PSBDDA(Y),U,5)<PSBNOW)
"RTN","PSBODL",174,0)
 ..W !?14,"*"
"RTN","PSBODL",175,0)
 ..W $$WRAP(15,33,$P(PSBDDA(Y),U,3)_" ("_+$P(PSBDDA(Y),U,2)_")")
"RTN","PSBODL",176,0)
 .I $D(PSBADA) S Y=0 F  S Y=$O(PSBADA(Y)) Q:'Y  D
"RTN","PSBODL",177,0)
 ..W !?14,"*"
"RTN","PSBODL",178,0)
 ..W $$WRAP(15,33,$P(PSBADA(Y),U,3)_" ("_$P(PSBADA(Y),U,4)_")")
"RTN","PSBODL",179,0)
 .I $D(PSBSOLA) S Y=0 F  S Y=$O(PSBSOLA(Y)) Q:'Y  D
"RTN","PSBODL",180,0)
 ..W !?14,"*"
"RTN","PSBODL",181,0)
 ..W $$WRAP(15,33,$P(PSBSOLA(Y),U,3)_" ("_$P(PSBSOLA(Y),U,4)_")")
"RTN","PSBODL",182,0)
 .W IOINORM ; Hlight Off
"RTN","PSBODL",183,0)
 .S PSBADM=$S(PSBADMIN]"":"Admin Times: "_PSBADMIN,1:"")
"RTN","PSBODL",184,0)
 .W:PSBADM]"" $$WRAP(50,27,PSBADM)
"RTN","PSBODL",185,0)
 .S X=$S(PSBOTXT]"":PSBOTXT,1:"<None Entered>")
"RTN","PSBODL",186,0)
 .W $$WRAP(14,34,"Spec Inst: "_X)
"RTN","PSBODL",187,0)
 .W !,$TR($J("",IOM)," ","-")
"RTN","PSBODL",188,0)
 I '$G(PSBWFLAG) W !!,?10,"** NO SPECIFIED MEDICATIONS TO PRINT **"
"RTN","PSBODL",189,0)
 W $$BLANKS(),$$FTR()
"RTN","PSBODL",190,0)
 S PSBORD=$O(^TMP("PSBO",$J,DFN,""),-1)
"RTN","PSBODL",191,0)
 I $P(PSBRPT(.4),U,1),$D(^TMP("PSBO",$J,DFN,PSBORD,PSBTYPE)) D EN^PSBODL1
"RTN","PSBODL",192,0)
 Q
"RTN","PSBODL",193,0)
 ;
"RTN","PSBODL",194,0)
WRAP(X,Y,Z) ;
"RTN","PSBODL",195,0)
 F  Q:'$L(Z)  D
"RTN","PSBODL",196,0)
 .W:$X>X !
"RTN","PSBODL",197,0)
 .W:$X<X ?X
"RTN","PSBODL",198,0)
 .I $L(Z)<Y W Z S Z="" Q
"RTN","PSBODL",199,0)
 .F PSB=Y:-1:0 Q:$E(Z,PSB)=" "
"RTN","PSBODL",200,0)
 .S:PSB<1 PSB=Y
"RTN","PSBODL",201,0)
 .W $E(Z,1,PSB)
"RTN","PSBODL",202,0)
 .S Z=$E(Z,PSB+1,255)
"RTN","PSBODL",203,0)
 Q ""
"RTN","PSBODL",204,0)
 ;
"RTN","PSBODL",205,0)
FTR() ;
"RTN","PSBODL",206,0)
 I (IOSL<100) F  Q:$Y>(IOSL-10)  W !
"RTN","PSBODL",207,0)
 W !,$TR($J("",IOM)," ","=")
"RTN","PSBODL",208,0)
 S X="Ward: "_PSBHDR("WARD")_"  Room-Bed: "_PSBHDR("ROOM")
"RTN","PSBODL",209,0)
 W !,PSBHDR("NAME"),?(IOM-11\2),PSBHDR("SSN"),?(IOM-$L(X)),X
"RTN","PSBODL",210,0)
 Q ""
"RTN","PSBODL",211,0)
 ;
"RTN","PSBODL",212,0)
HDR() ;
"RTN","PSBODL",213,0)
 D PT^PSBOHDR(DFN,.PSBHDR)
"RTN","PSBODL",214,0)
 W !,"Self",?85,"Last",?100,"Start",?110,"Stop",?120,"Verifying"
"RTN","PSBODL",215,0)
 W !,"Med",?6,"Sched",?14,"Medication",?50,"Dose",?78,"Route",?85,"Given",?100,"Date",?110,"Date",?120,"Rph/Rn"
"RTN","PSBODL",216,0)
 W !,?100,"@Time",?110,"@Time"
"RTN","PSBODL",217,0)
 W !,$TR($J("",IOM)," ","-")
"RTN","PSBODL",218,0)
 Q ""
"RTN","PSBODL",219,0)
 ;
"RTN","PSBODL",220,0)
BLANKS() ;
"RTN","PSBODL",221,0)
 Q:'$P(PSBRPT(.2),U,5) ""
"RTN","PSBODL",222,0)
 W !
"RTN","PSBODL",223,0)
 D:$Y>(IOSL-26)
"RTN","PSBODL",224,0)
 .W ?(IOM-42\2),"(Changes/Addendums to Orders on Next Page)"
"RTN","PSBODL",225,0)
 .W $$FTR(),$$HDR() ; New page - no room for blanks
"RTN","PSBODL",226,0)
 I IOSL<100 F  Q:$Y>(IOSL-26)  W !
"RTN","PSBODL",227,0)
 W ?(IOM-28\2),"Changes/Addendums to orders"
"RTN","PSBODL",228,0)
 F X=1:1:4 D
"RTN","PSBODL",229,0)
 .W !,$TR($J("",IOM)," ","-")
"RTN","PSBODL",230,0)
 .W !!?3,"CON ___ PRN ___"
"RTN","PSBODL",231,0)
 .W ?20,"Drug: ",$TR($J("",22)," ","_")
"RTN","PSBODL",232,0)
 .W ?50,"Give: ",$TR($J("",42)," ","_")
"RTN","PSBODL",233,0)
 .W ?100,"Start: _________ Stop: _________"
"RTN","PSBODL",234,0)
 .W !?20,"Spec"
"RTN","PSBODL",235,0)
 .W !?3,"OT  ___ OC  ___"
"RTN","PSBODL",236,0)
 .W ?20,"Inst: ",$TR($J("",72)," ","_")
"RTN","PSBODL",237,0)
 .W ?100,"Initials: ______ Date: _________"
"RTN","PSBODL",238,0)
 W !,$TR($J("",IOM)," ","-")
"RTN","PSBODL",239,0)
 Q ""
"RTN","PSBODL",240,0)
 ;
"RTN","PSBODL1")
0^19^B23809238
"RTN","PSBODL1",1,0)
PSBODL1 ;BIRMINGHAM/VRN-DUE LIST ;Mar 2004
"RTN","PSBODL1",2,0)
 ;;3.0;BAR CODE MED ADMIN;;Mar 2004 
"RTN","PSBODL1",3,0)
 ;
"RTN","PSBODL1",4,0)
 ; Reference/IA
"RTN","PSBODL1",5,0)
EN ;
"RTN","PSBODL1",6,0)
 W $$HDR()
"RTN","PSBODL1",7,0)
 S PSBORD=0 F  S PSBORD=$O(^TMP("PSBO",$J,DFN,PSBORD)) Q:PSBORD=""  D
"RTN","PSBODL1",8,0)
 .D CLEAN^PSBVT
"RTN","PSBODL1",9,0)
 .D PSJ1^PSBVT(DFN,PSBORD)
"RTN","PSBODL1",10,0)
 .I PSBSCHT="C" D  Q:PSBADMIN=""
"RTN","PSBODL1",11,0)
 ..S PSBX=PSBADST,PSBFLAG=1
"RTN","PSBODL1",12,0)
 ..I PSBX="",PSBONX["V",PSBIVT'="P" S PSBFLAG=0
"RTN","PSBODL1",13,0)
 ..S (PSBYES,PSBODD)=0
"RTN","PSBODL1",14,0)
 ..S:$$PSBDCHK1^PSBVT1(PSBSCH) PSBYES=1
"RTN","PSBODL1",15,0)
 ..F I=1:1 Q:$P(PSBSCH,"-",I)=""  I $P(PSBSCH,"-",I)?2N!($P(PSBSCH,"-",I)?4N) S PSBYES=1
"RTN","PSBODL1",16,0)
 ..I PSBYES,PSBADST="",PSBSCHT'="O",PSBSCHT'="OC",PSBSCHT'="P"  Q
"RTN","PSBODL1",17,0)
 ..I PSBFREQ="O" S PSBFREQ=1440
"RTN","PSBODL1",18,0)
 ..I 'PSBYES,PSBADST="",PSBFREQ<1 Q
"RTN","PSBODL1",19,0)
 ..I +PSBFREQ>0 I (PSBFREQ#1440'=0),(1440#PSBFREQ'=0) S PSBODD=1
"RTN","PSBODL1",20,0)
 ..I PSBODD,PSBADST'="" Q
"RTN","PSBODL1",21,0)
 ..D:PSBX=""
"RTN","PSBODL1",22,0)
 ...I PSBIVT="C",PSBCHEMT="A" S PSBX="0000",PSBFLAG=0
"RTN","PSBODL1",23,0)
 ...I PSBIVT="C",PSBISYR=0 S PSBX="0000",PSBFLAG=0
"RTN","PSBODL1",24,0)
 ...I PSBIVT="S",PSBISYR=0 S PSBX="0000",PSBFLAG=0
"RTN","PSBODL1",25,0)
 ...I "HA"[PSBIVT S PSBX="0000",PSBFLAG=0
"RTN","PSBODL1",26,0)
 ..I ("SC"[PSBIVT),(PSBISYR=1) S PSBX=""
"RTN","PSBODL1",27,0)
 ..I (PSBIVT="C"),(PSBCHEMT="P") S PSBX=""
"RTN","PSBODL1",28,0)
 ..I PSBOTYP="U",PSBX="0000" S PSBX=""
"RTN","PSBODL1",29,0)
 ..I PSBIVT="P",$G(PSBX)=0 S PSBX=""
"RTN","PSBODL1",30,0)
 ..I PSBX="" S PSBX=$$GETADMIN^PSBVDLU1(DFN,PSBONX,PSBOST,PSBFREQ,PSBEVDT)
"RTN","PSBODL1",31,0)
 ..E  K ^TMP("PSB",$J,"GETADMIN") S ^TMP("PSB",$J,"GETADMIN",0)=PSBX
"RTN","PSBODL1",32,0)
 ..S PSBADMIN=""
"RTN","PSBODL1",33,0)
 ..F PSBXX=0:1 Q:'$D(^TMP("PSB",$J,"GETADMIN",PSBXX))  S PSBX=$G(^TMP("PSB",$J,"GETADMIN",PSBXX)) D
"RTN","PSBODL1",34,0)
 ...F PSBY=1:1:$L(PSBX,"-")  D
"RTN","PSBODL1",35,0)
 ....Q:($P(PSBX,"-",PSBY)'?2N)&($P(PSBX,"-",PSBY)'?4N)
"RTN","PSBODL1",36,0)
 ....S PSBAT=+(PSBODATE_"."_$P(PSBX,"-",PSBY))
"RTN","PSBODL1",37,0)
 ....I PSBFLAG Q:PSBAT<PSBOSTRT!(PSBAT>PSBOSTOP)  ; Report Window
"RTN","PSBODL1",38,0)
 ....D VAL^PSBMLVAL(.PSBZ,DFN,PSBONX,PSBTYPE,PSBAT)
"RTN","PSBODL1",39,0)
 ....S:$G(PSBFREQ)>29 PSBADMIN=PSBADMIN_$S(PSBADMIN]"":"-",1:"")_$P(PSBX,"-",PSBY)
"RTN","PSBODL1",40,0)
 ....S:$G(PSBFREQ)<30 PSBADMIN="Due every "_$G(PSBFREQ)_" minutes."
"RTN","PSBODL1",41,0)
 .I $Y>(IOSL-12) W !?(IOM-36\2),"(Medications Continued on Next Page)",$$FTR(),$$HDR()
"RTN","PSBODL1",42,0)
 .I PSBSM S PSBSM=$S(PSBSMX:"H",1:"")_"SM"
"RTN","PSBODL1",43,0)
 .E  S PSBSM=""
"RTN","PSBODL1",44,0)
 .W !,$J(PSBSM,3),?6,PSBTYPE,$E(PSBSCHT,1,4),?12 S PSBWFLAG=1
"RTN","PSBODL1",45,0)
 .S X="",Y=0
"RTN","PSBODL1",46,0)
 .W $$WRAP(14,34,PSBOITX)
"RTN","PSBODL1",47,0)
 .S PSBADM="Give: "_PSBDOSE_"  "_PSBSCH
"RTN","PSBODL1",48,0)
 .W $$WRAP(50,27,PSBADM)
"RTN","PSBODL1",49,0)
 .W ?78,PSBMRAB
"RTN","PSBODL1",50,0)
 .W ?85 I PSBLGDT W $E(PSBLGDT,4,5),"/",$E(PSBLGDT,6,7),"/",$E(PSBLGDT,2,3) W "@",$E($P(PSBLGDT,".",2)_"0000",1,4)
"RTN","PSBODL1",51,0)
 .W ?100,$P($TR($$FMTE^XLFDT(PSBOST,2),"@"," ")," ")
"RTN","PSBODL1",52,0)
 .W ?110,$P($TR($$FMTE^XLFDT(PSBOSP,2),"@"," ")," ")
"RTN","PSBODL1",53,0)
 .W ?120,$S(PSBVPHI]"":PSBVPHI,1:"***"),"/",$S(PSBVNI]"":PSBVNI,1:"***")
"RTN","PSBODL1",54,0)
 .W !,?100,"@"_$P(PSBOSTX,"  ",2),?110,"@"_$P(PSBOSPX,"  ",2)
"RTN","PSBODL1",55,0)
 .W IOINHI  ; To Highlight the Dispense Drugs...
"RTN","PSBODL1",56,0)
 .I $D(PSBDDA) S Y=0 F  S Y=$O(PSBDDA(Y)) Q:'Y  D
"RTN","PSBODL1",57,0)
 ..Q:$P(PSBDDA(Y),U,5)&($P(PSBDDA(Y),U,5)<PSBNOW)
"RTN","PSBODL1",58,0)
 ..W !?14,"*",$$WRAP(15,33,$P(PSBDDA(Y),U,3)_" ("_+$P(PSBDDA(Y),U,2)_")")
"RTN","PSBODL1",59,0)
 .I $D(PSBADA) S Y=0 F  S Y=$O(PSBADA(Y)) Q:'Y  W !?14,"*",$$WRAP(15,33,$P(PSBADA(Y),U,3)_" ("_$P(PSBADA(Y),U,4)_")")
"RTN","PSBODL1",60,0)
 .I $D(PSBSOLA) S Y=0 F  S Y=$O(PSBSOLA(Y)) Q:'Y  W !?14,"*",$$WRAP(15,33,$P(PSBSOLA(Y),U,3)_" ("_$P(PSBSOLA(Y),U,4)_")")
"RTN","PSBODL1",61,0)
 .W IOINORM ; Highlight Off
"RTN","PSBODL1",62,0)
 .S PSBADM=$S(PSBADMIN]"":"Admin Times: "_PSBADMIN,1:"")
"RTN","PSBODL1",63,0)
 .W:PSBADM]"" $$WRAP(50,27,PSBADM)
"RTN","PSBODL1",64,0)
 .S X=$S(PSBOTXT]"":PSBOTXT,1:"<None Entered>")
"RTN","PSBODL1",65,0)
 .W $$WRAP(14,34,"Spec Inst: "_X),!,$TR($J("",IOM)," ","-")
"RTN","PSBODL1",66,0)
 I '$G(PSBWFLAG) W !!,?10,"** NO SPECIFIED MEDICATIONS TO PRINT **"
"RTN","PSBODL1",67,0)
 W $$BLANKS(),$$FTR()
"RTN","PSBODL1",68,0)
 Q
"RTN","PSBODL1",69,0)
 ;
"RTN","PSBODL1",70,0)
WRAP(X,Y,Z) ; Quick text wrap
"RTN","PSBODL1",71,0)
 F  Q:'$L(Z)  D
"RTN","PSBODL1",72,0)
 .W:$X>X !
"RTN","PSBODL1",73,0)
 .W:$X<X ?X
"RTN","PSBODL1",74,0)
 .I $L(Z)<Y W Z S Z="" Q
"RTN","PSBODL1",75,0)
 .F PSB=Y:-1:0 Q:$E(Z,PSB)=" "
"RTN","PSBODL1",76,0)
 .S:PSB<1 PSB=Y
"RTN","PSBODL1",77,0)
 .W $E(Z,1,PSB)
"RTN","PSBODL1",78,0)
 .S Z=$E(Z,PSB+1,250)
"RTN","PSBODL1",79,0)
 Q ""
"RTN","PSBODL1",80,0)
 ;
"RTN","PSBODL1",81,0)
FTR() ; [Extrinsic] Page footer
"RTN","PSBODL1",82,0)
 ;
"RTN","PSBODL1",83,0)
 ; Sub Module Description:
"RTN","PSBODL1",84,0)
 ; (No Description Available)
"RTN","PSBODL1",85,0)
 ;
"RTN","PSBODL1",86,0)
 I (IOSL<100) F  Q:$Y>(IOSL-10)  W !
"RTN","PSBODL1",87,0)
 W !,$TR($J("",IOM)," ","=")
"RTN","PSBODL1",88,0)
 S X="Ward: "_PSBHDR("WARD")_"  Room-Bed: "_PSBHDR("ROOM")
"RTN","PSBODL1",89,0)
 W !,PSBHDR("NAME"),?(IOM-11\2),PSBHDR("SSN"),?(IOM-$L(X)),X
"RTN","PSBODL1",90,0)
 Q ""
"RTN","PSBODL1",91,0)
 ;
"RTN","PSBODL1",92,0)
HDR() ; Page Header
"RTN","PSBODL1",93,0)
 D PT^PSBOHDR(DFN,.PSBHDR)
"RTN","PSBODL1",94,0)
 W !
"RTN","PSBODL1",95,0)
 W !
"RTN","PSBODL1",96,0)
 W !,?(IOM-28\2),"*****   FUTURE ORDERS   *****"
"RTN","PSBODL1",97,0)
 W !
"RTN","PSBODL1",98,0)
 W !,"Self",?85,"Last",?100,"Start",?110,"Stop",?120,"Verifying"
"RTN","PSBODL1",99,0)
 W !,"Med",?6,"Sched",?14,"Medication",?50,"Dose",?78,"Route",?85,"Given",?100,"Date",?110,"Date",?120,"Rph/Rn"
"RTN","PSBODL1",100,0)
 W !,?100,"@Time",?110,"@Time"
"RTN","PSBODL1",101,0)
 W !,$TR($J("",IOM)," ","-")
"RTN","PSBODL1",102,0)
 Q ""
"RTN","PSBODL1",103,0)
 ;
"RTN","PSBODL1",104,0)
BLANKS() ; [Extrinsic] Print blanks at end of printout for changes
"RTN","PSBODL1",105,0)
 Q:'$P(PSBRPT(.2),U,5) ""
"RTN","PSBODL1",106,0)
 W !
"RTN","PSBODL1",107,0)
 I $Y>(IOSL-26) W ?(IOM-42\2),"(Changes/Addendums to Orders on Next Page)" W $$FTR(),$$HDR() ; Not enough space - new page
"RTN","PSBODL1",108,0)
 I IOSL<100 F  Q:$Y>(IOSL-26)  W !
"RTN","PSBODL1",109,0)
 W ?(IOM-28\2),"Changes/Addendums to orders"
"RTN","PSBODL1",110,0)
 F X=1:1:4 D
"RTN","PSBODL1",111,0)
 .W !,$TR($J("",IOM)," ","-")
"RTN","PSBODL1",112,0)
 .W !!?3,"CON ___ PRN ___",?20,"Drug: ",$TR($J("",22)," ","_"),?50,"Give: ",$TR($J("",42)," ","_"),?100,"Start: _________ Stop: _________"
"RTN","PSBODL1",113,0)
 .W !?20,"Spec"
"RTN","PSBODL1",114,0)
 .W !?3,"OT  ___ OC  ___",?20,"Inst: ",$TR($J("",72)," ","_"),?100,"Initials: ______ Date: _________"
"RTN","PSBODL1",115,0)
 W !,$TR($J("",IOM)," ","-")
"RTN","PSBODL1",116,0)
 Q ""
"RTN","PSBODL1",117,0)
 ;
"RTN","PSBODO")
0^20^B8273378
"RTN","PSBODO",1,0)
PSBODO ;BIRMINGHAM/EFC-BCMA UNIT DOSE VIRTUAL DUE LIST FUNCTIONS ;Mar 2004
"RTN","PSBODO",2,0)
 ;;3.0;BAR CODE MED ADMIN;;Mar 2004
"RTN","PSBODO",3,0)
 ;
"RTN","PSBODO",4,0)
 ; Reference/IA
"RTN","PSBODO",5,0)
 ; EN^PSJBCMA2/2830
"RTN","PSBODO",6,0)
EN ;
"RTN","PSBODO",7,0)
 ;
"RTN","PSBODO",8,0)
 ; Description:
"RTN","PSBODO",9,0)
 ; Returns a display for a selected order when double clicked on the VDL
"RTN","PSBODO",10,0)
 ;
"RTN","PSBODO",11,0)
 N PSBGBL,DFN
"RTN","PSBODO",12,0)
 S PSBGBL=$NAME(^TMP("PSBO",$J,"B"))
"RTN","PSBODO",13,0)
 F  S PSBGBL=$Q(@PSBGBL) Q:PSBGBL=""  Q:$QS(PSBGBL,2)'=$J  Q:$QS(PSBGBL,1)'["PSBO"  D
"RTN","PSBODO",14,0)
 .S DFN=$QS(PSBGBL,5)
"RTN","PSBODO",15,0)
 .D DISPORD
"RTN","PSBODO",16,0)
 Q
"RTN","PSBODO",17,0)
 ;
"RTN","PSBODO",18,0)
DISPORD ;
"RTN","PSBODO",19,0)
 N PSBGBL,PSBOI
"RTN","PSBODO",20,0)
 S PSBOI=$$GET1^DIQ(53.69,PSBRPT_",",.09)
"RTN","PSBODO",21,0)
 D EN^PSJBCMA2(DFN,PSBOI)
"RTN","PSBODO",22,0)
 M PSBOACTL=^TMP("PSJ",$J) K ^TMP("PSJ",$J)
"RTN","PSBODO",23,0)
 D CLEAN^PSBVT
"RTN","PSBODO",24,0)
 D PSJ1^PSBVT(DFN,PSBOI)
"RTN","PSBODO",25,0)
 I '$G(PSBONX) W !,"Invalid Order"
"RTN","PSBODO",26,0)
 D:$G(PSBONX)
"RTN","PSBODO",27,0)
 .W !,"Orderable Item: ",PSBOITX
"RTN","PSBODO",28,0)
 .I PSBONX["V" W !,"Infusion Rate:  ",PSBIFR
"RTN","PSBODO",29,0)
 .I PSBONX'["V" W !,"Dosage Ordered: ",PSBDOSE
"RTN","PSBODO",30,0)
 .W ?40,"Start:    ",PSBOSTX
"RTN","PSBODO",31,0)
 .W !,"Med Route:      ",PSBMRAB
"RTN","PSBODO",32,0)
 .W ?40,"Stop:     ",PSBOSPX
"RTN","PSBODO",33,0)
 .W !,"Schedule Type:  ",PSBSCHTX
"RTN","PSBODO",34,0)
 .I PSBONX'["V" W ?40,"Self Med: ",PSBSMX
"RTN","PSBODO",35,0)
 .W:PSBSM !?40,"Hosp Sup: ",PSBSMX
"RTN","PSBODO",36,0)
 .W:PSBSCH'="" !,"Schedule: ",PSBSCH
"RTN","PSBODO",37,0)
 .I PSBONX'["V" W !,"Admin Times:    ",PSBADST
"RTN","PSBODO",38,0)
 .I PSBONX["V",((PSBIVT="P")!(PSBISYR=1)) W !,"Admin Times:    ",PSBADST
"RTN","PSBODO",39,0)
 .W !,"Provider: ",PSBMDX
"RTN","PSBODO",40,0)
 .W !,"Spec Inst:      ",PSBOTXT
"RTN","PSBODO",41,0)
 .W !
"RTN","PSBODO",42,0)
 .I $D(PSBDDA(1)) D
"RTN","PSBODO",43,0)
 ..W !,"Dispense Drugs",!,"Drug Name",?40,"Units",?50,"Inactive Date"
"RTN","PSBODO",44,0)
 ..W !,$TR($J("",75)," ","-")
"RTN","PSBODO",45,0)
 ..F Y=0:0 S Y=$O(PSBDDA(Y)) Q:'Y  D
"RTN","PSBODO",46,0)
 ...S X=$P(PSBDDA(Y),U,4)
"RTN","PSBODO",47,0)
 ...W !,$P(PSBDDA(Y),U,3),?40,$S(X]"":X,1:1)
"RTN","PSBODO",48,0)
 ...S X=$P(PSBDDA(Y),U,5) Q:'X
"RTN","PSBODO",49,0)
 ...W ?50,$E(X,4,5),"/",$E(X,6,7),"/",(1700+$E(X,1,3))
"RTN","PSBODO",50,0)
 .I $D(PSBADA(1)) D
"RTN","PSBODO",51,0)
 ..W !!,"Additives",!,"Name",?40,"Strength"
"RTN","PSBODO",52,0)
 ..W !,$TR($J("",75)," ","-")
"RTN","PSBODO",53,0)
 ..F Y=0:0 S Y=$O(PSBADA(Y)) Q:'Y  D
"RTN","PSBODO",54,0)
 ...W !,$P(PSBADA(Y),U,3),?40,$P(PSBADA(Y),U,4)
"RTN","PSBODO",55,0)
 .I $D(PSBSOLA(1)) D
"RTN","PSBODO",56,0)
 ..W !!,"Solution",!,"Name",?40,"Volume"
"RTN","PSBODO",57,0)
 ..W !,$TR($J("",75)," ","-")
"RTN","PSBODO",58,0)
 ..F Y=0:0 S Y=$O(PSBSOLA(Y)) Q:'Y  D
"RTN","PSBODO",59,0)
 ...W !,$P(PSBSOLA(Y),U,3),?40,$P(PSBSOLA(Y),U,4)
"RTN","PSBODO",60,0)
 .I $P(PSBOACTL(0),U,1)'=-1 D
"RTN","PSBODO",61,0)
 ..W !,$TR($J("",75)," ","-")
"RTN","PSBODO",62,0)
 ..W !,"Pharmacy Activity Log: "
"RTN","PSBODO",63,0)
 ..F I=1:1:$P(PSBOACTL(0),U,4) D
"RTN","PSBODO",64,0)
 ...W !?9,"Date:  ",$$FMTE^XLFDT($P(PSBOACTL(I,1),U,1)),?35,"User:  ",$P(PSBOACTL(I,1),U,2)
"RTN","PSBODO",65,0)
 ...W !?5,"Activity:  ",$P(PSBOACTL(I,1),U,4)
"RTN","PSBODO",66,0)
 ...I $D(PSBOACTL(I,2)) W !?8,"Field:  ",$P(PSBOACTL(I,1),U,3),!?5,"Old Data:  ",PSBOACTL(I,2)
"RTN","PSBODO",67,0)
 ...I $D(PSBOACTL(I,3)) W !?7,"Reason:  ",PSBOACTL(I,3)
"RTN","PSBODO",68,0)
 ...W !
"RTN","PSBODO",69,0)
 W !!
"RTN","PSBODO",70,0)
 D CLEAN^PSBVT K PSBOACTL
"RTN","PSBODO",71,0)
 Q
"RTN","PSBOHDR")
0^21^B15604534
"RTN","PSBOHDR",1,0)
PSBOHDR ;BIRMINGHAM/EFC-REPORT HEADERS ;Mar 2004
"RTN","PSBOHDR",2,0)
 ;;3.0;BAR CODE MED ADMIN;;Mar 2004
"RTN","PSBOHDR",3,0)
 ;
"RTN","PSBOHDR",4,0)
 ; Reference/IA
"RTN","PSBOHDR",5,0)
 ; ^GMRADPT/10099
"RTN","PSBOHDR",6,0)
 ; EN6^GMRVUTL/1120
"RTN","PSBOHDR",7,0)
 ; WARD^NURSUT5/3052
"RTN","PSBOHDR",8,0)
 ; IN5^VADPT/10061
"RTN","PSBOHDR",9,0)
 ; DEM^VADPT/10061
"RTN","PSBOHDR",10,0)
 ;
"RTN","PSBOHDR",11,0)
PT(DFN,PSBHDR,PSBCONT,PSBDT) ; 
"RTN","PSBOHDR",12,0)
 ; DFN:     Patient File IEN
"RTN","PSBOHDR",13,0)
 ; PSBCONT: True if this is a continuation page
"RTN","PSBOHDR",14,0)
 ; PSBDT:   Date of Pt Information (Default to DT)
"RTN","PSBOHDR",15,0)
 W:$Y>1 @IOF
"RTN","PSBOHDR",16,0)
 W:$X>1 !
"RTN","PSBOHDR",17,0)
 S:'$G(PSBDT) PSBDT=DT
"RTN","PSBOHDR",18,0)
 ; BUILD PSBHDR WITH ALL HEADER STUFF
"RTN","PSBOHDR",19,0)
 D:'$D(PSBHDR("NAME"))
"RTN","PSBOHDR",20,0)
 .S VAIP("D")="LAST"
"RTN","PSBOHDR",21,0)
 .D DEM^VADPT,IN5^VADPT
"RTN","PSBOHDR",22,0)
 .S PSBHDR("NAME")=VADM(1)
"RTN","PSBOHDR",23,0)
 .S PSBHDR("SSN")=$P(VADM(2),U,2)
"RTN","PSBOHDR",24,0)
 .S PSBHDR("DOB")=$P(VADM(3),U,2)
"RTN","PSBOHDR",25,0)
 .S PSBHDR("AGE")=VADM(4)
"RTN","PSBOHDR",26,0)
 .S PSBHDR("SEX")=$P(VADM(5),U,2)
"RTN","PSBOHDR",27,0)
 .S PSBHDR("MVMTTYPE")=$P(VAIP(2),U,2)
"RTN","PSBOHDR",28,0)
 .S PSBHDR("MVMTLAST")=$P(VAIP(3),U,2)
"RTN","PSBOHDR",29,0)
 .S PSBHDR("WARD")=$P(VAIP(5),U,2)
"RTN","PSBOHDR",30,0)
 .S PSBHDR("ROOM")=$P(VAIP(6),U,2)
"RTN","PSBOHDR",31,0)
 .S PSBHDR("DX")=VAIP(9)
"RTN","PSBOHDR",32,0)
 .K VAIP,VADM
"RTN","PSBOHDR",33,0)
 .S GMRVSTR="HT" D EN6^GMRVUTL
"RTN","PSBOHDR",34,0)
 .S X=+$P(X,U,8) S:X X=X*2.54\1 S PSBHDR("HEIGHT")=$S(X:X_"cm",1:"*")
"RTN","PSBOHDR",35,0)
 .S GMRVSTR="WT" D EN6^GMRVUTL
"RTN","PSBOHDR",36,0)
 .S X=+$P(X,U,8) S:X X=X*.45\1 S PSBHDR("WEIGHT")=$S(X:X_"kg",1:"*")
"RTN","PSBOHDR",37,0)
 .N PSBADRX D ALLR^PSBALL(.PSBADRX,DFN) S X=0,Y=""
"RTN","PSBOHDR",38,0)
 .F  S X=$O(PSBADRX(X)) Q:'X  D
"RTN","PSBOHDR",39,0)
 ..Q:$P(PSBADRX(X),U,1)'="ADR"  S Z=$P(PSBADRX(X),U,2) Q:Z=""
"RTN","PSBOHDR",40,0)
 ..I $L(Y_Z)>(IOM-22) S PSBHDR("REAC",$O(PSBHDR("REAC",""),-1)+1)=Y,Y=""
"RTN","PSBOHDR",41,0)
 ..S Y=Y_$S(Y]"":", ",1:"")_$P(PSBADRX(X),U,2)
"RTN","PSBOHDR",42,0)
 .S:Y]"" PSBHDR("REAC",$O(PSBHDR("REAC",""),-1)+1)=Y
"RTN","PSBOHDR",43,0)
 .I '$D(PSBHDR("REAC")) S PSBHDR("REAC",1)="No ADRs on file."
"RTN","PSBOHDR",44,0)
 .K GMRAL,GMRVSTR,GMRA,PSBARX
"RTN","PSBOHDR",45,0)
 .D NOW^%DTC S Y=+$E(%,1,12) D D^DIQ S PSBHDR("DATE")="Run Date: "_Y
"RTN","PSBOHDR",46,0)
 .S PSBHDR("PAGE")=0
"RTN","PSBOHDR",47,0)
 W $C(13),$TR($J("",IOM)," ","=")
"RTN","PSBOHDR",48,0)
 W !,$G(PSBHDR(0))
"RTN","PSBOHDR",49,0)
 W !,$G(PSBHDR(1)),?(IOM-$L(PSBHDR("DATE"))),PSBHDR("DATE")
"RTN","PSBOHDR",50,0)
 S PSBHDR("PAGE")=PSBHDR("PAGE")+1
"RTN","PSBOHDR",51,0)
 W !,$G(PSBHDR(2)),?(IOM-10),$J("Page: "_PSBHDR("PAGE"),10)
"RTN","PSBOHDR",52,0)
 F X=3:1 Q:'$D(PSBHDR(X))  W !,PSBHDR(X)  ; More Lines If Needed
"RTN","PSBOHDR",53,0)
 I $G(PSBCONT) W !?(IOM-35\2),"*** CONTINUED FROM PREVIOUS PAGE ***"
"RTN","PSBOHDR",54,0)
 W !!,"Patient:",?10,PSBHDR("NAME")
"RTN","PSBOHDR",55,0)
 W ?40,"SSN:       ",PSBHDR("SSN")
"RTN","PSBOHDR",56,0)
 W ?75,"DOB:",?82,PSBHDR("DOB")," (",PSBHDR("AGE"),")"
"RTN","PSBOHDR",57,0)
 D:'$G(PSBCONT)
"RTN","PSBOHDR",58,0)
 .W !,"Sex: ",?10,PSBHDR("SEX"),?40,"Ht/Wt:     ",PSBHDR("HEIGHT"),"/",PSBHDR("WEIGHT"),?75,"Ward: ",?82,PSBHDR("WARD")," Rm ",PSBHDR("ROOM")
"RTN","PSBOHDR",59,0)
 .W !,"Dx:",?10,PSBHDR("DX"),?40,"Last Mvmt: ",PSBHDR("MVMTLAST"),?75,"Type:  ",PSBHDR("MVMTTYPE")
"RTN","PSBOHDR",60,0)
 .; Reactions/Allergies
"RTN","PSBOHDR",61,0)
 .W !!,"Reactions:"
"RTN","PSBOHDR",62,0)
 .F X=0:0 S X=$O(PSBHDR("REAC",X)) Q:'X  W:$X>12 ! W ?12,PSBHDR("REAC",X)
"RTN","PSBOHDR",63,0)
 .; Local Mods Allowed Here and showup only on First Page
"RTN","PSBOHDR",64,0)
 .; Immunizations
"RTN","PSBOHDR",65,0)
 .;D SHOT80^ASFSHOTF
"RTN","PSBOHDR",66,0)
 W !,$TR($J("",IOM)," ","=")
"RTN","PSBOHDR",67,0)
 Q
"RTN","PSBOHDR",68,0)
 ;
"RTN","PSBOHDR",69,0)
WARD(PSBWP,PSBHDR,PSBCONT,PSBDT) ; 
"RTN","PSBOHDR",70,0)
 ; WARD:    Nurse Location File IEN
"RTN","PSBOHDR",71,0)
 ; PSBCONT: True if this is a continuation page
"RTN","PSBOHDR",72,0)
 ; PSBDT:   Date of Pt Information (Default to DT)
"RTN","PSBOHDR",73,0)
 N PSBWRDA
"RTN","PSBOHDR",74,0)
 S:'$G(PSBDT) PSBDT=DT
"RTN","PSBOHDR",75,0)
 I '$D(PSBHDR("DATE")) D NOW^%DTC S Y=+$E(%,1,12) D D^DIQ S PSBHDR("DATE")="Run Date: "_Y
"RTN","PSBOHDR",76,0)
 S:'$D(PSBHDR("PAGE")) PSBHDR("PAGE")=0
"RTN","PSBOHDR",77,0)
 W:$Y>1 @IOF
"RTN","PSBOHDR",78,0)
 W:$X>0 !
"RTN","PSBOHDR",79,0)
 W $TR($J("",IOM)," ","="),!,$G(PSBHDR(0)),!,$G(PSBHDR(1)),?(IOM-$L(PSBHDR("DATE"))),PSBHDR("DATE")
"RTN","PSBOHDR",80,0)
 S PSBHDR("PAGE")=PSBHDR("PAGE")+1
"RTN","PSBOHDR",81,0)
 W !,$G(PSBHDR(2)),?(IOM-10),$J("Page: "_PSBHDR("PAGE"),10)
"RTN","PSBOHDR",82,0)
 F X=3:1 Q:'$D(PSBHDR(X))  W !,PSBHDR(X)  ; More Lines If Needed
"RTN","PSBOHDR",83,0)
 I $G(PSBCONT) W !?(IOM-35\2),"*** CONTINUED FROM PREVIOUS PAGE ***"
"RTN","PSBOHDR",84,0)
 D WARD^NURSUT5("L^"_PSBWP,.PSBWRDA)
"RTN","PSBOHDR",85,0)
 W !!,"Ward Location: "_$P(PSBWRDA(PSBWP,.01),U,2)
"RTN","PSBOHDR",86,0)
 S X="Division: "_$P(PSBWRDA(PSBWP,.02),U,2)
"RTN","PSBOHDR",87,0)
 W ?(IOM-$L(X)),X,!,$TR($J("",IOM)," ","=")
"RTN","PSBOHDR",88,0)
 Q
"RTN","PSBOHDR",89,0)
 ;
"RTN","PSBOHDR",90,0)
PTFTR() ; [Extrinsic] Patient Page footer
"RTN","PSBOHDR",91,0)
 ;
"RTN","PSBOHDR",92,0)
 I (IOSL<100) F  Q:$Y>(IOSL-6)  W !
"RTN","PSBOHDR",93,0)
 W !,$TR($J("",IOM)," ","=")
"RTN","PSBOHDR",94,0)
 S X="Ward: "_PSBHDR("WARD")_"  Room-Bed: "_PSBHDR("ROOM")
"RTN","PSBOHDR",95,0)
 W !,PSBHDR("NAME"),?(IOM-11\2),PSBHDR("SSN"),?(IOM-$L(X)),X
"RTN","PSBOHDR",96,0)
 Q ""
"RTN","PSBOHDR",97,0)
 ;
"RTN","PSBOMD")
0^22^B11558325
"RTN","PSBOMD",1,0)
PSBOMD ;BIRMINGHAM/EFC-MISSING DOSE REPORT ;Mar 2004
"RTN","PSBOMD",2,0)
 ;;3.0;BAR CODE MED ADMIN;;Mar 2004
"RTN","PSBOMD",3,0)
 ;
"RTN","PSBOMD",4,0)
 ; Reference/IA
"RTN","PSBOMD",5,0)
 ; WARD^NURSUT5/3052
"RTN","PSBOMD",6,0)
 ; IN5^VADPT/10061
"RTN","PSBOMD",7,0)
 ; $$GET1^DIQ(52.6/436
"RTN","PSBOMD",8,0)
 ; $$GET1^DIQ(52.7/437
"RTN","PSBOMD",9,0)
 ;
"RTN","PSBOMD",10,0)
EN ; Begin printing
"RTN","PSBOMD",11,0)
 N PSBSCHD,PSBWRD,PSBSTRT,PSBSTOP,PSBWARD,PSBDRUG,PSBDT,PSBIEN,PSBWRDA
"RTN","PSBOMD",12,0)
 K ^TMP("PSB",$J)
"RTN","PSBOMD",13,0)
 S PSBWRD=+$P(PSBRPT(.1),U,3)
"RTN","PSBOMD",14,0)
 I PSBWRD D WARD^NURSUT5("L^"_PSBWRD,.PSBWRDA) S X="" F  S X=$O(PSBWRDA(PSBWRD,2,X)) Q:X=""  S Y=PSBWRDA(PSBWRD,2,X,.01),PSBWRD(+Y)=$P(Y,U,2),^TMP("PSB",$J,PSBWRD(+Y))=0
"RTN","PSBOMD",15,0)
 S PSBSTRT=$P(PSBRPT(.1),U,6)+$P(PSBRPT(.1),U,7)
"RTN","PSBOMD",16,0)
 S PSBSTOP=$P(PSBRPT(.1),U,8)+$P(PSBRPT(.1),U,9)
"RTN","PSBOMD",17,0)
 S PSBDT=PSBSTRT-.0000001
"RTN","PSBOMD",18,0)
 F  S PSBDT=$O(^PSB(53.68,"ADTE",PSBDT)) Q:'PSBDT!(PSBDT>PSBSTOP)  D
"RTN","PSBOMD",19,0)
 .S PSBIEN=0
"RTN","PSBOMD",20,0)
 .F  S PSBIEN=$O(^PSB(53.68,"ADTE",PSBDT,PSBIEN))  Q:'PSBIEN  D
"RTN","PSBOMD",21,0)
 ..Q:PSBWRD&('$D(PSBWRD(+$P($G(^PSB(53.68,PSBIEN,.1)),U,2))))
"RTN","PSBOMD",22,0)
 ..S PSBWARD=$$GET1^DIQ(53.68,PSBIEN_",",.12) Q:PSBWARD=""
"RTN","PSBOMD",23,0)
 ..S PSBDRUG=$$GET1^DIQ(53.68,PSBIEN_",",.13) I PSBDRUG="" D
"RTN","PSBOMD",24,0)
 ...S PSBDRUG="NO DATA"
"RTN","PSBOMD",25,0)
 ...I $D(^PSB(53.68,PSBIEN,.6)) S X=0 F  S X=$O(^PSB(53.68,+PSBIEN,.6,X)) Q:'X  S PSBDRUG=$$GET1^DIQ(52.6,+^PSB(53.68,PSBIEN,.6,X,0),.01)
"RTN","PSBOMD",26,0)
 ...I $D(^PSB(53.68,PSBIEN,.7)) S X=0 F  S X=$O(^PSB(53.68,+PSBIEN,.7,X)) Q:'X  S PSBDRUG=PSBDRUG_"  "_$$GET1^DIQ(52.7,+^PSB(53.68,+PSBIEN,.7,X,0),.01)
"RTN","PSBOMD",27,0)
 ..S PSBSCHD=$$GET1^DIQ(53.68,PSBIEN_",",.19) S:PSBSCHD="" PSBSCHD="NO DATA"
"RTN","PSBOMD",28,0)
 ..S ^TMP("PSB",$J,PSBWARD,PSBDRUG,PSBSCHD)=$G(^TMP("PSB",$J,PSBWARD,PSBDRUG,PSBSCHD))+1
"RTN","PSBOMD",29,0)
 ..S ^TMP("PSB",$J,PSBWARD)=+$G(^TMP("PSB",$J,PSBWARD))+1
"RTN","PSBOMD",30,0)
 ..S ^TMP("PSB",$J)=+$G(^TMP("PSB",$J))+1
"RTN","PSBOMD",31,0)
 W $$HDR()
"RTN","PSBOMD",32,0)
 I '$D(^TMP("PSB",$J)) W !!?5,"<<<NO MISSING DOSE REQUESTS FOR THIS TIME FRAME>>>" Q
"RTN","PSBOMD",33,0)
 S PSBWARD=""
"RTN","PSBOMD",34,0)
 F  S PSBWARD=$O(^TMP("PSB",$J,PSBWARD)) Q:PSBWARD=""  D
"RTN","PSBOMD",35,0)
 .W:$Y>(IOSL-10) $$HDR()
"RTN","PSBOMD",36,0)
 .W !,PSBWARD
"RTN","PSBOMD",37,0)
 .S (PSBDRUG,PSBSCHD)=""
"RTN","PSBOMD",38,0)
 .F  S PSBDRUG=$O(^TMP("PSB",$J,PSBWARD,PSBDRUG)) Q:PSBDRUG=""  D
"RTN","PSBOMD",39,0)
 ..F  S PSBSCHD=$O(^TMP("PSB",$J,PSBWARD,PSBDRUG,PSBSCHD)) Q:PSBSCHD=""  D
"RTN","PSBOMD",40,0)
 ...W:$Y>(IOSL-10) $$HDR()
"RTN","PSBOMD",41,0)
 ...W ?32,PSBDRUG,?74,$J(+^TMP("PSB",$J,PSBWARD,PSBDRUG,PSBSCHD),8),!,?35,"Schedule: "_PSBSCHD,!
"RTN","PSBOMD",42,0)
 .W ?74,"--------"
"RTN","PSBOMD",43,0)
 .W !?32,"Ward ",PSBWARD," Total: ",?74,$J(^TMP("PSB",$J,PSBWARD),8),!
"RTN","PSBOMD",44,0)
 W ?74,"========"
"RTN","PSBOMD",45,0)
 W !?32,"Report Total: ",?74,$J(+$G(^TMP("PSB",$J)),8)
"RTN","PSBOMD",46,0)
 K ^TMP("PSB",$J)
"RTN","PSBOMD",47,0)
 Q
"RTN","PSBOMD",48,0)
 ;
"RTN","PSBOMD",49,0)
HDR() ;
"RTN","PSBOMD",50,0)
 I '$D(PSBRPT("DATE")) D NOW^%DTC S Y=+$E(%,1,12) D D^DIQ S PSBRPT("DATE")="Run Date: "_Y
"RTN","PSBOMD",51,0)
 S:'$D(PSBRPT("PAGE")) PSBRPT("PAGE")=1
"RTN","PSBOMD",52,0)
 W:$Y>1 @IOF
"RTN","PSBOMD",53,0)
 W !,$TR($J("",IOM)," ","="),!,"MISSING DOSE REPORT FROM "
"RTN","PSBOMD",54,0)
 S Y=PSBSTRT D D^DIQ W Y," thru "
"RTN","PSBOMD",55,0)
 S Y=PSBSTOP D D^DIQ W Y
"RTN","PSBOMD",56,0)
 W ?(IOM-$L(PSBRPT("DATE"))),PSBRPT("DATE"),!,$S(PSBWRD:"SELECTED",1:"ALL")," WARDS"
"RTN","PSBOMD",57,0)
 S X="Page: "_PSBRPT("PAGE")
"RTN","PSBOMD",58,0)
 W ?(IOM-$L(X)),X
"RTN","PSBOMD",59,0)
 S PSBRPT("PAGE")=PSBRPT("PAGE")+1
"RTN","PSBOMD",60,0)
 W !,$TR($J("",IOM)," ","="),!,"Ward Location",?32,"Medication",?77,"Total",!,$TR($J("",IOM)," ","-"),!
"RTN","PSBOMD",61,0)
 Q ""
"RTN","PSBOMD",62,0)
 ;
"RTN","PSBOMD",63,0)
POST ;
"RTN","PSBOMD",64,0)
 N DFN
"RTN","PSBOMD",65,0)
 S DFN=X D IN5^VADPT
"RTN","PSBOMD",66,0)
 S PSBDDSW=$P(VAIP(5),U,2)
"RTN","PSBOMD",67,0)
 S PSBDDSR=$P(VAIP(6),U,2)
"RTN","PSBOMD",68,0)
 Q 
"RTN","PSBOMH")
0^23^B84859472
"RTN","PSBOMH",1,0)
PSBOMH ;BIRMINGHAM/EFC-MAH ;Mar 2004
"RTN","PSBOMH",2,0)
 ;;3.0;BAR CODE MED ADMIN;;Mar 2004
"RTN","PSBOMH",3,0)
 ;
"RTN","PSBOMH",4,0)
 ; Reference/IA
"RTN","PSBOMH",5,0)
 ; EN^PSJBCMA/2828
"RTN","PSBOMH",6,0)
 ; EN^PSJBCMA2/2830
"RTN","PSBOMH",7,0)
 ; File 200/10060
"RTN","PSBOMH",8,0)
 ;
"RTN","PSBOMH",9,0)
EN ; Called from DQ^PSBO
"RTN","PSBOMH",10,0)
 N PSBGBL,DFN
"RTN","PSBOMH",11,0)
 S PSBGBL=$NAME(^TMP("PSBO",$J,"B"))
"RTN","PSBOMH",12,0)
 F  S PSBGBL=$Q(@PSBGBL) Q:PSBGBL=""  Q:$QS(PSBGBL,2)'=$J  Q:$QS(PSBGBL,1)'["PSBO"  D
"RTN","PSBOMH",13,0)
 .S DFN=$QS(PSBGBL,5)
"RTN","PSBOMH",14,0)
 .S (PSBSTRT,X)=$P(PSBRPT(.1),U,6) D H^%DTC S PSBSTH=%H
"RTN","PSBOMH",15,0)
 .S (PSBSTOP,X)=$P(PSBRPT(.1),U,8)+.235959 D H^%DTC S PSBSPH=%H
"RTN","PSBOMH",16,0)
 .S PSBCNT=0 F I=PSBSTH:1:PSBSPH D
"RTN","PSBOMH",17,0)
 ..S PSBAR(I)=PSBSTH+((PSBCNT\7)*7),PSBCNT=PSBCNT+1
"RTN","PSBOMH",18,0)
 .D EN1
"RTN","PSBOMH",19,0)
 K PSBCNT,PSBAR Q
"RTN","PSBOMH",20,0)
EN1 ; Expects DFN,STRT,STOP
"RTN","PSBOMH",21,0)
 N PSBGBL,PSBHDR,PSBX,PSBFLAG
"RTN","PSBOMH",22,0)
 K ^TMP("PSJ",$J),^TMP("PSB",$J)
"RTN","PSBOMH",23,0)
 S PSBEVDT=PSBSTRT
"RTN","PSBOMH",24,0)
 D EN^PSJBCMA(DFN,PSBSTRT)
"RTN","PSBOMH",25,0)
 I $G(^TMP("PSJ",$J,1,0))=-1 D  Q  ; No Ord
"RTN","PSBOMH",26,0)
 .D PT^PSBOHDR(DFN,.PSBHDR) W !!,"****NO MEDICATIONS FOUND****"
"RTN","PSBOMH",27,0)
 S PSBX=""
"RTN","PSBOMH",28,0)
 F  S PSBX=$O(^TMP("PSJ",$J,PSBX)) Q:PSBX=""  D
"RTN","PSBOMH",29,0)
 .Q:$P(^TMP("PSJ",$J,PSBX,0),U,3)?.N1"P"  ; No Pnd
"RTN","PSBOMH",30,0)
 .Q:$P(^TMP("PSJ",$J,PSBX,1),U,5)<PSBSTRT!($P(^TMP("PSJ",$J,PSBX,1),U,4)>PSBSTOP)  ;display orders that are active within the dates of the report
"RTN","PSBOMH",31,0)
 .S X=$P(^TMP("PSJ",$J,PSBX,1),U,2)
"RTN","PSBOMH",32,0)
 .S ^TMP("PSB",$J,"ORDERS",$P(^TMP("PSJ",$J,PSBX,0),U,3))=X
"RTN","PSBOMH",33,0)
 I '$D(^TMP("PSB",$J,"ORDERS")) D PT^PSBOHDR(DFN,.PSBHDR) W !!,"****NO MEDICATIONS FOUND****" Q    ; No Orders
"RTN","PSBOMH",34,0)
 S PSBMHND="PSBOMH"
"RTN","PSBOMH",35,0)
 ; Act on Orders
"RTN","PSBOMH",36,0)
 S PSBX="" F  S PSBX=$O(^TMP("PSB",$J,"ORDERS",PSBX)) Q:PSBX=""  S PSBTYPE=^(PSBX) D
"RTN","PSBOMH",37,0)
 .S:PSBTYPE'="C" PSBTYPE="P"
"RTN","PSBOMH",38,0)
 .D CLEAN^PSBVT
"RTN","PSBOMH",39,0)
 .D PSJ1^PSBVT(DFN,PSBX)
"RTN","PSBOMH",40,0)
 .S X1=((PSBEVDT)\1)  S X2=-1  D C^%DTC  S PSBCNTST=X
"RTN","PSBOMH",41,0)
 .S X1=((PSBSTOP)\1)  S X2=1  D C^%DTC  S PSBXSTOP=X
"RTN","PSBOMH",42,0)
 .S PSBVALB=""
"RTN","PSBOMH",43,0)
 .S PSBVALB=$$IVPTAB^PSBVDLU3(PSBOTYP,PSBIVT,PSBISYR,PSBCHEMT,PSBMRAB)
"RTN","PSBOMH",44,0)
 .S PSBZ=""
"RTN","PSBOMH",45,0)
 .S X1=PSBXSTOP,X2=PSBCNTST D ^%DTC S PSBNCT=X
"RTN","PSBOMH",46,0)
 .F PSBZ=1:1:PSBNCT S X1=PSBCNTST  S X2=1  D C^%DTC  S PSBCNTST=X  D
"RTN","PSBOMH",47,0)
 ..I (PSBX["V")!(PSBX'["V")  D
"RTN","PSBOMH",48,0)
 ...I PSBCNTST'>(PSBOST\1) D
"RTN","PSBOMH",49,0)
 ....S ^TMP("PSB",$J,"ORDERS",PSBONX,"NTDUE",PSBCNTST)=""
"RTN","PSBOMH",50,0)
 ...I PSBCNTST=(PSBOST\1)!($G(^TMP("PSB",$J,"ORDERS",PSBONX,"NTDUE",PSBCNTST))) D
"RTN","PSBOMH",51,0)
 ....K ^TMP("PSB",$J,"ORDERS",PSBONX,"NTDUE",PSBCNTST)
"RTN","PSBOMH",52,0)
 ...I PSBCNTST>(PSBOSP\1) D
"RTN","PSBOMH",53,0)
 ....S ^TMP("PSB",$J,"ORDERS",PSBONX,"NTDUE",PSBCNTST)=""
"RTN","PSBOMH",54,0)
 ...I PSBCNTST=(PSBOSP\1)&($G(^TMP("PSB",$J,"ORDERS",PSBONX,"NTDUE",PSBCNTST))) D
"RTN","PSBOMH",55,0)
 ....K ^TMP("PSB",$J,"ORDERS",PSBONX,"NTDUE",PSBCNTST)
"RTN","PSBOMH",56,0)
 ....S ^TMP("PSB",$J,"ORDERS",PSBONX,"NTDUE",PSBCNTST)=""
"RTN","PSBOMH",57,0)
 ..S PSBDODD=""
"RTN","PSBOMH",58,0)
 ..I (PSBFREQ#1440'=0),(1440#PSBFREQ'=0) S PSBDODD=1
"RTN","PSBOMH",59,0)
 ..I (PSBX'["V")!(PSBVALB="1") D
"RTN","PSBOMH",60,0)
 ...I (PSBDODD="1")&(PSBADST'="") S ^TMP("PSB",$J,"ORDERS",PSBONX,"NTDUE",PSBCNTST)=""
"RTN","PSBOMH",61,0)
 ..I (PSBX'["V")!(PSBVALB="1") D
"RTN","PSBOMH",62,0)
 ...D:'$$OKAY^PSBVDLU1(PSBOST,PSBCNTST,PSBSCH,PSBON,PSBOITX,PSBFREQ,PSBOSTS)
"RTN","PSBOMH",63,0)
 ....S ^TMP("PSB",$J,"ORDERS",PSBONX,"NTDUE",PSBCNTST)=""  ;W t TMP
"RTN","PSBOMH",64,0)
 .S (PSBYES,PSBODD,PSBFLAG,PSBYTFN,PSBDAYN)=0
"RTN","PSBOMH",65,0)
 .S:$$PSBDCHK1^PSBVT1(PSBSCH) PSBYES=1,PSBDAYN=1
"RTN","PSBOMH",66,0)
 .I PSBYES,PSBADST="",PSBSCHT'="O",PSBSCHT'="OC",PSBSCHT'="P" Q 
"RTN","PSBOMH",67,0)
 .F I=1:1 Q:$P(PSBSCH,"-",I)=""  I $P(PSBSCH,"-",I)?2N!($P(PSBSCH,"-",I)?4N) S PSBYES=1,PSBYTFN=1
"RTN","PSBOMH",68,0)
 .I (PSBFREQ="O")!(PSBTYPE="P") S PSBYES=1
"RTN","PSBOMH",69,0)
 .I (PSBFREQ#1440'=0),(1440#PSBFREQ'=0) S PSBODD=1
"RTN","PSBOMH",70,0)
 .I PSBX["V" D
"RTN","PSBOMH",71,0)
 ..I PSBODD,PSBADST'="",PSBVALB'="1" Q
"RTN","PSBOMH",72,0)
 .;S flg, retr/s admn t
"RTN","PSBOMH",73,0)
 .S:PSBONX["U" PSBFLAG=1
"RTN","PSBOMH",74,0)
 .I PSBIVT="A" S PSBADST="0000"
"RTN","PSBOMH",75,0)
 .I PSBIVT="H" S PSBADST="0000"
"RTN","PSBOMH",76,0)
 .I PSBIVT="C",PSBCHEMT="P" S:PSBADST="" PSBFLAG=1
"RTN","PSBOMH",77,0)
 .I PSBIVT="C",PSBISYR=1 S:PSBADST="" PSBFLAG=1
"RTN","PSBOMH",78,0)
 .I PSBIVT="C",PSBCHEMT="A" S PSBADST="0000"
"RTN","PSBOMH",79,0)
 .I PSBIVT="C",PSBISYR=0 S PSBADST="0000"
"RTN","PSBOMH",80,0)
 .I PSBIVT="P",($G(PSBADST)=0) S:PSBADST="" PSBFLAG=1
"RTN","PSBOMH",81,0)
 .I PSBIVT="P" S:PSBADST="" PSBFLAG=1
"RTN","PSBOMH",82,0)
 .I PSBIVT="S",PSBISYR=0 S PSBADST="0000"
"RTN","PSBOMH",83,0)
 .I PSBIVT="S",PSBISYR=1 S:PSBADST="" PSBFLAG=1
"RTN","PSBOMH",84,0)
 .I PSBFREQ="D" S PSBFREQ=""
"RTN","PSBOMH",85,0)
 .I 'PSBYES,PSBADST="",PSBFREQ<1 Q
"RTN","PSBOMH",86,0)
 .S (PSBEE,PSBZZ)=0
"RTN","PSBOMH",87,0)
 .I (PSBVALB="1")!(PSBX'["V") D  Q:(PSBEE!PSBZZ)=1
"RTN","PSBOMH",88,0)
 ..I PSBSCHT="C",PSBYTFN="1",PSBADST=""  S PSBEE=1
"RTN","PSBOMH",89,0)
 ..I PSBSCHT="C",PSBDAYN'="1",PSBYTFN'="1",PSBADST'="",PSBFREQ<1  S PSBZZ=1
"RTN","PSBOMH",90,0)
 .I 'PSBODD,PSBFLAG,PSBTYPE="C",PSBADST="" S PSBADST=$$GETADMIN^PSBVDLU1(DFN,PSBONX,PSBOST,PSBFREQ,PSBEVDT)
"RTN","PSBOMH",91,0)
 .E  I PSBADST'="" K ^TMP("PSB",$J,"GETADMIN") S ^TMP("PSB",$J,"GETADMIN",0)=PSBADST
"RTN","PSBOMH",92,0)
 .;Calc adm/Frq
"RTN","PSBOMH",93,0)
 .S PSBDT=PSBSTRT
"RTN","PSBOMH",94,0)
 .K PSBO,^UTILITY($J)
"RTN","PSBOMH",95,0)
 .F X=1:1:8 S PSBO(X)=""
"RTN","PSBOMH",96,0)
 .S DIWL=0,DIWR=32,DIWF="C32"
"RTN","PSBOMH",97,0)
 .S X=$P(PSBOSTX," ")_"          "_$P(PSBOSPX," ") D ^DIWP
"RTN","PSBOMH",98,0)
 .S X="@"_$P(PSBOSTX," ",3)_"              @"_$P(PSBOSPX," ",3)_"   " D ^DIWP
"RTN","PSBOMH",99,0)
 .S X="" D ^DIWP
"RTN","PSBOMH",100,0)
 .S X=PSBOITX D ^DIWP
"RTN","PSBOMH",101,0)
 .; DSP DRG,SOL,ADD
"RTN","PSBOMH",102,0)
 .S X=""
"RTN","PSBOMH",103,0)
 .F Y=0:0 S Y=$O(PSBDDA(Y)) Q:'Y  D
"RTN","PSBOMH",104,0)
 ..S X=X_$S(X]"":", ",1:"")_$P(PSBDDA(Y),U,3)
"RTN","PSBOMH",105,0)
 .F Y=0:0 S Y=$O(PSBADA(Y)) Q:'Y  D
"RTN","PSBOMH",106,0)
 ..S X=X_$S(X]"":", ",1:"")_$P(PSBADA(Y),U,3)_" "_$P(PSBADA(Y),U,4)_$P(PSBADA(Y),U,5)
"RTN","PSBOMH",107,0)
 .F Y=0:0 S Y=$O(PSBSOLA(Y)) Q:'Y  D
"RTN","PSBOMH",108,0)
 ..S X=X_$S(X]"":", ",1:"")_$P(PSBSOLA(Y),U,3)_" "_$P(PSBSOLA(Y),U,4)
"RTN","PSBOMH",109,0)
 .S X=" "_X,DIWF="I2C32" D ^DIWP S DIWF="C32"
"RTN","PSBOMH",110,0)
 .S PSBTXT=" Give: "_PSBDOSE_" "_PSBMRAB_" "_PSBSCH_" "_PSBIFR
"RTN","PSBOMH",111,0)
 .F  S PSBWORD=$P(PSBTXT," ",1),PSBTXT=$P(PSBTXT," ",2,250) D  Q:PSBTXT=""
"RTN","PSBOMH",112,0)
 ..F  Q:'$L(PSBWORD)  D
"RTN","PSBOMH",113,0)
 ...S X=$E(PSBWORD,1,30),PSBWORD=$E(PSBWORD,30,250)
"RTN","PSBOMH",114,0)
 ...D ^DIWP
"RTN","PSBOMH",115,0)
 .K ^TMP("PSJ",$J) D EN^PSJBCMA2(DFN,PSBX) I ^TMP("PSJ",$J,0)'=-1 D   ;get activity log
"RTN","PSBOMH",116,0)
 ..S (PSBDISX,PSBHLDX)=0 F I=1:1:$P(^TMP("PSJ",$J,0),U,4) S X=$G(^TMP("PSJ",$J,I,1)) D  ;loop through activities 
"RTN","PSBOMH",117,0)
 ...Q:X["EDITED"!(X["VERIF")  ;
"RTN","PSBOMH",118,0)
 ...S Z=0
"RTN","PSBOMH",119,0)
 ...I X'["OFF HOLD",X'["UNHOLD",X'["REINSTATE" S Z=1 ; inc iv's
"RTN","PSBOMH",120,0)
 ...S PSBHLDX=PSBHLDX+$S(Z>0:1,1:0)
"RTN","PSBOMH",121,0)
 ...S $P(PSBHLD(PSBHLDX),U,$S(Z>0:1,1:11))=^TMP("PSJ",$J,I,1)  ;set up for multiple on hold entries save start & stop as pair if exists 
"RTN","PSBOMH",122,0)
 ..F PSBHLDX=1:1 S X=$G(PSBHLD(PSBHLDX)) Q:'X  D  ;if a hold index - process 
"RTN","PSBOMH",123,0)
 ...S PSBHLDN=$P(PSBHLD(PSBHLDX),U,1),PSBHLDF=$P(PSBHLD(PSBHLDX),U,11)  ;get on hold and off hold and dates and IEN number(for UD orders) of person used to get initials. 
"RTN","PSBOMH",124,0)
 ...Q:PSBHLDN>PSBSTOP  Q:(PSBHLDF<PSBSTRT)&(PSBHLDF'="") 
"RTN","PSBOMH",125,0)
 ...F PSBHLDT=PSBSTRT\1:1:PSBSTOP\1 I (PSBHLDT'<(PSBHLDN\1)),(PSBHLDT'>PSBSTOP) D
"RTN","PSBOMH",126,0)
 ....I X["DISCONTINUED" D
"RTN","PSBOMH",127,0)
 .....K ^TMP("PSB",$J,"ORDERS",PSBONX,"HOLD",PSBHLDT)
"RTN","PSBOMH",128,0)
 .....S ^TMP("PSB",$J,"ORDERS",PSBONX,"DISC",PSBHLDT)=""
"RTN","PSBOMH",129,0)
 ....I (X["HOLD")&((PSBHLDN\1)'>PSBHLDT)&((PSBHLDF'<PSBHLDT)!(PSBHLDF="")) D
"RTN","PSBOMH",130,0)
 .....S ^TMP("PSB",$J,"ORDERS",PSBONX,"HOLD",PSBHLDT)=""
"RTN","PSBOMH",131,0)
 ....I X["REINSTATE" D
"RTN","PSBOMH",132,0)
 .....K ^TMP("PSB",$J,"ORDERS",PSBONX,"DISC",PSBHLDT)
"RTN","PSBOMH",133,0)
 .....I PSBOSTS="H" S ^TMP("PSB",$J,"ORDERS",PSBONX,"HOLD",PSBHLDT)=""
"RTN","PSBOMH",134,0)
 ...F PSBHLDXP=1:10:$P(PSBHLD(PSBHLDX),U,11)]""+10 D
"RTN","PSBOMH",135,0)
 ....S PSBDESC=$P(PSBHLD(PSBHLDX),U,PSBHLDXP+3),X=$S(PSBDESC["DISCONTINUE":"***",1:"")
"RTN","PSBOMH",136,0)
 ....S X=" "_X_PSBDESC D ^DIWP  ;output activity text 
"RTN","PSBOMH",137,0)
 ....S X="",PSBHLDI=$P(PSBHLD(PSBHLDX),U,PSBHLDXP+4) I PSBHLDI'="" S X=$$GET1^DIQ(200,PSBHLDI,"INITIAL")
"RTN","PSBOMH",138,0)
 ....S:X="" X="99" ;no init present
"RTN","PSBOMH",139,0)
 ....I X'="99" S X=" "_X D ^DIWP   ;get init & store
"RTN","PSBOMH",140,0)
 ....S Y=$P(PSBHLD(PSBHLDX),U,PSBHLDXP) D DD^%DT S X=Y D ^DIWP  ;format hold status date and write 
"RTN","PSBOMH",141,0)
 ..K PSBHLD,PSBHLDF,PSBHLDN,PSBHLDT,PSBHLDX,PSBHLDXP,PSBHLDI,PSBDISX,PSBDISC,PSBDISXP,PSBDISI,PSBDIST,PSBDISN,PSBDESC
"RTN","PSBOMH",142,0)
 .I PSBOTXT]"" D
"RTN","PSBOMH",143,0)
 ..S PSBOTXT=" Spec Inst: "_PSBOTXT
"RTN","PSBOMH",144,0)
 ..F  S PSBWORD=$P(PSBOTXT," ",1),PSBOTXT=$P(PSBOTXT," ",2,250) D  Q:PSBOTXT=""
"RTN","PSBOMH",145,0)
 ...F  Q:'$L(PSBWORD)  D
"RTN","PSBOMH",146,0)
 ....S X=$E(PSBWORD,1,30),PSBWORD=$E(PSBWORD,30,250)
"RTN","PSBOMH",147,0)
 ....D ^DIWP
"RTN","PSBOMH",148,0)
 .F X=0:0 S X=$O(^UTILITY($J,"W",0,X)) Q:'X  S PSBO(X)=$G(^(X,0)) D
"RTN","PSBOMH",149,0)
 .S X=$O(PSBO(""),-1) S X=$S(X<8:8,1:X+1)
"RTN","PSBOMH",150,0)
 .S PSBO(X)=" RPH: "_PSBVPHI_"  RN: "_PSBVNI
"RTN","PSBOMH",151,0)
 .S PSBVAL=$$IVPTAB^PSBVDLU3(PSBOTYP,PSBIVT,PSBISYR,PSBCHEMT,PSBMRAB)
"RTN","PSBOMH",152,0)
 .I PSBODD="1",PSBADST'="" D
"RTN","PSBOMH",153,0)
 ..I (PSBVAL="1")!(PSBX'["V") D   ;checks iv/pb and u dose
"RTN","PSBOMH",154,0)
 ...S PSB0(X+1)=""
"RTN","PSBOMH",155,0)
 ...S PSBO(X+2)="NOTE - ODD SCHEDULE NO LONGER"
"RTN","PSBOMH",156,0)
 ...S PSBO(X+3)="       ALLOWS ADMIN TIMES."
"RTN","PSBOMH",157,0)
 .K ^UTILITY($J)
"RTN","PSBOMH",158,0)
 .M ^TMP("PSB",$J,"ORDERS",PSBX,"INST")=PSBO
"RTN","PSBOMH",159,0)
 .D:PSBTYPE="C"
"RTN","PSBOMH",160,0)
 ..F  D  Q:PSBDT>PSBSTOP
"RTN","PSBOMH",161,0)
 ...S X=PSBDT D H^%DTC S PSBWEEK=%H
"RTN","PSBOMH",162,0)
 ...S ^TMP("PSB",$J,PSBWEEK,PSBONX)=""
"RTN","PSBOMH",163,0)
 ...;I admn f odd schd msg NO TIMES
"RTN","PSBOMH",164,0)
 ...S PSBIDOW=0 I PSBONX["U"!("PCS"[PSBIVT) S PSBIDOW=1
"RTN","PSBOMH",165,0)
 ...I PSBADST="",PSBIDOW,(PSBODD) D
"RTN","PSBOMH",166,0)
 ....S ^TMP("PSB",$J,"ORDERS",PSBONX,"AT",0)=7
"RTN","PSBOMH",167,0)
 ....S ^TMP("PSB",$J,"ORDERS",PSBONX,"AT",1)="odd"
"RTN","PSBOMH",168,0)
 ....S ^TMP("PSB",$J,"ORDERS",PSBONX,"AT",2)="sched"
"RTN","PSBOMH",169,0)
 ....S ^TMP("PSB",$J,"ORDERS",PSBONX,"AT",3)=$E(PSBSCH,1,5)
"RTN","PSBOMH",170,0)
 ....S ^TMP("PSB",$J,"ORDERS",PSBONX,"AT",4)="no"
"RTN","PSBOMH",171,0)
 ....S ^TMP("PSB",$J,"ORDERS",PSBONX,"AT",5)="fixed"
"RTN","PSBOMH",172,0)
 ....S ^TMP("PSB",$J,"ORDERS",PSBONX,"AT",6)="admin"
"RTN","PSBOMH",173,0)
 ....S ^TMP("PSB",$J,"ORDERS",PSBONX,"AT",7)="times"
"RTN","PSBOMH",174,0)
 ...I PSBADST'="",PSBADST'="0000",+$G(PSBFREQ)>0,+$G(PSBFREQ)<45 D
"RTN","PSBOMH",175,0)
 ....S ^TMP("PSB",$J,"ORDERS",PSBONX,"AT",0)=5
"RTN","PSBOMH",176,0)
 ....S ^TMP("PSB",$J,"ORDERS",PSBONX,"AT",1)="Due"
"RTN","PSBOMH",177,0)
 ....S ^TMP("PSB",$J,"ORDERS",PSBONX,"AT",2)="every"
"RTN","PSBOMH",178,0)
 ....S ^TMP("PSB",$J,"ORDERS",PSBONX,"AT",3)=$E(PSBFREQ,1,5)
"RTN","PSBOMH",179,0)
 ....S ^TMP("PSB",$J,"ORDERS",PSBONX,"AT",4)="mins."
"RTN","PSBOMH",180,0)
 ....S ^TMP("PSB",$J,"ORDERS",PSBONX,"AT",5)=" "
"RTN","PSBOMH",181,0)
 ...S PSBATCNT=0    ; Track # times to print...
"RTN","PSBOMH",182,0)
 ...I PSBADST'="",((+$G(PSBFREQ)>44)!(PSBFREQ="")!(PSBADST="0000")) F PSBXX=0:1  Q:$G(^TMP("PSB",$J,"GETADMIN",PSBXX))=""  D
"RTN","PSBOMH",183,0)
 ....S PSBADST2=$G(^TMP("PSB",$J,"GETADMIN",PSBXX))
"RTN","PSBOMH",184,0)
 ....F Y=1:1:$L(PSBADST2,"-") D
"RTN","PSBOMH",185,0)
 .....Q:($P(PSBADST2,"-",Y)'?2N)&($P(PSBADST2,"-",Y)'?4N)
"RTN","PSBOMH",186,0)
 .....S PSBATCNT=PSBATCNT+1
"RTN","PSBOMH",187,0)
 .....S ^TMP("PSB",$J,"ORDERS",PSBONX,"AT",PSBATCNT)=$P(PSBADST2,"-",Y)
"RTN","PSBOMH",188,0)
 ...I PSBADST'="",PSBFREQ>44 S ^TMP("PSB",$J,"ORDERS",PSBONX,"AT",0)=PSBATCNT
"RTN","PSBOMH",189,0)
 ...S ^TMP("PSB",$J,PSBWEEK,"SORT",PSBTYPE,PSBOITX,PSBX)=""
"RTN","PSBOMH",190,0)
 ...F PSBDOW=0:1:6 D  Q:X>(PSBSTOP-1)
"RTN","PSBOMH",191,0)
 ....S %H=PSBWEEK+PSBDOW D YMD^%DTC
"RTN","PSBOMH",192,0)
 ....S ^TMP("PSB",$J,PSBWEEK,PSBONX,X,0)=0
"RTN","PSBOMH",193,0)
 ....D:'$D(^TMP("PSB",$J,PSBWEEK,"HDR",X))
"RTN","PSBOMH",194,0)
 .....S ^TMP("PSB",$J,PSBWEEK,"HDR",X)=$E(X,4,5)_"/"_$E(X,6,7)_"/"_(1700+$E(X,1,3))
"RTN","PSBOMH",195,0)
 ...S %H=PSBWEEK+7 D YMD^%DTC S PSBDT=X
"RTN","PSBOMH",196,0)
 .D:PSBTYPE'="C"
"RTN","PSBOMH",197,0)
 ..S X=PSBDT D H^%DTC S PSBWEEK=%H
"RTN","PSBOMH",198,0)
 ..S ^TMP("PSB",$J,PSBWEEK,PSBONX)=""
"RTN","PSBOMH",199,0)
 ..S ^TMP("PSB",$J,PSBWEEK,"SORT",PSBTYPE,PSBOITX,PSBX)=""
"RTN","PSBOMH",200,0)
 D EN^PSBOMH1,EN^PSBOMH2
"RTN","PSBOMH",201,0)
 Q
"RTN","PSBOMH",202,0)
INSTR S PSBINIT=PSBINIT_"*"
"RTN","PSBOMH",203,0)
 S PSBNAME=PSBNAME_"/"_$P(^PSB(53.79,PSBIEN,.9,$P(PSBDT,"."),0),U,3)_"  "_$$GET1^DIQ(53.79,PSBIEN_",",.06)
"RTN","PSBOMH",204,0)
 Q
"RTN","PSBOMH1")
0^24^B47198831
"RTN","PSBOMH1",1,0)
PSBOMH1 ;BIRMINGHAM/EFC-MAH ;Mar 2004
"RTN","PSBOMH1",2,0)
 ;;3.0;BAR CODE MED ADMIN;;Mar 2004
"RTN","PSBOMH1",3,0)
 ;
"RTN","PSBOMH1",4,0)
EN ;
"RTN","PSBOMH1",5,0)
 ; Load administrations
"RTN","PSBOMH1",6,0)
 S (PSBORD,PSBIEN,PSBADIEN)="",PSBDT=PSBSTRT
"RTN","PSBOMH1",7,0)
 F  S PSBDT=$O(^PSB(53.79,"AADT",DFN,PSBDT)) Q:'PSBDT!(PSBDT>PSBSTOP)  D
"RTN","PSBOMH1",8,0)
 .F  S PSBIEN=$O(^PSB(53.79,"AADT",DFN,PSBDT,PSBIEN)) Q:'PSBIEN  D
"RTN","PSBOMH1",9,0)
 ..Q:'$P($G(^PSB(53.79,PSBIEN,0)),U,6)  ; Bad entry, no event dt
"RTN","PSBOMH1",10,0)
 ..Q:$P(^PSB(53.79,PSBIEN,0),U,9)="N"  ;Status is not given
"RTN","PSBOMH1",11,0)
 ..S PSBORD=$P(^PSB(53.79,PSBIEN,.1),U,1)
"RTN","PSBOMH1",12,0)
 ..; Load as Continuous <=====
"RTN","PSBOMH1",13,0)
 ..D:$P($G(^PSB(53.79,PSBIEN,.1)),U,2)="C"
"RTN","PSBOMH1",14,0)
 ...S X=PSBDT D H^%DTC S PSBWEEK=PSBAR(%H)
"RTN","PSBOMH1",15,0)
 ...I $P(^PSB(53.79,PSBIEN,0),U,6)'=PSBDT,$P(^PSB(53.79,PSBIEN,.1),U,1)["V" D  Q  ;check IV audit
"RTN","PSBOMH1",16,0)
 ....D CLEAN^PSBVT,PSJ1^PSBVT($P(^PSB(53.79,PSBIEN,0),U,1),$P(^PSB(53.79,PSBIEN,.1),U,1))
"RTN","PSBOMH1",17,0)
 ....S PSBSIEN=PSBIEN
"RTN","PSBOMH1",18,0)
 ....I $P(^PSB(53.79,PSBIEN,0),"^",10)]"" D BAGDTL^PSBRPC2(.PSBAUD,$P(^PSB(53.79,PSBIEN,0),U,10),$P(^PSB(53.79,PSBIEN,.1),U,1))
"RTN","PSBOMH1",19,0)
 ....S PSBIEN=PSBSIEN K PSBSIEN
"RTN","PSBOMH1",20,0)
 ....S X=0 F  S X=$O(PSBAUD(X)) Q:X=""  I $P(PSBAUD(X),U,3)="" K PSBAUD(X)
"RTN","PSBOMH1",21,0)
 ....S X=0 F  S X=$O(PSBAUD(X)) Q:X=""  Q:$P(PSBAUD(X),U,1)=PSBDT
"RTN","PSBOMH1",22,0)
 ....I X="" K PSBAUD Q
"RTN","PSBOMH1",23,0)
 ....I '$D(PSBAUD(X)) K PSBAUD Q
"RTN","PSBOMH1",24,0)
 ....S PSBS=$P(PSBAUD(X),U,3)
"RTN","PSBOMH1",25,0)
 ....I PSBS="GIVEN",$P($G(PSBAUD(X-1)),U,3)="NOT GIVEN" Q
"RTN","PSBOMH1",26,0)
 ....I PSBS="NOT GIVEN" Q
"RTN","PSBOMH1",27,0)
 ....S PSBS=$S(PSBS="INFUSING":"I",PSBS="GIVEN":"G",PSBS="COMPLETED":"C",PSBS="HELD":"H",PSBS="REFUSED":"R",PSBS="REMOVED":"RM",PSBS="STOPPED":"S",PSBS["MISSING":"M",1:"NOACTION")
"RTN","PSBOMH1",28,0)
 ....S X=PSBDT_U_$P(PSBAUD(X),U,2)_U_PSBS_U_PSBIEN
"RTN","PSBOMH1",29,0)
 ....S Y=$O(^TMP("PSB",$J,PSBWEEK,PSBORD,PSBDT\1,""),-1)+1
"RTN","PSBOMH1",30,0)
 ....S ^TMP("PSB",$J,PSBWEEK,PSBORD,PSBDT\1,Y)=X
"RTN","PSBOMH1",31,0)
 ....S ^TMP("PSB",$J,PSBWEEK,PSBORD,PSBDT\1,0)=Y
"RTN","PSBOMH1",32,0)
 ....K PSBAUD
"RTN","PSBOMH1",33,0)
 ...S PSBINIT=$$GET1^DIQ(53.79,PSBIEN_",","ACTION BY:INITIAL")
"RTN","PSBOMH1",34,0)
 ...S PSBNAME=$$GET1^DIQ(53.79,PSBIEN_",","ACTION BY:NAME")
"RTN","PSBOMH1",35,0)
 ...I PSBINIT="" S PSBINIT=99
"RTN","PSBOMH1",36,0)
 ...;get instructor info from audit log
"RTN","PSBOMH1",37,0)
 ...I $D(^PSB(53.79,PSBIEN,.9,$P(PSBDT,"."))) D INSTR^PSBOMH
"RTN","PSBOMH1",38,0)
 ...I PSBINIT'="",PSBNAME'="" S ^TMP("PSB",$J,"LEGEND",PSBINIT,PSBNAME)=""  ;save initals,name for legend
"RTN","PSBOMH1",39,0)
 ...I PSBINIT[99 S PSBINIT=""
"RTN","PSBOMH1",40,0)
 ...I $P(^PSB(53.79,PSBIEN,0),U,9)="G",PSBDT=$P(^PSB(53.79,PSBIEN,0),U,6) S X=$P(^PSB(53.79,PSBIEN,0),U,6)_U_PSBINIT_U_"G"_U_PSBIEN
"RTN","PSBOMH1",41,0)
 ...I $P(^PSB(53.79,PSBIEN,0),U,9)'="G",PSBDT=$P(^PSB(53.79,PSBIEN,0),U,6) S X=$P(^PSB(53.79,PSBIEN,0),U,6)_U_PSBINIT_U_$P(^(0),U,9)_U_PSBIEN
"RTN","PSBOMH1",42,0)
 ...I PSBDT'=$P(^PSB(53.79,PSBIEN,0),U,6),$P(^PSB(53.79,PSBIEN,0),U,9)="RM" D
"RTN","PSBOMH1",43,0)
 ....D DDAUD
"RTN","PSBOMH1",44,0)
 ....S I="" F  S I=$O(PSBTAR(I),-1) Q:I=""  I $P(PSBTAR(I),U,1)=PSBDT D
"RTN","PSBOMH1",45,0)
 .....S PSBS=$P(PSBTAR(I),U,3)
"RTN","PSBOMH1",46,0)
 .....I PSBS="GIVEN",$P($G(PSBTAR(I-1)),U,3)="NOT GIVEN" Q  ; given canceled by not given
"RTN","PSBOMH1",47,0)
 .....I PSBS="NOT GIVEN" Q
"RTN","PSBOMH1",48,0)
 .....S PSBS=$S(PSBS="INFUSING":"I",PSBS="GIVEN":"G",PSBS="COMPLETED":"C",PSBS="HELD":"H",PSBS="REFUSED":"R",PSBS="REMOVED":"RM",PSBS="STOPPED":"S",PSBS["MISSING":"M",1:"NO ACTION")
"RTN","PSBOMH1",49,0)
 .....S X=$P(PSBTAR(I),U,1,2)_U_PSBS_U_PSBIEN
"RTN","PSBOMH1",50,0)
 ...Q:$P(X,U,2)=""
"RTN","PSBOMH1",51,0)
 ...S Y=$O(^TMP("PSB",$J,PSBWEEK,PSBORD,PSBDT\1,""),-1)+1
"RTN","PSBOMH1",52,0)
 ...S ^TMP("PSB",$J,PSBWEEK,PSBORD,PSBDT\1,Y)=X
"RTN","PSBOMH1",53,0)
 ...S ^TMP("PSB",$J,PSBWEEK,PSBORD,PSBDT\1,0)=Y
"RTN","PSBOMH1",54,0)
 ...Q
"RTN","PSBOMH1",55,0)
 ..; Load as One-Time On Call or PRN <=====
"RTN","PSBOMH1",56,0)
 ..D:$P($G(^PSB(53.79,PSBIEN,.1)),U,2)'="C"
"RTN","PSBOMH1",57,0)
 ...I PSBDT'=$$GET1^DIQ(53.79,PSBIEN_",",.06,"I") Q
"RTN","PSBOMH1",58,0)
 ...S PSBINIT=$$GET1^DIQ(53.79,PSBIEN_",","ACTION BY:INITIAL")
"RTN","PSBOMH1",59,0)
 ...S PSBNAME=$$GET1^DIQ(53.79,PSBIEN_",","ACTION BY:NAME")
"RTN","PSBOMH1",60,0)
 ...I PSBINIT="" S PSBINIT=99
"RTN","PSBOMH1",61,0)
 ...S PSBXA=1,PSBM="",PSBZ="",PSBT="",PSBFLG=""
"RTN","PSBOMH1",62,0)
 ...I $$GET1^DIQ(53.79,PSBIEN_",",.09)="REMOVED"  D
"RTN","PSBOMH1",63,0)
 ....F I=1:1 S PSBXA=$O(^PSB(53.79,PSBIEN,.9,PSBXA)) Q:PSBXA=""  I PSBXA?1.3N  S PSBZ=PSBZ+1,PSBT(PSBZ)=^PSB(53.79,PSBIEN,.9,PSBXA,0)
"RTN","PSBOMH1",64,0)
 ....F S=1:1 S PSBM=PSBZ-S  I PSBT(PSBM)["GIVEN"  S PSBFLG="1" S PRELINE1=$P(PSBT(PSBM),"'",2)_" "_$$GET1^DIQ(53.79,PSBIEN_",",.04)_" "_$E($P(PSBT(PSBM),"'",4),1,3) Q
"RTN","PSBOMH1",65,0)
 ...I $D(^PSB(53.79,PSBIEN,.9,$P(PSBDT,"."))) D INSTR^PSBOMH
"RTN","PSBOMH1",66,0)
 ...S PSBLINE1=$$GET1^DIQ(53.79,PSBIEN_",",.09)_" "_$$GET1^DIQ(53.79,PSBIEN_",",.06)_" "_PSBINIT_"            "_$$GET1^DIQ(53.79,PSBIEN_",",.21),PSBLINE2=""
"RTN","PSBOMH1",67,0)
 ...I PSBINIT'="",PSBNAME'="" S ^TMP("PSB",$J,"LEGEND",PSBINIT,PSBNAME)=""  ;save initals,name for legend
"RTN","PSBOMH1",68,0)
 ...I PSBINIT[99 S PSBINIT=""
"RTN","PSBOMH1",69,0)
 ...D:$P($G(^PSB(53.79,PSBIEN,.1)),U,2)="P"
"RTN","PSBOMH1",70,0)
 ....I $P($G(^PSB(53.79,PSBIEN,.2)),U,2)="" S PSBLINE2="  Results: <No PRN Results On File>"
"RTN","PSBOMH1",71,0)
 ....E  D
"RTN","PSBOMH1",72,0)
 .....S PSBINIT=$$GET1^DIQ(53.79,PSBIEN_",","PRN EFFECTIVENESS ENTERED BY:INITIAL")
"RTN","PSBOMH1",73,0)
 .....S PSBNAME=$$GET1^DIQ(53.79,PSBIEN_",","PRN EFFECTIVENESS ENTERED BY:NAME")
"RTN","PSBOMH1",74,0)
 .....I PSBINIT="" S PSBINIT=99
"RTN","PSBOMH1",75,0)
 .....I $D(^PSB(53.79,PSBIEN,.9,$P(PSBDT,"."))) S PSBINIT=PSBINIT_"*",PSBNAME=PSBNAME_"/"_$P(^PSB(53.79,PSBIEN,.9,$P(PSBDT,"."),0),U,3)_"  "_$$GET1^DIQ(53.79,PSBIEN_",",.24)
"RTN","PSBOMH1",76,0)
 .....S PSBLINE2="  Results: "_$$GET1^DIQ(53.79,PSBIEN_",",.22)
"RTN","PSBOMH1",77,0)
 .....S PSBRTXTW="     Entered By "_PSBINIT_" on "_$$GET1^DIQ(53.79,PSBIEN_",",.24)
"RTN","PSBOMH1",78,0)
 .....I PSBINIT'="",PSBNAME'="" S ^TMP("PSB",$J,"LEGEND",PSBINIT,PSBNAME)=""  ;
"RTN","PSBOMH1",79,0)
 .....I PSBINIT[99 S PSBINIT=""
"RTN","PSBOMH1",80,0)
 ...S X=PSBDT D H^%DTC S PSBWEEK=PSBAR(%H)
"RTN","PSBOMH1",81,0)
 ...S X=$O(^TMP("PSB",$J,PSBWEEK,PSBORD,"AT",""),-1)+1
"RTN","PSBOMH1",82,0)
 ...I PSBFLG="1" S ^TMP("PSB",$J,PSBWEEK,PSBORD,"AT",X)=PRELINE1
"RTN","PSBOMH1",83,0)
 ...S ^TMP("PSB",$J,PSBWEEK,PSBORD,"AT",X+1)=PSBLINE1
"RTN","PSBOMH1",84,0)
 ...I $G(PSBLINE2)]"" D
"RTN","PSBOMH1",85,0)
 ....I $L(PSBLINE2)<90 S ^TMP("PSB",$J,PSBWEEK,PSBORD,"AT",X+2)=PSBLINE2 S:$$GET1^DIQ(53.79,PSBIEN_",",.24)'="" ^TMP("PSB",$J,PSBWEEK,PSBORD,"AT",X+3)="      "_PSBRTXTW
"RTN","PSBOMH1",86,0)
 ....I $L(PSBLINE2)>90 D
"RTN","PSBOMH1",87,0)
 .....S ^TMP("PSB",$J,PSBWEEK,PSBORD,"AT",X+2)=$E(PSBLINE2,1,90)
"RTN","PSBOMH1",88,0)
 .....S ^TMP("PSB",$J,PSBWEEK,PSBORD,"AT",X+3)="           "_$E(PSBLINE2,91,161)
"RTN","PSBOMH1",89,0)
 .....I $L(PSBLINE2)'>161 S ^TMP("PSB",$J,PSBWEEK,PSBORD,"AT",X+4)="      "_PSBRTXTW
"RTN","PSBOMH1",90,0)
 .....I $L(PSBLINE2)>161 S ^TMP("PSB",$J,PSBWEEK,PSBORD,"AT",X+4)="     "_$E(PSBLINE2,162,200),^TMP("PSB",$J,PSBWEEK,PSBORD,"AT",X+5)="     "_PSBRTXTW
"RTN","PSBOMH1",91,0)
 Q
"RTN","PSBOMH1",92,0)
 ;
"RTN","PSBOMH1",93,0)
DDAUD ;  proccess audits for dispense drugs
"RTN","PSBOMH1",94,0)
 ;
"RTN","PSBOMH1",95,0)
 M PSBMLA=^PSB(53.79,PSBIEN)
"RTN","PSBOMH1",96,0)
 S PSBGA="" I $D(PSBMLA(.9,0)) D
"RTN","PSBOMH1",97,0)
 .F PSBX=1:1 Q:'$D(PSBMLA(.9,PSBX))  I ((PSBMLA(.9,PSBX,0)["ACTION STATUS")!(PSBMLA(.9,PSBX,0)["ADMINISTRATION STATUS")) D  Q
"RTN","PSBOMH1",98,0)
 ..I $D(PSBMLA(.9,PSBX-2,0)) D DT^DILF("ENPST",$P(PSBMLA(.9,PSBX-2,0),"'",2),.PSBDATE)
"RTN","PSBOMH1",99,0)
 ..I '$D(PSBMLA(.9,PSBX-2,0)) S PSBDATE=$P(^PSB(53.79,PSBIEN,0),U,6)
"RTN","PSBOMH1",100,0)
 ..S PSBTMP(10000000-PSBDATE,"B")=PSBDATE_U_$$INITIAL^PSBRPC2($P(PSBMLA(0),U,5))_U_$P(PSBMLA(.9,PSBX,0),"'",2)
"RTN","PSBOMH1",101,0)
 ..S PSBGA=1
"RTN","PSBOMH1",102,0)
 .F PSBX=1:1 Q:'$D(PSBMLA(.9,PSBX))  I ((PSBMLA(.9,PSBX,0)["ACTION STATUS")!(PSBMLA(.9,PSBX,0)["ADMINISTRATION STATUS")) D
"RTN","PSBOMH1",103,0)
 ..S PSBTMP(10000000-$P(PSBMLA(.9,PSBX,0),U,1),"B")=$P(PSBMLA(.9,PSBX,0),U,1)_U_$$INITIAL^PSBRPC2($P(PSBMLA(.9,PSBX,0),U,2))_U_$P($P(PSBMLA(.9,PSBX,0),U,3),"'",2)
"RTN","PSBOMH1",104,0)
 ..S PSBGA=1
"RTN","PSBOMH1",105,0)
 I PSBGA'=1 S PSBTMP(10000000-$P(PSBMLA(0),U,6),"A")=$P(PSBMLA(0),U,6)_U_$$INITIAL^PSBRPC2($P(PSBMLA(0),U,7))
"RTN","PSBOMH1",106,0)
 S PSBQRY="PSBTMP",PSBCNT=1 F  S PSBQRY=$Q(@PSBQRY) Q:PSBQRY=""  D  ; does comment go with action
"RTN","PSBOMH1",107,0)
 .S PSBPQRY=$Q(@PSBQRY,-1)
"RTN","PSBOMH1",108,0)
 .I PSBPQRY="" S PSBTAR(PSBCNT)=@PSBQRY,PSBCNT=PSBCNT+1 Q  ; no previous action
"RTN","PSBOMH1",109,0)
 .I $QS(PSBPQRY,2)="C"  S PSBTAR(PSBCNT)=@PSBQRY,PSBCNT=PSBCNT+1 Q  ; previous line is a comment
"RTN","PSBOMH1",110,0)
 .I $QS(PSBQRY,2)="C",$E($P(@$Q(@PSBQRY,-1),U,1),1,12)=$E($P(@PSBQRY,U,1),1,12),$P(@$Q(@PSBQRY,-1),U,2)=$P(@PSBQRY,U,2) D  Q
"RTN","PSBOMH1",111,0)
 ..S X=$P(@PSBQRY,U,4) S:X[":" X=$P(X,":",2) S $P(PSBTAR(PSBCNT-1),U,4)=X Q
"RTN","PSBOMH1",112,0)
 .S PSBTAR(PSBCNT)=@PSBQRY,PSBCNT=PSBCNT+1
"RTN","PSBOMH1",113,0)
 Q
"RTN","PSBOMH2")
0^25^B22139777
"RTN","PSBOMH2",1,0)
PSBOMH2 ;BIRMINGHAM/EFC-MAH ;Mar 2004
"RTN","PSBOMH2",2,0)
 ;;3.0;BAR CODE MED ADMIN;;Mar 2004
"RTN","PSBOMH2",3,0)
 ;
"RTN","PSBOMH2",4,0)
 ; Reference/IA
"RTN","PSBOMH2",5,0)
 ; EN^PSJBCMA/2828
"RTN","PSBOMH2",6,0)
 ;
"RTN","PSBOMH2",7,0)
EN ;
"RTN","PSBOMH2",8,0)
 ; Okay, let's print this puppy
"RTN","PSBOMH2",9,0)
 S PSBWEEK=0
"RTN","PSBOMH2",10,0)
 F  S PSBWEEK=$O(^TMP("PSB",$J,PSBWEEK)) Q:'PSBWEEK  D
"RTN","PSBOMH2",11,0)
 .D:$D(^TMP("PSB",$J,PSBWEEK,"SORT","C"))
"RTN","PSBOMH2",12,0)
 ..D CONT
"RTN","PSBOMH2",13,0)
 ;
"RTN","PSBOMH2",14,0)
 ; Now the PRN/One Time/On-Call Sheets
"RTN","PSBOMH2",15,0)
 S PSBWEEK=0
"RTN","PSBOMH2",16,0)
 F  S PSBWEEK=$O(^TMP("PSB",$J,PSBWEEK)) Q:'PSBWEEK  D
"RTN","PSBOMH2",17,0)
 .D:$D(^TMP("PSB",$J,PSBWEEK,"SORT","P"))
"RTN","PSBOMH2",18,0)
 ..D PRN
"RTN","PSBOMH2",19,0)
 ;
"RTN","PSBOMH2",20,0)
 D LEGEND
"RTN","PSBOMH2",21,0)
 Q
"RTN","PSBOMH2",22,0)
CONT ;
"RTN","PSBOMH2",23,0)
 S PSBHDR(1)="Continuing/PRN/Stat/One Time Medication/Treatment Record (VAF 10-2970 B, C, D)"
"RTN","PSBOMH2",24,0)
 W $$HDR()
"RTN","PSBOMH2",25,0)
 S PSBDRUG=""
"RTN","PSBOMH2",26,0)
 F  S PSBDRUG=$O(^TMP("PSB",$J,PSBWEEK,"SORT","C",PSBDRUG)) Q:PSBDRUG=""  D
"RTN","PSBOMH2",27,0)
 .S PSBORD=""
"RTN","PSBOMH2",28,0)
 .F  S PSBORD=$O(^TMP("PSB",$J,PSBWEEK,"SORT","C",PSBDRUG,PSBORD)) Q:'PSBORD  D
"RTN","PSBOMH2",29,0)
 ..;S X="",PSBNAF=0 F  S X=$O(^TMP("PSB",$J,PSBWEEK,PSBORD,X)) Q:X=""  I ^TMP("PSB",$J,PSBWEEK,PSBORD,X,0)'=0 S PSBNAF=1  ; check for data
"RTN","PSBOMH2",30,0)
 ..;D CLEAN^PSBVT,PSJ1^PSBVT(DFN,PSBORD)
"RTN","PSBOMH2",31,0)
 ..;S X=PSBOST D H^%DTC S PSBOSTH=%H
"RTN","PSBOMH2",32,0)
 ..;S X=PSBOSP D H^%DTC S PSBOSPH=%H
"RTN","PSBOMH2",33,0)
 ..;I PSBNAF=0 Q
"RTN","PSBOMH2",34,0)
 ..;I PSBNAF=0,$G(PSBAR(PSBOSTH))'=PSBWEEK,$G(PSBAR(PSBOSPH))'=PSBWEEK Q  ; no data for this week and neither start or stop date is this week
"RTN","PSBOMH2",35,0)
 ..S PSBCNT=8
"RTN","PSBOMH2",36,0)
 ..S:$O(^TMP("PSB",$J,"ORDERS",PSBORD,"INST",""),-1)>PSBCNT PSBCNT=$O(^(""),-1)
"RTN","PSBOMH2",37,0)
 ..S:$O(^TMP("PSB",$J,"ORDERS",PSBORD,"AT",""),-1)>PSBCNT PSBCNT=$O(^(""),-1)
"RTN","PSBOMH2",38,0)
 ..W:$Y>(IOSL-PSBCNT-4) $$HDR()
"RTN","PSBOMH2",39,0)
 ..F PSBLINE=1:1:PSBCNT D
"RTN","PSBOMH2",40,0)
 ...W !,$G(^TMP("PSB",$J,"ORDERS",PSBORD,"INST",PSBLINE))
"RTN","PSBOMH2",41,0)
 ...W ?32,"| ",$G(^TMP("PSB",$J,"ORDERS",PSBORD,"AT",PSBLINE))
"RTN","PSBOMH2",42,0)
 ...S PSBDAY=0,PSBCOL=0
"RTN","PSBOMH2",43,0)
 ...F  S PSBDAY=$O(^TMP("PSB",$J,PSBWEEK,"HDR",PSBDAY)) Q:'PSBDAY  D
"RTN","PSBOMH2",44,0)
 ....W ?(40+(PSBCOL*13)),"| "
"RTN","PSBOMH2",45,0)
 ....S Y=$G(^TMP("PSB",$J,PSBWEEK,PSBORD,PSBDAY,PSBLINE))
"RTN","PSBOMH2",46,0)
 ....W $P(Y,U,3)
"RTN","PSBOMH2",47,0)
 ....W $E($P($P(Y,U,1)_"0000",".",2),1,4)," "
"RTN","PSBOMH2",48,0)
 ....W $P(Y,U,2)
"RTN","PSBOMH2",49,0)
 ....I $D(^TMP("PSB",$J,"ORDERS",PSBORD,"HOLD",PSBDAY)),(PSBLINE=PSBCNT) W "HOLD"  ;output hold status
"RTN","PSBOMH2",50,0)
 ....I '$D(^TMP("PSB",$J,"ORDERS",PSBORD,"DISC",PSBDAY))&'$D(^TMP("PSB",$J,"ORDERS",PSBORD,"HOLD",PSBDAY)) D
"RTN","PSBOMH2",51,0)
 .....I $D(^TMP("PSB",$J,"ORDERS",PSBORD,"NTDUE",PSBDAY)),(PSBLINE=PSBCNT) W "***"  ;write *** when day no due
"RTN","PSBOMH2",52,0)
 ....I $D(^TMP("PSB",$J,"ORDERS",PSBORD,"DISC",PSBDAY)),(PSBLINE=PSBCNT) W "***"   ;output discontinued status
"RTN","PSBOMH2",53,0)
 ....S PSBCOL=PSBCOL+1
"RTN","PSBOMH2",54,0)
 ..W !,$TR($J("",IOM)," ","-")
"RTN","PSBOMH2",55,0)
 Q
"RTN","PSBOMH2",56,0)
 ;
"RTN","PSBOMH2",57,0)
PRN ;
"RTN","PSBOMH2",58,0)
 S PSBHDR(1)="Continuing/PRN/Stat/One Time Medication/Treatment Record (VAF 10-2970 B, C, D)"
"RTN","PSBOMH2",59,0)
 W $$HDR(1)
"RTN","PSBOMH2",60,0)
 S PSBDRUG=""
"RTN","PSBOMH2",61,0)
 F  S PSBDRUG=$O(^TMP("PSB",$J,PSBWEEK,"SORT","P",PSBDRUG)) Q:PSBDRUG=""  D
"RTN","PSBOMH2",62,0)
 .S PSBORD=""
"RTN","PSBOMH2",63,0)
 .F  S PSBORD=$O(^TMP("PSB",$J,PSBWEEK,"SORT","P",PSBDRUG,PSBORD)) Q:'PSBORD  D
"RTN","PSBOMH2",64,0)
 ..S PSBCNT=$O(^TMP("PSB",$J,PSBWEEK,PSBORD,"AT",""),-1)
"RTN","PSBOMH2",65,0)
 ..D:PSBCNT<$O(^TMP("PSB",$J,"ORDERS",PSBORD,"INST",""),-1)
"RTN","PSBOMH2",66,0)
 ...S PSBCNT=$O(^TMP("PSB",$J,"ORDERS",PSBORD,"INST",""),-1)
"RTN","PSBOMH2",67,0)
 ..S:PSBCNT<8 PSBCNT=8  ; Minimum space for order
"RTN","PSBOMH2",68,0)
 ..W:$Y>(IOSL-PSBCNT-4) $$HDR(1)
"RTN","PSBOMH2",69,0)
 ..F PSBLINE=1:1:PSBCNT D
"RTN","PSBOMH2",70,0)
 ...W !,$G(^TMP("PSB",$J,"ORDERS",PSBORD,"INST",PSBLINE))
"RTN","PSBOMH2",71,0)
 ...W ?32,"| ",$G(^TMP("PSB",$J,PSBWEEK,PSBORD,"AT",PSBLINE))
"RTN","PSBOMH2",72,0)
 ..W !,$TR($J("",IOM)," ","-")
"RTN","PSBOMH2",73,0)
 Q
"RTN","PSBOMH2",74,0)
 ;
"RTN","PSBOMH2",75,0)
LEGEND  ;
"RTN","PSBOMH2",76,0)
 ;print the initials - name legend as an extra page  ;
"RTN","PSBOMH2",77,0)
 ;I '$D(^TMP("PSB",$J,"LEGEND")) K ^TMP("PSJ",$J),^TMP("PSB",$J) Q  ;
"RTN","PSBOMH2",78,0)
 D PT^PSBOHDR(DFN,.PSBHDR)  ;
"RTN","PSBOMH2",79,0)
 W !!,"Initial - Name Legend",!  ;
"RTN","PSBOMH2",80,0)
 I $D(^TMP("PSB",$J,"LEGEND"))  D
"RTN","PSBOMH2",81,0)
 .S X=$Q(^TMP("PSB",$J,"LEGEND",""))
"RTN","PSBOMH2",82,0)
 .F  W $S($QS(X,4)[99:"",1:$QS(X,4)),?10,$QS(X,5),! S X=$Q(@X) Q:$QS(X,3)'="LEGEND"  ;
"RTN","PSBOMH2",83,0)
 W !!,"Status Codes",!,"C - Completed",!,"G - Given",!,"H - Held",!,"I - Infusing",!,"M - Missing Dose Requested",!,"R - Refused",!,"RM - Removed",!,"S - Stopped",!,"*** - Medication Not Due",!  ;
"RTN","PSBOMH2",84,0)
 K ^TMP("PSJ",$J),^TMP("PSB",$J)
"RTN","PSBOMH2",85,0)
 Q
"RTN","PSBOMH2",86,0)
 ;
"RTN","PSBOMH2",87,0)
HDR(PRN)   ;
"RTN","PSBOMH2",88,0)
 ; PRN = TRUE IF DISPLAYING PRN MED (OPTIONAL)
"RTN","PSBOMH2",89,0)
 D PT^PSBOHDR(DFN,.PSBHDR)
"RTN","PSBOMH2",90,0)
 W !,"Start Date",?20,"Stop Date",?32,"| ",$S('$G(PRN):"Admin",1:"Action Status")
"RTN","PSBOMH2",91,0)
 I '$G(PRN) F X=0:1:6 W ?(40+(X*13)),"|"
"RTN","PSBOMH2",92,0)
 W !,"and Time",?20,"and Time",?32,"| ",$S('$G(PRN):"Times",1:"Action Date/Times")
"RTN","PSBOMH2",93,0)
 D:'$G(PRN)
"RTN","PSBOMH2",94,0)
 .S PSBCOL=0,X=0 F  S X=$O(^TMP("PSB",$J,PSBWEEK,"HDR",X)) Q:'X  D
"RTN","PSBOMH2",95,0)
 ..W ?(40+(PSBCOL*13)),"| ",$E(X,4,5),"/",$E(X,6,7),"/",(1700+$E(X,1,3))
"RTN","PSBOMH2",96,0)
 ..S PSBCOL=PSBCOL+1
"RTN","PSBOMH2",97,0)
 D:$G(PRN)
"RTN","PSBOMH2",98,0)
 .W ?76,"PRN Reason"
"RTN","PSBOMH2",99,0)
 W !,$TR($J("",IOM)," ","-")
"RTN","PSBOMH2",100,0)
 Q ""
"RTN","PSBOML")
0^26^B31969332
"RTN","PSBOML",1,0)
PSBOML ;BIRMINGHAM/EFC-MEDICATION LOG ;Mar 2004
"RTN","PSBOML",2,0)
 ;;3.0;BAR CODE MED ADMIN;;Mar 2004
"RTN","PSBOML",3,0)
 ;
"RTN","PSBOML",4,0)
 ; Reference/IA
"RTN","PSBOML",5,0)
 ; ^DPT/10035
"RTN","PSBOML",6,0)
 ;
"RTN","PSBOML",7,0)
 ;
"RTN","PSBOML",8,0)
EN ; Begin printing
"RTN","PSBOML",9,0)
 N PSBSTRT,PSBSTOP,PSBHDR,DFN
"RTN","PSBOML",10,0)
 S PSBSTRT=$P(PSBRPT(.1),U,6)+$P(PSBRPT(.1),U,7)
"RTN","PSBOML",11,0)
 S PSBSTOP=$P(PSBRPT(.1),U,8)+$P(PSBRPT(.1),U,9)
"RTN","PSBOML",12,0)
 S PSBAUDF=$P(PSBRPT(.2),U,9)
"RTN","PSBOML",13,0)
 S PSBHDR(0)="Medication Log Report"
"RTN","PSBOML",14,0)
 S PSBHDR(1)="Continuing/PRN/Stat/One Time Medication/Treatment Record (Detailed Log) (VAF 10-2970 B, C, D)"
"RTN","PSBOML",15,0)
 ;
"RTN","PSBOML",16,0)
 ; Patient Report
"RTN","PSBOML",17,0)
 ;
"RTN","PSBOML",18,0)
 D:$P(PSBRPT(.1),U,1)="P"
"RTN","PSBOML",19,0)
 .S PSBHDR(2)="Log Type: INDIVIDUAL PATIENT"
"RTN","PSBOML",20,0)
 .S DFN=+$P(PSBRPT(.1),U,2)
"RTN","PSBOML",21,0)
 .W $$PTHDR()
"RTN","PSBOML",22,0)
 .S X=$O(^PSB(53.79,"AADT",DFN,PSBSTRT-.0000001))
"RTN","PSBOML",23,0)
 .I X>PSBSTOP!(X="") W !!?10,"<<<< NO MEDICATIONS FOUND FOR THIS TIME FRAME >>>>",!! Q
"RTN","PSBOML",24,0)
 .S PSBGBL=$NAME(^PSB(53.79,"AADT",DFN,PSBSTRT-.0000001))
"RTN","PSBOML",25,0)
 .F  S PSBGBL=$Q(@PSBGBL) Q:PSBGBL=""  Q:$QS(PSBGBL,2)'="AADT"!($QS(PSBGBL,3)'=DFN)!($QS(PSBGBL,4)>PSBSTOP)  D
"RTN","PSBOML",26,0)
 ..S PSBIEN=$QS(PSBGBL,5) Q:'$D(^PSB(53.79,PSBIEN))
"RTN","PSBOML",27,0)
 ..I $P(^PSB(53.79,PSBIEN,0),U,6)'=$QS(PSBGBL,4) Q
"RTN","PSBOML",28,0)
 ..I $Y>(IOSL-10) W $$PTFTR^PSBOHDR(),$$PTHDR()
"RTN","PSBOML",29,0)
 ..W $$LINE(PSBIEN)
"RTN","PSBOML",30,0)
 .W $$PTFTR^PSBOHDR()
"RTN","PSBOML",31,0)
 ;
"RTN","PSBOML",32,0)
 ; Ward Output
"RTN","PSBOML",33,0)
 ;
"RTN","PSBOML",34,0)
 D:$P(PSBRPT(.1),U,1)="W"
"RTN","PSBOML",35,0)
 .S PSBHDR(2)="LOG TYPE: WARD"
"RTN","PSBOML",36,0)
 .W $$WDHDR(PSBWRD)
"RTN","PSBOML",37,0)
 .S PSBTMPG=$NAME(^TMP("PSBO",$J,"B"))
"RTN","PSBOML",38,0)
 .F  S PSBTMPG=$Q(@PSBTMPG) Q:PSBTMPG=""  Q:$QS(PSBTMPG,1)'="PSBO"!($QS(PSBTMPG,2)'=$J)  D
"RTN","PSBOML",39,0)
 ..S DFN=$QS(PSBTMPG,5)
"RTN","PSBOML",40,0)
 ..I $Y>(IOSL-14) W $$WDHDR(PSBWRD)
"RTN","PSBOML",41,0)
 ..W !,$P(^DPT(DFN,0),U),"  (",$P(^(0),U,9),")"
"RTN","PSBOML",42,0)
 ..W !,"Ward: ",$G(^DPT(DFN,.1),"***"),"  Rm-Bed: ",$G(^DPT(DFN,.101),"***"),!
"RTN","PSBOML",43,0)
 ..S X=$O(^PSB(53.79,"AADT",DFN,PSBSTRT-.0000001))
"RTN","PSBOML",44,0)
 ..I X>PSBSTOP!(X="") W !!?10,"<<<< NO MEDICATIONS FOUND FOR THIS TIME FRAME >>>>",!! Q
"RTN","PSBOML",45,0)
 ..S PSBGBL=$NAME(^PSB(53.79,"AADT",DFN,PSBSTRT-.0000001))
"RTN","PSBOML",46,0)
 ..F  S PSBGBL=$Q(@PSBGBL) Q:PSBGBL=""  Q:$QS(PSBGBL,2)'="AADT"!($QS(PSBGBL,3)'=DFN)!($QS(PSBGBL,4)>PSBSTOP)  D
"RTN","PSBOML",47,0)
 ...S PSBIEN=$QS(PSBGBL,5) I $P(^PSB(53.79,PSBIEN,0),U,6)'=$QS(PSBGBL,4) Q
"RTN","PSBOML",48,0)
 ...W:$Y>(IOSL-10) $$WDHDR(PSBWRD)
"RTN","PSBOML",49,0)
 ...W $$LINE(PSBIEN)
"RTN","PSBOML",50,0)
 Q
"RTN","PSBOML",51,0)
 ;
"RTN","PSBOML",52,0)
LINE(PSBIEN) ; Displays the med log entry in PSBIEN
"RTN","PSBOML",53,0)
 N PSBX,PSBASTUS
"RTN","PSBOML",54,0)
 S X=$P($G(^PSB(53.79,PSBIEN,.1)),U)
"RTN","PSBOML",55,0)
 I X="" W !,"Error: Med Log Entry ",PSBIEN," has no order reference number!" Q ""
"RTN","PSBOML",56,0)
 I 'PSBAUDF,$P(^PSB(53.79,PSBIEN,0),U,9)="N" Q ""
"RTN","PSBOML",57,0)
 D CLEAN^PSBVT
"RTN","PSBOML",58,0)
 D PSJ1^PSBVT(DFN,X)
"RTN","PSBOML",59,0)
 I PSBDFN="-1" W !,"Error: Inpatient Meds API Failure!" Q ""
"RTN","PSBOML",60,0)
 M PSBX=^PSB(53.79,PSBIEN)
"RTN","PSBOML",61,0)
 S Y=$P(PSBX(0),U,4)+.0000001
"RTN","PSBOML",62,0)
 W !,$E(Y,4,5),"/",$E(Y,6,7),"/",$E(Y,2,3)
"RTN","PSBOML",63,0)
 W " ",$E(Y,9,10),":",$E(Y,11,12)
"RTN","PSBOML",64,0)
 S Y=$$GET1^DIQ(53.79,PSBIEN_",",.08)
"RTN","PSBOML",65,0)
 S Y=Y_" ["_PSBDOSE_PSBIFR_" "_PSBSCH
"RTN","PSBOML",66,0)
 S Y=Y_" "_PSBMRAB
"RTN","PSBOML",67,0)
 S:$P($G(^PSB(53.79,PSBIEN,.1)),U,6)]"" Y=Y_" Inj Site: "_$P(^(.1),U,6)
"RTN","PSBOML",68,0)
 S Y=Y_"]"
"RTN","PSBOML",69,0)
 W $$WRAP^PSBO(16,32,Y)
"RTN","PSBOML",70,0)
 W ?50,$$GET1^DIQ(53.79,PSBIEN_",","ACTION BY:INITIAL")
"RTN","PSBOML",71,0)
 S X=$P(PSBX(0),U,9)
"RTN","PSBOML",72,0)
 S PSBASTUS=$S(X="G":"Given",X="H":"Held",X="R":"Refused",X="I":"Infusing",X="C":"Completed",X="S":"Stopped",X="N":"Not Given",X="RM":"Removed",X="M":"Missing dose",1:"Status Missing")
"RTN","PSBOML",73,0)
 S Y=$P(PSBX(0),U,6)+.0000001
"RTN","PSBOML",74,0)
 S Y=$E(Y,4,5)_"/"_$E(Y,6,7)_"/"_$E(Y,2,3)_" "_$E(Y,9,10)_":"_$E(Y,11,12)
"RTN","PSBOML",75,0)
 S Y=Y_" "_PSBASTUS
"RTN","PSBOML",76,0)
 W $$WRAP^PSBO(57,15,Y)
"RTN","PSBOML",77,0)
 W:$P(PSBX(.1),U)["V" ?75,"Bag ID #",$$GET1^DIQ(53.79,PSBIEN,"IV UNIQUE ID")
"RTN","PSBOML",78,0)
 W:$P(PSBX(.1),U)["V" ?107,"NA",?115,"NA",?120,"NA"
"RTN","PSBOML",79,0)
 W !,$TR($$FMTE^XLFDT(PSBOST,2),"@"," ")_">"
"RTN","PSBOML",80,0)
 F PSBZ=.5,.6,.7 S PSBDHIT=0 F PSBY=0:0 S PSBY=$O(PSBX(PSBZ,PSBY)) Q:'PSBY  D
"RTN","PSBOML",81,0)
 .W:$X>75 !
"RTN","PSBOML",82,0)
 .S PSBDD=$S(PSBZ=.5:53.795,PSBZ=.6:53.796,1:53.797)
"RTN","PSBOML",83,0)
 .S Y=$$EXTERNAL^DILFD(PSBDD,.01,"",$P(PSBX(PSBZ,PSBY,0),U,1))
"RTN","PSBOML",84,0)
 .W $$WRAP^PSBO(75,28,Y)
"RTN","PSBOML",85,0)
 .I $P(PSBX(.1),U)["U" W ?105,$J($P(PSBX(PSBZ,PSBY,0),U,2),6,2),?113,$J($P(PSBX(PSBZ,PSBY,0),U,3),6,2) I 'PSBDHIT W $$WRAP^PSBO(120,12,$P(PSBX(PSBZ,PSBY,0),U,4)) S PSBDHIT=1
"RTN","PSBOML",86,0)
 .W:$P(PSBX(.1),U)["V"&($X+3+$L($P(PSBX(PSBZ,PSBY,0),U,3))>105) !?75
"RTN","PSBOML",87,0)
 .W:$P(PSBX(.1),U)["V" " - ",$P(PSBX(PSBZ,PSBY,0),U,3)
"RTN","PSBOML",88,0)
 D:$P($G(^PSB(53.79,PSBIEN,.1)),U,2)="P"
"RTN","PSBOML",89,0)
 .W !?16,"PRN Reason: ",?30,$$GET1^DIQ(53.79,PSBIEN_",",.21)
"RTN","PSBOML",90,0)
 .W !?16,"PRN Effectiveness: "
"RTN","PSBOML",91,0)
 .I $P($G(^PSB(53.79,PSBIEN,.2)),U,2)="" W "<No PRN Effectiveness Entered>" Q
"RTN","PSBOML",92,0)
 .W $$WRAP^PSBO(20,100,$$GET1^DIQ(53.79,PSBIEN_",",.22))
"RTN","PSBOML",93,0)
 .W !?20,"Entered By: ",$$GET1^DIQ(53.79,PSBIEN_",",.23)
"RTN","PSBOML",94,0)
 .W " Date/Time: ",$$GET1^DIQ(53.79,PSBIEN_",",.24)
"RTN","PSBOML",95,0)
 .W " Minutes: ",$$GET1^DIQ(53.79,PSBIEN_",",.25)
"RTN","PSBOML",96,0)
 D:$P(PSBRPT(.2),U,8)
"RTN","PSBOML",97,0)
 .W !?16,"Comments: ",?30 I '$O(PSBX(.3,0)) W "<No Comments>"
"RTN","PSBOML",98,0)
 .F PSBY=0:0 S PSBY=$O(PSBX(.3,PSBY)) Q:'PSBY  D
"RTN","PSBOML",99,0)
 ..W:$X>30 !?30
"RTN","PSBOML",100,0)
 ..S Y=$P(PSBX(.3,PSBY,0),U,3)+.0000001
"RTN","PSBOML",101,0)
 ..W $E(Y,4,5),"/",$E(Y,6,7),"/",$E(Y,2,3)
"RTN","PSBOML",102,0)
 ..W " ",$E(Y,9,10),":",$E(Y,11,12)
"RTN","PSBOML",103,0)
 ..W ?46,$$GET1^DIQ(53.793,PSBY_","_PSBIEN_",","ENTERED BY:INITIAL")
"RTN","PSBOML",104,0)
 ..W $$WRAP^PSBO(52,70,$P(PSBX(.3,PSBY,0),U,1))
"RTN","PSBOML",105,0)
 W !,$TR($$FMTE^XLFDT(PSBOSP,2),"@"," ")_"<"
"RTN","PSBOML",106,0)
 D:PSBAUDF
"RTN","PSBOML",107,0)
 .W !?16,"Audits: ",?30 I '$O(PSBX(.9,0)) W "<No Audits>" Q
"RTN","PSBOML",108,0)
 .F PSBY=0:0 S PSBY=$O(PSBX(.9,PSBY)) Q:'PSBY  D
"RTN","PSBOML",109,0)
 ..W:$X>30 !?30
"RTN","PSBOML",110,0)
 ..S Y=$P(PSBX(.9,PSBY,0),U,1)+.0000001
"RTN","PSBOML",111,0)
 ..W $E(Y,4,5),"/",$E(Y,6,7),"/",$E(Y,2,3)
"RTN","PSBOML",112,0)
 ..W " ",$E(Y,9,10),":",$E(Y,11,12)
"RTN","PSBOML",113,0)
 ..W ?46,$$GET1^DIQ(53.799,PSBY_","_PSBIEN_",","USER:INITIAL")
"RTN","PSBOML",114,0)
 ..W $$WRAP^PSBO(52,70,$P(PSBX(.9,PSBY,0),U,3))
"RTN","PSBOML",115,0)
 W !,$TR($J("",IOM)," ","-")
"RTN","PSBOML",116,0)
 Q ""
"RTN","PSBOML",117,0)
 ;
"RTN","PSBOML",118,0)
WDHDR(PSBWARD) ;
"RTN","PSBOML",119,0)
 D WARD^PSBOHDR(PSBWARD,.PSBHDR)
"RTN","PSBOML",120,0)
 W $$SUB()
"RTN","PSBOML",121,0)
 Q ""
"RTN","PSBOML",122,0)
 ;
"RTN","PSBOML",123,0)
PTHDR() ;
"RTN","PSBOML",124,0)
 D PT^PSBOHDR(DFN,.PSBHDR)
"RTN","PSBOML",125,0)
 W $$SUB()
"RTN","PSBOML",126,0)
 Q ""
"RTN","PSBOML",127,0)
 ;
"RTN","PSBOML",128,0)
SUB() ; Med Log Sub Header
"RTN","PSBOML",129,0)
 W:$X>1 !
"RTN","PSBOML",130,0)
 W "Activity Date",?16,"Orderable Item",?50,"Action",?57,"Action"
"RTN","PSBOML",131,0)
 W !,"Start Date>",?16,"[Dose/Sched/Route/Inj Site]",?50,"By"
"RTN","PSBOML",132,0)
 W ?57,"Date/Time",?75,"Drug/Additive/Solution",?105," U/Ord"
"RTN","PSBOML",133,0)
 W ?113," U/Gvn",?120,"Unit",!,"Stop Date<"
"RTN","PSBOML",134,0)
 W !,$TR($J("",IOM)," ","-")
"RTN","PSBOML",135,0)
 Q ""
"RTN","PSBOML",136,0)
 ;
"RTN","PSBOMM")
0^27^B85447995
"RTN","PSBOMM",1,0)
PSBOMM ;BIRMINGHAM/EFC-MISSED MEDS ;Mar 2004
"RTN","PSBOMM",2,0)
 ;;3.0;BAR CODE MED ADMIN;;Mar 2004
"RTN","PSBOMM",3,0)
 ;
"RTN","PSBOMM",4,0)
 ; Reference/IA
"RTN","PSBOMM",5,0)
 ; ^DPT/10035
"RTN","PSBOMM",6,0)
 ; EN^PSJBCMA/2828
"RTN","PSBOMM",7,0)
 ; EN^PSJBCMA2/2830
"RTN","PSBOMM",8,0)
 ;
"RTN","PSBOMM",9,0)
EN ; Called from DQ^PSBO
"RTN","PSBOMM",10,0)
 N PSBSTRT,PSBSTOP,DFN,PSBODATE,PSBFLAG,PSBCNT
"RTN","PSBOMM",11,0)
 K ^TMP("PSJ",$J),^TMP("PSB",$J),^TMP("PSB1",$J)
"RTN","PSBOMM",12,0)
 S PSBSTRT=$P(PSBRPT(.1),U,6)+$P(PSBRPT(.1),U,7)-.0000001
"RTN","PSBOMM",13,0)
 S PSBSTOP=$P(PSBRPT(.1),U,6)+$P(PSBRPT(.1),U,9)
"RTN","PSBOMM",14,0)
 S PSBODATE=$P(PSBRPT(.1),U,6)
"RTN","PSBOMM",15,0)
 F DFN=0:0 S DFN=$O(^TMP("PSBO",$J,DFN)) Q:'DFN  D EN1
"RTN","PSBOMM",16,0)
 D PRINT
"RTN","PSBOMM",17,0)
 K ^TMP("PSJ",$J),^TMP("PSB",$J),^TMP("PSBO",$J)
"RTN","PSBOMM",18,0)
 Q
"RTN","PSBOMM",19,0)
 ;
"RTN","PSBOMM",20,0)
EN1 ; Expects DFN,PSBSTRT,PSBSTOP from EN
"RTN","PSBOMM",21,0)
 N PSBGBL,PSBHDR,PSBX,PSBDFN,PSBDT,PSBEVDT,PSBHOUR
"RTN","PSBOMM",22,0)
 K ^TMP("PSJ",$J) S PSBEVDT=PSBSTRT
"RTN","PSBOMM",23,0)
 D EN^PSJBCMA(DFN,PSBSTRT)
"RTN","PSBOMM",24,0)
 Q:^TMP("PSJ",$J,1,0)=-1
"RTN","PSBOMM",25,0)
 S PSBX=""
"RTN","PSBOMM",26,0)
 F  S PSBX=$O(^TMP("PSJ",$J,PSBX)) Q:PSBX=""  D
"RTN","PSBOMM",27,0)
 .Q:^TMP("PSJ",$J,PSBX,0)=-1  ; No Orders
"RTN","PSBOMM",28,0)
 .D CLEAN^PSBVT
"RTN","PSBOMM",29,0)
 .D PSJ^PSBVT(PSBX)
"RTN","PSBOMM",30,0)
 .Q:PSBIVT="A"  ; No Admix or Hyp.
"RTN","PSBOMM",31,0)
 .Q:PSBIVT="H"
"RTN","PSBOMM",32,0)
 .I PSBIVT["S",PSBISYR'=1 Q  ;    allow intermittent syringe only
"RTN","PSBOMM",33,0)
 .I PSBIVT["C",PSBCHEMT'="P",PSBISYR'=1 Q
"RTN","PSBOMM",34,0)
 .I PSBIVT["C",PSBCHEMT="A" Q  ;     allow Chemo with intermittent syringe or Piggyback type only
"RTN","PSBOMM",35,0)
 .Q:PSBONX["P"  ;no pending orders
"RTN","PSBOMM",36,0)
 .I PSBSCHT="C" D  Q  ; Only Continuous
"RTN","PSBOMM",37,0)
 ..S (PSBYES,PSBODD)=0
"RTN","PSBOMM",38,0)
 ..S PSBDOW="SU^MO^TU^WE^TH^FR^SA" F I=1:1:7 I $P(PSBDOW,"^",I)=$E(PSBSCH,1,2) S PSBYES=1
"RTN","PSBOMM",39,0)
 ..I PSBYES,PSBADST="" Q
"RTN","PSBOMM",40,0)
 ..F I=1:1 Q:$P(PSBSCH,"-",I)=""  I $P(PSBSCH,"-",I)?2N!($P(PSBSCH,"-",I)?4N) S PSBYES=1
"RTN","PSBOMM",41,0)
 ..S PSBFREQ=$$GETFREQ^PSBVDLU1(DFN,PSBONX)
"RTN","PSBOMM",42,0)
 ..I PSBFREQ="O" S PSBYES=1
"RTN","PSBOMM",43,0)
 ..I 'PSBYES,PSBADST="",PSBFREQ<1 Q
"RTN","PSBOMM",44,0)
 ..I (PSBFREQ#1440'=0),(1440#PSBFREQ'=0) S PSBODD=1
"RTN","PSBOMM",45,0)
 ..I PSBODD,PSBADST'="" Q
"RTN","PSBOMM",46,0)
 ..Q:PSBOSTS["D"  ;Discontinued
"RTN","PSBOMM",47,0)
 ..Q:PSBNGF  ; Marked DO NOT GIVE
"RTN","PSBOMM",48,0)
 ..Q:PSBOSTS="N"
"RTN","PSBOMM",49,0)
 ..Q:PSBSM  ;Self med
"RTN","PSBOMM",50,0)
 ..S PSBCADM=0
"RTN","PSBOMM",51,0)
 ..I PSBADST="" S PSBADST=$$GETADMIN^PSBVDLU1(DFN,PSBONX,PSBOST,PSBFREQ,PSBEVDT) Q:PSBADST=""  S PSBCADM=1
"RTN","PSBOMM",52,0)
 ..E  K ^TMP("PSB",$J,"GETADMIN") S ^TMP("PSB",$J,"GETADMIN",0)=PSBADST
"RTN","PSBOMM",53,0)
 ..;Invalid admin times
"RTN","PSBOMM",54,0)
 ..F Y=1:1:$L(PSBADST,"-") D
"RTN","PSBOMM",55,0)
 ...Q:($P(PSBADST,"-",Y)'?2N)&($P(PSBADST,"-",Y)'?4N)
"RTN","PSBOMM",56,0)
 ..; Below is (Order Start Date, Report Date, Schedule)
"RTN","PSBOMM",57,0)
 ..Q:'$$OKAY^PSBVDLU1(PSBOST,PSBODATE,PSBSCH,PSBONX,$P(^TMP("PSJ",$J,PSBX,3),U,2),PSBFREQ,PSBOSTS)  ; Screens QOD type stuff
"RTN","PSBOMM",58,0)
 ..K PSBOACTL,TMP("PSB1",$J) D EN^PSJBCMA2(DFN,PSBONX,1) I ^TMP("PSJ2",$J,0)'=1 M PSBOACTL=^TMP("PSJ2",$J) K ^TMP("PSJ2",$J)
"RTN","PSBOMM",59,0)
 ..F PSBXX=0:1 Q:'$D(^TMP("PSB",$J,"GETADMIN",PSBXX))  S PSBADST=$G(^TMP("PSB",$J,"GETADMIN",PSBXX)) D
"RTN","PSBOMM",60,0)
 ...F Y=1:1:$L(PSBADST,"-") D
"RTN","PSBOMM",61,0)
 ....S PSBDT=+("."_$P(PSBADST,"-",Y))+(PSBSTRT\1)
"RTN","PSBOMM",62,0)
 ....Q:PSBDT<PSBOST  ; Order Start Date
"RTN","PSBOMM",63,0)
 ....Q:PSBDT'<PSBOSP  ; Order Stop Date
"RTN","PSBOMM",64,0)
 ....Q:PSBDT<PSBSTRT  ; Report Window
"RTN","PSBOMM",65,0)
 ....Q:PSBDT>PSBSTOP  ; Report Window
"RTN","PSBOMM",66,0)
 ....I $D(^PSB(53.79,"AORD",DFN,PSBONX,PSBDT)) D  I PSBSTUS'="N",PSBSTUS'="M" Q  ; If it is on the log quit continue if status is "NOT GIVEN" or "MISSING"
"RTN","PSBOMM",67,0)
 .....S PSBINDX=$O(^PSB(53.79,"AORD",DFN,PSBONX,PSBDT,"")),PSBSTUS=$P(^PSB(53.79,PSBINDX,0),U,9)
"RTN","PSBOMM",68,0)
 ....S ^TMP("PSB",$J,DFN,PSBDT,PSBOITX,PSBONX)=""
"RTN","PSBOMM",69,0)
 ....D UDCONT
"RTN","PSBOMM",70,0)
 ....I PSBFLAG=1 S ^TMP("PSB",$J,DFN,PSBDT,PSBOITX,PSBONX)="(On Hold) "_$$FMTE^XLFDT(PSBHDDT)
"RTN","PSBOMM",71,0)
 ....I PSBFLAG=2 S ^TMP("PSB",$J,DFN,PSBDT,PSBOITX,PSBONX)="(On Hold) "_$$FMTE^XLFDT(PSBHDDT)_"  "_"(Off Hold) "_$$FMTE^XLFDT(PSBUNHD) Q
"RTN","PSBOMM",72,0)
 .K PSBHDDT,PSBUNHD,^TMP("PSB1",$J)
"RTN","PSBOMM",73,0)
 .I PSBSCHT="O" D  Q
"RTN","PSBOMM",74,0)
 ..Q:PSBOSTS["D"!(PSBOSTS="N")  ; Discontinued
"RTN","PSBOMM",75,0)
 ..Q:PSBNGF  ; Marked DO NOT GIVE
"RTN","PSBOMM",76,0)
 ..Q:PSBSM  ;Self med
"RTN","PSBOMM",77,0)
 ..; Is the One Time Given?
"RTN","PSBOMM",78,0)
 ..Q:PSBOSP=PSBOST   ;Expired one-time
"RTN","PSBOMM",79,0)
 ..Q:PSBOST'<PSBSTOP
"RTN","PSBOMM",80,0)
 ..Q:PSBOSP<PSBSTRT
"RTN","PSBOMM",81,0)
 ..S (PSBGVN,X,Y)=""
"RTN","PSBOMM",82,0)
 ..F  S X=$O(^PSB(53.79,"AOIP",DFN,PSBOIT,X),-1) Q:'X  D
"RTN","PSBOMM",83,0)
 ...F  S Y=$O(^PSB(53.79,"AOIP",DFN,PSBOIT,X,Y),-1) Q:'Y  D
"RTN","PSBOMM",84,0)
 ....I $P(^PSB(53.79,Y,.1),U)=PSBONX,$P(^PSB(53.79,Y,0),U,9)'="N",$P(^PSB(53.79,Y,0),U,9)'="M" S PSBGVN=1,(X,Y)=0
"RTN","PSBOMM",85,0)
 ..; How long does One Time remain on the this report ??
"RTN","PSBOMM",86,0)
 ..D NOW^%DTC
"RTN","PSBOMM",87,0)
 ..S PSBRMN=1
"RTN","PSBOMM",88,0)
 ..I PSBSCHT="O",PSBOSP'=PSBOST&(%>PSBOSP) S PSBRMN=0
"RTN","PSBOMM",89,0)
 ..D:('PSBGVN)&(PSBRMN)
"RTN","PSBOMM",90,0)
 ...S VAR=""
"RTN","PSBOMM",91,0)
 ...K ^TMP("PSJ2",$J),^TMP("PSB1",$J),PSBOACTL D EN^PSJBCMA2(DFN,PSBONX,1) I ^TMP("PSJ2",$J,0)'=1 D
"RTN","PSBOMM",92,0)
 ....M PSBOACTL=^TMP("PSJ2",$J)
"RTN","PSBOMM",93,0)
 ....D UDONE
"RTN","PSBOMM",94,0)
 ....I PSBFLAG=1 S VAR="(On Hold) "_$$FMTE^XLFDT(PSBHDDT)
"RTN","PSBOMM",95,0)
 ....I PSBFLAG=2 S VAR="(On Hold) "_$$FMTE^XLFDT(PSBHDDT)_"  (Off Hold) "_$$FMTE^XLFDT(PSBUNHD)
"RTN","PSBOMM",96,0)
 ...S VAR=VAR_U_$TR($$FMTE^XLFDT(PSBOST,2),"@"," ")
"RTN","PSBOMM",97,0)
 ...S VAR=VAR_U_$TR($$FMTE^XLFDT(PSBOSP,2),"@"," ")
"RTN","PSBOMM",98,0)
 ...S $P(^TMP("PSB",$J,DFN,"*** ONE-TIME ***",PSBOITX,PSBONX),U,1,4)=VAR
"RTN","PSBOMM",99,0)
 ...K PSBHDDT,PSBUNHD,^TMP("PSB1",$J),PSBCNT
"RTN","PSBOMM",100,0)
 K PSBOACTL
"RTN","PSBOMM",101,0)
 Q
"RTN","PSBOMM",102,0)
 ;
"RTN","PSBOMM",103,0)
PRINT ; Print meds stored in ^TMP("PSB",$J,DFN,....
"RTN","PSBOMM",104,0)
 N PSBHDR,PSBDT,PSBOITX,PSBONX,DFN
"RTN","PSBOMM",105,0)
 ;
"RTN","PSBOMM",106,0)
 ; Print by Patient
"RTN","PSBOMM",107,0)
 ;
"RTN","PSBOMM",108,0)
 D:$P(PSBRPT(.1),U,1)="P"
"RTN","PSBOMM",109,0)
 .S PSBHDR(1)="MISSED MEDICATIONS  from "_$$FMTE^XLFDT($P(PSBRPT(.1),U,6)+$P(PSBRPT(.1),U,7))_" thru "_$$FMTE^XLFDT($P(PSBRPT(.1),U,6)+$P(PSBRPT(.1),U,9))
"RTN","PSBOMM",110,0)
 .S DFN=$P(PSBRPT(.1),U,2)
"RTN","PSBOMM",111,0)
 .W $$PTHDR()
"RTN","PSBOMM",112,0)
 .I $O(^TMP("PSB",$J,DFN,""))="" W !,"No Missed Medications Found",$$PTFTR^PSBOHDR() Q
"RTN","PSBOMM",113,0)
 .S PSBDT=""
"RTN","PSBOMM",114,0)
 .F  S PSBDT=$O(^TMP("PSB",$J,DFN,PSBDT)) Q:PSBDT=""  D
"RTN","PSBOMM",115,0)
 ..W !  ; Line Break Between Admin Times
"RTN","PSBOMM",116,0)
 ..S PSBOITX=""
"RTN","PSBOMM",117,0)
 ..F  S PSBOITX=$O(^TMP("PSB",$J,DFN,PSBDT,PSBOITX)) Q:PSBOITX=""  D
"RTN","PSBOMM",118,0)
 ...S PSBONX=""
"RTN","PSBOMM",119,0)
 ...F  S PSBONX=$O(^TMP("PSB",$J,DFN,PSBDT,PSBOITX,PSBONX)) Q:PSBONX=""  D
"RTN","PSBOMM",120,0)
 ....I $Y>(IOSL-5) W $$PTFTR^PSBOHDR(),$$PTHDR()
"RTN","PSBOMM",121,0)
 ....W !,+PSBONX,$S(PSBONX["U":"UD",PSBONX["V":"IV",1:"")
"RTN","PSBOMM",122,0)
 ....I PSBDT["ONE-TIME" D  Q
"RTN","PSBOMM",123,0)
 .....W ?12,PSBDT,?38,PSBOITX
"RTN","PSBOMM",124,0)
 .....W !,?38,$P(^TMP("PSB",$J,DFN,PSBDT,PSBOITX,PSBONX),U,1)
"RTN","PSBOMM",125,0)
 .....W !,"Start Date/Time: ",?16,$P(^TMP("PSB",$J,DFN,PSBDT,PSBOITX,PSBONX),U,2)
"RTN","PSBOMM",126,0)
 .....W !,"Stop Date/Time:  ",?16,$P(^TMP("PSB",$J,DFN,PSBDT,PSBOITX,PSBONX),U,3)
"RTN","PSBOMM",127,0)
 .....W !
"RTN","PSBOMM",128,0)
 ....W ?12,$S(PSBDT:$$FMTE^XLFDT(PSBDT),1:PSBDT),?38,PSBOITX
"RTN","PSBOMM",129,0)
 ....W !,?38,^TMP("PSB",$J,DFN,PSBDT,PSBOITX,PSBONX)
"RTN","PSBOMM",130,0)
 .W $$PTFTR^PSBOHDR()
"RTN","PSBOMM",131,0)
 .Q
"RTN","PSBOMM",132,0)
 ;
"RTN","PSBOMM",133,0)
 ; Print by Ward
"RTN","PSBOMM",134,0)
 ;
"RTN","PSBOMM",135,0)
 D:$P(PSBRPT(.1),U,1)="W"
"RTN","PSBOMM",136,0)
 .S PSBHDR(1)="MISSED MEDICATIONS  from "_$$FMTE^XLFDT($P(PSBRPT(.1),U,6)+$P(PSBRPT(.1),U,7))_" thru "_$$FMTE^XLFDT($P(PSBRPT(.1),U,6)+$P(PSBRPT(.1),U,9))
"RTN","PSBOMM",137,0)
 .S PSBWARD=$P(PSBRPT(.1),U,3)
"RTN","PSBOMM",138,0)
 .W $$WRDHDR()
"RTN","PSBOMM",139,0)
 .I '$O(^TMP("PSB",$J,0)) W !,"No Missed Medications Found" Q
"RTN","PSBOMM",140,0)
 .S PSBSORT=$P(PSBRPT(.1),U,5)
"RTN","PSBOMM",141,0)
 .F DFN=0:0 S DFN=$O(^TMP("PSB",$J,DFN)) Q:'DFN  D
"RTN","PSBOMM",142,0)
 ..S PSBINDX=$S(PSBSORT="P":$P(^DPT(DFN,0),U),1:$G(^DPT(DFN,.1))_" "_$G(^(.101)))
"RTN","PSBOMM",143,0)
 ..S:PSBINDX="" PSBINDX=$P(^DPT(DFN,0),U)
"RTN","PSBOMM",144,0)
 ..S ^TMP("PSB",$J,"B",PSBINDX,DFN)=""
"RTN","PSBOMM",145,0)
 .S PSBINDX=""
"RTN","PSBOMM",146,0)
 .F  S PSBINDX=$O(^TMP("PSB",$J,"B",PSBINDX)) Q:PSBINDX=""  D
"RTN","PSBOMM",147,0)
 ..F DFN=0:0 S DFN=$O(^TMP("PSB",$J,"B",PSBINDX,DFN)) Q:'DFN  D
"RTN","PSBOMM",148,0)
 ...W ! ; Line Break Between Pt's
"RTN","PSBOMM",149,0)
 ...S PSBDT=""
"RTN","PSBOMM",150,0)
 ...F  S PSBDT=$O(^TMP("PSB",$J,DFN,PSBDT)) Q:PSBDT=""  D
"RTN","PSBOMM",151,0)
 ....W !  ; Line Break Between Admin Times
"RTN","PSBOMM",152,0)
 ....S PSBOITX=""
"RTN","PSBOMM",153,0)
 ....F  S PSBOITX=$O(^TMP("PSB",$J,DFN,PSBDT,PSBOITX)) Q:PSBOITX=""  D
"RTN","PSBOMM",154,0)
 .....S PSBONX=""
"RTN","PSBOMM",155,0)
 .....F  S PSBONX=$O(^TMP("PSB",$J,DFN,PSBDT,PSBOITX,PSBONX)) Q:PSBONX=""  D
"RTN","PSBOMM",156,0)
 ......I $Y>(IOSL-5) W $$WRDHDR()
"RTN","PSBOMM",157,0)
 ......W !,+PSBONX,$S(PSBONX["U":"UD",PSBONX["V":"IV",1:"")
"RTN","PSBOMM",158,0)
 ......W ?10,$G(^DPT(DFN,.101),"**")
"RTN","PSBOMM",159,0)
 ......W ?30,$P(^DPT(DFN,0),U)," (",$E($P(^(0),U,9),6,9),")"
"RTN","PSBOMM",160,0)
 ......I PSBDT["ONE-TIME" D  Q
"RTN","PSBOMM",161,0)
 .......W !,PSBDT,?30,PSBOITX," ",$P(^TMP("PSB",$J,DFN,PSBDT,PSBOITX,PSBONX),U,1)
"RTN","PSBOMM",162,0)
 .......W !,"Start Date/Time:  ",?30,$P(^TMP("PSB",$J,DFN,PSBDT,PSBOITX,PSBONX),U,2)
"RTN","PSBOMM",163,0)
 .......W !,"Stop Date/Time:  ",?30,$P(^TMP("PSB",$J,DFN,PSBDT,PSBOITX,PSBONX),U,3)
"RTN","PSBOMM",164,0)
 .......W !
"RTN","PSBOMM",165,0)
 ......W ?64,$S(PSBDT:$$FMTE^XLFDT(PSBDT,2),1:PSBDT),?80,PSBOITX
"RTN","PSBOMM",166,0)
 ......W " ",^TMP("PSB",$J,DFN,PSBDT,PSBOITX,PSBONX)
"RTN","PSBOMM",167,0)
 Q
"RTN","PSBOMM",168,0)
 ;
"RTN","PSBOMM",169,0)
WRDHDR() ; Ward Header
"RTN","PSBOMM",170,0)
 D WARD^PSBOHDR(PSBWRD,.PSBHDR)
"RTN","PSBOMM",171,0)
 W !,"Ord Num",?10,"Room-Bed",?30,"Patient",?64,"Admin Date/Time",?80,"Medication"
"RTN","PSBOMM",172,0)
 W !,$TR($J("",IOM)," ","-")
"RTN","PSBOMM",173,0)
 Q ""
"RTN","PSBOMM",174,0)
 ;
"RTN","PSBOMM",175,0)
PTHDR() ; Patient Header
"RTN","PSBOMM",176,0)
 D PT^PSBOHDR(DFN,.PSBHDR)
"RTN","PSBOMM",177,0)
 W !,"Order Num",?12,"Administration Date/Time",?38,"Medication"
"RTN","PSBOMM",178,0)
 W !,$TR($J("",IOM)," ","-")
"RTN","PSBOMM",179,0)
 Q ""
"RTN","PSBOMM",180,0)
 ;
"RTN","PSBOMM",181,0)
UDCONT ;
"RTN","PSBOMM",182,0)
 S PSBFLAG=0,J=1
"RTN","PSBOMM",183,0)
 K ^TMP("PSB1",$J)
"RTN","PSBOMM",184,0)
 F I=1:1:$P(PSBOACTL(0),U,4) D
"RTN","PSBOMM",185,0)
 . I $P($G(PSBOACTL(I,1)),U,4)["ON HOLD"!($P($G(PSBOACTL(I,1)),U,4)="HOLD") S ^TMP("PSB1",$J,DFN,J)="HOLD"_U_$E($P($G(PSBOACTL(I,1)),U,1),1,12)
"RTN","PSBOMM",186,0)
 . I $P($G(PSBOACTL(I,1)),U,4)["TAKEN OFF HOLD"!($P($G(PSBOACTL(I,1)),U,4)["UNHOLD") S $P(^TMP("PSB1",$J,DFN,J),U,3)="OFF HOLD"_U_$E($P($G(PSBOACTL(I,1)),U,1),1,12),J=J+1
"RTN","PSBOMM",187,0)
 D:$D(^TMP("PSB1",$J,DFN))&($P(PSBOACTL(0),U,4)'=1)
"RTN","PSBOMM",188,0)
 .S J=0 F  S J=$O(^TMP("PSB1",$J,DFN,J)) Q:'J  Q:PSBFLAG  D
"RTN","PSBOMM",189,0)
 ..S PSBHDDT=$P(^TMP("PSB1",$J,DFN,J),U,2)
"RTN","PSBOMM",190,0)
 ..S PSBHDST=$P(^TMP("PSB1",$J,DFN,J),U)
"RTN","PSBOMM",191,0)
 ..S PSBOFDT=$P(^TMP("PSB1",$J,DFN,J),U,4)
"RTN","PSBOMM",192,0)
 ..S PSBOFST=$P(^TMP("PSB1",$J,DFN,J),U,3)
"RTN","PSBOMM",193,0)
 ..I PSBDT>PSBHDDT,PSBHDST="HOLD",PSBOFST'="" I PSBDT<PSBOFDT,PSBOFST="OFF HOLD" S PSBFLAG=2,PSBUNHD=PSBOFDT
"RTN","PSBOMM",194,0)
 ..I PSBDT>PSBHDDT,PSBHDST="HOLD",PSBOFST="" S PSBFLAG=1
"RTN","PSBOMM",195,0)
 K PSBCNT,TMP("PSB1",$J)
"RTN","PSBOMM",196,0)
 Q
"RTN","PSBOMM",197,0)
 ;
"RTN","PSBOMM",198,0)
UDONE ;
"RTN","PSBOMM",199,0)
 S PSBFLAG=0,J=1
"RTN","PSBOMM",200,0)
 F I=1:1:$P(PSBOACTL(0),U,4) D
"RTN","PSBOMM",201,0)
 .I $P($G(PSBOACTL(I,1)),U,4)["ON HOLD"!($P($G(PSBOACTL(I,1)),U,4)="HOLD") S ^TMP("PSB1",$J,DFN,J)="HOLD"_U_$E($P($G(PSBOACTL(I,1)),U,1),1,12)
"RTN","PSBOMM",202,0)
 .I $P($G(PSBOACTL(I,1)),U,4)["TAKEN OFF HOLD"!($P($G(PSBOACTL(I,1)),U,4)["UNHOLD") S $P(^TMP("PSB1",$J,DFN,J),U,3)="OFF HOLD"_U_$E($P($G(PSBOACTL(I,1)),U,1),1,12),J=J+1
"RTN","PSBOMM",203,0)
 D:$D(^TMP("PSB1",$J,DFN))&($P(PSBOACTL(0),U,4)'=1)
"RTN","PSBOMM",204,0)
 .S J="" F  S J=$O(^TMP("PSB1",$J,DFN,J)) Q:'J  Q:PSBFLAG  D
"RTN","PSBOMM",205,0)
 ..S PSBHDDT=$P(^TMP("PSB1",$J,DFN,J),U,2)
"RTN","PSBOMM",206,0)
 ..S PSBHDST=$P(^TMP("PSB1",$J,DFN,J),U)
"RTN","PSBOMM",207,0)
 ..S PSBOFDT=$P(^TMP("PSB1",$J,DFN,J),U,4)
"RTN","PSBOMM",208,0)
 ..S PSBOFST=$P(^TMP("PSB1",$J,DFN,J),U,3)
"RTN","PSBOMM",209,0)
 ..I PSBOSTS="A",PSBHDST="HOLD",PSBOFST'="",'$D(^TMP("PSB1",$J,DFN,J+1)) I PSBSTOP>PSBOFDT,PSBOFST="OFF HOLD" S PSBFLAG=2,PSBUNHD=PSBOFDT
"RTN","PSBOMM",210,0)
 ..I PSBOSTS="A",PSBHDST="HOLD",PSBOFST'="",PSBOFDT'<PSBSTOP S PSBFLAG=1
"RTN","PSBOMM",211,0)
 ..I PSBOSTS="H",PSBHDST="HOLD",'$D(^TMP("PSB1",$J,DFN,J+1)) S PSBFLAG=1
"RTN","PSBOMM",212,0)
 K PSBCNT,^TMP("PSB1",$J)
"RTN","PSBOMM",213,0)
 Q
"RTN","PSBOMM",214,0)
 ;
"RTN","PSBOMV")
0^28^B41185550
"RTN","PSBOMV",1,0)
PSBOMV ;BIRMINGHAM/EFC-BCMA UNIT DOSE VIRTUAL DUE LIST FUNCTIONS ;Mar 2004
"RTN","PSBOMV",2,0)
 ;;3.0;BAR CODE MED ADMIN;;Mar 2004
"RTN","PSBOMV",3,0)
 ;
"RTN","PSBOMV",4,0)
 ; Reference/IA
"RTN","PSBOMV",5,0)
 ; ^DPT/10035
"RTN","PSBOMV",6,0)
 ; ^NURSF(211.4/1409
"RTN","PSBOMV",7,0)
 ;
"RTN","PSBOMV",8,0)
EN ;
"RTN","PSBOMV",9,0)
 N CNT,PSBHDR,PSBPT,PSBINDX,DFN,PSBY,PSBSORT,PSBPRINT,PSBDT,PSBEV,PSBLOG,PSBPRCX,PSBRB,PSBSTOP,PSBSTRT,PSBTIME,PSBWLF,PSBWRD,PSBWRDA,PSBX,PSBY,PSBXX
"RTN","PSBOMV",10,0)
 ;
"RTN","PSBOMV",11,0)
 K ^TMP("PSBO",$J)
"RTN","PSBOMV",12,0)
 S PSBSTRT=$P(PSBRPT(.1),U,6)+$P(PSBRPT(.1),U,7)
"RTN","PSBOMV",13,0)
 S PSBSTOP=$P(PSBRPT(.1),U,8)+$P(PSBRPT(.1),U,9)
"RTN","PSBOMV",14,0)
 S CNT=0,PSBPRINT=$P($G(PSBRPT(.1)),U)
"RTN","PSBOMV",15,0)
 I PSBPRINT="P" S PSBPT=$P(PSBRPT(.1),U,2)
"RTN","PSBOMV",16,0)
 I PSBPRINT="W" S PSBSORT=$P($G(PSBRPT(.1)),U,5),PSBWRD=$P(PSBRPT(.1),U,3) Q:'PSBWRD  D WARD^NURSUT5("L^"_PSBWRD,.PSBWRDA)
"RTN","PSBOMV",17,0)
 ;
"RTN","PSBOMV",18,0)
RANGE ;Locate data between date range.
"RTN","PSBOMV",19,0)
 S PSBX=PSBSTRT F  S PSBX=$O(^PSB(53.78,"ADT",PSBX)) Q:'PSBX!(PSBX>PSBSTOP)  D
"RTN","PSBOMV",20,0)
 .F PSBY=0:0 S PSBY=$O(^PSB(53.78,"ADT",PSBX,PSBY)) Q:'PSBY  D
"RTN","PSBOMV",21,0)
 ..S DFN=+^PSB(53.78,PSBY,0),PSBWLF=$P($G(^(0)),U,9),PSBTIME=$P($G(^(0)),U,4),PSBLOG=$P($G(^(0)),U,8)
"RTN","PSBOMV",22,0)
CHECK ..;Ward IEN must exist in Ward Field # 9.
"RTN","PSBOMV",23,0)
 ..Q:'$G(PSBWLF)
"RTN","PSBOMV",24,0)
 ..Q:'$G(PSBLOG)
"RTN","PSBOMV",25,0)
 ..I $G(PSBTIME)=$P($G(^PSB(53.79,PSBLOG,0)),U,6),$P($G(^PSB(53.79,PSBLOG,0)),U,9)="RM" Q
"RTN","PSBOMV",26,0)
 ..;Quit if Ward IEN is not in Nurse Location file.
"RTN","PSBOMV",27,0)
 ..I PSBPRINT="W",'$O(^NURSF(211.4,"C",PSBWLF,PSBWRD,0)) Q
"RTN","PSBOMV",28,0)
 ..;Compare date/time and Quit if order status set to Remove.
"RTN","PSBOMV",29,0)
 ..;
"RTN","PSBOMV",30,0)
BUILD ..I $G(PSBSORT)'="B" S ^TMP("PSBO",$J,DFN,PSBX,PSBY)=""
"RTN","PSBOMV",31,0)
 ..I PSBPRINT="P",DFN=PSBPT S ^TMP("PSBO",$J,"B",$P(^DPT(DFN,0),U),DFN)="" Q
"RTN","PSBOMV",32,0)
 ..S ^TMP("PSBO",$J,DFN,0)=^DPT(DFN,0)
"RTN","PSBOMV",33,0)
 ..I PSBPRINT="W" D SORTING
"RTN","PSBOMV",34,0)
 ;
"RTN","PSBOMV",35,0)
BYWDPT ;Print by Ward and Sort by Patient.
"RTN","PSBOMV",36,0)
 I $G(PSBPRINT)="W",$G(PSBSORT)'="B" D
"RTN","PSBOMV",37,0)
 .;Print report by the selected ward name.
"RTN","PSBOMV",38,0)
 .W $$WRDHDR()
"RTN","PSBOMV",39,0)
 .S PSBINDX=""
"RTN","PSBOMV",40,0)
 .F  S PSBINDX=$O(^TMP("PSBO",$J,"B",PSBINDX)) Q:PSBINDX=""  D
"RTN","PSBOMV",41,0)
 ..F DFN=0:0 S DFN=$O(^TMP("PSBO",$J,"B",PSBINDX,DFN)) Q:'DFN  D
"RTN","PSBOMV",42,0)
 ...W:$Y>(IOSL-10) $$WRDHDR()
"RTN","PSBOMV",43,0)
 ...F PSBDT=0:0 S PSBDT=$O(^TMP("PSBO",$J,DFN,PSBDT)) Q:'PSBDT  D
"RTN","PSBOMV",44,0)
 ....F PSBY=0:0 S PSBY=$O(^TMP("PSBO",$J,DFN,PSBDT,PSBY)) Q:'PSBY  D
"RTN","PSBOMV",45,0)
 .....D EVENTS  ;Set Total Number of Events
"RTN","PSBOMV",46,0)
 .....S PSBRB=$$GET1^DIQ(53.78,PSBY_",",.02)
"RTN","PSBOMV",47,0)
 .....W !,PSBRB
"RTN","PSBOMV",48,0)
 .....W ?20,$P(^TMP("PSBO",$J,DFN,0),U,1)
"RTN","PSBOMV",49,0)
 .....W ?48,$$GET1^DIQ(53.78,PSBY_",",.04)
"RTN","PSBOMV",50,0)
 .....W ?75,$$GET1^DIQ(53.78,PSBY_",",.05)
"RTN","PSBOMV",51,0)
 .....W ?95,$$GET1^DIQ(53.78,PSBY_",",.06)
"RTN","PSBOMV",52,0)
 .....W ?102,$$GET1^DIQ(53.78,PSBY_",",.07)
"RTN","PSBOMV",53,0)
 .....W ?102,$$GET1^DIQ(53.78,PSBY_",","MED LOG PTR:ADMINISTRATION MEDICATION")
"RTN","PSBOMV",54,0)
 .....D VCOM ;Print Ward and Comments from Med Log.
"RTN","PSBOMV",55,0)
 .....W !?52
"RTN","PSBOMV",56,0)
 .W !!  D EVEPRNT
"RTN","PSBOMV",57,0)
 ;
"RTN","PSBOMV",58,0)
BYWDRB ;Print by Ward and Sort by Room and Bed.
"RTN","PSBOMV",59,0)
 I $G(PSBPRINT)="W",$G(PSBSORT)="B" D
"RTN","PSBOMV",60,0)
 .;Print report by the selected ward name.
"RTN","PSBOMV",61,0)
 .W $$WRDHDR()
"RTN","PSBOMV",62,0)
 .S PSBINDX=""
"RTN","PSBOMV",63,0)
 .F  S PSBINDX=$O(^TMP("PSBO",$J,"B",PSBINDX)) Q:PSBINDX=""  D
"RTN","PSBOMV",64,0)
 ..F DFN=0:0 S DFN=$O(^TMP("PSBO",$J,"B",PSBINDX,DFN)) Q:'DFN  D
"RTN","PSBOMV",65,0)
 ...W:$Y>(IOSL-10) $$WRDHDR()
"RTN","PSBOMV",66,0)
 ...F PSBDT=0:0 S PSBDT=$O(^TMP("PSBO",$J,"B",PSBINDX,DFN,PSBDT)) Q:'PSBDT  D
"RTN","PSBOMV",67,0)
 ....F PSBY=0:0 S PSBY=$O(^TMP("PSBO",$J,"B",PSBINDX,DFN,PSBDT,PSBY)) Q:'PSBY  D
"RTN","PSBOMV",68,0)
 .....D EVENTS  ;Set Total Number of Events
"RTN","PSBOMV",69,0)
 .....S PSBRB=$$GET1^DIQ(53.78,PSBY_",",.02)
"RTN","PSBOMV",70,0)
 .....W !,PSBRB
"RTN","PSBOMV",71,0)
 .....W ?20,$P(^TMP("PSBO",$J,DFN,0),U,1)
"RTN","PSBOMV",72,0)
 .....W ?48,$$GET1^DIQ(53.78,PSBY_",",.04)
"RTN","PSBOMV",73,0)
 .....W ?75,$$GET1^DIQ(53.78,PSBY_",",.05)
"RTN","PSBOMV",74,0)
 .....W ?95,$$GET1^DIQ(53.78,PSBY_",",.06)
"RTN","PSBOMV",75,0)
 .....W ?102,$$GET1^DIQ(53.78,PSBY_",",.07)
"RTN","PSBOMV",76,0)
 .....W ?102,$$GET1^DIQ(53.78,PSBY_",","MED LOG PTR:ADMINISTRATION MEDICATION")
"RTN","PSBOMV",77,0)
 .....D VCOM ;Print Ward and Comments from Med Log.
"RTN","PSBOMV",78,0)
 .....W !?52
"RTN","PSBOMV",79,0)
 .W !!  D EVEPRNT
"RTN","PSBOMV",80,0)
 ;
"RTN","PSBOMV",81,0)
BYDFN ;Print by Patient.
"RTN","PSBOMV",82,0)
 D:$G(PSBPRINT)="P"
"RTN","PSBOMV",83,0)
 .W $$PTHDR()
"RTN","PSBOMV",84,0)
 .S PSBINDX=""
"RTN","PSBOMV",85,0)
 .F  S PSBINDX=$O(^TMP("PSBO",$J,"B",PSBINDX)) Q:PSBINDX=""  D
"RTN","PSBOMV",86,0)
 ..F DFN=0:0 S DFN=$O(^TMP("PSBO",$J,"B",PSBINDX,DFN)) Q:'DFN  D
"RTN","PSBOMV",87,0)
 ...W:$Y>(IOSL-10) $$PTHDR()
"RTN","PSBOMV",88,0)
 ...F PSBDT=0:0 S PSBDT=$O(^TMP("PSBO",$J,DFN,PSBDT)) Q:'PSBDT  D
"RTN","PSBOMV",89,0)
 ....F PSBY=0:0 S PSBY=$O(^TMP("PSBO",$J,DFN,PSBDT,PSBY)) Q:'PSBY  D
"RTN","PSBOMV",90,0)
 .....D EVENTS  ;Set Total Number of Events
"RTN","PSBOMV",91,0)
 .....W !,$$GET1^DIQ(53.78,PSBY_",",.04)
"RTN","PSBOMV",92,0)
 .....W ?23,$$GET1^DIQ(53.78,PSBY_",",.05)
"RTN","PSBOMV",93,0)
 .....W ?43,$$GET1^DIQ(53.78,PSBY_",",.06)
"RTN","PSBOMV",94,0)
 .....W ?50,$$GET1^DIQ(53.78,PSBY_",",.07)
"RTN","PSBOMV",95,0)
 .....W ?50,$$GET1^DIQ(53.78,PSBY_",","MED LOG PTR:ADMINISTRATION MEDICATION")
"RTN","PSBOMV",96,0)
 .....D VCOM ;Print Ward and Comments from Med Log.
"RTN","PSBOMV",97,0)
 .W !!  D EVEPRNT
"RTN","PSBOMV",98,0)
 .W $$PTFTR^PSBOHDR()
"RTN","PSBOMV",99,0)
 Q
"RTN","PSBOMV",100,0)
 ;
"RTN","PSBOMV",101,0)
WRDHDR() ;
"RTN","PSBOMV",102,0)
 S PSBHDR(1)="MEDICATION VARIANCE LOG"
"RTN","PSBOMV",103,0)
 D WARD^PSBOHDR(PSBWRD,.PSBHDR)
"RTN","PSBOMV",104,0)
 W !,"Rm-Bed",?20,"Patient Name",?48,"Event Date/Time",?75,"Event",?95,"Var",?102,"Medication",!,$TR($J("",IOM)," ","-")
"RTN","PSBOMV",105,0)
 Q ""
"RTN","PSBOMV",106,0)
 ;
"RTN","PSBOMV",107,0)
PTHDR() ;
"RTN","PSBOMV",108,0)
 S PSBHDR(1)="MEDICATION VARIANCE LOG"
"RTN","PSBOMV",109,0)
 D PT^PSBOHDR(PSBDFN,.PSBHDR)
"RTN","PSBOMV",110,0)
 W !,"Event Date/Time",?23,"Event",?43,"Var",?50,"Medication",!,$TR($J("",IOM)," ","-")
"RTN","PSBOMV",111,0)
 Q ""
"RTN","PSBOMV",112,0)
 ;
"RTN","PSBOMV",113,0)
VCOM ;Print Ward and Comments from Med Log on Variance Report.
"RTN","PSBOMV",114,0)
 N PSBCOM,PSBML,Y
"RTN","PSBOMV",115,0)
 Q:'$P($G(^PSB(53.78,PSBY,0)),"^",8)  S PSBML=$P(^(0),"^",8)
"RTN","PSBOMV",116,0)
 I $P(PSBRPT(.1),U)="P" W !,?23,"Ward:      ",?34 D
"RTN","PSBOMV",117,0)
 .I $P($G(^PSB(53.79,PSBML,0)),U,2)=""  W "<No Ward>" Q
"RTN","PSBOMV",118,0)
 .W $P($G(^PSB(53.79,PSBML,0)),U,2)
"RTN","PSBOMV",119,0)
 W !,?23,"Comments:  ",?34 I '$O(^PSB(53.79,PSBML,.3,0))  W "<No Comments>" Q
"RTN","PSBOMV",120,0)
 F PSBCOM=0:0 S PSBCOM=$O(^PSB(53.79,PSBML,.3,PSBCOM)) Q:'PSBCOM  D
"RTN","PSBOMV",121,0)
 .W:$X>34 !?34
"RTN","PSBOMV",122,0)
 .S Y=$P(^PSB(53.79,PSBML,.3,PSBCOM,0),U,3)+.0000001
"RTN","PSBOMV",123,0)
 .W $E(Y,4,5),"/",$E(Y,6,7),"/",$E(Y,2,3)," ",$E(Y,9,10),":",$E(Y,11,12),?50,"By: ",$$GET1^DIQ(53.793,PSBCOM_","_PSBML_",","ENTERED BY:INITIAL"),$$WRAP^PSBO(60,75,$P(^PSB(53.79,PSBML,.3,PSBCOM,0),U,1))
"RTN","PSBOMV",124,0)
 Q
"RTN","PSBOMV",125,0)
 ;
"RTN","PSBOMV",126,0)
EVENTS ;Record total number of events.
"RTN","PSBOMV",127,0)
 S PSBEV=$P($G(^PSB(53.78,PSBY,0)),U,5) Q:'$G(PSBEV)
"RTN","PSBOMV",128,0)
 S ^TMP("PSBO",$J,"EVENTS",PSBEV,0)=$P($G(^TMP("PSBO",$J,"EVENTS",PSBEV,0)),U)+1
"RTN","PSBOMV",129,0)
 S CNT=CNT+1,^TMP("PSBO",$J,"EVENTSTOT",0)=CNT
"RTN","PSBOMV",130,0)
 Q
"RTN","PSBOMV",131,0)
EVEPRNT ;Display Total and Percentage of Events.
"RTN","PSBOMV",132,0)
 ;
"RTN","PSBOMV",133,0)
 Q:'$D(^TMP("PSBO",$J,"EVENTSTOT"))  ;Quit if there are no events
"RTN","PSBOMV",134,0)
 W !,"Total Number of Events for the reporting period is: "_$P(^TMP("PSBO",$J,"EVENTSTOT",0),U)_".",!
"RTN","PSBOMV",135,0)
 F PSBXX=0:0 S PSBXX=$O(^TMP("PSBO",$J,"EVENTS",PSBXX)) Q:'PSBXX  D
"RTN","PSBOMV",136,0)
 .W !,"Total number of "_$$EXTERNAL^DILFD(53.78,.05,"",PSBXX)_" events is "_$P($G(^TMP("PSBO",$J,"EVENTS",PSBXX,0)),U)_"."
"RTN","PSBOMV",137,0)
 .S PSBPRCX=$E($FN($P(^TMP("PSBO",$J,"EVENTS",PSBXX,0),U)/$P(^TMP("PSBO",$J,"EVENTSTOT",0),U),"",2),3,4)
"RTN","PSBOMV",138,0)
 .W !,"Percentage of Total Events: "_$S(PSBPRCX="00":"100",1:PSBPRCX)_"%",!
"RTN","PSBOMV",139,0)
 Q
"RTN","PSBOMV",140,0)
 ;
"RTN","PSBOMV",141,0)
SORTING ;Sort by Patient or Room and Bed Information
"RTN","PSBOMV",142,0)
 ;
"RTN","PSBOMV",143,0)
 I $G(PSBSORT)="P"!($G(PSBSORT)="") S PSBINDX=$P(^DPT(DFN,0),U),^TMP("PSBO",$J,"B",PSBINDX,DFN)="" Q
"RTN","PSBOMV",144,0)
 I $G(PSBSORT)="B" S PSBINDX=$P($G(^PSB(53.78,+PSBY,0)),U,2) S:PSBINDX="" PSBINDX="** NO ROOM/BED **" S ^TMP("PSBO",$J,"B",PSBINDX,DFN,PSBX,PSBY)=""
"RTN","PSBOMV",145,0)
 Q 
"RTN","PSBOPE")
0^29^B17070369
"RTN","PSBOPE",1,0)
PSBOPE ;BIRMINGHAM/EFC-PRN EFFECTIVENESS WORKSHEET ;Mar 2004
"RTN","PSBOPE",2,0)
 ;;3.0;BAR CODE MED ADMIN;;Mar 2004
"RTN","PSBOPE",3,0)
 ;
"RTN","PSBOPE",4,0)
 ; Reference/IA
"RTN","PSBOPE",5,0)
 ; ^DPT/10035
"RTN","PSBOPE",6,0)
 ; EN^PSJBCMA/2828
"RTN","PSBOPE",7,0)
 ;
"RTN","PSBOPE",8,0)
EN ; Called from DQ^PSBO
"RTN","PSBOPE",9,0)
 N PSBSTRT,PSBSTOP,DFN
"RTN","PSBOPE",10,0)
 K ^TMP("PSB",$J)
"RTN","PSBOPE",11,0)
 S PSBSTRT=$P(PSBRPT(.1),U,6)+$P(PSBRPT(.1),U,7)
"RTN","PSBOPE",12,0)
 S PSBSTOP=$P(PSBRPT(.1),U,8)+$P(PSBRPT(.1),U,9)
"RTN","PSBOPE",13,0)
 F DFN=0:0 S DFN=$O(^TMP("PSBO",$J,DFN)) Q:'DFN  D EN1
"RTN","PSBOPE",14,0)
 D PRINT
"RTN","PSBOPE",15,0)
 K ^TMP("PSJ",$J),^TMP("PSB",$J)
"RTN","PSBOPE",16,0)
 Q
"RTN","PSBOPE",17,0)
 ;
"RTN","PSBOPE",18,0)
EN1 ; Expects DFN,PSBSTRT,PSBSTOP from EN
"RTN","PSBOPE",19,0)
 N PSBGBL,PSBHDR,PSBX,PSBADMIN,PSBDFN,PSBDT,PSBMED,PSBORD,PSBOSTRT,PSBSCHED
"RTN","PSBOPE",20,0)
 K ^TMP("PSJ",$J)
"RTN","PSBOPE",21,0)
 S PSBDT=PSBSTRT-.0000001
"RTN","PSBOPE",22,0)
 F  S PSBDT=$O(^PSB(53.79,"AADT",DFN,PSBDT)) Q:'PSBDT!(PSBDT>PSBSTOP)  D
"RTN","PSBOPE",23,0)
 .S PSBIEN=0
"RTN","PSBOPE",24,0)
 .F  S PSBIEN=$O(^PSB(53.79,"AADT",DFN,PSBDT,PSBIEN)) Q:'PSBIEN  D
"RTN","PSBOPE",25,0)
 ..Q:$P($G(^PSB(53.79,PSBIEN,.1)),U,2)'="P"  ; Not a PRN Administration
"RTN","PSBOPE",26,0)
 ..Q:$P($G(^PSB(53.79,PSBIEN,.2)),U,2)]""  ; Effectiveness entered
"RTN","PSBOPE",27,0)
 ..Q:($P($G(^PSB(53.79,PSBIEN,0)),U,9)'="G")&($P($G(^PSB(53.79,PSBIEN,0)),U,9)'="RM")  ;Allow only entries with at status of "GIVEN" and "REMOVED"
"RTN","PSBOPE",28,0)
 ..Q:$P($G(^PSB(53.79,PSBIEN,0)),U,4)<PSBDT
"RTN","PSBOPE",29,0)
 ..Q:$P($G(^PSB(53.79,PSBIEN,0)),U,4)>PSBSTOP
"RTN","PSBOPE",30,0)
 ..S ^TMP("PSB",$J,DFN,PSBIEN)=""
"RTN","PSBOPE",31,0)
 Q
"RTN","PSBOPE",32,0)
PRINT ; Print meds stored in ^TMP("PSB",$J,DFN,....
"RTN","PSBOPE",33,0)
 N PSBHDR,PSBDT,PSBMED,DFN
"RTN","PSBOPE",34,0)
 ;
"RTN","PSBOPE",35,0)
 ; Print by Patient
"RTN","PSBOPE",36,0)
 ;
"RTN","PSBOPE",37,0)
 D:$P(PSBRPT(.1),U,1)="P"
"RTN","PSBOPE",38,0)
 .S PSBHDR(1)="PRN EFFECTIVENESS LIST from "_$$FMTE^XLFDT(PSBSTRT)_" thru "_$$FMTE^XLFDT(PSBSTOP)
"RTN","PSBOPE",39,0)
 .S DFN=$P(PSBRPT(.1),U,2)
"RTN","PSBOPE",40,0)
 .W $$PTHDR()
"RTN","PSBOPE",41,0)
 .I '$O(^TMP("PSB",$J,DFN,0)) W !,"No PRN Medications Found",$$PTFTR^PSBOHDR() Q
"RTN","PSBOPE",42,0)
 .W !  ; Line Break Between Admin Times
"RTN","PSBOPE",43,0)
 .S PSBIEN=""
"RTN","PSBOPE",44,0)
 .F  S PSBIEN=$O(^TMP("PSB",$J,DFN,PSBIEN)) Q:PSBIEN=""  D
"RTN","PSBOPE",45,0)
 ..S PSBIENS=PSBIEN_","
"RTN","PSBOPE",46,0)
 ..I $Y>(IOSL-5) W $$PTFTR^PSBOHDR(),$$PTHDR()
"RTN","PSBOPE",47,0)
 ..W !,$$GET1^DIQ(53.79,PSBIENS,.04),?30,$$GET1^DIQ(53.79,PSBIENS,.08),?72,$$GET1^DIQ(53.79,PSBIENS,"ACTION BY")
"RTN","PSBOPE",48,0)
 ..W !,?5,"PRN Reason: ",$$GET1^DIQ(53.79,PSBIENS,.21)
"RTN","PSBOPE",49,0)
 .W $$PTFTR^PSBOHDR()
"RTN","PSBOPE",50,0)
 .Q
"RTN","PSBOPE",51,0)
 ;
"RTN","PSBOPE",52,0)
 ; Print by Ward
"RTN","PSBOPE",53,0)
 ;
"RTN","PSBOPE",54,0)
 D:$P(PSBRPT(.1),U,1)="W"
"RTN","PSBOPE",55,0)
 .S PSBHDR(1)="PRN EFFECTIVENESS LIST  from "_$$FMTE^XLFDT(PSBSTRT)_" thru "_$$FMTE^XLFDT(PSBSTOP)
"RTN","PSBOPE",56,0)
 .S PSBWARD=$P(PSBRPT(.1),U,3)
"RTN","PSBOPE",57,0)
 .W $$WRDHDR()
"RTN","PSBOPE",58,0)
 .I '$O(^TMP("PSB",$J,0)) W !,"No PRN Medications Found" Q
"RTN","PSBOPE",59,0)
 .S PSBSORT=$P(PSBRPT(.1),U,5)
"RTN","PSBOPE",60,0)
 .F DFN=0:0 S DFN=$O(^TMP("PSB",$J,DFN)) Q:'DFN  D
"RTN","PSBOPE",61,0)
 ..S PSBINDX=$S(PSBSORT="P":$P(^DPT(DFN,0),U),1:$G(^(.1))_" "_$G(^(.101)))
"RTN","PSBOPE",62,0)
 ..S:PSBINDX="" PSBINDX=$P(^DPT(DFN,0),U)
"RTN","PSBOPE",63,0)
 ..S ^TMP("PSB",$J,"B",PSBINDX,DFN)=""
"RTN","PSBOPE",64,0)
 .S PSBINDX=""
"RTN","PSBOPE",65,0)
 .F  S PSBINDX=$O(^TMP("PSB",$J,"B",PSBINDX)) Q:PSBINDX=""  D
"RTN","PSBOPE",66,0)
 ..F DFN=0:0 S DFN=$O(^TMP("PSB",$J,"B",PSBINDX,DFN)) Q:'DFN  D
"RTN","PSBOPE",67,0)
 ...W ! ; Line Break Between Pt's
"RTN","PSBOPE",68,0)
 ...W:$P(PSBRPT(.1),U,5)="P" !,$$GET1^DIQ(2,DFN_",",.01),?32,$$GET1^DIQ(2,DFN_",",.1),"  ",$$GET1^DIQ(2,DFN_",",.101)
"RTN","PSBOPE",69,0)
 ...W:$P(PSBRPT(.1),U,5)="B" !,$$GET1^DIQ(2,DFN_",",.1),"  ",$$GET1^DIQ(2,DFN_",",.101),?20,$$GET1^DIQ(2,DFN_",",.01)
"RTN","PSBOPE",70,0)
 ...W !  ; Line Break Between Admin Times
"RTN","PSBOPE",71,0)
 ...S PSBIEN=""
"RTN","PSBOPE",72,0)
 ...F  S PSBIEN=$O(^TMP("PSB",$J,DFN,PSBIEN)) Q:PSBIEN=""  D
"RTN","PSBOPE",73,0)
 ....I $Y>(IOSL-5) W $$WRDHDR()
"RTN","PSBOPE",74,0)
 ....W !?5,$$GET1^DIQ(53.79,PSBIEN_",",.04),?35,$$GET1^DIQ(53.79,PSBIEN_",",.08),?77,$$GET1^DIQ(53.79,PSBIEN_",","ACTION BY")
"RTN","PSBOPE",75,0)
 ....W !?10,"PRN Reason: ",$$GET1^DIQ(53.79,PSBIEN_",",.21)
"RTN","PSBOPE",76,0)
 Q
"RTN","PSBOPE",77,0)
 ;
"RTN","PSBOPE",78,0)
WRDHDR() ; Ward Header
"RTN","PSBOPE",79,0)
 D WARD^PSBOHDR(PSBWRD,.PSBHDR)
"RTN","PSBOPE",80,0)
 W:$P(PSBRPT(.1),U,5)="B" !,"Ward Rm-Bed",?20,"Patient"
"RTN","PSBOPE",81,0)
 W:$P(PSBRPT(.1),U,5)="P" !,"Patient",?32,"Ward Rm-Bed"
"RTN","PSBOPE",82,0)
 W !?5,"Administration Date/Time",?35,"Medication",?77,"Administered By"
"RTN","PSBOPE",83,0)
 W !,$TR($J("",IOM)," ","-")
"RTN","PSBOPE",84,0)
 Q ""
"RTN","PSBOPE",85,0)
 ;
"RTN","PSBOPE",86,0)
PTHDR() ; Patient Header
"RTN","PSBOPE",87,0)
 D PT^PSBOHDR(DFN,.PSBHDR)
"RTN","PSBOPE",88,0)
 W !,"Administration Date/Time",?30,"Medication",?72,"Administered By"
"RTN","PSBOPE",89,0)
 W !,$TR($J("",IOM)," ","-")
"RTN","PSBOPE",90,0)
 Q ""
"RTN","PSBOPE",91,0)
 ;
"RTN","PSBOPI")
0^30^B405147
"RTN","PSBOPI",1,0)
PSBOPI ;BIRMINGHAM/EFC-BCMA UNIT DOSE VIRTUAL DUE LIST FUNCTIONS ;Mar 2004
"RTN","PSBOPI",2,0)
 ;;3.0;BAR CODE MED ADMIN;;Mar 2004
"RTN","PSBOPI",3,0)
 ;
"RTN","PSBOPI",4,0)
 ; Reference/IA
"RTN","PSBOPI",5,0)
 ; EN^DGRPD/2041
"RTN","PSBOPI",6,0)
 ;
"RTN","PSBOPI",7,0)
EN ;
"RTN","PSBOPI",8,0)
 N DFN,PSBGBL
"RTN","PSBOPI",9,0)
 S PSBGBL="^TMP(""PSBO"",$J,""B"")"
"RTN","PSBOPI",10,0)
 F  S PSBGBL=$Q(@PSBGBL) Q:PSBGBL=""  Q:$QS(PSBGBL,2)'=$J  Q:$QS(PSBGBL,1)'["PSBO"  D
"RTN","PSBOPI",11,0)
 .S DFN=$QS(PSBGBL,5)
"RTN","PSBOPI",12,0)
 .D EN^DGRPD
"RTN","PSBOPI",13,0)
 K ^TMP("PSBO",$J)
"RTN","PSBOPI",14,0)
 Q
"RTN","PSBOPM")
0^31^B11547930
"RTN","PSBOPM",1,0)
PSBOPM ;BIRMINGHAM/EFC-BCMA OIT HISTORY ;Mar 2004
"RTN","PSBOPM",2,0)
 ;;3.0;BAR CODE MED ADMIN;;Mar 2004
"RTN","PSBOPM",3,0)
 ;
"RTN","PSBOPM",4,0)
 ; Reference/IA
"RTN","PSBOPM",5,0)
 ; File 50.7/2880
"RTN","PSBOPM",6,0)
 ; File 2/10035
"RTN","PSBOPM",7,0)
 ; EN^PSJBCMA1/2829
"RTN","PSBOPM",8,0)
 ;
"RTN","PSBOPM",9,0)
 ;
"RTN","PSBOPM",10,0)
 ;
"RTN","PSBOPM",11,0)
EN ;
"RTN","PSBOPM",12,0)
 N PSBDT,PSBIEN,PSBIENS,PSBNODE,PSBSPC,PSBY,PSBOI,DFN,PSBGBL
"RTN","PSBOPM",13,0)
 S PSBGBL="^TMP(""PSBO"",$J,""B"")"
"RTN","PSBOPM",14,0)
 F  S PSBGBL=$Q(@PSBGBL) Q:PSBGBL=""  Q:$QS(PSBGBL,2)'=$J  Q:$QS(PSBGBL,1)'["PSBO"  D
"RTN","PSBOPM",15,0)
 .S DFN=$QS(PSBGBL,5)
"RTN","PSBOPM",16,0)
 S PSBOI=$$GET1^DIQ(53.69,PSBRPT_",",.09)
"RTN","PSBOPM",17,0)
 S PSBOI=$S(PSBOI["U":$TR(PSBOI,"U",""),PSBOI["V":$TR(PSBOI,"V",""),1:PSBOI)
"RTN","PSBOPM",18,0)
 I '$G(DFN) D ADD("Error: No Patient IEN") Q
"RTN","PSBOPM",19,0)
 I '$G(PSBOI) D ADD("Error: No Orderable Item") Q
"RTN","PSBOPM",20,0)
 K ^TMP("PSB",$J)
"RTN","PSBOPM",21,0)
 D ADD("Medication Administration History")
"RTN","PSBOPM",22,0)
 D ADD("")
"RTN","PSBOPM",23,0)
 D ADD("PATIENT:    "_$$GET1^DIQ(2,DFN_",",.01))
"RTN","PSBOPM",24,0)
 D ADD("MEDICATION: "_$$GET1^DIQ(50.7,PSBOI_",",.01))
"RTN","PSBOPM",25,0)
 D ADD("")
"RTN","PSBOPM",26,0)
 D ADD("Location            St Sch Administration Date        Admin By  Injection Site")
"RTN","PSBOPM",27,0)
 D ADD($J("",60)_"Medication & Dosage")
"RTN","PSBOPM",28,0)
 D ADD($TR($J("",110)," ","-"))
"RTN","PSBOPM",29,0)
 S PSBDT="",PSBSPC=$J("",80)
"RTN","PSBOPM",30,0)
 F  S PSBDT=$O(^PSB(53.79,"AOIP",DFN,PSBOI,PSBDT),-1) Q:'PSBDT  D
"RTN","PSBOPM",31,0)
 .S PSBIEN=""
"RTN","PSBOPM",32,0)
 .F  S PSBIEN=$O(^PSB(53.79,"AOIP",DFN,PSBOI,PSBDT,PSBIEN)) Q:'PSBIEN  D
"RTN","PSBOPM",33,0)
 ..Q:$P(^PSB(53.79,PSBIEN,0),U,9)="N"
"RTN","PSBOPM",34,0)
 ..S PSBIENS=PSBIEN_","
"RTN","PSBOPM",35,0)
 ..S Y=$E($$GET1^DIQ(53.79,PSBIENS,.02)_PSBSPC,1,20)
"RTN","PSBOPM",36,0)
 ..S Y=Y_$P(^PSB(53.79,PSBIEN,0),U,9)_"  "
"RTN","PSBOPM",37,0)
 ..S Y=Y_$E($P($G(^PSB(53.79,PSBIEN,.1)),U,2)_PSBSPC,1,2)_"  "
"RTN","PSBOPM",38,0)
 ..S Y=Y_$E($$GET1^DIQ(53.79,PSBIENS,.06)_PSBSPC,1,25)_"  "
"RTN","PSBOPM",39,0)
 ..S Y=Y_$E($$GET1^DIQ(53.79,PSBIENS,"ACTION BY:INITIAL")_PSBSPC,1,10)_"  "
"RTN","PSBOPM",40,0)
 ..S Y=Y_$$GET1^DIQ(53.79,PSBIENS,.16)
"RTN","PSBOPM",41,0)
 ..D ADD(Y)
"RTN","PSBOPM",42,0)
 ..;If "AOIP3" or "AOIP4" not exhists run old Logic
"RTN","PSBOPM",43,0)
 ..I '$D(^PSB(53.79,"AOIP3",DFN,PSBIEN))&'$D(^PSB(53.79,"AOIP4",DFN,PSBIEN))  D
"RTN","PSBOPM",44,0)
 ...F PSBNODE=.5,.6,.7 D
"RTN","PSBOPM",45,0)
 ....S PSBDD=$S(PSBNODE=.5:53.795,PSBNODE=.6:53.796,1:53.797)
"RTN","PSBOPM",46,0)
 ....F PSBY=0:0 S PSBY=$O(^PSB(53.79,PSBIEN,PSBNODE,PSBY)) Q:'PSBY  D
"RTN","PSBOPM",47,0)
 .....S Y=$$GET1^DIQ(PSBDD,PSBY_","_PSBIENS,.01)_"  "
"RTN","PSBOPM",48,0)
 .....S Y=Y_$$GET1^DIQ(PSBDD,PSBY_","_PSBIENS,.03)_"  "
"RTN","PSBOPM",49,0)
 .....S Y=Y_$$GET1^DIQ(PSBDD,PSBY_","_PSBIENS,.04)_"  "
"RTN","PSBOPM",50,0)
 .....D ADD($J("",60)_Y)
"RTN","PSBOPM",51,0)
 ...D ADD("")
"RTN","PSBOPM",52,0)
 ..S ^TMP("PSB",$J,0)=""
"RTN","PSBOPM",53,0)
 ..;I "AOIP3" or "AOIP4" exhists then run new Logic.
"RTN","PSBOPM",54,0)
 ..S PSBSS=""
"RTN","PSBOPM",55,0)
 ..I $D(^PSB(53.79,"AOIP4",DFN,PSBIEN)) S PSBVAR="950",PSBAA="AOIP4"  D ADDSOL
"RTN","PSBOPM",56,0)
 ..I $D(^PSB(53.79,"AOIP3",DFN,PSBIEN)) S PSBVAR="850",PSBAA="AOIP3",PSBSS=1  D ADDSOL
"RTN","PSBOPM",57,0)
 ;BR ENDS
"RTN","PSBOPM",58,0)
 S RESULTS=$NAME(^TMP("PSB",$J))
"RTN","PSBOPM",59,0)
 S I="" F  S I=$O(^TMP("PSB",$J,I)) Q:I=""  W !,$G(^TMP("PSB",$J,I))
"RTN","PSBOPM",60,0)
 K ^TMP("PSB",$J)
"RTN","PSBOPM",61,0)
 K PSBAA,PSBSS,PSBX,PSBZ,PSBE,PSBVAR
"RTN","PSBOPM",62,0)
 Q
"RTN","PSBOPM",63,0)
 ;           
"RTN","PSBOPM",64,0)
ADDSOL ;
"RTN","PSBOPM",65,0)
 I PSBSS'=1  D EN^PSJBCMA1(DFN,PSBORDNM,1)
"RTN","PSBOPM",66,0)
 S PSBX="" F  S PSBX=$O(^PSB(53.79,PSBAA,DFN,PSBIEN,PSBX)) Q:PSBX=""  D
"RTN","PSBOPM",67,0)
 .S PSBZ="0" F  S PSBZ=$O(^TMP("PSJ1",$J,PSBVAR,PSBZ)) Q:PSBZ=""  D
"RTN","PSBOPM",68,0)
 ..S D=$P(^TMP("PSJ1",$J,PSBVAR,PSBZ,0),"^")  I D=PSBX  D
"RTN","PSBOPM",69,0)
 ...S PSBE=$P(^TMP("PSJ1",$J,PSBVAR,PSBZ,0),"^",2)_"  "_$P(^TMP("PSJ1",$J,PSBVAR,PSBZ,0),"^",3)
"RTN","PSBOPM",70,0)
 ...D ADD($J("",60)_PSBE)
"RTN","PSBOPM",71,0)
 Q
"RTN","PSBOPM",72,0)
ADD(X) ;
"RTN","PSBOPM",73,0)
 S ^TMP("PSB",$J,$O(^TMP("PSB",$J,""),-1)+1)=X
"RTN","PSBOPM",74,0)
 Q
"RTN","PSBOPM",75,0)
 ;
"RTN","PSBOVT")
0^32^B1375415
"RTN","PSBOVT",1,0)
PSBOVT ;BIRMINGHAM/BSR-CUMULATIVE VITALS REPORT ;Mar 2004
"RTN","PSBOVT",2,0)
 ;;3.0;BAR CODE MED ADMIN;;Mar 2004;
"RTN","PSBOVT",3,0)
 ; Reference/IA
"RTN","PSBOVT",4,0)
 ; EN3^GMRVSC0/1444
"RTN","PSBOVT",5,0)
 ;
"RTN","PSBOVT",6,0)
EN ; Print Cumulative Vitals Report
"RTN","PSBOVT",7,0)
 ;
"RTN","PSBOVT",8,0)
 N PSBGBL,DFN
"RTN","PSBOVT",9,0)
 S PSBGBL="^TMP(""PSBO"",$J,""B"")"
"RTN","PSBOVT",10,0)
 S PSBGBL=$Q(@PSBGBL) Q:PSBGBL=""  Q:$QS(PSBGBL,1)'="PSBO"!($QS(PSBGBL,2)'=$J)
"RTN","PSBOVT",11,0)
 S DFN=$QS(PSBGBL,5)
"RTN","PSBOVT",12,0)
 D PRNT(DFN,$P(PSBRPT(.1),U,6)_$P(PSBRPT(.1),U,7),$P(PSBRPT(.1),U,8)_$P(PSBRPT(.1),U,9))
"RTN","PSBOVT",13,0)
 Q
"RTN","PSBOVT",14,0)
 ;
"RTN","PSBOVT",15,0)
PRNT(DFN,PSBVSDT,PSBVFDT)             ; PATIENT CUMULATIVE VITALS REPORT
"RTN","PSBOVT",16,0)
 ; INPUT VARIABLES:    DFN=PATIENT NUMBER
"RTN","PSBOVT",17,0)
 ;
"RTN","PSBOVT",18,0)
 S FLGD=""
"RTN","PSBOVT",19,0)
 S PSBINS=$P(PSBVSDT,".")
"RTN","PSBOVT",20,0)
 S PSBINSA=$P(PSBVFDT,".")
"RTN","PSBOVT",21,0)
 D DATEADD
"RTN","PSBOVT",22,0)
 I IOST="P-DUMMY"  D PSBIOCH
"RTN","PSBOVT",23,0)
 D EN3^GMRVSC0(DFN,PSBINS,PSBINSA)
"RTN","PSBOVT",24,0)
 Q
"RTN","PSBOVT",25,0)
 ;
"RTN","PSBOVT",26,0)
DATEADD ;
"RTN","PSBOVT",27,0)
 S X=PSBINSA
"RTN","PSBOVT",28,0)
 D H^%DTC
"RTN","PSBOVT",29,0)
 S %H=%H+1
"RTN","PSBOVT",30,0)
 D YMD^%DTC
"RTN","PSBOVT",31,0)
 S PSBINSA=X
"RTN","PSBOVT",32,0)
 Q
"RTN","PSBOVT",33,0)
 ;
"RTN","PSBOVT",34,0)
PSBIOCH ;
"RTN","PSBOVT",35,0)
 S IOF="#"
"RTN","PSBOVT",36,0)
 S IOSL="66"
"RTN","PSBOVT",37,0)
 Q
"RTN","PSBOVT",38,0)
 ;
"RTN","PSBOVT",39,0)
 ;
"RTN","PSBOWA")
0^33^B46636390
"RTN","PSBOWA",1,0)
PSBOWA ;BIRMINGHAM/EFC-WARD ADMINISTRATION TIMES ;Mar 2004
"RTN","PSBOWA",2,0)
 ;;3.0;BAR CODE MED ADMIN;;Mar 2004
"RTN","PSBOWA",3,0)
 ;
"RTN","PSBOWA",4,0)
 ; Reference/IA
"RTN","PSBOWA",5,0)
 ; ^DPT/10035
"RTN","PSBOWA",6,0)
 ; EN^PSJBCMA/2828
"RTN","PSBOWA",7,0)
 ;
"RTN","PSBOWA",8,0)
EN ;
"RTN","PSBOWA",9,0)
 N PSBHDR,PSBGTOT,PSBTOT,PSBINDX,DFN,PSBX,PSBY,PSBSM,PSBADST,PSBZ
"RTN","PSBOWA",10,0)
 S (Y,PSBEVDT)=$P(PSBRPT(.1),U,6) D D^DIQ
"RTN","PSBOWA",11,0)
 S PSBHDR(2)="ADMINISTRATION DATE: "_Y
"RTN","PSBOWA",12,0)
 D:$P(PSBRPT(.1),U)="W"
"RTN","PSBOWA",13,0)
 .F X=0,.01:.01:.24 S PSBGTOT(X)=""
"RTN","PSBOWA",14,0)
 .W $$WRDHDR()
"RTN","PSBOWA",15,0)
 .S PSBINDX=""
"RTN","PSBOWA",16,0)
 .F  S PSBINDX=$O(^TMP("PSBO",$J,"B",PSBINDX)) Q:PSBINDX=""  D
"RTN","PSBOWA",17,0)
 ..F DFN=0:0 S DFN=$O(^TMP("PSBO",$J,"B",PSBINDX,DFN)) Q:'DFN  D
"RTN","PSBOWA",18,0)
 ...W:$Y>(IOSL-10) $$WRDHDR()
"RTN","PSBOWA",19,0)
 ...W !,$P(^DPT(DFN,0),U,1),!,"SSN: ",$P(^(0),U,9)
"RTN","PSBOWA",20,0)
 ...W !,"Ward: ",$E($G(^DPT(DFN,.1)),1,25),!,"Room-Bed:  ",$E($G(^(.101)),1,21)
"RTN","PSBOWA",21,0)
 ...W ?32
"RTN","PSBOWA",22,0)
 ...F X=0,.01:.01:.24 S PSBTOT(X)=""
"RTN","PSBOWA",23,0)
 ...K ^TMP("PSJ",$J)
"RTN","PSBOWA",24,0)
 ...D EN^PSJBCMA(DFN,$P(PSBRPT(.1),U,6))
"RTN","PSBOWA",25,0)
 ...F PSBX=0:0 S PSBX=$O(^TMP("PSJ",$J,PSBX)) Q:'PSBX  D
"RTN","PSBOWA",26,0)
 ....Q:^TMP("PSJ",$J,PSBX,0)=-1  ; No Orders
"RTN","PSBOWA",27,0)
 ....D CLEAN^PSBVT
"RTN","PSBOWA",28,0)
 ....D PSJ^PSBVT(PSBX)
"RTN","PSBOWA",29,0)
 ....Q:PSBSCHT'="C"  ; Not a Continuous
"RTN","PSBOWA",30,0)
 ....Q:PSBOSTS'="A"&(PSBOSTS'="R")  ; Active?
"RTN","PSBOWA",31,0)
 ....Q:PSBSM=1  ;Self med?
"RTN","PSBOWA",32,0)
 ....S (PSBCADM,PSBYES,PSBODD)=0
"RTN","PSBOWA",33,0)
 ....S PSBFREQ=$$GETFREQ^PSBVDLU1(DFN,PSBONX)
"RTN","PSBOWA",34,0)
 ....S:$$PSBDCHK1^PSBVT1(PSBSCH) PSBYES=1
"RTN","PSBOWA",35,0)
 ....F I=1:1 Q:$P(PSBSCH,"-",I)=""  I ($P(PSBSCH,"-",I)?2N)!($P(PSBSCH,"-",I)?4N) S PSBYES=1
"RTN","PSBOWA",36,0)
 ....I PSBYES,PSBADST="",PSBSCHT'="O",PSBSCHT'="OC",PSBSCHT'="P" D  Q
"RTN","PSBOWA",37,0)
 .....D ERROR^PSBMLU(PSBONX,PSBOITX,DFN,"Admin times required",PSBSCH)
"RTN","PSBOWA",38,0)
 ....I "PCS"'[PSBIVT,PSBONX'["U" Q
"RTN","PSBOWA",39,0)
 ....I PSBIVT["S",PSBISYR'=1 Q  ;    allow intermittent syringe only
"RTN","PSBOWA",40,0)
 ....I PSBIVT["C",PSBCHEMT'="P",PSBISYR'=1 Q
"RTN","PSBOWA",41,0)
 ....I PSBIVT["C",PSBCHEMT="A" Q  ;     allow Chemo with intermittent syringe or Piggyback type only
"RTN","PSBOWA",42,0)
 ....I PSBFREQ="D" S PSBFREQ=""  ;BSR
"RTN","PSBOWA",43,0)
 ....I 'PSBYES,PSBFREQ<1 D  Q
"RTN","PSBOWA",44,0)
 .....D ERROR^PSBMLU(PSBONX,PSBOITX,DFN,"Invalid frequency received from order",PSBSCH)
"RTN","PSBOWA",45,0)
 ....I +PSBFREQ>0 D
"RTN","PSBOWA",46,0)
 .....I (PSBFREQ#1440'=0),(1440#PSBFREQ'=0) S PSBODD=1
"RTN","PSBOWA",47,0)
 ....I PSBODD,PSBADST'="" D  Q
"RTN","PSBOWA",48,0)
 .....D ERROR^PSBMLU(PSBONX,PSBOITX,DFN,"Administration Times on ODD SCHEDULE",PSBSCH)
"RTN","PSBOWA",49,0)
 ....K ^TMP("PSB",$J,"GETADMIN")
"RTN","PSBOWA",50,0)
 ....I PSBADST="" S PSBADST=$$GETADMIN^PSBVDLU1(DFN,PSBONX,PSBOST,PSBFREQ,PSBEVDT) S:PSBADST'="" PSBCADM=1
"RTN","PSBOWA",51,0)
 ....E  S ^TMP("PSB",$J,"GETADMIN",0)=PSBADST
"RTN","PSBOWA",52,0)
 ....Q:PSBADST=""
"RTN","PSBOWA",53,0)
 ....I PSBONX'["V" D  Q:'$$OKAY^PSBVDLU1(PSBOST,$P(PSBRPT(.1),U,6),PSBSCH,PSBONX,PSBOIT,PSBFREQ)
"RTN","PSBOWA",54,0)
 ....I PSBONX["V",PSBSCH'=""  Q:'$$OKAY^PSBVDLU1(PSBOST,$P(PSBRPT(.1),U,6),PSBSCH,PSBONX,PSBOIT,PSBFREQ)
"RTN","PSBOWA",55,0)
 ....F PSBXX=0:1 Q:'$D(^TMP("PSB",$J,"GETADMIN",PSBXX))  S PSBADST=$G(^TMP("PSB",$J,"GETADMIN",PSBXX)) D
"RTN","PSBOWA",56,0)
 .....F Y=1:1:$L(PSBADST,"-") S Z=+("."_$E($P(PSBADST,"-",Y),1,2)) D
"RTN","PSBOWA",57,0)
 ......Q:($P(PSBRPT(.1),U,6)+Z)<$E(PSBOST,1,10)  ;Start Date
"RTN","PSBOWA",58,0)
 ......Q:($P(PSBRPT(.1),U,6)+Z)'<$E(PSBOSP,1,10)  ;Stop Date
"RTN","PSBOWA",59,0)
 ......;For invalid admin times
"RTN","PSBOWA",60,0)
 ......D:($P(PSBADST,"-",Y)'?2N)&($P(PSBADST,"-",Y)'?4N)
"RTN","PSBOWA",61,0)
 .......D ERROR^PSBMLU(PSBONX,PSBOITX,DFN,"Invalid Admin times",PSBSCH)
"RTN","PSBOWA",62,0)
 ......S PSBTOT(Z)=PSBTOT(Z)+1
"RTN","PSBOWA",63,0)
 ......S PSBGTOT(Z)=PSBGTOT(Z)+1
"RTN","PSBOWA",64,0)
 ...F PSBX=0:0 S PSBX=$O(PSBTOT(PSBX)) Q:'PSBX  W $J(PSBTOT(PSBX),4)
"RTN","PSBOWA",65,0)
 ...W !,$TR($J("",IOM)," ","-")
"RTN","PSBOWA",66,0)
 .W !!,$TR($J("",IOM)," ","=")
"RTN","PSBOWA",67,0)
 .W !?32 F X=.01:.01:.24 W $J($E(X_"00",2,3),4)
"RTN","PSBOWA",68,0)
 .W !,"Hourly Totals:",?32
"RTN","PSBOWA",69,0)
 .S PSBGTOT=0
"RTN","PSBOWA",70,0)
 .F PSBX=0:0 S PSBX=$O(PSBGTOT(PSBX)) Q:'PSBX  D
"RTN","PSBOWA",71,0)
 ..W $J(PSBGTOT(PSBX),4)
"RTN","PSBOWA",72,0)
 ..S PSBGTOT=PSBGTOT+PSBGTOT(PSBX)
"RTN","PSBOWA",73,0)
 .W !!,"Ward Total:",?32,$J(PSBGTOT,4)
"RTN","PSBOWA",74,0)
 .W !!,$TR($J("",IOM)," ","-")
"RTN","PSBOWA",75,0)
 .K ^TMP("PSJ",$J)
"RTN","PSBOWA",76,0)
 D:$P(PSBRPT(.1),U)="P"
"RTN","PSBOWA",77,0)
 .S DFN=PSBDFN
"RTN","PSBOWA",78,0)
 .S PSBHDR(1)="WARD ADMINISTRATION TIMES"
"RTN","PSBOWA",79,0)
 .S Y=$P(PSBRPT(.1),U,6) D D^DIQ S PSBHDR(2)="ADMINISTRATION DATE: "_Y
"RTN","PSBOWA",80,0)
 .W $$PTHDR()
"RTN","PSBOWA",81,0)
 .K ^TMP("PSJ",$J),PSBTOT
"RTN","PSBOWA",82,0)
 .D EN^PSJBCMA(PSBDFN,$P(PSBRPT(.1),U,6),"")
"RTN","PSBOWA",83,0)
 .F PSBX=0:0 S PSBX=$O(^TMP("PSJ",$J,PSBX)) Q:'PSBX  D
"RTN","PSBOWA",84,0)
 ..Q:^TMP("PSJ",$J,PSBX,0)=-1  ; No Orders
"RTN","PSBOWA",85,0)
 ..D CLEAN^PSBVT
"RTN","PSBOWA",86,0)
 ..D PSJ^PSBVT(PSBX)
"RTN","PSBOWA",87,0)
 ..Q:PSBSCHT'="C"  ; Not a Continuous
"RTN","PSBOWA",88,0)
 ..Q:PSBOSTS'="A"&(PSBOSTS'="R")  ; Active?
"RTN","PSBOWA",89,0)
 ..S (PSBCADM,PSBYES,PSBODD)=0
"RTN","PSBOWA",90,0)
 ..S PSBFREQ=$$GETFREQ^PSBVDLU1(DFN,PSBONX)
"RTN","PSBOWA",91,0)
 ..S:$$PSBDCHK1^PSBVT1(PSBSCH) PSBYES=1
"RTN","PSBOWA",92,0)
 ..F I=1:1 Q:$P(PSBSCH,"-",I)=""  I ($P(PSBSCH,"-",I)?2N)!($P(PSBSCH,"-",I)?4N) S PSBYES=1
"RTN","PSBOWA",93,0)
 ..I PSBYES,PSBADST="",PSBSCHT'="O",PSBSCHT'="OC",PSBSCHT'="P" D  Q
"RTN","PSBOWA",94,0)
 ...D ERROR^PSBMLU(PSBONX,PSBOITX,DFN,"Admin times required",PSBSCH)
"RTN","PSBOWA",95,0)
 ..I "PCS"'[PSBIVT,PSBONX'["U" Q
"RTN","PSBOWA",96,0)
 ..I PSBIVT["S",PSBISYR'=1 Q  ;    allow intermittent syringe only
"RTN","PSBOWA",97,0)
 ..I PSBIVT["C",PSBCHEMT'="P",PSBISYR'=1 Q
"RTN","PSBOWA",98,0)
 ..I PSBIVT["C",PSBCHEMT="A" Q  ;     allow Chemo with intermittent syringe or Piggyback type only
"RTN","PSBOWA",99,0)
 ..I PSBFREQ="D" S PSBFREQ=""  ;BSR
"RTN","PSBOWA",100,0)
 ..I 'PSBYES,PSBFREQ<1 D  Q
"RTN","PSBOWA",101,0)
 ...D ERROR^PSBMLU(PSBONX,PSBOITX,DFN,"Invalid frequency received from order",PSBSCH)
"RTN","PSBOWA",102,0)
 ..I +PSBFREQ>0 D
"RTN","PSBOWA",103,0)
 ...I (PSBFREQ#1440'=0),(1440#PSBFREQ'=0) S PSBODD=1
"RTN","PSBOWA",104,0)
 ..I PSBODD,PSBADST'="" D  Q
"RTN","PSBOWA",105,0)
 ...D ERROR^PSBMLU(PSBONX,PSBOITX,DFN,"Administration Times on ODD SCHEDULE",PSBSCH)
"RTN","PSBOWA",106,0)
 ..K ^TMP("PSB",$J,"GETADMIN")
"RTN","PSBOWA",107,0)
 ..I PSBADST="",+$G(PSBFREQ)>0,$G(PSBFREQ)<30 S PSBADST="MESSAGE",$P(PSBTOT(PSBADST,PSBOITX,PSBONX),2)="Due every "_PSBFREQ_" Mins" Q
"RTN","PSBOWA",108,0)
 ..I PSBADST="",+$G(PSBFREQ)'<30 S PSBADST=$$GETADMIN^PSBVDLU1(DFN,PSBONX,PSBOST,PSBFREQ,PSBEVDT) S:PSBADST'="" PSBCADM=1
"RTN","PSBOWA",109,0)
 ..E  S ^TMP("PSB",$J,"GETADMIN",0)=PSBADST
"RTN","PSBOWA",110,0)
 ..Q:PSBADST=""
"RTN","PSBOWA",111,0)
 ..I PSBONX'["V" D  Q:'$$OKAY^PSBVDLU1(PSBOST,$P(PSBRPT(.1),U,6),PSBSCH,PSBONX,PSBOIT,PSBFREQ)
"RTN","PSBOWA",112,0)
 ..I PSBONX["V",PSBSCH'=""  Q:'$$OKAY^PSBVDLU1(PSBOST,$P(PSBRPT(.1),U,6),PSBSCH,PSBONX,PSBOIT,PSBFREQ)
"RTN","PSBOWA",113,0)
 ..F PSBXX=0:1 Q:'$D(^TMP("PSB",$J,"GETADMIN",PSBXX))  S PSBADST=$G(^TMP("PSB",$J,"GETADMIN",PSBXX)) D
"RTN","PSBOWA",114,0)
 ...F Y=1:1:$L(PSBADST,"-") S Z=+("."_$P(PSBADST,"-",Y)) D
"RTN","PSBOWA",115,0)
 ....Q:($P(PSBRPT(.1),U,6)+Z)<$E(PSBOST,1,10)  ; Start Date
"RTN","PSBOWA",116,0)
 ....Q:($P(PSBRPT(.1),U,6)+Z)'<$E(PSBOSP,1,10)  ; Stop Date
"RTN","PSBOWA",117,0)
 ....;For Invalid admin times
"RTN","PSBOWA",118,0)
 ....D:($P(PSBADST,"-",Y)'?2N)&($P(PSBADST,"-",Y)'?4N)
"RTN","PSBOWA",119,0)
 .....D ERROR^PSBMLU(PSBONX,PSBOITX,DFN,"Invalid Admin times",PSBSCH)
"RTN","PSBOWA",120,0)
 ....S PSBSM=$S(PSBHSM=1:"HSM",PSBSM=1:"SM",1:"")
"RTN","PSBOWA",121,0)
 ....;*** Local array to include order no
"RTN","PSBOWA",122,0)
 ....S PSBTOT(Z,PSBOITX,PSBONX)=PSBSM_U_"Dosage: "_PSBDOSE_"  Route: "_PSBMR_"  "_PSBIFR
"RTN","PSBOWA",123,0)
 .S PSBX="" F  S PSBX=$O(PSBTOT(PSBX)) Q:PSBX=""  D
"RTN","PSBOWA",124,0)
 ..W !
"RTN","PSBOWA",125,0)
 ..S PSBY="" F  S PSBY=$O(PSBTOT(PSBX,PSBY)) Q:PSBY=""  D
"RTN","PSBOWA",126,0)
 ...S PSBZ="" F  S PSBZ=$O(PSBTOT(PSBX,PSBY,PSBZ)) Q:PSBZ=""  D
"RTN","PSBOWA",127,0)
 ....W:$Y>(IOSL-6) $$PTFTR^PSBOHDR(),$$PTHDR()
"RTN","PSBOWA",128,0)
 ....I PSBX="MESSAGE" W !,$P(PSBTOT(PSBX,PSBY,PSBZ),U,1),?20,PSBY Q
"RTN","PSBOWA",129,0)
 ....W !,$$TIMEOUT^PSBUTL(PSBX),?10
"RTN","PSBOWA",130,0)
 ....W $P(PSBTOT(PSBX,PSBY,PSBZ),U,1),?20,PSBY,?55,$P(PSBTOT(PSBX,PSBY,PSBZ),U,2)
"RTN","PSBOWA",131,0)
 .W $$PTFTR^PSBOHDR()
"RTN","PSBOWA",132,0)
 K ^TMP("PSJ",$J),^TMP("PSB",$J)
"RTN","PSBOWA",133,0)
 Q
"RTN","PSBOWA",134,0)
 ;
"RTN","PSBOWA",135,0)
WRDHDR() ;
"RTN","PSBOWA",136,0)
 S PSBHDR(1)="WARD ADMINISTRATION TIMES"
"RTN","PSBOWA",137,0)
 D WARD^PSBOHDR(PSBWRD,.PSBHDR)
"RTN","PSBOWA",138,0)
 W !,"Patient Name",?72,"Administration Times"
"RTN","PSBOWA",139,0)
 W !,"Room-Bed",?32
"RTN","PSBOWA",140,0)
 F X=.01:.01:.24 W $J($E(X_"00",2,3),4)
"RTN","PSBOWA",141,0)
 W !,$TR($J("",IOM)," ","-")
"RTN","PSBOWA",142,0)
 Q ""
"RTN","PSBOWA",143,0)
 ;
"RTN","PSBOWA",144,0)
PTHDR() ;
"RTN","PSBOWA",145,0)
 S PSBHDR(1)="PATIENT ADMINISTRATION TIMES"
"RTN","PSBOWA",146,0)
 D PT^PSBOHDR(PSBDFN,.PSBHDR)
"RTN","PSBOWA",147,0)
 W !,"Time",?10,"Self Med",?20,"Medication",?55,"Dose/Route"
"RTN","PSBOWA",148,0)
 W !,$TR($J("",IOM)," ","-")
"RTN","PSBOWA",149,0)
 Q ""
"RTN","PSBOWA",150,0)
 ;
"RTN","PSBPAR")
0^34^B19006745
"RTN","PSBPAR",1,0)
PSBPAR ;BIRMINGHAM/EFC-BCMA PARAMETER MANAGEMENT ;Mar 2004
"RTN","PSBPAR",2,0)
 ;;3.0;BAR CODE MED ADMIN;;Mar 2004
"RTN","PSBPAR",3,0)
 ;
"RTN","PSBPAR",4,0)
EN ; Standard editting of parameters
"RTN","PSBPAR",5,0)
 K PSBDIV,PSBLIST,DIC
"RTN","PSBPAR",6,0)
 W !!,"BCMA Parameters Management",!!
"RTN","PSBPAR",7,0)
 W "You are currently logged onto Division: "_DUZ(2)
"RTN","PSBPAR",8,0)
 S DIC="^DIC(4,",DIC(0)="AEQM",DIC("A")="Select Division: " D ^DIC Q:+Y<1
"RTN","PSBPAR",9,0)
 S PSBDIV=+Y_";DIC(4,"
"RTN","PSBPAR",10,0)
 K DIR S DIR(0)="Y",DIR("A")="Edit Divisional Parameters",DIR("B")="Yes"
"RTN","PSBPAR",11,0)
 D ^DIR K DIR I Y D TED^XPAREDIT("PSB DIVISION","AB",PSBDIV)
"RTN","PSBPAR",12,0)
 K DIR S DIR(0)="Y",DIR("A")="Edit Default Lists",DIR("B")="Yes"
"RTN","PSBPAR",13,0)
 D ^DIR K DIR D:Y
"RTN","PSBPAR",14,0)
 .S DIR(0)="SO^1:Reasons Given PRN;2:Reasons Held;3:Reasons Refused;4:Injection Sites"
"RTN","PSBPAR",15,0)
 .S DIR("A")="Select Default List"
"RTN","PSBPAR",16,0)
 .F  W @IOF,!,"BCMA Default Lists",! D ^DIR Q:'Y  D
"RTN","PSBPAR",17,0)
 ..N DIR
"RTN","PSBPAR",18,0)
 ..I Y=1 D TED^XPAREDIT("PSB LIST REASONS GIVEN PRN","AB",PSBDIV) Q
"RTN","PSBPAR",19,0)
 ..I Y=2 D TED^XPAREDIT("PSB LIST REASONS HELD","AB",PSBDIV) Q
"RTN","PSBPAR",20,0)
 ..I Y=3 D TED^XPAREDIT("PSB LIST REASONS REFUSED","AB",PSBDIV) Q
"RTN","PSBPAR",21,0)
 ..I Y=4 D TED^XPAREDIT("PSB LIST INJECTION SITES","AB",PSBDIV) Q
"RTN","PSBPAR",22,0)
 Q
"RTN","PSBPAR",23,0)
 ;
"RTN","PSBPAR",24,0)
RPC(RESULTS,PSBCMD,PSBENT,PSBPAR,PSBINS,PSBVAL) ; Main RPC Hit Point
"RTN","PSBPAR",25,0)
 ;
"RTN","PSBPAR",26,0)
 ; RPC: PSB PARAMETER
"RTN","PSBPAR",27,0)
 ;
"RTN","PSBPAR",28,0)
 ; Description:
"RTN","PSBPAR",29,0)
 ; Called by client to return or set parameters
"RTN","PSBPAR",30,0)
 ;
"RTN","PSBPAR",31,0)
 N PSBERR,PSBTMP
"RTN","PSBPAR",32,0)
 D:PSBCMD="GETPAR" GETPAR(PSBENT,PSBPAR)
"RTN","PSBPAR",33,0)
 D:PSBCMD="GETLST" GETLST(PSBENT,PSBPAR)
"RTN","PSBPAR",34,0)
 D:PSBCMD="SETPAR" SETPAR(PSBENT,PSBPAR,PSBINS,PSBVAL)
"RTN","PSBPAR",35,0)
 D:PSBCMD="DELLST" DELLST(PSBENT,PSBPAR)
"RTN","PSBPAR",36,0)
 D:PSBCMD="GETDIV" GETDIV(PSBENT)
"RTN","PSBPAR",37,0)
 S:'$D(RESULTS) RESULTS(0)="-1^Unknown Internal Error "_PSBCMD
"RTN","PSBPAR",38,0)
 Q
"RTN","PSBPAR",39,0)
 ;
"RTN","PSBPAR",40,0)
GETDIV(PSBENT) ; Return a valid Entity pointer from user input
"RTN","PSBPAR",41,0)
 S X=$$FIND1^DIC(4,"","MX",PSBENT)
"RTN","PSBPAR",42,0)
 I +X<1 S RESULTS(0)="-1^Error, Station # "_PSBENT_" not found." Q
"RTN","PSBPAR",43,0)
 S RESULTS(0)="1^"_(+X)_";DIC(4,"
"RTN","PSBPAR",44,0)
 S RESULTS(1)=$$GET1^DIQ(4,+X_",",.01)_" ("_$$GET1^DIQ(4,+X_",",99)_")"
"RTN","PSBPAR",45,0)
 S RESULTS(2)=$$GET1^DIQ(4,+X_",",1.01)
"RTN","PSBPAR",46,0)
 S RESULTS(3)=$$GET1^DIQ(4,+X_",",1.02)
"RTN","PSBPAR",47,0)
 S RESULTS(4)=$$GET1^DIQ(4,+X_",",1.03)
"RTN","PSBPAR",48,0)
 S RESULTS(5)=$$GET1^DIQ(4,+X_",",.02)
"RTN","PSBPAR",49,0)
 S RESULTS(6)=$$GET1^DIQ(4,+X_",",1.04)
"RTN","PSBPAR",50,0)
 S PSBEDIV=+X  ;do NOT kill this variable - needed until gui context ends
"RTN","PSBPAR",51,0)
 Q
"RTN","PSBPAR",52,0)
 ;
"RTN","PSBPAR",53,0)
GETPAR(PSBENT,PSBPAR) ; Return a parameter
"RTN","PSBPAR",54,0)
 S RESULTS(0)=$$GET^XPAR(PSBENT,PSBPAR,,"B")
"RTN","PSBPAR",55,0)
 Q
"RTN","PSBPAR",56,0)
 ;
"RTN","PSBPAR",57,0)
GETLST(PSBENT,PSBPAR) ; Return a parameter list
"RTN","PSBPAR",58,0)
 D GETLST^XPAR(.PSBTMP,PSBENT,PSBPAR,,.PSBERR)
"RTN","PSBPAR",59,0)
 I PSBERR S RESULTS(0)="-1^Error: "_(+PSBERR)_" "_$P(PSBERR,"^",2) Q
"RTN","PSBPAR",60,0)
 S RESULTS(0)=PSBTMP
"RTN","PSBPAR",61,0)
 F Y=0:0 S Y=$O(PSBTMP(Y)) Q:'Y  S RESULTS(Y)=$P(PSBTMP(Y),"^",2)
"RTN","PSBPAR",62,0)
 Q
"RTN","PSBPAR",63,0)
 ;
"RTN","PSBPAR",64,0)
SETPAR(PSBENT,PSBPAR,PSBINS,PSBVAL) ; Set a new parameter
"RTN","PSBPAR",65,0)
 D EN^XPAR(PSBENT,PSBPAR,PSBINS,PSBVAL,.PSBERR)
"RTN","PSBPAR",66,0)
 I 'PSBERR S RESULTS(0)="1^Success"
"RTN","PSBPAR",67,0)
 E  S RESULTS(0)="-1^Error: "_(+PSBERR)_" "_$P(PSBERR,"^",2)
"RTN","PSBPAR",68,0)
 Q
"RTN","PSBPAR",69,0)
 ;
"RTN","PSBPAR",70,0)
DELLST(PSBENT,PSBPAR) ; Clear a list
"RTN","PSBPAR",71,0)
 D NDEL^XPAR(PSBENT,PSBPAR,.PSBERR)
"RTN","PSBPAR",72,0)
 I 'PSBERR S RESULTS(0)="1^Success"
"RTN","PSBPAR",73,0)
 E  S RESULTS(0)="-1^Error: "_(+PSBERR)_" "_$P(PSBERR,"^",2)
"RTN","PSBPAR",74,0)
 Q
"RTN","PSBPAR",75,0)
 ;
"RTN","PSBPAR",76,0)
USRDEF(PSBPAR) ; Return a parameter for the user
"RTN","PSBPAR",77,0)
 Q $$GET^XPAR("ALL",PSBPAR)
"RTN","PSBPAR",78,0)
 ;
"RTN","PSBPAR",79,0)
RSTUSR ; Reset all a users parameters
"RTN","PSBPAR",80,0)
 N PSBUSR,PSBENT,RESULTS
"RTN","PSBPAR",81,0)
 S DIC="^VA(200,",DIC(0)="AEQM",DIC("A")="Select User to Reset: "
"RTN","PSBPAR",82,0)
 D ^DIC K DIC Q:+Y<1  S PSBUSR=+Y
"RTN","PSBPAR",83,0)
 W !!,"Are you sure you want to reset all parameters for this user"
"RTN","PSBPAR",84,0)
 S %=2 D YN^DICN Q:%'=1
"RTN","PSBPAR",85,0)
 W !,"Resetting..."
"RTN","PSBPAR",86,0)
 S PSBENT=PSBUSR_";VA(200,"
"RTN","PSBPAR",87,0)
 D DEL^XPAR(PSBENT,"PSB PRINTER USER DEFAULT",1)
"RTN","PSBPAR",88,0)
 D DEL^XPAR(PSBENT,"PSB VDL INCL BLANKS",1)
"RTN","PSBPAR",89,0)
 D DEL^XPAR(PSBENT,"PSB VDL INCL CONT",1)
"RTN","PSBPAR",90,0)
 D DEL^XPAR(PSBENT,"PSB VDL INCL IV MEDS",1)
"RTN","PSBPAR",91,0)
 D DEL^XPAR(PSBENT,"PSB VDL INCL ON-CALL",1)
"RTN","PSBPAR",92,0)
 D DEL^XPAR(PSBENT,"PSB VDL INCL ONE-TIME",1)
"RTN","PSBPAR",93,0)
 D DEL^XPAR(PSBENT,"PSB VDL INCL PRN",1)
"RTN","PSBPAR",94,0)
 D DEL^XPAR(PSBENT,"PSB VDL INCL UD MEDS",1)
"RTN","PSBPAR",95,0)
 D DEL^XPAR(PSBENT,"PSB VDL START TIME",1)
"RTN","PSBPAR",96,0)
 D DEL^XPAR(PSBENT,"PSB VDL STOP TIME",1)
"RTN","PSBPAR",97,0)
 D DEL^XPAR(PSBENT,"PSB WINDOW",1)
"RTN","PSBPAR",98,0)
 D DEL^XPAR(PSBENT,"PSB UNIT DOSE COLUMN WIDTHS",1)
"RTN","PSBPAR",99,0)
 D DEL^XPAR(PSBENT,"PSB VDL SORT COLUMN",1)
"RTN","PSBPAR",100,0)
 D DEL^XPAR(PSBENT,"PSB VDL PB SORT COLUMN",1)
"RTN","PSBPAR",101,0)
 D DEL^XPAR(PSBENT,"PSB VDL IV SORT COLUMN",1)
"RTN","PSBPAR",102,0)
 D DEL^XPAR(PSBENT,"PSB IV COLUMN WIDTHS",1)
"RTN","PSBPAR",103,0)
 D DEL^XPAR(PSBENT,"PSB IVPB COLUMN WIDTHS",1)
"RTN","PSBPAR",104,0)
 D DEL^XPAR(PSBENT,"PSB HKEY",1)
"RTN","PSBPAR",105,0)
 D DEL^XPAR(PSBENT,"PSB IDLE TIMEOUT",1)
"RTN","PSBPAR",106,0)
 D DEL^XPAR(PSBENT,"PSB GUI DEFAULT PRINTER",1)
"RTN","PSBPAR",107,0)
 W "Done.",!
"RTN","PSBPAR",108,0)
 Q
"RTN","PSBPAR",109,0)
 ;
"RTN","PSBPARIV")
0^35^B48555967
"RTN","PSBPARIV",1,0)
PSBPARIV ;BIRMINGHAM/EFC-BCMA IV PARAMETERS FUNCTIONS ;Mar 2004
"RTN","PSBPARIV",2,0)
 ;;3.0;BAR CODE MED ADMIN;;Mar 2004
"RTN","PSBPARIV",3,0)
 ;
"RTN","PSBPARIV",4,0)
 ; Reference/IA
"RTN","PSBPARIV",5,0)
 ; ^DIC(42/1377
"RTN","PSBPARIV",6,0)
 ; ^DIC(42/2440
"RTN","PSBPARIV",7,0)
 ; $$SITE^VASITE/10112
"RTN","PSBPARIV",8,0)
 ; $$GET^XPAR/2263
"RTN","PSBPARIV",9,0)
 ; WIN^DGPMDDCF/1246
"RTN","PSBPARIV",10,0)
 ;
"RTN","PSBPARIV",11,0)
WLIST(RESULTS,PSBEDIV) ; get the ward list for the IV Parameters GUI
"RTN","PSBPARIV",12,0)
 K ^TMP("PSB",$J)
"RTN","PSBPARIV",13,0)
 S RESULTS=$NAME(^TMP("PSB",$J)),^TMP("PSB",$J,0)=1,^TMP("PSB",$J,1)="ALL^1^0^1^1^1^1^1"
"RTN","PSBPARIV",14,0)
 S PSBX="" F  S PSBX=$O(^DIC(42,"B",PSBX)) Q:PSBX=""  D
"RTN","PSBPARIV",15,0)
 .S D0=$O(^DIC(42,"B",PSBX,"")) D WIN^DGPMDDCF Q:X=1 
"RTN","PSBPARIV",16,0)
 .S PSBD=$$GET1^DIQ(42,D0_",",.015,"I") Q:PSBD=""
"RTN","PSBPARIV",17,0)
 .S PSBD=$P($$SITE^VASITE(DT,PSBD),U,1) Q:PSBD'=$G(PSBEDIV)
"RTN","PSBPARIV",18,0)
 .S PSBNODE=^TMP("PSB",$J,0)+1,^TMP("PSB",$J,0)=PSBNODE,^TMP("PSB",$J,PSBNODE)=PSBX_"^0"
"RTN","PSBPARIV",19,0)
 .I $D(^PSB(53.66,"B",D0)) S PSBIEN=$O(^PSB(53.66,"B",D0,"")),$P(^TMP("PSB",$J,PSBNODE),U,2)="1^"_PSBIEN_"^0^0^0^0^0" D
"RTN","PSBPARIV",20,0)
 ..S PSBY="" F  S PSBY=$O(^PSB(53.66,PSBIEN,1,"B",PSBY)) Q:PSBY=""  S $P(^TMP("PSB",$J,PSBNODE),U,$FIND("ACHPS",PSBY)+2)=1
"RTN","PSBPARIV",21,0)
 Q
"RTN","PSBPARIV",22,0)
 ;
"RTN","PSBPARIV",23,0)
GETPAR(RESULTS,PSBWARD,PSBIVPT,PSBDIV) ;get parameters for a specific ward and type
"RTN","PSBPARIV",24,0)
 K ^TMP("PSB",$J)
"RTN","PSBPARIV",25,0)
 I $G(PSBDIV)'="" S PSBEDIV=PSBDIV
"RTN","PSBPARIV",26,0)
 S RESULTS=$NAME(^TMP("PSB",$J)),^TMP("PSB",$J,0)="-1^Ward is not defined in BCMA IV PARAMETERS file 53.66"
"RTN","PSBPARIV",27,0)
 D CHKDIV
"RTN","PSBPARIV",28,0)
 S:PSBEDIV'["DIV.`" PSBEDIV="DIV.`"_PSBEDIV
"RTN","PSBPARIV",29,0)
 I PSBWARD=0 D  Q
"RTN","PSBPARIV",30,0)
 .S PSBPAR=PSBIVPT_U_$$GET^XPAR(PSBEDIV,"PSBIV ADDITIVE",PSBIVPT)
"RTN","PSBPARIV",31,0)
 .S PSBPAR=PSBPAR_U_$$GET^XPAR(PSBEDIV,"PSBIV STRENGTH",PSBIVPT)
"RTN","PSBPARIV",32,0)
 .S PSBPAR=PSBPAR_U_$$GET^XPAR(PSBEDIV,"PSBIV BOTTLE",PSBIVPT)
"RTN","PSBPARIV",33,0)
 .S PSBPAR=PSBPAR_U_$$GET^XPAR(PSBEDIV,"PSBIV SOLUTION",PSBIVPT)
"RTN","PSBPARIV",34,0)
 .S PSBPAR=PSBPAR_U_$$GET^XPAR(PSBEDIV,"PSBIV VOLUME",PSBIVPT)
"RTN","PSBPARIV",35,0)
 .S PSBPAR=PSBPAR_U_$$GET^XPAR(PSBEDIV,"PSBIV INFUSION RATE",PSBIVPT)
"RTN","PSBPARIV",36,0)
 .S PSBPAR=PSBPAR_U_$$GET^XPAR(PSBEDIV,"PSBIV MED ROUTE",PSBIVPT)
"RTN","PSBPARIV",37,0)
 .S PSBPAR=PSBPAR_U_$$GET^XPAR(PSBEDIV,"PSBIV SCHEDULE",PSBIVPT)
"RTN","PSBPARIV",38,0)
 .S PSBPAR=PSBPAR_U_$$GET^XPAR(PSBEDIV,"PSBIV ADMIN TIME",PSBIVPT)
"RTN","PSBPARIV",39,0)
 .S PSBPAR=PSBPAR_U_$$GET^XPAR(PSBEDIV,"PSBIV REMARKS",PSBIVPT)
"RTN","PSBPARIV",40,0)
 .S PSBPAR=PSBPAR_U_$$GET^XPAR(PSBEDIV,"PSBIV OTHER PRINT INFO",PSBIVPT)
"RTN","PSBPARIV",41,0)
 .S PSBPAR=PSBPAR_U_$$GET^XPAR(PSBEDIV,"PSBIV PROVIDER",PSBIVPT)
"RTN","PSBPARIV",42,0)
 .S PSBPAR=PSBPAR_U_$$GET^XPAR(PSBEDIV,"PSBIV START DATE/TIME",PSBIVPT)
"RTN","PSBPARIV",43,0)
 .S PSBPAR=PSBPAR_U_$$GET^XPAR(PSBEDIV,"PSBIV STOP DATE/TIME",PSBIVPT)
"RTN","PSBPARIV",44,0)
 .S PSBPAR=PSBPAR_U_$$GET^XPAR(PSBEDIV,"PSBIV PROVIDER COMMENTS",PSBIVPT)
"RTN","PSBPARIV",45,0)
 .S ^TMP("PSB",$J,0)=PSBPAR
"RTN","PSBPARIV",46,0)
 I '$D(^PSB(53.66,PSBWARD)) Q
"RTN","PSBPARIV",47,0)
 I '$D(^PSB(53.66,PSBWARD,1,"B",PSBIVPT)) D  Q
"RTN","PSBPARIV",48,0)
 .S PSBIVPTX=$P("^ADDMIXTURE^PIGGYBACK^HYPERAL^SYRINGE^CHEMO",U,$F("APHSC",PSBIVPT))
"RTN","PSBPARIV",49,0)
 .S ^TMP("PSB",$J,0)="-1^"_PSBIVPTX_" IV PARAMETERS NOT DEFINED FOR WARD"
"RTN","PSBPARIV",50,0)
 S PSBPAR=$TR(^PSB(53.66,PSBWARD,1,$O(^PSB(53.66,PSBWARD,1,"B",PSBIVPT,0)),0),"WNI",123)
"RTN","PSBPARIV",51,0)
 S ^TMP("PSB",$J,0)=PSBPAR
"RTN","PSBPARIV",52,0)
 Q
"RTN","PSBPARIV",53,0)
 ;
"RTN","PSBPARIV",54,0)
CHKDIV ;
"RTN","PSBPARIV",55,0)
 ;
"RTN","PSBPARIV",56,0)
 S:PSBEDIV'["DIV.`" PSBEDIV="DIV.`"_PSBEDIV
"RTN","PSBPARIV",57,0)
 I '$$GET^XPAR(PSBEDIV,"PSBIV ADDITIVE") F I=1:1:5  D EN^XPAR(PSBEDIV,"PSBIV ADDITIVE",I,3)
"RTN","PSBPARIV",58,0)
 I '$$GET^XPAR(PSBEDIV,"PSBIV ADMIN TIME") F I=1:1:5  D EN^XPAR(PSBEDIV,"PSBIV ADMIN TIME",I,3)
"RTN","PSBPARIV",59,0)
 I '$$GET^XPAR(PSBEDIV,"PSBIV BOTTLE") F I=1:1:5  D EN^XPAR(PSBEDIV,"PSBIV BOTTLE",I,3)
"RTN","PSBPARIV",60,0)
 I '$$GET^XPAR(PSBEDIV,"PSBIV INFUSION RATE") F I=1:1:5  D EN^XPAR(PSBEDIV,"PSBIV INFUSION RATE",I,1)
"RTN","PSBPARIV",61,0)
 I '$$GET^XPAR(PSBEDIV,"PSBIV MED ROUTE") F I=1:1:5  D EN^XPAR(PSBEDIV,"PSBIV MED ROUTE",I,3)
"RTN","PSBPARIV",62,0)
 I '$$GET^XPAR(PSBEDIV,"PSBIV OTHER PRINT INFO") F I=1:1:5  D EN^XPAR(PSBEDIV,"PSBIV OTHER PRINT INFO",I,1)
"RTN","PSBPARIV",63,0)
 I '$$GET^XPAR(PSBEDIV,"PSBIV PROVIDER") F I=1:1:5  D EN^XPAR(PSBEDIV,"PSBIV PROVIDER",I,3)
"RTN","PSBPARIV",64,0)
 I '$$GET^XPAR(PSBEDIV,"PSBIV PROVIDER COMMENTS") F I=1:1:5  D EN^XPAR(PSBEDIV,"PSBIV PROVIDER COMMENTS",I,3)
"RTN","PSBPARIV",65,0)
 I '$$GET^XPAR(PSBEDIV,"PSBIV REMARKS") F I=1:1:5  D EN^XPAR(PSBEDIV,"PSBIV REMARKS",I,3)
"RTN","PSBPARIV",66,0)
 I '$$GET^XPAR(PSBEDIV,"PSBIV SCHEDULE") F I=1:1:5  D EN^XPAR(PSBEDIV,"PSBIV SCHEDULE",I,3)
"RTN","PSBPARIV",67,0)
 I '$$GET^XPAR(PSBEDIV,"PSBIV SOLUTION") F I=1:1:5  D EN^XPAR(PSBEDIV,"PSBIV SOLUTION",I,3)
"RTN","PSBPARIV",68,0)
 I '$$GET^XPAR(PSBEDIV,"PSBIV START DATE/TIME") F I=1:1:5  D EN^XPAR(PSBEDIV,"PSBIV START DATE/TIME",I,3)
"RTN","PSBPARIV",69,0)
 I '$$GET^XPAR(PSBEDIV,"PSBIV STOP DATE/TIME") F I=1:1:5  D EN^XPAR(PSBEDIV,"PSBIV STOP DATE/TIME",I,3)
"RTN","PSBPARIV",70,0)
 I '$$GET^XPAR(PSBEDIV,"PSBIV STRENGTH")  F I=1:1:5  D EN^XPAR(PSBEDIV,"PSBIV STRENGTH",I,3)
"RTN","PSBPARIV",71,0)
 I '$$GET^XPAR(PSBEDIV,"PSBIV VOLUME") F I=1:1:5  D EN^XPAR(PSBEDIV,"PSBIV VOLUME",I,3)
"RTN","PSBPARIV",72,0)
 Q
"RTN","PSBPARIV",73,0)
 ;
"RTN","PSBPARIV",74,0)
PUTPAR(RESULTS,PSBWARD,PSBPARS,PSBDIV) ;  set 53.66 (parameters file) with input iv parameters
"RTN","PSBPARIV",75,0)
 K ^TMP("PSB",$J)
"RTN","PSBPARIV",76,0)
 I $G(PSBDIV)'="" S PSBEDIV=PSBDIV
"RTN","PSBPARIV",77,0)
 N PSBDIEN S PSBDIEN=+($G(PSBEDIV))
"RTN","PSBPARIV",78,0)
 S:PSBEDIV'["DIV.`" PSBEDIV="DIV.`"_PSBEDIV
"RTN","PSBPARIV",79,0)
 N PSBFDA,PSBMSG,PSBWD,PSBIVPT,X,Z,PSBIVPR,I,K
"RTN","PSBPARIV",80,0)
 S RESULTS=$NAME(^TMP("PSB",$J))
"RTN","PSBPARIV",81,0)
 S PSBWARD=$G(PSBWARD)
"RTN","PSBPARIV",82,0)
 S PSBPARS=$G(PSBPARS)
"RTN","PSBPARIV",83,0)
 I $G(PSBDIEN)="" S ^TMP("PSB",$J,0)="-1^Division IEN required for ward"_$G(PSBWARD) Q
"RTN","PSBPARIV",84,0)
 S PSBWD=$P(PSBWARD,U,1),PSBIEN=$P(PSBWARD,U,2)
"RTN","PSBPARIV",85,0)
 S X="^ADDITIVE^STRENGTH^BOTTLE^SOLUTION^VOLUME^INFUSION RATE^MED ROUTE^SCHEDULE^ADMIN TIME"
"RTN","PSBPARIV",86,0)
 S X=X_"^REMARKS^OTHER PRINT INFO^PROVIDER^START DATE/TIME^STOP DATE/TIME^PROVIDER COMMENTS"
"RTN","PSBPARIV",87,0)
 S PSBIVPT=$P(PSBPARS,U,1)
"RTN","PSBPARIV",88,0)
 I PSBWD="ALL" D  Q
"RTN","PSBPARIV",89,0)
 .S K=2,PSBIVPT=$S(PSBIVPT="A":1,PSBIVPT="P":2,PSBIVPT="H":3,PSBIVPT="S":4,1:5)
"RTN","PSBPARIV",90,0)
 .F I=2:1 Q:$P(X,U,I)=""  S PSBIVPR(I)="PSBIV"_" "_$P(X,U,I)
"RTN","PSBPARIV",91,0)
 .F I=2:1:16 D EN^XPAR(PSBEDIV,$G(PSBIVPR(I)),PSBIVPT,$P(PSBPARS,U,K)) S K=K+1
"RTN","PSBPARIV",92,0)
 .S ^TMP("PSB",$J,0)="1^Parameters Saved"
"RTN","PSBPARIV",93,0)
 F I=2:1 Q:$P(PSBPARS,U,I)=""  S $P(PSBPARS,U,I)=$TR($P(PSBPARS,U,I),123,"WNI")
"RTN","PSBPARIV",94,0)
 I PSBWD'="ALL" D
"RTN","PSBPARIV",95,0)
 .S PSBWIEN=$O(^DIC(42,"B",PSBWD,""))
"RTN","PSBPARIV",96,0)
 .S PSBDIVPT=$$GET1^DIQ(42,PSBWIEN_",",.015,"I")
"RTN","PSBPARIV",97,0)
 .I $P($$SITE^VASITE(DT,PSBDIVPT),U,1)'=PSBDIEN S ^TMP("PSB",$J,0)="-1^Data NOT filed - invalid Division IEN" Q
"RTN","PSBPARIV",98,0)
 .I $P(PSBPARS,U,2)'="" D
"RTN","PSBPARIV",99,0)
 ..I $D(^PSB(53.66,"B",PSBWIEN)),$D(^PSB(53.66,PSBIEN,1,"B",PSBIVPT)) D MODIFY ;Modify an existing ward,ivtype
"RTN","PSBPARIV",100,0)
 ..I $D(^PSB(53.66,"B",PSBWIEN)),'$D(^PSB(53.66,PSBIEN,1,"B",PSBIVPT)) D ADD  ;ward exists but not type
"RTN","PSBPARIV",101,0)
 ..I '$D(^PSB(53.66,"B",PSBWIEN)) D NEW ;Create a new ward
"RTN","PSBPARIV",102,0)
 .I $P(PSBPARS,U,2)="" D RESET ;Delete an existing ward
"RTN","PSBPARIV",103,0)
 Q
"RTN","PSBPARIV",104,0)
NEW ;
"RTN","PSBPARIV",105,0)
 S PSBIEN="+1,"
"RTN","PSBPARIV",106,0)
 S PSBFDA(53.66,PSBIEN,.01)=$G(PSBWIEN)
"RTN","PSBPARIV",107,0)
 D FILEIT
"RTN","PSBPARIV",108,0)
 S PSBIEN="+1,"_PSBIEN(1)_","
"RTN","PSBPARIV",109,0)
 S PSBFDA(53.67,PSBIEN,.01)=PSBIVPT
"RTN","PSBPARIV",110,0)
 S PSBFDA(53.67,PSBIEN,1)=$P(PSBPARS,U,2)
"RTN","PSBPARIV",111,0)
 F I=5:5:70 S PSBFDA(53.67,PSBIEN,I)=""
"RTN","PSBPARIV",112,0)
 S K=3,I=1 F  S I=$O(PSBFDA(53.67,PSBIEN,I)) Q:I=""  S PSBFDA(53.67,PSBIEN,I)=$P(PSBPARS,U,K),K=K+1
"RTN","PSBPARIV",113,0)
 S PSBIEN(1)=""
"RTN","PSBPARIV",114,0)
 D FILEIT
"RTN","PSBPARIV",115,0)
 Q:$D(PSBMSG("DIERR"))
"RTN","PSBPARIV",116,0)
 S ^TMP("PSB",$J,0)="1^Data successfully filed^"_$G(PSBIEN(1))
"RTN","PSBPARIV",117,0)
 Q
"RTN","PSBPARIV",118,0)
MODIFY ;
"RTN","PSBPARIV",119,0)
 S PSBIEN=$O(^PSB(53.66,"B",PSBWIEN,""))
"RTN","PSBPARIV",120,0)
 S Z=$O(^PSB(53.66,PSBIEN,1,"B",PSBIVPT,""))
"RTN","PSBPARIV",121,0)
 S PSBIEN=Z_","_PSBIEN_","
"RTN","PSBPARIV",122,0)
 S PSBFDA(53.67,PSBIEN,.01)=PSBIVPT
"RTN","PSBPARIV",123,0)
 S PSBFDA(53.67,PSBIEN,1)=$P(PSBPARS,U,2)
"RTN","PSBPARIV",124,0)
 F I=5:5:70 S PSBFDA(53.67,PSBIEN,I)=""
"RTN","PSBPARIV",125,0)
 S K=3,I=1 F  S I=$O(PSBFDA(53.67,PSBIEN,I)) Q:I=""  S PSBFDA(53.67,PSBIEN,I)=$P(PSBPARS,U,K),K=K+1
"RTN","PSBPARIV",126,0)
 D FILEIT
"RTN","PSBPARIV",127,0)
 Q:$D(PSBMSG("DIERR"))
"RTN","PSBPARIV",128,0)
 S ^TMP("PSB",$J,0)="1^Data successfully filed^"
"RTN","PSBPARIV",129,0)
 Q
"RTN","PSBPARIV",130,0)
ADD ;
"RTN","PSBPARIV",131,0)
 S PSBIEN=$O(^PSB(53.66,"B",PSBWIEN,""))
"RTN","PSBPARIV",132,0)
 S PSBIEN="+1"_","_PSBIEN_","
"RTN","PSBPARIV",133,0)
 S PSBFDA(53.67,PSBIEN,.01)=PSBIVPT
"RTN","PSBPARIV",134,0)
 S PSBFDA(53.67,PSBIEN,1)=$P(PSBPARS,U,2)
"RTN","PSBPARIV",135,0)
 F I=5:5:70 S PSBFDA(53.67,PSBIEN,I)=""
"RTN","PSBPARIV",136,0)
 S K=3,I=1 F  S I=$O(PSBFDA(53.67,PSBIEN,I)) Q:I=""  S PSBFDA(53.67,PSBIEN,I)=$P(PSBPARS,U,K),K=K+1
"RTN","PSBPARIV",137,0)
 D FILEIT
"RTN","PSBPARIV",138,0)
 Q:$D(PSBMSG("DIERR"))
"RTN","PSBPARIV",139,0)
 S ^TMP("PSB",$J,0)="1^Data successfully filed^"
"RTN","PSBPARIV",140,0)
 Q
"RTN","PSBPARIV",141,0)
RESET ;
"RTN","PSBPARIV",142,0)
 N DIK,DA
"RTN","PSBPARIV",143,0)
 S DIK="^PSB(53.66,"
"RTN","PSBPARIV",144,0)
 S DA=PSBIEN
"RTN","PSBPARIV",145,0)
 D ^DIK
"RTN","PSBPARIV",146,0)
 S ^TMP("PSB",$J,0)="1^Data successfully deleted^"
"RTN","PSBPARIV",147,0)
 Q
"RTN","PSBPARIV",148,0)
FILEIT ;
"RTN","PSBPARIV",149,0)
 D CLEAN^DILF
"RTN","PSBPARIV",150,0)
 D UPDATE^DIE("","PSBFDA","PSBIEN","PSBMSG")
"RTN","PSBPARIV",151,0)
 I $D(PSBMSG("DIERR")) S ^TMP("PSB",$J,0)="-1^"_PSBMSG("DIERR",1)_": "_PSBMSG("DIERR",1,"TEXT",1) Q
"RTN","PSBPARIV",152,0)
 Q
"RTN","PSBPOIV")
0^36^B63173944
"RTN","PSBPOIV",1,0)
PSBPOIV ;BIRMINGHAM/EFC-IV PARAMETER VALIDATION ;Mar 2004
"RTN","PSBPOIV",2,0)
 ;;3.0;BAR CODE MED ADMIN;;Mar 2004
"RTN","PSBPOIV",3,0)
 ;
"RTN","PSBPOIV",4,0)
 ; Reference/IA
"RTN","PSBPOIV",5,0)
 ; ^DIC(42/1377
"RTN","PSBPOIV",6,0)
 ; ^DIC(42/2440
"RTN","PSBPOIV",7,0)
 ; EN^PSJCBMA1/2829
"RTN","PSBPOIV",8,0)
 ; EN^PSJBCMA2/2830
"RTN","PSBPOIV",9,0)
 ; DIQ(2/10035
"RTN","PSBPOIV",10,0)
 ;
"RTN","PSBPOIV",11,0)
EN(PSBDFN,PSBORD) ;
"RTN","PSBPOIV",12,0)
 ;
"RTN","PSBPOIV",13,0)
 S DFN=PSBDFN,(PSBMI,PSBMW,PSBMWC,PSBMAUD)=0,(PSBMIDT,PSBMIM)="",PSBONXS=PSBORD_"^"
"RTN","PSBPOIV",14,0)
 K ^TMP("PSBAR",$J) S ^TMP("PSBAR",$J,"W",0)=0
"RTN","PSBPOIV",15,0)
 D CLEAN^PSBVT,PSJ1^PSBVT(DFN,PSBORD)
"RTN","PSBPOIV",16,0)
 ; get IV parameters for the current ward
"RTN","PSBPOIV",17,0)
 S PSBCSTR="^ADDITIVE^STRENGTH^BOTTLE^SOLUTION^VOLUME^INFUSION RATE^MED ROUTE^SCHEDULE^ADMIN TIME^REMARKS^OTHER PRINT INFO^PROVIDER^START DATE/TIME^STOP DATE/TIME^PROVIDER COMMENTS"
"RTN","PSBPOIV",18,0)
 S PSBWARD=$$GET1^DIQ(2,PSBDFN_",",.1),PSBWARD=$$FIND1^DIC(42,"","X",PSBWARD),PSBWDIV=PSBWARD
"RTN","PSBPOIV",19,0)
 I $G(PSBWARD)'="",$D(^PSB(53.66,"B",PSBWARD)) D  ; if IV paramaters defined for ward use them
"RTN","PSBPOIV",20,0)
 .S PSBWARD=$O(^PSB(53.66,"B",PSBWARD,""))
"RTN","PSBPOIV",21,0)
 .S:$D(^PSB(53.66,PSBWARD,1,"B",PSBIVT)) PSBIVPAR=^PSB(53.66,PSBWARD,1,$O(^PSB(53.66,PSBWARD,1,"B",PSBIVT,""),-1),0)
"RTN","PSBPOIV",22,0)
 I '$D(PSBIVPAR) S PSBIVPAR=PSBIVT D  ; if IV parameters not defined for ward get defaults for division
"RTN","PSBPOIV",23,0)
 .D:$D(PSBWDIV)  ; Get the appropriate DIV for ward and DIVISIONAL IV PARAMETERS
"RTN","PSBPOIV",24,0)
 ..S PSBWDIV=$$GET1^DIQ(42,PSBWDIV_",",.015,"I"),PSBWDIV=$P($$SITE^VASITE(DT,PSBWDIV),U,1)
"RTN","PSBPOIV",25,0)
 ..I $G(PSBWDIV)']"" S PSBWDIV="DIV"
"RTN","PSBPOIV",26,0)
 ..E  S PSBWDIV="DIV.`"_PSBWDIV
"RTN","PSBPOIV",27,0)
 ..F X=2:1 Q:$P(PSBCSTR,U,X)=""  S PSBIVPAR=PSBIVPAR_U_$P($P($$GET^XPAR(PSBWDIV,"PSBIV "_$P(PSBCSTR,U,X),PSBIVT,"B"),U,2),"-",1)
"RTN","PSBPOIV",28,0)
 ..K PSBWDIV ; Kill temp variable.
"RTN","PSBPOIV",29,0)
 F PSBC1=1:1 Q:$P(PSBONXS,U,PSBC1)=""  D  ; process all orders
"RTN","PSBPOIV",30,0)
 .D CLEAN^PSBVT,PSJ1^PSBVT(DFN,$P(PSBONXS,U,PSBC1))
"RTN","PSBPOIV",31,0)
 .K PSBPONX2 I $G(PSBPONX)]"",$G(PSBPONX)["P" S PSBPONX2=PSBPONX D  ; Must compare "active" orders for changes made - look beyond "pendings"
"RTN","PSBPOIV",32,0)
 ..F  D CLEAN^PSBVT,PSJ1^PSBVT(DFN,PSBPONX2) S PSBPONX2=PSBPONX Q:(PSBPONX2="")!(PSBPONX2'["P")  ;
"RTN","PSBPOIV",33,0)
 ..D CLEAN^PSBVT,PSJ1^PSBVT(DFN,$P(PSBONXS,U,PSBC1))  ; Refresh data
"RTN","PSBPOIV",34,0)
 ..S:$D(PSBPONX2) PSBPONX=PSBPONX2 K PSBPONX2
"RTN","PSBPOIV",35,0)
 .Q:($L(U_PSBONXS,U_PSBPONX_U)-1)>0
"RTN","PSBPOIV",36,0)
 .I $G(PSBPONX)]"" S PSBONXS=PSBONXS_PSBPONX_U
"RTN","PSBPOIV",37,0)
 .K ^TMP("PSJ2",$J) S PSBMAUD=0 D EN^PSJBCMA2(PSBDFN,PSBONX,1)  ; check IV parameters against activity log for this order when no "I"nvalid message
"RTN","PSBPOIV",38,0)
 .I PSBMI=0 F X=1:1 Q:'$D(^TMP("PSJ2",$J,X))  S PSBCHKV=U_$P(^TMP("PSJ2",$J,X,1),U,3)_U I PSBCSTR[PSBCHKV D MSG(PSBCHKV,$P(^TMP("PSJ2",$J,X,1),U,1)) S PSBMAUD=1
"RTN","PSBPOIV",39,0)
 .K ^TMP("PSJ2",$J)
"RTN","PSBPOIV",40,0)
 .I PSBMI=0,$G(PSBPONX)]"" D SAVEPAR,CHKORD  ; check IV parameters against previous order when no "I"nvalid message
"RTN","PSBPOIV",41,0)
 .D CLEAN^PSBVT,PSJ1^PSBVT(DFN,$P(PSBONXS,U,PSBC1))  ; restore variable for this order
"RTN","PSBPOIV",42,0)
 .; okay - we have invalids and warnings through this order so process bags for this order
"RTN","PSBPOIV",43,0)
 .I '$D(PSBUIDA) Q  ; got errors and warning but no bags printed for this order - go to the next
"RTN","PSBPOIV",44,0)
 .S PSBUID="" F  S PSBUID=$O(PSBUIDA(PSBUID),-1) Q:PSBUID=""  D
"RTN","PSBPOIV",45,0)
 ..F PSBC2=1:1 S PSBMONX=$P(PSBONXS,U,PSBC2) Q:PSBMONX=""  D  ; check if bag is in 53.79
"RTN","PSBPOIV",46,0)
 ...I $D(^PSB(53.79,"AUID",PSBDFN,PSBMONX,PSBUID)) D
"RTN","PSBPOIV",47,0)
 ....S PSBIEN=$O(^PSB(53.79,"AUID",PSBDFN,PSBMONX,PSBUID,""))
"RTN","PSBPOIV",48,0)
 ....S PSBPDT=$P(PSBLBLA(PSBUID),U,1),PSBLSTS=$P(PSBLBLA(PSBUID),3)
"RTN","PSBPOIV",49,0)
 ....S $P(X,U,2)=$P(^PSB(53.79,PSBIEN,0),U,9)  ; add action status
"RTN","PSBPOIV",50,0)
 ....S $P(X,U,3)=$P(^PSB(53.79,PSBIEN,0),U,6)  ; add action date/time
"RTN","PSBPOIV",51,0)
 ....S $P(X,U,4)=$P(^PSB(53.79,PSBIEN,.1),U,1)  ; add order ID was administered for
"RTN","PSBPOIV",52,0)
 ..S $P(X,U,5)=PSBONX  ; add order ID was printed for
"RTN","PSBPOIV",53,0)
 ..S $P(X,U,6)=PSBOSTS  ; add order status
"RTN","PSBPOIV",54,0)
 ..S $P(X,U,7)=$P(PSBLBLA(PSBUID),U,1)  ; add date/time ID was printed
"RTN","PSBPOIV",55,0)
 ..S $P(X,U,8)=$P(PSBLBLA(PSBUID),U,3)  ; add lable status from pharmacy
"RTN","PSBPOIV",56,0)
 ..S $P(X,U,9)=""  ; 9 open for later development
"RTN","PSBPOIV",57,0)
 ..S $P(X,U,10)=PSBUIDA(PSBUID)  ; add return from PSJ1
"RTN","PSBPOIV",58,0)
 ..D BWAR
"RTN","PSBPOIV",59,0)
 ..I PSBMW=1 S PSBMWS="W;" F I=1:1:^TMP("PSBAR",$J,"W",0) D  S $P(X,U,1)=$P(PSBMWS,";",1,$L(PSBMWS,";")-1)
"RTN","PSBPOIV",60,0)
 ...I $P(PSBLBLA(PSBUID),U,1)'>$P(^TMP("PSBAR",$J,"W",I),U,2) D
"RTN","PSBPOIV",61,0)
 ....S:(PSBONX=$P(PSBONXS,U,1))&(PSBMAUD=1) PSBMWS=PSBMWS_I_";"
"RTN","PSBPOIV",62,0)
 ....S:PSBONX'=$P(PSBONXS,U,1) PSBMWS=PSBMWS_I_";"
"RTN","PSBPOIV",63,0)
 ..I PSBMIDT'="",$P(PSBLBLA(PSBUID),U,1)<PSBMIDT D
"RTN","PSBPOIV",64,0)
 ...S:(PSBONX=$P(PSBONXS,U,1))&(PSBMAUD=1) $P(X,U,1)="I"
"RTN","PSBPOIV",65,0)
 ...S:(PSBONX'=$P(PSBONXS,U,1)) $P(X,U,1)="I"
"RTN","PSBPOIV",66,0)
 ..S ^TMP("PSBAR",$J,PSBUID)=X K X
"RTN","PSBPOIV",67,0)
 D CLEAN^PSBVT
"RTN","PSBPOIV",68,0)
 K PSBC1,PSBC2,PSBSCHV,PSBCSTR,PSBIVPAR,PSBMI,PSBMIDT,PSBMIM,PSBMONX,PSBMW,PSBSPAR,PSBUID,PSBWARD
"RTN","PSBPOIV",69,0)
 K PSBADA,PSBSOLA,PSBOTMP
"RTN","PSBPOIV",70,0)
 I ^TMP("PSBAR",$J,"W",0)=0 K ^TMP("PSBAR",$J,"W",0)
"RTN","PSBPOIV",71,0)
 D PSJ1^PSBVT(DFN,PSBORD)  ; restore variables for calling order
"RTN","PSBPOIV",72,0)
 Q
"RTN","PSBPOIV",73,0)
 ;
"RTN","PSBPOIV",74,0)
SAVEPAR ; save parameters from current order
"RTN","PSBPOIV",75,0)
 K PSBOTMP
"RTN","PSBPOIV",76,0)
 I $D(PSBADA) M PSBOTMP("ADD")=PSBADA E  S PSBOTMP("ADD")=""  ; additive, strength, bottle
"RTN","PSBPOIV",77,0)
 I $D(PSBSOLA) M PSBOTMP("SOL")=PSBSOLA E  S PSBOTMP("SOL")=""  ; solution, volume,
"RTN","PSBPOIV",78,0)
 K PSBADA,PSBSOLA
"RTN","PSBPOIV",79,0)
 S PSBOTMP("INFUSION RATE")=$G(PSBIFR),PSBOTMP("MED ROUTE")=$G(PSBMR)
"RTN","PSBPOIV",80,0)
 S PSBOTMP("SCHEDULE")=$G(PSBSCH),PSBOTMP("ADMIN TIME")=$G(PSBADST)
"RTN","PSBPOIV",81,0)
 S PSBOTMP("REMARKS")=$G(PSBRMRK),PSBOTMP("OTHER PRINT INFO")=$G(PSBOTXT)
"RTN","PSBPOIV",82,0)
 S PSBOTMP("PROVIDER")=PSBMD,PSBOTMP("START DATE/TIME")=PSBOST
"RTN","PSBPOIV",83,0)
 S PSBOTMP("STOP DATE/TIME")=PSBOSP
"RTN","PSBPOIV",84,0)
 D CLEAN^PSBVT,PSJ1^PSBVT(DFN,$P(PSBONXS,U,PSBC1+1))  ; setup previous order variables
"RTN","PSBPOIV",85,0)
 Q
"RTN","PSBPOIV",86,0)
 ;
"RTN","PSBPOIV",87,0)
CHKORD ; check previous order against current order
"RTN","PSBPOIV",88,0)
 I $D(PSBADA)!($D(PSBOTMP("ADD"))) D CHKADD Q:PSBMI=1
"RTN","PSBPOIV",89,0)
 I $D(PSBSOLA)!($D(PSBOTMP("SOL"))) D CHKSOL Q:PSBMI=1
"RTN","PSBPOIV",90,0)
 I PSBIFR'=PSBOTMP("INFUSION RATE") D MSG("INFUSION RATE",PSBOSP) Q:PSBMI=1
"RTN","PSBPOIV",91,0)
 I PSBMR'=PSBOTMP("MED ROUTE") D MSG("MED ROUTE",PSBOSP) Q:PSBMI=1
"RTN","PSBPOIV",92,0)
 I PSBSCH'=PSBOTMP("SCHEDULE") D MSG("SCHEDULE",PSBOSP) Q:PSBMI=1
"RTN","PSBPOIV",93,0)
 I PSBADST'=PSBOTMP("ADMIN TIME") D MSG("ADMIN TIME",PSBOSP) Q:PSBMI=1
"RTN","PSBPOIV",94,0)
 I PSBRMRK'=PSBOTMP("REMARKS") D MSG("REMARKS",PSBOSP) Q:PSBMI=1
"RTN","PSBPOIV",95,0)
 I PSBOTXT'=PSBOTMP("OTHER PRINT INFO") D MSG("OTHER PRINT INFO",PSBOSP) Q:PSBMI=1
"RTN","PSBPOIV",96,0)
 I PSBMD'=PSBOTMP("PROVIDER") D MSG("PROVIDER",PSBOSP) Q:PSBMI=1
"RTN","PSBPOIV",97,0)
 I $E(PSBOST,1,10)'=$E(PSBOTMP("START DATE/TIME"),1,10) D MSG("START DATE/TIME",PSBOSP) Q:PSBMI=1
"RTN","PSBPOIV",98,0)
 I $E(PSBOSP,1,10)'=$E(PSBOTMP("STOP DATE/TIME"),1,10) D MSG("STOP DATE/TIME",PSBOSP)
"RTN","PSBPOIV",99,0)
 Q
"RTN","PSBPOIV",100,0)
CHKADD ;
"RTN","PSBPOIV",101,0)
 N X,Y
"RTN","PSBPOIV",102,0)
 I '$D(PSBADA),'$D(PSBOTMP("ADD")) Q  ; no additives
"RTN","PSBPOIV",103,0)
 I $O(PSBADA(""),-1)>$O(PSBOTMP("ADD",""),-1) D MSG("ADDITIVE",PSBOSP) Q  ;previous order has addtives not in current order
"RTN","PSBPOIV",104,0)
 I $O(PSBADA(""),-1)<$O(PSBOTMP("ADD",""),-1) D MSG("ADDITIVE",PSBOSP) Q  ;previous order missing additives in current order
"RTN","PSBPOIV",105,0)
 S X="" F  S X=$O(PSBADA(X)) Q:X=""  D  Q  ; check that additives, strength, and bottle are the same
"RTN","PSBPOIV",106,0)
 .I PSBADA(X)=PSBOTMP("ADD",X) Q  ; everything the same
"RTN","PSBPOIV",107,0)
 .I $P(PSBADA(X),U,2)'=$P(PSBOTMP("ADD",X),U,2) D MSG("ADDITIVE",PSBOSP) Q
"RTN","PSBPOIV",108,0)
 .I $P(PSBADA(X),U,4)'=$P(PSBOTMP("ADD",X),U,4) D MSG("STRENGTH",PSBOSP) Q
"RTN","PSBPOIV",109,0)
 Q
"RTN","PSBPOIV",110,0)
 ;
"RTN","PSBPOIV",111,0)
CHKSOL ;
"RTN","PSBPOIV",112,0)
 N X,Y
"RTN","PSBPOIV",113,0)
 I '$D(PSBSOLA),'$D(PSBOTMP("SOL")) Q  ; no solutions
"RTN","PSBPOIV",114,0)
 I $O(PSBSOLA(""),-1)>$O(PSBOTMP("SOL",""),-1) D MSG("SOLUTION",PSBOSP) Q  ;previous order has solutions not in current order
"RTN","PSBPOIV",115,0)
 I $O(PSBSOLA(""),-1)<$O(PSBOTMP("SOL",""),-1) D MSG("SOLUTION",PSBOSP) Q  ;previous order missing solutions in current order
"RTN","PSBPOIV",116,0)
 S X="" F  S X=$O(PSBSOLA(X)) Q:X=""  D  Q  ; check that solutions volume are the same
"RTN","PSBPOIV",117,0)
 .I PSBSOLA(X)=PSBOTMP("SOL",X) Q  ; everything the same
"RTN","PSBPOIV",118,0)
 .I $P(PSBSOLA(X),U,2)'=$P(PSBOTMP("SOL",X),U,2) D MSG("SOLUTION",PSBOSP) Q
"RTN","PSBPOIV",119,0)
 .I $P(PSBSOLA(X),U,4)'=$P(PSBOTMP("SOL",X),U,4) D MSG("VOLUME",PSBOSP) Q
"RTN","PSBPOIV",120,0)
 Q
"RTN","PSBPOIV",121,0)
 ;
"RTN","PSBPOIV",122,0)
BWAR ;
"RTN","PSBPOIV",123,0)
 N X,Y,Z,PSBONX
"RTN","PSBPOIV",124,0)
 S X=^TMP("PSBAR",$J,"W",0)+1
"RTN","PSBPOIV",125,0)
 S Z="" F Z=1:1 S PSBONX=$P(PSBONXS,U,Z) Q:$G(PSBONX)=""  D  ; Display "Warning"s for changes 
"RTN","PSBPOIV",126,0)
 .I '$D(PSBMWAR(PSBONX)) Q
"RTN","PSBPOIV",127,0)
 .S Y="" F  S Y=$O(PSBMWAR(PSBONX,Y)) Q:Y'?.N1".".N  D
"RTN","PSBPOIV",128,0)
 ..S Z="",PSBYS="" F  S Z=$O(PSBMWAR(PSBONX,Y,Z)) Q:Z=""  S PSBYS=PSBYS_Z_";"
"RTN","PSBPOIV",129,0)
 ..S PSBYS=$P(PSBYS,";",1,$L(PSBYS,";")-1)
"RTN","PSBPOIV",130,0)
 ..S ^TMP("PSBAR",$J,"W",X)=PSBONX_U_Y_U_"2^The "_PSBYS_" was changed on",^TMP("PSBAR",$J,"W",0)=X,X=X+1
"RTN","PSBPOIV",131,0)
 .K PSBMWAR(PSBONX)
"RTN","PSBPOIV",132,0)
 Q
"RTN","PSBPOIV",133,0)
 ;
"RTN","PSBPOIV",134,0)
MSG(PSBMVAR,PSBDATE) ;
"RTN","PSBPOIV",135,0)
 I PSBMI=1 Q  ;already have an invalid don't need anymore
"RTN","PSBPOIV",136,0)
 F Y=1:1 S PSBSPAR=$P(PSBCSTR,U,Y) I PSBSPAR=$TR(PSBMVAR,"^") D  Q
"RTN","PSBPOIV",137,0)
 .I $P(PSBIVPAR,U,Y)="W" D
"RTN","PSBPOIV",138,0)
 ..S PSBMVAR=$TR(PSBMVAR,"^")
"RTN","PSBPOIV",139,0)
 ..I PSBMW=0 S PSBMW=1
"RTN","PSBPOIV",140,0)
 ..S PSBMWC=PSBMWC+1,PSBMWM="2^The "_PSBSPAR_" has been changed."
"RTN","PSBPOIV",141,0)
 ..I $D(PSBMWAR(PSBONX,PSBMVAR)) S PSBOLDT=$O(PSBMWAR(PSBONX,PSBMVAR,"")) I PSBOLDT<$E(PSBDATE,1,12) K PSBMWAR(PSBONX,PSBMVAR,PSBOLDT)
"RTN","PSBPOIV",142,0)
 ..S PSBMWAR(PSBONX,PSBMVAR,$E(PSBDATE,1,12))=""
"RTN","PSBPOIV",143,0)
 ..S PSBMWAR(PSBONX,$E(PSBDATE,1,12),PSBMVAR)=""
"RTN","PSBPOIV",144,0)
 .I $P(PSBIVPAR,U,Y)="I" S PSBMI=1,PSBMIDT=PSBDATE,PSBMIM="-1^IV invalid "_PSBSPAR_".",^TMP("PSBAR",$J,"I")=PSBONX_U_PSBMIDT_U_PSBMIM
"RTN","PSBPOIV",145,0)
 Q
"RTN","PSBPRN")
0^37^B19286940
"RTN","PSBPRN",1,0)
PSBPRN ;BIRMINGHAM/EFC-BCMA PRN FUNCTIONS ;Mar 2004
"RTN","PSBPRN",2,0)
 ;;3.0;BAR CODE MED ADMIN;;Mar 2004
"RTN","PSBPRN",3,0)
 ;
"RTN","PSBPRN",4,0)
 ;IN5^VADPT/10061
"RTN","PSBPRN",5,0)
 ;
"RTN","PSBPRN",6,0)
EN ;
"RTN","PSBPRN",7,0)
 Q
"RTN","PSBPRN",8,0)
 ;
"RTN","PSBPRN",9,0)
EDIT ; Edit Medication Log PRN Effectiveness
"RTN","PSBPRN",10,0)
 NEW DFN ;* Undef DFN at EDIT+7^PSBPRN (NOIS: HUN-0699-21494)
"RTN","PSBPRN",11,0)
 W !! S DA=""
"RTN","PSBPRN",12,0)
 S DIC="^DPT(",DIC(0)="AEQM",DIC("A")="Select Patient Name: "
"RTN","PSBPRN",13,0)
 D ^DIC K DIC Q:+Y<1
"RTN","PSBPRN",14,0)
 S DFN=+Y
"RTN","PSBPRN",15,0)
 D EDIT1
"RTN","PSBPRN",16,0)
 K DFN,DA
"RTN","PSBPRN",17,0)
 G EDIT
"RTN","PSBPRN",18,0)
 ;
"RTN","PSBPRN",19,0)
EDIT1 ;
"RTN","PSBPRN",20,0)
 S %DT="AEQ",%DT("A")="Select Date to Begin Searching Back From: "
"RTN","PSBPRN",21,0)
 S %DT("B")="Today"
"RTN","PSBPRN",22,0)
 W !! D ^%DT Q:+Y<1  S PSBDT=Y
"RTN","PSBPRN",23,0)
 F  D  Q:'PSBDT
"RTN","PSBPRN",24,0)
 .W @IOF,!,"Searching Date " S Y=PSBDT D D^DIQ W Y
"RTN","PSBPRN",25,0)
 .W !," #  Medication",?45,"St",?50,"D/T Given",?75,"Int"
"RTN","PSBPRN",26,0)
 .W !,$TR($J("",IOM)," ","-")
"RTN","PSBPRN",27,0)
 .S PSBSRCH=PSBDT+.9,PSBCNT=0
"RTN","PSBPRN",28,0)
 .K PSBTMP
"RTN","PSBPRN",29,0)
 .F  S PSBSRCH=$O(^PSB(53.79,"APRN",DFN,PSBSRCH),-1) Q:'PSBSRCH!(PSBSRCH<PSBDT)  D
"RTN","PSBPRN",30,0)
 ..S PSBIEN=""
"RTN","PSBPRN",31,0)
 ..F  S PSBIEN=$O(^PSB(53.79,"APRN",DFN,PSBSRCH,PSBIEN),-1) Q:'PSBIEN  D
"RTN","PSBPRN",32,0)
 ...Q:$P($G(^PSB(53.79,PSBIEN,.2)),U,2)]""
"RTN","PSBPRN",33,0)
 ...Q:$P($G(^PSB(53.79,PSBIEN,0)),U,9)'="G"
"RTN","PSBPRN",34,0)
 ...S PSBCNT=PSBCNT+1,PSBTMP(PSBCNT)=PSBIEN
"RTN","PSBPRN",35,0)
 ...I $Y>19 W ! S DIR(0)="E" D ^DIR W @IOF,!,"Searching Date " S Y=PSBDT D D^DIQ W Y,!," #  Medication",?45,"St",?50,"D/T Given",?75,"Int",!,$TR($J("",IOM)," ","-")
"RTN","PSBPRN",36,0)
 ...W !,$J(PSBCNT,2),". "
"RTN","PSBPRN",37,0)
 ...W ?5,$$GET1^DIQ(53.79,PSBIEN_",",.08)
"RTN","PSBPRN",38,0)
 ...W ?45,$P(^PSB(53.79,PSBIEN,0),U,9)
"RTN","PSBPRN",39,0)
 ...W ?50,$$GET1^DIQ(53.79,PSBIEN_",",.06)
"RTN","PSBPRN",40,0)
 ...W ?75,$$GET1^DIQ(53.79,PSBIEN_",","ACTION BY:INITIAL")
"RTN","PSBPRN",41,0)
 .I PSBCNT W ! S DIR(0)="NO^1:"_PSBCNT_":0" D ^DIR S:Y DA=PSBTMP(Y),PSBDT="" Q:Y
"RTN","PSBPRN",42,0)
 .I 'PSBCNT W !!?5,"No Meds Found!"
"RTN","PSBPRN",43,0)
 .S X1=PSBDT,X2=-1 D C^%DTC S (PSBDT,Y)=X D D^DIQ
"RTN","PSBPRN",44,0)
 .W !!,"Continue With ",Y
"RTN","PSBPRN",45,0)
 .S %=1 D YN^DICN I %'=1 S PSBDT=0
"RTN","PSBPRN",46,0)
 I DA S DDSFILE=53.79,DR="[PSB PRN EFFECTIVENESS]" D ^DDS S %=2 W !,"Edit another entry" D YN^DICN G:%=1 EDIT1
"RTN","PSBPRN",47,0)
 K PSBCNT,PSBDT,PSBIEN,PSBSRCH,PSBTMP,DA,DR,DDSFILE
"RTN","PSBPRN",48,0)
 Q
"RTN","PSBPRN",49,0)
 ;
"RTN","PSBPRN",50,0)
GETPRNS(RESULTS,DFN,PSBORD) ; Get the PRN's for a pt needing effectness
"RTN","PSBPRN",51,0)
 ;
"RTN","PSBPRN",52,0)
 ; RPC PSB GETPRNS
"RTN","PSBPRN",53,0)
 ;
"RTN","PSBPRN",54,0)
 ; Description:
"RTN","PSBPRN",55,0)
 ; Returns all administrations of a PRN order that have NOT had
"RTN","PSBPRN",56,0)
 ; the PRN Effectiveness documented for the last 30 days
"RTN","PSBPRN",57,0)
 ;
"RTN","PSBPRN",58,0)
 N PSBIEN,PSBSTOP,PSBFLAG
"RTN","PSBPRN",59,0)
 K ^TMP("PSB",$J),RESULTS
"RTN","PSBPRN",60,0)
 D INP^VADPT S PSBTRDT=+VAIN(7)
"RTN","PSBPRN",61,0)
 S PSBHOUR=$$GET^XPAR("DIV","PSB PRN DOCUMENTATION") I PSBHOUR="" S PSBHOUR=72
"RTN","PSBPRN",62,0)
 D NOW^%DTC S PSBSTRT=%,PSBPRNDT=$$FMADD^XLFDT(PSBSTRT,"",-PSBHOUR)
"RTN","PSBPRN",63,0)
 S PSBFLAG=0
"RTN","PSBPRN",64,0)
 I PSBPRNDT'<PSBTRDT S PSBFLAG=1
"RTN","PSBPRN",65,0)
 S PSBSTRT="" F  S PSBSTRT=$O(^PSB(53.79,"APRN",DFN,PSBSTRT),-1) Q:PSBSTRT<PSBPRNDT&(PSBFLAG=0)  Q:PSBSTRT<PSBTRDT&(PSBFLAG=1)  D
"RTN","PSBPRN",66,0)
 .S PSBIEN=""
"RTN","PSBPRN",67,0)
 .F  S PSBIEN=$O(^PSB(53.79,"APRN",DFN,PSBSTRT,PSBIEN),-1) Q:'PSBIEN  D
"RTN","PSBPRN",68,0)
 ..Q:PSBORD'=""&($P(^PSB(53.79,PSBIEN,.1),U)'=PSBORD)  ;  Not the right order
"RTN","PSBPRN",69,0)
 ..I ($P(^PSB(53.79,PSBIEN,0),U,9)'="G")&($P(^PSB(53.79,PSBIEN,0),U,9)'="RM") Q    ; Med was never given
"RTN","PSBPRN",70,0)
 ..Q:$P($G(^PSB(53.79,PSBIEN,.2)),U,2)]""  ; Already entered
"RTN","PSBPRN",71,0)
 ..S PSBX=PSBIEN_U_DFN,PSBIENS=PSBIEN_","
"RTN","PSBPRN",72,0)
 ..S PSBX=PSBX_U_$$GET1^DIQ(53.79,PSBIENS,.02)
"RTN","PSBPRN",73,0)
 ..S PSBX=PSBX_U_$$GET1^DIQ(53.79,PSBIENS,.04,"I")
"RTN","PSBPRN",74,0)
 ..S PSBX=PSBX_U_$$GET1^DIQ(53.79,PSBIENS,.07)
"RTN","PSBPRN",75,0)
 ..S PSBX=PSBX_U_$$GET1^DIQ(53.79,PSBIENS,.08)
"RTN","PSBPRN",76,0)
 ..S PSBX=PSBX_U_$$GET1^DIQ(53.79,PSBIENS,.21)
"RTN","PSBPRN",77,0)
 ..D PSJ1^PSBVT(DFN,$$GET1^DIQ(53.79,PSBIENS,.11))
"RTN","PSBPRN",78,0)
 ..S PSBX=PSBX_U_PSBOIT_U_PSBONX
"RTN","PSBPRN",79,0)
 ..S PSBX=PSBX_U_$$GET1^DIQ(53.79,PSBIENS,.27)
"RTN","PSBPRN",80,0)
 ..S Y=$O(^TMP("PSB",$J,""),-1)+1
"RTN","PSBPRN",81,0)
 ..S ^TMP("PSB",$J,Y)=PSBX
"RTN","PSBPRN",82,0)
 ..;Special instructions
"RTN","PSBPRN",83,0)
 ..S Y=Y+1,^TMP("PSB",$J,Y)=PSBOTXT
"RTN","PSBPRN",84,0)
 ..F PSBZ=.5,.6,.7 F PSBY=0:0 S PSBY=$O(^PSB(53.79,PSBIEN,PSBZ,PSBY)) Q:'PSBY  D
"RTN","PSBPRN",85,0)
 ...S PSBDD=$S(PSBZ=.5:53.795,PSBZ=.6:53.796,1:53.797)
"RTN","PSBPRN",86,0)
 ...S PSBSOL=$S(PSBZ=.5:"DD",PSBZ=.6:"ADD",1:"SOL")
"RTN","PSBPRN",87,0)
 ...Q:'$D(^PSB(53.79,PSBIEN,PSBZ,PSBY))
"RTN","PSBPRN",88,0)
 ...S PSBUNIT=$$GET1^DIQ(PSBDD,PSBY_","_PSBIEN_",",.03)
"RTN","PSBPRN",89,0)
 ...S PSBUNFR=$$GET1^DIQ(PSBDD,PSBY_","_PSBIEN_",",.04)
"RTN","PSBPRN",90,0)
 ...S Y=Y+1
"RTN","PSBPRN",91,0)
 ...S ^TMP("PSB",$J,Y)=PSBSOL_U_$$GET1^DIQ(PSBDD,PSBY_","_PSBIEN_",",.01)_U_PSBUNIT_U_PSBUNFR
"RTN","PSBPRN",92,0)
 ..S Y=Y+1,^TMP("PSB",$J,Y)="END"
"RTN","PSBPRN",93,0)
 S ^TMP("PSB",$J,0)=+$O(^TMP("PSB",$J,""),-1)
"RTN","PSBPRN",94,0)
 S RESULTS=$NAME(^TMP("PSB",$J))
"RTN","PSBPRN",95,0)
 K PSBTRDT,PSBHOUR,PSBPRNDT
"RTN","PSBPRN",96,0)
 D CLEAN^PSBVT
"RTN","PSBPRN",97,0)
 Q
"RTN","PSBPRN",98,0)
 ;
"RTN","PSBRPC")
0^39^B58150242
"RTN","PSBRPC",1,0)
PSBRPC ;BIRMINGHAM/EFC-BCMA RPC BROKER CALLS ;Mar 2004
"RTN","PSBRPC",2,0)
 ;;3.0;BAR CODE MED ADMIN;;Mar 2004
"RTN","PSBRPC",3,0)
 ;
"RTN","PSBRPC",4,0)
 ; Reference/IA
"RTN","PSBRPC",5,0)
 ; EN1^GMRADPT/10099
"RTN","PSBRPC",6,0)
 ; EN6^GMRVUTL/1120
"RTN","PSBRPC",7,0)
 ; DEM^VADPT/10061
"RTN","PSBRPC",8,0)
 ; IN5^VADPT/10061
"RTN","PSBRPC",9,0)
 ; File 200/10060
"RTN","PSBRPC",10,0)
 ; File 211.4/1409
"RTN","PSBRPC",11,0)
 ; CHECKAV^XUSRB/2882
"RTN","PSBRPC",12,0)
 ; GUIMTD^DPTLK6/3023
"RTN","PSBRPC",13,0)
 ; ^ORD(101.24/3429
"RTN","PSBRPC",14,0)
 ; File 2/10035
"RTN","PSBRPC",15,0)
 ; File 4/10090
"RTN","PSBRPC",16,0)
 ; EN1^GMRVUT0/1446
"RTN","PSBRPC",17,0)
 ; HASH^XUSHSHP/10045
"RTN","PSBRPC",18,0)
 ; $$DECRYP^XUSRB1/2241
"RTN","PSBRPC",19,0)
 ; ^DIC(42/1377
"RTN","PSBRPC",20,0)
 ; ^DIC(42/2440
"RTN","PSBRPC",21,0)
 ;
"RTN","PSBRPC",22,0)
 ;
"RTN","PSBRPC",23,0)
FMDATE(RESULTS,X) ;
"RTN","PSBRPC",24,0)
 ;
"RTN","PSBRPC",25,0)
 ; RPC: PSB FMDATE
"RTN","PSBRPC",26,0)
 ;
"RTN","PSBRPC",27,0)
 ; Description: Returns a valid FM Date/Time from Client DateToStr()
"RTN","PSBRPC",28,0)
 ;
"RTN","PSBRPC",29,0)
 I $P(X,"@",2)="0000" S $P(X,"@",2)="0001"
"RTN","PSBRPC",30,0)
 ;if no time for dates like T-1, append the current time
"RTN","PSBRPC",31,0)
 I $P(X,"@",2)="",X'?1"N" D  S $P(X,"@",2)=$P(Y,"@",2)
"RTN","PSBRPC",32,0)
 . N X
"RTN","PSBRPC",33,0)
 . S X="N",%DT="T" D ^%DT,DD^%DT
"RTN","PSBRPC",34,0)
 S %DT="T" D ^%DT
"RTN","PSBRPC",35,0)
 I +Y<1 S RESULTS(0)="-1^Invalid Date/Time" Q
"RTN","PSBRPC",36,0)
 S RESULTS(0)=Y D D^DIQ
"RTN","PSBRPC",37,0)
 S RESULTS(0)=RESULTS(0)_U_Y
"RTN","PSBRPC",38,0)
 Q
"RTN","PSBRPC",39,0)
 ;
"RTN","PSBRPC",40,0)
USRLOAD(RESULTS,DUMMY) ;
"RTN","PSBRPC",41,0)
 ;
"RTN","PSBRPC",42,0)
 ; RPC: PSB USERLOAD
"RTN","PSBRPC",43,0)
 ;
"RTN","PSBRPC",44,0)
 ; Description: Loads a user at sign-on on the client wkstn
"RTN","PSBRPC",45,0)
 ;
"RTN","PSBRPC",46,0)
 S RESULTS(0)=DUZ ; User IEN
"RTN","PSBRPC",47,0)
 S RESULTS(1)=$$GET1^DIQ(200,DUZ_",",.01) ; User Name
"RTN","PSBRPC",48,0)
 S RESULTS(2)=$S($D(^XUSEC("PSB STUDENT",DUZ)):1,1:0) ; Student 0/1
"RTN","PSBRPC",49,0)
 S RESULTS(3)=$S($D(^XUSEC("PSB MANAGER",DUZ)):1,1:0) ; Mgr 0/1
"RTN","PSBRPC",50,0)
 S RESULTS(4)=$S($D(^XUSEC("PSB CPRS MED BUTTON",DUZ)):1,1:0)
"RTN","PSBRPC",51,0)
 S RESULTS(5)=$$GET^XPAR("USR","PSB WINDOW")
"RTN","PSBRPC",52,0)
 ;
"RTN","PSBRPC",53,0)
 ; Build the Virtual Due List String
"RTN","PSBRPC",54,0)
 ;
"RTN","PSBRPC",55,0)
 S X=$S(+$$GET^XPAR("ALL","PSB VDL INCL CONT"):"T",1:"F")
"RTN","PSBRPC",56,0)
 S X=X_"/"_$S(+$$GET^XPAR("ALL","PSB VDL INCL PRN"):"T",1:"F")
"RTN","PSBRPC",57,0)
 S X=X_"/"_$S(+$$GET^XPAR("ALL","PSB VDL INCL ONE-TIME"):"T",1:"F")
"RTN","PSBRPC",58,0)
 S X=X_"/"_$S(+$$GET^XPAR("ALL","PSB VDL INCL ON-CALL"):"T",1:"F")
"RTN","PSBRPC",59,0)
 S X=X_"/"_+$$GET^XPAR("ALL","PSB VDL SORT COLUMN")
"RTN","PSBRPC",60,0)
 S X=X_"/"_+$$GET^XPAR("ALL","PSB VDL PB SORT COLUMN")
"RTN","PSBRPC",61,0)
 S X=X_"/"_+$$GET^XPAR("ALL","PSB VDL IV SORT COLUMN")
"RTN","PSBRPC",62,0)
 ;
"RTN","PSBRPC",63,0)
 S RESULTS(6)=X ; Virtual Due List Setup
"RTN","PSBRPC",64,0)
 S RESULTS(7)=+$G(DUZ(2))
"RTN","PSBRPC",65,0)
 I RESULTS(7) S RESULTS(8)=$$GET1^DIQ(4,RESULTS(7)_",",.01)
"RTN","PSBRPC",66,0)
 E  S RESULTS(8)="Undefined Division"
"RTN","PSBRPC",67,0)
 S RESULTS(9)=+$$GET^XPAR("DIV","PSB ADMIN ESIG")
"RTN","PSBRPC",68,0)
 S RESULTS(10)=+$$GET^XPAR("DIV","PSB ONLINE")
"RTN","PSBRPC",69,0)
 S RESULTS(11)=$G(DTIME,300)
"RTN","PSBRPC",70,0)
 S RESULTS(12)=$$GET^XPAR("USR","PSB UNIT DOSE COLUMN WIDTHS")
"RTN","PSBRPC",71,0)
 S RESULTS(13)=$J_"^"_$$BASE^XLFUTL($J,10,16)
"RTN","PSBRPC",72,0)
 S RESULTS(14)=$$GET^XPAR("USR","PSB IVPB COLUMN WIDTHS")
"RTN","PSBRPC",73,0)
 S RESULTS(15)=$$GET^XPAR("USR","PSB IV COLUMN WIDTHS")
"RTN","PSBRPC",74,0)
 S RESULTS(16)=$$GET^XPAR("USR","PSB PRINTER USER DEFAULT")
"RTN","PSBRPC",75,0)
 S RESULTS(17)=$$GET^XPAR("USR","PSB GUI DEFAULT PRINTER")
"RTN","PSBRPC",76,0)
 Q
"RTN","PSBRPC",77,0)
 ;
"RTN","PSBRPC",78,0)
USRSAVE(RESULTS,PSBWIN,PSBVDL,PSBUDCW,PSBPBCW,PSBIVCW,PSBDEV) ;
"RTN","PSBRPC",79,0)
 ;
"RTN","PSBRPC",80,0)
 ; RPC: PSB USERSAVE
"RTN","PSBRPC",81,0)
 ;
"RTN","PSBRPC",82,0)
 ; Description: Saves user settings for next sign-on.
"RTN","PSBRPC",83,0)
 ;
"RTN","PSBRPC",84,0)
 S PSBWIN=$G(PSBWIN)
"RTN","PSBRPC",85,0)
 S PSBVDL=$G(PSBVDL)
"RTN","PSBRPC",86,0)
 S PSBUDCW=$G(PSBUDCW)
"RTN","PSBRPC",87,0)
 S PSBPBCW=$G(PSBPBCW)
"RTN","PSBRPC",88,0)
 S PSBIVCW=$G(PSBIVCW)
"RTN","PSBRPC",89,0)
 S PSBDEV=$G(PSBDEV)
"RTN","PSBRPC",90,0)
 D EN^XPAR("USR","PSB WINDOW",1,PSBWIN)
"RTN","PSBRPC",91,0)
 D EN^XPAR("USR","PSB VDL INCL CONT",1,$P(PSBVDL,"/",1)["T")
"RTN","PSBRPC",92,0)
 D EN^XPAR("USR","PSB VDL INCL PRN",1,$P(PSBVDL,"/",2)["T")
"RTN","PSBRPC",93,0)
 D EN^XPAR("USR","PSB VDL INCL ONE-TIME",1,$P(PSBVDL,"/",3)["T")
"RTN","PSBRPC",94,0)
 D EN^XPAR("USR","PSB VDL INCL ON-CALL",1,$P(PSBVDL,"/",4)["T")
"RTN","PSBRPC",95,0)
 D EN^XPAR("USR","PSB VDL SORT COLUMN",1,+$P(PSBVDL,"/",5))
"RTN","PSBRPC",96,0)
 D EN^XPAR("USR","PSB VDL PB SORT COLUMN",1,+$P(PSBVDL,"/",6))
"RTN","PSBRPC",97,0)
 D EN^XPAR("USR","PSB VDL IV SORT COLUMN",1,+$P(PSBVDL,"/",7))
"RTN","PSBRPC",98,0)
 D EN^XPAR("USR","PSB UNIT DOSE COLUMN WIDTHS",1,PSBUDCW)
"RTN","PSBRPC",99,0)
 D EN^XPAR("USR","PSB IVPB COLUMN WIDTHS",1,PSBPBCW)
"RTN","PSBRPC",100,0)
 D EN^XPAR("USR","PSB IV COLUMN WIDTHS",1,PSBIVCW)
"RTN","PSBRPC",101,0)
 D EN^XPAR("USR","PSB GUI DEFAULT PRINTER",1,PSBDEV)
"RTN","PSBRPC",102,0)
 S RESULTS(0)="1^Parameters Saved"
"RTN","PSBRPC",103,0)
 Q
"RTN","PSBRPC",104,0)
 ;
"RTN","PSBRPC",105,0)
INST(RESULTS,PSBACC,PSBVER) ;
"RTN","PSBRPC",106,0)
 ;
"RTN","PSBRPC",107,0)
 ; RPC: PSB INSTRUCTOR
"RTN","PSBRPC",108,0)
 ;
"RTN","PSBRPC",109,0)
 ; Description:
"RTN","PSBRPC",110,0)
 ; Used by frmInstructor to validate an instructors presence at
"RTN","PSBRPC",111,0)
 ; the client via their encrypted A/V Code.
"RTN","PSBRPC",112,0)
 ;
"RTN","PSBRPC",113,0)
 S PSBACC=$$DECRYP^XUSRB1(PSBACC)
"RTN","PSBRPC",114,0)
 S PSBVER=$$DECRYP^XUSRB1(PSBVER)
"RTN","PSBRPC",115,0)
 S PSBINST=$$CHECKAV^XUSRB(PSBACC_";"_PSBVER)
"RTN","PSBRPC",116,0)
 I PSBINST<1 S RESULTS(0)="-1^Invalid Instructor Sign-On" K PSBINST Q
"RTN","PSBRPC",117,0)
 I '$D(^XUSEC("PSB INSTRUCTOR",PSBINST)) S RESULTS(0)="-1^Instructor doesn't have authority" K PSBINST Q
"RTN","PSBRPC",118,0)
 S PSBINST(0)=$$GET1^DIQ(200,PSBINST_",",.01)
"RTN","PSBRPC",119,0)
 S RESULTS(0)=PSBINST_U_PSBINST(0)
"RTN","PSBRPC",120,0)
 ;
"RTN","PSBRPC",121,0)
 Q
"RTN","PSBRPC",122,0)
 ;
"RTN","PSBRPC",123,0)
ESIG(RESULTS,PSBESIG) ;
"RTN","PSBRPC",124,0)
 ;
"RTN","PSBRPC",125,0)
 ; RPC: PSB VALIDATE ESIG
"RTN","PSBRPC",126,0)
 ;
"RTN","PSBRPC",127,0)
 ; Description:
"RTN","PSBRPC",128,0)
 ; Validate the data in PSBESIG against the user currently
"RTN","PSBRPC",129,0)
 ; signed on (DUZ)
"RTN","PSBRPC",130,0)
 ;
"RTN","PSBRPC",131,0)
 S PSBDSIG=$P($G(PSBESIG),U,2) I PSBDSIG'="" S PSBDSIG=$$DECRYP^XUSRB1(PSBDSIG),PSBESIG=PSBDSIG
"RTN","PSBRPC",132,0)
 I $G(PSBESIG)="" S RESULTS(0)="-1^Must Supply ESig" Q
"RTN","PSBRPC",133,0)
 S X=PSBESIG D HASH^XUSHSHP
"RTN","PSBRPC",134,0)
 I X'=$$GET1^DIQ(200,DUZ_",",20.4,"I") S RESULTS(0)="-1^Invalid ESig"
"RTN","PSBRPC",135,0)
 E  S RESULTS(0)="1^ESig Verified"
"RTN","PSBRPC",136,0)
 Q
"RTN","PSBRPC",137,0)
 ;
"RTN","PSBRPC",138,0)
 ;
"RTN","PSBRPC",139,0)
SCANPT(RESULTS,PSBDATA) ; Lookup Pt by Full SSN
"RTN","PSBRPC",140,0)
 ;
"RTN","PSBRPC",141,0)
 ; RPC: PSB SCANPT
"RTN","PSBRPC",142,0)
 ;
"RTN","PSBRPC",143,0)
 ; Description:
"RTN","PSBRPC",144,0)
 ; Does a lookup on file 2 either by full SSN
"RTN","PSBRPC",145,0)
 ; returns -1 on error or patient date on success
"RTN","PSBRPC",146,0)
 ;
"RTN","PSBRPC",147,0)
 ; Check for Interleave 2 of 5 Check Digit on SSN and remove
"RTN","PSBRPC",148,0)
 S:PSBDATA?1"0"9N PSBDATA=$E(PSBDATA,2,10)
"RTN","PSBRPC",149,0)
 ;
"RTN","PSBRPC",150,0)
 I PSBDATA'?9N.1U S RESULTS(0)="-1^Invalid Patient Lookup" Q
"RTN","PSBRPC",151,0)
 S X=$$FIND1^DIC(2,"","",PSBDATA,"SSN")
"RTN","PSBRPC",152,0)
 I X<1 S RESULTS(0)="-1^Invalid Patient Lookup" Q
"RTN","PSBRPC",153,0)
 S DFN=X
"RTN","PSBRPC",154,0)
 K VADM,VAIN
"RTN","PSBRPC",155,0)
 D DEM^VADPT,IN5^VADPT
"RTN","PSBRPC",156,0)
 I 'VAIP(13) S RESULTS(0)="-1^No admission on file for this patient" K VAIP,VADM Q
"RTN","PSBRPC",157,0)
 S RESULTS(0)=DFN
"RTN","PSBRPC",158,0)
 F X=1,2,3,4,5 S RESULTS(X)=$G(VADM(X))
"RTN","PSBRPC",159,0)
 F X=3,4,5,6,7,8,9,10,11 S RESULTS(X+3)=$G(VAIP(X))
"RTN","PSBRPC",160,0)
 S GMRVSTR="HT" D EN6^GMRVUTL
"RTN","PSBRPC",161,0)
 S X=+$P(X,U,8) S:X X=X*2.54\1 S PSBHDR("HEIGHT")=$S(X:X_"cm",1:"*")
"RTN","PSBRPC",162,0)
 S RESULTS(15)=PSBHDR("HEIGHT")
"RTN","PSBRPC",163,0)
 S GMRVSTR="WT" D EN6^GMRVUTL
"RTN","PSBRPC",164,0)
 S X=+$P(X,U,8) S X=$J(X/2.2,0,2) S PSBHDR("WEIGHT")=$S(X:X_"kg",1:"*")
"RTN","PSBRPC",165,0)
 S RESULTS(16)=PSBHDR("WEIGHT")
"RTN","PSBRPC",166,0)
 S GMRA="0^0^111" D EN1^GMRADPT
"RTN","PSBRPC",167,0)
 I $O(GMRAL(0)) S RESULTS(17)=1
"RTN","PSBRPC",168,0)
 E  S RESULTS(17)=0
"RTN","PSBRPC",169,0)
 ; Patch PSB*1.0*3 Add Means Test DRP@TOPEKA 11-JAN-2000 09:18:48
"RTN","PSBRPC",170,0)
 D GUIMTD^DPTLK6(.PSBDATA,DFN)
"RTN","PSBRPC",171,0)
 S RESULTS(18)=+$G(PSBDATA(1))_U_$G(PSBDATA(2))_U_$G(PSBDATA(3))
"RTN","PSBRPC",172,0)
 ;Add CCOW compliance
"RTN","PSBRPC",173,0)
 S PSBICN=$$GETICN^MPIF001(DFN) I +PSBICN=-1 S PSBICN=""
"RTN","PSBRPC",174,0)
 S Y=$O(^DIC(42,"B",$G(^DPT(DFN,.1)),"")),Y=$$GET1^DIQ(42,Y,.015,"I"),PSBSTA=$P($$SITE^VASITE(DT,Y),U,3)
"RTN","PSBRPC",175,0)
 S RESULTS(19)=PSBICN_U_PSBSTA
"RTN","PSBRPC",176,0)
 K VAIP,VADM
"RTN","PSBRPC",177,0)
 Q
"RTN","PSBRPC",178,0)
 ;
"RTN","PSBRPC",179,0)
MAX(RESULTS,PSBDAYS) ;
"RTN","PSBRPC",180,0)
 ;
"RTN","PSBRPC",181,0)
 ; RPC: PSB MAXDAYS  ; Maximum number of days user can view/print MAH
"RTN","PSBRPC",182,0)
 ;
"RTN","PSBRPC",183,0)
 S X=$O(^ORD(101.24,"B","ORRP BCMA MAH",""))
"RTN","PSBRPC",184,0)
 S RESULTS(0)=$$GET1^DIQ(101.24,X_",",.42)
"RTN","PSBRPC",185,0)
 Q
"RTN","PSBRPC",186,0)
 ;
"RTN","PSBRPC",187,0)
NWLIST(RESULTS,DUMMY) ; ward list from NURS LOCATION, file 211.4
"RTN","PSBRPC",188,0)
 ;
"RTN","PSBRPC",189,0)
 K ^TMP("PSB",$J)
"RTN","PSBRPC",190,0)
 S PSBIEN=0 F  S PSBIEN=$O(^NURSF(211.4,PSBIEN)) Q:PSBIEN'?.N  D
"RTN","PSBRPC",191,0)
 .S ^TMP("PSB",$J,$$GET1^DIQ(211.4,PSBIEN_",",.01))=PSBIEN
"RTN","PSBRPC",192,0)
 .S PSBX=0 F  S PSBX=$O(^NURSF(211.4,PSBIEN,3,PSBX)) Q:PSBX=""  D
"RTN","PSBRPC",193,0)
 ..S PSBWIEN=$P(^NURSF(211.4,PSBIEN,3,PSBX,0),"^")
"RTN","PSBRPC",194,0)
 ..I $$GET1^DIQ(42,PSBWIEN_",",.01)]"" S ^TMP("PSB",$J,$$GET1^DIQ(42,PSBWIEN_",",.01))=PSBIEN
"RTN","PSBRPC",195,0)
 S RESULTS(0)=0
"RTN","PSBRPC",196,0)
 S X="" F  S X=$O(^TMP("PSB",$J,X)) Q:X=""  S RESULTS(0)=RESULTS(0)+1,RESULTS(RESULTS(0))=^TMP("PSB",$J,X)_U_X
"RTN","PSBRPC",197,0)
 K ^TMP("PSB",$J)
"RTN","PSBRPC",198,0)
 Q
"RTN","PSBRPC",199,0)
 ;
"RTN","PSBRPC",200,0)
VITALS(RESULTS,DFN) ;Vital signs from Vitals API
"RTN","PSBRPC",201,0)
 ;
"RTN","PSBRPC",202,0)
 ; RPC PSB VITALS
"RTN","PSBRPC",203,0)
 ;
"RTN","PSBRPC",204,0)
 K RESULTS
"RTN","PSBRPC",205,0)
 N PSBSTRT,PSBSTOP,PSBNOW
"RTN","PSBRPC",206,0)
 S PSBDFN=DFN,GMRVSTR="T;P;R;BP;PN"
"RTN","PSBRPC",207,0)
 D NOW^%DTC S PSBNOW=%,PSBSTRT=$$FMADD^XLFDT(PSBNOW,"",-168),PSBSTOP=PSBNOW,GMRVSTR(0)=PSBSTRT_U_PSBSTOP_U_4_U
"RTN","PSBRPC",208,0)
 K ^UTILITY($J,"GMRVD")
"RTN","PSBRPC",209,0)
 D EN1^GMRVUT0
"RTN","PSBRPC",210,0)
 S PSBCNT=1
"RTN","PSBRPC",211,0)
 I '$D(^UTILITY($J,"GMRVD")) S RESULTS(0)=PSBCNT,RESULTS(PSBCNT)="No Vitals to report" Q
"RTN","PSBRPC",212,0)
 S PSBTYP=""
"RTN","PSBRPC",213,0)
 F  S PSBTYP=$O(^UTILITY($J,"GMRVD",PSBTYP)) Q:PSBTYP=""  D
"RTN","PSBRPC",214,0)
 .S PSBRDT=""
"RTN","PSBRPC",215,0)
 .F  S PSBRDT=$O(^UTILITY($J,"GMRVD",PSBTYP,PSBRDT)) Q:PSBRDT=""  D
"RTN","PSBRPC",216,0)
 ..S PSBIEN=""
"RTN","PSBRPC",217,0)
 ..F  S PSBIEN=$O(^UTILITY($J,"GMRVD",PSBTYP,PSBRDT,PSBIEN)) Q:PSBIEN=""  D
"RTN","PSBRPC",218,0)
 ...S PSBDATA=($G(^UTILITY($J,"GMRVD",PSBTYP,PSBRDT,PSBIEN)))
"RTN","PSBRPC",219,0)
 ...S RESULTS(PSBCNT)=PSBTYP_U_$P(PSBDATA,U,1,2)_U_$P(PSBDATA,U,8)
"RTN","PSBRPC",220,0)
 ...S PSBCNT=PSBCNT+1
"RTN","PSBRPC",221,0)
 S RESULTS(0)=PSBCNT-1
"RTN","PSBRPC",222,0)
 K ^UTILITY($J,"GMRVD"),GMRBSTR,PSBDFN,PSBTYPE,PSBDATA,PSBCNT
"RTN","PSBRPC",223,0)
 Q
"RTN","PSBRPC",224,0)
 ;
"RTN","PSBRPC1")
0^40^B9800054
"RTN","PSBRPC1",1,0)
PSBRPC1 ;BIRMINGHAM/VN-BCMA RPC BROKER CALLS ;Mar 2004
"RTN","PSBRPC1",2,0)
 ;;3.0;BAR CODE MED ADMIN;;Mar 2004
"RTN","PSBRPC1",3,0)
 ;
"RTN","PSBRPC1",4,0)
 ; Reference/IA
"RTN","PSBRPC1",5,0)
 ; ^%ZIS/812
"RTN","PSBRPC1",6,0)
 ; ^XUSEC/10076
"RTN","PSBRPC1",7,0)
 ; File 200/10060
"RTN","PSBRPC1",8,0)
 ;
"RTN","PSBRPC1",9,0)
DEVICE(RESULTS,FROM,DIR) ;
"RTN","PSBRPC1",10,0)
 ;
"RTN","PSBRPC1",11,0)
 ; RPC: PSB DEVICE
"RTN","PSBRPC1",12,0)
 ;
"RTN","PSBRPC1",13,0)
 ; Return a subset of entries from the Device file
"RTN","PSBRPC1",14,0)
 ;
"RTN","PSBRPC1",15,0)
 ; .LST(n)=IEN;Name^DisplayName^Location^RMar^PLen
"RTN","PSBRPC1",16,0)
 ; FROM=text to $O from, DIR=$O direction
"RTN","PSBRPC1",17,0)
 K RESULTS
"RTN","PSBRPC1",18,0)
 N I,IEN,SHOW,X S I=0,CNT=20
"RTN","PSBRPC1",19,0)
 I FROM["<" S FROM=$RE($P($RE(FROM),"<  ",2))
"RTN","PSBRPC1",20,0)
 F  Q:I'<CNT  S FROM=$O(^%ZIS(1,"B",FROM),DIR) Q:FROM=""  D
"RTN","PSBRPC1",21,0)
 . S IEN=0 F  S IEN=$O(^%ZIS(1,"B",FROM,IEN)) Q:'IEN  D
"RTN","PSBRPC1",22,0)
 .. N X0,X1,X90,X91,X95,XTYPE,XSTYPE,XTIME,%A,%X,POP
"RTN","PSBRPC1",23,0)
 .. Q:'$D(^%ZIS(1,IEN,0))
"RTN","PSBRPC1",24,0)
 .. S X0=$G(^%ZIS(1,IEN,0)),X1=$G(^(1)),X90=$G(^(90)),X91=$G(^(91)),X95=$G(^(95)),XSTYPE=$G(^("SUBTYPE")),XTIME=$G(^("TIME")),XTYPE=$G(^("TYPE"))
"RTN","PSBRPC1",25,0)
 .. I $E($G(^%ZIS(2,+XSTYPE,0)))'="P" Q  ;Printers only
"RTN","PSBRPC1",26,0)
 .. S X=$P(XTYPE,"^") I X'="TRM",X'="HG",X'="HFS",X'="CHAN" Q  ;Device Types
"RTN","PSBRPC1",27,0)
 .. S X=X0 I ($P(X,U,2)="0")!($P(X,U,12)=2) Q  ;Queuing allowed
"RTN","PSBRPC1",28,0)
 .. S X=+X90 I X,(X'>DT) Q  ;Out of Service
"RTN","PSBRPC1",29,0)
 .. I XTIME]"" S %A=$P(XTIME,"^"),%X=$P($H,",",2),%=%X\60#60+(%X\3600*100),%X=$P(%A,"-",2) I %X'<%A&(%'>%X&(%'<%A))!(%X<%A&(%'<%A!(%'>%X))) Q  ;Prohibited Times
"RTN","PSBRPC1",30,0)
 .. S POP=0
"RTN","PSBRPC1",31,0)
 .. I X95]"" S %X=$G(DUZ(0)) I %X'="@" S POP=1 F %A=1:1:$L(%X) I X95[$E(%X,%A) S POP=0 Q
"RTN","PSBRPC1",32,0)
 .. Q:POP  ;Security check
"RTN","PSBRPC1",33,0)
 .. S SHOW=$P(X0,U) I SHOW'=FROM S SHOW=FROM_"  <"_SHOW_">"
"RTN","PSBRPC1",34,0)
 .. S I=I+1,RESULTS(I)=IEN_";"_$P(X0,U)_U_SHOW_U_$P(X1,U)_U_$P(X91,U)_U_$P(X91,U,3)
"RTN","PSBRPC1",35,0)
 .. S RESULTS(0)=I
"RTN","PSBRPC1",36,0)
 I '$D(RESULTS(0)) S RESULTS(0)=1,RESULTS(1)="-1^No printers on file"
"RTN","PSBRPC1",37,0)
 Q
"RTN","PSBRPC1",38,0)
GPROV(RESULTS,DUMMY) ;
"RTN","PSBRPC1",39,0)
 K ^TMP("PSB",$J)
"RTN","PSBRPC1",40,0)
 S RESULTS=$NAME(^TMP("PSB",$J)),PSBCNT=1,^TMP("PSB",$J,0)=0
"RTN","PSBRPC1",41,0)
 D NOW^%DTC
"RTN","PSBRPC1",42,0)
 S X="" F  S X=$O(^XUSEC("PROVIDER",X)) Q:X=""  D
"RTN","PSBRPC1",43,0)
 .S PSBIACT=$$GET1^DIQ(200,X_",",53.4,"I") I PSBIACT'="",+PSBIACT'<% Q  ;if Inactive date and date is less than now Q
"RTN","PSBRPC1",44,0)
 .S PSBTERM=$$GET1^DIQ(200,X_",",9.2,"I") I PSBTERM'="",+PSBTERM'<% Q  ;if termination date and date is less than now Q
"RTN","PSBRPC1",45,0)
 .Q:'$$GET1^DIQ(200,X_",",53.1,"I")  ;is authorized to write med orders
"RTN","PSBRPC1",46,0)
 .Q:'$$GET1^DIQ(200,X_",",53.2)  ;must have DEA#
"RTN","PSBRPC1",47,0)
 .S ^TMP("PSBL",$J,$$GET1^DIQ(200,X_",",.01),X)=""
"RTN","PSBRPC1",48,0)
 S X="^TMP(""PSBL"","_$J_")",PSBCNT=1,^TMP("PSB",$J,0)=0
"RTN","PSBRPC1",49,0)
 F  S X=$Q(@X) Q:$QS(X,1)'="PSBL"  S ^TMP("PSB",$J,PSBCNT)=$QS(X,3)_"^"_$QS(X,4),^TMP("PSB",$J,0)=PSBCNT,PSBCNT=PSBCNT+1
"RTN","PSBRPC1",50,0)
 K ^TMP("PSBL",$J),PSBIACT,PSBTERM,PSBAUTH,PSBCNT,DUMMY
"RTN","PSBRPC2")
0^41^B43763791
"RTN","PSBRPC2",1,0)
PSBRPC2 ;BIRMINGHAM/EFC-BCMA RPC BROKER CALLS ;Mar 2004
"RTN","PSBRPC2",2,0)
 ;;3.0;BAR CODE MED ADMIN;;Mar 2004
"RTN","PSBRPC2",3,0)
 ;
"RTN","PSBRPC2",4,0)
 ; Reference/IA
"RTN","PSBRPC2",5,0)
 ; File 50/221
"RTN","PSBRPC2",6,0)
 ; File 52.6/436
"RTN","PSBRPC2",7,0)
 ; File 52.7/437
"RTN","PSBRPC2",8,0)
 ;
"RTN","PSBRPC2",9,0)
GETOHIST(RESULTS,DFN,PSBORD) ;
"RTN","PSBRPC2",10,0)
 S RESULTS=$NAME(^TMP("PSB",$J)),PSB=0
"RTN","PSBRPC2",11,0)
 S ^TMP("PSB",$J,0)=1,^TMP("PSB",$J,1)="-1^No History On File"
"RTN","PSBRPC2",12,0)
 D NOW^%DTC S PSBNOW=$P(%,".",1),PSBNOWZ=%
"RTN","PSBRPC2",13,0)
 D EN^PSBPOIV(DFN,PSBORD)
"RTN","PSBRPC2",14,0)
 S PSBUID=DFN_"V"_99999 F  S PSBUID=$O(^TMP("PSBAR",$J,PSBUID),-1) Q:PSBUID=""  D
"RTN","PSBRPC2",15,0)
 .S PSBUIDS=^TMP("PSBAR",$J,PSBUID)
"RTN","PSBRPC2",16,0)
 .I ((PSBOSTS="D")!(PSBOSTS="E")),$P(PSBUIDS,U,2)'="I",$P(PSBUIDS,U,2)'="S" Q   ; only want the infusing bag on a dc'ed order
"RTN","PSBRPC2",17,0)
 .I (PSBOSTS="A"),(PSBOSP<PSBNOWZ),$P(PSBUIDS,U,2)'="I",$P(PSBUIDS,U,2)'="S" S PSBOSTS="E" Q  ; only want the infusing bag on an expired order
"RTN","PSBRPC2",18,0)
 .I $P(PSBUIDS,U,2)'="" D  Q  ; get orders from med log (53.79)
"RTN","PSBRPC2",19,0)
 ..S PSBMLOR=$P(PSBUIDS,U,4),PSBIEN=$O(^PSB(53.79,"AUID",DFN,PSBMLOR,PSBUID,""))
"RTN","PSBRPC2",20,0)
 ..S PSBLADT=$P(^PSB(53.79,PSBIEN,0),U,6)
"RTN","PSBRPC2",21,0)
 ..S PSBLASTS=$P(^PSB(53.79,PSBIEN,0),U,9)
"RTN","PSBRPC2",22,0)
 ..I PSBLASTS="M",$P(PSBUIDS,U,8)'="" Q
"RTN","PSBRPC2",23,0)
 ..S PSBINJS=$P(^PSB(53.79,PSBIEN,.1),U,6)
"RTN","PSBRPC2",24,0)
 ..S PSB=PSB+1,^TMP("PSB",$J,PSB)=PSBORD_U_PSBUID_U_PSBIEN_U_PSBLADT_U_PSBLASTS_U_PSBINJS
"RTN","PSBRPC2",25,0)
 ..F PSBL=1:1 Q:'$D(^PSB(53.79,PSBIEN,.6,PSBL,0))  S PSB=PSB+1,^TMP("PSB",$J,PSB)="ADD^"_^PSB(53.79,PSBIEN,.6,PSBL,0)
"RTN","PSBRPC2",26,0)
 ..F PSBL=1:1 Q:'$D(^PSB(53.79,PSBIEN,.7,PSBL,0))  S PSB=PSB+1,^TMP("PSB",$J,PSB)="SOL^"_^PSB(53.79,PSBIEN,.7,PSBL,0)
"RTN","PSBRPC2",27,0)
 ..S PSB=PSB+1,^TMP("PSB",$J,PSB)="END"
"RTN","PSBRPC2",28,0)
 .I $P(PSBUIDS,U,1)="I" Q  ; IV parameters say bag is invalid
"RTN","PSBRPC2",29,0)
 .I $P(PSBUIDS,U,8)'="",$P(PSBUIDS,U,2)'="I",$P(PSBUIDS,U,2)'="S" Q  ; label has been reprinted/distroyed etc. - bag is not infusing or stopped
"RTN","PSBRPC2",30,0)
 .S PSB=PSB+1,^TMP("PSB",$J,PSB)=$P(PSBUIDS,U,5)_U_PSBUID_U_U_PSBNOW_U_"A"
"RTN","PSBRPC2",31,0)
 .S PSBUIDP=$P(PSBUIDS,U,10,999)
"RTN","PSBRPC2",32,0)
 .F Y=3:1 S PSBMEDTY=$P(PSBUIDP,U,Y) Q:PSBMEDTY=""  D
"RTN","PSBRPC2",33,0)
 ..D CLEAN^PSBVT,PSJ1^PSBVT(DFN,$P(PSBUIDS,U,5))
"RTN","PSBRPC2",34,0)
 ..I $P(PSBMEDTY,";",1)="ADD" F Z=1:1 S PSBAD=$G(PSBADA(Z)) Q:PSBAD=""  I $P(PSBADA(Z),U,2)=$P(PSBMEDTY,";",2) S PSB=PSB+1,^TMP("PSB",$J,PSB)=PSBADA(Z) Q
"RTN","PSBRPC2",35,0)
 ..I $P(PSBMEDTY,";",1)="SOL" F Z=1:1 S PSBSOL=$G(PSBSOLA(Z)) Q:PSBSOL=""  I $P(PSBSOLA(Z),U,2)=$P(PSBMEDTY,";",2) S PSB=PSB+1,^TMP("PSB",$J,PSB)=PSBSOLA(Z) Q
"RTN","PSBRPC2",36,0)
 .D CLEAN^PSBVT,PSJ1^PSBVT(DFN,PSBORD)
"RTN","PSBRPC2",37,0)
 .S PSB=PSB+1,^TMP("PSB",$J,PSB)="END"
"RTN","PSBRPC2",38,0)
 F II=1:1 S I=$P(PSBONXS,U,II) Q:I=""  D  ; get ward stocks
"RTN","PSBRPC2",39,0)
 .S PSBUID="" F  S PSBUID=$O(^PSB(53.79,"AUID",DFN,I,PSBUID)) Q:PSBUID=""  D
"RTN","PSBRPC2",40,0)
 ..I PSBUID'["WS" Q  ; not a ward stock
"RTN","PSBRPC2",41,0)
 ..S PSBIEN=$O(^PSB(53.79,"AUID",DFN,I,PSBUID,""))
"RTN","PSBRPC2",42,0)
 ..S PSBLADT=$P(^PSB(53.79,PSBIEN,0),U,6)
"RTN","PSBRPC2",43,0)
 ..S PSBLASTS=$P(^PSB(53.79,PSBIEN,0),U,9)
"RTN","PSBRPC2",44,0)
 ..I PSBOSTS="D",PSBLASTS'="I",PSBLASTS'="S" Q  ; want "not completed" on DC'ed orders
"RTN","PSBRPC2",45,0)
 ..I (PSBOSTS="A"),(PSBOSP<PSBNOWZ),PSBLASTS'="I",PSBLASTS'="S" Q
"RTN","PSBRPC2",46,0)
 ..S PSBINJS=$P(^PSB(53.79,PSBIEN,.1),U,6)
"RTN","PSBRPC2",47,0)
 ..S PSB=PSB+1,^TMP("PSB",$J,PSB)=PSBORD_U_PSBUID_U_PSBIEN_U_PSBLADT_U_PSBLASTS_U_PSBINJS
"RTN","PSBRPC2",48,0)
 ..F PSBL=1:1 Q:'$D(^PSB(53.79,PSBIEN,.6,PSBL,0))  S PSB=PSB+1,^TMP("PSB",$J,PSB)="ADD^"_^PSB(53.79,PSBIEN,.6,PSBL,0)
"RTN","PSBRPC2",49,0)
 ..F PSBL=1:1 Q:'$D(^PSB(53.79,PSBIEN,.7,PSBL,0))  S PSB=PSB+1,^TMP("PSB",$J,PSB)="SOL^"_^PSB(53.79,PSBIEN,.7,PSBL,0)
"RTN","PSBRPC2",50,0)
 ..S PSB=PSB+1,^TMP("PSB",$J,PSB)="END"
"RTN","PSBRPC2",51,0)
 S ^TMP("PSB",$J,0)=PSB
"RTN","PSBRPC2",52,0)
 K ^TMP("PSBAR",$J)
"RTN","PSBRPC2",53,0)
 Q
"RTN","PSBRPC2",54,0)
 ;
"RTN","PSBRPC2",55,0)
BAGDTL(RESULTS,PSBUID,PSBORD)  ; bag detail
"RTN","PSBRPC2",56,0)
 I $G(DFN)="" S DFN=+PSBUID
"RTN","PSBRPC2",57,0)
 S (PSBIEN,X)="" F  S X=$O(^PSB(53.79,"AUID",DFN,X)) Q:X=""  S:$D(^PSB(53.79,"AUID",DFN,X,PSBUID)) PSBIEN=$O(^PSB(53.79,"AUID",DFN,X,PSBUID,"")) Q:PSBIEN]""
"RTN","PSBRPC2",58,0)
 I PSBIEN'>0 S RESULTS(0)="-1^No History On File" Q
"RTN","PSBRPC2",59,0)
 M PSBMLA=^PSB(53.79,PSBIEN)
"RTN","PSBRPC2",60,0)
 S X=$P(^PSB(53.79,PSBIEN,0),U,9)
"RTN","PSBRPC2",61,0)
 S PSBLAC=$S(X="I":"INFUSING",X="G":"GIVEN",X="C":"COMPLETE",X="H":"HELD",X="R":"REFUSED",X="RM":"REMOVED",X="S":"STOPPED",X="M":"MISSING",1:"NO ACTION")
"RTN","PSBRPC2",62,0)
 ; comments
"RTN","PSBRPC2",63,0)
 F PSBX=1:1 Q:'$D(PSBMLA(.3,PSBX))  S PSBTMP(10000000-$P(PSBMLA(.3,PSBX,0),U,3),"C")=$P(PSBMLA(.3,PSBX,0),U,3)_U_$$INITIAL($P(PSBMLA(.3,PSBX,0),U,2))_U_U_$P(PSBMLA(.3,PSBX,0),U,1)
"RTN","PSBRPC2",64,0)
 ; audit
"RTN","PSBRPC2",65,0)
 S PSBGA="" I $D(PSBMLA(.9,0)) D
"RTN","PSBRPC2",66,0)
 .F PSBX=1:1 Q:'$D(PSBMLA(.9,PSBX))  I ((PSBMLA(.9,PSBX,0)["ACTION STATUS")!(PSBMLA(.9,PSBX,0)["ADMINISTRATION STATUS")) D  Q
"RTN","PSBRPC2",67,0)
 ..Q:'$D(PSBMLA(.9,PSBX-2,0)) 
"RTN","PSBRPC2",68,0)
 ..D DT^DILF("ENPST",$P(PSBMLA(.9,PSBX-2,0),"'",2),.PSBDATE)
"RTN","PSBRPC2",69,0)
 ..S PSBTMP(10000000-PSBDATE,"B")=PSBDATE_U_$$INITIAL($P(PSBMLA(0),U,5))_U_$P(PSBMLA(.9,PSBX,0),"'",2)
"RTN","PSBRPC2",70,0)
 ..S PSBGA=1
"RTN","PSBRPC2",71,0)
 .F PSBX=1:1 Q:'$D(PSBMLA(.9,PSBX))  I ((PSBMLA(.9,PSBX,0)["ACTION STATUS")!(PSBMLA(.9,PSBX,0)["ADMINISTRATION STATUS")) D
"RTN","PSBRPC2",72,0)
 ..S PSBTMP(10000000-$P(PSBMLA(.9,PSBX,0),U,1),"B")=$P(PSBMLA(.9,PSBX,0),U,1)_U_$$INITIAL($P(PSBMLA(.9,PSBX,0),U,2))_U_$P($P(PSBMLA(.9,PSBX,0),U,3),"'",2)
"RTN","PSBRPC2",73,0)
 ..S PSBGA=1
"RTN","PSBRPC2",74,0)
 I PSBGA'=1 S PSBTMP(10000000-$P(PSBMLA(0),U,6),"A")=$P(PSBMLA(0),U,6)_U_$$INITIAL($P(PSBMLA(0),U,7))_U_PSBLAC
"RTN","PSBRPC2",75,0)
 S PSBQRY="PSBTMP",PSBCNT=1 F  S PSBQRY=$Q(@PSBQRY) Q:PSBQRY=""  D  ; does comment go with action
"RTN","PSBRPC2",76,0)
 .S PSBPQRY=$Q(@PSBQRY,-1)
"RTN","PSBRPC2",77,0)
 .I PSBPQRY="" S RESULTS(PSBCNT)=@PSBQRY,PSBCNT=PSBCNT+1 Q  ; no previous action
"RTN","PSBRPC2",78,0)
 .I $QS(PSBPQRY,2)="C"  S RESULTS(PSBCNT)=@PSBQRY,PSBCNT=PSBCNT+1 Q  ; previous line is a comment
"RTN","PSBRPC2",79,0)
 .I $QS(PSBQRY,2)="C",$E($P(@$Q(@PSBQRY,-1),U,1),1,12)=$E($P(@PSBQRY,U,1),1,12),$P(@$Q(@PSBQRY,-1),U,2)=$P(@PSBQRY,U,2) S X=$P(@PSBQRY,U,4),$P(RESULTS(PSBCNT-1),U,4)=X Q
"RTN","PSBRPC2",80,0)
 .S RESULTS(PSBCNT)=@PSBQRY,PSBCNT=PSBCNT+1
"RTN","PSBRPC2",81,0)
 S RESULTS(0)=PSBCNT-1
"RTN","PSBRPC2",82,0)
 K PSBMLA,PSBIEN,PSBTMP,PSBQRY
"RTN","PSBRPC2",83,0)
 Q
"RTN","PSBRPC2",84,0)
 ;
"RTN","PSBRPC2",85,0)
INITIAL(PSBDUZ) ;
"RTN","PSBRPC2",86,0)
 Q $$GET1^DIQ(200,PSBDUZ,"INITIAL")
"RTN","PSBRPC2",87,0)
SCANMED(RESULTS,PSBDIEN,PSBTAB)  ; Lookup Medication
"RTN","PSBRPC2",88,0)
 ;
"RTN","PSBRPC2",89,0)
 ; RPC: PSB SCANMED
"RTN","PSBRPC2",90,0)
 ;
"RTN","PSBRPC2",91,0)
 ; Description:
"RTN","PSBRPC2",92,0)
 ; Does a lookup on file 50 returns -1 on invalid lookup or
"RTN","PSBRPC2",93,0)
 ; IEN^DrugName on success
"RTN","PSBRPC2",94,0)
 ;
"RTN","PSBRPC2",95,0)
 D NOW^%DTC S PSBDT=%
"RTN","PSBRPC2",96,0)
 S PSBCNT=0
"RTN","PSBRPC2",97,0)
 I $L(PSBDIEN?.N)>31 S PSBDIEN=$E(PSBDIEN,1,31)
"RTN","PSBRPC2",98,0)
 S RESULTS(PSBCNT)=1
"RTN","PSBRPC2",99,0)
 S PSBCNT=PSBCNT+1,RESULTS(PSBCNT)="-1^Invalid Medication Lookup"
"RTN","PSBRPC2",100,0)
 I $$GET^XPAR("DIV","PSB ROBOT RX"),PSBDIEN?1"3"15N!(PSBDIEN?1"3"17N),123[$E(PSBDIEN,12) S PSBDIEN=$E(PSBDIEN,2,11)
"RTN","PSBRPC2",101,0)
 I PSBTAB="UDTAB" D  Q
"RTN","PSBRPC2",102,0)
 .S X=$$FIND1^DIC(50,"","AX",PSBDIEN,"B^C")
"RTN","PSBRPC2",103,0)
 .I X<1 Q
"RTN","PSBRPC2",104,0)
 .E  S RESULTS(PSBCNT)="DD"_U_X_U_$$GET1^DIQ(50,X_",",.01)
"RTN","PSBRPC2",105,0)
 ;
"RTN","PSBRPC2",106,0)
 ; IV/IVPB ward stock scan
"RTN","PSBRPC2",107,0)
 ;
"RTN","PSBRPC2",108,0)
 S PSBDIEN=$$FIND1^DIC(50,"","AX",PSBDIEN,"B^C") I PSBDIEN<1 Q
"RTN","PSBRPC2",109,0)
 S PSBOIT=$$GET1^DIQ(50,PSBDIEN,"PHARMACY ORDERABLE ITEM","I")
"RTN","PSBRPC2",110,0)
 I $D(^PSDRUG("A527",PSBDIEN)) S X="" F  S X=$O(^PSDRUG("A527",PSBDIEN,X)) Q:X=""  D
"RTN","PSBRPC2",111,0)
 .S PSBINACT=$$GET1^DIQ(52.7,X,8,"I") I PSBINACT]"",PSBINACT'>PSBDT Q
"RTN","PSBRPC2",112,0)
 .S RESULTS(PSBCNT)="SOL"_U_X_U_$$GET1^DIQ(50,PSBDIEN_",",.01),PSBCNT=PSBCNT+1,RESULTS(0)=PSBCNT-1
"RTN","PSBRPC2",113,0)
 I $D(^PSDRUG("A526",PSBDIEN)) S X="" F  S X=$O(^PSDRUG("A526",PSBDIEN,X)) Q:X=""  D
"RTN","PSBRPC2",114,0)
 .S PSBINACT=$$GET1^DIQ(52.6,X,12,"I") I PSBINACT]"",PSBINACT'>PSBDT Q
"RTN","PSBRPC2",115,0)
 .S RESULTS(PSBCNT)="ADD"_U_X_U_$$GET1^DIQ(50,PSBDIEN_",",.01),PSBCNT=PSBCNT+1,RESULTS(0)=PSBCNT-1
"RTN","PSBRPC2",116,0)
 ;
"RTN","PSBRPC2",117,0)
 I PSBTAB="PBTAB",$$FIND1^DIC(50,"","AX",PSBDIEN,"B^C")'<1 S X=$$FIND1^DIC(50,"","AX",PSBDIEN,"B^C"),RESULTS(PSBCNT)="DD"_U_X_U_$$GET1^DIQ(50,X_",",.01),PSBCNT=PSBCNT+1,RESULTS(0)=PSBCNT-1
"RTN","PSBRPC2",118,0)
 Q
"RTN","PSBRPC2",119,0)
 ;
"RTN","PSBRPC3")
0^42^B316279
"RTN","PSBRPC3",1,0)
PSBRPC3 ;BIRMINGHAM/VRN-BCMA RPC BROKER CALLS ;Mar 2004
"RTN","PSBRPC3",2,0)
 ;;3.0;BAR CODE MED ADMIN;;Mar 2004
"RTN","PSBRPC3",3,0)
 ;
"RTN","PSBRPC3",4,0)
GUICHK(RESULTS,DUMMY) ;
"RTN","PSBRPC3",5,0)
 ;
"RTN","PSBRPC3",6,0)
 ; RPC : PSB VERSION CHECK
"RTN","PSBRPC3",7,0)
 ;
"RTN","PSBRPC3",8,0)
 K RESULTS
"RTN","PSBRPC3",9,0)
 N PSBCURR,PSBPREV,PSBCNT
"RTN","PSBRPC3",10,0)
 S PSBCURR="3.0.0.*",PSBPREV="2.0.36.*",PSBCNT=0
"RTN","PSBRPC3",11,0)
 S PSBCNT=PSBCNT+1
"RTN","PSBRPC3",12,0)
 S RESULTS(PSBCNT)=PSBCURR_U_PSBPREV
"RTN","PSBRPC3",13,0)
 S RESULTS(0)=PSBCNT
"RTN","PSBRPC3",14,0)
 Q
"RTN","PSBRPCMO")
0^43^B57699601
"RTN","PSBRPCMO",1,0)
PSBRPCMO ;BIRMINGHAM/EFC-MED ORDER BUTTON FUNCTIONS ;Mar 2004
"RTN","PSBRPCMO",2,0)
 ;;3.0;BAR CODE MED ADMIN;;Mar 2004
"RTN","PSBRPCMO",3,0)
 ;
"RTN","PSBRPCMO",4,0)
 ; Reference/IA
"RTN","PSBRPCMO",5,0)
 ; ^XUSEC("PROVIDER")/10076
"RTN","PSBRPCMO",6,0)
 ; ^%DTC/10000
"RTN","PSBRPCMO",7,0)
 ; ^XPAR/2263
"RTN","PSBRPCMO",8,0)
 ; File 50/221
"RTN","PSBRPCMO",9,0)
 ; File 50.7/2880
"RTN","PSBRPCMO",10,0)
 ; File 200/10060
"RTN","PSBRPCMO",11,0)
 ; File 52.6/436
"RTN","PSBRPCMO",12,0)
 ; File 52.7/437
"RTN","PSBRPCMO",13,0)
 ; $$EN^ORBCMA2/3616
"RTN","PSBRPCMO",14,0)
 ;
"RTN","PSBRPCMO",15,0)
OILST(RESULTS,PSBSCAN,PSBOTYP) ;
"RTN","PSBRPCMO",16,0)
 I $L(PSBSCAN?.N)>31 S PSBSCAN=$E(PSBSCAN,1,31)
"RTN","PSBRPCMO",17,0)
 S PSBSCAN=$TR(PSBSCAN,"abcdefghijklmnopqrstuvwxyz","ABCDEFGHIJKLMNOPQRSTUVWXYZ")
"RTN","PSBRPCMO",18,0)
 D NOW^%DTC S PSBDT=%
"RTN","PSBRPCMO",19,0)
 I $$GET^XPAR("DIV","PSB ROBOT RX"),PSBSCAN?1"3"15N!(PSBSCAN?1"3"17N),123[$E(PSBSCAN,12) S PSBSCAN=$E(PSBSCAN,2,11)
"RTN","PSBRPCMO",20,0)
 S PSBCNT=0
"RTN","PSBRPCMO",21,0)
 I PSBSCAN?.N D  ;is a scanned bar code
"RTN","PSBRPCMO",22,0)
 .I '$D(^PSDRUG(PSBSCAN)) S PSBSCAN=$$FIND1^DIC(50,"","AX",PSBSCAN,"B^C") I PSBSCAN<1 Q  ; not in the drug file
"RTN","PSBRPCMO",23,0)
 .Q:PSBOTYP="UD"&($P($G(^PSDRUG(PSBSCAN,2)),U,3)'["U")
"RTN","PSBRPCMO",24,0)
 .Q:PSBOTYP="UD"&($G(^PSDRUG(PSBSCAN,"I"))&(+$G(^("I"))'>PSBDT))
"RTN","PSBRPCMO",25,0)
 .S PSBOIEN=$$GET1^DIQ(50,PSBSCAN,"PHARMACY ORDERABLE ITEM","I") Q:PSBOIEN=""  ;orderable item ien
"RTN","PSBRPCMO",26,0)
 .D CPRS
"RTN","PSBRPCMO",27,0)
 .Q:PSBCPRS]""&(PSBCPRS'>PSBDT)
"RTN","PSBRPCMO",28,0)
 .;check for cprs orderable inactive date
"RTN","PSBRPCMO",29,0)
 .I $P(A,U,4)="" Q
"RTN","PSBRPCMO",30,0)
 .I +$P(A,U,4)=0 Q  ;not an inpatient pharmacy item
"RTN","PSBRPCMO",31,0)
 .S PSBPOI=$$GET1^DIQ(50.7,PSBOIEN,.01)
"RTN","PSBRPCMO",32,0)
 .S PSBDD=$$GET1^DIQ(50,PSBSCAN,.01)
"RTN","PSBRPCMO",33,0)
 .I PSBOTYP="UD" D  Q
"RTN","PSBRPCMO",34,0)
 ..S PSBDRUG="DD"_U_PSBSCAN_U_PSBDD_U_PSBOIEN_U_PSBPOI_U_PSBORIEN_U_PSBORNM
"RTN","PSBRPCMO",35,0)
 ..S PSBCNT=PSBCNT+1,RESULTS(PSBCNT)=PSBDRUG,RESULTS(0)=PSBCNT
"RTN","PSBRPCMO",36,0)
 .I PSBOTYP="IV" D  Q
"RTN","PSBRPCMO",37,0)
 ..S PSBCNT=0
"RTN","PSBRPCMO",38,0)
 ..I $P(A,U,4)=2 D
"RTN","PSBRPCMO",39,0)
 ...I $D(^PSDRUG("A527",PSBSCAN)) D SOLN
"RTN","PSBRPCMO",40,0)
 ...I $D(^PSDRUG("A526",PSBSCAN)) D ADD
"RTN","PSBRPCMO",41,0)
 .S PSBCNT=PSBCNT+1,RESULTS(PSBCNT)="-1^Medication does not match ordertype",RESULTS(0)=PSBCNT Q
"RTN","PSBRPCMO",42,0)
 ;
"RTN","PSBRPCMO",43,0)
 I PSBSCAN'?.N D
"RTN","PSBRPCMO",44,0)
 .K PSBMSG D LIST^DIC(50,"","2.1I;2.1","P","","",PSBSCAN,"B","","","^TMP(""PSBLST"",$J)","PSBMSG")
"RTN","PSBRPCMO",45,0)
 .;scan is alphanumeric do a look up of the "B" index of drug file
"RTN","PSBRPCMO",46,0)
 .;
"RTN","PSBRPCMO",47,0)
 .S X=0 F  S X=$O(^TMP("PSBLST",$J,"DILIST",X)) Q:X=""  D
"RTN","PSBRPCMO",48,0)
 ..Q:$P(^TMP("PSBLST",$J,"DILIST",X,0),U,3)=""
"RTN","PSBRPCMO",49,0)
 ..Q:$P(^TMP("PSBLST",$J,"DILIST",X,0),U,4)=""
"RTN","PSBRPCMO",50,0)
 ..I $P(^TMP("PSBLST",$J,"DILIST",X,0),U,3)'?.N S $P(^TMP("PSBLST",$J,"DILIST",X,0),U,3,99)=$P(^TMP("PSBLST",$J,"DILIST",X,0),U,4,99)
"RTN","PSBRPCMO",51,0)
 ..S ^TMP("PSB",$J,$P(^TMP("PSBLST",$J,"DILIST",X,0),U,1))=^TMP("PSBLST",$J,"DILIST",X,0)
"RTN","PSBRPCMO",52,0)
 .;
"RTN","PSBRPCMO",53,0)
 .K ^TMP("PSBLST",$J,"DILIST"),PSBMSG D LIST^DIC(50,"","2.1I;2.1","P","","",PSBSCAN,"C","","","^TMP(""PSBLST"",$J)","PSBMSG")
"RTN","PSBRPCMO",54,0)
 .;scan is alphanumeric do a look up on the "C" index of drug file
"RTN","PSBRPCMO",55,0)
 .;
"RTN","PSBRPCMO",56,0)
 .S X=0 F  S X=$O(^TMP("PSBLST",$J,"DILIST",X)) Q:X=""  D
"RTN","PSBRPCMO",57,0)
 ..Q:$P(^TMP("PSBLST",$J,"DILIST",X,0),U,3)=""
"RTN","PSBRPCMO",58,0)
 ..Q:$P(^TMP("PSBLST",$J,"DILIST",X,0),U,4)=""
"RTN","PSBRPCMO",59,0)
 ..I $P(^TMP("PSBLST",$J,"DILIST",X,0),U,3)'?.N S $P(^TMP("PSBLST",$J,"DILIST",X,0),U,3,99)=$P(^TMP("PSBLST",$J,"DILIST",X,0),U,4,99)
"RTN","PSBRPCMO",60,0)
 ..S ^TMP("PSB",$J,$P(^TMP("PSBLST",$J,"DILIST",X,0),U,1))=$P(^TMP("PSBLST",$J,"DILIST",X,0),U)_U_$P($G(^PSDRUG($P(^TMP("PSBLST",$J,"DILIST",X,0),U),0)),U)_U_$P(^TMP("PSBLST",$J,"DILIST",X,0),U,3,99)
"RTN","PSBRPCMO",61,0)
 .S PSBCNT=0,RESULTS(0)=0,PSBTLNG=0
"RTN","PSBRPCMO",62,0)
 .S X="" F  S X=$O(^TMP("PSB",$J,X)) Q:((X="")!(PSBTLNG=1))  D
"RTN","PSBRPCMO",63,0)
 ..I $P(^TMP("PSB",$J,X),U,3)'?.N S $P(^TMP("PSB",$J,X),U,3,99)=$P(^TMP("PSB",$J,X),U,4,99)
"RTN","PSBRPCMO",64,0)
 ..S PSBOIEN=$P(^TMP("PSB",$J,X),U,3)
"RTN","PSBRPCMO",65,0)
 ..S PSBSCIEN=$P(^TMP("PSB",$J,X),U,1)
"RTN","PSBRPCMO",66,0)
 ..Q:PSBOTYP="UD"&($P($G(^PSDRUG(PSBSCIEN,2)),U,3)'["U")
"RTN","PSBRPCMO",67,0)
 ..Q:PSBOTYP="UD"&($G(^PSDRUG(PSBSCIEN,"I"))&(+$G(^("I"))'>PSBDT))
"RTN","PSBRPCMO",68,0)
 ..D CPRS
"RTN","PSBRPCMO",69,0)
 ..Q:PSBCPRS]""&(PSBCPRS'>PSBDT)
"RTN","PSBRPCMO",70,0)
 ..;check for cprs orderable inactive date
"RTN","PSBRPCMO",71,0)
 ..I $P(A,U,4)="" Q
"RTN","PSBRPCMO",72,0)
 ..I +$P(A,U,4)=0 Q  ;not an inpatient pharmacy item
"RTN","PSBRPCMO",73,0)
 ..I PSBOTYP="UD" D  Q
"RTN","PSBRPCMO",74,0)
 ...S PSBDRUG="DD"_U_$P(^TMP("PSB",$J,X),U,1,2)_U_$P(^TMP("PSB",$J,X),U,3,4)_U_PSBORIEN_U_PSBORNM
"RTN","PSBRPCMO",75,0)
 ...S PSBCNT=PSBCNT+1,RESULTS(PSBCNT)=PSBDRUG,RESULTS(0)=PSBCNT
"RTN","PSBRPCMO",76,0)
 ..I PSBOTYP="IV" D  Q
"RTN","PSBRPCMO",77,0)
 ...I $P(A,U,4)=2 D
"RTN","PSBRPCMO",78,0)
 ....I $D(^PSDRUG("A527",PSBSCIEN)) D SOLNAL
"RTN","PSBRPCMO",79,0)
 ....I $D(^PSDRUG("A526",PSBSCIEN)) D ADDAL
"RTN","PSBRPCMO",80,0)
 ..I RESULTS(0)>100 K RESULTS S RESULTS(0)=1,RESULTS(1)=-2,PSBTLNG=1 Q
"RTN","PSBRPCMO",81,0)
 I $G(RESULTS(1))="" S RESULTS(0)=1,RESULTS(1)="-1^Invalid Medication Lookup"
"RTN","PSBRPCMO",82,0)
 K PSBDD,PSBDRUG,PSBDT,PSBDTYP,PSBSCIEN,PSBOIEN,PSBORNM,PSBORIEN,PSBPOI,PSBSCAN,PSBTLNG,PSBID,PSBCPRS,^TMP("PSB",$J),^TMP("PSBLST",$J)
"RTN","PSBRPCMO",83,0)
 Q
"RTN","PSBRPCMO",84,0)
 ;
"RTN","PSBRPCMO",85,0)
CPRS ;
"RTN","PSBRPCMO",86,0)
 S PSBID=PSBOIEN_";99PSP"
"RTN","PSBRPCMO",87,0)
 S A=$$EN^ORBCMA2(PSBID)
"RTN","PSBRPCMO",88,0)
 S PSBORNM=$P(A,U,2)
"RTN","PSBRPCMO",89,0)
 S PSBORIEN=$P(A,U,1)
"RTN","PSBRPCMO",90,0)
 S PSBCPRS=$P(A,U,3)
"RTN","PSBRPCMO",91,0)
 Q
"RTN","PSBRPCMO",92,0)
SOLN     ;
"RTN","PSBRPCMO",93,0)
 S X="" F  S X=$O(^PSDRUG("A527",PSBSCAN,X)) Q:X=""  D
"RTN","PSBRPCMO",94,0)
 .S PSBINACT=$$GET1^DIQ(52.7,X,8,"I") I PSBINACT]"",PSBINACT'>PSBDT Q
"RTN","PSBRPCMO",95,0)
 .S PSBDRUG="SOL"_U_PSBSCAN_U_PSBDD_U_PSBOIEN_U_PSBPOI_U_PSBORIEN_U_PSBORNM
"RTN","PSBRPCMO",96,0)
 .S PSBCNT=PSBCNT+1,RESULTS(PSBCNT)=PSBDRUG_U_X_U_$$GET1^DIQ(52.7,X_",",.01)_U_$$GET1^DIQ(52.7,X_",",2),RESULTS(0)=PSBCNT
"RTN","PSBRPCMO",97,0)
 Q
"RTN","PSBRPCMO",98,0)
 ;
"RTN","PSBRPCMO",99,0)
ADD      ;
"RTN","PSBRPCMO",100,0)
 S X="" F  S X=$O(^PSDRUG("A526",PSBSCAN,X)) Q:X=""  D
"RTN","PSBRPCMO",101,0)
 .S PSBINACT=$$GET1^DIQ(52.6,X,12,"I") I PSBINACT]"",PSBINACT'>PSBDT Q
"RTN","PSBRPCMO",102,0)
 .S PSBDRUG="ADD"_U_PSBSCAN_U_PSBDD_U_PSBOIEN_U_PSBPOI_U_PSBORIEN_U_PSBORNM
"RTN","PSBRPCMO",103,0)
 .S PSBCNT=PSBCNT+1,RESULTS(PSBCNT)=PSBDRUG_U_X_U_$$GET1^DIQ(52.6,X_",",.01),RESULTS(0)=PSBCNT
"RTN","PSBRPCMO",104,0)
 Q
"RTN","PSBRPCMO",105,0)
 ;
"RTN","PSBRPCMO",106,0)
SOLNAL   ;
"RTN","PSBRPCMO",107,0)
 S Y="" F  S Y=$O(^PSDRUG("A527",PSBSCIEN,Y)) Q:Y=""  D
"RTN","PSBRPCMO",108,0)
 .S PSBINACT=$$GET1^DIQ(52.7,Y,8,"I") I PSBINACT]"",PSBINACT'>PSBDT Q
"RTN","PSBRPCMO",109,0)
 .S PSBDRUG="SOL"_U_$P(^TMP("PSB",$J,X),U,1,2)_U_$P(^TMP("PSB",$J,X),U,3,4)_U_PSBORIEN_U_PSBORNM
"RTN","PSBRPCMO",110,0)
 .S PSBCNT=PSBCNT+1,RESULTS(PSBCNT)=PSBDRUG_U_Y_U_$$GET1^DIQ(52.7,Y_",",.01)_U_$$GET1^DIQ(52.7,Y_",",2),RESULTS(0)=PSBCNT
"RTN","PSBRPCMO",111,0)
 Q
"RTN","PSBRPCMO",112,0)
 ;
"RTN","PSBRPCMO",113,0)
ADDAL    ;
"RTN","PSBRPCMO",114,0)
 S Y="" F  S Y=$O(^PSDRUG("A526",PSBSCIEN,Y)) Q:Y=""  D
"RTN","PSBRPCMO",115,0)
 .S PSBINACT=$$GET1^DIQ(52.6,Y,12,"I") I PSBINACT]"",PSBINACT'>PSBDT Q
"RTN","PSBRPCMO",116,0)
 .S PSBDRUG="ADD"_U_$P(^TMP("PSB",$J,X),U,1,2)_U_$P(^TMP("PSB",$J,X),U,3,4)_U_PSBORIEN_U_PSBORNM
"RTN","PSBRPCMO",117,0)
 .S PSBCNT=PSBCNT+1,RESULTS(PSBCNT)=PSBDRUG_U_Y_U_$$GET1^DIQ(52.6,Y_",",.01),RESULTS(0)=PSBCNT
"RTN","PSBRPCMO",118,0)
 Q
"RTN","PSBRPCMO",119,0)
 ;
"RTN","PSBRPCMO",120,0)
 ;
"RTN","PSBRPCMO",121,0)
PROVLST(RESULTS,PSBIN) ;
"RTN","PSBRPCMO",122,0)
 K ^TMP("PSB",$J) D NOW^%DTC
"RTN","PSBRPCMO",123,0)
 S PSBIN=$TR(PSBIN,"abcdefghijklmnopqrstuvwxyz","ABCDEFGHIJKLMNOPQRSTUVWXYZ")
"RTN","PSBRPCMO",124,0)
 S RESULTS(0)=1,RESULTS(1)="-1^No provider matching input.",PSBTLNG=0
"RTN","PSBRPCMO",125,0)
 D LIST^DIC(200,"","","P","","",PSBIN,"B","","","^TMP(""PSB"",$J)","PSBMSG")
"RTN","PSBRPCMO",126,0)
 S X=0 F  S X=$O(^TMP("PSB",$J,"DILIST",X)) Q:((X="")!(PSBTLNG=1))  D
"RTN","PSBRPCMO",127,0)
 .S PSBIEN=$P(^TMP("PSB",$J,"DILIST",X,0),U,1)
"RTN","PSBRPCMO",128,0)
 .I '$D(^XUSEC("PROVIDER",PSBIEN)) Q
"RTN","PSBRPCMO",129,0)
 .S PSBIACT=$$GET1^DIQ(200,PSBIEN_",",53.4,"I")
"RTN","PSBRPCMO",130,0)
 .Q:PSBIACT'=""&(+PSBIACT'>%)  ;if Inactive date and date is less than now Q
"RTN","PSBRPCMO",131,0)
 .S PSBTERM=$$GET1^DIQ(200,PSBIEN_",",9.2,"I")
"RTN","PSBRPCMO",132,0)
 .Q:PSBTERM'=""&(+PSBTERM'>%)  ;if termination date and date is less than now Q
"RTN","PSBRPCMO",133,0)
 .S PSBAUTH=$$GET1^DIQ(200,PSBIEN_",",53.1,"I") I PSBAUTH'=1 Q  ;is AUTHORIZED TO WRITE MED ORDERS
"RTN","PSBRPCMO",134,0)
 .I RESULTS(1)["-1" S RESULTS(0)=0
"RTN","PSBRPCMO",135,0)
 .S RESULTS(0)=RESULTS(0)+1,RESULTS(RESULTS(0))=$P(^TMP("PSB",$J,"DILIST",X,0),U,1,2)
"RTN","PSBRPCMO",136,0)
 .I RESULTS(0)>100 K RESULTS S RESULTS(0)=1,RESULTS(1)=-2,PSBTLNG=1
"RTN","PSBRPCMO",137,0)
 K ^TMP("PSB",$J),PSBIN,PSBTLNG,PSBIACT,PSBIEN,PSBTERM,PSBAUTH
"RTN","PSBRPCMO",138,0)
 Q
"RTN","PSBRPCMO",139,0)
 ;
"RTN","PSBRPCMO",140,0)
ORDER(RESULTS,PSBHDR,PSBREC) ;
"RTN","PSBRPCMO",141,0)
 ;
"RTN","PSBRPCMO",142,0)
 S RESULTS(0)=1,RESULTS(1)="-1^Data not filed"
"RTN","PSBRPCMO",143,0)
 S PSBDFN=$P(PSBHDR,U,1),PSBMON=$P(PSBHDR,U,2),PSBSCH=$P(PSBHDR,U,3)
"RTN","PSBRPCMO",144,0)
 S ^TMP("PSBMO",$J,PSBDFN,PSBMON,0)=PSBDFN_U_PSBMON_U_PSBREC(0)_U_PSBREC(1)_U_PSBREC(2)_U_PSBSCH
"RTN","PSBRPCMO",145,0)
 S ^TMP("PSBMO",$J,PSBDFN,PSBMON,700,0)=0,^TMP("PSBMO",$J,PSBDFN,PSBMON,800,0)=0,^TMP("PSBMO",$J,PSBDFN,PSBMON,900,0)=0
"RTN","PSBRPCMO",146,0)
 I PSBREC(3)>0 D
"RTN","PSBRPCMO",147,0)
 .S ^TMP("PSBMO",$J,PSBDFN,PSBMON,700,0)=PSBREC(3)
"RTN","PSBRPCMO",148,0)
 .F I=1:1:PSBREC(3) D
"RTN","PSBRPCMO",149,0)
 ..S ^TMP("PSBMO",$J,PSBDFN,PSBMON,700,I,0)=$P(PSBREC(4),U,1)_U_$P(PSBREC(4),U,2)
"RTN","PSBRPCMO",150,0)
 ..S PSBREC(4)=$P(PSBREC(4),U,3,99)
"RTN","PSBRPCMO",151,0)
 I PSBREC(5)>0 D
"RTN","PSBRPCMO",152,0)
 .S ^TMP("PSBMO",$J,PSBDFN,PSBMON,800,0)=PSBREC(5)
"RTN","PSBRPCMO",153,0)
 .F I=1:1:PSBREC(5) S ^TMP("PSBMO",$J,PSBDFN,PSBMON,800,I,0)=$P(PSBREC(6),U,I)
"RTN","PSBRPCMO",154,0)
 I PSBREC(7)>0 D
"RTN","PSBRPCMO",155,0)
 .S ^TMP("PSBMO",$J,PSBDFN,PSBMON,900,0)=PSBREC(7)
"RTN","PSBRPCMO",156,0)
 .F I=1:1:PSBREC(7) S ^TMP("PSBMO",$J,PSBDFN,PSBMON,900,I,0)=$P(PSBREC(8),U,I)
"RTN","PSBRPCMO",157,0)
 S ^TMP("PSBMO",$J,PSBDFN,PSBMON,"PSB")=DUZ_U_DUZ(2)_U_PSBREC(9)
"RTN","PSBRPCMO",158,0)
 S RESULTS(0)=1,RESULTS(1)="1^Data successfully filed"
"RTN","PSBRPCMO",159,0)
 Q
"RTN","PSBRPCXM")
0^44^B3744891
"RTN","PSBRPCXM",1,0)
PSBRPCXM ;BIRMINGHAM/EFC-VISTA MAILMAN INTERFACE ;Mar 2004
"RTN","PSBRPCXM",2,0)
 ;;3.0;BAR CODE MED ADMIN;;Mar 2004
"RTN","PSBRPCXM",3,0)
 ;
"RTN","PSBRPCXM",4,0)
RPC(RESULTS,PSBCMD,PSBDATA) ; Main RPC point
"RTN","PSBRPCXM",5,0)
 S RESULTS=$NA(^TMP("PSBMSG",$J)),^TMP("PSBMSG",$J,0)="-1^Unknown Error"
"RTN","PSBRPCXM",6,0)
 I PSBCMD="CREATE" K ^TMP("PSBMAIL",$J) S ^TMP($J,0)="1^Message '"_$J_"' created."
"RTN","PSBRPCXM",7,0)
 D:PSBCMD="APPEND"
"RTN","PSBRPCXM",8,0)
 .I $G(PSBDATA)]"" S Y=$O(^TMP("PSBMAIL",$J,"TEXT",""),-1)+1,^TMP("PSBMAIL",$J,"TEXT",Y,0)=PSBDATA
"RTN","PSBRPCXM",9,0)
 .S X="PSBDATA"
"RTN","PSBRPCXM",10,0)
 .F  S X=$Q(@X) Q:X=""  S Y=$O(^TMP("PSBMAIL",$J,"TEXT",""),-1)+1,^TMP("PSBMAIL",$J,"TEXT",Y,0)=@X
"RTN","PSBRPCXM",11,0)
 .S Y=+$O(^TMP("PSBMAIL",$J,"TEXT",""),-1)
"RTN","PSBRPCXM",12,0)
 .S ^TMP("PSBMAIL",$J,"TEXT",0)="^^"_Y
"RTN","PSBRPCXM",13,0)
 .S ^TMP($J,0)="1^Text appended."
"RTN","PSBRPCXM",14,0)
 I PSBCMD="SUBJECT" S ^TMP("PSBMAIL",$J,"SUBJECT")=PSBDATA,^TMP($J,0)="1^Message subject set to '"_PSBDATA_"'"
"RTN","PSBRPCXM",15,0)
 D:PSBCMD="SENDTO"
"RTN","PSBRPCXM",16,0)
 .I $G(PSBDATA)]"" S Y=$O(^TMP("PSBMAIL",$J,"SENDTO",""),-1)+1,^TMP("PSBMAIL",$J,"SENDTO",Y)=PSBDATA
"RTN","PSBRPCXM",17,0)
 .S X="PSBDATA"
"RTN","PSBRPCXM",18,0)
 .F  S X=$Q(@X) Q:X=""  S Y=$O(^TMP("PSBMAIL",$J,"SENDTO",""),-1)+1,^TMP("PSBMAIL",$J,"SENDTO",Y)=@X
"RTN","PSBRPCXM",19,0)
 .S ^TMP($J,0)="1^Recipients Added."
"RTN","PSBRPCXM",20,0)
 D:PSBCMD="EXECUTE"
"RTN","PSBRPCXM",21,0)
 .S XMSUB=$G(^TMP("PSBMAIL",$J,"SUBJECT"),"No subject")
"RTN","PSBRPCXM",22,0)
 .S XMTEXT="^TMP(""PSBMAIL"",$J,""TEXT"","
"RTN","PSBRPCXM",23,0)
 .F X=0:0 S X=$O(^TMP("PSBMAIL",$J,"SENDTO",X)) Q:'X  S XMY(^(X))=""
"RTN","PSBRPCXM",24,0)
 .D ^XMD
"RTN","PSBRPCXM",25,0)
 .S ^TMP($J,0)="1^Message Sent.  ID: "_+$G(XMZ)
"RTN","PSBRPCXM",26,0)
 Q
"RTN","PSBRPCXM",27,0)
 ;
"RTN","PSBSAGG")
0^45^B2908625
"RTN","PSBSAGG",1,0)
PSBSAGG ;BIRMINGHAM/EFC-BCMA TEMPORARY SAGG TYPE REPORTING ;Mar 2004
"RTN","PSBSAGG",2,0)
 ;;3.0;BAR CODE MED ADMIN;;Mar 2004
"RTN","PSBSAGG",3,0)
 ;
"RTN","PSBSAGG",4,0)
 ; Reference/IA
"RTN","PSBSAGG",5,0)
 ; WIN^DGPMDDCF/1246
"RTN","PSBSAGG",6,0)
 ; OPER^DGPMDDCF/1246
"RTN","PSBSAGG",7,0)
 ; ^XMB(1,1,"XUS")/10091
"RTN","PSBSAGG",8,0)
 ; File 4/10090
"RTN","PSBSAGG",9,0)
 ; ^DIC(42/10039 
"RTN","PSBSAGG",10,0)
EN ;
"RTN","PSBSAGG",11,0)
 N XMDUZ,XMY,XMSUB,XMTEXT,PSBEDS,PSBDT,PSB,PSBCNT,PSBWRD,D0,PSBSITE,PSBNUM
"RTN","PSBSAGG",12,0)
 S X1=DT,X2=-1*(+$E(DT,6,7)) D C^%DTC
"RTN","PSBSAGG",13,0)
 S PSBDT=$E(X,1,5),Y=PSBDT_"00" X ^DD("DD") S PSBDT(0)=Y
"RTN","PSBSAGG",14,0)
 S PSBNUM=$P(^XMB(1,1,"XUS"),U,17)
"RTN","PSBSAGG",15,0)
 S PSBSITE=$$GET1^DIQ(4,PSBNUM_",",.01)
"RTN","PSBSAGG",16,0)
 S PSBNUM=$$GET1^DIQ(4,PSBNUM_",",99)
"RTN","PSBSAGG",17,0)
 K ^TMP("PSBO",$J)
"RTN","PSBSAGG",18,0)
 S ^TMP("PSBO",$J,1)=PSBSITE_U_PSBNUM_U_PSBDT(0)
"RTN","PSBSAGG",19,0)
 F D0=0:0 S D0=$O(^DIC(42,D0)) Q:'D0  D
"RTN","PSBSAGG",20,0)
 .D WIN^DGPMDDCF Q:X  ; Inactive Ward
"RTN","PSBSAGG",21,0)
 .D OPER^DGPMDDCF S PSBEDS=X
"RTN","PSBSAGG",22,0)
 .Q:'PSBEDS  ; No operating beds
"RTN","PSBSAGG",23,0)
 .; Tally the med passes
"RTN","PSBSAGG",24,0)
 .S PSBWRD=$P(^DIC(42,D0,0),U)
"RTN","PSBSAGG",25,0)
 .S PSBCNT=0,PSB=PSBDT_"00"
"RTN","PSBSAGG",26,0)
 .F  S PSB=$O(^PSB("SAGG",PSBWRD,PSB)) Q:PSB=""!($P(PSB,PSBDT)]"")  D
"RTN","PSBSAGG",27,0)
 ..S PSBCNT=PSBCNT+^PSB("SAGG",PSBWRD,PSB)
"RTN","PSBSAGG",28,0)
 .; Add to the message
"RTN","PSBSAGG",29,0)
 .S Y=$O(^TMP("PSBO",$J,""),-1)+1
"RTN","PSBSAGG",30,0)
 .S ^TMP("PSBO",$J,Y)=PSBWRD_U_PSBEDS_U_PSBCNT
"RTN","PSBSAGG",31,0)
 S ^TMP("PSBO",$J,0)=+$O(^TMP("PSBO",$J,""),-1)
"RTN","PSBSAGG",32,0)
 S XMDUZ="BCMA"
"RTN","PSBSAGG",33,0)
 S XMSUB=PSBSITE_" ("_PSBDT(0)_") BCMA Med Pass Tally"
"RTN","PSBSAGG",34,0)
 ;
"RTN","PSBSAGG",35,0)
 ; Begin Patch PSB*1*2
"RTN","PSBSAGG",36,0)
 ; DP/Topeka 7-SEP-1999 12:12:49 
"RTN","PSBSAGG",37,0)
 ; Changed server name per request of SAGG Team
"RTN","PSBSAGG",38,0)
 S XMY("S.KMP90-BCMA-SERVER@ISC-ALBANY.VA.GOV")=""
"RTN","PSBSAGG",39,0)
 ; End Patch PSB*1*2
"RTN","PSBSAGG",40,0)
 ;
"RTN","PSBSAGG",41,0)
 S XMTEXT="^TMP(""PSBO"",$J,"
"RTN","PSBSAGG",42,0)
 D ^XMD
"RTN","PSBSAGG",43,0)
 Q
"RTN","PSBSAGG",44,0)
 ;
"RTN","PSBSVHL7")
0^46^B79888085
"RTN","PSBSVHL7",1,0)
PSBSVHL7 ;BIRMINGHAM/TEJ-BCMA HL7 SERVER ;Mar 2004
"RTN","PSBSVHL7",2,0)
 ;;3.0;BAR CODE MED ADMIN;;Mar 2004
"RTN","PSBSVHL7",3,0)
 ; Reference/IA
"RTN","PSBSVHL7",4,0)
 ; $$HLDATE^HLFNC/10106
"RTN","PSBSVHL7",5,0)
 ; $$HLNAME^HLFNC/10106
"RTN","PSBSVHL7",6,0)
 ; INIT^HLFNC2/2161
"RTN","PSBSVHL7",7,0)
 ; GENERATE^HLMA/2164
"RTN","PSBSVHL7",8,0)
 ; File 50/221
"RTN","PSBSVHL7",9,0)
 ; File 50.7/2880
"RTN","PSBSVHL7",10,0)
 ; File 52.6/436
"RTN","PSBSVHL7",11,0)
 ; File 52.7/437
"RTN","PSBSVHL7",12,0)
 ; File 200/10060
"RTN","PSBSVHL7",13,0)
 ; DEM^VADPT/10061
"RTN","PSBSVHL7",14,0)
 ;
"RTN","PSBSVHL7",15,0)
 ; Description:
"RTN","PSBSVHL7",16,0)
 ; This routine is to service BCMA HL7 messaging to other COTS and
"RTN","PSBSVHL7",17,0)
 ; VISTA application.
"RTN","PSBSVHL7",18,0)
 ; The entry point ("EN") is accessed via BCMA.  This routine
"RTN","PSBSVHL7",19,0)
 ; basically consists of subroutines to generate HL7 messages
"RTN","PSBSVHL7",20,0)
 ; per trigger events coresponding to BCMA transactions.  
"RTN","PSBSVHL7",21,0)
 ; These trigger events are captured within the routine PSBML.
"RTN","PSBSVHL7",22,0)
 ; PSBML passes the affected BCMA MEDICATION LOG File IEN and 
"RTN","PSBSVHL7",23,0)
 ; a variable capturing the BCMA activity as the input.
"RTN","PSBSVHL7",24,0)
 ;       Input  -        PSBIEN  Affected BCMA record(s)
"RTN","PSBSVHL7",25,0)
 ;                       PSBHL7X  BCMA trigger event/transaction
"RTN","PSBSVHL7",26,0)
 ;       Output -        HL7 broadcast to subscribing Applications 
"RTN","PSBSVHL7",27,0)
 ;
"RTN","PSBSVHL7",28,0)
EN(PSBIEN,PSBHL7X) ; This is the entry point for for all HL7 processing
"RTN","PSBSVHL7",29,0)
1 ; set up environment for message
"RTN","PSBSVHL7",30,0)
 N PSBHLFS,PSBHLCS
"RTN","PSBSVHL7",31,0)
 D INIT^HLFNC2("PSB BCMA RASO17 SRV",.HL)
"RTN","PSBSVHL7",32,0)
 I $G(HL) W:+HL'=16 !,"Error: "_$P(HL,2) Q  ; error occurred
"RTN","PSBSVHL7",33,0)
 S PSBHLFS=$G(HL("FS")) I PSBHLFS="" S PSBHLFS="^"
"RTN","PSBSVHL7",34,0)
 S PSBHLCS=$E(HL("ECH"),1)
"RTN","PSBSVHL7",35,0)
 S PSBHLSCS=$E(HL("ECH"),4)
"RTN","PSBSVHL7",36,0)
2 ; Add appropriate message txt to HLA array
"RTN","PSBSVHL7",37,0)
 K HLA,HLEVN
"RTN","PSBSVHL7",38,0)
 N PSBDFN,PSBHL7MS
"RTN","PSBSVHL7",39,0)
 S PSBCNT=0
"RTN","PSBSVHL7",40,0)
 I (PSBHL7X["MEDPASS")!(PSBHL7X["UPDATE STATUS") D MEDSTAT Q
"RTN","PSBSVHL7",41,0)
 I (PSBHL7X["ADD COMMENT") D COMMENT Q
"RTN","PSBSVHL7",42,0)
 I (PSBHL7X["PRN EFFECTI") D PRNEFFE Q
"RTN","PSBSVHL7",43,0)
 Q
"RTN","PSBSVHL7",44,0)
MEDSTAT ;MEDPASS and UPDATE trigger events 
"RTN","PSBSVHL7",45,0)
 D PID,PV1,ORC,RXO
"RTN","PSBSVHL7",46,0)
 D:$D(^PSB(53.79,PSBIEN,.3,0)) NTE
"RTN","PSBSVHL7",47,0)
 D RXR,RXC,RXA,TRANS  Q
"RTN","PSBSVHL7",48,0)
COMMENT ;ADD COMNMENT trigger event
"RTN","PSBSVHL7",49,0)
 D PID,ORC,NTE,TRANS  Q
"RTN","PSBSVHL7",50,0)
PRNEFFE ;PRN EFFECTIVENESS trigger event
"RTN","PSBSVHL7",51,0)
 D PID,ORC,NTE,TRANS  Q
"RTN","PSBSVHL7",52,0)
PID ; PID segment -- use segment generator
"RTN","PSBSVHL7",53,0)
 S PSBDFN=$P(^PSB(53.79,PSBIEN,0),U,1),DFN=PSBDFN D DEM^VADPT
"RTN","PSBSVHL7",54,0)
 S PSBCNT=PSBCNT+1,$P(PSBHL7MS,PSBHLFS,3)=PSBDFN
"RTN","PSBSVHL7",55,0)
 S $P(VADM(4),PSBHLCS)=VADM(4),$P(VADM(4),PSBHLCS,5)="AGE",$P(PSBHL7MS,PSBHLFS,4)=VADM(4)
"RTN","PSBSVHL7",56,0)
 S $P(PSBHL7MS,PSBHLFS,5)=$$HLNAME^HLFNC(VADM(1),HL("ECH"))
"RTN","PSBSVHL7",57,0)
 S $P(PSBHL7MS,PSBHLFS,7)=$$HLDATE^HLFNC(+VADM(3),"DT")
"RTN","PSBSVHL7",58,0)
 S $P(PSBHL7MS,PSBHLFS,19)=$P(VADM(2),"^")
"RTN","PSBSVHL7",59,0)
 S $P(PSBHL7MS,PSBHLFS,8)=$P(VADM(5),"^")
"RTN","PSBSVHL7",60,0)
 S HLA("HLS",PSBCNT)="PID"_PSBHLFS_PSBHL7MS
"RTN","PSBSVHL7",61,0)
 Q
"RTN","PSBSVHL7",62,0)
PV1 ; PV1 segment
"RTN","PSBSVHL7",63,0)
 K PSBHL7MS,PSBHL7FD
"RTN","PSBSVHL7",64,0)
 S PSBCNT=PSBCNT+1,HLA("HLS",PSBCNT)="PV1"_PSBHLFS
"RTN","PSBSVHL7",65,0)
 S $P(PSBHL7MS,PSBHLFS,2)="U"
"RTN","PSBSVHL7",66,0)
 ; Construct location field
"RTN","PSBSVHL7",67,0)
 S $P(PSBHL7FD,PSBHLCS,1)=$$ESC($P(^PSB(53.79,PSBIEN,0),U,2))
"RTN","PSBSVHL7",68,0)
 S $P(PSBHL7FD,PSBHLCS,4)=$$ESC($P(^PSB(53.79,PSBIEN,0),U,3))
"RTN","PSBSVHL7",69,0)
 S $P(PSBHL7MS,PSBHLFS,3)=PSBHL7FD K PSBHL7FD
"RTN","PSBSVHL7",70,0)
 ; Construct attending physician data
"RTN","PSBSVHL7",71,0)
 S $P(PSBHL7FD,PSBHLCS,1)=$P(^PSB(53.79,PSBIEN,0),U,5)
"RTN","PSBSVHL7",72,0)
 S $P(PSBHL7FD,PSBHLCS,2)=$$HLNAME^HLFNC($$GET1^DIQ(200,$P(PSBHL7FD,PSBHLCS,1)_",",.01),HL("ECH"))
"RTN","PSBSVHL7",73,0)
 S $P(PSBHL7MS,PSBHLFS,7)=PSBHL7FD K PSBHL7FD
"RTN","PSBSVHL7",74,0)
 S HLA("HLS",PSBCNT)=(HLA("HLS",PSBCNT))_PSBHL7MS
"RTN","PSBSVHL7",75,0)
 Q
"RTN","PSBSVHL7",76,0)
ORC ; ORC segment
"RTN","PSBSVHL7",77,0)
 K PSBHL7MS,PSBHL7FD
"RTN","PSBSVHL7",78,0)
 S PSBCNT=PSBCNT+1,HLA("HLS",PSBCNT)="ORC"_PSBHLFS
"RTN","PSBSVHL7",79,0)
 S $P(PSBHL7MS,PSBHLFS,1)="XX"
"RTN","PSBSVHL7",80,0)
 S $P(PSBHL7MS,PSBHLFS,2)=PSBIEN_PSBHLCS_"PSB"_PSBHLCS_PSBIEN_PSBHLCS_"IEN"
"RTN","PSBSVHL7",81,0)
 S $P(PSBHL7MS,PSBHLFS,3)=$P(^PSB(53.79,PSBIEN,.1),U)
"RTN","PSBSVHL7",82,0)
 D PSJ1^PSBVT(PSBDFN,$P(PSBHL7MS,PSBHLFS,3))
"RTN","PSBSVHL7",83,0)
 ; Construct quantity/time
"RTN","PSBSVHL7",84,0)
 S $P(PSBHL7FD,PSBHLCS,1)=$P(^PSB(53.79,PSBIEN,.1),U,5)
"RTN","PSBSVHL7",85,0)
 S $P(PSBHL7FD,PSBHLCS,2)=$$ESC(PSBSCH)
"RTN","PSBSVHL7",86,0)
 S $P(PSBHL7FD,PSBHLCS,4)=$$HLDATE^HLFNC($P(^PSB(53.79,PSBIEN,.1),U,3),"TS")
"RTN","PSBSVHL7",87,0)
 S $P(PSBHL7FD,PSBHLCS,10)=$$ESC(PSBSCHT)
"RTN","PSBSVHL7",88,0)
 S $P(PSBHL7MS,PSBHLFS,7)=PSBHL7FD K PSBHL7FD
"RTN","PSBSVHL7",89,0)
 ; Construct previous (parent) order data
"RTN","PSBSVHL7",90,0)
 S:$D(PSBPONX) $P(PSBHL7FD,PSBHLCS,2)=PSBPONX
"RTN","PSBSVHL7",91,0)
 S $P(PSBHL7MS,PSBHLFS,8)=$G(PSBHL7FD) K PSBHL7FD
"RTN","PSBSVHL7",92,0)
 S $P(PSBHL7MS,PSBHLFS,9)=$$HLDATE^HLFNC($P(^PSB(53.79,PSBIEN,0),U,6),"TS")
"RTN","PSBSVHL7",93,0)
 ; Construct entered by data
"RTN","PSBSVHL7",94,0)
 S $P(PSBHL7FD,PSBHLCS,1)=$P(^PSB(53.79,PSBIEN,0),U,5)
"RTN","PSBSVHL7",95,0)
 S $P(PSBHL7FD,PSBHLCS,2)=$$HLNAME^HLFNC($$GET1^DIQ(200,$P(PSBHL7FD,PSBHLCS,1)_",",.01),HL("ECH"))
"RTN","PSBSVHL7",96,0)
 S $P(PSBHL7MS,PSBHLFS,10)=PSBHL7FD K PSBHL7FD
"RTN","PSBSVHL7",97,0)
 S $P(PSBHL7MS,PSBHLFS,15)=$$HLDATE^HLFNC($P(^PSB(53.79,PSBIEN,0),U,4),"TS")
"RTN","PSBSVHL7",98,0)
 ; Construct action by data
"RTN","PSBSVHL7",99,0)
 S $P(PSBHL7FD,PSBHLCS,1)=$P(^PSB(53.79,PSBIEN,0),U,7)
"RTN","PSBSVHL7",100,0)
 S $P(PSBHL7FD,PSBHLCS,2)=$$HLNAME^HLFNC($$GET1^DIQ(200,$P(PSBHL7FD,PSBHLCS,1)_",",.01),HL("ECH"))
"RTN","PSBSVHL7",101,0)
 S $P(PSBHL7MS,PSBHLFS,19)=PSBHL7FD K PSBHL7FD
"RTN","PSBSVHL7",102,0)
 S HLA("HLS",PSBCNT)=(HLA("HLS",PSBCNT))_PSBHL7MS
"RTN","PSBSVHL7",103,0)
 Q
"RTN","PSBSVHL7",104,0)
RXO ; RXO segment
"RTN","PSBSVHL7",105,0)
 K PSBHL7MS,PSBHL7FD
"RTN","PSBSVHL7",106,0)
 S PSBCNT=PSBCNT+1,HLA("HLS",PSBCNT)="RXO"_PSBHLFS
"RTN","PSBSVHL7",107,0)
 ; Construct rq give code data
"RTN","PSBSVHL7",108,0)
 S $P(PSBHL7FD,PSBHLCS,1)=$P(^PSB(53.79,PSBIEN,0),U,8)
"RTN","PSBSVHL7",109,0)
 S $P(PSBHL7FD,PSBHLCS,2)=$$GET1^DIQ(50.7,$P(PSBHL7FD,PSBHLCS,1)_",",.01)
"RTN","PSBSVHL7",110,0)
 S $P(PSBHL7MS,PSBHLFS,1)=PSBHL7FD K PSBHL7FD
"RTN","PSBSVHL7",111,0)
 S $P(PSBHL7MS,PSBHLFS,2)=$$ESC($P(^PSB(53.79,PSBIEN,.1),U,5))
"RTN","PSBSVHL7",112,0)
 S $P(PSBHL7MS,PSBHLFS,10)=$$ESC($P(^PSB(53.79,PSBIEN,0),U,10))
"RTN","PSBSVHL7",113,0)
 S $P(PSBHL7FD,PSBHLCS,2)=$$ESC($P(^PSB(53.79,PSBIEN,0),U,11))
"RTN","PSBSVHL7",114,0)
 S $P(PSBHL7MS,PSBHLFS,21)=PSBHL7FD
"RTN","PSBSVHL7",115,0)
 S HLA("HLS",PSBCNT)=(HLA("HLS",PSBCNT))_PSBHL7MS
"RTN","PSBSVHL7",116,0)
 Q
"RTN","PSBSVHL7",117,0)
NTE ; NTE segment(s) - notes and comments
"RTN","PSBSVHL7",118,0)
 K PSBHL7MS,PSBHL7FD
"RTN","PSBSVHL7",119,0)
 S PSBCNT=PSBCNT+1,HLA("HLS",PSBCNT)="NTE"_PSBHLFS
"RTN","PSBSVHL7",120,0)
 S $P(PSBHL7MS,PSBHLFS,2)="O"
"RTN","PSBSVHL7",121,0)
 ; Construct comment and comment type
"RTN","PSBSVHL7",122,0)
 D:($G(PSBSCHT)="P")&($D(^PSB(53.79,PSBIEN,.2)))&(PSBHL7X["PRN EFF")
"RTN","PSBSVHL7",123,0)
 .S $P(PSBHL7MS,PSBHLFS,3)=$$ESC($P(^PSB(53.79,PSBIEN,.2),U,2))
"RTN","PSBSVHL7",124,0)
 .S $P(PSBHL7FD,PSBHLCS,1)=$P(^PSB(53.79,PSBIEN,.2),U,3)
"RTN","PSBSVHL7",125,0)
 .S $P(PSBHL7FD,PSBHLCS,2)=$$HLNAME^HLFNC($$GET1^DIQ(200,$P(PSBHL7FD,PSBHLCS,1)_",",.01),HL("ECH"))
"RTN","PSBSVHL7",126,0)
 .S $P(PSBHL7FD,PSBHLCS,4)=$$HLDATE^HLFNC($P(^PSB(53.79,PSBIEN,.2),U,4),"TS")
"RTN","PSBSVHL7",127,0)
 .S $P(PSBHL7FD,PSBHLCS,5)="Date Entered"
"RTN","PSBSVHL7",128,0)
 .S $P(PSBHL7FD,PSBHLCS,7)=$P(^PSB(53.79,PSBIEN,.2),U,5)
"RTN","PSBSVHL7",129,0)
 .S $P(PSBHL7FD,PSBHLCS,8)="PRN Minutes"
"RTN","PSBSVHL7",130,0)
 .S $P(PSBHL7MS,PSBHLFS,4)=PSBHL7FD K PSBHL7FD
"RTN","PSBSVHL7",131,0)
 D:$D(^PSB(53.79,PSBIEN,.3,0))&(PSBHL7X'["PRN EFF")
"RTN","PSBSVHL7",132,0)
 .S PSBINDX="",PSBINDX=$O(^PSB(53.79,PSBIEN,.3,PSBINDX),-1)
"RTN","PSBSVHL7",133,0)
 .S $P(PSBHL7MS,PSBHLFS,3)=PSBINDX_PSBHLCS_$$ESC($P(^PSB(53.79,PSBIEN,.3,PSBINDX,0),U))
"RTN","PSBSVHL7",134,0)
 .S $P(PSBHL7FD,PSBHLCS,1)=$P(^PSB(53.79,PSBIEN,.3,PSBINDX,0),U,2)
"RTN","PSBSVHL7",135,0)
 .S $P(PSBHL7FD,PSBHLCS,2)=$$HLNAME^HLFNC($$GET1^DIQ(200,$P(PSBHL7FD,PSBHLCS,1)_",",.01),HL("ECH"))
"RTN","PSBSVHL7",136,0)
 .S $P(PSBHL7FD,PSBHLCS,4)=$$HLDATE^HLFNC($P(^PSB(53.79,PSBIEN,.3,PSBINDX,0),U,3),"TS")
"RTN","PSBSVHL7",137,0)
 .S $P(PSBHL7FD,PSBHLCS,5)="Date Entered"
"RTN","PSBSVHL7",138,0)
 .S $P(PSBHL7MS,PSBHLFS,4)=PSBHL7FD K PSBHL7FD
"RTN","PSBSVHL7",139,0)
 S HLA("HLS",PSBCNT)=(HLA("HLS",PSBCNT))_PSBHL7MS
"RTN","PSBSVHL7",140,0)
 Q
"RTN","PSBSVHL7",141,0)
RXR ; RXR segment
"RTN","PSBSVHL7",142,0)
 K PSBHL7MS,PSBHL7FD
"RTN","PSBSVHL7",143,0)
 S PSBCNT=PSBCNT+1,HLA("HLS",PSBCNT)="RXR"_PSBHLFS
"RTN","PSBSVHL7",144,0)
 S:$D(PSBMRAB) $P(PSBHL7MS,PSBHLFS,1)=PSBMRAB
"RTN","PSBSVHL7",145,0)
 S $P(PSBHL7MS,PSBHLFS,2)=$P($G(^PSB(53.79,PSBIEN,.1)),U,6)
"RTN","PSBSVHL7",146,0)
 S HLA("HLS",PSBCNT)=(HLA("HLS",PSBCNT))_PSBHL7MS
"RTN","PSBSVHL7",147,0)
 S:""=$TR(PSBHL7MS,PSBHLFS,"") PSBCNT=PSBCNT-1
"RTN","PSBSVHL7",148,0)
 Q
"RTN","PSBSVHL7",149,0)
RXC ; RXC segment
"RTN","PSBSVHL7",150,0)
 ; loop through .5,.6,and .7  send segments for each "component"
"RTN","PSBSVHL7",151,0)
 K PSBSUBFD F PSBSUBFD=".5",".6",".7" D:$D(^PSB(53.79,PSBIEN,PSBSUBFD,1))
"RTN","PSBSVHL7",152,0)
 .K PSBFILE S PSBFILE=$S(PSBSUBFD=".5":"^PSDRUG(",PSBSUBFD=".6":"^PS(52.6,",PSBSUBFD=".7":"^PS(52.7,")
"RTN","PSBSVHL7",153,0)
 .K PSBRXTYP S PSBRXTYP=$S(PSBSUBFD=".5":"B",PSBSUBFD=".6":"A",PSBSUBFD=".7":"B")
"RTN","PSBSVHL7",154,0)
 .S PSBSUBX=0 F  S PSBSUBX=$O(^PSB(53.79,PSBIEN,PSBSUBFD,PSBSUBX)) Q:+PSBSUBX=0  D
"RTN","PSBSVHL7",155,0)
 ..K PSBHL7MS,PSBHL7FD S PSBCNT=PSBCNT+1,HLA("HLS",PSBCNT)="RXC"_PSBHLFS
"RTN","PSBSVHL7",156,0)
 ..S $P(PSBHL7MS,PSBHLFS,1)=PSBRXTYP
"RTN","PSBSVHL7",157,0)
 ..; Construct component code data
"RTN","PSBSVHL7",158,0)
 ..S $P(PSBHL7FD,PSBHLCS,1)=$P(^PSB(53.79,PSBIEN,PSBSUBFD,PSBSUBX,0),U)
"RTN","PSBSVHL7",159,0)
 ..S PSBFILE1=PSBFILE_$P(^PSB(53.79,PSBIEN,PSBSUBFD,PSBSUBX,0),U)_",0)"
"RTN","PSBSVHL7",160,0)
 ..I $P(^PSB(53.79,PSBIEN,PSBSUBFD,PSBSUBX,0),U)]"" S $P(PSBHL7FD,PSBHLCS,2)=$P($G(@PSBFILE1),U) K PSBFILE1
"RTN","PSBSVHL7",161,0)
 ..I $G(PSBHL7FD)]"" S $P(PSBHL7MS,PSBHLFS,2)=PSBHL7FD,PSBRXAX=PSBHL7FD,PSBRXA(PSBRXAX)="RXA ADMIN CODE" K PSBHL7FD
"RTN","PSBSVHL7",162,0)
 ..S $P(PSBHL7MS,PSBHLFS,3)=$P(^PSB(53.79,PSBIEN,PSBSUBFD,PSBSUBX,0),U,2)
"RTN","PSBSVHL7",163,0)
 ..S $P(PSBHL7MS,PSBHLFS,4)=$P(^PSB(53.79,PSBIEN,PSBSUBFD,PSBSUBX,0),U,4)
"RTN","PSBSVHL7",164,0)
 ..I $G(PSBRXAX)]"" S PSBRXA(PSBRXAX)=$P(^PSB(53.79,PSBIEN,PSBSUBFD,PSBSUBX,0),U,3)_U_$P(PSBHL7MS,PSBHLFS,4)
"RTN","PSBSVHL7",165,0)
 ..S HLA("HLS",PSBCNT)=(HLA("HLS",PSBCNT))_PSBHL7MS
"RTN","PSBSVHL7",166,0)
 Q
"RTN","PSBSVHL7",167,0)
RXA ; RXA segment
"RTN","PSBSVHL7",168,0)
 K PSBHL7MS,PSBHL7FD S PSBRXAX=""
"RTN","PSBSVHL7",169,0)
 F PSBRX=1:1 S PSBRXAX=$O(PSBRXA(PSBRXAX)) Q:PSBRXAX=""  D
"RTN","PSBSVHL7",170,0)
 .S PSBCNT=PSBCNT+1,HLA("HLS",PSBCNT)="RXA"_PSBHLFS
"RTN","PSBSVHL7",171,0)
 .S $P(PSBHL7MS,PSBHLFS,1)=0
"RTN","PSBSVHL7",172,0)
 .S $P(PSBHL7MS,PSBHLFS,2)=PSBRX
"RTN","PSBSVHL7",173,0)
 .S $P(PSBHL7MS,PSBHLFS,3)=$$HLDATE^HLFNC($P(^PSB(53.79,PSBIEN,0),U,6),"TS")
"RTN","PSBSVHL7",174,0)
 .S $P(PSBHL7MS,PSBHLFS,4)=" "
"RTN","PSBSVHL7",175,0)
 .; Construct administered code data
"RTN","PSBSVHL7",176,0)
 .S $P(PSBHL7MS,PSBHLFS,5)=PSBRXAX
"RTN","PSBSVHL7",177,0)
 .S $P(PSBHL7MS,PSBHLFS,6)=$P(PSBRXA(PSBRXAX),U)
"RTN","PSBSVHL7",178,0)
 .S $P(PSBHL7MS,PSBHLFS,7)=$P(PSBRXA(PSBRXAX),U,2)
"RTN","PSBSVHL7",179,0)
 .D:$D(^PSB(53.79,PSBIEN,.9,1))
"RTN","PSBSVHL7",180,0)
 ..S PSBINDX=$O(^PSB(53.79,PSBIEN,.9,""),-1)
"RTN","PSBSVHL7",181,0)
 ..S:$D(PSBINDX) $P(PSBHL7MS,PSBHLFS,9)=PSBINDX_PSBHLCS_$$HLDATE^HLFNC($P(^PSB(53.79,PSBIEN,.9,PSBINDX,0),U),"TS")
"RTN","PSBSVHL7",182,0)
 .; "PRN reason"
"RTN","PSBSVHL7",183,0)
 .S:($G(PSBSCHT)="P")&($D(^PSB(53.79,PSBIEN,.2))) $P(PSBHL7FD,PSBHLCS,2)=$P(^PSB(53.79,PSBIEN,.2),U,1)
"RTN","PSBSVHL7",184,0)
 .S $P(PSBHL7MS,PSBHLFS,18)=$G(PSBHL7FD) K PSBHL7FD
"RTN","PSBSVHL7",185,0)
 .; Construct indication - "variance"
"RTN","PSBSVHL7",186,0)
 .S $P(PSBHL7FD,PSBHLCS,2)=$P(^PSB(53.79,PSBIEN,.1),U,4)
"RTN","PSBSVHL7",187,0)
 .S $P(PSBHL7MS,PSBHLFS,19)=PSBHL7FD K PSBHL7FD
"RTN","PSBSVHL7",188,0)
 .S $P(PSBHL7MS,PSBHLFS,20)=$P(^PSB(53.79,PSBIEN,0),U,9)
"RTN","PSBSVHL7",189,0)
 .S HLA("HLS",PSBCNT)=(HLA("HLS",PSBCNT))_PSBHL7MS
"RTN","PSBSVHL7",190,0)
 K PSBRX,PSBRXA,PSBRXAX
"RTN","PSBSVHL7",191,0)
 Q
"RTN","PSBSVHL7",192,0)
ESC(PSBINF) ; Escape message data
"RTN","PSBSVHL7",193,0)
 S PSBINFO=PSBINF K PSBESC,PSBINFO1 F PSBESCX=1:1:4 D
"RTN","PSBSVHL7",194,0)
 .S PSBCHR=$E(HL("ECH"),PSBESCX)
"RTN","PSBSVHL7",195,0)
 .I ($L(PSBINFO,PSBCHR)-1)>0 S PSBINFO1=PSBINFO F PSBESCXX=1:1:$L(PSBINFO,PSBCHR)-1 D
"RTN","PSBSVHL7",196,0)
 ..S PSBESC($F(PSBINFO1,PSBCHR)-1)=$E(HL("ECH"),3)_$E("SRET",PSBESCX)_$E(HL("ECH"),3)
"RTN","PSBSVHL7",197,0)
 ..S PSBINFO1=$E(PSBINFO1,1,$F(PSBINFO1,PSBCHR)-2)_U_$E(PSBINFO1,$F(PSBINFO1,PSBCHR),250)
"RTN","PSBSVHL7",198,0)
 S:$D(PSBINFO1) PSBINFO=PSBINFO1
"RTN","PSBSVHL7",199,0)
 S (PSBCNT1,PSBESCX,PSBESCXX)=0 F  S PSBESCX=$O(PSBESC(PSBESCX)) Q:PSBESCX=""  D
"RTN","PSBSVHL7",200,0)
 .S PSBESCXX=PSBESCX+PSBCNT1,PSBINFO=$E(PSBINFO,1,PSBESCXX-1)_$G(PSBESC(PSBESCX))_$E(PSBINFO,PSBESCXX+1,250),PSBCNT1=PSBCNT1+2
"RTN","PSBSVHL7",201,0)
 Q PSBINFO
"RTN","PSBSVHL7",202,0)
 ;
"RTN","PSBSVHL7",203,0)
TRANS ; CALL HL7 TO Transmit Message
"RTN","PSBSVHL7",204,0)
 K PSBHL7MS,PSBHL7FD
"RTN","PSBSVHL7",205,0)
 D:$D(HLA("HLS")) GENERATE^HLMA("PSB BCMA RASO17 SRV","LM",1,.PSBHL7T,"",.PSBHL7OP)
"RTN","PSBSVHL7",206,0)
 I +$P(PSBHL7T,U,2) W !,"PSB(BCMA) HL7 MESSAGE HAS FAILED TRANSMISSION - could not generate"
"RTN","PSBSVHL7",207,0)
 Q
"RTN","PSBSVHL7",208,0)
 ;
"RTN","PSBUTL")
0^47^B55203517
"RTN","PSBUTL",1,0)
PSBUTL ;BIRMINGHAM/EFC-BCMA UTILITIES ;Mar 2004
"RTN","PSBUTL",2,0)
 ;;3.0;BAR CODE MED ADMIN;;Mar 2004
"RTN","PSBUTL",3,0)
 ; 
"RTN","PSBUTL",4,0)
 ; Reference/IA
"RTN","PSBUTL",5,0)
 ; $$PATCH & $$VERSION^XPDUTL/10141
"RTN","PSBUTL",6,0)
 ; File 50/221
"RTN","PSBUTL",7,0)
 ; File 200/10060
"RTN","PSBUTL",8,0)
 ;
"RTN","PSBUTL",9,0)
 ;
"RTN","PSBUTL",10,0)
DIWP(X,Y,PSB,PSBARGN) ; 
"RTN","PSBUTL",11,0)
 K ^UTILITY($J,"W")
"RTN","PSBUTL",12,0)
 S DIWL=0,DIWR=Y,DIWF="C"_Y D ^DIWP
"RTN","PSBUTL",13,0)
 F X=0:0 S X=$O(^UTILITY($J,"W",0,X)) Q:'X  D
"RTN","PSBUTL",14,0)
 .S Y=$O(@PSB@(""),-1)+1
"RTN","PSBUTL",15,0)
 .; Naked Reference below is from two lines above ^UTILITY($J,"W",0,X)
"RTN","PSBUTL",16,0)
 .S @PSB@(Y)=$J("",+$G(PSBARGN))_^(X,0)
"RTN","PSBUTL",17,0)
 S @PSB@(0)=+$O(@PSB@(""),-1)
"RTN","PSBUTL",18,0)
 K ^UTILITY($J,"W"),DIWL,DIWR,DIWF
"RTN","PSBUTL",19,0)
 Q
"RTN","PSBUTL",20,0)
 ;
"RTN","PSBUTL",21,0)
SATURDAY(X,PSBDISP) ; 
"RTN","PSBUTL",22,0)
 S X=X\1 D H^%DTC ; Convert to $H style
"RTN","PSBUTL",23,0)
 S %H=%H+(6-%Y) ;   Set it forward to Saturday
"RTN","PSBUTL",24,0)
 D YMD^%DTC ;       Back to FM Format
"RTN","PSBUTL",25,0)
 I $G(PSBDISP) S PSBDISP=$E(X,4,5)_"/"_$E(X,6,7)_"/"_(1700+$E(X,1,3)) D EN^DDIOL("Actual date is Saturday "_PSBDISP)
"RTN","PSBUTL",26,0)
 Q X
"RTN","PSBUTL",27,0)
 ;
"RTN","PSBUTL",28,0)
SUNDAY(X,PSBDISP) ; 
"RTN","PSBUTL",29,0)
 S X=X\1 D H^%DTC ; Convert to $H style
"RTN","PSBUTL",30,0)
 S %H=%H-%Y ;       Set it back to Sunday
"RTN","PSBUTL",31,0)
 D YMD^%DTC ;       Back to FM Format
"RTN","PSBUTL",32,0)
 I $G(PSBDISP) S PSBDISP=$E(X,4,5)_"/"_$E(X,6,7)_"/"_(1700+$E(X,1,3)) D EN^DDIOL("Actual date is Sunday "_PSBDISP)
"RTN","PSBUTL",33,0)
 Q X
"RTN","PSBUTL",34,0)
 ;
"RTN","PSBUTL",35,0)
CLOCK(RESULTS,X) ; Verify Client/Server Date/Times are close enough
"RTN","PSBUTL",36,0)
 ;
"RTN","PSBUTL",37,0)
 ; RPC: PSB SERVER CLOCK VARIANCE
"RTN","PSBUTL",38,0)
 ;
"RTN","PSBUTL",39,0)
 ; Description:
"RTN","PSBUTL",40,0)
 ; Returns the variance from the server to the client in minutes
"RTN","PSBUTL",41,0)
 ;
"RTN","PSBUTL",42,0)
 N PSBCLNT,PSBSRVR,PSBDIFF
"RTN","PSBUTL",43,0)
 S %DT="RS" D ^%DT S PSBCLNT=Y
"RTN","PSBUTL",44,0)
 D NOW^%DTC S PSBSRVR=%
"RTN","PSBUTL",45,0)
 S PSBDIFF=$$DIFF(PSBSRVR,PSBCLNT)
"RTN","PSBUTL",46,0)
 S X=$$GET^XPAR("DIV","PSB SERVER CLOCK VARIANCE")
"RTN","PSBUTL",47,0)
 I PSBDIFF>X!(PSBDIFF<(X*-1)) S RESULTS(0)="-1^"_PSBDIFF
"RTN","PSBUTL",48,0)
 E  S RESULTS(0)="1^"_PSBDIFF
"RTN","PSBUTL",49,0)
 Q
"RTN","PSBUTL",50,0)
 ;
"RTN","PSBUTL",51,0)
DIFF(X,X1) ; Difference in minutes between 2 FM dates
"RTN","PSBUTL",52,0)
 ; Code copied from Fileman Function MINUTES
"RTN","PSBUTL",53,0)
 S Y=$E(X1_"000",9,10)-$E(X_"000",9,10)*60+$E(X1_"00000",11,12)-$E(X_"00000",11,12),X2=X,X=$P(X,".",1)'=$P(X1,".",1) D ^%DTC:X S X=X*1440+Y
"RTN","PSBUTL",54,0)
 Q X
"RTN","PSBUTL",55,0)
 ;
"RTN","PSBUTL",56,0)
DRUGINQ ; Drug File Inquiry
"RTN","PSBUTL",57,0)
 N PSBRET,PSBIEN,DIC,DIR,IOINORM,IOINHI
"RTN","PSBUTL",58,0)
 S X="IOINHI;IOINORM" D ENDR^%ZISS
"RTN","PSBUTL",59,0)
 S X=$TR(X,"abcdefghijklmnopqrstuvwxyz","ABCDEFGHIJKLMNOPQRSTUVWXYZ")
"RTN","PSBUTL",60,0)
 S DIC="^PSDRUG(",DIC(0)="AEQMVTN",DIC("T")="",D="B^C^VAPN^VAC^NDC^XATC",DIC("A")="Select DRUG: "
"RTN","PSBUTL",61,0)
 ; Display active drugs and those for appl packages IV and Unit Dose
"RTN","PSBUTL",62,0)
 S DIC("S")="I '$G(^PSDRUG(+Y,""I""))!($G(^(""I""))>DT),$P($G(^PSDRUG(+Y,2)),U,3)[""I""!($P($G(^PSDRUG(+Y,2)),U,3)[""U"")"
"RTN","PSBUTL",63,0)
 F  W @IOF,!,"DRUG FILE INQUIRY",! D ^DIC  Q:+Y<1  D
"RTN","PSBUTL",64,0)
 .K PSBRET
"RTN","PSBUTL",65,0)
 .S PSBIEN=+Y_","
"RTN","PSBUTL",66,0)
 .D GETS^DIQ(50,PSBIEN,".01;16;25;51;215;213;101;9*","","PSBRET")
"RTN","PSBUTL",67,0)
 .W @IOF,!,"DRUG NAME: ",IOINHI,PSBRET(50,PSBIEN,.01)
"RTN","PSBUTL",68,0)
 .W "  (IEN: ",+PSBIEN,")",IOINORM,!,$TR($J("",IOM)," ","-"),!
"RTN","PSBUTL",69,0)
 .F X=16,25,51,215,213,101 D
"RTN","PSBUTL",70,0)
 ..D FIELD^DID(50,X,"","LABEL","PSBRET")
"RTN","PSBUTL",71,0)
 ..W !,PSBRET("LABEL"),":",?30,IOINHI
"RTN","PSBUTL",72,0)
 ..D:$L(PSBRET(50,PSBIEN,X))>49
"RTN","PSBUTL",73,0)
 ...F Y=1:1 Q:$L($P(PSBRET(50,PSBIEN,X)," ",1,Y))>49
"RTN","PSBUTL",74,0)
 ...W $P(PSBRET(50,PSBIEN,X)," ",1,Y-1),!?30
"RTN","PSBUTL",75,0)
 ...S PSBRET(50,PSBIEN,X)=$P(PSBRET(50,PSBIEN,X)," ",Y,250)
"RTN","PSBUTL",76,0)
 ..W ?30,PSBRET(50,PSBIEN,X),IOINORM
"RTN","PSBUTL",77,0)
 .W !!,"SYNONYMS:",IOINHI,!?15
"RTN","PSBUTL",78,0)
 .S X="" F  S X=$O(PSBRET(50.1,X)) Q:X=""  W:$X>40 !?15 W:$X>15 ?40 W PSBRET(50.1,X,.01)
"RTN","PSBUTL",79,0)
 .W IOINORM
"RTN","PSBUTL",80,0)
 .F  Q:$Y>(IOSL-3)  W !
"RTN","PSBUTL",81,0)
 .S DIR(0)="E" D ^DIR
"RTN","PSBUTL",82,0)
 Q
"RTN","PSBUTL",83,0)
 ;
"RTN","PSBUTL",84,0)
DPTSET ; Set Logic for pt-merge x-ref on patient field in file 53.79
"RTN","PSBUTL",85,0)
 ;
"RTN","PSBUTL",86,0)
 ; Entered Date/Time
"RTN","PSBUTL",87,0)
 I $P(^PSB(53.79,DA,0),U,4) S ^PSB(53.79,"AEDT",X,$P(^PSB(53.79,DA,0),U,4),DA)=""
"RTN","PSBUTL",88,0)
 ;
"RTN","PSBUTL",89,0)
 ; Administration Date/Time
"RTN","PSBUTL",90,0)
 D:$P(^PSB(53.79,DA,0),U,6)
"RTN","PSBUTL",91,0)
 .S ^PSB(53.79,"AADT",X,$P(^PSB(53.79,DA,0),U,6),DA)=""
"RTN","PSBUTL",92,0)
 .;
"RTN","PSBUTL",93,0)
 .; Orderable Item + Administration Date/Time
"RTN","PSBUTL",94,0)
 .I $P(^PSB(53.79,DA,0),U,8) S ^PSB(53.79,"AOIP",X,$P(^PSB(53.79,DA,0),U,8),$P(^PSB(53.79,DA,0),U,6),DA)=""
"RTN","PSBUTL",95,0)
 ;
"RTN","PSBUTL",96,0)
 ; PRN's by entered date/time
"RTN","PSBUTL",97,0)
 I $P($G(^PSB(53.79,DA,.1)),U,2)="P"&($P(^(0),U,4)) S ^PSB(53.79,"APRN",X,$P(^PSB(53.79,DA,0),U,4),DA)=""
"RTN","PSBUTL",98,0)
 ;
"RTN","PSBUTL",99,0)
 ; Order+Administration Date and Time
"RTN","PSBUTL",100,0)
 I $P($G(^PSB(53.79,DA,.1)),U)]""&($P($G(^PSB(53.79,DA,.1)),U,3)) S ^PSB(53.79,"AORD",X,$P(^PSB(53.79,DA,.1),U),$P(^PSB(53.79,DA,.1),U,3),DA)=""
"RTN","PSBUTL",101,0)
 Q
"RTN","PSBUTL",102,0)
 ;
"RTN","PSBUTL",103,0)
DPTKILL ; Kill Logic for pt-merge x-ref on patient field in file 53.79
"RTN","PSBUTL",104,0)
 ;
"RTN","PSBUTL",105,0)
 ; Entered Date/Time
"RTN","PSBUTL",106,0)
 I $P(^PSB(53.79,DA,0),U,4) K ^PSB(53.79,"AEDT",X,$P(^PSB(53.79,DA,0),U,4),DA)
"RTN","PSBUTL",107,0)
 ;
"RTN","PSBUTL",108,0)
 ; Administration Date/Time
"RTN","PSBUTL",109,0)
 D:$P(^PSB(53.79,DA,0),U,6)
"RTN","PSBUTL",110,0)
 .K ^PSB(53.79,"AADT",X,$P(^PSB(53.79,DA,0),U,6),DA)
"RTN","PSBUTL",111,0)
 .;
"RTN","PSBUTL",112,0)
 .; Orderable Item + Administration Date/Time
"RTN","PSBUTL",113,0)
 .I $P(^PSB(53.79,DA,0),U,8) K ^PSB(53.79,"AOIP",X,$P(^PSB(53.79,DA,0),U,8),$P(^PSB(53.79,DA,0),U,6),DA)
"RTN","PSBUTL",114,0)
 ;
"RTN","PSBUTL",115,0)
 ; PRN's by entered date/time
"RTN","PSBUTL",116,0)
 I $P($G(^PSB(53.79,DA,.1)),U,2)="P"&($P(^(0),U,4)) K ^PSB(53.79,"APRN",X,$P(^PSB(53.79,DA,0),U,4),DA)
"RTN","PSBUTL",117,0)
 ;
"RTN","PSBUTL",118,0)
 ; Order+Administration Date and Time
"RTN","PSBUTL",119,0)
 I $P($G(^PSB(53.79,DA,.1)),U)]""&($P($G(^PSB(53.79,DA,.1)),U,3)) K ^PSB(53.79,"AORD",X,$P(^PSB(53.79,DA,.1),U),$P(^PSB(53.79,DA,.1),U,3),DA)
"RTN","PSBUTL",120,0)
 Q
"RTN","PSBUTL",121,0)
 ;
"RTN","PSBUTL",122,0)
TIMEIN ;
"RTN","PSBUTL",123,0)
 X ^%ZOSF("UPPERCASE") S X=Y
"RTN","PSBUTL",124,0)
 I X="NOON" S X=.12 Q
"RTN","PSBUTL",125,0)
 I X="MID" S X=.24 Q
"RTN","PSBUTL",126,0)
 I (X="NOW")!(X="N") D NOW^%DTC S X=$E($P(%,".",2)_"0000",1,4)
"RTN","PSBUTL",127,0)
 S X="T@"_X,%DT="R" D ^%DT
"RTN","PSBUTL",128,0)
 I Y<1 K X Q
"RTN","PSBUTL",129,0)
 S X=Y-DT
"RTN","PSBUTL",130,0)
 Q
"RTN","PSBUTL",131,0)
 ;
"RTN","PSBUTL",132,0)
TIMEOUT(X) ; 
"RTN","PSBUTL",133,0)
 N HOUR,MIN,AMPM
"RTN","PSBUTL",134,0)
 S X=$E($P(X,".",2)_"0000",1,4)
"RTN","PSBUTL",135,0)
 I X="2400" Q "12:00m"
"RTN","PSBUTL",136,0)
 I X="1200" Q "12:00n"
"RTN","PSBUTL",137,0)
 S HOUR=+$E(X,1,2),MIN=$E(X,3,4)
"RTN","PSBUTL",138,0)
 S AMPM="a"
"RTN","PSBUTL",139,0)
 S AMPM=$S(HOUR<12:"a",HOUR>11:"p",1:"**")
"RTN","PSBUTL",140,0)
 S:HOUR>12 HOUR=HOUR-12
"RTN","PSBUTL",141,0)
 Q HOUR_":"_MIN_AMPM
"RTN","PSBUTL",142,0)
 ;
"RTN","PSBUTL",143,0)
HFSOPEN(HANDLE) ; 
"RTN","PSBUTL",144,0)
 N PSBDIR,PSBFILE
"RTN","PSBUTL",145,0)
 S PSBDIR=$$GET^XPAR("DIV","PSB HFS SCRATCH")
"RTN","PSBUTL",146,0)
 S PSBFILE="PSB"_DUZ_".DAT"
"RTN","PSBUTL",147,0)
 D OPEN^%ZISH(HANDLE,PSBDIR,PSBFILE,"W") Q:POP
"RTN","PSBUTL",148,0)
 S IOM=132,IOSL=99999,IOST="P-DUMMY",IOF=""""""
"RTN","PSBUTL",149,0)
 Q
"RTN","PSBUTL",150,0)
 ;
"RTN","PSBUTL",151,0)
HFSCLOSE(HANDLE) ; 
"RTN","PSBUTL",152,0)
 N PSBDIR,PSBFILE,PSBDEL
"RTN","PSBUTL",153,0)
 D CLOSE^%ZISH(HANDLE)
"RTN","PSBUTL",154,0)
 K ^TMP("PSBO",$J)
"RTN","PSBUTL",155,0)
 S PSBDIR=$$GET^XPAR("DIV","PSB HFS SCRATCH")
"RTN","PSBUTL",156,0)
 S PSBFILE="PSB"_DUZ_".DAT",PSBDEL(PSBFILE)=""
"RTN","PSBUTL",157,0)
 S X=$$FTG^%ZISH(PSBDIR,PSBFILE,$NAME(^TMP("PSBO",$J,2)),3)
"RTN","PSBUTL",158,0)
 S X=$$DEL^%ZISH(PSBDIR,$NA(PSBDEL))
"RTN","PSBUTL",159,0)
 Q
"RTN","PSBUTL",160,0)
 ;
"RTN","PSBUTL",161,0)
AUDIT(PSBREC,PSBDD,PSBFLD,PSBDATA,PSBSK) ; Med Log Audit
"RTN","PSBUTL",162,0)
 ; used by cross references to 53.79 to track changes to fields in Med Log file
"RTN","PSBUTL",163,0)
 ; xref AU05, AU06, AU09, AU16, AU21, AU22 pass the value 53.79 as PSBDD
"RTN","PSBUTL",164,0)
 ; xref AU303, AU304 pass the value 53.795 as PSBDD
"RTN","PSBUTL",165,0)
 ; xref AU603, AU604 pass the value 53.796 as PSBDD
"RTN","PSBUTL",166,0)
 ; xref AU703, AU704 pass the value 53.797 as PSBDD
"RTN","PSBUTL",167,0)
 ;
"RTN","PSBUTL",168,0)
 N PSBDT,PSBTMP
"RTN","PSBUTL",169,0)
 Q:$G(PSBDATA)=""!('$G(PSBAUDIT))
"RTN","PSBUTL",170,0)
 D NOW^%DTC S PSBDT=%
"RTN","PSBUTL",171,0)
 S PSBDATA=$$EXTERNAL^DILFD(PSBDD,PSBFLD,"",PSBDATA)  ; PSBDD=53.79, 53.795, 53.796, or 53.797 see comment at tag AUDIT
"RTN","PSBUTL",172,0)
 D FIELD^DID(PSBDD,PSBFLD,"","LABEL","PSBTMP")  ; PSBDD=53.79, 53.795, 53.796, or 53.797 see comment at tag AUDIT
"RTN","PSBUTL",173,0)
 S:'$D(^PSB(53.79,PSBREC,.9,0)) ^(0)="^53.799^^"
"RTN","PSBUTL",174,0)
 S Y=$O(^PSB(53.79,PSBREC,.9,""),-1)+1
"RTN","PSBUTL",175,0)
 I PSBTMP("LABEL")["ACTION STATUS" D  Q
"RTN","PSBUTL",176,0)
 .S PSBOLDUZ=$P(^PSB(53.79,PSBREC,0),U,5),PSBOLSTS=$P(^PSB(53.79,PSBREC,0),U,9)
"RTN","PSBUTL",177,0)
 .S X=PSBOLSTS,X=$S(X="G":"GIVEN",X="H":"HELD",X="R":"REFUSED",X="I":"INFUSING",X="C":"COMPLETED",X="S":"STOPPED",X="N":"NOT GIVEN",X="RM":"REMOVED",X="M":"MISSING DOSE","":PSBOLSTS)
"RTN","PSBUTL",178,0)
 .I PSBSK["K" S ^PSB(53.79,PSBREC,.9,Y,0)=PSBDT_U_DUZ_U_"Field: "_PSBTMP("LABEL")_" '"_PSBDATA_"' by '"_$$GET1^DIQ(200,PSBOLDUZ,"INITIAL")_" deleted."
"RTN","PSBUTL",179,0)
 .E  S ^PSB(53.79,PSBREC,.9,Y,0)=PSBDT_U_DUZ_U_"Field: "_PSBTMP("LABEL")_" Set to '"_PSBDATA_"' by '"_$$GET1^DIQ(200,DUZ,"INITIAL")_"'."_U_X
"RTN","PSBUTL",180,0)
 I PSBSK["K" S ^PSB(53.79,PSBREC,.9,Y,0)=PSBDT_U_DUZ_U_"Field: "_PSBTMP("LABEL")_" '"_PSBDATA_"' deleted."
"RTN","PSBUTL",181,0)
 E  S ^PSB(53.79,PSBREC,.9,Y,0)=PSBDT_U_DUZ_U_"Field: "_PSBTMP("LABEL")_" Set to '"_PSBDATA_"'."
"RTN","PSBUTL",182,0)
 Q
"RTN","PSBUTL",183,0)
 ;
"RTN","PSBUTL",184,0)
CHECK(RESULTS,PSBWHAT,PSBDATA) ; Checks for KIDS Patch or Build
"RTN","PSBUTL",185,0)
 ; Module added in Patch PSB*1.0*3 DP/TOPEKA 22-DEC-1999 11:51:22 
"RTN","PSBUTL",186,0)
 ; PSBWHAT: B = Returns Build Version for packages by Namespace
"RTN","PSBUTL",187,0)
 ;          P = Returns if Patch is installed
"RTN","PSBUTL",188,0)
 ; PSBDATA: Build/Package namespace (i.e. PSB) or Patch Number
"RTN","PSBUTL",189,0)
 ;         (i.e. PSB*1.0*1)
"RTN","PSBUTL",190,0)
 ;
"RTN","PSBUTL",191,0)
 S RESULTS(0)="-1^Unknown Parameter "_$G(PSBWHAT,"<PSBWHAT Undefined>")
"RTN","PSBUTL",192,0)
 S PSBWHAT=$G(PSBWHAT),PSBDATA=$G(PSBDATA)
"RTN","PSBUTL",193,0)
 D:PSBWHAT="B"
"RTN","PSBUTL",194,0)
 .S X=$$VERSION^XPDUTL(PSBDATA)
"RTN","PSBUTL",195,0)
 .S RESULTS(0)=$S(X="":"-1^Unknown Package/Build",1:"1^"_X)
"RTN","PSBUTL",196,0)
 D:PSBWHAT="P"
"RTN","PSBUTL",197,0)
 .S X=$$PATCH^XPDUTL(PSBDATA)
"RTN","PSBUTL",198,0)
 .S RESULTS(0)=$S(X:"1^Patch Is Installed",1:"-1^Patch Is Not Installed")
"RTN","PSBUTL",199,0)
 Q
"RTN","PSBUTL",200,0)
 ;
"RTN","PSBUTL",201,0)
VERSION() ; [Extrinsic] 
"RTN","PSBUTL",202,0)
 ; Returns V#.# for display purposes
"RTN","PSBUTL",203,0)
 Q "V"_$J(2,0,1)
"RTN","PSBVAR")
0^48^B13394171
"RTN","PSBVAR",1,0)
PSBVAR ;BIRMINGHAM/EFC-BCMA VARIANCE LOG FUNCTIONS ;Mar 2004
"RTN","PSBVAR",2,0)
 ;;3.0;BAR CODE MED ADMIN;;Mar 2004
"RTN","PSBVAR",3,0)
 ;
"RTN","PSBVAR",4,0)
 ; Reference/IA
"RTN","PSBVAR",5,0)
 ; ^DPT/10035
"RTN","PSBVAR",6,0)
 ; ^DIC(42/10039
"RTN","PSBVAR",7,0)
 ;
"RTN","PSBVAR",8,0)
EN ;
"RTN","PSBVAR",9,0)
 Q
"RTN","PSBVAR",10,0)
 ;
"RTN","PSBVAR",11,0)
CHKPRN(DFN,PSBMIN,PSBLOG) ;
"RTN","PSBVAR",12,0)
 Q:PSBMIN=""
"RTN","PSBVAR",13,0)
 Q:PSBMIN'>$$GET^XPAR("DIV","PSB ADMIN PRN EFFECT")
"RTN","PSBVAR",14,0)
 D ADD(.RESULTS,DFN,3,PSBMIN,"",PSBLOG)
"RTN","PSBVAR",15,0)
 Q
"RTN","PSBVAR",16,0)
 ;
"RTN","PSBVAR",17,0)
 ;CHECK^PSBVAR() calling point is used to create a new variance entry.  Triggered by Order Administration Variance Field # 14 in the BCMA Medication Log File (#53.79).
"RTN","PSBVAR",18,0)
 ;
"RTN","PSBVAR",19,0)
CHECK(DFN,PSBMIN,PSBLOG) ;
"RTN","PSBVAR",20,0)
 Q:PSBMIN=""
"RTN","PSBVAR",21,0)
 N RESULTS
"RTN","PSBVAR",22,0)
 ; Checks the timing from the Med Log Entry X-Ref
"RTN","PSBVAR",23,0)
 I PSBMIN<0 D:(PSBMIN*-1)>$$GET^XPAR("DIV","PSB ADMIN BEFORE") ADD(.RESULTS,DFN,2,PSBMIN,"",PSBLOG)
"RTN","PSBVAR",24,0)
 I PSBMIN>0 D:PSBMIN>$$GET^XPAR("DIV","PSB ADMIN AFTER") ADD(.RESULTS,DFN,2,PSBMIN,"",PSBLOG)
"RTN","PSBVAR",25,0)
 Q
"RTN","PSBVAR",26,0)
 ;
"RTN","PSBVAR",27,0)
ADD(RESULTS,DFN,PSBEVNT,PSBMIN,PSBDRUG,PSBLOG) ;
"RTN","PSBVAR",28,0)
 ;
"RTN","PSBVAR",29,0)
 ; DFN:      Patient File (#2) Pointer
"RTN","PSBVAR",30,0)
 ; PSBEVNT:  Event Code (See DD for 53.78)
"RTN","PSBVAR",31,0)
 ; PSBMIN:   Minutes off of schedule (Optional)
"RTN","PSBVAR",32,0)
 ; PSBDRUG:  Drug File (#50) Pointer (Optional)
"RTN","PSBVAR",33,0)
 ; PSBLOG:   BCMA Med Log IEN (Optional)
"RTN","PSBVAR",34,0)
 ;
"RTN","PSBVAR",35,0)
 ;Do not create variance for med order with missing dose status.
"RTN","PSBVAR",36,0)
 I $G(PSBLOG),$P($G(^PSB(53.79,PSBLOG,0)),U,9)="M" Q
"RTN","PSBVAR",37,0)
 ;
"RTN","PSBVAR",38,0)
 N PSBDT,PSBRB,PSBWRD,PSBXX
"RTN","PSBVAR",39,0)
 ;
"RTN","PSBVAR",40,0)
 D EN^DDIOL("Filing Variance...")
"RTN","PSBVAR",41,0)
 D NOW^%DTC
"RTN","PSBVAR",42,0)
 L +(^PSB(53.78,0)):5 E  S RESULTS(0)="-1^Variance Log Locked" Q
"RTN","PSBVAR",43,0)
 S PSBXX=$O(^PSB(53.78,"A"),-1)+1
"RTN","PSBVAR",44,0)
 S $P(^PSB(53.78,0),U,3)=PSBXX
"RTN","PSBVAR",45,0)
 S $P(^PSB(53.78,0),U,4)=$P(^PSB(53.78,0),U,4)+1
"RTN","PSBVAR",46,0)
 ;
"RTN","PSBVAR",47,0)
WARD ;Extract the ward and room/bed information.
"RTN","PSBVAR",48,0)
 ;DFN is pre-defined.
"RTN","PSBVAR",49,0)
 S PSBRB=$P($G(^DPT(DFN,.101)),U)
"RTN","PSBVAR",50,0)
 S PSBRB=$S(PSBRB'="":PSBRB,1:"***")
"RTN","PSBVAR",51,0)
 S PSBWRD=$P($G(^DPT(DFN,.1)),U)
"RTN","PSBVAR",52,0)
 ;Convert Ward Name to Ward IEN
"RTN","PSBVAR",53,0)
 S PSBDT=%
"RTN","PSBVAR",54,0)
 S PSBWRD=$$FIND1^DIC(42,"","X",PSBWRD,"","","ERR")
"RTN","PSBVAR",55,0)
 S %=PSBDT ;reset after $$FIND1^DIC fileman call
"RTN","PSBVAR",56,0)
 S PSBWRD=$S($G(PSBWRD):PSBWRD,1:"***")
"RTN","PSBVAR",57,0)
 ;
"RTN","PSBVAR",58,0)
 ; Set Variance Entry
"RTN","PSBVAR",59,0)
 S ^PSB(53.78,PSBXX,0)=DFN_U_PSBRB_U_DUZ_U_%_U_PSBEVNT_U_$G(PSBMIN)_U_$G(PSBDRUG)_U_$G(PSBLOG)_U_PSBWRD
"RTN","PSBVAR",60,0)
 ;
"RTN","PSBVAR",61,0)
 S ^PSB(53.78,"ADT",%,PSBXX)=""
"RTN","PSBVAR",62,0)
 S ^PSB(53.78,"B",DFN,PSBXX)=""
"RTN","PSBVAR",63,0)
 L -(^PSB(53.78,0))
"RTN","PSBVAR",64,0)
 S RESULTS(0)="1^Data Filed"
"RTN","PSBVAR",65,0)
 Q
"RTN","PSBVAR",66,0)
 ;
"RTN","PSBVAR",67,0)
 ; Unable to UPDATE^DIE WHILE IN UPDATE^DIE
"RTN","PSBVAR",68,0)
 W !,"Filing Variance..."
"RTN","PSBVAR",69,0)
 D EN^DDIOL("Filing Variance...")
"RTN","PSBVAR",70,0)
 N PSBVFDA,PSBVMSG,PSBVIEN
"RTN","PSBVAR",71,0)
 D VAL(.01,"`"_DFN) ; Patient Pointer
"RTN","PSBVAR",72,0)
 S Y=$G(^DPT(DFN,.1),"Unk Ward")_" "_$G(^DPT(DFN,.101),"Unk Bed")
"RTN","PSBVAR",73,0)
 D VAL(.02,Y) ; Patient Location
"RTN","PSBVAR",74,0)
 D VAL(.03,"`"_DUZ) ; New Person Pointer
"RTN","PSBVAR",75,0)
 D VAL(.04,"NOW") ; DT Entered
"RTN","PSBVAR",76,0)
 D VAL(.05,PSBEVNT) ; Event Code
"RTN","PSBVAR",77,0)
 D:$G(PSBMIN) VAL(.06,PSBMIN) ; Minutes Early/Late
"RTN","PSBVAR",78,0)
 D:$G(PSBDRUG) VAL(.07,"`"_PSBDRUG) ; Drug File Pointer
"RTN","PSBVAR",79,0)
 D:$G(PSBLOG) VAL(.08,"`"_PSBLOG)
"RTN","PSBVAR",80,0)
 ; Call UPDATE^DIE and set Results(0)
"RTN","PSBVAR",81,0)
 D UPDATE^DIE("","PSBVFDA","PSBVIEN","PSBVMSG")  ; PSBVFDA set into file 53.68, BCMA MEDICATION VARIANCE LOG at VAL+3
"RTN","PSBVAR",82,0)
 I $D(PSBVMSG) S RESULTS(0)="-1^"_PSBVMSG("DIERR",1)_": "_PSBVMSG("DIERR",1,"TEXT",1)
"RTN","PSBVAR",83,0)
 E  S RESULTS(0)="1^Data Successfully Filed^"_PSBVIEN(1)
"RTN","PSBVAR",84,0)
 W !,RESULTS(0)
"RTN","PSBVAR",85,0)
 Q
"RTN","PSBVAR",86,0)
 ;
"RTN","PSBVAR",87,0)
VAL(PSBVFLD,PSBVVAL) ;
"RTN","PSBVAR",88,0)
 N PSBVRET
"RTN","PSBVAR",89,0)
 K ^TMP("DIERR",$J)
"RTN","PSBVAR",90,0)
 D VAL^DIE(53.78,"+1,",PSBVFLD,"F",PSBVVAL,.PSBVRET,"PSBVFDA")
"RTN","PSBVAR",91,0)
 I PSBVRET="^" F X=0:0 S X=$O(^TMP("DIERR",$J,X)) Q:'X  S Y=^TMP("DIERR",$J,X)_": "_$G(^(X,"TEXT",1),"**"),RESULTS($O(RESULTS(""),-1)+1)="Data Validation Error: "_Y
"RTN","PSBVAR",92,0)
 K ^TMP("DIERR",$J)
"RTN","PSBVAR",93,0)
 Q
"RTN","PSBVAR",94,0)
 ;
"RTN","PSBVDLIV")
0^49^B63524635
"RTN","PSBVDLIV",1,0)
PSBVDLIV ;BIRMINGHAM/EFC-BCMA IV VIRTUAL DUE LIST ;Mar 2004
"RTN","PSBVDLIV",2,0)
 ;;3.0;BAR CODE MED ADMIN;;Mar 2004
"RTN","PSBVDLIV",3,0)
 ;
"RTN","PSBVDLIV",4,0)
 ; Reference/IA
"RTN","PSBVDLIV",5,0)
 ; EN^PSJBCMA/2828
"RTN","PSBVDLIV",6,0)
 ; EN^PSJBCMA1/2829 
"RTN","PSBVDLIV",7,0)
 ;
"RTN","PSBVDLIV",8,0)
EN(DFN,PSBDT) ; Default Order List Return for Today
"RTN","PSBVDLIV",9,0)
 ;
"RTN","PSBVDLIV",10,0)
 ; RPC: PSB GETORDERLIST
"RTN","PSBVDLIV",11,0)
 ;
"RTN","PSBVDLIV",12,0)
 ; Description:
"RTN","PSBVDLIV",13,0)
 ; Returns the current IV order set for today to display on the
"RTN","PSBVDLIV",14,0)
 ; client VDL
"RTN","PSBVDLIV",15,0)
 ;
"RTN","PSBVDLIV",16,0)
 N PSBDATA,PSBTBOUT,PSBDOADD
"RTN","PSBVDLIV",17,0)
 S PSBTBOUT=0,PSBDOADD=0
"RTN","PSBVDLIV",18,0)
 S:PSBTAB="IVTAB" PSBDOADD=1
"RTN","PSBVDLIV",19,0)
 ;
"RTN","PSBVDLIV",20,0)
 ; Passing PSBDT as 3rd parameter turns off the V.1.0 One-Time lookback
"RTN","PSBVDLIV",21,0)
 K ^TMP("PSJ",$J),^TMP("PSB",$J,"ON IVTAB") S X1=PSBDT,X2=-3 D C^%DTC S PSBDT2=X D EN^PSJBCMA(DFN,PSBDT2,PSBDT)
"RTN","PSBVDLIV",22,0)
 ;
"RTN","PSBVDLIV",23,0)
 I $G(^TMP("PSJ",$J,1,0))=-1 Q  ; No orders
"RTN","PSBVDLIV",24,0)
 ;
"RTN","PSBVDLIV",25,0)
 F PSBX=0:0 S PSBX=$O(^TMP("PSJ",$J,PSBX)) Q:('PSBX)!(PSBTBOUT)  D
"RTN","PSBVDLIV",26,0)
 .D CLEAN^PSBVT,PSJ^PSBVT(PSBX)
"RTN","PSBVDLIV",27,0)
 .;
"RTN","PSBVDLIV",28,0)
 .; << Standard checks for ALL orders >>
"RTN","PSBVDLIV",29,0)
 .;
"RTN","PSBVDLIV",30,0)
 .Q:PSBONX'["V"  ; IVs only
"RTN","PSBVDLIV",31,0)
 .Q:PSBIVT["P"  ; No piggybacks
"RTN","PSBVDLIV",32,0)
 .Q:PSBONX["P"  ;     No Pending Orders
"RTN","PSBVDLIV",33,0)
 .Q:PSBOST>($$FMADD^XLFDT($$NOW^XLFDT,,,$$GET^XPAR("DIV","PSB ADMIN BEFORE")))
"RTN","PSBVDLIV",34,0)
 .; Need to see if "last order" in chain is active/not pending.
"RTN","PSBVDLIV",35,0)
 .I $G(PSBFON)]"" S PSBLACTV=$S($G(PSBFON)["P":0,1:1) S PSBFON2=$G(PSBFON) F  D  Q:($G(PSBFON)="")!($G(PSBFON)=$G(PSBFON2))  ;
"RTN","PSBVDLIV",36,0)
 ..I $G(PSBFON)["P" K ^TMP("PSJ1",$J) D EN^PSJBCMA1(DFN,PSBFON2,1) I ^TMP("PSJ1",$J,0)=-1 S PSBFON=""
"RTN","PSBVDLIV",37,0)
 ..D:$G(PSBFON)]"" CLEAN^PSBVT,PSJ1^PSBVT(DFN,PSBFON2)
"RTN","PSBVDLIV",38,0)
 ..S PSBLACTV=$S($G(PSBFON)["P":0,$G(PSBFON)']"":PSBLACTV,1:1),PSBFON2=$G(PSBFON)
"RTN","PSBVDLIV",39,0)
 ..S:(PSBLACTV)&($G(PSBOST)>($$FMADD^XLFDT($$NOW^XLFDT,,,$$GET^XPAR("DIV","PSB ADMIN BEFORE")))) PSBLACTV=0
"RTN","PSBVDLIV",40,0)
 .D CLEAN^PSBVT,PSJ^PSBVT(PSBX) ;Refresh data
"RTN","PSBVDLIV",41,0)
 .K PSBCOMP,PSBCOMPX,PSBINFDT,PSBINFST D INFUSING^PSBVDLU2
"RTN","PSBVDLIV",42,0)
 .D NOW^%DTC
"RTN","PSBVDLIV",43,0)
 .I ((PSBOSTS="A")!(PSBOSTS="R"))&(PSBOSP<%) S PSBOSTS="E"
"RTN","PSBVDLIV",44,0)
 .I (PSBOSTS["D")&(PSBCOMP=0) Q  ;     Is it DC'd and not infusing or stopped
"RTN","PSBVDLIV",45,0)
 .I PSBOSTS="E",PSBCOMP=0 Q  ; Is expired and not infusing or stopped
"RTN","PSBVDLIV",46,0)
 .I PSBOSTS="D",PSBCOMP=1,($G(PSBFON)]""),PSBLACTV Q  ; order is DC'ed   will be picked up by following order
"RTN","PSBVDLIV",47,0)
 .I PSBOSTS="E",PSBCOMP=1,($G(PSBFON)]""),PSBLACTV Q  ; order is expired will be picked up by following order
"RTN","PSBVDLIV",48,0)
 .I PSBOSTS="R",PSBFOR="R",PSBOSP<PSBWBEG Q  ; order is renewed bag picked up by following order
"RTN","PSBVDLIV",49,0)
 .Q:$G(^TMP("PSB",$J,"ON IVTAB",PSBDFN,PSBONX))=1  ; The "previous order" is displayed on the VDL!
"RTN","PSBVDLIV",50,0)
 .I (PSBOSTS["E")&(PSBCOMP=0) Q  ;     Is it expired and not infusing
"RTN","PSBVDLIV",51,0)
 .I PSBIVT["S",PSBISYR=1 Q  ;     No intermittent syringes - done on PB tab
"RTN","PSBVDLIV",52,0)
 .I PSBIVT["C",PSBISYR=1 Q  ;     No intermittent syringes - done on PB tab
"RTN","PSBVDLIV",53,0)
 .I PSBIVT["C",PSBCHEMT="P" Q  ;  No Piggyback Chemos
"RTN","PSBVDLIV",54,0)
 .I PSBNGF&(PSBCOMP=1) Q  ;         Is it marked DO NOT GIVE!
"RTN","PSBVDLIV",55,0)
 .;
"RTN","PSBVDLIV",56,0)
 .; Non One-Times with stop date/time < now
"RTN","PSBVDLIV",57,0)
 .;
"RTN","PSBVDLIV",58,0)
 .D NOW^%DTC
"RTN","PSBVDLIV",59,0)
 .I PSBOSP<%,PSBOSTS'="R",PSBCOMP'=1 Q
"RTN","PSBVDLIV",60,0)
 .;
"RTN","PSBVDLIV",61,0)
 .; include Active, Renewed, ReInstated and On Call and Hold and Expired infusing
"RTN","PSBVDLIV",62,0)
 .; (Is it not one time)&(Is it not active or renewed or On Call or Hold)
"RTN","PSBVDLIV",63,0)
 .Q:PSBSCHT'="O"&((PSBOSTS'="A")&(PSBOSTS'="R")&(PSBOSTS'="RE")&(PSBOSTS'="O")&(PSBOSTS'="D")&(PSBOSTS'="H")&(PSBOSTS'="E"))
"RTN","PSBVDLIV",64,0)
 .;
"RTN","PSBVDLIV",65,0)
 .; Is One Time Given
"RTN","PSBVDLIV",66,0)
 .;
"RTN","PSBVDLIV",67,0)
 .I PSBSCHT="O" D  Q:PSBGVN
"RTN","PSBVDLIV",68,0)
 ..S (PSBGVN,X,Y)=""
"RTN","PSBVDLIV",69,0)
 ..F  S X=$O(^PSB(53.79,"AOIP",DFN,PSBOIT,X),-1) Q:'X  D
"RTN","PSBVDLIV",70,0)
 ...F  S Y=$O(^PSB(53.79,"AOIP",DFN,PSBOIT,X,Y),-1) Q:'Y  D
"RTN","PSBVDLIV",71,0)
 ....I $P(^PSB(53.79,Y,.1),U)=PSBON,$P(^PSB(53.79,Y,0),U,9)="G" S PSBGVN=1,(X,Y)=0
"RTN","PSBVDLIV",72,0)
 .;
"RTN","PSBVDLIV",73,0)
 .; Is On-Call Given, Can it be given more than once
"RTN","PSBVDLIV",74,0)
 .;
"RTN","PSBVDLIV",75,0)
 .I PSBSCHT="OC" D  Q:PSBGVN&('$$GET^XPAR("DIV","PSB ADMIN MULTIPLE ONCALL"))
"RTN","PSBVDLIV",76,0)
 ..S (PSBGVN,X,Y)=""
"RTN","PSBVDLIV",77,0)
 ..F  S X=$O(^PSB(53.79,"AOIP",DFN,PSBOIT,X),-1) Q:'X  D
"RTN","PSBVDLIV",78,0)
 ...F  S Y=$O(^PSB(53.79,"AOIP",DFN,PSBOIT,X,Y),-1) Q:'Y  D
"RTN","PSBVDLIV",79,0)
 ....I $P(^PSB(53.79,Y,.1),U)=PSBON,$P(^PSB(53.79,Y,0),U,9)="G" S PSBGVN=1,(X,Y)=0
"RTN","PSBVDLIV",80,0)
 .;
"RTN","PSBVDLIV",81,0)
OK .S PSBSTRT=PSBOST ; Order Start Date/Time
"RTN","PSBVDLIV",82,0)
 .S PSBSTOP=PSBOSP ; Order Stop Date/Time
"RTN","PSBVDLIV",83,0)
 .;
"RTN","PSBVDLIV",84,0)
 .S PSBREC=""
"RTN","PSBVDLIV",85,0)
 .S $P(PSBREC,U,1)=DFN ; dfn
"RTN","PSBVDLIV",86,0)
 .S $P(PSBREC,U,2)=PSBONX ; Order
"RTN","PSBVDLIV",87,0)
 .S $P(PSBREC,U,3)=+PSBON ; order ien
"RTN","PSBVDLIV",88,0)
 .S $P(PSBREC,U,4)=PSBOTYP ; iv/ud/pending
"RTN","PSBVDLIV",89,0)
 .S $P(PSBREC,U,5)=PSBSCHT ; schedule type
"RTN","PSBVDLIV",90,0)
 .S $P(PSBREC,U,6)=PSBSCH ; schedule
"RTN","PSBVDLIV",91,0)
 .S Y=""
"RTN","PSBVDLIV",92,0)
 .S:PSBSM Y="SM"
"RTN","PSBVDLIV",93,0)
 .S:PSBHSM Y="HSM"
"RTN","PSBVDLIV",94,0)
 .S $P(PSBREC,U,7)=Y ; self med
"RTN","PSBVDLIV",95,0)
 .S $P(PSBREC,U,8)=PSBOITX ; drugname
"RTN","PSBVDLIV",96,0)
 .S $P(PSBREC,U,9)=PSBDOSE_" "_PSBIFR ; dosage
"RTN","PSBVDLIV",97,0)
 .S $P(PSBREC,U,10)=PSBMR ; route
"RTN","PSBVDLIV",98,0)
 .; IV Information Column *new*  -  status date/time
"RTN","PSBVDLIV",99,0)
 .; (only stopped or infusing)
"RTN","PSBVDLIV",100,0)
 .;
"RTN","PSBVDLIV",101,0)
 .D:PSBCOMP 
"RTN","PSBVDLIV",102,0)
 ..S $P(PSBREC,U,11)=PSBINFDT K PSBINFDT
"RTN","PSBVDLIV",103,0)
 ..S PSBSTUS=PSBINFST,$P(PSBREC,U,20)=PSBSTUS K PSBINFST
"RTN","PSBVDLIV",104,0)
 .S $P(PSBREC,U,14)="" ; admin date inserted below
"RTN","PSBVDLIV",105,0)
 .S $P(PSBREC,U,15)=PSBOIT ; OI Pointer
"RTN","PSBVDLIV",106,0)
 .S $P(PSBREC,U,16)=0  ; Default to not injectable
"RTN","PSBVDLIV",107,0)
 .;Scan for injectable routes
"RTN","PSBVDLIV",108,0)
 .F X="ID","IV","IM","SC","SQ" D  Q:$P(PSBREC,U,16)
"RTN","PSBVDLIV",109,0)
 ..I PSBMR?@(".E1"""_X_""".E") S $P(PSBREC,U,16)=1
"RTN","PSBVDLIV",110,0)
 .; Variable dosage entered as ####-####?
"RTN","PSBVDLIV",111,0)
 .I $P(PSBREC,U,9)?1.4N1"-"1.4N.E S $P(PSBREC,U,17)=1
"RTN","PSBVDLIV",112,0)
 .E  S $P(PSBREC,U,17)=0
"RTN","PSBVDLIV",113,0)
 .S $P(PSBREC,U,18)=PSBIVT  ;IV TYPE
"RTN","PSBVDLIV",114,0)
 .S $P(PSBREC,U,21)=PSBOST
"RTN","PSBVDLIV",115,0)
 .S $P(PSBREC,U,22)=PSBOSTS
"RTN","PSBVDLIV",116,0)
 .;
"RTN","PSBVDLIV",117,0)
 .; Gather Dispense Drugs
"RTN","PSBVDLIV",118,0)
 .D NOW^%DTC
"RTN","PSBVDLIV",119,0)
 .S (PSBDDS,PSBSOLS,PSBADDS)="0"
"RTN","PSBVDLIV",120,0)
 .F Y=0:0 S Y=$O(PSBDDA(Y)) Q:'Y  D
"RTN","PSBVDLIV",121,0)
 ..Q:$P(PSBDDA(Y),U,4)&($P(PSBDDA(Y),U,4)<%)  ; Inactive
"RTN","PSBVDLIV",122,0)
 ..S:$P(PSBDDA(Y),U,3)="" $P(PSBDDA(Y),U,3)=1
"RTN","PSBVDLIV",123,0)
 ..S PSBDDS=PSBDDS_U_$P(PSBDDA(Y),U,1,3)
"RTN","PSBVDLIV",124,0)
 ..S $P(PSBDDS,U,1)=PSBDDS+1
"RTN","PSBVDLIV",125,0)
 .; On-Call One Time PRN orders
"RTN","PSBVDLIV",126,0)
 .S PSBQRR=0
"RTN","PSBVDLIV",127,0)
 .I "^O^OC^P^"[(U_PSBSCHT_U) D  Q
"RTN","PSBVDLIV",128,0)
 ..I 'PSBDOADD S PSBTBOUT=1,^TMP("PSB",$J,"IVTAB",0)=2,^TMP("PSB",$J,"IVTAB",1)=1,^TMP("PSB",$J,"IVTAB",2)=1 Q
"RTN","PSBVDLIV",129,0)
 ..D ADD^PSBVDLU1(PSBREC,PSBOTXT,PSBNOW\1,PSBDDS,PSBSOLS,PSBADDS,"IVTAB")
"RTN","PSBVDLIV",130,0)
 ..S:$G(PSBFON)'="" ^TMP("PSB",$J,"ON IVTAB",PSBDFN,PSBFON)=1  ; Now do not have to place "following order" on VDL!
"RTN","PSBVDLIV",131,0)
 .;
"RTN","PSBVDLIV",132,0)
 .; IV's - don't worry about admin times if blank
"RTN","PSBVDLIV",133,0)
 .I PSBONX["V",PSBIVT'="P",PSBADST="" D  Q
"RTN","PSBVDLIV",134,0)
 ..I 'PSBDOADD S PSBTBOUT=1,^TMP("PSB",$J,"IVTAB",0)=2,^TMP("PSB",$J,"IVTAB",1)=1,^TMP("PSB",$J,"IVTAB",2)=1 Q
"RTN","PSBVDLIV",135,0)
 ..D ADD^PSBVDLU1(PSBREC,PSBOTXT,PSBNOW\1_".",PSBDDS,PSBSOLS,PSBADDS,"IVTAB")
"RTN","PSBVDLIV",136,0)
 ..S:$G(PSBFON)'="" ^TMP("PSB",$J,"ON IVTAB",PSBDFN,PSBFON)=1  ; Now do not have to place "following order" on VDL!
"RTN","PSBVDLIV",137,0)
 .;
"RTN","PSBVDLIV",138,0)
 .; Now we deal with only continuous
"RTN","PSBVDLIV",139,0)
 .; process admintimes
"RTN","PSBVDLIV",140,0)
 .S PSBFREQ=$$GETFREQ^PSBVDLU1(DFN,PSBONX)
"RTN","PSBVDLIV",141,0)
 .S PSBADMIN=PSBADST
"RTN","PSBVDLIV",142,0)
 .; process admin times against beginning and ending date
"RTN","PSBVDLIV",143,0)
 .; build all orders for both days.
"RTN","PSBVDLIV",144,0)
 .F PSBY=1:1 Q:$P(PSBADMIN,"-",PSBY)=""  D
"RTN","PSBVDLIV",145,0)
 ..; apply this time to the beginning window date
"RTN","PSBVDLIV",146,0)
 ..S PSB=+(PSBWBEG\1_"."_$P(PSBADMIN,"-",PSBY))
"RTN","PSBVDLIV",147,0)
 ..D:(PSB'<PSBWBEG)&(PSB'>PSBWEND)  ; Make sure it is in the window
"RTN","PSBVDLIV",148,0)
 ...D:(PSB'<PSBSTRT)&(PSB<PSBSTOP)  ; Make sure this time is active
"RTN","PSBVDLIV",149,0)
 ....D:$$OKAY^PSBVDLU1(PSBSTRT,$P(PSB,"."),PSBSCH,PSBON,PSBOITX,PSBFREQ)  ; Okay on this date?
"RTN","PSBVDLIV",150,0)
 .....I 'PSBDOADD S PSBTBOUT=1,^TMP("PSB",$J,"IVTAB",0)=2,^TMP("PSB",$J,"IVTAB",1)=1,^TMP("PSB",$J,"IVTAB",2)=1 Q
"RTN","PSBVDLIV",151,0)
 .....D ADD^PSBVDLU1(PSBREC,PSBOTXT,PSB,PSBDDS,PSBSOLS,PSBADDS,"IVTAB")
"RTN","PSBVDLIV",152,0)
 .....S:$G(PSBFON)'="" ^TMP("PSB",$J,"ON IVTAB",PSBDFN,PSBFON)=1  ; Now do not have to place "following order" on VDL!
"RTN","PSBVDLIV",153,0)
 ..;
"RTN","PSBVDLIV",154,0)
 ..Q:(PSBWBEG\1)=(PSBWEND\1)  ; Window only has one day rare but possible
"RTN","PSBVDLIV",155,0)
 ..;
"RTN","PSBVDLIV",156,0)
 ..; apply this time to the ending window date
"RTN","PSBVDLIV",157,0)
 ..S PSB=+(PSBWEND\1_"."_$P(PSBADMIN,"-",PSBY))
"RTN","PSBVDLIV",158,0)
 ..D:(PSB'<PSBWBEG)&(PSB'>PSBWEND)  ; Make sure it is in the window
"RTN","PSBVDLIV",159,0)
 ...D:(PSB'<PSBSTRT)&(PSB<PSBSTOP)  ; Make sure this time is active
"RTN","PSBVDLIV",160,0)
 ....D:$$OKAY^PSBVDLU1(PSBSTRT,$P(PSB,"."),PSBSCH,PSBON,PSBOITX,PSBFREQ)  ; Okay on this date?
"RTN","PSBVDLIV",161,0)
 .....I 'PSBDOADD S PSBTBOUT=1,^TMP("PSB",$J,"IVTAB",0)=2,^TMP("PSB",$J,"IVTAB",1)=1,^TMP("PSB",$J,"IVTAB",2)=1 Q
"RTN","PSBVDLIV",162,0)
 .....D ADD^PSBVDLU1(PSBREC,PSBOTXT,PSB,PSBDDS,PSBSOLS,PSBADDS,"IVTAB")
"RTN","PSBVDLIV",163,0)
 .....S:$G(PSBFON)'="" ^TMP("PSB",$J,"ON IVTAB",PSBDFN,PSBFON)=1  ; Now do not have to place "following order" on VDL!
"RTN","PSBVDLIV",164,0)
 K ^TMP("PSB",$J,"ON IVTAB")
"RTN","PSBVDLIV",165,0)
 ;
"RTN","PSBVDLIV",166,0)
 ;add initials of verifying pharmacist/verifying nurse
"RTN","PSBVDLIV",167,0)
 D:PSBDOADD VNURSE^PSBVDLU1("IVTAB")
"RTN","PSBVDLIV",168,0)
 Q
"RTN","PSBVDLIV",169,0)
 ;
"RTN","PSBVDLPA")
0^50^B6723611
"RTN","PSBVDLPA",1,0)
PSBVDLPA ;BIRMINGHAM/EFC-BCMA UNIT DOSE VIRTUAL DUE LIST FUNCTIONS ;Mar 2004
"RTN","PSBVDLPA",2,0)
 ;;3.0;BAR CODE MED ADMIN;;Mar 2004
"RTN","PSBVDLPA",3,0)
 ;
"RTN","PSBVDLPA",4,0)
 ; called by PSBVDLUD to find patches not removed
"RTN","PSBVDLPA",5,0)
 ;
"RTN","PSBVDLPA",6,0)
EN ;
"RTN","PSBVDLPA",7,0)
 S PSBGNODE="^PSB(53.79,"_"""APATCH"""_","_DFN_")" Q:'$D(PSBGNODE)
"RTN","PSBVDLPA",8,0)
 F  S PSBGNODE=$Q(@PSBGNODE) Q:PSBGNODE=""  Q:$QS(PSBGNODE,3)'=DFN  D
"RTN","PSBVDLPA",9,0)
 .S PSBIEN=$QS(PSBGNODE,5)
"RTN","PSBVDLPA",10,0)
 .I '$D(^PSB(53.79,PSBIEN,.5,1)) Q
"RTN","PSBVDLPA",11,0)
 .I $P(^PSB(53.79,PSBIEN,.5,1,0),U,4)'="PATCH" Q
"RTN","PSBVDLPA",12,0)
 .I $P(^PSB(53.79,PSBIEN,0),U,9)'="G" Q
"RTN","PSBVDLPA",13,0)
 .S PSBZON=$P(^PSB(53.79,PSBIEN,.1),"^")
"RTN","PSBVDLPA",14,0)
 .D CLEAN^PSBVT
"RTN","PSBVDLPA",15,0)
 .D PSJ1^PSBVT(DFN,PSBZON)
"RTN","PSBVDLPA",16,0)
 .S $P(PSBREC,U,1)=DFN  ; dfn
"RTN","PSBVDLPA",17,0)
 .S $P(PSBREC,U,2)=PSBONX  ; order numer
"RTN","PSBVDLPA",18,0)
 .S $P(PSBREC,U,3)=PSBON  ; order ien
"RTN","PSBVDLPA",19,0)
 .S $P(PSBREC,U,4)="U"  ; order type U unit dose
"RTN","PSBVDLPA",20,0)
 .S $P(PSBREC,U,5)=PSBSCHT
"RTN","PSBVDLPA",21,0)
 .S $P(PSBREC,U,6)=PSBSCH
"RTN","PSBVDLPA",22,0)
 .S $P(PSBREC,U,7)=$S(PSBHSM:"HSM",PSBSM:"SM",1:"")
"RTN","PSBVDLPA",23,0)
 .S $P(PSBREC,U,8)=PSBOITX
"RTN","PSBVDLPA",24,0)
 .S $P(PSBREC,U,9)=PSBDOSE
"RTN","PSBVDLPA",25,0)
 .S $P(PSBREC,U,10)=PSBMR
"RTN","PSBVDLPA",26,0)
 .S:$D(PSBHSTAX(PSBOIT)) $P(PSBREC,U,11)=$O(PSBHSTAX(PSBOIT,""),-1),$P(PSBREC,U,20)=$O(PSBHSTAX(PSBOIT,$P(PSBREC,U,11),""),-1)
"RTN","PSBVDLPA",27,0)
 .D:'$D(PSBHSTAX(PSBOIT))
"RTN","PSBVDLPA",28,0)
 ..N PSBX,PSBY,PSBDONE S PSBDONE=0,PSBX="" F  S PSBX=$O(^PSB(53.79,"AOIP",DFN,PSBOIT,PSBX),-1) Q:PSBX=""  D:'PSBDONE
"RTN","PSBVDLPA",29,0)
 ...S PSBY="" F  S PSBY=$O(^PSB(53.79,"AOIP",DFN,PSBOIT,PSBX,PSBY),-1) Q:PSBY=""  D:'PSBDONE
"RTN","PSBVDLPA",30,0)
 ....S:$P(^PSB(53.79,PSBY,0),U,9)'="N" $P(PSBREC,U,20)=$P(^PSB(53.79,PSBY,0),U,9) S:($P(PSBREC,U,20)'="N")&($P(PSBREC,U,20)]"") $P(PSBREC,U,11)=PSBX,PSBDONE=1
"RTN","PSBVDLPA",31,0)
 .S $P(PSBREC,U,12)=PSBIEN
"RTN","PSBVDLPA",32,0)
 .S $P(PSBREC,U,13)="G"
"RTN","PSBVDLPA",33,0)
 .S $P(PSBREC,U,14)=$P(^PSB(53.79,PSBIEN,.1),U,3)
"RTN","PSBVDLPA",34,0)
 .I $P(PSBREC,U,14)="" S $P(PSBREC,U,14)=PSBNOW\1
"RTN","PSBVDLPA",35,0)
 .S $P(PSBREC,U,15)=PSBOIT
"RTN","PSBVDLPA",36,0)
 .S $P(PSBREC,U,18)="PATCH"
"RTN","PSBVDLPA",37,0)
 .S $P(PSBREC,U,21)=PSBOST
"RTN","PSBVDLPA",38,0)
 .S $P(PSBREC,U,22)=PSBOSTS
"RTN","PSBVDLPA",39,0)
 .S PSBDDS="" F Y=0:0 S Y=$O(PSBDDA(Y)) Q:'Y  S:$P(PSBDDA(Y),U,4)="" $P(PSBDDA(Y),U,4)=1 S PSBDDS=PSBDDS_U_$P(PSBDDA(Y),U,1,4),$P(PSBDDS,U,1)=PSBDDS+1
"RTN","PSBVDLPA",40,0)
 .S PSBQRR=1
"RTN","PSBVDLPA",41,0)
 .D ADD^PSBVDLU1(PSBREC,PSBOTXT,$P(PSBREC,U,14),PSBDDS,"","","UDTAB")
"RTN","PSBVDLPA",42,0)
 Q
"RTN","PSBVDLPB")
0^51^B71736852
"RTN","PSBVDLPB",1,0)
PSBVDLPB ;BIRMINGHAM/EFC-BCMA IV VIRTUAL DUE LIST ;Mar 2004
"RTN","PSBVDLPB",2,0)
 ;;3.0;BAR CODE MED ADMIN;;Mar 2004
"RTN","PSBVDLPB",3,0)
 ;
"RTN","PSBVDLPB",4,0)
 ; Reference/IA
"RTN","PSBVDLPB",5,0)
 ; EN^PSJBCMA/2828
"RTN","PSBVDLPB",6,0)
 ;
"RTN","PSBVDLPB",7,0)
EN(DFN,PSBDT) ; Default Order List Return for Today
"RTN","PSBVDLPB",8,0)
 ;
"RTN","PSBVDLPB",9,0)
 ; RPC: PSB GETORDERLIST
"RTN","PSBVDLPB",10,0)
 ;
"RTN","PSBVDLPB",11,0)
 ; Description:
"RTN","PSBVDLPB",12,0)
 ; Returns the current IV order set for today to display on the
"RTN","PSBVDLPB",13,0)
 ; client VDL
"RTN","PSBVDLPB",14,0)
 ;
"RTN","PSBVDLPB",15,0)
 ;
"RTN","PSBVDLPB",16,0)
 N PSBDATA,PSBTBOUT
"RTN","PSBVDLPB",17,0)
 S PSBTBOUT=0,PSBDOADD=0
"RTN","PSBVDLPB",18,0)
 S:PSBTAB="PBTAB" PSBDOADD=1
"RTN","PSBVDLPB",19,0)
 ;
"RTN","PSBVDLPB",20,0)
 ;This routine now re-uses the ^TMP("PSJ",$J global built in PSBVDLTB
"RTN","PSBVDLPB",21,0)
 ;
"RTN","PSBVDLPB",22,0)
 I $G(^TMP("PSJ",$J,1,0))=-1 Q  ; No orders
"RTN","PSBVDLPB",23,0)
 ;
"RTN","PSBVDLPB",24,0)
 F PSBX=0:0 S PSBX=$O(^TMP("PSJ",$J,PSBX)) Q:('PSBX)!(PSBTBOUT)  D
"RTN","PSBVDLPB",25,0)
 .D CLEAN^PSBVT,PSJ^PSBVT(PSBX)
"RTN","PSBVDLPB",26,0)
 .;
"RTN","PSBVDLPB",27,0)
 .; << Standard checks for ALL orders >>
"RTN","PSBVDLPB",28,0)
 .;
"RTN","PSBVDLPB",29,0)
 .Q:PSBONX["P"  ;     No Pending Orders
"RTN","PSBVDLPB",30,0)
 .Q:'$$IVPTAB^PSBVDLU3(PSBOTYP,PSBIVT,PSBISYR,PSBCHEMT,PSBMR)
"RTN","PSBVDLPB",31,0)
 .Q:PSBOST>PSBWADM  ; Order Start Date/Time > admin window
"RTN","PSBVDLPB",32,0)
 .Q:PSBOSP<PSBWBEG  ; For all Order Stop Date/Time < vdl window
"RTN","PSBVDLPB",33,0)
 .Q:PSBOSTS["D"  ;     Is it DC'd
"RTN","PSBVDLPB",34,0)
 .Q:PSBNGF  ;  Is it marked DO NOT GIVE!
"RTN","PSBVDLPB",35,0)
 .; Non One-Times with stop date/time < now
"RTN","PSBVDLPB",36,0)
 .;
"RTN","PSBVDLPB",37,0)
 .D NOW^%DTC
"RTN","PSBVDLPB",38,0)
 .Q:PSBOSP<%
"RTN","PSBVDLPB",39,0)
 .;
"RTN","PSBVDLPB",40,0)
 .; include Active, Renewed, ReInstated and On Call
"RTN","PSBVDLPB",41,0)
 .; (Is it not one time)&(Is it not active or renewed or On Call)
"RTN","PSBVDLPB",42,0)
 .Q:PSBSCHT'="O"&((PSBOSTS'="A")&(PSBOSTS'="R")&(PSBOSTS'="RE")&(PSBOSTS'="O")&(PSBOSTS'="H"))
"RTN","PSBVDLPB",43,0)
 .;
"RTN","PSBVDLPB",44,0)
 .; Is One Time Given
"RTN","PSBVDLPB",45,0)
 .;
"RTN","PSBVDLPB",46,0)
 .I PSBSCHT="O" D  Q:PSBGVN
"RTN","PSBVDLPB",47,0)
 ..S (PSBGVN,X,Y)=""
"RTN","PSBVDLPB",48,0)
 ..F  S X=$O(^PSB(53.79,"AOIP",DFN,PSBOIT,X),-1) Q:'X  D
"RTN","PSBVDLPB",49,0)
 ...F  S Y=$O(^PSB(53.79,"AOIP",DFN,PSBOIT,X,Y),-1) Q:'Y  S:($P(^PSB(53.79,Y,.1),U)=PSBONX)&($P(^PSB(53.79,Y,0),U,9)="G") PSBGVN=1,(X,Y)=0
"RTN","PSBVDLPB",50,0)
 .;
"RTN","PSBVDLPB",51,0)
 .; How long does One Time remain on VDL ?
"RTN","PSBVDLPB",52,0)
 .S PSBRMN=1
"RTN","PSBVDLPB",53,0)
 .I PSBSCHT="O",PSBOSP'=PSBOST,%>PSBOSP S PSBRMN=0
"RTN","PSBVDLPB",54,0)
 .Q:'PSBRMN
"RTN","PSBVDLPB",55,0)
 .;
"RTN","PSBVDLPB",56,0)
 .; Is On-Call Given, Can it be given more than once
"RTN","PSBVDLPB",57,0)
 .;
"RTN","PSBVDLPB",58,0)
 .I PSBSCHT="OC" D  Q:PSBGVN&('$$GET^XPAR("DIV","PSB ADMIN MULTIPLE ONCALL"))
"RTN","PSBVDLPB",59,0)
 ..S (PSBGVN,X,Y)=""
"RTN","PSBVDLPB",60,0)
 ..F  S X=$O(^PSB(53.79,"AOIP",DFN,PSBOIT,X),-1) Q:'X  D
"RTN","PSBVDLPB",61,0)
 ...F  S Y=$O(^PSB(53.79,"AOIP",DFN,PSBOIT,X,Y),-1) Q:'Y  S:($P(^PSB(53.79,Y,.1),U)=PSBON)&($P(^PSB(53.79,Y,0),U,9)="G") PSBGVN=1,(X,Y)=0
"RTN","PSBVDLPB",62,0)
 .;
"RTN","PSBVDLPB",63,0)
 .S PSBSTRT=PSBOST ; Order Start Date/Time
"RTN","PSBVDLPB",64,0)
 .S PSBSTOP=PSBOSP ; Order Stop Date/Time
"RTN","PSBVDLPB",65,0)
 .;
"RTN","PSBVDLPB",66,0)
 .S PSBREC=""
"RTN","PSBVDLPB",67,0)
 .S $P(PSBREC,U,1)=DFN ; dfn
"RTN","PSBVDLPB",68,0)
 .S $P(PSBREC,U,2)=PSBONX ; Order
"RTN","PSBVDLPB",69,0)
 .S $P(PSBREC,U,3)=+PSBON ; order ien
"RTN","PSBVDLPB",70,0)
 .S $P(PSBREC,U,4)=PSBOTYP ; iv/ud/pending
"RTN","PSBVDLPB",71,0)
 .S $P(PSBREC,U,5)=PSBSCHT ; schedule type
"RTN","PSBVDLPB",72,0)
 .S $P(PSBREC,U,6)=PSBSCH ; schedule
"RTN","PSBVDLPB",73,0)
 .S Y=""
"RTN","PSBVDLPB",74,0)
 .S:PSBSM Y="SM"
"RTN","PSBVDLPB",75,0)
 .S:PSBHSM Y="HSM"
"RTN","PSBVDLPB",76,0)
 .S $P(PSBREC,U,7)=Y ; self med
"RTN","PSBVDLPB",77,0)
 .S $P(PSBREC,U,8)=PSBOITX ; drugname
"RTN","PSBVDLPB",78,0)
 .S $P(PSBREC,U,9)=PSBDOSE_" "_PSBIFR ; dosage
"RTN","PSBVDLPB",79,0)
 .S $P(PSBREC,U,10)=PSBMR ; route
"RTN","PSBVDLPB",80,0)
 .; Last Given from the AOIP X-Ref - not given status not excepted
"RTN","PSBVDLPB",81,0)
 .S (Y,PSBSTUS)="" K PSBHSTA,PSBHSTAX
"RTN","PSBVDLPB",82,0)
 .F XZ=1:1:20 S Y=$O(^PSB(53.79,"AOIP",DFN,PSBOIT,Y),-1),(PSBCNT,PSBFLAG)=0 Q:Y=""  D
"RTN","PSBVDLPB",83,0)
 ..S:Y>0 $P(PSBREC,U,11)=Y
"RTN","PSBVDLPB",84,0)
 ..S X="" F  S X=$O(^PSB(53.79,"AOIP",DFN,PSBOIT,Y,X),-1) Q:X=""  D
"RTN","PSBVDLPB",85,0)
 ...S PSBSTUS=$P(^PSB(53.79,X,0),U,9) I PSBSTUS'="N" S PSBFLAG=1,PSBHSTA(Y,$G(PSBSTUS))="ORIG"_U_X
"RTN","PSBVDLPB",86,0)
 ...D:PSBSTUS="N"
"RTN","PSBVDLPB",87,0)
 ....S $P(PSBREC,U,11)=""
"RTN","PSBVDLPB",88,0)
 ....S Z="" F  S Z=$O(^PSB(53.79,X,.9,Z),-1) Q:'Z  Q:PSBFLAG=1  S PSBDATA=$G(^(Z,0)) D
"RTN","PSBVDLPB",89,0)
 .....I (PSBDATA["Set to 'NOT GIVEN'")!(PSBDATA["Set to 'GIVEN'")!(PSBDATA["Set to 'REFUSED'")!(PSBDATA["Set to 'HELD'")!(PSBDATA["Set to 'MISSING DOSE'")!(PSBDATA["Set to 'REMOVED'") S PSBCNT=PSBCNT+1
"RTN","PSBVDLPB",90,0)
 .....I (PSBDATA["STATUS 'HELD'")!(PSBDATA["STATUS 'GIVEN'")!(PSBDATA["STATUS 'REFUSED'")!(PSBDATA["STATUS 'MISSING DOSE'")!(PSBDATA["STATUS 'REMOVED'") S PSBCNT=PSBCNT+1
"RTN","PSBVDLPB",91,0)
 .....I PSBCNT#2=0,PSBDATA["'REFUSED'" S PSBSTUS="R" D LAST^PSBVDLU1
"RTN","PSBVDLPB",92,0)
 .....I PSBCNT#2=0,PSBDATA["'HELD'" S PSBSTUS="H" D LAST^PSBVDLU1
"RTN","PSBVDLPB",93,0)
 .....I PSBCNT#2=0,PSBDATA["'MISSING DOSE'" S PSBSTUS="M" D LAST^PSBVDLU1
"RTN","PSBVDLPB",94,0)
 .....I PSBCNT#2=0,PSBDATA["'REMOVED'" S PSBSTUS="RM" D LAST^PSBVDLU1
"RTN","PSBVDLPB",95,0)
 .....I PSBFLAG=1,'$D(PSBHSTA($P(PSBREC,U,11),$G(PSBSTUS))) S PSBHSTA($P(PSBREC,U,11),$G(PSBSTUS))=Z_U_X
"RTN","PSBVDLPB",96,0)
 .I $D(PSBHSTA) S $P(PSBREC,U,11)=$O(PSBHSTA(""),-1),PSBSTUS=$O(PSBHSTA($P(PSBREC,U,11),""),-1) M PSBHSTAX(PSBOIT)=PSBHSTA K PSBHSTA  ;last action date/time
"RTN","PSBVDLPB",97,0)
 .S $P(PSBREC,U,12)=""  ;med log ien inserted below for actual date
"RTN","PSBVDLPB",98,0)
 .S $P(PSBREC,U,13)=""  ;med log status inserted below for actual date
"RTN","PSBVDLPB",99,0)
 .S $P(PSBREC,U,14)="" ; admin date inserted below
"RTN","PSBVDLPB",100,0)
 .S $P(PSBREC,U,15)=PSBOIT ; OI Pointer
"RTN","PSBVDLPB",101,0)
 .S $P(PSBREC,U,16)=0  ; Default to not injectable
"RTN","PSBVDLPB",102,0)
 .;Scan for injectable routes
"RTN","PSBVDLPB",103,0)
 .F X="ID","IV","IM","SC","SQ" D  Q:$P(PSBREC,U,16)
"RTN","PSBVDLPB",104,0)
 ..I PSBMR?@(".E1"""_X_""".E") S $P(PSBREC,U,16)=1
"RTN","PSBVDLPB",105,0)
 .; Variable dosage entered as ####-####?
"RTN","PSBVDLPB",106,0)
 .I $P(PSBREC,U,9)?1.4N1"-"1.4N.E S $P(PSBREC,U,17)=1
"RTN","PSBVDLPB",107,0)
 .E  S $P(PSBREC,U,17)=0
"RTN","PSBVDLPB",108,0)
 .S $P(PSBREC,U,18)=PSBIVT  ;IV TYPE - dosage form
"RTN","PSBVDLPB",109,0)
 .S $P(PSBREC,U,20)=PSBSTUS S:$P(PSBREC,U,11)="" $P(PSBREC,U,20)=""
"RTN","PSBVDLPB",110,0)
 .S $P(PSBREC,U,21)=PSBOST
"RTN","PSBVDLPB",111,0)
 .S $P(PSBREC,U,22)=PSBOSTS
"RTN","PSBVDLPB",112,0)
 .;
"RTN","PSBVDLPB",113,0)
 .; Gather Dispense Drugs
"RTN","PSBVDLPB",114,0)
 .D NOW^%DTC
"RTN","PSBVDLPB",115,0)
 .S (PSBDDS,PSBSOLS,PSBADDS)="0"
"RTN","PSBVDLPB",116,0)
 .F Y=0:0 S Y=$O(PSBDDA(Y)) Q:'Y  D
"RTN","PSBVDLPB",117,0)
 ..Q:$P(PSBDDA(Y),U,4)&($P(PSBDDA(Y),U,4)<%)  ; Inactive
"RTN","PSBVDLPB",118,0)
 ..S:$P(PSBDDA(Y),U,3)="" $P(PSBDDA(Y),U,3)=1
"RTN","PSBVDLPB",119,0)
 ..S PSBDDS=PSBDDS_U_$P(PSBDDA(Y),U,1,3)
"RTN","PSBVDLPB",120,0)
 ..S $P(PSBDDS,U,1)=PSBDDS+1
"RTN","PSBVDLPB",121,0)
 .; On-Call One Time PRN orders
"RTN","PSBVDLPB",122,0)
 .S PSBQRR=0
"RTN","PSBVDLPB",123,0)
 .I "^O^OC^P^"[(U_PSBSCHT_U) D  Q
"RTN","PSBVDLPB",124,0)
 ..I 'PSBDOADD S PSBTBOUT=1,^TMP("PSB",$J,"PBTAB",0)=2,^TMP("PSB",$J,"PBTAB",1)=1,^TMP("PSB",$J,"PBTAB",2)=1 Q
"RTN","PSBVDLPB",125,0)
 ..D ADD^PSBVDLU1(PSBREC,PSBOTXT,PSBNOW\1,PSBDDS,PSBSOLS,PSBADDS,"PBTAB")
"RTN","PSBVDLPB",126,0)
 .;
"RTN","PSBVDLPB",127,0)
 .; IV's - don't worry about admin times if blank
"RTN","PSBVDLPB",128,0)
 .I PSBONX["V","PSC"'[PSBIVT,PSBADST="" D  Q
"RTN","PSBVDLPB",129,0)
 ..I 'PSBDOADD S PSBTBOUT=1,^TMP("PSB",$J,"PBTAB",0)=2,^TMP("PSB",$J,"PBTAB",1)=1,^TMP("PSB",$J,"PBTAB",2)=1 Q
"RTN","PSBVDLPB",130,0)
 ..D ADD^PSBVDLU1(PSBREC,PSBOTXT,PSBNOW\1_".",PSBDDS,PSBSOLS,PSBADDS,"PBTAB")
"RTN","PSBVDLPB",131,0)
 .;
"RTN","PSBVDLPB",132,0)
 .; Now we deal with only continuous
"RTN","PSBVDLPB",133,0)
 .; process admintimes
"RTN","PSBVDLPB",134,0)
 .S (PSBYES,PSBODD,PSBYTF)=0
"RTN","PSBVDLPB",135,0)
 .S:$$PSBDCHK1^PSBVT1(PSBSCH) PSBYES=1
"RTN","PSBVDLPB",136,0)
 .I PSBYES,PSBADST="" D ERROR^PSBMLU(PSBONX,PSBOITX,DFN,"Admin times required",PSBSCH) Q
"RTN","PSBVDLPB",137,0)
 .F I=1:1 Q:$P(PSBSCH,"-",I)=""  I $P(PSBSCH,"-",I)?2N!($P(PSBSCH,"-",I)?4N) S PSBYES=1,PSBYTF=1
"RTN","PSBVDLPB",138,0)
 .I PSBSCHT="C",PSBYTF="1",PSBADST="" D ERROR^PSBMLU(PSBONX,PSBOITX,DFN,"Admin times required",PSBSCH) Q
"RTN","PSBVDLPB",139,0)
 .S PSBFREQ=$$GETFREQ^PSBVDLU1(DFN,PSBONX)
"RTN","PSBVDLPB",140,0)
 .I PSBFREQ="O" S PSBFREQ=1440
"RTN","PSBVDLPB",141,0)
 .I PSBFREQ="D" S PSBFREQ=""
"RTN","PSBVDLPB",142,0)
 .I 'PSBYES,PSBFREQ<1 D ERROR^PSBMLU(PSBONX,PSBOITX,DFN,"Invalid frequency received from order",PSBSCH) Q
"RTN","PSBVDLPB",143,0)
 .S PSBADMIN=PSBADST
"RTN","PSBVDLPB",144,0)
 .I (PSBADMIN="")&(+PSBFREQ>0) D ODDSCH^PSBVDLU1("PBTAB") Q  ;calculate admin times based on frequency
"RTN","PSBVDLPB",145,0)
 .; No admin times, MAYDAY MAYDAY!!
"RTN","PSBVDLPB",146,0)
 .I +PSBFREQ>0 I (PSBFREQ#1440'=0),(1440#PSBFREQ'=0) S PSBODD=1
"RTN","PSBVDLPB",147,0)
 .I PSBODD,PSBADST'="" D ERROR^PSBMLU(PSBONX,PSBOITX,DFN,"Administration Times on ODD SCHEDULE",PSBSCH) Q
"RTN","PSBVDLPB",148,0)
 .; process admin times against beginning and ending date
"RTN","PSBVDLPB",149,0)
 .; build all orders for both days.
"RTN","PSBVDLPB",150,0)
 .F PSBY=1:1 Q:$P(PSBADMIN,"-",PSBY)=""  D
"RTN","PSBVDLPB",151,0)
 ..;For invalid admin times
"RTN","PSBVDLPB",152,0)
 ..I ($P(PSBADST,"-",PSBY)'?2N)&($P(PSBADST,"-",PSBY)'?4N) D ERROR^PSBMLU(PSBONX,PSBOITX,DFN,"Invalid Admin times",PSBSCH)
"RTN","PSBVDLPB",153,0)
 ..; apply this time to the beginning window date
"RTN","PSBVDLPB",154,0)
 ..S PSB=+(PSBWBEG\1_"."_$P(PSBADMIN,"-",PSBY))
"RTN","PSBVDLPB",155,0)
 ..D:(PSB'<PSBWBEG)&(PSB'>PSBWEND)  ; Make sure it is in the window
"RTN","PSBVDLPB",156,0)
 ...D:(PSB'<PSBSTRT)&(PSB<PSBSTOP)  ; Make sure this time is active
"RTN","PSBVDLPB",157,0)
 ....D:$$OKAY^PSBVDLU1(PSBSTRT,PSB,PSBSCH,PSBON,PSBOITX,PSBFREQ,PSBOSTS)  ; Okay on this date?
"RTN","PSBVDLPB",158,0)
 .....I 'PSBDOADD S PSBTBOUT=1,^TMP("PSB",$J,"PBTAB",0)=2,^TMP("PSB",$J,"PBTAB",1)=1,^TMP("PSB",$J,"PBTAB",2)=1 Q
"RTN","PSBVDLPB",159,0)
 .....D ADD^PSBVDLU1(PSBREC,PSBOTXT,PSB,PSBDDS,PSBSOLS,PSBADDS,"PBTAB")
"RTN","PSBVDLPB",160,0)
 ..;
"RTN","PSBVDLPB",161,0)
 ..Q:(PSBWBEG\1)=(PSBWEND\1)  ; Window only has one day rare but possible
"RTN","PSBVDLPB",162,0)
 ..;
"RTN","PSBVDLPB",163,0)
 ..; apply this time to the ending window date
"RTN","PSBVDLPB",164,0)
 ..S PSB=+(PSBWEND\1_"."_$P(PSBADMIN,"-",PSBY))
"RTN","PSBVDLPB",165,0)
 ..D:(PSB'<PSBWBEG)&(PSB'>PSBWEND)  ; Make sure it is in the window
"RTN","PSBVDLPB",166,0)
 ...D:(PSB'<PSBSTRT)&(PSB<PSBSTOP)  ; Make sure this time is active
"RTN","PSBVDLPB",167,0)
 ....D:$$OKAY^PSBVDLU1(PSBSTRT,PSB,PSBSCH,PSBON,PSBOITX,PSBFREQ,PSBOSTS)  ; Okay on this date?
"RTN","PSBVDLPB",168,0)
 .....I 'PSBDOADD S PSBTBOUT=1,^TMP("PSB",$J,"PBTAB",0)=2,^TMP("PSB",$J,"PBTAB",1)=1,^TMP("PSB",$J,"PBTAB",2)=1 Q
"RTN","PSBVDLPB",169,0)
 .....D ADD^PSBVDLU1(PSBREC,PSBOTXT,PSB,PSBDDS,PSBSOLS,PSBADDS,"PBTAB")
"RTN","PSBVDLPB",170,0)
 ;
"RTN","PSBVDLPB",171,0)
 ;add initials of verifying pharmacist/verifying nurse
"RTN","PSBVDLPB",172,0)
 D:PSBDOADD VNURSE^PSBVDLU1("PBTAB")
"RTN","PSBVDLPB",173,0)
 Q
"RTN","PSBVDLPB",174,0)
 ;
"RTN","PSBVDLTB")
0^52^B7436456
"RTN","PSBVDLTB",1,0)
PSBVDLTB ;BIRMINGHAM/EFC-BCMA VIRTUAL DUE LIST FUNCTIONS (CONT) ;Mar 2004
"RTN","PSBVDLTB",2,0)
 ;;3.0;BAR CODE MED ADMIN;;Mar 2004
"RTN","PSBVDLTB",3,0)
 ;
"RTN","PSBVDLTB",4,0)
 ; Reference/IA
"RTN","PSBVDLTB",5,0)
 ; EN^PSJBCMA/2828
"RTN","PSBVDLTB",6,0)
 ; IN5^VADPT/10061
"RTN","PSBVDLTB",7,0)
 ;
"RTN","PSBVDLTB",8,0)
RPC(RESULTS,DFN,PSBTAB,PSBDT) ;
"RTN","PSBVDLTB",9,0)
 K RESULTS,^TMP("PSB",$J),^TMP("PSJ",$J)
"RTN","PSBVDLTB",10,0)
 N PSBCNT
"RTN","PSBVDLTB",11,0)
 S PSBTRFL=0
"RTN","PSBVDLTB",12,0)
 S RESULTS=$NAME(^TMP("PSB",$J,PSBTAB))
"RTN","PSBVDLTB",13,0)
 S PSBNOW=+$G(PSBDT)
"RTN","PSBVDLTB",14,0)
 I 'PSBNOW D NOW^%DTC S PSBNOW=+$E(%,1,10),PSBDT=$P(%,".",1)
"RTN","PSBVDLTB",15,0)
 ;
"RTN","PSBVDLTB",16,0)
 ; use fileman function to determine window
"RTN","PSBVDLTB",17,0)
 S PSBWBEG=$$FMADD^XLFDT(PSBNOW,"",-12)
"RTN","PSBVDLTB",18,0)
 S PSBWEND=$$FMADD^XLFDT(PSBNOW,"",12)
"RTN","PSBVDLTB",19,0)
 ;
"RTN","PSBVDLTB",20,0)
 ; Create variable for valid order start date/time against admin window
"RTN","PSBVDLTB",21,0)
 S PSBWADM=$$GET^XPAR("DIV","PSB ADMIN BEFORE")
"RTN","PSBVDLTB",22,0)
 D NOW^%DTC S PSBWADM=$$FMADD^XLFDT(%,"","",+PSBWADM)
"RTN","PSBVDLTB",23,0)
 ;
"RTN","PSBVDLTB",24,0)
 ; use last movement for API
"RTN","PSBVDLTB",25,0)
 S VAIP("D")="LAST" D IN5^VADPT S PSBTRDT=+VAIP(3),PSBTRTYP=$P(VAIP(2),U,2),PSBMVTYP=$P(VAIP(4),U,2) K VAIP
"RTN","PSBVDLTB",26,0)
 ;
"RTN","PSBVDLTB",27,0)
 ;Get patient transfer notification timeframe to determine pop-up box
"RTN","PSBVDLTB",28,0)
 S PSBPTTR=$$GET^XPAR("DIV","PSB PATIENT TRANSFER") I PSBPTTR="" S PSBPTTR=72
"RTN","PSBVDLTB",29,0)
 D NOW^%DTC S PSBNTDT=$$FMADD^XLFDT(%,"",-PSBPTTR) I PSBNTDT'>PSBTRDT S PSBTRFL=1
"RTN","PSBVDLTB",30,0)
 ;determine order type and load to table
"RTN","PSBVDLTB",31,0)
 ;
"RTN","PSBVDLTB",32,0)
 ; Setup the ^TMP("PSJ",$J global for use below 
"RTN","PSBVDLTB",33,0)
 ; Passing PSBDT as 3rd parameter turns off the V.1.0 One-Time lookback
"RTN","PSBVDLTB",34,0)
 D EN^PSJBCMA(DFN,PSBNOW,PSBDT)
"RTN","PSBVDLTB",35,0)
 ;initialize tabs
"RTN","PSBVDLTB",36,0)
 D TABINIT
"RTN","PSBVDLTB",37,0)
 ;
"RTN","PSBVDLTB",38,0)
 ;The following calls must be made in the order below since the ^TMP global is reused
"RTN","PSBVDLTB",39,0)
 D EN^PSBVDLUD(DFN,PSBDT),EN^PSBVDLPB(DFN,PSBDT),EN^PSBVDLIV(DFN,PSBDT)
"RTN","PSBVDLTB",40,0)
 S $P(PSBATAB,U,1)=$S($D(^TMP("PSB",$J,"UDTAB",2))>0:1,1:0)
"RTN","PSBVDLTB",41,0)
 S $P(PSBATAB,U,2)=$S($D(^TMP("PSB",$J,"PBTAB",2))>0:1,1:0)
"RTN","PSBVDLTB",42,0)
 S $P(PSBATAB,U,3)=$S($D(^TMP("PSB",$J,"IVTAB",2))>0:1,1:0)
"RTN","PSBVDLTB",43,0)
 S:PSBTAB="UDTAB" PSBCNT=$O(^TMP("PSB",$J,"UDTAB",""),-1)
"RTN","PSBVDLTB",44,0)
 S:PSBTAB="IVTAB" PSBCNT=$O(^TMP("PSB",$J,"IVTAB",""),-1)
"RTN","PSBVDLTB",45,0)
 S:PSBTAB="PBTAB" PSBCNT=$O(^TMP("PSB",$J,"PBTAB",""),-1)
"RTN","PSBVDLTB",46,0)
 I $G(PSBCNT)>0 S ^TMP("PSB",$J,PSBTAB,0)=PSBCNT
"RTN","PSBVDLTB",47,0)
 I $G(PSBCNT)>1 S ^TMP("PSB",$J,PSBTAB,1)=PSBATAB_U_$S(PSBTRFL:PSBTRTYP_U_PSBMVTYP,1:"")
"RTN","PSBVDLTB",48,0)
 I $G(PSBCNT)'>1 S ^TMP("PSB",$J,PSBTAB,1)=PSBATAB_U_^TMP("PSB",$J,PSBTAB,1)
"RTN","PSBVDLTB",49,0)
 F X="UDTAB","PBTAB","IVTAB" I X'=PSBTAB K ^TMP("PSB",$J,X)
"RTN","PSBVDLTB",50,0)
 D CLEAN^PSBVT K ^TMP("PSJ",$J),PSBATAB,PSBWADM,PSBWBEG,PSBWEND,PSBNOW,PSBTRDT,PSBPTTR,PSBTRFL,PSBNTDT,PSBTRTYP,PSBMVTYP
"RTN","PSBVDLTB",51,0)
 Q
"RTN","PSBVDLTB",52,0)
 ;
"RTN","PSBVDLTB",53,0)
TABINIT ;
"RTN","PSBVDLTB",54,0)
 F PSBX="UDTAB","PBTAB","IVTAB" D
"RTN","PSBVDLTB",55,0)
 .K ^TMP("PSB",$J,PSBX)
"RTN","PSBVDLTB",56,0)
 .S ^TMP("PSB",$J,PSBX,0)=1
"RTN","PSBVDLTB",57,0)
 .S ^TMP("PSB",$J,PSBX,1)="-1^No Administration(s) due at this time." Q
"RTN","PSBVDLTB",58,0)
 ;
"RTN","PSBVDLTB",59,0)
 Q
"RTN","PSBVDLU1")
0^53^B53853310
"RTN","PSBVDLU1",1,0)
PSBVDLU1 ;BIRMINGHAM/EFC-VIRTUAL DUE LIST (VDL) UTILITIES ;Mar 2004
"RTN","PSBVDLU1",2,0)
 ;;3.0;BAR CODE MED ADMIN;;Mar 2004
"RTN","PSBVDLU1",3,0)
 ;
"RTN","PSBVDLU1",4,0)
 ; Reference/IA
"RTN","PSBVDLU1",5,0)
 ; EN^PSJBCMA1/2829
"RTN","PSBVDLU1",6,0)
 ;
"RTN","PSBVDLU1",7,0)
ODDSCH(PSBTABX) ;
"RTN","PSBVDLU1",8,0)
 I (PSBOST'<PSBWBEG)&(PSBOST'>PSBWEND) D ADD(PSBREC,PSBOTXT,PSBOST,PSBDDS,PSBSOLS,PSBADDS,PSBTABX)  ;Include start date/time as admin
"RTN","PSBVDLU1",9,0)
 S PSBQUIT=0,PSBCDT=PSBOST F  S PSBCDT=$$FMADD^XLFDT(PSBCDT,"","",PSBFREQ) Q:PSBQUIT=1  D
"RTN","PSBVDLU1",10,0)
 .I $P(PSBCDT,".",2)="" S PSBCDT=PSBCDT-1_".24"
"RTN","PSBVDLU1",11,0)
 .I PSBCDT>PSBWEND S PSBQUIT=1 Q
"RTN","PSBVDLU1",12,0)
 .I PSBCDT'<PSBWBEG,PSBCDT<PSBOSP D ADD(PSBREC,PSBOTXT,PSBCDT,PSBDDS,PSBSOLS,PSBADDS,PSBTABX) Q
"RTN","PSBVDLU1",13,0)
 Q
"RTN","PSBVDLU1",14,0)
GETFREQ(PSBDFN,PSBORDN) ;
"RTN","PSBVDLU1",15,0)
 K ^TMP("PSJ1",$J)
"RTN","PSBVDLU1",16,0)
 D EN^PSJBCMA1(PSBDFN,PSBORDN,1)
"RTN","PSBVDLU1",17,0)
 S PSBFREQ=$P(^TMP("PSJ1",$J,4),U,11)
"RTN","PSBVDLU1",18,0)
 S PSBSCHBR=$P(^TMP("PSJ1",$J,2),"^",5)
"RTN","PSBVDLU1",19,0)
 I $$PSBDCHK1^PSBVT1(PSBSCHBR) S PSBFREQ=""
"RTN","PSBVDLU1",20,0)
 K ^TMP("PSJ1",$J)
"RTN","PSBVDLU1",21,0)
 Q PSBFREQ
"RTN","PSBVDLU1",22,0)
 ;
"RTN","PSBVDLU1",23,0)
GETADMIN(PSBDFN,PSBORDN,PSBSTRT,PSBFREQ,PSBEVDT) ;
"RTN","PSBVDLU1",24,0)
 ;Determine administration times of an odd schedule for today
"RTN","PSBVDLU1",25,0)
 N PSBADMIN
"RTN","PSBVDLU1",26,0)
 K ^TMP("PSB",$J,"GETADMIN")
"RTN","PSBVDLU1",27,0)
 D EN^PSJBCMA1(PSBDFN,PSBORDN,1)
"RTN","PSBVDLU1",28,0)
 S PSBADMIN=$P(^TMP("PSJ1",$J,4),U,9),PSBFREQ=$P(^TMP("PSJ1",$J,4),U,11),^TMP("PSB",$J,"GETADMIN",0)=PSBADMIN
"RTN","PSBVDLU1",29,0)
 I $E(PSBFREQ)'?1N K ^TMP("PSJ1",$J) Q $G(^TMP("PSB",$J,"GETADMIN",0))
"RTN","PSBVDLU1",30,0)
 I PSBFREQ=0 K ^TMP("PSJ1",$J) Q $G(^TMP("PSB",$J,"GETADMIN",0))
"RTN","PSBVDLU1",31,0)
 I PSBSTRT'<PSBEVDT S PSBADMIN=$E($P(PSBSTRT,".",2)_"0000",1,4),^TMP("PSB",$J,"GETADMIN",0)=PSBADMIN
"RTN","PSBVDLU1",32,0)
 S PSBCDT=PSBSTRT,(PSBADTMX,PSBQUIT)=0 F  S PSBCDT=$$FMADD^XLFDT(PSBCDT,"","",PSBFREQ) D  Q:PSBQUIT=1
"RTN","PSBVDLU1",33,0)
 .I $P(PSBCDT,".",2)="" S PSBCDT=PSBCDT-1_".24"
"RTN","PSBVDLU1",34,0)
 .I (PSBCDT\1)>(PSBEVDT\1) S PSBQUIT=1 Q
"RTN","PSBVDLU1",35,0)
 .I (PSBCDT\1)=(PSBEVDT\1) S PSBADMIN=PSBADMIN_$S(PSBADMIN="":"",1:"-")_$E($P(PSBCDT,".",2)_"0000",1,4)
"RTN","PSBVDLU1",36,0)
 .S ^TMP("PSB",$J,"GETADMIN",PSBADTMX)=PSBADMIN
"RTN","PSBVDLU1",37,0)
 .S:($L(PSBADMIN)+5)>255 PSBADTMX=PSBADTMX+1,PSBADMIN=""
"RTN","PSBVDLU1",38,0)
 K ^TMP("PSJ1",$J),PSBADTMX
"RTN","PSBVDLU1",39,0)
 Q $G(^TMP("PSB",$J,"GETADMIN",0))
"RTN","PSBVDLU1",40,0)
 ;
"RTN","PSBVDLU1",41,0)
ADD(PSBREC,PSBSI,PSBDT,PSBDD,PSBSOL,PSBADD,PSBTAB) ;
"RTN","PSBVDLU1",42,0)
 ;
"RTN","PSBVDLU1",43,0)
 ; Description: Add order to ^TMP("PSB",$J,PSBTAB,...) for RPC Return RESULTS
"RTN","PSBVDLU1",44,0)
 ;
"RTN","PSBVDLU1",45,0)
 ; PSBREC=order hdr from above
"RTN","PSBVDLU1",46,0)
 ; PSBSI=special instructions
"RTN","PSBVDLU1",47,0)
 ; PSBDT=admin date/time
"RTN","PSBVDLU1",48,0)
 ; PSBDD=Dispense Drugs
"RTN","PSBVDLU1",49,0)
 ; PSBSOL=Solutions
"RTN","PSBVDLU1",50,0)
 ; PSBADD=Additives
"RTN","PSBVDLU1",51,0)
 ;
"RTN","PSBVDLU1",52,0)
 N PSB
"RTN","PSBVDLU1",53,0)
 S PSBDT=$E(PSBDT,1,12),PSBQR=0
"RTN","PSBVDLU1",54,0)
 S PSB=$O(^TMP("PSB",$J,PSBTAB,""),-1) ; Get next node
"RTN","PSBVDLU1",55,0)
 S $P(PSBREC,U,14)=PSBDT ; Admin Time sits in ^14
"RTN","PSBVDLU1",56,0)
 I $P(PSBREC,U,5)'="O" S X=$O(^PSB(53.79,"AORD",DFN,PSBONX,PSBDT,0)) D:X
"RTN","PSBVDLU1",57,0)
 .S $P(PSBREC,U,12)=X
"RTN","PSBVDLU1",58,0)
 .S PSBSTUS=$P(^PSB(53.79,X,0),U,9),$P(PSBREC,U,13)=$S(PSBSTUS="N":"",1:PSBSTUS),$P(PSBREC,U,23)=$P(^PSB(53.79,X,0),U,10),$P(PSBREC,U,24)=$P(^PSB(53.79,X,0),U,7)
"RTN","PSBVDLU1",59,0)
 .I $D(^PSB(53.79,X)) I PSBDOSEF="PATCH",PSBSTUS="G",PSBDT=$P(^PSB(53.79,X,.1),U,3),PSBQRR=0 S PSBQR=1
"RTN","PSBVDLU1",60,0)
 .I PSBSTUS="G",$G(PSBFLAG) D CHECK ;Get the correct dispense drug
"RTN","PSBVDLU1",61,0)
 I ($P(PSBREC,U,5)="O") D
"RTN","PSBVDLU1",62,0)
 .S X=$O(^PSB(53.79,"AORDX",DFN,PSBONX,"")) Q:X=""
"RTN","PSBVDLU1",63,0)
 .S Y=$O(^PSB(53.79,"AORDX",DFN,PSBONX,X,"")) Q:Y=""  S $P(PSBREC,U,12)=Y
"RTN","PSBVDLU1",64,0)
 .S PSBSTUS=$P(^PSB(53.79,Y,0),U,9),$P(PSBREC,U,13)=$S(PSBSTUS="N":"",1:PSBSTUS),$P(PSBREC,U,24)=$P(^PSB(53.79,Y,0),U,7)
"RTN","PSBVDLU1",65,0)
 .I $D(^PSB(53.79,Y)) I PSBDOSEF="PATCH",PSBSTUS="G",PSBDT=$P(^PSB(53.79,Y,.1),U,3),PSBQRR=0 S PSBQR=1
"RTN","PSBVDLU1",66,0)
 .I PSBSTUS="G",$G(PSBFLAG) D CHECK
"RTN","PSBVDLU1",67,0)
 Q:PSBQR=1
"RTN","PSBVDLU1",68,0)
 S $P(PSBREC,U,25)=0 I $G(PSBTRFL),$P(PSBREC,U,11)]"",$P(PSBREC,U,11)'<$G(PSBNTDT),$P(PSBREC,U,11)'>$G(PSBTRDT) S $P(PSBREC,U,25)=1
"RTN","PSBVDLU1",69,0)
 S PSB=PSB+1,^TMP("PSB",$J,PSBTAB,PSB)=PSBREC ; Order Hdr
"RTN","PSBVDLU1",70,0)
 S PSB=PSB+1,^TMP("PSB",$J,PSBTAB,PSB)=PSBSI ; Special Instructions
"RTN","PSBVDLU1",71,0)
 ; add dispense drugs
"RTN","PSBVDLU1",72,0)
 I $D(PSBDDA) S X="" F  S X=$O(PSBDDA(X)) Q:X=""  S PSB=PSB+1,^TMP("PSB",$J,PSBTAB,PSB)=PSBDDA(X)
"RTN","PSBVDLU1",73,0)
 S PSBCHDT=0
"RTN","PSBVDLU1",74,0)
 I PSBONX["V",PSBOSTS="D",$G(PSBFOR)="" D  Q  ;get infusing bag from DCed but not DEed orders
"RTN","PSBVDLU1",75,0)
 .D PSJ^PSBVT(PSBX)
"RTN","PSBVDLU1",76,0)
 .D INFUSING^PSBVDLU2 I PSBCOMP=0 Q
"RTN","PSBVDLU1",77,0)
 .I $D(PSBSOLA) S X="" F  S X=$O(PSBSOLA(X)) Q:X=""  S PSB=PSB+1,^TMP("PSB",$J,PSBTAB,PSB)=PSBSOLA(X)
"RTN","PSBVDLU1",78,0)
 .I $D(PSBADA) S X="" F  S X=$O(PSBADA(X)) Q:X=""  S PSB=PSB+1,^TMP("PSB",$J,PSBTAB,PSB)=PSBADA(X)
"RTN","PSBVDLU1",79,0)
 .S X="" F  S X=$O(PSBPORA(PSBONX,X)) S PSBUID=$P(PSBPORA(PSBONX,X),U,1) Q:PSBUID]""  Q:X=""
"RTN","PSBVDLU1",80,0)
 .I PSBUID["P" Q
"RTN","PSBVDLU1",81,0)
 .I PSBUID["WS" D
"RTN","PSBVDLU1",82,0)
 ..S PSBNODE=$O(^PSB(53.79,"AUID",DFN,X,PSBUID,""))
"RTN","PSBVDLU1",83,0)
 ..S PSBUIDA(PSBUID)="ID"_U_PSBUID
"RTN","PSBVDLU1",84,0)
 ..S X=0 F  S X=$O(^PSB(53.79,PSBNODE,.6,X)) Q:'X  S PSBUIDA(PSBUID)=PSBUIDA(PSBUID)_U_"ADD;"_$P(^PSB(53.79,PSBNODE,.6,X,0),U,1)
"RTN","PSBVDLU1",85,0)
 ..S X=0 F  S X=$O(^PSB(53.79,PSBNODE,.7,X)) Q:'X  S PSBUIDA(PSBUID)=PSBUIDA(PSBUID)_U_"SOL;"_$P(^PSB(53.79,PSBNODE,.7,X,0),U,1)
"RTN","PSBVDLU1",86,0)
 .S PSBSONX=PSBONX
"RTN","PSBVDLU1",87,0)
 .I '$D(PSBUIDA(PSBUID)) S PSBCKOR="" F  S PSBCKOR=$O(PSBPORA(PSBSONX,PSBCKOR)) Q:PSBCKOR=""  D CLEAN^PSBVT,PSJ1^PSBVT(DFN,PSBCKOR) Q:$D(PSBUIDA(PSBUID))
"RTN","PSBVDLU1",88,0)
 .S PSBONX=PSBSONX
"RTN","PSBVDLU1",89,0)
 .S:$D(PSBUIDA(PSBUID)) PSB=PSB+2,^TMP("PSB",$J,PSBTAB,PSB-1)=PSBUIDA(PSBUID),^TMP("PSB",$J,PSBTAB,PSB)="END"
"RTN","PSBVDLU1",90,0)
 .D CLEAN^PSBVT,PSJ1^PSBVT(DFN,$O(PSBPORA("")))
"RTN","PSBVDLU1",91,0)
 ; add additives
"RTN","PSBVDLU1",92,0)
 I $D(PSBADA) S X="" F  S X=$O(PSBADA(X)) Q:X=""  S PSB=PSB+1,^TMP("PSB",$J,PSBTAB,PSB)=PSBADA(X)
"RTN","PSBVDLU1",93,0)
 ; add solutions
"RTN","PSBVDLU1",94,0)
 I $D(PSBSOLA) S X="" F  S X=$O(PSBSOLA(X)) Q:X=""  S $P(PSBSOLA(X),U,5)="",PSB=PSB+1,^TMP("PSB",$J,PSBTAB,PSB)=PSBSOLA(X)
"RTN","PSBVDLU1",95,0)
 I PSBONX["V" D EN^PSBPOIV(DFN,PSBONX)  ; get bags
"RTN","PSBVDLU1",96,0)
 I $D(^TMP("PSBAR",$J)) S PSBUID=DFN_"V"_99999 F  S PSBUID=$O(^TMP("PSBAR",$J,PSBUID),-1) Q:PSBUID=""  D
"RTN","PSBVDLU1",97,0)
 .S PSBUIDS=^TMP("PSBAR",$J,PSBUID)
"RTN","PSBVDLU1",98,0)
 .I $P(PSBUIDS,U,1)="I",$P(PSBUIDS,U,2)'="I",$P(PSBUIDS,U,2)'="S" Q  ; bag has invalid IV parameter, is not infusing or stopped
"RTN","PSBVDLU1",99,0)
 .I $P(PSBUIDS,U,2)'="I",$P(PSBUIDS,U,2)'="S",$P(PSBUIDS,U,8)'="" Q  ; label is no longer valid, bag is not infusing or stopped
"RTN","PSBVDLU1",100,0)
 .I $P(PSBUIDS,U,2)="C" Q  ; bag is completed
"RTN","PSBVDLU1",101,0)
 .I $P(PSBUIDS,U,2)="G" Q  ; bag is given (PBTAB)
"RTN","PSBVDLU1",102,0)
 .S PSB=PSB+1,^TMP("PSB",$J,PSBTAB,PSB)=$P(PSBUIDS,U,10,999)
"RTN","PSBVDLU1",103,0)
 K ^TMP("PSBAR",$J)
"RTN","PSBVDLU1",104,0)
 S PSB=PSB+1,^TMP("PSB",$J,PSBTAB,PSB)="END"
"RTN","PSBVDLU1",105,0)
 S ^TMP("PSB",$J,PSBTAB,0)=PSB
"RTN","PSBVDLU1",106,0)
 Q
"RTN","PSBVDLU1",107,0)
 ;
"RTN","PSBVDLU1",108,0)
CHECK S FILE=53.795,PSBNODE=.5,PSBIENS=X_","
"RTN","PSBVDLU1",109,0)
 F I=0:0 S I=$O(^PSB(53.79,X,PSBNODE,I)) Q:'I  S $P(PSBDDS,U,3,4)=$$GET1^DIQ(FILE,I_","_PSBIENS,.01,"I")_U_$$GET1^DIQ(FILE,I_","_PSBIENS,.01)
"RTN","PSBVDLU1",110,0)
 Q
"RTN","PSBVDLU1",111,0)
 ;
"RTN","PSBVDLU1",112,0)
VNURSE(PSBTAB) ;add initials of verifying pharmacist/verifying nurse
"RTN","PSBVDLU1",113,0)
 F PSBLP=1:1:$P(^TMP("PSB",$J,PSBTAB,0),U,1) S X=^TMP("PSB",$J,PSBTAB,PSBLP) I $P(X,U)=DFN D
"RTN","PSBVDLU1",114,0)
 .K ^TMP("PSJ1",$J)
"RTN","PSBVDLU1",115,0)
 .D PSJ1^PSBVT(DFN,$P(X,U,2))
"RTN","PSBVDLU1",116,0)
 .S $P(^TMP("PSB",$J,PSBTAB,PSBLP),U,19)=$S(PSBVNI]"":PSBVNI,1:"***")
"RTN","PSBVDLU1",117,0)
 K PSBLP,PSBTAB
"RTN","PSBVDLU1",118,0)
 Q
"RTN","PSBVDLU1",119,0)
 ;
"RTN","PSBVDLU1",120,0)
OKAY(PSBSTRT,PSBADMIN,PSBSCH,PSBORDER,PSBDRUG,PSBFREQ,PSBOSTS) ;
"RTN","PSBVDLU1",121,0)
 ;
"RTN","PSBVDLU1",122,0)
 ; Description: Determines if an order schedule is valid for
"RTN","PSBVDLU1",123,0)
 ;  the date in PSBADMIN (i.e. Q4D, is it valid today)
"RTN","PSBVDLU1",124,0)
 ;
"RTN","PSBVDLU1",125,0)
 ; PSBSTRT:  Start Date of order (Time ignored)
"RTN","PSBVDLU1",126,0)
 ; PSBADMIN: Date of administration to check (Time ignored)
"RTN","PSBVDLU1",127,0)
 ; PSBSCH:  Schedule (i.e. MO-WE-FR@0900 or Q48H...)
"RTN","PSBVDLU1",128,0)
 ; PSBORDER: Order reference
"RTN","PSBVDLU1",129,0)
 ; PSBDRUG:  Drug ordered (Orderable Item)
"RTN","PSBVDLU1",130,0)
 ; PSBOSTS: The status of the order
"RTN","PSBVDLU1",131,0)
 ;
"RTN","PSBVDLU1",132,0)
 N PSBOKAY,PSBDAYS,PSBDOW
"RTN","PSBVDLU1",133,0)
 S PSBOSTS=$G(PSBOSTS)
"RTN","PSBVDLU1",134,0)
 ;
"RTN","PSBVDLU1",135,0)
 S PSBOKAY=0  ; Default Flag
"RTN","PSBVDLU1",136,0)
 I PSBFREQ'="",PSBFREQ'="D",PSBFREQ'>1440 Q 1
"RTN","PSBVDLU1",137,0)
 ;PRN and ONE TIMES show everyday
"RTN","PSBVDLU1",138,0)
 I (PSBSCHT="P")!(PSBSCHT="O") Q 1
"RTN","PSBVDLU1",139,0)
 S PSBDAYS=$$DAYS(PSBSCH)
"RTN","PSBVDLU1",140,0)
 ;
"RTN","PSBVDLU1",141,0)
 I PSBDAYS=1 S PSBOKAY=1 Q PSBOKAY  ; Order is everyday
"RTN","PSBVDLU1",142,0)
 ;
"RTN","PSBVDLU1",143,0)
 ; find out if today is a good day for multi days
"RTN","PSBVDLU1",144,0)
 S PSBOKAY=0,PSBRDTE=PSBSTRT
"RTN","PSBVDLU1",145,0)
 S PSBADBR=PSBADMIN\1
"RTN","PSBVDLU1",146,0)
 S PSBENR=(PSBADMIN\1)+1
"RTN","PSBVDLU1",147,0)
 I PSBDAYS>1 D  Q PSBOKAY
"RTN","PSBVDLU1",148,0)
 .I PSBADBR=(PSBSTRT\1) S PSBOKAY=1
"RTN","PSBVDLU1",149,0)
 .F  S PSBRDTE=$$FMADD^XLFDT(PSBRDTE,"","",PSBFREQ) Q:PSBRDTE>PSBENR  D
"RTN","PSBVDLU1",150,0)
 ..I $P(PSBRDTE,".",2)="" S PSBRDTE=PSBRDTE-1_".24"
"RTN","PSBVDLU1",151,0)
 ..I PSBRDTE\1=PSBADBR S PSBOKAY=1
"RTN","PSBVDLU1",152,0)
 ..I PSBOKAY="1" Q
"RTN","PSBVDLU1",153,0)
 ;
"RTN","PSBVDLU1",154,0)
 ; Try the MO-WE-FR@0800 thing as last resort
"RTN","PSBVDLU1",155,0)
 S X=PSBADMIN D H^%DTC I %Y=-1 D  Q PSBOKAY  ; Error
"RTN","PSBVDLU1",156,0)
 .S PSBOKAY=0
"RTN","PSBVDLU1",157,0)
 .Q:PSBOSTS="E"
"RTN","PSBVDLU1",158,0)
 .Q:$G(PSBMHND)="PSBOMH"
"RTN","PSBVDLU1",159,0)
 .D ERROR^PSBMLU($G(PSBORDER,"UNKNOWN"),$G(PSBDRUG,""),DFN,"Unable to determine schedule "_PSBSCH,PSBSCH)
"RTN","PSBVDLU1",160,0)
 S PSBDOW=$P("SU^MO^TU^WE^TH^FR^SA",U,%Y+1)
"RTN","PSBVDLU1",161,0)
 I $F(PSBSCH,PSBDOW)>0 S PSBOKAY=1 Q PSBOKAY
"RTN","PSBVDLU1",162,0)
 S PSBOKAY=0
"RTN","PSBVDLU1",163,0)
 Q PSBOKAY
"RTN","PSBVDLU1",164,0)
 ;
"RTN","PSBVDLU1",165,0)
DAYS(PSB) ; Return days between doses (-1: error, 1:everyday 2: QOD...)
"RTN","PSBVDLU1",166,0)
 ;
"RTN","PSBVDLU1",167,0)
 ; Is it a PRN
"RTN","PSBVDLU1",168,0)
 I PSB?.E1"PRN".E Q 1  ; Straight PRN - As Needed
"RTN","PSBVDLU1",169,0)
 ;
"RTN","PSBVDLU1",170,0)
 S PSB=$TR(PSB," ","")
"RTN","PSBVDLU1",171,0)
 I PSB?2.4N.E Q 1
"RTN","PSBVDLU1",172,0)
 S X=PSBFREQ/1440 Q X
"RTN","PSBVDLU1",173,0)
 ;
"RTN","PSBVDLU1",174,0)
 Q
"RTN","PSBVDLU1",175,0)
 ;
"RTN","PSBVDLU1",176,0)
LAST ;
"RTN","PSBVDLU1",177,0)
 S PSBCC=0
"RTN","PSBVDLU1",178,0)
 S ZZ="" F  S ZZ=$O(^PSB(53.79,X,.3,ZZ),-1) Q:'ZZ  Q:PSBFLAG=1  S PSBDATA2=$G(^(ZZ,0)) D
"RTN","PSBVDLU1",179,0)
 .S PSBCC=PSBCC+1
"RTN","PSBVDLU1",180,0)
 .I (PSBCC=2)!($P($P(PSBDATA2,U)," ")="Refused:")!($P($P(PSBDATA2,U)," ")="Held:") S $P(PSBREC,U,11)=$P(PSBDATA2,U,3),PSBFLAG=1
"RTN","PSBVDLU1",181,0)
 Q
"RTN","PSBVDLU1",182,0)
 ;
"RTN","PSBVDLU2")
0^54^B6421023
"RTN","PSBVDLU2",1,0)
PSBVDLU2 ;BIRMINGHAM/EFC-BCMA VDL UTILITIES ;Mar 2004
"RTN","PSBVDLU2",2,0)
 ;;3.0;BAR CODE MED ADMIN;;Mar 2004
"RTN","PSBVDLU2",3,0)
 ;
"RTN","PSBVDLU2",4,0)
 ; Reference/IA
"RTN","PSBVDLU2",5,0)
 ; EN^PSJBCMA1/2829
"RTN","PSBVDLU2",6,0)
 ;
"RTN","PSBVDLU2",7,0)
INFUSING ;  determine if there is any bag not completed on an order or its' previous orders
"RTN","PSBVDLU2",8,0)
 N PSBSONX,PSBSPONX
"RTN","PSBVDLU2",9,0)
 S PSBCOMP=0 K PSBPORA I '$D(PSBPONX) D PSJ1^PSBVT(DFN,PSBONX)
"RTN","PSBVDLU2",10,0)
 S PSBPORA(PSBONX,PSBONX)="",PSBSONX=PSBONX,PSBSPONX=PSBPONX I PSBPONX'="",PSBPONX'["P" S PSBPORA(PSBSONX,PSBPONX)=""
"RTN","PSBVDLU2",11,0)
 F  Q:(PSBPONX="")!(PSBSONX=PSBPONX)  D  Q:^TMP("PSJ1",$J,0)=-1  S PSBPONX=$P(^(0),"^",4) Q:PSBPONX=""  S PSBSPONX=PSBPONX S:(PSBPONX]"")&(PSBPONX'["P") PSBPORA(PSBSONX,PSBPONX)=""
"RTN","PSBVDLU2",12,0)
 .K ^TMP("PSJ1",$J) D EN^PSJBCMA1(DFN,PSBSPONX,1)
"RTN","PSBVDLU2",13,0)
 S X="" F  S X=$O(PSBPORA(PSBONX,X)) Q:X=""  D
"RTN","PSBVDLU2",14,0)
 .S Y=""  F  S Y=$O(^PSB(53.79,"AUID",PSBDFN,X,Y)) Q:Y=""  D
"RTN","PSBVDLU2",15,0)
 ..S Z=$O(^PSB(53.79,"AUID",PSBDFN,X,Y,""))
"RTN","PSBVDLU2",16,0)
 ..I $P(^PSB(53.79,Z,0),U,9)="I"!($P(^PSB(53.79,Z,0),U,9)="S") S PSBCOMP=1,PSBPORA(PSBONX,X)=Y_U_$P(^PSB(53.79,Z,0),U,9),PSBINFDT=$P(^PSB(53.79,Z,0),U,6),PSBINFST=$P(^PSB(53.79,Z,0),U,9)
"RTN","PSBVDLU2",17,0)
 Q
"RTN","PSBVDLU2",18,0)
 ;
"RTN","PSBVDLU2",19,0)
GETWSID(DFN,ORDN) ; generate a uniqe ID for wardstock
"RTN","PSBVDLU2",20,0)
 ;
"RTN","PSBVDLU2",21,0)
 S PSBNUM=0
"RTN","PSBVDLU2",22,0)
 S X="" F  S X=$O(^PSB(53.79,"AUID",DFN,X)) Q:X=""  D
"RTN","PSBVDLU2",23,0)
 .S Y="" F  S Y=$O(^PSB(53.79,"AUID",DFN,X,Y)) Q:Y=""  I Y["WS",$P(Y,"S",2)>PSBNUM S PSBNUM=$P(Y,"S",2)
"RTN","PSBVDLU2",24,0)
 S PSBUID=DFN_"WS"_(PSBNUM+1)
"RTN","PSBVDLU2",25,0)
 Q PSBUID
"RTN","PSBVDLU2",26,0)
 ;
"RTN","PSBVDLU2",27,0)
FNDLBLO(PIN,ORDN,PSBBGID) ;  Return order IV bag was printed for AND setup ^TMP("PSJ1",$J).
"RTN","PSBVDLU2",28,0)
 ;
"RTN","PSBVDLU2",29,0)
 S PSBPIN=PIN,(PSBORD,PSBORDX)=ORDN,FNDLBLO="" K ^TMP("PSJ1",$J) D EN^PSJBCMA1(PSBPIN,PSBORD,1)
"RTN","PSBVDLU2",30,0)
 K PSBXDONE S PSBXDONE(PSBORDX)="" F  Q:(PSBORDX="")  Q:$D(PSBXDONE(PSBORDX))  D
"RTN","PSBVDLU2",31,0)
 .S PSBXDONE(PSBORDX)="" K ^TMP("PSJ1",$J) D EN^PSJBCMA1(PSBPIN,PSBORDX,1)
"RTN","PSBVDLU2",32,0)
 .I $D(^TMP("PSJ1",$J,1000,PSBBGID)) S FNDLBLO=$P(^TMP("PSJ1",$J,0),U,3) S PSBORDX="" Q
"RTN","PSBVDLU2",33,0)
 .E  S FNDLBLO="" S PSBORDX=$P(^TMP("PSJ1",$J,0),U,4)
"RTN","PSBVDLU2",34,0)
 Q $S($G(FNDLBLO)]"":FNDLBLO,$G(FNDLBLO)="":PSBORD)
"RTN","PSBVDLU3")
0^55^B7773577
"RTN","PSBVDLU3",1,0)
PSBVDLU3 ;BIRMINGHAM/TEJ-BCMA VDL UTILITIES 3 ;Mar 2004
"RTN","PSBVDLU3",2,0)
 ;;3.0;BAR CODE MED ADMIN;;Mar 2004
"RTN","PSBVDLU3",3,0)
 ;
"RTN","PSBVDLU3",4,0)
 ;This routine file has been created to serve as a container
"RTN","PSBVDLU3",5,0)
 ;for Extrinsic Variables/Functions
"RTN","PSBVDLU3",6,0)
 ;
"RTN","PSBVDLU3",7,0)
 ; Reference/IA
"RTN","PSBVDLU3",8,0)
 ; EN^PSJBCMA/2828
"RTN","PSBVDLU3",9,0)
 ;
"RTN","PSBVDLU3",10,0)
IVPTAB(PSBORTYP,PSBIVTYP,PSBINTSY,PSBCHMTY,PSBMROUT)  ;
"RTN","PSBVDLU3",11,0)
 ;
"RTN","PSBVDLU3",12,0)
 ; This function will return
"RTN","PSBVDLU3",13,0)
 ; the value 1 (one) if the
"RTN","PSBVDLU3",14,0)
 ; specified order input will cause
"RTN","PSBVDLU3",15,0)
 ; the order to display on the "IVP/IVPB"
"RTN","PSBVDLU3",16,0)
 ; tab of the VDL BCMA Virtual Due List (VDL)
"RTN","PSBVDLU3",17,0)
 ; else return the value 0 (zero).
"RTN","PSBVDLU3",18,0)
 ;
"RTN","PSBVDLU3",19,0)
 ; Input Parameters:
"RTN","PSBVDLU3",20,0)
 ;
"RTN","PSBVDLU3",21,0)
 ;     PSBORTYP - Order type (e.g. "U","V")
"RTN","PSBVDLU3",22,0)
 ;     PSBIVTYP - IV Type (e.g. "P","S","C")
"RTN","PSBVDLU3",23,0)
 ;     PSBINTSY - Intermittent Syringe value
"RTN","PSBVDLU3",24,0)
 ;     PSBCHMTY - Chemo type (e.g. "P","S")
"RTN","PSBVDLU3",25,0)
 ;     PSBMROUT - Med Route value (e.g. "IVP","IV PUSH","IVPB")
"RTN","PSBVDLU3",26,0)
 ;
"RTN","PSBVDLU3",27,0)
 ; Output:
"RTN","PSBVDLU3",28,0)
 ;     1 - order will display on the "IVP/IVPB" Tab of BCMA VDL
"RTN","PSBVDLU3",29,0)
 ;     0 - order will NOT display on the "IVP/IVPB" Tab of BCMA VDL
"RTN","PSBVDLU3",30,0)
 ;    -1 - error processed
"RTN","PSBVDLU3",31,0)
 ;
"RTN","PSBVDLU3",32,0)
 Q:'$D(PSBORTYP) "-1^Missing Parameter"
"RTN","PSBVDLU3",33,0)
 I PSBORTYP="U"&(($G(PSBMROUT)="IV PUSH")!($G(PSBMROUT)="IVP")) Q 1
"RTN","PSBVDLU3",34,0)
 I '(PSBORTYP="V") Q 0
"RTN","PSBVDLU3",35,0)
 I $G(PSBIVTYP)="P" Q 1
"RTN","PSBVDLU3",36,0)
 I $G(PSBIVTYP)="S",$G(PSBINTSY)=1 Q 1
"RTN","PSBVDLU3",37,0)
 I $G(PSBIVTYP)="C",$G(PSBCHMTY)="P" Q 1
"RTN","PSBVDLU3",38,0)
 I $G(PSBIVTYP)="C",$G(PSBCHMTY)="S",$G(PSBINTSY)=1 Q 1
"RTN","PSBVDLU3",39,0)
 Q 0
"RTN","PSBVDLU3",40,0)
 ;
"RTN","PSBVDLU3",41,0)
SHOVDL(DFN,BDATE,OTDATE,PSBTAB) ;
"RTN","PSBVDLU3",42,0)
 ;
"RTN","PSBVDLU3",43,0)
 ; This function will find orders such as discontinued or expired infusing IV bags 
"RTN","PSBVDLU3",44,0)
 ; or discontinued or expired "given" patches.  Recognizing these types of orders
"RTN","PSBVDLU3",45,0)
 ; will allow these orders to be displayed on the VDL and permits the user to take 
"RTN","PSBVDLU3",46,0)
 ; action on them.  This routine determines if such orders exist for patient,
"RTN","PSBVDLU3",47,0)
 ; time, and "BCMA VDL tab."  This routine is an "extention" to the API EN^PSJBCMA.
"RTN","PSBVDLU3",48,0)
 ;
"RTN","PSBVDLU3",49,0)
 ; INPUT Parameters:
"RTN","PSBVDLU3",50,0)
 ;    DFN           (req)   Patient Internal File Number.
"RTN","PSBVDLU3",51,0)
 ;    BDATE         (opt)   Start searching for "order stop" after this date. 
"RTN","PSBVDLU3",52,0)
 ;    OTDATE        (opt)   Include One-Time orders from this date.
"RTN","PSBVDLU3",53,0)
 ;    PSBTAB        (opt)   "UDTAB" or "IVTAB" - expedites process if specific tab
"RTN","PSBVDLU3",54,0)
 ;                            is given.
"RTN","PSBVDLU3",55,0)
 ;
"RTN","PSBVDLU3",56,0)
 ; OUTPUT Values
"RTN","PSBVDLU3",57,0)
 ;    0               absolutely no orders to display on VDL
"RTN","PSBVDLU3",58,0)
 ;    1               displayable orders have been located.
"RTN","PSBVDLU3",59,0)
 ;
"RTN","PSBVDLU3",60,0)
 ;
"RTN","PSBVDLU3",61,0)
 D EN^PSJBCMA(DFN,$G(BDATE),$G(OTDATE))
"RTN","PSBVDLU3",62,0)
 ; any active Patch orders to show on VDL?
"RTN","PSBVDLU3",63,0)
 S PSBFLG=0
"RTN","PSBVDLU3",64,0)
 I $G(^TMP("PSJ",$J,1,0))=-1 D
"RTN","PSBVDLU3",65,0)
 .;  
"RTN","PSBVDLU3",66,0)
 .; Check the indexice for given patches or infusing IVs
"RTN","PSBVDLU3",67,0)
 .;
"RTN","PSBVDLU3",68,0)
 .; Check APATCH
"RTN","PSBVDLU3",69,0)
 .D:($G(PSBTAB)="UDTAB")!($G(PSBTAB)="")  Q:PSBFLG
"RTN","PSBVDLU3",70,0)
 ..S PSBGNODE="^PSB(53.79,"_"""APATCH"""_","_DFN_")" Q:'$D(PSBGNODE)
"RTN","PSBVDLU3",71,0)
 ..F  S PSBGNODE=$Q(@PSBGNODE) Q:PSBGNODE=""  Q:$QS(PSBGNODE,3)'=DFN  Q:PSBFLG  S PSBIEN=$QS(PSBGNODE,5),PSBFLG=$S($P(^PSB(53.79,PSBIEN,0),U,9)="G":1,1:0)
"RTN","PSBVDLU3",72,0)
 .;
"RTN","PSBVDLU3",73,0)
 .; Check AUID
"RTN","PSBVDLU3",74,0)
 .;
"RTN","PSBVDLU3",75,0)
 .D:(($G(PSBTAB)="IVTAB")!($G(PSBTAB)=""))&('PSBFLG)  Q:PSBFLG
"RTN","PSBVDLU3",76,0)
 ..S PSBGNODE="^PSB(53.79,"_"""AUID"""_","_DFN_")" Q:'$D(PSBGNODE)
"RTN","PSBVDLU3",77,0)
 ..F  S PSBGNODE=$Q(@PSBGNODE) Q:PSBGNODE=""  Q:$QS(PSBGNODE,3)'=DFN  Q:PSBFLG  S PSBIEN=$QS(PSBGNODE,6),PSBFLG=$S($P(^PSB(53.79,PSBIEN,0),U,9)="I":1,1:0)
"RTN","PSBVDLU3",78,0)
 .;
"RTN","PSBVDLU3",79,0)
 .;  NOTE: Infusing bags will not display if DCed more than 3 days ago!
"RTN","PSBVDLU3",80,0)
 .;
"RTN","PSBVDLU3",81,0)
 S:$G(^TMP("PSJ",$J,1,0))'=-1 PSBFLG=1
"RTN","PSBVDLU3",82,0)
 ;
"RTN","PSBVDLU3",83,0)
 Q PSBFLG
"RTN","PSBVDLU3",84,0)
 ;
"RTN","PSBVDLUD")
0^56^B65830028
"RTN","PSBVDLUD",1,0)
PSBVDLUD ;BIRMINGHAM/EFC-BCMA UNIT DOSE VIRTUAL DUE LIST FUNCTIONS ;Mar 2004
"RTN","PSBVDLUD",2,0)
 ;;3.0;BAR CODE MED ADMIN;;Mar 2004
"RTN","PSBVDLUD",3,0)
 ;
"RTN","PSBVDLUD",4,0)
 ; Reference/IA
"RTN","PSBVDLUD",5,0)
 ; EN^PSJBCMA/2828
"RTN","PSBVDLUD",6,0)
 ; $$GET^XPAR/2263
"RTN","PSBVDLUD",7,0)
 ;
"RTN","PSBVDLUD",8,0)
EN(DFN,PSBDT) ;
"RTN","PSBVDLUD",9,0)
 ;
"RTN","PSBVDLUD",10,0)
 ;
"RTN","PSBVDLUD",11,0)
 ; Description:
"RTN","PSBVDLUD",12,0)
 ; Returns the current unit dose order set for today to display
"RTN","PSBVDLUD",13,0)
 ; on the client VDL
"RTN","PSBVDLUD",14,0)
 ;
"RTN","PSBVDLUD",15,0)
 N PSBDATA,PSBTBOUT
"RTN","PSBVDLUD",16,0)
 S PSBTBOUT=0
"RTN","PSBVDLUD",17,0)
 ;
"RTN","PSBVDLUD",18,0)
 ;This routine now re-uses the ^TMP("PSJ",$J global built in PSBVDLTB
"RTN","PSBVDLUD",19,0)
 ;
"RTN","PSBVDLUD",20,0)
 G:$G(^TMP("PSJ",$J,1,0))=-1 1
"RTN","PSBVDLUD",21,0)
 F PSBX=0:0 S PSBX=$O(^TMP("PSJ",$J,PSBX)) Q:('PSBX)!(PSBTBOUT)  D
"RTN","PSBVDLUD",22,0)
 .S:(PSBTAB'="UDTAB")&($G(^TMP("PSB",$J,"UDTAB",2))>0) PSBTBOUT=1
"RTN","PSBVDLUD",23,0)
 .D CLEAN^PSBVT
"RTN","PSBVDLUD",24,0)
 .D PSJ^PSBVT(PSBX)
"RTN","PSBVDLUD",25,0)
 .;
"RTN","PSBVDLUD",26,0)
 .; << Standard checks for ALL orders >>
"RTN","PSBVDLUD",27,0)
 .;
"RTN","PSBVDLUD",28,0)
 .Q:PSBONX["V"  ;No IVs on UD tab
"RTN","PSBVDLUD",29,0)
 .Q:PSBONX["P"  ;     No Pending Orders
"RTN","PSBVDLUD",30,0)
 .Q:PSBOST>PSBWADM  ; Order Start Date/Time > admin window
"RTN","PSBVDLUD",31,0)
 .Q:PSBOSP<PSBWBEG  ; For Non one-times Order Stop Date/Time < vdl window
"RTN","PSBVDLUD",32,0)
 .Q:PSBOSTS["D"  ;     Is it DC'd
"RTN","PSBVDLUD",33,0)
 .Q:PSBNGF  ;         Is it marked DO NOT GIVE!
"RTN","PSBVDLUD",34,0)
 .Q:PSBMR="IVP"!(PSBMR="IV PUSH")
"RTN","PSBVDLUD",35,0)
 .;
"RTN","PSBVDLUD",36,0)
 .; Non One-Times with stop date/time < now
"RTN","PSBVDLUD",37,0)
 .;
"RTN","PSBVDLUD",38,0)
 .D NOW^%DTC
"RTN","PSBVDLUD",39,0)
 .Q:PSBOSP<%
"RTN","PSBVDLUD",40,0)
 .;
"RTN","PSBVDLUD",41,0)
 .; include Active, Renewed, ReInstated and On Call
"RTN","PSBVDLUD",42,0)
 .; (Is it not one time)&(Is it not active or renewed or On Call)
"RTN","PSBVDLUD",43,0)
 .I PSBSCHT'="O",PSBOSTS'="A",PSBOSTS'="H",PSBOSTS'="R",PSBOSTS'="RE",PSBOSTS'="O" Q
"RTN","PSBVDLUD",44,0)
 .;
"RTN","PSBVDLUD",45,0)
 .; Is One Time Given
"RTN","PSBVDLUD",46,0)
 .;
"RTN","PSBVDLUD",47,0)
 .I PSBSCHT="O" D  Q:PSBGVN
"RTN","PSBVDLUD",48,0)
 ..S (PSBGVN,X,Y)=""
"RTN","PSBVDLUD",49,0)
 ..F  S X=$O(^PSB(53.79,"AOIP",DFN,PSBOIT,X),-1) Q:'X  D
"RTN","PSBVDLUD",50,0)
 ...F  S Y=$O(^PSB(53.79,"AOIP",DFN,PSBOIT,X,Y),-1) Q:'Y  D
"RTN","PSBVDLUD",51,0)
 ....I $P(^PSB(53.79,Y,.1),U)=PSBONX,$P(^PSB(53.79,Y,0),U,9)="G" S PSBGVN=1,(X,Y)=0
"RTN","PSBVDLUD",52,0)
 .;
"RTN","PSBVDLUD",53,0)
 .; How long does One Time remain on VDL ??
"RTN","PSBVDLUD",54,0)
 .S PSBRMN=1
"RTN","PSBVDLUD",55,0)
 .I PSBSCHT="O",PSBOSP'=PSBOST&(%>PSBOSP) S PSBRMN=0
"RTN","PSBVDLUD",56,0)
 .Q:'PSBRMN
"RTN","PSBVDLUD",57,0)
 .; Is On-Call Given, Can it be given more than once
"RTN","PSBVDLUD",58,0)
 .;
"RTN","PSBVDLUD",59,0)
 .I PSBSCHT="OC" D  Q:PSBGVN&('$$GET^XPAR("DIV","PSB ADMIN MULTIPLE ONCALL"))
"RTN","PSBVDLUD",60,0)
 ..S (PSBGVN,X,Y)=""
"RTN","PSBVDLUD",61,0)
 ..F  S X=$O(^PSB(53.79,"AOIP",DFN,PSBOIT,X),-1) Q:'X  D
"RTN","PSBVDLUD",62,0)
 ...F  S Y=$O(^PSB(53.79,"AOIP",DFN,PSBOIT,X,Y),-1) Q:'Y  D
"RTN","PSBVDLUD",63,0)
 ....I $P(^PSB(53.79,Y,.1),U)=PSBONX,$P(^PSB(53.79,Y,0),U,9)="G" S PSBGVN=1,(X,Y)=0
"RTN","PSBVDLUD",64,0)
 .;
"RTN","PSBVDLUD",65,0)
 .S PSBREC=""
"RTN","PSBVDLUD",66,0)
 .S $P(PSBREC,U,1)=DFN ; dfn
"RTN","PSBVDLUD",67,0)
 .S $P(PSBREC,U,2)=PSBONX ; order
"RTN","PSBVDLUD",68,0)
 .S $P(PSBREC,U,3)=PSBON ; order ien
"RTN","PSBVDLUD",69,0)
 .S $P(PSBREC,U,4)=PSBOTYP ; iv/ud/pending
"RTN","PSBVDLUD",70,0)
 .S $P(PSBREC,U,5)=PSBSCHT ; schedule type
"RTN","PSBVDLUD",71,0)
 .S $P(PSBREC,U,6)=PSBSCH ; schedule
"RTN","PSBVDLUD",72,0)
 .S $P(PSBREC,U,7)=$S(PSBHSM:"HSM",PSBSM:"SM",1:"") ; self med
"RTN","PSBVDLUD",73,0)
 .S $P(PSBREC,U,8)=PSBOITX ; drugname
"RTN","PSBVDLUD",74,0)
 .S $P(PSBREC,U,9)=PSBDOSE_" "_PSBIFR ; dosage
"RTN","PSBVDLUD",75,0)
 .S $P(PSBREC,U,10)=PSBMR ; route
"RTN","PSBVDLUD",76,0)
 .; Last Given from the AOIP X-Ref - not given status not excepted
"RTN","PSBVDLUD",77,0)
 .S (PSBCNT,PSBFLAG)=0,(Y,PSBSTUS)="" K PSBHSTA,PSBHSTAX
"RTN","PSBVDLUD",78,0)
 .F XZ=1:1:20 S Y=$O(^PSB(53.79,"AOIP",DFN,PSBOIT,Y),-1),(PSBCNT,PSBFLAG)=0 Q:Y=""  D
"RTN","PSBVDLUD",79,0)
 ..S:Y>0 $P(PSBREC,U,11)=Y
"RTN","PSBVDLUD",80,0)
 ..S X="" F  S X=$O(^PSB(53.79,"AOIP",DFN,PSBOIT,Y,X),-1) Q:X=""  D
"RTN","PSBVDLUD",81,0)
 ...S PSBSTUS=$P(^PSB(53.79,X,0),U,9) I (PSBSTUS'="N")&(PSBSTUS'="")  S PSBFLAG=1,PSBHSTA(Y,$G(PSBSTUS))="ORIG"_U_X
"RTN","PSBVDLUD",82,0)
 ...D:PSBSTUS="N"
"RTN","PSBVDLUD",83,0)
 ....S $P(PSBREC,U,11)=""
"RTN","PSBVDLUD",84,0)
 ....S Z="" F  S Z=$O(^PSB(53.79,X,.9,Z),-1) Q:'Z  Q:PSBFLAG=1  S PSBDATA=$G(^(Z,0)) D
"RTN","PSBVDLUD",85,0)
 .....I (PSBDATA["Set to 'NOT GIVEN'")!(PSBDATA["Set to 'GIVEN'")!(PSBDATA["Set to 'REFUSED'")!(PSBDATA["Set to 'HELD'")!(PSBDATA["Set to 'MISSING DOSE'")!(PSBDATA["Set to 'REMOVED'") S PSBCNT=PSBCNT+1
"RTN","PSBVDLUD",86,0)
 .....I (PSBDATA["STATUS 'HELD'")!(PSBDATA["STATUS 'GIVEN'")!(PSBDATA["STATUS 'REFUSED'")!(PSBDATA["STATUS 'MISSING DOSE'")!(PSBDATA["STATUS 'REMOVED'") S PSBCNT=PSBCNT+1
"RTN","PSBVDLUD",87,0)
 .....I PSBCNT#2=0,PSBDATA["'REFUSED'" S PSBSTUS="R" D LAST^PSBVDLU1
"RTN","PSBVDLUD",88,0)
 .....I PSBCNT#2=0,PSBDATA["'HELD'" S PSBSTUS="H" D LAST^PSBVDLU1
"RTN","PSBVDLUD",89,0)
 .....I PSBCNT#2=0,PSBDATA["'MISSING DOSE'" S PSBSTUS="M" D LAST^PSBVDLU1
"RTN","PSBVDLUD",90,0)
 .....I PSBCNT#2=0,PSBDATA["'REMOVED'" S PSBSTUS="RM" D LAST^PSBVDLU1
"RTN","PSBVDLUD",91,0)
 .....I PSBFLAG=1,'$D(PSBHSTA($P(PSBREC,U,11),$G(PSBSTUS))) S PSBHSTA($P(PSBREC,U,11),$G(PSBSTUS))=Z_U_X
"RTN","PSBVDLUD",92,0)
 .I $D(PSBHSTA) S $P(PSBREC,U,11)=$O(PSBHSTA(""),-1),PSBSTUS=$O(PSBHSTA($P(PSBREC,U,11),""),-1) M PSBHSTAX(PSBOIT)=PSBHSTA K PSBHSTA  ;last action date/time
"RTN","PSBVDLUD",93,0)
 .S $P(PSBREC,U,12)=""  ;med log ien inserted below for actual date
"RTN","PSBVDLUD",94,0)
 .S $P(PSBREC,U,13)=""  ;med log status inserted below for actual date
"RTN","PSBVDLUD",95,0)
 .S $P(PSBREC,U,14)="" ; admin date inserted below
"RTN","PSBVDLUD",96,0)
 .S $P(PSBREC,U,15)=PSBOIT ; OI Pointer
"RTN","PSBVDLUD",97,0)
 .S $P(PSBREC,U,16)=0  ; Default to not injectable
"RTN","PSBVDLUD",98,0)
 .F X="ID","IV","IM","SC","SQ" D  Q:$P(PSBREC,U,16)
"RTN","PSBVDLUD",99,0)
 ..I PSBMR?@(".E1"""_X_""".E"),PSBMR'["MISC" S $P(PSBREC,U,16)=1
"RTN","PSBVDLUD",100,0)
 .; Variable dosage entered as ####-####?
"RTN","PSBVDLUD",101,0)
 .I $P(PSBREC,U,9)?1.4N1"-"1.4N.E S $P(PSBREC,U,17)=1
"RTN","PSBVDLUD",102,0)
 .E  S $P(PSBREC,U,17)=0
"RTN","PSBVDLUD",103,0)
 .S:PSBDOSEF?1"CAP".E!(PSBDOSEF?1"TAB".E)!(PSBDOSEF="PATCH") $P(PSBREC,U,18)=PSBDOSEF ; dosage form
"RTN","PSBVDLUD",104,0)
 .S $P(PSBREC,U,20)=PSBSTUS S:$P(PSBREC,U,11)="" $P(PSBREC,U,20)=""  ; last action status
"RTN","PSBVDLUD",105,0)
 .S $P(PSBREC,U,21)=PSBOST
"RTN","PSBVDLUD",106,0)
 .S $P(PSBREC,U,22)=PSBOSTS
"RTN","PSBVDLUD",107,0)
 .;
"RTN","PSBVDLUD",108,0)
 .; Gather Dispense Drugs
"RTN","PSBVDLUD",109,0)
 .D NOW^%DTC
"RTN","PSBVDLUD",110,0)
 .S (PSBDDS,PSBSOLS,PSBADDS,PSBFLAG)="0"
"RTN","PSBVDLUD",111,0)
 .F Y=0:0 S Y=$O(PSBDDA(Y)) Q:'Y  D
"RTN","PSBVDLUD",112,0)
 ..I $P(PSBDDA(Y),U,5)=$P(%,".") S PSBFLAG=1 ;If drug was inactivated
"RTN","PSBVDLUD",113,0)
 ..Q:$P(PSBDDA(Y),U,5)&($P(PSBDDA(Y),U,5)<%)  ; Inactive
"RTN","PSBVDLUD",114,0)
 ..S:$P(PSBDDA(Y),U,4)="" $P(PSBDDA(Y),U,4)=1
"RTN","PSBVDLUD",115,0)
 ..S PSBDDS=PSBDDS_U_$P(PSBDDA(Y),U,1,4)
"RTN","PSBVDLUD",116,0)
 ..S $P(PSBDDS,U,1)=PSBDDS+1
"RTN","PSBVDLUD",117,0)
 .;
"RTN","PSBVDLUD",118,0)
 .; On-Call One Time PRN orders
"RTN","PSBVDLUD",119,0)
 .S PSBQRR=0
"RTN","PSBVDLUD",120,0)
 .I "^O^OC^P^"[(U_PSBSCHT_U) D ADD^PSBVDLU1(PSBREC,PSBOTXT,PSBNOW\1,PSBDDS,PSBSOLS,PSBADDS,"UDTAB") Q
"RTN","PSBVDLUD",121,0)
 .;
"RTN","PSBVDLUD",122,0)
 .; Now we deal with only continuous
"RTN","PSBVDLUD",123,0)
 .; process admintimes
"RTN","PSBVDLUD",124,0)
 .; Display an order on the VDL based on the frequency received from IPM **PSB*2.0*3
"RTN","PSBVDLUD",125,0)
 .S (PSBYES,PSBODD,PSBYTF)=0
"RTN","PSBVDLUD",126,0)
 .I PSBSCH="" D ERROR^PSBMLU(PSBONX,PSBOITX,DFN,"No Schedule on this order")
"RTN","PSBVDLUD",127,0)
 .S:$$PSBDCHK1^PSBVT1(PSBSCH) PSBYES=1
"RTN","PSBVDLUD",128,0)
 .I PSBYES,PSBADST="" D ERROR^PSBMLU(PSBONX,PSBOITX,DFN,"Admin times required",PSBSCH) Q
"RTN","PSBVDLUD",129,0)
 .F I=1:1 Q:$P(PSBSCH,"-",I)=""  I $P(PSBSCH,"-",I)?2N!($P(PSBSCH,"-",I)?4N) S PSBYES=1,PSBYTF=1
"RTN","PSBVDLUD",130,0)
 .I PSBSCHT="C",PSBYTF="1",PSBADST="" D ERROR^PSBMLU(PSBONX,PSBOITX,DFN,"Admin times required",PSBSCH) Q
"RTN","PSBVDLUD",131,0)
 .S PSBFREQ=$$GETFREQ^PSBVDLU1(DFN,PSBONX)
"RTN","PSBVDLUD",132,0)
 .I PSBFREQ="O" S PSBFREQ=1440
"RTN","PSBVDLUD",133,0)
 .I PSBFREQ="D" S PSBFREQ=""
"RTN","PSBVDLUD",134,0)
 .I 'PSBYES,PSBFREQ<1 D ERROR^PSBMLU(PSBONX,PSBOITX,DFN,"Invalid frequency received from order",PSBSCH) Q
"RTN","PSBVDLUD",135,0)
 .I (PSBADST="")&(+PSBFREQ>0) D ODDSCH^PSBVDLU1("UDTAB") Q  ;calculate admin times based on frequency
"RTN","PSBVDLUD",136,0)
 .; No admin times, MAYDAY MAYDAY!!
"RTN","PSBVDLUD",137,0)
 .I +PSBFREQ>0 I (PSBFREQ#1440'=0),(1440#PSBFREQ'=0) S PSBODD=1
"RTN","PSBVDLUD",138,0)
 .I PSBODD,PSBADST'="" D ERROR^PSBMLU(PSBONX,PSBOITX,DFN,"Administration Times on ODD SCHEDULE",PSBSCH) Q
"RTN","PSBVDLUD",139,0)
 .; process admin times against beginning and ending date
"RTN","PSBVDLUD",140,0)
 .; build all orders for both days.
"RTN","PSBVDLUD",141,0)
 .F PSBY=1:1 Q:$P(PSBADST,"-",PSBY)=""  D
"RTN","PSBVDLUD",142,0)
 ..;For invalid admin times
"RTN","PSBVDLUD",143,0)
 ..I ($P(PSBADST,"-",PSBY)'?2N)&($P(PSBADST,"-",PSBY)'?4N) D ERROR^PSBMLU(PSBONX,PSBOITX,DFN,"Invalid Admin times",PSBSCH)
"RTN","PSBVDLUD",144,0)
 ..; apply this time to the beginning window date
"RTN","PSBVDLUD",145,0)
 ..S PSB=+(PSBWBEG\1_"."_$P(PSBADST,"-",PSBY))
"RTN","PSBVDLUD",146,0)
 ..D:(PSB'<PSBWBEG)&(PSB'>PSBWEND)  ; Make sure it is in the window
"RTN","PSBVDLUD",147,0)
 ...D:(PSB'<PSBOST)&(PSB<PSBOSP)  ; Make sure this time is active
"RTN","PSBVDLUD",148,0)
 ....D:$$OKAY^PSBVDLU1(PSBOST,PSB,PSBSCH,PSBONX,PSBOITX,PSBFREQ,PSBOSTS)  ; Okay on this date?
"RTN","PSBVDLUD",149,0)
 .....D ADD^PSBVDLU1(PSBREC,PSBOTXT,PSB,PSBDDS,PSBSOLS,PSBADDS,"UDTAB")
"RTN","PSBVDLUD",150,0)
 ..;
"RTN","PSBVDLUD",151,0)
 ..Q:(PSBWBEG\1)=(PSBWEND\1)  ; Window only has one day rare but possible
"RTN","PSBVDLUD",152,0)
 ..;
"RTN","PSBVDLUD",153,0)
 ..; apply this time to the ending window date
"RTN","PSBVDLUD",154,0)
 ..S PSB=+(PSBWEND\1_"."_$P(PSBADST,"-",PSBY))
"RTN","PSBVDLUD",155,0)
 ..D:(PSB'<PSBWBEG)&(PSB'>PSBWEND)  ; Make sure it is in the window
"RTN","PSBVDLUD",156,0)
 ...D:(PSB'<PSBOST)&(PSB<PSBOSP)  ; Make sure this time is active
"RTN","PSBVDLUD",157,0)
 ....D:$$OKAY^PSBVDLU1(PSBOST,PSB,PSBSCH,PSBONX,PSBOITX,PSBFREQ,PSBOSTS)  ; Okay on this date?
"RTN","PSBVDLUD",158,0)
 .....D ADD^PSBVDLU1(PSBREC,PSBOTXT,PSB,PSBDDS,PSBSOLS,PSBADDS,"UDTAB")
"RTN","PSBVDLUD",159,0)
 .K PSBSTUS
"RTN","PSBVDLUD",160,0)
1 K PSBREC D EN^PSBVDLPA
"RTN","PSBVDLUD",161,0)
 ;add initials of verifying pharmacist/verifying nurse
"RTN","PSBVDLUD",162,0)
 D:PSBTAB="UDTAB" VNURSE^PSBVDLU1("UDTAB")
"RTN","PSBVDLUD",163,0)
 D CLEAN^PSBVT
"RTN","PSBVDLUD",164,0)
 Q
"RTN","PSBVDLUD",165,0)
 ;
"RTN","PSBVDLVL")
0^57^B54738502
"RTN","PSBVDLVL",1,0)
PSBVDLVL ;BIRMINGHAM/EFC-BCMA VIRTUAL DUE LIST FUNCTIONS ;Mar 2004
"RTN","PSBVDLVL",2,0)
 ;;3.0;BAR CODE MED ADMIN;;Mar 2004
"RTN","PSBVDLVL",3,0)
 ;
"RTN","PSBVDLVL",4,0)
EN(RESULTS,DFN,PSBIEN,PSBTYPE,PSBADMIN,PSBTAB,PSBUID,PSBASTS,PSBORSTS,PSBRMV) ;
"RTN","PSBVDLVL",5,0)
 ;
"RTN","PSBVDLVL",6,0)
 ; RPC: PSB VALIDATE ORDER
"RTN","PSBVDLVL",7,0)
 ;
"RTN","PSBVDLVL",8,0)
 ; Description: Final check of order against an actual administration
"RTN","PSBVDLVL",9,0)
 ;              date/time used immediately after scanned med has been
"RTN","PSBVDLVL",10,0)
 ;              validated to be a good un-administered order.
"RTN","PSBVDLVL",11,0)
 ;
"RTN","PSBVDLVL",12,0)
 K TEST
"RTN","PSBVDLVL",13,0)
 N PSBFLAG
"RTN","PSBVDLVL",14,0)
 I PSBRMV="I" D GETOHIST^PSBRPC2(.TEST,DFN,PSBIEN_PSBTYPE) S I=0 F  S I=$O(TEST(I)) Q:I=""  I $P(TEST(I),U,5)="I" S RESULTS(0)=1,RESULTS(1)="-2^" K TEST Q
"RTN","PSBVDLVL",15,0)
 K PSBOKAY D CLEAN^PSBVT,PSJ1^PSBVT(DFN,PSBIEN_PSBTYPE) S PSB=0
"RTN","PSBVDLVL",16,0)
 S RESULTS(0)=1,RESULTS(1)="-1^***Unable to determine administration" ; Default Flag will be overwritten by anything
"RTN","PSBVDLVL",17,0)
 D NOW^%DTC
"RTN","PSBVDLVL",18,0)
 I (PSBOSTS="A"!PSBOSTS="R")&(PSBOSP<%) S PSBOSTS="E"
"RTN","PSBVDLVL",19,0)
 I PSBORSTS'=PSBOSTS,((PSBSCHT'="O")&(PSBOSTS'="E")) S PSB=PSB+1,RESULTS(0)=PSB,RESULTS(PSB)="-2^ORDER STATUS MISMATCH" Q
"RTN","PSBVDLVL",20,0)
 I ((PSBTAB="UDTAB")!(PSBTAB="PBTAB")),((PSBRMV="RM")!(PSBRMV="N")) D  Q
"RTN","PSBVDLVL",21,0)
 .S PSB=PSB+1,RESULTS(0)=PSB,RESULTS(PSB)="0^OKAY TO REMOVE"  ;  is a patch removal does not follow rest of validte rules
"RTN","PSBVDLVL",22,0)
 .I PSBASTS="" Q  ;status is not given - don't check for missmatch
"RTN","PSBVDLVL",23,0)
 .I $D(^PSB(53.79,"AORD",DFN,PSBIEN_PSBTYPE,+PSBADMIN)) S X=$O(^PSB(53.79,"AORD",DFN,PSBIEN_PSBTYPE,+PSBADMIN,"")) I $P($G(^PSB(53.79,+X,0)),U,9)'=PSBASTS  S PSB=PSB+1,RESULTS(0)=PSB,RESULTS(PSB)="-2^Admin status mismatch"
"RTN","PSBVDLVL",24,0)
 I PSBTYPE="V",PSBSCHT'="P",((PSBUID="")!(PSBUID["WS")) S RESULTS(0)=1,RESULTS(1)="0^Okay to administer" Q
"RTN","PSBVDLVL",25,0)
 I PSBTYPE="V",PSBUID'="" D  Q:PSBTAB="IVTAB"  ; validate IV bags Piggybacks have additional tests
"RTN","PSBVDLVL",26,0)
 .S PSB=0,PSBSUID=PSBUID D EN^PSBPOIV(DFN,PSBIEN_PSBTYPE)
"RTN","PSBVDLVL",27,0)
 .S X="" F  S X=$O(^TMP("PSBAR",$J,X)) Q:X=""  D
"RTN","PSBVDLVL",28,0)
 ..I PSBSUID'=X Q
"RTN","PSBVDLVL",29,0)
 ..S PSBUIDS=^TMP("PSBAR",$J,X)
"RTN","PSBVDLVL",30,0)
 ..I $P(PSBUIDS,U,2)="I"!($P(PSBUIDS,U,2)="S") S PSB=PSB+1,RESULTS(0)=PSB,RESULTS(PSB)="0^Okay to administer" Q  ; is infusing or stopped
"RTN","PSBVDLVL",31,0)
 ..I $P(PSBUIDS,U,1)="I" S Y=$P(^TMP("PSBAR",$J,"I"),U,2) D DD^%DT S PSB=PSB+1,RESULTS(0)=PSB,RESULTS(PSB)=$P(^TMP("PSBAR",$J,"I"),U,3,99)_"  "_Y Q
"RTN","PSBVDLVL",32,0)
 ..I $P(PSBUIDS,U,1)["W" S PSBWS=$P(PSBUIDS,U,1) F PSBWM=2:1 Q:$P(PSBWS,";",PSBWM)=""  D
"RTN","PSBVDLVL",33,0)
 ...S Y=$P(^TMP("PSBAR",$J,"W",$P(PSBWS,";",PSBWM)),U,2) D DD^%DT S PSB=PSB+1,RESULTS(0)=PSB,RESULTS(PSB)=$P(^TMP("PSBAR",$J,"W",$P(PSBWS,";",PSBWM)),U,3,99)_" "_Y
"RTN","PSBVDLVL",34,0)
 ..S PSB=PSB+1,RESULTS(0)=PSB,RESULTS(PSB)="0^Okay to administer"
"RTN","PSBVDLVL",35,0)
 .K ^TMP("PSBAR",$J)
"RTN","PSBVDLVL",36,0)
 ;
"RTN","PSBVDLVL",37,0)
 ; no IV orders
"RTN","PSBVDLVL",38,0)
 ;
"RTN","PSBVDLVL",39,0)
 D NOW^%DTC
"RTN","PSBVDLVL",40,0)
 I PSBOSTS="H" S PSB=PSB+1,RESULTS(0)=PSB,RESULTS(PSB)="0^Order is on Provider Hold" Q
"RTN","PSBVDLVL",41,0)
 I PSBSCHT'="O"&(%<($$FMADD^XLFDT(PSBOST,"","",$$GET^XPAR("ALL","PSB ADMIN BEFORE")*-1))) S PSB=PSB+1,RESULTS(0)=PSB,RESULTS(PSB)="-1^Order Not Active" Q
"RTN","PSBVDLVL",42,0)
 I PSBSCHT'="O"&(%>PSBOSP) S PSB=PSB+1,RESULTS(0)=PSB,RESULTS(PSB)="-1^Order Not Active" Q
"RTN","PSBVDLVL",43,0)
 I (PSBSCHT="C")!((PSBSCHT="P")&(PSBDOSEF="PATCH")) D
"RTN","PSBVDLVL",44,0)
 .S PSBOKAY="0^Okay to administer"
"RTN","PSBVDLVL",45,0)
 .I PSBOSTS'="A",PSBOSTS'="R",PSBOSTS'="O" S PSBOKAY="-1^Order Not Active" Q
"RTN","PSBVDLVL",46,0)
 .I PSBNGF S PSBOKAY="-1^marked DO NOT GIVE" Q
"RTN","PSBVDLVL",47,0)
 .S PSBFLAG=0 I PSBRMV="M"!(PSBRMV="H")!(PSBRMV="R") S PSBFLAG=1
"RTN","PSBVDLVL",48,0)
 .I $D(^PSB(53.79,"AORDX",DFN,PSBIEN_PSBTYPE)) D  Q:X
"RTN","PSBVDLVL",49,0)
 ..S X=0,PSBLADT=$O(^PSB(53.79,"AORDX",DFN,PSBIEN_PSBTYPE,""),-1),PSBLAIEN=$O(^PSB(53.79,"AORDX",DFN,PSBIEN_PSBTYPE,PSBLADT,""),-1)
"RTN","PSBVDLVL",50,0)
    ..I $P($G(^PSB(53.79,PSBLAIEN,0)),U,9)="G",$P($G(^PSB(53.79,PSBLAIEN,.5,1,0)),U,4)="PATCH",PSBFLAG=0 S X=1,PSBOKAY="-1^Previous patch has not been removed"
"RTN","PSBVDLVL",51,0)
 .I $D(^PSB(53.79,"AORD",DFN,PSBIEN_PSBTYPE,+PSBADMIN)) D  Q:+PSBOKAY=-2
"RTN","PSBVDLVL",52,0)
 ..I PSBASTS="" Q
"RTN","PSBVDLVL",53,0)
 ..S X=$O(^PSB(53.79,"AORD",DFN,PSBIEN_PSBTYPE,+PSBADMIN,""))
"RTN","PSBVDLVL",54,0)
 ..I $P($G(^PSB(53.79,+X,0)),U,9)'=PSBASTS S PSBOKAY="-2^Admin status mismatch"
"RTN","PSBVDLVL",55,0)
 .; Minutes before
"RTN","PSBVDLVL",56,0)
 .S PSBWIN1=$$GET^XPAR("DIV","PSB ADMIN BEFORE")*-1
"RTN","PSBVDLVL",57,0)
 .; Minutes After
"RTN","PSBVDLVL",58,0)
 .S PSBWIN2=$$GET^XPAR("DIV","PSB ADMIN AFTER")
"RTN","PSBVDLVL",59,0)
 .D NOW^%DTC S PSBMIN=$$DIFF^PSBUTL(PSBADMIN,%)
"RTN","PSBVDLVL",60,0)
 .; PENDING A PC SOLUTION!
"RTN","PSBVDLVL",61,0)
 .I PSBMIN<PSBWIN1 S PSBOKAY="1^Admin is "_(PSBMIN*-1)_" minutes before the scheduled administration time" Q
"RTN","PSBVDLVL",62,0)
 .I PSBMIN>PSBWIN2 S PSBOKAY="1^Admin is "_(PSBMIN)_" minutes after the scheduled administration time" Q
"RTN","PSBVDLVL",63,0)
 .S PSBOKAY="0^Okay to administer"
"RTN","PSBVDLVL",64,0)
 ; Validate a PRN Order
"RTN","PSBVDLVL",65,0)
 D:(PSBSCHT="P")
"RTN","PSBVDLVL",66,0)
 .I PSBOSTS'="A",PSBOSTS'="R",PSBOSTS'="O" S PSBOKAY="-1^Order Not Active" Q
"RTN","PSBVDLVL",67,0)
 .I PSBNGF S PSBOKAY="-1^marked DO NOT GIVE" Q
"RTN","PSBVDLVL",68,0)
 .I (+($G(PSBOKAY))<0)&(PSBDOSEF="PATCH") Q  ;A Patch may have to be removed.
"RTN","PSBVDLVL",69,0)
 .S PSBOKAY="1^"
"RTN","PSBVDLVL",70,0)
 .; Get Last Four Givens
"RTN","PSBVDLVL",71,0)
 .S PSBDT=""
"RTN","PSBVDLVL",72,0)
 .F  S PSBDT=$O(^PSB(53.79,"AOIP",DFN,+PSBOIT,PSBDT),-1) Q:PSBDT=""  D
"RTN","PSBVDLVL",73,0)
 ..S PSBDA=""
"RTN","PSBVDLVL",74,0)
 ..F  S PSBDA=$O(^PSB(53.79,"AOIP",DFN,+PSBOIT,PSBDT,PSBDA),-1) Q:'PSBDA  D
"RTN","PSBVDLVL",75,0)
 ...S (PSBCNT1,PSBCNT2,PSBCNT3)=0
"RTN","PSBVDLVL",76,0)
 ...S PSBLADT=$$GET1^DIQ(53.79,PSBDA_",",.06,"I")  ;$P(^PSB(53.79,PSBDA,0),U,6)
"RTN","PSBVDLVL",77,0)
 ...S PSBSTUS=$$GET1^DIQ(53.79,PSBDA_",",.09)
"RTN","PSBVDLVL",78,0)
 ...S PSBSCH=$$GET1^DIQ(53.79,PSBDA_",",.12)
"RTN","PSBVDLVL",79,0)
 ...S PSBRSN=$$GET1^DIQ(53.79,PSBDA_",",.21)
"RTN","PSBVDLVL",80,0)
 ...S PSBINJ=$$GET1^DIQ(53.79,PSBDA_",",.16)
"RTN","PSBVDLVL",81,0)
 ...Q:$P(^PSB(53.79,PSBDA,0),U,9)="N"
"RTN","PSBVDLVL",82,0)
 ...F PSBZ=.5,.6,.7 F PSBY=0:0 S PSBY=$O(^PSB(53.79,PSBDA,PSBZ,PSBY)) Q:'PSBY  D
"RTN","PSBVDLVL",83,0)
 ....Q:'$D(^PSB(53.79,PSBDA,PSBZ,PSBY))
"RTN","PSBVDLVL",84,0)
 ....S PSBDD=$S(PSBZ=.5:53.795,PSBZ=.6:53.796,1:53.797)
"RTN","PSBVDLVL",85,0)
 ....S PSBUNIT=$$GET1^DIQ(PSBDD,PSBY_","_PSBDA_",",.03)
"RTN","PSBVDLVL",86,0)
 ....S PSBUNFR=$$GET1^DIQ(PSBDD,PSBY_","_PSBDA_",",.04)
"RTN","PSBVDLVL",87,0)
 ....I PSBZ=.5 S PSBCNT1=PSBCNT1+1
"RTN","PSBVDLVL",88,0)
 ....I PSBZ=.6 S PSBCNT2=PSBCNT2+1
"RTN","PSBVDLVL",89,0)
 ....I PSBZ=.7 S PSBCNT3=PSBCNT3+1
"RTN","PSBVDLVL",90,0)
 ...;Units given or free text not to display for multiple dispense drugs or additives and solution
"RTN","PSBVDLVL",91,0)
 ...I (PSBCNT1>1)!(PSBCNT2>0)!(PSBCNT3>0) S (PSBUNIT,PSBUNFR)=""
"RTN","PSBVDLVL",92,0)
 ...S X=PSBLADT_U
"RTN","PSBVDLVL",93,0)
 ...S X=X_PSBSTUS_U_PSBSCH_U_$G(PSBRSN)_U_$G(PSBINJ)_U_$G(PSBUNIT)_U_$G(PSBUNFR)
"RTN","PSBVDLVL",94,0)
 ...S PSBOKAY($O(PSBOKAY(""),-1)+1)=3_U_X
"RTN","PSBVDLVL",95,0)
 ...S:$D(PSBOKAY(4)) PSBDT=0
"RTN","PSBVDLVL",96,0)
 ; Validate a One-Time Order
"RTN","PSBVDLVL",97,0)
 D:PSBSCHT="O"
"RTN","PSBVDLVL",98,0)
 .S (PSBGVN,X,Y)=""
"RTN","PSBVDLVL",99,0)
 .F  S X=$O(^PSB(53.79,"AOIP",DFN,PSBOIT,X),-1)  Q:'X  F  S Y=$O(^PSB(53.79,"AOIP",DFN,PSBOIT,X,Y),-1) Q:'Y  I $P(^PSB(53.79,Y,.1),U)=PSBONX,$P(^PSB(53.79,Y,0),U,9)="G" S PSBGVN=1,(X,Y)=0
"RTN","PSBVDLVL",100,0)
 .I PSBGVN S PSBOKAY="-1^Dose Already on medication Log" Q
"RTN","PSBVDLVL",101,0)
 .; One Time are automatically expired so we don't check STATUS here
"RTN","PSBVDLVL",102,0)
 .I PSBNGF S PSBOKAY="-1^marked DO NOT GIVE" Q
"RTN","PSBVDLVL",103,0)
 .S PSBOKAY="0^Okay to administer"
"RTN","PSBVDLVL",104,0)
 ; Validate an On Call Order
"RTN","PSBVDLVL",105,0)
 D:PSBSCHT="OC"
"RTN","PSBVDLVL",106,0)
 .S PSBOKAY="0^Okay to administer"
"RTN","PSBVDLVL",107,0)
 .S (PSBGVN,X,Y)=""
"RTN","PSBVDLVL",108,0)
 .F  S X=$O(^PSB(53.79,"AOIP",DFN,PSBOIT,X),-1)  Q:'X  F  S Y=$O(^PSB(53.79,"AOIP",DFN,PSBOIT,X,Y),-1) Q:'Y  I $P(^PSB(53.79,Y,.1),U)=PSBONX,$P(^PSB(53.79,Y,0),U,9)="G" S PSBGVN=1,(X,Y)=0
"RTN","PSBVDLVL",109,0)
 .I PSBGVN&('$$GET^XPAR("DIV","PSB ADMIN MULTIPLE ONCALL")) S PSBOKAY="-1^Dose Already on medication Log" Q
"RTN","PSBVDLVL",110,0)
 .I PSBOSTS'="A",PSBOSTS'="R",PSBOSTS'="O" S PSBOKAY="-1^Order Not Active" Q
"RTN","PSBVDLVL",111,0)
 .I PSBNGF S PSBOKAY="-1^marked DO NOT GIVE" Q
"RTN","PSBVDLVL",112,0)
 .I PSBGVN&($$GET^XPAR("DIV","PSB ADMIN MULTIPLE ONCALL"))&(PSBDOSEF="PATCH") S PSBOKAY="-1^Previous patch has not been removed" Q
"RTN","PSBVDLVL",113,0)
 .S PSBOKAY="0^Okay to administer"
"RTN","PSBVDLVL",114,0)
 ;
"RTN","PSBVDLVL",115,0)
 D:+PSBOKAY'=-1
"RTN","PSBVDLVL",116,0)
 .N PSBDIFF,Y
"RTN","PSBVDLVL",117,0)
 .D:(PSBSCHT="C")!(PSBSCHT="OC"&('$G(PSBGVN)))
"RTN","PSBVDLVL",118,0)
 ..; On-call or cont and not on the log.
"RTN","PSBVDLVL",119,0)
 ..S Y=$O(^PSB(53.79,"AOIP",DFN,PSBOIT,""),-1)
"RTN","PSBVDLVL",120,0)
 ..S PSBDIFF=$$FMDIFF^XLFDT($$NOW^XLFDT(),Y,2)
"RTN","PSBVDLVL",121,0)
 ..Q:PSBDIFF>7200  ; Greater than 2 hours
"RTN","PSBVDLVL",122,0)
 ..;Check for the status of the medication and insert status in the text
"RTN","PSBVDLVL",123,0)
 ..I Y]"" S X=$O(^PSB(53.79,"AOIP",DFN,+PSBOIT,Y,""),-1),PSBSTUS=$P(^PSB(53.79,X,0),U,9)
"RTN","PSBVDLVL",124,0)
 ..I (PSBSTUS="G")!(PSBSTUS="H")!(PSBSTUS="R")!(PSBSTUS="RM") D
"RTN","PSBVDLVL",125,0)
 ...S PSBSTUS=$S(PSBSTUS="G":"GIVEN",PSBSTUS="H":"HELD",PSBSTUS="R":"REFUSED",PSBSTUS="RM":"REMOVED",1:"")
"RTN","PSBVDLVL",126,0)
 ...I PSBSTUS'="" D
"RTN","PSBVDLVL",127,0)
 ....S Y="1^*** NOTICE, "_PSBOITX_" was "_PSBSTUS_" "_(PSBDIFF\60)_" minutes ago."
"RTN","PSBVDLVL",128,0)
 ....I +PSBOKAY=1 S PSBOKAY(1)=Y
"RTN","PSBVDLVL",129,0)
 ....E  S PSBOKAY=Y
"RTN","PSBVDLVL",130,0)
 ;
"RTN","PSBVDLVL",131,0)
 S PSB=PSB+1,RESULTS(0)=PSB,RESULTS(PSB)=PSBOKAY
"RTN","PSBVDLVL",132,0)
 F X=1:1 Q:'$D(PSBOKAY(X))  S PSB=PSB+1,RESULTS(0)=PSB,RESULTS(PSB)=PSBOKAY(X)
"RTN","PSBVDLVL",133,0)
 Q
"RTN","PSBVDLVL",134,0)
 ;
"RTN","PSBVITFL")
0^58^B4261599
"RTN","PSBVITFL",1,0)
PSBVITFL ;BIRMINGHAM/TEJ-BCMA VITAL MEASUREMENT FILER ;Mar 2004
"RTN","PSBVITFL",2,0)
 ;;3.0;BAR CODE MED ADMIN;;Mar 2004
"RTN","PSBVITFL",3,0)
 ; Reference/IA
"RTN","PSBVITFL",4,0)
 ; STORE^GMRVPCE0/1589
"RTN","PSBVITFL",5,0)
 ; 44/908
"RTN","PSBVITFL",6,0)
 ; 42/10039
"RTN","PSBVITFL",7,0)
 ; 
"RTN","PSBVITFL",8,0)
 ;
"RTN","PSBVITFL",9,0)
 ; Description:
"RTN","PSBVITFL",10,0)
 ; This routine is to service BCMA 3.0 functionality and store VITALs'
"RTN","PSBVITFL",11,0)
 ; data into the VITAL MEASUREMENT FILE - ^GMR(120.5  using the API
"RTN","PSBVITFL",12,0)
 ; GMRVPCE0
"RTN","PSBVITFL",13,0)
 ; 
"RTN","PSBVITFL",14,0)
 ; Parameters:
"RTN","PSBVITFL",15,0)
 ;       Input  -        DFN     (r) Pointer to the PATIENT (#2) file
"RTN","PSBVITFL",16,0)
 ;                       RATE    (r) BCMA trigger event/transaction
"RTN","PSBVITFL",17,0)
 ;                       VTYPE   (o) Pointer to GMRV VITAL TYPE FILE (#120.51)
"RTN","PSBVITFL",18,0)
 ;                                    (default = Pain ["PN"])
"RTN","PSBVITFL",19,0)
 ;                       DTTKN   (o) Date/time (FileMan) measurment was taken 
"RTN","PSBVITFL",20,0)
 ;                                    (default = $$NOW^XLFDT())
"RTN","PSBVITFL",21,0)
 ;                                    
"RTN","PSBVITFL",22,0)
 ;       Output -        RESULTS(0) = 1                                                                                             
"RTN","PSBVITFL",23,0)
 ;                       RESULTS(1) ="1^*** comment ***"                                                              
"RTN","PSBVITFL",24,0)
 ;                 or    RESULTS(1) ="-1^ERROR * Pain Score NOT filed 
"RTN","PSBVITFL",25,0)
 ;                                    successfully"
"RTN","PSBVITFL",26,0)
 ;
"RTN","PSBVITFL",27,0)
 ;       Process results in the storing of VITAL Measurement rate into the VITAL
"RTN","PSBVITFL",28,0)
 ;       MEASUREMENT FILE per the given patient and vital type.
"RTN","PSBVITFL",29,0)
 ;   
"RTN","PSBVITFL",30,0)
RPC(RESULTS,PSBDFN,PSBRATE,PSBVTYPE,PSBDTTKN) ;
"RTN","PSBVITFL",31,0)
 ;
"RTN","PSBVITFL",32,0)
 ; Set up the input array for the API
"RTN","PSBVITFL",33,0)
 ;
"RTN","PSBVITFL",34,0)
 S RESULTS(0)=1,RESULTS(1)="-1^ERROR * "_$S($G(PSBVTYPE)']""!$G(PSBVTYPE)="PN":"Pain Score",1:"Vital Measurement")_" NOT filed successfully"
"RTN","PSBVITFL",35,0)
 S:$G(PSBVTYPE)']"" PSBVTYPE="PN"
"RTN","PSBVITFL",36,0)
 S:$G(PSBDTTKN)']"" PSBDTTKN=$$NOW^XLFDT()
"RTN","PSBVITFL",37,0)
 N DFN S DFN=$G(PSBDFN),VAIP("D")="" D IN5^VADPT S PSBHLOC=^DIC(42,+$G(VAIP(5)),44)
"RTN","PSBVITFL",38,0)
 S GMRVDAT("ENCOUNTER")=U_PSBDFN_U_$G(PSBHLOC)
"RTN","PSBVITFL",39,0)
 S GMRVDAT("SOURCE")=U_$G(DUZ)
"RTN","PSBVITFL",40,0)
 S GMRVDAT("VITALS",$G(DUZ),1)=PSBVTYPE_U_$G(PSBRATE)_U_$G(PSBUNTS)_U_PSBDTTKN
"RTN","PSBVITFL",41,0)
 D STORE^GMRVPCE0(.GMRVDAT)
"RTN","PSBVITFL",42,0)
 I '$D(GMRVDAT("ERROR")) D NOW^%DTC,YX^%DTC S RESULTS(0)=1,RESULTS(1)="1^"_$S($G(PSBVTYPE)="PN":"Pain Score",1:PSBVTYPE)_" entered in Vitals via BCMA taken "_Y
"RTN","PSBVITFL",43,0)
 Q
"RTN","PSBVITFL",44,0)
 ;
"RTN","PSBVT")
0^59^B74909012
"RTN","PSBVT",1,0)
PSBVT ;BIRMINGHAM/EFC-BCMA ORDER VARIABLES UTILITY ;Mar 2004
"RTN","PSBVT",2,0)
 ;;3.0;BAR CODE MED ADMIN;;Mar 2004
"RTN","PSBVT",3,0)
 ;
"RTN","PSBVT",4,0)
 ; Reference/IA
"RTN","PSBVT",5,0)
 ; EN^PSJBCMA1/2829
"RTN","PSBVT",6,0)
 ; ^TMP("PSJ",$J/2828
"RTN","PSBVT",7,0)
 ;
"RTN","PSBVT",8,0)
PSJ(PSBX1) ;
"RTN","PSBVT",9,0)
 K ^PSBORDA($J) M ^PSBORDA($J)=^TMP("PSJ",$J,PSBX1)
"RTN","PSBVT",10,0)
 S PSBDFN=DFN
"RTN","PSBVT",11,0)
 S PSBON=+$P(^PSBORDA($J,0),U,3)  ; order numer without type indicator "U" or "V"
"RTN","PSBVT",12,0)
 S PSBONX=$P(^PSBORDA($J,0),U,3)  ; order number with type indicator
"RTN","PSBVT",13,0)
 S PSBOTYP=$E(PSBONX,$L(PSBONX))
"RTN","PSBVT",14,0)
 S PSBPONX=$P(^PSBORDA($J,0),U,4)  ; previous order number
"RTN","PSBVT",15,0)
 S PSBFON=$P(^PSBORDA($J,0),U,5)  ; following order number
"RTN","PSBVT",16,0)
 S PSBIVT=$P(^PSBORDA($J,0),U,6)  ; IV type
"RTN","PSBVT",17,0)
 S PSBISYR=$P(^PSBORDA($J,0),U,7)  ; intermittent syringe
"RTN","PSBVT",18,0)
 S PSBCHEMT=$P(^PSBORDA($J,0),U,8)  ; chemotherapy type
"RTN","PSBVT",19,0)
 S PSBCPRS=$P(^PSBORDA($J,0),U,9)  ; orders file entry (CPRS order #)
"RTN","PSBVT",20,0)
 S PSBFOR=$P(^PSBORDA($J,0),U,10)  ; reason for following order
"RTN","PSBVT",21,0)
 Q:^PSBORDA($J,0)=-1
"RTN","PSBVT",22,0)
 S PSBMR=$P(^PSBORDA($J,1),U,1)  ; med route IEN
"RTN","PSBVT",23,0)
 S PSBSCHT=$P(^PSBORDA($J,1),U,2)  ; schedule type conversion
"RTN","PSBVT",24,0)
 S PSBSCH=$P(^PSBORDA($J,1),U,3)  ; schedule
"RTN","PSBVT",25,0)
 S PSBOST=$P(^PSBORDA($J,1),U,4)  ; start date FM
"RTN","PSBVT",26,0)
 S PSBOSP=$P(^PSBORDA($J,1),U,5)  ; stop date FM
"RTN","PSBVT",27,0)
 S PSBADST=$P(^PSBORDA($J,1),U,6)  ; admin times strin in NNNN- format
"RTN","PSBVT",28,0)
 S PSBOSTS=$P(^PSBORDA($J,1),U,7)  ; status
"RTN","PSBVT",29,0)
 S PSBNGF=$P(^PSBORDA($J,1),U,8)  ; not to be given flag
"RTN","PSBVT",30,0)
 S PSBOSCHT=$P(^PSBORDA($J,1),U,9)  ; original schedule type
"RTN","PSBVT",31,0)
 S PSBDOSE=$P(^PSBORDA($J,2),U,1)  ; dosage ordered
"RTN","PSBVT",32,0)
 S PSBIFR=$P(^PSBORDA($J,2),U,2)  ; infusion rate
"RTN","PSBVT",33,0)
 S PSBSM=$P(^PSBORDA($J,2),U,3)  ; self med
"RTN","PSBVT",34,0)
 S PSBHSM=$P(^PSBORDA($J,2),U,4)  ; hospital supplied self med
"RTN","PSBVT",35,0)
 S PSBOIT=$P(^PSBORDA($J,3),U,1)  ; orderable item IEN - > ^ORD(101.43)
"RTN","PSBVT",36,0)
 S PSBOITX=$P(^PSBORDA($J,3),U,2)  ; order item (expanded)_" "_dosage form
"RTN","PSBVT",37,0)
 I PSBOITX="" S PSBOITX="ZZZZ NO ORDERABLE ITEM"
"RTN","PSBVT",38,0)
 S PSBDOSEF=$P(^PSBORDA($J,3),U,3)  ; dosage form
"RTN","PSBVT",39,0)
 S PSBOTXT=^PSBORDA($J,4)  ; UD special instructions or IV other print info
"RTN","PSBVT",40,0)
 ; get dispensed drug
"RTN","PSBVT",41,0)
 I $G(^PSBORDA($J,700,0)) F PSBX2=1:1:^PSBORDA($J,700,0) M PSBDDA(PSBX2)=^PSBORDA($J,700,PSBX2,0) S PSBDDA(PSBX2)="DD^"_PSBDDA(PSBX2) ; # of DDrug (UD only)
"RTN","PSBVT",42,0)
 ;     piece 1 = literal "DD"
"RTN","PSBVT",43,0)
 ;     piece 2 = dispensed drug IEN -> ^PSDRUG() DRUG
"RTN","PSBVT",44,0)
 ;     piece 3 = dispensed drug name
"RTN","PSBVT",45,0)
 ;     piece 4 = units per dose
"RTN","PSBVT",46,0)
 ;     piece 5 = inactive date
"RTN","PSBVT",47,0)
 ;
"RTN","PSBVT",48,0)
 ; build unique id list
"RTN","PSBVT",49,0)
 ; add additives
"RTN","PSBVT",50,0)
 I $D(^PSBORDA($J,800)) S PSBX2="" F  S PSBX2=$O(^PSBORDA($J,800,PSBX2)) Q:PSBX2=""!(PSBX2="ERROR")  S PSBUIDA(PSBX2)="ID^"_PSBX2 F J=1:1:^PSBORDA($J,800,PSBX2,0) S PSBUIDA(PSBX2)=PSBUIDA(PSBX2)_"^"_"ADD;"_$P(^PSBORDA($J,800,PSBX2,J),U,1)
"RTN","PSBVT",51,0)
 ; add solutions
"RTN","PSBVT",52,0)
 I $D(^PSBORDA($J,900)) S PSBX2="" F  S PSBX2=$O(^PSBORDA($J,900,PSBX2)) Q:PSBX2=""!(PSBX2="ERROR")  D
"RTN","PSBVT",53,0)
 .I '$D(PSBUIDA(PSBX2)) S PSBUIDA(PSBX2)="ID^"_PSBX2
"RTN","PSBVT",54,0)
 .F J=1:1:^PSBORDA($J,900,PSBX2,0) S PSBUIDA(PSBX2)=PSBUIDA(PSBX2)_"^"_"SOL;"_$P(^PSBORDA($J,900,PSBX2,J),U,1)
"RTN","PSBVT",55,0)
 ;     piece 1 = literal "ID"
"RTN","PSBVT",56,0)
 ;     piece 2,3,... = type;IEN of each additive/solution for this ID ex. "SOL;4"
"RTN","PSBVT",57,0)
 ;
"RTN","PSBVT",58,0)
 ; get additives
"RTN","PSBVT",59,0)
 I $G(^PSBORDA($J,850,0)) F PSBX2=1:1:^PSBORDA($J,850,0) D
"RTN","PSBVT",60,0)
 .M PSBADA(PSBX2)=^PSBORDA($J,850,PSBX2,0)  ; number od additives (exists only for IV)
"RTN","PSBVT",61,0)
 .S PSBADA(PSBX2)="ADD^"_PSBADA(PSBX2)
"RTN","PSBVT",62,0)
 .S PSBBAGS=$P(PSBADA(PSBX2),U,5) I PSBBAGS'="" S PSBBAG=" IN BAG "_$P(PSBBAGS,",",1) F I=2:1 S X=$P(PSBBAGS,",",I) Q:X=""  S PSBBAG=PSBBAG_" AND "_X
"RTN","PSBVT",63,0)
 .S:PSBBAGS'="" $P(PSBADA(PSBX2),U,5)=PSBBAG,$P(PSBADA(PSBX2),U,6)=PSBBAGS
"RTN","PSBVT",64,0)
 ;     piece 1 = literal "ADD"
"RTN","PSBVT",65,0)
 ;     piece 2 = additive IEN -> ^PS(52.6) IV ADDITIVES
"RTN","PSBVT",66,0)
 ;     piece 3 = additive name
"RTN","PSBVT",67,0)
 ;     piece 4 = strength
"RTN","PSBVT",68,0)
 ;     piece 5 = bottle
"RTN","PSBVT",69,0)
 ;
"RTN","PSBVT",70,0)
 ; get solutions
"RTN","PSBVT",71,0)
 I $G(^PSBORDA($J,950,0)) F PSBX2=1:1:^PSBORDA($J,950,0) M PSBSOLA(PSBX2)=^PSBORDA($J,950,PSBX2,0) S PSBSOLA(PSBX2)="SOL^"_PSBSOLA(PSBX2)  ; # of SOLs (IV only)
"RTN","PSBVT",72,0)
 ;   piece 1 = literal "SOL"
"RTN","PSBVT",73,0)
 ;   piece 2 = solution IEN -> ^PS(52.7) IV SOLUTIONS
"RTN","PSBVT",74,0)
 ;   piece 3 = solution name
"RTN","PSBVT",75,0)
 ;   piece 4 = volume
"RTN","PSBVT",76,0)
 ;
"RTN","PSBVT",77,0)
 K ^PSBORDA($J),PSBX1,PSBX2
"RTN","PSBVT",78,0)
 Q
"RTN","PSBVT",79,0)
 ;
"RTN","PSBVT",80,0)
PSJ1(PSBPAR1,PSBPAR2) ; set the variables for an individual order
"RTN","PSBVT",81,0)
 ;
"RTN","PSBVT",82,0)
 ;     PSBPAR1 = DFN
"RTN","PSBVT",83,0)
 ;     PSBPAR2 = ORDNER NUMBER 
"RTN","PSBVT",84,0)
 ;
"RTN","PSBVT",85,0)
 N PSBX
"RTN","PSBVT",86,0)
 K ^TMP("PSJ1",$J) D EN^PSJBCMA1(PSBPAR1,PSBPAR2,1)
"RTN","PSBVT",87,0)
 M ^PSBORDA($J)=^TMP("PSJ1",$J) K ^TMP("PSJ1",$J)
"RTN","PSBVT",88,0)
 S PSBDFN=PSBPAR1
"RTN","PSBVT",89,0)
 S PSBON=+$P(^PSBORDA($J,0),U,3)  ; order numer without type indicator "U" or "V"
"RTN","PSBVT",90,0)
 S PSBONX=$P(^PSBORDA($J,0),U,3)  ; order number with type indicator
"RTN","PSBVT",91,0)
 S PSBOTYP=$E(PSBONX,$L(PSBONX))
"RTN","PSBVT",92,0)
 S PSBPONX=$P(^PSBORDA($J,0),U,4)  ; previous order number
"RTN","PSBVT",93,0)
 S PSBFON=$P(^PSBORDA($J,0),U,5)  ; following order number
"RTN","PSBVT",94,0)
 S PSBIVT=$P(^PSBORDA($J,0),U,6)  ; IV type
"RTN","PSBVT",95,0)
 S PSBISYR=$P(^PSBORDA($J,0),U,7)  ; intermittent syringe
"RTN","PSBVT",96,0)
 S PSBCHEMT=$P(^PSBORDA($J,0),U,8)  ; chemotherapy type
"RTN","PSBVT",97,0)
 S PSBCPRS=$P(^PSBORDA($J,0),U,0)  ; orders file entry (CPRS order #)
"RTN","PSBVT",98,0)
 Q:^PSBORDA($J,0)=-1
"RTN","PSBVT",99,0)
 S PSBMD=$P(^PSBORDA($J,1),U,1)  ; provider IEN -> ^VA(200) NEW PERSON
"RTN","PSBVT",100,0)
 S PSBMDX=$P(^PSBORDA($J,1),U,2)  ; provider name
"RTN","PSBVT",101,0)
 S PSBMR=$P(^PSBORDA($J,1),U,3)  ; med route IEN -> ^PS(51.2) MEDICATION ROUTES
"RTN","PSBVT",102,0)
 I $G(PSBMR)'="" S PSBMR=$P(^PSBORDA($J,1),U,4)
"RTN","PSBVT",103,0)
 S PSBMRAB=$P(^PSBORDA($J,1),U,4)  ;med route abbreviation
"RTN","PSBVT",104,0)
 S PSBSM=$P(^PSBORDA($J,1),U,5)  ; self med
"RTN","PSBVT",105,0)
 S PSBSMX=$P(^PSBORDA($J,1),U,6)  ; expanded to YES/NO
"RTN","PSBVT",106,0)
 S PSBHSM=$P(^PSBORDA($J,1),U,7)  ; hospital supplied self med
"RTN","PSBVT",107,0)
 S PSBHSMX=$P(^PSBORDA($J,1),U,8)  ; expanded to YES/NO
"RTN","PSBVT",108,0)
 S PSBNGF=$P(^PSBORDA($J,1),U,9)  ; not to be given flag
"RTN","PSBVT",109,0)
 S PSBOSTS=$P(^PSBORDA($J,1),U,10)  ; order status
"RTN","PSBVT",110,0)
 S PSBOSTSX=$P(^PSBORDA($J,1),U,11)  ; order status expansion
"RTN","PSBVT",111,0)
 S PSBOIT=$P(^PSBORDA($J,2),U,1)  ; orderable item IEN -> ^ORD(101.43) ORDERABLE ITEM
"RTN","PSBVT",112,0)
 S PSBOITX=$P(^PSBORDA($J,2),U,2)  ; orderable item (expaned)_" "_ dosage form
"RTN","PSBVT",113,0)
 I PSBOITX="" S PSBOITX="ZZZZ NO ORDERABLE ITEM"
"RTN","PSBVT",114,0)
 S PSBDOSE=$P(^PSBORDA($J,2),U,3)  ; dosage ordered
"RTN","PSBVT",115,0)
 S PSBIFR=$P(^PSBORDA($J,2),U,4)  ; infusion rate
"RTN","PSBVT",116,0)
 S PSBSCH=$P(^PSBORDA($J,2),U,5)  ; schedule
"RTN","PSBVT",117,0)
 S PSBDOSEF=$P(^PSBORDA($J,2),U,6)  ; dosage form
"RTN","PSBVT",118,0)
 S PSBOTXT=$P(^PSBORDA($J,3),U,1)  ; UD special instruction or IV other print info
"RTN","PSBVT",119,0)
 S PSBSCHT=$P(^PSBORDA($J,4),U,1)  ; schedule type conversion
"RTN","PSBVT",120,0)
 S PSBSCHTX=$P(^PSBORDA($J,4),U,2)  ; schedule type expansion
"RTN","PSBVT",121,0)
 S PSBLDT=$P(^PSBORDA($J,4),U,3)  ; log-in date FM
"RTN","PSBVT",122,0)
 S PSBLDTX=$P(^PSBORDA($J,4),U,4)  ; expanded MM/DD/YYYY HH:MM
"RTN","PSBVT",123,0)
 S PSBOST=$P(^PSBORDA($J,4),U,5)  ; start date FM
"RTN","PSBVT",124,0)
 S PSBOSTX=$P(^PSBORDA($J,4),U,6)  ; expanded MM/DD/YYYY HH:MM
"RTN","PSBVT",125,0)
 S PSBOSP=$P(^PSBORDA($J,4),U,7)  ; stop date FM
"RTN","PSBVT",126,0)
 S PSBOSPX=$P(^PSBORDA($J,4),U,8) ; expanded MM/DD/YYYY HH:MM
"RTN","PSBVT",127,0)
 S PSBADST=$P(^PSBORDA($J,4),U,9)  ; admin times string in NNNN- format
"RTN","PSBVT",128,0)
 S PSBOSCHT=$P(^PSBORDA($J,4),U,10)  ; original schedule type
"RTN","PSBVT",129,0)
 S PSBFREQ=$P(^PSBORDA($J,4),U,11)  ; frequency
"RTN","PSBVT",130,0)
 S PSBVN=$P(^PSBORDA($J,5),U,1)  ; verifying nurse IEN -> ^VA(200) NEW PERSON
"RTN","PSBVT",131,0)
 S PSBVNX=$P(^PSBORDA($J,5),U,2)  ; nurse name
"RTN","PSBVT",132,0)
 S PSBVNI=$P(^PSBORDA($J,5),U,3) ; nurse initials
"RTN","PSBVT",133,0)
 S PSBVPH=$P(^PSBORDA($J,5),U,4)  ; verifying pharmacist IEN -> ^VA(200) NEW PERSON
"RTN","PSBVT",134,0)
 S PSBVPHX=$P(^PSBORDA($J,5),U,5)  ; pharmacist name
"RTN","PSBVT",135,0)
 S PSBVPHI=$P(^PSBORDA($J,5),U,6)  ; pharmacist initials
"RTN","PSBVT",136,0)
 S PSBRMRK=$G(^PSBORDA($J,6))
"RTN","PSBVT",137,0)
 ;If Day OF Week Schedule set frequency to NULL
"RTN","PSBVT",138,0)
 I $$PSBDCHK1^PSBVT1(PSBSCH) S PSBFREQ=""
"RTN","PSBVT",139,0)
 ; get dispensed drug
"RTN","PSBVT",140,0)
 I $G(^PSBORDA($J,700,0)) F PSBX=1:1:^PSBORDA($J,700,0) M PSBDDA(PSBX)=^PSBORDA($J,700,PSBX,0) S PSBDDA(PSBX)="DD^"_PSBDDA(PSBX) ; # of DDrug (UD only)
"RTN","PSBVT",141,0)
 ;     piece 1 = literal "DD"
"RTN","PSBVT",142,0)
 ;     piece 1 = dispensed drug IEN -> ^PSDRUG() DRUG
"RTN","PSBVT",143,0)
 ;     piece 2 = dispensed drug name
"RTN","PSBVT",144,0)
 ;     piece 3 = units per dose
"RTN","PSBVT",145,0)
 ;     piece 4 = inactive date
"RTN","PSBVT",146,0)
 ;
"RTN","PSBVT",147,0)
 ; build unique id list
"RTN","PSBVT",148,0)
 ; add additives
"RTN","PSBVT",149,0)
 I $D(^PSBORDA($J,800)) S PSBX2="" F  S PSBX2=$O(^PSBORDA($J,800,PSBX2)) Q:PSBX2=""!(PSBX2="ERROR")  S PSBUIDA(PSBX2)="ID^"_PSBX2 F J=1:1:^PSBORDA($J,800,PSBX2,0) S PSBUIDA(PSBX2)=PSBUIDA(PSBX2)_"^"_"ADD;"_$P(^PSBORDA($J,800,PSBX2,J),U,1)
"RTN","PSBVT",150,0)
 ; add solutions
"RTN","PSBVT",151,0)
 I $D(^PSBORDA($J,900)) S PSBX2="" F  S PSBX2=$O(^PSBORDA($J,900,PSBX2)) Q:PSBX2=""!(PSBX2="ERROR")  D
"RTN","PSBVT",152,0)
 .I '$D(PSBUIDA(PSBX2)) S PSBUIDA(PSBX2)="ID^"_PSBX2
"RTN","PSBVT",153,0)
 .F J=1:1:^PSBORDA($J,900,PSBX2,0) S PSBUIDA(PSBX2)=PSBUIDA(PSBX2)_"^"_"SOL;"_$P(^PSBORDA($J,900,PSBX2,J),U,1)
"RTN","PSBVT",154,0)
 ;     piece 1 = literal "ID"
"RTN","PSBVT",155,0)
 ;     piece 2,3,... = type;IEN of each additive/solution for this ID ex. "SOL;4"
"RTN","PSBVT",156,0)
 ;
"RTN","PSBVT",157,0)
 ; get additives
"RTN","PSBVT",158,0)
 I $G(^PSBORDA($J,850,0)) F PSBX=1:1:^PSBORDA($J,850,0) D
"RTN","PSBVT",159,0)
 .M PSBADA(PSBX)=^PSBORDA($J,850,PSBX,0)  ; number od additives (exists only for IV)
"RTN","PSBVT",160,0)
 .S PSBADA(PSBX)="ADD^"_PSBADA(PSBX)
"RTN","PSBVT",161,0)
 .S PSBBAGS=$P(PSBADA(PSBX),U,5) I PSBBAGS'="" S PSBBAG=" IN BAG "_$P(PSBBAGS,",",1) D
"RTN","PSBVT",162,0)
 ..F I=2:1 S X=$P(PSBBAGS,",",I) Q:X=""  S PSBBAG=PSBBAG_" AND "_X
"RTN","PSBVT",163,0)
 .S:PSBBAGS'="" $P(PSBADA(PSBX),U,5)=PSBBAG
"RTN","PSBVT",164,0)
 ;     piece 1 = literal "ADD"
"RTN","PSBVT",165,0)
 ;     piece 2 = additive IEN -> ^PS(52.6) IV ADDITIVES
"RTN","PSBVT",166,0)
 ;     piece 3 = additive name
"RTN","PSBVT",167,0)
 ;     piece 4 = strength
"RTN","PSBVT",168,0)
 ;     piece 5 = bottle
"RTN","PSBVT",169,0)
 ;
"RTN","PSBVT",170,0)
 ; get solutions
"RTN","PSBVT",171,0)
 I $G(^PSBORDA($J,950,0)) F PSBX=1:1:^PSBORDA($J,950,0) M PSBSOLA(PSBX)=^PSBORDA($J,950,PSBX,0) S PSBSOLA(PSBX)="SOL^"_PSBSOLA(PSBX)  ; # of SOLs (IV only)
"RTN","PSBVT",172,0)
 ;   piece 1 = literal "SOL"
"RTN","PSBVT",173,0)
 ;   piece 2 = solution IEN -> ^PS(52.7) IV SOLUTIONS
"RTN","PSBVT",174,0)
 ;   piece 3 = solution name
"RTN","PSBVT",175,0)
 ;   piece 4 = volume
"RTN","PSBVT",176,0)
 ;
"RTN","PSBVT",177,0)
 ; get label info
"RTN","PSBVT",178,0)
 I $D(^PSBORDA($J,1000)) M PSBLBLA=^PSBORDA($J,1000)
"RTN","PSBVT",179,0)
 K ^PSBORDA($J)
"RTN","PSBVT",180,0)
 Q
"RTN","PSBVT",181,0)
 ;
"RTN","PSBVT",182,0)
LACTION ; get last action information
"RTN","PSBVT",183,0)
 S (PSBLADT,PSBLAIEN,PSBLASTS)=""
"RTN","PSBVT",184,0)
 I '$D(^PSB(53.79,"AORDX",PSBDFN,PSBONX)) Q
"RTN","PSBVT",185,0)
 S PSBLADT=$O(^PSB(53.79,"AORDX",PSBDFN,PSBONX,""),-1)
"RTN","PSBVT",186,0)
 S PSBLAIEN=$O(^PSB(53.79,"AORDX",PSBDFN,PSBONX,PSBLADT,""))
"RTN","PSBVT",187,0)
 S PSBLASTS=$P(^PSB(53.79,PSBLAIEN,0),U,9)
"RTN","PSBVT",188,0)
 Q
"RTN","PSBVT",189,0)
 ;
"RTN","PSBVT",190,0)
CLEAN ; kill all the variables defined above
"RTN","PSBVT",191,0)
 ;
"RTN","PSBVT",192,0)
 K PSBONX,PSBPONX,PSBFON,PSBOTYP,PSBIVT,PSBISYR,PSBCHEMT,PSBMD,PSBMDX,PSBMR,PSBMRAB,PSBSM,PSBSMX,PSBHSM,PSBHSMX
"RTN","PSBVT",193,0)
 K PSBDFN,PSBNGF,PSBOSTS,PSBOSTSX,PSBOIT,PSBOITX,PSBDOSE,PSBIFR,PSBSCH,PSBDOSEF,PSBOTXT,PSBSCHT,PSBSCHTX
"RTN","PSBVT",194,0)
 K PSBLDT,PSBLDTX,PSBOST,PSBOSTX,PSBOSP,PSBOSPX,PSBADST,PSBOSCHT,PSBFREQ,PSBVN,PSBVNX,PSBVNI
"RTN","PSBVT",195,0)
 K PSBVPH,PSBVPHX,PSBVPHI,PSBDDA,PSBADA,PSBSOLA,PSBUIDA,PSBCPRS,PSBON,PSBRMRK
"RTN","PSBVT",196,0)
 K PSBLADT,PSBLAIEN,PSBLASTS,PSBBAG,PSBBAGS,PSBLBLA,PSBFOR
"RTN","PSBVT",197,0)
 Q
"RTN","PSBVT1")
0^60^B1122204
"RTN","PSBVT1",1,0)
PSBVT1 ;BIRMINGHAM/BSR-BCMA ORDER VARIABLES UTILITY ;Mar 2004
"RTN","PSBVT1",2,0)
 ;;3.0;BAR CODE MED ADMIN;;Mar 2004
"RTN","PSBVT1",3,0)
 ;
"RTN","PSBVT1",4,0)
PSBDCHK1(PSBSCHV)                   ;
"RTN","PSBVT1",5,0)
 I PSBSCHV="" Q 0
"RTN","PSBVT1",6,0)
 I PSBSCHV["PRN" Q 0
"RTN","PSBVT1",7,0)
 S PSBYEA1="1"
"RTN","PSBVT1",8,0)
 I PSBSCHV["@" S PSBSCHV=$P(PSBSCHV,"@")
"RTN","PSBVT1",9,0)
 I $L(PSBSCHV)<2 Q 0
"RTN","PSBVT1",10,0)
 F S=1:1:7 Q:$P(PSBSCHV,"-",S)=""  I $$PSBDCHK($P(PSBSCHV,"-",S))=0 S PSBYEA1=0  Q
"RTN","PSBVT1",11,0)
 Q PSBYEA1
"RTN","PSBVT1",12,0)
 ;     
"RTN","PSBVT1",13,0)
PSBDCHK(PSBSCHV1)              ;
"RTN","PSBVT1",14,0)
 S PSBYEA=0
"RTN","PSBVT1",15,0)
 S PSBRDOW="SUNDAYS^MONDAYS^TUESDAYS^WEDNESDAYS^THURSDAYS^FRIDAYS^SATURDAYS"
"RTN","PSBVT1",16,0)
 F I=1:1:7 D
"RTN","PSBVT1",17,0)
 .S X=$P(PSBRDOW,"^",I),X1=$L(X),X2=$P(PSBSCHV1,"-",1),X3=$L(X2)  I X3<2 Q
"RTN","PSBVT1",18,0)
 .I $E(X,1,X3)=X2 S PSBYEA=1
"RTN","PSBVT1",19,0)
 Q PSBYEA
"RTN","PSBXMRG")
0^61^B2968246
"RTN","PSBXMRG",1,0)
PSBXMRG ;ROUTINE TO MERGE ENTRIES IN BCMA MED LOG FILE FOR PATIENT MERGE ;Mar 2004
"RTN","PSBXMRG",2,0)
 ;;3.0;BAR CODE MED ADMIN;;Mar 2004
"RTN","PSBXMRG",3,0)
 ;;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","PSBXMRG",4,0)
 ;Reference to EN^XDRMERG is supported by DBIA #2365
"RTN","PSBXMRG",5,0)
 ;Reference to SAVEMERG^XDRMERGB is supported by DBIA #2338
"RTN","PSBXMRG",6,0)
 ;
"RTN","PSBXMRG",7,0)
EN(ARRAY) ; Entry point called with NAME of array containing from, and to entries.
"RTN","PSBXMRG",8,0)
 ;
"RTN","PSBXMRG",9,0)
 N XARRAY,IBDIC,FROMX,TO,FROMX1,TO1,FROM,FRX,TOX
"RTN","PSBXMRG",10,0)
 S XARRAY=$NA(^TMP("PSB",$J))
"RTN","PSBXMRG",11,0)
 K @XARRAY
"RTN","PSBXMRG",12,0)
 S FROM=XARRAY
"RTN","PSBXMRG",13,0)
 S IBDIC=$G(^DIC(53.79,0,"GL"))
"RTN","PSBXMRG",14,0)
 I IBDIC="" Q
"RTN","PSBXMRG",15,0)
 F FROMX=0:0 S FROMX=$O(@ARRAY@(FROMX)) Q:FROMX'>0  D
"RTN","PSBXMRG",16,0)
 . S TO=$O(@ARRAY@(FROMX,0))
"RTN","PSBXMRG",17,0)
 . S FROMX1=$O(@(IBDIC_"""B"",FROMX,0)"))
"RTN","PSBXMRG",18,0)
 . S TO1=$O(@(IBDIC_"""B"",TO,0)"))
"RTN","PSBXMRG",19,0)
 . I TO1="",FROMX1="" Q
"RTN","PSBXMRG",20,0)
 . S TO1=$S(TO1>0:TO1,1:0),FROMX1=$S(FROMX1>0:FROMX1,1:0)
"RTN","PSBXMRG",21,0)
 . S FRX=$O(@ARRAY@(FROMX,TO,"")),TOX=$O(@ARRAY@(FROMX,TO,FRX,TOX))
"RTN","PSBXMRG",22,0)
 . S @XARRAY@(FROMX1,TO1,FRX,TOX)=""
"RTN","PSBXMRG",23,0)
 . I FROMX1=0 D  Q
"RTN","PSBXMRG",24,0)
 . . D SAVEMERG^XDRMERGB(53.79,FROMX1,TO1)
"RTN","PSBXMRG",25,0)
 . . K @XARRAY@(FROMX1,TO1)
"RTN","PSBXMRG",26,0)
 . I TO1=0 D  Q
"RTN","PSBXMRG",27,0)
 . . D SAVEMERG^XDRMERGB(53.79,FROMX1,TO1)
"RTN","PSBXMRG",28,0)
 . . K @XARRAY@(FROMX1,TO1)
"RTN","PSBXMRG",29,0)
 . . N IBDXXX
"RTN","PSBXMRG",30,0)
 . . S IBDXXX(53.79,(FROMX1_","),.01)=TO
"RTN","PSBXMRG",31,0)
 . . D UPDATE^DIE("","IBDXXX")
"RTN","PSBXMRG",32,0)
 I '$D(@XARRAY) Q
"RTN","PSBXMRG",33,0)
 D EN^XDRMERG(53.79,"XARRAY") ; NOW CONVERT ANY POINTERS TO THE MERGED ENTRIES
"RTN","PSBXMRG",34,0)
 S IBDIC=$G(^DIC(53.79,0,"GL"))
"RTN","PSBXMRG",35,0)
 I IBDIC'="" D
"RTN","PSBXMRG",36,0)
 . F FROMX=0:0 S FROMX=$O(@XARRAY@(FROMX)) Q:FROMX'>0  K @(IBDIC_FROMX_")")
"RTN","PSBXMRG",37,0)
 Q
"SEC","^DIC",53.66,53.66,0,"AUDIT")
@
"SEC","^DIC",53.66,53.66,0,"DD")
@
"SEC","^DIC",53.66,53.66,0,"DEL")
@
"SEC","^DIC",53.66,53.66,0,"LAYGO")
@
"SEC","^DIC",53.66,53.66,0,"RD")
@
"SEC","^DIC",53.66,53.66,0,"WR")
@
"SEC","^DIC",53.68,53.68,0,"AUDIT")
@
"SEC","^DIC",53.68,53.68,0,"DD")
@
"SEC","^DIC",53.68,53.68,0,"DEL")
@
"SEC","^DIC",53.68,53.68,0,"LAYGO")
@
"SEC","^DIC",53.68,53.68,0,"WR")
@
"SEC","^DIC",53.69,53.69,0,"AUDIT")
@
"SEC","^DIC",53.69,53.69,0,"DD")
@
"SEC","^DIC",53.69,53.69,0,"DEL")
@
"SEC","^DIC",53.69,53.69,0,"LAYGO")
@
"SEC","^DIC",53.69,53.69,0,"WR")
@
"SEC","^DIC",53.78,53.78,0,"AUDIT")
@
"SEC","^DIC",53.78,53.78,0,"DD")
@
"SEC","^DIC",53.78,53.78,0,"DEL")
@
"SEC","^DIC",53.78,53.78,0,"LAYGO")
@
"SEC","^DIC",53.78,53.78,0,"RD")
@
"SEC","^DIC",53.78,53.78,0,"WR")
@
"SEC","^DIC",53.79,53.79,0,"AUDIT")
@
"SEC","^DIC",53.79,53.79,0,"DD")
@
"SEC","^DIC",53.79,53.79,0,"DEL")
@
"SEC","^DIC",53.79,53.79,0,"LAYGO")
@
"SEC","^DIC",53.79,53.79,0,"WR")
@
"VER")
8.0^22.0
"^DD",53.66,53.66,0)
FIELD^^.05^3
"^DD",53.66,53.66,0,"DDA")
N
"^DD",53.66,53.66,0,"DT")
3020426
"^DD",53.66,53.66,0,"IX","B",53.66,.01)

"^DD",53.66,53.66,0,"NM","BCMA IV PARAMETERS")

"^DD",53.66,53.66,0,"VRPK")
PSB
"^DD",53.66,53.66,.01,0)
WARD^RP42'^DIC(42,^0;1^Q
"^DD",53.66,53.66,.01,1,0)
^.1
"^DD",53.66,53.66,.01,1,1,0)
53.66^B
"^DD",53.66,53.66,.01,1,1,1)
S ^PSB(53.66,"B",$E(X,1,30),DA)=""
"^DD",53.66,53.66,.01,1,1,2)
K ^PSB(53.66,"B",$E(X,1,30),DA)
"^DD",53.66,53.66,.01,3)
ENTER A WARD FROM THE WARD LOCATION FILE
"^DD",53.66,53.66,.01,21,0)
^^1^1^3010831^
"^DD",53.66,53.66,.01,21,1,0)
The name of the ward that IV parameters are defined for.
"^DD",53.66,53.66,.01,"DT")
3010831
"^DD",53.66,53.66,.03,0)
INSTITUTION^RP4'^DIC(4,^0;2^Q
"^DD",53.66,53.66,.03,21,0)
^^1^1^3010831^
"^DD",53.66,53.66,.03,21,1,0)
The institution that this ward is associated with.
"^DD",53.66,53.66,.03,"DT")
3010831
"^DD",53.66,53.66,.05,0)
IV TYPE^53.67SA^^1;0
"^DD",53.66,53.66,.05,21,0)
^.001^1^1^3010918^^^^
"^DD",53.66,53.66,.05,21,1,0)
The IV type - Admixture; Chemotherapy; Hyperal; Piggyback; or Syringe.
"^DD",53.66,53.67,0)
IV TYPE SUB-FIELD^^70^16
"^DD",53.66,53.67,0,"DT")
3020426
"^DD",53.66,53.67,0,"IX","B",53.67,.01)

"^DD",53.66,53.67,0,"NM","IV TYPE")

"^DD",53.66,53.67,0,"UP")
53.66
"^DD",53.66,53.67,.01,0)
IV TYPE^S^A:ADMIXTURE;C:CHEMOTHERAPY;H:HYPERAL;P:PIGGYBACK;S:SYRINGE;^0;1^Q
"^DD",53.66,53.67,.01,1,0)
^.1
"^DD",53.66,53.67,.01,1,1,0)
53.67^B
"^DD",53.66,53.67,.01,1,1,1)
S ^PSB(53.66,DA(1),1,"B",$E(X,1,30),DA)=""
"^DD",53.66,53.67,.01,1,1,2)
K ^PSB(53.66,DA(1),1,"B",$E(X,1,30),DA)
"^DD",53.66,53.67,.01,21,0)
^^1^1^3020426^
"^DD",53.66,53.67,.01,21,1,0)
Stores the IV parameter settings by IV Type.
"^DD",53.66,53.67,.01,"DT")
3020426
"^DD",53.66,53.67,1,0)
ADDITIVE^S^W:WARNING;N:NO WARNING;I:INVALID;^0;2^Q
"^DD",53.66,53.67,1,21,0)
^.001^1^1^3010918^^
"^DD",53.66,53.67,1,21,1,0)
Stores the parameter setting when a change is made to an additive.
"^DD",53.66,53.67,1,"DT")
3010831
"^DD",53.66,53.67,5,0)
STRENGTH^S^W:WARNING;N:NO WARNING;I:INVALID;^0;3^Q
"^DD",53.66,53.67,5,21,0)
^.001^1^1^3010918^^
"^DD",53.66,53.67,5,21,1,0)
Stores the parameter setting when a change is made to the strength.
"^DD",53.66,53.67,5,"DT")
3010105
"^DD",53.66,53.67,10,0)
BOTTLE^S^W:WARNING;N:NO WARNING;I:INVALID;^0;4^Q
"^DD",53.66,53.67,10,21,0)
^.001^1^1^3010918^^
"^DD",53.66,53.67,10,21,1,0)
Stores the parameter setting when a change is made to the bottle.
"^DD",53.66,53.67,10,"DT")
3010105
"^DD",53.66,53.67,15,0)
SOLUTION^S^W:WARNING;N:NO WARNING;I:INVALID;^0;5^Q
"^DD",53.66,53.67,15,21,0)
^.001^1^1^3010918^^
"^DD",53.66,53.67,15,21,1,0)
Stores the parameter setting when a change is made to the solution.
"^DD",53.66,53.67,15,"DT")
3010105
"^DD",53.66,53.67,20,0)
VOLUME^S^W:WARNING;N:NO WARNING;I:INVALID;^0;6^Q
"^DD",53.66,53.67,20,21,0)
^.001^1^1^3010918^^
"^DD",53.66,53.67,20,21,1,0)
Stores the parameter setting when a change is made to the IV volume.
"^DD",53.66,53.67,20,"DT")
3010105
"^DD",53.66,53.67,25,0)
INFUSION RATE^S^W:WARNING;N:NO WARNING;I:INVALID;^0;7^Q
"^DD",53.66,53.67,25,21,0)
^.001^1^1^3010918^^
"^DD",53.66,53.67,25,21,1,0)
Stores the parameter setting when a change is made to the infusion rate.
"^DD",53.66,53.67,25,"DT")
3010105
"^DD",53.66,53.67,30,0)
MED ROUTE^S^W:WARNING;N:NO WARNING;I:INVALID;^0;8^Q
"^DD",53.66,53.67,30,21,0)
^.001^1^1^3010918^^
"^DD",53.66,53.67,30,21,1,0)
Stores the parameter setting when a change is made to the IV medication route.
"^DD",53.66,53.67,30,"DT")
3010105
"^DD",53.66,53.67,35,0)
SCHEDULE^S^W:WARNING;N:NO WARNING;I:INVALID;^0;9^Q
"^DD",53.66,53.67,35,21,0)
^.001^1^1^3010918^^
"^DD",53.66,53.67,35,21,1,0)
Stores the parameter setting when a change is made to the IV schedule.
"^DD",53.66,53.67,35,"DT")
3010105
"^DD",53.66,53.67,40,0)
ADMIN TIME^S^W:WARNING;N:NO WARNING;I:INVALID;^0;10^Q
"^DD",53.66,53.67,40,21,0)
^.001^1^1^3010918^^
"^DD",53.66,53.67,40,21,1,0)
Stores the parameter setting when a change is made to the IV administration time.
"^DD",53.66,53.67,40,"DT")
3010105
"^DD",53.66,53.67,45,0)
REMARKS^S^W:WARNING;N:NO WARNING;I:INVALID;^0;11^Q
"^DD",53.66,53.67,45,21,0)
^.001^1^1^3010918^^
"^DD",53.66,53.67,45,21,1,0)
Stores the parameter setting when a change is made to the IV remarks.
"^DD",53.66,53.67,45,"DT")
3010105
"^DD",53.66,53.67,50,0)
OTHER PRINT INFO^S^W:WARNING;N:NO WARNING;I:INVALID;^0;12^Q
"^DD",53.66,53.67,50,21,0)
^.001^1^1^3010918^^
"^DD",53.66,53.67,50,21,1,0)
Stores the parameter setting when a change is made to the IV other print information.
"^DD",53.66,53.67,50,"DT")
3010105
"^DD",53.66,53.67,55,0)
PROVIDER^S^W:WARNING;N:NO WARNING;I:INVALID;^0;13^Q
"^DD",53.66,53.67,55,21,0)
^.001^1^1^3010918^^
"^DD",53.66,53.67,55,21,1,0)
Stores the parameter setting when a change is made to the IV provider.
"^DD",53.66,53.67,55,"DT")
3010105
"^DD",53.66,53.67,60,0)
START DATE/TIME^S^W:WARNING;N:NO WARNING;I:INVALID;^0;14^Q
"^DD",53.66,53.67,60,21,0)
^.001^1^1^3010918^^^
"^DD",53.66,53.67,60,21,1,0)
Stores the parameter setting when a change is made to the IV start date and time.
"^DD",53.66,53.67,60,23,0)
^.001^1^1^3010918^^
"^DD",53.66,53.67,60,23,1,0)
 
"^DD",53.66,53.67,60,"DT")
3010105
"^DD",53.66,53.67,65,0)
STOP DATE/TIME^S^W:WARNING;N:NO WARNING;I:INVALID;^0;15^Q
"^DD",53.66,53.67,65,21,0)
^.001^1^1^3010918^^
"^DD",53.66,53.67,65,21,1,0)
Stores the parameter setting when a change is made to the IV stop date and time.
"^DD",53.66,53.67,65,"DT")
3010105
"^DD",53.66,53.67,70,0)
PROVIDER COMMENTS^S^W:WARNING;N:NO WARNING;I:INVALID;^0;16^Q
"^DD",53.66,53.67,70,21,0)
^.001^1^1^3010918^^
"^DD",53.66,53.67,70,21,1,0)
Stores the parameter setting when a change is made to the provider comments.
"^DD",53.66,53.67,70,"DT")
3010105
"^DD",53.68,53.68,0)
FIELD^^.27^23
"^DD",53.68,53.68,0,"DDA")
N
"^DD",53.68,53.68,0,"DT")
3031030
"^DD",53.68,53.68,0,"IX","ADTE",53.68,.02)

"^DD",53.68,53.68,0,"IX","AS",53.68,.07)

"^DD",53.68,53.68,0,"IX","B",53.68,.01)

"^DD",53.68,53.68,0,"NM","BCMA MISSING DOSE REQUEST")

"^DD",53.68,53.68,0,"VRPK")
PSB
"^DD",53.68,53.68,.01,0)
REQUEST NUMBER^RF^^0;1^K:$L(X)>18!($L(X)<18) X
"^DD",53.68,53.68,.01,1,0)
^.1
"^DD",53.68,53.68,.01,1,1,0)
53.68^B
"^DD",53.68,53.68,.01,1,1,1)
S ^PSB(53.68,"B",$E(X,1,30),DA)=""
"^DD",53.68,53.68,.01,1,1,2)
K ^PSB(53.68,"B",$E(X,1,30),DA)
"^DD",53.68,53.68,.01,3)
Answer must be 18 characters in length.
"^DD",53.68,53.68,.01,21,0)
^^2^2^2990805^
"^DD",53.68,53.68,.01,21,1,0)
Contains a system generated unique request number for each missing dose
"^DD",53.68,53.68,.01,21,2,0)
request entered.
"^DD",53.68,53.68,.01,"DT")
2990313
"^DD",53.68,53.68,.02,0)
DATE/TIME ENTERED^D^^0;2^S %DT="ETXR" D ^%DT S X=Y K:Y<1 X
"^DD",53.68,53.68,.02,1,0)
^.1
"^DD",53.68,53.68,.02,1,1,0)
53.68^ADTE
"^DD",53.68,53.68,.02,1,1,1)
S ^PSB(53.68,"ADTE",$E(X,1,30),DA)=""
"^DD",53.68,53.68,.02,1,1,2)
K ^PSB(53.68,"ADTE",$E(X,1,30),DA)
"^DD",53.68,53.68,.02,1,1,"DT")
2990318
"^DD",53.68,53.68,.02,3)

"^DD",53.68,53.68,.02,21,0)
^^1^1^2990731^^^^
"^DD",53.68,53.68,.02,21,1,0)
Automatically stuffed at record creation time with a value of NOW.
"^DD",53.68,53.68,.02,"DT")
2990318
"^DD",53.68,53.68,.03,0)
ENTERED BY^P200'^VA(200,^0;3^Q
"^DD",53.68,53.68,.03,21,0)
2^^2^2^2990731^
"^DD",53.68,53.68,.03,21,1,0)
Automatically stuffed at record creation time with the current value of
"^DD",53.68,53.68,.03,21,2,0)
DUZ.
"^DD",53.68,53.68,.03,"DT")
2990313
"^DD",53.68,53.68,.04,0)
DIVISION^P4'^DIC(4,^0;4^Q
"^DD",53.68,53.68,.04,21,0)
^^2^2^2990731^^^
"^DD",53.68,53.68,.04,21,1,0)
Automatically stuffed at record creation time with the current value of
"^DD",53.68,53.68,.04,21,2,0)
DUZ(2).
"^DD",53.68,53.68,.04,"DT")
2990313
"^DD",53.68,53.68,.05,0)
SENT TO MAILGROUP^F^^0;5^K:$L(X)>30!($L(X)<1) X
"^DD",53.68,53.68,.05,3)
Answer must be 1-30 characters in length.
"^DD",53.68,53.68,.05,21,0)
^^1^1^2990731^
"^DD",53.68,53.68,.05,21,1,0)
Once submitted this field contains the Mail group the request was sent to.
"^DD",53.68,53.68,.05,"DT")
2990326
"^DD",53.68,53.68,.06,0)
PRINTED ON DEVICE^F^^0;6^K:$L(X)>30!($L(X)<1) X
"^DD",53.68,53.68,.06,3)
Answer must be 1-30 characters in length.
"^DD",53.68,53.68,.06,21,0)
^^2^2^2990731^
"^DD",53.68,53.68,.06,21,1,0)
If printing is enabled this contains the printer that the request printed
"^DD",53.68,53.68,.06,21,2,0)
on.
"^DD",53.68,53.68,.06,"DT")
2990326
"^DD",53.68,53.68,.07,0)
STATUS^S^0:CLOSED;1:UNRESOLVED;^0;7^Q
"^DD",53.68,53.68,.07,1,0)
^.1
"^DD",53.68,53.68,.07,1,1,0)
53.68^AS
"^DD",53.68,53.68,.07,1,1,1)
S ^PSB(53.68,"AS",$E(X,1,30),DA)=""
"^DD",53.68,53.68,.07,1,1,2)
K ^PSB(53.68,"AS",$E(X,1,30),DA)
"^DD",53.68,53.68,.07,1,1,"DT")
2990408
"^DD",53.68,53.68,.07,5,1,0)
53.68^.24^1
"^DD",53.68,53.68,.07,21,0)
^^1^1^2990731^
"^DD",53.68,53.68,.07,21,1,0)
Status of the request as Closed or Unresolved.
"^DD",53.68,53.68,.07,"DT")
2990408
"^DD",53.68,53.68,.11,0)
PATIENT^P2'^DPT(^.1;1^Q
"^DD",53.68,53.68,.11,21,0)
^^1^1^2990731^
"^DD",53.68,53.68,.11,21,1,0)
Pointer to the PATIENT file (#2) of the patient missing the medication.
"^DD",53.68,53.68,.11,"DT")
2990313
"^DD",53.68,53.68,.12,0)
WARD LOCATION^P42'^DIC(42,^.1;2^Q
"^DD",53.68,53.68,.12,21,0)
^^2^2^2990805^
"^DD",53.68,53.68,.12,21,1,0)
Pointer to the WARD LOCATION file (#42) with the selected ward for the
"^DD",53.68,53.68,.12,21,2,0)
report.
"^DD",53.68,53.68,.12,"DT")
2990326
"^DD",53.68,53.68,.13,0)
DRUG REQUESTED^P50'X^PSDRUG(^.1;3^I ($P($G(^PSDRUG(X,2)),U,3)'["U")&($P($G(^PSDRUG(X,2)),U,3)'["I")!($G(^PSDRUG(X,"I"),DT)<DT) K X
"^DD",53.68,53.68,.13,3)
Drug must be active and a Unit Dose or IV med.
"^DD",53.68,53.68,.13,21,0)
^.001^1^1^3000509^^
"^DD",53.68,53.68,.13,21,1,0)
Pointer to DRUG file (#50) with the medication needed.
"^DD",53.68,53.68,.13,"DT")
3000508
"^DD",53.68,53.68,.14,0)
DOSE NEEDED^F^^.1;4^K:$L(X)>30!($L(X)<1) X
"^DD",53.68,53.68,.14,3)
Answer must be 1-30 characters in length.
"^DD",53.68,53.68,.14,21,0)
^^1^1^2990731^
"^DD",53.68,53.68,.14,21,1,0)
Free text description of the dosage needed.
"^DD",53.68,53.68,.14,"DT")
2990313
"^DD",53.68,53.68,.15,0)
REASON NEEDED^S^1:DROPPED;2:EMPTY PACKAGE;3:NOT AVAILABLE;4:WRONG DOSE/DRUG DELIVERED;5:PACKAGE CONTENTS DAMAGED;6:PACKAGE INTEGRITY DAMAGED;7:BARCODE/IEN ILLEGIBLE;^.1;5^Q
"^DD",53.68,53.68,.15,21,0)
^^1^1^2990731^
"^DD",53.68,53.68,.15,21,1,0)
Set of codes containing the reason a medication is missing.
"^DD",53.68,53.68,.15,"DT")
3031030
"^DD",53.68,53.68,.16,0)
ADMINISTRATION DATE/TIME^D^^.1;6^S %DT="ETXR" D ^%DT S X=Y K:Y<1 X
"^DD",53.68,53.68,.16,21,0)
^^1^1^2990731^
"^DD",53.68,53.68,.16,21,1,0)
Date/Time the medication is to be administered.
"^DD",53.68,53.68,.16,"DT")
2990313
"^DD",53.68,53.68,.17,0)
NEEDED BY DATE/TIME^D^^.1;7^S %DT="ETXR" D ^%DT S X=Y K:Y<1 X
"^DD",53.68,53.68,.17,3)

"^DD",53.68,53.68,.17,21,0)
^.001^1^1^3020426^^^^
"^DD",53.68,53.68,.17,21,1,0)
Date/Time the medication will be needed to meet the next administration.
"^DD",53.68,53.68,.17,"DT")
3020426
"^DD",53.68,53.68,.18,0)
ROOM/BED^P405.4'^DG(405.4,^.1;8^Q
"^DD",53.68,53.68,.18,21,0)
^^1^1^3000511^
"^DD",53.68,53.68,.18,21,1,0)
The room/bed of the patient when the request is entered.
"^DD",53.68,53.68,.18,"DT")
3000511
"^DD",53.68,53.68,.19,0)
SCHEDULE^F^^.1;9^K:$L(X)>25!($L(X)<2) X
"^DD",53.68,53.68,.19,3)
Answer must be 2-25 characters in length.
"^DD",53.68,53.68,.19,"DT")
3020426
"^DD",53.68,53.68,.21,0)
DOSE DELIVERED^S^0:NO;1:YES;^.2;1^Q
"^DD",53.68,53.68,.21,21,0)
^^1^1^2990731^
"^DD",53.68,53.68,.21,21,1,0)
Was a dose delivered to complete this missing med request. (y/n)
"^DD",53.68,53.68,.21,"DT")
2990313
"^DD",53.68,53.68,.22,0)
DOSE DELIVERED BY^P200'^VA(200,^.2;2^Q
"^DD",53.68,53.68,.22,21,0)
^^1^1^2990731^
"^DD",53.68,53.68,.22,21,1,0)
Pointer to NEW PERSON file (#200) with the user who resolved the request.
"^DD",53.68,53.68,.22,"DT")
2990313
"^DD",53.68,53.68,.23,0)
DELIVERY TIME^D^^.2;3^S %DT="ETXR" D ^%DT S X=Y K:Y<1 X
"^DD",53.68,53.68,.23,21,0)
^^1^1^2990731^
"^DD",53.68,53.68,.23,21,1,0)
Date/Time the medication was delivered/resolved.
"^DD",53.68,53.68,.23,"DT")
2990313
"^DD",53.68,53.68,.24,0)
PHARMACY REASON NEEDED^S^1:WS/FILL ON REQUEST;2:FOUND IN DRAWER;3:PHARMACIST ERROR;4:EXPIRED/NO ORDER;5:ATC ERROR;6:NOT ENOUGH PRNS;7:TECHNICIAN ERROR;8:ON PRE-EXCHANGE/PICK LIST;9:PATIENT TRANSFERRED;10:NURSE ADMIN ERROR;^.2;4^Q
"^DD",53.68,53.68,.24,1,0)
^.1
"^DD",53.68,53.68,.24,1,1,0)
^^TRIGGER^53.68^.07
"^DD",53.68,53.68,.24,1,1,1)
K DIV S DIV=X,D0=DA,DIV(0)=D0 S Y(1)=$S($D(^PSB(53.68,D0,0)):^(0),1:"") S X=$P(Y(1),U,7),X=X S DIU=X K Y S X=DIV S X="0" X ^DD(53.68,.24,1,1,1.4)
"^DD",53.68,53.68,.24,1,1,1.4)
S DIH=$S($D(^PSB(53.68,DIV(0),0)):^(0),1:""),DIV=X S $P(^(0),U,7)=DIV,DIH=53.68,DIG=.07 D ^DICR:$O(^DD(DIH,DIG,1,0))>0
"^DD",53.68,53.68,.24,1,1,2)
K DIV S DIV=X,D0=DA,DIV(0)=D0 S Y(1)=$S($D(^PSB(53.68,D0,0)):^(0),1:"") S X=$P(Y(1),U,7),X=X S DIU=X K Y S X=DIV S X="1" X ^DD(53.68,.24,1,1,2.4)
"^DD",53.68,53.68,.24,1,1,2.4)
S DIH=$S($D(^PSB(53.68,DIV(0),0)):^(0),1:""),DIV=X S $P(^(0),U,7)=DIV,DIH=53.68,DIG=.07 D ^DICR:$O(^DD(DIH,DIG,1,0))>0
"^DD",53.68,53.68,.24,1,1,"CREATE VALUE")
"0"
"^DD",53.68,53.68,.24,1,1,"DELETE VALUE")
"1"
"^DD",53.68,53.68,.24,1,1,"DT")
2990408
"^DD",53.68,53.68,.24,1,1,"FIELD")
STATUS
"^DD",53.68,53.68,.24,21,0)
^^1^1^2990731^
"^DD",53.68,53.68,.24,21,1,0)
Set of coded for resolution reason.
"^DD",53.68,53.68,.24,"DT")
2990408
"^DD",53.68,53.68,.25,0)
UNIQUE ID^F^^.1;10^K:$L(X)>30!($L(X)<3) X
"^DD",53.68,53.68,.25,3)
Answer must be 3-30 characters in length.
"^DD",53.68,53.68,.25,21,0)
^^2^2^3020428^
"^DD",53.68,53.68,.25,21,1,0)
This is the unique ID number of an IV bag, which is generated from 
"^DD",53.68,53.68,.25,21,2,0)
Inpatient Medications.
"^DD",53.68,53.68,.25,"DT")
3020428
"^DD",53.68,53.68,.26,0)
ADDITIVES^53.686PA^^.6;0
"^DD",53.68,53.68,.26,21,0)
^.001^1^1^3020426^^
"^DD",53.68,53.68,.26,21,1,0)
Pointer to the additives file. Filled in automatically with the ordered additives when a missing dose is submitted.
"^DD",53.68,53.68,.27,0)
SOLUTIONS^53.687PA^^.7;0
"^DD",53.68,53.68,.27,21,0)
^^1^1^3020426^
"^DD",53.68,53.68,.27,21,1,0)
Pointer to the SOLUTIONS file. Filled in automatically with the ordered additives when a missing dose is submitted.
"^DD",53.68,53.686,0)
ADDITIVES SUB-FIELD^^.01^1
"^DD",53.68,53.686,0,"DT")
3010525
"^DD",53.68,53.686,0,"IX","B",53.686,.01)

"^DD",53.68,53.686,0,"NM","ADDITIVES")

"^DD",53.68,53.686,0,"UP")
53.68
"^DD",53.68,53.686,.01,0)
ADDITIVES^P52.6'^PS(52.6,^0;1^Q
"^DD",53.68,53.686,.01,1,0)
^.1
"^DD",53.68,53.686,.01,1,1,0)
53.686^B
"^DD",53.68,53.686,.01,1,1,1)
S ^PSB(53.68,DA(1),.6,"B",$E(X,1,30),DA)=""
"^DD",53.68,53.686,.01,1,1,2)
K ^PSB(53.68,DA(1),.6,"B",$E(X,1,30),DA)
"^DD",53.68,53.686,.01,21,0)
^.001^2^2^3020426^^
"^DD",53.68,53.686,.01,21,1,0)
Pointer to the additives file.  Filled in automatically with the ordered
"^DD",53.68,53.686,.01,21,2,0)
additives when a missing dose is submitted.
"^DD",53.68,53.686,.01,"DT")
3020426
"^DD",53.68,53.687,0)
SOLUTIONS SUB-FIELD^^.01^1
"^DD",53.68,53.687,0,"DT")
3010525
"^DD",53.68,53.687,0,"IX","B",53.687,.01)

"^DD",53.68,53.687,0,"NM","SOLUTIONS")

"^DD",53.68,53.687,0,"UP")
53.68
"^DD",53.68,53.687,.01,0)
SOLUTIONS^P52.7'^PS(52.7,^0;1^Q
"^DD",53.68,53.687,.01,1,0)
^.1
"^DD",53.68,53.687,.01,1,1,0)
53.687^B
"^DD",53.68,53.687,.01,1,1,1)
S ^PSB(53.68,DA(1),.7,"B",$E(X,1,30),DA)=""
"^DD",53.68,53.687,.01,1,1,2)
K ^PSB(53.68,DA(1),.7,"B",$E(X,1,30),DA)
"^DD",53.68,53.687,.01,21,0)
^^1^1^3020426^
"^DD",53.68,53.687,.01,21,1,0)
Pointer to the SOLUTIONS file. Filled in automatically with the ordered additives when a missing dose is submitted.
"^DD",53.68,53.687,.01,"DT")
3010525
"^DD",53.69,53.69,0)
FIELD^^.51^40
"^DD",53.69,53.69,0,"DDA")
N
"^DD",53.69,53.69,0,"DT")
3031009
"^DD",53.69,53.69,0,"IX","B",53.69,.01)

"^DD",53.69,53.69,0,"NM","BCMA REPORT REQUEST")

"^DD",53.69,53.69,0,"VRPK")
PSB
"^DD",53.69,53.69,.01,0)
REQUEST NUMBER^RF^^0;1^K:$L(X)>30!($L(X)<3) X
"^DD",53.69,53.69,.01,.1)
Request Number
"^DD",53.69,53.69,.01,1,0)
^.1
"^DD",53.69,53.69,.01,1,1,0)
53.69^B
"^DD",53.69,53.69,.01,1,1,1)
S ^PSB(53.69,"B",$E(X,1,30),DA)=""
"^DD",53.69,53.69,.01,1,1,2)
K ^PSB(53.69,"B",$E(X,1,30),DA)
"^DD",53.69,53.69,.01,3)
Answer must be 3-30 characters in length.
"^DD",53.69,53.69,.01,21,0)
^^1^1^2990731^^
"^DD",53.69,53.69,.01,21,1,0)
Unique identifier for the report request.
"^DD",53.69,53.69,.01,"DT")
2990112
"^DD",53.69,53.69,.02,0)
DATE/TIME ENTERED^D^^0;2^S %DT="ETXR" D ^%DT S X=Y K:Y<1 X
"^DD",53.69,53.69,.02,.1)
Date/Time Entered
"^DD",53.69,53.69,.02,21,0)
^^1^1^2990731^^
"^DD",53.69,53.69,.02,21,1,0)
Automatically stuffed at record creation with a value of NOW.
"^DD",53.69,53.69,.02,"DT")
2990313
"^DD",53.69,53.69,.03,0)
ENTERED BY^P200'^VA(200,^0;3^Q
"^DD",53.69,53.69,.03,.1)
Entered By
"^DD",53.69,53.69,.03,21,0)
^.001^2^2^3010919^^^
"^DD",53.69,53.69,.03,21,1,0)
Automatically stuffed at record creation time with the current value for
"^DD",53.69,53.69,.03,21,2,0)
DUZ.
"^DD",53.69,53.69,.03,"DT")
2990313
"^DD",53.69,53.69,.04,0)
DIVISION^P4'^DIC(4,^0;4^Q
"^DD",53.69,53.69,.04,.1)
Division
"^DD",53.69,53.69,.04,21,0)
^^2^2^2990731^^
"^DD",53.69,53.69,.04,21,1,0)
Automatically stuffed at record creation time with the current value for
"^DD",53.69,53.69,.04,21,2,0)
DUZ(2).
"^DD",53.69,53.69,.04,"DT")
2990313
"^DD",53.69,53.69,.05,0)
TYPE OF REQUEST^F^^0;5^K:$L(X)>2!($L(X)<2)!'(X'?1P.E) X
"^DD",53.69,53.69,.05,.1)
Type of Request
"^DD",53.69,53.69,.05,3)
Answer must be 2 characters in length
"^DD",53.69,53.69,.05,21,0)
^^18^18^3030814^
"^DD",53.69,53.69,.05,21,1,0)
Automatically stuffed at record creation with the type of report that is
"^DD",53.69,53.69,.05,21,2,0)
being requested.  Used to drive the report later on by appending the
"^DD",53.69,53.69,.05,21,3,0)
internal code to "DQ^PSBO"_type for the routine reference to run.  (i.e.
"^DD",53.69,53.69,.05,21,4,0)
ML for med log would call DQ^PSBOML to generate the report.) 
"^DD",53.69,53.69,.05,21,5,0)
Report types DL = Due List
"^DD",53.69,53.69,.05,21,6,0)
             MH = Medication Admin History (MAH)
"^DD",53.69,53.69,.05,21,7,0)
             ML = Med Log
"^DD",53.69,53.69,.05,21,8,0)
             MM = Missed Medications
"^DD",53.69,53.69,.05,21,9,0)
             PE = PRN Effectiveness List
"^DD",53.69,53.69,.05,21,10,0)
             PM = Patient Medication History
"^DD",53.69,53.69,.05,21,11,0)
             WA = Ward Administration Times
"^DD",53.69,53.69,.05,21,12,0)
             MV = Medication Variance Log
"^DD",53.69,53.69,.05,21,13,0)
             BL = Bar Code Label
"^DD",53.69,53.69,.05,21,14,0)
             MD = Missing Dose Follow-up
"^DD",53.69,53.69,.05,21,15,0)
             AL = Allergy Report
"^DD",53.69,53.69,.05,21,16,0)
             PI = Patient Inquiry
"^DD",53.69,53.69,.05,21,17,0)
             DO = Display Order
"^DD",53.69,53.69,.05,21,18,0)
             VT = Vitals Cumulative
"^DD",53.69,53.69,.05,"DT")
3030814
"^DD",53.69,53.69,.06,0)
OUTPUT DEVICE^P3.5'^%ZIS(1,^0;6^Q
"^DD",53.69,53.69,.06,.1)
Output DEVICE
"^DD",53.69,53.69,.06,21,0)
^^4^4^2990731^^
"^DD",53.69,53.69,.06,21,1,0)
Pointer to the device file the user has selected.
"^DD",53.69,53.69,.06,21,2,0)
 
"^DD",53.69,53.69,.06,21,3,0)
NOTE: A device containing 'BROWSER' will be sent directly to the device,
"^DD",53.69,53.69,.06,21,4,0)
all other devices will be submitted to Taskman.
"^DD",53.69,53.69,.06,"DT")
2990317
"^DD",53.69,53.69,.07,0)
DEQUEUE TIME^D^^0;7^S %DT="ETXR" D ^%DT S X=Y K:Y<1 X
"^DD",53.69,53.69,.07,.1)
Queue to Run At
"^DD",53.69,53.69,.07,21,0)
^^1^1^2990731^^
"^DD",53.69,53.69,.07,21,1,0)
Date/time the user would like the report to print.
"^DD",53.69,53.69,.07,"DT")
2990313
"^DD",53.69,53.69,.08,0)
ZTSK^F^^0;8^K:$L(X)>20!($L(X)<1) X
"^DD",53.69,53.69,.08,.1)
Task Number
"^DD",53.69,53.69,.08,3)
Answer must be 1-20 characters in length.
"^DD",53.69,53.69,.08,21,0)
^^2^2^2990805^
"^DD",53.69,53.69,.08,21,1,0)
Automatically stuffed when the print job starts for later tracking and
"^DD",53.69,53.69,.08,21,2,0)
trouble shooting.
"^DD",53.69,53.69,.08,"DT")
2990313
"^DD",53.69,53.69,.09,0)
ORDER/ORDERABLE ITEM NUMBER^F^^0;9^K:$L(X)>15!($L(X)<1) X
"^DD",53.69,53.69,.09,3)
Answer must be 1-15 characters in length
"^DD",53.69,53.69,.09,21,0)
^^3^3^3010919^
"^DD",53.69,53.69,.09,21,1,0)
This field will contain either the Inpatient Medications order number
"^DD",53.69,53.69,.09,21,2,0)
for the "Display Order" request from the GUI or the orderable item number
"^DD",53.69,53.69,.09,21,3,0)
for a "Med History" request.
"^DD",53.69,53.69,.09,23,0)
^.001^1^1^3010919^^^^
"^DD",53.69,53.69,.09,23,1,0)
 
"^DD",53.69,53.69,.09,"DT")
3010919
"^DD",53.69,53.69,.11,0)
SORT BY^S^P:Patient;W:Ward;^.1;1^Q
"^DD",53.69,53.69,.11,.1)
Sort by Pt or Ward
"^DD",53.69,53.69,.11,21,0)
^.001^1^1^3011119^^^
"^DD",53.69,53.69,.11,21,1,0)
Determines the type of report (W:An entire ward P:An individual patient)
"^DD",53.69,53.69,.11,"DT")
3011119
"^DD",53.69,53.69,.12,0)
PATIENT^P2'^DPT(^.1;2^Q
"^DD",53.69,53.69,.12,.1)
Patient
"^DD",53.69,53.69,.12,21,0)
^^2^2^2990731^^
"^DD",53.69,53.69,.12,21,1,0)
Pointer to the patient file with the selected patient for a Patient
"^DD",53.69,53.69,.12,21,2,0)
specific report.
"^DD",53.69,53.69,.12,"DT")
2990701
"^DD",53.69,53.69,.121,0)
PATIENT SSN (C)^CJ9^^ ; ^X ^DD(53.69,.121,9.2) S Y(53.69,.121,101)=$S($D(^DPT(D0,0)):^(0),1:"") S X=$P(Y(53.69,.121,101),U,9) S D0=Y(53.69,.121,80)
"^DD",53.69,53.69,.121,9)
^
"^DD",53.69,53.69,.121,9.01)
2^.09;53.69^.12
"^DD",53.69,53.69,.121,9.1)
#.12:#.09
"^DD",53.69,53.69,.121,9.2)
S Y(53.69,.121,80)=$S($D(D0):D0,1:""),Y(53.69,.121,1)=$S($D(^PSB(53.69,D0,.1)):^(.1),1:""),D0=$P(Y(53.69,.121,1),U,2) S:'$D(^DPT(+D0,0)) D0=-1
"^DD",53.69,53.69,.121,21,0)
^^1^1^2990731^
"^DD",53.69,53.69,.121,21,1,0)
Computed field to easily display Patients SSN.
"^DD",53.69,53.69,.122,0)
PATIENT WARD LOCATION (C)^CJ15^^ ; ^X ^DD(53.69,.122,9.2) S Y(53.69,.122,101)=$S($D(^DPT(D0,.1)):^(.1),1:"") S X=$E(Y(53.69,.122,101),1,30) S D0=Y(53.69,.122,80)
"^DD",53.69,53.69,.122,9)
^
"^DD",53.69,53.69,.122,9.01)
2^.1;53.69^.12
"^DD",53.69,53.69,.122,9.1)
#.12:#.1
"^DD",53.69,53.69,.122,9.2)
S Y(53.69,.122,80)=$S($D(D0):D0,1:""),Y(53.69,.122,1)=$S($D(^PSB(53.69,D0,.1)):^(.1),1:""),D0=$P(Y(53.69,.122,1),U,2) S:'$D(^DPT(+D0,0)) D0=-1
"^DD",53.69,53.69,.122,21,0)
^^1^1^2990731^
"^DD",53.69,53.69,.122,21,1,0)
Computed field to easily display Patients Ward Location.
"^DD",53.69,53.69,.13,0)
WARD^*P211.4'^NURSF(211.4,^.1;3^S DIC("S")="I $P($G(^NURSF(211.4,+Y,1)),U,1)=""A""" D ^DIC K DIC S DIC=$G(DIE),X=+Y K:Y<0 X
"^DD",53.69,53.69,.13,.1)
Ward
"^DD",53.69,53.69,.13,12)
Only active Nurse Location Entries Allowed
"^DD",53.69,53.69,.13,12.1)
S DIC("S")="I $P($G(^NURSF(211.4,+Y,1)),U,1)=""A"""
"^DD",53.69,53.69,.13,21,0)
^^2^2^3031008^
"^DD",53.69,53.69,.13,21,1,0)
Pointer to the NURS LOCATION file for reports to be generated by ward
"^DD",53.69,53.69,.13,21,2,0)
instead of patient.
"^DD",53.69,53.69,.13,"DT")
3031009
"^DD",53.69,53.69,.14,0)
TEAM^F^^.1;4^K:$L(X)>1!($L(X)<1) X
"^DD",53.69,53.69,.14,.1)
Team
"^DD",53.69,53.69,.14,3)
Answer must be 1 character in length.
"^DD",53.69,53.69,.14,21,0)
^^1^1^2990731^^
"^DD",53.69,53.69,.14,21,1,0)
Not used at this time.  Future plans are to incorporate a medication team.
"^DD",53.69,53.69,.14,"DT")
2990112
"^DD",53.69,53.69,.15,0)
SORT BY PATIENT OR BED^S^P:Patient;B:Room-Bed;^.1;5^Q
"^DD",53.69,53.69,.15,.1)
Sort by Pt or Room-Bed
"^DD",53.69,53.69,.15,21,0)
^^2^2^2990731^^
"^DD",53.69,53.69,.15,21,1,0)
Ward based reports are asked to sort either by patient name or room bed
"^DD",53.69,53.69,.15,21,2,0)
locations.
"^DD",53.69,53.69,.15,"DT")
2990321
"^DD",53.69,53.69,.16,0)
START DATE^DX^^.1;6^S %DT="EX" D ^%DT S X=Y K:Y<1 X
"^DD",53.69,53.69,.16,.1)
Report Start Date
"^DD",53.69,53.69,.16,21,0)
^.001^2^2^3010717^^^
"^DD",53.69,53.69,.16,21,1,0)
Fileman Date that the selected report is to start generating from.  No
"^DD",53.69,53.69,.16,21,2,0)
time is allowed in this field.
"^DD",53.69,53.69,.16,"DT")
3020118
"^DD",53.69,53.69,.17,0)
START TIME^NJ6,4XO^^.1;7^D TIMEIN^PSBUTL
"^DD",53.69,53.69,.17,.1)
Report Start Time
"^DD",53.69,53.69,.17,2)
S Y(0)=Y S Y=$$TIMEOUT^PSBUTL(Y)
"^DD",53.69,53.69,.17,2.1)
S Y=$$TIMEOUT^PSBUTL(Y)
"^DD",53.69,53.69,.17,3)
Enter in the starting time (i.e. 8A or 0800).
"^DD",53.69,53.69,.17,21,0)
^^2^2^2990731^^
"^DD",53.69,53.69,.17,21,1,0)
Contains the decimal portion of an internal fileman date/time to specify
"^DD",53.69,53.69,.17,21,2,0)
the time that the report is to generate from.
"^DD",53.69,53.69,.17,"DT")
2990112
"^DD",53.69,53.69,.18,0)
STOP DATE^DX^^.1;8^S %DT="EX" D ^%DT S X=Y K:Y<1 X
"^DD",53.69,53.69,.18,.1)
Report Stop Date
"^DD",53.69,53.69,.18,21,0)
^^2^2^2990731^^
"^DD",53.69,53.69,.18,21,1,0)
Fileman Date that the selected report is to stop generating.  No
"^DD",53.69,53.69,.18,21,2,0)
time is allowed in this field.
"^DD",53.69,53.69,.18,"DT")
3020118
"^DD",53.69,53.69,.19,0)
STOP TIME^NJ6,4XO^^.1;9^D TIMEIN^PSBUTL
"^DD",53.69,53.69,.19,.1)
Report Stop Time
"^DD",53.69,53.69,.19,2)
S Y(0)=Y S Y=$$TIMEOUT^PSBUTL(Y)
"^DD",53.69,53.69,.19,2.1)
S Y=$$TIMEOUT^PSBUTL(Y)
"^DD",53.69,53.69,.19,3)
Enter in the stop time (i.e. 8A or 0800).
"^DD",53.69,53.69,.19,21,0)
^^2^2^2990731^^
"^DD",53.69,53.69,.19,21,1,0)
Contains the decimal portion of an internal fileman date/time to specify
"^DD",53.69,53.69,.19,21,2,0)
the time that the report is to generate to.
"^DD",53.69,53.69,.19,"DT")
2990112
"^DD",53.69,53.69,.21,0)
[DL] INCLUDE CONTINUOUS MEDS^S^0:No;1:Yes;^.2;1^Q
"^DD",53.69,53.69,.21,.1)
Include Continuous Meds
"^DD",53.69,53.69,.21,21,0)
^^2^2^2990731^^
"^DD",53.69,53.69,.21,21,1,0)
Yes/No question for the Due List to include continuous medications
"^DD",53.69,53.69,.21,21,2,0)
or not.
"^DD",53.69,53.69,.21,"DT")
2990126
"^DD",53.69,53.69,.22,0)
[DL] INCLUDE PRN MEDS^S^0:No;1:Yes;^.2;2^Q
"^DD",53.69,53.69,.22,.1)
Include PRN Meds
"^DD",53.69,53.69,.22,3)

"^DD",53.69,53.69,.22,21,0)
^^2^2^2990731^^
"^DD",53.69,53.69,.22,21,1,0)
Yes/No question for the Due List to include PRN medications 
"^DD",53.69,53.69,.22,21,2,0)
or not.
"^DD",53.69,53.69,.22,"DT")
2990126
"^DD",53.69,53.69,.23,0)
[DL] INCLUDE ON-CALL MEDS^S^0:No;1:Yes;^.2;3^Q
"^DD",53.69,53.69,.23,.1)
Include On-Call Meds
"^DD",53.69,53.69,.23,3)

"^DD",53.69,53.69,.23,21,0)
^^2^2^2990731^^
"^DD",53.69,53.69,.23,21,1,0)
Yes/No question for the Due List to include On-Call medications 
"^DD",53.69,53.69,.23,21,2,0)
or not.
"^DD",53.69,53.69,.23,"DT")
2990126
"^DD",53.69,53.69,.24,0)
[DL] INCLUDE ONE-TIME MEDS^S^0:No;1:Yes;^.2;4^Q
"^DD",53.69,53.69,.24,.1)
Include One-Time Meds
"^DD",53.69,53.69,.24,3)

"^DD",53.69,53.69,.24,21,0)
^^2^2^2990731^^
"^DD",53.69,53.69,.24,21,1,0)
Yes/No question for the Due List to include One Time medications 
"^DD",53.69,53.69,.24,21,2,0)
or not.
"^DD",53.69,53.69,.24,"DT")
2990126
"^DD",53.69,53.69,.25,0)
[DL] INCLUDE BLANKS^S^0:No;1:Yes;^.2;5^Q
"^DD",53.69,53.69,.25,.1)
Include Order Blanks
"^DD",53.69,53.69,.25,3)

"^DD",53.69,53.69,.25,21,0)
^^2^2^2990731^^
"^DD",53.69,53.69,.25,21,1,0)
Yes/No question for the Due List to include blank addendums for newly
"^DD",53.69,53.69,.25,21,2,0)
ordered meds or not.
"^DD",53.69,53.69,.25,"DT")
2990317
"^DD",53.69,53.69,.26,0)
[DL] INLCUDE IV MEDS^S^0:No;1:Yes;^.2;6^Q
"^DD",53.69,53.69,.26,21,0)
^^2^2^2990731^^
"^DD",53.69,53.69,.26,21,1,0)
Yes/No question for the Due List to include IV medications 
"^DD",53.69,53.69,.26,21,2,0)
or not.
"^DD",53.69,53.69,.26,"DT")
2990317
"^DD",53.69,53.69,.27,0)
[DL] INCLUDE UNIT DOSE MEDS^S^0:No;1:Yes;^.2;7^Q
"^DD",53.69,53.69,.27,3)

"^DD",53.69,53.69,.27,21,0)
^^2^2^2990731^^
"^DD",53.69,53.69,.27,21,1,0)
Yes/No question for the Due List to include Unit Dose medications 
"^DD",53.69,53.69,.27,21,2,0)
or not.
"^DD",53.69,53.69,.27,"DT")
2990317
"^DD",53.69,53.69,.28,0)
[ML] INCLUDE COMMENTS^S^1:Yes;0:No;^.2;8^Q
"^DD",53.69,53.69,.28,21,0)
^^2^2^2990731^^
"^DD",53.69,53.69,.28,21,1,0)
When printing the medication log, comments can be included for each med
"^DD",53.69,53.69,.28,21,2,0)
pass if this question is answered Yes.
"^DD",53.69,53.69,.28,"DT")
2990331
"^DD",53.69,53.69,.29,0)
[ML] INCLUDE AUDITS^S^1:YES;0:NO;^.2;9^Q
"^DD",53.69,53.69,.29,3)

"^DD",53.69,53.69,.29,21,0)
^^2^2^2990805^
"^DD",53.69,53.69,.29,21,1,0)
When printing the medication log, audits can be included for each med
"^DD",53.69,53.69,.29,21,2,0)
pass if this question is answered Yes.
"^DD",53.69,53.69,.29,"DT")
2990331
"^DD",53.69,53.69,.31,0)
[BL] DRUG^FXO^^.3;1^D INPTR^PSBOBL
"^DD",53.69,53.69,.31,.1)
Drug
"^DD",53.69,53.69,.31,2)
S Y(0)=Y S Y=$P(Y,"~",1)
"^DD",53.69,53.69,.31,2.1)
S Y=$P(Y,"~",1)
"^DD",53.69,53.69,.31,3)
Answer must be 1-40 characters in length.
"^DD",53.69,53.69,.31,21,0)
^^2^2^2990731^^
"^DD",53.69,53.69,.31,21,1,0)
Stores the Name and IEN of the selected drug to print a bar code label
"^DD",53.69,53.69,.31,21,2,0)
for.
"^DD",53.69,53.69,.31,"DT")
3021101
"^DD",53.69,53.69,.32,0)
[BL] LOT NUMBER^F^^.3;2^K:$L(X)>15!($L(X)<1) X
"^DD",53.69,53.69,.32,.1)
Lot Number
"^DD",53.69,53.69,.32,3)
Answer must be 1-15 characters in length.
"^DD",53.69,53.69,.32,21,0)
^^1^1^2990731^^
"^DD",53.69,53.69,.32,21,1,0)
Contains the lot number of the drug to print a bar code label for.
"^DD",53.69,53.69,.32,"DT")
2990318
"^DD",53.69,53.69,.33,0)
[BL] EXPIRATION DATE^D^^.3;3^S %DT="E" D ^%DT S X=Y K:Y<1 X
"^DD",53.69,53.69,.33,.1)
Expiration Date
"^DD",53.69,53.69,.33,21,0)
^^1^1^2990731^^
"^DD",53.69,53.69,.33,21,1,0)
Contains the exp date of the drug to print a bar code label for.
"^DD",53.69,53.69,.33,"DT")
2990318
"^DD",53.69,53.69,.34,0)
[BL] MANUFACTURER^F^^.3;4^K:$L(X)>30!($L(X)<1) X
"^DD",53.69,53.69,.34,.1)
Manufacturer
"^DD",53.69,53.69,.34,3)
Answer must be 1-30 characters in length.
"^DD",53.69,53.69,.34,21,0)
^^1^1^2990731^^
"^DD",53.69,53.69,.34,21,1,0)
Contains the manufacturer of the drug to print a bar code label for.
"^DD",53.69,53.69,.34,"DT")
2990318
"^DD",53.69,53.69,.35,0)
[BL] QUANTITY^NJ7,2^^.3;5^K:+X'=X!(X>9999)!(X<.25)!(X?.E1"."3N.N) X
"^DD",53.69,53.69,.35,.1)
Quantity
"^DD",53.69,53.69,.35,3)
Type a Number between .25 and 9999, 2 Decimal Digits
"^DD",53.69,53.69,.35,21,0)
^^1^1^2990731^^
"^DD",53.69,53.69,.35,21,1,0)
Contains the quantity of the drug to print a bar code label for.
"^DD",53.69,53.69,.35,"DT")
2990318
"^DD",53.69,53.69,.36,0)
[BL] FILLED BY^F^^.3;6^K:$L(X)>5!($L(X)<2) X
"^DD",53.69,53.69,.36,.1)
Filled By
"^DD",53.69,53.69,.36,3)
Answer must be 2-5 characters in length.
"^DD",53.69,53.69,.36,21,0)
^^1^1^2990731^^
"^DD",53.69,53.69,.36,21,1,0)
Contains the initials of the pharmacists filling the meds for this label.
"^DD",53.69,53.69,.36,"DT")
2990326
"^DD",53.69,53.69,.37,0)
[BL] CHECKED BY^F^^.3;7^K:$L(X)>5!($L(X)<2) X
"^DD",53.69,53.69,.37,.1)
Checked By
"^DD",53.69,53.69,.37,3)
Answer must be 2-5 characters in length.
"^DD",53.69,53.69,.37,21,0)
^^1^1^2990731^^
"^DD",53.69,53.69,.37,21,1,0)
Contains the initials of the pharmacists checking the meds for this label.
"^DD",53.69,53.69,.37,"DT")
2990318
"^DD",53.69,53.69,.38,0)
[BL] NUMBER OF LABELS^NJ4,0^^.3;8^K:+X'=X!(X>9999)!(X<1)!(X?.E1"."1N.N) X
"^DD",53.69,53.69,.38,.1)
Number of Labels
"^DD",53.69,53.69,.38,3)
Type a Number between 1 and 9999, 0 Decimal Digits
"^DD",53.69,53.69,.38,21,0)
^^1^1^2990731^^
"^DD",53.69,53.69,.38,21,1,0)
Contains the number of labels the user is requesting to be printed.
"^DD",53.69,53.69,.38,"DT")
2990318
"^DD",53.69,53.69,.39,0)
[BL] DOSAGE^F^^.3;9^K:$L(X)>30!($L(X)<1) X
"^DD",53.69,53.69,.39,3)
Answer must be 1-30 characters in length.
"^DD",53.69,53.69,.39,21,0)
^^1^1^2990731^^
"^DD",53.69,53.69,.39,21,1,0)
Free text dosage to print on each label.
"^DD",53.69,53.69,.39,"DT")
2990407
"^DD",53.69,53.69,.41,0)
[DL] INCLUDE FUTURE ORDERS^S^0:No;1:Yes;^.4;1^Q
"^DD",53.69,53.69,.41,21,0)
^^1^1^3011129^
"^DD",53.69,53.69,.41,21,1,0)
Yes/No question for the Due List to include future orders or not.
"^DD",53.69,53.69,.41,"DT")
3011129
"^DD",53.69,53.69,.51,0)
REPORT REQUEST CONT.^S^VT:Vitals cumulative;^.5;1^Q
"^DD",53.69,53.69,.51,.1)
Report Request Cont.
"^DD",53.69,53.69,.51,21,0)
^^6^6^3030801^
"^DD",53.69,53.69,.51,21,1,0)
This field will store additional report type requests.
"^DD",53.69,53.69,.51,21,2,0)
Automatically stuffed at record creation with the type of report
"^DD",53.69,53.69,.51,21,3,0)
that is being requested.  Used to drive the report later on by
"^DD",53.69,53.69,.51,21,4,0)
appending the internal code to "DQ^PSBO"_type for the routine
"^DD",53.69,53.69,.51,21,5,0)
reference to run. (i.e. VT for vitals cumulative would call DQ^PSBOVT to 
"^DD",53.69,53.69,.51,21,6,0)
generate the report.)
"^DD",53.69,53.69,.51,"DT")
3030801
"^DD",53.78,53.78,0)
FIELD^^.09^9
"^DD",53.78,53.78,0,"DDA")
N
"^DD",53.78,53.78,0,"DT")
2990428
"^DD",53.78,53.78,0,"IX","ADT",53.78,.04)

"^DD",53.78,53.78,0,"IX","B",53.78,.01)

"^DD",53.78,53.78,0,"NM","BCMA MEDICATION VARIANCE LOG")

"^DD",53.78,53.78,0,"VRPK")
PSB
"^DD",53.78,53.78,.01,0)
PATIENT NAME^RP2'^DPT(^0;1^Q
"^DD",53.78,53.78,.01,1,0)
^.1
"^DD",53.78,53.78,.01,1,1,0)
53.78^B
"^DD",53.78,53.78,.01,1,1,1)
S ^PSB(53.78,"B",$E(X,1,30),DA)=""
"^DD",53.78,53.78,.01,1,1,2)
K ^PSB(53.78,"B",$E(X,1,30),DA)
"^DD",53.78,53.78,.01,3)

"^DD",53.78,53.78,.01,21,0)
^^1^1^2990731^^
"^DD",53.78,53.78,.01,21,1,0)
Pointer to the patient file (#2) of the patient in the variance log.
"^DD",53.78,53.78,.01,"DT")
2990325
"^DD",53.78,53.78,.02,0)
ROOM AND BED^F^^0;2^K:$L(X)>20!($L(X)<1) X
"^DD",53.78,53.78,.02,3)
Answer must be 1-20 characters in length.
"^DD",53.78,53.78,.02,21,0)
^^1^1^3020701^
"^DD",53.78,53.78,.02,21,1,0)
Room and bed location of the patient at the time of the variance.
"^DD",53.78,53.78,.02,"DT")
3020701
"^DD",53.78,53.78,.03,0)
USER^P200'O^VA(200,^0;3^Q
"^DD",53.78,53.78,.03,2)
S Y(0)=Y S Y=$S($D(^XUSEC("PSB MANAGER",DUZ)):$P(^VA(200,Y,0),U),1:"<No Access>")
"^DD",53.78,53.78,.03,2.1)
S Y=$S($D(^XUSEC("PSB MANAGER",DUZ)):$P(^VA(200,Y,0),U),1:"<No Access>")
"^DD",53.78,53.78,.03,21,0)
^^1^1^2990731^^
"^DD",53.78,53.78,.03,21,1,0)
User passing meds during the variance.
"^DD",53.78,53.78,.03,"DT")
2990328
"^DD",53.78,53.78,.04,0)
DATE/TIME OF OCCURRENCE^D^^0;4^S %DT="ESTXR" D ^%DT S X=Y K:Y<1 X
"^DD",53.78,53.78,.04,1,0)
^.1
"^DD",53.78,53.78,.04,1,1,0)
53.78^ADT
"^DD",53.78,53.78,.04,1,1,1)
S ^PSB(53.78,"ADT",$E(X,1,30),DA)=""
"^DD",53.78,53.78,.04,1,1,2)
K ^PSB(53.78,"ADT",$E(X,1,30),DA)
"^DD",53.78,53.78,.04,1,1,"DT")
2990328
"^DD",53.78,53.78,.04,21,0)
^^1^1^2990731^^
"^DD",53.78,53.78,.04,21,1,0)
Date/time of the variance.
"^DD",53.78,53.78,.04,"DT")
2990328
"^DD",53.78,53.78,.05,0)
EVENT^S^1:WRONG MED;2:EARLY/LATE DOSE;3:LATE PRN EFFECT;^0;5^Q
"^DD",53.78,53.78,.05,3)

"^DD",53.78,53.78,.05,21,0)
^^1^1^2990731^^
"^DD",53.78,53.78,.05,21,1,0)
Set of codes describing the variance.
"^DD",53.78,53.78,.05,"DT")
2990428
"^DD",53.78,53.78,.06,0)
ADMINISTRATION TIME VARIANCE^NJ9,0^^0;6^K:+X'=X!(X>999999999)!(X<-999999999)!(X?.E1"."1N.N) X
"^DD",53.78,53.78,.06,3)
Type a Number between -999999999 and 999999999, 0 Decimal Digits
"^DD",53.78,53.78,.06,21,0)
^^2^2^2990731^^
"^DD",53.78,53.78,.06,21,1,0)
If the variance was an early or late event this field store the number of
"^DD",53.78,53.78,.06,21,2,0)
minutes early (<1) or minutes late (>1) of the event.
"^DD",53.78,53.78,.06,"DT")
2990325
"^DD",53.78,53.78,.07,0)
DRUG SCANNED^P50'^PSDRUG(^0;7^Q
"^DD",53.78,53.78,.07,21,0)
^^2^2^2990731^^
"^DD",53.78,53.78,.07,21,1,0)
Pointer to the drug file of the medication that was scanned for this
"^DD",53.78,53.78,.07,21,2,0)
variance.
"^DD",53.78,53.78,.07,"DT")
2990325
"^DD",53.78,53.78,.08,0)
MED LOG PTR^P53.79'^PSB(53.79,^0;8^Q
"^DD",53.78,53.78,.08,21,0)
^^1^1^2990731^^
"^DD",53.78,53.78,.08,21,1,0)
Pointer to the BCMA MEDICATION LOG (#53.79) for this event.
"^DD",53.78,53.78,.08,"DT")
2990328
"^DD",53.78,53.78,.09,0)
WARD LOCATION^P42'^DIC(42,^0;9^Q
"^DD",53.78,53.78,.09,3)
Enter the ward where the patient is currently located.
"^DD",53.78,53.78,.09,21,0)
^.001^1^1^3020703^^^^
"^DD",53.78,53.78,.09,21,1,0)
The ward location where the patient is located when a Medication Variance is logged.
"^DD",53.78,53.78,.09,"DT")
3020703
"^DD",53.79,53.79,0)
FIELD^^.9^28
"^DD",53.79,53.79,0,"DDA")
N
"^DD",53.79,53.79,0,"DT")
3031104
"^DD",53.79,53.79,0,"ID",.08)
S %I=Y,Y=$S('$D(^(0)):"",$D(^PS(50.7,+$P(^(0),U,8),0))#2:$P(^(0),U,1),1:""),C=$P(^DD(50.7,.01,0),U,2) D Y^DIQ:Y]"" W "   ",Y,@("$E("_DIC_"%I,0),0)") S Y=%I K %I
"^DD",53.79,53.79,0,"ID",.11)
W:$D(^(.1)) "   ",$P(^(.1),U,1)
"^DD",53.79,53.79,0,"IX","AADT",53.79,.06)

"^DD",53.79,53.79,0,"IX","ACHKPRN",53.79,.25)

"^DD",53.79,53.79,0,"IX","AEDT",53.79,.04)

"^DD",53.79,53.79,0,"IX","AOIP",53.79,.08)

"^DD",53.79,53.79,0,"IX","AOIP1",53.79,.06)

"^DD",53.79,53.79,0,"IX","AORD2",53.79,.13)

"^DD",53.79,53.79,0,"IX","APRN2",53.79,.12)

"^DD",53.79,53.79,0,"IX","AU06",53.79,.06)

"^DD",53.79,53.79,0,"IX","AU09",53.79,.09)

"^DD",53.79,53.79,0,"IX","AU16",53.79,.16)

"^DD",53.79,53.79,0,"IX","AU21",53.79,.21)

"^DD",53.79,53.79,0,"IX","AU22",53.79,.22)

"^DD",53.79,53.79,0,"IX","AVARCHK",53.79,.14)

"^DD",53.79,53.79,0,"IX","B",53.79,.01)

"^DD",53.79,53.79,0,"IX","E",53.796,.01)

"^DD",53.79,53.79,0,"IX","F",53.797,.01)

"^DD",53.79,53.79,0,"NM","BCMA MEDICATION LOG")

"^DD",53.79,53.79,0,"PT",53.78,.08)

"^DD",53.79,53.79,0,"VRPK")
PSB
"^DD",53.79,53.79,.01,0)
PATIENT NAME^RP2'^DPT(^0;1^Q
"^DD",53.79,53.79,.01,1,0)
^.1^^-1
"^DD",53.79,53.79,.01,1,1,0)
53.79^B
"^DD",53.79,53.79,.01,1,1,1)
S ^PSB(53.79,"B",$E(X,1,30),DA)=""
"^DD",53.79,53.79,.01,1,1,2)
K ^PSB(53.79,"B",$E(X,1,30),DA)
"^DD",53.79,53.79,.01,3)

"^DD",53.79,53.79,.01,21,0)
^^2^2^2990731^^^
"^DD",53.79,53.79,.01,21,1,0)
This field contains a pointer to the PATIENT File (#2) and is the patient
"^DD",53.79,53.79,.01,21,2,0)
that received the medication.
"^DD",53.79,53.79,.01,"DT")
3030221
"^DD",53.79,53.79,.02,0)
PATIENT LOCATION^F^^0;2^K:$L(X)>50!($L(X)<1) X
"^DD",53.79,53.79,.02,3)
Answer must be 1-50 characters in length.
"^DD",53.79,53.79,.02,21,0)
^^2^2^2990731^^
"^DD",53.79,53.79,.02,21,1,0)
Free text room-bed and ward location of the patient at the time of the med
"^DD",53.79,53.79,.02,21,2,0)
pass.
"^DD",53.79,53.79,.02,"DT")
2990319
"^DD",53.79,53.79,.03,0)
PATIENT DIVISION^RP4'^DIC(4,^0;3^Q
"^DD",53.79,53.79,.03,21,0)
^.001^1^1^3020306^^^^
"^DD",53.79,53.79,.03,21,1,0)
Division of the ward that this patient was on during the med pass.
"^DD",53.79,53.79,.03,"DT")
2990313
"^DD",53.79,53.79,.04,0)
ENTERED DATE/TIME^RD^^0;4^S %DT="ESTXR" D ^%DT S X=Y K:Y<1 X
"^DD",53.79,53.79,.04,1,0)
^.1
"^DD",53.79,53.79,.04,1,1,0)
53.79^AEDT^MUMPS
"^DD",53.79,53.79,.04,1,1,1)
S ^PSB(53.79,"AEDT",$P(^PSB(53.79,DA,0),U),X,DA)=""
"^DD",53.79,53.79,.04,1,1,2)
K ^PSB(53.79,"AEDT",$P(^PSB(53.79,DA,0),U),X,DA)
"^DD",53.79,53.79,.04,1,1,"%D",0)
^^3^3^2990731^
"^DD",53.79,53.79,.04,1,1,"%D",1,0)
Creates an entry by patient for date/time entries in the log were created.
"^DD",53.79,53.79,.04,1,1,"%D",2,0)
 
"^DD",53.79,53.79,.04,1,1,"%D",3,0)
  ^PSB(53.79,"AEDT",dfn,Entered Date/Time,DA)=""
"^DD",53.79,53.79,.04,1,1,"DT")
2990314
"^DD",53.79,53.79,.04,21,0)
^.001^1^1^3010411^^^
"^DD",53.79,53.79,.04,21,1,0)
Date and time the med pass was filed.  Defaults to NOW on record creation.
"^DD",53.79,53.79,.04,"DT")
2990314
"^DD",53.79,53.79,.05,0)
ENTERED BY^RP200'^VA(200,^0;5^Q
"^DD",53.79,53.79,.05,1,0)
^.1^^0
"^DD",53.79,53.79,.05,21,0)
^^1^1^2990731^^
"^DD",53.79,53.79,.05,21,1,0)
Pointer to the NEW PERSON file (#200).  Contains the user passing meds.
"^DD",53.79,53.79,.05,"DT")
3020426
"^DD",53.79,53.79,.06,0)
ACTION DATE/TIME^RD^^0;6^S %DT="ESTXR" D ^%DT S X=Y K:Y<1 X
"^DD",53.79,53.79,.06,1,0)
^.1^^-1
"^DD",53.79,53.79,.06,1,1,0)
53.79^AADT^MUMPS
"^DD",53.79,53.79,.06,1,1,1)
S ^PSB(53.79,"AADT",$P(^PSB(53.79,DA,0),U),X,DA)=""
"^DD",53.79,53.79,.06,1,1,2)
Q
"^DD",53.79,53.79,.06,1,1,"%D",0)
^.101^3^3^3020517^^^^
"^DD",53.79,53.79,.06,1,1,"%D",1,0)
Creates a cross reference by patient for administration times
"^DD",53.79,53.79,.06,1,1,"%D",2,0)
 
"^DD",53.79,53.79,.06,1,1,"%D",3,0)
  ^PSB(53.79,"AADT",dfn,administration d/t,DA)=""
"^DD",53.79,53.79,.06,1,1,"DT")
3020429
"^DD",53.79,53.79,.06,1,2,0)
53.79^AOIP1^MUMPS^^^^^^G
"^DD",53.79,53.79,.06,1,2,1)
I $P(^PSB(53.79,DA,0),U,8) S ^PSB(53.79,"AOIP",$P(^PSB(53.79,DA,0),U),$P(^PSB(53.79,DA,0),U,8),X,DA)=""
"^DD",53.79,53.79,.06,1,2,2)
I $P(^PSB(53.79,DA,0),U,8) K ^PSB(53.79,"AOIP",$P(^PSB(53.79,DA,0),U),$P(^PSB(53.79,DA,0),U,8),X,DA)
"^DD",53.79,53.79,.06,1,2,"%D",0)
^.101^6^6^3020410^^
"^DD",53.79,53.79,.06,1,2,"%D",1,0)
Creates a cross reference by patient for orderable items and
"^DD",53.79,53.79,.06,1,2,"%D",2,0)
administration date/time
"^DD",53.79,53.79,.06,1,2,"%D",3,0)
 
"^DD",53.79,53.79,.06,1,2,"%D",4,0)
  ^PSB(53.79,"AOIP",dfn,orderable item,administration d/t,DA)=""
"^DD",53.79,53.79,.06,1,2,"%D",5,0)
 
"^DD",53.79,53.79,.06,1,2,"%D",6,0)
Same as field ADMINISTRATION MEDICATION (#.08)
"^DD",53.79,53.79,.06,1,2,"DT")
2990427
"^DD",53.79,53.79,.06,1,4,0)
53.79^AU06^MUMPS
"^DD",53.79,53.79,.06,1,4,1)
D AUDIT^PSBUTL(DA,53.79,.06,X,"S")
"^DD",53.79,53.79,.06,1,4,2)
D AUDIT^PSBUTL(DA,53.79,.06,X,"K")
"^DD",53.79,53.79,.06,1,4,"%D",0)
^.101^1^1^3020412^^^^
"^DD",53.79,53.79,.06,1,4,"%D",1,0)
Creates an entry in this items audit log whenever changed or deleted.
"^DD",53.79,53.79,.06,1,4,"DT")
2990409
"^DD",53.79,53.79,.06,1,8,0)
^^TRIGGER^53.79^.14
"^DD",53.79,53.79,.06,1,8,1)
K DIV S DIV=X,D0=DA,DIV(0)=D0 S Y(0)=X I $P($G(^PSB(53.79,DA,.1)),U,2)="C"&($P($G(^(.1)),U,3)]"") I X S X=DIV S Y(1)=$S($D(^PSB(53.79,D0,.1)):^(.1),1:"") S X=$P(Y(1),U,4),X=X S DIU=X K Y X ^DD(53.79,.06,1,8,1.1) X ^DD(53.79,.06,1,8,1.4)
"^DD",53.79,53.79,.06,1,8,1.1)
S X=DIV X ^DD(53.79,.06,1,8,49.2) S X1=Y(1) S Y=$E(X1_"000",9,10)-$E(X_"000",9,10)*60+$E(X1_"00000",11,12)-$E(X_"00000",11,12),X2=X,X=$P(X,".",1)'=$P(X1,".",1) D ^%DTC:X S X=X*1440+Y
"^DD",53.79,53.79,.06,1,8,1.4)
S DIH=$S($D(^PSB(53.79,DIV(0),.1)):^(.1),1:""),DIV=X S $P(^(.1),U,4)=DIV,DIH=53.79,DIG=.14 D ^DICR:$O(^DD(DIH,DIG,1,0))>0
"^DD",53.79,53.79,.06,1,8,2)
K DIV S DIV=X,D0=DA,DIV(0)=D0 S Y(0)=X I $P($G(^PSB(53.79,DA,.1)),U,2)="C"&($P($G(^(.1)),U,3)]"") I X S X=DIV S Y(1)=$S($D(^PSB(53.79,D0,.1)):^(.1),1:"") S X=$P(Y(1),U,4),X=X S DIU=X K Y S X="" X ^DD(53.79,.06,1,8,2.4)
"^DD",53.79,53.79,.06,1,8,2.4)
S DIH=$S($D(^PSB(53.79,DIV(0),.1)):^(.1),1:""),DIV=X S $P(^(.1),U,4)=DIV,DIH=53.79,DIG=.14 D ^DICR:$O(^DD(DIH,DIG,1,0))>0
"^DD",53.79,53.79,.06,1,8,49.2)
S Y(2)=$S($D(^PSB(53.79,D0,.1)):^(.1),1:"") S X=DIV,Y(1)=X S X=$P(Y(2),U,3)
"^DD",53.79,53.79,.06,1,8,"CREATE CONDITION")
I $P($G(^PSB(53.79,DA,.1)),U,2)="C"&($P($G(^(.1)),U,3)]"")
"^DD",53.79,53.79,.06,1,8,"CREATE VALUE")
MINUTES(#.06,#.13)
"^DD",53.79,53.79,.06,1,8,"DELETE CONDITION")
I $P($G(^PSB(53.79,DA,.1)),U,2)="C"&($P($G(^(.1)),U,3)]"")
"^DD",53.79,53.79,.06,1,8,"DELETE VALUE")
@
"^DD",53.79,53.79,.06,1,8,"DT")
2990314
"^DD",53.79,53.79,.06,1,8,"FIELD")
#.14
"^DD",53.79,53.79,.06,21,0)
^.001^1^1^3020711^^^^
"^DD",53.79,53.79,.06,21,1,0)
Fileman Date/Time containing the actual time the med was administered.
"^DD",53.79,53.79,.06,"DT")
3030221
"^DD",53.79,53.79,.07,0)
ACTION BY^P200'^VA(200,^0;7^Q
"^DD",53.79,53.79,.07,21,0)
^^1^1^2990731^^
"^DD",53.79,53.79,.07,21,1,0)
Pointer to the NEW PERSON file (#200).  Contains the user passing meds.
"^DD",53.79,53.79,.07,"DT")
3010411
"^DD",53.79,53.79,.08,0)
ADMINISTRATION MEDICATION^RP50.7'^PS(50.7,^0;8^Q
"^DD",53.79,53.79,.08,1,0)
^.1
"^DD",53.79,53.79,.08,1,1,0)
53.79^AOIP^MUMPS
"^DD",53.79,53.79,.08,1,1,1)
I $P(^PSB(53.79,DA,0),U,6) S ^PSB(53.79,"AOIP",$P(^PSB(53.79,DA,0),U),X,+$P(^PSB(53.79,DA,0),U,6),DA)=""
"^DD",53.79,53.79,.08,1,1,2)
I $P(^PSB(53.79,DA,0),U,6) K ^PSB(53.79,"AOIP",$P(^PSB(53.79,DA,0),U),X,+$P(^PSB(53.79,DA,0),U,6),DA)
"^DD",53.79,53.79,.08,1,1,"%D",0)
^.101^6^6^3020430^^
"^DD",53.79,53.79,.08,1,1,"%D",1,0)
Creates a cross reference by patient for orderable items and
"^DD",53.79,53.79,.08,1,1,"%D",2,0)
administration date/time
"^DD",53.79,53.79,.08,1,1,"%D",3,0)
 
"^DD",53.79,53.79,.08,1,1,"%D",4,0)
  ^PSB(53.79,"AOIP",dfn,orderable item,administration d/t,DA)=""
"^DD",53.79,53.79,.08,1,1,"%D",5,0)
 
"^DD",53.79,53.79,.08,1,1,"%D",6,0)
Same as Field ADMINISTRATION DATE/TIME (#.06)
"^DD",53.79,53.79,.08,1,1,"DT")
2990427
"^DD",53.79,53.79,.08,21,0)
^^2^2^2990805^
"^DD",53.79,53.79,.08,21,1,0)
Pointer to ORDERABLE ITEM (#50.7) containing the medication entered for
"^DD",53.79,53.79,.08,21,2,0)
the order.
"^DD",53.79,53.79,.08,"DT")
2990427
"^DD",53.79,53.79,.09,0)
ACTION STATUS^RS^G:GIVEN;H:HELD;R:REFUSED;N:NOT GIVEN;RM:REMOVED;I:INFUSING;S:STOPPED;C:COMPLETED;M:MISSING DOSE;^0;9^Q
"^DD",53.79,53.79,.09,1,0)
^.1^^0
"^DD",53.79,53.79,.09,1,2,0)
53.79^AU09^MUMPS
"^DD",53.79,53.79,.09,1,2,1)
D AUDIT^PSBUTL(DA,53.79,.09,X,"S")
"^DD",53.79,53.79,.09,1,2,2)
D AUDIT^PSBUTL(DA,53.79,.09,X,"K")
"^DD",53.79,53.79,.09,1,2,"%D",0)
^.101^1^1^3020425^^^
"^DD",53.79,53.79,.09,1,2,"%D",1,0)
Creates an entry in this items audit log whenever changed or deleted.
"^DD",53.79,53.79,.09,1,2,"DT")
2990409
"^DD",53.79,53.79,.09,21,0)
^.001^1^1^3020226^^^^
"^DD",53.79,53.79,.09,21,1,0)
Status of administration (H:Held,R:Refused,G:Given,N:NOT GIVEN)
"^DD",53.79,53.79,.09,"DT")
3020226
"^DD",53.79,53.79,.11,0)
ORDER REFERENCE NUMBER^RF^^.1;1^K:$L(X)>15!($L(X)<1)!'(X?.N1"U"!(X?.N1"V")!(X?.N1"P")) X
"^DD",53.79,53.79,.11,1,0)
^.1^^0
"^DD",53.79,53.79,.11,3)
Answer must be 1-15 characters in length.
"^DD",53.79,53.79,.11,21,0)
^^2^2^2990805^
"^DD",53.79,53.79,.11,21,1,0)
Contains the IEN to the actual order in PHARMACY PATIENT (#55) followed by
"^DD",53.79,53.79,.11,21,2,0)
a U for Unit Dose or V for IV
"^DD",53.79,53.79,.11,"DT")
3010509
"^DD",53.79,53.79,.12,0)
ORDER SCHEDULE^S^C:CONTINUOUS;P:PRN;O:ONE-TIME;OC:ON-CALL;^.1;2^Q
"^DD",53.79,53.79,.12,1,0)
^.1
"^DD",53.79,53.79,.12,1,1,0)
53.79^APRN2^MUMPS
"^DD",53.79,53.79,.12,1,1,1)
S:X="P"&($P(^PSB(53.79,DA,0),U,4)) ^PSB(53.79,"APRN",$P(^PSB(53.79,DA,0),U,1),$P(^PSB(53.79,DA,0),U,4),DA)=""
"^DD",53.79,53.79,.12,1,1,2)
K:X="P"&($P(^PSB(53.79,DA,0),U,4)) ^PSB(53.79,"APRN",$P(^PSB(53.79,DA,0),U,1),$P(^PSB(53.79,DA,0),U,4),DA)
"^DD",53.79,53.79,.12,1,1,"%D",0)
^^6^6^2990731^
"^DD",53.79,53.79,.12,1,1,"%D",1,0)
Creates an index for all PRN administered medications for recall with the
"^DD",53.79,53.79,.12,1,1,"%D",2,0)
PRN effectiveness options.
"^DD",53.79,53.79,.12,1,1,"%D",3,0)
 
"^DD",53.79,53.79,.12,1,1,"%D",4,0)
  ^PSB(53.79,"APRN",dfn,entered date/time,DA)=""
"^DD",53.79,53.79,.12,1,1,"%D",5,0)
 
"^DD",53.79,53.79,.12,1,1,"%D",6,0)
  NOTE: This is entered date/time (#.04), not administered date/time.
"^DD",53.79,53.79,.12,1,1,"DT")
2990427
"^DD",53.79,53.79,.12,21,0)
^^1^1^2990805^
"^DD",53.79,53.79,.12,21,1,0)
Contains the schedule type of the order.
"^DD",53.79,53.79,.12,"DT")
2990427
"^DD",53.79,53.79,.13,0)
SCHEDULED ADMINISTRATION TIME^D^^.1;3^S %DT="ETXR" D ^%DT S X=Y K:Y<1 X
"^DD",53.79,53.79,.13,1,0)
^.1
"^DD",53.79,53.79,.13,1,1,0)
53.79^AORD2^MUMPS
"^DD",53.79,53.79,.13,1,1,1)
I $P($G(^PSB(53.79,DA,.1)),U,1)]"" S ^PSB(53.79,"AORD",$P(^PSB(53.79,DA,0),U),$P(^PSB(53.79,DA,.1),U),X,DA)=""
"^DD",53.79,53.79,.13,1,1,2)
I $P($G(^PSB(53.79,DA,.1)),U,1)]"" K ^PSB(53.79,"AORD",$P(^PSB(53.79,DA,0),U),$P(^PSB(53.79,DA,.1),U),X,DA)
"^DD",53.79,53.79,.13,1,1,"%D",0)
^^4^4^2990731^
"^DD",53.79,53.79,.13,1,1,"%D",1,0)
Creates an index by patient for Order reference number and administration
"^DD",53.79,53.79,.13,1,1,"%D",2,0)
time.
"^DD",53.79,53.79,.13,1,1,"%D",3,0)
 
"^DD",53.79,53.79,.13,1,1,"%D",4,0)
  ^PSB(53.79,"AORD",dfn,order reference,administration date/time,DA)=""
"^DD",53.79,53.79,.13,1,1,"DT")
2990427
"^DD",53.79,53.79,.13,1,8,0)
^^TRIGGER^53.79^.14
"^DD",53.79,53.79,.13,1,8,1)
K DIV S DIV=X,D0=DA,DIV(0)=D0 S Y(0)=X I $P(^PSB(53.79,DA,0),U,6)&($P($G(^(.1)),U,2)="C") I X S X=DIV S Y(1)=$S($D(^PSB(53.79,D0,.1)):^(.1),1:"") S X=$P(Y(1),U,4),X=X S DIU=X K Y X ^DD(53.79,.13,1,8,1.1) X ^DD(53.79,.13,1,8,1.4)
"^DD",53.79,53.79,.13,1,8,1.1)
S X=DIV X ^DD(53.79,.13,1,8,49.2) S X1=Y(2) S Y=$E(X1_"000",9,10)-$E(X_"000",9,10)*60+$E(X1_"00000",11,12)-$E(X_"00000",11,12),X2=X,X=$P(X,".",1)'=$P(X1,".",1) D ^%DTC:X S X=X*1440+Y
"^DD",53.79,53.79,.13,1,8,1.4)
S DIH=$S($D(^PSB(53.79,DIV(0),.1)):^(.1),1:""),DIV=X S $P(^(.1),U,4)=DIV,DIH=53.79,DIG=.14 D ^DICR:$O(^DD(DIH,DIG,1,0))>0
"^DD",53.79,53.79,.13,1,8,2)
K DIV S DIV=X,D0=DA,DIV(0)=D0 S Y(0)=X I $P(^PSB(53.79,DA,0),U,6)&($P($G(^(.1)),U,2)="C") I X S X=DIV S Y(1)=$S($D(^PSB(53.79,D0,.1)):^(.1),1:"") S X=$P(Y(1),U,4),X=X S DIU=X K Y S X="" X ^DD(53.79,.13,1,8,2.4)
"^DD",53.79,53.79,.13,1,8,2.4)
S DIH=$S($D(^PSB(53.79,DIV(0),.1)):^(.1),1:""),DIV=X S $P(^(.1),U,4)=DIV,DIH=53.79,DIG=.14 D ^DICR:$O(^DD(DIH,DIG,1,0))>0
"^DD",53.79,53.79,.13,1,8,49.2)
S Y(1)=$S($D(^PSB(53.79,D0,0)):^(0),1:"") S X=$P(Y(1),U,6),Y(2)=X S X=DIV
"^DD",53.79,53.79,.13,1,8,"CREATE CONDITION")
I $P(^PSB(53.79,DA,0),U,6)&($P($G(^(.1)),U,2)="C")
"^DD",53.79,53.79,.13,1,8,"CREATE VALUE")
MINUTES(#.06,#.13)
"^DD",53.79,53.79,.13,1,8,"DELETE CONDITION")
I $P(^PSB(53.79,DA,0),U,6)&($P($G(^(.1)),U,2)="C")
"^DD",53.79,53.79,.13,1,8,"DELETE VALUE")
@
"^DD",53.79,53.79,.13,1,8,"FIELD")
#.14
"^DD",53.79,53.79,.13,21,0)
^^2^2^2990805^
"^DD",53.79,53.79,.13,21,1,0)
If a continuous order this field will contain the actual administration
"^DD",53.79,53.79,.13,21,2,0)
date and time the medication was ordered for.
"^DD",53.79,53.79,.13,"DT")
3010411
"^DD",53.79,53.79,.14,0)
ORDER ADMINISTRATION VARIANCE^NJ5,0^^.1;4^K:+X'=X!(X>99999)!(X<-99999)!(X?.E1"."1N.N) X
"^DD",53.79,53.79,.14,1,0)
^.1
"^DD",53.79,53.79,.14,1,1,0)
53.79^AVARCHK^MUMPS
"^DD",53.79,53.79,.14,1,1,1)
D CHECK^PSBVAR(+$G(^PSB(53.79,DA,0)),X,DA)
"^DD",53.79,53.79,.14,1,1,2)
Q
"^DD",53.79,53.79,.14,1,1,"%D",0)
^^3^3^2990731^
"^DD",53.79,53.79,.14,1,1,"%D",1,0)
This field is triggered by the administration date/time.  If this field is
"^DD",53.79,53.79,.14,1,1,"%D",2,0)
greater than or less than the allowable administration window times for
"^DD",53.79,53.79,.14,1,1,"%D",3,0)
this division a variance will be filed.
"^DD",53.79,53.79,.14,1,1,"DT")
2990414
"^DD",53.79,53.79,.14,3)
Type a Number between -99999 and 99999, 0 Decimal Digits
"^DD",53.79,53.79,.14,5,1,0)
53.79^.06^8
"^DD",53.79,53.79,.14,5,2,0)
53.79^.13^8
"^DD",53.79,53.79,.14,9)
^
"^DD",53.79,53.79,.14,21,0)
^.001^2^2^3011018^^^
"^DD",53.79,53.79,.14,21,1,0)
If a continuous order this field contains the minutes early (<1) or Late
"^DD",53.79,53.79,.14,21,2,0)
(>1) that the medication was given.
"^DD",53.79,53.79,.14,"DT")
2990414
"^DD",53.79,53.79,.15,0)
ORDER DOSAGE^F^^.1;5^K:$L(X)>60!($L(X)<1) X
"^DD",53.79,53.79,.15,3)
Answer must be 1-60 characters in length.
"^DD",53.79,53.79,.15,21,0)
^^1^1^2990731^^
"^DD",53.79,53.79,.15,21,1,0)
Free text field containing the dosage from the original order.
"^DD",53.79,53.79,.15,"DT")
2990409
"^DD",53.79,53.79,.16,0)
INJECTION SITE^F^^.1;6^K:$L(X)>30!($L(X)<1) X
"^DD",53.79,53.79,.16,1,0)
^.1
"^DD",53.79,53.79,.16,1,1,0)
53.79^AU16^MUMPS
"^DD",53.79,53.79,.16,1,1,1)
D AUDIT^PSBUTL(DA,53.79,.16,X,"S")
"^DD",53.79,53.79,.16,1,1,2)
D AUDIT^PSBUTL(DA,53.79,.16,X,"K")
"^DD",53.79,53.79,.16,1,1,"%D",0)
^.101^1^1^3010504^^
"^DD",53.79,53.79,.16,1,1,"%D",1,0)
Creates an entry in this items audit log whenever changed or deleted.
"^DD",53.79,53.79,.16,1,1,"DT")
2990409
"^DD",53.79,53.79,.16,3)
Answer must be 1-30 characters in length.
"^DD",53.79,53.79,.16,21,0)
^^2^2^2990805^
"^DD",53.79,53.79,.16,21,1,0)
Free text field containing the injection site of medication that are
"^DD",53.79,53.79,.16,21,2,0)
injected.
"^DD",53.79,53.79,.16,"DT")
2990409
"^DD",53.79,53.79,.21,0)
PRN REASON^F^^.2;1^K:$L(X)>30!($L(X)<1) X
"^DD",53.79,53.79,.21,1,0)
^.1
"^DD",53.79,53.79,.21,1,1,0)
53.79^AU21^MUMPS
"^DD",53.79,53.79,.21,1,1,1)
D AUDIT^PSBUTL(DA,53.79,.21,X,"S")
"^DD",53.79,53.79,.21,1,1,2)
D AUDIT^PSBUTL(DA,53.79,.21,X,"K")
"^DD",53.79,53.79,.21,1,1,"%D",0)
^^1^1^2990731^
"^DD",53.79,53.79,.21,1,1,"%D",1,0)
Creates an entry in this items audit log whenever changed or deleted.
"^DD",53.79,53.79,.21,1,1,"DT")
2990409
"^DD",53.79,53.79,.21,3)
Answer must be 1-30 characters in length.
"^DD",53.79,53.79,.21,21,0)
^^1^1^2990731^^
"^DD",53.79,53.79,.21,21,1,0)
Free text field containing the PRN reason for a PRN med being given.
"^DD",53.79,53.79,.21,"DT")
2990422
"^DD",53.79,53.79,.22,0)
PRN EFFECTIVENESS^F^^.2;2^K:$L(X)>150!($L(X)<1) X
"^DD",53.79,53.79,.22,1,0)
^.1
"^DD",53.79,53.79,.22,1,1,0)
^^TRIGGER^53.79^.24
"^DD",53.79,53.79,.22,1,1,1)
K DIV S DIV=X,D0=DA,DIV(0)=D0 S Y(1)=$S($D(^PSB(53.79,D0,.2)):^(.2),1:"") S X=$P(Y(1),U,4),X=X S DIU=X K Y X ^DD(53.79,.22,1,1,1.1) X ^DD(53.79,.22,1,1,1.4)
"^DD",53.79,53.79,.22,1,1,1.1)
S X=DIV S %=$P($H,",",2),X=DT_(%\60#60/100+(%\3600)+(%#60/10000)/100)
"^DD",53.79,53.79,.22,1,1,1.4)
S DIH=$S($D(^PSB(53.79,DIV(0),.2)):^(.2),1:""),DIV=X S $P(^(.2),U,4)=DIV,DIH=53.79,DIG=.24 D ^DICR:$O(^DD(DIH,DIG,1,0))>0
"^DD",53.79,53.79,.22,1,1,2)
K DIV S DIV=X,D0=DA,DIV(0)=D0 S Y(1)=$S($D(^PSB(53.79,D0,.2)):^(.2),1:"") S X=$P(Y(1),U,4),X=X S DIU=X K Y S X="" X ^DD(53.79,.22,1,1,2.4)
"^DD",53.79,53.79,.22,1,1,2.4)
S DIH=$S($D(^PSB(53.79,DIV(0),.2)):^(.2),1:""),DIV=X S $P(^(.2),U,4)=DIV,DIH=53.79,DIG=.24 D ^DICR:$O(^DD(DIH,DIG,1,0))>0
"^DD",53.79,53.79,.22,1,1,"CREATE VALUE")
NOW
"^DD",53.79,53.79,.22,1,1,"DELETE VALUE")
@
"^DD",53.79,53.79,.22,1,1,"DT")
2990322
"^DD",53.79,53.79,.22,1,1,"FIELD")
PRN EFFECTIVENESS ENTERED AT
"^DD",53.79,53.79,.22,1,2,0)
^^TRIGGER^53.79^.23
"^DD",53.79,53.79,.22,1,2,1)
K DIV S DIV=X,D0=DA,DIV(0)=D0 S Y(1)=$S($D(^PSB(53.79,D0,.2)):^(.2),1:"") S X=$P(Y(1),U,3),X=X S DIU=X K Y S X=DIV S X=DUZ X ^DD(53.79,.22,1,2,1.4)
"^DD",53.79,53.79,.22,1,2,1.4)
S DIH=$S($D(^PSB(53.79,DIV(0),.2)):^(.2),1:""),DIV=X S $P(^(.2),U,3)=DIV,DIH=53.79,DIG=.23 D ^DICR:$O(^DD(DIH,DIG,1,0))>0
"^DD",53.79,53.79,.22,1,2,2)
K DIV S DIV=X,D0=DA,DIV(0)=D0 S Y(1)=$S($D(^PSB(53.79,D0,.2)):^(.2),1:"") S X=$P(Y(1),U,3),X=X S DIU=X K Y S X="" X ^DD(53.79,.22,1,2,2.4)
"^DD",53.79,53.79,.22,1,2,2.4)
S DIH=$S($D(^PSB(53.79,DIV(0),.2)):^(.2),1:""),DIV=X S $P(^(.2),U,3)=DIV,DIH=53.79,DIG=.23 D ^DICR:$O(^DD(DIH,DIG,1,0))>0
"^DD",53.79,53.79,.22,1,2,"CREATE VALUE")
S X=DUZ
"^DD",53.79,53.79,.22,1,2,"DELETE VALUE")
@
"^DD",53.79,53.79,.22,1,2,"DT")
2990322
"^DD",53.79,53.79,.22,1,2,"FIELD")
PRN EFFECTIVENESS ENTERED BY
"^DD",53.79,53.79,.22,1,3,0)
53.79^AU22^MUMPS
"^DD",53.79,53.79,.22,1,3,1)
D AUDIT^PSBUTL(DA,53.79,.22,X,"S")
"^DD",53.79,53.79,.22,1,3,2)
D AUDIT^PSBUTL(DA,53.79,.22,X,"K")
"^DD",53.79,53.79,.22,1,3,"%D",0)
^^1^1^2990731^
"^DD",53.79,53.79,.22,1,3,"%D",1,0)
Creates an entry in this items audit log whenever changed or deleted.
"^DD",53.79,53.79,.22,1,3,"DT")
2990409
"^DD",53.79,53.79,.22,3)
Answer must be 1-150 characters in length.
"^DD",53.79,53.79,.22,21,0)
^^1^1^2990731^^
"^DD",53.79,53.79,.22,21,1,0)
Free text field containing the effectiveness of a PRN medication.
"^DD",53.79,53.79,.22,"DT")
2990422
"^DD",53.79,53.79,.23,0)
PRN EFFECTIVENESS ENTERED BY^P200'^VA(200,^.2;3^Q
"^DD",53.79,53.79,.23,5,1,0)
53.79^.22^2
"^DD",53.79,53.79,.23,21,0)
^^2^2^2990731^^
"^DD",53.79,53.79,.23,21,1,0)
Pointer to file NEW PERSON (#200) with the IEN of the user logging the PRN
"^DD",53.79,53.79,.23,21,2,0)
effectiveness.
"^DD",53.79,53.79,.23,"DT")
2990313
"^DD",53.79,53.79,.24,0)
PRN EFFECTIVENESS ENTERED AT^D^^.2;4^S %DT="ETXR" D ^%DT S X=Y K:Y<1 X
"^DD",53.79,53.79,.24,1,0)
^.1
"^DD",53.79,53.79,.24,1,1,0)
^^TRIGGER^53.79^.25
"^DD",53.79,53.79,.24,1,1,1)
K DIV S DIV=X,D0=DA,DIV(0)=D0 S Y(1)=$S($D(^PSB(53.79,D0,.2)):^(.2),1:"") S X=$P(Y(1),U,5),X=X S DIU=X K Y X ^DD(53.79,.24,1,1,1.1) X ^DD(53.79,.24,1,1,1.4)
"^DD",53.79,53.79,.24,1,1,1.1)
S X=DIV X ^DD(53.79,.24,1,1,49.2) S X1=Y(1) S Y=$E(X1_"000",9,10)-$E(X_"000",9,10)*60+$E(X1_"00000",11,12)-$E(X_"00000",11,12),X2=X,X=$P(X,".",1)'=$P(X1,".",1) D ^%DTC:X S X=X*1440+Y
"^DD",53.79,53.79,.24,1,1,1.4)
S DIH=$S($D(^PSB(53.79,DIV(0),.2)):^(.2),1:""),DIV=X S $P(^(.2),U,5)=DIV,DIH=53.79,DIG=.25 D ^DICR:$O(^DD(DIH,DIG,1,0))>0
"^DD",53.79,53.79,.24,1,1,2)
K DIV S DIV=X,D0=DA,DIV(0)=D0 S Y(1)=$S($D(^PSB(53.79,D0,.2)):^(.2),1:"") S X=$P(Y(1),U,5),X=X S DIU=X K Y S X="" X ^DD(53.79,.24,1,1,2.4)
"^DD",53.79,53.79,.24,1,1,2.4)
S DIH=$S($D(^PSB(53.79,DIV(0),.2)):^(.2),1:""),DIV=X S $P(^(.2),U,5)=DIV,DIH=53.79,DIG=.25 D ^DICR:$O(^DD(DIH,DIG,1,0))>0
"^DD",53.79,53.79,.24,1,1,49.2)
S Y(2)=$S($D(^PSB(53.79,D0,0)):^(0),1:"") S X=DIV,Y(1)=X S X=$P(Y(2),U,6)
"^DD",53.79,53.79,.24,1,1,"CREATE VALUE")
MINUTES(#.24,#.06)
"^DD",53.79,53.79,.24,1,1,"DELETE VALUE")
@
"^DD",53.79,53.79,.24,1,1,"DT")
2990324
"^DD",53.79,53.79,.24,1,1,"FIELD")
PRN EFFECTIVENESS MINUTES
"^DD",53.79,53.79,.24,5,1,0)
53.79^.22^1
"^DD",53.79,53.79,.24,21,0)
^^1^1^2990731^^
"^DD",53.79,53.79,.24,21,1,0)
Date/time the PRN effectiveness was charted.
"^DD",53.79,53.79,.24,"DT")
2990324
"^DD",53.79,53.79,.25,0)
PRN EFFECTIVENESS MINUTES^NJ5,0^^.2;5^K:+X'=X!(X>99999)!(X<-99999)!(X?.E1"."1N.N) X
"^DD",53.79,53.79,.25,1,0)
^.1
"^DD",53.79,53.79,.25,1,1,0)
53.79^ACHKPRN^MUMPS
"^DD",53.79,53.79,.25,1,1,1)
D CHKPRN^PSBVAR(+$G(^PSB(53.79,DA,0)),X,DA)
"^DD",53.79,53.79,.25,1,1,2)
Q
"^DD",53.79,53.79,.25,1,1,"%D",0)
^^3^3^2990731^
"^DD",53.79,53.79,.25,1,1,"%D",1,0)
This field is triggered by the PRN EFFECTIVENESS DATE/TIME field. If this
"^DD",53.79,53.79,.25,1,1,"%D",2,0)
field is greater than the allowable PRN EFFECTIVENESS window times for
"^DD",53.79,53.79,.25,1,1,"%D",3,0)
this division a variance will be filed.
"^DD",53.79,53.79,.25,1,1,"DT")
2990428
"^DD",53.79,53.79,.25,3)
Type a Number between -99999 and 99999, 0 Decimal Digits
"^DD",53.79,53.79,.25,5,1,0)
53.79^.24^1
"^DD",53.79,53.79,.25,9)
^
"^DD",53.79,53.79,.25,21,0)
^^2^2^2990731^^
"^DD",53.79,53.79,.25,21,1,0)
Number of minutes from administration to the charting of PRN
"^DD",53.79,53.79,.25,21,2,0)
effectiveness.
"^DD",53.79,53.79,.25,"DT")
2990428
"^DD",53.79,53.79,.26,0)
IV UNIQUE ID^F^^0;10^K:$L(X)>30!($L(X)<3) X
"^DD",53.79,53.79,.26,1,0)
^.1^^0
"^DD",53.79,53.79,.26,3)
Answer must be 3-30 characters in length
"^DD",53.79,53.79,.26,21,0)
^^2^2^3010919^
"^DD",53.79,53.79,.26,21,1,0)
This is the unique ID number of an IV bag, which is generated from
"^DD",53.79,53.79,.26,21,2,0)
Inpatient Medications.
"^DD",53.79,53.79,.26,"DT")
3010919
"^DD",53.79,53.79,.27,0)
PRN REASON FLAG^NJ1,0^^0;12^K:+X'=X!(X>1)!(X<0)!(X?.E1"."1.N) X
"^DD",53.79,53.79,.27,3)
Type a number between 0 and 1, 0 Decimal Digits
"^DD",53.79,53.79,.27,21,0)
^^3^3^3031104^^
"^DD",53.79,53.79,.27,21,1,0)
The PRN REASON FLAG field is to indicate whether the BCMA Med Log file
"^DD",53.79,53.79,.27,21,2,0)
entry is PRN activity and has an associated PRN REASON which has been set 
"^DD",53.79,53.79,.27,21,3,0)
to require BCMA user attention or action.
"^DD",53.79,53.79,.27,"DT")
3031104
"^DD",53.79,53.79,.3,0)
COMMENT^53.793^^.3;0
"^DD",53.79,53.79,.3,21,0)
^^1^1^2990805^
"^DD",53.79,53.79,.3,21,1,0)
Multiple containing the comments entered for each med pass.
"^DD",53.79,53.79,.35,0)
INFUSION RATE^F^^0;11^K:$L(X)>47!($L(X)<1) X
"^DD",53.79,53.79,.35,3)
Answer must be 1-47 characters in length.
"^DD",53.79,53.79,.35,21,0)
^.001^2^2^3030225^^
"^DD",53.79,53.79,.35,21,1,0)
This is the infusion rate for an IV bag, which is passed by Inpatient
"^DD",53.79,53.79,.35,21,2,0)
Medications.
"^DD",53.79,53.79,.35,"DT")
3030225
"^DD",53.79,53.79,.5,0)
DISPENSE DRUG^53.795P^^.5;0
"^DD",53.79,53.79,.6,0)
ADDITIVES^53.796P^^.6;0
"^DD",53.79,53.79,.7,0)
SOLUTIONS^53.797P^^.7;0
"^DD",53.79,53.79,.9,0)
AUDIT LOG^53.799D^^.9;0
"^DD",53.79,53.793,0)
COMMENT SUB-FIELD^^.03^3
"^DD",53.79,53.793,0,"DT")
2990319
"^DD",53.79,53.793,0,"NM","COMMENT")

"^DD",53.79,53.793,0,"UP")
53.79
"^DD",53.79,53.793,.01,0)
COMMENT^MF^^0;1^K:$L(X)>150!($L(X)<1) X
"^DD",53.79,53.793,.01,1,0)
^.1^^0
"^DD",53.79,53.793,.01,3)
Answer must be 1-150 characters in length.
"^DD",53.79,53.793,.01,21,0)
^^1^1^2990731^
"^DD",53.79,53.793,.01,21,1,0)
Text of comment entered by the user.
"^DD",53.79,53.793,.01,"DT")
2990323
"^DD",53.79,53.793,.02,0)
ENTERED BY^P200'^VA(200,^0;2^Q
"^DD",53.79,53.793,.02,21,0)
^^1^1^2990731^
"^DD",53.79,53.793,.02,21,1,0)
Pointer to the NEW PERSON file (#200) of the user making the comment.
"^DD",53.79,53.793,.02,"DT")
2990319
"^DD",53.79,53.793,.03,0)
ENTERED DATE/TIME^D^^0;3^S %DT="ESTX" D ^%DT S X=Y K:Y<1 X
"^DD",53.79,53.793,.03,21,0)
^^1^1^2990731^
"^DD",53.79,53.793,.03,21,1,0)
Date/Time the comment was filed against this entry.
"^DD",53.79,53.793,.03,"DT")
2990319
"^DD",53.79,53.795,0)
DISPENSE DRUG SUB-FIELD^^.04^4
"^DD",53.79,53.795,0,"DT")
3020605
"^DD",53.79,53.795,0,"IX","AU303",53.795,.03)

"^DD",53.79,53.795,0,"IX","AU304",53.795,.04)

"^DD",53.79,53.795,0,"IX","B",53.795,.01)

"^DD",53.79,53.795,0,"NM","DISPENSE DRUG")

"^DD",53.79,53.795,0,"UP")
53.79
"^DD",53.79,53.795,.01,0)
DISPENSE DRUG^MP50'^PSDRUG(^0;1^Q
"^DD",53.79,53.795,.01,1,0)
^.1
"^DD",53.79,53.795,.01,1,1,0)
53.795^B
"^DD",53.79,53.795,.01,1,1,1)
S ^PSB(53.79,DA(1),.5,"B",$E(X,1,30),DA)=""
"^DD",53.79,53.795,.01,1,1,2)
K ^PSB(53.79,DA(1),.5,"B",$E(X,1,30),DA)
"^DD",53.79,53.795,.01,21,0)
^.001^2^2^3020322^^^
"^DD",53.79,53.795,.01,21,1,0)
Pointer to the drug file.  Contains the actual medication scanned for this
"^DD",53.79,53.795,.01,21,2,0)
entry.
"^DD",53.79,53.795,.01,"AUDIT")

"^DD",53.79,53.795,.01,"DT")
2990313
"^DD",53.79,53.795,.02,0)
DOSES ORDERED^NJ7,4^^0;2^K:+X'=X!(X>50)!(X<0)!(X?.E1"."5N.N) X
"^DD",53.79,53.795,.02,3)
Type a Number between 0 and 50, 4 Decimal Digits
"^DD",53.79,53.795,.02,21,0)
^.001^1^1^3020605^^^^
"^DD",53.79,53.795,.02,21,1,0)
Number of units from the PHARMACY PATIENT file (#55)
"^DD",53.79,53.795,.02,"DT")
3020605
"^DD",53.79,53.795,.03,0)
DOSES GIVEN^NJ7,4^^0;3^K:+X'=X!(X>50)!(X<0)!(X?.E1"."5N.N) X
"^DD",53.79,53.795,.03,1,0)
^.1
"^DD",53.79,53.795,.03,1,1,0)
53.795^AU303^MUMPS
"^DD",53.79,53.795,.03,1,1,1)
D AUDIT^PSBUTL(DA(1),53.795,.03,X,"S")
"^DD",53.79,53.795,.03,1,1,2)
D AUDIT^PSBUTL(DA(1),53.795,.03,X,"K")
"^DD",53.79,53.795,.03,1,1,"%D",0)
^^1^1^2990731^
"^DD",53.79,53.795,.03,1,1,"%D",1,0)
Creates an entry in this items audit log whenever changed or deleted.
"^DD",53.79,53.795,.03,1,1,"DT")
2990409
"^DD",53.79,53.795,.03,3)
Type a Number between 0 and 50, 4 Decimal Digits
"^DD",53.79,53.795,.03,21,0)
^.001^1^1^3020605^^^^
"^DD",53.79,53.795,.03,21,1,0)
Actual number of units given.
"^DD",53.79,53.795,.03,"DT")
3020605
"^DD",53.79,53.795,.04,0)
UNIT OF ADMINISTRATION^F^^0;4^K:$L(X)>40!($L(X)<1) X
"^DD",53.79,53.795,.04,1,0)
^.1^^-1
"^DD",53.79,53.795,.04,1,1,0)
53.795^AU304^MUMPS
"^DD",53.79,53.795,.04,1,1,1)
D AUDIT^PSBUTL(DA(1),53.795,.04,X,"S")
"^DD",53.79,53.795,.04,1,1,2)
D AUDIT^PSBUTL(DA(1),53.795,.04,X,"K")
"^DD",53.79,53.795,.04,1,1,"%D",0)
^^1^1^2990731^
"^DD",53.79,53.795,.04,1,1,"%D",1,0)
Creates an entry in this items audit log whenever changed or deleted.
"^DD",53.79,53.795,.04,1,1,"DT")
2990409
"^DD",53.79,53.795,.04,3)
Answer must be 1-40 characters in length.
"^DD",53.79,53.795,.04,21,0)
^^1^1^2990731^
"^DD",53.79,53.795,.04,21,1,0)
Unit of administration (i.e. TABLET, ML, VIAL)
"^DD",53.79,53.795,.04,"DT")
3030313
"^DD",53.79,53.796,0)
ADDITIVES SUB-FIELD^^.04^4
"^DD",53.79,53.796,0,"DT")
2990409
"^DD",53.79,53.796,0,"IX","AU603",53.796,.03)

"^DD",53.79,53.796,0,"IX","AU604",53.796,.04)

"^DD",53.79,53.796,0,"IX","B",53.796,.01)

"^DD",53.79,53.796,0,"NM","ADDITIVES")

"^DD",53.79,53.796,0,"UP")
53.79
"^DD",53.79,53.796,.01,0)
ADDITIVES^MP52.6'^PS(52.6,^0;1^Q
"^DD",53.79,53.796,.01,1,0)
^.1^^-1
"^DD",53.79,53.796,.01,1,1,0)
53.796^B
"^DD",53.79,53.796,.01,1,1,1)
S ^PSB(53.79,DA(1),.6,"B",$E(X,1,30),DA)=""
"^DD",53.79,53.796,.01,1,1,2)
K ^PSB(53.79,DA(1),.6,"B",$E(X,1,30),DA)
"^DD",53.79,53.796,.01,1,3,0)
53.79^E^MUMPS
"^DD",53.79,53.796,.01,1,3,1)
I $P(^PSB(53.79,DA,0),U,6) S ^PSB(53.79,"AOIP3",$P(^PSB(53.79,DA(1),0),U),DA(1),X)=""
"^DD",53.79,53.796,.01,1,3,2)
I $P(^PSB(53.79,DA,0),U,6) K ^PSB(53.79,"AOIP3",$P(^PSB(53.79,DA(1),0),U),DA(1),X)
"^DD",53.79,53.796,.01,1,3,"%D",0)
^.101^2^2^3031209^^^^
"^DD",53.79,53.796,.01,1,3,"%D",1,0)
CROSS REFERENCE for multiple ADDITIVES.
"^DD",53.79,53.796,.01,1,3,"%D",2,0)
PSB(53.79,"AOIP3",DFN,ORDERABLE IEN,ADDITIVE,)
"^DD",53.79,53.796,.01,1,3,"DT")
3030421
"^DD",53.79,53.796,.01,21,0)
^^2^2^2990731^
"^DD",53.79,53.796,.01,21,1,0)
Pointer to the additives file.  Filled in automatically with the ordered
"^DD",53.79,53.796,.01,21,2,0)
additives when marked as given.
"^DD",53.79,53.796,.01,"DT")
3030520
"^DD",53.79,53.796,.02,0)
DOSE ORDERED^F^^0;2^K:$L(X)>30!($L(X)<1) X
"^DD",53.79,53.796,.02,3)
Answer must be 1-30 characters in length.
"^DD",53.79,53.796,.02,21,0)
^^1^1^2990731^
"^DD",53.79,53.796,.02,21,1,0)
Dosage from the actual IV order.
"^DD",53.79,53.796,.02,"DT")
2990409
"^DD",53.79,53.796,.03,0)
DOSE GIVEN^F^^0;3^K:$L(X)>30!($L(X)<1) X
"^DD",53.79,53.796,.03,1,0)
^.1
"^DD",53.79,53.796,.03,1,1,0)
53.796^AU603^MUMPS
"^DD",53.79,53.796,.03,1,1,1)
D AUDIT^PSBUTL(DA(1),53.796,.03,X,"S")
"^DD",53.79,53.796,.03,1,1,2)
D AUDIT^PSBUTL(DA(1),53.796,.03,X,"K")
"^DD",53.79,53.796,.03,1,1,"%D",0)
^^1^1^2990731^
"^DD",53.79,53.796,.03,1,1,"%D",1,0)
Creates an entry in this items audit log whenever changed or deleted.
"^DD",53.79,53.796,.03,1,1,"DT")
2990409
"^DD",53.79,53.796,.03,3)
Answer must be 1-30 characters in length.
"^DD",53.79,53.796,.03,21,0)
^^1^1^2990731^
"^DD",53.79,53.796,.03,21,1,0)
Actual dosing performed by administration clinician.
"^DD",53.79,53.796,.03,"DT")
2990409
"^DD",53.79,53.796,.04,0)
UNIT OF ADMINISTRATION^F^^0;4^K:$L(X)>20!($L(X)<1) X
"^DD",53.79,53.796,.04,1,0)
^.1
"^DD",53.79,53.796,.04,1,1,0)
53.796^AU604^MUMPS
"^DD",53.79,53.796,.04,1,1,1)
D AUDIT^PSBUTL(DA(1),53.796,.04,X,"S")
"^DD",53.79,53.796,.04,1,1,2)
D AUDIT^PSBUTL(DA(1),53.796,.04,X,"K")
"^DD",53.79,53.796,.04,1,1,"%D",0)
^^1^1^2990731^
"^DD",53.79,53.796,.04,1,1,"%D",1,0)
Creates an entry in this items audit log whenever changed or deleted.
"^DD",53.79,53.796,.04,1,1,"DT")
2990409
"^DD",53.79,53.796,.04,3)
Answer must be 1-20 characters in length.
"^DD",53.79,53.796,.04,21,0)
^.001^1^1^3010531^^
"^DD",53.79,53.796,.04,21,1,0)
Unit of administration (i.e. ML)
"^DD",53.79,53.796,.04,"DT")
2990409
"^DD",53.79,53.797,0)
SOLUTIONS SUB-FIELD^^.04^4
"^DD",53.79,53.797,0,"DT")
2990409
"^DD",53.79,53.797,0,"IX","AU703",53.797,.03)

"^DD",53.79,53.797,0,"IX","AU704",53.797,.04)

"^DD",53.79,53.797,0,"IX","B",53.797,.01)

"^DD",53.79,53.797,0,"NM","SOLUTIONS")

"^DD",53.79,53.797,0,"UP")
53.79
"^DD",53.79,53.797,.01,0)
SOLUTIONS^MP52.7'^PS(52.7,^0;1^Q
"^DD",53.79,53.797,.01,1,0)
^.1
"^DD",53.79,53.797,.01,1,1,0)
53.797^B
"^DD",53.79,53.797,.01,1,1,1)
S ^PSB(53.79,DA(1),.7,"B",$E(X,1,30),DA)=""
"^DD",53.79,53.797,.01,1,1,2)
K ^PSB(53.79,DA(1),.7,"B",$E(X,1,30),DA)
"^DD",53.79,53.797,.01,1,2,0)
53.79^F^MUMPS
"^DD",53.79,53.797,.01,1,2,1)
I $P(^PSB(53.79,DA,0),U,6) S ^PSB(53.79,"AOIP4",$P(^PSB(53.79,DA(1),0),U),DA(1),X)=""
"^DD",53.79,53.797,.01,1,2,2)
I $P(^PSB(53.79,DA,0),U,6) K ^PSB(53.79,"AOIP4",$P(^PSB(53.79,DA(1),0),U),DA(1),X)
"^DD",53.79,53.797,.01,1,2,"%D",0)
^.101^2^2^3031209^^^^
"^DD",53.79,53.797,.01,1,2,"%D",1,0)
CROSS REFERENCE for multiple SOLUTIONS.
"^DD",53.79,53.797,.01,1,2,"%D",2,0)
PSB(53.79,"AOIP4",DFN,ORDERABLE IEN,SOLUTION)
"^DD",53.79,53.797,.01,1,2,"DT")
3030516
"^DD",53.79,53.797,.01,21,0)
^.001^1^1^3020426^^
"^DD",53.79,53.797,.01,21,1,0)
Pointer to the SOLUTIONS file.
"^DD",53.79,53.797,.01,"DT")
3030516
"^DD",53.79,53.797,.02,0)
DOSE ORDERED^F^^0;2^K:$L(X)>30!($L(X)<1) X
"^DD",53.79,53.797,.02,3)
Answer must be 1-30 characters in length.
"^DD",53.79,53.797,.02,21,0)
^^1^1^2990731^
"^DD",53.79,53.797,.02,21,1,0)
Dosage ordered from the IV Order.
"^DD",53.79,53.797,.02,"DT")
2990409
"^DD",53.79,53.797,.03,0)
DOSES GIVEN^F^^0;3^K:$L(X)>30!($L(X)<1) X
"^DD",53.79,53.797,.03,1,0)
^.1
"^DD",53.79,53.797,.03,1,1,0)
53.797^AU703^MUMPS
"^DD",53.79,53.797,.03,1,1,1)
D AUDIT^PSBUTL(DA(1),53.797,.03,X,"S")
"^DD",53.79,53.797,.03,1,1,2)
D AUDIT^PSBUTL(DA(1),53.797,.03,X,"K")
"^DD",53.79,53.797,.03,1,1,"%D",0)
^^1^1^2990731^
"^DD",53.79,53.797,.03,1,1,"%D",1,0)
Creates an entry in this items audit log whenever changed or deleted.
"^DD",53.79,53.797,.03,1,1,"DT")
2990409
"^DD",53.79,53.797,.03,3)
Answer must be 1-30 characters in length.
"^DD",53.79,53.797,.03,21,0)
^^1^1^2990805^
"^DD",53.79,53.797,.03,21,1,0)
Actual amount of medication given.
"^DD",53.79,53.797,.03,"DT")
2990409
"^DD",53.79,53.797,.04,0)
UNIT OF ADMINISTRATION^F^^0;4^K:$L(X)>20!($L(X)<1) X
"^DD",53.79,53.797,.04,1,0)
^.1
"^DD",53.79,53.797,.04,1,1,0)
53.797^AU704^MUMPS
"^DD",53.79,53.797,.04,1,1,1)
D AUDIT^PSBUTL(DA(1),53.797,.04,X,"S")
"^DD",53.79,53.797,.04,1,1,2)
D AUDIT^PSBUTL(DA(1),53.797,.04,X,"K")
"^DD",53.79,53.797,.04,1,1,"%D",0)
^^1^1^2990731^
"^DD",53.79,53.797,.04,1,1,"%D",1,0)
Creates an entry in this items audit log whenever changed or deleted.
"^DD",53.79,53.797,.04,1,1,"DT")
2990409
"^DD",53.79,53.797,.04,3)
Answer must be 1-20 characters in length.
"^DD",53.79,53.797,.04,21,0)
^^1^1^2990731^
"^DD",53.79,53.797,.04,21,1,0)
Unit of administration (i.e. ML)
"^DD",53.79,53.797,.04,"DT")
2990409
"^DD",53.79,53.799,0)
AUDIT LOG SUB-FIELD^^.03^3
"^DD",53.79,53.799,0,"DT")
2990320
"^DD",53.79,53.799,0,"IX","B",53.799,.01)

"^DD",53.79,53.799,0,"NM","AUDIT LOG")

"^DD",53.79,53.799,0,"UP")
53.79
"^DD",53.79,53.799,.01,0)
AUDIT LOG^MD^^0;1^S %DT="ESTXR" D ^%DT S X=Y K:Y<1 X
"^DD",53.79,53.799,.01,1,0)
^.1
"^DD",53.79,53.799,.01,1,1,0)
53.799^B
"^DD",53.79,53.799,.01,1,1,1)
S ^PSB(53.79,DA(1),.9,"B",$E(X,1,30),DA)=""
"^DD",53.79,53.799,.01,1,1,2)
K ^PSB(53.79,DA(1),.9,"B",$E(X,1,30),DA)
"^DD",53.79,53.799,.01,21,0)
^^1^1^2990731^
"^DD",53.79,53.799,.01,21,1,0)
Date/time of audit being filed.
"^DD",53.79,53.799,.01,"DT")
2990320
"^DD",53.79,53.799,.02,0)
USER^P200'^VA(200,^0;2^Q
"^DD",53.79,53.799,.02,21,0)
^^1^1^2990731^^
"^DD",53.79,53.799,.02,21,1,0)
Pointer to the user making the change.
"^DD",53.79,53.799,.02,"DT")
2990320
"^DD",53.79,53.799,.03,0)
TEXT^F^^0;3^K:$L(X)>150!($L(X)<1) X
"^DD",53.79,53.799,.03,3)
Answer must be 1-150 characters in length.
"^DD",53.79,53.799,.03,21,0)
^^1^1^2990731^^
"^DD",53.79,53.799,.03,21,1,0)
Description of the change made.
"^DD",53.79,53.799,.03,"DT")
2990320
"^DIC",53.66,53.66,0)
BCMA IV PARAMETERS^53.66
"^DIC",53.66,53.66,0,"GL")
^PSB(53.66,
"^DIC",53.66,53.66,"%",0)
^1.005^^0
"^DIC",53.66,53.66,"%D",0)
^^1^1^3020426^
"^DIC",53.66,53.66,"%D",1,0)
This file contains the IV parameters set by individual ward.
"^DIC",53.66,"B","BCMA IV PARAMETERS",53.66)

"^DIC",53.68,53.68,0)
BCMA MISSING DOSE REQUEST^53.68
"^DIC",53.68,53.68,0,"GL")
^PSB(53.68,
"^DIC",53.68,53.68,"%D",0)
^^2^2^2990731^
"^DIC",53.68,53.68,"%D",1,0)
Contains the missing dose requests from the ward that are sent to
"^DIC",53.68,53.68,"%D",2,0)
pharmacy.  This file may be purged as needed by VA Fileman.
"^DIC",53.68,"B","BCMA MISSING DOSE REQUEST",53.68)

"^DIC",53.69,53.69,0)
BCMA REPORT REQUEST^53.69
"^DIC",53.69,53.69,0,"GL")
^PSB(53.69,
"^DIC",53.69,53.69,"%",0)
^1.005^^0
"^DIC",53.69,53.69,"%D",0)
^1.001^2^2^3030813^^
"^DIC",53.69,53.69,"%D",1,0)
Contains all report requests generated by users of the BCMA system.
"^DIC",53.69,53.69,"%D",2,0)
This file may be purged as needed by VA Fileman.
"^DIC",53.69,"B","BCMA REPORT REQUEST",53.69)

"^DIC",53.78,53.78,0)
BCMA MEDICATION VARIANCE LOG^53.78
"^DIC",53.78,53.78,0,"GL")
^PSB(53.78,
"^DIC",53.78,53.78,"%D",0)
^^3^3^2990805^
"^DIC",53.78,53.78,"%D",1,0)
Contains all variances occurring during the medication passes.
"^DIC",53.78,53.78,"%D",2,0)
 
"^DIC",53.78,53.78,"%D",3,0)
This file may *NOT* be purged.
"^DIC",53.78,"B","BCMA MEDICATION VARIANCE LOG",53.78)

"^DIC",53.79,53.79,0)
BCMA MEDICATION LOG^53.79
"^DIC",53.79,53.79,0,"GL")
^PSB(53.79,
"^DIC",53.79,53.79,"%",0)
^1.005^^0
"^DIC",53.79,53.79,"%D",0)
^^6^6^2990805^
"^DIC",53.79,53.79,"%D",1,0)
Contains all medication passes.
"^DIC",53.79,53.79,"%D",2,0)
 
"^DIC",53.79,53.79,"%D",3,0)
This file may *NOT* be purged.
"^DIC",53.79,53.79,"%D",4,0)
 
"^DIC",53.79,53.79,"%D",5,0)
Due to the size of this file Re-Indexing is also not recommended unless
"^DIC",53.79,53.79,"%D",6,0)
directed by customer support.
"^DIC",53.79,"B","BCMA MEDICATION LOG",53.79)

**END**
**END**
