Released PRC*5.1*69 SEQ #60
Extracted from mail message
**KIDS**:PRC*5.1*69^

**INSTALL NAME**
PRC*5.1*69
"BLD",2915,0)
PRC*5.1*69^IFCAP^0^3030915^y
"BLD",2915,1,0)
^^13^13^3030507^^
"BLD",2915,1,1,0)
This patch is in support of the site preparation steps for CoreFLS
"BLD",2915,1,2,0)
deployment. A new option, Local Vendor Data Cleansing Reports [PRCL
"BLD",2915,1,3,0)
LOCAL VENDOR], is added to the CoreFLS Data Cleansing [PRCL COREFLS
"BLD",2915,1,4,0)
DATA CLEANSING] menu as part of the installation of this patch.
"BLD",2915,1,5,0)
Instructions for the use of this option will be included with the 
"BLD",2915,1,6,0)
CoreFLS Action Request.
"BLD",2915,1,7,0)
  
"BLD",2915,1,8,0)
The compile routine examines the IFCAP PROCUREMENT & ACCOUNTING
"BLD",2915,1,9,0)
TRANSACTIONS FILE (#442) to determine which local vendor 
"BLD",2915,1,10,0)
purchasing records will be converted into the CoreFLS system. Once 
"BLD",2915,1,11,0)
the compile has been done, various reports may be run to show, in 
"BLD",2915,1,12,0)
summary or detail format, the open POs for current or previous 
"BLD",2915,1,13,0)
fiscal years.
"BLD",2915,4,0)
^9.64PA^^
"BLD",2915,"KRN",0)
^9.67PA^19^17
"BLD",2915,"KRN",.4,0)
.4
"BLD",2915,"KRN",.401,0)
.401
"BLD",2915,"KRN",.402,0)
.402
"BLD",2915,"KRN",.403,0)
.403
"BLD",2915,"KRN",.5,0)
.5
"BLD",2915,"KRN",.84,0)
.84
"BLD",2915,"KRN",3.6,0)
3.6
"BLD",2915,"KRN",3.8,0)
3.8
"BLD",2915,"KRN",9.2,0)
9.2
"BLD",2915,"KRN",9.8,0)
9.8
"BLD",2915,"KRN",9.8,"NM",0)
^9.68A^12^12
"BLD",2915,"KRN",9.8,"NM",1,0)
PRCLA1^^0^B57686654
"BLD",2915,"KRN",9.8,"NM",2,0)
PRCLA3^^0^B76728020
"BLD",2915,"KRN",9.8,"NM",3,0)
PRCLA6^^0^B51164971
"BLD",2915,"KRN",9.8,"NM",4,0)
PRCLD1^^0^B9973418
"BLD",2915,"KRN",9.8,"NM",5,0)
PRCLD2^^0^B19647241
"BLD",2915,"KRN",9.8,"NM",6,0)
PRCLD3^^0^B22890339
"BLD",2915,"KRN",9.8,"NM",7,0)
PRCLD4^^0^B1268446
"BLD",2915,"KRN",9.8,"NM",8,0)
PRCLD5^^0^B12301070
"BLD",2915,"KRN",9.8,"NM",9,0)
PRCLA2^^0^B43659701
"BLD",2915,"KRN",9.8,"NM",10,0)
PRCLA4^^0^B54914682
"BLD",2915,"KRN",9.8,"NM",11,0)
PRCLA5^^0^B49813073
"BLD",2915,"KRN",9.8,"NM",12,0)
PRCLA7^^0^B55467271
"BLD",2915,"KRN",9.8,"NM","B","PRCLA1",1)

"BLD",2915,"KRN",9.8,"NM","B","PRCLA2",9)

"BLD",2915,"KRN",9.8,"NM","B","PRCLA3",2)

"BLD",2915,"KRN",9.8,"NM","B","PRCLA4",10)

"BLD",2915,"KRN",9.8,"NM","B","PRCLA5",11)

"BLD",2915,"KRN",9.8,"NM","B","PRCLA6",3)

"BLD",2915,"KRN",9.8,"NM","B","PRCLA7",12)

"BLD",2915,"KRN",9.8,"NM","B","PRCLD1",4)

"BLD",2915,"KRN",9.8,"NM","B","PRCLD2",5)

"BLD",2915,"KRN",9.8,"NM","B","PRCLD3",6)

"BLD",2915,"KRN",9.8,"NM","B","PRCLD4",7)

"BLD",2915,"KRN",9.8,"NM","B","PRCLD5",8)

"BLD",2915,"KRN",19,0)
19
"BLD",2915,"KRN",19,"NM",0)
^9.68A^15^15
"BLD",2915,"KRN",19,"NM",1,0)
PRCL COREFLS DATA CLEANSING^^2
"BLD",2915,"KRN",19,"NM",2,0)
PRCL LOCAL VENDOR^^0
"BLD",2915,"KRN",19,"NM",3,0)
PRCL VENDOR^^0
"BLD",2915,"KRN",19,"NM",4,0)
PRCL LOCAL VENDOR RPT - DET^^0
"BLD",2915,"KRN",19,"NM",5,0)
PRCL LOCAL VENDOR RPT - SUM^^0
"BLD",2915,"KRN",19,"NM",6,0)
PRCL VENDOR COMPILE^^0
"BLD",2915,"KRN",19,"NM",7,0)
PRCL FISCAL VENDOR RPT - SUM^^0
"BLD",2915,"KRN",19,"NM",8,0)
PRCL FISCAL VENDOR RPT - DET^^0
"BLD",2915,"KRN",19,"NM",9,0)
PRCL SUPPLY VENDOR RPT - SUM^^0
"BLD",2915,"KRN",19,"NM",10,0)
PRCL SUPPLY VENDOR RPT - DET^^0
"BLD",2915,"KRN",19,"NM",11,0)
PRCL MISSING VENDOR NAME RPT^^0
"BLD",2915,"KRN",19,"NM",12,0)
PRCL MULTIPLE SYNONYMS RPT^^0
"BLD",2915,"KRN",19,"NM",13,0)
PRCL DUP TAX ID NUMBERS - SUM^^0
"BLD",2915,"KRN",19,"NM",14,0)
PRCL DUP TAX ID NUMBERS - DET^^0
"BLD",2915,"KRN",19,"NM",15,0)
PRCL INACTIVE VENDOR RPT^^0
"BLD",2915,"KRN",19,"NM","B","PRCL COREFLS DATA CLEANSING",1)

"BLD",2915,"KRN",19,"NM","B","PRCL DUP TAX ID NUMBERS - DET",14)

"BLD",2915,"KRN",19,"NM","B","PRCL DUP TAX ID NUMBERS - SUM",13)

"BLD",2915,"KRN",19,"NM","B","PRCL FISCAL VENDOR RPT - DET",8)

"BLD",2915,"KRN",19,"NM","B","PRCL FISCAL VENDOR RPT - SUM",7)

"BLD",2915,"KRN",19,"NM","B","PRCL INACTIVE VENDOR RPT",15)

"BLD",2915,"KRN",19,"NM","B","PRCL LOCAL VENDOR",2)

"BLD",2915,"KRN",19,"NM","B","PRCL LOCAL VENDOR RPT - DET",4)

"BLD",2915,"KRN",19,"NM","B","PRCL LOCAL VENDOR RPT - SUM",5)

"BLD",2915,"KRN",19,"NM","B","PRCL MISSING VENDOR NAME RPT",11)

"BLD",2915,"KRN",19,"NM","B","PRCL MULTIPLE SYNONYMS RPT",12)

"BLD",2915,"KRN",19,"NM","B","PRCL SUPPLY VENDOR RPT - DET",10)

"BLD",2915,"KRN",19,"NM","B","PRCL SUPPLY VENDOR RPT - SUM",9)

"BLD",2915,"KRN",19,"NM","B","PRCL VENDOR",3)

"BLD",2915,"KRN",19,"NM","B","PRCL VENDOR COMPILE",6)

"BLD",2915,"KRN",19.1,0)
19.1
"BLD",2915,"KRN",101,0)
101
"BLD",2915,"KRN",409.61,0)
409.61
"BLD",2915,"KRN",771,0)
771
"BLD",2915,"KRN",870,0)
870
"BLD",2915,"KRN",8994,0)
8994
"BLD",2915,"KRN","B",.4,.4)

"BLD",2915,"KRN","B",.401,.401)

"BLD",2915,"KRN","B",.402,.402)

"BLD",2915,"KRN","B",.403,.403)

"BLD",2915,"KRN","B",.5,.5)

"BLD",2915,"KRN","B",.84,.84)

"BLD",2915,"KRN","B",3.6,3.6)

"BLD",2915,"KRN","B",3.8,3.8)

"BLD",2915,"KRN","B",9.2,9.2)

"BLD",2915,"KRN","B",9.8,9.8)

"BLD",2915,"KRN","B",19,19)

"BLD",2915,"KRN","B",19.1,19.1)

"BLD",2915,"KRN","B",101,101)

"BLD",2915,"KRN","B",409.61,409.61)

"BLD",2915,"KRN","B",771,771)

"BLD",2915,"KRN","B",870,870)

"BLD",2915,"KRN","B",8994,8994)

"BLD",2915,"QUES",0)
^9.62^^
"BLD",2915,"REQB",0)
^9.611^^
"KRN",19,10900,-1)
0^3
"KRN",19,10900,0)
PRCL VENDOR^Vendor Data Cleansing Reports^^M^^PRCL DATA CLEANSING^^^^^^IFCAP
"KRN",19,10900,1,0)
^19.06^8^8^3030723^^^^
"KRN",19,10900,1,1,0)
This menu contains a set of options related to the VENDOR (#440) file for
"KRN",19,10900,1,2,0)
CoreFLS data conversion. The option Compile List of Vendors To Be Converted
"KRN",19,10900,1,3,0)
must be run prior to any other report.
"KRN",19,10900,1,4,0)
 
"KRN",19,10900,1,5,0)
The option Compile List of Vendors To Be Converted provides a list of
"KRN",19,10900,1,6,0)
vendors to be converted into the CoreFLS system. Reports highlighting data
"KRN",19,10900,1,7,0)
problems that may prevent the successful conversion of these items are also
"KRN",19,10900,1,8,0)
available.
"KRN",19,10900,10,0)
^19.01IP^10^10
"KRN",19,10900,10,1,0)
11173^1^1
"KRN",19,10900,10,1,"^")
PRCL VENDOR COMPILE
"KRN",19,10900,10,2,0)
11174^2^2
"KRN",19,10900,10,2,"^")
PRCL FISCAL VENDOR RPT - SUM
"KRN",19,10900,10,3,0)
11175^3^3
"KRN",19,10900,10,3,"^")
PRCL SUPPLY VENDOR RPT - SUM
"KRN",19,10900,10,4,0)
11176^4^4
"KRN",19,10900,10,4,"^")
PRCL FISCAL VENDOR RPT - DET
"KRN",19,10900,10,5,0)
11177^5^5
"KRN",19,10900,10,5,"^")
PRCL SUPPLY VENDOR RPT - DET
"KRN",19,10900,10,6,0)
11178^6^6
"KRN",19,10900,10,6,"^")
PRCL MISSING VENDOR NAME RPT
"KRN",19,10900,10,7,0)
11179^7^7
"KRN",19,10900,10,7,"^")
PRCL MULTIPLE SYNONYMS RPT
"KRN",19,10900,10,8,0)
11180^8^8
"KRN",19,10900,10,8,"^")
PRCL INACTIVE VENDOR RPT
"KRN",19,10900,10,9,0)
11181^9^9
"KRN",19,10900,10,9,"^")
PRCL DUP TAX ID NUMBERS - SUM
"KRN",19,10900,10,10,0)
11182^10^10
"KRN",19,10900,10,10,"^")
PRCL DUP TAX ID NUMBERS - DET
"KRN",19,10900,99)
59343,47684
"KRN",19,10900,"U")
VENDOR DATA CLEANSING REPORTS
"KRN",19,10901,-1)
2^1
"KRN",19,10901,0)
PRCL COREFLS DATA CLEANSING^CoreFLS Data Cleansing Menu^^M^100917^PRCL DATA CLEANSING^^^^^^455
"KRN",19,10901,10,0)
^19.01IP^4^4
"KRN",19,10901,10,1,0)
10900^^
"KRN",19,10901,10,1,"^")
PRCL VENDOR
"KRN",19,10901,10,4,0)
10916^^
"KRN",19,10901,10,4,"^")
PRCL LOCAL VENDOR
"KRN",19,10901,"U")
COREFLS DATA CLEANSING MENU
"KRN",19,10916,-1)
0^2
"KRN",19,10916,0)
PRCL LOCAL VENDOR^Local Vendor Data Cleansing Reports^^M^^PRCL DATA CLEANSING^^^^^^IFCAP
"KRN",19,10916,1,0)
^19.06^7^7^3030822^^^^
"KRN",19,10916,1,1,0)
This menu contains a set of options related to the VENDOR(#440) file for
"KRN",19,10916,1,2,0)
CoreFLS data conversion. The option Compile List of Vendors To Be Converted
"KRN",19,10916,1,3,0)
must be run prior to any other report.  
"KRN",19,10916,1,4,0)
 
"KRN",19,10916,1,5,0)
The Compile List of Vendors To Be Converted provides a list of local
"KRN",19,10916,1,6,0)
vendors to be converted into the CoreFLS system. Reports based on purchase
"KRN",19,10916,1,7,0)
order activity highlighting local vendors are also available.
"KRN",19,10916,10,0)
^19.01IP^3^3
"KRN",19,10916,10,1,0)
11173^1^1
"KRN",19,10916,10,1,"^")
PRCL VENDOR COMPILE
"KRN",19,10916,10,2,0)
11183^3^3
"KRN",19,10916,10,2,"^")
PRCL LOCAL VENDOR RPT - DET
"KRN",19,10916,10,3,0)
11184^2^2
"KRN",19,10916,10,3,"^")
PRCL LOCAL VENDOR RPT - SUM
"KRN",19,10916,99)
59403,57001
"KRN",19,10916,"U")
LOCAL VENDOR DATA CLEANSING RE
"KRN",19,11173,-1)
0^6
"KRN",19,11173,0)
PRCL VENDOR COMPILE^Compile List of Vendors To Be Converted^^R^^PRCL DATA CLEANSING^^^^^^IFCAP^^1^^^
"KRN",19,11173,1,0)
^19.06^10^10^3030723^^^^
"KRN",19,11173,1,1,0)
This option uses the PROCUREMENT & ACCOUNTING TRANSACTIONS (#442) file to
"KRN",19,11173,1,2,0)
extract vendors associated with a transaction.  The compiled list of
"KRN",19,11173,1,3,0)
vendors must be checked for problems and corrected prior to data conversion
"KRN",19,11173,1,4,0)
into the CoreFLS system.
"KRN",19,11173,1,5,0)
 
"KRN",19,11173,1,6,0)
This option must be invoked prior to running any of the associated CoreFLS
"KRN",19,11173,1,7,0)
Vendor or Local Vendor Data Cleansing reports. This option must be invoked
"KRN",19,11173,1,8,0)
every 30 days (minimum) to refresh the list of vendors. This option must
"KRN",19,11173,1,9,0)
also be invoked after the data cleansing has been completed for
"KRN",19,11173,1,10,0)
verification.
"KRN",19,11173,20)
S BODY=""
"KRN",19,11173,25)
TOP^PRCLA1
"KRN",19,11173,26)

"KRN",19,11173,"U")
COMPILE LIST OF VENDORS TO BE 
"KRN",19,11174,-1)
0^7
"KRN",19,11174,0)
PRCL FISCAL VENDOR RPT - SUM^Summary Vendor Report (Fiscal)^^R^^PRCL DATA CLEANSING^^^^^^IFCAP^^1
"KRN",19,11174,1,0)
^19.06^4^4^3030723^^^
"KRN",19,11174,1,1,0)
This CoreFLS Data Cleansing Report displays a summarized list of fiscal
"KRN",19,11174,1,2,0)
data fields in the VENDOR (#440) file. The list contains the total number
"KRN",19,11174,1,3,0)
of entries and related fields that do not conform to the required formats
"KRN",19,11174,1,4,0)
for CoreFLS data conversion.
"KRN",19,11174,20)
S BODY="LOOP^PRCLA2"
"KRN",19,11174,25)
TOP^PRCLA1
"KRN",19,11174,"U")
SUMMARY VENDOR REPORT (FISCAL)
"KRN",19,11175,-1)
0^9
"KRN",19,11175,0)
PRCL SUPPLY VENDOR RPT - SUM^Summary Vendor Report (Supply)^^R^^PRCL DATA CLEANSING^^^^^^IFCAP^^1
"KRN",19,11175,1,0)
^19.06^4^4^3030723^^^
"KRN",19,11175,1,1,0)
This CoreFLS Data Cleansing Report displays a summarized list of supply
"KRN",19,11175,1,2,0)
data fields in the VENDOR (#440) file. The list contains the total number
"KRN",19,11175,1,3,0)
of entries and related fields that do not conform to the required formats
"KRN",19,11175,1,4,0)
for CoreFLS data conversion.
"KRN",19,11175,20)
S BODY="LOOP^PRCLA3"
"KRN",19,11175,25)
TOP^PRCLA1
"KRN",19,11175,"U")
SUMMARY VENDOR REPORT (SUPPLY)
"KRN",19,11176,-1)
0^8
"KRN",19,11176,0)
PRCL FISCAL VENDOR RPT - DET^Detailed Vendor Report (Fiscal)^^R^^PRCL DATA CLEANSING^^^^^^IFCAP^^1
"KRN",19,11176,1,0)
^19.06^3^3^3030723^^^
"KRN",19,11176,1,1,0)
This CoreFLS Data Cleansing Detail Report displays a list of entries and
"KRN",19,11176,1,2,0)
its related fiscal data fields from the VENDOR (#440) file that do not
"KRN",19,11176,1,3,0)
conform to the required formats for CoreFLS data conversion.
"KRN",19,11176,20)
S BODY="RPT^PRCLA2"
"KRN",19,11176,25)
TOP^PRCLA1
"KRN",19,11176,"U")
DETAILED VENDOR REPORT (FISCAL
"KRN",19,11177,-1)
0^10
"KRN",19,11177,0)
PRCL SUPPLY VENDOR RPT - DET^Detailed Vendor Report (Supply)^^R^^PRCL DATA CLEANSING^^^^^^IFCAP^^1
"KRN",19,11177,1,0)
^19.06^3^3^3030723^^^
"KRN",19,11177,1,1,0)
This CoreFLS Data Cleansing Detail Report displays a list of entries and
"KRN",19,11177,1,2,0)
its related supply data fields from the VENDOR (#440) file that do not
"KRN",19,11177,1,3,0)
conform to the required formats for CoreFLS data conversion.
"KRN",19,11177,20)
S BODY="RPT^PRCLA3"
"KRN",19,11177,25)
TOP^PRCLA1
"KRN",19,11177,"U")
DETAILED VENDOR REPORT (SUPPLY
"KRN",19,11178,-1)
0^11
"KRN",19,11178,0)
PRCL MISSING VENDOR NAME RPT^Missing Vendor Name or 'B' x-ref^^R^^PRCL DATA CLEANSING^^^^^^IFCAP^^1
"KRN",19,11178,1,0)
^19.06^3^3^3030723^^^^
"KRN",19,11178,1,1,0)
This CoreFLS Data Cleansing Report displays entries in the VENDOR (#440)
"KRN",19,11178,1,2,0)
file not listed in the "B" cross reference or with a missing Name (#.01)
"KRN",19,11178,1,3,0)
field.
"KRN",19,11178,20)
S BODY="RPT1^PRCLA4"
"KRN",19,11178,25)
TOP^PRCLA1
"KRN",19,11178,"U")
MISSING VENDOR NAME OR 'B' X-R
"KRN",19,11179,-1)
0^12
"KRN",19,11179,0)
PRCL MULTIPLE SYNONYMS RPT^Multiple Synonyms^^R^^PRCL DATA CLEANSING^^^^^^IFCAP^^1
"KRN",19,11179,1,0)
^19.06^2^2^3030723^^^
"KRN",19,11179,1,1,0)
This CoreFLS Data Cleansing Report displays multiple entries in the
"KRN",19,11179,1,2,0)
SYNONYM (#20) field found in the VENDOR (#440) file.
"KRN",19,11179,20)
S BODY="RPT2^PRCLA4"
"KRN",19,11179,25)
TOP^PRCLA1
"KRN",19,11179,"U")
MULTIPLE SYNONYMS
"KRN",19,11180,-1)
0^15
"KRN",19,11180,0)
PRCL INACTIVE VENDOR RPT^Inactive/Replaced Vendors^^R^^PRCL DATA CLEANSING^^^^^^IFCAP^^1
"KRN",19,11180,1,0)
^19.06^5^5^3030723^^^^
"KRN",19,11180,1,1,0)
This CoreFLS Data Cleansing Report displays the INACTIVATED VENDOR (#31.5)
"KRN",19,11180,1,2,0)
field or REPLACEMENT VENDOR (#15) field entries from the VENDOR (#440)
"KRN",19,11180,1,3,0)
file.
"KRN",19,11180,1,4,0)
 
"KRN",19,11180,1,5,0)
The criteria are explained in this report's instructions. 
"KRN",19,11180,20)
S BODY="RPT3^PRCLA4"
"KRN",19,11180,25)
TOP^PRCLA1
"KRN",19,11180,"U")
INACTIVE/REPLACED VENDORS
"KRN",19,11181,-1)
0^13
"KRN",19,11181,0)
PRCL DUP TAX ID NUMBERS - SUM^Duplicate Tax ID Numbers (Summary)^^R^^PRCL DATA CLEANSING^^^^^^IFCAP^^1
"KRN",19,11181,1,0)
^19.06^2^2^3030722^^
"KRN",19,11181,1,1,0)
This CoreFLS Data Cleansing Summary Report displays a summary of the total
"KRN",19,11181,1,2,0)
number of vendors with duplicate tax IDs in the VENDOR (#440) file. 
"KRN",19,11181,20)
S BODY="RPT4^PRCLA4"
"KRN",19,11181,25)
TOP^PRCLA1
"KRN",19,11181,"U")
DUPLICATE TAX ID NUMBERS (SUMM
"KRN",19,11182,-1)
0^14
"KRN",19,11182,0)
PRCL DUP TAX ID NUMBERS - DET^Duplicate Tax ID Numbers (Detail)^^R^^PRCL DATA CLEANSING^^^^^^IFCAP^^1
"KRN",19,11182,1,0)
^19.06^2^2^3030722^^
"KRN",19,11182,1,1,0)
This CoreFLS Data Cleansing Detail Report displays a list of each tax ID in
"KRN",19,11182,1,2,0)
the VENDOR (#440) file with more than one associated vendor.
"KRN",19,11182,20)
S BODY="RPT5^PRCLA4"
"KRN",19,11182,25)
TOP^PRCLA1
"KRN",19,11182,"U")
DUPLICATE TAX ID NUMBERS (DETA
"KRN",19,11183,-1)
0^4
"KRN",19,11183,0)
PRCL LOCAL VENDOR RPT - DET^Detailed Open POs to Local Vendors Report^^R^^PRCL DATA CLEANSING^^^^^^IFCAP^^1
"KRN",19,11183,1,0)
^19.06^4^4^3030722^^
"KRN",19,11183,1,1,0)
This CoreFLS Data Cleansing Report displays open* POs created within the
"KRN",19,11183,1,2,0)
last 12 months for local vendors that do not have an FMS code.
"KRN",19,11183,1,3,0)
 
"KRN",19,11183,1,4,0)
(*This term is more fully explained in this report's instructions.)
"KRN",19,11183,20)
S BODY="RPT^PRCLD5"
"KRN",19,11183,25)
TOP^PRCLD1
"KRN",19,11183,"U")
DETAILED OPEN POS TO LOCAL VEN
"KRN",19,11184,-1)
0^5
"KRN",19,11184,0)
PRCL LOCAL VENDOR RPT - SUM^Summary POs to Local Vendors Report^^R^^PRCL DATA CLEANSING^^^^^^IFCAP^^1
"KRN",19,11184,1,0)
^19.06^7^7^3030723^^^
"KRN",19,11184,1,1,0)
This CoreFLS Data Cleansing Report displays local vendor purchase order
"KRN",19,11184,1,2,0)
activity within the last 24 months. Vendors with recent activity, multiple
"KRN",19,11184,1,3,0)
POs, or high order totals may be considered for vendorization through FMS.
"KRN",19,11184,1,4,0)
This report includes open* and closed* POs created within the last
"KRN",19,11184,1,5,0)
24 months.
"KRN",19,11184,1,6,0)
 
"KRN",19,11184,1,7,0)
(*These terms are more fully explained in this report's instructions.)
"KRN",19,11184,20)
S BODY="LOOP2^PRCLD2"
"KRN",19,11184,25)
TOP^PRCLD1
"KRN",19,11184,"U")
SUMMARY POS TO LOCAL VENDORS R
"MBREQ")
0
"ORD",18,19)
19;18;;;OPT^XPDTA;OPTF1^XPDIA;OPTE1^XPDIA;OPTF2^XPDIA;;OPTDEL^XPDIA
"ORD",18,19,0)
OPTION
"PKG",455,-1)
1^1
"PKG",455,0)
IFCAP^PRC^IFCAP System Files
"PKG",455,20,0)
^9.402P^^
"PKG",455,22,0)
^9.49I^1^1
"PKG",455,22,1,0)
5.1^3001012^3001019^68
"PKG",455,22,1,"PAH",1,0)
69^3030915
"PKG",455,22,1,"PAH",1,1,0)
^^13^13^3030915
"PKG",455,22,1,"PAH",1,1,1,0)
This patch is in support of the site preparation steps for CoreFLS
"PKG",455,22,1,"PAH",1,1,2,0)
deployment. A new option, Local Vendor Data Cleansing Reports [PRCL
"PKG",455,22,1,"PAH",1,1,3,0)
LOCAL VENDOR], is added to the CoreFLS Data Cleansing [PRCL COREFLS
"PKG",455,22,1,"PAH",1,1,4,0)
DATA CLEANSING] menu as part of the installation of this patch.
"PKG",455,22,1,"PAH",1,1,5,0)
Instructions for the use of this option will be included with the 
"PKG",455,22,1,"PAH",1,1,6,0)
CoreFLS Action Request.
"PKG",455,22,1,"PAH",1,1,7,0)
  
"PKG",455,22,1,"PAH",1,1,8,0)
The compile routine examines the IFCAP PROCUREMENT & ACCOUNTING
"PKG",455,22,1,"PAH",1,1,9,0)
TRANSACTIONS FILE (#442) to determine which local vendor 
"PKG",455,22,1,"PAH",1,1,10,0)
purchasing records will be converted into the CoreFLS system. Once 
"PKG",455,22,1,"PAH",1,1,11,0)
the compile has been done, various reports may be run to show, in 
"PKG",455,22,1,"PAH",1,1,12,0)
summary or detail format, the open POs for current or previous 
"PKG",455,22,1,"PAH",1,1,13,0)
fiscal years.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
12
"RTN","PRCLA1")
0^1^B57686654
"RTN","PRCLA1",1,0)
PRCLA1 ;WOIFO/KJH - Vendor (Main routine) - CoreFLS Data Cleansing ;7 May 2003  11:16 AM
"RTN","PRCLA1",2,0)
 ;;5.1;IFCAP;**60,69**;Oct 20, 2000
"RTN","PRCLA1",3,0)
 ;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","PRCLA1",4,0)
 ;
"RTN","PRCLA1",5,0)
 ;NOTE: This routine is not callable from the top. Set variable 'BODY' (see option reader) and then call tag 'TOP'.
"RTN","PRCLA1",6,0)
 Q
"RTN","PRCLA1",7,0)
TOP ; Make sure no one else is currently compiling the list of vendors.
"RTN","PRCLA1",8,0)
 W !!
"RTN","PRCLA1",9,0)
 L +^XTMP("PRCLA"):1 E  D EN^DDIOL("Vendor compile in progress. Please try again later.",,"!!") G EXIT
"RTN","PRCLA1",10,0)
 L -^XTMP("PRCLA")
"RTN","PRCLA1",11,0)
 ; Make sure last compile completed successfully. Otherwise, do not allow user to print anything.
"RTN","PRCLA1",12,0)
 I '$D(^XTMP("PRCLA",0)),BODY]"" D EN^DDIOL("You must first run the vendor compile before printing any reports.",,"!!") G EXIT
"RTN","PRCLA1",13,0)
 ; Display date of last compile.
"RTN","PRCLA1",14,0)
 I $D(^XTMP("PRCLA",0)) D EN^DDIOL("Last vendor compile done on "_$$FMTE^XLFDT($P(^XTMP("PRCLA",0),U,2)),,"!!")
"RTN","PRCLA1",15,0)
 ; If this is a report, run it and exit.
"RTN","PRCLA1",16,0)
 I BODY]"" D DISPLAY G EXIT
"RTN","PRCLA1",17,0)
 ; Otherwise, this is the 'compile' option.
"RTN","PRCLA1",18,0)
 D COMPILE
"RTN","PRCLA1",19,0)
EXIT ; Make sure all the variables that weren't NEW'd get KILL'd. (Exception: ZT* variables are handled by TaskMan.)
"RTN","PRCLA1",20,0)
 K BODY,INS,VEND,DA,DIR,DIRUT,DTOUT,DUOUT,X,Y,%ZIS
"RTN","PRCLA1",21,0)
 Q
"RTN","PRCLA1",22,0)
DISPLAY ; Ask to report for FMS, local vendors, or both. (detailed/summary reports)
"RTN","PRCLA1",23,0)
 I $P(BODY,"^")?1"RPT"1N G DISP1
"RTN","PRCLA1",24,0)
 K DIR
"RTN","PRCLA1",25,0)
 S DIR(0)="S^F:FMS   (Vendors found with an FMS VENDOR NAME or CODE);L:LOCAL (Vendors found without an FMS VENDOR NAME or CODE);A:ALL   (All vendors found during the compile)"
"RTN","PRCLA1",26,0)
 S DIR("A")="Enter Selection"
"RTN","PRCLA1",27,0)
 S DIR("?")="Please select the vendors to include in the report from the following list."
"RTN","PRCLA1",28,0)
 D ^DIR K DIR
"RTN","PRCLA1",29,0)
 I Y["^"!$D(DTOUT)!$D(DUOUT) D EN^DDIOL("<Report Aborted> ",,"!!?10") Q
"RTN","PRCLA1",30,0)
 S VEND=Y
"RTN","PRCLA1",31,0)
DISP1 ; Ask to display instructions (Not for summaries)
"RTN","PRCLA1",32,0)
 S INS="N"
"RTN","PRCLA1",33,0)
 I $P(BODY,"^")="LOOP"!($P(BODY,"^")="RPT4") G DISP2
"RTN","PRCLA1",34,0)
 K DIR
"RTN","PRCLA1",35,0)
 S DIR(0)="YA",DIR("A")="Do you wish to also display the instructions? ",DIR("B")="YES"
"RTN","PRCLA1",36,0)
 S DIR("?")="Enter 'YES' to display a set of instructions before displaying the report."
"RTN","PRCLA1",37,0)
 D ^DIR K DIR
"RTN","PRCLA1",38,0)
 I Y["^"!$D(DTOUT)!$D(DUOUT) D EN^DDIOL("<Report Aborted> ",,"!!?10") Q
"RTN","PRCLA1",39,0)
 I Y S INS="Y"
"RTN","PRCLA1",40,0)
DISP2 ; prompt for print device (queuing allowed)
"RTN","PRCLA1",41,0)
 S %ZIS="Q"
"RTN","PRCLA1",42,0)
 D ^%ZIS Q:POP
"RTN","PRCLA1",43,0)
 I '$D(IO("Q")) G PRT
"RTN","PRCLA1",44,0)
 S ZTSAVE("BODY")="",ZTSAVE("INS")="",ZTSAVE("VEND")=""
"RTN","PRCLA1",45,0)
 S ZTRTN="PRT^PRCLA1",ZTDESC="CoreFLS Data Cleansing Report (File# 440 - VENDOR)"
"RTN","PRCLA1",46,0)
 D ^%ZTLOAD,HOME^%ZIS
"RTN","PRCLA1",47,0)
 K ZTSK
"RTN","PRCLA1",48,0)
 Q
"RTN","PRCLA1",49,0)
PRT ; Print the requested report.
"RTN","PRCLA1",50,0)
 U IO
"RTN","PRCLA1",51,0)
 N PRCLA,PRCLB,PRCLD1,PRCLD2,PRCLD3,PRCLD4,PRCLERR,PRCLOK,PRCLOK1
"RTN","PRCLA1",52,0)
 N PRCLN,PRCLS,PRCLI,PRCLJ,DISP,TOT,REQ,HEAD,HEAD1,HDR,HDR1,OPT
"RTN","PRCLA1",53,0)
 S REQ="  * Required field *"
"RTN","PRCLA1",54,0)
 S PRCLA=0,P=0,L=0,ABORT=0
"RTN","PRCLA1",55,0)
 D @BODY
"RTN","PRCLA1",56,0)
PRT1 ; Report completed
"RTN","PRCLA1",57,0)
 I 'ABORT W !,"<End of Report>" I $E(IOST,1,2)="C-" W " Enter RETURN to continue" R Y:DTIME
"RTN","PRCLA1",58,0)
 I ABORT W !,"<Report Aborted>"
"RTN","PRCLA1",59,0)
 D ^%ZISC
"RTN","PRCLA1",60,0)
 K L,P,X,Y,ABORT
"RTN","PRCLA1",61,0)
 I $D(ZTQUEUED) S ZTREQ="@"
"RTN","PRCLA1",62,0)
 Q
"RTN","PRCLA1",63,0)
HDR ; Print report header
"RTN","PRCLA1",64,0)
 ; Do not ask 'RETURN' before first page on CRT.
"RTN","PRCLA1",65,0)
 I $E(IOST,1,2)="C-",P R !,"Enter RETURN to continue or '^' to exit: ",Y:DTIME I '$T!(Y[U) S ABORT=1 Q
"RTN","PRCLA1",66,0)
 ; Do not print a form feed before first page on printer. Top of form is set at end of previous report.
"RTN","PRCLA1",67,0)
 I $E(IOST,1,2)="C-"!P W @IOF
"RTN","PRCLA1",68,0)
 S P=P+1,L=4
"RTN","PRCLA1",69,0)
 W $E("                              ",1,80-$L(HDR)/2),HDR ; Main report name
"RTN","PRCLA1",70,0)
 W !,"CoreFLS Data Cleansing Report (File# 440 - VENDOR)",?69,"Page: ",$J(P,4),!
"RTN","PRCLA1",71,0)
 ; Print the compile date on the first line unless there is a filter, in which case print the filter. Don't print either if we're still in the instructions [$G(HEAD1)=""].
"RTN","PRCLA1",72,0)
 I $G(HDR1)="",$G(HEAD1)]"" W "Vendor list compiled: ",$$FMTE^XLFDT($P(^XTMP("PRCLA",0),U,2))
"RTN","PRCLA1",73,0)
 I $G(HDR1)]"",$G(HEAD1)]"" W "Results filtered by: ",HDR1
"RTN","PRCLA1",74,0)
 W ?58,"Printed: ",$$FMTE^XLFDT(DT)
"RTN","PRCLA1",75,0)
 ; If we printed the filter on the first line then add a line for the compile date.
"RTN","PRCLA1",76,0)
 I $G(HDR1)]"",$G(HEAD1)]"" W !,"Vendor list compiled: ",$$FMTE^XLFDT($P(^XTMP("PRCLA",0),U,2)) S L=L+1
"RTN","PRCLA1",77,0)
 W !
"RTN","PRCLA1",78,0)
 I $G(HEAD)]"" D @HEAD ; Sub-header
"RTN","PRCLA1",79,0)
 Q
"RTN","PRCLA1",80,0)
COMPILE ; Prompt for deployment date
"RTN","PRCLA1",81,0)
 N DEPLOYDT,CONVDT
"RTN","PRCLA1",82,0)
 K DIR
"RTN","PRCLA1",83,0)
 S DIR(0)="D^::EX"
"RTN","PRCLA1",84,0)
 S DIR("A")="Enter the CoreFLS deployment date or Data Cleansing date"
"RTN","PRCLA1",85,0)
 S DIR("?")="The Data Cleansing reports will use this date to determine which vendor records should be examined."
"RTN","PRCLA1",86,0)
 D ^DIR K DIR
"RTN","PRCLA1",87,0)
 I $D(DTOUT)!$D(DUOUT) D EN^DDIOL("<Vendor Compile Aborted> ",,"!!?10") G EX
"RTN","PRCLA1",88,0)
 S DEPLOYDT=Y
"RTN","PRCLA1",89,0)
 S CONVDT=$$FMADD^XLFDT(Y,-730)
"RTN","PRCLA1",90,0)
 ; Prompt for compile queuing
"RTN","PRCLA1",91,0)
 K DIR
"RTN","PRCLA1",92,0)
 S DIR(0)="YA",DIR("B")="YES"
"RTN","PRCLA1",93,0)
 S DIR("A")="Do you wish to queue the vendor compile? "
"RTN","PRCLA1",94,0)
 S DIR("A",1)=" "
"RTN","PRCLA1",95,0)
 F PRCLI=1:1:5 S DIR("A",PRCLI+1)=$P($T(LIST+PRCLI),";;",2)
"RTN","PRCLA1",96,0)
 S DIR("A",PRCLI+2)=" "
"RTN","PRCLA1",97,0)
 S DIR("?")="Enter 'YES' to queue the vendor compile."
"RTN","PRCLA1",98,0)
 D ^DIR K DIR
"RTN","PRCLA1",99,0)
 I $D(DTOUT)!$D(DUOUT) D EN^DDIOL("<Vendor Compile Aborted> ",,"!!?10") G EX
"RTN","PRCLA1",100,0)
 I Y D  G EX
"RTN","PRCLA1",101,0)
 . S ZTIO="NULL",ZTDESC="CoreFLS Vendor List (to be converted)",ZTRTN="TASK^PRCLA1",ZTSAVE("DEPLOYDT")="",ZTSAVE("CONVDT")=""
"RTN","PRCLA1",102,0)
 . D ^%ZTLOAD
"RTN","PRCLA1",103,0)
 . I $G(ZTSK)]"" D EN^DDIOL("Compile's TaskMan ID is "_ZTSK,"","!!?10")
"RTN","PRCLA1",104,0)
 . K ZTSK
"RTN","PRCLA1",105,0)
 . Q
"RTN","PRCLA1",106,0)
 D EN^DDIOL("Compiling vendor list ...",,"!!?10")
"RTN","PRCLA1",107,0)
TASK ; Setup an ^XTMP holding area for the vendor list
"RTN","PRCLA1",108,0)
 L +^XTMP("PRCLA"):5 E  D:'$D(ZTQUEUED) EN^DDIOL("Another vendor compile is currently running.",,"!!?10") G EX
"RTN","PRCLA1",109,0)
 K ^XTMP("PRCLA")
"RTN","PRCLA1",110,0)
 K ^XTMP("PRCLD")
"RTN","PRCLA1",111,0)
 ; Start vendor compile
"RTN","PRCLA1",112,0)
 N PRCLA,PRCLD1,PRCLD2,PRCLD3,PRCLD4,PRCLD5,PRCLDT,PRCLDT2,PRCLN,PRCLS
"RTN","PRCLA1",113,0)
 ; Calculate date to check from (First day of the fiscal year one year previous)
"RTN","PRCLA1",114,0)
 ; Logic as of 5/15/2003
"RTN","PRCLA1",115,0)
 ; Do not convert ignorables
"RTN","PRCLA1",116,0)
 ; Convert open and closed POs for created within 24 months of user input date
"RTN","PRCLA1",117,0)
 I +$E(DEPLOYDT,4,5)>9 S X=$E(DEPLOYDT,1,3)  ; Oct thru Dec
"RTN","PRCLA1",118,0)
 E  S X=$E(DEPLOYDT,1,3)-1 ; Jan thru Sep
"RTN","PRCLA1",119,0)
 S PRCLDT=$E(X,1,3)_"1001" ; First day of fiscal year.
"RTN","PRCLA1",120,0)
 S PRCLDT2=($E(X,1,3)-1)_"1001"
"RTN","PRCLA1",121,0)
 ; Setup list of P.O. statuses that won't be converted (1 = no conversion; 0 = no conversion, unless they pass a date check)
"RTN","PRCLA1",122,0)
 S PRCLS($O(^PRCD(442.3,"C",1,0)))=1 ; Order Not Completely Prepared
"RTN","PRCLA1",123,0)
 S PRCLS($O(^PRCD(442.3,"AC",3,0)))=1 ; Order Not Completely Prepared
"RTN","PRCLA1",124,0)
 S PRCLS($O(^PRCD(442.3,"AC",45,0)))=1 ; Cancelled Order
"RTN","PRCLA1",125,0)
 S PRCLS($O(^PRCD(442.3,"AC",100,0)))=1 ; Obligated - 1358
"RTN","PRCLA1",126,0)
 S PRCLS($O(^PRCD(442.3,"AC",105,0)))=1 ; Cancelled - 1358
"RTN","PRCLA1",127,0)
 S PRCLS($O(^PRCD(442.3,"AC",40,0)))=0 ; Transaction Complete
"RTN","PRCLA1",128,0)
 S PRCLS($O(^PRCD(442.3,"AC",41,0)))=0 ; Transaction Complete (Amended)
"RTN","PRCLA1",129,0)
 ; Loop through the transactions in file 442.
"RTN","PRCLA1",130,0)
 S PRCLA=0 F  S PRCLA=$O(^PRC(442,PRCLA)) Q:'PRCLA  D
"RTN","PRCLA1",131,0)
 . S PRCLN=$G(^PRC(442,PRCLA,1)),PRCLD1=$P(PRCLN,U,15),PRCLD2=$P(PRCLN,U,1)
"RTN","PRCLA1",132,0)
 . I PRCLD2="" Q  ; No vendor assigned to this transaction.
"RTN","PRCLA1",133,0)
 . S PRCLN=$G(^PRC(442,PRCLA,0)),PRCLD3=$P(PRCLN,U,1),PRCLD5=$P(PRCLN,U,2)
"RTN","PRCLA1",134,0)
 . I PRCLD5="" Q  ; No method of processing assigned to this transaction.
"RTN","PRCLA1",135,0)
 . ; I PRCLD5=21 Q  ; Transaction is a Misc. Obligation (1358). These will not be converted. ** 
"RTN","PRCLA1",136,0)
 . S PRCLN=$G(^PRC(442,PRCLA,7)),PRCLD4=$P(PRCLN,U,1)
"RTN","PRCLA1",137,0)
 . I PRCLD4="" Q  ; No status assigned to this transaction.
"RTN","PRCLA1",138,0)
 . I $G(PRCLS(PRCLD4))=1 Q  ; Do not convert these statuses
"RTN","PRCLA1",139,0)
 . ; If PO date is 24 months(730 days) before user supplied date quit
"RTN","PRCLA1",140,0)
 . I PRCLD1<CONVDT Q
"RTN","PRCLA1",141,0)
 . I PRCLD1'="",PRCLD3'="" S ^XTMP("PRCLD",PRCLD3,PRCLD1,PRCLA)=PRCLD1_U_PRCLD4_U_PRCLD5_U_PRCLD2
"RTN","PRCLA1",142,0)
 . S PRCLN=$G(^XTMP("PRCLA",PRCLD2)) ; Get previous PO for this vendor.
"RTN","PRCLA1",143,0)
 . I PRCLD1<$P(PRCLN,U,1) Q  ; This PO is older than the previous one set for this vendor.
"RTN","PRCLA1",144,0)
 . S ^XTMP("PRCLA",PRCLD2)=PRCLD1_U_PRCLD3_U_PRCLD4_U_PRCLD5  ; Save most recent PO for this vendor for display.
"RTN","PRCLA1",145,0)
 . Q
"RTN","PRCLA1",146,0)
 ; Standard header for all ^XTMP globals.
"RTN","PRCLA1",147,0)
 S X=$$FMADD^XLFDT(DT,30)
"RTN","PRCLA1",148,0)
 S ^XTMP("PRCLA",0)=X_U_DT_U_"CoreFLS Vendor List (to be converted)"
"RTN","PRCLA1",149,0)
 S ^XTMP("PRCLD",0)=X_U_DT_U_"CoreFLS Vendor List (to be converted)"
"RTN","PRCLA1",150,0)
 S ^XTMP("PRCLDDT",0)=X_U_DT_U_"CoreFLS User Selected Deploy Date"
"RTN","PRCLA1",151,0)
 S ^XTMP("PRCLDDT",1)=DEPLOYDT
"RTN","PRCLA1",152,0)
 L -^XTMP("PRCLA")
"RTN","PRCLA1",153,0)
 I $D(ZTQUEUED) S ZTREQ="@"
"RTN","PRCLA1",154,0)
EX ;
"RTN","PRCLA1",155,0)
 K DA,DIR,DIRUT,DTOUT,DUOUT,X,Y,%ZIS
"RTN","PRCLA1",156,0)
 Q
"RTN","PRCLA1",157,0)
LIST ; Prompt text for the vendor compile question
"RTN","PRCLA1",158,0)
 ;;Compile may take 30 minutes or more depending on the size of your database.
"RTN","PRCLA1",159,0)
 ;;Answering 'NO' will start the compile immediately in the foreground and your
"RTN","PRCLA1",160,0)
 ;;terminal will be unresponsive until it completes. Answering 'YES' will allow
"RTN","PRCLA1",161,0)
 ;;you to schedule the compile. Note that once the compile begins you will not
"RTN","PRCLA1",162,0)
 ;;be allowed to access these options until it completes.
"RTN","PRCLA2")
0^9^B43659701
"RTN","PRCLA2",1,0)
PRCLA2 ;WOIFO/KJH - Vendor (Fiscal Reports) - CoreFLS Data Cleansing ;1 May 2003  4:19 PM
"RTN","PRCLA2",2,0)
 ;;5.1;IFCAP;**60,69**;Oct 20, 2000
"RTN","PRCLA2",3,0)
 ;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","PRCLA2",4,0)
 ;
"RTN","PRCLA2",5,0)
 ;NOTE: This routine is not callable from the top. Use TOP in PRCLA1.
"RTN","PRCLA2",6,0)
 Q
"RTN","PRCLA2",7,0)
RPT ; Detailed Vendor Report (Fiscal)
"RTN","PRCLA2",8,0)
 S HDR="DETAILED VENDOR REPORT (FISCAL)",PRCLERR=0
"RTN","PRCLA2",9,0)
 D INS^PRCLA5("TXT2","PRCLA5") Q:ABORT
"RTN","PRCLA2",10,0)
 S HDR1=$S(VEND="F":"FMS",VEND="L":"LOCAL",1:"ALL")_" VENDORS"
"RTN","PRCLA2",11,0)
 D HDR^PRCLA1 Q:ABORT
"RTN","PRCLA2",12,0)
 F  S PRCLA=$O(^XTMP("PRCLA",PRCLA)) Q:'PRCLA  D  Q:ABORT
"RTN","PRCLA2",13,0)
 . F PRCLJ=1:1:13 S DISP(PRCLJ)="  * OK *"
"RTN","PRCLA2",14,0)
 . S PRCLOK=1 D FISCAL I PRCLOK=1 Q  ; Vendor did not match the criteria selected by the user.
"RTN","PRCLA2",15,0)
 . S PRCLOK=1
"RTN","PRCLA2",16,0)
 . F PRCLJ=1:1:13 I DISP(PRCLJ)'="  * OK *",DISP(PRCLJ)'="" S PRCLOK=0
"RTN","PRCLA2",17,0)
 . I PRCLOK=1 Q  ; No errors were found on this vendor.
"RTN","PRCLA2",18,0)
 . D:L+10>IOSL HDR^PRCLA1 Q:ABORT
"RTN","PRCLA2",19,0)
 . S PRCLERR=1
"RTN","PRCLA2",20,0)
 . W !,"Vendor: ",PRCLA," (",$E($P($G(^PRC(440,PRCLA,0)),U,1),1,22),")"
"RTN","PRCLA2",21,0)
 . W ?39,"TIN: ",$P($G(^PRC(440,PRCLA,3)),U,8)
"RTN","PRCLA2",22,0)
 . W ?54,"Ph: ",$E($P($G(^PRC(440,PRCLA,0)),U,10),1,22)
"RTN","PRCLA2",23,0)
 . S PRCLN=^XTMP("PRCLA",PRCLA)
"RTN","PRCLA2",24,0)
 . W !,?4,"Most Recent PO: "
"RTN","PRCLA2",25,0)
 . W $P(PRCLN,U,2),"  ",$$FMTE^XLFDT($P(PRCLN,U,1),"2Z"),"  "
"RTN","PRCLA2",26,0)
 . I $D(^PRCD(442.5,+$P(PRCLN,U,4),0))#2 W $P(^(0),U,2),"  "
"RTN","PRCLA2",27,0)
 . I $D(^PRCD(442.3,+$P(PRCLN,U,3),0)) W $E($P(^(0),U,1),1,34)
"RTN","PRCLA2",28,0)
 . W !
"RTN","PRCLA2",29,0)
 . W ?40,"Pay Addr1",?50,$G(DISP(7))
"RTN","PRCLA2",30,0)
 . W !,"1099 Ind",?10,$G(DISP(1))
"RTN","PRCLA2",31,0)
 . W ?40,"Pay Addr2",?50,$G(DISP(8))
"RTN","PRCLA2",32,0)
 . W !,"Tax ID",?10,$G(DISP(2))
"RTN","PRCLA2",33,0)
 . W ?40,"Pay Addr3",?50,$G(DISP(9))
"RTN","PRCLA2",34,0)
 . W !,"SSN/Tax",?10,$G(DISP(3))
"RTN","PRCLA2",35,0)
 . W ?40,"Pay Addr4",?50,$G(DISP(10))
"RTN","PRCLA2",36,0)
 . W !,"FMS Code",?10,$G(DISP(4))
"RTN","PRCLA2",37,0)
 . W ?40,"Pay City",?50,$G(DISP(11))
"RTN","PRCLA2",38,0)
 . W !,"FMS Name",?10,$G(DISP(5))
"RTN","PRCLA2",39,0)
 . W ?40,"Pay State",?50,$G(DISP(12))
"RTN","PRCLA2",40,0)
 . W !,"ALT-ADDR",?10,$G(DISP(6))
"RTN","PRCLA2",41,0)
 . W ?40,"Pay ZIP",?50,$G(DISP(13))
"RTN","PRCLA2",42,0)
 . W !
"RTN","PRCLA2",43,0)
 . S L=L+10
"RTN","PRCLA2",44,0)
 . Q
"RTN","PRCLA2",45,0)
 I 'PRCLERR W !!,"No problem records to report."
"RTN","PRCLA2",46,0)
 W !
"RTN","PRCLA2",47,0)
 Q
"RTN","PRCLA2",48,0)
LOOP ; Summary Vendor Report (Fiscal)
"RTN","PRCLA2",49,0)
 S TOT=0
"RTN","PRCLA2",50,0)
 F  S PRCLA=$O(^XTMP("PRCLA",PRCLA)) Q:'PRCLA  D
"RTN","PRCLA2",51,0)
 . F PRCLJ=1:1:13 S DISP(PRCLJ)="  * OK *"
"RTN","PRCLA2",52,0)
 . S PRCLOK=1 D FISCAL I PRCLOK=1 Q  ; Vendor did not match the criteria selected by the user.
"RTN","PRCLA2",53,0)
 . S TOT=$G(TOT)+1
"RTN","PRCLA2",54,0)
 . S PRCLOK=1
"RTN","PRCLA2",55,0)
 . F PRCLJ=1:1:13 I DISP(PRCLJ)'="  * OK *",DISP(PRCLJ)'="" S TOT(PRCLJ)=$G(TOT(PRCLJ))+1,PRCLOK=0
"RTN","PRCLA2",56,0)
 . I PRCLOK=1 Q  ; No errors were found on this vendor.
"RTN","PRCLA2",57,0)
 . S TOT(0)=$G(TOT(0))+1
"RTN","PRCLA2",58,0)
 . Q
"RTN","PRCLA2",59,0)
 S HDR="SUMMARY VENDOR REPORT (FISCAL)",HEAD1=1
"RTN","PRCLA2",60,0)
 S HDR1=$S(VEND="F":"FMS",VEND="L":"LOCAL",1:"ALL")_" VENDORS"
"RTN","PRCLA2",61,0)
 D HDR^PRCLA1
"RTN","PRCLA2",62,0)
 ; Set null values to "0" for reporting display
"RTN","PRCLA2",63,0)
 I '$G(TOT) S TOT=0
"RTN","PRCLA2",64,0)
 F PRCLI=0:1:13 I '$G(TOT(PRCLI)) S TOT(PRCLI)=0
"RTN","PRCLA2",65,0)
 W !,"# Vendors Found",?20,$J($G(TOT),8)
"RTN","PRCLA2",66,0)
 W !,"# With Problems",?20,$J($G(TOT(0)),8)
"RTN","PRCLA2",67,0)
 W ?40,"Pay Addr1",?60,$J($G(TOT(7)),8)
"RTN","PRCLA2",68,0)
 W !,"1099 Ind",?20,$J($G(TOT(1)),8)
"RTN","PRCLA2",69,0)
 W ?40,"Pay Addr2",?60,$J($G(TOT(8)),8)
"RTN","PRCLA2",70,0)
 W !,"Tax ID",?20,$J($G(TOT(2)),8)
"RTN","PRCLA2",71,0)
 W ?40,"Pay Addr3",?60,$J($G(TOT(9)),8)
"RTN","PRCLA2",72,0)
 W !,"SSN/Tax",?20,$J($G(TOT(3)),8)
"RTN","PRCLA2",73,0)
 W ?40,"Pay Addr4",?60,$J($G(TOT(10)),8)
"RTN","PRCLA2",74,0)
 W !,"FMS Code",?20,$J($G(TOT(4)),8)
"RTN","PRCLA2",75,0)
 W ?40,"Pay City",?60,$J($G(TOT(11)),8)
"RTN","PRCLA2",76,0)
 W !,"FMS Name",?20,$J($G(TOT(5)),8)
"RTN","PRCLA2",77,0)
 W ?40,"Pay State",?60,$J($G(TOT(12)),8)
"RTN","PRCLA2",78,0)
 W !,"ALT-ADDR",?20,$J($G(TOT(6)),8)
"RTN","PRCLA2",79,0)
 W ?40,"Pay ZIP",?60,$J($G(TOT(13)),8)
"RTN","PRCLA2",80,0)
 W !
"RTN","PRCLA2",81,0)
 Q
"RTN","PRCLA2",82,0)
FISCAL ;
"RTN","PRCLA2",83,0)
 ; Check FMS Vendor Code and Name against the user's selection for this report.
"RTN","PRCLA2",84,0)
 S PRCLN=$G(^PRC(440,PRCLA,3)),PRCLD1=$P(PRCLN,U,4),PRCLD2=$P(PRCLN,U,7)
"RTN","PRCLA2",85,0)
 I VEND="F",PRCLD1="",PRCLD2="" Q  ; Treat as FMS Vendor if either code or name exists.
"RTN","PRCLA2",86,0)
 I VEND="L",(PRCLD1]""!(PRCLD2]"")) Q  ; Treat as Local Vendor if neither code nor name exists.
"RTN","PRCLA2",87,0)
 S PRCLOK=0 ; Reset flag. OK to print this vendor.
"RTN","PRCLA2",88,0)
 ; 1099 Vendor Indicator
"RTN","PRCLA2",89,0)
 S PRCLN=$G(^PRC(440,PRCLA,3)),PRCLD1=$P(PRCLN,U,11) D
"RTN","PRCLA2",90,0)
 . I PRCLD1="N"!(PRCLD1="Y") Q
"RTN","PRCLA2",91,0)
 . I PRCLD1="" S DISP(1)=REQ Q
"RTN","PRCLA2",92,0)
 . S DISP(1)=PRCLD1
"RTN","PRCLA2",93,0)
 . Q
"RTN","PRCLA2",94,0)
 ; Tax ID
"RTN","PRCLA2",95,0)
 S PRCLN=$G(^PRC(440,PRCLA,3)),PRCLD1=$P(PRCLN,U,8) D
"RTN","PRCLA2",96,0)
 . I PRCLD1="" S DISP(2)=REQ Q
"RTN","PRCLA2",97,0)
 . I PRCLD1'?9N S DISP(2)=PRCLD1 Q
"RTN","PRCLA2",98,0)
 . I PRCLD1?3"0"6N S DISP(2)=PRCLD1 Q
"RTN","PRCLA2",99,0)
 . I PRCLD1?5"1"4N S DISP(2)=PRCLD1 Q
"RTN","PRCLA2",100,0)
 . I PRCLD1?5"2"4N S DISP(2)=PRCLD1 Q
"RTN","PRCLA2",101,0)
 . I PRCLD1?5"3"4N S DISP(2)=PRCLD1 Q
"RTN","PRCLA2",102,0)
 . I PRCLD1?5"4"4N S DISP(2)=PRCLD1 Q
"RTN","PRCLA2",103,0)
 . I PRCLD1?5"5"4N S DISP(2)=PRCLD1 Q
"RTN","PRCLA2",104,0)
 . I PRCLD1?5"6"4N S DISP(2)=PRCLD1 Q
"RTN","PRCLA2",105,0)
 . I PRCLD1?5"7"4N S DISP(2)=PRCLD1 Q
"RTN","PRCLA2",106,0)
 . I PRCLD1?5"8"4N S DISP(2)=PRCLD1 Q
"RTN","PRCLA2",107,0)
 . I PRCLD1?5"9"4N S DISP(2)=PRCLD1 Q
"RTN","PRCLA2",108,0)
 . I PRCLD1="123456789" S DISP(2)=PRCLD1 Q
"RTN","PRCLA2",109,0)
 . Q
"RTN","PRCLA2",110,0)
 ; SSN/Tax ID Indicator
"RTN","PRCLA2",111,0)
 S PRCLN=$G(^PRC(440,PRCLA,3)),PRCLD1=$P(PRCLN,U,9) D
"RTN","PRCLA2",112,0)
 . I PRCLD1="S"!(PRCLD1="T") Q
"RTN","PRCLA2",113,0)
 . I PRCLD1="" S DISP(3)=REQ Q
"RTN","PRCLA2",114,0)
 . S DISP(3)=PRCLD1
"RTN","PRCLA2",115,0)
 . Q
"RTN","PRCLA2",116,0)
 ; FMS Vendor Code/Name
"RTN","PRCLA2",117,0)
 S PRCLN=$G(^PRC(440,PRCLA,3)),PRCLD1=$P(PRCLN,U,4),PRCLD2=$P(PRCLN,U,7) D
"RTN","PRCLA2",118,0)
 . I PRCLD1="",PRCLD2="" S DISP(4)="",DISP(5)="" Q  ; NULL is allowed only if both fields are NULL
"RTN","PRCLA2",119,0)
 . I PRCLD1="",PRCLD2]"" S DISP(4)=REQ,DISP(5)=PRCLD2 Q
"RTN","PRCLA2",120,0)
 . I PRCLD1]"",PRCLD2="" S DISP(4)=PRCLD1,DISP(5)=REQ Q
"RTN","PRCLA2",121,0)
 . Q
"RTN","PRCLA2",122,0)
 ; ALT-ADDR-IND
"RTN","PRCLA2",123,0)
 S PRCLN=$G(^PRC(440,PRCLA,3)),PRCLD1=$P(PRCLN,U,4),PRCLD2=$P(PRCLN,U,7),PRCLD3=$P(PRCLN,U,5) D
"RTN","PRCLA2",124,0)
 . I PRCLD3="" S DISP(6)="" Q  ; NULL is allowed in this field
"RTN","PRCLA2",125,0)
 . I PRCLD1]"",PRCLD2]"" Q  ; If this field is not NULL then FMS Code and Name must also be not NULL
"RTN","PRCLA2",126,0)
 . S DISP(6)=PRCLD3,DISP(4)=$S(PRCLD1]"":PRCLD1,1:REQ),DISP(5)=$S(PRCLD2]"":PRCLD2,1:REQ)
"RTN","PRCLA2",127,0)
 . Q
"RTN","PRCLA2",128,0)
 ; If Ordering Address exists then Payment Address is optional.
"RTN","PRCLA2",129,0)
 S PRCLN=$G(^PRC(440,PRCLA,0)),OPT=0
"RTN","PRCLA2",130,0)
 I $P(PRCLN,U,2)]"",$P(PRCLN,U,6)]"",$P(PRCLN,U,7)]"",$P(PRCLN,U,8)]"" S OPT=1
"RTN","PRCLA2",131,0)
 ; Payment Address 1
"RTN","PRCLA2",132,0)
 S PRCLN=$G(^PRC(440,PRCLA,7)),PRCLD1=$P(PRCLN,U,3) D
"RTN","PRCLA2",133,0)
 . I PRCLD1="" S:'OPT DISP(7)=REQ Q
"RTN","PRCLA2",134,0)
 . Q
"RTN","PRCLA2",135,0)
 ; Payment Address 2
"RTN","PRCLA2",136,0)
 S PRCLN=$G(^PRC(440,PRCLA,7)),PRCLD1=$P(PRCLN,U,4),PRCLD2=$P(PRCLN,U,5),PRCLD3=$P(PRCLN,U,6) D
"RTN","PRCLA2",137,0)
 . I PRCLD1]"" Q
"RTN","PRCLA2",138,0)
 . I PRCLD2]""!(PRCLD3]"") S DISP(8)=REQ Q  ; NULL is allowed in this field as long as Pay ADDR3 and ADDR4 are also NULL
"RTN","PRCLA2",139,0)
 . S DISP(8)=""
"RTN","PRCLA2",140,0)
 . Q
"RTN","PRCLA2",141,0)
 ; Payment Address 3
"RTN","PRCLA2",142,0)
 S PRCLN=$G(^PRC(440,PRCLA,7)),PRCLD1=$P(PRCLN,U,5) D
"RTN","PRCLA2",143,0)
 . I PRCLD1]"" S DISP(9)=PRCLD1 Q  ; Any data in this field should be displayed for the user to verify that it is valid address info.
"RTN","PRCLA2",144,0)
 . S DISP(9)=""
"RTN","PRCLA2",145,0)
 . Q
"RTN","PRCLA2",146,0)
 ; Payment Address 4
"RTN","PRCLA2",147,0)
 S PRCLN=$G(^PRC(440,PRCLA,7)),PRCLD1=$P(PRCLN,U,6) D
"RTN","PRCLA2",148,0)
 . I PRCLD1]"" S DISP(10)=PRCLD1 Q  ; Any data in this field must be moved as it is not scheduled to be converted
"RTN","PRCLA2",149,0)
 . S DISP(10)=""
"RTN","PRCLA2",150,0)
 . Q
"RTN","PRCLA2",151,0)
 ; Payment City
"RTN","PRCLA2",152,0)
 S PRCLN=$G(^PRC(440,PRCLA,7)),PRCLD1=$P(PRCLN,U,7) D
"RTN","PRCLA2",153,0)
 . I PRCLD1="" S:'OPT DISP(11)=REQ Q
"RTN","PRCLA2",154,0)
 . Q
"RTN","PRCLA2",155,0)
 ; Payment State
"RTN","PRCLA2",156,0)
 S PRCLN=$G(^PRC(440,PRCLA,7)),PRCLD1=$P(PRCLN,U,8) D
"RTN","PRCLA2",157,0)
 . I PRCLD1="" S:'OPT DISP(12)=REQ Q
"RTN","PRCLA2",158,0)
 . I PRCLD1'?1.N S DISP(12)=PRCLD1 Q
"RTN","PRCLA2",159,0)
 . I '$D(^DIC(5,PRCLD1,0)) S DISP(12)=PRCLD1 Q
"RTN","PRCLA2",160,0)
 . Q
"RTN","PRCLA2",161,0)
 ; Payment ZIP
"RTN","PRCLA2",162,0)
 S PRCLN=$G(^PRC(440,PRCLA,7)),PRCLD1=$P(PRCLN,U,9) D
"RTN","PRCLA2",163,0)
 . I PRCLD1="" S:'OPT DISP(13)=REQ Q
"RTN","PRCLA2",164,0)
 . I PRCLD1="00000"!(PRCLD1="99999") S DISP(13)=PRCLD1 Q  ; Exclude potential 'fake' ZIP codes
"RTN","PRCLA2",165,0)
 . I PRCLD1?5N Q
"RTN","PRCLA2",166,0)
 . I PRCLD1?9N Q
"RTN","PRCLA2",167,0)
 . I PRCLD1?5N1"-"4N Q
"RTN","PRCLA2",168,0)
 . S DISP(13)=PRCLD1
"RTN","PRCLA2",169,0)
 . Q
"RTN","PRCLA2",170,0)
 Q
"RTN","PRCLA3")
0^2^B76728020
"RTN","PRCLA3",1,0)
PRCLA3 ;WOIFO/KJH - Vendor (Supply Reports) - CoreFLS Data Cleansing ;1 May 2003  11:16 PM
"RTN","PRCLA3",2,0)
 ;;5.1;IFCAP;**60,69**;Oct 20, 2000
"RTN","PRCLA3",3,0)
 ;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","PRCLA3",4,0)
 ;
"RTN","PRCLA3",5,0)
 ;NOTE: This routine is not callable from the top. Use TOP in PRCLA1.
"RTN","PRCLA3",6,0)
 Q
"RTN","PRCLA3",7,0)
RPT ; Detailed Vendor Report (Supply)
"RTN","PRCLA3",8,0)
 S HDR="DETAILED VENDOR REPORT (SUPPLY)",PRCLERR=0
"RTN","PRCLA3",9,0)
 D INS^PRCLA5("TXT3","PRCLA6") Q:ABORT
"RTN","PRCLA3",10,0)
 S HDR1=$S(VEND="F":"FMS",VEND="L":"LOCAL",1:"ALL")_" VENDORS"
"RTN","PRCLA3",11,0)
 D HDR^PRCLA1 Q:ABORT
"RTN","PRCLA3",12,0)
 F  S PRCLA=$O(^XTMP("PRCLA",PRCLA)) Q:'PRCLA  D  Q:ABORT
"RTN","PRCLA3",13,0)
 . F PRCLJ=1:1:16 S DISP(PRCLJ)="  * OK *"
"RTN","PRCLA3",14,0)
 . S PRCLOK=1 D SUPPLY I PRCLOK=1 Q  ; Vendor did not match the criteria selected by the user.
"RTN","PRCLA3",15,0)
 . S PRCLOK=1
"RTN","PRCLA3",16,0)
 . F PRCLJ=1:1:16 I DISP(PRCLJ)'="  * OK *",DISP(PRCLJ)'="" S PRCLOK=0
"RTN","PRCLA3",17,0)
 . I PRCLOK=1 Q  ; No errors were found on this vendor.
"RTN","PRCLA3",18,0)
 . S PRCLERR=1
"RTN","PRCLA3",19,0)
 . D:L+11>IOSL HDR^PRCLA1 Q:ABORT
"RTN","PRCLA3",20,0)
 . W !,"Vendor: ",PRCLA," (",$E($P($G(^PRC(440,PRCLA,0)),U,1),1,22),")"
"RTN","PRCLA3",21,0)
 . W ?39,"TIN: ",$P($G(^PRC(440,PRCLA,3)),U,8)
"RTN","PRCLA3",22,0)
 . W ?54,"Ph: ",$E($P($G(^PRC(440,PRCLA,0)),U,10),1,22)
"RTN","PRCLA3",23,0)
 . S PRCLN=^XTMP("PRCLA",PRCLA)
"RTN","PRCLA3",24,0)
 . W !,?4,"Most Recent PO: "
"RTN","PRCLA3",25,0)
 . W $P(PRCLN,U,2),"  ",$$FMTE^XLFDT($P(PRCLN,U,1),"2Z"),"  "
"RTN","PRCLA3",26,0)
 . I $D(^PRCD(442.5,+$P(PRCLN,U,4),0))#2 W $P(^(0),U,2),"  "
"RTN","PRCLA3",27,0)
 . I $D(^PRCD(442.3,+$P(PRCLN,U,3),0)) W $E($P(^(0),U,1),1,34)
"RTN","PRCLA3",28,0)
 . W !,"EDI Vend",?10,$G(DISP(8))
"RTN","PRCLA3",29,0)
 . W ?40,"Vend ID#",?50,$G(DISP(16))
"RTN","PRCLA3",30,0)
 . W !,"Vend Type",?10,$G(DISP(1))
"RTN","PRCLA3",31,0)
 . W ?40,"Ord Addr1",?50,$G(DISP(9))
"RTN","PRCLA3",32,0)
 . W !,"Bus Type",?10,$G(DISP(2))
"RTN","PRCLA3",33,0)
 . W ?40,"Ord Addr2",?50,$G(DISP(10))
"RTN","PRCLA3",34,0)
 . W !,"Contact",?10,$G(DISP(3))
"RTN","PRCLA3",35,0)
 . W ?40,"Ord Addr3",?50,$G(DISP(11))
"RTN","PRCLA3",36,0)
 . W !,"D&B #",?10,$G(DISP(4))
"RTN","PRCLA3",37,0)
 . W ?40,"Ord Addr4",?50,$G(DISP(12))
"RTN","PRCLA3",38,0)
 . W !,"Socio Grp",?10,$G(DISP(5))
"RTN","PRCLA3",39,0)
 . W ?40,"Ord City",?50,$G(DISP(13))
"RTN","PRCLA3",40,0)
 . W !,"FAX",?10,$G(DISP(6))
"RTN","PRCLA3",41,0)
 . W ?40,"Ord State",?50,$G(DISP(14))
"RTN","PRCLA3",42,0)
 . W !,"Phone",?10,$G(DISP(7))
"RTN","PRCLA3",43,0)
 . W ?40,"Ord ZIP",?50,$G(DISP(15))
"RTN","PRCLA3",44,0)
 . W !
"RTN","PRCLA3",45,0)
 . S L=L+11
"RTN","PRCLA3",46,0)
 . Q
"RTN","PRCLA3",47,0)
 I 'PRCLERR W !!,"No problem records to report."
"RTN","PRCLA3",48,0)
 W !
"RTN","PRCLA3",49,0)
 Q
"RTN","PRCLA3",50,0)
LOOP ; Summary Vendor Report (Supply)
"RTN","PRCLA3",51,0)
 S TOT=0
"RTN","PRCLA3",52,0)
 F  S PRCLA=$O(^XTMP("PRCLA",PRCLA)) Q:'PRCLA  D
"RTN","PRCLA3",53,0)
 . F PRCLJ=1:1:16 S DISP(PRCLJ)="  * OK *"
"RTN","PRCLA3",54,0)
 . S PRCLOK=1 D SUPPLY I PRCLOK=1 Q  ; Vendor did not match the criteria selected by the user.
"RTN","PRCLA3",55,0)
 . S TOT=$G(TOT)+1
"RTN","PRCLA3",56,0)
 . S PRCLOK=1
"RTN","PRCLA3",57,0)
 . F PRCLJ=1:1:16 I DISP(PRCLJ)'="  * OK *",DISP(PRCLJ)'="" S TOT(PRCLJ)=$G(TOT(PRCLJ))+1,PRCLOK=0
"RTN","PRCLA3",58,0)
 . I PRCLOK=1 Q  ; No errors were found on this vendor.
"RTN","PRCLA3",59,0)
 . S TOT(0)=$G(TOT(0))+1
"RTN","PRCLA3",60,0)
 . Q
"RTN","PRCLA3",61,0)
 S HDR="SUMMARY VENDOR REPORT (SUPPLY)",HEAD1=1
"RTN","PRCLA3",62,0)
 S HDR1=$S(VEND="F":"FMS",VEND="L":"LOCAL",1:"ALL")_" VENDORS"
"RTN","PRCLA3",63,0)
 D HDR^PRCLA1
"RTN","PRCLA3",64,0)
 ; Set null values to "0" for reporting display
"RTN","PRCLA3",65,0)
 I '$G(TOT) S TOT=0
"RTN","PRCLA3",66,0)
 F PRCLI=0:1:16 I '$G(TOT(PRCLI)) S TOT(PRCLI)=0
"RTN","PRCLA3",67,0)
 W !,"# Vendors Found",?20,$J($G(TOT),8)
"RTN","PRCLA3",68,0)
 W !,"# With Problems",?20,$J($G(TOT(0)),8)
"RTN","PRCLA3",69,0)
 W !,"EDI Vend",?20,$J($G(TOT(8)),8)
"RTN","PRCLA3",70,0)
 W ?40,"Vend ID#",?60,$J($G(TOT(16)),8)
"RTN","PRCLA3",71,0)
 W !,"Vend Type",?20,$J($G(TOT(1)),8)
"RTN","PRCLA3",72,0)
 W ?40,"Ord Addr1",?60,$J($G(TOT(9)),8)
"RTN","PRCLA3",73,0)
 W !,"Bus Type",?20,$J($G(TOT(2)),8)
"RTN","PRCLA3",74,0)
 W ?40,"Ord Addr2",?60,$J($G(TOT(10)),8)
"RTN","PRCLA3",75,0)
 W !,"Contact",?20,$J($G(TOT(3)),8)
"RTN","PRCLA3",76,0)
 W ?40,"Ord Addr3",?60,$J($G(TOT(11)),8)
"RTN","PRCLA3",77,0)
 W !,"D&B #",?20,$J($G(TOT(4)),8)
"RTN","PRCLA3",78,0)
 W ?40,"Ord Addr4",?60,$J($G(TOT(12)),8)
"RTN","PRCLA3",79,0)
 W !,"Socio Grp",?20,$J($G(TOT(5)),8)
"RTN","PRCLA3",80,0)
 W ?40,"Ord City",?60,$J($G(TOT(13)),8)
"RTN","PRCLA3",81,0)
 W !,"FAX",?20,$J($G(TOT(6)),8)
"RTN","PRCLA3",82,0)
 W ?40,"Ord State",?60,$J($G(TOT(14)),8)
"RTN","PRCLA3",83,0)
 W !,"Phone",?20,$J($G(TOT(7)),8)
"RTN","PRCLA3",84,0)
 W ?40,"Ord ZIP",?60,$J($G(TOT(15)),8)
"RTN","PRCLA3",85,0)
 W !
"RTN","PRCLA3",86,0)
 Q
"RTN","PRCLA3",87,0)
SUPPLY ;
"RTN","PRCLA3",88,0)
 ; Check FMS Vendor Code and Name against the user's selection for this report.
"RTN","PRCLA3",89,0)
 S PRCLN=$G(^PRC(440,PRCLA,3)),PRCLD1=$P(PRCLN,U,4),PRCLD2=$P(PRCLN,U,7)
"RTN","PRCLA3",90,0)
 I VEND="F",PRCLD1="",PRCLD2="" Q  ; Treat as FMS Vendor if either code or name exists.
"RTN","PRCLA3",91,0)
 I VEND="L",(PRCLD1]""!(PRCLD2]"")) Q  ; Treat as Local Vendor if neither code nor name exists.
"RTN","PRCLA3",92,0)
 S PRCLOK=0 ; Reset flag. OK to print this vendor.
"RTN","PRCLA3",93,0)
 ; Vendor Type
"RTN","PRCLA3",94,0)
 S PRCLN=$G(^PRC(440,PRCLA,3)),PRCLD1=$P(PRCLN,U,14) D
"RTN","PRCLA3",95,0)
 . I PRCLD1="A" Q
"RTN","PRCLA3",96,0)
 . I PRCLD1="C" Q
"RTN","PRCLA3",97,0)
 . I PRCLD1="E" Q
"RTN","PRCLA3",98,0)
 . I PRCLD1="F" Q
"RTN","PRCLA3",99,0)
 . I PRCLD1="G" Q
"RTN","PRCLA3",100,0)
 . I PRCLD1="I" Q
"RTN","PRCLA3",101,0)
 . I PRCLD1="O" Q
"RTN","PRCLA3",102,0)
 . I PRCLD1="R" Q
"RTN","PRCLA3",103,0)
 . I PRCLD1="U" Q
"RTN","PRCLA3",104,0)
 . I PRCLD1="V" Q
"RTN","PRCLA3",105,0)
 . I PRCLD1="K" Q
"RTN","PRCLA3",106,0)
 . I PRCLD1="" S DISP(1)=REQ Q
"RTN","PRCLA3",107,0)
 . S DISP(1)=PRCLD1
"RTN","PRCLA3",108,0)
 . Q
"RTN","PRCLA3",109,0)
 ; Business Type
"RTN","PRCLA3",110,0)
 S PRCLN=$G(^PRC(440,PRCLA,2)),PRCLD1=$P(PRCLN,U,3) D
"RTN","PRCLA3",111,0)
 . I PRCLD1="1"!(PRCLD1="2")!(PRCLD1="3")!(PRCLD1="4") Q
"RTN","PRCLA3",112,0)
 . I PRCLD1="" S DISP(2)=REQ Q
"RTN","PRCLA3",113,0)
 . S DISP(2)=PRCLD1
"RTN","PRCLA3",114,0)
 . Q
"RTN","PRCLA3",115,0)
 ; Procurement Contact Person
"RTN","PRCLA3",116,0)
 S PRCLN=$G(^PRC(440,PRCLA,0)),PRCLD1=$P(PRCLN,U,9) D
"RTN","PRCLA3",117,0)
 . I PRCLD1="" S DISP(3)="" Q  ; NULL is allowed in this field
"RTN","PRCLA3",118,0)
 . ; Format is LAST,FIRST,MI (or just LAST,FIRST). No numbers allowed.
"RTN","PRCLA3",119,0)
 . I ($L(PRCLD1,",")=3!($L(PRCLD1,",")=2)),$TR(PRCLD1,"0123456789")=PRCLD1 Q
"RTN","PRCLA3",120,0)
 . ; Format is "FIRST MI LAST" or "FIRST LAST". No numbers allowed.
"RTN","PRCLA3",121,0)
 . I ($L(PRCLD1," ")=3!($L(PRCLD1," ")=2)),$TR(PRCLD1,"0123456789")=PRCLD1 Q
"RTN","PRCLA3",122,0)
 . ; Format is just a "FIRST" name. No numbers allowed.
"RTN","PRCLA3",123,0)
 . I PRCLD1'[" ",$TR(PRCLD1,"0123456789")=PRCLD1 Q
"RTN","PRCLA3",124,0)
 . ; Any other format is suspect and should be updated.
"RTN","PRCLA3",125,0)
 . S DISP(3)=PRCLD1
"RTN","PRCLA3",126,0)
 . Q
"RTN","PRCLA3",127,0)
 ; Dun & Bradstreet #
"RTN","PRCLA3",128,0)
 S PRCLN=$G(^PRC(440,PRCLA,7)),PRCLD1=$P(PRCLN,U,12) D
"RTN","PRCLA3",129,0)
 . I PRCLD1="" S DISP(4)="" Q  ; NULL is allowed in this field
"RTN","PRCLA3",130,0)
 . I $$DBCHK^PRCHQ1B(PRCLD1) Q
"RTN","PRCLA3",131,0)
 . S DISP(4)=PRCLD1
"RTN","PRCLA3",132,0)
 . Q
"RTN","PRCLA3",133,0)
 ; Socioeconomic Group
"RTN","PRCLA3",134,0)
 S PRCLD1=0,PRCLD2="",PRCLOK1=0
"RTN","PRCLA3",135,0)
 F  S PRCLD1=$O(^PRC(440,PRCLA,1.1,PRCLD1)) Q:'PRCLD1  D  Q:PRCLD2]""
"RTN","PRCLA3",136,0)
 . I $D(^PRCD(420.6,PRCLD1,0)) S PRCLOK1=1 Q
"RTN","PRCLA3",137,0)
 . S PRCLD2=PRCLD1
"RTN","PRCLA3",138,0)
 . Q
"RTN","PRCLA3",139,0)
 I PRCLOK1=0 S DISP(5)=REQ ; No good entries were found in this multiple. Should at least be 'None of the above'.
"RTN","PRCLA3",140,0)
 I PRCLD2]"" S DISP(5)=PRCLD2 ; Bad entry found in multiple. Display it.
"RTN","PRCLA3",141,0)
 ; FAX Number
"RTN","PRCLA3",142,0)
 S PRCLN=$G(^PRC(440,PRCLA,10)),PRCLD1=$P(PRCLN,U,6) D
"RTN","PRCLA3",143,0)
 . I PRCLD1="" S DISP(6)="" Q  ; NULL is allowed in this field
"RTN","PRCLA3",144,0)
 . S PRCLD2=PRCLD1
"RTN","PRCLA3",145,0)
 . ; Remove hyphens, spaces, and parentheses
"RTN","PRCLA3",146,0)
 . S PRCLD2=$TR(PRCLD2,"()- ")
"RTN","PRCLA3",147,0)
 . ;If # is 10 digits (with area code) and 1st and 4th digit is not 0 or 1 it should be OK
"RTN","PRCLA3",148,0)
 . I PRCLD2?10N,$E(PRCLD2,1)>1,$E(PRCLD2,4)>1 Q
"RTN","PRCLA3",149,0)
 . ; If length is 11 then first digit must be "1" and second digit cannot be "0" or "1"
"RTN","PRCLA3",150,0)
 . I PRCLD2?11N,$E(PRCLD2,1)=1,$E(PRCLD2,2)>1,$E(PRCLD2,5)>1 Q
"RTN","PRCLA3",151,0)
 . ; Any other format is suspect and should be updated
"RTN","PRCLA3",152,0)
 . S DISP(6)=PRCLD1
"RTN","PRCLA3",153,0)
 . Q
"RTN","PRCLA3",154,0)
 ; Vendor Phone Number
"RTN","PRCLA3",155,0)
 S PRCLN=$G(^PRC(440,PRCLA,0)),PRCLD1=$P(PRCLN,U,10) D
"RTN","PRCLA3",156,0)
 . I PRCLD1="" S DISP(7)="" Q  ; NULL is allowed in this field
"RTN","PRCLA3",157,0)
 . S PRCLD2=PRCLD1
"RTN","PRCLA3",158,0)
 . ; Remove extension (most popular formats)
"RTN","PRCLA3",159,0)
 . I PRCLD1["EXT" S PRCLD2=$P(PRCLD1,"EXT",1)
"RTN","PRCLA3",160,0)
 . I PRCLD1["ext" S PRCLD2=$P(PRCLD1,"ext",1)
"RTN","PRCLA3",161,0)
 . I PRCLD1["Ext" S PRCLD2=$P(PRCLD1,"Ext",1)
"RTN","PRCLA3",162,0)
 . I PRCLD1["X" S PRCLD2=$P(PRCLD1,"X",1)
"RTN","PRCLA3",163,0)
 . I PRCLD1["x" S PRCLD2=$P(PRCLD1,"x",1)
"RTN","PRCLA3",164,0)
 . ; Remove hyphens, spaces, and parentheses
"RTN","PRCLA3",165,0)
 . S PRCLD2=$TR(PRCLD2,"()- ")
"RTN","PRCLA3",166,0)
 . ;If # is 10 digits (with area code) and 1st and 4th digit is not 0 or 1 it should be OK
"RTN","PRCLA3",167,0)
 . I PRCLD2?10N,$E(PRCLD2,1)>1,$E(PRCLD2,4)>1 Q
"RTN","PRCLA3",168,0)
 . ; If # is 11 digits then 1st digit must be 1 and 2nd and 5th digits cannot be 0 or 1
"RTN","PRCLA3",169,0)
 . I PRCLD2?11N,$E(PRCLD2,1)=1,$E(PRCLD2,2)>1,$E(PRCLD2,5)>1 Q
"RTN","PRCLA3",170,0)
 . ; Any other format is suspect and should be updated
"RTN","PRCLA3",171,0)
 . S DISP(7)=PRCLD1
"RTN","PRCLA3",172,0)
 . Q
"RTN","PRCLA3",173,0)
 ; EDI Vendor
"RTN","PRCLA3",174,0)
 S PRCLN=$G(^PRC(440,PRCLA,3)),PRCLD1=$P(PRCLN,U,2),PRCLD2=$P(PRCLN,U,3) D
"RTN","PRCLA3",175,0)
 . I PRCLD1="Y",PRCLD2]"" Q  ; If EDI VENDOR? field is "Y" then VENDOR ID NUMBER field must be not NULL.
"RTN","PRCLA3",176,0)
 . ; Otherwise, display the field we have and put standard 'required' message in the other.
"RTN","PRCLA3",177,0)
 . I PRCLD1="Y" S DISP(8)=PRCLD1,DISP(16)=REQ
"RTN","PRCLA3",178,0)
 . I PRCLD2]"" S DISP(8)=REQ,DISP(16)=PRCLD2
"RTN","PRCLA3",179,0)
 . Q
"RTN","PRCLA3",180,0)
 ; If Payment Address exists then Ordering Address is optional.
"RTN","PRCLA3",181,0)
 S PRCLN=$G(^PRC(440,PRCLA,7)),OPT=0
"RTN","PRCLA3",182,0)
 I $P(PRCLN,U,3)]"",$P(PRCLN,U,7)]"",$P(PRCLN,U,8)]"",$P(PRCLN,U,9)]"" S OPT=1
"RTN","PRCLA3",183,0)
 ; Ordering Address 1
"RTN","PRCLA3",184,0)
 S PRCLN=$G(^PRC(440,PRCLA,0)),PRCLD1=$P(PRCLN,U,2) D
"RTN","PRCLA3",185,0)
 . I PRCLD1="" S:'OPT DISP(9)=REQ Q
"RTN","PRCLA3",186,0)
 . Q
"RTN","PRCLA3",187,0)
 ; Ordering Address 2
"RTN","PRCLA3",188,0)
 S PRCLN=$G(^PRC(440,PRCLA,0)),PRCLD1=$P(PRCLN,U,3),PRCLD2=$P(PRCLN,U,4),PRCLD3=$P(PRCLN,U,5) D
"RTN","PRCLA3",189,0)
 . I PRCLD1]"" Q
"RTN","PRCLA3",190,0)
 . I PRCLD2]""!(PRCLD3]"") S DISP(10)=REQ Q  ; NULL is allowed in this field as long as Order ADDR3 and ADDR4 are also NULL
"RTN","PRCLA3",191,0)
 . S DISP(10)=""
"RTN","PRCLA3",192,0)
 . Q
"RTN","PRCLA3",193,0)
 ; Ordering Address 3
"RTN","PRCLA3",194,0)
 S PRCLN=$G(^PRC(440,PRCLA,0)),PRCLD1=$P(PRCLN,U,4) D
"RTN","PRCLA3",195,0)
 . I PRCLD1]"" S DISP(11)=PRCLD1 Q  ; Any data in this field should be displayed for the user to verify that it is valid address info.
"RTN","PRCLA3",196,0)
 . S DISP(11)=""
"RTN","PRCLA3",197,0)
 . Q
"RTN","PRCLA3",198,0)
 ; Ordering Address 4
"RTN","PRCLA3",199,0)
 S PRCLN=$G(^PRC(440,PRCLA,0)),PRCLD1=$P(PRCLN,U,5) D
"RTN","PRCLA3",200,0)
 . I PRCLD1]"" S DISP(12)=PRCLD1 Q  ; Any data in this field must be moved as it is not scheduled to be converted
"RTN","PRCLA3",201,0)
 . S DISP(12)=""
"RTN","PRCLA3",202,0)
 . Q
"RTN","PRCLA3",203,0)
 ; Ordering City
"RTN","PRCLA3",204,0)
 S PRCLN=$G(^PRC(440,PRCLA,0)),PRCLD1=$P(PRCLN,U,6) D
"RTN","PRCLA3",205,0)
 . I PRCLD1="" S:'OPT DISP(13)=REQ Q
"RTN","PRCLA3",206,0)
 . Q
"RTN","PRCLA3",207,0)
 ; Ordering State
"RTN","PRCLA3",208,0)
 S PRCLN=$G(^PRC(440,PRCLA,0)),PRCLD1=$P(PRCLN,U,7) D
"RTN","PRCLA3",209,0)
 . I PRCLD1="" S:'OPT DISP(14)=REQ Q
"RTN","PRCLA3",210,0)
 . I PRCLD1'?1.N S DISP(14)=PRCLD1 Q
"RTN","PRCLA3",211,0)
 . I '$D(^DIC(5,PRCLD1,0)) S DISP(14)=PRCLD1 Q
"RTN","PRCLA3",212,0)
 . Q
"RTN","PRCLA3",213,0)
 ; Ordering ZIP
"RTN","PRCLA3",214,0)
 S PRCLN=$G(^PRC(440,PRCLA,0)),PRCLD1=$P(PRCLN,U,8) D
"RTN","PRCLA3",215,0)
 . I PRCLD1="" S:'OPT DISP(15)=REQ Q
"RTN","PRCLA3",216,0)
 . I PRCLD1="00000"!(PRCLD1="99999") S DISP(13)=PRCLD1 Q  ; Exclude potential 'fake' ZIP codes
"RTN","PRCLA3",217,0)
 . I PRCLD1?5N Q
"RTN","PRCLA3",218,0)
 . I PRCLD1?9N Q
"RTN","PRCLA3",219,0)
 . I PRCLD1?5N1"-"4N Q
"RTN","PRCLA3",220,0)
 . S DISP(15)=PRCLD1
"RTN","PRCLA3",221,0)
 . Q
"RTN","PRCLA3",222,0)
 Q
"RTN","PRCLA4")
0^10^B54914682
"RTN","PRCLA4",1,0)
PRCLA4 ;WOIFO/KJH - Vendor (Other Reports) - CoreFLS Data Cleansing ;1 May 2003  4:19 PM
"RTN","PRCLA4",2,0)
 ;;5.1;IFCAP;**60,69**;Oct 20, 2000
"RTN","PRCLA4",3,0)
 ;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","PRCLA4",4,0)
 ;
"RTN","PRCLA4",5,0)
 ;NOTE: This routine is not callable from the top. Use TOP in PRCLA1.
"RTN","PRCLA4",6,0)
 Q
"RTN","PRCLA4",7,0)
RPT1 ; Missing Vendor Name or "B" x-ref
"RTN","PRCLA4",8,0)
 S HDR="MISSING VENDOR NAME OR 'B' X-REF REPORT",PRCLERR=0
"RTN","PRCLA4",9,0)
 D INS^PRCLA5("TXT41","PRCLA7") Q:ABORT
"RTN","PRCLA4",10,0)
 S HEAD="HDR1^PRCLA4"
"RTN","PRCLA4",11,0)
 D HDR^PRCLA1 Q:ABORT
"RTN","PRCLA4",12,0)
 F  S PRCLA=$O(^XTMP("PRCLA",PRCLA)) Q:'PRCLA  D  Q:ABORT
"RTN","PRCLA4",13,0)
 . D:L+1>IOSL HDR^PRCLA1 Q:ABORT
"RTN","PRCLA4",14,0)
 . S PRCLN=$G(^PRC(440,PRCLA,0)),PRCLD1=$P(PRCLN,U,1)
"RTN","PRCLA4",15,0)
 . I PRCLD1="" W !,$J(PRCLA,8),?10,REQ,?50,"Vendor Name Missing" S L=L+1,PRCLERR=1 Q
"RTN","PRCLA4",16,0)
 . I '$D(^PRC(440,"B",$E($$UP^XLFSTR(PRCLD1),1,30),PRCLA)) W !,$J(PRCLA,8),?10,PRCLD1,?50,"Vendor Name not in 'B' x-ref" S L=L+1,PRCLERR=1 Q
"RTN","PRCLA4",17,0)
 . Q
"RTN","PRCLA4",18,0)
 I 'PRCLERR W !!,"No problem records to report."
"RTN","PRCLA4",19,0)
 W !
"RTN","PRCLA4",20,0)
 Q
"RTN","PRCLA4",21,0)
HDR1 ;
"RTN","PRCLA4",22,0)
 W !,"IEN",?10,"Vendor",?50,"Reason"
"RTN","PRCLA4",23,0)
 S L=L+2
"RTN","PRCLA4",24,0)
 Q
"RTN","PRCLA4",25,0)
RPT2 ; Multiple Synonyms
"RTN","PRCLA4",26,0)
 S HDR="MULTIPLE SYNONYMS REPORT",PRCLERR=0
"RTN","PRCLA4",27,0)
 D INS^PRCLA5("TXT42","PRCLA7") Q:ABORT
"RTN","PRCLA4",28,0)
 S HEAD="HDR2^PRCLA4"
"RTN","PRCLA4",29,0)
 D HDR^PRCLA1 Q:ABORT
"RTN","PRCLA4",30,0)
 F  S PRCLA=$O(^XTMP("PRCLA",PRCLA)) Q:'PRCLA  D  Q:ABORT
"RTN","PRCLA4",31,0)
 . S PRCLN=$G(^PRC(440,PRCLA,0)),PRCLD1=$P(PRCLN,U,1)
"RTN","PRCLA4",32,0)
 . K PRCLS
"RTN","PRCLA4",33,0)
 . S PRCLB=0 F PRCLI=0:1 S PRCLB=$O(^PRC(440,PRCLA,5,PRCLB)) Q:'PRCLB  D
"RTN","PRCLA4",34,0)
 .. S PRCLN=$G(^PRC(440,PRCLA,5,PRCLB,0)),PRCLD2=$P(PRCLN,U,1)
"RTN","PRCLA4",35,0)
 .. S PRCLS(PRCLD2)=""
"RTN","PRCLA4",36,0)
 .. Q
"RTN","PRCLA4",37,0)
 . I PRCLI'>1 Q  ; Only one synonym is allowed in the Oracle system
"RTN","PRCLA4",38,0)
 . ; Two header lines plus 1 line for each synonym (plus 3 lines as a buffer).
"RTN","PRCLA4",39,0)
 . D:L+PRCLI+5>IOSL HDR^PRCLA1 Q:ABORT
"RTN","PRCLA4",40,0)
 . S L=L+PRCLI+3,PRCLERR=1
"RTN","PRCLA4",41,0)
 . W !,?10,PRCLA,?25,PRCLD1,!
"RTN","PRCLA4",42,0)
 . S PRCLB="" F PRCLI=1:1 S PRCLB=$O(PRCLS(PRCLB)) Q:PRCLB=""  W !,PRCLI,?25,PRCLB
"RTN","PRCLA4",43,0)
 . W !
"RTN","PRCLA4",44,0)
 . Q
"RTN","PRCLA4",45,0)
 I 'PRCLERR W !!,"No problem records to report."
"RTN","PRCLA4",46,0)
 W !
"RTN","PRCLA4",47,0)
 Q
"RTN","PRCLA4",48,0)
HDR2 ;
"RTN","PRCLA4",49,0)
 W !,?10,"Vendor IEN",?25,"Vendor Name"
"RTN","PRCLA4",50,0)
 W !,"Synonym Number",?25,"Synonym"
"RTN","PRCLA4",51,0)
 S L=L+2
"RTN","PRCLA4",52,0)
 Q
"RTN","PRCLA4",53,0)
RPT3 ; Inactive/Replaced Vendors
"RTN","PRCLA4",54,0)
 S HDR="INACTIVE/REPLACED VENDORS REPORT",PRCLERR=0
"RTN","PRCLA4",55,0)
 D INS^PRCLA5("TXT43","PRCLA7") Q:ABORT
"RTN","PRCLA4",56,0)
 S HEAD="HDR3^PRCLA4"
"RTN","PRCLA4",57,0)
 D HDR^PRCLA1 Q:ABORT
"RTN","PRCLA4",58,0)
 F  S PRCLA=$O(^XTMP("PRCLA",PRCLA)) Q:'PRCLA  D  Q:ABORT
"RTN","PRCLA4",59,0)
 . S PRCLN=$G(^PRC(440,PRCLA,10)),PRCLD1=$P(PRCLN,U,5) ; Inactive flag
"RTN","PRCLA4",60,0)
 . S PRCLN=$G(^PRC(440,PRCLA,0)),PRCLD2=$P(PRCLN,U,1) ; Vendor Name
"RTN","PRCLA4",61,0)
 . I PRCLD1'=1,$E(PRCLD2,1,2)'="**" Q  ; Inactive vendors will either have the flag = 1 or a "**" beginning their name.
"RTN","PRCLA4",62,0)
 . D:L+1>IOSL HDR^PRCLA1 Q:ABORT
"RTN","PRCLA4",63,0)
 . K PRCLS
"RTN","PRCLA4",64,0)
 . S PRCLS(PRCLA)="" ; To avoid an infinite loop if the replacement vendor is itself.
"RTN","PRCLA4",65,0)
 . S PRCLB=PRCLA,PRCLOK=0 F  D  Q:PRCLOK=1  ; Loop through the 'replacement' vendors until you get an 'active' one or there are none left.
"RTN","PRCLA4",66,0)
 .. S PRCLN=$G(^PRC(440,PRCLB,9)),PRCLD3=$P(PRCLN,U,1),PRCLD4="" ; Replacement Vendor
"RTN","PRCLA4",67,0)
 .. I PRCLD3="" S PRCLOK=1 Q  ; No active replacement vendor found.
"RTN","PRCLA4",68,0)
 .. I $D(PRCLS(PRCLD3)) S PRCLOK=1,PRCLD3="" Q  ; Replacement vendor has already been looked at. Avoid infinite loop.
"RTN","PRCLA4",69,0)
 .. S PRCLS(PRCLD3)=""
"RTN","PRCLA4",70,0)
 .. S PRCLN=$G(^PRC(440,PRCLD3,10)),PRCLD1=$P(PRCLN,U,5) ; Inactive flag
"RTN","PRCLA4",71,0)
 .. S PRCLN=$G(^PRC(440,PRCLD3,0)),PRCLD4=$P(PRCLN,U,1) ; Replacement Vendor Name
"RTN","PRCLA4",72,0)
 .. I PRCLD1'=1,$E(PRCLD4,1,2)'="**" S PRCLOK=1 Q  ; Replacement vendor is active. Display this one.
"RTN","PRCLA4",73,0)
 .. S PRCLB=PRCLD3 Q  ; Check this inactive replacement vendor to see if it was also replaced.
"RTN","PRCLA4",74,0)
 .. Q
"RTN","PRCLA4",75,0)
 . S L=L+1,PRCLERR=1
"RTN","PRCLA4",76,0)
 . W !,PRCLA,?10,$E(PRCLD2,1,29),?40,PRCLD3,?50,$E(PRCLD4,1,29)
"RTN","PRCLA4",77,0)
 . Q
"RTN","PRCLA4",78,0)
 I 'PRCLERR W !!,"No problem records to report."
"RTN","PRCLA4",79,0)
 W !
"RTN","PRCLA4",80,0)
 Q
"RTN","PRCLA4",81,0)
HDR3 ;
"RTN","PRCLA4",82,0)
 W !,"IEN",?10,"Vendor Name",?40,"Rep IEN",?50,"Replacement Name"
"RTN","PRCLA4",83,0)
 S L=L+1
"RTN","PRCLA4",84,0)
 Q
"RTN","PRCLA4",85,0)
RPT4 ; Duplicate Tax ID Numbers (Summary)
"RTN","PRCLA4",86,0)
 D COMP
"RTN","PRCLA4",87,0)
 S HDR="SUMMARY DUPLICATE TAX ID NUMBERS REPORT",HEAD1=1
"RTN","PRCLA4",88,0)
 D HDR^PRCLA1 Q:ABORT
"RTN","PRCLA4",89,0)
 K PRCLS
"RTN","PRCLA4",90,0)
 S PRCLS(0)=0,PRCLS(-1)=0
"RTN","PRCLA4",91,0)
 S PRCLA="" F  S PRCLA=$O(^TMP("PRCLA",$J,PRCLA)) Q:PRCLA=""  D  Q:ABORT
"RTN","PRCLA4",92,0)
 . ; Count the number of duplicates to be displayed.
"RTN","PRCLA4",93,0)
 . S PRCLB="" F PRCLI=0:1 S PRCLB=$O(^TMP("PRCLA",$J,PRCLA,PRCLB)) Q:PRCLB=""
"RTN","PRCLA4",94,0)
 . S PRCLS(PRCLI)=$G(PRCLS(PRCLI))+1,PRCLS(0)=$G(PRCLS(0))+1,PRCLS(-1)=$G(PRCLS(-1))+PRCLI
"RTN","PRCLA4",95,0)
 . Q
"RTN","PRCLA4",96,0)
 D:L+2>IOSL HDR^PRCLA1 Q:ABORT
"RTN","PRCLA4",97,0)
 W !,"Total of ",PRCLS(0)," Duplicate Tax IDs containing a total of ",PRCLS(-1)," vendors.",!
"RTN","PRCLA4",98,0)
 S L=L+2
"RTN","PRCLA4",99,0)
 S PRCLB=0 F  S PRCLB=$O(PRCLS(PRCLB)) Q:'PRCLB  D  Q:ABORT
"RTN","PRCLA4",100,0)
 . D:L+2>IOSL HDR^PRCLA1 Q:ABORT
"RTN","PRCLA4",101,0)
 . W !,PRCLS(PRCLB)," Duplicate Tax IDs where ",PRCLB," vendors are duplicates (",PRCLS(PRCLB)*PRCLB," vendors).",!
"RTN","PRCLA4",102,0)
 . S L=L+2
"RTN","PRCLA4",103,0)
 . Q
"RTN","PRCLA4",104,0)
 K ^TMP("PRCLA",$J) ; Cleanup the compile.
"RTN","PRCLA4",105,0)
 Q
"RTN","PRCLA4",106,0)
RPT5 ; Duplicate Tax ID Numbers (Detail)
"RTN","PRCLA4",107,0)
 D COMP
"RTN","PRCLA4",108,0)
 S HDR="DETAILED DUPLICATE TAX ID NUMBERS REPORT",PRCLERR=0
"RTN","PRCLA4",109,0)
 D INS^PRCLA5("TXT45","PRCLA7") Q:ABORT
"RTN","PRCLA4",110,0)
 S HEAD="HDR5^PRCLA4"
"RTN","PRCLA4",111,0)
 D HDR^PRCLA1 Q:ABORT
"RTN","PRCLA4",112,0)
 S PRCLA="" F  S PRCLA=$O(^TMP("PRCLA",$J,PRCLA)) Q:PRCLA=""  D  Q:ABORT
"RTN","PRCLA4",113,0)
 . ; Count the number of duplicates to be displayed.
"RTN","PRCLA4",114,0)
 . S PRCLB="" F PRCLI=0:1 S PRCLB=$O(^TMP("PRCLA",$J,PRCLA,PRCLB)) Q:PRCLB=""
"RTN","PRCLA4",115,0)
 . ; One header line plus 2 lines for each duplicate (plus 3 lines as a buffer).
"RTN","PRCLA4",116,0)
 . D:L+(PRCLI*2)+4>IOSL HDR^PRCLA1 Q:ABORT
"RTN","PRCLA4",117,0)
 . S L=L+(PRCLI*2)+1,PRCLERR=1
"RTN","PRCLA4",118,0)
 . W !,PRCLA
"RTN","PRCLA4",119,0)
 . S PRCLB="" F  S PRCLB=$O(^TMP("PRCLA",$J,PRCLA,PRCLB)) Q:PRCLB=""  D
"RTN","PRCLA4",120,0)
 .. S PRCLN=$G(^PRC(440,PRCLB,0)),PRCLD1=$P(PRCLN,U,1)
"RTN","PRCLA4",121,0)
 .. S PRCLN=$G(^PRC(440,PRCLB,3)),PRCLD2=$P(PRCLN,U,5),PRCLD3=$P(PRCLN,U,4)
"RTN","PRCLA4",122,0)
 .. W !,?3,PRCLD3,?14,PRCLD2,?18,PRCLB,?24,$E(PRCLD1,1,25)
"RTN","PRCLA4",123,0)
 .. S PRCLN=$G(^PRC(440,PRCLB,7)),PRCLD1=$P(PRCLN,U,3),PRCLD2=$P(PRCLN,U,7),PRCLS=$P(PRCLN,U,8)
"RTN","PRCLA4",124,0)
 .. S PRCLN=$G(^DIC(5,PRCLS,0)),PRCLD3=$P(PRCLN,U,2)
"RTN","PRCLA4",125,0)
 .. W ?50,$E(PRCLD1,1,29)
"RTN","PRCLA4",126,0)
 .. W !,?50,$E(PRCLD2,1,25)," ",PRCLD3
"RTN","PRCLA4",127,0)
 .. Q
"RTN","PRCLA4",128,0)
 . Q
"RTN","PRCLA4",129,0)
 I 'PRCLERR W !!,"No problem records to report."
"RTN","PRCLA4",130,0)
 W !
"RTN","PRCLA4",131,0)
 K ^TMP("PRCLA",$J) ; Cleanup the compile.
"RTN","PRCLA4",132,0)
 Q
"RTN","PRCLA4",133,0)
HDR5 ;
"RTN","PRCLA4",134,0)
 W !,"Tax ID"
"RTN","PRCLA4",135,0)
 W !,?3,"FMS Code",?14,"AA",?18,"IEN",?24,"Vendor Name",?50,"Payment Address Line 1"
"RTN","PRCLA4",136,0)
 W !,?50,"City/State"
"RTN","PRCLA4",137,0)
 S L=L+3
"RTN","PRCLA4",138,0)
 Q
"RTN","PRCLA4",139,0)
COMP ; Compile for Duplicate Tax ID Numbers Report (Summary/Detail)
"RTN","PRCLA4",140,0)
 K ^TMP("PRCLA",$J)
"RTN","PRCLA4",141,0)
 S PRCLA=0 F  S PRCLA=$O(^XTMP("PRCLA",PRCLA)) Q:'PRCLA  D
"RTN","PRCLA4",142,0)
 . S PRCLN=$G(^PRC(440,PRCLA,3)),PRCLD1=$P(PRCLN,U,8)
"RTN","PRCLA4",143,0)
 . S PRCLN=$G(^PRC(440,PRCLA,10)),PRCLD2=$P(PRCLN,U,5) ; Inactive flag
"RTN","PRCLA4",144,0)
 . S PRCLN=$G(^PRC(440,PRCLA,0)),PRCLD3=$P(PRCLN,U,1) ; Vendor Name
"RTN","PRCLA4",145,0)
 . I PRCLD2=1!($E(PRCLD3,1,2)="**") Q  ; Inactive vendors will either have the flag = 1 or a "**" beginning their name.
"RTN","PRCLA4",146,0)
 . I PRCLD1="" Q
"RTN","PRCLA4",147,0)
 . I PRCLD1'?9N Q
"RTN","PRCLA4",148,0)
 . I PRCLD1?3"0"6N Q
"RTN","PRCLA4",149,0)
 . I PRCLD1?5"1"4N Q
"RTN","PRCLA4",150,0)
 . I PRCLD1?5"2"4N Q
"RTN","PRCLA4",151,0)
 . I PRCLD1?5"3"4N Q
"RTN","PRCLA4",152,0)
 . I PRCLD1?5"4"4N Q
"RTN","PRCLA4",153,0)
 . I PRCLD1?5"5"4N Q
"RTN","PRCLA4",154,0)
 . I PRCLD1?5"6"4N Q
"RTN","PRCLA4",155,0)
 . I PRCLD1?5"7"4N Q
"RTN","PRCLA4",156,0)
 . I PRCLD1?5"8"4N Q
"RTN","PRCLA4",157,0)
 . I PRCLD1?5"9"4N Q
"RTN","PRCLA4",158,0)
 . I PRCLD1="123456789" Q
"RTN","PRCLA4",159,0)
 . S ^TMP("PRCLA",$J,PRCLD1,PRCLA)=""
"RTN","PRCLA4",160,0)
 . Q
"RTN","PRCLA4",161,0)
 S PRCLA="" F  S PRCLA=$O(^TMP("PRCLA",$J,PRCLA)) Q:PRCLA=""  D  Q:ABORT
"RTN","PRCLA4",162,0)
 . K PRCLS
"RTN","PRCLA4",163,0)
 . S PRCLOK1=0
"RTN","PRCLA4",164,0)
 . S PRCLB="" F PRCLI=0:1 S PRCLB=$O(^TMP("PRCLA",$J,PRCLA,PRCLB)) Q:PRCLB=""  D
"RTN","PRCLA4",165,0)
 .. S PRCLN=$G(^PRC(440,PRCLB,3)),PRCLD1=$P(PRCLN,U,5)
"RTN","PRCLA4",166,0)
 .. I PRCLD1="" S PRCLOK1=1 Q  ; Missing ALT-ADDR-IND. Treat as duplicate.
"RTN","PRCLA4",167,0)
 .. I $D(PRCLS(PRCLD1)) S PRCLOK1=1 Q  ; Already found this ALT-ADDR-IND. Duplicate.
"RTN","PRCLA4",168,0)
 .. S PRCLS(PRCLD1)=""
"RTN","PRCLA4",169,0)
 .. Q
"RTN","PRCLA4",170,0)
 . I PRCLI<2 K ^TMP("PRCLA",$J,PRCLA)  ; Remove this Tax ID if only one Vendor has it.
"RTN","PRCLA4",171,0)
 . I PRCLOK1=0 K ^TMP("PRCLA",$J,PRCLA)  ; Remove this Tax ID if there are no real duplicates (all have different ALT-ADDR-IND).
"RTN","PRCLA4",172,0)
 . Q
"RTN","PRCLA4",173,0)
 Q
"RTN","PRCLA5")
0^11^B49813073
"RTN","PRCLA5",1,0)
PRCLA5 ;WOIFO/KJH - Vendor (Instructions Part 1) - CoreFLS Data Cleansing ;1 May 2003  4:19 PM
"RTN","PRCLA5",2,0)
 ;;5.1;IFCAP;**60,69**;Oct 20, 2000
"RTN","PRCLA5",3,0)
 ;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","PRCLA5",4,0)
 ;
"RTN","PRCLA5",5,0)
 ;NOTE: This routine is not callable from the top. Use TOP in PRCLA1.
"RTN","PRCLA5",6,0)
 Q
"RTN","PRCLA5",7,0)
INS(TAG,RTN) ; Print Data Cleansing 'instructions/notes' (max 75 columns per line).
"RTN","PRCLA5",8,0)
 I INS'="Y" S HEAD1=1 Q
"RTN","PRCLA5",9,0)
 S HDR="INSTRUCTIONS FOR "_HDR
"RTN","PRCLA5",10,0)
 D HDR^PRCLA1
"RTN","PRCLA5",11,0)
 F PRCLI=1:1 S @("PRCLN=$T("_TAG_"+"_PRCLI_"^"_RTN_")"),PRCLN=$P(PRCLN,";;",2,999) Q:PRCLN="**END**"  D:L+3>IOSL HDR^PRCLA1 Q:ABORT  W !,PRCLN S L=L+1
"RTN","PRCLA5",12,0)
 Q:ABORT
"RTN","PRCLA5",13,0)
 ; Must have a page break between instructions and report, but don't want to do a full header.
"RTN","PRCLA5",14,0)
 W !!,"<End of Instructions>"
"RTN","PRCLA5",15,0)
 ; Do not ask 'RETURN' before first page on CRT.
"RTN","PRCLA5",16,0)
 I $E(IOST,1,2)="C-",P R " Enter RETURN to continue or '^' to exit: ",Y:DTIME I '$T!(Y[U) S ABORT=1 Q
"RTN","PRCLA5",17,0)
 ; Do not print a form feed before first page on printer. Top of form is set at end of previous report.
"RTN","PRCLA5",18,0)
 I $E(IOST,1,2)="C-"!P W @IOF
"RTN","PRCLA5",19,0)
 S HDR=$P(HDR," ",3,$L(HDR," ")),HEAD1=1,P=0,L=0 ; Reset header and page and line number indicators for main report
"RTN","PRCLA5",20,0)
 Q
"RTN","PRCLA5",21,0)
TXT2 ; ===========================================================================
"RTN","PRCLA5",22,0)
 ;;The following instructions/notes refer to the CoreFLS Data Cleansing
"RTN","PRCLA5",23,0)
 ;;Detailed Vendor Report (Fiscal). They explain the criteria for each
"RTN","PRCLA5",24,0)
 ;;field and what actions the user needs to take to update any fields that
"RTN","PRCLA5",25,0)
 ;;do not conform to the required formats. The report displays fields that
"RTN","PRCLA5",26,0)
 ;;do not match CoreFLS guidelines for vendor records which would be
"RTN","PRCLA5",27,0)
 ;;converted into CoreFLS.
"RTN","PRCLA5",28,0)
 ;;
"RTN","PRCLA5",29,0)
 ;;The vendors have been selected for conversion based on the following
"RTN","PRCLA5",30,0)
 ;;criteria: The vendor is associated with any convertible transaction in the
"RTN","PRCLA5",31,0)
 ;;Purchase Order file (#442) created within the last 24 months.
"RTN","PRCLA5",32,0)
 ;;("Convertible" transactions are defined as those that do 
"RTN","PRCLA5",33,0)
 ;;not have a status of Order Not Completely Prepared, Canceled Order, 
"RTN","PRCLA5",34,0)
 ;;Cancelled - 1358, or Obligated 1358.)
"RTN","PRCLA5",35,0)
 ;;
"RTN","PRCLA5",36,0)
 ;;Each field can contain one of the following pieces of information:
"RTN","PRCLA5",37,0)
 ;;
"RTN","PRCLA5",38,0)
 ;;* OK *
"RTN","PRCLA5",39,0)
 ;;  - The field contains data and it is in a format acceptable to CoreFLS.
"RTN","PRCLA5",40,0)
 ;;    No problems were detected. The user can ignore these fields.
"RTN","PRCLA5",41,0)
 ;;    OK fields are listed (rather than suppressed) so that the data fields
"RTN","PRCLA5",42,0)
 ;;    appear in the same position for every vendor record making it easier
"RTN","PRCLA5",43,0)
 ;;    to scan the reports for specific fields of interest.
"RTN","PRCLA5",44,0)
 ;;
"RTN","PRCLA5",45,0)
 ;;* Required field *
"RTN","PRCLA5",46,0)
 ;;  - The field is required in CoreFLS, but may or may not be required in
"RTN","PRCLA5",47,0)
 ;;    VistA. The user needs to determine what value should be stored in this
"RTN","PRCLA5",48,0)
 ;;    field and update it in the VistA system.
"RTN","PRCLA5",49,0)
 ;;
"RTN","PRCLA5",50,0)
 ;;BLANK (no data displayed)
"RTN","PRCLA5",51,0)
 ;;  - The field has no data stored in it in the VistA system and it is not
"RTN","PRCLA5",52,0)
 ;;    required in CoreFLS. (The user may still wish to review these fields
"RTN","PRCLA5",53,0)
 ;;    to determine if they would like to populate them before the conversion
"RTN","PRCLA5",54,0)
 ;;    to CoreFLS.)
"RTN","PRCLA5",55,0)
 ;;
"RTN","PRCLA5",56,0)
 ;;Any Other Data Displayed
"RTN","PRCLA5",57,0)
 ;;  - The field contains data that will present a problem for the CoreFLS
"RTN","PRCLA5",58,0)
 ;;    data conversion.
"RTN","PRCLA5",59,0)
 ;;
"RTN","PRCLA5",60,0)
 ;;The following FIELD DESCRIPTIONS list details for each header abbreviation,
"RTN","PRCLA5",61,0)
 ;;the field name and number, and the allowed values or other screening
"RTN","PRCLA5",62,0)
 ;;criteria used for that field. Unless otherwise noted, all fields are from
"RTN","PRCLA5",63,0)
 ;;the VENDOR (#440) file. Consult the help text for each field in the VistA
"RTN","PRCLA5",64,0)
 ;;system for further information.
"RTN","PRCLA5",65,0)
 ;;
"RTN","PRCLA5",66,0)
 ;;FIELD DESCRIPTIONS
"RTN","PRCLA5",67,0)
 ;;===========================================================================
"RTN","PRCLA5",68,0)
 ;;Most Recent PO:
"RTN","PRCLA5",69,0)
 ;;  - The most recent PURCHASE ORDER NUMBER (field #.01) and P.O. DATE
"RTN","PRCLA5",70,0)
 ;;    (field # .1) on record in the PROCUREMENT AND ACCOUNTING TRANSACTIONS
"RTN","PRCLA5",71,0)
 ;;    (#442) file for this vendor displays. The METHOD OF PROCESSING
"RTN","PRCLA5",72,0)
 ;;    (field #.02) and SUPPLY STATUS (field #.5) identifiers also display on
"RTN","PRCLA5",73,0)
 ;;    this line. This information is provided so that the user can see the
"RTN","PRCLA5",74,0)
 ;;    most recent transaction for this vendor. It is not necessarily the
"RTN","PRCLA5",75,0)
 ;;    transaction that met the criteria for selecting the vendor.
"RTN","PRCLA5",76,0)
 ;;
"RTN","PRCLA5",77,0)
 ;;1099 Ind      [1099 VENDOR INDICATOR (Field #41)  ]
"RTN","PRCLA5",78,0)
 ;;  - Required Field. Either "Y" or "N".
"RTN","PRCLA5",79,0)
 ;;
"RTN","PRCLA5",80,0)
 ;;Tax ID        [TAX ID/SSN            (Field #38)  ]
"RTN","PRCLA5",81,0)
 ;;  - Required field. Report flags any missing or 'suspicious' IDs for
"RTN","PRCLA5",82,0)
 ;;    review. Note that the 'suspicious' ones are not necessarily wrong, but
"RTN","PRCLA5",83,0)
 ;;    they should be reviewed carefully. However, note that the CoreFLS
"RTN","PRCLA5",84,0)
 ;;    system does require a Tax ID.
"RTN","PRCLA5",85,0)
 ;;
"RTN","PRCLA5",86,0)
 ;;SSN/Tax       [SSN/TAX ID INDICATOR  (Field #39)  ]
"RTN","PRCLA5",87,0)
 ;;  - Required field. Must be either "S" or "T".
"RTN","PRCLA5",88,0)
 ;;
"RTN","PRCLA5",89,0)
 ;;FMS Code      [FMS VENDOR CODE       (Field #34)  ]
"RTN","PRCLA5",90,0)
 ;;  - See the comments for the next field.
"RTN","PRCLA5",91,0)
 ;;
"RTN","PRCLA5",92,0)
 ;;FMS Name      [FMS VENDOR NAME       (Field #34.5)]
"RTN","PRCLA5",93,0)
 ;;  - If 'FMS Code' or 'FMS Name' is populated then the other field must
"RTN","PRCLA5",94,0)
 ;;    also be populated.
"RTN","PRCLA5",95,0)
 ;;    (In this case, the report displays a valid-looking entry in one field
"RTN","PRCLA5",96,0)
 ;;    and "* Required field *" in the other. The user needs to determine
"RTN","PRCLA5",97,0)
 ;;    whether to remove the displayed entry or to insert the missing
"RTN","PRCLA5",98,0)
 ;;    entry to fix the problem.)
"RTN","PRCLA5",99,0)
 ;;
"RTN","PRCLA5",100,0)
 ;;ALT-ADDR      [ALT-ADDR-IND          (Field #35)  ]
"RTN","PRCLA5",101,0)
 ;;  - If this field is populated, then 'FMS Code' and 'FMS Name' fields must
"RTN","PRCLA5",102,0)
 ;;    also be populated.
"RTN","PRCLA5",103,0)
 ;;
"RTN","PRCLA5",104,0)
 ;;Pay Addr1     [PAYMENT ADDRESS1      (Field #17.3)]
"RTN","PRCLA5",105,0)
 ;;  - Required field if there is no ordering address.
"RTN","PRCLA5",106,0)
 ;;
"RTN","PRCLA5",107,0)
 ;;Pay Addr2     [PAYMENT ADDRESS2      (Field #17.4)]
"RTN","PRCLA5",108,0)
 ;;  - If this field is blank and Pay Addr3 or Pay Addr4 is populated then
"RTN","PRCLA5",109,0)
 ;;    this field is reported. If additional address lines are required,
"RTN","PRCLA5",110,0)
 ;;    they should start in this field.
"RTN","PRCLA5",111,0)
 ;;
"RTN","PRCLA5",112,0)
 ;;Pay Addr3     [PAYMENT ADDRESS3      (Field #17.5)]
"RTN","PRCLA5",113,0)
 ;;  - Optional, if address requires three lines.
"RTN","PRCLA5",114,0)
 ;;    This field does not have any special requirements, but any data found
"RTN","PRCLA5",115,0)
 ;;    in this field is displayed for the user to review for accuracy.
"RTN","PRCLA5",116,0)
 ;;
"RTN","PRCLA5",117,0)
 ;;Pay Addr4     [PAYMENT ADDRESS4      (Field #17.6)]
"RTN","PRCLA5",118,0)
 ;;  - This field will not be converted into CoreFLS. Any data found
"RTN","PRCLA5",119,0)
 ;;    in this field is displayed. If it is important data then the
"RTN","PRCLA5",120,0)
 ;;    user needs to move it to some other field for conversion.
"RTN","PRCLA5",121,0)
 ;;
"RTN","PRCLA5",122,0)
 ;;Pay City      [PAYMENT CITY          (Field #17.7)]
"RTN","PRCLA5",123,0)
 ;;  - Required field if there is no ordering address.
"RTN","PRCLA5",124,0)
 ;;
"RTN","PRCLA5",125,0)
 ;;Pay State     [PAYMENT STATE         (Field #17.8)]
"RTN","PRCLA5",126,0)
 ;;  - Required field if there is no ordering address.
"RTN","PRCLA5",127,0)
 ;;    Must be a valid entry in the STATE file (#5).
"RTN","PRCLA5",128,0)
 ;;
"RTN","PRCLA5",129,0)
 ;;Pay ZIP       [PAYMENT ZIP CODE      (Field #17.9)]
"RTN","PRCLA5",130,0)
 ;;  - Required field if there is no ordering address.
"RTN","PRCLA5",131,0)
 ;;    Must be in the format of 5 numbers only, or 9 numbers only, or
"RTN","PRCLA5",132,0)
 ;;    5 numbers "-" 4 numbers. 'Foreign' ZIP codes may be left as is.
"RTN","PRCLA5",133,0)
 ;;**END**
"RTN","PRCLA6")
0^3^B51164971
"RTN","PRCLA6",1,0)
PRCLA6 ;WOIFO/KJH - Vendor (Instructions Part 2) - CoreFLS Data Cleansing ;18 Apr 2003  4:19 PM
"RTN","PRCLA6",2,0)
 ;;5.1;IFCAP;**60,69**;Oct 20, 2000
"RTN","PRCLA6",3,0)
 ;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","PRCLA6",4,0)
 ;
"RTN","PRCLA6",5,0)
 ;NOTE: This routine is not callable from the top. Use TOP in PRCLA1.
"RTN","PRCLA6",6,0)
 Q
"RTN","PRCLA6",7,0)
TXT3 ; ===========================================================================
"RTN","PRCLA6",8,0)
 ;;The following instructions/notes refer to the CoreFLS Data Cleansing
"RTN","PRCLA6",9,0)
 ;;Detailed Vendor Report (Supply). They explain the criteria for each field
"RTN","PRCLA6",10,0)
 ;;and what actions the user needs to take to update any fields that do
"RTN","PRCLA6",11,0)
 ;;not conform to the required formats. The report displays fields that do
"RTN","PRCLA6",12,0)
 ;;not match CoreFLS guidelines for vendor records which would be converted
"RTN","PRCLA6",13,0)
 ;;into CoreFLS.
"RTN","PRCLA6",14,0)
 ;;
"RTN","PRCLA6",15,0)
 ;;The vendors have been selected for conversion based on the following
"RTN","PRCLA6",16,0)
 ;;criteria: The vendor is associated with any convertible transaction in the
"RTN","PRCLA6",17,0)
 ;;Purchase Order file (#442) created within the last 24 months.
"RTN","PRCLA6",18,0)
 ;;("Convertible" transactions are defined as those that do 
"RTN","PRCLA6",19,0)
 ;;not have a status of Transaction Complete, Transaction Complete 
"RTN","PRCLA6",20,0)
 ;;(Amended), Order Not Completely Prepared, Canceled Order, 
"RTN","PRCLA6",21,0)
 ;;Cancelled - 1358, or Obligated 1358.)
"RTN","PRCLA6",22,0)
 ;;
"RTN","PRCLA6",23,0)
 ;;Each field can contain one of the following pieces of information:
"RTN","PRCLA6",24,0)
 ;;
"RTN","PRCLA6",25,0)
 ;;* OK *
"RTN","PRCLA6",26,0)
 ;;  - The field contains data and it is in a format acceptable to CoreFLS.
"RTN","PRCLA6",27,0)
 ;;    No problems were detected. The user can ignore these fields.
"RTN","PRCLA6",28,0)
 ;;    OK fields are listed (rather than suppressed) so that the data fields
"RTN","PRCLA6",29,0)
 ;;    appear in the same position for every vendor record making it easier
"RTN","PRCLA6",30,0)
 ;;    to scan the reports for specific fields of interest.
"RTN","PRCLA6",31,0)
 ;;
"RTN","PRCLA6",32,0)
 ;;* Required field *
"RTN","PRCLA6",33,0)
 ;;  - The field is required in CoreFLS, but may or may not be required in
"RTN","PRCLA6",34,0)
 ;;    VistA. The user needs to determine what value should be stored in this
"RTN","PRCLA6",35,0)
 ;;    field and update it in the VistA system.
"RTN","PRCLA6",36,0)
 ;;
"RTN","PRCLA6",37,0)
 ;;BLANK (no data displayed)
"RTN","PRCLA6",38,0)
 ;;  - The field has no data stored in it in the VistA system and it is not
"RTN","PRCLA6",39,0)
 ;;    required in CoreFLS. (The user may still wish to review these fields
"RTN","PRCLA6",40,0)
 ;;    to determine if they would like to populate these fields before the
"RTN","PRCLA6",41,0)
 ;;    conversion to CoreFLS.)
"RTN","PRCLA6",42,0)
 ;;
"RTN","PRCLA6",43,0)
 ;;Any Other Data Displayed
"RTN","PRCLA6",44,0)
 ;;  - The field contains data that will present a problem for the CoreFLS
"RTN","PRCLA6",45,0)
 ;;    data conversion.
"RTN","PRCLA6",46,0)
 ;;
"RTN","PRCLA6",47,0)
 ;;The following FIELD DESCRIPTIONS list details for each header abbreviation,
"RTN","PRCLA6",48,0)
 ;;the field name and number, and the allowed values or other screening
"RTN","PRCLA6",49,0)
 ;;criteria used for that field. Unless otherwise noted, all fields are from
"RTN","PRCLA6",50,0)
 ;;the VENDOR (#440) file. Consult the help text for each field in the VistA
"RTN","PRCLA6",51,0)
 ;;system for further information.
"RTN","PRCLA6",52,0)
 ;;
"RTN","PRCLA6",53,0)
 ;;===========================================================================
"RTN","PRCLA6",54,0)
 ;;Most Recent PO:
"RTN","PRCLA6",55,0)
 ;;  - The most recent PURCHASE ORDER NUMBER (field #.01) and P.O. DATE
"RTN","PRCLA6",56,0)
 ;;    (field # .1) on record in the PROCUREMENT AND ACCOUNTING TRANSACTIONS
"RTN","PRCLA6",57,0)
 ;;    (#442) file for this vendor displays. The METHOD OF PROCESSING
"RTN","PRCLA6",58,0)
 ;;    (field #.02) and SUPPLY STATUS (field #.5) identifiers also display on
"RTN","PRCLA6",59,0)
 ;;    this line. This information is provided so that the user can see the
"RTN","PRCLA6",60,0)
 ;;    most recent transaction for this vendor. It is not necessarily the
"RTN","PRCLA6",61,0)
 ;;    transaction that met the criteria for selecting the vendor.
"RTN","PRCLA6",62,0)
 ;;
"RTN","PRCLA6",63,0)
 ;;Vend Type     [VENDOR TYPE                (Field #44)  ]
"RTN","PRCLA6",64,0)
 ;;  - Required field. Must be one of the following:
"RTN","PRCLA6",65,0)
 ;;       A (AGENT CASHIER)
"RTN","PRCLA6",66,0)
 ;;       C (COMMERCIAL)
"RTN","PRCLA6",67,0)
 ;;       E (EMPLOYEE)
"RTN","PRCLA6",68,0)
 ;;       F (FEDERAL GOVERNMENT)
"RTN","PRCLA6",69,0)
 ;;       G (GSA)
"RTN","PRCLA6",70,0)
 ;;       I (INDIVIDUALS-OTHER)
"RTN","PRCLA6",71,0)
 ;;       K (CANTEEN)
"RTN","PRCLA6",72,0)
 ;;       O (OTHER COUNTRIES)
"RTN","PRCLA6",73,0)
 ;;       R (COMMERCIAL-RECURRING PMTS)
"RTN","PRCLA6",74,0)
 ;;       U (UTILITY COMPANIES)
"RTN","PRCLA6",75,0)
 ;;       V (VETERANS)
"RTN","PRCLA6",76,0)
 ;;
"RTN","PRCLA6",77,0)
 ;;Bus Type      [BUSINESS TYPE (FPDS)       (Field #8.3) ]
"RTN","PRCLA6",78,0)
 ;;  - Required field. Must be one of the following:
"RTN","PRCLA6",79,0)
 ;;       1 (SMALL)
"RTN","PRCLA6",80,0)
 ;;       2 (LARGE)
"RTN","PRCLA6",81,0)
 ;;       3 (OUTSIDE U.S.)
"RTN","PRCLA6",82,0)
 ;;       4 (OTHER ENTITIES)
"RTN","PRCLA6",83,0)
 ;;
"RTN","PRCLA6",84,0)
 ;;Contact       [PROCUREMENT CONTACT PERSON (Field #4.8) ]
"RTN","PRCLA6",85,0)
 ;;  - May not contain any numbers and must be in one of the following formats:
"RTN","PRCLA6",86,0)
 ;;      FirstName MiddleName LastName (preferred)
"RTN","PRCLA6",87,0)
 ;;      FirstName LastName (preferred)
"RTN","PRCLA6",88,0)
 ;;      LastName,Firstname,MiddleName
"RTN","PRCLA6",89,0)
 ;;      LastName,FirstName
"RTN","PRCLA6",90,0)
 ;;      Name
"RTN","PRCLA6",91,0)
 ;;
"RTN","PRCLA6",92,0)
 ;;D&B #         [DUN & BRADSTREET #         (Field #18.3)]
"RTN","PRCLA6",93,0)
 ;;  - Must pass the field's current Input Transform.
"RTN","PRCLA6",94,0)
 ;;
"RTN","PRCLA6",95,0)
 ;;Socio Grp     [SOCIOECONOMIC GROUP (FPDS) (Field #10)  ]
"RTN","PRCLA6",96,0)
 ;;  - Must be a valid entry in the CODE INDEX file (#420.6). Note that the
"RTN","PRCLA6",97,0)
 ;;    report only displays the first bad entry for each vendor if there
"RTN","PRCLA6",98,0)
 ;;    is more than one.
"RTN","PRCLA6",99,0)
 ;;
"RTN","PRCLA6",100,0)
 ;;FAX           [FAX #                      (Field #46)  ]
"RTN","PRCLA6",101,0)
 ;;  - Preferred format is 3 number "-" 3 number "-" 4 number. Other formats
"RTN","PRCLA6",102,0)
 ;;    are also possible but must conform to 3N 3N 4N or 1N 3N 3N 4N.
"RTN","PRCLA6",103,0)
 ;;
"RTN","PRCLA6",104,0)
 ;;Phone         [VENDOR PHONE NUMBER        (Field #5)   ]
"RTN","PRCLA6",105,0)
 ;;  - Preferred format is similar to the FAX number but optionally, an
"RTN","PRCLA6",106,0)
 ;;    extension may be added. The extension must be preceded by "X" or "EXT".
"RTN","PRCLA6",107,0)
 ;;
"RTN","PRCLA6",108,0)
 ;;EDI Vend      [EDI VENDOR?                (Field #.2)  ]
"RTN","PRCLA6",109,0)
 ;;  - If set to "Y"es then Vend ID# field must be populated.
"RTN","PRCLA6",110,0)
 ;;
"RTN","PRCLA6",111,0)
 ;;Vend ID#      [VENDOR ID NUMBER           (Field #.4)  ]
"RTN","PRCLA6",112,0)
 ;;  - If Vend ID# is populated then EDI Vend field must be set to "Y".
"RTN","PRCLA6",113,0)
 ;;
"RTN","PRCLA6",114,0)
 ;;Ord Addr1     [ORDERING ADDRESS1          (Field #1)   ]
"RTN","PRCLA6",115,0)
 ;;  - Required field if there is no payment address.
"RTN","PRCLA6",116,0)
 ;;
"RTN","PRCLA6",117,0)
 ;;Ord Addr2     [ORDERING ADDRESS2          (Field #2)   ]
"RTN","PRCLA6",118,0)
 ;;  - If this field is blank and Ord Addr3 or Ord Addr4 is populated then
"RTN","PRCLA6",119,0)
 ;;    this field is reported. If additional address lines are required,
"RTN","PRCLA6",120,0)
 ;;    they should start in this field.
"RTN","PRCLA6",121,0)
 ;;
"RTN","PRCLA6",122,0)
 ;;Ord Addr3     [ORDERING ADDRESS3          (Field #3)   ]
"RTN","PRCLA6",123,0)
 ;;  - Optional, if address requires three lines.
"RTN","PRCLA6",124,0)
 ;;    This field does not have any special requirements, but any data found
"RTN","PRCLA6",125,0)
 ;;    in this field is displayed for the user to review for accuracy.
"RTN","PRCLA6",126,0)
 ;;
"RTN","PRCLA6",127,0)
 ;;Ord Addr4     [ORDERING ADDRESS4          (Field #4)   ]
"RTN","PRCLA6",128,0)
 ;;  - This field will not be converted into CoreFLS. Any data found
"RTN","PRCLA6",129,0)
 ;;    in this field is displayed. If it is important data then the
"RTN","PRCLA6",130,0)
 ;;    user needs to move it to some other field for conversion.
"RTN","PRCLA6",131,0)
 ;;
"RTN","PRCLA6",132,0)
 ;;Ord City      [ORDERING CITY              (Field #4.2) ]
"RTN","PRCLA6",133,0)
 ;;  - Required field if there is no payment address.
"RTN","PRCLA6",134,0)
 ;;
"RTN","PRCLA6",135,0)
 ;;Ord State     [ORDERING STATE             (Field #4.4) ]
"RTN","PRCLA6",136,0)
 ;;  - Required field if there is no payment address. Must be a valid entry
"RTN","PRCLA6",137,0)
 ;;    in the STATE file (#5).
"RTN","PRCLA6",138,0)
 ;;
"RTN","PRCLA6",139,0)
 ;;Ord ZIP       [ORDERING ZIP CODE          (Field #4.6) ]
"RTN","PRCLA6",140,0)
 ;;  - Required field if there is no payment address.
"RTN","PRCLA6",141,0)
 ;;    Must be in the format of 5 numbers only, or 9 numbers only, or
"RTN","PRCLA6",142,0)
 ;;    5 numbers "-" 4 numbers. 'Foreign' ZIP codes may be left as is.
"RTN","PRCLA6",143,0)
 ;;**END**
"RTN","PRCLA7")
0^12^B55467271
"RTN","PRCLA7",1,0)
PRCLA7 ;WOIFO/KJH - Vendor (Instructions Part 3) - CoreFLS Data Cleansing ;1 May 2003  4:19 PM
"RTN","PRCLA7",2,0)
 ;;5.1;IFCAP;**69**;Oct 20, 2000
"RTN","PRCLA7",3,0)
 ;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","PRCLA7",4,0)
 ;
"RTN","PRCLA7",5,0)
 ;NOTE: This routine is not callable from the top. Use TOP in PRCLA1.
"RTN","PRCLA7",6,0)
 ;
"RTN","PRCLA7",7,0)
 ;This routine contains several tags that were split from PRCLA5 and
"RTN","PRCLA7",8,0)
 ;PRCLA6 because of the routine size limits.
"RTN","PRCLA7",9,0)
 Q
"RTN","PRCLA7",10,0)
TXT41 ; ===========================================================================
"RTN","PRCLA7",11,0)
 ;;The following instructions/notes refer to the CoreFLS Data Cleansing detailed
"RTN","PRCLA7",12,0)
 ;;vendor report for Missing Vendor Name or "B" x-ref.
"RTN","PRCLA7",13,0)
 ;;
"RTN","PRCLA7",14,0)
 ;;This report displays two related pieces of information:
"RTN","PRCLA7",15,0)
 ;;        1) If a Vendor record is found where the NAME (#.01) field is blank,
"RTN","PRCLA7",16,0)
 ;;           then this report displays the internal entry number (IEN) for the
"RTN","PRCLA7",17,0)
 ;;           vendor and a message that this is a required field. In this case,
"RTN","PRCLA7",18,0)
 ;;           the user needs to determine the correct vendor name so that the
"RTN","PRCLA7",19,0)
 ;;           vendor will be converted into CoreFLS.
"RTN","PRCLA7",20,0)
 ;;
"RTN","PRCLA7",21,0)
 ;;        2) If the vendor name is not found in the "B" cross-reference, this
"RTN","PRCLA7",22,0)
 ;;           report displays the vendor name and IEN with a message that the
"RTN","PRCLA7",23,0)
 ;;           "B" x-ref is missing. This needs to be corrected because the
"RTN","PRCLA7",24,0)
 ;;           CoreFLS extraction process depends on this cross-reference.
"RTN","PRCLA7",25,0)
 ;;
"RTN","PRCLA7",26,0)
 ;;The information for each record is printed by row with the following columns:
"RTN","PRCLA7",27,0)
 ;;
"RTN","PRCLA7",28,0)
 ;;IEN       - VENDOR (#440) file internal record (entry) number
"RTN","PRCLA7",29,0)
 ;;
"RTN","PRCLA7",30,0)
 ;;Vendor    - value found in the NAME (#.01) field or
"RTN","PRCLA7",31,0)
 ;;            "* Required field *" if this field is blank
"RTN","PRCLA7",32,0)
 ;;
"RTN","PRCLA7",33,0)
 ;;Reason    - brief description of the identified problem:
"RTN","PRCLA7",34,0)
 ;;
"RTN","PRCLA7",35,0)
 ;;            "Vendor Name Missing" means the NAME (#.01) field is blank.
"RTN","PRCLA7",36,0)
 ;;
"RTN","PRCLA7",37,0)
 ;;            "Vendor Name not in 'B' x-ref" means the Vendor Name found
"RTN","PRCLA7",38,0)
 ;;             in the NAME (#.01) field is not listed in the "B"
"RTN","PRCLA7",39,0)
 ;;             cross-reference.
"RTN","PRCLA7",40,0)
 ;;
"RTN","PRCLA7",41,0)
 ;;NOTE: Contact National VistA Support to resolve all entries on this report.
"RTN","PRCLA7",42,0)
 ;;**END**
"RTN","PRCLA7",43,0)
TXT42 ; ===========================================================================
"RTN","PRCLA7",44,0)
 ;;The following instructions/notes refer to the CoreFLS Data Cleansing
"RTN","PRCLA7",45,0)
 ;;detailed vendor report for Multiple Synonyms.
"RTN","PRCLA7",46,0)
 ;;
"RTN","PRCLA7",47,0)
 ;;This report is an informational report that displays any vendors having more
"RTN","PRCLA7",48,0)
 ;;than one SYNONYM (#20) field entered. In the VistA system, the synonym field
"RTN","PRCLA7",49,0)
 ;;is a multiple. However, in the CoreFLS system there is only one synonym
"RTN","PRCLA7",50,0)
 ;;allowed per vendor. Users are encouraged to remove redundant synonyms, but
"RTN","PRCLA7",51,0)
 ;;if these synonyms remain, CoreFLS conversion will not be affected. One of
"RTN","PRCLA7",52,0)
 ;;the synonyms will be selected during the conversion process, usually the
"RTN","PRCLA7",53,0)
 ;;first one in alphabetical order.
"RTN","PRCLA7",54,0)
 ;;
"RTN","PRCLA7",55,0)
 ;;The information for each record is printed by row with the following
"RTN","PRCLA7",56,0)
 ;;columns:
"RTN","PRCLA7",57,0)
 ;;
"RTN","PRCLA7",58,0)
 ;;Vendor IEN        - VENDOR (#440) file internal record (entry) number
"RTN","PRCLA7",59,0)
 ;;
"RTN","PRCLA7",60,0)
 ;;Vendor Name       - value found in the NAME (#.01) field
"RTN","PRCLA7",61,0)
 ;;
"RTN","PRCLA7",62,0)
 ;;Synonym Number    - Sequential number assigned to differentiate the synonyms
"RTN","PRCLA7",63,0)
 ;;
"RTN","PRCLA7",64,0)
 ;;Synonym           - entry from the SYNONYM (#20) multiple field
"RTN","PRCLA7",65,0)
 ;;**END**
"RTN","PRCLA7",66,0)
TXT43 ; ===========================================================================
"RTN","PRCLA7",67,0)
 ;;The following instructions/notes refer to the CoreFLS Data Cleansing
"RTN","PRCLA7",68,0)
 ;;Detailed Vendor report for Inactive/Replaced Vendors.
"RTN","PRCLA7",69,0)
 ;;
"RTN","PRCLA7",70,0)
 ;;This report is an informational report that displays all vendors marked as
"RTN","PRCLA7",71,0)
 ;;"inactive". (Either the INACTIVATED VENDOR (#31.5) field contains "1"
"RTN","PRCLA7",72,0)
 ;;(INACTIVATED) or the NAME (#.01) field begins with "**"). Also, when the
"RTN","PRCLA7",73,0)
 ;;"inactive" vendor has a designated "replacement" vendor in the
"RTN","PRCLA7",74,0)
 ;;REPLACEMENT VENDOR (#15) field, the replacement vendor is also displayed.
"RTN","PRCLA7",75,0)
 ;;The user should review these entries for accuracy and ensure:
"RTN","PRCLA7",76,0)
 ;;
"RTN","PRCLA7",77,0)
 ;;1. All vendors that should be inactive are marked as such.
"RTN","PRCLA7",78,0)
 ;;2. Vendors are correctly marked as "inactive".
"RTN","PRCLA7",79,0)
 ;;3. Replacement vendors correctly replace the vendors to whom they
"RTN","PRCLA7",80,0)
 ;;   are assigned.
"RTN","PRCLA7",81,0)
 ;;
"RTN","PRCLA7",82,0)
 ;;NOTE: A blank entry in the Replacement Vendor column is acceptable when
"RTN","PRCLA7",83,0)
 ;;      an inactive vendor is no longer in use.
"RTN","PRCLA7",84,0)
 ;;
"RTN","PRCLA7",85,0)
 ;;The information for each record is printed by row with the following
"RTN","PRCLA7",86,0)
 ;;columns:
"RTN","PRCLA7",87,0)
 ;;
"RTN","PRCLA7",88,0)
 ;;IEN                 - VENDOR (#440) file internal record (entry) number for
"RTN","PRCLA7",89,0)
 ;;                      the vendor marked "inactive"
"RTN","PRCLA7",90,0)
 ;;
"RTN","PRCLA7",91,0)
 ;;Vendor Name         - value found in the NAME (#.01) field for the vendor
"RTN","PRCLA7",92,0)
 ;;                      marked "inactive"
"RTN","PRCLA7",93,0)
 ;;
"RTN","PRCLA7",94,0)
 ;;Rep IEN             - VENDOR (#440) file internal record (entry) number for
"RTN","PRCLA7",95,0)
 ;;                      the vendor replacing the "inactive" vendor
"RTN","PRCLA7",96,0)
 ;;
"RTN","PRCLA7",97,0)
 ;;Replacement Name    - value found in the NAME (#.01) field for the vendor
"RTN","PRCLA7",98,0)
 ;;                      replacing the "inactive" vendor
"RTN","PRCLA7",99,0)
 ;;**END**
"RTN","PRCLA7",100,0)
TXT45 ; ===========================================================================
"RTN","PRCLA7",101,0)
 ;;The following instructions/notes refer to the CoreFLS Data Cleansing
"RTN","PRCLA7",102,0)
 ;;detailed vendor report for Duplicate Tax ID Numbers.
"RTN","PRCLA7",103,0)
 ;;
"RTN","PRCLA7",104,0)
 ;;This report is an informational report which displays all vendors with the
"RTN","PRCLA7",105,0)
 ;;same Tax ID/SSN. The user should review the report to ensure that all
"RTN","PRCLA7",106,0)
 ;;vendors with the same Tax ID are in fact related and that the vendor names
"RTN","PRCLA7",107,0)
 ;;are similar. The names and Tax IDs should be updated as necessary to make
"RTN","PRCLA7",108,0)
 ;;sure that they accurately represent the vendors that they reference. This
"RTN","PRCLA7",109,0)
 ;;is crucial to ensure proper association with data from FMS.
"RTN","PRCLA7",110,0)
 ;;
"RTN","PRCLA7",111,0)
 ;;The information for each record is printed by row with the following
"RTN","PRCLA7",112,0)
 ;;columns:
"RTN","PRCLA7",113,0)
 ;;
"RTN","PRCLA7",114,0)
 ;;Tax ID              - value found in the TAX ID/SSN (#38) field
"RTN","PRCLA7",115,0)
 ;;                      (Each Tax ID has a group of vendor records
"RTN","PRCLA7",116,0)
 ;;                       with the same Tax ID.)
"RTN","PRCLA7",117,0)
 ;;
"RTN","PRCLA7",118,0)
 ;;FMS Code            - value found in the FMS VENDOR CODE (#34) field
"RTN","PRCLA7",119,0)
 ;;
"RTN","PRCLA7",120,0)
 ;;AA                  - value found in the ALT-ADDR-IND (#35) field
"RTN","PRCLA7",121,0)
 ;;                      (Refer to Special Note below)
"RTN","PRCLA7",122,0)
 ;;
"RTN","PRCLA7",123,0)
 ;;IEN                 - VENDOR (#440) file internal record (entry) number
"RTN","PRCLA7",124,0)
 ;;
"RTN","PRCLA7",125,0)
 ;;Vendor Name         - value found in the NAME (#.01) field
"RTN","PRCLA7",126,0)
 ;;
"RTN","PRCLA7",127,0)
 ;;Payment Address
"RTN","PRCLA7",128,0)
 ;;    Line 1          - value found in the PAYMENT ADDRESS1 (#17.3) field
"RTN","PRCLA7",129,0)
 ;;    City            - value found in the PAYMENT CITY (#17.7) field
"RTN","PRCLA7",130,0)
 ;;    State           - value found in the PAYMENT STATE (#17.8) field
"RTN","PRCLA7",131,0)
 ;;
"RTN","PRCLA7",132,0)
 ;;**** Special Note on Alternate Address Indicators *************************
"RTN","PRCLA7",133,0)
 ;;Vendors with the "AA" indicator are usually not displayed on this report
"RTN","PRCLA7",134,0)
 ;;(even though they may have duplicate Tax ID Numbers), because the presence
"RTN","PRCLA7",135,0)
 ;;of an AA indicator effectively marks these vendors as "different" vendors.
"RTN","PRCLA7",136,0)
 ;;
"RTN","PRCLA7",137,0)
 ;;The exceptions are:
"RTN","PRCLA7",138,0)
 ;;
"RTN","PRCLA7",139,0)
 ;;1.      More than one vendor has the same AA (only the vendors with the
"RTN","PRCLA7",140,0)
 ;;        same AA will display).
"RTN","PRCLA7",141,0)
 ;;2.      Some vendors with the same Tax ID have an AA and some do not
"RTN","PRCLA7",142,0)
 ;;        (all vendors with the same Tax ID will display).
"RTN","PRCLA7",143,0)
 ;;
"RTN","PRCLA7",144,0)
 ;;***************************************************************************
"RTN","PRCLA7",145,0)
 ;;**END**
"RTN","PRCLD1")
0^4^B9973418
"RTN","PRCLD1",1,0)
PRCLD1 ;WOIFO/DAC - Local Vendor (Main routine) - CoreFLS Data Cleansing ;1 May  11:16 AM
"RTN","PRCLD1",2,0)
 ;;5.1;IFCAP;**69**;Oct 20, 2000
"RTN","PRCLD1",3,0)
 ;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","PRCLD1",4,0)
 ;
"RTN","PRCLD1",5,0)
 ;NOTE: This routine is not callable from the top. Set variable 'BODY' (see option reader) and then call tag 'TOP'.
"RTN","PRCLD1",6,0)
 Q
"RTN","PRCLD1",7,0)
TOP ; Make sure no one else is currently compiling the list of vendors.
"RTN","PRCLD1",8,0)
 W !!
"RTN","PRCLD1",9,0)
 L +^XTMP("PRCLA"):1 E  D EN^DDIOL("Vendor compile in progress. Please try again later.",,"!!") G EXIT
"RTN","PRCLD1",10,0)
 L -^XTMP("PRCLA")
"RTN","PRCLD1",11,0)
 ; Make sure last compile completed successfully. Otherwise, do not allow user to print anything.
"RTN","PRCLD1",12,0)
 I '$D(^XTMP("PRCLA",0)),BODY]"" D EN^DDIOL("You must first run the vendor compile before printing any reports.",,"!!") G EXIT
"RTN","PRCLD1",13,0)
 ; Display date of last compile.
"RTN","PRCLD1",14,0)
 I $D(^XTMP("PRCLA",0)) D EN^DDIOL("Last vendor compile done on "_$$FMTE^XLFDT($P(^XTMP("PRCLA",0),U,2)),,"!!")
"RTN","PRCLD1",15,0)
 ; If this is a report, run it and exit.
"RTN","PRCLD1",16,0)
 I BODY]"" D DISP1 G EXIT
"RTN","PRCLD1",17,0)
 ; Otherwise, this is the 'compile' option.
"RTN","PRCLD1",18,0)
 D COMPILE^PRCLA1
"RTN","PRCLD1",19,0)
EXIT ; Make sure all the variables that weren't NEW'd get KILL'd. (Exception: ZT* variables are handled by TaskMan.)
"RTN","PRCLD1",20,0)
 K BODY,INS,VEND,DA,DIR,DIRUT,DTOUT,DUOUT,X,Y,%ZIS
"RTN","PRCLD1",21,0)
 Q
"RTN","PRCLD1",22,0)
DISP1 ; Ask the user if they wish to display some instructions with the report. 
"RTN","PRCLD1",23,0)
 S INS="N"
"RTN","PRCLD1",24,0)
 K DIR
"RTN","PRCLD1",25,0)
 S DIR(0)="YA",DIR("A")="Do you wish to also display the instructions? ",DIR("B")="YES"
"RTN","PRCLD1",26,0)
 S DIR("?")="Enter 'YES' to display a set of instructions before displaying the report."
"RTN","PRCLD1",27,0)
 D ^DIR K DIR
"RTN","PRCLD1",28,0)
 I Y["^"!$D(DTOUT)!$D(DUOUT) D EN^DDIOL("<Report Aborted> ",,"!!?10") Q
"RTN","PRCLD1",29,0)
 I Y S INS="Y"
"RTN","PRCLD1",30,0)
DISP2 ; Ask the user for a device to print to (queuing is allowed).
"RTN","PRCLD1",31,0)
 S %ZIS="Q"
"RTN","PRCLD1",32,0)
 D ^%ZIS Q:POP
"RTN","PRCLD1",33,0)
 I '$D(IO("Q")) G PRT
"RTN","PRCLD1",34,0)
 S ZTSAVE("BODY")="",ZTSAVE("INS")=""
"RTN","PRCLD1",35,0)
 S ZTRTN="PRT^PRCLA1",ZTDESC="CoreFLS Data Cleansing Report (File# 440 - VENDOR)"
"RTN","PRCLD1",36,0)
 D ^%ZTLOAD,HOME^%ZIS
"RTN","PRCLD1",37,0)
 K ZTSK
"RTN","PRCLD1",38,0)
 Q
"RTN","PRCLD1",39,0)
PRT ; Print the requested report.
"RTN","PRCLD1",40,0)
 U IO
"RTN","PRCLD1",41,0)
 N PRCLA,PRCLD1,PRCLD2,PRCLD3,PRCLD4,PRCLD5,PRCLD6,PRCLD6A,PRCLD7,PRCLD7A
"RTN","PRCLD1",42,0)
 N PRCLDX,PRCLDX1,PRCLDX2,PRCLERR,PRCLI,PRCLN,PRCLN1,PRCLDAMT,PRCLDBP
"RTN","PRCLD1",43,0)
 N PRCLDDT,PRCLDNM,PRCLDNUM,PRCLDPIN,PRCLDPO,PRCLDRP,PRCLSTAT
"RTN","PRCLD1",44,0)
 N PRCLDSTN,PRCLDVIN,HEAD,HEAD1,HDR,LASTPO,LASTPODT,M1,M2,MONTH12
"RTN","PRCLD1",45,0)
 N PODATE,PREVSTN,RPT,STNID,TTL1,TTL2,TRANC,TRANCA
"RTN","PRCLD1",46,0)
 S PRCLA=0,P=0,L=0,ABORT=0
"RTN","PRCLD1",47,0)
 D @BODY
"RTN","PRCLD1",48,0)
PRT1 ; Report completed
"RTN","PRCLD1",49,0)
 I 'ABORT W !,"<End of Report>" I $E(IOST,1,2)="C-" W " Enter RETURN to continue" R Y:DTIME
"RTN","PRCLD1",50,0)
 I ABORT W !,"<Report Aborted>"
"RTN","PRCLD1",51,0)
 D ^%ZISC
"RTN","PRCLD1",52,0)
 K L,P,X,Y,ABORT
"RTN","PRCLD1",53,0)
 I $D(ZTQUEUED) S ZTREQ="@"
"RTN","PRCLD1",54,0)
 Q
"RTN","PRCLD1",55,0)
HDR ; Print the standard report header.
"RTN","PRCLD1",56,0)
 ; Do not ask 'RETURN' before first page on CRT.
"RTN","PRCLD1",57,0)
 I $E(IOST,1,2)="C-",P R !,"Enter RETURN to continue or '^' to exit: ",Y:DTIME I '$T!(Y[U) S ABORT=1 Q
"RTN","PRCLD1",58,0)
 ; Do not print a form feed before first page on printer. Top of form is set at end of previous report.
"RTN","PRCLD1",59,0)
 I $E(IOST,1,2)="C-"!P W @IOF
"RTN","PRCLD1",60,0)
 S P=P+1,L=4
"RTN","PRCLD1",61,0)
 W $E("                              ",1,80-$L(HDR)/2),HDR ; Main report name
"RTN","PRCLD1",62,0)
 W !,"CoreFLS Data Cleansing Report (File# 440 - VENDOR)",?69,"Page: ",$J(P,4)
"RTN","PRCLD1",63,0)
 W !
"RTN","PRCLD1",64,0)
 I $G(HEAD1)]"" W "Vendor list compiled: ",$$FMTE^XLFDT($P(^XTMP("PRCLA",0),U,2))
"RTN","PRCLD1",65,0)
 W ?58,"Printed: ",$$FMTE^XLFDT(DT),!
"RTN","PRCLD1",66,0)
 I $G(HEAD)]"" D @HEAD ; Sub-header
"RTN","PRCLD1",67,0)
 Q
"RTN","PRCLD2")
0^5^B19647241
"RTN","PRCLD2",1,0)
PRCLD2 ;WOIFO/DAC - Local Vendor (Summary Reports)- CoreFLS Data Cleansing ;1 May 2003  11:16 AM
"RTN","PRCLD2",2,0)
 ;;5.1;IFCAP;**69**;Oct 20, 2000
"RTN","PRCLD2",3,0)
 ;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","PRCLD2",4,0)
 ;
"RTN","PRCLD2",5,0)
 ;NOTE: This routine is not callable from the top. Use TOP in PRCLD1.
"RTN","PRCLD2",6,0)
 Q
"RTN","PRCLD2",7,0)
LOOP2 ; Local Vendor Summary Report
"RTN","PRCLD2",8,0)
 S HDR="PURCHASE ORDERS TO LOCAL VENDORS - SUMMARY"
"RTN","PRCLD2",9,0)
 D INS^PRCLD3("TXT3","PRCLD3") Q:ABORT
"RTN","PRCLD2",10,0)
 K ^TMP("PRCLD2A",$J),^TMP("PRCLD2C",$J)
"RTN","PRCLD2",11,0)
 S RPT="2"
"RTN","PRCLD2",12,0)
 D LOOP1A
"RTN","PRCLD2",13,0)
 D SORT2
"RTN","PRCLD2",14,0)
 D OUT2
"RTN","PRCLD2",15,0)
 K ^TMP("PRCLD2A",$J),^TMP("PRCLD2C",$J)
"RTN","PRCLD2",16,0)
 Q
"RTN","PRCLD2",17,0)
 ;
"RTN","PRCLD2",18,0)
LOOP1A ; Local Vendor Summary (Used by Current and Previous Yr. Reports)
"RTN","PRCLD2",19,0)
 S PRCLDPO=""
"RTN","PRCLD2",20,0)
 ; Get closed statuses 
"RTN","PRCLD2",21,0)
 S TRANC=$O(^PRCD(442.3,"AC",40,0)) ; Transaction Complete
"RTN","PRCLD2",22,0)
 S TRANCA=$O(^PRCD(442.3,"AC",41,0)) ; Transaction Complete (Amended)
"RTN","PRCLD2",23,0)
 F  S PRCLDPO=$O(^XTMP("PRCLD",PRCLDPO)) Q:PRCLDPO=""  S PRCLDDT="" D  Q:ABORT 
"RTN","PRCLD2",24,0)
 . F  S PRCLDDT=$O(^XTMP("PRCLD",PRCLDPO,PRCLDDT)) Q:PRCLDDT=""  S PRCLDPIN=""  D  Q:ABORT
"RTN","PRCLD2",25,0)
 . . F  S PRCLDPIN=$O(^XTMP("PRCLD",PRCLDPO,PRCLDDT,PRCLDPIN)) Q:PRCLDPIN=""  D  Q:ABORT
"RTN","PRCLD2",26,0)
 . . . S PRCLN=$G(^XTMP("PRCLD",PRCLDPO,PRCLDDT,PRCLDPIN))
"RTN","PRCLD2",27,0)
 . . . S PRCLD5=$P(PRCLN,U,1) ; PO date
"RTN","PRCLD2",28,0)
 . . . ; Quit if vendor has FMS code(not local)
"RTN","PRCLD2",29,0)
 . . . S PRCLDVIN=$P(PRCLN,U,4)
"RTN","PRCLD2",30,0)
 . . . I $P($G(^PRC(440,PRCLDVIN,3)),U,4)'="" Q
"RTN","PRCLD2",31,0)
 . . . ; Do not process closed POs
"RTN","PRCLD2",32,0)
 . . . S PRCLSTAT=$P(PRCLN,U,2) ; Supply
"RTN","PRCLD2",33,0)
 . . . ; S PRCLSTAT=$P($G(^PRC(442,PRCLDPIN,7)),U,1)
"RTN","PRCLD2",34,0)
 . . . ; I (PRCLSTAT=TRANC)!(PRCLSTAT=TRANCA) Q
"RTN","PRCLD2",35,0)
 . . . ; Amount
"RTN","PRCLD2",36,0)
 . . . S PRCLDAMT=$P($G(^PRC(442,PRCLDPIN,0)),U,15)
"RTN","PRCLD2",37,0)
 . . . S PRCLDSTN=$$STN(PRCLDPO)
"RTN","PRCLD2",38,0)
 . . . S PRCLN1=$G(^TMP("PRCLD2A",$J,PRCLDSTN,PRCLDVIN))
"RTN","PRCLD2",39,0)
 . . . S TTL1=$P(PRCLN1,U,1),TTL2=$P(PRCLN1,U,2),PRCLDRP=""
"RTN","PRCLD2",40,0)
 . . . I RPT=2 S LASTPO=$P(PRCLN1,U,3),LASTPODT=$P(PRCLN1,U,4) S PRCLDRP=LASTPO_U_LASTPODT
"RTN","PRCLD2",41,0)
 . . . I (RPT=2),(PRCLDDT>LASTPODT) S PRCLDRP=PRCLDPO_U_PRCLDDT
"RTN","PRCLD2",42,0)
 . . . ; Sort by Station, Vendor IEN
"RTN","PRCLD2",43,0)
 . . . S ^TMP("PRCLD2A",$J,PRCLDSTN,PRCLDVIN)=(TTL1+1)_U_(TTL2+PRCLDAMT)_U_(PRCLDRP)
"RTN","PRCLD2",44,0)
 . . . Q
"RTN","PRCLD2",45,0)
 . . Q
"RTN","PRCLD2",46,0)
 . Q
"RTN","PRCLD2",47,0)
 Q
"RTN","PRCLD2",48,0)
SORT2 ; Sort for Current Year Summary Report Output 
"RTN","PRCLD2",49,0)
 S PRCLDSTN=""
"RTN","PRCLD2",50,0)
 F  S PRCLDSTN=$O(^TMP("PRCLD2A",$J,PRCLDSTN)) Q:PRCLDSTN=""  S PRCLDVIN="" D  Q:ABORT
"RTN","PRCLD2",51,0)
 . F  S PRCLDVIN=$O(^TMP("PRCLD2A",$J,PRCLDSTN,PRCLDVIN)) Q:PRCLDVIN=""  D  Q:ABORT
"RTN","PRCLD2",52,0)
 . . S PRCLN=^TMP("PRCLD2A",$J,PRCLDSTN,PRCLDVIN)
"RTN","PRCLD2",53,0)
 . . S PRCLDAMT=$P(PRCLN,U,2)
"RTN","PRCLD2",54,0)
 . . I PRCLDAMT'="" S ^TMP("PRCLD2C",$J,PRCLDSTN,PRCLDAMT,PRCLDVIN)=PRCLN
"RTN","PRCLD2",55,0)
 . . Q
"RTN","PRCLD2",56,0)
 . Q
"RTN","PRCLD2",57,0)
 Q
"RTN","PRCLD2",58,0)
 ;
"RTN","PRCLD2",59,0)
OUT2 ; Output portion of Summary Report
"RTN","PRCLD2",60,0)
 ; LOOP THRU ^TMP("PRCLD2C",$J,PRCLDSTN,PRCLDAMT,PRCLDVIN)
"RTN","PRCLD2",61,0)
 S PRCLDSTN=$O(^TMP("PRCLD2C",$J,""))
"RTN","PRCLD2",62,0)
 I PRCLDSTN="" S PRCLDSTN="No Stations to Report"
"RTN","PRCLD2",63,0)
 S HEAD="HDR3^PRCLD4"
"RTN","PRCLD2",64,0)
 D HDR^PRCLA1
"RTN","PRCLD2",65,0)
 S PREVSTN=PRCLDSTN,PRCLDSTN=""
"RTN","PRCLD2",66,0)
 F  S PRCLDSTN=$O(^TMP("PRCLD2C",$J,PRCLDSTN)) Q:PRCLDSTN=""  S PRCLDAMT="" D  Q:ABORT
"RTN","PRCLD2",67,0)
 . F  S PRCLDAMT=$O(^TMP("PRCLD2C",$J,PRCLDSTN,PRCLDAMT),-1) Q:PRCLDAMT=""  S PRCLDVIN="" D  Q:ABORT
"RTN","PRCLD2",68,0)
 . . F  S PRCLDVIN=$O(^TMP("PRCLD2C",$J,PRCLDSTN,PRCLDAMT,PRCLDVIN)) Q:PRCLDVIN=""  D  Q:ABORT
"RTN","PRCLD2",69,0)
 . . . S PRCLN=^TMP("PRCLD2C",$J,PRCLDSTN,PRCLDAMT,PRCLDVIN)
"RTN","PRCLD2",70,0)
 . . . S PRCLDNUM=$P(PRCLN,U,1),LASTPO=$P(PRCLN,U,3),PODATE=$P(PRCLN,U,4)
"RTN","PRCLD2",71,0)
 . . . I (L+4>IOSL)!(PRCLDSTN'=PREVSTN) W ! D HDR^PRCLA1 Q:ABORT
"RTN","PRCLD2",72,0)
 . . . S PRCLDNM=$P($G(^PRC(440,PRCLDVIN,0)),U,1)
"RTN","PRCLD2",73,0)
 . . . S PRCLDX=$$FMTE^XLFDT(PODATE,2) ; PO date
"RTN","PRCLD2",74,0)
 . . . S PRCLDX1=$P(PRCLDX,"/",1),PRCLDX2=$P(PRCLDX,"/",2)
"RTN","PRCLD2",75,0)
 . . . S PODATE=$S($L(PRCLDX1)=1:0_PRCLDX1,1:PRCLDX1)_$S($L(PRCLDX2)=1:0_PRCLDX2,1:PRCLDX2)_$P(PRCLDX,"/",3)
"RTN","PRCLD2",76,0)
 . . . D
"RTN","PRCLD2",77,0)
 . . . . N PRCLJ,PRCLOK,PRCLOK1,DISP,OPT,REQ
"RTN","PRCLD2",78,0)
 . . . . S PRCLERR="",REQ="  * Required field *"
"RTN","PRCLD2",79,0)
 . . . . S VEND="L",PRCLA=PRCLDVIN
"RTN","PRCLD2",80,0)
 . . . . F PRCLJ=1:1:13 S DISP(PRCLJ)="  * OK *"
"RTN","PRCLD2",81,0)
 . . . . D FISCAL^PRCLA2
"RTN","PRCLD2",82,0)
 . . . . F PRCLJ=1:1:13 I DISP(PRCLJ)'="  * OK *",DISP(PRCLJ)'="" S PRCLERR="YES" Q
"RTN","PRCLD2",83,0)
 . . . . I PRCLERR="YES" Q
"RTN","PRCLD2",84,0)
 . . . . F PRCLJ=1:1:16 S DISP(PRCLJ)="  * OK *"
"RTN","PRCLD2",85,0)
 . . . . D SUPPLY^PRCLA3
"RTN","PRCLD2",86,0)
 . . . . F PRCLJ=1:1:16 I DISP(PRCLJ)'="  * OK *",DISP(PRCLJ)'="" S PRCLERR="YES" Q
"RTN","PRCLD2",87,0)
 . . . . Q
"RTN","PRCLD2",88,0)
 . . . W !,$E(PRCLDNM,1,28),?29,$J(PRCLDVIN,10),?41,PRCLERR,?46,LASTPO,?57,PODATE,?64,$J(PRCLDNUM,5),?69,$J($$MONEY(PRCLDAMT),10)
"RTN","PRCLD2",89,0)
 . . . S L=L+1,PREVSTN=PRCLDSTN
"RTN","PRCLD2",90,0)
 . . . Q
"RTN","PRCLD2",91,0)
 . . Q
"RTN","PRCLD2",92,0)
 . Q
"RTN","PRCLD2",93,0)
 W !
"RTN","PRCLD2",94,0)
 Q
"RTN","PRCLD2",95,0)
 ;
"RTN","PRCLD2",96,0)
STN(PONUM) ;Returns Station ID
"RTN","PRCLD2",97,0)
 ; Input PO Number (ex. 999-12345)
"RTN","PRCLD2",98,0)
 ; Output Station ID (ex 999)
"RTN","PRCLD2",99,0)
 S STNID=$P(PONUM,"-",1)
"RTN","PRCLD2",100,0)
 Q STNID
"RTN","PRCLD2",101,0)
 ;
"RTN","PRCLD2",102,0)
MONEY(M) ;Returns Currency Format
"RTN","PRCLD2",103,0)
 I M'["." S M=M_"."
"RTN","PRCLD2",104,0)
 S M2=$P(M,".",2),M1=$P(M,".",1)
"RTN","PRCLD2",105,0)
 S M2=$E(M2,1,2)
"RTN","PRCLD2",106,0)
 I M1="" S M1=0
"RTN","PRCLD2",107,0)
 I $L(M2)<2 S M2=M2_"0" I $L(M2)<2 S M2=M2_"0"
"RTN","PRCLD2",108,0)
 S M=M1_"."_M2
"RTN","PRCLD2",109,0)
 Q M
"RTN","PRCLD2",110,0)
 ;
"RTN","PRCLD3")
0^6^B22890339
"RTN","PRCLD3",1,0)
PRCLD3 ;WOIFO/DAC - Local Vendor (Instructions) - CoreFLS Data Cleansing ;1 May 2003  11:16 AM
"RTN","PRCLD3",2,0)
 ;;5.1;IFCAP;**69**;Oct 20, 2000
"RTN","PRCLD3",3,0)
 ;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","PRCLD3",4,0)
 ;
"RTN","PRCLD3",5,0)
 ;NOTE: This routine is not callable from the top. Use TOP in PRCLD1.
"RTN","PRCLD3",6,0)
 Q
"RTN","PRCLD3",7,0)
INS(TAG,RTN) ; Print Data Cleansing 'instructions/notes' (max 75 columns per line).
"RTN","PRCLD3",8,0)
 I INS'="Y" S HEAD1=1 Q
"RTN","PRCLD3",9,0)
 S HDR="INSTRUCTIONS FOR "_HDR
"RTN","PRCLD3",10,0)
 D HDR^PRCLA1
"RTN","PRCLD3",11,0)
 F PRCLI=1:1 S @("PRCLN=$T("_TAG_"+"_PRCLI_"^"_RTN_")"),PRCLN=$P(PRCLN,";;",2,999) Q:PRCLN="**END**"  D:L+3>IOSL HDR^PRCLA1 Q:ABORT  W !,PRCLN S L=L+1
"RTN","PRCLD3",12,0)
 Q:ABORT
"RTN","PRCLD3",13,0)
 ; Must have a page break between instructions and report, but don't want to do a full header.
"RTN","PRCLD3",14,0)
 W !!,"<End of Instructions>"
"RTN","PRCLD3",15,0)
 ; Do not ask 'RETURN' before first page on CRT.
"RTN","PRCLD3",16,0)
 I $E(IOST,1,2)="C-",P R " Enter RETURN to continue or '^' to exit: ",Y:DTIME I '$T!(Y[U) S ABORT=1 Q
"RTN","PRCLD3",17,0)
 ; Do not print a form feed before first page on printer. Top of form is set at end of previous report.
"RTN","PRCLD3",18,0)
 I $E(IOST,1,2)="C-"!P W @IOF
"RTN","PRCLD3",19,0)
 S HDR=$P(HDR," ",3,$L(HDR," ")),HEAD1=1,P=0,L=0 ; Reset header and page and line number indicators for main report
"RTN","PRCLD3",20,0)
 Q
"RTN","PRCLD3",21,0)
TXT1 ; ===========================================================================
"RTN","PRCLD3",22,0)
 ;;The following instructions/notes refer to the CoreFLS Data Cleansing
"RTN","PRCLD3",23,0)
 ;;Open Purchase Orders to Local Vendors--Detail report.
"RTN","PRCLD3",24,0)
 ;;
"RTN","PRCLD3",25,0)
 ;;The report enables the review of recent local vendor (no FMS code)
"RTN","PRCLD3",26,0)
 ;;purchase orders in IFCAP that still have a supply status indicating the 
"RTN","PRCLD3",27,0)
 ;;order has not been closed.  The report displays open POs created
"RTN","PRCLD3",28,0)
 ;;within the last 12 months.
"RTN","PRCLD3",29,0)
 ;;
"RTN","PRCLD3",30,0)
 ;;Use this report to determine which purchase orders should be completed, 
"RTN","PRCLD3",31,0)
 ;;cancelled, etc., and which should remain open.  
"RTN","PRCLD3",32,0)
 ;;
"RTN","PRCLD3",33,0)
 ;;The following FIELD DESCRIPTIONS list details for each header abbreviation,
"RTN","PRCLD3",34,0)
 ;;the file number, and the field name and number.  Consult the help text for 
"RTN","PRCLD3",35,0)
 ;;each field in the VistA system for further information.
"RTN","PRCLD3",36,0)
 ;;
"RTN","PRCLD3",37,0)
 ;;FIELD DESCRIPTIONS
"RTN","PRCLD3",38,0)
 ;;===========================================================================
"RTN","PRCLD3",39,0)
 ;;
"RTN","PRCLD3",40,0)
 ;;PO NUM             [PURCHASE ORDER NUMBER         (File 442 Field .01)   ]
"RTN","PRCLD3",41,0)
 ;;
"RTN","PRCLD3",42,0)
 ;;BUYER              [PA/PPM/AUTHORIZED BUYER       (File 442 Field 16)    ]
"RTN","PRCLD3",43,0)
 ;;      PA/PPM/AUTHORIZED BUYER is an entry in the NEW PERSON file (#200)
"RTN","PRCLD3",44,0)
 ;;       
"RTN","PRCLD3",45,0)
 ;;VENDOR             [VENDOR                        (File 442 Field 5)     ]  
"RTN","PRCLD3",46,0)
 ;;      VENDOR is an entry in the VENDOR file (#440)
"RTN","PRCLD3",47,0)
 ;;
"RTN","PRCLD3",48,0)
 ;;AMOUNT             [TOTAL AMOUNT                  (File 442 Field 91)    ]
"RTN","PRCLD3",49,0)
 ;;
"RTN","PRCLD3",50,0)
 ;;DATE               [P.O. DATE                     (File 442 Field .1)    ]
"RTN","PRCLD3",51,0)
 ;;
"RTN","PRCLD3",52,0)
 ;;SUP-STATUS         [SUPPLY STATUS                 (File 442 Field .5)    ]
"RTN","PRCLD3",53,0)
 ;;      SUPPLY STATUS is an entry in the PURCHASE ORDER STATUS file (#442.3)
"RTN","PRCLD3",54,0)
 ;;
"RTN","PRCLD3",55,0)
 ;;PROC-METHOD        [METHOD OF PROCESSING          (File 442 Field .02)   ]
"RTN","PRCLD3",56,0)
 ;;      METHOD OF PROCESSING is an entry in the PAT TYPE file (#442.5)
"RTN","PRCLD3",57,0)
 ;;
"RTN","PRCLD3",58,0)
 ;;**END**
"RTN","PRCLD3",59,0)
TXT3 ; ===========================================================================
"RTN","PRCLD3",60,0)
 ;;The following instructions/notes refer to the CoreFLS Data Cleansing
"RTN","PRCLD3",61,0)
 ;;Purchase Orders to Local Vendors--Summary report. 
"RTN","PRCLD3",62,0)
 ;;
"RTN","PRCLD3",63,0)
 ;;The report shows all local vendors with recent PO activity that should
"RTN","PRCLD3",64,0)
 ;;be considered for vendorization through FMS. The report displays open 
"RTN","PRCLD3",65,0)
 ;;and closed POs created within the last 24 months. 
"RTN","PRCLD3",66,0)
 ;;
"RTN","PRCLD3",67,0)
 ;;It displays the volume of purchasing activity in terms of number of orders 
"RTN","PRCLD3",68,0)
 ;;and total dollar value of orders. The data is sorted by total dollar volume.  
"RTN","PRCLD3",69,0)
 ;;
"RTN","PRCLD3",70,0)
 ;;The following FIELD DESCRIPTIONS list details for each header abbreviation,
"RTN","PRCLD3",71,0)
 ;;the file number, and the field name and number.  Consult the help text for 
"RTN","PRCLD3",72,0)
 ;;each field in the VistA system for further information.
"RTN","PRCLD3",73,0)
 ;;
"RTN","PRCLD3",74,0)
 ;;FIELD DESCRIPTIONS
"RTN","PRCLD3",75,0)
 ;;===========================================================================
"RTN","PRCLD3",76,0)
 ;;VENDOR NAME        [NAME                          (File 440 Field .01)   ]
"RTN","PRCLD3",77,0)
 ;;
"RTN","PRCLD3",78,0)
 ;;VENDOR IEN         [VENDOR IEN                    (File 440)             ]
"RTN","PRCLD3",79,0)
 ;;
"RTN","PRCLD3",80,0)
 ;;ISSUE              Displays 'YES' if this vendor also has a problem reported
"RTN","PRCLD3",81,0)
 ;;                   on either the Fiscal or Supply vendor detail reports.
"RTN","PRCLD3",82,0)
 ;;
"RTN","PRCLD3",83,0)
 ;;LAST PO TRANS      [PURCHASE ORDER NUMBER         (File 442 Field .01    ]
"RTN","PRCLD3",84,0)
 ;;
"RTN","PRCLD3",85,0)
 ;;DATE OF PO         [P.O. DATE                     (File 442 Field .1)    ]
"RTN","PRCLD3",86,0)
 ;;
"RTN","PRCLD3",87,0)
 ;;# OF POS           Total number of POs selected
"RTN","PRCLD3",88,0)
 ;;
"RTN","PRCLD3",89,0)
 ;;TOTAL $ OF POS     [TOTAL AMOUNT                  (File 442 Field 91)    ]
"RTN","PRCLD3",90,0)
 ;;
"RTN","PRCLD3",91,0)
 ;;**END**
"RTN","PRCLD4")
0^7^B1268446
"RTN","PRCLD4",1,0)
PRCLD4 ;WOIFO/DAC - Local Vendor (Report Headers) - CoreFLS Data Cleansing ;1 May 2003  11:18 AM
"RTN","PRCLD4",2,0)
 ;;5.1;IFCAP;**69**;Oct 20, 2000
"RTN","PRCLD4",3,0)
 ;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","PRCLD4",4,0)
 ;
"RTN","PRCLD4",5,0)
 ;NOTE: This routine is not callable from the top. Use TOP in PRCLD1.
"RTN","PRCLD4",6,0)
 Q
"RTN","PRCLD4",7,0)
HDR1 ; Header for Detailed Summary Report (Local Vendor)
"RTN","PRCLD4",8,0)
 W !,?32,"FOR STATION ",PRCLDSTN
"RTN","PRCLD4",9,0)
 W !
"RTN","PRCLD4",10,0)
 W !,"PO NUM",?11,"BUYER",?17,"VENDOR",?36,"AMOUNT",?43,"DATE",?50,"SUP-STATUS",?68,"PROC-METHOD"
"RTN","PRCLD4",11,0)
 S L=L+3
"RTN","PRCLD4",12,0)
 Q
"RTN","PRCLD4",13,0)
 ;
"RTN","PRCLD4",14,0)
HDR3 ; Header for Summary Report (Local Vendor)
"RTN","PRCLD4",15,0)
 W !,?32,"FOR STATION ",PRCLDSTN
"RTN","PRCLD4",16,0)
 W !
"RTN","PRCLD4",17,0)
 W !,"                                                 LAST PO   DATE  # OF   TOTAL $"
"RTN","PRCLD4",18,0)
 W !,"VENDOR NAME                  VENDOR IEN ISSUE      TRANS  OF PO   POS    OF POS"
"RTN","PRCLD4",19,0)
 W !,"---------------------------- ---------- ----- ---------- ------ ----- ---------"
"RTN","PRCLD4",20,0)
 S L=L+5
"RTN","PRCLD4",21,0)
 Q
"RTN","PRCLD4",22,0)
 ;
"RTN","PRCLD5")
0^8^B12301070
"RTN","PRCLD5",1,0)
PRCLD5 ;WOIFO/DAC - Local Vendor (Detailed Reports) - CoreFLS Data Cleansing ;1 May 2003  11:16 AM
"RTN","PRCLD5",2,0)
 ;;5.1;IFCAP;**69**;Oct 20, 2000
"RTN","PRCLD5",3,0)
 ;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","PRCLD5",4,0)
 ;
"RTN","PRCLD5",5,0)
 ;NOTE: This routine is not callable from the top. Use TOP in PRCLD1.
"RTN","PRCLD5",6,0)
 Q
"RTN","PRCLD5",7,0)
RPT ; Detailed Local Vendor Report
"RTN","PRCLD5",8,0)
 K ^TMP("PRCLD2D",$J)
"RTN","PRCLD5",9,0)
 S HDR="OPEN PURCHASE ORDERS TO LOCAL VENDORS - DETAIL"
"RTN","PRCLD5",10,0)
 D INS^PRCLD3("TXT1","PRCLD3") Q:ABORT
"RTN","PRCLD5",11,0)
 S HEAD="HDR1^PRCLD4"
"RTN","PRCLD5",12,0)
 S PRCLDPO="",PRCLDDT="",PRCLDPIN="",PREVSTN=""
"RTN","PRCLD5",13,0)
 S MONTH12=$$FMADD^XLFDT(^XTMP("PRCLDDT",1),-365)
"RTN","PRCLD5",14,0)
 ; Sort by station, PO date, PO IEN
"RTN","PRCLD5",15,0)
 F  S PRCLDPO=$O(^XTMP("PRCLD",PRCLDPO)) Q:PRCLDPO=""  S PRCLDDT="" D  Q:ABORT
"RTN","PRCLD5",16,0)
 . F  S PRCLDDT=$O(^XTMP("PRCLD",PRCLDPO,PRCLDDT)) Q:PRCLDDT=""  S PRCLDPIN="" D  Q:ABORT
"RTN","PRCLD5",17,0)
 . . ; If PO is older than 12 months from user selected deploy date quit
"RTN","PRCLD5",18,0)
 . . I PRCLDDT<MONTH12 Q
"RTN","PRCLD5",19,0)
 . . F  S PRCLDPIN=$O(^XTMP("PRCLD",PRCLDPO,PRCLDDT,PRCLDPIN)) Q:PRCLDPIN=""  D  Q:ABORT
"RTN","PRCLD5",20,0)
 . . . S PRCLDSTN=$$STN^PRCLD2(PRCLDPO)
"RTN","PRCLD5",21,0)
 . . . S ^TMP("PRCLD2D",$J,PRCLDSTN,PRCLDDT,PRCLDPIN)=^XTMP("PRCLD",PRCLDPO,PRCLDDT,PRCLDPIN)_U_PRCLDPO
"RTN","PRCLD5",22,0)
 . . . Q
"RTN","PRCLD5",23,0)
 . . Q
"RTN","PRCLD5",24,0)
 . Q
"RTN","PRCLD5",25,0)
 S PRCLDSTN=""
"RTN","PRCLD5",26,0)
 ; Get closed statuses 
"RTN","PRCLD5",27,0)
 S TRANC=$O(^PRCD(442.3,"AC",40,0)) ; Transaction Complete
"RTN","PRCLD5",28,0)
 S TRANCA=$O(^PRCD(442.3,"AC",41,0)) ; Transaction Complete (Amended)
"RTN","PRCLD5",29,0)
 F  S PRCLDSTN=$O(^TMP("PRCLD2D",$J,PRCLDSTN)) Q:PRCLDSTN=""  S PRCLDDT="" D  Q:ABORT
"RTN","PRCLD5",30,0)
 . F  S PRCLDDT=$O(^TMP("PRCLD2D",$J,PRCLDSTN,PRCLDDT),-1) Q:PRCLDDT=""  S PRCLDPIN="" D  Q:ABORT
"RTN","PRCLD5",31,0)
 . . F  S PRCLDPIN=$O(^TMP("PRCLD2D",$J,PRCLDSTN,PRCLDDT,PRCLDPIN)) Q:PRCLDPIN=""  D  Q:ABORT
"RTN","PRCLD5",32,0)
 . . . D:L+1>IOSL HDR^PRCLA1 Q:ABORT
"RTN","PRCLD5",33,0)
 . . . S PRCLN=$G(^TMP("PRCLD2D",$J,PRCLDSTN,PRCLDDT,PRCLDPIN))
"RTN","PRCLD5",34,0)
 . . . ; Quit if vendor has FMS code(not local)
"RTN","PRCLD5",35,0)
 . . . S PRCLDVIN=$P(PRCLN,U,4)
"RTN","PRCLD5",36,0)
 . . . I $P($G(^PRC(440,PRCLDVIN,3)),U,4)'="" Q
"RTN","PRCLD5",37,0)
 . . . ; Do not process closed POs
"RTN","PRCLD5",38,0)
 . . . S PRCLD6=$P(PRCLN,U,2) ; Supply
"RTN","PRCLD5",39,0)
 . . . ; S PRCLSTAT=$P($G(^PRC(442,PRCLDPIN,7)),U,1)
"RTN","PRCLD5",40,0)
 . . . I (PRCLD6=TRANC)!(PRCLD6=TRANCA) Q
"RTN","PRCLD5",41,0)
 . . . S PRCLDX=$$FMTE^XLFDT(PRCLDDT,2) ; PO date
"RTN","PRCLD5",42,0)
 . . . S PRCLDX1=$P(PRCLDX,"/",1),PRCLDX2=$P(PRCLDX,"/",2)
"RTN","PRCLD5",43,0)
 . . . S PRCLD5=$S($L(PRCLDX1)=1:0_PRCLDX1,1:PRCLDX1)_$S($L(PRCLDX2)=1:0_PRCLDX2,1:PRCLDX2)_$P(PRCLDX,"/",3)
"RTN","PRCLD5",44,0)
 . . . S PRCLDPO=$P(PRCLN,U,5)
"RTN","PRCLD5",45,0)
 . . . ; S PRCLD6=$P(PRCLN,U,2) ; Supply
"RTN","PRCLD5",46,0)
 . . . S PRCLD7=$P(PRCLN,U,3) ; Method
"RTN","PRCLD5",47,0)
 . . . ; Buyer Pointer
"RTN","PRCLD5",48,0)
 . . . S PRCLDBP=$P($G(^PRC(442,PRCLDPIN,1)),U,10)
"RTN","PRCLD5",49,0)
 . . . ; Buyer Name
"RTN","PRCLD5",50,0)
 . . . S PRCLD2="",PRCLD6A="",PRCLD7A=""
"RTN","PRCLD5",51,0)
 . . . I PRCLDBP'="" S PRCLD2=$P($G(^VA(200,PRCLDBP,0)),U,1)
"RTN","PRCLD5",52,0)
 . . . ; Vendor Name
"RTN","PRCLD5",53,0)
 . . . S PRCLD3=$P($G(^PRC(440,PRCLDVIN,0)),U,1)
"RTN","PRCLD5",54,0)
 . . . ; Amount
"RTN","PRCLD5",55,0)
 . . . S PRCLD4=$P($G(^PRC(442,PRCLDPIN,0)),U,15)
"RTN","PRCLD5",56,0)
 . . . ; Get Supply Status
"RTN","PRCLD5",57,0)
 . . . I PRCLD6'="" S PRCLD6A=$P($G(^PRCD(442.3,PRCLD6,0)),U,1)
"RTN","PRCLD5",58,0)
 . . . ; 3 Letter Method Abbreviation
"RTN","PRCLD5",59,0)
 . . . I PRCLD7'="" S PRCLD7A=$P($G(^PRCD(442.5,PRCLD7,0)),U,2)
"RTN","PRCLD5",60,0)
 . . . ; Print Header if change in station or new page
"RTN","PRCLD5",61,0)
 . . . I (L+4>IOSL)!(PRCLDSTN'=PREVSTN) W ! D HDR^PRCLA1 Q:ABORT
"RTN","PRCLD5",62,0)
 . . . S PREVSTN=PRCLDSTN
"RTN","PRCLD5",63,0)
 . . . W !,$E(PRCLDPO,1,10),?11,$E(PRCLD2,1,5),?17,$E(PRCLD3,1,16),?34,$J($$MONEY^PRCLD2(PRCLD4),8),?43,PRCLD5,?50,$E(PRCLD6A,1,24),?76,PRCLD7A S L=L+1
"RTN","PRCLD5",64,0)
 . . . Q
"RTN","PRCLD5",65,0)
 . . Q
"RTN","PRCLD5",66,0)
 . Q
"RTN","PRCLD5",67,0)
 W !
"RTN","PRCLD5",68,0)
 K ^TMP("PRCLD2D",$J)
"RTN","PRCLD5",69,0)
 Q
"VER")
8.0^22.0
**END**
**END**
