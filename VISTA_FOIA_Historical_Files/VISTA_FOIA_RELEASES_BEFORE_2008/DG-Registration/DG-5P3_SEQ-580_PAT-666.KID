Released DG*5.3*666 SEQ #580
Extracted from mail message
**KIDS**:DG*5.3*666^

**INSTALL NAME**
DG*5.3*666
"BLD",6194,0)
DG*5.3*666^REGISTRATION^0^3050722^y
"BLD",6194,4,0)
^9.64PA^^
"BLD",6194,"KRN",0)
^9.67PA^8989.52^19
"BLD",6194,"KRN",.4,0)
.4
"BLD",6194,"KRN",.4,"NM",0)
^9.68A^2^2
"BLD",6194,"KRN",.4,"NM",1,0)
DG ISO SENSITIVE RCDS PRT    FILE #38.1^38.1^0
"BLD",6194,"KRN",.4,"NM",2,0)
DG ISO SENSITIVE RCDS PRT1    FILE #38.1^38.1^0
"BLD",6194,"KRN",.4,"NM","B","DG ISO SENSITIVE RCDS PRT    FILE #38.1",1)

"BLD",6194,"KRN",.4,"NM","B","DG ISO SENSITIVE RCDS PRT1    FILE #38.1",2)

"BLD",6194,"KRN",.401,0)
.401
"BLD",6194,"KRN",.401,"NM",0)
^9.68A^1^1
"BLD",6194,"KRN",.401,"NM",1,0)
DG ISO SENSITIVE RCDS SORT    FILE #38.1^38.1^0
"BLD",6194,"KRN",.401,"NM","B","DG ISO SENSITIVE RCDS SORT    FILE #38.1",1)

"BLD",6194,"KRN",.402,0)
.402
"BLD",6194,"KRN",.402,"NM",0)
^9.68A^^
"BLD",6194,"KRN",.403,0)
.403
"BLD",6194,"KRN",.5,0)
.5
"BLD",6194,"KRN",.84,0)
.84
"BLD",6194,"KRN",3.6,0)
3.6
"BLD",6194,"KRN",3.8,0)
3.8
"BLD",6194,"KRN",3.8,"NM",0)
^9.68A^1^1
"BLD",6194,"KRN",3.8,"NM",1,0)
DG ISO SENSITIVE RCDS^^0
"BLD",6194,"KRN",3.8,"NM","B","DG ISO SENSITIVE RCDS",1)

"BLD",6194,"KRN",9.2,0)
9.2
"BLD",6194,"KRN",9.8,0)
9.8
"BLD",6194,"KRN",9.8,"NM",0)
^9.68A^1^1
"BLD",6194,"KRN",9.8,"NM",1,0)
DGISORPT^^0^B8188646
"BLD",6194,"KRN",9.8,"NM","B","DGISORPT",1)

"BLD",6194,"KRN",19,0)
19
"BLD",6194,"KRN",19,"NM",0)
^9.68A^5^4
"BLD",6194,"KRN",19,"NM",1,0)
DG SECURITY OFFICER MENU^^2
"BLD",6194,"KRN",19,"NM",3,0)
DG SENSITIVE RCDS RPT-TASK^^0
"BLD",6194,"KRN",19,"NM",4,0)
DG SENSITIVE RCDS RPT-EXPORT^^0
"BLD",6194,"KRN",19,"NM",5,0)
DG SENSITIVE RCDS RPT-FORMAT^^0
"BLD",6194,"KRN",19,"NM","B","DG SECURITY OFFICER MENU",1)

"BLD",6194,"KRN",19,"NM","B","DG SENSITIVE RCDS RPT-EXPORT",4)

"BLD",6194,"KRN",19,"NM","B","DG SENSITIVE RCDS RPT-FORMAT",5)

"BLD",6194,"KRN",19,"NM","B","DG SENSITIVE RCDS RPT-TASK",3)

"BLD",6194,"KRN",19.1,0)
19.1
"BLD",6194,"KRN",19.1,"NM",0)
^9.68A^^
"BLD",6194,"KRN",101,0)
101
"BLD",6194,"KRN",409.61,0)
409.61
"BLD",6194,"KRN",771,0)
771
"BLD",6194,"KRN",870,0)
870
"BLD",6194,"KRN",8989.51,0)
8989.51
"BLD",6194,"KRN",8989.52,0)
8989.52
"BLD",6194,"KRN",8994,0)
8994
"BLD",6194,"KRN","B",.4,.4)

"BLD",6194,"KRN","B",.401,.401)

"BLD",6194,"KRN","B",.402,.402)

"BLD",6194,"KRN","B",.403,.403)

"BLD",6194,"KRN","B",.5,.5)

"BLD",6194,"KRN","B",.84,.84)

"BLD",6194,"KRN","B",3.6,3.6)

"BLD",6194,"KRN","B",3.8,3.8)

"BLD",6194,"KRN","B",9.2,9.2)

"BLD",6194,"KRN","B",9.8,9.8)

"BLD",6194,"KRN","B",19,19)

"BLD",6194,"KRN","B",19.1,19.1)

"BLD",6194,"KRN","B",101,101)

"BLD",6194,"KRN","B",409.61,409.61)

"BLD",6194,"KRN","B",771,771)

"BLD",6194,"KRN","B",870,870)

"BLD",6194,"KRN","B",8989.51,8989.51)

"BLD",6194,"KRN","B",8989.52,8989.52)

"BLD",6194,"KRN","B",8994,8994)

"BLD",6194,"QUES",0)
^9.62^^
"KRN",.4,2747,-1)
0^1
"KRN",.4,2747,0)
DG ISO SENSITIVE RCDS PRT^3050722.1544^^38.1^^^3050722
"KRN",.4,2747,"DXS",1,9)
X DXS(1,9.2) S DIP(6)=$G(X) S X=2,X=$P(DIP(5),DIP(6),X)_"0000",DIP(7)=$G(X) S X=1,DIP(8)=$G(X) S X=4,X=$E(DIP(7),DIP(8),X) S Y=X,X=DIP(1),X=X_Y
"KRN",.4,2747,"DXS",1,9.2)
S DIP(4)=$S($D(^DGSL(38.1,D0,"D",D1,0)):^(0),1:"") S X="@",DIP(1)=$G(X),DIP(2)=$G(X),DIP(3)=$G(X) S X=$P(DIP(4),U,1),X=X S X=X,DIP(5)=$G(X) S X="."
"KRN",.4,2747,"DXS",2,9.2)
F D=0:0 S (D,D1)=$O(^VA(200,D0,3,"B",DICOB,D)) Q:D'>0  I $D(^VA(200,D0,3,D,0))#2 S X=$P(^(0),U) S Y=X S:Y'?." " DIP(101)=Y Q:'$D(D)  S D=D1
"KRN",.4,2747,"DXS",2,9.3)
S I(101)="""3""",J(101)=200.04 N DICOB S DICOB="" F  S DICOB=$O(^VA(200,D0,3,"B",DICOB)) Q:DICOB=""   X DXS(2,9.2) Q:'$D(D)
"KRN",.4,2747,"DXS",2,9.4)
S I(101,0)=$G(D1) X DXS(2,9.3):D0>0 S X="" S D1=I(101,0)
"KRN",.4,2747,"F",1)
D HEADER^DGISORPT;Z;"D HEADER^DGISORPT"~
"KRN",.4,2747,"F",2)
S DIP(1)=$S($D(^DGSL(38.1,D0,0)):^(0),1:"") S X=$P($G(^DPT(+$P(DIP(1),U,1),0)),U)_"^" W X K DIP;L30;" ";C1;Z;"PATIENT NAME_"^""~
"KRN",.4,2747,"F",3)
50,S DIP(1)=$S($D(^DGSL(38.1,D0,"D",D1,0)):^(0),1:"") S X=$P(DIP(1),U,1) S:X X=$E(X,4,5)_"/"_$E(X,6,7)_"/"_$E(X,2,3) W X K DIP;X;Z;"NUMDATE(DATE/TIME RECORD ACCESSED)"~
"KRN",.4,2747,"F",4)
50,X DXS(1,9) W X K DIP;X;Z;""@"_$E($P(INTERNAL(DATE/TIME RECORD ACCESSED),".",2)_"0000",1,4)"~50,"^";X~50,2;X;L20~50,"^";X~
"KRN",.4,2747,"F",5)
50,-200,^VA(200,^^S I(1,0)=D1 S I(0,0)=D0 S DIP(1)=$S($D(^DGSL(38.1,D0,"D",D1,0)):^(0),1:"") S X=$P(DIP(1),U,2),X=X S D(0)=+X;Z;"2:"~50,-200,8;X~50,-200,"^";X~
"KRN",.4,2747,"F",6)
50,-200,S DIP(101)="" X DXS(2,9.4) S X=DIP(101) W X K DIP;X;L5;Z;"LAST(ALIAS)"~50,-200,"^";X~50,-200,29;X;L20~50,-200,"^";X~50,3;X~50,"^";X~50,4;X;L1~
"KRN",.4,2747,"H")
@
"KRN",.4,2747,"SUB")
1
"KRN",.4,2749,-1)
0^2
"KRN",.4,2749,0)
DG ISO SENSITIVE RCDS PRT1^3050707.1439^^38.1^^^3050707
"KRN",.4,2749,"DXS",1,9)
X DXS(1,9.2) S X=$E($P(X,".",2)_"0000",1,4),%=X>1159 S:X>1259 X=X-1200 S X=X\100_":"_$E(X#100+100,2,3)_" "_$E("AP",%+1)_"M" S Y=X,X=DIP(2),X=X S X=X_Y
"KRN",.4,2749,"DXS",1,9.2)
S DIP(1)=$S($D(^DGSL(38.1,D0,"D",D1,0)):^(0),1:"") S X=$P(DIP(1),U,1) S:X X=$E(X,4,5)_"/"_$E(X,6,7)_"/"_$E(X,2,3) S X=X_"@",DIP(2)=$G(X) S X=$P(DIP(1),U,1)
"KRN",.4,2749,"F",1)
.01;L20~50,X DXS(1,9) W X K DIP;C24;"DT/TM ACCESSED";Z;"NUMDATE(DATE/TIM)_"@"_TIME(DATE/TIME)"~50,2;L20;C47~
"KRN",.4,2749,"F",2)
50,-200,^VA(200,^^S I(1,0)=D1 S I(0,0)=D0 S DIP(1)=$S($D(^DGSL(38.1,D0,"D",D1,0)):^(0),1:"") S X=$P(DIP(1),U,2),X=X S D(0)=+X;Z;"2:"~50,-200,8;L20;C70~
"KRN",.4,2749,"F",3)
50,3;L30;C93~50,4;C125;"INPAT WHEN ACCESSED"~
"KRN",.4,2749,"H")
Sensitive Records Accessed
"KRN",.401,2067,-1)
0^1
"KRN",.401,2067,0)
DG ISO SENSITIVE RCDS SORT^3040810.1248^^38.1^^^3050722
"KRN",.401,2067,2,0)
^.4014^2^2
"KRN",.401,2067,2,1,0)
38.11^.01^DATE/TIME RECORD ACCESSED^]@@^^^^^^1
"KRN",.401,2067,2,1,1,0)
^.40141^1^1
"KRN",.401,2067,2,1,1,1,0)
38.1^D
"KRN",.401,2067,2,1,1,"B",38.1,1)

"KRN",.401,2067,2,1,"ASK")
1
"KRN",.401,2067,2,1,"F")
3050516.999999^May 17,2005^May 17,2005
"KRN",.401,2067,2,1,"GET")
S DISX(1)=$P($G(^DGSL(38.1,D0,"D",D1,0)),U)
"KRN",.401,2067,2,1,"QCON")
I (DISX(1)]]3050516.999999)&(DISX(1)']]3050517.24)
"KRN",.401,2067,2,1,"T")
3050517.24^May 17,2005@2400^May 17,2005@24:00
"KRN",.401,2067,2,1,"TXT")
DATE/TIME RECORD ACCESSED from May 17,2005 to May 17,2005@24:00
"KRN",.401,2067,2,2,0)
38.1^^PATIENT NAME^@".01^^^^^^4
"KRN",.401,2067,2,2,"CM")
S Y(1)=$S($D(^DGSL(38.1,D0,0)):^(0),1:"") S X=$P($G(^DPT(+$P(Y(1),U,1),0)),U) I D0>0 S DISX(2)=X
"KRN",.401,2067,2,2,"GET")
S Y(1)=$S($D(^DGSL(38.1,D0,0)):^(0),1:"") S X=$P($G(^DPT(+$P(Y(1),U,1),0)),U) I D0>0 S DISX(2)=X
"KRN",.401,2067,2,2,"IX")
^DGSL(38.1,"B",^DGSL(38.1,^2
"KRN",.401,2067,2,2,"PTRIX")
^DPT("B",
"KRN",.401,2067,2,2,"QCON")
I DISX(2)'=""
"KRN",.401,2067,2,2,"SER")
0.0198^0.0198
"KRN",.401,2067,2,2,"TXT")
PATIENT NAME not null
"KRN",.401,2067,2,"B",38.1,2)

"KRN",.401,2067,2,"B",38.11,1)

"KRN",.401,2067,"%D",0)
^^1^1^3040810^
"KRN",.401,2067,"%D",1,0)
Used with the option AXVISO Sensitive Rcds Rpt-Man
"KRN",3.8,6169,-1)
0^1
"KRN",3.8,6169,0)
DG ISO SENSITIVE RCDS^PU^n^^^0^
"KRN",3.8,6169,2,0)
^^2^2^3050620^
"KRN",3.8,6169,2,1,0)
This mail group is used by the DG SENSITIVE RCDS RPT-FORMAT and 
"KRN",3.8,6169,2,2,0)
DG SENSITIVE RCDS RPT-TASK options.
"KRN",3.8,6169,3)

"KRN",19,1138,-1)
2^1
"KRN",19,1138,0)
DG SECURITY OFFICER MENU^Security Officer Menu^^M^66481^DG SECURITY OFFICER^^^^^^5
"KRN",19,1138,10,0)
^19.01IP^7^6
"KRN",19,1138,10,6,0)
12730^EXP^5
"KRN",19,1138,10,6,"^")
DG SENSITIVE RCDS RPT-EXPORT
"KRN",19,1138,10,7,0)
12750^FMT^6
"KRN",19,1138,10,7,"^")
DG SENSITIVE RCDS RPT-FORMAT
"KRN",19,1138,"U")
SECURITY OFFICER MENU
"KRN",19,12729,-1)
0^3
"KRN",19,12729,0)
DG SENSITIVE RCDS RPT-TASK^ISO Sensitive Records Report Tasked^^R^^^^^^^^REGISTRATION
"KRN",19,12729,1,0)
^^6^6^3050518^
"KRN",19,12729,1,1,0)
This option will automatically send a VistA email to the mail group of 
"KRN",19,12729,1,2,0)
DG ISO SENSITIVE RCRDS.  This report gives a summary of all sensitive
"KRN",19,12729,1,3,0)
patient records accessed for the previous day.  It includes: patient 
"KRN",19,12729,1,4,0)
name, user name, title of user, option/protocol that was used when the 
"KRN",19,12729,1,5,0)
patient record was accessed, date/time the record was accessed and if the 
"KRN",19,12729,1,6,0)
patient record was an inpatient at the time.
"KRN",19,12729,25)
EN^DGISORPT
"KRN",19,12729,"U")
ISO SENSITIVE RECORDS REPORT T
"KRN",19,12730,-1)
0^4
"KRN",19,12730,0)
DG SENSITIVE RCDS RPT-EXPORT^ISO Sensitive Records Report-Export^^P^^^^^^^^REGISTRATION^^1^1
"KRN",19,12730,1,0)
^^6^6^3050606^
"KRN",19,12730,1,1,0)
This report will provided a list of patients accessed by a date range.  It
"KRN",19,12730,1,2,0)
includes: patient name, user name, title of user, option/protocol that was
"KRN",19,12730,1,3,0)
used when the patient record was accessed, date/time the record was
"KRN",19,12730,1,4,0)
accessed and if the patient record was an inpatient at the time.
"KRN",19,12730,1,5,0)
 
"KRN",19,12730,1,6,0)
Report is in a downloadable format.
"KRN",19,12730,15)
K DGCNT
"KRN",19,12730,20)
W !!,"THIS REPORT MAY TAKE A WHILE, YOU MAY WANT TO QUEUE IT.",!,"***256 COLUMNS AND WRAP AROUND NEEDED***",!
"KRN",19,12730,60)
DGSL(38.1,
"KRN",19,12730,62)
0
"KRN",19,12730,63)
[DG ISO SENSITIVE RCDS PRT]
"KRN",19,12730,64)
[DG ISO SENSITIVE RCDS SORT]
"KRN",19,12730,65)

"KRN",19,12730,66)

"KRN",19,12730,67)

"KRN",19,12730,"U")
ISO SENSITIVE RECORDS REPORT-E
"KRN",19,12750,-1)
0^5
"KRN",19,12750,0)
DG SENSITIVE RCDS RPT-FORMAT^ISO Sensitive Records Report-Formatted Report^^P^^^^^^^^REGISTRATION^^1
"KRN",19,12750,1,0)
^19.06^6^6^3050606^^
"KRN",19,12750,1,1,0)
This report will provided a list of patients accessed by a date range.  It
"KRN",19,12750,1,2,0)
includes: patient name, user name, title of user, option/protocol that was
"KRN",19,12750,1,3,0)
used when the patient record was accessed, date/time the record was
"KRN",19,12750,1,4,0)
accessed and if the patient record was an inpatient at the time.
"KRN",19,12750,1,5,0)
 
"KRN",19,12750,1,6,0)
This report is in printable format.
"KRN",19,12750,20)
W !!,"THIS REPORT MAY TAKE A WHILE, YOU MAY WANT TO QUEUE IT.",!,"***132 COLUMNS***",!
"KRN",19,12750,60)
DGSL(38.1,
"KRN",19,12750,62)
0
"KRN",19,12750,63)
[DG ISO SENSITIVE RCDS PRT1]
"KRN",19,12750,64)
[DG ISO SENSITIVE RCDS SORT]
"KRN",19,12750,65)

"KRN",19,12750,66)

"KRN",19,12750,"U")
ISO SENSITIVE RECORDS REPORT-F
"MBREQ")
0
"ORD",5,.4)
.4;5;;;EDEOUT^DIFROMSO(.4,DA,"",XPDA);FPRE^DIFROMSI(.4,"",XPDA);EPRE^DIFROMSI(.4,DA,$E("N",$G(XPDNEW)),XPDA,"",OLDA);;EPOST^DIFROMSI(.4,DA,"",XPDA);DEL^DIFROMSK(.4,"",%)
"ORD",5,.4,0)
PRINT TEMPLATE
"ORD",6,.401)
.401;6;;;EDEOUT^DIFROMSO(.401,DA,"",XPDA);FPRE^DIFROMSI(.401,"",XPDA);EPRE^DIFROMSI(.401,DA,$E("N",$G(XPDNEW)),XPDA,"",OLDA);;EPOST^DIFROMSI(.401,DA,"",XPDA);DEL^DIFROMSK(.401,"",%)
"ORD",6,.401,0)
SORT TEMPLATE
"ORD",11,3.8)
3.8;11;;;MAILG^XPDTA1;MAILGF1^XPDIA1;MAILGE1^XPDIA1;MAILGF2^XPDIA1;;MAILGDEL^XPDIA1(%)
"ORD",11,3.8,0)
MAIL GROUP
"ORD",18,19)
19;18;;;OPT^XPDTA;OPTF1^XPDIA;OPTE1^XPDIA;OPTF2^XPDIA;;OPTDEL^XPDIA
"ORD",18,19,0)
OPTION
"PKG",5,-1)
1^1
"PKG",5,0)
REGISTRATION^DG^PATIENT REGISTRATION, ADMISSION, DISCHARGE, EMBOSSER 
"PKG",5,20,0)
^9.402P^^
"PKG",5,22,0)
^9.49I^1^1
"PKG",5,22,1,0)
5.3^2930813
"PKG",5,22,1,"PAH",1,0)
666^3050722
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
1
"RTN","DGISORPT")
0^1^B8188646
"RTN","DGISORPT",1,0)
DGISORPT ;ALB/WJG/DHH SENSITIVE RECDS RPT;06/18/2005
"RTN","DGISORPT",2,0)
 ;;5.3;Registration;**666**;Aug 13, 1993
"RTN","DGISORPT",3,0)
 ;This was based off of a Pug Fileman template, that was tasked 
"RTN","DGISORPT",4,0)
 ;to run by the user. It was changed to incorporate the use of a 
"RTN","DGISORPT",5,0)
 ;Mail Group.
"RTN","DGISORPT",6,0)
 ;
"RTN","DGISORPT",7,0)
EN ;
"RTN","DGISORPT",8,0)
 K ^TMP($J),^UTILITY($J)
"RTN","DGISORPT",9,0)
 S U="^"
"RTN","DGISORPT",10,0)
 S (DGYEST,A)=9999999.9999-$$FMADD^XLFDT(DT,-1),A=A-1
"RTN","DGISORPT",11,0)
 F  S A=$O(^DGSL(38.1,"AD",A)),A1=0 Q:'A!(A>DGYEST)  F  S A1=$O(^DGSL(38.1,"AD",A,A1)) Q:A1=""  D
"RTN","DGISORPT",12,0)
 . S RECDAT=$G(^DGSL(38.1,A1,0)) Q:RECDAT=""
"RTN","DGISORPT",13,0)
 . S RECDAT1=$G(^DGSL(38.1,A1,"D",A,0)) Q:RECDAT1=""
"RTN","DGISORPT",14,0)
 . S RDATE=$P(RECDAT1,U) Q:RDATE=""
"RTN","DGISORPT",15,0)
 . S RDATE1=$E(RDATE,4,5)_"/"_$E(RDATE,6,7)_"/"_$E(RDATE,2,3)
"RTN","DGISORPT",16,0)
 . S TIME=$P(RDATE,".",2),TIME=$E(TIME_"0000",1,4)
"RTN","DGISORPT",17,0)
 . S RDATE1=RDATE1_"@"_TIME
"RTN","DGISORPT",18,0)
 . S PATNAME=$P($G(^DPT(A1,0)),U) Q:PATNAME=""
"RTN","DGISORPT",19,0)
 . S USERIEN=$P(RECDAT1,U,2) Q:USERIEN=""
"RTN","DGISORPT",20,0)
 . S OPT=$P(RECDAT1,U,3) S:OPT="" OPT=""
"RTN","DGISORPT",21,0)
 . S INP=$P(RECDAT1,U,4) S:INP="" INP=""
"RTN","DGISORPT",22,0)
 . S USERDAT=$G(^VA(200,USERIEN,0)) Q:USERDAT=""
"RTN","DGISORPT",23,0)
 . S USER=$E($P(USERDAT,U),1,20) Q:USER=""
"RTN","DGISORPT",24,0)
 . S TITLE1=$P(USERDAT,U,9) S:TITLE1="" TITLE=""
"RTN","DGISORPT",25,0)
 . S:TITLE1'="" TITLE=$P($G(^DIC(3.1,TITLE1,0)),U)
"RTN","DGISORPT",26,0)
 . S ALIAS=$P($G(^VA(200,USERIEN,3,1,0)),U)
"RTN","DGISORPT",27,0)
 . S SECIEN=$P($G(^VA(200,USERIEN,5)),U) S:SECIEN="" SECT=""
"RTN","DGISORPT",28,0)
 . S:SECIEN'="" SECT=$P($G(^DIC(49,SECIEN,0)),U) S:SECT="" SECT=""
"RTN","DGISORPT",29,0)
 . S:USERIEN=".5" SECT="VISTA SYSTEM"
"RTN","DGISORPT",30,0)
 . S:SECT'="" SECT=$E(SECT,1,20) S:ALIAS'="" ALIAS=$E(ALIAS,1,5) S:OPT'="" OPT=$E(OPT,1,25)
"RTN","DGISORPT",31,0)
 . S ^UTILITY($J,RDATE,A1)=PATNAME_U_RDATE1_U_USER_U_TITLE_U_ALIAS_U_SECT_U_OPT_U_INP
"RTN","DGISORPT",32,0)
XMTEXT ;sets up message text
"RTN","DGISORPT",33,0)
 S LINE=0
"RTN","DGISORPT",34,0)
 S LINE=LINE+1
"RTN","DGISORPT",35,0)
 S ^TMP($J,LINE)="PATIENT^DATE/TIME^USER^TITLE^ALIAS^SERVICE^OPTION USED^INPATIENT"
"RTN","DGISORPT",36,0)
 S LINE=LINE+1
"RTN","DGISORPT",37,0)
 S T1=0 F  S T1=$O(^UTILITY($J,T1)) Q:T1=""  S T2=0 F  S T2=$O(^UTILITY($J,T1,T2)) Q:T2=""  D
"RTN","DGISORPT",38,0)
 . S TEXT=$G(^UTILITY($J,T1,T2)) Q:TEXT=""
"RTN","DGISORPT",39,0)
 . S ^TMP($J,LINE)=TEXT,LINE=LINE+1
"RTN","DGISORPT",40,0)
NOPAT ;set message text if ^tmp($J=null
"RTN","DGISORPT",41,0)
 I '$D(^TMP($J,2)) D
"RTN","DGISORPT",42,0)
 . S ^TMP($J,2)="No Sensitive Records were accessed on "_$$FMTE^XLFDT(DT-1,1)_"."
"RTN","DGISORPT",43,0)
SEND ;
"RTN","DGISORPT",44,0)
 S XMSUB="Sensitive Record Auditing Report"
"RTN","DGISORPT",45,0)
 S XMTEXT="^TMP($J,"
"RTN","DGISORPT",46,0)
 S XMY("G.DG ISO SENSITIVE RCDS")=""
"RTN","DGISORPT",47,0)
 S XMDUZ=.5 D ^XMD
"RTN","DGISORPT",48,0)
 K XMDUZ,XMSUB,XMTEXT,XMY,^TMP($J)
"RTN","DGISORPT",49,0)
Q ;
"RTN","DGISORPT",50,0)
 K XMSUB,XMTEXT,XMY,XMDUZ,LINE,T1,T2,TEXT,^UTILITY($J),^TMP($J),X1,X2,RDATE,A,A1,PATNAME,RECDAT,RECDAT1,USER
"RTN","DGISORPT",51,0)
 K TITLE,TITLE1,OPT,INP,USERDAT,SECT,ALIAS,USERIEN,X,Y,SECIEN,TIME,RDATE1,DGYEST
"RTN","DGISORPT",52,0)
 Q
"RTN","DGISORPT",53,0)
HEADER ;Header for export option
"RTN","DGISORPT",54,0)
 S DGCNT=$G(DGCNT)+1
"RTN","DGISORPT",55,0)
 I DGCNT=1 W !,"PATIENT^DATE/TIME^USER^TITLE^ALIAS^SERVICE^OPTION USED^INPATIENT",!
"RTN","DGISORPT",56,0)
 ; DGCNT is killed upon exiting DG SENSITIVE RCDS RPT-EXPORT option
"RTN","DGISORPT",57,0)
 Q
"VER")
8.0^22.0
"BLD",6194,6)
^SEQ #580
**END**
**END**
