EMERGENCY Released PRCA*4.5*241 SEQ #215
Extracted from mail message
**KIDS**:PRCA*4.5*241^

**INSTALL NAME**
PRCA*4.5*241
"BLD",6509,0)
PRCA*4.5*241^ACCOUNTS RECEIVABLE^0^3060412^y
"BLD",6509,1,0)
^^7^7^3060307^^^
"BLD",6509,1,1,0)
Patch PRCA*4.5*241 is the last in a series of patches that will
"BLD",6509,1,2,0)
adjust the accounts of veterans affected by Hurricane Katrina.
"BLD",6509,1,3,0)
This patch will exempt interest charges added to these veterans'
"BLD",6509,1,4,0)
accounts between 8/29/06 and 2/28/06, and cancel all co-payment
"BLD",6509,1,5,0)
charges billed to these veterans in this same period.  Integrated
"BLD",6509,1,6,0)
Billing patch IB*2*340 must be installed before this patch can be
"BLD",6509,1,7,0)
installed.
"BLD",6509,4,0)
^9.64PA^340^1
"BLD",6509,4,340,0)
340
"BLD",6509,4,340,2,0)
^9.641^340^1
"BLD",6509,4,340,2,340,0)
AR DEBTOR  (File-top level)
"BLD",6509,4,340,2,340,1,0)
^9.6411^.09^2
"BLD",6509,4,340,2,340,1,.08,0)
ACCT. PROCESSED (KATRINA)
"BLD",6509,4,340,2,340,1,.09,0)
COPAY CHARGES CANCELLED?
"BLD",6509,4,340,222)
y^n^p^^^^n^^n
"BLD",6509,4,340,224)

"BLD",6509,4,"APDD",340,340)

"BLD",6509,4,"APDD",340,340,.08)

"BLD",6509,4,"APDD",340,340,.09)

"BLD",6509,4,"B",340,340)

"BLD",6509,"ABPKG")
n
"BLD",6509,"INID")
^n
"BLD",6509,"INIT")
POST^RCKATP
"BLD",6509,"KRN",0)
^9.67PA^8989.52^19
"BLD",6509,"KRN",.4,0)
.4
"BLD",6509,"KRN",.4,"NM",0)
^9.68A^^
"BLD",6509,"KRN",.401,0)
.401
"BLD",6509,"KRN",.402,0)
.402
"BLD",6509,"KRN",.403,0)
.403
"BLD",6509,"KRN",.5,0)
.5
"BLD",6509,"KRN",.84,0)
.84
"BLD",6509,"KRN",3.6,0)
3.6
"BLD",6509,"KRN",3.8,0)
3.8
"BLD",6509,"KRN",9.2,0)
9.2
"BLD",6509,"KRN",9.8,0)
9.8
"BLD",6509,"KRN",9.8,"NM",0)
^9.68A^11^7
"BLD",6509,"KRN",9.8,"NM",5,0)
RCDPAPLI^^0^B42722904
"BLD",6509,"KRN",9.8,"NM",6,0)
RCDPBPLM^^0^B53138816
"BLD",6509,"KRN",9.8,"NM",7,0)
PRCADR^^0^B15191429
"BLD",6509,"KRN",9.8,"NM",8,0)
PRCADR2^^0^B15487000
"BLD",6509,"KRN",9.8,"NM",9,0)
RCEXINAD^^0^B28426860
"BLD",6509,"KRN",9.8,"NM",10,0)
RCKATP^^0^B52172732
"BLD",6509,"KRN",9.8,"NM",11,0)
RCKATPD^^0^B7389792
"BLD",6509,"KRN",9.8,"NM","B","PRCADR",7)

"BLD",6509,"KRN",9.8,"NM","B","PRCADR2",8)

"BLD",6509,"KRN",9.8,"NM","B","RCDPAPLI",5)

"BLD",6509,"KRN",9.8,"NM","B","RCDPBPLM",6)

"BLD",6509,"KRN",9.8,"NM","B","RCEXINAD",9)

"BLD",6509,"KRN",9.8,"NM","B","RCKATP",10)

"BLD",6509,"KRN",9.8,"NM","B","RCKATPD",11)

"BLD",6509,"KRN",19,0)
19
"BLD",6509,"KRN",19,"NM",0)
^9.68A^^0
"BLD",6509,"KRN",19.1,0)
19.1
"BLD",6509,"KRN",19.1,"NM",0)
^9.68A^^
"BLD",6509,"KRN",101,0)
101
"BLD",6509,"KRN",409.61,0)
409.61
"BLD",6509,"KRN",771,0)
771
"BLD",6509,"KRN",870,0)
870
"BLD",6509,"KRN",8989.51,0)
8989.51
"BLD",6509,"KRN",8989.52,0)
8989.52
"BLD",6509,"KRN",8994,0)
8994
"BLD",6509,"KRN","B",.4,.4)

"BLD",6509,"KRN","B",.401,.401)

"BLD",6509,"KRN","B",.402,.402)

"BLD",6509,"KRN","B",.403,.403)

"BLD",6509,"KRN","B",.5,.5)

"BLD",6509,"KRN","B",.84,.84)

"BLD",6509,"KRN","B",3.6,3.6)

"BLD",6509,"KRN","B",3.8,3.8)

"BLD",6509,"KRN","B",9.2,9.2)

"BLD",6509,"KRN","B",9.8,9.8)

"BLD",6509,"KRN","B",19,19)

"BLD",6509,"KRN","B",19.1,19.1)

"BLD",6509,"KRN","B",101,101)

"BLD",6509,"KRN","B",409.61,409.61)

"BLD",6509,"KRN","B",771,771)

"BLD",6509,"KRN","B",870,870)

"BLD",6509,"KRN","B",8989.51,8989.51)

"BLD",6509,"KRN","B",8989.52,8989.52)

"BLD",6509,"KRN","B",8994,8994)

"BLD",6509,"QUES",0)
^9.62^^
"BLD",6509,"REQB",0)
^9.611^4^3
"BLD",6509,"REQB",2,0)
PRCA*4.5*237^2
"BLD",6509,"REQB",3,0)
IB*2.0*340^2
"BLD",6509,"REQB",4,0)
PRCA*4.5*159^2
"BLD",6509,"REQB","B","IB*2.0*340",3)

"BLD",6509,"REQB","B","PRCA*4.5*159",4)

"BLD",6509,"REQB","B","PRCA*4.5*237",2)

"FIA",340)
AR DEBTOR
"FIA",340,0)
^RCD(340,
"FIA",340,0,0)
340V
"FIA",340,0,1)
y^n^p^^^^n^^n
"FIA",340,0,10)

"FIA",340,0,11)

"FIA",340,0,"RLRO")

"FIA",340,0,"VR")
4.5^PRCA
"FIA",340,340)
1
"FIA",340,340,.08)

"FIA",340,340,.09)

"INIT")
POST^RCKATP
"MBREQ")
0
"PKG",142,-1)
1^1
"PKG",142,0)
ACCOUNTS RECEIVABLE^PRCA^BILL COLLECTIONS
"PKG",142,20,0)
^9.402P^1^1
"PKG",142,20,1,0)
2^^PRCAMRG
"PKG",142,20,1,1)

"PKG",142,20,"B",2,1)

"PKG",142,22,0)
^9.49I^1^1
"PKG",142,22,1,0)
4.5^^2950320
"PKG",142,22,1,"PAH",1,0)
241^3060412^10865
"PKG",142,22,1,"PAH",1,1,0)
^^7^7^3060412
"PKG",142,22,1,"PAH",1,1,1,0)
Patch PRCA*4.5*241 is the last in a series of patches that will
"PKG",142,22,1,"PAH",1,1,2,0)
adjust the accounts of veterans affected by Hurricane Katrina.
"PKG",142,22,1,"PAH",1,1,3,0)
This patch will exempt interest charges added to these veterans'
"PKG",142,22,1,"PAH",1,1,4,0)
accounts between 8/29/06 and 2/28/06, and cancel all co-payment
"PKG",142,22,1,"PAH",1,1,5,0)
charges billed to these veterans in this same period.  Integrated
"PKG",142,22,1,"PAH",1,1,6,0)
Billing patch IB*2*340 must be installed before this patch can be
"PKG",142,22,1,"PAH",1,1,7,0)
installed.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
7
"RTN","PRCADR")
0^7^B15191429^B14913380
"RTN","PRCADR",1,0)
PRCADR ;SF-ISC/YJK-PRINT ADDRESS,TRANS.,BALANCE ;9/13/96  11:54 AM [ 02/24/97  12:17 PM ]
"RTN","PRCADR",2,0)
V ;;4.5;Accounts Receivable;**21,45,108,141,241**;Mar 20, 1995
"RTN","PRCADR",3,0)
 ;;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","PRCADR",4,0)
 ;print debtor's 3rd party address,transaction,balances.
"RTN","PRCADR",5,0)
EN1 ;PRINT ADDRESS, SOCIAL SECURITY NUMBER AND DATE OF BIRTH.
"RTN","PRCADR",6,0)
 N RCDMC,RCTOP,RCKAT
"RTN","PRCADR",7,0)
 K PRCAGL D EN11 Q:'$D(PRCAGL)  D WR1^PRCADR2
"RTN","PRCADR",8,0)
 I $D(^PRCA(430,D0,8)),$P(^(8),U,7)["N" W !,"* UNABLE TO LOCATE *"
"RTN","PRCADR",9,0)
 D END1 Q
"RTN","PRCADR",10,0)
EN11 Q:'$D(D0)  S Z0=$S($P(^PRCA(430,D0,0),U,9)'="":$P(^(0),U,9),1:"") Q:Z0=""
"RTN","PRCADR",11,0)
EN12 S PRCADB=$P(^RCD(340,Z0,0),"^"),RCDMC=$D(^RCD(340,"DMC",1,Z0)),RCTOP=$D(^RCD(340,"TOP",Z0))
"RTN","PRCADR",12,0)
 S X=$$DADD^RCAMADD(PRCADB) S $P(PRCAGL,"^",1,6)=$P(X,"^",1,6),$P(PRCAGL,"^",9)=$P(X,"^",7) K PRCADB
"RTN","PRCADR",13,0)
 S Z1=$P(^RCD(340,Z0,0),";",1),Z2=$P($P(^(0),"^"),";",2),PRCASTE=$P(PRCAGL,U,5)
"RTN","PRCADR",14,0)
 S (PRCASSN,PRCADOB)="" I '$D(^VA(200,Z1,0)),'$D(^DPT(Z1,0)) Q
"RTN","PRCADR",15,0)
 S DFN=Z1 D DEM^VADPT I VAERR K VAERR Q
"RTN","PRCADR",16,0)
 S PRCASSN=$S(Z2["VA(200":$P(^VA(200,Z1,1),U,9),1:"")
"RTN","PRCADR",17,0)
 I Z2["DPT(" S DFN=Z1 D DEM^VADPT S PRCASSN=$P(VADM(2),"^",2)
"RTN","PRCADR",18,0)
 S RCKAT="" I $$EMGRES^DGUTL(DFN)["K" S RCKAT=1
"RTN","PRCADR",19,0)
 S PRCASSN=$S((PRCASSN["-")!($L(PRCASSN)>9):PRCASSN,1:$E(PRCASSN,1,3)_"-"_$E(PRCASSN,4,5)_"-"_$E(PRCASSN,6,9))
"RTN","PRCADR",20,0)
 S PRCADOB=$S(Z2["VA(200":$P(^VA(200,Z1,1),U,3),Z2["DPT":$P(VADM(3),"^",1),1:"")
"RTN","PRCADR",21,0)
 S PRCADOB=$$SLH^RCFN01(PRCADOB) K DFN,VAERR,VADM,Z1,Z2 Q
"RTN","PRCADR",22,0)
END1 K %,PRCADOB,PRCASSN,PRCASTE,PRCAGL,Z1,Z2,Z0 Q
"RTN","PRCADR",23,0)
EN2 ;prints all transaction type of AR in the Profile of AR.
"RTN","PRCADR",24,0)
 Q:'$D(D0)  S PRCAEN=0,PRCAK1=1 K PRCA("WROFF")
"RTN","PRCADR",25,0)
 F I=0:0 S PRCAEN=$O(^PRCA(433,"C",D0,PRCAEN)) Q:'PRCAEN  D WR2^PRCADR2 S PRCAK1=PRCAK1+1 I PRCAK1>7 D EN5 Q:$D(PRCA("HALT"))  S PRCAK1=-5
"RTN","PRCADR",26,0)
END2 K I,PRCAEN,PRCAK1,PRCAG,% Q  ;end of EN2
"RTN","PRCADR",27,0)
EN3 ;Print the balances and paid amount of Principal,Interest and Admin.
"RTN","PRCADR",28,0)
PRBAL S (PRCAK("PB"),PRCAK("IB"),PRCAK("AB"),PRCAK("IP"),PRCAK("PP"),PRCAK("AP"),PRCAK("MF"),PRCAK("CC"))=0
"RTN","PRCADR",29,0)
 I $D(^PRCA(430,D0,7)) D PRBAL1
"RTN","PRCADR",30,0)
 S (PRCAL(1),PRCAL(2),PRCAL(3),PRCAL(4),PRCAL(5),PRCAL(6),PRCACODE)=""
"RTN","PRCADR",31,0)
 I $D(^PRCA(430,D0,6)) S PRCAGL6=^(6),PRCAL(1)=$P(PRCAGL6,U,1),PRCAL(2)=$P(PRCAGL6,U,2),PRCAL(3)=$P(PRCAGL6,U,3),PRCAL(4)=$P(PRCAGL6,U,4),PRCACODE=$P(PRCAGL6,U,5),PRCAL(5)=$P(PRCAGL6,U,7),PRCAL(6)=$P(PRCAGL6,U,14)
"RTN","PRCADR",32,0)
 S PRCACODE=$S(PRCACODE]"""":PRCACODE,1:"DC/DOJ")
"RTN","PRCADR",33,0)
 S PRCALT=PRCAL(1) D LDATE S PRCAL(1)=PRCALT,PRCALT=PRCAL(2) D LDATE S PRCAL(2)=PRCALT,PRCALT=PRCAL(3) D LDATE S PRCAL(3)=PRCALT
"RTN","PRCADR",34,0)
 S PRCALT=PRCAL(4) D LDATE S PRCAL(4)=PRCALT,PRCALT=PRCAL(5) D LDATE S PRCAL(5)=PRCALT,PRCALT=PRCAL(6) D LDATE S PRCAL(6)=PRCALT
"RTN","PRCADR",35,0)
 D WR3^PRCADR2
"RTN","PRCADR",36,0)
END3 K PRCAL,PRCACODE,PRCALT,PRCAGL6,PRCAGL7,PRCAK Q
"RTN","PRCADR",37,0)
PRBAL1 S PRCAGL7=^PRCA(430,D0,7),PRCAK("PP")=$P(PRCAGL7,U,7),PRCAK("IP")=$P(PRCAGL7,U,8),PRCAK("AP")=$P(PRCAGL7,U,9)
"RTN","PRCADR",38,0)
 S PRCAK("PB")=$P(PRCAGL7,U,1),PRCAK("IB")=$P(PRCAGL7,U,2),PRCAK("AB")=$P(PRCAGL7,U,3),PRCAK("MF")=$P(PRCAGL7,U,4),PRCAK("CC")=$P(PRCAGL7,U,5)
"RTN","PRCADR",39,0)
 Q
"RTN","PRCADR",40,0)
LDATE Q:PRCALT=""  S PRCALT=$$SLH^RCFN01(PRCALT) Q
"RTN","PRCADR",41,0)
EN4 ;Print 3rd party address information.
"RTN","PRCADR",42,0)
 Q:'$D(D0)  S Z0=$S($P(^PRCA(430,D0,0),U,9)'="":$P(^(0),U,9),1:"") Q:Z0=""  S PRCADB=$P(^RCD(340,Z0,0),"^") S X=$$DADD^RCAMADD(PRCADB) S $P(PRCAGL,"^",1,6)=$P(X,"^",1,6),$P(PRCAGL,"^",9)=$P(X,"^",7) K PRCADB
"RTN","PRCADR",43,0)
 W !,?12,$P(PRCAGL,U) F X=2,3,4 W:$P(PRCAGL,U,X)'="" !,?12,$P(PRCAGL,U,X)
"RTN","PRCADR",44,0)
 I $P(PRCAGL,U,5)'="",$P(PRCAGL,U,5)'[" " W ", ",$P(PRCAGL,U,5)," ",$P(PRCAGL,U,6)
"RTN","PRCADR",45,0)
 W "      PHONE NO.: ",$P(PRCAGL,U,9)
"RTN","PRCADR",46,0)
END4 K %,PRCAGL,Z0 Q
"RTN","PRCADR",47,0)
EN5 K PRCA("HALT") Q:'$D(PRCAIO)
"RTN","PRCADR",48,0)
 I $E(IOST,1,2)["C-" R !,?8,"ENTER '^' TO HALT:  ",X:$S($D(DTIME):DTIME,1:999) I (X["^")!('$T) S PRCA("HALT")=1 Q
"RTN","PRCADR",49,0)
 I $E(IOST,1,2)["C-",$D(IOF) W @IOF
"RTN","PRCADR",50,0)
 Q
"RTN","PRCADR",51,0)
 ;
"RTN","PRCADR",52,0)
SVDT(D0) ;Called from the PRCA 3RD PROFILE print template
"RTN","PRCADR",53,0)
 N X S X="IBRFN" X ^%ZOSF("TEST") G SVDTQ:'$T
"RTN","PRCADR",54,0)
 S D0=$P($P($G(^PRCA(430,+D0,0)),"^"),"-",2)
"RTN","PRCADR",55,0)
 S X=$$SVDT^IBRFN(D0)
"RTN","PRCADR",56,0)
 Q X
"RTN","PRCADR",57,0)
SVDTQ Q 0
"RTN","PRCADR2")
0^8^B15487000^B15135581
"RTN","PRCADR2",1,0)
PRCADR2 ;SF-ISC/YJK-PRINT ADDRESS,TRANS.,BALANCE ;3/19/97  3:19 PM
"RTN","PRCADR2",2,0)
V ;;4.5;Accounts Receivable;**45,104,108,149,141,172,241**;Mar 20, 1995
"RTN","PRCADR2",3,0)
 ;;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","PRCADR2",4,0)
 ;print debtor's /3rd party address,transaction,balances.
"RTN","PRCADR2",5,0)
 N RCDMC,RCTOP
"RTN","PRCADR2",6,0)
WR1 W !!,$P(PRCAGL,U,1),?39,"SOC.SEC.NO.: ",?55,PRCASSN
"RTN","PRCADR2",7,0)
 W:$P(PRCAGL,U,2)'="" !,$P(PRCAGL,U,2)
"RTN","PRCADR2",8,0)
 W !,$P(PRCAGL,U,4),", ",PRCASTE,"  ",$P(PRCAGL,U,6),?39,"DATE OF BIRTH: ",?55,PRCADOB,!,"PHONE NO.: ",$P(PRCAGL,U,9),?39,"DATE POSTED: " S Y=$P($G(^PRCA(430,D0,6)),"^",21) W:'Y "N/A" I Y D DD^%DT W $P(Y,"@")," ",$P(Y,"@",2)
"RTN","PRCADR2",9,0)
 I $G(RCKAT) W !,"EMERGENCY RESPONSE INDICATOR: HURRICANE KATRINA"
"RTN","PRCADR2",10,0)
 I $G(RCDMC) W !,"****Debtor's Account Forwarded To DMC****"
"RTN","PRCADR2",11,0)
 I $G(RCTOP) W !,"****Debtor's Account Forwarded To TOP****"
"RTN","PRCADR2",12,0)
END1 K %,PRCADOB,PRCASSN,PRCASTE,PRCAGL,Z1,Z2,Z0
"RTN","PRCADR2",13,0)
 Q
"RTN","PRCADR2",14,0)
 ;
"RTN","PRCADR2",15,0)
 ;
"RTN","PRCADR2",16,0)
WR2 ;called by EN2^PRCADR
"RTN","PRCADR2",17,0)
 W ! S PRCAGL0=$S($D(^PRCA(433,PRCAEN,0)):^(0),1:""),PRCAG=$S($D(^PRCA(433,PRCAEN,1)):^(1),1:"") Q:(PRCAG="")!(PRCAGL0="")
"RTN","PRCADR2",18,0)
 S PRCATD=$P(PRCAG,U,1),PRCATY=$P(PRCAG,U,2) Q:'$D(^PRCA(430.3,+PRCATY,0))  S PRCATYPE=$P(^(0),U,3) W ?1,$S($P(PRCAGL0,U,10):"*",1:""),?2,+PRCAGL0
"RTN","PRCADR2",19,0)
 I $P(PRCAG,U,3)="" D
"RTN","PRCADR2",20,0)
 .W:PRCATYPE=17 ?10,$P($G(^PRCA(433,PRCAEN,5)),"^",2)
"RTN","PRCADR2",21,0)
 .W:(PRCATYPE=1)!(PRCATYPE=21) ?10,$P(PRCAG,U,4)
"RTN","PRCADR2",22,0)
 I $P(PRCAG,U,3)'="" W ?10,$P(PRCAG,U,3)
"RTN","PRCADR2",23,0)
 S:(PRCATYPE=8)!((PRCATYPE=9)!(PRCATYPE=10)) PRCA("WROFF")=PRCAEN
"RTN","PRCADR2",24,0)
 W:PRCATY?1N.N&(PRCATYPE'=17) ?20,$P(^PRCA(430.3,PRCATY,0),U,1) I (PRCATYPE=2)!(PRCATYPE=20),$P(^PRCA(433,PRCAEN,0),U,7)]"" W "(",$P(^(0),U,7),")"
"RTN","PRCADR2",25,0)
 S Y=PRCATD D DD^%DT S Y(1)=$P(Y,", ",2)
"RTN","PRCADR2",26,0)
 S PRCATD=$E(PRCATD,4,5)_"/"_$E(PRCATD,6,7)_"/"_Y(1)
"RTN","PRCADR2",27,0)
 ;  if a decrease adjustment, show as negative (patch 4.5*172)
"RTN","PRCADR2",28,0)
 I $P(PRCAG,"^",2)=35,$P(PRCAG,"^",5)>0 S $P(PRCAG,"^",5)=-$P(PRCAG,"^",5)
"RTN","PRCADR2",29,0)
 W ?42,PRCATD,?53,$J($P(PRCAG,U,5),9,2) W:+$P(PRCAGL0,U,4)<2 ?67,"INCOMPLETE"
"RTN","PRCADR2",30,0)
END2 K PRCAG,PRCATD,PRCATY,PRCATYPE,PRCAGL0
"RTN","PRCADR2",31,0)
 Q  ;end of WR2
"RTN","PRCADR2",32,0)
 ;
"RTN","PRCADR2",33,0)
 ;
"RTN","PRCADR2",34,0)
WR3 W !,?17,"BALANCES",?31,"PAID"
"RTN","PRCADR2",35,0)
 W !,?44,"LETTER1/ICD:",?58,PRCAL(1)
"RTN","PRCADR2",36,0)
 W !,"PRINCIPAL:",?16,$J(PRCAK("PB"),9,2),?26,$J(PRCAK("PP"),9,2),?44,"LETTER2:",?58,PRCAL(2)
"RTN","PRCADR2",37,0)
 W !,"INTEREST:",?16,$J(PRCAK("IB"),9,2),?26,$J(PRCAK("IP"),9,2),?44,"LETTER3:",?58,PRCAL(3)
"RTN","PRCADR2",38,0)
 W !,"ADMINISTRATIVE:",?16,$J(PRCAK("AB"),9,2),?26,$J(PRCAK("AP"),9,2),?44,"IRS LETTER:",?58,PRCAL(6)
"RTN","PRCADR2",39,0)
 W ! W:PRCAK("MF")>0 "MARSHAL FEE:",?16,$J(PRCAK("MF"),9,2),?26,$J(0,9,2) W ?44,PRCACODE_" REF.DATE:",?62,PRCAL(4)
"RTN","PRCADR2",40,0)
 W:PRCAK("CC")>0 !,"COURT COST:",?16,$J(PRCAK("CC"),9,2),?26,$J(0,9,2)
"RTN","PRCADR2",41,0)
 W !,"CURRENT:",?16,$J(PRCAK("PB")+PRCAK("IB")+PRCAK("AB")+PRCAK("MF")+PRCAK("CC"),9,2),?26,$J(PRCAK("PP")+PRCAK("AP")+PRCAK("IP"),9,2)
"RTN","PRCADR2",42,0)
 K PRCAL I $D(^PRCA(430,D0,6)) S PRCAL=^(6) I $P(PRCAL,"^",15)]"" W !!,"     Date forwarded to IRS: " S Y=$P(PRCAL,"^",15) D DD^%DT W Y
"RTN","PRCADR2",43,0)
 I $D(PRCAL),$P(PRCAL,"^",16)]"" W !,"Prin/Int/Admin IRS balance: " F X=16:1:18 W +$P(PRCAL,"^",X),"/"
"RTN","PRCADR2",44,0)
 K PRCAL I $G(^PRCA(430,D0,12)) S PRCAL=^(12) I $P(PRCAL,U)]"" W !!,"     Date forwarded to DMC: " S Y=$P(PRCAL,U) D DD^%DT W Y
"RTN","PRCADR2",45,0)
 I $D(PRCAL),$P(PRCAL,U,2)]"" W !,"Prin/Int/Admin DMC balance: " F X=2:1:4 W +$P(PRCAL,U,X),"/"
"RTN","PRCADR2",46,0)
 I $D(PRCAL),$P($G(^RCD(340,(+$P(^PRCA(430,D0,0),"^",9)),3)),"^",9)'="" W !,"Lesser Withhold Amt to DMC: ",$J($P(^(3),"^",9),0,2)
"RTN","PRCADR2",47,0)
 K PRCAL I $G(^PRCA(430,D0,14)) S PRCAL=^(14) I $P(PRCAL,U)]"" W !!,"Date forwarded to TOP: " S Y=$P(PRCAL,U) D DD^%DT W Y
"RTN","PRCADR2",48,0)
 I $D(PRCAL),$P($G(^RCD(340,(+$P(^PRCA(430,D0,0),"^",9)),6)),"^",6)'="" W !,"TOP Hold Date:  " S Y=$P(^(6),"^",6) D DD^%DT W Y
"RTN","PRCADR2",49,0)
END3 K PRCAL,PRCACODE,PRCALT,PRCAK,PRCAGL6,PRCAGL7 Q
"RTN","RCDPAPLI")
0^5^B42722904^B40599018
"RTN","RCDPAPLI",1,0)
RCDPAPLI ;WISC/RFJ-account profile top list manager init ;1 Jun 99
"RTN","RCDPAPLI",2,0)
 ;;4.5;Accounts Receivable;**114,141,241**;Mar 20, 1995
"RTN","RCDPAPLI",3,0)
 ;;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","RCDPAPLI",4,0)
 Q
"RTN","RCDPAPLI",5,0)
 ;
"RTN","RCDPAPLI",6,0)
 ;
"RTN","RCDPAPLI",7,0)
INIT ;  init for list manager screen
"RTN","RCDPAPLI",8,0)
 N DMCDATA,RCBILLDA,RCCOMM,RCDATA,RCDATE,RCLINE,RCSTATDA,RCTOTAL
"RTN","RCDPAPLI",9,0)
 N TOP4,TOP6
"RTN","RCDPAPLI",10,0)
 K ^TMP("RCDPAPLM",$J),^TMP("RCDPAPLMX",$J),^TMP("VALM VIDEO",$J)
"RTN","RCDPAPLI",11,0)
 ;
"RTN","RCDPAPLI",12,0)
 ;  fast exit
"RTN","RCDPAPLI",13,0)
 I $G(RCDPFXIT) S VALMQUIT=1 Q
"RTN","RCDPAPLI",14,0)
 ;
"RTN","RCDPAPLI",15,0)
 I '$G(RCDEBTDA) D  Q
"RTN","RCDPAPLI",16,0)
 .   D SET("",1,1,80)
"RTN","RCDPAPLI",17,0)
 .   D SET("*****  Select an ACCOUNT  *****",2,1,80)
"RTN","RCDPAPLI",18,0)
 .   S VALMCNT=2
"RTN","RCDPAPLI",19,0)
 .   D HDR^RCDPAPLM
"RTN","RCDPAPLI",20,0)
 ;
"RTN","RCDPAPLI",21,0)
 ;  get bills for a debtor
"RTN","RCDPAPLI",22,0)
 D GETBILLS^RCDPAPST(RCDEBTDA)
"RTN","RCDPAPLI",23,0)
 ;
"RTN","RCDPAPLI",24,0)
 I '$O(^TMP("RCDPAPST",$J,0)) D  Q
"RTN","RCDPAPLI",25,0)
 .   D SET("",1,1,80,IORVOFF,IORVOFF)
"RTN","RCDPAPLI",26,0)
 .   D SET("  *****  Account does not have any bills *****",2,1,80)
"RTN","RCDPAPLI",27,0)
 .   S VALMCNT=2
"RTN","RCDPAPLI",28,0)
 .   S RCTOTAL(1)=0
"RTN","RCDPAPLI",29,0)
 .   D HDR^RCDPAPLM
"RTN","RCDPAPLI",30,0)
 ;
"RTN","RCDPAPLI",31,0)
 ;  set the listmanager line number
"RTN","RCDPAPLI",32,0)
 S RCLINE=0
"RTN","RCDPAPLI",33,0)
 ;
"RTN","RCDPAPLI",34,0)
 S RCDATE=9999999 F  S RCDATE=$O(^TMP("RCDPAPST",$J,RCDATE),-1) Q:'RCDATE  D
"RTN","RCDPAPLI",35,0)
 .   S RCSTATDA=0 F  S RCSTATDA=$O(^TMP("RCDPAPST",$J,RCDATE,RCSTATDA)) Q:'RCSTATDA  D
"RTN","RCDPAPLI",36,0)
 .   .   S RCBILLDA=0 F  S RCBILLDA=$O(^TMP("RCDPAPST",$J,RCDATE,RCSTATDA,RCBILLDA)) Q:'RCBILLDA  D
"RTN","RCDPAPLI",37,0)
 .   .   .   S RCDATA=^TMP("RCDPAPST",$J,RCDATE,RCSTATDA,RCBILLDA)
"RTN","RCDPAPLI",38,0)
 .   .   .   ;  add up dollars owed by account (all bills)
"RTN","RCDPAPLI",39,0)
 .   .   .   S RCTOTAL(1)=$G(RCTOTAL(1))+$P(RCDATA,"^")
"RTN","RCDPAPLI",40,0)
 .   .   .   S RCTOTAL(2)=$G(RCTOTAL(2))+$P(RCDATA,"^",2)
"RTN","RCDPAPLI",41,0)
 .   .   .   S RCTOTAL(3)=$G(RCTOTAL(3))+$P(RCDATA,"^",3)
"RTN","RCDPAPLI",42,0)
 .   .   .   ;
"RTN","RCDPAPLI",43,0)
 .   .   .   ;  if not a selected status, do not display
"RTN","RCDPAPLI",44,0)
 .   .   .   I ("^"_$G(^DISV(DUZ,"RCDPAPLM","STATUS"))_"^")'[("^"_RCSTATDA_"^") Q
"RTN","RCDPAPLI",45,0)
 .   .   .   ;
"RTN","RCDPAPLI",46,0)
 .   .   .   ;  display the bill in listmanager if the status selected
"RTN","RCDPAPLI",47,0)
 .   .   .   D SETBILL
"RTN","RCDPAPLI",48,0)
 .   .   .   ;
"RTN","RCDPAPLI",49,0)
 .   .   .   ;  add up dollars owed by account (bills displayed)
"RTN","RCDPAPLI",50,0)
 .   .   .   S RCTOTAL(4)=$G(RCTOTAL(4))+$P(RCDATA,"^")
"RTN","RCDPAPLI",51,0)
 .   .   .   S RCTOTAL(5)=$G(RCTOTAL(5))+$P(RCDATA,"^",2)
"RTN","RCDPAPLI",52,0)
 .   .   .   S RCTOTAL(6)=$G(RCTOTAL(6))+$P(RCDATA,"^",3)
"RTN","RCDPAPLI",53,0)
 ;
"RTN","RCDPAPLI",54,0)
 ;  show totals of all bills displayed in listmanager
"RTN","RCDPAPLI",55,0)
 S RCLINE=RCLINE+1
"RTN","RCDPAPLI",56,0)
 D SET("                                                    --------- -------- --------",RCLINE,1,80)
"RTN","RCDPAPLI",57,0)
 S RCLINE=RCLINE+1
"RTN","RCDPAPLI",58,0)
 D SET("   TOTAL BALANCE OWED FOR ALL BILLS DISPLAYED",RCLINE,1,80)
"RTN","RCDPAPLI",59,0)
 D SET($J($G(RCTOTAL(4)),9,2),RCLINE,53,62)
"RTN","RCDPAPLI",60,0)
 D SET($J($G(RCTOTAL(5)),9,2),RCLINE,62,71)
"RTN","RCDPAPLI",61,0)
 D SET($J($G(RCTOTAL(6)),9,2),RCLINE,71,80)
"RTN","RCDPAPLI",62,0)
 ;
"RTN","RCDPAPLI",63,0)
 ;  get the pending payments for the debtor
"RTN","RCDPAPLI",64,0)
 S RCTOTAL("PP")=$$PENDPAY^RCDPURET($P(^RCD(340,RCDEBTDA,0),"^"))
"RTN","RCDPAPLI",65,0)
 I $O(^TMP($J,"RCDPUREC","PP",0)) D
"RTN","RCDPAPLI",66,0)
 .   S RCLINE=RCLINE+1 D SET(" ",RCLINE,1,80)
"RTN","RCDPAPLI",67,0)
 .   S RCLINE=RCLINE+1 D SET("Pending Payments",RCLINE,1,80,0,IORVON,IORVOFF)
"RTN","RCDPAPLI",68,0)
 .   N %,DATA,DATE,RECEIPT,RECTDA,TRANDA,TYPE
"RTN","RCDPAPLI",69,0)
 .   S RECTDA=0 F  S RECTDA=$O(^TMP($J,"RCDPUREC","PP",RECTDA)) Q:'RECTDA  D
"RTN","RCDPAPLI",70,0)
 .   .   S RECEIPT=$P($G(^RCY(344,RECTDA,0)),"^")
"RTN","RCDPAPLI",71,0)
 .   .   S TYPE=$E($P($G(^RC(341.1,+$P(^RCY(344,RECTDA,0),"^",4),0)),"^"),1,14)
"RTN","RCDPAPLI",72,0)
 .   .   S TRANDA=0 F  S TRANDA=$O(^TMP($J,"RCDPUREC","PP",RECTDA,TRANDA)) Q:'TRANDA  D
"RTN","RCDPAPLI",73,0)
 .   .   .   S DATA=^TMP($J,"RCDPUREC","PP",RECTDA,TRANDA)
"RTN","RCDPAPLI",74,0)
 .   .   .   S RCLINE=RCLINE+1
"RTN","RCDPAPLI",75,0)
 .   .   .   D SET(RECEIPT_"/"_TRANDA,RCLINE,1,80)
"RTN","RCDPAPLI",76,0)
 .   .   .   S DATE=$P(DATA,"^",6)
"RTN","RCDPAPLI",77,0)
 .   .   .   S DATE=$E(DATE,4,5)_"/"_$E(DATE,6,7)_"/"_$E(DATE,2,3)
"RTN","RCDPAPLI",78,0)
 .   .   .   D SET(DATE,RCLINE,13,21)
"RTN","RCDPAPLI",79,0)
 .   .   .   ;  build type of payment display
"RTN","RCDPAPLI",80,0)
 .   .   .   S %=$E(TYPE_"              ",1,14)
"RTN","RCDPAPLI",81,0)
 .   .   .   I $P(DATA,"^",7)'="" S %=%_"/"_$P(DATA,"^",7)  ;  check #
"RTN","RCDPAPLI",82,0)
 .   .   .   I $P(DATA,"^",8)'="" S %=%_"/"_$P(DATA,"^",8)  ;  bank #
"RTN","RCDPAPLI",83,0)
 .   .   .   I $P(DATA,"^",2)'="" S %=%_"/"_$P(DATA,"^",2)  ;  confirmation
"RTN","RCDPAPLI",84,0)
 .   .   .   D SET(%,RCLINE,29,53)
"RTN","RCDPAPLI",85,0)
 .   .   .   ;  show amount paid
"RTN","RCDPAPLI",86,0)
 .   .   .   D SET($J($P(DATA,"^",4),9,2),RCLINE,53,62)
"RTN","RCDPAPLI",87,0)
 .   S RCLINE=RCLINE+1
"RTN","RCDPAPLI",88,0)
 .   D SET("                                                    ---------",RCLINE,1,80)
"RTN","RCDPAPLI",89,0)
 .   S RCLINE=RCLINE+1
"RTN","RCDPAPLI",90,0)
 .   D SET("   TOTAL PENDING PAYMENTS",RCLINE,1,80)
"RTN","RCDPAPLI",91,0)
 .   D SET($J($G(RCTOTAL("PP")),9,2),RCLINE,53,62)
"RTN","RCDPAPLI",92,0)
 .   K ^TMP($J,"RCDPUREC","PP")
"RTN","RCDPAPLI",93,0)
 ;
"RTN","RCDPAPLI",94,0)
 ;  dmc info
"RTN","RCDPAPLI",95,0)
 I $D(^RCD(340,"DMC",1,+RCDEBTDA)) D
"RTN","RCDPAPLI",96,0)
 .   S DMCDATA=$G(^RCD(340,+RCDEBTDA,3))
"RTN","RCDPAPLI",97,0)
 .   S RCLINE=RCLINE+1 D SET(" ",RCLINE,1,80)
"RTN","RCDPAPLI",98,0)
 .   S RCLINE=RCLINE+1
"RTN","RCDPAPLI",99,0)
 .   D SET("** Account forwarded to DMC: "_$S('$P(DMCDATA,"^",2):"",1:$$SLH^RCFN01($P(DMCDATA,"^",2))),RCLINE,1,80)
"RTN","RCDPAPLI",100,0)
 .   D SET("Total DMC Amount: "_$J($P(DMCDATA,"^",5),9,2),RCLINE,50,80)
"RTN","RCDPAPLI",101,0)
 .   I $P(DMCDATA,"^",9)'="" D
"RTN","RCDPAPLI",102,0)
 .   .   S RCLINE=RCLINE+1
"RTN","RCDPAPLI",103,0)
 .   .   D SET(" ",RCLINE,1,80)
"RTN","RCDPAPLI",104,0)
 .   .   D SET("Lesser Amt to DMC: "_$J($P(DMCDATA,"^",9),9,2),RCLINE,49,80)
"RTN","RCDPAPLI",105,0)
 ;   top info
"RTN","RCDPAPLI",106,0)
 I $D(^RCD(340,"TOP",+RCDEBTDA)) D
"RTN","RCDPAPLI",107,0)
 .   S TOP6=$G(^RCD(340,+RCDEBTDA,6)),TOP4=$G(^(4))
"RTN","RCDPAPLI",108,0)
 .   S RCLINE=RCLINE+1 D SET(" ",RCLINE,1,80)
"RTN","RCDPAPLI",109,0)
 .   S RCLINE=RCLINE+1
"RTN","RCDPAPLI",110,0)
 .   D SET("** Account forwarded to TOP: "_$S('$P(TOP6,"^"):"",1:$$SLH^RCFN01($P(TOP6,"^"))),RCLINE,1,80)
"RTN","RCDPAPLI",111,0)
 .   D SET("Total TOP Amount: "_$J($P(TOP4,"^",3),13,2),RCLINE,45,80)
"RTN","RCDPAPLI",112,0)
 .   I $P(TOP6,"^",6)'="" D
"RTN","RCDPAPLI",113,0)
 .   .   S RCLINE=RCLINE+1
"RTN","RCDPAPLI",114,0)
 .   .   D SET(" ",RCLINE,1,80)
"RTN","RCDPAPLI",115,0)
 .   .   D SET("TOP Hold Date: "_$$SLH^RCFN01($P(TOP6,"^",6)),RCLINE,45,80)
"RTN","RCDPAPLI",116,0)
 ;
"RTN","RCDPAPLI",117,0)
 ;  show if hurricane katrina vet
"RTN","RCDPAPLI",118,0)
 I $P(^RCD(340,+RCDEBTDA,0),U)["DPT(" S DFN=+^(0) D
"RTN","RCDPAPLI",119,0)
 .   Q:$$EMGRES^DGUTL(DFN)'["K"
"RTN","RCDPAPLI",120,0)
 .   S RCLINE=RCLINE+1
"RTN","RCDPAPLI",121,0)
 .   D SET("EMERGENCY RESPONSE INDICATOR: HURRICANE KATRINA",RCLINE,1,80)
"RTN","RCDPAPLI",122,0)
 ;
"RTN","RCDPAPLI",123,0)
 ;  show comments if they exist
"RTN","RCDPAPLI",124,0)
 I $O(^RCD(340,RCDEBTDA,2,0)) D
"RTN","RCDPAPLI",125,0)
 .   S RCLINE=RCLINE+1 D SET(" ",RCLINE,1,80)
"RTN","RCDPAPLI",126,0)
 .   S RCLINE=RCLINE+1 D SET("Comments",RCLINE,1,80,0,IOUON,IOUOFF)
"RTN","RCDPAPLI",127,0)
 .   S RCCOMM=0 F  S RCCOMM=$O(^RCD(340,RCDEBTDA,2,RCCOMM)) Q:'RCCOMM  D
"RTN","RCDPAPLI",128,0)
 .   .   S RCLINE=RCLINE+1 D SET(^RCD(340,RCDEBTDA,2,RCCOMM,0),RCLINE,1,80)
"RTN","RCDPAPLI",129,0)
 ;
"RTN","RCDPAPLI",130,0)
 K ^TMP("RCDPAPST",$J)
"RTN","RCDPAPLI",131,0)
 ;
"RTN","RCDPAPLI",132,0)
 ;  set valmcnt to number of lines in the list
"RTN","RCDPAPLI",133,0)
 S VALMCNT=RCLINE
"RTN","RCDPAPLI",134,0)
 D HDR^RCDPAPLM
"RTN","RCDPAPLI",135,0)
 Q
"RTN","RCDPAPLI",136,0)
 ;
"RTN","RCDPAPLI",137,0)
 ;
"RTN","RCDPAPLI",138,0)
SETBILL ;  set a bill on the listmanager line
"RTN","RCDPAPLI",139,0)
 N DATE,IBCNDATA,RCDPDATA,VALUE
"RTN","RCDPAPLI",140,0)
 D DIQ430^RCDPBPLM(RCBILLDA,".01;2;3;8;60;")
"RTN","RCDPAPLI",141,0)
 ;
"RTN","RCDPAPLI",142,0)
 S RCLINE=RCLINE+1
"RTN","RCDPAPLI",143,0)
 ;
"RTN","RCDPAPLI",144,0)
 ;  create an index array for bill lookup in list
"RTN","RCDPAPLI",145,0)
 S ^TMP("RCDPAPLM",$J,"IDX",RCLINE,RCLINE)=RCBILLDA
"RTN","RCDPAPLI",146,0)
 ;
"RTN","RCDPAPLI",147,0)
 ;  bill number
"RTN","RCDPAPLI",148,0)
 D SET(RCLINE,RCLINE,1,80,0,IORVON,IORVOFF)
"RTN","RCDPAPLI",149,0)
 D SET($E($P(RCDPDATA(430,RCBILLDA,.01,"E"),"-",2)_"       ",1,7),RCLINE,4,10,0)
"RTN","RCDPAPLI",150,0)
 ;
"RTN","RCDPAPLI",151,0)
 ;  get date of care
"RTN","RCDPAPLI",152,0)
 D DIQ399^RCXFMSUR(RCBILLDA)
"RTN","RCDPAPLI",153,0)
 S DATE=$G(IBCNDATA(399,RCBILLDA,151,"I"))
"RTN","RCDPAPLI",154,0)
 I 'DATE S DATE=$G(RCDPDATA(430,RCBILLDA,60,"I"))
"RTN","RCDPAPLI",155,0)
 S DATE=$E(DATE,4,5)_"/"_$E(DATE,6,7)_"/"_$E(DATE,2,3)
"RTN","RCDPAPLI",156,0)
 D SET(DATE,RCLINE,13,21,0)
"RTN","RCDPAPLI",157,0)
 ;
"RTN","RCDPAPLI",158,0)
 ;  status (field 8)
"RTN","RCDPAPLI",159,0)
 D SET("",RCLINE,23,26,8)
"RTN","RCDPAPLI",160,0)
 ;
"RTN","RCDPAPLI",161,0)
 ;  type of care
"RTN","RCDPAPLI",162,0)
 D SET("",RCLINE,29,71,2)
"RTN","RCDPAPLI",163,0)
 ;
"RTN","RCDPAPLI",164,0)
 ;  principle, interest, admin
"RTN","RCDPAPLI",165,0)
 D SET($J($P(RCDATA,"^"),9,2),RCLINE,53,62,0)
"RTN","RCDPAPLI",166,0)
 D SET($J($P(RCDATA,"^",2),9,2),RCLINE,62,71,0)
"RTN","RCDPAPLI",167,0)
 D SET($J($P(RCDATA,"^",3),9,2),RCLINE,71,80,0)
"RTN","RCDPAPLI",168,0)
 Q
"RTN","RCDPAPLI",169,0)
 ;
"RTN","RCDPAPLI",170,0)
 ;
"RTN","RCDPAPLI",171,0)
SET(STRING,LINE,COLBEG,COLEND,FIELD,ON,OFF) ;  set array
"RTN","RCDPAPLI",172,0)
 I $G(FIELD) S STRING=STRING_$S(STRING="":"",1:": ")_$G(RCDPDATA(430,RCBILLDA,FIELD,"E"))
"RTN","RCDPAPLI",173,0)
 I STRING="",'$G(FIELD) D SET^VALM10(LINE,$J("",80)) Q
"RTN","RCDPAPLI",174,0)
 I '$D(@VALMAR@(LINE,0)) D SET^VALM10(LINE,$J("",80))
"RTN","RCDPAPLI",175,0)
 D SET^VALM10(LINE,$$SETSTR^VALM1(STRING,@VALMAR@(LINE,0),COLBEG,COLEND-COLBEG+1))
"RTN","RCDPAPLI",176,0)
 I $G(ON)]""!($G(OFF)]"") D CNTRL^VALM10(LINE,COLBEG,$L(STRING),ON,OFF)
"RTN","RCDPAPLI",177,0)
 Q
"RTN","RCDPBPLM")
0^6^B53138816^B50396509
"RTN","RCDPBPLM",1,0)
RCDPBPLM ;WISC/RFJ - bill profile ;1 Jun 99
"RTN","RCDPBPLM",2,0)
 ;;4.5;Accounts Receivable;**114,153,159,241**;Mar 20, 1995
"RTN","RCDPBPLM",3,0)
 ;;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","RCDPBPLM",4,0)
 ;
"RTN","RCDPBPLM",5,0)
 ;
"RTN","RCDPBPLM",6,0)
 ;  called from menu option (19)
"RTN","RCDPBPLM",7,0)
 ;
"RTN","RCDPBPLM",8,0)
 N RCBILLDA,RCDPFXIT
"RTN","RCDPBPLM",9,0)
 ;
"RTN","RCDPBPLM",10,0)
 F  D  Q:'RCBILLDA
"RTN","RCDPBPLM",11,0)
 .   W !! S RCBILLDA=$$SELBILL^RCDPBTLM
"RTN","RCDPBPLM",12,0)
 .   I RCBILLDA<1 S RCBILLDA=0 Q
"RTN","RCDPBPLM",13,0)
 .   D EN^VALM("RCDP BILL PROFILE")
"RTN","RCDPBPLM",14,0)
 .   ;  fast exit
"RTN","RCDPBPLM",15,0)
 .   I $G(RCDPFXIT) S RCBILLDA=0
"RTN","RCDPBPLM",16,0)
 Q
"RTN","RCDPBPLM",17,0)
 ;
"RTN","RCDPBPLM",18,0)
 ;
"RTN","RCDPBPLM",19,0)
INIT ;  initialization for list manager list
"RTN","RCDPBPLM",20,0)
 ;  requires rcbillda
"RTN","RCDPBPLM",21,0)
 N BILLED,COMMDA,DATA,PAID,RCDPDATA,RCFYDA,RCLINE,REPTYPE,X1,X2,RCDEBTOR,DFN
"RTN","RCDPBPLM",22,0)
 K ^TMP("RCDPBPLM",$J),^TMP("VALM VIDEO",$J)
"RTN","RCDPBPLM",23,0)
 ;
"RTN","RCDPBPLM",24,0)
 ;  fast exit
"RTN","RCDPBPLM",25,0)
 I $G(RCDPFXIT) S VALMQUIT=1 Q
"RTN","RCDPBPLM",26,0)
 ;
"RTN","RCDPBPLM",27,0)
 D DIQ430(RCBILLDA,".01:300")
"RTN","RCDPBPLM",28,0)
 ;
"RTN","RCDPBPLM",29,0)
 ;  set the listmanager line number
"RTN","RCDPBPLM",30,0)
 S RCLINE=0
"RTN","RCDPBPLM",31,0)
 ;
"RTN","RCDPBPLM",32,0)
 S DATA=$$ACCNTHDR^RCDPAPLM(RCDPDATA(430,RCBILLDA,9,"I"))
"RTN","RCDPBPLM",33,0)
 S RCLINE=RCLINE+1 D SET("Account: "_$P(DATA,"^")_" "_$P(DATA,"^",2),RCLINE,1,80)
"RTN","RCDPBPLM",34,0)
 D SET($P(DATA,"^",3),RCLINE,60,80)
"RTN","RCDPBPLM",35,0)
 S %="" I $TR($P(DATA,"^",4,9),"^")'="" S %=$P(DATA,"^",4)_", "_$P(DATA,"^",7)_", "_$P(DATA,"^",8)_"  "_$P(DATA,"^",9)
"RTN","RCDPBPLM",36,0)
 S RCLINE=RCLINE+1 D SET("   Addr: "_%,RCLINE,1,80)
"RTN","RCDPBPLM",37,0)
 S RCLINE=RCLINE+1 D SET("  Phone: "_$P(DATA,"^",10),RCLINE,1,80)
"RTN","RCDPBPLM",38,0)
 S RCDEBTOR=$P(^PRCA(430,RCBILLDA,0),U,9)
"RTN","RCDPBPLM",39,0)
 I $P(^RCD(340,+RCDEBTOR,0),U)["DPT(" S DFN=+^(0) D
"RTN","RCDPBPLM",40,0)
 .   Q:$$EMGRES^DGUTL(DFN)'["K"
"RTN","RCDPBPLM",41,0)
 .   S RCLINE=RCLINE+1
"RTN","RCDPBPLM",42,0)
 .   D SET("EMERGENCY RESPONSE INDICATOR: HURRICANE KATRINA",RCLINE,1,80)
"RTN","RCDPBPLM",43,0)
 ;
"RTN","RCDPBPLM",44,0)
 ;  bill descriptive data
"RTN","RCDPBPLM",45,0)
 S RCLINE=RCLINE+1 D SET(" ",RCLINE,1,80)
"RTN","RCDPBPLM",46,0)
 S RCLINE=RCLINE+1 D SET("Bill Number",RCLINE,1,80,.01,IOUON,IOUOFF)
"RTN","RCDPBPLM",47,0)
 D SET("Category",RCLINE,40,80,2)
"RTN","RCDPBPLM",48,0)
 S RCLINE=RCLINE+1 D SET("Date  Prepared",RCLINE,1,80,10)
"RTN","RCDPBPLM",49,0)
 D SET("Status",RCLINE,42,80,8)
"RTN","RCDPBPLM",50,0)
 S RCLINE=RCLINE+1 D SET("Date Activated",RCLINE,1,80,60)
"RTN","RCDPBPLM",51,0)
 S RCLINE=RCLINE+1 D SET("Date Status Up",RCLINE,1,80,14)
"RTN","RCDPBPLM",52,0)
 D SET("By",RCLINE,46,80,17)
"RTN","RCDPBPLM",53,0)
 ;display TP bills Division of Care
"RTN","RCDPBPLM",54,0)
 I "T"=$P($G(^PRCA(430.2,+RCDPDATA(430,RCBILLDA,2,"I"),0)),"^",6) D
"RTN","RCDPBPLM",55,0)
 .S RCDIV=$$DIV^IBJDF2(RCBILLDA) I +RCDIV D
"RTN","RCDPBPLM",56,0)
 ..S RCDIV=$P($G(^DG(40.8,RCDIV,0)),U,1) I RCDIV="" Q
"RTN","RCDPBPLM",57,0)
 ..S RCLINE=RCLINE+1 D SET("Division of Care: "_RCDIV,RCLINE,1,80)
"RTN","RCDPBPLM",58,0)
 S RCLINE=RCLINE+1 D SET("Resulting From",RCLINE,1,80,4.5)
"RTN","RCDPBPLM",59,0)
 I RCDPDATA(430,RCBILLDA,15.1,"E")'="" D
"RTN","RCDPBPLM",60,0)
 .   S RCLINE=RCLINE+1 D SET("  Type of Care",RCLINE,1,80,15.1)
"RTN","RCDPBPLM",61,0)
 S RCLINE=RCLINE+1 D SET("        Remark",RCLINE,1,80,15)
"RTN","RCDPBPLM",62,0)
 ;  display comments if there
"RTN","RCDPBPLM",63,0)
 I $O(^PRCA(430,RCBILLDA,10,0)) D
"RTN","RCDPBPLM",64,0)
 .   S RCLINE=RCLINE+1 D SET("Comments:",RCLINE,1,80)
"RTN","RCDPBPLM",65,0)
 .   S COMMDA=0 F  S COMMDA=$O(^PRCA(430,RCBILLDA,10,COMMDA)) Q:'COMMDA  D
"RTN","RCDPBPLM",66,0)
 .   .   S RCLINE=RCLINE+1 D SET("  "_$G(^PRCA(430,RCBILLDA,10,COMMDA,0)),RCLINE,1,80)
"RTN","RCDPBPLM",67,0)
 ;
"RTN","RCDPBPLM",68,0)
 ;  int/adm rate and date
"RTN","RCDPBPLM",69,0)
 S RCLINE=RCLINE+1 D SET(" ",RCLINE,1,80)
"RTN","RCDPBPLM",70,0)
 S DATA=$$INT^RCMSFN01(RCDPDATA(430,RCBILLDA,10,"I"))
"RTN","RCDPBPLM",71,0)
 S Y=$P(DATA,"^",2) I Y D DD^%DT
"RTN","RCDPBPLM",72,0)
 S RCLINE=RCLINE+1 D SET("Interest Effective Rate Date: "_Y,RCLINE,1,80)
"RTN","RCDPBPLM",73,0)
 D SET(" Annual Rate: "_$P(DATA,"^"),RCLINE,55,80)
"RTN","RCDPBPLM",74,0)
 S DATA=$$ADM^RCMSFN01(RCDPDATA(430,RCBILLDA,10,"I"))
"RTN","RCDPBPLM",75,0)
 S Y=$P(DATA,"^",2) I Y D DD^%DT
"RTN","RCDPBPLM",76,0)
 S RCLINE=RCLINE+1 D SET("   Admin Effective Rate Date: "_Y,RCLINE,1,80)
"RTN","RCDPBPLM",77,0)
 D SET("Monthly Rate: "_$P(DATA,"^"),RCLINE,55,80)
"RTN","RCDPBPLM",78,0)
 S RCLINE=RCLINE+1 D SET("  Last Int/Admin Charge Date",RCLINE,1,80,67)
"RTN","RCDPBPLM",79,0)
 ;
"RTN","RCDPBPLM",80,0)
 ;  put bill balances on first line of second screen
"RTN","RCDPBPLM",81,0)
 F RCLINE=RCLINE+1:1:16 D SET(" ",RCLINE,1,80)
"RTN","RCDPBPLM",82,0)
 ;
"RTN","RCDPBPLM",83,0)
 ;  bill dollars
"RTN","RCDPBPLM",84,0)
 S RCLINE=RCLINE+1 D SET(" ",RCLINE,1,80)
"RTN","RCDPBPLM",85,0)
 S RCLINE=RCLINE+1 D SET("Bill Balances           Billed          Paid",RCLINE,1,80,0,IOUON,IOUOFF)
"RTN","RCDPBPLM",86,0)
 S RCLINE=RCLINE+1 D SET("     Principal: "_$J(RCDPDATA(430,RCBILLDA,71,"E"),14,2)_$J(RCDPDATA(430,RCBILLDA,77,"E"),14,2),RCLINE,1,80)
"RTN","RCDPBPLM",87,0)
 D SET("       Original Amt: "_$J(RCDPDATA(430,RCBILLDA,3,"E"),11,2),RCLINE,48,80)
"RTN","RCDPBPLM",88,0)
 S RCLINE=RCLINE+1 D SET("      Interest: "_$J(RCDPDATA(430,RCBILLDA,72,"E"),14,2)_$J(RCDPDATA(430,RCBILLDA,78,"E"),14,2),RCLINE,1,80)
"RTN","RCDPBPLM",89,0)
 I $G(RCDPDATA(430,RCBILLDA,131,"E")) D SET("Medicare Contr  Adj: "_$J(RCDPDATA(430,RCBILLDA,131,"E"),11,2),RCLINE,48,80)
"RTN","RCDPBPLM",90,0)
 I RCDPDATA(430,RCBILLDA,74,"E") D
"RTN","RCDPBPLM",91,0)
 .   S RCLINE=RCLINE+1 D SET("  Marshall Fee: "_$J(RCDPDATA(430,RCBILLDA,74,"E"),14,2)_$J(RCDPDATA(430,RCBILLDA,79.1,"E"),14,2),RCLINE,1,80)
"RTN","RCDPBPLM",92,0)
 I RCDPDATA(430,RCBILLDA,75,"E") D
"RTN","RCDPBPLM",93,0)
 .   S RCLINE=RCLINE+1 D SET("    Court Cost: "_$J(RCDPDATA(430,RCBILLDA,75,"E"),14,2),RCLINE,1,80)
"RTN","RCDPBPLM",94,0)
 S RCLINE=RCLINE+1 D SET("Administrative: "_$J(RCDPDATA(430,RCBILLDA,73,"E"),14,2)_$J(RCDPDATA(430,RCBILLDA,79,"E"),14,2),RCLINE,1,80,0,IOUON,IOUOFF)
"RTN","RCDPBPLM",95,0)
 I $G(RCDPDATA(430,RCBILLDA,132,"E")) D SET("Medicare Unreim Exp: "_$J(RCDPDATA(430,RCBILLDA,132,"E"),11,2),RCLINE,48,80)
"RTN","RCDPBPLM",96,0)
 ;  compute totals
"RTN","RCDPBPLM",97,0)
 S BILLED=0 F %=71,72,73,74,75 S BILLED=BILLED+RCDPDATA(430,RCBILLDA,%,"E")
"RTN","RCDPBPLM",98,0)
 S PAID=0 F %=77,78,79,79.1 S PAID=PAID+RCDPDATA(430,RCBILLDA,%,"E")
"RTN","RCDPBPLM",99,0)
 S RCLINE=RCLINE+1 D SET("       Current: "_$J(BILLED,14,2)_$J(PAID,14,2),RCLINE,1,80)
"RTN","RCDPBPLM",100,0)
 ;
"RTN","RCDPBPLM",101,0)
 ;  show refund if there
"RTN","RCDPBPLM",102,0)
 I RCDPDATA(430,RCBILLDA,79.18,"E") D
"RTN","RCDPBPLM",103,0)
 .   S RCLINE=RCLINE+1 D SET(" ",RCLINE,1,80)
"RTN","RCDPBPLM",104,0)
 .   S RCLINE=RCLINE+1 D SET("Refunded Amount",RCLINE,1,80,79.18)
"RTN","RCDPBPLM",105,0)
 .   D SET("Date",RCLINE,27,80,79.19)
"RTN","RCDPBPLM",106,0)
 .   D SET("By",RCLINE,50,80,79.21)
"RTN","RCDPBPLM",107,0)
 ;
"RTN","RCDPBPLM",108,0)
 ;  accounting data
"RTN","RCDPBPLM",109,0)
 S RCLINE=RCLINE+1 D SET(" ",RCLINE,1,80)
"RTN","RCDPBPLM",110,0)
 S RCLINE=RCLINE+1 D SET("Accounting Data",RCLINE,1,80,0,IOUON,IOUOFF)
"RTN","RCDPBPLM",111,0)
 ;  fiscal year multiple
"RTN","RCDPBPLM",112,0)
 D SET("Fiscal Year",RCLINE,20,32,0,IOUON,IOUOFF)
"RTN","RCDPBPLM",113,0)
 D SET("Approp Code",RCLINE,34,46,0,IOUON,IOUOFF)
"RTN","RCDPBPLM",114,0)
 D SET("Amount",RCLINE,50,60,0,IOUON,IOUOFF)
"RTN","RCDPBPLM",115,0)
 S RCFYDA=0 F  S RCFYDA=$O(^PRCA(430,RCBILLDA,2,RCFYDA)) Q:'RCFYDA  D
"RTN","RCDPBPLM",116,0)
 .   S DATA=$G(^PRCA(430,RCBILLDA,2,RCFYDA,0))
"RTN","RCDPBPLM",117,0)
 .   S RCLINE=RCLINE+1
"RTN","RCDPBPLM",118,0)
 .   D SET($J($P(DATA,"^"),30),RCLINE,1,80)     ;fiscal year
"RTN","RCDPBPLM",119,0)
 .   D SET($J(RCDPDATA(430,RCBILLDA,203,"E"),6),RCLINE,39,45) ;fund
"RTN","RCDPBPLM",120,0)
 .   D SET($J($P(DATA,"^",2),8,2),RCLINE,48,80)   ;amount
"RTN","RCDPBPLM",121,0)
 ;  determine which rsc to display
"RTN","RCDPBPLM",122,0)
 S %=RCDPDATA(430,RCBILLDA,255.1,"E") I %="" S %=RCDPDATA(430,RCBILLDA,255,"E")
"RTN","RCDPBPLM",123,0)
 S RCLINE=RCLINE+1 D SET("Rev Srce Code: "_%,RCLINE,1,80)
"RTN","RCDPBPLM",124,0)
 ;
"RTN","RCDPBPLM",125,0)
 ;  collection data
"RTN","RCDPBPLM",126,0)
 S RCLINE=RCLINE+1 D SET(" ",RCLINE,1,80)
"RTN","RCDPBPLM",127,0)
 S RCLINE=RCLINE+1 D SET("Collection Follow up Data",RCLINE,1,80,0,IOUON,IOUOFF)
"RTN","RCDPBPLM",128,0)
 S RCLINE=RCLINE+1 D SET("        Letter1",RCLINE,1,80,61)
"RTN","RCDPBPLM",129,0)
 S RCLINE=RCLINE+1 D SET("        Letter2",RCLINE,1,80,62)
"RTN","RCDPBPLM",130,0)
 S RCLINE=RCLINE+1 D SET("        Letter3",RCLINE,1,80,63)
"RTN","RCDPBPLM",131,0)
 S RCLINE=RCLINE+1 D SET("        Letter4",RCLINE,1,80,68)
"RTN","RCDPBPLM",132,0)
 I RCDPDATA(430,RCBILLDA,68.6,"I") D
"RTN","RCDPBPLM",133,0)
 .   S RCLINE=RCLINE+1 D SET("     IRS Letter",RCLINE,1,80,68.6)
"RTN","RCDPBPLM",134,0)
 .   D SET("Amount",RCLINE,65,80,68.93)
"RTN","RCDPBPLM",135,0)
 I RCDPDATA(430,RCBILLDA,64,"I") D
"RTN","RCDPBPLM",136,0)
 .   S RCLINE=RCLINE+1 D SET("DC/DOJ Ref Date",RCLINE,1,80,64)
"RTN","RCDPBPLM",137,0)
 .   D SET("To",RCLINE,40,80,65)
"RTN","RCDPBPLM",138,0)
 .   D SET("Amount",RCLINE,65,80,66)
"RTN","RCDPBPLM",139,0)
 ;
"RTN","RCDPBPLM",140,0)
 ;  repayment plan (show only if there)
"RTN","RCDPBPLM",141,0)
 I RCDPDATA(430,RCBILLDA,41,"I") D REPAY^RCDPBPLI
"RTN","RCDPBPLM",142,0)
 ;
"RTN","RCDPBPLM",143,0)
 ;  irs data (show only if there)
"RTN","RCDPBPLM",144,0)
 I RCDPDATA(430,RCBILLDA,68.7,"I") D IRS^RCDPBPLI
"RTN","RCDPBPLM",145,0)
 ;
"RTN","RCDPBPLM",146,0)
 ;  dmc data (show only if there)
"RTN","RCDPBPLM",147,0)
 I RCDPDATA(430,RCBILLDA,121,"I") D DMC^RCDPBPLI
"RTN","RCDPBPLM",148,0)
 ;
"RTN","RCDPBPLM",149,0)
 ;  top data (show only if there)
"RTN","RCDPBPLM",150,0)
 I $G(RCDPDATA(430,RCBILLDA,141,"I")) D TOP^RCDPBPLI
"RTN","RCDPBPLM",151,0)
 ;
"RTN","RCDPBPLM",152,0)
 ;  get the report type based on category.  if third party show
"RTN","RCDPBPLM",153,0)
 ;  insurance data
"RTN","RCDPBPLM",154,0)
 S REPTYPE=$P($G(^PRCA(430.2,+RCDPDATA(430,RCBILLDA,2,"I"),0)),"^",6)
"RTN","RCDPBPLM",155,0)
 I REPTYPE="T" D INSUR^RCDPBPLI
"RTN","RCDPBPLM",156,0)
 ;
"RTN","RCDPBPLM",157,0)
 ;  report type for employee or vendor, show description field 106
"RTN","RCDPBPLM",158,0)
 I REPTYPE="O"!(REPTYPE="V") D INIT^RCDPBPLI
"RTN","RCDPBPLM",159,0)
 ;
"RTN","RCDPBPLM",160,0)
 ;  show transactions and reasons
"RTN","RCDPBPLM",161,0)
 D TRANINIT^RCDPBPLI
"RTN","RCDPBPLM",162,0)
 ;
"RTN","RCDPBPLM",163,0)
 ;  set valmcnt to number of lines in the list
"RTN","RCDPBPLM",164,0)
 S VALMCNT=RCLINE
"RTN","RCDPBPLM",165,0)
 D HDR
"RTN","RCDPBPLM",166,0)
 Q
"RTN","RCDPBPLM",167,0)
 ;
"RTN","RCDPBPLM",168,0)
 ;
"RTN","RCDPBPLM",169,0)
HDR ;  header code for list manager display
"RTN","RCDPBPLM",170,0)
 ;  requires rcbillda
"RTN","RCDPBPLM",171,0)
 S VALMHDR(1)="***** ACCOUNTS RECEIVABLE BILL PROFILE FOR "_$P($G(^PRCA(430,RCBILLDA,0)),"^")_" *****"
"RTN","RCDPBPLM",172,0)
 Q
"RTN","RCDPBPLM",173,0)
 ;
"RTN","RCDPBPLM",174,0)
 ;
"RTN","RCDPBPLM",175,0)
EXIT ;  exit list manager option and clean up
"RTN","RCDPBPLM",176,0)
 K ^TMP("RCDPBPLM",$J)
"RTN","RCDPBPLM",177,0)
 Q
"RTN","RCDPBPLM",178,0)
 ;
"RTN","RCDPBPLM",179,0)
 ;
"RTN","RCDPBPLM",180,0)
SET(STRING,LINE,COLBEG,COLEND,FIELD,ON,OFF) ;  set array
"RTN","RCDPBPLM",181,0)
 I $G(FIELD) S STRING=STRING_$S(STRING="":"",1:": ")_$G(RCDPDATA(430,RCBILLDA,FIELD,"E"))
"RTN","RCDPBPLM",182,0)
 I STRING="",'$G(FIELD) Q
"RTN","RCDPBPLM",183,0)
 I '$D(@VALMAR@(LINE,0)) D SET^VALM10(LINE,$J("",80))
"RTN","RCDPBPLM",184,0)
 D SET^VALM10(LINE,$$SETSTR^VALM1(STRING,@VALMAR@(LINE,0),COLBEG,COLEND-COLBEG+1))
"RTN","RCDPBPLM",185,0)
 I $G(ON)]""!($G(OFF)]"") D CNTRL^VALM10(LINE,COLBEG,$L(STRING),ON,OFF)
"RTN","RCDPBPLM",186,0)
 Q
"RTN","RCDPBPLM",187,0)
 ;
"RTN","RCDPBPLM",188,0)
 ;
"RTN","RCDPBPLM",189,0)
DIQ430(DA,DR) ;  diq call to retrieve data for dr fields in file 430
"RTN","RCDPBPLM",190,0)
 N D0,DIC,DIQ,DIQ2
"RTN","RCDPBPLM",191,0)
 K RCDPDATA(430,DA)
"RTN","RCDPBPLM",192,0)
 S DIQ(0)="IE",DIC="^PRCA(430,",DIQ="RCDPDATA" D EN^DIQ1
"RTN","RCDPBPLM",193,0)
 Q
"RTN","RCEXINAD")
0^9^B28426860^B27913240
"RTN","RCEXINAD",1,0)
RCEXINAD ;ALB/MAF - Exempt int/admin for Katrina victims from 9/1/05 - patch install;3 Oct 05
"RTN","RCEXINAD",2,0)
 ;;4.5;Accounts Receivable;**237,241**;Mar 20, 1995
"RTN","RCEXINAD",3,0)
 ;;
"RTN","RCEXINAD",4,0)
 ;
"RTN","RCEXINAD",5,0)
START ;
"RTN","RCEXINAD",6,0)
 N ADMIN,BILLDA,DATE,INTEREST,PRINBAL,TRANDA,TRANTYPE,VALUE,RCNOHSIF,RCDFN,DATEEND,RCDEB,X
"RTN","RCEXINAD",7,0)
 ;  needs datebeg, dateend
"RTN","RCEXINAD",8,0)
 ;  total is total by category
"RTN","RCEXINAD",9,0)
 ;
"RTN","RCEXINAD",10,0)
 ;
"RTN","RCEXINAD",11,0)
 S RCNOHSIF=$$NOHSIF^RCRJRCO() ; no HSIF (disabled)
"RTN","RCEXINAD",12,0)
 ;
"RTN","RCEXINAD",13,0)
 K ^TMP("RCINTADM",$J)
"RTN","RCEXINAD",14,0)
 F TRANTYPE=13 D
"RTN","RCEXINAD",15,0)
 .   S DATE=3050901-1,DATEEND=9999999
"RTN","RCEXINAD",16,0)
 .   F  S DATE=$O(^PRCA(433,"AT",TRANTYPE,DATE)) Q:'DATE!(DATE>DATEEND)  D
"RTN","RCEXINAD",17,0)
 .   .   S TRANDA=0
"RTN","RCEXINAD",18,0)
 .   .   F  S TRANDA=$O(^PRCA(433,"AT",TRANTYPE,DATE,TRANDA)) Q:'TRANDA  D
"RTN","RCEXINAD",19,0)
 .   .   .   S BILLDA=+$P($G(^PRCA(433,TRANDA,0)),"^",2) I 'BILLDA Q
"RTN","RCEXINAD",20,0)
 .   .   .   ;  bill not linked to a site
"RTN","RCEXINAD",21,0)
 .   .   .   I '$P($G(^PRCA(430,BILLDA,0)),"^",12) Q
"RTN","RCEXINAD",22,0)
 .   .   .   S RCDEB=$P($G(^PRCA(430,BILLDA,0)),"^",9) Q:'+RCDEB  D  Q:'+RCDFN
"RTN","RCEXINAD",23,0)
 .   .   .   .   S RCDFN=0
"RTN","RCEXINAD",24,0)
 .   .   .   .   Q:$P($G(^RCD(340,+RCDEB,0)),"^",1)'["DPT"
"RTN","RCEXINAD",25,0)
 .   .   .   .   S RCDFN=+$P($G(^RCD(340,+RCDEB,0)),"^",1)
"RTN","RCEXINAD",26,0)
 .   .   .   .   Q
"RTN","RCEXINAD",27,0)
 .   .   .   ;Check if emergency response victim
"RTN","RCEXINAD",28,0)
 .   .   .   I $$EMERES^PRCAUTL(+RCDFN)']"" Q
"RTN","RCEXINAD",29,0)
 .   .   .   Q:$P($G(^RCD(340,+RCDEB,0)),"^",8)  ; already exempted
"RTN","RCEXINAD",30,0)
 .   .   .   S ^TMP("RCINTADM",$J,RCDFN,BILLDA)=""
"RTN","RCEXINAD",31,0)
 .   .   .   Q
"RTN","RCEXINAD",32,0)
 I '$D(^TMP("RCINTADM",$J)) Q
"RTN","RCEXINAD",33,0)
 N BILLDA,RCDFN,PAYDAT
"RTN","RCEXINAD",34,0)
 S (RCDFN,BILLDA)=0,PAYDAT=3050901
"RTN","RCEXINAD",35,0)
 F  S RCDFN=$O(^TMP("RCINTADM",$J,RCDFN)) Q:RCDFN']""  F  S BILLDA=$O(^TMP("RCINTADM",$J,RCDFN,BILLDA)) Q:BILLDA']""  D EXEMPT(BILLDA,PAYDAT)
"RTN","RCEXINAD",36,0)
 Q
"RTN","RCEXINAD",37,0)
 ;
"RTN","RCEXINAD",38,0)
 ;
"RTN","RCEXINAD",39,0)
EXEMPT(RCBILLDA,RCPAYDAT) ;  exempt interest/admin/penalty charges
"RTN","RCEXINAD",40,0)
 ;  added after the payment date
"RTN","RCEXINAD",41,0)
 N ADMIN,BILLBAL,COMMENT,INTEREST,PENALTY,RCDATE,RCEXTRAN,RCFLAG,RCLIST,RCTRANDA,TRANDA,DATE,RCEND,RCEXEM
"RTN","RCEXINAD",42,0)
 ;
"RTN","RCEXINAD",43,0)
 S BILLBAL=$$GETTRANS^RCDPBTLM(RCBILLDA)
"RTN","RCEXINAD",44,0)
 ;  no interest or admin to exempt
"RTN","RCEXINAD",45,0)
 I ($P(BILLBAL,"^",2)+$P(BILLBAL,"^",3))=0 Q
"RTN","RCEXINAD",46,0)
 ;  loop thru transactions after payment date and look for
"RTN","RCEXINAD",47,0)
 ;  interest/admin charge transactions to exempt
"RTN","RCEXINAD",48,0)
 S RCDATE=RCPAYDAT-.1
"RTN","RCEXINAD",49,0)
 ;set an end date so that no transactions beyond the emergency response end date are exempted
"RTN","RCEXINAD",50,0)
 S X=$P($G(^RC(342,1,30)),"^",2)
"RTN","RCEXINAD",51,0)
 S RCEND=$S('X:DT,DT<X:DT,1:X)
"RTN","RCEXINAD",52,0)
 F  S RCDATE=$O(RCLIST(RCDATE)) Q:'RCDATE!(RCDATE>RCEND)  D
"RTN","RCEXINAD",53,0)
 .   S RCTRANDA=0
"RTN","RCEXINAD",54,0)
 .   F  S RCTRANDA=$O(RCLIST(RCDATE,RCTRANDA)) Q:'RCTRANDA  D
"RTN","RCEXINAD",55,0)
 .   .   I RCLIST(RCDATE,RCTRANDA)'["INTEREST/ADM. CHARGE" Q
"RTN","RCEXINAD",56,0)
 .   .   ;  interest/admin/penalty charge added after payment date
"RTN","RCEXINAD",57,0)
 .   .   ;  exempt the charge
"RTN","RCEXINAD",58,0)
 .   .   ;
"RTN","RCEXINAD",59,0)
 .   .   ;  check to see if charge is already exempted
"RTN","RCEXINAD",60,0)
 .   .   ;  the charge would be on the same date
"RTN","RCEXINAD",61,0)
 .   .   ;  for example:
"RTN","RCEXINAD",62,0)
 .   .   ;    rclist(3000424,2742117)=INTEREST/ADM. CHARGE^^ .68^ .45^0^0
"RTN","RCEXINAD",63,0)
 .   .   ;    rclist(3000424,2750151)=EXEMPT INT/ADM. COST^^-.68^-.45^0^0
"RTN","RCEXINAD",64,0)
 .   .   S RCFLAG=0
"RTN","RCEXINAD",65,0)
 .   .   S TRANDA=RCTRANDA,DATE=RCDATE-.1
"RTN","RCEXINAD",66,0)
 .   .   F  S DATE=$O(RCLIST(DATE)) Q:'DATE!(RCFLAG)  F  S TRANDA=$O(RCLIST(DATE,TRANDA)) Q:'TRANDA!(RCFLAG)  D  I RCFLAG Q
"RTN","RCEXINAD",67,0)
 .   .   .   I RCLIST(DATE,TRANDA)'["EXEMPT INT/ADM. COST" Q
"RTN","RCEXINAD",68,0)
 .   .   .   ;skip exemption if it has already been matched with another interest charge
"RTN","RCEXINAD",69,0)
 .   .   .   Q:$D(RCEXEM(TRANDA))
"RTN","RCEXINAD",70,0)
 .   .   .   ;  compare interest values (p3) and admin (p4)
"RTN","RCEXINAD",71,0)
 .   .   .   I +$P(RCLIST(RCDATE,RCTRANDA),"^",3)'=-$P(RCLIST(DATE,TRANDA),"^",3) Q
"RTN","RCEXINAD",72,0)
 .   .   .   I +$P(RCLIST(RCDATE,RCTRANDA),"^",4)'=-$P(RCLIST(DATE,TRANDA),"^",4) Q
"RTN","RCEXINAD",73,0)
 .   .   .   ;  transaction already exempted; save transaction as one already matched
"RTN","RCEXINAD",74,0)
 .   .   .   S RCFLAG=1,RCEXEM(TRANDA)=""
"RTN","RCEXINAD",75,0)
 .   .   I $G(RCFLAG) Q
"RTN","RCEXINAD",76,0)
 .   .   ;
"RTN","RCEXINAD",77,0)
 .   .   S INTEREST=$P(RCLIST(RCDATE,RCTRANDA),"^",3)
"RTN","RCEXINAD",78,0)
 .   .   S ADMIN=$P(RCLIST(RCDATE,RCTRANDA),"^",4)
"RTN","RCEXINAD",79,0)
 .   .   I 'INTEREST,'ADMIN Q
"RTN","RCEXINAD",80,0)
 .   .   ;
"RTN","RCEXINAD",81,0)
 .   .   ;  check to make sure the amount being exempted does not
"RTN","RCEXINAD",82,0)
 .   .   ;  exceed the balance of the bill
"RTN","RCEXINAD",83,0)
 .   .   I INTEREST>$P(BILLBAL,"^",2) Q
"RTN","RCEXINAD",84,0)
 .   .   I ADMIN>$P(BILLBAL,"^",3) Q
"RTN","RCEXINAD",85,0)
 .   .   ;
"RTN","RCEXINAD",86,0)
 .   .   ;  get the penalty charge from the transaction.  this charge is computed in the
"RTN","RCEXINAD",87,0)
 .   .   ;  admin value, so subtract it from admin
"RTN","RCEXINAD",88,0)
 .   .   S PENALTY=$P($G(^PRCA(433,RCTRANDA,2)),"^",9)
"RTN","RCEXINAD",89,0)
 .   .   I PENALTY S ADMIN=ADMIN-PENALTY S:ADMIN<0 ADMIN=0
"RTN","RCEXINAD",90,0)
 .   .   ;
"RTN","RCEXINAD",91,0)
 .   .   ;  add the exempt transaction to file 433 with the date
"RTN","RCEXINAD",92,0)
 .   .   ;  equal to the date the int/admin charge created
"RTN","RCEXINAD",93,0)
 .   .   S COMMENT(1)="Auto exemption of "_RCTRANDA_", charges applied "_$S(RCDATE=RCPAYDAT:"on ",1:"after ")_$$FORMATDT^RCBECHGA(RCPAYDAT)_" for Hurricane Katrina victims."
"RTN","RCEXINAD",94,0)
 .   .   ;  make sure the time is entered for date processed in file 433 1;9
"RTN","RCEXINAD",95,0)
 .   .   ;  if not, it will show as being out of balance on patient statement
"RTN","RCEXINAD",96,0)
 .   .   ;  this was added for patch 162.
"RTN","RCEXINAD",97,0)
 .   .   ;
"RTN","RCEXINAD",98,0)
 .   .   ;  patch 165 removed the process date passed so the current date
"RTN","RCEXINAD",99,0)
 .   .   ;  and time would be used.  this will prevent statements from
"RTN","RCEXINAD",100,0)
 .   .   ;  being out of balance.
"RTN","RCEXINAD",101,0)
 .   .   ;N %,%H,%I,PROCDATE
"RTN","RCEXINAD",102,0)
 .   .   ;D NOW^%DTC S PROCDATE=$P(RCDATE,".")_"."_$P(%,".",2)
"RTN","RCEXINAD",103,0)
 .   .   S RCEXTRAN=$$EXEMPT^RCBEUTR2(RCBILLDA,INTEREST_"^"_ADMIN_"^"_PENALTY,.COMMENT,0)
"RTN","RCEXINAD",104,0)
 Q
"RTN","RCKATP")
0^10^B52172732
"RTN","RCKATP",1,0)
RCKATP ;ALB/CPM - ADJUST ACCOUNTS FOR KATRINA VETS ; 28-FEB-06
"RTN","RCKATP",2,0)
 ;;4.5;Accounts Receivable;**241**;Mar 20, 1995
"RTN","RCKATP",3,0)
 ;;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","RCKATP",4,0)
 Q
"RTN","RCKATP",5,0)
 ;
"RTN","RCKATP",6,0)
 ;
"RTN","RCKATP",7,0)
POST ; Queue PRCA*4.5*241 post-init job.
"RTN","RCKATP",8,0)
 ;
"RTN","RCKATP",9,0)
 D BMES^XPDUTL(">>> Queuing the post-initialization to run now...")
"RTN","RCKATP",10,0)
 S ZTDTH=$H,ZTRTN="EN^RCKATP",ZTIO=""
"RTN","RCKATP",11,0)
 S ZTDESC="RC - PATCH PRCA*4.5*241 POST INITIALIZATION"
"RTN","RCKATP",12,0)
 D ^%ZTLOAD
"RTN","RCKATP",13,0)
 I $D(ZTSK) D MES^XPDUTL(" >> Queued as task #"_ZTSK_".")
"RTN","RCKATP",14,0)
 I '$D(ZTSK) D MES^XPDUTL(" >> Unable to queue task - contact EVS.")
"RTN","RCKATP",15,0)
 K ZTDTH,ZTRTN,ZTDESC,ZTSK,ZTIO
"RTN","RCKATP",16,0)
 Q
"RTN","RCKATP",17,0)
 ;
"RTN","RCKATP",18,0)
 ;
"RTN","RCKATP",19,0)
EN ; Queued entry point to run the PRCA*4.5*241 post init.
"RTN","RCKATP",20,0)
 ;
"RTN","RCKATP",21,0)
 D EX ;                    exempt interest - return RCTOTAL
"RTN","RCKATP",22,0)
 ;
"RTN","RCKATP",23,0)
 S RCRES=$$CAN^IBAKAT() ;  cancel copay charges
"RTN","RCKATP",24,0)
 ;
"RTN","RCKATP",25,0)
 D BULL ;                  generate bulletin with results
"RTN","RCKATP",26,0)
 ;
"RTN","RCKATP",27,0)
 I $D(ZTQUEUED) S ZTREQ="@"
"RTN","RCKATP",28,0)
 K RCTOTAL,RCRES
"RTN","RCKATP",29,0)
 Q
"RTN","RCKATP",30,0)
 ;
"RTN","RCKATP",31,0)
 ;
"RTN","RCKATP",32,0)
EX ; Entry point to exempt interest/admin charges
"RTN","RCKATP",33,0)
 ;
"RTN","RCKATP",34,0)
 ; - get all 'Katrina' vets based on interest/admin charges 
"RTN","RCKATP",35,0)
 K ^TMP("RCKATP",$J)
"RTN","RCKATP",36,0)
 S RCCOM(1)="INTEREST ADJUSTMENT FOR HURRICANE KATRINA VETERAN"
"RTN","RCKATP",37,0)
 S RCD=3050828.9
"RTN","RCKATP",38,0)
 F  S RCD=$O(^PRCA(433,"AT",13,RCD)) Q:'RCD!($P(RCD,".")>3060430)  D
"RTN","RCKATP",39,0)
 .S RCT=0 F  S RCT=$O(^PRCA(433,"AT",13,RCD,RCT)) Q:'RCT  D
"RTN","RCKATP",40,0)
 ..S RCB=+$P($G(^PRCA(433,RCT,0)),"^",2) Q:'RCB
"RTN","RCKATP",41,0)
 ..I '$P($G(^PRCA(430,RCB,0)),"^",12) Q
"RTN","RCKATP",42,0)
 ..S RCDPT=+$P($G(^PRCA(430,RCB,0)),"^",9)
"RTN","RCKATP",43,0)
 ..S RCDEB=$G(^RCD(340,RCDPT,0))
"RTN","RCKATP",44,0)
 ..Q:$P(RCDEB,"^")'["DPT"  Q:'RCDEB
"RTN","RCKATP",45,0)
 ..Q:$$EMERES^PRCAUTL(+RCDEB)=""
"RTN","RCKATP",46,0)
 ..Q:$P(RCDEB,"^",8)  ;    vet has been already been processed
"RTN","RCKATP",47,0)
 ..;
"RTN","RCKATP",48,0)
 ..; - store the vet and bill
"RTN","RCKATP",49,0)
 ..S ^TMP("RCKATP",$J,RCDPT,RCB)=""
"RTN","RCKATP",50,0)
 ;
"RTN","RCKATP",51,0)
 ; - look for extra interest exemptions to create
"RTN","RCKATP",52,0)
 S RCTOTAL="0^0"
"RTN","RCKATP",53,0)
 S RCDEB=0 F  S RCDEB=$O(^TMP("RCKATP",$J,RCDEB)) Q:'RCDEB  D
"RTN","RCKATP",54,0)
 .;
"RTN","RCKATP",55,0)
 .; - initialize bucket and new patient flag
"RTN","RCKATP",56,0)
 .S (RCBUCK,RCNEWP)=0
"RTN","RCKATP",57,0)
 .S RCB=0 F  S RCB=$O(^TMP("RCKATP",$J,RCDEB,RCB)) Q:'RCB  D
"RTN","RCKATP",58,0)
 ..;
"RTN","RCKATP",59,0)
 ..; - review transactions to find interest added/exempted
"RTN","RCKATP",60,0)
 ..S RCCB=$$GETTRANS^RCDPBTLM(RCB),RCH=0,RCHOLD=""
"RTN","RCKATP",61,0)
 ..S RCDT=3050828.9 F  S RCDT=$O(RCLIST(RCDT)) Q:'RCDT  D
"RTN","RCKATP",62,0)
 ...S RCT=0 F  S RCT=$O(RCLIST(RCDT,RCT)) Q:'RCT  D
"RTN","RCKATP",63,0)
 ....S RCV=RCLIST(RCDT,RCT)
"RTN","RCKATP",64,0)
 ....;
"RTN","RCKATP",65,0)
 ....; - if transaction is an interest charge, save off amount
"RTN","RCKATP",66,0)
 ....I RCV["INTEREST/ADM. CHARGE",RCDT<3060501 S RCH=1 D  Q
"RTN","RCKATP",67,0)
 .....S $P(RCHOLD,"^")=$P(RCHOLD,"^")+$P(RCV,"^",3)
"RTN","RCKATP",68,0)
 .....S $P(RCHOLD,"^",2)=$P(RCHOLD,"^",2)+$P(RCV,"^",4)
"RTN","RCKATP",69,0)
 ....;
"RTN","RCKATP",70,0)
 ....; - if transaction is an interest exemption, save off (+) amount
"RTN","RCKATP",71,0)
 ....I RCV["EXEMPT INT/ADM. COST",RCH D  Q
"RTN","RCKATP",72,0)
 .....S $P(RCHOLD,"^",3)=$P(RCHOLD,"^",3)-$P(RCV,"^",3)
"RTN","RCKATP",73,0)
 .....S $P(RCHOLD,"^",4)=$P(RCHOLD,"^",4)-$P(RCV,"^",4)
"RTN","RCKATP",74,0)
 ..;
"RTN","RCKATP",75,0)
 ..; - get total amounts of interest added and exempted
"RTN","RCKATP",76,0)
 ..S RCINT=$P(RCHOLD,"^")+$P(RCHOLD,"^",2)
"RTN","RCKATP",77,0)
 ..S RCEXEM=$P(RCHOLD,"^",3)+$P(RCHOLD,"^",4)
"RTN","RCKATP",78,0)
 ..;
"RTN","RCKATP",79,0)
 ..; - quit if interest added less than or equal to exemptions
"RTN","RCKATP",80,0)
 ..S RCAPPLY=RCINT-RCEXEM
"RTN","RCKATP",81,0)
 ..Q:RCAPPLY'>0
"RTN","RCKATP",82,0)
 ..;
"RTN","RCKATP",83,0)
 ..; - get bill's interest balance
"RTN","RCKATP",84,0)
 ..S RCNEWP=1
"RTN","RCKATP",85,0)
 ..S X=$G(^PRCA(430,RCB,7)),RCINTB=$P(X,"^",2)+$P(X,"^",3)
"RTN","RCKATP",86,0)
 ..;
"RTN","RCKATP",87,0)
 ..; - if no balance, put in bucket and quit
"RTN","RCKATP",88,0)
 ..I 'RCINTB S RCBUCK=RCBUCK+RCAPPLY Q
"RTN","RCKATP",89,0)
 ..;
"RTN","RCKATP",90,0)
 ..; - adjust bucket and amount to apply
"RTN","RCKATP",91,0)
 ..S RCAMT=$S(RCAPPLY'<RCINTB:RCINTB,1:RCAPPLY)
"RTN","RCKATP",92,0)
 ..S RCBUCK=$S(RCAPPLY>RCINTB:RCBUCK+(RCAPPLY-RCINTB),1:RCBUCK)
"RTN","RCKATP",93,0)
 ..;
"RTN","RCKATP",94,0)
 ..; - will apply RCAMT - spread over admin then interest.
"RTN","RCKATP",95,0)
 ..S RCAPA=$S(RCAMT'<$P(X,"^",3):$P(X,"^",3),1:RCAMT)
"RTN","RCKATP",96,0)
 ..S RCAPI=RCAMT-RCAPA
"RTN","RCKATP",97,0)
 ..S RC=$$EXEMPT^RCBEUTR2(RCB,RCAPI_"^"_RCAPA,.RCCOM,0)
"RTN","RCKATP",98,0)
 ..;
"RTN","RCKATP",99,0)
 ..; - update total amount exempted
"RTN","RCKATP",100,0)
 ..S $P(RCTOTAL,"^",2)=$P(RCTOTAL,"^",2)+RCAMT
"RTN","RCKATP",101,0)
 .;
"RTN","RCKATP",102,0)
 .;
"RTN","RCKATP",103,0)
 .; - set debtor as having been processed
"RTN","RCKATP",104,0)
 .S $P(^RCD(340,RCDEB,0),"^",8)=1
"RTN","RCKATP",105,0)
 .;
"RTN","RCKATP",106,0)
 .; - if an amount is left in the bucket, process it,
"RTN","RCKATP",107,0)
 .;   update total exempted, and the number of vets exempted
"RTN","RCKATP",108,0)
 .I RCBUCK D
"RTN","RCKATP",109,0)
 ..D EN^RCKATPD($P($G(^RCD(340,RCDEB,0)),"^"),RCBUCK,RCCOM(1))
"RTN","RCKATP",110,0)
 ..S $P(RCTOTAL,"^",2)=$P(RCTOTAL,"^",2)+RCBUCK
"RTN","RCKATP",111,0)
 .I RCNEWP S $P(RCTOTAL,"^")=$P(RCTOTAL,"^")+1
"RTN","RCKATP",112,0)
 ;
"RTN","RCKATP",113,0)
 ;
"RTN","RCKATP",114,0)
 K ^TMP("RCKATP",$J)
"RTN","RCKATP",115,0)
 K RCD,RCT,RCB,RCDPT,RCDEB,RCBUCK,RCNEWP,RC,RCCB,RCH,RCHOLD,RCDT
"RTN","RCKATP",116,0)
 K RCLIST,RCV,RCINT,RCINTB,RCEXEM,RCAPPLY,RCAMT,RCAPA,RCAPI,RCCOM,X
"RTN","RCKATP",117,0)
 Q
"RTN","RCKATP",118,0)
 ;
"RTN","RCKATP",119,0)
 ;
"RTN","RCKATP",120,0)
CHK(DFN) ; Check to see if vet should have charges cancelled
"RTN","RCKATP",121,0)
 ;  Input:  DFN  --  Pointer to patient in file 2
"RTN","RCKATP",122,0)
 ; Output:    0  --  No, don't cancel charges
"RTN","RCKATP",123,0)
 ;            1  --  Yes, cancel charges
"RTN","RCKATP",124,0)
 N RCDEB,RCH
"RTN","RCKATP",125,0)
 S RCH=0
"RTN","RCKATP",126,0)
 I $$EMERES^PRCAUTL(DFN)="" G CHKQ
"RTN","RCKATP",127,0)
 S RCDEB=$O(^RCD(340,"B",DFN_";DPT(",0))
"RTN","RCKATP",128,0)
 ;
"RTN","RCKATP",129,0)
 ; - if a Katrina vet is not in file #340, must look for held charges
"RTN","RCKATP",130,0)
 I 'RCDEB S RCH=1 G CHKQ
"RTN","RCKATP",131,0)
 ;
"RTN","RCKATP",132,0)
 ; - make sure charges have not yet been canceled
"RTN","RCKATP",133,0)
 I '$P($G(^RCD(340,RCDEB,0)),"^",9) S RCH=1
"RTN","RCKATP",134,0)
CHKQ Q RCH
"RTN","RCKATP",135,0)
 ;
"RTN","RCKATP",136,0)
 ;
"RTN","RCKATP",137,0)
TPP(RCTI,RCH) ; Identify decreases that are credits for third party payments
"RTN","RCKATP",138,0)
 ;  Input:  RCTI  --  Pointer to AR Transaction in file 433
"RTN","RCKATP",139,0)
 ;           RCH  --  Array of 'counted' transactions passed by reference
"RTN","RCKATP",140,0)
 ; Output:  RCRES --  1^2, where
"RTN","RCKATP",141,0)
 ;                      1 = total amount of credit adjustments
"RTN","RCKATP",142,0)
 ;                      2 = pointer to the affected bill in file #430
"RTN","RCKATP",143,0)
 ;
"RTN","RCKATP",144,0)
 N RCRES,RCB,RCAMT,RCT,RCTD,RCQ,RCI,RCS
"RTN","RCKATP",145,0)
 S RCRES="",RCAMT=0
"RTN","RCKATP",146,0)
 I '$G(RCTI) G TPPQ
"RTN","RCKATP",147,0)
 S RCB=+$P($G(^PRCA(433,RCTI,0)),"^",2) I 'RCB G TPPQ
"RTN","RCKATP",148,0)
 S RCAMT=0
"RTN","RCKATP",149,0)
 S RCT=RCTI F  S RCT=$O(^PRCA(433,"C",RCB,RCT)) Q:'RCT  D
"RTN","RCKATP",150,0)
 .Q:$D(RCH(RCB,RCT))  ;    transaction has been counted
"RTN","RCKATP",151,0)
 .S RCTD=$G(^PRCA(433,RCT,1))
"RTN","RCKATP",152,0)
 .Q:$P(RCTD,"^",2)'=35  ;  not a decrease
"RTN","RCKATP",153,0)
 .;
"RTN","RCKATP",154,0)
 .; - check for a potential 'Katrina decrease'
"RTN","RCKATP",155,0)
 .S RCQ=0,RCS="HURRICANE KATRINA VETERAN" D  Q:RCQ
"RTN","RCKATP",156,0)
 ..S RCI=0 F  S RCI=$O(^PRCA(433,RCT,7,RCI)) Q:'RCI  D  Q:RCQ
"RTN","RCKATP",157,0)
 ...I $G(^PRCA(433,RCT,7,RCI,0))[RCS S RCQ=1
"RTN","RCKATP",158,0)
 .;
"RTN","RCKATP",159,0)
 .; - increment the credit amount
"RTN","RCKATP",160,0)
 .S RCAMT=RCAMT+$P(RCTD,"^",5),RCH(RCB,RCT)=""
"RTN","RCKATP",161,0)
 ;
"RTN","RCKATP",162,0)
 S RCRES=RCAMT_"^"_RCB
"RTN","RCKATP",163,0)
TPPQ Q RCRES
"RTN","RCKATP",164,0)
 ;
"RTN","RCKATP",165,0)
 ;
"RTN","RCKATP",166,0)
DEC(RCBILL,RCAMT) ; Decrease a bill
"RTN","RCKATP",167,0)
 ;  Input:  RCBILL  --  Bill Number of a bill in file 430
"RTN","RCKATP",168,0)
 ;           RCAMT  --  Amount to decrease bill
"RTN","RCKATP",169,0)
 ; Output:  RCBUCK  --  Amount not decreased, to go to bucket
"RTN","RCKATP",170,0)
 ;
"RTN","RCKATP",171,0)
 N RCBUCK,RCMSG,RCT
"RTN","RCKATP",172,0)
 S RCBUCK=RCAMT
"RTN","RCKATP",173,0)
 S RCB=$O(^PRCA(430,"B",RCBILL,0))
"RTN","RCKATP",174,0)
 I RCB D
"RTN","RCKATP",175,0)
 .S RCMSG="CANCEL COPAYMENTS FOR HURRICANE KATRINA VETERAN"
"RTN","RCKATP",176,0)
 .D DEC^PRCASER1(RCB,.RCBUCK,DUZ,RCMSG,"",.RCT)
"RTN","RCKATP",177,0)
DECQ Q RCBUCK
"RTN","RCKATP",178,0)
 ;
"RTN","RCKATP",179,0)
 ;
"RTN","RCKATP",180,0)
FLAG(DFN) ; Flag veteran as having had copay charges cancelled
"RTN","RCKATP",181,0)
 ;  Input:  DFN  --  Pointer to patient in file 2
"RTN","RCKATP",182,0)
 ;
"RTN","RCKATP",183,0)
 N RCDEB
"RTN","RCKATP",184,0)
 S RCDEB=$O(^RCD(340,"B",DFN_";DPT(",0))
"RTN","RCKATP",185,0)
 I 'RCDEB D
"RTN","RCKATP",186,0)
 .S DIC="^RCD(340,",DIC(0)="QL",X=DFN_";DPT(",DLAYGO=340
"RTN","RCKATP",187,0)
 .K DD,DO D FILE^DICN K DIC,DLAYGO,DO,DD S RCDEB=+Y
"RTN","RCKATP",188,0)
 I RCDEB>0 S $P(^RCD(340,RCDEB,0),"^",9)=1
"RTN","RCKATP",189,0)
 Q
"RTN","RCKATP",190,0)
 ;
"RTN","RCKATP",191,0)
 ;
"RTN","RCKATP",192,0)
ADJ(DFN,RCAMT) ; Make final credit adjustments to the vet's account
"RTN","RCKATP",193,0)
 ;  Input:  DFN  --  Pointer to patient in file 2
"RTN","RCKATP",194,0)
 ;        RCAMT  --  Amount to decrease from account
"RTN","RCKATP",195,0)
 ;
"RTN","RCKATP",196,0)
 N RCDEBN,RCMSG
"RTN","RCKATP",197,0)
 S RCDEBN=DFN_";DPT("
"RTN","RCKATP",198,0)
 S RCMSG="CANCEL COPAYMENTS FOR HURRICANE KATRINA VETERAN"
"RTN","RCKATP",199,0)
 D EN^RCKATPD(RCDEBN,RCAMT,RCMSG)
"RTN","RCKATP",200,0)
 Q
"RTN","RCKATP",201,0)
 ;
"RTN","RCKATP",202,0)
 ;
"RTN","RCKATP",203,0)
BULL ; Send job completion bulletin
"RTN","RCKATP",204,0)
 N XMSUB,XMTEXT,XMY,XMDUZ,RCT,RCN
"RTN","RCKATP",205,0)
 S RCT(1)="The patch PRCA*4.5*241 post initialization has completed."
"RTN","RCKATP",206,0)
 S RCT(2)=" "
"RTN","RCKATP",207,0)
 S RCT(3)="Number of Veterans with Interest Exempted:  "_+RCTOTAL
"RTN","RCKATP",208,0)
 S RCT(4)="        Total Amount of Interest Exempted: $"_$J($P(RCTOTAL,"^",2),0,2)
"RTN","RCKATP",209,0)
 S RCT(5)=" "
"RTN","RCKATP",210,0)
 I RCRES="" S RCT(6)="*** Note: Copay Charges were not cancelled - contact EVS ***"
"RTN","RCKATP",211,0)
 I RCRES'="" D
"RTN","RCKATP",212,0)
 .S RCT(6)="Number of Veterans with Charges Cancelled:  "_+RCRES
"RTN","RCKATP",213,0)
 .S RCT(7)="        Total Amount of Charges Cancelled: $"_$J($P(RCRES,"^",2),0,2)
"RTN","RCKATP",214,0)
 .S RCT(8)="   Total Amount of Held Charges Cancelled: $"_$J($P(RCRES,"^",3),0,2)
"RTN","RCKATP",215,0)
 ;
"RTN","RCKATP",216,0)
 S XMSUB="Job Completion - PRCA*4.5*241 Post Initialization"
"RTN","RCKATP",217,0)
 S XMTEXT="RCT("
"RTN","RCKATP",218,0)
 S XMY("G.PRCA ADJUSTMENT TRANS")="",XMY(DUZ)=""
"RTN","RCKATP",219,0)
 S XMDUZ="ACCOUNTS RECEIVABLE"
"RTN","RCKATP",220,0)
 D ^XMD
"RTN","RCKATP",221,0)
 Q
"RTN","RCKATPD")
0^11^B7389792
"RTN","RCKATPD",1,0)
RCKATPD ;ALB/CPM/TJK - ADJUST ACCOUNTS FOR KATRINA VETS (CON'T) - 03-MAR-06
"RTN","RCKATPD",2,0)
 ;;4.5;Accounts Receivable;**241**;Mar 20, 1995
"RTN","RCKATPD",3,0)
 ;;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","RCKATPD",4,0)
 Q
"RTN","RCKATPD",5,0)
 ;
"RTN","RCKATPD",6,0)
 ;
"RTN","RCKATPD",7,0)
EN(ACCT,BUCKET,RCMSG) ; Entry point to credit an account for a Katrina vet
"RTN","RCKATPD",8,0)
 ;  Input:    ACCT  --  value of .01 field for debtor in file 340
"RTN","RCKATPD",9,0)
 ;          BUCKET  --  Amount to credit the account
"RTN","RCKATPD",10,0)
 ;           RCMSG  --  Bill or transaction comment
"RTN","RCKATPD",11,0)
 ;
"RTN","RCKATPD",12,0)
 N DFN,RCDEBTDA,RCCOM
"RTN","RCKATPD",13,0)
 S DFN=+ACCT,RCDEBTDA=$$DEBT^RCEVUTL(ACCT)
"RTN","RCKATPD",14,0)
 I 'DFN!($G(^DPT(DFN,0))="") Q
"RTN","RCKATPD",15,0)
 K ^TMP($J)
"RTN","RCKATPD",16,0)
 N BILL,B0,OLDBAL,PREPAY,TRAN,TDATE,T0,T1,TRAMT,X,TTYPE,STATUS,BN7
"RTN","RCKATPD",17,0)
 N DECAMT,EXTOT,I,PRCAEN,DIC,DIE,DA,DR,MSG,PERROR,NBILL,NTRAN,MSGCNTS,ERR
"RTN","RCKATPD",18,0)
 S PREPAY=$O(^PRCA(430.2,"B","PREPAYMENT",0)),RCCOM(1)=RCMSG
"RTN","RCKATPD",19,0)
 F STATUS=16,42 S BILL=0 F  S BILL=$O(^PRCA(430,"AS",RCDEBTDA,STATUS,BILL)) Q:'BILL!'BUCKET  D PROC,APPLY:OLDBAL
"RTN","RCKATPD",20,0)
 D REFUND:BUCKET
"RTN","RCKATPD",21,0)
 S ERR=$G(PERROR) K ^TMP($J)
"RTN","RCKATPD",22,0)
 Q
"RTN","RCKATPD",23,0)
 ;
"RTN","RCKATPD",24,0)
PROC ; Determine the bill's balance
"RTN","RCKATPD",25,0)
 S B0=$G(^PRCA(430,BILL,0)),BN7=$G(^(7))
"RTN","RCKATPD",26,0)
 S OLDBAL=0 F I=1:1:5 S OLDBAL=OLDBAL+$P(BN7,U,I)
"RTN","RCKATPD",27,0)
 Q
"RTN","RCKATPD",28,0)
 ;
"RTN","RCKATPD",29,0)
APPLY ; Exempt interest and decrease a bill
"RTN","RCKATPD",30,0)
 S EXTOT=0 F I=2:1:5 S EXTOT=EXTOT+$P(BN7,U,I)
"RTN","RCKATPD",31,0)
 ;
"RTN","RCKATPD",32,0)
 ; - interest balance is zero - do a decrease
"RTN","RCKATPD",33,0)
 G DEC:'EXTOT
"RTN","RCKATPD",34,0)
 ;
"RTN","RCKATPD",35,0)
 S TRAMT=0 S:EXTOT'<BUCKET EXTOT=BUCKET
"RTN","RCKATPD",36,0)
INT F I=5:-1:2 Q:'EXTOT  I $P(BN7,U,I) D
"RTN","RCKATPD",37,0)
 .S X=$P(BN7,U,I),DECAMT=$S(X>BUCKET:BUCKET,1:X)
"RTN","RCKATPD",38,0)
 .S $P(BN7,U,I)=$P(BN7,U,I)-DECAMT,BUCKET=BUCKET-DECAMT
"RTN","RCKATPD",39,0)
 .S EXTOT=EXTOT-DECAMT,TRAMT=TRAMT+DECAMT
"RTN","RCKATPD",40,0)
 S OLDBAL=OLDBAL-TRAMT
"RTN","RCKATPD",41,0)
 ;
"RTN","RCKATPD",42,0)
 ; - create exemption transaction
"RTN","RCKATPD",43,0)
 D SETTR^PRCAUTL
"RTN","RCKATPD",44,0)
 S TTYPE=14,DIE="^PRCA(433,",DA=PRCAEN
"RTN","RCKATPD",45,0)
 S DR=".03////"_BILL_";11////"_DT_";12////"_TTYPE_";15///"_TRAMT_";41///"_RCMSG_";89///1;4///2"
"RTN","RCKATPD",46,0)
 S DIC=DIE D ^DIE
"RTN","RCKATPD",47,0)
 K DA,DIC,DIE,DR,TRAMT
"RTN","RCKATPD",48,0)
 ;
"RTN","RCKATPD",49,0)
 ; - update the balance of the bill
"RTN","RCKATPD",50,0)
 S $P(^PRCA(430,BILL,7),U,2,5)=$P(BN7,U,2)_U_$P(BN7,U,3)_U_$P(BN7,U,4)_U_$P(BN7,U,5)
"RTN","RCKATPD",51,0)
 ;
"RTN","RCKATPD",52,0)
 ; - if the bill was decreased by its entire balance, set the
"RTN","RCKATPD",53,0)
 ;   bill status to Cancellation
"RTN","RCKATPD",54,0)
 I 'OLDBAL D CHGSTAT^RCBEUBIL(BILL,39),ADDCOMM^RCBEUBIL(BILL,.RCCOM) Q
"RTN","RCKATPD",55,0)
 ;
"RTN","RCKATPD",56,0)
 ; - no need for decrease if the amount to credit the account is zero
"RTN","RCKATPD",57,0)
 Q:'BUCKET
"RTN","RCKATPD",58,0)
 ;
"RTN","RCKATPD",59,0)
DEC ; - create a decrease adjustment
"RTN","RCKATPD",60,0)
 S PRCAEN=0,DECAMT=BUCKET
"RTN","RCKATPD",61,0)
 D DEC^PRCASER1(BILL,.DECAMT,DUZ,RCMSG,"",.PRCAEN)
"RTN","RCKATPD",62,0)
 S BUCKET=DECAMT
"RTN","RCKATPD",63,0)
 Q
"RTN","RCKATPD",64,0)
 ;
"RTN","RCKATPD",65,0)
 ;
"RTN","RCKATPD",66,0)
REFUND ; Create a prepayment in an Open status
"RTN","RCKATPD",67,0)
 S PERROR="" D EN^PRCAPAY3(DFN_";DPT(",BUCKET,DT,DUZ,"","","",.PERROR)
"RTN","RCKATPD",68,0)
 Q:PERROR]""
"RTN","RCKATPD",69,0)
 ;
"RTN","RCKATPD",70,0)
 ; - find the Open prepayment just increased to add a comment
"RTN","RCKATPD",71,0)
 S NBILL=0 F  S NBILL=$O(^PRCA(430,"AS",RCDEBTDA,$O(^PRCA(430.3,"AC",112,0)),NBILL)) Q:'NBILL  I $P(^PRCA(430,NBILL,0),U,2)=PREPAY Q
"RTN","RCKATPD",72,0)
 I NBILL D ADDCOMM^RCBEUBIL(NBILL,.RCCOM)
"RTN","RCKATPD",73,0)
 Q
"VER")
8.0^22.0
"^DD",340,340,.08,0)
ACCT. PROCESSED (KATRINA)^S^1:YES;^0;8^Q
"^DD",340,340,.08,21,0)
^.001^5^5^3060407^^
"^DD",340,340,.08,21,1,0)
This field will be set by the software whenever a debtor is processed for 
"^DD",340,340,.08,21,2,0)
a possible refund of payments made to interest and/or administrative 
"^DD",340,340,.08,21,3,0)
charges that were charged inappropriately during the Hurricane Katrina 
"^DD",340,340,.08,21,4,0)
emergency period.  A '1' in this field indicates that the account was 
"^DD",340,340,.08,21,5,0)
already processed and should not be processed again.
"^DD",340,340,.08,23,0)
^.001^3^3^3060407^^
"^DD",340,340,.08,23,1,0)
The software automatically sets this field to 1 whenever a veteran's 
"^DD",340,340,.08,23,2,0)
account is processed by the AR hurricane Katrina software.  It prevents 
"^DD",340,340,.08,23,3,0)
this account from being processed again.
"^DD",340,340,.08,"DT")
3051213
"^DD",340,340,.09,0)
COPAY CHARGES CANCELLED?^S^1:YES;0:NO;^0;9^Q
"^DD",340,340,.09,21,0)
^.001^3^3^3060307^^
"^DD",340,340,.09,21,1,0)
This field is used to flag debtors, who were affected by Hurricane
"^DD",340,340,.09,21,2,0)
Katrina, who had copay charges from 8/29/05 through 2/28/06
"^DD",340,340,.09,21,3,0)
cancelled by patch PRCA*4.5*241.
"^DD",340,340,.09,23,0)
^^3^3^3060307^
"^DD",340,340,.09,23,1,0)
This field will be automatically set by routine RCKATP during the
"^DD",340,340,.09,23,2,0)
patch PRCA*4.5*241 post initialization, when copay charges for
"^DD",340,340,.09,23,3,0)
veterans affected by Hurricane Katrina are being cancelled.
"^DD",340,340,.09,"DT")
3060307
"BLD",6509,6)
^215
**END**
**END**
