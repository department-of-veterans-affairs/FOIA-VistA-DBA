$TXT Created by THEROUX,JOHN at MNTVBB.FO-ALBANY.MED.VA.GOV  (KIDS) on Tuesday, 06/27/06 at 15:35
=============================================================================
Run Date: JAN 11, 2007                     Designation: DG*5.3*713
Package : DG - REGISTRATION                   Priority: Mandatory
Version : 5.3       SEQ #651                    Status: Released
                  Compliance Date: FEB 11, 2007
=============================================================================

Associated patches: (v)DG*5.3*208  <<= must be installed BEFORE `DG*5.3*713'
                    (v)DG*5.3*428  <<= must be installed BEFORE `DG*5.3*713'
                    (v)DG*5.3*515  <<= must be installed BEFORE `DG*5.3*713'
                    (v)DG*5.3*709  <<= must be installed BEFORE `DG*5.3*713'

Subject: RATED DISABILITIES

Category: 
  - Routine

Description:
============

   This patch corrects a system error when adding rated disabilities,
 data exceptions on the MPI for the "date last treated", printing of 
 the full SSN on the G&L report, and not generating UR admission 
 bulletins on ASIH transfers.  
  
 ASSOCIATED REMEDY TICKETS:
 ==========================
  
 1) HD 123920 - <SUBSCRIPT>RDIS+28^DGRPDB
    Duplicates:
    HD 135785
    HD 135908
    HD 146283
    HD 150472
    HD 154412
    HD 156135
    HD 162729
    HD 163006
    HD 168181
  
 2) HD 137533 - Erroneous entry for seconds data in DATE LAST TREATED 
 3) HD 146768 - G&L still has full SSNs on it
 4) HD 65631 - UR ADMISSION BULLETIN
    Duplicate:
    HD 110248
  
 ASSOCIATED E3R's:
 =================
 N/A
  
 PARTICIPATING TEST SITES:
 =========================
 Manila, Philippines - O
 Madison, WI - O
 Tampa, FL - L
 Cheyenne, WY - O
 Central Alabama HCS - I
 Salisbury, NC - L
  
  
 REMEDY OVERVIEW:
 ================
  
 1) HD 123920 - <SUBSCRIPT>RDIS+28^DGRPDB
  
 Problem:
 ========
 When adding a rated disability using Screen #11 of the 
 Load/Edit Patient Data [DG LOAD PATIENT DATA] option,
 the user can up arrow or time out of the required field
 DISABILITY % (field #2).  When returning to the screen
 to update the disability, a system error occurs.
  
 Solution:
 =========
 Routine DGRPDB has been modified to avoid the error.
 Without changing IA#4887, the RDIS^DGRPDB API has
 also been clarified. It can be used as both a function
 and a procedure.
  
 2) HD 137533 - Erroneous entry for seconds data in DATE LAST TREATED
  
 Problem:
 ========   
 Certain old records in the Outpatient Encounter file (#409.68) have
 bad data in the DATE field (#.01) where the seconds exceed 59 and this
 causes an error in MPI when that date is used as the "date last treated".
  
 Solution:
 =========
 Routine VAFCTF will be modified to convert the seconds to 59
 before passing it as the "date last treated".
  
 3) HD 146768 - G&L still has full SSNs on it
  
 Problem:
 ========
 Even though on the Gains & Losses portion of the G&L only the last 4 are 
 displayed, on the "corrections" page, the full SSN is still displayed. 
 This is a privacy issue.
  
 Solution:
 =========
 Routine DGPMGLP was modified to print only the last 4 digits of the SSN
 on the "corrections" page.
  
 4) HD 65631 - UR ADMISSION BULLETIN
  
 Problem:
 ========
 The only time patients are showing up on the UR bulletin is when it is a 
 standard admission.  Transfers from nursing home and other non standard 
 admissions are not and this is causing us to loose the ability to follow 
 up on potential billable in-patients. 
  
 Solution:
 =========
 Routine DGPMV321 has been modified to generate the UR bulletin to the 
 DGPM UR ADMISSION mailgroup on ASIH transfers (provided there is active
 insurance coverage). 
  
 INSTALLATION INSTRUCTIONS:
 ===========================
 This patch may be run with users on the system.
 Installation will take less than 5 minutes.
  
 1.  Use the INSTALL/CHECK MESSAGE option on the PackMan menu to unload
     the KIDS distribution included with this message.
     NOTE:  If the required patches are not installed, the transport global
            will be removed.  If the transport global is removed you will
            need to repeat this step.
  
 2.  From the Kernel Installation and Distribution System Menu, select
     the Installation menu.
  
 3.  From this menu, you may elect to use the following options
     (when prompted for INSTALL NAME, enter DG*5.3*713):
     a.  Compare Transport Global to Current System  - this option will
         allow you to view all changes that will be made when the patch
         is installed.  It compares all components of the patch (routines,
         DDs, templates, etc.).
     b.  Verify Checksums in Transport Global - this option will
         allow you to ensure the integrity of the routines that are in
         the transport global.
     c.  Print Transport Global - this option will allow you to view the
         components of the KIDS build.
     d.  Backup a Transport Global - This option will create a backup
         message of any routines exported with this patch. It will not
         backup any other changes such as DD's or templates.
  
 4.  Use the Install Package(s) option and select the package DG*5.3*713.
  
 5.  When prompted ' Want KIDS to INHIBIT LOGONs during the install?
     YES//', respond NO.
  
 6.  When prompted,' Want to DISABLE Scheduled Options, Menu Options, and 
     Protocols? NO//', respond Yes.
     When prompted,'Enter options you wish to mark as 'Out Of Order':',
     enter:
             Load/Edit Patient Data [DG LOAD PATIENT DATA]
             Gains and Losses (G&L) Sheet [DG G&L SHEET]
             Transfer a Patient [DG TRANSFER PATIENT]
  
     When prompted,'Enter protocols you wish to mark as 'Out Of Order':', 
     press enter.
  
 ROUTINE SUMMARY:
 ================
 The following is a list of the routine(s) included in this patch.  The
 second line of each of these routine(s) will look like:
  
      <tab>;;5.3;Registration;**[patch list]**;Aug 13, 1993
  
 Using old logic:
                             CHECK^XTSUMBLD results
  Routine name      Before Patch          After Patch         Patch List
  ============      ============          ===========         ==========
  DGPMGLP               12220002             12268776       20,134,515,713
  DGPMV321              13527701             13533636         40,208,713
  DGRPDB                 8286387              8198049    26,50,358,570,631
                                                                709,713
  VAFCTF                 4013034              4080486           428,713
  
 Using new logic:
                             CHECK1^XTSUMBLD results
  Routine name      Before Patch          After Patch         Patch List
  ============      ============          ===========         ==========
  DGPMGLP              B21935096            B22017750      20,134,515,713
  DGPMV321             B20175654            B20512503         40,208,713
  DGRPDB               B20476702            B20319584    26,50,358,570,631
                                                                709,713
  VAFCTF               B8943810             B9218723           428,713

Routine Information:
====================
The checksums below are new checksums, and
 can be checked with CHECK1^XTSUMBLD.

Routine Name: DGPMGLP
    Before: B21935096  After: B22017750  **20,134,515,713**
 Description of Changes:
  DGPMGLP.INT.1                 |"PATVEE"|DGPMGLP.INT.1  
  **************************************************************************
  *****
  DGPMGLP.INT.1
   +2         ;;5.3;Registration;**20,134,515,713**;Aug 13, 1993
  ...................
  |"PATVEE"|DGPMGLP.INT.1
   +2         ;;5.3;Registration;**20,134,515**;Aug 13, 1993
  ---------------------------------------
  DGPMGLP.INT.1
   +88        W " For ",$S($D(^DPT(+$P(DGCR,"^",5),0)):$P(^(0),"^",1)_"  
  "_$E($P(
  ^(0),"^",9),6,9),1:" ") ; Patient name and SSN
  ...................
  |"PATVEE"|DGPMGLP.INT.1
   +88        W " For ",$S($D(^DPT(+$P(DGCR,"^",5),0)):$P(^(0),"^",1)_"  
  "_$P(^(0
  ),"^",9),1:" ") ; Patient name and SSN
  **************************************************************************
  *****

Routine Name: DGPMV321
    Before: B20175654  After: B20512503  **40,208,713**
 Description of Changes:
  DGPMV321.INT.1                |"PATVEE"|DGPMV321.INT.1  
  **************************************************************************
  *****
  DGPMV321.INT.1
   +2         ;;5.3;Registration;**40,208,713**;Aug 13, 1993
  ...................
  |"PATVEE"|DGPMV321.INT.1
   +2         ;;5.3;Registration;**40,208**;Aug 13, 1993
  ---------------------------------------
  DGPMV321.INT.1
   +15        ; DG*713 - send admission bulletin
   +16        D ^DGPMVBUR
  ...................
  |"PATVEE"|DGPMV321.INT.1
  **************************************************************************
  *****

Routine Name: DGRPDB
    Before: B20476702  After: B20319584  **26,50,358,570,631,709,713**
 Description of Changes:
  DGRPDB.INT.1                  |"PATVEE"|DGRPDB.INT.1  
  **************************************************************************
  *****
  DGRPDB.INT.1
   +2         ;;5.3;Registration;**26,50,358,570,631,709,713**;Aug 13, 1993
  ...................
  |"PATVEE"|DGRPDB.INT.1
   +2         ;;5.3;Registration;**26,50,358,570,631,709**;Aug 13, 1993
  ---------------------------------------
  DGRPDB.INT.1
   +88  RDIS(DGDFN,DGARR) ;API to return all Rated Disabilities from the 
   +89        ;Patient file for a patient using an array.  Returned in 
  descending
   Service Connected percent.
  ...................
  |"PATVEE"|DGRPDB.INT.1
   +88  RDIS(DGDFN,DGARR) ;API will reutrn all Rated Disabilities from the 
  ---------------------------------------
  DGRPDB.INT.1
   +91        ; Integration Agreement #4807
   +92        ; 
   +93        ;Input          DGDFN - IEN of patient file (required)
   +94        ;Input/Output   DGARR - name of array for returned disability 
  info 
  (required)
   
            
  ...................
  |"PATVEE"|DGRPDB.INT.1
   +90        ;Integration Agreement - #????
   +91        ;
   +92        ;Patient file for a patient and put them into the array sent 
  in.
   +93        ;Input  DGDFN - IEN of patient file (required)
   +94        ;       DGARR - name of array for returned disability info 
  (require
  d)
  ---------------------------------------
  DGRPDB.INT.1
   +96        ;               piece 2 - Disability %
  ...................
  |"PATVEE"|DGRPDB.INT.1
   +96        ;               piece 2 - SC%
  ---------------------------------------
  DGRPDB.INT.1
   +98        ;               piece 4 - extremity affected
   +99        ;               piece 5 - original effective date
   +100       ;               piece 6 - current effective date
   +101       ;Output 1=successful and array returned with data
   +102       ;       0=unsuccessful and no array
   
            
   +103       ;         
   +104       N DGARR1,DGC,DGCC,DGERR,DGNODE,DGCT,DGE,DGEE
   +105       K DGW,DGARR
   +106       I $G(DGDFN)']"" Q 0
   +107       I '$D(^DPT(DGDFN,0)) Q 0
  ...................
  |"PATVEE"|DGRPDB.INT.1
   +98        ;               piece 4 - extremity
   +99        ;               piece 5 - original award date
   +100       ;               piece 6 - current award date
   +101       ;Output  DGOK - success or failure, 1=success, 0=failure
   +102       N DGARR1,DGC,DGCC,DGERR,DGNODE
   +103       K DGARR,DGOK
   +104       I $G(DGDFN)']"" S DGOK=0 Q DGOK
   +105       I '$D(^DPT(DGDFN,0)) S DGOK=0 Q DGOK
  ---------------------------------------
  DGRPDB.INT.1
   +109       I $D(DGERR) Q 0
   +110       S DGCC=0
   +111       S DGCC=$O(^DPT(DGDFN,.372,DGCC))
   +112       I 'DGCC Q 0
   
            
  ...................
  |"PATVEE"|DGRPDB.INT.1
   +107       I $D(DGERR) S DGOK=0 Q DGOK
   +108       S DGOK=1
  ---------------------------------------
  DGRPDB.INT.1
  ...................
  |"PATVEE"|DGRPDB.INT.1
   +110       S DGCC=$P($G(^DPT(DGDFN,.372,0)),U,3)
   +111       I $G(DGCC)'>0 S DGOK=0 Q DGOK
  ---------------------------------------
  DGRPDB.INT.1
  ...................
  |"PATVEE"|DGRPDB.INT.1
   +115       K DGW
   +116       N DGCT,DGE,DGEE
  ---------------------------------------
  DGRPDB.INT.1
   +118       F  S DGE=$O(DGARR(DGE)) Q:'DGE  D
   +119       . I $P(DGARR(DGE),U,2)="" S $P(DGARR(DGE),U,2)=0
   +120       . S DGW($P(DGARR(DGE),U,2),$P(DGE,",",1))=DGARR(DGE)
   
            
  ...................
  |"PATVEE"|DGRPDB.INT.1
   +118       F  S DGE=$O(DGARR(DGE)) Q:'DGE  S 
  DGW($P(DGARR(DGE),U,2),$P(DGE,","
  ,1))=DGARR(DGE)
  ---------------------------------------
  DGRPDB.INT.1
   +127       Q 1
   +128       ;
  ...................
  |"PATVEE"|DGRPDB.INT.1
   +125       Q DGOK
  **************************************************************************
  *****

Routine Name: VAFCTF
    Before:  B8943810  After:  B9218723  **428,713**
 Description of Changes:
  VAFCTF.INT.1                  |"PATVEE"|VAFCTF.INT.1  
  **************************************************************************
  *****
  VAFCTF.INT.1
   +2         ;;5.3;Registration;**428,713**;Aug 13, 1993
  ...................
  |"PATVEE"|VAFCTF.INT.1
   +2         ;;5.3;Registration;**428**;Aug 13, 1993
  ---------------------------------------
  VAFCTF.INT.1
   +73        I $E(VAFCX3,13)>5 S VAFCX3=$E(VAFCX3,1,12)_"59"
  ...................
  |"PATVEE"|VAFCTF.INT.1
  **************************************************************************
  *****


=============================================================================
User Information:
Entered By  : THEROUX,JOHN                  Date Entered  : MAY 09, 2006
Completed By: BOWEN,MARY JANE               Date Completed: DEC 29, 2006
Released By : FITCH,DONNA                   Date Released : JAN 11, 2007
=============================================================================


Packman Mail Message:
=====================

$END TXT
