Released PRCA*4.5*192 SEQ #188
Extracted from mail message
**KIDS**:PRCA*4.5*192^

**INSTALL NAME**
PRCA*4.5*192
"BLD",4467,0)
PRCA*4.5*192^ACCOUNTS RECEIVABLE^0^3040701^y
"BLD",4467,1,0)
^^1^1^3040316^
"BLD",4467,1,1,0)
Change references to CHAMPUS to TRICARE.
"BLD",4467,4,0)
^9.64PA^^
"BLD",4467,"ABPKG")
n
"BLD",4467,"INID")
n^n
"BLD",4467,"INIT")
PRCA192P
"BLD",4467,"KRN",0)
^9.67PA^8989.52^19
"BLD",4467,"KRN",.4,0)
.4
"BLD",4467,"KRN",.401,0)
.401
"BLD",4467,"KRN",.402,0)
.402
"BLD",4467,"KRN",.403,0)
.403
"BLD",4467,"KRN",.5,0)
.5
"BLD",4467,"KRN",.84,0)
.84
"BLD",4467,"KRN",3.6,0)
3.6
"BLD",4467,"KRN",3.8,0)
3.8
"BLD",4467,"KRN",9.2,0)
9.2
"BLD",4467,"KRN",9.8,0)
9.8
"BLD",4467,"KRN",9.8,"NM",0)
^9.68A^10^8
"BLD",4467,"KRN",9.8,"NM",2,0)
PRCABJV^^0^B27673505
"BLD",4467,"KRN",9.8,"NM",3,0)
PRCACPV^^0^B13147911
"BLD",4467,"KRN",9.8,"NM",5,0)
RCBEUTR1^^0^B31839795
"BLD",4467,"KRN",9.8,"NM",6,0)
RCCPCPS1^^0^B36852341
"BLD",4467,"KRN",9.8,"NM",7,0)
RCDMC90^^0^B54668888
"BLD",4467,"KRN",9.8,"NM",8,0)
RCXFMSUF^^0^B17432145
"BLD",4467,"KRN",9.8,"NM",9,0)
RCXFMSUV^^0^B12738785
"BLD",4467,"KRN",9.8,"NM",10,0)
PRCAAPR1^^0^B28557452
"BLD",4467,"KRN",9.8,"NM","B","PRCAAPR1",10)

"BLD",4467,"KRN",9.8,"NM","B","PRCABJV",2)

"BLD",4467,"KRN",9.8,"NM","B","PRCACPV",3)

"BLD",4467,"KRN",9.8,"NM","B","RCBEUTR1",5)

"BLD",4467,"KRN",9.8,"NM","B","RCCPCPS1",6)

"BLD",4467,"KRN",9.8,"NM","B","RCDMC90",7)

"BLD",4467,"KRN",9.8,"NM","B","RCXFMSUF",8)

"BLD",4467,"KRN",9.8,"NM","B","RCXFMSUV",9)

"BLD",4467,"KRN",19,0)
19
"BLD",4467,"KRN",19,"NM",0)
^9.68A^^
"BLD",4467,"KRN",19.1,0)
19.1
"BLD",4467,"KRN",19.1,"NM",0)
^9.68A^^
"BLD",4467,"KRN",101,0)
101
"BLD",4467,"KRN",409.61,0)
409.61
"BLD",4467,"KRN",771,0)
771
"BLD",4467,"KRN",870,0)
870
"BLD",4467,"KRN",8989.51,0)
8989.51
"BLD",4467,"KRN",8989.52,0)
8989.52
"BLD",4467,"KRN",8994,0)
8994
"BLD",4467,"KRN","B",.4,.4)

"BLD",4467,"KRN","B",.401,.401)

"BLD",4467,"KRN","B",.402,.402)

"BLD",4467,"KRN","B",.403,.403)

"BLD",4467,"KRN","B",.5,.5)

"BLD",4467,"KRN","B",.84,.84)

"BLD",4467,"KRN","B",3.6,3.6)

"BLD",4467,"KRN","B",3.8,3.8)

"BLD",4467,"KRN","B",9.2,9.2)

"BLD",4467,"KRN","B",9.8,9.8)

"BLD",4467,"KRN","B",19,19)

"BLD",4467,"KRN","B",19.1,19.1)

"BLD",4467,"KRN","B",101,101)

"BLD",4467,"KRN","B",409.61,409.61)

"BLD",4467,"KRN","B",771,771)

"BLD",4467,"KRN","B",870,870)

"BLD",4467,"KRN","B",8989.51,8989.51)

"BLD",4467,"KRN","B",8989.52,8989.52)

"BLD",4467,"KRN","B",8994,8994)

"BLD",4467,"PRE")
PRCA192E
"BLD",4467,"QUES",0)
^9.62^^
"BLD",4467,"REQB",0)
^9.611^9^9
"BLD",4467,"REQB",1,0)
PRCA*4.5*141^2
"BLD",4467,"REQB",2,0)
PRCA*4.5*165^2
"BLD",4467,"REQB",3,0)
PRCA*4.5*169^2
"BLD",4467,"REQB",4,0)
PRCA*4.5*173^2
"BLD",4467,"REQB",5,0)
PRCA*4.5*176^2
"BLD",4467,"REQB",6,0)
PRCA*4.5*190^2
"BLD",4467,"REQB",7,0)
PRCA*4.5*204^2
"BLD",4467,"REQB",8,0)
PRCA*4.5*211^2
"BLD",4467,"REQB",9,0)
PRCA*4.5*206^2
"BLD",4467,"REQB","B","PRCA*4.5*141",1)

"BLD",4467,"REQB","B","PRCA*4.5*165",2)

"BLD",4467,"REQB","B","PRCA*4.5*169",3)

"BLD",4467,"REQB","B","PRCA*4.5*173",4)

"BLD",4467,"REQB","B","PRCA*4.5*176",5)

"BLD",4467,"REQB","B","PRCA*4.5*190",6)

"BLD",4467,"REQB","B","PRCA*4.5*204",7)

"BLD",4467,"REQB","B","PRCA*4.5*206",9)

"BLD",4467,"REQB","B","PRCA*4.5*211",8)

"INIT")
PRCA192P
"MBREQ")
0
"PKG",142,-1)
1^1
"PKG",142,0)
ACCOUNTS RECEIVABLE^PRCA^BILL COLLECTIONS
"PKG",142,20,0)
^9.402P^1^1
"PKG",142,20,1,0)
2^^PRCAMRG
"PKG",142,20,1,1)

"PKG",142,20,"B",2,1)

"PKG",142,22,0)
^9.49I^1^1
"PKG",142,22,1,0)
4.5^^2950320
"PKG",142,22,1,"PAH",1,0)
192^3040701
"PKG",142,22,1,"PAH",1,1,0)
^^1^1^3040701
"PKG",142,22,1,"PAH",1,1,1,0)
Change references to CHAMPUS to TRICARE.
"PRE")
PRCA192E
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
10
"RTN","PRCA192E")
0^^B4203115
"RTN","PRCA192E",1,0)
PRCA192E ;BAY-OI/RLC - ENVIRONMENTAL CHECK FOR PATCH 192 ;03/08/04
"RTN","PRCA192E",2,0)
 ;;4.5;Accounts Receivable;**192**;Mar 20, 1995
"RTN","PRCA192E",3,0)
 ;;Per VHA Directive 10-93-142, this routine should not be modified
"RTN","PRCA192E",4,0)
 ;
"RTN","PRCA192E",5,0)
 ;Environmental check routine for patch 192.  This patch should
"RTN","PRCA192E",6,0)
 ;not be installed by any sites that have CoreFLS installed.
"RTN","PRCA192E",7,0)
ENV ;
"RTN","PRCA192E",8,0)
 I $$PATCH^XPDUTL("PRCA*4.5*175") D
"RTN","PRCA192E",9,0)
 . W "You are a test site for a CoreFLS version (patch PRCA*4.5*175) of Accounts",!
"RTN","PRCA192E",10,0)
 . W "Receivable.  This patch has a conflict with the AR-CoreFLS test software.",!
"RTN","PRCA192E",11,0)
 . W "It must NOT be installed unless an accompanying update is made to the",!
"RTN","PRCA192E",12,0)
 . W "AR-CoreFLS software immediately after installation of this patch.",!!
"RTN","PRCA192E",13,0)
 . N DIR,DTOUT,DUOUT,Y
"RTN","PRCA192E",14,0)
 . S DIR(0)="YA"
"RTN","PRCA192E",15,0)
 . S DIR("A")="Do you have the corresponding update to the AR-CoreFLS software that is associatied with this patch? (Note: entering ""No"" here will stop the installation of this patch) Y/N // "
"RTN","PRCA192E",16,0)
 . D ^DIR
"RTN","PRCA192E",17,0)
 . I $D(DTOUT)!$D(DUOUT)!(Y'=1) W !,"Installation of this patch has been stopped!" S XPDQUIT=2 Q
"RTN","PRCA192E",18,0)
 . W !,"OK to install!"
"RTN","PRCA192E",19,0)
 . K DIR,DTOUT,DUOUT,Y
"RTN","PRCA192E",20,0)
 Q
"RTN","PRCA192P")
0^^B1686832
"RTN","PRCA192P",1,0)
PRCA192P ;BAY-OI/RLC- PRE-INIT FOR 192 TO UPDATE CHAMPUS TO TRICARE ;03/31/03
"RTN","PRCA192P",2,0)
 ;;4.5;Accounts Receivable;**192 **;Mar 20, 1995
"RTN","PRCA192P",3,0)
 ;Change references to CHAMPUS to TRICARE
"RTN","PRCA192P",4,0)
 D F4302
"RTN","PRCA192P",5,0)
 D F3473
"RTN","PRCA192P",6,0)
 Q
"RTN","PRCA192P",7,0)
 ;
"RTN","PRCA192P",8,0)
F4302 ; update file 430.2 with new Category name and Abbreviation
"RTN","PRCA192P",9,0)
 ; along with the corresponding "B" and "C" cross references
"RTN","PRCA192P",10,0)
 N DA,PRNM,PRNAME,PRAB,PRABB
"RTN","PRCA192P",11,0)
 S (PRNM,PRAB,PRABB,PRNAME)="",U="^"
"RTN","PRCA192P",12,0)
 F  S PRNM=$O(^PRCA(430.2,"B",PRNM)) Q:PRNM=""  D
"RTN","PRCA192P",13,0)
 .  Q:PRNM'["CHAMPUS"
"RTN","PRCA192P",14,0)
 .  S PRNAME=$TR($E(PRNM,1,7),"CHAMPUS","TRICARE")_$E(PRNM,8,$L(PRNM))
"RTN","PRCA192P",15,0)
 .  S DA=$O(^PRCA(430.2,"B",PRNM,0)) Q:'DA
"RTN","PRCA192P",16,0)
 .  S PRAB=$P(^PRCA(430.2,DA,0),U,2)
"RTN","PRCA192P",17,0)
 .  S PRABB=$TR($E(PRAB,1),"C","T")_$E(PRAB,2,$L(PRAB))
"RTN","PRCA192P",18,0)
 .  S $P(^PRCA(430.2,DA,0),U,1)=PRNAME,$P(^(0),U,2)=PRABB
"RTN","PRCA192P",19,0)
 .  S ^PRCA(430.2,"B",PRNAME,DA)="",^PRCA(430.2,"C",PRABB,DA)=""
"RTN","PRCA192P",20,0)
 .  K ^PRCA(430.2,"B",PRNM,DA),^PRCA(430.2,"C",PRAB,DA)
"RTN","PRCA192P",21,0)
 K DA,PRNM,PRNAME,PRAB,PRABB
"RTN","PRCA192P",22,0)
 Q
"RTN","PRCA192P",23,0)
 ;
"RTN","PRCA192P",24,0)
F3473 ; Inactivate Champus Revenue Source Codes file 347.3
"RTN","PRCA192P",25,0)
 S INACT=1
"RTN","PRCA192P",26,0)
 F DA=8025,8026,8027 D
"RTN","PRCA192P",27,0)
 . L +^RC(347.3,DA):10
"RTN","PRCA192P",28,0)
 . S DIE="^RC(347.3,",DR=".03///^S X=INACT"
"RTN","PRCA192P",29,0)
 . D ^DIE
"RTN","PRCA192P",30,0)
 . L -^RC(347.3,DA)
"RTN","PRCA192P",31,0)
 K DA,DR,DIE,INACT
"RTN","PRCA192P",32,0)
 Q
"RTN","PRCAAPR1")
0^10^B28557452
"RTN","PRCAAPR1",1,0)
PRCAAPR1 ;WASH-ISC@ALTOONA,PA/RGY-PATIENT ACCOUNT PROFILE ;2/12/97  11:48 AM
"RTN","PRCAAPR1",2,0)
V ;;4.5;Accounts Receivable;**34,45,108,143,141,206,192**;Mar 20, 1995
"RTN","PRCAAPR1",3,0)
 ;;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","PRCAAPR1",4,0)
HDR ;Head for Account profile
"RTN","PRCAAPR1",5,0)
 S X="",$P(X,"=",23)="" W @IOF,!,X,"   A c c o u n t   P r o f i l e   ",X
"RTN","PRCAAPR1",6,0)
HDR1 N DMC,IBRX,RSN,TOP4,TOP6,DPTFLG,ACCTNUM
"RTN","PRCAAPR1",7,0)
 S IBRX=0,DPTFLG=0
"RTN","PRCAAPR1",8,0)
 ;
"RTN","PRCAAPR1",9,0)
 ;Display new 'Statement Account Number" (Patch 206)
"RTN","PRCAAPR1",10,0)
 I PRCADB["DPT(" S DPTFLG=1,ACCTNUM=$$ACCT(PRCADB)
"RTN","PRCAAPR1",11,0)
 ;
"RTN","PRCAAPR1",12,0)
 W !,$P(DEBT,"^",2) I DPTFLG!(PRCADB["VA(200,") S X=$S(PRCADB["DPT(":$P(^DPT(+PRCADB,0),"^",9),1:$P($G(^VA(200,+PRCADB,1)),"^",9)) W " (",$E(X,1,3),"-",$E(X,4,5),"-",$E(X,6,9),")"
"RTN","PRCAAPR1",13,0)
 W ?53,"Statement Day: ",$S($$PST^RCAMFN01(+DEBT)>0:$$PST^RCAMFN01(+DEBT),1:"N/A")
"RTN","PRCAAPR1",14,0)
 K Y S X("ADD")=$$DADD^RCAMADD(PRCADB)
"RTN","PRCAAPR1",15,0)
 ;
"RTN","PRCAAPR1",16,0)
 ;Display new 'Statement Account Number" (Patch 206)
"RTN","PRCAAPR1",17,0)
 I DPTFLG W !,"Statement Account #: ",ACCTNUM,?52,"Last Statement: "
"RTN","PRCAAPR1",18,0)
 E  W !?52,"Last Statement: "
"RTN","PRCAAPR1",19,0)
 ;
"RTN","PRCAAPR1",20,0)
 S Y=+$$LST^RCFN01(PRCADB,2)
"RTN","PRCAAPR1",21,0)
 I Y>0 S Y("CCPC")=$$FPS^RCCPCFN(+DEBT) S:Y("CCPC") Y=+$P(Y("CCPC"),"^")
"RTN","PRCAAPR1",22,0)
 W $S(Y=-1:"N/A",1:$$SLH^RCFN01(Y))
"RTN","PRCAAPR1",23,0)
 W !,$P(X("ADD"),"^")
"RTN","PRCAAPR1",24,0)
 W:+$G(Y("CCPC")) ?52,"Activity as of: ",$$SLH^RCFN01($$ASOF^RCCPCFN($P(Y("CCPC"),"^",2)))
"RTN","PRCAAPR1",25,0)
 W:$P(X("ADD"),"^",2)]"" !,$P(X("ADD"),"^",2) W:$P(X("ADD"),"^",3)]"" !,$P(X("ADD"),"^",3)
"RTN","PRCAAPR1",26,0)
 W ! W:$P(X("ADD"),"^",4)]"" $P(X("ADD"),"^",4),", ",$P(X("ADD"),"^",5),"  ",$S($P(X("ADD"),"^",6):$P(X("ADD"),"^",6),1:$P(X("ADD"),"^",8))
"RTN","PRCAAPR1",27,0)
 W ?55,"Amount Owed: ",?69,$J(+$G(^TMP("PRCAAPR",$J,"C")),9,2)
"RTN","PRCAAPR1",28,0)
 W !,"Phone #: ",$S($P(X("ADD"),"^",7)]"":$P(X("ADD"),"^",7),1:"N/A")
"RTN","PRCAAPR1",29,0)
 I PRCADB["DPT(" W ?51,"RX Copay Exempt: " S IBRX=$$RXST^IBARXEU(+PRCADB,DT) W $S($P(IBRX,U)=1:"YES",$P(IBRX,U)=0:"NO",1:"N/A")
"RTN","PRCAAPR1",30,0)
 ; *108 add exemption reason/dmc info
"RTN","PRCAAPR1",31,0)
 I IBRX>0,($P(IBRX,U)=1) S DIC="^IBE(354.2,",DIC(0)="M",X=+$P(IBRX,"^",3) D ^DIC I Y>0 W !,?54,"(",$P(Y,"^",2),")"
"RTN","PRCAAPR1",32,0)
 I $D(^RCD(340,"DMC",1,+DEBT)) S DMC=$G(^RCD(340,+DEBT,3)) D
"RTN","PRCAAPR1",33,0)
 .I $P(DMC,"^",2) W !,"** Account forwarded to DMC: ",$$SLH^RCFN01($P(DMC,"^",2)),?50,"Total DMC Amount: ",?69,$J($P(DMC,"^",5),9,2)
"RTN","PRCAAPR1",34,0)
 .I $P(DMC,"^",9)'="" W !,?49,"Lesser Amt to DMC: ",?69,$J($P(DMC,"^",9),9,2)
"RTN","PRCAAPR1",35,0)
 .Q
"RTN","PRCAAPR1",36,0)
 I $D(^RCD(340,"TOP",+DEBT)) S TOP4=$G(^RCD(340,+DEBT,4)),TOP6=$G(^(6)) D
"RTN","PRCAAPR1",37,0)
 .I +TOP6 W !,"** Account forwarded to TOP: ",$$SLH^RCFN01($P(TOP6,"^")),?45,"Total TOP Amount: ",?65,$J($P(TOP4,"^",3),13,2)
"RTN","PRCAAPR1",38,0)
 .I $P(TOP6,"^",6) W !,?45,"TOP HOLD DATE: ",$$SLH^RCFN01($P(TOP6,"^",6))
"RTN","PRCAAPR1",39,0)
 .Q
"RTN","PRCAAPR1",40,0)
 I $O(^RCD(340,+DEBT,2,0)) D
"RTN","PRCAAPR1",41,0)
 .S Y=0 F X=0:0 S X=$O(^RCD(340,+DEBT,2,X)) Q:'X  W:'Y ! W !,$G(^(X,0)) S Y=Y+1 W:Y=3&$O(^RCD(340,+DEBT,2,X)) "..." Q:Y=3
"RTN","PRCAAPR1",42,0)
 .Q
"RTN","PRCAAPR1",43,0)
 Q
"RTN","PRCAAPR1",44,0)
HDR2 W !!,"#",?4,"Bill #",?16,"Est",?28,"Type",?37,"Paid",?46,"Prin",?55,"Int",?63,"Adm",?72,"Balance"
"RTN","PRCAAPR1",45,0)
 Q
"RTN","PRCAAPR1",46,0)
DIS ;Display bill line items
"RTN","PRCAAPR1",47,0)
 NEW STAT1
"RTN","PRCAAPR1",48,0)
 I '$O(^TMP("PRCAAPR",$J,"C",0)) S X="",$P(X,"*",22)="" W !!,X,"  NO ACCOUNT INFORMATION AVAILABLE  ",X G Q1
"RTN","PRCAAPR1",49,0)
 F STAT1=0:0 S STAT1=$O(^TMP("PRCAAPR",$J,"C",STAT1)) Q:'STAT1!$D(OUT)  D BHDR S BILL=0 F  S BILL=$O(^TMP("PRCAAPR",$J,"C",STAT1,BILL)) Q:BILL=""!$D(OUT)  D BLN
"RTN","PRCAAPR1",50,0)
 I '$D(OUT) D READ
"RTN","PRCAAPR1",51,0)
Q1 Q
"RTN","PRCAAPR1",52,0)
BHDR ;Display status line
"RTN","PRCAAPR1",53,0)
 S X=$S(+$P(^TMP("PRCAAPR",$J,"C",STAT1),"^",2)=99:"PAYMENTS",1:$P($G(^PRCA(430.3,+$O(^PRCA(430.3,"AC",+$P(^TMP("PRCAAPR",$J,"C",STAT1),"^",2),0)),0)),"^"))
"RTN","PRCAAPR1",54,0)
 S Y=" "_X_" ("_$J(+^TMP("PRCAAPR",$J,"C",STAT1),0,2)_") " W ! F X=1:1:80-$L(Y)/2 W "-"
"RTN","PRCAAPR1",55,0)
 W Y F X=1:1:IOM-$X-1 W "-"
"RTN","PRCAAPR1",56,0)
 Q
"RTN","PRCAAPR1",57,0)
BLN ;
"RTN","PRCAAPR1",58,0)
 I $Y+5>IOSL,COUNT D READ G:$D(OUT) Q2 D HDR,HDR2,BHDR
"RTN","PRCAAPR1",59,0)
 S:STAT1'=99 COUNT=COUNT+1,^TMP("PRCAAPR",$J,"O",COUNT)=BILL S X=$S(STAT1=99:BILL,1:$G(^PRCA(430,BILL,0)))
"RTN","PRCAAPR1",60,0)
 W !,$S(STAT1'=99:COUNT,1:"*"),?4,$P(X,"^") W:STAT1'=99 ?16,$$SLH^RCFN01($P(X,"^",10))
"RTN","PRCAAPR1",61,0)
 W:STAT1'=99 ?28,$S($P(X,"^",2)=31:"TRIC PT",1:$E($P($G(^PRCA(430.2,$S($O(^PRCA(430.2,"AC",24,0))=$P(X,"^",2):+$P(X,"^",16),1:+$P(X,"^",2)),0)),"^"),1,7))
"RTN","PRCAAPR1",62,0)
 W:STAT1=99 ?28,"PAYMENT"
"RTN","PRCAAPR1",63,0)
 S X=$S(STAT1=99:"^^^^^^"_^TMP("PRCAAPR",$J,"C",STAT1,BILL),1:$G(^PRCA(430,BILL,7))) W ?37 W:STAT1=99 "-" W $J($P(X,"^",7)+$P(X,"^",8)+$P(X,"^",9)+$P(X,"^",10)+$P(X,"^",11),0,2)
"RTN","PRCAAPR1",64,0)
 W ?45 W:STAT1=99 " " W:STAT1'=99 $S($P(^PRCA(430,BILL,0),"^",2)=$O(^PRCA(430.2,"AC",33,0)):"-",1:" ")
"RTN","PRCAAPR1",65,0)
 W $J($P(X,"^"),0,2),?55,$J($P(X,"^",2),1,2),?63,$J($P(X,"^",3),0,2),?69,$S(STAT1=99:"-",$P(^PRCA(430,BILL,0),"^",2)=$O(^PRCA(430.2,"AC",33,0)):"-",1:" ")
"RTN","PRCAAPR1",66,0)
 W $S(STAT1=99:$J(^TMP("PRCAAPR",$J,"C",STAT1,BILL),0,2),1:$J($P(X,"^")+$P(X,"^",2)+$P(X,"^",3)+$P(X,"^",4)+$P(X,"^",5),9,2))
"RTN","PRCAAPR1",67,0)
 K ^TMP("PRCAAPR",$J,"C",STAT1,BILL) K:$O(^TMP("PRCAAPR",$J,"C",STAT1,""))="" ^TMP("PRCAAPR",$J,"C",STAT1)
"RTN","PRCAAPR1",68,0)
Q2 Q
"RTN","PRCAAPR1",69,0)
READ ;Read bill number
"RTN","PRCAAPR1",70,0)
 W !!,"Select 1-",COUNT W:$O(^TMP("PRCAAPR",$J,"C","")) " or return to continue" R ": ",X:DTIME I X["^"!'$T S:'$T DTOUT=1 S OUT=1 G Q3
"RTN","PRCAAPR1",71,0)
 I X["?" W !!,"To see detailed information for a bill number, enter the corresponding '#'",!,"next to the bill.  (Ex: 1 or 1,3)" G READ
"RTN","PRCAAPR1",72,0)
 I X="",'$O(^TMP("PRCAAPR",$J,"C","")) S OUT=1 G Q3
"RTN","PRCAAPR1",73,0)
 G:X="" Q3 S SEL=X
"RTN","PRCAAPR1",74,0)
 F X=1:1:$L(SEL,",") S Y=$P(SEL,",",X) I Y'?1N.N!'$D(^TMP("PRCAAPR",$J,"O",+Y)) W *7," ??" G READ
"RTN","PRCAAPR1",75,0)
 S OUT=1 F X=1:1:$L(SEL,",") S Y=$P(SEL,",",X) D EN1^PRCAATR($G(^TMP("PRCAAPR",$J,"O",+Y)))
"RTN","PRCAAPR1",76,0)
Q3 Q
"RTN","PRCAAPR1",77,0)
 ;
"RTN","PRCAAPR1",78,0)
ACCT(DFN) ;Get account number. Join station with DFN (Patch 206)
"RTN","PRCAAPR1",79,0)
 N SITE,ACCT,ACCT1,LEN
"RTN","PRCAAPR1",80,0)
 S DFN=+DFN
"RTN","PRCAAPR1",81,0)
 S LEN=$L(DFN)-1
"RTN","PRCAAPR1",82,0)
 S SITE=$$SITE^RCMSITE                          ;station number
"RTN","PRCAAPR1",83,0)
 S ACCT=$$RJ^XLFSTR(DFN,13,0)                   ;add leading zeroes
"RTN","PRCAAPR1",84,0)
 S ACCT1=SITE_"-"_$E(ACCT,1,$L(ACCT)-$L(DFN))   ;add hyphen
"RTN","PRCAAPR1",85,0)
 S ACCT1=ACCT1_"-"_$E(ACCT,$L(ACCT)-LEN,99)     ;add hyphen
"RTN","PRCAAPR1",86,0)
 S ACCT1=ACCT1_"-"_$E($P($P(DEBT,U,2),","),1,5) ;add last name
"RTN","PRCAAPR1",87,0)
 Q ACCT1
"RTN","PRCABJV")
0^2^B27673505
"RTN","PRCABJV",1,0)
PRCABJV ;WASH-ISC@ALTOONA,PA/TJK-FILE VERIFICATION FOR BACKGROUND JOB ;4/6/95  10:13 AM
"RTN","PRCABJV",2,0)
V ;;4.5;Accounts Receivable;**1,48,63,114,141,170,176,173,192**;Mar 20, 1995
"RTN","PRCABJV",3,0)
 ;;patch 192 changes all occurrences of CHAMPUS to TRICARE
"RTN","PRCABJV",4,0)
 ;;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","PRCABJV",5,0)
EN1(FILE,X1,X2,ERROR) ;
"RTN","PRCABJV",6,0)
 ;FILE IS THE FILE NUMBER
"RTN","PRCABJV",7,0)
 ;X1 AND X2 ARE 3 PART VARIABLES SEPARATED BY SEMI-COLONS WITH
"RTN","PRCABJV",8,0)
 ;THE FORMAT (X-REF INDEX;NODE;PIECE)
"RTN","PRCABJV",9,0)
 ;AN ERROR ARRAY IS SET IF VALIDATION FAILS
"RTN","PRCABJV",10,0)
 NEW LT,CNT,I,I1,I2,I3,REC,IND,ND,PC,DATA,J,LN,FILENT
"RTN","PRCABJV",11,0)
 S LT=$S(FILE[430.3:"TRANST",FILE[430.2:"CAT",1:"EVENT"),CNT=0
"RTN","PRCABJV",12,0)
 F I=1,2 S J=@("X"_I),IND(I)=$P(J,";"),ND(I)=$P(J,";",2),PC(I)=$P(J,";",3)
"RTN","PRCABJV",13,0)
 F I1=1:1 D  Q:(DATA(0)="EOF")!(ERROR)
"RTN","PRCABJV",14,0)
    .S LN=$T(@LT+I1) F I=3:1:6 S DATA(I-3)=$P(LN,";",I)
"RTN","PRCABJV",15,0)
    .Q:DATA(0)="EOF"
"RTN","PRCABJV",16,0)
    .G RC:FILE<430
"RTN","PRCABJV",17,0)
    .I '$D(^PRCA(FILE,"B",DATA(0))) S ERROR=1 Q
"RTN","PRCABJV",18,0)
    .S REC=$O(^PRCA(FILE,"B",DATA(0),0)) I 'REC S ERROR=1 Q
"RTN","PRCABJV",19,0)
    .I DATA(3)'=REC S ERROR=1 Q
"RTN","PRCABJV",20,0)
    .I $P(^PRCA(FILE,REC,0),U)'=DATA(0) S ERROR=1 Q
"RTN","PRCABJV",21,0)
    .G CNT:X1=""
"RTN","PRCABJV",22,0)
    .F I2=1,2 D  Q:ERROR  I I2=1,X2="" Q
"RTN","PRCABJV",23,0)
       ..I '$D(^PRCA(FILE,IND(I2),DATA(I2))) S ERROR=1 G Q2
"RTN","PRCABJV",24,0)
       ..;  do not check if category number is a zero
"RTN","PRCABJV",25,0)
       ..I I2=1,DATA(1)'=0,$O(^PRCA(FILE,IND(I2),DATA(I2),0))'=REC S ERROR=1 G Q2
"RTN","PRCABJV",26,0)
       ..I $P(^PRCA(FILE,REC,ND(I2)),U,PC(I2))'=DATA(I2) S ERROR=1
"RTN","PRCABJV",27,0)
Q2       ..Q
"RTN","PRCABJV",28,0)
CNT    .Q:ERROR
"RTN","PRCABJV",29,0)
    .S CNT=CNT+1
"RTN","PRCABJV",30,0)
Q1    .Q
"RTN","PRCABJV",31,0)
RC    .I '$D(^RC(FILE,"B",DATA(0))) S ERROR=1 Q
"RTN","PRCABJV",32,0)
    .S REC=$O(^RC(FILE,"B",DATA(0),0)) I 'REC S ERROR=1 Q
"RTN","PRCABJV",33,0)
    .I DATA(3)'=REC S ERROR=1 Q
"RTN","PRCABJV",34,0)
    .I $P(^RC(FILE,REC,0),U)'=DATA(0) S ERROR=1 Q
"RTN","PRCABJV",35,0)
    .G CNT:X1=""
"RTN","PRCABJV",36,0)
    .F I3=1,2 D  Q:ERROR  I I3=1,X2="" Q
"RTN","PRCABJV",37,0)
       ..I '$D(^RC(FILE,IND(I3),DATA(I3))) S ERROR=1 G Q3
"RTN","PRCABJV",38,0)
       ..I $O(^RC(FILE,IND(I3),DATA(I3),0))'=REC S ERROR=1 G Q3
"RTN","PRCABJV",39,0)
       ..I $P(^RC(FILE,REC,ND(I3)),U,PC(I3))'=DATA(I3) S ERROR=1
"RTN","PRCABJV",40,0)
Q3       ..Q
"RTN","PRCABJV",41,0)
    .G CNT
"RTN","PRCABJV",42,0)
 I FILE>429.99,$P(^PRCA(FILE,0),U,4)'=CNT S ERROR=1 G EXIT
"RTN","PRCABJV",43,0)
 G EXIT:FILE>429.99
"RTN","PRCABJV",44,0)
 I $P(^RC(FILE,0),U,4)'=CNT S ERROR=1
"RTN","PRCABJV",45,0)
EXIT Q:'ERROR
"RTN","PRCABJV",46,0)
 S FILENT=$S(FILE>429.99:$P(^PRCA(FILE,0),U,4),1:$P(^RC(FILE,0),U,4))
"RTN","PRCABJV",47,0)
 S ERROR(1)="An error has been detected in the "_$P(^DIC(FILE,0),U)_" File."
"RTN","PRCABJV",48,0)
 I DATA(0)="EOF" S ERROR(2)="There are too many entries in your file."
"RTN","PRCABJV",49,0)
 I DATA(0)'="EOF" S ERROR(2)="The "_DATA(0)_" Entry in your file is missing or corrupted."
"RTN","PRCABJV",50,0)
 Q
"RTN","PRCABJV",51,0)
TRANST ;
"RTN","PRCABJV",52,0)
 ;;ACTIVE;102;A;16
"RTN","PRCABJV",53,0)
 ;;ADD (AMEND);302;AD;37
"RTN","PRCABJV",54,0)
 ;;ADMIN.COST CHARGE;12;AC;12
"RTN","PRCABJV",55,0)
 ;;AMEND;303;AM;38
"RTN","PRCABJV",56,0)
 ;;AMENDED BILL;110;AB;33
"RTN","PRCABJV",57,0)
 ;;ARCHIVED;115;XX;49
"RTN","PRCABJV",58,0)
 ;;BILL INCOMPLETE;201;BI;27
"RTN","PRCABJV",59,0)
 ;;CANCELLATION;111;CN;39
"RTN","PRCABJV",60,0)
 ;;CANCELLED BILL;210;CB;26
"RTN","PRCABJV",61,0)
 ;;CASH COLLECTION BY RC/DOJ;7;CJ;7
"RTN","PRCABJV",62,0)
 ;;CHARGE SUSPENDED;19;CS;47
"RTN","PRCABJV",63,0)
 ;;COLLECTED/CLOSED;108;CC;22
"RTN","PRCABJV",64,0)
 ;;COMMENT;17;CM;45
"RTN","PRCABJV",65,0)
 ;;DEBIT VOUCHER (SF 5515);30;DV;30
"RTN","PRCABJV",66,0)
 ;;DECREASE ADJUSTMENT;21;DA;35
"RTN","PRCABJV",67,0)
 ;;DELETE (AMEND);301;DL;36
"RTN","PRCABJV",68,0)
 ;;EXEMPT INT/ADM. COST;14;E;14
"RTN","PRCABJV",69,0)
 ;;IN-ACTIVE;103;IA;17
"RTN","PRCABJV",70,0)
 ;;INCOMPLETE;101;IN;15
"RTN","PRCABJV",71,0)
 ;;INCREASE ADJUSTMENT;1;AJ;1
"RTN","PRCABJV",72,0)
 ;;INTEREST/ADM. CHARGE;13;IC;13
"RTN","PRCABJV",73,0)
 ;;MARSHAL/COURT COST;15;ML;24
"RTN","PRCABJV",74,0)
 ;;NEW BILL;104;N;18
"RTN","PRCABJV",75,0)
 ;;OLD BILL;106;OB;28
"RTN","PRCABJV",76,0)
 ;;OPEN;112;OP;42
"RTN","PRCABJV",77,0)
 ;;PAYMENT (IN FULL);20;PF;34
"RTN","PRCABJV",78,0)
 ;;PAYMENT (IN PART);2;PP;2
"RTN","PRCABJV",79,0)
 ;;PENDING APPROVAL;205;PA;20
"RTN","PRCABJV",80,0)
 ;;PENDING ARCHIVE;114;X;48
"RTN","PRCABJV",81,0)
 ;;PENDING CALM CODE;107;PC;21
"RTN","PRCABJV",82,0)
 ;;RE-ESTABLISH;250;RW;43
"RTN","PRCABJV",83,0)
 ;;REESTABLISH TO RC/DOJ;5;RR;5
"RTN","PRCABJV",84,0)
 ;;REFER TO RC;3;RC;3
"RTN","PRCABJV",85,0)
 ;;REFER TO DOJ;4;RJ;4
"RTN","PRCABJV",86,0)
 ;;REFUND REVIEW;113;PR;44
"RTN","PRCABJV",87,0)
 ;;REFUNDED;120;RF;41
"RTN","PRCABJV",88,0)
 ;;REPAYMENT PLAN;16;RP;25
"RTN","PRCABJV",89,0)
 ;;RETURNED BY RC/DOJ;6;RD;6
"RTN","PRCABJV",90,0)
 ;;RETURNED FOR AMENDMENT;230;RA;32
"RTN","PRCABJV",91,0)
 ;;RETURNED FROM AR (NEW);220;RT;31
"RTN","PRCABJV",92,0)
 ;;SUSPENDED;240;SP;40
"RTN","PRCABJV",93,0)
 ;;SUSPENSE;105;S;19
"RTN","PRCABJV",94,0)
 ;;TERM.BY COMPROMISE;9;TC;9
"RTN","PRCABJV",95,0)
 ;;TERM.BY RC/DOJ;29;TJ;29
"RTN","PRCABJV",96,0)
 ;;TERM.BY FIS.OFFICER;8;TO;8
"RTN","PRCABJV",97,0)
 ;;UNSUSPENDED;18;US;46
"RTN","PRCABJV",98,0)
 ;;WAIVED IN FULL;10;WF;10
"RTN","PRCABJV",99,0)
 ;;WAIVED IN PART;11;WP;11
"RTN","PRCABJV",100,0)
 ;;WRITE-OFF;109;WO;23
"RTN","PRCABJV",101,0)
 ;;EOF
"RTN","PRCABJV",102,0)
CAT ;patch 192 - ISC-0502-N2803 change Champus to Tricare
"RTN","PRCABJV",103,0)
 ;;ADULT DAY HEALTH CARE;40;AD;33
"RTN","PRCABJV",104,0)
 ;;C (MEANS TEST);24;C;18
"RTN","PRCABJV",105,0)
 ;;TRICARE;37;T1;30
"RTN","PRCABJV",106,0)
 ;;TRICARE PATIENT;38;T2;31
"RTN","PRCABJV",107,0)
 ;;TRICARE THIRD PARTY;39;T3;32
"RTN","PRCABJV",108,0)
 ;;CHAMPVA;36;CV;29
"RTN","PRCABJV",109,0)
 ;;CHAMPVA SUBSISTENCE;34;CS;27
"RTN","PRCABJV",110,0)
 ;;CHAMPVA THIRD PARTY;35;CT;28
"RTN","PRCABJV",111,0)
 ;;CRIME OF PER.VIO.;27;CP;8
"RTN","PRCABJV",112,0)
 ;;CURRENT EMP.;14;CE;16
"RTN","PRCABJV",113,0)
 ;;DOMICILIARY;41;DO;34
"RTN","PRCABJV",114,0)
 ;;EMERGENCY/HUMANITARIAN;25;H;2
"RTN","PRCABJV",115,0)
 ;;EX-EMPLOYEE;13;E;15
"RTN","PRCABJV",116,0)
 ;;FEDERAL AGENCIES-REFUND;15;F2;13
"RTN","PRCABJV",117,0)
 ;;FEDERAL AGENCIES-REIMB.;16;F1;14
"RTN","PRCABJV",118,0)
 ;;GERIATRIC EVAL-INSTITUTIONAL;44;GE;37
"RTN","PRCABJV",119,0)
 ;;GERIATRIC EVAL-NON-INSTITUTION;45;GN;38
"RTN","PRCABJV",120,0)
 ;;HOSPITAL CARE (NSC);1;HC;5
"RTN","PRCABJV",121,0)
 ;;HOSPITAL CARE PER DIEM;32;HP;25
"RTN","PRCABJV",122,0)
 ;;INELIGIBLE HOSP.;20;I;1
"RTN","PRCABJV",123,0)
 ;;INTERAGENCY;19;IA;20
"RTN","PRCABJV",124,0)
 ;;MEDICARE;28;MC;21
"RTN","PRCABJV",125,0)
 ;;MILITARY;17;M;12
"RTN","PRCABJV",126,0)
 ;;NO-FAULT AUTO ACC.;26;NA;7
"RTN","PRCABJV",127,0)
 ;;NURSING HOME CARE PER DIEM;31;NP;24
"RTN","PRCABJV",128,0)
 ;;NURSING HOME CARE(NSC);3;NC;3
"RTN","PRCABJV",129,0)
 ;;NURSING HOME CARE-LTC;46;NL;39
"RTN","PRCABJV",130,0)
 ;;OUTPATIENT CARE(NSC);2;OC;4
"RTN","PRCABJV",131,0)
 ;;PREPAYMENT;33;PP;26
"RTN","PRCABJV",132,0)
 ;;REIMBURS.HEALTH INS.;21;RI;9
"RTN","PRCABJV",133,0)
 ;;RESPITE CARE-INSTITUTIONAL;42;RC;35
"RTN","PRCABJV",134,0)
 ;;RESPITE CARE-NON-INSTITUTIONAL;43;RN;36
"RTN","PRCABJV",135,0)
 ;;RX CO-PAYMENT/NSC VET;30;PN;23
"RTN","PRCABJV",136,0)
 ;;RX CO-PAYMENT/SC VET;29;PS;22
"RTN","PRCABJV",137,0)
 ;;SHARING AGREEMENTS;18;SA;19
"RTN","PRCABJV",138,0)
 ;;TORT FEASOR;22;TF;10
"RTN","PRCABJV",139,0)
 ;;VENDOR;11;V;17
"RTN","PRCABJV",140,0)
 ;;WORKMAN'S COMP.;23;WC;6
"RTN","PRCABJV",141,0)
 ;;EOF
"RTN","PRCABJV",142,0)
EVENT ;
"RTN","PRCABJV",143,0)
 ;;CASH PAYMENT;6;;6
"RTN","PRCABJV",144,0)
 ;;CHECK/MO PAYMENT;4;;4
"RTN","PRCABJV",145,0)
 ;;COMMENT;1;;1
"RTN","PRCABJV",146,0)
 ;;CREDIT CARD PAYMENT;7;;7
"RTN","PRCABJV",147,0)
 ;;DEPT OF JUSTICE PAYMENT;5;;5
"RTN","PRCABJV",148,0)
 ;;REGIONAL COUNSEL PAYMENT;3;;3
"RTN","PRCABJV",149,0)
 ;;FOLLOW-UP LETTER;10;;10
"RTN","PRCABJV",150,0)
 ;;IRS PAYMENT;11;;11
"RTN","PRCABJV",151,0)
 ;;PATIENT STATEMENT;2;;2
"RTN","PRCABJV",152,0)
 ;;TDA PAYMENT;8;;8
"RTN","PRCABJV",153,0)
 ;;UB PRINTED;9;;9
"RTN","PRCABJV",154,0)
 ;;LOCKBOX;12;;12
"RTN","PRCABJV",155,0)
 ;;TOP PAYMENT;13;;13
"RTN","PRCABJV",156,0)
 ;;EDI LOCKBOX;14;;14
"RTN","PRCABJV",157,0)
 ;;EOF
"RTN","PRCACPV")
0^3^B13147911
"RTN","PRCACPV",1,0)
PRCACPV ;WASH-ISC@ALTOONA,PA/LDB- CHAMPVA FMS DOCUMENTS ;5/1/95  3:06 PM
"RTN","PRCACPV",2,0)
V ;;4.5;Accounts Receivable;**1,48,90,119,204,192**;Mar 20, 1995
"RTN","PRCACPV",3,0)
 ;
"RTN","PRCACPV",4,0)
EN(BILL,ERR) ;Send CHAMPVA SUBSISTENCE bill to FMS
"RTN","PRCACPV",5,0)
 N ADD,ADDR,AMT,BILL0,BNUM,CAT,DA,DIE,DOC,DR,ERROR,ENT,FY,GECSFMS,I,P,PAT,SITE,TXT,VA,VAERR,VADM,X,XMDUZ,XMTEXT,XMY,XMSUB,Y
"RTN","PRCACPV",6,0)
 S ERR=-1
"RTN","PRCACPV",7,0)
 I '$G(BILL) S ERR="NO BILL NUMBER TO PROCESS" D ERR Q
"RTN","PRCACPV",8,0)
 S BILL0=$G(^PRCA(430,+BILL,0)) I BILL0']"" S ERR="BILL INFO CORRUPTED FOR BILL '"_BILL D ERR Q
"RTN","PRCACPV",9,0)
 I "^27^28^30^31^"'[("^"_$P(BILL0,"^",2)_"^")  Q
"RTN","PRCACPV",10,0)
 I $P(BILL0,"^",2)=30,$$AUD^IBRFN(+BILL) Q
"RTN","PRCACPV",11,0)
 S SITE=$P($P(BILL0,"^"),"-") I SITE']"" S ERR="BILL NUMBER CORRUPTED" D ERR Q
"RTN","PRCACPV",12,0)
 S BNUM=$P(BILL0,"^")
"RTN","PRCACPV",13,0)
 S AMT=$J($P(BILL0,"^",3),0,2)
"RTN","PRCACPV",14,0)
 S CAT=$P(BILL0,"^",2)
"RTN","PRCACPV",15,0)
 I "^27^31^"[("^"_CAT_"^") S PAT=$P($G(^PRCA(430,+BILL,0)),"^",9),PAT=$P($G(^RCD(340,+PAT,0)),"^"),PAT=$$NAM^RCFN01(PAT),PAT=$P(PAT,",",2)_" "_$P(PAT,",")
"RTN","PRCACPV",16,0)
 S FY=$$FY^RCFN01(DT)
"RTN","PRCACPV",17,0)
 S ADD=$$SADD^RCFN01(5)
"RTN","PRCACPV",18,0)
 S DESC=$S(CAT=27:"CHAMPVA Subsistence",CAT=30:"TRICARE",CAT=31:"TRICARE PATIENT",1:"CHAMPVA Third Party")
"RTN","PRCACPV",19,0)
 F I=1:1:6 S ADDR(I)=$P(ADD,"^",I) I (I'=3),(ADDR(I)']"") S ERR="NO HOSPITAL ADDRESS FOUND FOR SITE GROUP" D ERR Q
"RTN","PRCACPV",20,0)
 I ERR>0 Q
"RTN","PRCACPV",21,0)
 ;CALL TO GET VENDORID BELOW - CHECK NOT NECESSARY SINCE GENERIC
"RTN","PRCACPV",22,0)
 ;VENDOR CODE ALWAYS RETURNED FOR THESE BILL TYPES
"RTN","PRCACPV",23,0)
 S VENDORID=$$VENDORID^RCXFMSUV(BILL)
"RTN","PRCACPV",24,0)
 I ADDR(6)["-" S ADDR(7)=$P(ADDR(6),"-",2),ADDR(6)=$P(ADDR(6),"-")
"RTN","PRCACPV",25,0)
 N FMSDT S FMSDT=$$FMSDATE^RCBEUTRA(DT)
"RTN","PRCACPV",26,0)
 S ^TMP("PRCACPV",$J,1)="BD2^"_$E(FMSDT,4,5)_"^"_$E(FMSDT,6,7)_"^"_$E(FMSDT,2,3)
"RTN","PRCACPV",27,0)
 S ^TMP("PRCACPV",$J,1)=^TMP("PRCACPV",$J,1)_"^^^^^^E^"_VENDORID_"^^"_AMT_"^^^^"_$E(ADDR(1),1,30)_"^"_$E(ADDR(2),1,30)_"^"_$E(ADDR(3),1,30)_"^"_$E(ADDR(4),1,19)_"^"_ADDR(5)_"^"_ADDR(6)_"^"_$G(ADDR(7))_"^"_"N^^^^^^W^~"
"RTN","PRCACPV",28,0)
 S ^TMP("PRCACPV",$J,2)="LIN^~BDA^"_$$LINE^RCXFMSC1(BILL)_"^"_FY_"^^"_$S(CAT<30:"3220",1:"0160A1")_"^"_SITE_"^^^"
"RTN","PRCACPV",29,0)
 S:CAT<30 CAT("R")=1000
"RTN","PRCACPV",30,0)
 I CAT'<30 S CAT("R")=$P($G(^PRCA(430,+BILL,11)),U,6)
"RTN","PRCACPV",31,0)
 S ^TMP("PRCACPV",$J,2)=^TMP("PRCACPV",$J,2)_CAT("R")_"^^^^^^^"_AMT_"^I^AR_INTERFACE^^^^"_$S(CAT<30:"09",1:"02")_"^~"
"RTN","PRCACPV",32,0)
 D CONTROL^GECSUFMS("A",SITE,BNUM,"BD",10,0,"",DESC)
"RTN","PRCACPV",33,0)
 I '$D(GECSFMS("DA")) S ERR="COULD NOT ACCESS STACK FILE" D ERR Q
"RTN","PRCACPV",34,0)
 S DOC=$S($G(GECSFMS("DOC"))]"":$P(GECSFMS("DOC"),"^",3)_"-"_$P(GECSFMS("DOC"),"^",4),1:BNUM)
"RTN","PRCACPV",35,0)
 S DA=0 F  S DA=$O(^TMP("PRCACPV",$J,DA)) Q:'DA  D
"RTN","PRCACPV",36,0)
 . D SETCS^GECSSTAA(GECSFMS("DA"),^TMP("PRCACPV",$J,DA))
"RTN","PRCACPV",37,0)
 D OPEN^RCFMDRV1(DOC,6,"B"_+BILL,.ENT,.ERROR,+BILL)
"RTN","PRCACPV",38,0)
 I ERROR]"" S ERR="AR DOCUMENT MISSING - "_ERROR Q
"RTN","PRCACPV",39,0)
 D SETCODE^GECSSDCT(GECSFMS("DA"),"D RETN^RCFMFN02")
"RTN","PRCACPV",40,0)
 D SETSTAT^GECSSTAA(GECSFMS("DA"),"Q")
"RTN","PRCACPV",41,0)
 D SSTAT^RCFMFN02("B"_+BILL,1)
"RTN","PRCACPV",42,0)
 K ^TMP("PRCACPV",$J)
"RTN","PRCACPV",43,0)
 ;
"RTN","PRCACPV",44,0)
ERR I ERR'<0 S ERR="1^"_ERR D
"RTN","PRCACPV",45,0)
 .S TXT(1)="The following error has occurred while processing a "_$S(CAT=31:"TRICARE PATIENT ",1:"CHAMPVA")
"RTN","PRCACPV",46,0)
 .S TXT(2)="bill: ("_$S($G(BNUM):BNUM,1:"BILL IFN - "_+BILL)_")"
"RTN","PRCACPV",47,0)
 .S TXT(3)=" "
"RTN","PRCACPV",48,0)
 .S TXT(4)=$P(ERR,"^",2)
"RTN","PRCACPV",49,0)
 .S TXT(5)=""
"RTN","PRCACPV",50,0)
 .S TXT(6)="You will need to use the BILLING DOCUMENT REGENERATION option to create the FMS document."
"RTN","PRCACPV",51,0)
 .S XMTEXT="TXT(",XMY("G.PRCA ERROR")=""
"RTN","PRCACPV",52,0)
 .S XMSUB=$S(CAT=31:"TRICARE PATIENT",1:"CHAMPVA")_" FMS DOC error",XMDUZ="ACCOUNTS RECEIVABLE PACKAGE"
"RTN","PRCACPV",53,0)
 .D ^XMD
"RTN","PRCACPV",54,0)
 Q
"RTN","RCBEUTR1")
0^5^B31839795
"RTN","RCBEUTR1",1,0)
RCBEUTR1 ;WISC/RFJ-add int,admin chg or increase,decrease principal  ;1 Jun 00
"RTN","RCBEUTR1",2,0)
 ;;4.5;Accounts Receivable;**153,169,192**;Mar 20, 1995
"RTN","RCBEUTR1",3,0)
 ;;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","RCBEUTR1",4,0)
 Q
"RTN","RCBEUTR1",5,0)
 ;
"RTN","RCBEUTR1",6,0)
 ;
"RTN","RCBEUTR1",7,0)
INTADM(RCBILLDA,RCVALUE,RCCOMMNT,RCDATE) ;  add an intererst/admin charge (transaction type=13)
"RTN","RCBEUTR1",8,0)
 ;  for a bill.  rcvalue = interest ^ admin ^ penalty ^ marshal fee ^ court cost
"RTN","RCBEUTR1",9,0)
 ;  for the transaction.  rcdate = process date (optional)
"RTN","RCBEUTR1",10,0)
 ;  returns transaction number if successful
"RTN","RCBEUTR1",11,0)
 ;
"RTN","RCBEUTR1",12,0)
 N RCDRSTRG,RCTRANDA,Y
"RTN","RCBEUTR1",13,0)
 ;  add the transaction (if added to 433, transaction is locked)
"RTN","RCBEUTR1",14,0)
 S RCTRANDA=$$ADD433^RCBEUTRA(RCBILLDA,13) I 'RCTRANDA Q 0
"RTN","RCBEUTR1",15,0)
 ;
"RTN","RCBEUTR1",16,0)
 ;  build dr string
"RTN","RCBEUTR1",17,0)
 ;  transaction date (strip off time)
"RTN","RCBEUTR1",18,0)
 S RCDRSTRG="11////"_$S($G(RCDATE):$P(RCDATE,"."),1:DT)_";"
"RTN","RCBEUTR1",19,0)
 ;
"RTN","RCBEUTR1",20,0)
 ;  transaction values
"RTN","RCBEUTR1",21,0)
 S RCDRSTRG=RCDRSTRG_"15////"_($P(RCVALUE,"^")+$P(RCVALUE,"^",2)+$P(RCVALUE,"^",3)+$P(RCVALUE,"^",4)+$P(RCVALUE,"^",5))_";"
"RTN","RCBEUTR1",22,0)
 I $P(RCVALUE,"^",4) S RCDRSTRG=RCDRSTRG_"25////"_$P(RCVALUE,"^",4)_";"  ;marshal fee
"RTN","RCBEUTR1",23,0)
 I $P(RCVALUE,"^",5) S RCDRSTRG=RCDRSTRG_"26////"_$P(RCVALUE,"^",5)_";"  ;court cost
"RTN","RCBEUTR1",24,0)
 I $P(RCVALUE,"^",1) S RCDRSTRG=RCDRSTRG_"27////"_$P(RCVALUE,"^",1)_";"  ;interest
"RTN","RCBEUTR1",25,0)
 I $P(RCVALUE,"^",2) S RCDRSTRG=RCDRSTRG_"28////"_$P(RCVALUE,"^",2)_";"  ;admin
"RTN","RCBEUTR1",26,0)
 I $P(RCVALUE,"^",3) S RCDRSTRG=RCDRSTRG_"29////"_$P(RCVALUE,"^",3)_";"  ;penalty
"RTN","RCBEUTR1",27,0)
 I $G(RCDATE) S RCDRSTRG=RCDRSTRG_"19////"_RCDATE_";"  ;date entered
"RTN","RCBEUTR1",28,0)
 ;
"RTN","RCBEUTR1",29,0)
 ;  input the fields for the transaction
"RTN","RCBEUTR1",30,0)
 S Y=$$EDIT433^RCBEUTRA(RCTRANDA,RCDRSTRG) I 'Y L -^PRCA(433,RCTRANDA) Q 0
"RTN","RCBEUTR1",31,0)
 ;
"RTN","RCBEUTR1",32,0)
 ;  set the comment
"RTN","RCBEUTR1",33,0)
 I $D(RCCOMMNT(1)) D ADDCOMM^RCBEUTRA(RCTRANDA,.RCCOMMNT)
"RTN","RCBEUTR1",34,0)
 ;
"RTN","RCBEUTR1",35,0)
 ;  move over 433 from 430 (no principal, just move it)
"RTN","RCBEUTR1",36,0)
 D FY433^RCBEUTRA(RCTRANDA)
"RTN","RCBEUTR1",37,0)
 ;
"RTN","RCBEUTR1",38,0)
 ;  mark transaction as processed
"RTN","RCBEUTR1",39,0)
 D PROCESS^RCBEUTRA(RCTRANDA)
"RTN","RCBEUTR1",40,0)
 ;
"RTN","RCBEUTR1",41,0)
 ;  update the bill file with the balance of the transaction
"RTN","RCBEUTR1",42,0)
 D SETBAL^RCBEUBIL(RCTRANDA)
"RTN","RCBEUTR1",43,0)
 ;
"RTN","RCBEUTR1",44,0)
 ;  if the bill has no balance, close or cancel it
"RTN","RCBEUTR1",45,0)
 D CLOSEIT(RCBILLDA)
"RTN","RCBEUTR1",46,0)
 ;
"RTN","RCBEUTR1",47,0)
 ;  clear the lock and return the transaction added
"RTN","RCBEUTR1",48,0)
 L -^PRCA(433,RCTRANDA)
"RTN","RCBEUTR1",49,0)
 Q RCTRANDA
"RTN","RCBEUTR1",50,0)
 ;
"RTN","RCBEUTR1",51,0)
INCDEC(RCBILLDA,RCVALUE,RCCOMMNT,RCDATE,RCPREPAY,RCONTADJ) ;  automatically
"RTN","RCBEUTR1",52,0)
 ;  create an increase or decrease adjustment for a bill
"RTN","RCBEUTR1",53,0)
 ;  pass variables:
"RTN","RCBEUTR1",54,0)
 ;      rcvalue  = principal value for the transaction.
"RTN","RCBEUTR1",55,0)
 ;                 if rcvalue is less than zero, it will create a
"RTN","RCBEUTR1",56,0)
 ;                 decrease adjustment.  if rcvalue is greater than
"RTN","RCBEUTR1",57,0)
 ;                 zero, it will create an increase adjustment.
"RTN","RCBEUTR1",58,0)
 ;      rccommnt = the comments for the word processing field.
"RTN","RCBEUTR1",59,0)
 ;      rcdate   = optional processing date and time.  if not
"RTN","RCBEUTR1",60,0)
 ;                 passed, the current date and time will be used
"RTN","RCBEUTR1",61,0)
 ;      rcprepay = optional prepayment transaction.  this is the
"RTN","RCBEUTR1",62,0)
 ;                 payment transaction applied to the bill to
"RTN","RCBEUTR1",63,0)
 ;                 create the decrease adjustment.  this gets
"RTN","RCBEUTR1",64,0)
 ;                 stored in field 20 (file 433).
"RTN","RCBEUTR1",65,0)
 ;      rcontadj = optional contract adjustment.  if 1 then this
"RTN","RCBEUTR1",66,0)
 ;                 gets stored in field 88 (file 433).
"RTN","RCBEUTR1",67,0)
 ;
"RTN","RCBEUTR1",68,0)
 ;  returns transaction number added to 433 if successful.
"RTN","RCBEUTR1",69,0)
 ;
"RTN","RCBEUTR1",70,0)
 N ADJNUMB,RCDRSTRG,RCTRANDA,X,Y
"RTN","RCBEUTR1",71,0)
 ;
"RTN","RCBEUTR1",72,0)
 ;  add the transaction (if added to 433, transaction is locked)
"RTN","RCBEUTR1",73,0)
 S RCTRANDA=$$ADD433^RCBEUTRA(RCBILLDA,$S(RCVALUE>0:1,1:35)) I 'RCTRANDA Q 0
"RTN","RCBEUTR1",74,0)
 ;
"RTN","RCBEUTR1",75,0)
 ;  build dr string
"RTN","RCBEUTR1",76,0)
 ;  11=transaction date (strip off time)
"RTN","RCBEUTR1",77,0)
 S RCDRSTRG="11////"_$S($G(RCDATE):$P(RCDATE,"."),1:DT)_";"
"RTN","RCBEUTR1",78,0)
 ;  transaction value (make sure it is not negative)
"RTN","RCBEUTR1",79,0)
 I RCVALUE<0 S RCVALUE=-RCVALUE
"RTN","RCBEUTR1",80,0)
 S RCDRSTRG=RCDRSTRG_"15////"_RCVALUE_";"
"RTN","RCBEUTR1",81,0)
 S RCDRSTRG=RCDRSTRG_"81////"_RCVALUE_";"
"RTN","RCBEUTR1",82,0)
 ;
"RTN","RCBEUTR1",83,0)
 ;  get the next adjustment number if increase(1) or decrease(35)
"RTN","RCBEUTR1",84,0)
 ;  start with the last transaction and work backwards
"RTN","RCBEUTR1",85,0)
 S X=999999999999,ADJNUMB=1
"RTN","RCBEUTR1",86,0)
 F  S X=$O(^PRCA(433,"C",RCBILLDA,X),-1) Q:'X  I $P($G(^PRCA(433,X,1)),"^",4) I $P(^(1),"^",2)=1!($P(^(1),"^",2)=35) S ADJNUMB=$P(^(1),"^",4)+1 Q
"RTN","RCBEUTR1",87,0)
 S RCDRSTRG=RCDRSTRG_"14////"_ADJNUMB_";"
"RTN","RCBEUTR1",88,0)
 ;
"RTN","RCBEUTR1",89,0)
 ;  date entered
"RTN","RCBEUTR1",90,0)
 I $G(RCDATE) S RCDRSTRG=RCDRSTRG_"19////"_RCDATE_";"
"RTN","RCBEUTR1",91,0)
 ;
"RTN","RCBEUTR1",92,0)
 ;  store the prepayment transaction
"RTN","RCBEUTR1",93,0)
 I $G(RCPREPAY) D
"RTN","RCBEUTR1",94,0)
 .   S RCDRSTRG=RCDRSTRG_"20////"_RCPREPAY_";"
"RTN","RCBEUTR1",95,0)
 .   ;  for prepayments, set the incomplete transaction flag
"RTN","RCBEUTR1",96,0)
 .   ;  this will no longer be used after patch 146 and can
"RTN","RCBEUTR1",97,0)
 .   ;  be removed
"RTN","RCBEUTR1",98,0)
 .   S RCDRSTRG=RCDRSTRG_"10////1;"
"RTN","RCBEUTR1",99,0)
 ;
"RTN","RCBEUTR1",100,0)
 ;  contract adjustment
"RTN","RCBEUTR1",101,0)
 I $G(RCONTADJ) S RCDRSTRG=RCDRSTRG_"88///1;"
"RTN","RCBEUTR1",102,0)
 ;
"RTN","RCBEUTR1",103,0)
 ;  input the fields for the transaction
"RTN","RCBEUTR1",104,0)
 S Y=$$EDIT433^RCBEUTRA(RCTRANDA,RCDRSTRG) I 'Y L -^PRCA(433,RCTRANDA) Q 0
"RTN","RCBEUTR1",105,0)
 ;
"RTN","RCBEUTR1",106,0)
 ;  set the comment
"RTN","RCBEUTR1",107,0)
 I $D(RCCOMMNT(1)) D ADDCOMM^RCBEUTRA(RCTRANDA,.RCCOMMNT)
"RTN","RCBEUTR1",108,0)
 ;
"RTN","RCBEUTR1",109,0)
 ;  mark the transaction processed
"RTN","RCBEUTR1",110,0)
 D PROCESS^RCBEUTRA(RCTRANDA)
"RTN","RCBEUTR1",111,0)
 ;
"RTN","RCBEUTR1",112,0)
 ;  update the fiscal year multiple (must be done after marked as
"RTN","RCBEUTR1",113,0)
 ;  processed so the value is defined)
"RTN","RCBEUTR1",114,0)
 D FYMULT^RCBEUTRA(RCTRANDA)
"RTN","RCBEUTR1",115,0)
 ;
"RTN","RCBEUTR1",116,0)
 ;  update the bill file with the balance of the transaction
"RTN","RCBEUTR1",117,0)
 D SETBAL^RCBEUBIL(RCTRANDA)
"RTN","RCBEUTR1",118,0)
 ;
"RTN","RCBEUTR1",119,0)
 ;  if the bill has no balance, close or cancel it
"RTN","RCBEUTR1",120,0)
 D CLOSEIT(RCBILLDA)
"RTN","RCBEUTR1",121,0)
 ;
"RTN","RCBEUTR1",122,0)
 ;  send FMS document if non-accrued (redo this later on)
"RTN","RCBEUTR1",123,0)
 I '$$ACCK^PRCAACC(RCBILLDA) D
"RTN","RCBEUTR1",124,0)
 .   N D0,DA,DI,DIC,DIE,DIQ2,DQ,DR,ENT,FMSNUM,GECSDATA
"RTN","RCBEUTR1",125,0)
 .   N CATEG,DATA1,ERR
"RTN","RCBEUTR1",126,0)
 .   S CATEG=$P($G(^PRCA(430,RCBILLDA,0)),"^",2)
"RTN","RCBEUTR1",127,0)
 .   ;
"RTN","RCBEUTR1",128,0)
 .   ;  category=29 champva, do not send to fms, quit
"RTN","RCBEUTR1",129,0)
 .   I CATEG=29 Q
"RTN","RCBEUTR1",130,0)
 .   ;
"RTN","RCBEUTR1",131,0)
 .   ;  category=30 tricare or 32 tricare third party, and contract adj
"RTN","RCBEUTR1",132,0)
 .   I (CATEG=30!(CATEG=32)),$P($G(^PRCA(430,RCBILLDA,8)),"^",8) D  Q
"RTN","RCBEUTR1",133,0)
 .   .   S DATA1=$G(^PRCA(433,RCTRANDA,1))
"RTN","RCBEUTR1",134,0)
 .   .   D EN^PRCAFWO(RCBILLDA,$P(DATA1,"^",1),$P(DATA1,"^",5),$$SITE^RCMSITE,RCTRANDA)
"RTN","RCBEUTR1",135,0)
 .   ;
"RTN","RCBEUTR1",136,0)
 .   ;  all other categories
"RTN","RCBEUTR1",137,0)
 .   ;  pass trans amount(1;5),trans type(1;2),trans date(1;1)
"RTN","RCBEUTR1",138,0)
 .   S DATA1=$G(^PRCA(433,RCTRANDA,1))
"RTN","RCBEUTR1",139,0)
 .   D EN^PRCAFBDM(RCBILLDA,$P(DATA1,"^",5),$P(DATA1,"^",2),$P(DATA1,"^",1),RCTRANDA,.ERR)
"RTN","RCBEUTR1",140,0)
 ;
"RTN","RCBEUTR1",141,0)
 ;  clear the lock and return the transaction added
"RTN","RCBEUTR1",142,0)
 L -^PRCA(433,RCTRANDA)
"RTN","RCBEUTR1",143,0)
 Q RCTRANDA
"RTN","RCBEUTR1",144,0)
 ;
"RTN","RCBEUTR1",145,0)
 ;
"RTN","RCBEUTR1",146,0)
CLOSEIT(RCBILLDA) ;  check to cancel or close bill with no balance
"RTN","RCBEUTR1",147,0)
 N AMTPAID,BILLBAL,DATA7,TRANDA
"RTN","RCBEUTR1",148,0)
 ;  if the bill has no balance, close or cancel it
"RTN","RCBEUTR1",149,0)
 S DATA7=$G(^PRCA(430,RCBILLDA,7))
"RTN","RCBEUTR1",150,0)
 S BILLBAL=$P(DATA7,"^")+$P(DATA7,"^",2)+$P(DATA7,"^",3)+$P(DATA7,"^",4)+$P(DATA7,"^",5)
"RTN","RCBEUTR1",151,0)
 I 'BILLBAL D
"RTN","RCBEUTR1",152,0)
 .   ;  get payments recorded against the bill.  if payments have been
"RTN","RCBEUTR1",153,0)
 .   ;  made, then the status of the bill should be collected/closed.
"RTN","RCBEUTR1",154,0)
 .   S AMTPAID=$P(DATA7,"^",7)+$P(DATA7,"^",8)+$P(DATA7,"^",9)+$P(DATA7,"^",10)+$P(DATA7,"^",11)
"RTN","RCBEUTR1",155,0)
 .   I AMTPAID D CHGSTAT^RCBEUBIL(RCBILLDA,22) Q
"RTN","RCBEUTR1",156,0)
 .   ;  if the last transaction was a decrease contract adjustment,
"RTN","RCBEUTR1",157,0)
 .   ;  then the status will be collected/closed
"RTN","RCBEUTR1",158,0)
 .   S TRANDA=+$O(^PRCA(433,"C",RCBILLDA,999999999999),-1)
"RTN","RCBEUTR1",159,0)
 .   I $P($G(^PRCA(433,TRANDA,8)),"^",8) D CHGSTAT^RCBEUBIL(RCBILLDA,22) Q
"RTN","RCBEUTR1",160,0)
 .   ;  otherwise it should be cancellation
"RTN","RCBEUTR1",161,0)
 .   D CHGSTAT^RCBEUBIL(RCBILLDA,39)
"RTN","RCBEUTR1",162,0)
 Q
"RTN","RCCPCPS1")
0^6^B36852341
"RTN","RCCPCPS1",1,0)
RCCPCPS1 ;WISC/RFJ-build description for patient statement ;08 Aug 2001
"RTN","RCCPCPS1",2,0)
 ;;4.5;Accounts Receivable;**34,48,104,170,176,192**;Mar 20, 1995
"RTN","RCCPCPS1",3,0)
 ;;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","RCCPCPS1",4,0)
 Q
"RTN","RCCPCPS1",5,0)
 ;
"RTN","RCCPCPS1",6,0)
 ;
"RTN","RCCPCPS1",7,0)
TRANDESC(RCTRANDA,RCWIDTH) ;  build the description array for a transaction
"RTN","RCCPCPS1",8,0)
 ;
"RTN","RCCPCPS1",9,0)
 ;  initialize
"RTN","RCCPCPS1",10,0)
 N DESCRIPT,RCBILLDA,RCCATEG,RCCATTXT,RCDATA0,RCDATA1,RCDATA3,RCLINE,TRANTYPE,X
"RTN","RCCPCPS1",11,0)
 I '$G(RCWIDTH) S RCWIDTH=50 ; Default max. width is 50 characters
"RTN","RCCPCPS1",12,0)
 K RCDESC
"RTN","RCCPCPS1",13,0)
 S RCLINE=1,RCDESC(1)=""
"RTN","RCCPCPS1",14,0)
 ;
"RTN","RCCPCPS1",15,0)
 S RCBILLDA=+$P($G(^PRCA(433,RCTRANDA,0)),"^",2) I 'RCBILLDA Q
"RTN","RCCPCPS1",16,0)
 S RCDATA0=^PRCA(430,RCBILLDA,0)
"RTN","RCCPCPS1",17,0)
 S RCCATEG=+$P(RCDATA0,"^",2),RCCATTXT=$P($G(^PRCA(430.2,RCCATEG,0)),"^")
"RTN","RCCPCPS1",18,0)
 S RCDATA1=^PRCA(433,RCTRANDA,1)
"RTN","RCCPCPS1",19,0)
 S TRANTYPE=$P(RCDATA1,"^",2)
"RTN","RCCPCPS1",20,0)
 ;
"RTN","RCCPCPS1",21,0)
 ;  build the first line description
"RTN","RCCPCPS1",22,0)
 ;  if transaction type is an increase or decrease, set description
"RTN","RCCPCPS1",23,0)
 I TRANTYPE=1!(TRANTYPE=35) D
"RTN","RCCPCPS1",24,0)
 .   ;  if c means test, set description to category for c means test
"RTN","RCCPCPS1",25,0)
 .   I RCCATEG=18 S DESCRIPT=$S($P(RCDATA0,"^",16):$P(^PRCA(430.2,$P(RCDATA0,"^",16),0),"^"),1:RCCATTXT) Q
"RTN","RCCPCPS1",26,0)
 .   ;  otherwise, set to category name
"RTN","RCCPCPS1",27,0)
 .   S DESCRIPT=RCCATTXT
"RTN","RCCPCPS1",28,0)
 ;
"RTN","RCCPCPS1",29,0)
 ;  if the bill category is a rx-copay and it is an increase adjustment
"RTN","RCCPCPS1",30,0)
 ;  then set the description to copay
"RTN","RCCPCPS1",31,0)
 I RCCATEG=22!(RCCATEG=23),TRANTYPE=1 S DESCRIPT="COPAY"
"RTN","RCCPCPS1",32,0)
 ;
"RTN","RCCPCPS1",33,0)
 ;  if the bill category is adult day health care, remove health
"RTN","RCCPCPS1",34,0)
 I RCCATEG=33 S DESCRIPT="ADULT DAY CARE"
"RTN","RCCPCPS1",35,0)
 ;
"RTN","RCCPCPS1",36,0)
 ;  if the bill category is respite or geriatric eval,
"RTN","RCCPCPS1",37,0)
 ;  take the 2nd piece removing institutional
"RTN","RCCPCPS1",38,0)
 I RCCATEG=35!(RCCATEG=36)!(RCCATEG=37)!(RCCATEG=38) S DESCRIPT=$P(RCCATTXT,"-")_$S(RCCATEG=35!(RCCATEG=37):" IN",1:" OUT")_"PATIENT"
"RTN","RCCPCPS1",39,0)
 ;
"RTN","RCCPCPS1",40,0)
 ;  if it is a comment transaction
"RTN","RCCPCPS1",41,0)
 I TRANTYPE=45 S DESCRIPT="COMMENT: "_$P($G(^PRCA(433,RCTRANDA,5)),"^",2)
"RTN","RCCPCPS1",42,0)
 ;
"RTN","RCCPCPS1",43,0)
 ;  prepayment bill (1=increase, 35=decrease, otherwise refund)
"RTN","RCCPCPS1",44,0)
 I RCCATEG=26 S DESCRIPT=$S(TRANTYPE=1:"OVERPAYMENT CREDIT",TRANTYPE=35:"OVERPAYMENT CREDIT DECREASE",1:"OVERPAYMENT REFUND")
"RTN","RCCPCPS1",45,0)
 ;
"RTN","RCCPCPS1",46,0)
 ;  if the first line description not set (like payments), set it
"RTN","RCCPCPS1",47,0)
 ;  to the type of transaction
"RTN","RCCPCPS1",48,0)
 I $G(DESCRIPT)="" S DESCRIPT=$P($G(^PRCA(430.3,+$P(RCDATA1,"^",2),0)),"^")
"RTN","RCCPCPS1",49,0)
 ;
"RTN","RCCPCPS1",50,0)
 ;  if the transaction date is different from the process date,
"RTN","RCCPCPS1",51,0)
 ;  show it with the description
"RTN","RCCPCPS1",52,0)
 I $P(RCDATA1,"^"),$P($P(RCDATA1,"^"),".")'=$P($P(RCDATA1,"^",9),".") S DESCRIPT=DESCRIPT_"  ("_$$DATE($P($P(RCDATA1,"^"),"."))_")"
"RTN","RCCPCPS1",53,0)
 ;
"RTN","RCCPCPS1",54,0)
 ;  set the first description line
"RTN","RCCPCPS1",55,0)
 D SETDESC(DESCRIPT)
"RTN","RCCPCPS1",56,0)
 ;
"RTN","RCCPCPS1",57,0)
 ;  if it is a payment transaction, show amount paid interest, admin, other
"RTN","RCCPCPS1",58,0)
 I TRANTYPE=2!(TRANTYPE=34) D
"RTN","RCCPCPS1",59,0)
 .   S RCDATA3=$G(^PRCA(433,RCTRANDA,3))
"RTN","RCCPCPS1",60,0)
 .   ;  if not interest, admin, or other, quit
"RTN","RCCPCPS1",61,0)
 .   I '$P(RCDATA3,"^",2),'$P(RCDATA3,"^",3),'$P(RCDATA3,"^",4),'$P(RCDATA3,"^",5) Q
"RTN","RCCPCPS1",62,0)
 .   ;
"RTN","RCCPCPS1",63,0)
 .   S DESCRIPT="  (Int:"_$J(+$P(RCDATA3,"^",2),1,2)_"  Adm:"_$J(+$P(RCDATA3,"^",3),1,2)
"RTN","RCCPCPS1",64,0)
 .   ;  calculate other
"RTN","RCCPCPS1",65,0)
 .   S X=$P(RCDATA1,"^",5)-$P(RCDATA3,"^")-$P(RCDATA3,"^",2)-$P(RCDATA3,"^",3)
"RTN","RCCPCPS1",66,0)
 .   S DESCRIPT=DESCRIPT_$S(X:" Other:"_$J(X,1,2)_")",1:")")
"RTN","RCCPCPS1",67,0)
 .   D SETDESC(DESCRIPT)
"RTN","RCCPCPS1",68,0)
 ;
"RTN","RCCPCPS1",69,0)
 ;  if it is a admin cost or interest charge, total the amounts
"RTN","RCCPCPS1",70,0)
 I TRANTYPE=13!(TRANTYPE=12) D  Q
"RTN","RCCPCPS1",71,0)
 .   S X=$G(^PRCA(433,RCTRANDA,2)) I X="" Q
"RTN","RCCPCPS1",72,0)
 .   S RCTOTAL("INT")=$G(RCTOTAL("INT"))+$P(X,"^",7)
"RTN","RCCPCPS1",73,0)
 .   S RCTOTAL("ADM")=$G(RCTOTAL("ADM"))+$P(X,"^",8)
"RTN","RCCPCPS1",74,0)
 .   S RCTOTAL("OTH")=$G(RCTOTAL("OTH"))+($P(RCDATA1,"^",5)-$P(X,"^",7)-$P(X,"^",8))
"RTN","RCCPCPS1",75,0)
 ;
"RTN","RCCPCPS1",76,0)
 ;  if not an increase adjustment, quit
"RTN","RCCPCPS1",77,0)
 I TRANTYPE'=1 Q
"RTN","RCCPCPS1",78,0)
 ;
"RTN","RCCPCPS1",79,0)
 ;  increase to c means test, ltc or rx-copay, get data from ib
"RTN","RCCPCPS1",80,0)
 I RCCATEG=18!(RCCATEG=22)!(RCCATEG=23)!((RCCATEG>32)&(RCCATEG<40)) D
"RTN","RCCPCPS1",81,0)
 .   S X="IBRFN1" X ^%ZOSF("TEST") I '$T Q
"RTN","RCCPCPS1",82,0)
 .   K ^TMP("IBRFN1",$J)
"RTN","RCCPCPS1",83,0)
 .   D STMT^IBRFN1(RCTRANDA)
"RTN","RCCPCPS1",84,0)
 .   D IBDATA
"RTN","RCCPCPS1",85,0)
 Q
"RTN","RCCPCPS1",86,0)
 ;
"RTN","RCCPCPS1",87,0)
 ;
"RTN","RCCPCPS1",88,0)
 ;  Returns RCDESC(1..n) array of Bill Description
"RTN","RCCPCPS1",89,0)
BILLDESC(RCBILLDA,RCWIDTH) ;
"RTN","RCCPCPS1",90,0)
 ;  initialize
"RTN","RCCPCPS1",91,0)
 N DESCRIPT,RCCATEG,RCCATTXT,RCDATA0,RCLINE,X
"RTN","RCCPCPS1",92,0)
 I '$G(RCWIDTH) S RCWIDTH=50 ; Default max. width is 50 characters
"RTN","RCCPCPS1",93,0)
 K RCDESC
"RTN","RCCPCPS1",94,0)
 S RCLINE=1,RCDESC(1)=""
"RTN","RCCPCPS1",95,0)
 ;
"RTN","RCCPCPS1",96,0)
 S RCDATA0=^PRCA(430,RCBILLDA,0)
"RTN","RCCPCPS1",97,0)
 S RCCATEG=+$P(RCDATA0,"^",2),RCCATTXT=$P($G(^PRCA(430.2,RCCATEG,0)),"^")
"RTN","RCCPCPS1",98,0)
 ;
"RTN","RCCPCPS1",99,0)
 ;  if category=c means test, set the description and quit
"RTN","RCCPCPS1",100,0)
 I RCCATEG=18 S DESCRIPT=$S($P(RCDATA0,"^",16):$P(^PRCA(430.2,$P(RCDATA0,"^",16),0),"^"),1:RCCATTXT) D SETDESC(DESCRIPT) Q
"RTN","RCCPCPS1",101,0)
 ;
"RTN","RCCPCPS1",102,0)
 ;  set the category description
"RTN","RCCPCPS1",103,0)
 D SETDESC(RCCATTXT)
"RTN","RCCPCPS1",104,0)
 ;
"RTN","RCCPCPS1",105,0)
 ;  if category not champva subsitence and not tricare patient, quit
"RTN","RCCPCPS1",106,0)
 I RCCATEG'=27,RCCATEG'=31 Q
"RTN","RCCPCPS1",107,0)
 ;
"RTN","RCCPCPS1",108,0)
 ;  build description for champva subsistence and tricare patient bills
"RTN","RCCPCPS1",109,0)
 ;  get data from ib
"RTN","RCCPCPS1",110,0)
 S X="IBRFN1" X ^%ZOSF("TEST") I '$T Q
"RTN","RCCPCPS1",111,0)
 K ^TMP("IBRFN1",$J)
"RTN","RCCPCPS1",112,0)
 D STMTB^IBRFN1($P(RCDATA0,"^"))
"RTN","RCCPCPS1",113,0)
 D IBDATA
"RTN","RCCPCPS1",114,0)
 Q
"RTN","RCCPCPS1",115,0)
 ;
"RTN","RCCPCPS1",116,0)
 ;
"RTN","RCCPCPS1",117,0)
IBDATA ;  get data from IB for description
"RTN","RCCPCPS1",118,0)
 N IBDATA,IBJ
"RTN","RCCPCPS1",119,0)
 ;
"RTN","RCCPCPS1",120,0)
 ;  show IB data
"RTN","RCCPCPS1",121,0)
 S IBJ=0 F  S IBJ=$O(^TMP("IBRFN1",$J,IBJ)) Q:'IBJ  S IBDATA=^TMP("IBRFN1",$J,IBJ) D
"RTN","RCCPCPS1",122,0)
 .   ;
"RTN","RCCPCPS1",123,0)
 .   ;  if no drug or bill date returned from IB, then it is outpatient
"RTN","RCCPCPS1",124,0)
 .   I $P(IBDATA,"^",3)="" D:$P(IBDATA,"^",2) SETDESC("VISIT DATE: "_$$DATE($P(IBDATA,"^",2))) Q
"RTN","RCCPCPS1",125,0)
 .   ;
"RTN","RCCPCPS1",126,0)
 .   ;  if no drug quantity returned from ib, then it is inpatient
"RTN","RCCPCPS1",127,0)
 .   I '$P(IBDATA,"^",6) D  Q
"RTN","RCCPCPS1",128,0)
 .   .   I $P(IBDATA,"^",2) D SETDESC("  ADMISSION DATE: "_$$DATE($P(IBDATA,"^",2)))
"RTN","RCCPCPS1",129,0)
 .   .   I $P(IBDATA,"^",3) D SETDESC("  BEGINNING DATE OF BILLING CYCLE: "_$$DATE($P(IBDATA,"^",3)))
"RTN","RCCPCPS1",130,0)
 .   .   I $P(IBDATA,"^",4) D SETDESC("  ENDING DATE OF BILLING CYCLE: "_$$DATE($P(IBDATA,"^",4)))
"RTN","RCCPCPS1",131,0)
 .   .   I $P(IBDATA,"^",5) D SETDESC("  DISCHARGE DATE: "_$$DATE($P(IBDATA,"^",5)))
"RTN","RCCPCPS1",132,0)
 .   ;
"RTN","RCCPCPS1",133,0)
 .   ;  pharmacy
"RTN","RCCPCPS1",134,0)
 .   D:$P(IBDATA,"^",2) SETDESC("RX:"_$P(IBDATA,"^",2))
"RTN","RCCPCPS1",135,0)
 .   D:$P(IBDATA,"^",7) SETDESC("FD:"_$$DATE($P(IBDATA,"^",7)))
"RTN","RCCPCPS1",136,0)
 .   ;
"RTN","RCCPCPS1",137,0)
 .   ;  if not patient statement detail, quit
"RTN","RCCPCPS1",138,0)
 .   I $$DET^RCFN01($P(RCDATA0,"^",9))'=2 Q
"RTN","RCCPCPS1",139,0)
 .   ;
"RTN","RCCPCPS1",140,0)
 .   ;  return pharmacy detail
"RTN","RCCPCPS1",141,0)
 .   I $P(IBDATA,"^",3)'="" D SETDESC(" DRUG:"_$TR($P(IBDATA,"^",3),"|~"))
"RTN","RCCPCPS1",142,0)
 .   I $P(IBDATA,"^",4) D SETDESC(" DAYS:"_$P(IBDATA,"^",4))
"RTN","RCCPCPS1",143,0)
 .   I $P(IBDATA,"^",6) D SETDESC(" QTY:"_$P(IBDATA,"^",6))
"RTN","RCCPCPS1",144,0)
 .   I $P(IBDATA,"^",5)'="" D SETDESC(" PHY:"_$P(IBDATA,"^",5))
"RTN","RCCPCPS1",145,0)
 .   I $P(IBDATA,"^",8) D SETDESC(" CHG:$"_$J($P(IBDATA,"^",8),0,2))
"RTN","RCCPCPS1",146,0)
 ;
"RTN","RCCPCPS1",147,0)
 K ^TMP("IBRFN1",$J)
"RTN","RCCPCPS1",148,0)
 Q
"RTN","RCCPCPS1",149,0)
 ;
"RTN","RCCPCPS1",150,0)
 ;
"RTN","RCCPCPS1",151,0)
 ; Add line to the description, not longer than RCWIDTH
"RTN","RCCPCPS1",152,0)
 ; Input: RCLINE,RCWIDTH
"RTN","RCCPCPS1",153,0)
 ; Output: RCDESC
"RTN","RCCPCPS1",154,0)
SETDESC(DESCRIPT) N LENGTH
"RTN","RCCPCPS1",155,0)
 ;  calculate the length of the description
"RTN","RCCPCPS1",156,0)
 S LENGTH=$L(RCDESC(RCLINE))+$L(DESCRIPT)
"RTN","RCCPCPS1",157,0)
 I RCDESC(RCLINE)'="" S LENGTH=LENGTH+1
"RTN","RCCPCPS1",158,0)
 ;
"RTN","RCCPCPS1",159,0)
 ;  the description line cannot go over RCWIDTH characters
"RTN","RCCPCPS1",160,0)
 I LENGTH<RCWIDTH S RCDESC(RCLINE)=RCDESC(RCLINE)_$S(RCDESC(RCLINE)="":"",1:" ")_DESCRIPT Q
"RTN","RCCPCPS1",161,0)
 ;
"RTN","RCCPCPS1",162,0)
 ; Description line to add is over RCWIDTH
"RTN","RCCPCPS1",163,0)
 ; The given string will be splitted _only_ if the limit is more than 44 characters.
"RTN","RCCPCPS1",164,0)
 I $L(DESCRIPT)>RCWIDTH D  Q
"RTN","RCCPCPS1",165,0)
 .   I RCDESC(RCLINE)'="" S RCLINE=RCLINE+1
"RTN","RCCPCPS1",166,0)
 .   S RCDESC(RCLINE)=$E(DESCRIPT,1,RCWIDTH)
"RTN","RCCPCPS1",167,0)
 .   S RCLINE=RCLINE+1
"RTN","RCCPCPS1",168,0)
 .   S RCDESC(RCLINE)=$E(DESCRIPT,RCWIDTH+1,2*RCWIDTH)
"RTN","RCCPCPS1",169,0)
 ;
"RTN","RCCPCPS1",170,0)
 ;  over RCWIDTH characters, start new line
"RTN","RCCPCPS1",171,0)
 I RCDESC(RCLINE)'="" S RCLINE=RCLINE+1
"RTN","RCCPCPS1",172,0)
 S RCDESC(RCLINE)=DESCRIPT
"RTN","RCCPCPS1",173,0)
 Q
"RTN","RCCPCPS1",174,0)
 ;
"RTN","RCCPCPS1",175,0)
DATE(FMDT) ;  format date mm/dd/yyyy
"RTN","RCCPCPS1",176,0)
 I 'FMDT Q ""
"RTN","RCCPCPS1",177,0)
 Q $E(FMDT,4,5)_"/"_$E(FMDT,6,7)_"/"_(1700+$E(FMDT,1,3))
"RTN","RCDMC90")
0^7^B54668888
"RTN","RCDMC90",1,0)
RCDMC90 ;WASH IRMFO@ALTOONA,PA/TJK-DMC 90 DAY ;7/17/97  8:13 AM
"RTN","RCDMC90",2,0)
V ;;4.5;Accounts Receivable;**45,108,133,121,163,190,192**;Mar 20, 1995
"RTN","RCDMC90",3,0)
 ;;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","RCDMC90",4,0)
ENTER ;Entry point from nightly process
"RTN","RCDMC90",5,0)
 Q:'$D(RCDOC)
"RTN","RCDMC90",6,0)
 N DEBTOR,BILL,DEBTOR0,B0,B6,B7,LTRDT3,P30DT,PRIN,INT,ADMIN,B4,B12
"RTN","RCDMC90",7,0)
 N TPRIN,TINT,TADMIN,ESTDT,CATYP,DFN,CNTR,SITE,LN,FN,MN,STNM,DOB,SITE
"RTN","RCDMC90",8,0)
 N PHONE,QUIT,TOTAL,ZIPCODE,FULLNM,XN,P91DT,OFFAMT,RCNT,TLINE,REPAY,X1,X2
"RTN","RCDMC90",9,0)
 N LKUP,ADDR,ADDRPHO,CHKPHONE,PSSN
"RTN","RCDMC90",10,0)
 K ^XTMP("RCDMC90",$J),^TMP($J,"RCDMC90") S ^XTMP("RCDMC90",0)=DT
"RTN","RCDMC90",11,0)
 S SITE=$$SITE^RCMSITE(),TLINE="0^0^0"
"RTN","RCDMC90",12,0)
 S X1=DT,X2=-91 D C^%DTC S P91DT=X
"RTN","RCDMC90",13,0)
 S X1=DT,X2=-30 D C^%DTC S P30DT=X
"RTN","RCDMC90",14,0)
 S (CNTR,DEBTOR)=0,RCNT=2 G UPDATE:$G(RCDOC)="W"
"RTN","RCDMC90",15,0)
 ;MASTER SHEET COMPILATION
"RTN","RCDMC90",16,0)
 F  S DEBTOR=$O(^PRCA(430,"C",DEBTOR)) Q:DEBTOR'?1N.N  D
"RTN","RCDMC90",17,0)
 .K ^TMP($J,"RCDMC90","BILL")
"RTN","RCDMC90",18,0)
 .S QUIT=1,OFFAMT=+$P($G(^RCD(340,DEBTOR,3)),U,9)
"RTN","RCDMC90",19,0)
 .D PROC(DEBTOR,.QUIT) Q:QUIT
"RTN","RCDMC90",20,0)
 .;COMPILES FIELDS UNIQUE TO MASTER CODE SHEETS
"RTN","RCDMC90",21,0)
 .S FULLNM=$$NM(DFN),FN=$P(FULLNM,U,3),MN=$P(FULLNM,U,4)
"RTN","RCDMC90",22,0)
 .S LN=$P(FULLNM,U,1),XN=$P(FULLNM,U,2)
"RTN","RCDMC90",23,0)
 .S FULLNM=FN_" "_$S(MN'="":$P(MN,".")_" ",1:"")_LN_$S(XN'="":" "_$P(XN,"."),1:"")
"RTN","RCDMC90",24,0)
 .S STNM=$$LJ^XLFSTR($E(FN)_$S(MN'="":$E(MN),1:" ")_$E(LN,1,5),7," ")
"RTN","RCDMC90",25,0)
 .S DOB=$$DATE8(+VADM(3))
"RTN","RCDMC90",26,0)
 .;SET HOLDING GLOBAL FOR MASTER SHEETS
"RTN","RCDMC90",27,0)
 .S CNTR=CNTR+1
"RTN","RCDMC90",28,0)
 .S ^XTMP("RCDMC90",$J,CNTR)=$E($$LJ^XLFSTR($P(VADM(2),U),9),1,9)_STNM_SITE_DOB_PHONE_$$LJ^XLFSTR(FULLNM,40)_$$LJ^XLFSTR($E($P(ADDR,U,1),1,2),2)
"RTN","RCDMC90",29,0)
 .S CNTR=CNTR+1
"RTN","RCDMC90",30,0)
 .S ^XTMP("RCDMC90",$J,CNTR)=$$LJ^XLFSTR($E($P(ADDR,U,1),3,40),38)_$$LJ^XLFSTR($E($P(ADDR,U,2),1,40),40)_$$LJ^XLFSTR($E($P(ADDR,U,3)),1)
"RTN","RCDMC90",31,0)
 .S CNTR=CNTR+1
"RTN","RCDMC90",32,0)
 .S ^XTMP("RCDMC90",$J,CNTR)=$$LJ^XLFSTR($E($P(ADDR,U,3),2,40),39)_$$LJ^XLFSTR($E($P(ADDR,U,4),1,40),40)
"RTN","RCDMC90",33,0)
 .S CNTR=CNTR+1
"RTN","RCDMC90",34,0)
 .S ^XTMP("RCDMC90",$J,CNTR)=$$LJ^XLFSTR($E($P(ADDR,U,5),1,40),40)_$$LJ^XLFSTR(ZIPCODE,9)_$$DATE8(ESTDT)_$$AMT(TPRIN)_$$AMT(TINT)_$E($$AMT(TADMIN),1,4)
"RTN","RCDMC90",35,0)
 .S CNTR=CNTR+1
"RTN","RCDMC90",36,0)
 .S ^XTMP("RCDMC90",$J,CNTR)=$E($$AMT(TADMIN),5,9)_$$DATE8(DT)_CATYP_$$AMT(OFFAMT)_$$AMT($$BAL(DEBTOR))_$E("0000000000",1,10-$L(DEBTOR))_DEBTOR_"$"
"RTN","RCDMC90",37,0)
 .S $P(^RCD(340,DEBTOR,3),U)=1,$P(^(3),U,2)=DT,$P(^(3),U,3)=ESTDT,$P(^(3),U,5)=TOTAL,$P(^(3),U,6)=TPRIN,$P(^(3),U,7)=TINT,$P(^(3),U,8)=TADMIN,^RCD(340,"DMC",1,DEBTOR)=""
"RTN","RCDMC90",38,0)
 .S X=0 F  S X=$O(^TMP($J,"RCDMC90","BILL",X)) Q:'X  S ^PRCA(430,X,12)=^(X)
"RTN","RCDMC90",39,0)
 .D SETREC
"RTN","RCDMC90",40,0)
 .Q
"RTN","RCDMC90",41,0)
 D COMPILE^RCDMC90U(375,CNTR,5,TLINE),KVAR
"RTN","RCDMC90",42,0)
 Q
"RTN","RCDMC90",43,0)
UPDATE ;WEEKLY UPDATE COMPILATION
"RTN","RCDMC90",44,0)
 F  S DEBTOR=$O(^RCD(340,"DMC",1,DEBTOR)) Q:DEBTOR'?1N.N  D
"RTN","RCDMC90",45,0)
 .I '$G(^RCD(340,DEBTOR,3)) K ^RCD(340,"DMC",1,DEBTOR) Q
"RTN","RCDMC90",46,0)
 .S QUIT=1,OFFAMT=+$P(^RCD(340,DEBTOR,3),U,9)
"RTN","RCDMC90",47,0)
 .D PROC(DEBTOR,.QUIT) Q:QUIT
"RTN","RCDMC90",48,0)
 .;SET HOLDING GLOBAL FOR WEEKLY UPDATES
"RTN","RCDMC90",49,0)
 .S CNTR=CNTR+1
"RTN","RCDMC90",50,0)
 .S ^XTMP("RCDMC90",$J,CNTR)=$E($$LJ^XLFSTR($P(VADM(2),U),9),1,9)_$$LJ^XLFSTR($E($P(ADDR,U,1),1,40),40)_$$LJ^XLFSTR($E($P(ADDR,U,2),1,30),30)
"RTN","RCDMC90",51,0)
 .S CNTR=CNTR+1
"RTN","RCDMC90",52,0)
 .S ^XTMP("RCDMC90",$J,CNTR)=$$LJ^XLFSTR($E($P(ADDR,U,2),31,40),10)_$$LJ^XLFSTR($E($P(ADDR,U,3),1,40),40)_$$LJ^XLFSTR($E($P(ADDR,U,4),1,29),29)
"RTN","RCDMC90",53,0)
 .S CNTR=CNTR+1
"RTN","RCDMC90",54,0)
 .S ^XTMP("RCDMC90",$J,CNTR)=$$LJ^XLFSTR($E($P(ADDR,U,4),30,40),11)_$$LJ^XLFSTR($E($P(ADDR,U,5),1,40),40)_$$LJ^XLFSTR(ZIPCODE,9)_SITE_PHONE_$E($$AMT(TPRIN),1,6)
"RTN","RCDMC90",55,0)
 .S CNTR=CNTR+1
"RTN","RCDMC90",56,0)
 .S ^XTMP("RCDMC90",$J,CNTR)=$E($$AMT(TPRIN),7,9)_$$AMT(TINT)_$$AMT(TADMIN)_$$DATE8(DT)_CATYP_$$AMT(OFFAMT)_$$AMT($$BAL(DEBTOR))_"$"
"RTN","RCDMC90",57,0)
 .S:TOTAL $P(^RCD(340,DEBTOR,3),U,5)=TOTAL,$P(^(3),U,6)=TPRIN,$P(^(3),U,7)=TINT,$P(^(3),U,8)=TADMIN
"RTN","RCDMC90",58,0)
 .D SETREC
"RTN","RCDMC90",59,0)
 .Q
"RTN","RCDMC90",60,0)
 D COMPILE^RCDMC90U(300,CNTR,4,TLINE),KVAR
"RTN","RCDMC90",61,0)
 Q
"RTN","RCDMC90",62,0)
KVAR D KVAR^VADPT
"RTN","RCDMC90",63,0)
 K RCDOC,^XTMP("RCDMC90",$J),VA("BID"),XMDUZ
"RTN","RCDMC90",64,0)
 Q
"RTN","RCDMC90",65,0)
PROC(DEBTOR,QUIT) ;PROCESS BILLS FOR A SPECIFIC DEBTOR
"RTN","RCDMC90",66,0)
 ;SETS DATA COMMON TO BOTH WEEKLY & MASTER CODESHEETS
"RTN","RCDMC90",67,0)
 S DEBTOR0=$G(^RCD(340,DEBTOR,0))
"RTN","RCDMC90",68,0)
 Q:$P(DEBTOR0,U)'["DPT"
"RTN","RCDMC90",69,0)
 S DFN=+DEBTOR0 D DEM^VADPT Q:$E(VADM(2),1,5)="00000"
"RTN","RCDMC90",70,0)
 F X=1:1:6 S CATYP(X)=""
"RTN","RCDMC90",71,0)
 S (BILL,TOTAL,TPRIN,TINT,TADMIN,REPAY)=0,ESTDT=P91DT
"RTN","RCDMC90",72,0)
 I RCDOC="W",$P(^RCD(340,DEBTOR,3),U,10) G TOTAL
"RTN","RCDMC90",73,0)
 F  S BILL=$O(^PRCA(430,"C",DEBTOR,BILL)) Q:BILL'?1N.N  D  K:PRIN=0 ^PRCA(430,BILL,12) Q:REPAY
"RTN","RCDMC90",74,0)
 .S (PRIN,INT,ADMIN)=0
"RTN","RCDMC90",75,0)
 .I +VADM(6) Q
"RTN","RCDMC90",76,0)
 .S B0=$G(^PRCA(430,BILL,0)),B4=$G(^(4)),B6=$G(^(6)),B7=$G(^(7)),B12=$G(^(12))
"RTN","RCDMC90",77,0)
 .Q:$P(B0,U,8)'=16
"RTN","RCDMC90",78,0)
 .I B4 D  Q
"RTN","RCDMC90",79,0)
 ..S (TOTAL,TPRIN,TINT,TADMIN)=0
"RTN","RCDMC90",80,0)
 ..S X=0 F  S X=$O(^PRCA(430,"C",DEBTOR,X)) Q:X'?1N.N  K ^PRCA(430,X,12)
"RTN","RCDMC90",81,0)
 ..S REPAY=1
"RTN","RCDMC90",82,0)
 ..Q
"RTN","RCDMC90",83,0)
 .I RCDOC="W",'$P(B12,U) Q
"RTN","RCDMC90",84,0)
 .S PRIN=$P(B7,U),INT=$P(B7,U,2),ADMIN=$P(B7,U,3)+$P(B7,U,4)+$P(B7,U,5)
"RTN","RCDMC90",85,0)
 .I PRIN'>0,INT+ADMIN>0 D  Q
"RTN","RCDMC90",86,0)
 ..N XMSUB,XMY,XMTEXT,MSG
"RTN","RCDMC90",87,0)
 ..S XMSUB="Notice Of Active Bill Without Principal Balance"
"RTN","RCDMC90",88,0)
 ..S XMY("G.DMR")=""
"RTN","RCDMC90",89,0)
 ..S XMDUZ="AR PACKAGE"
"RTN","RCDMC90",90,0)
 ..S XMTEXT="MSG("
"RTN","RCDMC90",91,0)
 ..S MSG(1)="The following bill has a 0 principal balance,"
"RTN","RCDMC90",92,0)
 ..S MSG(2)="but has interest/admin charges remaining."
"RTN","RCDMC90",93,0)
 ..S MSG(3)="These charges should be exempted"
"RTN","RCDMC90",94,0)
 ..S MSG(4)=" "
"RTN","RCDMC90",95,0)
 ..S MSG(5)="BILL #:  "_$P(B0,U)
"RTN","RCDMC90",96,0)
 ..D ^XMD
"RTN","RCDMC90",97,0)
 ..Q
"RTN","RCDMC90",98,0)
 .Q:$P(B4,U)
"RTN","RCDMC90",99,0)
 .S LTRDT3=$P(B6,U,3) Q:'LTRDT3  Q:LTRDT3>P30DT
"RTN","RCDMC90",100,0)
 .;CHECK FOR DC REFERRAL HERE
"RTN","RCDMC90",101,0)
 .I $P(B6,U,4),($P(B6,U,5)="DC")!($P(B6,U,5)="RC") Q
"RTN","RCDMC90",102,0)
 .;Q:$$INSURED^IBCNS1(DFN,$P(B0,U,10))  ;Commented out w/patch *121
"RTN","RCDMC90",103,0)
 .S X=$P(B0,U,2),X=$S(X=22:1,X=23:1,(X>2)&(X<6):2,X=18:2,X=24:2,X=25:2,X=1:3,X=2:4,(X>26)&(X<30):5,X>29:6,1:"")
"RTN","RCDMC90",104,0)
 .Q:X=""  K CATYP(X)
"RTN","RCDMC90",105,0)
 .I $P(B6,U,21),$P(B6,U,21)<ESTDT S ESTDT=$P($P(B6,U,21),".")
"RTN","RCDMC90",106,0)
 .I $P(B12,U,2),PRIN>$P(B12,U,2) S PRIN=$P(B12,U,2)
"RTN","RCDMC90",107,0)
 .S ^TMP($J,"RCDMC90","BILL",BILL)=$S($P(B12,U):$P(B12,U),1:DT)_U_PRIN_U_INT_U_ADMIN
"RTN","RCDMC90",108,0)
 .S TPRIN=TPRIN+PRIN,TINT=TINT+INT,TADMIN=TADMIN+ADMIN
"RTN","RCDMC90",109,0)
 .Q
"RTN","RCDMC90",110,0)
TOTAL S TOTAL=TPRIN+TINT+TADMIN
"RTN","RCDMC90",111,0)
 I RCDOC="M" Q:TOTAL<25  Q:TPRIN'>0
"RTN","RCDMC90",112,0)
 I RCDOC="M",$P(VADM(2),U)["P" S PSSN=$P(VADM(2),U) D PSEUDO^RCDMC90U(DFN,PSSN) Q
"RTN","RCDMC90",113,0)
 I RCDOC="W" Q:(TOTAL_U_TPRIN_U_TINT_U_TADMIN)=$P(^RCD(340,DEBTOR,3),U,5,8)
"RTN","RCDMC90",114,0)
 S DFN=+DEBTOR0
"RTN","RCDMC90",115,0)
 ;SETS CATEGORY CODE 1=MEANS TEST,2=PHARMACY,3=INEL.,4=EMER./HUM.
"RTN","RCDMC90",116,0)
 ;5=CHAMPVA,6=TRICARE OR ANY COMBINATION THEREOF
"RTN","RCDMC90",117,0)
 S CATYP="" F X=1:1:6 S:'$D(CATYP(X)) CATYP=CATYP_X
"RTN","RCDMC90",118,0)
 S CATYP=$$LJ^XLFSTR(CATYP,6)
"RTN","RCDMC90",119,0)
 ;
"RTN","RCDMC90",120,0)
 ;Send Master/Weekly error msg if Unknown or Invalid address
"RTN","RCDMC90",121,0)
 ;If Master update, quit and don't refer to DMC
"RTN","RCDMC90",122,0)
 ;If Weekly update, send a zero balance
"RTN","RCDMC90",123,0)
 S LKUP=$$CHKADD(DEBTOR)
"RTN","RCDMC90",124,0)
 I LKUP D ERROR^RCDMC90U(RCDOC,LKUP,DFN)  Q:RCDOC="M"  S (TOTAL,TPRIN,TINT,TADMIN)=0
"RTN","RCDMC90",125,0)
 ;
"RTN","RCDMC90",126,0)
 S ZIPCODE=$TR($P(ADDR,U,6),"-")
"RTN","RCDMC90",127,0)
 ;
"RTN","RCDMC90",128,0)
 ;Retrieve and format patient phone number
"RTN","RCDMC90",129,0)
 S ADDRPHO=$P(ADDR,U,7),PHONE=""
"RTN","RCDMC90",130,0)
 F I=1:1:$L(ADDRPHO) S CHKPHONE=$E(ADDRPHO,I) I CHKPHONE?1N S PHONE=PHONE_CHKPHONE
"RTN","RCDMC90",131,0)
 S PHONE=$S(PHONE?10N:PHONE,PHONE?7N:"   "_PHONE,1:"          ")
"RTN","RCDMC90",132,0)
 ;
"RTN","RCDMC90",133,0)
 I RCDOC="W",TOTAL=0 D
"RTN","RCDMC90",134,0)
 .K ^RCD(340,"DMC",1,DEBTOR),^RCD(340,DEBTOR,3)
"RTN","RCDMC90",135,0)
 .N NM,XMSUB,XMY,XMTEXT,MSG
"RTN","RCDMC90",136,0)
 .S XMSUB="Deletion of Debtor from DMC"
"RTN","RCDMC90",137,0)
 .S XMY("G.DMX")=""
"RTN","RCDMC90",138,0)
 .S XMDUZ="AR PACKAGE"
"RTN","RCDMC90",139,0)
 .S XMTEXT="MSG("
"RTN","RCDMC90",140,0)
 .S MSG(1)="The following patient has a DMC balance of '0'"
"RTN","RCDMC90",141,0)
 .S MSG(2)="and will be deleted from the DMC system:"
"RTN","RCDMC90",142,0)
 .S MSG(3)=" "
"RTN","RCDMC90",143,0)
 .S MSG(4)=$P(^DPT(DFN,0),U)_"   SSN:  "_$P(^(0),U,9)
"RTN","RCDMC90",144,0)
 .D ^XMD
"RTN","RCDMC90",145,0)
 .Q
"RTN","RCDMC90",146,0)
 S QUIT=0
"RTN","RCDMC90",147,0)
PROCQ Q
"RTN","RCDMC90",148,0)
DATE8(X) ;CHANGES FILEMAN DATE INTO 8 DIGIT DATE IN FORMAT MMDDYYYY
"RTN","RCDMC90",149,0)
 S X=$E(X,4,7)_($E(X,1,3)+1700)
"RTN","RCDMC90",150,0)
 Q X
"RTN","RCDMC90",151,0)
AMT(X) ;CHANGES AMOUNT TO ZERO FILLED, RIGHT JUSTIFIED
"RTN","RCDMC90",152,0)
 S X=$TR($J(X,0,2),".")
"RTN","RCDMC90",153,0)
 S X=$E("000000000",1,9-$L(X))_X
"RTN","RCDMC90",154,0)
 Q X
"RTN","RCDMC90",155,0)
NM(DFN) ;Returns first, middle, and last name in 3 different variables
"RTN","RCDMC90",156,0)
 N FN,LN,MN,NM,XN
"RTN","RCDMC90",157,0)
 S NM=$P($G(^DPT(DFN,0)),"^")
"RTN","RCDMC90",158,0)
 S LN=$TR($P(NM,",")," .'-"),MN=$P($P(NM,",",2)," ",2)
"RTN","RCDMC90",159,0)
 I ($E(MN,1,2)="SR")!($E(MN,1,2)="JR")!(MN?2.3"I")!(MN?0.1"I"1"V"1.3"I") S XN=MN,MN=""
"RTN","RCDMC90",160,0)
 I $G(XN)="" S XN=$P($P($G(NM),",",2)," ",3)
"RTN","RCDMC90",161,0)
 S FN=$P($P(NM,",",2)," ")
"RTN","RCDMC90",162,0)
QNM Q LN_"^"_XN_"^"_FN_"^"_MN
"RTN","RCDMC90",163,0)
BAL(DEBTOR) ;COMPUTES TOTAL OF ACTIVE BILLS THAT COULD BE SENT TO DMC
"RTN","RCDMC90",164,0)
 N BILL,BAL
"RTN","RCDMC90",165,0)
 S (BILL,BAL)=0
"RTN","RCDMC90",166,0)
 F  S BILL=$O(^PRCA(430,"C",DEBTOR,BILL)) Q:BILL'?1N.N  D
"RTN","RCDMC90",167,0)
 .S B0=$G(^PRCA(430,BILL,0)),B7=$G(^(7))
"RTN","RCDMC90",168,0)
 .Q:$P(B0,U,8)'=16
"RTN","RCDMC90",169,0)
 .S X=$P(B0,U,2),X=$S((X>0)&(X<6):1,X=18:1,(X>21)&(X<26):1,(X>26)&(X<33):1,1:"")
"RTN","RCDMC90",170,0)
 .Q:X=""
"RTN","RCDMC90",171,0)
 .S BAL=BAL+$P(B7,U)+$P(B7,U,2)+$P(B7,U,3)+$P(B7,U,4)+$P(B7,U,5)
"RTN","RCDMC90",172,0)
 .Q
"RTN","RCDMC90",173,0)
BALQ Q BAL
"RTN","RCDMC90",174,0)
SETREC ;SETS TEMPORARY GLOBAL FOR MAIL MESSAGE TO USERS
"RTN","RCDMC90",175,0)
 S RCNT=RCNT+1 D PID^VADPT S:$L(VA("BID"))=4 VA("BID")=" "_VA("BID")
"RTN","RCDMC90",176,0)
 S TLINE=($P(TLINE,U)+TPRIN)_U_($P(TLINE,U,2)+TINT)_U_($P(TLINE,U,3)+TADMIN)
"RTN","RCDMC90",177,0)
 S ^XTMP("RCDMC90",$J,"REC",$P(^DPT(DFN,0),U)_";"_DFN)=$$LJ^XLFSTR($E($P(^DPT(DFN,0),U),1,28),29)_" "_VA("BID")_" "_$J(TPRIN,10,2)_$J(TINT,10,2)_$J(TADMIN,10,2)_$J(TOTAL,10,2)
"RTN","RCDMC90",178,0)
 Q
"RTN","RCDMC90",179,0)
 ;
"RTN","RCDMC90",180,0)
CHKADD(DEBTOR) ; Checks for invalid and unknown addresses
"RTN","RCDMC90",181,0)
 N CHK S CHK=0,ADDR=""
"RTN","RCDMC90",182,0)
 I $P($G(^RCD(340,+DEBTOR,1)),"^",9)=1 S CHK=1 G CHKADDQ
"RTN","RCDMC90",183,0)
 S ADDR=$$DADD^RCAMADD(+DEBTOR,1) ;get address (confidential if possible) 
"RTN","RCDMC90",184,0)
 I ADDR'?.ANP!(ADDR["$")!(ADDR["**")!(ADDR["///")!(ADDR["ZZZ") S CHK=2
"RTN","RCDMC90",185,0)
CHKADDQ Q CHK
"RTN","RCDMC90",186,0)
 ;
"RTN","RCXFMSUF")
0^8^B17432145
"RTN","RCXFMSUF",1,0)
RCXFMSUF ;WISC/RFJ-calculate fms fund code for a bill ;1 Oct 97
"RTN","RCXFMSUF",2,0)
 ;;4.5;Accounts Receivable;**90,101,135,157,160,165,170,203,207,173,211,192**;Mar 20, 1995
"RTN","RCXFMSUF",3,0)
 ;;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","RCXFMSUF",4,0)
 Q
"RTN","RCXFMSUF",5,0)
 ;
"RTN","RCXFMSUF",6,0)
 ;
"RTN","RCXFMSUF",7,0)
GETFUNDO(TYPE) ;  return the fund for other type associated collections
"RTN","RCXFMSUF",8,0)
 ;  type can equal:
"RTN","RCXFMSUF",9,0)
 ;  I for interest         A for admin
"RTN","RCXFMSUF",10,0)
 ;  M for marshall fee     C for court cost
"RTN","RCXFMSUF",11,0)
 I TYPE="I" Q "1435"
"RTN","RCXFMSUF",12,0)
 I TYPE="A" Q "3220"
"RTN","RCXFMSUF",13,0)
 I TYPE="M" Q "0869"
"RTN","RCXFMSUF",14,0)
 I TYPE="C" Q "0869"
"RTN","RCXFMSUF",15,0)
 Q ""
"RTN","RCXFMSUF",16,0)
 ;
"RTN","RCXFMSUF",17,0)
 ;
"RTN","RCXFMSUF",18,0)
GETFUNDB(BILLDA,DONTSTOR,RCEFT) ;  return a bills fms fund code
"RTN","RCXFMSUF",19,0)
 ;  pass DONTSTOR equal 1 to prevent storing the fund code
"RTN","RCXFMSUF",20,0)
 ;  cannot rely on data in the fund field since it may reference the
"RTN","RCXFMSUF",21,0)
 ;  old funds S FUND=$P($G(^PRCA(430,BILLDA,11)),"^",17).  since there
"RTN","RCXFMSUF",22,0)
 ;  are reports which use 11;17, set it for a bill once its computed
"RTN","RCXFMSUF",23,0)
 ;  until all references to the fund are eliminated.
"RTN","RCXFMSUF",24,0)
 ;  rceft = 1 if processing an EFT deposit
"RTN","RCXFMSUF",25,0)
 ;
"RTN","RCXFMSUF",26,0)
 N ACTDATE,CATEGDA,FUND
"RTN","RCXFMSUF",27,0)
 ;
"RTN","RCXFMSUF",28,0)
 ;  calculate a bills fund
"RTN","RCXFMSUF",29,0)
 I $G(RCEFT)=1 S FUND="5287"_$S(DT<3030926:"",1:".4") Q FUND
"RTN","RCXFMSUF",30,0)
 S CATEGDA=+$P($G(^PRCA(430,BILLDA,0)),"^",2)
"RTN","RCXFMSUF",31,0)
 I CATEGDA>39 Q ""
"RTN","RCXFMSUF",32,0)
 ;
"RTN","RCXFMSUF",33,0)
 ;  piece 5 is new fund, remove spaces
"RTN","RCXFMSUF",34,0)
 S FUND=$P($TR($T(@CATEGDA)," "),";",5)
"RTN","RCXFMSUF",35,0)
 ;
"RTN","RCXFMSUF",36,0)
 ;  if category is vendor(17), ex-employee(15), current employee(16)
"RTN","RCXFMSUF",37,0)
 ;  federal agency refund(13), federal agency reimb(14), military(12)
"RTN","RCXFMSUF",38,0)
 ;  set the fund to what is stored in the file.  This was entered
"RTN","RCXFMSUF",39,0)
 ;  by the user during the audit process.  If fund is in the file
"RTN","RCXFMSUF",40,0)
 ;  already, do not need to store it again.
"RTN","RCXFMSUF",41,0)
 I CATEGDA=17!(CATEGDA=15)!(CATEGDA=16)!(CATEGDA=13)!(CATEGDA=14)!(CATEGDA=12) D
"RTN","RCXFMSUF",42,0)
 .   I $P($G(^PRCA(430,BILLDA,11)),"^",17)'="" S FUND=$P(^(11),"^",17),DONTSTOR=1
"RTN","RCXFMSUF",43,0)
 ;
"RTN","RCXFMSUF",44,0)
 ;  public law states that bills in the category ineligible (1),
"RTN","RCXFMSUF",45,0)
 ;  emerg/human (2), torts (10), or medicare (21) which are older 
"RTN","RCXFMSUF",46,0)
 ;  than oct 1, 1992 should be reported under fund 3220.
"RTN","RCXFMSUF",47,0)
 I CATEGDA=1!(CATEGDA=2)!(CATEGDA=10)!(CATEGDA=21) D
"RTN","RCXFMSUF",48,0)
 .   S ACTDATE=$P($G(^PRCA(430,BILLDA,6)),"^",21)
"RTN","RCXFMSUF",49,0)
 .   I ACTDATE,ACTDATE<2921001 S FUND=3220 Q
"RTN","RCXFMSUF",50,0)
 .   ;
"RTN","RCXFMSUF",51,0)
 .   ;  patch157 changes ineligibles.  an ineligible activated before
"RTN","RCXFMSUF",52,0)
 .   ;  oct 1, 1992 or after sep 30, 2000 will be recorded in fund 0160A1.
"RTN","RCXFMSUF",53,0)
 .   ;  otherwise it will be recorded in fund 5287.3
"RTN","RCXFMSUF",54,0)
 .   I CATEGDA=1,ACTDATE,ACTDATE<3001001 S FUND=5287.3
"RTN","RCXFMSUF",55,0)
 ;
"RTN","RCXFMSUF",56,0)
 ;  set the fund for the bill
"RTN","RCXFMSUF",57,0)
 I $G(DONTSTOR)'=1 D STORE^RCXFMSUR(BILLDA,"",FUND)
"RTN","RCXFMSUF",58,0)
 ;
"RTN","RCXFMSUF",59,0)
 I $G(REPRODT),REPRODT<3030926,$P(FUND,".")=5287 Q 5287
"RTN","RCXFMSUF",60,0)
 I $G(REPRODT),REPRODT<3031001,$P(FUND,".")=5287,$G(REFMS) Q 5287
"RTN","RCXFMSUF",61,0)
 I DT<3030926,$P(FUND,".")=5287 Q 5287 ; Effective date
"RTN","RCXFMSUF",62,0)
 I DT<3031001,$P(FUND,".")=5287,$G(REFMS) Q 5287 ; Resubmitted documents not held
"RTN","RCXFMSUF",63,0)
 Q FUND
"RTN","RCXFMSUF",64,0)
 ;
"RTN","RCXFMSUF",65,0)
 ;
"RTN","RCXFMSUF",66,0)
 ;  this is a listing of all categories and associated funds
"RTN","RCXFMSUF",67,0)
 ;  the label is from the internal entry number in the category
"RTN","RCXFMSUF",68,0)
 ;  file 430.2.  piece 3 is a description, piece 4 is the old fund,
"RTN","RCXFMSUF",69,0)
 ;  piece 5 is the new fund
"RTN","RCXFMSUF",70,0)
0 ;;no fund                       ;       ;    
"RTN","RCXFMSUF",71,0)
1 ;;INELIGIBLE HOSP.              ;3220   ;0160A1
"RTN","RCXFMSUF",72,0)
2 ;;EMERGENCY/HUMANITARIAN        ;0160A1 ;5287.3
"RTN","RCXFMSUF",73,0)
3 ;;NURSING HOME CARE(NSC)        ;2431   ;5287.3
"RTN","RCXFMSUF",74,0)
4 ;;OUTPATIENT CARE(NSC)          ;2431   ;5287.3
"RTN","RCXFMSUF",75,0)
5 ;;HOSPITAL CARE (NSC)           ;2431   ;5287.3
"RTN","RCXFMSUF",76,0)
6 ;;WORKMAN'S COMP.               ;5014   ;5287.4
"RTN","RCXFMSUF",77,0)
7 ;;NO-FAULT AUTO ACC.            ;5014   ;5287.4
"RTN","RCXFMSUF",78,0)
8 ;;CRIME OF PER.VIO.             ;5014   ;5287.4
"RTN","RCXFMSUF",79,0)
9 ;;REIMBURS.HEALTH INS.          ;5014   ;5287.4
"RTN","RCXFMSUF",80,0)
10 ;;TORT FEASOR                   ;0160A1 ;5287.4
"RTN","RCXFMSUF",81,0)
11 ;;no entry                      ;       ;
"RTN","RCXFMSUF",82,0)
12 ;;MILITARY                      ;0160A1 ;0160A1
"RTN","RCXFMSUF",83,0)
13 ;;FEDERAL AGENCIES-REFUND       ;0160A1 ;0160A1
"RTN","RCXFMSUF",84,0)
14 ;;FEDERAL AGENCIES-REIMB.       ;0160A1 ;0160A1
"RTN","RCXFMSUF",85,0)
15 ;;EX-EMPLOYEE                   ;0160A1 ;0160A1
"RTN","RCXFMSUF",86,0)
16 ;;CURRENT EMP.                  ;0160A1 ;0160A1
"RTN","RCXFMSUF",87,0)
17 ;;VENDOR                        ;0160A1 ;0160A1
"RTN","RCXFMSUF",88,0)
18 ;;C (MEANS TEST)                ;2431   ;5287.3
"RTN","RCXFMSUF",89,0)
19 ;;SHARING AGREEMENTS            ;0160A1 ;0160A1
"RTN","RCXFMSUF",90,0)
20 ;;INTERAGENCY                   ;0160A1 ;0160A1
"RTN","RCXFMSUF",91,0)
21 ;;MEDICARE                      ;5014   ;5287.4
"RTN","RCXFMSUF",92,0)
22 ;;RX CO-PAYMENT/SC VET          ;5014   ;5287.1
"RTN","RCXFMSUF",93,0)
23 ;;RX CO-PAYMENT/NSC VET         ;5014   ;5287.1
"RTN","RCXFMSUF",94,0)
24 ;;NURSING HOME CARE PER DIEM    ;2431   ;5287.3
"RTN","RCXFMSUF",95,0)
25 ;;HOSPITAL CARE PER DIEM        ;2431   ;5287.3
"RTN","RCXFMSUF",96,0)
26 ;;PREPAYMENT                    ;5014   ;5287.3
"RTN","RCXFMSUF",97,0)
27 ;;CHAMPVA SUBSISTENCE           ;3220   ;3220
"RTN","RCXFMSUF",98,0)
28 ;;CHAMPVA THIRD PARTY           ;3220   ;3220
"RTN","RCXFMSUF",99,0)
29 ;;CHAMPVA                       ;0160A1 ;0160A1
"RTN","RCXFMSUF",100,0)
30 ;;TRICARE                       ;0160A1 ;0160A1
"RTN","RCXFMSUF",101,0)
31 ;;TRICARE PATIENT               ;0160A1 ;0160A1
"RTN","RCXFMSUF",102,0)
32 ;;TRICARE THIRD PARTY           ;0160A1 ;0160A1
"RTN","RCXFMSUF",103,0)
33 ;;ADULT DAY HEALTH CARE         ;       ;4032
"RTN","RCXFMSUF",104,0)
34 ;;DOMICILIARY                   ;       ;4032
"RTN","RCXFMSUF",105,0)
35 ;;RESPITE CARE-INSTITUTIONAL    ;       ;4032
"RTN","RCXFMSUF",106,0)
36 ;;RESPITE CARE-NON-INSTITUTIONAL;       ;4032
"RTN","RCXFMSUF",107,0)
37 ;;GERIATRIC EVAL-INSTITUTIONAL  ;       ;4032
"RTN","RCXFMSUF",108,0)
38 ;;GERIATRIC EVAL-NON-INSTITUTION;       ;4032
"RTN","RCXFMSUF",109,0)
39 ;;NURSING HOME CARE-LTC         ;       ;4032
"RTN","RCXFMSUV")
0^9^B12738785
"RTN","RCXFMSUV",1,0)
RCXFMSUV ;WISC/RFJ-fms vendor id ;9/17/98  11:42 AM
"RTN","RCXFMSUV",2,0)
 ;;4.5;Accounts Receivable;**90,119,98,165,192**;Mar 20, 1995
"RTN","RCXFMSUV",3,0)
 ;;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","RCXFMSUV",4,0)
 Q
"RTN","RCXFMSUV",5,0)
 ;
"RTN","RCXFMSUV",6,0)
 ;
"RTN","RCXFMSUV",7,0)
VENDORID(BILLDA) ;  return the vendorid for a bill (used on a BD document)
"RTN","RCXFMSUV",8,0)
 ;  returns null if vendor id is not required
"RTN","RCXFMSUV",9,0)
 ;  returns UNKNOWN if vendor id is required but could not be determined
"RTN","RCXFMSUV",10,0)
 N ACCRUAL,CATEGORY,DEBTOR,RSC,VENDORID,VENDOR,DIR
"RTN","RCXFMSUV",11,0)
 ;
"RTN","RCXFMSUV",12,0)
 ;  accrued bills get sent to mccf 5287 fund, no vendor id
"RTN","RCXFMSUV",13,0)
 S ACCRUAL=$$ACCK^PRCAACC(BILLDA)
"RTN","RCXFMSUV",14,0)
 I ACCRUAL Q ""
"RTN","RCXFMSUV",15,0)
 ;
"RTN","RCXFMSUV",16,0)
 ;  if not a category, cannot determine vendor id
"RTN","RCXFMSUV",17,0)
 S CATEGORY=$P($G(^PRCA(430,BILLDA,0)),"^",2)
"RTN","RCXFMSUV",18,0)
 I 'CATEGORY Q ""
"RTN","RCXFMSUV",19,0)
 ;
"RTN","RCXFMSUV",20,0)
 ;  if vendor(17) or military(12) or federal agencies refund(13)
"RTN","RCXFMSUV",21,0)
 ;  or federal agencies-reimb(14) or interagency(20)
"RTN","RCXFMSUV",22,0)
 ;  or sharing agreements(19)
"RTN","RCXFMSUV",23,0)
 ;  then get vendor id
"RTN","RCXFMSUV",24,0)
 I CATEGORY=17!(CATEGORY=12)!(CATEGORY=13)!(CATEGORY=14)!(CATEGORY=20)!(CATEGORY=19) D  Q VENDORID
"RTN","RCXFMSUV",25,0)
    .S DEBTOR=+$P($G(^PRCA(430,BILLDA,0)),"^",9),VENDOR=$P($G(^RCD(340,DEBTOR,0)),U)
"RTN","RCXFMSUV",26,0)
    .I VENDOR="" S VENDORID="UNKNOWN" Q
"RTN","RCXFMSUV",27,0)
    .I CATEGORY=17,VENDOR["VA(" S VENDORID="PERSONOTH" D STORE(BILLDA,"PERSONOTH") Q
"RTN","RCXFMSUV",28,0)
    .I VENDOR["PRC(" D  Q
"RTN","RCXFMSUV",29,0)
       ..S VENDORID=$$VEN^PRCHUTL(+VENDOR)
"RTN","RCXFMSUV",30,0)
       ..I VENDORID'="" D STORE(BILLDA,VENDORID) Q
"RTN","RCXFMSUV",31,0)
       ..I CATEGORY=17 D  Q
"RTN","RCXFMSUV",32,0)
         ...S DIR(0)="Y",DIR("A")="Can this bill be offset by FMS "
"RTN","RCXFMSUV",33,0)
         ...S DIR("B")="YES" D ^DIR
"RTN","RCXFMSUV",34,0)
         ...S VENDORID=$S(Y=0:"PERSONOTH",1:"UNKNOWN")
"RTN","RCXFMSUV",35,0)
         ...D:VENDORID="PERSONOTH" STORE(BILLDA,"PERSONOTH")
"RTN","RCXFMSUV",36,0)
         ...Q
"RTN","RCXFMSUV",37,0)
       ..S VENDORID="UNKNOWN"
"RTN","RCXFMSUV",38,0)
       ..Q
"RTN","RCXFMSUV",39,0)
    .S VENDOR=$P(^RCD(340,+DEBTOR,0),U,6)
"RTN","RCXFMSUV",40,0)
    .I VENDOR'="" S VENDORID=$$VEN^PRCHUTL(VENDOR) D  Q
"RTN","RCXFMSUV",41,0)
       ..I VENDORID="" S VENDORID="UNKNOWN" Q
"RTN","RCXFMSUV",42,0)
       ..D STORE(BILLDA,VENDORID)
"RTN","RCXFMSUV",43,0)
       ..Q
"RTN","RCXFMSUV",44,0)
    .I '$D(^XUSEC("PRCA VENDOR",DUZ)) S VENDORID="LINK" Q
"RTN","RCXFMSUV",45,0)
    .W !!,"DEBTOR MUST BE LINKED TO VENDOR FILE"
"RTN","RCXFMSUV",46,0)
    .S VENDOR=$$VENSEL^PRCHUTL()
"RTN","RCXFMSUV",47,0)
    .I VENDOR<0 S VENDORID="LINK" Q
"RTN","RCXFMSUV",48,0)
    .S VENDORID=$$VEN^PRCHUTL(VENDOR)
"RTN","RCXFMSUV",49,0)
    .I VENDORID="" S VENDORID="UNKNOWN" Q
"RTN","RCXFMSUV",50,0)
    .D STORE(BILLDA,VENDORID),STOREL(+DEBTOR,VENDOR)
"RTN","RCXFMSUV",51,0)
    .Q
"RTN","RCXFMSUV",52,0)
 ;
"RTN","RCXFMSUV",53,0)
 ;  for ineligible send INELIG
"RTN","RCXFMSUV",54,0)
 I CATEGORY=1 D STORE(BILLDA,"INELIG") Q "INELIG"
"RTN","RCXFMSUV",55,0)
 ;  for ex-employee send XEMPL
"RTN","RCXFMSUV",56,0)
 I CATEGORY=15 D STORE(BILLDA,"XEMPL") Q "XEMPL"
"RTN","RCXFMSUV",57,0)
 ;  for current employee send CUREMPL
"RTN","RCXFMSUV",58,0)
 I CATEGORY=16 D STORE(BILLDA,"CUREMPL") Q "CUREMPL"
"RTN","RCXFMSUV",59,0)
 ;
"RTN","RCXFMSUV",60,0)
 ;  champva subsitence(27), champva third party(28)
"RTN","RCXFMSUV",61,0)
 I CATEGORY=27 D STORE(BILLDA,"CHMPVA1ST") Q "CHMPVA1ST"
"RTN","RCXFMSUV",62,0)
 I CATEGORY=28 D STORE(BILLDA,"CHMPVA3RD") Q "CHMPVA3RD"
"RTN","RCXFMSUV",63,0)
 ;  champva(29) does not get sent to FMS, code commented out
"RTN","RCXFMSUV",64,0)
 ;I CATEGORY=29 Q ""
"RTN","RCXFMSUV",65,0)
 ;
"RTN","RCXFMSUV",66,0)
 ;  tricare(30), tricare patient(31), tricare third party(32)
"RTN","RCXFMSUV",67,0)
 ;  test for tricare by looking at the revenue source code
"RTN","RCXFMSUV",68,0)
 S RSC=$P($G(^PRCA(430,BILLDA,11)),"^",6)
"RTN","RCXFMSUV",69,0)
 I RSC>8027,RSC<8031 D  D STORE(BILLDA,VENDORID) Q VENDORID
"RTN","RCXFMSUV",70,0)
    .S VENDORID=$S(RSC=8028:"TRIINPAT",RSC=8029:"TRIOUTPAT",1:"TRIOTH")
"RTN","RCXFMSUV",71,0)
    .Q
"RTN","RCXFMSUV",72,0)
 I CATEGORY>29,CATEGORY<33 D  D STORE(BILLDA,VENDORID) Q VENDORID
"RTN","RCXFMSUV",73,0)
    .S VENDORID=$S(CATEGORY=30:"TRICAROTH",CATEGORY=31:"TRICAROPT",1:"TRICARINP")
"RTN","RCXFMSUV",74,0)
    .Q
"RTN","RCXFMSUV",75,0)
 ;  vendor id not known, process should never reach this line of code
"RTN","RCXFMSUV",76,0)
 Q "UNKNOWN"
"RTN","RCXFMSUV",77,0)
 ;
"RTN","RCXFMSUV",78,0)
 ;
"RTN","RCXFMSUV",79,0)
LINKASK ;ENTRY POINT FOR MENU OPTION TO STORE LINK
"RTN","RCXFMSUV",80,0)
 N DIC,Y
"RTN","RCXFMSUV",81,0)
 S DIC=340,DIC(0)="AEQM",DIC("A")="Enter Debtor to be linked to Vendor File: ",DIC("S")="I $P(^RCD(340,+Y,0),U)'[""PRC(""" D ^DIC Q:Y<0  S DEBTOR=+Y
"RTN","RCXFMSUV",82,0)
LINK ;LINKS DEBTOR TO VENDOR FILE
"RTN","RCXFMSUV",83,0)
 S VENDOR=$$VENSEL^PRCHUTL() I VENDOR<0 S VENDOR="LINK" Q
"RTN","RCXFMSUV",84,0)
 D STOREL(DEBTOR,VENDOR) Q
"RTN","RCXFMSUV",85,0)
 ;
"RTN","RCXFMSUV",86,0)
 ;
"RTN","RCXFMSUV",87,0)
STOREL(DA,VENDOR) ;  store the link from the debtor file to the vendor file
"RTN","RCXFMSUV",88,0)
 N D,D0,DI,DIC,DIE,DQ,DR,X,Y
"RTN","RCXFMSUV",89,0)
 S DR=".06////"_VENDOR_";"
"RTN","RCXFMSUV",90,0)
 S (DIC,DIE)="^RCD(340,"
"RTN","RCXFMSUV",91,0)
 D ^DIE
"RTN","RCXFMSUV",92,0)
 Q
"RTN","RCXFMSUV",93,0)
 ;
"RTN","RCXFMSUV",94,0)
 ;
"RTN","RCXFMSUV",95,0)
STORE(DA,VENDORID) ;STORES THE VENDOR ID WITH THE BILL
"RTN","RCXFMSUV",96,0)
 I $G(^PRCA(430,DA,0))="" Q
"RTN","RCXFMSUV",97,0)
 N D0,DI,DIC,DIE,DQ,DR,X,Y,D
"RTN","RCXFMSUV",98,0)
 S DR="265////"_VENDORID_";"
"RTN","RCXFMSUV",99,0)
 S (DIC,DIE)="^PRCA(430,"
"RTN","RCXFMSUV",100,0)
 D ^DIE
"RTN","RCXFMSUV",101,0)
 Q
"VER")
8.0^22
**END**
**END**
