Released PRC*5.1*61 SEQ #58
Extracted from mail message
**KIDS**:PRC*5.1*61^

**INSTALL NAME**
PRC*5.1*61
"BLD",2862,0)
PRC*5.1*61^IFCAP^0^3030915^y
"BLD",2862,1,0)
^^10^10^3030515^^
"BLD",2862,1,1,0)
This patch is in support of the site preparation steps for CoreFLS
"BLD",2862,1,2,0)
deployment. It should be installed as a normal patch. A new option will
"BLD",2862,1,3,0)
be installed under the CoreFLS Data Cleansing menu [PRCL COREFLS DATA
"BLD",2862,1,4,0)
CLEANSING] with the same security key as the other options. Instructions
"BLD",2862,1,5,0)
for the use of this option will be included in an official CoreFLS Action
"BLD",2862,1,6,0)
Request.
"BLD",2862,1,7,0)
 
"BLD",2862,1,8,0)
This option contains various reports that show in summary or detail
"BLD",2862,1,9,0)
format the data fields for records in the GENERIC INVENTORY file (#445)
"BLD",2862,1,10,0)
that do not conform to the established CoreFLS data cleansing guidelines.
"BLD",2862,4,0)
^9.64PA^^
"BLD",2862,"KRN",0)
^9.67PA^19^17
"BLD",2862,"KRN",.4,0)
.4
"BLD",2862,"KRN",.401,0)
.401
"BLD",2862,"KRN",.402,0)
.402
"BLD",2862,"KRN",.403,0)
.403
"BLD",2862,"KRN",.5,0)
.5
"BLD",2862,"KRN",.84,0)
.84
"BLD",2862,"KRN",3.6,0)
3.6
"BLD",2862,"KRN",3.8,0)
3.8
"BLD",2862,"KRN",9.2,0)
9.2
"BLD",2862,"KRN",9.8,0)
9.8
"BLD",2862,"KRN",9.8,"NM",0)
^9.68A^6^6
"BLD",2862,"KRN",9.8,"NM",1,0)
PRCLB1^^0^B9328965
"BLD",2862,"KRN",9.8,"NM",2,0)
PRCLB2^^0^B52020895
"BLD",2862,"KRN",9.8,"NM",3,0)
PRCLB3^^0^B51342589
"BLD",2862,"KRN",9.8,"NM",4,0)
PRCLB4^^0^B60198659
"BLD",2862,"KRN",9.8,"NM",5,0)
PRCLB5^^0^B66938421
"BLD",2862,"KRN",9.8,"NM",6,0)
PRCLB6^^0^B5857535
"BLD",2862,"KRN",9.8,"NM","B","PRCLB1",1)

"BLD",2862,"KRN",9.8,"NM","B","PRCLB2",2)

"BLD",2862,"KRN",9.8,"NM","B","PRCLB3",3)

"BLD",2862,"KRN",9.8,"NM","B","PRCLB4",4)

"BLD",2862,"KRN",9.8,"NM","B","PRCLB5",5)

"BLD",2862,"KRN",9.8,"NM","B","PRCLB6",6)

"BLD",2862,"KRN",19,0)
19
"BLD",2862,"KRN",19,"NM",0)
^9.68A^9^8
"BLD",2862,"KRN",19,"NM",2,0)
PRCL COREFLS DATA CLEANSING^^2
"BLD",2862,"KRN",19,"NM",3,0)
PRCL GENERIC INVENTORY^^0
"BLD",2862,"KRN",19,"NM",4,0)
PRCL GEN. INV. ITEM RPT - DET^^0
"BLD",2862,"KRN",19,"NM",5,0)
PRCL GEN. INV. ITEM RPT - SUM^^0
"BLD",2862,"KRN",19,"NM",6,0)
PRCL GEN. INV. POINT RPT - DET^^0
"BLD",2862,"KRN",19,"NM",7,0)
PRCL GEN. INV. POINT RPT - SUM^^0
"BLD",2862,"KRN",19,"NM",8,0)
PRCL MISSING INV. POINT RPT^^0
"BLD",2862,"KRN",19,"NM",9,0)
PRCL SECONDARY INV. POINT RPT^^0
"BLD",2862,"KRN",19,"NM","B","PRCL COREFLS DATA CLEANSING",2)

"BLD",2862,"KRN",19,"NM","B","PRCL GEN. INV. ITEM RPT - DET",4)

"BLD",2862,"KRN",19,"NM","B","PRCL GEN. INV. ITEM RPT - SUM",5)

"BLD",2862,"KRN",19,"NM","B","PRCL GEN. INV. POINT RPT - DET",6)

"BLD",2862,"KRN",19,"NM","B","PRCL GEN. INV. POINT RPT - SUM",7)

"BLD",2862,"KRN",19,"NM","B","PRCL GENERIC INVENTORY",3)

"BLD",2862,"KRN",19,"NM","B","PRCL MISSING INV. POINT RPT",8)

"BLD",2862,"KRN",19,"NM","B","PRCL SECONDARY INV. POINT RPT",9)

"BLD",2862,"KRN",19.1,0)
19.1
"BLD",2862,"KRN",101,0)
101
"BLD",2862,"KRN",409.61,0)
409.61
"BLD",2862,"KRN",771,0)
771
"BLD",2862,"KRN",870,0)
870
"BLD",2862,"KRN",8994,0)
8994
"BLD",2862,"KRN","B",.4,.4)

"BLD",2862,"KRN","B",.401,.401)

"BLD",2862,"KRN","B",.402,.402)

"BLD",2862,"KRN","B",.403,.403)

"BLD",2862,"KRN","B",.5,.5)

"BLD",2862,"KRN","B",.84,.84)

"BLD",2862,"KRN","B",3.6,3.6)

"BLD",2862,"KRN","B",3.8,3.8)

"BLD",2862,"KRN","B",9.2,9.2)

"BLD",2862,"KRN","B",9.8,9.8)

"BLD",2862,"KRN","B",19,19)

"BLD",2862,"KRN","B",19.1,19.1)

"BLD",2862,"KRN","B",101,101)

"BLD",2862,"KRN","B",409.61,409.61)

"BLD",2862,"KRN","B",771,771)

"BLD",2862,"KRN","B",870,870)

"BLD",2862,"KRN","B",8994,8994)

"BLD",2862,"QUES",0)
^9.62^^
"BLD",2862,"REQB",0)
^9.611^^
"KRN",19,10901,-1)
2^2
"KRN",19,10901,0)
PRCL COREFLS DATA CLEANSING^CoreFLS Data Cleansing Menu^^M^100917^PRCL DATA CLEANSING^^^^^^455
"KRN",19,10901,10,0)
^19.01IP^4^4
"KRN",19,10901,10,2,0)
10903^^
"KRN",19,10901,10,2,"^")
PRCL GENERIC INVENTORY
"KRN",19,10901,"U")
COREFLS DATA CLEANSING MENU
"KRN",19,10903,-1)
0^3
"KRN",19,10903,0)
PRCL GENERIC INVENTORY^Generic Inventory Data Cleansing Reports^^M^^PRCL DATA CLEANSING^^^^^^IFCAP
"KRN",19,10903,1,0)
^^4^4^3030722^
"KRN",19,10903,1,1,0)
This menu contains a set of options related to the GENERIC INVENTORY (#445)
"KRN",19,10903,1,2,0)
file for CoreFLS data conversion. It provides a series of reports that
"KRN",19,10903,1,3,0)
highlight data problems that may prevent the successful conversion of these
"KRN",19,10903,1,4,0)
items to the CoreFLS system.
"KRN",19,10903,10,0)
^19.01IP^6^6
"KRN",19,10903,10,1,0)
11185^1^1
"KRN",19,10903,10,1,"^")
PRCL GEN. INV. POINT RPT - SUM
"KRN",19,10903,10,2,0)
11186^2^2
"KRN",19,10903,10,2,"^")
PRCL GEN. INV. POINT RPT - DET
"KRN",19,10903,10,3,0)
11187^3^3
"KRN",19,10903,10,3,"^")
PRCL GEN. INV. ITEM RPT - SUM
"KRN",19,10903,10,4,0)
11188^4^4
"KRN",19,10903,10,4,"^")
PRCL GEN. INV. ITEM RPT - DET
"KRN",19,10903,10,5,0)
11189^5^5
"KRN",19,10903,10,5,"^")
PRCL MISSING INV. POINT RPT
"KRN",19,10903,10,6,0)
11190^6^6
"KRN",19,10903,10,6,"^")
PRCL SECONDARY INV. POINT RPT
"KRN",19,10903,99)
59343,54242
"KRN",19,10903,"U")
GENERIC INVENTORY DATA CLEANSI
"KRN",19,11185,-1)
0^7
"KRN",19,11185,0)
PRCL GEN. INV. POINT RPT - SUM^Summary Generic Inventory Point Report^^R^^PRCL DATA CLEANSING^^^^^^IFCAP^^1
"KRN",19,11185,1,0)
^19.06^4^4^3030722^^
"KRN",19,11185,1,1,0)
This CoreFLS Data Cleansing Report displays a list of fields related to the
"KRN",19,11185,1,2,0)
INVENTORY ITEM (#445.01) sub-file in the GENERIC INVENTORY (#445) file. It
"KRN",19,11185,1,3,0)
provides a total number of all the item-related sub-fields that do not
"KRN",19,11185,1,4,0)
conform to the required formats for CoreFLS data conversion.
"KRN",19,11185,20)
S BODY="LOOP^PRCLB2"
"KRN",19,11185,25)
TOP^PRCLB1
"KRN",19,11185,"U")
SUMMARY GENERIC INVENTORY POIN
"KRN",19,11186,-1)
0^6
"KRN",19,11186,0)
PRCL GEN. INV. POINT RPT - DET^Detailed Generic Inventory Point Report^^R^^PRCL DATA CLEANSING^^^^^^IFCAP^^1
"KRN",19,11186,1,0)
^19.06^4^4^3030722^^
"KRN",19,11186,1,1,0)
This CoreFLS Data Cleansing Report displays a list of fields related to the
"KRN",19,11186,1,2,0)
INVENTORY ITEM (#445.01) sub-file in the GENERIC INVENTORY (#445) file.
"KRN",19,11186,1,3,0)
Listed is each item-related sub-field and the actions to be taken when
"KRN",19,11186,1,4,0)
entries do not conform to the required formats for CoreFLS data conversion.
"KRN",19,11186,20)
S BODY="RPT^PRCLB2"
"KRN",19,11186,25)
TOP^PRCLB1
"KRN",19,11186,"U")
DETAILED GENERIC INVENTORY POI
"KRN",19,11187,-1)
0^5
"KRN",19,11187,0)
PRCL GEN. INV. ITEM RPT - SUM^Summary Generic Inventory Item Report^^R^^PRCL DATA CLEANSING^^^^^^IFCAP^^1
"KRN",19,11187,1,0)
^19.06^4^4^3030722^^
"KRN",19,11187,1,1,0)
This CoreFLS Data Cleansing Report displays a list of fields related to
"KRN",19,11187,1,2,0)
Inventory Point in the GENERIC INVENTORY (#445) file. Listed is the total
"KRN",19,11187,1,3,0)
number of entries in Inventory Point related fields that do not conform to
"KRN",19,11187,1,4,0)
the required formats for CoreFLS data conversion.
"KRN",19,11187,20)
S BODY="LOOP^PRCLB6"
"KRN",19,11187,25)
TOP^PRCLB1
"KRN",19,11187,"U")
SUMMARY GENERIC INVENTORY ITEM
"KRN",19,11188,-1)
0^4
"KRN",19,11188,0)
PRCL GEN. INV. ITEM RPT - DET^Detailed Generic Inventory Item Report^^R^^PRCL DATA CLEANSING^^^^^^IFCAP^^1
"KRN",19,11188,1,0)
^19.06^4^4^3030722^^
"KRN",19,11188,1,1,0)
This CoreFLS Data Cleansing Report displays entries related to an Inventory
"KRN",19,11188,1,2,0)
Point in the GENERIC INVENTORY (#445) file that present a problem and the
"KRN",19,11188,1,3,0)
actions to be taken when entries do not conform to the required formats for
"KRN",19,11188,1,4,0)
CoreFLS data conversion.
"KRN",19,11188,20)
S BODY="RPT^PRCLB5"
"KRN",19,11188,25)
TOP^PRCLB1
"KRN",19,11188,"U")
DETAILED GENERIC INVENTORY ITE
"KRN",19,11189,-1)
0^8
"KRN",19,11189,0)
PRCL MISSING INV. POINT RPT^Missing Inventory Point or 'B' x-ref^^R^^PRCL DATA CLEANSING^^^^^^IFCAP^^1
"KRN",19,11189,1,0)
^19.06^3^3^3030723^^^^
"KRN",19,11189,1,1,0)
This CoreFLS Data Cleansing Report displays entries in the
"KRN",19,11189,1,2,0)
GENERIC INVENTORY (#445) file not listed in the "B" cross reference
"KRN",19,11189,1,3,0)
or with a missing INVENTORY POINT (#.01) field.
"KRN",19,11189,20)
S BODY="RPT1^PRCLB3"
"KRN",19,11189,25)
TOP^PRCLB1
"KRN",19,11189,"U")
MISSING INVENTORY POINT OR 'B'
"KRN",19,11190,-1)
0^9
"KRN",19,11190,0)
PRCL SECONDARY INV. POINT RPT^Secondary Inventory Points w/more than one primary^^R^^PRCL DATA CLEANSING^^^^^^IFCAP^^1
"KRN",19,11190,1,0)
^19.06^5^5^3030723^^^
"KRN",19,11190,1,1,0)
This CoreFLS Data Cleansing Report displays Secondary Inventory Points that
"KRN",19,11190,1,2,0)
are used by more than one Primary Inventory Point. In other words, an entry
"KRN",19,11190,1,3,0)
in the GENERIC INVENTORY (#445) file with TYPE OF INVENTORY POINT (#.7)
"KRN",19,11190,1,4,0)
field set to "S" (Secondary) and listed in the DISTRIBUTION POINT (#4)
"KRN",19,11190,1,5,0)
field for more than one Primary Inventory Point will appear on this report.
"KRN",19,11190,20)
S BODY="RPT2^PRCLB3"
"KRN",19,11190,25)
TOP^PRCLB1
"KRN",19,11190,"U")
SECONDARY INVENTORY POINTS W/M
"MBREQ")
0
"ORD",18,19)
19;18;;;OPT^XPDTA;OPTF1^XPDIA;OPTE1^XPDIA;OPTF2^XPDIA;;OPTDEL^XPDIA
"ORD",18,19,0)
OPTION
"PKG",455,-1)
1^1
"PKG",455,0)
IFCAP^PRC^IFCAP System Files
"PKG",455,20,0)
^9.402P^^
"PKG",455,22,0)
^9.49I^1^1
"PKG",455,22,1,0)
5.1^3001012^3001019^68
"PKG",455,22,1,"PAH",1,0)
61^3030915
"PKG",455,22,1,"PAH",1,1,0)
^^10^10^3030915
"PKG",455,22,1,"PAH",1,1,1,0)
This patch is in support of the site preparation steps for CoreFLS
"PKG",455,22,1,"PAH",1,1,2,0)
deployment. It should be installed as a normal patch. A new option will
"PKG",455,22,1,"PAH",1,1,3,0)
be installed under the CoreFLS Data Cleansing menu [PRCL COREFLS DATA
"PKG",455,22,1,"PAH",1,1,4,0)
CLEANSING] with the same security key as the other options. Instructions
"PKG",455,22,1,"PAH",1,1,5,0)
for the use of this option will be included in an official CoreFLS Action
"PKG",455,22,1,"PAH",1,1,6,0)
Request.
"PKG",455,22,1,"PAH",1,1,7,0)
 
"PKG",455,22,1,"PAH",1,1,8,0)
This option contains various reports that show in summary or detail
"PKG",455,22,1,"PAH",1,1,9,0)
format the data fields for records in the GENERIC INVENTORY file (#445)
"PKG",455,22,1,"PAH",1,1,10,0)
that do not conform to the established CoreFLS data cleansing guidelines.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
6
"RTN","PRCLB1")
0^1^B9328965
"RTN","PRCLB1",1,0)
PRCLB1 ;WOIFO/KJH - Generic Inventory (Main routine) - CoreFLS Data Cleansing ;25 Mar 2003  2:51 PM
"RTN","PRCLB1",2,0)
 ;;5.1;IFCAP;**61**;Oct 20, 2000
"RTN","PRCLB1",3,0)
 ;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","PRCLB1",4,0)
 ;
"RTN","PRCLB1",5,0)
 ;NOTE: This routine is not callable from the top. Set variable 'BODY' (see option reader) and then call tag 'TOP'.
"RTN","PRCLB1",6,0)
 Q
"RTN","PRCLB1",7,0)
TOP ; If this is a report, run it and exit.
"RTN","PRCLB1",8,0)
 W !!
"RTN","PRCLB1",9,0)
 I BODY]"" D DISPLAY G EXIT
"RTN","PRCLB1",10,0)
 ; Otherwise, this is the 'compile' option.
"RTN","PRCLB1",11,0)
 D COMPILE
"RTN","PRCLB1",12,0)
EXIT ; Make sure all the variables that weren't NEW'd get KILL'd. (Exception: ZT* variables are handled by TaskMan.)
"RTN","PRCLB1",13,0)
 K BODY,INS,TYPE,DA,DIR,DIRUT,DTOUT,DUOUT,X,Y,%ZIS
"RTN","PRCLB1",14,0)
 Q
"RTN","PRCLB1",15,0)
DISPLAY ; Ask the user if they wish to display the report for 'Warehouse', 'Primary', or 'Secondary' inventory points. (Only detailed and summary reports)
"RTN","PRCLB1",16,0)
 I $P(BODY,"^")?1"RPT"1N G DISP1
"RTN","PRCLB1",17,0)
 K DIR
"RTN","PRCLB1",18,0)
 S DIR(0)="S^W:WAREHOUSE;P:PRIMARY;S:SECONDARY;A:ALL"
"RTN","PRCLB1",19,0)
 S DIR("A")="Enter Selection"
"RTN","PRCLB1",20,0)
 S DIR("?")="Please select the type of inventory point to include in the report from the following list."
"RTN","PRCLB1",21,0)
 D ^DIR K DIR
"RTN","PRCLB1",22,0)
 I Y["^"!$D(DTOUT)!$D(DUOUT) D EN^DDIOL("<Report Aborted> ",,"!!?10") Q
"RTN","PRCLB1",23,0)
 S TYPE=Y
"RTN","PRCLB1",24,0)
DISP1 ; Ask the user if they wish to display some instructions with the report. (Not for the summary reports.)
"RTN","PRCLB1",25,0)
 S INS="N"
"RTN","PRCLB1",26,0)
 I $P(BODY,"^")="LOOP" G DISP2
"RTN","PRCLB1",27,0)
 K DIR
"RTN","PRCLB1",28,0)
 S DIR(0)="YA",DIR("A")="Do you wish to also display the instructions? ",DIR("B")="YES"
"RTN","PRCLB1",29,0)
 S DIR("?")="Enter 'YES' to display a set of instructions before displaying the report."
"RTN","PRCLB1",30,0)
 D ^DIR K DIR
"RTN","PRCLB1",31,0)
 I Y="^"!$D(DTOUT)!$D(DUOUT) D EN^DDIOL("<Report Aborted> ",,"!!?10") Q
"RTN","PRCLB1",32,0)
 I Y S INS="Y"
"RTN","PRCLB1",33,0)
DISP2 ; Ask the user for a device to print to (queuing is allowed).
"RTN","PRCLB1",34,0)
 S %ZIS="Q"
"RTN","PRCLB1",35,0)
 D ^%ZIS Q:POP
"RTN","PRCLB1",36,0)
 I '$D(IO("Q")) G PRT
"RTN","PRCLB1",37,0)
 S ZTSAVE("BODY")="",ZTSAVE("INS")="",ZTSAVE("TYPE")=""
"RTN","PRCLB1",38,0)
 S ZTRTN="PRT^PRCLB1",ZTDESC="CoreFLS Data Cleansing Report (File# 445 - GENERIC INVENTORY)"
"RTN","PRCLB1",39,0)
 D ^%ZTLOAD,HOME^%ZIS
"RTN","PRCLB1",40,0)
 K ZTSK
"RTN","PRCLB1",41,0)
 Q
"RTN","PRCLB1",42,0)
PRT ; Print the requested report.
"RTN","PRCLB1",43,0)
 U IO
"RTN","PRCLB1",44,0)
 N PRCLA,PRCLB,PRCLD1,PRCLD2,PRCLD3,PRCLD4,PRCLERR,PRCLOK,PRCLN
"RTN","PRCLB1",45,0)
 N PRCLS,PRCLI,PRCLJ,DISP,TOT,TOT1,REQ,HEAD,HEAD1,HDR,HDR1,I,INVPOINT
"RTN","PRCLB1",46,0)
 N PRCLTYPE,ASSOC,PNAME,PRCLB2,PRCLIEN,PRCLN2,SNAME,WNAME,XNAME
"RTN","PRCLB1",47,0)
 S REQ="  * Required field *"
"RTN","PRCLB1",48,0)
 S PRCLA=0,P=0,L=0,ABORT=0
"RTN","PRCLB1",49,0)
 D @BODY
"RTN","PRCLB1",50,0)
PRT1 ; Report completed
"RTN","PRCLB1",51,0)
 I 'ABORT W !,"<End of Report>" I $E(IOST,1,2)="C-" W " Enter RETURN to continue" R Y:DTIME
"RTN","PRCLB1",52,0)
 I ABORT W !,"<Report Aborted>"
"RTN","PRCLB1",53,0)
 D ^%ZISC
"RTN","PRCLB1",54,0)
 K L,P,X,Y,ABORT
"RTN","PRCLB1",55,0)
 I $D(ZTQUEUED) S ZTREQ="@"
"RTN","PRCLB1",56,0)
 Q
"RTN","PRCLB1",57,0)
HDR ; Print the standard report header.
"RTN","PRCLB1",58,0)
 ; Do not ask 'RETURN' before first page on CRT.
"RTN","PRCLB1",59,0)
 I $E(IOST,1,2)="C-",P R !,"Enter RETURN to continue or '^' to exit: ",Y:DTIME I '$T!(Y[U) S ABORT=1 Q
"RTN","PRCLB1",60,0)
 ; Do not print a form feed before first page on printer. Top of form is set at end of previous report.
"RTN","PRCLB1",61,0)
 I $E(IOST,1,2)="C-"!P W @IOF
"RTN","PRCLB1",62,0)
 S P=P+1,L=4
"RTN","PRCLB1",63,0)
 W $E("                              ",1,80-$L(HDR)/2),HDR ; Main report name
"RTN","PRCLB1",64,0)
 W !,"CoreFLS Data Cleansing Report (File# 445 - GENERIC INVENTORY) ",?69,"Page: ",$J(P,4)
"RTN","PRCLB1",65,0)
 W !
"RTN","PRCLB1",66,0)
 I $G(HDR1)]"" W "Results filtered by: ",HDR1
"RTN","PRCLB1",67,0)
 W ?58,"Printed: ",$$FMTE^XLFDT(DT),!
"RTN","PRCLB1",68,0)
 I $G(HEAD)]"" D @HEAD ; Sub-header
"RTN","PRCLB1",69,0)
 Q
"RTN","PRCLB1",70,0)
COMPILE ; Ask the user if they want to queue the inventory point compile
"RTN","PRCLB1",71,0)
 ; *** NOTE: Actually, there currently isn't an inventory point compile since we're searching all inventory points. But should we have one to exclude any specific inventory points?
"RTN","PRCLB1",72,0)
 Q
"RTN","PRCLB2")
0^2^B52020895
"RTN","PRCLB2",1,0)
PRCLB2 ;WOIFO/KJH - Generic Inventory Reports - CoreFLS Data Cleansing (Inventory Points) ;13 May 2003  2:51 PM
"RTN","PRCLB2",2,0)
 ;;5.1;IFCAP;**61**;Oct 20, 2000
"RTN","PRCLB2",3,0)
 ;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","PRCLB2",4,0)
 ;
"RTN","PRCLB2",5,0)
 ;NOTE: This routine is not callable from the top. Use TOP in PRCLB1.
"RTN","PRCLB2",6,0)
 Q
"RTN","PRCLB2",7,0)
RPT ; Detailed Generic Inventory Point Report
"RTN","PRCLB2",8,0)
 K ^TMP("PRCLB2A",$J),^TMP("PRCLB2B",$J)
"RTN","PRCLB2",9,0)
 S HDR="DETAILED GENERIC INVENTORY POINT REPORT",PRCLERR=0
"RTN","PRCLB2",10,0)
 D INS^PRCLB4("TXT1","PRCLB4") Q:ABORT
"RTN","PRCLB2",11,0)
 S HDR1=$S(TYPE="W":"WAREHOUSE",TYPE="P":"PRIMARY",TYPE="S":"SECONDARY",1:"ALL")_" INVENTORY POINTS"
"RTN","PRCLB2",12,0)
 D HDR^PRCLB1 Q:ABORT
"RTN","PRCLB2",13,0)
 ; Check each inventory point
"RTN","PRCLB2",14,0)
 S PRCLA=0
"RTN","PRCLB2",15,0)
 F  S PRCLA=$O(^PRCP(445,PRCLA)) Q:'PRCLA  D  Q:ABORT
"RTN","PRCLB2",16,0)
 . S PRCLN=$G(^PRCP(445,PRCLA,0)),PRCLD1=$P(PRCLN,U,3),PRCLD2=$P(PRCLN,U,1)
"RTN","PRCLB2",17,0)
 . I (PRCLD1'="W")&(PRCLD1'="P")&(PRCLD1'="S") S PRCLD1="X"
"RTN","PRCLB2",18,0)
 . I PRCLD2="" S PRCLD2=" "
"RTN","PRCLB2",19,0)
 . S ^TMP("PRCLB2A",$J,PRCLD1,PRCLD2)=PRCLA
"RTN","PRCLB2",20,0)
 . ; Loop thru distrib. points.
"RTN","PRCLB2",21,0)
 . S PRCLB=0
"RTN","PRCLB2",22,0)
 . F  S PRCLB=$O(^PRCP(445,PRCLA,2,PRCLB)) Q:PRCLB=""  D  Q:ABORT
"RTN","PRCLB2",23,0)
 . . S PRCLB2=$G(^PRCP(445,PRCLA,2,PRCLB,0))
"RTN","PRCLB2",24,0)
 . . S PRCLN2=$G(^PRCP(445,PRCLB2,0))
"RTN","PRCLB2",25,0)
 . . S PRCLD3=$P(PRCLN2,U,1),PRCLD4=$P(PRCLN2,U,3)
"RTN","PRCLB2",26,0)
 . . I (PRCLD1="")!(PRCLD2="")!(PRCLD3="") Q
"RTN","PRCLB2",27,0)
 . . S ^TMP("PRCLB2A",$J,PRCLD1,PRCLD2,PRCLD3)=PRCLB
"RTN","PRCLB2",28,0)
 . . ; Set as matched for distrib. points (exclude 2ndary and self ref.)
"RTN","PRCLB2",29,0)
 . . I PRCLD4="" S PRCLD4="X"
"RTN","PRCLB2",30,0)
 . . I (PRCLD2'=PRCLD3)&(PRCLD1'="S") S ^TMP("PRCLB2B",$J,PRCLD4,PRCLD3)=1
"RTN","PRCLB2",31,0)
 . . Q
"RTN","PRCLB2",32,0)
 . ; If not matched  --> set as unmatched.
"RTN","PRCLB2",33,0)
 . I '$D(^TMP("PRCLB2B",$J,PRCLD1,PRCLD2)) S ^TMP("PRCLB2B",$J,PRCLD1,PRCLD2)=0
"RTN","PRCLB2",34,0)
 . Q
"RTN","PRCLB2",35,0)
 D TAG0
"RTN","PRCLB2",36,0)
 D TAG3
"RTN","PRCLB2",37,0)
 D TAG5
"RTN","PRCLB2",38,0)
 D TAG6
"RTN","PRCLB2",39,0)
 I 'PRCLERR W !!,"No problem records to report."
"RTN","PRCLB2",40,0)
 W !
"RTN","PRCLB2",41,0)
 K ^TMP("PRCLB2A",$J),^TMP("PRCLB2B",$J)
"RTN","PRCLB2",42,0)
 Q
"RTN","PRCLB2",43,0)
TAG0 ; Loop thru warehouse inv. points
"RTN","PRCLB2",44,0)
 S WNAME="",PNAME="",SNAME="",XNAME=""
"RTN","PRCLB2",45,0)
 F  S WNAME=$O(^TMP("PRCLB2A",$J,"W",WNAME)) Q:WNAME=""!ABORT  D 
"RTN","PRCLB2",46,0)
 . S PRCLIEN=$G(^TMP("PRCLB2A",$J,"W",WNAME))
"RTN","PRCLB2",47,0)
 . D RPTB
"RTN","PRCLB2",48,0)
 . D TAG1
"RTN","PRCLB2",49,0)
 . Q
"RTN","PRCLB2",50,0)
 Q
"RTN","PRCLB2",51,0)
TAG1 ; Loop thru "P" subnodes
"RTN","PRCLB2",52,0)
 S PNAME="",SNAME="",XNAME=""
"RTN","PRCLB2",53,0)
 F  S PNAME=$O(^TMP("PRCLB2A",$J,"W",WNAME,PNAME)) Q:PNAME=""!ABORT  D
"RTN","PRCLB2",54,0)
 . S PRCLIEN=$G(^TMP("PRCLB2A",$J,"W",WNAME,PNAME))
"RTN","PRCLB2",55,0)
 . D RPTB
"RTN","PRCLB2",56,0)
 . D TAG2
"RTN","PRCLB2",57,0)
 . Q
"RTN","PRCLB2",58,0)
 Q
"RTN","PRCLB2",59,0)
TAG2 ; Loop thru "S" subnodes
"RTN","PRCLB2",60,0)
 S SNAME="",XNAME=""
"RTN","PRCLB2",61,0)
 F  S SNAME=$O(^TMP("PRCLB2A",$J,"P",PNAME,SNAME)) Q:SNAME=""!ABORT  D
"RTN","PRCLB2",62,0)
 . S PRCLIEN=$G(^TMP("PRCLB2A",$J,"P",PNAME,SNAME))
"RTN","PRCLB2",63,0)
 . D RPTB
"RTN","PRCLB2",64,0)
 . Q
"RTN","PRCLB2",65,0)
 Q
"RTN","PRCLB2",66,0)
TAG3 ; Loop thru unmatched "P"
"RTN","PRCLB2",67,0)
 S PNAME="",SNAME="",XNAME=""
"RTN","PRCLB2",68,0)
 ; Loop thru unmatched "P"
"RTN","PRCLB2",69,0)
 F  S PNAME=$O(^TMP("PRCLB2B",$J,"P",PNAME)) Q:PNAME=""!ABORT  D
"RTN","PRCLB2",70,0)
 . S PRCLIEN=$G(^TMP("PRCLB2A",$J,"P",PNAME))
"RTN","PRCLB2",71,0)
 . ; QUIT IF MATCHED
"RTN","PRCLB2",72,0)
 . I $G(^TMP("PRCLB2B",$J,"P",PNAME))=1 Q
"RTN","PRCLB2",73,0)
 . D RPTB
"RTN","PRCLB2",74,0)
 . D TAG4
"RTN","PRCLB2",75,0)
 . Q
"RTN","PRCLB2",76,0)
 Q
"RTN","PRCLB2",77,0)
TAG4 ; Loop thru "S" subnodes 
"RTN","PRCLB2",78,0)
 S SNAME="",XNAME=""
"RTN","PRCLB2",79,0)
 F  S SNAME=$O(^TMP("PRCLB2A",$J,"P",PNAME,SNAME)) Q:SNAME=""!ABORT  D
"RTN","PRCLB2",80,0)
 . S PRCLIEN=$G(^TMP("PRCLB2A",$J,"P",PNAME,SNAME))
"RTN","PRCLB2",81,0)
 . D RPTB
"RTN","PRCLB2",82,0)
 . Q
"RTN","PRCLB2",83,0)
 Q
"RTN","PRCLB2",84,0)
TAG5 ; Loop thru unmatched "S"
"RTN","PRCLB2",85,0)
 S SNAME="",XNAME=""
"RTN","PRCLB2",86,0)
 F  S SNAME=$O(^TMP("PRCLB2B",$J,"S",SNAME)) Q:SNAME=""!ABORT  D
"RTN","PRCLB2",87,0)
 . S PRCLIEN=$G(^TMP("PRCLB2A",$J,"S",SNAME))
"RTN","PRCLB2",88,0)
 . ; Quit if matched
"RTN","PRCLB2",89,0)
 . I $G(^TMP("PRCLB2B",$J,"S",SNAME))=1 Q
"RTN","PRCLB2",90,0)
 . D RPTB
"RTN","PRCLB2",91,0)
 . Q
"RTN","PRCLB2",92,0)
 Q
"RTN","PRCLB2",93,0)
TAG6 ; Loop thru unmatched - no category "X"
"RTN","PRCLB2",94,0)
 S XNAME=""
"RTN","PRCLB2",95,0)
 F  S XNAME=$O(^TMP("PRCLB2B",$J,"X",XNAME)) Q:XNAME=""!ABORT  D
"RTN","PRCLB2",96,0)
 . S PRCLIEN=$G(^TMP("PRCLB2A",$J,"X",XNAME))
"RTN","PRCLB2",97,0)
 . ; Quit If Matched
"RTN","PRCLB2",98,0)
 . I $G(^TMP("PRCLB2B",$J,"X",XNAME))=1 Q
"RTN","PRCLB2",99,0)
 . D RPTB
"RTN","PRCLB2",100,0)
 . Q
"RTN","PRCLB2",101,0)
 Q
"RTN","PRCLB2",102,0)
RPTB ; Check Inventory Point Type against the user's selection for this report.
"RTN","PRCLB2",103,0)
 S PRCLA=PRCLIEN
"RTN","PRCLB2",104,0)
 S PRCLN=$G(^PRCP(445,PRCLA,0)),PRCLD1=$P(PRCLN,U,3)
"RTN","PRCLB2",105,0)
 I TYPE'="A",TYPE'=PRCLD1 Q  ; Skip this entry if type selected is not 'ALL' and doesn't match current type.
"RTN","PRCLB2",106,0)
 ; Quit if inv. point is inactive
"RTN","PRCLB2",107,0)
 S INVPOINT=$P(PRCLN,U,1)
"RTN","PRCLB2",108,0)
 I INVPOINT?1N.N1"-***"1E.E Q
"RTN","PRCLB2",109,0)
 K DISP
"RTN","PRCLB2",110,0)
 F PRCLJ=1:1:3 S DISP(PRCLJ)="  * OK *"
"RTN","PRCLB2",111,0)
 D CHECK
"RTN","PRCLB2",112,0)
 S PRCLOK=1
"RTN","PRCLB2",113,0)
 F PRCLJ=1:1:3 I DISP(PRCLJ)'="  * OK *",DISP(PRCLJ)'="" S PRCLOK=0
"RTN","PRCLB2",114,0)
 I PRCLOK=1 Q  ; No Inventory Point header entries that seem to be bad.
"RTN","PRCLB2",115,0)
 S PRCLERR=1
"RTN","PRCLB2",116,0)
 S PRCLB=0 F PRCLI=0:1 S PRCLB=$O(DISP(3,PRCLB)) Q:'PRCLB
"RTN","PRCLB2",117,0)
 ; One (blank) header line plus 4 main lines plus 1 line for each distribution point (plus 2 lines as a buffer).
"RTN","PRCLB2",118,0)
 D:L+PRCLI+7>IOSL HDR^PRCLB1 Q:ABORT
"RTN","PRCLB2",119,0)
 S L=L+PRCLI+5
"RTN","PRCLB2",120,0)
 ; List parent distribution points
"RTN","PRCLB2",121,0)
 W !,"Descended from: "
"RTN","PRCLB2",122,0)
 S ASSOC=0
"RTN","PRCLB2",123,0)
 I (WNAME)&(WNAME'=INVPOINT) W WNAME S ASSOC=1
"RTN","PRCLB2",124,0)
 I (PNAME)&(PNAME'=INVPOINT) W:ASSOC=1 " / " W PNAME S ASSOC=1
"RTN","PRCLB2",125,0)
 I (SNAME)&(SNAME'=INVPOINT) W:ASSOC=1 " / " W SNAME S ASSOC=1
"RTN","PRCLB2",126,0)
 I (XNAME)&(XNAME'=INVPOINT) W:ASSOC=1 " / " W XNAME S ASSOC=1
"RTN","PRCLB2",127,0)
 I 'ASSOC W "Not descended from an inventory point"
"RTN","PRCLB2",128,0)
 ;W !,"Inventory Point: ",PRCLA," (",$P($G(^PRCP(445,PRCLA,0)),U,1),")"
"RTN","PRCLB2",129,0)
 W !,"Inventory Point: ",PRCLA," (",INVPOINT,")"
"RTN","PRCLB2",130,0)
 S PRCLN=$G(^PRCP(445,PRCLA,0)),PRCLD1=$P(PRCLN,U,3) W ?50,$S(PRCLD1="W":"WAREHOUSE",PRCLD1="P":"PRIMARY",PRCLD1="S":"SECONDARY",1:"")
"RTN","PRCLB2",131,0)
 W !,"Type of Inv Point",?20,$G(DISP(1))
"RTN","PRCLB2",132,0)
 W !,"Abbreviated Name",?20,$G(DISP(2))
"RTN","PRCLB2",133,0)
 ;W !,"Distribution Point"
"RTN","PRCLB2",134,0)
 I $G(DISP(3))'="  * OK *" W !,"Distribution Point" D
"RTN","PRCLB2",135,0)
 . ; I $G(DISP(3))'?1.N W ?20,$G(DISP(3))
"RTN","PRCLB2",136,0)
 . S PRCLB=0 F  S PRCLB=$O(DISP(3,PRCLB)) Q:'PRCLB  D
"RTN","PRCLB2",137,0)
 . . W !,?10,DISP(3,PRCLB),?20,PRCLB," (",$P($G(^PRCP(445,PRCLB,0)),U,1),")"
"RTN","PRCLB2",138,0)
 . . S L=L+1
"RTN","PRCLB2",139,0)
 . . Q
"RTN","PRCLB2",140,0)
 . Q
"RTN","PRCLB2",141,0)
 W !
"RTN","PRCLB2",142,0)
 Q
"RTN","PRCLB2",143,0)
LOOP ; Summary Generic Inventory Point Report
"RTN","PRCLB2",144,0)
 ; Check each inventory point
"RTN","PRCLB2",145,0)
 F  S PRCLA=$O(^PRCP(445,PRCLA)) Q:'PRCLA  D
"RTN","PRCLB2",146,0)
 . ; Check Inventory Point Type against the user's selection for this report.
"RTN","PRCLB2",147,0)
 . S PRCLN=$G(^PRCP(445,PRCLA,0)),PRCLD1=$P(PRCLN,U,3)
"RTN","PRCLB2",148,0)
 . I TYPE'="A",TYPE'=PRCLD1 Q  ; Skip this entry if type selected is not 'ALL' and doesn't match current type.
"RTN","PRCLB2",149,0)
 . S INVPOINT=$P(PRCLN,U,1)
"RTN","PRCLB2",150,0)
 . I INVPOINT?1N.N1"-***"1E.E Q
"RTN","PRCLB2",151,0)
 . K DISP
"RTN","PRCLB2",152,0)
 . S TOT=$G(TOT)+1
"RTN","PRCLB2",153,0)
 . F PRCLJ=1:1:3 S DISP(PRCLJ)="  * OK *"
"RTN","PRCLB2",154,0)
 . D CHECK
"RTN","PRCLB2",155,0)
 . S PRCLOK=1
"RTN","PRCLB2",156,0)
 . F PRCLJ=1:1:3 I DISP(PRCLJ)'="  * OK *",DISP(PRCLJ)'="" S TOT(PRCLJ)=$G(TOT(PRCLJ))+1,PRCLOK=0
"RTN","PRCLB2",157,0)
 . I PRCLOK=1 Q  ; No Inventory Point header entries that seem to be bad.
"RTN","PRCLB2",158,0)
 . S TOT(0)=$G(TOT(0))+1
"RTN","PRCLB2",159,0)
 . Q
"RTN","PRCLB2",160,0)
 S HDR="SUMMARY GENERIC INVENTORY POINT REPORT",HEAD1=1
"RTN","PRCLB2",161,0)
 S HDR1=$S(TYPE="W":"WAREHOUSE",TYPE="P":"PRIMARY",TYPE="S":"SECONDARY",1:"ALL")_" INVENTORY POINTS"
"RTN","PRCLB2",162,0)
 D HDR^PRCLB1
"RTN","PRCLB2",163,0)
 ; Set null values to "0" for reporting display
"RTN","PRCLB2",164,0)
 I '$G(TOT) S TOT=0
"RTN","PRCLB2",165,0)
 F I=0:1:3 I '$G(TOT(I)) S TOT(I)=0
"RTN","PRCLB2",166,0)
 W !,"# Inventory Points Found",?25,$J($G(TOT),8)
"RTN","PRCLB2",167,0)
 W !,"# With Problems",?25,$J($G(TOT(0)),8)
"RTN","PRCLB2",168,0)
 W !,"Type of Inv Point",?25,$J($G(TOT(1)),8)
"RTN","PRCLB2",169,0)
 W !,"Abbreviated Name",?25,$J($G(TOT(2)),8)
"RTN","PRCLB2",170,0)
 I TYPE'="S" W !,"Distribution Point",?25,$J($G(TOT(3)),8)
"RTN","PRCLB2",171,0)
 W !
"RTN","PRCLB2",172,0)
 Q
"RTN","PRCLB2",173,0)
CHECK ;
"RTN","PRCLB2",174,0)
 ; Type of Inventory Point
"RTN","PRCLB2",175,0)
 S PRCLN=$G(^PRCP(445,PRCLA,0)),PRCLD1=$P(PRCLN,U,3) D
"RTN","PRCLB2",176,0)
 . I PRCLD1="W" Q  ; Warehouse
"RTN","PRCLB2",177,0)
 . I PRCLD1="P" Q  ; Primary
"RTN","PRCLB2",178,0)
 . I PRCLD1="S" Q  ; Secondary
"RTN","PRCLB2",179,0)
 . I PRCLD1="" S DISP(1)=REQ Q
"RTN","PRCLB2",180,0)
 . S DISP(1)=PRCLD1
"RTN","PRCLB2",181,0)
 . Q
"RTN","PRCLB2",182,0)
 ; Abbreviated Name
"RTN","PRCLB2",183,0)
 S PRCLN=$G(^PRCP(445,PRCLA,0)),PRCLD1=$P(PRCLN,U,5) D
"RTN","PRCLB2",184,0)
 . I PRCLD1="" S DISP(2)=REQ Q
"RTN","PRCLB2",185,0)
 . Q
"RTN","PRCLB2",186,0)
 ; Distribution Point
"RTN","PRCLB2",187,0)
 S PRCLN=$G(^PRCP(445,PRCLA,0)),PRCLD1=$P(PRCLN,U,3) D
"RTN","PRCLB2",188,0)
 . ; I PRCLD1="S" S:$D(^PRCP(445,PRCLA,2)) DISP(3)="** Not allowed for Secondary Inventory Points **" Q
"RTN","PRCLB2",189,0)
 . I PRCLD1="S" Q
"RTN","PRCLB2",190,0)
 . S PRCLD2=0 ;,PRCLOK1=0
"RTN","PRCLB2",191,0)
 . F  S PRCLD2=$O(^PRCP(445,PRCLA,2,PRCLD2)) Q:'PRCLD2  D
"RTN","PRCLB2",192,0)
 .. S PRCLN=$G(^PRCP(445,PRCLD2,0)),PRCLD3=$P(PRCLN,U,3)
"RTN","PRCLB2",193,0)
 .. I PRCLD1="W",PRCLD3'="P" S DISP(3,PRCLD2)=PRCLD3,DISP(3)=DISP(3)+1 Q
"RTN","PRCLB2",194,0)
 .. I PRCLD1="P",PRCLD3'="S" S DISP(3,PRCLD2)=PRCLD3,DISP(3)=DISP(3)+1 Q
"RTN","PRCLB2",195,0)
 .. ;S PRCLOK1=1
"RTN","PRCLB2",196,0)
 .. Q
"RTN","PRCLB2",197,0)
 . I DISP(3)?1.N Q  ; Bad entries found
"RTN","PRCLB2",198,0)
 . ;I PRCLOK1=0 S DISP(3)=REQ ; No good entries found
"RTN","PRCLB2",199,0)
 . Q
"RTN","PRCLB2",200,0)
 Q
"RTN","PRCLB3")
0^3^B51342589
"RTN","PRCLB3",1,0)
PRCLB3 ;WOIFO/KJH - Generic Inventory (Other Reports) - CoreFLS Data Cleansing ;25 Apr 2003  2:51 PM
"RTN","PRCLB3",2,0)
 ;;5.1;IFCAP;**61**;Oct 20, 2000
"RTN","PRCLB3",3,0)
 ;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","PRCLB3",4,0)
 ;
"RTN","PRCLB3",5,0)
 ;NOTE: This routine is not callable from the top. Use TOP in PRCLB1.
"RTN","PRCLB3",6,0)
 Q
"RTN","PRCLB3",7,0)
RPT1 ; Missing Inventory Point or "B" x-ref
"RTN","PRCLB3",8,0)
 S HDR="MISSING INVENTORY POINT OR 'B' X-REF REPORT",PRCLERR=0
"RTN","PRCLB3",9,0)
 D INS^PRCLB4("TXT1","PRCLB3") Q:ABORT
"RTN","PRCLB3",10,0)
 S HEAD="HDR1^PRCLB3"
"RTN","PRCLB3",11,0)
 D HDR^PRCLB1 Q:ABORT
"RTN","PRCLB3",12,0)
 F  S PRCLA=$O(^PRCP(445,PRCLA)) Q:'PRCLA  D  Q:ABORT
"RTN","PRCLB3",13,0)
 . D:L+1>IOSL HDR^PRCLB1 Q:ABORT
"RTN","PRCLB3",14,0)
 . S PRCLN=$G(^PRCP(445,PRCLA,0)),PRCLD1=$P(PRCLN,U,1)
"RTN","PRCLB3",15,0)
 . I PRCLD1="" W !,$J(PRCLA,8),?10,REQ,?45,"Inventory Point Name Missing" S L=L+1,PRCLERR=1 Q
"RTN","PRCLB3",16,0)
 . I '$D(^PRCP(445,"B",$E(PRCLD1,1,30),PRCLA)) W !,$J(PRCLA,8),?10,PRCLD1,?45,"Inventory Point not in 'B' x-ref" S L=L+1,PRCLERR=1 Q
"RTN","PRCLB3",17,0)
 . Q
"RTN","PRCLB3",18,0)
 I 'PRCLERR W !!,"No problem records to report."
"RTN","PRCLB3",19,0)
 W !
"RTN","PRCLB3",20,0)
 Q
"RTN","PRCLB3",21,0)
HDR1 ;
"RTN","PRCLB3",22,0)
 W !,"IEN",?10,"Inventory Point",?45,"Reason"
"RTN","PRCLB3",23,0)
 S L=L+1
"RTN","PRCLB3",24,0)
 Q
"RTN","PRCLB3",25,0)
RPT2 ; Secondary Inventory Points (with more than one primary)
"RTN","PRCLB3",26,0)
 K ^TMP("PRCLB",$J)
"RTN","PRCLB3",27,0)
 F  S PRCLA=$O(^PRCP(445,PRCLA)) Q:'PRCLA  D  Q:ABORT
"RTN","PRCLB3",28,0)
 . S PRCLN=$G(^PRCP(445,PRCLA,0)),PRCLD1=$P(PRCLN,U,3) I PRCLD1="P" D
"RTN","PRCLB3",29,0)
 .. S PRCLD2=0
"RTN","PRCLB3",30,0)
 .. F  S PRCLD2=$O(^PRCP(445,PRCLA,2,PRCLD2)) Q:'PRCLD2  D
"RTN","PRCLB3",31,0)
 ... S PRCLN=$G(^PRCP(445,PRCLD2,0)),PRCLD3=$P(PRCLN,U,3)
"RTN","PRCLB3",32,0)
 ... I PRCLD3="S" S ^TMP("PRCLB",$J,PRCLD2,PRCLA)=""
"RTN","PRCLB3",33,0)
 ... Q
"RTN","PRCLB3",34,0)
 .. Q
"RTN","PRCLB3",35,0)
 . Q
"RTN","PRCLB3",36,0)
 S HDR="SECONDARY INVENTORY POINTS (with more than one primary)",PRCLERR=0
"RTN","PRCLB3",37,0)
 D INS^PRCLB4("TXT2","PRCLB3") Q:ABORT
"RTN","PRCLB3",38,0)
 S HEAD="HDR2^PRCLB3"
"RTN","PRCLB3",39,0)
 D HDR^PRCLB1 Q:ABORT
"RTN","PRCLB3",40,0)
 S PRCLA="" F  S PRCLA=$O(^TMP("PRCLB",$J,PRCLA)) Q:PRCLA=""  D  Q:ABORT
"RTN","PRCLB3",41,0)
 . S PRCLB="" F PRCLI=0:1 S PRCLB=$O(^TMP("PRCLB",$J,PRCLA,PRCLB)) Q:PRCLB=""
"RTN","PRCLB3",42,0)
 . S INVPOINT=$P(^PRCP(445,PRCLA,0),U,1)
"RTN","PRCLB3",43,0)
 . I INVPOINT?1N.N1"-***"1E.E Q
"RTN","PRCLB3",44,0)
 . ; Only print when more than one primary has a specified secondary.
"RTN","PRCLB3",45,0)
 . I PRCLI<2 Q
"RTN","PRCLB3",46,0)
 . S PRCLERR=1
"RTN","PRCLB3",47,0)
 . ; One (blank) header line plus 1 description line plus 1 line for each duplicate (plus 3 lines as a buffer).
"RTN","PRCLB3",48,0)
 . D:L+PRCLI+5>IOSL HDR^PRCLB1 Q:ABORT
"RTN","PRCLB3",49,0)
 . S L=L+PRCLI+2
"RTN","PRCLB3",50,0)
 . W !,PRCLA," (",$P($G(^PRCP(445,PRCLA,0)),U,1),")"
"RTN","PRCLB3",51,0)
 . S PRCLB="" F  S PRCLB=$O(^TMP("PRCLB",$J,PRCLA,PRCLB)) Q:PRCLB=""  D
"RTN","PRCLB3",52,0)
 .. W !,?30,PRCLB," (",$P($G(^PRCP(445,PRCLB,0)),U,1),")"
"RTN","PRCLB3",53,0)
 .. Q
"RTN","PRCLB3",54,0)
 . W !
"RTN","PRCLB3",55,0)
 . Q
"RTN","PRCLB3",56,0)
 I 'PRCLERR W !!,"No problem records to report."
"RTN","PRCLB3",57,0)
 W !
"RTN","PRCLB3",58,0)
 K ^TMP("PRCLB",$J)
"RTN","PRCLB3",59,0)
 Q
"RTN","PRCLB3",60,0)
HDR2 ;
"RTN","PRCLB3",61,0)
 W !,"Secondary Inventory Point",?30,"Primary Inventory Point"
"RTN","PRCLB3",62,0)
 S L=L+1
"RTN","PRCLB3",63,0)
 Q
"RTN","PRCLB3",64,0)
TXT1 ; ===========================================================================
"RTN","PRCLB3",65,0)
 ;;The following instructions/notes refer to the CoreFLS Data Cleansing detailed
"RTN","PRCLB3",66,0)
 ;;generic inventory report for Missing Inventory Point or "B" x-ref.
"RTN","PRCLB3",67,0)
 ;;
"RTN","PRCLB3",68,0)
 ;;This report displays two related pieces of information:
"RTN","PRCLB3",69,0)
 ;;        1) If an Inventory Point record is found where the INVENTORY POINT
"RTN","PRCLB3",70,0)
 ;;           (#.01) field is blank, then this report displays the internal
"RTN","PRCLB3",71,0)
 ;;           entry number (IEN) for the inventory point and a message that
"RTN","PRCLB3",72,0)
 ;;           this is a required field. In this case, the user needs to
"RTN","PRCLB3",73,0)
 ;;           determine the correct inventory point name so that the
"RTN","PRCLB3",74,0)
 ;;           inventory point will be converted into CoreFLS.
"RTN","PRCLB3",75,0)
 ;;
"RTN","PRCLB3",76,0)
 ;;        2) If the inventory point name is not found in the
"RTN","PRCLB3",77,0)
 ;;           "B" cross-reference, this report displays the inventory point
"RTN","PRCLB3",78,0)
 ;;           name and IEN with a message that the "B" x-ref is missing.
"RTN","PRCLB3",79,0)
 ;;           This needs to be corrected because the CoreFLS extraction
"RTN","PRCLB3",80,0)
 ;;           process depends on this cross-reference.
"RTN","PRCLB3",81,0)
 ;;
"RTN","PRCLB3",82,0)
 ;;The information for each record is printed by row with the following columns:
"RTN","PRCLB3",83,0)
 ;;
"RTN","PRCLB3",84,0)
 ;;IEN             - GENERIC INVENTORY (#445) file internal record (entry) number
"RTN","PRCLB3",85,0)
 ;;
"RTN","PRCLB3",86,0)
 ;;Inventory Point - value found in the INVENTORY POINT (#.01) field or
"RTN","PRCLB3",87,0)
 ;;                  "* Required field *" if this field is blank
"RTN","PRCLB3",88,0)
 ;;
"RTN","PRCLB3",89,0)
 ;;Reason          - brief description of the identified problem:
"RTN","PRCLB3",90,0)
 ;;
"RTN","PRCLB3",91,0)
 ;;                  "Inventory Point Name Missing" means the INVENTORY POINT
"RTN","PRCLB3",92,0)
 ;;                   (#.01) field is blank.
"RTN","PRCLB3",93,0)
 ;;
"RTN","PRCLB3",94,0)
 ;;                  "Inventory Point not in 'B' x-ref" means the Inventory
"RTN","PRCLB3",95,0)
 ;;                   Point Name found in the INVENTORY POINT (#.01) field is
"RTN","PRCLB3",96,0)
 ;;                   not listed in the "B" cross-reference.
"RTN","PRCLB3",97,0)
 ;;
"RTN","PRCLB3",98,0)
 ;;NOTE: Contact National VistA Support to resolve all entries on this report.
"RTN","PRCLB3",99,0)
 ;;**END**
"RTN","PRCLB3",100,0)
TXT2 ; ===========================================================================
"RTN","PRCLB3",101,0)
 ;;The following instructions/notes refer to the CoreFLS Data Cleansing
"RTN","PRCLB3",102,0)
 ;;detailed generic inventory report for Secondary Inventory Points (with
"RTN","PRCLB3",103,0)
 ;;more than one primary).
"RTN","PRCLB3",104,0)
 ;;
"RTN","PRCLB3",105,0)
 ;;This report displays any secondary inventory points which are used as a
"RTN","PRCLB3",106,0)
 ;;distribution point by more than one primary inventory point. In CoreFLS
"RTN","PRCLB3",107,0)
 ;;each secondary inventory point may only be defined under one primary
"RTN","PRCLB3",108,0)
 ;;inventory point. Any secondary inventory points on this report should be
"RTN","PRCLB3",109,0)
 ;;checked and removed from all but one of the listed primary inventory points.
"RTN","PRCLB3",110,0)
 ;;
"RTN","PRCLB3",111,0)
 ;;If a secondary inventory point is found that needs to receive distributions
"RTN","PRCLB3",112,0)
 ;;from two or more primary inventory points, an extra secondary (with a
"RTN","PRCLB3",113,0)
 ;;slightly different name) should be created for each additional primary. So,
"RTN","PRCLB3",114,0)
 ;;if primary A and primary B distribute to secondary C, the user may rename
"RTN","PRCLB3",115,0)
 ;;the current secondary as C-A and leave it assigned to primary A and then
"RTN","PRCLB3",116,0)
 ;;create a new secondary named C-B and assign it to primary B. Each primary
"RTN","PRCLB3",117,0)
 ;;is now associated with a different secondary even though the two refer to
"RTN","PRCLB3",118,0)
 ;;the same physical inventory location.
"RTN","PRCLB3",119,0)
 ;;
"RTN","PRCLB3",120,0)
 ;;The information for each record is printed by row with the following columns:
"RTN","PRCLB3",121,0)
 ;;
"RTN","PRCLB3",122,0)
 ;;Secondary Inventory Point    - GENERIC INVENTORY (#445) file internal record
"RTN","PRCLB3",123,0)
 ;;                               (entry) number and INVENTORY POINT (#.01)
"RTN","PRCLB3",124,0)
 ;;                               field for the inventory point that has TYPE OF
"RTN","PRCLB3",125,0)
 ;;                               INVENTORY POINT (#.7) field "S" meaning
"RTN","PRCLB3",126,0)
 ;;                               secondary
"RTN","PRCLB3",127,0)
 ;;
"RTN","PRCLB3",128,0)
 ;;Primary Inventory Point      - GENERIC INVENTORY (#445) file internal record
"RTN","PRCLB3",129,0)
 ;;                               (entry) number and INVENTORY POINT (#.01)
"RTN","PRCLB3",130,0)
 ;;                               field for the inventory point that has TYPE OF
"RTN","PRCLB3",131,0)
 ;;                               INVENTORY POINT (#.7) field "P" meaning
"RTN","PRCLB3",132,0)
 ;;                               primary and has DISTRIBUTION POINT (#4)
"RTN","PRCLB3",133,0)
 ;;                               multiple field pointing to that secondary
"RTN","PRCLB3",134,0)
 ;;                               inventory point
"RTN","PRCLB3",135,0)
 ;;**END**
"RTN","PRCLB3",136,0)
 Q
"RTN","PRCLB4")
0^4^B60198659
"RTN","PRCLB4",1,0)
PRCLB4 ;WOIFO/KJH - Generic Inventory (Instructions) - CoreFLS Data Cleansing ;25 Apr 2003  2:51 PM
"RTN","PRCLB4",2,0)
 ;;5.1;IFCAP;**61**;Oct 20, 2000
"RTN","PRCLB4",3,0)
 ;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","PRCLB4",4,0)
 ;
"RTN","PRCLB4",5,0)
 ;NOTE: This routine is not callable from the top. Use TOP in PRCLB1.
"RTN","PRCLB4",6,0)
 Q
"RTN","PRCLB4",7,0)
INS(TAG,RTN) ; Print Data Cleansing 'instructions/notes' (max 75 columns per line).
"RTN","PRCLB4",8,0)
 I INS'="Y" S HEAD1=1 Q
"RTN","PRCLB4",9,0)
 S HDR="INSTRUCTIONS FOR "_HDR
"RTN","PRCLB4",10,0)
 D HDR^PRCLB1
"RTN","PRCLB4",11,0)
 F PRCLI=1:1 S @("PRCLN=$T("_TAG_"+"_PRCLI_"^"_RTN_")"),PRCLN=$P(PRCLN,";;",2,999) Q:PRCLN="**END**"  D:L+3>IOSL HDR^PRCLB1 Q:ABORT  W !,PRCLN S L=L+1
"RTN","PRCLB4",12,0)
 Q:ABORT
"RTN","PRCLB4",13,0)
 ; Must have a page break between instructions and report, but don't want to do a full header.
"RTN","PRCLB4",14,0)
 W !!,"<End of Instructions>"
"RTN","PRCLB4",15,0)
 ; Do not ask 'RETURN' before first page on CRT.
"RTN","PRCLB4",16,0)
 I $E(IOST,1,2)="C-",P R " Enter RETURN to continue or '^' to exit: ",Y:DTIME I '$T!(Y[U) S ABORT=1 Q
"RTN","PRCLB4",17,0)
 ; Do not print a form feed before first page on printer. Top of form is set at end of previous report.
"RTN","PRCLB4",18,0)
 I $E(IOST,1,2)="C-"!P W @IOF
"RTN","PRCLB4",19,0)
 S HDR=$P(HDR," ",3,$L(HDR," ")),HEAD1=1,P=0,L=0 ; Reset header and page and line number indicators for main report
"RTN","PRCLB4",20,0)
 Q
"RTN","PRCLB4",21,0)
TXT1 ; ===========================================================================
"RTN","PRCLB4",22,0)
 ;;The following instructions/notes refer to the CoreFLS Data Cleansing
"RTN","PRCLB4",23,0)
 ;;Detailed Generic Inventory Point Report. They explain the criteria for each
"RTN","PRCLB4",24,0)
 ;;field and what actions the user needs to take to update any fields that
"RTN","PRCLB4",25,0)
 ;;do not conform to the required formats. The report displays fields that
"RTN","PRCLB4",26,0)
 ;;do not match CoreFLS guidelines for inventory point header records which
"RTN","PRCLB4",27,0)
 ;;would be converted into CoreFLS.
"RTN","PRCLB4",28,0)
 ;;
"RTN","PRCLB4",29,0)
 ;;Each field can contain one of the following pieces of information:
"RTN","PRCLB4",30,0)
 ;;
"RTN","PRCLB4",31,0)
 ;;* OK *
"RTN","PRCLB4",32,0)
 ;;  - The field contains data and it is in a format acceptable to CoreFLS.
"RTN","PRCLB4",33,0)
 ;;    No problems were detected. The user can ignore these fields.
"RTN","PRCLB4",34,0)
 ;;    OK fields are listed (rather than suppressed) so that the data fields
"RTN","PRCLB4",35,0)
 ;;    appear in the same position for every inventory point record making
"RTN","PRCLB4",36,0)
 ;;    it easier to scan the reports for specific fields of interest.
"RTN","PRCLB4",37,0)
 ;;* Required field *
"RTN","PRCLB4",38,0)
 ;;  - The field is required in CoreFLS, but may or may not be required in
"RTN","PRCLB4",39,0)
 ;;    VistA. The user needs to determine what value should be stored in this
"RTN","PRCLB4",40,0)
 ;;    field and update it in the VistA system.
"RTN","PRCLB4",41,0)
 ;;BLANK (no data displayed)
"RTN","PRCLB4",42,0)
 ;;  - The field has no data stored in it in the VistA system and it is not
"RTN","PRCLB4",43,0)
 ;;    required in CoreFLS. (The user may still wish to review these fields
"RTN","PRCLB4",44,0)
 ;;    to determine if they would like to populate them before the conversion
"RTN","PRCLB4",45,0)
 ;;    to CoreFLS.)
"RTN","PRCLB4",46,0)
 ;;Other Data
"RTN","PRCLB4",47,0)
 ;;  - The field has data that will present a problem for the CoreFLS data
"RTN","PRCLB4",48,0)
 ;;    conversion.
"RTN","PRCLB4",49,0)
 ;;
"RTN","PRCLB4",50,0)
 ;;The following FIELD DESCRIPTIONS list details for each header abbreviation,
"RTN","PRCLB4",51,0)
 ;;the field name and number, and the allowed values or other screening
"RTN","PRCLB4",52,0)
 ;;criteria used for that field. Unless otherwise noted, all fields are from
"RTN","PRCLB4",53,0)
 ;;the GENERIC INVENTORY (#445) file. Consult the help text for each field in
"RTN","PRCLB4",54,0)
 ;;the VistA system for further information.
"RTN","PRCLB4",55,0)
 ;;
"RTN","PRCLB4",56,0)
 ;;FIELD DESCRIPTIONS
"RTN","PRCLB4",57,0)
 ;;===========================================================================
"RTN","PRCLB4",58,0)
 ;;Descended from
"RTN","PRCLB4",59,0)
 ;;  - Reports the inventory points in the distribution chain that
"RTN","PRCLB4",60,0)
 ;;    distribute to this inventory point.
"RTN","PRCLB4",61,0)
 ;;Type of Inv Point      [TYPE OF INVENTORY POINT  (Field .7)]
"RTN","PRCLB4",62,0)
 ;;  - Required field. Must be one of the following:
"RTN","PRCLB4",63,0)
 ;;       W (SUPPLY WAREHOUSE)
"RTN","PRCLB4",64,0)
 ;;       P (PRIMARY INVENTORY POINT)
"RTN","PRCLB4",65,0)
 ;;       S (SECONDARY INVENTORY POINT)
"RTN","PRCLB4",66,0)
 ;;Abbreviated Name       [ABBREVIATED NAME         (Field .8)]
"RTN","PRCLB4",67,0)
 ;;  - Required field.
"RTN","PRCLB4",68,0)
 ;;Distribution Point     [DISTRIBUTION POINT       (Field 4) ]
"RTN","PRCLB4",69,0)
 ;;  - If this multiple field exists for warehouse or primary inventory 
"RTN","PRCLB4",70,0)
 ;;    points then each entry must be a valid entry in the GENERIC INVENTORY
"RTN","PRCLB4",71,0)
 ;;    file (#445). This field is not displayed for secondary inventory
"RTN","PRCLB4",72,0)
 ;;    points. 
"RTN","PRCLB4",73,0)
 ;;**END**
"RTN","PRCLB4",74,0)
TXT2 ; ===========================================================================
"RTN","PRCLB4",75,0)
 ;;The following instructions/notes refer to the CoreFLS Data Cleansing
"RTN","PRCLB4",76,0)
 ;;Detailed Generic Inventory Item Report. They explain the criteria for each
"RTN","PRCLB4",77,0)
 ;;field and what actions the user needs to take to update any fields that
"RTN","PRCLB4",78,0)
 ;;do not conform to the required formats. The report displays fields that
"RTN","PRCLB4",79,0)
 ;;do not match CoreFLS guidelines for inventory point item records which
"RTN","PRCLB4",80,0)
 ;;would be converted into CoreFLS.
"RTN","PRCLB4",81,0)
 ;;
"RTN","PRCLB4",82,0)
 ;;Each field can contain one of the following pieces of information:
"RTN","PRCLB4",83,0)
 ;;
"RTN","PRCLB4",84,0)
 ;;* OK *
"RTN","PRCLB4",85,0)
 ;;  - The field contains data and it is in a format acceptable to CoreFLS.
"RTN","PRCLB4",86,0)
 ;;    No problems were detected. The user can ignore these fields.
"RTN","PRCLB4",87,0)
 ;;    OK fields are listed (rather than suppressed) so that the data fields
"RTN","PRCLB4",88,0)
 ;;    appear in the same position for every item record making
"RTN","PRCLB4",89,0)
 ;;    it easier to scan the reports for specific fields of interest.
"RTN","PRCLB4",90,0)
 ;;* Required field *
"RTN","PRCLB4",91,0)
 ;;  - The field is required in CoreFLS, but may or may not be required in
"RTN","PRCLB4",92,0)
 ;;    VistA. The user needs to determine what value should be stored in this
"RTN","PRCLB4",93,0)
 ;;    field and update it in the VistA system.
"RTN","PRCLB4",94,0)
 ;;BLANK (no data displayed)
"RTN","PRCLB4",95,0)
 ;;  - The field has no data stored in it in the VistA system and it is not
"RTN","PRCLB4",96,0)
 ;;    required in CoreFLS. (The user may still wish to review these fields
"RTN","PRCLB4",97,0)
 ;;    to determine if they would like to populate them before the conversion
"RTN","PRCLB4",98,0)
 ;;    to CoreFLS.)
"RTN","PRCLB4",99,0)
 ;;Other Data
"RTN","PRCLB4",100,0)
 ;;  - The field has data that will present a problem for the CoreFLS data
"RTN","PRCLB4",101,0)
 ;;    conversion.
"RTN","PRCLB4",102,0)
 ;;
"RTN","PRCLB4",103,0)
 ;;The following FIELD DESCRIPTIONS list details for each header abbreviation,
"RTN","PRCLB4",104,0)
 ;;the field name and number, and the allowed values or other screening
"RTN","PRCLB4",105,0)
 ;;criteria used for that field. Unless otherwise noted, all fields are from
"RTN","PRCLB4",106,0)
 ;;the GENERIC INVENTORY (#445) file. Consult the help text for each field in
"RTN","PRCLB4",107,0)
 ;;the VistA system for further information.
"RTN","PRCLB4",108,0)
 ;;
"RTN","PRCLB4",109,0)
 ;;FIELD DESCRIPTIONS
"RTN","PRCLB4",110,0)
 ;;===========================================================================
"RTN","PRCLB4",111,0)
 ;;Descended from
"RTN","PRCLB4",112,0)
 ;;  - Reports the inventory points in the distribution chain that
"RTN","PRCLB4",113,0)
 ;;    distribute to this inventory point.
"RTN","PRCLB4",114,0)
 ;;Item No.            [ITEM NO.                      (File 445.01 Field .01)]
"RTN","PRCLB4",115,0)
 ;;  - Required field. Must be a valid entry in the ITEM MASTER file (#441)
"RTN","PRCLB4",116,0)
 ;;Unit of Issue       [UNIT OF ISSUE                 (File 445.01 Field 4)  ]
"RTN","PRCLB4",117,0)
 ;;  - Required field. Must be a valid entry in the UNIT OF ISSUE
"RTN","PRCLB4",118,0)
 ;;    file (#420.5)
"RTN","PRCLB4",119,0)
 ;;U/I Package Multi.  [UNIT OF ISSUE PACKAGE MULT.   (File 445.01 Field 4.5)]
"RTN","PRCLB4",120,0)
 ;;  - If field exists, must be an integer greater than zero.
"RTN","PRCLB4",121,0)
 ;;Normal Stock Level  [NORMAL STOCK LEVEL (U OF I)   (File 445.01 Field 9)  ]
"RTN","PRCLB4",122,0)
 ;;  - If field exists, must be an integer greater than or equal to zero.
"RTN","PRCLB4",123,0)
 ;;Std. Reorder Point  [STANDARD REORDER POINT        (File 445.01 Field 10) ]
"RTN","PRCLB4",124,0)
 ;;  - If field exists, must be an integer greater than or equal to zero.
"RTN","PRCLB4",125,0)
 ;;Mandatory Source    [MANDATORY OR REQUESTED SOURCE (File 445.01 Field .4) ]
"RTN","PRCLB4",126,0)
 ;;  - If field exists, must be a valid entry in the GENERIC INVENTORY
"RTN","PRCLB4",127,0)
 ;;    file (445) or the VENDOR file (440). This field is not displayed
"RTN","PRCLB4",128,0)
 ;;    for secondary inventory points.
"RTN","PRCLB4",129,0)
 ;;Main Storage Loc.   [MAIN STORAGE LOCATION         (File 445.01 Field 5)  ]
"RTN","PRCLB4",130,0)
 ;;  - If field exists, must be a valid entry in the STORAGE LOCATION
"RTN","PRCLB4",131,0)
 ;;    file (#445.4)
"RTN","PRCLB4",132,0)
 ;;Addt'l Storage Loc. [ADDITIONAL STORAGE LOCATION   (File 445.01 Field 6)  ]
"RTN","PRCLB4",133,0)
 ;;  - This is a multiple field and if there are any entries then each must
"RTN","PRCLB4",134,0)
 ;;    be a valid entry in the STORAGE LOCATION file (#445.4). This field
"RTN","PRCLB4",135,0)
 ;;    is not displayed for secondary inventory points.
"RTN","PRCLB4",136,0)
 ;;**END**
"RTN","PRCLB5")
0^5^B66938421
"RTN","PRCLB5",1,0)
PRCLB5 ;WOIFO/KJH - Generic Inventory Reports - CoreFLS Data Cleansing (Items) ;13 May 2003  2:26 PM
"RTN","PRCLB5",2,0)
 ;;5.1;IFCAP;**61**;Oct 20, 2000
"RTN","PRCLB5",3,0)
 ;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","PRCLB5",4,0)
 ;
"RTN","PRCLB5",5,0)
 ;NOTE: This routine is not callable from the top. Use TOP in PRCLB1.
"RTN","PRCLB5",6,0)
 Q
"RTN","PRCLB5",7,0)
RPT ; Detailed Generic Inventory Item Report
"RTN","PRCLB5",8,0)
 K ^TMP("PRCLB5A",$J),^TMP("PRCLB5B",$J)
"RTN","PRCLB5",9,0)
 S HDR="DETAILED GENERIC INVENTORY ITEM REPORT",PRCLERR=0
"RTN","PRCLB5",10,0)
 D INS^PRCLB4("TXT2","PRCLB4") Q:ABORT
"RTN","PRCLB5",11,0)
 S HDR1=$S(TYPE="W":"WAREHOUSE",TYPE="P":"PRIMARY",TYPE="S":"SECONDARY",1:"ALL")_" INVENTORY POINTS"
"RTN","PRCLB5",12,0)
 D HDR^PRCLB1 Q:ABORT
"RTN","PRCLB5",13,0)
 ; Check each inventory point
"RTN","PRCLB5",14,0)
 F  S PRCLA=$O(^PRCP(445,PRCLA)) Q:'PRCLA  D  Q:ABORT
"RTN","PRCLB5",15,0)
 . S PRCLN=$G(^PRCP(445,PRCLA,0)),PRCLD1=$P(PRCLN,U,3),PRCLD2=$P(PRCLN,U,1)
"RTN","PRCLB5",16,0)
 . I (PRCLD1'="W")&(PRCLD1'="P")&(PRCLD1'="S") S PRCLD1="X"
"RTN","PRCLB5",17,0)
 . I PRCLD2="" S PRCLD2=" "
"RTN","PRCLB5",18,0)
 . S ^TMP("PRCLB5A",$J,PRCLD1,PRCLD2)=PRCLA
"RTN","PRCLB5",19,0)
 . ; Loop thru distrib. points.
"RTN","PRCLB5",20,0)
 . S PRCLB=0
"RTN","PRCLB5",21,0)
 . F  S PRCLB=$O(^PRCP(445,PRCLA,2,PRCLB)) Q:PRCLB=""  D  Q:ABORT
"RTN","PRCLB5",22,0)
 . . S PRCLB2=$G(^PRCP(445,PRCLA,2,PRCLB,0))
"RTN","PRCLB5",23,0)
 . . S PRCLN2=$G(^PRCP(445,PRCLB2,0))
"RTN","PRCLB5",24,0)
 . . S PRCLD3=$P(PRCLN2,U,1),PRCLD4=$P(PRCLN2,U,3)
"RTN","PRCLB5",25,0)
 . . I (PRCLD1="")!(PRCLD2="")!(PRCLD3="") Q
"RTN","PRCLB5",26,0)
 . . S ^TMP("PRCLB5A",$J,PRCLD1,PRCLD2,PRCLD3)=PRCLB
"RTN","PRCLB5",27,0)
 . . ; Set as matched for distrib. points
"RTN","PRCLB5",28,0)
 . . I PRCLD4="" S PRCLD4="X"
"RTN","PRCLB5",29,0)
 . . I (PRCLD2'=PRCLD3)!(PRCLD1'="S") S ^TMP("PRCLB5B",$J,PRCLD4,PRCLD3)=1
"RTN","PRCLB5",30,0)
 . . Q
"RTN","PRCLB5",31,0)
 . ; If not matched  --> set as unmatched.
"RTN","PRCLB5",32,0)
 . I '$D(^TMP("PRCLB5B",$J,PRCLD1,PRCLD2)) S ^TMP("PRCLB5B",$J,PRCLD1,PRCLD2)=0
"RTN","PRCLB5",33,0)
 . Q
"RTN","PRCLB5",34,0)
 D TAG0
"RTN","PRCLB5",35,0)
 D TAG3
"RTN","PRCLB5",36,0)
 D TAG5
"RTN","PRCLB5",37,0)
 D TAG6
"RTN","PRCLB5",38,0)
 I 'PRCLERR W !!,"No problem records to report."
"RTN","PRCLB5",39,0)
 W !
"RTN","PRCLB5",40,0)
 K ^TMP("PRCLB5",$J)
"RTN","PRCLB5",41,0)
 K ^TMP("PRCLB5A",$J),^TMP("PRCLB5B",$J)
"RTN","PRCLB5",42,0)
 Q
"RTN","PRCLB5",43,0)
TAG0 ; Loop thru warehouse inv. points
"RTN","PRCLB5",44,0)
 S WNAME="",PNAME="",SNAME="",XNAME=""
"RTN","PRCLB5",45,0)
 F  S WNAME=$O(^TMP("PRCLB5A",$J,"W",WNAME)) Q:WNAME=""!ABORT  D
"RTN","PRCLB5",46,0)
 . S PRCLIEN=$G(^TMP("PRCLB5A",$J,"W",WNAME))
"RTN","PRCLB5",47,0)
 . D RPTB
"RTN","PRCLB5",48,0)
 . D TAG1
"RTN","PRCLB5",49,0)
 . Q
"RTN","PRCLB5",50,0)
 Q
"RTN","PRCLB5",51,0)
TAG1 ; Loop thru "P" subnodes
"RTN","PRCLB5",52,0)
 S PNAME="",SNAME="",XNAME=""
"RTN","PRCLB5",53,0)
 F  S PNAME=$O(^TMP("PRCLB5A",$J,"W",WNAME,PNAME)) Q:PNAME=""!ABORT  D
"RTN","PRCLB5",54,0)
 . S PRCLIEN=$G(^TMP("PRCLB5A",$J,"W",WNAME,PNAME))
"RTN","PRCLB5",55,0)
 . D RPTB
"RTN","PRCLB5",56,0)
 . D TAG2
"RTN","PRCLB5",57,0)
 . Q
"RTN","PRCLB5",58,0)
 Q
"RTN","PRCLB5",59,0)
TAG2 ; Loop thru "S" subnodes
"RTN","PRCLB5",60,0)
 S SNAME="",XNAME=""
"RTN","PRCLB5",61,0)
 F  S SNAME=$O(^TMP("PRCLB5A",$J,"P",PNAME,SNAME)) Q:SNAME=""!ABORT  D
"RTN","PRCLB5",62,0)
 . S PRCLIEN=$G(^TMP("PRCLB5A",$J,"P",PNAME,SNAME))
"RTN","PRCLB5",63,0)
 . D RPTB
"RTN","PRCLB5",64,0)
 . Q
"RTN","PRCLB5",65,0)
 Q
"RTN","PRCLB5",66,0)
TAG3 ; Loop thru unmatched "P"
"RTN","PRCLB5",67,0)
 S PNAME="",SNAME="",XNAME=""
"RTN","PRCLB5",68,0)
 F  S PNAME=$O(^TMP("PRCLB5B",$J,"P",PNAME)) Q:PNAME=""!ABORT  D
"RTN","PRCLB5",69,0)
 . S PRCLIEN=$G(^TMP("PRCLB5A",$J,"P",PNAME))
"RTN","PRCLB5",70,0)
 . ; QUIT IF MATCHED
"RTN","PRCLB5",71,0)
 . I $G(^TMP("PRCLB5B",$J,"P",PNAME))=1 Q
"RTN","PRCLB5",72,0)
 . D RPTB
"RTN","PRCLB5",73,0)
 . D TAG4
"RTN","PRCLB5",74,0)
 . Q
"RTN","PRCLB5",75,0)
 Q
"RTN","PRCLB5",76,0)
TAG4 ; Loop thru "S" subnodes
"RTN","PRCLB5",77,0)
 S SNAME="",XNAME=""
"RTN","PRCLB5",78,0)
 F  S SNAME=$O(^TMP("PRCLB5A",$J,"P",PNAME,SNAME)) Q:SNAME=""!ABORT  D
"RTN","PRCLB5",79,0)
 . S PRCLIEN=$G(^TMP("PRCLB5A",$J,"P",PNAME,SNAME))
"RTN","PRCLB5",80,0)
 . D RPTB
"RTN","PRCLB5",81,0)
 . Q
"RTN","PRCLB5",82,0)
 Q
"RTN","PRCLB5",83,0)
TAG5 ; Loop thru unmatched "S"
"RTN","PRCLB5",84,0)
 S SNAME="",XNAME=""
"RTN","PRCLB5",85,0)
 F  S SNAME=$O(^TMP("PRCLB5B",$J,"S",SNAME)) Q:SNAME=""!ABORT  D
"RTN","PRCLB5",86,0)
 . S PRCLIEN=$G(^TMP("PRCLB5A",$J,"S",SNAME))
"RTN","PRCLB5",87,0)
 . ; Quit if matched
"RTN","PRCLB5",88,0)
 . I $G(^TMP("PRCLB5B",$J,"S",SNAME))=1 Q
"RTN","PRCLB5",89,0)
 . D RPTB
"RTN","PRCLB5",90,0)
 . Q
"RTN","PRCLB5",91,0)
 Q
"RTN","PRCLB5",92,0)
TAG6 ; Loop thru unmatched - no category "X"
"RTN","PRCLB5",93,0)
 S XNAME=""
"RTN","PRCLB5",94,0)
 F  S XNAME=$O(^TMP("PRCLB5B",$J,"X",XNAME)) Q:XNAME=""!ABORT  D
"RTN","PRCLB5",95,0)
 . S PRCLIEN=$G(^TMP("PRCLB5A",$J,"X",XNAME))
"RTN","PRCLB5",96,0)
 . ; Quit If Matched
"RTN","PRCLB5",97,0)
 . I $G(^TMP("PRCLB5B",$J,"X",XNAME))=1 Q
"RTN","PRCLB5",98,0)
 . D RPTB
"RTN","PRCLB5",99,0)
 . Q
"RTN","PRCLB5",100,0)
 Q
"RTN","PRCLB5",101,0)
RPTB D
"RTN","PRCLB5",102,0)
 . ; Check Inventory Point Type against the user's selection for this report.
"RTN","PRCLB5",103,0)
 . S PRCLA=PRCLIEN
"RTN","PRCLB5",104,0)
 . S PRCLN=$G(^PRCP(445,PRCLA,0)),PRCLD1=$P(PRCLN,U,3)
"RTN","PRCLB5",105,0)
 . I TYPE'="A",TYPE'=PRCLD1 Q  ; Skip this entry if type selected is not 'ALL' and doesn't match current type.
"RTN","PRCLB5",106,0)
 . ; Skip inactive inv. points
"RTN","PRCLB5",107,0)
 . S INVPOINT=$P(PRCLN,U,1)
"RTN","PRCLB5",108,0)
 . I INVPOINT?1N.N1"-***"1E.E Q
"RTN","PRCLB5",109,0)
 . K ^TMP("PRCLB5",$J)
"RTN","PRCLB5",110,0)
 . ; Check each 'Item' sub-entry
"RTN","PRCLB5",111,0)
 . S PRCLB=0 F  S PRCLB=$O(^PRCP(445,PRCLA,1,PRCLB)) Q:'PRCLB  D
"RTN","PRCLB5",112,0)
 .. F PRCLJ=1:1:9 S ^TMP("PRCLB5",$J,PRCLB,PRCLJ)="  * OK *"
"RTN","PRCLB5",113,0)
 .. D CHECK1
"RTN","PRCLB5",114,0)
 .. S PRCLOK=1
"RTN","PRCLB5",115,0)
 .. F PRCLJ=1:1:9 I ^TMP("PRCLB5",$J,PRCLB,PRCLJ)'="  * OK *",^TMP("PRCLB5",$J,PRCLB,PRCLJ)'="" S PRCLOK=0
"RTN","PRCLB5",116,0)
 .. I PRCLOK=1 K ^TMP("PRCLB5",$J,PRCLB)
"RTN","PRCLB5",117,0)
 .. Q
"RTN","PRCLB5",118,0)
 . I '$D(^TMP("PRCLB5",$J)) Q  ; No Item sub-file entries that seem to be bad.
"RTN","PRCLB5",119,0)
 . S PRCLERR=1
"RTN","PRCLB5",120,0)
 . ; Print each bad Item sub-file entry
"RTN","PRCLB5",121,0)
 . S PRCLB=0 F  S PRCLB=$O(^TMP("PRCLB5",$J,PRCLB)) Q:'PRCLB  D  Q:ABORT
"RTN","PRCLB5",122,0)
 .. S PRCLS=0 F PRCLI=0:1 S PRCLS=$O(^TMP("PRCLB5",$J,PRCLB,8,PRCLS)) Q:'PRCLS  D  Q:ABORT
"RTN","PRCLB5",123,0)
 .. ; One (blank) header line plus 7 main lines plus 1 line for each additional storage location (plus 2 lines as a buffer)
"RTN","PRCLB5",124,0)
 .. D:L+PRCLI+10>IOSL HDR^PRCLB1 Q:ABORT
"RTN","PRCLB5",125,0)
 .. S L=L+PRCLI+8
"RTN","PRCLB5",126,0)
 .. ; List parent distrib. points
"RTN","PRCLB5",127,0)
 .. W !,"Descended from: "
"RTN","PRCLB5",128,0)
 .. S ASSOC=0
"RTN","PRCLB5",129,0)
 .. I (WNAME)&(WNAME'=INVPOINT) W WNAME S ASSOC=1
"RTN","PRCLB5",130,0)
 .. I (PNAME)&(PNAME'=INVPOINT) W:ASSOC=1 " / " W PNAME S ASSOC=1
"RTN","PRCLB5",131,0)
 .. I (SNAME)&(SNAME'=INVPOINT) W:ASSOC=1 " / " W SNAME S ASSOC=1
"RTN","PRCLB5",132,0)
 .. I (XNAME)&(XNAME'=INVPOINT) W:ASSOC=1 " / " W XNAME S ASSOC=1
"RTN","PRCLB5",133,0)
 .. I 'ASSOC W "Not descended from an inventory point"
"RTN","PRCLB5",134,0)
 .. W !,"Inventory Point: ",PRCLA," (",$P($G(^PRCP(445,PRCLA,0)),U,1),")"
"RTN","PRCLB5",135,0)
 .. S PRCLN=$G(^PRCP(445,PRCLA,0)),PRCLD1=$P(PRCLN,U,3)
"RTN","PRCLB5",136,0)
 .. W ?50,$S(PRCLD1="W":"WAREHOUSE",PRCLD1="P":"PRIMARY",PRCLD1="S":"SECONDARY",1:"")
"RTN","PRCLB5",137,0)
 .. W !,"Inventory Item:  ",PRCLB," (",$P($G(^PRCP(445,PRCLA,1,PRCLB,6)),U,1),")"
"RTN","PRCLB5",138,0)
 .. W !,"Item No.",?19,$G(^TMP("PRCLB5",$J,PRCLB,1))
"RTN","PRCLB5",139,0)
 .. W !,"Unit of Issue",?19,$G(^TMP("PRCLB5",$J,PRCLB,5))
"RTN","PRCLB5",140,0)
 .. W ?40,"U/I Package Multi.",?59,$G(^TMP("PRCLB5",$J,PRCLB,6))
"RTN","PRCLB5",141,0)
 .. W !,"Normal Stock Level",?19,$G(^TMP("PRCLB5",$J,PRCLB,9))
"RTN","PRCLB5",142,0)
 .. W ?40,"Std. Reorder Point",?59,$G(^TMP("PRCLB5",$J,PRCLB,2))
"RTN","PRCLB5",143,0)
 .. W !,"Main Storage Loc.",?19,$G(^TMP("PRCLB5",$J,PRCLB,7))
"RTN","PRCLB5",144,0)
 .. I PRCLD1'="S" D
"RTN","PRCLB5",145,0)
 ... W ?40,"Mandatory Source",?59,$G(^TMP("PRCLB5",$J,PRCLB,3))
"RTN","PRCLB5",146,0)
 ... W !,"Addt'l Storage Loc."
"RTN","PRCLB5",147,0)
 ... I $G(^TMP("PRCLB5",$J,PRCLB,8))'?1.N W ?19,$G(^TMP("PRCLB5",$J,PRCLB,8))
"RTN","PRCLB5",148,0)
 ... S PRCLS=0 F  S PRCLS=$O(^TMP("PRCLB5",$J,PRCLB,8,PRCLS)) Q:'PRCLS  D  Q:ABORT
"RTN","PRCLB5",149,0)
 .... W !,?10,^TMP("PRCLB5",$J,PRCLB,8,PRCLS),?19,PRCLS," (",$P($G(^PRCP(445.4,PRCLS,0)),U,1),")"
"RTN","PRCLB5",150,0)
 .... Q
"RTN","PRCLB5",151,0)
 ... Q
"RTN","PRCLB5",152,0)
 .. W !
"RTN","PRCLB5",153,0)
 .. Q
"RTN","PRCLB5",154,0)
 . Q
"RTN","PRCLB5",155,0)
 Q
"RTN","PRCLB5",156,0)
CHECK1 ;
"RTN","PRCLB5",157,0)
 ; Item Number
"RTN","PRCLB5",158,0)
 S PRCLN=$G(^PRCP(445,PRCLA,1,PRCLB,0)),PRCLD1=$P(PRCLN,U,1) D
"RTN","PRCLB5",159,0)
 . I PRCLD1="" S ^TMP("PRCLB5",$J,PRCLB,1)=REQ Q
"RTN","PRCLB5",160,0)
 . I '$D(^PRC(441,PRCLD1,0)) S ^TMP("PRCLB5",$J,PRCLB,1)=PRCLD1 Q
"RTN","PRCLB5",161,0)
 . Q
"RTN","PRCLB5",162,0)
 ; Standard Re-Order Point
"RTN","PRCLB5",163,0)
 S PRCLN=$G(^PRCP(445,PRCLA,1,PRCLB,0)),PRCLD1=$P(PRCLN,U,10) D
"RTN","PRCLB5",164,0)
 . I PRCLD1="" Q  ; NULL is allowed in this field
"RTN","PRCLB5",165,0)
 . I PRCLD1'?1.N S ^TMP("PRCLB5",$J,PRCLB,2)=PRCLD1 Q
"RTN","PRCLB5",166,0)
 . I PRCLD1<0 S ^TMP("PRCLB5",$J,PRCLB,2)=PRCLD1 Q
"RTN","PRCLB5",167,0)
 . Q
"RTN","PRCLB5",168,0)
 ; Mandatory or Requested Source
"RTN","PRCLB5",169,0)
 S PRCLN=$G(^PRCP(445,PRCLA,0)),PRCLTYPE=$P(PRCLN,U,3)
"RTN","PRCLB5",170,0)
 S PRCLN=$G(^PRCP(445,PRCLA,1,PRCLB,0)),PRCLD1=$P(PRCLN,U,12) D
"RTN","PRCLB5",171,0)
 . I PRCLD1="" Q  ; NULL is allowed in this field
"RTN","PRCLB5",172,0)
 . ; Quit if secondary inv. point
"RTN","PRCLB5",173,0)
 . I PRCLTYPE="S" Q
"RTN","PRCLB5",174,0)
 . I $P(PRCLD1,";",1)=""!($P(PRCLD1,";",2)="") S ^TMP("PRCLB5",$J,PRCLB,3)=PRCLD1 Q
"RTN","PRCLB5",175,0)
 . I '$D(@("^"_$P(PRCLD1,";",2)_$P(PRCLD1,";",1)_",0)")) S ^TMP("PRCLB5",$J,PRCLB,3)=PRCLD1 Q
"RTN","PRCLB5",176,0)
 . Q
"RTN","PRCLB5",177,0)
 ; Unit of Issue
"RTN","PRCLB5",178,0)
 S PRCLN=$G(^PRCP(445,PRCLA,1,PRCLB,0)),PRCLD1=$P(PRCLN,U,5) D
"RTN","PRCLB5",179,0)
 . I PRCLD1="" S ^TMP("PRCLB5",$J,PRCLB,5)=REQ Q
"RTN","PRCLB5",180,0)
 . I '$D(^PRCD(420.5,PRCLD1,0)) S ^TMP("PRCLB5",$J,PRCLB,5)=PRCLD1
"RTN","PRCLB5",181,0)
 . Q
"RTN","PRCLB5",182,0)
 ; Unit of Issue (Packaging Multiple)
"RTN","PRCLB5",183,0)
 S PRCLN=$G(^PRCP(445,PRCLA,1,PRCLB,0)),PRCLD1=$P(PRCLN,U,14) D
"RTN","PRCLB5",184,0)
 . I PRCLD1="" Q  ; NULL is allowed in this field
"RTN","PRCLB5",185,0)
 . I PRCLD1'?1.N S ^TMP("PRCLB5",$J,PRCLB,6)=PRCLD1 Q
"RTN","PRCLB5",186,0)
 . I PRCLD1'>0 S ^TMP("PRCLB5",$J,PRCLB,6)=PRCLD1 Q
"RTN","PRCLB5",187,0)
 . Q
"RTN","PRCLB5",188,0)
 ; Main Storage Location
"RTN","PRCLB5",189,0)
 S PRCLN=$G(^PRCP(445,PRCLA,1,PRCLB,0)),PRCLD1=$P(PRCLN,U,6) D
"RTN","PRCLB5",190,0)
 . I PRCLD1="" Q
"RTN","PRCLB5",191,0)
 . I '$D(^PRCP(445.4,PRCLD1,0)) S ^TMP("PRCLB5",$J,PRCLB,7)=PRCLD1
"RTN","PRCLB5",192,0)
 . Q
"RTN","PRCLB5",193,0)
 ; Additional Storage Location
"RTN","PRCLB5",194,0)
 S PRCLN=$G(^PRCP(445,PRCLA,0)),PRCLD1=$P(PRCLN,U,3) D
"RTN","PRCLB5",195,0)
 . I PRCLD1="S" Q
"RTN","PRCLB5",196,0)
 . ; I PRCLD1="S" S:$D(^PRCP(445,PRCLA,1,PRCLB,1)) ^TMP("PRCLB5",$J,PRCLB,8)="** Not allowed for Secondary Inventory Points **"
"RTN","PRCLB5",197,0)
 . S PRCLD2=0
"RTN","PRCLB5",198,0)
 . F  S PRCLD2=$O(^PRCP(445,PRCLA,1,PRCLB,1,PRCLD2)) Q:'PRCLD2  D
"RTN","PRCLB5",199,0)
 .. ; I PRCLA=9 W !,PRCLB," ",PRCLD2 ; **
"RTN","PRCLB5",200,0)
 .. I $D(^PRCP(445.4,PRCLD2,0)) Q
"RTN","PRCLB5",201,0)
 .. S ^TMP("PRCLB5",$J,PRCLB,8,PRCLD2)="",^TMP("PRCLB5",$J,PRCLB,8)=^TMP("PRCLB5",$J,PRCLB,8)+1
"RTN","PRCLB5",202,0)
 .. Q
"RTN","PRCLB5",203,0)
 . Q
"RTN","PRCLB5",204,0)
 ; Normal Stock Level
"RTN","PRCLB5",205,0)
 S PRCLN=$G(^PRCP(445,PRCLA,1,PRCLB,0)),PRCLD1=$P(PRCLN,U,9) D
"RTN","PRCLB5",206,0)
 . I PRCLD1="" Q  ; NULL is allowed in this field
"RTN","PRCLB5",207,0)
 . I PRCLD1'?1.N S ^TMP("PRCLB5",$J,PRCLB,9)=PRCLD1 Q
"RTN","PRCLB5",208,0)
 . I PRCLD1<0 S ^TMP("PRCLB5",$J,PRCLB,9)=PRCLD1 Q
"RTN","PRCLB5",209,0)
 . Q
"RTN","PRCLB5",210,0)
 Q
"RTN","PRCLB6")
0^6^B5857535
"RTN","PRCLB6",1,0)
PRCLB6 ;WOIFO/KJH - Generic Inventory Reports - CoreFLS Data Cleansing (Items);13 May 2003  2:26 PM
"RTN","PRCLB6",2,0)
 ;;5.1;IFCAP;**61**;Oct 20, 2000
"RTN","PRCLB6",3,0)
 ;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","PRCLB6",4,0)
 ;
"RTN","PRCLB6",5,0)
 ;NOTE: This routine is not callable from the top. Use TOP in PRCLB1.
"RTN","PRCLB6",6,0)
 Q
"RTN","PRCLB6",7,0)
LOOP ; Summary Generic Inventory Item Report
"RTN","PRCLB6",8,0)
 ; Check each inventory point
"RTN","PRCLB6",9,0)
 F  S PRCLA=$O(^PRCP(445,PRCLA)) Q:'PRCLA  D
"RTN","PRCLB6",10,0)
 . ; Check Inventory Point Type against the user's selection for this report.
"RTN","PRCLB6",11,0)
 . S PRCLN=$G(^PRCP(445,PRCLA,0)),PRCLD1=$P(PRCLN,U,3)
"RTN","PRCLB6",12,0)
 . I TYPE'="A",TYPE'=PRCLD1 Q  ; Skip this entry if type selected is not 'ALL' and doesn't match current type.
"RTN","PRCLB6",13,0)
 . ; Skip inactive inv. points
"RTN","PRCLB6",14,0)
 . S INVPOINT=$P(PRCLN,U,1)
"RTN","PRCLB6",15,0)
 . I INVPOINT?1N.N1"-***"1E.E Q
"RTN","PRCLB6",16,0)
 . K ^TMP("PRCLB5",$J)
"RTN","PRCLB6",17,0)
 . ; Check each 'Item' sub-entry
"RTN","PRCLB6",18,0)
 . S PRCLB=0 F  S PRCLB=$O(^PRCP(445,PRCLA,1,PRCLB)) Q:'PRCLB  D
"RTN","PRCLB6",19,0)
 .. S TOT1=$G(TOT1)+1
"RTN","PRCLB6",20,0)
 .. F PRCLJ=1:1:9 S ^TMP("PRCLB5",$J,PRCLB,PRCLJ)="  * OK *"
"RTN","PRCLB6",21,0)
 .. D CHECK1^PRCLB5
"RTN","PRCLB6",22,0)
 .. S PRCLOK=1
"RTN","PRCLB6",23,0)
 .. F PRCLJ=1:1:9 I ^TMP("PRCLB5",$J,PRCLB,PRCLJ)'="  * OK *",^TMP("PRCLB5",$J,PRCLB,PRCLJ)'="" S TOT1(PRCLJ)=$G(TOT1(PRCLJ))+1,PRCLOK=0
"RTN","PRCLB6",24,0)
 .. I PRCLOK=1 K ^TMP("PRCLB5",$J,PRCLB) Q
"RTN","PRCLB6",25,0)
 .. S TOT1(0)=$G(TOT1(0))+1
"RTN","PRCLB6",26,0)
 .. Q
"RTN","PRCLB6",27,0)
 . Q
"RTN","PRCLB6",28,0)
 S HDR="SUMMARY GENERIC INVENTORY ITEM REPORT",HEAD1=1
"RTN","PRCLB6",29,0)
 S HDR1=$S(TYPE="W":"WAREHOUSE",TYPE="P":"PRIMARY",TYPE="S":"SECONDARY",1:"ALL")_" INVENTORY POINTS"
"RTN","PRCLB6",30,0)
 D HDR^PRCLB1
"RTN","PRCLB6",31,0)
 ; Set null values to "0" for reporting display
"RTN","PRCLB6",32,0)
 I '$G(TOT1) S TOT1=0
"RTN","PRCLB6",33,0)
 F I=0:1:9 I '$G(TOT1(I)) S TOT1(I)=0
"RTN","PRCLB6",34,0)
 W !,"# of Inventory Items Found",?30,$J($G(TOT1),8)
"RTN","PRCLB6",35,0)
 W !,"# With Problems",?30,$J($G(TOT1(0)),8)
"RTN","PRCLB6",36,0)
 W !,"Item No.",?30,$J($G(TOT1(1)),8)
"RTN","PRCLB6",37,0)
 W !,"Unit of Issue",?30,$J($G(TOT1(5)),8)
"RTN","PRCLB6",38,0)
 W ?50,"U/I Package Multi.",?70,$J($G(TOT1(6)),8)
"RTN","PRCLB6",39,0)
 W !,"Normal Stock Level",?30,$J($G(TOT1(9)),8)
"RTN","PRCLB6",40,0)
 W ?50,"Std. Reorder Point",?70,$J($G(TOT1(2)),8)
"RTN","PRCLB6",41,0)
 W !,"Main Storage Loc.",?30,$J($G(TOT1(7)),8)
"RTN","PRCLB6",42,0)
 I TYPE'="S" D
"RTN","PRCLB6",43,0)
 . W ?50,"Mandatory Source",?70,$J($G(TOT1(3)),8)
"RTN","PRCLB6",44,0)
 . W !,"Addt'l Storage Loc.",?30,$J($G(TOT1(8)),8)
"RTN","PRCLB6",45,0)
 . Q
"RTN","PRCLB6",46,0)
 W !
"RTN","PRCLB6",47,0)
 K ^TMP("PRCLB5",$J)
"RTN","PRCLB6",48,0)
 Q
"VER")
8.0^22.0
**END**
**END**
