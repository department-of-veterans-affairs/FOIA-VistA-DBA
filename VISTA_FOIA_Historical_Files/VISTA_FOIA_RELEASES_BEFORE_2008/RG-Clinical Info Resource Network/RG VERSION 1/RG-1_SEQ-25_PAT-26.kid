Released RG*1*26 SEQ #25
Extracted from mail message
**KIDS**:RG*1.0*26^

**INSTALL NAME**
RG*1.0*26
"BLD",1548,0)
RG*1.0*26^CLINICAL INFO RESOURCE NETWORK^0^3020924^y
"BLD",1548,1,0)
^^3^3^3020726^
"BLD",1548,1,1,0)
NEW MESSSAGE STRUCTURE - PHASE 1
"BLD",1548,1,2,0)
Refer to patch RG*1*26 in the FORUM Patch Module for a complete
"BLD",1548,1,3,0)
description.
"BLD",1548,4,0)
^9.64PA^^
"BLD",1548,"ABNS",0)
^9.66A^^
"BLD",1548,"ABPKG")
^^
"BLD",1548,"INID")
^y
"BLD",1548,"INIT")
RGP26PST
"BLD",1548,"KRN",0)
^9.67PA^8989.52^19
"BLD",1548,"KRN",.4,0)
.4
"BLD",1548,"KRN",.401,0)
.401
"BLD",1548,"KRN",.402,0)
.402
"BLD",1548,"KRN",.403,0)
.403
"BLD",1548,"KRN",.5,0)
.5
"BLD",1548,"KRN",.84,0)
.84
"BLD",1548,"KRN",3.6,0)
3.6
"BLD",1548,"KRN",3.8,0)
3.8
"BLD",1548,"KRN",9.2,0)
9.2
"BLD",1548,"KRN",9.8,0)
9.8
"BLD",1548,"KRN",9.8,"NM",0)
^9.68A^8^5
"BLD",1548,"KRN",9.8,"NM",3,0)
RGADTP^^0^B93476080
"BLD",1548,"KRN",9.8,"NM",4,0)
RGP26PST^^0^B997157
"BLD",1548,"KRN",9.8,"NM",5,0)
RGADTP1^^0^B28492244
"BLD",1548,"KRN",9.8,"NM",7,0)
RGRSDYN^^0^B5625324
"BLD",1548,"KRN",9.8,"NM",8,0)
RGADTPC^^0^B582302
"BLD",1548,"KRN",9.8,"NM","B","RGADTP",3)

"BLD",1548,"KRN",9.8,"NM","B","RGADTP1",5)

"BLD",1548,"KRN",9.8,"NM","B","RGADTPC",8)

"BLD",1548,"KRN",9.8,"NM","B","RGP26PST",4)

"BLD",1548,"KRN",9.8,"NM","B","RGRSDYN",7)

"BLD",1548,"KRN",19,0)
19
"BLD",1548,"KRN",19.1,0)
19.1
"BLD",1548,"KRN",101,0)
101
"BLD",1548,"KRN",101,"NM",0)
^9.68A^10^10
"BLD",1548,"KRN",101,"NM",1,0)
RG ADT-A04 TRIGGER^^0
"BLD",1548,"KRN",101,"NM",2,0)
RG ADT-A08 TRIGGER^^0
"BLD",1548,"KRN",101,"NM",3,0)
RG ADT-A04 2.4 SERVER^^0
"BLD",1548,"KRN",101,"NM",4,0)
RG ADT-A04 2.4 CLIENT^^0
"BLD",1548,"KRN",101,"NM",5,0)
RG ADT-A08 2.4 SERVER^^0
"BLD",1548,"KRN",101,"NM",6,0)
RG ADT-A08 2.4 CLIENT^^0
"BLD",1548,"KRN",101,"NM",7,0)
RG ADT-A01 2.4 SERVER^^0
"BLD",1548,"KRN",101,"NM",8,0)
RG ADT-A01 2.4 CLIENT^^0
"BLD",1548,"KRN",101,"NM",9,0)
RG ADT-A03 2.4 SERVER^^0
"BLD",1548,"KRN",101,"NM",10,0)
RG ADT-A03 2.4 CLIENT^^0
"BLD",1548,"KRN",101,"NM","B","RG ADT-A01 2.4 CLIENT",8)

"BLD",1548,"KRN",101,"NM","B","RG ADT-A01 2.4 SERVER",7)

"BLD",1548,"KRN",101,"NM","B","RG ADT-A03 2.4 CLIENT",10)

"BLD",1548,"KRN",101,"NM","B","RG ADT-A03 2.4 SERVER",9)

"BLD",1548,"KRN",101,"NM","B","RG ADT-A04 2.4 CLIENT",4)

"BLD",1548,"KRN",101,"NM","B","RG ADT-A04 2.4 SERVER",3)

"BLD",1548,"KRN",101,"NM","B","RG ADT-A04 TRIGGER",1)

"BLD",1548,"KRN",101,"NM","B","RG ADT-A08 2.4 CLIENT",6)

"BLD",1548,"KRN",101,"NM","B","RG ADT-A08 2.4 SERVER",5)

"BLD",1548,"KRN",101,"NM","B","RG ADT-A08 TRIGGER",2)

"BLD",1548,"KRN",409.61,0)
409.61
"BLD",1548,"KRN",771,0)
771
"BLD",1548,"KRN",771,"NM",0)
^9.68A^1^1
"BLD",1548,"KRN",771,"NM",1,0)
RG ADT^^0
"BLD",1548,"KRN",771,"NM","B","RG ADT",1)

"BLD",1548,"KRN",870,0)
870
"BLD",1548,"KRN",8989.51,0)
8989.51
"BLD",1548,"KRN",8989.52,0)
8989.52
"BLD",1548,"KRN",8994,0)
8994
"BLD",1548,"KRN","B",.4,.4)

"BLD",1548,"KRN","B",.401,.401)

"BLD",1548,"KRN","B",.402,.402)

"BLD",1548,"KRN","B",.403,.403)

"BLD",1548,"KRN","B",.5,.5)

"BLD",1548,"KRN","B",.84,.84)

"BLD",1548,"KRN","B",3.6,3.6)

"BLD",1548,"KRN","B",3.8,3.8)

"BLD",1548,"KRN","B",9.2,9.2)

"BLD",1548,"KRN","B",9.8,9.8)

"BLD",1548,"KRN","B",19,19)

"BLD",1548,"KRN","B",19.1,19.1)

"BLD",1548,"KRN","B",101,101)

"BLD",1548,"KRN","B",409.61,409.61)

"BLD",1548,"KRN","B",771,771)

"BLD",1548,"KRN","B",870,870)

"BLD",1548,"KRN","B",8989.51,8989.51)

"BLD",1548,"KRN","B",8989.52,8989.52)

"BLD",1548,"KRN","B",8994,8994)

"BLD",1548,"QUES",0)
^9.62^^
"BLD",1548,"REQB",0)
^9.611^2^2
"BLD",1548,"REQB",1,0)
DG*5.3*428^2
"BLD",1548,"REQB",2,0)
RG*1.0*23^2
"BLD",1548,"REQB","B","DG*5.3*428",1)

"BLD",1548,"REQB","B","RG*1.0*23",2)

"INIT")
RGP26PST
"KRN",101,1841,-1)
0^2
"KRN",101,1841,0)
RG ADT-A08 TRIGGER^MPI/PD ADT-A08 Trigger Protocol^^S^^^^^^^^CLINICAL INFO RESOURCE NETWORK
"KRN",101,1841,1,0)
^^5^5^3020719^
"KRN",101,1841,1,1,0)
This is the new MPI/PD ADT-A08 HL7 2.4 trigger client protocol.  This 
"KRN",101,1841,1,2,0)
protocol is used to process in messages generated by the VAFC ADT-A08 
"KRN",101,1841,1,3,0)
SERVER protocol that is in 2.3 format and update the message to the 2.4 
"KRN",101,1841,1,4,0)
standard and include full enhanced mode acknowledgements at both the
"KRN",101,1841,1,5,0)
commit and application level.
"KRN",101,1841,99)
58968,33458
"KRN",101,1841,770)
^RG MPIPD^^A08^^^^^^^ACK
"KRN",101,1841,771)
Q
"KRN",101,1841,773)
1^1
"KRN",101,1841,774)
D PROC^RGADTP
"KRN",101,1882,-1)
0^7
"KRN",101,1882,0)
RG ADT-A01 2.4 SERVER^MPI/PD ADT-A01 2.4 Server Protocol^^E^^^^^^^^CLINICAL INFO RESOURCE NETWORK
"KRN",101,1882,1,0)
^^2^2^3020507^
"KRN",101,1882,1,1,0)
This is the new MPI/PD ADT-A01 HL7 2.4 server protocol.  This new version 
"KRN",101,1882,1,2,0)
includes the new PID as well as the routing via the MPI.
"KRN",101,1882,99)
58968,33281
"KRN",101,1882,770)
RG ADT^^ADT^A01^^^^AL^AL^2.4^
"KRN",101,1882,772)
D RESP^RGADTP
"KRN",101,1882,775,0)
^101.0775PA^1^1
"KRN",101,1882,775,1,0)
1883
"KRN",101,1882,775,1,"^")
RG ADT-A01 2.4 CLIENT
"KRN",101,1883,-1)
0^8
"KRN",101,1883,0)
RG ADT-A01 2.4 CLIENT^MPI/PD ADT-A01 2.4 Client Protocol^^S^^^^^^^^CLINICAL INFO RESOURCE NETWORK
"KRN",101,1883,1,0)
^^4^4^3020805^
"KRN",101,1883,1,1,0)
This is the new MPI/PD ADT-A01 HL7 2.4 client protocol.  This new version 
"KRN",101,1883,1,2,0)
includes the new PID as well as the routing via the MPI.  This will be 
"KRN",101,1883,1,3,0)
used to send admission data to the MPI to support the synchronization of 
"KRN",101,1883,1,4,0)
the patients date last treated and/or event reason.
"KRN",101,1883,99)
58968,33248
"KRN",101,1883,770)
^RG ADT^^A01^^^^^^^ACK
"KRN",101,1883,771)
D INIT^RGADTP
"KRN",101,1883,773)
1^1
"KRN",101,1883,774)
D ROUTE^RGADTP
"KRN",101,1884,-1)
0^9
"KRN",101,1884,0)
RG ADT-A03 2.4 SERVER^MPI/PD ADT-A03 2.4 Server Protocol^^E^^^^^^^^CLINICAL INFO RESOURCE NETWORK
"KRN",101,1884,1,0)
^^2^2^3020507^
"KRN",101,1884,1,1,0)
This is the new MPI/PD ADT-A03 HL7 2.4 server protocol.  This new version
"KRN",101,1884,1,2,0)
includes the new PID as well as the routing via the MPI.
"KRN",101,1884,99)
58968,33333
"KRN",101,1884,770)
RG ADT^^ADT^A03^^^^AL^AL^2.4^
"KRN",101,1884,772)
D RESP^RGADTP
"KRN",101,1884,775,0)
^101.0775PA^1^1
"KRN",101,1884,775,1,0)
1885
"KRN",101,1884,775,1,"^")
RG ADT-A03 2.4 CLIENT
"KRN",101,1885,-1)
0^10
"KRN",101,1885,0)
RG ADT-A03 2.4 CLIENT^MPI/PD ADT-A03 2.4 Client Protocol^^S^^^^^^^^CLINICAL INFO RESOURCE NETWORK
"KRN",101,1885,1,0)
^^4^4^3020805^
"KRN",101,1885,1,1,0)
This is the new MPI/PD ADT-A03 HL7 2.4 client protocol.  This new version 
"KRN",101,1885,1,2,0)
includes the new PID as well as the routing via the MPI.  This will be 
"KRN",101,1885,1,3,0)
used to send discharge and clinic checkout data to the MPI to support the
"KRN",101,1885,1,4,0)
synchronization of the patients date last treated and/or event reason.
"KRN",101,1885,99)
58968,33321
"KRN",101,1885,770)
^RG ADT^^A03^^^^^^^ACK
"KRN",101,1885,771)
D INIT^RGADTP
"KRN",101,1885,773)
1^1
"KRN",101,1885,774)
D ROUTE^RGADTP
"KRN",101,1886,-1)
0^3
"KRN",101,1886,0)
RG ADT-A04 2.4 SERVER^MPI/PD ADT-A04 2.4 Server Protocol^^E^^^^^^^^CLINICAL INFO RESOURCE NETWORK
"KRN",101,1886,1,0)
^^3^3^3020507^
"KRN",101,1886,1,1,0)
This is the new MPI/PD ADT-A04 (Register a Patient) HL7 2.4 server
"KRN",101,1886,1,2,0)
protocol. This new version includes the new PID as well as the routing via
"KRN",101,1886,1,3,0)
the MPI.
"KRN",101,1886,99)
58968,33369
"KRN",101,1886,770)
RG ADT^^ADT^A04^^^^AL^AL^2.4^
"KRN",101,1886,772)
D RESP^RGADTP
"KRN",101,1886,775,0)
^101.0775PA^1^1
"KRN",101,1886,775,1,0)
1887
"KRN",101,1886,775,1,"^")
RG ADT-A04 2.4 CLIENT
"KRN",101,1887,-1)
0^4
"KRN",101,1887,0)
RG ADT-A04 2.4 CLIENT^MPI/PD ADT-A04 2.4 Client Protocol^^S^^^^^^^^CLINICAL INFO RESOURCE NETWORK
"KRN",101,1887,1,0)
^^4^4^3020805^
"KRN",101,1887,1,1,0)
This is the new MPI/PD ADT-A04 HL7 2.4 client protocol.  This new version
"KRN",101,1887,1,2,0)
includes the new PID as well as the routing via the MPI.  This will be 
"KRN",101,1887,1,3,0)
used to send registration data to the MPI to support the synchronization
"KRN",101,1887,1,4,0)
of the patient demographic data.
"KRN",101,1887,99)
58968,33358
"KRN",101,1887,770)
^RG ADT^^A04^^^^^^^ACK
"KRN",101,1887,771)
D INIT^RGADTP
"KRN",101,1887,773)
1^1
"KRN",101,1887,774)
D ROUTE^RGADTP
"KRN",101,1888,-1)
0^5
"KRN",101,1888,0)
RG ADT-A08 2.4 SERVER^MPI/PD ADT-A08 2.4 Server Protocol^^E^^^^^^^^CLINICAL INFO RESOURCE NETWORK
"KRN",101,1888,1,0)
^101.06^2^2^3020613^^
"KRN",101,1888,1,1,0)
This is the new MPI/PD ADT-A08 (Patient Update) HL7 2.4 server protocol.  
"KRN",101,1888,1,2,0)
This new version includes the new PID as well as the routing via the MPI.
"KRN",101,1888,99)
58968,33434
"KRN",101,1888,770)
RG ADT^^ADT^A08^^^^AL^AL^2.4^
"KRN",101,1888,772)
D RESP^RGADTP
"KRN",101,1888,775,0)
^101.0775PA^1^1
"KRN",101,1888,775,1,0)
1889
"KRN",101,1888,775,1,"^")
RG ADT-A08 2.4 CLIENT
"KRN",101,1889,-1)
0^6
"KRN",101,1889,0)
RG ADT-A08 2.4 CLIENT^MPI/PD ADT-A08 2.4 Client Protocol^^S^^^^^^^^CLINICAL INFO RESOURCE NETWORK
"KRN",101,1889,1,0)
^^4^4^3020805^
"KRN",101,1889,1,1,0)
This is the new MPI/PD ADT-A08 HL7 2.4 client protocol.  This new version
"KRN",101,1889,1,2,0)
includes the new PID as well as the routing via the MPI.  This will be 
"KRN",101,1889,1,3,0)
used to send updated patient data to the MPI to support the
"KRN",101,1889,1,4,0)
synchronization of the patient demographic data.
"KRN",101,1889,99)
58968,33421
"KRN",101,1889,770)
^RG ADT^^A08^^^^^^^ACK
"KRN",101,1889,771)
D INIT^RGADTP
"KRN",101,1889,773)
1^1
"KRN",101,1889,774)
D ROUTE^RGADTP
"KRN",101,1891,-1)
0^1
"KRN",101,1891,0)
RG ADT-A04 TRIGGER^MPI/PD ADT-A04 Trigger Protocol^^S^^^^^^^^CLINICAL INFO RESOURCE NETWORK
"KRN",101,1891,1,0)
^^3^3^3020719^^
"KRN",101,1891,1,1,0)
This protocol is used as an internal process of the A04 messages.  The 
"KRN",101,1891,1,2,0)
protocol will read in the message and reformat to the HL7 v2.4 standard 
"KRN",101,1891,1,3,0)
with Application and Commit acknowledgements turned on.
"KRN",101,1891,99)
58968,33404
"KRN",101,1891,770)
^RG ADT^^A04^^^^^^^ACK
"KRN",101,1891,771)
Q
"KRN",101,1891,773)
1^1
"KRN",101,1891,774)
D PROC^RGADTP
"KRN",771,51,-1)
0^1
"KRN",771,51,0)
RG ADT^a^^^^^US
"MBREQ")
0
"ORD",14,771)
771;14;;;HLAP^XPDTA1;HLAPF1^XPDIA1;HLAPE1^XPDIA1;HLAPF2^XPDIA1;;
"ORD",14,771,0)
HL7 APPLICATION PARAMETER
"ORD",15,101)
101;15;;;PRO^XPDTA;PROF1^XPDIA;PROE1^XPDIA;PROF2^XPDIA;;PRODEL^XPDIA
"ORD",15,101,0)
PROTOCOL
"PKG",272,-1)
1^1
"PKG",272,0)
CLINICAL INFO RESOURCE NETWORK^RG^CIRN
"PKG",272,20,0)
^9.402P^^0
"PKG",272,22,0)
^9.49I^1^1
"PKG",272,22,1,0)
1.0^2990430^2990601^12555
"PKG",272,22,1,"PAH",1,0)
26^3020924
"PKG",272,22,1,"PAH",1,1,0)
^^3^3^3020924
"PKG",272,22,1,"PAH",1,1,1,0)
NEW MESSSAGE STRUCTURE - PHASE 1
"PKG",272,22,1,"PAH",1,1,2,0)
Refer to patch RG*1*26 in the FORUM Patch Module for a complete
"PKG",272,22,1,"PAH",1,1,3,0)
description.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
5
"RTN","RGADTP")
0^3^B93476080
"RTN","RGADTP",1,0)
RGADTP ;BIR/DLR-ADT PROCESSOR TO RETRIGGER A08 or A04 MESSAGES WITH AL/AL (COMMIT/APPLICATION) ACKNOWLEDGEMENTS ;5/28/02
"RTN","RGADTP",2,0)
 ;;1.0;CLINICAL INFO RESOURCE NETWORK;**26**;30 Apr 99
"RTN","RGADTP",3,0)
 ;
"RTN","RGADTP",4,0)
 ;Reference to ^ORD(101 supported by IA #872
"RTN","RGADTP",5,0)
 ;Reference to $$ADD^VAFCEHU1 supported by IA #2753
"RTN","RGADTP",6,0)
 ;Reference to EDIT^VAFCPTED supported by IA #2784
"RTN","RGADTP",7,0)
 ;Reference to $$SEND2^VAFCUTL1 supported by IA #2779
"RTN","RGADTP",8,0)
 ;Reference to BLDEVN^VAFCQRY and BLDPID^VAFCQRY supported by IA #3630
"RTN","RGADTP",9,0)
 ;
"RTN","RGADTP",10,0)
INIT ;
"RTN","RGADTP",11,0)
 N RGER,RGSITE,ARRAY,MSH,RGLOCAL,RGEVNT,REP,DIC,DR,DIE,DA,DLAYGO
"RTN","RGADTP",12,0)
 S RGER=""
"RTN","RGADTP",13,0)
 D IN
"RTN","RGADTP",14,0)
 D PROCIN
"RTN","RGADTP",15,0)
 D GENACK
"RTN","RGADTP",16,0)
 Q
"RTN","RGADTP",17,0)
PROC ;processing entry point
"RTN","RGADTP",18,0)
 N HLA,RGADT,PV1,DIC,ARRAY,RGEVNT,RGLOCAL,REP,ICN
"RTN","RGADTP",19,0)
 S RGEVNT=HL("ETN")
"RTN","RGADTP",20,0)
 I $G(HL("MID"))'="" S RGADT=HL("MID")
"RTN","RGADTP",21,0)
 I $G(HL("MID"))="" S RGADT=999
"RTN","RGADTP",22,0)
 D IN
"RTN","RGADTP",23,0)
 S ICN=$$GETICN^MPIF001(DFN)
"RTN","RGADTP",24,0)
 I +$G(ICN)'<1&'$$IFLOCAL^MPIF001(DFN) S ZTSAVE("DFN")="",ZTSAVE("RGEVNT")="",ZTSAVE("HLA(""HLS"",")="",ZTRTN="SEND^RGADTPC",ZTDESC="Sending HL7 Patient Update...",ZTIO="RG QUEUE",ZTDTH=$H D ^%ZTLOAD
"RTN","RGADTP",25,0)
 K ZTSAVE,ZTRTN,ZTDESC,ZTIO,ZTDTH
"RTN","RGADTP",26,0)
 Q
"RTN","RGADTP",27,0)
IN ;Process in the ADT A04/A08 (routing logic)
"RTN","RGADTP",28,0)
 N RGI,MSG,RG,SG,DFN,EVN,SITE,RGC,RGJ,DIC,PV1,PID
"RTN","RGADTP",29,0)
 ;set local flag to indicate the processing of an outbound for reformating
"RTN","RGADTP",30,0)
 S REP=$E(HL("ECH"),2)
"RTN","RGADTP",31,0)
 I +$G(HL("SAF"))=$P($$SITE^VASITE,"^",3) S RGLOCAL=1
"RTN","RGADTP",32,0)
 I +$G(HL("SAF"))'=$P($$SITE^VASITE,"^",3) S RGLOCAL=0
"RTN","RGADTP",33,0)
 S RGC=$E($G(HL("ECH")),1)
"RTN","RGADTP",34,0)
 F RGI=1:1 X HLNEXT Q:HLQUIT'>0  S MSG=HLNODE,SG=$E(HLNODE,1,3) D
"RTN","RGADTP",35,0)
 . S RGJ=0 F  S RGJ=$O(HLNODE(RGJ)) Q:'RGJ  S MSG(RGJ)=HLNODE(RGJ)
"RTN","RGADTP",36,0)
 . D:SG?2A1(1A,1N) PICK
"RTN","RGADTP",37,0)
 ;if message MSH sending facility matches the PID assigning authority update
"RTN","RGADTP",38,0)
QUIT Q
"RTN","RGADTP",39,0)
ROUTE ;
"RTN","RGADTP",40,0)
 N RGERR
"RTN","RGADTP",41,0)
 I $G(RGEVNT)="" S RGEVNT=$G(HL("ETN"))
"RTN","RGADTP",42,0)
 N MPI S MPI=$$MPILINK^MPIFAPI() D
"RTN","RGADTP",43,0)
 . I $P($G(MPI),U)'=-1 S HLL("LINKS",1)="RG ADT-"_HL("ETN")_" 2.4 CLIENT^"_MPI
"RTN","RGADTP",44,0)
 . I $P($G(MPI),U)=-1 D
"RTN","RGADTP",45,0)
 .. N RGLOG,RGMTXT
"RTN","RGADTP",46,0)
 .. D START^RGHLLOG(HLMTIEN,"","")
"RTN","RGADTP",47,0)
 .. S RGMTXT="for DFN#"_$G(DFN)
"RTN","RGADTP",48,0)
 .. D EXC^RGHLLOG(224,"No MPI link identified"_RGMTXT,$G(DFN)) S RGERR=1
"RTN","RGADTP",49,0)
 I $G(RGERR)'=1 S ^XTMP("RG"_RGEVNT_"%"_DFN,0)=$$FMADD^XLFDT(DT,5)_"^"_DT_"^"_"RG"_RGEVNT_" msg to MPI for DFN "_DFN S ^XTMP("RG"_RGEVNT_"%"_DFN,"MPI",0)="A"
"RTN","RGADTP",50,0)
 Q
"RTN","RGADTP",51,0)
RESP ;
"RTN","RGADTP",52,0)
 N RGER,RGSITE,ARRAY,MSH,RGLOCAL,RGEVNT
"RTN","RGADTP",53,0)
 N RGI,MSG,RG,SG,DFN,EVN,SITE,RGC,RGJ,DIC,PV1,PID
"RTN","RGADTP",54,0)
 D IN
"RTN","RGADTP",55,0)
 Q
"RTN","RGADTP",56,0)
PICK ;check routine for segment entry point
"RTN","RGADTP",57,0)
 I $T(@SG)]"" D @SG
"RTN","RGADTP",58,0)
 I $T(@SG)="" Q
"RTN","RGADTP",59,0)
 Q
"RTN","RGADTP",60,0)
MSA ;;
"RTN","RGADTP",61,0)
 ;process the MSA segment
"RTN","RGADTP",62,0)
 N ARRAY,CNT,DFN,EXIT,HLCOMP,RGAA,RGERR,RGEVNT,RGMSG,RETURN,RGX,RGY
"RTN","RGADTP",63,0)
 I RGLOCAL S HLA("HLS",RGI)=MSG
"RTN","RGADTP",64,0)
 S RGAA=MSG
"RTN","RGADTP",65,0)
 S EXIT=0
"RTN","RGADTP",66,0)
 S RGMSG=$P(RGAA,HL("FS"),3)
"RTN","RGADTP",67,0)
 S RGERR=$P(RGAA,HL("FS"),4)
"RTN","RGADTP",68,0)
 S RGMSG=$$MSG^HLCSUTL(RGMSG,"RETURN(1)")
"RTN","RGADTP",69,0)
 K RGMSG
"RTN","RGADTP",70,0)
 S CNT=1,RGX=0 F  S RGX=$O(RETURN(1,RGX)) Q:'RGX!(EXIT=1)  D
"RTN","RGADTP",71,0)
 . I RETURN(1,RGX)'="" D
"RTN","RGADTP",72,0)
 .. I $D(RGMSG) S RGMSG(CNT)=RETURN(1,RGX),CNT=CNT+1
"RTN","RGADTP",73,0)
 .. I '$D(RGMSG) S RGMSG=RETURN(1,RGX),RGY=RGX
"RTN","RGADTP",74,0)
 . I RETURN(1,RGX)="" D  S CNT=1 K RGMSG
"RTN","RGADTP",75,0)
 .. I $E(RETURN(1,RGY),1,3)="MSH" D MSH
"RTN","RGADTP",76,0)
 .. I $E(RETURN(1,RGY),1,3)="PID" D PIDP^RGADTP1(.RGMSG,.ARRAY,.HL) S EXIT=1
"RTN","RGADTP",77,0)
 S DFN=$G(ARRAY("DFN"))
"RTN","RGADTP",78,0)
 I $D(^XTMP("RG"_RGEVNT_"%"_DFN,0)) K ^XTMP("RG"_RGEVNT_"%"_DFN)
"RTN","RGADTP",79,0)
 Q
"RTN","RGADTP",80,0)
MSH ;;
"RTN","RGADTP",81,0)
 S MSH=1
"RTN","RGADTP",82,0)
 I RGLOCAL S HLA("HLS",RGI)=MSG
"RTN","RGADTP",83,0)
 I 'RGLOCAL S RGC=$E(HL("ECH"),1)
"RTN","RGADTP",84,0)
 S RGSITE=$P($P(MSG,HL("FS"),4),RGC)
"RTN","RGADTP",85,0)
 S RGEVNT=$P($P(MSG,HL("FS"),9),RGC,2)
"RTN","RGADTP",86,0)
 Q
"RTN","RGADTP",87,0)
EVN ;;
"RTN","RGADTP",88,0)
 N CNT,ERR
"RTN","RGADTP",89,0)
 S EVN=RGI
"RTN","RGADTP",90,0)
 I RGLOCAL S (EVN(1),HLA("HLS",RGI))=MSG
"RTN","RGADTP",91,0)
 I 'RGLOCAL D
"RTN","RGADTP",92,0)
 .S ARRAY("EVR")=$P(MSG,HL("FS"),2)
"RTN","RGADTP",93,0)
 .S ARRAY("DLT")=$$FMDATE^HLFNC($P(MSG,HL("FS"),3))
"RTN","RGADTP",94,0)
 .S ARRAY("EVNAME")=$$FMNAME^XLFNAME($P(MSG,HL("FS"),2),"",$E(HL("ECH"),1))
"RTN","RGADTP",95,0)
 .S ARRAY("SENDING SITE")=$P(MSG,HL("FS"),8)
"RTN","RGADTP",96,0)
 Q
"RTN","RGADTP",97,0)
EVNP ;
"RTN","RGADTP",98,0)
 N EVNX
"RTN","RGADTP",99,0)
 I $G(DFN)'="" D BLDEVN^VAFCQRY(DFN,"1,2,4,5,6,7",.EVN,.HL,$G(HL("ETN")),.ERR) S CNT=0,EVNX=0 F  S EVNX=$O(EVN(EVNX)) Q:'EVNX  D
"RTN","RGADTP",100,0)
 . I CNT>0 S HLA("HLS",EVN,CNT)=EVN(EVNX),CNT=CNT+1
"RTN","RGADTP",101,0)
 . I CNT'>0 S HLA("HLS",EVN)=EVN(EVNX),CNT=CNT+1
"RTN","RGADTP",102,0)
 Q
"RTN","RGADTP",103,0)
PID ;;
"RTN","RGADTP",104,0)
 N CNT,PIDX
"RTN","RGADTP",105,0)
 I RGLOCAL D
"RTN","RGADTP",106,0)
 .S HLA("HLS",RGI)=MSG
"RTN","RGADTP",107,0)
 .S DFN=+$P(MSG,HL("FS"),4)
"RTN","RGADTP",108,0)
 .D EVNP
"RTN","RGADTP",109,0)
 .D BLDPID^VAFCQRY(DFN,1,"1,3,5,6,7,8,11,29",.PID,.HL)
"RTN","RGADTP",110,0)
 .S CNT=0,PIDX=0 F  S PIDX=$O(PID(PIDX)) Q:'PIDX  D
"RTN","RGADTP",111,0)
 .. I CNT>0 S HLA("HLS",RGI,CNT)=PID(PIDX),CNT=CNT+1
"RTN","RGADTP",112,0)
 .. I CNT'>0 S HLA("HLS",RGI)=PID(PIDX),CNT=CNT+1
"RTN","RGADTP",113,0)
 I 'RGLOCAL D PIDP^RGADTP1(.MSG,.ARRAY,.HL) S ARRAY(.351)=ARRAY("MPIDOD")
"RTN","RGADTP",114,0)
 Q
"RTN","RGADTP",115,0)
PD1 ;;
"RTN","RGADTP",116,0)
 I RGLOCAL S HLA("HLS",RGI)=MSG
"RTN","RGADTP",117,0)
 I 'RGLOCAL S (ARRAY(991.03),ARRAY("CMOR"))=$P($P(MSG,HL("FS"),4),RGC)
"RTN","RGADTP",118,0)
 Q
"RTN","RGADTP",119,0)
PV1 ;;
"RTN","RGADTP",120,0)
 I RGLOCAL S HLA("HLS",RGI)=MSG
"RTN","RGADTP",121,0)
 Q
"RTN","RGADTP",122,0)
OBX ;;
"RTN","RGADTP",123,0)
 N COMP S COMP=$E(HL("ECH"),1)
"RTN","RGADTP",124,0)
 I RGLOCAL S HLA("HLS",RGI)=MSG
"RTN","RGADTP",125,0)
 I 'RGLOCAL D:$$FREE^RGRSPARS($P($P(MSG,HL("FS"),4),RGC,2))="SECURITY LEVEL"
"RTN","RGADTP",126,0)
 . S ARRAY("SENSITIVITY")=$$SENSTIVE^RGRSPARS($P(MSG,HL("FS"),6),COMP)
"RTN","RGADTP",127,0)
 . S ARRAY("SENSITIVITY USER")=$$FREE^RGRSPARS($P($P(MSG,HL("FS"),17),RGC,3))_","_$$FREE^RGRSPARS($P($P(MSG,HL("FS"),17),RGC,2))
"RTN","RGADTP",128,0)
 . S ARRAY("SENSITIVITY DATE")=$$FREE^RGRSPARS($$FMDATE^HLFNC($P(MSG,HL("FS"),15)))
"RTN","RGADTP",129,0)
 Q
"RTN","RGADTP",130,0)
ZPD ;;
"RTN","RGADTP",131,0)
 I RGLOCAL S HLA("HLS",RGI)=MSG
"RTN","RGADTP",132,0)
 ;I 'RGLOCAL S ARRAY(.351)=$$FREE^RGRSPARS($P(MSG,HL("FS"),5))
"RTN","RGADTP",133,0)
 Q
"RTN","RGADTP",134,0)
ZSP ;;
"RTN","RGADTP",135,0)
 I RGLOCAL S HLA("HLS",RGI)=MSG
"RTN","RGADTP",136,0)
 I 'RGLOCAL D
"RTN","RGADTP",137,0)
 . S ARRAY(.301)=$$YESNO^RGRSPARS($P(MSG,HL("FS"),3))
"RTN","RGADTP",138,0)
 . S ARRAY(.302)=$$FREE^RGRSPARS($P(MSG,HL("FS"),4))
"RTN","RGADTP",139,0)
 . S ARRAY(.323)=$$POS^RGRSPARS($P(MSG,HL("FS"),5))
"RTN","RGADTP",140,0)
 Q
"RTN","RGADTP",141,0)
ZEL ;;
"RTN","RGADTP",142,0)
 I RGLOCAL S HLA("HLS",RGI)=MSG
"RTN","RGADTP",143,0)
 I 'RGLOCAL D
"RTN","RGADTP",144,0)
 . S ARRAY(.361)=$$ELIG^RGRSPARS($P(MSG,HL("FS"),3))
"RTN","RGADTP",145,0)
 . S ARRAY(.3612)=$$FREE^RGRSPARS($P(MSG,HL("FS"),12))
"RTN","RGADTP",146,0)
 . S ARRAY(.3615)=$$FREE^RGRSPARS($P(MSG,HL("FS"),14))
"RTN","RGADTP",147,0)
 . S ARRAY(391)=$$TYPE^RGRSPARS($P(MSG,HL("FS"),10))
"RTN","RGADTP",148,0)
 . S ARRAY(1901)=$$VETERAN^RGRSPARS($P(MSG,HL("FS"),9))
"RTN","RGADTP",149,0)
 Q
"RTN","RGADTP",150,0)
ZCT ;;
"RTN","RGADTP",151,0)
 I RGLOCAL S HLA("HLS",RGI)=MSG
"RTN","RGADTP",152,0)
 I 'RGLOCAL D
"RTN","RGADTP",153,0)
 . S ARRAY(.211)=$$FREE^RGRSPARS($P(MSG,HL("FS"),4))
"RTN","RGADTP",154,0)
 . S ARRAY(.219)=$$FREE^RGRSPARS($P(MSG,HL("FS"),7))
"RTN","RGADTP",155,0)
 Q
"RTN","RGADTP",156,0)
ZEM ;;
"RTN","RGADTP",157,0)
 I RGLOCAL S HLA("HLS",RGI)=MSG
"RTN","RGADTP",158,0)
 I 'RGLOCAL D
"RTN","RGADTP",159,0)
 . S ARRAY(.3115)=$$EMP^RGRSPARS($P(MSG,HL("FS"),4))
"RTN","RGADTP",160,0)
 Q
"RTN","RGADTP",161,0)
ZFF ;;
"RTN","RGADTP",162,0)
 I RGLOCAL S HLA("HLS",RGI)=MSG
"RTN","RGADTP",163,0)
 I 'RGLOCAL S ARRAY("FLD")=$P(MSG,HL("FS"),3)
"RTN","RGADTP",164,0)
 Q
"RTN","RGADTP",165,0)
PROCIN ;
"RTN","RGADTP",166,0)
 N RGRSDFN,OTHSITE,NODE,ICN,CMORIEN,CMOR,CMORDISP,SENSTVTY,RMTDOD,LOCDOD,VAFCA,VAFCA08,HERE,BOGUS,ARAY
"RTN","RGADTP",167,0)
 S HERE=$P($$SITE^VASITE,"^",3)
"RTN","RGADTP",168,0)
 ;if sending site is your site quit
"RTN","RGADTP",169,0)
 Q:$G(ARRAY("MPISSITE"))=$G(HERE)
"RTN","RGADTP",170,0)
 S ARRAY(.097)=$P($$NOW^XLFDT,".")
"RTN","RGADTP",171,0)
 I $G(ARRAY("ICN"))'="" D
"RTN","RGADTP",172,0)
 . S RGRSDFN=$$GETDFN^MPIF001(ARRAY("ICN")) I +RGRSDFN<1  ;quit and return error msg
"RTN","RGADTP",173,0)
 . S OTHSITE=+ARRAY("MPISSITE")
"RTN","RGADTP",174,0)
 I $G(RGRSDFN)="" S RGRSDFN=$G(DFN)
"RTN","RGADTP",175,0)
 I $G(OTHSITE)="" S OTHSITE=""
"RTN","RGADTP",176,0)
 I +$$SEND2^VAFCUTL1(RGRSDFN,"T")  ;quit and return error msg
"RTN","RGADTP",177,0)
 S NODE=$$MPINODE^MPIFAPI(RGRSDFN)
"RTN","RGADTP",178,0)
 S ICN=$P(NODE,"^")
"RTN","RGADTP",179,0)
 S CMORIEN=$P(NODE,"^",3)
"RTN","RGADTP",180,0)
 S CMOR=$$NS^XUAF4(CMORIEN)
"RTN","RGADTP",181,0)
 S CMORDISP=$P(CMOR,"^",1)
"RTN","RGADTP",182,0)
 S CMOR=$P(CMOR,"^",2)
"RTN","RGADTP",183,0)
 ;
"RTN","RGADTP",184,0)
 ;If patient is Sensitive at other site but not here send bulletin
"RTN","RGADTP",185,0)
 I $G(ARRAY("SENSITIVITY"))'="" S SENSTVTY=$G(ARRAY("SENSITIVITY")) D
"RTN","RGADTP",186,0)
 . N NAME S NAME=ARRAY("NAME")
"RTN","RGADTP",187,0)
 . I '$$SENSTIVE^RGRSENS(RGRSDFN),SENSTVTY D
"RTN","RGADTP",188,0)
 .. S ARAY("SSN")=ARRAY("SSN")
"RTN","RGADTP",189,0)
 .. S ARAY("SENDING SITE")=ARRAY("SENDING SITE")
"RTN","RGADTP",190,0)
 .. S ARAY("SENSITIVITY USER")=ARRAY("SENSITIVITY USER")
"RTN","RGADTP",191,0)
 .. S ARAY("SENSITIVITY DATE")=ARRAY("SENSITIVITY DATE")
"RTN","RGADTP",192,0)
 .. D SENSTIVE^RGRSBUL1(RGRSDFN,"ARAY",NAME)
"RTN","RGADTP",193,0)
 ;
"RTN","RGADTP",194,0)
 ;If patient has DATE OF DEATH (DOD) at remote site send bulletin
"RTN","RGADTP",195,0)
 ;Ignore time if present with date.
"RTN","RGADTP",196,0)
 S RMTDOD=$G(ARRAY("DOD")),RMTDOD=$P(RMTDOD,".")
"RTN","RGADTP",197,0)
 S DFN=RGRSDFN D DEM^VADPT
"RTN","RGADTP",198,0)
 S LOCDOD=$P($P(VADM(6),"^"),".")
"RTN","RGADTP",199,0)
 ;If there is a remote DOD but no local DOD  OR
"RTN","RGADTP",200,0)
 ;if remote DOD is different from local DOD, send bulletin
"RTN","RGADTP",201,0)
 I RMTDOD D
"RTN","RGADTP",202,0)
 . S ARAY("SSN")=ARRAY("SSN")
"RTN","RGADTP",203,0)
 . S ARAY("SENDING SITE")=ARRAY("SENDING SITE")
"RTN","RGADTP",204,0)
 . D RMTDOD^RGRSBUL1(RGRSDFN,"ARAY",NAME,RMTDOD,LOCDOD)
"RTN","RGADTP",205,0)
 K VADM
"RTN","RGADTP",206,0)
 ;
"RTN","RGADTP",207,0)
 I 'RGLOCAL D
"RTN","RGADTP",208,0)
 . ;if sending site is not the CMOR - log update into PDR if differences exist
"RTN","RGADTP",209,0)
 . I (OTHSITE)'=(CMOR) D  Q
"RTN","RGADTP",210,0)
 .. S VAFCA=$P($$NOW^XLFDT,".")_"^"_$$NOW^XLFDT_"^"_$G(ARRAY("SENDING SITE"))_"^"_RGRSDFN
"RTN","RGADTP",211,0)
 .. S ARRAY(.01)=$$FREE^RGRSPARS(ARRAY("NAME"))
"RTN","RGADTP",212,0)
 .. S ARRAY(.03)=$$FREE^RGRSPARS($G(ARRAY("MPIDOB")))
"RTN","RGADTP",213,0)
 .. S ARRAY(.09)=$$FREE^RGRSPARS($G(ARRAY("SSN")))
"RTN","RGADTP",214,0)
 .. S ARRAY(.02)=$$SEX^RGRSPARS($G(ARRAY("SEX")))
"RTN","RGADTP",215,0)
 .. S ARRAY(.2403)=$G(ARRAY("MMN"))
"RTN","RGADTP",216,0)
 .. S ARRAY(991.01)=$P($G(ARRAY("ICN")),"V")
"RTN","RGADTP",217,0)
 .. N ARAY M ARAY(2)=ARRAY
"RTN","RGADTP",218,0)
 .. S VAFCA08=1 S BOGUS=$$ADD^VAFCEHU1(VAFCA,"ARAY")
"RTN","RGADTP",219,0)
 . ;if sending site is the CMOR - synchronize data
"RTN","RGADTP",220,0)
 . I (OTHSITE)=(CMOR) D
"RTN","RGADTP",221,0)
 .. S VAFCA08=1
"RTN","RGADTP",222,0)
 .. S (ARRAY("NAME"),ARAY(2,.01))=ARRAY("SURNAME")_","_ARRAY("FIRST")_" "_$G(ARRAY("MIDDLE"))_" "_$G(ARRAY("SUFFIX"))
"RTN","RGADTP",223,0)
 .. S ARAY(2,.03)=$G(ARRAY("DOB"))
"RTN","RGADTP",224,0)
 .. S ARAY(2,.09)=$G(ARRAY("SSN"))
"RTN","RGADTP",225,0)
 .. S ARAY(2,.02)=$G(ARRAY("SEX"))
"RTN","RGADTP",226,0)
 .. S ARAY(2,.2403)=$G(ARRAY("MMN"))
"RTN","RGADTP",227,0)
 .. D EDIT^VAFCPTED(RGRSDFN,"ARAY(2)",".01;.03;.09;.02;.2403")
"RTN","RGADTP",228,0)
 .. ;check to see if edits were successful, if not set RGER="why it failed"
"RTN","RGADTP",229,0)
 .. N NAME,SSN,PDOB,SEX,MMN
"RTN","RGADTP",230,0)
 .. S NAME=$$GET1^DIQ(2,+RGRSDFN_",",.01,"I")
"RTN","RGADTP",231,0)
 .. S PDOB=$$GET1^DIQ(2,+RGRSDFN_",",.03,"I")
"RTN","RGADTP",232,0)
 .. S SSN=$$GET1^DIQ(2,+RGRSDFN_",",.09,"I")
"RTN","RGADTP",233,0)
 .. S SEX=$$GET1^DIQ(2,+RGRSDFN_",",.02,"I")
"RTN","RGADTP",234,0)
 .. S MMN=$$GET1^DIQ(2,+RGRSDFN_",",.2403,"I")
"RTN","RGADTP",235,0)
 .. I NAME'=$G(ARRAY("NAME")) S RGER=$S($D(RGER):$G(RGER)_REP,1:"-1^238^")_"Name field failure"
"RTN","RGADTP",236,0)
 .. I PDOB'=$G(ARRAY("DOB")) S RGER=$S($D(RGER):$G(RGER)_REP,1:"-1^238^")_"DOB field failure"
"RTN","RGADTP",237,0)
 .. I SSN'=$G(ARRAY("SSN")) S RGER=$S($D(RGER):$G(RGER)_REP,1:"-1^238^")_"SSN field failure"
"RTN","RGADTP",238,0)
 .. I SEX'=$G(ARRAY("SEX")) S RGER=$S($D(RGER):$G(RGER)_REP,1:"-1^238^")_"SEX field failure"
"RTN","RGADTP",239,0)
 .. I MMN'=$G(ARRAY("MMN")) S RGER=$S($D(RGER):$G(RGER)_REP,1:"-1^238^")_"MOTHER'S MAIDEN NAME field failure"
"RTN","RGADTP",240,0)
 .. ;send the updated fields to the MPI to synch site with MPI
"RTN","RGADTP",241,0)
 .. S ZTSAVE("DFN")="",ZTRTN="MPISYN^RGADTPC",ZTDESC="Sending Synchronized Patient Data to MPI...",ZTIO="RG QUEUE",ZTDTH=$H D ^%ZTLOAD
"RTN","RGADTP",242,0)
 Q
"RTN","RGADTP",243,0)
GENACK ;
"RTN","RGADTP",244,0)
 N RGCNT,IEN,RG
"RTN","RGADTP",245,0)
 I $G(ARRAY("DFN"))'>0 S RGER="-1^Unknown ICN#"_$G(ARRAY("ICN"))_" and SSN#"_$G(ARRAY(.09))
"RTN","RGADTP",246,0)
 S RGCNT=1
"RTN","RGADTP",247,0)
 S HLA("HLA",RGCNT)="MSA"_HL("FS")_"AA"_HL("FS")_HL("MID")_HL("FS")_$S(+$G(RGER)<0:$P(RGER,"^",2,3),1:""),RGCNT=RGCNT+1
"RTN","RGADTP",248,0)
 S RGSITE=$$LKUP^XUAF4(RGSITE)
"RTN","RGADTP",249,0)
 D LINK^HLUTIL3(RGSITE,.RG) S IEN=$O(RG(0)) S HLL("LINKS",1)="^"_RG(IEN)
"RTN","RGADTP",250,0)
 D GENACK^HLMA1(HL("EID"),HLMTIENS,HL("EIDS"),"LM",1,.HLRESLTA,"",.HL)
"RTN","RGADTP",251,0)
 K HLA
"RTN","RGADTP",252,0)
 Q
"RTN","RGADTP",253,0)
RSP ;
"RTN","RGADTP",254,0)
 Q
"RTN","RGADTP1")
0^5^B28492244
"RTN","RGADTP1",1,0)
RGADTP1 ;BIR/DLR-ADT PROCESSOR TO RETRIGGER A08 or A04 MESSAGES WITH AL/AL (COMMIT/APPLICATION) ACKNOWLEDGEMENTS - CONTINUED ;6/2/02
"RTN","RGADTP1",2,0)
 ;;1.0;CLINICAL INFO RESOURCE NETWORK;**26**;30 Apr 99
"RTN","RGADTP1",3,0)
PIDP(MSG,ARRAY,HL) ;process PID segment
"RTN","RGADTP1",4,0)
 N ID,IDS,PIDAA,PIDNTC
"RTN","RGADTP1",5,0)
 ;Since PID can be over 245 characters loop through setting a PID ARRAY
"RTN","RGADTP1",6,0)
 ;sequenced PID(1)="PID"... PID(4 or 5) can be over 245 characters so
"RTN","RGADTP1",7,0)
 ;it will also loop and place it in PID(4,1...
"RTN","RGADTP1",8,0)
 ;
"RTN","RGADTP1",9,0)
 ; Input variables
"RTN","RGADTP1",10,0)
 ;   assumes that MSG or MSG(I) will contain the PID segment
"RTN","RGADTP1",11,0)
 ; Output ARRAY ARRAY will contain the following subscripts
"RTN","RGADTP1",12,0)
 ;   SSN - patient SSN
"RTN","RGADTP1",13,0)
 ;   ICN - patient ICN
"RTN","RGADTP1",14,0)
 ;   DFN - sites local identifier
"RTN","RGADTP1",15,0)
 ;   MPISSITE - authoritative source (station# of sending site)
"RTN","RGADTP1",16,0)
 ;   SEX - patient's SEX
"RTN","RGADTP1",17,0)
 ;   MPIDOB - Date of Birth
"RTN","RGADTP1",18,0)
 ;   NAME,SURNAME,FIRST,MIDDLE,PREFIX,and SUFFIX - Patient Name
"RTN","RGADTP1",19,0)
 ;   MMN - Mother's maiden name
"RTN","RGADTP1",20,0)
 ;   POBCITY, POBSTATE - Place of birth city and state
"RTN","RGADTP1",21,0)
 ;
"RTN","RGADTP1",22,0)
 N PID,MPIJ,LNGTH,LNGTH1,PID1,SEQ,SEQ1,COMP,SUBCOMP,REP,HLECH,X,Y,CNT,NXT,ID,IDS,PIDAA,PIDNTC,NAME,LNGTH2,PIDSITE,PIDXDT,HLECH,HLFS
"RTN","RGADTP1",23,0)
 S HLFS=HL("FS"),HLECH=HL("ECH")
"RTN","RGADTP1",24,0)
 S ARRAY("DFN")="",ARRAY("ICN")="",ARRAY("CLAIMN")="",ARRAY("SSN")=""
"RTN","RGADTP1",25,0)
 S COMP=$E(HL("ECH"),1),SUBCOMP=$E(HL("ECH"),4),REP=$E(HL("ECH"),2)
"RTN","RGADTP1",26,0)
 S LNGTH=$L(MSG,HL("FS")) F SEQ=1:1:LNGTH S PID(SEQ)=$P(MSG,HL("FS"),SEQ)
"RTN","RGADTP1",27,0)
 S SEQ1=1,X=0 F  S X=$O(MSG(X)) Q:'X  S LNGTH=$L(MSG(X),HL("FS")) D
"RTN","RGADTP1",28,0)
 . F Y=1:1:LNGTH S:Y'=1 SEQ=SEQ+1 D
"RTN","RGADTP1",29,0)
 .. S NXT=$P(MSG(X),HL("FS"),Y) D
"RTN","RGADTP1",30,0)
 ... I $L($G(PID(SEQ)))=245 D  Q
"RTN","RGADTP1",31,0)
 .... I $L(NXT_$G(PID(SEQ,SEQ1)))>245 S LNGTH1=$L(PID(SEQ,SEQ1)) S LNGTH2=245-LNGTH1,PID(SEQ,SEQ1)=$G(PID(SEQ,SEQ1))_$E(NXT,1,LNGTH2),LNGTH2=LNGTH2+1,NXT=$E(NXT,LNGTH2,$L(NXT)),SEQ1=SEQ1+1
"RTN","RGADTP1",32,0)
 .... I $L(NXT_$G(PID(SEQ,SEQ1)))'>245 S PID(SEQ,SEQ1)=$G(PID(SEQ,SEQ1))_NXT
"RTN","RGADTP1",33,0)
 ... I $L(NXT_$G(PID(SEQ)))>245 S LNGTH1=$L($G(PID(SEQ))) S LNGTH2=245-LNGTH1,PID(SEQ)=$G(PID(SEQ))_$E(NXT,1,LNGTH2),LNGTH2=LNGTH2+1,NXT=$E(NXT,LNGTH2,$L(NXT)) S PID(SEQ,SEQ1)=NXT
"RTN","RGADTP1",34,0)
 ... I $L(NXT_$G(PID(SEQ)))'>245 S PID(SEQ)=$G(PID(SEQ))_NXT Q
"RTN","RGADTP1",35,0)
 ;get PID-3 Patient Identifier List (three ids should be returned ICN, SSN, and DFN)
"RTN","RGADTP1",36,0)
 N LASTID,IDCNT,CNT
"RTN","RGADTP1",37,0)
 S IDS=PID(4)
"RTN","RGADTP1",38,0)
 S LASTID=$L(IDS,REP),IDCNT=1,IDS=PID(4),CNT=1
"RTN","RGADTP1",39,0)
 F X=1:1:LASTID S ID=$P(IDS,REP,X) D
"RTN","RGADTP1",40,0)
 .;if this is the last entry check for an extension of the message and reset the key variables
"RTN","RGADTP1",41,0)
 .I X=LASTID I $D(PID(4,IDCNT)) S ID=ID_$P(PID(4,IDCNT),REP),IDS=$P(PID(4,IDCNT),REP,2,99),IDCNT=IDCNT+1,X=0,LASTID=$L(IDS,REP)
"RTN","RGADTP1",42,0)
 . ;get id, assigning authority, and name type code
"RTN","RGADTP1",43,0)
 . S PIDAA=$P($P(ID,COMP,4),SUBCOMP),PIDNTC=$P(ID,COMP,5),PIDSITE=$P($P(ID,COMP,6),SUBCOMP,2),PIDXDT=$P(ID,COMP,8)
"RTN","RGADTP1",44,0)
 . S ID=$P(ID,COMP)
"RTN","RGADTP1",45,0)
 . Q:ID=""
"RTN","RGADTP1",46,0)
 . ;check assigning authority(0363) AND name type code(0203)
"RTN","RGADTP1",47,0)
 . I PIDAA="USVHA" D
"RTN","RGADTP1",48,0)
 .. I PIDNTC="NI" D
"RTN","RGADTP1",49,0)
 ... I $G(PIDXDT)="" S ARRAY("ICN")=+ID,ARRAY("MPISSITE")=PIDSITE,ARRAY(991.02)=$P(ID,"V",2)  ;National unique individual identifier
"RTN","RGADTP1",50,0)
 ... I $G(PIDXDT)'="" S ARRAY("OID",CNT)=ID_"^"_PIDAA_"^"_PIDSITE_"^"_PIDXDT,CNT=CNT+1  ;Deprecated National unique individual identifier
"RTN","RGADTP1",51,0)
 .. I PIDNTC="PI" S ARRAY("DFN")=ID  ;Patient internal identifier
"RTN","RGADTP1",52,0)
 . I PIDAA="USSSA" D
"RTN","RGADTP1",53,0)
 .. I PIDNTC="SS" S ARRAY("SSN")=ID  ;Social Security number
"RTN","RGADTP1",54,0)
 . I PIDAA="USVBA" D
"RTN","RGADTP1",55,0)
 .. I PIDNTC="PN" S ARRAY("CLAIMN")=ID  ;VBA CLAIM#
"RTN","RGADTP1",56,0)
 ;get PID-4 alternate ID (ICN History)
"RTN","RGADTP1",57,0)
 I $G(PID(5))'="" D
"RTN","RGADTP1",58,0)
 . S CNT=1
"RTN","RGADTP1",59,0)
 . F X=1:1:$L(PID(5),REP) S ARRAY("OID",CNT)=$P(PID(5),REP,X),CNT=CNT+1
"RTN","RGADTP1",60,0)
 . S Y=0 F  S Y=$O(PID(5,Y)) Q:'Y  D
"RTN","RGADTP1",61,0)
 .. S ARRAY("OID",CNT-1)=ARRAY("OID",CNT-1)_$P(PID(5,Y),REP)
"RTN","RGADTP1",62,0)
 .. F X=2:1:$L(PID(5,Y),REP) S ARRAY("OID",CNT)=$P(PID(5,Y),REP,X),CNT=CNT+1
"RTN","RGADTP1",63,0)
 . S X=0 F  S X=$O(ARRAY("OID",X)) Q:'X  D
"RTN","RGADTP1",64,0)
 .. N ID,AA,AL S ID=$P(ARRAY("OID",X),COMP),AA=$P($P(ARRAY("OID",X),COMP,4),SUBCOMP,1),AL=$P($P(ARRAY("OID",X),COMP,6),SUBCOMP,2) S AL=$$IEN^XUAF4(AL)
"RTN","RGADTP1",65,0)
 .. S ARRAY("OID",X)=ID_"^"_AA_"^"_AL
"RTN","RGADTP1",66,0)
 ;get PID-5 Patient Name
"RTN","RGADTP1",67,0)
 I $G(PID(6))'="" S NAME=PID(6),ARRAY("SURNAME")=$P(NAME,COMP),ARRAY("FIRST")=$P(NAME,COMP,2),ARRAY("MIDDLE")=$P(NAME,COMP,3),ARRAY("PREFIX")=$P(NAME,COMP,4),ARRAY("SUFFIX")=$P(NAME,COMP,5) D
"RTN","RGADTP1",68,0)
 . S ARRAY("NAME")=$$FMNAME^HLFNC($P(PID(6),COMP,1,6))
"RTN","RGADTP1",69,0)
 ;get PID-6 Mother's maiden name
"RTN","RGADTP1",70,0)
 I $G(PID(7))'="" S ARRAY("MMN")=$G(PID(7)) I ARRAY("MMN")'="" S ARRAY("MMN")=$P(ARRAY("MMN"),COMP,1,5) S HLECH=HL("ECH") S ARRAY("MMN")=$$FMNAME^HLFNC(ARRAY("MMN"))
"RTN","RGADTP1",71,0)
 ;get PID-7 Date of Birth
"RTN","RGADTP1",72,0)
 S ARRAY("MPIDOB")=$$FMDATE^HLFNC($G(PID(8)))
"RTN","RGADTP1",73,0)
 ;get PID-8 Sex
"RTN","RGADTP1",74,0)
 S ARRAY("SEX")=$G(PID(9))
"RTN","RGADTP1",75,0)
 ;get PID-11-3 ADDRESS BOTH "P"rimary and "N" Place of
"RTN","RGADTP1",76,0)
 S CNT=1
"RTN","RGADTP1",77,0)
 N ADRTYPE,ADDR
"RTN","RGADTP1",78,0)
 F X=1:1:$L(PID(12),REP) D
"RTN","RGADTP1",79,0)
 . S ADDR=$P(PID(12),REP,X),ADRTYPE=$P(ADDR,COMP,7)
"RTN","RGADTP1",80,0)
 . I ADRTYPE="P" D
"RTN","RGADTP1",81,0)
 .. S ADDR=$$FREE^RGRSPARS(ADDR)
"RTN","RGADTP1",82,0)
 .. S ARRAY(.111)=$$FREE^RGRSPARS($P(ADDR,COMP,1))  ;addr [1]
"RTN","RGADTP1",83,0)
 .. S ARRAY(.112)=$$FREE^RGRSPARS($P(ADDR,COMP,2))  ;addr [2]
"RTN","RGADTP1",84,0)
 .. I ARRAY(.112)="" S ARRAY(.112)="@"
"RTN","RGADTP1",85,0)
 .. S ARRAY(.113)=$$FREE^RGRSPARS($P(ADDR,COMP,8))  ;addr [3]
"RTN","RGADTP1",86,0)
 .. I ARRAY(.113)="" S ARRAY(.113)="@"
"RTN","RGADTP1",87,0)
 .. S ARRAY(.114)=$$FREE^RGRSPARS($P(ADDR,COMP,3))  ;city
"RTN","RGADTP1",88,0)
 .. S ARRAY(.115)=$$STATE^RGRSPARS($P(ADDR,COMP,4))  ;state
"RTN","RGADTP1",89,0)
 .. S ARRAY(.1112)=$$FREE^RGRSPARS($P(ADDR,COMP,5))  ;zip+4
"RTN","RGADTP1",90,0)
 .. N CNTYCODE S CNTYCODE=PID(13)  ;county code
"RTN","RGADTP1",91,0)
 .. S ARRAY(.117)=$$COUNTY^RGRSPARS(ARRAY(.115),CNTYCODE)
"RTN","RGADTP1",92,0)
 .. S ARRAY(.131)=$$FREE^RGRSPARS(PID(14))
"RTN","RGADTP1",93,0)
 .. S ARRAY(.132)=$$FREE^RGRSPARS(PID(15))
"RTN","RGADTP1",94,0)
 .. I ARRAY(.132)="" S ARRAY(.132)="@"
"RTN","RGADTP1",95,0)
 . I ADRTYPE="N" D
"RTN","RGADTP1",96,0)
 .. S ARRAY("POBCITY")=$$FREE^RGRSPARS($P(ADDR,COMP,3))  ;POB city
"RTN","RGADTP1",97,0)
 .. S ARRAY("POBSTATE")=$$STATE^RGRSPARS($P(ADDR,COMP,4))  ;POB state
"RTN","RGADTP1",98,0)
 ;marital status
"RTN","RGADTP1",99,0)
 S ARRAY(.05)=$$MARITAL^RGRSPARS(PID(17))
"RTN","RGADTP1",100,0)
 ;religious preference
"RTN","RGADTP1",101,0)
 S ARRAY(.08)=$$RELIG^RGRSPARS(PID(18))
"RTN","RGADTP1",102,0)
 ;address
"RTN","RGADTP1",103,0)
 ;get PID-29 Date of Death
"RTN","RGADTP1",104,0)
 S ARRAY("MPIDOD")=$$FMDATE^HLFNC($G(PID(30))),ARRAY(.351)=ARRAY("MPIDOD")
"RTN","RGADTP1",105,0)
 Q
"RTN","RGADTPC")
0^8^B582302
"RTN","RGADTPC",1,0)
RGADTPC ;BIR/DLR-Continuation of RGADTP routine ;9/19/02
"RTN","RGADTPC",2,0)
 ;;1.0;CLINICAL INFO RESOURCE NETWORK;**26**;30 Apr 99
"RTN","RGADTPC",3,0)
 ;
"RTN","RGADTPC",4,0)
 ;Reference to $$A31^MPIFA31B supported by IA #3765
"RTN","RGADTPC",5,0)
 ;Reference to ^ORD(101 supported by IA #872
"RTN","RGADTPC",6,0)
 ;
"RTN","RGADTPC",7,0)
MPISYN ;
"RTN","RGADTPC",8,0)
 S:$D(ZTQUEUED) ZTREQ="@"
"RTN","RGADTPC",9,0)
 S ERR=$$A31^MPIFA31B(DFN)
"RTN","RGADTPC",10,0)
 K DFN,ERR
"RTN","RGADTPC",11,0)
 Q
"RTN","RGADTPC",12,0)
SEND ;
"RTN","RGADTPC",13,0)
 S:$D(ZTQUEUED) ZTREQ="@"
"RTN","RGADTPC",14,0)
 N EID
"RTN","RGADTPC",15,0)
 S EID=$O(^ORD(101,"B","RG ADT-"_RGEVNT_" 2.4 SERVER",0))
"RTN","RGADTPC",16,0)
 N HL,INT,HLP,HLRESLT,ARRAY
"RTN","RGADTPC",17,0)
 S HL="HL",INT=0
"RTN","RGADTPC",18,0)
 D INIT^HLFNC2(EID,.HL,INT)
"RTN","RGADTPC",19,0)
 D GENERATE^HLMA(EID,"LM",1,.HLRESLT,"",.HLP)
"RTN","RGADTPC",20,0)
 K DFN,HLA,RGEVNT
"RTN","RGADTPC",21,0)
 Q
"RTN","RGP26PST")
0^4^B997157
"RTN","RGP26PST",1,0)
RGP26PST ;BIR/PTD-RG*1*26 PATCH POST INSTALL ROUTINE ;7/22/02
"RTN","RGP26PST",2,0)
 ;;1.0;CLINICAL INFO RESOURCE NETWORK;**26**;30 Apr 99
"RTN","RGP26PST",3,0)
 ;
"RTN","RGP26PST",4,0)
 ;Reference to DEVICE (#3.5) file supported by IA #1139
"RTN","RGP26PST",5,0)
 ;
"RTN","RGP26PST",6,0)
DEVICE ;Add RG QUEUE entry in DEVICE (#3.5) file
"RTN","RGP26PST",7,0)
 N DA,DIC,DIE,DLAYGO,X,Y
"RTN","RGP26PST",8,0)
 S DIC(0)="LQMZ",(DIC,DLAYGO)=3.5,X="RG QUEUE" D ^DIC
"RTN","RGP26PST",9,0)
 I Y,$P(Y,"^",3) D  ;if newly added
"RTN","RGP26PST",10,0)
 .S DA=+Y,DIE=DIC
"RTN","RGP26PST",11,0)
 .S DR="1///^S X=""RG QUEUE"";2///^S X=""RES"";35////10"
"RTN","RGP26PST",12,0)
 .L +^%ZIS(1,DA):10
"RTN","RGP26PST",13,0)
 .D ^DIE
"RTN","RGP26PST",14,0)
 .L -^%ZIS(1,DA)
"RTN","RGP26PST",15,0)
 .D BMES^XPDUTL("RG QUEUE entry added to the DEVICE (#3.5) file.")
"RTN","RGP26PST",16,0)
 ;
"RTN","RGP26PST",17,0)
 D MES^XPDUTL(" Post-install routine completed successfully.")
"RTN","RGP26PST",18,0)
 ;
"RTN","RGP26PST",19,0)
QUIT ;Kill variables and quit
"RTN","RGP26PST",20,0)
 K DA,DIC,DIE,DLAYGO,DR,X,Y
"RTN","RGP26PST",21,0)
 Q
"RTN","RGRSDYN")
0^7^B5625324
"RTN","RGRSDYN",1,0)
RGRSDYN ;ALB/RJS-BUILD DYNAMIC LINK LIST FOR A PATIENT ;03/21/97
"RTN","RGRSDYN",2,0)
 ;;1.0;CLINICAL INFO RESOURCE NETWORK;**4,8,17,23,26**;30 Apr 99
"RTN","RGRSDYN",3,0)
 ;
"RTN","RGRSDYN",4,0)
 ;Reference to $$SEND2^VAFCUTL1 supported by IA #2779
"RTN","RGRSDYN",5,0)
 ;
"RTN","RGRSDYN",6,0)
EN(CLIENT,CLASS) ;
"RTN","RGRSDYN",7,0)
 ;CLIENT=HL7 CLIENT PROTOCOL AT TARGET SYSTEM
"RTN","RGRSDYN",8,0)
 ;DATA CLASS (Opt.) = Pull from Subs. Registry ONLY
"RTN","RGRSDYN",9,0)
 ;For now, anything else is both DESCRIPTIVE AND CLINICAL
"RTN","RGRSDYN",10,0)
 S CLASS=$G(CLASS),CLIENT=$G(CLIENT)
"RTN","RGRSDYN",11,0)
 Q:CLIENT=""  ;No receiver
"RTN","RGRSDYN",12,0)
 N PPF,DFN,HERE,ICN,RGRS,PPFIEN
"RTN","RGRSDYN",13,0)
PARS ;Parse local outbound message
"RTN","RGRSDYN",14,0)
 N RGDC
"RTN","RGRSDYN",15,0)
 D INITIZE^RGRSUTIL,EN^RGRSPARS("RGRS")
"RTN","RGRSDYN",16,0)
 ;Get patients owner site
"RTN","RGRSDYN",17,0)
 S PPF=$G(RGRS("SITENUM"))\1 Q:PPF'>0
"RTN","RGRSDYN",18,0)
 S PPFIEN=$$LKUP^XUAF4(PPF)
"RTN","RGRSDYN",19,0)
 ;get ICN
"RTN","RGRSDYN",20,0)
 S ICN=$G(RGRS(991.01)) Q:$G(ICN)']""
"RTN","RGRSDYN",21,0)
 ;Get DFN
"RTN","RGRSDYN",22,0)
 S DFN=$$GETDFN^MPIF001(ICN) Q:$G(DFN)'>0
"RTN","RGRSDYN",23,0)
 Q:+$$SEND2^VAFCUTL1(DFN,"T")  ;quit if test patient
"RTN","RGRSDYN",24,0)
 Q:$$IFLOCAL^MPIF001(DFN)
"RTN","RGRSDYN",25,0)
 ;Where we're at
"RTN","RGRSDYN",26,0)
 S HERE=$P($$SITE^VASITE,"^",3)\1
"RTN","RGRSDYN",27,0)
NOTPPF ; if not ppf send only to ppf
"RTN","RGRSDYN",28,0)
 I PPF'=HERE D  Q
"RTN","RGRSDYN",29,0)
 . N PPFLINK,INDEX
"RTN","RGRSDYN",30,0)
 . D LINK^HLUTIL3(PPFIEN,.PPFLINK)
"RTN","RGRSDYN",31,0)
 . S INDEX=$O(PPFLINK(0))
"RTN","RGRSDYN",32,0)
 . I INDEX]"" S HLL("LINKS",1)=CLIENT_"^"_PPFLINK(INDEX)
"RTN","RGRSDYN",33,0)
ISPPF ;
"RTN","RGRSDYN",34,0)
 I PPF=HERE D  Q
"RTN","RGRSDYN",35,0)
 . N PARENT,INDEX,SUBCONTL,CHILDREN,INDEX1,NODE
"RTN","RGRSDYN",36,0)
 . S NODE=$$MPINODE^MPIFAPI(DFN)
"RTN","RGRSDYN",37,0)
 . S SUBCONTL=$P($G(NODE),"^",5)
"RTN","RGRSDYN",38,0)
 . ;Get subscribers, return updated HLL array
"RTN","RGRSDYN",39,0)
 . D GET^RGRSDYN1(DFN,SUBCONTL,+CLASS,CLIENT,.HLL)
"RTN","RGRSDYN",40,0)
 . ;Get MPI link from SITE PARAMETER (when non A01/A03 event, ADT
"RTN","RGRSDYN",41,0)
 . ;message) part of the DG*5.3*261/RG*1.0*4 bundle gjc@2/4/99
"RTN","RGRSDYN",42,0)
 . I '$$ADT0103() D
"RTN","RGRSDYN",43,0)
 . . N MPI S MPI=$$MPILINK^MPIFAPI() D
"RTN","RGRSDYN",44,0)
 . . . I $P($G(MPI),U)'=-1 S HLL("LINKS",9999999999)=CLIENT_"^"_MPI
"RTN","RGRSDYN",45,0)
 . . . I $P($G(MPI),U)=-1 D
"RTN","RGRSDYN",46,0)
 . . . . N RGLOG,RGMTXT
"RTN","RGRSDYN",47,0)
 . . . . D START^RGHLLOG(HLMTIEN,"","")
"RTN","RGRSDYN",48,0)
 . . . . S RGMTXT=""
"RTN","RGRSDYN",49,0)
 . . . . D EXC^RGHLLOG(224,"No MPI link identified in CIRN SITE PARAMETER file (#991.8)"_RGMTXT,$G(DFN))
"RTN","RGRSDYN",50,0)
 . . . . D STOP^RGHLLOG(0)
"RTN","RGRSDYN",51,0)
 ;
"RTN","RGRSDYN",52,0)
 ;the following was commented out because we're not updating all sites
"RTN","RGRSDYN",53,0)
 ;in the VISN anymore
"RTN","RGRSDYN",54,0)
 ;
"RTN","RGRSDYN",55,0)
 ;. ;Get owners PARENT
"RTN","RGRSDYN",56,0)
 ;. D PARENT^XUAF4("PARENT",PPF)
"RTN","RGRSDYN",57,0)
 ;. S INDEX=""
"RTN","RGRSDYN",58,0)
 ;. S INDEX=$O(PARENT("P",INDEX))
"RTN","RGRSDYN",59,0)
 ;. Q:INDEX']""
"RTN","RGRSDYN",60,0)
 ;. D LINK^HLUTIL3(INDEX,.CHILDREN)
"RTN","RGRSDYN",61,0)
 ;. S INDEX=$O(HLL("LINKS",9999999999999),-1)
"RTN","RGRSDYN",62,0)
 ;. Q:INDEX']""
"RTN","RGRSDYN",63,0)
 ;. S INDEX1=0
"RTN","RGRSDYN",64,0)
 ;. F  S INDEX1=$O(CHILDREN(INDEX1)) Q:INDEX1'>0  D
"RTN","RGRSDYN",65,0)
 ;. . S INDEX=INDEX+1
"RTN","RGRSDYN",66,0)
 ;. . S HLL("LINKS",INDEX)=CLIENT_"^"_CHILDREN(INDEX1)
"RTN","RGRSDYN",67,0)
 ;
"RTN","RGRSDYN",68,0)
ADT0103() ; check to see if this is an ADT message type with an
"RTN","RGRSDYN",69,0)
 ; event of A01 -or- A03.  If true, do not broadcast the message
"RTN","RGRSDYN",70,0)
 ; to the MPI.  Part of the DG*5.3*261/RG*1.0*4 bundle.  gjc@2/4/99
"RTN","RGRSDYN",71,0)
 S HL("MTN")=$G(HL("MTN")),HL("ETN")=$G(HL("ETN")) ; just in case
"RTN","RGRSDYN",72,0)
 Q $S(HL("MTN")="ADT"&(HL("ETN")="A01"!(HL("ETN")="A03")):1,1:0)
"VER")
8.0^22.0
**END**
**END**
