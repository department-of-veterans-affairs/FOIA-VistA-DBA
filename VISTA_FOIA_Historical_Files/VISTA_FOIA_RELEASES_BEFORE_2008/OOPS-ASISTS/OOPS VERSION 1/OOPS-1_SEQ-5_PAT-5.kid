Released OOPS*1*5 SEQ #5
Extracted from mail message
**KIDS**:OOPS*1.0*5^

**INSTALL NAME**
OOPS*1.0*5
"BLD",2128,0)
OOPS*1.0*5^ASISTS^0^2991129^y
"BLD",2128,1,0)
^^3^3^2991105^^^
"BLD",2128,1,1,0)
Modifcations for the National Database project as well as modifications 
"BLD",2128,1,2,0)
needed to implement the NDB project reporting requirements and other 
"BLD",2128,1,3,0)
NOIS and E3R's
"BLD",2128,4,0)
^9.64PA^2261.5^3
"BLD",2128,4,2260,0)
2260
"BLD",2128,4,2260,2,0)
^9.641^2260.039^2
"BLD",2128,4,2260,2,2260,0)
ASISTS ACCIDENT REPORTING  (File-top level)
"BLD",2128,4,2260,2,2260,1,0)
^9.6411^57^7
"BLD",2128,4,2260,2,2260,1,2,0)
PERSONNEL STATUS
"BLD",2128,4,2260,2,2260,1,4,0)
DATE/TIME OF OCCURRENCE
"BLD",2128,4,2260,2,2260,1,13,0)
STATION NUMBER
"BLD",2128,4,2260,2,2260,1,29.5,0)
MEDICAL EMERGENCY
"BLD",2128,4,2260,2,2260,1,42.5,0)
EQUIP/DEVICE FAILURE OCCURRED
"BLD",2128,4,2260,2,2260,1,56,0)
PERSON ENTERING STUB RECORD
"BLD",2128,4,2260,2,2260,1,57,0)
DATE TRANSMITTED TO NDB
"BLD",2128,4,2260,2,2260.039,0)
AREA EXPOSED TO BODILY FLUID  (sub-file)
"BLD",2128,4,2260,2,2260.039,1,0)
^9.6411^.01^1
"BLD",2128,4,2260,2,2260.039,1,.01,0)
AREA EXPOSED TO BODILY FLUID
"BLD",2128,4,2260,222)
y^y^p^^^^n
"BLD",2128,4,2261.5,0)
2261.5
"BLD",2128,4,2261.5,222)
n^n^f^^n^^y^o^n
"BLD",2128,4,2261.6,0)
2261.6
"BLD",2128,4,2261.6,222)
n^n^f^^n^^y^o^n
"BLD",2128,4,"APDD",2260,2260)

"BLD",2128,4,"APDD",2260,2260,2)

"BLD",2128,4,"APDD",2260,2260,4)

"BLD",2128,4,"APDD",2260,2260,13)

"BLD",2128,4,"APDD",2260,2260,29.5)

"BLD",2128,4,"APDD",2260,2260,42.5)

"BLD",2128,4,"APDD",2260,2260,56)

"BLD",2128,4,"APDD",2260,2260,57)

"BLD",2128,4,"APDD",2260,2260.039)

"BLD",2128,4,"APDD",2260,2260.039,.01)

"BLD",2128,4,"B",2260,2260)

"BLD",2128,4,"B",2261.5,2261.5)

"BLD",2128,4,"B",2261.6,2261.6)

"BLD",2128,"ABPKG")
n
"BLD",2128,"INI")
PRE^OOPSXP5
"BLD",2128,"INIT")
POST^OOPSXP5
"BLD",2128,"KRN",0)
^9.67PA^19^18
"BLD",2128,"KRN",.4,0)
.4
"BLD",2128,"KRN",.4,"NM",0)
^9.68A^^
"BLD",2128,"KRN",.401,0)
.401
"BLD",2128,"KRN",.402,0)
.402
"BLD",2128,"KRN",.403,0)
.403
"BLD",2128,"KRN",.5,0)
.5
"BLD",2128,"KRN",.84,0)
.84
"BLD",2128,"KRN",3.6,0)
3.6
"BLD",2128,"KRN",3.8,0)
3.8
"BLD",2128,"KRN",3.8,"NM",0)
^9.68A^1^1
"BLD",2128,"KRN",3.8,"NM",1,0)
OOPS NDB MESSAGES^^0
"BLD",2128,"KRN",3.8,"NM","B","OOPS NDB MESSAGES",1)

"BLD",2128,"KRN",9.2,0)
9.2
"BLD",2128,"KRN",9.8,0)
9.8
"BLD",2128,"KRN",9.8,"NM",0)
^9.68A^17^16
"BLD",2128,"KRN",9.8,"NM",1,0)
OOPSCC^^0^B32083878
"BLD",2128,"KRN",9.8,"NM",2,0)
OOPSDIS^^0^B5175941
"BLD",2128,"KRN",9.8,"NM",3,0)
OOPSEMP1^^0^B66497929
"BLD",2128,"KRN",9.8,"NM",4,0)
OOPSPRT^^0^B37129997
"BLD",2128,"KRN",9.8,"NM",5,0)
OOPSPRT1^^0^B30649056
"BLD",2128,"KRN",9.8,"NM",6,0)
OOPSLOG^^0^B29138214
"BLD",2128,"KRN",9.8,"NM",7,0)
OOPSSOF1^^0^B4960225
"BLD",2128,"KRN",9.8,"NM",8,0)
OOPSSOF2^^0^B1745457
"BLD",2128,"KRN",9.8,"NM",10,0)
OOPSSUP3^^0^B8636206
"BLD",2128,"KRN",9.8,"NM",11,0)
OOPSSUP1^^0^B31529635
"BLD",2128,"KRN",9.8,"NM",12,0)
OOPSUTL4^^0^B12340948
"BLD",2128,"KRN",9.8,"NM",13,0)
OOPSVAL1^^0^B17650014
"BLD",2128,"KRN",9.8,"NM",14,0)
OOPSSUP2^^0^B64366643
"BLD",2128,"KRN",9.8,"NM",15,0)
OOPSNDB^^0^B37956155
"BLD",2128,"KRN",9.8,"NM",16,0)
OOPSNDBX^^0^B15692135
"BLD",2128,"KRN",9.8,"NM",17,0)
OOPSXP5^^0^B7400907
"BLD",2128,"KRN",9.8,"NM","B","OOPSCC",1)

"BLD",2128,"KRN",9.8,"NM","B","OOPSDIS",2)

"BLD",2128,"KRN",9.8,"NM","B","OOPSEMP1",3)

"BLD",2128,"KRN",9.8,"NM","B","OOPSLOG",6)

"BLD",2128,"KRN",9.8,"NM","B","OOPSNDB",15)

"BLD",2128,"KRN",9.8,"NM","B","OOPSNDBX",16)

"BLD",2128,"KRN",9.8,"NM","B","OOPSPRT",4)

"BLD",2128,"KRN",9.8,"NM","B","OOPSPRT1",5)

"BLD",2128,"KRN",9.8,"NM","B","OOPSSOF1",7)

"BLD",2128,"KRN",9.8,"NM","B","OOPSSOF2",8)

"BLD",2128,"KRN",9.8,"NM","B","OOPSSUP1",11)

"BLD",2128,"KRN",9.8,"NM","B","OOPSSUP2",14)

"BLD",2128,"KRN",9.8,"NM","B","OOPSSUP3",10)

"BLD",2128,"KRN",9.8,"NM","B","OOPSUTL4",12)

"BLD",2128,"KRN",9.8,"NM","B","OOPSVAL1",13)

"BLD",2128,"KRN",9.8,"NM","B","OOPSXP5",17)

"BLD",2128,"KRN",19,0)
19
"BLD",2128,"KRN",19,"NM",0)
^9.68A^3^3
"BLD",2128,"KRN",19,"NM",1,0)
OOPS SCHEDULED XMIT 2162 DATA^^0
"BLD",2128,"KRN",19,"NM",2,0)
OOPS MANUAL 2162 DATA XMIT^^0
"BLD",2128,"KRN",19,"NM",3,0)
OOPS SAFETY MENU^^2
"BLD",2128,"KRN",19,"NM","B","OOPS MANUAL 2162 DATA XMIT",2)

"BLD",2128,"KRN",19,"NM","B","OOPS SAFETY MENU",3)

"BLD",2128,"KRN",19,"NM","B","OOPS SCHEDULED XMIT 2162 DATA",1)

"BLD",2128,"KRN",19.1,0)
19.1
"BLD",2128,"KRN",19.1,"NM",0)
^9.68A^1^1
"BLD",2128,"KRN",19.1,"NM",1,0)
OOPS XMIT 2162 DATA^^0
"BLD",2128,"KRN",19.1,"NM","B","OOPS XMIT 2162 DATA",1)

"BLD",2128,"KRN",101,0)
101
"BLD",2128,"KRN",101,"NM",0)
^9.68A^^
"BLD",2128,"KRN",409.61,0)
409.61
"BLD",2128,"KRN",771,0)
771
"BLD",2128,"KRN",869.2,0)
869.2
"BLD",2128,"KRN",870,0)
870
"BLD",2128,"KRN",8994,0)
8994
"BLD",2128,"KRN","B",.4,.4)

"BLD",2128,"KRN","B",.401,.401)

"BLD",2128,"KRN","B",.402,.402)

"BLD",2128,"KRN","B",.403,.403)

"BLD",2128,"KRN","B",.5,.5)

"BLD",2128,"KRN","B",.84,.84)

"BLD",2128,"KRN","B",3.6,3.6)

"BLD",2128,"KRN","B",3.8,3.8)

"BLD",2128,"KRN","B",9.2,9.2)

"BLD",2128,"KRN","B",9.8,9.8)

"BLD",2128,"KRN","B",19,19)

"BLD",2128,"KRN","B",19.1,19.1)

"BLD",2128,"KRN","B",101,101)

"BLD",2128,"KRN","B",409.61,409.61)

"BLD",2128,"KRN","B",771,771)

"BLD",2128,"KRN","B",869.2,869.2)

"BLD",2128,"KRN","B",870,870)

"BLD",2128,"KRN","B",8994,8994)

"BLD",2128,"QUES",0)
^9.62^1^1
"BLD",2128,"QUES",1,0)
PRE1
"BLD",2128,"QUES",1,1)
PA^4:AEMZ
"BLD",2128,"QUES",1,"A")
Enter Station Number to Populate blank Station # Fields: 
"BLD",2128,"QUES",1,"Q")
Enter Station Number to use in populating blank Station # fields
"BLD",2128,"QUES","B","PRE1",1)

"BLD",2128,"REQB",0)
^9.611^3^3
"BLD",2128,"REQB",1,0)
OOPS*1.0*1^2
"BLD",2128,"REQB",2,0)
OOPS*1.0*2^2
"BLD",2128,"REQB",3,0)
OOPS*1.0*3^2
"BLD",2128,"REQB","B","OOPS*1.0*1",1)

"BLD",2128,"REQB","B","OOPS*1.0*2",2)

"BLD",2128,"REQB","B","OOPS*1.0*3",3)

"DATA",2261.5,1,0)
Injection, thru skin (syringe)^1
"DATA",2261.5,2,0)
Heparin/saline flush (syringe)^2
"DATA",2261.5,3,0)
Other, I.M. or I.V. port (syringe)^3
"DATA",2261.5,4,0)
To connect I.V. line^4
"DATA",2261.5,6,0)
Venous blood samp-direct stick^6
"DATA",2261.5,7,0)
Venous blood sample-from line^7
"DATA",2261.5,8,0)
Art. blood samp-direct stick^8
"DATA",2261.5,9,0)
Art. blood samp-from line^9
"DATA",2261.5,10,0)
Obtain body fluid or tissue samp^10
"DATA",2261.5,11,0)
Finger stick/heel stick^11
"DATA",2261.5,12,0)
Suturing^12
"DATA",2261.5,13,0)
Cutting^13
"DATA",2261.5,14,0)
Drilling^14
"DATA",2261.5,15,0)
Electrocautery^15
"DATA",2261.5,16,0)
Glass item-hold spec or pharm^16
"DATA",2261.5,17,0)
Place arterial/central line^17
"DATA",2261.5,18,0)
Unknown/not applicable^18
"DATA",2261.5,20,0)
Start I.V. or heparin lock^5
"DATA",2261.5,21,0)
Other^19
"DATA",2261.5,22,0)
Shaving Patient^20
"DATA",2261.5,23,0)
Dental Procedure^21
"DATA",2261.6,1,0)
Before use (broke, slipped, etc)^1
"DATA",2261.6,2,0)
During use of item ^2
"DATA",2261.6,3,0)
During multi-step procedure^3
"DATA",2261.6,4,0)
Disassembling device or equip^4
"DATA",2261.6,5,0)
Preparing item for reuse^5
"DATA",2261.6,6,0)
Needle from resistant material^6
"DATA",2261.6,7,0)
Device in inappropriate place^7
"DATA",2261.6,8,0)
After use, before disposal^8
"DATA",2261.6,9,0)
Left near disposal container^9
"DATA",2261.6,10,0)
While disposing of item^10
"DATA",2261.6,11,0)
Protruded-opening disposal container^11
"DATA",2261.6,12,0)
Item pierced side of disposal container^12
"DATA",2261.6,13,0)
Protruded-inappropriate waste container^13
"DATA",2261.6,14,0)
Restraining^14
"DATA",2261.6,15,0)
Other^15
"DATA",2261.6,16,0)
Cleaning Equipment with Visible Contamination^16
"FIA",2260)
ASISTS ACCIDENT REPORTING
"FIA",2260,0)
^OOPS(2260,
"FIA",2260,0,0)
2260I
"FIA",2260,0,1)
y^y^p^^^^n
"FIA",2260,0,10)

"FIA",2260,0,11)

"FIA",2260,0,"RLRO")

"FIA",2260,0,"VR")
1.0^OOPS
"FIA",2260,2260)
1
"FIA",2260,2260,2)

"FIA",2260,2260,4)

"FIA",2260,2260,13)

"FIA",2260,2260,29.5)

"FIA",2260,2260,39)

"FIA",2260,2260,42.5)

"FIA",2260,2260,56)

"FIA",2260,2260,57)

"FIA",2260,2260.039)
1
"FIA",2260,2260.039,.01)

"FIA",2261.5)
ASISTS PURPOSE FOR USING SHARPS
"FIA",2261.5,0)
^OOPS(2261.5,
"FIA",2261.5,0,0)
2261.5
"FIA",2261.5,0,1)
n^n^f^^n^^y^o^n
"FIA",2261.5,0,10)

"FIA",2261.5,0,11)

"FIA",2261.5,0,"RLRO")

"FIA",2261.5,0,"VR")
1.0^OOPS
"FIA",2261.5,2261.5)
0
"FIA",2261.6)
ASISTS OCCURRENCE OF SHARPS INJURY
"FIA",2261.6,0)
^OOPS(2261.6,
"FIA",2261.6,0,0)
2261.6
"FIA",2261.6,0,1)
n^n^f^^n^^y^o^n
"FIA",2261.6,0,10)

"FIA",2261.6,0,11)

"FIA",2261.6,0,"RLRO")

"FIA",2261.6,0,"VR")
1.0^OOPS
"FIA",2261.6,2261.6)
0
"INI")
PRE^OOPSXP5
"INIT")
POST^OOPSXP5
"KRN",3.8,234,-1)
0^1
"KRN",3.8,234,0)
OOPS NDB MESSAGES^PU^n^^^^
"KRN",3.8,234,2,0)
^^2^2^2991109^^^^
"KRN",3.8,234,2,1,0)
This group should contain the individuals who should receive any messages
"KRN",3.8,234,2,2,0)
regarding the transmission of ASISTS 2162 data to the AAC or from the AAC. 
"KRN",3.8,234,5,0)
^3.811P
"KRN",19,7450,-1)
2^3
"KRN",19,7450,0)
OOPS SAFETY MENU^ASISTS Safety Officers Menu^^M^66481^^^^^^^
"KRN",19,7450,10,0)
^19.01IP^16^16
"KRN",19,7450,10,16,0)
10070
"KRN",19,7450,10,16,"^")
OOPS MANUAL 2162 DATA XMIT
"KRN",19,7450,"U")
ASISTS SAFETY OFFICERS MENU
"KRN",19,10069,-1)
0^1
"KRN",19,10069,0)
OOPS SCHEDULED XMIT 2162 DATA^Scheduled Transmit National Database (2162) Data^^R^^^^^^^^ASISTS^y
"KRN",19,10069,1,0)
^^3^3^2991018^^
"KRN",19,10069,1,1,0)
This option will be used to transmit the 2162 data from closed ASISTS cases
"KRN",19,10069,1,2,0)
to the Austin Automation Center for processing to the National Database.  It
"KRN",19,10069,1,3,0)
will be a scheduled option that should be run monthly.
"KRN",19,10069,25)
EN^OOPSNDB
"KRN",19,10069,200.9)
y^y
"KRN",19,10069,"U")
SCHEDULED TRANSMIT NATIONAL DA
"KRN",19,10070,-1)
0^2
"KRN",19,10070,0)
OOPS MANUAL 2162 DATA XMIT^Manual Transmit of National Database (2162) Data^^R^^^^^^^^ASISTS
"KRN",19,10070,1,0)
^^4^4^2991129^^^
"KRN",19,10070,1,1,0)
This option will be used to transmit the 2162 data from closed
"KRN",19,10070,1,2,0)
ASISTS cases to the Austin Automation Center for processing to the National
"KRN",19,10070,1,3,0)
Database.  It will be used for manual transmission of the data when the 
"KRN",19,10070,1,4,0)
scheduled option has failed.
"KRN",19,10070,25)
OOPSNDB
"KRN",19,10070,"U")
MANUAL TRANSMIT OF NATIONAL DA
"KRN",19.1,369,-1)
0^1
"KRN",19.1,369,0)
OOPS XMIT 2162 DATA^OOPS TRANSMIT 2162 DATA
"KRN",19.1,369,1,0)
^^2^2^2991105^^^
"KRN",19.1,369,1,1,0)
This key is used to allow access to the ASISTS menu option to transmit the 
"KRN",19.1,369,1,2,0)
2162 National Database data manually.
"MBREQ")
0
"ORD",3,19.1)
19.1;3;1;;KEY^XPDTA1;;;;;KEYDEL^XPDIA1
"ORD",3,19.1,0)
SECURITY KEY
"ORD",11,3.8)
3.8;11;;;MAILG^XPDTA1;MAILGF1^XPDIA1;MAILGE1^XPDIA1;MAILGF2^XPDIA1
"ORD",11,3.8,0)
MAIL GROUP
"ORD",18,19)
19;18;;;OPT^XPDTA;OPTF1^XPDIA;OPTE1^XPDIA;OPTF2^XPDIA;;OPTDEL^XPDIA
"ORD",18,19,0)
OPTION
"PKG",472,-1)
1^1
"PKG",472,0)
ASISTS^OOPS^Automated Safety Incident Surveillance Tracking System
"PKG",472,20,0)
^9.402P^^
"PKG",472,22,0)
^9.49I^1^1
"PKG",472,22,1,0)
1.0^^2980819^66481
"PKG",472,22,1,"PAH",1,0)
5^2991129
"PKG",472,22,1,"PAH",1,1,0)
^^3^3^2991129
"PKG",472,22,1,"PAH",1,1,1,0)
Modifcations for the National Database project as well as modifications 
"PKG",472,22,1,"PAH",1,1,2,0)
needed to implement the NDB project reporting requirements and other 
"PKG",472,22,1,"PAH",1,1,3,0)
NOIS and E3R's
"QUES","PRE1",0)
PA^4:AEMZ
"QUES","PRE1","?")
Enter Station Number to use in populating blank Station # fields
"QUES","PRE1","A")
Enter Station Number to Populate blank Station # Fields: 
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
16
"RTN","OOPSCC")
0^1^B32083878
"RTN","OOPSCC",1,0)
OOPSCC ;HINES CIOFO/GWB-CREATE ASISTS CASE ;3/5/98
"RTN","OOPSCC",2,0)
 ;;1.0;ASISTS;**3,5**;Jun 01, 1998
"RTN","OOPSCC",3,0)
 N CAT,DATE,SUP,FYEAR,GRP,I,IEN2260,OOPS,IEN450,EMP,IEN200,PAID,VIEW
"RTN","OOPSCC",4,0)
 S DIE("NO^")="BACKOUTOK",VIEW=0
"RTN","OOPSCC",5,0)
 D NOW^%DTC
"RTN","OOPSCC",6,0)
 S DATE=X,FYEAR="",FYEAR=$$FYEAR^OOPSCSN(X),NUM=$$NEWR^OOPSCSN(FYEAR)
"RTN","OOPSCC",7,0)
 S (NAME,SEX,SSN,DOB,STN,CCT,OCC,GRD,STP,EDU,ANS,PAID)=""
"RTN","OOPSCC",8,0)
 W @IOF
"RTN","OOPSCC",9,0)
 W !!," Case number ",NUM," will be assigned to this incident.",!
"RTN","OOPSCC",10,0)
 K DD,DO S DIC="^OOPS(2260,",DIC(0)="QLZ",X=NUM D FILE^DICN G:Y=-1 EXIT
"RTN","OOPSCC",11,0)
 S IEN2260=+Y
"RTN","OOPSCC",12,0)
PS K DR S DIE="^OOPS(2260,",DA=IEN2260,DR="2 PERSONNEL STATUS........."
"RTN","OOPSCC",13,0)
 D ^DIE
"RTN","OOPSCC",14,0)
 G:$D(Y)'=0 DELETE S CAT=X
"RTN","OOPSCC",15,0)
 I CAT=1 D  G:Y=-1 DELETE               ; Employee in ^PRSPC (PAID)
"RTN","OOPSCC",16,0)
 .S DIC="^PRSPC(",DIC("A")=" PERSON INVOLVED..........: ",DIC("B")=NAME
"RTN","OOPSCC",17,0)
 .S DIC("W")="W ?30,$E($P(^(0),U,9),6,9)"
"RTN","OOPSCC",18,0)
 .S DIC(0)="QEAMZ" D ^DIC Q:Y=-1
"RTN","OOPSCC",19,0)
 .S IEN450=+Y,NAME=$P(Y,U,2)
"RTN","OOPSCC",20,0)
 .N Y K DIQ S DIC="^PRSPC(",DR="6;8;10;13;16;31;32;38;458;604",DA=IEN450
"RTN","OOPSCC",21,0)
 .S DIQ="OOPS",DIQ(0)="IE" D EN^DIQ1
"RTN","OOPSCC",22,0)
 .S STN=OOPS(450,IEN450,6,"I")
"RTN","OOPSCC",23,0)
 .S SSN=OOPS(450,IEN450,8,"I")
"RTN","OOPSCC",24,0)
 .S EDU=OOPS(450,IEN450,10,"E"),EDU=$E(EDU,1)_$$LOW^XLFSTR($E(EDU,2,45))
"RTN","OOPSCC",25,0)
 .S GRD=OOPS(450,IEN450,13,"I")
"RTN","OOPSCC",26,0)
 .S OCC=OOPS(450,IEN450,16,"I")
"RTN","OOPSCC",27,0)
 .S CCT=OOPS(450,IEN450,458,"I")
"RTN","OOPSCC",28,0)
 .S SEX=OOPS(450,IEN450,31,"I")
"RTN","OOPSCC",29,0)
 .S DOB=OOPS(450,IEN450,32,"I")
"RTN","OOPSCC",30,0)
 .S STP=OOPS(450,IEN450,38,"I")
"RTN","OOPSCC",31,0)
 ;
"RTN","OOPSCC",32,0)
 ; New Personnel Status = Non-Paid Employee. Get fields from ^VA(200
"RTN","OOPSCC",33,0)
 ; If Person in PAID file (PAID=1) don't allow adding as non-paid emp
"RTN","OOPSCC",34,0)
 ; If no SSN in file 200, set PAID=1, prevent hard errors
"RTN","OOPSCC",35,0)
 I CAT=6 D  G:(Y=-1!(PAID)) DELETE
"RTN","OOPSCC",36,0)
 .S DIC="^VA(200,",DIC("A")=" PERSON INVOLVED..........: ",DIC("B")=NAME
"RTN","OOPSCC",37,0)
 .S DIC("W")="W ?30,$E($P(^(1),U,9),6,9)"
"RTN","OOPSCC",38,0)
 .S DIC(0)="QEAMZ" D ^DIC Q:Y=-1
"RTN","OOPSCC",39,0)
 .S IEN200=+Y,NAME=$P(Y,U,2)
"RTN","OOPSCC",40,0)
 .; Make sure the person is not a PAID Employee - Patch 3
"RTN","OOPSCC",41,0)
 .S PAID=0
"RTN","OOPSCC",42,0)
 .; If no SSN, Can't continue - Patch 3
"RTN","OOPSCC",43,0)
 .I '$$GET1^DIQ(200,IEN200,9,"I") D  Q
"RTN","OOPSCC",44,0)
 ..W !,"No SSN on file in the New Person file. Must enter to create case."
"RTN","OOPSCC",45,0)
 ..S PAID=1
"RTN","OOPSCC",46,0)
 .N Y K DIQ S DIC="^VA(200,",DR="4;5;9",DA=IEN200
"RTN","OOPSCC",47,0)
 .S DIQ="OOPS",DIQ(0)="IE" D EN^DIQ1
"RTN","OOPSCC",48,0)
 .S SEX=OOPS(200,IEN200,4,"I")
"RTN","OOPSCC",49,0)
 .S DOB=OOPS(200,IEN200,5,"I")
"RTN","OOPSCC",50,0)
 .S SSN=OOPS(200,IEN200,9,"I")
"RTN","OOPSCC",51,0)
 .I $D(^PRSPC("SSN",SSN)) D
"RTN","OOPSCC",52,0)
 ..W !,"This person (SSN) is a 'PAID' Employee, Please Re-enter"
"RTN","OOPSCC",53,0)
 ..S PAID=1
"RTN","OOPSCC",54,0)
 K DR S DIE="^OOPS(2260,",DA=IEN2260,DR=""
"RTN","OOPSCC",55,0)
 I CAT=1 D                           ; Employee in ^PRSPC (PAID)
"RTN","OOPSCC",56,0)
 .S DR(1,2260,1)="1///^S X=NAME"
"RTN","OOPSCC",57,0)
 .S DR(1,2260,2)="5///^S X=SSN"
"RTN","OOPSCC",58,0)
 .S DR(1,2260,3)="6///^S X=DOB"
"RTN","OOPSCC",59,0)
 .S DR(1,2260,4)="7///^S X=SEX"
"RTN","OOPSCC",60,0)
 .; S DR(1,2260,5)="13///^S X=STN"   ; patch 5 - don't stuff pointer
"RTN","OOPSCC",61,0)
 .S DR(1,2260,6)="14///^S X=CCT"
"RTN","OOPSCC",62,0)
 .S DR(1,2260,7)="15///^S X=$E(OCC,1,4)"
"RTN","OOPSCC",63,0)
 .S DR(1,2260,8)="16///^S X=GRD"
"RTN","OOPSCC",64,0)
 .S DR(1,2260,9)="17///^S X=STP"
"RTN","OOPSCC",65,0)
 .S DR(1,2260,10)="18///^S X=EDU"
"RTN","OOPSCC",66,0)
 I CAT=6 D                           ; Employee not in ^PRSPC (Non-PAID)
"RTN","OOPSCC",67,0)
 .S DR(1,2260,1)="1///^S X=NAME"
"RTN","OOPSCC",68,0)
 .S DR(1,2260,2)="5///^S X=SSN"
"RTN","OOPSCC",69,0)
 .S DR(1,2260,3)="6///^S X=DOB"
"RTN","OOPSCC",70,0)
 .S DR(1,2260,4)="7///^S X=SEX"
"RTN","OOPSCC",71,0)
 I CAT'=1&(CAT'=6) D                 ; Everyone else
"RTN","OOPSCC",72,0)
 .S DR(1,2260,1)="1 PERSON INVOLVED.........."
"RTN","OOPSCC",73,0)
 .S DR(1,2260,2)="5 SSN......................"
"RTN","OOPSCC",74,0)
 .; Patch 5 - get data for non-employee personnel
"RTN","OOPSCC",75,0)
 . S DR(1,2260,2.5)="I X="""" W !,""Social Security Number is Required"" S Y=5"
"RTN","OOPSCC",76,0)
 .S DR(1,2260,3)="6 DOB......................"
"RTN","OOPSCC",77,0)
 .S DR(1,2260,3.5)="I X="""" W !,""Date of Birth is required"" S Y=6"
"RTN","OOPSCC",78,0)
 .S DR(1,2260,4)="7 SEX......................"
"RTN","OOPSCC",79,0)
 .S DR(1,2260,4.5)="I X="""" W !,""Sex is Required"" S Y=7"
"RTN","OOPSCC",80,0)
 ;
"RTN","OOPSCC",81,0)
 ; Patch 5 - Check for Duplicate Cases
"RTN","OOPSCC",82,0)
 S DR(1,2260,2.7)="I $$DUP^OOPSCC() S Y=""@3"""
"RTN","OOPSCC",83,0)
 S DR(1,2260,11)="8 HOME STREET ADDRESS......"
"RTN","OOPSCC",84,0)
 S DR(1,2260,12)="9 CITY....................."
"RTN","OOPSCC",85,0)
 S DR(1,2260,13)="10 STATE...................."
"RTN","OOPSCC",86,0)
 S DR(1,2260,14)="11 ZIP CODE................."
"RTN","OOPSCC",87,0)
 S DR(1,2260,15)="12 HOME PHONE NUMBER........"
"RTN","OOPSCC",88,0)
 ; Patch 5 - Collect Station Number for everyone, allow changing PAID
"RTN","OOPSCC",89,0)
 S DR(1,2260,15.5)="13 STATION NUMBER...........//^S X=STN"
"RTN","OOPSCC",90,0)
 S DR(1,2260,16)="52 INJURY/ILLNESS..........."
"RTN","OOPSCC",91,0)
 S DR(1,2260,17)="S Y=$S(X=1:""@1"",1:""@2"")"
"RTN","OOPSCC",92,0)
 S DR(1,2260,18)="@1"
"RTN","OOPSCC",93,0)
 S DR(1,2260,19)="4 DATE/TIME INJURY OCCURRED"
"RTN","OOPSCC",94,0)
 S DR(1,2260,20)="I $P(X,""."",2)="""" W !,""Time is REQUIRED in this response."" S Y=4"
"RTN","OOPSCC",95,0)
 S DR(1,2260,21)="S Y=3"
"RTN","OOPSCC",96,0)
 S DR(1,2260,22)="@2"
"RTN","OOPSCC",97,0)
 S DR(1,2260,23)="4 DATE 1ST AWARE OF ILLNESS"
"RTN","OOPSCC",98,0)
 S DR(1,2260,24)="3 TYPE OF INCIDENT........."
"RTN","OOPSCC",99,0)
 ; patch 5 - changed for new category types
"RTN","OOPSCC",100,0)
 S SUP=$S((CAT=1!(CAT>6)):" SUPERVISOR...............",CAT=2:" VOLUNTARY SVC SUPERVISOR.",CAT=3:" CONTRACT ADMINISTRATOR...",1:" SAFETY OFFICER...........")
"RTN","OOPSCC",101,0)
 S DR(1,2260,25)="53"_SUP
"RTN","OOPSCC",102,0)
 S DR(1,2260,26)="53.1 SECONDARY SUPERVISOR....."
"RTN","OOPSCC",103,0)
 S DR(1,2260,27)="56///^S X=DUZ"
"RTN","OOPSCC",104,0)
 S DR(1,2260,28)="@3"
"RTN","OOPSCC",105,0)
 S DR(1,2260,29)="I VIEW W !!?4,""This Case will be DELETED!"""
"RTN","OOPSCC",106,0)
 D ^DIE G:$D(Y)'=0!(VIEW) DELETE            ; VIEW = Duplicate Patch 5
"RTN","OOPSCC",107,0)
 S DIR(0)="S^E:Edit;S:Save;D:Delete",DIR("A")=" Case action" D ^DIR K DIR
"RTN","OOPSCC",108,0)
 I Y="E" S ANS="E" G PS
"RTN","OOPSCC",109,0)
 I Y="S" D  D CASE^OOPSMBUL(IEN2260) D:((CAT=1)!(CAT=6))&(SSN'="") BOR^OOPSMBUL(IEN2260):$D(^VA(200,"SSN",SSN)) G EXIT
"RTN","OOPSCC",110,0)
 .K DR S DIE="^OOPS(2260,",DA=IEN2260,DR="51///0" D ^DIE K DIE
"RTN","OOPSCC",111,0)
 .W !!," Case number ",NUM," has been saved.",!
"RTN","OOPSCC",112,0)
 I (Y="D")!($D(DIRUT)) G DELETE
"RTN","OOPSCC",113,0)
 G EXIT
"RTN","OOPSCC",114,0)
DUP() ; Patch 5 Finds Open Cases w/Matching names, Cases checked for
"RTN","OOPSCC",115,0)
 ;   being a duplicate must have a Status of OPEN
"RTN","OOPSCC",116,0)
 ;
"RTN","OOPSCC",117,0)
 ; Input Variables:
"RTN","OOPSCC",118,0)
 ;   IEN2260 - IEN of Current Case
"RTN","OOPSCC",119,0)
 ;   SSN     - SSN of Current Case
"RTN","OOPSCC",120,0)
 ; Output Variables
"RTN","OOPSCC",121,0)
 ;   VIEW    - returns 1 if user indicates case is a duplicate
"RTN","OOPSCC",122,0)
 ;             which triggers system to delete the case and exit
"RTN","OOPSCC",123,0)
 ;           - returns 0 if user indicates case is not a duplicate
"RTN","OOPSCC",124,0)
 ;             and system continues normal processing.
"RTN","OOPSCC",125,0)
 ;
"RTN","OOPSCC",126,0)
 N ARR,FILE,FLD,IX,SCR,Y
"RTN","OOPSCC",127,0)
 S FILE=2260,FLD=5
"RTN","OOPSCC",128,0)
 S SSN=$$GET1^DIQ(2260,IEN2260,5,"I")
"RTN","OOPSCC",129,0)
 S IX="SSN",ARR="OOPS",VIEW=0
"RTN","OOPSCC",130,0)
 S SCR="I ($$GET1^DIQ(FILE,Y,51,""I"")<1)&(Y'=IEN2260)"
"RTN","OOPSCC",131,0)
 S SCR=SCR_"&($$GET1^DIQ(FILE,Y,5,""I"")=SSN)"
"RTN","OOPSCC",132,0)
 D LIST^DIC(FILE,,FLD,,,,,IX,SCR,,ARR)
"RTN","OOPSCC",133,0)
 I $G(OOPS("DILIST",0)) D
"RTN","OOPSCC",134,0)
 . W !!,"The following case(s) are Open with SSN: "_SSN,!
"RTN","OOPSCC",135,0)
 . N DIC,DA,DR,OPID,Y
"RTN","OOPSCC",136,0)
 . S DIC="^OOPS(2260,",(DA,DR,OPID)=0
"RTN","OOPSCC",137,0)
 . F  S OPID=$O(OOPS("DILIST",2,OPID)) Q:OPID=""  D
"RTN","OOPSCC",138,0)
 .. S DA=OOPS("DILIST",2,OPID) D EN^DIQ
"RTN","OOPSCC",139,0)
 . K DIR S DIR(0)="Y"
"RTN","OOPSCC",140,0)
 . S DIR("A")=" Is the Current entry a DUPLICATE Case: "
"RTN","OOPSCC",141,0)
 . D ^DIR K DIR
"RTN","OOPSCC",142,0)
 . I Y S VIEW=1
"RTN","OOPSCC",143,0)
 Q VIEW
"RTN","OOPSCC",144,0)
DELETE ;Delete incomplete case
"RTN","OOPSCC",145,0)
 S DIK="^OOPS(2260,",DA=IEN2260 D ^DIK K DIK
"RTN","OOPSCC",146,0)
END W !!," Case ",NUM," deleted"
"RTN","OOPSCC",147,0)
EXIT K DA,DIC,DIE,DR,NUM,NAME,SEX,SSN,DOB,STN,CCT,OCC,GRD,STP,EDU,ANS
"RTN","OOPSCC",148,0)
 Q
"RTN","OOPSDIS")
0^2^B5175941
"RTN","OOPSDIS",1,0)
OOPSDIS ;HIRMFO/GWB - Display 2162 ;3/5/98
"RTN","OOPSDIS",2,0)
 ;;1.0;ASISTS;**3,5**;Jun 01, 1998
"RTN","OOPSDIS",3,0)
 W @IOF
"RTN","OOPSDIS",4,0)
 S CAT=$$GET1^DIQ(2260,IEN,2,"I")
"RTN","OOPSDIS",5,0)
 ;Include logic for Non_PAID employee, CAT=6
"RTN","OOPSDIS",6,0)
 ; Patch 5 - added logic for employee CAT >6
"RTN","OOPSDIS",7,0)
 S SUP=$S((CAT=1!(CAT>6)):" SUPERVISOR.............: ",CAT=2:" VOLUNTARY SVC SUP......: ",CAT=3:" CONTRACT ADMINISTRATOR.: ",1:" SAFETY OFFICER.........: ")
"RTN","OOPSDIS",8,0)
 K DIQ,DA,DR S DIC="^OOPS(2260,",DR=".01:99",DA=IEN,DIQ="OOPS" D EN^DIQ1
"RTN","OOPSDIS",9,0)
 W !,"----------------------------------------------------------------------------"
"RTN","OOPSDIS",10,0)
 W !," CASE NUMBER............: ",OOPS(2260,IEN,.01)
"RTN","OOPSDIS",11,0)
 W !," PERSONNEL STATUS.......: ",OOPS(2260,IEN,2)
"RTN","OOPSDIS",12,0)
 W !," TYPE OF INCIDENT.......: ",OOPS(2260,IEN,3)
"RTN","OOPSDIS",13,0)
 W !," CASE STATUS............: ",OOPS(2260,IEN,51)
"RTN","OOPSDIS",14,0)
 W !," INJURY/ILLNESS.........: ",OOPS(2260,IEN,52)
"RTN","OOPSDIS",15,0)
 W !," PERSON INVOLVED........: ",OOPS(2260,IEN,1)
"RTN","OOPSDIS",16,0)
 W !," SSN....................: ",OOPS(2260,IEN,5)
"RTN","OOPSDIS",17,0)
 W !," DATE OF BIRTH..........: ",OOPS(2260,IEN,6)
"RTN","OOPSDIS",18,0)
 W !," SEX....................: ",OOPS(2260,IEN,7)
"RTN","OOPSDIS",19,0)
 W !," HOME ADDRESS...........: ",OOPS(2260,IEN,8)
"RTN","OOPSDIS",20,0)
 I (OOPS(2260,IEN,9)'="")!(OOPS(2260,IEN,10)'="")!(OOPS(2260,IEN,11)'="") W !,"                          ",OOPS(2260,IEN,9),", ",OOPS(2260,IEN,10)," ",OOPS(2260,IEN,11)
"RTN","OOPSDIS",21,0)
 W !," HOME PHONE NUMBER......: ",OOPS(2260,IEN,12)
"RTN","OOPSDIS",22,0)
 W !," STATION NUMBER.........: ",OOPS(2260,IEN,13)
"RTN","OOPSDIS",23,0)
 W !," COST CENTER/ORG........: ",OOPS(2260,IEN,14)
"RTN","OOPSDIS",24,0)
 W !," OCCUPATION.............: ",OOPS(2260,IEN,15)
"RTN","OOPSDIS",25,0)
 W !," GRADE/STEP.............: ",OOPS(2260,IEN,16) W:OOPS(2260,IEN,16)'="" "/" W OOPS(2260,IEN,17)
"RTN","OOPSDIS",26,0)
 W !," EDUCATION..............: ",OOPS(2260,IEN,18)
"RTN","OOPSDIS",27,0)
 W !,SUP,OOPS(2260,IEN,53)
"RTN","OOPSDIS",28,0)
 W !," SECONDARY SUPERVISOR...: ",OOPS(2260,IEN,53.1)
"RTN","OOPSDIS",29,0)
 W !," DATE/TIME OF OCCURRENCE: ",OOPS(2260,IEN,4)
"RTN","OOPSDIS",30,0)
 W !,"----------------------------------------------------------------------------"
"RTN","OOPSDIS",31,0)
 S SUP=OOPS(2260,IEN,53)
"RTN","OOPSDIS",32,0)
 K OOPS,DIQ,DIC,DR,DA,CAT Q
"RTN","OOPSEMP1")
0^3^B66497929
"RTN","OOPSEMP1",1,0)
OOPSEMP1 ;HINES/WAA,GTD - E/E Employee data Routines - 3/25/98 [ 04/17/1998  3:20 PM ]
"RTN","OOPSEMP1",2,0)
 ;;1.0;ASISTS;**1,3,5**;Jun 01, 1998
"RTN","OOPSEMP1",3,0)
 ;;
"RTN","OOPSEMP1",4,0)
 ;
"RTN","OOPSEMP1",5,0)
 ; Employee/Person Address is now only stored in the 2162A node
"RTN","OOPSEMP1",6,0)
 ; of file 2260.  Prior to patch 3 it was stored in the CA1A and
"RTN","OOPSEMP1",7,0)
 ; CA2A nodes depending on which form was entered.  The address
"RTN","OOPSEMP1",8,0)
 ; is only 'pulled' from this location when printing either form.
"RTN","OOPSEMP1",9,0)
 ;
"RTN","OOPSEMP1",10,0)
EN1(CALLER) ;  Main Entry Point
"RTN","OOPSEMP1",11,0)
 ;INPUT:
"RTN","OOPSEMP1",12,0)
 ;     CALLER = "E" FOR EMPLOYEE
"RTN","OOPSEMP1",13,0)
 ;            = "S" FOR SUPERVISOR
"RTN","OOPSEMP1",14,0)
 ;            = "O" FOR SAFETY OFFICER
"RTN","OOPSEMP1",15,0)
 N SSN,IEN
"RTN","OOPSEMP1",16,0)
 S IEN=0
"RTN","OOPSEMP1",17,0)
 Q:DUZ<1
"RTN","OOPSEMP1",18,0)
 Q:$G(^VA(200,DUZ,1))=""
"RTN","OOPSEMP1",19,0)
 I CALLER="E" D  Q:$G(SSN)=""  Q:$D(^OOPS(2260,"SSN",SSN))<1
"RTN","OOPSEMP1",20,0)
 .S SSN=$P(^VA(200,DUZ,1),U,9)
"RTN","OOPSEMP1",21,0)
 .I '$G(SSN) W !!,"No SSN on file for this Employee" Q
"RTN","OOPSEMP1",22,0)
 .I $D(^OOPS(2260,"SSN",SSN))<1 D
"RTN","OOPSEMP1",23,0)
 ..W !!,"An Accident Report has not been created for this Employee"
"RTN","OOPSEMP1",24,0)
 D  Q:IEN<1
"RTN","OOPSEMP1",25,0)
 .N DIC,X,INT
"RTN","OOPSEMP1",26,0)
 .S DIC="^OOPS(2260,"
"RTN","OOPSEMP1",27,0)
 .I CALLER="E" S DIC("S")="I $$EMP^OOPSUTL1(Y,SSN)"
"RTN","OOPSEMP1",28,0)
 .I CALLER="S" S DIC("S")="I $$SUP^OOPSEMP1(DUZ,Y)"
"RTN","OOPSEMP1",29,0)
 .I CALLER="O" S DIC("S")="I $$SAFE^OOPSEMP1(Y)"
"RTN","OOPSEMP1",30,0)
 . ; Patch 5 - new Personnel status logic, make sure it's an employee
"RTN","OOPSEMP1",31,0)
 .S DIC("S")=DIC("S")_",$$ISEMP^OOPSUTL4(Y)"
"RTN","OOPSEMP1",32,0)
 .S DIC(0)="AEMNZ",DIC("A")="   Select Case: "
"RTN","OOPSEMP1",33,0)
 .D ^DIC
"RTN","OOPSEMP1",34,0)
 .Q:Y<1
"RTN","OOPSEMP1",35,0)
 .Q:$D(DTOUT)!($D(DUOUT))
"RTN","OOPSEMP1",36,0)
 .S IEN=$P(Y,U)
"RTN","OOPSEMP1",37,0)
 .Q
"RTN","OOPSEMP1",38,0)
FORM S FORM=$$GET1^DIQ(2260,IEN,52,"I")
"RTN","OOPSEMP1",39,0)
 S FORM=$S(FORM=1:"CA1",FORM=2:"CA2",1:"")
"RTN","OOPSEMP1",40,0)
 D CLEAR(IEN,FORM)
"RTN","OOPSEMP1",41,0)
 Q:FORM=""
"RTN","OOPSEMP1",42,0)
 D  Q:$D(Y)'=0
"RTN","OOPSEMP1",43,0)
 .N DR,DIE,SIGN2,OOPS
"RTN","OOPSEMP1",44,0)
 .I FORM="CA1" D
"RTN","OOPSEMP1",45,0)
 ..W !!," Federal Employee's Notice of Traumatic Injury and"
"RTN","OOPSEMP1",46,0)
 ..W !," Claim for Continuation of Pay/Compensation (Form CA-1)"
"RTN","OOPSEMP1",47,0)
 ..W !!,"     Employee Data"
"RTN","OOPSEMP1",48,0)
 ..W !,"     -------------"
"RTN","OOPSEMP1",49,0)
 ..K DIQ,DA,DR S DIC="^OOPS(2260,",DR=".01;1;2;4;5;6;7;16;17",DA=IEN,DIQ="OOPS",DIQ(0)="IE"
"RTN","OOPSEMP1",50,0)
 ..D EN^DIQ1
"RTN","OOPSEMP1",51,0)
 ..S DR=""
"RTN","OOPSEMP1",52,0)
 ..; Patch 5 - changed personnel status logic (employee or not)
"RTN","OOPSEMP1",53,0)
 ..S:'$$ISEMP^OOPSUTL4(IEN) DR(1,2260,.1)="1  1. NAME OF EMPLOYEE......"
"RTN","OOPSEMP1",54,0)
 ..S:$$ISEMP^OOPSUTL4(IEN) DR(1,2260,.1)="W !,""  1. NAME OF EMPLOYEE......: "",OOPS(2260,IEN,1,""E"")"
"RTN","OOPSEMP1",55,0)
 ..S DR(1,2260,.2)="W !,""  2. SOCIAL SECURITY NUMBER: "",OOPS(2260,IEN,5,""E"")"
"RTN","OOPSEMP1",56,0)
 ..S:'$$ISEMP^OOPSUTL4(IEN) DR(1,2260,.3)="6  3. DATE OF BIRTH.........;I X="""" S Y=7"
"RTN","OOPSEMP1",57,0)
 ..S:'$$ISEMP^OOPSUTL4(IEN) DR(1,2260,.35)="S DIN=$$GET1^DIQ(2260,IEN,4,""I"")\1 I DIN<X W !!?10,""This date cannot be after ""_$$FMTE^XLFDT(DIN),! S Y=6"
"RTN","OOPSEMP1",58,0)
 ..S:$$ISEMP^OOPSUTL4(IEN) DR(1,2260,.3)="W !,""  3. DATE OF BIRTH.........: "",OOPS(2260,IEN,6,""E"")"
"RTN","OOPSEMP1",59,0)
 ..S:'$$ISEMP^OOPSUTL4(IEN) DR(1,2260,.4)="7  4. SEX..................."
"RTN","OOPSEMP1",60,0)
 ..S:$$ISEMP^OOPSUTL4(IEN) DR(1,2260,.4)="W !,""  4. SEX...................: "",OOPS(2260,IEN,7,""E"")"
"RTN","OOPSEMP1",61,0)
 ..S DR(1,2260,1)="12  5. HOME TELEPHONE........"
"RTN","OOPSEMP1",62,0)
 ..S DR(1,2260,2)="W !,""  6. GRADE/STEP............: "",OOPS(2260,IEN,16,""E""),""/"",OOPS(2260,IEN,17,""E"")"
"RTN","OOPSEMP1",63,0)
 ..S DR(1,2260,3)="W !,""  7. EMPLOYEE'S HOME MAILING ADDRESS:"""
"RTN","OOPSEMP1",64,0)
 ..S DR(1,2260,4)="8     STREET ADDRESS........"
"RTN","OOPSEMP1",65,0)
 ..S DR(1,2260,5)="9     CITY.................."
"RTN","OOPSEMP1",66,0)
 ..S DR(1,2260,6)="10     STATE................."
"RTN","OOPSEMP1",67,0)
 ..S DR(1,2260,7)="11     ZIP CODE.............."
"RTN","OOPSEMP1",68,0)
 ..S DR(1,2260,8)="107  8. DEPENDENTS............"
"RTN","OOPSEMP1",69,0)
 ..S DR(1,2260,8.1)="W !!,""     Description of Injury"""
"RTN","OOPSEMP1",70,0)
 ..S DR(1,2260,8.2)="W !,""     ---------------------"""
"RTN","OOPSEMP1",71,0)
 ..S DR(1,2260,9)="108  9. PLACE WHERE INJURY OCCURRED"
"RTN","OOPSEMP1",72,0)
 ..;
"RTN","OOPSEMP1",73,0)
 ..;Default the Date/Time Injury Occurred from the 2162
"RTN","OOPSEMP1",74,0)
 ..S DR(1,2260,10)="109 10. DATE/TIME INJURY OCCURRED..//^S X=OOPS(2260,IEN,4,""E"")"
"RTN","OOPSEMP1",75,0)
 ..S DR(1,2260,10.1)="I $P(X,""."",2)="""" W !,""Time is REQUIRED in this response."" S Y=109"
"RTN","OOPSEMP1",76,0)
 ..S DR(1,2260,10.5)="I X'="""",'$$FUT^OOPSUTL4($P(X,""."")) S Y=109"
"RTN","OOPSEMP1",77,0)
 ..S DR(1,2260,11)="110 11. DATE OF THIS NOTICE........;I X="""" S Y=111"
"RTN","OOPSEMP1",78,0)
 ..S DR(1,2260,11.5)="I X'="""",'$$FUT^OOPSUTL4($P(X,""."")) S Y=110"
"RTN","OOPSEMP1",79,0)
 ..S DR(1,2260,12)="111 12. EMPLOYEE'S OCCUPATION......"
"RTN","OOPSEMP1",80,0)
 ..S DR(1,2260,13)="112 13. CAUSE OF INJURY............"
"RTN","OOPSEMP1",81,0)
 ..S DR(1,2260,14)="113 14. NATURE OF INJURY..........."
"RTN","OOPSEMP1",82,0)
 ..S DR(1,2260,14.1)="W !!,""     Employee Signature"""
"RTN","OOPSEMP1",83,0)
 ..S DR(1,2260,14.2)="W !,""     ------------------"""
"RTN","OOPSEMP1",84,0)
 ..S DR(1,2260,15)="114 15. REQUEST PAY OR LEAVE......."
"RTN","OOPSEMP1",85,0)
 ..S DR(1,2260,16)="W !!,""     Witness"""
"RTN","OOPSEMP1",86,0)
 ..S DR(1,2260,17)="W !,""     -------"""
"RTN","OOPSEMP1",87,0)
 ..S DR(1,2260,18)="115 16. NAME OF WITNESS............"
"RTN","OOPSEMP1",88,0)
 ..Q
"RTN","OOPSEMP1",89,0)
 .I FORM="CA2" D
"RTN","OOPSEMP1",90,0)
 ..W !!," Notice of Occupational Disease and Claim for Compensation (Form CA-2)"
"RTN","OOPSEMP1",91,0)
 ..W !!,"     Employee Data"
"RTN","OOPSEMP1",92,0)
 ..W !,"     -------------"
"RTN","OOPSEMP1",93,0)
 ..K DIQ,DA,DR S DIC="^OOPS(2260,",DR=".01;1;2;5;6;7;16;17",DA=IEN,DIQ="OOPS",DIQ(0)="IE"
"RTN","OOPSEMP1",94,0)
 ..D EN^DIQ1
"RTN","OOPSEMP1",95,0)
 ..S DR=""
"RTN","OOPSEMP1",96,0)
 ..; Patch 5 - changed Personnel Status logic - employee or not
"RTN","OOPSEMP1",97,0)
 ..S:'$$ISEMP^OOPSUTL4(IEN) DR(1,2260,.1)="1  1. NAME OF EMPLOYEE......"
"RTN","OOPSEMP1",98,0)
 ..S:$$ISEMP^OOPSUTL4(IEN) DR(1,2260,.1)="W !,""  1. NAME OF EMPLOYEE......: "",OOPS(2260,IEN,1,""E"")"
"RTN","OOPSEMP1",99,0)
 ..S DR(1,2260,.2)="W !,""  2. SOCIAL SECURITY NUMBER: "",OOPS(2260,IEN,5,""E"")"
"RTN","OOPSEMP1",100,0)
 ..S:'$$ISEMP^OOPSUTL4(IEN) DR(1,2260,.3)="6  3. DATE OF BIRTH.........;I X="""" S Y=7"
"RTN","OOPSEMP1",101,0)
 ..S:'$$ISEMP^OOPSUTL4(IEN) DR(1,2260,.35)="S DIN=$$GET1^DIQ(2260,IEN,4,""I"")\1 I DIN<X W !!?10,""This date cannot be after ""_$$FMTE^XLFDT(DIN),! S Y=6"
"RTN","OOPSEMP1",102,0)
 ..S:$$ISEMP^OOPSUTL4(IEN) DR(1,2260,.3)="W !,""  3. DATE OF BIRTH.........: "",OOPS(2260,IEN,6,""E"")"
"RTN","OOPSEMP1",103,0)
 ..S:'$$ISEMP^OOPSUTL4(IEN) DR(1,2260,.4)="7  4. SEX..................."
"RTN","OOPSEMP1",104,0)
 ..S:$$ISEMP^OOPSUTL4(IEN) DR(1,2260,.4)="W !,""  4. SEX...................: "",OOPS(2260,IEN,7,""E"")"
"RTN","OOPSEMP1",105,0)
 ..S DR(1,2260,1)="12  5. HOME TELEPHONE........"
"RTN","OOPSEMP1",106,0)
 ..S DR(1,2260,2)="W !,""  6. GRADE/STEP............: "",OOPS(2260,IEN,16,""E""),""/"",OOPS(2260,IEN,17,""E"")"
"RTN","OOPSEMP1",107,0)
 ..S DR(1,2260,3)="W !,""  7. EMPLOYEE'S HOME MAILING ADDRESS:"""
"RTN","OOPSEMP1",108,0)
 ..S DR(1,2260,4)="8     STREET ADDRESS........"
"RTN","OOPSEMP1",109,0)
 ..S DR(1,2260,5)="9     CITY.................."
"RTN","OOPSEMP1",110,0)
 ..S DR(1,2260,6)="10     STATE................."
"RTN","OOPSEMP1",111,0)
 ..S DR(1,2260,7)="11     ZIP CODE.............."
"RTN","OOPSEMP1",112,0)
 ..S DR(1,2260,8)="207  8. DEPENDENTS............"
"RTN","OOPSEMP1",113,0)
 ..S DR(1,2260,8.1)="W !!,""     Claim Information"""
"RTN","OOPSEMP1",114,0)
 ..S DR(1,2260,8.2)="W !,""     -----------------"""
"RTN","OOPSEMP1",115,0)
 ..S DR(1,2260,9)="208  9. EMPLOYEE'S OCCUPATION."
"RTN","OOPSEMP1",116,0)
 ..S DR(1,2260,9.1)="W !,"" 10. LOCATION WHERE YOU WORKED WHEN DISEASE OR ILLNESS OCCURRED:"""
"RTN","OOPSEMP1",117,0)
 ..S DR(1,2260,10)="209     LOCATION..............;I X="""" S Y=214;"
"RTN","OOPSEMP1",118,0)
 ..S DR(1,2260,11)="210     STREET ADDRESS........"
"RTN","OOPSEMP1",119,0)
 ..S DR(1,2260,12)="211     CITY.................."
"RTN","OOPSEMP1",120,0)
 ..S DR(1,2260,13)="212     STATE................."
"RTN","OOPSEMP1",121,0)
 ..S DR(1,2260,14)="213     ZIP CODE.............."
"RTN","OOPSEMP1",122,0)
 ..S DR(1,2260,15)="214 11. DATE YOU FIRST BECAME AWARE OF DISEASE OR ILLNESS;I X="""" S Y=215"
"RTN","OOPSEMP1",123,0)
 ..S DR(1,2260,15.5)="I X'="""",'$$FUT^OOPSUTL4($P(X,""."")) S Y=214"
"RTN","OOPSEMP1",124,0)
 ..S DR(1,2260,16)="215 12. DATE YOU FIRST REALIZED THE DISEASE OR ILLNESS WAS CAUSED BY OR AGGRAVATED      BY YOUR EMPLOYMENT;I X="""" S Y=216"
"RTN","OOPSEMP1",125,0)
 ..S DR(1,2260,16.5)="I X'="""",'$$FUT^OOPSUTL4($P(X,""."")) S Y=215"
"RTN","OOPSEMP1",126,0)
 ..S DR(1,2260,17)="216 13. EXPLAIN THE RELATIONSHIP TO YOUR EMPLOYMENT, AND WHY YOU CAME TO THIS           REALIZATION~"
"RTN","OOPSEMP1",127,0)
 ..S DR(1,2260,17.1)="W !"
"RTN","OOPSEMP1",128,0)
 ..S DR(1,2260,18)="217 14. NATURE OF DISEASE OR ILLNESS~"
"RTN","OOPSEMP1",129,0)
 ..S DR(1,2260,18.1)="W !"
"RTN","OOPSEMP1",130,0)
 ..S DR(1,2260,19)="218 15. IF THIS NOTICE AND CLAIM WAS NOT FILED WITH THE EMPLOYING AGENCY WITHIN         30 DAYS AFTER DATE SHOWN ABOVE IN ITEM #12, EXPLAIN THE REASON FOR THE          DELAY~"
"RTN","OOPSEMP1",131,0)
 ..S DR(1,2260,19.1)="W !"
"RTN","OOPSEMP1",132,0)
 ..S DR(1,2260,20)="219 16. IF A SEPARATE NARRATIVE STATEMENT IS NOT SUBMITTED WITH THIS FORM, EXPLAIN      REASON FOR DELAY~"
"RTN","OOPSEMP1",133,0)
 ..S DR(1,2260,20.1)="W !"
"RTN","OOPSEMP1",134,0)
 ..S DR(1,2260,21)="220 17. IF MEDICAL REPORTS ARE NOT SUBMITTED WITH THIS FORM, EXPLAIN REASON FOR         DELAY~"
"RTN","OOPSEMP1",135,0)
 ..Q
"RTN","OOPSEMP1",136,0)
 .S DIE="^OOPS(2260,",DA=IEN
"RTN","OOPSEMP1",137,0)
 .D ^DIE
"RTN","OOPSEMP1",138,0)
 .I $D(Y)'=0 Q
"RTN","OOPSEMP1",139,0)
 .N SIGN
"RTN","OOPSEMP1",140,0)
 .D SIGN(FORM)
"RTN","OOPSEMP1",141,0)
 .Q:SIGN=""                   ; Form was not signed
"RTN","OOPSEMP1",142,0)
 .I $P(SIGN,U) D
"RTN","OOPSEMP1",143,0)
 ..I FORM="CA1" S $P(^OOPS(2260,IEN,"CA1ES"),U,1,3)=SIGN
"RTN","OOPSEMP1",144,0)
 ..I FORM="CA2" S $P(^OOPS(2260,IEN,"CA2ES"),U,1,3)=SIGN
"RTN","OOPSEMP1",145,0)
 ..D EMP^OOPSMBUL(IEN)
"RTN","OOPSEMP1",146,0)
 ..Q
"RTN","OOPSEMP1",147,0)
 .Q
"RTN","OOPSEMP1",148,0)
 K HSA,CIT,STA,ZIP Q
"RTN","OOPSEMP1",149,0)
CLEAR(IEN,FORM) ; Clear out the old ES
"RTN","OOPSEMP1",150,0)
 N ES
"RTN","OOPSEMP1",151,0)
 S ES=$S(FORM="CA1":"CA1ES",FORM="CA2":"CA2ES",1:0) Q:ES=0
"RTN","OOPSEMP1",152,0)
 Q:$GET(^OOPS(2260,IEN,ES))=""
"RTN","OOPSEMP1",153,0)
 Q:$P(^OOPS(2260,IEN,ES),U,1,3)="^^"
"RTN","OOPSEMP1",154,0)
 S $P(^OOPS(2260,IEN,ES),U,1,3)="^^"
"RTN","OOPSEMP1",155,0)
 W !,"Your ES has been cleared.  You will need to resign.",!
"RTN","OOPSEMP1",156,0)
 Q
"RTN","OOPSEMP1",157,0)
SAFE(IEN) ; Safety Officer Screen
"RTN","OOPSEMP1",158,0)
 N VIEW,FORM,TYPE
"RTN","OOPSEMP1",159,0)
 S VIEW=1
"RTN","OOPSEMP1",160,0)
 S (TYPE,FORM)=$$GET1^DIQ(2260,IEN,52,"I"),FORM=$S(FORM=1:"CA1",FORM=2:"CA2",1:"")
"RTN","OOPSEMP1",161,0)
 I $P($$EDSTA^OOPSUTL1(IEN,"E"),U,TYPE) S VIEW=0 ; Employee Signed
"RTN","OOPSEMP1",162,0)
 I $P($$EDSTA^OOPSUTL1(IEN,"S"),U,TYPE) S VIEW=0 ; Super Signed
"RTN","OOPSEMP1",163,0)
 I $$GET1^DIQ(2260,IEN,51,"I")'=0 S VIEW=0 ; Case is not open
"RTN","OOPSEMP1",164,0)
 Q VIEW
"RTN","OOPSEMP1",165,0)
SUP(DUZ,IEN) ; Supervisor Screen
"RTN","OOPSEMP1",166,0)
 N VIEW,FORM,SIGN,FORMS
"RTN","OOPSEMP1",167,0)
 S VIEW=1
"RTN","OOPSEMP1",168,0)
 S (FORMS,FORM)=$$GET1^DIQ(2260,IEN,52,"I"),FORM=$S(FORM=1:"CA1",FORM=2:"CA2",1:"")
"RTN","OOPSEMP1",169,0)
 I $P($$EDSTA^OOPSUTL1(IEN,"E"),U,FORMS) S VIEW=0 ; Employee Signed
"RTN","OOPSEMP1",170,0)
 I $P($$EDSTA^OOPSUTL1(IEN,"S"),U,FORMS) S VIEW=0 ; Super Signed
"RTN","OOPSEMP1",171,0)
 I $$GET1^DIQ(2260,IEN,51,"I")'=0 S VIEW=0 ; Case is not open
"RTN","OOPSEMP1",172,0)
 I $$GET1^DIQ(2260,IEN,53,"I")'=DUZ,$$GET1^DIQ(2260,IEN,53.1,"I")'=DUZ S VIEW=0 ; Not Supervisor for case
"RTN","OOPSEMP1",173,0)
 Q VIEW
"RTN","OOPSEMP1",174,0)
SIGN(FORM) ; Sign/validate Document
"RTN","OOPSEMP1",175,0)
 N EMP,INC,VALID
"RTN","OOPSEMP1",176,0)
 S VALID=0,SIGN=""
"RTN","OOPSEMP1",177,0)
 S INC=$$GET1^DIQ(2260,IEN,52,"I")
"RTN","OOPSEMP1",178,0)
 W ! D VALIDATE^OOPSUTL4(IEN,FORM,"E",.VALID)
"RTN","OOPSEMP1",179,0)
 I 'VALID Q
"RTN","OOPSEMP1",180,0)
 I CALLER="E" S SIGN=$$SIG^OOPSESIG(DUZ,IEN)
"RTN","OOPSEMP1",181,0)
 Q
"RTN","OOPSLOG")
0^6^B29138214
"RTN","OOPSLOG",1,0)
OOPSLOG ;HINES CIOFO/GB-Log of Federal Occupational Injuries and Illnesses;8/15/96
"RTN","OOPSLOG",2,0)
 ;;1.0;ASISTS;**1,2,5**;Jun 01, 1998
"RTN","OOPSLOG",3,0)
 N CN,CL,DA,DASHES,DATE,EV,EX,FCILL,FCINJ,FCINJILL,FYR,FY,HDR,HDR1
"RTN","OOPSLOG",4,0)
 N HDR2,ILL,INC,INJ,INJILL,LIN,LP1,LTILL,LTINJ,LTINJILL,LYR,OUT,PG,STA
"RTN","OOPSLOG",5,0)
 S CN=0 F  S CN=$O(^OOPS(2260,"B",CN)) Q:CN'>0  S CL($E(CN,1,4))=""
"RTN","OOPSLOG",6,0)
 Q:'$D(CL)
"RTN","OOPSLOG",7,0)
 S FYR=$O(CL(0)),LYR=$O(CL(""),-1)
"RTN","OOPSLOG",8,0)
 K DIR S DIR(0)="N^"_FYR_":"_LYR,DIR("A")="Fiscal Year"
"RTN","OOPSLOG",9,0)
 S DIR("?")="Enter a fiscal year from the above range"
"RTN","OOPSLOG",10,0)
 D ^DIR K DIR
"RTN","OOPSLOG",11,0)
 Q:$D(DIRUT)
"RTN","OOPSLOG",12,0)
 S FY=Y
"RTN","OOPSLOG",13,0)
 I $D(EV) S INC=0,HDR1="Employees and volunteers only" G DEV
"RTN","OOPSLOG",14,0)
 K DIR S DIR(0)="SA^E/V:Employees and volunteers only;A:All cases",DIR("A")="Cases to be included: " D ^DIR K DIR
"RTN","OOPSLOG",15,0)
 Q:$D(DIRUT)
"RTN","OOPSLOG",16,0)
 S EV=Y
"RTN","OOPSLOG",17,0)
 K DIR S DIR(0)="Y",DIR("A")="Include names of persons involved",DIR("B")="Yes" D ^DIR K DIR
"RTN","OOPSLOG",18,0)
 Q:$D(DIRUT)
"RTN","OOPSLOG",19,0)
 S INC=Y
"RTN","OOPSLOG",20,0)
 ; Patch 5 -Get Station Number
"RTN","OOPSLOG",21,0)
 S OUT=""
"RTN","OOPSLOG",22,0)
 D STATION(.STA,.OUT)
"RTN","OOPSLOG",23,0)
 Q:$D(DIRUT)!(OUT)
"RTN","OOPSLOG",24,0)
DEV K IOP,%ZIS S %ZIS="MQ" W ! D ^%ZIS K %ZIS,IOP G:POP EXIT
"RTN","OOPSLOG",25,0)
 I $D(IO("Q")) D TASK G EXIT
"RTN","OOPSLOG",26,0)
 U IO D PRT D ^%ZISC K %ZIS,IOP G EXIT
"RTN","OOPSLOG",27,0)
PRT S PG=0
"RTN","OOPSLOG",28,0)
 S (INJ,ILL,FCINJ,FCILL,LTINJ,LTILL)=0
"RTN","OOPSLOG",29,0)
 S EX="",LIN=$S(IOST?1"C".E:IOSL-5,1:IOSL-6)
"RTN","OOPSLOG",30,0)
 K DASHES S $P(DASHES,"-",80)="-"
"RTN","OOPSLOG",31,0)
 D NOW^%DTC S DATE=%,Y=DATE X ^DD("DD") S DATE=Y
"RTN","OOPSLOG",32,0)
 S HDR=$S($G(NS):"Log of Needlestick Incidents for Fiscal Year ",1:"Log of Federal Occupational Injuries and Illnesses for Fiscal Year ")
"RTN","OOPSLOG",33,0)
 S HDR1=$S(EV="E/V":"Employees and volunteers only",1:"All cases")
"RTN","OOPSLOG",34,0)
 ; Patch 5 - change for Station Number looping
"RTN","OOPSLOG",35,0)
 S LP1=""
"RTN","OOPSLOG",36,0)
 I STA="A" D  Q
"RTN","OOPSLOG",37,0)
 . F  S LP1=$O(^OOPS(2260,"D",LP1)) Q:LP1=""!(EX=U)  D HDR D
"RTN","OOPSLOG",38,0)
 .. S DA=0 F  S DA=$O(^OOPS(2260,"D",LP1,DA)) D:DA="" LOGSUM Q:DA=""!(EX=U)  D DATA
"RTN","OOPSLOG",39,0)
 I STA'="A" D  Q
"RTN","OOPSLOG",40,0)
 . S LP1=STA
"RTN","OOPSLOG",41,0)
 . D HDR
"RTN","OOPSLOG",42,0)
 . S DA=0 F  S DA=$O(^OOPS(2260,"D",LP1,DA)) D:DA="" LOGSUM Q:DA=""!(EX=U)  D DATA
"RTN","OOPSLOG",43,0)
EXIT ; Clean up and exit
"RTN","OOPSLOG",44,0)
 K POP,X,Y,%,NS
"RTN","OOPSLOG",45,0)
 Q
"RTN","OOPSLOG",46,0)
DATA ;
"RTN","OOPSLOG",47,0)
 N CASE,OOPS,YR,DIC,DIQ,DR
"RTN","OOPSLOG",48,0)
 S CASE=$$GET1^DIQ(2260,DA,.01)
"RTN","OOPSLOG",49,0)
 S YR=$E(CASE,1,4)
"RTN","OOPSLOG",50,0)
 I FY'="",(FY'=YR) Q
"RTN","OOPSLOG",51,0)
 K OOPS
"RTN","OOPSLOG",52,0)
 S DIC="^OOPS(2260,"
"RTN","OOPSLOG",53,0)
 S DR=".01;2;3;4;1;15;14;29;30;33;51;52"
"RTN","OOPSLOG",54,0)
 S DIQ="OOPS",DIQ(0)="IE" D EN^DIQ1
"RTN","OOPSLOG",55,0)
 I $G(NS),OOPS(2260,DA,3,"I")<11 Q
"RTN","OOPSLOG",56,0)
 I EV="E/V","1,2,6,"'[OOPS(2260,DA,2,"I")_"," Q
"RTN","OOPSLOG",57,0)
 Q:OOPS(2260,DA,51,"E")="Deleted"
"RTN","OOPSLOG",58,0)
 Q:OOPS(2260,DA,51,"E")="Replaced by amendment"
"RTN","OOPSLOG",59,0)
 I OOPS(2260,DA,52,"E")="Injury" S INJ=INJ+1
"RTN","OOPSLOG",60,0)
 S:OOPS(2260,DA,29,"E")="Death" FCINJ=FCINJ+1
"RTN","OOPSLOG",61,0)
 S:OOPS(2260,DA,33,"E")="Yes" LTINJ=LTINJ+1
"RTN","OOPSLOG",62,0)
 I OOPS(2260,DA,52,"E")="Illness/disease" S ILL=ILL+1
"RTN","OOPSLOG",63,0)
 S:OOPS(2260,DA,29,"E")="Death" FCILL=FCILL+1
"RTN","OOPSLOG",64,0)
 S:OOPS(2260,DA,33,"E")="Yes" LTILL=LTILL+1
"RTN","OOPSLOG",65,0)
 S:INC=0 OOPS(2260,DA,1,"E")="",OOPS(2260,DA,15,"E")="",OOPS(2260,DA,14,"E")=""
"RTN","OOPSLOG",66,0)
 W !,CASE,?12,$P(OOPS(2260,DA,4,"E"),"@",1),?26,OOPS(2260,DA,1,"E"),?57,OOPS(2260,DA,15,"E"),?63,OOPS(2260,DA,14,"E"),?74,OOPS(2260,DA,33,"E")
"RTN","OOPSLOG",67,0)
 W !,OOPS(2260,DA,52,"E"),?26,OOPS(2260,DA,3,"E")
"RTN","OOPSLOG",68,0)
 W !,?26,OOPS(2260,DA,29,"E")
"RTN","OOPSLOG",69,0)
 W !,OOPS(2260,DA,51,"E"),?26,OOPS(2260,DA,30,"E")
"RTN","OOPSLOG",70,0)
 W !,DASHES
"RTN","OOPSLOG",71,0)
 Q
"RTN","OOPSLOG",72,0)
LOGSUM ;Log Summary
"RTN","OOPSLOG",73,0)
 I IOST?1"C".E,$Y>14 D  Q:EX=U
"RTN","OOPSLOG",74,0)
 .W ! K DIR S DIR(0)="E" D ^DIR I 'Y S EX=U Q
"RTN","OOPSLOG",75,0)
 .W @IOF S PG=PG+1
"RTN","OOPSLOG",76,0)
 .W !,HDR,FY,?72,"Page",$S($L(PG)=2:" ",1:"  "),PG
"RTN","OOPSLOG",77,0)
 .W !,DASHES
"RTN","OOPSLOG",78,0)
 W !,"Log Summary" D P Q:EX=U
"RTN","OOPSLOG",79,0)
 W !,DASHES D P Q:EX=U
"RTN","OOPSLOG",80,0)
 W !,"Injuries.: ",$J(INJ,3),?16,"Fatal Injuries....: ",$J(FCINJ,3)
"RTN","OOPSLOG",81,0)
 W ?41,"Lost Time Injuries....: ",$J(LTINJ,3) D P Q:EX=U
"RTN","OOPSLOG",82,0)
 W !,"Illnesses: ",$J(ILL,3),?16,"Fatal Illnesses...: ",$J(FCILL,3)
"RTN","OOPSLOG",83,0)
 W ?41,"Lost Time Illnesses...: ",$J(LTILL,3) D P Q:EX=U
"RTN","OOPSLOG",84,0)
 W !,"--------------",?16,"-----------------------",?41,"---------------------------" D P Q:EX=U
"RTN","OOPSLOG",85,0)
 S INJILL=INJ+ILL,FCINJILL=FCINJ+FCILL,LTINJILL=LTINJ+LTILL
"RTN","OOPSLOG",86,0)
 W !,"Total....: ",$J(INJILL,3),?16,"Total.............: ",$J(FCINJILL,3)
"RTN","OOPSLOG",87,0)
 W ?41,"Total.................: ",$J(LTINJILL,3)
"RTN","OOPSLOG",88,0)
 W !,DASHES
"RTN","OOPSLOG",89,0)
 I IOST?1"C".E W ! K DIR S DIR(0)="E" D ^DIR I 'Y S EX=U Q
"RTN","OOPSLOG",90,0)
 S (INJ,FCINJ,LTINJ,ILL,FCILL,LTILL,INJILL,FCINJILL,LTINJILL)=0
"RTN","OOPSLOG",91,0)
 Q
"RTN","OOPSLOG",92,0)
P ;Display Data
"RTN","OOPSLOG",93,0)
 I $Y'<LIN D  Q:EX=U
"RTN","OOPSLOG",94,0)
 .I IOST?1"C".E W ! K DIR S DIR(0)="E" D ^DIR I 'Y S EX=U Q
"RTN","OOPSLOG",95,0)
 .D HDR
"RTN","OOPSLOG",96,0)
 Q
"RTN","OOPSLOG",97,0)
TASK ;Queue a task
"RTN","OOPSLOG",98,0)
 K IO("Q"),ZTUCI,ZTDTH,ZTIO,ZTSAVE
"RTN","OOPSLOG",99,0)
 S ZTRTN="PRT^OOPSLOG",ZTREQ="@",ZTSAVE("ZTREQ")=""
"RTN","OOPSLOG",100,0)
 S ZTDESC="Log of Federal Occupational Injuries and Illnesses"
"RTN","OOPSLOG",101,0)
 S ZTSAVE("FY")="",ZTSAVE("INC")="",ZTSAVE("NS")="",ZTSAVE("EV")=""
"RTN","OOPSLOG",102,0)
 ; Patch 5 - added STA
"RTN","OOPSLOG",103,0)
 S ZTSAVE("STA")=""
"RTN","OOPSLOG",104,0)
 D ^%ZTLOAD D ^%ZISC U IO W !,"Request Queued",!
"RTN","OOPSLOG",105,0)
 K ZTSK Q
"RTN","OOPSLOG",106,0)
HDR ;Header
"RTN","OOPSLOG",107,0)
 S HDR2="Station Number: "_$$GET1^DIQ(4,LP1,.01,"E")
"RTN","OOPSLOG",108,0)
 W @IOF S PG=PG+1
"RTN","OOPSLOG",109,0)
 W !,HDR,FY,?72,"Page",$S($L(PG)=2:" ",1:"  "),PG
"RTN","OOPSLOG",110,0)
 W !?(40-($L(HDR2)/2)),HDR2,!,HDR1
"RTN","OOPSLOG",111,0)
 W !?74,"Lost"
"RTN","OOPSLOG",112,0)
 W:INC=1 !,"Case #      Date          Name                           Occ   CC/Org     time"
"RTN","OOPSLOG",113,0)
 W:INC=0 !,"Case #      Date                                                          time"
"RTN","OOPSLOG",114,0)
 W !,DASHES
"RTN","OOPSLOG",115,0)
 Q
"RTN","OOPSLOG",116,0)
STATION(STA,OUT) ; Get 'ALL' or one station
"RTN","OOPSLOG",117,0)
 S STA=""
"RTN","OOPSLOG",118,0)
 N DIC,DIR,DIRUT,Y
"RTN","OOPSLOG",119,0)
 S DIR(0)="Y",DIR("A")="Run report for 'ALL' Stations",DIR("B")="Yes"
"RTN","OOPSLOG",120,0)
 S DIR("?")="Enter 'Y'es to run for all Stations or 'N'o to run "
"RTN","OOPSLOG",121,0)
 S DIR("?")=DIR("?")_"for just one Station."
"RTN","OOPSLOG",122,0)
 D ^DIR I Y S STA="A" Q
"RTN","OOPSLOG",123,0)
 I $D(DIRUT)!($D(DUOUT)) S OUT=1 Q
"RTN","OOPSLOG",124,0)
S1 ; if get here user <CR>
"RTN","OOPSLOG",125,0)
 S DIC("A")="Select STATION NUMBER: "
"RTN","OOPSLOG",126,0)
 S DIC="^DIC(4,",DIC(0)="AEMQZ"
"RTN","OOPSLOG",127,0)
 D ^DIC
"RTN","OOPSLOG",128,0)
 I $D(DUOUT) S OUT=1 Q
"RTN","OOPSLOG",129,0)
 I Y=-1 W !?5,"No Station selected, report will not run" S OUT=1 Q
"RTN","OOPSLOG",130,0)
 S STA=+Y
"RTN","OOPSLOG",131,0)
 I '$D(^OOPS(2260,"D",STA)) W !?5,"No data for that Station Number, Please select again." G S1
"RTN","OOPSLOG",132,0)
 Q
"RTN","OOPSNDB")
0^15^B37956155
"RTN","OOPSNDB",1,0)
OOPSNDB ; WISC/LLH - NATIONAL DATABASE; 10/12/99
"RTN","OOPSNDB",2,0)
 ;;1.0;ASISTS;**5**;Jun 01, 1998
"RTN","OOPSNDB",3,0)
 ;
"RTN","OOPSNDB",4,0)
 N ARR,FIELD,FL,MSG,VAL
"RTN","OOPSNDB",5,0)
 I '$D(^XUSEC("OOPS XMIT 2162 DATA",DUZ)) D  G EXIT
"RTN","OOPSNDB",6,0)
 . S DIR(0)="FO" W !
"RTN","OOPSNDB",7,0)
 . S DIR("A")="You do NOT have the required Security Key."
"RTN","OOPSNDB",8,0)
 . S DIR("A")=DIR("A")_"  Press Enter to continue"
"RTN","OOPSNDB",9,0)
 . D ^DIR K DIR
"RTN","OOPSNDB",10,0)
 ; Assure the Queue (Q-ASI) has been defined
"RTN","OOPSNDB",11,0)
 S VAL="Q-ASI.MED.VA.GOV",FIELD=.01,FL="X"
"RTN","OOPSNDB",12,0)
 D FIND^DIC(4.2,"",FIELD,FL,VAL,"","","","","ARR")
"RTN","OOPSNDB",13,0)
 I '$D(ARR("DILIST",1)) D  G EXIT
"RTN","OOPSNDB",14,0)
 . S DIR(0)="FO" W !
"RTN","OOPSNDB",15,0)
 . S DIR("A")="Domain not found in the DOMAIN File,"
"RTN","OOPSNDB",16,0)
 . S DIR("A")=DIR("A")_" No Transmission. Press Enter to continue"
"RTN","OOPSNDB",17,0)
 . D ^DIR K DIR
"RTN","OOPSNDB",18,0)
 S DIR(0)="Y",DIR("B")="Y",DIR("A")="Do you want to Queue Transmission"
"RTN","OOPSNDB",19,0)
 S DIR("?",1)="Enter 'Y' if you want the 2162 data placed in mail"
"RTN","OOPSNDB",20,0)
 S DIR("?")="messages as part of a tasked job."
"RTN","OOPSNDB",21,0)
 D ^DIR K DIR G:$D(DIRUT) EXIT I Y D  G EXIT
"RTN","OOPSNDB",22,0)
 . S ZTRTN="EN^OOPSNDB",ZTIO=""
"RTN","OOPSNDB",23,0)
 . S ZTDESC="TRAMSIT NATIONAL DATABASE 2162 DATA"
"RTN","OOPSNDB",24,0)
 . D ^%ZTLOAD
"RTN","OOPSNDB",25,0)
 S DIR(0)="Y"
"RTN","OOPSNDB",26,0)
 S DIR("A")="Transmission NOT queued, OK to continue"
"RTN","OOPSNDB",27,0)
 D ^DIR K DIR I 'Y G EXIT
"RTN","OOPSNDB",28,0)
 S MSG("DIHELP",1)="Processing" W !
"RTN","OOPSNDB",29,0)
 D MSG^DIALOG("WH","","","","MSG")
"RTN","OOPSNDB",30,0)
EN ; Routine Entry
"RTN","OOPSNDB",31,0)
 N CNT,ERR,ERROR,FAIL,OPMG,OPQ
"RTN","OOPSNDB",32,0)
 K VMSG,INV                     ; used for data validation of records
"RTN","OOPSNDB",33,0)
 S CTR=1                        ; counter for Mail message array
"RTN","OOPSNDB",34,0)
 S (START,END,FAIL)=""
"RTN","OOPSNDB",35,0)
 ; Assure the Queue (Q-ASI) has been defined
"RTN","OOPSNDB",36,0)
 S VAL="Q-ASI.MED.VA.GOV",FIELD=.01,FL="X"
"RTN","OOPSNDB",37,0)
 D FIND^DIC(4.2,"",FIELD,FL,VAL,"","","","","ARR")
"RTN","OOPSNDB",38,0)
 I '$D(ARR("DILIST",1)) D  G EXIT
"RTN","OOPSNDB",39,0)
 . S ERROR(1)="The Queue Q-ASI.MED.VA.GOV has not been created."
"RTN","OOPSNDB",40,0)
 . S ERROR(2)="Install Patch XM*999*130, complete manual "
"RTN","OOPSNDB",41,0)
 . S ERROR(3)="Transmission of NDB Data."
"RTN","OOPSNDB",42,0)
 . D ERROR
"RTN","OOPSNDB",43,0)
 ; Make sure Mail Group Exists
"RTN","OOPSNDB",44,0)
 S OPMG=$$FIND1^DIC(3.8,"","X","OOPS NDB MESSAGES")
"RTN","OOPSNDB",45,0)
 I 'OPMG D  G EXIT
"RTN","OOPSNDB",46,0)
 . S ERROR(1)="The Mail Group OOPS NDB MESSAGES is missing."
"RTN","OOPSNDB",47,0)
 . S ERROR(2)="Add the Group so that ASISTS data can be transmitted "
"RTN","OOPSNDB",48,0)
 . S ERROR(3)="to the AAC.  Then contact IRM to complete manual "
"RTN","OOPSNDB",49,0)
 . S ERROR(4)="Transmission of NDB Data."
"RTN","OOPSNDB",50,0)
 . D ERROR
"RTN","OOPSNDB",51,0)
 ; Get list of members
"RTN","OOPSNDB",52,0)
 D LIST^DIC(3.81,","_OPMG_",","","",1,"","","","","","OPQ")
"RTN","OOPSNDB",53,0)
 I '$P(OPQ("DILIST",0),U) D  G EXIT
"RTN","OOPSNDB",54,0)
 . S ERROR(1)="There are no members of the OOPS NDB MESSAGES "
"RTN","OOPSNDB",55,0)
 . S ERROR(1)=ERROR(1)_"Mail Group."
"RTN","OOPSNDB",56,0)
 . S ERROR(2)="Enter at least one member to the group.  This person "
"RTN","OOPSNDB",57,0)
 . S ERROR(3)="will receive messages concerning the transmission of "
"RTN","OOPSNDB",58,0)
 . S ERROR(4)="ASISTS NDB data to and from the AAC. After adding member"
"RTN","OOPSNDB",59,0)
 . S ERROR(5)="contact IRM to complete manual transmission of NDB data."
"RTN","OOPSNDB",60,0)
 . D ERROR
"RTN","OOPSNDB",61,0)
GETREC ; Loop thru ^OOP(2260 to get records to transmit
"RTN","OOPSNDB",62,0)
 N OOPDA,PRSCNT,PRSDA,XMDUZ,XMTEXT,XMSUB,XMY
"RTN","OOPSNDB",63,0)
 N Y,%,%H,%I
"RTN","OOPSNDB",64,0)
 K ^TMP($J,"C"),^TMP($J,"D")
"RTN","OOPSNDB",65,0)
 S (CNT,PRSCNT,OOPDA)=0
"RTN","OOPSNDB",66,0)
 D NOW^%DTC S DATE=%,Y=DATE X ^DD("DD")
"RTN","OOPSNDB",67,0)
 S MTIME=$P(Y,"@",2),DATE=$$DC^OOPSNDBX(%)
"RTN","OOPSNDB",68,0)
 F  S OOPDA=$O(^OOPS(2260,OOPDA)) Q:OOPDA'>0  D
"RTN","OOPSNDB",69,0)
 . ; If Case not closed, do not include
"RTN","OOPSNDB",70,0)
 . Q:$$GET1^DIQ(2260,OOPDA,51,"I")'=1
"RTN","OOPSNDB",71,0)
 . ; If Case already Transmitted, do not resend
"RTN","OOPSNDB",72,0)
 . Q:$$GET1^DIQ(2260,OOPDA,57,"I")'=""
"RTN","OOPSNDB",73,0)
 . S VALID=""
"RTN","OOPSNDB",74,0)
 . F CHK=5:1:7 I '$$GET1^DIQ(2260,OOPDA,CHK,"I") S:CHK=5 $P(VALID,U)=5 S:CHK=6 $P(VALID,U,2)=6 S:CHK=7 $P(VALID,U,3)=7
"RTN","OOPSNDB",75,0)
 . I $G(VALID)'="" S ^TMP($J,"D",OOPDA)=VALID Q
"RTN","OOPSNDB",76,0)
 . S ^TMP($J,"C",OOPDA)=""
"RTN","OOPSNDB",77,0)
 . S CNT=CNT+1
"RTN","OOPSNDB",78,0)
 S ^TMP($J,"C")=CNT
"RTN","OOPSNDB",79,0)
 ; Count # of Non-Separated PAID Employees
"RTN","OOPSNDB",80,0)
 S PRSDA=0 D
"RTN","OOPSNDB",81,0)
 . F  S PRSDA=$O(^PRSPC(PRSDA)) Q:PRSDA'>0  D
"RTN","OOPSNDB",82,0)
 .. I $$GET1^DIQ(450,PRSDA,80,"I")'="Y" S PRSCNT=PRSCNT+1
"RTN","OOPSNDB",83,0)
NOCASES ; No Cases to Send - Send Mail Message with only NDB segment
"RTN","OOPSNDB",84,0)
 I CNT=0 D  G EXIT
"RTN","OOPSNDB",85,0)
 . D CREATE Q:FAIL
"RTN","OOPSNDB",86,0)
 . D SEND
"RTN","OOPSNDB",87,0)
PROCESS ;
"RTN","OOPSNDB",88,0)
 D CREATE G:FAIL EXIT
"RTN","OOPSNDB",89,0)
 ; START - First case number in MM, End - Last Case # in MM
"RTN","OOPSNDB",90,0)
 S OOPDA="",START="",END="",OPAST=""
"RTN","OOPSNDB",91,0)
 F  S OPAST=OOPDA,OOPDA=$O(^TMP($J,"C",OOPDA)) Q:OOPDA=""  D
"RTN","OOPSNDB",92,0)
 . D ^OOPSNDBX
"RTN","OOPSNDB",93,0)
 . ; Set DATE TRANSMITTED TO NDB in ^OOPS(2260 records
"RTN","OOPSNDB",94,0)
 . K DR S DIE="^OOPS(2260,",DA=OOPDA,DR="57///TODAY" D ^DIE K DR,DA,DIE
"RTN","OOPSNDB",95,0)
 ; If any records left to send and no FAILure
"RTN","OOPSNDB",96,0)
 I ($G(XMZ)'<1)&('FAIL) D
"RTN","OOPSNDB",97,0)
 . I END="" S END=$P($P(^OOPS(2260,OPAST,0),U),"-",2)
"RTN","OOPSNDB",98,0)
 . D SEND
"RTN","OOPSNDB",99,0)
 ;
"RTN","OOPSNDB",100,0)
EXIT ; Quits the program
"RTN","OOPSNDB",101,0)
 D BADREC                      ; Send Mail if any Bad Records
"RTN","OOPSNDB",102,0)
 I $G(FAIL) D
"RTN","OOPSNDB",103,0)
 . S ERROR(1)="Mail Message was not created.  Contact IRM to comlete "
"RTN","OOPSNDB",104,0)
 . S ERROR(2)="the manual transmission of ASISTS NDB data."
"RTN","OOPSNDB",105,0)
 . D ERROR
"RTN","OOPSNDB",106,0)
 K CTR,DATE,ERR,ERROR,GRP,INV,OPL,MSIZE,MTIME,XMSUB,XMTEXT,XMY,MSG
"RTN","OOPSNDB",107,0)
 K ^TMP($J)
"RTN","OOPSNDB",108,0)
 Q
"RTN","OOPSNDB",109,0)
CREATE ; Create MailMan Message
"RTN","OOPSNDB",110,0)
 N OPDATA,SN
"RTN","OOPSNDB",111,0)
 S MSIZE=0
"RTN","OOPSNDB",112,0)
 I $G(XMZ)'<1 D SEND
"RTN","OOPSNDB",113,0)
 S OPL=0
"RTN","OOPSNDB",114,0)
 S XMSUB="ASISTS NATIONAL DATABASE"
"RTN","OOPSNDB",115,0)
 S XMDUZ=DUZ
"RTN","OOPSNDB",116,0)
 D XMZ^XMA2 I XMZ<1 S FAIL=1 Q
"RTN","OOPSNDB",117,0)
 S SN=$P($G(^XMB(1,1,"XUS")),U,17)
"RTN","OOPSNDB",118,0)
 S SN=$E("0000000",$L(SN)+1,7)_SN
"RTN","OOPSNDB",119,0)
 S OPDATA="NDB^OOPS^"_SN_U_DATE_U_MTIME_U_^TMP($J,"C")
"RTN","OOPSNDB",120,0)
 S OPDATA=OPDATA_U_U_PRSCNT_U_"001"_U_"|"
"RTN","OOPSNDB",121,0)
 S OPL=OPL+1,^XMB(3.9,XMZ,2,OPL,0)=OPDATA
"RTN","OOPSNDB",122,0)
 Q
"RTN","OOPSNDB",123,0)
SEND ; Send MailMan Message
"RTN","OOPSNDB",124,0)
 N NUMCASE
"RTN","OOPSNDB",125,0)
 S ^XMB(3.9,XMZ,2,0)="^3.92A^"_OPL_U_OPL_U_DT
"RTN","OOPSNDB",126,0)
 ; Set # of Cases in this Mail Message
"RTN","OOPSNDB",127,0)
 S NUMCASE=$S(START'="":START_"-"_END,1:0)
"RTN","OOPSNDB",128,0)
 S $P(^XMB(3.9,XMZ,2,1,0),U,7)=NUMCASE
"RTN","OOPSNDB",129,0)
 ; Indicate last line of message
"RTN","OOPSNDB",130,0)
 S OPL=OPL+1,^XMB(3.9,XMZ,2,OPL,0)="$"
"RTN","OOPSNDB",131,0)
 S XMY(DUZ)=""                        ; also send here, in case of error.
"RTN","OOPSNDB",132,0)
 S XMY("XXX@Q-ASI.MED.VA.GOV")=""
"RTN","OOPSNDB",133,0)
 S XMCHAN=1 D ENT1^XMD K XMCHAN
"RTN","OOPSNDB",134,0)
 K XMZ
"RTN","OOPSNDB",135,0)
 Q
"RTN","OOPSNDB",136,0)
BADREC ; If any records with missing data, send mail message
"RTN","OOPSNDB",137,0)
 K MSG
"RTN","OOPSNDB",138,0)
 S CTR=1,OOPDA=0
"RTN","OOPSNDB",139,0)
 F  S OOPDA=$O(^TMP($J,"D",OOPDA)) Q:OOPDA=""  D
"RTN","OOPSNDB",140,0)
 . S VALID=^TMP($J,"D",OOPDA)
"RTN","OOPSNDB",141,0)
 . S MSG(CTR)="Case: "_$$GET1^DIQ(2260,OOPDA,.01)_" has missing data "
"RTN","OOPSNDB",142,0)
 . S MSG(CTR)=MSG(CTR)_"that must be entered prior",CTR=CTR+1
"RTN","OOPSNDB",143,0)
 . S MSG(CTR)="to transmitting to AAC. ",CTR=CTR+1
"RTN","OOPSNDB",144,0)
 . I $P(VALID,U) S MSG(CTR)="  Missing SSN",CTR=CTR+1
"RTN","OOPSNDB",145,0)
 . I $P(VALID,U,2) S MSG(CTR)="  Missing DOB",CTR=CTR+1
"RTN","OOPSNDB",146,0)
 . I $P(VALID,U,3) S MSG(CTR)="  Missing SEX",CTR=CTR+1
"RTN","OOPSNDB",147,0)
 I $D(MSG) D 
"RTN","OOPSNDB",148,0)
 . S XMSUB="ASISTS Records Missing Necessary Data Elements"
"RTN","OOPSNDB",149,0)
 . S XMY("G.OOPS NDB MESSAGES@"_^XMB("NETNAME"))=""
"RTN","OOPSNDB",150,0)
 . S XMTEXT="MSG("
"RTN","OOPSNDB",151,0)
 . D ^XMD
"RTN","OOPSNDB",152,0)
 Q
"RTN","OOPSNDB",153,0)
ERROR ; Create appropriate Error message and Send message
"RTN","OOPSNDB",154,0)
 S XMDUZ="ASISTS Package"
"RTN","OOPSNDB",155,0)
 S GRP="OOPS SAFETY"
"RTN","OOPSNDB",156,0)
 D GRP^OOPSMBUL
"RTN","OOPSNDB",157,0)
 ; If no one in mail group (this should not occur), send to user
"RTN","OOPSNDB",158,0)
 I $D(XMY)<9 S XMY(DUZ)=""
"RTN","OOPSNDB",159,0)
 S XMSUB="ASISTS NDB Error Notification Message"
"RTN","OOPSNDB",160,0)
 S XMTEXT="ERROR("
"RTN","OOPSNDB",161,0)
 D ^XMD
"RTN","OOPSNDB",162,0)
 I '$D(ZTQUEUED) D
"RTN","OOPSNDB",163,0)
 . S MSG("DIHELP",1)="An Error Occurred during Processing, check"
"RTN","OOPSNDB",164,0)
 . S MSG("DIHELP",2)="Mailman Message for details."
"RTN","OOPSNDB",165,0)
 . D MSG^DIALOG("WH","","","","MSG")
"RTN","OOPSNDB",166,0)
 K ERROR
"RTN","OOPSNDB",167,0)
 Q
"RTN","OOPSNDBX")
0^16^B15692135
"RTN","OOPSNDBX",1,0)
OOPSNDBX ;;WCIOFO/LLH - Extract data to MailMan message
"RTN","OOPSNDBX",2,0)
 ;;1.0;ASISTS;**5**;Jun 01, 1998
"RTN","OOPSNDBX",3,0)
 ;
"RTN","OOPSNDBX",4,0)
 ; Retrieves data from ^OOPS(2260, for 2162
"RTN","OOPSNDBX",5,0)
 ; Variables used
"RTN","OOPSNDBX",6,0)
 ;  OOPDA        IEN of Case
"RTN","OOPSNDBX",7,0)
 ;  OOPSAR       Array holding data
"RTN","OOPSNDBX",8,0)
 ;  OPL          Last Line number written in message text
"RTN","OOPSNDBX",9,0)
 ;  XMZ          Message Number
"RTN","OOPSNDBX",10,0)
EN ; Entry
"RTN","OOPSNDBX",11,0)
 N ARR,MESS,OPC,OPDATA,OPFLD,OPI,OPJ,OPSAR,OPT,OPX,SEG,TL
"RTN","OOPSNDBX",12,0)
 S RSIZE=0,ARR=0
"RTN","OOPSNDBX",13,0)
 S OPSAR(0)=$G(^OOPS(2260,OOPDA,0))
"RTN","OOPSNDBX",14,0)
 S OPSAR("2162A")=$G(^OOPS(2260,OOPDA,"2162A"))
"RTN","OOPSNDBX",15,0)
 S OPSAR("2162B")=$G(^OOPS(2260,OOPDA,"2162B"))
"RTN","OOPSNDBX",16,0)
 S OPSAR("2162D")=$G(^OOPS(2260,OOPDA,"2162D"))
"RTN","OOPSNDBX",17,0)
OP1 ; Seg OP1
"RTN","OOPSNDBX",18,0)
 N TIME
"RTN","OOPSNDBX",19,0)
 S TIME=$P($P(OPSAR(0),U,5),".",2)
"RTN","OOPSNDBX",20,0)
 S OPX="OP1^"_$P(OPSAR(0),U)_U_$P(OPSAR(0),U,2)_U_$P(OPSAR(0),U,3)
"RTN","OOPSNDBX",21,0)
 S OPX=OPX_U_$$GET1^DIQ(2260,OOPDA,"3:1")
"RTN","OOPSNDBX",22,0)
 S OPX=OPX_U_$$DC($P($P(OPSAR(0),U,5),"."))
"RTN","OOPSNDBX",23,0)
 S OPX=OPX_U_TIME_$E("0000",$L(TIME)+1,4)
"RTN","OOPSNDBX",24,0)
 S OPX=OPX_U_$P(OPSAR("2162A"),U)_U_$$DC($P(OPSAR("2162A"),U,2))
"RTN","OOPSNDBX",25,0)
 S OPX=OPX_U_$P(OPSAR("2162A"),U,3)_U_$P(OPSAR("2162A"),U,9)
"RTN","OOPSNDBX",26,0)
 S OPX=OPX_U_$P(OPSAR("2162A"),U,10)_U_$P(OPSAR("2162A"),U,11)
"RTN","OOPSNDBX",27,0)
 S OPX=OPX_U_$P(OPSAR("2162A"),U,12)_U_$P(OPSAR("2162A"),U,13)
"RTN","OOPSNDBX",28,0)
 S OPX=OPX_U_$P(OPSAR("2162A"),U,14)
"RTN","OOPSNDBX",29,0)
 S OPX=OPX_U_$P(OPSAR("2162B"),U)_U_$$GET1^DIQ(2260,OOPDA,"27:1")
"RTN","OOPSNDBX",30,0)
 S OPX=OPX_U_$$GET1^DIQ(2260,OOPDA,"29:1")
"RTN","OOPSNDBX",31,0)
 S OPX=OPX_U_$$GET1^DIQ(2260,OOPDA,"30:1")
"RTN","OOPSNDBX",32,0)
 S OPX=OPX_U_$$GET1^DIQ(2260,OOPDA,"30.1:1")_U_$P(OPSAR("2162B"),U,5)
"RTN","OOPSNDBX",33,0)
 S OPX=OPX_U_$P(OPSAR("2162B"),U,6)_U_$P(OPSAR("2162B"),U,7)
"RTN","OOPSNDBX",34,0)
 S OPX=OPX_U_$P(OPSAR("2162D"),U)_U_$P(OPSAR("2162D"),U,2)
"RTN","OOPSNDBX",35,0)
 S OPX=OPX_U_$$GET1^DIQ(2260,OOPDA,"36:1")
"RTN","OOPSNDBX",36,0)
 S OPX=OPX_U_$$GET1^DIQ(2260,OOPDA,"37:1")
"RTN","OOPSNDBX",37,0)
 S OPX=OPX_U_$$GET1^DIQ(2260,OOPDA,"38:1")
"RTN","OOPSNDBX",38,0)
 S OPX=OPX_U_$$GET1^DIQ(2260,OOPDA,"41:1")
"RTN","OOPSNDBX",39,0)
 S OPX=OPX_U_$P(OPSAR("2162D"),U,8)
"RTN","OOPSNDBX",40,0)
 S OPX=OPX_U_$P(OPSAR(0),U,7)_"^|"
"RTN","OOPSNDBX",41,0)
 S ARR=ARR+1,MESS(ARR)=OPX
"RTN","OOPSNDBX",42,0)
 S RSIZE=RSIZE+$L(OPX)+2
"RTN","OOPSNDBX",43,0)
 ;
"RTN","OOPSNDBX",44,0)
OP2 ; Seg OP2 - Description of Incident (Word Processing)
"RTN","OOPSNDBX",45,0)
 S OPFLD=28,SEG="OP2"
"RTN","OOPSNDBX",46,0)
 D WP
"RTN","OOPSNDBX",47,0)
OP3 ; Seg OP3 - Equipment Device Failure
"RTN","OOPSNDBX",48,0)
 K OPX
"RTN","OOPSNDBX",49,0)
 I $P($G(OPSAR("2162D")),U,7)'="" D
"RTN","OOPSNDBX",50,0)
 . S OPX="OP3"_U_$P(OPSAR("2162D"),U,7)_"^|"
"RTN","OOPSNDBX",51,0)
 . S ARR=ARR+1,MESS(ARR)=OPX
"RTN","OOPSNDBX",52,0)
 . S RSIZE=RSIZE+$L(OPX)+2
"RTN","OOPSNDBX",53,0)
OP4 ; Seg OP4 - Corrective Action - Word Processing
"RTN","OOPSNDBX",54,0)
 S OPFLD=47,SEG="OP4"
"RTN","OOPSNDBX",55,0)
 D WP
"RTN","OOPSNDBX",56,0)
OP5 ; Seg OP5 - Safety Officer Comments - Word Processing
"RTN","OOPSNDBX",57,0)
 S OPFLD=55,SEG="OP5"
"RTN","OOPSNDBX",58,0)
 D WP
"RTN","OOPSNDBX",59,0)
OP6 ; Seg OP6 - Area Exposed to Bodily Fluid - Multiple
"RTN","OOPSNDBX",60,0)
 K OPX
"RTN","OOPSNDBX",61,0)
 S OPDATA=""
"RTN","OOPSNDBX",62,0)
 S TL=0 F OPI=0:1 S TL=$O(^OOPS(2260,OOPDA,"2162E",TL)) Q:'TL
"RTN","OOPSNDBX",63,0)
 I OPI S TL=0 F OPJ=1:1 S TL=$O(^OOPS(2260,OOPDA,"2162E",TL)) Q:'TL  D
"RTN","OOPSNDBX",64,0)
 . S OPDATA=$G(^OOPS(2260,OOPDA,"2162E",TL,0)) Q:(OPDATA="")
"RTN","OOPSNDBX",65,0)
 . I OPJ=1 S OPX="OP6"_U_OPDATA
"RTN","OOPSNDBX",66,0)
 . I OPJ>1 S OPX=OPX_","_OPDATA
"RTN","OOPSNDBX",67,0)
 I $D(OPX) S OPX=OPX_"^|" D
"RTN","OOPSNDBX",68,0)
 . S ARR=ARR+1,MESS(ARR)=OPX
"RTN","OOPSNDBX",69,0)
 . S RSIZE=RSIZE+$L(OPX)+2
"RTN","OOPSNDBX",70,0)
OP7 ; Seg OP7 - Personal Protective Equipment - Multiple
"RTN","OOPSNDBX",71,0)
 K OPX
"RTN","OOPSNDBX",72,0)
 S OPDATA=""
"RTN","OOPSNDBX",73,0)
 S TL=0 F OPI=0:1 S TL=$O(^OOPS(2260,OOPDA,"2162F",TL)) Q:'TL
"RTN","OOPSNDBX",74,0)
 I OPI S TL=0 F OPJ=1:1 S TL=$O(^OOPS(2260,OOPDA,"2162F",TL)) Q:'TL  D
"RTN","OOPSNDBX",75,0)
 . S OPDATA=$G(^OOPS(2260,OOPDA,"2162F",TL,0)) Q:(OPDATA="")
"RTN","OOPSNDBX",76,0)
 . I OPJ=1 S OPX="OP7"_U_OPDATA
"RTN","OOPSNDBX",77,0)
 . I OPJ>1 S OPX=OPX_","_OPDATA
"RTN","OOPSNDBX",78,0)
 I $D(OPX) S OPX=OPX_"^|" D
"RTN","OOPSNDBX",79,0)
 . S ARR=ARR+1,MESS(ARR)=OPX
"RTN","OOPSNDBX",80,0)
 . S RSIZE=RSIZE+$L(OPX)+2
"RTN","OOPSNDBX",81,0)
EXIT ; Loads the message and Quits the routine
"RTN","OOPSNDBX",82,0)
 I RSIZE+MSIZE>31500 D
"RTN","OOPSNDBX",83,0)
 . S END=$P($P(^OOPS(2260,OPAST,0),U),"-",2)
"RTN","OOPSNDBX",84,0)
 . D SEND^OOPSNDB,CREATE^OOPSNDB
"RTN","OOPSNDBX",85,0)
 . S (START,END)=""
"RTN","OOPSNDBX",86,0)
 F I=1:1:ARR I $G(MESS(I))'="" D
"RTN","OOPSNDBX",87,0)
 . S OPL=OPL+1,^XMB(3.9,XMZ,2,OPL,0)=MESS(I)
"RTN","OOPSNDBX",88,0)
 . I START="" S START=$P($P(OPSAR(0),U),"-",2)
"RTN","OOPSNDBX",89,0)
 S MSIZE=MSIZE+RSIZE
"RTN","OOPSNDBX",90,0)
 K ARR,MESS,OPDT,RSIZE
"RTN","OOPSNDBX",91,0)
 Q
"RTN","OOPSNDBX",92,0)
WP ; Word Processing Fields
"RTN","OOPSNDBX",93,0)
 N DIWL,DIWR,DIWF,OPGLB,OPNODE,X
"RTN","OOPSNDBX",94,0)
 S OPI=0
"RTN","OOPSNDBX",95,0)
 K ^UTILITY($J,"W")
"RTN","OOPSNDBX",96,0)
 S DIWL=1,DIWR="",DIWF="|C70"
"RTN","OOPSNDBX",97,0)
 S OPNODE=$P($$GET1^DID(2260,OPFLD,"","GLOBAL SUBSCRIPT LOCATION"),";")
"RTN","OOPSNDBX",98,0)
 S OPGLB="^OOPS(2260,OOPDA,OPNODE,OPI)"
"RTN","OOPSNDBX",99,0)
 S OPI=0 F  S OPI=$O(@OPGLB) Q:'OPI  S X=$G(^(OPI,0)) D:X]"" ^DIWP
"RTN","OOPSNDBX",100,0)
 S OPT=$G(^UTILITY($J,"W",1))+0
"RTN","OOPSNDBX",101,0)
 I OPT S OPI=0 F OPC=1:1 S OPI=$O(^UTILITY($J,"W",1,OPI)) Q:'OPI  D
"RTN","OOPSNDBX",102,0)
 . S OPX=SEG_U_OPC_U_OPT_U_$E(^UTILITY($J,"W",1,OPI,0),1,220)_"^|"
"RTN","OOPSNDBX",103,0)
 . S ARR=ARR+1,MESS(ARR)=OPX
"RTN","OOPSNDBX",104,0)
 . S RSIZE=RSIZE+$L(OPX)+2
"RTN","OOPSNDBX",105,0)
 K ^UTILITY($J,"W"),X
"RTN","OOPSNDBX",106,0)
 Q
"RTN","OOPSNDBX",107,0)
DC(OPDT) ; Convert Date to YYYYMMDD
"RTN","OOPSNDBX",108,0)
 S:OPDT]"" OPDT=OPDT+17000000\1
"RTN","OOPSNDBX",109,0)
 Q OPDT
"RTN","OOPSPRT")
0^4^B37129997
"RTN","OOPSPRT",1,0)
OOPSPRT ;HIRMFO/GWB - Print Report of Accident ;3/5/98
"RTN","OOPSPRT",2,0)
 ;;1.0;ASISTS;**2,3,5**;Jun 01, 1998
"RTN","OOPSPRT",3,0)
SUP S DIC="^OOPS(2260,"
"RTN","OOPSPRT",4,0)
 S DIC("S")="I $$GET1^DIQ(2260,Y,53,""I"")=DUZ!($$GET1^DIQ(2260,Y,53.1,""I"")=DUZ)"
"RTN","OOPSPRT",5,0)
 G DIC
"RTN","OOPSPRT",6,0)
SO S DIC="^OOPS(2260,"
"RTN","OOPSPRT",7,0)
DIC S DIC(0)="AEMNZ",DIC("A")="Select case: "
"RTN","OOPSPRT",8,0)
 D ^DIC Q:(Y<1)!($D(DTOUT))!($D(DUOUT))
"RTN","OOPSPRT",9,0)
 S IEN=+Y
"RTN","OOPSPRT",10,0)
 K IOP,%ZIS S %ZIS="MQ" W ! D ^%ZIS K %ZIS,IOP G:POP KILL
"RTN","OOPSPRT",11,0)
 I $D(IO("Q")) S OOPSLST="IEN^UNION" D TASK G KILL
"RTN","OOPSPRT",12,0)
 U IO D PRT D ^%ZISC K %ZIS,IOP G KILL
"RTN","OOPSPRT",13,0)
PRT N LIN,SUP,AETBF,CAT,PPE
"RTN","OOPSPRT",14,0)
 S PG=0,EX="",LIN=$S(($E(IOST,1,2)="C-"):IOSL-2,1:IOSL-6),IE=IEN
"RTN","OOPSPRT",15,0)
 D NOW^%DTC S DATE=%,Y=DATE X ^DD("DD") S DATE=$P(Y,":",1,2)
"RTN","OOPSPRT",16,0)
 K DIQ,DA,DR S DIC="^OOPS(2260,",DR=".01:99",DA=IEN,DIQ="OOPS" D EN^DIQ1
"RTN","OOPSPRT",17,0)
 I $D(^OOPS(2260,IEN,"2162E")) S EIEN=0 F  S EIEN=$O(^OOPS(2260,IEN,"2162E",EIEN)) Q:EIEN=""  K DIQ S DIC="^OOPS(2260,",DR=39,DA=IEN,DIQ="OOPS",DR(2260.039)=.01,DA(2260.039)=EIEN D EN^DIQ1
"RTN","OOPSPRT",18,0)
 I $D(^OOPS(2260,IEN,"2162F")) S FIEN=0 F  S FIEN=$O(^OOPS(2260,IEN,"2162F",FIEN)) Q:FIEN=""  K DIQ S DIC="^OOPS(2260,",DR=40,DA=IEN,DIQ="OOPS",DR(2260.01)=.01,DA(2260.01)=FIEN D EN^DIQ1
"RTN","OOPSPRT",19,0)
 S CN=OOPS(2260,IEN,.01)
"RTN","OOPSPRT",20,0)
 S TOI=OOPS(2260,IEN,3)
"RTN","OOPSPRT",21,0)
 ; Patch 5 - have changed this logic, matches other routines
"RTN","OOPSPRT",22,0)
 S CAT=$$GET1^DIQ(2260,IEN,2,"I")
"RTN","OOPSPRT",23,0)
 S SUP=$S((CAT=1!(CAT>6)):"SUPERVISOR...................:",CAT=2:"VOLUNTARY SVC SUPERVISOR.....:",CAT=3:"CONTRACT ADMINISTRATOR.......:",1:"SAFETY OFFICER...............:")
"RTN","OOPSPRT",24,0)
 D HDR
"RTN","OOPSPRT",25,0)
 W !,"CASE NUMBER..................: ",OOPS(2260,IEN,.01) D P Q:EX=U
"RTN","OOPSPRT",26,0)
 W !,"PERSONNEL STATUS.............: ",OOPS(2260,IEN,2) D P Q:EX=U
"RTN","OOPSPRT",27,0)
 W !,"TYPE OF INCIDENT.............: ",OOPS(2260,IEN,3) D P Q:EX=U
"RTN","OOPSPRT",28,0)
 W !,"CASE STATUS..................: ",OOPS(2260,IEN,51) D P Q:EX=U
"RTN","OOPSPRT",29,0)
 W !,"INJURY/ILLNESS...............: ",OOPS(2260,IEN,52) D P Q:EX=U
"RTN","OOPSPRT",30,0)
 ; Patch 5 - added the block structure
"RTN","OOPSPRT",31,0)
 I $G(UNION)'="Y" D  Q:EX=U
"RTN","OOPSPRT",32,0)
 . W !,"PERSON INVOLVED..............: ",OOPS(2260,IEN,1) D P Q:EX=U
"RTN","OOPSPRT",33,0)
 . W !,"SSN..........................: ",OOPS(2260,IEN,5) D P Q:EX=U
"RTN","OOPSPRT",34,0)
 . W !,"DATE OF BIRTH................: ",OOPS(2260,IEN,6) D P Q:EX=U
"RTN","OOPSPRT",35,0)
 . W !,"SEX..........................: ",OOPS(2260,IEN,7) D P Q:EX=U
"RTN","OOPSPRT",36,0)
 . W !,"HOME ADDRESS.................: ",OOPS(2260,IEN,8) D P Q:EX=U
"RTN","OOPSPRT",37,0)
 . I (OOPS(2260,IEN,9)'="")!(OOPS(2260,IEN,10)'="")!(OOPS(2260,IEN,11)'="") W !,"                               ",OOPS(2260,IEN,9),", ",OOPS(2260,IEN,10)," ",OOPS(2260,IEN,11) D P Q:EX=U
"RTN","OOPSPRT",38,0)
 . W !,"HOME PHONE NUMBER............: ",OOPS(2260,IEN,12) D P Q:EX=U
"RTN","OOPSPRT",39,0)
 . ; Patch 5 - print station #
"RTN","OOPSPRT",40,0)
 . W !,"STATION NUMBER...............: ",OOPS(2260,IEN,13) D P Q:EX=U
"RTN","OOPSPRT",41,0)
 . W !,"COST CENTER/ORG..............: ",OOPS(2260,IEN,14) D P Q:EX=U
"RTN","OOPSPRT",42,0)
 . W !,"OCCUPATION...................: ",OOPS(2260,IEN,15) D P Q:EX=U
"RTN","OOPSPRT",43,0)
 . W !,"GRADE/STEP...................: ",OOPS(2260,IEN,16) W:OOPS(2260,IEN,16)'="" "/" W OOPS(2260,IEN,17) D P Q:EX=U
"RTN","OOPSPRT",44,0)
 . W !,"EDUCATION....................: ",OOPS(2260,IEN,18) D P Q:EX=U
"RTN","OOPSPRT",45,0)
 . W !,SUP," ",OOPS(2260,IEN,53) D P Q:EX=U
"RTN","OOPSPRT",46,0)
 . W !,"SECONDARY SUPERVISOR.........: ",OOPS(2260,IEN,53.1) D P Q:EX=U
"RTN","OOPSPRT",47,0)
 ; Patch 5 - new logic for Station Number display
"RTN","OOPSPRT",48,0)
 I $G(UNION)="Y" D  Q:EX=U
"RTN","OOPSPRT",49,0)
 . W !,"STATION NUMBER...............: ",OOPS(2260,IEN,13) D P Q:EX=U
"RTN","OOPSPRT",50,0)
 W !,"DATE/TIME OF OCCURRENCE......: ",OOPS(2260,IEN,4) D P Q:EX=U
"RTN","OOPSPRT",51,0)
 W !,"GENERAL SETTING OF INCIDENT..: ",OOPS(2260,IEN,26) D P Q:EX=U
"RTN","OOPSPRT",52,0)
 W !,"LOCATION OF INCIDENT.........: ",OOPS(2260,IEN,27) D P Q:EX=U
"RTN","OOPSPRT",53,0)
 W !,"CHARACTERIZATION OF INJURY...: ",OOPS(2260,IEN,29) D P Q:EX=U
"RTN","OOPSPRT",54,0)
 ; Patch 5 - added write
"RTN","OOPSPRT",55,0)
 W !,"MEDICAL EMERGENCY............: ",OOPS(2260,IEN,29.5) D P Q:EX=U
"RTN","OOPSPRT",56,0)
 W !,"BODY PART MOST AFFECTED......: ",OOPS(2260,IEN,30) D P Q:EX=U
"RTN","OOPSPRT",57,0)
 W !,"ADDITIONAL BODY PART AFFECTED: ",OOPS(2260,IEN,30.1) D P Q:EX=U
"RTN","OOPSPRT",58,0)
 W !,"SIDE OF BODY AFFECTED........: ",OOPS(2260,IEN,31) D P Q:EX=U
"RTN","OOPSPRT",59,0)
 W !,"DUTY RETURNED TO.............: ",OOPS(2260,IEN,32) D P Q:EX=U
"RTN","OOPSPRT",60,0)
 W !,"LOST TIME....................: ",OOPS(2260,IEN,33) D P Q:EX=U
"RTN","OOPSPRT",61,0)
 W !,"DESCRIPTION OF INCIDENT......:"
"RTN","OOPSPRT",62,0)
 S DOI=0 F  S DOI=$O(OOPS(2260,IEN,28,DOI)) Q:DOI=""  W !," ",OOPS(2260,IEN,28,DOI) D P Q:EX=U
"RTN","OOPSPRT",63,0)
 I $P(^OOPS(2260,IEN,0),U,4)>10 D  Q:EX=U
"RTN","OOPSPRT",64,0)
 .W !,"PATIENT SOURCE...............: ",OOPS(2260,IEN,34) D P Q:EX=U
"RTN","OOPSPRT",65,0)
 I ($P(^OOPS(2260,IEN,0),U,4)=11)!($P(^OOPS(2260,IEN,0),U,4)=12) D
"RTN","OOPSPRT",66,0)
 .W !,"CONTAMINATION................: ",OOPS(2260,IEN,35) D P Q:EX=U
"RTN","OOPSPRT",67,0)
 .W !,"PURPOSE OF SHARP OBJECT......: ",OOPS(2260,IEN,36) D P Q:EX=U
"RTN","OOPSPRT",68,0)
 .W !,"ACTIVITY AT TIME OF INJURY...: ",OOPS(2260,IEN,37) D P Q:EX=U
"RTN","OOPSPRT",69,0)
 .W !,"OBJECT CAUSING INJURY........: ",OOPS(2260,IEN,38) D P Q:EX=U
"RTN","OOPSPRT",70,0)
 I $P(^OOPS(2260,IEN,0),U,4)=13 D  Q:EX=U
"RTN","OOPSPRT",71,0)
 .W !,"AREA EXPOSED TO BODILY FLUID.: "
"RTN","OOPSPRT",72,0)
 .K IND S AETBF=0 F  S AETBF=$O(OOPS(2260.039,AETBF)) Q:AETBF=""  W ?31,OOPS(2260.039,AETBF,.01),! S IND="" D P Q:EX=U
"RTN","OOPSPRT",73,0)
 .W:'$D(IND) ! W "PERSONAL PROTECTIVE EQUIPMENT: " K IND
"RTN","OOPSPRT",74,0)
 .K IND S PPE=0 F  S PPE=$O(OOPS(2260.01,PPE)) Q:PPE=""  W ?31,OOPS(2260.01,PPE,.01),! S IND="" D P Q:EX=U
"RTN","OOPSPRT",75,0)
 .W:'$D(IND) ! W "BODILY FLUID EXPOSURE SOURCE.: ",OOPS(2260,IEN,41) K IND D P Q:EX=U
"RTN","OOPSPRT",76,0)
 I $P(^OOPS(2260,IEN,0),U,4)>10 D  Q:EX=U
"RTN","OOPSPRT",77,0)
 .; Patch 5 - added If
"RTN","OOPSPRT",78,0)
 .I OOPS(2260,IEN,42.5)="Yes" D  Q:EX=U
"RTN","OOPSPRT",79,0)
 ..W !,"EQUIPMENT/DEVICE FAILURE.....: ",OOPS(2260,IEN,42) D P Q:EX=U
"RTN","OOPSPRT",80,0)
 .W !,"SAFETY DESIGN DEVICE USED....: ",OOPS(2260,IEN,43) D P Q:EX=U
"RTN","OOPSPRT",81,0)
 ; OOPS*1*5 - Move Corrective Action (from below field 50) and
"RTN","OOPSPRT",82,0)
 ;            add Safety Officer Comments (field 55)
"RTN","OOPSPRT",83,0)
 W !,"CORRECTIVE ACTION............: "
"RTN","OOPSPRT",84,0)
 ; OOPS*1*5 - Changed to use WP logic
"RTN","OOPSPRT",85,0)
 S OPFLD=47 D WP K OPFLD
"RTN","OOPSPRT",86,0)
 W !,"SAFETY OFF. COMMENTS.........: "
"RTN","OOPSPRT",87,0)
 S OPFLD=55 D WP K OPFLD
"RTN","OOPSPRT",88,0)
 W !,"PERSON ENTERING STUB RECORD..: ",OOPS(2260,IEN,56) D P Q:EX=U
"RTN","OOPSPRT",89,0)
 I $G(UNION)'="Y" W !,"/ES/SUPERVISOR...............: ",OOPS(2260,IEN,44) D P Q:EX=U
"RTN","OOPSPRT",90,0)
 W !,"SUPERVISOR SIGNATURE DATE....: ",OOPS(2260,IEN,46) D P Q:EX=U
"RTN","OOPSPRT",91,0)
 W !,"/ES/SAFETY OFFICER...........: ",OOPS(2260,IEN,48) D P Q:EX=U
"RTN","OOPSPRT",92,0)
 W !,"SAFETY OFFICER SIGNATURE DATE: ",OOPS(2260,IEN,50) D P Q:EX=U
"RTN","OOPSPRT",93,0)
 I $E(IOST,1,2)="C-" W ! K DIR S DIR(0)="E" D ^DIR W @IOF
"RTN","OOPSPRT",94,0)
KILL ;Kill Variables and Exit
"RTN","OOPSPRT",95,0)
 K %,DIR,DIROUT,DIRUT,DTOUT,DUOUT,X,Y
"RTN","OOPSPRT",96,0)
 K CA,CACNT,CN,D0,DA,DASHES,DATE,DIC,DIQ,DIQ2,DOI,DR,EIEN,EX,FIEN,I,IE
"RTN","OOPSPRT",97,0)
 K IEN,OOPS,PG,TOI,SUP,UNION
"RTN","OOPSPRT",98,0)
 Q
"RTN","OOPSPRT",99,0)
P ;Print
"RTN","OOPSPRT",100,0)
 I ($Y'<(LIN-3)) D  Q:EX=U
"RTN","OOPSPRT",101,0)
 .I IOST?1"C".E W ! K DIR S DIR(0)="E" D ^DIR I 'Y S EX=U Q
"RTN","OOPSPRT",102,0)
 .D HDR Q
"RTN","OOPSPRT",103,0)
 Q
"RTN","OOPSPRT",104,0)
TASK ;Queue a task
"RTN","OOPSPRT",105,0)
 K IO("Q"),ZTUCI,ZTDTH,ZTIO,ZTSAVE
"RTN","OOPSPRT",106,0)
 S ZTRTN="PRT^OOPSPRT",ZTREQ="@",ZTSAVE("ZTREQ")=""
"RTN","OOPSPRT",107,0)
 S ZTDESC="ASISTS REPORT OF ACCIDENT"
"RTN","OOPSPRT",108,0)
 F V2=1:1 S V1=$P(OOPSLST,"^",V2) Q:V1=""  S ZTSAVE(V1)=""
"RTN","OOPSPRT",109,0)
 D ^%ZTLOAD D ^%ZISC U IO W !,"Request Queued",!
"RTN","OOPSPRT",110,0)
 K V1,V2,OOPSLST,ZTSK Q
"RTN","OOPSPRT",111,0)
WP ; Process Word Processing Fields (#47, #55)
"RTN","OOPSPRT",112,0)
 N DIWL,DIWR,DIWF,OPGLB,OPI,OPNODE,OPT,OPC
"RTN","OOPSPRT",113,0)
 K ^UTILITY($J,"W")
"RTN","OOPSPRT",114,0)
 S DIWL=1,DIWR="",DIWF="|C76"
"RTN","OOPSPRT",115,0)
 S OPNODE=$P($$GET1^DID(2260,OPFLD,"","GLOBAL SUBSCRIPT LOCATION"),";")
"RTN","OOPSPRT",116,0)
 S OPGLB="^OOPS(2260,IEN,OPNODE,OPI)"
"RTN","OOPSPRT",117,0)
 S OPI=0 F  S OPI=$O(@OPGLB) Q:'OPI  S X=$G(^(OPI,0)) D:X]"" ^DIWP
"RTN","OOPSPRT",118,0)
 S OPT=$G(^UTILITY($J,"W",1))+0
"RTN","OOPSPRT",119,0)
 I OPT S OPI=0 F OPC=1:1 S OPI=$O(^UTILITY($J,"W",1,OPI)) Q:'OPI!(EX=U)  D
"RTN","OOPSPRT",120,0)
 . W !?1,^UTILITY($J,"W",1,OPI,0) D P Q:EX=U
"RTN","OOPSPRT",121,0)
 K ^UTILITY($J,"W"),X
"RTN","OOPSPRT",122,0)
 Q
"RTN","OOPSPRT",123,0)
HDR ;Header
"RTN","OOPSPRT",124,0)
 W @IOF S PG=PG+1 K DASHES S $P(DASHES,"-",80)="-"
"RTN","OOPSPRT",125,0)
 W !,"Report of Accident ",CN,?73,"Page ",PG
"RTN","OOPSPRT",126,0)
 ;W ?62,ONDATE,!,DASHES
"RTN","OOPSPRT",127,0)
 W !,DASHES
"RTN","OOPSPRT",128,0)
 Q
"RTN","OOPSPRT",129,0)
UNION ; Union Entry point
"RTN","OOPSPRT",130,0)
 S UNION="Y"
"RTN","OOPSPRT",131,0)
 S DIC="^OOPS(2260,"
"RTN","OOPSPRT",132,0)
 S DIC("S")="I $$UNION^OOPSUTL4(Y)"
"RTN","OOPSPRT",133,0)
 G DIC
"RTN","OOPSPRT1")
0^5^B30649056
"RTN","OOPSPRT1",1,0)
OOPSPRT1 ;HINES/WAA - Utilities Routines - 3/24/98
"RTN","OOPSPRT1",2,0)
 ;;1.0;ASISTS;**2,3,5**;Jun 01, 1998
"RTN","OOPSPRT1",3,0)
 ;;
"RTN","OOPSPRT1",4,0)
 ; This routine is to display all the report that a person has
"RTN","OOPSPRT1",5,0)
 ; access to.
"RTN","OOPSPRT1",6,0)
EN1(CALLER) ;
"RTN","OOPSPRT1",7,0)
 ; Input:
"RTN","OOPSPRT1",8,0)
 ;    Caller O = Safety Officer
"RTN","OOPSPRT1",9,0)
 ;           U = Union
"RTN","OOPSPRT1",10,0)
 ;           S = Supervisor
"RTN","OOPSPRT1",11,0)
 ;           E = Employee
"RTN","OOPSPRT1",12,0)
 ; 
"RTN","OOPSPRT1",13,0)
 N YEAR,OUT,PAGE,STA
"RTN","OOPSPRT1",14,0)
 ; Patch 5 - added logic to print all stations or 1
"RTN","OOPSPRT1",15,0)
 S OUT=0,PAGE=1
"RTN","OOPSPRT1",16,0)
 S YEAR=""
"RTN","OOPSPRT1",17,0)
 I CALLER="E" D
"RTN","OOPSPRT1",18,0)
 .S SSN=$P(^VA(200,DUZ,1),U,9)
"RTN","OOPSPRT1",19,0)
 .Q:$D(^OOPS(2260,"SSN",SSN))<1
"RTN","OOPSPRT1",20,0)
 .Q
"RTN","OOPSPRT1",21,0)
 D RANGE(.YEAR,.OUT)
"RTN","OOPSPRT1",22,0)
 I 'OUT D STATION(.STA,.OUT)
"RTN","OOPSPRT1",23,0)
 D:'OUT DEVICE
"RTN","OOPSPRT1",24,0)
 I 'OUT D:'$D(IO("Q")) PRINT
"RTN","OOPSPRT1",25,0)
EXIT ;
"RTN","OOPSPRT1",26,0)
 K IO("Q")
"RTN","OOPSPRT1",27,0)
 Q
"RTN","OOPSPRT1",28,0)
RANGE(YEAR,OUT) ; This Subroutine will allow the user to select a range.
"RTN","OOPSPRT1",29,0)
 ; Output
"RTN","OOPSPRT1",30,0)
 ;   YEAR = The year that the user what to print
"RTN","OOPSPRT1",31,0)
 ;        = "" all years
"RTN","OOPSPRT1",32,0)
 ;
"RTN","OOPSPRT1",33,0)
 N DIR,DIRUT,Y
"RTN","OOPSPRT1",34,0)
R1 S DIR(0)="NAO^0:9999:0"
"RTN","OOPSPRT1",35,0)
 S DIR("A")="Select the Fiscal Year or RETURN for ALL: "
"RTN","OOPSPRT1",36,0)
 S DIR("??")="Enter the Fiscal Year that you want to print for or RETURN for data in file"
"RTN","OOPSPRT1",37,0)
 D ^DIR
"RTN","OOPSPRT1",38,0)
 I $D(DTOUT)!($D(DUOUT)) S OUT=1 Q
"RTN","OOPSPRT1",39,0)
 I Y'="",$L(Y)'=4 W !,"You must enter a 4 digit year." G R1
"RTN","OOPSPRT1",40,0)
 S YEAR=Y
"RTN","OOPSPRT1",41,0)
 I YEAR'="",'$O(^OOPS(2260,"B",(YEAR_"00000"))) W !,"No date for that Fiscal Year please select again." G R1
"RTN","OOPSPRT1",42,0)
 Q
"RTN","OOPSPRT1",43,0)
STATION(STA,OUT) ;
"RTN","OOPSPRT1",44,0)
 S STA=""
"RTN","OOPSPRT1",45,0)
 N DIC,DIR,DIRUT,Y
"RTN","OOPSPRT1",46,0)
 S DIR(0)="Y",DIR("A")="Run report for 'ALL' Stations",DIR("B")="Yes"
"RTN","OOPSPRT1",47,0)
 S DIR("?")="Enter 'Y'es to run for all Stations or 'N'o to run "
"RTN","OOPSPRT1",48,0)
 S DIR("?")=DIR("?")_"for just one Station."
"RTN","OOPSPRT1",49,0)
 D ^DIR I Y S STA="A" Q
"RTN","OOPSPRT1",50,0)
 I $D(DIRUT)!($D(DUOUT)) S OUT=1 Q
"RTN","OOPSPRT1",51,0)
S1 ; if get here user <CR>
"RTN","OOPSPRT1",52,0)
 S DIC("A")="Select STATION NUMBER: "
"RTN","OOPSPRT1",53,0)
 S DIC="^DIC(4,",DIC(0)="AEMQZ"
"RTN","OOPSPRT1",54,0)
 D ^DIC K DIC
"RTN","OOPSPRT1",55,0)
 I Y=-1 W !?5,"No Station selected, report will not run" S OUT=1 Q
"RTN","OOPSPRT1",56,0)
 S STA=+Y
"RTN","OOPSPRT1",57,0)
 I '$D(^OOPS(2260,"D",STA)) W !?5,"No data for that Station Number, Please select again." G S1
"RTN","OOPSPRT1",58,0)
 Q
"RTN","OOPSPRT1",59,0)
DEVICE ; This is the device selection routine.
"RTN","OOPSPRT1",60,0)
 ;
"RTN","OOPSPRT1",61,0)
 S %ZIS="QM" D ^%ZIS I POP S OUT=1 Q
"RTN","OOPSPRT1",62,0)
 I $D(IO("Q")) D  Q
"RTN","OOPSPRT1",63,0)
 .S ZTRTN="PRINT^OOPSPRT1",ZTDESC="Print Accident Report Sign-off list"
"RTN","OOPSPRT1",64,0)
 .S ZTSAVE("YEAR")="",ZTSAVE("STA")=""   ; Patch 5 - added STA
"RTN","OOPSPRT1",65,0)
 .S ZTSAVE("OUT")=""
"RTN","OOPSPRT1",66,0)
 .S ZTSAVE("CALLER")=""
"RTN","OOPSPRT1",67,0)
 .S ZTSAVE("SSN")=""
"RTN","OOPSPRT1",68,0)
 .S ZTSAVE("PAGE")=""
"RTN","OOPSPRT1",69,0)
 .D ^%ZTLOAD D HOME^%ZIS Q
"RTN","OOPSPRT1",70,0)
 .Q
"RTN","OOPSPRT1",71,0)
 Q
"RTN","OOPSPRT1",72,0)
PRINT ; This is the main print portion of the routine
"RTN","OOPSPRT1",73,0)
 N CNT,LOOP,OUTPUT
"RTN","OOPSPRT1",74,0)
 S CNT=0,OUTPUT=0
"RTN","OOPSPRT1",75,0)
 S LOOP=$S(STA="A":"",1:STA)
"RTN","OOPSPRT1",76,0)
 U IO
"RTN","OOPSPRT1",77,0)
 I STA'="A" D ONE Q
"RTN","OOPSPRT1",78,0)
MAIN ; Main Loop
"RTN","OOPSPRT1",79,0)
 F  S LOOP=$O(^OOPS(2260,"D",LOOP)) Q:LOOP=""!OUT  S HEAD=1 D HEAD Q:OUT  D
"RTN","OOPSPRT1",80,0)
 . S IEN=0 F  S IEN=$O(^OOPS(2260,"D",LOOP,IEN)) Q:IEN<1!OUT  D DATA
"RTN","OOPSPRT1",81,0)
 Q
"RTN","OOPSPRT1",82,0)
ONE ; Only 1 Station Selected
"RTN","OOPSPRT1",83,0)
 D HEAD
"RTN","OOPSPRT1",84,0)
 S IEN=0 F  S IEN=$O(^OOPS(2260,"D",LOOP,IEN)) Q:IEN<1!OUT  D DATA
"RTN","OOPSPRT1",85,0)
 Q
"RTN","OOPSPRT1",86,0)
DATA ; Loop to get & print data
"RTN","OOPSPRT1",87,0)
 N CASE,NAME,SSN1,DATE,INC,CAT,YR
"RTN","OOPSPRT1",88,0)
 S CASE=$$GET1^DIQ(2260,IEN,.01)
"RTN","OOPSPRT1",89,0)
 S YR=$E(CASE,1,4)
"RTN","OOPSPRT1",90,0)
 I YEAR,YEAR'=YR Q
"RTN","OOPSPRT1",91,0)
 ; Only get OPEN cases - field 51 - 0 = OPEN
"RTN","OOPSPRT1",92,0)
 I $$GET1^DIQ(2260,IEN,51,"I") Q
"RTN","OOPSPRT1",93,0)
 S INC=$$GET1^DIQ(2260,IEN,52,"I")
"RTN","OOPSPRT1",94,0)
 S NAME=$E($$GET1^DIQ(2260,IEN,1,"E"),1,30)
"RTN","OOPSPRT1",95,0)
 S SSN1=$$GET1^DIQ(2260,IEN,5,"E")
"RTN","OOPSPRT1",96,0)
 S DATE=$$GET1^DIQ(2260,IEN,4,"E")
"RTN","OOPSPRT1",97,0)
 S CAT=$$GET1^DIQ(2260,IEN,2,"I")
"RTN","OOPSPRT1",98,0)
 S CNT=CNT+1
"RTN","OOPSPRT1",99,0)
 I CALLER="E" Q:SSN'=SSN1
"RTN","OOPSPRT1",100,0)
 I CALLER="S" I ($$GET1^DIQ(2260,IEN,53,"I")'=DUZ),($$GET1^DIQ(2260,IEN,53.1,"I")'=DUZ) Q
"RTN","OOPSPRT1",101,0)
 D HEAD Q:OUT
"RTN","OOPSPRT1",102,0)
 W !!,CASE
"RTN","OOPSPRT1",103,0)
 W:CALLER'="U" ?12,NAME,?42,SSN1
"RTN","OOPSPRT1",104,0)
 W ?57,DATE S OUTPUT=1
"RTN","OOPSPRT1",105,0)
 W !,?35,"   CA1   ",?50,"   CA2   ",?65,"  2162   "
"RTN","OOPSPRT1",106,0)
 W !,?35,"---------",?50,"---------",?65,"---------"
"RTN","OOPSPRT1",107,0)
 D          ; Employee Data
"RTN","OOPSPRT1",108,0)
 . N SIGN
"RTN","OOPSPRT1",109,0)
 . S SIGN=$$EDSTA^OOPSUTL1(IEN,"E")
"RTN","OOPSPRT1",110,0)
 . W !,?20,"EMPLOYEE:"
"RTN","OOPSPRT1",111,0)
 . I INC=1 W ?35
"RTN","OOPSPRT1",112,0)
 . I INC=2 W ?50
"RTN","OOPSPRT1",113,0)
 . ; Also, not a Non-PAID Employee either
"RTN","OOPSPRT1",114,0)
 . ; Patch 5 - logic changed for new Personnel Categories
"RTN","OOPSPRT1",115,0)
 . I '$$ISEMP^OOPSUTL4(IEN) W "N/A(",$E($$GET1^DIQ(2260,IEN,2,"E"),1,7),")" Q
"RTN","OOPSPRT1",116,0)
 . W $S($P(SIGN,U,INC):" ",1:"UN-"),"SIGNED"
"RTN","OOPSPRT1",117,0)
 . Q
"RTN","OOPSPRT1",118,0)
 Q:CALLER="E"
"RTN","OOPSPRT1",119,0)
 D           ; Supervisor Data
"RTN","OOPSPRT1",120,0)
 . N SIGN
"RTN","OOPSPRT1",121,0)
 . S SIGN=$$EDSTA^OOPSUTL1(IEN,"S")
"RTN","OOPSPRT1",122,0)
 . W !,?20,"SUPERVISOR:"
"RTN","OOPSPRT1",123,0)
 . I INC=1 W ?35
"RTN","OOPSPRT1",124,0)
 . I INC=2 W ?50
"RTN","OOPSPRT1",125,0)
 .;Also not a Non-Paid Employee either
"RTN","OOPSPRT1",126,0)
 .; Patch 5 - See above
"RTN","OOPSPRT1",127,0)
 . I '$$ISEMP^OOPSUTL4(IEN) W "N/A(",$E($$GET1^DIQ(2260,IEN,2,"E"),1,7),")"
"RTN","OOPSPRT1",128,0)
 . E  W $S($P(SIGN,U,INC):" ",1:"UN-"),"SIGNED"
"RTN","OOPSPRT1",129,0)
 . W ?65,$S($P(SIGN,U,3):" ",1:"UN-"),"SIGNED"
"RTN","OOPSPRT1",130,0)
 . Q
"RTN","OOPSPRT1",131,0)
 Q:CALLER="S"
"RTN","OOPSPRT1",132,0)
 D           ; Safety Officer Data
"RTN","OOPSPRT1",133,0)
 . N SIGN
"RTN","OOPSPRT1",134,0)
 . S SIGN=$$EDSTA^OOPSUTL1(IEN,"O")
"RTN","OOPSPRT1",135,0)
 . W !,?20,"SAFETY OFFICER:"
"RTN","OOPSPRT1",136,0)
 . W ?65,$S($P(SIGN,U):" ",1:"UN-"),"SIGNED"
"RTN","OOPSPRT1",137,0)
 . Q
"RTN","OOPSPRT1",138,0)
 Q
"RTN","OOPSPRT1",139,0)
END ; exit the report
"RTN","OOPSPRT1",140,0)
 I 'OUTPUT W !,?20,"No Data Found for this report."
"RTN","OOPSPRT1",141,0)
 D ^%ZISC
"RTN","OOPSPRT1",142,0)
 S:$D(ZTQUEUED) ZTREQ="@"
"RTN","OOPSPRT1",143,0)
 Q
"RTN","OOPSPRT1",144,0)
HEAD ; This is the head portion of the routine
"RTN","OOPSPRT1",145,0)
 I PAGE=1 D
"RTN","OOPSPRT1",146,0)
 .W:$E(IOST,1,2)="C-" @IOF
"RTN","OOPSPRT1",147,0)
 .Q
"RTN","OOPSPRT1",148,0)
 I PAGE'=1 Q:($Y<(IOSL-6)&('HEAD))
"RTN","OOPSPRT1",149,0)
 I $E(IOST,1,2)="C-" D  Q:OUT
"RTN","OOPSPRT1",150,0)
 .I PAGE=1 W @IOF Q
"RTN","OOPSPRT1",151,0)
 .I PAGE'=1 D  Q:OUT
"RTN","OOPSPRT1",152,0)
 ..N DIR S DIR(0)="E" D ^DIR I 'Y S OUT=1
"RTN","OOPSPRT1",153,0)
 ..K Y
"RTN","OOPSPRT1",154,0)
 ..Q
"RTN","OOPSPRT1",155,0)
 .Q
"RTN","OOPSPRT1",156,0)
 Q:OUT
"RTN","OOPSPRT1",157,0)
 I PAGE'=1 W @IOF
"RTN","OOPSPRT1",158,0)
 N LINER,TAB,LINE2,TAB2
"RTN","OOPSPRT1",159,0)
 W !,$$FMTE^XLFDT($$NOW^XLFDT,1),?70,"PAGE: ",PAGE,!
"RTN","OOPSPRT1",160,0)
 S LINER="Accident Report Status"_$S(YEAR="":"",1:" for the fiscal Year "_YEAR)
"RTN","OOPSPRT1",161,0)
 S TAB=(40-($L(LINER)/2))
"RTN","OOPSPRT1",162,0)
 S LINE2="Station Number: "_$$GET1^DIQ(4,LOOP,.01,"E")
"RTN","OOPSPRT1",163,0)
 S TAB2=(40-($L(LINE2)/2))
"RTN","OOPSPRT1",164,0)
 W ?TAB,LINER,!,?TAB2,LINE2
"RTN","OOPSPRT1",165,0)
 W !,"Case No."
"RTN","OOPSPRT1",166,0)
 W:CALLER'="U" ?12,"Name",?46,"SSN"
"RTN","OOPSPRT1",167,0)
 W ?57,"DATE OF INCIDENT"
"RTN","OOPSPRT1",168,0)
 W !,"============================================================================="
"RTN","OOPSPRT1",169,0)
 S PAGE=PAGE+1,HEAD=""
"RTN","OOPSPRT1",170,0)
 Q
"RTN","OOPSSOF1")
0^7^B4960225
"RTN","OOPSSOF1",1,0)
OOPSSOF1 ;HINES/WAA - SOF/E Safety officer Edit Routine ;3/30/98  10:46
"RTN","OOPSSOF1",2,0)
 ;;1.0;ASISTS;**1,5**;Jun 01, 1998
"RTN","OOPSSOF1",3,0)
 ;;
"RTN","OOPSSOF1",4,0)
EN1 ;  Main Entry Point
"RTN","OOPSSOF1",5,0)
 N SSN,IEN,CLOSED,FORM,SIGN
"RTN","OOPSSOF1",6,0)
 S IEN=0
"RTN","OOPSSOF1",7,0)
 Q:DUZ<1
"RTN","OOPSSOF1",8,0)
 Q:$G(^VA(200,DUZ,1))=""
"RTN","OOPSSOF1",9,0)
 S SSN=$P(^VA(200,DUZ,1),U,9)
"RTN","OOPSSOF1",10,0)
 D  Q:IEN<1
"RTN","OOPSSOF1",11,0)
 .N DIC,X
"RTN","OOPSSOF1",12,0)
 .S DIC="^OOPS(2260,",DIC("S")="I '$$GET1^DIQ(2260,Y,51,""I""),$$SAFETY^OOPSUTL2(Y)"
"RTN","OOPSSOF1",13,0)
 .S DIC(0)="AEMNZ",DIC("A")="Select Case: "
"RTN","OOPSSOF1",14,0)
 .D ^DIC
"RTN","OOPSSOF1",15,0)
 .Q:Y<1
"RTN","OOPSSOF1",16,0)
 .Q:$D(DTOUT)!($D(DUOUT))
"RTN","OOPSSOF1",17,0)
 .S IEN=$P(Y,U)
"RTN","OOPSSOF1",18,0)
 .Q
"RTN","OOPSSOF1",19,0)
 D FORM ;Q:$D(Y)=0
"RTN","OOPSSOF1",20,0)
 D SIGN(FORM)
"RTN","OOPSSOF1",21,0)
 I $P(SIGN,U) D FILE
"RTN","OOPSSOF1",22,0)
 D CLOSE
"RTN","OOPSSOF1",23,0)
 Q
"RTN","OOPSSOF1",24,0)
CLOSE ; Close
"RTN","OOPSSOF1",25,0)
 N DR,DIE,SIGN2
"RTN","OOPSSOF1",26,0)
 S DR=""
"RTN","OOPSSOF1",27,0)
 S DR="51 CASE STATUS..................//C"
"RTN","OOPSSOF1",28,0)
 S DIE="^OOPS(2260,",DA=IEN
"RTN","OOPSSOF1",29,0)
 D ^DIE
"RTN","OOPSSOF1",30,0)
 I $D(Y)'=0 Q
"RTN","OOPSSOF1",31,0)
 Q
"RTN","OOPSSOF1",32,0)
CLEAR(IEN) ; Clear out the old ES
"RTN","OOPSSOF1",33,0)
 N FLG,FLD
"RTN","OOPSSOF1",34,0)
 S FLG=0
"RTN","OOPSSOF1",35,0)
 F FLD=4:1:6 I $P(^OOPS(2260,IEN,"2162ES"),U,FLD)'="" S $P(^OOPS(2260,IEN,"2162ES"),U,FLD)="",FLG=1
"RTN","OOPSSOF1",36,0)
 I FLG W !,"Your ES has been cleared.  You will need to resign.",!
"RTN","OOPSSOF1",37,0)
 Q
"RTN","OOPSSOF1",38,0)
FORM ; Form
"RTN","OOPSSOF1",39,0)
 S FORM="2162"
"RTN","OOPSSOF1",40,0)
 N DR,DIE,SIGN2
"RTN","OOPSSOF1",41,0)
 D DISPLAY^OOPSSUP1
"RTN","OOPSSOF1",42,0)
 D CLEAR(IEN)
"RTN","OOPSSOF1",43,0)
 S DR=""
"RTN","OOPSSOF1",44,0)
 ; Patch 5 - changed order of the following 2 prompts
"RTN","OOPSSOF1",45,0)
 S DR(1,2260,1)="47 CORRECTIVE ACTION TAKEN......"
"RTN","OOPSSOF1",46,0)
 S DR(1,2260,2)="55 SAFETY OFF. COMMENTS........."
"RTN","OOPSSOF1",47,0)
 S DIE="^OOPS(2260,",DA=IEN
"RTN","OOPSSOF1",48,0)
 D ^DIE
"RTN","OOPSSOF1",49,0)
 I $D(Y)'=0 Q
"RTN","OOPSSOF1",50,0)
 Q
"RTN","OOPSSOF1",51,0)
SIGN(FORM) ; Sign/validate Document
"RTN","OOPSSOF1",52,0)
 N EMP,INC,VALID,SSIGN,ESIGN,WHO,DOCUM
"RTN","OOPSSOF1",53,0)
 S VALID=0,SIGN=""
"RTN","OOPSSOF1",54,0)
 S WHO=""
"RTN","OOPSSOF1",55,0)
 D VALIDATE^OOPSUTL4(IEN,FORM,"O",.VALID)
"RTN","OOPSSOF1",56,0)
 S INC=$$GET1^DIQ(2260,IEN,52,"I")
"RTN","OOPSSOF1",57,0)
 S DOCUM=$S(INC=1:"CA1",INC=2:"CA2",1:"")
"RTN","OOPSSOF1",58,0)
 S SSIGN=$$EDSTA^OOPSUTL1(IEN,"S")
"RTN","OOPSSOF1",59,0)
 S ESIGN=$$EDSTA^OOPSUTL1(IEN,"S")
"RTN","OOPSSOF1",60,0)
 I '$P(SSIGN,U,3) D  Q
"RTN","OOPSSOF1",61,0)
 .W !,"The Supervisor portion of the 2162 has not been Signed."
"RTN","OOPSSOF1",62,0)
 .Q
"RTN","OOPSSOF1",63,0)
 I 'VALID Q
"RTN","OOPSSOF1",64,0)
 S SIGN=$$SIG^OOPSESIG(DUZ,IEN)
"RTN","OOPSSOF1",65,0)
 Q
"RTN","OOPSSOF1",66,0)
FILE ;File the ES and send a bull
"RTN","OOPSSOF1",67,0)
 S $P(^OOPS(2260,IEN,"2162ES"),U,4,6)=SIGN
"RTN","OOPSSOF1",68,0)
 Q
"RTN","OOPSSOF2")
0^8^B1745457
"RTN","OOPSSOF2",1,0)
OOPSSOF2 ;HINES/WAA - SOF/E Safety officer CLOSE Routine ;3/30/98  10:46
"RTN","OOPSSOF2",2,0)
 ;;1.0;ASISTS;**1,5**;Jun 01, 1998
"RTN","OOPSSOF2",3,0)
 ;;
"RTN","OOPSSOF2",4,0)
EN1 ;  Main Entry Point
"RTN","OOPSSOF2",5,0)
 N SSN,IEN,CLOSED,FORM,SIGN
"RTN","OOPSSOF2",6,0)
 S IEN=0
"RTN","OOPSSOF2",7,0)
 D  Q:IEN<1
"RTN","OOPSSOF2",8,0)
 .N DIC,X
"RTN","OOPSSOF2",9,0)
 .S DIC="^OOPS(2260,"
"RTN","OOPSSOF2",10,0)
 .S DIC(0)="AEMNZ",DIC("S")="I $$GET1^DIQ(2260,Y,51,""I"")'=3",DIC("A")="Select Case: "
"RTN","OOPSSOF2",11,0)
 .D ^DIC
"RTN","OOPSSOF2",12,0)
 .Q:Y<1
"RTN","OOPSSOF2",13,0)
 .Q:$D(DTOUT)!($D(DUOUT))
"RTN","OOPSSOF2",14,0)
 .S IEN=$P(Y,U)
"RTN","OOPSSOF2",15,0)
 .Q
"RTN","OOPSSOF2",16,0)
CLOSE ; Close
"RTN","OOPSSOF2",17,0)
 N DR,DIE,SIGN2,CURSTAT,DIR
"RTN","OOPSSOF2",18,0)
 D DISPLAY^OOPSSUP1
"RTN","OOPSSOF2",19,0)
 S CURSTAT=$$GET1^DIQ(2260,IEN,51,"E")
"RTN","OOPSSOF2",20,0)
 S DIR(0)="SAO^0:Open;1:Closed;2:Deleted"
"RTN","OOPSSOF2",21,0)
 S DIR("A")="CASE STATUS.................."
"RTN","OOPSSOF2",22,0)
 S DIR("B")=$S(CURSTAT'="":$E(CURSTAT,1),1:"C") D ^DIR
"RTN","OOPSSOF2",23,0)
 I $D(DIRUT) Q
"RTN","OOPSSOF2",24,0)
 S DR=""
"RTN","OOPSSOF2",25,0)
 ; Patch 5 - Clear Field 57 when needed
"RTN","OOPSSOF2",26,0)
 I CURSTAT="Closed" D
"RTN","OOPSSOF2",27,0)
 . I $$EXTERNAL^DILFD(2260,51,,Y)["Deleted" Q    ; Perserve Date
"RTN","OOPSSOF2",28,0)
 . I $$EXTERNAL^DILFD(2260,51,,Y)'[CURSTAT D
"RTN","OOPSSOF2",29,0)
 .. S DR(1,2260,2)="57////@"
"RTN","OOPSSOF2",30,0)
 S DR(1,2260,1)="51////"_Y
"RTN","OOPSSOF2",31,0)
 S DIE="^OOPS(2260,",DA=IEN
"RTN","OOPSSOF2",32,0)
 D ^DIE
"RTN","OOPSSOF2",33,0)
 ; I $D(Y)'=0 Q
"RTN","OOPSSOF2",34,0)
 Q
"RTN","OOPSSUP1")
0^11^B31529635
"RTN","OOPSSUP1",1,0)
OOPSSUP1 ;HINES/WAA - S/E Supervisor Edit routine [ 04/17/1998  3:18 PM ]
"RTN","OOPSSUP1",2,0)
 ;;1.0;ASISTS;**1,3,5**;Jun 01, 1998
"RTN","OOPSSUP1",3,0)
 ;;
"RTN","OOPSSUP1",4,0)
EN1(CALLER) ;  Main Entry Point
"RTN","OOPSSUP1",5,0)
 S CALLER=$G(CALLER,"S") ; check CALLER
"RTN","OOPSSUP1",6,0)
 N SSN,IEN,EDIT,OUT,FORM,SUP
"RTN","OOPSSUP1",7,0)
 S EDIT=""
"RTN","OOPSSUP1",8,0)
 S (OUT,IEN)=0
"RTN","OOPSSUP1",9,0)
 Q:DUZ<1
"RTN","OOPSSUP1",10,0)
 Q:$G(^VA(200,DUZ,1))=""
"RTN","OOPSSUP1",11,0)
 D INCIDENT(CALLER) Q:IEN<1  ; Select a Employee
"RTN","OOPSSUP1",12,0)
 D DISPLAY ; Display header information
"RTN","OOPSSUP1",13,0)
 D SELECT  ; Select the form to be processed.
"RTN","OOPSSUP1",14,0)
 Q:EDIT=""
"RTN","OOPSSUP1",15,0)
 D FORMS ; Process the forms that ther user selected
"RTN","OOPSSUP1",16,0)
 Q
"RTN","OOPSSUP1",17,0)
DISPLAY ; Display case data
"RTN","OOPSSUP1",18,0)
 D ^OOPSDIS
"RTN","OOPSSUP1",19,0)
 Q
"RTN","OOPSSUP1",20,0)
SELECT ; Select a form
"RTN","OOPSSUP1",21,0)
 ; Injury (2162,CA1)
"RTN","OOPSSUP1",22,0)
 ; Illness (2162,CA2)
"RTN","OOPSSUP1",23,0)
 ; VA form 2162
"RTN","OOPSSUP1",24,0)
 ; Get the type of incident
"RTN","OOPSSUP1",25,0)
 ; If the supporting global doesn't exist force the 
"RTN","OOPSSUP1",26,0)
 ; Supervisor to fill both the 2162 and supporting form.
"RTN","OOPSSUP1",27,0)
 N SIGN,INC,SAFE,CAT
"RTN","OOPSSUP1",28,0)
 S EDIT=""
"RTN","OOPSSUP1",29,0)
 S SIGN=$$EDSTA^OOPSUTL1(IEN,"S")
"RTN","OOPSSUP1",30,0)
 S INC=$$GET1^DIQ(2260,IEN,52,"I")
"RTN","OOPSSUP1",31,0)
 S SAFE=+$$EDSTA^OOPSUTL1(IEN,"O")
"RTN","OOPSSUP1",32,0)
 ; Allow Non-PAID employee - CAT=6
"RTN","OOPSSUP1",33,0)
 S CAT=$$GET1^DIQ(2260,IEN,2,"I")
"RTN","OOPSSUP1",34,0)
 ; Patch 5 - change logic for other Personnel Types
"RTN","OOPSSUP1",35,0)
 I '$$ISEMP^OOPSUTL4(IEN),'SAFE S EDIT="2162" Q  ; Person is not EMP/NONPAID
"RTN","OOPSSUP1",36,0)
 I SAFE S EDIT=$P("CA1^CA2",U,INC) Q
"RTN","OOPSSUP1",37,0)
 ;  ^...The safety officer has sign and ca1 or ca2 can be edited
"RTN","OOPSSUP1",38,0)
 S INCTYP=$P("CA1^CA2",U,INC)
"RTN","OOPSSUP1",39,0)
 I $P($$EDSTA^OOPSUTL1(IEN,"E"),U,INC),$P($$EDSTA^OOPSUTL1(IEN,"S"),U,INC) S EDIT="2162" Q
"RTN","OOPSSUP1",40,0)
 I '$$CHECK^OOPSUTL3(IEN,INCTYP) S EDIT="2162^"_INCTYP Q
"RTN","OOPSSUP1",41,0)
 ;     No data has been entered for the ca1/2
"RTN","OOPSSUP1",42,0)
 ; ^^^ Force the Super to edit both and once.
"RTN","OOPSSUP1",43,0)
 S EDIT=""
"RTN","OOPSSUP1",44,0)
 I '$P(SIGN,U,3)
"RTN","OOPSSUP1",45,0)
 N DIR,Y
"RTN","OOPSSUP1",46,0)
 N PROMPT1,PROMPT2,SEL1,SEL2
"RTN","OOPSSUP1",47,0)
 S PROMPT1="1) VA FORM 2162 "
"RTN","OOPSSUP1",48,0)
 S PROMPT2="              2) "_$S(INC=1:"Injury (CA1",INC=2:"Illness (CA2",1:"")_")"
"RTN","OOPSSUP1",49,0)
 W !," Select form: ",PROMPT1
"RTN","OOPSSUP1",50,0)
 W !,PROMPT2
"RTN","OOPSSUP1",51,0)
 S DIR(0)="SAO^1:2162;2:"_$S(INC=1:"CA1",INC=2:"CA2",1:"")
"RTN","OOPSSUP1",52,0)
 S DIR("A")=" Select form: "
"RTN","OOPSSUP1",53,0)
 S DIR("?")=" Select the form to be edited."
"RTN","OOPSSUP1",54,0)
 D ^DIR
"RTN","OOPSSUP1",55,0)
 I '$D(Y(0)) S EDIT="" Q
"RTN","OOPSSUP1",56,0)
 S EDIT=Y(0)
"RTN","OOPSSUP1",57,0)
 Q
"RTN","OOPSSUP1",58,0)
CLEAR(IEN,FORM) ; Clear out the old ES
"RTN","OOPSSUP1",59,0)
 N ES,FLG
"RTN","OOPSSUP1",60,0)
 S FLG=0
"RTN","OOPSSUP1",61,0)
 S ES=$S(FORM="CA1":"CA1ES",FORM="CA2":"CA2ES",FORM="2162":"2162ES",1:0) Q:ES=0
"RTN","OOPSSUP1",62,0)
 Q:$GET(^OOPS(2260,IEN,ES))=""
"RTN","OOPSSUP1",63,0)
 I FORM'=2162 D  I FLG S $P(^OOPS(2260,IEN,ES),U,4,6)="^^"
"RTN","OOPSSUP1",64,0)
 .N I
"RTN","OOPSSUP1",65,0)
 .F I=4:1:6 I $P(^OOPS(2260,IEN,ES),U,I)'="" S FLG=1 Q
"RTN","OOPSSUP1",66,0)
 .Q
"RTN","OOPSSUP1",67,0)
 I FORM=2162 D  I FLG S $P(^OOPS(2260,IEN,ES),U,1,3)="^^"
"RTN","OOPSSUP1",68,0)
 .N I
"RTN","OOPSSUP1",69,0)
 .F I=1:1:3 I $P(^OOPS(2260,IEN,ES),U,I)'="" S FLG=1 Q
"RTN","OOPSSUP1",70,0)
 .Q
"RTN","OOPSSUP1",71,0)
 I FLG W !,"Your ES for ",FORM," has been cleared.  You will need to resign.",!
"RTN","OOPSSUP1",72,0)
 Q
"RTN","OOPSSUP1",73,0)
INCIDENT(CALLER) ; Select a case
"RTN","OOPSSUP1",74,0)
 N DIC,X
"RTN","OOPSSUP1",75,0)
 S DIC="^OOPS(2260,"
"RTN","OOPSSUP1",76,0)
 I CALLER="S" S DIC("S")="I $$SUP^OOPSSUP1(Y)"
"RTN","OOPSSUP1",77,0)
 I CALLER="O" S DIC("S")="I $$SAFETY^OOPSSUP1(Y)"
"RTN","OOPSSUP1",78,0)
 S DIC(0)="AEMNZ",DIC("A")="   Select Case: "
"RTN","OOPSSUP1",79,0)
 D ^DIC
"RTN","OOPSSUP1",80,0)
 Q:Y<1
"RTN","OOPSSUP1",81,0)
 Q:$D(DTOUT)!($D(DUOUT))
"RTN","OOPSSUP1",82,0)
 S IEN=$P(Y,U)
"RTN","OOPSSUP1",83,0)
 Q
"RTN","OOPSSUP1",84,0)
SUP(IEN) ; Supervisor Screen
"RTN","OOPSSUP1",85,0)
 N VIEW
"RTN","OOPSSUP1",86,0)
 S VIEW=1
"RTN","OOPSSUP1",87,0)
 I $$GET1^DIQ(2260,IEN,51,"I") S VIEW=0 ; Case is not open
"RTN","OOPSSUP1",88,0)
 I $$GET1^DIQ(2260,IEN,53,"I")'=DUZ,$$GET1^DIQ(2260,IEN,53.1,"I")'=DUZ S VIEW=0 ; Not the Super or Alternate Super
"RTN","OOPSSUP1",89,0)
 ; Patch 5 - new $$ for determining if employee
"RTN","OOPSSUP1",90,0)
 I '$$ISEMP^OOPSUTL4(IEN) D  ; person is not an employee
"RTN","OOPSSUP1",91,0)
 .I +$$EDSTA^OOPSUTL1(IEN,"O") S VIEW=0 Q  ; Safety has signed
"RTN","OOPSSUP1",92,0)
 .Q
"RTN","OOPSSUP1",93,0)
 E  D  ; This will filter emps who have sign, sup who sign and safety who sign
"RTN","OOPSSUP1",94,0)
 .S INC=$$GET1^DIQ(2260,IEN,52,"I")
"RTN","OOPSSUP1",95,0)
 .I $P($$EDSTA^OOPSUTL1(IEN,"E"),U,INC),$P($$EDSTA^OOPSUTL1(IEN,"S"),U,INC),+$$EDSTA^OOPSUTL1(IEN,"O") S VIEW=0
"RTN","OOPSSUP1",96,0)
 .Q
"RTN","OOPSSUP1",97,0)
 Q VIEW
"RTN","OOPSSUP1",98,0)
SAFETY(IEN) ; Safety officer screen
"RTN","OOPSSUP1",99,0)
 N VIEW,INC
"RTN","OOPSSUP1",100,0)
 S VIEW=1
"RTN","OOPSSUP1",101,0)
 S INC=$$GET1^DIQ(2260,IEN,52,"I")
"RTN","OOPSSUP1",102,0)
 I $$GET1^DIQ(2260,IEN,51,"I") S VIEW=0 ; Case is not open
"RTN","OOPSSUP1",103,0)
 ;I $$GET1^DIQ(2260,IEN,53,"I")'=DUZ,$$GET1^DIQ(2260,IEN,53.1,"I")'=DUZ S VIEW=0 ; Not the Super or Alternate Super
"RTN","OOPSSUP1",104,0)
 I '$$ISEMP^OOPSUTL4(IEN) D       ; person is not an employee
"RTN","OOPSSUP1",105,0)
 .I +$$EDSTA^OOPSUTL1(IEN,"O") S VIEW=0 Q  ; Safety has signed
"RTN","OOPSSUP1",106,0)
 .Q
"RTN","OOPSSUP1",107,0)
 E  D  ; This will filter emps who have sign, sup who sign and safety who sign
"RTN","OOPSSUP1",108,0)
 .I $P($$EDSTA^OOPSUTL1(IEN,"E"),U,INC),$P($$EDSTA^OOPSUTL1(IEN,"S"),U,INC),+$$EDSTA^OOPSUTL1(IEN,"O") S VIEW=0
"RTN","OOPSSUP1",109,0)
 .Q
"RTN","OOPSSUP1",110,0)
 I $$GET1^DIQ(2260,IEN,53,"I")'=DUZ,$$GET1^DIQ(2260,IEN,53.1,"I")'=DUZ D
"RTN","OOPSSUP1",111,0)
 .I $P($$EDSTA^OOPSUTL1(IEN,"E"),U,INC),$P($$EDSTA^OOPSUTL1(IEN,"S"),U,INC),$P($$EDSTA^OOPSUTL1(IEN,"S"),U,3) S VIEW=0
"RTN","OOPSSUP1",112,0)
 .Q
"RTN","OOPSSUP1",113,0)
 Q VIEW
"RTN","OOPSSUP1",114,0)
FORMS ; Process Form
"RTN","OOPSSUP1",115,0)
 N I
"RTN","OOPSSUP1",116,0)
 F I=1:1 S FORM=$P(EDIT,U,I) Q:FORM=""  D  Q:OUT
"RTN","OOPSSUP1",117,0)
 .N DR,DIE,SIGN,EDIT,I
"RTN","OOPSSUP1",118,0)
 .I ($$GET1^DIQ(2260,IEN,53,"I")=DUZ!($$GET1^DIQ(2260,IEN,53.1,"I")=DUZ)) D CLEAR(IEN,FORM)
"RTN","OOPSSUP1",119,0)
 .I FORM="2162" D ASIST^OOPSSUP3 Q:OUT
"RTN","OOPSSUP1",120,0)
 .I FORM="CA1" D CA1^OOPSSUP2 Q:OUT
"RTN","OOPSSUP1",121,0)
 .I FORM="CA2" D CA2^OOPSSUP2 Q:OUT
"RTN","OOPSSUP1",122,0)
 .S DIE="^OOPS(2260,",DA=IEN
"RTN","OOPSSUP1",123,0)
 .D ^DIE
"RTN","OOPSSUP1",124,0)
 .I ($D(Y)'=0)!($G(DIRUT)=1)  S OUT=1 Q  ; Quit if user exits
"RTN","OOPSSUP1",125,0)
 .I $$GET1^DIQ(2260,IEN,53,"I")'=DUZ,$$GET1^DIQ(2260,IEN,53.1,"I")'=DUZ Q
"RTN","OOPSSUP1",126,0)
 .D SIGNS(FORM) ; Sign/validate Document
"RTN","OOPSSUP1",127,0)
 .Q:'$P(SIGN,U)   ; Quit if user doesn't sign
"RTN","OOPSSUP1",128,0)
 .D FILE ; User Signs and files
"RTN","OOPSSUP1",129,0)
 .Q
"RTN","OOPSSUP1",130,0)
 Q
"RTN","OOPSSUP1",131,0)
SIGNS(FORM) ; Sign/validate Document
"RTN","OOPSSUP1",132,0)
 N EMP,INC,VALID
"RTN","OOPSSUP1",133,0)
 S VALID=0,SIGN=""
"RTN","OOPSSUP1",134,0)
 S EMP=$$EDSTA^OOPSUTL1(IEN,"E")
"RTN","OOPSSUP1",135,0)
 S INC=$$GET1^DIQ(2260,IEN,52,"I")
"RTN","OOPSSUP1",136,0)
 D VALIDATE^OOPSUTL4(IEN,FORM,"S",.VALID)
"RTN","OOPSSUP1",137,0)
 I FORM'="2162",'$P(EMP,U,INC) D  Q  ;Employee has not signed yet
"RTN","OOPSSUP1",138,0)
 .W !,?10,"The employee has not signed the ",FORM,"." Q
"RTN","OOPSSUP1",139,0)
 .Q
"RTN","OOPSSUP1",140,0)
 I 'VALID Q
"RTN","OOPSSUP1",141,0)
 S SIGN=$$SIG^OOPSESIG(DUZ,IEN)
"RTN","OOPSSUP1",142,0)
 Q
"RTN","OOPSSUP1",143,0)
FILE ;File the ES and send a bull
"RTN","OOPSSUP1",144,0)
 I FORM="2162" S $P(^OOPS(2260,IEN,"2162ES"),U,1,3)=SIGN D SAFETY^OOPSMBUL(IEN)
"RTN","OOPSSUP1",145,0)
 I FORM="CA1" S $P(^OOPS(2260,IEN,"CA1ES"),U,4,6)=SIGN D UNION^OOPSMBUL(IEN)
"RTN","OOPSSUP1",146,0)
 I FORM="CA2" S $P(^OOPS(2260,IEN,"CA2ES"),U,4,6)=SIGN D UNION^OOPSMBUL(IEN)
"RTN","OOPSSUP1",147,0)
 Q
"RTN","OOPSSUP2")
0^14^B64366643
"RTN","OOPSSUP2",1,0)
OOPSSUP2 ;HINES/WAA - S/E Supervisor Edit routine [ 04/15/1998  1:26 PM ]
"RTN","OOPSSUP2",2,0)
 ;;1.0;ASISTS;**3,5**;Jun 01, 1998
"RTN","OOPSSUP2",3,0)
 ;;
"RTN","OOPSSUP2",4,0)
CA1 ; CA1 FORM
"RTN","OOPSSUP2",5,0)
 N ITEM,DTINJ
"RTN","OOPSSUP2",6,0)
 W !!," Federal Employee's Notice of Traumatic Injury and Claim"
"RTN","OOPSSUP2",7,0)
 W !," for Continuation of Pay/Compensation (Form CA-1)"
"RTN","OOPSSUP2",8,0)
 W !!,"     Witness"
"RTN","OOPSSUP2",9,0)
 W !,"     -------"
"RTN","OOPSSUP2",10,0)
 S DR=""
"RTN","OOPSSUP2",11,0)
 S DR(1,2260,.1)="115 16. NAME OF WITNESS..........."
"RTN","OOPSSUP2",12,0)
 S DR(1,2260,.2)="W !!,""     Supervisor's Report"""
"RTN","OOPSSUP2",13,0)
 S DR(1,2260,.3)="W !,""     -------------------"""
"RTN","OOPSSUP2",14,0)
 S DR(1,2260,1)="130 17. AGENCY NAME..............."
"RTN","OOPSSUP2",15,0)
 S DR(1,2260,2)="131     STREET ADDRESS............"
"RTN","OOPSSUP2",16,0)
 S DR(1,2260,3)="132     CITY......................"
"RTN","OOPSSUP2",17,0)
 S DR(1,2260,4)="133     STATE....................."
"RTN","OOPSSUP2",18,0)
 S DR(1,2260,5)="134     ZIP CODE.................."
"RTN","OOPSSUP2",19,0)
 S DR(1,2260,6)="176 18. EMPLOYEE'S DUTY STATION..."
"RTN","OOPSSUP2",20,0)
 S DR(1,2260,7)="177     STREET ADDRESS............"
"RTN","OOPSSUP2",21,0)
 S DR(1,2260,8)="178     CITY......................"
"RTN","OOPSSUP2",22,0)
 S DR(1,2260,9)="179     STATE....................."
"RTN","OOPSSUP2",23,0)
 S DR(1,2260,10)="180     ZIP CODE.................."
"RTN","OOPSSUP2",24,0)
 S DR(1,2260,11)="W !,"" 19. REGULAR WORK HOURS:"""
"RTN","OOPSSUP2",25,0)
 S DR(1,2260,12)="138     FROM......................"
"RTN","OOPSSUP2",26,0)
 S DR(1,2260,13)="139     TO........................"
"RTN","OOPSSUP2",27,0)
 S DR(1,2260,14)="S ITEM=20 W !,"" 20. REGULAR WORK SCHEDULE.....: ""_$$GET1^DIQ(2260,D0,140,""E"")"
"RTN","OOPSSUP2",28,0)
 S DR(1,2260,15)="K DIR S DIR(""A"")=""                                 "",DIR(""B"")=$$GET1^DIQ(2260,D0,140,""I"") D RWS^OOPSSUP2 S:$D(DIRUT) Y=""@2"""
"RTN","OOPSSUP2",29,0)
 ;
"RTN","OOPSSUP2",30,0)
 ; Default from 2162, require time entry but allow edit
"RTN","OOPSSUP2",31,0)
 ;
"RTN","OOPSSUP2",32,0)
 S DTINJ=$$GET1^DIQ(2260,IEN,4,"E")
"RTN","OOPSSUP2",33,0)
 S DR(1,2260,16)="4 21. DATE/TIME INJURY OCCURRED.......//^S X=DTINJ"
"RTN","OOPSSUP2",34,0)
 S DR(1,2260,16.1)="I $P(X,""."",2)="""" W !,""Time is REQUIRED in this response."" S Y=4"
"RTN","OOPSSUP2",35,0)
 S DR(1,2260,17)="175 22. DATE OF NOTICE RECEIVED..."
"RTN","OOPSSUP2",36,0)
 S DR(1,2260,17.5)="I X'="""",'$$FUT^OOPSUTL4($P(X,""."")) S Y=175"
"RTN","OOPSSUP2",37,0)
 S DR(1,2260,18)="142 23. DATE/TIME STOPPED WORK...."
"RTN","OOPSSUP2",38,0)
 S DR(1,2260,18.5)="I X'="""",'$$FUT^OOPSUTL4($P(X,""."")) S Y=142"
"RTN","OOPSSUP2",39,0)
 S DR(1,2260,19)="143 24. DATE PAY STOPPED.........."
"RTN","OOPSSUP2",40,0)
 S DR(1,2260,19.5)="I X'="""",'$$FUT^OOPSUTL4($P(X,""."")) S Y=143"
"RTN","OOPSSUP2",41,0)
 S DR(1,2260,20)="144 25. DATE 45 DAY PERIOD BEGAN.."
"RTN","OOPSSUP2",42,0)
 S DR(1,2260,20.5)="I X'="""",'$$FUT^OOPSUTL4($P(X,""."")) S Y=144"
"RTN","OOPSSUP2",43,0)
 S DR(1,2260,21)="145 26. DATE/TIME RETURNED TO WORK"
"RTN","OOPSSUP2",44,0)
 S DR(1,2260,21.5)="I X'="""",'$$FUT^OOPSUTL4($P(X,""."")) S Y=145"
"RTN","OOPSSUP2",45,0)
 S DR(1,2260,22)="146 27. WAS EMPLOYEE INJURED IN PERFORMANCE OF DUTY;I X=""Y"" S Y=148;"
"RTN","OOPSSUP2",46,0)
 S DR(1,2260,23)="147     EXPLANATION"
"RTN","OOPSSUP2",47,0)
 S DR(1,2260,24)="148 28. WAS INJURY CAUSED BY EMPLOYEE'S WILLFUL MISCONDUCT, INTOXICATION, OR            INTENT TO INJURE SELF OR ANOTHER;I X=""N"" S Y=150;"
"RTN","OOPSSUP2",48,0)
 S DR(1,2260,25)="149     EXPLANATION"
"RTN","OOPSSUP2",49,0)
 S DR(1,2260,26)="150 29. WAS INJURY CAUSED BY 3RD PARTY;I X=""N"" S Y=""@1"""
"RTN","OOPSSUP2",50,0)
 S DR(1,2260,27)="W !,"" 30. NAME AND ADDRESS OF THIRD PARTY:"""
"RTN","OOPSSUP2",51,0)
 S DR(1,2260,28)="151     NAME OF THIRD PARTY.......;I X="""" S Y=""@1"""
"RTN","OOPSSUP2",52,0)
 S DR(1,2260,29)="152     STREET ADDRESS............"
"RTN","OOPSSUP2",53,0)
 S DR(1,2260,30)="153     CITY......................"
"RTN","OOPSSUP2",54,0)
 S DR(1,2260,31)="154     STATE....................."
"RTN","OOPSSUP2",55,0)
 S DR(1,2260,32)="155     ZIP CODE.................."
"RTN","OOPSSUP2",56,0)
 S DR(1,2260,32.1)="@1"
"RTN","OOPSSUP2",57,0)
 S DR(1,2260,33)="W !,"" 31. NAME AND ADDRESS OF PHYSICIAN FIRST PROVIDING MEDICAL CARE:"""
"RTN","OOPSSUP2",58,0)
 S DR(1,2260,34)="156     NAME OF PHYSICIAN.........;I X="""" S Y=161"
"RTN","OOPSSUP2",59,0)
 S DR(1,2260,35)="157     STREET ADDRESS............"
"RTN","OOPSSUP2",60,0)
 S DR(1,2260,36)="158     CITY......................"
"RTN","OOPSSUP2",61,0)
 S DR(1,2260,37)="159     STATE....................."
"RTN","OOPSSUP2",62,0)
 S DR(1,2260,38)="160     ZIP CODE.................."
"RTN","OOPSSUP2",63,0)
 S DR(1,2260,39)="161 32. 1ST DATE MEDICAL CARE RECEIVED"
"RTN","OOPSSUP2",64,0)
 S DR(1,2260,39.5)="I X'="""",'$$FUT^OOPSUTL4(X) S Y=161"
"RTN","OOPSSUP2",65,0)
 S DR(1,2260,40)="162 33. DO MEDICAL REPORTS SHOW EMPLOYEE IS DISABLED FOR WORK"
"RTN","OOPSSUP2",66,0)
 S DR(1,2260,41)="163 34. DOES YOUR KNOWLEDGE OF THE FACTS AGREE WITH STATEMENTS OF THE EMPLOYEE;I X=""Y"" S Y=165"
"RTN","OOPSSUP2",67,0)
 S DR(1,2260,43)="164     EXPLANATION~"
"RTN","OOPSSUP2",68,0)
 S DR(1,2260,44)="W !"
"RTN","OOPSSUP2",69,0)
 S DR(1,2260,46)="165 35. IF THE EMPLOYING AGENCY CONTROVERTS CONTINUATION OF PAY, STATE THE REASON       IN DETAIL~"
"RTN","OOPSSUP2",70,0)
 S DR(1,2260,47)="W !!,"" 36. PAY RATE WHEN EMPLOYEE STOPPED WORK:"""
"RTN","OOPSSUP2",71,0)
 S DR(1,2260,48)="166     $........................."
"RTN","OOPSSUP2",72,0)
 S DR(1,2260,49)="167     PER......................."
"RTN","OOPSSUP2",73,0)
 S DR(1,2260,50)="W !!,""     Signature of Supervisor and Filing Instructions"""
"RTN","OOPSSUP2",74,0)
 S DR(1,2260,51)="W !,""     -----------------------------------------------"""
"RTN","OOPSSUP2",75,0)
 S DR(1,2260,52)="S ITEM=37 D EXCEPT^OOPSSUP2;168     EXCEPTION"
"RTN","OOPSSUP2",76,0)
 S DR(1,2260,53)="W !,""     NAME OF SUPERVISOR:  ""_SUP"
"RTN","OOPSSUP2",77,0)
 S DR(1,2260,54)="172     SUPERVISOR'S TITLE."
"RTN","OOPSSUP2",78,0)
 S DR(1,2260,55)="173     OFFICE PHONE......."
"RTN","OOPSSUP2",79,0)
 S DR(1,2260,56)="174 38. FILING INSTRUCTIONS"
"RTN","OOPSSUP2",80,0)
 S DR(1,2260,57)="@2"
"RTN","OOPSSUP2",81,0)
 Q
"RTN","OOPSSUP2",82,0)
CA2 ; CA2 FORM
"RTN","OOPSSUP2",83,0)
 N ITEM
"RTN","OOPSSUP2",84,0)
 W !!," Notice of Occupational Disease and Claim for Compensation (Form CA-2)"
"RTN","OOPSSUP2",85,0)
 W !!,"     Supervisor's Report"
"RTN","OOPSSUP2",86,0)
 W !,"     -------------------",!
"RTN","OOPSSUP2",87,0)
 S DR=""
"RTN","OOPSSUP2",88,0)
 S DR(1,2260,1)="230 19. AGENCY NAME..................."
"RTN","OOPSSUP2",89,0)
 S DR(1,2260,2)="231     STREET ADDRESS................"
"RTN","OOPSSUP2",90,0)
 S DR(1,2260,3)="232     CITY.........................."
"RTN","OOPSSUP2",91,0)
 S DR(1,2260,4)="233     STATE........................."
"RTN","OOPSSUP2",92,0)
 S DR(1,2260,5)="234     AGENCY ZIP CODE..............."
"RTN","OOPSSUP2",93,0)
 S DR(1,2260,6)="237 20. EMPLOYEE'S DUTY STATION......."
"RTN","OOPSSUP2",94,0)
 S DR(1,2260,7)="238     STREET ADDRESS................"
"RTN","OOPSSUP2",95,0)
 S DR(1,2260,8)="239     CITY.........................."
"RTN","OOPSSUP2",96,0)
 S DR(1,2260,9)="240     STATE........................."
"RTN","OOPSSUP2",97,0)
 S DR(1,2260,10)="241     ZIP CODE......................"
"RTN","OOPSSUP2",98,0)
 S DR(1,2260,11)="W !,"" 21. REGULAR WORK HOURS:"""
"RTN","OOPSSUP2",99,0)
 S DR(1,2260,12)="242     FROM.........................."
"RTN","OOPSSUP2",100,0)
 S DR(1,2260,13)="243     TO............................"
"RTN","OOPSSUP2",101,0)
 S DR(1,2260,14)="S ITEM=22 W !,"" 22. REGULAR WORK SCHEDULE.........: ""_$$GET1^DIQ(2260,D0,244,""E"")"
"RTN","OOPSSUP2",102,0)
 S DR(1,2260,15)="K DIR S DIR(""A"")=""                                     "",DIR(""B"")=$$GET1^DIQ(2260,D0,244,""I"") D RWS^OOPSSUP2 S:$D(DIRUT) Y=""@2"""
"RTN","OOPSSUP2",103,0)
 S DR(1,2260,16)="W !,"" 23. NAME AND ADDRESS OF PHYSICIAN FIRST PROVIDING MEDICAL CARE"""
"RTN","OOPSSUP2",104,0)
 S DR(1,2260,17)="245     NAME OF PHYSICIAN.............;I X="""" S Y=250"
"RTN","OOPSSUP2",105,0)
 S DR(1,2260,18)="246     STREET ADDRESS................"
"RTN","OOPSSUP2",106,0)
 S DR(1,2260,19)="247     CITY.........................."
"RTN","OOPSSUP2",107,0)
 S DR(1,2260,20)="248     STATE........................."
"RTN","OOPSSUP2",108,0)
 S DR(1,2260,21)="249     ZIP CODE......................"
"RTN","OOPSSUP2",109,0)
 S DR(1,2260,22)="250 24. 1ST DATE MEDICAL CARE RECEIVED"
"RTN","OOPSSUP2",110,0)
 S DR(1,2260,22.5)="I X'="""",'$$FUT^OOPSUTL4(X) S Y=250"
"RTN","OOPSSUP2",111,0)
 S DR(1,2260,23)="251 25. DO MEDICAL REPORTS SHOW EMPLOYEE IS DISABLED FOR WORK"
"RTN","OOPSSUP2",112,0)
 S DR(1,2260,24)="252 26. DATE EMPLOYEE FIRST REPORTED CONDITION TO SUPERVISOR."
"RTN","OOPSSUP2",113,0)
 S DR(1,2260,24.5)="I X'="""",'$$FUT^OOPSUTL4(X) S Y=252"
"RTN","OOPSSUP2",114,0)
 S DR(1,2260,25)="253 27. DATE/TIME EMPLOYEE STOPPED WORK.."
"RTN","OOPSSUP2",115,0)
 S DR(1,2260,25.5)="I X'="""",'$$FUT^OOPSUTL4($P(X,""."")) S Y=253"
"RTN","OOPSSUP2",116,0)
 S DR(1,2260,26)="254 28. DATE/TIME EMPLOYEE'S PAY STOPPED."
"RTN","OOPSSUP2",117,0)
 S DR(1,2260,26.5)="I X'="""",'$$FUT^OOPSUTL4($P(X,""."")) S Y=254"
"RTN","OOPSSUP2",118,0)
 S DR(1,2260,27)="255 29. DATE EMPLOYEE WAS LAST EXPOSED TO CONDITIONS ALLEGED TO HAVE CAUSED             DISEASE OR ILLNESS..............."
"RTN","OOPSSUP2",119,0)
 S DR(1,2260,28)="256 30. DATE/TIME RETURNED TO WORK......."
"RTN","OOPSSUP2",120,0)
 S DR(1,2260,28.5)="I X'="""",'$$FUT^OOPSUTL4($P(X,""."")) S Y=256"
"RTN","OOPSSUP2",121,0)
 S DR(1,2260,28.7)="@3"
"RTN","OOPSSUP2",122,0)
 S DR(1,2260,29)="W !,"" 31. IF EMPLOYEE HAS RETURNED TO WORK AND WORK ASSIGNMENT HAS CHANGED, DESCRIBE      NEW DUTIES"""
"RTN","OOPSSUP2",123,0)
 S DR(1,2260,31)="257     DESCRIPTION~"
"RTN","OOPSSUP2",124,0)
 S DR(1,2260,32)="W !"
"RTN","OOPSSUP2",125,0)
 S DR(1,2260,33)="258 32. WAS INJURY CAUSED BY 3RD PARTY;I X=""N"" S Y=""@1"""
"RTN","OOPSSUP2",126,0)
 S DR(1,2260,34)="259 33. NAME OF THIRD PARTY..........."
"RTN","OOPSSUP2",127,0)
 S DR(1,2260,35)="260     STREET ADDRESS................"
"RTN","OOPSSUP2",128,0)
 S DR(1,2260,36)="261     CITY.........................."
"RTN","OOPSSUP2",129,0)
 S DR(1,2260,37)="262     STATE........................."
"RTN","OOPSSUP2",130,0)
 S DR(1,2260,38)="263     ZIP CODE......................"
"RTN","OOPSSUP2",131,0)
 S DR(1,2260,38.1)="@1"
"RTN","OOPSSUP2",132,0)
 S DR(1,2260,39)="W !!,""     Signature of Supervisor"""
"RTN","OOPSSUP2",133,0)
 S DR(1,2260,40)="W !,""     -----------------------"""
"RTN","OOPSSUP2",134,0)
 S DR(1,2260,41)="S ITEM=34 D EXCEPT^OOPSSUP2;264     EXCEPTION"
"RTN","OOPSSUP2",135,0)
 S DR(1,2260,42)="W !,""     NAME OF SUPERVISOR: ""_SUP"
"RTN","OOPSSUP2",136,0)
 S DR(1,2260,43)="268     SUPERVISOR'S TITLE"
"RTN","OOPSSUP2",137,0)
 S DR(1,2260,44)="269     OFFICE PHONE......"
"RTN","OOPSSUP2",138,0)
 S DR(1,2260,45)="@2"
"RTN","OOPSSUP2",139,0)
 Q
"RTN","OOPSSUP2",140,0)
EXCEPT ; Exception statement
"RTN","OOPSSUP2",141,0)
 W !," ",ITEM,". A supervisor who knowingly certifies to any false statement,"
"RTN","OOPSSUP2",142,0)
 W !,"     misrepresentation, concealment of fact, etc., in respect of"
"RTN","OOPSSUP2",143,0)
 W !,"     this claim may also be subject to appropriate felony criminal"
"RTN","OOPSSUP2",144,0)
 W !,"     prosecution."
"RTN","OOPSSUP2",145,0)
 W !
"RTN","OOPSSUP2",146,0)
 W !,"     I certify that the information given above and that furnished"
"RTN","OOPSSUP2",147,0)
 W !,"     by the employee is true to the best of my knowledge with the"
"RTN","OOPSSUP2",148,0)
 W !,"     following exception."
"RTN","OOPSSUP2",149,0)
 W !
"RTN","OOPSSUP2",150,0)
 Q
"RTN","OOPSSUP2",151,0)
RWS ;Regular Work Schedule
"RTN","OOPSSUP2",152,0)
 N Y S DIR(0)="LA^1:7"
"RTN","OOPSSUP2",153,0)
 S DIR("?",1)="     Enter the employee's work schedule at the time of the incident."
"RTN","OOPSSUP2",154,0)
 S DIR("?",2)="     The numbers 1-7 correspond to the days of the week."
"RTN","OOPSSUP2",155,0)
 S DIR("?",3)="       1 = Sunday"
"RTN","OOPSSUP2",156,0)
 S DIR("?",4)="       2 = Monday"
"RTN","OOPSSUP2",157,0)
 S DIR("?",5)="       3 = Tuesday"
"RTN","OOPSSUP2",158,0)
 S DIR("?",6)="       4 = Wednesday"
"RTN","OOPSSUP2",159,0)
 S DIR("?",7)="       5 = Thursday"
"RTN","OOPSSUP2",160,0)
 S DIR("?",8)="       6 = Friday"
"RTN","OOPSSUP2",161,0)
 S DIR("?",9)="       7 = Saturday"
"RTN","OOPSSUP2",162,0)
 S DIR("?",10)="     Enter the day numbers as a range or list separated by commas."
"RTN","OOPSSUP2",163,0)
 S DIR("?",11)=""
"RTN","OOPSSUP2",164,0)
 S DIR("?",12)="     Examples: For Mon-Fri     enter 2-6 (or 2,3,4,5,6)"
"RTN","OOPSSUP2",165,0)
 S DIR("?",13)="               For Wed-Sat     enter 4-7 (or 4,5,6,7)"
"RTN","OOPSSUP2",166,0)
 S DIR("?")="               For Mon,Wed,Fri enter 2,4,6"
"RTN","OOPSSUP2",167,0)
 D ^DIR
"RTN","OOPSSUP2",168,0)
 I $P(X,"-",2)>7 W !,"     Range exceeds 1-7 limit." G RWS
"RTN","OOPSSUP2",169,0)
 Q:$D(DIRUT)
"RTN","OOPSSUP2",170,0)
 S:ITEM=20 $P(^OOPS(2260,D0,"CA1F"),U,11)=Y
"RTN","OOPSSUP2",171,0)
 S:ITEM=22 $P(^OOPS(2260,D0,"CA2I"),U,8)=Y
"RTN","OOPSSUP3")
0^10^B8636206
"RTN","OOPSSUP3",1,0)
OOPSSUP3 ;HINES/WAA - S/E Supervisor Edit routine 2162 [ 04/15/1998  1:25 PM ]
"RTN","OOPSSUP3",2,0)
 ;;1.0;ASISTS;**3,5**;Jun 01, 1998
"RTN","OOPSSUP3",3,0)
 ;;
"RTN","OOPSSUP3",4,0)
ASIST ;  2162 FORM
"RTN","OOPSSUP3",5,0)
 N INCID,SUP,CAT
"RTN","OOPSSUP3",6,0)
 S INCID=$$GET1^DIQ(2260,IEN,3,"I")
"RTN","OOPSSUP3",7,0)
 S:INCID'="" INCID=$$GET1^DIQ(2261.2,INCID,.01,"E") ; Getting the type of incident
"RTN","OOPSSUP3",8,0)
 S INCID=U_INCID_U
"RTN","OOPSSUP3",9,0)
 ; Allow edit of supervisor, secondary supervisor
"RTN","OOPSSUP3",10,0)
 ; Also, include logic for Non-PAID employee
"RTN","OOPSSUP3",11,0)
 S CAT=$$GET1^DIQ(2260,IEN,2,"I")
"RTN","OOPSSUP3",12,0)
 ; Patch 5 - added logic for employee CAT >6
"RTN","OOPSSUP3",13,0)
 S SUP=$S((CAT=1!(CAT>6)):" SUPERVISOR...............",CAT=2:" VOLUNTARY SVC SUPERVISOR.",CAT=3:" CONTRACT ADMINISTRATOR...",1:" SAFETY OFFICER...........")
"RTN","OOPSSUP3",14,0)
 S DR=""
"RTN","OOPSSUP3",15,0)
 S DR(1,2260,.1)="53"_SUP
"RTN","OOPSSUP3",16,0)
 S DR(1,2260,.6)="53.1 SECONDARY SUPERVISOR....."
"RTN","OOPSSUP3",17,0)
 S DR(1,2260,1)="26 GENERAL SETTING OF INCIDENT........;S X=X;"
"RTN","OOPSSUP3",18,0)
 S DR(1,2260,2)="27 LOCATION OF INJURY.................;S X=X;D CARE2^OOPSUTL2(IEN);"
"RTN","OOPSSUP3",19,0)
 S DR(1,2260,4)="28 DESCRIPTION OF INCIDENT............"
"RTN","OOPSSUP3",20,0)
 ; Patch 5 - added line below
"RTN","OOPSSUP3",21,0)
 S DR(1,2260,4.5)="29.5 HOW IS INCIDENT RELATED TO MEDICAL EMERGENCY"
"RTN","OOPSSUP3",22,0)
 S DR(1,2260,5)="29 CHARACTERIZATION OF INJURY........."
"RTN","OOPSSUP3",23,0)
 S DR(1,2260,6)="30 BODY PART MOST AFFECTED............"
"RTN","OOPSSUP3",24,0)
 S DR(1,2260,6.1)="30.1 ADDITIONAL BODY PART AFFECTED......"
"RTN","OOPSSUP3",25,0)
 S DR(1,2260,7)="31 SIDE OF BODY AFFECTED..............;S X=X;"
"RTN","OOPSSUP3",26,0)
SHARPS ; SHARPS DATA
"RTN","OOPSSUP3",27,0)
 ; Patch 5 - added Suture Needlestick
"RTN","OOPSSUP3",28,0)
 I "^Sharps Exposure^Hollow Bore Needlestick^Suture Needlestick^"'[INCID G FLUID
"RTN","OOPSSUP3",29,0)
 S DR(1,2260,8)="34 PATIENT SOURCE....................."
"RTN","OOPSSUP3",30,0)
 S DR(1,2260,9)="35 CONTAMINATION......................"
"RTN","OOPSSUP3",31,0)
 S DR(1,2260,10)="36 PURPOSE OF SHARP OBJECT..........."
"RTN","OOPSSUP3",32,0)
 S DR(1,2260,11)="37 ACTIVITY AT TIME OF INJURY........"
"RTN","OOPSSUP3",33,0)
 S DR(1,2260,12)="38 OBJECT CAUSING INJURY.............;S X=X;"
"RTN","OOPSSUP3",34,0)
 G ALL
"RTN","OOPSSUP3",35,0)
FLUID ; Body Fluid Exposer
"RTN","OOPSSUP3",36,0)
 I "^Exposure to Body Fluids/Splash^"'[INCID G EVERY
"RTN","OOPSSUP3",37,0)
 S DR(1,2260,8)="34 PATIENT SOURCE....................."
"RTN","OOPSSUP3",38,0)
 S DR(1,2260,14)="39"                  ; Multiple, DD prompt used - P5
"RTN","OOPSSUP3",39,0)
 S DR(1,2260,15)="40"                  ; Multiple, DD prompt used - P5
"RTN","OOPSSUP3",40,0)
 S DR(1,2260,16)="41 BODILY FLUID EXPOSURE SOURCE......."
"RTN","OOPSSUP3",41,0)
ALL ; ALL TYPE OF EXPOSURES
"RTN","OOPSSUP3",42,0)
 ; Patch 5 - Changed logic
"RTN","OOPSSUP3",43,0)
 S FAIL=$$GET1^DIQ(2260,IEN,42.5,"E") I FAIL="" S FAIL="No"
"RTN","OOPSSUP3",44,0)
 S DR(1,2260,17)="42.5 WAS THERE AN EQUIPMENT/DEVICE/PRODUCT FAILURE//^S X=FAIL;I X=""N"" S Y=""@1"""
"RTN","OOPSSUP3",45,0)
 S DR(1,2260,17.4)="42 DESCRIBE EQUIPMENT/DEVICE/PRODUCT FAILURE.."
"RTN","OOPSSUP3",46,0)
 S DR(1,2260,17.5)="S Y=43"
"RTN","OOPSSUP3",47,0)
 S DR(1,2260,17.6)="@1"
"RTN","OOPSSUP3",48,0)
 S DR(1,2260,17.7)="42////@"
"RTN","OOPSSUP3",49,0)
 S DR(1,2260,18)="43 SAFETY DESIGN DEVICE USED....;S X=X;"
"RTN","OOPSSUP3",50,0)
EVERY ; All Employees
"RTN","OOPSSUP3",51,0)
 ; Include CAT=6 Non-PAID employee as employee
"RTN","OOPSSUP3",52,0)
 I $$ISEMP^OOPSUTL4(IEN) D
"RTN","OOPSSUP3",53,0)
 .S DR(1,2260,19)="32 DUTY RETURNED TO..................."
"RTN","OOPSSUP3",54,0)
 .S DR(1,2260,20)="33 LOST TIME..........................;S X=X;"
"RTN","OOPSSUP3",55,0)
 .Q
"RTN","OOPSSUP3",56,0)
 S DR(1,2260,21)="47 CORRECTIVE ACTION............"
"RTN","OOPSSUP3",57,0)
 Q
"RTN","OOPSUTL4")
0^12^B12340948
"RTN","OOPSUTL4",1,0)
OOPSUTL4 ;HINES/WAA - Utilities Routines - 3/24/98
"RTN","OOPSUTL4",2,0)
 ;;1.0;ASISTS;**3,5**;Jun 01, 1998
"RTN","OOPSUTL4",3,0)
 ;;
"RTN","OOPSUTL4",4,0)
UNION(IEN) ;
"RTN","OOPSUTL4",5,0)
 ; Input: IEN   = Internal Entry Number of entry in file 2260
"RTN","OOPSUTL4",6,0)
 ; Output VALID = 1 Valid to be seen by Union
"RTN","OOPSUTL4",7,0)
 ;              = 0 Not Valid to be seen by Union
"RTN","OOPSUTL4",8,0)
 N VALID
"RTN","OOPSUTL4",9,0)
 S VALID=0
"RTN","OOPSUTL4",10,0)
 I $$EDSTA^OOPSUTL1(IEN,"O"),$P($$EDSTA^OOPSUTL1(IEN,"S"),U,3) S VALID=1
"RTN","OOPSUTL4",11,0)
 Q VALID
"RTN","OOPSUTL4",12,0)
 ;
"RTN","OOPSUTL4",13,0)
VALIDATE(IEN,FORM,CALLER,VALID) ;
"RTN","OOPSUTL4",14,0)
 ;
"RTN","OOPSUTL4",15,0)
 ; Input: IEN    = Internal Entry Number of entry in file 2260
"RTN","OOPSUTL4",16,0)
 ;        FORM   = 2162,CA1, or CA2
"RTN","OOPSUTL4",17,0)
 ;        CALLER = "E" employee
"RTN","OOPSUTL4",18,0)
 ;               = "S" supervisor
"RTN","OOPSUTL4",19,0)
 ;               = "O" safety officer
"RTN","OOPSUTL4",20,0)
 ;        VALID  = RESERVED FOR OUTPUT DATA
"RTN","OOPSUTL4",21,0)
 ; Output:VALID  = 1 ALL REQUIRED DATA FOR FORM IS COMPLETE
"RTN","OOPSUTL4",22,0)
 ;               = 0 DATA IS MISSING
"RTN","OOPSUTL4",23,0)
 N LIST,FLD,CNT,CHK
"RTN","OOPSUTL4",24,0)
 S (FLD,LIST)=""
"RTN","OOPSUTL4",25,0)
 S VALID=1,CHK=0
"RTN","OOPSUTL4",26,0)
 W !,"Validating data on form ",FORM,"."
"RTN","OOPSUTL4",27,0)
 I CALLER="E" D EMP
"RTN","OOPSUTL4",28,0)
 I CALLER="S" D SUP
"RTN","OOPSUTL4",29,0)
 I CALLER="O" D SOF
"RTN","OOPSUTL4",30,0)
 F CNT=1:1 S FLD=$P(LIST,",",CNT) Q:FLD=""  D
"RTN","OOPSUTL4",31,0)
 .N LOC,NODE,PCE,BADFLD,TEXT,WP
"RTN","OOPSUTL4",32,0)
 .S BADFLD=1,WP=0
"RTN","OOPSUTL4",33,0)
 .S LOC=$$GET1^DID(2260,FLD,"","GLOBAL SUBSCRIPT LOCATION")
"RTN","OOPSUTL4",34,0)
 .S NODE=$P(LOC,";")
"RTN","OOPSUTL4",35,0)
 .S PCE=$P(LOC,";",2)
"RTN","OOPSUTL4",36,0)
 .I PCE=0 D  ;Work processing field
"RTN","OOPSUTL4",37,0)
 ..I '$D(^OOPS(2260,IEN,NODE,1,0)) S (BADFLD,VALID)=0
"RTN","OOPSUTL4",38,0)
 ..S WP=1
"RTN","OOPSUTL4",39,0)
 ..Q
"RTN","OOPSUTL4",40,0)
 .E  I $P($G(^OOPS(2260,IEN,NODE)),U,PCE)="" S (BADFLD,VALID)=0
"RTN","OOPSUTL4",41,0)
 .I 'BADFLD D  ; Display error messaged about fields not filled.
"RTN","OOPSUTL4",42,0)
 ..I 'CHK W !!,"The following fields must be completed before the "_FORM_" can be signed.",! S CHK=1
"RTN","OOPSUTL4",43,0)
 ..I WP D  ;Is this a wp field and where to get title
"RTN","OOPSUTL4",44,0)
 ...N NODE
"RTN","OOPSUTL4",45,0)
 ...S NODE=2260_".0"_FLD
"RTN","OOPSUTL4",46,0)
 ...S TEXT=$$GET1^DID(NODE,".01","","TITLE")
"RTN","OOPSUTL4",47,0)
 ...Q
"RTN","OOPSUTL4",48,0)
 ..E  S TEXT=$$GET1^DID(2260,FLD,"","TITLE")
"RTN","OOPSUTL4",49,0)
 ..W !,TEXT
"RTN","OOPSUTL4",50,0)
 ..Q
"RTN","OOPSUTL4",51,0)
 .Q
"RTN","OOPSUTL4",52,0)
 Q
"RTN","OOPSUTL4",53,0)
EMP ;
"RTN","OOPSUTL4",54,0)
 ; Address fields are now all pulled from the 2162A node
"RTN","OOPSUTL4",55,0)
 I FORM="CA1" S LIST="8,9,10,11,12,108,109,110,111,112,113,114"
"RTN","OOPSUTL4",56,0)
 I FORM="CA2" S LIST="8,9,10,11,12,208,209,214,215,216,217"
"RTN","OOPSUTL4",57,0)
 Q
"RTN","OOPSUTL4",58,0)
SUP ;
"RTN","OOPSUTL4",59,0)
 I FORM="2162" S LIST="26,27,28,30,31" I $$ISEMP^OOPSUTL4(IEN) S LIST=LIST_",33"
"RTN","OOPSUTL4",60,0)
 I FORM="2162" S LIST=LIST_",47"
"RTN","OOPSUTL4",61,0)
 I FORM="CA1" S LIST="130,176,138,139,140,4,175,146,148,150,156,157,158,159,160,161,162,163"
"RTN","OOPSUTL4",62,0)
 I FORM="CA2" S LIST="230,237,242,243,244,245,246,247,248,249,250,251,252,258"
"RTN","OOPSUTL4",63,0)
 Q
"RTN","OOPSUTL4",64,0)
SOF ;
"RTN","OOPSUTL4",65,0)
 I FORM="2162" S LIST="55,47"
"RTN","OOPSUTL4",66,0)
 Q
"RTN","OOPSUTL4",67,0)
UP(IN) ; Translate all lower to upper
"RTN","OOPSUTL4",68,0)
 N OUT
"RTN","OOPSUTL4",69,0)
 S OUT=$TR(IN,"abcdefghijklmnopqrstuvwxyz","ABCDEFGHIJKLMNOPQRSTUVWXYZ")
"RTN","OOPSUTL4",70,0)
 Q OUT
"RTN","OOPSUTL4",71,0)
RWSOT ;Regular Work Schedule output transform
"RTN","OOPSUTL4",72,0)
 N I,HOLD
"RTN","OOPSUTL4",73,0)
 S HOLD=""
"RTN","OOPSUTL4",74,0)
 F I=1:1:($L(Y)/2) S HOLD=HOLD_$P("Sun,Mon,Tue,Wed,Thu,Fri,Sat",",",$P(Y,",",I))_","
"RTN","OOPSUTL4",75,0)
 S Y=$E(HOLD,1,($L(HOLD)-1))
"RTN","OOPSUTL4",76,0)
 Q 
"RTN","OOPSUTL4",77,0)
RWSIN(X) ;
"RTN","OOPSUTL4",78,0)
 ; X=Sun,Mon,Tue
"RTN","OOPSUTL4",79,0)
 N IN,I,Y,DAY,DOW
"RTN","OOPSUTL4",80,0)
 S X=X_",",DAY=""
"RTN","OOPSUTL4",81,0)
 S IN="1Sun,2Mon,3Tue,4Wed,5Thu,6Fri,7Sat"
"RTN","OOPSUTL4",82,0)
 F I=1:1 S DOW=$P(X,",",I) Q:DOW=""  D
"RTN","OOPSUTL4",83,0)
 .S DAY=DAY_$E(IN,($F(IN,DOW)-4))_","
"RTN","OOPSUTL4",84,0)
 .Q
"RTN","OOPSUTL4",85,0)
 ;I DAY'="" S DAY=$E(DAY,1,($L(DAY)-1))
"RTN","OOPSUTL4",86,0)
 Q DAY
"RTN","OOPSUTL4",87,0)
ISEMP(IEN) ; Determine if PERSONNEL STATUS = employee
"RTN","OOPSUTL4",88,0)
 ;  Input -  IEN     = internal Entry Number of case in File 2260
"RTN","OOPSUTL4",89,0)
 ;           CAT     = Personnel Status of Case in File 2260
"RTN","OOPSUTL4",90,0)
 ;           TST     = valid Personnel status categories for employee
"RTN","OOPSUTL4",91,0)
 ;  Output - EMP     = 1 Personnel status indicates employee
"RTN","OOPSUTL4",92,0)
 ;                     0 Personnel status indicates non-employee
"RTN","OOPSUTL4",93,0)
 ;
"RTN","OOPSUTL4",94,0)
 NEW CAT,TST,EMP
"RTN","OOPSUTL4",95,0)
 S EMP=0
"RTN","OOPSUTL4",96,0)
 S CAT=$$GET1^DIQ(2260,IEN,2,"I")
"RTN","OOPSUTL4",97,0)
 S TST=",1,2,6,7,8,9,10,"
"RTN","OOPSUTL4",98,0)
 I TST[(","_CAT_",") S EMP=1
"RTN","OOPSUTL4",99,0)
 Q EMP
"RTN","OOPSUTL4",100,0)
 ;
"RTN","OOPSUTL4",101,0)
FUT(DATE) ; Check for dates prior to Date of Inj/Ill
"RTN","OOPSUTL4",102,0)
 N DAT,VIEW,FORM
"RTN","OOPSUTL4",103,0)
 S VIEW=1
"RTN","OOPSUTL4",104,0)
 S FORM=$$GET1^DIQ(2260,IEN,52,"I")
"RTN","OOPSUTL4",105,0)
 S DAT=$$GET1^DIQ(2260,IEN,4,"I")
"RTN","OOPSUTL4",106,0)
 I DATE<$P(DAT,".") D
"RTN","OOPSUTL4",107,0)
 . W !!?6,"This date cannot be prior to DATE"_$S(FORM=1:"/TIME INJURY OCCURRED",FORM=2:" 1ST AWARE OF ILLNESS",1:"")_" entered on 2162.",!
"RTN","OOPSUTL4",108,0)
 . S VIEW=0
"RTN","OOPSUTL4",109,0)
 Q VIEW
"RTN","OOPSVAL1")
0^13^B17650014
"RTN","OOPSVAL1",1,0)
OOPSVAL1 ;HINES/WAA,GTD - Validate and Sign data Routines - 3/25/98 [ 04/17/1998  3:20 PM ]
"RTN","OOPSVAL1",2,0)
 ;;1.0;ASISTS;**1,3,5**;Jun 01, 1998
"RTN","OOPSVAL1",3,0)
 ;;
"RTN","OOPSVAL1",4,0)
EN1(CALLER) ;  Main Entry Point
"RTN","OOPSVAL1",5,0)
 ;INPUT:
"RTN","OOPSVAL1",6,0)
 ;     CALLER = "E" FOR EMPLOYEE
"RTN","OOPSVAL1",7,0)
 ;            = "S" FOR SUPERVISOR
"RTN","OOPSVAL1",8,0)
 ;            = "O" FOR SAFETY OFFICER
"RTN","OOPSVAL1",9,0)
 N SSN,IEN,SIGN,EDIT,FORM,GRP,SUP,I,CIT,HSA,STA,ZIP
"RTN","OOPSVAL1",10,0)
 S IEN=0
"RTN","OOPSVAL1",11,0)
 Q:DUZ<1
"RTN","OOPSVAL1",12,0)
 Q:$G(^VA(200,DUZ,1))=""
"RTN","OOPSVAL1",13,0)
 I CALLER="E" S SSN=$P(^VA(200,DUZ,1),U,9) Q:$D(^OOPS(2260,"SSN",SSN))<1
"RTN","OOPSVAL1",14,0)
 D  Q:IEN<1
"RTN","OOPSVAL1",15,0)
 .N DIC,X
"RTN","OOPSVAL1",16,0)
 .S DIC="^OOPS(2260,"
"RTN","OOPSVAL1",17,0)
 .I CALLER="E" S DIC("S")="I $$EMPSCR^OOPSVAL1(Y)"
"RTN","OOPSVAL1",18,0)
 .I CALLER="S" S DIC("S")="I $$SUPSCR^OOPSVAL1(Y)"
"RTN","OOPSVAL1",19,0)
 .I CALLER="O" S DIC("S")="I $$SAFSCR^OOPSVAL1(Y)"
"RTN","OOPSVAL1",20,0)
 .S DIC("S")=DIC("S")_",'$$GET1^DIQ(2260,Y,51,""I"")"
"RTN","OOPSVAL1",21,0)
 .S DIC(0)="AEMNZ",DIC("A")="   Select Case: "
"RTN","OOPSVAL1",22,0)
 .D ^DIC
"RTN","OOPSVAL1",23,0)
 .Q:Y<1
"RTN","OOPSVAL1",24,0)
 .Q:$D(DTOUT)!($D(DUOUT))
"RTN","OOPSVAL1",25,0)
 .S IEN=$P(Y,U)
"RTN","OOPSVAL1",26,0)
 .Q
"RTN","OOPSVAL1",27,0)
 I CALLER="O" S FORM="2162" D FORM Q
"RTN","OOPSVAL1",28,0)
 I CALLER="E" D
"RTN","OOPSVAL1",29,0)
 .S FORM=$$GET1^DIQ(2260,IEN,52,"I")
"RTN","OOPSVAL1",30,0)
 .S FORM=$S(FORM=1:"CA1",FORM=2:"CA2",1:"")
"RTN","OOPSVAL1",31,0)
 .Q:FORM=""
"RTN","OOPSVAL1",32,0)
 .D FORM
"RTN","OOPSVAL1",33,0)
 .Q
"RTN","OOPSVAL1",34,0)
 I CALLER="S" D
"RTN","OOPSVAL1",35,0)
 .N CNT,PAUSE,OUT,FORM,EDIT
"RTN","OOPSVAL1",36,0)
 .S (PAUSE,OUT)=0
"RTN","OOPSVAL1",37,0)
 .D
"RTN","OOPSVAL1",38,0)
 ..N INC,STAT,ESTAT
"RTN","OOPSVAL1",39,0)
 ..S INC=$$GET1^DIQ(2260,IEN,52,"I")
"RTN","OOPSVAL1",40,0)
 ..S STAT=$$EDSTA^OOPSUTL1(IEN,"S")
"RTN","OOPSVAL1",41,0)
 ..; added check for employee having signed CA1
"RTN","OOPSVAL1",42,0)
 ..S ESTAT=$$EDSTA^OOPSUTL1(IEN,"E")
"RTN","OOPSVAL1",43,0)
 ..; if employee signed ok to let super select if no forms signed
"RTN","OOPSVAL1",44,0)
 ..I $P(ESTAT,U,INC) D
"RTN","OOPSVAL1",45,0)
 ...I '$P(STAT,U,INC),'$P(STAT,U,3) D SELECT^OOPSSUP1 Q
"RTN","OOPSVAL1",46,0)
 ...S EDIT=$S('$P(STAT,U,3):2162,'$P(STAT,U,INC):$P("CA1^CA2",U,INC),1:"")
"RTN","OOPSVAL1",47,0)
 ..I '$P(ESTAT,U,INC) D  ;  Employee has not signed CA1/CA2
"RTN","OOPSVAL1",48,0)
 ...I '$P(STAT,U,3) S EDIT=2162 Q
"RTN","OOPSVAL1",49,0)
 ...S EDIT=""
"RTN","OOPSVAL1",50,0)
 .I EDIT="" Q
"RTN","OOPSVAL1",51,0)
 .F CNT=1:1 S FORM=$P(EDIT,U,CNT) Q:FORM=""  D:PAUSE END Q:OUT  D
"RTN","OOPSVAL1",52,0)
 ..D FORM S PAUSE=1
"RTN","OOPSVAL1",53,0)
 ..Q
"RTN","OOPSVAL1",54,0)
 .Q
"RTN","OOPSVAL1",55,0)
 Q
"RTN","OOPSVAL1",56,0)
EMPSCR(IEN) ;
"RTN","OOPSVAL1",57,0)
 N VIEW
"RTN","OOPSVAL1",58,0)
 S VIEW=1
"RTN","OOPSVAL1",59,0)
 I '$$EMP^OOPSUTL1(IEN,SSN) S VIEW=0
"RTN","OOPSVAL1",60,0)
 E  D
"RTN","OOPSVAL1",61,0)
 .N INC
"RTN","OOPSVAL1",62,0)
 .S INC=$$GET1^DIQ(2260,IEN,52,"I")
"RTN","OOPSVAL1",63,0)
 .I $P($$EDSTA^OOPSUTL1(IEN,"E"),U,INC) S VIEW=0
"RTN","OOPSVAL1",64,0)
 .Q
"RTN","OOPSVAL1",65,0)
 Q VIEW
"RTN","OOPSVAL1",66,0)
SUPSCR(IEN) ;
"RTN","OOPSVAL1",67,0)
 N VIEW
"RTN","OOPSVAL1",68,0)
 S VIEW=1
"RTN","OOPSVAL1",69,0)
 I '$$SUPSCR^OOPSUTL2(DUZ,IEN) S VIEW=0
"RTN","OOPSVAL1",70,0)
 E  D
"RTN","OOPSVAL1",71,0)
 .N INC,STAT,ESTAT,CAT
"RTN","OOPSVAL1",72,0)
 .S CAT=$$GET1^DIQ(2260,IEN,2,"I")              ; Personnel status
"RTN","OOPSVAL1",73,0)
 .S INC=$$GET1^DIQ(2260,IEN,52,"I")             ; Injury/Illness
"RTN","OOPSVAL1",74,0)
 .S STAT=$$EDSTA^OOPSUTL1(IEN,"S")              ; sup signed forms
"RTN","OOPSVAL1",75,0)
 .S ESTAT=$$EDSTA^OOPSUTL1(IEN,"E")             ; emp signed forms
"RTN","OOPSVAL1",76,0)
 .; Added Non-PAID employee to check, not emp, 2162 signed
"RTN","OOPSVAL1",77,0)
 .; Patch 5 - logic changed for new Personnel Categories
"RTN","OOPSVAL1",78,0)
 .I '$$ISEMP^OOPSUTL4(IEN),$P(STAT,U,3) S VIEW=0 Q
"RTN","OOPSVAL1",79,0)
 .; super signed 2162 and CA1/CA2
"RTN","OOPSVAL1",80,0)
 .I $P(STAT,U,INC),$P(STAT,U,3) S VIEW=0 Q
"RTN","OOPSVAL1",81,0)
 .; emp not signed CA1/CA2, super signed 2162, not signed CA1/CA2 - no
"RTN","OOPSVAL1",82,0)
 .I '$P(ESTAT,U,INC),$P(STAT,U,3),'$P(STAT,U,INC) S VIEW=0 Q
"RTN","OOPSVAL1",83,0)
 .Q
"RTN","OOPSVAL1",84,0)
 Q VIEW
"RTN","OOPSVAL1",85,0)
SAFSCR(IEN) ;
"RTN","OOPSVAL1",86,0)
 N VIEW
"RTN","OOPSVAL1",87,0)
 S VIEW=1
"RTN","OOPSVAL1",88,0)
 I '$$SAFETY^OOPSUTL2(IEN) S VIEW=0
"RTN","OOPSVAL1",89,0)
 I $$EDSTA^OOPSUTL1(IEN,"O") S VIEW=0
"RTN","OOPSVAL1",90,0)
 Q VIEW
"RTN","OOPSVAL1",91,0)
END ;End of Form pause
"RTN","OOPSVAL1",92,0)
 N DIR
"RTN","OOPSVAL1",93,0)
 W !
"RTN","OOPSVAL1",94,0)
 S DIR(0)="E" D ^DIR
"RTN","OOPSVAL1",95,0)
 S:$D(DIRUT) OUT=1 Q
"RTN","OOPSVAL1",96,0)
 Q
"RTN","OOPSVAL1",97,0)
FORM ;Select Form
"RTN","OOPSVAL1",98,0)
 D:'$G(PAUSE,0) DISPLAY^OOPSSUP1
"RTN","OOPSVAL1",99,0)
 D SIGN(FORM)
"RTN","OOPSVAL1",100,0)
 Q:+SIGN=0  ; Form was not signed
"RTN","OOPSVAL1",101,0)
 I CALLER="E" D EMP
"RTN","OOPSVAL1",102,0)
 I CALLER="S" D SUP
"RTN","OOPSVAL1",103,0)
 I CALLER="O" D SAF
"RTN","OOPSVAL1",104,0)
 Q
"RTN","OOPSVAL1",105,0)
SIGN(FORM) ; Sign/validate Document
"RTN","OOPSVAL1",106,0)
 N EMP,INC,VALID,OUT
"RTN","OOPSVAL1",107,0)
 S VALID=0,SIGN=""
"RTN","OOPSVAL1",108,0)
 S INC=$$GET1^DIQ(2260,IEN,52,"I")
"RTN","OOPSVAL1",109,0)
 D VALIDATE^OOPSUTL4(IEN,FORM,CALLER,.VALID)
"RTN","OOPSVAL1",110,0)
 I 'VALID D END Q
"RTN","OOPSVAL1",111,0)
 S SIGN=$$SIG^OOPSESIG(DUZ,IEN)
"RTN","OOPSVAL1",112,0)
 Q
"RTN","OOPSVAL1",113,0)
EMP ; Employee Sign off
"RTN","OOPSVAL1",114,0)
 I FORM="CA1" S $P(^OOPS(2260,IEN,"CA1ES"),U,1,3)=SIGN
"RTN","OOPSVAL1",115,0)
 I FORM="CA2" S $P(^OOPS(2260,IEN,"CA2ES"),U,1,3)=SIGN
"RTN","OOPSVAL1",116,0)
 D EMP^OOPSMBUL(IEN)
"RTN","OOPSVAL1",117,0)
 Q
"RTN","OOPSVAL1",118,0)
SUP ;Supervisor Sign off
"RTN","OOPSVAL1",119,0)
 I FORM="CA1" S $P(^OOPS(2260,IEN,"CA1ES"),U,4,6)=SIGN
"RTN","OOPSVAL1",120,0)
 I FORM="CA2" S $P(^OOPS(2260,IEN,"CA2ES"),U,4,6)=SIGN
"RTN","OOPSVAL1",121,0)
 I FORM="2162" S $P(^OOPS(2260,IEN,"2162ES"),U,1,3)=SIGN D SAFETY^OOPSMBUL(IEN)
"RTN","OOPSVAL1",122,0)
 Q
"RTN","OOPSVAL1",123,0)
SAF ; Safety Officer Sign off
"RTN","OOPSVAL1",124,0)
 I FORM="2162" S $P(^OOPS(2260,IEN,"2162ES"),U,4,6)=SIGN
"RTN","OOPSVAL1",125,0)
 Q
"RTN","OOPSXP5")
0^17^B7400907
"RTN","OOPSXP5",1,0)
OOPSXP5 ;WCIOFO/LLH - INIT ROUTINE FOR VISN 2 INTEGRATION; 09/20/99
"RTN","OOPSXP5",2,0)
 ;;1.0;ASISTS;**5**;Jun 01, 1998
"RTN","OOPSXP5",3,0)
 ;
"RTN","OOPSXP5",4,0)
 ;  This is the Pre-Init for OOPS*1*5
"RTN","OOPSXP5",5,0)
 ;  It will be used to populate blank STATION NUMBER fields in 
"RTN","OOPSXP5",6,0)
 ;  ^OOPS(2260 file.
"RTN","OOPSXP5",7,0)
 ;
"RTN","OOPSXP5",8,0)
PRE ; Pre-Init to Convert Station Number
"RTN","OOPSXP5",9,0)
 ; First assure ^DD(2260,13 has not been changed - implies conv run
"RTN","OOPSXP5",10,0)
 D FIELD^DID(2260,13,"","TYPE","ARR")
"RTN","OOPSXP5",11,0)
 I ARR("TYPE")'="FREE TEXT" QUIT
"RTN","OOPSXP5",12,0)
 S FAC=XPDQUES("PRE1")
"RTN","OOPSXP5",13,0)
 I $G(FAC)="" QUIT
"RTN","OOPSXP5",14,0)
 S IEN=0
"RTN","OOPSXP5",15,0)
 ; Loop thru file, if Station # blank, stuff with FAC
"RTN","OOPSXP5",16,0)
 ; if Station has a value, convert to pointer
"RTN","OOPSXP5",17,0)
 F  S IEN=$O(^OOPS(2260,IEN)) Q:IEN'>0  D
"RTN","OOPSXP5",18,0)
 . D GETS^DIQ(2260,IEN,13,"IE","ARR")
"RTN","OOPSXP5",19,0)
 . S STA=$G(ARR(2260,IEN_",",13,"I"))
"RTN","OOPSXP5",20,0)
 . I $G(STA)'="" D
"RTN","OOPSXP5",21,0)
 .. I ARR(2260,IEN_",",13,"E")'=ARR(2260,IEN_",",13,"I") Q
"RTN","OOPSXP5",22,0)
 .. I $O(^DIC(4,"D",STA,""))="" D
"RTN","OOPSXP5",23,0)
 ... S CASE=$$GET1^DIQ(2260,IEN,.01,"E")
"RTN","OOPSXP5",24,0)
 ... S MES="Station # for Case #: "_CASE_", could not be Converted, "
"RTN","OOPSXP5",25,0)
 ... S MES=MES_"Update Manually."
"RTN","OOPSXP5",26,0)
 ... D MES^XPDUTL(MES)
"RTN","OOPSXP5",27,0)
 .. I $O(^DIC(4,"D",STA,""))'="" S STA=$O(^DIC(4,"D",STA,""))
"RTN","OOPSXP5",28,0)
 . I '$G(STA) D
"RTN","OOPSXP5",29,0)
 .. S STA=FAC
"RTN","OOPSXP5",30,0)
 . K DA,DIE,DR
"RTN","OOPSXP5",31,0)
 . S DA=IEN,DIE="^OOPS(2260,",DR="13////"_STA
"RTN","OOPSXP5",32,0)
 . D ^DIE K DA,DIE,DR
"RTN","OOPSXP5",33,0)
 S MES="ASISTS Cases have been Updated with Station Number."
"RTN","OOPSXP5",34,0)
 D BMES^XPDUTL(MES)
"RTN","OOPSXP5",35,0)
 D MES^XPDUTL(" ")
"RTN","OOPSXP5",36,0)
 Q
"RTN","OOPSXP5",37,0)
 ;
"RTN","OOPSXP5",38,0)
POST ; Post-init used to Update Table files
"RTN","OOPSXP5",39,0)
 ; Load Dictionary with changed descriptions
"RTN","OOPSXP5",40,0)
 K DIE,DA,DR
"RTN","OOPSXP5",41,0)
 S DIE="^OOPS(2261.2,"
"RTN","OOPSXP5",42,0)
 S DA=11,DR=".01///^S X=""Hollow Bore Needlestick""" D ^DIE
"RTN","OOPSXP5",43,0)
 S DA=13,DR=".01///^S X=""Exposure to Body Fluids/Splash""" D ^DIE
"RTN","OOPSXP5",44,0)
 K DIE,DA,DR
"RTN","OOPSXP5",45,0)
 ; Need to do something about Suture Needlestick - being ADDED
"RTN","OOPSXP5",46,0)
 K DIC,DA,DR
"RTN","OOPSXP5",47,0)
 S (DIC,DIE)="^OOPS(2261.2,",DIC(0)="L",DLAYGO=2261.2
"RTN","OOPSXP5",48,0)
 S DINUM=14
"RTN","OOPSXP5",49,0)
 I $D(@(DIC_DINUM_")"))=0 D
"RTN","OOPSXP5",50,0)
 . S X="Suture Needlestick"
"RTN","OOPSXP5",51,0)
 . D FILE^DICN
"RTN","OOPSXP5",52,0)
 . S DA=+Y
"RTN","OOPSXP5",53,0)
 . S DR="1///^S X=DA"
"RTN","OOPSXP5",54,0)
 . D ^DIE
"RTN","OOPSXP5",55,0)
 E  D
"RTN","OOPSXP5",56,0)
 . S DA=14,DR=".01///^S X=""Suture Needlestick""" D ^DIE
"RTN","OOPSXP5",57,0)
 . S DR="1///^S X=DA" D ^DIE
"RTN","OOPSXP5",58,0)
 K DIC,DIE,DA,DR
"RTN","OOPSXP5",59,0)
 ;
"RTN","OOPSXP5",60,0)
 S DIE="^OOPS(2261.7,"
"RTN","OOPSXP5",61,0)
 S DA=39,DR=".01///^S X=""Drill bit/burr""" D ^DIE
"RTN","OOPSXP5",62,0)
 ; Need to do something about Blunt Suture Needle
"RTN","OOPSXP5",63,0)
 K DIC,DA,DR
"RTN","OOPSXP5",64,0)
 S (DIC,DIE)="^OOPS(2261.7,",DIC(0)="L",DLAYGO=2261.7
"RTN","OOPSXP5",65,0)
 S DINUM=66
"RTN","OOPSXP5",66,0)
 I $D(@(DIC_DINUM_")"))=0 D
"RTN","OOPSXP5",67,0)
 . S X="Blunt Suture Needle"
"RTN","OOPSXP5",68,0)
 . D FILE^DICN
"RTN","OOPSXP5",69,0)
 . S DA=+Y
"RTN","OOPSXP5",70,0)
 . S DR="1///^S X=50" D ^DIE
"RTN","OOPSXP5",71,0)
 . S DR="2///^S X=""N""" D ^DIE
"RTN","OOPSXP5",72,0)
 E  D
"RTN","OOPSXP5",73,0)
 . S DA=66,DR=".01///^S X=""Blunt Suture Needle""" D ^DIE
"RTN","OOPSXP5",74,0)
 . S DR="1///^S X=50" D ^DIE
"RTN","OOPSXP5",75,0)
 . S DR="2///^S X=""N""" D ^DIE
"RTN","OOPSXP5",76,0)
 K DIC,DIE,DA,DR
"RTN","OOPSXP5",77,0)
 S MES="Table Files have been Updated."
"RTN","OOPSXP5",78,0)
 D BMES^XPDUTL(MES)
"RTN","OOPSXP5",79,0)
 D MES^XPDUTL(" ")
"RTN","OOPSXP5",80,0)
 ; Update X-Reference for Station Number
"RTN","OOPSXP5",81,0)
 S DIK="^OOPS(2260,",DIK(1)="13^D" D ENALL^DIK
"RTN","OOPSXP5",82,0)
 QUIT
"UP",2260,2260.039,-1)
2260^2162E
"UP",2260,2260.039,0)
2260.039
"VER")
8.0^22.0
"^DD",2260,2260,2,0)
PERSONNEL STATUS^RSX^1:Employee;2:Volunteer;3:Contractor;4:Visitor;5:Other;6:Non-PAID Employee;7:Medical Student;8:Nursing Student;9:Other Student;10:Resident Physician;^0;3^Q
"^DD",2260,2260,2,1,0)
^.1
"^DD",2260,2260,2,1,1,0)
2260^AC
"^DD",2260,2260,2,1,1,1)
S ^OOPS(2260,"AC",$E(X,1,30),DA)=""
"^DD",2260,2260,2,1,1,2)
K ^OOPS(2260,"AC",$E(X,1,30),DA)
"^DD",2260,2260,2,1,1,"DT")
2980407
"^DD",2260,2260,2,3)
Enter the status. Non-PAID Employee includes student and resident. 
"^DD",2260,2260,2,21,0)
^^3^3^2991007^^^^
"^DD",2260,2260,2,21,1,0)
The personnel status of the individual involved in the incident is either
"^DD",2260,2260,2,21,2,0)
employee, volunteer, contractor, visitor or other.  Non-PAID Employee
"^DD",2260,2260,2,21,3,0)
includes students and residents.
"^DD",2260,2260,2,"DT")
2991007
"^DD",2260,2260,4,0)
DATE/TIME OF OCCURRENCE^RDX^^0;5^S %DT="ETX",%DT(0)="-NOW" D ^%DT K %DT S X=Y K:Y<1 X
"^DD",2260,2260,4,.1)
21. DATE OF INJURY
"^DD",2260,2260,4,1,0)
^.1
"^DD",2260,2260,4,1,1,0)
2260^AD
"^DD",2260,2260,4,1,1,1)
S ^OOPS(2260,"AD",$E(X,1,30),DA)=""
"^DD",2260,2260,4,1,1,2)
K ^OOPS(2260,"AD",$E(X,1,30),DA)
"^DD",2260,2260,4,1,1,"DT")
2980407
"^DD",2260,2260,4,3)
Enter the date and time of injury, date only if illness.
"^DD",2260,2260,4,21,0)
^^3^3^2990610^^^
"^DD",2260,2260,4,21,1,0)
If this is an injury, this is the date and time the incident happened.
"^DD",2260,2260,4,21,2,0)
If this is an illness, this is the date the employee first became aware of
"^DD",2260,2260,4,21,3,0)
the disease or illness.
"^DD",2260,2260,4,"DT")
2990811
"^DD",2260,2260,13,0)
STATION NUMBER^RP4'^DIC(4,^2162A;9^Q
"^DD",2260,2260,13,1,0)
^.1
"^DD",2260,2260,13,1,1,0)
2260^D
"^DD",2260,2260,13,1,1,1)
S ^OOPS(2260,"D",$E(X,1,30),DA)=""
"^DD",2260,2260,13,1,1,2)
K ^OOPS(2260,"D",$E(X,1,30),DA)
"^DD",2260,2260,13,1,1,3)
This index cannot be deleted
"^DD",2260,2260,13,1,1,"DT")
2991012
"^DD",2260,2260,13,3)
Answer must be 3-7 characters in length.
"^DD",2260,2260,13,21,0)
^^1^1^2991104^^^^
"^DD",2260,2260,13,21,1,0)
This is the station number where the incident took place.
"^DD",2260,2260,13,"DT")
2991012
"^DD",2260,2260,29.5,0)
MEDICAL EMERGENCY^S^1:Normal Operations (No Emergency);2:Medical Emergency;3:Clean-up Following Medical Emergency;^2162B;9^Q
"^DD",2260,2260,29.5,3)
Enter how the incident relates to a medical emergency, if applicable
"^DD",2260,2260,29.5,21,0)
^^2^2^2991129^^^^
"^DD",2260,2260,29.5,21,1,0)
Enter the response that best describes how the incident is related to a
"^DD",2260,2260,29.5,21,2,0)
medical emergency.
"^DD",2260,2260,29.5,23,0)
^^2^2^2991129^
"^DD",2260,2260,29.5,23,1,0)
This Set of Codes field will collect the response that best describes how the
"^DD",2260,2260,29.5,23,2,0)
incident is related to a medical emergency.
"^DD",2260,2260,29.5,"DT")
2991007
"^DD",2260,2260,39,0)
AREA EXPOSED TO BODILY FLUID^2260.039SA^^2162E;0
"^DD",2260,2260,39,21,0)
^^1^1^2991129^^^^
"^DD",2260,2260,39,21,1,0)
This is a description of the exposed body parts. 
"^DD",2260,2260,42.5,0)
EQUIP/DEVICE FAILURE OCCURRED^S^N:No;Y:Yes;^2162D;9^Q
"^DD",2260,2260,42.5,3)
Enter whether there was an equipment or device product failure involved with the incident.
"^DD",2260,2260,42.5,21,0)
^^3^3^2991129^^
"^DD",2260,2260,42.5,21,1,0)
Indicates whether there was an equipment or device product failure
"^DD",2260,2260,42.5,21,2,0)
involved with the incident.  If yes, user will be prompted to enter
"^DD",2260,2260,42.5,21,3,0)
comments
"^DD",2260,2260,42.5,"DT")
2991007
"^DD",2260,2260,56,0)
PERSON ENTERING STUB RECORD^RP200'^VA(200,^0;10^Q
"^DD",2260,2260,56,21,0)
^^5^5^2991129^^^^
"^DD",2260,2260,56,21,1,0)
This field is automatically populated when the 2162 Incicent report is
"^DD",2260,2260,56,21,2,0)
created and saved.  Data entry for this field is not possible through the
"^DD",2260,2260,56,21,3,0)
ASISTS package.  The internal value for this field is a pointer to the 
"^DD",2260,2260,56,21,4,0)
NEW PERSON File (#200).  The external value (Name) is displayed on the PRINT
"^DD",2260,2260,56,21,5,0)
REPORT OF ACCIDENT Report.
"^DD",2260,2260,56,"DT")
2990909
"^DD",2260,2260,57,0)
DATE TRANSMITTED TO NDB^D^^0;11^S %DT="EX" D ^%DT S X=Y K:Y<1 X
"^DD",2260,2260,57,21,0)
^^4^4^2991129^^
"^DD",2260,2260,57,21,1,0)
 
"^DD",2260,2260,57,21,2,0)
The value in this field will be the last time the closed case 2162 data 
"^DD",2260,2260,57,21,3,0)
was transmitted to the NDB. If the case is closed, transmitted, then 
"^DD",2260,2260,57,21,4,0)
re-opened, this field is 'blanked' so that retransmission will be triggered.
"^DD",2260,2260,57,"DT")
2991007
"^DD",2260,2260.039,0)
AREA EXPOSED TO BODILY FLUID SUB-FIELD^^.01^1
"^DD",2260,2260.039,0,"NM","AREA EXPOSED TO BODILY FLUID")

"^DD",2260,2260.039,.01,0)
AREA EXPOSED TO BODILY FLUID^MS^S:Skin;E:Eyes (conjunctiva);N:Nose (mucosa);M:Mouth (mucosa);O:Other;B:Both Eyes and Mouth;^0;1^Q
"^DD",2260,2260.039,.01,1,0)
^.1
"^DD",2260,2260.039,.01,1,1,0)
2260.039^B
"^DD",2260,2260.039,.01,1,1,1)
S ^OOPS(2260,DA(1),"2162E","B",$E(X,1,30),DA)=""
"^DD",2260,2260.039,.01,1,1,2)
K ^OOPS(2260,DA(1),"2162E","B",$E(X,1,30),DA)
"^DD",2260,2260.039,.01,3)
Enter the exposed body part(s).
"^DD",2260,2260.039,.01,21,0)
^^1^1^2991129^^^^
"^DD",2260,2260.039,.01,21,1,0)
This is a description of the exposed body parts.
"^DD",2260,2260.039,.01,"DT")
2991129
"^DD",2261.5,2261.5,0)
FIELD^^1^2
"^DD",2261.5,2261.5,0,"DDA")
N
"^DD",2261.5,2261.5,0,"DT")
2980316
"^DD",2261.5,2261.5,0,"IX","B",2261.5,.01)

"^DD",2261.5,2261.5,0,"IX","C",2261.5,1)

"^DD",2261.5,2261.5,0,"IX","D",2261.5,.01)

"^DD",2261.5,2261.5,0,"NM","ASISTS PURPOSE FOR USING SHARPS")

"^DD",2261.5,2261.5,0,"PT",2260,36)

"^DD",2261.5,2261.5,0,"VRPK")
ASISTS
"^DD",2261.5,2261.5,.01,0)
NAME^RF^^0;1^K:$L(X)>100!($L(X)<3)!'(X'?1P.E) X
"^DD",2261.5,2261.5,.01,1,0)
^.1
"^DD",2261.5,2261.5,.01,1,1,0)
2261.5^B
"^DD",2261.5,2261.5,.01,1,1,1)
S ^OOPS(2261.5,"B",$E(X,1,30),DA)=""
"^DD",2261.5,2261.5,.01,1,1,2)
K ^OOPS(2261.5,"B",$E(X,1,30),DA)
"^DD",2261.5,2261.5,.01,1,2,0)
2261.5^D^MUMPS
"^DD",2261.5,2261.5,.01,1,2,1)
S ^OOPS(2261.5,"D",$$UP^OOPSUTL4($E(X,1,30)),DA)=""
"^DD",2261.5,2261.5,.01,1,2,2)
K ^OOPS(2261.5,"D",$$UP^OOPSUTL4($E(X,1,30)),DA)
"^DD",2261.5,2261.5,.01,1,2,"%D",0)
^^2^2^2980505^^
"^DD",2261.5,2261.5,.01,1,2,"%D",1,0)
This cross-reference allows selection of entries by upper-case
"^DD",2261.5,2261.5,.01,1,2,"%D",2,0)
values.
"^DD",2261.5,2261.5,.01,1,2,"DT")
2980505
"^DD",2261.5,2261.5,.01,3)
Answer must be 3-100 characters in length.
"^DD",2261.5,2261.5,.01,21,0)
^^1^1^2980316^^^^
"^DD",2261.5,2261.5,.01,21,1,0)
Enter a purpose for using Sharps.
"^DD",2261.5,2261.5,.01,"DT")
2980505
"^DD",2261.5,2261.5,1,0)
CODE^NJ3,0^^0;2^K:+X'=X!(X>999)!(X<0)!(X?.E1"."1N.N) X
"^DD",2261.5,2261.5,1,1,0)
^.1
"^DD",2261.5,2261.5,1,1,1,0)
2261.5^C
"^DD",2261.5,2261.5,1,1,1,1)
S ^OOPS(2261.5,"C",$E(X,1,30),DA)=""
"^DD",2261.5,2261.5,1,1,1,2)
K ^OOPS(2261.5,"C",$E(X,1,30),DA)
"^DD",2261.5,2261.5,1,1,1,"DT")
2980311
"^DD",2261.5,2261.5,1,3)
Type a Number between 0 and 999, 0 Decimal Digits
"^DD",2261.5,2261.5,1,21,0)
^^2^2^2980310^^
"^DD",2261.5,2261.5,1,21,1,0)
Enter a code that will identify a purpose for
"^DD",2261.5,2261.5,1,21,2,0)
using sharps.
"^DD",2261.5,2261.5,1,"DT")
2980311
"^DD",2261.6,2261.6,0)
FIELD^^1^2
"^DD",2261.6,2261.6,0,"DDA")
N
"^DD",2261.6,2261.6,0,"DT")
2980316
"^DD",2261.6,2261.6,0,"IX","B",2261.6,.01)

"^DD",2261.6,2261.6,0,"IX","C",2261.6,1)

"^DD",2261.6,2261.6,0,"IX","D",2261.6,.01)

"^DD",2261.6,2261.6,0,"NM","ASISTS OCCURRENCE OF SHARPS INJURY")

"^DD",2261.6,2261.6,0,"PT",2260,37)

"^DD",2261.6,2261.6,0,"VRPK")
ASISTS
"^DD",2261.6,2261.6,.01,0)
NAME^RF^^0;1^K:$L(X)>200!($L(X)<3)!'(X'?1P.E) X
"^DD",2261.6,2261.6,.01,1,0)
^.1
"^DD",2261.6,2261.6,.01,1,1,0)
2261.6^B
"^DD",2261.6,2261.6,.01,1,1,1)
S ^OOPS(2261.6,"B",$E(X,1,30),DA)=""
"^DD",2261.6,2261.6,.01,1,1,2)
K ^OOPS(2261.6,"B",$E(X,1,30),DA)
"^DD",2261.6,2261.6,.01,1,2,0)
2261.6^D^MUMPS
"^DD",2261.6,2261.6,.01,1,2,1)
S ^OOPS(2261.6,"D",$$UP^OOPSUTL4($E(X,1,30)),DA)=""
"^DD",2261.6,2261.6,.01,1,2,2)
K ^OOPS(2261.6,"D",$$UP^OOPSUTL4($E(X,1,30)),DA)
"^DD",2261.6,2261.6,.01,1,2,"%D",0)
^^2^2^2980505^^
"^DD",2261.6,2261.6,.01,1,2,"%D",1,0)
This cross-reference allows selection of entries by upper-case
"^DD",2261.6,2261.6,.01,1,2,"%D",2,0)
values.
"^DD",2261.6,2261.6,.01,1,2,"DT")
2980505
"^DD",2261.6,2261.6,.01,3)
Answer must be 3-200 characters in length.
"^DD",2261.6,2261.6,.01,21,0)
^^2^2^2980428^
"^DD",2261.6,2261.6,.01,21,1,0)
Enter an occurrence of sharps injury. This field will describe an
"^DD",2261.6,2261.6,.01,21,2,0)
occurrence of a sharps injury.
"^DD",2261.6,2261.6,.01,"DT")
2980505
"^DD",2261.6,2261.6,1,0)
CODE^NJ3,0^^0;2^K:+X'=X!(X>999)!(X<0)!(X?.E1"."1N.N) X
"^DD",2261.6,2261.6,1,1,0)
^.1
"^DD",2261.6,2261.6,1,1,1,0)
2261.6^C
"^DD",2261.6,2261.6,1,1,1,1)
S ^OOPS(2261.6,"C",$E(X,1,30),DA)=""
"^DD",2261.6,2261.6,1,1,1,2)
K ^OOPS(2261.6,"C",$E(X,1,30),DA)
"^DD",2261.6,2261.6,1,1,1,"DT")
2980311
"^DD",2261.6,2261.6,1,3)
Type a Number between 0 and 999, 0 Decimal Digits
"^DD",2261.6,2261.6,1,21,0)
^^1^1^2980617^
"^DD",2261.6,2261.6,1,21,1,0)
This code will identify the occurrence of a sharps injury.
"^DD",2261.6,2261.6,1,"DT")
2980311
"^DIC",2261.5,2261.5,0)
ASISTS PURPOSE FOR USING SHARPS^2261.5
"^DIC",2261.5,2261.5,0,"GL")
^OOPS(2261.5,
"^DIC",2261.5,2261.5,"%D",0)
^^3^3^2980414^^
"^DIC",2261.5,2261.5,"%D",1,0)
This file contains a list of phrases describing the purpose for originally
"^DIC",2261.5,2261.5,"%D",2,0)
using the sharps item. Each entry is associated with a code.  File data is
"^DIC",2261.5,2261.5,"%D",3,0)
exported with the package and should not be edited by the site.
"^DIC",2261.5,"B","ASISTS PURPOSE FOR USING SHARPS",2261.5)

"^DIC",2261.6,2261.6,0)
ASISTS OCCURRENCE OF SHARPS INJURY^2261.6
"^DIC",2261.6,2261.6,0,"GL")
^OOPS(2261.6,
"^DIC",2261.6,2261.6,"%D",0)
^^3^3^2980414^^
"^DIC",2261.6,2261.6,"%D",1,0)
This file contains a list of phrases describing how or when the injury
"^DIC",2261.6,2261.6,"%D",2,0)
occurred. Each entry is associated with a code. File data is exported with
"^DIC",2261.6,2261.6,"%D",3,0)
the package and should not be edited by the site.
"^DIC",2261.6,"B","ASISTS OCCURRENCE OF SHARPS INJURY",2261.6)

**END**
**END**
