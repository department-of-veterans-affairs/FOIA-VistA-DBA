Released PRCA*4.5*232 SEQ #219
Extracted from mail message
**KIDS**:PRCA*4.5*232^

**INSTALL NAME**
PRCA*4.5*232
"BLD",6160,0)
PRCA*4.5*232^ACCOUNTS RECEIVABLE^0^3060718^y
"BLD",6160,1,0)
^^1^1^3060202^
"BLD",6160,1,1,0)
AR IB EXTRACT PHASE II PART 2
"BLD",6160,4,0)
^9.64PA^348.4^1
"BLD",6160,4,348.4,0)
348.4
"BLD",6160,4,348.4,222)
y^y^f^^^^n^^n
"BLD",6160,4,348.4,224)

"BLD",6160,4,"B",348.4,348.4)

"BLD",6160,"ABPKG")
n
"BLD",6160,"INID")
^n
"BLD",6160,"INIT")
EN^RCXVP232
"BLD",6160,"KRN",0)
^9.67PA^8989.52^19
"BLD",6160,"KRN",.4,0)
.4
"BLD",6160,"KRN",.4,"NM",0)
^9.68A^^
"BLD",6160,"KRN",.401,0)
.401
"BLD",6160,"KRN",.402,0)
.402
"BLD",6160,"KRN",.403,0)
.403
"BLD",6160,"KRN",.5,0)
.5
"BLD",6160,"KRN",.84,0)
.84
"BLD",6160,"KRN",3.6,0)
3.6
"BLD",6160,"KRN",3.8,0)
3.8
"BLD",6160,"KRN",9.2,0)
9.2
"BLD",6160,"KRN",9.8,0)
9.8
"BLD",6160,"KRN",9.8,"NM",0)
^9.68A^5^5
"BLD",6160,"KRN",9.8,"NM",1,0)
RCXVDEQ^^0^B15467596
"BLD",6160,"KRN",9.8,"NM",2,0)
RCXVTSK^^0^B42720951
"BLD",6160,"KRN",9.8,"NM",3,0)
RCXVDC10^^0^B8113955
"BLD",6160,"KRN",9.8,"NM",4,0)
RCXVP232^^0^B46691
"BLD",6160,"KRN",9.8,"NM",5,0)
RCXVDC3^^0^B26462535
"BLD",6160,"KRN",9.8,"NM","B","RCXVDC10",3)

"BLD",6160,"KRN",9.8,"NM","B","RCXVDC3",5)

"BLD",6160,"KRN",9.8,"NM","B","RCXVDEQ",1)

"BLD",6160,"KRN",9.8,"NM","B","RCXVP232",4)

"BLD",6160,"KRN",9.8,"NM","B","RCXVTSK",2)

"BLD",6160,"KRN",19,0)
19
"BLD",6160,"KRN",19.1,0)
19.1
"BLD",6160,"KRN",101,0)
101
"BLD",6160,"KRN",409.61,0)
409.61
"BLD",6160,"KRN",771,0)
771
"BLD",6160,"KRN",870,0)
870
"BLD",6160,"KRN",8989.51,0)
8989.51
"BLD",6160,"KRN",8989.52,0)
8989.52
"BLD",6160,"KRN",8994,0)
8994
"BLD",6160,"KRN","B",.4,.4)

"BLD",6160,"KRN","B",.401,.401)

"BLD",6160,"KRN","B",.402,.402)

"BLD",6160,"KRN","B",.403,.403)

"BLD",6160,"KRN","B",.5,.5)

"BLD",6160,"KRN","B",.84,.84)

"BLD",6160,"KRN","B",3.6,3.6)

"BLD",6160,"KRN","B",3.8,3.8)

"BLD",6160,"KRN","B",9.2,9.2)

"BLD",6160,"KRN","B",9.8,9.8)

"BLD",6160,"KRN","B",19,19)

"BLD",6160,"KRN","B",19.1,19.1)

"BLD",6160,"KRN","B",101,101)

"BLD",6160,"KRN","B",409.61,409.61)

"BLD",6160,"KRN","B",771,771)

"BLD",6160,"KRN","B",870,870)

"BLD",6160,"KRN","B",8989.51,8989.51)

"BLD",6160,"KRN","B",8989.52,8989.52)

"BLD",6160,"KRN","B",8994,8994)

"BLD",6160,"QUES",0)
^9.62^^
"BLD",6160,"REQB",0)
^9.611^6^6
"BLD",6160,"REQB",1,0)
PRCA*4.5*201^2
"BLD",6160,"REQB",2,0)
PRCA*4.5*228^2
"BLD",6160,"REQB",3,0)
IB*2.0*233^2
"BLD",6160,"REQB",4,0)
IB*2.0*301^2
"BLD",6160,"REQB",5,0)
IB*2.0*305^2
"BLD",6160,"REQB",6,0)
PRCA*4.5*243^2
"BLD",6160,"REQB","B","IB*2.0*233",3)

"BLD",6160,"REQB","B","IB*2.0*301",4)

"BLD",6160,"REQB","B","IB*2.0*305",5)

"BLD",6160,"REQB","B","PRCA*4.5*201",1)

"BLD",6160,"REQB","B","PRCA*4.5*228",2)

"BLD",6160,"REQB","B","PRCA*4.5*243",6)

"FIA",348.4)
AR DATA QUEUE
"FIA",348.4,0)
^RCXV(
"FIA",348.4,0,0)
348.4
"FIA",348.4,0,1)
y^y^f^^^^n^^n
"FIA",348.4,0,10)

"FIA",348.4,0,11)

"FIA",348.4,0,"RLRO")

"FIA",348.4,0,"VR")
4.5^PRCA
"FIA",348.4,348.4)
0
"FIA",348.4,348.41)
0
"FIA",348.4,348.42)
0
"FIA",348.4,348.43)
0
"INIT")
EN^RCXVP232
"MBREQ")
0
"PKG",142,-1)
1^1
"PKG",142,0)
ACCOUNTS RECEIVABLE^PRCA^BILL COLLECTIONS
"PKG",142,20,0)
^9.402P^1^1
"PKG",142,20,1,0)
2^^PRCAMRG
"PKG",142,20,1,1)

"PKG",142,20,"B",2,1)

"PKG",142,22,0)
^9.49I^1^1
"PKG",142,22,1,0)
4.5^^2950320
"PKG",142,22,1,"PAH",1,0)
232^3060718^1258
"PKG",142,22,1,"PAH",1,1,0)
^^1^1^3060718
"PKG",142,22,1,"PAH",1,1,1,0)
AR IB EXTRACT PHASE II PART 2
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
5
"RTN","RCXVDC10")
0^3^B8113955^n/a
"RTN","RCXVDC10",1,0)
RCXVDC10 ;ALBANY OI@ALTOONA,PA/TJK-AR Data Extraction Data Creation ;08/18/05
"RTN","RCXVDC10",2,0)
 ;;4.5;Accounts Receivable;**232**;Mar 20, 1995
"RTN","RCXVDC10",3,0)
 ;
"RTN","RCXVDC10",4,0)
 ;  Monthly transmissions 
"RTN","RCXVDC10",5,0)
 Q
"RTN","RCXVDC10",6,0)
EN ;Entry point from nightly process to set up monthly batch jobs
"RTN","RCXVDC10",7,0)
 N RCXVMO,RCXVDA,IENARRAY,RCDA
"RTN","RCXVDC10",8,0)
 S X1=$E(DT,1,5)_"01",X2=-1 D C^%DTC S RCXVMO=$E(X,1,5)_"00"
"RTN","RCXVDC10",9,0)
EN1 ;branch point for historical job
"RTN","RCXVDC10",10,0)
 F RCXVBTY="P","B","I" K RCXVDA,IENARRAY D NBT^RCXVDEQ S RCDA(RCXVBTY)=RCXVDA
"RTN","RCXVDC10",11,0)
 S RCXVDA=RCDA("I"),$P(^RCXV(RCXVDA,0),U,10)=RCXVMO D D3547A
"RTN","RCXVDC10",12,0)
 S RCXVDA=RCDA("P"),$P(^RCXV(RCXVDA,4),U)=RCXVMO
"RTN","RCXVDC10",13,0)
 S RCXVDA=RCDA("B"),$P(^RCXV(RCXVDA,5),U)=RCXVMO
"RTN","RCXVDC10",14,0)
 Q
"RTN","RCXVDC10",15,0)
D3547 ;IB Patient Copay account data
"RTN","RCXVDC10",16,0)
 ;DFN,RCXVBTN defined in routine RCXVTSK
"RTN","RCXVDC10",17,0)
 ;RCXVBTN=Internal number of batch file in ^RCXV(
"RTN","RCXVDC10",18,0)
 N I,RCFLAG,RCXVDA,RCXVMO,SSN,RCXVDT,RCXVCO,VADM
"RTN","RCXVDC10",19,0)
 S RCXVMO=$P(^RCXV(RCXVBTN,0),U,10)
"RTN","RCXVDC10",20,0)
 S (I,RCFLAG)=0 F  S I=$O(^IBAM(354.7,DFN,1,I)) Q:'I  S RCXVCO=$G(^(I,0)) D  Q:RCFLAG
"RTN","RCXVDC10",21,0)
 . I +RCXVCO=RCXVMO S RCFLAG=1
"RTN","RCXVDC10",22,0)
 . Q
"RTN","RCXVDC10",23,0)
 Q:'RCFLAG
"RTN","RCXVDC10",24,0)
 ; Write data into FTP file
"RTN","RCXVDC10",25,0)
 D DEM^VADPT S SSN=$P(VADM(2),U)
"RTN","RCXVDC10",26,0)
 S RCXVDT=$P(RCXVCO,U),RCXVDA=SSN_RCXVU_$E($$HLDATE^HLFNC(RCXVDT),1,8)
"RTN","RCXVDC10",27,0)
 S RCXVDA=RCXVDA_RCXVU_$P(RCXVCO,U,2)
"RTN","RCXVDC10",28,0)
 S X=$P(RCXVCO,U,3),X=$S(X=1:"YES",X=2:"OVER",1:"NO")
"RTN","RCXVDC10",29,0)
 S RCXVDA=RCXVDA_RCXVU_X_RCXVU_$P(RCXVCO,U,4)
"RTN","RCXVDC10",30,0)
 S ^TMP($J,"RCXVDC10",DFN)=RCXVDA
"RTN","RCXVDC10",31,0)
 W "REC:"_$P(RCXVDA,RCXVU,1),!
"RTN","RCXVDC10",32,0)
 W "354.7:"_$P(RCXVDA,RCXVU,2,5),!
"RTN","RCXVDC10",33,0)
 Q
"RTN","RCXVDC10",34,0)
PREREG ;Pre-Registration
"RTN","RCXVDC10",35,0)
 N IBDATA,X1,X2,IBEDT,IBBDT,RCXVDA
"RTN","RCXVDC10",36,0)
 S IBBDT=$E(RCXVMO,1,5)_"01",IBEDT=$$ENDT(IBBDT)
"RTN","RCXVDC10",37,0)
 S IBDATA=$$PREREG^IBRFN4(IBBDT,IBEDT)
"RTN","RCXVDC10",38,0)
 S RCXVDA=$E($$HLDATE^HLFNC(IBBDT),1,8)
"RTN","RCXVDC10",39,0)
 S RCXVDA=RCXVDA_RCXVU_$E($$HLDATE^HLFNC(IBEDT),1,8)_RCXVU_IBDATA
"RTN","RCXVDC10",40,0)
 S ^TMP($J,"RCXVDC10","PRE-REG")=RCXVDA
"RTN","RCXVDC10",41,0)
 W "PRE-REG:"_RCXVDA,!
"RTN","RCXVDC10",42,0)
 Q 
"RTN","RCXVDC10",43,0)
BUFFER ;Insurance buffer
"RTN","RCXVDC10",44,0)
 S IBBDT=$E(RCXVMO,1,5)_"01",IBEDT=$$ENDT(IBBDT)
"RTN","RCXVDC10",45,0)
 S IBDATA=$$BUFFER^IBRFN4(IBBDT,IBEDT)
"RTN","RCXVDC10",46,0)
 S RCXVDA=$E($$HLDATE^HLFNC(IBBDT),1,8)
"RTN","RCXVDC10",47,0)
 S RCXVDA=RCXVDA_RCXVU_$E($$HLDATE^HLFNC(IBEDT),1,8)_RCXVU_IBDATA
"RTN","RCXVDC10",48,0)
 S ^TMP($J,"RCXVDC10","BUFFER")=RCXVDA
"RTN","RCXVDC10",49,0)
 W "BUFFER:"_RCXVDA,!
"RTN","RCXVDC10",50,0)
 Q 
"RTN","RCXVDC10",51,0)
ENDT(IBBDT) ;Calculates end date
"RTN","RCXVDC10",52,0)
 S X1=IBBDT,X2=+31 D C^%DTC
"RTN","RCXVDC10",53,0)
 S X1=$E(X,1,5)_"01",X2=-1 D C^%DTC
"RTN","RCXVDC10",54,0)
 Q X
"RTN","RCXVDC10",55,0)
D3547A ;Sets Patient list from 354.7 into 348.4
"RTN","RCXVDC10",56,0)
 N I,DFN,RCXVDA
"RTN","RCXVDC10",57,0)
 S RCXVDA=RCDA("I")
"RTN","RCXVDC10",58,0)
 F I=0,1,2 D
"RTN","RCXVDC10",59,0)
 . S DFN=0 F  S DFN=$O(^IBAM(354.7,"AC",RCXVMO,I,DFN)) Q:'DFN  D
"RTN","RCXVDC10",60,0)
 . . D FIL^RCXVDEQ("I")
"RTN","RCXVDC10",61,0)
 . . ;  If this patient already exists in this batch, quit
"RTN","RCXVDC10",62,0)
 . . I $D(^RCXV(RCXVDA,3,DFN)) Q 
"RTN","RCXVDC10",63,0)
 . . ;; File record
"RTN","RCXVDC10",64,0)
 . . NEW DIC,DIE,X,DA,DLAYGO,Y,DINUM
"RTN","RCXVDC10",65,0)
 . . S DA(1)=RCXVDA,DIC="^RCXV("_DA(1)_",3,",DIE=DIC,(X,DINUM)=DFN
"RTN","RCXVDC10",66,0)
 . . S DLAYGO=348.43,DIC(0)="L",DIC("P")=DLAYGO
"RTN","RCXVDC10",67,0)
 . . I '$D(^RCXV(DA(1),3,0)) S ^RCXV(DA(1),3,0)="^348.43^^"
"RTN","RCXVDC10",68,0)
 . . D FILE^DICN
"RTN","RCXVDC10",69,0)
 . . Q
"RTN","RCXVDC10",70,0)
 . Q
"RTN","RCXVDC10",71,0)
 S $P(^RCXV(RCXVDA,0),U,10)=RCXVMO
"RTN","RCXVDC10",72,0)
 ;
"RTN","RCXVDC10",73,0)
 Q
"RTN","RCXVDC10",74,0)
HIST ;entry point from post-init for historical job
"RTN","RCXVDC10",75,0)
 D EN1
"RTN","RCXVDC10",76,0)
 Q
"RTN","RCXVDC3")
0^5^B26462535^B25730617
"RTN","RCXVDC3",1,0)
RCXVDC3 ;DAOU/ALA-AR Data Extraction Data Creation ;02-JUL-03
"RTN","RCXVDC3",2,0)
 ;;4.5;Accounts Receivable;**201,227,228,232**;Mar 20, 1995
"RTN","RCXVDC3",3,0)
 ;
"RTN","RCXVDC3",4,0)
 ; CLAIMS (# 399)
"RTN","RCXVDC3",5,0)
 Q
"RTN","RCXVDC3",6,0)
D399 ;
"RTN","RCXVDC3",7,0)
 NEW RCXVD,RCXVBC,RCXVDT,RCXVD1,RCXVD2,RCXVD3
"RTN","RCXVDC3",8,0)
 NEW RCXVD4,RCXVD5,RCXVD6,RCXVD7,RCXVDA,RCXVDB,RCXVDC,RCXVDD
"RTN","RCXVDC3",9,0)
 NEW RCXVP1,RCXVP2,RCXVD0C,RCXVP3,RCXVP4,RCXVP5,RCXVCFL,RCXVPAY
"RTN","RCXVDC3",10,0)
 NEW RCXVINS,RCXVVAN,RCXVDRG,RCXVCAN,RCXVSNR,IBD,X1,X2
"RTN","RCXVDC3",11,0)
 ;
"RTN","RCXVDC3",12,0)
 I $P(RCXVBLNA,"-",2)="" Q
"RTN","RCXVDC3",13,0)
 S RCXVD0=$O(^DGCR(399,"B",$P(RCXVBLNA,"-",2),""))
"RTN","RCXVDC3",14,0)
 I RCXVD0="" Q
"RTN","RCXVDC3",15,0)
 S RCXVD1=$G(^DGCR(399,RCXVD0,0))
"RTN","RCXVDC3",16,0)
 I $G(DFN)="" S DFN=$P(RCXVD1,U,2)
"RTN","RCXVDC3",17,0)
 S RCXVD2=$G(^DGCR(399,RCXVD0,"S"))
"RTN","RCXVDC3",18,0)
 S RCXVD3=$G(^DGCR(399,RCXVD0,"U"))
"RTN","RCXVDC3",19,0)
 S RCXVD7=$G(^DGCR(399,RCXVD0,"TX"))
"RTN","RCXVDC3",20,0)
 S RCXVDA=$P(RCXVD1,U,1) ; BILL #
"RTN","RCXVDC3",21,0)
 S (RCXVEVDT,RCXVDT)=$P($P(RCXVD1,U,3),".",1)
"RTN","RCXVDC3",22,0)
 ;S RCXVDA=RCXVBLNB_RCXVDA_RCXVU_$E($$HLDATE^HLFNC(RCXVDT),1,8) ; EVNT DT
"RTN","RCXVDC3",23,0)
 S RCXVDA=RCXVBLNA_RCXVU_$P(^DPT(DFN,0),U,9) ; SSN
"RTN","RCXVDC3",24,0)
 S RCXVDA=RCXVDA_RCXVU_$E($$HLDATE^HLFNC(RCXVDT),1,8) ; EVNT DT
"RTN","RCXVDC3",25,0)
 S RCXVDA=RCXVDA_RCXVU_$P(RCXVD1,U,5) ; BILL CLASS
"RTN","RCXVDC3",26,0)
 S RCXVP1=$P(RCXVD1,U,7),RCXVP2=""
"RTN","RCXVDC3",27,0)
 I RCXVP1'="" S RCXVP2=$P($G(^DGCR(399.3,RCXVP1,0)),U,1)
"RTN","RCXVDC3",28,0)
 S RCXVDA=RCXVDA_RCXVU_RCXVP2 ; RATE TYPE (P) 
"RTN","RCXVDC3",29,0)
 S RCXVP1=$P(RCXVD2,U,11),RCXVP2=""
"RTN","RCXVDC3",30,0)
 I RCXVP1'="" S RCXVP2=$P($G(^VA(200,RCXVP1,2,0)),U,1)_RCXVP1 ; SITE_IEN
"RTN","RCXVDC3",31,0)
 S RCXVDA=RCXVDA_RCXVU_RCXVSITE_RCXVP2 ; Authorizer (P)
"RTN","RCXVDC3",32,0)
 S RCXVDA=RCXVDA_RCXVU_$P(RCXVD1,U,13) ; Stat 
"RTN","RCXVDC3",33,0)
 S RCXVDT=$P(RCXVD1,U,14)
"RTN","RCXVDC3",34,0)
 S RCXVDA=RCXVDA_RCXVU_$E($$HLDATE^HLFNC(RCXVDT),1,8) ; Stat DT
"RTN","RCXVDC3",35,0)
 S RCXVP1=$P(RCXVD1,U,22),RCXVP2=""
"RTN","RCXVDC3",36,0)
 I RCXVP1'="" S RCXVP2=$P($G(^DG(40.8,RCXVP1,0)),U,2)
"RTN","RCXVDC3",37,0)
 S RCXVDA=RCXVDA_RCXVU_RCXVP2 ; Default division
"RTN","RCXVDC3",38,0)
 S RCXVDA=RCXVDA_RCXVU_$P(RCXVD1,U,24) ; UB92 Location
"RTN","RCXVDC3",39,0)
 S RCXVDA=RCXVDA_RCXVU_$P(RCXVD1,U,27) ; Bill Chrg type
"RTN","RCXVDC3",40,0)
 S RCXVDT=$P(RCXVD2,U,10)
"RTN","RCXVDC3",41,0)
 S RCXVDB=$E($$HLDATE^HLFNC(RCXVDT),1,8) ; Auth. DT
"RTN","RCXVDC3",42,0)
 S RCXVDT=$P(RCXVD2,U,12)
"RTN","RCXVDC3",43,0)
 S RCXVDB=RCXVDB_RCXVU_$E($$HLDATE^HLFNC(RCXVDT),1,8) ; DT 1st printed
"RTN","RCXVDC3",44,0)
 S (RCXVP1,RCXVD0C)=$P($G(^DGCR(399,RCXVD0,"M")),U,1),RCXVP2=""
"RTN","RCXVDC3",45,0)
 I RCXVP1'="" S RCXVP2=$P($G(^DIC(36,RCXVP1,0)),U,1)
"RTN","RCXVDC3",46,0)
 S RCXVDB=RCXVDB_RCXVU_RCXVP2 ; PRIM. INSR (P)
"RTN","RCXVDC3",47,0)
 ;
"RTN","RCXVDC3",48,0)
 ; Type of Plan
"RTN","RCXVDC3",49,0)
 S RCXVP2="",RCXVI=0,RCXVP3="",RCXVP4="",RCXVP5=""
"RTN","RCXVDC3",50,0)
 S IBD=$$IBAREXT^IBRFN4(RCXVD0,.IBD)
"RTN","RCXVDC3",51,0)
 S RCXVP2=$P(IBD("IN"),U),RCXVP5=$P(IBD("IN"),U,2),RCXVP3=$P(IBD("IN"),U,3),RCXVP4=$P(IBD("IN"),U,4)
"RTN","RCXVDC3",52,0)
 S RCXVDB=RCXVDB_RCXVU_RCXVP2_RCXVU_RCXVP5_RCXVU_RCXVP3_RCXVU_RCXVP4,RCXVD5="",RCXVD6=""
"RTN","RCXVDC3",53,0)
 ; 
"RTN","RCXVDC3",54,0)
 ; 36, 36.3 ADDRESS/EDI
"RTN","RCXVDC3",55,0)
 I RCXVD0C S RCXVD5=$G(^DIC(36,RCXVD0C,.11))
"RTN","RCXVDC3",56,0)
 S RCXVDB=RCXVDB_RCXVU_$P(RCXVD5,U,1) ; STRT ADD 1 
"RTN","RCXVDC3",57,0)
 S RCXVDB=RCXVDB_RCXVU_$P(RCXVD5,U,2) ; STRT ADD 2
"RTN","RCXVDC3",58,0)
 S RCXVDB=RCXVDB_RCXVU_$P(RCXVD5,U,4) ; CITY
"RTN","RCXVDC3",59,0)
 S RCXVP1=$P(RCXVD5,U,5),RCXVP2=""
"RTN","RCXVDC3",60,0)
 I RCXVP1'="" S RCXVP2=$P($G(^DIC(5,RCXVP1,0)),U,1)
"RTN","RCXVDC3",61,0)
 S RCXVDB=RCXVDB_RCXVU_RCXVP2 ; STATE (P)
"RTN","RCXVDC3",62,0)
 S RCXVDB=RCXVDB_RCXVU_$P(RCXVD5,U,6) ; ZIP
"RTN","RCXVDC3",63,0)
 I RCXVD0C'="" S RCXVD6=$G(^DIC(36,RCXVD0C,3))
"RTN","RCXVDC3",64,0)
 S RCXVDB=RCXVDB_RCXVU_$P(RCXVD6,U,2) ; EDI - PROF
"RTN","RCXVDC3",65,0)
 S RCXVDB=RCXVDB_RCXVU_$P(RCXVD6,U,4) ; EDI - INST
"RTN","RCXVDC3",66,0)
 S RCXVDB=RCXVDB_RCXVU_$$GET1^DIQ(36,RCXVD0C_",",1,"I") ; REIMBURSE?
"RTN","RCXVDC3",67,0)
 ;
"RTN","RCXVDC3",68,0)
 S RCXVPFDT=$P(RCXVD3,U,1)
"RTN","RCXVDC3",69,0)
 S RCXVDC=$$HLDATE^HLFNC(RCXVPFDT) ; STMT COVERS FROM
"RTN","RCXVDC3",70,0)
 S RCXVPTDT=$P(RCXVD3,U,2)
"RTN","RCXVDC3",71,0)
 S RCXVDC=RCXVDC_RCXVU_$$HLDATE^HLFNC(RCXVPTDT) ; STMT COVERS TO
"RTN","RCXVDC3",72,0)
 S RCXVP1=$P(RCXVD3,U,11),RCXVP2=""
"RTN","RCXVDC3",73,0)
 I RCXVP1'="" S RCXVP2=$P($G(^DGCR(399.1,RCXVP1,0)),U,1)
"RTN","RCXVDC3",74,0)
 S RCXVDC=RCXVDC_RCXVU_RCXVP2 ; DISCH. BED SEC.
"RTN","RCXVDC3",75,0)
 S RCXVD4=$G(^DGCR(399,RCXVD0,"U1"))
"RTN","RCXVDC3",76,0)
 S RCXVDC=RCXVDC_RCXVU_$P(RCXVD4,U,1) ; TOT CHRG
"RTN","RCXVDC3",77,0)
 ;
"RTN","RCXVDC3",78,0)
 S RCXVP1=$P($G(^DGCR(399,RCXVD0,"U2")),U,10),RCXVP2=""
"RTN","RCXVDC3",79,0)
 I RCXVP1'="" S RCXVP2=$P($G(^IBA(355.93,RCXVP1,0)),U,1)
"RTN","RCXVDC3",80,0)
 S RCXVDC=RCXVDC_RCXVU_RCXVP2 ; NON VA FAC (P)
"RTN","RCXVDC3",81,0)
 ;
"RTN","RCXVDC3",82,0)
 ;  Get VACARE or NONVACARE flag
"RTN","RCXVDC3",83,0)
 NEW RCXVIEN
"RTN","RCXVDC3",84,0)
 D CARE^RCXVUTIL(RCXVD0)
"RTN","RCXVDC3",85,0)
 S RCXVDC=RCXVDC_RCXVU_$S(RCXVCFL=1:"VACARE",1:"NONVACARE")
"RTN","RCXVDC3",86,0)
 ;  MRA data
"RTN","RCXVDC3",87,0)
 S RCXVDT=$P(IBD,U,2)
"RTN","RCXVDC3",88,0)
 S RCXVDD=$E($$HLDATE^HLFNC(RCXVDT),1,8) ; MRA Requested DT
"RTN","RCXVDC3",89,0)
 S RCXVDT=$P(IBD,U,3)
"RTN","RCXVDC3",90,0)
 S RCXVDD=RCXVDD_RCXVU_$E($$HLDATE^HLFNC(RCXVDT),1,8) ;Last Electronic Extract Date
"RTN","RCXVDC3",91,0)
 S RCXVDD=RCXVDD_RCXVU_$P(IBD,U,4) ;Printed VIA EDI
"RTN","RCXVDC3",92,0)
 S RCXVDD=RCXVDD_RCXVU_$P(IBD,U,5) ;Force Claim To Print
"RTN","RCXVDC3",93,0)
 S RCXVDD=RCXVDD_RCXVU_$P(IBD,U,6) ;Claim MRA Status
"RTN","RCXVDC3",94,0)
 S RCXVDT=$P(IBD,U,7)
"RTN","RCXVDC3",95,0)
 S RCXVDD=RCXVDD_RCXVU_$E($$HLDATE^HLFNC(RCXVDT),1,8) ;MRA Recorded Date
"RTN","RCXVDC3",96,0)
 S RCXVDT=$P(IBD,U,8)
"RTN","RCXVDC3",97,0)
 S RCXVDD=RCXVDD_RCXVU_$E($$HLDATE^HLFNC(RCXVDT),1,8) ;Date Cancelled
"RTN","RCXVDC3",98,0)
 S RCXVDD=RCXVDD_RCXVU_$P(IBD,U,9) ;Form Type
"RTN","RCXVDC3",99,0)
 S RCXVDD=RCXVDD_RCXVU_$P(IBD,U,16)_RCXVU_$P(IBD,U,15) ;PAYER&VA NAT.ID #
"RTN","RCXVDC3",100,0)
 S RCXVDRG=$P(IBD,U,11)
"RTN","RCXVDC3",101,0)
 S RCXVDD=RCXVDD_RCXVU_RCXVDRG ;DRG
"RTN","RCXVDC3",102,0)
 S RCXVSNR=$P(IBD,U,14) ;Days site not responsible for MRA request
"RTN","RCXVDC3",103,0)
 S RCXVDD=RCXVDD_RCXVU_RCXVSNR
"RTN","RCXVDC3",104,0)
 S RCXVDD=RCXVDD_RCXVU_$P($P(IBD,U,12),";") ;ECME #
"RTN","RCXVDC3",105,0)
 S RCXVDD=RCXVDD_RCXVU_$P(IBD,U,17) ;Offset Amount
"RTN","RCXVDC3",106,0)
 S ^TMP($J,RCXVBLN,"3-399A")=RCXVDA
"RTN","RCXVDC3",107,0)
 S ^TMP($J,RCXVBLN,"3-399B")=RCXVDB
"RTN","RCXVDC3",108,0)
 S ^TMP($J,RCXVBLN,"3-399C")=RCXVDC
"RTN","RCXVDC3",109,0)
 S ^TMP($J,RCXVBLN,"3-399D")=RCXVDD
"RTN","RCXVDC3",110,0)
 Q
"RTN","RCXVDC3",111,0)
 ;
"RTN","RCXVDC3",112,0)
REJ() ;Checks for reject on a claim
"RTN","RCXVDC3",113,0)
 S X="NO"
"RTN","RCXVDC3",114,0)
 S X1=$P(RCXVD1,U,15) S D0=RCXVD0
"RTN","RCXVDC3",115,0)
 F  D  G REJQ:'D0
"RTN","RCXVDC3",116,0)
 . S I=0 F  S I=$O(^IBM(361,"B",D0,I)) Q:'I  D  Q:'D0
"RTN","RCXVDC3",117,0)
   ..S X2=$P($G(^IBM(361,I,0)),U,3)
"RTN","RCXVDC3",118,0)
   ..I X2="R" S X="YES",D0=""
"RTN","RCXVDC3",119,0)
   ..Q
"RTN","RCXVDC3",120,0)
 .I X="YES" Q
"RTN","RCXVDC3",121,0)
 .I X1=D0 S D0="" Q
"RTN","RCXVDC3",122,0)
 .S D0=X1 Q:'D0  S X1=$P($G(^DGCR(399,X1,0)),U,15)
"RTN","RCXVDC3",123,0)
 .Q
"RTN","RCXVDC3",124,0)
 K I
"RTN","RCXVDC3",125,0)
REJQ Q X
"RTN","RCXVDC3",126,0)
 ;
"RTN","RCXVDEQ")
0^1^B15467596^B15138965
"RTN","RCXVDEQ",1,0)
RCXVDEQ ;DAOU/ALA-AR Data Extract Queue Trigger ;02-JUL-03
"RTN","RCXVDEQ",2,0)
 ;;4.5;Accounts Receivable;**201,228,240,243,232**;Mar 20, 1995
"RTN","RCXVDEQ",3,0)
 ;*****240 change in this routine for test sites only****
"RTN","RCXVDEQ",4,0)
 ;
"RTN","RCXVDEQ",5,0)
 ;**Program Description**
"RTN","RCXVDEQ",6,0)
 ;  This program will log a record who meets the
"RTN","RCXVDEQ",7,0)
 ;  selection criteria for the VISTA Data Extract
"RTN","RCXVDEQ",8,0)
 ;
"RTN","RCXVDEQ",9,0)
AR ;  Triggers from the Accounts Receivable File (#430)
"RTN","RCXVDEQ",10,0)
 NEW DFN
"RTN","RCXVDEQ",11,0)
 ;
"RTN","RCXVDEQ",12,0)
 S RCXVBLN=D0,RCXVSTAT=$P(^PRCA(430,D0,0),U,8)
"RTN","RCXVDEQ",13,0)
 I '+$P(^PRCA(430.3,RCXVSTAT,0),U,6) Q
"RTN","RCXVDEQ",14,0)
 ;
"RTN","RCXVDEQ",15,0)
 S DFN=$P(^PRCA(430,D0,0),U,7)
"RTN","RCXVDEQ",16,0)
 D FIL("D")
"RTN","RCXVDEQ",17,0)
 ;
"RTN","RCXVDEQ",18,0)
 K RCXVBLN,RCXVSTAT
"RTN","RCXVDEQ",19,0)
 Q
"RTN","RCXVDEQ",20,0)
 ;
"RTN","RCXVDEQ",21,0)
AT ;  Triggers from the Accounts Receivable Transactions (#433)
"RTN","RCXVDEQ",22,0)
 NEW DFN
"RTN","RCXVDEQ",23,0)
 ;
"RTN","RCXVDEQ",24,0)
 S RCXVBLN=$P($G(^PRCA(433,D0,0)),U,2)
"RTN","RCXVDEQ",25,0)
 I RCXVBLN="" Q
"RTN","RCXVDEQ",26,0)
 S RCXVTYP=$P($G(^PRCA(433,D0,1)),U,2)
"RTN","RCXVDEQ",27,0)
 I RCXVTYP="" Q
"RTN","RCXVDEQ",28,0)
 ;
"RTN","RCXVDEQ",29,0)
 I '+$P(^PRCA(430.3,RCXVTYP,0),U,6) Q
"RTN","RCXVDEQ",30,0)
 ;
"RTN","RCXVDEQ",31,0)
 S DFN=$P(^PRCA(430,RCXVBLN,0),U,7)
"RTN","RCXVDEQ",32,0)
 D FIL("D")
"RTN","RCXVDEQ",33,0)
 ;
"RTN","RCXVDEQ",34,0)
 K RCXVBLN,RCXVTYP
"RTN","RCXVDEQ",35,0)
 Q
"RTN","RCXVDEQ",36,0)
 ;
"RTN","RCXVDEQ",37,0)
FIL(RCXVBTY) ;  File the record into the AR Data Queue File (#348.4)
"RTN","RCXVDEQ",38,0)
 ;
"RTN","RCXVDEQ",39,0)
 ;  If a test system has 'turned off' extract, quit
"RTN","RCXVDEQ",40,0)
 I '$$GET1^DIQ(342,"1,",20.04,"I") Q
"RTN","RCXVDEQ",41,0)
 ;
"RTN","RCXVDEQ",42,0)
 ;  Input Parameter
"RTN","RCXVDEQ",43,0)
 ;    RCXVBTY = Batch Type (H=Historical, D=Daily, C=Current Fiscal Year, A=Active,E=FY05 DATA,I=CoPay Patient Data)
"RTN","RCXVDEQ",44,0)
 ;    RCXVBLN = Bill IEN
"RTN","RCXVDEQ",45,0)
 ;
"RTN","RCXVDEQ",46,0)
 N FDA,RCXVCURB,RCVXBNM,RCVXBMX
"RTN","RCXVDEQ",47,0)
 ; 
"RTN","RCXVDEQ",48,0)
 ; Where there has been any update/change to the system 
"RTN","RCXVDEQ",49,0)
 ; for a particular bill for the previous days business business (T-1). 
"RTN","RCXVDEQ",50,0)
 ;
"RTN","RCXVDEQ",51,0)
 ; Get current batch
"RTN","RCXVDEQ",52,0)
BTC K ^TMP("RCXVA",$J)
"RTN","RCXVDEQ",53,0)
 D FIND^DIC(348.4,"","","P",DT,"","C","I $P(^(0),U,4)=RCXVBTY","","^TMP(""RCXVA"",$J)")
"RTN","RCXVDEQ",54,0)
 S RCXVCURB=+$P($G(^TMP("RCXVA",$J,"DILIST",0)),U,1)
"RTN","RCXVDEQ",55,0)
 S RCVXCTY="",RCXVBDT="",RCXQFL=0
"RTN","RCXVDEQ",56,0)
 ;
"RTN","RCXVDEQ",57,0)
 ;  If there is no batch for today, create a new batch
"RTN","RCXVDEQ",58,0)
 I RCXVCURB=0 D NBT G CON:'RCXQFL,BTC
"RTN","RCXVDEQ",59,0)
 ;
"RTN","RCXVDEQ",60,0)
 ; Check to see if batch is full.
"RTN","RCXVDEQ",61,0)
 S RCXVCURB=$P(^TMP("RCXVA",$J,"DILIST",RCXVCURB,0),U,1)
"RTN","RCXVDEQ",62,0)
 I RCXVCURB'=0 D
"RTN","RCXVDEQ",63,0)
 . S RCVXBNM=$P($G(^RCXV(RCXVCURB,0)),U,7) ; Number of record in batch
"RTN","RCXVDEQ",64,0)
 . S RCVXCTY=$P($G(^RCXV(RCXVCURB,0)),U,4) ; Current batch type
"RTN","RCXVDEQ",65,0)
 . S RCXVBDT=$P($G(^RCXV(RCXVCURB,0)),U,2) ; Batch Date
"RTN","RCXVDEQ",66,0)
 . S RCXVBST=$P($G(^RCXV(RCXVCURB,0)),U,3) ; Batch Status
"RTN","RCXVDEQ",67,0)
 S RCVXBMX=$P($G(^RC(342,1,20)),U,5) ; Max. # of record per batch
"RTN","RCXVDEQ",68,0)
 ;  OR if the number of records in batch exceeds the
"RTN","RCXVDEQ",69,0)
 ;  maximum number of records per batch --> create new batch
"RTN","RCXVDEQ",70,0)
 ;  change in line below for patch 240
"RTN","RCXVDEQ",71,0)
 I (RCVXBNM>RCVXBMX)!(RCVXBNM=RCVXBMX)!(RCXVBST="T")!(RCXVBST="C") D NBT G BTC:RCXQFL=1
"RTN","RCXVDEQ",72,0)
 ;
"RTN","RCXVDEQ",73,0)
CON ;  Continue with updating the AR Data Queue file
"RTN","RCXVDEQ",74,0)
 S RCXVDA=$S($G(RCXVCURB)'=0:RCXVCURB,1:RCXVDA)
"RTN","RCXVDEQ",75,0)
 ;
"RTN","RCXVDEQ",76,0)
 ;  If the Batch Type is 'R', quit
"RTN","RCXVDEQ",77,0)
 I RCXVBTY="R"!(RCXVBTY="I") Q
"RTN","RCXVDEQ",78,0)
 ;
"RTN","RCXVDEQ",79,0)
 ;  If this bill number already exists in this batch, quit
"RTN","RCXVDEQ",80,0)
 I $D(^RCXV(RCXVDA,1,RCXVBLN)) Q
"RTN","RCXVDEQ",81,0)
 ;
"RTN","RCXVDEQ",82,0)
 ; File record
"RTN","RCXVDEQ",83,0)
 NEW DIC,DIE,X,DA,DLAYGO,Y,DINUM
"RTN","RCXVDEQ",84,0)
 S DA(1)=RCXVDA,DIC="^RCXV("_DA(1)_",1,",DIE=DIC,(X,DINUM)=RCXVBLN
"RTN","RCXVDEQ",85,0)
 S DLAYGO=348.41,DIC(0)="L",DIC("P")=DLAYGO
"RTN","RCXVDEQ",86,0)
 I '$D(^RCXV(DA(1),1,0)) S ^RCXV(DA(1),1,0)="^348.41^^"
"RTN","RCXVDEQ",87,0)
 K DO D FILE^DICN K DO
"RTN","RCXVDEQ",88,0)
 ;
"RTN","RCXVDEQ",89,0)
 S RCUPD(348.4,RCXVDA_",",.07)=(RCVXBNM+1)
"RTN","RCXVDEQ",90,0)
 S RCUPD(348.41,RCXVBLN_","_RCXVDA_",",.02)=$G(DFN)
"RTN","RCXVDEQ",91,0)
 D FILE^DIE("","RCUPD","RCXVERR")
"RTN","RCXVDEQ",92,0)
 ;
"RTN","RCXVDEQ",93,0)
 K RCXVDA,RCVXBNM,RCXVBLN,RCXVCURB,RCXVBTY,RCVXBMX,RCVXCTY,RCXVBDT
"RTN","RCXVDEQ",94,0)
 K ^TMP("RCXVA",$J),IENARRAY,RCXVBST,RCUPD,RCXVERR,RCXQFL
"RTN","RCXVDEQ",95,0)
 Q
"RTN","RCXVDEQ",96,0)
 ;
"RTN","RCXVDEQ",97,0)
NBT ;  Create a new batch
"RTN","RCXVDEQ",98,0)
 N $ES,$ET
"RTN","RCXVDEQ",99,0)
 S $ET="D ER^RCXVDEQ"
"RTN","RCXVDEQ",100,0)
 L +^RCXVLK:1 E  S RCXQFL=1 Q
"RTN","RCXVDEQ",101,0)
 S RCXVCURB=$P(^RCXV(0),U,3)+1
"RTN","RCXVDEQ",102,0)
 S RCVXBNM=0
"RTN","RCXVDEQ",103,0)
 S FDA(348.4,"+1,",.01)=RCXVCURB
"RTN","RCXVDEQ",104,0)
 S FDA(348.4,"+1,",.02)=DT
"RTN","RCXVDEQ",105,0)
 S FDA(348.4,"+1,",.03)="P"
"RTN","RCXVDEQ",106,0)
 S FDA(348.4,"+1,",.04)=RCXVBTY
"RTN","RCXVDEQ",107,0)
 S FDA(348.4,"+1,",.07)=RCVXBNM
"RTN","RCXVDEQ",108,0)
 D UPDATE^DIE("","FDA","IENARRAY","ERROR")
"RTN","RCXVDEQ",109,0)
 I '$D(ERROR) S RCXVDA=$G(IENARRAY(1))
"RTN","RCXVDEQ",110,0)
 L -^RCXVLK
"RTN","RCXVDEQ",111,0)
 Q
"RTN","RCXVDEQ",112,0)
 ;
"RTN","RCXVDEQ",113,0)
UDR ;  Update Deposits/Receipts subfile
"RTN","RCXVDEQ",114,0)
 ; If this batch payment number already exists in this batch, quit
"RTN","RCXVDEQ",115,0)
 I $D(^RCXV(RCXVDA,2,RCXVD0)) Q
"RTN","RCXVDEQ",116,0)
 ;
"RTN","RCXVDEQ",117,0)
 ; File record
"RTN","RCXVDEQ",118,0)
 NEW DIC,DIE,X,DA,DLAYGO,Y,DINUM
"RTN","RCXVDEQ",119,0)
 S DA(1)=RCXVDA,DIC="^RCXV("_DA(1)_",2,",DIE=DIC,(X,DINUM)=RCXVD0
"RTN","RCXVDEQ",120,0)
 S DLAYGO=348.42,DIC(0)="L",DIC("P")=DLAYGO
"RTN","RCXVDEQ",121,0)
 I '$D(^RCXV(DA(1),2,0)) S ^RCXV(DA(1),2,0)="^348.42^^"
"RTN","RCXVDEQ",122,0)
 K DO D FILE^DICN K DO
"RTN","RCXVDEQ",123,0)
 ;
"RTN","RCXVDEQ",124,0)
 S RCUPD(348.4,RCXVDA_",",.07)=RCXVRNUM
"RTN","RCXVDEQ",125,0)
 D FILE^DIE("","RCUPD","RCXVERR")
"RTN","RCXVDEQ",126,0)
 K RCXVERR,RCUPD
"RTN","RCXVDEQ",127,0)
 Q
"RTN","RCXVDEQ",128,0)
 ;
"RTN","RCXVDEQ",129,0)
ER ; Unlock and log error
"RTN","RCXVDEQ",130,0)
 L -^RCXVLK
"RTN","RCXVDEQ",131,0)
 D ^%ZTER
"RTN","RCXVDEQ",132,0)
 D UNWIND^%ZTER
"RTN","RCXVDEQ",133,0)
 Q
"RTN","RCXVP232")
0^4^B46691^n/a
"RTN","RCXVP232",1,0)
RCXVP232 ;ALBANY OI@ALTOONA,PA/TJK-AR Data Extraction - Post-Install Program ;8/18/05
"RTN","RCXVP232",2,0)
 ;;4.5;Accounts Receivable;**232**;Mar 20, 1995
"RTN","RCXVP232",3,0)
 ;
"RTN","RCXVP232",4,0)
 ;** Program Description **
"RTN","RCXVP232",5,0)
 ;  This program will be run on installation of patch
"RTN","RCXVP232",6,0)
 ;  PRCA*4.5*232 for CBO to ARC Data Extractions
"RTN","RCXVP232",7,0)
 ;
"RTN","RCXVP232",8,0)
EN ; Entry Point
"RTN","RCXVP232",9,0)
 ; Reset CBO Flag field to for bills in NEW BILL status to "INCLUDE"
"RTN","RCXVP232",10,0)
 S $P(^PRCA(430.3,18,0),U,6)=1
"RTN","RCXVP232",11,0)
 Q
"RTN","RCXVP232",12,0)
 ;
"RTN","RCXVTSK")
0^2^B42720951^B38032406
"RTN","RCXVTSK",1,0)
RCXVTSK ;DAOU/ALA-AR Data Extract Nightly Task ;23-JUL-03
"RTN","RCXVTSK",2,0)
 ;;4.5;Accounts Receivable;**201,227,228,232**;Mar 20, 1995
"RTN","RCXVTSK",3,0)
 ;
"RTN","RCXVTSK",4,0)
 ;** Program Description **
"RTN","RCXVTSK",5,0)
 ;  This program is the nightly task program for the
"RTN","RCXVTSK",6,0)
 ;  CBO Data Extract to the Boston Allocation Resource
"RTN","RCXVTSK",7,0)
 ;  Center
"RTN","RCXVTSK",8,0)
 ;
"RTN","RCXVTSK",9,0)
EN ;  Entry point
"RTN","RCXVTSK",10,0)
 ;
"RTN","RCXVTSK",11,0)
 ;  If a test system has 'turned off' extract, quit
"RTN","RCXVTSK",12,0)
 I '$$GET1^DIQ(342,"1,",20.04,"I") Q
"RTN","RCXVTSK",13,0)
 ;
"RTN","RCXVTSK",14,0)
 N $ES,$ET
"RTN","RCXVTSK",15,0)
 S $ET="D ER^RCXVTSK"
"RTN","RCXVTSK",16,0)
 ;
"RTN","RCXVTSK",17,0)
 L +^RCXVTSK:60 E  Q
"RTN","RCXVTSK",18,0)
 ;
"RTN","RCXVTSK",19,0)
 ;  Purge completed batches
"RTN","RCXVTSK",20,0)
 S IEN="",DIK="^RCXV("
"RTN","RCXVTSK",21,0)
 F  S IEN=$O(^RCXV("AC","C",IEN)) Q:IEN=""  D
"RTN","RCXVTSK",22,0)
 . S DA=IEN D ^DIK
"RTN","RCXVTSK",23,0)
 ;
"RTN","RCXVTSK",24,0)
 K ^TMP("RCXVMSG",$J)
"RTN","RCXVTSK",25,0)
 ;
"RTN","RCXVTSK",26,0)
 ;  Find all deposits/receipts
"RTN","RCXVTSK",27,0)
 S RCXVD0="",RCXVRNUM=0,RCXVDT=$$FMADD^XLFDT(DT,-1)
"RTN","RCXVTSK",28,0)
 F  S RCXVD0=$O(^RCY(344,"ASTAT",0,RCXVD0)) Q:RCXVD0=""  D
"RTN","RCXVTSK",29,0)
 . S RCXVEDT=$P($G(^RCY(344,RCXVD0,0)),U,12)\1
"RTN","RCXVTSK",30,0)
 . I RCXVEDT'=RCXVDT Q
"RTN","RCXVTSK",31,0)
 . S RCXVRNUM=RCXVRNUM+1
"RTN","RCXVTSK",32,0)
 . D FIL^RCXVDEQ("R")
"RTN","RCXVTSK",33,0)
 . D UDR^RCXVDEQ
"RTN","RCXVTSK",34,0)
 ;
"RTN","RCXVTSK",35,0)
 K RCXVD0,RCXVRNUM,RCXVDT,RCXVEDT,RCXVDA,RCVXCTY,RCXVBDT
"RTN","RCXVTSK",36,0)
 ;
"RTN","RCXVTSK",37,0)
 S RCXVBTN="",RCXVU="^",RCXVXDT=DT
"RTN","RCXVTSK",38,0)
 ;
"RTN","RCXVTSK",39,0)
 ;  If the CCPC calculation is scheduled to run, don't
"RTN","RCXVTSK",40,0)
 ;  run the nightly task
"RTN","RCXVTSK",41,0)
 ; Patch 228 changes software to allow nightly task on CCPC date
"RTN","RCXVTSK",42,0)
 ;S X1=$$STD^RCCPCFN,X2=-3 D C^%DTC I X=DT L -^RCXVTSK K X Q
"RTN","RCXVTSK",43,0)
 ;K X1,X2
"RTN","RCXVTSK",44,0)
 ;
"RTN","RCXVTSK",45,0)
MONTHLY ;Set up monthly transmission batches
"RTN","RCXVTSK",46,0)
 I $E(DT,6,7)="01" D EN^RCXVDC10
"RTN","RCXVTSK",47,0)
NM ;  Find all new batches to be transmitted
"RTN","RCXVTSK",48,0)
 S RBSQ=0,RBTOT=0
"RTN","RCXVTSK",49,0)
 F  S RCXVBTN=$O(^RCXV("AC","P",RCXVBTN)) Q:RCXVBTN=""  D
"RTN","RCXVTSK",50,0)
 . I $G(^RCXV(RCXVBTN,0))="" Q
"RTN","RCXVTSK",51,0)
 . S RBSQ=RBSQ+1,RBTOT=RBTOT+1
"RTN","RCXVTSK",52,0)
 . I $P(^RCXV(RCXVBTN,0),U,1)'=RCXVBTN S RCXVUP(348.4,RCXVBTN_",",.01)=RCXVBTN
"RTN","RCXVTSK",53,0)
 . S RCXVUP(348.4,RCXVBTN_",",.05)=RBSQ
"RTN","RCXVTSK",54,0)
 F  S RCXVBTN=$O(RCXVUP(348.4,RCXVBTN)) Q:RCXVBTN=""  D
"RTN","RCXVTSK",55,0)
 . S RCXVUP(348.4,RCXVBTN,.06)=RBTOT
"RTN","RCXVTSK",56,0)
 D FILE^DIE("","RCXVUP","RCXVERR")
"RTN","RCXVTSK",57,0)
 K RCXVUP
"RTN","RCXVTSK",58,0)
 ;
"RTN","RCXVTSK",59,0)
 S RCXVBTN=""
"RTN","RCXVTSK",60,0)
STRT ;  Start the build and transmission of batches
"RTN","RCXVTSK",61,0)
 D ^RCXVCHK
"RTN","RCXVTSK",62,0)
 F RCSTAT="T","P" F  S RCXVBTN=$O(^RCXV("AC",RCSTAT,RCXVBTN)) Q:RCXVBTN=""  D
"RTN","RCXVTSK",63,0)
 . S RCXVBLN=0,RQFL=0
"RTN","RCXVTSK",64,0)
 . S RCXVSITE=$P($$SITE^VASITE(),U,3)
"RTN","RCXVTSK",65,0)
 . S RCXVDIR=$P($G(^RC(342,1,20)),U,1)
"RTN","RCXVTSK",66,0)
 . S RCXVBDT=$P($G(^RCXV(RCXVBTN,0)),U,2)
"RTN","RCXVTSK",67,0)
 . S RCXVBTY=$P($G(^RCXV(RCXVBTN,0)),U,4)
"RTN","RCXVTSK",68,0)
 . S RCXVSEQ=$P($G(^RCXV(RCXVBTN,0)),U,5)
"RTN","RCXVTSK",69,0)
 . S RCXVSTOT=$P($G(^RCXV(RCXVBTN,0)),U,6)
"RTN","RCXVTSK",70,0)
 . S RCXVLDOM=$P($G(^RC(342,1,20)),U,8)
"RTN","RCXVTSK",71,0)
 . ;S RCXVLEG=+$P($G(^RC(342,1,20)),U,7)
"RTN","RCXVTSK",72,0)
 . ;
"RTN","RCXVTSK",73,0)
 . I RCSTAT'="T" D  Q:RQFL
"RTN","RCXVTSK",74,0)
 .. I $G(RCXVSEQ)="" S RQFL=1 Q
"RTN","RCXVTSK",75,0)
 .. I $P(^RCXV(RCXVBTN,0),U,3)="C" S RQFL=1 Q
"RTN","RCXVTSK",76,0)
 .. S RCXVUP(348.4,RCXVBTN_",",.03)="T"
"RTN","RCXVTSK",77,0)
 .. D FILE^DIE("I","RCXVUP","RCXVERR")
"RTN","RCXVTSK",78,0)
 .. K RCXVUP
"RTN","RCXVTSK",79,0)
 . ;
"RTN","RCXVTSK",80,0)
 . ; If a file has been transmitted but no acknowledgement
"RTN","RCXVTSK",81,0)
 . ; has been received after 5 days, resend
"RTN","RCXVTSK",82,0)
 . I RCSTAT="T" D  Q:RQFL
"RTN","RCXVTSK",83,0)
 .. S RCXVTRD=$P($G(^RCXV(RCXVBTN,0)),U,8)\1
"RTN","RCXVTSK",84,0)
 .. S RCXVARD=$P($G(^RCXV(RCXVBTN,0)),U,9)\1
"RTN","RCXVTSK",85,0)
 .. I $$FMADD^XLFDT(RCXVTRD,5)>DT S RQFL=1
"RTN","RCXVTSK",86,0)
 .. ;I RCXVARD=0,RCXVLEG,RCXVTRD'=0 S RQFL=1
"RTN","RCXVTSK",87,0)
 . ;
"RTN","RCXVTSK",88,0)
 . Q:RQFL
"RTN","RCXVTSK",89,0)
 . ; FILENAME=SITE_DATE_BATCH# 
"RTN","RCXVTSK",90,0)
 . S RCXVFILE="RCXV"_RCXVSITE_RCXVBDT_RCXVBTN_".TXT"
"RTN","RCXVTSK",91,0)
 . S RCXVSCR="TMP_RCXV"_RCXVSITE_"_"_RCXVBTN
"RTN","RCXVTSK",92,0)
 . D OPEN^%ZISH("RCXVHNDL",RCXVDIR,RCXVFILE,"W")
"RTN","RCXVTSK",93,0)
 . U IO
"RTN","RCXVTSK",94,0)
 . S RCXVDMN=$P($G(^XTV(8989.3,1,0)),U,1)
"RTN","RCXVTSK",95,0)
 . S RCXVDMN=$P($G(^DIC(4.2,RCXVDMN,0)),U,1)
"RTN","RCXVTSK",96,0)
 . S RCXVRN=$P($G(^RCXV(RCXVBTN,1,0)),U,4) ; # OF REC FOR BILLS
"RTN","RCXVTSK",97,0)
 . I RCXVRN="" S RCXVRN=$P($G(^RCXV(RCXVBTN,2,0)),U,4) ; # REC DEP/REC
"RTN","RCXVTSK",98,0)
 . S RCXVRT=$P($G(^RCXV(RCXVBTN,0)),U,4) ; TYPE OF DATA 
"RTN","RCXVTSK",99,0)
 . W "HDR:"_RCXVSITE_RCXVU_RCXVDMN_RCXVU_RCXVRT_RCXVU_RCXVRN_RCXVU_RCXVBDT_RCXVU_RCXVXDT_RCXVU_RCXVSEQ_RCXVU_RCXVSTOT_RCXVU_RCXVLDOM,!
"RTN","RCXVTSK",100,0)
 . F  S RCXVBLN=$O(^RCXV(RCXVBTN,1,RCXVBLN)) Q:'RCXVBLN  D
"RTN","RCXVTSK",101,0)
 .. S DFN=$P(^RCXV(RCXVBTN,1,RCXVBLN,0),U,2)
"RTN","RCXVTSK",102,0)
 .. D EN^RCXVDC
"RTN","RCXVTSK",103,0)
 . ;
"RTN","RCXVTSK",104,0)
 . S RCXVD0=0
"RTN","RCXVTSK",105,0)
 . F  S RCXVD0=$O(^RCXV(RCXVBTN,2,RCXVD0)) Q:'RCXVD0  D
"RTN","RCXVTSK",106,0)
 .. S RCXVEDT=$P($G(^RCY(344,RCXVD0,0)),U,12)\1
"RTN","RCXVTSK",107,0)
 .. D D344^RCXVDC8
"RTN","RCXVTSK",108,0)
 . ;
"RTN","RCXVTSK",109,0)
 . S RCXVD0=0
"RTN","RCXVTSK",110,0)
 . F  S RCXVD0=$O(^RCXV(RCXVBTN,3,RCXVD0)) Q:'RCXVD0  D
"RTN","RCXVTSK",111,0)
 .. S DFN=RCXVD0
"RTN","RCXVTSK",112,0)
 .. D D3547^RCXVDC10
"RTN","RCXVTSK",113,0)
 . ;
"RTN","RCXVTSK",114,0)
 . I $D(^RCXV(RCXVBTN,4)) S RCXVMO=$G(^(4)) D PREREG^RCXVDC10
"RTN","RCXVTSK",115,0)
 . ;
"RTN","RCXVTSK",116,0)
 . I $D(^RCXV(RCXVBTN,5)) S RCXVMO=$G(^(5)) D BUFFER^RCXVDC10
"RTN","RCXVTSK",117,0)
 . ;
"RTN","RCXVTSK",118,0)
 . D CLOSE^%ZISH("RCXVHNDL")
"RTN","RCXVTSK",119,0)
 . ;
"RTN","RCXVTSK",120,0)
 . S $P(^RC(342,1,20),U,9)=$$NOW^XLFDT()
"RTN","RCXVTSK",121,0)
 . ;
"RTN","RCXVTSK",122,0)
 . ;  FTP directly to ARC
"RTN","RCXVTSK",123,0)
 . D EN^RCXVFTP(RCXVFILE,RCXVDIR)
"RTN","RCXVTSK",124,0)
 ;
"RTN","RCXVTSK",125,0)
 ;  Check on FTP transfer messages
"RTN","RCXVTSK",126,0)
 D ^RCXVFTR
"RTN","RCXVTSK",127,0)
 ;
"RTN","RCXVTSK",128,0)
 L -^RCXVTSK
"RTN","RCXVTSK",129,0)
EXIT D MSG^RCXVCHK
"RTN","RCXVTSK",130,0)
 K IEN,DIK,DA,RCXVBLN,RCXVBTN,RCSTAT,RCXVBDT,RCXVDMN,RCXVXDT,RCXVTRD
"RTN","RCXVTSK",131,0)
 K RCXVSITE,RCXVFILE,RCXVRN,RCXVRT,RCXVDIR,RCXVATP,RCXVU,DTACT,RBSQ,RBTOT
"RTN","RCXVTSK",132,0)
 K RCFDATE,RCXVCFLG,RCXVDBN,RCXVIDT,RCXVSEQ,RCXVSTOT,RCXVTRD,CCT,DTENT
"RTN","RCXVTSK",133,0)
 K RCBLN,RCDBTR,RCDEBT,RCTRAN,RCXVTR,RCBCN,RCXVPFDT,RCXVPTDT,RCXRMB
"RTN","RCXVTSK",134,0)
 K RCXVLDOM,RCXVARD,RCXVSUB,RCXVBTY,RCXVLEG,RCXVSCR,Y,X,RCXVMO
"RTN","RCXVTSK",135,0)
 K ^TMP("RCXVMSG",$J),^TMP("RCXVA",$J),^TMP("RCXVIN",$J)
"RTN","RCXVTSK",136,0)
 Q
"RTN","RCXVTSK",137,0)
 ;
"RTN","RCXVTSK",138,0)
HIS ;  Historical data extract
"RTN","RCXVTSK",139,0)
 ;
"RTN","RCXVTSK",140,0)
 L +^RCXVTSK:60 E  HANG 600 G HIS
"RTN","RCXVTSK",141,0)
 ;
"RTN","RCXVTSK",142,0)
 I $G(DT)="" D DT^DICRW
"RTN","RCXVTSK",143,0)
 ;
"RTN","RCXVTSK",144,0)
 I $G(RCXVFFD)="" D
"RTN","RCXVTSK",145,0)
 . S RCFDATE=$$FYCY^IBCU8(DT)
"RTN","RCXVTSK",146,0)
 . S RCXVFFD=$P(RCFDATE,U,3),RCXVFTD=$P(RCFDATE,U,4)
"RTN","RCXVTSK",147,0)
 ;
"RTN","RCXVTSK",148,0)
 S RCXVDAT=RCXVFFD-.01
"RTN","RCXVTSK",149,0)
 F  S RCXVDAT=$O(^PRCA(430,"ACTDT",RCXVDAT)) Q:RCXVDAT=""!(RCXVDAT>RCXVFTD)  D
"RTN","RCXVTSK",150,0)
 . S IEN=""
"RTN","RCXVTSK",151,0)
 . F  S IEN=$O(^PRCA(430,"ACTDT",RCXVDAT,IEN)) Q:IEN=""  D
"RTN","RCXVTSK",152,0)
 .. I $P(^PRCA(430,IEN,0),U,8)=16!($P(^PRCA(430,IEN,0),U,8)=40) Q
"RTN","RCXVTSK",153,0)
 .. S RCXVBLN=IEN,DFN=$P(^PRCA(430,IEN,0),U,7)
"RTN","RCXVTSK",154,0)
 .. D FIL^RCXVDEQ("H")
"RTN","RCXVTSK",155,0)
 ;
"RTN","RCXVTSK",156,0)
 L -^RCXVTSK
"RTN","RCXVTSK",157,0)
 ;
"RTN","RCXVTSK",158,0)
 D EN
"RTN","RCXVTSK",159,0)
 K RCXVDAT,RCFDATE,RCXVFFD,RCXVFTD,IEN,DFN,RCXVBLN
"RTN","RCXVTSK",160,0)
 ;
"RTN","RCXVTSK",161,0)
 Q
"RTN","RCXVTSK",162,0)
 ;
"RTN","RCXVTSK",163,0)
CUR ;  Find all current fiscal year bills
"RTN","RCXVTSK",164,0)
 ;
"RTN","RCXVTSK",165,0)
 L +^RCXVTSK:60 E  HANG 600 G CUR
"RTN","RCXVTSK",166,0)
 ;
"RTN","RCXVTSK",167,0)
 S TTYP=""
"RTN","RCXVTSK",168,0)
 F  S TTYP=$O(^PRCA(433,"AT",TTYP)) Q:TTYP=""  D
"RTN","RCXVTSK",169,0)
 . I '+$P(^PRCA(430.3,TTYP,0),U,6) Q
"RTN","RCXVTSK",170,0)
 . S RDATE=RCXVFFD-.01
"RTN","RCXVTSK",171,0)
 . F  S RDATE=$O(^PRCA(433,"AT",TTYP,RDATE)) Q:RDATE=""!(RDATE\1>RCXVFTD)  D
"RTN","RCXVTSK",172,0)
 .. S IEN=""
"RTN","RCXVTSK",173,0)
 .. F  S IEN=$O(^PRCA(433,"AT",TTYP,RDATE,IEN)) Q:IEN=""  D
"RTN","RCXVTSK",174,0)
 ... S RCXVBLN=$P(^PRCA(433,IEN,0),U,2)
"RTN","RCXVTSK",175,0)
 ... I RCXVBLN="" Q
"RTN","RCXVTSK",176,0)
 ... S X=$P($G(^PRCA(430,RCXVBLN,0)),U,8)
"RTN","RCXVTSK",177,0)
 ... I X=16!(X=40) Q
"RTN","RCXVTSK",178,0)
 ... ; Line below changed for patch 228 to do FY05 extract
"RTN","RCXVTSK",179,0)
 ... D FIL^RCXVDEQ("E")
"RTN","RCXVTSK",180,0)
 ;
"RTN","RCXVTSK",181,0)
 L -^RCXVTSK
"RTN","RCXVTSK",182,0)
 ;
"RTN","RCXVTSK",183,0)
 D EN
"RTN","RCXVTSK",184,0)
 K TTYP,RDATE,RCXVFFD,RCXVFTD,RCXVBLN
"RTN","RCXVTSK",185,0)
 Q
"RTN","RCXVTSK",186,0)
 ;
"RTN","RCXVTSK",187,0)
ACT ;  Active data extract
"RTN","RCXVTSK",188,0)
 ;
"RTN","RCXVTSK",189,0)
 L +^RCXVTSK:60 E  HANG 600 G ACT
"RTN","RCXVTSK",190,0)
 ;
"RTN","RCXVTSK",191,0)
 NEW STAT,CSTAT,QFL
"RTN","RCXVTSK",192,0)
 ;  Set up the AR Data Queue for all 'Active' and 'Suspended' bills
"RTN","RCXVTSK",193,0)
 F STAT=16,40 S IEN="" F  S IEN=$O(^PRCA(430,"AC",STAT,IEN)) Q:IEN=""  D
"RTN","RCXVTSK",194,0)
 . S RCXVBLN=IEN,DFN=$P(^PRCA(430,IEN,0),U,7)
"RTN","RCXVTSK",195,0)
 . I $P(^PRCA(430,IEN,0),U,2)="" Q
"RTN","RCXVTSK",196,0)
 . S CSTAT=$P(^PRCA(430,IEN,0),U,8)
"RTN","RCXVTSK",197,0)
 . I CSTAT'=STAT S QFL=0 D  Q:QFL
"RTN","RCXVTSK",198,0)
 .. I CSTAT'=16!(CSTAT'=40) S QFL=1
"RTN","RCXVTSK",199,0)
 . D FIL^RCXVDEQ("A")
"RTN","RCXVTSK",200,0)
 ;
"RTN","RCXVTSK",201,0)
 L -^RCXVTSK
"RTN","RCXVTSK",202,0)
 ;
"RTN","RCXVTSK",203,0)
 D EN
"RTN","RCXVTSK",204,0)
 Q
"RTN","RCXVTSK",205,0)
 ;
"RTN","RCXVTSK",206,0)
ER ; Unlock and log error
"RTN","RCXVTSK",207,0)
 L -^RCXVTSK
"RTN","RCXVTSK",208,0)
 D ^%ZTER
"RTN","RCXVTSK",209,0)
 D UNWIND^%ZTER
"RTN","RCXVTSK",210,0)
 Q
"SEC","^DIC",348.4,348.4,0,"AUDIT")
@
"SEC","^DIC",348.4,348.4,0,"DD")
@
"SEC","^DIC",348.4,348.4,0,"DEL")
@
"SEC","^DIC",348.4,348.4,0,"LAYGO")
@
"SEC","^DIC",348.4,348.4,0,"RD")
@
"SEC","^DIC",348.4,348.4,0,"WR")
@
"VER")
8.0^22.0
"^DD",348.4,348.4,0)
FIELD^^5^15
"^DD",348.4,348.4,0,"DDA")
N
"^DD",348.4,348.4,0,"DT")
3060718
"^DD",348.4,348.4,0,"IX","AC",348.4,.03)

"^DD",348.4,348.4,0,"IX","B",348.4,.01)

"^DD",348.4,348.4,0,"IX","C",348.4,.02)

"^DD",348.4,348.4,0,"NM","AR DATA QUEUE")

"^DD",348.4,348.4,0,"VRPK")
PRCA
"^DD",348.4,348.4,.01,0)
BATCH NUMBER^RNJ9,0^^0;1^K:+X'=X!(X>999999999)!(X<1)!(X?.E1"."1N.N) X
"^DD",348.4,348.4,.01,1,0)
^.1
"^DD",348.4,348.4,.01,1,1,0)
348.4^B
"^DD",348.4,348.4,.01,1,1,1)
S ^RCXV("B",$E(X,1,30),DA)=""
"^DD",348.4,348.4,.01,1,1,2)
K ^RCXV("B",$E(X,1,30),DA)
"^DD",348.4,348.4,.01,3)
Type a Number between 1 and 999999999, 0 Decimal Digits
"^DD",348.4,348.4,.01,21,0)
^^1^1^3030716^
"^DD",348.4,348.4,.01,21,1,0)
The Batch Number is a sequential counter distinguishing each batch of data to be transmitted
"^DD",348.4,348.4,.01,"DT")
3030728
"^DD",348.4,348.4,.02,0)
BATCH DATE^D^^0;2^S %DT="EX" D ^%DT S X=Y K:Y<1 X
"^DD",348.4,348.4,.02,1,0)
^.1
"^DD",348.4,348.4,.02,1,1,0)
348.4^C
"^DD",348.4,348.4,.02,1,1,1)
S ^RCXV("C",$E(X,1,30),DA)=""
"^DD",348.4,348.4,.02,1,1,2)
K ^RCXV("C",$E(X,1,30),DA)
"^DD",348.4,348.4,.02,1,1,"%D",0)
^^1^1^3030728^
"^DD",348.4,348.4,.02,1,1,"%D",1,0)
This cross-reference is used to look up a batch by the batch date.
"^DD",348.4,348.4,.02,1,1,"DT")
3030728
"^DD",348.4,348.4,.02,21,0)
^^1^1^3030716^
"^DD",348.4,348.4,.02,21,1,0)
This field will contain the date for which the batch is generated.
"^DD",348.4,348.4,.02,"DT")
3030728
"^DD",348.4,348.4,.03,0)
STATUS^S^P:PENDING;T:TRANSMITTED;C:COMPLETED;^0;3^Q
"^DD",348.4,348.4,.03,1,0)
^.1
"^DD",348.4,348.4,.03,1,1,0)
348.4^AC
"^DD",348.4,348.4,.03,1,1,1)
S ^RCXV("AC",$E(X,1,30),DA)=""
"^DD",348.4,348.4,.03,1,1,2)
K ^RCXV("AC",$E(X,1,30),DA)
"^DD",348.4,348.4,.03,1,1,"%D",0)
^^1^1^3030724^
"^DD",348.4,348.4,.03,1,1,"%D",1,0)
This cross-reference tells the status of the batch.
"^DD",348.4,348.4,.03,1,1,"DT")
3030724
"^DD",348.4,348.4,.03,21,0)
3^.001^3^3^3030716^
"^DD",348.4,348.4,.03,21,1,0)
This field contains the status of the batch. 'Pending' will indicate that the batch is ready for the nightly process. 'Transmitted' will indicate that the batch has been sent to the Vitria server but no completed acknowledgement has been
"^DD",348.4,348.4,.03,21,2,0)
received. If the batch is still at the status of 'Transmitted' the next night, it will be sent to Vitria. 'Completed' will indicate that the batch has been successfully received and processed on the Vitria server and records may now be 
"^DD",348.4,348.4,.03,21,3,0)
available for purging.
"^DD",348.4,348.4,.03,"DT")
3030724
"^DD",348.4,348.4,.04,0)
BATCH TYPE^S^D:DAILY;H:HISTORICAL;A:ACTIVE;R:DEPOSITS/RECEIPTS;C:CURRENT FY;E:FY 05;P:PRE-REGISTRATION;B:BUFFER;I:IB COPAY;^0;4^Q
"^DD",348.4,348.4,.04,21,0)
^.001^1^1^3060718^^^
"^DD",348.4,348.4,.04,21,1,0)
This field contains the type of data contained in this batch.
"^DD",348.4,348.4,.04,23,0)
^^1^1^3060718^
"^DD",348.4,348.4,.04,23,1,0)
 
"^DD",348.4,348.4,.04,"DT")
3060718
"^DD",348.4,348.4,.05,0)
BATCH SEQUENCE NUMBER^NJ4,0^^0;5^K:+X'=X!(X>9999)!(X<1)!(X?.E1"."1N.N) X
"^DD",348.4,348.4,.05,3)
Type a Number between 1 and 9999, 0 Decimal Digits
"^DD",348.4,348.4,.05,21,0)
^.001^2^2^3031021^^
"^DD",348.4,348.4,.05,21,1,0)
This field contains the sequence number of the batch where there
"^DD",348.4,348.4,.05,21,2,0)
may be more than one batch transmitted in the daily transmission.
"^DD",348.4,348.4,.05,"DT")
3031021
"^DD",348.4,348.4,.06,0)
TOTAL BATCH SEQUENCE NUMBER^NJ4,0^^0;6^K:+X'=X!(X>9999)!(X<1)!(X?.E1"."1N.N) X
"^DD",348.4,348.4,.06,3)
Type a Number between 1 and 9999, 0 Decimal Digits
"^DD",348.4,348.4,.06,21,0)
^.001^2^2^3031021^^
"^DD",348.4,348.4,.06,21,1,0)
This field contains the total number of batches in a daily
"^DD",348.4,348.4,.06,21,2,0)
transmission.
"^DD",348.4,348.4,.06,"DT")
3031021
"^DD",348.4,348.4,.07,0)
NUMBER OF RECORDS^NJ11,0^^0;7^K:+X'=X!(X>99999999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",348.4,348.4,.07,3)
Type a Number between 0 and 99999999999, 0 Decimal Digits
"^DD",348.4,348.4,.07,21,0)
^^1^1^3030716^
"^DD",348.4,348.4,.07,21,1,0)
This field will contain the number of records contained in this batch.
"^DD",348.4,348.4,.07,"DT")
3030716
"^DD",348.4,348.4,.08,0)
ACK RECEIVED DATE/TIME^D^^0;8^S %DT="ESTX" D ^%DT S X=Y K:Y<1 X
"^DD",348.4,348.4,.08,21,0)
^^1^1^3030716^
"^DD",348.4,348.4,.08,21,1,0)
This field will contain the date and time that the successful acknowledgement was received from the Vitria server.
"^DD",348.4,348.4,.08,"DT")
3030716
"^DD",348.4,348.4,.09,0)
ARC ACK RECEIVED DATE/TIME^D^^0;9^S %DT="ESTX" D ^%DT S X=Y K:Y<1 X
"^DD",348.4,348.4,.09,21,0)
^^3^3^3030924^
"^DD",348.4,348.4,.09,21,1,0)
This field contains the date and time that the Boston Allocation
"^DD",348.4,348.4,.09,21,2,0)
Resource Center sent back an acknowledgement that the data was
"^DD",348.4,348.4,.09,21,3,0)
loaded succesfully.
"^DD",348.4,348.4,.09,"DT")
3030924
"^DD",348.4,348.4,.1,0)
COPAY MONTH/YEAR^D^^0;10^S %DT="E" D ^%DT S X=Y K:X<1 X
"^DD",348.4,348.4,.1,3)
Month and year for this transmission
"^DD",348.4,348.4,.1,21,0)
^^2^2^3050822^
"^DD",348.4,348.4,.1,21,1,0)
If this batch is a Co-Pay Transmission, ("I" batch type), this field will 
"^DD",348.4,348.4,.1,21,2,0)
hold the month/year that the transmission is for.
"^DD",348.4,348.4,.1,"DT")
3050822
"^DD",348.4,348.4,1.01,0)
BILL NUMBER^348.41PA^^1;0
"^DD",348.4,348.4,2.01,0)
AR BATCH PAYMENT^348.42P^^2;0
"^DD",348.4,348.4,3.01,0)
COPAY PATIENT^348.43P^^3;0
"^DD",348.4,348.4,4,0)
PRE-REGISTRATION MONTH/YEAR^D^^4;1^S %DT="E" D ^%DT S X=Y K:X<1 X
"^DD",348.4,348.4,4,3)
(No range limit on date)
"^DD",348.4,348.4,4,21,0)
^^2^2^3050822^
"^DD",348.4,348.4,4,21,1,0)
If this batch is a Pre-registration transmission, ("P" batch type), this
"^DD",348.4,348.4,4,21,2,0)
field will hold the month/year that the transmission is for.
"^DD",348.4,348.4,4,"DT")
3050822
"^DD",348.4,348.4,5,0)
INSURANCE BUFFER MONTH/YEAR^D^^5;1^S %DT="E" D ^%DT S X=Y K:X<1 X
"^DD",348.4,348.4,5,3)
(No range limit on date)
"^DD",348.4,348.4,5,21,0)
^^2^2^3050822^
"^DD",348.4,348.4,5,21,1,0)
If this batch is a Buffer file transmission, ("B" batch type), this field
"^DD",348.4,348.4,5,21,2,0)
will hold the month/year that the transmission is for.
"^DD",348.4,348.4,5,"DT")
3050822
"^DD",348.4,348.41,0)
BILL NUMBER SUB-FIELD^^.02^2
"^DD",348.4,348.41,0,"DT")
3030722
"^DD",348.4,348.41,0,"IX","B",348.41,.01)

"^DD",348.4,348.41,0,"NM","BILL NUMBER")

"^DD",348.4,348.41,0,"UP")
348.4
"^DD",348.4,348.41,.01,0)
BILL NUMBER^MP430'X^PRCA(430,^0;1^S X=DINUM
"^DD",348.4,348.41,.01,1,0)
^.1
"^DD",348.4,348.41,.01,1,1,0)
348.41^B
"^DD",348.4,348.41,.01,1,1,1)
S ^RCXV(DA(1),1,"B",$E(X,1,30),DA)=""
"^DD",348.4,348.41,.01,1,1,2)
K ^RCXV(DA(1),1,"B",$E(X,1,30),DA)
"^DD",348.4,348.41,.01,21,0)
^^1^1^3030716^
"^DD",348.4,348.41,.01,21,1,0)
This field will contain the IEN of the bill who was triggered to be processed for this BATCH DATE.  This field will be DINUM'd so there will not be any duplicates.
"^DD",348.4,348.41,.01,"DT")
3030723
"^DD",348.4,348.41,.02,0)
PATIENT^P2'^DPT(^0;2^Q
"^DD",348.4,348.41,.02,21,0)
^^1^1^3030930^
"^DD",348.4,348.41,.02,21,1,0)
This is the patient associated with the bill.
"^DD",348.4,348.41,.02,"DT")
3030722
"^DD",348.4,348.42,0)
AR BATCH PAYMENT SUB-FIELD^^.01^1
"^DD",348.4,348.42,0,"DT")
3031022
"^DD",348.4,348.42,0,"IX","B",348.42,.01)

"^DD",348.4,348.42,0,"NM","AR BATCH PAYMENT")

"^DD",348.4,348.42,0,"UP")
348.4
"^DD",348.4,348.42,.01,0)
AR BATCH PAYMENT^MP344'X^RCY(344,^0;1^S DINUM=X Q
"^DD",348.4,348.42,.01,1,0)
^.1
"^DD",348.4,348.42,.01,1,1,0)
348.42^B
"^DD",348.4,348.42,.01,1,1,1)
S ^RCXV(DA(1),2,"B",$E(X,1,30),DA)=""
"^DD",348.4,348.42,.01,1,1,2)
K ^RCXV(DA(1),2,"B",$E(X,1,30),DA)
"^DD",348.4,348.42,.01,21,0)
^^3^3^3031022^
"^DD",348.4,348.42,.01,21,1,0)
This field will contain any batch payments for a specific date.
"^DD",348.4,348.42,.01,21,2,0)
It will be used to transmit information to the Boston Allocation
"^DD",348.4,348.42,.01,21,3,0)
Resource Center or re-transmit as needed.
"^DD",348.4,348.42,.01,"DT")
3031022
"^DD",348.4,348.43,0)
COPAY PATIENT SUB-FIELD^^.01^1
"^DD",348.4,348.43,0,"DT")
3050504
"^DD",348.4,348.43,0,"IX","B",348.43,.01)

"^DD",348.4,348.43,0,"NM","COPAY PATIENT")

"^DD",348.4,348.43,0,"UP")
348.4
"^DD",348.4,348.43,.01,0)
COPAY PATIENT^P2'X^DPT(^0;1^S X=DINUM
"^DD",348.4,348.43,.01,1,0)
^.1
"^DD",348.4,348.43,.01,1,1,0)
348.43^B
"^DD",348.4,348.43,.01,1,1,1)
S ^RCXV(DA(1),3,"B",$E(X,1,30),DA)=""
"^DD",348.4,348.43,.01,1,1,2)
K ^RCXV(DA(1),3,"B",$E(X,1,30),DA)
"^DD",348.4,348.43,.01,3)
This is the patient's DFN
"^DD",348.4,348.43,.01,21,0)
^^5^5^3050829^
"^DD",348.4,348.43,.01,21,1,0)
If this transmission is a Co-Pay transmission ("P" batch type), this
"^DD",348.4,348.43,.01,21,2,0)
field will contain the IEN of the patient whose data will be transmitted.
"^DD",348.4,348.43,.01,21,3,0)
This field will be DINUMed, so there are no duplicates.
"^DD",348.4,348.43,.01,21,4,0)
 
"^DD",348.4,348.43,.01,21,5,0)
This field is populated from routine RCXVDC10.
"^DD",348.4,348.43,.01,"DT")
3050829
"^DIC",348.4,348.4,0)
AR DATA QUEUE^348.4
"^DIC",348.4,348.4,0,"GL")
^RCXV(
"^DIC",348.4,348.4,"%D",0)
^1.001^4^4^3031022^^
"^DIC",348.4,348.4,"%D",1,0)
This file contains bill entries which based upon certain criteria
"^DIC",348.4,348.4,"%D",2,0)
have been triggered into this file.  These bill entries are used
"^DIC",348.4,348.4,"%D",3,0)
to export data information for CBO to the Boston Allocation
"^DIC",348.4,348.4,"%D",4,0)
Resource Center (ARC).
"^DIC",348.4,"B","AR DATA QUEUE",348.4)

"BLD",6160,6)
^219
**END**
**END**
