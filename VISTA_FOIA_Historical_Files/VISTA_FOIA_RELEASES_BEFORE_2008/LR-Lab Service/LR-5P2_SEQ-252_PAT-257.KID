Released LR*5.2*257 SEQ #252
Extracted from mail message
**KIDS**:LR*5.2*257^

**INSTALL NAME**
LR*5.2*257
"BLD",5703,0)
LR*5.2*257^LAB SERVICE^0^3050610^y
"BLD",5703,1,0)
^^257^257^3050610^^^^
"BLD",5703,1,1,0)
Blood Bank Clearance:
"BLD",5703,1,2,0)
=====================
"BLD",5703,1,3,0)
EFFECT ON BLOOD BANK FUNCTIONAL REQUIREMENTS: Patch LR*5.2*257 does not
"BLD",5703,1,4,0)
contain any changes to the VISTA BLOOD BANK Software as defined by VHA
"BLD",5703,1,5,0)
DIRECTIVE 99-053 titled VISTA BLOOD BANK SOFTWARE VERSION 5.2.
"BLD",5703,1,6,0)

"BLD",5703,1,7,0)
EFFECT ON BLOOD BANK FUNCTIONAL REQUIREMENTS: Patch LR*5.2*257 does not alter
"BLD",5703,1,8,0)
or modify any software design safeguards or safety critical elements
"BLD",5703,1,9,0)
functions.
"BLD",5703,1,10,0)

"BLD",5703,1,11,0)
RISK ANALYSIS: Changes made by patch LR*5.2*257 have no effect on Blood Bank
"BLD",5703,1,12,0)
software functionality, therefore RISK is none.
"BLD",5703,1,13,0)

"BLD",5703,1,14,0)
VALIDATION REQUIREMENTS BY OPTION:  Because of the nature of the changes made,
"BLD",5703,1,15,0)
no specific validation requirements exist as a result of installation of this
"BLD",5703,1,16,0)
patch.
"BLD",5703,1,17,0)

"BLD",5703,1,18,0)
This patch provides the ability to print an Antimicrobial Trend Report by
"BLD",5703,1,19,0)
division.  There are three new additions to the LAB DATA (#63) file-
"BLD",5703,1,20,0)
one new field for the "CH" subscript and two new fields for the "MI" subscript.
"BLD",5703,1,21,0)
These fields will be used to capture the ordering location and institution
"BLD",5703,1,22,0)
during accessioning.  In the MICROBIOLOGY (#63.05) sub-file of the LAB DATA 
"BLD",5703,1,23,0)
(#63) file, the new fields are REQUESTING LOC/DIV (#63.05,.111) and
"BLD",5703,1,24,0)
ACCESSIONING INSTITUTION (#63.05,.112).  In the CHEM, HEM, TOX, RIA, SER,
"BLD",5703,1,25,0)
etc. (#63.04) sub-file of the LAB DATA (#63) file, the new field is
"BLD",5703,1,26,0)
ACCESSIONING INSTITUTION (#63.04,.112).  In the CHEM, HEM, TOX, RIA, SER, etc.
"BLD",5703,1,27,0)
(#63.04) sub-file of the LAB DATA (#63) file, the REQUESTING LOC/DIV
"BLD",5703,1,28,0)
(#63.04,.111) field is modified to remove the screen on INSTITUTION file (#4)
"BLD",5703,1,29,0)
since sites need to be able to point to entries in the INSTITUTION file (#4)
"BLD",5703,1,30,0)
that are not VA facilities such as DoD and commercial/civilian facilities.
"BLD",5703,1,31,0)

"BLD",5703,1,32,0)
ALB-0600-50112/HD0000000069278:
"BLD",5703,1,33,0)
Patch LR*5.2*257 also corrects two typographical errors. The query portion of
"BLD",5703,1,34,0)
the Microbiology Trend Entry routine has two typographical errors. The word
"BLD",5703,1,35,0)
misspelled as susceptability should be susceptibility. Also, the misspelled
"BLD",5703,1,36,0)
word procede should be proceed.
"BLD",5703,1,37,0)

"BLD",5703,1,38,0)
MODIFIED OPTION
"BLD",5703,1,39,0)
===============
"BLD",5703,1,40,0)
NAME: LRMITS                      MENU TEXT: Microbiology Trend Report
"BLD",5703,1,41,0)
  TYPE: run routine
"BLD",5703,1,42,0)
  HELP FRAME: LRMITS OPTION       PACKAGE: LAB SERVICE
"BLD",5703,1,43,0)
DESCRIPTION:  The antimicrobial trend report is used to compare counts of
"BLD",5703,1,44,0)
organisms and patterns of antibiotic susceptibility.  Different types of
"BLD",5703,1,45,0)
reports can be generated.  The types of reports are categorized by: organism,
"BLD",5703,1,46,0)
specimen, collection sample, patient, physician, and location.  Specific
"BLD",5703,1,47,0)
criteria can be applied to all report types.  Criteria include: specific types
"BLD",5703,1,48,0)
of organisms, isolates collected after a specified time from admission, merge
"BLD",5703,1,49,0)
criteria, antibiotic patterns, and detailed reports.  These reports can be
"BLD",5703,1,50,0)
printed by division or selected divisions.
"BLD",5703,1,51,0)
  ROUTINE: LRMITS
"BLD",5703,1,52,0)

"BLD",5703,1,53,0)

"BLD",5703,1,54,0)

"BLD",5703,1,55,0)
DATA DICTIONARY CHANGES:
"BLD",5703,1,56,0)
========================
"BLD",5703,1,57,0)

"BLD",5703,1,58,0)
NEW FIELDS:
"BLD",5703,1,59,0)
===========
"BLD",5703,1,60,0)

"BLD",5703,1,61,0)
In the MICROBIOLOGY (#63.05) sub-file of the LAB DATA (#63) file: 
"BLD",5703,1,62,0)

"BLD",5703,1,63,0)
63.05,.111      REQUESTING LOC/DIV   0;13         VARIABLE POINTER
"BLD",5703,1,64,0)

"BLD",5703,1,65,0)
                FILE  ORDER  PREFIX    LAYGO  MESSAGE
"BLD",5703,1,66,0)
                   44   1    SC(          n   Enter Hospital Location 
"BLD",5703,1,67,0)
                   4    2    DIC(4,       n   Select appropriate Institution 
"BLD",5703,1,68,0)
                                         
"BLD",5703,1,69,0)
                LAST EDITED:    AUG 04, 2004 
"BLD",5703,1,70,0)
                DESCRIPTION:    Enter the hospital location or institution
"BLD",5703,1,71,0)
                                ordering this test.  
"BLD",5703,1,72,0)

"BLD",5703,1,73,0)
63.05,.112    ACCESSIONING INSTITUTION 0;14 POINTER TO INSTITUTION FILE (#4)
"BLD",5703,1,74,0)

"BLD",5703,1,75,0)
              LAST EDITED:      AUG 04, 2004 
"BLD",5703,1,76,0)
              DESCRIPTION:      This field contains the pointer to the
"BLD",5703,1,77,0)
                                institution where the specimen was accessioned.
"BLD",5703,1,78,0)
                                This field can be blank if LEDI or POC specimen 
"BLD",5703,1,79,0)
                                is accessioned. The field will be set if an
"BLD",5703,1,80,0)
                                actual user accepts the specimen.  
"BLD",5703,1,81,0)

"BLD",5703,1,82,0)
In the CHEM, HEM, TOX, RIA, SER, etc. (#63.04) sub-file of the LAB DATA (#63)
"BLD",5703,1,83,0)
file:
"BLD",5703,1,84,0)

"BLD",5703,1,85,0)
63.04,.112    ACCESSIONING INSTITUTION 0;14 POINTER TO INSTITUTION FILE (#4)
"BLD",5703,1,86,0)

"BLD",5703,1,87,0)
              LAST EDITED:      AUG 04, 2004 
"BLD",5703,1,88,0)
              DESCRIPTION:      This field contains the pointer to the
"BLD",5703,1,89,0)
                                institution where the specimen was accessioned.
"BLD",5703,1,90,0)
                                This field can be blank if LEDI or POC specimen 
"BLD",5703,1,91,0)
                                is accessioned. The field will be set if an
"BLD",5703,1,92,0)
                                actual user accepts the specimen.  
"BLD",5703,1,93,0)

"BLD",5703,1,94,0)
 
"BLD",5703,1,95,0)
MODIFIED FIELD:
"BLD",5703,1,96,0)
===============
"BLD",5703,1,97,0)

"BLD",5703,1,98,0)
In the CHEM, HEM, TOX, RIA, SER, etc. (#63.04) sub-file of the LAB DATA (#63)
"BLD",5703,1,99,0)
file:
"BLD",5703,1,100,0)

"BLD",5703,1,101,0)
BEFORE:
"BLD",5703,1,102,0)

"BLD",5703,1,103,0)
63.04,.111      REQUESTING LOC/DIV   0;13         VARIABLE POINTER
"BLD",5703,1,104,0)
 
"BLD",5703,1,105,0)
                FILE  ORDER  PREFIX    LAYGO  MESSAGE
"BLD",5703,1,106,0)
                   44   1    SC(          n   Hospital Location 
"BLD",5703,1,107,0)
                   4    2    DIC(4,       n   Ordering Institution 
"BLD",5703,1,108,0)
                SCREEN ON FILE 4: S DIC("S")="I $G(^DIC(4,Y,99)),$G(^DIC(4,Y,6)
"BLD",5703,1,109,0)
                                )"
"BLD",5703,1,110,0)

"BLD",5703,1,111,0)
                LAST EDITED:    FEB 01, 1997 
"BLD",5703,1,112,0)
                HELP-PROMPT:    Enter the hospital location or institution 
"BLD",5703,1,113,0)
                                ordering this test. 
"BLD",5703,1,114,0)
                DESCRIPTION:    This is the hospital location or institution
"BLD",5703,1,115,0)
                                ordering this test.  
"BLD",5703,1,116,0)

"BLD",5703,1,117,0)
AFTER:
"BLD",5703,1,118,0)

"BLD",5703,1,119,0)
63.04,.111      REQUESTING LOC/DIV   0;13         VARIABLE POINTER
"BLD",5703,1,120,0)

"BLD",5703,1,121,0)
                FILE  ORDER  PREFIX    LAYGO  MESSAGE
"BLD",5703,1,122,0)
                   44   1    SC(          n   Hospital Location 
"BLD",5703,1,123,0)
                   4    2    DIC(4,       n   Ordering Institution 
"BLD",5703,1,124,0)

"BLD",5703,1,125,0)
                LAST EDITED:    FEB 01, 1997 
"BLD",5703,1,126,0)
                HELP-PROMPT:    Enter the hospital location or institution 
"BLD",5703,1,127,0)
                                ordering this test. 
"BLD",5703,1,128,0)
                DESCRIPTION:    This is the hospital location or institution
"BLD",5703,1,129,0)
                                ordering this test.  
"BLD",5703,1,130,0)

"BLD",5703,1,131,0)

"BLD",5703,1,132,0)
Software Retrieval
"BLD",5703,1,133,0)
==================
"BLD",5703,1,134,0)
VistA Laboratory Multidivisional Antimicrobial Trend Report LR*5.2*257 is
"BLD",5703,1,135,0)
distributed by Packman. 
"BLD",5703,1,136,0)

"BLD",5703,1,137,0)

"BLD",5703,1,138,0)
Documentation Retrieval Locations:
"BLD",5703,1,139,0)
==================================
"BLD",5703,1,140,0)
NOTE: All sites are encouraged to use the File Transfer Protocol (FTP)
"BLD",5703,1,141,0)
capability.  Use the FTP address "download.vista.med.va.gov" (without the
"BLD",5703,1,142,0)
quotes) to connect to the first available FTP server where the files are
"BLD",5703,1,143,0)
located.
"BLD",5703,1,144,0)

"BLD",5703,1,145,0)
VistA Laboratory 5.2 User Manual and VistA Laboratory Planning and
"BLD",5703,1,146,0)
Implementation Guide with change pages are available at the following
"BLD",5703,1,147,0)
Office of Information Field Offices (OIFOs) ANONYMOUS.SOFTWARE directories:
"BLD",5703,1,148,0)

"BLD",5703,1,149,0)
  OI FIELD OFFICE          FTP ADDRESS               DIRECTORY
"BLD",5703,1,150,0)
---------------------------------------------------------------
"BLD",5703,1,151,0)
ALBANY                  ftp.fo-albany.med.va.gov   [ANONYMOUS.SOFTWARE]
"BLD",5703,1,152,0)
HINES                   ftp.fo-hines.med.va.gov    [ANONYMOUS.SOFTWARE]
"BLD",5703,1,153,0)
SALT LAKE CITY          ftp.fo-slc.med.va.gov      [ANONYMOUS.SOFTWARE]
"BLD",5703,1,154,0)

"BLD",5703,1,155,0)
Documentation Retrieval Format
"BLD",5703,1,156,0)
==============================
"BLD",5703,1,157,0)
VistA Laboratory 5.2 User Manual and Vista Laboratory 5.2 Planning and
"BLD",5703,1,158,0)
Implementation Guide with change pages are exported in the following
"BLD",5703,1,159,0)
retrieval formats:
"BLD",5703,1,160,0)

"BLD",5703,1,161,0)
       File Names                Contents              Retrieval Formats
"BLD",5703,1,162,0)
-------------------------------------------------------------------------
"BLD",5703,1,163,0)
lab5_2um.doc                 Laboratory 5.2 User Manual    BINARY 
"BLD",5703,1,164,0)

"BLD",5703,1,165,0)

"BLD",5703,1,166,0)
lab5_2pi.doc                 Laboratory 5.2 Planning and   BINARY
"BLD",5703,1,167,0)
                             Implementation Guide
"BLD",5703,1,168,0)

"BLD",5703,1,169,0)

"BLD",5703,1,170,0)
VistA Website Locations:
"BLD",5703,1,171,0)
========================
"BLD",5703,1,172,0)
The Laboratory 5.2 User Manual and Laboratory 5.2 Planning and Implementation
"BLD",5703,1,173,0)
Guide with change pages are accessible at the following locations:
"BLD",5703,1,174,0)

"BLD",5703,1,175,0)
Laboratory Version 5.2 Home Page
"BLD",5703,1,176,0)
---------------------------------
"BLD",5703,1,177,0)
http://vista.med.va.gov/ClinicalSpecialties/lab/
"BLD",5703,1,178,0)

"BLD",5703,1,179,0)
VistA Documentation Library (VDL)
"BLD",5703,1,180,0)
---------------------------------
"BLD",5703,1,181,0)
http://www.va.gov/vdl/
"BLD",5703,1,182,0)

"BLD",5703,1,183,0)

"BLD",5703,1,184,0)

"BLD",5703,1,185,0)
Related NOIS/Remedy: 
"BLD",5703,1,186,0)
====================
"BLD",5703,1,187,0)
 FGH-0200-31523/HD0000000069224
"BLD",5703,1,188,0)
 ALB-0600-50112/HD0000000069278
"BLD",5703,1,189,0)

"BLD",5703,1,190,0)

"BLD",5703,1,191,0)
E3RS:
"BLD",5703,1,192,0)
=====
"BLD",5703,1,193,0)
 11438
"BLD",5703,1,194,0)

"BLD",5703,1,195,0)
Test Sites:
"BLD",5703,1,196,0)
===========
"BLD",5703,1,197,0)
 Durham, NC
"BLD",5703,1,198,0)
 Gainesville, FL
"BLD",5703,1,199,0)
 VA Boston Healthcare System
"BLD",5703,1,200,0)

"BLD",5703,1,201,0)

"BLD",5703,1,202,0)
ROUTINE SUMMARY:
"BLD",5703,1,203,0)
================
"BLD",5703,1,204,0)
The following is a list of the routine(s) included in this patch.  The
"BLD",5703,1,205,0)
second line of each of these routine(s) will look like:
"BLD",5703,1,206,0)

"BLD",5703,1,207,0)
   <tab>;;5.2;LAB SERVICE;**[patch list]**;Sep 27, 1994
"BLD",5703,1,208,0)

"BLD",5703,1,209,0)
                          CHECK^XTSUMBLD results
"BLD",5703,1,210,0)
Routine name    Before Patch          After Patch          Patch List
"BLD",5703,1,211,0)
============    ============          ===========          ==========
"BLD",5703,1,212,0)
LR257              NONE                 2442358               257(Deleted by
"BLD",5703,1,213,0)
                                                                  KIDS) 
"BLD",5703,1,214,0)
LRMITSE          6478419                8737276              96,257
"BLD",5703,1,215,0)
LRMITSES         7787667                7819718              96,257
"BLD",5703,1,216,0)
LRMITSPE         6091299                7314510              96,257
"BLD",5703,1,217,0)
LRMITSPS         3052409                3271788               257
"BLD",5703,1,218,0)
LRMITSR          11570196               11570170             96,257
"BLD",5703,1,219,0)
LRMITSRH         2059425                2320614               257
"BLD",5703,1,220,0)

"BLD",5703,1,221,0)

"BLD",5703,1,222,0)
INSTALLATION INSTRUCTIONS
"BLD",5703,1,223,0)
=========================
"BLD",5703,1,224,0)
  The install time for this patch is less than 5 minutes.  This patch
"BLD",5703,1,225,0)
  can be installed when Laboratory users are on the system.
"BLD",5703,1,226,0)
  Suggested time to install:  non-peak requirement hours.
"BLD",5703,1,227,0)

"BLD",5703,1,228,0)
      Patch installation needs to be coordinated with the Laboratory
"BLD",5703,1,229,0)
      Information Manager (LIM/ADPAC).
"BLD",5703,1,230,0)

"BLD",5703,1,231,0)
  1.  If any of the above routines are mapped, disable mapping for them.
"BLD",5703,1,232,0)

"BLD",5703,1,233,0)
  2.  Use the 'INSTALL/CHECK MESSAGE' option of the PackMan menu.  This
"BLD",5703,1,234,0)
      option will load the KIDS patch onto your system.
"BLD",5703,1,235,0)

"BLD",5703,1,236,0)
  3.  On the 'Kernel Installation & Distribution System' Menu (KIDS),
"BLD",5703,1,237,0)
      select the 'Installation ' menu.
"BLD",5703,1,238,0)

"BLD",5703,1,239,0)
  4.  Use the 'Verify Checksum in Transport Global' option and verify that
"BLD",5703,1,240,0)
      all routines have the correct checksums.
"BLD",5703,1,241,0)

"BLD",5703,1,242,0)
  5.  On the KIDS menu, under the 'Installation' menu, use the following
"BLD",5703,1,243,0)
      options:
"BLD",5703,1,244,0)
        Print Transport Global
"BLD",5703,1,245,0)
        Compare Transport Global to Current System
"BLD",5703,1,246,0)
        Backup a Transport Global
"BLD",5703,1,247,0)

"BLD",5703,1,248,0)
  6.  Use the 'Install Package(s)' option under the 'Installation' menu
"BLD",5703,1,249,0)
      and select the package 'LR*5.2*257'.  When prompted 'Want KIDS to
"BLD",5703,1,250,0)
      INHIBIT LOGONS during the install? YES//', choose 'NO'.  When prompted
"BLD",5703,1,251,0)
      'Want to DISABLE Scheduled Options, Menu Options, and Protocols?
"BLD",5703,1,252,0)
      YES//', choose 'NO'.  When prompted 'Want KIDS to Rebuild Menu Trees
"BLD",5703,1,253,0)
      Upon Completion of Install? YES//"', choose 'NO'.
"BLD",5703,1,254,0)

"BLD",5703,1,255,0)
  7.  On a mapped system, rebuild your map set.
"BLD",5703,1,256,0)

"BLD",5703,1,257,0)
NOTE:  Routine LR257 will be deleted after successful patch installation.
"BLD",5703,4,0)
^9.64PA^63^1
"BLD",5703,4,63,0)
63
"BLD",5703,4,63,2,0)
^9.641^63.05^2
"BLD",5703,4,63,2,63.04,0)
CHEM, HEM, TOX, RIA, SER, etc.  (sub-file)
"BLD",5703,4,63,2,63.04,1,0)
^9.6411^.112^2
"BLD",5703,4,63,2,63.04,1,.111,0)
REQUESTING LOC/DIV
"BLD",5703,4,63,2,63.04,1,.112,0)
ACCESSIONING INSTITUTION
"BLD",5703,4,63,2,63.05,0)
MICROBIOLOGY  (sub-file)
"BLD",5703,4,63,2,63.05,1,0)
^9.6411^.112^2
"BLD",5703,4,63,2,63.05,1,.111,0)
REQUESTING LOC/DIV
"BLD",5703,4,63,2,63.05,1,.112,0)
ACCESSIONING INSTITUTION
"BLD",5703,4,63,222)
y^n^p^^^^n^^n
"BLD",5703,4,63,224)

"BLD",5703,4,"APDD",63,63.04)

"BLD",5703,4,"APDD",63,63.04,.111)

"BLD",5703,4,"APDD",63,63.04,.112)

"BLD",5703,4,"APDD",63,63.05)

"BLD",5703,4,"APDD",63,63.05,.111)

"BLD",5703,4,"APDD",63,63.05,.112)

"BLD",5703,4,"B",63,63)

"BLD",5703,"INID")
y
"BLD",5703,"KRN",0)
^9.67PA^8989.52^19
"BLD",5703,"KRN",.4,0)
.4
"BLD",5703,"KRN",.401,0)
.401
"BLD",5703,"KRN",.402,0)
.402
"BLD",5703,"KRN",.403,0)
.403
"BLD",5703,"KRN",.5,0)
.5
"BLD",5703,"KRN",.84,0)
.84
"BLD",5703,"KRN",3.6,0)
3.6
"BLD",5703,"KRN",3.8,0)
3.8
"BLD",5703,"KRN",9.2,0)
9.2
"BLD",5703,"KRN",9.8,0)
9.8
"BLD",5703,"KRN",9.8,"NM",0)
^9.68A^6^6
"BLD",5703,"KRN",9.8,"NM",1,0)
LRMITSE^^0^B26817058
"BLD",5703,"KRN",9.8,"NM",2,0)
LRMITSES^^0^B11205096
"BLD",5703,"KRN",9.8,"NM",3,0)
LRMITSPE^^0^B14156680
"BLD",5703,"KRN",9.8,"NM",4,0)
LRMITSPS^^0^B5049655
"BLD",5703,"KRN",9.8,"NM",5,0)
LRMITSR^^0^B20538738
"BLD",5703,"KRN",9.8,"NM",6,0)
LRMITSRH^^0^B2990572
"BLD",5703,"KRN",9.8,"NM","B","LRMITSE",1)

"BLD",5703,"KRN",9.8,"NM","B","LRMITSES",2)

"BLD",5703,"KRN",9.8,"NM","B","LRMITSPE",3)

"BLD",5703,"KRN",9.8,"NM","B","LRMITSPS",4)

"BLD",5703,"KRN",9.8,"NM","B","LRMITSR",5)

"BLD",5703,"KRN",9.8,"NM","B","LRMITSRH",6)

"BLD",5703,"KRN",19,0)
19
"BLD",5703,"KRN",19,"NM",0)
^9.68A^1^1
"BLD",5703,"KRN",19,"NM",1,0)
LRMITS^^0
"BLD",5703,"KRN",19,"NM","B","LRMITS",1)

"BLD",5703,"KRN",19.1,0)
19.1
"BLD",5703,"KRN",19.1,"NM",0)
^9.68A^^
"BLD",5703,"KRN",101,0)
101
"BLD",5703,"KRN",409.61,0)
409.61
"BLD",5703,"KRN",771,0)
771
"BLD",5703,"KRN",870,0)
870
"BLD",5703,"KRN",8989.51,0)
8989.51
"BLD",5703,"KRN",8989.52,0)
8989.52
"BLD",5703,"KRN",8994,0)
8994
"BLD",5703,"KRN","B",.4,.4)

"BLD",5703,"KRN","B",.401,.401)

"BLD",5703,"KRN","B",.402,.402)

"BLD",5703,"KRN","B",.403,.403)

"BLD",5703,"KRN","B",.5,.5)

"BLD",5703,"KRN","B",.84,.84)

"BLD",5703,"KRN","B",3.6,3.6)

"BLD",5703,"KRN","B",3.8,3.8)

"BLD",5703,"KRN","B",9.2,9.2)

"BLD",5703,"KRN","B",9.8,9.8)

"BLD",5703,"KRN","B",19,19)

"BLD",5703,"KRN","B",19.1,19.1)

"BLD",5703,"KRN","B",101,101)

"BLD",5703,"KRN","B",409.61,409.61)

"BLD",5703,"KRN","B",771,771)

"BLD",5703,"KRN","B",870,870)

"BLD",5703,"KRN","B",8989.51,8989.51)

"BLD",5703,"KRN","B",8989.52,8989.52)

"BLD",5703,"KRN","B",8994,8994)

"BLD",5703,"PRE")
LR257
"BLD",5703,"QUES",0)
^9.62^^
"BLD",5703,"REQB",0)
^9.611^^
"FIA",63)
LAB DATA
"FIA",63,0)
^LR(
"FIA",63,0,0)
63
"FIA",63,0,1)
y^n^p^^^^n^^n
"FIA",63,0,10)

"FIA",63,0,11)

"FIA",63,0,"RLRO")

"FIA",63,0,"VR")
5.2^LR
"FIA",63,63)
1
"FIA",63,63.04)
1
"FIA",63,63.04,.111)

"FIA",63,63.04,.112)

"FIA",63,63.05)
1
"FIA",63,63.05,.111)

"FIA",63,63.05,.112)

"KRN",19,8050,-1)
0^1
"KRN",19,8050,0)
LRMITS^Microbiology Trend Report^^R^^^LRMITS OPTION^^^^^LAB SERVICE
"KRN",19,8050,1,0)
^19.06^8^8^3050511^^^^
"KRN",19,8050,1,1,0)
The antimicrobial trend report is used to compare counts of organisms and
"KRN",19,8050,1,2,0)
patterns of antibiotic susceptibility.  Different types of reports can
"KRN",19,8050,1,3,0)
be generated.  The types of reports are categorized by: organism, specimen,
"KRN",19,8050,1,4,0)
collection sample, patient, physician, and location.  Specific criteria
"KRN",19,8050,1,5,0)
can be applied to all report types.  Criteria include: specific types
"KRN",19,8050,1,6,0)
of organisms, isolates collected after a specified time from admission,
"KRN",19,8050,1,7,0)
merge criteria, antibiotic patterns, and detailed reports.  These reports
"KRN",19,8050,1,8,0)
can be printed by division or for selected divisions.
"KRN",19,8050,25)
LRMITS
"KRN",19,8050,99)
55431,33599
"KRN",19,8050,"U")
MICROBIOLOGY TREND REPORT
"MBREQ")
0
"ORD",18,19)
19;18;;;OPT^XPDTA;OPTF1^XPDIA;OPTE1^XPDIA;OPTF2^XPDIA;;OPTDEL^XPDIA
"ORD",18,19,0)
OPTION
"PKG",26,-1)
1^1
"PKG",26,0)
LAB SERVICE^LR^CORE LAB SYSTEM
"PKG",26,20,0)
^9.402P^1^1
"PKG",26,20,1,0)
2^^LRXDRPT
"PKG",26,20,1,1)

"PKG",26,20,"B",2,1)

"PKG",26,22,0)
^9.49I^1^1
"PKG",26,22,1,0)
5.2^2940927^2941128
"PKG",26,22,1,"PAH",1,0)
257^3050610^6473
"PKG",26,22,1,"PAH",1,1,0)
^^257^257^3050610
"PKG",26,22,1,"PAH",1,1,1,0)
Blood Bank Clearance:
"PKG",26,22,1,"PAH",1,1,2,0)
=====================
"PKG",26,22,1,"PAH",1,1,3,0)
EFFECT ON BLOOD BANK FUNCTIONAL REQUIREMENTS: Patch LR*5.2*257 does not
"PKG",26,22,1,"PAH",1,1,4,0)
contain any changes to the VISTA BLOOD BANK Software as defined by VHA
"PKG",26,22,1,"PAH",1,1,5,0)
DIRECTIVE 99-053 titled VISTA BLOOD BANK SOFTWARE VERSION 5.2.
"PKG",26,22,1,"PAH",1,1,6,0)

"PKG",26,22,1,"PAH",1,1,7,0)
EFFECT ON BLOOD BANK FUNCTIONAL REQUIREMENTS: Patch LR*5.2*257 does not alter
"PKG",26,22,1,"PAH",1,1,8,0)
or modify any software design safeguards or safety critical elements
"PKG",26,22,1,"PAH",1,1,9,0)
functions.
"PKG",26,22,1,"PAH",1,1,10,0)

"PKG",26,22,1,"PAH",1,1,11,0)
RISK ANALYSIS: Changes made by patch LR*5.2*257 have no effect on Blood Bank
"PKG",26,22,1,"PAH",1,1,12,0)
software functionality, therefore RISK is none.
"PKG",26,22,1,"PAH",1,1,13,0)

"PKG",26,22,1,"PAH",1,1,14,0)
VALIDATION REQUIREMENTS BY OPTION:  Because of the nature of the changes made,
"PKG",26,22,1,"PAH",1,1,15,0)
no specific validation requirements exist as a result of installation of this
"PKG",26,22,1,"PAH",1,1,16,0)
patch.
"PKG",26,22,1,"PAH",1,1,17,0)

"PKG",26,22,1,"PAH",1,1,18,0)
This patch provides the ability to print an Antimicrobial Trend Report by
"PKG",26,22,1,"PAH",1,1,19,0)
division.  There are three new additions to the LAB DATA (#63) file-
"PKG",26,22,1,"PAH",1,1,20,0)
one new field for the "CH" subscript and two new fields for the "MI" subscript.
"PKG",26,22,1,"PAH",1,1,21,0)
These fields will be used to capture the ordering location and institution
"PKG",26,22,1,"PAH",1,1,22,0)
during accessioning.  In the MICROBIOLOGY (#63.05) sub-file of the LAB DATA 
"PKG",26,22,1,"PAH",1,1,23,0)
(#63) file, the new fields are REQUESTING LOC/DIV (#63.05,.111) and
"PKG",26,22,1,"PAH",1,1,24,0)
ACCESSIONING INSTITUTION (#63.05,.112).  In the CHEM, HEM, TOX, RIA, SER,
"PKG",26,22,1,"PAH",1,1,25,0)
etc. (#63.04) sub-file of the LAB DATA (#63) file, the new field is
"PKG",26,22,1,"PAH",1,1,26,0)
ACCESSIONING INSTITUTION (#63.04,.112).  In the CHEM, HEM, TOX, RIA, SER, etc.
"PKG",26,22,1,"PAH",1,1,27,0)
(#63.04) sub-file of the LAB DATA (#63) file, the REQUESTING LOC/DIV
"PKG",26,22,1,"PAH",1,1,28,0)
(#63.04,.111) field is modified to remove the screen on INSTITUTION file (#4)
"PKG",26,22,1,"PAH",1,1,29,0)
since sites need to be able to point to entries in the INSTITUTION file (#4)
"PKG",26,22,1,"PAH",1,1,30,0)
that are not VA facilities such as DoD and commercial/civilian facilities.
"PKG",26,22,1,"PAH",1,1,31,0)

"PKG",26,22,1,"PAH",1,1,32,0)
ALB-0600-50112/HD0000000069278:
"PKG",26,22,1,"PAH",1,1,33,0)
Patch LR*5.2*257 also corrects two typographical errors. The query portion of
"PKG",26,22,1,"PAH",1,1,34,0)
the Microbiology Trend Entry routine has two typographical errors. The word
"PKG",26,22,1,"PAH",1,1,35,0)
misspelled as susceptability should be susceptibility. Also, the misspelled
"PKG",26,22,1,"PAH",1,1,36,0)
word procede should be proceed.
"PKG",26,22,1,"PAH",1,1,37,0)

"PKG",26,22,1,"PAH",1,1,38,0)
MODIFIED OPTION
"PKG",26,22,1,"PAH",1,1,39,0)
===============
"PKG",26,22,1,"PAH",1,1,40,0)
NAME: LRMITS                      MENU TEXT: Microbiology Trend Report
"PKG",26,22,1,"PAH",1,1,41,0)
  TYPE: run routine
"PKG",26,22,1,"PAH",1,1,42,0)
  HELP FRAME: LRMITS OPTION       PACKAGE: LAB SERVICE
"PKG",26,22,1,"PAH",1,1,43,0)
DESCRIPTION:  The antimicrobial trend report is used to compare counts of
"PKG",26,22,1,"PAH",1,1,44,0)
organisms and patterns of antibiotic susceptibility.  Different types of
"PKG",26,22,1,"PAH",1,1,45,0)
reports can be generated.  The types of reports are categorized by: organism,
"PKG",26,22,1,"PAH",1,1,46,0)
specimen, collection sample, patient, physician, and location.  Specific
"PKG",26,22,1,"PAH",1,1,47,0)
criteria can be applied to all report types.  Criteria include: specific types
"PKG",26,22,1,"PAH",1,1,48,0)
of organisms, isolates collected after a specified time from admission, merge
"PKG",26,22,1,"PAH",1,1,49,0)
criteria, antibiotic patterns, and detailed reports.  These reports can be
"PKG",26,22,1,"PAH",1,1,50,0)
printed by division or selected divisions.
"PKG",26,22,1,"PAH",1,1,51,0)
  ROUTINE: LRMITS
"PKG",26,22,1,"PAH",1,1,52,0)

"PKG",26,22,1,"PAH",1,1,53,0)

"PKG",26,22,1,"PAH",1,1,54,0)

"PKG",26,22,1,"PAH",1,1,55,0)
DATA DICTIONARY CHANGES:
"PKG",26,22,1,"PAH",1,1,56,0)
========================
"PKG",26,22,1,"PAH",1,1,57,0)

"PKG",26,22,1,"PAH",1,1,58,0)
NEW FIELDS:
"PKG",26,22,1,"PAH",1,1,59,0)
===========
"PKG",26,22,1,"PAH",1,1,60,0)

"PKG",26,22,1,"PAH",1,1,61,0)
In the MICROBIOLOGY (#63.05) sub-file of the LAB DATA (#63) file: 
"PKG",26,22,1,"PAH",1,1,62,0)

"PKG",26,22,1,"PAH",1,1,63,0)
63.05,.111      REQUESTING LOC/DIV   0;13         VARIABLE POINTER
"PKG",26,22,1,"PAH",1,1,64,0)

"PKG",26,22,1,"PAH",1,1,65,0)
                FILE  ORDER  PREFIX    LAYGO  MESSAGE
"PKG",26,22,1,"PAH",1,1,66,0)
                   44   1    SC(          n   Enter Hospital Location 
"PKG",26,22,1,"PAH",1,1,67,0)
                   4    2    DIC(4,       n   Select appropriate Institution 
"PKG",26,22,1,"PAH",1,1,68,0)
                                         
"PKG",26,22,1,"PAH",1,1,69,0)
                LAST EDITED:    AUG 04, 2004 
"PKG",26,22,1,"PAH",1,1,70,0)
                DESCRIPTION:    Enter the hospital location or institution
"PKG",26,22,1,"PAH",1,1,71,0)
                                ordering this test.  
"PKG",26,22,1,"PAH",1,1,72,0)

"PKG",26,22,1,"PAH",1,1,73,0)
63.05,.112    ACCESSIONING INSTITUTION 0;14 POINTER TO INSTITUTION FILE (#4)
"PKG",26,22,1,"PAH",1,1,74,0)

"PKG",26,22,1,"PAH",1,1,75,0)
              LAST EDITED:      AUG 04, 2004 
"PKG",26,22,1,"PAH",1,1,76,0)
              DESCRIPTION:      This field contains the pointer to the
"PKG",26,22,1,"PAH",1,1,77,0)
                                institution where the specimen was accessioned.
"PKG",26,22,1,"PAH",1,1,78,0)
                                This field can be blank if LEDI or POC specimen 
"PKG",26,22,1,"PAH",1,1,79,0)
                                is accessioned. The field will be set if an
"PKG",26,22,1,"PAH",1,1,80,0)
                                actual user accepts the specimen.  
"PKG",26,22,1,"PAH",1,1,81,0)

"PKG",26,22,1,"PAH",1,1,82,0)
In the CHEM, HEM, TOX, RIA, SER, etc. (#63.04) sub-file of the LAB DATA (#63)
"PKG",26,22,1,"PAH",1,1,83,0)
file:
"PKG",26,22,1,"PAH",1,1,84,0)

"PKG",26,22,1,"PAH",1,1,85,0)
63.04,.112    ACCESSIONING INSTITUTION 0;14 POINTER TO INSTITUTION FILE (#4)
"PKG",26,22,1,"PAH",1,1,86,0)

"PKG",26,22,1,"PAH",1,1,87,0)
              LAST EDITED:      AUG 04, 2004 
"PKG",26,22,1,"PAH",1,1,88,0)
              DESCRIPTION:      This field contains the pointer to the
"PKG",26,22,1,"PAH",1,1,89,0)
                                institution where the specimen was accessioned.
"PKG",26,22,1,"PAH",1,1,90,0)
                                This field can be blank if LEDI or POC specimen 
"PKG",26,22,1,"PAH",1,1,91,0)
                                is accessioned. The field will be set if an
"PKG",26,22,1,"PAH",1,1,92,0)
                                actual user accepts the specimen.  
"PKG",26,22,1,"PAH",1,1,93,0)

"PKG",26,22,1,"PAH",1,1,94,0)
 
"PKG",26,22,1,"PAH",1,1,95,0)
MODIFIED FIELD:
"PKG",26,22,1,"PAH",1,1,96,0)
===============
"PKG",26,22,1,"PAH",1,1,97,0)

"PKG",26,22,1,"PAH",1,1,98,0)
In the CHEM, HEM, TOX, RIA, SER, etc. (#63.04) sub-file of the LAB DATA (#63)
"PKG",26,22,1,"PAH",1,1,99,0)
file:
"PKG",26,22,1,"PAH",1,1,100,0)

"PKG",26,22,1,"PAH",1,1,101,0)
BEFORE:
"PKG",26,22,1,"PAH",1,1,102,0)

"PKG",26,22,1,"PAH",1,1,103,0)
63.04,.111      REQUESTING LOC/DIV   0;13         VARIABLE POINTER
"PKG",26,22,1,"PAH",1,1,104,0)
 
"PKG",26,22,1,"PAH",1,1,105,0)
                FILE  ORDER  PREFIX    LAYGO  MESSAGE
"PKG",26,22,1,"PAH",1,1,106,0)
                   44   1    SC(          n   Hospital Location 
"PKG",26,22,1,"PAH",1,1,107,0)
                   4    2    DIC(4,       n   Ordering Institution 
"PKG",26,22,1,"PAH",1,1,108,0)
                SCREEN ON FILE 4: S DIC("S")="I $G(^DIC(4,Y,99)),$G(^DIC(4,Y,6)
"PKG",26,22,1,"PAH",1,1,109,0)
                                )"
"PKG",26,22,1,"PAH",1,1,110,0)

"PKG",26,22,1,"PAH",1,1,111,0)
                LAST EDITED:    FEB 01, 1997 
"PKG",26,22,1,"PAH",1,1,112,0)
                HELP-PROMPT:    Enter the hospital location or institution 
"PKG",26,22,1,"PAH",1,1,113,0)
                                ordering this test. 
"PKG",26,22,1,"PAH",1,1,114,0)
                DESCRIPTION:    This is the hospital location or institution
"PKG",26,22,1,"PAH",1,1,115,0)
                                ordering this test.  
"PKG",26,22,1,"PAH",1,1,116,0)

"PKG",26,22,1,"PAH",1,1,117,0)
AFTER:
"PKG",26,22,1,"PAH",1,1,118,0)

"PKG",26,22,1,"PAH",1,1,119,0)
63.04,.111      REQUESTING LOC/DIV   0;13         VARIABLE POINTER
"PKG",26,22,1,"PAH",1,1,120,0)

"PKG",26,22,1,"PAH",1,1,121,0)
                FILE  ORDER  PREFIX    LAYGO  MESSAGE
"PKG",26,22,1,"PAH",1,1,122,0)
                   44   1    SC(          n   Hospital Location 
"PKG",26,22,1,"PAH",1,1,123,0)
                   4    2    DIC(4,       n   Ordering Institution 
"PKG",26,22,1,"PAH",1,1,124,0)

"PKG",26,22,1,"PAH",1,1,125,0)
                LAST EDITED:    FEB 01, 1997 
"PKG",26,22,1,"PAH",1,1,126,0)
                HELP-PROMPT:    Enter the hospital location or institution 
"PKG",26,22,1,"PAH",1,1,127,0)
                                ordering this test. 
"PKG",26,22,1,"PAH",1,1,128,0)
                DESCRIPTION:    This is the hospital location or institution
"PKG",26,22,1,"PAH",1,1,129,0)
                                ordering this test.  
"PKG",26,22,1,"PAH",1,1,130,0)

"PKG",26,22,1,"PAH",1,1,131,0)

"PKG",26,22,1,"PAH",1,1,132,0)
Software Retrieval
"PKG",26,22,1,"PAH",1,1,133,0)
==================
"PKG",26,22,1,"PAH",1,1,134,0)
VistA Laboratory Multidivisional Antimicrobial Trend Report LR*5.2*257 is
"PKG",26,22,1,"PAH",1,1,135,0)
distributed by Packman. 
"PKG",26,22,1,"PAH",1,1,136,0)

"PKG",26,22,1,"PAH",1,1,137,0)

"PKG",26,22,1,"PAH",1,1,138,0)
Documentation Retrieval Locations:
"PKG",26,22,1,"PAH",1,1,139,0)
==================================
"PKG",26,22,1,"PAH",1,1,140,0)
NOTE: All sites are encouraged to use the File Transfer Protocol (FTP)
"PKG",26,22,1,"PAH",1,1,141,0)
capability.  Use the FTP address "download.vista.med.va.gov" (without the
"PKG",26,22,1,"PAH",1,1,142,0)
quotes) to connect to the first available FTP server where the files are
"PKG",26,22,1,"PAH",1,1,143,0)
located.
"PKG",26,22,1,"PAH",1,1,144,0)

"PKG",26,22,1,"PAH",1,1,145,0)
VistA Laboratory 5.2 User Manual and VistA Laboratory Planning and
"PKG",26,22,1,"PAH",1,1,146,0)
Implementation Guide with change pages are available at the following
"PKG",26,22,1,"PAH",1,1,147,0)
Office of Information Field Offices (OIFOs) ANONYMOUS.SOFTWARE directories:
"PKG",26,22,1,"PAH",1,1,148,0)

"PKG",26,22,1,"PAH",1,1,149,0)
  OI FIELD OFFICE          FTP ADDRESS               DIRECTORY
"PKG",26,22,1,"PAH",1,1,150,0)
---------------------------------------------------------------
"PKG",26,22,1,"PAH",1,1,151,0)
ALBANY                  ftp.fo-albany.med.va.gov   [ANONYMOUS.SOFTWARE]
"PKG",26,22,1,"PAH",1,1,152,0)
HINES                   ftp.fo-hines.med.va.gov    [ANONYMOUS.SOFTWARE]
"PKG",26,22,1,"PAH",1,1,153,0)
SALT LAKE CITY          ftp.fo-slc.med.va.gov      [ANONYMOUS.SOFTWARE]
"PKG",26,22,1,"PAH",1,1,154,0)

"PKG",26,22,1,"PAH",1,1,155,0)
Documentation Retrieval Format
"PKG",26,22,1,"PAH",1,1,156,0)
==============================
"PKG",26,22,1,"PAH",1,1,157,0)
VistA Laboratory 5.2 User Manual and Vista Laboratory 5.2 Planning and
"PKG",26,22,1,"PAH",1,1,158,0)
Implementation Guide with change pages are exported in the following
"PKG",26,22,1,"PAH",1,1,159,0)
retrieval formats:
"PKG",26,22,1,"PAH",1,1,160,0)

"PKG",26,22,1,"PAH",1,1,161,0)
       File Names                Contents              Retrieval Formats
"PKG",26,22,1,"PAH",1,1,162,0)
-------------------------------------------------------------------------
"PKG",26,22,1,"PAH",1,1,163,0)
lab5_2um.doc                 Laboratory 5.2 User Manual    BINARY 
"PKG",26,22,1,"PAH",1,1,164,0)

"PKG",26,22,1,"PAH",1,1,165,0)

"PKG",26,22,1,"PAH",1,1,166,0)
lab5_2pi.doc                 Laboratory 5.2 Planning and   BINARY
"PKG",26,22,1,"PAH",1,1,167,0)
                             Implementation Guide
"PKG",26,22,1,"PAH",1,1,168,0)

"PKG",26,22,1,"PAH",1,1,169,0)

"PKG",26,22,1,"PAH",1,1,170,0)
VistA Website Locations:
"PKG",26,22,1,"PAH",1,1,171,0)
========================
"PKG",26,22,1,"PAH",1,1,172,0)
The Laboratory 5.2 User Manual and Laboratory 5.2 Planning and Implementation
"PKG",26,22,1,"PAH",1,1,173,0)
Guide with change pages are accessible at the following locations:
"PKG",26,22,1,"PAH",1,1,174,0)

"PKG",26,22,1,"PAH",1,1,175,0)
Laboratory Version 5.2 Home Page
"PKG",26,22,1,"PAH",1,1,176,0)
---------------------------------
"PKG",26,22,1,"PAH",1,1,177,0)
http://vista.med.va.gov/ClinicalSpecialties/lab/
"PKG",26,22,1,"PAH",1,1,178,0)

"PKG",26,22,1,"PAH",1,1,179,0)
VistA Documentation Library (VDL)
"PKG",26,22,1,"PAH",1,1,180,0)
---------------------------------
"PKG",26,22,1,"PAH",1,1,181,0)
http://www.va.gov/vdl/
"PKG",26,22,1,"PAH",1,1,182,0)

"PKG",26,22,1,"PAH",1,1,183,0)

"PKG",26,22,1,"PAH",1,1,184,0)

"PKG",26,22,1,"PAH",1,1,185,0)
Related NOIS/Remedy: 
"PKG",26,22,1,"PAH",1,1,186,0)
====================
"PKG",26,22,1,"PAH",1,1,187,0)
 FGH-0200-31523/HD0000000069224
"PKG",26,22,1,"PAH",1,1,188,0)
 ALB-0600-50112/HD0000000069278
"PKG",26,22,1,"PAH",1,1,189,0)

"PKG",26,22,1,"PAH",1,1,190,0)

"PKG",26,22,1,"PAH",1,1,191,0)
E3RS:
"PKG",26,22,1,"PAH",1,1,192,0)
=====
"PKG",26,22,1,"PAH",1,1,193,0)
 11438
"PKG",26,22,1,"PAH",1,1,194,0)

"PKG",26,22,1,"PAH",1,1,195,0)
Test Sites:
"PKG",26,22,1,"PAH",1,1,196,0)
===========
"PKG",26,22,1,"PAH",1,1,197,0)
 Durham, NC
"PKG",26,22,1,"PAH",1,1,198,0)
 Gainesville, FL
"PKG",26,22,1,"PAH",1,1,199,0)
 VA Boston Healthcare System
"PKG",26,22,1,"PAH",1,1,200,0)

"PKG",26,22,1,"PAH",1,1,201,0)

"PKG",26,22,1,"PAH",1,1,202,0)
ROUTINE SUMMARY:
"PKG",26,22,1,"PAH",1,1,203,0)
================
"PKG",26,22,1,"PAH",1,1,204,0)
The following is a list of the routine(s) included in this patch.  The
"PKG",26,22,1,"PAH",1,1,205,0)
second line of each of these routine(s) will look like:
"PKG",26,22,1,"PAH",1,1,206,0)

"PKG",26,22,1,"PAH",1,1,207,0)
   <tab>;;5.2;LAB SERVICE;**[patch list]**;Sep 27, 1994
"PKG",26,22,1,"PAH",1,1,208,0)

"PKG",26,22,1,"PAH",1,1,209,0)
                          CHECK^XTSUMBLD results
"PKG",26,22,1,"PAH",1,1,210,0)
Routine name    Before Patch          After Patch          Patch List
"PKG",26,22,1,"PAH",1,1,211,0)
============    ============          ===========          ==========
"PKG",26,22,1,"PAH",1,1,212,0)
LR257              NONE                 2442358               257(Deleted by
"PKG",26,22,1,"PAH",1,1,213,0)
                                                                  KIDS) 
"PKG",26,22,1,"PAH",1,1,214,0)
LRMITSE          6478419                8737276              96,257
"PKG",26,22,1,"PAH",1,1,215,0)
LRMITSES         7787667                7819718              96,257
"PKG",26,22,1,"PAH",1,1,216,0)
LRMITSPE         6091299                7314510              96,257
"PKG",26,22,1,"PAH",1,1,217,0)
LRMITSPS         3052409                3271788               257
"PKG",26,22,1,"PAH",1,1,218,0)
LRMITSR          11570196               11570170             96,257
"PKG",26,22,1,"PAH",1,1,219,0)
LRMITSRH         2059425                2320614               257
"PKG",26,22,1,"PAH",1,1,220,0)

"PKG",26,22,1,"PAH",1,1,221,0)

"PKG",26,22,1,"PAH",1,1,222,0)
INSTALLATION INSTRUCTIONS
"PKG",26,22,1,"PAH",1,1,223,0)
=========================
"PKG",26,22,1,"PAH",1,1,224,0)
  The install time for this patch is less than 5 minutes.  This patch
"PKG",26,22,1,"PAH",1,1,225,0)
  can be installed when Laboratory users are on the system.
"PKG",26,22,1,"PAH",1,1,226,0)
  Suggested time to install:  non-peak requirement hours.
"PKG",26,22,1,"PAH",1,1,227,0)

"PKG",26,22,1,"PAH",1,1,228,0)
      Patch installation needs to be coordinated with the Laboratory
"PKG",26,22,1,"PAH",1,1,229,0)
      Information Manager (LIM/ADPAC).
"PKG",26,22,1,"PAH",1,1,230,0)

"PKG",26,22,1,"PAH",1,1,231,0)
  1.  If any of the above routines are mapped, disable mapping for them.
"PKG",26,22,1,"PAH",1,1,232,0)

"PKG",26,22,1,"PAH",1,1,233,0)
  2.  Use the 'INSTALL/CHECK MESSAGE' option of the PackMan menu.  This
"PKG",26,22,1,"PAH",1,1,234,0)
      option will load the KIDS patch onto your system.
"PKG",26,22,1,"PAH",1,1,235,0)

"PKG",26,22,1,"PAH",1,1,236,0)
  3.  On the 'Kernel Installation & Distribution System' Menu (KIDS),
"PKG",26,22,1,"PAH",1,1,237,0)
      select the 'Installation ' menu.
"PKG",26,22,1,"PAH",1,1,238,0)

"PKG",26,22,1,"PAH",1,1,239,0)
  4.  Use the 'Verify Checksum in Transport Global' option and verify that
"PKG",26,22,1,"PAH",1,1,240,0)
      all routines have the correct checksums.
"PKG",26,22,1,"PAH",1,1,241,0)

"PKG",26,22,1,"PAH",1,1,242,0)
  5.  On the KIDS menu, under the 'Installation' menu, use the following
"PKG",26,22,1,"PAH",1,1,243,0)
      options:
"PKG",26,22,1,"PAH",1,1,244,0)
        Print Transport Global
"PKG",26,22,1,"PAH",1,1,245,0)
        Compare Transport Global to Current System
"PKG",26,22,1,"PAH",1,1,246,0)
        Backup a Transport Global
"PKG",26,22,1,"PAH",1,1,247,0)

"PKG",26,22,1,"PAH",1,1,248,0)
  6.  Use the 'Install Package(s)' option under the 'Installation' menu
"PKG",26,22,1,"PAH",1,1,249,0)
      and select the package 'LR*5.2*257'.  When prompted 'Want KIDS to
"PKG",26,22,1,"PAH",1,1,250,0)
      INHIBIT LOGONS during the install? YES//', choose 'NO'.  When prompted
"PKG",26,22,1,"PAH",1,1,251,0)
      'Want to DISABLE Scheduled Options, Menu Options, and Protocols?
"PKG",26,22,1,"PAH",1,1,252,0)
      YES//', choose 'NO'.  When prompted 'Want KIDS to Rebuild Menu Trees
"PKG",26,22,1,"PAH",1,1,253,0)
      Upon Completion of Install? YES//"', choose 'NO'.
"PKG",26,22,1,"PAH",1,1,254,0)

"PKG",26,22,1,"PAH",1,1,255,0)
  7.  On a mapped system, rebuild your map set.
"PKG",26,22,1,"PAH",1,1,256,0)

"PKG",26,22,1,"PAH",1,1,257,0)
NOTE:  Routine LR257 will be deleted after successful patch installation.
"PRE")
LR257
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
7
"RTN","LR257")
0^^B3023539
"RTN","LR257",1,0)
LR257 ;DALOI/CKA - LR*5.2*257 PATCH ENVIRONMENT CHECK ROUTINE;1/15/05
"RTN","LR257",2,0)
 ;;5.2;LAB SERVICE;**257**;Sep 27,1994
"RTN","LR257",3,0)
EN ; Does not prevent loading of the transport global.
"RTN","LR257",4,0)
 ;Environment check is done only during the install.
"RTN","LR257",5,0)
 Q:'$G(XPDENV) 
"RTN","LR257",6,0)
 D BMES^XPDUTL($$CJ^XLFSTR("*** Environment check started ***",80))
"RTN","LR257",7,0)
 D CHECK Q:$G(XPDQUIT)
"RTN","LR257",8,0)
EXIT I $G(XPDQUIT) W !!,$$CJ^XLFSTR("Install Environment Check FAILED",IOM)
"RTN","LR257",9,0)
 I '$G(XPDQUIT) W !!,$$CJ^XLFSTR("Environment Check is Ok ---",IOM)
"RTN","LR257",10,0)
 K VER,RN,LN2
"RTN","LR257",11,0)
 Q
"RTN","LR257",12,0)
CHECK I $S('$G(IOM):1,'$G(IOSL):1,$G(U)'="^":1,1:0) W !,$$CJ^XLFSTR("Terminal Device is not defined",IOM),!! S XPDQUIT=2 Q
"RTN","LR257",13,0)
 I $S('$G(DUZ):1,$D(DUZ)[0:1,$D(DUZ(0))[0:1,1:0) W !!,$$CJ^XLFSTR("Please Log in to set local DUZ... variables",80),! S XPDQUIT=2 Q
"RTN","LR257",14,0)
 I '$D(^VA(200,$G(DUZ),0))#2 W !,$$CJ^XLFSTR("You are not a valid user on this system",80),! S XPDQUIT=2 Q
"RTN","LR257",15,0)
 S VER=$$VERSION^XPDUTL("LR")
"RTN","LR257",16,0)
 I VER'>5.1 W !,$$CJ^XLFSTR("You must have LAB V5.2 Installed",IOM),! S XPDQUIT=2 Q
"RTN","LR257",17,0)
 Q
"RTN","LRMITSE")
0^1^B26817058
"RTN","LRMITSE",1,0)
LRMITSE ;SLC/STAFF - MICRO TREND ENTRY ;3/4/93  17:07
"RTN","LRMITSE",2,0)
 ;;5.2;LAB SERVICE;**96,257**;Sep 27, 1994
"RTN","LRMITSE",3,0)
 ; from LRMITS
"RTN","LRMITSE",4,0)
 ; collect input data for trend report
"RTN","LRMITSE",5,0)
 ; LRAP(drug node)=organism #  if antibiotic pattern defined
"RTN","LRMITSE",6,0)
 ; LRDETAIL  detailed report with patient results
"RTN","LRMITSE",7,0)
 ; LREND  flag to end program
"RTN","LRMITSE",8,0)
 ; LRHELP  help frame
"RTN","LRMITSE",9,0)
 ; LRLOS  length of stay
"RTN","LRMITSE",10,0)
 ; LRMERGE  none/spec/col sample/any  "N"/"S"/"C"/"A"
"RTN","LRMITSE",11,0)
 ; LRM(type of report,"A")="" all values
"RTN","LRMITSE",12,0)
 ; LRM(type of report,"S",value #)=value name  selected values
"RTN","LRMITSE",13,0)
 ; LROTYPE(type of organism)=""  organism types  "B"/"F"/"M"/"P"/"V"
"RTN","LRMITSE",14,0)
 ; LRSORG(type of organism,organism #)=""  if specific organisms selected
"RTN","LRMITSE",15,0)
 ; LRSORT Defines antibiotic reporting order by alph or print order
"RTN","LRMITSE",16,0)
 ; LRSUSR(interp)=""  interpretations forced to 'R'
"RTN","LRMITSE",17,0)
 ; LRSUSS(interp)=""  interpretations forced to 'S'
"RTN","LRMITSE",18,0)
 ; LRUNK  "Unknown" - used for any value
"RTN","LRMITSE",19,0)
 ; LRTBEG  begin time
"RTN","LRMITSE",20,0)
 ; LRTEND  end time
"RTN","LRMITSE",21,0)
 ;
"RTN","LRMITSE",22,0)
 W @IOF,?30,"MICROBIOLOGY TREND REPORT",!
"RTN","LRMITSE",23,0)
 ; initialize variables and defaults
"RTN","LRMITSE",24,0)
 K LRAP,LRM,LROTYPE,LRSORG,LRSUSR,LRSUSS
"RTN","LRMITSE",25,0)
DIV ;MULTIDIVISIONAL PATCH LR*5.2*257 - 3/01
"RTN","LRMITSE",26,0)
 ;ASK IF WANT REPORT BY DIVISION
"RTN","LRMITSE",27,0)
 S LRASK="DIV",LRHELP="LRMITS OPTION"
"RTN","LRMITSE",28,0)
 W !!,"Report by: DIVISION"
"RTN","LRMITSE",29,0)
 S LRPX=$S($D(LRM(LRASK,"A")):"All",1:"No") K DIC,DIR,LRM(LRASK)
"RTN","LRMITSE",30,0)
 S DIR(0)="SAM^A:All;S:Selected;N:No",DIR("A")="(A)ll Divisions, (S)elected Divisions, or (N)o Division Report? ",DIR("B")=LRPX
"RTN","LRMITSE",31,0)
 S DIR("?")="Enter 'A'll, 'S'elected, or 'N'o.",DIR("??")=LRHELP
"RTN","LRMITSE",32,0)
 S DIR("?",1)="Select 'A' to obtain a report grouped by all divisions."
"RTN","LRMITSE",33,0)
 S DIR("?",2)="Select 'S' to obtain a report grouped for selected divisions."
"RTN","LRMITSE",34,0)
 S DIR("?",3)="Select 'N' if you DO NOT want a report grouped by division."
"RTN","LRMITSE",35,0)
 S DIR("?",4)="Enter '^' to exit."
"RTN","LRMITSE",36,0)
 D ^DIR I $D(DIRUT) S LREND=1 Q
"RTN","LRMITSE",37,0)
 I Y="A" S LRM(LRASK,"A")=""
"RTN","LRMITSE",38,0)
 ; if specific values are requested, obtain selections
"RTN","LRMITSE",39,0)
 I Y="S" D
"RTN","LRMITSE",40,0)
 .S DIC=4,DIC(0)="AEMOQ",DIC("A")="Select Division: " F  D ^DIC Q:Y<1  S LRM(LRASK,"S",+Y)=$P(Y,U,2),LRSDIV=+Y
"RTN","LRMITSE",41,0)
 K DIC I $D(DTOUT) S LREND=1
"RTN","LRMITSE",42,0)
 ;
"RTN","LRMITSE",43,0)
 S LRDETAIL=0,LRHELP="LRMITS OPTION",LRLOS=0,LRMERGE="S",LROTYPE("B")="",LRUNK="Unknown"
"RTN","LRMITSE",44,0)
 S (LRSUSR("I"),LRSUSR("R"),LRSUSS("MS"),LRSUSS("S"))=""
"RTN","LRMITSE",45,0)
 S OK=1
"RTN","LRMITSE",46,0)
 S LRBLIK=""
"RTN","LRMITSE",47,0)
 D FILSCAN ;<------DRH patch 96
"RTN","LRMITSE",48,0)
 Q:'OK
"RTN","LRMITSE",49,0)
 I $D(^TMP("LRM",$J)) D QUERY
"RTN","LRMITSE",50,0)
 F LRX="O","S","L","D","P","C" I $D(^LAB(69.9,1,"MIT","B",LRX)) S LRM(LRX,"A")=""
"RTN","LRMITSE",51,0)
 ; default reports
"RTN","LRMITSE",52,0)
 I 'OK S LREND=1 QUIT
"RTN","LRMITSE",53,0)
SORT K DIR S DIR(0)="SAMO^A:Alphabetically;P:Print Order",DIR("B")="A"
"RTN","LRMITSE",54,0)
 S DIR("A")="Sort the Antibiotic output by: "
"RTN","LRMITSE",55,0)
 S DIR("?")="Enter 'A'lphabetically or 'P'rint Order"
"RTN","LRMITSE",56,0)
 S DIR("?",1)="This allows you to choose how the Antibiotics will be"
"RTN","LRMITSE",57,0)
 S DIR("?",2)="sorted. Alphabetically will sort by the mnemonics and "
"RTN","LRMITSE",58,0)
 S DIR("?",3)="Print Order will use the order defined in file #62.06"
"RTN","LRMITSE",59,0)
 S DIR("?",4)="ANTIMICROBIAL SUSCEPTIBILITY" D ^DIR I $D(DIRUT) S LREND=1 Q
"RTN","LRMITSE",60,0)
 S LRSORT=$S(Y="P":1,1:0)
"RTN","LRMITSE",61,0)
 ;
"RTN","LRMITSE",62,0)
 K DIR S DIR(0)="Y",DIR("A")="Use default reports HERE",DIR("B")="YES"
"RTN","LRMITSE",63,0)
 S DIR("?")="Enter 'Y'es or 'N'o",DIR("??")=LRHELP
"RTN","LRMITSE",64,0)
 S DIR("?",1)="Default reports are setup in the Laboratory Site file, 69.9."
"RTN","LRMITSE",65,0)
 S DIR("?",2)="If you answer 'NO', you can select individual antibiotic trend reports"
"RTN","LRMITSE",66,0)
 S DIR("?",3)="grouped by: organism, site/specimen, location, patient, physician, and/or"
"RTN","LRMITSE",67,0)
 S DIR("?",4)="collection sample.  You can select all items or a single item for each group."
"RTN","LRMITSE",68,0)
 S DIR("?",5)="Example: a trend report on a single patient."
"RTN","LRMITSE",69,0)
 D ^DIR I $D(DIRUT) G SORT
"RTN","LRMITSE",70,0)
 K DIR,LRX
"RTN","LRMITSE",71,0)
 ; get specific input if not using default data
"RTN","LRMITSE",72,0)
 I 'Y D ^LRMITSEC Q:LREND  D ^LRMITSES Q:LREND
"RTN","LRMITSE",73,0)
 ; if no reports selected quit
"RTN","LRMITSE",74,0)
 I '$D(LRM) W !,"No reports were selected!" S LREND=1 Q
"RTN","LRMITSE",75,0)
 ; get date range
"RTN","LRMITSE",76,0)
 W ! K DIR S DIR(0)="D^::AE",DIR("A")="Start Date"
"RTN","LRMITSE",77,0)
 S DIR("?")="^D HELP^%DTC",DIR("??")=LRHELP
"RTN","LRMITSE",78,0)
 D ^DIR I $D(DIRUT) S LREND=1 Q
"RTN","LRMITSE",79,0)
 S LRTBEG=Y\1 ;S LRTBEG=$E(Y,1,5)_"00"
"RTN","LRMITSE",80,0)
 K DIR S DIR(0)="D^::AE",DIR("A")="End Date"
"RTN","LRMITSE",81,0)
 S DIR("?")="^D HELP^%DTC",DIR("??")=LRHELP
"RTN","LRMITSE",82,0)
 D ^DIR I $D(DIRUT) S LREND=1 Q
"RTN","LRMITSE",83,0)
 S LRTEND=Y\1 ;S LRTEND=$E(Y,1,5)_"00"
"RTN","LRMITSE",84,0)
 I LRTEND<LRTBEG S X=LRTBEG,LRTBEG=LRTEND,LRTEND=X
"RTN","LRMITSE",85,0)
 W ! K DIR,LRHELP,X,Y
"RTN","LRMITSE",86,0)
 Q
"RTN","LRMITSE",87,0)
 ;-------------------LR*5.2*96------------------------------------
"RTN","LRMITSE",88,0)
FILSCAN ; scan ^LAB(62.06 FOR non std DEFAULT INTERPS ie RES, SUS etc  <--
"RTN","LRMITSE",89,0)
 K ^TMP("LRM",$J)
"RTN","LRMITSE",90,0)
 S LRSCN("R")="R",LRSCN("MS")="MS",LRSCN("I")="I",LRSCN("S")="S"
"RTN","LRMITSE",91,0)
 S LRTIC=0,LRCNT=1
"RTN","LRMITSE",92,0)
 F  S LRTIC=$O(^LAB(62.06,LRTIC)) Q:+LRTIC'>0  D
"RTN","LRMITSE",93,0)
 .  S LRCN=0
"RTN","LRMITSE",94,0)
 .  F  S LRCN=$O(^LAB(62.06,LRTIC,1,LRCN)) Q:+LRCN'>0  S NODE=^(LRCN,0) D
"RTN","LRMITSE",95,0)
 ..  S NODE=$P(NODE,U,2) Q:NODE?1P.E!(+NODE'=0)  I 'NODE D MISSNG
"RTN","LRMITSE",96,0)
 ..  F LRTAC="I","S","R","MS" S:LRTAC=NODE LRGOT1=1
"RTN","LRMITSE",97,0)
 ..  Q:NODE=""  I $G(LRGOT1)'=1 S ^TMP("LRM",$J,NODE)="" S LRCNT=LRCNT+1
"RTN","LRMITSE",98,0)
 ..  K LRGOT1
"RTN","LRMITSE",99,0)
 K NODE,LRCN,LRSCN,LRTIC,LRTAC
"RTN","LRMITSE",100,0)
 Q
"RTN","LRMITSE",101,0)
MISSNG ;
"RTN","LRMITSE",102,0)
 Q:$G(LRBLIK)=1
"RTN","LRMITSE",103,0)
 ;W !!,"You have required fields without data. Please check file 62.06 for deletions.",$C(7)
"RTN","LRMITSE",104,0)
 ;Commented out for future use
"RTN","LRMITSE",105,0)
 S LRBLIK=1
"RTN","LRMITSE",106,0)
 Q
"RTN","LRMITSE",107,0)
QUERY ; Present to user non std entries from ^TMP classify per std.
"RTN","LRMITSE",108,0)
 ; LRSUSR(interp)=""  interpretations forced to 'R'
"RTN","LRMITSE",109,0)
 ; LRSUSS(interp)=""  interpretations forced to 'S'
"RTN","LRMITSE",110,0)
 W !!,"I scanned your Antimicrobial Susceptibility File and was"
"RTN","LRMITSE",111,0)
 W !,"surprised to see you have non-standard entries in the default"
"RTN","LRMITSE",112,0)
 W !,"interpretation field."
"RTN","LRMITSE",113,0)
 W !!,"In order for me to proceed, I need to know what the entry means."
"RTN","LRMITSE",114,0)
 K DIR
"RTN","LRMITSE",115,0)
 S DIR(0)="SOM^1:RESISTANT;2:SUSCEPTIBLE"
"RTN","LRMITSE",116,0)
 S DIR("A")="Please enter your response here"
"RTN","LRMITSE",117,0)
 S LRNTRP="",OK=1
"RTN","LRMITSE",118,0)
 F  S LRNTRP=$O(^TMP("LRM",$J,LRNTRP)) Q:LRNTRP=""!'OK  W !!!,?32,"*****",LRNTRP,"*****" D
"RTN","LRMITSE",119,0)
 .  Q:'$D(LRNTRP)  D ^DIR
"RTN","LRMITSE",120,0)
 .  S:$D(DIRUT) OK="" I 'OK QUIT
"RTN","LRMITSE",121,0)
 .  I Y=1 S LRSUSR(LRNTRP)=""
"RTN","LRMITSE",122,0)
 .  E  S LRSUSS(LRNTRP)=""
"RTN","LRMITSE",123,0)
 K ^TMP("LRM")
"RTN","LRMITSE",124,0)
 K LRNTRP
"RTN","LRMITSE",125,0)
 ;---------------------------------------------------------------------
"RTN","LRMITSE",126,0)
 Q
"RTN","LRMITSES")
0^2^B11205096
"RTN","LRMITSES",1,0)
LRMITSES ;SLC/STAFF - MICRO TREND ENTRY SELECTIONS ;10/18/92  16:03
"RTN","LRMITSES",2,0)
 ;;5.2;LAB SERVICE;**96,257**;Sep 27, 1994
"RTN","LRMITSES",3,0)
 ; from LRMITSE
"RTN","LRMITSES",4,0)
 ;
"RTN","LRMITSES",5,0)
 D SELECT K D,DIC,DIR,DFN,LRASK,LRDFN,LRDPF,LRPROMPT,LRPX,PNM,SSN,X,Y
"RTN","LRMITSES",6,0)
 Q
"RTN","LRMITSES",7,0)
SELECT W !!!?10,"Types of reports to be generated."
"RTN","LRMITSES",8,0)
 ; go thru the report types
"RTN","LRMITSES",9,0)
 F LRASK="O","S","L","D","P","C" D  Q:LREND
"RTN","LRMITSES",10,0)
 .; if specific organisms are used on all reports, prompt only to print report
"RTN","LRMITSES",11,0)
 .I $D(LRSORG),LRASK="O" D  Q
"RTN","LRMITSES",12,0)
 ..W ! K DIR S DIR(0)="Y",DIR("A")="Include report for organisms",DIR("B")="YES"
"RTN","LRMITSES",13,0)
 ..S DIR("?")="Enter 'Y'es or 'N'o",DIR("??")=LRHELP
"RTN","LRMITSES",14,0)
 ..S DIR("?",1)="You have already selected organisms for all report types."
"RTN","LRMITSES",15,0)
 ..S DIR("?",2)="You may select whether or not to include a report grouped by organisms."
"RTN","LRMITSES",16,0)
 ..D ^DIR I $D(DIRUT) S LREND=1 Q
"RTN","LRMITSES",17,0)
 ..I 'Y K LRM("O")
"RTN","LRMITSES",18,0)
 .S LRPROMPT=$S(LRASK="L":"Location",LRASK="O":"Organism",LRASK="D":"Physician",LRASK="P":"Patient",LRASK="C":"Col Samp",1:"Site/Spec") W !!,"Report by:  ",LRPROMPT
"RTN","LRMITSES",19,0)
 .S LRPX=$S($D(LRM(LRASK,"A")):"All",1:"No") K DIC,DIR,LRM(LRASK)
"RTN","LRMITSES",20,0)
 .S DIR(0)="SAM^A:All;S:Selected;N:No",DIR("A")="(A)ll "_LRPROMPT_"s, (S)elected "_LRPROMPT_"s, or (N)o "_LRPROMPT_" Report? ",DIR("B")=LRPX
"RTN","LRMITSES",21,0)
 .S DIR("?")="Enter 'A'll, 'S'elected, or 'N'o.",DIR("??")=LRHELP
"RTN","LRMITSES",22,0)
 .S DIR("?",1)="Select 'A' to obtain a report grouped by all "_LRPROMPT_"s."
"RTN","LRMITSES",23,0)
 .S DIR("?",2)="Select 'S' to obtain a report grouped for selected "_LRPROMPT_"s."
"RTN","LRMITSES",24,0)
 .S DIR("?",3)="Select 'N' if you DO NOT want a report grouped by "_LRPROMPT_"."
"RTN","LRMITSES",25,0)
 .S DIR("?",4)="Enter '^' to exit."
"RTN","LRMITSES",26,0)
 .D ^DIR I $D(DIRUT) S LREND=1 Q
"RTN","LRMITSES",27,0)
 .I Y="A" S LRM(LRASK,"A")=""
"RTN","LRMITSES",28,0)
 .; if specific values are requested, obtain selections
"RTN","LRMITSES",29,0)
 .I Y="S" D
"RTN","LRMITSES",30,0)
 ..I LRASK="L" S DIC=44,DIC(0)="AEMOQ",DIC("A")="Select Location: " F  D ^DIC Q:Y<1  S LRM(LRASK,"S",+Y)=$P(Y,U,2)
"RTN","LRMITSES",31,0)
 ..I LRASK="O" S DIC=61.2,DIC(0)="AEMOQ",DIC("A")="Select Organism: ",DIC("S")="I $L($P(^(0),U,5)),$D(LROTYPE($P(^(0),U,5)))" F  D ^DIC K DIC Q:Y<1  S LRM(LRASK,"S",+Y)=$P(Y,U,2)
"RTN","LRMITSES",32,0)
 ..I LRASK="D" F  S DIC=200,DIC(0)="AEQ",DIC("A")="Select Physician: ",D="AK.PROVIDER" D IX^DIC Q:Y<1  S LRM(LRASK,"S",+Y)=$P(Y,U,2)
"RTN","LRMITSES",33,0)
 ..I LRASK="S" S DIC=61,DIC(0)="AEMOQ",DIC("A")="Select Site/Specimen: " F  D ^DIC Q:Y<1  S LRM(LRASK,"S",+Y)=$P(Y,U,2)
"RTN","LRMITSES",34,0)
 ..I LRASK="P" F  D ^LRDPA Q:LRDFN=-1!$D(DUOUT)!$D(DTOUT)  S LRM(LRASK,"S",DFN)=PNM_U_LRDFN
"RTN","LRMITSES",35,0)
 ..I LRASK="C" S DIC=62,DIC(0)="AEMOQ",DIC("A")="Select Collection Sample: " F  D ^DIC Q:Y<1  S LRM(LRASK,"S",+Y)=$P(Y,U,2)
"RTN","LRMITSES",36,0)
 Q
"RTN","LRMITSPE")
0^3^B14156680
"RTN","LRMITSPE",1,0)
LRMITSPE ;SLC/STAFF - MICRO TREND PROCESS EXTRACT ;10/28/93  15:17
"RTN","LRMITSPE",2,0)
 ;;5.2;LAB SERVICE;**96,257**;Sep 27, 1994
"RTN","LRMITSPE",3,0)
 ; from LRMITSP
"RTN","LRMITSPE",4,0)
 ;Reference to ^SC supported by IA# 10040
"RTN","LRMITSPE",5,0)
 ;Reference to ^SC C xref supported by IA# 908
"RTN","LRMITSPE",6,0)
 ;Reference to ^DD supported by IA# 10154
"RTN","LRMITSPE",7,0)
 ;Reference to ^DPT supported by IA# 10035
"RTN","LRMITSPE",8,0)
 ;Reference to Y^DIQ supported by IA# 10004
"RTN","LRMITSPE",9,0)
 ;Reference to $$NS^XUAF4 supported by IA# 2171
"RTN","LRMITSPE",10,0)
 ;
"RTN","LRMITSPE",11,0)
 S LRSEQN=0
"RTN","LRMITSPE",12,0)
 ; if report type is only for specific patients, collect only that data
"RTN","LRMITSPE",13,0)
 I '$D(LRM("O")),'$D(LRM("S")),'$D(LRM("L")),'$D(LRM("D")),'$D(LRM("C")),'$D(LRM("DIV")),$D(LRM("P","S")) D  Q
"RTN","LRMITSPE",14,0)
 .S DFN=0 F  S DFN=$O(LRM("P","S",DFN)) Q:DFN<1  S LRDFN=+$P(LRM("P","S",DFN),U,2) I LRDFN D DATA Q:LREND
"RTN","LRMITSPE",15,0)
 .D CLEANUP
"RTN","LRMITSPE",16,0)
 ; otherwise, go thru all patients
"RTN","LRMITSPE",17,0)
 S LRDFN=0 F  S LRDFN=$O(^LR(LRDFN)) Q:LRDFN<1  D DATA Q:LREND
"RTN","LRMITSPE",18,0)
CLEANUP K DFN,LRACC,LRADMD,LRANTIM,LRANTIN,LRANTINM,LRATS,LRCDATE,LRCOLN,LRCOLNM,LRDCHD,LRDFN,LRDN,LRDOCN,LRDOCNM,LRGPN,LRGPNM,LRIDT,LRINTERP,LRLOCN,LRLOCNM
"RTN","LRMITSPE",19,0)
 K LRMERGEV,LRN1,LRN2,LRN3,LROK,LRORGN,LRORGNM,LRPATN,LRPATNM,LRPLOS,LRR,LRRTYPE,LRSEQN,LRSPECN,LRSPECNM,LRSUBN,LRSUSR,LRSUSS,LRTSAL,LRTB,LRTYPE,LRX,Y
"RTN","LRMITSPE",20,0)
 K LRX13,LRXN,LRDIV,LRDIVNM,LRSDIV,LRASK
"RTN","LRMITSPE",21,0)
 K LRAPRT,LRBLIK,LRPX
"RTN","LRMITSPE",22,0)
 Q
"RTN","LRMITSPE",23,0)
DATA ; quit if not a valid patient or task is stopped
"RTN","LRMITSPE",24,0)
 Q:'$D(^LR(LRDFN,0))  Q:$P(^(0),U,2)'=2  S LRPATN=+$P(^(0),U,3) I $$S^%ZTLOAD S (LREND,ZTSTOP)=1 Q
"RTN","LRMITSPE",25,0)
 ; go thru valid collection dates with available data
"RTN","LRMITSPE",26,0)
 S LRIDT=LRTSAL F  S LRIDT=$O(^LR(LRDFN,"MI",LRIDT)) Q:LRIDT<1!((LRIDT\1)>LRATS)  S LRX=$G(^(LRIDT,0)) I LRX,$$CHECK(LRDFN,LRIDT,.LROTYPE) D
"RTN","LRMITSPE",27,0)
 .; get date, los, acc, patient, provider, site/specimen, location, col samp #s and names
"RTN","LRMITSPE",28,0)
 .S LRCDATE=+LRX
"RTN","LRMITSPE",29,0)
 .S LRPLOS=$S(LRLOS!LRDETAIL:$$LOS(LRPATN,LRCDATE),1:"") I LRLOS Q:'$L(LRPLOS)  Q:LRPLOS<LRLOS
"RTN","LRMITSPE",30,0)
 .S LRACC=$P(LRX,U,6)
"RTN","LRMITSPE",31,0)
 .S LRPATNM=$P($G(^DPT(LRPATN,0)),U) I '$L(LRPATNM) S LRPATNM=LRUNK
"RTN","LRMITSPE",32,0)
 .S LRDOCN=+$P(LRX,U,7),LRDOCNM=$$VALUE(LRDOCN,63.05,.07) I '$L(LRDOCNM) S LRDOCNM=LRUNK
"RTN","LRMITSPE",33,0)
 .S LRSPECN=+$P(LRX,U,5),LRSPECNM=$P($G(^LAB(61,LRSPECN,0)),U) I '$L(LRSPECNM) S LRSPECNM=LRUNK
"RTN","LRMITSPE",34,0)
 .S LRLOCNM=$P(LRX,U,8) S:'$L(LRLOCNM) LRLOCNM=LRUNK
"RTN","LRMITSPE",35,0)
 .S X=LRLOCNM,DIC="^SC(",DIC(0)="",D="C" D IX^DIC
"RTN","LRMITSPE",36,0)
 .I Y=-1 S LRLOCN=0
"RTN","LRMITSPE",37,0)
 .E  S LRLOCN=Y ;S LRLOCN=+$O(^SC("C",LRLOCNM,0))
"RTN","LRMITSPE",38,0)
 .K DIC,Y
"RTN","LRMITSPE",39,0)
 .;MULTIDIVISIONAL PATCH LR*5.2*257 - 08/04
"RTN","LRMITSPE",40,0)
 .S LRX13=$P(LRX,U,13),LRXN=$P(LRX13,";")
"RTN","LRMITSPE",41,0)
 .I LRX13>0,$P(LRX13,";",2)="SC(" S LRLOCNM=$P(^SC(LRXN,0),U),LRDIV=$P(^SC(LRXN,0),U,4)
"RTN","LRMITSPE",42,0)
 .I LRX13>0,$P(LRX13,";",2)="DIC(4," S LRDIV=LRXN
"RTN","LRMITSPE",43,0)
 .I '$G(LRDIV) S LRDIV=$P($G(^SC(+LRLOCN,0)),U,4)
"RTN","LRMITSPE",44,0)
 .I LRDIV S LRDIVNM=$P($$NS^XUAF4(LRDIV),U)
"RTN","LRMITSPE",45,0)
 .E  S LRDIV=0,LRDIVNM="UNKNOWN"
"RTN","LRMITSPE",46,0)
 .S:LRDIV="" LRDIV=0
"RTN","LRMITSPE",47,0)
 .S LRCOLN=+$P(LRX,U,11),LRCOLNM=$P($G(^LAB(62,LRCOLN,0)),U) I '$L(LRCOLNM) S LRCOLNM=LRUNK
"RTN","LRMITSPE",48,0)
 .;MULTIDIVISIONAL PATCH LR*5.2*257 -3/01
"RTN","LRMITSPE",49,0)
 .;if report is for specific division, collect only that data
"RTN","LRMITSPE",50,0)
 .I $D(LRM("DIV","S")) D  Q
"RTN","LRMITSPE",51,0)
 ..S LRSDIV=0
"RTN","LRMITSPE",52,0)
 ..F  S LRSDIV=$O(LRM("DIV","S",LRSDIV)) Q:LRSDIV=""  D
"RTN","LRMITSPE",53,0)
 ...I LRSDIV=LRDIV,LRDIV'=0 D ^LRMITSPO
"RTN","LRMITSPE",54,0)
 ..Q 
"RTN","LRMITSPE",55,0)
 .; get data on organisms
"RTN","LRMITSPE",56,0)
 .D ^LRMITSPO
"RTN","LRMITSPE",57,0)
 Q
"RTN","LRMITSPE",58,0)
CHECK(LRDFN,LRIDT,LROTYPE) ; lab patient, time, organism types -> 1 or 0 if data available
"RTN","LRMITSPE",59,0)
 I $D(LROTYPE("B")),$D(^LR(LRDFN,"MI",LRIDT,3)) Q 1
"RTN","LRMITSPE",60,0)
 I $D(LROTYPE("F")),$D(^LR(LRDFN,"MI",LRIDT,8)) Q 1
"RTN","LRMITSPE",61,0)
 I $D(LROTYPE("M")),$D(^LR(LRDFN,"MI",LRIDT,11)) Q 1
"RTN","LRMITSPE",62,0)
 I $D(LROTYPE("P")),$D(^LR(LRDFN,"MI",LRIDT,5)) Q 1
"RTN","LRMITSPE",63,0)
 I $D(LROTYPE("V")),$D(^LR(LRDFN,"MI",LRIDT,16)) Q 1
"RTN","LRMITSPE",64,0)
 I '$D(LROTYPE("B")),$D(^LR(LRDFN,"MI",LRIDT,3)) Q 1
"RTN","LRMITSPE",65,0)
 Q 0
"RTN","LRMITSPE",66,0)
VALUE(Y,FILE,FIELD) ; $$(internal value,file,field) -> external value or ""
"RTN","LRMITSPE",67,0)
 I 'Y Q ""
"RTN","LRMITSPE",68,0)
 N C S C=$P(^DD(FILE,FIELD,0),U,2) D Y^DIQ Q Y
"RTN","LRMITSPE",69,0)
LOS(DFN,CDATE) ; $$(patient,collection date) -> length of stay or ""
"RTN","LRMITSPE",70,0)
 N ADATE S VAINDT=CDATE D INP^VADPT S ADATE=$P(VAIN(7),U) D KVAR^VADPT I '$L(ADATE) Q ""
"RTN","LRMITSPE",71,0)
 Q $$FMDIFF^XLFDT(CDATE,ADATE)
"RTN","LRMITSPS")
0^4^B5049655
"RTN","LRMITSPS",1,0)
LRMITSPS ;SLC/STAFF - MICRO TREND PROCESS SETUP ;10/12/92  20:07
"RTN","LRMITSPS",2,0)
 ;;5.2;LAB SERVICE;**257**;Sep 27, 1994
"RTN","LRMITSPS",3,0)
 ; from LRMITSPO
"RTN","LRMITSPS",4,0)
 ;
"RTN","LRMITSPS",5,0)
 S LRMERGEV=$S(LRMERGE="S":LRSPECN,LRMERGE="C":LRCOLN,1:0)
"RTN","LRMITSPS",6,0)
 ; setup data for each report type
"RTN","LRMITSPS",7,0)
 ;MULTIDIVISIONAL PATCH LR*5.2*257 02/01
"RTN","LRMITSPS",8,0)
 F LRTYPE="O;LRORGN;LRORGNM","S;LRSPECN;LRSPECNM","L;LRLOCN;LRLOCNM","D;LRDOCN;LRDOCNM","P;LRPATN;LRPATNM","C;LRCOLN;LRCOLNM","DIV;LRDIV;LRDIVNM" I $D(LRM($P(LRTYPE,";"))) D
"RTN","LRMITSPS",9,0)
 .S LRRTYPE=$P(LRTYPE,";"),LRGPN=@$P(LRTYPE,";",2),LRGPNM=@$P(LRTYPE,";",3)
"RTN","LRMITSPS",10,0)
 .; count patients for report type
"RTN","LRMITSPS",11,0)
 .I $D(LRM(LRRTYPE,"A")) S ^TMP($J,"PAT",LRRTYPE,LRPATN)=""
"RTN","LRMITSPS",12,0)
 .I $D(LRM(LRRTYPE,"S",LRGPN)) S ^TMP($J,"PAT",LRRTYPE,LRPATN)=""
"RTN","LRMITSPS",13,0)
 .; setup isolate data
"RTN","LRMITSPS",14,0)
 .S LRN1=$G(^TMP($J,LRRTYPE,LRGPNM,LRGPN,LRORGNM,LRORGN))
"RTN","LRMITSPS",15,0)
 .I 'LRN1 D
"RTN","LRMITSPS",16,0)
 ..S (LRN1,LRSEQN)=LRSEQN+1
"RTN","LRMITSPS",17,0)
 ..S ^TMP($J,LRRTYPE,LRGPNM,LRGPN,LRORGNM,LRORGN)=LRN1
"RTN","LRMITSPS",18,0)
 .S LRN2=$G(^TMP($J,LRN1,"P",LRPATNM,LRPATN,LRSPECNM,LRSPECN))
"RTN","LRMITSPS",19,0)
 .I 'LRN2 D
"RTN","LRMITSPS",20,0)
 ..S (LRN2,LRSEQN)=LRSEQN+1
"RTN","LRMITSPS",21,0)
 ..S ^TMP($J,LRN1,"P",LRPATNM,LRPATN,LRSPECNM,LRSPECN)=LRN2
"RTN","LRMITSPS",22,0)
 .S (LRN3,LRSEQN)=LRSEQN+1
"RTN","LRMITSPS",23,0)
 .S ^(LRGPN)=$G(^TMP($J,LRRTYPE,LRGPNM,LRGPN))+1
"RTN","LRMITSPS",24,0)
 .S ^TMP($J,LRN2,LRCDATE,LRSUBN)=LRN3_U_LRACC_U_LRPLOS_U_LRCOLN
"RTN","LRMITSPS",25,0)
 .S ^TMP($J,"M",LRN1,LRPATN_";"_LRORGN_";"_LRMERGEV,-LRN3)=LRN2_U_LRCDATE_U_LRSUBN
"RTN","LRMITSPS",26,0)
 .; setup bacteria antibiotic data
"RTN","LRMITSPS",27,0)
 .S LRDN=0 F  S LRDN=$O(LRANTIM(LRDN)) Q:LRDN<2  D
"RTN","LRMITSPS",28,0)
 ..S LRANTINM=$P($G(^TMP($J,"A",LRDN)),U,2) Q:'$L(LRANTINM)
"RTN","LRMITSPS",29,0)
 ..S ^TMP($J,LRN3,"A",LRANTINM)=LRANTIM(LRDN)
"RTN","LRMITSPS",30,0)
 .; setup mycobatcteria antibiotic data
"RTN","LRMITSPS",31,0)
 .S LRDN=0 F  S LRDN=$O(LRTB(LRDN)) Q:LRDN<2  D
"RTN","LRMITSPS",32,0)
 ..S LRANTINM=$P($G(^TMP($J,"T",LRDN)),U) Q:'$L(LRANTINM)
"RTN","LRMITSPS",33,0)
 ..S ^TMP($J,LRN3,"T",LRANTINM)=LRTB(LRDN)
"RTN","LRMITSPS",34,0)
 Q
"RTN","LRMITSR")
0^5^B20538738
"RTN","LRMITSR",1,0)
LRMITSR ;SLC/STAFF - MICRO TREND REPORT ;10/17/92  22:52
"RTN","LRMITSR",2,0)
 ;;5.2;LAB SERVICE;**96,257**;Sep 27, 1994
"RTN","LRMITSR",3,0)
 ; from LRMITSP
"RTN","LRMITSR",4,0)
 ; report may be stopped by stopping task
"RTN","LRMITSR",5,0)
 ;
"RTN","LRMITSR",6,0)
 D REPORT I LREND W !!,"Report has been stopped."
"RTN","LRMITSR",7,0)
 W @IOF K LRABRV,LRACC,LRCDATE,LRCNT,LRCOLS,LRDN,LRGPN,LRGPNM,LRGPV,LRHDR,LRHDR1,LRHDRT,LRLINE,LRLINE1,LRN,LRN1,LRN2,LRN3,LRNM
"RTN","LRMITSR",8,0)
 K LRORGN,LRORGNM,LRPAGE,LRPATN,LRPATNM,LRPATNUM,LRPLOS,LRSPACE,LRSPECN,LRSPECNM,LRSTATUS,LRSUBN,LRSUSC,LRTCNT,LRTYPE,LRX
"RTN","LRMITSR",9,0)
 Q
"RTN","LRMITSR",10,0)
REPORT D ^LRMITSRS
"RTN","LRMITSR",11,0)
 I $D(LRM("O")) D  Q:LREND
"RTN","LRMITSR",12,0)
 .S LRPAGE=0,LRPATNUM=+$G(^TMP($J,"O")),LRTYPE="O" D ^LRMITSRH Q:LREND
"RTN","LRMITSR",13,0)
 .S LRORGNM="" F  S LRORGNM=$O(^TMP($J,LRTYPE,LRORGNM)) Q:LRORGNM=""  D  Q:LREND
"RTN","LRMITSR",14,0)
 ..S LRORGN=0 F  S LRORGN=$O(^TMP($J,LRTYPE,LRORGNM,LRORGN)) Q:LRORGN<1  S LRN1=$G(^(LRORGN,LRORGNM,LRORGN)) D  Q:LREND
"RTN","LRMITSR",15,0)
 ...I $D(LRM(LRTYPE,"S")),'$D(LRM(LRTYPE,"S",LRORGN)) Q
"RTN","LRMITSR",16,0)
 ...D RESULTS
"RTN","LRMITSR",17,0)
 S LRTYPE="" F  S LRTYPE=$O(LRM(LRTYPE)) Q:LRTYPE=""  I LRTYPE'="O" D  Q:LREND
"RTN","LRMITSR",18,0)
 .S LRPAGE=0,LRPATNUM=+$G(^TMP($J,LRTYPE)) D ^LRMITSRH Q:LREND
"RTN","LRMITSR",19,0)
 .S LRGPNM="" F  S LRGPNM=$O(^TMP($J,LRTYPE,LRGPNM)) Q:LRGPNM=""  D  Q:LREND
"RTN","LRMITSR",20,0)
 ..S LRGPN="" F  S LRGPN=$O(^TMP($J,LRTYPE,LRGPNM,LRGPN)) Q:LRGPN=""  S LRGPV=+^(LRGPN) D  Q:LREND
"RTN","LRMITSR",21,0)
 ...I $D(LRM(LRTYPE,"S")),'$D(LRM(LRTYPE,"S",LRGPN)) Q
"RTN","LRMITSR",22,0)
 ...D LCHECK Q:LREND  W !,LRGPNM," (",+LRGPV," isolates)",!,"---------------"
"RTN","LRMITSR",23,0)
 ...S LRORGNM="" F  S LRORGNM=$O(^TMP($J,LRTYPE,LRGPNM,LRGPN,LRORGNM)) Q:LRORGNM=""  D  Q:LREND
"RTN","LRMITSR",24,0)
 ....S LRORGN=0 F  S LRORGN=$O(^TMP($J,LRTYPE,LRGPNM,LRGPN,LRORGNM,LRORGN)) Q:LRORGN<1  S LRN1=^(LRORGN) D RESULTS Q:LREND
"RTN","LRMITSR",25,0)
 Q
"RTN","LRMITSR",26,0)
RESULTS D LCHECK Q:LREND  W !,$S($L(LRORGNM)<34:$E(LRORGNM,5,34),1:$P(^LAB(61.2,LRORGN,0),U)) S LROTYPE=$E($P(LRORGNM,"(",2))
"RTN","LRMITSR",27,0)
 S LRX=^TMP($J,LRN1,"C") D LCHECK Q:LREND  W !,"(",+LRX," counted, ",+$P(LRX,U,2)," merged, ",+$P(LRX,U,3)," not tested)"
"RTN","LRMITSR",28,0)
 I LROTYPE="B" D  Q:LREND
"RTN","LRMITSR",29,0)
 .S LRNODE="^TMP($J,"_$S($D(^TMP($J,"PSRT")):"""PSRT""",1:"""AB""")_",LRAINT)"
"RTN","LRMITSR",30,0)
 .S LRLINE="% sus",LRAINT="" F  S LRAINT=$O(@LRNODE) Q:LRAINT=""  D
"RTN","LRMITSR",31,0)
 ..S LRABRV=$S($D(^TMP($J,"PSRT")):$G(@LRNODE),1:LRAINT)
"RTN","LRMITSR",32,0)
 ..Q:LRABRV=""
"RTN","LRMITSR",33,0)
 ..S (LRSUSC,LRX)=$G(^TMP($J,LRN1,"C",LRABRV)) I LRX S LRSUSC=$J($P(LRX,U,2)/LRX*100,0,0)
"RTN","LRMITSR",34,0)
 ..S LRLINE=LRLINE_"|"_$J(LRSUSC,3)
"RTN","LRMITSR",35,0)
 .S LRLINE=LRLINE_"|" D LCHECK Q:LREND  W !,LRLINE
"RTN","LRMITSR",36,0)
 .S LRNODE="^TMP($J,"_$S($D(^TMP($J,"PSRT")):"""PSRT""",1:"""AB""")_",LRAINT)"
"RTN","LRMITSR",37,0)
 .S LRLINE="# ctd",LRAINT="" F  S LRAINT=$O(@LRNODE) Q:LRAINT=""  D
"RTN","LRMITSR",38,0)
 ..Q:LRABRV=""
"RTN","LRMITSR",39,0)
 ..S LRABRV=$S($D(^TMP($J,"PSRT")):$G(@LRNODE),1:LRAINT)
"RTN","LRMITSR",40,0)
 ..S (LRTCNT,LRX)=$G(^TMP($J,LRN1,"C",LRABRV)) I LRX S LRTCNT=+LRX
"RTN","LRMITSR",41,0)
 ..S LRLINE=LRLINE_"|"_$J(LRTCNT,3)
"RTN","LRMITSR",42,0)
 .S LRLINE=LRLINE_"|" D LCHECK Q:LREND  W !,LRLINE
"RTN","LRMITSR",43,0)
 ; detailed report
"RTN","LRMITSR",44,0)
 Q:'LRDETAIL
"RTN","LRMITSR",45,0)
 S LRPATNM="" F  S LRPATNM=$O(^TMP($J,LRN1,"P",LRPATNM)) Q:LRPATNM=""  D  Q:LREND
"RTN","LRMITSR",46,0)
 .S LRPATN=0 F  S LRPATN=$O(^TMP($J,LRN1,"P",LRPATNM,LRPATN)) Q:LRPATN<1  D  Q:LREND
"RTN","LRMITSR",47,0)
 ..S LRSPECNM="" F  S LRSPECNM=$O(^TMP($J,LRN1,"P",LRPATNM,LRPATN,LRSPECNM)) Q:LRSPECNM=""  D  Q:LREND
"RTN","LRMITSR",48,0)
 ...S LRSPECN=0 F  S LRSPECN=$O(^TMP($J,LRN1,"P",LRPATNM,LRPATN,LRSPECNM,LRSPECN)) Q:LRSPECN<1  S LRN2=+^(LRSPECN) D  Q:LREND
"RTN","LRMITSR",49,0)
 ....S LRCDATE=0 F  S LRCDATE=$O(^TMP($J,LRN2,LRCDATE)) Q:LRCDATE<1  D  Q:LREND
"RTN","LRMITSR",50,0)
 .....S LRSUBN=0 F  S LRSUBN=$O(^TMP($J,LRN2,LRCDATE,LRSUBN)) Q:LRSUBN<1  S LRX=^(LRSUBN) D DETAIL Q:LREND
"RTN","LRMITSR",51,0)
 Q
"RTN","LRMITSR",52,0)
DETAIL S LRN3=+LRX,LRACC=$P(LRX,U,2),LRPLOS=$P(LRX,U,3),LRCOLS=$P($G(^LAB(62,+$P(LRX,U,4),0)),U),LRSTATUS=$P(LRX,U,5) I $L(LRPLOS) S LRPLOS="LOS: "_LRPLOS_" days"
"RTN","LRMITSR",53,0)
 D LCHECK Q:LREND  W !?2,LRPATNM," ",?32,LRSPECNM," ",?52,LRACC," ",?66,$$FMTE^XLFDT(LRCDATE\1),?82,LRPLOS I LRSTATUS="M" W " ** merged **"
"RTN","LRMITSR",54,0)
 I LROTYPE="B" D  Q:LREND
"RTN","LRMITSR",55,0)
 .S LRNODE="^TMP($J,"_$S($D(^TMP($J,"PSRT")):"""PSRT""",1:"""AB""")_",LRAINT)"
"RTN","LRMITSR",56,0)
 .S LRLINE=LRSPACE,LRAINT="" F  S LRAINT=$O(@LRNODE) Q:LRAINT=""  D
"RTN","LRMITSR",57,0)
 ..S LRABRV=$S($D(^TMP($J,"PSRT")):$G(@LRNODE),1:LRAINT)
"RTN","LRMITSR",58,0)
 ..S LRLINE=LRLINE_"|"_$J($P($G(^TMP($J,LRN3,"A",LRABRV)),U),3)
"RTN","LRMITSR",59,0)
 .S LRLINE=LRLINE_"|" D LCHECK Q:LREND  W !,LRLINE
"RTN","LRMITSR",60,0)
 I LROTYPE="M",$D(^TMP($J,LRN3,"T")) D  Q:LREND
"RTN","LRMITSR",61,0)
 .K LRTEMP,LRTEMPT S LRABRV="" F  S LRABRV=$O(^TMP($J,"T",LRABRV)) Q:LRABRV=""  S LRTEMP(LRABRV)=LRABRV_"="_^(LRABRV)
"RTN","LRMITSR",62,0)
 .D HLIST^LRMITSRS("LRTEMP","LRTEMPT",", ",IOM-LRSPACE)
"RTN","LRMITSR",63,0)
 .S LRABRV="" F  S LRABRV=$O(LRTEMPT(LRABRV)) Q:LRABRV  D LCHECK Q:LREND  W !?LRSPACE,LRTEMPT(LRABRV)
"RTN","LRMITSR",64,0)
 .K LRTEMP,LRTEMPT
"RTN","LRMITSR",65,0)
 Q
"RTN","LRMITSR",66,0)
LCHECK I $Y+4>IOSL D ^LRMITSRH
"RTN","LRMITSR",67,0)
 Q
"RTN","LRMITSRH")
0^6^B2990572
"RTN","LRMITSRH",1,0)
LRMITSRH ;SLC/STAFF - MICRO TREND REPORT HEADER ;10/12/92  20:26
"RTN","LRMITSRH",2,0)
 ;;5.2;LAB SERVICE;**257*;Sep 27, 1994
"RTN","LRMITSRH",3,0)
 ; from LRMITSR
"RTN","LRMITSRH",4,0)
 ; writes heading information
"RTN","LRMITSRH",5,0)
 ;
"RTN","LRMITSRH",6,0)
 I $$S^%ZTLOAD S (LREND,ZTSTOP)=1 Q
"RTN","LRMITSRH",7,0)
 W @IOF S LRPAGE=LRPAGE+1
"RTN","LRMITSRH",8,0)
 S LRHDRT=$S(LRTYPE="O":"ORGANISM",LRTYPE="S":"SITE/SPECIMEN",LRTYPE="L":"LOCATION",LRTYPE="P":"PATIENT",LRTYPE="C":"COLLECTION SAMPLE",LRTYPE="DIV":"DIVISION",1:"PHYSICIAN")
"RTN","LRMITSRH",9,0)
 I LRPAGE=1 D
"RTN","LRMITSRH",10,0)
 .S LRLINE(1)=LRLINE1_LRHDRT,LRLINE(1)=$J(LRLINE(1),IOM+$L(LRLINE(1))\2)
"RTN","LRMITSRH",11,0)
 .W LRLINE(1),!,LRLINE(2)
"RTN","LRMITSRH",12,0)
 .I $D(LRM(LRTYPE,"S")) D
"RTN","LRMITSRH",13,0)
 ..W !,"This report is restricted to the following ",$$LOW^XLFSTR(LRHDRT),"s:"
"RTN","LRMITSRH",14,0)
 ..K LRTEMP D HLIST^LRMITSRS("LRM(LRTYPE,""S"")","LRTEMP",", ",IOM)
"RTN","LRMITSRH",15,0)
 ..S LRN="" F  S LRN=$O(LRTEMP(LRN)) Q:LRN=""  W !,LRTEMP(LRN)
"RTN","LRMITSRH",16,0)
 ..K LRTEMP
"RTN","LRMITSRH",17,0)
 .S LRCNT=2 F  S LRCNT=$O(LRLINE(LRCNT)) Q:LRCNT<1  W !,LRLINE(LRCNT)
"RTN","LRMITSRH",18,0)
 S LRHDR(1)=LRHDR1_LRPATNUM_" patients)           BY "_LRHDRT_"    Page "_$J(LRPAGE,1)
"RTN","LRMITSRH",19,0)
 S LRCNT=0 F  S LRCNT=$O(LRHDR(LRCNT)) Q:LRCNT<1  W !,LRHDR(LRCNT)
"RTN","LRMITSRH",20,0)
 Q
"UP",63,63.04,-1)
63^CH
"UP",63,63.04,0)
63.04
"UP",63,63.05,-1)
63^MI
"UP",63,63.05,0)
63.05
"VER")
8.0^22.0
"^DD",63,63.04,.111,0)
REQUESTING LOC/DIV^V^^0;13^Q
"^DD",63,63.04,.111,3)
Enter the hospital location or institution ordering this test.
"^DD",63,63.04,.111,21,0)
^^1^1^2970616^^
"^DD",63,63.04,.111,21,1,0)
This is the hospital location or institution ordering this test.
"^DD",63,63.04,.111,"DT")
2970201
"^DD",63,63.04,.111,"V",0)
^.12P^2^2
"^DD",63,63.04,.111,"V",1,0)
44^Hospital Location^1^SC(^n^n
"^DD",63,63.04,.111,"V",2,0)
4^Ordering Institution^2^DIC(4,^n^n
"^DD",63,63.04,.112,0)
ACCESSIONING INSTITUTION^P4'^DIC(4,^0;14^Q
"^DD",63,63.04,.112,21,0)
^^4^4^3040804^
"^DD",63,63.04,.112,21,1,0)
This field contains the pointer to the institution where the specimen was 
"^DD",63,63.04,.112,21,2,0)
accessioned. This field can be blank if LEDI or POC specimen
"^DD",63,63.04,.112,21,3,0)
is accessioned. The field will be set if an actual user accepts the 
"^DD",63,63.04,.112,21,4,0)
specimen.
"^DD",63,63.04,.112,"DT")
3040804
"^DD",63,63.05,.111,0)
REQUESTING LOC/DIV^V^^0;13^Q
"^DD",63,63.05,.111,3)
Enter the hospital location or institution ordering this test.
"^DD",63,63.05,.111,21,0)
^.001^1^1^3050407^^^
"^DD",63,63.05,.111,21,1,0)
Enter the hospital location or institution ordering this test.
"^DD",63,63.05,.111,"DT")
3040804
"^DD",63,63.05,.111,"V",0)
^.12P^2^2
"^DD",63,63.05,.111,"V",1,0)
44^Enter Hospital Location^1^SC(^n^n
"^DD",63,63.05,.111,"V",2,0)
4^Select appropriate Institution^2^DIC(4,^n^n
"^DD",63,63.05,.112,0)
ACCESSIONING INSTITUTION^P4'^DIC(4,^0;14^Q
"^DD",63,63.05,.112,21,0)
^^3^3^3040804^
"^DD",63,63.05,.112,21,1,0)
This field contains the pointer to the institution where the specimen was 
"^DD",63,63.05,.112,21,2,0)
accessioned. This field can be blank if LEDI or POC specimen is 
"^DD",63,63.05,.112,21,3,0)
accessioned. The field will be set if an actual user accepts the specimen.
"^DD",63,63.05,.112,"DT")
3040804
"BLD",5703,6)
^SEQ #252
**END**
**END**
