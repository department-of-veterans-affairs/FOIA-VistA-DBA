$TXT Created by CHIN,CORY L at DEVVII.FO-ALBANY.MED.VA.GOV  (KIDS) on Friday, 01/13/06 at 10:21
=============================================================================
Run Date: MAR 09, 2006                     Designation: SD*5.3*430
Package : SD - SCHEDULING                     Priority: Mandatory
Version : 5.3       SEQ #375                    Status: Released
                  Compliance Date: APR 09, 2006
=============================================================================

Associated patches: (v)SD*5.3*257  <<= must be installed BEFORE `SD*5.3*430'
                    (v)IB*2*286    <<= must be installed BEFORE `SD*5.3*430'

Subject: PFSS SCHEDULING PKG CHANGES

Category: 
  - Routine
  - Data Dictionary
  - Other
  - Enhancement (Mandatory)

Description:
============

 IMPORTANT NOTE:  As of the release date of this patch the software 
 changes instituted with this patch will be invisible to users except for 
 those sites who are using PFSS (initially Cleveland with more expected to 
 follow at a later date).
  
 This patch is part of the Patient Financial Services System (PFSS) 
 project.  PFSS patches are being released on various schedules.  Some 
 patch functionality will not be active until a new PFSS switch is 
 activated during final implementation. PFSS will initially be implemented 
 at select pilot sites ONLY.
  
 The purpose of the PFSS project is to prepare the Veterans Health 
 Information Systems and Technology Architecture (VistA) environment for
 the implementation of a commercial off-the-shelf (COTS) billing 
 replacement system.  The project consists of the implementation of the 
 billing replacement system, business process improvements, and 
 enhancements to VistA to support integration with the COTS billing
 replacement system.  Significant changes to VistA legacy systems and 
 ancillary packages are necessary.
  
 Some of the PFSS software components are not operational until the PFSS 
 On/Off Switch, distributed with patch IB*2.0*260, is set to "ON".  The 
 ability for the local site to set the switch to "ON" will be provided at 
 the appropriate time with the release of a subsequent Integrated Billing 
 (IB) patch.
  
 For more information about the PFSS project, review the documentation 
 accompanying this patch and refer to the following website: 
 http://vista.med.va.gov/billreplace/
  
 The COTS billing system handles the billing functionality by incorporating
 a patient account number for all billable patient activity.  The 
 Scheduling package does not currently support the use of a patient 
 "account number".  This patch provides the modifications and enhancements
 necessary to provide this "account awareness".  All outpatient
 appointments or encounters created within a PFSS-enabled system will 
 generate a PFSS Account Reference through an Integrated Billing 
 Subsystem (IBB) API.
  
 The functionality installed by this patch will be invisible to users of 
 the Appointment Management menus.  The Appointment Management menus will 
 call an IBB API in the background which will generate the PFSS Account 
 Reference and return it for storage in a new cross-reference file, 
 APPOINTMENT PFSS ACCOUNT REFERENCE File (#409.55).
  
 For the new functionality to request and store the PFSS Account Reference
 during appointment management, two conditions are required to be met.
 First, patch IB*2.0*286 must be installed (these are the new IBB utilities
 and files). Second, the PFSS On/Off Switch must be enabled at the site.  
 If these two conditions are not met, the Scheduling functionality will
 continue to function as it does currently.
  
 NOTE: IB*2.0*286 does not need to be installed for this patch to be
 installed.  Until the PFSS On/Off Switch is activated, the Scheduling
 package will ignore any of the installed modifications.
  
 PFSS Activation Conversion
 ===========================
 Do NOT attempt to run the following conversion routine as part of the 
 patch install.  This conversion will be run at later date by the
 appropriate system implementation personnel.
  
 Upon implementation of PFSS, the routine will be run from the EP1 tag.  
 Running the routine displays the message below to the user.  This message
 is also displayed as part of the proper running of the routine from tags
 PRECHK,POSTCHK and EP1.
  
 The Scheduled Outpatient Back-Load routine, SD53430P, is a one-time 
 conversion requirement for each location implementing the COTS billing 
 system. This process will be added to the PFSS Implementation Plan 
 Activation Checklist.  During the Activation, scheduled outpatients who
 have an Appointment Date that is on or after the PFSS Effective Date shall
 be converted to the COTS billing system. This conversion will create a 
 Visit Number on the COTS billing system and produce a corresponding flat
 file so that the generated Visit Numbers can be "Back-Loaded" into VistA.
  
 The data from this file will be loaded into the APPOINTMENT ACCOUNT 
 NUMBER REFERENCE File (#409.55) and the PFSS ACCOUNT File (#375).  This
 backload will effectively simulate the Make Appointment Event that
 occurred when the PFSS Master Switch was still "Off". An IBB API will be 
 called to file the data elements into the PFSS ACCOUNT File (#375). The 
 API will return the Account Number Reference to be filed in the
 APPOINTMENT PFSS ACCOUNT REFERENCE File (#409.55).
  
 A Pre-Analysis function, run from the PRECHK tag, was also created to
 establish a backload base number of "Outpatient Future Appointments". In
 addition, a Post-Analysis function, run from the POSTCHK tag, will allow
 for an analysis of the backload file prior to a live run.  The function
 compares the backload file patient appointments against the expected
 appointment list from the Pre-Analysis.  Any patient discrepancies will be
 displayed after the analysis.
  
 ===========================================================
 Scheduled Outpatient Conversion Backload
  
     **********************************************************
     * This Routine should ONLY be run by PFSS Implementation *
     * Staff.  DO NOT run this routine as part of the normal  *
     * Patch installation process.                            *
     **********************************************************
  
 ===========================================================
  
 This patch addresses the following New Service Request (NSR):
 -------------------------------------------------------------
 None
  
  
 This patch addresses the following NOIS/Remedy Ticket(s):
 ---------------------------------------------------------
 None
  
  
 Overview of NOIS/Remedy Ticket(s):
 ----------------------------------
 None
  
  
 Test Sites:
 -----------
 Boston HCS
 Dayton VAMC
 Tuscaloosa VAMC
  
  
        ================INSTALLATION INSTRUCTIONS =================
  
 If installed during the normal workday, it is recommended that the 
 following selection(s) in the OPTION (#19) file, and all of their 
 descendants be disabled to prevent possible conflicts while running the 
 KIDS Install. Other VISTA users will not be affected.
  
     [SDAM APPT MGT]               Appointment Management
     [SDAM APPT CHECK IN/OUT]      Appointment Check-in/Check-out
     [SD CANCEL APPOINTMENT]       Cancel Appointment
     [SDM]                         Make Appointment
  
 Install Time - less than 5 minutes
  
  
   1.   LOAD TRANSPORT GLOBAL 
        ---------------------
        Choose the PackMan message containing this patch and invoke the 
        INSTALL/CHECK MESSAGE PackMan option.  
              
   2.   DISABLE ROUTINE MAPPING   (DSM for Open VMS sites only) 
        -----------------------
        Disable routine mapping on all systems for the routines listed in 
        step 3 below.  
  
          NOTE:  If the routines included in this patch are not currently 
          in your mapped routine set, please skip this step.
   
   3.   COMPONENTS SENT WITH PATCH 
        --------------------------
        The following is a list of the routines included in this patch.  
        The second line of each of these routines now looks like: 
   
             <tab>;;5.3;Scheduling;**[patch list]**;Aug 13, 1993 
   
                            CHECK^XTSUMBLD results
  
        Routine          Before Patch     After Patch    Patch List 
        -------          ------------     -----------    ----------
        SDPFSS                    N/A         4979579           430
        SDPFSS2                   N/A         3215276           430  
        SD53430P                  N/A        13969129           430 
        SDVSIT0               4117780         4225469  27,99,132,257,
                                                             430
  
                           CHECK1^XTSUMBLD results
  
        Routine          Before Patch     After Patch    Patch List 
        -------          ------------     -----------    ----------
        SDPFSS                    N/A       18894412        430
        SDPFSS2                   N/A        9459306        430  
        SD53430P                  N/A       59881265        430 
        SDVSIT0              10311012       10655905   27,99,132,257,
                                                             430
                                                     
         Total number of routines - 4
  
  
        New Mail Groups
        ---------------
        SD RSA API ERRORS
          Leave this mail group empty.  It's for use by PFSS-enabled sites
  
        New Bulletins
        -------------
        SD API ERROR NOTICE
  
        New Protocols
        -------------
        PFSS Account Number Driver  [SDAM PFSS EVENT]              
          This protocol will be attached to the SDAM APPOINTMENT EVENTS
          Driver.
  
        The Delete Check Out [SDAM DELETE CHECK OUT] protocol will be
        modified to set and clear a flag which will be used by the new
        functionality. 
   
        The following is a list of fields included in this patch:
        NOTE: This is a new field.
  
        Field Name (Number)           File Name (Number)
        -------------------           ------------------
        APPOINTMENT ENTRY (#.001)     APPOINTMENT PFSS ACCOUNT
                                      REFERENCE (#409.55)
  
        APPOINTMENT DATE/TIME (#.01)  APPOINTMENT PFSS ACCOUNT
                                      REFERENCE (#409.55)
  
        PATIENT (#.02)                APPOINTMENT PFSS ACCOUNT
                                      REFERENCE (#409.55)
  
        CLINIC (#.03)                 APPOINTMENT PFSS ACCOUNT
                                      REFERENCE (#409.55)
  
        PFSS ACCOUNT                  APPOINTMENT PFSS ACCOUNT
        REFERENCE (#.04)              REFERENCE (#409.55)
  
  
        The following is a list of files included in this patch:
  
                                             UP    SEND  DATA
                                             DATE  SEC.  COMES  SITE   RSLV
        FILE #  NAME                         DD    CODE  W/FILE DATA   PTS 
     ------------------------------------------------------------------------
        409.55  APPOINTMENT PFSS ACCOUNT     YES   YES   NO     OVER   NO
                REFERENCE                
  
   NEW GLOBAL ^SD(409.55,
   The following information is provided on the new global defined above,
   global growth is expected to be minimal with this new global.  Only five
   pieces of information will be stored in the global.  Three are pointer
   values and two are numeric.  It is estimated that this global will
   requires less than 5 MB of disk space depending on your sites volume of
   scheduled appointments.
  
  
   4.   START UP KIDS 
        -------------
        Start up the Kernel Installation and Distribution System Menu 
        [XPD MAIN]: 
    
             Edits and Distribution ...  
             Utilities ...  
             Installation ...  
    
   Select Kernel Installation & Distribution System Option: INStallation 
                                                            ---
             Load a Distribution 
             Print Transport Global 
             Compare Transport Global to Current System 
             Verify Checksums in Transport Global 
             Install Package(s) 
             Restart Install of Package(s) 
             Unload a Distribution 
             Backup a Transport Global 
    
   Select Installation Option: 
    
   5.   Select Installation Option: 
        ---------------------------
        NOTE:  The following are OPTIONAL - (When prompted for the INSTALL
               NAME, enter SD*5.3*430):
       
        a.  Backup a Transport Global - This option will create a backup
            message of any routines exported with this patch. It will not
            backup any other changes such as DD's or templates.
        b.  Compare Transport Global to Current System - This option will
            allow you to view all changes that will be made when this patch
            is installed.  It compares all components of this patch
            (routines, DDs, templates, etc.).
        c.  Verify Checksums in Transport Global - This option will allow
            you to ensure the integrity of the routines that are in the
            transport global.
      
   6.   Select Installation Option: Install Package(s) 
                                    ----------------
        **This is the step to start the installation of this KIDS patch: 
    
        a.  Choose the Install Package(s) option to start the patch 
            install.
        b.  When prompted 'Want KIDS to INHIBIT LOGONs during the 
            install? YES//' answer NO 
        c.  When prompted 'Want to DISABLE Scheduled Options, Menu 
            Options, and Protocols? YES//' answer YES
        d.  When prompted 'Enter options you wish to mark as 'Out Of
            Order':'  Enter the following options:
   
            Appointment Management         [SDAM APPT MGT] 
            Appointment Check-in/Check-out [SDAM APPT CHECK IN/OUT]
            Cancel Appointment             [SD CANCEL APPOINTMENT]
            Make Appointment               [SDM]
  
        e.  When prompted 'Enter protocols you wish to mark as 'Out Of 
            Order':' Enter the following options:
  
               Delete Check Out         [SDAM DELETE CHECK OUT]
               Appointment Event Driver [SDAM APPOINTMENT EVENTS]
  
  
   7.   REBUILD MAPPED ROUTINE(S)  (DSM for Open VMS sites only)
       -------------------------
       Optional - Include the routines distributed with this patch
       in the mapped routine set.
      
       NOTE: This step is only necessary if you performed step 2 or 
             if you wish to include the routines in your mapped set.
  
  
 Post-Installation
 -----------------
  
 1.  When your site is directed to implement PFSS by enabling the the PFSS
 On/Off Switch, you will need to enter at least one member to the SD RSA
 API ERRORS mail group.  This mail group will receive any notifications
 generated by the PFSS Account Number Driver protocol.  If there are no
 members assigned, no messages will be generated.

Routine Information:
====================
The checksums below are new checksums, and
 can be checked with CHECK1^XTSUMBLD.

Routine Name: SD53430P
    Before:            After: B59881265  **430**
Routine Name: SDPFSS
    Before:            After: B18894412  **430**
 Description of Changes:
  This is a new routine.

Routine Name: SDPFSS2
    Before:            After:  B9459306  **430**
 Description of Changes:
  This is a new routine.

Routine Name: SDVSIT0
    Before: B10311012  After: B10655905  **27,99,132,257,430**
 Description of Changes:
  Before
  ======
   
   46        I $G(SDVSIT("LOC")) S VSIT("LOC")=SDVSIT("LOC")
   47        I $G(SDVSIT("PAR")) S X=$G(^SCE(SDVSIT("PAR"),0)) I X]"" S VSIT=+X I
               $P(X,U,5) S VSIT("LNK")=$P(X,U,5)
   48        I $G(VSIT("LNK")) D  ;PX/96 - accept passed INSTITUTION
   49        .N DR,DIC,DA,DIQ,INST,DIC1
   50        .S DR=".06",DIC=9000010,DIC1=DIC,DA=VSIT("LNK"),DIQ="INST",DIQ(0)="I
              " D EN^DIQ1
   51        .S VSIT("INS")=+$G(INST(DIC1,DA,DR,"I"))
   52        .I VSIT("INS")'>0 S VSIT("INS")=$P($G(^DG(40.8,+$G(SDVSIT("DIV")),0)
              ),U,7)
   53        .Q
   
   
  After
  =====
   
   46        I $G(SDVSIT("LOC")) S VSIT("LOC")=SDVSIT("LOC")
   47        I $G(SDVSIT("PAR")) S X=$G(^SCE(SDVSIT("PAR"),0)) I X]"" S VSIT=+X I
               $P(X,U,5) S VSIT("LNK")=$P(X,U,5)
   48        S VSIT("ACT")=$$GETARN^SDPFSS2(SDT,DFN,$G(SDVSIT("LOC")))
   49        I $G(VSIT("LNK")) D  ;PX/96 - accept passed INSTITUTION
   50        .N DR,DIC,DA,DIQ,INST,DIC1
   51        .S DR=".06",DIC=9000010,DIC1=DIC,DA=VSIT("LNK"),DIQ="INST",DIQ(0)="I
              " D EN^DIQ1
   52        .S VSIT("INS")=+$G(INST(DIC1,DA,DR,"I"))
   53        .I VSIT("INS")'>0 S VSIT("INS")=$P($G(^DG(40.8,+$G(SDVSIT("DIV")),0)
              ),U,7)
   54        .Q


=============================================================================
User Information:                          Hold Date     : MAR 06, 2006
Entered By  : KOPECKY,STEPHEN C.            Date Entered  : FEB 23, 2005
Completed By: LYNCH,MARY F.                 Date Completed: MAR 09, 2006
Released By : CANNEDY,JOELLEN               Date Released : MAR 09, 2006
=============================================================================


Packman Mail Message:
=====================

$END TXT
