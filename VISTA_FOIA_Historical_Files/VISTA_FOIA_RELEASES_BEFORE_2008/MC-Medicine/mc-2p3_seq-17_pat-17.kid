Released MC*2.3*17 SEQ #17
Extracted from mail message
**KIDS**:MC*2.3*17^

**INSTALL NAME**
MC*2.3*17
"BLD",261,0)
MC*2.3*17^MEDICINE^0^2980318^y
"BLD",261,1,0)
^^1^1^2980318^
"BLD",261,1,1,0)
Refer to the Patch Description of the patch.
"BLD",261,4,0)
^9.64PA^^
"BLD",261,"KRN",0)
^9.67PA^19^18
"BLD",261,"KRN",.4,0)
.4
"BLD",261,"KRN",.401,0)
.401
"BLD",261,"KRN",.402,0)
.402
"BLD",261,"KRN",.403,0)
.403
"BLD",261,"KRN",.5,0)
.5
"BLD",261,"KRN",.84,0)
.84
"BLD",261,"KRN",3.6,0)
3.6
"BLD",261,"KRN",3.8,0)
3.8
"BLD",261,"KRN",9.2,0)
9.2
"BLD",261,"KRN",9.8,0)
9.8
"BLD",261,"KRN",9.8,"NM",0)
^9.68A^8^8
"BLD",261,"KRN",9.8,"NM",1,0)
MCBPFTP1^^0^B22140924
"BLD",261,"KRN",9.8,"NM",2,0)
MCBPFTP2^^0^B10135980
"BLD",261,"KRN",9.8,"NM",3,0)
MCBPFTP3^^0^B9269912
"BLD",261,"KRN",9.8,"NM",4,0)
MCEO^^0^B3289092
"BLD",261,"KRN",9.8,"NM",5,0)
MCOR1^^0^B9282543
"BLD",261,"KRN",9.8,"NM",6,0)
MCPFTP^^0^B2782684
"BLD",261,"KRN",9.8,"NM",7,0)
MCOR^^0^B22696878
"BLD",261,"KRN",9.8,"NM",8,0)
MCOREX^^0^B4961082
"BLD",261,"KRN",9.8,"NM","B","MCBPFTP1",1)

"BLD",261,"KRN",9.8,"NM","B","MCBPFTP2",2)

"BLD",261,"KRN",9.8,"NM","B","MCBPFTP3",3)

"BLD",261,"KRN",9.8,"NM","B","MCEO",4)

"BLD",261,"KRN",9.8,"NM","B","MCOR",7)

"BLD",261,"KRN",9.8,"NM","B","MCOR1",5)

"BLD",261,"KRN",9.8,"NM","B","MCOREX",8)

"BLD",261,"KRN",9.8,"NM","B","MCPFTP",6)

"BLD",261,"KRN",19,0)
19
"BLD",261,"KRN",19.1,0)
19.1
"BLD",261,"KRN",101,0)
101
"BLD",261,"KRN",409.61,0)
409.61
"BLD",261,"KRN",771,0)
771
"BLD",261,"KRN",869.2,0)
869.2
"BLD",261,"KRN",870,0)
870
"BLD",261,"KRN",8994,0)
8994
"BLD",261,"KRN","B",.4,.4)

"BLD",261,"KRN","B",.401,.401)

"BLD",261,"KRN","B",.402,.402)

"BLD",261,"KRN","B",.403,.403)

"BLD",261,"KRN","B",.5,.5)

"BLD",261,"KRN","B",.84,.84)

"BLD",261,"KRN","B",3.6,3.6)

"BLD",261,"KRN","B",3.8,3.8)

"BLD",261,"KRN","B",9.2,9.2)

"BLD",261,"KRN","B",9.8,9.8)

"BLD",261,"KRN","B",19,19)

"BLD",261,"KRN","B",19.1,19.1)

"BLD",261,"KRN","B",101,101)

"BLD",261,"KRN","B",409.61,409.61)

"BLD",261,"KRN","B",771,771)

"BLD",261,"KRN","B",869.2,869.2)

"BLD",261,"KRN","B",870,870)

"BLD",261,"KRN","B",8994,8994)

"BLD",261,"QUES",0)
^9.62^^
"BLD",261,"REQB",0)
^9.611^^
"OER",114,0)
114^^1^^
"OER",114,4)
K MCGLO,MCNAM
"PKG",114,-1)
1^1
"PKG",114,0)
MEDICINE^MC^MEDICINE PACKAGE INCLUDES ALL AREAS OF MEDICINE
"PKG",114,22,0)
^9.49I^1^1
"PKG",114,22,1,0)
2.3^2960913
"PKG",114,22,1,"PAH",1,0)
17^2980318
"PKG",114,22,1,"PAH",1,1,0)
^^1^1^2980403
"PKG",114,22,1,"PAH",1,1,1,0)
Refer to the Patch Description of the patch.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
8
"RTN","MCBPFTP1")
0^1^B22140924
"RTN","MCBPFTP1",1,0)
MCBPFTP1 ;WISC/TJK,ALG-PFT BRIEF REPORT-DEMO INFO ;5/15/96  16:04
"RTN","MCBPFTP1",2,0)
 ;;2.3;Medicine;**5,14,16,17**;09/13/1996
"RTN","MCBPFTP1",3,0)
 ; ------------------------
"RTN","MCBPFTP1",4,0)
 ; SSN = Enternal Format of the patients SSN with the first letter
"RTN","MCBPFTP1",5,0)
 ; of the last name tacked on the end
"RTN","MCBPFTP1",6,0)
 ; ------------------------
"RTN","MCBPFTP1",7,0)
 D DEM^VADPT S MCARGNM=VADM(1),SSN=VA("PID")
"RTN","MCBPFTP1",8,0)
 S X1=$E($P(MCPFT0,U),1,7),X2=$P(VADM(3),U)
"RTN","MCBPFTP1",9,0)
 ; ---------------------
"RTN","MCBPFTP1",10,0)
 ; AGE = the patients age at the date of the procedure
"RTN","MCBPFTP1",11,0)
 ; ---------------------
"RTN","MCBPFTP1",12,0)
 S AGE=$E(X1,1,3)-$E(X2,1,3)-($E(X1,4,7)<$E(X2,4,7))
"RTN","MCBPFTP1",13,0)
 S RACE=$P(VADM(8),U,2),CLIN="" S:$P(MCPFT0,U,10) CLIN=$P(MCPFT0,U,10) I CLIN,$D(^SC(CLIN,0)) S CLIN=$P(^(0),U)
"RTN","MCBPFTP1",14,0)
 S DATE=$P(MCPFT0,U),DATE=+$E(DATE,4,5)_"/"_+$E(DATE,6,7)_"/"_$E(DATE,2,3)_$S($P(DATE,".",2):"@"_+$E(DATE,9,10)_":"_$S($L($E(DATE,11,12))=2:$E(DATE,11,12),$L($E(DATE,11,12))=1:$E(DATE,11)_"0",1:"00"),1:"")
"RTN","MCBPFTP1",15,0)
 S HT1=$P(MCPFT0,U,4),WT1=$P(MCPFT0,U,5) S $P(MCDOT,".",81)=""
"RTN","MCBPFTP1",16,0)
 S HT=HT1*2.54,WT=WT1/2.2
"RTN","MCBPFTP1",17,0)
 S:'HT HT=$P(MCPFT0,U,3),HT1=HT/2.54 S:'WT WT=$P(MCPFT0,U,6),WT1=WT*2.2
"RTN","MCBPFTP1",18,0)
 S (MC17,MCEFF,MCSEX)="" S:$D(^MCAR(700,MCARGDA,17)) MC17=^(17),MCEFF=$P(MC17,U,6),MCEFF=$S(MCEFF="G":"GOOD",MCEFF="E":"EXCELLENT",MCEFF="P":"POOR",1:"")
"RTN","MCBPFTP1",19,0)
 ;S MCSEX=$P(VADM(5),U),X=$P(VADM(3),"^",2) S MCARDOB=$S(X'="":X,1:""),X=$P(MCPFT0,U) D DTIME^MCARP S MCARGDT=X,MCARZ="PULMONARY FUNCTION TEST"
"RTN","MCBPFTP1",20,0)
 S MCSEX=$P(VADM(5),U),X=$P(VADM(3),"^",2) S MCARDOB=$S(X'="":X,1:""),X=$P(MCPFT0,U),MCARGDT=X,MCARZ="PULMONARY FUNCTION TEST"
"RTN","MCBPFTP1",21,0)
 D INP^VADPT S MCARWARD=$S(VAIN(4)'="":$P(VAIN(4),U,2),1:"NOT INPATIENT"),MCARRB=VAIN(5) D NOW^%DTC S X=% D DTIME^MCARP S MCARDTM=X
"RTN","MCBPFTP1",22,0)
 S MCARZ="PULMONARY FUNCTION TEST"
"RTN","MCBPFTP1",23,0)
 D INIT^MCARP1(MCARZ,MCARGDT,MCFILE),HEAD^MCARP
"RTN","MCBPFTP1",24,0)
 W !,"SEX: ",MCSEX,"  AGE:",AGE,?30,HT1," in/",WT1," lb",?60,"AMBIENT: ",$P(MCPFT0,U,12),"C/",$P(MCPFT0,U,7),"T" K HT1,WT1
"RTN","MCBPFTP1",25,0)
 W !,RACE S TECH=$$GETVALUE^MCU(700,MCARGDA,34)
"RTN","MCBPFTP1",26,0)
 W ?60,"TECH: ",$E(TECH,1,14)
"RTN","MCBPFTP1",27,0)
 W !,$S($P(MCPFT0,U,8)="Y":"SMOKER",$P(MCPFT0,U,8)="N":"NON-SMOKER",1:"")
"RTN","MCBPFTP1",28,0)
 W ?30 W:$P(MCPFT0,U,9)="Y" "CURRENT BRONCHODILATOR USE"
"RTN","MCBPFTP1",29,0)
 W ?60,"EFFORT: ",MCEFF
"RTN","MCBPFTP1",30,0)
 S MCFF="S DN=1,MCY="""" I $Y>(IOSL-3) R:$E(IOST,1,2)=""C-"" !!,""Press Return to Continue, '^' to escape: "",MCY:DTIME S:'$T MCY=U S:MCY=U MCOUT=1,DN=0 Q:$D(MCOUT)  D:DN HEAD^MCARP D:$D(HEAD1) HEAD1^MCBPFTP2,HEAD2^MCBPFTP2 K MCY"
"RTN","MCBPFTP1",31,0)
 K ^UTILITY("DIQ1",$J) W !!,"CONSULT DX: " S DR(700.01)=.01,DIQ(0)="E",DIC="^MCAR(700,"
"RTN","MCBPFTP1",32,0)
 F K=0:0 S K=$O(^MCAR(700,MCARGDA,1,K)) Q:K'?1N.N  S DA=MCARGDA,DA(700.01)=K,DR=11,DIQ(0)="E" D EN^DIQ1 W ?15,^UTILITY("DIQ1",$J,700.01,K,.01,"E"),! X MCFF Q:$D(MCOUT)
"RTN","MCBPFTP1",33,0)
 K ^UTILITY("DIQ1",$J),DIQ Q:$D(MCOUT)  W !,MCDOT X MCFF Q:$D(MCOUT)  D PRED
"RTN","MCBPFTP1",34,0)
 S RDATE=9999999.9999-$P(MCPFT0,U)
"RTN","MCBPFTP1",35,0)
 W:$D(MCRCN) !,MCRCN D ^MCBPFTP2
"RTN","MCBPFTP1",36,0)
 I '$D(MCOUT),$G(MCESON) D FOOTER^MCESPRT(MCFILE,MCARGDA)  ;PATCH 28
"RTN","MCBPFTP1",37,0)
EXIT D:$D(ZTSK) KILL^%ZTLOAD K ZTSK
"RTN","MCBPFTP1",38,0)
EXIT1 D KVAR^VADPT K MCOUT,ACT,AGE,CK,CLIN,D0,D1,DA,DATE,CI95
"RTN","MCBPFTP1",39,0)
 K MCARGDT2
"RTN","MCBPFTP1",40,0)
 K BSA,HB,PH,PACO2,PAO2,O2HB,COHB,FIO2,MHB,PAAO2,QSQT,CAO2,CVO2
"RTN","MCBPFTP1",41,0)
 K DFN,DIC,DIW,DIWL,DIWR,DIWT,DLCOSB,DN,MCDOT,DR,FEV1,FRC,FVC,MC17
"RTN","MCBPFTP1",42,0)
 K HT,I,J,K,MCARGDA,MCARGNM,MCFF,MCK,MCN,MCPI,MCREC,MCREC1,MCVCN
"RTN","MCBPFTP1",43,0)
 K MCREC2,MCTLCN,MCVN,MCX,MEAS,FEF2575,ND,ND1,P1,P2,PC,PD1,PD11,MCEFF
"RTN","MCBPFTP1",44,0)
 K PD2,PD21,PF,MCPFT0,PG,PRED,MCPV,RACE,RDATE,RDATE1,RDATE2,RV,MCSEX
"RTN","MCBPFTP1",45,0)
 K SSN,TAB,TECH,TLC,TYPE,UNIT,UNITS,VC,WT,X,Z,VA,MCRCN
"RTN","MCBPFTP1",46,0)
 K MCMVVN,MVV,PMVV,MCSP,MCP1S0,MCP1S1,MCP1S2,MCP2S0,MCP2S1,MCP2S2
"RTN","MCBPFTP1",47,0)
 K CDLCOSB,MCIAO1,MCIAO2,MCIDA,MCIDL,MCIDP,MCIFA,MCIFE
"RTN","MCBPFTP1",48,0)
 K MCIFL,MCIFV,MCIPTL,MCIRV,MCITL,MCMAIN,MCP1,MCP2,MCRC,MCRCR,MCTYPEP,MCY,MCRC1,MCRC2,MCRC3,MCRC4   ;,MCARGDA
"RTN","MCBPFTP1",49,0)
 K MCARRB,MCARDOB,MCARWARD,MCARDTM,MCARHDR,MCARZ,MCARGDT,MCDL,MCLNG D KVAR^VADPT D ^%ZISC Q
"RTN","MCBPFTP1",50,0)
PRED S (FVC,CFVC,FEV1,F,TLC,MVV)=""
"RTN","MCBPFTP1",51,0)
 Q:'HT!'WT!'AGE!'$D(^MCAR(700,MCARGDA,"PV"))  Q:'(^("PV"))
"RTN","MCBPFTP1",52,0)
 S MCPV=^MCAR(700,MCARGDA,"PV") Q:'$D(^MCAR(700.1,MCPV))
"RTN","MCBPFTP1",53,0)
 S BSA=$$BSA^MCPFTP1(HT,WT)
"RTN","MCBPFTP1",54,0)
 F I="FEV1","FVC","TLC","MVV" D
"RTN","MCBPFTP1",55,0)
    .S:$D(^MCAR(700.1,MCPV,I)) @("P"_I)="S "_I_"="_$P(^MCAR(700.2,^MCAR(700.1,MCPV,I),0),U),@("C"_I)=$P(^MCAR(700.2,^MCAR(700.1,MCPV,I),0),U,5) X:$D(^MCAR(700.1,MCPV,I)) @("P"_I)
"RTN","MCBPFTP1",56,0)
 K PDLCOSB,PFEV1,PFRC,PFVC,PFEF2575,PPF,PRV,PTLC,PVC
"RTN","MCBPFTP1",57,0)
 S MCRCR="",MCRC=$G(^MCAR(700.1,MCPV,"RC")) Q:MCRC=""
"RTN","MCBPFTP1",58,0)
 S MCRCR=$G(^MCAR(700,MCARGDA,17)) Q:MCRCR=""  Q:$P(MCRCR,U,5)'="Y"
"RTN","MCBPFTP1",59,0)
 S MCRCR=$S(RACE["BLACK":"B",RACE["ASIAN":"O",1:"") Q:MCRCR=""
"RTN","MCBPFTP1",60,0)
 F I=1:1:4 I $P(MCRC,U,I) S J=$P(MCRC,U,I) D:J
"RTN","MCBPFTP1",61,0)
    .Q:'$D(^MCAR(700.2,J,0))  S J=$P(^(0),U,1)
"RTN","MCBPFTP1",62,0)
    .S @("MCRC"_I)="S PRED="_J
"RTN","MCBPFTP1",63,0)
 K J G ORIENTAL:MCRCR="O" K MCRC2
"RTN","MCBPFTP1",64,0)
 I '$D(MCRC1),'$D(MCRC3),'$D(MCRC4) Q
"RTN","MCBPFTP1",65,0)
 S:$D(MCRC1) MCRCN="TLC,FVC,FEV1" S:$D(MCRC3) MCRCN=MCRCN_",FRC,RV" S:$D(MCRC4) MCRCN=MCRCN_",FEF25-75" S:$E(MCRCN,1)="," MCRCN=$E(MCRCN,2,30)
"RTN","MCBPFTP1",66,0)
 G NOTE
"RTN","MCBPFTP1",67,0)
ORIENTAL I '$D(MCRC2) K MCRC1,MCRC3,MCRC4 Q
"RTN","MCBPFTP1",68,0)
 S MCRC1=MCRC2 K MCRC3,MCRC4 S MCRCN="TLC,FVC,FEV1"
"RTN","MCBPFTP1",69,0)
NOTE S MCRCN="NOTE:   Race Correction done on predicted values for: "_MCRCN
"RTN","MCBPFTP1",70,0)
 Q
"RTN","MCBPFTP2")
0^2^B10135980
"RTN","MCBPFTP2",1,0)
MCBPFTP2 ;WISC/TJK,ALG-PFT BRIEF REPORT-VOLUMES ;2/24/98  15:42
"RTN","MCBPFTP2",2,0)
 ;;2.3;Medicine;**17**;09/13/1996
"RTN","MCBPFTP2",3,0)
 D SETVAR G FLOW:'$D(^MCAR(700,MCARGDA,3)),FLOW:'$O(^(3,0)) S MCX=0
"RTN","MCBPFTP2",4,0)
 S HEAD1="VOLUMES" D HEAD1,HEAD2 Q:$D(MCOUT)
"RTN","MCBPFTP2",5,0)
VOL S MCMAIN=0,MCX=$O(^MCAR(700,MCARGDA,3,MCX)) G FLOW:MCX'?1N.N S MCREC=^(MCX,0),TYPE=$P(MCREC,U) S:(TYPE="I")!(TYPE="B") MCMAIN=1
"RTN","MCBPFTP2",6,0)
 S ND="AV",ND1=3 D PRETEST
"RTN","MCBPFTP2",7,0)
 W !,?5,$S(TYPE="B":"BODY BOX",TYPE="I":"INERT GAS DILUTION",TYPE="N":"NITROGEN WASH OUT",1:"X-RAY PLANIMETRY") D PREVDATE
"RTN","MCBPFTP2",8,0)
 I $P(MCREC,U,6)'="" W !,?5,"(NOTES): ",$P(MCREC,U,6) X MCFF Q:$D(MCOUT)
"RTN","MCBPFTP2",9,0)
 S ACT=$P(MCREC,U,2) I ACT S MEAS="TLC",UNITS="L",PRED=TLC X:$D(MCRC1) MCRC1 S PC=2,CI95=$S(PRED:PRED-CTLC,1:"") D PRTLINE Q:$D(MCOUT)  S:MCMAIN MCTLCN=ACT,MCITL=CI95,MCIPTL=PRED
"RTN","MCBPFTP2",10,0)
 W ! G VOL
"RTN","MCBPFTP2",11,0)
FLOW K CTLC,CVC,CFRC,CRV G ^MCBPFTP3
"RTN","MCBPFTP2",12,0)
EXIT Q
"RTN","MCBPFTP2",13,0)
SETVAR S (MCVCN,MCTLCN,MCMVVN,MCIRV,MCIFA,MCIFL,MCIPTL,MCIFE,MCIFV,MCIDA,MCIDL,MCIDP,MCIAO2,MCIAO1,MCITL)="",MCDL=2,MCLNG=5,PRED=0 Q
"RTN","MCBPFTP2",14,0)
PRTLINE S MCP1=$G(MCP1),MCP2=$G(MCP2)
"RTN","MCBPFTP2",15,0)
 W !,?5,MEAS,?18,UNITS,?25,$S(PRED:$J(PRED,MCLNG,MCDL),1:""),?35,$J(ACT,MCLNG,MCDL),?45,$S(PRED:$J(ACT/PRED*100,5,1),1:"") W:$P(MCP1,U,PC) ?55,$J($P(MCP1,U,PC),MCLNG,MCDL) W:$P(MCP2,U,PC) ?65,$J($P(MCP2,U,PC),MCLNG,MCDL)
"RTN","MCBPFTP2",16,0)
 W:(CI95)&(CI95'=PRED) ?72,$J(CI95,6,2) X MCFF Q
"RTN","MCBPFTP2",17,0)
HEAD S PG=PG+1 W @IOF,!!,?22,"CONFIDENTIAL PULMONARY FUNCTION REPORT",?70,"Page: ",PG
"RTN","MCBPFTP2",18,0)
 W !,VADM(1),?60,SSN
"RTN","MCBPFTP2",19,0)
 W !,CLIN,?60,"DATE: "_DATE
"RTN","MCBPFTP2",20,0)
 W !,MCDOT
"RTN","MCBPFTP2",21,0)
 Q
"RTN","MCBPFTP2",22,0)
HEAD1 W !! X MCFF Q:$D(MCOUT)  W ?15,"UNITS",?25,$S('$D(MCSP):"PRED",1:""),?35,"ACTUAL",?45,$S('$D(MCSP):"%PRED",1:""),?55,"PREV1",?65,"PREV2" W:'$D(MCSP) ?73,"LCI" X MCFF Q
"RTN","MCBPFTP2",23,0)
HEAD2 Q:$D(MCOUT)  W !,HEAD1,$E(MCDOT,1,80-$L(HEAD1)),! X MCFF Q
"RTN","MCBPFTP2",24,0)
PREVDATE F I="RDATE1","RDATE2" I $D(@I),@I S X=9999999.9999-@I S TAB=$S(I="RDATE1":"?55",1:"?65") W @TAB,+$E(X,4,5),"/",+$E(X,6,7),"/",$E(X,2,3)
"RTN","MCBPFTP2",25,0)
 Q
"RTN","MCBPFTP2",26,0)
PRETEST S (MCP1,MCP2,MCP1S0,MCP2S0,MCP1S1,MCP1S2,MCP2S1,MCP2S2,RDATE1,RDATE2)="" Q:'$O(^MCAR(700,ND,DFN,TYPE,RDATE))
"RTN","MCBPFTP2",27,0)
 S RDATE1=$O(^MCAR(700,ND,DFN,TYPE,RDATE)),PD11=$O(^(RDATE1,0)),PD1=$O(^(PD11,0))
"RTN","MCBPFTP2",28,0)
 S (MCP1,MCP1S0)=^MCAR(700,PD11,ND1,PD1,0) I ND="AS" S:$D(^(1)) MCP1S1=^(1) S:$D(^(2)) MCP1S2=^(2)
"RTN","MCBPFTP2",29,0)
 K PD1,PD11 Q:'$O(^MCAR(700,ND,DFN,TYPE,RDATE1))
"RTN","MCBPFTP2",30,0)
 S RDATE2=$O(^MCAR(700,ND,DFN,TYPE,RDATE1)),PD21=$O(^(RDATE2,0)),PD2=$O(^(PD21,0))
"RTN","MCBPFTP2",31,0)
 S (MCP2,MCP2S0)=^MCAR(700,PD21,ND1,PD2,0) I ND="AS" S:$D(^(1)) MCP2S1=^(1) S:$D(^(2)) MCP2S2=^(2)
"RTN","MCBPFTP2",32,0)
 K PD2,PD21 Q
"RTN","MCBPFTP3")
0^3^B9269912
"RTN","MCBPFTP3",1,0)
MCBPFTP3 ;WISC/TJK,ALG-PFT BRIEF REPORT-FLOWS ;4/9/96  09:01
"RTN","MCBPFTP3",2,0)
 ;;2.3;Medicine;**17**;09/13/1996
"RTN","MCBPFTP3",3,0)
FLOW G ABG:'$D(^MCAR(700,MCARGDA,4)),ABG:'$O(^(4,0)) S MCX=0
"RTN","MCBPFTP3",4,0)
 I '$D(HEAD1) S HEAD1="FLOWS" D HEAD1^MCBPFTP2,HEAD2^MCBPFTP2
"RTN","MCBPFTP3",5,0)
 E  S HEAD1="FLOWS" D HEAD2^MCBPFTP2
"RTN","MCBPFTP3",6,0)
 Q:$D(MCOUT)
"RTN","MCBPFTP3",7,0)
 I MC17'="" S MC17A=$P(MC17,U,2) W ?3,"MACHINE: ",$S(MC17A="F":"FLOW TURBINE",MC17A="P":"PNEUMOTACH",MC17A="A":"ANEMOMETER",MC17A="DS":"DRY WATER SEAL",MC17A="WS":"WATER SEAL",MC17A="W":"WEDGE",1:"") X MCFF K MC17A Q:$D(MCOUT)
"RTN","MCBPFTP3",8,0)
FLOW1 S MCX=$O(^MCAR(700,MCARGDA,4,MCX)) G ABG:MCX'?1N.N S MCREC=^(MCX,0),TYPE=$P(MCREC,U)
"RTN","MCBPFTP3",9,0)
 W !! X MCFF Q:$D(MCOUT)
"RTN","MCBPFTP3",10,0)
 S ND="AF",ND1=4 D PRETEST^MCBPFTP2
"RTN","MCBPFTP3",11,0)
 W ?5,$S(TYPE="S":"STANDARD STUDY",TYPE="B":"AFTER BRONCHODILATOR",TYPE="I":"AFTER INHALATION CHALLENGE",1:"AFTER EXERCISE") X MCFF Q:$D(MCOUT)  D PREVDATE^MCBPFTP2
"RTN","MCBPFTP3",12,0)
 I $P(MCREC,U,6)'="" W !,?5,"(NOTES): ",$P(MCREC,U,6) X MCFF Q:$D(MCOUT)
"RTN","MCBPFTP3",13,0)
 S ACT=$P(MCREC,U,2) I ACT S MEAS="FVC",UNITS="L",PRED=FVC X:$D(MCRC1) MCRC1 S PC=2,CI95=$S(PRED:PRED-CFVC,1:"") D PRTLINE S:TYPE="S" MCIFA=ACT,MCIFL=CI95 Q:$D(MCOUT)
"RTN","MCBPFTP3",14,0)
 S ACT=$P(MCREC,U,3) I ACT S MEAS="FEV1",UNITS="L",PRED=FEV1 X:$D(MCRC1) MCRC1 S PC=3,CI95=$S(PRED:PRED-CFEV1,1:"") D PRTLINE S:TYPE="S" MCIFE=ACT Q:$D(MCOUT)
"RTN","MCBPFTP3",15,0)
 S MCDL=2,MCLNG=5,ACT=$P(MCREC,U,7) I ACT S MEAS="MVV",UNITS="L/MIN",PRED=MVV,PC=7,CI95=$S(PRED:PRED-CMVV,1:"") S:TYPE="S" MCMVVN=ACT D PRTLINE Q:$D(MCOUT)
"RTN","MCBPFTP3",16,0)
 ;write out actual FEV1/FVC*100 from elements in MCREC 
"RTN","MCBPFTP3",17,0)
 I $P(MCREC,U,2),$P(MCREC,U,3) W !,?5,"FEV1/FVC",?17,"%" S ACT=$P(MCREC,U,3)/$P(MCREC,U,2) W ?35,$J(ACT*100,5,0) S:TYPE="S" MCIFV=ACT X MCFF Q:$D(MCOUT)
"RTN","MCBPFTP3",18,0)
 G FLOW1
"RTN","MCBPFTP3",19,0)
ABG G ^MCBPFTP4
"RTN","MCBPFTP3",20,0)
PRTLINE S MCP1=$G(MCP1),MCP2=$G(MCP2)
"RTN","MCBPFTP3",21,0)
 W !,?5,MEAS,?15,UNITS,?25,$S(PRED:$J(PRED,MCLNG,MCDL),1:""),?35,$J(ACT,MCLNG,MCDL),?45,$S(PRED:$J(ACT/PRED*100,5,1),1:"") W:$P(MCP1,U,PC) ?55,$J($P(MCP1,U,PC),MCLNG,MCDL) W:$P(MCP2,U,PC) ?65,$J($P(MCP2,U,PC),MCLNG,MCDL)
"RTN","MCBPFTP3",22,0)
 W:(CI95)&(CI95'=PRED) ?72,$J(CI95,6,2) X MCFF Q
"RTN","MCEO")
0^4^B3289092
"RTN","MCEO",1,0)
MCEO ;WISC/MLH-MED PROC EDIT, OE INTERFACE ;4/2/98  15:19
"RTN","MCEO",2,0)
 ;;2.3;Medicine;**17**;09/13/1996
"RTN","MCEO",3,0)
 ;
"RTN","MCEO",4,0)
IN ;
"RTN","MCEO",5,0)
 N DA,DIC,DIE,DR
"RTN","MCEO",6,0)
 S MCFILE1=MCFILE
"RTN","MCEO",7,0)
 I '$D(MCOEON) D ORDER^MCPARAM
"RTN","MCEO",8,0)
 IF $D(MCOEON) D  ;    order entry flag on
"RTN","MCEO",9,0)
 .  N MCFILE1
"RTN","MCEO",10,0)
 .  S GMRCPRNM=$P(^MCAR(697.2,MCARGNUM,0),U,8)
"RTN","MCEO",11,0)
 .  S GMRCSR=MCARGDA_";"_"MCAR("_MCFILE_",",GMRCSS=""
"RTN","MCEO",12,0)
 .  IF $D(^MCAR(MCFILE,MCARGDA,"OR")),$P(^("OR"),U,2) S GMRCO=$P(^("OR"),U,2),ORIFN=$P(^("OR"),U)
"RTN","MCEO",13,0)
 .  ELSE  D
"RTN","MCEO",14,0)
 ..    S GMRCSS=$G(GMRCSS) ; WAA
"RTN","MCEO",15,0)
 ..    K GMRCPNM D EN^GMRCR
"RTN","MCEO",16,0)
 ..    I '$D(DTOUT),'$D(DUOUT) S ^MCAR(MCFILE,MCARGDA,"OR")=$G(ORIFN)_U_$G(GMRCO)
"RTN","MCEO",17,0)
 ..    Q
"RTN","MCEO",18,0)
 .  ;END IF
"RTN","MCEO",19,0)
 .  ;
"RTN","MCEO",20,0)
 .  Q
"RTN","MCEO",21,0)
 ;END IF
"RTN","MCEO",22,0)
 ;
"RTN","MCEO",23,0)
 S MCFILE=MCFILE1
"RTN","MCEO",24,0)
 QUIT
"RTN","MCEO",25,0)
 ;
"RTN","MCEO",26,0)
OUT ;
"RTN","MCEO",27,0)
 N DONE
"RTN","MCEO",28,0)
 IF $D(MCOEON) D  I 1 ;    order entry flag on
"RTN","MCEO",29,0)
 .  IF $D(^MCAR(MCFILE,MCARGDA)) D  I 1 ;    a record on file
"RTN","MCEO",30,0)
 ..    IF $D(DTOUT) D  I 1 ;    timeout
"RTN","MCEO",31,0)
 ...      S ORSTS=9
"RTN","MCEO",32,0)
 ...      D RESULT^GMRCR
"RTN","MCEO",33,0)
 ...      S DONE=1
"RTN","MCEO",34,0)
 ...      Q
"RTN","MCEO",35,0)
 ..    ELSE  D  ;    no timeout
"RTN","MCEO",36,0)
 ...      S DIR(0)="Y",DIR("A")="ORDER COMPLETE",DIR("B")="YES"
"RTN","MCEO",37,0)
 ...      D ^DIR
"RTN","MCEO",38,0)
 ...      I Y S ORSTS=2
"RTN","MCEO",39,0)
 ...      E  S ORSTS=9
"RTN","MCEO",40,0)
 ...      D RESULT^GMRCR
"RTN","MCEO",41,0)
 ...      Q
"RTN","MCEO",42,0)
 ..    ;END IF
"RTN","MCEO",43,0)
 ..    ;
"RTN","MCEO",44,0)
 ..    Q
"RTN","MCEO",45,0)
 .  ELSE  S DONE=1 ;    no record on file
"RTN","MCEO",46,0)
 .  ;END IF
"RTN","MCEO",47,0)
 .  ;
"RTN","MCEO",48,0)
 .  Q
"RTN","MCEO",49,0)
 ;END IF
"RTN","MCEO",50,0)
 ;
"RTN","MCEO",51,0)
 I '$G(DONE),'$D(DTOUT),'$D(DUOUT) D EN1^MCMAG ;    imaging link
"RTN","MCEO",52,0)
 QUIT
"RTN","MCOR")
0^7^B22696878
"RTN","MCOR",1,0)
MCOR ;WISC/TJK-OERR/MEDICINE PACKAGE LINKS ;4/2/98  15:28
"RTN","MCOR",2,0)
 ;;2.3;Medicine;**17**;09/13/1996
"RTN","MCOR",3,0)
PRINT Q:ORACTION'=8  Q:'$D(GMRCSR)  Q:'$D(GMRCPRNM)  Q:'$D(^MCAR(697.2,"BA",GMRCPRNM))
"RTN","MCOR",4,0)
 K ^TMP("MC",$J) S MCFILE=+$P($P(GMRCSR,";",2),"MCAR(",2),MCARGDA=$P(GMRCSR,";"),MCK=0
"RTN","MCOR",5,0)
 I $G(MCESON),('$$SCRSUMPT^MCESSCR(MCFILE,MCARGDA)) S ^TMP("MC",$J,"S")="This report is not authorized for Release" Q
"RTN","MCOR",6,0)
 S MCSMR="" S:$D(^MCAR(MCFILE,MCARGDA,.2)) MCSMR=^(.2)
"RTN","MCOR",7,0)
 S K=$P(MCSMR,U),K=$S(K="N"!(K="L"):"NORMAL",K="A":"ABNORMAL",K="B":"BORDERLINE",K="T":"TECHNICALLY UNSATISFACTORY",K="ND":"NON-DIAGNOSTIC",K="MI":"MILDLY ABNORMAL",K="MO":"MODERATELY ABNORMAL",K="S":"SEVERELY ABNORMAL",1:"")
"RTN","MCOR",8,0)
 K ^TMP("MC",$J) S ^TMP("MC",$J,"S")=K_U_$P(MCSMR,U,2)
"RTN","MCOR",9,0)
 S MCARGNUM=$O(^MCAR(697.2,"BA",GMRCPRNM,0))
"RTN","MCOR",10,0)
 I MCFILE=699 S MCARCODE=$P($G(^MCAR(697.2,MCARGNUM,0)),U,4) D ENDO G EXIT
"RTN","MCOR",11,0)
 S MCBRANCH=$S(MCFILE=691:"ECHO",MCFILE=691.1:"CATH",MCFILE=691.5:"ECG",MCFILE=691.6:"HOLTER",MCFILE=691.7:"ETT",MCFILE=691.8:"EP",MCFILE=694:"HEM",MCFILE=700:"PFT",MCFILE=701:"RHEUM",1:"^MCOR1") D @MCBRANCH
"RTN","MCOR",12,0)
EXIT Q  K I,J,K,L,MCFILE,MCARGDA,MCARGNUM,MCSMR,MCM,MCHEAD,MCARCODE,MCFILE1,MCNODE,MCPIECE,MCBRANCH Q
"RTN","MCOR",13,0)
HEM S MCC="I",MCNODE=12,MCPIECE=1,MCFILE1=694.1,MCHEAD="INDICATION" D MPOINT^MCOREX
"RTN","MCOR",14,0)
 S MCM=694.058,MCHEAD="INDICATION;W" D WP^MCOREX ;CHGD 'SET' TO 'WP^MCOREX' 5-19-92 MLH
"RTN","MCOR",15,0)
 S MCNODE=10,MCPIECE=1,MCFILE1=697.5,MCHEAD="PROVISIONAL DX" D MPOINT^MCOREX
"RTN","MCOR",16,0)
 S MCNODE=1,MCPIECE=2,MCHEAD="PROVISIONAL DX REMARKS" D FREE^MCOREX
"RTN","MCOR",17,0)
 S MCC="D",MCNODE=8,MCPIECE=1,MCFILE1=697.5,MCHEAD="FINAL DIAGNOSIS" D MPOINT^MCOREX
"RTN","MCOR",18,0)
 S MCM=694.041,MCHEAD="FINAL DIAGNOSIS REMARKS;W" D WP^MCOREX ;CHGD 'SET' TO 'WP^MCOREX' 5-19-92 MLH
"RTN","MCOR",19,0)
 Q
"RTN","MCOR",20,0)
RHEUM S MCC="D",MCNODE=5,MCPIECE=52,MCFILE1=329,MCHEAD="DISEASE SEVERITY-PHYS. ESTIMATE" D SETS^MCOREX
"RTN","MCOR",21,0)
 S MCNODE=13,MCPIECE=1,MCFILE1=697.5,MCHEAD="DIAGNOSIS" D MPOINT^MCOREX
"RTN","MCOR",22,0)
 Q
"RTN","MCOR",23,0)
HOLTER S MCC="I",MCNODE=8,MCFILE1=691.65,MCPIECE=1,MCHEAD="REASON FOR STUDY" D MSET^MCOREX
"RTN","MCOR",24,0)
 S MCM=691.68,MCHEAD="OTHER INDICATIONS" D WP^MCOREX ;CHGD 'HEAD=' TO 'MCHEAD=' 5/18/92 MLH, 'SET' TO 'WP^MCOREX' 5/19/92 MLH
"RTN","MCOR",25,0)
 S MCC="D",MCM=691.63,MCHEAD="INTERPRETATION" D WP^MCOREX ;CHGD 'HEAD=' TO 'MCHEAD=' 5/18/92 MLH, 'SET' TO 'WP^MCOREX' 5/19/92 MLH
"RTN","MCOR",26,0)
 Q
"RTN","MCOR",27,0)
ETT S MCC="I",MCNODE=0,MCPIECE=4,MCFILE1=3,MCHEAD="REASON FOR TEST" D SETS^MCOREX
"RTN","MCOR",28,0)
 S MCC="D",MCNODE=5,MCPIECE=8,MCFILE1=55,MCHEAD="INTERPRETATION" D SETS^MCOREX
"RTN","MCOR",29,0)
 Q
"RTN","MCOR",30,0)
EP S MCC="I",MCNODE=5,MCPIECE1=1,MCFILE1=697.5,MCHEAD="ARRHYTHMIA DX" D MPOINT^MCOREX
"RTN","MCOR",31,0)
 S MCNODE=6,MCPIECE=1,MCHEAD="CARDIAX DX" D POINT^MCOREX
"RTN","MCOR",32,0)
 S MCC="D",MCM=691.813,MCHEAD="INTERPRETATION;W" D WP^MCOREX ;CHGD 'SET' TO 'WP^MCOREX' 5-19-92 MLH
"RTN","MCOR",33,0)
 Q
"RTN","MCOR",34,0)
ECG S MCC="I",MCNODE=.3,MCPIECE=1,MCFILE1=695.5,MCHEAD="SYMPTOM" D MPOINT^MCOREX
"RTN","MCOR",35,0)
 S MCNODE=0,MCPIECE=3,MCFILE1=2,MCHEAD="TYPE OF EKG" D SETS^MCOREX
"RTN","MCOR",36,0)
 S MCC="D",MCNODE=3,MCPIECE=1,MCFILE1=693.3,MCHEAD="INTERPRETATION CODE (RHYTHM)" D MPOINT^MCOREX
"RTN","MCOR",37,0)
 S MCNODE=5,MCHEAD="INTERPRETATION CODE (CONFIG)" D MPOINT^MCOREX
"RTN","MCOR",38,0)
 S MCNODE=6,MCHEAD="INTERPRETATION CODE (PACING)" D MPOINT^MCOREX
"RTN","MCOR",39,0)
 S MCM=691.57,MCHEAD="AUTO-INSTRUMENT DIAGNOSIS" D WP^MCOREX ;CHGD 'HEAD=' TO 'MCHEAD=' 5/18/92 MLH, 'SET' TO 'WP^MCOREX' 5/19/92 MLH
"RTN","MCOR",40,0)
 Q
"RTN","MCOR",41,0)
ECHO S MCC="I",MCNODE=.3,MCFILE1=691.08,MCPIECE=1,MCHEAD="SYMPTOM" D MSET^MCOREX
"RTN","MCOR",42,0)
 S MCC="D",MCNODE=9,MCFILE1=693,MCPIECE=1,MCHEAD="FINDINGS" D MPOINT^MCOREX
"RTN","MCOR",43,0)
 S MCNODE=14,MCFILE1=697.5,MCPIECE=1,MCHEAD="DIAGNOSIS" D MPOINT^MCOREX
"RTN","MCOR",44,0)
 S MCM=691.07,MCHEAD="OTHER CONCLUSION" D WP^MCOREX ;CHGD 'HEAD=' TO 'MCHEAD=' 5/18/92 MLH, 'SET' TO 'WP^MCOREX' 5/19/92 MLH
"RTN","MCOR",45,0)
 Q
"RTN","MCOR",46,0)
CATH S MCC="I",MCNODE=.3,MCFILE1=695.5,MCPIECE=1,MCHEAD="SYMPTOM" D MPOINT^MCOREX
"RTN","MCOR",47,0)
 S MCNODE=8,MCFILE1=697.5,MCHEAD="INDICATION" D MPOINT^MCOREX
"RTN","MCOR",48,0)
 S MCC="D",MCNODE=42,MCFILE1=693.2,MCHEAD="INTERPRETATION" D POINT^MCOREX
"RTN","MCOR",49,0)
 Q
"RTN","MCOR",50,0)
PFT S MCC="I",MCNODE=1,MCPIECE=1,MCFILE1=697.5,MCHEAD="CONSULT DX" D MPOINT^MCOREX
"RTN","MCOR",51,0)
 S MCC="D",MCNODE=24,MCPIECE=1,MCFILE1=693.2,MCHEAD="COMP. GENERATED INTERPRETATION" D MPOINT^MCOREX
"RTN","MCOR",52,0)
 S MCM=700.04,MCHEAD="FREE TEXT INTERPRETATION;W" D WP^MCOREX ;CHGD 'SET' TO 'WP^MCOREX' 5-19-92 MLH
"RTN","MCOR",53,0)
 S MCM=700.03,MCHEAD="COMMENTS AND RECOMMENDATIONS;W" D WP^MCOREX ;CHGD 'SET' TO 'WP^MCOREX' 5-19-92 MLH
"RTN","MCOR",54,0)
 Q
"RTN","MCOR",55,0)
ENDO D ENDO^MCOR1
"RTN","MCOR",56,0)
 Q
"RTN","MCOR",57,0)
SET S MCK=MCK+1,^TMP("MC",$J,MCC,MCK)=MCM_U_MCHEAD Q
"RTN","MCOR",58,0)
NOTIFY(MCDA,MCFILE,MCX) Q
"RTN","MCOR",59,0)
MGMT ;Allows Site Manager to allow hooks to OE/RR.
"RTN","MCOR",60,0)
 S DIR("A")="Do you want to enable Order Entry/Results Reporting" S DIR(0)="Y" D ^DIR G:$D(DIRUT) MGMTEXIT
"RTN","MCOR",61,0)
 I Y=1 D
"RTN","MCOR",62,0)
 . D PARAM^MCU("2///Y") W !,"OE/RR enabled!",!!
"RTN","MCOR",63,0)
 . Q
"RTN","MCOR",64,0)
 E  D
"RTN","MCOR",65,0)
 . N MC S MC=$S($P($G(^MCAR(690.1,1,0)),U,3)'="Y":" already ",1:" ")
"RTN","MCOR",66,0)
 . D PARAM^MCU("2///@")
"RTN","MCOR",67,0)
 . W !,"OE/RR",MC,"disabled!",!!
"RTN","MCOR",68,0)
 . Q
"RTN","MCOR",69,0)
MGMTEXIT ;
"RTN","MCOR",70,0)
 K X,Y,DIE,DA,DR,DIR
"RTN","MCOR",71,0)
 Q
"RTN","MCOR1")
0^5^B9282543
"RTN","MCOR1",1,0)
MCOR1 ;WISC/TJK-OERR/MEDICINE PACKAGE LINKS (PART 2) ;3/18/98  13:19
"RTN","MCOR1",2,0)
 ;;2.3;Medicine;**17**;09/13/1996
"RTN","MCOR1",3,0)
 S MCBRANCH=$S(MCFILE=698.3:"SURV",MCFILE=699.5:"GEN",1:"PACE") D @MCBRANCH
"RTN","MCOR1",4,0)
EXIT Q
"RTN","MCOR1",5,0)
SET S MCK=MCK+1,^TMP("MC",$J,MCC,MCK)=MCM_U_MCHEAD Q
"RTN","MCOR1",6,0)
GEN ;
"RTN","MCOR1",7,0)
 S MCK=0
"RTN","MCOR1",8,0)
 S MCC="D",MCNODE=0,MCPIECE=8,MCFILE1=697.2,MCHEAD="PROCEDURE" D POINT^MCOREX
"RTN","MCOR1",9,0)
 S MCC="D",MCNODE=0,MCPIECE=6,MCFILE1=697.2,MCHEAD="SUBSPECIALTY" D POINT^MCOREX
"RTN","MCOR1",10,0)
 S MCC="D",MCM=699.534,MCHEAD="ASSESSMENT/FINDINGS;W" D WP^MCOREX
"RTN","MCOR1",11,0)
 Q
"RTN","MCOR1",12,0)
PACE ;S MCC="D",MCNODE=0,MCPIECE=3,MCFILE1=698.4,MCARCODE=$S(MCFILE=698:"PACEMAKER",MCFILE=698.1:"V LEAD",1:"A LEAD"),MCHEAD=MCARCODE_" MODEL" D POINT^MCOREX
"RTN","MCOR1",13,0)
 S MCC="D",MCNODE=0,MCPIECE=3,MCFILE1=698.4
"RTN","MCOR1",14,0)
 S MCARCODE=$S(MCFILE=698:"PACEMAKER",MCFILE=698.1:"V LEAD",MCFILE=698.2:"A LEAD",1:"")
"RTN","MCOR1",15,0)
 I MCARCODE="" D  Q
"RTN","MCOR1",16,0)
 . W !!?5,"Report not implemented for the criteria chosen."
"RTN","MCOR1",17,0)
 . Q
"RTN","MCOR1",18,0)
 S MCHEAD=MCARCODE_" MODEL" D POINT^MCOREX
"RTN","MCOR1",19,0)
 S MCPIECE=4,MCFILE1=698.6,MCHEAD=MCARCODE_" MANUFACTURER" D POINT^MCOREX
"RTN","MCOR1",20,0)
 S MCPIECE=5,MCHEAD=MCARCODE_" SERIAL NUMBER" D FREE^MCOREX
"RTN","MCOR1",21,0)
 Q
"RTN","MCOR1",22,0)
SURV S MCC="D",MCNODE=4,MCPIECE=4,MCHEAD="FOLLOWUP COMMENT" D FREE^MCOREX
"RTN","MCOR1",23,0)
 S MCM=698.31,MCHEAD="COMMENTS;W" D SET
"RTN","MCOR1",24,0)
 Q
"RTN","MCOR1",25,0)
ENDO S MCC="I",MCNODE=2,MCFILE1=699.6,MCPIECE=1,MCHEAD="INDICATED THERAPY" D MPOINT^MCOREX
"RTN","MCOR1",26,0)
 S MCNODE=3,MCFILE1=695.5,MCHEAD="SIGNS AND SYMPTOMS" D MPOINT^MCOREX
"RTN","MCOR1",27,0)
 S MCNODE=5,MCFILE1=699.84,MCHEAD="DISEASE "_$S(MCARCODE="G":"FOLLOWUP",1:"EVALUATION") D MPOINT^MCOREX
"RTN","MCOR1",28,0)
 S MCNODE=6,MCFILE1=699.85,MCHEAD="FOLLOWUP DEVICE OR THERAPY" D MPOINT^MCOREX
"RTN","MCOR1",29,0)
 I MCARCODE="P" S MCNODE=12,MCPIECE=1,MCHEAD="OTHER FOLLOWUP DEVICE/THERAPY" D FREE^MCOREX
"RTN","MCOR1",30,0)
 S MCNODE=7,MCFILE1=699.86,MCHEAD="SURVEILLANCE" D MPOINT^MCOREX
"RTN","MCOR1",31,0)
 I MCARCODE="G" S MCNODE=31 F MCPIECE=1,2,3 S MCHEAD=$S(MCPIECE=1:"PROTOCOL",MCPIECE=2:"EGD SIMPLE PRIMARY EXAM",1:"LAB OR XRAY") D FREE^MCOREX
"RTN","MCOR1",32,0)
 I MCARCODE="G" S MCNODE=32 F MCPIECE=1,2 S MCHEAD=$S(MCPIECE=1:"OCCULT BLOOD",1:"SPECIMEN COLLECTION") D FREE^MCOREX
"RTN","MCOR1",33,0)
 S MCNODE=0,MCPIECE=6,MCHEAD="INDICATION COMMENT" D FREE^MCOREX
"RTN","MCOR1",34,0)
 S MCC="D",MCNODE=204,MCPIECE=1,MCFILE1=697.5,MCHEAD="PRIMARY DIAGNOSIS" D POINT^MCOREX
"RTN","MCOR1",35,0)
 S MCNODE=205,MCPIECE=1,MCHEAD="PRIMARY DIAGNOSIS IMPRESSION" D FREE^MCOREX
"RTN","MCOR1",36,0)
 S MCNODE=27,MCFILE1=697.5,MCPIECE=1,MCHEAD="SECONDARY DIAGNOSIS" D MPOINT^MCOREX
"RTN","MCOR1",37,0)
 S MCPIECE=2,MCHEAD="SECONDARY DIAGNOSIS IMPRESSION" D MFREE^MCOREX
"RTN","MCOR1",38,0)
 S MCNODE=19 F MCPIECE=1,2,MCHEAD=$S(MCPIECE=1:"DIAGNOSIS/DIAGNOSIS SUPPLEMENT",1:"REVISED DIAGNOSIS") D FREE^MCOREX
"RTN","MCOR1",39,0)
 Q
"RTN","MCOREX")
0^8^B4961082
"RTN","MCOREX",1,0)
MCOREX ;WISC/TJK-OERR/MEDICINE DATA EXTRACT UTILITY ;2/17/98  14:48
"RTN","MCOREX",2,0)
 ;;2.3;Medicine;**17**;09/13/1996
"RTN","MCOREX",3,0)
SET S MCK=MCK+1,^TMP("MC",$J,MCC,MCK)=MCM_U_MCHEAD Q
"RTN","MCOREX",4,0)
POINT Q:'$D(^MCAR(MCFILE,MCARGDA,MCNODE))
"RTN","MCOREX",5,0)
 S MCM=$P($G(^MCAR(MCFILE,MCARGDA,MCNODE)),U,MCPIECE)
"RTN","MCOREX",6,0)
 Q:'MCM  S MCM=$P($G(^MCAR(MCFILE1,MCM,0)),U) Q:MCM=""
"RTN","MCOREX",7,0)
 D SET
"RTN","MCOREX",8,0)
 Q
"RTN","MCOREX",9,0)
MPOINT Q:'$D(^MCAR(MCFILE,MCARGDA,MCNODE))
"RTN","MCOREX",10,0)
 F I=0:0 S I=$O(^MCAR(MCFILE,MCARGDA,MCNODE,I)) Q:I'?1N.N  D
"RTN","MCOREX",11,0)
   .S J=$P(^MCAR(MCFILE,MCARGDA,MCNODE,I,0),U,MCPIECE)
"RTN","MCOREX",12,0)
   .Q:'J  S MCM=$P($G(^MCAR(MCFILE1,J,0)),U)
"RTN","MCOREX",13,0)
   .Q:MCM=""  D SET
"RTN","MCOREX",14,0)
 Q
"RTN","MCOREX",15,0)
FREE Q:'$D(^MCAR(MCFILE,MCARGDA,MCNODE))
"RTN","MCOREX",16,0)
 S MCM=$P(^MCAR(MCFILE,MCARGDA,MCNODE),U,MCPIECE) D SET Q
"RTN","MCOREX",17,0)
MFREE Q:'$D(^MCAR(MCFILE,MCARGDA,MCNODE))
"RTN","MCOREX",18,0)
 F I=0:0 S I=$O(^MCAR(MCFILE,MCARGDA,MCNODE,I)) Q:I'?1N.N  D
"RTN","MCOREX",19,0)
    .S MCM=$P(^MCAR(MCFILE,MCARGDA,MCNODE,I,0),U,MCPIECE)
"RTN","MCOREX",20,0)
    .Q:MCM=""  D SET
"RTN","MCOREX",21,0)
 Q
"RTN","MCOREX",22,0)
SETS Q:'$D(^MCAR(MCFILE,MCARGDA,MCNODE))
"RTN","MCOREX",23,0)
 S J=$P(^MCAR(MCFILE,MCARGDA,MCNODE),U,MCPIECE) Q:J=""
"RTN","MCOREX",24,0)
 ;S MCM=$P($G(^DD(MCFILE,MCFILE1,0)),U,3) Q:MCM=""
"RTN","MCOREX",25,0)
 S MCM=$$GET1^DID(MCFILE,MCFILE1,"","SPECIFIER") Q:MCM=""
"RTN","MCOREX",26,0)
 F K=1:1 S L=$P(MCM,";",K) Q:L=""  I $P(L,":",1)=J S MCM=$P(L,":",2) D SET Q
"RTN","MCOREX",27,0)
 Q
"RTN","MCOREX",28,0)
MSET Q:'$D(^MCAR(MCFILE,MCARGDA,MCNODE))
"RTN","MCOREX",29,0)
 F I=0:0 S I=$O(^MCAR(MCFILE,MCARGDA,MCNODE,I)) Q:I'?1N.N  D
"RTN","MCOREX",30,0)
    .S J=$P(^MCAR(MCFILE,MCARGDA,MCNODE,I,0),U,MCPIECE)
"RTN","MCOREX",31,0)
    .;Q:J=""  S MCM=$P($G(^DD(MCFILE1,.01,0)),U,3)
"RTN","MCOREX",32,0)
    .Q:J=""  S MCM=$$GET1^DID(MCFILE1,.01,"","SPECIFIER")
"RTN","MCOREX",33,0)
    .F K=1:1 S L=$P(MCM,";",K) Q:L=""  I $P(K,":",1)=J S MCM=$P(K,":",2) D SET Q
"RTN","MCOREX",34,0)
 Q
"RTN","MCOREX",35,0)
 ;
"RTN","MCOREX",36,0)
WP ;    word-processing field
"RTN","MCOREX",37,0)
 S $P(MCHEAD,";",2)="W" ;    indicate to OE/RR that this is WP
"RTN","MCOREX",38,0)
 S MCMUP=^DD(MCM,0,"UP")
"RTN","MCOREX",39,0)
 S MCMFLD=$O(^DD(MCMUP,"SB",MCM,""))
"RTN","MCOREX",40,0)
 ;S MCNODE=+$P(^DD(MCMUP,MCMFLD,0),"^",4)
"RTN","MCOREX",41,0)
 S MCNODE=$P($$GET1^DID(MCMUP,MCMFLD,"","GLOBAL SUBSCRIPT LOCATION"),";")
"RTN","MCOREX",42,0)
 F I=0:0 S I=$O(^MCAR(MCMUP,MCARGDA,MCNODE,I)) Q:I'?1N.N  D
"RTN","MCOREX",43,0)
    .S MCM=^MCAR(MCFILE,MCARGDA,MCNODE,I,0)
"RTN","MCOREX",44,0)
    .I MCM'="" D SET
"RTN","MCOREX",45,0)
 Q
"RTN","MCPFTP")
0^6^B2782684
"RTN","MCPFTP",1,0)
MCPFTP ;WISC/TJK-PULMONARY FUNCTION TEST PRINT ;3/6/98  16:29
"RTN","MCPFTP",2,0)
 ;;2.3;Medicine;**17**;09/13/1996
"RTN","MCPFTP",3,0)
DIC ;
"RTN","MCPFTP",4,0)
 D MCPPROC^MCARP
"RTN","MCPFTP",5,0)
 S MCBP=$S($E(XQY0,3,3)="B":1,1:0)
"RTN","MCPFTP",6,0)
 S DIC="^MCAR(700,",DIC(0)="AEQMZ"
"RTN","MCPFTP",7,0)
 G:$G(MCARGDA)>0 SUM
"RTN","MCPFTP",8,0)
 S:MCESON DIC("S")=$$PREVIEW^MCESSCR(MCFILE)
"RTN","MCPFTP",9,0)
 D ^DIC K DIC G EXIT:Y<0
"RTN","MCPFTP",10,0)
 S MCARGDA=+Y
"RTN","MCPFTP",11,0)
 ;
"RTN","MCPFTP",12,0)
SUM ;    Entry point when procedure # (MCARGDA) is already defined.
"RTN","MCPFTP",13,0)
 ;    Called by Summary of Patient Procedures, Interpretation Enter/
"RTN","MCPFTP",14,0)
 ;    Edit.
"RTN","MCPFTP",15,0)
 S MCARZ="PULMONARY FUNCTION TEST REPORT"
"RTN","MCPFTP",16,0)
 D:$G(MCESON) STATUS^MCESPRT(MCFILE,MCARGDA)
"RTN","MCPFTP",17,0)
 S MCPFT0=^MCAR(700,MCARGDA,0),MCFILE=700,DFN=$P(^(0),U,2)
"RTN","MCPFTP",18,0)
 I $D(ORHFS) U IO G PRINT ;dcm/slc added for CPRS
"RTN","MCPFTP",19,0)
DEVQUE ; Device Control and Queuing Control
"RTN","MCPFTP",20,0)
 K IO("Q") S %ZIS="MQ" D ^%ZIS I POP G EXIT
"RTN","MCPFTP",21,0)
 I $D(IO("Q")) K IO("Q") S (ZTSAVE("MC*"),ZTSAVE("DFN"),ZTSAVE("DIC"))="",ZTRTN=$S($G(MCBP)=1:"^MCBPFTP1",1:"^MCPFTP1"),ZTDESC="PFT REPORT" D ^%ZTLOAD K ZTSK G EXIT
"RTN","MCPFTP",22,0)
 U IO
"RTN","MCPFTP",23,0)
PRINT G:$G(MCBP)=1 ^MCBPFTP1 G ^MCPFTP1
"RTN","MCPFTP",24,0)
EXIT K DFN,MCARGDA,MCPFT0,Y,POP
"RTN","MCPFTP",25,0)
 K MCAR,MCARDOB,MCARDTM,MCARHDR,MCARRB,MCARWARD,MCRHR,VADM,VAIN
"RTN","MCPFTP",26,0)
 K MCARP,MCFILE,MCESON,MCESKEY,MCROUT,MCTYPE,MCARGDA
"RTN","MCPFTP",27,0)
 K MCPBRIEF,MCPFULL,MCPRTRTN,MCBS
"RTN","MCPFTP",28,0)
 D ^%ZISC Q
"VER")
8.0^21.0
**END**
**END**
