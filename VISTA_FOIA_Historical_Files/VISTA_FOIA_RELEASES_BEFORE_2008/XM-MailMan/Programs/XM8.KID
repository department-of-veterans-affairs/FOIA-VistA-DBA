KIDS Distribution saved on Aug 29, 2002@09:18:04
MailMan 8.0 8/29/2002
**KIDS**:MAILMAN 8.0^

**INSTALL NAME**
MAILMAN 8.0
"BLD",443,0)
MAILMAN 8.0^MAILMAN^0^3020829^y
"BLD",443,1,0)
^^675^675^3020807^^^^
"BLD",443,1,1,0)
MailMan 8.0
"BLD",443,1,2,0)

"BLD",443,1,3,0)
Test Sites: FORUM, San Francisco, Central Alabama, FO-Albany, FO-Oakland
"BLD",443,1,4,0)

"BLD",443,1,5,0)
MailMan 8.0 is a maintenance release.  It includes the complete MailMan
"BLD",443,1,6,0)
suite of data dictionaries, but it does not populate the files.  This
"BLD",443,1,7,0)
version expects that a site already has MailMan 7.1 installed and running,
"BLD",443,1,8,0)
and that it is patched through XM*7.1*198.  It is also expected that
"BLD",443,1,9,0)
Kernel 8.0 and FileMan 22.0 are installed and are reasonably up-to-date
"BLD",443,1,10,0)
(through patches XU*8.0*216 and DI*22.0*68, respectively).
"BLD",443,1,11,0)

"BLD",443,1,12,0)
MailMan 8.0 offers the following improvements over MailMan 7.1:
"BLD",443,1,13,0)

"BLD",443,1,14,0)
1. MailMan is now DNS aware.  It can use the Kernel API MAIL^XLFNSLK
"BLD",443,1,15,0)
to retrieve IP addresses.  It is no longer necessary to manually update the
"BLD",443,1,16,0)
IP addresses in the DOMAIN file, 4.2.  The IP address fields will remain in
"BLD",443,1,17,0)
file 4.2, and MailMan will use them.  However, if they don't work, MailMan
"BLD",443,1,18,0)
will use the Kernel API to retrieve a list of valid IP addresses.  When
"BLD",443,1,19,0)
MailMan finds one that works, MailMan will replace the non-working IP
"BLD",443,1,20,0)
address with the working one.  In order to activate DNS awareness, this
"BLD",443,1,21,0)
new field in the MAILMAN SITE PARAMETERS file 4.3 must be set to 'yes':
"BLD",443,1,22,0)
     4.3,8.22   DNS AWARE                        Yes or No?
"BLD",443,1,23,0)
Also, routine ^XLFNSLK must exist, and the following field in the
"BLD",443,1,24,0)
KERNEL SYSTEMS PARAMETERS file 8989.3 must be properly filled in with
"BLD",443,1,25,0)
an IP address:
"BLD",443,1,26,0)
     8989.3,51  DNS IP                           IP address for DNS
"BLD",443,1,27,0)

"BLD",443,1,28,0)
2. For TCP/IP connections, MailMan can now build transmission scripts
"BLD",443,1,29,0)
on-the-fly.  (Transmission scripts exist in the DOMAIN file 4.2, in the
"BLD",443,1,30,0)
TRANSMISSION SCRIPT multiple, in the TEXT field 2.)  If the TYPE is "SMTP",
"BLD",443,1,31,0)
"TCPCHAN", or null, and the TEXT field has no records, and these fields
"BLD",443,1,32,0)
in the MAILMAN SITE PARAMETERS file 4.3 are filled in:
"BLD",443,1,33,0)
     4.3,8.23   TCP/IP COMMUNICATIONS PROTOCOL   Points to file 3.4
"BLD",443,1,34,0)
     4.3,8.24   TCP/IP TRANSMISSION SCRIPT       Points to file 4.6
"BLD",443,1,35,0)
...then MailMan creates the script.  This one is for FORUM:
"BLD",443,1,36,0)
     O H=FORUM.VA.GOV,P=TCP/IP-MAILMAN
"BLD",443,1,37,0)
     C TCPCHAN-SOCKET25
"BLD",443,1,38,0)
where:
"BLD",443,1,39,0)
     "FORUM.VA.GOV" is taken from the DOMAIN name.
"BLD",443,1,40,0)
     "TCP/IP-MAILMAN" is the protocol pointed to by field 8.23
"BLD",443,1,41,0)
     "TCPCHAN-SOCKET25" is the script pointed to by field 8.24.
"BLD",443,1,42,0)

"BLD",443,1,43,0)
3. Messages in transmit queues can now be designated as low priority, as
"BLD",443,1,44,0)
well as high priority.  If a message gets stuck in a transmit queue and is
"BLD",443,1,45,0)
holding up the rest of the queue for whatever reason, MailMan will make
"BLD",443,1,46,0)
that message a low priority message, so that all the other messages are
"BLD",443,1,47,0)
transmitted ahead of it.  The postmaster can also make these priority
"BLD",443,1,48,0)
changes.  In the message queue, high-priority messages are now marked with
"BLD",443,1,49,0)
'^', instead of '$'.  Low priority messages are marked with 'v'.
"BLD",443,1,50,0)

"BLD",443,1,51,0)
The postmaster can now change the transmit priority at the message level
"BLD",443,1,52,0)
(at the 'Message action: Ignore//' prompt).  As at the basket level, the
"BLD",443,1,53,0)
command to use is 'X'.  (In a user basket, the 'X' at the message level is
"BLD",443,1,54,0)
a command to unload a PackMan message or KIDS build.  In a remote transmit
"BLD",443,1,55,0)
queue, the 'X' changes the transmit priority.  The difference is the
"BLD",443,1,56,0)
context, and writers of MailMan front-ends should take note!)
"BLD",443,1,57,0)

"BLD",443,1,58,0)
4. MailMan date/times are now in a standard format, produced by the Kernel
"BLD",443,1,59,0)
API: $$FMTE^XLFDT(datetime,"2Z").  Previously, 3020803.153204 would be
"BLD",443,1,60,0)
displayed as '03 Aug 02 15:32'.  Now, it is displayed as '08/03/02@15:32'.
"BLD",443,1,61,0)
This change is also carried through to all MailMan APIs which return
"BLD",443,1,62,0)
date/time in MailMan format.  Users of such APIs should take note!
"BLD",443,1,63,0)

"BLD",443,1,64,0)
5. MailMan remote message IDs now include the message date, to ensure that
"BLD",443,1,65,0)
if you are told that a message is a duplicate of a previously received
"BLD",443,1,66,0)
message, it really is.  Sites will no longer have problems sending messages
"BLD",443,1,67,0)
from a production account to a test account which was created by "mirroring"
"BLD",443,1,68,0)
the production account.  The remote message ID is now the message number
"BLD",443,1,69,0)
following by a period, followed by the 7-digit FileMan message creation
"BLD",443,1,70,0)
date.  Before, a remote message ID might be 34561234@FORUM.VA.GOV.  Now it
"BLD",443,1,71,0)
would be 34561234.3020803@FORUM.VA.GOV.
"BLD",443,1,72,0)

"BLD",443,1,73,0)
6. The ^XMC*, ^XMR*, ^XMS* suite of routines, which are responsible for
"BLD",443,1,74,0)
scheduling, transmitting to, and receiving messages from remote sites, have
"BLD",443,1,75,0)
been completely overhauled to make them easier to understand and easier to
"BLD",443,1,76,0)
maintain.
"BLD",443,1,77,0)

"BLD",443,1,78,0)
7. MailMan will no longer display user names by taking them directly from
"BLD",443,1,79,0)
the .01 field of the NEW PERSON file, 200.  The API, $$NAMEFMT^XLFNAME,
"BLD",443,1,80,0)
supplied as part of the Name Standardization project, is used, instead.
"BLD",443,1,81,0)
Thus, the names of people whose last names, for instance, contain periods,
"BLD",443,1,82,0)
apostrophes, or spaces, are properly displayed (ST. IVES, O'MALLEY, and
"BLD",443,1,83,0)
VAN DYKE), instead of improperly (STIVES, OMALLEY, and VANDYKE).
"BLD",443,1,84,0)

"BLD",443,1,85,0)
8. In response to NOIS FAV-0202-71819, messages with responses may no longer
"BLD",443,1,86,0)
be forwarded to broadcast to all users.  Such messages may have important
"BLD",443,1,87,0)
information in the responses, and as we all know, responses are not auto-
"BLD",443,1,88,0)
forwarded to remote sites for users with auto-forward addresses.  Users who
"BLD",443,1,89,0)
attempt to broadcast messages with responses will be encouraged to copy the
"BLD",443,1,90,0)
message and its responses into a new message, which can be broadcast.
"BLD",443,1,91,0)

"BLD",443,1,92,0)
9. Incoming PackMan and KIDS messages are no longer subject to the
"BLD",443,1,93,0)
restriction NETWORK - MAX LINES RECEIVE (field 8.31, file 4.3).  Other kinds
"BLD",443,1,94,0)
of messages continue to be subject to that restriction.
"BLD",443,1,95,0)

"BLD",443,1,96,0)
10. If a task transmitting messages to another site fails and has to be
"BLD",443,1,97,0)
requeued, it really is requeued.  Previously, that wasn't true.  Previously,
"BLD",443,1,98,0)
the failing task queued up a new task to take its place, and then the
"BLD",443,1,99,0)
failing task stopped.
"BLD",443,1,100,0)

"BLD",443,1,101,0)
11. You can now send, forward, or filter-forward messages to H.device
"BLD",443,1,102,0)
(Headerless print).  It will print the message, without a header, on the
"BLD",443,1,103,0)
device.  As before, sending messages to D.device will print them with
"BLD",443,1,104,0)
a header.
"BLD",443,1,105,0)

"BLD",443,1,106,0)
12. In response to NOIS HWH-0502-41774, if you become a surrogate of a user,
"BLD",443,1,107,0)
and try to access a message that the user is not on (but you are), you will
"BLD",443,1,108,0)
be told that you will have to forward the message to the user, in order to
"BLD",443,1,109,0)
access it as the user.  You will then be given the opportunity to forward
"BLD",443,1,110,0)
it, if it's OK to do so.  (For example, if the message is closed, you would
"BLD",443,1,111,0)
not be allowed to forward it, if you didn't send it.)
"BLD",443,1,112,0)

"BLD",443,1,113,0)
13. In response to NOIS CHY-0597-50209, when using TalkMan to communicate
"BLD",443,1,114,0)
with a site, MailMan will only consider using scripts whose TYPE is TELNET.
"BLD",443,1,115,0)

"BLD",443,1,116,0)
14. The pre-init, PRE^XMYPRE, will
"BLD",443,1,117,0)
- K ^DOPT("XMC"), to reset the programmer options (D ^XMC).
"BLD",443,1,118,0)
- Kill the old "AC" xref definition for NETWORK PRIORITY TRANSMISSION field
"BLD",443,1,119,0)
6, in the basket multiple of file 3.7, and change all xrefs
"BLD",443,1,120,0)
^XMB(3.7,.5,2,"AC",1,XMK,XMZ) to ^XMB(3.7,.5,2,XMK,1,"AC",1,XMZ).
"BLD",443,1,121,0)
- Delete the following fields from file 4.2999, MESSAGE STATISTICS, because
"BLD",443,1,122,0)
they are not used:
"BLD",443,1,123,0)
     7  OUTGOING MESSAGE COUNT
"BLD",443,1,124,0)
     8  CHARACTERS REC'D
"BLD",443,1,125,0)
     9  INCOMING MESSAGE COUNT
"BLD",443,1,126,0)
    10  CHARACTERS SENT 
"BLD",443,1,127,0)
- Delete the ENTRY ACTION fields for options XMQSHOW, XMSUBEDIT, XMDXPROT.
"BLD",443,1,128,0)

"BLD",443,1,129,0)
15. The post-init, POST^XMYPRE, will
"BLD",443,1,130,0)
- Go through MailMan's security keys and ensure that the 'mutually
"BLD",443,1,131,0)
exclusive' keys are correct.
"BLD",443,1,132,0)

"BLD",443,1,133,0)
16. Here are DD changes:
"BLD",443,1,134,0)

"BLD",443,1,135,0)
a. MESSAGE file 3.7
"BLD",443,1,136,0)

"BLD",443,1,137,0)
- Change field 2, FORWARDING ADDRESS to fix the bulletin xref.  FileMan
"BLD",443,1,138,0)
thought that it was firing XM-FWD-ADDRESS-CHECKER, yet it was actually
"BLD",443,1,139,0)
firing XMZFWDBULL.  It now fires XM FWD ADDRESS CHANGE, a new bulletin,
"BLD",443,1,140,0)
which looks like the old ones, but has a better name.
"BLD",443,1,141,0)

"BLD",443,1,142,0)
STANDARD DATA DICTIONARY #3.7 -- MAILBOX FILE
"BLD",443,1,143,0)
STORED IN ^XMB(3.7,
"BLD",443,1,144,0)
DATA        NAME                GLOBAL        DATA
"BLD",443,1,145,0)
ELEMENT     TITLE               LOCATION      TYPE
"BLD",443,1,146,0)
---------------------------------------------------------------------------
"BLD",443,1,147,0)
3.7,2     FORWARDING ADDRESS     0;2 FREE TEXT
"BLD",443,1,148,0)
          Remote address to which mail is routed   
"BLD",443,1,149,0)
          INPUT TRANSFORM:  D XMFWD^XMVVITA(.X,$G(XMIA)) I $D(X) K:$L(X)>50
"BLD",443,1,150,0)
                            !($L(X)<1) X
"BLD",443,1,151,0)
          LAST EDITED:      APR 23, 2002 
"BLD",443,1,152,0)
          HELP-PROMPT:      Enter a forwarding address (name@domain) of up 
"BLD",443,1,153,0)
                            to 50 characters. 
"BLD",443,1,154,0)
          DESCRIPTION:      This field names an additional address to which
"BLD",443,1,155,0)
                            any messages addressed to you are routed.  This
"BLD",443,1,156,0)
                            address must be a remote address or a local
"BLD",443,1,157,0)
                            device.  
"BLD",443,1,158,0)
                                 
"BLD",443,1,159,0)
                            If you want a local user to see your messages,
"BLD",443,1,160,0)
                            make that user a surrogate.  
"BLD",443,1,161,0)
                                 
"BLD",443,1,162,0)
                            See the LOCAL DELIVERY FLAG.  If you do not
"BLD",443,1,163,0)
                            edit this field to 'ON', then mail will only be
"BLD",443,1,164,0)
                            delivered to your FORWARDING ADDRESS and not to
"BLD",443,1,165,0)
                            your Mailbox.  
"BLD",443,1,166,0)

"BLD",443,1,167,0)
          NOTES:            XXXX--CAN'T BE ALTERED EXCEPT BY PROGRAMMER
"BLD",443,1,168,0)

"BLD",443,1,169,0)
          CROSS-REFERENCE:  ^^BULLETIN MESSAGE 
"BLD",443,1,170,0)
                            1)= S Y(0)=X,D0=DA X "N DIIND F DIIND=1.001:.00
"BLD",443,1,171,0)
                            1 Q:$D(^DD(3.7,2,1,1,DIIND))[0  X ^(DIIND)" K X
"BLD",443,1,172,0)
                            MY S XMB="XM FWD ADDRESS CHANGE" D ^XMB:$D(^XMB
"BLD",443,1,173,0)
                            (3.7,"B",XMB)),ENT^XMUT7(DA) K Y,XMB
"BLD",443,1,174,0)
                            1.001)= S X=Y(0) S Y(1)=$S($D(^XMB(3.7,D0,0)):^
"BLD",443,1,175,0)
                            (0),1:"") S X=$S('$D(^VA(200,+$P(Y(1),U,1),0)):
"BLD",443,1,176,0)
                            "",1:$P(^(0),U,1)) S XMB(1)=X
"BLD",443,1,177,0)
                            1.002)= S X=Y(0) S Y(1)=$S($D(^XMB(3.7,D0,0)):^
"BLD",443,1,178,0)
                            (0),1:"") S X=$P(Y(1),U,2) S XMB(2)=X
"BLD",443,1,179,0)
                            2)= Q
"BLD",443,1,180,0)
                            CREATE PARAMETER #1)= NAME
"BLD",443,1,181,0)
                            CREATE PARAMETER #2)= FORWARDING ADDRESS
"BLD",443,1,182,0)
                            CREATE VALUE)= XM FWD ADDRESS CHANGE
"BLD",443,1,183,0)
                            DELETE VALUE)= NO EFFECT
"BLD",443,1,184,0)
                            This cross reference sends two bulletins.  
"BLD",443,1,185,0)
                                 
"BLD",443,1,186,0)
                            The first, XM FWD ADDRESS CHANGE, notifies
"BLD",443,1,187,0)
                            responsible individuals (belonging to the mail
"BLD",443,1,188,0)
                            group associated with the bulletin) that a user 
"BLD",443,1,189,0)
                            has changed his forwarding address.  This is
"BLD",443,1,190,0)
                            the "official" bulletin of this cross
"BLD",443,1,191,0)
                            reference.  
"BLD",443,1,192,0)
                                 
"BLD",443,1,193,0)
                            The second, XM FWD ADDRESS CHECK, is sent to
"BLD",443,1,194,0)
                            the user's new forwarding address as test to
"BLD",443,1,195,0)
                            see if the address is valid.  If it's not
"BLD",443,1,196,0)
                            valid, the sender (the Postmaster) will receive
"BLD",443,1,197,0)
                            an error message.  This bulletin has been
"BLD",443,1,198,0)
                            piggy-backed onto the "official" bulletin. 
"BLD",443,1,199,0)
                            FileMan is not aware of this.  
"BLD",443,1,200,0)

"BLD",443,1,201,0)
          CROSS-REFERENCE:  3.7^F 
"BLD",443,1,202,0)
                            1)= S ^XMB(3.7,"F",$E(X,1,30),DA)=""
"BLD",443,1,203,0)
                            2)= K ^XMB(3.7,"F",$E(X,1,30),DA)
"BLD",443,1,204,0)
                            This cross reference enables the site manager
"BLD",443,1,205,0)
                            to easily find a user who enters a bad
"BLD",443,1,206,0)
                            forwarding address.  
"BLD",443,1,207,0)

"BLD",443,1,208,0)
- Change field 3.702,6 - NETWORK PRIORITY TRANSMISSION
"BLD",443,1,209,0)
to expand the set of codes to add low priority, and to change the "AC" xref
"BLD",443,1,210,0)
from user-level to message-level.  (See item 3, above, for more info.)
"BLD",443,1,211,0)

"BLD",443,1,212,0)
3.702,6     NETWORK PRIORITY TRANSMISSION? 0;6 SET
"BLD",443,1,213,0)
                            '1' FOR HIGH PRIORITY; 
"BLD",443,1,214,0)
                            '0' FOR REGULAR PRIORITY; 
"BLD",443,1,215,0)
                            '2' FOR LOW PRIORITY; 
"BLD",443,1,216,0)
            HELP-PROMPT:    How should this message be handled during 
"BLD",443,1,217,0)
                            transmission? 
"BLD",443,1,218,0)
            DESCRIPTION:    This field is used to flag messages that need
"BLD",443,1,219,0)
                            to be transmitted before or after all other
"BLD",443,1,220,0)
                            messages in a queue.  
"BLD",443,1,221,0)

"BLD",443,1,222,0)
                            Messages in the queue which are flagged as HIGH
"BLD",443,1,223,0)
                            priority are transmitted before all other
"BLD",443,1,224,0)
                            messages.  
"BLD",443,1,225,0)

"BLD",443,1,226,0)
                            Messages in the queue which are flagged as
"BLD",443,1,227,0)
                            REGULAR priority (default) are transmitted
"BLD",443,1,228,0)
                            next.  
"BLD",443,1,229,0)

"BLD",443,1,230,0)
                            Messages in the queue which are flagged as LOW
"BLD",443,1,231,0)
                            priority are transmitted after all other
"BLD",443,1,232,0)
                            messages.  
"BLD",443,1,233,0)

"BLD",443,1,234,0)
                            Messages with the same priority are transmitted
"BLD",443,1,235,0)
                            in IEN order, which is not necessarily the
"BLD",443,1,236,0)
                            order in which they appear in the transmit
"BLD",443,1,237,0)
                            queue.  
"BLD",443,1,238,0)

"BLD",443,1,239,0)
                            Only the POSTMASTER (or surrogate) may change
"BLD",443,1,240,0)
                            the priority of a message in a transmit queue. 
"BLD",443,1,241,0)
                            If, during a transmission, MailMan has problems 
"BLD",443,1,242,0)
                            with a particular message, MailMan may flag
"BLD",443,1,243,0)
                            that message as LOW priority, so that other
"BLD",443,1,244,0)
                            messages in the queue will transmit, before the
"BLD",443,1,245,0)
                            problem message is attempted again.  
"BLD",443,1,246,0)

"BLD",443,1,247,0)
                            Changes to message priorities can be made even
"BLD",443,1,248,0)
                            while a queue is being transmitted.  
"BLD",443,1,249,0)

"BLD",443,1,250,0)
            FIELD INDEX:    AC (#12)    REGULAR    IR    SORTING ONLY
"BLD",443,1,251,0)
              Short Descr:  Transmission Priority Cross Reference
"BLD",443,1,252,0)
              Description:  This xref is used by MailMan during message
"BLD",443,1,253,0)
                            transmission to identify messages which should
"BLD",443,1,254,0)
                            be transmitted first (high priority) or last 
"BLD",443,1,255,0)
                            (low priority).  Messages with regular priority
"BLD",443,1,256,0)
                            are not xref'd.
"BLD",443,1,257,0)
                Set Logic:  S ^XMB(3.7,DA(2),2,DA(1),1,"AC",$E(X,1,1),DA)=""
"BLD",443,1,258,0)
                 Set Cond:  S X=X
"BLD",443,1,259,0)
               Kill Logic:  K ^XMB(3.7,DA(2),2,DA(1),1,"AC",$E(X,1,1),DA)
"BLD",443,1,260,0)
                Kill Cond:  S X=X
"BLD",443,1,261,0)
               Whole Kill:  K ^XMB(3.7,DA(2),2,DA(1),1,"AC")
"BLD",443,1,262,0)
                     X(1):  NETWORK PRIORITY TRANSMISSION?  (3.702,6)
"BLD",443,1,263,0)
                            (Subscr 1)  (Len 1)  (forwards)
"BLD",443,1,264,0)

"BLD",443,1,265,0)
b. MAIL GROUP file 3.8, add a trigger to field .01 to populate field 5.1
"BLD",443,1,266,0)

"BLD",443,1,267,0)
STANDARD DATA DICTIONARY #3.8 -- MAIL GROUP FILE
"BLD",443,1,268,0)
STORED IN ^XMB(3.8,
"BLD",443,1,269,0)
DATA       NAME                  GLOBAL        DATA
"BLD",443,1,270,0)
ELEMENT    TITLE                 LOCATION      TYPE
"BLD",443,1,271,0)
----------------------------------------------------------------------------
"BLD",443,1,272,0)
3.8,.01    NAME                   0;1 FREE TEXT (Required)
"BLD",443,1,273,0)
           MAIL GROUP NAME           
"BLD",443,1,274,0)
           INPUT TRANSFORM:  S:X?1"G.".E!(X?1"g.".E) X=$E(X,3,99) K:$L(X)>30
"BLD",443,1,275,0)
                             !($L(X)<3)!'(X'?1P.E)!(X'?.ANP) X
"BLD",443,1,276,0)
           HELP-PROMPT:      ANSWER MUST BE 3-30 CHARACTERS IN LENGTH 
"BLD",443,1,277,0)
           DESCRIPTION:      The name of a mail group, i.e. a list of
"BLD",443,1,278,0)
                             recipients who can all be addressed at once by
"BLD",443,1,279,0)
                             reference to this name.  
"BLD",443,1,280,0)
           NOTES:            XXXX--CAN'T BE ALTERED EXCEPT BY PROGRAMMER
"BLD",443,1,281,0)
           CROSS-REFERENCE:  3.8^B 
"BLD",443,1,282,0)
                             1)= S ^XMB(3.8,"B",$E(X,1,30),DA)=""
"BLD",443,1,283,0)
                             2)= K ^XMB(3.8,"B",$E(X,1,30),DA)
"BLD",443,1,284,0)
           CROSS-REFERENCE:  ^^TRIGGER^3.8^5 
"BLD",443,1,285,0)
                             1)= X ^DD(3.8,.01,1,2,1.3) I X S X=DIV S Y(1)=$
"BLD",443,1,286,0)
                             S($D(^XMB(3.8,D0,3)):^(3),1:"") S X=$P(Y(1),U,1
"BLD",443,1,287,0)
                             ),X=X S DIU=X K Y S X=DIV S X=$G(XMDUZ,DUZ) S D
"BLD",443,1,288,0)
                             IH=$G(^XMB(3.8,DIV(0),3)),DIV=X S $P(^(3),U,1)=
"BLD",443,1,289,0)
                             DIV,DIH=3.8,DIG=5 D ^DICR
"BLD",443,1,290,0)
                             1.3)= K DIV S DIV=X,D0=DA,DIV(0)=D0 S Y(0)=X S 
"BLD",443,1,291,0)
                             Y(1)=$S($D(^XMB(3.8,D0,3)):^(3),1:"") S X=$S('$
"BLD",443,1,292,0)
                             D(^VA(200,+$P(Y(1),U,1),0)):"",1:$P(^(0),U,1))=
"BLD",443,1,293,0)
                             ""
"BLD",443,1,294,0)
                             2)= Q
"BLD",443,1,295,0)
                             CREATE CONDITION)= ORGANIZER=""
"BLD",443,1,296,0)
                             CREATE VALUE)= S X=$G(XMDUZ,DUZ)
"BLD",443,1,297,0)
                             DELETE VALUE)= NO EFFECT
"BLD",443,1,298,0)
                             FIELD)= ORGANIZER
"BLD",443,1,299,0)
                             When a user creates a mail group, this trigger
"BLD",443,1,300,0)
                             makes that user the organizer of the group. 
"BLD",443,1,301,0)
                             The user is free to change that field.  
"BLD",443,1,302,0)

"BLD",443,1,303,0)
c. INTER-UCI TRANSFER file 4.281, increase domain name field lengths to 
"BLD",443,1,304,0)
agree with .01 field in file 4.2.  Also increase lengths of B & C xrefs.
"BLD",443,1,305,0)

"BLD",443,1,306,0)
STANDARD DATA DICTIONARY #4.281 -- INTER-UCI TRANSFER FILE
"BLD",443,1,307,0)
STORED IN ^%ZISL(4.281,
"BLD",443,1,308,0)
DATA        NAME                GLOBAL        DATA
"BLD",443,1,309,0)
ELEMENT     TITLE               LOCATION      TYPE
"BLD",443,1,310,0)
---------------------------------------------------------------------------
"BLD",443,1,311,0)
4.281,.01   FROM DOMAIN            0;1 FREE TEXT (Required)
"BLD",443,1,312,0)
            INPUT TRANSFORM:  K:$L(X)>64!($L(X)<3)!'(X'?1P.E) X
"BLD",443,1,313,0)
            HELP-PROMPT:      Answer must be 3-64 characters in length
"BLD",443,1,314,0)
            CROSS-REFERENCE:  4.281^B
"BLD",443,1,315,0)
                              1)= S ^%ZISL(4.281,"B",$E(X,1,64),DA)=""
"BLD",443,1,316,0)
                              2)= K ^%ZISL(4.281,"B",$E(X,1,64),DA)
"BLD",443,1,317,0)

"BLD",443,1,318,0)
4.281,1     TO DOMAIN              0;2 FREE TEXT
"BLD",443,1,319,0)
            INPUT TRANSFORM:  K:$L(X)>64!($L(X)<3) X
"BLD",443,1,320,0)
            HELP-PROMPT:      Answer must be 3-64 characters in length
"BLD",443,1,321,0)
            CROSS-REFERENCE:  4.281^C
"BLD",443,1,322,0)
                              1)= S ^%ZISL(4.281,"C",$E(X,1,64),DA)=""
"BLD",443,1,323,0)
                              2)= K ^%ZISL(4.281,"C",$E(X,1,64),DA)
"BLD",443,1,324,0)
                              3)= XXXX - Do not delete
"BLD",443,1,325,0)
                              This cross-reference is used by the receiving
"BLD",443,1,326,0)
                              UCI to find entries which have been
"BLD",443,1,327,0)
                              'transmitted' to it from other UCIs.
"BLD",443,1,328,0)

"BLD",443,1,329,0)
d. Add fields to MESSAGE STATISTICS file 4.2999.
"BLD",443,1,330,0)

"BLD",443,1,331,0)
STANDARD DATA DICTIONARY #4.2999 -- MESSAGE STATISTICS FILE
"BLD",443,1,332,0)
STORED IN ^XMBS(4.2999,
"BLD",443,1,333,0)
DATA        NAME                  GLOBAL        DATA
"BLD",443,1,334,0)
ELEMENT     TITLE                 LOCATION      TYPE
"BLD",443,1,335,0)
---------------------------------------------------------------------------
"BLD",443,1,336,0)
4.2999,8    DIRECTION              3;8 SET
"BLD",443,1,337,0)
                              'S' FOR SENDING; 
"BLD",443,1,338,0)
                              'R' FOR RECEIVING; 
"BLD",443,1,339,0)
            HELP-PROMPT:      Are we sending or receiving? 
"BLD",443,1,340,0)
            DESCRIPTION:      This field is used to report whether, at any
"BLD",443,1,341,0)
                              given time, we are sending messages to, or
"BLD",443,1,342,0)
                              receiving messages from, the site.  
"BLD",443,1,343,0)

"BLD",443,1,344,0)
4.2999,48   XMIT IP ADDRESSES TRIED 4;8 FREE TEXT
"BLD",443,1,345,0)
            INPUT TRANSFORM:  K:$L(X)>100!($L(X)<3) X
"BLD",443,1,346,0)
            HELP-PROMPT:      Answer must be 3-100 characters in length.
"BLD",443,1,347,0)
            DESCRIPTION:    This is a list of IP addresses, separated by
"BLD",443,1,348,0)
                            commas, which have already been used in
"BLD",443,1,349,0)
                            attempting to connect with the site.
"BLD",443,1,350,0)

"BLD",443,1,351,0)
                            We use this list in conjunction with the DNS
"BLD",443,1,352,0)
                            server, which returns a list of valid addresses
"BLD",443,1,353,0)
                            to try.  Using both lists, we can come up with
"BLD",443,1,354,0)
                            the next IP address to try.
"BLD",443,1,355,0)

"BLD",443,1,356,0)
4.29992,3   XMIT AUDIT IP ADDRESS  0;4 FREE TEXT
"BLD",443,1,357,0)
            INPUT TRANSFORM:  K:$L(X)>20!($L(X)<1) X
"BLD",443,1,358,0)
            HELP-PROMPT:      Answer must be 1-20 characters in length. 
"BLD",443,1,359,0)
            DESCRIPTION:      This is the IP address used for this attempt.
"BLD",443,1,360,0)

"BLD",443,1,361,0)
e. Change fields in MESSAGE STATISTICS file 4.2999.
"BLD",443,1,362,0)

"BLD",443,1,363,0)
Changed the title and description:
"BLD",443,1,364,0)

"BLD",443,1,365,0)
4.2999,.01  NAME              0;1 POINTER TO DOMAIN FILE (#4.2)
"BLD",443,1,366,0)
                                 (Required)
"BLD",443,1,367,0)
            Domain name               
"BLD",443,1,368,0)
            INPUT TRANSFORM:  S:$D(X) DINUM=X
"BLD",443,1,369,0)
            DESCRIPTION:      Domain for which network mail transmission
"BLD",443,1,370,0)
                              information is collected.
"BLD",443,1,371,0)
            NOTES:            XXXX--CAN'T BE ALTERED EXCEPT BY PROGRAMMER
"BLD",443,1,372,0)
            CROSS-REFERENCE:  4.2999^B
"BLD",443,1,373,0)
                              1)= S ^XMBS(4.2999,"B",$E(X,1,30),DA)=""
"BLD",443,1,374,0)
                              2)= K ^XMBS(4.2999,"B",$E(X,1,30),DA)
"BLD",443,1,375,0)

"BLD",443,1,376,0)
Changed to a pointer and changed the help prompt:
"BLD",443,1,377,0)

"BLD",443,1,378,0)
4.2999,2    MESSAGE IN TRANSIT     3;2 POINTER TO MESSAGE FILE (#3.9)
"BLD",443,1,379,0)
            HELP-PROMPT:    Enter the IEN of the message being transmitted.
"BLD",443,1,380,0)
            DESCRIPTION:    This points to the 3.9 (Message) file entry of
"BLD",443,1,381,0)
                            the message being transmitted.
"BLD",443,1,382,0)

"BLD",443,1,383,0)
Corrected the spelling of "included":
"BLD",443,1,384,0)

"BLD",443,1,385,0)
4.29991,103   MESSAGES RECEIVED    0;3 NUMBER
"BLD",443,1,386,0)

"BLD",443,1,387,0)
              INPUT TRANSFORM:K:+X'=X!(X>9999999)!(X<0)!(X?.E1"."1N.N) X
"BLD",443,1,388,0)
              HELP-PROMPT:  Type a Number between 0 and 9999999, 0 Decimal
"BLD",443,1,389,0)
                            Digits
"BLD",443,1,390,0)
              DESCRIPTION:  Messages received are included here even if
"BLD",443,1,391,0)
                            they are received only to be forwarded on to
"BLD",443,1,392,0)
                            another site.  Also included are responses and
"BLD",443,1,393,0)
                            messages received previously (as long as they
"BLD",443,1,394,0)
                            have additional recipients).
"BLD",443,1,395,0)

"BLD",443,1,396,0)
Increased the length of the following fields:
"BLD",443,1,397,0)

"BLD",443,1,398,0)
4.29991,104   CHARACTERS SENT      0;4 NUMBER
"BLD",443,1,399,0)
              INPUT TRANSFORM:K:+X'=X!(X>999999999)!(X<0)!(X?.E1"."1.N) X
"BLD",443,1,400,0)
              HELP-PROMPT:  Type a number between 0 and 999999999, 0
"BLD",443,1,401,0)
                            Decimal Digits
"BLD",443,1,402,0)
              DESCRIPTION:  This is a count of the number of characters in
"BLD",443,1,403,0)
                            the messages sent.
"BLD",443,1,404,0)

"BLD",443,1,405,0)
4.29991,105   CHARACTERS RECEIVED  0;5 NUMBER
"BLD",443,1,406,0)
              INPUT TRANSFORM:K:+X'=X!(X>999999999)!(X<0)!(X?.E1"."1.N) X
"BLD",443,1,407,0)
              HELP-PROMPT:  Type a number between 0 and 999999999, 0
"BLD",443,1,408,0)
                            Decimal Digits
"BLD",443,1,409,0)
              DESCRIPTION:  This is a count of the number of characters in
"BLD",443,1,410,0)
                            the messages received.
"BLD",443,1,411,0)

"BLD",443,1,412,0)
4.29991,106   LINES SENT           0;6 NUMBER
"BLD",443,1,413,0)
              INPUT TRANSFORM:K:+X'=X!(X>99999999)!(X<0)!(X?.E1"."1.N) X
"BLD",443,1,414,0)
              HELP-PROMPT:  Type a number between 0 and 99999999, 0 Decimal
"BLD",443,1,415,0)
                            Digits
"BLD",443,1,416,0)
              DESCRIPTION:  This is a count of the number of lines in the
"BLD",443,1,417,0)
                            message sent.
"BLD",443,1,418,0)

"BLD",443,1,419,0)
4.29991,107   LINES RECEIVED       0;7 NUMBER
"BLD",443,1,420,0)
              INPUT TRANSFORM:K:+X'=X!(X>99999999)!(X<0)!(X?.E1"."1.N) X
"BLD",443,1,421,0)
              HELP-PROMPT:  Type a number between 0 and 99999999, 0 Decimal
"BLD",443,1,422,0)
                            Digits
"BLD",443,1,423,0)
              DESCRIPTION:  This is a count of the number of lines in the
"BLD",443,1,424,0)
                            messages received.
"BLD",443,1,425,0)

"BLD",443,1,426,0)
f. Add fields to MAILMAN SITE PARAMETERS file 4.3
"BLD",443,1,427,0)
(See items 1 and 2, above, for more info.)
"BLD",443,1,428,0)

"BLD",443,1,429,0)
STANDARD DATA DICTIONARY #4.3 -- MAILMAN SITE PARAMETERS FILE
"BLD",443,1,430,0)
STORED IN ^XMB(1,
"BLD",443,1,431,0)
DATA        NAME            GLOBAL        DATA
"BLD",443,1,432,0)
ELEMENT     TITLE           LOCATION      TYPE
"BLD",443,1,433,0)
---------------------------------------------------------------------------
"BLD",443,1,434,0)
4.3,8.22    DNS AWARE       NETWORK;2 SET
"BLD",443,1,435,0)
                            '0' FOR NO;
"BLD",443,1,436,0)
                            '1' FOR YES;
"BLD",443,1,437,0)
            HELP-PROMPT:    Should MailMan use DNS to look up IP addresses?
"BLD",443,1,438,0)
            DESCRIPTION:    In order for MailMan to be DNS aware, the site
"BLD",443,1,439,0)
                            must have installed the requisite Kernel
"BLD",443,1,440,0)
                            patches for DNS.
"BLD",443,1,441,0)

"BLD",443,1,442,0)
                            If you answer 'no', MailMan will use the IP
"BLD",443,1,443,0)
                            addresses in the domain scripts.
"BLD",443,1,444,0)

"BLD",443,1,445,0)
                            If you answer 'yes', MailMan will use the IP
"BLD",443,1,446,0)
                            addresses in the domain scripts, but if they
"BLD",443,1,447,0)
                            fail, or don't exist, MailMan will use DNS to
"BLD",443,1,448,0)
                            ascertain other IP addresses to try.  MailMan
"BLD",443,1,449,0)
                            will replace failed script IP address with the
"BLD",443,1,450,0)
                            successful DNS IP address.
"BLD",443,1,451,0)

"BLD",443,1,452,0)
4.3,8.23  TCP/IP COMMUNICATIONS PROTOCOL NETWORK;3
"BLD",443,1,453,0)
                            POINTER TO COMMUNICATIONS PROTOCOL FILE (#3.4)
"BLD",443,1,454,0)
                            (Required)
"BLD",443,1,455,0)
          HELP-PROMPT:      Which protocol shall be used for TCP/IP?
"BLD",443,1,456,0)
          DESCRIPTION:      For TCP/IP connections, the scripts (the TEXT
"BLD",443,1,457,0)
                            field, 2, in the TRANSMISSION SCRIPT multiple,
"BLD",443,1,458,0)
                            4, of the DOMAIN file, 4.2) are ignored.
"BLD",443,1,459,0)

"BLD",443,1,460,0)
                            We identify the TCP/IP transmission scripts in
"BLD",443,1,461,0)
                            file 4.2 by the TYPE field, 1.2, within the
"BLD",443,1,462,0)
                            TRANSMISSION SCRIPT multiple.  Those whose TYPE
"BLD",443,1,463,0)
                            is 'SMTP', 'TCPCHAN', or null are considered
"BLD",443,1,464,0)
                            TCP/IP transmission scripts.
"BLD",443,1,465,0)

"BLD",443,1,466,0)
                            We can ignore the scripts, because they are
"BLD",443,1,467,0)
                            standard.
"BLD",443,1,468,0)

"BLD",443,1,469,0)
                            Here's an example of one for FORUM:
"BLD",443,1,470,0)

"BLD",443,1,471,0)
                            O H=FORUM.VA.GOV,P=TCP/IP-MAILMAN
"BLD",443,1,472,0)
                            C TCPCHAN-SOCKET25-VXD
"BLD",443,1,473,0)

"BLD",443,1,474,0)
                            In this script, the TCP/IP-MAILMAN refers to
"BLD",443,1,475,0)
                            the communications protocol to use.  This field
"BLD",443,1,476,0)
                            should point to the communications protocol in
"BLD",443,1,477,0)
                            file 3.4 that should be used for TCP/IP
"BLD",443,1,478,0)
                            connections.
"BLD",443,1,479,0)

"BLD",443,1,480,0)
4.3,8.24  TCP/IP TRANSMISSION SCRIPT NETWORK;4
"BLD",443,1,481,0)
                            POINTER TO TRANSMISSION SCRIPT FILE (#4.6)
"BLD",443,1,482,0)
                            (Required)
"BLD",443,1,483,0)
          HELP-PROMPT:      Which script shall be used for TCP/IP?
"BLD",443,1,484,0)
          DESCRIPTION:      For TCP/IP connections, the scripts (the TEXT
"BLD",443,1,485,0)
                            field, 2, in the TRANSMISSION SCRIPT multiple,
"BLD",443,1,486,0)
                            4, of the DOMAIN file, 4.2) are ignored.
"BLD",443,1,487,0)

"BLD",443,1,488,0)
                            We identify the TCP/IP transmission scripts in
"BLD",443,1,489,0)
                            file 4.2 by the TYPE field, 1.2, within the
"BLD",443,1,490,0)
                            TRANSMISSION SCRIPT multiple.  Those whose TYPE
"BLD",443,1,491,0)
                            is 'SMTP', 'TCPCHAN', or null are considered
"BLD",443,1,492,0)
                            TCP/IP transmission scripts.
"BLD",443,1,493,0)

"BLD",443,1,494,0)
                            We can ignore the scripts, because they are
"BLD",443,1,495,0)
                            standard.
"BLD",443,1,496,0)

"BLD",443,1,497,0)
                            Here's an example of one for FORUM:
"BLD",443,1,498,0)

"BLD",443,1,499,0)
                            O H=FORUM.VA.GOV,P=TCP/IP-MAILMAN
"BLD",443,1,500,0)
                            C TCPCHAN-SOCKET25-VXD
"BLD",443,1,501,0)

"BLD",443,1,502,0)
                            In this script, the TCPCHAN-SOCKET25-VXD refers
"BLD",443,1,503,0)
                            to the transmission script to use.  This field
"BLD",443,1,504,0)
                            should point to the transmission script in file
"BLD",443,1,505,0)
                            4.6 that should be used for TCP/IP connections.
"BLD",443,1,506,0)

"BLD",443,1,507,0)
NOTE: This release should be installed after hours, when user activity is at
"BLD",443,1,508,0)
a minimum.  Your site should be patched through MailMan patch XM*7.1*198.
"BLD",443,1,509,0)
It is also expected that Kernel 8.0 and FileMan 22.0 are installed and are
"BLD",443,1,510,0)
reasonably up-to-date (through patches XU*8.0*216 and DI*22.0*68,
"BLD",443,1,511,0)
respectively).  It is up to you to check this.  KIDS will not.
"BLD",443,1,512,0)
Installation will take approximately 5 minutes.
"BLD",443,1,513,0)
============================================================================ 
"BLD",443,1,514,0)

"BLD",443,1,515,0)
ROUTINES:
"BLD",443,1,516,0)
The second line of the routines now look like:
"BLD",443,1,517,0)
       ;;8.0;MailMan;;Jun 28, 2002
"BLD",443,1,518,0)
 
"BLD",443,1,519,0)
Routine list and checksums can be found in routines XMNTEG and XMNTEG0.
"BLD",443,1,520,0)

"BLD",443,1,521,0)
===========================================================================
"BLD",443,1,522,0)
 
"BLD",443,1,523,0)
INSTALLATION:
"BLD",443,1,524,0)
NOTES:
"BLD",443,1,525,0)
a. This release should be installed after hours, when user activity is at a
"BLD",443,1,526,0)
minimum.  Your site should be patched through MailMan patch XM*7.1*198.  It
"BLD",443,1,527,0)
is also expected that Kernel 8.0 and FileMan 22.0 are installed and are
"BLD",443,1,528,0)
reasonably up-to-date (through patches XU*8.0*216 and DI*22.0*68,
"BLD",443,1,529,0)
respectively).  It is up to you to check this.  KIDS will not.
"BLD",443,1,530,0)
b. Installation will take approximately 5 minutes.
"BLD",443,1,531,0)
c. DSM sites running SlotMaster may see routine mapping problems with ZSLOT
"BLD",443,1,532,0)
users, even after disabling mapping.  Therefore, such sites should consider
"BLD",443,1,533,0)
the following steps:
"BLD",443,1,534,0)
- Shutdown ZSLOT on all nodes.
"BLD",443,1,535,0)
- Disable all mapped XM routines.
"BLD",443,1,536,0)
- Install this release.
"BLD",443,1,537,0)
- Enter manual edits.
"BLD",443,1,538,0)
- Rebuild mapped routine sets.
"BLD",443,1,539,0)
- Shutdown/restart all DSM configurations.
"BLD",443,1,540,0)
An alternative to the above steps is to disable all mapped XM routines about
"BLD",443,1,541,0)
a week before you load this release.  That way you wouldn't need to shutdown
"BLD",443,1,542,0)
ZSLOT or shutdown/restart DSM configurations.
"BLD",443,1,543,0)

"BLD",443,1,544,0)
1.  Users may NOT be on the system during installation of this release.
"BLD",443,1,545,0)
2.  DSM Sites: disable mapping for all MailMan routines.
"BLD",443,1,546,0)
3.  Retrieve the MailMan 8.0 KIDS build (XM8.KID) via FTP from one of the
"BLD",443,1,547,0)
    Anonymous Directories by following the instructions in the MailMan 8.0
"BLD",443,1,548,0)
    Release Message.
"BLD",443,1,549,0)
4.  On the KIDS:Installation menu, use the following option to load the
"BLD",443,1,550,0)
    build into a Transport Global on your system:
"BLD",443,1,551,0)
       Load a Distribution
"BLD",443,1,552,0)
 Enter a Host File: E:\INETPUB\FTPROOT\XM8.KID or USR$:[USER.NAME]XM8.KID
"BLD",443,1,553,0)
                    ==========================    =======================
"BLD",443,1,554,0)
 (How you answer the above prompt depends on the system you're on and where
"BLD",443,1,555,0)
 you placed the build you retrieved in the previous step.  The answers
"BLD",443,1,556,0)
 shown are examples only.)
"BLD",443,1,557,0)
5.  Users should not be on the system.
"BLD",443,1,558,0)
    Place TaskMan in a WAIT state.
"BLD",443,1,559,0)
    You may also wish to shut down HL7 filers/LLP's and other background
"BLD",443,1,560,0)
    tasks which may attempt to create new messages.
"BLD",443,1,561,0)
6.  On the Manage MailMan:Local Delivery Management menu, use the following
"BLD",443,1,562,0)
    option to stop the background filer:
"BLD",443,1,563,0)
       STOP background filer
"BLD",443,1,564,0)
Are you sure you want Background Filers to stop delivering mail? No// YES
"BLD",443,1,565,0)
                                                                      ===
"BLD",443,1,566,0)
<< Background Filers will stop soon. >>
"BLD",443,1,567,0)
7.  On the KIDS:Installation menu, use the following options to install the
"BLD",443,1,568,0)
    Transport Global:
"BLD",443,1,569,0)
       Verify Checksums in Transport Global
"BLD",443,1,570,0)
       Print Transport Global
"BLD",443,1,571,0)
       Compare Transport Global to Current System
"BLD",443,1,572,0)
       Backup a Transport Global
"BLD",443,1,573,0)
       Install Package(s)
"BLD",443,1,574,0)
 Select INSTALL NAME:   MAILMAN 8.0   Loaded from Distribution  <date/time>
"BLD",443,1,575,0)
                        ===========
"BLD",443,1,576,0)
Install Questions for MAILMAN 8.0
"BLD",443,1,577,0)

"BLD",443,1,578,0)
Incoming Files:
"BLD",443,1,579,0)

"BLD",443,1,580,0)
   3.4       COMMUNICATIONS PROTOCOL
"BLD",443,1,581,0)
Note:  You already have the 'COMMUNICATIONS PROTOCOL' File.
"BLD",443,1,582,0)

"BLD",443,1,583,0)
   3.6       BULLETIN
"BLD",443,1,584,0)
Note:  You already have the 'BULLETIN' File.
"BLD",443,1,585,0)

"BLD",443,1,586,0)
   3.7       MAILBOX
"BLD",443,1,587,0)
Note:  You already have the 'MAILBOX' File.
"BLD",443,1,588,0)

"BLD",443,1,589,0)
   3.73      MESSAGES TO BE NEW AT A LATER DATE
"BLD",443,1,590,0)
Note:  You already have the 'MESSAGES TO BE NEW AT A LATER DATE' File.
"BLD",443,1,591,0)

"BLD",443,1,592,0)
   3.8       MAIL GROUP
"BLD",443,1,593,0)
Note:  You already have the 'MAIL GROUP' File.
"BLD",443,1,594,0)

"BLD",443,1,595,0)
   3.816     DISTRIBUTION LIST
"BLD",443,1,596,0)
Note:  You already have the 'DISTRIBUTION LIST' File.
"BLD",443,1,597,0)

"BLD",443,1,598,0)
   3.9       MESSAGE
"BLD",443,1,599,0)
Note:  You already have the 'MESSAGE' File.
"BLD",443,1,600,0)

"BLD",443,1,601,0)
   4.2       DOMAIN
"BLD",443,1,602,0)
Note:  You already have the 'DOMAIN' File.
"BLD",443,1,603,0)

"BLD",443,1,604,0)
   4.281     INTER-UCI TRANSFER
"BLD",443,1,605,0)
Note:  You already have the 'INTER-UCI TRANSFER' File.
"BLD",443,1,606,0)

"BLD",443,1,607,0)
   4.2996    INTERNET SUFFIX
"BLD",443,1,608,0)
Note:  You already have the 'INTERNET SUFFIX' File.
"BLD",443,1,609,0)

"BLD",443,1,610,0)
   4.2997    REMOTE USER DIRECTORY
"BLD",443,1,611,0)
Note:  You already have the 'REMOTE USER DIRECTORY' File.
"BLD",443,1,612,0)

"BLD",443,1,613,0)
   4.2998    MESSAGE DELIVERY STATS
"BLD",443,1,614,0)
Note:  You already have the 'MESSAGE DELIVERY STATS' File.
"BLD",443,1,615,0)

"BLD",443,1,616,0)
   4.2999    MESSAGE STATISTICS
"BLD",443,1,617,0)
Note:  You already have the 'MESSAGE STATISTICS' File.
"BLD",443,1,618,0)

"BLD",443,1,619,0)
   4.3       MAILMAN SITE PARAMETERS
"BLD",443,1,620,0)
Note:  You already have the 'MAILMAN SITE PARAMETERS' File.
"BLD",443,1,621,0)

"BLD",443,1,622,0)
   4.4       MAILMAN TIME ZONE
"BLD",443,1,623,0)
Note:  You already have the 'MAILMAN TIME ZONE' File.
"BLD",443,1,624,0)

"BLD",443,1,625,0)
   4.501     NETWORK SENDERS REJECTED
"BLD",443,1,626,0)
Note:  You already have the 'NETWORK SENDERS REJECTED' File.
"BLD",443,1,627,0)

"BLD",443,1,628,0)
   4.6       TRANSMISSION SCRIPT
"BLD",443,1,629,0)
Note:  You already have the 'TRANSMISSION SCRIPT' File.
"BLD",443,1,630,0)

"BLD",443,1,631,0)
Incoming Mail Groups:
"BLD",443,1,632,0)

"BLD",443,1,633,0)
Enter the Coordinator for Mail Group 'XM SUPER SEARCH': <Your site's ISO>
"BLD",443,1,634,0)
                                                        =================
"BLD",443,1,635,0)
Want KIDS to Rebuild Menu Trees Upon Completion of Install? YES// YES
"BLD",443,1,636,0)
                                                                  ===
"BLD",443,1,637,0)
Want KIDS to INHIBIT LOGONs during the install? YES// YES
"BLD",443,1,638,0)
                                                      ===
"BLD",443,1,639,0)
Want to DISABLE Scheduled Options, Menu Options, and Protocols? YES// NO
"BLD",443,1,640,0)
                                                                      ==
"BLD",443,1,641,0)
 Enter the Device you want to print the Install messages.
"BLD",443,1,642,0)
 You can queue the install by enter a 'Q' at the device prompt.
"BLD",443,1,643,0)
 Enter a '^' to abort the install.
"BLD",443,1,644,0)

"BLD",443,1,645,0)
 DEVICE: HOME// <Don't queue this>
"BLD",443,1,646,0)
                ------------------
"BLD",443,1,647,0)
8. Remove TaskMan from WAIT State.  If you shut down HL7 filers/LLPs or
"BLD",443,1,648,0)
   any other background tasks, you may restart them.
"BLD",443,1,649,0)
9. Start the background filer.
"BLD",443,1,650,0)
    On the Manage MailMan:Local Delivery Management menu, use the following
"BLD",443,1,651,0)
    option to start the background filer:
"BLD",443,1,652,0)
       START background filer
"BLD",443,1,653,0)
   << Background Filers will start soon. >>
"BLD",443,1,654,0)
10. Ensure that the new fields in file 4.3, MAILMAN SITE PARAMETERS, are
"BLD",443,1,655,0)
correctly entered:
"BLD",443,1,656,0)
     8.22  DNS AWARE                        Yes or No?
"BLD",443,1,657,0)
     8.23  TCP/IP COMMUNICATIONS PROTOCOL   Points to file 3.4
"BLD",443,1,658,0)
     8.24  TCP/IP TRANSMISSION SCRIPT       Points to file 4.6
"BLD",443,1,659,0)
11. DSM Sites: If your site maps routines, then rebuild your map set.
"BLD",443,1,660,0)
    Many routines have become obsolete and should be removed from the map
"BLD",443,1,661,0)
    set.  Here is a new recommended list of routines to map, should your
"BLD",443,1,662,0)
    site choose to map routines:
"BLD",443,1,663,0)
    Minimum                           Additional
"BLD",443,1,664,0)
    -------                           ----------
"BLD",443,1,665,0)
    XM                                XMC1A,XMC1B
"BLD",443,1,666,0)
    XMC1                              XMK*
"BLD",443,1,667,0)
    XMJ*                              XML
"BLD",443,1,668,0)
    XMR                               XMR1,XMR2,XMR3*
"BLD",443,1,669,0)
    XMS                               XMS1,XMS2,XMS3
"BLD",443,1,670,0)
                                      XMT*
"BLD",443,1,671,0)
                                      XMVVITAE
"BLD",443,1,672,0)
                                      XMXADDR*
"BLD",443,1,673,0)
                                      XMXSEC*
"BLD",443,1,674,0)
                                      XMXUTIL*
"BLD",443,1,675,0)
===========================================================================
"BLD",443,4,0)
^9.64PA^4.2995^18
"BLD",443,4,3.4,0)
3.4
"BLD",443,4,3.4,222)
y^y^f^^^^n
"BLD",443,4,3.6,0)
3.6
"BLD",443,4,3.6,222)
y^y^f^^^^n
"BLD",443,4,3.7,0)
3.7
"BLD",443,4,3.7,222)
y^y^f^^^^n
"BLD",443,4,3.73,0)
3.73
"BLD",443,4,3.73,222)
y^y^f^^^^n
"BLD",443,4,3.8,0)
3.8
"BLD",443,4,3.8,222)
y^y^f^^^^n
"BLD",443,4,3.816,0)
3.816
"BLD",443,4,3.816,222)
y^y^f^^^^n
"BLD",443,4,3.9,0)
3.9
"BLD",443,4,3.9,222)
y^y^f^^^^n
"BLD",443,4,4.2,0)
4.2
"BLD",443,4,4.2,222)
y^y^f^^^^n
"BLD",443,4,4.281,0)
4.281
"BLD",443,4,4.281,222)
y^y^f^^^^n
"BLD",443,4,4.2995,0)
4.2995
"BLD",443,4,4.2995,222)
y^y^f^^^^n
"BLD",443,4,4.2996,0)
4.2996
"BLD",443,4,4.2996,222)
y^y^f^^^^n
"BLD",443,4,4.2997,0)
4.2997
"BLD",443,4,4.2997,222)
y^y^f^^^^n
"BLD",443,4,4.2998,0)
4.2998
"BLD",443,4,4.2998,222)
y^y^f^^^^n
"BLD",443,4,4.2999,0)
4.2999
"BLD",443,4,4.2999,222)
y^y^f^^^^n
"BLD",443,4,4.3,0)
4.3
"BLD",443,4,4.3,222)
y^y^f^^^^n
"BLD",443,4,4.4,0)
4.4
"BLD",443,4,4.4,222)
y^y^f^^^^n
"BLD",443,4,4.501,0)
4.501
"BLD",443,4,4.501,222)
y^y^f^^^^n
"BLD",443,4,4.6,0)
4.6
"BLD",443,4,4.6,222)
y^y^f^^^^n
"BLD",443,4,"B",3.4,3.4)

"BLD",443,4,"B",3.6,3.6)

"BLD",443,4,"B",3.7,3.7)

"BLD",443,4,"B",3.73,3.73)

"BLD",443,4,"B",3.8,3.8)

"BLD",443,4,"B",3.816,3.816)

"BLD",443,4,"B",3.9,3.9)

"BLD",443,4,"B",4.2,4.2)

"BLD",443,4,"B",4.281,4.281)

"BLD",443,4,"B",4.2995,4.2995)

"BLD",443,4,"B",4.2996,4.2996)

"BLD",443,4,"B",4.2997,4.2997)

"BLD",443,4,"B",4.2998,4.2998)

"BLD",443,4,"B",4.2999,4.2999)

"BLD",443,4,"B",4.3,4.3)

"BLD",443,4,"B",4.4,4.4)

"BLD",443,4,"B",4.501,4.501)

"BLD",443,4,"B",4.6,4.6)

"BLD",443,"ABPKG")
n
"BLD",443,"INI")
PRE^XMYPRE
"BLD",443,"INID")
^n^n
"BLD",443,"INIT")
POST^XMYPRE
"BLD",443,"KRN",0)
^9.67PA^8989.52^17
"BLD",443,"KRN",.4,0)
.4
"BLD",443,"KRN",.4,"NM",0)
^9.68A^17^10
"BLD",443,"KRN",.4,"NM",4,0)
XMHOSTLIST    FILE #4.2^4.2^0
"BLD",443,"KRN",.4,"NM",5,0)
XMMGR-BKFILER-ACTIVE_USERS/DEL    FILE #4.2998^4.2998^0
"BLD",443,"KRN",.4,"NM",7,0)
XMMGR-BKFILER-LENGTH_OF_QUEUES    FILE #4.2998^4.2998^0
"BLD",443,"KRN",.4,"NM",10,0)
XMMGR-BKFILER-QUEUE-WAIT    FILE #4.2998^4.2998^0
"BLD",443,"KRN",.4,"NM",12,0)
XMMGR-BKFILER-STATS/TABBED    FILE #4.2998^4.2998^0
"BLD",443,"KRN",.4,"NM",13,0)
XMMGR-BKFILER-TABBED-RT    FILE #4.2998^4.2998^0
"BLD",443,"KRN",.4,"NM",14,0)
XMMGR-BKFILER-DEL_BY_GROUP    FILE #4.2998^4.2998^0
"BLD",443,"KRN",.4,"NM",15,0)
XMMGR-BKFILER-LONGTERM-STATS    FILE #4.2998^4.2998^0
"BLD",443,"KRN",.4,"NM",16,0)
XMMGR-BKFILER-OLD_STATS/TABBED    FILE #4.2998^4.2998^0
"BLD",443,"KRN",.4,"NM",17,0)
XMMGR-BKFILER-STATS-PLUS    FILE #4.2998^4.2998^0
"BLD",443,"KRN",.4,"NM","B","XMHOSTLIST    FILE #4.2",4)

"BLD",443,"KRN",.4,"NM","B","XMMGR-BKFILER-ACTIVE_USERS/DEL    FILE #4.2998",5)

"BLD",443,"KRN",.4,"NM","B","XMMGR-BKFILER-DEL_BY_GROUP    FILE #4.2998",14)

"BLD",443,"KRN",.4,"NM","B","XMMGR-BKFILER-LENGTH_OF_QUEUES    FILE #4.2998",7)

"BLD",443,"KRN",.4,"NM","B","XMMGR-BKFILER-LONGTERM-STATS    FILE #4.2998",15)

"BLD",443,"KRN",.4,"NM","B","XMMGR-BKFILER-OLD_STATS/TABBED    FILE #4.2998",16)

"BLD",443,"KRN",.4,"NM","B","XMMGR-BKFILER-QUEUE-WAIT    FILE #4.2998",10)

"BLD",443,"KRN",.4,"NM","B","XMMGR-BKFILER-STATS-PLUS    FILE #4.2998",17)

"BLD",443,"KRN",.4,"NM","B","XMMGR-BKFILER-STATS/TABBED    FILE #4.2998",12)

"BLD",443,"KRN",.4,"NM","B","XMMGR-BKFILER-TABBED-RT    FILE #4.2998",13)

"BLD",443,"KRN",.401,0)
.401
"BLD",443,"KRN",.401,"NM",0)
^9.68A^4^2
"BLD",443,"KRN",.401,"NM",3,0)
XMMGR-BKFILER-DAY@23:30    FILE #4.2998^4.2998^0
"BLD",443,"KRN",.401,"NM",4,0)
XMMGR-BKFILER-TIME_PER_DATE    FILE #4.2998^4.2998^0
"BLD",443,"KRN",.401,"NM","B","XMMGR-BKFILER-DAY@23:30    FILE #4.2998",3)

"BLD",443,"KRN",.401,"NM","B","XMMGR-BKFILER-TIME_PER_DATE    FILE #4.2998",4)

"BLD",443,"KRN",.402,0)
.402
"BLD",443,"KRN",.402,"NM",0)
^9.68A^^
"BLD",443,"KRN",.403,0)
.403
"BLD",443,"KRN",.403,"NM",0)
^9.68A^^
"BLD",443,"KRN",.5,0)
.5
"BLD",443,"KRN",.5,"NM",0)
^9.68A^1^1
"BLD",443,"KRN",.5,"NM",1,0)
XM NEXT SEQUENCE NUMBER^^0
"BLD",443,"KRN",.5,"NM","B","XM NEXT SEQUENCE NUMBER",1)

"BLD",443,"KRN",.84,0)
.84
"BLD",443,"KRN",.84,"NM",0)
^9.68A^1448^1438
"BLD",443,"KRN",.84,"NM",1,0)
34332^^0
"BLD",443,"KRN",.84,"NM",2,0)
34332.1^^0
"BLD",443,"KRN",.84,"NM",3,0)
34332.2^^0
"BLD",443,"KRN",.84,"NM",4,0)
34332.3^^0
"BLD",443,"KRN",.84,"NM",5,0)
39205^^0
"BLD",443,"KRN",.84,"NM",6,0)
39036.5^^0
"BLD",443,"KRN",.84,"NM",7,0)
37447^^0
"BLD",443,"KRN",.84,"NM",9,0)
42201^^0
"BLD",443,"KRN",.84,"NM",10,0)
42201.01^^0
"BLD",443,"KRN",.84,"NM",11,0)
42201.02^^0
"BLD",443,"KRN",.84,"NM",12,0)
42201.03^^0
"BLD",443,"KRN",.84,"NM",13,0)
42201.04^^0
"BLD",443,"KRN",.84,"NM",14,0)
42201.05^^0
"BLD",443,"KRN",.84,"NM",15,0)
42201.06^^0
"BLD",443,"KRN",.84,"NM",16,0)
42201.07^^0
"BLD",443,"KRN",.84,"NM",17,0)
42201.08^^0
"BLD",443,"KRN",.84,"NM",18,0)
42201.09^^0
"BLD",443,"KRN",.84,"NM",19,0)
42201.1^^0
"BLD",443,"KRN",.84,"NM",20,0)
42201.11^^0
"BLD",443,"KRN",.84,"NM",21,0)
42201.12^^0
"BLD",443,"KRN",.84,"NM",22,0)
42201.13^^0
"BLD",443,"KRN",.84,"NM",23,0)
42201.14^^0
"BLD",443,"KRN",.84,"NM",24,0)
42201.15^^0
"BLD",443,"KRN",.84,"NM",25,0)
42201.16^^0
"BLD",443,"KRN",.84,"NM",26,0)
42201.17^^0
"BLD",443,"KRN",.84,"NM",27,0)
42201.18^^0
"BLD",443,"KRN",.84,"NM",28,0)
42210^^0
"BLD",443,"KRN",.84,"NM",30,0)
42212^^0
"BLD",443,"KRN",.84,"NM",31,0)
42213^^0
"BLD",443,"KRN",.84,"NM",32,0)
42214^^0
"BLD",443,"KRN",.84,"NM",33,0)
42215^^0
"BLD",443,"KRN",.84,"NM",34,0)
42216^^0
"BLD",443,"KRN",.84,"NM",35,0)
42217^^0
"BLD",443,"KRN",.84,"NM",36,0)
42218^^0
"BLD",443,"KRN",.84,"NM",37,0)
42219^^0
"BLD",443,"KRN",.84,"NM",38,0)
42220^^0
"BLD",443,"KRN",.84,"NM",39,0)
42221^^0
"BLD",443,"KRN",.84,"NM",40,0)
42222^^0
"BLD",443,"KRN",.84,"NM",41,0)
42222.1^^0
"BLD",443,"KRN",.84,"NM",42,0)
42222.2^^0
"BLD",443,"KRN",.84,"NM",43,0)
42223^^0
"BLD",443,"KRN",.84,"NM",44,0)
42224^^0
"BLD",443,"KRN",.84,"NM",45,0)
42225^^0
"BLD",443,"KRN",.84,"NM",46,0)
42226^^0
"BLD",443,"KRN",.84,"NM",47,0)
42227^^0
"BLD",443,"KRN",.84,"NM",48,0)
42228^^0
"BLD",443,"KRN",.84,"NM",50,0)
42230^^0
"BLD",443,"KRN",.84,"NM",51,0)
42231^^0
"BLD",443,"KRN",.84,"NM",52,0)
42232^^0
"BLD",443,"KRN",.84,"NM",53,0)
42233^^0
"BLD",443,"KRN",.84,"NM",54,0)
42234^^0
"BLD",443,"KRN",.84,"NM",55,0)
42235^^0
"BLD",443,"KRN",.84,"NM",56,0)
42236^^0
"BLD",443,"KRN",.84,"NM",57,0)
42237^^0
"BLD",443,"KRN",.84,"NM",58,0)
42240^^0
"BLD",443,"KRN",.84,"NM",59,0)
42241^^0
"BLD",443,"KRN",.84,"NM",60,0)
42245^^0
"BLD",443,"KRN",.84,"NM",61,0)
42246^^0
"BLD",443,"KRN",.84,"NM",62,0)
42247^^0
"BLD",443,"KRN",.84,"NM",63,0)
42248^^0
"BLD",443,"KRN",.84,"NM",64,0)
42250^^0
"BLD",443,"KRN",.84,"NM",65,0)
42251^^0
"BLD",443,"KRN",.84,"NM",66,0)
42252^^0
"BLD",443,"KRN",.84,"NM",67,0)
42253^^0
"BLD",443,"KRN",.84,"NM",68,0)
42254^^0
"BLD",443,"KRN",.84,"NM",69,0)
42255^^0
"BLD",443,"KRN",.84,"NM",70,0)
42256^^0
"BLD",443,"KRN",.84,"NM",71,0)
42257^^0
"BLD",443,"KRN",.84,"NM",72,0)
42150^^0
"BLD",443,"KRN",.84,"NM",73,0)
42151^^0
"BLD",443,"KRN",.84,"NM",74,0)
42152^^0
"BLD",443,"KRN",.84,"NM",75,0)
42153^^0
"BLD",443,"KRN",.84,"NM",76,0)
42263^^0
"BLD",443,"KRN",.84,"NM",77,0)
42264^^0
"BLD",443,"KRN",.84,"NM",78,0)
42265^^0
"BLD",443,"KRN",.84,"NM",79,0)
42266^^0
"BLD",443,"KRN",.84,"NM",80,0)
42170^^0
"BLD",443,"KRN",.84,"NM",81,0)
42171^^0
"BLD",443,"KRN",.84,"NM",82,0)
42171.1^^0
"BLD",443,"KRN",.84,"NM",83,0)
42172^^0
"BLD",443,"KRN",.84,"NM",84,0)
42173^^0
"BLD",443,"KRN",.84,"NM",85,0)
42174^^0
"BLD",443,"KRN",.84,"NM",86,0)
42175^^0
"BLD",443,"KRN",.84,"NM",87,0)
42176^^0
"BLD",443,"KRN",.84,"NM",88,0)
42177^^0
"BLD",443,"KRN",.84,"NM",89,0)
34007.2^^0
"BLD",443,"KRN",.84,"NM",90,0)
42281^^0
"BLD",443,"KRN",.84,"NM",91,0)
42282^^0
"BLD",443,"KRN",.84,"NM",92,0)
42283^^0
"BLD",443,"KRN",.84,"NM",93,0)
42284^^0
"BLD",443,"KRN",.84,"NM",94,0)
42285^^0
"BLD",443,"KRN",.84,"NM",95,0)
42286^^0
"BLD",443,"KRN",.84,"NM",96,0)
42287^^0
"BLD",443,"KRN",.84,"NM",97,0)
42288^^0
"BLD",443,"KRN",.84,"NM",98,0)
42288.1^^0
"BLD",443,"KRN",.84,"NM",99,0)
42289^^0
"BLD",443,"KRN",.84,"NM",100,0)
42289.1^^0
"BLD",443,"KRN",.84,"NM",101,0)
42244^^0
"BLD",443,"KRN",.84,"NM",102,0)
42300^^0
"BLD",443,"KRN",.84,"NM",103,0)
42301^^0
"BLD",443,"KRN",.84,"NM",104,0)
42305^^0
"BLD",443,"KRN",.84,"NM",105,0)
42306^^0
"BLD",443,"KRN",.84,"NM",106,0)
42307^^0
"BLD",443,"KRN",.84,"NM",107,0)
42308^^0
"BLD",443,"KRN",.84,"NM",108,0)
42309^^0
"BLD",443,"KRN",.84,"NM",109,0)
42315^^0
"BLD",443,"KRN",.84,"NM",110,0)
42316^^0
"BLD",443,"KRN",.84,"NM",111,0)
42350^^0
"BLD",443,"KRN",.84,"NM",112,0)
42351^^0
"BLD",443,"KRN",.84,"NM",113,0)
42352^^0
"BLD",443,"KRN",.84,"NM",114,0)
42353^^0
"BLD",443,"KRN",.84,"NM",115,0)
42354^^0
"BLD",443,"KRN",.84,"NM",116,0)
42355^^0
"BLD",443,"KRN",.84,"NM",117,0)
39303.6^^0
"BLD",443,"KRN",.84,"NM",118,0)
42356^^0
"BLD",443,"KRN",.84,"NM",119,0)
42357^^0
"BLD",443,"KRN",.84,"NM",120,0)
42260^^0
"BLD",443,"KRN",.84,"NM",121,0)
42261^^0
"BLD",443,"KRN",.84,"NM",122,0)
42262^^0
"BLD",443,"KRN",.84,"NM",123,0)
42267^^0
"BLD",443,"KRN",.84,"NM",124,0)
42268^^0
"BLD",443,"KRN",.84,"NM",125,0)
42191^^0
"BLD",443,"KRN",.84,"NM",126,0)
42190^^0
"BLD",443,"KRN",.84,"NM",127,0)
42000.1^^0
"BLD",443,"KRN",.84,"NM",128,0)
42000.2^^0
"BLD",443,"KRN",.84,"NM",129,0)
42192^^0
"BLD",443,"KRN",.84,"NM",130,0)
42229^^0
"BLD",443,"KRN",.84,"NM",131,0)
34019.1^^0
"BLD",443,"KRN",.84,"NM",132,0)
38159.1^^0
"BLD",443,"KRN",.84,"NM",134,0)
39330^^0
"BLD",443,"KRN",.84,"NM",135,0)
39331^^0
"BLD",443,"KRN",.84,"NM",136,0)
39332^^0
"BLD",443,"KRN",.84,"NM",137,0)
39333^^0
"BLD",443,"KRN",.84,"NM",138,0)
39334^^0
"BLD",443,"KRN",.84,"NM",139,0)
39303.7^^0
"BLD",443,"KRN",.84,"NM",140,0)
42260.1^^0
"BLD",443,"KRN",.84,"NM",141,0)
42260.2^^0
"BLD",443,"KRN",.84,"NM",142,0)
42260.3^^0
"BLD",443,"KRN",.84,"NM",143,0)
42260.4^^0
"BLD",443,"KRN",.84,"NM",144,0)
42137^^0
"BLD",443,"KRN",.84,"NM",145,0)
34353^^0
"BLD",443,"KRN",.84,"NM",146,0)
34001^^0
"BLD",443,"KRN",.84,"NM",147,0)
34002^^0
"BLD",443,"KRN",.84,"NM",148,0)
34003^^0
"BLD",443,"KRN",.84,"NM",149,0)
34003.1^^0
"BLD",443,"KRN",.84,"NM",150,0)
34004^^0
"BLD",443,"KRN",.84,"NM",151,0)
34005^^0
"BLD",443,"KRN",.84,"NM",152,0)
34006^^0
"BLD",443,"KRN",.84,"NM",153,0)
34007^^0
"BLD",443,"KRN",.84,"NM",154,0)
34007.1^^0
"BLD",443,"KRN",.84,"NM",155,0)
34008^^0
"BLD",443,"KRN",.84,"NM",156,0)
34009^^0
"BLD",443,"KRN",.84,"NM",157,0)
34010^^0
"BLD",443,"KRN",.84,"NM",158,0)
34011^^0
"BLD",443,"KRN",.84,"NM",159,0)
34012^^0
"BLD",443,"KRN",.84,"NM",160,0)
34013^^0
"BLD",443,"KRN",.84,"NM",161,0)
34014^^0
"BLD",443,"KRN",.84,"NM",162,0)
34015^^0
"BLD",443,"KRN",.84,"NM",163,0)
34016^^0
"BLD",443,"KRN",.84,"NM",164,0)
34017^^0
"BLD",443,"KRN",.84,"NM",165,0)
34018^^0
"BLD",443,"KRN",.84,"NM",166,0)
34019^^0
"BLD",443,"KRN",.84,"NM",167,0)
34020^^0
"BLD",443,"KRN",.84,"NM",168,0)
34021^^0
"BLD",443,"KRN",.84,"NM",169,0)
34022^^0
"BLD",443,"KRN",.84,"NM",170,0)
34023^^0
"BLD",443,"KRN",.84,"NM",171,0)
34024^^0
"BLD",443,"KRN",.84,"NM",172,0)
34025^^0
"BLD",443,"KRN",.84,"NM",173,0)
34026^^0
"BLD",443,"KRN",.84,"NM",174,0)
34026.1^^0
"BLD",443,"KRN",.84,"NM",175,0)
34027^^0
"BLD",443,"KRN",.84,"NM",176,0)
34027.1^^0
"BLD",443,"KRN",.84,"NM",177,0)
34027.2^^0
"BLD",443,"KRN",.84,"NM",178,0)
34028^^0
"BLD",443,"KRN",.84,"NM",179,0)
34029^^0
"BLD",443,"KRN",.84,"NM",180,0)
34030^^0
"BLD",443,"KRN",.84,"NM",181,0)
34030.9^^0
"BLD",443,"KRN",.84,"NM",182,0)
34031^^0
"BLD",443,"KRN",.84,"NM",183,0)
34032^^0
"BLD",443,"KRN",.84,"NM",184,0)
34034^^0
"BLD",443,"KRN",.84,"NM",185,0)
34035^^0
"BLD",443,"KRN",.84,"NM",186,0)
34036^^0
"BLD",443,"KRN",.84,"NM",187,0)
34037^^0
"BLD",443,"KRN",.84,"NM",188,0)
34038^^0
"BLD",443,"KRN",.84,"NM",189,0)
34039^^0
"BLD",443,"KRN",.84,"NM",190,0)
34040^^0
"BLD",443,"KRN",.84,"NM",191,0)
34041^^0
"BLD",443,"KRN",.84,"NM",192,0)
34042^^0
"BLD",443,"KRN",.84,"NM",193,0)
34043^^0
"BLD",443,"KRN",.84,"NM",194,0)
34043.1^^0
"BLD",443,"KRN",.84,"NM",195,0)
34044^^0
"BLD",443,"KRN",.84,"NM",196,0)
34045^^0
"BLD",443,"KRN",.84,"NM",197,0)
34046^^0
"BLD",443,"KRN",.84,"NM",198,0)
34047^^0
"BLD",443,"KRN",.84,"NM",199,0)
34048^^0
"BLD",443,"KRN",.84,"NM",200,0)
34048.8^^0
"BLD",443,"KRN",.84,"NM",201,0)
34048.9^^0
"BLD",443,"KRN",.84,"NM",202,0)
34050^^0
"BLD",443,"KRN",.84,"NM",203,0)
34051^^0
"BLD",443,"KRN",.84,"NM",204,0)
34051.1^^0
"BLD",443,"KRN",.84,"NM",205,0)
34052^^0
"BLD",443,"KRN",.84,"NM",206,0)
34053^^0
"BLD",443,"KRN",.84,"NM",207,0)
34054^^0
"BLD",443,"KRN",.84,"NM",208,0)
34055^^0
"BLD",443,"KRN",.84,"NM",209,0)
34056^^0
"BLD",443,"KRN",.84,"NM",210,0)
34057^^0
"BLD",443,"KRN",.84,"NM",211,0)
34058^^0
"BLD",443,"KRN",.84,"NM",212,0)
34059^^0
"BLD",443,"KRN",.84,"NM",213,0)
34060^^0
"BLD",443,"KRN",.84,"NM",214,0)
34061^^0
"BLD",443,"KRN",.84,"NM",215,0)
34065^^0
"BLD",443,"KRN",.84,"NM",216,0)
34066^^0
"BLD",443,"KRN",.84,"NM",217,0)
34067^^0
"BLD",443,"KRN",.84,"NM",218,0)
34068^^0
"BLD",443,"KRN",.84,"NM",219,0)
34070^^0
"BLD",443,"KRN",.84,"NM",220,0)
34071^^0
"BLD",443,"KRN",.84,"NM",221,0)
34072^^0
"BLD",443,"KRN",.84,"NM",222,0)
34075^^0
"BLD",443,"KRN",.84,"NM",223,0)
34076^^0
"BLD",443,"KRN",.84,"NM",224,0)
34077^^0
"BLD",443,"KRN",.84,"NM",225,0)
34078^^0
"BLD",443,"KRN",.84,"NM",226,0)
34079^^0
"BLD",443,"KRN",.84,"NM",227,0)
34081^^0
"BLD",443,"KRN",.84,"NM",228,0)
34082^^0
"BLD",443,"KRN",.84,"NM",229,0)
34085^^0
"BLD",443,"KRN",.84,"NM",230,0)
34086^^0
"BLD",443,"KRN",.84,"NM",231,0)
34087^^0
"BLD",443,"KRN",.84,"NM",232,0)
34088^^0
"BLD",443,"KRN",.84,"NM",233,0)
34089^^0
"BLD",443,"KRN",.84,"NM",234,0)
34090^^0
"BLD",443,"KRN",.84,"NM",235,0)
34091^^0
"BLD",443,"KRN",.84,"NM",236,0)
34092^^0
"BLD",443,"KRN",.84,"NM",237,0)
34098^^0
"BLD",443,"KRN",.84,"NM",238,0)
34099^^0
"BLD",443,"KRN",.84,"NM",239,0)
34100^^0
"BLD",443,"KRN",.84,"NM",240,0)
34101^^0
"BLD",443,"KRN",.84,"NM",241,0)
34102^^0
"BLD",443,"KRN",.84,"NM",242,0)
34103^^0
"BLD",443,"KRN",.84,"NM",243,0)
34104^^0
"BLD",443,"KRN",.84,"NM",244,0)
34105^^0
"BLD",443,"KRN",.84,"NM",245,0)
34106^^0
"BLD",443,"KRN",.84,"NM",246,0)
34107^^0
"BLD",443,"KRN",.84,"NM",247,0)
34110^^0
"BLD",443,"KRN",.84,"NM",248,0)
34111^^0
"BLD",443,"KRN",.84,"NM",249,0)
34112^^0
"BLD",443,"KRN",.84,"NM",250,0)
34113^^0
"BLD",443,"KRN",.84,"NM",251,0)
34114^^0
"BLD",443,"KRN",.84,"NM",252,0)
34115^^0
"BLD",443,"KRN",.84,"NM",253,0)
34116^^0
"BLD",443,"KRN",.84,"NM",254,0)
34117^^0
"BLD",443,"KRN",.84,"NM",255,0)
34120^^0
"BLD",443,"KRN",.84,"NM",256,0)
34121^^0
"BLD",443,"KRN",.84,"NM",257,0)
34122^^0
"BLD",443,"KRN",.84,"NM",258,0)
34123^^0
"BLD",443,"KRN",.84,"NM",259,0)
34124^^0
"BLD",443,"KRN",.84,"NM",260,0)
34125^^0
"BLD",443,"KRN",.84,"NM",261,0)
34126^^0
"BLD",443,"KRN",.84,"NM",262,0)
34130^^0
"BLD",443,"KRN",.84,"NM",263,0)
34131^^0
"BLD",443,"KRN",.84,"NM",264,0)
34132^^0
"BLD",443,"KRN",.84,"NM",265,0)
34133^^0
"BLD",443,"KRN",.84,"NM",266,0)
34140^^0
"BLD",443,"KRN",.84,"NM",267,0)
34141^^0
"BLD",443,"KRN",.84,"NM",268,0)
34142^^0
"BLD",443,"KRN",.84,"NM",269,0)
34143^^0
"BLD",443,"KRN",.84,"NM",270,0)
34144^^0
"BLD",443,"KRN",.84,"NM",271,0)
34145^^0
"BLD",443,"KRN",.84,"NM",272,0)
34146^^0
"BLD",443,"KRN",.84,"NM",273,0)
34149^^0
"BLD",443,"KRN",.84,"NM",274,0)
34200^^0
"BLD",443,"KRN",.84,"NM",275,0)
34201^^0
"BLD",443,"KRN",.84,"NM",276,0)
34202^^0
"BLD",443,"KRN",.84,"NM",277,0)
34203^^0
"BLD",443,"KRN",.84,"NM",278,0)
34204^^0
"BLD",443,"KRN",.84,"NM",279,0)
34205^^0
"BLD",443,"KRN",.84,"NM",280,0)
34206^^0
"BLD",443,"KRN",.84,"NM",281,0)
34207^^0
"BLD",443,"KRN",.84,"NM",282,0)
34208^^0
"BLD",443,"KRN",.84,"NM",283,0)
34209^^0
"BLD",443,"KRN",.84,"NM",284,0)
34211^^0
"BLD",443,"KRN",.84,"NM",285,0)
34212^^0
"BLD",443,"KRN",.84,"NM",286,0)
34213^^0
"BLD",443,"KRN",.84,"NM",287,0)
34214^^0
"BLD",443,"KRN",.84,"NM",288,0)
34215^^0
"BLD",443,"KRN",.84,"NM",289,0)
34216^^0
"BLD",443,"KRN",.84,"NM",290,0)
34217^^0
"BLD",443,"KRN",.84,"NM",291,0)
34220^^0
"BLD",443,"KRN",.84,"NM",292,0)
34221^^0
"BLD",443,"KRN",.84,"NM",293,0)
34222^^0
"BLD",443,"KRN",.84,"NM",294,0)
34222.1^^0
"BLD",443,"KRN",.84,"NM",295,0)
34222.3^^0
"BLD",443,"KRN",.84,"NM",296,0)
34223^^0
"BLD",443,"KRN",.84,"NM",297,0)
34230^^0
"BLD",443,"KRN",.84,"NM",298,0)
34231^^0
"BLD",443,"KRN",.84,"NM",299,0)
34232^^0
"BLD",443,"KRN",.84,"NM",300,0)
34233^^0
"BLD",443,"KRN",.84,"NM",301,0)
34234^^0
"BLD",443,"KRN",.84,"NM",302,0)
34235^^0
"BLD",443,"KRN",.84,"NM",303,0)
34236^^0
"BLD",443,"KRN",.84,"NM",304,0)
34237^^0
"BLD",443,"KRN",.84,"NM",305,0)
34238^^0
"BLD",443,"KRN",.84,"NM",306,0)
34239^^0
"BLD",443,"KRN",.84,"NM",307,0)
34240^^0
"BLD",443,"KRN",.84,"NM",308,0)
34241^^0
"BLD",443,"KRN",.84,"NM",309,0)
34242^^0
"BLD",443,"KRN",.84,"NM",310,0)
34250^^0
"BLD",443,"KRN",.84,"NM",311,0)
34251^^0
"BLD",443,"KRN",.84,"NM",312,0)
34252^^0
"BLD",443,"KRN",.84,"NM",313,0)
34253^^0
"BLD",443,"KRN",.84,"NM",314,0)
34254^^0
"BLD",443,"KRN",.84,"NM",315,0)
34255^^0
"BLD",443,"KRN",.84,"NM",316,0)
34260^^0
"BLD",443,"KRN",.84,"NM",317,0)
34261^^0
"BLD",443,"KRN",.84,"NM",318,0)
34262^^0
"BLD",443,"KRN",.84,"NM",319,0)
34263^^0
"BLD",443,"KRN",.84,"NM",320,0)
34263.1^^0
"BLD",443,"KRN",.84,"NM",321,0)
34264^^0
"BLD",443,"KRN",.84,"NM",322,0)
34265^^0
"BLD",443,"KRN",.84,"NM",323,0)
34265.1^^0
"BLD",443,"KRN",.84,"NM",324,0)
34266^^0
"BLD",443,"KRN",.84,"NM",325,0)
34267^^0
"BLD",443,"KRN",.84,"NM",326,0)
34267.1^^0
"BLD",443,"KRN",.84,"NM",327,0)
34267.2^^0
"BLD",443,"KRN",.84,"NM",328,0)
34270^^0
"BLD",443,"KRN",.84,"NM",329,0)
34271^^0
"BLD",443,"KRN",.84,"NM",330,0)
34272^^0
"BLD",443,"KRN",.84,"NM",331,0)
34273^^0
"BLD",443,"KRN",.84,"NM",332,0)
34274^^0
"BLD",443,"KRN",.84,"NM",333,0)
34301^^0
"BLD",443,"KRN",.84,"NM",334,0)
34302^^0
"BLD",443,"KRN",.84,"NM",335,0)
34302.1^^0
"BLD",443,"KRN",.84,"NM",336,0)
34302.2^^0
"BLD",443,"KRN",.84,"NM",337,0)
34303^^0
"BLD",443,"KRN",.84,"NM",338,0)
34303.1^^0
"BLD",443,"KRN",.84,"NM",339,0)
34305^^0
"BLD",443,"KRN",.84,"NM",340,0)
34306^^0
"BLD",443,"KRN",.84,"NM",341,0)
34306.1^^0
"BLD",443,"KRN",.84,"NM",342,0)
34306.2^^0
"BLD",443,"KRN",.84,"NM",343,0)
34306.3^^0
"BLD",443,"KRN",.84,"NM",344,0)
34308^^0
"BLD",443,"KRN",.84,"NM",345,0)
34309^^0
"BLD",443,"KRN",.84,"NM",346,0)
34309.1^^0
"BLD",443,"KRN",.84,"NM",347,0)
34309.2^^0
"BLD",443,"KRN",.84,"NM",348,0)
34309.3^^0
"BLD",443,"KRN",.84,"NM",349,0)
34311^^0
"BLD",443,"KRN",.84,"NM",350,0)
34312^^0
"BLD",443,"KRN",.84,"NM",351,0)
34312.1^^0
"BLD",443,"KRN",.84,"NM",352,0)
34314^^0
"BLD",443,"KRN",.84,"NM",353,0)
34315^^0
"BLD",443,"KRN",.84,"NM",354,0)
34315.1^^0
"BLD",443,"KRN",.84,"NM",355,0)
34317^^0
"BLD",443,"KRN",.84,"NM",356,0)
34317.1^^0
"BLD",443,"KRN",.84,"NM",357,0)
34318^^0
"BLD",443,"KRN",.84,"NM",358,0)
34318.1^^0
"BLD",443,"KRN",.84,"NM",359,0)
34318.2^^0
"BLD",443,"KRN",.84,"NM",360,0)
34318.3^^0
"BLD",443,"KRN",.84,"NM",361,0)
34318.4^^0
"BLD",443,"KRN",.84,"NM",362,0)
34319^^0
"BLD",443,"KRN",.84,"NM",363,0)
34320^^0
"BLD",443,"KRN",.84,"NM",364,0)
34320.1^^0
"BLD",443,"KRN",.84,"NM",365,0)
34321^^0
"BLD",443,"KRN",.84,"NM",366,0)
34323^^0
"BLD",443,"KRN",.84,"NM",367,0)
34324^^0
"BLD",443,"KRN",.84,"NM",368,0)
34324.1^^0
"BLD",443,"KRN",.84,"NM",369,0)
34324.2^^0
"BLD",443,"KRN",.84,"NM",370,0)
34324.3^^0
"BLD",443,"KRN",.84,"NM",371,0)
34325^^0
"BLD",443,"KRN",.84,"NM",372,0)
34325.1^^0
"BLD",443,"KRN",.84,"NM",373,0)
34325.9^^0
"BLD",443,"KRN",.84,"NM",374,0)
34326^^0
"BLD",443,"KRN",.84,"NM",375,0)
34326.1^^0
"BLD",443,"KRN",.84,"NM",376,0)
34328^^0
"BLD",443,"KRN",.84,"NM",377,0)
34329^^0
"BLD",443,"KRN",.84,"NM",378,0)
34329.1^^0
"BLD",443,"KRN",.84,"NM",379,0)
34330^^0
"BLD",443,"KRN",.84,"NM",380,0)
34330.1^^0
"BLD",443,"KRN",.84,"NM",381,0)
34331^^0
"BLD",443,"KRN",.84,"NM",382,0)
34331.1^^0
"BLD",443,"KRN",.84,"NM",383,0)
34333^^0
"BLD",443,"KRN",.84,"NM",384,0)
34334^^0
"BLD",443,"KRN",.84,"NM",385,0)
34334.1^^0
"BLD",443,"KRN",.84,"NM",386,0)
34335^^0
"BLD",443,"KRN",.84,"NM",387,0)
34335.1^^0
"BLD",443,"KRN",.84,"NM",388,0)
34336^^0
"BLD",443,"KRN",.84,"NM",389,0)
34336.1^^0
"BLD",443,"KRN",.84,"NM",390,0)
34337^^0
"BLD",443,"KRN",.84,"NM",391,0)
34337.1^^0
"BLD",443,"KRN",.84,"NM",392,0)
34337.2^^0
"BLD",443,"KRN",.84,"NM",393,0)
34337.3^^0
"BLD",443,"KRN",.84,"NM",394,0)
34338^^0
"BLD",443,"KRN",.84,"NM",395,0)
34338.1^^0
"BLD",443,"KRN",.84,"NM",396,0)
34338.2^^0
"BLD",443,"KRN",.84,"NM",397,0)
34338.3^^0
"BLD",443,"KRN",.84,"NM",398,0)
34339^^0
"BLD",443,"KRN",.84,"NM",399,0)
34350^^0
"BLD",443,"KRN",.84,"NM",400,0)
34351^^0
"BLD",443,"KRN",.84,"NM",401,0)
34352^^0
"BLD",443,"KRN",.84,"NM",402,0)
34354^^0
"BLD",443,"KRN",.84,"NM",403,0)
34401^^0
"BLD",443,"KRN",.84,"NM",404,0)
34402^^0
"BLD",443,"KRN",.84,"NM",405,0)
34403^^0
"BLD",443,"KRN",.84,"NM",406,0)
34403.5^^0
"BLD",443,"KRN",.84,"NM",407,0)
34404^^0
"BLD",443,"KRN",.84,"NM",408,0)
34405^^0
"BLD",443,"KRN",.84,"NM",409,0)
34410^^0
"BLD",443,"KRN",.84,"NM",410,0)
34411^^0
"BLD",443,"KRN",.84,"NM",411,0)
34412^^0
"BLD",443,"KRN",.84,"NM",412,0)
34413^^0
"BLD",443,"KRN",.84,"NM",413,0)
34413.5^^0
"BLD",443,"KRN",.84,"NM",414,0)
34413.6^^0
"BLD",443,"KRN",.84,"NM",415,0)
34414^^0
"BLD",443,"KRN",.84,"NM",416,0)
34415^^0
"BLD",443,"KRN",.84,"NM",417,0)
34416^^0
"BLD",443,"KRN",.84,"NM",418,0)
34417^^0
"BLD",443,"KRN",.84,"NM",419,0)
34418^^0
"BLD",443,"KRN",.84,"NM",420,0)
34418.5^^0
"BLD",443,"KRN",.84,"NM",421,0)
34419^^0
"BLD",443,"KRN",.84,"NM",422,0)
34420^^0
"BLD",443,"KRN",.84,"NM",423,0)
34420.1^^0
"BLD",443,"KRN",.84,"NM",424,0)
34420.2^^0
"BLD",443,"KRN",.84,"NM",425,0)
34421^^0
"BLD",443,"KRN",.84,"NM",426,0)
34421.1^^0
"BLD",443,"KRN",.84,"NM",427,0)
34421.2^^0
"BLD",443,"KRN",.84,"NM",428,0)
34422^^0
"BLD",443,"KRN",.84,"NM",429,0)
34422.1^^0
"BLD",443,"KRN",.84,"NM",430,0)
34423^^0
"BLD",443,"KRN",.84,"NM",431,0)
34423.1^^0
"BLD",443,"KRN",.84,"NM",432,0)
34424^^0
"BLD",443,"KRN",.84,"NM",433,0)
34424.1^^0
"BLD",443,"KRN",.84,"NM",435,0)
34426^^0
"BLD",443,"KRN",.84,"NM",436,0)
34426.1^^0
"BLD",443,"KRN",.84,"NM",437,0)
34427^^0
"BLD",443,"KRN",.84,"NM",438,0)
34427.1^^0
"BLD",443,"KRN",.84,"NM",439,0)
34428^^0
"BLD",443,"KRN",.84,"NM",440,0)
34428.1^^0
"BLD",443,"KRN",.84,"NM",441,0)
34429^^0
"BLD",443,"KRN",.84,"NM",442,0)
34429.1^^0
"BLD",443,"KRN",.84,"NM",443,0)
34430^^0
"BLD",443,"KRN",.84,"NM",444,0)
34430.1^^0
"BLD",443,"KRN",.84,"NM",445,0)
34431^^0
"BLD",443,"KRN",.84,"NM",446,0)
34431.1^^0
"BLD",443,"KRN",.84,"NM",447,0)
34435^^0
"BLD",443,"KRN",.84,"NM",448,0)
34435.5^^0
"BLD",443,"KRN",.84,"NM",449,0)
34436^^0
"BLD",443,"KRN",.84,"NM",450,0)
34437^^0
"BLD",443,"KRN",.84,"NM",451,0)
34437.1^^0
"BLD",443,"KRN",.84,"NM",452,0)
34438^^0
"BLD",443,"KRN",.84,"NM",453,0)
34438.1^^0
"BLD",443,"KRN",.84,"NM",454,0)
34439^^0
"BLD",443,"KRN",.84,"NM",455,0)
34440^^0
"BLD",443,"KRN",.84,"NM",456,0)
34440.1^^0
"BLD",443,"KRN",.84,"NM",457,0)
34440.2^^0
"BLD",443,"KRN",.84,"NM",458,0)
34441^^0
"BLD",443,"KRN",.84,"NM",459,0)
34441.1^^0
"BLD",443,"KRN",.84,"NM",460,0)
34441.2^^0
"BLD",443,"KRN",.84,"NM",461,0)
34441.3^^0
"BLD",443,"KRN",.84,"NM",462,0)
34442^^0
"BLD",443,"KRN",.84,"NM",465,0)
34444^^0
"BLD",443,"KRN",.84,"NM",466,0)
34444.1^^0
"BLD",443,"KRN",.84,"NM",467,0)
34445^^0
"BLD",443,"KRN",.84,"NM",468,0)
34446.1^^0
"BLD",443,"KRN",.84,"NM",469,0)
34446.2^^0
"BLD",443,"KRN",.84,"NM",470,0)
34446.3^^0
"BLD",443,"KRN",.84,"NM",471,0)
34446.4^^0
"BLD",443,"KRN",.84,"NM",472,0)
34447^^0
"BLD",443,"KRN",.84,"NM",473,0)
34447.1^^0
"BLD",443,"KRN",.84,"NM",474,0)
34448^^0
"BLD",443,"KRN",.84,"NM",475,0)
34448.1^^0
"BLD",443,"KRN",.84,"NM",476,0)
34448.2^^0
"BLD",443,"KRN",.84,"NM",477,0)
34448.3^^0
"BLD",443,"KRN",.84,"NM",478,0)
34449^^0
"BLD",443,"KRN",.84,"NM",479,0)
34449.1^^0
"BLD",443,"KRN",.84,"NM",480,0)
34450^^0
"BLD",443,"KRN",.84,"NM",481,0)
34450.1^^0
"BLD",443,"KRN",.84,"NM",482,0)
34500^^0
"BLD",443,"KRN",.84,"NM",483,0)
34501^^0
"BLD",443,"KRN",.84,"NM",484,0)
34501.1^^0
"BLD",443,"KRN",.84,"NM",485,0)
34502^^0
"BLD",443,"KRN",.84,"NM",486,0)
34503^^0
"BLD",443,"KRN",.84,"NM",487,0)
34504^^0
"BLD",443,"KRN",.84,"NM",488,0)
34505^^0
"BLD",443,"KRN",.84,"NM",489,0)
34506^^0
"BLD",443,"KRN",.84,"NM",490,0)
34507^^0
"BLD",443,"KRN",.84,"NM",491,0)
34508^^0
"BLD",443,"KRN",.84,"NM",492,0)
34509^^0
"BLD",443,"KRN",.84,"NM",493,0)
34510^^0
"BLD",443,"KRN",.84,"NM",494,0)
34511^^0
"BLD",443,"KRN",.84,"NM",495,0)
34512^^0
"BLD",443,"KRN",.84,"NM",496,0)
34513^^0
"BLD",443,"KRN",.84,"NM",497,0)
34514^^0
"BLD",443,"KRN",.84,"NM",498,0)
34515^^0
"BLD",443,"KRN",.84,"NM",499,0)
34516^^0
"BLD",443,"KRN",.84,"NM",500,0)
34518^^0
"BLD",443,"KRN",.84,"NM",501,0)
34519^^0
"BLD",443,"KRN",.84,"NM",502,0)
34520^^0
"BLD",443,"KRN",.84,"NM",503,0)
34521^^0
"BLD",443,"KRN",.84,"NM",504,0)
34530^^0
"BLD",443,"KRN",.84,"NM",505,0)
34531^^0
"BLD",443,"KRN",.84,"NM",506,0)
34532^^0
"BLD",443,"KRN",.84,"NM",507,0)
34533^^0
"BLD",443,"KRN",.84,"NM",508,0)
34534^^0
"BLD",443,"KRN",.84,"NM",509,0)
34534.1^^0
"BLD",443,"KRN",.84,"NM",510,0)
34535^^0
"BLD",443,"KRN",.84,"NM",511,0)
34536^^0
"BLD",443,"KRN",.84,"NM",512,0)
34537^^0
"BLD",443,"KRN",.84,"NM",513,0)
34538^^0
"BLD",443,"KRN",.84,"NM",514,0)
34539^^0
"BLD",443,"KRN",.84,"NM",515,0)
34540^^0
"BLD",443,"KRN",.84,"NM",516,0)
34541^^0
"BLD",443,"KRN",.84,"NM",517,0)
34542^^0
"BLD",443,"KRN",.84,"NM",518,0)
34543^^0
"BLD",443,"KRN",.84,"NM",519,0)
34544^^0
"BLD",443,"KRN",.84,"NM",520,0)
34545^^0
"BLD",443,"KRN",.84,"NM",521,0)
34546^^0
"BLD",443,"KRN",.84,"NM",522,0)
34550^^0
"BLD",443,"KRN",.84,"NM",523,0)
34551^^0
"BLD",443,"KRN",.84,"NM",524,0)
34552^^0
"BLD",443,"KRN",.84,"NM",525,0)
34554^^0
"BLD",443,"KRN",.84,"NM",526,0)
34555^^0
"BLD",443,"KRN",.84,"NM",527,0)
34556^^0
"BLD",443,"KRN",.84,"NM",528,0)
34557^^0
"BLD",443,"KRN",.84,"NM",529,0)
34557.1^^0
"BLD",443,"KRN",.84,"NM",530,0)
34559^^0
"BLD",443,"KRN",.84,"NM",531,0)
34560^^0
"BLD",443,"KRN",.84,"NM",532,0)
34561^^0
"BLD",443,"KRN",.84,"NM",533,0)
34562^^0
"BLD",443,"KRN",.84,"NM",534,0)
34562.1^^0
"BLD",443,"KRN",.84,"NM",535,0)
34564^^0
"BLD",443,"KRN",.84,"NM",536,0)
34565^^0
"BLD",443,"KRN",.84,"NM",537,0)
34566^^0
"BLD",443,"KRN",.84,"NM",538,0)
34567^^0
"BLD",443,"KRN",.84,"NM",539,0)
34568^^0
"BLD",443,"KRN",.84,"NM",540,0)
34570^^0
"BLD",443,"KRN",.84,"NM",541,0)
34571^^0
"BLD",443,"KRN",.84,"NM",542,0)
34572^^0
"BLD",443,"KRN",.84,"NM",543,0)
34573^^0
"BLD",443,"KRN",.84,"NM",544,0)
34574^^0
"BLD",443,"KRN",.84,"NM",545,0)
34575^^0
"BLD",443,"KRN",.84,"NM",546,0)
34576^^0
"BLD",443,"KRN",.84,"NM",547,0)
34577^^0
"BLD",443,"KRN",.84,"NM",548,0)
34578^^0
"BLD",443,"KRN",.84,"NM",549,0)
34580^^0
"BLD",443,"KRN",.84,"NM",550,0)
34581^^0
"BLD",443,"KRN",.84,"NM",551,0)
34582^^0
"BLD",443,"KRN",.84,"NM",552,0)
34583^^0
"BLD",443,"KRN",.84,"NM",553,0)
34584^^0
"BLD",443,"KRN",.84,"NM",554,0)
34585^^0
"BLD",443,"KRN",.84,"NM",555,0)
34586^^0
"BLD",443,"KRN",.84,"NM",556,0)
34587^^0
"BLD",443,"KRN",.84,"NM",557,0)
34588^^0
"BLD",443,"KRN",.84,"NM",558,0)
34590^^0
"BLD",443,"KRN",.84,"NM",559,0)
34591^^0
"BLD",443,"KRN",.84,"NM",560,0)
34592^^0
"BLD",443,"KRN",.84,"NM",561,0)
34593^^0
"BLD",443,"KRN",.84,"NM",562,0)
34593.1^^0
"BLD",443,"KRN",.84,"NM",563,0)
34593.2^^0
"BLD",443,"KRN",.84,"NM",564,0)
34594^^0
"BLD",443,"KRN",.84,"NM",565,0)
34594.1^^0
"BLD",443,"KRN",.84,"NM",566,0)
34595^^0
"BLD",443,"KRN",.84,"NM",567,0)
34595.1^^0
"BLD",443,"KRN",.84,"NM",568,0)
34596^^0
"BLD",443,"KRN",.84,"NM",569,0)
34597^^0
"BLD",443,"KRN",.84,"NM",570,0)
34598^^0
"BLD",443,"KRN",.84,"NM",571,0)
34600^^0
"BLD",443,"KRN",.84,"NM",572,0)
34601^^0
"BLD",443,"KRN",.84,"NM",573,0)
34602^^0
"BLD",443,"KRN",.84,"NM",574,0)
34603^^0
"BLD",443,"KRN",.84,"NM",575,0)
34604^^0
"BLD",443,"KRN",.84,"NM",576,0)
34605^^0
"BLD",443,"KRN",.84,"NM",577,0)
34606^^0
"BLD",443,"KRN",.84,"NM",578,0)
34607^^0
"BLD",443,"KRN",.84,"NM",579,0)
34608^^0
"BLD",443,"KRN",.84,"NM",580,0)
34610^^0
"BLD",443,"KRN",.84,"NM",581,0)
34611^^0
"BLD",443,"KRN",.84,"NM",582,0)
34612^^0
"BLD",443,"KRN",.84,"NM",583,0)
34615^^0
"BLD",443,"KRN",.84,"NM",584,0)
34616^^0
"BLD",443,"KRN",.84,"NM",585,0)
34617^^0
"BLD",443,"KRN",.84,"NM",586,0)
34618^^0
"BLD",443,"KRN",.84,"NM",587,0)
34619^^0
"BLD",443,"KRN",.84,"NM",588,0)
34620^^0
"BLD",443,"KRN",.84,"NM",589,0)
34620.1^^0
"BLD",443,"KRN",.84,"NM",590,0)
34621^^0
"BLD",443,"KRN",.84,"NM",591,0)
34622^^0
"BLD",443,"KRN",.84,"NM",592,0)
34623^^0
"BLD",443,"KRN",.84,"NM",593,0)
34624^^0
"BLD",443,"KRN",.84,"NM",594,0)
34630^^0
"BLD",443,"KRN",.84,"NM",595,0)
34631^^0
"BLD",443,"KRN",.84,"NM",596,0)
34632^^0
"BLD",443,"KRN",.84,"NM",597,0)
34633^^0
"BLD",443,"KRN",.84,"NM",598,0)
34634^^0
"BLD",443,"KRN",.84,"NM",599,0)
34635^^0
"BLD",443,"KRN",.84,"NM",600,0)
34635.1^^0
"BLD",443,"KRN",.84,"NM",601,0)
34636^^0
"BLD",443,"KRN",.84,"NM",602,0)
34636.1^^0
"BLD",443,"KRN",.84,"NM",603,0)
34637^^0
"BLD",443,"KRN",.84,"NM",604,0)
34638^^0
"BLD",443,"KRN",.84,"NM",605,0)
34639^^0
"BLD",443,"KRN",.84,"NM",606,0)
34650^^0
"BLD",443,"KRN",.84,"NM",607,0)
34651^^0
"BLD",443,"KRN",.84,"NM",608,0)
34652^^0
"BLD",443,"KRN",.84,"NM",609,0)
34653^^0
"BLD",443,"KRN",.84,"NM",610,0)
34654^^0
"BLD",443,"KRN",.84,"NM",611,0)
34655^^0
"BLD",443,"KRN",.84,"NM",612,0)
34656^^0
"BLD",443,"KRN",.84,"NM",613,0)
34656.1^^0
"BLD",443,"KRN",.84,"NM",614,0)
34657^^0
"BLD",443,"KRN",.84,"NM",615,0)
34660^^0
"BLD",443,"KRN",.84,"NM",616,0)
34661^^0
"BLD",443,"KRN",.84,"NM",617,0)
34662^^0
"BLD",443,"KRN",.84,"NM",618,0)
34665^^0
"BLD",443,"KRN",.84,"NM",619,0)
34666^^0
"BLD",443,"KRN",.84,"NM",620,0)
34667^^0
"BLD",443,"KRN",.84,"NM",621,0)
36080^^0
"BLD",443,"KRN",.84,"NM",622,0)
36081^^0
"BLD",443,"KRN",.84,"NM",623,0)
36082^^0
"BLD",443,"KRN",.84,"NM",624,0)
36083^^0
"BLD",443,"KRN",.84,"NM",625,0)
36084^^0
"BLD",443,"KRN",.84,"NM",626,0)
36085^^0
"BLD",443,"KRN",.84,"NM",627,0)
36086^^0
"BLD",443,"KRN",.84,"NM",628,0)
36087^^0
"BLD",443,"KRN",.84,"NM",629,0)
36088^^0
"BLD",443,"KRN",.84,"NM",630,0)
36089^^0
"BLD",443,"KRN",.84,"NM",631,0)
36090^^0
"BLD",443,"KRN",.84,"NM",632,0)
36091^^0
"BLD",443,"KRN",.84,"NM",633,0)
36092^^0
"BLD",443,"KRN",.84,"NM",634,0)
36093^^0
"BLD",443,"KRN",.84,"NM",635,0)
36094^^0
"BLD",443,"KRN",.84,"NM",636,0)
36095^^0
"BLD",443,"KRN",.84,"NM",637,0)
36096^^0
"BLD",443,"KRN",.84,"NM",638,0)
36097^^0
"BLD",443,"KRN",.84,"NM",639,0)
36098^^0
"BLD",443,"KRN",.84,"NM",640,0)
36099^^0
"BLD",443,"KRN",.84,"NM",641,0)
36101^^0
"BLD",443,"KRN",.84,"NM",642,0)
36101.1^^0
"BLD",443,"KRN",.84,"NM",643,0)
36102^^0
"BLD",443,"KRN",.84,"NM",644,0)
36102.1^^0
"BLD",443,"KRN",.84,"NM",645,0)
36103^^0
"BLD",443,"KRN",.84,"NM",646,0)
36103.1^^0
"BLD",443,"KRN",.84,"NM",647,0)
36104^^0
"BLD",443,"KRN",.84,"NM",648,0)
36104.1^^0
"BLD",443,"KRN",.84,"NM",649,0)
36111^^0
"BLD",443,"KRN",.84,"NM",650,0)
36111.1^^0
"BLD",443,"KRN",.84,"NM",651,0)
36112^^0
"BLD",443,"KRN",.84,"NM",652,0)
36112.1^^0
"BLD",443,"KRN",.84,"NM",653,0)
36113^^0
"BLD",443,"KRN",.84,"NM",654,0)
36113.1^^0
"BLD",443,"KRN",.84,"NM",655,0)
36121^^0
"BLD",443,"KRN",.84,"NM",656,0)
36121.1^^0
"BLD",443,"KRN",.84,"NM",657,0)
36122^^0
"BLD",443,"KRN",.84,"NM",658,0)
36122.1^^0
"BLD",443,"KRN",.84,"NM",659,0)
36123^^0
"BLD",443,"KRN",.84,"NM",660,0)
36123.1^^0
"BLD",443,"KRN",.84,"NM",661,0)
36124^^0
"BLD",443,"KRN",.84,"NM",662,0)
36124.1^^0
"BLD",443,"KRN",.84,"NM",663,0)
36125^^0
"BLD",443,"KRN",.84,"NM",664,0)
36125.1^^0
"BLD",443,"KRN",.84,"NM",665,0)
36126^^0
"BLD",443,"KRN",.84,"NM",666,0)
36126.1^^0
"BLD",443,"KRN",.84,"NM",667,0)
36127^^0
"BLD",443,"KRN",.84,"NM",668,0)
36127.1^^0
"BLD",443,"KRN",.84,"NM",669,0)
36131^^0
"BLD",443,"KRN",.84,"NM",670,0)
36131.1^^0
"BLD",443,"KRN",.84,"NM",671,0)
36132^^0
"BLD",443,"KRN",.84,"NM",672,0)
36132.1^^0
"BLD",443,"KRN",.84,"NM",673,0)
36133^^0
"BLD",443,"KRN",.84,"NM",674,0)
36133.1^^0
"BLD",443,"KRN",.84,"NM",675,0)
36134^^0
"BLD",443,"KRN",.84,"NM",676,0)
36134.1^^0
"BLD",443,"KRN",.84,"NM",677,0)
36141^^0
"BLD",443,"KRN",.84,"NM",678,0)
36151^^0
"BLD",443,"KRN",.84,"NM",679,0)
36151.1^^0
"BLD",443,"KRN",.84,"NM",680,0)
36152^^0
"BLD",443,"KRN",.84,"NM",681,0)
36152.1^^0
"BLD",443,"KRN",.84,"NM",682,0)
36153^^0
"BLD",443,"KRN",.84,"NM",683,0)
36153.1^^0
"BLD",443,"KRN",.84,"NM",684,0)
36160^^0
"BLD",443,"KRN",.84,"NM",685,0)
36160.1^^0
"BLD",443,"KRN",.84,"NM",686,0)
36161^^0
"BLD",443,"KRN",.84,"NM",687,0)
36161.1^^0
"BLD",443,"KRN",.84,"NM",688,0)
36162^^0
"BLD",443,"KRN",.84,"NM",689,0)
36162.1^^0
"BLD",443,"KRN",.84,"NM",690,0)
36163^^0
"BLD",443,"KRN",.84,"NM",691,0)
36163.1^^0
"BLD",443,"KRN",.84,"NM",692,0)
36164^^0
"BLD",443,"KRN",.84,"NM",693,0)
36164.1^^0
"BLD",443,"KRN",.84,"NM",694,0)
36200^^0
"BLD",443,"KRN",.84,"NM",695,0)
36201^^0
"BLD",443,"KRN",.84,"NM",696,0)
36202^^0
"BLD",443,"KRN",.84,"NM",697,0)
36203^^0
"BLD",443,"KRN",.84,"NM",698,0)
36204^^0
"BLD",443,"KRN",.84,"NM",699,0)
36205^^0
"BLD",443,"KRN",.84,"NM",700,0)
36206^^0
"BLD",443,"KRN",.84,"NM",701,0)
36207^^0
"BLD",443,"KRN",.84,"NM",702,0)
36210^^0
"BLD",443,"KRN",.84,"NM",703,0)
36211^^0
"BLD",443,"KRN",.84,"NM",704,0)
36212^^0
"BLD",443,"KRN",.84,"NM",705,0)
36213^^0
"BLD",443,"KRN",.84,"NM",706,0)
36214^^0
"BLD",443,"KRN",.84,"NM",707,0)
36215^^0
"BLD",443,"KRN",.84,"NM",708,0)
36216^^0
"BLD",443,"KRN",.84,"NM",709,0)
36217^^0
"BLD",443,"KRN",.84,"NM",710,0)
36218^^0
"BLD",443,"KRN",.84,"NM",711,0)
36219^^0
"BLD",443,"KRN",.84,"NM",712,0)
36220^^0
"BLD",443,"KRN",.84,"NM",713,0)
36221^^0
"BLD",443,"KRN",.84,"NM",714,0)
36222^^0
"BLD",443,"KRN",.84,"NM",715,0)
36223^^0
"BLD",443,"KRN",.84,"NM",716,0)
36224^^0
"BLD",443,"KRN",.84,"NM",717,0)
36224.1^^0
"BLD",443,"KRN",.84,"NM",718,0)
36224.2^^0
"BLD",443,"KRN",.84,"NM",719,0)
36225^^0
"BLD",443,"KRN",.84,"NM",720,0)
36226^^0
"BLD",443,"KRN",.84,"NM",721,0)
36227^^0
"BLD",443,"KRN",.84,"NM",722,0)
36228^^0
"BLD",443,"KRN",.84,"NM",723,0)
36229^^0
"BLD",443,"KRN",.84,"NM",724,0)
36229.1^^0
"BLD",443,"KRN",.84,"NM",725,0)
36229.2^^0
"BLD",443,"KRN",.84,"NM",726,0)
36230^^0
"BLD",443,"KRN",.84,"NM",727,0)
36231^^0
"BLD",443,"KRN",.84,"NM",728,0)
36232^^0
"BLD",443,"KRN",.84,"NM",729,0)
36240^^0
"BLD",443,"KRN",.84,"NM",730,0)
36241^^0
"BLD",443,"KRN",.84,"NM",731,0)
36242^^0
"BLD",443,"KRN",.84,"NM",732,0)
36300^^0
"BLD",443,"KRN",.84,"NM",733,0)
36301^^0
"BLD",443,"KRN",.84,"NM",734,0)
36302^^0
"BLD",443,"KRN",.84,"NM",735,0)
36303^^0
"BLD",443,"KRN",.84,"NM",736,0)
36304^^0
"BLD",443,"KRN",.84,"NM",737,0)
36305^^0
"BLD",443,"KRN",.84,"NM",738,0)
36306^^0
"BLD",443,"KRN",.84,"NM",739,0)
36309^^0
"BLD",443,"KRN",.84,"NM",740,0)
36309.5^^0
"BLD",443,"KRN",.84,"NM",741,0)
36310^^0
"BLD",443,"KRN",.84,"NM",742,0)
36311^^0
"BLD",443,"KRN",.84,"NM",743,0)
36312^^0
"BLD",443,"KRN",.84,"NM",744,0)
36313^^0
"BLD",443,"KRN",.84,"NM",745,0)
36314^^0
"BLD",443,"KRN",.84,"NM",746,0)
36315^^0
"BLD",443,"KRN",.84,"NM",747,0)
36316^^0
"BLD",443,"KRN",.84,"NM",748,0)
36317^^0
"BLD",443,"KRN",.84,"NM",749,0)
36318^^0
"BLD",443,"KRN",.84,"NM",750,0)
36319^^0
"BLD",443,"KRN",.84,"NM",751,0)
36321^^0
"BLD",443,"KRN",.84,"NM",752,0)
36322^^0
"BLD",443,"KRN",.84,"NM",753,0)
36323^^0
"BLD",443,"KRN",.84,"NM",754,0)
36324^^0
"BLD",443,"KRN",.84,"NM",755,0)
36325^^0
"BLD",443,"KRN",.84,"NM",756,0)
36326^^0
"BLD",443,"KRN",.84,"NM",757,0)
36327^^0
"BLD",443,"KRN",.84,"NM",758,0)
36330^^0
"BLD",443,"KRN",.84,"NM",759,0)
36332^^0
"BLD",443,"KRN",.84,"NM",760,0)
36334^^0
"BLD",443,"KRN",.84,"NM",761,0)
36335^^0
"BLD",443,"KRN",.84,"NM",762,0)
36336^^0
"BLD",443,"KRN",.84,"NM",763,0)
36337^^0
"BLD",443,"KRN",.84,"NM",764,0)
36338^^0
"BLD",443,"KRN",.84,"NM",765,0)
36339^^0
"BLD",443,"KRN",.84,"NM",766,0)
36340^^0
"BLD",443,"KRN",.84,"NM",767,0)
36341^^0
"BLD",443,"KRN",.84,"NM",768,0)
36342^^0
"BLD",443,"KRN",.84,"NM",769,0)
36343^^0
"BLD",443,"KRN",.84,"NM",770,0)
36344^^0
"BLD",443,"KRN",.84,"NM",771,0)
36345^^0
"BLD",443,"KRN",.84,"NM",772,0)
36346^^0
"BLD",443,"KRN",.84,"NM",773,0)
36347^^0
"BLD",443,"KRN",.84,"NM",774,0)
36351^^0
"BLD",443,"KRN",.84,"NM",775,0)
36352^^0
"BLD",443,"KRN",.84,"NM",776,0)
36353^^0
"BLD",443,"KRN",.84,"NM",777,0)
36357^^0
"BLD",443,"KRN",.84,"NM",778,0)
36358^^0
"BLD",443,"KRN",.84,"NM",779,0)
36359^^0
"BLD",443,"KRN",.84,"NM",780,0)
36360^^0
"BLD",443,"KRN",.84,"NM",781,0)
36361^^0
"BLD",443,"KRN",.84,"NM",782,0)
36362^^0
"BLD",443,"KRN",.84,"NM",783,0)
36364^^0
"BLD",443,"KRN",.84,"NM",784,0)
36366^^0
"BLD",443,"KRN",.84,"NM",785,0)
36367^^0
"BLD",443,"KRN",.84,"NM",786,0)
36368^^0
"BLD",443,"KRN",.84,"NM",787,0)
36369^^0
"BLD",443,"KRN",.84,"NM",788,0)
36400^^0
"BLD",443,"KRN",.84,"NM",789,0)
36401^^0
"BLD",443,"KRN",.84,"NM",790,0)
36402^^0
"BLD",443,"KRN",.84,"NM",791,0)
36402.1^^0
"BLD",443,"KRN",.84,"NM",792,0)
36403^^0
"BLD",443,"KRN",.84,"NM",793,0)
36404^^0
"BLD",443,"KRN",.84,"NM",794,0)
36405^^0
"BLD",443,"KRN",.84,"NM",795,0)
36406^^0
"BLD",443,"KRN",.84,"NM",796,0)
36407^^0
"BLD",443,"KRN",.84,"NM",797,0)
36408^^0
"BLD",443,"KRN",.84,"NM",798,0)
36409^^0
"BLD",443,"KRN",.84,"NM",799,0)
36410^^0
"BLD",443,"KRN",.84,"NM",800,0)
36411^^0
"BLD",443,"KRN",.84,"NM",801,0)
36412^^0
"BLD",443,"KRN",.84,"NM",802,0)
36412.1^^0
"BLD",443,"KRN",.84,"NM",803,0)
36413^^0
"BLD",443,"KRN",.84,"NM",804,0)
36414^^0
"BLD",443,"KRN",.84,"NM",805,0)
36415^^0
"BLD",443,"KRN",.84,"NM",806,0)
36416^^0
"BLD",443,"KRN",.84,"NM",807,0)
36417^^0
"BLD",443,"KRN",.84,"NM",808,0)
36418^^0
"BLD",443,"KRN",.84,"NM",809,0)
36419^^0
"BLD",443,"KRN",.84,"NM",810,0)
36420^^0
"BLD",443,"KRN",.84,"NM",811,0)
36421^^0
"BLD",443,"KRN",.84,"NM",812,0)
36422^^0
"BLD",443,"KRN",.84,"NM",813,0)
36423^^0
"BLD",443,"KRN",.84,"NM",814,0)
36425^^0
"BLD",443,"KRN",.84,"NM",815,0)
36426^^0
"BLD",443,"KRN",.84,"NM",816,0)
36427^^0
"BLD",443,"KRN",.84,"NM",817,0)
36428^^0
"BLD",443,"KRN",.84,"NM",818,0)
36429^^0
"BLD",443,"KRN",.84,"NM",819,0)
36430^^0
"BLD",443,"KRN",.84,"NM",820,0)
36431^^0
"BLD",443,"KRN",.84,"NM",821,0)
36432^^0
"BLD",443,"KRN",.84,"NM",822,0)
36433^^0
"BLD",443,"KRN",.84,"NM",823,0)
36434^^0
"BLD",443,"KRN",.84,"NM",824,0)
36435^^0
"BLD",443,"KRN",.84,"NM",825,0)
36436^^0
"BLD",443,"KRN",.84,"NM",826,0)
36437^^0
"BLD",443,"KRN",.84,"NM",827,0)
36438^^0
"BLD",443,"KRN",.84,"NM",828,0)
36439.1^^0
"BLD",443,"KRN",.84,"NM",829,0)
36439.2^^0
"BLD",443,"KRN",.84,"NM",830,0)
36439.3^^0
"BLD",443,"KRN",.84,"NM",831,0)
36440^^0
"BLD",443,"KRN",.84,"NM",832,0)
36441^^0
"BLD",443,"KRN",.84,"NM",833,0)
36443^^0
"BLD",443,"KRN",.84,"NM",834,0)
36501^^0
"BLD",443,"KRN",.84,"NM",835,0)
36501.1^^0
"BLD",443,"KRN",.84,"NM",836,0)
36502^^0
"BLD",443,"KRN",.84,"NM",837,0)
36502.1^^0
"BLD",443,"KRN",.84,"NM",838,0)
36503^^0
"BLD",443,"KRN",.84,"NM",839,0)
36503.1^^0
"BLD",443,"KRN",.84,"NM",840,0)
36504^^0
"BLD",443,"KRN",.84,"NM",841,0)
36504.1^^0
"BLD",443,"KRN",.84,"NM",842,0)
36505^^0
"BLD",443,"KRN",.84,"NM",843,0)
36505.1^^0
"BLD",443,"KRN",.84,"NM",844,0)
36506^^0
"BLD",443,"KRN",.84,"NM",845,0)
36506.1^^0
"BLD",443,"KRN",.84,"NM",846,0)
36507^^0
"BLD",443,"KRN",.84,"NM",847,0)
36507.1^^0
"BLD",443,"KRN",.84,"NM",848,0)
36508^^0
"BLD",443,"KRN",.84,"NM",849,0)
36508.1^^0
"BLD",443,"KRN",.84,"NM",850,0)
36509^^0
"BLD",443,"KRN",.84,"NM",851,0)
36509.1^^0
"BLD",443,"KRN",.84,"NM",852,0)
36510^^0
"BLD",443,"KRN",.84,"NM",853,0)
36510.1^^0
"BLD",443,"KRN",.84,"NM",854,0)
36511^^0
"BLD",443,"KRN",.84,"NM",855,0)
36511.1^^0
"BLD",443,"KRN",.84,"NM",857,0)
36512.1^^0
"BLD",443,"KRN",.84,"NM",858,0)
36513^^0
"BLD",443,"KRN",.84,"NM",859,0)
36513.1^^0
"BLD",443,"KRN",.84,"NM",860,0)
36516^^0
"BLD",443,"KRN",.84,"NM",861,0)
36516.1^^0
"BLD",443,"KRN",.84,"NM",862,0)
36517^^0
"BLD",443,"KRN",.84,"NM",863,0)
36517.1^^0
"BLD",443,"KRN",.84,"NM",864,0)
36518^^0
"BLD",443,"KRN",.84,"NM",865,0)
36518.1^^0
"BLD",443,"KRN",.84,"NM",866,0)
36521^^0
"BLD",443,"KRN",.84,"NM",867,0)
36521.1^^0
"BLD",443,"KRN",.84,"NM",868,0)
36522^^0
"BLD",443,"KRN",.84,"NM",869,0)
36522.1^^0
"BLD",443,"KRN",.84,"NM",870,0)
36523^^0
"BLD",443,"KRN",.84,"NM",871,0)
36523.1^^0
"BLD",443,"KRN",.84,"NM",872,0)
36531^^0
"BLD",443,"KRN",.84,"NM",873,0)
36531.1^^0
"BLD",443,"KRN",.84,"NM",874,0)
36532^^0
"BLD",443,"KRN",.84,"NM",875,0)
36532.1^^0
"BLD",443,"KRN",.84,"NM",876,0)
36533^^0
"BLD",443,"KRN",.84,"NM",877,0)
36533.1^^0
"BLD",443,"KRN",.84,"NM",878,0)
36600^^0
"BLD",443,"KRN",.84,"NM",879,0)
36601^^0
"BLD",443,"KRN",.84,"NM",880,0)
36602^^0
"BLD",443,"KRN",.84,"NM",881,0)
36603^^0
"BLD",443,"KRN",.84,"NM",882,0)
36604^^0
"BLD",443,"KRN",.84,"NM",883,0)
36610^^0
"BLD",443,"KRN",.84,"NM",884,0)
36611^^0
"BLD",443,"KRN",.84,"NM",885,0)
36612^^0
"BLD",443,"KRN",.84,"NM",886,0)
36613^^0
"BLD",443,"KRN",.84,"NM",888,0)
37000^^0
"BLD",443,"KRN",.84,"NM",889,0)
37001^^0
"BLD",443,"KRN",.84,"NM",890,0)
37002^^0
"BLD",443,"KRN",.84,"NM",891,0)
37003^^0
"BLD",443,"KRN",.84,"NM",892,0)
37004^^0
"BLD",443,"KRN",.84,"NM",893,0)
37005^^0
"BLD",443,"KRN",.84,"NM",894,0)
37006^^0
"BLD",443,"KRN",.84,"NM",895,0)
37007^^0
"BLD",443,"KRN",.84,"NM",896,0)
37008^^0
"BLD",443,"KRN",.84,"NM",897,0)
37100^^0
"BLD",443,"KRN",.84,"NM",898,0)
37101^^0
"BLD",443,"KRN",.84,"NM",899,0)
37102^^0
"BLD",443,"KRN",.84,"NM",900,0)
37201^^0
"BLD",443,"KRN",.84,"NM",901,0)
37201.1^^0
"BLD",443,"KRN",.84,"NM",902,0)
37201.2^^0
"BLD",443,"KRN",.84,"NM",903,0)
37201.3^^0
"BLD",443,"KRN",.84,"NM",904,0)
37202^^0
"BLD",443,"KRN",.84,"NM",905,0)
37203^^0
"BLD",443,"KRN",.84,"NM",906,0)
37204^^0
"BLD",443,"KRN",.84,"NM",907,0)
37204.1^^0
"BLD",443,"KRN",.84,"NM",908,0)
37204.2^^0
"BLD",443,"KRN",.84,"NM",909,0)
37205^^0
"BLD",443,"KRN",.84,"NM",910,0)
37206^^0
"BLD",443,"KRN",.84,"NM",911,0)
37207^^0
"BLD",443,"KRN",.84,"NM",912,0)
37208^^0
"BLD",443,"KRN",.84,"NM",913,0)
37209^^0
"BLD",443,"KRN",.84,"NM",914,0)
37211^^0
"BLD",443,"KRN",.84,"NM",915,0)
37212^^0
"BLD",443,"KRN",.84,"NM",916,0)
37212.8^^0
"BLD",443,"KRN",.84,"NM",917,0)
37212.9^^0
"BLD",443,"KRN",.84,"NM",918,0)
37213^^0
"BLD",443,"KRN",.84,"NM",919,0)
37214^^0
"BLD",443,"KRN",.84,"NM",920,0)
37215.1^^0
"BLD",443,"KRN",.84,"NM",921,0)
37215.2^^0
"BLD",443,"KRN",.84,"NM",922,0)
37215.3^^0
"BLD",443,"KRN",.84,"NM",923,0)
37215.4^^0
"BLD",443,"KRN",.84,"NM",924,0)
37216^^0
"BLD",443,"KRN",.84,"NM",925,0)
37219^^0
"BLD",443,"KRN",.84,"NM",926,0)
37219.5^^0
"BLD",443,"KRN",.84,"NM",927,0)
37221^^0
"BLD",443,"KRN",.84,"NM",928,0)
37222^^0
"BLD",443,"KRN",.84,"NM",929,0)
37223^^0
"BLD",443,"KRN",.84,"NM",930,0)
37231^^0
"BLD",443,"KRN",.84,"NM",931,0)
37232^^0
"BLD",443,"KRN",.84,"NM",932,0)
37241^^0
"BLD",443,"KRN",.84,"NM",933,0)
37251^^0
"BLD",443,"KRN",.84,"NM",934,0)
37261^^0
"BLD",443,"KRN",.84,"NM",935,0)
37301^^0
"BLD",443,"KRN",.84,"NM",936,0)
37301.6^^0
"BLD",443,"KRN",.84,"NM",937,0)
37301.9^^0
"BLD",443,"KRN",.84,"NM",938,0)
37302^^0
"BLD",443,"KRN",.84,"NM",939,0)
37302.9^^0
"BLD",443,"KRN",.84,"NM",940,0)
37303^^0
"BLD",443,"KRN",.84,"NM",941,0)
37303.1^^0
"BLD",443,"KRN",.84,"NM",942,0)
37303.2^^0
"BLD",443,"KRN",.84,"NM",943,0)
37303.9^^0
"BLD",443,"KRN",.84,"NM",944,0)
37304^^0
"BLD",443,"KRN",.84,"NM",945,0)
37304.9^^0
"BLD",443,"KRN",.84,"NM",946,0)
37305^^0
"BLD",443,"KRN",.84,"NM",947,0)
37306^^0
"BLD",443,"KRN",.84,"NM",948,0)
37306.1^^0
"BLD",443,"KRN",.84,"NM",949,0)
37306.2^^0
"BLD",443,"KRN",.84,"NM",950,0)
37307^^0
"BLD",443,"KRN",.84,"NM",951,0)
37307.9^^0
"BLD",443,"KRN",.84,"NM",952,0)
37308^^0
"BLD",443,"KRN",.84,"NM",953,0)
37308.9^^0
"BLD",443,"KRN",.84,"NM",954,0)
37309^^0
"BLD",443,"KRN",.84,"NM",955,0)
37309.1^^0
"BLD",443,"KRN",.84,"NM",956,0)
37309.2^^0
"BLD",443,"KRN",.84,"NM",957,0)
37309.3^^0
"BLD",443,"KRN",.84,"NM",958,0)
37309.4^^0
"BLD",443,"KRN",.84,"NM",959,0)
37309.5^^0
"BLD",443,"KRN",.84,"NM",960,0)
37309.9^^0
"BLD",443,"KRN",.84,"NM",961,0)
37311^^0
"BLD",443,"KRN",.84,"NM",962,0)
37311.9^^0
"BLD",443,"KRN",.84,"NM",963,0)
37312^^0
"BLD",443,"KRN",.84,"NM",964,0)
37312.9^^0
"BLD",443,"KRN",.84,"NM",965,0)
37313^^0
"BLD",443,"KRN",.84,"NM",966,0)
37313.9^^0
"BLD",443,"KRN",.84,"NM",967,0)
37314^^0
"BLD",443,"KRN",.84,"NM",968,0)
37314.9^^0
"BLD",443,"KRN",.84,"NM",969,0)
37315^^0
"BLD",443,"KRN",.84,"NM",970,0)
37315.4^^0
"BLD",443,"KRN",.84,"NM",971,0)
37315.8^^0
"BLD",443,"KRN",.84,"NM",972,0)
37315.9^^0
"BLD",443,"KRN",.84,"NM",973,0)
37316^^0
"BLD",443,"KRN",.84,"NM",974,0)
37316.8^^0
"BLD",443,"KRN",.84,"NM",975,0)
37316.9^^0
"BLD",443,"KRN",.84,"NM",976,0)
37317^^0
"BLD",443,"KRN",.84,"NM",977,0)
37317.1^^0
"BLD",443,"KRN",.84,"NM",978,0)
37317.2^^0
"BLD",443,"KRN",.84,"NM",979,0)
37317.9^^0
"BLD",443,"KRN",.84,"NM",980,0)
37318^^0
"BLD",443,"KRN",.84,"NM",981,0)
37318.9^^0
"BLD",443,"KRN",.84,"NM",982,0)
37319^^0
"BLD",443,"KRN",.84,"NM",983,0)
37319.9^^0
"BLD",443,"KRN",.84,"NM",984,0)
37320^^0
"BLD",443,"KRN",.84,"NM",985,0)
37320.6^^0
"BLD",443,"KRN",.84,"NM",986,0)
37320.9^^0
"BLD",443,"KRN",.84,"NM",987,0)
37331^^0
"BLD",443,"KRN",.84,"NM",988,0)
37332^^0
"BLD",443,"KRN",.84,"NM",989,0)
37333^^0
"BLD",443,"KRN",.84,"NM",990,0)
37333.1^^0
"BLD",443,"KRN",.84,"NM",991,0)
37333.2^^0
"BLD",443,"KRN",.84,"NM",992,0)
37333.3^^0
"BLD",443,"KRN",.84,"NM",993,0)
37333.8^^0
"BLD",443,"KRN",.84,"NM",994,0)
37333.9^^0
"BLD",443,"KRN",.84,"NM",995,0)
37334^^0
"BLD",443,"KRN",.84,"NM",996,0)
37341^^0
"BLD",443,"KRN",.84,"NM",997,0)
37342^^0
"BLD",443,"KRN",.84,"NM",998,0)
37350^^0
"BLD",443,"KRN",.84,"NM",999,0)
37351^^0
"BLD",443,"KRN",.84,"NM",1000,0)
37401^^0
"BLD",443,"KRN",.84,"NM",1001,0)
37401.1^^0
"BLD",443,"KRN",.84,"NM",1002,0)
37401.2^^0
"BLD",443,"KRN",.84,"NM",1003,0)
37401.3^^0
"BLD",443,"KRN",.84,"NM",1004,0)
37401.4^^0
"BLD",443,"KRN",.84,"NM",1005,0)
37401.5^^0
"BLD",443,"KRN",.84,"NM",1006,0)
37402^^0
"BLD",443,"KRN",.84,"NM",1007,0)
37402.1^^0
"BLD",443,"KRN",.84,"NM",1008,0)
37403^^0
"BLD",443,"KRN",.84,"NM",1009,0)
37403.1^^0
"BLD",443,"KRN",.84,"NM",1010,0)
37403.2^^0
"BLD",443,"KRN",.84,"NM",1011,0)
37403.4^^0
"BLD",443,"KRN",.84,"NM",1012,0)
37403.5^^0
"BLD",443,"KRN",.84,"NM",1013,0)
37403.6^^0
"BLD",443,"KRN",.84,"NM",1014,0)
37404^^0
"BLD",443,"KRN",.84,"NM",1015,0)
37404.1^^0
"BLD",443,"KRN",.84,"NM",1016,0)
37404.5^^0
"BLD",443,"KRN",.84,"NM",1017,0)
37405^^0
"BLD",443,"KRN",.84,"NM",1018,0)
37405.1^^0
"BLD",443,"KRN",.84,"NM",1019,0)
37405.2^^0
"BLD",443,"KRN",.84,"NM",1020,0)
37405.3^^0
"BLD",443,"KRN",.84,"NM",1021,0)
37405.4^^0
"BLD",443,"KRN",.84,"NM",1022,0)
37405.5^^0
"BLD",443,"KRN",.84,"NM",1023,0)
37406^^0
"BLD",443,"KRN",.84,"NM",1024,0)
37406.1^^0
"BLD",443,"KRN",.84,"NM",1025,0)
37406.6^^0
"BLD",443,"KRN",.84,"NM",1026,0)
37407^^0
"BLD",443,"KRN",.84,"NM",1027,0)
37408^^0
"BLD",443,"KRN",.84,"NM",1028,0)
37408.9^^0
"BLD",443,"KRN",.84,"NM",1029,0)
37409^^0
"BLD",443,"KRN",.84,"NM",1030,0)
37409.1^^0
"BLD",443,"KRN",.84,"NM",1031,0)
37409.5^^0
"BLD",443,"KRN",.84,"NM",1032,0)
37409.9^^0
"BLD",443,"KRN",.84,"NM",1033,0)
37411^^0
"BLD",443,"KRN",.84,"NM",1034,0)
37411.9^^0
"BLD",443,"KRN",.84,"NM",1035,0)
37412^^0
"BLD",443,"KRN",.84,"NM",1036,0)
37412.1^^0
"BLD",443,"KRN",.84,"NM",1037,0)
37412.9^^0
"BLD",443,"KRN",.84,"NM",1038,0)
37413^^0
"BLD",443,"KRN",.84,"NM",1039,0)
37414^^0
"BLD",443,"KRN",.84,"NM",1040,0)
37414.9^^0
"BLD",443,"KRN",.84,"NM",1041,0)
37415^^0
"BLD",443,"KRN",.84,"NM",1042,0)
37415.9^^0
"BLD",443,"KRN",.84,"NM",1043,0)
37416^^0
"BLD",443,"KRN",.84,"NM",1044,0)
37416.4^^0
"BLD",443,"KRN",.84,"NM",1045,0)
37417^^0
"BLD",443,"KRN",.84,"NM",1046,0)
37418^^0
"BLD",443,"KRN",.84,"NM",1047,0)
37419^^0
"BLD",443,"KRN",.84,"NM",1048,0)
37420^^0
"BLD",443,"KRN",.84,"NM",1049,0)
37420.1^^0
"BLD",443,"KRN",.84,"NM",1050,0)
37422^^0
"BLD",443,"KRN",.84,"NM",1051,0)
37422.1^^0
"BLD",443,"KRN",.84,"NM",1052,0)
37422.2^^0
"BLD",443,"KRN",.84,"NM",1053,0)
37422.3^^0
"BLD",443,"KRN",.84,"NM",1054,0)
37422.4^^0
"BLD",443,"KRN",.84,"NM",1055,0)
37422.5^^0
"BLD",443,"KRN",.84,"NM",1056,0)
37422.6^^0
"BLD",443,"KRN",.84,"NM",1057,0)
37423^^0
"BLD",443,"KRN",.84,"NM",1058,0)
37424^^0
"BLD",443,"KRN",.84,"NM",1059,0)
37425^^0
"BLD",443,"KRN",.84,"NM",1060,0)
37425.1^^0
"BLD",443,"KRN",.84,"NM",1061,0)
37426^^0
"BLD",443,"KRN",.84,"NM",1062,0)
37427^^0
"BLD",443,"KRN",.84,"NM",1063,0)
37428^^0
"BLD",443,"KRN",.84,"NM",1064,0)
37428.1^^0
"BLD",443,"KRN",.84,"NM",1065,0)
37428.2^^0
"BLD",443,"KRN",.84,"NM",1066,0)
37429^^0
"BLD",443,"KRN",.84,"NM",1067,0)
37430^^0
"BLD",443,"KRN",.84,"NM",1068,0)
37431^^0
"BLD",443,"KRN",.84,"NM",1069,0)
37431.9^^0
"BLD",443,"KRN",.84,"NM",1070,0)
37432^^0
"BLD",443,"KRN",.84,"NM",1071,0)
37432.9^^0
"BLD",443,"KRN",.84,"NM",1072,0)
37433^^0
"BLD",443,"KRN",.84,"NM",1073,0)
37433.9^^0
"BLD",443,"KRN",.84,"NM",1074,0)
37441^^0
"BLD",443,"KRN",.84,"NM",1075,0)
37442^^0
"BLD",443,"KRN",.84,"NM",1076,0)
37443^^0
"BLD",443,"KRN",.84,"NM",1077,0)
37444^^0
"BLD",443,"KRN",.84,"NM",1078,0)
37444.5^^0
"BLD",443,"KRN",.84,"NM",1079,0)
37445^^0
"BLD",443,"KRN",.84,"NM",1080,0)
37445.4^^0
"BLD",443,"KRN",.84,"NM",1081,0)
37446^^0
"BLD",443,"KRN",.84,"NM",1082,0)
37446.9^^0
"BLD",443,"KRN",.84,"NM",1083,0)
37451^^0
"BLD",443,"KRN",.84,"NM",1084,0)
37452^^0
"BLD",443,"KRN",.84,"NM",1085,0)
37453^^0
"BLD",443,"KRN",.84,"NM",1086,0)
37455^^0
"BLD",443,"KRN",.84,"NM",1087,0)
37456^^0
"BLD",443,"KRN",.84,"NM",1088,0)
37457^^0
"BLD",443,"KRN",.84,"NM",1089,0)
37458^^0
"BLD",443,"KRN",.84,"NM",1090,0)
37461^^0
"BLD",443,"KRN",.84,"NM",1091,0)
37462^^0
"BLD",443,"KRN",.84,"NM",1092,0)
37470^^0
"BLD",443,"KRN",.84,"NM",1093,0)
37471^^0
"BLD",443,"KRN",.84,"NM",1094,0)
37472^^0
"BLD",443,"KRN",.84,"NM",1095,0)
38001^^0
"BLD",443,"KRN",.84,"NM",1096,0)
38002^^0
"BLD",443,"KRN",.84,"NM",1097,0)
38003^^0
"BLD",443,"KRN",.84,"NM",1098,0)
38004^^0
"BLD",443,"KRN",.84,"NM",1099,0)
38005^^0
"BLD",443,"KRN",.84,"NM",1100,0)
38006^^0
"BLD",443,"KRN",.84,"NM",1101,0)
38007^^0
"BLD",443,"KRN",.84,"NM",1102,0)
38008^^0
"BLD",443,"KRN",.84,"NM",1103,0)
38009^^0
"BLD",443,"KRN",.84,"NM",1104,0)
38010^^0
"BLD",443,"KRN",.84,"NM",1105,0)
38011^^0
"BLD",443,"KRN",.84,"NM",1106,0)
38012^^0
"BLD",443,"KRN",.84,"NM",1107,0)
38013^^0
"BLD",443,"KRN",.84,"NM",1108,0)
38014^^0
"BLD",443,"KRN",.84,"NM",1109,0)
38015^^0
"BLD",443,"KRN",.84,"NM",1110,0)
38016^^0
"BLD",443,"KRN",.84,"NM",1111,0)
38017^^0
"BLD",443,"KRN",.84,"NM",1112,0)
38018^^0
"BLD",443,"KRN",.84,"NM",1113,0)
38019^^0
"BLD",443,"KRN",.84,"NM",1114,0)
38020^^0
"BLD",443,"KRN",.84,"NM",1115,0)
38021^^0
"BLD",443,"KRN",.84,"NM",1116,0)
38022^^0
"BLD",443,"KRN",.84,"NM",1117,0)
38022.1^^0
"BLD",443,"KRN",.84,"NM",1118,0)
38023^^0
"BLD",443,"KRN",.84,"NM",1119,0)
38023.1^^0
"BLD",443,"KRN",.84,"NM",1120,0)
38023.5^^0
"BLD",443,"KRN",.84,"NM",1121,0)
38023.8^^0
"BLD",443,"KRN",.84,"NM",1122,0)
38023.9^^0
"BLD",443,"KRN",.84,"NM",1123,0)
38024^^0
"BLD",443,"KRN",.84,"NM",1124,0)
38024.1^^0
"BLD",443,"KRN",.84,"NM",1125,0)
38025^^0
"BLD",443,"KRN",.84,"NM",1126,0)
38026^^0
"BLD",443,"KRN",.84,"NM",1127,0)
38027^^0
"BLD",443,"KRN",.84,"NM",1128,0)
38028^^0
"BLD",443,"KRN",.84,"NM",1129,0)
38029^^0
"BLD",443,"KRN",.84,"NM",1130,0)
38030^^0
"BLD",443,"KRN",.84,"NM",1131,0)
38031^^0
"BLD",443,"KRN",.84,"NM",1132,0)
38040^^0
"BLD",443,"KRN",.84,"NM",1133,0)
38041^^0
"BLD",443,"KRN",.84,"NM",1134,0)
38042^^0
"BLD",443,"KRN",.84,"NM",1135,0)
38043^^0
"BLD",443,"KRN",.84,"NM",1136,0)
38044^^0
"BLD",443,"KRN",.84,"NM",1137,0)
38045^^0
"BLD",443,"KRN",.84,"NM",1138,0)
38046^^0
"BLD",443,"KRN",.84,"NM",1139,0)
38047^^0
"BLD",443,"KRN",.84,"NM",1140,0)
38048^^0
"BLD",443,"KRN",.84,"NM",1141,0)
38049^^0
"BLD",443,"KRN",.84,"NM",1142,0)
38050^^0
"BLD",443,"KRN",.84,"NM",1143,0)
38051^^0
"BLD",443,"KRN",.84,"NM",1144,0)
38052^^0
"BLD",443,"KRN",.84,"NM",1145,0)
38053^^0
"BLD",443,"KRN",.84,"NM",1146,0)
38054^^0
"BLD",443,"KRN",.84,"NM",1147,0)
38055^^0
"BLD",443,"KRN",.84,"NM",1148,0)
38056^^0
"BLD",443,"KRN",.84,"NM",1149,0)
38100^^0
"BLD",443,"KRN",.84,"NM",1150,0)
38105^^0
"BLD",443,"KRN",.84,"NM",1151,0)
38106^^0
"BLD",443,"KRN",.84,"NM",1152,0)
38107^^0
"BLD",443,"KRN",.84,"NM",1153,0)
38109^^0
"BLD",443,"KRN",.84,"NM",1154,0)
38110^^0
"BLD",443,"KRN",.84,"NM",1155,0)
38110.1^^0
"BLD",443,"KRN",.84,"NM",1156,0)
38110.2^^0
"BLD",443,"KRN",.84,"NM",1157,0)
38110.3^^0
"BLD",443,"KRN",.84,"NM",1158,0)
38111^^0
"BLD",443,"KRN",.84,"NM",1159,0)
38112^^0
"BLD",443,"KRN",.84,"NM",1160,0)
38113^^0
"BLD",443,"KRN",.84,"NM",1161,0)
38113.1^^0
"BLD",443,"KRN",.84,"NM",1162,0)
38114^^0
"BLD",443,"KRN",.84,"NM",1163,0)
38114.1^^0
"BLD",443,"KRN",.84,"NM",1164,0)
38130^^0
"BLD",443,"KRN",.84,"NM",1165,0)
38131^^0
"BLD",443,"KRN",.84,"NM",1166,0)
38132^^0
"BLD",443,"KRN",.84,"NM",1167,0)
38133^^0
"BLD",443,"KRN",.84,"NM",1168,0)
38140^^0
"BLD",443,"KRN",.84,"NM",1169,0)
38141^^0
"BLD",443,"KRN",.84,"NM",1170,0)
38150^^0
"BLD",443,"KRN",.84,"NM",1171,0)
38151^^0
"BLD",443,"KRN",.84,"NM",1172,0)
38152^^0
"BLD",443,"KRN",.84,"NM",1173,0)
38153^^0
"BLD",443,"KRN",.84,"NM",1174,0)
38154^^0
"BLD",443,"KRN",.84,"NM",1175,0)
38155^^0
"BLD",443,"KRN",.84,"NM",1176,0)
38155.1^^0
"BLD",443,"KRN",.84,"NM",1177,0)
38155.2^^0
"BLD",443,"KRN",.84,"NM",1178,0)
38156^^0
"BLD",443,"KRN",.84,"NM",1179,0)
38156.1^^0
"BLD",443,"KRN",.84,"NM",1180,0)
38156.2^^0
"BLD",443,"KRN",.84,"NM",1181,0)
38157^^0
"BLD",443,"KRN",.84,"NM",1182,0)
38158^^0
"BLD",443,"KRN",.84,"NM",1183,0)
38159^^0
"BLD",443,"KRN",.84,"NM",1184,0)
38160^^0
"BLD",443,"KRN",.84,"NM",1185,0)
38161^^0
"BLD",443,"KRN",.84,"NM",1186,0)
38162^^0
"BLD",443,"KRN",.84,"NM",1187,0)
38165^^0
"BLD",443,"KRN",.84,"NM",1188,0)
38165.1^^0
"BLD",443,"KRN",.84,"NM",1189,0)
38170^^0
"BLD",443,"KRN",.84,"NM",1190,0)
38171^^0
"BLD",443,"KRN",.84,"NM",1191,0)
38172^^0
"BLD",443,"KRN",.84,"NM",1192,0)
38173^^0
"BLD",443,"KRN",.84,"NM",1193,0)
38174^^0
"BLD",443,"KRN",.84,"NM",1194,0)
38175^^0
"BLD",443,"KRN",.84,"NM",1195,0)
38176^^0
"BLD",443,"KRN",.84,"NM",1196,0)
38177^^0
"BLD",443,"KRN",.84,"NM",1197,0)
38178^^0
"BLD",443,"KRN",.84,"NM",1198,0)
38179^^0
"BLD",443,"KRN",.84,"NM",1199,0)
38200^^0
"BLD",443,"KRN",.84,"NM",1200,0)
38201^^0
"BLD",443,"KRN",.84,"NM",1201,0)
38210^^0
"BLD",443,"KRN",.84,"NM",1202,0)
38211^^0
"BLD",443,"KRN",.84,"NM",1203,0)
38213^^0
"BLD",443,"KRN",.84,"NM",1204,0)
38214^^0
"BLD",443,"KRN",.84,"NM",1205,0)
38215^^0
"BLD",443,"KRN",.84,"NM",1206,0)
38216^^0
"BLD",443,"KRN",.84,"NM",1207,0)
38217^^0
"BLD",443,"KRN",.84,"NM",1208,0)
38218^^0
"BLD",443,"KRN",.84,"NM",1209,0)
38220^^0
"BLD",443,"KRN",.84,"NM",1210,0)
38221^^0
"BLD",443,"KRN",.84,"NM",1211,0)
38222^^0
"BLD",443,"KRN",.84,"NM",1212,0)
38223^^0
"BLD",443,"KRN",.84,"NM",1213,0)
38224^^0
"BLD",443,"KRN",.84,"NM",1214,0)
38225^^0
"BLD",443,"KRN",.84,"NM",1215,0)
38226^^0
"BLD",443,"KRN",.84,"NM",1216,0)
38230^^0
"BLD",443,"KRN",.84,"NM",1217,0)
38231^^0
"BLD",443,"KRN",.84,"NM",1218,0)
38232^^0
"BLD",443,"KRN",.84,"NM",1219,0)
38233^^0
"BLD",443,"KRN",.84,"NM",1220,0)
39001^^0
"BLD",443,"KRN",.84,"NM",1221,0)
39002^^0
"BLD",443,"KRN",.84,"NM",1222,0)
39003^^0
"BLD",443,"KRN",.84,"NM",1223,0)
39004^^0
"BLD",443,"KRN",.84,"NM",1224,0)
39005^^0
"BLD",443,"KRN",.84,"NM",1225,0)
39006^^0
"BLD",443,"KRN",.84,"NM",1226,0)
39007^^0
"BLD",443,"KRN",.84,"NM",1227,0)
39008^^0
"BLD",443,"KRN",.84,"NM",1228,0)
39009^^0
"BLD",443,"KRN",.84,"NM",1229,0)
39010^^0
"BLD",443,"KRN",.84,"NM",1230,0)
39011^^0
"BLD",443,"KRN",.84,"NM",1231,0)
39012^^0
"BLD",443,"KRN",.84,"NM",1232,0)
39013^^0
"BLD",443,"KRN",.84,"NM",1233,0)
39014^^0
"BLD",443,"KRN",.84,"NM",1234,0)
39015^^0
"BLD",443,"KRN",.84,"NM",1235,0)
39015.1^^0
"BLD",443,"KRN",.84,"NM",1236,0)
39016^^0
"BLD",443,"KRN",.84,"NM",1237,0)
39017^^0
"BLD",443,"KRN",.84,"NM",1238,0)
39018^^0
"BLD",443,"KRN",.84,"NM",1239,0)
39019^^0
"BLD",443,"KRN",.84,"NM",1240,0)
39020^^0
"BLD",443,"KRN",.84,"NM",1241,0)
39021^^0
"BLD",443,"KRN",.84,"NM",1242,0)
39022^^0
"BLD",443,"KRN",.84,"NM",1243,0)
39023^^0
"BLD",443,"KRN",.84,"NM",1244,0)
39024^^0
"BLD",443,"KRN",.84,"NM",1245,0)
39025^^0
"BLD",443,"KRN",.84,"NM",1246,0)
39025.1^^0
"BLD",443,"KRN",.84,"NM",1247,0)
39026^^0
"BLD",443,"KRN",.84,"NM",1248,0)
39027^^0
"BLD",443,"KRN",.84,"NM",1249,0)
39028^^0
"BLD",443,"KRN",.84,"NM",1250,0)
39028.1^^0
"BLD",443,"KRN",.84,"NM",1251,0)
39029^^0
"BLD",443,"KRN",.84,"NM",1252,0)
39030^^0
"BLD",443,"KRN",.84,"NM",1253,0)
39031^^0
"BLD",443,"KRN",.84,"NM",1254,0)
39032^^0
"BLD",443,"KRN",.84,"NM",1255,0)
39033^^0
"BLD",443,"KRN",.84,"NM",1256,0)
39034^^0
"BLD",443,"KRN",.84,"NM",1257,0)
39035^^0
"BLD",443,"KRN",.84,"NM",1258,0)
39036^^0
"BLD",443,"KRN",.84,"NM",1259,0)
39037^^0
"BLD",443,"KRN",.84,"NM",1260,0)
39038^^0
"BLD",443,"KRN",.84,"NM",1261,0)
39039^^0
"BLD",443,"KRN",.84,"NM",1262,0)
39040^^0
"BLD",443,"KRN",.84,"NM",1263,0)
39041^^0
"BLD",443,"KRN",.84,"NM",1264,0)
39042^^0
"BLD",443,"KRN",.84,"NM",1265,0)
39043^^0
"BLD",443,"KRN",.84,"NM",1266,0)
39044^^0
"BLD",443,"KRN",.84,"NM",1267,0)
39045^^0
"BLD",443,"KRN",.84,"NM",1268,0)
39046^^0
"BLD",443,"KRN",.84,"NM",1269,0)
39047^^0
"BLD",443,"KRN",.84,"NM",1270,0)
39047.5^^0
"BLD",443,"KRN",.84,"NM",1271,0)
39048^^0
"BLD",443,"KRN",.84,"NM",1272,0)
39049^^0
"BLD",443,"KRN",.84,"NM",1273,0)
39050^^0
"BLD",443,"KRN",.84,"NM",1274,0)
39051^^0
"BLD",443,"KRN",.84,"NM",1275,0)
39052^^0
"BLD",443,"KRN",.84,"NM",1276,0)
39053^^0
"BLD",443,"KRN",.84,"NM",1277,0)
39054^^0
"BLD",443,"KRN",.84,"NM",1278,0)
39054.1^^0
"BLD",443,"KRN",.84,"NM",1279,0)
39060^^0
"BLD",443,"KRN",.84,"NM",1280,0)
39061^^0
"BLD",443,"KRN",.84,"NM",1281,0)
39062^^0
"BLD",443,"KRN",.84,"NM",1282,0)
39063^^0
"BLD",443,"KRN",.84,"NM",1283,0)
39064^^0
"BLD",443,"KRN",.84,"NM",1284,0)
39065^^0
"BLD",443,"KRN",.84,"NM",1285,0)
39066^^0
"BLD",443,"KRN",.84,"NM",1286,0)
39067^^0
"BLD",443,"KRN",.84,"NM",1287,0)
39068^^0
"BLD",443,"KRN",.84,"NM",1288,0)
39069^^0
"BLD",443,"KRN",.84,"NM",1289,0)
39080^^0
"BLD",443,"KRN",.84,"NM",1290,0)
39081^^0
"BLD",443,"KRN",.84,"NM",1291,0)
39082^^0
"BLD",443,"KRN",.84,"NM",1292,0)
39083^^0
"BLD",443,"KRN",.84,"NM",1293,0)
39084^^0
"BLD",443,"KRN",.84,"NM",1294,0)
39085^^0
"BLD",443,"KRN",.84,"NM",1295,0)
39086^^0
"BLD",443,"KRN",.84,"NM",1296,0)
39087^^0
"BLD",443,"KRN",.84,"NM",1297,0)
39088^^0
"BLD",443,"KRN",.84,"NM",1298,0)
39089^^0
"BLD",443,"KRN",.84,"NM",1299,0)
39090^^0
"BLD",443,"KRN",.84,"NM",1300,0)
39091^^0
"BLD",443,"KRN",.84,"NM",1301,0)
39092^^0
"BLD",443,"KRN",.84,"NM",1302,0)
39093^^0
"BLD",443,"KRN",.84,"NM",1303,0)
39100^^0
"BLD",443,"KRN",.84,"NM",1304,0)
39101^^0
"BLD",443,"KRN",.84,"NM",1305,0)
39102^^0
"BLD",443,"KRN",.84,"NM",1306,0)
39103^^0
"BLD",443,"KRN",.84,"NM",1307,0)
39104^^0
"BLD",443,"KRN",.84,"NM",1308,0)
39105^^0
"BLD",443,"KRN",.84,"NM",1309,0)
39106^^0
"BLD",443,"KRN",.84,"NM",1310,0)
39107^^0
"BLD",443,"KRN",.84,"NM",1311,0)
39108^^0
"BLD",443,"KRN",.84,"NM",1312,0)
39109^^0
"BLD",443,"KRN",.84,"NM",1313,0)
39110^^0
"BLD",443,"KRN",.84,"NM",1314,0)
39111^^0
"BLD",443,"KRN",.84,"NM",1315,0)
39112^^0
"BLD",443,"KRN",.84,"NM",1316,0)
39113^^0
"BLD",443,"KRN",.84,"NM",1317,0)
39114^^0
"BLD",443,"KRN",.84,"NM",1318,0)
39115^^0
"BLD",443,"KRN",.84,"NM",1319,0)
39116^^0
"BLD",443,"KRN",.84,"NM",1320,0)
39130^^0
"BLD",443,"KRN",.84,"NM",1321,0)
39131^^0
"BLD",443,"KRN",.84,"NM",1322,0)
39132^^0
"BLD",443,"KRN",.84,"NM",1323,0)
39133^^0
"BLD",443,"KRN",.84,"NM",1324,0)
39134^^0
"BLD",443,"KRN",.84,"NM",1325,0)
39135^^0
"BLD",443,"KRN",.84,"NM",1326,0)
39136^^0
"BLD",443,"KRN",.84,"NM",1327,0)
39137^^0
"BLD",443,"KRN",.84,"NM",1328,0)
39138^^0
"BLD",443,"KRN",.84,"NM",1329,0)
39139^^0
"BLD",443,"KRN",.84,"NM",1330,0)
39140^^0
"BLD",443,"KRN",.84,"NM",1331,0)
39141^^0
"BLD",443,"KRN",.84,"NM",1332,0)
39142^^0
"BLD",443,"KRN",.84,"NM",1333,0)
39143^^0
"BLD",443,"KRN",.84,"NM",1334,0)
39144^^0
"BLD",443,"KRN",.84,"NM",1335,0)
39145^^0
"BLD",443,"KRN",.84,"NM",1336,0)
39146^^0
"BLD",443,"KRN",.84,"NM",1337,0)
39147^^0
"BLD",443,"KRN",.84,"NM",1338,0)
39148^^0
"BLD",443,"KRN",.84,"NM",1339,0)
39149^^0
"BLD",443,"KRN",.84,"NM",1340,0)
39200^^0
"BLD",443,"KRN",.84,"NM",1341,0)
39201^^0
"BLD",443,"KRN",.84,"NM",1342,0)
39202^^0
"BLD",443,"KRN",.84,"NM",1343,0)
39203^^0
"BLD",443,"KRN",.84,"NM",1344,0)
39204^^0
"BLD",443,"KRN",.84,"NM",1345,0)
39300^^0
"BLD",443,"KRN",.84,"NM",1346,0)
39301^^0
"BLD",443,"KRN",.84,"NM",1347,0)
39302^^0
"BLD",443,"KRN",.84,"NM",1348,0)
39303.1^^0
"BLD",443,"KRN",.84,"NM",1349,0)
39303.2^^0
"BLD",443,"KRN",.84,"NM",1350,0)
39303.3^^0
"BLD",443,"KRN",.84,"NM",1351,0)
39303.4^^0
"BLD",443,"KRN",.84,"NM",1352,0)
39303.5^^0
"BLD",443,"KRN",.84,"NM",1353,0)
39310^^0
"BLD",443,"KRN",.84,"NM",1354,0)
39311^^0
"BLD",443,"KRN",.84,"NM",1355,0)
39320^^0
"BLD",443,"KRN",.84,"NM",1356,0)
39321^^0
"BLD",443,"KRN",.84,"NM",1357,0)
39401^^0
"BLD",443,"KRN",.84,"NM",1358,0)
39402^^0
"BLD",443,"KRN",.84,"NM",1359,0)
39403^^0
"BLD",443,"KRN",.84,"NM",1360,0)
39404^^0
"BLD",443,"KRN",.84,"NM",1361,0)
39405^^0
"BLD",443,"KRN",.84,"NM",1362,0)
39406^^0
"BLD",443,"KRN",.84,"NM",1363,0)
39407^^0
"BLD",443,"KRN",.84,"NM",1364,0)
39408^^0
"BLD",443,"KRN",.84,"NM",1365,0)
39409^^0
"BLD",443,"KRN",.84,"NM",1366,0)
39410^^0
"BLD",443,"KRN",.84,"NM",1367,0)
39411^^0
"BLD",443,"KRN",.84,"NM",1368,0)
39412^^0
"BLD",443,"KRN",.84,"NM",1369,0)
39413^^0
"BLD",443,"KRN",.84,"NM",1370,0)
39414^^0
"BLD",443,"KRN",.84,"NM",1371,0)
39415^^0
"BLD",443,"KRN",.84,"NM",1372,0)
39416^^0
"BLD",443,"KRN",.84,"NM",1373,0)
39417^^0
"BLD",443,"KRN",.84,"NM",1374,0)
39418^^0
"BLD",443,"KRN",.84,"NM",1375,0)
39419^^0
"BLD",443,"KRN",.84,"NM",1376,0)
39420^^0
"BLD",443,"KRN",.84,"NM",1377,0)
39430^^0
"BLD",443,"KRN",.84,"NM",1378,0)
39431^^0
"BLD",443,"KRN",.84,"NM",1379,0)
39432^^0
"BLD",443,"KRN",.84,"NM",1380,0)
39433^^0
"BLD",443,"KRN",.84,"NM",1381,0)
39434^^0
"BLD",443,"KRN",.84,"NM",1382,0)
39435^^0
"BLD",443,"KRN",.84,"NM",1383,0)
39436^^0
"BLD",443,"KRN",.84,"NM",1384,0)
39437^^0
"BLD",443,"KRN",.84,"NM",1385,0)
39438^^0
"BLD",443,"KRN",.84,"NM",1386,0)
39440^^0
"BLD",443,"KRN",.84,"NM",1387,0)
39441^^0
"BLD",443,"KRN",.84,"NM",1388,0)
39442^^0
"BLD",443,"KRN",.84,"NM",1389,0)
39443^^0
"BLD",443,"KRN",.84,"NM",1390,0)
39501^^0
"BLD",443,"KRN",.84,"NM",1391,0)
39502^^0
"BLD",443,"KRN",.84,"NM",1392,0)
39503^^0
"BLD",443,"KRN",.84,"NM",1393,0)
39503.1^^0
"BLD",443,"KRN",.84,"NM",1394,0)
39504^^0
"BLD",443,"KRN",.84,"NM",1395,0)
39504.1^^0
"BLD",443,"KRN",.84,"NM",1397,0)
42000^^0
"BLD",443,"KRN",.84,"NM",1398,0)
42001^^0
"BLD",443,"KRN",.84,"NM",1399,0)
42002^^0
"BLD",443,"KRN",.84,"NM",1400,0)
42002.1^^0
"BLD",443,"KRN",.84,"NM",1401,0)
42002.2^^0
"BLD",443,"KRN",.84,"NM",1402,0)
42003^^0
"BLD",443,"KRN",.84,"NM",1403,0)
42100^^0
"BLD",443,"KRN",.84,"NM",1404,0)
42101^^0
"BLD",443,"KRN",.84,"NM",1405,0)
42102^^0
"BLD",443,"KRN",.84,"NM",1406,0)
42103^^0
"BLD",443,"KRN",.84,"NM",1407,0)
42104^^0
"BLD",443,"KRN",.84,"NM",1408,0)
42105^^0
"BLD",443,"KRN",.84,"NM",1409,0)
42106^^0
"BLD",443,"KRN",.84,"NM",1410,0)
42110^^0
"BLD",443,"KRN",.84,"NM",1411,0)
42111^^0
"BLD",443,"KRN",.84,"NM",1412,0)
42112^^0
"BLD",443,"KRN",.84,"NM",1413,0)
42113^^0
"BLD",443,"KRN",.84,"NM",1414,0)
42114^^0
"BLD",443,"KRN",.84,"NM",1415,0)
42115^^0
"BLD",443,"KRN",.84,"NM",1416,0)
42116^^0
"BLD",443,"KRN",.84,"NM",1417,0)
42117^^0
"BLD",443,"KRN",.84,"NM",1418,0)
42120^^0
"BLD",443,"KRN",.84,"NM",1419,0)
42121^^0
"BLD",443,"KRN",.84,"NM",1420,0)
42122^^0
"BLD",443,"KRN",.84,"NM",1421,0)
42123^^0
"BLD",443,"KRN",.84,"NM",1422,0)
42125^^0
"BLD",443,"KRN",.84,"NM",1423,0)
42126^^0
"BLD",443,"KRN",.84,"NM",1424,0)
42127^^0
"BLD",443,"KRN",.84,"NM",1425,0)
42128^^0
"BLD",443,"KRN",.84,"NM",1426,0)
42129^^0
"BLD",443,"KRN",.84,"NM",1427,0)
42130^^0
"BLD",443,"KRN",.84,"NM",1428,0)
42131^^0
"BLD",443,"KRN",.84,"NM",1429,0)
42132^^0
"BLD",443,"KRN",.84,"NM",1430,0)
42135^^0
"BLD",443,"KRN",.84,"NM",1431,0)
42136^^0
"BLD",443,"KRN",.84,"NM",1432,0)
42138^^0
"BLD",443,"KRN",.84,"NM",1433,0)
42139^^0
"BLD",443,"KRN",.84,"NM",1434,0)
42140^^0
"BLD",443,"KRN",.84,"NM",1435,0)
42141^^0
"BLD",443,"KRN",.84,"NM",1436,0)
36512^^0
"BLD",443,"KRN",.84,"NM",1437,0)
37103^^0
"BLD",443,"KRN",.84,"NM",1438,0)
37104^^0
"BLD",443,"KRN",.84,"NM",1439,0)
36141.1^^0
"BLD",443,"KRN",.84,"NM",1440,0)
42211^^0
"BLD",443,"KRN",.84,"NM",1441,0)
42355.1^^0
"BLD",443,"KRN",.84,"NM",1442,0)
42358^^0
"BLD",443,"KRN",.84,"NM",1443,0)
42269^^0
"BLD",443,"KRN",.84,"NM",1444,0)
34444.5^^0
"BLD",443,"KRN",.84,"NM",1445,0)
36614^^0
"BLD",443,"KRN",.84,"NM",1446,0)
34425^^1^
"BLD",443,"KRN",.84,"NM",1447,0)
34443^^1^
"BLD",443,"KRN",.84,"NM",1448,0)
34443.1^^1^
"BLD",443,"KRN",.84,"NM","B",34001,146)

"BLD",443,"KRN",.84,"NM","B",34002,147)

"BLD",443,"KRN",.84,"NM","B",34003,148)

"BLD",443,"KRN",.84,"NM","B",34003.1,149)

"BLD",443,"KRN",.84,"NM","B",34004,150)

"BLD",443,"KRN",.84,"NM","B",34005,151)

"BLD",443,"KRN",.84,"NM","B",34006,152)

"BLD",443,"KRN",.84,"NM","B",34007,153)

"BLD",443,"KRN",.84,"NM","B",34007.1,154)

"BLD",443,"KRN",.84,"NM","B",34007.2,89)

"BLD",443,"KRN",.84,"NM","B",34008,155)

"BLD",443,"KRN",.84,"NM","B",34009,156)

"BLD",443,"KRN",.84,"NM","B",34010,157)

"BLD",443,"KRN",.84,"NM","B",34011,158)

"BLD",443,"KRN",.84,"NM","B",34012,159)

"BLD",443,"KRN",.84,"NM","B",34013,160)

"BLD",443,"KRN",.84,"NM","B",34014,161)

"BLD",443,"KRN",.84,"NM","B",34015,162)

"BLD",443,"KRN",.84,"NM","B",34016,163)

"BLD",443,"KRN",.84,"NM","B",34017,164)

"BLD",443,"KRN",.84,"NM","B",34018,165)

"BLD",443,"KRN",.84,"NM","B",34019,166)

"BLD",443,"KRN",.84,"NM","B",34019.1,131)

"BLD",443,"KRN",.84,"NM","B",34020,167)

"BLD",443,"KRN",.84,"NM","B",34021,168)

"BLD",443,"KRN",.84,"NM","B",34022,169)

"BLD",443,"KRN",.84,"NM","B",34023,170)

"BLD",443,"KRN",.84,"NM","B",34024,171)

"BLD",443,"KRN",.84,"NM","B",34025,172)

"BLD",443,"KRN",.84,"NM","B",34026,173)

"BLD",443,"KRN",.84,"NM","B",34026.1,174)

"BLD",443,"KRN",.84,"NM","B",34027,175)

"BLD",443,"KRN",.84,"NM","B",34027.1,176)

"BLD",443,"KRN",.84,"NM","B",34027.2,177)

"BLD",443,"KRN",.84,"NM","B",34028,178)

"BLD",443,"KRN",.84,"NM","B",34029,179)

"BLD",443,"KRN",.84,"NM","B",34030,180)

"BLD",443,"KRN",.84,"NM","B",34030.9,181)

"BLD",443,"KRN",.84,"NM","B",34031,182)

"BLD",443,"KRN",.84,"NM","B",34032,183)

"BLD",443,"KRN",.84,"NM","B",34034,184)

"BLD",443,"KRN",.84,"NM","B",34035,185)

"BLD",443,"KRN",.84,"NM","B",34036,186)

"BLD",443,"KRN",.84,"NM","B",34037,187)

"BLD",443,"KRN",.84,"NM","B",34038,188)

"BLD",443,"KRN",.84,"NM","B",34039,189)

"BLD",443,"KRN",.84,"NM","B",34040,190)

"BLD",443,"KRN",.84,"NM","B",34041,191)

"BLD",443,"KRN",.84,"NM","B",34042,192)

"BLD",443,"KRN",.84,"NM","B",34043,193)

"BLD",443,"KRN",.84,"NM","B",34043.1,194)

"BLD",443,"KRN",.84,"NM","B",34044,195)

"BLD",443,"KRN",.84,"NM","B",34045,196)

"BLD",443,"KRN",.84,"NM","B",34046,197)

"BLD",443,"KRN",.84,"NM","B",34047,198)

"BLD",443,"KRN",.84,"NM","B",34048,199)

"BLD",443,"KRN",.84,"NM","B",34048.8,200)

"BLD",443,"KRN",.84,"NM","B",34048.9,201)

"BLD",443,"KRN",.84,"NM","B",34050,202)

"BLD",443,"KRN",.84,"NM","B",34051,203)

"BLD",443,"KRN",.84,"NM","B",34051.1,204)

"BLD",443,"KRN",.84,"NM","B",34052,205)

"BLD",443,"KRN",.84,"NM","B",34053,206)

"BLD",443,"KRN",.84,"NM","B",34054,207)

"BLD",443,"KRN",.84,"NM","B",34055,208)

"BLD",443,"KRN",.84,"NM","B",34056,209)

"BLD",443,"KRN",.84,"NM","B",34057,210)

"BLD",443,"KRN",.84,"NM","B",34058,211)

"BLD",443,"KRN",.84,"NM","B",34059,212)

"BLD",443,"KRN",.84,"NM","B",34060,213)

"BLD",443,"KRN",.84,"NM","B",34061,214)

"BLD",443,"KRN",.84,"NM","B",34065,215)

"BLD",443,"KRN",.84,"NM","B",34066,216)

"BLD",443,"KRN",.84,"NM","B",34067,217)

"BLD",443,"KRN",.84,"NM","B",34068,218)

"BLD",443,"KRN",.84,"NM","B",34070,219)

"BLD",443,"KRN",.84,"NM","B",34071,220)

"BLD",443,"KRN",.84,"NM","B",34072,221)

"BLD",443,"KRN",.84,"NM","B",34075,222)

"BLD",443,"KRN",.84,"NM","B",34076,223)

"BLD",443,"KRN",.84,"NM","B",34077,224)

"BLD",443,"KRN",.84,"NM","B",34078,225)

"BLD",443,"KRN",.84,"NM","B",34079,226)

"BLD",443,"KRN",.84,"NM","B",34081,227)

"BLD",443,"KRN",.84,"NM","B",34082,228)

"BLD",443,"KRN",.84,"NM","B",34085,229)

"BLD",443,"KRN",.84,"NM","B",34086,230)

"BLD",443,"KRN",.84,"NM","B",34087,231)

"BLD",443,"KRN",.84,"NM","B",34088,232)

"BLD",443,"KRN",.84,"NM","B",34089,233)

"BLD",443,"KRN",.84,"NM","B",34090,234)

"BLD",443,"KRN",.84,"NM","B",34091,235)

"BLD",443,"KRN",.84,"NM","B",34092,236)

"BLD",443,"KRN",.84,"NM","B",34098,237)

"BLD",443,"KRN",.84,"NM","B",34099,238)

"BLD",443,"KRN",.84,"NM","B",34100,239)

"BLD",443,"KRN",.84,"NM","B",34101,240)

"BLD",443,"KRN",.84,"NM","B",34102,241)

"BLD",443,"KRN",.84,"NM","B",34103,242)

"BLD",443,"KRN",.84,"NM","B",34104,243)

"BLD",443,"KRN",.84,"NM","B",34105,244)

"BLD",443,"KRN",.84,"NM","B",34106,245)

"BLD",443,"KRN",.84,"NM","B",34107,246)

"BLD",443,"KRN",.84,"NM","B",34110,247)

"BLD",443,"KRN",.84,"NM","B",34111,248)

"BLD",443,"KRN",.84,"NM","B",34112,249)

"BLD",443,"KRN",.84,"NM","B",34113,250)

"BLD",443,"KRN",.84,"NM","B",34114,251)

"BLD",443,"KRN",.84,"NM","B",34115,252)

"BLD",443,"KRN",.84,"NM","B",34116,253)

"BLD",443,"KRN",.84,"NM","B",34117,254)

"BLD",443,"KRN",.84,"NM","B",34120,255)

"BLD",443,"KRN",.84,"NM","B",34121,256)

"BLD",443,"KRN",.84,"NM","B",34122,257)

"BLD",443,"KRN",.84,"NM","B",34123,258)

"BLD",443,"KRN",.84,"NM","B",34124,259)

"BLD",443,"KRN",.84,"NM","B",34125,260)

"BLD",443,"KRN",.84,"NM","B",34126,261)

"BLD",443,"KRN",.84,"NM","B",34130,262)

"BLD",443,"KRN",.84,"NM","B",34131,263)

"BLD",443,"KRN",.84,"NM","B",34132,264)

"BLD",443,"KRN",.84,"NM","B",34133,265)

"BLD",443,"KRN",.84,"NM","B",34140,266)

"BLD",443,"KRN",.84,"NM","B",34141,267)

"BLD",443,"KRN",.84,"NM","B",34142,268)

"BLD",443,"KRN",.84,"NM","B",34143,269)

"BLD",443,"KRN",.84,"NM","B",34144,270)

"BLD",443,"KRN",.84,"NM","B",34145,271)

"BLD",443,"KRN",.84,"NM","B",34146,272)

"BLD",443,"KRN",.84,"NM","B",34149,273)

"BLD",443,"KRN",.84,"NM","B",34200,274)

"BLD",443,"KRN",.84,"NM","B",34201,275)

"BLD",443,"KRN",.84,"NM","B",34202,276)

"BLD",443,"KRN",.84,"NM","B",34203,277)

"BLD",443,"KRN",.84,"NM","B",34204,278)

"BLD",443,"KRN",.84,"NM","B",34205,279)

"BLD",443,"KRN",.84,"NM","B",34206,280)

"BLD",443,"KRN",.84,"NM","B",34207,281)

"BLD",443,"KRN",.84,"NM","B",34208,282)

"BLD",443,"KRN",.84,"NM","B",34209,283)

"BLD",443,"KRN",.84,"NM","B",34211,284)

"BLD",443,"KRN",.84,"NM","B",34212,285)

"BLD",443,"KRN",.84,"NM","B",34213,286)

"BLD",443,"KRN",.84,"NM","B",34214,287)

"BLD",443,"KRN",.84,"NM","B",34215,288)

"BLD",443,"KRN",.84,"NM","B",34216,289)

"BLD",443,"KRN",.84,"NM","B",34217,290)

"BLD",443,"KRN",.84,"NM","B",34220,291)

"BLD",443,"KRN",.84,"NM","B",34221,292)

"BLD",443,"KRN",.84,"NM","B",34222,293)

"BLD",443,"KRN",.84,"NM","B",34222.1,294)

"BLD",443,"KRN",.84,"NM","B",34222.3,295)

"BLD",443,"KRN",.84,"NM","B",34223,296)

"BLD",443,"KRN",.84,"NM","B",34230,297)

"BLD",443,"KRN",.84,"NM","B",34231,298)

"BLD",443,"KRN",.84,"NM","B",34232,299)

"BLD",443,"KRN",.84,"NM","B",34233,300)

"BLD",443,"KRN",.84,"NM","B",34234,301)

"BLD",443,"KRN",.84,"NM","B",34235,302)

"BLD",443,"KRN",.84,"NM","B",34236,303)

"BLD",443,"KRN",.84,"NM","B",34237,304)

"BLD",443,"KRN",.84,"NM","B",34238,305)

"BLD",443,"KRN",.84,"NM","B",34239,306)

"BLD",443,"KRN",.84,"NM","B",34240,307)

"BLD",443,"KRN",.84,"NM","B",34241,308)

"BLD",443,"KRN",.84,"NM","B",34242,309)

"BLD",443,"KRN",.84,"NM","B",34250,310)

"BLD",443,"KRN",.84,"NM","B",34251,311)

"BLD",443,"KRN",.84,"NM","B",34252,312)

"BLD",443,"KRN",.84,"NM","B",34253,313)

"BLD",443,"KRN",.84,"NM","B",34254,314)

"BLD",443,"KRN",.84,"NM","B",34255,315)

"BLD",443,"KRN",.84,"NM","B",34260,316)

"BLD",443,"KRN",.84,"NM","B",34261,317)

"BLD",443,"KRN",.84,"NM","B",34262,318)

"BLD",443,"KRN",.84,"NM","B",34263,319)

"BLD",443,"KRN",.84,"NM","B",34263.1,320)

"BLD",443,"KRN",.84,"NM","B",34264,321)

"BLD",443,"KRN",.84,"NM","B",34265,322)

"BLD",443,"KRN",.84,"NM","B",34265.1,323)

"BLD",443,"KRN",.84,"NM","B",34266,324)

"BLD",443,"KRN",.84,"NM","B",34267,325)

"BLD",443,"KRN",.84,"NM","B",34267.1,326)

"BLD",443,"KRN",.84,"NM","B",34267.2,327)

"BLD",443,"KRN",.84,"NM","B",34270,328)

"BLD",443,"KRN",.84,"NM","B",34271,329)

"BLD",443,"KRN",.84,"NM","B",34272,330)

"BLD",443,"KRN",.84,"NM","B",34273,331)

"BLD",443,"KRN",.84,"NM","B",34274,332)

"BLD",443,"KRN",.84,"NM","B",34301,333)

"BLD",443,"KRN",.84,"NM","B",34302,334)

"BLD",443,"KRN",.84,"NM","B",34302.1,335)

"BLD",443,"KRN",.84,"NM","B",34302.2,336)

"BLD",443,"KRN",.84,"NM","B",34303,337)

"BLD",443,"KRN",.84,"NM","B",34303.1,338)

"BLD",443,"KRN",.84,"NM","B",34305,339)

"BLD",443,"KRN",.84,"NM","B",34306,340)

"BLD",443,"KRN",.84,"NM","B",34306.1,341)

"BLD",443,"KRN",.84,"NM","B",34306.2,342)

"BLD",443,"KRN",.84,"NM","B",34306.3,343)

"BLD",443,"KRN",.84,"NM","B",34308,344)

"BLD",443,"KRN",.84,"NM","B",34309,345)

"BLD",443,"KRN",.84,"NM","B",34309.1,346)

"BLD",443,"KRN",.84,"NM","B",34309.2,347)

"BLD",443,"KRN",.84,"NM","B",34309.3,348)

"BLD",443,"KRN",.84,"NM","B",34311,349)

"BLD",443,"KRN",.84,"NM","B",34312,350)

"BLD",443,"KRN",.84,"NM","B",34312.1,351)

"BLD",443,"KRN",.84,"NM","B",34314,352)

"BLD",443,"KRN",.84,"NM","B",34315,353)

"BLD",443,"KRN",.84,"NM","B",34315.1,354)

"BLD",443,"KRN",.84,"NM","B",34317,355)

"BLD",443,"KRN",.84,"NM","B",34317.1,356)

"BLD",443,"KRN",.84,"NM","B",34318,357)

"BLD",443,"KRN",.84,"NM","B",34318.1,358)

"BLD",443,"KRN",.84,"NM","B",34318.2,359)

"BLD",443,"KRN",.84,"NM","B",34318.3,360)

"BLD",443,"KRN",.84,"NM","B",34318.4,361)

"BLD",443,"KRN",.84,"NM","B",34319,362)

"BLD",443,"KRN",.84,"NM","B",34320,363)

"BLD",443,"KRN",.84,"NM","B",34320.1,364)

"BLD",443,"KRN",.84,"NM","B",34321,365)

"BLD",443,"KRN",.84,"NM","B",34323,366)

"BLD",443,"KRN",.84,"NM","B",34324,367)

"BLD",443,"KRN",.84,"NM","B",34324.1,368)

"BLD",443,"KRN",.84,"NM","B",34324.2,369)

"BLD",443,"KRN",.84,"NM","B",34324.3,370)

"BLD",443,"KRN",.84,"NM","B",34325,371)

"BLD",443,"KRN",.84,"NM","B",34325.1,372)

"BLD",443,"KRN",.84,"NM","B",34325.9,373)

"BLD",443,"KRN",.84,"NM","B",34326,374)

"BLD",443,"KRN",.84,"NM","B",34326.1,375)

"BLD",443,"KRN",.84,"NM","B",34328,376)

"BLD",443,"KRN",.84,"NM","B",34329,377)

"BLD",443,"KRN",.84,"NM","B",34329.1,378)

"BLD",443,"KRN",.84,"NM","B",34330,379)

"BLD",443,"KRN",.84,"NM","B",34330.1,380)

"BLD",443,"KRN",.84,"NM","B",34331,381)

"BLD",443,"KRN",.84,"NM","B",34331.1,382)

"BLD",443,"KRN",.84,"NM","B",34332,1)

"BLD",443,"KRN",.84,"NM","B",34332.1,2)

"BLD",443,"KRN",.84,"NM","B",34332.2,3)

"BLD",443,"KRN",.84,"NM","B",34332.3,4)

"BLD",443,"KRN",.84,"NM","B",34333,383)

"BLD",443,"KRN",.84,"NM","B",34334,384)

"BLD",443,"KRN",.84,"NM","B",34334.1,385)

"BLD",443,"KRN",.84,"NM","B",34335,386)

"BLD",443,"KRN",.84,"NM","B",34335.1,387)

"BLD",443,"KRN",.84,"NM","B",34336,388)

"BLD",443,"KRN",.84,"NM","B",34336.1,389)

"BLD",443,"KRN",.84,"NM","B",34337,390)

"BLD",443,"KRN",.84,"NM","B",34337.1,391)

"BLD",443,"KRN",.84,"NM","B",34337.2,392)

"BLD",443,"KRN",.84,"NM","B",34337.3,393)

"BLD",443,"KRN",.84,"NM","B",34338,394)

"BLD",443,"KRN",.84,"NM","B",34338.1,395)

"BLD",443,"KRN",.84,"NM","B",34338.2,396)

"BLD",443,"KRN",.84,"NM","B",34338.3,397)

"BLD",443,"KRN",.84,"NM","B",34339,398)

"BLD",443,"KRN",.84,"NM","B",34350,399)

"BLD",443,"KRN",.84,"NM","B",34351,400)

"BLD",443,"KRN",.84,"NM","B",34352,401)

"BLD",443,"KRN",.84,"NM","B",34353,145)

"BLD",443,"KRN",.84,"NM","B",34354,402)

"BLD",443,"KRN",.84,"NM","B",34401,403)

"BLD",443,"KRN",.84,"NM","B",34402,404)

"BLD",443,"KRN",.84,"NM","B",34403,405)

"BLD",443,"KRN",.84,"NM","B",34403.5,406)

"BLD",443,"KRN",.84,"NM","B",34404,407)

"BLD",443,"KRN",.84,"NM","B",34405,408)

"BLD",443,"KRN",.84,"NM","B",34410,409)

"BLD",443,"KRN",.84,"NM","B",34411,410)

"BLD",443,"KRN",.84,"NM","B",34412,411)

"BLD",443,"KRN",.84,"NM","B",34413,412)

"BLD",443,"KRN",.84,"NM","B",34413.5,413)

"BLD",443,"KRN",.84,"NM","B",34413.6,414)

"BLD",443,"KRN",.84,"NM","B",34414,415)

"BLD",443,"KRN",.84,"NM","B",34415,416)

"BLD",443,"KRN",.84,"NM","B",34416,417)

"BLD",443,"KRN",.84,"NM","B",34417,418)

"BLD",443,"KRN",.84,"NM","B",34418,419)

"BLD",443,"KRN",.84,"NM","B",34418.5,420)

"BLD",443,"KRN",.84,"NM","B",34419,421)

"BLD",443,"KRN",.84,"NM","B",34420,422)

"BLD",443,"KRN",.84,"NM","B",34420.1,423)

"BLD",443,"KRN",.84,"NM","B",34420.2,424)

"BLD",443,"KRN",.84,"NM","B",34421,425)

"BLD",443,"KRN",.84,"NM","B",34421.1,426)

"BLD",443,"KRN",.84,"NM","B",34421.2,427)

"BLD",443,"KRN",.84,"NM","B",34422,428)

"BLD",443,"KRN",.84,"NM","B",34422.1,429)

"BLD",443,"KRN",.84,"NM","B",34423,430)

"BLD",443,"KRN",.84,"NM","B",34423.1,431)

"BLD",443,"KRN",.84,"NM","B",34424,432)

"BLD",443,"KRN",.84,"NM","B",34424.1,433)

"BLD",443,"KRN",.84,"NM","B",34425,1446)

"BLD",443,"KRN",.84,"NM","B",34426,435)

"BLD",443,"KRN",.84,"NM","B",34426.1,436)

"BLD",443,"KRN",.84,"NM","B",34427,437)

"BLD",443,"KRN",.84,"NM","B",34427.1,438)

"BLD",443,"KRN",.84,"NM","B",34428,439)

"BLD",443,"KRN",.84,"NM","B",34428.1,440)

"BLD",443,"KRN",.84,"NM","B",34429,441)

"BLD",443,"KRN",.84,"NM","B",34429.1,442)

"BLD",443,"KRN",.84,"NM","B",34430,443)

"BLD",443,"KRN",.84,"NM","B",34430.1,444)

"BLD",443,"KRN",.84,"NM","B",34431,445)

"BLD",443,"KRN",.84,"NM","B",34431.1,446)

"BLD",443,"KRN",.84,"NM","B",34435,447)

"BLD",443,"KRN",.84,"NM","B",34435.5,448)

"BLD",443,"KRN",.84,"NM","B",34436,449)

"BLD",443,"KRN",.84,"NM","B",34437,450)

"BLD",443,"KRN",.84,"NM","B",34437.1,451)

"BLD",443,"KRN",.84,"NM","B",34438,452)

"BLD",443,"KRN",.84,"NM","B",34438.1,453)

"BLD",443,"KRN",.84,"NM","B",34439,454)

"BLD",443,"KRN",.84,"NM","B",34440,455)

"BLD",443,"KRN",.84,"NM","B",34440.1,456)

"BLD",443,"KRN",.84,"NM","B",34440.2,457)

"BLD",443,"KRN",.84,"NM","B",34441,458)

"BLD",443,"KRN",.84,"NM","B",34441.1,459)

"BLD",443,"KRN",.84,"NM","B",34441.2,460)

"BLD",443,"KRN",.84,"NM","B",34441.3,461)

"BLD",443,"KRN",.84,"NM","B",34442,462)

"BLD",443,"KRN",.84,"NM","B",34443,1447)

"BLD",443,"KRN",.84,"NM","B",34443.1,1448)

"BLD",443,"KRN",.84,"NM","B",34444,465)

"BLD",443,"KRN",.84,"NM","B",34444.1,466)

"BLD",443,"KRN",.84,"NM","B",34444.5,1444)

"BLD",443,"KRN",.84,"NM","B",34445,467)

"BLD",443,"KRN",.84,"NM","B",34446.1,468)

"BLD",443,"KRN",.84,"NM","B",34446.2,469)

"BLD",443,"KRN",.84,"NM","B",34446.3,470)

"BLD",443,"KRN",.84,"NM","B",34446.4,471)

"BLD",443,"KRN",.84,"NM","B",34447,472)

"BLD",443,"KRN",.84,"NM","B",34447.1,473)

"BLD",443,"KRN",.84,"NM","B",34448,474)

"BLD",443,"KRN",.84,"NM","B",34448.1,475)

"BLD",443,"KRN",.84,"NM","B",34448.2,476)

"BLD",443,"KRN",.84,"NM","B",34448.3,477)

"BLD",443,"KRN",.84,"NM","B",34449,478)

"BLD",443,"KRN",.84,"NM","B",34449.1,479)

"BLD",443,"KRN",.84,"NM","B",34450,480)

"BLD",443,"KRN",.84,"NM","B",34450.1,481)

"BLD",443,"KRN",.84,"NM","B",34500,482)

"BLD",443,"KRN",.84,"NM","B",34501,483)

"BLD",443,"KRN",.84,"NM","B",34501.1,484)

"BLD",443,"KRN",.84,"NM","B",34502,485)

"BLD",443,"KRN",.84,"NM","B",34503,486)

"BLD",443,"KRN",.84,"NM","B",34504,487)

"BLD",443,"KRN",.84,"NM","B",34505,488)

"BLD",443,"KRN",.84,"NM","B",34506,489)

"BLD",443,"KRN",.84,"NM","B",34507,490)

"BLD",443,"KRN",.84,"NM","B",34508,491)

"BLD",443,"KRN",.84,"NM","B",34509,492)

"BLD",443,"KRN",.84,"NM","B",34510,493)

"BLD",443,"KRN",.84,"NM","B",34511,494)

"BLD",443,"KRN",.84,"NM","B",34512,495)

"BLD",443,"KRN",.84,"NM","B",34513,496)

"BLD",443,"KRN",.84,"NM","B",34514,497)

"BLD",443,"KRN",.84,"NM","B",34515,498)

"BLD",443,"KRN",.84,"NM","B",34516,499)

"BLD",443,"KRN",.84,"NM","B",34518,500)

"BLD",443,"KRN",.84,"NM","B",34519,501)

"BLD",443,"KRN",.84,"NM","B",34520,502)

"BLD",443,"KRN",.84,"NM","B",34521,503)

"BLD",443,"KRN",.84,"NM","B",34530,504)

"BLD",443,"KRN",.84,"NM","B",34531,505)

"BLD",443,"KRN",.84,"NM","B",34532,506)

"BLD",443,"KRN",.84,"NM","B",34533,507)

"BLD",443,"KRN",.84,"NM","B",34534,508)

"BLD",443,"KRN",.84,"NM","B",34534.1,509)

"BLD",443,"KRN",.84,"NM","B",34535,510)

"BLD",443,"KRN",.84,"NM","B",34536,511)

"BLD",443,"KRN",.84,"NM","B",34537,512)

"BLD",443,"KRN",.84,"NM","B",34538,513)

"BLD",443,"KRN",.84,"NM","B",34539,514)

"BLD",443,"KRN",.84,"NM","B",34540,515)

"BLD",443,"KRN",.84,"NM","B",34541,516)

"BLD",443,"KRN",.84,"NM","B",34542,517)

"BLD",443,"KRN",.84,"NM","B",34543,518)

"BLD",443,"KRN",.84,"NM","B",34544,519)

"BLD",443,"KRN",.84,"NM","B",34545,520)

"BLD",443,"KRN",.84,"NM","B",34546,521)

"BLD",443,"KRN",.84,"NM","B",34550,522)

"BLD",443,"KRN",.84,"NM","B",34551,523)

"BLD",443,"KRN",.84,"NM","B",34552,524)

"BLD",443,"KRN",.84,"NM","B",34554,525)

"BLD",443,"KRN",.84,"NM","B",34555,526)

"BLD",443,"KRN",.84,"NM","B",34556,527)

"BLD",443,"KRN",.84,"NM","B",34557,528)

"BLD",443,"KRN",.84,"NM","B",34557.1,529)

"BLD",443,"KRN",.84,"NM","B",34559,530)

"BLD",443,"KRN",.84,"NM","B",34560,531)

"BLD",443,"KRN",.84,"NM","B",34561,532)

"BLD",443,"KRN",.84,"NM","B",34562,533)

"BLD",443,"KRN",.84,"NM","B",34562.1,534)

"BLD",443,"KRN",.84,"NM","B",34564,535)

"BLD",443,"KRN",.84,"NM","B",34565,536)

"BLD",443,"KRN",.84,"NM","B",34566,537)

"BLD",443,"KRN",.84,"NM","B",34567,538)

"BLD",443,"KRN",.84,"NM","B",34568,539)

"BLD",443,"KRN",.84,"NM","B",34570,540)

"BLD",443,"KRN",.84,"NM","B",34571,541)

"BLD",443,"KRN",.84,"NM","B",34572,542)

"BLD",443,"KRN",.84,"NM","B",34573,543)

"BLD",443,"KRN",.84,"NM","B",34574,544)

"BLD",443,"KRN",.84,"NM","B",34575,545)

"BLD",443,"KRN",.84,"NM","B",34576,546)

"BLD",443,"KRN",.84,"NM","B",34577,547)

"BLD",443,"KRN",.84,"NM","B",34578,548)

"BLD",443,"KRN",.84,"NM","B",34580,549)

"BLD",443,"KRN",.84,"NM","B",34581,550)

"BLD",443,"KRN",.84,"NM","B",34582,551)

"BLD",443,"KRN",.84,"NM","B",34583,552)

"BLD",443,"KRN",.84,"NM","B",34584,553)

"BLD",443,"KRN",.84,"NM","B",34585,554)

"BLD",443,"KRN",.84,"NM","B",34586,555)

"BLD",443,"KRN",.84,"NM","B",34587,556)

"BLD",443,"KRN",.84,"NM","B",34588,557)

"BLD",443,"KRN",.84,"NM","B",34590,558)

"BLD",443,"KRN",.84,"NM","B",34591,559)

"BLD",443,"KRN",.84,"NM","B",34592,560)

"BLD",443,"KRN",.84,"NM","B",34593,561)

"BLD",443,"KRN",.84,"NM","B",34593.1,562)

"BLD",443,"KRN",.84,"NM","B",34593.2,563)

"BLD",443,"KRN",.84,"NM","B",34594,564)

"BLD",443,"KRN",.84,"NM","B",34594.1,565)

"BLD",443,"KRN",.84,"NM","B",34595,566)

"BLD",443,"KRN",.84,"NM","B",34595.1,567)

"BLD",443,"KRN",.84,"NM","B",34596,568)

"BLD",443,"KRN",.84,"NM","B",34597,569)

"BLD",443,"KRN",.84,"NM","B",34598,570)

"BLD",443,"KRN",.84,"NM","B",34600,571)

"BLD",443,"KRN",.84,"NM","B",34601,572)

"BLD",443,"KRN",.84,"NM","B",34602,573)

"BLD",443,"KRN",.84,"NM","B",34603,574)

"BLD",443,"KRN",.84,"NM","B",34604,575)

"BLD",443,"KRN",.84,"NM","B",34605,576)

"BLD",443,"KRN",.84,"NM","B",34606,577)

"BLD",443,"KRN",.84,"NM","B",34607,578)

"BLD",443,"KRN",.84,"NM","B",34608,579)

"BLD",443,"KRN",.84,"NM","B",34610,580)

"BLD",443,"KRN",.84,"NM","B",34611,581)

"BLD",443,"KRN",.84,"NM","B",34612,582)

"BLD",443,"KRN",.84,"NM","B",34615,583)

"BLD",443,"KRN",.84,"NM","B",34616,584)

"BLD",443,"KRN",.84,"NM","B",34617,585)

"BLD",443,"KRN",.84,"NM","B",34618,586)

"BLD",443,"KRN",.84,"NM","B",34619,587)

"BLD",443,"KRN",.84,"NM","B",34620,588)

"BLD",443,"KRN",.84,"NM","B",34620.1,589)

"BLD",443,"KRN",.84,"NM","B",34621,590)

"BLD",443,"KRN",.84,"NM","B",34622,591)

"BLD",443,"KRN",.84,"NM","B",34623,592)

"BLD",443,"KRN",.84,"NM","B",34624,593)

"BLD",443,"KRN",.84,"NM","B",34630,594)

"BLD",443,"KRN",.84,"NM","B",34631,595)

"BLD",443,"KRN",.84,"NM","B",34632,596)

"BLD",443,"KRN",.84,"NM","B",34633,597)

"BLD",443,"KRN",.84,"NM","B",34634,598)

"BLD",443,"KRN",.84,"NM","B",34635,599)

"BLD",443,"KRN",.84,"NM","B",34635.1,600)

"BLD",443,"KRN",.84,"NM","B",34636,601)

"BLD",443,"KRN",.84,"NM","B",34636.1,602)

"BLD",443,"KRN",.84,"NM","B",34637,603)

"BLD",443,"KRN",.84,"NM","B",34638,604)

"BLD",443,"KRN",.84,"NM","B",34639,605)

"BLD",443,"KRN",.84,"NM","B",34650,606)

"BLD",443,"KRN",.84,"NM","B",34651,607)

"BLD",443,"KRN",.84,"NM","B",34652,608)

"BLD",443,"KRN",.84,"NM","B",34653,609)

"BLD",443,"KRN",.84,"NM","B",34654,610)

"BLD",443,"KRN",.84,"NM","B",34655,611)

"BLD",443,"KRN",.84,"NM","B",34656,612)

"BLD",443,"KRN",.84,"NM","B",34656.1,613)

"BLD",443,"KRN",.84,"NM","B",34657,614)

"BLD",443,"KRN",.84,"NM","B",34660,615)

"BLD",443,"KRN",.84,"NM","B",34661,616)

"BLD",443,"KRN",.84,"NM","B",34662,617)

"BLD",443,"KRN",.84,"NM","B",34665,618)

"BLD",443,"KRN",.84,"NM","B",34666,619)

"BLD",443,"KRN",.84,"NM","B",34667,620)

"BLD",443,"KRN",.84,"NM","B",36080,621)

"BLD",443,"KRN",.84,"NM","B",36081,622)

"BLD",443,"KRN",.84,"NM","B",36082,623)

"BLD",443,"KRN",.84,"NM","B",36083,624)

"BLD",443,"KRN",.84,"NM","B",36084,625)

"BLD",443,"KRN",.84,"NM","B",36085,626)

"BLD",443,"KRN",.84,"NM","B",36086,627)

"BLD",443,"KRN",.84,"NM","B",36087,628)

"BLD",443,"KRN",.84,"NM","B",36088,629)

"BLD",443,"KRN",.84,"NM","B",36089,630)

"BLD",443,"KRN",.84,"NM","B",36090,631)

"BLD",443,"KRN",.84,"NM","B",36091,632)

"BLD",443,"KRN",.84,"NM","B",36092,633)

"BLD",443,"KRN",.84,"NM","B",36093,634)

"BLD",443,"KRN",.84,"NM","B",36094,635)

"BLD",443,"KRN",.84,"NM","B",36095,636)

"BLD",443,"KRN",.84,"NM","B",36096,637)

"BLD",443,"KRN",.84,"NM","B",36097,638)

"BLD",443,"KRN",.84,"NM","B",36098,639)

"BLD",443,"KRN",.84,"NM","B",36099,640)

"BLD",443,"KRN",.84,"NM","B",36101,641)

"BLD",443,"KRN",.84,"NM","B",36101.1,642)

"BLD",443,"KRN",.84,"NM","B",36102,643)

"BLD",443,"KRN",.84,"NM","B",36102.1,644)

"BLD",443,"KRN",.84,"NM","B",36103,645)

"BLD",443,"KRN",.84,"NM","B",36103.1,646)

"BLD",443,"KRN",.84,"NM","B",36104,647)

"BLD",443,"KRN",.84,"NM","B",36104.1,648)

"BLD",443,"KRN",.84,"NM","B",36111,649)

"BLD",443,"KRN",.84,"NM","B",36111.1,650)

"BLD",443,"KRN",.84,"NM","B",36112,651)

"BLD",443,"KRN",.84,"NM","B",36112.1,652)

"BLD",443,"KRN",.84,"NM","B",36113,653)

"BLD",443,"KRN",.84,"NM","B",36113.1,654)

"BLD",443,"KRN",.84,"NM","B",36121,655)

"BLD",443,"KRN",.84,"NM","B",36121.1,656)

"BLD",443,"KRN",.84,"NM","B",36122,657)

"BLD",443,"KRN",.84,"NM","B",36122.1,658)

"BLD",443,"KRN",.84,"NM","B",36123,659)

"BLD",443,"KRN",.84,"NM","B",36123.1,660)

"BLD",443,"KRN",.84,"NM","B",36124,661)

"BLD",443,"KRN",.84,"NM","B",36124.1,662)

"BLD",443,"KRN",.84,"NM","B",36125,663)

"BLD",443,"KRN",.84,"NM","B",36125.1,664)

"BLD",443,"KRN",.84,"NM","B",36126,665)

"BLD",443,"KRN",.84,"NM","B",36126.1,666)

"BLD",443,"KRN",.84,"NM","B",36127,667)

"BLD",443,"KRN",.84,"NM","B",36127.1,668)

"BLD",443,"KRN",.84,"NM","B",36131,669)

"BLD",443,"KRN",.84,"NM","B",36131.1,670)

"BLD",443,"KRN",.84,"NM","B",36132,671)

"BLD",443,"KRN",.84,"NM","B",36132.1,672)

"BLD",443,"KRN",.84,"NM","B",36133,673)

"BLD",443,"KRN",.84,"NM","B",36133.1,674)

"BLD",443,"KRN",.84,"NM","B",36134,675)

"BLD",443,"KRN",.84,"NM","B",36134.1,676)

"BLD",443,"KRN",.84,"NM","B",36141,677)

"BLD",443,"KRN",.84,"NM","B",36141.1,1439)

"BLD",443,"KRN",.84,"NM","B",36151,678)

"BLD",443,"KRN",.84,"NM","B",36151.1,679)

"BLD",443,"KRN",.84,"NM","B",36152,680)

"BLD",443,"KRN",.84,"NM","B",36152.1,681)

"BLD",443,"KRN",.84,"NM","B",36153,682)

"BLD",443,"KRN",.84,"NM","B",36153.1,683)

"BLD",443,"KRN",.84,"NM","B",36160,684)

"BLD",443,"KRN",.84,"NM","B",36160.1,685)

"BLD",443,"KRN",.84,"NM","B",36161,686)

"BLD",443,"KRN",.84,"NM","B",36161.1,687)

"BLD",443,"KRN",.84,"NM","B",36162,688)

"BLD",443,"KRN",.84,"NM","B",36162.1,689)

"BLD",443,"KRN",.84,"NM","B",36163,690)

"BLD",443,"KRN",.84,"NM","B",36163.1,691)

"BLD",443,"KRN",.84,"NM","B",36164,692)

"BLD",443,"KRN",.84,"NM","B",36164.1,693)

"BLD",443,"KRN",.84,"NM","B",36200,694)

"BLD",443,"KRN",.84,"NM","B",36201,695)

"BLD",443,"KRN",.84,"NM","B",36202,696)

"BLD",443,"KRN",.84,"NM","B",36203,697)

"BLD",443,"KRN",.84,"NM","B",36204,698)

"BLD",443,"KRN",.84,"NM","B",36205,699)

"BLD",443,"KRN",.84,"NM","B",36206,700)

"BLD",443,"KRN",.84,"NM","B",36207,701)

"BLD",443,"KRN",.84,"NM","B",36210,702)

"BLD",443,"KRN",.84,"NM","B",36211,703)

"BLD",443,"KRN",.84,"NM","B",36212,704)

"BLD",443,"KRN",.84,"NM","B",36213,705)

"BLD",443,"KRN",.84,"NM","B",36214,706)

"BLD",443,"KRN",.84,"NM","B",36215,707)

"BLD",443,"KRN",.84,"NM","B",36216,708)

"BLD",443,"KRN",.84,"NM","B",36217,709)

"BLD",443,"KRN",.84,"NM","B",36218,710)

"BLD",443,"KRN",.84,"NM","B",36219,711)

"BLD",443,"KRN",.84,"NM","B",36220,712)

"BLD",443,"KRN",.84,"NM","B",36221,713)

"BLD",443,"KRN",.84,"NM","B",36222,714)

"BLD",443,"KRN",.84,"NM","B",36223,715)

"BLD",443,"KRN",.84,"NM","B",36224,716)

"BLD",443,"KRN",.84,"NM","B",36224.1,717)

"BLD",443,"KRN",.84,"NM","B",36224.2,718)

"BLD",443,"KRN",.84,"NM","B",36225,719)

"BLD",443,"KRN",.84,"NM","B",36226,720)

"BLD",443,"KRN",.84,"NM","B",36227,721)

"BLD",443,"KRN",.84,"NM","B",36228,722)

"BLD",443,"KRN",.84,"NM","B",36229,723)

"BLD",443,"KRN",.84,"NM","B",36229.1,724)

"BLD",443,"KRN",.84,"NM","B",36229.2,725)

"BLD",443,"KRN",.84,"NM","B",36230,726)

"BLD",443,"KRN",.84,"NM","B",36231,727)

"BLD",443,"KRN",.84,"NM","B",36232,728)

"BLD",443,"KRN",.84,"NM","B",36240,729)

"BLD",443,"KRN",.84,"NM","B",36241,730)

"BLD",443,"KRN",.84,"NM","B",36242,731)

"BLD",443,"KRN",.84,"NM","B",36300,732)

"BLD",443,"KRN",.84,"NM","B",36301,733)

"BLD",443,"KRN",.84,"NM","B",36302,734)

"BLD",443,"KRN",.84,"NM","B",36303,735)

"BLD",443,"KRN",.84,"NM","B",36304,736)

"BLD",443,"KRN",.84,"NM","B",36305,737)

"BLD",443,"KRN",.84,"NM","B",36306,738)

"BLD",443,"KRN",.84,"NM","B",36309,739)

"BLD",443,"KRN",.84,"NM","B",36309.5,740)

"BLD",443,"KRN",.84,"NM","B",36310,741)

"BLD",443,"KRN",.84,"NM","B",36311,742)

"BLD",443,"KRN",.84,"NM","B",36312,743)

"BLD",443,"KRN",.84,"NM","B",36313,744)

"BLD",443,"KRN",.84,"NM","B",36314,745)

"BLD",443,"KRN",.84,"NM","B",36315,746)

"BLD",443,"KRN",.84,"NM","B",36316,747)

"BLD",443,"KRN",.84,"NM","B",36317,748)

"BLD",443,"KRN",.84,"NM","B",36318,749)

"BLD",443,"KRN",.84,"NM","B",36319,750)

"BLD",443,"KRN",.84,"NM","B",36321,751)

"BLD",443,"KRN",.84,"NM","B",36322,752)

"BLD",443,"KRN",.84,"NM","B",36323,753)

"BLD",443,"KRN",.84,"NM","B",36324,754)

"BLD",443,"KRN",.84,"NM","B",36325,755)

"BLD",443,"KRN",.84,"NM","B",36326,756)

"BLD",443,"KRN",.84,"NM","B",36327,757)

"BLD",443,"KRN",.84,"NM","B",36330,758)

"BLD",443,"KRN",.84,"NM","B",36332,759)

"BLD",443,"KRN",.84,"NM","B",36334,760)

"BLD",443,"KRN",.84,"NM","B",36335,761)

"BLD",443,"KRN",.84,"NM","B",36336,762)

"BLD",443,"KRN",.84,"NM","B",36337,763)

"BLD",443,"KRN",.84,"NM","B",36338,764)

"BLD",443,"KRN",.84,"NM","B",36339,765)

"BLD",443,"KRN",.84,"NM","B",36340,766)

"BLD",443,"KRN",.84,"NM","B",36341,767)

"BLD",443,"KRN",.84,"NM","B",36342,768)

"BLD",443,"KRN",.84,"NM","B",36343,769)

"BLD",443,"KRN",.84,"NM","B",36344,770)

"BLD",443,"KRN",.84,"NM","B",36345,771)

"BLD",443,"KRN",.84,"NM","B",36346,772)

"BLD",443,"KRN",.84,"NM","B",36347,773)

"BLD",443,"KRN",.84,"NM","B",36351,774)

"BLD",443,"KRN",.84,"NM","B",36352,775)

"BLD",443,"KRN",.84,"NM","B",36353,776)

"BLD",443,"KRN",.84,"NM","B",36357,777)

"BLD",443,"KRN",.84,"NM","B",36358,778)

"BLD",443,"KRN",.84,"NM","B",36359,779)

"BLD",443,"KRN",.84,"NM","B",36360,780)

"BLD",443,"KRN",.84,"NM","B",36361,781)

"BLD",443,"KRN",.84,"NM","B",36362,782)

"BLD",443,"KRN",.84,"NM","B",36364,783)

"BLD",443,"KRN",.84,"NM","B",36366,784)

"BLD",443,"KRN",.84,"NM","B",36367,785)

"BLD",443,"KRN",.84,"NM","B",36368,786)

"BLD",443,"KRN",.84,"NM","B",36369,787)

"BLD",443,"KRN",.84,"NM","B",36400,788)

"BLD",443,"KRN",.84,"NM","B",36401,789)

"BLD",443,"KRN",.84,"NM","B",36402,790)

"BLD",443,"KRN",.84,"NM","B",36402.1,791)

"BLD",443,"KRN",.84,"NM","B",36403,792)

"BLD",443,"KRN",.84,"NM","B",36404,793)

"BLD",443,"KRN",.84,"NM","B",36405,794)

"BLD",443,"KRN",.84,"NM","B",36406,795)

"BLD",443,"KRN",.84,"NM","B",36407,796)

"BLD",443,"KRN",.84,"NM","B",36408,797)

"BLD",443,"KRN",.84,"NM","B",36409,798)

"BLD",443,"KRN",.84,"NM","B",36410,799)

"BLD",443,"KRN",.84,"NM","B",36411,800)

"BLD",443,"KRN",.84,"NM","B",36412,801)

"BLD",443,"KRN",.84,"NM","B",36412.1,802)

"BLD",443,"KRN",.84,"NM","B",36413,803)

"BLD",443,"KRN",.84,"NM","B",36414,804)

"BLD",443,"KRN",.84,"NM","B",36415,805)

"BLD",443,"KRN",.84,"NM","B",36416,806)

"BLD",443,"KRN",.84,"NM","B",36417,807)

"BLD",443,"KRN",.84,"NM","B",36418,808)

"BLD",443,"KRN",.84,"NM","B",36419,809)

"BLD",443,"KRN",.84,"NM","B",36420,810)

"BLD",443,"KRN",.84,"NM","B",36421,811)

"BLD",443,"KRN",.84,"NM","B",36422,812)

"BLD",443,"KRN",.84,"NM","B",36423,813)

"BLD",443,"KRN",.84,"NM","B",36425,814)

"BLD",443,"KRN",.84,"NM","B",36426,815)

"BLD",443,"KRN",.84,"NM","B",36427,816)

"BLD",443,"KRN",.84,"NM","B",36428,817)

"BLD",443,"KRN",.84,"NM","B",36429,818)

"BLD",443,"KRN",.84,"NM","B",36430,819)

"BLD",443,"KRN",.84,"NM","B",36431,820)

"BLD",443,"KRN",.84,"NM","B",36432,821)

"BLD",443,"KRN",.84,"NM","B",36433,822)

"BLD",443,"KRN",.84,"NM","B",36434,823)

"BLD",443,"KRN",.84,"NM","B",36435,824)

"BLD",443,"KRN",.84,"NM","B",36436,825)

"BLD",443,"KRN",.84,"NM","B",36437,826)

"BLD",443,"KRN",.84,"NM","B",36438,827)

"BLD",443,"KRN",.84,"NM","B",36439.1,828)

"BLD",443,"KRN",.84,"NM","B",36439.2,829)

"BLD",443,"KRN",.84,"NM","B",36439.3,830)

"BLD",443,"KRN",.84,"NM","B",36440,831)

"BLD",443,"KRN",.84,"NM","B",36441,832)

"BLD",443,"KRN",.84,"NM","B",36443,833)

"BLD",443,"KRN",.84,"NM","B",36501,834)

"BLD",443,"KRN",.84,"NM","B",36501.1,835)

"BLD",443,"KRN",.84,"NM","B",36502,836)

"BLD",443,"KRN",.84,"NM","B",36502.1,837)

"BLD",443,"KRN",.84,"NM","B",36503,838)

"BLD",443,"KRN",.84,"NM","B",36503.1,839)

"BLD",443,"KRN",.84,"NM","B",36504,840)

"BLD",443,"KRN",.84,"NM","B",36504.1,841)

"BLD",443,"KRN",.84,"NM","B",36505,842)

"BLD",443,"KRN",.84,"NM","B",36505.1,843)

"BLD",443,"KRN",.84,"NM","B",36506,844)

"BLD",443,"KRN",.84,"NM","B",36506.1,845)

"BLD",443,"KRN",.84,"NM","B",36507,846)

"BLD",443,"KRN",.84,"NM","B",36507.1,847)

"BLD",443,"KRN",.84,"NM","B",36508,848)

"BLD",443,"KRN",.84,"NM","B",36508.1,849)

"BLD",443,"KRN",.84,"NM","B",36509,850)

"BLD",443,"KRN",.84,"NM","B",36509.1,851)

"BLD",443,"KRN",.84,"NM","B",36510,852)

"BLD",443,"KRN",.84,"NM","B",36510.1,853)

"BLD",443,"KRN",.84,"NM","B",36511,854)

"BLD",443,"KRN",.84,"NM","B",36511.1,855)

"BLD",443,"KRN",.84,"NM","B",36512,1436)

"BLD",443,"KRN",.84,"NM","B",36512.1,857)

"BLD",443,"KRN",.84,"NM","B",36513,858)

"BLD",443,"KRN",.84,"NM","B",36513.1,859)

"BLD",443,"KRN",.84,"NM","B",36516,860)

"BLD",443,"KRN",.84,"NM","B",36516.1,861)

"BLD",443,"KRN",.84,"NM","B",36517,862)

"BLD",443,"KRN",.84,"NM","B",36517.1,863)

"BLD",443,"KRN",.84,"NM","B",36518,864)

"BLD",443,"KRN",.84,"NM","B",36518.1,865)

"BLD",443,"KRN",.84,"NM","B",36521,866)

"BLD",443,"KRN",.84,"NM","B",36521.1,867)

"BLD",443,"KRN",.84,"NM","B",36522,868)

"BLD",443,"KRN",.84,"NM","B",36522.1,869)

"BLD",443,"KRN",.84,"NM","B",36523,870)

"BLD",443,"KRN",.84,"NM","B",36523.1,871)

"BLD",443,"KRN",.84,"NM","B",36531,872)

"BLD",443,"KRN",.84,"NM","B",36531.1,873)

"BLD",443,"KRN",.84,"NM","B",36532,874)

"BLD",443,"KRN",.84,"NM","B",36532.1,875)

"BLD",443,"KRN",.84,"NM","B",36533,876)

"BLD",443,"KRN",.84,"NM","B",36533.1,877)

"BLD",443,"KRN",.84,"NM","B",36600,878)

"BLD",443,"KRN",.84,"NM","B",36601,879)

"BLD",443,"KRN",.84,"NM","B",36602,880)

"BLD",443,"KRN",.84,"NM","B",36603,881)

"BLD",443,"KRN",.84,"NM","B",36604,882)

"BLD",443,"KRN",.84,"NM","B",36610,883)

"BLD",443,"KRN",.84,"NM","B",36611,884)

"BLD",443,"KRN",.84,"NM","B",36612,885)

"BLD",443,"KRN",.84,"NM","B",36613,886)

"BLD",443,"KRN",.84,"NM","B",36614,1445)

"BLD",443,"KRN",.84,"NM","B",37000,888)

"BLD",443,"KRN",.84,"NM","B",37001,889)

"BLD",443,"KRN",.84,"NM","B",37002,890)

"BLD",443,"KRN",.84,"NM","B",37003,891)

"BLD",443,"KRN",.84,"NM","B",37004,892)

"BLD",443,"KRN",.84,"NM","B",37005,893)

"BLD",443,"KRN",.84,"NM","B",37006,894)

"BLD",443,"KRN",.84,"NM","B",37007,895)

"BLD",443,"KRN",.84,"NM","B",37008,896)

"BLD",443,"KRN",.84,"NM","B",37100,897)

"BLD",443,"KRN",.84,"NM","B",37101,898)

"BLD",443,"KRN",.84,"NM","B",37102,899)

"BLD",443,"KRN",.84,"NM","B",37103,1437)

"BLD",443,"KRN",.84,"NM","B",37104,1438)

"BLD",443,"KRN",.84,"NM","B",37201,900)

"BLD",443,"KRN",.84,"NM","B",37201.1,901)

"BLD",443,"KRN",.84,"NM","B",37201.2,902)

"BLD",443,"KRN",.84,"NM","B",37201.3,903)

"BLD",443,"KRN",.84,"NM","B",37202,904)

"BLD",443,"KRN",.84,"NM","B",37203,905)

"BLD",443,"KRN",.84,"NM","B",37204,906)

"BLD",443,"KRN",.84,"NM","B",37204.1,907)

"BLD",443,"KRN",.84,"NM","B",37204.2,908)

"BLD",443,"KRN",.84,"NM","B",37205,909)

"BLD",443,"KRN",.84,"NM","B",37206,910)

"BLD",443,"KRN",.84,"NM","B",37207,911)

"BLD",443,"KRN",.84,"NM","B",37208,912)

"BLD",443,"KRN",.84,"NM","B",37209,913)

"BLD",443,"KRN",.84,"NM","B",37211,914)

"BLD",443,"KRN",.84,"NM","B",37212,915)

"BLD",443,"KRN",.84,"NM","B",37212.8,916)

"BLD",443,"KRN",.84,"NM","B",37212.9,917)

"BLD",443,"KRN",.84,"NM","B",37213,918)

"BLD",443,"KRN",.84,"NM","B",37214,919)

"BLD",443,"KRN",.84,"NM","B",37215.1,920)

"BLD",443,"KRN",.84,"NM","B",37215.2,921)

"BLD",443,"KRN",.84,"NM","B",37215.3,922)

"BLD",443,"KRN",.84,"NM","B",37215.4,923)

"BLD",443,"KRN",.84,"NM","B",37216,924)

"BLD",443,"KRN",.84,"NM","B",37219,925)

"BLD",443,"KRN",.84,"NM","B",37219.5,926)

"BLD",443,"KRN",.84,"NM","B",37221,927)

"BLD",443,"KRN",.84,"NM","B",37222,928)

"BLD",443,"KRN",.84,"NM","B",37223,929)

"BLD",443,"KRN",.84,"NM","B",37231,930)

"BLD",443,"KRN",.84,"NM","B",37232,931)

"BLD",443,"KRN",.84,"NM","B",37241,932)

"BLD",443,"KRN",.84,"NM","B",37251,933)

"BLD",443,"KRN",.84,"NM","B",37261,934)

"BLD",443,"KRN",.84,"NM","B",37301,935)

"BLD",443,"KRN",.84,"NM","B",37301.6,936)

"BLD",443,"KRN",.84,"NM","B",37301.9,937)

"BLD",443,"KRN",.84,"NM","B",37302,938)

"BLD",443,"KRN",.84,"NM","B",37302.9,939)

"BLD",443,"KRN",.84,"NM","B",37303,940)

"BLD",443,"KRN",.84,"NM","B",37303.1,941)

"BLD",443,"KRN",.84,"NM","B",37303.2,942)

"BLD",443,"KRN",.84,"NM","B",37303.9,943)

"BLD",443,"KRN",.84,"NM","B",37304,944)

"BLD",443,"KRN",.84,"NM","B",37304.9,945)

"BLD",443,"KRN",.84,"NM","B",37305,946)

"BLD",443,"KRN",.84,"NM","B",37306,947)

"BLD",443,"KRN",.84,"NM","B",37306.1,948)

"BLD",443,"KRN",.84,"NM","B",37306.2,949)

"BLD",443,"KRN",.84,"NM","B",37307,950)

"BLD",443,"KRN",.84,"NM","B",37307.9,951)

"BLD",443,"KRN",.84,"NM","B",37308,952)

"BLD",443,"KRN",.84,"NM","B",37308.9,953)

"BLD",443,"KRN",.84,"NM","B",37309,954)

"BLD",443,"KRN",.84,"NM","B",37309.1,955)

"BLD",443,"KRN",.84,"NM","B",37309.2,956)

"BLD",443,"KRN",.84,"NM","B",37309.3,957)

"BLD",443,"KRN",.84,"NM","B",37309.4,958)

"BLD",443,"KRN",.84,"NM","B",37309.5,959)

"BLD",443,"KRN",.84,"NM","B",37309.9,960)

"BLD",443,"KRN",.84,"NM","B",37311,961)

"BLD",443,"KRN",.84,"NM","B",37311.9,962)

"BLD",443,"KRN",.84,"NM","B",37312,963)

"BLD",443,"KRN",.84,"NM","B",37312.9,964)

"BLD",443,"KRN",.84,"NM","B",37313,965)

"BLD",443,"KRN",.84,"NM","B",37313.9,966)

"BLD",443,"KRN",.84,"NM","B",37314,967)

"BLD",443,"KRN",.84,"NM","B",37314.9,968)

"BLD",443,"KRN",.84,"NM","B",37315,969)

"BLD",443,"KRN",.84,"NM","B",37315.4,970)

"BLD",443,"KRN",.84,"NM","B",37315.8,971)

"BLD",443,"KRN",.84,"NM","B",37315.9,972)

"BLD",443,"KRN",.84,"NM","B",37316,973)

"BLD",443,"KRN",.84,"NM","B",37316.8,974)

"BLD",443,"KRN",.84,"NM","B",37316.9,975)

"BLD",443,"KRN",.84,"NM","B",37317,976)

"BLD",443,"KRN",.84,"NM","B",37317.1,977)

"BLD",443,"KRN",.84,"NM","B",37317.2,978)

"BLD",443,"KRN",.84,"NM","B",37317.9,979)

"BLD",443,"KRN",.84,"NM","B",37318,980)

"BLD",443,"KRN",.84,"NM","B",37318.9,981)

"BLD",443,"KRN",.84,"NM","B",37319,982)

"BLD",443,"KRN",.84,"NM","B",37319.9,983)

"BLD",443,"KRN",.84,"NM","B",37320,984)

"BLD",443,"KRN",.84,"NM","B",37320.6,985)

"BLD",443,"KRN",.84,"NM","B",37320.9,986)

"BLD",443,"KRN",.84,"NM","B",37331,987)

"BLD",443,"KRN",.84,"NM","B",37332,988)

"BLD",443,"KRN",.84,"NM","B",37333,989)

"BLD",443,"KRN",.84,"NM","B",37333.1,990)

"BLD",443,"KRN",.84,"NM","B",37333.2,991)

"BLD",443,"KRN",.84,"NM","B",37333.3,992)

"BLD",443,"KRN",.84,"NM","B",37333.8,993)

"BLD",443,"KRN",.84,"NM","B",37333.9,994)

"BLD",443,"KRN",.84,"NM","B",37334,995)

"BLD",443,"KRN",.84,"NM","B",37341,996)

"BLD",443,"KRN",.84,"NM","B",37342,997)

"BLD",443,"KRN",.84,"NM","B",37350,998)

"BLD",443,"KRN",.84,"NM","B",37351,999)

"BLD",443,"KRN",.84,"NM","B",37401,1000)

"BLD",443,"KRN",.84,"NM","B",37401.1,1001)

"BLD",443,"KRN",.84,"NM","B",37401.2,1002)

"BLD",443,"KRN",.84,"NM","B",37401.3,1003)

"BLD",443,"KRN",.84,"NM","B",37401.4,1004)

"BLD",443,"KRN",.84,"NM","B",37401.5,1005)

"BLD",443,"KRN",.84,"NM","B",37402,1006)

"BLD",443,"KRN",.84,"NM","B",37402.1,1007)

"BLD",443,"KRN",.84,"NM","B",37403,1008)

"BLD",443,"KRN",.84,"NM","B",37403.1,1009)

"BLD",443,"KRN",.84,"NM","B",37403.2,1010)

"BLD",443,"KRN",.84,"NM","B",37403.4,1011)

"BLD",443,"KRN",.84,"NM","B",37403.5,1012)

"BLD",443,"KRN",.84,"NM","B",37403.6,1013)

"BLD",443,"KRN",.84,"NM","B",37404,1014)

"BLD",443,"KRN",.84,"NM","B",37404.1,1015)

"BLD",443,"KRN",.84,"NM","B",37404.5,1016)

"BLD",443,"KRN",.84,"NM","B",37405,1017)

"BLD",443,"KRN",.84,"NM","B",37405.1,1018)

"BLD",443,"KRN",.84,"NM","B",37405.2,1019)

"BLD",443,"KRN",.84,"NM","B",37405.3,1020)

"BLD",443,"KRN",.84,"NM","B",37405.4,1021)

"BLD",443,"KRN",.84,"NM","B",37405.5,1022)

"BLD",443,"KRN",.84,"NM","B",37406,1023)

"BLD",443,"KRN",.84,"NM","B",37406.1,1024)

"BLD",443,"KRN",.84,"NM","B",37406.6,1025)

"BLD",443,"KRN",.84,"NM","B",37407,1026)

"BLD",443,"KRN",.84,"NM","B",37408,1027)

"BLD",443,"KRN",.84,"NM","B",37408.9,1028)

"BLD",443,"KRN",.84,"NM","B",37409,1029)

"BLD",443,"KRN",.84,"NM","B",37409.1,1030)

"BLD",443,"KRN",.84,"NM","B",37409.5,1031)

"BLD",443,"KRN",.84,"NM","B",37409.9,1032)

"BLD",443,"KRN",.84,"NM","B",37411,1033)

"BLD",443,"KRN",.84,"NM","B",37411.9,1034)

"BLD",443,"KRN",.84,"NM","B",37412,1035)

"BLD",443,"KRN",.84,"NM","B",37412.1,1036)

"BLD",443,"KRN",.84,"NM","B",37412.9,1037)

"BLD",443,"KRN",.84,"NM","B",37413,1038)

"BLD",443,"KRN",.84,"NM","B",37414,1039)

"BLD",443,"KRN",.84,"NM","B",37414.9,1040)

"BLD",443,"KRN",.84,"NM","B",37415,1041)

"BLD",443,"KRN",.84,"NM","B",37415.9,1042)

"BLD",443,"KRN",.84,"NM","B",37416,1043)

"BLD",443,"KRN",.84,"NM","B",37416.4,1044)

"BLD",443,"KRN",.84,"NM","B",37417,1045)

"BLD",443,"KRN",.84,"NM","B",37418,1046)

"BLD",443,"KRN",.84,"NM","B",37419,1047)

"BLD",443,"KRN",.84,"NM","B",37420,1048)

"BLD",443,"KRN",.84,"NM","B",37420.1,1049)

"BLD",443,"KRN",.84,"NM","B",37422,1050)

"BLD",443,"KRN",.84,"NM","B",37422.1,1051)

"BLD",443,"KRN",.84,"NM","B",37422.2,1052)

"BLD",443,"KRN",.84,"NM","B",37422.3,1053)

"BLD",443,"KRN",.84,"NM","B",37422.4,1054)

"BLD",443,"KRN",.84,"NM","B",37422.5,1055)

"BLD",443,"KRN",.84,"NM","B",37422.6,1056)

"BLD",443,"KRN",.84,"NM","B",37423,1057)

"BLD",443,"KRN",.84,"NM","B",37424,1058)

"BLD",443,"KRN",.84,"NM","B",37425,1059)

"BLD",443,"KRN",.84,"NM","B",37425.1,1060)

"BLD",443,"KRN",.84,"NM","B",37426,1061)

"BLD",443,"KRN",.84,"NM","B",37427,1062)

"BLD",443,"KRN",.84,"NM","B",37428,1063)

"BLD",443,"KRN",.84,"NM","B",37428.1,1064)

"BLD",443,"KRN",.84,"NM","B",37428.2,1065)

"BLD",443,"KRN",.84,"NM","B",37429,1066)

"BLD",443,"KRN",.84,"NM","B",37430,1067)

"BLD",443,"KRN",.84,"NM","B",37431,1068)

"BLD",443,"KRN",.84,"NM","B",37431.9,1069)

"BLD",443,"KRN",.84,"NM","B",37432,1070)

"BLD",443,"KRN",.84,"NM","B",37432.9,1071)

"BLD",443,"KRN",.84,"NM","B",37433,1072)

"BLD",443,"KRN",.84,"NM","B",37433.9,1073)

"BLD",443,"KRN",.84,"NM","B",37441,1074)

"BLD",443,"KRN",.84,"NM","B",37442,1075)

"BLD",443,"KRN",.84,"NM","B",37443,1076)

"BLD",443,"KRN",.84,"NM","B",37444,1077)

"BLD",443,"KRN",.84,"NM","B",37444.5,1078)

"BLD",443,"KRN",.84,"NM","B",37445,1079)

"BLD",443,"KRN",.84,"NM","B",37445.4,1080)

"BLD",443,"KRN",.84,"NM","B",37446,1081)

"BLD",443,"KRN",.84,"NM","B",37446.9,1082)

"BLD",443,"KRN",.84,"NM","B",37447,7)

"BLD",443,"KRN",.84,"NM","B",37451,1083)

"BLD",443,"KRN",.84,"NM","B",37452,1084)

"BLD",443,"KRN",.84,"NM","B",37453,1085)

"BLD",443,"KRN",.84,"NM","B",37455,1086)

"BLD",443,"KRN",.84,"NM","B",37456,1087)

"BLD",443,"KRN",.84,"NM","B",37457,1088)

"BLD",443,"KRN",.84,"NM","B",37458,1089)

"BLD",443,"KRN",.84,"NM","B",37461,1090)

"BLD",443,"KRN",.84,"NM","B",37462,1091)

"BLD",443,"KRN",.84,"NM","B",37470,1092)

"BLD",443,"KRN",.84,"NM","B",37471,1093)

"BLD",443,"KRN",.84,"NM","B",37472,1094)

"BLD",443,"KRN",.84,"NM","B",38001,1095)

"BLD",443,"KRN",.84,"NM","B",38002,1096)

"BLD",443,"KRN",.84,"NM","B",38003,1097)

"BLD",443,"KRN",.84,"NM","B",38004,1098)

"BLD",443,"KRN",.84,"NM","B",38005,1099)

"BLD",443,"KRN",.84,"NM","B",38006,1100)

"BLD",443,"KRN",.84,"NM","B",38007,1101)

"BLD",443,"KRN",.84,"NM","B",38008,1102)

"BLD",443,"KRN",.84,"NM","B",38009,1103)

"BLD",443,"KRN",.84,"NM","B",38010,1104)

"BLD",443,"KRN",.84,"NM","B",38011,1105)

"BLD",443,"KRN",.84,"NM","B",38012,1106)

"BLD",443,"KRN",.84,"NM","B",38013,1107)

"BLD",443,"KRN",.84,"NM","B",38014,1108)

"BLD",443,"KRN",.84,"NM","B",38015,1109)

"BLD",443,"KRN",.84,"NM","B",38016,1110)

"BLD",443,"KRN",.84,"NM","B",38017,1111)

"BLD",443,"KRN",.84,"NM","B",38018,1112)

"BLD",443,"KRN",.84,"NM","B",38019,1113)

"BLD",443,"KRN",.84,"NM","B",38020,1114)

"BLD",443,"KRN",.84,"NM","B",38021,1115)

"BLD",443,"KRN",.84,"NM","B",38022,1116)

"BLD",443,"KRN",.84,"NM","B",38022.1,1117)

"BLD",443,"KRN",.84,"NM","B",38023,1118)

"BLD",443,"KRN",.84,"NM","B",38023.1,1119)

"BLD",443,"KRN",.84,"NM","B",38023.5,1120)

"BLD",443,"KRN",.84,"NM","B",38023.8,1121)

"BLD",443,"KRN",.84,"NM","B",38023.9,1122)

"BLD",443,"KRN",.84,"NM","B",38024,1123)

"BLD",443,"KRN",.84,"NM","B",38024.1,1124)

"BLD",443,"KRN",.84,"NM","B",38025,1125)

"BLD",443,"KRN",.84,"NM","B",38026,1126)

"BLD",443,"KRN",.84,"NM","B",38027,1127)

"BLD",443,"KRN",.84,"NM","B",38028,1128)

"BLD",443,"KRN",.84,"NM","B",38029,1129)

"BLD",443,"KRN",.84,"NM","B",38030,1130)

"BLD",443,"KRN",.84,"NM","B",38031,1131)

"BLD",443,"KRN",.84,"NM","B",38040,1132)

"BLD",443,"KRN",.84,"NM","B",38041,1133)

"BLD",443,"KRN",.84,"NM","B",38042,1134)

"BLD",443,"KRN",.84,"NM","B",38043,1135)

"BLD",443,"KRN",.84,"NM","B",38044,1136)

"BLD",443,"KRN",.84,"NM","B",38045,1137)

"BLD",443,"KRN",.84,"NM","B",38046,1138)

"BLD",443,"KRN",.84,"NM","B",38047,1139)

"BLD",443,"KRN",.84,"NM","B",38048,1140)

"BLD",443,"KRN",.84,"NM","B",38049,1141)

"BLD",443,"KRN",.84,"NM","B",38050,1142)

"BLD",443,"KRN",.84,"NM","B",38051,1143)

"BLD",443,"KRN",.84,"NM","B",38052,1144)

"BLD",443,"KRN",.84,"NM","B",38053,1145)

"BLD",443,"KRN",.84,"NM","B",38054,1146)

"BLD",443,"KRN",.84,"NM","B",38055,1147)

"BLD",443,"KRN",.84,"NM","B",38056,1148)

"BLD",443,"KRN",.84,"NM","B",38100,1149)

"BLD",443,"KRN",.84,"NM","B",38105,1150)

"BLD",443,"KRN",.84,"NM","B",38106,1151)

"BLD",443,"KRN",.84,"NM","B",38107,1152)

"BLD",443,"KRN",.84,"NM","B",38109,1153)

"BLD",443,"KRN",.84,"NM","B",38110,1154)

"BLD",443,"KRN",.84,"NM","B",38110.1,1155)

"BLD",443,"KRN",.84,"NM","B",38110.2,1156)

"BLD",443,"KRN",.84,"NM","B",38110.3,1157)

"BLD",443,"KRN",.84,"NM","B",38111,1158)

"BLD",443,"KRN",.84,"NM","B",38112,1159)

"BLD",443,"KRN",.84,"NM","B",38113,1160)

"BLD",443,"KRN",.84,"NM","B",38113.1,1161)

"BLD",443,"KRN",.84,"NM","B",38114,1162)

"BLD",443,"KRN",.84,"NM","B",38114.1,1163)

"BLD",443,"KRN",.84,"NM","B",38130,1164)

"BLD",443,"KRN",.84,"NM","B",38131,1165)

"BLD",443,"KRN",.84,"NM","B",38132,1166)

"BLD",443,"KRN",.84,"NM","B",38133,1167)

"BLD",443,"KRN",.84,"NM","B",38140,1168)

"BLD",443,"KRN",.84,"NM","B",38141,1169)

"BLD",443,"KRN",.84,"NM","B",38150,1170)

"BLD",443,"KRN",.84,"NM","B",38151,1171)

"BLD",443,"KRN",.84,"NM","B",38152,1172)

"BLD",443,"KRN",.84,"NM","B",38153,1173)

"BLD",443,"KRN",.84,"NM","B",38154,1174)

"BLD",443,"KRN",.84,"NM","B",38155,1175)

"BLD",443,"KRN",.84,"NM","B",38155.1,1176)

"BLD",443,"KRN",.84,"NM","B",38155.2,1177)

"BLD",443,"KRN",.84,"NM","B",38156,1178)

"BLD",443,"KRN",.84,"NM","B",38156.1,1179)

"BLD",443,"KRN",.84,"NM","B",38156.2,1180)

"BLD",443,"KRN",.84,"NM","B",38157,1181)

"BLD",443,"KRN",.84,"NM","B",38158,1182)

"BLD",443,"KRN",.84,"NM","B",38159,1183)

"BLD",443,"KRN",.84,"NM","B",38159.1,132)

"BLD",443,"KRN",.84,"NM","B",38160,1184)

"BLD",443,"KRN",.84,"NM","B",38161,1185)

"BLD",443,"KRN",.84,"NM","B",38162,1186)

"BLD",443,"KRN",.84,"NM","B",38165,1187)

"BLD",443,"KRN",.84,"NM","B",38165.1,1188)

"BLD",443,"KRN",.84,"NM","B",38170,1189)

"BLD",443,"KRN",.84,"NM","B",38171,1190)

"BLD",443,"KRN",.84,"NM","B",38172,1191)

"BLD",443,"KRN",.84,"NM","B",38173,1192)

"BLD",443,"KRN",.84,"NM","B",38174,1193)

"BLD",443,"KRN",.84,"NM","B",38175,1194)

"BLD",443,"KRN",.84,"NM","B",38176,1195)

"BLD",443,"KRN",.84,"NM","B",38177,1196)

"BLD",443,"KRN",.84,"NM","B",38178,1197)

"BLD",443,"KRN",.84,"NM","B",38179,1198)

"BLD",443,"KRN",.84,"NM","B",38200,1199)

"BLD",443,"KRN",.84,"NM","B",38201,1200)

"BLD",443,"KRN",.84,"NM","B",38210,1201)

"BLD",443,"KRN",.84,"NM","B",38211,1202)

"BLD",443,"KRN",.84,"NM","B",38213,1203)

"BLD",443,"KRN",.84,"NM","B",38214,1204)

"BLD",443,"KRN",.84,"NM","B",38215,1205)

"BLD",443,"KRN",.84,"NM","B",38216,1206)

"BLD",443,"KRN",.84,"NM","B",38217,1207)

"BLD",443,"KRN",.84,"NM","B",38218,1208)

"BLD",443,"KRN",.84,"NM","B",38220,1209)

"BLD",443,"KRN",.84,"NM","B",38221,1210)

"BLD",443,"KRN",.84,"NM","B",38222,1211)

"BLD",443,"KRN",.84,"NM","B",38223,1212)

"BLD",443,"KRN",.84,"NM","B",38224,1213)

"BLD",443,"KRN",.84,"NM","B",38225,1214)

"BLD",443,"KRN",.84,"NM","B",38226,1215)

"BLD",443,"KRN",.84,"NM","B",38230,1216)

"BLD",443,"KRN",.84,"NM","B",38231,1217)

"BLD",443,"KRN",.84,"NM","B",38232,1218)

"BLD",443,"KRN",.84,"NM","B",38233,1219)

"BLD",443,"KRN",.84,"NM","B",39001,1220)

"BLD",443,"KRN",.84,"NM","B",39002,1221)

"BLD",443,"KRN",.84,"NM","B",39003,1222)

"BLD",443,"KRN",.84,"NM","B",39004,1223)

"BLD",443,"KRN",.84,"NM","B",39005,1224)

"BLD",443,"KRN",.84,"NM","B",39006,1225)

"BLD",443,"KRN",.84,"NM","B",39007,1226)

"BLD",443,"KRN",.84,"NM","B",39008,1227)

"BLD",443,"KRN",.84,"NM","B",39009,1228)

"BLD",443,"KRN",.84,"NM","B",39010,1229)

"BLD",443,"KRN",.84,"NM","B",39011,1230)

"BLD",443,"KRN",.84,"NM","B",39012,1231)

"BLD",443,"KRN",.84,"NM","B",39013,1232)

"BLD",443,"KRN",.84,"NM","B",39014,1233)

"BLD",443,"KRN",.84,"NM","B",39015,1234)

"BLD",443,"KRN",.84,"NM","B",39015.1,1235)

"BLD",443,"KRN",.84,"NM","B",39016,1236)

"BLD",443,"KRN",.84,"NM","B",39017,1237)

"BLD",443,"KRN",.84,"NM","B",39018,1238)

"BLD",443,"KRN",.84,"NM","B",39019,1239)

"BLD",443,"KRN",.84,"NM","B",39020,1240)

"BLD",443,"KRN",.84,"NM","B",39021,1241)

"BLD",443,"KRN",.84,"NM","B",39022,1242)

"BLD",443,"KRN",.84,"NM","B",39023,1243)

"BLD",443,"KRN",.84,"NM","B",39024,1244)

"BLD",443,"KRN",.84,"NM","B",39025,1245)

"BLD",443,"KRN",.84,"NM","B",39025.1,1246)

"BLD",443,"KRN",.84,"NM","B",39026,1247)

"BLD",443,"KRN",.84,"NM","B",39027,1248)

"BLD",443,"KRN",.84,"NM","B",39028,1249)

"BLD",443,"KRN",.84,"NM","B",39028.1,1250)

"BLD",443,"KRN",.84,"NM","B",39029,1251)

"BLD",443,"KRN",.84,"NM","B",39030,1252)

"BLD",443,"KRN",.84,"NM","B",39031,1253)

"BLD",443,"KRN",.84,"NM","B",39032,1254)

"BLD",443,"KRN",.84,"NM","B",39033,1255)

"BLD",443,"KRN",.84,"NM","B",39034,1256)

"BLD",443,"KRN",.84,"NM","B",39035,1257)

"BLD",443,"KRN",.84,"NM","B",39036,1258)

"BLD",443,"KRN",.84,"NM","B",39036.5,6)

"BLD",443,"KRN",.84,"NM","B",39037,1259)

"BLD",443,"KRN",.84,"NM","B",39038,1260)

"BLD",443,"KRN",.84,"NM","B",39039,1261)

"BLD",443,"KRN",.84,"NM","B",39040,1262)

"BLD",443,"KRN",.84,"NM","B",39041,1263)

"BLD",443,"KRN",.84,"NM","B",39042,1264)

"BLD",443,"KRN",.84,"NM","B",39043,1265)

"BLD",443,"KRN",.84,"NM","B",39044,1266)

"BLD",443,"KRN",.84,"NM","B",39045,1267)

"BLD",443,"KRN",.84,"NM","B",39046,1268)

"BLD",443,"KRN",.84,"NM","B",39047,1269)

"BLD",443,"KRN",.84,"NM","B",39047.5,1270)

"BLD",443,"KRN",.84,"NM","B",39048,1271)

"BLD",443,"KRN",.84,"NM","B",39049,1272)

"BLD",443,"KRN",.84,"NM","B",39050,1273)

"BLD",443,"KRN",.84,"NM","B",39051,1274)

"BLD",443,"KRN",.84,"NM","B",39052,1275)

"BLD",443,"KRN",.84,"NM","B",39053,1276)

"BLD",443,"KRN",.84,"NM","B",39054,1277)

"BLD",443,"KRN",.84,"NM","B",39054.1,1278)

"BLD",443,"KRN",.84,"NM","B",39060,1279)

"BLD",443,"KRN",.84,"NM","B",39061,1280)

"BLD",443,"KRN",.84,"NM","B",39062,1281)

"BLD",443,"KRN",.84,"NM","B",39063,1282)

"BLD",443,"KRN",.84,"NM","B",39064,1283)

"BLD",443,"KRN",.84,"NM","B",39065,1284)

"BLD",443,"KRN",.84,"NM","B",39066,1285)

"BLD",443,"KRN",.84,"NM","B",39067,1286)

"BLD",443,"KRN",.84,"NM","B",39068,1287)

"BLD",443,"KRN",.84,"NM","B",39069,1288)

"BLD",443,"KRN",.84,"NM","B",39080,1289)

"BLD",443,"KRN",.84,"NM","B",39081,1290)

"BLD",443,"KRN",.84,"NM","B",39082,1291)

"BLD",443,"KRN",.84,"NM","B",39083,1292)

"BLD",443,"KRN",.84,"NM","B",39084,1293)

"BLD",443,"KRN",.84,"NM","B",39085,1294)

"BLD",443,"KRN",.84,"NM","B",39086,1295)

"BLD",443,"KRN",.84,"NM","B",39087,1296)

"BLD",443,"KRN",.84,"NM","B",39088,1297)

"BLD",443,"KRN",.84,"NM","B",39089,1298)

"BLD",443,"KRN",.84,"NM","B",39090,1299)

"BLD",443,"KRN",.84,"NM","B",39091,1300)

"BLD",443,"KRN",.84,"NM","B",39092,1301)

"BLD",443,"KRN",.84,"NM","B",39093,1302)

"BLD",443,"KRN",.84,"NM","B",39100,1303)

"BLD",443,"KRN",.84,"NM","B",39101,1304)

"BLD",443,"KRN",.84,"NM","B",39102,1305)

"BLD",443,"KRN",.84,"NM","B",39103,1306)

"BLD",443,"KRN",.84,"NM","B",39104,1307)

"BLD",443,"KRN",.84,"NM","B",39105,1308)

"BLD",443,"KRN",.84,"NM","B",39106,1309)

"BLD",443,"KRN",.84,"NM","B",39107,1310)

"BLD",443,"KRN",.84,"NM","B",39108,1311)

"BLD",443,"KRN",.84,"NM","B",39109,1312)

"BLD",443,"KRN",.84,"NM","B",39110,1313)

"BLD",443,"KRN",.84,"NM","B",39111,1314)

"BLD",443,"KRN",.84,"NM","B",39112,1315)

"BLD",443,"KRN",.84,"NM","B",39113,1316)

"BLD",443,"KRN",.84,"NM","B",39114,1317)

"BLD",443,"KRN",.84,"NM","B",39115,1318)

"BLD",443,"KRN",.84,"NM","B",39116,1319)

"BLD",443,"KRN",.84,"NM","B",39130,1320)

"BLD",443,"KRN",.84,"NM","B",39131,1321)

"BLD",443,"KRN",.84,"NM","B",39132,1322)

"BLD",443,"KRN",.84,"NM","B",39133,1323)

"BLD",443,"KRN",.84,"NM","B",39134,1324)

"BLD",443,"KRN",.84,"NM","B",39135,1325)

"BLD",443,"KRN",.84,"NM","B",39136,1326)

"BLD",443,"KRN",.84,"NM","B",39137,1327)

"BLD",443,"KRN",.84,"NM","B",39138,1328)

"BLD",443,"KRN",.84,"NM","B",39139,1329)

"BLD",443,"KRN",.84,"NM","B",39140,1330)

"BLD",443,"KRN",.84,"NM","B",39141,1331)

"BLD",443,"KRN",.84,"NM","B",39142,1332)

"BLD",443,"KRN",.84,"NM","B",39143,1333)

"BLD",443,"KRN",.84,"NM","B",39144,1334)

"BLD",443,"KRN",.84,"NM","B",39145,1335)

"BLD",443,"KRN",.84,"NM","B",39146,1336)

"BLD",443,"KRN",.84,"NM","B",39147,1337)

"BLD",443,"KRN",.84,"NM","B",39148,1338)

"BLD",443,"KRN",.84,"NM","B",39149,1339)

"BLD",443,"KRN",.84,"NM","B",39200,1340)

"BLD",443,"KRN",.84,"NM","B",39201,1341)

"BLD",443,"KRN",.84,"NM","B",39202,1342)

"BLD",443,"KRN",.84,"NM","B",39203,1343)

"BLD",443,"KRN",.84,"NM","B",39204,1344)

"BLD",443,"KRN",.84,"NM","B",39205,5)

"BLD",443,"KRN",.84,"NM","B",39300,1345)

"BLD",443,"KRN",.84,"NM","B",39301,1346)

"BLD",443,"KRN",.84,"NM","B",39302,1347)

"BLD",443,"KRN",.84,"NM","B",39303.1,1348)

"BLD",443,"KRN",.84,"NM","B",39303.2,1349)

"BLD",443,"KRN",.84,"NM","B",39303.3,1350)

"BLD",443,"KRN",.84,"NM","B",39303.4,1351)

"BLD",443,"KRN",.84,"NM","B",39303.5,1352)

"BLD",443,"KRN",.84,"NM","B",39303.6,117)

"BLD",443,"KRN",.84,"NM","B",39303.7,139)

"BLD",443,"KRN",.84,"NM","B",39310,1353)

"BLD",443,"KRN",.84,"NM","B",39311,1354)

"BLD",443,"KRN",.84,"NM","B",39320,1355)

"BLD",443,"KRN",.84,"NM","B",39321,1356)

"BLD",443,"KRN",.84,"NM","B",39330,134)

"BLD",443,"KRN",.84,"NM","B",39331,135)

"BLD",443,"KRN",.84,"NM","B",39332,136)

"BLD",443,"KRN",.84,"NM","B",39333,137)

"BLD",443,"KRN",.84,"NM","B",39334,138)

"BLD",443,"KRN",.84,"NM","B",39401,1357)

"BLD",443,"KRN",.84,"NM","B",39402,1358)

"BLD",443,"KRN",.84,"NM","B",39403,1359)

"BLD",443,"KRN",.84,"NM","B",39404,1360)

"BLD",443,"KRN",.84,"NM","B",39405,1361)

"BLD",443,"KRN",.84,"NM","B",39406,1362)

"BLD",443,"KRN",.84,"NM","B",39407,1363)

"BLD",443,"KRN",.84,"NM","B",39408,1364)

"BLD",443,"KRN",.84,"NM","B",39409,1365)

"BLD",443,"KRN",.84,"NM","B",39410,1366)

"BLD",443,"KRN",.84,"NM","B",39411,1367)

"BLD",443,"KRN",.84,"NM","B",39412,1368)

"BLD",443,"KRN",.84,"NM","B",39413,1369)

"BLD",443,"KRN",.84,"NM","B",39414,1370)

"BLD",443,"KRN",.84,"NM","B",39415,1371)

"BLD",443,"KRN",.84,"NM","B",39416,1372)

"BLD",443,"KRN",.84,"NM","B",39417,1373)

"BLD",443,"KRN",.84,"NM","B",39418,1374)

"BLD",443,"KRN",.84,"NM","B",39419,1375)

"BLD",443,"KRN",.84,"NM","B",39420,1376)

"BLD",443,"KRN",.84,"NM","B",39430,1377)

"BLD",443,"KRN",.84,"NM","B",39431,1378)

"BLD",443,"KRN",.84,"NM","B",39432,1379)

"BLD",443,"KRN",.84,"NM","B",39433,1380)

"BLD",443,"KRN",.84,"NM","B",39434,1381)

"BLD",443,"KRN",.84,"NM","B",39435,1382)

"BLD",443,"KRN",.84,"NM","B",39436,1383)

"BLD",443,"KRN",.84,"NM","B",39437,1384)

"BLD",443,"KRN",.84,"NM","B",39438,1385)

"BLD",443,"KRN",.84,"NM","B",39440,1386)

"BLD",443,"KRN",.84,"NM","B",39441,1387)

"BLD",443,"KRN",.84,"NM","B",39442,1388)

"BLD",443,"KRN",.84,"NM","B",39443,1389)

"BLD",443,"KRN",.84,"NM","B",39501,1390)

"BLD",443,"KRN",.84,"NM","B",39502,1391)

"BLD",443,"KRN",.84,"NM","B",39503,1392)

"BLD",443,"KRN",.84,"NM","B",39503.1,1393)

"BLD",443,"KRN",.84,"NM","B",39504,1394)

"BLD",443,"KRN",.84,"NM","B",39504.1,1395)

"BLD",443,"KRN",.84,"NM","B",42000,1397)

"BLD",443,"KRN",.84,"NM","B",42000.1,127)

"BLD",443,"KRN",.84,"NM","B",42000.2,128)

"BLD",443,"KRN",.84,"NM","B",42001,1398)

"BLD",443,"KRN",.84,"NM","B",42002,1399)

"BLD",443,"KRN",.84,"NM","B",42002.1,1400)

"BLD",443,"KRN",.84,"NM","B",42002.2,1401)

"BLD",443,"KRN",.84,"NM","B",42003,1402)

"BLD",443,"KRN",.84,"NM","B",42100,1403)

"BLD",443,"KRN",.84,"NM","B",42101,1404)

"BLD",443,"KRN",.84,"NM","B",42102,1405)

"BLD",443,"KRN",.84,"NM","B",42103,1406)

"BLD",443,"KRN",.84,"NM","B",42104,1407)

"BLD",443,"KRN",.84,"NM","B",42105,1408)

"BLD",443,"KRN",.84,"NM","B",42106,1409)

"BLD",443,"KRN",.84,"NM","B",42110,1410)

"BLD",443,"KRN",.84,"NM","B",42111,1411)

"BLD",443,"KRN",.84,"NM","B",42112,1412)

"BLD",443,"KRN",.84,"NM","B",42113,1413)

"BLD",443,"KRN",.84,"NM","B",42114,1414)

"BLD",443,"KRN",.84,"NM","B",42115,1415)

"BLD",443,"KRN",.84,"NM","B",42116,1416)

"BLD",443,"KRN",.84,"NM","B",42117,1417)

"BLD",443,"KRN",.84,"NM","B",42120,1418)

"BLD",443,"KRN",.84,"NM","B",42121,1419)

"BLD",443,"KRN",.84,"NM","B",42122,1420)

"BLD",443,"KRN",.84,"NM","B",42123,1421)

"BLD",443,"KRN",.84,"NM","B",42125,1422)

"BLD",443,"KRN",.84,"NM","B",42126,1423)

"BLD",443,"KRN",.84,"NM","B",42127,1424)

"BLD",443,"KRN",.84,"NM","B",42128,1425)

"BLD",443,"KRN",.84,"NM","B",42129,1426)

"BLD",443,"KRN",.84,"NM","B",42130,1427)

"BLD",443,"KRN",.84,"NM","B",42131,1428)

"BLD",443,"KRN",.84,"NM","B",42132,1429)

"BLD",443,"KRN",.84,"NM","B",42135,1430)

"BLD",443,"KRN",.84,"NM","B",42136,1431)

"BLD",443,"KRN",.84,"NM","B",42137,144)

"BLD",443,"KRN",.84,"NM","B",42138,1432)

"BLD",443,"KRN",.84,"NM","B",42139,1433)

"BLD",443,"KRN",.84,"NM","B",42140,1434)

"BLD",443,"KRN",.84,"NM","B",42141,1435)

"BLD",443,"KRN",.84,"NM","B",42150,72)

"BLD",443,"KRN",.84,"NM","B",42151,73)

"BLD",443,"KRN",.84,"NM","B",42152,74)

"BLD",443,"KRN",.84,"NM","B",42153,75)

"BLD",443,"KRN",.84,"NM","B",42170,80)

"BLD",443,"KRN",.84,"NM","B",42171,81)

"BLD",443,"KRN",.84,"NM","B",42171.1,82)

"BLD",443,"KRN",.84,"NM","B",42172,83)

"BLD",443,"KRN",.84,"NM","B",42173,84)

"BLD",443,"KRN",.84,"NM","B",42174,85)

"BLD",443,"KRN",.84,"NM","B",42175,86)

"BLD",443,"KRN",.84,"NM","B",42176,87)

"BLD",443,"KRN",.84,"NM","B",42177,88)

"BLD",443,"KRN",.84,"NM","B",42190,126)

"BLD",443,"KRN",.84,"NM","B",42191,125)

"BLD",443,"KRN",.84,"NM","B",42192,129)

"BLD",443,"KRN",.84,"NM","B",42201,9)

"BLD",443,"KRN",.84,"NM","B",42201.01,10)

"BLD",443,"KRN",.84,"NM","B",42201.02,11)

"BLD",443,"KRN",.84,"NM","B",42201.03,12)

"BLD",443,"KRN",.84,"NM","B",42201.04,13)

"BLD",443,"KRN",.84,"NM","B",42201.05,14)

"BLD",443,"KRN",.84,"NM","B",42201.06,15)

"BLD",443,"KRN",.84,"NM","B",42201.07,16)

"BLD",443,"KRN",.84,"NM","B",42201.08,17)

"BLD",443,"KRN",.84,"NM","B",42201.09,18)

"BLD",443,"KRN",.84,"NM","B",42201.1,19)

"BLD",443,"KRN",.84,"NM","B",42201.11,20)

"BLD",443,"KRN",.84,"NM","B",42201.12,21)

"BLD",443,"KRN",.84,"NM","B",42201.13,22)

"BLD",443,"KRN",.84,"NM","B",42201.14,23)

"BLD",443,"KRN",.84,"NM","B",42201.15,24)

"BLD",443,"KRN",.84,"NM","B",42201.16,25)

"BLD",443,"KRN",.84,"NM","B",42201.17,26)

"BLD",443,"KRN",.84,"NM","B",42201.18,27)

"BLD",443,"KRN",.84,"NM","B",42210,28)

"BLD",443,"KRN",.84,"NM","B",42211,1440)

"BLD",443,"KRN",.84,"NM","B",42212,30)

"BLD",443,"KRN",.84,"NM","B",42213,31)

"BLD",443,"KRN",.84,"NM","B",42214,32)

"BLD",443,"KRN",.84,"NM","B",42215,33)

"BLD",443,"KRN",.84,"NM","B",42216,34)

"BLD",443,"KRN",.84,"NM","B",42217,35)

"BLD",443,"KRN",.84,"NM","B",42218,36)

"BLD",443,"KRN",.84,"NM","B",42219,37)

"BLD",443,"KRN",.84,"NM","B",42220,38)

"BLD",443,"KRN",.84,"NM","B",42221,39)

"BLD",443,"KRN",.84,"NM","B",42222,40)

"BLD",443,"KRN",.84,"NM","B",42222.1,41)

"BLD",443,"KRN",.84,"NM","B",42222.2,42)

"BLD",443,"KRN",.84,"NM","B",42223,43)

"BLD",443,"KRN",.84,"NM","B",42224,44)

"BLD",443,"KRN",.84,"NM","B",42225,45)

"BLD",443,"KRN",.84,"NM","B",42226,46)

"BLD",443,"KRN",.84,"NM","B",42227,47)

"BLD",443,"KRN",.84,"NM","B",42228,48)

"BLD",443,"KRN",.84,"NM","B",42229,130)

"BLD",443,"KRN",.84,"NM","B",42230,50)

"BLD",443,"KRN",.84,"NM","B",42231,51)

"BLD",443,"KRN",.84,"NM","B",42232,52)

"BLD",443,"KRN",.84,"NM","B",42233,53)

"BLD",443,"KRN",.84,"NM","B",42234,54)

"BLD",443,"KRN",.84,"NM","B",42235,55)

"BLD",443,"KRN",.84,"NM","B",42236,56)

"BLD",443,"KRN",.84,"NM","B",42237,57)

"BLD",443,"KRN",.84,"NM","B",42240,58)

"BLD",443,"KRN",.84,"NM","B",42241,59)

"BLD",443,"KRN",.84,"NM","B",42244,101)

"BLD",443,"KRN",.84,"NM","B",42245,60)

"BLD",443,"KRN",.84,"NM","B",42246,61)

"BLD",443,"KRN",.84,"NM","B",42247,62)

"BLD",443,"KRN",.84,"NM","B",42248,63)

"BLD",443,"KRN",.84,"NM","B",42250,64)

"BLD",443,"KRN",.84,"NM","B",42251,65)

"BLD",443,"KRN",.84,"NM","B",42252,66)

"BLD",443,"KRN",.84,"NM","B",42253,67)

"BLD",443,"KRN",.84,"NM","B",42254,68)

"BLD",443,"KRN",.84,"NM","B",42255,69)

"BLD",443,"KRN",.84,"NM","B",42256,70)

"BLD",443,"KRN",.84,"NM","B",42257,71)

"BLD",443,"KRN",.84,"NM","B",42260,120)

"BLD",443,"KRN",.84,"NM","B",42260.1,140)

"BLD",443,"KRN",.84,"NM","B",42260.2,141)

"BLD",443,"KRN",.84,"NM","B",42260.3,142)

"BLD",443,"KRN",.84,"NM","B",42260.4,143)

"BLD",443,"KRN",.84,"NM","B",42261,121)

"BLD",443,"KRN",.84,"NM","B",42262,122)

"BLD",443,"KRN",.84,"NM","B",42263,76)

"BLD",443,"KRN",.84,"NM","B",42264,77)

"BLD",443,"KRN",.84,"NM","B",42265,78)

"BLD",443,"KRN",.84,"NM","B",42266,79)

"BLD",443,"KRN",.84,"NM","B",42267,123)

"BLD",443,"KRN",.84,"NM","B",42268,124)

"BLD",443,"KRN",.84,"NM","B",42269,1443)

"BLD",443,"KRN",.84,"NM","B",42281,90)

"BLD",443,"KRN",.84,"NM","B",42282,91)

"BLD",443,"KRN",.84,"NM","B",42283,92)

"BLD",443,"KRN",.84,"NM","B",42284,93)

"BLD",443,"KRN",.84,"NM","B",42285,94)

"BLD",443,"KRN",.84,"NM","B",42286,95)

"BLD",443,"KRN",.84,"NM","B",42287,96)

"BLD",443,"KRN",.84,"NM","B",42288,97)

"BLD",443,"KRN",.84,"NM","B",42288.1,98)

"BLD",443,"KRN",.84,"NM","B",42289,99)

"BLD",443,"KRN",.84,"NM","B",42289.1,100)

"BLD",443,"KRN",.84,"NM","B",42300,102)

"BLD",443,"KRN",.84,"NM","B",42301,103)

"BLD",443,"KRN",.84,"NM","B",42305,104)

"BLD",443,"KRN",.84,"NM","B",42306,105)

"BLD",443,"KRN",.84,"NM","B",42307,106)

"BLD",443,"KRN",.84,"NM","B",42308,107)

"BLD",443,"KRN",.84,"NM","B",42309,108)

"BLD",443,"KRN",.84,"NM","B",42315,109)

"BLD",443,"KRN",.84,"NM","B",42316,110)

"BLD",443,"KRN",.84,"NM","B",42350,111)

"BLD",443,"KRN",.84,"NM","B",42351,112)

"BLD",443,"KRN",.84,"NM","B",42352,113)

"BLD",443,"KRN",.84,"NM","B",42353,114)

"BLD",443,"KRN",.84,"NM","B",42354,115)

"BLD",443,"KRN",.84,"NM","B",42355,116)

"BLD",443,"KRN",.84,"NM","B",42355.1,1441)

"BLD",443,"KRN",.84,"NM","B",42356,118)

"BLD",443,"KRN",.84,"NM","B",42357,119)

"BLD",443,"KRN",.84,"NM","B",42358,1442)

"BLD",443,"KRN",3.6,0)
3.6
"BLD",443,"KRN",3.6,"NM",0)
^9.68A^36^33
"BLD",443,"KRN",3.6,"NM",2,0)
XMMISS^^1^
"BLD",443,"KRN",3.6,"NM",3,0)
XMNEWBUL^^1^
"BLD",443,"KRN",3.6,"NM",4,0)
XMQFAIL^^1^
"BLD",443,"KRN",3.6,"NM",5,0)
XMRDNAK^^1^
"BLD",443,"KRN",3.6,"NM",6,0)
XMREPNAK^^1^
"BLD",443,"KRN",3.6,"NM",7,0)
XMTFAIL^^1^
"BLD",443,"KRN",3.6,"NM",8,0)
XMUSERNO^^1^
"BLD",443,"KRN",3.6,"NM",9,0)
XMVADABORT^^1^
"BLD",443,"KRN",3.6,"NM",10,0)
XMDATANO^^1^
"BLD",443,"KRN",3.6,"NM",12,0)
XM-FWD-ADDRESS-CHECKER^^1^
"BLD",443,"KRN",3.6,"NM",13,0)
XM FWD ADDRESS CHANGE^^0
"BLD",443,"KRN",3.6,"NM",14,0)
XMZFWDBULL^^1^
"BLD",443,"KRN",3.6,"NM",15,0)
XM FWD ADDRESS CHECK^^0
"BLD",443,"KRN",3.6,"NM",16,0)
XM BANNER MESSAGE^^0
"BLD",443,"KRN",3.6,"NM",17,0)
XM DATE PURGE WARNING^^0
"BLD",443,"KRN",3.6,"NM",18,0)
XM DOMAIN ADDED^^0
"BLD",443,"KRN",3.6,"NM",19,0)
XM FILTER FWD ADDRESS DELETE^^0
"BLD",443,"KRN",3.6,"NM",20,0)
XM FWD ADDRESS DELETE^^0
"BLD",443,"KRN",3.6,"NM",21,0)
XM GROUP EDIT NOTIFY^^0
"BLD",443,"KRN",3.6,"NM",22,0)
XM GROUP ERROR^^0
"BLD",443,"KRN",3.6,"NM",23,0)
XM IN BASKET PURGE REQUEST^^0
"BLD",443,"KRN",3.6,"NM",24,0)
XM IN BASKET PURGE WARNING^^0
"BLD",443,"KRN",3.6,"NM",25,0)
XM SEND ERR MSG^^0
"BLD",443,"KRN",3.6,"NM",26,0)
XM SEND ERR RECIPIENT^^0
"BLD",443,"KRN",3.6,"NM",27,0)
XM SEND ERR REMOTE MSG ID^^0
"BLD",443,"KRN",3.6,"NM",28,0)
XM SEND ERR SERVER MSG^^0
"BLD",443,"KRN",3.6,"NM",29,0)
XM SUPER SEARCH^^0
"BLD",443,"KRN",3.6,"NM",30,0)
XM TOO MANY MESSAGES^^0
"BLD",443,"KRN",3.6,"NM",31,0)
XMNEWUSER^^0
"BLD",443,"KRN",3.6,"NM",32,0)
XMRDACK^^0
"BLD",443,"KRN",3.6,"NM",34,0)
XM_TRANSMISSION_ERROR^^0
"BLD",443,"KRN",3.6,"NM",35,0)
XM SEND ERR TRANSMISSION^^0
"BLD",443,"KRN",3.6,"NM",36,0)
XMVALBAD^^0
"BLD",443,"KRN",3.6,"NM","B","XM BANNER MESSAGE",16)

"BLD",443,"KRN",3.6,"NM","B","XM DATE PURGE WARNING",17)

"BLD",443,"KRN",3.6,"NM","B","XM DOMAIN ADDED",18)

"BLD",443,"KRN",3.6,"NM","B","XM FILTER FWD ADDRESS DELETE",19)

"BLD",443,"KRN",3.6,"NM","B","XM FWD ADDRESS CHANGE",13)

"BLD",443,"KRN",3.6,"NM","B","XM FWD ADDRESS CHECK",15)

"BLD",443,"KRN",3.6,"NM","B","XM FWD ADDRESS DELETE",20)

"BLD",443,"KRN",3.6,"NM","B","XM GROUP EDIT NOTIFY",21)

"BLD",443,"KRN",3.6,"NM","B","XM GROUP ERROR",22)

"BLD",443,"KRN",3.6,"NM","B","XM IN BASKET PURGE REQUEST",23)

"BLD",443,"KRN",3.6,"NM","B","XM IN BASKET PURGE WARNING",24)

"BLD",443,"KRN",3.6,"NM","B","XM SEND ERR MSG",25)

"BLD",443,"KRN",3.6,"NM","B","XM SEND ERR RECIPIENT",26)

"BLD",443,"KRN",3.6,"NM","B","XM SEND ERR REMOTE MSG ID",27)

"BLD",443,"KRN",3.6,"NM","B","XM SEND ERR SERVER MSG",28)

"BLD",443,"KRN",3.6,"NM","B","XM SEND ERR TRANSMISSION",35)

"BLD",443,"KRN",3.6,"NM","B","XM SUPER SEARCH",29)

"BLD",443,"KRN",3.6,"NM","B","XM TOO MANY MESSAGES",30)

"BLD",443,"KRN",3.6,"NM","B","XM-FWD-ADDRESS-CHECKER",12)

"BLD",443,"KRN",3.6,"NM","B","XMDATANO",10)

"BLD",443,"KRN",3.6,"NM","B","XMMISS",2)

"BLD",443,"KRN",3.6,"NM","B","XMNEWBUL",3)

"BLD",443,"KRN",3.6,"NM","B","XMNEWUSER",31)

"BLD",443,"KRN",3.6,"NM","B","XMQFAIL",4)

"BLD",443,"KRN",3.6,"NM","B","XMRDACK",32)

"BLD",443,"KRN",3.6,"NM","B","XMRDNAK",5)

"BLD",443,"KRN",3.6,"NM","B","XMREPNAK",6)

"BLD",443,"KRN",3.6,"NM","B","XMTFAIL",7)

"BLD",443,"KRN",3.6,"NM","B","XMUSERNO",8)

"BLD",443,"KRN",3.6,"NM","B","XMVADABORT",9)

"BLD",443,"KRN",3.6,"NM","B","XMVALBAD",36)

"BLD",443,"KRN",3.6,"NM","B","XMZFWDBULL",14)

"BLD",443,"KRN",3.6,"NM","B","XM_TRANSMISSION_ERROR",34)

"BLD",443,"KRN",3.8,0)
3.8
"BLD",443,"KRN",3.8,"NM",0)
^9.68A^1^1
"BLD",443,"KRN",3.8,"NM",1,0)
XM SUPER SEARCH^^0
"BLD",443,"KRN",3.8,"NM","B","XM SUPER SEARCH",1)

"BLD",443,"KRN",9.2,0)
9.2
"BLD",443,"KRN",9.2,"NM",0)
^9.68A^342^337
"BLD",443,"KRN",9.2,"NM",1,0)
XM-BACKGROUND-FILER^^1^
"BLD",443,"KRN",9.2,"NM",2,0)
XM-I-C-TALKMAN^^0
"BLD",443,"KRN",9.2,"NM",3,0)
XM-I-C-TALKMAN CAPTURE^^0
"BLD",443,"KRN",9.2,"NM",4,0)
XM-I-C-TALKMAN END^^0
"BLD",443,"KRN",9.2,"NM",5,0)
XM-I-D-RECOVER MSGS^^0
"BLD",443,"KRN",9.2,"NM",6,0)
XM-I-D-RECOVER MSGS-FIND^^0
"BLD",443,"KRN",9.2,"NM",7,0)
XM-I-D-RECOVER MSGS-LIST^^0
"BLD",443,"KRN",9.2,"NM",8,0)
XM-I-D-RECOVER MSGS-PUT^^0
"BLD",443,"KRN",9.2,"NM",9,0)
XM-I-N-BULLETINS^^0
"BLD",443,"KRN",9.2,"NM",10,0)
XM-I-N-DOMAIN FILE^^0
"BLD",443,"KRN",9.2,"NM",11,0)
XM-I-N-DOMAIN FILE-ADDRESSING^^0
"BLD",443,"KRN",9.2,"NM",12,0)
XM-I-N-DOMAIN FILE-CONNECT^^0
"BLD",443,"KRN",9.2,"NM",13,0)
XM-I-N-DOMAIN FILE-CONNECT-2^^0
"BLD",443,"KRN",9.2,"NM",14,0)
XM-I-N-DOMAIN FILE-FLAGS^^0
"BLD",443,"KRN",9.2,"NM",15,0)
XM-I-N-DOMAIN FILE-SESSION^^0
"BLD",443,"KRN",9.2,"NM",16,0)
XM-I-N-DOMAIN FILE-TURN^^0
"BLD",443,"KRN",9.2,"NM",17,0)
XM-I-N-DOMAIN FILE-VALIDATE^^0
"BLD",443,"KRN",9.2,"NM",18,0)
XM-I-N-NETWORK^^0
"BLD",443,"KRN",9.2,"NM",19,0)
XM-I-N-XMIT PLAY^^0
"BLD",443,"KRN",9.2,"NM",20,0)
XM-I-N-XMIT POLL^^0
"BLD",443,"KRN",9.2,"NM",21,0)
XM-I-N-XMIT QUEUES^^0
"BLD",443,"KRN",9.2,"NM",22,0)
XM-I-N-XMIT SCHEDULE TASK^^0
"BLD",443,"KRN",9.2,"NM",23,0)
XM-I-N-XMIT TAPE^^0
"BLD",443,"KRN",9.2,"NM",24,0)
XM-I-N-XMIT TASK^^0
"BLD",443,"KRN",9.2,"NM",25,0)
XM-I-N-XMIT TASK-2^^0
"BLD",443,"KRN",9.2,"NM",26,0)
XM-I-N-XMIT UCI^^0
"BLD",443,"KRN",9.2,"NM",27,0)
XM-I-NEW FEATURES^^0
"BLD",443,"KRN",9.2,"NM",28,0)
XM-I-S-BIG GROUP SIZE^^0
"BLD",443,"KRN",9.2,"NM",29,0)
XM-I-S-MAX DIGITS FOR MSG NUM^^0
"BLD",443,"KRN",9.2,"NM",30,0)
XM-I-S-MESSAGE LINE LIMIT^^0
"BLD",443,"KRN",9.2,"NM",31,0)
XM-I-S-SITE PARAMETERS^^0
"BLD",443,"KRN",9.2,"NM",32,0)
XM-I-S-SITE PARAMETERS-DISK^^0
"BLD",443,"KRN",9.2,"NM",33,0)
XM-I-S-SITE PARAMETERS-ID^^0
"BLD",443,"KRN",9.2,"NM",34,0)
XM-I-S-SITE PARAMETERS-LOCAL^^0
"BLD",443,"KRN",9.2,"NM",35,0)
XM-I-S-SITE PARAMETERS-REMOTE^^0
"BLD",443,"KRN",9.2,"NM",36,0)
XM-I-S-SITE PARAMETERS-USER^^0
"BLD",443,"KRN",9.2,"NM",37,0)
XM-I-S-SITE PARAMETERS-USER-2^^0
"BLD",443,"KRN",9.2,"NM",38,0)
XM-IN-BASKET-PURGE^^1^
"BLD",443,"KRN",9.2,"NM",39,0)
XM-IN-BASKET-PURGE-1^^1^
"BLD",443,"KRN",9.2,"NM",40,0)
XM-IN-BASKET-PURGE-2^^1^
"BLD",443,"KRN",9.2,"NM",41,0)
XM-IN-BASKET-PURGE-3^^1^
"BLD",443,"KRN",9.2,"NM",42,0)
XM-LOCAL-LAST-SIGN-ON^^1^
"BLD",443,"KRN",9.2,"NM",44,0)
XM-U-A-ADDRESS^^0
"BLD",443,"KRN",9.2,"NM",45,0)
XM-U-A-CC^^0
"BLD",443,"KRN",9.2,"NM",46,0)
XM-U-A-GROUP LARGE^^0
"BLD",443,"KRN",9.2,"NM",47,0)
XM-U-A-GROUP LARGE-2^^0
"BLD",443,"KRN",9.2,"NM",48,0)
XM-U-A-INFO ONLY^^0
"BLD",443,"KRN",9.2,"NM",49,0)
XM-U-A-LOCAL USER NAME^^0
"BLD",443,"KRN",9.2,"NM",50,0)
XM-U-A-LOCAL USER NAME-2^^0
"BLD",443,"KRN",9.2,"NM",51,0)
XM-U-A-STAGGER DELIVERY^^0
"BLD",443,"KRN",9.2,"NM",52,0)
XM-U-A-STAGGER DELIVERY-2^^0
"BLD",443,"KRN",9.2,"NM",53,0)
XM-U-B-BASKET CONTENTS LIST^^0
"BLD",443,"KRN",9.2,"NM",54,0)
XM-U-B-BASKET NAME^^0
"BLD",443,"KRN",9.2,"NM",55,0)
XM-U-B-BASKET NAME CHANGE^^0
"BLD",443,"KRN",9.2,"NM",56,0)
XM-U-B-BASKET SELECT^^0
"BLD",443,"KRN",9.2,"NM",57,0)
XM-U-B-CHANGE DETAIL^^0
"BLD",443,"KRN",9.2,"NM",58,0)
XM-U-B-FILTER^^0
"BLD",443,"KRN",9.2,"NM",59,0)
XM-U-B-NAVIGATE CLASSIC^^0
"BLD",443,"KRN",9.2,"NM",60,0)
XM-U-B-NAVIGATE FULL SCREEN^^0
"BLD",443,"KRN",9.2,"NM",61,0)
XM-U-B-NEW MAIL LIST^^0
"BLD",443,"KRN",9.2,"NM",62,0)
XM-U-B-OPPOSITE TOGGLE^^0
"BLD",443,"KRN",9.2,"NM",63,0)
XM-U-B-READER^^0
"BLD",443,"KRN",9.2,"NM",64,0)
XM-U-B-READER CLASSIC^^0
"BLD",443,"KRN",9.2,"NM",65,0)
XM-U-B-READER DETAILED^^0
"BLD",443,"KRN",9.2,"NM",66,0)
XM-U-B-READER DETAILED LIST^^0
"BLD",443,"KRN",9.2,"NM",67,0)
XM-U-B-READER DIFF^^0
"BLD",443,"KRN",9.2,"NM",68,0)
XM-U-B-READER DIFF-2^^0
"BLD",443,"KRN",9.2,"NM",69,0)
XM-U-B-READER DIFF-3^^0
"BLD",443,"KRN",9.2,"NM",70,0)
XM-U-B-READER FULL SCREEN^^0
"BLD",443,"KRN",9.2,"NM",71,0)
XM-U-B-READER SUMMARY^^0
"BLD",443,"KRN",9.2,"NM",72,0)
XM-U-B-RESEQUENCE MESSAGES^^0
"BLD",443,"KRN",9.2,"NM",73,0)
XM-U-B-XMIT PRIORITY TOGGLE^^0
"BLD",443,"KRN",9.2,"NM",74,0)
XM-U-B-XMIT PRIORITY TOGGLE-2^^0
"BLD",443,"KRN",9.2,"NM",75,0)
XM-U-B-ZOOM TOGGLE^^0
"BLD",443,"KRN",9.2,"NM",76,0)
XM-U-BO-CLASSIC^^0
"BLD",443,"KRN",9.2,"NM",77,0)
XM-U-BO-CLASSIC-2^^0
"BLD",443,"KRN",9.2,"NM",78,0)
XM-U-BO-FULL SCREEN^^0
"BLD",443,"KRN",9.2,"NM",79,0)
XM-U-BO-FULL SCREEN LIST^^0
"BLD",443,"KRN",9.2,"NM",80,0)
XM-U-BO-FULL SCREEN-2^^0
"BLD",443,"KRN",9.2,"NM",81,0)
XM-U-H-GROUP^^0
"BLD",443,"KRN",9.2,"NM",82,0)
XM-U-H-GROUP-2^^0
"BLD",443,"KRN",9.2,"NM",83,0)
XM-U-H-GROUP-3^^0
"BLD",443,"KRN",9.2,"NM",84,0)
XM-U-H-GROUP-4^^0
"BLD",443,"KRN",9.2,"NM",85,0)
XM-U-H-Q DELETE^^0
"BLD",443,"KRN",9.2,"NM",86,0)
XM-U-H-Q DISAPPEARED^^0
"BLD",443,"KRN",9.2,"NM",87,0)
XM-U-H-Q INTERRUPT^^0
"BLD",443,"KRN",9.2,"NM",88,0)
XM-U-H-Q LOOKUP^^0
"BLD",443,"KRN",9.2,"NM",89,0)
XM-U-H-Q RECALL^^0
"BLD",443,"KRN",9.2,"NM",90,0)
XM-U-H-Q REMOVE^^0
"BLD",443,"KRN",9.2,"NM",91,0)
XM-U-H-Q REPLIES^^0
"BLD",443,"KRN",9.2,"NM",92,0)
XM-U-H-QUESTIONS^^0
"BLD",443,"KRN",9.2,"NM",93,0)
XM-U-H-USER^^0
"BLD",443,"KRN",9.2,"NM",94,0)
XM-U-I-EDITOR FM LINE^^0
"BLD",443,"KRN",9.2,"NM",95,0)
XM-U-I-EDITOR FM SCREEN^^0
"BLD",443,"KRN",9.2,"NM",96,0)
XM-U-I-GROUP^^0
"BLD",443,"KRN",9.2,"NM",97,0)
XM-U-I-GROUP COORDINATOR^^0
"BLD",443,"KRN",9.2,"NM",98,0)
XM-U-I-GROUP MEMBER^^0
"BLD",443,"KRN",9.2,"NM",99,0)
XM-U-I-GROUP-2^^0
"BLD",443,"KRN",9.2,"NM",100,0)
XM-U-I-SHARED MAIL^^0
"BLD",443,"KRN",9.2,"NM",101,0)
XM-U-I-SURROGATE^^0
"BLD",443,"KRN",9.2,"NM",102,0)
XM-U-I-SURROGATE BECOME^^0
"BLD",443,"KRN",9.2,"NM",103,0)
XM-U-I-SURROGATE-2^^0
"BLD",443,"KRN",9.2,"NM",104,0)
XM-U-I-SURROGATE-3^^0
"BLD",443,"KRN",9.2,"NM",105,0)
XM-U-I-SURROGATE-4^^0
"BLD",443,"KRN",9.2,"NM",106,0)
XM-U-K-PACKMAN^^0
"BLD",443,"KRN",9.2,"NM",107,0)
XM-U-K-PACKMAN COMPARE^^0
"BLD",443,"KRN",9.2,"NM",108,0)
XM-U-K-PACKMAN INSTALL^^0
"BLD",443,"KRN",9.2,"NM",109,0)
XM-U-K-PACKMAN LOAD GLOBALS^^0
"BLD",443,"KRN",9.2,"NM",110,0)
XM-U-K-PACKMAN LOAD PACKAGE^^0
"BLD",443,"KRN",9.2,"NM",111,0)
XM-U-K-PACKMAN LOAD ROUTINES^^0
"BLD",443,"KRN",9.2,"NM",112,0)
XM-U-K-PACKMAN PRINT^^0
"BLD",443,"KRN",9.2,"NM",113,0)
XM-U-K-PACKMAN SUMMARIZE^^0
"BLD",443,"KRN",9.2,"NM",114,0)
XM-U-M-ANSWER^^0
"BLD",443,"KRN",9.2,"NM",115,0)
XM-U-M-BACKUP^^0
"BLD",443,"KRN",9.2,"NM",116,0)
XM-U-M-BACKUP BEFORE SENDING^^0
"BLD",443,"KRN",9.2,"NM",117,0)
XM-U-M-BROWSER^^0
"BLD",443,"KRN",9.2,"NM",118,0)
XM-U-M-CHOOSE RANGE^^0
"BLD",443,"KRN",9.2,"NM",119,0)
XM-U-M-CHOOSE RESPONSES^^0
"BLD",443,"KRN",9.2,"NM",120,0)
XM-U-M-CHOOSE SELECT^^0
"BLD",443,"KRN",9.2,"NM",121,0)
XM-U-M-CHOOSE SELECT-2^^0
"BLD",443,"KRN",9.2,"NM",123,0)
XM-U-M-CONFIDENTIAL^^0
"BLD",443,"KRN",9.2,"NM",124,0)
XM-U-M-CONFIRM RECEIPT^^0
"BLD",443,"KRN",9.2,"NM",125,0)
XM-U-M-COPY^^0
"BLD",443,"KRN",9.2,"NM",126,0)
XM-U-M-COPY-2^^0
"BLD",443,"KRN",9.2,"NM",127,0)
XM-U-M-DELETE^^0
"BLD",443,"KRN",9.2,"NM",128,0)
XM-U-M-DELETE-2^^0
"BLD",443,"KRN",9.2,"NM",129,0)
XM-U-M-DELETE-3^^0
"BLD",443,"KRN",9.2,"NM",130,0)
XM-U-M-DELIVERY BASKET SET^^0
"BLD",443,"KRN",9.2,"NM",131,0)
XM-U-M-EDIT RECIPIENTS^^0
"BLD",443,"KRN",9.2,"NM",132,0)
XM-U-M-EDIT SUBJECT^^0
"BLD",443,"KRN",9.2,"NM",133,0)
XM-U-M-EDIT TEXT^^0
"BLD",443,"KRN",9.2,"NM",134,0)
XM-U-M-FORWARD^^0
"BLD",443,"KRN",9.2,"NM",135,0)
XM-U-M-FORWARD-2^^0
"BLD",443,"KRN",9.2,"NM",136,0)
XM-U-M-INCLUDE MESSAGE^^0
"BLD",443,"KRN",9.2,"NM",138,0)
XM-U-M-LATER^^0
"BLD",443,"KRN",9.2,"NM",139,0)
XM-U-M-LATER-2^^0
"BLD",443,"KRN",9.2,"NM",140,0)
XM-U-M-LATER-3^^0
"BLD",443,"KRN",9.2,"NM",141,0)
XM-U-M-LATERED MESSAGE CHANGE^^0
"BLD",443,"KRN",9.2,"NM",142,0)
XM-U-M-LATERED MESSAGE REPORT^^0
"BLD",443,"KRN",9.2,"NM",143,0)
XM-U-M-MESSAGE HEADER^^0
"BLD",443,"KRN",9.2,"NM",144,0)
XM-U-M-NETWORK SIGNATURE^^0
"BLD",443,"KRN",9.2,"NM",145,0)
XM-U-M-NEW^^0
"BLD",443,"KRN",9.2,"NM",146,0)
XM-U-M-NEW-2^^0
"BLD",443,"KRN",9.2,"NM",147,0)
XM-U-M-PRINT^^0
"BLD",443,"KRN",9.2,"NM",148,0)
XM-U-M-PRINT DEVICE P-MESSAGE^^0
"BLD",443,"KRN",9.2,"NM",149,0)
XM-U-M-PRINT HEADER^^0
"BLD",443,"KRN",9.2,"NM",150,0)
XM-U-M-PRINT NO HEADER^^0
"BLD",443,"KRN",9.2,"NM",151,0)
XM-U-M-PRINT NO HEADER-2^^0
"BLD",443,"KRN",9.2,"NM",152,0)
XM-U-M-PRINT NO HEADER-3^^1^
"BLD",443,"KRN",9.2,"NM",153,0)
XM-U-M-PRINT-2^^0
"BLD",443,"KRN",9.2,"NM",155,0)
XM-U-M-PRIORITY TOGGLE^^0
"BLD",443,"KRN",9.2,"NM",156,0)
XM-U-M-QUERY^^0
"BLD",443,"KRN",9.2,"NM",157,0)
XM-U-M-QUERY DETAILED^^0
"BLD",443,"KRN",9.2,"NM",158,0)
XM-U-M-QUERY GENERAL^^0
"BLD",443,"KRN",9.2,"NM",159,0)
XM-U-M-QUERY INFO BASIC^^0
"BLD",443,"KRN",9.2,"NM",160,0)
XM-U-M-QUERY INFO LOCAL^^0
"BLD",443,"KRN",9.2,"NM",161,0)
XM-U-M-QUERY INFO REMOTE^^0
"BLD",443,"KRN",9.2,"NM",162,0)
XM-U-M-QUERY NETWORK^^0
"BLD",443,"KRN",9.2,"NM",163,0)
XM-U-M-QUERY NETWORK-2^^0
"BLD",443,"KRN",9.2,"NM",164,0)
XM-U-M-QUERY SPECIFIC^^0
"BLD",443,"KRN",9.2,"NM",165,0)
XM-U-M-QUERY-2^^0
"BLD",443,"KRN",9.2,"NM",166,0)
XM-U-M-REPLY^^0
"BLD",443,"KRN",9.2,"NM",167,0)
XM-U-M-REPLY INCLUDE^^0
"BLD",443,"KRN",9.2,"NM",168,0)
XM-U-M-REPLY-2^^0
"BLD",443,"KRN",9.2,"NM",169,0)
XM-U-M-SAVE^^0
"BLD",443,"KRN",9.2,"NM",170,0)
XM-U-M-SCRAMBLE^^0
"BLD",443,"KRN",9.2,"NM",171,0)
XM-U-M-SCRAMBLE HINT^^0
"BLD",443,"KRN",9.2,"NM",172,0)
XM-U-M-SCRAMBLE PASSWORD^^0
"BLD",443,"KRN",9.2,"NM",173,0)
XM-U-M-SEND^^0
"BLD",443,"KRN",9.2,"NM",174,0)
XM-U-M-TERMINATE^^0
"BLD",443,"KRN",9.2,"NM",175,0)
XM-U-M-TERMINATE-2^^0
"BLD",443,"KRN",9.2,"NM",176,0)
XM-U-M-TRANSMIT LATER^^0
"BLD",443,"KRN",9.2,"NM",177,0)
XM-U-M-TRANSMIT NOW^^0
"BLD",443,"KRN",9.2,"NM",178,0)
XM-U-M-VAPORIZE DATE EDIT^^0
"BLD",443,"KRN",9.2,"NM",179,0)
XM-U-M-VAPORIZE DATE EDIT-2^^0
"BLD",443,"KRN",9.2,"NM",180,0)
XM-U-M-VAPORIZE DATE SEND^^0
"BLD",443,"KRN",9.2,"NM",181,0)
XM-U-M-WRITE^^0
"BLD",443,"KRN",9.2,"NM",182,0)
XM-U-M-WRITE-2^^0
"BLD",443,"KRN",9.2,"NM",183,0)
XM-U-MO-EDIT^^0
"BLD",443,"KRN",9.2,"NM",184,0)
XM-U-MO-READ^^0
"BLD",443,"KRN",9.2,"NM",185,0)
XM-U-MO-READ-2^^0
"BLD",443,"KRN",9.2,"NM",186,0)
XM-U-MO-REPLY^^0
"BLD",443,"KRN",9.2,"NM",187,0)
XM-U-MO-SEND^^0
"BLD",443,"KRN",9.2,"NM",188,0)
XM-U-MO-SEND-2^^0
"BLD",443,"KRN",9.2,"NM",189,0)
XM-U-NEW FEATURES^^0
"BLD",443,"KRN",9.2,"NM",190,0)
XM-U-NEW FEATURES-2^^1^
"BLD",443,"KRN",9.2,"NM",191,0)
XM-U-NEW FEATURES-3^^1^
"BLD",443,"KRN",9.2,"NM",192,0)
XM-U-NEW FEATURES-4^^1^
"BLD",443,"KRN",9.2,"NM",193,0)
XM-U-NEW FEATURES-5^^1^
"BLD",443,"KRN",9.2,"NM",194,0)
XM-U-P-ASK BASKET^^0
"BLD",443,"KRN",9.2,"NM",195,0)
XM-U-P-BANNER^^0
"BLD",443,"KRN",9.2,"NM",196,0)
XM-U-P-DELIVERY BASKET PRIV^^0
"BLD",443,"KRN",9.2,"NM",197,0)
XM-U-P-EDITOR^^0
"BLD",443,"KRN",9.2,"NM",198,0)
XM-U-P-FILTER^^0
"BLD",443,"KRN",9.2,"NM",199,0)
XM-U-P-FILTER ACTIONS^^0
"BLD",443,"KRN",9.2,"NM",200,0)
XM-U-P-FILTER CRITERIA^^0
"BLD",443,"KRN",9.2,"NM",201,0)
XM-U-P-FILTER CRITERIA-2^^0
"BLD",443,"KRN",9.2,"NM",202,0)
XM-U-P-FILTER ORDER^^0
"BLD",443,"KRN",9.2,"NM",203,0)
XM-U-P-FILTER-2^^0
"BLD",443,"KRN",9.2,"NM",204,0)
XM-U-P-FILTER-3^^0
"BLD",443,"KRN",9.2,"NM",205,0)
XM-U-P-FORWARDING ADDRESS^^0
"BLD",443,"KRN",9.2,"NM",206,0)
XM-U-P-GROUP ENROLL^^0
"BLD",443,"KRN",9.2,"NM",207,0)
XM-U-P-GROUP ENROLL-2^^0
"BLD",443,"KRN",9.2,"NM",208,0)
XM-U-P-GROUP PERSONAL^^0
"BLD",443,"KRN",9.2,"NM",209,0)
XM-U-P-GROUP PERSONAL-2^^0
"BLD",443,"KRN",9.2,"NM",210,0)
XM-U-P-INSTITUTION^^0
"BLD",443,"KRN",9.2,"NM",211,0)
XM-U-P-INTRODUCTION^^0
"BLD",443,"KRN",9.2,"NM",212,0)
XM-U-P-MESSAGE ACTION DEFAULT^^0
"BLD",443,"KRN",9.2,"NM",213,0)
XM-U-P-MESSAGE ORDER^^0
"BLD",443,"KRN",9.2,"NM",214,0)
XM-U-P-NETWORK SIGNATURE^^0
"BLD",443,"KRN",9.2,"NM",215,0)
XM-U-P-NEW MESSAGES OPTION^^0
"BLD",443,"KRN",9.2,"NM",216,0)
XM-U-P-NEW MESSAGES READ ORDER^^0
"BLD",443,"KRN",9.2,"NM",217,0)
XM-U-P-OFFICE INFO^^0
"BLD",443,"KRN",9.2,"NM",218,0)
XM-U-P-OPTIONS^^0
"BLD",443,"KRN",9.2,"NM",219,0)
XM-U-P-OPTIONS-2^^0
"BLD",443,"KRN",9.2,"NM",220,0)
XM-U-P-OPTIONS-3^^0
"BLD",443,"KRN",9.2,"NM",221,0)
XM-U-P-OPTIONS-4^^0
"BLD",443,"KRN",9.2,"NM",222,0)
XM-U-P-P-MESSAGE FROM^^0
"BLD",443,"KRN",9.2,"NM",223,0)
XM-U-P-PERSONAL PREFERENCES^^0
"BLD",443,"KRN",9.2,"NM",224,0)
XM-U-P-PRIORITY FLAG^^0
"BLD",443,"KRN",9.2,"NM",225,0)
XM-U-P-PRIORITY PROMPT^^0
"BLD",443,"KRN",9.2,"NM",226,0)
XM-U-P-PRIORITY PROMPT-2^^0
"BLD",443,"KRN",9.2,"NM",227,0)
XM-U-P-READ NEW MSGS BSKT^^0
"BLD",443,"KRN",9.2,"NM",228,0)
XM-U-P-READER DEFAULT^^0
"BLD",443,"KRN",9.2,"NM",229,0)
XM-U-P-READER PROMPT^^0
"BLD",443,"KRN",9.2,"NM",230,0)
XM-U-P-SHOW MESSAGE PREVIEW^^0
"BLD",443,"KRN",9.2,"NM",231,0)
XM-U-P-SHOW TITLES^^0
"BLD",443,"KRN",9.2,"NM",232,0)
XM-U-P-SURROGATE EDIT^^0
"BLD",443,"KRN",9.2,"NM",233,0)
XM-U-P-SURROGATE READ PRIV^^0
"BLD",443,"KRN",9.2,"NM",234,0)
XM-U-P-SURROGATE WRITE PRIV^^0
"BLD",443,"KRN",9.2,"NM",235,0)
XM-U-Q-CLASSIC LOOKUP ?^^0
"BLD",443,"KRN",9.2,"NM",236,0)
XM-U-Q-CLASSIC LOOKUP ??^^0
"BLD",443,"KRN",9.2,"NM",237,0)
XM-U-Q-REMOTE USER NAME^^0
"BLD",443,"KRN",9.2,"NM",238,0)
XM-U-Q-SEARCH^^0
"BLD",443,"KRN",9.2,"NM",239,0)
XM-U-Q-SEARCH CRITERIA^^0
"BLD",443,"KRN",9.2,"NM",241,0)
XM-U-Q-SEARCH CRITERIA TEXT^^0
"BLD",443,"KRN",9.2,"NM",242,0)
XM-U-Q-SEARCH CRITERIA USERS^^0
"BLD",443,"KRN",9.2,"NM",243,0)
XM-U-Q-SEARCH CRITERIA-2^^0
"BLD",443,"KRN",9.2,"NM",244,0)
XM-U-Q-SEARCH CRITERIA-3^^1^
"BLD",443,"KRN",9.2,"NM",245,0)
XM-U-Q-SEARCH CRITERIA-4^^1^
"BLD",443,"KRN",9.2,"NM",246,0)
XM-U-Q-SEARCH CRITERIA-5^^1^
"BLD",443,"KRN",9.2,"NM",247,0)
XM-U-Q-SEARCH MAILBOX^^0
"BLD",443,"KRN",9.2,"NM",248,0)
XM-U-Q-SEARCH SYSTEM^^0
"BLD",443,"KRN",9.2,"NM",249,0)
XM-U-R-NEW LIST ALL^^0
"BLD",443,"KRN",9.2,"NM",250,0)
XM-U-R-NEW LIST BASKETS^^0
"BLD",443,"KRN",9.2,"NM",251,0)
XM-U-R-NEW LIST PRIORITY^^0
"BLD",443,"KRN",9.2,"NM",252,0)
XM-U-R-NEW PRINT^^0
"BLD",443,"KRN",9.2,"NM",253,0)
XM-U-R-NEW SCAN^^0
"BLD",443,"KRN",9.2,"NM",254,0)
XM-U-R-READ^^0
"BLD",443,"KRN",9.2,"NM",255,0)
XM-U-R-NEW READ^^0
"BLD",443,"KRN",9.2,"NM",256,0)
XM-U-R-READ NEW^^0
"BLD",443,"KRN",9.2,"NM",257,0)
XM-U-R-READ NEW-2^^0
"BLD",443,"KRN",9.2,"NM",258,0)
XM-U-R-READ-2^^0
"BLD",443,"KRN",9.2,"NM",259,0)
XM-U-R-READ-3^^0
"BLD",443,"KRN",9.2,"NM",260,0)
XMBULL+^^1^
"BLD",443,"KRN",9.2,"NM",261,0)
XMDOMAIN+^^1^
"BLD",443,"KRN",9.2,"NM",262,0)
XMFLAGS+^^1^
"BLD",443,"KRN",9.2,"NM",263,0)
XMHELP^^0
"BLD",443,"KRN",9.2,"NM",264,0)
XMHELP-MANUAL^^0
"BLD",443,"KRN",9.2,"NM",265,0)
XMKEYS+^^1^
"BLD",443,"KRN",9.2,"NM",266,0)
XMMG-BULLETIN-MANY-MESSAGES^^1^
"BLD",443,"KRN",9.2,"NM",267,0)
XMMG-LOCAL-DELIVERY-STATISTICS^^1^
"BLD",443,"KRN",9.2,"NM",268,0)
XMMG-LOCAL-FIRST READ^^1^
"BLD",443,"KRN",9.2,"NM",269,0)
XMMG-LOCAL-FORWARD^^1^
"BLD",443,"KRN",9.2,"NM",270,0)
XMMG-LOCAL-INTEGRITY^^1^
"BLD",443,"KRN",9.2,"NM",271,0)
XMMG-LOCAL-LARGE-REPORT^^1^
"BLD",443,"KRN",9.2,"NM",272,0)
XMMG-NEW-FEATURES^^1^
"BLD",443,"KRN",9.2,"NM",273,0)
XMMG-NEW-FEATURES-7.1^^1^
"BLD",443,"KRN",9.2,"NM",274,0)
XMMG-NEW3.1FEATURES^^1^
"BLD",443,"KRN",9.2,"NM",275,0)
XMMG-POSTMASTER-BULLETINS^^1^
"BLD",443,"KRN",9.2,"NM",276,0)
XMNET-BLOB-HARDWARE^^0
"BLD",443,"KRN",9.2,"NM",277,0)
XMNET-BLOB-NETWORK^^0
"BLD",443,"KRN",9.2,"NM",278,0)
XMNET-CASE-SENSITIVE^^1^
"BLD",443,"KRN",9.2,"NM",279,0)
XMNET-DIRECTORY-REQUEST-FLAG^^1^
"BLD",443,"KRN",9.2,"NM",280,0)
XMNET-ERROR-COMMAND^^1^
"BLD",443,"KRN",9.2,"NM",281,0)
XMNET-FORWARD-ADDRESS^^1^
"BLD",443,"KRN",9.2,"NM",282,0)
XMNET-KERNEL-SITE-PARAMETERS^^1^
"BLD",443,"KRN",9.2,"NM",283,0)
XMNET-FTP-COMPONENTS^^0
"BLD",443,"KRN",9.2,"NM",284,0)
XMNET-FTP-REC-NETWORK-LOCATION^^0
"BLD",443,"KRN",9.2,"NM",285,0)
XMNET-LPC-CHECKSUM^^1^
"BLD",443,"KRN",9.2,"NM",286,0)
XMNET-MAIL-NAME^^1^
"BLD",443,"KRN",9.2,"NM",287,0)
XMNET-MAILLINK^^1^
"BLD",443,"KRN",9.2,"NM",288,0)
XMNET-MAILLINK-ADDRESS^^1^
"BLD",443,"KRN",9.2,"NM",289,0)
XMNET-MAX-LINES^^1^
"BLD",443,"KRN",9.2,"NM",290,0)
XMNET-MAX-TCP-CHANNEL^^1^
"BLD",443,"KRN",9.2,"NM",291,0)
XMNET-MULTIMEDIA^^0
"BLD",443,"KRN",9.2,"NM",292,0)
XMNET-MULTIMEDIA-HARDWARE^^0
"BLD",443,"KRN",9.2,"NM",293,0)
XMNET-MULTIMEDIA-OVERVIEW^^0
"BLD",443,"KRN",9.2,"NM",294,0)
XMNET-NET-FEATURES-7.1^^1^
"BLD",443,"KRN",9.2,"NM",295,0)
XMNET-NEW-FEATURES^^1^
"BLD",443,"KRN",9.2,"NM",296,0)
XMNET-NEW-FEATURES1^^1^
"BLD",443,"KRN",9.2,"NM",297,0)
XMNET-NEW-FEATURES2^^1^
"BLD",443,"KRN",9.2,"NM",298,0)
XMNET-NEW-FEATURES3^^1^
"BLD",443,"KRN",9.2,"NM",299,0)
XMNET-NEW-features^^1^
"BLD",443,"KRN",9.2,"NM",300,0)
XMNET-NEW3.1FEATURES^^1^
"BLD",443,"KRN",9.2,"NM",301,0)
XMNET-SENDER-REJECT^^1^
"BLD",443,"KRN",9.2,"NM",302,0)
XMNET-SIZE-LIMIT^^1^
"BLD",443,"KRN",9.2,"NM",303,0)
XMNET-TCP/IP^^1^
"BLD",443,"KRN",9.2,"NM",304,0)
XMNET-TIME-ZONE^^1^
"BLD",443,"KRN",9.2,"NM",305,0)
XMNETSEND+^^1^
"BLD",443,"KRN",9.2,"NM",306,0)
XMNETWORK*^^1^
"BLD",443,"KRN",9.2,"NM",307,0)
XMPACKMAN^^1^
"BLD",443,"KRN",9.2,"NM",308,0)
XMPARENT+^^1^
"BLD",443,"KRN",9.2,"NM",309,0)
XMPHYSLINK^^1^
"BLD",443,"KRN",9.2,"NM",310,0)
XMPOLL+^^1^
"BLD",443,"KRN",9.2,"NM",311,0)
XMQUERY+^^1^
"BLD",443,"KRN",9.2,"NM",312,0)
XMQUEUE+^^1^
"BLD",443,"KRN",9.2,"NM",313,0)
XMRELAY+^^1^
"BLD",443,"KRN",9.2,"NM",314,0)
XMSCRIPT+^^1^
"BLD",443,"KRN",9.2,"NM",315,0)
XMSUBORDINATE+^^1^
"BLD",443,"KRN",9.2,"NM",316,0)
XMTALK^^1^
"BLD",443,"KRN",9.2,"NM",317,0)
XMTALK-CAPTURE^^1^
"BLD",443,"KRN",9.2,"NM",318,0)
XMTALK-END^^1^
"BLD",443,"KRN",9.2,"NM",319,0)
XMTALK-KERMIT^^1^
"BLD",443,"KRN",9.2,"NM",320,0)
XMTALK-RETURN^^1^
"BLD",443,"KRN",9.2,"NM",321,0)
XMTALK-USER^^1^
"BLD",443,"KRN",9.2,"NM",322,0)
XMTROUBLE+^^1^
"BLD",443,"KRN",9.2,"NM",323,0)
XMTURN+^^1^
"BLD",443,"KRN",9.2,"NM",324,0)
XMUT-%ZISL-SEND^^1^
"BLD",443,"KRN",9.2,"NM",325,0)
XMUT-INTEGRITY^^1^
"BLD",443,"KRN",9.2,"NM",326,0)
XMUT-REC-DEL^^1^
"BLD",443,"KRN",9.2,"NM",327,0)
XMUT-REC-FIND^^1^
"BLD",443,"KRN",9.2,"NM",328,0)
XMUT-REC-LIST^^1^
"BLD",443,"KRN",9.2,"NM",329,0)
XMUT-RECOVER MESSAGES^^1^
"BLD",443,"KRN",9.2,"NM",330,0)
XMUT-TAPE-TRANSMISSION^^1^
"BLD",443,"KRN",9.2,"NM",331,0)
XMUT4-AUTOPURGE^^1^
"BLD",443,"KRN",9.2,"NM",332,0)
XMVALID+^^1^
"BLD",443,"KRN",9.2,"NM",333,0)
XM-OUTPUT^^1^
"BLD",443,"KRN",9.2,"NM",334,0)
XM-U-Q-CLASSIC LOOKUP^^1^
"BLD",443,"KRN",9.2,"NM",335,0)
XM-U-Q-CLASSIC LOOKUP-2^^1^
"BLD",443,"KRN",9.2,"NM",336,0)
XMS-USING A FORWARDING ADDRESS^^1^
"BLD",443,"KRN",9.2,"NM",337,0)
XM-MASTER^^0
"BLD",443,"KRN",9.2,"NM",338,0)
XM-OUPUT^^1^
"BLD",443,"KRN",9.2,"NM",339,0)
XM-U-Q-SEARCH CRITERIA DATE^^0
"BLD",443,"KRN",9.2,"NM",340,0)
XM-U-M-CLOSED^^0
"BLD",443,"KRN",9.2,"NM",341,0)
XM-U-M-INFO ONLY^^0
"BLD",443,"KRN",9.2,"NM",342,0)
XM-U-M-PRIORITY SEND^^0
"BLD",443,"KRN",9.2,"NM","B","XM-BACKGROUND-FILER",1)

"BLD",443,"KRN",9.2,"NM","B","XM-I-C-TALKMAN",2)

"BLD",443,"KRN",9.2,"NM","B","XM-I-C-TALKMAN CAPTURE",3)

"BLD",443,"KRN",9.2,"NM","B","XM-I-C-TALKMAN END",4)

"BLD",443,"KRN",9.2,"NM","B","XM-I-D-RECOVER MSGS",5)

"BLD",443,"KRN",9.2,"NM","B","XM-I-D-RECOVER MSGS-FIND",6)

"BLD",443,"KRN",9.2,"NM","B","XM-I-D-RECOVER MSGS-LIST",7)

"BLD",443,"KRN",9.2,"NM","B","XM-I-D-RECOVER MSGS-PUT",8)

"BLD",443,"KRN",9.2,"NM","B","XM-I-N-BULLETINS",9)

"BLD",443,"KRN",9.2,"NM","B","XM-I-N-DOMAIN FILE",10)

"BLD",443,"KRN",9.2,"NM","B","XM-I-N-DOMAIN FILE-ADDRESSING",11)

"BLD",443,"KRN",9.2,"NM","B","XM-I-N-DOMAIN FILE-CONNECT",12)

"BLD",443,"KRN",9.2,"NM","B","XM-I-N-DOMAIN FILE-CONNECT-2",13)

"BLD",443,"KRN",9.2,"NM","B","XM-I-N-DOMAIN FILE-FLAGS",14)

"BLD",443,"KRN",9.2,"NM","B","XM-I-N-DOMAIN FILE-SESSION",15)

"BLD",443,"KRN",9.2,"NM","B","XM-I-N-DOMAIN FILE-TURN",16)

"BLD",443,"KRN",9.2,"NM","B","XM-I-N-DOMAIN FILE-VALIDATE",17)

"BLD",443,"KRN",9.2,"NM","B","XM-I-N-NETWORK",18)

"BLD",443,"KRN",9.2,"NM","B","XM-I-N-XMIT PLAY",19)

"BLD",443,"KRN",9.2,"NM","B","XM-I-N-XMIT POLL",20)

"BLD",443,"KRN",9.2,"NM","B","XM-I-N-XMIT QUEUES",21)

"BLD",443,"KRN",9.2,"NM","B","XM-I-N-XMIT SCHEDULE TASK",22)

"BLD",443,"KRN",9.2,"NM","B","XM-I-N-XMIT TAPE",23)

"BLD",443,"KRN",9.2,"NM","B","XM-I-N-XMIT TASK",24)

"BLD",443,"KRN",9.2,"NM","B","XM-I-N-XMIT TASK-2",25)

"BLD",443,"KRN",9.2,"NM","B","XM-I-N-XMIT UCI",26)

"BLD",443,"KRN",9.2,"NM","B","XM-I-NEW FEATURES",27)

"BLD",443,"KRN",9.2,"NM","B","XM-I-S-BIG GROUP SIZE",28)

"BLD",443,"KRN",9.2,"NM","B","XM-I-S-MAX DIGITS FOR MSG NUM",29)

"BLD",443,"KRN",9.2,"NM","B","XM-I-S-MESSAGE LINE LIMIT",30)

"BLD",443,"KRN",9.2,"NM","B","XM-I-S-SITE PARAMETERS",31)

"BLD",443,"KRN",9.2,"NM","B","XM-I-S-SITE PARAMETERS-DISK",32)

"BLD",443,"KRN",9.2,"NM","B","XM-I-S-SITE PARAMETERS-ID",33)

"BLD",443,"KRN",9.2,"NM","B","XM-I-S-SITE PARAMETERS-LOCAL",34)

"BLD",443,"KRN",9.2,"NM","B","XM-I-S-SITE PARAMETERS-REMOTE",35)

"BLD",443,"KRN",9.2,"NM","B","XM-I-S-SITE PARAMETERS-USER",36)

"BLD",443,"KRN",9.2,"NM","B","XM-I-S-SITE PARAMETERS-USER-2",37)

"BLD",443,"KRN",9.2,"NM","B","XM-IN-BASKET-PURGE",38)

"BLD",443,"KRN",9.2,"NM","B","XM-IN-BASKET-PURGE-1",39)

"BLD",443,"KRN",9.2,"NM","B","XM-IN-BASKET-PURGE-2",40)

"BLD",443,"KRN",9.2,"NM","B","XM-IN-BASKET-PURGE-3",41)

"BLD",443,"KRN",9.2,"NM","B","XM-LOCAL-LAST-SIGN-ON",42)

"BLD",443,"KRN",9.2,"NM","B","XM-MASTER",337)

"BLD",443,"KRN",9.2,"NM","B","XM-OUPUT",338)

"BLD",443,"KRN",9.2,"NM","B","XM-OUTPUT",333)

"BLD",443,"KRN",9.2,"NM","B","XM-U-A-ADDRESS",44)

"BLD",443,"KRN",9.2,"NM","B","XM-U-A-CC",45)

"BLD",443,"KRN",9.2,"NM","B","XM-U-A-GROUP LARGE",46)

"BLD",443,"KRN",9.2,"NM","B","XM-U-A-GROUP LARGE-2",47)

"BLD",443,"KRN",9.2,"NM","B","XM-U-A-INFO ONLY",48)

"BLD",443,"KRN",9.2,"NM","B","XM-U-A-LOCAL USER NAME",49)

"BLD",443,"KRN",9.2,"NM","B","XM-U-A-LOCAL USER NAME-2",50)

"BLD",443,"KRN",9.2,"NM","B","XM-U-A-STAGGER DELIVERY",51)

"BLD",443,"KRN",9.2,"NM","B","XM-U-A-STAGGER DELIVERY-2",52)

"BLD",443,"KRN",9.2,"NM","B","XM-U-B-BASKET CONTENTS LIST",53)

"BLD",443,"KRN",9.2,"NM","B","XM-U-B-BASKET NAME",54)

"BLD",443,"KRN",9.2,"NM","B","XM-U-B-BASKET NAME CHANGE",55)

"BLD",443,"KRN",9.2,"NM","B","XM-U-B-BASKET SELECT",56)

"BLD",443,"KRN",9.2,"NM","B","XM-U-B-CHANGE DETAIL",57)

"BLD",443,"KRN",9.2,"NM","B","XM-U-B-FILTER",58)

"BLD",443,"KRN",9.2,"NM","B","XM-U-B-NAVIGATE CLASSIC",59)

"BLD",443,"KRN",9.2,"NM","B","XM-U-B-NAVIGATE FULL SCREEN",60)

"BLD",443,"KRN",9.2,"NM","B","XM-U-B-NEW MAIL LIST",61)

"BLD",443,"KRN",9.2,"NM","B","XM-U-B-OPPOSITE TOGGLE",62)

"BLD",443,"KRN",9.2,"NM","B","XM-U-B-READER",63)

"BLD",443,"KRN",9.2,"NM","B","XM-U-B-READER CLASSIC",64)

"BLD",443,"KRN",9.2,"NM","B","XM-U-B-READER DETAILED",65)

"BLD",443,"KRN",9.2,"NM","B","XM-U-B-READER DETAILED LIST",66)

"BLD",443,"KRN",9.2,"NM","B","XM-U-B-READER DIFF",67)

"BLD",443,"KRN",9.2,"NM","B","XM-U-B-READER DIFF-2",68)

"BLD",443,"KRN",9.2,"NM","B","XM-U-B-READER DIFF-3",69)

"BLD",443,"KRN",9.2,"NM","B","XM-U-B-READER FULL SCREEN",70)

"BLD",443,"KRN",9.2,"NM","B","XM-U-B-READER SUMMARY",71)

"BLD",443,"KRN",9.2,"NM","B","XM-U-B-RESEQUENCE MESSAGES",72)

"BLD",443,"KRN",9.2,"NM","B","XM-U-B-XMIT PRIORITY TOGGLE",73)

"BLD",443,"KRN",9.2,"NM","B","XM-U-B-XMIT PRIORITY TOGGLE-2",74)

"BLD",443,"KRN",9.2,"NM","B","XM-U-B-ZOOM TOGGLE",75)

"BLD",443,"KRN",9.2,"NM","B","XM-U-BO-CLASSIC",76)

"BLD",443,"KRN",9.2,"NM","B","XM-U-BO-CLASSIC-2",77)

"BLD",443,"KRN",9.2,"NM","B","XM-U-BO-FULL SCREEN",78)

"BLD",443,"KRN",9.2,"NM","B","XM-U-BO-FULL SCREEN LIST",79)

"BLD",443,"KRN",9.2,"NM","B","XM-U-BO-FULL SCREEN-2",80)

"BLD",443,"KRN",9.2,"NM","B","XM-U-H-GROUP",81)

"BLD",443,"KRN",9.2,"NM","B","XM-U-H-GROUP-2",82)

"BLD",443,"KRN",9.2,"NM","B","XM-U-H-GROUP-3",83)

"BLD",443,"KRN",9.2,"NM","B","XM-U-H-GROUP-4",84)

"BLD",443,"KRN",9.2,"NM","B","XM-U-H-Q DELETE",85)

"BLD",443,"KRN",9.2,"NM","B","XM-U-H-Q DISAPPEARED",86)

"BLD",443,"KRN",9.2,"NM","B","XM-U-H-Q INTERRUPT",87)

"BLD",443,"KRN",9.2,"NM","B","XM-U-H-Q LOOKUP",88)

"BLD",443,"KRN",9.2,"NM","B","XM-U-H-Q RECALL",89)

"BLD",443,"KRN",9.2,"NM","B","XM-U-H-Q REMOVE",90)

"BLD",443,"KRN",9.2,"NM","B","XM-U-H-Q REPLIES",91)

"BLD",443,"KRN",9.2,"NM","B","XM-U-H-QUESTIONS",92)

"BLD",443,"KRN",9.2,"NM","B","XM-U-H-USER",93)

"BLD",443,"KRN",9.2,"NM","B","XM-U-I-EDITOR FM LINE",94)

"BLD",443,"KRN",9.2,"NM","B","XM-U-I-EDITOR FM SCREEN",95)

"BLD",443,"KRN",9.2,"NM","B","XM-U-I-GROUP",96)

"BLD",443,"KRN",9.2,"NM","B","XM-U-I-GROUP COORDINATOR",97)

"BLD",443,"KRN",9.2,"NM","B","XM-U-I-GROUP MEMBER",98)

"BLD",443,"KRN",9.2,"NM","B","XM-U-I-GROUP-2",99)

"BLD",443,"KRN",9.2,"NM","B","XM-U-I-SHARED MAIL",100)

"BLD",443,"KRN",9.2,"NM","B","XM-U-I-SURROGATE",101)

"BLD",443,"KRN",9.2,"NM","B","XM-U-I-SURROGATE BECOME",102)

"BLD",443,"KRN",9.2,"NM","B","XM-U-I-SURROGATE-2",103)

"BLD",443,"KRN",9.2,"NM","B","XM-U-I-SURROGATE-3",104)

"BLD",443,"KRN",9.2,"NM","B","XM-U-I-SURROGATE-4",105)

"BLD",443,"KRN",9.2,"NM","B","XM-U-K-PACKMAN",106)

"BLD",443,"KRN",9.2,"NM","B","XM-U-K-PACKMAN COMPARE",107)

"BLD",443,"KRN",9.2,"NM","B","XM-U-K-PACKMAN INSTALL",108)

"BLD",443,"KRN",9.2,"NM","B","XM-U-K-PACKMAN LOAD GLOBALS",109)

"BLD",443,"KRN",9.2,"NM","B","XM-U-K-PACKMAN LOAD PACKAGE",110)

"BLD",443,"KRN",9.2,"NM","B","XM-U-K-PACKMAN LOAD ROUTINES",111)

"BLD",443,"KRN",9.2,"NM","B","XM-U-K-PACKMAN PRINT",112)

"BLD",443,"KRN",9.2,"NM","B","XM-U-K-PACKMAN SUMMARIZE",113)

"BLD",443,"KRN",9.2,"NM","B","XM-U-M-ANSWER",114)

"BLD",443,"KRN",9.2,"NM","B","XM-U-M-BACKUP",115)

"BLD",443,"KRN",9.2,"NM","B","XM-U-M-BACKUP BEFORE SENDING",116)

"BLD",443,"KRN",9.2,"NM","B","XM-U-M-BROWSER",117)

"BLD",443,"KRN",9.2,"NM","B","XM-U-M-CHOOSE RANGE",118)

"BLD",443,"KRN",9.2,"NM","B","XM-U-M-CHOOSE RESPONSES",119)

"BLD",443,"KRN",9.2,"NM","B","XM-U-M-CHOOSE SELECT",120)

"BLD",443,"KRN",9.2,"NM","B","XM-U-M-CHOOSE SELECT-2",121)

"BLD",443,"KRN",9.2,"NM","B","XM-U-M-CLOSED",340)

"BLD",443,"KRN",9.2,"NM","B","XM-U-M-CONFIDENTIAL",123)

"BLD",443,"KRN",9.2,"NM","B","XM-U-M-CONFIRM RECEIPT",124)

"BLD",443,"KRN",9.2,"NM","B","XM-U-M-COPY",125)

"BLD",443,"KRN",9.2,"NM","B","XM-U-M-COPY-2",126)

"BLD",443,"KRN",9.2,"NM","B","XM-U-M-DELETE",127)

"BLD",443,"KRN",9.2,"NM","B","XM-U-M-DELETE-2",128)

"BLD",443,"KRN",9.2,"NM","B","XM-U-M-DELETE-3",129)

"BLD",443,"KRN",9.2,"NM","B","XM-U-M-DELIVERY BASKET SET",130)

"BLD",443,"KRN",9.2,"NM","B","XM-U-M-EDIT RECIPIENTS",131)

"BLD",443,"KRN",9.2,"NM","B","XM-U-M-EDIT SUBJECT",132)

"BLD",443,"KRN",9.2,"NM","B","XM-U-M-EDIT TEXT",133)

"BLD",443,"KRN",9.2,"NM","B","XM-U-M-FORWARD",134)

"BLD",443,"KRN",9.2,"NM","B","XM-U-M-FORWARD-2",135)

"BLD",443,"KRN",9.2,"NM","B","XM-U-M-INCLUDE MESSAGE",136)

"BLD",443,"KRN",9.2,"NM","B","XM-U-M-INFO ONLY",341)

"BLD",443,"KRN",9.2,"NM","B","XM-U-M-LATER",138)

"BLD",443,"KRN",9.2,"NM","B","XM-U-M-LATER-2",139)

"BLD",443,"KRN",9.2,"NM","B","XM-U-M-LATER-3",140)

"BLD",443,"KRN",9.2,"NM","B","XM-U-M-LATERED MESSAGE CHANGE",141)

"BLD",443,"KRN",9.2,"NM","B","XM-U-M-LATERED MESSAGE REPORT",142)

"BLD",443,"KRN",9.2,"NM","B","XM-U-M-MESSAGE HEADER",143)

"BLD",443,"KRN",9.2,"NM","B","XM-U-M-NETWORK SIGNATURE",144)

"BLD",443,"KRN",9.2,"NM","B","XM-U-M-NEW",145)

"BLD",443,"KRN",9.2,"NM","B","XM-U-M-NEW-2",146)

"BLD",443,"KRN",9.2,"NM","B","XM-U-M-PRINT",147)

"BLD",443,"KRN",9.2,"NM","B","XM-U-M-PRINT DEVICE P-MESSAGE",148)

"BLD",443,"KRN",9.2,"NM","B","XM-U-M-PRINT HEADER",149)

"BLD",443,"KRN",9.2,"NM","B","XM-U-M-PRINT NO HEADER",150)

"BLD",443,"KRN",9.2,"NM","B","XM-U-M-PRINT NO HEADER-2",151)

"BLD",443,"KRN",9.2,"NM","B","XM-U-M-PRINT NO HEADER-3",152)

"BLD",443,"KRN",9.2,"NM","B","XM-U-M-PRINT-2",153)

"BLD",443,"KRN",9.2,"NM","B","XM-U-M-PRIORITY SEND",342)

"BLD",443,"KRN",9.2,"NM","B","XM-U-M-PRIORITY TOGGLE",155)

"BLD",443,"KRN",9.2,"NM","B","XM-U-M-QUERY",156)

"BLD",443,"KRN",9.2,"NM","B","XM-U-M-QUERY DETAILED",157)

"BLD",443,"KRN",9.2,"NM","B","XM-U-M-QUERY GENERAL",158)

"BLD",443,"KRN",9.2,"NM","B","XM-U-M-QUERY INFO BASIC",159)

"BLD",443,"KRN",9.2,"NM","B","XM-U-M-QUERY INFO LOCAL",160)

"BLD",443,"KRN",9.2,"NM","B","XM-U-M-QUERY INFO REMOTE",161)

"BLD",443,"KRN",9.2,"NM","B","XM-U-M-QUERY NETWORK",162)

"BLD",443,"KRN",9.2,"NM","B","XM-U-M-QUERY NETWORK-2",163)

"BLD",443,"KRN",9.2,"NM","B","XM-U-M-QUERY SPECIFIC",164)

"BLD",443,"KRN",9.2,"NM","B","XM-U-M-QUERY-2",165)

"BLD",443,"KRN",9.2,"NM","B","XM-U-M-REPLY",166)

"BLD",443,"KRN",9.2,"NM","B","XM-U-M-REPLY INCLUDE",167)

"BLD",443,"KRN",9.2,"NM","B","XM-U-M-REPLY-2",168)

"BLD",443,"KRN",9.2,"NM","B","XM-U-M-SAVE",169)

"BLD",443,"KRN",9.2,"NM","B","XM-U-M-SCRAMBLE",170)

"BLD",443,"KRN",9.2,"NM","B","XM-U-M-SCRAMBLE HINT",171)

"BLD",443,"KRN",9.2,"NM","B","XM-U-M-SCRAMBLE PASSWORD",172)

"BLD",443,"KRN",9.2,"NM","B","XM-U-M-SEND",173)

"BLD",443,"KRN",9.2,"NM","B","XM-U-M-TERMINATE",174)

"BLD",443,"KRN",9.2,"NM","B","XM-U-M-TERMINATE-2",175)

"BLD",443,"KRN",9.2,"NM","B","XM-U-M-TRANSMIT LATER",176)

"BLD",443,"KRN",9.2,"NM","B","XM-U-M-TRANSMIT NOW",177)

"BLD",443,"KRN",9.2,"NM","B","XM-U-M-VAPORIZE DATE EDIT",178)

"BLD",443,"KRN",9.2,"NM","B","XM-U-M-VAPORIZE DATE EDIT-2",179)

"BLD",443,"KRN",9.2,"NM","B","XM-U-M-VAPORIZE DATE SEND",180)

"BLD",443,"KRN",9.2,"NM","B","XM-U-M-WRITE",181)

"BLD",443,"KRN",9.2,"NM","B","XM-U-M-WRITE-2",182)

"BLD",443,"KRN",9.2,"NM","B","XM-U-MO-EDIT",183)

"BLD",443,"KRN",9.2,"NM","B","XM-U-MO-READ",184)

"BLD",443,"KRN",9.2,"NM","B","XM-U-MO-READ-2",185)

"BLD",443,"KRN",9.2,"NM","B","XM-U-MO-REPLY",186)

"BLD",443,"KRN",9.2,"NM","B","XM-U-MO-SEND",187)

"BLD",443,"KRN",9.2,"NM","B","XM-U-MO-SEND-2",188)

"BLD",443,"KRN",9.2,"NM","B","XM-U-NEW FEATURES",189)

"BLD",443,"KRN",9.2,"NM","B","XM-U-NEW FEATURES-2",190)

"BLD",443,"KRN",9.2,"NM","B","XM-U-NEW FEATURES-3",191)

"BLD",443,"KRN",9.2,"NM","B","XM-U-NEW FEATURES-4",192)

"BLD",443,"KRN",9.2,"NM","B","XM-U-NEW FEATURES-5",193)

"BLD",443,"KRN",9.2,"NM","B","XM-U-P-ASK BASKET",194)

"BLD",443,"KRN",9.2,"NM","B","XM-U-P-BANNER",195)

"BLD",443,"KRN",9.2,"NM","B","XM-U-P-DELIVERY BASKET PRIV",196)

"BLD",443,"KRN",9.2,"NM","B","XM-U-P-EDITOR",197)

"BLD",443,"KRN",9.2,"NM","B","XM-U-P-FILTER",198)

"BLD",443,"KRN",9.2,"NM","B","XM-U-P-FILTER ACTIONS",199)

"BLD",443,"KRN",9.2,"NM","B","XM-U-P-FILTER CRITERIA",200)

"BLD",443,"KRN",9.2,"NM","B","XM-U-P-FILTER CRITERIA-2",201)

"BLD",443,"KRN",9.2,"NM","B","XM-U-P-FILTER ORDER",202)

"BLD",443,"KRN",9.2,"NM","B","XM-U-P-FILTER-2",203)

"BLD",443,"KRN",9.2,"NM","B","XM-U-P-FILTER-3",204)

"BLD",443,"KRN",9.2,"NM","B","XM-U-P-FORWARDING ADDRESS",205)

"BLD",443,"KRN",9.2,"NM","B","XM-U-P-GROUP ENROLL",206)

"BLD",443,"KRN",9.2,"NM","B","XM-U-P-GROUP ENROLL-2",207)

"BLD",443,"KRN",9.2,"NM","B","XM-U-P-GROUP PERSONAL",208)

"BLD",443,"KRN",9.2,"NM","B","XM-U-P-GROUP PERSONAL-2",209)

"BLD",443,"KRN",9.2,"NM","B","XM-U-P-INSTITUTION",210)

"BLD",443,"KRN",9.2,"NM","B","XM-U-P-INTRODUCTION",211)

"BLD",443,"KRN",9.2,"NM","B","XM-U-P-MESSAGE ACTION DEFAULT",212)

"BLD",443,"KRN",9.2,"NM","B","XM-U-P-MESSAGE ORDER",213)

"BLD",443,"KRN",9.2,"NM","B","XM-U-P-NETWORK SIGNATURE",214)

"BLD",443,"KRN",9.2,"NM","B","XM-U-P-NEW MESSAGES OPTION",215)

"BLD",443,"KRN",9.2,"NM","B","XM-U-P-NEW MESSAGES READ ORDER",216)

"BLD",443,"KRN",9.2,"NM","B","XM-U-P-OFFICE INFO",217)

"BLD",443,"KRN",9.2,"NM","B","XM-U-P-OPTIONS",218)

"BLD",443,"KRN",9.2,"NM","B","XM-U-P-OPTIONS-2",219)

"BLD",443,"KRN",9.2,"NM","B","XM-U-P-OPTIONS-3",220)

"BLD",443,"KRN",9.2,"NM","B","XM-U-P-OPTIONS-4",221)

"BLD",443,"KRN",9.2,"NM","B","XM-U-P-P-MESSAGE FROM",222)

"BLD",443,"KRN",9.2,"NM","B","XM-U-P-PERSONAL PREFERENCES",223)

"BLD",443,"KRN",9.2,"NM","B","XM-U-P-PRIORITY FLAG",224)

"BLD",443,"KRN",9.2,"NM","B","XM-U-P-PRIORITY PROMPT",225)

"BLD",443,"KRN",9.2,"NM","B","XM-U-P-PRIORITY PROMPT-2",226)

"BLD",443,"KRN",9.2,"NM","B","XM-U-P-READ NEW MSGS BSKT",227)

"BLD",443,"KRN",9.2,"NM","B","XM-U-P-READER DEFAULT",228)

"BLD",443,"KRN",9.2,"NM","B","XM-U-P-READER PROMPT",229)

"BLD",443,"KRN",9.2,"NM","B","XM-U-P-SHOW MESSAGE PREVIEW",230)

"BLD",443,"KRN",9.2,"NM","B","XM-U-P-SHOW TITLES",231)

"BLD",443,"KRN",9.2,"NM","B","XM-U-P-SURROGATE EDIT",232)

"BLD",443,"KRN",9.2,"NM","B","XM-U-P-SURROGATE READ PRIV",233)

"BLD",443,"KRN",9.2,"NM","B","XM-U-P-SURROGATE WRITE PRIV",234)

"BLD",443,"KRN",9.2,"NM","B","XM-U-Q-CLASSIC LOOKUP",334)

"BLD",443,"KRN",9.2,"NM","B","XM-U-Q-CLASSIC LOOKUP ?",235)

"BLD",443,"KRN",9.2,"NM","B","XM-U-Q-CLASSIC LOOKUP ??",236)

"BLD",443,"KRN",9.2,"NM","B","XM-U-Q-CLASSIC LOOKUP-2",335)

"BLD",443,"KRN",9.2,"NM","B","XM-U-Q-REMOTE USER NAME",237)

"BLD",443,"KRN",9.2,"NM","B","XM-U-Q-SEARCH",238)

"BLD",443,"KRN",9.2,"NM","B","XM-U-Q-SEARCH CRITERIA",239)

"BLD",443,"KRN",9.2,"NM","B","XM-U-Q-SEARCH CRITERIA DATE",339)

"BLD",443,"KRN",9.2,"NM","B","XM-U-Q-SEARCH CRITERIA TEXT",241)

"BLD",443,"KRN",9.2,"NM","B","XM-U-Q-SEARCH CRITERIA USERS",242)

"BLD",443,"KRN",9.2,"NM","B","XM-U-Q-SEARCH CRITERIA-2",243)

"BLD",443,"KRN",9.2,"NM","B","XM-U-Q-SEARCH CRITERIA-3",244)

"BLD",443,"KRN",9.2,"NM","B","XM-U-Q-SEARCH CRITERIA-4",245)

"BLD",443,"KRN",9.2,"NM","B","XM-U-Q-SEARCH CRITERIA-5",246)

"BLD",443,"KRN",9.2,"NM","B","XM-U-Q-SEARCH MAILBOX",247)

"BLD",443,"KRN",9.2,"NM","B","XM-U-Q-SEARCH SYSTEM",248)

"BLD",443,"KRN",9.2,"NM","B","XM-U-R-NEW LIST ALL",249)

"BLD",443,"KRN",9.2,"NM","B","XM-U-R-NEW LIST BASKETS",250)

"BLD",443,"KRN",9.2,"NM","B","XM-U-R-NEW LIST PRIORITY",251)

"BLD",443,"KRN",9.2,"NM","B","XM-U-R-NEW PRINT",252)

"BLD",443,"KRN",9.2,"NM","B","XM-U-R-NEW READ",255)

"BLD",443,"KRN",9.2,"NM","B","XM-U-R-NEW SCAN",253)

"BLD",443,"KRN",9.2,"NM","B","XM-U-R-READ",254)

"BLD",443,"KRN",9.2,"NM","B","XM-U-R-READ NEW",256)

"BLD",443,"KRN",9.2,"NM","B","XM-U-R-READ NEW-2",257)

"BLD",443,"KRN",9.2,"NM","B","XM-U-R-READ-2",258)

"BLD",443,"KRN",9.2,"NM","B","XM-U-R-READ-3",259)

"BLD",443,"KRN",9.2,"NM","B","XMBULL+",260)

"BLD",443,"KRN",9.2,"NM","B","XMDOMAIN+",261)

"BLD",443,"KRN",9.2,"NM","B","XMFLAGS+",262)

"BLD",443,"KRN",9.2,"NM","B","XMHELP",263)

"BLD",443,"KRN",9.2,"NM","B","XMHELP-MANUAL",264)

"BLD",443,"KRN",9.2,"NM","B","XMKEYS+",265)

"BLD",443,"KRN",9.2,"NM","B","XMMG-BULLETIN-MANY-MESSAGES",266)

"BLD",443,"KRN",9.2,"NM","B","XMMG-LOCAL-DELIVERY-STATISTICS",267)

"BLD",443,"KRN",9.2,"NM","B","XMMG-LOCAL-FIRST READ",268)

"BLD",443,"KRN",9.2,"NM","B","XMMG-LOCAL-FORWARD",269)

"BLD",443,"KRN",9.2,"NM","B","XMMG-LOCAL-INTEGRITY",270)

"BLD",443,"KRN",9.2,"NM","B","XMMG-LOCAL-LARGE-REPORT",271)

"BLD",443,"KRN",9.2,"NM","B","XMMG-NEW-FEATURES",272)

"BLD",443,"KRN",9.2,"NM","B","XMMG-NEW-FEATURES-7.1",273)

"BLD",443,"KRN",9.2,"NM","B","XMMG-NEW3.1FEATURES",274)

"BLD",443,"KRN",9.2,"NM","B","XMMG-POSTMASTER-BULLETINS",275)

"BLD",443,"KRN",9.2,"NM","B","XMNET-BLOB-HARDWARE",276)

"BLD",443,"KRN",9.2,"NM","B","XMNET-BLOB-NETWORK",277)

"BLD",443,"KRN",9.2,"NM","B","XMNET-CASE-SENSITIVE",278)

"BLD",443,"KRN",9.2,"NM","B","XMNET-DIRECTORY-REQUEST-FLAG",279)

"BLD",443,"KRN",9.2,"NM","B","XMNET-ERROR-COMMAND",280)

"BLD",443,"KRN",9.2,"NM","B","XMNET-FORWARD-ADDRESS",281)

"BLD",443,"KRN",9.2,"NM","B","XMNET-FTP-COMPONENTS",283)

"BLD",443,"KRN",9.2,"NM","B","XMNET-FTP-REC-NETWORK-LOCATION",284)

"BLD",443,"KRN",9.2,"NM","B","XMNET-KERNEL-SITE-PARAMETERS",282)

"BLD",443,"KRN",9.2,"NM","B","XMNET-LPC-CHECKSUM",285)

"BLD",443,"KRN",9.2,"NM","B","XMNET-MAIL-NAME",286)

"BLD",443,"KRN",9.2,"NM","B","XMNET-MAILLINK",287)

"BLD",443,"KRN",9.2,"NM","B","XMNET-MAILLINK-ADDRESS",288)

"BLD",443,"KRN",9.2,"NM","B","XMNET-MAX-LINES",289)

"BLD",443,"KRN",9.2,"NM","B","XMNET-MAX-TCP-CHANNEL",290)

"BLD",443,"KRN",9.2,"NM","B","XMNET-MULTIMEDIA",291)

"BLD",443,"KRN",9.2,"NM","B","XMNET-MULTIMEDIA-HARDWARE",292)

"BLD",443,"KRN",9.2,"NM","B","XMNET-MULTIMEDIA-OVERVIEW",293)

"BLD",443,"KRN",9.2,"NM","B","XMNET-NET-FEATURES-7.1",294)

"BLD",443,"KRN",9.2,"NM","B","XMNET-NEW-FEATURES",295)

"BLD",443,"KRN",9.2,"NM","B","XMNET-NEW-FEATURES1",296)

"BLD",443,"KRN",9.2,"NM","B","XMNET-NEW-FEATURES2",297)

"BLD",443,"KRN",9.2,"NM","B","XMNET-NEW-FEATURES3",298)

"BLD",443,"KRN",9.2,"NM","B","XMNET-NEW-features",299)

"BLD",443,"KRN",9.2,"NM","B","XMNET-NEW3.1FEATURES",300)

"BLD",443,"KRN",9.2,"NM","B","XMNET-SENDER-REJECT",301)

"BLD",443,"KRN",9.2,"NM","B","XMNET-SIZE-LIMIT",302)

"BLD",443,"KRN",9.2,"NM","B","XMNET-TCP/IP",303)

"BLD",443,"KRN",9.2,"NM","B","XMNET-TIME-ZONE",304)

"BLD",443,"KRN",9.2,"NM","B","XMNETSEND+",305)

"BLD",443,"KRN",9.2,"NM","B","XMNETWORK*",306)

"BLD",443,"KRN",9.2,"NM","B","XMPACKMAN",307)

"BLD",443,"KRN",9.2,"NM","B","XMPARENT+",308)

"BLD",443,"KRN",9.2,"NM","B","XMPHYSLINK",309)

"BLD",443,"KRN",9.2,"NM","B","XMPOLL+",310)

"BLD",443,"KRN",9.2,"NM","B","XMQUERY+",311)

"BLD",443,"KRN",9.2,"NM","B","XMQUEUE+",312)

"BLD",443,"KRN",9.2,"NM","B","XMRELAY+",313)

"BLD",443,"KRN",9.2,"NM","B","XMS-USING A FORWARDING ADDRESS",336)

"BLD",443,"KRN",9.2,"NM","B","XMSCRIPT+",314)

"BLD",443,"KRN",9.2,"NM","B","XMSUBORDINATE+",315)

"BLD",443,"KRN",9.2,"NM","B","XMTALK",316)

"BLD",443,"KRN",9.2,"NM","B","XMTALK-CAPTURE",317)

"BLD",443,"KRN",9.2,"NM","B","XMTALK-END",318)

"BLD",443,"KRN",9.2,"NM","B","XMTALK-KERMIT",319)

"BLD",443,"KRN",9.2,"NM","B","XMTALK-RETURN",320)

"BLD",443,"KRN",9.2,"NM","B","XMTALK-USER",321)

"BLD",443,"KRN",9.2,"NM","B","XMTROUBLE+",322)

"BLD",443,"KRN",9.2,"NM","B","XMTURN+",323)

"BLD",443,"KRN",9.2,"NM","B","XMUT-%ZISL-SEND",324)

"BLD",443,"KRN",9.2,"NM","B","XMUT-INTEGRITY",325)

"BLD",443,"KRN",9.2,"NM","B","XMUT-REC-DEL",326)

"BLD",443,"KRN",9.2,"NM","B","XMUT-REC-FIND",327)

"BLD",443,"KRN",9.2,"NM","B","XMUT-REC-LIST",328)

"BLD",443,"KRN",9.2,"NM","B","XMUT-RECOVER MESSAGES",329)

"BLD",443,"KRN",9.2,"NM","B","XMUT-TAPE-TRANSMISSION",330)

"BLD",443,"KRN",9.2,"NM","B","XMUT4-AUTOPURGE",331)

"BLD",443,"KRN",9.2,"NM","B","XMVALID+",332)

"BLD",443,"KRN",9.8,0)
9.8
"BLD",443,"KRN",9.8,"NM",0)
^9.68A^389^386
"BLD",443,"KRN",9.8,"NM",1,0)
XMA30^^0^B40089770
"BLD",443,"KRN",9.8,"NM",2,0)
XMB^^0^B12706751
"BLD",443,"KRN",9.8,"NM",3,0)
XMBPOST^^1^
"BLD",443,"KRN",9.8,"NM",4,0)
XMC^^0^B17110255
"BLD",443,"KRN",9.8,"NM",5,0)
XMC1^^0^B47889874
"BLD",443,"KRN",9.8,"NM",6,0)
XMC11^^0^B3776206
"BLD",443,"KRN",9.8,"NM",7,0)
XMC11A^^1^
"BLD",443,"KRN",9.8,"NM",8,0)
XMC1A^^0^B15801874
"BLD",443,"KRN",9.8,"NM",9,0)
XMC1A1^^1^
"BLD",443,"KRN",9.8,"NM",10,0)
XMC1B^^0^B5097848
"BLD",443,"KRN",9.8,"NM",11,0)
XMC2^^1^
"BLD",443,"KRN",9.8,"NM",12,0)
XMC3^^1^
"BLD",443,"KRN",9.8,"NM",13,0)
XMC4^^1^
"BLD",443,"KRN",9.8,"NM",14,0)
XMCB^^0^B12594462
"BLD",443,"KRN",9.8,"NM",15,0)
XMCD^^0^B8363136
"BLD",443,"KRN",9.8,"NM",16,0)
XMCE^^0^B3445836
"BLD",443,"KRN",9.8,"NM",17,0)
XMCP^^0^B5676753
"BLD",443,"KRN",9.8,"NM",18,0)
XMCQ^^0^B12337552
"BLD",443,"KRN",9.8,"NM",19,0)
XMCQA^^0^B21177378
"BLD",443,"KRN",9.8,"NM",20,0)
XMCQH^^0^B4658509
"BLD",443,"KRN",9.8,"NM",21,0)
XMCTLK^^0^B40421145
"BLD",443,"KRN",9.8,"NM",22,0)
XMCTLK0^^1^
"BLD",443,"KRN",9.8,"NM",23,0)
XMCTRAP^^0^B267755
"BLD",443,"KRN",9.8,"NM",24,0)
XMCX^^0^B17138675
"BLD",443,"KRN",9.8,"NM",25,0)
XMCXT^^0^B6029680
"BLD",443,"KRN",9.8,"NM",26,0)
XMCXU^^0^B12784505
"BLD",443,"KRN",9.8,"NM",27,0)
XMDIRSND^^0^B3654840
"BLD",443,"KRN",9.8,"NM",28,0)
XMFAX^^0^B11327342
"BLD",443,"KRN",9.8,"NM",29,0)
XMGAPI1^^0^B32088
"BLD",443,"KRN",9.8,"NM",30,0)
XMHIG^^0^B30287826
"BLD",443,"KRN",9.8,"NM",31,0)
XMHIU^^0^B25238513
"BLD",443,"KRN",9.8,"NM",32,0)
XMJBL^^0^B12292736
"BLD",443,"KRN",9.8,"NM",33,0)
XMJMD^^0^B29661397
"BLD",443,"KRN",9.8,"NM",34,0)
XMJMF2^^0^B36466615
"BLD",443,"KRN",9.8,"NM",35,0)
XMJML^^0^B38830599
"BLD",443,"KRN",9.8,"NM",36,0)
XMJMOR^^0^B82943223
"BLD",443,"KRN",9.8,"NM",37,0)
XMJMORX^^0^B63081012
"BLD",443,"KRN",9.8,"NM",38,0)
XMJMP1^^0^B73787234
"BLD",443,"KRN",9.8,"NM",39,0)
XMJMOI^^0^B72054294
"BLD",443,"KRN",9.8,"NM",40,0)
XMKP^^0^B71100476
"BLD",443,"KRN",9.8,"NM",41,0)
XMKPO^^0^B4343165
"BLD",443,"KRN",9.8,"NM",42,0)
XMKPR^^0^B40462386
"BLD",443,"KRN",9.8,"NM",43,0)
XML^^0^B16315182
"BLD",443,"KRN",9.8,"NM",44,0)
XMLTCP^^0^B4491324
"BLD",443,"KRN",9.8,"NM",45,0)
XMP^^0^B13644218
"BLD",443,"KRN",9.8,"NM",46,0)
XMP3^^0^B19117242
"BLD",443,"KRN",9.8,"NM",47,0)
XMR^^0^B45958212
"BLD",443,"KRN",9.8,"NM",48,0)
XMR0^^1^
"BLD",443,"KRN",9.8,"NM",49,0)
XMR0A^^1^
"BLD",443,"KRN",9.8,"NM",50,0)
XMR0B^^1^
"BLD",443,"KRN",9.8,"NM",51,0)
XMR1^^0^B49978938
"BLD",443,"KRN",9.8,"NM",52,0)
XMR1A^^1^
"BLD",443,"KRN",9.8,"NM",53,0)
XMR2^^0^B5718588
"BLD",443,"KRN",9.8,"NM",54,0)
XMR3^^0^B72491233
"BLD",443,"KRN",9.8,"NM",55,0)
XMR3A^^0^B6907946
"BLD",443,"KRN",9.8,"NM",56,0)
XMR4^^0^B39144591
"BLD",443,"KRN",9.8,"NM",57,0)
XMRENT^^0^B4269431
"BLD",443,"KRN",9.8,"NM",58,0)
XMRPCTS0^^0^B13546596
"BLD",443,"KRN",9.8,"NM",59,0)
XMRTCP^^0^B9528522
"BLD",443,"KRN",9.8,"NM",60,0)
XMS^^0^B39486750
"BLD",443,"KRN",9.8,"NM",61,0)
XMS0^^1^
"BLD",443,"KRN",9.8,"NM",62,0)
XMS0A^^1^
"BLD",443,"KRN",9.8,"NM",63,0)
XMS0BLOB^^0^B13857394
"BLD",443,"KRN",9.8,"NM",64,0)
XMS1^^0^B43515829
"BLD",443,"KRN",9.8,"NM",65,0)
XMS1P^^1^
"BLD",443,"KRN",9.8,"NM",66,0)
XMS2^^0^B13825076
"BLD",443,"KRN",9.8,"NM",67,0)
XMS3^^0^B52710665
"BLD",443,"KRN",9.8,"NM",68,0)
XMS4^^1^
"BLD",443,"KRN",9.8,"NM",69,0)
XMS5^^1^
"BLD",443,"KRN",9.8,"NM",70,0)
XMS5A^^1^
"BLD",443,"KRN",9.8,"NM",71,0)
XMS5B^^1^
"BLD",443,"KRN",9.8,"NM",72,0)
XMSERR^^1^
"BLD",443,"KRN",9.8,"NM",73,0)
XMSM^^1^
"BLD",443,"KRN",9.8,"NM",74,0)
XMSM1^^1^
"BLD",443,"KRN",9.8,"NM",75,0)
XMSMAIL^^1^
"BLD",443,"KRN",9.8,"NM",76,0)
XMTDL^^0^B60982718
"BLD",443,"KRN",9.8,"NM",77,0)
XMTDO^^0^B3548599
"BLD",443,"KRN",9.8,"NM",78,0)
XMTDR^^0^B41196621
"BLD",443,"KRN",9.8,"NM",80,0)
XMUT1^^0^B8182432
"BLD",443,"KRN",9.8,"NM",81,0)
XMUT1A^^0^B9388357
"BLD",443,"KRN",9.8,"NM",82,0)
XMUT7^^0^B651942
"BLD",443,"KRN",9.8,"NM",83,0)
XMUTERM1^^0^B64992482
"BLD",443,"KRN",9.8,"NM",84,0)
XMUTERM2^^0^B24703189
"BLD",443,"KRN",9.8,"NM",85,0)
XMVGRP^^0^B47750952
"BLD",443,"KRN",9.8,"NM",86,0)
XMVVITAE^^0^B48248055
"BLD",443,"KRN",9.8,"NM",87,0)
XMXADDR^^0^B66876638
"BLD",443,"KRN",9.8,"NM",88,0)
XMXADDR1^^0^B49188214
"BLD",443,"KRN",9.8,"NM",89,0)
XMXADDR2^^0^B44254386
"BLD",443,"KRN",9.8,"NM",90,0)
XMXADDR4^^0^B24786676
"BLD",443,"KRN",9.8,"NM",91,0)
XMXMSGS^^0^B44667143
"BLD",443,"KRN",9.8,"NM",92,0)
XMXMSGS1^^0^B26176553
"BLD",443,"KRN",9.8,"NM",93,0)
XMXPARM^^0^B71472333
"BLD",443,"KRN",9.8,"NM",94,0)
XMXREPLY^^0^B15685689
"BLD",443,"KRN",9.8,"NM",95,0)
XMXSEC1^^0^B64148927
"BLD",443,"KRN",9.8,"NM",96,0)
XMXSEC3^^0^B5539815
"BLD",443,"KRN",9.8,"NM",97,0)
XMXUTIL^^0^B61068501
"BLD",443,"KRN",9.8,"NM",98,0)
XMXUTIL1^^0^B30118375
"BLD",443,"KRN",9.8,"NM",99,0)
XMYPRE^^0^B6113778
"BLD",443,"KRN",9.8,"NM",100,0)
XM0^^1^
"BLD",443,"KRN",9.8,"NM",101,0)
XMA01^^1^
"BLD",443,"KRN",9.8,"NM",102,0)
XMA02^^1^
"BLD",443,"KRN",9.8,"NM",103,0)
XMA0A^^1^
"BLD",443,"KRN",9.8,"NM",104,0)
XMA1^^1^
"BLD",443,"KRN",9.8,"NM",105,0)
XMA10^^1^
"BLD",443,"KRN",9.8,"NM",106,0)
XMA11B^^1^
"BLD",443,"KRN",9.8,"NM",107,0)
XMA1A^^1^
"BLD",443,"KRN",9.8,"NM",108,0)
XMA1E^^1^
"BLD",443,"KRN",9.8,"NM",109,0)
XMA20^^1^
"BLD",443,"KRN",9.8,"NM",110,0)
XMA210^^1^
"BLD",443,"KRN",9.8,"NM",111,0)
XMA21A^^1^
"BLD",443,"KRN",9.8,"NM",112,0)
XMA21B^^1^
"BLD",443,"KRN",9.8,"NM",113,0)
XMA21FWD^^1^
"BLD",443,"KRN",9.8,"NM",114,0)
XMA21G^^1^
"BLD",443,"KRN",9.8,"NM",115,0)
XMA22^^1^
"BLD",443,"KRN",9.8,"NM",116,0)
XMA24^^1^
"BLD",443,"KRN",9.8,"NM",117,0)
XMA25^^1^
"BLD",443,"KRN",9.8,"NM",118,0)
XMA2C^^1^
"BLD",443,"KRN",9.8,"NM",119,0)
XMA2C0^^1^
"BLD",443,"KRN",9.8,"NM",120,0)
XMA4^^1^
"BLD",443,"KRN",9.8,"NM",121,0)
XMA5^^1^
"BLD",443,"KRN",9.8,"NM",122,0)
XMA50^^1^
"BLD",443,"KRN",9.8,"NM",123,0)
XMA5A^^1^
"BLD",443,"KRN",9.8,"NM",124,0)
XMA51^^1^
"BLD",443,"KRN",9.8,"NM",125,0)
XMA6^^1^
"BLD",443,"KRN",9.8,"NM",127,0)
XMA7G^^1^
"BLD",443,"KRN",9.8,"NM",128,0)
XMA7G1^^1^
"BLD",443,"KRN",9.8,"NM",129,0)
XMAD0^^1^
"BLD",443,"KRN",9.8,"NM",130,0)
XMAD1^^1^
"BLD",443,"KRN",9.8,"NM",131,0)
XMAD1A^^1^
"BLD",443,"KRN",9.8,"NM",132,0)
XMAD1X^^1^
"BLD",443,"KRN",9.8,"NM",133,0)
XMADA^^1^
"BLD",443,"KRN",9.8,"NM",134,0)
XMADDOC^^1^
"BLD",443,"KRN",9.8,"NM",135,0)
XMADDOC1^^1^
"BLD",443,"KRN",9.8,"NM",136,0)
XMADDOC2^^1^
"BLD",443,"KRN",9.8,"NM",137,0)
XMADGO1^^1^
"BLD",443,"KRN",9.8,"NM",138,0)
XMADJ999^^1^
"BLD",443,"KRN",9.8,"NM",139,0)
XMADJF0^^1^
"BLD",443,"KRN",9.8,"NM",140,0)
XMADJF1^^1^
"BLD",443,"KRN",9.8,"NM",141,0)
XMADJF1A^^1^
"BLD",443,"KRN",9.8,"NM",142,0)
XMADJF1B^^1^
"BLD",443,"KRN",9.8,"NM",143,0)
XMAH0^^1^
"BLD",443,"KRN",9.8,"NM",144,0)
XMAI^^1^
"BLD",443,"KRN",9.8,"NM",145,0)
XMAI0^^1^
"BLD",443,"KRN",9.8,"NM",146,0)
XMAI1^^1^
"BLD",443,"KRN",9.8,"NM",147,0)
XMAK^^1^
"BLD",443,"KRN",9.8,"NM",148,0)
XMAL0^^1^
"BLD",443,"KRN",9.8,"NM",149,0)
XMAL0A^^1^
"BLD",443,"KRN",9.8,"NM",150,0)
XMANON^^1^
"BLD",443,"KRN",9.8,"NM",151,0)
XMAP^^1^
"BLD",443,"KRN",9.8,"NM",152,0)
XMAP0^^1^
"BLD",443,"KRN",9.8,"NM",153,0)
XMAP1^^1^
"BLD",443,"KRN",9.8,"NM",155,0)
XMB1^^1^
"BLD",443,"KRN",9.8,"NM",156,0)
XME^^1^
"BLD",443,"KRN",9.8,"NM",157,0)
XME1^^1^
"BLD",443,"KRN",9.8,"NM",158,0)
XMUT4B^^1^
"BLD",443,"KRN",9.8,"NM",159,0)
XMUT4BA^^1^
"BLD",443,"KRN",9.8,"NM",160,0)
XMA23^^1^
"BLD",443,"KRN",9.8,"NM",161,0)
XMA31^^1^
"BLD",443,"KRN",9.8,"NM",162,0)
XMA33^^1^
"BLD",443,"KRN",9.8,"NM",163,0)
XMAD^^1^
"BLD",443,"KRN",9.8,"NM",164,0)
XMDIE^^1^
"BLD",443,"KRN",9.8,"NM",165,0)
XMDOC^^1^
"BLD",443,"KRN",9.8,"NM",166,0)
XML1^^1^
"BLD",443,"KRN",9.8,"NM",167,0)
XML3^^1^
"BLD",443,"KRN",9.8,"NM",168,0)
XML98^^1^
"BLD",443,"KRN",9.8,"NM",169,0)
XMNETV^^1^
"BLD",443,"KRN",9.8,"NM",170,0)
XMNTEG^^0^B20704578
"BLD",443,"KRN",9.8,"NM",171,0)
XMNTEG0^^0^B7139150
"BLD",443,"KRN",9.8,"NM",172,0)
XMPD^^1^
"BLD",443,"KRN",9.8,"NM",173,0)
XMSER^^1^
"BLD",443,"KRN",9.8,"NM",174,0)
XMVA^^1^
"BLD",443,"KRN",9.8,"NM",175,0)
XMVCODE^^1^
"BLD",443,"KRN",9.8,"NM",176,0)
XMVPIC^^1^
"BLD",443,"KRN",9.8,"NM",177,0)
XMVSTUFF^^1^
"BLD",443,"KRN",9.8,"NM",178,0)
XMVTEST^^1^
"BLD",443,"KRN",9.8,"NM",179,0)
XMUDCHR^^0^B21201807
"BLD",443,"KRN",9.8,"NM",180,0)
XMYPOSD^^1^
"BLD",443,"KRN",9.8,"NM",181,0)
XMYPOST^^1^
"BLD",443,"KRN",9.8,"NM",182,0)
XMYPOST0^^1^
"BLD",443,"KRN",9.8,"NM",183,0)
XMYPOST1^^1^
"BLD",443,"KRN",9.8,"NM",184,0)
XMYPOST2^^1^
"BLD",443,"KRN",9.8,"NM",185,0)
XMYPOST3^^1^
"BLD",443,"KRN",9.8,"NM",186,0)
XMYPOST4^^1^
"BLD",443,"KRN",9.8,"NM",187,0)
XMYPOST5^^1^
"BLD",443,"KRN",9.8,"NM",188,0)
XMYPOST6^^1^
"BLD",443,"KRN",9.8,"NM",189,0)
XMYPOST7^^1^
"BLD",443,"KRN",9.8,"NM",190,0)
XMYPOST8^^1^
"BLD",443,"KRN",9.8,"NM",191,0)
XMYPOST9^^1^
"BLD",443,"KRN",9.8,"NM",192,0)
XMYPOSTA^^1^
"BLD",443,"KRN",9.8,"NM",193,0)
XMYPOSTB^^1^
"BLD",443,"KRN",9.8,"NM",194,0)
XMYPOSTC^^1^
"BLD",443,"KRN",9.8,"NM",195,0)
XMYPOSTD^^1^
"BLD",443,"KRN",9.8,"NM",196,0)
XMYPRE1^^1^
"BLD",443,"KRN",9.8,"NM",197,0)
XMYPRE10^^1^
"BLD",443,"KRN",9.8,"NM",198,0)
XMYPRE11^^1^
"BLD",443,"KRN",9.8,"NM",199,0)
XMYPRE2^^1^
"BLD",443,"KRN",9.8,"NM",200,0)
XMYPRE2A^^1^
"BLD",443,"KRN",9.8,"NM",201,0)
XMYPRE2B^^1^
"BLD",443,"KRN",9.8,"NM",202,0)
XMYPRE3^^1^
"BLD",443,"KRN",9.8,"NM",203,0)
XMYPRE4^^1^
"BLD",443,"KRN",9.8,"NM",204,0)
XMYPRE5^^1^
"BLD",443,"KRN",9.8,"NM",205,0)
XMYPRE6^^1^
"BLD",443,"KRN",9.8,"NM",206,0)
XMYPRE6A^^1^
"BLD",443,"KRN",9.8,"NM",207,0)
XMYPRE7^^1^
"BLD",443,"KRN",9.8,"NM",208,0)
XMYPRE8^^1^
"BLD",443,"KRN",9.8,"NM",209,0)
XMYPRE9^^1^
"BLD",443,"KRN",9.8,"NM",210,0)
XMYMNEM^^1^
"BLD",443,"KRN",9.8,"NM",211,0)
XMYMNEM0^^1^
"BLD",443,"KRN",9.8,"NM",212,0)
XMYMNEM1^^1^
"BLD",443,"KRN",9.8,"NM",213,0)
XMYMNEM2^^1^
"BLD",443,"KRN",9.8,"NM",214,0)
XMYPDOM^^1^
"BLD",443,"KRN",9.8,"NM",215,0)
XMYPDOM1^^1^
"BLD",443,"KRN",9.8,"NM",216,0)
XMKPR1^^0^B14608787
"BLD",443,"KRN",9.8,"NM",217,0)
XMKPRD^^0^B15344166
"BLD",443,"KRN",9.8,"NM",218,0)
XMLSTAT^^1^
"BLD",443,"KRN",9.8,"NM",219,0)
XML1CRC^^0^B12736464
"BLD",443,"KRN",9.8,"NM",220,0)
XML4CRC^^0^B19924261
"BLD",443,"KRN",9.8,"NM",221,0)
XMLPC^^0^B5775025
"BLD",443,"KRN",9.8,"NM",222,0)
XMLSWP2^^0^B4108377
"BLD",443,"KRN",9.8,"NM",223,0)
XMXADDR3^^0^B27839753
"BLD",443,"KRN",9.8,"NM",224,0)
XMPDAT^^1^
"BLD",443,"KRN",9.8,"NM",225,0)
XMVVITA^^0^B34730890
"BLD",443,"KRN",9.8,"NM",226,0)
XMJMQ^^0^B54683650
"BLD",443,"KRN",9.8,"NM",227,0)
XMVGROUP^^0^B58696222
"BLD",443,"KRN",9.8,"NM",228,0)
XMXGRP^^0^B53414420
"BLD",443,"KRN",9.8,"NM",229,0)
XMXUTIL4^^0^B32435147
"BLD",443,"KRN",9.8,"NM",230,0)
XMKP1^^0^B2528182
"BLD",443,"KRN",9.8,"NM",231,0)
XMUDCHK^^0^B14580607
"BLD",443,"KRN",9.8,"NM",232,0)
XMDF^^1^
"BLD",443,"KRN",9.8,"NM",233,0)
XMAREAD^^1^
"BLD",443,"KRN",9.8,"NM",234,0)
XMPX^^1^
"BLD",443,"KRN",9.8,"NM",235,0)
XMUT1B^^1^
"BLD",443,"KRN",9.8,"NM",236,0)
XMUT5R^^1^
"BLD",443,"KRN",9.8,"NM",237,0)
XMUTASK^^1^
"BLD",443,"KRN",9.8,"NM",238,0)
XM^^0^B66365873
"BLD",443,"KRN",9.8,"NM",239,0)
XMA^^0^B263445
"BLD",443,"KRN",9.8,"NM",240,0)
XMA0^^0^B1015526
"BLD",443,"KRN",9.8,"NM",241,0)
XMA03^^0^B121737
"BLD",443,"KRN",9.8,"NM",242,0)
XMA11^^0^B41447
"BLD",443,"KRN",9.8,"NM",243,0)
XMA11A^^0^B562876
"BLD",443,"KRN",9.8,"NM",244,0)
XMA1B^^0^B1589781
"BLD",443,"KRN",9.8,"NM",245,0)
XMA1C^^0^B259410
"BLD",443,"KRN",9.8,"NM",246,0)
XMA2B^^0^B9474956
"BLD",443,"KRN",9.8,"NM",247,0)
XMA2R^^0^B13833277
"BLD",443,"KRN",9.8,"NM",248,0)
XMA3^^0^B60737613
"BLD",443,"KRN",9.8,"NM",249,0)
XMA32^^0^B42886226
"BLD",443,"KRN",9.8,"NM",250,0)
XMA32A^^0^B32531975
"BLD",443,"KRN",9.8,"NM",251,0)
XMA7^^0^B27269
"BLD",443,"KRN",9.8,"NM",252,0)
XMAD2^^0^B404128
"BLD",443,"KRN",9.8,"NM",253,0)
XMADGO^^0^B22926
"BLD",443,"KRN",9.8,"NM",254,0)
XMAFTP^^0^B8113913
"BLD",443,"KRN",9.8,"NM",255,0)
XMAH^^0^B2492368
"BLD",443,"KRN",9.8,"NM",256,0)
XMAH1^^0^B3811256
"BLD",443,"KRN",9.8,"NM",257,0)
XMAI2^^0^B4319906
"BLD",443,"KRN",9.8,"NM",258,0)
XMAPBLOB^^0^B9485803
"BLD",443,"KRN",9.8,"NM",259,0)
XMAPHOST^^0^B29772497
"BLD",443,"KRN",9.8,"NM",260,0)
XMASEC^^0^B63884
"BLD",443,"KRN",9.8,"NM",261,0)
XMBBLOB^^0^B2223259
"BLD",443,"KRN",9.8,"NM",262,0)
XMCDNT^^0^B579239
"BLD",443,"KRN",9.8,"NM",263,0)
XMCSIZE^^0^B2168987
"BLD",443,"KRN",9.8,"NM",264,0)
XMCU1^^0^B1480805
"BLD",443,"KRN",9.8,"NM",265,0)
XMD^^0^B63422057
"BLD",443,"KRN",9.8,"NM",266,0)
XMDIR1^^0^B23954143
"BLD",443,"KRN",9.8,"NM",267,0)
XMDIR1A^^0^B7666830
"BLD",443,"KRN",9.8,"NM",268,0)
XMDIR1B^^0^B5271223
"BLD",443,"KRN",9.8,"NM",269,0)
XMDIRQST^^0^B14882403
"BLD",443,"KRN",9.8,"NM",270,0)
XMDIRRCV^^0^B3171429
"BLD",443,"KRN",9.8,"NM",271,0)
XMF1^^1^
"BLD",443,"KRN",9.8,"NM",272,0)
XMGAPI0^^0^B3801409
"BLD",443,"KRN",9.8,"NM",273,0)
XMGAPI2^^0^B11238816
"BLD",443,"KRN",9.8,"NM",274,0)
XMGAPI3^^0^B5982411
"BLD",443,"KRN",9.8,"NM",275,0)
XMGAPI4^^0^B13644447
"BLD",443,"KRN",9.8,"NM",276,0)
XMJBM^^0^B53324713
"BLD",443,"KRN",9.8,"NM",277,0)
XMJBM1^^0^B8498226
"BLD",443,"KRN",9.8,"NM",278,0)
XMJBN^^0^B36117943
"BLD",443,"KRN",9.8,"NM",279,0)
XMJBN1^^0^B14482804
"BLD",443,"KRN",9.8,"NM",280,0)
XMJBU^^0^B5867813
"BLD",443,"KRN",9.8,"NM",281,0)
XMJDIR^^0^B19555701
"BLD",443,"KRN",9.8,"NM",282,0)
XMJERR^^0^B630190
"BLD",443,"KRN",9.8,"NM",283,0)
XMJMA^^0^B7017158
"BLD",443,"KRN",9.8,"NM",284,0)
XMJMBULL^^0^B4320263
"BLD",443,"KRN",9.8,"NM",285,0)
XMJMC^^0^B33661798
"BLD",443,"KRN",9.8,"NM",286,0)
XMJMCODE^^0^B37745565
"BLD",443,"KRN",9.8,"NM",287,0)
XMJMF^^0^B8951979
"BLD",443,"KRN",9.8,"NM",288,0)
XMJMF1^^0^B26707831
"BLD",443,"KRN",9.8,"NM",289,0)
XMJMFA^^0^B15433328
"BLD",443,"KRN",9.8,"NM",290,0)
XMJMFB^^0^B72865137
"BLD",443,"KRN",9.8,"NM",291,0)
XMJMFC^^0^B36679658
"BLD",443,"KRN",9.8,"NM",292,0)
XMJMLN^^0^B61825279
"BLD",443,"KRN",9.8,"NM",293,0)
XMJMLR^^0^B74217777
"BLD",443,"KRN",9.8,"NM",294,0)
XMJMLR1^^0^B28231874
"BLD",443,"KRN",9.8,"NM",295,0)
XMJMOI1^^0^B18562704
"BLD",443,"KRN",9.8,"NM",296,0)
XMJMOIE^^0^B9940499
"BLD",443,"KRN",9.8,"NM",297,0)
XMJMORX1^^0^B30705892
"BLD",443,"KRN",9.8,"NM",298,0)
XMJMP^^0^B62577394
"BLD",443,"KRN",9.8,"NM",299,0)
XMJMP2^^0^B6095644
"BLD",443,"KRN",9.8,"NM",300,0)
XMJMQ1^^0^B48669689
"BLD",443,"KRN",9.8,"NM",301,0)
XMJMR^^0^B29191383
"BLD",443,"KRN",9.8,"NM",302,0)
XMJMR1^^0^B28685507
"BLD",443,"KRN",9.8,"NM",303,0)
XMJMRO^^0^B10100070
"BLD",443,"KRN",9.8,"NM",304,0)
XMJMS^^0^B38369904
"BLD",443,"KRN",9.8,"NM",305,0)
XMJMSA^^0^B5186637
"BLD",443,"KRN",9.8,"NM",306,0)
XMJMSO^^0^B49837651
"BLD",443,"KRN",9.8,"NM",307,0)
XMJMT^^0^B25844973
"BLD",443,"KRN",9.8,"NM",308,0)
XMKPL^^0^B6248412
"BLD",443,"KRN",9.8,"NM",309,0)
XMKPLQ^^0^B15760272
"BLD",443,"KRN",9.8,"NM",310,0)
XML4CRC1^^0^B12792269
"BLD",443,"KRN",9.8,"NM",311,0)
XMLSWP^^0^B10276184
"BLD",443,"KRN",9.8,"NM",312,0)
XMLSWP0^^0^B10066868
"BLD",443,"KRN",9.8,"NM",313,0)
XMM1^^0^B7787825
"BLD",443,"KRN",9.8,"NM",314,0)
XMM2^^0^B3732331
"BLD",443,"KRN",9.8,"NM",315,0)
XMP2^^0^B33252211
"BLD",443,"KRN",9.8,"NM",316,0)
XMP2A^^0^B13988849
"BLD",443,"KRN",9.8,"NM",317,0)
XMPC^^0^B8382242
"BLD",443,"KRN",9.8,"NM",318,0)
XMPG^^0^B10765431
"BLD",443,"KRN",9.8,"NM",319,0)
XMPH^^0^B11811007
"BLD",443,"KRN",9.8,"NM",320,0)
XMPSEC^^0^B22927463
"BLD",443,"KRN",9.8,"NM",321,0)
XMR0BLOB^^0^B9857085
"BLD",443,"KRN",9.8,"NM",322,0)
XMRFTP^^0^B6643646
"BLD",443,"KRN",9.8,"NM",323,0)
XMRFTPUX^^0^B6748352
"BLD",443,"KRN",9.8,"NM",324,0)
XMRINETD^^0^B448081
"BLD",443,"KRN",9.8,"NM",325,0)
XMRMSM^^0^B465912
"BLD",443,"KRN",9.8,"NM",326,0)
XMRONT^^0^B718752
"BLD",443,"KRN",9.8,"NM",327,0)
XMRPCTS^^0^B8341164
"BLD",443,"KRN",9.8,"NM",328,0)
XMRPCTS1^^0^B21126453
"BLD",443,"KRN",9.8,"NM",329,0)
XMRPCTSA^^0^B7279851
"BLD",443,"KRN",9.8,"NM",330,0)
XMRPOP^^0^B58705120
"BLD",443,"KRN",9.8,"NM",331,0)
XMRTCPGO^^0^B3838958
"BLD",443,"KRN",9.8,"NM",332,0)
XMRUCX^^0^B2418489
"BLD",443,"KRN",9.8,"NM",333,0)
XMSFTP^^0^B8502703
"BLD",443,"KRN",9.8,"NM",334,0)
XMSFTPUX^^0^B9247891
"BLD",443,"KRN",9.8,"NM",335,0)
XMTDF^^0^B26187152
"BLD",443,"KRN",9.8,"NM",336,0)
XMTDL1^^0^B6567327
"BLD",443,"KRN",9.8,"NM",337,0)
XMTDL2^^0^B37771292
"BLD",443,"KRN",9.8,"NM",338,0)
XMTDT^^0^B25044230
"BLD",443,"KRN",9.8,"NM",339,0)
XMUDNC^^0^B66680721
"BLD",443,"KRN",9.8,"NM",340,0)
XMUDTOP^^0^B52913690
"BLD",443,"KRN",9.8,"NM",341,0)
XMUPIN^^0^B32693876
"BLD",443,"KRN",9.8,"NM",342,0)
XMUT2^^0^B15678954
"BLD",443,"KRN",9.8,"NM",343,0)
XMUT4^^0^B63689784
"BLD",443,"KRN",9.8,"NM",344,0)
XMUT41^^0^B18956511
"BLD",443,"KRN",9.8,"NM",345,0)
XMUT4A^^0^B2183742
"BLD",443,"KRN",9.8,"NM",346,0)
XMUT4C^^0^B34612432
"BLD",443,"KRN",9.8,"NM",347,0)
XMUT5^^0^B15655517
"BLD",443,"KRN",9.8,"NM",348,0)
XMUT5C^^0^B5865266
"BLD",443,"KRN",9.8,"NM",349,0)
XMUT5G^^0^B429148
"BLD",443,"KRN",9.8,"NM",350,0)
XMUT5Q^^0^B18391915
"BLD",443,"KRN",9.8,"NM",351,0)
XMUT5Q1^^0^B8959791
"BLD",443,"KRN",9.8,"NM",352,0)
XMUT5R1^^0^B4780533
"BLD",443,"KRN",9.8,"NM",353,0)
XMUT5R2^^0^B7682921
"BLD",443,"KRN",9.8,"NM",354,0)
XMUT6^^0^B4028377
"BLD",443,"KRN",9.8,"NM",355,0)
XMUTCOM1^^0^B6233052
"BLD",443,"KRN",9.8,"NM",356,0)
XMUTERM^^0^B30239309
"BLD",443,"KRN",9.8,"NM",357,0)
XMUTPUR0^^0^B5569328
"BLD",443,"KRN",9.8,"NM",358,0)
XMVSURR^^0^B8214736
"BLD",443,"KRN",9.8,"NM",359,0)
XMXADDRD^^0^B40495890
"BLD",443,"KRN",9.8,"NM",360,0)
XMXADDRG^^0^B70083077
"BLD",443,"KRN",9.8,"NM",361,0)
XMXANSER^^0^B6003785
"BLD",443,"KRN",9.8,"NM",362,0)
XMXAPI^^0^B39021968
"BLD",443,"KRN",9.8,"NM",363,0)
XMXAPIB^^0^B10245722
"BLD",443,"KRN",9.8,"NM",364,0)
XMXAPIG^^0^B12997724
"BLD",443,"KRN",9.8,"NM",365,0)
XMXAPIU^^0^B1235647
"BLD",443,"KRN",9.8,"NM",366,0)
XMXBSKT^^0^B42208664
"BLD",443,"KRN",9.8,"NM",367,0)
XMXBULL^^0^B18811259
"BLD",443,"KRN",9.8,"NM",368,0)
XMXEDIT^^0^B25275913
"BLD",443,"KRN",9.8,"NM",369,0)
XMXGRP1^^0^B31227909
"BLD",443,"KRN",9.8,"NM",370,0)
XMXLIST^^0^B30457906
"BLD",443,"KRN",9.8,"NM",371,0)
XMXLIST1^^0^B45274144
"BLD",443,"KRN",9.8,"NM",372,0)
XMXLIST2^^0^B16392703
"BLD",443,"KRN",9.8,"NM",373,0)
XMXMBOX^^0^B3516978
"BLD",443,"KRN",9.8,"NM",374,0)
XMXMSGS2^^0^B45234380
"BLD",443,"KRN",9.8,"NM",375,0)
XMXPARM1^^0^B10264070
"BLD",443,"KRN",9.8,"NM",376,0)
XMXPARMB^^0^B14713222
"BLD",443,"KRN",9.8,"NM",377,0)
XMXPRT^^0^B6915293
"BLD",443,"KRN",9.8,"NM",378,0)
XMXSEC^^0^B67205765
"BLD",443,"KRN",9.8,"NM",379,0)
XMXSEC2^^0^B66090183
"BLD",443,"KRN",9.8,"NM",380,0)
XMXSEND^^0^B65629156
"BLD",443,"KRN",9.8,"NM",381,0)
XMXTO^^0^B4749458
"BLD",443,"KRN",9.8,"NM",382,0)
XMXUTIL2^^0^B43408568
"BLD",443,"KRN",9.8,"NM",383,0)
XMXUTIL3^^0^B23095450
"BLD",443,"KRN",9.8,"NM",384,0)
XMA2^^0^B2966133
"BLD",443,"KRN",9.8,"NM",385,0)
XMA21^^0^B12959406
"BLD",443,"KRN",9.8,"NM",386,0)
XMA21C^^0^B8010998
"BLD",443,"KRN",9.8,"NM",387,0)
XMBGRP^^0^B34058917
"BLD",443,"KRN",9.8,"NM",388,0)
XMUCXPOP^^0^B526376
"BLD",443,"KRN",9.8,"NM",389,0)
XMUT5B^^0^B2957494
"BLD",443,"KRN",9.8,"NM","B","XM",238)

"BLD",443,"KRN",9.8,"NM","B","XM0",100)

"BLD",443,"KRN",9.8,"NM","B","XMA",239)

"BLD",443,"KRN",9.8,"NM","B","XMA0",240)

"BLD",443,"KRN",9.8,"NM","B","XMA01",101)

"BLD",443,"KRN",9.8,"NM","B","XMA02",102)

"BLD",443,"KRN",9.8,"NM","B","XMA03",241)

"BLD",443,"KRN",9.8,"NM","B","XMA0A",103)

"BLD",443,"KRN",9.8,"NM","B","XMA1",104)

"BLD",443,"KRN",9.8,"NM","B","XMA10",105)

"BLD",443,"KRN",9.8,"NM","B","XMA11",242)

"BLD",443,"KRN",9.8,"NM","B","XMA11A",243)

"BLD",443,"KRN",9.8,"NM","B","XMA11B",106)

"BLD",443,"KRN",9.8,"NM","B","XMA1A",107)

"BLD",443,"KRN",9.8,"NM","B","XMA1B",244)

"BLD",443,"KRN",9.8,"NM","B","XMA1C",245)

"BLD",443,"KRN",9.8,"NM","B","XMA1E",108)

"BLD",443,"KRN",9.8,"NM","B","XMA2",384)

"BLD",443,"KRN",9.8,"NM","B","XMA20",109)

"BLD",443,"KRN",9.8,"NM","B","XMA21",385)

"BLD",443,"KRN",9.8,"NM","B","XMA210",110)

"BLD",443,"KRN",9.8,"NM","B","XMA21A",111)

"BLD",443,"KRN",9.8,"NM","B","XMA21B",112)

"BLD",443,"KRN",9.8,"NM","B","XMA21C",386)

"BLD",443,"KRN",9.8,"NM","B","XMA21FWD",113)

"BLD",443,"KRN",9.8,"NM","B","XMA21G",114)

"BLD",443,"KRN",9.8,"NM","B","XMA22",115)

"BLD",443,"KRN",9.8,"NM","B","XMA23",160)

"BLD",443,"KRN",9.8,"NM","B","XMA24",116)

"BLD",443,"KRN",9.8,"NM","B","XMA25",117)

"BLD",443,"KRN",9.8,"NM","B","XMA2B",246)

"BLD",443,"KRN",9.8,"NM","B","XMA2C",118)

"BLD",443,"KRN",9.8,"NM","B","XMA2C0",119)

"BLD",443,"KRN",9.8,"NM","B","XMA2R",247)

"BLD",443,"KRN",9.8,"NM","B","XMA3",248)

"BLD",443,"KRN",9.8,"NM","B","XMA30",1)

"BLD",443,"KRN",9.8,"NM","B","XMA31",161)

"BLD",443,"KRN",9.8,"NM","B","XMA32",249)

"BLD",443,"KRN",9.8,"NM","B","XMA32A",250)

"BLD",443,"KRN",9.8,"NM","B","XMA33",162)

"BLD",443,"KRN",9.8,"NM","B","XMA4",120)

"BLD",443,"KRN",9.8,"NM","B","XMA5",121)

"BLD",443,"KRN",9.8,"NM","B","XMA50",122)

"BLD",443,"KRN",9.8,"NM","B","XMA51",124)

"BLD",443,"KRN",9.8,"NM","B","XMA5A",123)

"BLD",443,"KRN",9.8,"NM","B","XMA6",125)

"BLD",443,"KRN",9.8,"NM","B","XMA7",251)

"BLD",443,"KRN",9.8,"NM","B","XMA7G",127)

"BLD",443,"KRN",9.8,"NM","B","XMA7G1",128)

"BLD",443,"KRN",9.8,"NM","B","XMAD",163)

"BLD",443,"KRN",9.8,"NM","B","XMAD0",129)

"BLD",443,"KRN",9.8,"NM","B","XMAD1",130)

"BLD",443,"KRN",9.8,"NM","B","XMAD1A",131)

"BLD",443,"KRN",9.8,"NM","B","XMAD1X",132)

"BLD",443,"KRN",9.8,"NM","B","XMAD2",252)

"BLD",443,"KRN",9.8,"NM","B","XMADA",133)

"BLD",443,"KRN",9.8,"NM","B","XMADDOC",134)

"BLD",443,"KRN",9.8,"NM","B","XMADDOC1",135)

"BLD",443,"KRN",9.8,"NM","B","XMADDOC2",136)

"BLD",443,"KRN",9.8,"NM","B","XMADGO",253)

"BLD",443,"KRN",9.8,"NM","B","XMADGO1",137)

"BLD",443,"KRN",9.8,"NM","B","XMADJ999",138)

"BLD",443,"KRN",9.8,"NM","B","XMADJF0",139)

"BLD",443,"KRN",9.8,"NM","B","XMADJF1",140)

"BLD",443,"KRN",9.8,"NM","B","XMADJF1A",141)

"BLD",443,"KRN",9.8,"NM","B","XMADJF1B",142)

"BLD",443,"KRN",9.8,"NM","B","XMAFTP",254)

"BLD",443,"KRN",9.8,"NM","B","XMAH",255)

"BLD",443,"KRN",9.8,"NM","B","XMAH0",143)

"BLD",443,"KRN",9.8,"NM","B","XMAH1",256)

"BLD",443,"KRN",9.8,"NM","B","XMAI",144)

"BLD",443,"KRN",9.8,"NM","B","XMAI0",145)

"BLD",443,"KRN",9.8,"NM","B","XMAI1",146)

"BLD",443,"KRN",9.8,"NM","B","XMAI2",257)

"BLD",443,"KRN",9.8,"NM","B","XMAK",147)

"BLD",443,"KRN",9.8,"NM","B","XMAL0",148)

"BLD",443,"KRN",9.8,"NM","B","XMAL0A",149)

"BLD",443,"KRN",9.8,"NM","B","XMANON",150)

"BLD",443,"KRN",9.8,"NM","B","XMAP",151)

"BLD",443,"KRN",9.8,"NM","B","XMAP0",152)

"BLD",443,"KRN",9.8,"NM","B","XMAP1",153)

"BLD",443,"KRN",9.8,"NM","B","XMAPBLOB",258)

"BLD",443,"KRN",9.8,"NM","B","XMAPHOST",259)

"BLD",443,"KRN",9.8,"NM","B","XMAREAD",233)

"BLD",443,"KRN",9.8,"NM","B","XMASEC",260)

"BLD",443,"KRN",9.8,"NM","B","XMB",2)

"BLD",443,"KRN",9.8,"NM","B","XMB1",155)

"BLD",443,"KRN",9.8,"NM","B","XMBBLOB",261)

"BLD",443,"KRN",9.8,"NM","B","XMBGRP",387)

"BLD",443,"KRN",9.8,"NM","B","XMBPOST",3)

"BLD",443,"KRN",9.8,"NM","B","XMC",4)

"BLD",443,"KRN",9.8,"NM","B","XMC1",5)

"BLD",443,"KRN",9.8,"NM","B","XMC11",6)

"BLD",443,"KRN",9.8,"NM","B","XMC11A",7)

"BLD",443,"KRN",9.8,"NM","B","XMC1A",8)

"BLD",443,"KRN",9.8,"NM","B","XMC1A1",9)

"BLD",443,"KRN",9.8,"NM","B","XMC1B",10)

"BLD",443,"KRN",9.8,"NM","B","XMC2",11)

"BLD",443,"KRN",9.8,"NM","B","XMC3",12)

"BLD",443,"KRN",9.8,"NM","B","XMC4",13)

"BLD",443,"KRN",9.8,"NM","B","XMCB",14)

"BLD",443,"KRN",9.8,"NM","B","XMCD",15)

"BLD",443,"KRN",9.8,"NM","B","XMCDNT",262)

"BLD",443,"KRN",9.8,"NM","B","XMCE",16)

"BLD",443,"KRN",9.8,"NM","B","XMCP",17)

"BLD",443,"KRN",9.8,"NM","B","XMCQ",18)

"BLD",443,"KRN",9.8,"NM","B","XMCQA",19)

"BLD",443,"KRN",9.8,"NM","B","XMCQH",20)

"BLD",443,"KRN",9.8,"NM","B","XMCSIZE",263)

"BLD",443,"KRN",9.8,"NM","B","XMCTLK",21)

"BLD",443,"KRN",9.8,"NM","B","XMCTLK0",22)

"BLD",443,"KRN",9.8,"NM","B","XMCTRAP",23)

"BLD",443,"KRN",9.8,"NM","B","XMCU1",264)

"BLD",443,"KRN",9.8,"NM","B","XMCX",24)

"BLD",443,"KRN",9.8,"NM","B","XMCXT",25)

"BLD",443,"KRN",9.8,"NM","B","XMCXU",26)

"BLD",443,"KRN",9.8,"NM","B","XMD",265)

"BLD",443,"KRN",9.8,"NM","B","XMDF",232)

"BLD",443,"KRN",9.8,"NM","B","XMDIE",164)

"BLD",443,"KRN",9.8,"NM","B","XMDIR1",266)

"BLD",443,"KRN",9.8,"NM","B","XMDIR1A",267)

"BLD",443,"KRN",9.8,"NM","B","XMDIR1B",268)

"BLD",443,"KRN",9.8,"NM","B","XMDIRQST",269)

"BLD",443,"KRN",9.8,"NM","B","XMDIRRCV",270)

"BLD",443,"KRN",9.8,"NM","B","XMDIRSND",27)

"BLD",443,"KRN",9.8,"NM","B","XMDOC",165)

"BLD",443,"KRN",9.8,"NM","B","XME",156)

"BLD",443,"KRN",9.8,"NM","B","XME1",157)

"BLD",443,"KRN",9.8,"NM","B","XMF1",271)

"BLD",443,"KRN",9.8,"NM","B","XMFAX",28)

"BLD",443,"KRN",9.8,"NM","B","XMGAPI0",272)

"BLD",443,"KRN",9.8,"NM","B","XMGAPI1",29)

"BLD",443,"KRN",9.8,"NM","B","XMGAPI2",273)

"BLD",443,"KRN",9.8,"NM","B","XMGAPI3",274)

"BLD",443,"KRN",9.8,"NM","B","XMGAPI4",275)

"BLD",443,"KRN",9.8,"NM","B","XMHIG",30)

"BLD",443,"KRN",9.8,"NM","B","XMHIU",31)

"BLD",443,"KRN",9.8,"NM","B","XMJBL",32)

"BLD",443,"KRN",9.8,"NM","B","XMJBM",276)

"BLD",443,"KRN",9.8,"NM","B","XMJBM1",277)

"BLD",443,"KRN",9.8,"NM","B","XMJBN",278)

"BLD",443,"KRN",9.8,"NM","B","XMJBN1",279)

"BLD",443,"KRN",9.8,"NM","B","XMJBU",280)

"BLD",443,"KRN",9.8,"NM","B","XMJDIR",281)

"BLD",443,"KRN",9.8,"NM","B","XMJERR",282)

"BLD",443,"KRN",9.8,"NM","B","XMJMA",283)

"BLD",443,"KRN",9.8,"NM","B","XMJMBULL",284)

"BLD",443,"KRN",9.8,"NM","B","XMJMC",285)

"BLD",443,"KRN",9.8,"NM","B","XMJMCODE",286)

"BLD",443,"KRN",9.8,"NM","B","XMJMD",33)

"BLD",443,"KRN",9.8,"NM","B","XMJMF",287)

"BLD",443,"KRN",9.8,"NM","B","XMJMF1",288)

"BLD",443,"KRN",9.8,"NM","B","XMJMF2",34)

"BLD",443,"KRN",9.8,"NM","B","XMJMFA",289)

"BLD",443,"KRN",9.8,"NM","B","XMJMFB",290)

"BLD",443,"KRN",9.8,"NM","B","XMJMFC",291)

"BLD",443,"KRN",9.8,"NM","B","XMJML",35)

"BLD",443,"KRN",9.8,"NM","B","XMJMLN",292)

"BLD",443,"KRN",9.8,"NM","B","XMJMLR",293)

"BLD",443,"KRN",9.8,"NM","B","XMJMLR1",294)

"BLD",443,"KRN",9.8,"NM","B","XMJMOI",39)

"BLD",443,"KRN",9.8,"NM","B","XMJMOI1",295)

"BLD",443,"KRN",9.8,"NM","B","XMJMOIE",296)

"BLD",443,"KRN",9.8,"NM","B","XMJMOR",36)

"BLD",443,"KRN",9.8,"NM","B","XMJMORX",37)

"BLD",443,"KRN",9.8,"NM","B","XMJMORX1",297)

"BLD",443,"KRN",9.8,"NM","B","XMJMP",298)

"BLD",443,"KRN",9.8,"NM","B","XMJMP1",38)

"BLD",443,"KRN",9.8,"NM","B","XMJMP2",299)

"BLD",443,"KRN",9.8,"NM","B","XMJMQ",226)

"BLD",443,"KRN",9.8,"NM","B","XMJMQ1",300)

"BLD",443,"KRN",9.8,"NM","B","XMJMR",301)

"BLD",443,"KRN",9.8,"NM","B","XMJMR1",302)

"BLD",443,"KRN",9.8,"NM","B","XMJMRO",303)

"BLD",443,"KRN",9.8,"NM","B","XMJMS",304)

"BLD",443,"KRN",9.8,"NM","B","XMJMSA",305)

"BLD",443,"KRN",9.8,"NM","B","XMJMSO",306)

"BLD",443,"KRN",9.8,"NM","B","XMJMT",307)

"BLD",443,"KRN",9.8,"NM","B","XMKP",40)

"BLD",443,"KRN",9.8,"NM","B","XMKP1",230)

"BLD",443,"KRN",9.8,"NM","B","XMKPL",308)

"BLD",443,"KRN",9.8,"NM","B","XMKPLQ",309)

"BLD",443,"KRN",9.8,"NM","B","XMKPO",41)

"BLD",443,"KRN",9.8,"NM","B","XMKPR",42)

"BLD",443,"KRN",9.8,"NM","B","XMKPR1",216)

"BLD",443,"KRN",9.8,"NM","B","XMKPRD",217)

"BLD",443,"KRN",9.8,"NM","B","XML",43)

"BLD",443,"KRN",9.8,"NM","B","XML1",166)

"BLD",443,"KRN",9.8,"NM","B","XML1CRC",219)

"BLD",443,"KRN",9.8,"NM","B","XML3",167)

"BLD",443,"KRN",9.8,"NM","B","XML4CRC",220)

"BLD",443,"KRN",9.8,"NM","B","XML4CRC1",310)

"BLD",443,"KRN",9.8,"NM","B","XML98",168)

"BLD",443,"KRN",9.8,"NM","B","XMLPC",221)

"BLD",443,"KRN",9.8,"NM","B","XMLSTAT",218)

"BLD",443,"KRN",9.8,"NM","B","XMLSWP",311)

"BLD",443,"KRN",9.8,"NM","B","XMLSWP0",312)

"BLD",443,"KRN",9.8,"NM","B","XMLSWP2",222)

"BLD",443,"KRN",9.8,"NM","B","XMLTCP",44)

"BLD",443,"KRN",9.8,"NM","B","XMM1",313)

"BLD",443,"KRN",9.8,"NM","B","XMM2",314)

"BLD",443,"KRN",9.8,"NM","B","XMNETV",169)

"BLD",443,"KRN",9.8,"NM","B","XMNTEG",170)

"BLD",443,"KRN",9.8,"NM","B","XMNTEG0",171)

"BLD",443,"KRN",9.8,"NM","B","XMP",45)

"BLD",443,"KRN",9.8,"NM","B","XMP2",315)

"BLD",443,"KRN",9.8,"NM","B","XMP2A",316)

"BLD",443,"KRN",9.8,"NM","B","XMP3",46)

"BLD",443,"KRN",9.8,"NM","B","XMPC",317)

"BLD",443,"KRN",9.8,"NM","B","XMPD",172)

"BLD",443,"KRN",9.8,"NM","B","XMPDAT",224)

"BLD",443,"KRN",9.8,"NM","B","XMPG",318)

"BLD",443,"KRN",9.8,"NM","B","XMPH",319)

"BLD",443,"KRN",9.8,"NM","B","XMPSEC",320)

"BLD",443,"KRN",9.8,"NM","B","XMPX",234)

"BLD",443,"KRN",9.8,"NM","B","XMR",47)

"BLD",443,"KRN",9.8,"NM","B","XMR0",48)

"BLD",443,"KRN",9.8,"NM","B","XMR0A",49)

"BLD",443,"KRN",9.8,"NM","B","XMR0B",50)

"BLD",443,"KRN",9.8,"NM","B","XMR0BLOB",321)

"BLD",443,"KRN",9.8,"NM","B","XMR1",51)

"BLD",443,"KRN",9.8,"NM","B","XMR1A",52)

"BLD",443,"KRN",9.8,"NM","B","XMR2",53)

"BLD",443,"KRN",9.8,"NM","B","XMR3",54)

"BLD",443,"KRN",9.8,"NM","B","XMR3A",55)

"BLD",443,"KRN",9.8,"NM","B","XMR4",56)

"BLD",443,"KRN",9.8,"NM","B","XMRENT",57)

"BLD",443,"KRN",9.8,"NM","B","XMRFTP",322)

"BLD",443,"KRN",9.8,"NM","B","XMRFTPUX",323)

"BLD",443,"KRN",9.8,"NM","B","XMRINETD",324)

"BLD",443,"KRN",9.8,"NM","B","XMRMSM",325)

"BLD",443,"KRN",9.8,"NM","B","XMRONT",326)

"BLD",443,"KRN",9.8,"NM","B","XMRPCTS",327)

"BLD",443,"KRN",9.8,"NM","B","XMRPCTS0",58)

"BLD",443,"KRN",9.8,"NM","B","XMRPCTS1",328)

"BLD",443,"KRN",9.8,"NM","B","XMRPCTSA",329)

"BLD",443,"KRN",9.8,"NM","B","XMRPOP",330)

"BLD",443,"KRN",9.8,"NM","B","XMRTCP",59)

"BLD",443,"KRN",9.8,"NM","B","XMRTCPGO",331)

"BLD",443,"KRN",9.8,"NM","B","XMRUCX",332)

"BLD",443,"KRN",9.8,"NM","B","XMS",60)

"BLD",443,"KRN",9.8,"NM","B","XMS0",61)

"BLD",443,"KRN",9.8,"NM","B","XMS0A",62)

"BLD",443,"KRN",9.8,"NM","B","XMS0BLOB",63)

"BLD",443,"KRN",9.8,"NM","B","XMS1",64)

"BLD",443,"KRN",9.8,"NM","B","XMS1P",65)

"BLD",443,"KRN",9.8,"NM","B","XMS2",66)

"BLD",443,"KRN",9.8,"NM","B","XMS3",67)

"BLD",443,"KRN",9.8,"NM","B","XMS4",68)

"BLD",443,"KRN",9.8,"NM","B","XMS5",69)

"BLD",443,"KRN",9.8,"NM","B","XMS5A",70)

"BLD",443,"KRN",9.8,"NM","B","XMS5B",71)

"BLD",443,"KRN",9.8,"NM","B","XMSER",173)

"BLD",443,"KRN",9.8,"NM","B","XMSERR",72)

"BLD",443,"KRN",9.8,"NM","B","XMSFTP",333)

"BLD",443,"KRN",9.8,"NM","B","XMSFTPUX",334)

"BLD",443,"KRN",9.8,"NM","B","XMSM",73)

"BLD",443,"KRN",9.8,"NM","B","XMSM1",74)

"BLD",443,"KRN",9.8,"NM","B","XMSMAIL",75)

"BLD",443,"KRN",9.8,"NM","B","XMTDF",335)

"BLD",443,"KRN",9.8,"NM","B","XMTDL",76)

"BLD",443,"KRN",9.8,"NM","B","XMTDL1",336)

"BLD",443,"KRN",9.8,"NM","B","XMTDL2",337)

"BLD",443,"KRN",9.8,"NM","B","XMTDO",77)

"BLD",443,"KRN",9.8,"NM","B","XMTDR",78)

"BLD",443,"KRN",9.8,"NM","B","XMTDT",338)

"BLD",443,"KRN",9.8,"NM","B","XMUCXPOP",388)

"BLD",443,"KRN",9.8,"NM","B","XMUDCHK",231)

"BLD",443,"KRN",9.8,"NM","B","XMUDCHR",179)

"BLD",443,"KRN",9.8,"NM","B","XMUDNC",339)

"BLD",443,"KRN",9.8,"NM","B","XMUDTOP",340)

"BLD",443,"KRN",9.8,"NM","B","XMUPIN",341)

"BLD",443,"KRN",9.8,"NM","B","XMUT1",80)

"BLD",443,"KRN",9.8,"NM","B","XMUT1A",81)

"BLD",443,"KRN",9.8,"NM","B","XMUT1B",235)

"BLD",443,"KRN",9.8,"NM","B","XMUT2",342)

"BLD",443,"KRN",9.8,"NM","B","XMUT4",343)

"BLD",443,"KRN",9.8,"NM","B","XMUT41",344)

"BLD",443,"KRN",9.8,"NM","B","XMUT4A",345)

"BLD",443,"KRN",9.8,"NM","B","XMUT4B",158)

"BLD",443,"KRN",9.8,"NM","B","XMUT4BA",159)

"BLD",443,"KRN",9.8,"NM","B","XMUT4C",346)

"BLD",443,"KRN",9.8,"NM","B","XMUT5",347)

"BLD",443,"KRN",9.8,"NM","B","XMUT5B",389)

"BLD",443,"KRN",9.8,"NM","B","XMUT5C",348)

"BLD",443,"KRN",9.8,"NM","B","XMUT5G",349)

"BLD",443,"KRN",9.8,"NM","B","XMUT5Q",350)

"BLD",443,"KRN",9.8,"NM","B","XMUT5Q1",351)

"BLD",443,"KRN",9.8,"NM","B","XMUT5R",236)

"BLD",443,"KRN",9.8,"NM","B","XMUT5R1",352)

"BLD",443,"KRN",9.8,"NM","B","XMUT5R2",353)

"BLD",443,"KRN",9.8,"NM","B","XMUT6",354)

"BLD",443,"KRN",9.8,"NM","B","XMUT7",82)

"BLD",443,"KRN",9.8,"NM","B","XMUTASK",237)

"BLD",443,"KRN",9.8,"NM","B","XMUTCOM1",355)

"BLD",443,"KRN",9.8,"NM","B","XMUTERM",356)

"BLD",443,"KRN",9.8,"NM","B","XMUTERM1",83)

"BLD",443,"KRN",9.8,"NM","B","XMUTERM2",84)

"BLD",443,"KRN",9.8,"NM","B","XMUTPUR0",357)

"BLD",443,"KRN",9.8,"NM","B","XMVA",174)

"BLD",443,"KRN",9.8,"NM","B","XMVCODE",175)

"BLD",443,"KRN",9.8,"NM","B","XMVGROUP",227)

"BLD",443,"KRN",9.8,"NM","B","XMVGRP",85)

"BLD",443,"KRN",9.8,"NM","B","XMVPIC",176)

"BLD",443,"KRN",9.8,"NM","B","XMVSTUFF",177)

"BLD",443,"KRN",9.8,"NM","B","XMVSURR",358)

"BLD",443,"KRN",9.8,"NM","B","XMVTEST",178)

"BLD",443,"KRN",9.8,"NM","B","XMVVITA",225)

"BLD",443,"KRN",9.8,"NM","B","XMVVITAE",86)

"BLD",443,"KRN",9.8,"NM","B","XMXADDR",87)

"BLD",443,"KRN",9.8,"NM","B","XMXADDR1",88)

"BLD",443,"KRN",9.8,"NM","B","XMXADDR2",89)

"BLD",443,"KRN",9.8,"NM","B","XMXADDR3",223)

"BLD",443,"KRN",9.8,"NM","B","XMXADDR4",90)

"BLD",443,"KRN",9.8,"NM","B","XMXADDRD",359)

"BLD",443,"KRN",9.8,"NM","B","XMXADDRG",360)

"BLD",443,"KRN",9.8,"NM","B","XMXANSER",361)

"BLD",443,"KRN",9.8,"NM","B","XMXAPI",362)

"BLD",443,"KRN",9.8,"NM","B","XMXAPIB",363)

"BLD",443,"KRN",9.8,"NM","B","XMXAPIG",364)

"BLD",443,"KRN",9.8,"NM","B","XMXAPIU",365)

"BLD",443,"KRN",9.8,"NM","B","XMXBSKT",366)

"BLD",443,"KRN",9.8,"NM","B","XMXBULL",367)

"BLD",443,"KRN",9.8,"NM","B","XMXEDIT",368)

"BLD",443,"KRN",9.8,"NM","B","XMXGRP",228)

"BLD",443,"KRN",9.8,"NM","B","XMXGRP1",369)

"BLD",443,"KRN",9.8,"NM","B","XMXLIST",370)

"BLD",443,"KRN",9.8,"NM","B","XMXLIST1",371)

"BLD",443,"KRN",9.8,"NM","B","XMXLIST2",372)

"BLD",443,"KRN",9.8,"NM","B","XMXMBOX",373)

"BLD",443,"KRN",9.8,"NM","B","XMXMSGS",91)

"BLD",443,"KRN",9.8,"NM","B","XMXMSGS1",92)

"BLD",443,"KRN",9.8,"NM","B","XMXMSGS2",374)

"BLD",443,"KRN",9.8,"NM","B","XMXPARM",93)

"BLD",443,"KRN",9.8,"NM","B","XMXPARM1",375)

"BLD",443,"KRN",9.8,"NM","B","XMXPARMB",376)

"BLD",443,"KRN",9.8,"NM","B","XMXPRT",377)

"BLD",443,"KRN",9.8,"NM","B","XMXREPLY",94)

"BLD",443,"KRN",9.8,"NM","B","XMXSEC",378)

"BLD",443,"KRN",9.8,"NM","B","XMXSEC1",95)

"BLD",443,"KRN",9.8,"NM","B","XMXSEC2",379)

"BLD",443,"KRN",9.8,"NM","B","XMXSEC3",96)

"BLD",443,"KRN",9.8,"NM","B","XMXSEND",380)

"BLD",443,"KRN",9.8,"NM","B","XMXTO",381)

"BLD",443,"KRN",9.8,"NM","B","XMXUTIL",97)

"BLD",443,"KRN",9.8,"NM","B","XMXUTIL1",98)

"BLD",443,"KRN",9.8,"NM","B","XMXUTIL2",382)

"BLD",443,"KRN",9.8,"NM","B","XMXUTIL3",383)

"BLD",443,"KRN",9.8,"NM","B","XMXUTIL4",229)

"BLD",443,"KRN",9.8,"NM","B","XMYMNEM",210)

"BLD",443,"KRN",9.8,"NM","B","XMYMNEM0",211)

"BLD",443,"KRN",9.8,"NM","B","XMYMNEM1",212)

"BLD",443,"KRN",9.8,"NM","B","XMYMNEM2",213)

"BLD",443,"KRN",9.8,"NM","B","XMYPDOM",214)

"BLD",443,"KRN",9.8,"NM","B","XMYPDOM1",215)

"BLD",443,"KRN",9.8,"NM","B","XMYPOSD",180)

"BLD",443,"KRN",9.8,"NM","B","XMYPOST",181)

"BLD",443,"KRN",9.8,"NM","B","XMYPOST0",182)

"BLD",443,"KRN",9.8,"NM","B","XMYPOST1",183)

"BLD",443,"KRN",9.8,"NM","B","XMYPOST2",184)

"BLD",443,"KRN",9.8,"NM","B","XMYPOST3",185)

"BLD",443,"KRN",9.8,"NM","B","XMYPOST4",186)

"BLD",443,"KRN",9.8,"NM","B","XMYPOST5",187)

"BLD",443,"KRN",9.8,"NM","B","XMYPOST6",188)

"BLD",443,"KRN",9.8,"NM","B","XMYPOST7",189)

"BLD",443,"KRN",9.8,"NM","B","XMYPOST8",190)

"BLD",443,"KRN",9.8,"NM","B","XMYPOST9",191)

"BLD",443,"KRN",9.8,"NM","B","XMYPOSTA",192)

"BLD",443,"KRN",9.8,"NM","B","XMYPOSTB",193)

"BLD",443,"KRN",9.8,"NM","B","XMYPOSTC",194)

"BLD",443,"KRN",9.8,"NM","B","XMYPOSTD",195)

"BLD",443,"KRN",9.8,"NM","B","XMYPRE",99)

"BLD",443,"KRN",9.8,"NM","B","XMYPRE1",196)

"BLD",443,"KRN",9.8,"NM","B","XMYPRE10",197)

"BLD",443,"KRN",9.8,"NM","B","XMYPRE11",198)

"BLD",443,"KRN",9.8,"NM","B","XMYPRE2",199)

"BLD",443,"KRN",9.8,"NM","B","XMYPRE2A",200)

"BLD",443,"KRN",9.8,"NM","B","XMYPRE2B",201)

"BLD",443,"KRN",9.8,"NM","B","XMYPRE3",202)

"BLD",443,"KRN",9.8,"NM","B","XMYPRE4",203)

"BLD",443,"KRN",9.8,"NM","B","XMYPRE5",204)

"BLD",443,"KRN",9.8,"NM","B","XMYPRE6",205)

"BLD",443,"KRN",9.8,"NM","B","XMYPRE6A",206)

"BLD",443,"KRN",9.8,"NM","B","XMYPRE7",207)

"BLD",443,"KRN",9.8,"NM","B","XMYPRE8",208)

"BLD",443,"KRN",9.8,"NM","B","XMYPRE9",209)

"BLD",443,"KRN",19,0)
19
"BLD",443,"KRN",19,"NM",0)
^9.68A^182^142
"BLD",443,"KRN",19,"NM",4,0)
XMEDIT-DOMAIN-VALIDATION#^^0
"BLD",443,"KRN",19,"NM",5,0)
XMLIST^^0
"BLD",443,"KRN",19,"NM",7,0)
XMQACTIVE^^0
"BLD",443,"KRN",19,"NM",8,0)
XMQDISP^^0
"BLD",443,"KRN",19,"NM",9,0)
XMQHIST^^0
"BLD",443,"KRN",19,"NM",10,0)
XMQSHOW^^0
"BLD",443,"KRN",19,"NM",12,0)
XMR-SEQ-RECEIVE^^0
"BLD",443,"KRN",19,"NM",15,0)
XMS-SEQ-TRANSMIT^^0
"BLD",443,"KRN",19,"NM",16,0)
XMSCRIPTEDIT^^0
"BLD",443,"KRN",19,"NM",17,0)
XMSCRIPTOUT^^0
"BLD",443,"KRN",19,"NM",18,0)
XMSCRIPTPLAY^^0
"BLD",443,"KRN",19,"NM",19,0)
XMSCRIPTRES^^0
"BLD",443,"KRN",19,"NM",22,0)
XMSUBEDIT^^0
"BLD",443,"KRN",19,"NM",24,0)
XMCHRIS^^0
"BLD",443,"KRN",19,"NM",28,0)
XM DELIVERY BASKET EDIT^^0
"BLD",443,"KRN",19,"NM",31,0)
XM SUPER SEARCH^^0
"BLD",443,"KRN",19,"NM",34,0)
XM-NEW-FEATURES^^0
"BLD",443,"KRN",19,"NM",35,0)
XMASSUME^^0
"BLD",443,"KRN",19,"NM",36,0)
XMAUTOPURGE^^0
"BLD",443,"KRN",19,"NM",37,0)
XMBANNER^^0
"BLD",443,"KRN",19,"NM",38,0)
XMBASKLIST^^0
"BLD",443,"KRN",19,"NM",39,0)
XMBLOBSEND^^0
"BLD",443,"KRN",19,"NM",40,0)
XMCLEAN^^0
"BLD",443,"KRN",19,"NM",41,0)
XMDX^^3
"BLD",443,"KRN",19,"NM",43,0)
XMDXMODEM^^0
"BLD",443,"KRN",19,"NM",44,0)
XMDXNAME^^0
"BLD",443,"KRN",19,"NM",45,0)
XMDXPROT^^0
"BLD",443,"KRN",19,"NM",46,0)
XMDXSCRIPT^^0
"BLD",443,"KRN",19,"NM",47,0)
XMDXSMTP^^0
"BLD",443,"KRN",19,"NM",49,0)
XMEDITBUL^^0
"BLD",443,"KRN",19,"NM",50,0)
XMEDITDIST^^0
"BLD",443,"KRN",19,"NM",51,0)
XMEDITFWD^^0
"BLD",443,"KRN",19,"NM",52,0)
XMEDITMG^^0
"BLD",443,"KRN",19,"NM",53,0)
XMEDITPERSGROUP^^0
"BLD",443,"KRN",19,"NM",54,0)
XMEDITSURR^^0
"BLD",443,"KRN",19,"NM",56,0)
XMENROLL^^0
"BLD",443,"KRN",19,"NM",57,0)
XMHELP^^3
"BLD",443,"KRN",19,"NM",58,0)
XMHELP-ON-LINE-USER_MANUAL^^0
"BLD",443,"KRN",19,"NM",59,0)
XMHELPALL^^0
"BLD",443,"KRN",19,"NM",60,0)
XMHELPGROUP^^0
"BLD",443,"KRN",19,"NM",61,0)
XMHELPLNK^^0
"BLD",443,"KRN",19,"NM",62,0)
XMHELPQUEST^^0
"BLD",443,"KRN",19,"NM",63,0)
XMHELPUSER^^0
"BLD",443,"KRN",19,"NM",66,0)
XMLATER-REPORT^^0
"BLD",443,"KRN",19,"NM",67,0)
XMMASTER^^3
"BLD",443,"KRN",19,"NM",69,0)
XMMGR-BACKGROUND-FILER^^3
"BLD",443,"KRN",19,"NM",70,0)
XMMGR-BKFILER-ACT^^0
"BLD",443,"KRN",19,"NM",71,0)
XMMGR-BKFILER-EDIT-NORMALIZED^^0
"BLD",443,"KRN",19,"NM",72,0)
XMMGR-BKFILER-GROUP^^0
"BLD",443,"KRN",19,"NM",73,0)
XMMGR-BKFILER-STAT^^0
"BLD",443,"KRN",19,"NM",74,0)
XMMGR-BKFILER-TABBED-STATS^^0
"BLD",443,"KRN",19,"NM",75,0)
XMMGR-BKFILER-WAIT^^0
"BLD",443,"KRN",19,"NM",76,0)
XMMGR-CHECK-BACKGROUND-FILER^^0
"BLD",443,"KRN",19,"NM",78,0)
XMMGR-DIRECTORY-ALL^^0
"BLD",443,"KRN",19,"NM",79,0)
XMMGR-DIRECTORY-EDITGRP^^0
"BLD",443,"KRN",19,"NM",80,0)
XMMGR-DIRECTORY-GROUP^^0
"BLD",443,"KRN",19,"NM",81,0)
XMMGR-DIRECTORY-LISTGRP^^0
"BLD",443,"KRN",19,"NM",82,0)
XMMGR-DIRECTORY-MAIN^^3
"BLD",443,"KRN",19,"NM",83,0)
XMMGR-DIRECTORY-RECV^^0
"BLD",443,"KRN",19,"NM",84,0)
XMMGR-DIRECTORY-SEND^^0
"BLD",443,"KRN",19,"NM",85,0)
XMMGR-DIRECTORY-SINGLE^^0
"BLD",443,"KRN",19,"NM",86,0)
XMMGR-DIRECTORY-VACO^^0
"BLD",443,"KRN",19,"NM",87,0)
XMMGR-DISK-MANY-MESSAGE-MAINT^^0
"BLD",443,"KRN",19,"NM",88,0)
XMMGR-DISK-SPACE-MANAGEMENT^^3
"BLD",443,"KRN",19,"NM",89,0)
XMMGR-GROUP-MAINTENANCE^^3
"BLD",443,"KRN",19,"NM",93,0)
XMMGR-MAIL-GRP-COORD-W/REMOTES^^0
"BLD",443,"KRN",19,"NM",94,0)
XMMGR-MAIL-GRP-COORDINATOR^^0
"BLD",443,"KRN",19,"NM",95,0)
XMMGR-MESSAGE-DELIVERY-MGT^^3
"BLD",443,"KRN",19,"NM",96,0)
XMMGR-NEW-MAIL-BOX^^0
"BLD",443,"KRN",19,"NM",97,0)
XMMGR-NEWMESS/LOGON-STATS^^0
"BLD",443,"KRN",19,"NM",98,0)
XMMGR-PURGE-AI-XREF^^0
"BLD",443,"KRN",19,"NM",100,0)
XMMGR-RESPONSE-TIME-COMPILER^^0
"BLD",443,"KRN",19,"NM",101,0)
XMMGR-RESPONSE-TIME-TOGGLER^^0
"BLD",443,"KRN",19,"NM",102,0)
XMMGR-START-BACKGROUND-FILER^^0
"BLD",443,"KRN",19,"NM",103,0)
XMMGR-STOP-BACKGROUND-FILER^^0
"BLD",443,"KRN",19,"NM",104,0)
XMMGR-TERMINATE-MANY^^0
"BLD",443,"KRN",19,"NM",106,0)
XMMGR-TERMINATE-SUGGEST^^0
"BLD",443,"KRN",19,"NM",107,0)
XMNET^^3
"BLD",443,"KRN",19,"NM",109,0)
XMNET-TRANSMISSION-MANAGEMENT^^3
"BLD",443,"KRN",19,"NM",110,0)
XMNET-TWIX-SEND^^0
"BLD",443,"KRN",19,"NM",111,0)
XMNET-TWIX-TRANSMIT^^0
"BLD",443,"KRN",19,"NM",113,0)
XMNEW^^0
"BLD",443,"KRN",19,"NM",114,0)
XMOTHER^^3
"BLD",443,"KRN",19,"NM",115,0)
XMOTHER-COMMUNICATIONS^^3
"BLD",443,"KRN",19,"NM",117,0)
XMPCOM^^0
"BLD",443,"KRN",19,"NM",118,0)
XMPGLO^^0
"BLD",443,"KRN",19,"NM",119,0)
XMPINS^^0
"BLD",443,"KRN",19,"NM",120,0)
XMPOST^^0
"BLD",443,"KRN",19,"NM",121,0)
XMPPRT^^0
"BLD",443,"KRN",19,"NM",122,0)
XMPRECV^^3
"BLD",443,"KRN",19,"NM",123,0)
XMPROU^^0
"BLD",443,"KRN",19,"NM",124,0)
XMPSEND^^3
"BLD",443,"KRN",19,"NM",125,0)
XMPSUM^^0
"BLD",443,"KRN",19,"NM",126,0)
XMPURGE^^0
"BLD",443,"KRN",19,"NM",127,0)
XMPURGE-BY-DATE^^0
"BLD",443,"KRN",19,"NM",128,0)
XMR-BROADCAST-VA-WIDE^^0
"BLD",443,"KRN",19,"NM",129,0)
XMREAD^^0
"BLD",443,"KRN",19,"NM",130,0)
XMRONT^^0
"BLD",443,"KRN",19,"NM",132,0)
XMSEND^^0
"BLD",443,"KRN",19,"NM",133,0)
XMSHARE^^0
"BLD",443,"KRN",19,"NM",135,0)
XMSTAT^^0
"BLD",443,"KRN",19,"NM",136,0)
XMSUGGESTION^^0
"BLD",443,"KRN",19,"NM",137,0)
XMUSER^^3
"BLD",443,"KRN",19,"NM",138,0)
XMUT-CHKFIL^^0
"BLD",443,"KRN",19,"NM",139,0)
XMUT-REC-DELETE^^0
"BLD",443,"KRN",19,"NM",144,0)
XMYB-BROADCAST-VA-WIDE^^0
"BLD",443,"KRN",19,"NM",147,0)
XMPACK^^0
"BLD",443,"KRN",19,"NM",148,0)
XMTALK^^0
"BLD",443,"KRN",19,"NM",149,0)
XMUT-REC-DELIVER^^0
"BLD",443,"KRN",19,"NM",150,0)
XMUT-REC-FIND^^0
"BLD",443,"KRN",19,"NM",151,0)
XMUT-REC-RPT^^0
"BLD",443,"KRN",19,"NM",152,0)
XMUT-REC-MENU^^3
"BLD",443,"KRN",19,"NM",153,0)
XMPOLL^^0
"BLD",443,"KRN",19,"NM",154,0)
XMMGR-IN-BASKET-PURGE^^0
"BLD",443,"KRN",19,"NM",155,0)
XMSTARTQUE-ALL^^0
"BLD",443,"KRN",19,"NM",156,0)
XMSTARTQUE^^0
"BLD",443,"KRN",19,"NM",157,0)
XMMGR-HELP^^0
"BLD",443,"KRN",19,"NM",158,0)
XMR-UCI-RCV^^0
"BLD",443,"KRN",19,"NM",159,0)
XMR-UCI-SEND^^0
"BLD",443,"KRN",19,"NM",160,0)
XMMGR^^3
"BLD",443,"KRN",19,"NM",161,0)
XMNETHELP^^0
"BLD",443,"KRN",19,"NM",162,0)
XM FILTER EDIT^^0
"BLD",443,"KRN",19,"NM",163,0)
XM PERSONAL MENU^^3
"BLD",443,"KRN",19,"NM",164,0)
XM-FTP-GET^^0
"BLD",443,"KRN",19,"NM",165,0)
XM-FTP-PUT^^0
"BLD",443,"KRN",19,"NM",166,0)
XMEDIT-REMOTE-USER^^0
"BLD",443,"KRN",19,"NM",167,0)
XMEDITUSER^^0
"BLD",443,"KRN",19,"NM",168,0)
XMKSP^^0
"BLD",443,"KRN",19,"NM",169,0)
XMLATER-EDIT^^0
"BLD",443,"KRN",19,"NM",170,0)
XMMGR-LARGE-MESSAGE-REPORT^^0
"BLD",443,"KRN",19,"NM",171,0)
XMMGR-PURGE-MESSAGE^^0
"BLD",443,"KRN",19,"NM",172,0)
XMMGR-TERMINATE-ONE^^0
"BLD",443,"KRN",19,"NM",173,0)
XMNET-QUEUE-MANAGEMENT^^3
"BLD",443,"KRN",19,"NM",174,0)
XMQDOMAINS^^0
"BLD",443,"KRN",19,"NM",175,0)
XMQUEUED^^0
"BLD",443,"KRN",19,"NM",176,0)
XMSEARCH^^0
"BLD",443,"KRN",19,"NM",177,0)
XMSITE^^0
"BLD",443,"KRN",19,"NM",178,0)
XMMGR-DELIVERY-STATS-COLL^^0
"BLD",443,"KRN",19,"NM",179,0)
XMDXERROR^^1^
"BLD",443,"KRN",19,"NM",180,0)
XMDXSERVER^^1^
"BLD",443,"KRN",19,"NM",181,0)
XMDXVADATS^^1^
"BLD",443,"KRN",19,"NM",182,0)
XMPDAT^^1^
"BLD",443,"KRN",19,"NM","B","XM DELIVERY BASKET EDIT",28)

"BLD",443,"KRN",19,"NM","B","XM FILTER EDIT",162)

"BLD",443,"KRN",19,"NM","B","XM PERSONAL MENU",163)

"BLD",443,"KRN",19,"NM","B","XM SUPER SEARCH",31)

"BLD",443,"KRN",19,"NM","B","XM-FTP-GET",164)

"BLD",443,"KRN",19,"NM","B","XM-FTP-PUT",165)

"BLD",443,"KRN",19,"NM","B","XM-NEW-FEATURES",34)

"BLD",443,"KRN",19,"NM","B","XMASSUME",35)

"BLD",443,"KRN",19,"NM","B","XMAUTOPURGE",36)

"BLD",443,"KRN",19,"NM","B","XMBANNER",37)

"BLD",443,"KRN",19,"NM","B","XMBASKLIST",38)

"BLD",443,"KRN",19,"NM","B","XMBLOBSEND",39)

"BLD",443,"KRN",19,"NM","B","XMCHRIS",24)

"BLD",443,"KRN",19,"NM","B","XMCLEAN",40)

"BLD",443,"KRN",19,"NM","B","XMDX",41)

"BLD",443,"KRN",19,"NM","B","XMDXERROR",179)

"BLD",443,"KRN",19,"NM","B","XMDXMODEM",43)

"BLD",443,"KRN",19,"NM","B","XMDXNAME",44)

"BLD",443,"KRN",19,"NM","B","XMDXPROT",45)

"BLD",443,"KRN",19,"NM","B","XMDXSCRIPT",46)

"BLD",443,"KRN",19,"NM","B","XMDXSERVER",180)

"BLD",443,"KRN",19,"NM","B","XMDXSMTP",47)

"BLD",443,"KRN",19,"NM","B","XMDXVADATS",181)

"BLD",443,"KRN",19,"NM","B","XMEDIT-DOMAIN-VALIDATION#",4)

"BLD",443,"KRN",19,"NM","B","XMEDIT-REMOTE-USER",166)

"BLD",443,"KRN",19,"NM","B","XMEDITBUL",49)

"BLD",443,"KRN",19,"NM","B","XMEDITDIST",50)

"BLD",443,"KRN",19,"NM","B","XMEDITFWD",51)

"BLD",443,"KRN",19,"NM","B","XMEDITMG",52)

"BLD",443,"KRN",19,"NM","B","XMEDITPERSGROUP",53)

"BLD",443,"KRN",19,"NM","B","XMEDITSURR",54)

"BLD",443,"KRN",19,"NM","B","XMEDITUSER",167)

"BLD",443,"KRN",19,"NM","B","XMENROLL",56)

"BLD",443,"KRN",19,"NM","B","XMHELP",57)

"BLD",443,"KRN",19,"NM","B","XMHELP-ON-LINE-USER_MANUAL",58)

"BLD",443,"KRN",19,"NM","B","XMHELPALL",59)

"BLD",443,"KRN",19,"NM","B","XMHELPGROUP",60)

"BLD",443,"KRN",19,"NM","B","XMHELPLNK",61)

"BLD",443,"KRN",19,"NM","B","XMHELPQUEST",62)

"BLD",443,"KRN",19,"NM","B","XMHELPUSER",63)

"BLD",443,"KRN",19,"NM","B","XMKSP",168)

"BLD",443,"KRN",19,"NM","B","XMLATER-EDIT",169)

"BLD",443,"KRN",19,"NM","B","XMLATER-REPORT",66)

"BLD",443,"KRN",19,"NM","B","XMLIST",5)

"BLD",443,"KRN",19,"NM","B","XMMASTER",67)

"BLD",443,"KRN",19,"NM","B","XMMGR",160)

"BLD",443,"KRN",19,"NM","B","XMMGR-BACKGROUND-FILER",69)

"BLD",443,"KRN",19,"NM","B","XMMGR-BKFILER-ACT",70)

"BLD",443,"KRN",19,"NM","B","XMMGR-BKFILER-EDIT-NORMALIZED",71)

"BLD",443,"KRN",19,"NM","B","XMMGR-BKFILER-GROUP",72)

"BLD",443,"KRN",19,"NM","B","XMMGR-BKFILER-STAT",73)

"BLD",443,"KRN",19,"NM","B","XMMGR-BKFILER-TABBED-STATS",74)

"BLD",443,"KRN",19,"NM","B","XMMGR-BKFILER-WAIT",75)

"BLD",443,"KRN",19,"NM","B","XMMGR-CHECK-BACKGROUND-FILER",76)

"BLD",443,"KRN",19,"NM","B","XMMGR-DELIVERY-STATS-COLL",178)

"BLD",443,"KRN",19,"NM","B","XMMGR-DIRECTORY-ALL",78)

"BLD",443,"KRN",19,"NM","B","XMMGR-DIRECTORY-EDITGRP",79)

"BLD",443,"KRN",19,"NM","B","XMMGR-DIRECTORY-GROUP",80)

"BLD",443,"KRN",19,"NM","B","XMMGR-DIRECTORY-LISTGRP",81)

"BLD",443,"KRN",19,"NM","B","XMMGR-DIRECTORY-MAIN",82)

"BLD",443,"KRN",19,"NM","B","XMMGR-DIRECTORY-RECV",83)

"BLD",443,"KRN",19,"NM","B","XMMGR-DIRECTORY-SEND",84)

"BLD",443,"KRN",19,"NM","B","XMMGR-DIRECTORY-SINGLE",85)

"BLD",443,"KRN",19,"NM","B","XMMGR-DIRECTORY-VACO",86)

"BLD",443,"KRN",19,"NM","B","XMMGR-DISK-MANY-MESSAGE-MAINT",87)

"BLD",443,"KRN",19,"NM","B","XMMGR-DISK-SPACE-MANAGEMENT",88)

"BLD",443,"KRN",19,"NM","B","XMMGR-GROUP-MAINTENANCE",89)

"BLD",443,"KRN",19,"NM","B","XMMGR-HELP",157)

"BLD",443,"KRN",19,"NM","B","XMMGR-IN-BASKET-PURGE",154)

"BLD",443,"KRN",19,"NM","B","XMMGR-LARGE-MESSAGE-REPORT",170)

"BLD",443,"KRN",19,"NM","B","XMMGR-MAIL-GRP-COORD-W/REMOTES",93)

"BLD",443,"KRN",19,"NM","B","XMMGR-MAIL-GRP-COORDINATOR",94)

"BLD",443,"KRN",19,"NM","B","XMMGR-MESSAGE-DELIVERY-MGT",95)

"BLD",443,"KRN",19,"NM","B","XMMGR-NEW-MAIL-BOX",96)

"BLD",443,"KRN",19,"NM","B","XMMGR-NEWMESS/LOGON-STATS",97)

"BLD",443,"KRN",19,"NM","B","XMMGR-PURGE-AI-XREF",98)

"BLD",443,"KRN",19,"NM","B","XMMGR-PURGE-MESSAGE",171)

"BLD",443,"KRN",19,"NM","B","XMMGR-RESPONSE-TIME-COMPILER",100)

"BLD",443,"KRN",19,"NM","B","XMMGR-RESPONSE-TIME-TOGGLER",101)

"BLD",443,"KRN",19,"NM","B","XMMGR-START-BACKGROUND-FILER",102)

"BLD",443,"KRN",19,"NM","B","XMMGR-STOP-BACKGROUND-FILER",103)

"BLD",443,"KRN",19,"NM","B","XMMGR-TERMINATE-MANY",104)

"BLD",443,"KRN",19,"NM","B","XMMGR-TERMINATE-ONE",172)

"BLD",443,"KRN",19,"NM","B","XMMGR-TERMINATE-SUGGEST",106)

"BLD",443,"KRN",19,"NM","B","XMNET",107)

"BLD",443,"KRN",19,"NM","B","XMNET-QUEUE-MANAGEMENT",173)

"BLD",443,"KRN",19,"NM","B","XMNET-TRANSMISSION-MANAGEMENT",109)

"BLD",443,"KRN",19,"NM","B","XMNET-TWIX-SEND",110)

"BLD",443,"KRN",19,"NM","B","XMNET-TWIX-TRANSMIT",111)

"BLD",443,"KRN",19,"NM","B","XMNETHELP",161)

"BLD",443,"KRN",19,"NM","B","XMNEW",113)

"BLD",443,"KRN",19,"NM","B","XMOTHER",114)

"BLD",443,"KRN",19,"NM","B","XMOTHER-COMMUNICATIONS",115)

"BLD",443,"KRN",19,"NM","B","XMPACK",147)

"BLD",443,"KRN",19,"NM","B","XMPCOM",117)

"BLD",443,"KRN",19,"NM","B","XMPDAT",182)

"BLD",443,"KRN",19,"NM","B","XMPGLO",118)

"BLD",443,"KRN",19,"NM","B","XMPINS",119)

"BLD",443,"KRN",19,"NM","B","XMPOLL",153)

"BLD",443,"KRN",19,"NM","B","XMPOST",120)

"BLD",443,"KRN",19,"NM","B","XMPPRT",121)

"BLD",443,"KRN",19,"NM","B","XMPRECV",122)

"BLD",443,"KRN",19,"NM","B","XMPROU",123)

"BLD",443,"KRN",19,"NM","B","XMPSEND",124)

"BLD",443,"KRN",19,"NM","B","XMPSUM",125)

"BLD",443,"KRN",19,"NM","B","XMPURGE",126)

"BLD",443,"KRN",19,"NM","B","XMPURGE-BY-DATE",127)

"BLD",443,"KRN",19,"NM","B","XMQACTIVE",7)

"BLD",443,"KRN",19,"NM","B","XMQDISP",8)

"BLD",443,"KRN",19,"NM","B","XMQDOMAINS",174)

"BLD",443,"KRN",19,"NM","B","XMQHIST",9)

"BLD",443,"KRN",19,"NM","B","XMQSHOW",10)

"BLD",443,"KRN",19,"NM","B","XMQUEUED",175)

"BLD",443,"KRN",19,"NM","B","XMR-BROADCAST-VA-WIDE",128)

"BLD",443,"KRN",19,"NM","B","XMR-SEQ-RECEIVE",12)

"BLD",443,"KRN",19,"NM","B","XMR-UCI-RCV",158)

"BLD",443,"KRN",19,"NM","B","XMR-UCI-SEND",159)

"BLD",443,"KRN",19,"NM","B","XMREAD",129)

"BLD",443,"KRN",19,"NM","B","XMRONT",130)

"BLD",443,"KRN",19,"NM","B","XMS-SEQ-TRANSMIT",15)

"BLD",443,"KRN",19,"NM","B","XMSCRIPTEDIT",16)

"BLD",443,"KRN",19,"NM","B","XMSCRIPTOUT",17)

"BLD",443,"KRN",19,"NM","B","XMSCRIPTPLAY",18)

"BLD",443,"KRN",19,"NM","B","XMSCRIPTRES",19)

"BLD",443,"KRN",19,"NM","B","XMSEARCH",176)

"BLD",443,"KRN",19,"NM","B","XMSEND",132)

"BLD",443,"KRN",19,"NM","B","XMSHARE",133)

"BLD",443,"KRN",19,"NM","B","XMSITE",177)

"BLD",443,"KRN",19,"NM","B","XMSTARTQUE",156)

"BLD",443,"KRN",19,"NM","B","XMSTARTQUE-ALL",155)

"BLD",443,"KRN",19,"NM","B","XMSTAT",135)

"BLD",443,"KRN",19,"NM","B","XMSUBEDIT",22)

"BLD",443,"KRN",19,"NM","B","XMSUGGESTION",136)

"BLD",443,"KRN",19,"NM","B","XMTALK",148)

"BLD",443,"KRN",19,"NM","B","XMUSER",137)

"BLD",443,"KRN",19,"NM","B","XMUT-CHKFIL",138)

"BLD",443,"KRN",19,"NM","B","XMUT-REC-DELETE",139)

"BLD",443,"KRN",19,"NM","B","XMUT-REC-DELIVER",149)

"BLD",443,"KRN",19,"NM","B","XMUT-REC-FIND",150)

"BLD",443,"KRN",19,"NM","B","XMUT-REC-MENU",152)

"BLD",443,"KRN",19,"NM","B","XMUT-REC-RPT",151)

"BLD",443,"KRN",19,"NM","B","XMYB-BROADCAST-VA-WIDE",144)

"BLD",443,"KRN",19.1,0)
19.1
"BLD",443,"KRN",19.1,"NM",0)
^9.68A^13^13
"BLD",443,"KRN",19.1,"NM",1,0)
XMSTAR^^0
"BLD",443,"KRN",19.1,"NM",2,0)
XMSTAR LIMITED^^0
"BLD",443,"KRN",19.1,"NM",3,0)
XMPRIORITY^^1^
"BLD",443,"KRN",19.1,"NM",4,0)
XMPRIORITY-OVERRIDE^^1^
"BLD",443,"KRN",19.1,"NM",5,0)
XM CAC ADPAC^^0
"BLD",443,"KRN",19.1,"NM",6,0)
XM GROUP EDIT MASTER^^0
"BLD",443,"KRN",19.1,"NM",7,0)
XM GROUP PRIORITY^^0
"BLD",443,"KRN",19.1,"NM",8,0)
XM NO BROADCASTS^^0
"BLD",443,"KRN",19.1,"NM",9,0)
XM SUPER SEARCH^^0
"BLD",443,"KRN",19.1,"NM",10,0)
XMMGR^^0
"BLD",443,"KRN",19.1,"NM",11,0)
XMNET^^0
"BLD",443,"KRN",19.1,"NM",12,0)
XMNOPRIV^^0
"BLD",443,"KRN",19.1,"NM",13,0)
XMTALK^^0
"BLD",443,"KRN",19.1,"NM","B","XM CAC ADPAC",5)

"BLD",443,"KRN",19.1,"NM","B","XM GROUP EDIT MASTER",6)

"BLD",443,"KRN",19.1,"NM","B","XM GROUP PRIORITY",7)

"BLD",443,"KRN",19.1,"NM","B","XM NO BROADCASTS",8)

"BLD",443,"KRN",19.1,"NM","B","XM SUPER SEARCH",9)

"BLD",443,"KRN",19.1,"NM","B","XMMGR",10)

"BLD",443,"KRN",19.1,"NM","B","XMNET",11)

"BLD",443,"KRN",19.1,"NM","B","XMNOPRIV",12)

"BLD",443,"KRN",19.1,"NM","B","XMPRIORITY",3)

"BLD",443,"KRN",19.1,"NM","B","XMPRIORITY-OVERRIDE",4)

"BLD",443,"KRN",19.1,"NM","B","XMSTAR",1)

"BLD",443,"KRN",19.1,"NM","B","XMSTAR LIMITED",2)

"BLD",443,"KRN",19.1,"NM","B","XMTALK",13)

"BLD",443,"KRN",101,0)
101
"BLD",443,"KRN",409.61,0)
409.61
"BLD",443,"KRN",409.61,"NM",0)
^9.68A^^0
"BLD",443,"KRN",8989.51,0)
8989.51
"BLD",443,"KRN",8989.51,"NM",0)
^9.68A^^
"BLD",443,"KRN",8989.52,0)
8989.52
"BLD",443,"KRN",8989.52,"NM",0)
^9.68A^^
"BLD",443,"KRN",8994,0)
8994
"BLD",443,"KRN",8994,"NM",0)
^9.68A^^
"BLD",443,"KRN","B",.4,.4)

"BLD",443,"KRN","B",.401,.401)

"BLD",443,"KRN","B",.402,.402)

"BLD",443,"KRN","B",.403,.403)

"BLD",443,"KRN","B",.5,.5)

"BLD",443,"KRN","B",.84,.84)

"BLD",443,"KRN","B",3.6,3.6)

"BLD",443,"KRN","B",3.8,3.8)

"BLD",443,"KRN","B",9.2,9.2)

"BLD",443,"KRN","B",9.8,9.8)

"BLD",443,"KRN","B",19,19)

"BLD",443,"KRN","B",19.1,19.1)

"BLD",443,"KRN","B",101,101)

"BLD",443,"KRN","B",409.61,409.61)

"BLD",443,"KRN","B",8989.51,8989.51)

"BLD",443,"KRN","B",8989.52,8989.52)

"BLD",443,"KRN","B",8994,8994)

"BLD",443,"QUES",0)
^9.62^^
"BLD",443,"REQB",0)
^9.611^^0
"FIA",3.4)
COMMUNICATIONS PROTOCOL
"FIA",3.4,0)
^DIC(3.4,
"FIA",3.4,0,0)
3.4
"FIA",3.4,0,1)
y^y^f^^^^n
"FIA",3.4,0,10)

"FIA",3.4,0,11)

"FIA",3.4,0,"RLRO")

"FIA",3.4,0,"VR")
8.0^MAILMAN
"FIA",3.4,3.4)
0
"FIA",3.4,3.41)
0
"FIA",3.6)
BULLETIN
"FIA",3.6,0)
^XMB(3.6,
"FIA",3.6,0,0)
3.6
"FIA",3.6,0,1)
y^y^f^^^^n
"FIA",3.6,0,10)

"FIA",3.6,0,11)

"FIA",3.6,0,"RLRO")

"FIA",3.6,0,"VR")
8.0^MAILMAN
"FIA",3.6,3.6)
0
"FIA",3.6,3.61)
0
"FIA",3.6,3.62)
0
"FIA",3.6,3.63)
0
"FIA",3.6,3.64)
0
"FIA",3.6,3.65)
0
"FIA",3.7)
MAILBOX
"FIA",3.7,0)
^XMB(3.7,
"FIA",3.7,0,0)
3.7P
"FIA",3.7,0,1)
y^y^f^^^^n
"FIA",3.7,0,10)

"FIA",3.7,0,11)

"FIA",3.7,0,"RLRO")

"FIA",3.7,0,"VR")
8.0^MAILMAN
"FIA",3.7,3.7)
0
"FIA",3.7,3.701)
0
"FIA",3.7,3.702)
0
"FIA",3.7,3.703)
0
"FIA",3.7,3.704)
0
"FIA",3.7,3.715)
0
"FIA",3.7,3.7159)
0
"FIA",3.73)
MESSAGES TO BE NEW AT A LATER DATE
"FIA",3.73,0)
^XMB(3.73,
"FIA",3.73,0,0)
3.73DIAO
"FIA",3.73,0,1)
y^y^f^^^^n
"FIA",3.73,0,10)

"FIA",3.73,0,11)

"FIA",3.73,0,"RLRO")

"FIA",3.73,0,"VR")
8.0^MAILMAN
"FIA",3.73,3.73)
0
"FIA",3.8)
MAIL GROUP
"FIA",3.8,0)
^XMB(3.8,
"FIA",3.8,0,0)
3.8
"FIA",3.8,0,1)
y^y^f^^^^n
"FIA",3.8,0,10)

"FIA",3.8,0,11)

"FIA",3.8,0,"RLRO")

"FIA",3.8,0,"VR")
8.0^MAILMAN
"FIA",3.8,3.8)
0
"FIA",3.8,3.801)
0
"FIA",3.8,3.802)
0
"FIA",3.8,3.81)
0
"FIA",3.8,3.811)
0
"FIA",3.8,3.812)
0
"FIA",3.8,3.813)
0
"FIA",3.8,3.814)
0
"FIA",3.8,3.815)
0
"FIA",3.816)
DISTRIBUTION LIST
"FIA",3.816,0)
^XMB(3.816,
"FIA",3.816,0,0)
3.816
"FIA",3.816,0,1)
y^y^f^^^^n
"FIA",3.816,0,10)

"FIA",3.816,0,11)

"FIA",3.816,0,"RLRO")

"FIA",3.816,0,"VR")
8.0^MAILMAN
"FIA",3.816,3.816)
0
"FIA",3.816,3.8161)
0
"FIA",3.9)
MESSAGE
"FIA",3.9,0)
^XMB(3.9,
"FIA",3.9,0,0)
3.9s
"FIA",3.9,0,1)
y^y^f^^^^n
"FIA",3.9,0,10)

"FIA",3.9,0,11)

"FIA",3.9,0,"RLRO")

"FIA",3.9,0,"VR")
8.0^MAILMAN
"FIA",3.9,3.9)
0
"FIA",3.9,3.9001)
0
"FIA",3.9,3.91)
0
"FIA",3.9,3.911)
0
"FIA",3.9,3.914)
0
"FIA",3.9,3.92)
0
"FIA",3.9,3.92005)
0
"FIA",4.2)
DOMAIN
"FIA",4.2,0)
^DIC(4.2,
"FIA",4.2,0,0)
4.2I
"FIA",4.2,0,1)
y^y^f^^^^n
"FIA",4.2,0,10)

"FIA",4.2,0,11)

"FIA",4.2,0,"RLRO")

"FIA",4.2,0,"VR")
8.0^MAILMAN
"FIA",4.2,4.2)
0
"FIA",4.2,4.21)
0
"FIA",4.2,4.22)
0
"FIA",4.2,4.23)
0
"FIA",4.2,4.24)
0
"FIA",4.2,4.25)
0
"FIA",4.2,4.299)
0
"FIA",4.281)
INTER-UCI TRANSFER
"FIA",4.281,0)
^%ZISL(4.281,
"FIA",4.281,0,0)
4.281
"FIA",4.281,0,1)
y^y^f^^^^n
"FIA",4.281,0,10)

"FIA",4.281,0,11)

"FIA",4.281,0,"RLRO")

"FIA",4.281,0,"VR")
8.0^MAILMAN
"FIA",4.281,4.281)
0
"FIA",4.281,4.2812)
0
"FIA",4.2995)
MAILMAN OUTSTANDING FTP TRANSACTIONS
"FIA",4.2995,0)
^XMBX(4.2995,
"FIA",4.2995,0,0)
4.2995
"FIA",4.2995,0,1)
y^y^f^^^^n
"FIA",4.2995,0,10)

"FIA",4.2995,0,11)

"FIA",4.2995,0,"RLRO")

"FIA",4.2995,0,"VR")
8.0^MAILMAN
"FIA",4.2995,4.2995)
0
"FIA",4.2996)
INTERNET SUFFIX
"FIA",4.2996,0)
^DIC(4.2996,
"FIA",4.2996,0,0)
4.2996I
"FIA",4.2996,0,1)
y^y^f^^^^n
"FIA",4.2996,0,10)

"FIA",4.2996,0,11)

"FIA",4.2996,0,"RLRO")

"FIA",4.2996,0,"VR")
8.0^MAILMAN
"FIA",4.2996,4.2996)
0
"FIA",4.2996,4.29961)
0
"FIA",4.2997)
REMOTE USER DIRECTORY
"FIA",4.2997,0)
^XMD(4.2997,
"FIA",4.2997,0,0)
4.2997I
"FIA",4.2997,0,1)
y^y^f^^^^n
"FIA",4.2997,0,10)

"FIA",4.2997,0,11)

"FIA",4.2997,0,"RLRO")

"FIA",4.2997,0,"VR")
8.0^MAILMAN
"FIA",4.2997,4.2997)
0
"FIA",4.2998)
MESSAGE DELIVERY STATS
"FIA",4.2998,0)
^XMBX(4.2998,
"FIA",4.2998,0,0)
4.2998D
"FIA",4.2998,0,1)
y^y^f^^^^n
"FIA",4.2998,0,10)

"FIA",4.2998,0,11)

"FIA",4.2998,0,"RLRO")

"FIA",4.2998,0,"VR")
8.0^MAILMAN
"FIA",4.2998,4.2998)
0
"FIA",4.2999)
MESSAGE STATISTICS
"FIA",4.2999,0)
^XMBS(4.2999,
"FIA",4.2999,0,0)
4.2999IP
"FIA",4.2999,0,1)
y^y^f^^^^n
"FIA",4.2999,0,10)

"FIA",4.2999,0,11)

"FIA",4.2999,0,"RLRO")

"FIA",4.2999,0,"VR")
8.0^MAILMAN
"FIA",4.2999,4.2999)
0
"FIA",4.2999,4.29991)
0
"FIA",4.2999,4.29992)
0
"FIA",4.3)
MAILMAN SITE PARAMETERS
"FIA",4.3,0)
^XMB(1,
"FIA",4.3,0,0)
4.3P
"FIA",4.3,0,1)
y^y^f^^^^n
"FIA",4.3,0,10)

"FIA",4.3,0,11)

"FIA",4.3,0,"RLRO")

"FIA",4.3,0,"VR")
8.0^MAILMAN
"FIA",4.3,4.3)
0
"FIA",4.3,4.302)
0
"FIA",4.3,4.31)
0
"FIA",4.3,4.32)
0
"FIA",4.3,4.37)
0
"FIA",4.4)
MAILMAN TIME ZONE
"FIA",4.4,0)
^XMB(4.4,
"FIA",4.4,0,0)
4.4I
"FIA",4.4,0,1)
y^y^f^^^^n
"FIA",4.4,0,10)

"FIA",4.4,0,11)

"FIA",4.4,0,"RLRO")

"FIA",4.4,0,"VR")
8.0^MAILMAN
"FIA",4.4,4.4)
0
"FIA",4.501)
NETWORK SENDERS REJECTED
"FIA",4.501,0)
^XMBX(4.501,
"FIA",4.501,0,0)
4.501
"FIA",4.501,0,1)
y^y^f^^^^n
"FIA",4.501,0,10)

"FIA",4.501,0,11)

"FIA",4.501,0,"RLRO")

"FIA",4.501,0,"VR")
8.0^MAILMAN
"FIA",4.501,4.501)
0
"FIA",4.6)
TRANSMISSION SCRIPT
"FIA",4.6,0)
^XMB(4.6,
"FIA",4.6,0,0)
4.6
"FIA",4.6,0,1)
y^y^f^^^^n
"FIA",4.6,0,10)

"FIA",4.6,0,11)

"FIA",4.6,0,"RLRO")

"FIA",4.6,0,"VR")
8.0^MAILMAN
"FIA",4.6,4.6)
0
"FIA",4.6,4.61)
0
"FIA",4.6,4.62)
0
"INI")
PRE^XMYPRE
"INIT")
POST^XMYPRE
"IX",3.7,3.702,"AC",0)
3.702^AC^Transmission Priority Cross Reference^R^^F^IR^I^3.702^^^^^S
"IX",3.7,3.702,"AC",.1,0)
^^3^3^3020222^
"IX",3.7,3.702,"AC",.1,1,0)
This xref is used by MailMan during message transmission to identify
"IX",3.7,3.702,"AC",.1,2,0)
messages which should be transmitted first (high priority) or last
"IX",3.7,3.702,"AC",.1,3,0)
(low priority).  Messages with regular priority are not xref'd.
"IX",3.7,3.702,"AC",1)
S ^XMB(3.7,DA(2),2,DA(1),1,"AC",$E(X,1,1),DA)=""
"IX",3.7,3.702,"AC",1.4)
S X=X
"IX",3.7,3.702,"AC",2)
K ^XMB(3.7,DA(2),2,DA(1),1,"AC",$E(X,1,1),DA)
"IX",3.7,3.702,"AC",2.4)
S X=X
"IX",3.7,3.702,"AC",2.5)
K ^XMB(3.7,DA(2),2,DA(1),1,"AC")
"IX",3.7,3.702,"AC",11.1,0)
^.114IA^1^1
"IX",3.7,3.702,"AC",11.1,1,0)
1^F^3.702^6^1^1^F
"IX",3.7,3.702,"AC",11.1,1,3)

"IX",3.8,3.81,"AC",0)
3.81^AC^Set a local variable when a new member is added.^MU^^F^^I^3.81^^^^^A
"IX",3.8,3.81,"AC",.1,0)
^^8^8^3010212^^^^
"IX",3.8,3.81,"AC",.1,1,0)
This xref only works while under control of one of the MailMan options
"IX",3.8,3.81,"AC",.1,2,0)
to edit mail groups.  Variable XMTRKNEW is set to activate the xref.
"IX",3.8,3.81,"AC",.1,3,0)
 
"IX",3.8,3.81,"AC",.1,4,0)
When a new member is added, this xref adds that member to a local array.
"IX",3.8,3.81,"AC",.1,5,0)
Once the user is finished editing this mail group, and if new members
"IX",3.8,3.81,"AC",.1,6,0)
have been added, MailMan may use the local array to find and forward
"IX",3.8,3.81,"AC",.1,7,0)
previous mail group messages to the new members, depending on what the
"IX",3.8,3.81,"AC",.1,8,0)
user wants.
"IX",3.8,3.81,"AC",1)
S XMNEWMBR(X2(1))=""
"IX",3.8,3.81,"AC",1.4)
S X=$S('$G(XMTRKNEW):0,X1(1)="":1,1:0)
"IX",3.8,3.81,"AC",2)
Q
"IX",3.8,3.81,"AC",11.1,0)
^.114IA^1^1
"IX",3.8,3.81,"AC",11.1,1,0)
1^F^3.81^.01^^^F
"IX",3.8,3.81,"B",0)
3.81^B^Uniqueness Index for Key 'A' of Subfile #3.81^R^^F^IR^I^3.81^^^^^LS
"IX",3.8,3.81,"B",1)
S ^XMB(3.8,DA(1),1,"B",X,DA)=""
"IX",3.8,3.81,"B",2)
K ^XMB(3.8,DA(1),1,"B",X,DA)
"IX",3.8,3.81,"B",2.5)
K ^XMB(3.8,DA(1),1,"B")
"IX",3.8,3.81,"B",11.1,0)
^.114IA^1^1
"IX",3.8,3.81,"B",11.1,1,0)
1^F^3.81^.01^^1
"IX",3.9,3.9,"AF",0)
3.9^AF^See Technical Description^R^^F^IR^W^3.91^^^^^S
"IX",3.9,3.9,"AF",1)
S ^XMB(3.9,"AF",X,DA(1),DA)=""
"IX",3.9,3.9,"AF",1.4)
S X=(X>0)
"IX",3.9,3.9,"AF",2)
K ^XMB(3.9,"AF",X,DA(1),DA)
"IX",3.9,3.9,"AF",2.5)
K ^XMB(3.9,"AF")
"IX",3.9,3.9,"AF",11.1,0)
^.114IA^1^1
"IX",3.9,3.9,"AF",11.1,1,0)
1^F^3.91^15^^1^F
"IX",3.9,3.9,"AF",11.1,1,3)

"KEY",3.8,3.81,"A",0)
3.81^A^P^1
"KEY",3.8,3.81,"A",2,0)
^.312IA^1^1
"KEY",3.8,3.81,"A",2,1,0)
.01^3.81^1
"KEYPTR",3.8,3.81,"A")
3.81^B
"KRN",.4,58,-1)
0^4
"KRN",.4,58,0)
XMHOSTLIST^2870409^^4.2^^^^
"KRN",.4,58,"%D",0)
^^2^2^2931206^^
"KRN",.4,58,"%D",1,0)
This template may be used to produce a list of domains with pertinent
"KRN",.4,58,"%D",2,0)
network routing information.
"KRN",.4,58,"F",2)
.01;L10~5.5;"STATION";R5~6.2;"DHCP";L6~6.5;"HOST";R8~6;"MCST";L6~
"KRN",.4,58,"H")
DOMAIN HOST LIST
"KRN",.4,59,-1)
0^10
"KRN",.4,59,0)
XMMGR-BKFILER-QUEUE-WAIT^2931017.1833^^4.2998^^^^
"KRN",.4,59,"%D",0)
^^4^4^2931206^^
"KRN",.4,59,"%D",1,0)
This template is used to output the time messages are waiting 
"KRN",.4,59,"%D",2,0)
to be delivered in the mail delivery queues.
"KRN",.4,59,"%D",3,0)
Each queue is a column and two message and three response columns are
"KRN",.4,59,"%D",4,0)
displayed.
"KRN",.4,59,"DCL","4.2998^1")
#
"KRN",.4,59,"DCL","4.2998^201")
#
"KRN",.4,59,"DCL","4.2998^202")
#
"KRN",.4,59,"DCL","4.2998^203")
#
"KRN",.4,59,"DCL","4.2998^401")
#
"KRN",.4,59,"DCL","4.2998^402")
#
"KRN",.4,59,"F",2)
.01~1~401~402~201~202~203~
"KRN",.4,59,"H")
DELIVERY WAIT BY QUEUE
"KRN",.4,60,-1)
0^5
"KRN",.4,60,0)
XMMGR-BKFILER-ACTIVE_USERS/DEL^2931017.183^^4.2998^^^^
"KRN",.4,60,"%D",0)
^^2^2^2931206^^
"KRN",.4,60,"%D",1,0)
This template is used to display active users and message delivery 
"KRN",.4,60,"%D",2,0)
information.
"KRN",.4,60,"DCL","4.2998^1")
#
"KRN",.4,60,"DCL","4.2998^38")
#
"KRN",.4,60,"DCL","4.2998^44")
#
"KRN",.4,60,"DCL","4.2998^45")
#
"KRN",.4,60,"DCL","4.2998^46")
#
"KRN",.4,60,"DCL","4.2998^47")
#
"KRN",.4,60,"F",2)
.01~38~1~44~45~46~47~
"KRN",.4,60,"H")
ACTIVE USERS VERSES DELIVERIES
"KRN",.4,61,-1)
0^7
"KRN",.4,61,0)
XMMGR-BKFILER-LENGTH_OF_QUEUES^2931017.1831^^4.2998^^^^
"KRN",.4,61,"%D",0)
^^3^3^2931206^^^
"KRN",.4,61,"%D",1,0)
This template is used to output the length of mail delivery queues.
"KRN",.4,61,"%D",2,0)
Each queue is a column and two message and three response columns are
"KRN",.4,61,"%D",3,0)
displayed.
"KRN",.4,61,"DCL","4.2998^1")
#
"KRN",.4,61,"DCL","4.2998^301")
#
"KRN",.4,61,"DCL","4.2998^302")
#
"KRN",.4,61,"DCL","4.2998^303")
#
"KRN",.4,61,"DCL","4.2998^501")
#
"KRN",.4,61,"DCL","4.2998^502")
#
"KRN",.4,61,"F",2)
.01~1~501~502~301~302~303~
"KRN",.4,61,"H")
QUEUE LENGTH REPORT
"KRN",.4,62,-1)
0^14
"KRN",.4,62,0)
XMMGR-BKFILER-DEL_BY_GROUP^2931017.183^^4.2998^^^2971118^
"KRN",.4,62,"%D",0)
^.4001^2^2^3020717^^^
"KRN",.4,62,"%D",1,0)
This template is used to output mail deliveries by delivery group.  It
"KRN",.4,62,"%D",2,0)
will output two message delivery groups and three response delivery groups. 
"KRN",.4,62,"DCL","4.2998^601")
#
"KRN",.4,62,"DCL","4.2998^602")
#
"KRN",.4,62,"DCL","4.2998^603")
#
"KRN",.4,62,"DCL","4.2998^701")
#
"KRN",.4,62,"DCL","4.2998^702")
#
"KRN",.4,62,"F",2)
.01~701~702~601~602~603~
"KRN",.4,62,"H")
DELIVERIES BY GROUP
"KRN",.4,63,-1)
0^15
"KRN",.4,63,0)
XMMGR-BKFILER-LONGTERM-STATS^2940506.141^^4.2998^^^^
"KRN",.4,63,"%D",0)
^^1^1^3020717^
"KRN",.4,63,"%D",1,0)
This template is used to output statistics of mail deliveries by month.
"KRN",.4,63,"DXS",1,9)
W:$S('$D(XMLAST):0,$P(X,U,11)-XMLAST>999999:0,$P(X,U,11)-XMLAST>0:1,1:0) $P(X,U,11)-XMLAST S XMLAST=$P(X,U,11)
"KRN",.4,63,"F",2)
.01~43~X DXS(1,9);"New Messages";Z;"W:$S('$D(XMLAST):0,$P(X,U,11)-XMLAST>999999:0,$P(X,U,11)-XMLAST>0:1,1:0) $P(X,U,11)-XMLAST S XMLAST=$P(X,U,11)"~
"KRN",.4,63,"H")
MESSAGE & RESPONSE CREATION HISTORY
"KRN",.4,64,-1)
0^17
"KRN",.4,64,0)
XMMGR-BKFILER-STATS-PLUS^2931017.1833^^4.2998^^^2971118^
"KRN",.4,64,"%D",0)
^.4001^1^1^3020717^^^
"KRN",.4,64,"%D",1,0)
This template gives important daily delivery statistics.
"KRN",.4,64,"DCL","4.2998^15")
#
"KRN",.4,64,"DCL","4.2998^201")
#
"KRN",.4,64,"DCL","4.2998^22")
#
"KRN",.4,64,"DCL","4.2998^38")
#
"KRN",.4,64,"DCL","4.2998^401")
#
"KRN",.4,64,"DCL","4.2998^44")
#
"KRN",.4,64,"DCL","4.2998^45")
#
"KRN",.4,64,"DCL","4.2998^46")
#
"KRN",.4,64,"DCL","4.2998^47")
#
"KRN",.4,64,"F",2)
.01~38~15~44~45~401~201~46~47~22~
"KRN",.4,64,"H")
MESSAGE DELIVERY STATS LIST
"KRN",.4,65,-1)
0^16
"KRN",.4,65,0)
XMMGR-BKFILER-OLD_STATS/TABBED^2931017.1832^^4.2998^^^^
"KRN",.4,65,"%D",0)
^.4001^3^3^3020717^^^
"KRN",.4,65,"%D",1,0)
This template will produce a report just like the XMMGR-BKFILER-STATS-PLUS
"KRN",.4,65,"%D",2,0)
template, except that the output is formatted for capture into a file that
"KRN",.4,65,"%D",3,0)
can then easily be converted into a graphical display.
"KRN",.4,65,"DXS",1,9.2)
S DIP(1)=$S($D(^XMBX(4.2998,D0,0)):^(0),1:"") S X=$P(DIP(1),U,1)
"KRN",.4,65,"F",1)
S DIP(1)=$S($D(^XMBX(4.2998,D0,0)):^(0),1:"") S X=$P(DIP(1),U,1),X=$P(X,".",1) S Y=X D DT K DIP;L12;Z;"DATE(#.01)"~S X=9,X=$C(X) W X K DIP;X;Z;"$C(9)"~
"KRN",.4,65,"F",2)
X DXS(1,9.2) S X=$E($P(X,".",2)_"0000",1,4),%=X>1159 S:X>1259 X=X-1200 S X=X\100_":"_$E(X#100+100,2,3)_" "_$E("AP",%+1)_"M" W X K DIP;Z;"TIME(#.01)"~
"KRN",.4,65,"F",3)
S X=9,X=$C(X) W X K DIP;X;Z;"$C(9)"~S %XMNORMAL=$S($D(^XMB(1,1,120001)):^(120001),1:"");X;Z;"S %XMNORMAL=$S($D(^XMB(1,1,120001)):^(120001),1:"")"~
"KRN",.4,65,"F",4)
38;L6~S X=9,X=$C(X) W X K DIP;X;Z;"$C(9)"~W $J($S('$D(X):.1,X=0:.1,1:X)/%XMNORMAL,4,2);X;Z;"W $J($S('$D(X):.1,X=0:.1,1:X)/%XMNORMAL,4,2)"~
"KRN",.4,65,"F",5)
S X=9,X=$C(X) W X K DIP;X;Z;"$C(9)"~15;R6~S X=9,X=$C(X) W X K DIP;X;Z;"$C(9)"~
"KRN",.4,65,"F",6)
W $J($S('$D(X):.1,X=0:.1,1:X)/$P(%XMNORMAL,",",2),8,2);X;Z;"W $J($S('$D(X):.1,X=0:.1,1:X)/$P(%XMNORMAL,",",2),8,2)"~
"KRN",.4,65,"F",7)
S X=9,X=$C(X) W X K DIP;X;Z;"$C(9)"~44;R10~S X=9,X=$C(X) W X K DIP;X;Z;"$C(9)"~S XMTEMP=X;X;Z;"S XMTEMP=X"~45;R10~S X=9,X=$C(X) W X K DIP;X;Z;"$C(9)"~
"KRN",.4,65,"F",8)
S Y=X+XMTEMP W $J($S('$D(Y):.1,Y=0:.1,1:Y)/$P(%XMNORMAL,",",3),7,2);X;Z;"S Y=X+XMTEMP W $J($S('$D(Y):.1,Y=0:.1,1:Y)/$P(%XMNORMAL,",",3),7,2)"~
"KRN",.4,65,"F",9)
S X=9,X=$C(X) W X K DIP;X;Z;"$C(9)"~46;R10~S X=9,X=$C(X) W X K DIP;X;Z;"$C(9)"~S XMTEMP=X;X;Z;"S XMTEMP=X"~47;R10~S X=9,X=$C(X) W X K DIP;X;Z;"$C(9)"~
"KRN",.4,65,"F",10)
S Y=X+XMTEMP W $J($S('$D(Y):.1,Y=0:.1,1:Y)/$P(%XMNORMAL,",",4),7,2);X;Z;"S Y=X+XMTEMP W $J($S('$D(Y):.1,Y=0:.1,1:Y)/$P(%XMNORMAL,",",4),7,2)"~
"KRN",.4,65,"F",11)
S X=9,X=$C(X) W X K DIP;X;Z;"$C(9)"~22;R8~S X=9,X=$C(X) W X K DIP;X;Z;"$C(9)"~
"KRN",.4,65,"F",12)
W $J($S('$D(X):.1,X=0:.1,1:X)/$P(%XMNORMAL,",",5),4,2);X;Z;"W $J($S('$D(X):.1,X=0:.1,1:X)/$P(%XMNORMAL,",",5),4,2)"~K %XMNORMAL;X;Z;"K %XMNORMAL"~
"KRN",.4,65,"H")
TABBED STATISTICS
"KRN",.4,66,-1)
0^12
"KRN",.4,66,0)
XMMGR-BKFILER-STATS/TABBED^2940211.1522^^4.2998^^^^
"KRN",.4,66,"%D",0)
^^3^3^2931206^^
"KRN",.4,66,"%D",1,0)
This template will produce a report just like the XMMGR-BKFILER-STATS-PLUS
"KRN",.4,66,"%D",2,0)
template, except that the output is formated for capture into a file that
"KRN",.4,66,"%D",3,0)
can then easily be converted into a graphical display.
"KRN",.4,66,"DXS",1,9.2)
S DIP(1)=$S($D(^XMBX(4.2998,D0,0)):^(0),1:"") S X=$P(DIP(1),U,1)
"KRN",.4,66,"DXS",2,9)
S Y=$P(X,U,21) W "A"_$C(9)_$S(+%XMNORMAL=0:0,1:$J($S('$D(Y):.1,Y=0:.1,1:Y)/%XMNORMAL,4,2))
"KRN",.4,66,"DXS",3,9)
W "L"_$C(9)_$S(+$P(%XMNORMAL,",",2)=0:0,1:$J($S('$D(Y):.1,Y=0:.1,1:Y)/$P(%XMNORMAL,",",2),8,2))
"KRN",.4,66,"DXS",4,9)
S Y=Y+XMTEMP W "R"_$C(9)_$S(+$P(%XMNORMAL,",",3)=0:0,1:$J($S('$D(Y):.1,Y=0:.1,1:Y)/$P(%XMNORMAL,",",3),7,2))
"KRN",.4,66,"DXS",5,9)
S Y=Y+XMTEMP W "Q"_$C(9)_$S(+$P(%XMNORMAL,",",4)=0:0,1:$J($S('$D(Y):.1,Y=0:.1,1:Y)/$P(%XMNORMAL,",",4),7,2))
"KRN",.4,66,"DXS",6,9)
W "T"_$C(9)_$S(+$P(%XMNORMAL,",",5)=0:0,1:$J($S('$D(Y):.1,Y=0:.1,1:Y)/$P(%XMNORMAL,",",5),4,2))
"KRN",.4,66,"F",1)
S DIP(1)=$S($D(^XMBX(4.2998,D0,0)):^(0),1:"") S X=$P(DIP(1),U,1),X=$P(X,".",1) S Y=X D DT K DIP;L12;Z;"DATE(#.01)"~S X=9,X=$C(X) W X K DIP;X;Z;"$C(9)"~
"KRN",.4,66,"F",2)
X DXS(1,9.2) S X=$E($P(X,".",2)_"0000",1,4),%=X>1159 S:X>1259 X=X-1200 S X=X\100_":"_$E(X#100+100,2,3)_" "_$E("AP",%+1)_"M" W X K DIP;Z;"TIME(#.01)"~
"KRN",.4,66,"F",3)
S XMTEMP=$P(X,U,21) W $C(9);X;Z;"S XMTEMP=$P(X,U,21) W $C(9)"~
"KRN",.4,66,"F",4)
S %XMNORMAL=$S($D(^XMB(1,1,120001)):^(120001),1:"");X;Z;"S %XMNORMAL=$S($D(^XMB(1,1,120001)):^(120001),1:"")"~38;L6~
"KRN",.4,66,"F",5)
X DXS(2,9);X;Z;"S Y=$P(X,U,21) W "A"_$C(9)_$S(+%XMNORMAL=0:0,1:$J($S('$D(Y):.1,Y=0:.1,1:Y)/%XMNORMAL,4,2))"~S X=9,X=$C(X) W X K DIP;X;Z;"$C(9)"~15;R6~
"KRN",.4,66,"F",6)
X DXS(3,9);X;Z;"W "L"_$C(9)_$S(+$P(%XMNORMAL,",",2)=0:0,1:$J($S('$D(Y):.1,Y=0:.1,1:Y)/$P(%XMNORMAL,",",2),8,2))"~S X=9,X=$C(X) W X K DIP;X;Z;"$C(9)"~
"KRN",.4,66,"F",7)
44;R10~S XMTEMP=Y;X;Z;"S XMTEMP=Y"~45;R10~
"KRN",.4,66,"F",8)
X DXS(4,9);X;Z;"S Y=Y+XMTEMP W "R"_$C(9)_$S(+$P(%XMNORMAL,",",3)=0:0,1:$J($S('$D(Y):.1,Y=0:.1,1:Y)/$P(%XMNORMAL,",",3),7,2))"~
"KRN",.4,66,"F",9)
S X=9,X=$C(X) W X K DIP;X;Z;"$C(9)"~46;R10~S XMTEMP=Y;X;Z;"S XMTEMP=Y"~47;R10~
"KRN",.4,66,"F",10)
X DXS(5,9);X;Z;"S Y=Y+XMTEMP W "Q"_$C(9)_$S(+$P(%XMNORMAL,",",4)=0:0,1:$J($S('$D(Y):.1,Y=0:.1,1:Y)/$P(%XMNORMAL,",",4),7,2))"~
"KRN",.4,66,"F",11)
S X=9,X=$C(X) W X K DIP;X;Z;"$C(9)"~22;R8~
"KRN",.4,66,"F",12)
X DXS(6,9);X;Z;"W "T"_$C(9)_$S(+$P(%XMNORMAL,",",5)=0:0,1:$J($S('$D(Y):.1,Y=0:.1,1:Y)/$P(%XMNORMAL,",",5),4,2))"~K %XMNORMAL;X;Z;"K %XMNORMAL"~
"KRN",.4,66,"H")
TABBED STATISTICS
"KRN",.4,67,-1)
0^13
"KRN",.4,67,0)
XMMGR-BKFILER-TABBED-RT^2931017.1835^^4.2998^^^^
"KRN",.4,67,"%D",0)
^^1^1^2931206^^
"KRN",.4,67,"%D",1,0)
This template provides information about daily response time.
"KRN",.4,67,"F",2)
.01;X~S X=9,X=$C(X) W X K DIP;X;Z;"$C(9)"~22~
"KRN",.4,67,"H")
MESSAGE DELIVERY STATS LIST
"KRN",.401,36,-1)
0^3
"KRN",.401,36,0)
XMMGR-BKFILER-DAY@23:30^2920214.1212^^4.2998^^^^
"KRN",.401,36,2,1)
4.2998^.01^DATE/TIME^^
"KRN",.401,36,2,1,"ASK")

"KRN",.401,36,2,1,"F")
2110100.99999^1/1/11
"KRN",.401,36,2,1,"IX")
^XMBX(4.2998,"B",^XMBX(4.2998,^2
"KRN",.401,36,2,1,"T")
2991231.9999^12/31/99
"KRN",.401,36,2,2)
4.2998^^$E($P(INTERNAL(DATE/TIME),".",2),1,3)=233^'"@B^;L1
"KRN",.401,36,2,2,"CM")
X DPP(2,"OVF0",9.2) S X=$E(Y(4),Y(5),X)=233 I D0>0 S X(2)=X
"KRN",.401,36,2,2,"F")
0
"KRN",.401,36,2,2,"OVF0",9.2)
S Y(1)=$S($D(^XMBX(4.2998,D0,0)):^(0),1:"") S X=$P(Y(1),U,1),X=X S X=X,Y(2)=X S X=".",Y(3)=X S X=2,X=$P(Y(2),Y(3),X),Y(4)=X S X=1,Y(5)=X S X=3
"KRN",.401,36,2,2,"T")
1
"KRN",.401,36,"%D",0)
^^2^2^2931206^^
"KRN",.401,36,"%D",1,0)
This template is used to produce a report that lists the number of
"KRN",.401,36,"%D",2,0)
messages that were created in a month, a day at a time.
"KRN",.401,37,-1)
0^4
"KRN",.401,37,0)
XMMGR-BKFILER-TIME_PER_DATE^2920611.091^^4.2998^^^^
"KRN",.401,37,2,1)
4.2998^.01^DATE/TIME^@^
"KRN",.401,37,2,1,"ASK")

"KRN",.401,37,2,1,"F")
2920500.99999^5/1
"KRN",.401,37,2,1,"IX")
^XMBX(4.2998,"B",^XMBX(4.2998,^2
"KRN",.401,37,2,1,"T")
2920531.9999^5/31
"KRN",.401,37,2,2)
4.2998^^$E($P(INTERNAL(DATE/TIME),".",2),1,3)^@"^
"KRN",.401,37,2,2,"ASK")

"KRN",.401,37,2,2,"CM")
X DPP(2,"OVF0",9.2) S X=$E(Y(4),Y(5),X) I D0>0 S X(2)=X
"KRN",.401,37,2,2,"F")
119.99999^120
"KRN",.401,37,2,2,"OVF0",9.2)
S Y(1)=$S($D(^XMBX(4.2998,D0,0)):^(0),1:"") S X=$P(Y(1),U,1),X=X S X=X,Y(2)=X S X=".",Y(3)=X S X=2,X=$P(Y(2),Y(3),X),Y(4)=X S X=1,Y(5)=X S X=3
"KRN",.401,37,2,2,"T")
120^120
"KRN",.401,37,"%D",0)
^.4012^2^2^3020717^^^
"KRN",.401,37,"%D",1,0)
This template allows information in a time-oriented file to be output
"KRN",.401,37,"%D",2,0)
from a beginning time to an ending time.
"KRN",.5,116,-1)
0^1
"KRN",.5,116,0)
XM NEXT SEQUENCE NUMBER
"KRN",.5,116,1)
S X=$O(^XMB(3.7,DA(2),2,DA(1),1,"C",""),-1)+1
"KRN",.5,116,3)
0
"KRN",.5,116,9)
Gets the next sequence number in the basket for a new message
"KRN",.84,34001,-1)
0^146
"KRN",.84,34001,0)
34001^2^^MAILMAN^*=New/!=Priority
"KRN",.84,34001,2,0)
^^1^1^2980818^^
"KRN",.84,34001,2,1,0)
*=New/!=Priority
"KRN",.84,34002,-1)
0^147
"KRN",.84,34002,0)
34002^2^^MAILMAN^Subject
"KRN",.84,34002,2,0)
^^1^1^2980817^
"KRN",.84,34002,2,1,0)
Subject
"KRN",.84,34002,5,0)
^.841^4^4
"KRN",.84,34002,5,1,0)
XMJMD
"KRN",.84,34002,5,2,0)
XMJML
"KRN",.84,34002,5,3,0)
XMJMS
"KRN",.84,34002,5,4,0)
XMUT2
"KRN",.84,34002,5,"B","XMJMD",1)

"KRN",.84,34002,5,"B","XMJML",2)

"KRN",.84,34002,5,"B","XMJMS",3)

"KRN",.84,34002,5,"B","XMUT2",4)

"KRN",.84,34003,-1)
0^148
"KRN",.84,34003,0)
34003^2^^MAILMAN^Line
"KRN",.84,34003,2,0)
^^1^1^2980817^
"KRN",.84,34003,2,1,0)
Line
"KRN",.84,34003.1,-1)
0^149
"KRN",.84,34003.1,0)
34003.1^2^^MAILMAN^Lines
"KRN",.84,34003.1,2,0)
^^1^1^2980817^^^
"KRN",.84,34003.1,2,1,0)
Lines
"KRN",.84,34003.1,5,0)
^.841^3^3
"KRN",.84,34003.1,5,1,0)
XMUT2
"KRN",.84,34003.1,5,2,0)
XMJML
"KRN",.84,34003.1,5,3,0)
XMJMP1
"KRN",.84,34003.1,5,"B","XMJML",2)

"KRN",.84,34003.1,5,"B","XMJMP1",3)

"KRN",.84,34003.1,5,"B","XMUT2",1)

"KRN",.84,34004,-1)
0^150
"KRN",.84,34004,0)
34004^2^^MAILMAN^Read/Rcvd
"KRN",.84,34004,2,0)
^^1^1^2980818^
"KRN",.84,34004,2,1,0)
Read/Rcvd
"KRN",.84,34005,-1)
0^151
"KRN",.84,34005,0)
34005^2^^MAILMAN^*=New/!=Priority.......Subject
"KRN",.84,34005,2,0)
^^1^1^2980817^
"KRN",.84,34005,2,1,0)
*=New/!=Priority.......Subject
"KRN",.84,34006,-1)
0^152
"KRN",.84,34006,0)
34006^2^^MAILMAN^From
"KRN",.84,34006,2,0)
^^1^1^2980817^
"KRN",.84,34006,2,1,0)
From
"KRN",.84,34006,5,0)
^.841^4^4
"KRN",.84,34006,5,1,0)
XMJML
"KRN",.84,34006,5,2,0)
XMJMP1
"KRN",.84,34006,5,3,0)
XMUPIN
"KRN",.84,34006,5,4,0)
XMUT2
"KRN",.84,34006,5,"B","XMJML",1)

"KRN",.84,34006,5,"B","XMJMP1",2)

"KRN",.84,34006,5,"B","XMUPIN",3)

"KRN",.84,34006,5,"B","XMUT2",4)

"KRN",.84,34007,-1)
0^153
"KRN",.84,34007,0)
34007^2^^MAILMAN^ message
"KRN",.84,34007,2,0)
^^1^1^2990622^^^
"KRN",.84,34007,2,1,0)
 message
"KRN",.84,34007.1,-1)
0^154
"KRN",.84,34007.1,0)
34007.1^2^^MAILMAN^ messages
"KRN",.84,34007.1,2,0)
^^1^1^2990622^^^
"KRN",.84,34007.1,2,1,0)
 messages
"KRN",.84,34007.2,-1)
0^89
"KRN",.84,34007.2,0)
34007.2^2^^MAILMAN^ msgs
"KRN",.84,34007.2,1,0)
^^1^1^3020405^
"KRN",.84,34007.2,1,1,0)
has a leading blank
"KRN",.84,34007.2,2,0)
^^1^1^3020405^
"KRN",.84,34007.2,2,1,0)
 msgs
"KRN",.84,34007.2,5,0)
^.841^1^1
"KRN",.84,34007.2,5,1,0)
XMCXU
"KRN",.84,34007.2,5,"B","XMCXU",1)

"KRN",.84,34008,-1)
0^155
"KRN",.84,34008,0)
34008^2^^MAILMAN^ new
"KRN",.84,34008,2,0)
^^1^1^2990622^^^^
"KRN",.84,34008,2,1,0)
 new
"KRN",.84,34009,-1)
0^156
"KRN",.84,34009,0)
34009^2^^MAILMAN^* No Name *
"KRN",.84,34009,2,0)
^^1^1^2991124^^
"KRN",.84,34009,2,1,0)
* No Name *
"KRN",.84,34009,5,0)
^.841^3^3
"KRN",.84,34009,5,1,0)
XMUT4
"KRN",.84,34009,5,2,0)
XMUT4C
"KRN",.84,34009,5,3,0)
XMXUTIL
"KRN",.84,34009,5,"B","XMUT4",1)

"KRN",.84,34009,5,"B","XMUT4C",2)

"KRN",.84,34009,5,"B","XMXUTIL",3)

"KRN",.84,34010,-1)
0^157
"KRN",.84,34010,0)
34010^2^y^MAILMAN^* User #|1| *
"KRN",.84,34010,2,0)
^^1^1^2990614^^^
"KRN",.84,34010,2,1,0)
* User #|1| *
"KRN",.84,34010,3,0)
^.845^1^1
"KRN",.84,34010,3,1,0)
1^User DUZ
"KRN",.84,34011,-1)
0^158
"KRN",.84,34011,0)
34011^2^^MAILMAN^Basket
"KRN",.84,34011,2,0)
^^1^1^2990622^^^
"KRN",.84,34011,2,1,0)
Basket
"KRN",.84,34012,-1)
0^159
"KRN",.84,34012,0)
34012^2^^MAILMAN^* No Subject *
"KRN",.84,34012,2,0)
^^1^1^2980817^
"KRN",.84,34012,2,1,0)
* No Subject *
"KRN",.84,34013,-1)
0^160
"KRN",.84,34013,0)
34013^2^^MAILMAN^No NEW messages
"KRN",.84,34013,2,0)
^^1^1^2980817^
"KRN",.84,34013,2,1,0)
No NEW messages
"KRN",.84,34014,-1)
0^161
"KRN",.84,34014,0)
34014^2^^MAILMAN^* N/A *
"KRN",.84,34014,2,0)
^^1^1^2991110^
"KRN",.84,34014,2,1,0)
* N/A *
"KRN",.84,34014,5,0)
^.841^2^1
"KRN",.84,34014,5,2,0)
XMJMD
"KRN",.84,34014,5,"B","XMJMD",2)

"KRN",.84,34015,-1)
0^162
"KRN",.84,34015,0)
34015^2^^MAILMAN^You have no new messages in this basket.
"KRN",.84,34015,2,0)
^^1^1^2991216^
"KRN",.84,34015,2,1,0)
You have no new messages in this basket.
"KRN",.84,34015,5,0)
^.841^1^1
"KRN",.84,34015,5,1,0)
XMJMLN
"KRN",.84,34015,5,"B","XMJMLN",1)

"KRN",.84,34016,-1)
0^163
"KRN",.84,34016,0)
34016^2^^MAILMAN^You have no new priority messages in this
"KRN",.84,34016,2,0)
^^1^1^2991216^
"KRN",.84,34016,2,1,0)
You have no new priority messages in this basket.
"KRN",.84,34016,5,0)
^.841^1^1
"KRN",.84,34016,5,1,0)
XMJMLN
"KRN",.84,34016,5,"B","XMJMLN",1)

"KRN",.84,34017,-1)
0^164
"KRN",.84,34017,0)
34017^2^^MAILMAN^You have no new messages.
"KRN",.84,34017,2,0)
^^1^1^2991216^
"KRN",.84,34017,2,1,0)
You have no new messages.
"KRN",.84,34017,5,0)
^.841^1^1
"KRN",.84,34017,5,1,0)
XMJMLN
"KRN",.84,34017,5,"B","XMJMLN",1)

"KRN",.84,34018,-1)
0^165
"KRN",.84,34018,0)
34018^2^^MAILMAN^You have no new priority messages.
"KRN",.84,34018,2,0)
^^1^1^2991216^
"KRN",.84,34018,2,1,0)
You have no new priority messages.
"KRN",.84,34018,5,0)
^.841^1^1
"KRN",.84,34018,5,1,0)
XMJMLN
"KRN",.84,34018,5,"B","XMJMLN",1)

"KRN",.84,34019,-1)
0^166
"KRN",.84,34019,0)
34019^2^^MAILMAN^You have new mail in more than one
"KRN",.84,34019,2,0)
^.844^1^1^3020406^^
"KRN",.84,34019,2,1,0)
You have new mail in more than one basket.
"KRN",.84,34019,5,0)
^.841^1^1
"KRN",.84,34019,5,1,0)
XMJBN1
"KRN",.84,34019,5,"B","XMJBN1",1)

"KRN",.84,34019.1,-1)
0^131
"KRN",.84,34019.1,0)
34019.1^2^y^MAILMAN^|1| has new mail in more than 1 basket.
"KRN",.84,34019.1,2,0)
^^1^1^3020406^
"KRN",.84,34019.1,2,1,0)
|1| has new mail in more than 1 basket.
"KRN",.84,34019.1,3,0)
^.845^1^1
"KRN",.84,34019.1,3,1,0)
1^surrogate name
"KRN",.84,34019.1,5,0)
^.841^1^1
"KRN",.84,34019.1,5,1,0)
XMJBN1
"KRN",.84,34019.1,5,"B","XMJBN1",1)

"KRN",.84,34020,-1)
0^167
"KRN",.84,34020,0)
34020^2^^MAILMAN^End reached.  Begin again
"KRN",.84,34020,2,0)
^^1^1^2991216^
"KRN",.84,34020,2,1,0)
End reached.  Begin again
"KRN",.84,34020,5,0)
^.841^1^1
"KRN",.84,34020,5,1,0)
XMJMLR
"KRN",.84,34020,5,"B","XMJMLR",1)

"KRN",.84,34021,-1)
0^168
"KRN",.84,34021,0)
34021^3^^MAILMAN^Enter 'Yes' if you wish to continue read
"KRN",.84,34021,2,0)
^^1^1^2991216^
"KRN",.84,34021,2,1,0)
Enter 'Yes' if you wish to continue reading messages; 'No' if you don't.
"KRN",.84,34021,5,0)
^.841^1^1
"KRN",.84,34021,5,1,0)
XMJMLR
"KRN",.84,34021,5,"B","XMJMLR",1)

"KRN",.84,34022,-1)
0^169
"KRN",.84,34022,0)
34022^2^y^MAILMAN^All Baskets, New messages: |1|
"KRN",.84,34022,2,0)
^.844^1^1^3000608^^
"KRN",.84,34022,2,1,0)
All Baskets, New messages: |1|
"KRN",.84,34022,3,0)
^.845^1^1
"KRN",.84,34022,3,1,0)
1^number of new messages
"KRN",.84,34022,5,0)
^.841^1^1
"KRN",.84,34022,5,1,0)
XMJMLN
"KRN",.84,34022,5,"B","XMJMLN",1)

"KRN",.84,34023,-1)
0^170
"KRN",.84,34023,0)
34023^2^y^MAILMAN^All Baskets, New Priority messages: |2|
"KRN",.84,34023,2,0)
^.844^1^1^3000608^^^
"KRN",.84,34023,2,1,0)
All Baskets, New Priority messages: |2|
"KRN",.84,34023,3,0)
^.845^1^1
"KRN",.84,34023,3,1,0)
2^number of new priority messages
"KRN",.84,34023,5,0)
^.841^1^1
"KRN",.84,34023,5,1,0)
XMJMLN
"KRN",.84,34023,5,"B","XMJMLN",1)

"KRN",.84,34024,-1)
0^171
"KRN",.84,34024,0)
34024^2^y^MAILMAN^|3| Basket, New messages: |1|
"KRN",.84,34024,2,0)
^.844^1^1^3000608^^
"KRN",.84,34024,2,1,0)
|3| Basket, New messages: |1|
"KRN",.84,34024,3,0)
^.845^2^2
"KRN",.84,34024,3,1,0)
1^number of new messages
"KRN",.84,34024,3,2,0)
3^basket name
"KRN",.84,34024,5,0)
^.841^1^1
"KRN",.84,34024,5,1,0)
XMJMLN
"KRN",.84,34024,5,"B","XMJMLN",1)

"KRN",.84,34025,-1)
0^172
"KRN",.84,34025,0)
34025^2^y^MAILMAN^|3| Basket, New Priority messages: |2|
"KRN",.84,34025,2,0)
^.844^1^1^3000608^^
"KRN",.84,34025,2,1,0)
|3| Basket, New Priority messages: |2|
"KRN",.84,34025,3,0)
^.845^2^2
"KRN",.84,34025,3,1,0)
2^number of new priority messages
"KRN",.84,34025,3,2,0)
3^basket name
"KRN",.84,34025,5,0)
^.841^1^1
"KRN",.84,34025,5,1,0)
XMJMLN
"KRN",.84,34025,5,"B","XMJMLN",1)

"KRN",.84,34026,-1)
0^173
"KRN",.84,34026,0)
34026^2^y^MAILMAN^  (|1| messages)
"KRN",.84,34026,2,0)
^^1^1^3000712^
"KRN",.84,34026,2,1,0)
  (|1| messages)
"KRN",.84,34026,3,0)
^.845^1^1
"KRN",.84,34026,3,1,0)
1^number of new messages
"KRN",.84,34026,5,0)
^.841^1^1
"KRN",.84,34026,5,1,0)
XMJBN
"KRN",.84,34026,5,"B","XMJBN",1)

"KRN",.84,34026.1,-1)
0^174
"KRN",.84,34026.1,0)
34026.1^2^^MAILMAN^  (1 message)
"KRN",.84,34026.1,2,0)
^^1^1^3000712^
"KRN",.84,34026.1,2,1,0)
  (1 message)
"KRN",.84,34026.1,5,0)
^.841^1^1
"KRN",.84,34026.1,5,1,0)
XMJBN
"KRN",.84,34026.1,5,"B","XMJBN",1)

"KRN",.84,34027,-1)
0^175
"KRN",.84,34027,0)
34027^2^y^MAILMAN^  (|1| messages, |2| new)
"KRN",.84,34027,2,0)
^.844^1^1^3000719^^
"KRN",.84,34027,2,1,0)
  (|1| messages, |2| new)
"KRN",.84,34027,3,0)
^.845^2^2
"KRN",.84,34027,3,1,0)
1^number of messages
"KRN",.84,34027,3,2,0)
2^number of new messages
"KRN",.84,34027,5,0)
^.841^1^1
"KRN",.84,34027,5,1,0)
XMJBN
"KRN",.84,34027,5,"B","XMJBN",1)

"KRN",.84,34027.1,-1)
0^176
"KRN",.84,34027.1,0)
34027.1^2^^MAILMAN^  (1 message, 1 new)
"KRN",.84,34027.1,2,0)
^^1^1^3000712^
"KRN",.84,34027.1,2,1,0)
  (1 message, 1 new)
"KRN",.84,34027.1,5,0)
^.841^1^1
"KRN",.84,34027.1,5,1,0)
XMJBN
"KRN",.84,34027.1,5,"B","XMJBN",1)

"KRN",.84,34027.2,-1)
0^177
"KRN",.84,34027.2,0)
34027.2^2^y^MAILMAN^  (|1| new)
"KRN",.84,34027.2,2,0)
^^1^1^3000712^
"KRN",.84,34027.2,2,1,0)
  (|1| new)
"KRN",.84,34027.2,3,0)
^.845^1^1
"KRN",.84,34027.2,3,1,0)
1^number of new messages
"KRN",.84,34027.2,5,0)
^.841^1^1
"KRN",.84,34027.2,5,1,0)
XMJBN
"KRN",.84,34027.2,5,"B","XMJBN",1)

"KRN",.84,34028,-1)
0^178
"KRN",.84,34028,0)
34028^2^^MAILMAN^Read mail in basket: 
"KRN",.84,34028,1,0)
^^1^1^3000712^
"KRN",.84,34028,1,1,0)
There's one blank at the end.
"KRN",.84,34028,2,0)
^^1^1^3000712^
"KRN",.84,34028,2,1,0)
Read mail in basket: 
"KRN",.84,34028,5,0)
^.841^1^1
"KRN",.84,34028,5,1,0)
XMJBN
"KRN",.84,34028,5,"B","XMJBN",1)

"KRN",.84,34029,-1)
0^179
"KRN",.84,34029,0)
34029^2^^MAILMAN^Read new mail in basket: 
"KRN",.84,34029,1,0)
^^1^1^3000712^
"KRN",.84,34029,1,1,0)
There's one blank at the end.
"KRN",.84,34029,2,0)
^^1^1^3000712^
"KRN",.84,34029,2,1,0)
Read new mail in basket: 
"KRN",.84,34029,5,0)
^.841^1^1
"KRN",.84,34029,5,1,0)
XMJBN
"KRN",.84,34029,5,"B","XMJBN",1)

"KRN",.84,34030,-1)
0^180
"KRN",.84,34030,0)
34030^2^y^MAILMAN^|1| Basket Message: |2|// 
"KRN",.84,34030,1,0)
^^1^1^2991215^
"KRN",.84,34030,1,1,0)
Note: there's one blank character at the end of this dialog.
"KRN",.84,34030,2,0)
^^1^1^2991215^
"KRN",.84,34030,2,1,0)
|1| Basket Message: |2|// 
"KRN",.84,34030,3,0)
^.845^2^2
"KRN",.84,34030,3,1,0)
1^basket name
"KRN",.84,34030,3,2,0)
2^message sequence number in basket
"KRN",.84,34030,5,0)
^.841^1^1
"KRN",.84,34030,5,1,0)
XMJBM
"KRN",.84,34030,5,"B","XMJBM",1)

"KRN",.84,34030.9,-1)
0^181
"KRN",.84,34030.9,0)
34030.9^2^^MAILMAN^All of the messages in this basket are
"KRN",.84,34030.9,2,0)
^.844^3^3^3001120^^
"KRN",.84,34030.9,2,1,0)
All of the messages in this basket are confidential.
"KRN",.84,34030.9,2,2,0)
Surrogates may not read confidential messages.
"KRN",.84,34030.9,2,3,0)
Use one of the full screen readers to see a list of the messages.
"KRN",.84,34030.9,5,0)
^.841^1^1
"KRN",.84,34030.9,5,1,0)
XMJBM
"KRN",.84,34030.9,5,"B","XMJBM",1)

"KRN",.84,34031,-1)
0^182
"KRN",.84,34031,0)
34031^2^y^MAILMAN^Subj: |1|   From: |2|
"KRN",.84,34031,2,0)
^^1^1^2991215^
"KRN",.84,34031,2,1,0)
Subj: |1|   From: |2|
"KRN",.84,34031,3,0)
^.845^2^2
"KRN",.84,34031,3,1,0)
1^message subject
"KRN",.84,34031,3,2,0)
2^message sender
"KRN",.84,34031,5,0)
^.841^1^1
"KRN",.84,34031,5,1,0)
XMJBM
"KRN",.84,34031,5,"B","XMJBM",1)

"KRN",.84,34032,-1)
0^183
"KRN",.84,34032,0)
34032^3^y^MAILMAN^Press ENTER to read message |1|.  Enter
"KRN",.84,34032,2,0)
^^9^9^2991216^^^
"KRN",.84,34032,2,1,0)
Press ENTER to read message |1|.  Enter a message number (|2|-|3|) to read
"KRN",.84,34032,2,2,0)
a message in this basket.  Enter an internal message number to read any
"KRN",.84,34032,2,3,0)
message still on the system, which you ever sent or received.  Enter:
"KRN",.84,34032,2,4,0)
 ? or ??        Display a summary or detailed list of messages in this basket
"KRN",.84,34032,2,5,0)
 ???? or ?HELP  Display detailed help
"KRN",.84,34032,2,6,0)
 ?string        Search for messages in this basket whose subject
"KRN",.84,34032,2,7,0)
                contains the specified string
"KRN",.84,34032,2,8,0)
 ??string       Search for messages you once sent or received
"KRN",.84,34032,2,9,0)
                whose subject begins with the specified string
"KRN",.84,34032,3,0)
^.845^3^3
"KRN",.84,34032,3,1,0)
1^message sequence number in basket
"KRN",.84,34032,3,2,0)
2^first message sequence number in basket
"KRN",.84,34032,3,3,0)
3^last message sequence number in basket
"KRN",.84,34032,5,0)
^.841^1^1
"KRN",.84,34032,5,1,0)
XMJBM
"KRN",.84,34032,5,"B","XMJBM",1)

"KRN",.84,34034,-1)
0^184
"KRN",.84,34034,0)
34034^1^^MAILMAN^This references a message which doesn't ex
"KRN",.84,34034,2,0)
^^1^1^2991215^
"KRN",.84,34034,2,1,0)
This references a message which doesn't exist - deleting it.
"KRN",.84,34034,5,0)
^.841^1^1
"KRN",.84,34034,5,1,0)
XMJBM
"KRN",.84,34034,5,"B","XMJBM",1)

"KRN",.84,34035,-1)
0^185
"KRN",.84,34035,0)
34035^2^^MAILMAN^Resequencing ...
"KRN",.84,34035,2,0)
^^1^1^2991215^
"KRN",.84,34035,2,1,0)
Resequencing ...
"KRN",.84,34035,5,0)
^.841^1^1
"KRN",.84,34035,5,1,0)
XMJBM
"KRN",.84,34035,5,"B","XMJBM",1)

"KRN",.84,34036,-1)
0^186
"KRN",.84,34036,0)
34036^2^^MAILMAN^C:Classic
"KRN",.84,34036,2,0)
^^1^1^3000711^
"KRN",.84,34036,2,1,0)
C:Classic
"KRN",.84,34036,5,0)
^.841^1^1
"KRN",.84,34036,5,1,0)
XMJBM1
"KRN",.84,34036,5,"B","XMJBM1",1)

"KRN",.84,34037,-1)
0^187
"KRN",.84,34037,0)
34037^2^^MAILMAN^D:Detailed Full Screen
"KRN",.84,34037,2,0)
^^1^1^3000711^
"KRN",.84,34037,2,1,0)
D:Detailed Full Screen
"KRN",.84,34037,5,0)
^.841^1^1
"KRN",.84,34037,5,1,0)
XMJBM1
"KRN",.84,34037,5,"B","XMJBM1",1)

"KRN",.84,34038,-1)
0^188
"KRN",.84,34038,0)
34038^2^^MAILMAN^S:Summary Full Screen
"KRN",.84,34038,2,0)
^^1^1^3000711^
"KRN",.84,34038,2,1,0)
S:Summary Full Screen
"KRN",.84,34038,5,0)
^.841^1^1
"KRN",.84,34038,5,1,0)
XMJBM1
"KRN",.84,34038,5,"B","XMJBM1",1)

"KRN",.84,34039,-1)
0^189
"KRN",.84,34039,0)
34039^3^^MAILMAN^The Classic reader is the one that has
"KRN",.84,34039,2,0)
^^5^5^3000711^
"KRN",.84,34039,2,1,0)
The Classic reader is the one that has been around forever.
"KRN",.84,34039,2,2,0)
 
"KRN",.84,34039,2,3,0)
The Full Screen reader has two flavors:
"KRN",.84,34039,2,4,0)
Detailed Full Screen contains a detailed message list.
"KRN",.84,34039,2,5,0)
Summary Full Screen contains a summary message list.
"KRN",.84,34039,5,0)
^.841^1^1
"KRN",.84,34039,5,1,0)
XMJBM1
"KRN",.84,34039,5,"B","XMJBM1",1)

"KRN",.84,34040,-1)
0^190
"KRN",.84,34040,0)
34040^3^^MAILMAN^You may choose a default MESSAGE READER
"KRN",.84,34040,2,0)
^^3^3^3000711^
"KRN",.84,34040,2,1,0)
You may choose a default MESSAGE READER under
"KRN",.84,34040,2,2,0)
'Personal Preferences|User Options Edit'.
"KRN",.84,34040,2,3,0)
Until you do, the Classic reader will be your default.
"KRN",.84,34040,5,0)
^.841^1^1
"KRN",.84,34040,5,1,0)
XMJBM1
"KRN",.84,34040,5,"B","XMJBM1",1)

"KRN",.84,34041,-1)
0^191
"KRN",.84,34041,0)
34041^3^y^MAILMAN^Your default MESSAGE READER is the |1|
"KRN",.84,34041,2,0)
^.844^3^3^3000711^^
"KRN",.84,34041,2,1,0)
Your default MESSAGE READER is the |1| reader.
"KRN",.84,34041,2,2,0)
You may change your default MESSAGE READER under
"KRN",.84,34041,2,3,0)
'Personal Preferences|User Options Edit'.
"KRN",.84,34041,3,0)
^.845^1^1
"KRN",.84,34041,3,1,0)
1^default message reader
"KRN",.84,34041,5,0)
^.841^1^1
"KRN",.84,34041,5,1,0)
XMJBM1
"KRN",.84,34041,5,"B","XMJBM1",1)

"KRN",.84,34042,-1)
0^192
"KRN",.84,34042,0)
34042^3^y^MAILMAN^If you don't want to be asked this ques
"KRN",.84,34042,2,0)
^.844^3^3^3000711^^^^
"KRN",.84,34042,2,1,0)
If you don't want to be asked this question again, and wish to use
"KRN",.84,34042,2,2,0)
the |1| reader exclusively, set the MESSAGE READER PROMPT
"KRN",.84,34042,2,3,0)
to "No, don't ask", under 'Personal Preferences|User Options Edit'.
"KRN",.84,34042,3,0)
^.845^1^1
"KRN",.84,34042,3,1,0)
1^default message reader
"KRN",.84,34043,-1)
0^193
"KRN",.84,34043,0)
34043^2^y^MAILMAN^Last message number: |1|   Messages in
"KRN",.84,34043,2,0)
^.844^2^2^3000711^^^
"KRN",.84,34043,2,1,0)
Last message number: |1|   Messages in basket: |2|
"KRN",.84,34043,2,2,0)
Enter ??? for help.
"KRN",.84,34043,3,0)
^.845^2^2
"KRN",.84,34043,3,1,0)
1^last message number
"KRN",.84,34043,3,2,0)
2^messages in basket
"KRN",.84,34043,5,0)
^.841^1^1
"KRN",.84,34043,5,1,0)
XMJBM1
"KRN",.84,34043,5,"B","XMJBM1",1)

"KRN",.84,34043.1,-1)
0^194
"KRN",.84,34043.1,0)
34043.1^2^y^MAILMAN^Last message number: |1|   Messages in
"KRN",.84,34043.1,2,0)
^.844^2^2^3000711^^
"KRN",.84,34043.1,2,1,0)
Last message number: |1|   Messages in basket: |2| (|3| new)
"KRN",.84,34043.1,2,2,0)
Enter ??? for help.
"KRN",.84,34043.1,3,0)
^.845^3^3
"KRN",.84,34043.1,3,1,0)
1^last message number
"KRN",.84,34043.1,3,2,0)
2^messages in basket
"KRN",.84,34043.1,3,3,0)
3^number of new messages
"KRN",.84,34043.1,5,0)
^.841^1^1
"KRN",.84,34043.1,5,1,0)
XMJBM1
"KRN",.84,34043.1,5,"B","XMJBM1",1)

"KRN",.84,34044,-1)
0^195
"KRN",.84,34044,0)
34044^2^y^MAILMAN^No messages in '|1|' basket.
"KRN",.84,34044,2,0)
^^1^1^3000711^
"KRN",.84,34044,2,1,0)
No messages in '|1|' basket.
"KRN",.84,34044,3,0)
^.845^1^1
"KRN",.84,34044,3,1,0)
1^basket name
"KRN",.84,34044,5,0)
^.841^1^1
"KRN",.84,34044,5,1,0)
XMJBM1
"KRN",.84,34044,5,"B","XMJBM1",1)

"KRN",.84,34045,-1)
0^196
"KRN",.84,34045,0)
34045^2^y^MAILMAN^Since the '|1|' basket is empty,
"KRN",.84,34045,2,0)
^^2^2^3000711^
"KRN",.84,34045,2,1,0)
Since the '|1|' basket is empty,
"KRN",.84,34045,2,2,0)
do you want to delete it
"KRN",.84,34045,3,0)
^.845^1^1
"KRN",.84,34045,3,1,0)
1^basket name
"KRN",.84,34045,5,0)
^.841^1^1
"KRN",.84,34045,5,1,0)
XMJBM1
"KRN",.84,34045,5,"B","XMJBM1",1)

"KRN",.84,34046,-1)
0^197
"KRN",.84,34046,0)
34046^2^^MAILMAN^Basket deleted.
"KRN",.84,34046,2,0)
^^1^1^3000711^
"KRN",.84,34046,2,1,0)
Basket deleted.
"KRN",.84,34046,5,0)
^.841^1^1
"KRN",.84,34046,5,1,0)
XMJBM1
"KRN",.84,34046,5,"B","XMJBM1",1)

"KRN",.84,34047,-1)
0^198
"KRN",.84,34047,0)
34047^2^^MAILMAN^Select message reader: 
"KRN",.84,34047,1,0)
^^1^1^3000711^
"KRN",.84,34047,1,1,0)
There's 1 blank at the end of the string.
"KRN",.84,34047,2,0)
^^1^1^3000711^
"KRN",.84,34047,2,1,0)
Select message reader: 
"KRN",.84,34047,5,0)
^.841^1^1
"KRN",.84,34047,5,1,0)
XMJBM1
"KRN",.84,34047,5,"B","XMJBM1",1)

"KRN",.84,34048,-1)
0^199
"KRN",.84,34048,0)
34048^2^^MAILMAN^Enter a new basket name
"KRN",.84,34048,2,0)
^^1^1^3000712^
"KRN",.84,34048,2,1,0)
Enter a new basket name
"KRN",.84,34048,5,0)
^.841^1^1
"KRN",.84,34048,5,1,0)
XMJBU
"KRN",.84,34048,5,"B","XMJBU",1)

"KRN",.84,34048.8,-1)
0^200
"KRN",.84,34048.8,0)
34048.8^1^^MAILMAN^That's the same name.
"KRN",.84,34048.8,2,0)
^^1^1^3000712^
"KRN",.84,34048.8,2,1,0)
That's the same name.
"KRN",.84,34048.8,5,0)
^.841^1^1
"KRN",.84,34048.8,5,1,0)
XMJBU
"KRN",.84,34048.8,5,"B","XMJBU",1)

"KRN",.84,34048.9,-1)
0^201
"KRN",.84,34048.9,0)
34048.9^1^^MAILMAN^You already have a basket by this name.
"KRN",.84,34048.9,2,0)
^^1^1^3000712^
"KRN",.84,34048.9,2,1,0)
You already have a basket by this name.
"KRN",.84,34048.9,5,0)
^.841^1^1
"KRN",.84,34048.9,5,1,0)
XMJBU
"KRN",.84,34048.9,5,"B","XMJBU",1)

"KRN",.84,34050,-1)
0^202
"KRN",.84,34050,0)
34050^2^^MAILMAN^Enter message number or command: 
"KRN",.84,34050,1,0)
^^1^1^2991215^
"KRN",.84,34050,1,1,0)
Note: there's a blank character at the end of this dialog.
"KRN",.84,34050,2,0)
^^1^1^2991215^
"KRN",.84,34050,2,1,0)
Enter message number or command: 
"KRN",.84,34050,5,0)
^.841^1^1
"KRN",.84,34050,5,1,0)
XMJMLR1
"KRN",.84,34050,5,"B","XMJMLR1",1)

"KRN",.84,34051,-1)
0^203
"KRN",.84,34051,0)
34051^3^y^MAILMAN^Enter a message number (|1|-|2|) to read a
"KRN",.84,34051,2,0)
^^3^3^2991216^^^^
"KRN",.84,34051,2,1,0)
Enter a message number (|1|-|2|) to read a message in this basket.
"KRN",.84,34051,2,2,0)
Enter an internal message number to read any message still on the system,
"KRN",.84,34051,2,3,0)
which you ever sent or received.  Enter: 
"KRN",.84,34051,3,0)
^.845^2^2
"KRN",.84,34051,3,1,0)
1^first message sequence number in basket
"KRN",.84,34051,3,2,0)
2^last message sequence number in basket
"KRN",.84,34051,5,0)
^.841^1^1
"KRN",.84,34051,5,1,0)
XMJMLR1
"KRN",.84,34051,5,"B","XMJMLR1",1)

"KRN",.84,34051.1,-1)
0^204
"KRN",.84,34051.1,0)
34051.1^3^y^MAILMAN^Enter a message number (|1|-|2|) to read a
"KRN",.84,34051.1,2,0)
^^1^1^2991216^
"KRN",.84,34051.1,2,1,0)
Enter a message number (|1|-|2|) to read a message.  Enter:
"KRN",.84,34051.1,3,0)
^.845^2^2
"KRN",.84,34051.1,3,1,0)
1^first message sequence number
"KRN",.84,34051.1,3,2,0)
2^last message sequence number
"KRN",.84,34051.1,5,0)
^.841^1^1
"KRN",.84,34051.1,5,1,0)
XMJMLR1
"KRN",.84,34051.1,5,"B","XMJMLR1",1)

"KRN",.84,34052,-1)
0^205
"KRN",.84,34052,0)
34052^3^^MAILMAN^ ?string             Search for messages
"KRN",.84,34052,2,0)
^^4^4^2991216^^^
"KRN",.84,34052,2,1,0)
 ?string             Search for messages in this basket whose subject
"KRN",.84,34052,2,2,0)
                     contains the specified string
"KRN",.84,34052,2,3,0)
 ??string            Search for messages you once sent or received
"KRN",.84,34052,2,4,0)
                     whose subject begins with the specified string
"KRN",.84,34052,5,0)
^.841^1^1
"KRN",.84,34052,5,1,0)
XMJMLR1
"KRN",.84,34052,5,"B","XMJMLR1",1)

"KRN",.84,34053,-1)
0^206
"KRN",.84,34053,0)
34053^3^^MAILMAN^ .(-)n or n-m,a,c-d  (de)select message n
"KRN",.84,34053,2,0)
^^2^2^2991216^^
"KRN",.84,34053,2,1,0)
 .(-)n or n-m,a,c-d  (de)select message n or a list of messages
"KRN",.84,34053,2,2,0)
 .(-)*               (de)select all messages
"KRN",.84,34053,5,0)
^.841^1^1
"KRN",.84,34053,5,1,0)
XMJMLR1
"KRN",.84,34053,5,"B","XMJMLR1",1)

"KRN",.84,34054,-1)
0^207
"KRN",.84,34054,0)
34054^2^^MAILMAN^Enter a code from the list.
"KRN",.84,34054,2,0)
^^1^1^2991216^
"KRN",.84,34054,2,1,0)
Enter a code from the list.
"KRN",.84,34054,5,0)
^.841^1^1
"KRN",.84,34054,5,1,0)
XMJDIR
"KRN",.84,34054,5,"B","XMJDIR",1)

"KRN",.84,34055,-1)
0^208
"KRN",.84,34055,0)
34055^3^^MAILMAN^Press ENTER or + to go to the next page.
"KRN",.84,34055,2,0)
^^3^3^2991215^
"KRN",.84,34055,2,1,0)
Press ENTER or + to go to the next page.  Enter +n to page forward n pages.
"KRN",.84,34055,2,2,0)
Enter - to go to the previous page.  Enter -n to page back n pages.
"KRN",.84,34055,2,3,0)
Enter 0 to go to the first page; = to refresh this page; ^ to exit.
"KRN",.84,34055,5,0)
^.841^1^1
"KRN",.84,34055,5,1,0)
XMJMLR1
"KRN",.84,34055,5,"B","XMJMLR1",1)

"KRN",.84,34056,-1)
0^209
"KRN",.84,34056,0)
34056^3^^MAILMAN^Press ENTER or + to go to the next page.
"KRN",.84,34056,2,0)
^^3^3^2991215^
"KRN",.84,34056,2,1,0)
Press ENTER or + to go to the next page.
"KRN",.84,34056,2,2,0)
Enter - to go to the previous page.
"KRN",.84,34056,2,3,0)
Enter 0 to go to the first page; = to refresh this page; ^ to exit.
"KRN",.84,34056,5,0)
^.841^1^1
"KRN",.84,34056,5,1,0)
XMJMLR1
"KRN",.84,34056,5,"B","XMJMLR1",1)

"KRN",.84,34057,-1)
0^210
"KRN",.84,34057,0)
34057^3^^MAILMAN^Press ENTER or + to go to the next page.
"KRN",.84,34057,2,0)
^^2^2^2991215^
"KRN",.84,34057,2,1,0)
Press ENTER or + to go to the next page.  Enter +n to page forward n pages.
"KRN",.84,34057,2,2,0)
Enter = to refresh this page; ^ to exit this list.
"KRN",.84,34057,5,0)
^.841^1^1
"KRN",.84,34057,5,1,0)
XMJMLR1
"KRN",.84,34057,5,"B","XMJMLR1",1)

"KRN",.84,34058,-1)
0^211
"KRN",.84,34058,0)
34058^3^^MAILMAN^Press ENTER or + to go to the next page.
"KRN",.84,34058,2,0)
^^2^2^2991215^
"KRN",.84,34058,2,1,0)
Press ENTER or + to go to the next page.
"KRN",.84,34058,2,2,0)
Enter = to refresh this page; ^ to exit this list.
"KRN",.84,34058,5,0)
^.841^1^1
"KRN",.84,34058,5,1,0)
XMJMLR1
"KRN",.84,34058,5,"B","XMJMLR1",1)

"KRN",.84,34059,-1)
0^212
"KRN",.84,34059,0)
34059^3^^MAILMAN^Press ENTER or U to exit this list.
"KRN",.84,34059,2,0)
^^1^1^2991215^
"KRN",.84,34059,2,1,0)
Press ENTER or ^ to exit this list.  Enter = to refresh this page.
"KRN",.84,34059,5,0)
^.841^1^1
"KRN",.84,34059,5,1,0)
XMJMLR1
"KRN",.84,34059,5,"B","XMJMLR1",1)

"KRN",.84,34060,-1)
0^213
"KRN",.84,34060,0)
34060^3^^MAILMAN^Press ENTER or U to exit this list.
"KRN",.84,34060,2,0)
^^3^3^2991215^
"KRN",.84,34060,2,1,0)
Press ENTER or ^ to exit this list.
"KRN",.84,34060,2,2,0)
Enter - to go to the previous page.  Enter -n to page back n pages.
"KRN",.84,34060,2,3,0)
Enter 0 to go to the first page; = to refresh this page.
"KRN",.84,34060,5,0)
^.841^1^1
"KRN",.84,34060,5,1,0)
XMJMLR1
"KRN",.84,34060,5,"B","XMJMLR1",1)

"KRN",.84,34061,-1)
0^214
"KRN",.84,34061,0)
34061^3^^MAILMAN^Press ENTER or U to exit this list.
"KRN",.84,34061,2,0)
^^3^3^2991215^
"KRN",.84,34061,2,1,0)
Press ENTER or ^ to exit this list.
"KRN",.84,34061,2,2,0)
Enter - to go to the previous page.
"KRN",.84,34061,2,3,0)
Enter 0 to go to the first page; = to refresh this page.
"KRN",.84,34061,5,0)
^.841^1^1
"KRN",.84,34061,5,1,0)
XMJMLR1
"KRN",.84,34061,5,"B","XMJMLR1",1)

"KRN",.84,34065,-1)
0^215
"KRN",.84,34065,0)
34065^2^y^MAILMAN^Enter message action (in |1| basket): 
"KRN",.84,34065,1,0)
^^1^1^2991216^
"KRN",.84,34065,1,1,0)
Note: there's one blank character at the end of this dialog.
"KRN",.84,34065,2,0)
^^1^1^2991216^
"KRN",.84,34065,2,1,0)
Enter message action (in |1| basket): 
"KRN",.84,34065,3,0)
^.845^1^1
"KRN",.84,34065,3,1,0)
1^basket name
"KRN",.84,34065,5,0)
^.841^1^1
"KRN",.84,34065,5,1,0)
XMJMOI
"KRN",.84,34065,5,"B","XMJMOI",1)

"KRN",.84,34066,-1)
0^216
"KRN",.84,34066,0)
34066^2^^MAILMAN^Select Edit option: 
"KRN",.84,34066,1,0)
^^1^1^2991216^
"KRN",.84,34066,1,1,0)
Note: there's one blank character at the end of this dialog.
"KRN",.84,34066,2,0)
^^1^1^2991216^
"KRN",.84,34066,2,1,0)
Select Edit option: 
"KRN",.84,34066,5,0)
^.841^1^1
"KRN",.84,34066,5,1,0)
XMJMOIE
"KRN",.84,34066,5,"B","XMJMOIE",1)

"KRN",.84,34067,-1)
0^217
"KRN",.84,34067,0)
34067^2^^MAILMAN^Select Message option: 
"KRN",.84,34067,1,0)
^^1^1^2991216^
"KRN",.84,34067,1,1,0)
Note: there is one blank at the end of this dialog
"KRN",.84,34067,2,0)
^^1^1^2991216^
"KRN",.84,34067,2,1,0)
Select Message option: 
"KRN",.84,34067,5,0)
^.841^2^2
"KRN",.84,34067,5,1,0)
XMJMRO
"KRN",.84,34067,5,2,0)
XMJMSO
"KRN",.84,34067,5,"B","XMJMRO",1)

"KRN",.84,34067,5,"B","XMJMSO",2)

"KRN",.84,34068,-1)
0^218
"KRN",.84,34068,0)
34068^2^y^MAILMAN^This message is now in the '|1|' basket.
"KRN",.84,34068,2,0)
^^2^2^3001023^
"KRN",.84,34068,2,1,0)
This message is now in the '|1|' basket.
"KRN",.84,34068,2,2,0)
Someone acting for |2| must have moved it.
"KRN",.84,34068,3,0)
^.845^2^2
"KRN",.84,34068,3,1,0)
1^basket name
"KRN",.84,34068,3,2,0)
2^user name
"KRN",.84,34068,5,0)
^.841^1^1
"KRN",.84,34068,5,1,0)
XMJMOI1
"KRN",.84,34068,5,"B","XMJMOI1",1)

"KRN",.84,34070,-1)
0^219
"KRN",.84,34070,0)
34070^2^^MAILMAN^Finished with the 'Answer' command.
"KRN",.84,34070,2,0)
^^1^1^3000110^^
"KRN",.84,34070,2,1,0)
Finished with the 'Answer' command.
"KRN",.84,34070,5,0)
^.841^1^1
"KRN",.84,34070,5,1,0)
XMJMOI
"KRN",.84,34070,5,"B","XMJMOI",1)

"KRN",.84,34071,-1)
0^220
"KRN",.84,34071,0)
34071^2^^MAILMAN^Finished with the 'Copy' command.
"KRN",.84,34071,2,0)
^^1^1^3000110^^
"KRN",.84,34071,2,1,0)
Finished with the 'Copy' command.
"KRN",.84,34071,5,0)
^.841^1^1
"KRN",.84,34071,5,1,0)
XMJMOI
"KRN",.84,34071,5,"B","XMJMOI",1)

"KRN",.84,34072,-1)
0^221
"KRN",.84,34072,0)
34072^2^^MAILMAN^Finished with the 'Write' command.
"KRN",.84,34072,2,0)
^^1^1^3000110^^
"KRN",.84,34072,2,1,0)
Finished with the 'Write' command.
"KRN",.84,34072,5,0)
^.841^1^1
"KRN",.84,34072,5,1,0)
XMJMOI
"KRN",.84,34072,5,"B","XMJMOI",1)

"KRN",.84,34075,-1)
0^222
"KRN",.84,34075,0)
34075^2^^MAILMAN^Now back to:
"KRN",.84,34075,2,0)
^^1^1^3000105^
"KRN",.84,34075,2,1,0)
Now back to:
"KRN",.84,34075,5,0)
^.841^1^1
"KRN",.84,34075,5,1,0)
XMJMOI1
"KRN",.84,34075,5,"B","XMJMOI1",1)

"KRN",.84,34076,-1)
0^223
"KRN",.84,34076,0)
34076^2^^MAILMAN^KIDS build
"KRN",.84,34076,1,0)
^^1^1^3000105^
"KRN",.84,34076,1,1,0)
used as input into 34078 & 34079.
"KRN",.84,34076,2,0)
^^1^1^3000105^
"KRN",.84,34076,2,1,0)
KIDS build
"KRN",.84,34076,5,0)
^.841^1^1
"KRN",.84,34076,5,1,0)
XMJMOI
"KRN",.84,34076,5,"B","XMJMOI",1)

"KRN",.84,34077,-1)
0^224
"KRN",.84,34077,0)
34077^2^^MAILMAN^PackMan Message
"KRN",.84,34077,1,0)
^^1^1^3000105^
"KRN",.84,34077,1,1,0)
used as input into 34078 & 34079.
"KRN",.84,34077,2,0)
^^1^1^3000105^
"KRN",.84,34077,2,1,0)
PackMan message
"KRN",.84,34077,5,0)
^.841^1^1
"KRN",.84,34077,5,1,0)
XMJMOI
"KRN",.84,34077,5,"B","XMJMOI",1)

"KRN",.84,34078,-1)
0^225
"KRN",.84,34078,0)
34078^2^y^MAILMAN^Print just the descriptive text of this |1
"KRN",.84,34078,2,0)
^^1^1^3000105^
"KRN",.84,34078,2,1,0)
Print just the descriptive text of this |1|
"KRN",.84,34078,3,0)
^.845^1^1
"KRN",.84,34078,3,1,0)
1^KIDS or PackMan
"KRN",.84,34078,5,0)
^.841^1^1
"KRN",.84,34078,5,1,0)
XMJMOI
"KRN",.84,34078,5,"B","XMJMOI",1)

"KRN",.84,34079,-1)
0^226
"KRN",.84,34079,0)
34079^3^y^MAILMAN^This is a |1|.
"KRN",.84,34079,2,0)
^^3^3^3000105^
"KRN",.84,34079,2,1,0)
This is a |1|.
"KRN",.84,34079,2,2,0)
Answer YES to print just the descriptive text.
"KRN",.84,34079,2,3,0)
Answer NO to print the whole thing (|2| lines) and/or any responses.
"KRN",.84,34079,3,0)
^.845^2^2
"KRN",.84,34079,3,1,0)
1^KIDS build or PackMan message
"KRN",.84,34079,3,2,0)
2^number of lines in the message
"KRN",.84,34079,5,0)
^.841^1^1
"KRN",.84,34079,5,1,0)
XMJMOI
"KRN",.84,34079,5,"B","XMJMOI",1)

"KRN",.84,34081,-1)
0^227
"KRN",.84,34081,0)
34081^2^^MAILMAN^This message is a priority message.
"KRN",.84,34081,2,0)
^^2^2^3000105^
"KRN",.84,34081,2,1,0)
This message is a priority message.
"KRN",.84,34081,2,2,0)
Deliver future responses to this message as Priority Mail
"KRN",.84,34081,5,0)
^.841^1^1
"KRN",.84,34081,5,1,0)
XMJMOI1
"KRN",.84,34081,5,"B","XMJMOI1",1)

"KRN",.84,34082,-1)
0^228
"KRN",.84,34082,0)
34082^3^^MAILMAN^Your answer determines, for this message,
"KRN",.84,34082,2,0)
^^7^7^3000105^
"KRN",.84,34082,2,1,0)
Your answer determines, for this message,
"KRN",.84,34082,2,2,0)
how MailMan delivers responses to you.
"KRN",.84,34082,2,3,0)
 
"KRN",.84,34082,2,4,0)
Note: Recipients can determine for themselves, on a message by message
"KRN",.84,34082,2,5,0)
basis, how responses to priority messages are delivered to them.
"KRN",.84,34082,2,6,0)
It follows that responses to priority messages are not necessarily
"KRN",.84,34082,2,7,0)
delivered as Priority Mail to all recipients.
"KRN",.84,34082,5,0)
^.841^1^1
"KRN",.84,34082,5,1,0)
XMJMOI1
"KRN",.84,34082,5,"B","XMJMOI1",1)

"KRN",.84,34085,-1)
0^229
"KRN",.84,34085,0)
34085^2^^MAILMAN^Select New mail option: 
"KRN",.84,34085,1,0)
^^1^1^3000712^
"KRN",.84,34085,1,1,0)
There's one blank at the end.
"KRN",.84,34085,2,0)
^.844^1^1^3000712^^
"KRN",.84,34085,2,1,0)
Select New mail option: 
"KRN",.84,34085,5,0)
^.841^1^1
"KRN",.84,34085,5,1,0)
XMJBN
"KRN",.84,34085,5,"B","XMJBN",1)

"KRN",.84,34086,-1)
0^230
"KRN",.84,34086,0)
34086^2^^MAILMAN^R:Read new mail by basket
"KRN",.84,34086,2,0)
^^1^1^3000712^
"KRN",.84,34086,2,1,0)
R:Read new mail by basket
"KRN",.84,34086,5,0)
^.841^1^1
"KRN",.84,34086,5,1,0)
XMJBN
"KRN",.84,34086,5,"B","XMJBN",1)

"KRN",.84,34087,-1)
0^231
"KRN",.84,34087,0)
34087^2^^MAILMAN^LB:List Baskets with new mail
"KRN",.84,34087,2,0)
^^1^1^3000712^
"KRN",.84,34087,2,1,0)
LB:List Baskets with new mail
"KRN",.84,34087,5,0)
^.841^1^1
"KRN",.84,34087,5,1,0)
XMJBN
"KRN",.84,34087,5,"B","XMJBN",1)

"KRN",.84,34088,-1)
0^232
"KRN",.84,34088,0)
34088^2^^MAILMAN^LN:List all New messages
"KRN",.84,34088,2,0)
^^1^1^3000712^
"KRN",.84,34088,2,1,0)
LN:List all New messages
"KRN",.84,34088,5,0)
^.841^1^1
"KRN",.84,34088,5,1,0)
XMJBN
"KRN",.84,34088,5,"B","XMJBN",1)

"KRN",.84,34089,-1)
0^233
"KRN",.84,34089,0)
34089^2^^MAILMAN^LP:List all Priority messages
"KRN",.84,34089,2,0)
^^1^1^3000712^
"KRN",.84,34089,2,1,0)
LP:List all Priority messages
"KRN",.84,34089,5,0)
^.841^1^1
"KRN",.84,34089,5,1,0)
XMJBN
"KRN",.84,34089,5,"B","XMJBN",1)

"KRN",.84,34090,-1)
0^234
"KRN",.84,34090,0)
34090^2^^MAILMAN^P:Print all new messages
"KRN",.84,34090,2,0)
^^1^1^3000712^
"KRN",.84,34090,2,1,0)
P:Print all new messages
"KRN",.84,34090,5,0)
^.841^1^1
"KRN",.84,34090,5,1,0)
XMJBN
"KRN",.84,34090,5,"B","XMJBN",1)

"KRN",.84,34091,-1)
0^235
"KRN",.84,34091,0)
34091^2^^MAILMAN^S:Scan all new messages
"KRN",.84,34091,2,0)
^^1^1^3000712^
"KRN",.84,34091,2,1,0)
S:Scan all new messages
"KRN",.84,34091,5,0)
^.841^1^1
"KRN",.84,34091,5,1,0)
XMJBN
"KRN",.84,34091,5,"B","XMJBN",1)

"KRN",.84,34092,-1)
0^236
"KRN",.84,34092,0)
34092^2^^MAILMAN^Q:Quit
"KRN",.84,34092,2,0)
^^1^1^3000712^
"KRN",.84,34092,2,1,0)
Q:Quit
"KRN",.84,34092,5,0)
^.841^1^1
"KRN",.84,34092,5,1,0)
XMJBN
"KRN",.84,34092,5,"B","XMJBN",1)

"KRN",.84,34098,-1)
0^237
"KRN",.84,34098,0)
34098^2^y^MAILMAN^Done with new mail in your '|1|' basket.
"KRN",.84,34098,2,0)
^^1^1^3000712^
"KRN",.84,34098,2,1,0)
Done with new mail in your '|1|' basket.
"KRN",.84,34098,3,0)
^.845^1^1
"KRN",.84,34098,3,1,0)
1^basket name
"KRN",.84,34098,5,0)
^.841^1^1
"KRN",.84,34098,5,1,0)
XMJBN
"KRN",.84,34098,5,"B","XMJBN",1)

"KRN",.84,34099,-1)
0^238
"KRN",.84,34099,0)
34099^2^y^MAILMAN^Done with priority mail in your '|1|' bask
"KRN",.84,34099,2,0)
^.844^1^1^3000712^^
"KRN",.84,34099,2,1,0)
Done with priority mail in your '|1|' basket.
"KRN",.84,34099,3,0)
^.845^1^1
"KRN",.84,34099,3,1,0)
1^basket name
"KRN",.84,34099,5,0)
^.841^1^1
"KRN",.84,34099,5,1,0)
XMJBN
"KRN",.84,34099,5,"B","XMJBN",1)

"KRN",.84,34100,-1)
0^239
"KRN",.84,34100,0)
34100^1^^MAILMAN^No addressees.  Message not sent.
"KRN",.84,34100,2,0)
^^1^1^2991112^
"KRN",.84,34100,2,1,0)
No addressees.  Message not sent.
"KRN",.84,34100,5,0)
^.841^1^1
"KRN",.84,34100,5,1,0)
XMXSEND
"KRN",.84,34100,5,"B","XMXSEND",1)

"KRN",.84,34101,-1)
0^240
"KRN",.84,34101,0)
34101^2^^MAILMAN^Waiting for access to the MESSAGE file
"KRN",.84,34101,2,0)
^^1^1^3000103^^
"KRN",.84,34101,2,1,0)
Waiting for access to the MESSAGE file
"KRN",.84,34101,5,0)
^.841^1^1
"KRN",.84,34101,5,1,0)
XMD
"KRN",.84,34101,5,"B","XMD",1)

"KRN",.84,34102,-1)
0^241
"KRN",.84,34102,0)
34102^1^^MAILMAN^Call to DIE failed.
"KRN",.84,34102,2,0)
^.844^3^3^3010402^^
"KRN",.84,34102,2,1,0)
Call to UPDATE^DIE failed.  We can't get a message number.
"KRN",.84,34102,2,2,0)
Here is the error returned by FileMan:
"KRN",.84,34102,2,3,0)

"KRN",.84,34102,3,0)
^.845^^0
"KRN",.84,34102,5,0)
^.841^1^1
"KRN",.84,34102,5,1,0)
XMXSEND
"KRN",.84,34102,5,"B","XMXSEND",1)

"KRN",.84,34103,-1)
0^242
"KRN",.84,34103,0)
34103^2^^MAILMAN^wait
"KRN",.84,34103,2,0)
^^1^1^2991112^
"KRN",.84,34103,2,1,0)
wait
"KRN",.84,34103,5,0)
^.841^1^1
"KRN",.84,34103,5,1,0)
XMXSEND
"KRN",.84,34103,5,"B","XMXSEND",1)

"KRN",.84,34104,-1)
0^243
"KRN",.84,34104,0)
34104^2^^MAILMAN^keep waiting
"KRN",.84,34104,2,0)
^^1^1^2991112^
"KRN",.84,34104,2,1,0)
keep waiting
"KRN",.84,34104,5,0)
^.841^1^1
"KRN",.84,34104,5,1,0)
XMXSEND
"KRN",.84,34104,5,"B","XMXSEND",1)

"KRN",.84,34105,-1)
0^244
"KRN",.84,34105,0)
34105^2^y^MAILMAN^Some other process has a lock on the MESS
"KRN",.84,34105,2,0)
^^5^5^2991112^
"KRN",.84,34105,2,1,0)
Some other process has a lock on the MESSAGE file.
"KRN",.84,34105,2,2,0)
In order to maintain file integrity, we must wait
"KRN",.84,34105,2,3,0)
until the lock is released before we can continue.
"KRN",.84,34105,2,4,0)
If you wish to |1|, answer YES.
"KRN",.84,34105,2,5,0)
If you don't wish to |1|, answer NO.
"KRN",.84,34105,3,0)
^.845^1^1
"KRN",.84,34105,3,1,0)
1^wait/keep waiting
"KRN",.84,34105,5,0)
^.841^1^1
"KRN",.84,34105,5,1,0)
XMXSEND
"KRN",.84,34105,5,"B","XMXSEND",1)

"KRN",.84,34106,-1)
0^245
"KRN",.84,34106,0)
34106^2^^MAILMAN^Please try again later.
"KRN",.84,34106,2,0)
^^1^1^2991112^
"KRN",.84,34106,2,1,0)
Please try again later.
"KRN",.84,34106,5,0)
^.841^1^1
"KRN",.84,34106,5,1,0)
XMXSEND
"KRN",.84,34106,5,"B","XMXSEND",1)

"KRN",.84,34107,-1)
0^246
"KRN",.84,34107,0)
34107^1^^MAILMAN^We can't get a message number.
"KRN",.84,34107,2,0)
^.844^3^3^3010402^^
"KRN",.84,34107,2,1,0)
Call to UPDATE^DIE failed.  We can't get a message number.
"KRN",.84,34107,2,2,0)
Here's the error returned by FileMan:
"KRN",.84,34107,2,3,0)

"KRN",.84,34107,5,0)
^.841^1^1
"KRN",.84,34107,5,1,0)
XMXSEND
"KRN",.84,34107,5,"B","XMXSEND",1)

"KRN",.84,34110,-1)
0^247
"KRN",.84,34110,0)
34110^2^^MAILMAN^Send
"KRN",.84,34110,2,0)
^^1^1^2991103^
"KRN",.84,34110,2,1,0)
Send
"KRN",.84,34110,5,0)
^.841^7^7
"KRN",.84,34110,5,1,0)
XMD
"KRN",.84,34110,5,2,0)
XMA21
"KRN",.84,34110,5,3,0)
XMAPHOST
"KRN",.84,34110,5,4,0)
XMJMT
"KRN",.84,34110,5,5,0)
XMJMC
"KRN",.84,34110,5,6,0)
XMJMA
"KRN",.84,34110,5,7,0)
XMJMS
"KRN",.84,34110,5,"B","XMA21",2)

"KRN",.84,34110,5,"B","XMAPHOST",3)

"KRN",.84,34110,5,"B","XMD",1)

"KRN",.84,34110,5,"B","XMJMA",6)

"KRN",.84,34110,5,"B","XMJMC",5)

"KRN",.84,34110,5,"B","XMJMS",7)

"KRN",.84,34110,5,"B","XMJMT",4)

"KRN",.84,34111,-1)
0^248
"KRN",.84,34111,0)
34111^2^^MAILMAN^Forward
"KRN",.84,34111,2,0)
^^1^1^2991103^
"KRN",.84,34111,2,1,0)
Forward
"KRN",.84,34111,5,0)
^.841^2^2
"KRN",.84,34111,5,1,0)
XMD
"KRN",.84,34111,5,2,0)
XMJMT
"KRN",.84,34111,5,"B","XMD",1)

"KRN",.84,34111,5,"B","XMJMT",2)

"KRN",.84,34112,-1)
0^249
"KRN",.84,34112,0)
34112^2^y^MAILMAN^|1| mail to
"KRN",.84,34112,2,0)
^^1^1^2991117^
"KRN",.84,34112,2,1,0)
|1| mail to
"KRN",.84,34112,3,0)
^.845^1^1
"KRN",.84,34112,3,1,0)
1^send or forward
"KRN",.84,34112,5,0)
^.841^1^1
"KRN",.84,34112,5,1,0)
XMJMT
"KRN",.84,34112,5,"B","XMJMT",1)

"KRN",.84,34113,-1)
0^250
"KRN",.84,34113,0)
34113^2^y^MAILMAN^And |1| to
"KRN",.84,34113,2,0)
^^1^1^2991117^
"KRN",.84,34113,2,1,0)
And |1| to
"KRN",.84,34113,3,0)
^.845^1^1
"KRN",.84,34113,3,1,0)
1^send or forward
"KRN",.84,34113,5,0)
^.841^1^1
"KRN",.84,34113,5,1,0)
XMJMT
"KRN",.84,34113,5,"B","XMJMT",1)

"KRN",.84,34114,-1)
0^251
"KRN",.84,34114,0)
34114^3^^MAILMAN^Enter the name(s) of the recipient(s)
"KRN",.84,34114,2,0)
^.844^19^19^3020411^^^
"KRN",.84,34114,2,1,0)
Enter the recipient(s) of this message in any of the following formats:
"KRN",.84,34114,2,2,0)

"KRN",.84,34114,2,3,0)
Lastname,first              for a user at this site
"KRN",.84,34114,2,4,0)
Lastname,first@REMOTE-SITE  for a user at another site
"KRN",.84,34114,2,5,0)
  (note: DUZ may be used, instead of Lastname,first for local or remote users)
"KRN",.84,34114,2,6,0)
G.<group-name>              for a mail group
"KRN",.84,34114,2,7,0)
D. or H.<device-name>       for a device (H. is for Headerless printing)
"KRN",.84,34114,2,8,0)
*                           for a limited broadcast or broadcast to all users
"KRN",.84,34114,2,9,0)
                            (must be Postmaster or XMSTAR key holder)
"KRN",.84,34114,2,10,0)

"KRN",.84,34114,2,11,0)
Prefix any user address with 'I:' to send Information only.
"KRN",.84,34114,2,12,0)
                             'C:' to send Carbon Copy.
"KRN",.84,34114,2,13,0)
                             'L:' to send Later.
"KRN",.84,34114,2,14,0)
                             '-'  to delete it.
"KRN",.84,34114,2,15,0)
Enter:
"KRN",.84,34114,2,16,0)
G.?                         for a list of mail groups
"KRN",.84,34114,2,17,0)
D.? or H.?                  for a list of devices
"KRN",.84,34114,2,18,0)

"KRN",.84,34114,2,19,0)
Enter '??' for detailed help.
"KRN",.84,34114,5,0)
^.841^1^1
"KRN",.84,34114,5,1,0)
XMJMT
"KRN",.84,34114,5,"B","XMJMT",1)

"KRN",.84,34115,-1)
0^252
"KRN",.84,34115,0)
34115^2^^MAILMAN^Shall we forget the whole thing
"KRN",.84,34115,2,0)
^^1^1^2991117^
"KRN",.84,34115,2,1,0)
Shall we forget the whole thing
"KRN",.84,34115,5,0)
^.841^1^1
"KRN",.84,34115,5,1,0)
XMJMT
"KRN",.84,34115,5,"B","XMJMT",1)

"KRN",.84,34116,-1)
0^253
"KRN",.84,34116,0)
34116^3^^MAILMAN^Enter YES to abort this message.
"KRN",.84,34116,2,0)
^^2^2^2991117^
"KRN",.84,34116,2,1,0)
Enter YES to abort this message.
"KRN",.84,34116,2,2,0)
Enter NO to continue sending it.
"KRN",.84,34116,5,0)
^.841^1^1
"KRN",.84,34116,5,1,0)
XMJMT
"KRN",.84,34116,5,"B","XMJMT",1)

"KRN",.84,34117,-1)
0^254
"KRN",.84,34117,0)
34117^1^^MAILMAN^Only the message originator or XM GROUP
"KRN",.84,34117,2,0)
^^2^2^2991117^^
"KRN",.84,34117,2,1,0)
Only the message originator or XM GROUP PRIORITY key
"KRN",.84,34117,2,2,0)
holders may forward priority messages to Mail Groups.
"KRN",.84,34117,5,0)
^.841^1^1
"KRN",.84,34117,5,1,0)
XMJMT
"KRN",.84,34117,5,"B","XMJMT",1)

"KRN",.84,34120,-1)
0^255
"KRN",.84,34120,0)
34120^2^^MAILMAN^Enter the kind of help you'd like
"KRN",.84,34120,2,0)
^^1^1^2991117^
"KRN",.84,34120,2,1,0)
Enter the kind of help you'd like
"KRN",.84,34120,5,0)
^.841^1^1
"KRN",.84,34120,5,1,0)
XMJMT
"KRN",.84,34120,5,"B","XMJMT",1)

"KRN",.84,34121,-1)
0^256
"KRN",.84,34121,0)
34121^2^^MAILMAN^G:Mail Group information
"KRN",.84,34121,2,0)
^^1^1^2991117^
"KRN",.84,34121,2,1,0)
G:Mail Group information
"KRN",.84,34121,5,0)
^.841^1^1
"KRN",.84,34121,5,1,0)
XMJMT
"KRN",.84,34121,5,"B","XMJMT",1)

"KRN",.84,34122,-1)
0^257
"KRN",.84,34122,0)
34122^2^^MAILMAN^D:Domain information
"KRN",.84,34122,2,0)
^^1^1^2991117^
"KRN",.84,34122,2,1,0)
D:Domain information
"KRN",.84,34122,5,0)
^.841^1^1
"KRN",.84,34122,5,1,0)
XMJMT
"KRN",.84,34122,5,"B","XMJMT",1)

"KRN",.84,34123,-1)
0^258
"KRN",.84,34123,0)
34123^2^^MAILMAN^R:Remote user information
"KRN",.84,34123,2,0)
^^1^1^2991117^
"KRN",.84,34123,2,1,0)
R:Remote user information
"KRN",.84,34123,5,0)
^.841^1^1
"KRN",.84,34123,5,1,0)
XMJMT
"KRN",.84,34123,5,"B","XMJMT",1)

"KRN",.84,34124,-1)
0^259
"KRN",.84,34124,0)
34124^2^^MAILMAN^S:Show current recipients of this message
"KRN",.84,34124,2,0)
^^1^1^2991117^
"KRN",.84,34124,2,1,0)
S:Show current recipients of this message
"KRN",.84,34124,5,0)
^.841^1^1
"KRN",.84,34124,5,1,0)
XMJMT
"KRN",.84,34124,5,"B","XMJMT",1)

"KRN",.84,34125,-1)
0^260
"KRN",.84,34125,0)
34125^2^^MAILMAN^M:More help
"KRN",.84,34125,2,0)
^^1^1^2991117^
"KRN",.84,34125,2,1,0)
M:More help
"KRN",.84,34125,5,0)
^.841^1^1
"KRN",.84,34125,5,1,0)
XMJMT
"KRN",.84,34125,5,"B","XMJMT",1)

"KRN",.84,34126,-1)
0^261
"KRN",.84,34126,0)
34126^2^^MAILMAN^U:User information
"KRN",.84,34126,2,0)
^^1^1^2991117^
"KRN",.84,34126,2,1,0)
U:User information
"KRN",.84,34126,5,0)
^.841^1^1
"KRN",.84,34126,5,1,0)
XMJMT
"KRN",.84,34126,5,"B","XMJMT",1)

"KRN",.84,34130,-1)
0^262
"KRN",.84,34130,0)
34130^2^^MAILMAN^There aren't any recipients so far.
"KRN",.84,34130,2,0)
^^1^1^2991117^
"KRN",.84,34130,2,1,0)
There aren't any recipients so far.
"KRN",.84,34130,5,0)
^.841^1^1
"KRN",.84,34130,5,1,0)
XMJMT
"KRN",.84,34130,5,"B","XMJMT",1)

"KRN",.84,34131,-1)
0^263
"KRN",.84,34131,0)
34131^2^^MAILMAN^Current recipients are:
"KRN",.84,34131,2,0)
^^1^1^2991117^
"KRN",.84,34131,2,1,0)
Current recipients are:
"KRN",.84,34131,5,0)
^.841^1^1
"KRN",.84,34131,5,1,0)
XMJMT
"KRN",.84,34131,5,"B","XMJMT",1)

"KRN",.84,34132,-1)
0^264
"KRN",.84,34132,0)
34132^2^^MAILMAN^  Deliver:
"KRN",.84,34132,2,0)
^^1^1^2991117^
"KRN",.84,34132,2,1,0)
  Deliver: 
"KRN",.84,34132,5,0)
^.841^1^1
"KRN",.84,34132,5,1,0)
XMJMT
"KRN",.84,34132,5,"B","XMJMT",1)

"KRN",.84,34133,-1)
0^265
"KRN",.84,34133,0)
34133^2^^MAILMAN^Like more detail
"KRN",.84,34133,2,0)
^^1^1^2991117^
"KRN",.84,34133,2,1,0)
Like more detail
"KRN",.84,34133,5,0)
^.841^1^1
"KRN",.84,34133,5,1,0)
XMJMT
"KRN",.84,34133,5,"B","XMJMT",1)

"KRN",.84,34140,-1)
0^266
"KRN",.84,34140,0)
34140^2^^MAILMAN^  Routing indicator:
"KRN",.84,34140,2,0)
^.844^1^1^3001020^^
"KRN",.84,34140,2,1,0)
  Routing Indicator: 
"KRN",.84,34140,5,0)
^.841^1^1
"KRN",.84,34140,5,1,0)
XMJMT
"KRN",.84,34140,5,"B","XMJMT",1)

"KRN",.84,34141,-1)
0^267
"KRN",.84,34141,0)
34141^2^^MAILMAN^  MailMan Host Number:
"KRN",.84,34141,2,0)
^^1^1^2991117^
"KRN",.84,34141,2,1,0)
  MailMan Host Number: 
"KRN",.84,34141,5,0)
^.841^1^1
"KRN",.84,34141,5,1,0)
XMJMT
"KRN",.84,34141,5,"B","XMJMT",1)

"KRN",.84,34142,-1)
0^268
"KRN",.84,34142,0)
34142^2^^MAILMAN^  Security Key:
"KRN",.84,34142,2,0)
^^1^1^2991117^
"KRN",.84,34142,2,1,0)
  Security Key: 
"KRN",.84,34142,5,0)
^.841^1^1
"KRN",.84,34142,5,1,0)
XMJMT
"KRN",.84,34142,5,"B","XMJMT",1)

"KRN",.84,34143,-1)
0^269
"KRN",.84,34143,0)
34143^2^^MAILMAN^  Relay Domain:
"KRN",.84,34143,2,0)
^^1^1^2991117^
"KRN",.84,34143,2,1,0)
  Relay Domain: 
"KRN",.84,34143,5,0)
^.841^1^1
"KRN",.84,34143,5,1,0)
XMJMT
"KRN",.84,34143,5,"B","XMJMT",1)

"KRN",.84,34144,-1)
0^270
"KRN",.84,34144,0)
34144^2^^MAILMAN^  Messages cannot be sent, because this
"KRN",.84,34144,2,0)
^^1^1^2991117^^
"KRN",.84,34144,2,1,0)
  Messages cannot be sent, because this domain is CLOSED
"KRN",.84,34144,5,0)
^.841^1^1
"KRN",.84,34144,5,1,0)
XMJMT
"KRN",.84,34144,5,"B","XMJMT",1)

"KRN",.84,34145,-1)
0^271
"KRN",.84,34145,0)
34145^2^^MAILMAN^  Messages are QUEUED for later trans
"KRN",.84,34145,2,0)
^^1^1^2991117^
"KRN",.84,34145,2,1,0)
  Messages are QUEUED for later transmission
"KRN",.84,34145,5,0)
^.841^1^1
"KRN",.84,34145,5,1,0)
XMJMT
"KRN",.84,34145,5,"B","XMJMT",1)

"KRN",.84,34146,-1)
0^272
"KRN",.84,34146,0)
34146^2^^MAILMAN^  Messages are SENT immediately
"KRN",.84,34146,2,0)
^^1^1^2991117^
"KRN",.84,34146,2,1,0)
  Messages are SENT immediately
"KRN",.84,34146,5,0)
^.841^1^1
"KRN",.84,34146,5,1,0)
XMJMT
"KRN",.84,34146,5,"B","XMJMT",1)

"KRN",.84,34149,-1)
0^273
"KRN",.84,34149,0)
34149^2^^MAILMAN^Enter LAST NAME, MAIL CODE, or part of
"KRN",.84,34149,2,0)
^^1^1^2991117^^
"KRN",.84,34149,2,1,0)
Enter LASTNAME, MAIL CODE, or part of LOCATION (one word only): 
"KRN",.84,34149,5,0)
^.841^1^1
"KRN",.84,34149,5,1,0)
XMJMT
"KRN",.84,34149,5,"B","XMJMT",1)

"KRN",.84,34200,-1)
0^274
"KRN",.84,34200,0)
34200^3^^MAILMAN^Responses to priority messages are not
"KRN",.84,34200,2,0)
^^3^3^2991103^^
"KRN",.84,34200,2,1,0)
Responses to priority messages are not always delivered as
"KRN",.84,34200,2,2,0)
priority mail.  If your response needs priority delivery, use
"KRN",.84,34200,2,3,0)
the 'write' command to send a new priority message.
"KRN",.84,34200,5,0)
^.841^1^1
"KRN",.84,34200,5,1,0)
XMJMR
"KRN",.84,34200,5,"B","XMJMR",1)

"KRN",.84,34201,-1)
0^275
"KRN",.84,34201,0)
34201^3^^MAILMAN^Because this message is from a remote
"KRN",.84,34201,2,0)
^^2^2^2991103^
"KRN",.84,34201,2,1,0)
Because this message is from a remote POSTMASTER, your reply
"KRN",.84,34201,2,2,0)
will remain local; it will not be sent over the network.
"KRN",.84,34201,5,0)
^.841^1^1
"KRN",.84,34201,5,1,0)
XMJMR
"KRN",.84,34201,5,"B","XMJMR",1)

"KRN",.84,34202,-1)
0^276
"KRN",.84,34202,0)
34202^2^^MAILMAN^Copying...
"KRN",.84,34202,2,0)
^^1^1^2991103^
"KRN",.84,34202,2,1,0)
Copying...
"KRN",.84,34202,5,0)
^.841^1^1
"KRN",.84,34202,5,1,0)
XMJMR
"KRN",.84,34202,5,"B","XMJMR",1)

"KRN",.84,34203,-1)
0^277
"KRN",.84,34203,0)
34203^2^y^MAILMAN^On |1| (|2|) |3| wrote:
"KRN",.84,34203,2,0)
^^1^1^2991103^
"KRN",.84,34203,2,1,0)
On |1| (|2|) |3| wrote:
"KRN",.84,34203,3,0)
^.845^3^3
"KRN",.84,34203,3,1,0)
1^date
"KRN",.84,34203,3,2,0)
2^original message or response
"KRN",.84,34203,3,3,0)
3^who wrote it
"KRN",.84,34203,5,0)
^.841^1^1
"KRN",.84,34203,5,1,0)
XMJMR
"KRN",.84,34203,5,"B","XMJMR",1)

"KRN",.84,34204,-1)
0^278
"KRN",.84,34204,0)
34204^2^y^MAILMAN^Response #|1|
"KRN",.84,34204,2,0)
^^1^1^2991103^
"KRN",.84,34204,2,1,0)
Response #|1|
"KRN",.84,34204,3,0)
^.845^1^1
"KRN",.84,34204,3,1,0)
1^response number
"KRN",.84,34204,5,0)
^.841^2^2
"KRN",.84,34204,5,1,0)
XMJMR
"KRN",.84,34204,5,2,0)
XMJMC
"KRN",.84,34204,5,"B","XMJMC",2)

"KRN",.84,34204,5,"B","XMJMR",1)

"KRN",.84,34205,-1)
0^279
"KRN",.84,34205,0)
34205^2^^MAILMAN^Original message
"KRN",.84,34205,2,0)
^^1^1^2991103^
"KRN",.84,34205,2,1,0)
Original message
"KRN",.84,34205,5,0)
^.841^2^2
"KRN",.84,34205,5,1,0)
XMJMR
"KRN",.84,34205,5,2,0)
XMJMC
"KRN",.84,34205,5,"B","XMJMC",2)

"KRN",.84,34205,5,"B","XMJMR",1)

"KRN",.84,34206,-1)
0^280
"KRN",.84,34206,0)
34206^2^^MAILMAN^Do you wish to send this reply across the
"KRN",.84,34206,2,0)
^^1^1^2991103^
"KRN",.84,34206,2,1,0)
Do you wish to send this reply across the network
"KRN",.84,34206,5,0)
^.841^1^1
"KRN",.84,34206,5,1,0)
XMJMR
"KRN",.84,34206,5,"B","XMJMR",1)

"KRN",.84,34207,-1)
0^281
"KRN",.84,34207,0)
34207^2^^MAILMAN^Enter YES if you wish your response
"KRN",.84,34207,2,0)
^^2^2^2991103^
"KRN",.84,34207,2,1,0)
Enter YES if you wish to send your response across the network;
"KRN",.84,34207,2,2,0)
Enter NO if you wish your response to remain local.
"KRN",.84,34207,5,0)
^.841^1^1
"KRN",.84,34207,5,1,0)
XMJMR
"KRN",.84,34207,5,"B","XMJMR",1)

"KRN",.84,34208,-1)
0^282
"KRN",.84,34208,0)
34208^3^^MAILMAN^A network response will go to all message
"KRN",.84,34208,2,0)
^^10^10^2991103^
"KRN",.84,34208,2,1,0)
A network response will go to all message recipients on the mail
"KRN",.84,34208,2,2,0)
system of the sender.
"KRN",.84,34208,2,3,0)

"KRN",.84,34208,2,4,0)
For example, if the sender's address ends in '@FORUM.MED.VA.GOV',
"KRN",.84,34208,2,5,0)
and the message had 500 recipients on FORUM, then a response sent
"KRN",.84,34208,2,6,0)
across the network would be delivered to all of the FORUM recipients.
"KRN",.84,34208,2,7,0)
The response would not be sent to any other remote sites.
"KRN",.84,34208,2,8,0)

"KRN",.84,34208,2,9,0)
If you prefer to send a response only to the sender, you may create
"KRN",.84,34208,2,10,0)
a new message by choosing to 'answer' or 'write', instead of 'reply'.
"KRN",.84,34208,5,0)
^.841^1^1
"KRN",.84,34208,5,1,0)
XMJMR
"KRN",.84,34208,5,"B","XMJMR",1)

"KRN",.84,34209,-1)
0^283
"KRN",.84,34209,0)
34209^2^^MAILMAN^include
"KRN",.84,34209,2,0)
^^1^1^2991123^
"KRN",.84,34209,2,1,0)
include
"KRN",.84,34209,5,0)
^.841^2^2
"KRN",.84,34209,5,1,0)
XMJMR
"KRN",.84,34209,5,2,0)
XMJMRO
"KRN",.84,34209,5,"B","XMJMR",1)

"KRN",.84,34209,5,"B","XMJMRO",2)

"KRN",.84,34211,-1)
0^284
"KRN",.84,34211,0)
34211^2^y^MAILMAN^Addressing the reply to: |1|
"KRN",.84,34211,2,0)
^^1^1^2991103^
"KRN",.84,34211,2,1,0)
Addressing the reply to: |1|
"KRN",.84,34211,3,0)
^.845^1^1
"KRN",.84,34211,3,1,0)
1^to whom
"KRN",.84,34211,5,0)
^.841^1^1
"KRN",.84,34211,5,1,0)
XMJMR
"KRN",.84,34211,5,"B","XMJMR",1)

"KRN",.84,34212,-1)
0^285
"KRN",.84,34212,0)
34212^2^^MAILMAN^  Sending network reply...
"KRN",.84,34212,2,0)
^^1^1^2991103^
"KRN",.84,34212,2,1,0)
  Sending network reply...
"KRN",.84,34212,5,0)
^.841^1^1
"KRN",.84,34212,5,1,0)
XMJMR
"KRN",.84,34212,5,"B","XMJMR",1)

"KRN",.84,34213,-1)
0^286
"KRN",.84,34213,0)
34213^2^^MAILMAN^  Sent
"KRN",.84,34213,2,0)
^^1^1^2991103^
"KRN",.84,34213,2,1,0)
  Sent
"KRN",.84,34213,5,0)
^.841^1^1
"KRN",.84,34213,5,1,0)
XMJMR
"KRN",.84,34213,5,"B","XMJMR",1)

"KRN",.84,34214,-1)
0^287
"KRN",.84,34214,0)
34214^2^^MAILMAN^This message has a 'reply-to' address
"KRN",.84,34214,2,0)
^^2^2^2991103^
"KRN",.84,34214,2,1,0)
This message has a 'reply-to' address which differs from the 'from' address.
"KRN",.84,34214,2,2,0)
Select the address to use
"KRN",.84,34214,5,0)
^.841^1^1
"KRN",.84,34214,5,1,0)
XMJMR
"KRN",.84,34214,5,"B","XMJMR",1)

"KRN",.84,34215,-1)
0^288
"KRN",.84,34215,0)
34215^3^^MAILMAN^Generally, we recommend that you use
"KRN",.84,34215,2,0)
^^3^3^2991103^
"KRN",.84,34215,2,1,0)
Generally, we recommend that you use the 'reply-to' address.
"KRN",.84,34215,2,2,0)
The choice, however, is up to you.
"KRN",.84,34215,2,3,0)
Select F to use the 'from' address; R the 'reply-to'.
"KRN",.84,34215,5,0)
^.841^1^1
"KRN",.84,34215,5,1,0)
XMJMR
"KRN",.84,34215,5,"B","XMJMR",1)

"KRN",.84,34216,-1)
0^289
"KRN",.84,34216,0)
34216^2^^MAILMAN^  Sending local reply...
"KRN",.84,34216,2,0)
^^1^1^2991216^
"KRN",.84,34216,2,1,0)
  Sending local reply...
"KRN",.84,34216,5,0)
^.841^1^1
"KRN",.84,34216,5,1,0)
XMJMRO
"KRN",.84,34216,5,"B","XMJMRO",1)

"KRN",.84,34217,-1)
0^290
"KRN",.84,34217,0)
34217^2^y^MAILMAN^  Sending [|1|]...
"KRN",.84,34217,2,0)
^^1^1^2991216^^
"KRN",.84,34217,2,1,0)
Sending [|1|]...
"KRN",.84,34217,3,0)
^.845^1^1
"KRN",.84,34217,3,1,0)
1^message ien in message file
"KRN",.84,34217,5,0)
^.841^1^1
"KRN",.84,34217,5,1,0)
XMJMSO
"KRN",.84,34217,5,"B","XMJMSO",1)

"KRN",.84,34220,-1)
0^291
"KRN",.84,34220,0)
34220^2^^MAILMAN^replying to
"KRN",.84,34220,2,0)
^^1^1^2991123^
"KRN",.84,34220,2,1,0)
replying to
"KRN",.84,34220,5,0)
^.841^1^1
"KRN",.84,34220,5,1,0)
XMJMR
"KRN",.84,34220,5,"B","XMJMR",1)

"KRN",.84,34221,-1)
0^292
"KRN",.84,34221,0)
34221^2^^MAILMAN^recovering
"KRN",.84,34221,2,0)
^^1^1^2991123^
"KRN",.84,34221,2,1,0)
recovering
"KRN",.84,34221,5,0)
^.841^2^2
"KRN",.84,34221,5,1,0)
XMJMR
"KRN",.84,34221,5,2,0)
XMJMS
"KRN",.84,34221,5,"B","XMJMR",1)

"KRN",.84,34221,5,"B","XMJMS",2)

"KRN",.84,34222,-1)
0^293
"KRN",.84,34222,0)
34222^2^^MAILMAN^You have an unsent response in your buffer
"KRN",.84,34222,2,0)
^.844^1^1^3010824^^^
"KRN",.84,34222,2,1,0)
You have an unsent response in your buffer.
"KRN",.84,34222,5,0)
^.841^1^1
"KRN",.84,34222,5,1,0)
XMJMR
"KRN",.84,34222,5,"B","XMJMR",1)

"KRN",.84,34222.1,-1)
0^294
"KRN",.84,34222.1,0)
34222.1^2^y^MAILMAN^|1| has an unsent response remaining in
"KRN",.84,34222.1,2,0)
^^1^1^3010824^
"KRN",.84,34222.1,2,1,0)
|1| has an unsent response in the buffer.
"KRN",.84,34222.1,3,0)
^.845^1^1
"KRN",.84,34222.1,3,1,0)
1^user's name
"KRN",.84,34222.1,5,0)
^.841^1^1
"KRN",.84,34222.1,5,1,0)
XMJMR
"KRN",.84,34222.1,5,"B","XMJMR",1)

"KRN",.84,34222.3,-1)
0^295
"KRN",.84,34222.3,0)
34222.3^2^^MAILMAN^You may continue to reply, or delete the
"KRN",.84,34222.3,2,0)
^^2^2^3010824^
"KRN",.84,34222.3,2,1,0)
You may continue to reply, or delete the remaining text.
"KRN",.84,34222.3,2,2,0)
Do you want to delete the unsent response
"KRN",.84,34222.3,5,0)
^.841^1^1
"KRN",.84,34222.3,5,1,0)
XMJMR
"KRN",.84,34222.3,5,"B","XMJMR",1)

"KRN",.84,34223,-1)
0^296
"KRN",.84,34223,0)
34223^3^^MAILMAN^Enter YES to delete the unsent response.
"KRN",.84,34223,2,0)
^^5^5^2991123^
"KRN",.84,34223,2,1,0)
Enter YES to delete the unsent response.
"KRN",.84,34223,2,2,0)
Enter NO to continue with the response.
"KRN",.84,34223,2,3,0)
 
"KRN",.84,34223,2,4,0)
If in doubt, just press return.
"KRN",.84,34223,2,5,0)
You will be able to edit the response and delete it if you wish.
"KRN",.84,34223,5,0)
^.841^1^1
"KRN",.84,34223,5,1,0)
XMJMR
"KRN",.84,34223,5,"B","XMJMR",1)

"KRN",.84,34230,-1)
0^297
"KRN",.84,34230,0)
34230^2^^MAILMAN^No user identity.  Using Postmaster as
"KRN",.84,34230,2,0)
^^1^1^2991110^
"KRN",.84,34230,2,1,0)
No user identity.  Using Postmaster as sender and receiver.
"KRN",.84,34230,5,0)
^.841^1^1
"KRN",.84,34230,5,1,0)
XMAPHOST
"KRN",.84,34230,5,"B","XMAPHOST",1)

"KRN",.84,34231,-1)
0^298
"KRN",.84,34231,0)
34231^2^^MAILMAN^You do not have a mailbox.  Using Post
"KRN",.84,34231,2,0)
^^1^1^2991110^
"KRN",.84,34231,2,1,0)
You do not have a mailbox.  Using Postmaster as sender and receiver.
"KRN",.84,34231,5,0)
^.841^1^1
"KRN",.84,34231,5,1,0)
XMAPHOST
"KRN",.84,34231,5,"B","XMAPHOST",1)

"KRN",.84,34232,-1)
0^299
"KRN",.84,34232,0)
34232^2^^MAILMAN^Sorry, I cannot stop the creation of this
"KRN",.84,34232,2,0)
^^2^2^2991221^^
"KRN",.84,34232,2,1,0)
Sorry, I cannot stop the creation of this message at this point.
"KRN",.84,34232,2,2,0)
You must enter a valid subject.
"KRN",.84,34232,5,0)
^.841^1^1
"KRN",.84,34232,5,1,0)
XMAPHOST
"KRN",.84,34232,5,"B","XMAPHOST",1)

"KRN",.84,34233,-1)
0^300
"KRN",.84,34233,0)
34233^2^y^MAILMAN^Queued Mail Report from |1|
"KRN",.84,34233,2,0)
^^1^1^2991110^
"KRN",.84,34233,2,1,0)
Queued Mail Report from |1|
"KRN",.84,34233,3,0)
^.845^1^1
"KRN",.84,34233,3,1,0)
1^who sent it
"KRN",.84,34233,5,0)
^.841^1^1
"KRN",.84,34233,5,1,0)
XMAPHOST
"KRN",.84,34233,5,"B","XMAPHOST",1)

"KRN",.84,34234,-1)
0^301
"KRN",.84,34234,0)
34234^2^^MAILMAN^Moving to MailMan message...
"KRN",.84,34234,2,0)
^.844^1^1^3000621^^^
"KRN",.84,34234,2,1,0)
Moving to MailMan message...
"KRN",.84,34234,5,0)
^.841^1^1
"KRN",.84,34234,5,1,0)
XMAPHOST
"KRN",.84,34234,5,"B","XMAPHOST",1)

"KRN",.84,34235,-1)
0^302
"KRN",.84,34235,0)
34235^2^y^MAILMAN^P-MESSAGE line limit of |1| reached.
"KRN",.84,34235,2,0)
^^1^1^2991110^^
"KRN",.84,34235,2,1,0)
P-MESSAGE line limit of |1| reached.  Rest of file ignored.
"KRN",.84,34235,3,0)
^.845^1^1
"KRN",.84,34235,3,1,0)
1^line limit
"KRN",.84,34235,5,0)
^.841^1^1
"KRN",.84,34235,5,1,0)
XMAPHOST
"KRN",.84,34235,5,"B","XMAPHOST",1)

"KRN",.84,34236,-1)
0^303
"KRN",.84,34236,0)
34236^2^^MAILMAN^Finished moving.
"KRN",.84,34236,2,0)
^.844^1^1^3000621^^
"KRN",.84,34236,2,1,0)
Finished moving.
"KRN",.84,34236,5,0)
^.841^1^1
"KRN",.84,34236,5,1,0)
XMAPHOST
"KRN",.84,34236,5,"B","XMAPHOST",1)

"KRN",.84,34237,-1)
0^304
"KRN",.84,34237,0)
34237^2^^MAILMAN^End of file reached
"KRN",.84,34237,2,0)
^^1^1^2991110^
"KRN",.84,34237,2,1,0)
End of file reached
"KRN",.84,34237,5,0)
^.841^1^1
"KRN",.84,34237,5,1,0)
XMAPHOST
"KRN",.84,34237,5,"B","XMAPHOST",1)

"KRN",.84,34238,-1)
0^305
"KRN",.84,34238,0)
34238^2^y^MAILMAN^Message subject: |1|, Message number: |2|
"KRN",.84,34238,2,0)
^^1^1^2991110^
"KRN",.84,34238,2,1,0)
Message subject: |1|, Message number: |2|
"KRN",.84,34238,3,0)
^.845^2^2
"KRN",.84,34238,3,1,0)
1^message subject
"KRN",.84,34238,3,2,0)
2^message ien
"KRN",.84,34238,5,0)
^.841^1^1
"KRN",.84,34238,5,1,0)
XMAPHOST
"KRN",.84,34238,5,"B","XMAPHOST",1)

"KRN",.84,34239,-1)
0^306
"KRN",.84,34239,0)
34239^2^^MAILMAN^From whom
"KRN",.84,34239,2,0)
^^1^1^2991110^
"KRN",.84,34239,2,1,0)
From whom
"KRN",.84,34239,5,0)
^.841^1^1
"KRN",.84,34239,5,1,0)
XMAPHOST
"KRN",.84,34239,5,"B","XMAPHOST",1)

"KRN",.84,34240,-1)
0^307
"KRN",.84,34240,0)
34240^2^^MAILMAN^M:Me
"KRN",.84,34240,2,0)
^^1^1^2991110^
"KRN",.84,34240,2,1,0)
M:Me
"KRN",.84,34240,5,0)
^.841^1^1
"KRN",.84,34240,5,1,0)
XMAPHOST
"KRN",.84,34240,5,"B","XMAPHOST",1)

"KRN",.84,34241,-1)
0^308
"KRN",.84,34241,0)
34241^2^^MAILMAN^P:Postmaster
"KRN",.84,34241,2,0)
^^1^1^2991110^
"KRN",.84,34241,2,1,0)
P:Postmaster
"KRN",.84,34241,5,0)
^.841^1^1
"KRN",.84,34241,5,1,0)
XMAPHOST
"KRN",.84,34241,5,"B","XMAPHOST",1)

"KRN",.84,34242,-1)
0^309
"KRN",.84,34242,0)
34242^3^^MAILMAN^Answer 'Me' if the message should be from
"KRN",.84,34242,2,0)
^^7^7^2991221^^
"KRN",.84,34242,2,1,0)
Answer 'Me' if the message should be from you.
"KRN",.84,34242,2,2,0)
If you send this to yourself, it will not be delivered new to you,
"KRN",.84,34242,2,3,0)
but you will be able to edit it, if you don't send it to anyone else.
"KRN",.84,34242,2,4,0)

"KRN",.84,34242,2,5,0)
Answer 'Postmaster' if the message should be from the Postmaster.
"KRN",.84,34242,2,6,0)
If you send this to yourself, it will be delivered new to you,
"KRN",.84,34242,2,7,0)
but you will not be able to edit it.
"KRN",.84,34242,5,0)
^.841^1^1
"KRN",.84,34242,5,1,0)
XMAPHOST
"KRN",.84,34242,5,"B","XMAPHOST",1)

"KRN",.84,34250,-1)
0^310
"KRN",.84,34250,0)
34250^2^^MAILMAN^answering
"KRN",.84,34250,2,0)
^^1^1^3000107^
"KRN",.84,34250,2,1,0)
answering
"KRN",.84,34250,5,0)
^.841^1^1
"KRN",.84,34250,5,1,0)
XMJMA
"KRN",.84,34250,5,"B","XMJMA",1)

"KRN",.84,34251,-1)
0^311
"KRN",.84,34251,0)
34251^1^^MAILMAN^This message has too many lines to 'Answer
"KRN",.84,34251,2,0)
^^2^2^3000107^
"KRN",.84,34251,2,1,0)
This message has too many lines to 'Answer'.
"KRN",.84,34251,2,2,0)
Use 'Write' or 'Reply', instead.
"KRN",.84,34251,5,0)
^.841^1^1
"KRN",.84,34251,5,1,0)
XMJMA
"KRN",.84,34251,5,"B","XMJMA",1)

"KRN",.84,34252,-1)
0^312
"KRN",.84,34252,0)
34252^2^^MAILMAN^Copying original message and network signa
"KRN",.84,34252,2,0)
^^1^1^3000110^^
"KRN",.84,34252,2,1,0)
Copying original message and network signature ...
"KRN",.84,34252,5,0)
^.841^1^1
"KRN",.84,34252,5,1,0)
XMJMA
"KRN",.84,34252,5,"B","XMJMA",1)

"KRN",.84,34253,-1)
0^313
"KRN",.84,34253,0)
34253^2^y^MAILMAN^Addressing answer to: |1|
"KRN",.84,34253,2,0)
^^1^1^3000107^
"KRN",.84,34253,2,1,0)
Addressing answer to: |1|
"KRN",.84,34253,3,0)
^.845^1^1
"KRN",.84,34253,3,1,0)
1^to whom
"KRN",.84,34253,5,0)
^.841^1^1
"KRN",.84,34253,5,1,0)
XMJMA
"KRN",.84,34253,5,"B","XMJMA",1)

"KRN",.84,34254,-1)
0^314
"KRN",.84,34254,0)
34254^2^^MAILMAN^Addressing answer to sender:
"KRN",.84,34254,2,0)
^^1^1^3000107^^
"KRN",.84,34254,2,1,0)
Addressing answer to sender:
"KRN",.84,34254,5,0)
^.841^1^1
"KRN",.84,34254,5,1,0)
XMJMA
"KRN",.84,34254,5,"B","XMJMA",1)

"KRN",.84,34255,-1)
0^315
"KRN",.84,34255,0)
34255^1^y^MAILMAN^Failed in addressing answer to: |1|
"KRN",.84,34255,2,0)
^^1^1^3000107^
"KRN",.84,34255,2,1,0)
Failed in addressing answer to: |1|
"KRN",.84,34255,3,0)
^.845^1^1
"KRN",.84,34255,3,1,0)
1^bad address
"KRN",.84,34255,5,0)
^.841^1^1
"KRN",.84,34255,5,1,0)
XMJMA
"KRN",.84,34255,5,"B","XMJMA",1)

"KRN",.84,34260,-1)
0^316
"KRN",.84,34260,0)
34260^2^^MAILMAN^sending
"KRN",.84,34260,2,0)
^^1^1^3000225^
"KRN",.84,34260,2,1,0)
sending
"KRN",.84,34260,5,0)
^.841^1^1
"KRN",.84,34260,5,1,0)
XMJMS
"KRN",.84,34260,5,"B","XMJMS",1)

"KRN",.84,34261,-1)
0^317
"KRN",.84,34261,0)
34261^3^^MAILMAN^This is the subject of the message,
"KRN",.84,34261,2,0)
^^3^3^3000225^
"KRN",.84,34261,2,1,0)
This is the subject of the message, shown whenever the message is displayed.
"KRN",.84,34261,2,2,0)
Leading and trailing blanks are deleted.
"KRN",.84,34261,2,3,0)
Any sequence of 3 or more blanks is reduced to 2 blanks.
"KRN",.84,34261,5,0)
^.841^1^1
"KRN",.84,34261,5,1,0)
XMJMS
"KRN",.84,34261,5,"B","XMJMS",1)

"KRN",.84,34262,-1)
0^318
"KRN",.84,34262,0)
34262^3^^MAILMAN^If you want to send a message with no subj
"KRN",.84,34262,2,0)
^^1^1^3000225^
"KRN",.84,34262,2,1,0)
If you want to send a message with no subject, just press ENTER.
"KRN",.84,34262,5,0)
^.841^1^1
"KRN",.84,34262,5,1,0)
XMJMS
"KRN",.84,34262,5,"B","XMJMS",1)

"KRN",.84,34263,-1)
0^319
"KRN",.84,34263,0)
34263^2^^MAILMAN^You may enter the text of the message...
"KRN",.84,34263,2,0)
^^1^1^3000225^
"KRN",.84,34263,2,1,0)
You may enter the text of the message...
"KRN",.84,34263,5,0)
^.841^1^1
"KRN",.84,34263,5,1,0)
XMJMS
"KRN",.84,34263,5,"B","XMJMS",1)

"KRN",.84,34263.1,-1)
0^320
"KRN",.84,34263.1,0)
34263.1^2^^MAILMAN^You may edit the text of the message...
"KRN",.84,34263.1,2,0)
^^1^1^3000225^
"KRN",.84,34263.1,2,1,0)
You may edit the text of the message...
"KRN",.84,34263.1,5,0)
^.841^1^1
"KRN",.84,34263.1,5,1,0)
XMJMS
"KRN",.84,34263.1,5,"B","XMJMS",1)

"KRN",.84,34264,-1)
0^321
"KRN",.84,34264,0)
34264^1^y^MAILMAN^You have timed out while |1| a message.
"KRN",.84,34264,2,0)
^^3^3^3000225^
"KRN",.84,34264,2,1,0)
You have timed out while |1| a message.
"KRN",.84,34264,2,2,0)
You can resume when you log back on and re-enter MailMan.
"KRN",.84,34264,2,3,0)
Do it today, or your text may be purged this evening.
"KRN",.84,34264,3,0)
^.845^1^1
"KRN",.84,34264,3,1,0)
1^sending or replying to
"KRN",.84,34264,5,0)
^.841^1^1
"KRN",.84,34264,5,1,0)
XMJMS
"KRN",.84,34264,5,"B","XMJMS",1)

"KRN",.84,34265,-1)
0^322
"KRN",.84,34265,0)
34265^2^^MAILMAN^You have an unsent message in your buffer.
"KRN",.84,34265,2,0)
^.844^1^1^3010823^^^
"KRN",.84,34265,2,1,0)
You have an unsent message in your buffer.
"KRN",.84,34265,3,0)
^.845^^0
"KRN",.84,34265,5,0)
^.841^1^1
"KRN",.84,34265,5,1,0)
XMJMS
"KRN",.84,34265,5,"B","XMJMS",1)

"KRN",.84,34265.1,-1)
0^323
"KRN",.84,34265.1,0)
34265.1^2^y^MAILMAN^|1| has an unsent message in the buffer.
"KRN",.84,34265.1,2,0)
^^1^1^3010823^
"KRN",.84,34265.1,2,1,0)
|1| has an unsent message in the buffer.
"KRN",.84,34265.1,3,0)
^.845^1^1
"KRN",.84,34265.1,3,1,0)
1^user's name
"KRN",.84,34265.1,5,0)
^.841^1^1
"KRN",.84,34265.1,5,1,0)
XMJMS
"KRN",.84,34265.1,5,"B","XMJMS",1)

"KRN",.84,34266,-1)
0^324
"KRN",.84,34266,0)
34266^2^^MAILMAN^Some of the text may have been lost.
"KRN",.84,34266,2,0)
^.844^2^2^3010824^^^
"KRN",.84,34266,2,1,0)
Some of the text may have been lost.
"KRN",.84,34266,2,2,0)
You must re-enter recipients and any special handling instructions.
"KRN",.84,34266,3,0)
^.845^^0
"KRN",.84,34266,5,0)
^.841^1^1
"KRN",.84,34266,5,1,0)
XMJMS
"KRN",.84,34266,5,"B","XMJMS",1)

"KRN",.84,34267,-1)
0^325
"KRN",.84,34267,0)
34267^2^^MAILMAN^Since you don't have 'send' privilege,
"KRN",.84,34267,2,0)
^^4^4^3010823^
"KRN",.84,34267,2,1,0)
Since you don't have 'send' privilege, you may not complete this
"KRN",.84,34267,2,2,0)
message.  If we delete this message, you'll be able to read and
"KRN",.84,34267,2,3,0)
reply to messages in this mailbox.  If we leave it alone, you'll
"KRN",.84,34267,2,4,0)
be able to read messages, but you won't be able to reply to them.
"KRN",.84,34267,5,0)
^.841^1^1
"KRN",.84,34267,5,1,0)
XMJMS
"KRN",.84,34267,5,"B","XMJMS",1)

"KRN",.84,34267.1,-1)
0^326
"KRN",.84,34267.1,0)
34267.1^2^^MAILMAN^Shall we delete this unsent message
"KRN",.84,34267.1,2,0)
^^1^1^3010823^
"KRN",.84,34267.1,2,1,0)
Shall we delete this unsent message
"KRN",.84,34267.2,-1)
0^327
"KRN",.84,34267.2,0)
34267.2^2^^MAILMAN^OK, you'll be able to read messages, but
"KRN",.84,34267.2,2,0)
^^1^1^3010824^
"KRN",.84,34267.2,2,1,0)
OK, you'll be able to read messages, but you won't be able to reply to them.
"KRN",.84,34267.2,5,0)
^.841^1^1
"KRN",.84,34267.2,5,1,0)
XMJMS
"KRN",.84,34267.2,5,"B","XMJMS",1)

"KRN",.84,34270,-1)
0^328
"KRN",.84,34270,0)
34270^2^^MAILMAN^Include responses from which message
"KRN",.84,34270,2,0)
^^1^1^3000511^
"KRN",.84,34270,2,1,0)
Include responses from which message
"KRN",.84,34270,5,0)
^.841^1^1
"KRN",.84,34270,5,1,0)
XMJMR
"KRN",.84,34270,5,"B","XMJMR",1)

"KRN",.84,34271,-1)
0^329
"KRN",.84,34271,0)
34271^2^^MAILMAN^This message
"KRN",.84,34271,2,0)
^^1^1^3000511^
"KRN",.84,34271,2,1,0)
This message
"KRN",.84,34271,5,0)
^.841^1^1
"KRN",.84,34271,5,1,0)
XMJMR
"KRN",.84,34271,5,"B","XMJMR",1)

"KRN",.84,34272,-1)
0^330
"KRN",.84,34272,0)
34272^3^y^MAILMAN^Press Enter to include previous responses
"KRN",.84,34272,2,0)
^^3^3^3000511^
"KRN",.84,34272,2,1,0)
Press Enter to include previous responses from this message,
"KRN",.84,34272,2,2,0)
or enter the internal entry number of a different message
"KRN",.84,34272,2,3,0)
(|1|-|2|) to include any of its responses.
"KRN",.84,34272,3,0)
^.845^2^2
"KRN",.84,34272,3,1,0)
1^lowest message IEN
"KRN",.84,34272,3,2,0)
2^highest message IEN
"KRN",.84,34272,5,0)
^.841^1^1
"KRN",.84,34272,5,1,0)
XMJMR
"KRN",.84,34272,5,"B","XMJMR",1)

"KRN",.84,34273,-1)
0^331
"KRN",.84,34273,0)
34273^3^y^MAILMAN^Enter the internal entry number of a diff
"KRN",.84,34273,2,0)
^^2^2^3000511^
"KRN",.84,34273,2,1,0)
Enter the internal entry number of a different message
"KRN",.84,34273,2,2,0)
(|1|-|2|) to include any of its responses.
"KRN",.84,34273,3,0)
^.845^2^2
"KRN",.84,34273,3,1,0)
1^lowest message IEN
"KRN",.84,34273,3,2,0)
2^highest message IEN
"KRN",.84,34273,5,0)
^.841^1^1
"KRN",.84,34273,5,1,0)
XMJMR
"KRN",.84,34273,5,"B","XMJMR",1)

"KRN",.84,34274,-1)
0^332
"KRN",.84,34274,0)
34274^1^^MAILMAN^You can't include the message you're edit
"KRN",.84,34274,2,0)
^^1^1^3000511^
"KRN",.84,34274,2,1,0)
You can't include the message you're editing.
"KRN",.84,34274,5,0)
^.841^1^1
"KRN",.84,34274,5,1,0)
XMJMR
"KRN",.84,34274,5,"B","XMJMR",1)

"KRN",.84,34301,-1)
0^333
"KRN",.84,34301,0)
34301^2^^MAILMAN^Delete which messages
"KRN",.84,34301,2,0)
^^1^1^2991214^
"KRN",.84,34301,2,1,0)
Delete which messages
"KRN",.84,34301,5,0)
^.841^2^2
"KRN",.84,34301,5,1,0)
XMJMOR
"KRN",.84,34301,5,2,0)
XMJMORX
"KRN",.84,34301,5,"B","XMJMOR",1)

"KRN",.84,34301,5,"B","XMJMORX",2)

"KRN",.84,34302,-1)
0^334
"KRN",.84,34302,0)
34302^2^y^MAILMAN^|1| messages deleted.
"KRN",.84,34302,2,0)
^^1^1^2991214^
"KRN",.84,34302,2,1,0)
|1| messages deleted.
"KRN",.84,34302,3,0)
^.845^1^1
"KRN",.84,34302,3,1,0)
1^number of messages
"KRN",.84,34302,5,0)
^.841^3^3
"KRN",.84,34302,5,1,0)
XMJMOR
"KRN",.84,34302,5,2,0)
XMJMORX
"KRN",.84,34302,5,3,0)
XMXMSGS
"KRN",.84,34302,5,"B","XMJMOR",1)

"KRN",.84,34302,5,"B","XMJMORX",2)

"KRN",.84,34302,5,"B","XMXMSGS",3)

"KRN",.84,34302.1,-1)
0^335
"KRN",.84,34302.1,0)
34302.1^2^^MAILMAN^1 message deleted.
"KRN",.84,34302.1,2,0)
^^1^1^2991214^
"KRN",.84,34302.1,2,1,0)
1 message deleted.
"KRN",.84,34302.1,5,0)
^.841^3^3
"KRN",.84,34302.1,5,1,0)
XMJMOR
"KRN",.84,34302.1,5,2,0)
XMJMORX
"KRN",.84,34302.1,5,3,0)
XMXMSGS
"KRN",.84,34302.1,5,"B","XMJMOR",1)

"KRN",.84,34302.1,5,"B","XMJMORX",2)

"KRN",.84,34302.1,5,"B","XMXMSGS",3)

"KRN",.84,34302.2,-1)
0^336
"KRN",.84,34302.2,0)
34302.2^2^^MAILMAN^Message deleted.
"KRN",.84,34302.2,2,0)
^^1^1^2991214^
"KRN",.84,34302.2,2,1,0)
Message deleted.
"KRN",.84,34302.2,5,0)
^.841^1^1
"KRN",.84,34302.2,5,1,0)
XMJMOI
"KRN",.84,34302.2,5,"B","XMJMOI",1)

"KRN",.84,34303,-1)
0^337
"KRN",.84,34303,0)
34303^2^^MAILMAN^Are you sure you want to delete the sel
"KRN",.84,34303,2,0)
^^1^1^2991214^
"KRN",.84,34303,2,1,0)
Are you sure you want to delete the selected messages
"KRN",.84,34303,5,0)
^.841^2^2
"KRN",.84,34303,5,1,0)
XMJMOR
"KRN",.84,34303,5,2,0)
XMJMORX
"KRN",.84,34303,5,"B","XMJMOR",1)

"KRN",.84,34303,5,"B","XMJMORX",2)

"KRN",.84,34303.1,-1)
0^338
"KRN",.84,34303.1,0)
34303.1^2^^MAILMAN^Do you really want to delete these mess
"KRN",.84,34303.1,2,0)
^^1^1^2991214^
"KRN",.84,34303.1,2,1,0)
Do you really want to delete these messages
"KRN",.84,34303.1,5,0)
^.841^2^2
"KRN",.84,34303.1,5,1,0)
XMJMOR
"KRN",.84,34303.1,5,2,0)
XMJMORX
"KRN",.84,34303.1,5,"B","XMJMOR",1)

"KRN",.84,34303.1,5,"B","XMJMORX",2)

"KRN",.84,34305,-1)
0^339
"KRN",.84,34305,0)
34305^2^^MAILMAN^Filter which messages
"KRN",.84,34305,2,0)
^^1^1^2991214^
"KRN",.84,34305,2,1,0)
Filter which messages
"KRN",.84,34305,5,0)
^.841^2^2
"KRN",.84,34305,5,1,0)
XMJMOR
"KRN",.84,34305,5,2,0)
XMJMORX
"KRN",.84,34305,5,"B","XMJMOR",1)

"KRN",.84,34305,5,"B","XMJMORX",2)

"KRN",.84,34306,-1)
0^340
"KRN",.84,34306,0)
34306^2^y^MAILMAN^|1| messages filtered.
"KRN",.84,34306,2,0)
^^1^1^2991214^
"KRN",.84,34306,2,1,0)
|1| messages filtered.
"KRN",.84,34306,3,0)
^.845^1^1
"KRN",.84,34306,3,1,0)
1^number of messages
"KRN",.84,34306,5,0)
^.841^3^3
"KRN",.84,34306,5,1,0)
XMJMOR
"KRN",.84,34306,5,2,0)
XMJMORX
"KRN",.84,34306,5,3,0)
XMXMSGS
"KRN",.84,34306,5,"B","XMJMOR",1)

"KRN",.84,34306,5,"B","XMJMORX",2)

"KRN",.84,34306,5,"B","XMXMSGS",3)

"KRN",.84,34306.1,-1)
0^341
"KRN",.84,34306.1,0)
34306.1^2^^MAILMAN^1 message filtered.
"KRN",.84,34306.1,2,0)
^^1^1^2991214^
"KRN",.84,34306.1,2,1,0)
1 message filtered.
"KRN",.84,34306.1,5,0)
^.841^3^3
"KRN",.84,34306.1,5,1,0)
XMJMOR
"KRN",.84,34306.1,5,2,0)
XMJMORX
"KRN",.84,34306.1,5,3,0)
XMXMSGS
"KRN",.84,34306.1,5,"B","XMJMOR",1)

"KRN",.84,34306.1,5,"B","XMJMORX",2)

"KRN",.84,34306.1,5,"B","XMXMSGS",3)

"KRN",.84,34306.2,-1)
0^342
"KRN",.84,34306.2,0)
34306.2^2^^MAILMAN^Basket filtered.
"KRN",.84,34306.2,2,0)
^^1^1^3000203^
"KRN",.84,34306.2,2,1,0)
Basket filtered.
"KRN",.84,34306.2,5,0)
^.841^1^1
"KRN",.84,34306.2,5,1,0)
XMXBSKT
"KRN",.84,34306.2,5,"B","XMXBSKT",1)

"KRN",.84,34306.3,-1)
0^343
"KRN",.84,34306.3,0)
34306.3^2^^MAILMAN^Mailbox filtered.
"KRN",.84,34306.3,2,0)
^^1^1^3000808^
"KRN",.84,34306.3,2,1,0)
Mailbox filtered.
"KRN",.84,34306.3,5,0)
^.841^1^1
"KRN",.84,34306.3,5,1,0)
XMXMBOX
"KRN",.84,34306.3,5,"B","XMXMBOX",1)

"KRN",.84,34308,-1)
0^344
"KRN",.84,34308,0)
34308^2^^MAILMAN^Forward which messages
"KRN",.84,34308,2,0)
^^1^1^2991214^
"KRN",.84,34308,2,1,0)
Forward which messages
"KRN",.84,34308,5,0)
^.841^2^2
"KRN",.84,34308,5,1,0)
XMJMOR
"KRN",.84,34308,5,2,0)
XMJMORX
"KRN",.84,34308,5,"B","XMJMOR",1)

"KRN",.84,34308,5,"B","XMJMORX",2)

"KRN",.84,34309,-1)
0^345
"KRN",.84,34309,0)
34309^2^y^MAILMAN^|1| messages forwarded.
"KRN",.84,34309,2,0)
^^1^1^2991214^
"KRN",.84,34309,2,1,0)
|1| messages forwarded.
"KRN",.84,34309,3,0)
^.845^1^1
"KRN",.84,34309,3,1,0)
1^number of messages
"KRN",.84,34309,5,0)
^.841^3^3
"KRN",.84,34309,5,1,0)
XMJMOR
"KRN",.84,34309,5,2,0)
XMJMORX
"KRN",.84,34309,5,3,0)
XMXMSGS
"KRN",.84,34309,5,"B","XMJMOR",1)

"KRN",.84,34309,5,"B","XMJMORX",2)

"KRN",.84,34309,5,"B","XMXMSGS",3)

"KRN",.84,34309.1,-1)
0^346
"KRN",.84,34309.1,0)
34309.1^2^^MAILMAN^1 message forwarded.
"KRN",.84,34309.1,2,0)
^^1^1^2991214^
"KRN",.84,34309.1,2,1,0)
1 message forwarded.
"KRN",.84,34309.1,5,0)
^.841^3^3
"KRN",.84,34309.1,5,1,0)
XMJMOR
"KRN",.84,34309.1,5,2,0)
XMJMORX
"KRN",.84,34309.1,5,3,0)
XMXMSGS
"KRN",.84,34309.1,5,"B","XMJMOR",1)

"KRN",.84,34309.1,5,"B","XMJMORX",2)

"KRN",.84,34309.1,5,"B","XMXMSGS",3)

"KRN",.84,34309.2,-1)
0^347
"KRN",.84,34309.2,0)
34309.2^2^^MAILMAN^Message forwarded.
"KRN",.84,34309.2,2,0)
^^1^1^2991214^
"KRN",.84,34309.2,2,1,0)
Message forwarded.
"KRN",.84,34309.2,5,0)
^.841^2^2
"KRN",.84,34309.2,5,1,0)
XMJMOI
"KRN",.84,34309.2,5,2,0)
XMJMOR
"KRN",.84,34309.2,5,"B","XMJMOI",1)

"KRN",.84,34309.2,5,"B","XMJMOR",2)

"KRN",.84,34309.3,-1)
0^348
"KRN",.84,34309.3,0)
34309.3^2^^MAILMAN^No messages forwarded.
"KRN",.84,34309.3,2,0)
^^1^1^2991214^^
"KRN",.84,34309.3,2,1,0)
No messages forwarded.
"KRN",.84,34309.3,5,0)
^.841^2^2
"KRN",.84,34309.3,5,1,0)
XMJMOR
"KRN",.84,34309.3,5,2,0)
XMJMORX
"KRN",.84,34309.3,5,"B","XMJMOR",1)

"KRN",.84,34309.3,5,"B","XMJMORX",2)

"KRN",.84,34311,-1)
0^349
"KRN",.84,34311,0)
34311^2^^MAILMAN^Later which messages
"KRN",.84,34311,2,0)
^^1^1^2991214^
"KRN",.84,34311,2,1,0)
Later which messages
"KRN",.84,34311,5,0)
^.841^2^2
"KRN",.84,34311,5,1,0)
XMJMOR
"KRN",.84,34311,5,2,0)
XMJMORX
"KRN",.84,34311,5,"B","XMJMOR",1)

"KRN",.84,34311,5,"B","XMJMORX",2)

"KRN",.84,34312,-1)
0^350
"KRN",.84,34312,0)
34312^2^y^MAILMAN^|1| messages latered.
"KRN",.84,34312,2,0)
^^1^1^2991214^
"KRN",.84,34312,2,1,0)
|1| messages latered.
"KRN",.84,34312,3,0)
^.845^1^1
"KRN",.84,34312,3,1,0)
1^number of messages
"KRN",.84,34312,5,0)
^.841^3^3
"KRN",.84,34312,5,1,0)
XMJMOR
"KRN",.84,34312,5,2,0)
XMJMORX
"KRN",.84,34312,5,3,0)
XMXMSGS
"KRN",.84,34312,5,"B","XMJMOR",1)

"KRN",.84,34312,5,"B","XMJMORX",2)

"KRN",.84,34312,5,"B","XMXMSGS",3)

"KRN",.84,34312.1,-1)
0^351
"KRN",.84,34312.1,0)
34312.1^2^^MAILMAN^1 message latered.
"KRN",.84,34312.1,2,0)
^^1^1^2991214^
"KRN",.84,34312.1,2,1,0)
1 message latered.
"KRN",.84,34312.1,5,0)
^.841^3^3
"KRN",.84,34312.1,5,1,0)
XMJMOR
"KRN",.84,34312.1,5,2,0)
XMJMORX
"KRN",.84,34312.1,5,3,0)
XMXMSGS
"KRN",.84,34312.1,5,"B","XMJMOR",1)

"KRN",.84,34312.1,5,"B","XMJMORX",2)

"KRN",.84,34312.1,5,"B","XMXMSGS",3)

"KRN",.84,34314,-1)
0^352
"KRN",.84,34314,0)
34314^2^^MAILMAN^New Toggle which messages
"KRN",.84,34314,2,0)
^^1^1^2991214^
"KRN",.84,34314,2,1,0)
New Toggle which messages
"KRN",.84,34314,5,0)
^.841^2^2
"KRN",.84,34314,5,1,0)
XMJMOR
"KRN",.84,34314,5,2,0)
XMJMORX
"KRN",.84,34314,5,"B","XMJMOR",1)

"KRN",.84,34314,5,"B","XMJMORX",2)

"KRN",.84,34315,-1)
0^353
"KRN",.84,34315,0)
34315^2^y^MAILMAN^|1| messages new toggled.
"KRN",.84,34315,2,0)
^^1^1^2991214^^
"KRN",.84,34315,2,1,0)
|1| messages new toggled.
"KRN",.84,34315,3,0)
^.845^1^1
"KRN",.84,34315,3,1,0)
1^number of messages
"KRN",.84,34315,5,0)
^.841^3^3
"KRN",.84,34315,5,1,0)
XMJMOR
"KRN",.84,34315,5,2,0)
XMJMORX
"KRN",.84,34315,5,3,0)
XMXMSGS
"KRN",.84,34315,5,"B","XMJMOR",1)

"KRN",.84,34315,5,"B","XMJMORX",2)

"KRN",.84,34315,5,"B","XMXMSGS",3)

"KRN",.84,34315.1,-1)
0^354
"KRN",.84,34315.1,0)
34315.1^2^^MAILMAN^1 message new toggled.
"KRN",.84,34315.1,2,0)
^^1^1^2991214^
"KRN",.84,34315.1,2,1,0)
1 message new toggled.
"KRN",.84,34315.1,5,0)
^.841^3^3
"KRN",.84,34315.1,5,1,0)
XMJMOR
"KRN",.84,34315.1,5,2,0)
XMJMORX
"KRN",.84,34315.1,5,3,0)
XMXMSGS
"KRN",.84,34315.1,5,"B","XMJMOR",1)

"KRN",.84,34315.1,5,"B","XMJMORX",2)

"KRN",.84,34315.1,5,"B","XMXMSGS",3)

"KRN",.84,34317,-1)
0^355
"KRN",.84,34317,0)
34317^2^^MAILMAN^Print which messages
"KRN",.84,34317,2,0)
^^1^1^2991214^
"KRN",.84,34317,2,1,0)
Print which messages
"KRN",.84,34317,5,0)
^.841^2^2
"KRN",.84,34317,5,1,0)
XMJMOR
"KRN",.84,34317,5,2,0)
XMJMORX
"KRN",.84,34317,5,"B","XMJMOR",1)

"KRN",.84,34317,5,"B","XMJMORX",2)

"KRN",.84,34317.1,-1)
0^356
"KRN",.84,34317.1,0)
34317.1^2^^MAILMAN^Print which messages without headers
"KRN",.84,34317.1,2,0)
^^1^1^2991214^
"KRN",.84,34317.1,2,1,0)
Print which messages without headers
"KRN",.84,34317.1,5,0)
^.841^2^2
"KRN",.84,34317.1,5,1,0)
XMJMOR
"KRN",.84,34317.1,5,2,0)
XMJMORX
"KRN",.84,34317.1,5,"B","XMJMOR",1)

"KRN",.84,34317.1,5,"B","XMJMORX",2)

"KRN",.84,34318,-1)
0^357
"KRN",.84,34318,0)
34318^2^y^MAILMAN^|1| messages printed.
"KRN",.84,34318,2,0)
^^1^1^2991214^
"KRN",.84,34318,2,1,0)
|1| messages printed.
"KRN",.84,34318,3,0)
^.845^1^1
"KRN",.84,34318,3,1,0)
1^number of messages
"KRN",.84,34318,5,0)
^.841^3^3
"KRN",.84,34318,5,1,0)
XMJMOR
"KRN",.84,34318,5,2,0)
XMJMORX
"KRN",.84,34318,5,3,0)
XMXMSGS
"KRN",.84,34318,5,"B","XMJMOR",1)

"KRN",.84,34318,5,"B","XMJMORX",2)

"KRN",.84,34318,5,"B","XMXMSGS",3)

"KRN",.84,34318.1,-1)
0^358
"KRN",.84,34318.1,0)
34318.1^2^^MAILMAN^1 message printed.
"KRN",.84,34318.1,2,0)
^^1^1^2991214^^
"KRN",.84,34318.1,2,1,0)
1 message printed.
"KRN",.84,34318.1,5,0)
^.841^3^3
"KRN",.84,34318.1,5,1,0)
XMJMOR
"KRN",.84,34318.1,5,2,0)
XMJMORX
"KRN",.84,34318.1,5,3,0)
XMXMSGS
"KRN",.84,34318.1,5,"B","XMJMOR",1)

"KRN",.84,34318.1,5,"B","XMJMORX",2)

"KRN",.84,34318.1,5,"B","XMXMSGS",3)

"KRN",.84,34318.2,-1)
0^359
"KRN",.84,34318.2,0)
34318.2^2^^MAILMAN^Message printed.
"KRN",.84,34318.2,2,0)
^^1^1^2991214^
"KRN",.84,34318.2,2,1,0)
Message printed.
"KRN",.84,34318.2,5,0)
^.841^1^1
"KRN",.84,34318.2,5,1,0)
XMJMOR
"KRN",.84,34318.2,5,"B","XMJMOR",1)

"KRN",.84,34318.3,-1)
0^360
"KRN",.84,34318.3,0)
34318.3^2^^MAILMAN^No messages printed.
"KRN",.84,34318.3,2,0)
^^1^1^2991214^
"KRN",.84,34318.3,2,1,0)
No messages printed.
"KRN",.84,34318.3,5,0)
^.841^1^1
"KRN",.84,34318.3,5,1,0)
XMJMOR
"KRN",.84,34318.3,5,"B","XMJMOR",1)

"KRN",.84,34318.4,-1)
0^361
"KRN",.84,34318.4,0)
34318.4^2^^MAILMAN^Message not printed.
"KRN",.84,34318.4,2,0)
^^1^1^2991214^
"KRN",.84,34318.4,2,1,0)
Message not printed.
"KRN",.84,34318.4,5,0)
^.841^1^1
"KRN",.84,34318.4,5,1,0)
XMJMOR
"KRN",.84,34318.4,5,"B","XMJMOR",1)

"KRN",.84,34319,-1)
0^362
"KRN",.84,34319,0)
34319^2^^MAILMAN^No valid messages selected.
"KRN",.84,34319,2,0)
^^1^1^2991214^
"KRN",.84,34319,2,1,0)
No valid messages selected.
"KRN",.84,34319,5,0)
^.841^1^1
"KRN",.84,34319,5,1,0)
XMJMORX
"KRN",.84,34319,5,"B","XMJMORX",1)

"KRN",.84,34320,-1)
0^363
"KRN",.84,34320,0)
34320^2^y^MAILMAN^|1| messages sent to printer.
"KRN",.84,34320,2,0)
^^1^1^2991214^^
"KRN",.84,34320,2,1,0)
|1| messages sent to printer.
"KRN",.84,34320,3,0)
^.845^1^1
"KRN",.84,34320,3,1,0)
1^number of messages
"KRN",.84,34320,5,0)
^.841^1^1
"KRN",.84,34320,5,1,0)
XMXMSGS
"KRN",.84,34320,5,"B","XMXMSGS",1)

"KRN",.84,34320.1,-1)
0^364
"KRN",.84,34320.1,0)
34320.1^2^^MAILMAN^1 message sent to printer.
"KRN",.84,34320.1,2,0)
^^1^1^2991214^
"KRN",.84,34320.1,2,1,0)
1 message sent to printer.
"KRN",.84,34320.1,5,0)
^.841^1^1
"KRN",.84,34320.1,5,1,0)
XMXMSGS
"KRN",.84,34320.1,5,"B","XMXMSGS",1)

"KRN",.84,34321,-1)
0^365
"KRN",.84,34321,0)
34321^1^^MAILMAN^No messages sent to printer.  TaskMan prob
"KRN",.84,34321,2,0)
^^1^1^2991214^
"KRN",.84,34321,2,1,0)
No messages sent to printer.  TaskMan problem.
"KRN",.84,34321,5,0)
^.841^1^1
"KRN",.84,34321,5,1,0)
XMXMSGS
"KRN",.84,34321,5,"B","XMXMSGS",1)

"KRN",.84,34323,-1)
0^366
"KRN",.84,34323,0)
34323^2^^MAILMAN^Save which messages
"KRN",.84,34323,2,0)
^^1^1^2991214^
"KRN",.84,34323,2,1,0)
Save which messages
"KRN",.84,34323,5,0)
^.841^2^2
"KRN",.84,34323,5,1,0)
XMJMOR
"KRN",.84,34323,5,2,0)
XMJMORX
"KRN",.84,34323,5,"B","XMJMOR",1)

"KRN",.84,34323,5,"B","XMJMORX",2)

"KRN",.84,34324,-1)
0^367
"KRN",.84,34324,0)
34324^2^y^MAILMAN^|1| messages saved.
"KRN",.84,34324,2,0)
^^1^1^2991214^
"KRN",.84,34324,2,1,0)
|1| messages saved.
"KRN",.84,34324,3,0)
^.845^1^1
"KRN",.84,34324,3,1,0)
1^number of messages
"KRN",.84,34324,5,0)
^.841^3^3
"KRN",.84,34324,5,1,0)
XMJMOR
"KRN",.84,34324,5,2,0)
XMJMORX
"KRN",.84,34324,5,3,0)
XMXMSGS
"KRN",.84,34324,5,"B","XMJMOR",1)

"KRN",.84,34324,5,"B","XMJMORX",2)

"KRN",.84,34324,5,"B","XMXMSGS",3)

"KRN",.84,34324.1,-1)
0^368
"KRN",.84,34324.1,0)
34324.1^2^^MAILMAN^1 message saved.
"KRN",.84,34324.1,2,0)
^^1^1^2991214^
"KRN",.84,34324.1,2,1,0)
1 message saved.
"KRN",.84,34324.1,5,0)
^.841^3^3
"KRN",.84,34324.1,5,1,0)
XMJMOR
"KRN",.84,34324.1,5,2,0)
XMJMORX
"KRN",.84,34324.1,5,3,0)
XMXMSGS
"KRN",.84,34324.1,5,"B","XMJMOR",1)

"KRN",.84,34324.1,5,"B","XMJMORX",2)

"KRN",.84,34324.1,5,"B","XMXMSGS",3)

"KRN",.84,34324.2,-1)
0^369
"KRN",.84,34324.2,0)
34324.2^2^^MAILMAN^Message saved.
"KRN",.84,34324.2,2,0)
^^1^1^2991214^
"KRN",.84,34324.2,2,1,0)
Message saved.
"KRN",.84,34324.2,5,0)
^.841^1^1
"KRN",.84,34324.2,5,1,0)
XMJMOI
"KRN",.84,34324.2,5,"B","XMJMOI",1)

"KRN",.84,34324.3,-1)
0^370
"KRN",.84,34324.3,0)
34324.3^2^^MAILMAN^No messages saved.
"KRN",.84,34324.3,2,0)
^^1^1^2991214^
"KRN",.84,34324.3,2,1,0)
No messages saved.
"KRN",.84,34324.3,5,0)
^.841^1^1
"KRN",.84,34324.3,5,1,0)
XMJMOR
"KRN",.84,34324.3,5,"B","XMJMOR",1)

"KRN",.84,34325,-1)
0^371
"KRN",.84,34325,0)
34325^2^^MAILMAN^Save messages to which basket? 
"KRN",.84,34325,1,0)
^^1^1^2991214^
"KRN",.84,34325,1,1,0)
Note:  there must be one blank character at the end of this dialog.
"KRN",.84,34325,2,0)
^^1^1^2991214^
"KRN",.84,34325,2,1,0)
Save messages to which basket? 
"KRN",.84,34325,5,0)
^.841^2^2
"KRN",.84,34325,5,1,0)
XMJMOR
"KRN",.84,34325,5,2,0)
XMJMORX
"KRN",.84,34325,5,"B","XMJMOR",1)

"KRN",.84,34325,5,"B","XMJMORX",2)

"KRN",.84,34325.1,-1)
0^372
"KRN",.84,34325.1,0)
34325.1^2^^MAILMAN^Save message into basket: 
"KRN",.84,34325.1,1,0)
^.842^1^1^3000525^^
"KRN",.84,34325.1,1,1,0)
Note: this dialog has one blank character at the end.
"KRN",.84,34325.1,2,0)
^.844^1^1^3000525^^
"KRN",.84,34325.1,2,1,0)
Save message into basket: 
"KRN",.84,34325.1,5,0)
^.841^1^1
"KRN",.84,34325.1,5,1,0)
XMJMOI
"KRN",.84,34325.1,5,"B","XMJMOI",1)

"KRN",.84,34325.9,-1)
0^373
"KRN",.84,34325.9,0)
34325.9^2^y^MAILMAN^Message saved to |1| basket.
"KRN",.84,34325.9,2,0)
^^1^1^2991216^^
"KRN",.84,34325.9,2,1,0)
Message saved to |1| basket.
"KRN",.84,34325.9,3,0)
^.845^1^1
"KRN",.84,34325.9,3,1,0)
1^basket name
"KRN",.84,34325.9,5,0)
^.841^1^1
"KRN",.84,34325.9,5,1,0)
XMJMOI
"KRN",.84,34325.9,5,"B","XMJMOI",1)

"KRN",.84,34326,-1)
0^374
"KRN",.84,34326,0)
34326^1^^MAILMAN^Same basket.  No messages saved.
"KRN",.84,34326,2,0)
^^1^1^2991214^
"KRN",.84,34326,2,1,0)
Same basket.  No messages saved.
"KRN",.84,34326,5,0)
^.841^2^2
"KRN",.84,34326,5,1,0)
XMJMOR
"KRN",.84,34326,5,2,0)
XMJMORX
"KRN",.84,34326,5,"B","XMJMOR",1)

"KRN",.84,34326,5,"B","XMJMORX",2)

"KRN",.84,34326.1,-1)
0^375
"KRN",.84,34326.1,0)
34326.1^2^^MAILMAN^That's the same basket the message is al
"KRN",.84,34326.1,2,0)
^^1^1^2991214^
"KRN",.84,34326.1,2,1,0)
That's the same basket the message is already in.
"KRN",.84,34326.1,5,0)
^.841^1^1
"KRN",.84,34326.1,5,1,0)
XMJMOI
"KRN",.84,34326.1,5,"B","XMJMOI",1)

"KRN",.84,34328,-1)
0^376
"KRN",.84,34328,0)
34328^2^^MAILMAN^Terminate which messages
"KRN",.84,34328,2,0)
^^1^1^2991214^
"KRN",.84,34328,2,1,0)
Terminate which messages
"KRN",.84,34328,5,0)
^.841^2^2
"KRN",.84,34328,5,1,0)
XMJMOR
"KRN",.84,34328,5,2,0)
XMJMORX
"KRN",.84,34328,5,"B","XMJMOR",1)

"KRN",.84,34328,5,"B","XMJMORX",2)

"KRN",.84,34329,-1)
0^377
"KRN",.84,34329,0)
34329^2^y^MAILMAN^|1| messages terminated.
"KRN",.84,34329,2,0)
^^1^1^2991214^
"KRN",.84,34329,2,1,0)
|1| messages terminated.
"KRN",.84,34329,3,0)
^.845^1^1
"KRN",.84,34329,3,1,0)
1^number of messages
"KRN",.84,34329,5,0)
^.841^3^3
"KRN",.84,34329,5,1,0)
XMJMOR
"KRN",.84,34329,5,2,0)
XMJMORX
"KRN",.84,34329,5,3,0)
XMXMSGS
"KRN",.84,34329,5,"B","XMJMOR",1)

"KRN",.84,34329,5,"B","XMJMORX",2)

"KRN",.84,34329,5,"B","XMXMSGS",3)

"KRN",.84,34329.1,-1)
0^378
"KRN",.84,34329.1,0)
34329.1^2^^MAILMAN^1 message terminated.
"KRN",.84,34329.1,2,0)
^^1^1^2991214^
"KRN",.84,34329.1,2,1,0)
1 message terminated.
"KRN",.84,34329.1,5,0)
^.841^3^3
"KRN",.84,34329.1,5,1,0)
XMJMOR
"KRN",.84,34329.1,5,2,0)
XMJMORX
"KRN",.84,34329.1,5,3,0)
XMXMSGS
"KRN",.84,34329.1,5,"B","XMJMOR",1)

"KRN",.84,34329.1,5,"B","XMJMORX",2)

"KRN",.84,34329.1,5,"B","XMXMSGS",3)

"KRN",.84,34330,-1)
0^379
"KRN",.84,34330,0)
34330^2^^MAILMAN^Are you sure you want to terminate the sel
"KRN",.84,34330,2,0)
^^1^1^2991214^
"KRN",.84,34330,2,1,0)
Are you sure you want to terminate the selected messages
"KRN",.84,34330,5,0)
^.841^2^2
"KRN",.84,34330,5,1,0)
XMJMOR
"KRN",.84,34330,5,2,0)
XMJMORX
"KRN",.84,34330,5,"B","XMJMOR",1)

"KRN",.84,34330,5,"B","XMJMORX",2)

"KRN",.84,34330.1,-1)
0^380
"KRN",.84,34330.1,0)
34330.1^2^^MAILMAN^Do you really want to terminate these mess
"KRN",.84,34330.1,2,0)
^^1^1^2991214^
"KRN",.84,34330.1,2,1,0)
Do you really want to terminate these messages
"KRN",.84,34330.1,5,0)
^.841^2^2
"KRN",.84,34330.1,5,1,0)
XMJMOR
"KRN",.84,34330.1,5,2,0)
XMJMORX
"KRN",.84,34330.1,5,"B","XMJMOR",1)

"KRN",.84,34330.1,5,"B","XMJMORX",2)

"KRN",.84,34331,-1)
0^381
"KRN",.84,34331,0)
34331^2^^MAILMAN^You won't see future responses.  (In WASTE
"KRN",.84,34331,2,0)
^^1^1^2991214^
"KRN",.84,34331,2,1,0)
You won't see future responses.  (In WASTE basket)
"KRN",.84,34331,5,0)
^.841^2^2
"KRN",.84,34331,5,1,0)
XMJMOR
"KRN",.84,34331,5,2,0)
XMJMORX
"KRN",.84,34331,5,"B","XMJMOR",1)

"KRN",.84,34331,5,"B","XMJMORX",2)

"KRN",.84,34331.1,-1)
0^382
"KRN",.84,34331.1,0)
34331.1^2^^MAILMAN^You won't see future responses.
"KRN",.84,34331.1,2,0)
^^1^1^2991214^
"KRN",.84,34331.1,2,1,0)
You won't see future responses.
"KRN",.84,34331.1,5,0)
^.841^2^2
"KRN",.84,34331.1,5,1,0)
XMJMOR
"KRN",.84,34331.1,5,2,0)
XMJMORX
"KRN",.84,34331.1,5,"B","XMJMOR",1)

"KRN",.84,34331.1,5,"B","XMJMORX",2)

"KRN",.84,34332,-1)
0^1
"KRN",.84,34332,0)
34332^2^^MAILMAN^Select transmit priority: 
"KRN",.84,34332,1,0)
^^1^1^3020226^
"KRN",.84,34332,1,1,0)
There is 1 blank at the end of this dialog.
"KRN",.84,34332,2,0)
^^1^1^3020226^
"KRN",.84,34332,2,1,0)
Select transmit priority: 
"KRN",.84,34332,5,0)
^.841^1^1
"KRN",.84,34332,5,1,0)
XMJMORX
"KRN",.84,34332,5,"B","XMJMORX",1)

"KRN",.84,34332.1,-1)
0^2
"KRN",.84,34332.1,0)
34332.1^2^^MAILMAN^L:Low
"KRN",.84,34332.1,2,0)
^^1^1^3020226^
"KRN",.84,34332.1,2,1,0)
L:Low
"KRN",.84,34332.1,5,0)
^.841^1^1
"KRN",.84,34332.1,5,1,0)
XMJMORX
"KRN",.84,34332.1,5,"B","XMJMORX",1)

"KRN",.84,34332.2,-1)
0^3
"KRN",.84,34332.2,0)
34332.2^2^^MAILMAN^N:Normal
"KRN",.84,34332.2,2,0)
^^1^1^3020226^
"KRN",.84,34332.2,2,1,0)
N:Normal
"KRN",.84,34332.2,5,0)
^.841^1^1
"KRN",.84,34332.2,5,1,0)
XMJMORX
"KRN",.84,34332.2,5,"B","XMJMORX",1)

"KRN",.84,34332.3,-1)
0^4
"KRN",.84,34332.3,0)
34332.3^2^^MAILMAN^H:High
"KRN",.84,34332.3,2,0)
^^1^1^3020226^
"KRN",.84,34332.3,2,1,0)
H:High
"KRN",.84,34332.3,5,0)
^.841^1^1
"KRN",.84,34332.3,5,1,0)
XMJMORX
"KRN",.84,34332.3,5,"B","XMJMORX",1)

"KRN",.84,34333,-1)
0^383
"KRN",.84,34333,0)
34333^2^^MAILMAN^Toggle xmit priority for which messages
"KRN",.84,34333,2,0)
^^1^1^2991214^
"KRN",.84,34333,2,1,0)
Toggle xmit priority for which messages
"KRN",.84,34333,5,0)
^.841^2^2
"KRN",.84,34333,5,1,0)
XMJMOR
"KRN",.84,34333,5,2,0)
XMJMORX
"KRN",.84,34333,5,"B","XMJMOR",1)

"KRN",.84,34333,5,"B","XMJMORX",2)

"KRN",.84,34334,-1)
0^384
"KRN",.84,34334,0)
34334^2^y^MAILMAN^|1| messages xmit priority toggled.
"KRN",.84,34334,2,0)
^^1^1^2991214^
"KRN",.84,34334,2,1,0)
|1| messages xmit priority toggled.
"KRN",.84,34334,3,0)
^.845^1^1
"KRN",.84,34334,3,1,0)
1^number of messages
"KRN",.84,34334,5,0)
^.841^3^3
"KRN",.84,34334,5,1,0)
XMJMOR
"KRN",.84,34334,5,2,0)
XMJMORX
"KRN",.84,34334,5,3,0)
XMXMSGS
"KRN",.84,34334,5,"B","XMJMOR",1)

"KRN",.84,34334,5,"B","XMJMORX",2)

"KRN",.84,34334,5,"B","XMXMSGS",3)

"KRN",.84,34334.1,-1)
0^385
"KRN",.84,34334.1,0)
34334.1^2^^MAILMAN^1 message xmit priority toggled.
"KRN",.84,34334.1,2,0)
^^1^1^2991214^
"KRN",.84,34334.1,2,1,0)
1 message xmit priority toggled.
"KRN",.84,34334.1,5,0)
^.841^3^3
"KRN",.84,34334.1,5,1,0)
XMJMOR
"KRN",.84,34334.1,5,2,0)
XMJMORX
"KRN",.84,34334.1,5,3,0)
XMXMSGS
"KRN",.84,34334.1,5,"B","XMJMOR",1)

"KRN",.84,34334.1,5,"B","XMJMORX",2)

"KRN",.84,34334.1,5,"B","XMXMSGS",3)

"KRN",.84,34335,-1)
0^386
"KRN",.84,34335,0)
34335^2^^MAILMAN^Are you sure you want to toggle the xmit
"KRN",.84,34335,2,0)
^^1^1^2991214^
"KRN",.84,34335,2,1,0)
Are you sure you want to toggle the xmit priority for the selected messages
"KRN",.84,34335,5,0)
^.841^2^2
"KRN",.84,34335,5,1,0)
XMJMOR
"KRN",.84,34335,5,2,0)
XMJMORX
"KRN",.84,34335,5,"B","XMJMOR",1)

"KRN",.84,34335,5,"B","XMJMORX",2)

"KRN",.84,34335.1,-1)
0^387
"KRN",.84,34335.1,0)
34335.1^2^^MAILMAN^Do you really want to xmit priority toggle
"KRN",.84,34335.1,2,0)
^^1^1^2991214^
"KRN",.84,34335.1,2,1,0)
Do you really want to xmit priority toggle these messages
"KRN",.84,34335.1,5,0)
^.841^2^2
"KRN",.84,34335.1,5,1,0)
XMJMOR
"KRN",.84,34335.1,5,2,0)
XMJMORX
"KRN",.84,34335.1,5,"B","XMJMOR",1)

"KRN",.84,34335.1,5,"B","XMJMORX",2)

"KRN",.84,34336,-1)
0^388
"KRN",.84,34336,0)
34336^2^^MAILMAN^Set the vaporize date for which messages
"KRN",.84,34336,2,0)
^^1^1^3000607^
"KRN",.84,34336,2,1,0)
Set the vaporize date for which messages
"KRN",.84,34336,5,0)
^.841^1^1
"KRN",.84,34336,5,1,0)
XMJMOR
"KRN",.84,34336,5,"B","XMJMOR",1)

"KRN",.84,34336.1,-1)
0^389
"KRN",.84,34336.1,0)
34336.1^2^^MAILMAN^Delete the vaporize date for which mess
"KRN",.84,34336.1,2,0)
^^1^1^3000612^
"KRN",.84,34336.1,2,1,0)
Delete the vaporize date for which messages
"KRN",.84,34336.1,5,0)
^.841^1^1
"KRN",.84,34336.1,5,1,0)
XMJMOR
"KRN",.84,34336.1,5,"B","XMJMOR",1)

"KRN",.84,34337,-1)
0^390
"KRN",.84,34337,0)
34337^2^y^MAILMAN^|1| messages vaporize date set.
"KRN",.84,34337,2,0)
^.844^1^1^3000607^^
"KRN",.84,34337,2,1,0)
|1| messages vaporize date set.
"KRN",.84,34337,3,0)
^.845^1^1
"KRN",.84,34337,3,1,0)
1^number of messages whose vaporize date was set
"KRN",.84,34337,5,0)
^.841^2^2
"KRN",.84,34337,5,1,0)
XMJMOR
"KRN",.84,34337,5,2,0)
XMJMORX
"KRN",.84,34337,5,"B","XMJMOR",1)

"KRN",.84,34337,5,"B","XMJMORX",2)

"KRN",.84,34337.1,-1)
0^391
"KRN",.84,34337.1,0)
34337.1^2^^MAILMAN^1 message vaporize date set.
"KRN",.84,34337.1,2,0)
^^1^1^3000607^
"KRN",.84,34337.1,2,1,0)
1 message vaporize date set.
"KRN",.84,34337.1,5,0)
^.841^2^2
"KRN",.84,34337.1,5,1,0)
XMJMOR
"KRN",.84,34337.1,5,2,0)
XMJMORX
"KRN",.84,34337.1,5,"B","XMJMOR",1)

"KRN",.84,34337.1,5,"B","XMJMORX",2)

"KRN",.84,34337.2,-1)
0^392
"KRN",.84,34337.2,0)
34337.2^2^y^MAILMAN^|1| messages vaporize date deleted
"KRN",.84,34337.2,2,0)
^^1^1^3000612^
"KRN",.84,34337.2,2,1,0)
|1| messages vaporize date deleted.
"KRN",.84,34337.2,3,0)
^.845^1^1
"KRN",.84,34337.2,3,1,0)
1^number of messages
"KRN",.84,34337.2,5,0)
^.841^1^1
"KRN",.84,34337.2,5,1,0)
XMJMOR
"KRN",.84,34337.2,5,"B","XMJMOR",1)

"KRN",.84,34337.3,-1)
0^393
"KRN",.84,34337.3,0)
34337.3^2^^MAILMAN^1 message vaporize date deleted.
"KRN",.84,34337.3,2,0)
^^1^1^3000612^
"KRN",.84,34337.3,2,1,0)
1 message vaporize date deleted.
"KRN",.84,34337.3,5,0)
^.841^1^1
"KRN",.84,34337.3,5,1,0)
XMJMOR
"KRN",.84,34337.3,5,"B","XMJMOR",1)

"KRN",.84,34338,-1)
0^394
"KRN",.84,34338,0)
34338^2^^MAILMAN^Are you sure you want to set the vaporize
"KRN",.84,34338,2,0)
^^1^1^3000607^
"KRN",.84,34338,2,1,0)
Are you sure you want to set the vaporize date for the selected messages
"KRN",.84,34338,5,0)
^.841^1^1
"KRN",.84,34338,5,1,0)
XMJMORX
"KRN",.84,34338,5,"B","XMJMORX",1)

"KRN",.84,34338.1,-1)
0^395
"KRN",.84,34338.1,0)
34338.1^2^^MAILMAN^Do you really want to set the vaporize
"KRN",.84,34338.1,2,0)
^^1^1^3000607^
"KRN",.84,34338.1,2,1,0)
Do you really want to set the vaporize date for these messages
"KRN",.84,34338.1,5,0)
^.841^1^1
"KRN",.84,34338.1,5,1,0)
XMJMOR
"KRN",.84,34338.1,5,"B","XMJMOR",1)

"KRN",.84,34338.2,-1)
0^396
"KRN",.84,34338.2,0)
34338.2^2^^MAILMAN^Are you sure you want to delete the vapor
"KRN",.84,34338.2,2,0)
^^2^2^3000612^
"KRN",.84,34338.2,2,1,0)
Are you sure you want to delete
"KRN",.84,34338.2,2,2,0)
the vaporize date for the selected messages
"KRN",.84,34338.2,5,0)
^.841^1^1
"KRN",.84,34338.2,5,1,0)
XMJMOR
"KRN",.84,34338.2,5,"B","XMJMOR",1)

"KRN",.84,34338.3,-1)
0^397
"KRN",.84,34338.3,0)
34338.3^2^^MAILMAN^Do you really want to delete the vaporize
"KRN",.84,34338.3,2,0)
^^1^1^3000612^
"KRN",.84,34338.3,2,1,0)
Do you really want to delete the vaporize date for these messages
"KRN",.84,34338.3,5,0)
^.841^1^1
"KRN",.84,34338.3,5,1,0)
XMJMOR
"KRN",.84,34338.3,5,"B","XMJMOR",1)

"KRN",.84,34339,-1)
0^398
"KRN",.84,34339,0)
34339^3^^MAILMAN^Enter a date (in the future)
"KRN",.84,34339,2,0)
^.844^2^2^3000607^^
"KRN",.84,34339,2,1,0)
Enter a date (in the future) when the messages should be deleted from
"KRN",.84,34339,2,2,0)
your mailbox.  (Enter '@' to delete any existing vaporize dates.)
"KRN",.84,34339,5,0)
^.841^1^1
"KRN",.84,34339,5,1,0)
XMJMOR
"KRN",.84,34339,5,"B","XMJMOR",1)

"KRN",.84,34350,-1)
0^399
"KRN",.84,34350,0)
34350^1^y^MAILMAN^Range '|1|-|2|' invalid.
"KRN",.84,34350,2,0)
^^1^1^2991220^
"KRN",.84,34350,2,1,0)
Range '|1|-|2|' invalid.
"KRN",.84,34350,3,0)
^.845^2^2
"KRN",.84,34350,3,1,0)
1^start of message range
"KRN",.84,34350,3,2,0)
2^end of message range
"KRN",.84,34350,5,0)
^.841^1^1
"KRN",.84,34350,5,1,0)
XMXMSGS
"KRN",.84,34350,5,"B","XMXMSGS",1)

"KRN",.84,34351,-1)
0^400
"KRN",.84,34351,0)
34351^1^y^MAILMAN^Message '|1|' in basket '|2|' does not exi
"KRN",.84,34351,2,0)
^^1^1^2991220^
"KRN",.84,34351,2,1,0)
Message '|1|' in basket '|2|' does not exist.
"KRN",.84,34351,3,0)
^.845^2^2
"KRN",.84,34351,3,1,0)
1^message sequence number in basket
"KRN",.84,34351,3,2,0)
2^basket ien
"KRN",.84,34351,5,0)
^.841^3^3
"KRN",.84,34351,5,1,0)
XMXMSGS
"KRN",.84,34351,5,2,0)
XMXSEC1
"KRN",.84,34351,5,3,0)
XMXPARM
"KRN",.84,34351,5,"B","XMXMSGS",1)

"KRN",.84,34351,5,"B","XMXPARM",3)

"KRN",.84,34351,5,"B","XMXSEC1",2)

"KRN",.84,34352,-1)
0^401
"KRN",.84,34352,0)
34352^1^y^MAILMAN^Message '|1|' (message '|2|' in basket '|3
"KRN",.84,34352,2,0)
^^1^1^2991220^
"KRN",.84,34352,2,1,0)
Message '|1|' (message '|2|' in basket '|3|') does not exist.
"KRN",.84,34352,3,0)
^.845^3^3
"KRN",.84,34352,3,1,0)
1^message ien in message file
"KRN",.84,34352,3,2,0)
2^message sequence number in basket
"KRN",.84,34352,3,3,0)
3^basket ien
"KRN",.84,34352,5,0)
^.841^2^2
"KRN",.84,34352,5,1,0)
XMXMSGS
"KRN",.84,34352,5,2,0)
XMXSEC1
"KRN",.84,34352,5,"B","XMXMSGS",1)

"KRN",.84,34352,5,"B","XMXSEC1",2)

"KRN",.84,34353,-1)
0^145
"KRN",.84,34353,0)
34353^1^^MAILMAN^XMZ message ranges are not allowed.
"KRN",.84,34353,2,0)
^^1^1^2991220^
"KRN",.84,34353,2,1,0)
XMZ message ranges are not allowed.
"KRN",.84,34353,5,0)
^.841^1^1
"KRN",.84,34353,5,1,0)
XMXMSGS
"KRN",.84,34353,5,"B","XMXMSGS",1)

"KRN",.84,34354,-1)
0^402
"KRN",.84,34354,0)
34354^1^y^MAILMAN^Message '|1|' does not exist.
"KRN",.84,34354,2,0)
^^1^1^2991220^
"KRN",.84,34354,2,1,0)
Message '|1|' does not exist.
"KRN",.84,34354,3,0)
^.845^1^1
"KRN",.84,34354,3,1,0)
1^message ien in message file
"KRN",.84,34354,5,0)
^.841^3^3
"KRN",.84,34354,5,1,0)
XMXMSGS
"KRN",.84,34354,5,2,0)
XMXSEC1
"KRN",.84,34354,5,3,0)
XMXPARM
"KRN",.84,34354,5,"B","XMXMSGS",1)

"KRN",.84,34354,5,"B","XMXPARM",3)

"KRN",.84,34354,5,"B","XMXSEC1",2)

"KRN",.84,34401,-1)
0^403
"KRN",.84,34401,0)
34401^2^^MAILMAN^  No matches found.
"KRN",.84,34401,2,0)
^^1^1^2991221^
"KRN",.84,34401,2,1,0)
  No matches found.
"KRN",.84,34401,5,0)
^.841^2^2
"KRN",.84,34401,5,1,0)
XMJMFA
"KRN",.84,34401,5,2,0)
XMJMFB
"KRN",.84,34401,5,"B","XMJMFA",1)

"KRN",.84,34401,5,"B","XMJMFB",2)

"KRN",.84,34402,-1)
0^404
"KRN",.84,34402,0)
34402^2^^MAILMAN^Search finished.
"KRN",.84,34402,2,0)
^^1^1^2991221^
"KRN",.84,34402,2,1,0)
Search finished.
"KRN",.84,34402,5,0)
^.841^2^2
"KRN",.84,34402,5,1,0)
XMJMFA
"KRN",.84,34402,5,2,0)
XMJMFB
"KRN",.84,34402,5,"B","XMJMFA",1)

"KRN",.84,34402,5,"B","XMJMFB",2)

"KRN",.84,34403,-1)
0^405
"KRN",.84,34403,0)
34403^2^^MAILMAN^All Messages Search
"KRN",.84,34403,2,0)
^^1^1^3000608^
"KRN",.84,34403,2,1,0)
All Messages Search
"KRN",.84,34403,5,0)
^.841^1^1
"KRN",.84,34403,5,1,0)
XMJMFA
"KRN",.84,34403,5,"B","XMJMFA",1)

"KRN",.84,34403.5,-1)
0^406
"KRN",.84,34403.5,0)
34403.5^2^^MAILMAN^All Messages Super Search
"KRN",.84,34403.5,2,0)
^^1^1^3000907^
"KRN",.84,34403.5,2,1,0)
All Messages Super Search
"KRN",.84,34403.5,5,0)
^.841^1^1
"KRN",.84,34403.5,5,1,0)
XMJMFC
"KRN",.84,34403.5,5,"B","XMJMFC",1)

"KRN",.84,34404,-1)
0^407
"KRN",.84,34404,0)
34404^2^y^MAILMAN^|1| Basket Search
"KRN",.84,34404,2,0)
^^1^1^3000608^
"KRN",.84,34404,2,1,0)
|1| Basket Search
"KRN",.84,34404,3,0)
^.845^1^1
"KRN",.84,34404,3,1,0)
1^basket name
"KRN",.84,34404,5,0)
^.841^1^1
"KRN",.84,34404,5,1,0)
XMJMFB
"KRN",.84,34404,5,"B","XMJMFB",1)

"KRN",.84,34405,-1)
0^408
"KRN",.84,34405,0)
34405^2^^MAILMAN^All Baskets Search
"KRN",.84,34405,2,0)
^^1^1^3000608^
"KRN",.84,34405,2,1,0)
All Baskets Search
"KRN",.84,34405,5,0)
^.841^1^1
"KRN",.84,34405,5,1,0)
XMJMFB
"KRN",.84,34405,5,"B","XMJMFB",1)

"KRN",.84,34410,-1)
0^409
"KRN",.84,34410,0)
34410^2^^MAILMAN^Select message search method: 
"KRN",.84,34410,1,0)
^^1^1^3000905^
"KRN",.84,34410,1,1,0)
There's one blank at the end.
"KRN",.84,34410,2,0)
^.844^1^1^3000905^^
"KRN",.84,34410,2,1,0)
Select message search method: 
"KRN",.84,34410,5,0)
^.841^1^1
"KRN",.84,34410,5,1,0)
XMJMF
"KRN",.84,34410,5,"B","XMJMF",1)

"KRN",.84,34411,-1)
0^410
"KRN",.84,34411,0)
34411^2^^MAILMAN^S:Search all messages by subject only
"KRN",.84,34411,2,0)
^.844^1^1^3000829^^^
"KRN",.84,34411,2,1,0)
S:Search all messages by subject only
"KRN",.84,34411,5,0)
^.841^1^1
"KRN",.84,34411,5,1,0)
XMJMF
"KRN",.84,34411,5,"B","XMJMF",1)

"KRN",.84,34412,-1)
0^411
"KRN",.84,34412,0)
34412^2^^MAILMAN^M:Search my Mailbox by multiple criteria
"KRN",.84,34412,2,0)
^.844^1^1^3000829^^
"KRN",.84,34412,2,1,0)
M:Search my Mailbox by multiple criteria
"KRN",.84,34412,5,0)
^.841^1^1
"KRN",.84,34412,5,1,0)
XMJMF
"KRN",.84,34412,5,"B","XMJMF",1)

"KRN",.84,34413,-1)
0^412
"KRN",.84,34413,0)
34413^2^^MAILMAN^A:Search all messages by multiple criteria
"KRN",.84,34413,2,0)
^^1^1^3000829^
"KRN",.84,34413,2,1,0)
A:Search all messages by multiple criteria
"KRN",.84,34413,5,0)
^.841^1^1
"KRN",.84,34413,5,1,0)
XMJMF
"KRN",.84,34413,5,"B","XMJMF",1)

"KRN",.84,34413.5,-1)
0^413
"KRN",.84,34413.5,0)
34413.5^2^^MAILMAN^You are not authorized to Super Search
"KRN",.84,34413.5,2,0)
^.844^3^3^3000906^^^
"KRN",.84,34413.5,2,1,0)
You are not authorized to Super Search the Message file.
"KRN",.84,34413.5,2,2,0)
You must be yourself (not POSTMASTER or SHARED,MAIL).
"KRN",.84,34413.5,2,3,0)
You must possess the proper security key.
"KRN",.84,34413.5,5,0)
^.841^1^1
"KRN",.84,34413.5,5,1,0)
XMJMF
"KRN",.84,34413.5,5,"B","XMJMF",1)

"KRN",.84,34413.6,-1)
0^414
"KRN",.84,34413.6,0)
34413.6^1^^MAILMAN^You may not Super Search until
"KRN",.84,34413.6,2,0)
^.844^8^8^3000907^^^^
"KRN",.84,34413.6,2,1,0)
You may not Super Search until you ensure that an audit bulletin
"KRN",.84,34413.6,2,2,0)
can be sent.  The following conditions must be met:
"KRN",.84,34413.6,2,3,0)
 
"KRN",.84,34413.6,2,4,0)
Bulletin XM SUPER SEARCH must exist.
"KRN",.84,34413.6,2,5,0)
Mail group XM SUPER SEARCH must exist and be populated with active
"KRN",.84,34413.6,2,6,0)
local users who have logged on recently.
"KRN",.84,34413.6,2,7,0)
 
"KRN",.84,34413.6,2,8,0)
See option XM SUPER SEARCH for more information.
"KRN",.84,34413.6,5,0)
^.841^1^1
"KRN",.84,34413.6,5,1,0)
XMJMF
"KRN",.84,34413.6,5,"B","XMJMF",1)

"KRN",.84,34414,-1)
0^415
"KRN",.84,34414,0)
34414^3^^MAILMAN^Enter 'S' to search all messages on the
"KRN",.84,34414,2,0)
^.844^15^15^3000831^^
"KRN",.84,34414,2,1,0)
Enter 'S' or 'A' to search all messages on the system which you have ever sent
"KRN",.84,34414,2,2,0)
or which have ever been sent to you, whether they are in your mailbox or not.
"KRN",.84,34414,2,3,0)

"KRN",.84,34414,2,4,0)
The 'S' search is based only on the criterion, 'Subject starts with',
"KRN",.84,34414,2,5,0)
(This is the fastest and most restrictive search.)
"KRN",.84,34414,2,6,0)

"KRN",.84,34414,2,7,0)
The 'A' search is based on any combination of the criteria: 'Subject contains',
"KRN",.84,34414,2,8,0)
'sender is', 'addressee is', 'response sender is', 'lines of text', and
"KRN",.84,34414,2,9,0)
'message contains'.  (This is the slowest and most extensive search,
"KRN",.84,34414,2,10,0)
and requires that you enter a time period - month and/or year - to search.)
"KRN",.84,34414,2,11,0)

"KRN",.84,34414,2,12,0)
Enter 'M' to search all messages which currently exist in your mailbox.
"KRN",.84,34414,2,13,0)
The search is based on any combination of criteria:
"KRN",.84,34414,2,14,0)
'Subject contains', 'sender is', 'addressee is', 'date sent',
"KRN",.84,34414,2,15,0)
'response sender is', 'lines of text', and 'message contains'.
"KRN",.84,34414,5,0)
^.841^1^1
"KRN",.84,34414,5,1,0)
XMJMF
"KRN",.84,34414,5,"B","XMJMF",1)

"KRN",.84,34415,-1)
0^416
"KRN",.84,34415,0)
34415^2^^MAILMAN^Enter the string that the subject starts
"KRN",.84,34415,2,0)
^^1^1^3000829^
"KRN",.84,34415,2,1,0)
Enter the string that the subject starts with
"KRN",.84,34415,5,0)
^.841^1^1
"KRN",.84,34415,5,1,0)
XMJMF
"KRN",.84,34415,5,"B","XMJMF",1)

"KRN",.84,34416,-1)
0^417
"KRN",.84,34416,0)
34416^3^^MAILMAN^The string may be from 3 to 30 characters.
"KRN",.84,34416,2,0)
^^5^5^3000829^
"KRN",.84,34416,2,1,0)
The string may be from 3 to 30 characters.
"KRN",.84,34416,2,2,0)
We will find all messages whose subject starts with the string you enter.
"KRN",.84,34416,2,3,0)
We will search all existing messages which you have ever had access to,
"KRN",.84,34416,2,4,0)
whether they are in your mailbox or not.
"KRN",.84,34416,2,5,0)
The search is case-sensitive.
"KRN",.84,34416,5,0)
^.841^1^1
"KRN",.84,34416,5,1,0)
XMJMF
"KRN",.84,34416,5,"B","XMJMF",1)

"KRN",.84,34417,-1)
0^418
"KRN",.84,34417,0)
34417^2^^MAILMAN^Searching...
"KRN",.84,34417,2,0)
^.844^1^1^3000829^^
"KRN",.84,34417,2,1,0)
Searching...
"KRN",.84,34417,5,0)
^.841^1^1
"KRN",.84,34417,5,1,0)
XMJMF
"KRN",.84,34417,5,"B","XMJMF",1)

"KRN",.84,34418,-1)
0^419
"KRN",.84,34418,0)
34418^2^^MAILMAN^This search looks at all messages in
"KRN",.84,34418,2,0)
^.844^8^8^3000908^^^^
"KRN",.84,34418,2,1,0)
                      * * * * * WARNING * * * * *
"KRN",.84,34418,2,2,0)

"KRN",.84,34418,2,3,0)
This search looks at all messages in the MESSAGE file which were sent
"KRN",.84,34418,2,4,0)
to you or by you during the entire time period you select.
"KRN",.84,34418,2,5,0)
If you know that the messages you are looking for are in your Mailbox
"KRN",.84,34418,2,6,0)
baskets, you should use the Mailbox search, instead.  It is much faster.
"KRN",.84,34418,2,7,0)
This search is for finding messages which aren't in your Mailbox.  It
"KRN",.84,34418,2,8,0)
is much slower.
"KRN",.84,34418,5,0)
^.841^1^1
"KRN",.84,34418,5,1,0)
XMJMF
"KRN",.84,34418,5,"B","XMJMF",1)

"KRN",.84,34418.5,-1)
0^420
"KRN",.84,34418.5,0)
34418.5^2^^MAILMAN^This is the Super Search
"KRN",.84,34418.5,2,0)
^.844^7^7^3000906^^^^
"KRN",.84,34418.5,2,1,0)
                      * * * * * WARNING * * * * *
"KRN",.84,34418.5,2,2,0)

"KRN",.84,34418.5,2,3,0)
This is the Super Search.  It looks at all messages in the MESSAGE
"KRN",.84,34418.5,2,4,0)
file which were sent by anyone and everyone during the entire
"KRN",.84,34418.5,2,5,0)
time period you select, regardless of whether or not you are party
"KRN",.84,34418.5,2,6,0)
to the messages.  This is a very powerful search and should not be
"KRN",.84,34418.5,2,7,0)
abused.  You should have good reason and authorization to be here.
"KRN",.84,34418.5,5,0)
^.841^1^1
"KRN",.84,34418.5,5,1,0)
XMJMF
"KRN",.84,34418.5,5,"B","XMJMF",1)

"KRN",.84,34419,-1)
0^421
"KRN",.84,34419,0)
34419^2^^MAILMAN^This search can take a very long time
"KRN",.84,34419,2,0)
^.844^6^6^3000905^^^
"KRN",.84,34419,2,1,0)
This search can take a very long time, depending on how many messages
"KRN",.84,34419,2,2,0)
were sent at this site during the time period you select, and how many
"KRN",.84,34419,2,3,0)
search criteria you specify.  The more messages to search, the more
"KRN",.84,34419,2,4,0)
search criteria you specify, the longer the search will take.
"KRN",.84,34419,2,5,0)

"KRN",.84,34419,2,6,0)
             This search can be VERY SLOW.  Be forewarned!
"KRN",.84,34419,5,0)
^.841^1^1
"KRN",.84,34419,5,1,0)
XMJMF
"KRN",.84,34419,5,"B","XMJMF",1)

"KRN",.84,34420,-1)
0^422
"KRN",.84,34420,0)
34420^2^^MAILMAN^Select search action:
"KRN",.84,34420,1,0)
^.842^1^1^3000829^^
"KRN",.84,34420,1,1,0)
There's one blank at the end
"KRN",.84,34420,2,0)
^^1^1^3000829^
"KRN",.84,34420,2,1,0)
Select search action: 
"KRN",.84,34420,5,0)
^.841^1^1
"KRN",.84,34420,5,1,0)
XMJMF1
"KRN",.84,34420,5,"B","XMJMF1",1)

"KRN",.84,34420.1,-1)
0^423
"KRN",.84,34420.1,0)
34420.1^2^^MAILMAN^Q:Quit
"KRN",.84,34420.1,2,0)
^^1^1^3000829^
"KRN",.84,34420.1,2,1,0)
Q:Quit
"KRN",.84,34420.1,5,0)
^.841^1^1
"KRN",.84,34420.1,5,1,0)
XMJMF1
"KRN",.84,34420.1,5,"B","XMJMF1",1)

"KRN",.84,34420.2,-1)
0^424
"KRN",.84,34420.2,0)
34420.2^2^^MAILMAN^G:Go Search
"KRN",.84,34420.2,2,0)
^^1^1^3000829^
"KRN",.84,34420.2,2,1,0)
G:Go Search
"KRN",.84,34420.2,5,0)
^.841^1^1
"KRN",.84,34420.2,5,1,0)
XMJMF1
"KRN",.84,34420.2,5,"B","XMJMF1",1)

"KRN",.84,34421,-1)
0^425
"KRN",.84,34421,0)
34421^2^^MAILMAN^B:Search one basket
"KRN",.84,34421,2,0)
^^1^1^3000829^
"KRN",.84,34421,2,1,0)
B:Search one basket
"KRN",.84,34421,5,0)
^.841^1^1
"KRN",.84,34421,5,1,0)
XMJMF1
"KRN",.84,34421,5,"B","XMJMF1",1)

"KRN",.84,34421.1,-1)
0^426
"KRN",.84,34421.1,0)
34421.1^2^^MAILMAN^B:Change Search basket
"KRN",.84,34421.1,2,0)
^^1^1^3000829^
"KRN",.84,34421.1,2,1,0)
B:Change Search basket
"KRN",.84,34421.1,5,0)
^.841^1^1
"KRN",.84,34421.1,5,1,0)
XMJMF1
"KRN",.84,34421.1,5,"B","XMJMF1",1)

"KRN",.84,34421.2,-1)
0^427
"KRN",.84,34421.2,0)
34421.2^2^^MAILMAN^BA:Search all baskets
"KRN",.84,34421.2,2,0)
^^1^1^3000829^
"KRN",.84,34421.2,2,1,0)
BA:Search all baskets
"KRN",.84,34421.2,5,0)
^.841^1^1
"KRN",.84,34421.2,5,1,0)
XMJMF1
"KRN",.84,34421.2,5,"B","XMJMF1",1)

"KRN",.84,34422,-1)
0^428
"KRN",.84,34422,0)
34422^2^^MAILMAN^S:Enter 'Subject contains' string
"KRN",.84,34422,2,0)
^.844^1^1^3000829^
"KRN",.84,34422,2,1,0)
S:Enter 'Subject contains' string
"KRN",.84,34422,5,0)
^.841^1^1
"KRN",.84,34422,5,1,0)
XMJMF1
"KRN",.84,34422,5,"B","XMJMF1",1)

"KRN",.84,34422.1,-1)
0^429
"KRN",.84,34422.1,0)
34422.1^2^^MAILMAN^S:Change 'Subject contains' string
"KRN",.84,34422.1,2,0)
^^1^1^3000829^
"KRN",.84,34422.1,2,1,0)
S:Change 'Subject contains' string
"KRN",.84,34422.1,5,0)
^.841^1^1
"KRN",.84,34422.1,5,1,0)
XMJMF1
"KRN",.84,34422.1,5,"B","XMJMF1",1)

"KRN",.84,34423,-1)
0^430
"KRN",.84,34423,0)
34423^2^^MAILMAN^F:Enter 'Message from' person
"KRN",.84,34423,2,0)
^.844^1^1^3000829^^
"KRN",.84,34423,2,1,0)
F:Enter 'Message from' person
"KRN",.84,34423,5,0)
^.841^1^1
"KRN",.84,34423,5,1,0)
XMJMF1
"KRN",.84,34423,5,"B","XMJMF1",1)

"KRN",.84,34423.1,-1)
0^431
"KRN",.84,34423.1,0)
34423.1^2^^MAILMAN^F:Change 'Message from' person
"KRN",.84,34423.1,2,0)
^^1^1^3000829^
"KRN",.84,34423.1,2,1,0)
F:Change 'Message from' person
"KRN",.84,34423.1,5,0)
^.841^1^1
"KRN",.84,34423.1,5,1,0)
XMJMF1
"KRN",.84,34423.1,5,"B","XMJMF1",1)

"KRN",.84,34424,-1)
0^432
"KRN",.84,34424,0)
34424^2^^MAILMAN^T:Enter 'Message to' addressee
"KRN",.84,34424,2,0)
^.844^1^1^3000829^^
"KRN",.84,34424,2,1,0)
T:Enter 'Message to' addressee
"KRN",.84,34424,5,0)
^.841^1^1
"KRN",.84,34424,5,1,0)
XMJMF1
"KRN",.84,34424,5,"B","XMJMF1",1)

"KRN",.84,34424.1,-1)
0^433
"KRN",.84,34424.1,0)
34424.1^2^^MAILMAN^T:Change 'Message to' addressee
"KRN",.84,34424.1,2,0)
^^1^1^3000829^
"KRN",.84,34424.1,2,1,0)
T:Change 'Message to' addressee
"KRN",.84,34424.1,5,0)
^.841^1^1
"KRN",.84,34424.1,5,1,0)
XMJMF1
"KRN",.84,34424.1,5,"B","XMJMF1",1)

"KRN",.84,34426,-1)
0^435
"KRN",.84,34426,0)
34426^2^^MAILMAN^DA:Enter 'Message sent on or after' date
"KRN",.84,34426,2,0)
^.844^1^1^3000829^
"KRN",.84,34426,2,1,0)
DA:Enter 'Message sent on or after' date
"KRN",.84,34426,5,0)
^.841^1^1
"KRN",.84,34426,5,1,0)
XMJMF1
"KRN",.84,34426,5,"B","XMJMF1",1)

"KRN",.84,34426.1,-1)
0^436
"KRN",.84,34426.1,0)
34426.1^2^^MAILMAN^DA:Change 'Message sent on or after' date
"KRN",.84,34426.1,2,0)
^^1^1^3000829^
"KRN",.84,34426.1,2,1,0)
DA:Change 'Message sent on or after' date
"KRN",.84,34426.1,5,0)
^.841^1^1
"KRN",.84,34426.1,5,1,0)
XMJMF1
"KRN",.84,34426.1,5,"B","XMJMF1",1)

"KRN",.84,34427,-1)
0^437
"KRN",.84,34427,0)
34427^2^^MAILMAN^DB:Enter 'Message sent on or before' date
"KRN",.84,34427,2,0)
^.844^1^1^3000829^^
"KRN",.84,34427,2,1,0)
DB:Enter 'Message sent on or before' date
"KRN",.84,34427,5,0)
^.841^1^1
"KRN",.84,34427,5,1,0)
XMJMF1
"KRN",.84,34427,5,"B","XMJMF1",1)

"KRN",.84,34427.1,-1)
0^438
"KRN",.84,34427.1,0)
34427.1^2^^MAILMAN^DB:Change 'Message sent on or before' date
"KRN",.84,34427.1,2,0)
^^1^1^3000829^
"KRN",.84,34427.1,2,1,0)
DB:Change 'Message sent on or before' date
"KRN",.84,34427.1,5,0)
^.841^1^1
"KRN",.84,34427.1,5,1,0)
XMJMF1
"KRN",.84,34427.1,5,"B","XMJMF1",1)

"KRN",.84,34428,-1)
0^439
"KRN",.84,34428,0)
34428^2^^MAILMAN^R:Enter 'Response from' person
"KRN",.84,34428,2,0)
^.844^1^1^3000829^^
"KRN",.84,34428,2,1,0)
R:Enter 'Response from' person
"KRN",.84,34428,5,0)
^.841^1^1
"KRN",.84,34428,5,1,0)
XMJMF1
"KRN",.84,34428,5,"B","XMJMF1",1)

"KRN",.84,34428.1,-1)
0^440
"KRN",.84,34428.1,0)
34428.1^2^^MAILMAN^R:Change 'Response from' person
"KRN",.84,34428.1,2,0)
^^1^1^3000829^
"KRN",.84,34428.1,2,1,0)
R:Change 'Response from' person
"KRN",.84,34428.1,5,0)
^.841^1^1
"KRN",.84,34428.1,5,1,0)
XMJMF1
"KRN",.84,34428.1,5,"B","XMJMF1",1)

"KRN",.84,34429,-1)
0^441
"KRN",.84,34429,0)
34429^2^^MAILMAN^X:Change 'Message contains' string
"KRN",.84,34429,2,0)
^^1^1^3000829^
"KRN",.84,34429,2,1,0)
X:Enter 'Message contains' string
"KRN",.84,34429,5,0)
^.841^1^1
"KRN",.84,34429,5,1,0)
XMJMF1
"KRN",.84,34429,5,"B","XMJMF1",1)

"KRN",.84,34429.1,-1)
0^442
"KRN",.84,34429.1,0)
34429.1^2^^MAILMAN^X:Change 'Message contains' string
"KRN",.84,34429.1,2,0)
^^1^1^3000829^
"KRN",.84,34429.1,2,1,0)
X:Change 'Message contains' string
"KRN",.84,34429.1,5,0)
^.841^1^1
"KRN",.84,34429.1,5,1,0)
XMJMF1
"KRN",.84,34429.1,5,"B","XMJMF1",1)

"KRN",.84,34430,-1)
0^443
"KRN",.84,34430,0)
34430^2^^MAILMAN^L:Enter 'Minimum Lines of text' number
"KRN",.84,34430,2,0)
^.844^1^1^3000831^^
"KRN",.84,34430,2,1,0)
L:Enter 'Minimum Lines of text' number
"KRN",.84,34430,5,0)
^.841^1^1
"KRN",.84,34430,5,1,0)
XMJMF1
"KRN",.84,34430,5,"B","XMJMF1",1)

"KRN",.84,34430.1,-1)
0^444
"KRN",.84,34430.1,0)
34430.1^2^^MAILMAN^L:Change 'Minimum Lines of text' number
"KRN",.84,34430.1,2,0)
^.844^1^1^3000831^^^
"KRN",.84,34430.1,2,1,0)
L:Change 'Minimum Lines of text' number
"KRN",.84,34430.1,5,0)
^.841^1^1
"KRN",.84,34430.1,5,1,0)
XMJMF1
"KRN",.84,34430.1,5,"B","XMJMF1",1)

"KRN",.84,34431,-1)
0^445
"KRN",.84,34431,0)
34431^2^^MAILMAN^LX:Enter 'Maximum Lines of text' number
"KRN",.84,34431,2,0)
^.844^1^1^3000831^
"KRN",.84,34431,2,1,0)
LX:Enter 'Maximum Lines of text' number
"KRN",.84,34431,5,0)
^.841^1^1
"KRN",.84,34431,5,1,0)
XMJMF1
"KRN",.84,34431,5,"B","XMJMF1",1)

"KRN",.84,34431.1,-1)
0^446
"KRN",.84,34431.1,0)
34431.1^2^^MAILMAN^LX:Change 'Maximum Lines of text' number
"KRN",.84,34431.1,2,0)
^.844^1^1^3000831^
"KRN",.84,34431.1,2,1,0)
LX:Change 'Maximum Lines of text' number
"KRN",.84,34431.1,5,0)
^.841^1^1
"KRN",.84,34431.1,5,1,0)
XMJMF1
"KRN",.84,34431.1,5,"B","XMJMF1",1)

"KRN",.84,34435,-1)
0^447
"KRN",.84,34435,0)
34435^2^^MAILMAN^Current 'All Messages' search criteria:
"KRN",.84,34435,2,0)
^^1^1^3000829^
"KRN",.84,34435,2,1,0)
Current 'All Messages' search criteria:
"KRN",.84,34435,5,0)
^.841^1^1
"KRN",.84,34435,5,1,0)
XMJMF1
"KRN",.84,34435,5,"B","XMJMF1",1)

"KRN",.84,34435.5,-1)
0^448
"KRN",.84,34435.5,0)
34435.5^2^^MAILMAN^Current 'All Messages Super Search'
"KRN",.84,34435.5,2,0)
^.844^1^1^3000906^^
"KRN",.84,34435.5,2,1,0)
Current 'All Messages Super Search' search criteria:
"KRN",.84,34435.5,5,0)
^.841^1^1
"KRN",.84,34435.5,5,1,0)
XMJMF1
"KRN",.84,34435.5,5,"B","XMJMF1",1)

"KRN",.84,34436,-1)
0^449
"KRN",.84,34436,0)
34436^2^^MAILMAN^Current 'Mailbox' search criteria:
"KRN",.84,34436,2,0)
^.844^1^1^3000829^^
"KRN",.84,34436,2,1,0)
Current 'Mailbox' search criteria:
"KRN",.84,34436,5,0)
^.841^1^1
"KRN",.84,34436,5,1,0)
XMJMF1
"KRN",.84,34436,5,"B","XMJMF1",1)

"KRN",.84,34437,-1)
0^450
"KRN",.84,34437,0)
34437^2^^MAILMAN^Search basket
"KRN",.84,34437,2,0)
^.844^1^1^3000829^^
"KRN",.84,34437,2,1,0)
Search basket
"KRN",.84,34437,5,0)
^.841^1^1
"KRN",.84,34437,5,1,0)
XMJMF1
"KRN",.84,34437,5,"B","XMJMF1",1)

"KRN",.84,34437.1,-1)
0^451
"KRN",.84,34437.1,0)
34437.1^2^^MAILMAN^All baskets
"KRN",.84,34437.1,2,0)
^^1^1^3000829^
"KRN",.84,34437.1,2,1,0)
All baskets
"KRN",.84,34437.1,5,0)
^.841^1^1
"KRN",.84,34437.1,5,1,0)
XMJMF1
"KRN",.84,34437.1,5,"B","XMJMF1",1)

"KRN",.84,34438,-1)
0^452
"KRN",.84,34438,0)
34438^2^^MAILMAN^Subject contains
"KRN",.84,34438,2,0)
^^1^1^3000829^
"KRN",.84,34438,2,1,0)
Subject contains
"KRN",.84,34438,5,0)
^.841^1^1
"KRN",.84,34438,5,1,0)
XMJMF1
"KRN",.84,34438,5,"B","XMJMF1",1)

"KRN",.84,34438.1,-1)
0^453
"KRN",.84,34438.1,0)
34438.1^3^^MAILMAN^Enter the string that the subject contains
"KRN",.84,34438.1,2,0)
^.844^3^3^3000829^^
"KRN",.84,34438.1,2,1,0)
Enter the string that the subject contains.
"KRN",.84,34438.1,2,2,0)
It may be from 3 to 30 characters.
"KRN",.84,34438.1,2,3,0)
The search is NOT case-sensitive.
"KRN",.84,34438.1,5,0)
^.841^1^1
"KRN",.84,34438.1,5,1,0)
XMJMF1
"KRN",.84,34438.1,5,"B","XMJMF1",1)

"KRN",.84,34439,-1)
0^454
"KRN",.84,34439,0)
34439^2^^MAILMAN^Select basket to search: 
"KRN",.84,34439,1,0)
^^1^1^3000829^
"KRN",.84,34439,1,1,0)
There's one blank at the end.
"KRN",.84,34439,2,0)
^^1^1^3000829^
"KRN",.84,34439,2,1,0)
Select basket to search: 
"KRN",.84,34439,5,0)
^.841^1^1
"KRN",.84,34439,5,1,0)
XMJMF1
"KRN",.84,34439,5,"B","XMJMF1",1)

"KRN",.84,34440,-1)
0^455
"KRN",.84,34440,0)
34440^2^^MAILMAN^Message from
"KRN",.84,34440,2,0)
^^1^1^3000829^
"KRN",.84,34440,2,1,0)
Message from
"KRN",.84,34440,5,0)
^.841^1^1
"KRN",.84,34440,5,1,0)
XMJMF1
"KRN",.84,34440,5,"B","XMJMF1",1)

"KRN",.84,34440.1,-1)
0^456
"KRN",.84,34440.1,0)
34440.1^2^^MAILMAN^Response from
"KRN",.84,34440.1,2,0)
^^1^1^3000829^
"KRN",.84,34440.1,2,1,0)
Response from
"KRN",.84,34440.1,5,0)
^.841^1^1
"KRN",.84,34440.1,5,1,0)
XMJMF1
"KRN",.84,34440.1,5,"B","XMJMF1",1)

"KRN",.84,34440.2,-1)
0^457
"KRN",.84,34440.2,0)
34440.2^2^^MAILMAN^Message to
"KRN",.84,34440.2,2,0)
^^1^1^3000829^
"KRN",.84,34440.2,2,1,0)
Message to
"KRN",.84,34440.2,5,0)
^.841^1^1
"KRN",.84,34440.2,5,1,0)
XMJMF1
"KRN",.84,34440.2,5,"B","XMJMF1",1)

"KRN",.84,34441,-1)
0^458
"KRN",.84,34441,0)
34441^3^^MAILMAN^Enter the name of the person who sent
"KRN",.84,34441,2,0)
^^1^1^3000829^
"KRN",.84,34441,2,1,0)
Enter the name of the person who sent the message.
"KRN",.84,34441,5,0)
^.841^1^1
"KRN",.84,34441,5,1,0)
XMJMF1
"KRN",.84,34441,5,"B","XMJMF1",1)

"KRN",.84,34441.1,-1)
0^459
"KRN",.84,34441.1,0)
34441.1^3^^MAILMAN^Enter the name of the person who sent
"KRN",.84,34441.1,2,0)
^.844^1^1^3010301^^
"KRN",.84,34441.1,2,1,0)
Enter the name of the person who sent the response.
"KRN",.84,34441.1,5,0)
^.841^1^1
"KRN",.84,34441.1,5,1,0)
XMJMF1
"KRN",.84,34441.1,5,"B","XMJMF1",1)

"KRN",.84,34441.2,-1)
0^460
"KRN",.84,34441.2,0)
34441.2^3^^MAILMAN^Enter the message addressee.  It may be
"KRN",.84,34441.2,2,0)
^^1^1^3000829^
"KRN",.84,34441.2,2,1,0)
Enter the message addressee.  It may be a person, group, device, or server.
"KRN",.84,34441.2,5,0)
^.841^1^1
"KRN",.84,34441.2,5,1,0)
XMJMF1
"KRN",.84,34441.2,5,"B","XMJMF1",1)

"KRN",.84,34441.3,-1)
0^461
"KRN",.84,34441.3,0)
34441.3^3^^MAILMAN^If it's from a VistA package/fake sender,
"KRN",.84,34441.3,2,0)
^^2^2^3010301^
"KRN",.84,34441.3,2,1,0)
If it's from a local VistA package/fake sender, just put '@' after
"KRN",.84,34441.3,2,2,0)
the sender, like ACCOUNTS RECEIVABLE@
"KRN",.84,34441.3,5,0)
^.841^1^1
"KRN",.84,34441.3,5,1,0)
XMJMF2
"KRN",.84,34441.3,5,"B","XMJMF2",1)

"KRN",.84,34442,-1)
0^462
"KRN",.84,34442,0)
34442^3^^MAILMAN^For remote users, enter name@, name@domain
"KRN",.84,34442,2,0)
^.844^6^6^3010301^^
"KRN",.84,34442,2,1,0)
For remote users, enter name@, name@domain, or @domain.
"KRN",.84,34442,2,2,0)
'Name' must be found somewhere in the user's name.
"KRN",.84,34442,2,3,0)
'Domain' must be found somewhere in the user's domain.
"KRN",.84,34442,2,4,0)
The more characters you provide, the narrower the search will be.
"KRN",.84,34442,2,5,0)
 
"KRN",.84,34442,2,6,0)
MailMan may capitalize some names to facilitate filtering.
"KRN",.84,34442,5,0)
^.841^1^1
"KRN",.84,34442,5,1,0)
XMJMF1
"KRN",.84,34442,5,"B","XMJMF1",1)

"KRN",.84,34444,-1)
0^465
"KRN",.84,34444,0)
34444^2^^MAILMAN^Message sent on or after
"KRN",.84,34444,2,0)
^^1^1^3000829^
"KRN",.84,34444,2,1,0)
Message sent on or after
"KRN",.84,34444,5,0)
^.841^1^1
"KRN",.84,34444,5,1,0)
XMJMF1
"KRN",.84,34444,5,"B","XMJMF1",1)

"KRN",.84,34444.1,-1)
0^466
"KRN",.84,34444.1,0)
34444.1^3^^MAILMAN^Enter a date.  It must include day, month,
"KRN",.84,34444.1,2,0)
^^1^1^3000829^
"KRN",.84,34444.1,2,1,0)
Enter a date.  It must include day, month, and year.
"KRN",.84,34444.1,5,0)
^.841^1^1
"KRN",.84,34444.1,5,1,0)
XMJMF1
"KRN",.84,34444.1,5,"B","XMJMF1",1)

"KRN",.84,34444.5,-1)
0^1444
"KRN",.84,34444.5,0)
34444.5^1^^MAILMAN^This search requires a date range.
"KRN",.84,34444.5,2,0)
^^2^2^3020712^
"KRN",.84,34444.5,2,1,0)
This search requires a date range.
"KRN",.84,34444.5,2,2,0)
You may change the dates, but you may not delete them.
"KRN",.84,34444.5,5,0)
^.841^1^1
"KRN",.84,34444.5,5,1,0)
XMJMF
"KRN",.84,34444.5,5,"B","XMJMF",1)

"KRN",.84,34445,-1)
0^467
"KRN",.84,34445,0)
34445^2^^MAILMAN^Message sent on or before
"KRN",.84,34445,2,0)
^^1^1^3000829^
"KRN",.84,34445,2,1,0)
Message sent on or before
"KRN",.84,34445,5,0)
^.841^1^1
"KRN",.84,34445,5,1,0)
XMJMF1
"KRN",.84,34445,5,"B","XMJMF1",1)

"KRN",.84,34446.1,-1)
0^468
"KRN",.84,34446.1,0)
34446.1^2^^MAILMAN^Message contains
"KRN",.84,34446.1,2,0)
^^1^1^3000829^
"KRN",.84,34446.1,2,1,0)
Message contains
"KRN",.84,34446.1,5,0)
^.841^1^1
"KRN",.84,34446.1,5,1,0)
XMJMF1
"KRN",.84,34446.1,5,"B","XMJMF1",1)

"KRN",.84,34446.2,-1)
0^469
"KRN",.84,34446.2,0)
34446.2^2^^MAILMAN^Message or Response contains
"KRN",.84,34446.2,2,0)
^^1^1^3000829^
"KRN",.84,34446.2,2,1,0)
Message or Response contains
"KRN",.84,34446.2,5,0)
^.841^1^1
"KRN",.84,34446.2,5,1,0)
XMJMF1
"KRN",.84,34446.2,5,"B","XMJMF1",1)

"KRN",.84,34446.3,-1)
0^470
"KRN",.84,34446.3,0)
34446.3^2^^MAILMAN^Response contains
"KRN",.84,34446.3,2,0)
^^1^1^3000829^
"KRN",.84,34446.3,2,1,0)
Response contains
"KRN",.84,34446.3,5,0)
^.841^1^1
"KRN",.84,34446.3,5,1,0)
XMJMF1
"KRN",.84,34446.3,5,"B","XMJMF1",1)

"KRN",.84,34446.4,-1)
0^471
"KRN",.84,34446.4,0)
34446.4^3^^MAILMAN^Enter the string to search for.
"KRN",.84,34446.4,2,0)
^^3^3^3000829^
"KRN",.84,34446.4,2,1,0)
Enter the string to search for.  It may be from 3 to 30 characters.
"KRN",.84,34446.4,2,2,0)
Note that if the string you are searching for is not all on one line
"KRN",.84,34446.4,2,3,0)
in the message, the search will not be able to find it.
"KRN",.84,34446.4,5,0)
^.841^1^1
"KRN",.84,34446.4,5,1,0)
XMJMF1
"KRN",.84,34446.4,5,"B","XMJMF1",1)

"KRN",.84,34447,-1)
0^472
"KRN",.84,34447,0)
34447^2^^MAILMAN^Should the search be case-sensitive
"KRN",.84,34447,2,0)
^^1^1^3000829^
"KRN",.84,34447,2,1,0)
Should the search be case-sensitive
"KRN",.84,34447,5,0)
^.841^1^1
"KRN",.84,34447,5,1,0)
XMJMF1
"KRN",.84,34447,5,"B","XMJMF1",1)

"KRN",.84,34447.1,-1)
0^473
"KRN",.84,34447.1,0)
34447.1^3^^MAILMAN^Your answer determines whether case (upper
"KRN",.84,34447.1,2,0)
^^7^7^3000829^
"KRN",.84,34447.1,2,1,0)
Your answer determines whether case (upper/lower) matters in the search.
"KRN",.84,34447.1,2,2,0)
It also affects the speed of the search.
"KRN",.84,34447.1,2,3,0)
A case-sensitive search (one in which case matters) is faster.
"KRN",.84,34447.1,2,4,0)
A case-insensitive search (one in which case does not matter) is slower,
"KRN",.84,34447.1,2,5,0)
but may find more matches.
"KRN",.84,34447.1,2,6,0)
Answer 'yes' for a faster search, when case matters.
"KRN",.84,34447.1,2,7,0)
Answer 'no' for a slower search, when case does not matter.
"KRN",.84,34447.1,5,0)
^.841^1^1
"KRN",.84,34447.1,5,1,0)
XMJMF1
"KRN",.84,34447.1,5,"B","XMJMF1",1)

"KRN",.84,34448,-1)
0^474
"KRN",.84,34448,0)
34448^2^^MAILMAN^Where should we search
"KRN",.84,34448,2,0)
^^1^1^3000829^
"KRN",.84,34448,2,1,0)
Where should we search
"KRN",.84,34448,5,0)
^.841^1^1
"KRN",.84,34448,5,1,0)
XMJMF1
"KRN",.84,34448,5,"B","XMJMF1",1)

"KRN",.84,34448.1,-1)
0^475
"KRN",.84,34448.1,0)
34448.1^2^^MAILMAN^Message only
"KRN",.84,34448.1,2,0)
^^1^1^3000829^
"KRN",.84,34448.1,2,1,0)
Message only
"KRN",.84,34448.1,5,0)
^.841^1^1
"KRN",.84,34448.1,5,1,0)
XMJMF1
"KRN",.84,34448.1,5,"B","XMJMF1",1)

"KRN",.84,34448.2,-1)
0^476
"KRN",.84,34448.2,0)
34448.2^2^^MAILMAN^Message and Responses
"KRN",.84,34448.2,2,0)
^^1^1^3000829^
"KRN",.84,34448.2,2,1,0)
Message and Responses
"KRN",.84,34448.2,5,0)
^.841^1^1
"KRN",.84,34448.2,5,1,0)
XMJMF1
"KRN",.84,34448.2,5,"B","XMJMF1",1)

"KRN",.84,34448.3,-1)
0^477
"KRN",.84,34448.3,0)
34448.3^2^^MAILMAN^Responses only
"KRN",.84,34448.3,2,0)
^^1^1^3000829^
"KRN",.84,34448.3,2,1,0)
Responses only
"KRN",.84,34448.3,5,0)
^.841^1^1
"KRN",.84,34448.3,5,1,0)
XMJMF1
"KRN",.84,34448.3,5,"B","XMJMF1",1)

"KRN",.84,34449,-1)
0^478
"KRN",.84,34449,0)
34449^2^^MAILMAN^Lines of text, minimum
"KRN",.84,34449,2,0)
^^1^1^3000831^
"KRN",.84,34449,2,1,0)
Lines of text, minimum
"KRN",.84,34449,5,0)
^.841^1^1
"KRN",.84,34449,5,1,0)
XMJMF1
"KRN",.84,34449,5,"B","XMJMF1",1)

"KRN",.84,34449.1,-1)
0^479
"KRN",.84,34449.1,0)
34449.1^3^^MAILMAN^Enter a number from 100 to 100,000.
"KRN",.84,34449.1,2,0)
^.844^3^3^3000831^^^
"KRN",.84,34449.1,2,1,0)
Enter a number from 100 to 100,000.
"KRN",.84,34449.1,2,2,0)
We will find all messages with that many lines of text or more.
"KRN",.84,34449.1,2,3,0)
We won't look at responses.
"KRN",.84,34449.1,5,0)
^.841^1^1
"KRN",.84,34449.1,5,1,0)
XMJMF1
"KRN",.84,34449.1,5,"B","XMJMF1",1)

"KRN",.84,34450,-1)
0^480
"KRN",.84,34450,0)
34450^2^^MAILMAN^Lines of text, maximum
"KRN",.84,34450,2,0)
^^1^1^3000831^
"KRN",.84,34450,2,1,0)
Lines of text, maximum
"KRN",.84,34450,5,0)
^.841^1^1
"KRN",.84,34450,5,1,0)
XMJMF1
"KRN",.84,34450,5,"B","XMJMF1",1)

"KRN",.84,34450.1,-1)
0^481
"KRN",.84,34450.1,0)
34450.1^3^^MAILMAN^Enter a number from 100 to 100,000.
"KRN",.84,34450.1,2,0)
^^2^2^3000831^
"KRN",.84,34450.1,2,1,0)
Enter a number from 100 to 100,000.
"KRN",.84,34450.1,2,2,0)
We will find all messages with that many lines of text or less.
"KRN",.84,34450.1,5,0)
^.841^1^1
"KRN",.84,34450.1,5,1,0)
XMJMF1
"KRN",.84,34450.1,5,"B","XMJMF1",1)

"KRN",.84,34500,-1)
0^482
"KRN",.84,34500,0)
34500^2^^MAILMAN^Print
"KRN",.84,34500,2,0)
^^1^1^3000103^
"KRN",.84,34500,2,1,0)
Print
"KRN",.84,34500,5,0)
^.841^1^1
"KRN",.84,34500,5,1,0)
XMJMP
"KRN",.84,34500,5,"B","XMJMP",1)

"KRN",.84,34501,-1)
0^483
"KRN",.84,34501,0)
34501^2^^MAILMAN^MailMan: Print
"KRN",.84,34501,2,0)
^^1^1^3000103^
"KRN",.84,34501,2,1,0)
MailMan: Print
"KRN",.84,34501,5,0)
^.841^1^1
"KRN",.84,34501,5,1,0)
XMJMP
"KRN",.84,34501,5,"B","XMJMP",1)

"KRN",.84,34501.1,-1)
0^484
"KRN",.84,34501.1,0)
34501.1^2^y^MAILMAN^Request queued.  Task number: |1|
"KRN",.84,34501.1,2,0)
^^1^1^3000810^
"KRN",.84,34501.1,2,1,0)
Request queued.  Task number: |1|
"KRN",.84,34501.1,3,0)
^.845^1^1
"KRN",.84,34501.1,3,1,0)
1^task number
"KRN",.84,34501.1,5,0)
^.841^1^1
"KRN",.84,34501.1,5,1,0)
XMJMP
"KRN",.84,34501.1,5,"B","XMJMP",1)

"KRN",.84,34502,-1)
0^485
"KRN",.84,34502,0)
34502^2^y^MAILMAN^MailMan message for |1|
"KRN",.84,34502,2,0)
^^1^1^3000103^
"KRN",.84,34502,2,1,0)
MailMan message for |1|
"KRN",.84,34502,3,0)
^.845^1^1
"KRN",.84,34502,3,1,0)
1^user name
"KRN",.84,34502,5,0)
^.841^1^1
"KRN",.84,34502,5,1,0)
XMJMP
"KRN",.84,34502,5,"B","XMJMP",1)

"KRN",.84,34503,-1)
0^486
"KRN",.84,34503,0)
34503^2^y^MAILMAN^Printed at |1|  |2|
"KRN",.84,34503,2,0)
^^1^1^3000103^
"KRN",.84,34503,2,1,0)
Printed at |1|  |2|
"KRN",.84,34503,3,0)
^.845^2^2
"KRN",.84,34503,3,1,0)
1^site name
"KRN",.84,34503,3,2,0)
2^current date/time
"KRN",.84,34503,5,0)
^.841^1^1
"KRN",.84,34503,5,1,0)
XMJMP
"KRN",.84,34503,5,"B","XMJMP",1)

"KRN",.84,34504,-1)
0^487
"KRN",.84,34504,0)
34504^2^^MAILMAN^Print recipient list
"KRN",.84,34504,2,0)
^^1^1^3000103^
"KRN",.84,34504,2,1,0)
Print recipient list
"KRN",.84,34504,5,0)
^.841^1^1
"KRN",.84,34504,5,1,0)
XMJMP
"KRN",.84,34504,5,"B","XMJMP",1)

"KRN",.84,34505,-1)
0^488
"KRN",.84,34505,0)
34505^3^^MAILMAN^Answer 'Yes' if you want the recipients
"KRN",.84,34505,2,0)
^^1^1^3000103^
"KRN",.84,34505,2,1,0)
Answer 'Yes' if you want the recipients printed at the end.
"KRN",.84,34505,5,0)
^.841^1^1
"KRN",.84,34505,5,1,0)
XMJMP
"KRN",.84,34505,5,"B","XMJMP",1)

"KRN",.84,34506,-1)
0^489
"KRN",.84,34506,0)
34506^2^^MAILMAN^D:Detail
"KRN",.84,34506,2,0)
^^1^1^3000103^^
"KRN",.84,34506,2,1,0)
D:Detail
"KRN",.84,34506,5,0)
^.841^1^1
"KRN",.84,34506,5,1,0)
XMJMP
"KRN",.84,34506,5,"B","XMJMP",1)

"KRN",.84,34507,-1)
0^490
"KRN",.84,34507,0)
34507^2^^MAILMAN^S:Summary
"KRN",.84,34507,2,0)
^^1^1^3000103^
"KRN",.84,34507,2,1,0)
S:Summary
"KRN",.84,34507,5,0)
^.841^1^1
"KRN",.84,34507,5,1,0)
XMJMP
"KRN",.84,34507,5,"B","XMJMP",1)

"KRN",.84,34508,-1)
0^491
"KRN",.84,34508,0)
34508^2^^MAILMAN^Print Detail or Summary recipient chain
"KRN",.84,34508,2,0)
^^1^1^3000103^
"KRN",.84,34508,2,1,0)
Print Detail or Summary recipient chain
"KRN",.84,34508,5,0)
^.841^1^1
"KRN",.84,34508,5,1,0)
XMJMP
"KRN",.84,34508,5,"B","XMJMP",1)

"KRN",.84,34509,-1)
0^492
"KRN",.84,34509,0)
34509^2^^MAILMAN^You are at the end of this message.  Enter
"KRN",.84,34509,2,0)
^^1^1^3000525^
"KRN",.84,34509,2,1,0)
You are at the end of this message.  Enter 'B' to Backup and review it.
"KRN",.84,34509,5,0)
^.841^1^1
"KRN",.84,34509,5,1,0)
XMJMP
"KRN",.84,34509,5,"B","XMJMP",1)

"KRN",.84,34510,-1)
0^493
"KRN",.84,34510,0)
34510^2^y^MAILMAN^>> You haven't read responses |1|-|2|.
"KRN",.84,34510,2,0)
^^1^1^3000103^
"KRN",.84,34510,2,1,0)
>> You haven't read responses |1|-|2|.  You may backup to see them. <<
"KRN",.84,34510,3,0)
^.845^2^2
"KRN",.84,34510,3,1,0)
1^first response not read
"KRN",.84,34510,3,2,0)
2^last response not read
"KRN",.84,34510,5,0)
^.841^1^1
"KRN",.84,34510,5,1,0)
XMJMP
"KRN",.84,34510,5,"B","XMJMP",1)

"KRN",.84,34511,-1)
0^494
"KRN",.84,34511,0)
34511^2^y^MAILMAN^>> You haven't read response |1|.  You may
"KRN",.84,34511,2,0)
^^1^1^3000103^
"KRN",.84,34511,2,1,0)
>> You haven't read response |1|.  You may backup to see it. <<
"KRN",.84,34511,3,0)
^.845^1^1
"KRN",.84,34511,3,1,0)
1^response not read
"KRN",.84,34511,5,0)
^.841^1^1
"KRN",.84,34511,5,1,0)
XMJMP
"KRN",.84,34511,5,"B","XMJMP",1)

"KRN",.84,34512,-1)
0^495
"KRN",.84,34512,0)
34512^2^y^MAILMAN^>> Response |1| has arrived - you may back
"KRN",.84,34512,2,0)
^^1^1^3000103^
"KRN",.84,34512,2,1,0)
>> Response |1| has arrived - you may backup to see it. <<
"KRN",.84,34512,3,0)
^.845^1^1
"KRN",.84,34512,3,1,0)
1^latest response
"KRN",.84,34512,5,0)
^.841^1^1
"KRN",.84,34512,5,1,0)
XMJMP
"KRN",.84,34512,5,"B","XMJMP",1)

"KRN",.84,34513,-1)
0^496
"KRN",.84,34513,0)
34513^2^^MAILMAN^Backup to
"KRN",.84,34513,2,0)
^.844^1^1^3000814^^
"KRN",.84,34513,2,1,0)
Backup to
"KRN",.84,34513,5,0)
^.841^1^1
"KRN",.84,34513,5,1,0)
XMJMP
"KRN",.84,34513,5,"B","XMJMP",1)

"KRN",.84,34514,-1)
0^497
"KRN",.84,34514,0)
34514^2^y^MAILMAN^There is 1 response.  Response 0 is the
"KRN",.84,34514,2,0)
^^1^1^3000104^^^^
"KRN",.84,34514,2,1,0)
There is 1 response.  Response 0 is the original message.  (?? shows index)
"KRN",.84,34514,3,0)
^.845^1^1
"KRN",.84,34514,3,1,0)
1^prompt
"KRN",.84,34514,5,0)
^.841^1^1
"KRN",.84,34514,5,1,0)
XMJMP
"KRN",.84,34514,5,"B","XMJMP",1)

"KRN",.84,34515,-1)
0^498
"KRN",.84,34515,0)
34515^2^y^MAILMAN^There are |1| responses.  Response 0 is
"KRN",.84,34515,2,0)
^^1^1^3000104^^^
"KRN",.84,34515,2,1,0)
There are |1| responses.  Response 0 is the original message.  (?? shows index)
"KRN",.84,34515,3,0)
^.845^1^1
"KRN",.84,34515,3,1,0)
1^number of responses
"KRN",.84,34515,5,0)
^.841^1^1
"KRN",.84,34515,5,1,0)
XMJMP
"KRN",.84,34515,5,"B","XMJMP",1)

"KRN",.84,34516,-1)
0^499
"KRN",.84,34516,0)
34516^2^y^MAILMAN^Select the responses to |1|: 
"KRN",.84,34516,1,0)
^^1^1^3000103^^
"KRN",.84,34516,1,1,0)
Note: there is one blank at the end of this dialog.
"KRN",.84,34516,2,0)
^^1^1^3000103^^
"KRN",.84,34516,2,1,0)
Select the responses to |1|: 
"KRN",.84,34516,3,0)
^.845^1^1
"KRN",.84,34516,3,1,0)
1^prompt
"KRN",.84,34516,5,0)
^.841^1^1
"KRN",.84,34516,5,1,0)
XMJMP
"KRN",.84,34516,5,"B","XMJMP",1)

"KRN",.84,34518,-1)
0^500
"KRN",.84,34518,0)
34518^2^^MAILMAN^Backup to: 
"KRN",.84,34518,1,0)
^.842^1^1^3000814^^
"KRN",.84,34518,1,1,0)
Note: there is one blank at the end of this dialog.
"KRN",.84,34518,2,0)
^.844^1^1^3000814^^
"KRN",.84,34518,2,1,0)
Backup to: 
"KRN",.84,34518,3,0)
^.845^^0
"KRN",.84,34518,5,0)
^.841^1^1
"KRN",.84,34518,5,1,0)
XMJMP1
"KRN",.84,34518,5,"B","XMJMP1",1)

"KRN",.84,34519,-1)
0^501
"KRN",.84,34519,0)
34519^2^^MAILMAN^Backup to: Original message  
"KRN",.84,34519,1,0)
^.842^1^1^3000814^^^^
"KRN",.84,34519,1,1,0)
Note: there are two blanks at the end of this dialog.
"KRN",.84,34519,2,0)
^.844^1^1^3000814^^^
"KRN",.84,34519,2,1,0)
Backup to: Original message  
"KRN",.84,34519,3,0)
^.845^^0
"KRN",.84,34519,5,0)
^.841^1^1
"KRN",.84,34519,5,1,0)
XMJMP1
"KRN",.84,34519,5,"B","XMJMP1",1)

"KRN",.84,34520,-1)
0^502
"KRN",.84,34520,0)
34520^3^^MAILMAN^If you select 0, you will Backup to
"KRN",.84,34520,2,0)
^.844^2^2^3000814^^
"KRN",.84,34520,2,1,0)
If you select 0, you will Backup to the original message.
"KRN",.84,34520,2,2,0)
If you select one of the responses, you will Backup to it.
"KRN",.84,34520,3,0)
^.845^^0
"KRN",.84,34520,5,0)
^.841^1^1
"KRN",.84,34520,5,1,0)
XMJMP1
"KRN",.84,34520,5,"B","XMJMP1",1)

"KRN",.84,34521,-1)
0^503
"KRN",.84,34521,0)
34521^2^^MAILMAN^This message has been secured with a pass
"KRN",.84,34521,2,0)
^^4^4^3000103^
"KRN",.84,34521,2,1,0)
This message has been secured with a password.
"KRN",.84,34521,2,2,0)
When a range of messages is queued to print,
"KRN",.84,34521,2,3,0)
those messages with passwords cannot be printed,
"KRN",.84,34521,2,4,0)
because there is no opportunity to ask for the password.
"KRN",.84,34521,5,0)
^.841^1^1
"KRN",.84,34521,5,1,0)
XMJMP
"KRN",.84,34521,5,"B","XMJMP",1)

"KRN",.84,34530,-1)
0^504
"KRN",.84,34530,0)
34530^2^^MAILMAN^There is 1 response.  Response 0 is the
"KRN",.84,34530,2,0)
^^1^1^3000104^
"KRN",.84,34530,2,1,0)
There is 1 response.  Response 0 is the original message.
"KRN",.84,34530,5,0)
^.841^1^1
"KRN",.84,34530,5,1,0)
XMJMP1
"KRN",.84,34530,5,"B","XMJMP1",1)

"KRN",.84,34531,-1)
0^505
"KRN",.84,34531,0)
34531^2^y^MAILMAN^There are |1| responses.  Response 0 is
"KRN",.84,34531,2,0)
^^1^1^3000104^
"KRN",.84,34531,2,1,0)
There are |1| responses.  Response 0 is the original message.
"KRN",.84,34531,3,0)
^.845^1^1
"KRN",.84,34531,3,1,0)
1^number of responses
"KRN",.84,34531,5,0)
^.841^1^1
"KRN",.84,34531,5,1,0)
XMJMP1
"KRN",.84,34531,5,"B","XMJMP1",1)

"KRN",.84,34532,-1)
0^506
"KRN",.84,34532,0)
34532^2^^MAILMAN^Response
"KRN",.84,34532,2,0)
^^1^1^3000104^
"KRN",.84,34532,2,1,0)
Response
"KRN",.84,34532,5,0)
^.841^1^1
"KRN",.84,34532,5,1,0)
XMJMP1
"KRN",.84,34532,5,"B","XMJMP1",1)

"KRN",.84,34533,-1)
0^507
"KRN",.84,34533,0)
34533^2^y^MAILMAN^(Sender: |1|)
"KRN",.84,34533,2,0)
^^1^1^3000104^
"KRN",.84,34533,2,1,0)
(Sender: |1|)
"KRN",.84,34533,3,0)
^.845^1^1
"KRN",.84,34533,3,1,0)
1^message sender
"KRN",.84,34533,5,0)
^.841^1^1
"KRN",.84,34533,5,1,0)
XMJMP1
"KRN",.84,34533,5,"B","XMJMP1",1)

"KRN",.84,34534,-1)
0^508
"KRN",.84,34534,0)
34534^2^y^MAILMAN^|1| lines
"KRN",.84,34534,2,0)
^^1^1^3000106^^^^
"KRN",.84,34534,2,1,0)
|1| lines
"KRN",.84,34534,3,0)
^.845^1^1
"KRN",.84,34534,3,1,0)
1^number of lines
"KRN",.84,34534,5,0)
^.841^1^1
"KRN",.84,34534,5,1,0)
XMJMP1
"KRN",.84,34534,5,"B","XMJMP1",1)

"KRN",.84,34534.1,-1)
0^509
"KRN",.84,34534.1,0)
34534.1^2^^MAILMAN^1 line
"KRN",.84,34534.1,2,0)
^^1^1^3000106^^^
"KRN",.84,34534.1,2,1,0)
1 line
"KRN",.84,34534.1,3,0)
^.845^^0
"KRN",.84,34534.1,5,0)
^.841^1^1
"KRN",.84,34534.1,5,1,0)
XMJMP1
"KRN",.84,34534.1,5,"B","XMJMP1",1)

"KRN",.84,34535,-1)
0^510
"KRN",.84,34535,0)
34535^2^^MAILMAN^<Local Reply>
"KRN",.84,34535,2,0)
^^1^1^3000605^
"KRN",.84,34535,2,1,0)
<Local Reply>
"KRN",.84,34535,5,0)
^.841^1^1
"KRN",.84,34535,5,1,0)
XMJMP1
"KRN",.84,34535,5,"B","XMJMP1",1)

"KRN",.84,34536,-1)
0^511
"KRN",.84,34536,0)
34536^2^y^MAILMAN^Subj: |1|
"KRN",.84,34536,2,0)
^^1^1^3000104^
"KRN",.84,34536,2,1,0)
Subj: |1|
"KRN",.84,34536,3,0)
^.845^1^1
"KRN",.84,34536,3,1,0)
1^message subject
"KRN",.84,34536,5,0)
^.841^3^3
"KRN",.84,34536,5,1,0)
XMJMP1
"KRN",.84,34536,5,2,0)
XMJMP2
"KRN",.84,34536,5,3,0)
XMJMQ
"KRN",.84,34536,5,"B","XMJMP1",1)

"KRN",.84,34536,5,"B","XMJMP2",2)

"KRN",.84,34536,5,"B","XMJMQ",3)

"KRN",.84,34537,-1)
0^512
"KRN",.84,34537,0)
34537^2^y^MAILMAN^[#|1|]
"KRN",.84,34537,2,0)
^^1^1^3000104^
"KRN",.84,34537,2,1,0)
[#|1|]
"KRN",.84,34537,3,0)
^.845^1^1
"KRN",.84,34537,3,1,0)
1^message ien in message file
"KRN",.84,34537,5,0)
^.841^4^4
"KRN",.84,34537,5,1,0)
XMJMP1
"KRN",.84,34537,5,2,0)
XMJMP2
"KRN",.84,34537,5,3,0)
XMJMQ
"KRN",.84,34537,5,4,0)
XMJMC
"KRN",.84,34537,5,"B","XMJMC",4)

"KRN",.84,34537,5,"B","XMJMP1",1)

"KRN",.84,34537,5,"B","XMJMP2",2)

"KRN",.84,34537,5,"B","XMJMQ",3)

"KRN",.84,34538,-1)
0^513
"KRN",.84,34538,0)
34538^2^y^MAILMAN^From: |1|
"KRN",.84,34538,2,0)
^^1^1^3000104^
"KRN",.84,34538,2,1,0)
From: |1|
"KRN",.84,34538,3,0)
^.845^1^1
"KRN",.84,34538,3,1,0)
1^message from
"KRN",.84,34538,5,0)
^.841^3^3
"KRN",.84,34538,5,1,0)
XMJMP1
"KRN",.84,34538,5,2,0)
XMJMP2
"KRN",.84,34538,5,3,0)
XMJMC
"KRN",.84,34538,5,"B","XMJMC",3)

"KRN",.84,34538,5,"B","XMJMP1",1)

"KRN",.84,34538,5,"B","XMJMP2",2)

"KRN",.84,34539,-1)
0^514
"KRN",.84,34539,0)
34539^2^y^MAILMAN^In '|1|' basket.
"KRN",.84,34539,2,0)
^^1^1^3000104^
"KRN",.84,34539,2,1,0)
In '|1|' basket.
"KRN",.84,34539,3,0)
^.845^1^1
"KRN",.84,34539,3,1,0)
1^basket name
"KRN",.84,34539,5,0)
^.841^1^1
"KRN",.84,34539,5,1,0)
XMJMP1
"KRN",.84,34539,5,"B","XMJMP1",1)

"KRN",.84,34540,-1)
0^515
"KRN",.84,34540,0)
34540^2^^MAILMAN^>> Confirmation message sent to sender. <<
"KRN",.84,34540,2,0)
^^1^1^3000104^
"KRN",.84,34540,2,1,0)
>> Confirmation message sent to sender. <<
"KRN",.84,34540,5,0)
^.841^1^1
"KRN",.84,34540,5,1,0)
XMJMP1
"KRN",.84,34540,5,"B","XMJMP1",1)

"KRN",.84,34541,-1)
0^516
"KRN",.84,34541,0)
34541^2^^MAILMAN^Page 1
"KRN",.84,34541,2,0)
^^1^1^3000104^
"KRN",.84,34541,2,1,0)
Page 1
"KRN",.84,34541,5,0)
^.841^1^1
"KRN",.84,34541,5,1,0)
XMJMP1
"KRN",.84,34541,5,"B","XMJMP1",1)

"KRN",.84,34542,-1)
0^517
"KRN",.84,34542,0)
34542^2^y^MAILMAN^Page |1|
"KRN",.84,34542,2,0)
^^1^1^3000104^
"KRN",.84,34542,2,1,0)
Page |1|
"KRN",.84,34542,3,0)
^.845^1^1
"KRN",.84,34542,3,1,0)
1^page number
"KRN",.84,34542,5,0)
^.841^3^3
"KRN",.84,34542,5,1,0)
XMJMP1
"KRN",.84,34542,5,2,0)
XMJMD
"KRN",.84,34542,5,3,0)
XMUT2
"KRN",.84,34542,5,"B","XMJMD",2)

"KRN",.84,34542,5,"B","XMJMP1",1)

"KRN",.84,34542,5,"B","XMUT2",3)

"KRN",.84,34543,-1)
0^518
"KRN",.84,34543,0)
34543^2^^MAILMAN^Priority!
"KRN",.84,34543,2,0)
^^1^1^3000104^
"KRN",.84,34543,2,1,0)
Priority!
"KRN",.84,34543,5,0)
^.841^2^2
"KRN",.84,34543,5,1,0)
XMJMP1
"KRN",.84,34543,5,2,0)
XMJMQ
"KRN",.84,34543,5,"B","XMJMP1",1)

"KRN",.84,34543,5,"B","XMJMQ",2)

"KRN",.84,34544,-1)
0^519
"KRN",.84,34544,0)
34544^2^^MAILMAN^*New*
"KRN",.84,34544,2,0)
^^1^1^3000104^
"KRN",.84,34544,2,1,0)
*New*
"KRN",.84,34544,5,0)
^.841^1^1
"KRN",.84,34544,5,1,0)
XMJMP1
"KRN",.84,34544,5,"B","XMJMP1",1)

"KRN",.84,34545,-1)
0^520
"KRN",.84,34545,0)
34545^2^y^MAILMAN^|1| of 1 response read.
"KRN",.84,34545,2,0)
^^1^1^3000104^^^
"KRN",.84,34545,2,1,0)
|1| of 1 response read.
"KRN",.84,34545,3,0)
^.845^1^1
"KRN",.84,34545,3,1,0)
1^number of responses read
"KRN",.84,34545,5,0)
^.841^1^1
"KRN",.84,34545,5,1,0)
XMJMP1
"KRN",.84,34545,5,"B","XMJMP1",1)

"KRN",.84,34546,-1)
0^521
"KRN",.84,34546,0)
34546^2^y^MAILMAN^|1| of |2| responses read.
"KRN",.84,34546,2,0)
^^1^1^3000104^
"KRN",.84,34546,2,1,0)
|1| of |2| responses read.
"KRN",.84,34546,3,0)
^.845^2^2
"KRN",.84,34546,3,1,0)
1^number of responses read
"KRN",.84,34546,3,2,0)
2^number of responses
"KRN",.84,34546,5,0)
^.841^1^1
"KRN",.84,34546,5,1,0)
XMJMP1
"KRN",.84,34546,5,"B","XMJMP1",1)

"KRN",.84,34550,-1)
0^522
"KRN",.84,34550,0)
34550^2^^MAILMAN^This message originated locally.  There
"KRN",.84,34550,2,0)
^^1^1^3000104^
"KRN",.84,34550,2,1,0)
This message originated locally.  There is no network header.
"KRN",.84,34550,5,0)
^.841^1^1
"KRN",.84,34550,5,1,0)
XMJMQ1
"KRN",.84,34550,5,"B","XMJMQ1",1)

"KRN",.84,34551,-1)
0^523
"KRN",.84,34551,0)
34551^2^y^MAILMAN^Envelope From:|1|
"KRN",.84,34551,2,0)
^^1^1^3000104^^
"KRN",.84,34551,2,1,0)
Envelope From:|1|
"KRN",.84,34551,3,0)
^.845^1^1
"KRN",.84,34551,3,1,0)
1^message envelope from
"KRN",.84,34551,5,0)
^.841^1^1
"KRN",.84,34551,5,1,0)
XMJMQ1
"KRN",.84,34551,5,"B","XMJMQ1",1)

"KRN",.84,34552,-1)
0^524
"KRN",.84,34552,0)
34552^2^^MAILMAN^Network header:
"KRN",.84,34552,2,0)
^^1^1^3000104^
"KRN",.84,34552,2,1,0)
Network header:
"KRN",.84,34552,5,0)
^.841^1^1
"KRN",.84,34552,5,1,0)
XMJMQ1
"KRN",.84,34552,5,"B","XMJMQ1",1)

"KRN",.84,34554,-1)
0^525
"KRN",.84,34554,0)
34554^2^y^MAILMAN^Searching for recipients that match '|1|'.
"KRN",.84,34554,2,0)
^^1^1^3000104^^
"KRN",.84,34554,2,1,0)
Searching for recipients that match '|1|'.
"KRN",.84,34554,3,0)
^.845^1^1
"KRN",.84,34554,3,1,0)
1^search string
"KRN",.84,34554,5,0)
^.841^1^1
"KRN",.84,34554,5,1,0)
XMJMQ1
"KRN",.84,34554,5,"B","XMJMQ1",1)

"KRN",.84,34555,-1)
0^526
"KRN",.84,34555,0)
34555^2^^MAILMAN^Enter the person's name or partial name
"KRN",.84,34555,2,0)
^^1^1^3000104^
"KRN",.84,34555,2,1,0)
Enter the person's name or partial name
"KRN",.84,34555,5,0)
^.841^1^1
"KRN",.84,34555,5,1,0)
XMJMQ
"KRN",.84,34555,5,"B","XMJMQ",1)

"KRN",.84,34556,-1)
0^527
"KRN",.84,34556,0)
34556^3^^MAILMAN^Name must be from 1 to 30 characters,
"KRN",.84,34556,2,0)
^^2^2^3000104^
"KRN",.84,34556,2,1,0)
Name must be from 1 to 30 characters,
"KRN",.84,34556,2,2,0)
and must not contain ^, or begin with comma or space.
"KRN",.84,34556,5,0)
^.841^1^1
"KRN",.84,34556,5,1,0)
XMJMQ
"KRN",.84,34556,5,"B","XMJMQ",1)

"KRN",.84,34557,-1)
0^528
"KRN",.84,34557,0)
34557^2^y^MAILMAN^|1| responses
"KRN",.84,34557,2,0)
^^1^1^3000106^^
"KRN",.84,34557,2,1,0)
|1| responses
"KRN",.84,34557,3,0)
^.845^1^1
"KRN",.84,34557,3,1,0)
1^number of responses
"KRN",.84,34557,5,0)
^.841^1^1
"KRN",.84,34557,5,1,0)
XMJMQ
"KRN",.84,34557,5,"B","XMJMQ",1)

"KRN",.84,34557.1,-1)
0^529
"KRN",.84,34557.1,0)
34557.1^2^^MAILMAN^1 response
"KRN",.84,34557.1,2,0)
^^1^1^3000106^
"KRN",.84,34557.1,2,1,0)
1 response
"KRN",.84,34557.1,5,0)
^.841^1^1
"KRN",.84,34557.1,5,1,0)
XMJMQ
"KRN",.84,34557.1,5,"B","XMJMQ",1)

"KRN",.84,34559,-1)
0^530
"KRN",.84,34559,0)
34559^2^y^MAILMAN^Local Message-ID: |1|
"KRN",.84,34559,2,0)
^^1^1^3000104^
"KRN",.84,34559,2,1,0)
Local Message-ID: |1|
"KRN",.84,34559,3,0)
^.845^1^1
"KRN",.84,34559,3,1,0)
1^local message id
"KRN",.84,34559,5,0)
^.841^1^1
"KRN",.84,34559,5,1,0)
XMJMQ
"KRN",.84,34559,5,"B","XMJMQ",1)

"KRN",.84,34560,-1)
0^531
"KRN",.84,34560,0)
34560^2^^MAILMAN^[SPOOL]
"KRN",.84,34560,2,0)
^^1^1^3000104^
"KRN",.84,34560,2,1,0)
[SPOOL]
"KRN",.84,34560,5,0)
^.841^1^1
"KRN",.84,34560,5,1,0)
XMJMQ
"KRN",.84,34560,5,"B","XMJMQ",1)

"KRN",.84,34561,-1)
0^532
"KRN",.84,34561,0)
34561^2^^MAILMAN^<RESPONSE>
"KRN",.84,34561,2,0)
^^1^1^3000104^
"KRN",.84,34561,2,1,0)
<RESPONSE>
"KRN",.84,34561,5,0)
^.841^1^1
"KRN",.84,34561,5,1,0)
XMJMQ
"KRN",.84,34561,5,"B","XMJMQ",1)

"KRN",.84,34562,-1)
0^533
"KRN",.84,34562,0)
34562^2^y^MAILMAN^(|1| recipients)
"KRN",.84,34562,2,0)
^^1^1^3000106^^
"KRN",.84,34562,2,1,0)
(|1| recipients)
"KRN",.84,34562,3,0)
^.845^1^1
"KRN",.84,34562,3,1,0)
1^number of recipients
"KRN",.84,34562,5,0)
^.841^1^1
"KRN",.84,34562,5,1,0)
XMJMQ
"KRN",.84,34562,5,"B","XMJMQ",1)

"KRN",.84,34562.1,-1)
0^534
"KRN",.84,34562.1,0)
34562.1^2^^MAILMAN^(1 recipient)
"KRN",.84,34562.1,2,0)
^^1^1^3000106^
"KRN",.84,34562.1,2,1,0)
(1 recipient)
"KRN",.84,34562.1,5,0)
^.841^1^1
"KRN",.84,34562.1,5,1,0)
XMJMQ
"KRN",.84,34562.1,5,"B","XMJMQ",1)

"KRN",.84,34564,-1)
0^535
"KRN",.84,34564,0)
34564^2^^MAILMAN^Confirmation requested.
"KRN",.84,34564,2,0)
^^1^1^3000104^
"KRN",.84,34564,2,1,0)
Confirmation requested.
"KRN",.84,34564,5,0)
^.841^1^1
"KRN",.84,34564,5,1,0)
XMJMQ
"KRN",.84,34564,5,"B","XMJMQ",1)

"KRN",.84,34565,-1)
0^536
"KRN",.84,34565,0)
34565^2^^MAILMAN^Scramble Hint: None.
"KRN",.84,34565,2,0)
^^1^1^3000104^
"KRN",.84,34565,2,1,0)
Scramble Hint: None.
"KRN",.84,34565,5,0)
^.841^1^1
"KRN",.84,34565,5,1,0)
XMJMQ
"KRN",.84,34565,5,"B","XMJMQ",1)

"KRN",.84,34566,-1)
0^537
"KRN",.84,34566,0)
34566^2^y^MAILMAN^Scramble Hint: |1|.
"KRN",.84,34566,2,0)
^^1^1^3000104^
"KRN",.84,34566,2,1,0)
Scramble Hint: |1|.
"KRN",.84,34566,3,0)
^.845^1^1
"KRN",.84,34566,3,1,0)
1^scramble hint
"KRN",.84,34566,5,0)
^.841^1^1
"KRN",.84,34566,5,1,0)
XMJMQ
"KRN",.84,34566,5,"B","XMJMQ",1)

"KRN",.84,34567,-1)
0^538
"KRN",.84,34567,0)
34567^2^^MAILMAN^Closed.
"KRN",.84,34567,2,0)
^^1^1^3000104^
"KRN",.84,34567,2,1,0)
Closed.
"KRN",.84,34567,5,0)
^.841^1^1
"KRN",.84,34567,5,1,0)
XMJMQ
"KRN",.84,34567,5,"B","XMJMQ",1)

"KRN",.84,34568,-1)
0^539
"KRN",.84,34568,0)
34568^2^^MAILMAN^Confidential.
"KRN",.84,34568,2,0)
^^1^1^3000104^
"KRN",.84,34568,2,1,0)
Confidential.
"KRN",.84,34568,5,0)
^.841^1^1
"KRN",.84,34568,5,1,0)
XMJMQ
"KRN",.84,34568,5,"B","XMJMQ",1)

"KRN",.84,34570,-1)
0^540
"KRN",.84,34570,0)
34570^2^^MAILMAN^'Information only' for all recipients.
"KRN",.84,34570,2,0)
^^1^1^3000104^
"KRN",.84,34570,2,1,0)
'Information only' for all recipients.
"KRN",.84,34570,5,0)
^.841^1^1
"KRN",.84,34570,5,1,0)
XMJMQ
"KRN",.84,34570,5,"B","XMJMQ",1)

"KRN",.84,34571,-1)
0^541
"KRN",.84,34571,0)
34571^2^y^MAILMAN^Delivery basket: |1|
"KRN",.84,34571,2,0)
^^1^1^3000104^
"KRN",.84,34571,2,1,0)
Delivery basket: |1|
"KRN",.84,34571,3,0)
^.845^1^1
"KRN",.84,34571,3,1,0)
1^delivery basket name
"KRN",.84,34571,5,0)
^.841^1^1
"KRN",.84,34571,5,1,0)
XMJMQ
"KRN",.84,34571,5,"B","XMJMQ",1)

"KRN",.84,34572,-1)
0^542
"KRN",.84,34572,0)
34572^2^y^MAILMAN^Automatic Deletion Date: |1|
"KRN",.84,34572,2,0)
^^1^1^3000104^
"KRN",.84,34572,2,1,0)
Automatic Deletion Date: |1|
"KRN",.84,34572,3,0)
^.845^1^1
"KRN",.84,34572,3,1,0)
1^automatic deletion date
"KRN",.84,34572,5,0)
^.841^1^1
"KRN",.84,34572,5,1,0)
XMJMQ
"KRN",.84,34572,5,"B","XMJMQ",1)

"KRN",.84,34573,-1)
0^543
"KRN",.84,34573,0)
34573^2^^MAILMAN^Attachment(s).
"KRN",.84,34573,2,0)
^^1^1^3000104^
"KRN",.84,34573,2,1,0)
Attachment(s).
"KRN",.84,34573,5,0)
^.841^2^2
"KRN",.84,34573,5,1,0)
XMJMP1
"KRN",.84,34573,5,2,0)
XMJMQ
"KRN",.84,34573,5,"B","XMJMP1",1)

"KRN",.84,34573,5,"B","XMJMQ",2)

"KRN",.84,34574,-1)
0^544
"KRN",.84,34574,0)
34574^2^^MAILMAN^ Not read.
"KRN",.84,34574,2,0)
^^1^1^3000104^
"KRN",.84,34574,2,1,0)
 Not read.
"KRN",.84,34574,5,0)
^.841^1^1
"KRN",.84,34574,5,1,0)
XMJMQ
"KRN",.84,34574,5,"B","XMJMQ",1)

"KRN",.84,34575,-1)
0^545
"KRN",.84,34575,0)
34575^2^y^MAILMAN^Last read: |1|
"KRN",.84,34575,2,0)
^^1^1^3000104^
"KRN",.84,34575,2,1,0)
Last read: |1|
"KRN",.84,34575,3,0)
^.845^1^1
"KRN",.84,34575,3,1,0)
1^date/time msg was last read
"KRN",.84,34575,5,0)
^.841^1^1
"KRN",.84,34575,5,1,0)
XMJMQ
"KRN",.84,34575,5,"B","XMJMQ",1)

"KRN",.84,34576,-1)
0^546
"KRN",.84,34576,0)
34576^2^y^MAILMAN^(|1| of |2|)
"KRN",.84,34576,1,0)
^^2^2^3000104^
"KRN",.84,34576,1,1,0)
tells how many of the message's responses the user has read.
"KRN",.84,34576,1,2,0)
Parameter 2 is created by dialogs 34557 or 34558.
"KRN",.84,34576,2,0)
^^1^1^3000104^
"KRN",.84,34576,2,1,0)
(|1| of |2|)
"KRN",.84,34576,3,0)
^.845^2^2
"KRN",.84,34576,3,1,0)
1^number of responses user has read
"KRN",.84,34576,3,2,0)
2^number of responses in the message
"KRN",.84,34576,5,0)
^.841^1^1
"KRN",.84,34576,5,1,0)
XMJMQ
"KRN",.84,34576,5,"B","XMJMQ",1)

"KRN",.84,34577,-1)
0^547
"KRN",.84,34577,0)
34577^2^y^MAILMAN^[First read: |1|]
"KRN",.84,34577,2,0)
^^1^1^3000104^
"KRN",.84,34577,2,1,0)
[First read: |1|]
"KRN",.84,34577,3,0)
^.845^1^1
"KRN",.84,34577,3,1,0)
1^date/time the user first read the msg
"KRN",.84,34577,5,0)
^.841^1^1
"KRN",.84,34577,5,1,0)
XMJMQ
"KRN",.84,34577,5,"B","XMJMQ",1)

"KRN",.84,34578,-1)
0^548
"KRN",.84,34578,0)
34578^2^y^MAILMAN^Copied: |1|
"KRN",.84,34578,2,0)
^^1^1^3000104^
"KRN",.84,34578,2,1,0)
Copied: |1|
"KRN",.84,34578,3,0)
^.845^1^1
"KRN",.84,34578,3,1,0)
1^date/time the user copied the msg
"KRN",.84,34578,5,0)
^.841^1^1
"KRN",.84,34578,5,1,0)
XMJMQ
"KRN",.84,34578,5,"B","XMJMQ",1)

"KRN",.84,34580,-1)
0^549
"KRN",.84,34580,0)
34580^2^y^MAILMAN^Surrogate: |1|
"KRN",.84,34580,2,0)
^^1^1^3000104^
"KRN",.84,34580,2,1,0)
Surrogate: |1|
"KRN",.84,34580,3,0)
^.845^1^1
"KRN",.84,34580,3,1,0)
1^surrogate who last read this msg
"KRN",.84,34580,5,0)
^.841^1^1
"KRN",.84,34580,5,1,0)
XMJMQ
"KRN",.84,34580,5,"B","XMJMQ",1)

"KRN",.84,34581,-1)
0^550
"KRN",.84,34581,0)
34581^2^y^MAILMAN^Terminated: |1|
"KRN",.84,34581,2,0)
^^1^1^3000104^
"KRN",.84,34581,2,1,0)
Terminated: |1|
"KRN",.84,34581,3,0)
^.845^1^1
"KRN",.84,34581,3,1,0)
1^date/time the user terminated the msg
"KRN",.84,34581,5,0)
^.841^1^1
"KRN",.84,34581,5,1,0)
XMJMQ
"KRN",.84,34581,5,"B","XMJMQ",1)

"KRN",.84,34582,-1)
0^551
"KRN",.84,34582,0)
34582^2^y^MAILMAN^Sent to fax: |1|
"KRN",.84,34582,2,0)
^^1^1^3000104^
"KRN",.84,34582,2,1,0)
Sent to fax: |1|
"KRN",.84,34582,3,0)
^.845^1^1
"KRN",.84,34582,3,1,0)
1^date/time the msg was sent to the fax software
"KRN",.84,34582,5,0)
^.841^1^1
"KRN",.84,34582,5,1,0)
XMJMQ
"KRN",.84,34582,5,"B","XMJMQ",1)

"KRN",.84,34583,-1)
0^552
"KRN",.84,34583,0)
34583^2^y^MAILMAN^Status: |1|
"KRN",.84,34583,2,0)
^^1^1^3000104^
"KRN",.84,34583,2,1,0)
Status: |1|
"KRN",.84,34583,3,0)
^.845^1^1
"KRN",.84,34583,3,1,0)
1^msg status
"KRN",.84,34583,5,0)
^.841^1^1
"KRN",.84,34583,5,1,0)
XMJMQ
"KRN",.84,34583,5,"B","XMJMQ",1)

"KRN",.84,34584,-1)
0^553
"KRN",.84,34584,0)
34584^2^y^MAILMAN^Fax ID: |1|
"KRN",.84,34584,2,0)
^^1^1^3000104^
"KRN",.84,34584,2,1,0)
Fax ID: |1|
"KRN",.84,34584,3,0)
^.845^1^1
"KRN",.84,34584,3,1,0)
1^fax id
"KRN",.84,34584,5,0)
^.841^1^1
"KRN",.84,34584,5,1,0)
XMJMQ
"KRN",.84,34584,5,"B","XMJMQ",1)

"KRN",.84,34585,-1)
0^554
"KRN",.84,34585,0)
34585^2^y^MAILMAN^Sent: |1|
"KRN",.84,34585,2,0)
^^1^1^3000104^
"KRN",.84,34585,2,1,0)
Sent: |1|
"KRN",.84,34585,3,0)
^.845^1^1
"KRN",.84,34585,3,1,0)
1^date/time the msg was sent
"KRN",.84,34585,5,0)
^.841^2^2
"KRN",.84,34585,5,1,0)
XMJMQ
"KRN",.84,34585,5,2,0)
XMJMC
"KRN",.84,34585,5,"B","XMJMC",2)

"KRN",.84,34585,5,"B","XMJMQ",1)

"KRN",.84,34586,-1)
0^555
"KRN",.84,34586,0)
34586^2^^MAILMAN^Time: 1 second
"KRN",.84,34586,2,0)
^^1^1^3000104^
"KRN",.84,34586,2,1,0)
Time: 1 second
"KRN",.84,34586,5,0)
^.841^1^1
"KRN",.84,34586,5,1,0)
XMJMQ
"KRN",.84,34586,5,"B","XMJMQ",1)

"KRN",.84,34587,-1)
0^556
"KRN",.84,34587,0)
34587^2^y^MAILMAN^Time: |1| seconds
"KRN",.84,34587,2,0)
^^1^1^3000104^
"KRN",.84,34587,2,1,0)
Time: |1| seconds
"KRN",.84,34587,3,0)
^.845^1^1
"KRN",.84,34587,3,1,0)
1^number of seconds the transmission took
"KRN",.84,34587,5,0)
^.841^1^1
"KRN",.84,34587,5,1,0)
XMJMQ
"KRN",.84,34587,5,"B","XMJMQ",1)

"KRN",.84,34588,-1)
0^557
"KRN",.84,34588,0)
34588^2^y^MAILMAN^Path: |1|
"KRN",.84,34588,2,0)
^^1^1^3000104^
"KRN",.84,34588,2,1,0)
Path: |1|
"KRN",.84,34588,3,0)
^.845^1^1
"KRN",.84,34588,3,1,0)
1^path the transmission took
"KRN",.84,34588,5,0)
^.841^1^1
"KRN",.84,34588,5,1,0)
XMJMQ
"KRN",.84,34588,5,"B","XMJMQ",1)

"KRN",.84,34590,-1)
0^558
"KRN",.84,34590,0)
34590^2^y^MAILMAN^Message ID: |1|
"KRN",.84,34590,2,0)
^^1^1^3000104^
"KRN",.84,34590,2,1,0)
Message ID: |1|
"KRN",.84,34590,3,0)
^.845^1^1
"KRN",.84,34590,3,1,0)
1^remote message id
"KRN",.84,34590,5,0)
^.841^1^1
"KRN",.84,34590,5,1,0)
XMJMQ
"KRN",.84,34590,5,"B","XMJMQ",1)

"KRN",.84,34591,-1)
0^559
"KRN",.84,34591,0)
34591^2^y^MAILMAN^Date: |1|
"KRN",.84,34591,2,0)
^^1^1^3000104^
"KRN",.84,34591,2,1,0)
Date: |1|
"KRN",.84,34591,3,0)
^.845^1^1
"KRN",.84,34591,3,1,0)
1^date of status
"KRN",.84,34591,5,0)
^.841^1^1
"KRN",.84,34591,5,1,0)
XMJMQ
"KRN",.84,34591,5,"B","XMJMQ",1)

"KRN",.84,34592,-1)
0^560
"KRN",.84,34592,0)
34592^2^y^MAILMAN^Forwarded on: |1|
"KRN",.84,34592,2,0)
^^1^1^3000104^
"KRN",.84,34592,2,1,0)
Forwarded on: |1|
"KRN",.84,34592,3,0)
^.845^1^1
"KRN",.84,34592,3,1,0)
1^date/time msg was forwarded
"KRN",.84,34592,5,0)
^.841^1^1
"KRN",.84,34592,5,1,0)
XMJMQ
"KRN",.84,34592,5,"B","XMJMQ",1)

"KRN",.84,34593,-1)
0^561
"KRN",.84,34593,0)
34593^2^y^MAILMAN^Forwarded by: |1|
"KRN",.84,34593,2,0)
^^1^1^3000104^
"KRN",.84,34593,2,1,0)
Forwarded by: |1|
"KRN",.84,34593,3,0)
^.845^1^1
"KRN",.84,34593,3,1,0)
1^who forwarded the msg
"KRN",.84,34593,5,0)
^.841^1^1
"KRN",.84,34593,5,1,0)
XMJMQ
"KRN",.84,34593,5,"B","XMJMQ",1)

"KRN",.84,34593.1,-1)
0^562
"KRN",.84,34593.1,0)
34593.1^2^y^MAILMAN^Auto-Forwarded by: |1|
"KRN",.84,34593.1,2,0)
^^1^1^3011128^
"KRN",.84,34593.1,2,1,0)
Auto-Forwarded by: |1|
"KRN",.84,34593.1,3,0)
^.845^1^1
"KRN",.84,34593.1,3,1,0)
1^forwarded by whom
"KRN",.84,34593.1,5,0)
^.841^1^1
"KRN",.84,34593.1,5,1,0)
XMJMQ
"KRN",.84,34593.1,5,"B","XMJMQ",1)

"KRN",.84,34593.2,-1)
0^563
"KRN",.84,34593.2,0)
34593.2^2^y^MAILMAN^Filter-Forwarded by: |1|
"KRN",.84,34593.2,2,0)
^^1^1^3011128^
"KRN",.84,34593.2,2,1,0)
Filter-Forwarded by: |1|
"KRN",.84,34593.2,3,0)
^.845^1^1
"KRN",.84,34593.2,3,1,0)
1^forwarded by whom
"KRN",.84,34593.2,5,0)
^.841^1^1
"KRN",.84,34593.2,5,1,0)
XMJMQ
"KRN",.84,34593.2,5,"B","XMJMQ",1)

"KRN",.84,34594,-1)
0^564
"KRN",.84,34594,0)
34594^2^y^MAILMAN^[Forwarded to |1| by: |2|]
"KRN",.84,34594,2,0)
^.844^1^1^3011128^
"KRN",.84,34594,2,1,0)
[Forwarded to |1| by: |2|]
"KRN",.84,34594,3,0)
^.845^2^2
"KRN",.84,34594,3,1,0)
1^forwarded to whom
"KRN",.84,34594,3,2,0)
2^by whom
"KRN",.84,34594,5,0)
^.841^1^1
"KRN",.84,34594,5,1,0)
XMJMQ
"KRN",.84,34594,5,"B","XMJMQ",1)

"KRN",.84,34594.1,-1)
0^565
"KRN",.84,34594.1,0)
34594.1^2^y^MAILMAN^[Filter-Forwarded to |1| by: |2|]
"KRN",.84,34594.1,2,0)
^.844^1^1^3011128^^
"KRN",.84,34594.1,2,1,0)
[Filter-Forwarded to |1| by: |2|]
"KRN",.84,34594.1,3,0)
^.845^2^2
"KRN",.84,34594.1,3,1,0)
1^forwarded to whom
"KRN",.84,34594.1,3,2,0)
2^by whom
"KRN",.84,34594.1,5,0)
^.841^1^1
"KRN",.84,34594.1,5,1,0)
XMJMQ
"KRN",.84,34594.1,5,"B","XMJMQ",1)

"KRN",.84,34595,-1)
0^566
"KRN",.84,34595,0)
34595^2^^MAILMAN^Message will be NEW on: 
"KRN",.84,34595,1,0)
^^1^1^3000104^
"KRN",.84,34595,1,1,0)
Note: there is one blank at this end of this dialog
"KRN",.84,34595,2,0)
^^1^1^3000104^^
"KRN",.84,34595,2,1,0)
Message will be NEW on: 
"KRN",.84,34595,5,0)
^.841^1^1
"KRN",.84,34595,5,1,0)
XMJMQ
"KRN",.84,34595,5,"B","XMJMQ",1)

"KRN",.84,34595.1,-1)
0^567
"KRN",.84,34595.1,0)
34595.1^2^^MAILMAN^Message will be NEW Later.
"KRN",.84,34595.1,2,0)
^^1^1^3000605^
"KRN",.84,34595.1,2,1,0)
Message will be NEW Later.
"KRN",.84,34595.1,5,0)
^.841^1^1
"KRN",.84,34595.1,5,1,0)
XMJMP1
"KRN",.84,34595.1,5,"B","XMJMP1",1)

"KRN",.84,34596,-1)
0^568
"KRN",.84,34596,0)
34596^2^^MAILMAN^This message has no summary recipient list
"KRN",.84,34596,2,0)
^^2^2^3000104^^
"KRN",.84,34596,2,1,0)
This message has no summary recipient list.
"KRN",.84,34596,2,2,0)
Only the Detail Query (QD) is available.
"KRN",.84,34596,5,0)
^.841^1^1
"KRN",.84,34596,5,1,0)
XMJMQ1
"KRN",.84,34596,5,"B","XMJMQ1",1)

"KRN",.84,34597,-1)
0^569
"KRN",.84,34597,0)
34597^2^^MAILMAN^This message was addressed as follows:
"KRN",.84,34597,2,0)
^^1^1^3000104^
"KRN",.84,34597,2,1,0)
This message was addressed as follows:
"KRN",.84,34597,5,0)
^.841^1^1
"KRN",.84,34597,5,1,0)
XMJMQ1
"KRN",.84,34597,5,"B","XMJMQ1",1)

"KRN",.84,34598,-1)
0^570
"KRN",.84,34598,0)
34598^2^y^MAILMAN^for delivery |1| by |2|
"KRN",.84,34598,2,0)
^^1^1^3000104^
"KRN",.84,34598,2,1,0)
for delivery |1| by |2|
"KRN",.84,34598,3,0)
^.845^2^2
"KRN",.84,34598,3,1,0)
1^date/time to deliver the msg
"KRN",.84,34598,3,2,0)
2^who later'd delivery to this user
"KRN",.84,34598,5,0)
^.841^1^1
"KRN",.84,34598,5,1,0)
XMJMQ1
"KRN",.84,34598,5,"B","XMJMQ1",1)

"KRN",.84,34600,-1)
0^571
"KRN",.84,34600,0)
34600^2^^MAILMAN^copy
"KRN",.84,34600,2,0)
^^1^1^3000105^^
"KRN",.84,34600,2,1,0)
copy
"KRN",.84,34600,5,0)
^.841^1^1
"KRN",.84,34600,5,1,0)
XMJMC
"KRN",.84,34600,5,"B","XMJMC",1)

"KRN",.84,34601,-1)
0^572
"KRN",.84,34601,0)
34601^3^^MAILMAN^You may use the 'Transfer' option of the
"KRN",.84,34601,2,0)
^.844^2^2^3020408^^
"KRN",.84,34601,2,1,0)
You may use the 'Transfer' option of the FileMan Editor
"KRN",.84,34601,2,2,0)
to move text from this message or its responses into a new message.
"KRN",.84,34601,5,0)
^.841^1^1
"KRN",.84,34601,5,1,0)
XMJMC
"KRN",.84,34601,5,"B","XMJMC",1)

"KRN",.84,34602,-1)
0^573
"KRN",.84,34602,0)
34602^2^^MAILMAN^List original recipients in text
"KRN",.84,34602,2,0)
^^1^1^3000105^
"KRN",.84,34602,2,1,0)
List original recipients in text
"KRN",.84,34602,5,0)
^.841^1^1
"KRN",.84,34602,5,1,0)
XMJMC
"KRN",.84,34602,5,"B","XMJMC",1)

"KRN",.84,34603,-1)
0^574
"KRN",.84,34603,0)
34603^2^^MAILMAN^Deliver to the same recipients
"KRN",.84,34603,2,0)
^^1^1^3000105^
"KRN",.84,34603,2,1,0)
Deliver to the same recipients
"KRN",.84,34603,5,0)
^.841^1^1
"KRN",.84,34603,5,1,0)
XMJMC
"KRN",.84,34603,5,"B","XMJMC",1)

"KRN",.84,34604,-1)
0^575
"KRN",.84,34604,0)
34604^2^^MAILMAN^LOCAL recipients (NOT recipients on remote
"KRN",.84,34604,2,0)
^^1^1^3000105^
"KRN",.84,34604,2,1,0)
LOCAL recipients (NOT recipients on remote network nodes) will be copied.
"KRN",.84,34604,5,0)
^.841^1^1
"KRN",.84,34604,5,1,0)
XMJMC
"KRN",.84,34604,5,"B","XMJMC",1)

"KRN",.84,34605,-1)
0^576
"KRN",.84,34605,0)
34605^2^y^MAILMAN^Copy of: |1|
"KRN",.84,34605,2,0)
^^1^1^3000105^^
"KRN",.84,34605,2,1,0)
Copy of: |1|
"KRN",.84,34605,3,0)
^.845^1^1
"KRN",.84,34605,3,1,0)
1^msg subject
"KRN",.84,34605,5,0)
^.841^1^1
"KRN",.84,34605,5,1,0)
XMJMC
"KRN",.84,34605,5,"B","XMJMC",1)

"KRN",.84,34606,-1)
0^577
"KRN",.84,34606,0)
34606^2^^MAILMAN^copying
"KRN",.84,34606,2,0)
^^1^1^3000105^
"KRN",.84,34606,2,1,0)
copying
"KRN",.84,34606,5,0)
^.841^1^1
"KRN",.84,34606,5,1,0)
XMJMC
"KRN",.84,34606,5,"B","XMJMC",1)

"KRN",.84,34607,-1)
0^578
"KRN",.84,34607,0)
34607^2^^MAILMAN^Copying text...
"KRN",.84,34607,2,0)
^^1^1^3000110^^
"KRN",.84,34607,2,1,0)
Copying text...
"KRN",.84,34607,5,0)
^.841^1^1
"KRN",.84,34607,5,1,0)
XMJMC
"KRN",.84,34607,5,"B","XMJMC",1)

"KRN",.84,34608,-1)
0^579
"KRN",.84,34608,0)
34608^2^^MAILMAN^Original Recipients
"KRN",.84,34608,2,0)
^^1^1^3000105^
"KRN",.84,34608,2,1,0)
Original Recipients
"KRN",.84,34608,5,0)
^.841^1^1
"KRN",.84,34608,5,1,0)
XMJMC
"KRN",.84,34608,5,"B","XMJMC",1)

"KRN",.84,34610,-1)
0^580
"KRN",.84,34610,0)
34610^2^^MAILMAN^Copying recipients into text and onto mess
"KRN",.84,34610,2,0)
^^1^1^3000110^^
"KRN",.84,34610,2,1,0)
Copying recipients into text and onto message...
"KRN",.84,34610,5,0)
^.841^1^1
"KRN",.84,34610,5,1,0)
XMJMC
"KRN",.84,34610,5,"B","XMJMC",1)

"KRN",.84,34611,-1)
0^581
"KRN",.84,34611,0)
34611^2^^MAILMAN^Copying recipients into text...
"KRN",.84,34611,2,0)
^^1^1^3000110^^
"KRN",.84,34611,2,1,0)
Copying recipients into text...
"KRN",.84,34611,5,0)
^.841^1^1
"KRN",.84,34611,5,1,0)
XMJMC
"KRN",.84,34611,5,"B","XMJMC",1)

"KRN",.84,34612,-1)
0^582
"KRN",.84,34612,0)
34612^2^^MAILMAN^Copying recipients onto message...
"KRN",.84,34612,2,0)
^^1^1^3000110^^
"KRN",.84,34612,2,1,0)
Copying recipients onto message...
"KRN",.84,34612,5,0)
^.841^1^1
"KRN",.84,34612,5,1,0)
XMJMC
"KRN",.84,34612,5,"B","XMJMC",1)

"KRN",.84,34615,-1)
0^583
"KRN",.84,34615,0)
34615^2^^MAILMAN^Scrambling...
"KRN",.84,34615,2,0)
^^1^1^3000105^
"KRN",.84,34615,2,1,0)
Scrambling...
"KRN",.84,34615,5,0)
^.841^1^1
"KRN",.84,34615,5,1,0)
XMJMCODE
"KRN",.84,34615,5,"B","XMJMCODE",1)

"KRN",.84,34616,-1)
0^584
"KRN",.84,34616,0)
34616^2^^MAILMAN^UnScrambling...
"KRN",.84,34616,2,0)
^^1^1^3000105^
"KRN",.84,34616,2,1,0)
UnScrambling...
"KRN",.84,34616,5,0)
^.841^1^1
"KRN",.84,34616,5,1,0)
XMJMCODE
"KRN",.84,34616,5,"B","XMJMCODE",1)

"KRN",.84,34617,-1)
0^585
"KRN",.84,34617,0)
34617^2^^MAILMAN^Enter Scramble Hint
"KRN",.84,34617,2,0)
^^1^1^3000105^
"KRN",.84,34617,2,1,0)
Enter Scramble Hint
"KRN",.84,34617,5,0)
^.841^1^1
"KRN",.84,34617,5,1,0)
XMJMCODE
"KRN",.84,34617,5,"B","XMJMCODE",1)

"KRN",.84,34618,-1)
0^586
"KRN",.84,34618,0)
34618^2^^MAILMAN^Enter Scramble Password: 
"KRN",.84,34618,1,0)
^^1^1^3000105^
"KRN",.84,34618,1,1,0)
note: there is a blank at the end of this dialog.
"KRN",.84,34618,2,0)
^^1^1^3000105^
"KRN",.84,34618,2,1,0)
Enter Scramble Password: 
"KRN",.84,34618,5,0)
^.841^1^1
"KRN",.84,34618,5,1,0)
XMJMCODE
"KRN",.84,34618,5,"B","XMJMCODE",1)

"KRN",.84,34619,-1)
0^587
"KRN",.84,34619,0)
34619^3^^MAILMAN^The scramble password is a secret code,
"KRN",.84,34619,2,0)
^.844^4^4^3010822^^
"KRN",.84,34619,2,1,0)
The scramble password is a secret code, which must be entered by the reader
"KRN",.84,34619,2,2,0)
in order to see the message.  Upper and lower case characters are treated
"KRN",.84,34619,2,3,0)
the same.  (The password is not case sensitive.)  The password must be from
"KRN",.84,34619,2,4,0)
3 to 20 characters long, and may not be just one repeating character.
"KRN",.84,34619,5,0)
^.841^1^1
"KRN",.84,34619,5,1,0)
XMJMCODE
"KRN",.84,34619,5,"B","XMJMCODE",1)

"KRN",.84,34620,-1)
0^588
"KRN",.84,34620,0)
34620^2^y^MAILMAN^The Scramble Hint is: '|1|'
"KRN",.84,34620,2,0)
^.844^1^1^3001023^^^
"KRN",.84,34620,2,1,0)
The Scramble Hint is: '|1|'
"KRN",.84,34620,3,0)
^.845^1^1
"KRN",.84,34620,3,1,0)
1^scramble hint
"KRN",.84,34620,5,0)
^.841^1^1
"KRN",.84,34620,5,1,0)
XMJMCODE
"KRN",.84,34620,5,"B","XMJMCODE",1)

"KRN",.84,34620.1,-1)
0^589
"KRN",.84,34620.1,0)
34620.1^2^^MAILMAN^There is no Scramble Hint.
"KRN",.84,34620.1,2,0)
^.844^1^1^3001023^^^
"KRN",.84,34620.1,2,1,0)
There is no Scramble Hint.
"KRN",.84,34620.1,5,0)
^.841^1^1
"KRN",.84,34620.1,5,1,0)
XMJMCODE
"KRN",.84,34620.1,5,"B","XMJMCODE",1)

"KRN",.84,34621,-1)
0^590
"KRN",.84,34621,0)
34621^1^y^MAILMAN^  Not the proper password.  Strike |1|.
"KRN",.84,34621,2,0)
^^1^1^3000110^^^
"KRN",.84,34621,2,1,0)
  Not the proper password.  Strike |1|.
"KRN",.84,34621,3,0)
^.845^1^1
"KRN",.84,34621,3,1,0)
1^number of unsuccessful tries
"KRN",.84,34621,5,0)
^.841^1^1
"KRN",.84,34621,5,1,0)
XMJMCODE
"KRN",.84,34621,5,"B","XMJMCODE",1)

"KRN",.84,34622,-1)
0^591
"KRN",.84,34622,0)
34622^1^^MAILMAN^  Yer out!
"KRN",.84,34622,2,0)
^^1^1^3000105^
"KRN",.84,34622,2,1,0)
  Yer out!
"KRN",.84,34622,5,0)
^.841^1^1
"KRN",.84,34622,5,1,0)
XMJMCODE
"KRN",.84,34622,5,"B","XMJMCODE",1)

"KRN",.84,34623,-1)
0^592
"KRN",.84,34623,0)
34623^1^^MAILMAN^The key is not correct.
"KRN",.84,34623,2,0)
^^1^1^3000105^
"KRN",.84,34623,2,1,0)
The key is not correct.
"KRN",.84,34623,5,0)
^.841^1^1
"KRN",.84,34623,5,1,0)
XMXEDIT
"KRN",.84,34623,5,"B","XMXEDIT",1)

"KRN",.84,34624,-1)
0^593
"KRN",.84,34624,0)
34624^2^^MAILMAN^This message has been secured with a pass
"KRN",.84,34624,2,0)
^.844^1^1^3001023^^
"KRN",.84,34624,2,1,0)
This message has been secured with a password:
"KRN",.84,34624,5,0)
^.841^1^1
"KRN",.84,34624,5,1,0)
XMJMCODE
"KRN",.84,34624,5,"B","XMJMCODE",1)

"KRN",.84,34630,-1)
0^594
"KRN",.84,34630,0)
34630^2^^MAILMAN^No Later'd Messages
"KRN",.84,34630,2,0)
^^1^1^3000105^
"KRN",.84,34630,2,1,0)
No Later'd Messages
"KRN",.84,34630,5,0)
^.841^1^1
"KRN",.84,34630,5,1,0)
XMJMD
"KRN",.84,34630,5,"B","XMJMD",1)

"KRN",.84,34631,-1)
0^595
"KRN",.84,34631,0)
34631^2^y^MAILMAN^Later'd Messages Report for: |1|
"KRN",.84,34631,2,0)
^^1^1^3000105^
"KRN",.84,34631,2,1,0)
Later'd Messages Report for: |1|
"KRN",.84,34631,3,0)
^.845^1^1
"KRN",.84,34631,3,1,0)
1^user name
"KRN",.84,34631,5,0)
^.841^1^1
"KRN",.84,34631,5,1,0)
XMJMD
"KRN",.84,34631,5,"B","XMJMD",1)

"KRN",.84,34632,-1)
0^596
"KRN",.84,34632,0)
34632^2^^MAILMAN^Date
"KRN",.84,34632,2,0)
^^1^1^3000105^
"KRN",.84,34632,2,1,0)
Date
"KRN",.84,34632,5,0)
^.841^1^1
"KRN",.84,34632,5,1,0)
XMJMD
"KRN",.84,34632,5,"B","XMJMD",1)

"KRN",.84,34633,-1)
0^597
"KRN",.84,34633,0)
34633^2^^MAILMAN^Msg ID
"KRN",.84,34633,2,0)
^^1^1^3000105^
"KRN",.84,34633,2,1,0)
Msg ID
"KRN",.84,34633,5,0)
^.841^2^2
"KRN",.84,34633,5,1,0)
XMJMD
"KRN",.84,34633,5,2,0)
XMUT2
"KRN",.84,34633,5,"B","XMJMD",1)

"KRN",.84,34633,5,"B","XMUT2",2)

"KRN",.84,34634,-1)
0^598
"KRN",.84,34634,0)
34634^2^^MAILMAN^A:Add another date on which this message
"KRN",.84,34634,2,0)
^^1^1^3000105^
"KRN",.84,34634,2,1,0)
A:Add another date on which this message should appear new
"KRN",.84,34634,5,0)
^.841^1^1
"KRN",.84,34634,5,1,0)
XMJMD
"KRN",.84,34634,5,"B","XMJMD",1)

"KRN",.84,34635,-1)
0^599
"KRN",.84,34635,0)
34635^2^^MAILMAN^C:Change this date
"KRN",.84,34635,2,0)
^^1^1^3000105^
"KRN",.84,34635,2,1,0)
C:Change this date
"KRN",.84,34635,5,0)
^.841^1^1
"KRN",.84,34635,5,1,0)
XMJMD
"KRN",.84,34635,5,"B","XMJMD",1)

"KRN",.84,34635.1,-1)
0^600
"KRN",.84,34635.1,0)
34635.1^2^^MAILMAN^C:Change a date
"KRN",.84,34635.1,2,0)
^^1^1^3000105^
"KRN",.84,34635.1,2,1,0)
C:Change a date
"KRN",.84,34635.1,5,0)
^.841^1^1
"KRN",.84,34635.1,5,1,0)
XMJMD
"KRN",.84,34635.1,5,"B","XMJMD",1)

"KRN",.84,34636,-1)
0^601
"KRN",.84,34636,0)
34636^2^^MAILMAN^D:Delete this date
"KRN",.84,34636,2,0)
^^1^1^3000105^
"KRN",.84,34636,2,1,0)
D:Delete this date
"KRN",.84,34636,5,0)
^.841^1^1
"KRN",.84,34636,5,1,0)
XMJMD
"KRN",.84,34636,5,"B","XMJMD",1)

"KRN",.84,34636.1,-1)
0^602
"KRN",.84,34636.1,0)
34636.1^2^^MAILMAN^D:Delete a date
"KRN",.84,34636.1,2,0)
^^1^1^3000105^
"KRN",.84,34636.1,2,1,0)
D:Delete a date
"KRN",.84,34636.1,5,0)
^.841^1^1
"KRN",.84,34636.1,5,1,0)
XMJMD
"KRN",.84,34636.1,5,"B","XMJMD",1)

"KRN",.84,34637,-1)
0^603
"KRN",.84,34637,0)
34637^2^^MAILMAN^... deleted.
"KRN",.84,34637,2,0)
^^1^1^3000105^
"KRN",.84,34637,2,1,0)
... deleted.
"KRN",.84,34637,5,0)
^.841^1^1
"KRN",.84,34637,5,1,0)
XMJMD
"KRN",.84,34637,5,"B","XMJMD",1)

"KRN",.84,34638,-1)
0^604
"KRN",.84,34638,0)
34638^2^^MAILMAN^You have no Later'd messages.
"KRN",.84,34638,2,0)
^^1^1^3000105^
"KRN",.84,34638,2,1,0)
You have no Later'd messages.
"KRN",.84,34638,5,0)
^.841^1^1
"KRN",.84,34638,5,1,0)
XMJMD
"KRN",.84,34638,5,"B","XMJMD",1)

"KRN",.84,34639,-1)
0^605
"KRN",.84,34639,0)
34639^2^^MAILMAN^MailMan: Report on Later'd Messages
"KRN",.84,34639,2,0)
^^1^1^3000105^
"KRN",.84,34639,2,1,0)
MailMan: Report on Later'd Messages
"KRN",.84,34639,5,0)
^.841^1^1
"KRN",.84,34639,5,1,0)
XMJMD
"KRN",.84,34639,5,"B","XMJMD",1)

"KRN",.84,34650,-1)
0^606
"KRN",.84,34650,0)
34650^2^^MAILMAN^List contents of
"KRN",.84,34650,2,0)
^^1^1^3000808^
"KRN",.84,34650,2,1,0)
List contents of
"KRN",.84,34650,5,0)
^.841^1^1
"KRN",.84,34650,5,1,0)
XMJBL
"KRN",.84,34650,5,"B","XMJBL",1)

"KRN",.84,34651,-1)
0^607
"KRN",.84,34651,0)
34651^2^^MAILMAN^A:All Baskets
"KRN",.84,34651,2,0)
^^1^1^3000808^
"KRN",.84,34651,2,1,0)
A:All Baskets
"KRN",.84,34651,5,0)
^.841^1^1
"KRN",.84,34651,5,1,0)
XMJBL
"KRN",.84,34651,5,"B","XMJBL",1)

"KRN",.84,34652,-1)
0^608
"KRN",.84,34652,0)
34652^2^^MAILMAN^O:One Basket
"KRN",.84,34652,2,0)
^^1^1^3000808^
"KRN",.84,34652,2,1,0)
O:One Basket
"KRN",.84,34652,5,0)
^.841^1^1
"KRN",.84,34652,5,1,0)
XMJBL
"KRN",.84,34652,5,"B","XMJBL",1)

"KRN",.84,34653,-1)
0^609
"KRN",.84,34653,0)
34653^2^^MAILMAN^List contents of MAIL BASKET: 
"KRN",.84,34653,1,0)
^^1^1^3000808^
"KRN",.84,34653,1,1,0)
There's one blank at the end.
"KRN",.84,34653,2,0)
^^1^1^3000808^
"KRN",.84,34653,2,1,0)
List contents of MAIL BASKET: 
"KRN",.84,34653,5,0)
^.841^1^1
"KRN",.84,34653,5,1,0)
XMJBL
"KRN",.84,34653,5,"B","XMJBL",1)

"KRN",.84,34654,-1)
0^610
"KRN",.84,34654,0)
34654^2^^MAILMAN^MailMan: Mailbox Contents List
"KRN",.84,34654,2,0)
^^1^1^3000808^
"KRN",.84,34654,2,1,0)
MailMan: Mailbox Contents List
"KRN",.84,34654,5,0)
^.841^1^1
"KRN",.84,34654,5,1,0)
XMJBL
"KRN",.84,34654,5,"B","XMJBL",1)

"KRN",.84,34655,-1)
0^611
"KRN",.84,34655,0)
34655^2^^MAILMAN^MailMan: Basket Contents List
"KRN",.84,34655,2,0)
^^1^1^3000808^
"KRN",.84,34655,2,1,0)
MailMan: Basket Contents List
"KRN",.84,34655,5,0)
^.841^1^1
"KRN",.84,34655,5,1,0)
XMJBL
"KRN",.84,34655,5,"B","XMJBL",1)

"KRN",.84,34656,-1)
0^612
"KRN",.84,34656,0)
34656^2^y^MAILMAN^Basket: |1|
"KRN",.84,34656,2,0)
^^1^1^3000808^
"KRN",.84,34656,2,1,0)
Basket: |1|
"KRN",.84,34656,3,0)
^.845^1^1
"KRN",.84,34656,3,1,0)
1^basket name
"KRN",.84,34656,5,0)
^.841^1^1
"KRN",.84,34656,5,1,0)
XMJBL
"KRN",.84,34656,5,"B","XMJBL",1)

"KRN",.84,34656.1,-1)
0^613
"KRN",.84,34656.1,0)
34656.1^2^y^MAILMAN^Basket: |1| (continued)
"KRN",.84,34656.1,2,0)
^^1^1^3000808^
"KRN",.84,34656.1,2,1,0)
Basket: |1| (continued)
"KRN",.84,34656.1,3,0)
^.845^1^1
"KRN",.84,34656.1,3,1,0)
1^basket name
"KRN",.84,34656.1,5,0)
^.841^1^1
"KRN",.84,34656.1,5,1,0)
XMJBL
"KRN",.84,34656.1,5,"B","XMJBL",1)

"KRN",.84,34657,-1)
0^614
"KRN",.84,34657,0)
34657^2^y^MAILMAN^Mailbox Content for |1|   Page: |2|
"KRN",.84,34657,2,0)
^^1^1^3000808^
"KRN",.84,34657,2,1,0)
Mailbox Content for |1|   Page: |2|
"KRN",.84,34657,3,0)
^.845^2^2
"KRN",.84,34657,3,1,0)
1^user name
"KRN",.84,34657,3,2,0)
2^page number
"KRN",.84,34657,5,0)
^.841^1^1
"KRN",.84,34657,5,1,0)
XMJBL
"KRN",.84,34657,5,"B","XMJBL",1)

"KRN",.84,34660,-1)
0^615
"KRN",.84,34660,0)
34660^2^y^MAILMAN^Enter parameter |1|
"KRN",.84,34660,2,0)
^^1^1^3000808^
"KRN",.84,34660,2,1,0)
Enter parameter |1|
"KRN",.84,34660,3,0)
^.845^1^1
"KRN",.84,34660,3,1,0)
1^parameter number
"KRN",.84,34660,5,0)
^.841^1^1
"KRN",.84,34660,5,1,0)
XMJMBULL
"KRN",.84,34660,5,"B","XMJMBULL",1)

"KRN",.84,34661,-1)
0^616
"KRN",.84,34661,0)
34661^1^y^MAILMAN^|1| is not a valid parameter.  Aborting!
"KRN",.84,34661,2,0)
^^1^1^3000808^
"KRN",.84,34661,2,1,0)
|1| is not a valid parameter.  Aborting!
"KRN",.84,34661,3,0)
^.845^1^1
"KRN",.84,34661,3,1,0)
1^invalid parameter name
"KRN",.84,34661,5,0)
^.841^1^1
"KRN",.84,34661,5,1,0)
XMJMBULL
"KRN",.84,34661,5,"B","XMJMBULL",1)

"KRN",.84,34662,-1)
0^617
"KRN",.84,34662,0)
34662^2^^MAILMAN^When do you want to send the bulletin? 
"KRN",.84,34662,1,0)
^^1^1^3000808^
"KRN",.84,34662,1,1,0)
There's 1 blank at the end of this dialog.
"KRN",.84,34662,2,0)
^.844^1^1^3000808^^
"KRN",.84,34662,2,1,0)
When do you want to send the bulletin? 
"KRN",.84,34662,5,0)
^.841^1^1
"KRN",.84,34662,5,1,0)
XMJMBULL
"KRN",.84,34662,5,"B","XMJMBULL",1)

"KRN",.84,34665,-1)
0^618
"KRN",.84,34665,0)
34665^2^^MAILMAN^Anonymous
"KRN",.84,34665,2,0)
^^1^1^3000808^
"KRN",.84,34665,2,1,0)
Anonymous
"KRN",.84,34665,5,0)
^.841^1^1
"KRN",.84,34665,5,1,0)
XMJMSA
"KRN",.84,34665,5,"B","XMJMSA",1)

"KRN",.84,34666,-1)
0^619
"KRN",.84,34666,0)
34666^2^^MAILMAN^SUGGESTION BOX
"KRN",.84,34666,2,0)
^^1^1^3000808^
"KRN",.84,34666,2,1,0)
SUGGESTION BOX
"KRN",.84,34666,5,0)
^.841^1^1
"KRN",.84,34666,5,1,0)
XMJMSA
"KRN",.84,34666,5,"B","XMJMSA",1)

"KRN",.84,34667,-1)
0^620
"KRN",.84,34667,0)
34667^2^^MAILMAN^* * * * *  ATTENTION  * * * * *
"KRN",.84,34667,2,0)
^^6^6^3000808^
"KRN",.84,34667,2,1,0)
                    * * * * *  ATTENTION  * * * * *
"KRN",.84,34667,2,2,0)
 
"KRN",.84,34667,2,3,0)
         Anonymous messages may or may not be totally anonymous.
"KRN",.84,34667,2,4,0)
 
"KRN",.84,34667,2,5,0)
                    Please check with your local IRM
"KRN",.84,34667,2,6,0)
    to find out if your facility has methods in place to identify you.
"KRN",.84,34667,5,0)
^.841^1^1
"KRN",.84,34667,5,1,0)
XMJMSA
"KRN",.84,34667,5,"B","XMJMSA",1)

"KRN",.84,36080,-1)
0^621
"KRN",.84,36080,0)
36080^2^^MAILMAN^MailMan: Global Integrity Checker
"KRN",.84,36080,2,0)
^^1^1^3010417^
"KRN",.84,36080,2,1,0)
MailMan: Global Integrity Checker
"KRN",.84,36081,-1)
0^622
"KRN",.84,36081,0)
36081^2^^MAILMAN^Checking MAILBOX file 3.7
"KRN",.84,36081,2,0)
^^1^1^3010417^
"KRN",.84,36081,2,1,0)
Checking MAILBOX file 3.7
"KRN",.84,36082,-1)
0^623
"KRN",.84,36082,0)
36082^2^^MAILMAN^Checking each user mailbox
"KRN",.84,36082,2,0)
^^1^1^3010417^
"KRN",.84,36082,2,1,0)
Checking each user mailbox
"KRN",.84,36083,-1)
0^624
"KRN",.84,36083,0)
36083^2^y^MAILMAN^|1| Users, |2| Baskets, |3| Messages
"KRN",.84,36083,2,0)
^.844^1^1^3010418^^
"KRN",.84,36083,2,1,0)
|1| Users, |2| Baskets, |3| Messages in Baskets
"KRN",.84,36083,3,0)
^.845^3^3
"KRN",.84,36083,3,1,0)
1^number of users in file 3.7
"KRN",.84,36083,3,2,0)
2^number of baskets
"KRN",.84,36083,3,3,0)
3^number of message entries in all baskets
"KRN",.84,36084,-1)
0^625
"KRN",.84,36084,0)
36084^2^^MAILMAN^The MailMan file checker may take some tim
"KRN",.84,36084,2,0)
^^9^9^3010417^
"KRN",.84,36084,2,1,0)
The MailMan file checker may take some time to process.
"KRN",.84,36084,2,2,0)
If you have not tried it before, PLEASE try it when the
"KRN",.84,36084,2,3,0)
system will be quiescent for a LONG period of time.
"KRN",.84,36084,2,4,0)

"KRN",.84,36084,2,5,0)
Errors listed are generally not fatal.  Most errors are
"KRN",.84,36084,2,6,0)
corrected.  Please enter a NOIS if there are many errors.
"KRN",.84,36084,2,7,0)

"KRN",.84,36084,2,8,0)
Keep the error printout for future reference.  If you see
"KRN",.84,36084,2,9,0)
errors in MailMan, the printout may help to resolve them.
"KRN",.84,36085,-1)
0^626
"KRN",.84,36085,0)
36085^2^^MAILMAN^Do you wish to proceed
"KRN",.84,36085,2,0)
^^1^1^3010417^
"KRN",.84,36085,2,1,0)
Do you wish to proceed
"KRN",.84,36086,-1)
0^627
"KRN",.84,36086,0)
36086^2^^MAILMAN^Checking M xref
"KRN",.84,36086,2,0)
^^1^1^3010417^
"KRN",.84,36086,2,1,0)
Checking M xref
"KRN",.84,36087,-1)
0^628
"KRN",.84,36087,0)
36087^2^^MAILMAN^Summary of Integrity Check:
"KRN",.84,36087,2,0)
^.844^1^1^3010418^^
"KRN",.84,36087,2,1,0)
Summary of Integrity Check:
"KRN",.84,36088,-1)
0^629
"KRN",.84,36088,0)
36088^2^^MAILMAN^No errors to report.
"KRN",.84,36088,2,0)
^^1^1^3010417^
"KRN",.84,36088,2,1,0)
No errors to report.
"KRN",.84,36089,-1)
0^630
"KRN",.84,36089,0)
36089^2^^MAILMAN^Results for MESSAGE file 3.7:
"KRN",.84,36089,2,0)
^.844^1^1^3010418^^
"KRN",.84,36089,2,1,0)
Results for MESSAGE file 3.7:
"KRN",.84,36090,-1)
0^631
"KRN",.84,36090,0)
36090^2^y^MAILMAN^Type |1| errors=|2|
"KRN",.84,36090,2,0)
^^1^1^3010417^
"KRN",.84,36090,2,1,0)
Type |1| errors=|2|
"KRN",.84,36090,3,0)
^.845^2^2
"KRN",.84,36090,3,1,0)
1^error type
"KRN",.84,36090,3,2,0)
2^number of errors of that type
"KRN",.84,36091,-1)
0^632
"KRN",.84,36091,0)
36091^2^^MAILMAN^Results for MESSAGE file 3.9:
"KRN",.84,36091,2,0)
^.844^1^1^3010418^^
"KRN",.84,36091,2,1,0)
Results for MESSAGE file 3.9:
"KRN",.84,36092,-1)
0^633
"KRN",.84,36092,0)
36092^2^y^MAILMAN^|1| unique messages referenced in the
"KRN",.84,36092,2,0)
^^1^1^3010418^
"KRN",.84,36092,2,1,0)
|1| unique messages referenced in the MAILBOX file 3.7
"KRN",.84,36092,3,0)
^.845^1^1
"KRN",.84,36092,3,1,0)
1^number of messages
"KRN",.84,36093,-1)
0^634
"KRN",.84,36093,0)
36093^2^y^MAILMAN^|1| messages in the MESSAGE file 3.9.
"KRN",.84,36093,2,0)
^.844^1^1^3010418^^
"KRN",.84,36093,2,1,0)
|1| messages in the MESSAGE file 3.9
"KRN",.84,36093,3,0)
^.845^1^1
"KRN",.84,36093,3,1,0)
1^number of msgs
"KRN",.84,36094,-1)
0^635
"KRN",.84,36094,0)
36094^2^^MAILMAN^Checking MESSAGE file 3.9
"KRN",.84,36094,2,0)
^^1^1^3010417^
"KRN",.84,36094,2,1,0)
Checking MESSAGE file 3.9
"KRN",.84,36095,-1)
0^636
"KRN",.84,36095,0)
36095^2^^MAILMAN^Zero node is OK.
"KRN",.84,36095,2,0)
^^1^1^3010417^
"KRN",.84,36095,2,1,0)
Zero node is OK.
"KRN",.84,36096,-1)
0^637
"KRN",.84,36096,0)
36096^2^^MAILMAN^I reset the zero node.
"KRN",.84,36096,2,0)
^^1^1^3010417^
"KRN",.84,36096,2,1,0)
I reset the zero node.
"KRN",.84,36097,-1)
0^638
"KRN",.84,36097,0)
36097^2^y^MAILMAN^Msg=|1|, Err=|2|, |3|
"KRN",.84,36097,2,0)
^^1^1^3010417^
"KRN",.84,36097,2,1,0)
Msg=|1|, Err=|2|, |3|
"KRN",.84,36097,3,0)
^.845^3^3
"KRN",.84,36097,3,1,0)
1^msg ien in file 3.9
"KRN",.84,36097,3,2,0)
2^error number
"KRN",.84,36097,3,3,0)
3^error text
"KRN",.84,36098,-1)
0^639
"KRN",.84,36098,0)
36098^1^y^MAILMAN^DUZ=|1|, Bskt=|2|, Err=|3| |4|
"KRN",.84,36098,2,0)
^^1^1^2991124^
"KRN",.84,36098,2,1,0)
DUZ=|1|, Bskt=|2|, Err=|3| |4|
"KRN",.84,36098,3,0)
^.845^4^4
"KRN",.84,36098,3,1,0)
1^user's DUZ
"KRN",.84,36098,3,2,0)
2^user's basket ien
"KRN",.84,36098,3,3,0)
3^error number
"KRN",.84,36098,3,4,0)
4^error text
"KRN",.84,36098,5,0)
^.841^1^1
"KRN",.84,36098,5,1,0)
XMUT4
"KRN",.84,36098,5,"B","XMUT4",1)

"KRN",.84,36099,-1)
0^640
"KRN",.84,36099,0)
36099^1^y^MAILMAN^DUZ=|1|, Bskt=|2|, Msg=|5|, Err=|3| |4|
"KRN",.84,36099,2,0)
^^1^1^2991124^
"KRN",.84,36099,2,1,0)
DUZ=|1|, Bskt=|2|, Msg=|5|, Err=|3| |4|
"KRN",.84,36099,3,0)
^.845^5^5
"KRN",.84,36099,3,1,0)
1^user's duz
"KRN",.84,36099,3,2,0)
2^user's basket ien
"KRN",.84,36099,3,3,0)
3^error number
"KRN",.84,36099,3,4,0)
4^error text
"KRN",.84,36099,3,5,0)
5^message ien
"KRN",.84,36099,5,0)
^.841^1^1
"KRN",.84,36099,5,1,0)
XMUT4
"KRN",.84,36099,5,"B","XMUT4",1)

"KRN",.84,36101,-1)
0^641
"KRN",.84,36101,0)
36101^1^^MAILMAN^Msg in bskt, but no msg: removed from bskt
"KRN",.84,36101,2,0)
^^1^1^2991124^
"KRN",.84,36101,2,1,0)
Msg in bskt, but no msg: removed from bskt
"KRN",.84,36101,5,0)
^.841^1^1
"KRN",.84,36101,5,1,0)
XMUT4
"KRN",.84,36101,5,"B","XMUT4",1)

"KRN",.84,36101.1,-1)
0^642
"KRN",.84,36101.1,0)
36101.1^1^^MAILMAN^Msg in basket, but not in Message file: re
"KRN",.84,36101.1,2,0)
^^6^6^3010417
"KRN",.84,36101.1,2,1,0)
Msg in basket, but not in Message file: removed from basket.  *FIXED*
"KRN",.84,36101.1,2,2,0)
A message in a basket points to a non-existent message in the
"KRN",.84,36101.1,2,3,0)
message file.
"KRN",.84,36101.1,2,4,0)
To fix this, the message is removed from the basket.
"KRN",.84,36101.1,2,5,0)
If left alone, the message would have been removed from the basket
"KRN",.84,36101.1,2,6,0)
when the user tried to access the message.
"KRN",.84,36102,-1)
0^643
"KRN",.84,36102,0)
36102^1^^MAILMAN^Msg in bskt, but no seq #: seq # created
"KRN",.84,36102,2,0)
^^1^1^2991124^
"KRN",.84,36102,2,1,0)
Msg in bskt, but no seq #: seq # created
"KRN",.84,36102,5,0)
^.841^1^1
"KRN",.84,36102,5,1,0)
XMUT4
"KRN",.84,36102,5,"B","XMUT4",1)

"KRN",.84,36102.1,-1)
0^644
"KRN",.84,36102.1,0)
36102.1^1^^MAILMAN^Msg in basket, but no seq #: seq # created
"KRN",.84,36102.1,2,0)
^^6^6^3010417
"KRN",.84,36102.1,2,1,0)
Msg in basket, but no seq #: seq # created.  *FIXED*
"KRN",.84,36102.1,2,2,0)
A message in a basket has no sequence number.
"KRN",.84,36102.1,2,3,0)
To fix this, a sequence number was created to place the message at
"KRN",.84,36102.1,2,4,0)
the end of the basket.
"KRN",.84,36102.1,2,5,0)
If left alone, the user would have had difficulty locating this
"KRN",.84,36102.1,2,6,0)
message.
"KRN",.84,36103,-1)
0^645
"KRN",.84,36103,0)
36103^1^^MAILMAN^Msg in bskt, but no .01 field: .01 field
"KRN",.84,36103,2,0)
^^1^1^2991124^
"KRN",.84,36103,2,1,0)
Msg in bskt, but no .01 field: .01 field created
"KRN",.84,36103,5,0)
^.841^1^1
"KRN",.84,36103,5,1,0)
XMUT4
"KRN",.84,36103,5,"B","XMUT4",1)

"KRN",.84,36103.1,-1)
0^646
"KRN",.84,36103.1,0)
36103.1^1^^MAILMAN^Msg in basket, but no .01 field: .01 field
"KRN",.84,36103.1,2,0)
^^6^6^3010417
"KRN",.84,36103.1,2,1,0)
Msg in basket, but no .01 field: .01 field created.  *FIXED*
"KRN",.84,36103.1,2,2,0)
A message in a basket has no message number in its .01 field.
"KRN",.84,36103.1,2,3,0)
To fix this, its message number (from the IEN) was placed in the
"KRN",.84,36103.1,2,4,0)
.01 field
"KRN",.84,36103.1,2,5,0)
If left alone, the MailMan would have had difficulty dealing with
"KRN",.84,36103.1,2,6,0)
this message.
"KRN",.84,36104,-1)
0^647
"KRN",.84,36104,0)
36104^1^^MAILMAN^New msg in WASTE bskt: msg made not new
"KRN",.84,36104,2,0)
^^1^1^2991124^
"KRN",.84,36104,2,1,0)
New msg in WASTE bskt: msg made not new
"KRN",.84,36104,5,0)
^.841^1^1
"KRN",.84,36104,5,1,0)
XMUT4
"KRN",.84,36104,5,"B","XMUT4",1)

"KRN",.84,36104.1,-1)
0^648
"KRN",.84,36104.1,0)
36104.1^1^^MAILMAN^New msg in WASTE bskt: msg made not new.  
"KRN",.84,36104.1,2,0)
^^5^5^3010417
"KRN",.84,36104.1,2,1,0)
New msg in WASTE bskt: msg made not new.  *FIXED*
"KRN",.84,36104.1,2,2,0)
A message in the WASTE basket was new.
"KRN",.84,36104.1,2,3,0)
To fix this, it was made not new.
"KRN",.84,36104.1,2,4,0)
If left alone, the user would be notified of a new message in
"KRN",.84,36104.1,2,5,0)
the WASTE basket.
"KRN",.84,36111,-1)
0^649
"KRN",.84,36111,0)
36111^1^^MAILMAN^Msg in bskt, but no M xref: xref created
"KRN",.84,36111,2,0)
^^1^1^2991124^
"KRN",.84,36111,2,1,0)
Msg in bskt, but no M xref: xref created
"KRN",.84,36111,5,0)
^.841^1^1
"KRN",.84,36111,5,1,0)
XMUT4
"KRN",.84,36111,5,"B","XMUT4",1)

"KRN",.84,36111.1,-1)
0^650
"KRN",.84,36111.1,0)
36111.1^1^^MAILMAN^Msg in basket, but no M xref: xref created
"KRN",.84,36111.1,2,0)
^^7^7^3010417
"KRN",.84,36111.1,2,1,0)
Msg in basket, but no M xref: xref created.  *FIXED*
"KRN",.84,36111.1,2,2,0)
A message in a basket has no "M" cross-reference.
"KRN",.84,36111.1,2,3,0)
To fix this, the "M" cross-reference has been created.
"KRN",.84,36111.1,2,4,0)
If left alone, the 'unreferenced messages' purge might
"KRN",.84,36111.1,2,5,0)
have purged the message.
"KRN",.84,36111.1,2,6,0)
(This part of the integrity checker is called by XMAUTOPURGE
"KRN",.84,36111.1,2,7,0)
before it actually purges.)
"KRN",.84,36112,-1)
0^651
"KRN",.84,36112,0)
36112^1^^MAILMAN^Msg in bskt, but no C xref: xref created
"KRN",.84,36112,2,0)
^^1^1^2991124^
"KRN",.84,36112,2,1,0)
Msg in bskt, but no C xref: xref created
"KRN",.84,36112,5,0)
^.841^1^1
"KRN",.84,36112,5,1,0)
XMUT4
"KRN",.84,36112,5,"B","XMUT4",1)

"KRN",.84,36112.1,-1)
0^652
"KRN",.84,36112.1,0)
36112.1^1^^MAILMAN^Msg in basket, but no C xref: xref created
"KRN",.84,36112.1,2,0)
^^7^7^3010417
"KRN",.84,36112.1,2,1,0)
Msg in basket, but no C xref: xref created.  *FIXED*
"KRN",.84,36112.1,2,2,0)
A message in a basket has a sequence number,
"KRN",.84,36112.1,2,3,0)
but it is not in the "C" cross-reference for that basket.
"KRN",.84,36112.1,2,4,0)
To fix this, the "C" cross-reference has been created, using
"KRN",.84,36112.1,2,5,0)
the message's sequence number.
"KRN",.84,36112.1,2,6,0)
If left alone, the user would have had difficulty locating this
"KRN",.84,36112.1,2,7,0)
message.
"KRN",.84,36113,-1)
0^653
"KRN",.84,36113,0)
36113^1^^MAILMAN^New msg, but no N0 xref: xref created
"KRN",.84,36113,2,0)
^^1^1^2991124^
"KRN",.84,36113,2,1,0)
New msg, but no N0 xref: xref created
"KRN",.84,36113,5,0)
^.841^1^1
"KRN",.84,36113,5,1,0)
XMUT4
"KRN",.84,36113,5,"B","XMUT4",1)

"KRN",.84,36113.1,-1)
0^654
"KRN",.84,36113.1,0)
36113.1^1^^MAILMAN^New msg in basket, but no N0 xref: xref cr
"KRN",.84,36113.1,2,0)
^^5^5^3010417
"KRN",.84,36113.1,2,1,0)
New msg in basket, but no N0 xref: xref created.  *FIXED*
"KRN",.84,36113.1,2,2,0)
A message in a basket is flagged new,
"KRN",.84,36113.1,2,3,0)
but it is not in the "N0" cross-reference for that basket.
"KRN",.84,36113.1,2,4,0)
To fix this, the "N0" cross-reference has been created.
"KRN",.84,36113.1,2,5,0)
If left alone, the message would not have appeared new to the user.
"KRN",.84,36121,-1)
0^655
"KRN",.84,36121,0)
36121^1^^MAILMAN^M xref, but msg not in bskt: xref killed
"KRN",.84,36121,2,0)
^^1^1^3010417^
"KRN",.84,36121,2,1,0)
M xref, but msg not in bskt: xref killed
"KRN",.84,36121.1,-1)
0^656
"KRN",.84,36121.1,0)
36121.1^1^^MAILMAN^M xref, but not in bskt: xref killed.  *FI
"KRN",.84,36121.1,2,0)
^^6^6^3010417
"KRN",.84,36121.1,2,1,0)
M xref, but not in bskt: xref killed.  *FIXED*
"KRN",.84,36121.1,2,2,0)
A message exists in the "M" cross-reference,
"KRN",.84,36121.1,2,3,0)
but not in the basket to which it is pointing.
"KRN",.84,36121.1,2,4,0)
To fix this, the "M" cross-reference has been killed.
"KRN",.84,36121.1,2,5,0)
If left alone, the "M" cross-reference would have prevented the
"KRN",.84,36121.1,2,6,0)
message from being purged during the unreferenced messages purge.
"KRN",.84,36122,-1)
0^657
"KRN",.84,36122,0)
36122^1^^MAILMAN^C xref, but msg not in bskt: put in bskt
"KRN",.84,36122,2,0)
^^1^1^2991124^
"KRN",.84,36122,2,1,0)
C xref, but msg not in bskt: put in bskt
"KRN",.84,36122,5,0)
^.841^1^1
"KRN",.84,36122,5,1,0)
XMUT4
"KRN",.84,36122,5,"B","XMUT4",1)

"KRN",.84,36122.1,-1)
0^658
"KRN",.84,36122.1,0)
36122.1^1^^MAILMAN^C xref, but msg not in basket: msg put in 
"KRN",.84,36122.1,2,0)
^^7^7^3010417
"KRN",.84,36122.1,2,1,0)
C xref, but msg not in basket: msg put in basket.  *FIXED*
"KRN",.84,36122.1,2,2,0)
A message exists in the "C" cross-reference,
"KRN",.84,36122.1,2,3,0)
but not in the user's basket.
"KRN",.84,36122.1,2,4,0)
To fix this, the message has been put in the basket at the
"KRN",.84,36122.1,2,5,0)
sequence number indicated by the C xref.
"KRN",.84,36122.1,2,6,0)
If left alone, there would have been problems when the user
"KRN",.84,36122.1,2,7,0)
tried to access the message.
"KRN",.84,36123,-1)
0^659
"KRN",.84,36123,0)
36123^1^^MAILMAN^C xref, but no msg seq #: set seq # using
"KRN",.84,36123,2,0)
^^1^1^2991124^
"KRN",.84,36123,2,1,0)
C xref, but no msg seq #: set seq # using xref
"KRN",.84,36123,5,0)
^.841^1^1
"KRN",.84,36123,5,1,0)
XMUT4
"KRN",.84,36123,5,"B","XMUT4",1)

"KRN",.84,36123.1,-1)
0^660
"KRN",.84,36123.1,0)
36123.1^1^^MAILMAN^C xref, but no msg seq #: seq # set using 
"KRN",.84,36123.1,2,0)
^^7^7^3010417
"KRN",.84,36123.1,2,1,0)
C xref, but no msg seq #: seq # set using xref.  *FIXED*
"KRN",.84,36123.1,2,2,0)
A message exists in the "C" cross-reference,
"KRN",.84,36123.1,2,3,0)
but the sequence number is null in the basket entry.
"KRN",.84,36123.1,2,4,0)
To fix this, the message sequence number has been set using
"KRN",.84,36123.1,2,5,0)
the sequence number indicated by the C xref.
"KRN",.84,36123.1,2,6,0)
If left alone, there would have been problems when the user
"KRN",.84,36123.1,2,7,0)
tried to access the message.
"KRN",.84,36124,-1)
0^661
"KRN",.84,36124,0)
36124^1^^MAILMAN^C xref does not match msg seq #: xref kill
"KRN",.84,36124,2,0)
^^1^1^2991124^
"KRN",.84,36124,2,1,0)
C xref does not match msg seq #: xref killed
"KRN",.84,36124,5,0)
^.841^1^1
"KRN",.84,36124,5,1,0)
XMUT4
"KRN",.84,36124,5,"B","XMUT4",1)

"KRN",.84,36124.1,-1)
0^662
"KRN",.84,36124.1,0)
36124.1^1^^MAILMAN^C xref does not match msg seq #: xref kill
"KRN",.84,36124.1,2,0)
^^7^7^3010417
"KRN",.84,36124.1,2,1,0)
C xref does not match msg seq #: xref killed.  *FIXED*
"KRN",.84,36124.1,2,2,0)
A message exists in the "C" cross-reference,
"KRN",.84,36124.1,2,3,0)
but the sequence number in the basket entry differs from
"KRN",.84,36124.1,2,4,0)
the sequence number in the "C" cross-reference.
"KRN",.84,36124.1,2,5,0)
To fix this, the "C" cross-reference has been killed.
"KRN",.84,36124.1,2,6,0)
If left alone, there would have been problems when the user
"KRN",.84,36124.1,2,7,0)
tried to access the message.
"KRN",.84,36125,-1)
0^663
"KRN",.84,36125,0)
36125^1^^MAILMAN^C xref duplicate seq #s: bskt reseq'd
"KRN",.84,36125,2,0)
^^1^1^2991124^
"KRN",.84,36125,2,1,0)
C xref duplicate seq #s: bskt reseq'd
"KRN",.84,36125,5,0)
^.841^1^1
"KRN",.84,36125,5,1,0)
XMUT4
"KRN",.84,36125,5,"B","XMUT4",1)

"KRN",.84,36125.1,-1)
0^664
"KRN",.84,36125.1,0)
36125.1^1^^MAILMAN^C xref duplicate seq #s: basket reseq'd.  
"KRN",.84,36125.1,2,0)
^^5^5^3010417
"KRN",.84,36125.1,2,1,0)
C xref duplicate seq #s: basket reseq'd.  *FIXED*
"KRN",.84,36125.1,2,2,0)
More than one message has the same sequence number.
"KRN",.84,36125.1,2,3,0)
To fix this, the entire basket was reseqenced.
"KRN",.84,36125.1,2,4,0)
If left alone, there would have been problems when the user
"KRN",.84,36125.1,2,5,0)
tried to access the messages with the duplicate sequence numbers.
"KRN",.84,36126,-1)
0^665
"KRN",.84,36126,0)
36126^1^^MAILMAN^N0 xref, but msg not in bskt: msg put in
"KRN",.84,36126,2,0)
^^1^1^2991124^
"KRN",.84,36126,2,1,0)
N0 xref, but msg not in bskt: msg put in bskt
"KRN",.84,36126,5,0)
^.841^1^1
"KRN",.84,36126,5,1,0)
XMUT4
"KRN",.84,36126,5,"B","XMUT4",1)

"KRN",.84,36126.1,-1)
0^666
"KRN",.84,36126.1,0)
36126.1^1^^MAILMAN^N0 xref, but not in basket: put in basket.
"KRN",.84,36126.1,2,0)
^^6^6^3010417
"KRN",.84,36126.1,2,1,0)
N0 xref, but not in basket: put in basket.  *FIXED*
"KRN",.84,36126.1,2,2,0)
A message exists in the "N0" cross-reference,
"KRN",.84,36126.1,2,3,0)
but not in the user's basket to which it is pointing.
"KRN",.84,36126.1,2,4,0)
To fix this, the message has been put in the user's basket.
"KRN",.84,36126.1,2,5,0)
If left alone, there might have been problems when the user
"KRN",.84,36126.1,2,6,0)
tried to access the message.
"KRN",.84,36127,-1)
0^667
"KRN",.84,36127,0)
36127^1^^MAILMAN^N0 xref, but msg not new: new flag set
"KRN",.84,36127,2,0)
^^1^1^2991124^
"KRN",.84,36127,2,1,0)
N0 xref, but msg not new: new flag set
"KRN",.84,36127,5,0)
^.841^1^1
"KRN",.84,36127,5,1,0)
XMUT4
"KRN",.84,36127,5,"B","XMUT4",1)

"KRN",.84,36127.1,-1)
0^668
"KRN",.84,36127.1,0)
36127.1^1^^MAILMAN^N0 xref, but msg not flagged new: flag set
"KRN",.84,36127.1,2,0)
^^6^6^3010417
"KRN",.84,36127.1,2,1,0)
N0 xref, but msg not flagged new: flag set.  *FIXED*
"KRN",.84,36127.1,2,2,0)
A message exists in the "N0" cross-reference,
"KRN",.84,36127.1,2,3,0)
but the message isn't flagged new
"KRN",.84,36127.1,2,4,0)
To fix this, the message new flag has been set.
"KRN",.84,36127.1,2,5,0)
If left alone, the message might have remained new even after
"KRN",.84,36127.1,2,6,0)
the user read it.
"KRN",.84,36131,-1)
0^669
"KRN",.84,36131,0)
36131^1^^MAILMAN^No bskt 0 node: created
"KRN",.84,36131,2,0)
^^1^1^2991124^
"KRN",.84,36131,2,1,0)
No bskt 0 node: created
"KRN",.84,36131,5,0)
^.841^1^1
"KRN",.84,36131,5,1,0)
XMUT4
"KRN",.84,36131,5,"B","XMUT4",1)

"KRN",.84,36131.1,-1)
0^670
"KRN",.84,36131.1,0)
36131.1^1^^MAILMAN^No basket zero node or B xref: 0 node crea
"KRN",.84,36131.1,2,0)
^^6^6^3010417
"KRN",.84,36131.1,2,1,0)
No basket zero node or B xref: 0 node created.  *FIXED*
"KRN",.84,36131.1,2,2,0)
A basket has no zero node or "B" cross-reference.
"KRN",.84,36131.1,2,3,0)
To fix this, a zero node is created using and the basket is
"KRN",.84,36131.1,2,4,0)
named "* No Name *".
"KRN",.84,36131.1,2,5,0)
If left alone, there might have been problems when the user
"KRN",.84,36131.1,2,6,0)
tried to access the basket.
"KRN",.84,36132,-1)
0^671
"KRN",.84,36132,0)
36132^1^^MAILMAN^Bskt name null: created
"KRN",.84,36132,2,0)
^^1^1^2991124^
"KRN",.84,36132,2,1,0)
Bskt name null: created
"KRN",.84,36132,5,0)
^.841^1^1
"KRN",.84,36132,5,1,0)
XMUT4
"KRN",.84,36132,5,"B","XMUT4",1)

"KRN",.84,36132.1,-1)
0^672
"KRN",.84,36132.1,0)
36132.1^1^^MAILMAN^Basket zero node, but no name or B xref: 0
"KRN",.84,36132.1,2,0)
^^6^6^3010417
"KRN",.84,36132.1,2,1,0)
Basket zero node, but no name or B xref: 0 node created.  *FIXED*
"KRN",.84,36132.1,2,2,0)
A basket has a zero node, but its name is null and it has
"KRN",.84,36132.1,2,3,0)
no "B" cross-reference.
"KRN",.84,36132.1,2,4,0)
To fix this, the basket is named "* No Name *".
"KRN",.84,36132.1,2,5,0)
If left alone, there might have been problems when the user
"KRN",.84,36132.1,2,6,0)
tried to access the basket.
"KRN",.84,36133,-1)
0^673
"KRN",.84,36133,0)
36133^1^^MAILMAN^No msg multiple 0 node: created
"KRN",.84,36133,2,0)
^^1^1^2991124^
"KRN",.84,36133,2,1,0)
No msg multiple 0 node: created
"KRN",.84,36133,5,0)
^.841^1^1
"KRN",.84,36133,5,1,0)
XMUT4
"KRN",.84,36133,5,"B","XMUT4",1)

"KRN",.84,36133.1,-1)
0^674
"KRN",.84,36133.1,0)
36133.1^1^^MAILMAN^No msg multiple zero node: 0 node created.
"KRN",.84,36133.1,2,0)
^^5^5^3010417
"KRN",.84,36133.1,2,1,0)
No msg multiple zero node: 0 node created.  *FIXED*
"KRN",.84,36133.1,2,2,0)
A basket has no message multiple zero node.
"KRN",.84,36133.1,2,3,0)
To fix this, the message multiple zero node is created.
"KRN",.84,36133.1,2,4,0)
If left alone, there might have been problems when the user
"KRN",.84,36133.1,2,5,0)
tried to access the basket.
"KRN",.84,36134,-1)
0^675
"KRN",.84,36134,0)
36134^1^y^MAILMAN^Bskt name '|1|' wrong: corrected
"KRN",.84,36134,2,0)
^^1^1^2991124^^^
"KRN",.84,36134,2,1,0)
Bskt name '|1|' wrong: corrected
"KRN",.84,36134,3,0)
^.845^1^1
"KRN",.84,36134,3,1,0)
1^incorrect basket name
"KRN",.84,36134,5,0)
^.841^1^1
"KRN",.84,36134,5,1,0)
XMUT4
"KRN",.84,36134,5,"B","XMUT4",1)

"KRN",.84,36134.1,-1)
0^676
"KRN",.84,36134.1,0)
36134.1^1^^MAILMAN^Bskt name wrong: corrected.  *FIXED*
"KRN",.84,36134.1,2,0)
^^5^5^3010417
"KRN",.84,36134.1,2,1,0)
Bskt name wrong: corrected.  *FIXED*
"KRN",.84,36134.1,2,2,0)
The IN or WASTE basket is named something else.
"KRN",.84,36134.1,2,3,0)
To fix this, the basket has been renamed to its proper name.
"KRN",.84,36134.1,2,4,0)
If left alone, there might have been problems delivering mail
"KRN",.84,36134.1,2,5,0)
or handling message deletions.
"KRN",.84,36141,-1)
0^677
"KRN",.84,36141,0)
36141^1^^MAILMAN^Bskt name, but no B xref: xref created
"KRN",.84,36141,2,0)
^^1^1^2991124^
"KRN",.84,36141,2,1,0)
Bskt name, but no B xref: xref created
"KRN",.84,36141,5,0)
^.841^1^1
"KRN",.84,36141,5,1,0)
XMUT4
"KRN",.84,36141,5,"B","XMUT4",1)

"KRN",.84,36141.1,-1)
0^1439
"KRN",.84,36141.1,0)
36141.1^1^^MAILMAN^Bskt name, but no B xref: xref created
"KRN",.84,36141.1,2,0)
^^5^5^3020626^
"KRN",.84,36141.1,2,1,0)
Bskt name, but no B xref: xref created.  *FIXED*
"KRN",.84,36141.1,2,2,0)
A basket has a name, but no "B" cross-reference.
"KRN",.84,36141.1,2,3,0)
To fix this, the "B" cross-reference has been created using the basket name.
"KRN",.84,36141.1,2,4,0)
If left alone, there might have been problems when the user tried to
"KRN",.84,36141.1,2,5,0)
access the basket.
"KRN",.84,36141.1,5,0)
^.841^1^1
"KRN",.84,36141.1,5,1,0)
XMUT4
"KRN",.84,36141.1,5,"B","XMUT4",1)

"KRN",.84,36151,-1)
0^678
"KRN",.84,36151,0)
36151^1^^MAILMAN^B xref, but bskt name null: name set using
"KRN",.84,36151,2,0)
^^1^1^2991124^
"KRN",.84,36151,2,1,0)
B xref, but bskt name null: name set using xref
"KRN",.84,36151,5,0)
^.841^1^1
"KRN",.84,36151,5,1,0)
XMUT4
"KRN",.84,36151,5,"B","XMUT4",1)

"KRN",.84,36151.1,-1)
0^679
"KRN",.84,36151.1,0)
36151.1^1^^MAILMAN^B xref, but basket name null: name set usi
"KRN",.84,36151.1,2,0)
^^6^6^3010417
"KRN",.84,36151.1,2,1,0)
B xref, but basket name null: name set using xref.  *FIXED*
"KRN",.84,36151.1,2,2,0)
A basket has no name.
"KRN",.84,36151.1,2,3,0)
To fix this, the basket is named using the basket name from the
"KRN",.84,36151.1,2,4,0)
"B" cross-reference.
"KRN",.84,36151.1,2,5,0)
If left alone, there might have been problems when the user
"KRN",.84,36151.1,2,6,0)
tried to access the basket.
"KRN",.84,36152,-1)
0^680
"KRN",.84,36152,0)
36152^1^^MAILMAN^B xref, but no bskt node: node set using
"KRN",.84,36152,2,0)
^^1^1^2991124^
"KRN",.84,36152,2,1,0)
B xref, but no bskt node: node set using xref
"KRN",.84,36152,5,0)
^.841^1^1
"KRN",.84,36152,5,1,0)
XMUT4
"KRN",.84,36152,5,"B","XMUT4",1)

"KRN",.84,36152.1,-1)
0^681
"KRN",.84,36152.1,0)
36152.1^1^^MAILMAN^B xref, but no basket zero node: 0 node cr
"KRN",.84,36152.1,2,0)
^^6^6^3010417
"KRN",.84,36152.1,2,1,0)
B xref, but no basket zero node: 0 node created.  *FIXED*
"KRN",.84,36152.1,2,2,0)
A basket has no zero node.
"KRN",.84,36152.1,2,3,0)
To fix this, a zero node is created using the basket name from the
"KRN",.84,36152.1,2,4,0)
"B" cross-reference.
"KRN",.84,36152.1,2,5,0)
If left alone, there might have been problems when the user
"KRN",.84,36152.1,2,6,0)
tried to access the basket.
"KRN",.84,36153,-1)
0^682
"KRN",.84,36153,0)
36153^1^^MAILMAN^B xref does not match bskt name: xref kill
"KRN",.84,36153,2,0)
^^1^1^2991124^
"KRN",.84,36153,2,1,0)
B xref does not match bskt name: xref killed
"KRN",.84,36153,5,0)
^.841^1^1
"KRN",.84,36153,5,1,0)
XMUT4
"KRN",.84,36153,5,"B","XMUT4",1)

"KRN",.84,36153.1,-1)
0^683
"KRN",.84,36153.1,0)
36153.1^1^^MAILMAN^B xref does not match bskt name: xref kill
"KRN",.84,36153.1,2,0)
^^5^5^3010417
"KRN",.84,36153.1,2,1,0)
B xref does not match bskt name: xref killed.  *FIXED*
"KRN",.84,36153.1,2,2,0)
A B xref does not match the basket name.
"KRN",.84,36153.1,2,3,0)
To fix this, the xref is killed.
"KRN",.84,36153.1,2,4,0)
If left alone, the user would have seen the wrong basket name
"KRN",.84,36153.1,2,5,0)
in the list of baskets to choose from.
"KRN",.84,36160,-1)
0^684
"KRN",.84,36160,0)
36160^1^^MAILMAN^Xmit basket<1000 has domain name: inv
"KRN",.84,36160,2,0)
^^1^1^3010417^
"KRN",.84,36160,2,1,0)
Xmit basket<1000 has domain name: investigate msgs.
"KRN",.84,36160,3,0)
^.845^^0
"KRN",.84,36160.1,-1)
0^685
"KRN",.84,36160.1,0)
36160.1^1^^MAILMAN^Xmit basket<1000 has domain name: investig
"KRN",.84,36160.1,2,0)
^^6^6^3010417
"KRN",.84,36160.1,2,1,0)
Xmit basket<1000 has domain name: investigate msgs.  *WARNING*
"KRN",.84,36160.1,2,2,0)
One of the Postmaster's baskets with an IEN less than 1000
"KRN",.84,36160.1,2,3,0)
has the same name as of one of the domains in the DOMAIN file.
"KRN",.84,36160.1,2,4,0)
Usually, such baskets have IENs which are the DOMAIN IEN+1000 and
"KRN",.84,36160.1,2,5,0)
contain messages which are queued to be transmitted to the domain.
"KRN",.84,36160.1,2,6,0)
We must investigate the messages in this fake domain basket.
"KRN",.84,36161,-1)
0^686
"KRN",.84,36161,0)
36161^1^^MAILMAN^Msg in xmit basket<1000 not addressed to
"KRN",.84,36161,2,0)
^^1^1^3010417^
"KRN",.84,36161,2,1,0)
Msg in xmit basket<1000 not addressed to Postmaster: deleted.
"KRN",.84,36161.1,-1)
0^687
"KRN",.84,36161.1,0)
36161.1^1^^MAILMAN^Msg in xmit basket<1000 not addressed to P
"KRN",.84,36161.1,2,0)
^^4^4^3010417
"KRN",.84,36161.1,2,1,0)
Msg in xmit basket<1000 not addressed to Postmaster: deleted.  *FIXED*
"KRN",.84,36161.1,2,2,0)
A message in a fake domain basket is not addressed to the Postmaster,
"KRN",.84,36161.1,2,3,0)
and it is not queued to go to the domain,
"KRN",.84,36161.1,2,4,0)
so it has been deleted from the basket.
"KRN",.84,36162,-1)
0^688
"KRN",.84,36162,0)
36162^1^^MAILMAN^Msg in xmit basket<1000: copied to proper
"KRN",.84,36162,2,0)
^^1^1^3010417^
"KRN",.84,36162,2,1,0)
Msg in xmit basket<1000: copied to proper bskt.
"KRN",.84,36162.1,-1)
0^689
"KRN",.84,36162.1,0)
36162.1^1^^MAILMAN^Msg in xmit basket<1000: copied to proper 
"KRN",.84,36162.1,2,0)
^^4^4^3010417
"KRN",.84,36162.1,2,1,0)
Msg in xmit basket<1000: copied to proper bskt.  *FIXED*
"KRN",.84,36162.1,2,2,0)
A message in a fake domain basket is addressed to the Postmaster,
"KRN",.84,36162.1,2,3,0)
and is queued to go to the domain, but it is not in the proper
"KRN",.84,36162.1,2,4,0)
transmit basket.  It has been copied to the proper transmit basket.
"KRN",.84,36163,-1)
0^690
"KRN",.84,36163,0)
36163^1^^MAILMAN^Msg in xmit basket<1000: moved to proper
"KRN",.84,36163,2,0)
^^1^1^3010417^
"KRN",.84,36163,2,1,0)
Msg in xmit basket<1000: moved to proper bskt.
"KRN",.84,36163.1,-1)
0^691
"KRN",.84,36163.1,0)
36163.1^1^^MAILMAN^Msg in xmit basket<1000: moved to proper b
"KRN",.84,36163.1,2,0)
^^4^4^3010417
"KRN",.84,36163.1,2,1,0)
Msg in xmit basket<1000: moved to proper bskt.  *FIXED*
"KRN",.84,36163.1,2,2,0)
A message in a fake domain basket is not addressed to the Postmaster,
"KRN",.84,36163.1,2,3,0)
and is queued to go to the domain, but it is not in the proper
"KRN",.84,36163.1,2,4,0)
transmit basket.  It has been moved to the proper transmit basket.
"KRN",.84,36164,-1)
0^692
"KRN",.84,36164,0)
36164^1^^MAILMAN^Xmit basket<1000 with no msgs: deleted.
"KRN",.84,36164,2,0)
^^1^1^3010417^
"KRN",.84,36164,2,1,0)
Xmit basket<1000 with no msgs: deleted.
"KRN",.84,36164.1,-1)
0^693
"KRN",.84,36164.1,0)
36164.1^1^^MAILMAN^Xmit basket<1000 with no msgs: deleted.  *
"KRN",.84,36164.1,2,0)
^^3^3^3010417
"KRN",.84,36164.1,2,1,0)
Xmit basket<1000 with no msgs: deleted.  *FIXED*
"KRN",.84,36164.1,2,2,0)
A fake domain basket has no messages, so to avoid further confusion,
"KRN",.84,36164.1,2,3,0)
it has been deleted.
"KRN",.84,36200,-1)
0^694
"KRN",.84,36200,0)
36200^2^^MAILMAN^MailMan: Large Message Report
"KRN",.84,36200,2,0)
^^1^1^3000110^
"KRN",.84,36200,2,1,0)
MailMan: Large Message Report
"KRN",.84,36200,5,0)
^.841^1^1
"KRN",.84,36200,5,1,0)
XMUT2
"KRN",.84,36200,5,"B","XMUT2",1)

"KRN",.84,36201,-1)
0^695
"KRN",.84,36201,0)
36201^2^^MAILMAN^This report lists messages longer than
"KRN",.84,36201,2,0)
^^1^1^3000110^
"KRN",.84,36201,2,1,0)
This report lists messages longer than a certain number of lines.
"KRN",.84,36201,5,0)
^.841^1^1
"KRN",.84,36201,5,1,0)
XMUT2
"KRN",.84,36201,5,"B","XMUT2",1)

"KRN",.84,36202,-1)
0^696
"KRN",.84,36202,0)
36202^2^^MAILMAN^The default starting date is the date of
"KRN",.84,36202,2,0)
^^2^2^3000110^^
"KRN",.84,36202,2,1,0)
The default starting date is the date of the oldest message.
"KRN",.84,36202,2,2,0)
Enter the starting date
"KRN",.84,36202,5,0)
^.841^1^1
"KRN",.84,36202,5,1,0)
XMUT2
"KRN",.84,36202,5,"B","XMUT2",1)

"KRN",.84,36203,-1)
0^697
"KRN",.84,36203,0)
36203^2^^MAILMAN^Report on messages longer than this
"KRN",.84,36203,2,0)
^^1^1^3000110^
"KRN",.84,36203,2,1,0)
Report on messages longer than this many lines
"KRN",.84,36203,5,0)
^.841^1^1
"KRN",.84,36203,5,1,0)
XMUT2
"KRN",.84,36203,5,"B","XMUT2",1)

"KRN",.84,36204,-1)
0^698
"KRN",.84,36204,0)
36204^2^^MAILMAN^Make this the default for future reports
"KRN",.84,36204,2,0)
^^1^1^3000110^
"KRN",.84,36204,2,1,0)
Make this the default for future reports
"KRN",.84,36204,5,0)
^.841^1^1
"KRN",.84,36204,5,1,0)
XMUT2
"KRN",.84,36204,5,"B","XMUT2",1)

"KRN",.84,36205,-1)
0^699
"KRN",.84,36205,0)
36205^2^y^MAILMAN^Messages with more than |1| lines
"KRN",.84,36205,2,0)
^^1^1^3000110^
"KRN",.84,36205,2,1,0)
Messages with more than |1| lines
"KRN",.84,36205,3,0)
^.845^1^1
"KRN",.84,36205,3,1,0)
1^number of lines
"KRN",.84,36205,5,0)
^.841^1^1
"KRN",.84,36205,5,1,0)
XMUT2
"KRN",.84,36205,5,"B","XMUT2",1)

"KRN",.84,36206,-1)
0^700
"KRN",.84,36206,0)
36206^2^y^MAILMAN^Report date: |1|
"KRN",.84,36206,2,0)
^^1^1^3000110^
"KRN",.84,36206,2,1,0)
Report date: |1|
"KRN",.84,36206,3,0)
^.845^1^1
"KRN",.84,36206,3,1,0)
1^report date
"KRN",.84,36206,5,0)
^.841^1^1
"KRN",.84,36206,5,1,0)
XMUT2
"KRN",.84,36206,5,"B","XMUT2",1)

"KRN",.84,36207,-1)
0^701
"KRN",.84,36207,0)
36207^2^^MAILMAN^Rcpts
"KRN",.84,36207,2,0)
^^1^1^3000110^
"KRN",.84,36207,2,1,0)
Rcpts
"KRN",.84,36207,5,0)
^.841^1^1
"KRN",.84,36207,5,1,0)
XMUT2
"KRN",.84,36207,5,"B","XMUT2",1)

"KRN",.84,36210,-1)
0^702
"KRN",.84,36210,0)
36210^2^^MAILMAN^Refresh
"KRN",.84,36210,2,0)
^^1^1^3000111^
"KRN",.84,36210,2,1,0)
Refresh
"KRN",.84,36210,5,0)
^.841^1^1
"KRN",.84,36210,5,1,0)
XMUT5
"KRN",.84,36210,5,"B","XMUT5",1)

"KRN",.84,36211,-1)
0^703
"KRN",.84,36211,0)
36211^3^^MAILMAN^Answer YES if you want the display refresh
"KRN",.84,36211,2,0)
^^3^3^3000111^
"KRN",.84,36211,2,1,0)
Answer YES if you want the display refreshed.
"KRN",.84,36211,2,2,0)
Answer NO if you don't.
"KRN",.84,36211,2,3,0)
If you don't answer, the display will be refreshed every five seconds.
"KRN",.84,36211,5,0)
^.841^1^1
"KRN",.84,36211,5,1,0)
XMUT5
"KRN",.84,36211,5,"B","XMUT5",1)

"KRN",.84,36212,-1)
0^704
"KRN",.84,36212,0)
36212^2^y^MAILMAN^Delivery Queue Status as of |1|
"KRN",.84,36212,2,0)
^^1^1^3000111^
"KRN",.84,36212,2,1,0)
Delivery Queue Status as of |1|
"KRN",.84,36212,3,0)
^.845^1^1
"KRN",.84,36212,3,1,0)
1^date/time
"KRN",.84,36212,5,0)
^.841^1^1
"KRN",.84,36212,5,1,0)
XMUT5
"KRN",.84,36212,5,"B","XMUT5",1)

"KRN",.84,36213,-1)
0^705
"KRN",.84,36213,0)
36213^2^y^MAILMAN^Deliveries COMPLETED since last 1/2 hour:
"KRN",.84,36213,2,0)
^^1^1^3000111^
"KRN",.84,36213,2,1,0)
Deliveries COMPLETED since last 1/2 hour: |1| (|2| Msg, |3| Resp)
"KRN",.84,36213,3,0)
^.845^3^3
"KRN",.84,36213,3,1,0)
1^total deliveries
"KRN",.84,36213,3,2,0)
2^message deliveries
"KRN",.84,36213,3,3,0)
3^response deliveries
"KRN",.84,36213,5,0)
^.841^1^1
"KRN",.84,36213,5,1,0)
XMUT5
"KRN",.84,36213,5,"B","XMUT5",1)

"KRN",.84,36214,-1)
0^706
"KRN",.84,36214,0)
36214^2^y^MAILMAN^Number of delivery queues: |1| Message and
"KRN",.84,36214,2,0)
^^1^1^3000111^
"KRN",.84,36214,2,1,0)
Number of delivery queues: |1| Message and |2| Response
"KRN",.84,36214,3,0)
^.845^2^2
"KRN",.84,36214,3,1,0)
1^message queues
"KRN",.84,36214,3,2,0)
2^response queues
"KRN",.84,36214,5,0)
^.841^1^1
"KRN",.84,36214,5,1,0)
XMUT5
"KRN",.84,36214,5,"B","XMUT5",1)

"KRN",.84,36215,-1)
0^707
"KRN",.84,36215,0)
36215^2^y^MAILMAN^Waiting time for items to be put in
"KRN",.84,36215,2,0)
^^1^1^3000111^
"KRN",.84,36215,2,1,0)
Waiting time for items to be put in the delivery queues: |1|
"KRN",.84,36215,3,0)
^.845^1^1
"KRN",.84,36215,3,1,0)
1^waiting time
"KRN",.84,36215,5,0)
^.841^1^1
"KRN",.84,36215,5,1,0)
XMUT5
"KRN",.84,36215,5,"B","XMUT5",1)

"KRN",.84,36216,-1)
0^708
"KRN",.84,36216,0)
36216^2^^MAILMAN^Nothing waiting to be put in the delivery
"KRN",.84,36216,2,0)
^^1^1^3000111^
"KRN",.84,36216,2,1,0)
Nothing waiting to be put in the delivery queues.
"KRN",.84,36216,5,0)
^.841^1^1
"KRN",.84,36216,5,1,0)
XMUT5
"KRN",.84,36216,5,"B","XMUT5",1)

"KRN",.84,36217,-1)
0^709
"KRN",.84,36217,0)
36217^2^^MAILMAN^Nothing in the delivery queues.
"KRN",.84,36217,2,0)
^^1^1^3000111^
"KRN",.84,36217,2,1,0)
Nothing in the delivery queues.
"KRN",.84,36217,5,0)
^.841^1^1
"KRN",.84,36217,5,1,0)
XMUT5
"KRN",.84,36217,5,"B","XMUT5",1)

"KRN",.84,36218,-1)
0^710
"KRN",.84,36218,0)
36218^2^y^MAILMAN^Items currently waiting in delivery queues
"KRN",.84,36218,2,0)
^^1^1^3000111^
"KRN",.84,36218,2,1,0)
Items currently waiting in delivery queues: |1|
"KRN",.84,36218,3,0)
^.845^1^1
"KRN",.84,36218,3,1,0)
1^number of messages in the delivery queues
"KRN",.84,36218,5,0)
^.841^1^1
"KRN",.84,36218,5,1,0)
XMUT5
"KRN",.84,36218,5,"B","XMUT5",1)

"KRN",.84,36219,-1)
0^711
"KRN",.84,36219,0)
36219^2^^MAILMAN^Message Group
"KRN",.84,36219,2,0)
^^2^2^3000111^
"KRN",.84,36219,2,1,0)
                                                          Msg being     *Latest
"KRN",.84,36219,2,2,0)
Message Group    Messages  Deliveries  Waiting Time       Delivered    Delivery
"KRN",.84,36219,5,0)
^.841^1^1
"KRN",.84,36219,5,1,0)
XMUT5
"KRN",.84,36219,5,"B","XMUT5",1)

"KRN",.84,36220,-1)
0^712
"KRN",.84,36220,0)
36220^2^^MAILMAN^Response Group
"KRN",.84,36220,2,0)
^^2^2^3000112^^
"KRN",.84,36220,2,1,0)
                                                          Msg being
"KRN",.84,36220,2,2,0)
Response Group  Responses  Deliveries  Waiting Time       Delivered
"KRN",.84,36220,5,0)
^.841^1^1
"KRN",.84,36220,5,1,0)
XMUT5
"KRN",.84,36220,5,"B","XMUT5",1)

"KRN",.84,36221,-1)
0^713
"KRN",.84,36221,0)
36221^2^^MAILMAN^Summary
"KRN",.84,36221,2,0)
^^1^1^3000111^
"KRN",.84,36221,2,1,0)
Summary
"KRN",.84,36221,5,0)
^.841^1^1
"KRN",.84,36221,5,1,0)
XMUT5
"KRN",.84,36221,5,"B","XMUT5",1)

"KRN",.84,36222,-1)
0^714
"KRN",.84,36222,0)
36222^2^^MAILMAN^*Latest Delivery shows last user with
"KRN",.84,36222,2,0)
^^3^3^3000112^^
"KRN",.84,36222,2,1,0)
*Latest Delivery shows last user with message in mailbox.
"KRN",.84,36222,2,2,0)
Meaningful for new messages, possibly meaningful for forwarded (f) messages.
"KRN",.84,36222,2,3,0)
Not meaningful and not shown for responses.
"KRN",.84,36222,5,0)
^.841^1^1
"KRN",.84,36222,5,1,0)
XMUT5
"KRN",.84,36222,5,"B","XMUT5",1)

"KRN",.84,36223,-1)
0^715
"KRN",.84,36223,0)
36223^2^^MAILMAN^(f)
"KRN",.84,36223,1,0)
^^1^1^3000111^
"KRN",.84,36223,1,1,0)
Same as the item in parens in dialog 36222.
"KRN",.84,36223,2,0)
^^1^1^3000111^
"KRN",.84,36223,2,1,0)
(f)
"KRN",.84,36223,5,0)
^.841^1^1
"KRN",.84,36223,5,1,0)
XMUT5B
"KRN",.84,36223,5,"B","XMUT5B",1)

"KRN",.84,36224,-1)
0^716
"KRN",.84,36224,0)
36224^2^^MAILMAN^Background filer status: 
"KRN",.84,36224,1,0)
^^1^1^3000111^
"KRN",.84,36224,1,1,0)
note: there is one blank at the end of this dialog.
"KRN",.84,36224,2,0)
^^1^1^3000111^
"KRN",.84,36224,2,1,0)
Background filer status: 
"KRN",.84,36224,5,0)
^.841^1^1
"KRN",.84,36224,5,1,0)
XMUT5
"KRN",.84,36224,5,"B","XMUT5",1)

"KRN",.84,36224.1,-1)
0^717
"KRN",.84,36224.1,0)
36224.1^2^^MAILMAN^The Mover is not running!
"KRN",.84,36224.1,2,0)
^^1^1^3000728^
"KRN",.84,36224.1,2,1,0)
The Mover is not running!
"KRN",.84,36224.1,5,0)
^.841^1^1
"KRN",.84,36224.1,5,1,0)
XMKPL
"KRN",.84,36224.1,5,"B","XMKPL",1)

"KRN",.84,36224.2,-1)
0^718
"KRN",.84,36224.2,0)
36224.2^2^^MAILMAN^The Tickler is not running!
"KRN",.84,36224.2,2,0)
^^1^1^3000728^
"KRN",.84,36224.2,2,1,0)
The Tickler is not running!
"KRN",.84,36224.2,5,0)
^.841^1^1
"KRN",.84,36224.2,5,1,0)
XMKPL
"KRN",.84,36224.2,5,"B","XMKPL",1)

"KRN",.84,36225,-1)
0^719
"KRN",.84,36225,0)
36225^2^^MAILMAN^Background Filers are running.
"KRN",.84,36225,2,0)
^.844^1^1^3000728^^
"KRN",.84,36225,2,1,0)
Background Filers are running.
"KRN",.84,36225,5,0)
^.841^1^1
"KRN",.84,36225,5,1,0)
XMUT5
"KRN",.84,36225,5,"B","XMUT5",1)

"KRN",.84,36226,-1)
0^720
"KRN",.84,36226,0)
36226^2^^MAILMAN^The Background Filers have been shut down
"KRN",.84,36226,2,0)
^.844^3^3^3000418^^
"KRN",.84,36226,2,1,0)
The Background Filers have been shut down.
"KRN",.84,36226,2,2,0)
Until they are restarted, local mail will not be delivered.
"KRN",.84,36226,2,3,0)
To restart them, use the option: XMMGR-START-BACKGROUND-FILER
"KRN",.84,36226,5,0)
^.841^1^1
"KRN",.84,36226,5,1,0)
XMUT5
"KRN",.84,36226,5,"B","XMUT5",1)

"KRN",.84,36227,-1)
0^721
"KRN",.84,36227,0)
36227^2^^MAILMAN^MailMan: Background Filer (Mover)
"KRN",.84,36227,2,0)
^^1^1^3000728^
"KRN",.84,36227,2,1,0)
MailMan: Background Filer (Mover)
"KRN",.84,36227,5,0)
^.841^1^1
"KRN",.84,36227,5,1,0)
XMKPL
"KRN",.84,36227,5,"B","XMKPL",1)

"KRN",.84,36228,-1)
0^722
"KRN",.84,36228,0)
36228^2^^MAILMAN^MailMan: Background Filer (Tickler)
"KRN",.84,36228,2,0)
^^1^1^3000728^
"KRN",.84,36228,2,1,0)
MailMan: Background Filer (Tickler)
"KRN",.84,36228,5,0)
^.841^1^1
"KRN",.84,36228,5,1,0)
XMKPL
"KRN",.84,36228,5,"B","XMKPL",1)

"KRN",.84,36229,-1)
0^723
"KRN",.84,36229,0)
36229^2^^MAILMAN^Are you sure you want the Background
"KRN",.84,36229,2,0)
^^1^1^3000728^
"KRN",.84,36229,2,1,0)
Are you sure you want the Background Filers to stop delivering mail
"KRN",.84,36229,5,0)
^.841^1^1
"KRN",.84,36229,5,1,0)
XMKPL
"KRN",.84,36229,5,"B","XMKPL",1)

"KRN",.84,36229.1,-1)
0^724
"KRN",.84,36229.1,0)
36229.1^2^^MAILMAN^<< Background Filers will stop soon. >>
"KRN",.84,36229.1,2,0)
^^1^1^3000728^
"KRN",.84,36229.1,2,1,0)
<< Background Filers will stop soon. >>
"KRN",.84,36229.1,5,0)
^.841^1^1
"KRN",.84,36229.1,5,1,0)
XMKPL
"KRN",.84,36229.1,5,"B","XMKPL",1)

"KRN",.84,36229.2,-1)
0^725
"KRN",.84,36229.2,0)
36229.2^2^^MAILMAN^<< Background Filers will start soon. >>
"KRN",.84,36229.2,2,0)
^^1^1^3000728^
"KRN",.84,36229.2,2,1,0)
<< Background Filers will start soon. >>
"KRN",.84,36229.2,5,0)
^.841^1^1
"KRN",.84,36229.2,5,1,0)
XMKPL
"KRN",.84,36229.2,5,"B","XMKPL",1)

"KRN",.84,36230,-1)
0^726
"KRN",.84,36230,0)
36230^2^y^MAILMAN^MailMan: Message Delivery Queue |1|
"KRN",.84,36230,2,0)
^^1^1^3000728^
"KRN",.84,36230,2,1,0)
MailMan: Message Delivery Queue |1|
"KRN",.84,36230,3,0)
^.845^1^1
"KRN",.84,36230,3,1,0)
1^queue number
"KRN",.84,36230,5,0)
^.841^1^1
"KRN",.84,36230,5,1,0)
XMKPLQ
"KRN",.84,36230,5,"B","XMKPLQ",1)

"KRN",.84,36231,-1)
0^727
"KRN",.84,36231,0)
36231^2^y^MAILMAN^MailMan: Response Delivery Queue |1|
"KRN",.84,36231,2,0)
^.844^1^1^3000728^
"KRN",.84,36231,2,1,0)
MailMan: Response Delivery Queue |1|
"KRN",.84,36231,3,0)
^.845^1^1
"KRN",.84,36231,3,1,0)
1^queue number
"KRN",.84,36231,5,0)
^.841^1^1
"KRN",.84,36231,5,1,0)
XMKPLQ
"KRN",.84,36231,5,"B","XMKPLQ",1)

"KRN",.84,36232,-1)
0^728
"KRN",.84,36232,0)
36232^2^^MAILMAN^You determine the number of delivery queue
"KRN",.84,36232,2,0)
^.844^21^21^3000728^
"KRN",.84,36232,2,1,0)
You determine the number of delivery queues (10 max.) by what you enter in
"KRN",.84,36232,2,2,0)
this field.  Each number designates a queue boundary and a boundary of the
"KRN",.84,36232,2,3,0)
number of recipients per message which a queue may handle.
"KRN",.84,36232,2,4,0)
 
"KRN",.84,36232,2,5,0)
By creating more than one delivery queue, messages with approximately the
"KRN",.84,36232,2,6,0)
same number of recipients will queue up together.  Each delivery queue is
"KRN",.84,36232,2,7,0)
handled by a separate task.  In this way, a message with many recipients
"KRN",.84,36232,2,8,0)
won't hold up the delivery of a message with few recipients.
"KRN",.84,36232,2,9,0)
 
"KRN",.84,36232,2,10,0)
For example:
"KRN",.84,36232,2,11,0)
A null entry means there will be one queue into which all messages are placed.
"KRN",.84,36232,2,12,0)
 
"KRN",.84,36232,2,13,0)
If you enter '10' it means that there will be two queues.
"KRN",.84,36232,2,14,0)
The first will deliver messages with fewer than 10 recipients.
"KRN",.84,36232,2,15,0)
The second will deliver messages with 10 or more recipients.
"KRN",.84,36232,2,16,0)
 
"KRN",.84,36232,2,17,0)
If you enter '50,100,200' there will be four (4) queues.
"KRN",.84,36232,2,18,0)
The first will deliver messages with fewer than 50 recipients.
"KRN",.84,36232,2,19,0)
The second will deliver messages with from 50 to 99 recipients.
"KRN",.84,36232,2,20,0)
The third will deliver messages with from 100 to 199 recipients.
"KRN",.84,36232,2,21,0)
The fourth will deliver messages with 200 or more recipients.
"KRN",.84,36232,5,0)
^.841^1^1
"KRN",.84,36232,5,1,0)
XMKPLQ
"KRN",.84,36232,5,"B","XMKPLQ",1)

"KRN",.84,36240,-1)
0^729
"KRN",.84,36240,0)
36240^1^y^MAILMAN^Message |1| does not exist.
"KRN",.84,36240,2,0)
^.844^1^1^3000731^^
"KRN",.84,36240,2,1,0)
Message |1| does not exist.  Can't post responses to it.
"KRN",.84,36240,3,0)
^.845^1^1
"KRN",.84,36240,3,1,0)
1^message number
"KRN",.84,36240,5,0)
^.841^1^1
"KRN",.84,36240,5,1,0)
XMTDL
"KRN",.84,36240,5,"B","XMTDL",1)

"KRN",.84,36241,-1)
0^730
"KRN",.84,36241,0)
36241^1^y^MAILMAN^Response |2| to message |1| does not exis
"KRN",.84,36241,2,0)
^^1^1^3000731^
"KRN",.84,36241,2,1,0)
Response |2| to message |1| does not exist.  Can't deliver it.
"KRN",.84,36241,3,0)
^.845^2^2
"KRN",.84,36241,3,1,0)
1^message number
"KRN",.84,36241,3,2,0)
2^response number
"KRN",.84,36241,5,0)
^.841^1^1
"KRN",.84,36241,5,1,0)
XMTDL
"KRN",.84,36241,5,"B","XMTDL",1)

"KRN",.84,36242,-1)
0^731
"KRN",.84,36242,0)
36242^1^y^MAILMAN^Message |1| does not exist.  Can't deliver
"KRN",.84,36242,2,0)
^^1^1^3000731^
"KRN",.84,36242,2,1,0)
Message |1| does not exist.  Can't deliver it.
"KRN",.84,36242,3,0)
^.845^1^1
"KRN",.84,36242,3,1,0)
1^message ien
"KRN",.84,36242,5,0)
^.841^1^1
"KRN",.84,36242,5,1,0)
XMTDL
"KRN",.84,36242,5,"B","XMTDL",1)

"KRN",.84,36300,-1)
0^732
"KRN",.84,36300,0)
36300^1^^MAILMAN^You must hold the XMMGR key to run this op
"KRN",.84,36300,2,0)
^.844^1^1^3000421^^^
"KRN",.84,36300,2,1,0)
You must hold the XMMGR key to run this option.
"KRN",.84,36300,5,0)
^.841^1^1
"KRN",.84,36300,5,1,0)
XMUTERM
"KRN",.84,36300,5,"B","XMUTERM",1)

"KRN",.84,36301,-1)
0^733
"KRN",.84,36301,0)
36301^2^^MAILMAN^This option enables you to purge any mess
"KRN",.84,36301,2,0)
^^9^9^3000420^
"KRN",.84,36301,2,1,0)
This option enables you to purge any message.
"KRN",.84,36301,2,2,0)
 
"KRN",.84,36301,2,3,0)
Purge means:
"KRN",.84,36301,2,4,0)
-delete the message from all user mailboxes
"KRN",.84,36301,2,5,0)
-delete the message from the MESSAGE file ^XMB(3.9
"KRN",.84,36301,2,6,0)
-delete all of its responses from the MESSAGE file ^XMB(3.9
"KRN",.84,36301,2,7,0)
-delete the message from the MESSAGES TO BE NEW AT A LATER DATE file ^XMB(3.73
"KRN",.84,36301,2,8,0)
 
"KRN",.84,36301,2,9,0)
Purge is not reversible  The message is gone forever.
"KRN",.84,36301,5,0)
^.841^1^1
"KRN",.84,36301,5,1,0)
XMUTERM
"KRN",.84,36301,5,"B","XMUTERM",1)

"KRN",.84,36302,-1)
0^734
"KRN",.84,36302,0)
36302^2^^MAILMAN^Purge MESSAGE
"KRN",.84,36302,2,0)
^^1^1^3000420^
"KRN",.84,36302,2,1,0)
Purge MESSAGE
"KRN",.84,36302,5,0)
^.841^1^1
"KRN",.84,36302,5,1,0)
XMUTERM
"KRN",.84,36302,5,"B","XMUTERM",1)

"KRN",.84,36303,-1)
0^735
"KRN",.84,36303,0)
36303^3^^MAILMAN^This response must be a message number.
"KRN",.84,36303,2,0)
^^1^1^3000420^
"KRN",.84,36303,2,1,0)
This response must be a message number.
"KRN",.84,36303,5,0)
^.841^1^1
"KRN",.84,36303,5,1,0)
XMUTERM
"KRN",.84,36303,5,"B","XMUTERM",1)

"KRN",.84,36304,-1)
0^736
"KRN",.84,36304,0)
36304^2^^MAILMAN^Are you sure you want to purge this mess
"KRN",.84,36304,2,0)
^^1^1^3000420^
"KRN",.84,36304,2,1,0)
Are you sure you want to purge this message
"KRN",.84,36304,5,0)
^.841^1^1
"KRN",.84,36304,5,1,0)
XMUTERM
"KRN",.84,36304,5,"B","XMUTERM",1)

"KRN",.84,36305,-1)
0^737
"KRN",.84,36305,0)
36305^2^^MAILMAN^Message not purged.
"KRN",.84,36305,2,0)
^^1^1^3000420^
"KRN",.84,36305,2,1,0)
Message not purged.
"KRN",.84,36305,5,0)
^.841^1^1
"KRN",.84,36305,5,1,0)
XMUTERM
"KRN",.84,36305,5,"B","XMUTERM",1)

"KRN",.84,36306,-1)
0^738
"KRN",.84,36306,0)
36306^2^y^MAILMAN^|1| message and |2| response(s) purged.
"KRN",.84,36306,2,0)
^^1^1^3000420^
"KRN",.84,36306,2,1,0)
|1| message and |2| response(s) purged.
"KRN",.84,36306,3,0)
^.845^2^2
"KRN",.84,36306,3,1,0)
1^number of messages purged
"KRN",.84,36306,3,2,0)
2^number of responses purged
"KRN",.84,36306,5,0)
^.841^1^1
"KRN",.84,36306,5,1,0)
XMUTERM
"KRN",.84,36306,5,"B","XMUTERM",1)

"KRN",.84,36309,-1)
0^739
"KRN",.84,36309,0)
36309^2^^MAILMAN^This option goes through the MailBox glob
"KRN",.84,36309,2,0)
^^1^1^3000420^
"KRN",.84,36309,2,1,0)
This option goes through the MailBox global and deletes the user's mailbox if
"KRN",.84,36309,5,0)
^.841^1^1
"KRN",.84,36309,5,1,0)
XMUTERM
"KRN",.84,36309,5,"B","XMUTERM",1)

"KRN",.84,36309.5,-1)
0^740
"KRN",.84,36309.5,0)
36309.5^2^^MAILMAN^However, if the user meets one of the last
"KRN",.84,36309.5,2,0)
^.844^3^3^3010731^^
"KRN",.84,36309.5,2,1,0)
However, if the user meets one of the last two conditions above, but has
"KRN",.84,36309.5,2,2,0)
a forwarding address, the user's mailbox will not be deleted.  The fact
"KRN",.84,36309.5,2,3,0)
will be noted with '***', and the user should be investigated further.  
"KRN",.84,36309.5,5,0)
^.841^1^1
"KRN",.84,36309.5,5,1,0)
XMUTERM
"KRN",.84,36309.5,5,"B","XMUTERM",1)

"KRN",.84,36310,-1)
0^741
"KRN",.84,36310,0)
36310^2^^MAILMAN^This option lets you delete the mailbox
"KRN",.84,36310,2,0)
^^1^1^3000420^
"KRN",.84,36310,2,1,0)
This option lets you delete the mailbox of a user if
"KRN",.84,36310,5,0)
^.841^1^1
"KRN",.84,36310,5,1,0)
XMUTERM
"KRN",.84,36310,5,"B","XMUTERM",1)

"KRN",.84,36311,-1)
0^742
"KRN",.84,36311,0)
36311^2^^MAILMAN^- the user is not in the NEW PERSON file.
"KRN",.84,36311,2,0)
^.844^16^16^3010731^^^
"KRN",.84,36311,2,1,0)
- the user is not in the NEW PERSON file.
"KRN",.84,36311,2,2,0)
- the user has no access code and was not terminated.
"KRN",.84,36311,2,3,0)
- the user has no access code and was terminated w/o mailbox retention.
"KRN",.84,36311,2,4,0)
- the user has an access code, but no primary menu.
"KRN",.84,36311,2,5,0)
- the user has an access code and primary menu, but no verify code AND
"KRN",.84,36311,2,6,0)
  - has never signed on or used mail, since being added before a cutoff date.
"KRN",.84,36311,2,7,0)
  OR
"KRN",.84,36311,2,8,0)
  - last signed on or used mail before a cutoff date.
"KRN",.84,36311,2,9,0)
 
"KRN",.84,36311,2,10,0)
'Delete mailbox' includes:
"KRN",.84,36311,2,11,0)
- Delete user's private mail groups
"KRN",.84,36311,2,12,0)
- Remove user from membership in any group
"KRN",.84,36311,2,13,0)
- Remove user as authorized sender from any group
"KRN",.84,36311,2,14,0)
- Remove user from anyone's list of surrogates
"KRN",.84,36311,2,15,0)
- Delete user's mailbox
"KRN",.84,36311,2,16,0)
As a result, the user will not receive any mail.
"KRN",.84,36311,5,0)
^.841^1^1
"KRN",.84,36311,5,1,0)
XMUTERM
"KRN",.84,36311,5,"B","XMUTERM",1)

"KRN",.84,36312,-1)
0^743
"KRN",.84,36312,0)
36312^2^^MAILMAN^This option goes through the MailBox glob
"KRN",.84,36312,2,0)
^^1^1^3000420^
"KRN",.84,36312,2,1,0)
This option goes through the MailBox global and reports if
"KRN",.84,36312,5,0)
^.841^1^1
"KRN",.84,36312,5,1,0)
XMUTERM
"KRN",.84,36312,5,"B","XMUTERM",1)

"KRN",.84,36313,-1)
0^744
"KRN",.84,36313,0)
36313^2^^MAILMAN^- the user was terminated before a cutoff
"KRN",.84,36313,2,0)
^.844^6^6^3010821^^^^
"KRN",.84,36313,2,1,0)
- the user was DISUSER'd.
"KRN",.84,36313,2,2,0)
- the user was terminated before a cutoff date and allowed to keep a mailbox.
"KRN",.84,36313,2,3,0)
- the user has an access code, verify code, and primary menu, AND
"KRN",.84,36313,2,4,0)
  - has never signed on or used mail, since being added before a cutoff date.
"KRN",.84,36313,2,5,0)
  OR
"KRN",.84,36313,2,6,0)
  - last signed on or used mail before a cutoff date.
"KRN",.84,36313,5,0)
^.841^1^1
"KRN",.84,36313,5,1,0)
XMUTERM
"KRN",.84,36313,5,"B","XMUTERM",1)

"KRN",.84,36314,-1)
0^745
"KRN",.84,36314,0)
36314^2^^MAILMAN^This option does not delete any mailboxes.
"KRN",.84,36314,2,0)
^^2^2^3000420^
"KRN",.84,36314,2,1,0)
This option does not delete any mailboxes.  Use the XM-TERMINATE-ONE-USER
"KRN",.84,36314,2,2,0)
option to delete any user mailboxes identified in this report.
"KRN",.84,36314,5,0)
^.841^1^1
"KRN",.84,36314,5,1,0)
XMUTERM
"KRN",.84,36314,5,"B","XMUTERM",1)

"KRN",.84,36315,-1)
0^746
"KRN",.84,36315,0)
36315^2^^MAILMAN^Logon cutoff date
"KRN",.84,36315,2,0)
^^1^1^3000420^
"KRN",.84,36315,2,1,0)
Logon cutoff date
"KRN",.84,36315,5,0)
^.841^1^1
"KRN",.84,36315,5,1,0)
XMUTERM
"KRN",.84,36315,5,"B","XMUTERM",1)

"KRN",.84,36316,-1)
0^747
"KRN",.84,36316,0)
36316^3^^MAILMAN^The cutoff date must be more than 30 days
"KRN",.84,36316,2,0)
^.844^2^2^3000420^^^
"KRN",.84,36316,2,1,0)
The cutoff date must be more than 30 days ago.
"KRN",.84,36316,2,2,0)
It is used during the check to see if
"KRN",.84,36316,5,0)
^.841^1^1
"KRN",.84,36316,5,1,0)
XMUTERM
"KRN",.84,36316,5,"B","XMUTERM",1)

"KRN",.84,36317,-1)
0^748
"KRN",.84,36317,0)
36317^3^^MAILMAN^- the user has an access code and primary
"KRN",.84,36317,2,0)
^.844^4^4^3010731^^
"KRN",.84,36317,2,1,0)
- the user has an access code and primary menu, but no verify code, AND
"KRN",.84,36317,2,2,0)
  - has never signed on or used mail, since being added before a cutoff date.
"KRN",.84,36317,2,3,0)
  OR
"KRN",.84,36317,2,4,0)
  - last signed on or used mail before a cutoff date.
"KRN",.84,36317,5,0)
^.841^1^1
"KRN",.84,36317,5,1,0)
XMUTERM
"KRN",.84,36317,5,"B","XMUTERM",1)

"KRN",.84,36318,-1)
0^749
"KRN",.84,36318,0)
36318^3^^MAILMAN^- the user has an access code, verify code
"KRN",.84,36318,2,0)
^.844^4^4^3010731^^
"KRN",.84,36318,2,1,0)
- the user has an access code, verify code, and primary menu, AND
"KRN",.84,36318,2,2,0)
  - has never signed on or used mail, since being added before a cutoff date.
"KRN",.84,36318,2,3,0)
  OR
"KRN",.84,36318,2,4,0)
  - last signed on or used mail before a cutoff date.
"KRN",.84,36318,5,0)
^.841^1^1
"KRN",.84,36318,5,1,0)
XMUTERM
"KRN",.84,36318,5,"B","XMUTERM",1)

"KRN",.84,36319,-1)
0^750
"KRN",.84,36319,0)
36319^3^^MAILMAN^(If you do not wish to check mailboxes
"KRN",.84,36319,2,0)
^.844^3^3^3000420^^
"KRN",.84,36319,2,1,0)
(If you do not wish to check mailboxes based on a cutoff date, enter '1900'.)
"KRN",.84,36319,2,2,0)
 
"KRN",.84,36319,2,3,0)
Please enter that cutoff date.
"KRN",.84,36319,5,0)
^.841^1^1
"KRN",.84,36319,5,1,0)
XMUTERM
"KRN",.84,36319,5,"B","XMUTERM",1)

"KRN",.84,36321,-1)
0^751
"KRN",.84,36321,0)
36321^2^^MAILMAN^T:Test Mode only
"KRN",.84,36321,2,0)
^^1^1^3000420^
"KRN",.84,36321,2,1,0)
T:Test Mode only
"KRN",.84,36321,5,0)
^.841^1^1
"KRN",.84,36321,5,1,0)
XMUTERM
"KRN",.84,36321,5,"B","XMUTERM",1)

"KRN",.84,36322,-1)
0^752
"KRN",.84,36322,0)
36322^2^^MAILMAN^R:Real Mode
"KRN",.84,36322,2,0)
^^1^1^3000420^
"KRN",.84,36322,2,1,0)
R:Real Mode
"KRN",.84,36322,5,0)
^.841^1^1
"KRN",.84,36322,5,1,0)
XMUTERM
"KRN",.84,36322,5,"B","XMUTERM",1)

"KRN",.84,36323,-1)
0^753
"KRN",.84,36323,0)
36323^2^^MAILMAN^Select Run Option
"KRN",.84,36323,2,0)
^^1^1^3000420^
"KRN",.84,36323,2,1,0)
Select Run Option
"KRN",.84,36323,5,0)
^.841^1^1
"KRN",.84,36323,5,1,0)
XMUTERM
"KRN",.84,36323,5,"B","XMUTERM",1)

"KRN",.84,36324,-1)
0^754
"KRN",.84,36324,0)
36324^3^^MAILMAN^'Real Mode' will remove qualifying users
"KRN",.84,36324,2,0)
^^4^4^3000420^
"KRN",.84,36324,2,1,0)
'Real Mode' will remove qualifying users from MailMan.
"KRN",.84,36324,2,2,0)
'Test Mode' will not.
"KRN",.84,36324,2,3,0)
Select 'Test Mode' to see who would be removed.
"KRN",.84,36324,2,4,0)
Select 'Real Mode' to remove them.
"KRN",.84,36324,5,0)
^.841^1^1
"KRN",.84,36324,5,1,0)
XMUTERM
"KRN",.84,36324,5,"B","XMUTERM",1)

"KRN",.84,36325,-1)
0^755
"KRN",.84,36325,0)
36325^2^^MAILMAN^This report may take a while.  You might
"KRN",.84,36325,2,0)
^^1^1^3000420^
"KRN",.84,36325,2,1,0)
This report may take a while.  You might consider spooling it.
"KRN",.84,36325,5,0)
^.841^1^1
"KRN",.84,36325,5,1,0)
XMUTERM
"KRN",.84,36325,5,"B","XMUTERM",1)

"KRN",.84,36326,-1)
0^756
"KRN",.84,36326,0)
36326^2^^MAILMAN^MailMan: Remove user MailBoxes
"KRN",.84,36326,2,0)
^^1^1^3000420^
"KRN",.84,36326,2,1,0)
MailMan: Remove user MailBoxes
"KRN",.84,36326,5,0)
^.841^1^1
"KRN",.84,36326,5,1,0)
XMUTERM
"KRN",.84,36326,5,"B","XMUTERM",1)

"KRN",.84,36327,-1)
0^757
"KRN",.84,36327,0)
36327^2^^MAILMAN^MailMan: Suggest Remove user Mailboxes
"KRN",.84,36327,2,0)
^^1^1^3000420^
"KRN",.84,36327,2,1,0)
MailMan: Suggest Remove user Mailboxes
"KRN",.84,36327,5,0)
^.841^1^1
"KRN",.84,36327,5,1,0)
XMUTERM
"KRN",.84,36327,5,"B","XMUTERM",1)

"KRN",.84,36330,-1)
0^758
"KRN",.84,36330,0)
36330^2^^MAILMAN^M:MailMan presents;I:I select
"KRN",.84,36330,2,0)
^^1^1^3000420^
"KRN",.84,36330,2,1,0)
M:MailMan presents;I:I select
"KRN",.84,36330,5,0)
^.841^1^1
"KRN",.84,36330,5,1,0)
XMUTERM
"KRN",.84,36330,5,"B","XMUTERM",1)

"KRN",.84,36332,-1)
0^759
"KRN",.84,36332,0)
36332^3^^MAILMAN^Select 'M' if you want MailMan to $Order
"KRN",.84,36332,2,0)
^^4^4^3000420^
"KRN",.84,36332,2,1,0)
Select 'M' if you want MailMan to $Order through the MailBox file and
"KRN",.84,36332,2,2,0)
present to you candidates for mailbox deletion.
"KRN",.84,36332,2,3,0)
 
"KRN",.84,36332,2,4,0)
Select 'I' if you want to do the selection directly.
"KRN",.84,36332,5,0)
^.841^1^1
"KRN",.84,36332,5,1,0)
XMUTERM
"KRN",.84,36332,5,"B","XMUTERM",1)

"KRN",.84,36334,-1)
0^760
"KRN",.84,36334,0)
36334^2^^MAILMAN^NONE
"KRN",.84,36334,2,0)
^^1^1^3000421^
"KRN",.84,36334,2,1,0)
NONE
"KRN",.84,36334,5,0)
^.841^1^1
"KRN",.84,36334,5,1,0)
XMUTERM
"KRN",.84,36334,5,"B","XMUTERM",1)

"KRN",.84,36335,-1)
0^761
"KRN",.84,36335,0)
36335^2^^MAILMAN^<Hidden>
"KRN",.84,36335,2,0)
^^1^1^3000421^
"KRN",.84,36335,2,1,0)
<Hidden>
"KRN",.84,36335,5,0)
^.841^1^1
"KRN",.84,36335,5,1,0)
XMUTERM
"KRN",.84,36335,5,"B","XMUTERM",1)

"KRN",.84,36336,-1)
0^762
"KRN",.84,36336,0)
36336^2^^MAILMAN^Access Code: 
"KRN",.84,36336,1,0)
^^1^1^3000421^
"KRN",.84,36336,1,1,0)
1 space at the end
"KRN",.84,36336,2,0)
^^1^1^3000421^
"KRN",.84,36336,2,1,0)
Access Code: 
"KRN",.84,36336,5,0)
^.841^1^1
"KRN",.84,36336,5,1,0)
XMUTERM
"KRN",.84,36336,5,"B","XMUTERM",1)

"KRN",.84,36337,-1)
0^763
"KRN",.84,36337,0)
36337^2^^MAILMAN^Verify Code: 
"KRN",.84,36337,1,0)
^^1^1^3000421^
"KRN",.84,36337,1,1,0)
1 space at the end
"KRN",.84,36337,2,0)
^^1^1^3000421^
"KRN",.84,36337,2,1,0)
Verify Code: 
"KRN",.84,36337,5,0)
^.841^1^1
"KRN",.84,36337,5,1,0)
XMUTERM
"KRN",.84,36337,5,"B","XMUTERM",1)

"KRN",.84,36338,-1)
0^764
"KRN",.84,36338,0)
36338^2^^MAILMAN^Primary Menu: 
"KRN",.84,36338,1,0)
^^1^1^3000421^
"KRN",.84,36338,1,1,0)
1 space at the end
"KRN",.84,36338,2,0)
^^1^1^3000421^
"KRN",.84,36338,2,1,0)
Primary Menu: 
"KRN",.84,36338,5,0)
^.841^1^1
"KRN",.84,36338,5,1,0)
XMUTERM
"KRN",.84,36338,5,"B","XMUTERM",1)

"KRN",.84,36339,-1)
0^765
"KRN",.84,36339,0)
36339^2^^MAILMAN^Date Entered: 
"KRN",.84,36339,1,0)
^^1^1^3000421^
"KRN",.84,36339,1,1,0)
1 space at the end
"KRN",.84,36339,2,0)
^^1^1^3000421^
"KRN",.84,36339,2,1,0)
Date Entered: 
"KRN",.84,36339,5,0)
^.841^1^1
"KRN",.84,36339,5,1,0)
XMUTERM
"KRN",.84,36339,5,"B","XMUTERM",1)

"KRN",.84,36340,-1)
0^766
"KRN",.84,36340,0)
36340^2^^MAILMAN^Last Logon: 
"KRN",.84,36340,1,0)
^^1^1^3000421^
"KRN",.84,36340,1,1,0)
1 space at the end
"KRN",.84,36340,2,0)
^^1^1^3000421^
"KRN",.84,36340,2,1,0)
Last Logon: 
"KRN",.84,36340,5,0)
^.841^1^1
"KRN",.84,36340,5,1,0)
XMUTERM
"KRN",.84,36340,5,"B","XMUTERM",1)

"KRN",.84,36341,-1)
0^767
"KRN",.84,36341,0)
36341^2^^MAILMAN^Term Date: 
"KRN",.84,36341,1,0)
^^1^1^3000421^
"KRN",.84,36341,1,1,0)
1 space at the end
"KRN",.84,36341,2,0)
^^1^1^3000421^
"KRN",.84,36341,2,1,0)
Term Date: 
"KRN",.84,36341,5,0)
^.841^1^1
"KRN",.84,36341,5,1,0)
XMUTERM
"KRN",.84,36341,5,"B","XMUTERM",1)

"KRN",.84,36342,-1)
0^768
"KRN",.84,36342,0)
36342^2^^MAILMAN^Delete Mail: 
"KRN",.84,36342,1,0)
^^1^1^3000421^
"KRN",.84,36342,1,1,0)
1 space at the end
"KRN",.84,36342,2,0)
^^1^1^3000421^
"KRN",.84,36342,2,1,0)
Delete Mail: 
"KRN",.84,36342,5,0)
^.841^1^1
"KRN",.84,36342,5,1,0)
XMUTERM
"KRN",.84,36342,5,"B","XMUTERM",1)

"KRN",.84,36343,-1)
0^769
"KRN",.84,36343,0)
36343^2^^MAILMAN^New Messages: 
"KRN",.84,36343,1,0)
^^1^1^3000421^
"KRN",.84,36343,1,1,0)
1 space at the end
"KRN",.84,36343,2,0)
^^1^1^3000421^
"KRN",.84,36343,2,1,0)
New Messages: 
"KRN",.84,36343,5,0)
^.841^1^1
"KRN",.84,36343,5,1,0)
XMUTERM
"KRN",.84,36343,5,"B","XMUTERM",1)

"KRN",.84,36344,-1)
0^770
"KRN",.84,36344,0)
36344^2^^MAILMAN^Delete this user's mailbox
"KRN",.84,36344,2,0)
^^1^1^3000421^
"KRN",.84,36344,2,1,0)
Delete this user's mailbox
"KRN",.84,36344,5,0)
^.841^1^1
"KRN",.84,36344,5,1,0)
XMUTERM
"KRN",.84,36344,5,"B","XMUTERM",1)

"KRN",.84,36345,-1)
0^771
"KRN",.84,36345,0)
36345^2^y^MAILMAN^Deleting mailbox for user |1| |2|
"KRN",.84,36345,2,0)
^^1^1^3000421^
"KRN",.84,36345,2,1,0)
Deleting mailbox for user |1| |2|
"KRN",.84,36345,3,0)
^.845^2^2
"KRN",.84,36345,3,1,0)
1^user duz
"KRN",.84,36345,3,2,0)
2^user name
"KRN",.84,36345,5,0)
^.841^1^1
"KRN",.84,36345,5,1,0)
XMUTERM
"KRN",.84,36345,5,"B","XMUTERM",1)

"KRN",.84,36346,-1)
0^772
"KRN",.84,36346,0)
36346^2^^MAILMAN^* Not in NEW PERSON file *
"KRN",.84,36346,2,0)
^.844^1^1^3000421^^
"KRN",.84,36346,2,1,0)
* Not in NEW PERSON file *
"KRN",.84,36346,5,0)
^.841^2^2
"KRN",.84,36346,5,1,0)
XMUTERM
"KRN",.84,36346,5,2,0)
XMUTERM1
"KRN",.84,36346,5,"B","XMUTERM",1)

"KRN",.84,36346,5,"B","XMUTERM1",2)

"KRN",.84,36347,-1)
0^773
"KRN",.84,36347,0)
36347^2^^MAILMAN^*** not deleted - 
"KRN",.84,36347,1,0)
^^1^1^3010731^
"KRN",.84,36347,1,1,0)
There's a space at the end
"KRN",.84,36347,2,0)
^^1^1^3010731^
"KRN",.84,36347,2,1,0)
*** not deleted - 
"KRN",.84,36347,5,0)
^.841^1^1
"KRN",.84,36347,5,1,0)
XMUTERM
"KRN",.84,36347,5,"B","XMUTERM",1)

"KRN",.84,36351,-1)
0^774
"KRN",.84,36351,0)
36351^2^^MAILMAN^No user mailboxes deleted.
"KRN",.84,36351,2,0)
^^1^1^3000421^
"KRN",.84,36351,2,1,0)
No user mailboxes deleted.
"KRN",.84,36351,5,0)
^.841^1^1
"KRN",.84,36351,5,1,0)
XMUTERM1
"KRN",.84,36351,5,"B","XMUTERM1",1)

"KRN",.84,36352,-1)
0^775
"KRN",.84,36352,0)
36352^2^^MAILMAN^Test: 
"KRN",.84,36352,1,0)
^^1^1^3000421^
"KRN",.84,36352,1,1,0)
1 space at end
"KRN",.84,36352,2,0)
^.844^1^1^3000421^^
"KRN",.84,36352,2,1,0)
Test: 
"KRN",.84,36352,5,0)
^.841^1^1
"KRN",.84,36352,5,1,0)
XMUTERM1
"KRN",.84,36352,5,"B","XMUTERM1",1)

"KRN",.84,36353,-1)
0^776
"KRN",.84,36353,0)
36353^2^y^MAILMAN^|1|Delete user mailbox
"KRN",.84,36353,2,0)
^.844^8^8^3010801^^^^
"KRN",.84,36353,2,1,0)
|1|Delete user mailbox
"KRN",.84,36353,2,2,0)
 
"KRN",.84,36353,2,3,0)
(Logon cutoff date: |2|, AC=Access Code, VC=Verify Code, PM=Primary Menu)
"KRN",.84,36353,2,4,0)
 
"KRN",.84,36353,2,5,0)
                                                       Last
"KRN",.84,36353,2,6,0)
                                   ^VA(200             Mail/  Terminate  Delete
"KRN",.84,36353,2,7,0)
Delete Mailbox (DUZ name)          Created  AC VC PM  Sign on    Date     Mail
"KRN",.84,36353,2,8,0)
-------------------------------------------------------------------------------
"KRN",.84,36353,3,0)
^.845^2^2
"KRN",.84,36353,3,1,0)
1^test or not
"KRN",.84,36353,3,2,0)
2^cutoff date
"KRN",.84,36353,5,0)
^.841^1^1
"KRN",.84,36353,5,1,0)
XMUTERM1
"KRN",.84,36353,5,"B","XMUTERM1",1)

"KRN",.84,36357,-1)
0^777
"KRN",.84,36357,0)
36357^2^^MAILMAN^No AC, no termination date
"KRN",.84,36357,2,0)
^^1^1^3000421^
"KRN",.84,36357,2,1,0)
No AC, no termination date
"KRN",.84,36357,5,0)
^.841^1^1
"KRN",.84,36357,5,1,0)
XMUTERM1
"KRN",.84,36357,5,"B","XMUTERM1",1)

"KRN",.84,36358,-1)
0^778
"KRN",.84,36358,0)
36358^2^^MAILMAN^No AC, terminated w/o mail retention
"KRN",.84,36358,2,0)
^^1^1^3000421^
"KRN",.84,36358,2,1,0)
No AC, terminated w/o mail retention
"KRN",.84,36358,5,0)
^.841^1^1
"KRN",.84,36358,5,1,0)
XMUTERM1
"KRN",.84,36358,5,"B","XMUTERM1",1)

"KRN",.84,36359,-1)
0^779
"KRN",.84,36359,0)
36359^2^^MAILMAN^AC, but no PM
"KRN",.84,36359,2,0)
^^1^1^3000421^
"KRN",.84,36359,2,1,0)
AC, but no PM
"KRN",.84,36359,5,0)
^.841^1^1
"KRN",.84,36359,5,1,0)
XMUTERM1
"KRN",.84,36359,5,"B","XMUTERM1",1)

"KRN",.84,36360,-1)
0^780
"KRN",.84,36360,0)
36360^2^y^MAILMAN^AC & PM, no VC, no logon, added |1|
"KRN",.84,36360,2,0)
^^1^1^3000421^
"KRN",.84,36360,2,1,0)
AC & PM, no VC, no logon, added |1|
"KRN",.84,36360,3,0)
^.845^1^1
"KRN",.84,36360,3,1,0)
1^date added
"KRN",.84,36360,5,0)
^.841^1^1
"KRN",.84,36360,5,1,0)
XMUTERM1
"KRN",.84,36360,5,"B","XMUTERM1",1)

"KRN",.84,36361,-1)
0^781
"KRN",.84,36361,0)
36361^2^y^MAILMAN^AC & PM, no VC, last logon |1|
"KRN",.84,36361,2,0)
^^1^1^3000421^
"KRN",.84,36361,2,1,0)
AC & PM, no VC, last logon |1|
"KRN",.84,36361,3,0)
^.845^1^1
"KRN",.84,36361,3,1,0)
1^date of last logon
"KRN",.84,36361,5,0)
^.841^1^1
"KRN",.84,36361,5,1,0)
XMUTERM1
"KRN",.84,36361,5,"B","XMUTERM1",1)

"KRN",.84,36362,-1)
0^782
"KRN",.84,36362,0)
36362^2^^MAILMAN^No user mailboxes to report.
"KRN",.84,36362,2,0)
^^1^1^3000421^
"KRN",.84,36362,2,1,0)
No user mailboxes to report.
"KRN",.84,36362,5,0)
^.841^1^1
"KRN",.84,36362,5,1,0)
XMUTERM1
"KRN",.84,36362,5,"B","XMUTERM1",1)

"KRN",.84,36364,-1)
0^783
"KRN",.84,36364,0)
36364^2^y^MAILMAN^Check user mailbox for Service/Section
"KRN",.84,36364,2,0)
^.844^8^8^3010821^^^
"KRN",.84,36364,2,1,0)
Check user mailbox for Service/Section: |1|
"KRN",.84,36364,2,2,0)
 
"KRN",.84,36364,2,3,0)
(Logon cutoff date: |2|, AC=Access Code, VC=Verify Code, PM=Primary Menu)
"KRN",.84,36364,2,4,0)
 
"KRN",.84,36364,2,5,0)
                                     Last
"KRN",.84,36364,2,6,0)
                                     Mail/    Term   Del  DIS  New
"KRN",.84,36364,2,7,0)
Check Mailbox (DUZ name)  AC VC PM  Sign on   Date  Mail USER Msgs Surrogate
"KRN",.84,36364,2,8,0)
-------------------------------------------------------------------------------
"KRN",.84,36364,3,0)
^.845^2^2
"KRN",.84,36364,3,1,0)
1^service/section
"KRN",.84,36364,3,2,0)
2^cutoff date
"KRN",.84,36364,5,0)
^.841^1^1
"KRN",.84,36364,5,1,0)
XMUTERM1
"KRN",.84,36364,5,"B","XMUTERM1",1)

"KRN",.84,36366,-1)
0^784
"KRN",.84,36366,0)
36366^2^^MAILMAN^DISUSER'd
"KRN",.84,36366,2,0)
^^1^1^3010821^
"KRN",.84,36366,2,1,0)
DISUSER'd
"KRN",.84,36366,5,0)
^.841^1^1
"KRN",.84,36366,5,1,0)
XMUTERM
"KRN",.84,36366,5,"B","XMUTERM",1)

"KRN",.84,36367,-1)
0^785
"KRN",.84,36367,0)
36367^2^^MAILMAN^No AC, terminated w/mail retention
"KRN",.84,36367,2,0)
^^1^1^3000421^
"KRN",.84,36367,2,1,0)
No AC, terminated w/mail retention
"KRN",.84,36367,5,0)
^.841^1^1
"KRN",.84,36367,5,1,0)
XMUTERM1
"KRN",.84,36367,5,"B","XMUTERM1",1)

"KRN",.84,36368,-1)
0^786
"KRN",.84,36368,0)
36368^2^y^MAILMAN^AC, VC, & PM, no logon, added |1|
"KRN",.84,36368,2,0)
^^1^1^3000421^
"KRN",.84,36368,2,1,0)
AC, VC, & PM, no logon, added |1|
"KRN",.84,36368,3,0)
^.845^1^1
"KRN",.84,36368,3,1,0)
1^date added
"KRN",.84,36368,5,0)
^.841^1^1
"KRN",.84,36368,5,1,0)
XMUTERM1
"KRN",.84,36368,5,"B","XMUTERM1",1)

"KRN",.84,36369,-1)
0^787
"KRN",.84,36369,0)
36369^2^y^MAILMAN^AC, VC, & PM, last logon |1|
"KRN",.84,36369,2,0)
^^1^1^3000421^
"KRN",.84,36369,2,1,0)
AC, VC, & PM, last logon |1|
"KRN",.84,36369,3,0)
^.845^1^1
"KRN",.84,36369,3,1,0)
1^date of last logon
"KRN",.84,36369,5,0)
^.841^1^1
"KRN",.84,36369,5,1,0)
XMUTERM1
"KRN",.84,36369,5,"B","XMUTERM1",1)

"KRN",.84,36400,-1)
0^788
"KRN",.84,36400,0)
36400^1^y^MAILMAN^You must hold the |1| key to run this
"KRN",.84,36400,2,0)
^^1^1^3010416^
"KRN",.84,36400,2,1,0)
You must hold the |1| key to run this option.
"KRN",.84,36400,3,0)
^.845^1^1
"KRN",.84,36400,3,1,0)
1^security key
"KRN",.84,36401,-1)
0^789
"KRN",.84,36401,0)
36401^2^^MAILMAN^This process REMOVES MESSAGES PERMANENTLY
"KRN",.84,36401,2,0)
^^2^2^3010416^
"KRN",.84,36401,2,1,0)
This process REMOVES MESSAGES PERMANENTLY from the system.
"KRN",.84,36401,2,2,0)
            ***** BE VERY CAREFUL *****
"KRN",.84,36402,-1)
0^790
"KRN",.84,36402,0)
36402^2^y^MAILMAN^This process was last run on |1|.
"KRN",.84,36402,2,0)
^^1^1^3010416^
"KRN",.84,36402,2,1,0)
This process was last run on |1|.
"KRN",.84,36402,3,0)
^.845^1^1
"KRN",.84,36402,3,1,0)
1^date last run
"KRN",.84,36402.1,-1)
0^791
"KRN",.84,36402.1,0)
36402.1^2^y^MAILMAN^This process was last run on |1| in
"KRN",.84,36402.1,2,0)
^^1^1^3010416^
"KRN",.84,36402.1,2,1,0)
This process was last run on |1| in TEST mode.
"KRN",.84,36402.1,3,0)
^.845^1^1
"KRN",.84,36402.1,3,1,0)
1^date last run
"KRN",.84,36403,-1)
0^792
"KRN",.84,36403,0)
36403^2^y^MAILMAN^The PURGE DATE used was |1|.
"KRN",.84,36403,2,0)
^^2^2^3010416^
"KRN",.84,36403,2,1,0)
The PURGE DATE used was |1|.
"KRN",.84,36403,2,2,0)
(Messages more than |2| days old were purged.)
"KRN",.84,36403,3,0)
^.845^2^2
"KRN",.84,36403,3,1,0)
1^purge date
"KRN",.84,36403,3,2,0)
2^number of days
"KRN",.84,36404,-1)
0^793
"KRN",.84,36404,0)
36404^2^y^MAILMAN^The oldest message on the system is from
"KRN",.84,36404,2,0)
^^2^2^3010416^
"KRN",.84,36404,2,1,0)
The oldest message on the system is from |1|.
"KRN",.84,36404,2,2,0)
Purge all messages originating before
"KRN",.84,36404,3,0)
^.845^1^1
"KRN",.84,36404,3,1,0)
1^date of oldest message
"KRN",.84,36405,-1)
0^794
"KRN",.84,36405,0)
36405^3^^MAILMAN^All messages whose 'local create date'
"KRN",.84,36405,2,0)
^^4^4^3010416^
"KRN",.84,36405,2,1,0)
All messages whose 'local create date' is prior to the
"KRN",.84,36405,2,2,0)
'purge date' you enter will be deleted from the system,
"KRN",.84,36405,2,3,0)
except those which are in one of SHARED,MAIL's baskets,
"KRN",.84,36405,2,4,0)
OR in POSTMASTER's server baskets or remote transmit queues.
"KRN",.84,36406,-1)
0^795
"KRN",.84,36406,0)
36406^2^^MAILMAN^The date you entered is less than 1 year
"KRN",.84,36406,2,0)
^^1^1^3010416^
"KRN",.84,36406,2,1,0)
The date you entered is less than 1 year ago.
"KRN",.84,36407,-1)
0^796
"KRN",.84,36407,0)
36407^2^^MAILMAN^Are you sure about this date
"KRN",.84,36407,2,0)
^^1^1^3010416^
"KRN",.84,36407,2,1,0)
Are you sure about this date
"KRN",.84,36408,-1)
0^797
"KRN",.84,36408,0)
36408^2^y^MAILMAN^You have chosen to purge messages older
"KRN",.84,36408,2,0)
^^3^3^3010416^
"KRN",.84,36408,2,1,0)
You have chosen to purge messages older than |1| days old,
"KRN",.84,36408,2,2,0)
which is different from the current default of |2|.
"KRN",.84,36408,2,3,0)
Do you want |1| to be the new default
"KRN",.84,36408,3,0)
^.845^2^2
"KRN",.84,36408,3,1,0)
1^choice days
"KRN",.84,36408,3,2,0)
2^default days
"KRN",.84,36409,-1)
0^798
"KRN",.84,36409,0)
36409^3^y^MAILMAN^Answer YES if you want field 10.03
"KRN",.84,36409,2,0)
^^6^6^3010416^
"KRN",.84,36409,2,1,0)
Answer YES if you want field 10.03, DATE PURGE CUTOFF DAYS,
"KRN",.84,36409,2,2,0)
in file 4.3, MAILMAN SITE PARAMETERS, to be set to |1|.
"KRN",.84,36409,2,3,0)
 
"KRN",.84,36409,2,4,0)
Answer NO if you want that field to remain |2|.
"KRN",.84,36409,2,5,0)
 
"KRN",.84,36409,2,6,0)
You can also edit this field using option XMKSP.
"KRN",.84,36409,3,0)
^.845^2^2
"KRN",.84,36409,3,1,0)
1^choice days
"KRN",.84,36409,3,2,0)
2^default days
"KRN",.84,36410,-1)
0^799
"KRN",.84,36410,0)
36410^2^^MAILMAN^TEST mode
"KRN",.84,36410,2,0)
^^1^1^3010416^
"KRN",.84,36410,2,1,0)
TEST mode
"KRN",.84,36411,-1)
0^800
"KRN",.84,36411,0)
36411^3^^MAILMAN^Test mode will not kill off messages.
"KRN",.84,36411,2,0)
^.844^5^5^3010416^^
"KRN",.84,36411,2,1,0)
Test mode will not kill off messages.
"KRN",.84,36411,2,2,0)
Test mode gives you a list of what would happen in 'real' mode.
"KRN",.84,36411,2,3,0)
If you do not run in test mode, messages will be KILLED!
"KRN",.84,36411,2,4,0)

"KRN",.84,36411,2,5,0)
Enter YES to run in 'test' mode; NO, 'real' mode.
"KRN",.84,36412,-1)
0^801
"KRN",.84,36412,0)
36412^2^^MAILMAN^Since we are running in test mode,
"KRN",.84,36412,2,0)
^^1^1^3010416^
"KRN",.84,36412,2,1,0)
Since we are running in test mode, no warning bulletin will be sent.
"KRN",.84,36412.1,-1)
0^802
"KRN",.84,36412.1,0)
36412.1^2^^MAILMAN^If you queue this purge to run 3 or more
"KRN",.84,36412.1,2,0)
^^4^4^3010416^
"KRN",.84,36412.1,2,1,0)
If you queue this purge to run 3 or more days from now, I will
"KRN",.84,36412.1,2,2,0)
send a bulletin, XM DATE PURGE WARNING, to all users to warn
"KRN",.84,36412.1,2,3,0)
them of the coming date purge, and tell them how to identify
"KRN",.84,36412.1,2,4,0)
all of the messages in their mailbox, which may be affected.
"KRN",.84,36413,-1)
0^803
"KRN",.84,36413,0)
36413^2^^MAILMAN^MailMan: MESSAGE PURGE by DATE
"KRN",.84,36413,2,0)
^^1^1^3010416^
"KRN",.84,36413,2,1,0)
MailMan: MESSAGE PURGE by DATE
"KRN",.84,36414,-1)
0^804
"KRN",.84,36414,0)
36414^2^^MAILMAN^Since you scheduled the date purge
"KRN",.84,36414,2,0)
^^2^2^3010416^
"KRN",.84,36414,2,1,0)
Since you scheduled the date purge less than 3 days
"KRN",.84,36414,2,2,0)
from now, no warning bulletin has been sent.
"KRN",.84,36415,-1)
0^805
"KRN",.84,36415,0)
36415^2^^MAILMAN^The warning bulletin has been sent.
"KRN",.84,36415,2,0)
^^1^1^3010416^
"KRN",.84,36415,2,1,0)
The warning bulletin has been sent.
"KRN",.84,36416,-1)
0^806
"KRN",.84,36416,0)
36416^2^^MAILMAN^ <<< Purge!  Date = 
"KRN",.84,36416,1,0)
^^1^1^3010416^
"KRN",.84,36416,1,1,0)
there's a blank at the start and end
"KRN",.84,36416,2,0)
^^1^1^3010416^
"KRN",.84,36416,2,1,0)
 <<< Purge!  Date = 
"KRN",.84,36417,-1)
0^807
"KRN",.84,36417,0)
36417^2^^MAILMAN^Message deleted for DUZ:
"KRN",.84,36417,2,0)
^.844^1^1^3010416^^
"KRN",.84,36417,2,1,0)
Message deleted for DUZ:
"KRN",.84,36418,-1)
0^808
"KRN",.84,36418,0)
36418^2^^MAILMAN^Response deleted:
"KRN",.84,36418,2,0)
^^1^1^3010416^
"KRN",.84,36418,2,1,0)
Response deleted:
"KRN",.84,36419,-1)
0^809
"KRN",.84,36419,0)
36419^2^^MAILMAN^Message Purge, local create date <
"KRN",.84,36419,2,0)
^.844^1^1^3010416^^
"KRN",.84,36419,2,1,0)
Message Purge, local create date < 
"KRN",.84,36420,-1)
0^810
"KRN",.84,36420,0)
36420^2^^MAILMAN^Started: 
"KRN",.84,36420,1,0)
^^1^1^3010416^
"KRN",.84,36420,1,1,0)
there's a blank at the end
"KRN",.84,36420,2,0)
^^1^1^3010416^
"KRN",.84,36420,2,1,0)
Started: 
"KRN",.84,36421,-1)
0^811
"KRN",.84,36421,0)
36421^2^^MAILMAN^*TEST RUN*
"KRN",.84,36421,2,0)
^^1^1^3010416^
"KRN",.84,36421,2,1,0)
*TEST RUN*
"KRN",.84,36422,-1)
0^812
"KRN",.84,36422,0)
36422^2^^MAILMAN^*** Stopping prematurely per user request
"KRN",.84,36422,2,0)
^^1^1^3010416^
"KRN",.84,36422,2,1,0)
*** Stopping prematurely per user request ***
"KRN",.84,36423,-1)
0^813
"KRN",.84,36423,0)
36423^2^y^MAILMAN^Message Purge finished on |1|
"KRN",.84,36423,2,0)
^^3^3^3010416^
"KRN",.84,36423,2,1,0)
Message Purge finished on |1|
"KRN",.84,36423,2,2,0)
|2| messages processed.
"KRN",.84,36423,2,3,0)
|3| original messages and |4| responses purged.
"KRN",.84,36425,-1)
0^814
"KRN",.84,36425,0)
36425^2^^MAILMAN^I will purge messages which are not in
"KRN",.84,36425,2,0)
^^7^7^3010416^
"KRN",.84,36425,2,1,0)
I will purge messages which are not in anybody's mailbox.  This
"KRN",.84,36425,2,2,0)
will be done by comparing the message numbers in the MESSAGE file
"KRN",.84,36425,2,3,0)
(3.9) against the 'M' cross reference of the MAILBOX file (3.7).
"KRN",.84,36425,2,4,0)

"KRN",.84,36425,2,5,0)
Because this is a real-time dynamic cross reference, it is strongly
"KRN",.84,36425,2,6,0)
recommended that you run the Integrity Checker (option XMUT-CHKFIL)
"KRN",.84,36425,2,7,0)
with some regularity, to correct any problems.
"KRN",.84,36426,-1)
0^815
"KRN",.84,36426,0)
36426^2^^MAILMAN^A Mailbox Integrity Check will run before
"KRN",.84,36426,2,0)
^^1^1^3010416^
"KRN",.84,36426,2,1,0)
A Mailbox Integrity Check will run before the Purge.
"KRN",.84,36427,-1)
0^816
"KRN",.84,36427,0)
36427^2^^MAILMAN^A Mailbox Integrity Check will NOT run
"KRN",.84,36427,2,0)
^^4^4^3010416^
"KRN",.84,36427,2,1,0)
A Mailbox Integrity Check will NOT run before the Purge, because
"KRN",.84,36427,2,2,0)
your site parameters (field 4.303 in file 4.3) indicate you do not
"KRN",.84,36427,2,3,0)
want it to.  You may want to do a back-up just before this runs,
"KRN",.84,36427,2,4,0)
and revert to it, if many problems are discovered.
"KRN",.84,36428,-1)
0^817
"KRN",.84,36428,0)
36428^2^^MAILMAN^Do you really want to purge all unref
"KRN",.84,36428,2,0)
^^1^1^3010416^
"KRN",.84,36428,2,1,0)
Do you really want to purge all unreferenced messages
"KRN",.84,36429,-1)
0^818
"KRN",.84,36429,0)
36429^2^y^MAILMAN^Any unreferenced message will be purged
"KRN",.84,36429,2,0)
^.844^12^12^3010416^^
"KRN",.84,36429,2,1,0)
Any unreferenced message will be purged if its local create date
"KRN",.84,36429,2,2,0)
is from |1| to |2|, inclusive.
"KRN",.84,36429,2,3,0)
However, locally generated messages sent to remote sites will not
"KRN",.84,36429,2,4,0)
be purged if they were sent on or after |3|.
"KRN",.84,36429,2,5,0)

"KRN",.84,36429,2,6,0)
The following messages are considered 'referenced' and will not be
"KRN",.84,36429,2,7,0)
purged:
"KRN",.84,36429,2,8,0)
- Messages in users' baskets
"KRN",.84,36429,2,9,0)
- Messages in transit (arriving or being sent)
"KRN",.84,36429,2,10,0)
- Server messages
"KRN",.84,36429,2,11,0)
- Messages being edited (includes aborted edits)
"KRN",.84,36429,2,12,0)
- Later'd messages
"KRN",.84,36429,3,0)
^.845^3^3
"KRN",.84,36429,3,1,0)
1^start date
"KRN",.84,36429,3,2,0)
2^end date
"KRN",.84,36429,3,3,0)
3^local end date
"KRN",.84,36430,-1)
0^819
"KRN",.84,36430,0)
36430^2^y^MAILMAN^|1| messages processed, |2| messages
"KRN",.84,36430,2,0)
^^3^3^3010416^
"KRN",.84,36430,2,1,0)
Messages processed:   |1|
"KRN",.84,36430,2,2,0)
Messages purged:      |2|
"KRN",.84,36430,2,3,0)
Messages in file 3.9: |3|
"KRN",.84,36430,3,0)
^.845^3^3
"KRN",.84,36430,3,1,0)
1^messages processed
"KRN",.84,36430,3,2,0)
2^messages purged
"KRN",.84,36430,3,3,0)
3^messages in file 3.9
"KRN",.84,36431,-1)
0^820
"KRN",.84,36431,0)
36431^2^^MAILMAN^Waste & Arriving Baskets Cleaned!
"KRN",.84,36431,2,0)
^^1^1^3010417^
"KRN",.84,36431,2,1,0)
Waste & Arriving Baskets Cleaned!
"KRN",.84,36432,-1)
0^821
"KRN",.84,36432,0)
36432^2^^MAILMAN^It's a good idea to look these over.
"KRN",.84,36432,2,0)
^^3^3^3010417^
"KRN",.84,36432,2,1,0)
It's a good idea to look these over.  Look for multiple purges
"KRN",.84,36432,2,2,0)
running concurrently and missing purge dates.  Check the times
"KRN",.84,36432,2,3,0)
the purge ended - do they conflict with user activity?
"KRN",.84,36433,-1)
0^822
"KRN",.84,36433,0)
36433^2^^MAILMAN^Unref Msg
"KRN",.84,36433,2,0)
^^1^1^3010417^
"KRN",.84,36433,2,1,0)
Unref Msg
"KRN",.84,36434,-1)
0^823
"KRN",.84,36434,0)
36434^2^^MAILMAN^Date
"KRN",.84,36434,2,0)
^^1^1^3010417^
"KRN",.84,36434,2,1,0)
Date
"KRN",.84,36435,-1)
0^824
"KRN",.84,36435,0)
36435^2^^MAILMAN^Test Date
"KRN",.84,36435,2,0)
^^1^1^3010417^
"KRN",.84,36435,2,1,0)
Test Date
"KRN",.84,36436,-1)
0^825
"KRN",.84,36436,0)
36436^2^^MAILMAN^MailMan Purge History
"KRN",.84,36436,2,0)
^.844^2^2^3010419^^^^
"KRN",.84,36436,2,1,0)
MailMan Purge History
"KRN",.84,36436,2,2,0)
Type              Start             End         Duration     Purged        Kept
"KRN",.84,36437,-1)
0^826
"KRN",.84,36437,0)
36437^2^y^MAILMAN^Lowest numbered message: |1|
"KRN",.84,36437,2,0)
^.844^3^3^3010417^^
"KRN",.84,36437,2,1,0)
Lowest numbered message:   |1|
"KRN",.84,36437,2,2,0)
Highest numbered message:  |2|
"KRN",.84,36437,2,3,0)
Number of messages:        |3|
"KRN",.84,36437,3,0)
^.845^2^2
"KRN",.84,36437,3,1,0)
1^highest message number
"KRN",.84,36437,3,2,0)
2^number of active msgs
"KRN",.84,36438,-1)
0^827
"KRN",.84,36438,0)
36438^2^^MAILMAN^Scan Option
"KRN",.84,36438,2,0)
^^1^1^3010417^
"KRN",.84,36438,2,1,0)
Scan Option
"KRN",.84,36439.1,-1)
0^828
"KRN",.84,36439.1,0)
36439.1^2^^MAILMAN^A:Active Mailboxes
"KRN",.84,36439.1,2,0)
^^1^1^3010417^
"KRN",.84,36439.1,2,1,0)
A:Active Mailboxes
"KRN",.84,36439.2,-1)
0^829
"KRN",.84,36439.2,0)
36439.2^2^^MAILMAN^I:Inactive Mailboxes
"KRN",.84,36439.2,2,0)
^^1^1^3010417^
"KRN",.84,36439.2,2,1,0)
I:Inactive Mailboxes
"KRN",.84,36439.3,-1)
0^830
"KRN",.84,36439.3,0)
36439.3^2^^MAILMAN^M:All Mailboxes
"KRN",.84,36439.3,2,0)
^^1^1^3010417^
"KRN",.84,36439.3,2,1,0)
M:All Mailboxes
"KRN",.84,36440,-1)
0^831
"KRN",.84,36440,0)
36440^2^^MAILMAN^MailMan: User Mailbox Statistics
"KRN",.84,36440,2,0)
^^1^1^3010417^
"KRN",.84,36440,2,1,0)
MailMan: User Mailbox Statistics
"KRN",.84,36441,-1)
0^832
"KRN",.84,36441,0)
36441^2^^MAILMAN^Inactive
"KRN",.84,36441,2,0)
^^1^1^3010417^
"KRN",.84,36441,2,1,0)
Inactive
"KRN",.84,36443,-1)
0^833
"KRN",.84,36443,0)
36443^2^^MAILMAN^User   Bskts  Msgs
"KRN",.84,36443,2,0)
^^1^1^3010417^
"KRN",.84,36443,2,1,0)
User                         Bskts  Msgs  IN Bskt  Last Sign on  Last Mail Use
"KRN",.84,36501,-1)
0^834
"KRN",.84,36501,0)
36501^1^^MAILMAN^Msg has bad/no 0 node: not fixed
"KRN",.84,36501,2,0)
^^1^1^3010417^
"KRN",.84,36501,2,1,0)
Msg has bad/no 0 node: not fixed
"KRN",.84,36501.1,-1)
0^835
"KRN",.84,36501.1,0)
36501.1^1^^MAILMAN^Msg has bad/no 0 node *NOT FIXED*
"KRN",.84,36501.1,2,0)
^^8^8^3010417
"KRN",.84,36501.1,2,1,0)
Msg has bad/no 0 node *NOT FIXED*
"KRN",.84,36501.1,2,2,0)
A message has a bad/no zero node.
"KRN",.84,36501.1,2,3,0)
A message like this usually is not owned by anybody and can be
"KRN",.84,36501.1,2,4,0)
deleted.  Entries like this can be created by Network Mail when
"KRN",.84,36501.1,2,5,0)
your site is receiving a message, and the transmission ends
"KRN",.84,36501.1,2,6,0)
ungracefully before MailMan can recognize this and kill off the
"KRN",.84,36501.1,2,7,0)
incomplete transmission.
"KRN",.84,36501.1,2,8,0)
XMAUTOPURGE will usually purge this message.
"KRN",.84,36502,-1)
0^836
"KRN",.84,36502,0)
36502^1^^MAILMAN^Msg has no subject: fixed
"KRN",.84,36502,2,0)
^^1^1^3010417^
"KRN",.84,36502,2,1,0)
Msg has no subject: fixed
"KRN",.84,36502.1,-1)
0^837
"KRN",.84,36502.1,0)
36502.1^1^^MAILMAN^Msg has no subject *FIXED*
"KRN",.84,36502.1,2,0)
^^4^4^3010417
"KRN",.84,36502.1,2,1,0)
Msg has no subject *FIXED*
"KRN",.84,36502.1,2,2,0)
A message has no subject.
"KRN",.84,36502.1,2,3,0)
This can happen with incoming network mail.
"KRN",.84,36502.1,2,4,0)
To fix this, the subject has been set to: "* No Subject *"
"KRN",.84,36503,-1)
0^838
"KRN",.84,36503,0)
36503^1^^MAILMAN^Msg subject <3 or >65: fixed
"KRN",.84,36503,2,0)
^^1^1^3010417^
"KRN",.84,36503,2,1,0)
Msg subject <3 or >65: fixed
"KRN",.84,36503.1,-1)
0^839
"KRN",.84,36503.1,0)
36503.1^1^^MAILMAN^Msg subject <3 or >65 *FIXED*
"KRN",.84,36503.1,2,0)
^^7^7^3010417
"KRN",.84,36503.1,2,1,0)
Msg subject <3 or >65 *FIXED*
"KRN",.84,36503.1,2,2,0)
A message's subject is shorter or longer than the current standard
"KRN",.84,36503.1,2,3,0)
allows.
"KRN",.84,36503.1,2,4,0)
This should not happen.  If you see this, then a package has been
"KRN",.84,36503.1,2,5,0)
creating messages without using MailMan, which is a SAC violation.
"KRN",.84,36503.1,2,6,0)
To fix this, "..." is appended to a short subject, or
"KRN",.84,36503.1,2,7,0)
a long subject is truncated to 65 characters.
"KRN",.84,36504,-1)
0^840
"KRN",.84,36504,0)
36504^1^^MAILMAN^Subject has no B xref: xref created
"KRN",.84,36504,2,0)
^^1^1^3010417^
"KRN",.84,36504,2,1,0)
Subject has no B xref: xref created
"KRN",.84,36504.1,-1)
0^841
"KRN",.84,36504.1,0)
36504.1^1^^MAILMAN^Msg subject has no B xref *FIXED*
"KRN",.84,36504.1,2,0)
^^5^5^3010417
"KRN",.84,36504.1,2,1,0)
Msg subject has no B xref *FIXED*
"KRN",.84,36504.1,2,2,0)
A message's subject has no "B" cross-reference.
"KRN",.84,36504.1,2,3,0)
To fix this, the "B" cross-reference is created.
"KRN",.84,36504.1,2,4,0)
If left alone, one could not have looked up this message by its
"KRN",.84,36504.1,2,5,0)
subject.
"KRN",.84,36505,-1)
0^842
"KRN",.84,36505,0)
36505^1^^MAILMAN^Subject B xref too long: xref shortened
"KRN",.84,36505,2,0)
^^1^1^3010417^
"KRN",.84,36505,2,1,0)
Subject B xref too long: xref shortened
"KRN",.84,36505.1,-1)
0^843
"KRN",.84,36505.1,0)
36505.1^1^^MAILMAN^Msg subject B xref is too long *FIXED*
"KRN",.84,36505.1,2,0)
^^5^5^3010417
"KRN",.84,36505.1,2,1,0)
Msg subject B xref is too long *FIXED*
"KRN",.84,36505.1,2,2,0)
A message's subject "B" cross-reference is longer than in the DD.
"KRN",.84,36505.1,2,3,0)
To fix this, the "B" cross-reference is shortened.
"KRN",.84,36505.1,2,4,0)
If left alone, the "B" cross-reference would not have been killed
"KRN",.84,36505.1,2,5,0)
when the message was purged.
"KRN",.84,36506,-1)
0^844
"KRN",.84,36506,0)
36506^1^^MAILMAN^Msg has no sender: fixed
"KRN",.84,36506,2,0)
^^1^1^3010417^
"KRN",.84,36506,2,1,0)
Msg has no sender: fixed
"KRN",.84,36506.1,-1)
0^845
"KRN",.84,36506.1,0)
36506.1^1^^MAILMAN^Msg has no sender *FIXED*
"KRN",.84,36506.1,2,0)
^^3^3^3010417
"KRN",.84,36506.1,2,1,0)
Msg has no sender *FIXED*
"KRN",.84,36506.1,2,2,0)
A message has no sender.
"KRN",.84,36506.1,2,3,0)
To fix this, the sender has been set to: "* No name *"
"KRN",.84,36507,-1)
0^846
"KRN",.84,36507,0)
36507^1^^MAILMAN^Msg has no date/time: fixed
"KRN",.84,36507,2,0)
^^1^1^3010417^
"KRN",.84,36507,2,1,0)
Msg has no date/time: fixed
"KRN",.84,36507.1,-1)
0^847
"KRN",.84,36507.1,0)
36507.1^1^^MAILMAN^Msg has no date/time *FIXED*
"KRN",.84,36507.1,2,0)
^^3^3^3010417
"KRN",.84,36507.1,2,1,0)
Msg has no date/time *FIXED*
"KRN",.84,36507.1,2,2,0)
A message has no date/time.
"KRN",.84,36507.1,2,3,0)
To fix this, the date/time has been set to: DT
"KRN",.84,36508,-1)
0^848
"KRN",.84,36508,0)
36508^1^^MAILMAN^Msg has no local create date: fixed
"KRN",.84,36508,2,0)
^^1^1^3010417^
"KRN",.84,36508,2,1,0)
Msg has no local create date: fixed
"KRN",.84,36508.1,-1)
0^849
"KRN",.84,36508.1,0)
36508.1^1^^MAILMAN^Msg has no local create date *FIXED*
"KRN",.84,36508.1,2,0)
^^5^5^3010417
"KRN",.84,36508.1,2,1,0)
Msg has no local create date *FIXED*
"KRN",.84,36508.1,2,2,0)
A message has no local create date.
"KRN",.84,36508.1,2,3,0)
This date is used by the message purge processes.
"KRN",.84,36508.1,2,4,0)
To fix this, the local create date has been set to the date
"KRN",.84,36508.1,2,5,0)
that the message was sent.
"KRN",.84,36509,-1)
0^850
"KRN",.84,36509,0)
36509^1^^MAILMAN^Local create date C xref missing: fixed
"KRN",.84,36509,2,0)
^^1^1^3010417^
"KRN",.84,36509,2,1,0)
Local create date C xref missing: fixed
"KRN",.84,36509.1,-1)
0^851
"KRN",.84,36509.1,0)
36509.1^1^^MAILMAN^Msg local create date has no C xref *FIXED
"KRN",.84,36509.1,2,0)
^^4^4^3010417
"KRN",.84,36509.1,2,1,0)
Msg local create date has no C xref *FIXED*
"KRN",.84,36509.1,2,2,0)
A message's local create date has no "C" cross-reference.
"KRN",.84,36509.1,2,3,0)
To fix this, the "C" cross-reference is created.
"KRN",.84,36509.1,2,4,0)
If left alone, the purge process would miss it.
"KRN",.84,36510,-1)
0^852
"KRN",.84,36510,0)
36510^1^^MAILMAN^Msg IEN is corrupted: fixed
"KRN",.84,36510,2,0)
^^1^1^3010417^
"KRN",.84,36510,2,1,0)
Msg IEN is corrupted: fixed
"KRN",.84,36510.1,-1)
0^853
"KRN",.84,36510.1,0)
36510.1^1^^MAILMAN^Msg IEN is corrupted *FIXED*
"KRN",.84,36510.1,2,0)
^^4^4^3010417
"KRN",.84,36510.1,2,1,0)
Msg IEN is corrupted *FIXED*
"KRN",.84,36510.1,2,2,0)
A message's IEN is not a number.
"KRN",.84,36510.1,2,3,0)
To fix this, the message is killed.
"KRN",.84,36510.1,2,4,0)
If left alone, it would cause aborts in MailMan processing.
"KRN",.84,36511,-1)
0^854
"KRN",.84,36511,0)
36511^1^^MAILMAN^Message thinks it's a response to itself:
"KRN",.84,36511,2,0)
^^1^1^3010417^
"KRN",.84,36511,2,1,0)
Message thinks it's a response to itself: fixed
"KRN",.84,36511.1,-1)
0^855
"KRN",.84,36511.1,0)
36511.1^1^^MAILMAN^Msg thinks it's a response to itself *FIXE
"KRN",.84,36511.1,2,0)
^^4^4^3010417
"KRN",.84,36511.1,2,1,0)
Msg thinks it's a response to itself *FIXED*
"KRN",.84,36511.1,2,2,0)
A message points to itself in piece 8 of its zero node.
"KRN",.84,36511.1,2,3,0)
To fix this, piece 8 of the message zero node has been made null.
"KRN",.84,36511.1,2,4,0)
Run XMAUTOPURGE to purge the response.
"KRN",.84,36512,-1)
0^1436
"KRN",.84,36512,0)
36512^1^y^MAILMAN^No original message |1| for this response:
"KRN",.84,36512,2,0)
^.844^1^1^3020501^^
"KRN",.84,36512,2,1,0)
No original message |1| for this response: fixed
"KRN",.84,36512,3,0)
^.845^1^1
"KRN",.84,36512,3,1,0)
1^msg ien of original msg
"KRN",.84,36512.1,-1)
0^857
"KRN",.84,36512.1,0)
36512.1^1^^MAILMAN^Response has no original msg *FIXED*
"KRN",.84,36512.1,2,0)
^^21^21^3010417
"KRN",.84,36512.1,2,1,0)
Response has no original msg *FIXED*
"KRN",.84,36512.1,2,2,0)
A message seems to be a response, but the message to which it is
"KRN",.84,36512.1,2,3,0)
responding doesn't seem to be there.
"KRN",.84,36512.1,2,4,0)
Each response is associated with a message.  The response has the
"KRN",.84,36512.1,2,5,0)
original message number in piece 8 of its 0 node.  Local responses
"KRN",.84,36512.1,2,6,0)
have their subjects set to "R"_<original message number>.
"KRN",.84,36512.1,2,7,0)
(e.g. R1233 points to and is a response to message number 1233).
"KRN",.84,36512.1,2,8,0)

"KRN",.84,36512.1,2,9,0)
In MailMan 3.2 and later, users are not allowed to use this
"KRN",.84,36512.1,2,10,0)
syntax for message subjects, in order to avoid contradictions
"KRN",.84,36512.1,2,11,0)
in the database.  This was not true in MailMan 3.09 and
"KRN",.84,36512.1,2,12,0)
earlier versions.
"KRN",.84,36512.1,2,13,0)

"KRN",.84,36512.1,2,14,0)
A real message will usually have recipients
"KRN",.84,36512.1,2,15,0)
and be pointed at from ^XMB(3.7,"M",XMZ,...
"KRN",.84,36512.1,2,16,0)

"KRN",.84,36512.1,2,17,0)
A real response will not have responses, although it may have recipients.
"KRN",.84,36512.1,2,18,0)

"KRN",.84,36512.1,2,19,0)
To fix this, piece 8 of the response zero node has been made null.
"KRN",.84,36512.1,2,20,0)
Run XMAUTOPURGE to get rid of responses which don't have their
"KRN",.84,36512.1,2,21,0)
original messages.
"KRN",.84,36513,-1)
0^858
"KRN",.84,36513,0)
36513^1^y^MAILMAN^Not in response chain of |1|: fixed
"KRN",.84,36513,2,0)
^^1^1^3010417^
"KRN",.84,36513,2,1,0)
Not in response chain of |1|: fixed
"KRN",.84,36513,3,0)
^.845^1^1
"KRN",.84,36513,3,1,0)
1^msg ien of original msg
"KRN",.84,36513.1,-1)
0^859
"KRN",.84,36513.1,0)
36513.1^1^^MAILMAN^Response not in response chain of original
"KRN",.84,36513.1,2,0)
^^5^5^3010417
"KRN",.84,36513.1,2,1,0)
Response not in response chain of original msg *FIXED*
"KRN",.84,36513.1,2,2,0)
A message seems to be a response, but the message to which it
"KRN",.84,36513.1,2,3,0)
claims to be responding does not have it in its response multiple.
"KRN",.84,36513.1,2,4,0)
To fix this, piece 8 of the response zero node has been made null.
"KRN",.84,36513.1,2,5,0)
Run XMAUTOPURGE to purge the response.
"KRN",.84,36516,-1)
0^860
"KRN",.84,36516,0)
36516^1^y^MAILMAN^No original message |1| for this response:
"KRN",.84,36516,2,0)
^^1^1^3010417^
"KRN",.84,36516,2,1,0)
No original message |1| for this response: not fixed
"KRN",.84,36516,3,0)
^.845^1^1
"KRN",.84,36516,3,1,0)
1^msg ien of original msg
"KRN",.84,36516.1,-1)
0^861
"KRN",.84,36516.1,0)
36516.1^1^^MAILMAN^Response has no original msg *NOT FIXED*
"KRN",.84,36516.1,2,0)
^^5^5^3010417
"KRN",.84,36516.1,2,1,0)
Response has no original msg *NOT FIXED*
"KRN",.84,36516.1,2,2,0)
A message seems to be a response, because its subject is Rnnn, but
"KRN",.84,36516.1,2,3,0)
the message to which it claims to be responding doesn't seem to be
"KRN",.84,36516.1,2,4,0)
there, and piece 8 of the response zero node is null.
"KRN",.84,36516.1,2,5,0)
Run XMAUTOPURGE to purge the response.
"KRN",.84,36517,-1)
0^862
"KRN",.84,36517,0)
36517^1^y^MAILMAN^Not in response chain of |1|: not fixed
"KRN",.84,36517,2,0)
^^1^1^3010417^
"KRN",.84,36517,2,1,0)
Not in response chain of |1|: not fixed
"KRN",.84,36517,3,0)
^.845^1^1
"KRN",.84,36517,3,1,0)
1^msg ien of original msg
"KRN",.84,36517,5,0)
^.841^^0
"KRN",.84,36517.1,-1)
0^863
"KRN",.84,36517.1,0)
36517.1^1^^MAILMAN^Response not in response chain of original
"KRN",.84,36517.1,2,0)
^^5^5^3010417
"KRN",.84,36517.1,2,1,0)
Response not in response chain of original msg *NOT FIXED*
"KRN",.84,36517.1,2,2,0)
A message seems to be a response, because its subject is Rnnn, but
"KRN",.84,36517.1,2,3,0)
the message to which it claims to be responding doesn't have it in
"KRN",.84,36517.1,2,4,0)
its response multiple, and piece 8 of the response zero node is null.
"KRN",.84,36517.1,2,5,0)
Run XMAUTOPURGE to purge the response.
"KRN",.84,36518,-1)
0^864
"KRN",.84,36518,0)
36518^1^y^MAILMAN^Piece 8 didn't point to original message
"KRN",.84,36518,2,0)
^.844^1^1^3010417^^
"KRN",.84,36518,2,1,0)
Piece 8 didn't point to original message |1|: fixed
"KRN",.84,36518,3,0)
^.845^1^1
"KRN",.84,36518,3,1,0)
1^msg ien of original msg
"KRN",.84,36518.1,-1)
0^865
"KRN",.84,36518.1,0)
36518.1^1^^MAILMAN^Response didn't point to original msg in p
"KRN",.84,36518.1,2,0)
^^6^6^3010417
"KRN",.84,36518.1,2,1,0)
Response didn't point to original msg in piece 8 *FIXED*
"KRN",.84,36518.1,2,2,0)
A message seems to be a response, because its subject is Rnnn, and
"KRN",.84,36518.1,2,3,0)
the message to which it claims to be responding does have it in
"KRN",.84,36518.1,2,4,0)
its response multiple, but piece 8 of the response zero node is null.
"KRN",.84,36518.1,2,5,0)
To fix this, piece 8 of the response zero node has been made to
"KRN",.84,36518.1,2,6,0)
point to its original message.
"KRN",.84,36521,-1)
0^866
"KRN",.84,36521,0)
36521^1^y^MAILMAN^Recipient |1| null, no C xref: fixed
"KRN",.84,36521,2,0)
^^1^1^3010417^
"KRN",.84,36521,2,1,0)
Recipient |1| null, no C xref: fixed
"KRN",.84,36521,3,0)
^.845^1^1
"KRN",.84,36521,3,1,0)
1^recipient id
"KRN",.84,36521.1,-1)
0^867
"KRN",.84,36521.1,0)
36521.1^1^^MAILMAN^Recip null and no C xref *FIXED*
"KRN",.84,36521.1,2,0)
^^4^4^3010417
"KRN",.84,36521.1,2,1,0)
Recip null and no C xref *FIXED*
"KRN",.84,36521.1,2,2,0)
A message recipient is null, and there is no "C" cross-reference
"KRN",.84,36521.1,2,3,0)
from which to regenerate the recipient.
"KRN",.84,36521.1,2,4,0)
To fix this, the recipient node is killed.
"KRN",.84,36522,-1)
0^868
"KRN",.84,36522,0)
36522^1^y^MAILMAN^Recipient |1| no C xref: xref created
"KRN",.84,36522,2,0)
^^1^1^3010417^
"KRN",.84,36522,2,1,0)
Recipient |1| no C xref: xref created
"KRN",.84,36522,3,0)
^.845^1^1
"KRN",.84,36522,3,1,0)
1^recipient id
"KRN",.84,36522.1,-1)
0^869
"KRN",.84,36522.1,0)
36522.1^1^^MAILMAN^Recip has no C xref: xref created *FIXED*
"KRN",.84,36522.1,2,0)
^^4^4^3010417
"KRN",.84,36522.1,2,1,0)
Recip has no C xref: xref created *FIXED*
"KRN",.84,36522.1,2,2,0)
A message recipient has no "C" cross-reference.
"KRN",.84,36522.1,2,3,0)
To fix this the "C" cross-reference is created.
"KRN",.84,36522.1,2,4,0)
If left alone, responses might not have gone to the recipient.
"KRN",.84,36523,-1)
0^870
"KRN",.84,36523,0)
36523^1^y^MAILMAN^Recipient |1| C xref too long: xref short
"KRN",.84,36523,2,0)
^^1^1^3010417^
"KRN",.84,36523,2,1,0)
Recipient |1| C xref too long: xref shortened
"KRN",.84,36523,3,0)
^.845^1^1
"KRN",.84,36523,3,1,0)
1^recipient id
"KRN",.84,36523.1,-1)
0^871
"KRN",.84,36523.1,0)
36523.1^1^^MAILMAN^Recip C xref is too long: xref shortened *
"KRN",.84,36523.1,2,0)
^^5^5^3010417
"KRN",.84,36523.1,2,1,0)
Recip C xref is too long: xref shortened *FIXED*
"KRN",.84,36523.1,2,2,0)
A message recipient has a "C" cross-reference which is longer
"KRN",.84,36523.1,2,3,0)
than the DD expects.
"KRN",.84,36523.1,2,4,0)
To fix this the "C" cross-reference is shortened.
"KRN",.84,36523.1,2,5,0)
If left alone, nothing bad would have happened.
"KRN",.84,36531,-1)
0^872
"KRN",.84,36531,0)
36531^1^y^MAILMAN^C xref, but recip |1| null: fixed using
"KRN",.84,36531,2,0)
^.844^1^1^3010417^^
"KRN",.84,36531,2,1,0)
C xref, but recip |1| null: fixed using xref
"KRN",.84,36531,3,0)
^.845^1^1
"KRN",.84,36531,3,1,0)
1^recipient id
"KRN",.84,36531.1,-1)
0^873
"KRN",.84,36531.1,0)
36531.1^1^^MAILMAN^C xref, but recip null: fixed using C xref
"KRN",.84,36531.1,2,0)
^^4^4^3010417
"KRN",.84,36531.1,2,1,0)
C xref, but recip null: fixed using C xref *FIXED*
"KRN",.84,36531.1,2,2,0)
A message recipient is null, but it does have a "C" cross-reference
"KRN",.84,36531.1,2,3,0)
whose length is <30, meaning that the value is not truncated.
"KRN",.84,36531.1,2,4,0)
To fix this, the recipient is set to the "C" cross-reference value.
"KRN",.84,36532,-1)
0^874
"KRN",.84,36532,0)
36532^1^y^MAILMAN^C xref, but recip |1| null: fixed, but CHE
"KRN",.84,36532,2,0)
^^1^1^3010417^
"KRN",.84,36532,2,1,0)
C xref, but recip |1| null: fixed, but CHECK
"KRN",.84,36532,3,0)
^.845^1^1
"KRN",.84,36532,3,1,0)
1^recipient id
"KRN",.84,36532.1,-1)
0^875
"KRN",.84,36532.1,0)
36532.1^1^^MAILMAN^C xref, but recip null: fixed using C xref
"KRN",.84,36532.1,2,0)
^^7^7^3010417
"KRN",.84,36532.1,2,1,0)
C xref, but recip null: fixed using C xref *FIXED, BUT CHECK*
"KRN",.84,36532.1,2,2,0)
A message recipient is null, but it does have a "C" cross-reference.
"KRN",.84,36532.1,2,3,0)
However, the "C" cross-reference is 30 characters, meaning that the
"KRN",.84,36532.1,2,4,0)
"C" cross-reference may not have the full recipient address.
"KRN",.84,36532.1,2,5,0)
To fix this, the recipient is set to the "C" cross-reference value.
"KRN",.84,36532.1,2,6,0)
You should check the recipient address, to make sure it's OK,
"KRN",.84,36532.1,2,7,0)
and fix it manually, if it's not.
"KRN",.84,36533,-1)
0^876
"KRN",.84,36533,0)
36533^1^y^MAILMAN^C xref for recip |1| doesn't match recip:
"KRN",.84,36533,2,0)
^^1^1^3010417^
"KRN",.84,36533,2,1,0)
C xref for recip |1| doesn't match recip: xref killed
"KRN",.84,36533,3,0)
^.845^1^1
"KRN",.84,36533,3,1,0)
1^recipient id
"KRN",.84,36533.1,-1)
0^877
"KRN",.84,36533.1,0)
36533.1^1^^MAILMAN^C xref does not match recip: xref killed *
"KRN",.84,36533.1,2,0)
^^3^3^3010417
"KRN",.84,36533.1,2,1,0)
C xref does not match recip: xref killed *FIXED*
"KRN",.84,36533.1,2,2,0)
A "C" cross-reference does not match the recipient value.
"KRN",.84,36533.1,2,3,0)
To fix this, the "C" cross-reference is killed.
"KRN",.84,36600,-1)
0^878
"KRN",.84,36600,0)
36600^2^^MAILMAN^MailMan: Many Msg Maint Request
"KRN",.84,36600,2,0)
^^1^1^3020410^
"KRN",.84,36600,2,1,0)
MailMan: Many Msg Maint Request
"KRN",.84,36600,5,0)
^.841^1^1
"KRN",.84,36600,5,1,0)
XMAI2
"KRN",.84,36600,5,"B","XMAI2",1)

"KRN",.84,36601,-1)
0^879
"KRN",.84,36601,0)
36601^2^^MAILMAN^This option sends a message to every user
"KRN",.84,36601,2,0)
^.844^3^3^3020410^^
"KRN",.84,36601,2,1,0)
This option sends a message to every user who has more than a
"KRN",.84,36601,2,2,0)
certain number of messages in his or her mailbox, asking the user
"KRN",.84,36601,2,3,0)
to terminate unnecessary messages.
"KRN",.84,36601,3,0)
^.845^^0
"KRN",.84,36601,5,0)
^.841^1^1
"KRN",.84,36601,5,1,0)
XMAI2
"KRN",.84,36601,5,"B","XMAI2",1)

"KRN",.84,36602,-1)
0^880
"KRN",.84,36602,0)
36602^2^^MAILMAN^Enter the 'many message' threshold
"KRN",.84,36602,2,0)
^^1^1^3020410^
"KRN",.84,36602,2,1,0)
Enter the 'many message' threshold
"KRN",.84,36602,5,0)
^.841^1^1
"KRN",.84,36602,5,1,0)
XMAI2
"KRN",.84,36602,5,"B","XMAI2",1)

"KRN",.84,36603,-1)
0^881
"KRN",.84,36603,0)
36603^3^^MAILMAN^How many messages may a user have
"KRN",.84,36603,2,0)
^^1^1^3020410^
"KRN",.84,36603,2,1,0)
How many messages may a user have before MailMan sends a nastygram?
"KRN",.84,36603,5,0)
^.841^1^1
"KRN",.84,36603,5,1,0)
XMAI2
"KRN",.84,36603,5,"B","XMAI2",1)

"KRN",.84,36604,-1)
0^882
"KRN",.84,36604,0)
36604^2^y^MAILMAN^Messages will be sent to owners of
"KRN",.84,36604,2,0)
^^2^2^3020410^
"KRN",.84,36604,2,1,0)
Messages will be sent to owners of more than |1| messages.
"KRN",.84,36604,2,2,0)
This option may take awhile - you may wish to queue it.
"KRN",.84,36604,3,0)
^.845^1^1
"KRN",.84,36604,3,1,0)
1^number of messages that's too many
"KRN",.84,36604,5,0)
^.841^1^1
"KRN",.84,36604,5,1,0)
XMAI2
"KRN",.84,36604,5,"B","XMAI2",1)

"KRN",.84,36610,-1)
0^883
"KRN",.84,36610,0)
36610^2^y^MAILMAN^This process cleans out old messages
"KRN",.84,36610,2,0)
^.844^20^20^3020411^^^^
"KRN",.84,36610,2,1,0)
This process cleans out old messages from user mailboxes.
"KRN",.84,36610,2,2,0)

"KRN",.84,36610,2,3,0)
Fields in the MAILMAN SITE PARAMETERS file 4.3 let you fine-tune:
"KRN",.84,36610,2,4,0)
 - field 10:    Number of days since the messages have been read
"KRN",.84,36610,2,5,0)
 - field 10.01: Examine ALL baskets or just the IN basket.
"KRN",.84,36610,2,6,0)

"KRN",.84,36610,2,7,0)
Messages that are not 'NEW' and have NOT been READ for |1| days are
"KRN",.84,36610,2,8,0)
marked for automatic deletion.  Messages so marked, which have not been
"KRN",.84,36610,2,9,0)
read nor saved into another Basket within |2| days, will be deleted
"KRN",.84,36610,2,10,0)
automatically from users' mailboxes.
"KRN",.84,36610,2,11,0)

"KRN",.84,36610,2,12,0)
Each user will receive a message listing messages that are marked
"KRN",.84,36610,2,13,0)
for deletion.  The |2| day grace period allows users to receive
"KRN",.84,36610,2,14,0)
this message and have time to prevent messages they want to keep from
"KRN",.84,36610,2,15,0)
being deleted from their Mail Baskets.
"KRN",.84,36610,2,16,0)

"KRN",.84,36610,2,17,0)
Even then many of the messages may still be recalled via the
"KRN",.84,36610,2,18,0)
search process that can be invoked to search for messages that
"KRN",.84,36610,2,19,0)
the user is a recipient of.  As long as the 'AUTOPURGE' has not
"KRN",.84,36610,2,20,0)
been run or another user has kept a copy, messages can be recovered.
"KRN",.84,36610,3,0)
^.845^2^2
"KRN",.84,36610,3,1,0)
1^how old is old?
"KRN",.84,36610,3,2,0)
2^messages are set for deletion in this many days
"KRN",.84,36610,5,0)
^.841^1^1
"KRN",.84,36610,5,1,0)
XMUPIN
"KRN",.84,36610,5,"B","XMUPIN",1)

"KRN",.84,36611,-1)
0^884
"KRN",.84,36611,0)
36611^2^^MAILMAN^This may take some time.  Do you
"KRN",.84,36611,2,0)
^^1^1^3020410^
"KRN",.84,36611,2,1,0)
This may take some time.  Do you wish to continue
"KRN",.84,36611,5,0)
^.841^1^1
"KRN",.84,36611,5,1,0)
XMUPIN
"KRN",.84,36611,5,"B","XMUPIN",1)

"KRN",.84,36612,-1)
0^885
"KRN",.84,36612,0)
36612^2^y^MAILMAN^Compiling lists of messages to delete
"KRN",.84,36612,2,0)
^^1^1^3020410^
"KRN",.84,36612,2,1,0)
Compiling lists of messages to delete in |1| days from *all* baskets
"KRN",.84,36612,3,0)
^.845^1^1
"KRN",.84,36612,3,1,0)
1^number of days grace period
"KRN",.84,36612,5,0)
^.841^1^1
"KRN",.84,36612,5,1,0)
XMUPIN
"KRN",.84,36612,5,"B","XMUPIN",1)

"KRN",.84,36613,-1)
0^886
"KRN",.84,36613,0)
36613^2^y^MAILMAN^Compiling lists of messages to delete
"KRN",.84,36613,2,0)
^^1^1^3020410^
"KRN",.84,36613,2,1,0)
Compiling lists of messages to delete in |1| days from IN baskets
"KRN",.84,36613,3,0)
^.845^1^1
"KRN",.84,36613,3,1,0)
1^number of days grace period
"KRN",.84,36613,5,0)
^.841^1^1
"KRN",.84,36613,5,1,0)
XMUPIN
"KRN",.84,36613,5,"B","XMUPIN",1)

"KRN",.84,36614,-1)
0^1445
"KRN",.84,36614,0)
36614^2^^MAILMAN^Last rd
"KRN",.84,36614,1,0)
^^1^1^3020715^
"KRN",.84,36614,1,1,0)
Date the message was last read
"KRN",.84,36614,2,0)
^.844^1^1^3020715^^^
"KRN",.84,36614,2,1,0)
Last rd
"KRN",.84,36614,5,0)
^.841^1^1
"KRN",.84,36614,5,1,0)
XMUPIN
"KRN",.84,36614,5,"B","XMUPIN",1)

"KRN",.84,37000,-1)
0^888
"KRN",.84,37000,0)
37000^1^^MAILMAN^up-arrow out.
"KRN",.84,37000,2,0)
^^1^1^2991030^^
"KRN",.84,37000,2,1,0)
up-arrow out.
"KRN",.84,37000,5,0)
^.841^1^1
"KRN",.84,37000,5,1,0)
XMXADDRD
"KRN",.84,37000,5,"B","XMXADDRD",1)

"KRN",.84,37001,-1)
0^889
"KRN",.84,37001,0)
37001^1^^MAILMAN^time out.
"KRN",.84,37001,2,0)
^^1^1^2991030^
"KRN",.84,37001,2,1,0)
time out.
"KRN",.84,37001,5,0)
^.841^1^1
"KRN",.84,37001,5,1,0)
XMXADDRD
"KRN",.84,37001,5,"B","XMXADDRD",1)

"KRN",.84,37002,-1)
0^890
"KRN",.84,37002,0)
37002^1^^MAILMAN^up-arrow or time out.
"KRN",.84,37002,2,0)
^^1^1^2991030^
"KRN",.84,37002,2,1,0)
up-arrow or time out.
"KRN",.84,37002,5,0)
^.841^1^1
"KRN",.84,37002,5,1,0)
XMXADDRD
"KRN",.84,37002,5,"B","XMXADDRD",1)

"KRN",.84,37003,-1)
0^891
"KRN",.84,37003,0)
37003^2^^MAILMAN^Press RETURN to continue
"KRN",.84,37003,2,0)
^^1^1^2991101^
"KRN",.84,37003,2,1,0)
Press RETURN to continue
"KRN",.84,37003,5,0)
^.841^1^1
"KRN",.84,37003,5,1,0)
XMXUTIL
"KRN",.84,37003,5,"B","XMXUTIL",1)

"KRN",.84,37004,-1)
0^892
"KRN",.84,37004,0)
37004^2^^MAILMAN^WASTE
"KRN",.84,37004,2,0)
^^1^1^2991101^
"KRN",.84,37004,2,1,0)
WASTE
"KRN",.84,37004,5,0)
^.841^2^2
"KRN",.84,37004,5,1,0)
XMXREPLY
"KRN",.84,37004,5,2,0)
XMUT4
"KRN",.84,37004,5,"B","XMUT4",2)

"KRN",.84,37004,5,"B","XMXREPLY",1)

"KRN",.84,37005,-1)
0^893
"KRN",.84,37005,0)
37005^2^^MAILMAN^IN
"KRN",.84,37005,2,0)
^^1^1^2991101^
"KRN",.84,37005,2,1,0)
IN
"KRN",.84,37005,5,0)
^.841^2^2
"KRN",.84,37005,5,1,0)
XMXREPLY
"KRN",.84,37005,5,2,0)
XMUT4
"KRN",.84,37005,5,"B","XMUT4",2)

"KRN",.84,37005,5,"B","XMXREPLY",1)

"KRN",.84,37006,-1)
0^894
"KRN",.84,37006,0)
37006^2^^MAILMAN^Re:
"KRN",.84,37006,1,0)
^^1^1^3000107^
"KRN",.84,37006,1,1,0)
Note: this dialog has a blank at the end of it.
"KRN",.84,37006,2,0)
^^1^1^3000107^^^
"KRN",.84,37006,2,1,0)
Re: 
"KRN",.84,37006,5,0)
^.841^3^3
"KRN",.84,37006,5,1,0)
XMXREPLY
"KRN",.84,37006,5,2,0)
XMXANSER
"KRN",.84,37006,5,3,0)
XMJMA
"KRN",.84,37006,5,"B","XMJMA",3)

"KRN",.84,37006,5,"B","XMXANSER",2)

"KRN",.84,37006,5,"B","XMXREPLY",1)

"KRN",.84,37007,-1)
0^895
"KRN",.84,37007,0)
37007^2^^MAILMAN^NOW
"KRN",.84,37007,1,0)
^^2^2^3000808^
"KRN",.84,37007,1,1,0)
This is the FileMan reserved word, used as an answer to a FileMan
"KRN",.84,37007,1,2,0)
date/time prompt.
"KRN",.84,37007,2,0)
^.844^1^1^3000808^
"KRN",.84,37007,2,1,0)
NOW
"KRN",.84,37007,5,0)
^.841^1^1
"KRN",.84,37007,5,1,0)
XMJMBULL
"KRN",.84,37007,5,"B","XMJMBULL",1)

"KRN",.84,37008,-1)
0^896
"KRN",.84,37008,0)
37008^2^^MAILMAN^Select one of the following:
"KRN",.84,37008,2,0)
^^1^1^3000829^
"KRN",.84,37008,2,1,0)
Select one of the following:
"KRN",.84,37008,5,0)
^.841^1^1
"KRN",.84,37008,5,1,0)
XMJMF1
"KRN",.84,37008,5,"B","XMJMF1",1)

"KRN",.84,37100,-1)
0^897
"KRN",.84,37100,0)
37100^1^y^MAILMAN^You may not access any message prior to
"KRN",.84,37100,2,0)
^^2^2^2991203^
"KRN",.84,37100,2,1,0)
You may not access any message prior to |1|,
"KRN",.84,37100,2,2,0)
unless someone forwards it to you.
"KRN",.84,37100,3,0)
^.845^1^1
"KRN",.84,37100,3,1,0)
1^cutoff date
"KRN",.84,37100,5,0)
^.841^1^1
"KRN",.84,37100,5,1,0)
XMXSEC
"KRN",.84,37100,5,"B","XMXSEC",1)

"KRN",.84,37101,-1)
0^898
"KRN",.84,37101,0)
37101^1^y^MAILMAN^Message |1| is a response to message |2|.
"KRN",.84,37101,2,0)
^^1^1^2991203^
"KRN",.84,37101,2,1,0)
Message |1| is a response to message |2|.
"KRN",.84,37101,3,0)
^.845^2^2
"KRN",.84,37101,3,1,0)
1^message reply ien
"KRN",.84,37101,3,2,0)
2^original message ien
"KRN",.84,37101,5,0)
^.841^1^1
"KRN",.84,37101,5,1,0)
XMXSEC
"KRN",.84,37101,5,"B","XMXSEC",1)

"KRN",.84,37102,-1)
0^899
"KRN",.84,37102,0)
37102^1^^MAILMAN^You are neither the originator nor a recip
"KRN",.84,37102,2,0)
^^2^2^2991203^^
"KRN",.84,37102,2,1,0)
You are neither the originator nor a recipient of this message.
"KRN",.84,37102,2,2,0)
If you need to see it, ask someone to forward it to you.
"KRN",.84,37102,5,0)
^.841^1^1
"KRN",.84,37102,5,1,0)
XMXSEC
"KRN",.84,37102,5,"B","XMXSEC",1)

"KRN",.84,37103,-1)
0^1437
"KRN",.84,37103,0)
37103^1^y^MAILMAN^You may not access this message as |1|
"KRN",.84,37103,2,0)
^^2^2^3020517^
"KRN",.84,37103,2,1,0)
You may not access this message as |1| unless you
"KRN",.84,37103,2,2,0)
or someone else on the message forwards it to |1|.
"KRN",.84,37103,3,0)
^.845^1^1
"KRN",.84,37103,3,1,0)
1^surrogate name
"KRN",.84,37103,5,0)
^.841^1^1
"KRN",.84,37103,5,1,0)
XMXSEC
"KRN",.84,37103,5,"B","XMXSEC",1)

"KRN",.84,37104,-1)
0^1438
"KRN",.84,37104,0)
37104^2^y^MAILMAN^Do you want to forward this message to |1|
"KRN",.84,37104,2,0)
^^1^1^3020520^
"KRN",.84,37104,2,1,0)
Do you want to forward this message to |1|
"KRN",.84,37104,3,0)
^.845^1^1
"KRN",.84,37104,3,1,0)
1^name of user to forward to
"KRN",.84,37104,5,0)
^.841^1^1
"KRN",.84,37104,5,1,0)
XMJMLR1
"KRN",.84,37104,5,"B","XMJMLR1",1)

"KRN",.84,37201,-1)
0^900
"KRN",.84,37201,0)
37201^2^^MAILMAN^C:Change the name of this basket
"KRN",.84,37201,2,0)
^^1^1^2991207^^
"KRN",.84,37201,2,1,0)
C:Change the name of this basket
"KRN",.84,37201,5,0)
^.841^1^1
"KRN",.84,37201,5,1,0)
XMXSEC1
"KRN",.84,37201,5,"B","XMXSEC1",1)

"KRN",.84,37201.1,-1)
0^901
"KRN",.84,37201.1,0)
37201.1^1^^MAILMAN^The name of this basket may not be changed
"KRN",.84,37201.1,2,0)
^^1^1^2991207^
"KRN",.84,37201.1,2,1,0)
The name of this basket may not be changed.
"KRN",.84,37201.1,5,0)
^.841^1^1
"KRN",.84,37201.1,5,1,0)
XMXSEC1
"KRN",.84,37201.1,5,"B","XMXSEC1",1)

"KRN",.84,37201.2,-1)
0^902
"KRN",.84,37201.2,0)
37201.2^1^y^MAILMAN^The '|1|' basket name may not be changed.
"KRN",.84,37201.2,2,0)
^^1^1^2991207^
"KRN",.84,37201.2,2,1,0)
The '|1|' basket name may not be changed.
"KRN",.84,37201.2,3,0)
^.845^1^1
"KRN",.84,37201.2,3,1,0)
1^correct name of this basket
"KRN",.84,37201.2,5,0)
^.841^1^1
"KRN",.84,37201.2,5,1,0)
XMXSEC1
"KRN",.84,37201.2,5,"B","XMXSEC1",1)

"KRN",.84,37201.3,-1)
0^903
"KRN",.84,37201.3,0)
37201.3^1^y^MAILMAN^Basket '|1|' already exists.
"KRN",.84,37201.3,2,0)
^^1^1^3000203^
"KRN",.84,37201.3,2,1,0)
Basket '|1|' already exists.
"KRN",.84,37201.3,3,0)
^.845^1^1
"KRN",.84,37201.3,3,1,0)
1^existing basket name
"KRN",.84,37201.3,5,0)
^.841^1^1
"KRN",.84,37201.3,5,1,0)
XMXBSKT
"KRN",.84,37201.3,5,"B","XMXBSKT",1)

"KRN",.84,37202,-1)
0^904
"KRN",.84,37202,0)
37202^2^^MAILMAN^D:Delete messages
"KRN",.84,37202,2,0)
^^1^1^2991207^^
"KRN",.84,37202,2,1,0)
D:Delete messages
"KRN",.84,37202,5,0)
^.841^1^1
"KRN",.84,37202,5,1,0)
XMXSEC1
"KRN",.84,37202,5,"B","XMXSEC1",1)

"KRN",.84,37203,-1)
0^905
"KRN",.84,37203,0)
37203^2^^MAILMAN^F:Forward messages
"KRN",.84,37203,2,0)
^^1^1^2991207^^
"KRN",.84,37203,2,1,0)
F:Forward messages
"KRN",.84,37203,5,0)
^.841^1^1
"KRN",.84,37203,5,1,0)
XMXSEC1
"KRN",.84,37203,5,"B","XMXSEC1",1)

"KRN",.84,37204,-1)
0^906
"KRN",.84,37204,0)
37204^2^^MAILMAN^FI:Filter messages
"KRN",.84,37204,2,0)
^^1^1^2991207^^
"KRN",.84,37204,2,1,0)
FI:Filter messages
"KRN",.84,37204,5,0)
^.841^1^1
"KRN",.84,37204,5,1,0)
XMXSEC1
"KRN",.84,37204,5,"B","XMXSEC1",1)

"KRN",.84,37204.1,-1)
0^907
"KRN",.84,37204.1,0)
37204.1^1^^MAILMAN^You have no message filters defined.
"KRN",.84,37204.1,2,0)
^^1^1^2991207^
"KRN",.84,37204.1,2,1,0)
You have no message filters defined.
"KRN",.84,37204.1,5,0)
^.841^1^1
"KRN",.84,37204.1,5,1,0)
XMXSEC1
"KRN",.84,37204.1,5,"B","XMXSEC1",1)

"KRN",.84,37204.2,-1)
0^908
"KRN",.84,37204.2,0)
37204.2^1^y^MAILMAN^|1| has no message filters defined.
"KRN",.84,37204.2,2,0)
^^1^1^2991207^
"KRN",.84,37204.2,2,1,0)
|1| has no message filters defined.
"KRN",.84,37204.2,3,0)
^.845^1^1
"KRN",.84,37204.2,3,1,0)
1^surrogate name
"KRN",.84,37204.2,5,0)
^.841^1^1
"KRN",.84,37204.2,5,1,0)
XMXSEC1
"KRN",.84,37204.2,5,"B","XMXSEC1",1)

"KRN",.84,37205,-1)
0^909
"KRN",.84,37205,0)
37205^2^^MAILMAN^H:Headerless Print messages
"KRN",.84,37205,2,0)
^^1^1^2991207^
"KRN",.84,37205,2,1,0)
H:Headerless Print messages
"KRN",.84,37205,5,0)
^.841^1^1
"KRN",.84,37205,5,1,0)
XMXSEC1
"KRN",.84,37205,5,"B","XMXSEC1",1)

"KRN",.84,37206,-1)
0^910
"KRN",.84,37206,0)
37206^2^^MAILMAN^L:Later messages
"KRN",.84,37206,2,0)
^^1^1^2991207^
"KRN",.84,37206,2,1,0)
L:Later messages
"KRN",.84,37206,5,0)
^.841^1^1
"KRN",.84,37206,5,1,0)
XMXSEC1
"KRN",.84,37206,5,"B","XMXSEC1",1)

"KRN",.84,37207,-1)
0^911
"KRN",.84,37207,0)
37207^2^^MAILMAN^N:New message list
"KRN",.84,37207,2,0)
^^1^1^2991207^
"KRN",.84,37207,2,1,0)
N:New message list
"KRN",.84,37207,5,0)
^.841^1^1
"KRN",.84,37207,5,1,0)
XMXSEC1
"KRN",.84,37207,5,"B","XMXSEC1",1)

"KRN",.84,37208,-1)
0^912
"KRN",.84,37208,0)
37208^2^^MAILMAN^NT:New Toggle messages
"KRN",.84,37208,2,0)
^^1^1^2991207^
"KRN",.84,37208,2,1,0)
NT:New Toggle messages
"KRN",.84,37208,5,0)
^.841^1^1
"KRN",.84,37208,5,1,0)
XMXSEC1
"KRN",.84,37208,5,"B","XMXSEC1",1)

"KRN",.84,37209,-1)
0^913
"KRN",.84,37209,0)
37209^2^^MAILMAN^P:Print messages
"KRN",.84,37209,2,0)
^^1^1^2991207^
"KRN",.84,37209,2,1,0)
P:Print messages
"KRN",.84,37209,5,0)
^.841^1^1
"KRN",.84,37209,5,1,0)
XMXSEC1
"KRN",.84,37209,5,"B","XMXSEC1",1)

"KRN",.84,37211,-1)
0^914
"KRN",.84,37211,0)
37211^2^^MAILMAN^Q:Query (search for) messages
"KRN",.84,37211,2,0)
^^1^1^2991207^
"KRN",.84,37211,2,1,0)
Q:Query (search for) messages
"KRN",.84,37211,5,0)
^.841^1^1
"KRN",.84,37211,5,1,0)
XMXSEC1
"KRN",.84,37211,5,"B","XMXSEC1",1)

"KRN",.84,37212,-1)
0^915
"KRN",.84,37212,0)
37212^2^^MAILMAN^R:Resequence messages
"KRN",.84,37212,2,0)
^^1^1^2991207^
"KRN",.84,37212,2,1,0)
R:Resequence messages
"KRN",.84,37212,5,0)
^.841^1^1
"KRN",.84,37212,5,1,0)
XMXSEC1
"KRN",.84,37212,5,"B","XMXSEC1",1)

"KRN",.84,37212.8,-1)
0^916
"KRN",.84,37212.8,0)
37212.8^1^y^MAILMAN^Error resequencing the '|1|' basket.
"KRN",.84,37212.8,2,0)
^^1^1^3000203^^
"KRN",.84,37212.8,2,1,0)
Error resequencing the '|1|' basket.
"KRN",.84,37212.8,3,0)
^.845^1^1
"KRN",.84,37212.8,3,1,0)
1^basket name
"KRN",.84,37212.8,5,0)
^.841^1^1
"KRN",.84,37212.8,5,1,0)
XMXBSKT
"KRN",.84,37212.8,5,"B","XMXBSKT",1)

"KRN",.84,37212.9,-1)
0^917
"KRN",.84,37212.9,0)
37212.9^2^y^MAILMAN^Resequenced from 1 to |1|.
"KRN",.84,37212.9,2,0)
^^1^1^3000203^
"KRN",.84,37212.9,2,1,0)
Resequenced from 1 to |1|.
"KRN",.84,37212.9,3,0)
^.845^1^1
"KRN",.84,37212.9,3,1,0)
1^last sequence number in basket
"KRN",.84,37212.9,5,0)
^.841^1^1
"KRN",.84,37212.9,5,1,0)
XMXBSKT
"KRN",.84,37212.9,5,"B","XMXBSKT",1)

"KRN",.84,37213,-1)
0^918
"KRN",.84,37213,0)
37213^2^^MAILMAN^S:Save messages to another basket
"KRN",.84,37213,2,0)
^^1^1^2991207^
"KRN",.84,37213,2,1,0)
S:Save messages to another basket
"KRN",.84,37213,5,0)
^.841^1^1
"KRN",.84,37213,5,1,0)
XMXSEC1
"KRN",.84,37213,5,"B","XMXSEC1",1)

"KRN",.84,37214,-1)
0^919
"KRN",.84,37214,0)
37214^2^^MAILMAN^T:Terminate messages
"KRN",.84,37214,2,0)
^^1^1^2991207^
"KRN",.84,37214,2,1,0)
T:Terminate messages
"KRN",.84,37214,5,0)
^.841^1^1
"KRN",.84,37214,5,1,0)
XMXSEC1
"KRN",.84,37214,5,"B","XMXSEC1",1)

"KRN",.84,37215.1,-1)
0^920
"KRN",.84,37215.1,0)
37215.1^1^^MAILMAN^This basket may not be deleted.
"KRN",.84,37215.1,2,0)
^^1^1^3000203^
"KRN",.84,37215.1,2,1,0)
This basket may not be deleted.
"KRN",.84,37215.1,5,0)
^.841^1^1
"KRN",.84,37215.1,5,1,0)
XMXBSKT
"KRN",.84,37215.1,5,"B","XMXBSKT",1)

"KRN",.84,37215.2,-1)
0^921
"KRN",.84,37215.2,0)
37215.2^1^y^MAILMAN^The '|1|' basket may not be deleted.
"KRN",.84,37215.2,2,0)
^^1^1^3000203^
"KRN",.84,37215.2,2,1,0)
The '|1|' basket may not be deleted.
"KRN",.84,37215.2,3,0)
^.845^1^1
"KRN",.84,37215.2,3,1,0)
1^basket name
"KRN",.84,37215.2,5,0)
^.841^1^1
"KRN",.84,37215.2,5,1,0)
XMXBSKT
"KRN",.84,37215.2,5,"B","XMXBSKT",1)

"KRN",.84,37215.3,-1)
0^922
"KRN",.84,37215.3,0)
37215.3^1^^MAILMAN^This basket may not be deleted,
"KRN",.84,37215.3,2,0)
^^1^1^3000203^
"KRN",.84,37215.3,2,1,0)
This basket may not be deleted, because it still has messages in it.
"KRN",.84,37215.3,5,0)
^.841^1^1
"KRN",.84,37215.3,5,1,0)
XMXBSKT
"KRN",.84,37215.3,5,"B","XMXBSKT",1)

"KRN",.84,37215.4,-1)
0^923
"KRN",.84,37215.4,0)
37215.4^1^y^MAILMAN^The '|1|' basket may not be deleted,
"KRN",.84,37215.4,2,0)
^^2^2^3000203^
"KRN",.84,37215.4,2,1,0)
The '|1|' basket may not be deleted,
"KRN",.84,37215.4,2,2,0)
because it still has messages in it.
"KRN",.84,37215.4,3,0)
^.845^1^1
"KRN",.84,37215.4,3,1,0)
1^basket name
"KRN",.84,37215.4,5,0)
^.841^1^1
"KRN",.84,37215.4,5,1,0)
XMXBSKT
"KRN",.84,37215.4,5,"B","XMXBSKT",1)

"KRN",.84,37216,-1)
0^924
"KRN",.84,37216,0)
37216^2^^MAILMAN^V:Vaporize date set messages
"KRN",.84,37216,2,0)
^^1^1^3000607^
"KRN",.84,37216,2,1,0)
V:Vaporize date set messages
"KRN",.84,37216,5,0)
^.841^1^1
"KRN",.84,37216,5,1,0)
XMXSEC1
"KRN",.84,37216,5,"B","XMXSEC1",1)

"KRN",.84,37219,-1)
0^925
"KRN",.84,37219,0)
37219^2^^MAILMAN^X:Xmit priority toggle
"KRN",.84,37219,2,0)
^^1^1^2991207^
"KRN",.84,37219,2,1,0)
X:Xmit priority toggle
"KRN",.84,37219,5,0)
^.841^1^1
"KRN",.84,37219,5,1,0)
XMXSEC1
"KRN",.84,37219,5,"B","XMXSEC1",1)

"KRN",.84,37219.5,-1)
0^926
"KRN",.84,37219.5,0)
37219.5^1^^MAILMAN^Transmit priority toggle valid only for
"KRN",.84,37219.5,2,0)
^^1^1^3000106^^
"KRN",.84,37219.5,2,1,0)
Transmit priority toggle valid only for Postmaster transmission queues.
"KRN",.84,37219.5,5,0)
^.841^2^2
"KRN",.84,37219.5,5,1,0)
XMXMSGS
"KRN",.84,37219.5,5,2,0)
XMXMSGS1
"KRN",.84,37219.5,5,"B","XMXMSGS",1)

"KRN",.84,37219.5,5,"B","XMXMSGS1",2)

"KRN",.84,37221,-1)
0^927
"KRN",.84,37221,0)
37221^2^^MAILMAN^CD:Change Detail
"KRN",.84,37221,2,0)
^^1^1^2991207^
"KRN",.84,37221,2,1,0)
CD:Change Detail
"KRN",.84,37221,5,0)
^.841^2^2
"KRN",.84,37221,5,1,0)
XMXSEC1
"KRN",.84,37221,5,2,0)
XMJMLR1
"KRN",.84,37221,5,"B","XMJMLR1",2)

"KRN",.84,37221,5,"B","XMXSEC1",1)

"KRN",.84,37222,-1)
0^928
"KRN",.84,37222,0)
37222^2^^MAILMAN^O:Opposite selection toggle
"KRN",.84,37222,2,0)
^^1^1^2991207^
"KRN",.84,37222,2,1,0)
O:Opposite selection toggle
"KRN",.84,37222,5,0)
^.841^2^2
"KRN",.84,37222,5,1,0)
XMXSEC1
"KRN",.84,37222,5,2,0)
XMJMLR1
"KRN",.84,37222,5,"B","XMJMLR1",2)

"KRN",.84,37222,5,"B","XMXSEC1",1)

"KRN",.84,37223,-1)
0^929
"KRN",.84,37223,0)
37223^2^^MAILMAN^Z:Zoom selection toggle
"KRN",.84,37223,2,0)
^^1^1^2991207^
"KRN",.84,37223,2,1,0)
Z:Zoom selection toggle
"KRN",.84,37223,5,0)
^.841^2^2
"KRN",.84,37223,5,1,0)
XMXSEC1
"KRN",.84,37223,5,2,0)
XMJMLR1
"KRN",.84,37223,5,"B","XMJMLR1",2)

"KRN",.84,37223,5,"B","XMXSEC1",1)

"KRN",.84,37231,-1)
0^930
"KRN",.84,37231,0)
37231^1^^MAILMAN^You can't do this unless messages are sele
"KRN",.84,37231,2,0)
^^1^1^2991207^
"KRN",.84,37231,2,1,0)
You can't do this unless messages are selected.
"KRN",.84,37231,5,0)
^.841^2^2
"KRN",.84,37231,5,1,0)
XMXSEC1
"KRN",.84,37231,5,2,0)
XMJMLR1
"KRN",.84,37231,5,"B","XMJMLR1",2)

"KRN",.84,37231,5,"B","XMXSEC1",1)

"KRN",.84,37232,-1)
0^931
"KRN",.84,37232,0)
37232^1^^MAILMAN^You can't do this with messages selected.
"KRN",.84,37232,2,0)
^^1^1^2991207^
"KRN",.84,37232,2,1,0)
You can't do this with messages selected.
"KRN",.84,37232,5,0)
^.841^2^2
"KRN",.84,37232,5,1,0)
XMXSEC1
"KRN",.84,37232,5,2,0)
XMJMLR1
"KRN",.84,37232,5,"B","XMJMLR1",2)

"KRN",.84,37232,5,"B","XMXSEC1",1)

"KRN",.84,37241,-1)
0^932
"KRN",.84,37241,0)
37241^2^^MAILMAN^I:Ignore this message
"KRN",.84,37241,2,0)
^^1^1^2991207^
"KRN",.84,37241,2,1,0)
I:Ignore this message
"KRN",.84,37241,5,0)
^.841^1^1
"KRN",.84,37241,5,1,0)
XMJBM
"KRN",.84,37241,5,"B","XMJBM",1)

"KRN",.84,37251,-1)
0^933
"KRN",.84,37251,0)
37251^1^^MAILMAN^You may not do this with messages in the
"KRN",.84,37251,2,0)
^^1^1^2991207^
"KRN",.84,37251,2,1,0)
You may not do this with messages in the transmit queues.
"KRN",.84,37251,5,0)
^.841^1^1
"KRN",.84,37251,5,1,0)
XMXSEC1
"KRN",.84,37251,5,"B","XMXSEC1",1)

"KRN",.84,37261,-1)
0^934
"KRN",.84,37261,0)
37261^1^^MAILMAN^You must hold the XMMGR key or be a POSTM
"KRN",.84,37261,2,0)
^^2^2^2991207^
"KRN",.84,37261,2,1,0)
You must hold the XMMGR key or be a POSTMASTER surrogate
"KRN",.84,37261,2,2,0)
to do this in SHARED,MAIL.
"KRN",.84,37261,5,0)
^.841^1^1
"KRN",.84,37261,5,1,0)
XMXSEC1
"KRN",.84,37261,5,"B","XMXSEC1",1)

"KRN",.84,37301,-1)
0^935
"KRN",.84,37301,0)
37301^2^^MAILMAN^C:Confidential (surrogate can't read)
"KRN",.84,37301,2,0)
^^1^1^2991208^
"KRN",.84,37301,2,1,0)
C:Confidential (surrogate can't read)
"KRN",.84,37301,5,0)
^.841^1^1
"KRN",.84,37301,5,1,0)
XMXSEC2
"KRN",.84,37301,5,"B","XMXSEC2",1)

"KRN",.84,37301.6,-1)
0^936
"KRN",.84,37301.6,0)
37301.6^1^^MAILMAN^Messages addressed to SHARED,MAIL may not
"KRN",.84,37301.6,2,0)
^^1^1^2991208^^
"KRN",.84,37301.6,2,1,0)
Messages addressed to SHARED,MAIL may not be 'Confidential'.
"KRN",.84,37301.6,5,0)
^.841^1^1
"KRN",.84,37301.6,5,1,0)
XMXSEC2
"KRN",.84,37301.6,5,"B","XMXSEC2",1)

"KRN",.84,37301.9,-1)
0^937
"KRN",.84,37301.9,0)
37301.9^2^^MAILMAN^Message flagged 'Confidential'.
"KRN",.84,37301.9,2,0)
^^1^1^2991208^
"KRN",.84,37301.9,2,1,0)
Message flagged 'Confidential'.
"KRN",.84,37301.9,5,0)
^.841^2^2
"KRN",.84,37301.9,5,1,0)
XMJMSO
"KRN",.84,37301.9,5,2,0)
XMXEDIT
"KRN",.84,37301.9,5,"B","XMJMSO",1)

"KRN",.84,37301.9,5,"B","XMXEDIT",2)

"KRN",.84,37302,-1)
0^938
"KRN",.84,37302,0)
37302^2^^MAILMAN^C:UnConfidential (surrogate may read)
"KRN",.84,37302,2,0)
^^1^1^2991208^
"KRN",.84,37302,2,1,0)
C:UnConfidential (surrogate may read)
"KRN",.84,37302,5,0)
^.841^1^1
"KRN",.84,37302,5,1,0)
XMXSEC2
"KRN",.84,37302,5,"B","XMXSEC2",1)

"KRN",.84,37302.9,-1)
0^939
"KRN",.84,37302.9,0)
37302.9^2^^MAILMAN^'Confidential' flag removed.
"KRN",.84,37302.9,2,0)
^^1^1^2991208^
"KRN",.84,37302.9,2,1,0)
'Confidential' flag removed.
"KRN",.84,37302.9,5,0)
^.841^2^2
"KRN",.84,37302.9,5,1,0)
XMJMSO
"KRN",.84,37302.9,5,2,0)
XMXEDIT
"KRN",.84,37302.9,5,"B","XMJMSO",1)

"KRN",.84,37302.9,5,"B","XMXEDIT",2)

"KRN",.84,37303,-1)
0^940
"KRN",.84,37303,0)
37303^2^^MAILMAN^D:Delivery basket set
"KRN",.84,37303,2,0)
^^1^1^2991208^
"KRN",.84,37303,2,1,0)
D:Delivery basket set
"KRN",.84,37303,5,0)
^.841^1^1
"KRN",.84,37303,5,1,0)
XMXSEC2
"KRN",.84,37303,5,"B","XMXSEC2",1)

"KRN",.84,37303.1,-1)
0^941
"KRN",.84,37303.1,0)
37303.1^2^^MAILMAN^The delivery basket is the basket to which
"KRN",.84,37303.1,2,0)
^^16^16^2991221^
"KRN",.84,37303.1,2,1,0)
The delivery basket is the basket to which this message should be delivered
"KRN",.84,37303.1,2,2,0)
for all recipients (even future ones, should the message be forwarded).
"KRN",.84,37303.1,2,3,0)
Any message filters, which the recipient might have, are ignored.
"KRN",.84,37303.1,2,4,0)
If the basket does not exist, it will be created.
"KRN",.84,37303.1,2,5,0)
 
"KRN",.84,37303.1,2,6,0)
Note: The recipients must have chosen to allow delivery baskets by setting
"KRN",.84,37303.1,2,7,0)
ACCEPT DELIVERY BASKET? under 'Personal Preferences|Delivery Basket Edit'
"KRN",.84,37303.1,2,8,0)
to one of the following:
"KRN",.84,37303.1,2,9,0)
 YES    - If basket doesn't exist, create it, and deliver the message to it.
"KRN",.84,37303.1,2,10,0)
 EXIST  - If the basket already exists, then deliver the message to it.
"KRN",.84,37303.1,2,11,0)
          Else, just deliver the message as usual.
"KRN",.84,37303.1,2,12,0)
 SELECT - If the basket already exists AND accepts such messages,
"KRN",.84,37303.1,2,13,0)
          then deliver the message to it.
"KRN",.84,37303.1,2,14,0)
          Else, just deliver the message as usual.
"KRN",.84,37303.1,2,15,0)
If the recipient has not set this field or has set it to NO, then
"KRN",.84,37303.1,2,16,0)
the message would be delivered as usual.
"KRN",.84,37303.1,5,0)
^.841^1^1
"KRN",.84,37303.1,5,1,0)
XMJMSO
"KRN",.84,37303.1,5,"B","XMJMSO",1)

"KRN",.84,37303.2,-1)
0^942
"KRN",.84,37303.2,0)
37303.2^2^^MAILMAN^Select delivery basket: 
"KRN",.84,37303.2,1,0)
^^1^1^2991221^
"KRN",.84,37303.2,1,1,0)
Note: there is one blank character at the end of this dialog.
"KRN",.84,37303.2,2,0)
^^1^1^2991221^
"KRN",.84,37303.2,2,1,0)
Select delivery basket: 
"KRN",.84,37303.2,5,0)
^.841^1^1
"KRN",.84,37303.2,5,1,0)
XMJMSO
"KRN",.84,37303.2,5,"B","XMJMSO",1)

"KRN",.84,37303.9,-1)
0^943
"KRN",.84,37303.9,0)
37303.9^2^^MAILMAN^Delivery basket set.
"KRN",.84,37303.9,2,0)
^^1^1^2991208^
"KRN",.84,37303.9,2,1,0)
Delivery basket set.
"KRN",.84,37303.9,5,0)
^.841^2^2
"KRN",.84,37303.9,5,1,0)
XMJMSO
"KRN",.84,37303.9,5,2,0)
XMXEDIT
"KRN",.84,37303.9,5,"B","XMJMSO",1)

"KRN",.84,37303.9,5,"B","XMXEDIT",2)

"KRN",.84,37304,-1)
0^944
"KRN",.84,37304,0)
37304^2^^MAILMAN^D:Delivery basket remove
"KRN",.84,37304,2,0)
^^1^1^2991208^
"KRN",.84,37304,2,1,0)
D:Delivery basket remove
"KRN",.84,37304,5,0)
^.841^1^1
"KRN",.84,37304,5,1,0)
XMXSEC2
"KRN",.84,37304,5,"B","XMXSEC2",1)

"KRN",.84,37304.9,-1)
0^945
"KRN",.84,37304.9,0)
37304.9^2^^MAILMAN^Delivery basket removed.
"KRN",.84,37304.9,2,0)
^^1^1^2991208^
"KRN",.84,37304.9,2,1,0)
Delivery basket removed.
"KRN",.84,37304.9,5,0)
^.841^2^2
"KRN",.84,37304.9,5,1,0)
XMJMSO
"KRN",.84,37304.9,5,2,0)
XMXEDIT
"KRN",.84,37304.9,5,"B","XMJMSO",1)

"KRN",.84,37304.9,5,"B","XMXEDIT",2)

"KRN",.84,37305,-1)
0^946
"KRN",.84,37305,0)
37305^2^^MAILMAN^ES:Edit Subject
"KRN",.84,37305,2,0)
^^1^1^2991208^
"KRN",.84,37305,2,1,0)
ES:Edit Subject
"KRN",.84,37305,5,0)
^.841^1^1
"KRN",.84,37305,5,1,0)
XMXSEC2
"KRN",.84,37305,5,"B","XMXSEC2",1)

"KRN",.84,37306,-1)
0^947
"KRN",.84,37306,0)
37306^2^^MAILMAN^ET:Edit Text
"KRN",.84,37306,2,0)
^^1^1^2991208^
"KRN",.84,37306,2,1,0)
ET:Edit Text
"KRN",.84,37306,5,0)
^.841^1^1
"KRN",.84,37306,5,1,0)
XMXSEC2
"KRN",.84,37306,5,"B","XMXSEC2",1)

"KRN",.84,37306.1,-1)
0^948
"KRN",.84,37306.1,0)
37306.1^2^^MAILMAN^W A R N I N G
"KRN",.84,37306.1,2,0)
^^12^12^2991221^
"KRN",.84,37306.1,2,1,0)
                    W A R N I N G
"KRN",.84,37306.1,2,2,0)
 
"KRN",.84,37306.1,2,3,0)
  You are about to edit what appears to be a PackMan message.
"KRN",.84,37306.1,2,4,0)
  Please note the following:
"KRN",.84,37306.1,2,5,0)
 
"KRN",.84,37306.1,2,6,0)
  1. If you edit this message you may compromise its integrity.
"KRN",.84,37306.1,2,7,0)
  2. If you must edit it,
"KRN",.84,37306.1,2,8,0)
     - Do not edit the code.
"KRN",.84,37306.1,2,9,0)
     - Confine your editing to the text (the lines between $TXT and $ENDTXT).
"KRN",.84,37306.1,2,10,0)
     - You may insert lines in the text.
"KRN",.84,37306.1,2,11,0)
     - Do not begin any line with a '$' (dollar sign).
"KRN",.84,37306.1,2,12,0)
     - Be careful!
"KRN",.84,37306.1,5,0)
^.841^1^1
"KRN",.84,37306.1,5,1,0)
XMJMSO
"KRN",.84,37306.1,5,"B","XMJMSO",1)

"KRN",.84,37306.2,-1)
0^949
"KRN",.84,37306.2,0)
37306.2^2^^MAILMAN^Are you sure you want to edit this message
"KRN",.84,37306.2,2,0)
^^1^1^2991221^
"KRN",.84,37306.2,2,1,0)
Are you sure you want to edit this message
"KRN",.84,37306.2,5,0)
^.841^1^1
"KRN",.84,37306.2,5,1,0)
XMJMSO
"KRN",.84,37306.2,5,"B","XMJMSO",1)

"KRN",.84,37307,-1)
0^950
"KRN",.84,37307,0)
37307^2^^MAILMAN^I:Information only (recipients may not rep
"KRN",.84,37307,2,0)
^^1^1^2991208^
"KRN",.84,37307,2,1,0)
I:Information only (recipients may not reply)
"KRN",.84,37307,5,0)
^.841^1^1
"KRN",.84,37307,5,1,0)
XMXSEC2
"KRN",.84,37307,5,"B","XMXSEC2",1)

"KRN",.84,37307.9,-1)
0^951
"KRN",.84,37307.9,0)
37307.9^2^^MAILMAN^Message flagged 'Information only'.
"KRN",.84,37307.9,2,0)
^^1^1^2991208^
"KRN",.84,37307.9,2,1,0)
Message flagged 'Information only'.
"KRN",.84,37307.9,5,0)
^.841^2^2
"KRN",.84,37307.9,5,1,0)
XMJMSO
"KRN",.84,37307.9,5,2,0)
XMXEDIT
"KRN",.84,37307.9,5,"B","XMJMSO",1)

"KRN",.84,37307.9,5,"B","XMXEDIT",2)

"KRN",.84,37308,-1)
0^952
"KRN",.84,37308,0)
37308^2^^MAILMAN^I:UnInformation only (recipients may reply
"KRN",.84,37308,2,0)
^^1^1^2991208^
"KRN",.84,37308,2,1,0)
I:UnInformation only (recipients may reply)
"KRN",.84,37308,5,0)
^.841^1^1
"KRN",.84,37308,5,1,0)
XMXSEC2
"KRN",.84,37308,5,"B","XMXSEC2",1)

"KRN",.84,37308.9,-1)
0^953
"KRN",.84,37308.9,0)
37308.9^2^^MAILMAN^'Information only' flag removed.
"KRN",.84,37308.9,2,0)
^^1^1^2991208^
"KRN",.84,37308.9,2,1,0)
'Information only' flag removed.
"KRN",.84,37308.9,5,0)
^.841^2^2
"KRN",.84,37308.9,5,1,0)
XMJMSO
"KRN",.84,37308.9,5,2,0)
XMXEDIT
"KRN",.84,37308.9,5,"B","XMJMSO",1)

"KRN",.84,37308.9,5,"B","XMXEDIT",2)

"KRN",.84,37309,-1)
0^954
"KRN",.84,37309,0)
37309^2^^MAILMAN^NS:Add Network Signature
"KRN",.84,37309,2,0)
^^1^1^2991208^
"KRN",.84,37309,2,1,0)
NS:Add Network Signature
"KRN",.84,37309,5,0)
^.841^1^1
"KRN",.84,37309,5,1,0)
XMXSEC2
"KRN",.84,37309,5,"B","XMXSEC2",1)

"KRN",.84,37309.1,-1)
0^955
"KRN",.84,37309.1,0)
37309.1^1^^MAILMAN^You have no Network Signature.
"KRN",.84,37309.1,2,0)
^^1^1^2991208^
"KRN",.84,37309.1,2,1,0)
You have no Network Signature.
"KRN",.84,37309.1,5,0)
^.841^1^1
"KRN",.84,37309.1,5,1,0)
XMXSEC2
"KRN",.84,37309.1,5,"B","XMXSEC2",1)

"KRN",.84,37309.2,-1)
0^956
"KRN",.84,37309.2,0)
37309.2^1^^MAILMAN^Network Signature has already been added.
"KRN",.84,37309.2,2,0)
^^1^1^2991208^
"KRN",.84,37309.2,2,1,0)
Network Signature has already been added.
"KRN",.84,37309.2,5,0)
^.841^2^2
"KRN",.84,37309.2,5,1,0)
XMJMOIE
"KRN",.84,37309.2,5,2,0)
XMJMSO
"KRN",.84,37309.2,5,"B","XMJMOIE",1)

"KRN",.84,37309.2,5,"B","XMJMSO",2)

"KRN",.84,37309.3,-1)
0^957
"KRN",.84,37309.3,0)
37309.3^1^^MAILMAN^|1| has no Network Signature.
"KRN",.84,37309.3,2,0)
^^1^1^2991208^
"KRN",.84,37309.3,2,1,0)
|1| has no Network Signature.
"KRN",.84,37309.3,5,0)
^.841^1^1
"KRN",.84,37309.3,5,1,0)
XMXSEC2
"KRN",.84,37309.3,5,"B","XMXSEC2",1)

"KRN",.84,37309.4,-1)
0^958
"KRN",.84,37309.4,0)
37309.4^1^^MAILMAN^You may not add a Network Signature to a K
"KRN",.84,37309.4,2,0)
^^1^1^2991216^^
"KRN",.84,37309.4,2,1,0)
You may not add a Network Signature to a KIDS or PackMan message.
"KRN",.84,37309.4,5,0)
^.841^1^1
"KRN",.84,37309.4,5,1,0)
XMXSEC2
"KRN",.84,37309.4,5,"B","XMXSEC2",1)

"KRN",.84,37309.5,-1)
0^959
"KRN",.84,37309.5,0)
37309.5^2^^MAILMAN^Would you like to create a Network Signat
"KRN",.84,37309.5,2,0)
^^1^1^2991221^
"KRN",.84,37309.5,2,1,0)
Would you like to create a Network Signature now
"KRN",.84,37309.5,5,0)
^.841^1^1
"KRN",.84,37309.5,5,1,0)
XMJMSO
"KRN",.84,37309.5,5,"B","XMJMSO",1)

"KRN",.84,37309.9,-1)
0^960
"KRN",.84,37309.9,0)
37309.9^2^^MAILMAN^Network Signature added.
"KRN",.84,37309.9,2,0)
^^1^1^2991208^
"KRN",.84,37309.9,2,1,0)
Network Signature added.
"KRN",.84,37309.9,5,0)
^.841^2^2
"KRN",.84,37309.9,5,1,0)
XMJMSO
"KRN",.84,37309.9,5,2,0)
XMXEDIT
"KRN",.84,37309.9,5,"B","XMJMSO",1)

"KRN",.84,37309.9,5,"B","XMXEDIT",2)

"KRN",.84,37311,-1)
0^961
"KRN",.84,37311,0)
37311^2^^MAILMAN^P:Priority delivery
"KRN",.84,37311,2,0)
^^1^1^2991208^
"KRN",.84,37311,2,1,0)
P:Priority delivery
"KRN",.84,37311,5,0)
^.841^1^1
"KRN",.84,37311,5,1,0)
XMXSEC2
"KRN",.84,37311,5,"B","XMXSEC2",1)

"KRN",.84,37311.9,-1)
0^962
"KRN",.84,37311.9,0)
37311.9^2^^MAILMAN^Message flagged 'Priority'.
"KRN",.84,37311.9,2,0)
^^1^1^2991208^
"KRN",.84,37311.9,2,1,0)
Message flagged 'Priority'.
"KRN",.84,37311.9,5,0)
^.841^2^2
"KRN",.84,37311.9,5,1,0)
XMJMSO
"KRN",.84,37311.9,5,2,0)
XMXSEC2
"KRN",.84,37311.9,5,"B","XMJMSO",1)

"KRN",.84,37311.9,5,"B","XMXSEC2",2)

"KRN",.84,37312,-1)
0^963
"KRN",.84,37312,0)
37312^2^^MAILMAN^P:Normal delivery
"KRN",.84,37312,2,0)
^^1^1^2991208^
"KRN",.84,37312,2,1,0)
P:Normal delivery
"KRN",.84,37312,5,0)
^.841^1^1
"KRN",.84,37312,5,1,0)
XMXSEC2
"KRN",.84,37312,5,"B","XMXSEC2",1)

"KRN",.84,37312.9,-1)
0^964
"KRN",.84,37312.9,0)
37312.9^2^^MAILMAN^'Priority' flag removed.
"KRN",.84,37312.9,2,0)
^^1^1^2991208^
"KRN",.84,37312.9,2,1,0)
'Priority' flag removed.
"KRN",.84,37312.9,5,0)
^.841^2^2
"KRN",.84,37312.9,5,1,0)
XMJMSO
"KRN",.84,37312.9,5,2,0)
XMXEDIT
"KRN",.84,37312.9,5,"B","XMJMSO",1)

"KRN",.84,37312.9,5,"B","XMXEDIT",2)

"KRN",.84,37313,-1)
0^965
"KRN",.84,37313,0)
37313^2^^MAILMAN^R:Confirm Receipt
"KRN",.84,37313,2,0)
^^1^1^2991208^^
"KRN",.84,37313,2,1,0)
R:Confirm Receipt
"KRN",.84,37313,5,0)
^.841^1^1
"KRN",.84,37313,5,1,0)
XMXSEC2
"KRN",.84,37313,5,"B","XMXSEC2",1)

"KRN",.84,37313.9,-1)
0^966
"KRN",.84,37313.9,0)
37313.9^2^^MAILMAN^Message flagged 'Confirm Receipt Requested
"KRN",.84,37313.9,2,0)
^^1^1^2991208^
"KRN",.84,37313.9,2,1,0)
Message flagged 'Confirm Receipt Requested'.
"KRN",.84,37313.9,5,0)
^.841^2^2
"KRN",.84,37313.9,5,1,0)
XMJMSO
"KRN",.84,37313.9,5,2,0)
XMXEDIT
"KRN",.84,37313.9,5,"B","XMJMSO",1)

"KRN",.84,37313.9,5,"B","XMXEDIT",2)

"KRN",.84,37314,-1)
0^967
"KRN",.84,37314,0)
37314^2^^MAILMAN^R:No Confirm Receipt
"KRN",.84,37314,2,0)
^^1^1^2991208^^
"KRN",.84,37314,2,1,0)
R:No Confirm Receipt
"KRN",.84,37314,5,0)
^.841^1^1
"KRN",.84,37314,5,1,0)
XMXSEC2
"KRN",.84,37314,5,"B","XMXSEC2",1)

"KRN",.84,37314.9,-1)
0^968
"KRN",.84,37314.9,0)
37314.9^2^^MAILMAN^'Confirm Receipt Requested' flag removed.
"KRN",.84,37314.9,2,0)
^^1^1^2991208^
"KRN",.84,37314.9,2,1,0)
'Confirm Receipt Requested' flag removed.
"KRN",.84,37314.9,5,0)
^.841^2^2
"KRN",.84,37314.9,5,1,0)
XMJMSO
"KRN",.84,37314.9,5,2,0)
XMXEDIT
"KRN",.84,37314.9,5,"B","XMJMSO",1)

"KRN",.84,37314.9,5,"B","XMXEDIT",2)

"KRN",.84,37315,-1)
0^969
"KRN",.84,37315,0)
37315^2^^MAILMAN^S:Scramble text with password
"KRN",.84,37315,2,0)
^^1^1^2991208^^
"KRN",.84,37315,2,1,0)
S:Scramble text with password
"KRN",.84,37315,5,0)
^.841^1^1
"KRN",.84,37315,5,1,0)
XMXSEC2
"KRN",.84,37315,5,"B","XMXSEC2",1)

"KRN",.84,37315.4,-1)
0^970
"KRN",.84,37315.4,0)
37315.4^1^^MAILMAN^Sorry, but we can't (un)secure a KIDS or
"KRN",.84,37315.4,2,0)
^^1^1^2991208^^
"KRN",.84,37315.4,2,1,0)
Sorry, but we can't (un)secure a KIDS or PackMan message here.
"KRN",.84,37315.4,5,0)
^.841^1^1
"KRN",.84,37315.4,5,1,0)
XMXSEC2
"KRN",.84,37315.4,5,"B","XMXSEC2",1)

"KRN",.84,37315.8,-1)
0^971
"KRN",.84,37315.8,0)
37315.8^1^^MAILMAN^Scramble aborted.
"KRN",.84,37315.8,2,0)
^^1^1^2991221^
"KRN",.84,37315.8,2,1,0)
Scramble aborted.
"KRN",.84,37315.8,5,0)
^.841^1^1
"KRN",.84,37315.8,5,1,0)
XMJMSO
"KRN",.84,37315.8,5,"B","XMJMSO",1)

"KRN",.84,37315.9,-1)
0^972
"KRN",.84,37315.9,0)
37315.9^2^^MAILMAN^Message text scrambled.
"KRN",.84,37315.9,2,0)
^^1^1^2991208^
"KRN",.84,37315.9,2,1,0)
Message text scrambled.
"KRN",.84,37315.9,5,0)
^.841^2^2
"KRN",.84,37315.9,5,1,0)
XMJMSO
"KRN",.84,37315.9,5,2,0)
XMXEDIT
"KRN",.84,37315.9,5,"B","XMJMSO",1)

"KRN",.84,37315.9,5,"B","XMXEDIT",2)

"KRN",.84,37316,-1)
0^973
"KRN",.84,37316,0)
37316^2^^MAILMAN^S:UnScramble text
"KRN",.84,37316,2,0)
^^1^1^2991208^
"KRN",.84,37316,2,1,0)
S:UnScramble text
"KRN",.84,37316,5,0)
^.841^1^1
"KRN",.84,37316,5,1,0)
XMXSEC2
"KRN",.84,37316,5,"B","XMXSEC2",1)

"KRN",.84,37316.8,-1)
0^974
"KRN",.84,37316.8,0)
37316.8^2^^MAILMAN^Scramble removed.
"KRN",.84,37316.8,2,0)
^^1^1^2991209^
"KRN",.84,37316.8,2,1,0)
Scramble removed.
"KRN",.84,37316.8,5,0)
^.841^1^1
"KRN",.84,37316.8,5,1,0)
XMJMSO
"KRN",.84,37316.8,5,"B","XMJMSO",1)

"KRN",.84,37316.9,-1)
0^975
"KRN",.84,37316.9,0)
37316.9^2^^MAILMAN^Message text unscrambled.
"KRN",.84,37316.9,2,0)
^^1^1^2991208^
"KRN",.84,37316.9,2,1,0)
Message text unscrambled.
"KRN",.84,37316.9,5,0)
^.841^2^2
"KRN",.84,37316.9,5,1,0)
XMJMSO
"KRN",.84,37316.9,5,2,0)
XMXEDIT
"KRN",.84,37316.9,5,"B","XMJMSO",1)

"KRN",.84,37316.9,5,"B","XMXEDIT",2)

"KRN",.84,37317,-1)
0^976
"KRN",.84,37317,0)
37317^2^^MAILMAN^V:Vaporize date set
"KRN",.84,37317,2,0)
^^1^1^2991208^
"KRN",.84,37317,2,1,0)
V:Vaporize date set
"KRN",.84,37317,5,0)
^.841^1^1
"KRN",.84,37317,5,1,0)
XMXSEC2
"KRN",.84,37317,5,"B","XMXSEC2",1)

"KRN",.84,37317.1,-1)
0^977
"KRN",.84,37317.1,0)
37317.1^2^^MAILMAN^Enter Vaporize Date
"KRN",.84,37317.1,2,0)
^^1^1^2991221^
"KRN",.84,37317.1,2,1,0)
Enter Vaporize Date
"KRN",.84,37317.1,5,0)
^.841^1^1
"KRN",.84,37317.1,5,1,0)
XMJMSO
"KRN",.84,37317.1,5,"B","XMJMSO",1)

"KRN",.84,37317.2,-1)
0^978
"KRN",.84,37317.2,0)
37317.2^1^^MAILMAN^Must be no earlier than tomorrow.
"KRN",.84,37317.2,2,0)
^^1^1^3001025^
"KRN",.84,37317.2,2,1,0)
Must be no earlier than tomorrow.
"KRN",.84,37317.2,5,0)
^.841^1^1
"KRN",.84,37317.2,5,1,0)
XMJMSO
"KRN",.84,37317.2,5,"B","XMJMSO",1)

"KRN",.84,37317.9,-1)
0^979
"KRN",.84,37317.9,0)
37317.9^2^^MAILMAN^Vaporize date set.
"KRN",.84,37317.9,2,0)
^^1^1^2991208^
"KRN",.84,37317.9,2,1,0)
Vaporize date set.
"KRN",.84,37317.9,5,0)
^.841^2^2
"KRN",.84,37317.9,5,1,0)
XMJMSO
"KRN",.84,37317.9,5,2,0)
XMXEDIT
"KRN",.84,37317.9,5,"B","XMJMSO",1)

"KRN",.84,37317.9,5,"B","XMXEDIT",2)

"KRN",.84,37318,-1)
0^980
"KRN",.84,37318,0)
37318^2^^MAILMAN^V:Vaporize date remove
"KRN",.84,37318,2,0)
^^1^1^2991208^
"KRN",.84,37318,2,1,0)
V:Vaporize date remove
"KRN",.84,37318,5,0)
^.841^1^1
"KRN",.84,37318,5,1,0)
XMXSEC2
"KRN",.84,37318,5,"B","XMXSEC2",1)

"KRN",.84,37318.9,-1)
0^981
"KRN",.84,37318.9,0)
37318.9^2^^MAILMAN^Vaporize date removed.
"KRN",.84,37318.9,2,0)
^^1^1^2991208^
"KRN",.84,37318.9,2,1,0)
Vaporize date removed.
"KRN",.84,37318.9,5,0)
^.841^2^2
"KRN",.84,37318.9,5,1,0)
XMJMSO
"KRN",.84,37318.9,5,2,0)
XMXEDIT
"KRN",.84,37318.9,5,"B","XMJMSO",1)

"KRN",.84,37318.9,5,"B","XMXEDIT",2)

"KRN",.84,37319,-1)
0^982
"KRN",.84,37319,0)
37319^2^^MAILMAN^X:Close (no forward allowed)
"KRN",.84,37319,2,0)
^^1^1^2991208^
"KRN",.84,37319,2,1,0)
X:Close (no forward allowed)
"KRN",.84,37319,5,0)
^.841^1^1
"KRN",.84,37319,5,1,0)
XMXSEC2
"KRN",.84,37319,5,"B","XMXSEC2",1)

"KRN",.84,37319.9,-1)
0^983
"KRN",.84,37319.9,0)
37319.9^2^^MAILMAN^Message flagged 'Closed'.
"KRN",.84,37319.9,2,0)
^^1^1^2991208^
"KRN",.84,37319.9,2,1,0)
Message flagged 'Closed'.
"KRN",.84,37319.9,5,0)
^.841^2^2
"KRN",.84,37319.9,5,1,0)
XMJMSO
"KRN",.84,37319.9,5,2,0)
XMXEDIT
"KRN",.84,37319.9,5,"B","XMJMSO",1)

"KRN",.84,37319.9,5,"B","XMXEDIT",2)

"KRN",.84,37320,-1)
0^984
"KRN",.84,37320,0)
37320^2^^MAILMAN^X:UnClose (forward allowed)
"KRN",.84,37320,2,0)
^^1^1^2991208^
"KRN",.84,37320,2,1,0)
X:UnClose (forward allowed)
"KRN",.84,37320,5,0)
^.841^1^1
"KRN",.84,37320,5,1,0)
XMXSEC2
"KRN",.84,37320,5,"B","XMXSEC2",1)

"KRN",.84,37320.6,-1)
0^985
"KRN",.84,37320.6,0)
37320.6^1^^MAILMAN^Messages addressed to SHARED,MAIL may not
"KRN",.84,37320.6,2,0)
^^1^1^2991208^^
"KRN",.84,37320.6,2,1,0)
Messages addressed to SHARED,MAIL may not be 'Closed'.
"KRN",.84,37320.6,5,0)
^.841^1^1
"KRN",.84,37320.6,5,1,0)
XMXSEC2
"KRN",.84,37320.6,5,"B","XMXSEC2",1)

"KRN",.84,37320.9,-1)
0^986
"KRN",.84,37320.9,0)
37320.9^2^^MAILMAN^'Closed' flag removed.
"KRN",.84,37320.9,2,0)
^^1^1^2991208^
"KRN",.84,37320.9,2,1,0)
'Closed' flag removed.
"KRN",.84,37320.9,5,0)
^.841^2^2
"KRN",.84,37320.9,5,1,0)
XMJMSO
"KRN",.84,37320.9,5,2,0)
XMXEDIT
"KRN",.84,37320.9,5,"B","XMJMSO",1)

"KRN",.84,37320.9,5,"B","XMXEDIT",2)

"KRN",.84,37331,-1)
0^987
"KRN",.84,37331,0)
37331^2^^MAILMAN^B:Backup to review message
"KRN",.84,37331,2,0)
^^1^1^2991208^
"KRN",.84,37331,2,1,0)
B:Backup to review message
"KRN",.84,37331,5,0)
^.841^2^2
"KRN",.84,37331,5,1,0)
XMJMOI
"KRN",.84,37331,5,2,0)
XMJMOSO
"KRN",.84,37331,5,"B","XMJMOI",1)

"KRN",.84,37331,5,"B","XMJMOSO",2)

"KRN",.84,37332,-1)
0^988
"KRN",.84,37332,0)
37332^2^^MAILMAN^ER:Edit Recipients
"KRN",.84,37332,2,0)
^^1^1^2991208^^
"KRN",.84,37332,2,1,0)
ER:Edit Recipients
"KRN",.84,37332,5,0)
^.841^1^1
"KRN",.84,37332,5,1,0)
XMJMSO
"KRN",.84,37332,5,"B","XMJMSO",1)

"KRN",.84,37333,-1)
0^989
"KRN",.84,37333,0)
37333^2^^MAILMAN^L:Transmit Later
"KRN",.84,37333,2,0)
^^1^1^2991208^^^
"KRN",.84,37333,2,1,0)
L:Transmit Later
"KRN",.84,37333,5,0)
^.841^1^1
"KRN",.84,37333,5,1,0)
XMJMSO
"KRN",.84,37333,5,"B","XMJMSO",1)

"KRN",.84,37333.1,-1)
0^990
"KRN",.84,37333.1,0)
37333.1^2^^MAILMAN^Enter Date@time at which to send this mess
"KRN",.84,37333.1,2,0)
^^1^1^2991221^
"KRN",.84,37333.1,2,1,0)
Enter Date@time at which to send this message
"KRN",.84,37333.1,5,0)
^.841^1^1
"KRN",.84,37333.1,5,1,0)
XMJMSO
"KRN",.84,37333.1,5,"B","XMJMSO",1)

"KRN",.84,37333.2,-1)
0^991
"KRN",.84,37333.2,0)
37333.2^2^^MAILMAN^  Latering ...
"KRN",.84,37333.2,2,0)
^^1^1^2991221^
"KRN",.84,37333.2,2,1,0)
  Latering ...
"KRN",.84,37333.2,5,0)
^.841^1^1
"KRN",.84,37333.2,5,1,0)
XMJMSO
"KRN",.84,37333.2,5,"B","XMJMSO",1)

"KRN",.84,37333.3,-1)
0^992
"KRN",.84,37333.3,0)
37333.3^2^^MAILMAN^Note: This message will be sent to all mem
"KRN",.84,37333.3,2,0)
^^5^5^3011031^
"KRN",.84,37333.3,2,1,0)
Note: When you send a message Later, it is sent to all members of
"KRN",.84,37333.3,2,2,0)
the groups to which you addressed it, even if you 'minus'ed anyone.
"KRN",.84,37333.3,2,3,0)
To have your 'minus'es honored, you must ^-out of this and Transmit
"KRN",.84,37333.3,2,4,0)
Now, not Later.  If you didn't 'minus' anyone from the groups, just
"KRN",.84,37333.3,2,5,0)
ignore this note, and continue ...
"KRN",.84,37333.3,5,0)
^.841^1^1
"KRN",.84,37333.3,5,1,0)
XMJMSO
"KRN",.84,37333.3,5,"B","XMJMSO",1)

"KRN",.84,37333.8,-1)
0^993
"KRN",.84,37333.8,0)
37333.8^1^^MAILMAN^Latering was not successful.
"KRN",.84,37333.8,2,0)
^^1^1^2991221^
"KRN",.84,37333.8,2,1,0)
Latering was not successful.  Try again or transmit now.
"KRN",.84,37333.8,5,0)
^.841^1^1
"KRN",.84,37333.8,5,1,0)
XMJMSO
"KRN",.84,37333.8,5,"B","XMJMSO",1)

"KRN",.84,37333.9,-1)
0^994
"KRN",.84,37333.9,0)
37333.9^2^y^MAILMAN^ Latered (Task #|1|)
"KRN",.84,37333.9,2,0)
^^1^1^2991221^
"KRN",.84,37333.9,2,1,0)
 Latered (Task #|1|)
"KRN",.84,37333.9,3,0)
^.845^1^1
"KRN",.84,37333.9,3,1,0)
1^task number
"KRN",.84,37333.9,5,0)
^.841^1^1
"KRN",.84,37333.9,5,1,0)
XMJMSO
"KRN",.84,37333.9,5,"B","XMJMSO",1)

"KRN",.84,37334,-1)
0^995
"KRN",.84,37334,0)
37334^2^^MAILMAN^T:Transmit now
"KRN",.84,37334,2,0)
^^1^1^2991208^
"KRN",.84,37334,2,1,0)
T:Transmit now
"KRN",.84,37334,5,0)
^.841^1^1
"KRN",.84,37334,5,1,0)
XMJMSO
"KRN",.84,37334,5,"B","XMJMSO",1)

"KRN",.84,37341,-1)
0^996
"KRN",.84,37341,0)
37341^2^^MAILMAN^E:Edit reply
"KRN",.84,37341,2,0)
^^1^1^2991208^
"KRN",.84,37341,2,1,0)
E:Edit reply
"KRN",.84,37341,5,0)
^.841^1^1
"KRN",.84,37341,5,1,0)
XMJMRO
"KRN",.84,37341,5,"B","XMJMRO",1)

"KRN",.84,37342,-1)
0^997
"KRN",.84,37342,0)
37342^2^^MAILMAN^I:Include previous responses in reply
"KRN",.84,37342,2,0)
^^1^1^2991208^
"KRN",.84,37342,2,1,0)
I:Include previous responses in reply
"KRN",.84,37342,5,0)
^.841^1^1
"KRN",.84,37342,5,1,0)
XMJMRO
"KRN",.84,37342,5,"B","XMJMRO",1)

"KRN",.84,37350,-1)
0^998
"KRN",.84,37350,0)
37350^2^^MAILMAN^Since you are broadcasting this message,
"KRN",.84,37350,2,0)
^^2^2^3000606^
"KRN",.84,37350,2,1,0)
Since you are broadcasting this message,
"KRN",.84,37350,2,2,0)
would you like to set a vaporize date
"KRN",.84,37350,5,0)
^.841^1^1
"KRN",.84,37350,5,1,0)
XMJMSO
"KRN",.84,37350,5,"B","XMJMSO",1)

"KRN",.84,37351,-1)
0^999
"KRN",.84,37351,0)
37351^3^^MAILMAN^If this message is about something time
"KRN",.84,37351,2,0)
^.844^6^6^3000607^^^^
"KRN",.84,37351,2,1,0)
Answer YES or NO.
"KRN",.84,37351,2,2,0)

"KRN",.84,37351,2,3,0)
If this message is about something time sensitive, like an event which
"KRN",.84,37351,2,4,0)
takes place next week, you may wish to set a vaporize date so that the
"KRN",.84,37351,2,5,0)
message will be automatically deleted when it is no longer useful, like
"KRN",.84,37351,2,6,0)
after the event is over.  Your recipients will thank you.
"KRN",.84,37351,5,0)
^.841^1^1
"KRN",.84,37351,5,1,0)
XMJMSO
"KRN",.84,37351,5,"B","XMJMSO",1)

"KRN",.84,37401,-1)
0^1000
"KRN",.84,37401,0)
37401^2^^MAILMAN^A:Answer
"KRN",.84,37401,2,0)
^^1^1^2991207^
"KRN",.84,37401,2,1,0)
A:Answer
"KRN",.84,37401,5,0)
^.841^1^1
"KRN",.84,37401,5,1,0)
XMXSEC2
"KRN",.84,37401,5,"B","XMXSEC2",1)

"KRN",.84,37401.1,-1)
0^1001
"KRN",.84,37401.1,0)
37401.1^1^^MAILMAN^You must have a Network Signature to Answe
"KRN",.84,37401.1,2,0)
^^1^1^2991207^
"KRN",.84,37401.1,2,1,0)
You must have a Network Signature to Answer a message.
"KRN",.84,37401.1,5,0)
^.841^1^1
"KRN",.84,37401.1,5,1,0)
XMXSEC2
"KRN",.84,37401.1,5,"B","XMXSEC2",1)

"KRN",.84,37401.2,-1)
0^1002
"KRN",.84,37401.2,0)
37401.2^1^^MAILMAN^You may not Answer a scrambled message.
"KRN",.84,37401.2,2,0)
^^1^1^2991207^
"KRN",.84,37401.2,2,1,0)
You may not Answer a scrambled message.  Use Reply.
"KRN",.84,37401.2,5,0)
^.841^1^1
"KRN",.84,37401.2,5,1,0)
XMXSEC2
"KRN",.84,37401.2,5,"B","XMXSEC2",1)

"KRN",.84,37401.3,-1)
0^1003
"KRN",.84,37401.3,0)
37401.3^1^^MAILMAN^|1| must have a Network Signature to Answe
"KRN",.84,37401.3,2,0)
^^1^1^2991207^
"KRN",.84,37401.3,2,1,0)
|1| must have a Network Signature to Answer a message.
"KRN",.84,37401.3,5,0)
^.841^1^1
"KRN",.84,37401.3,5,1,0)
XMXSEC2
"KRN",.84,37401.3,5,"B","XMXSEC2",1)

"KRN",.84,37401.4,-1)
0^1004
"KRN",.84,37401.4,0)
37401.4^1^^MAILMAN^You may not Answer a KIDS or PackMan mess
"KRN",.84,37401.4,2,0)
^^1^1^2991207^
"KRN",.84,37401.4,2,1,0)
You may not Answer a KIDS or PackMan message.
"KRN",.84,37401.4,5,0)
^.841^1^1
"KRN",.84,37401.4,5,1,0)
XMXSEC2
"KRN",.84,37401.4,5,"B","XMXSEC2",1)

"KRN",.84,37401.5,-1)
0^1005
"KRN",.84,37401.5,0)
37401.5^1^^MAILMAN^You need 'send' privilege to Answer a mess
"KRN",.84,37401.5,2,0)
^^1^1^2991207^
"KRN",.84,37401.5,2,1,0)
You need 'send' privilege to Answer a message.
"KRN",.84,37401.5,5,0)
^.841^1^1
"KRN",.84,37401.5,5,1,0)
XMXSEC2
"KRN",.84,37401.5,5,"B","XMXSEC2",1)

"KRN",.84,37402,-1)
0^1006
"KRN",.84,37402,0)
37402^2^^MAILMAN^AA:Access Attachments
"KRN",.84,37402,2,0)
^^1^1^2991207^^
"KRN",.84,37402,2,1,0)
AA:Access Attachments
"KRN",.84,37402,5,0)
^.841^1^1
"KRN",.84,37402,5,1,0)
XMXSEC2
"KRN",.84,37402,5,"B","XMXSEC2",1)

"KRN",.84,37402.1,-1)
0^1007
"KRN",.84,37402.1,0)
37402.1^1^^MAILMAN^This message has no attachments.
"KRN",.84,37402.1,2,0)
^^1^1^2991207^
"KRN",.84,37402.1,2,1,0)
This message has no attachments.
"KRN",.84,37402.1,5,0)
^.841^1^1
"KRN",.84,37402.1,5,1,0)
XMXSEC2
"KRN",.84,37402.1,5,"B","XMXSEC2",1)

"KRN",.84,37403,-1)
0^1008
"KRN",.84,37403,0)
37403^2^^MAILMAN^C:Copy
"KRN",.84,37403,2,0)
^^1^1^2991207^
"KRN",.84,37403,2,1,0)
C:Copy
"KRN",.84,37403,5,0)
^.841^1^1
"KRN",.84,37403,5,1,0)
XMXSEC2
"KRN",.84,37403,5,"B","XMXSEC2",1)

"KRN",.84,37403.1,-1)
0^1009
"KRN",.84,37403.1,0)
37403.1^1^^MAILMAN^Only the originator may Copy a 'closed' me
"KRN",.84,37403.1,2,0)
^^1^1^2991220^^^
"KRN",.84,37403.1,2,1,0)
Only the originator may Copy a 'closed' message.
"KRN",.84,37403.1,5,0)
^.841^1^1
"KRN",.84,37403.1,5,1,0)
XMXSEC2
"KRN",.84,37403.1,5,"B","XMXSEC2",1)

"KRN",.84,37403.2,-1)
0^1010
"KRN",.84,37403.2,0)
37403.2^1^^MAILMAN^You may not Copy a scrambled message.
"KRN",.84,37403.2,2,0)
^^1^1^2991207^
"KRN",.84,37403.2,2,1,0)
You may not Copy a scrambled message.
"KRN",.84,37403.2,5,0)
^.841^1^1
"KRN",.84,37403.2,5,1,0)
XMXSEC2
"KRN",.84,37403.2,5,"B","XMXSEC2",1)

"KRN",.84,37403.4,-1)
0^1011
"KRN",.84,37403.4,0)
37403.4^1^^MAILMAN^You may not Copy a secure KIDS or PackMan
"KRN",.84,37403.4,2,0)
^^1^1^2991207^
"KRN",.84,37403.4,2,1,0)
You may not Copy a secure KIDS or PackMan message.
"KRN",.84,37403.4,5,0)
^.841^1^1
"KRN",.84,37403.4,5,1,0)
XMXSEC2
"KRN",.84,37403.4,5,"B","XMXSEC2",1)

"KRN",.84,37403.5,-1)
0^1012
"KRN",.84,37403.5,0)
37403.5^1^^MAILMAN^You need 'send' privilege to Copy a messag
"KRN",.84,37403.5,2,0)
^^1^1^2991207^
"KRN",.84,37403.5,2,1,0)
You need 'send' privilege to Copy a message.
"KRN",.84,37403.5,5,0)
^.841^1^1
"KRN",.84,37403.5,5,1,0)
XMXSEC2
"KRN",.84,37403.5,5,"B","XMXSEC2",1)

"KRN",.84,37403.6,-1)
0^1013
"KRN",.84,37403.6,0)
37403.6^1^^MAILMAN^Only the originator may Copy a message in
"KRN",.84,37403.6,2,0)
^^1^1^2991220^
"KRN",.84,37403.6,2,1,0)
Only the originator may Copy a message in SHARED,MAIL.
"KRN",.84,37403.6,5,0)
^.841^1^1
"KRN",.84,37403.6,5,1,0)
XMXSEC3
"KRN",.84,37403.6,5,"B","XMXSEC3",1)

"KRN",.84,37404,-1)
0^1014
"KRN",.84,37404,0)
37404^2^^MAILMAN^D:Delete
"KRN",.84,37404,2,0)
^^1^1^2991207^^
"KRN",.84,37404,2,1,0)
D:Delete
"KRN",.84,37404,5,0)
^.841^1^1
"KRN",.84,37404,5,1,0)
XMXSEC2
"KRN",.84,37404,5,"B","XMXSEC2",1)

"KRN",.84,37404.1,-1)
0^1015
"KRN",.84,37404.1,0)
37404.1^1^^MAILMAN^This message has already been deleted.
"KRN",.84,37404.1,2,0)
^^1^1^2991207^
"KRN",.84,37404.1,2,1,0)
This message has already been deleted.  It's not in a basket.
"KRN",.84,37404.1,5,0)
^.841^1^1
"KRN",.84,37404.1,5,1,0)
XMXSEC2
"KRN",.84,37404.1,5,"B","XMXSEC2",1)

"KRN",.84,37404.5,-1)
0^1016
"KRN",.84,37404.5,0)
37404.5^1^^MAILMAN^You need 'send' privilege to Edit a mess
"KRN",.84,37404.5,2,0)
^^1^1^2991207^
"KRN",.84,37404.5,2,1,0)
You need 'send' privilege to Edit a message.
"KRN",.84,37404.5,5,0)
^.841^1^1
"KRN",.84,37404.5,5,1,0)
XMXSEC2
"KRN",.84,37404.5,5,"B","XMXSEC2",1)

"KRN",.84,37405,-1)
0^1017
"KRN",.84,37405,0)
37405^2^^MAILMAN^E:Edit
"KRN",.84,37405,2,0)
^^1^1^2991207^
"KRN",.84,37405,2,1,0)
E:Edit
"KRN",.84,37405,5,0)
^.841^1^1
"KRN",.84,37405,5,1,0)
XMXSEC2
"KRN",.84,37405,5,"B","XMXSEC2",1)

"KRN",.84,37405.1,-1)
0^1018
"KRN",.84,37405.1,0)
37405.1^1^^MAILMAN^Only the originator may Edit a message.
"KRN",.84,37405.1,2,0)
^^1^1^2991220^^^^
"KRN",.84,37405.1,2,1,0)
Only the originator may Edit a message.
"KRN",.84,37405.1,5,0)
^.841^1^1
"KRN",.84,37405.1,5,1,0)
XMXSEC2
"KRN",.84,37405.1,5,"B","XMXSEC2",1)

"KRN",.84,37405.2,-1)
0^1019
"KRN",.84,37405.2,0)
37405.2^1^^MAILMAN^You may not Edit a message you have alread
"KRN",.84,37405.2,2,0)
^^2^2^2991216^^
"KRN",.84,37405.2,2,1,0)
You may not Edit a message you have already sent to someone else.
"KRN",.84,37405.2,2,2,0)
You may toggle the 'information only' switch, if you wish.
"KRN",.84,37405.2,5,0)
^.841^1^1
"KRN",.84,37405.2,5,1,0)
XMXSEC2
"KRN",.84,37405.2,5,"B","XMXSEC2",1)

"KRN",.84,37405.3,-1)
0^1020
"KRN",.84,37405.3,0)
37405.3^1^^MAILMAN^You may not Edit a message which has a r
"KRN",.84,37405.3,2,0)
^^1^1^2991216^^
"KRN",.84,37405.3,2,1,0)
You may not Edit a message which has a reply.
"KRN",.84,37405.3,5,0)
^.841^1^1
"KRN",.84,37405.3,5,1,0)
XMXSEC2
"KRN",.84,37405.3,5,"B","XMXSEC2",1)

"KRN",.84,37405.4,-1)
0^1021
"KRN",.84,37405.4,0)
37405.4^1^^MAILMAN^You may not Edit a secure KIDS or PackMan
"KRN",.84,37405.4,2,0)
^^1^1^2991216^
"KRN",.84,37405.4,2,1,0)
You may not Edit a secure KIDS or PackMan message.
"KRN",.84,37405.4,5,0)
^.841^1^1
"KRN",.84,37405.4,5,1,0)
XMXSEC2
"KRN",.84,37405.4,5,"B","XMXSEC2",1)

"KRN",.84,37405.5,-1)
0^1022
"KRN",.84,37405.5,0)
37405.5^1^^MAILMAN^You need 'send' privilege to Edit a messag
"KRN",.84,37405.5,2,0)
^^1^1^3011031^
"KRN",.84,37405.5,2,1,0)
You need 'send' privilege to Edit a message.
"KRN",.84,37405.5,5,0)
^.841^1^1
"KRN",.84,37405.5,5,1,0)
XMXSEC3
"KRN",.84,37405.5,5,"B","XMXSEC3",1)

"KRN",.84,37406,-1)
0^1023
"KRN",.84,37406,0)
37406^2^^MAILMAN^F:Forward
"KRN",.84,37406,2,0)
^^1^1^2991207^
"KRN",.84,37406,2,1,0)
F:Forward
"KRN",.84,37406,5,0)
^.841^1^1
"KRN",.84,37406,5,1,0)
XMXSEC2
"KRN",.84,37406,5,"B","XMXSEC2",1)

"KRN",.84,37406.1,-1)
0^1024
"KRN",.84,37406.1,0)
37406.1^1^^MAILMAN^Only the originator may forward a 'closed'
"KRN",.84,37406.1,2,0)
^^1^1^2991207^
"KRN",.84,37406.1,2,1,0)
Only the originator may forward a 'closed' message.
"KRN",.84,37406.1,5,0)
^.841^1^1
"KRN",.84,37406.1,5,1,0)
XMXSEC2
"KRN",.84,37406.1,5,"B","XMXSEC2",1)

"KRN",.84,37406.6,-1)
0^1025
"KRN",.84,37406.6,0)
37406.6^1^^MAILMAN^Only the originator may forward a message
"KRN",.84,37406.6,2,0)
^^1^1^2991207^
"KRN",.84,37406.6,2,1,0)
Only the originator may forward a message in SHARED,MAIL.
"KRN",.84,37406.6,5,0)
^.841^1^1
"KRN",.84,37406.6,5,1,0)
XMXSEC2
"KRN",.84,37406.6,5,"B","XMXSEC2",1)

"KRN",.84,37407,-1)
0^1026
"KRN",.84,37407,0)
37407^2^^MAILMAN^H:Headerless Print
"KRN",.84,37407,2,0)
^^1^1^2991207^
"KRN",.84,37407,2,1,0)
H:Headerless Print
"KRN",.84,37407,5,0)
^.841^1^1
"KRN",.84,37407,5,1,0)
XMXSEC2
"KRN",.84,37407,5,"B","XMXSEC2",1)

"KRN",.84,37408,-1)
0^1027
"KRN",.84,37408,0)
37408^2^^MAILMAN^IN:Information only
"KRN",.84,37408,2,0)
^^1^1^2991207^
"KRN",.84,37408,2,1,0)
IN:Information only
"KRN",.84,37408,5,0)
^.841^1^1
"KRN",.84,37408,5,1,0)
XMXSEC2
"KRN",.84,37408,5,"B","XMXSEC2",1)

"KRN",.84,37408.9,-1)
0^1028
"KRN",.84,37408.9,0)
37408.9^2^^MAILMAN^Message is now 'Information only'.  No one
"KRN",.84,37408.9,2,0)
^^1^1^2991216^
"KRN",.84,37408.9,2,1,0)
Message is now 'Information only'.  No one may reply.
"KRN",.84,37408.9,5,0)
^.841^1^1
"KRN",.84,37408.9,5,1,0)
XMJMOI
"KRN",.84,37408.9,5,"B","XMJMOI",1)

"KRN",.84,37409,-1)
0^1029
"KRN",.84,37409,0)
37409^2^^MAILMAN^IN:UnInformation only
"KRN",.84,37409,2,0)
^^1^1^2991207^
"KRN",.84,37409,2,1,0)
IN:UnInformation only
"KRN",.84,37409,5,0)
^.841^1^1
"KRN",.84,37409,5,1,0)
XMXSEC2
"KRN",.84,37409,5,"B","XMXSEC2",1)

"KRN",.84,37409.1,-1)
0^1030
"KRN",.84,37409.1,0)
37409.1^1^^MAILMAN^Only the originator may toggle 'Informat
"KRN",.84,37409.1,2,0)
^^1^1^2991207^
"KRN",.84,37409.1,2,1,0)
Only the originator may toggle 'Information only'.
"KRN",.84,37409.1,5,0)
^.841^1^1
"KRN",.84,37409.1,5,1,0)
XMXSEC2
"KRN",.84,37409.1,5,"B","XMXSEC2",1)

"KRN",.84,37409.5,-1)
0^1031
"KRN",.84,37409.5,0)
37409.5^1^^MAILMAN^You need 'send' privilege to toggle 'Info
"KRN",.84,37409.5,2,0)
^^1^1^2991207^
"KRN",.84,37409.5,2,1,0)
You need 'send' privilege to toggle 'Information only'.
"KRN",.84,37409.5,5,0)
^.841^1^1
"KRN",.84,37409.5,5,1,0)
XMXSEC2
"KRN",.84,37409.5,5,"B","XMXSEC2",1)

"KRN",.84,37409.9,-1)
0^1032
"KRN",.84,37409.9,0)
37409.9^2^^MAILMAN^Message is no longer 'Information only'.
"KRN",.84,37409.9,2,0)
^^1^1^2991216^
"KRN",.84,37409.9,2,1,0)
Message is no longer 'Information only'.
"KRN",.84,37409.9,5,0)
^.841^1^1
"KRN",.84,37409.9,5,1,0)
XMJMOI
"KRN",.84,37409.9,5,"B","XMJMOI",1)

"KRN",.84,37411,-1)
0^1033
"KRN",.84,37411,0)
37411^2^^MAILMAN^K:Priority replies
"KRN",.84,37411,2,0)
^^1^1^2991207^
"KRN",.84,37411,2,1,0)
K:Priority replies
"KRN",.84,37411,5,0)
^.841^1^1
"KRN",.84,37411,5,1,0)
XMXSEC2
"KRN",.84,37411,5,"B","XMXSEC2",1)

"KRN",.84,37411.9,-1)
0^1034
"KRN",.84,37411.9,0)
37411.9^2^^MAILMAN^Responses will be delivered as Priority
"KRN",.84,37411.9,2,0)
^^1^1^2991216^
"KRN",.84,37411.9,2,1,0)
Responses will be delivered as Priority Mail.
"KRN",.84,37411.9,5,0)
^.841^1^1
"KRN",.84,37411.9,5,1,0)
XMJMOI
"KRN",.84,37411.9,5,"B","XMJMOI",1)

"KRN",.84,37412,-1)
0^1035
"KRN",.84,37412,0)
37412^2^^MAILMAN^K:UnPriority replies
"KRN",.84,37412,2,0)
^^1^1^2991207^
"KRN",.84,37412,2,1,0)
K:UnPriority replies
"KRN",.84,37412,5,0)
^.841^1^1
"KRN",.84,37412,5,1,0)
XMXSEC2
"KRN",.84,37412,5,"B","XMXSEC2",1)

"KRN",.84,37412.1,-1)
0^1036
"KRN",.84,37412.1,0)
37412.1^1^^MAILMAN^The message must be 'priority' in order to
"KRN",.84,37412.1,2,0)
^^1^1^2991207^
"KRN",.84,37412.1,2,1,0)
The message must be 'priority' in order to toggle 'Priority replies'.
"KRN",.84,37412.1,5,0)
^.841^1^1
"KRN",.84,37412.1,5,1,0)
XMXSEC2
"KRN",.84,37412.1,5,"B","XMXSEC2",1)

"KRN",.84,37412.9,-1)
0^1037
"KRN",.84,37412.9,0)
37412.9^2^^MAILMAN^Responses will not be delivered as Pri
"KRN",.84,37412.9,2,0)
^^1^1^2991216^
"KRN",.84,37412.9,2,1,0)
Responses will not be delivered as Priority Mail.
"KRN",.84,37412.9,5,0)
^.841^1^1
"KRN",.84,37412.9,5,1,0)
XMJMOI
"KRN",.84,37412.9,5,"B","XMJMOI",1)

"KRN",.84,37413,-1)
0^1038
"KRN",.84,37413,0)
37413^2^^MAILMAN^L:Later
"KRN",.84,37413,2,0)
^^1^1^2991207^
"KRN",.84,37413,2,1,0)
L:Later
"KRN",.84,37413,5,0)
^.841^1^1
"KRN",.84,37413,5,1,0)
XMXSEC2
"KRN",.84,37413,5,"B","XMXSEC2",1)

"KRN",.84,37414,-1)
0^1039
"KRN",.84,37414,0)
37414^2^^MAILMAN^N:New
"KRN",.84,37414,2,0)
^^1^1^2991207^
"KRN",.84,37414,2,1,0)
N:New
"KRN",.84,37414,5,0)
^.841^1^1
"KRN",.84,37414,5,1,0)
XMXSEC2
"KRN",.84,37414,5,"B","XMXSEC2",1)

"KRN",.84,37414.9,-1)
0^1040
"KRN",.84,37414.9,0)
37414.9^2^^MAILMAN^Message will be new next time.
"KRN",.84,37414.9,2,0)
^^1^1^2991216^
"KRN",.84,37414.9,2,1,0)
Message will be new next time.
"KRN",.84,37414.9,5,0)
^.841^1^1
"KRN",.84,37414.9,5,1,0)
XMJMOI
"KRN",.84,37414.9,5,"B","XMJMOI",1)

"KRN",.84,37415,-1)
0^1041
"KRN",.84,37415,0)
37415^2^^MAILMAN^N:UnNew
"KRN",.84,37415,2,0)
^^1^1^2991207^
"KRN",.84,37415,2,1,0)
N:UnNew
"KRN",.84,37415,5,0)
^.841^1^1
"KRN",.84,37415,5,1,0)
XMXSEC2
"KRN",.84,37415,5,"B","XMXSEC2",1)

"KRN",.84,37415.9,-1)
0^1042
"KRN",.84,37415.9,0)
37415.9^2^^MAILMAN^Message will NOT be new next time.
"KRN",.84,37415.9,2,0)
^^1^1^2991216^
"KRN",.84,37415.9,2,1,0)
Message will NOT be new next time.
"KRN",.84,37415.9,5,0)
^.841^1^1
"KRN",.84,37415.9,5,1,0)
XMJMOI
"KRN",.84,37415.9,5,"B","XMJMOI",1)

"KRN",.84,37416,-1)
0^1043
"KRN",.84,37416,0)
37416^2^^MAILMAN^P:Print
"KRN",.84,37416,2,0)
^^1^1^2991207^
"KRN",.84,37416,2,1,0)
P:Print
"KRN",.84,37416,5,0)
^.841^1^1
"KRN",.84,37416,5,1,0)
XMXSEC2
"KRN",.84,37416,5,"B","XMXSEC2",1)

"KRN",.84,37416.4,-1)
0^1044
"KRN",.84,37416.4,0)
37416.4^1^^MAILMAN^You may not Print a secure KIDS or PackMan
"KRN",.84,37416.4,2,0)
^^1^1^2991207^
"KRN",.84,37416.4,2,1,0)
You may not Print a secure KIDS or PackMan message.
"KRN",.84,37416.4,5,0)
^.841^2^2
"KRN",.84,37416.4,5,1,0)
XMXSEC2
"KRN",.84,37416.4,5,2,0)
XMJMP
"KRN",.84,37416.4,5,"B","XMJMP",2)

"KRN",.84,37416.4,5,"B","XMXSEC2",1)

"KRN",.84,37417,-1)
0^1045
"KRN",.84,37417,0)
37417^2^^MAILMAN^Q:Query
"KRN",.84,37417,2,0)
^^1^1^2991207^
"KRN",.84,37417,2,1,0)
Q:Query
"KRN",.84,37417,5,0)
^.841^1^1
"KRN",.84,37417,5,1,0)
XMXSEC2
"KRN",.84,37417,5,"B","XMXSEC2",1)

"KRN",.84,37418,-1)
0^1046
"KRN",.84,37418,0)
37418^1^^MAILMAN^QD:Query Detailed
"KRN",.84,37418,2,0)
^^1^1^2991207^
"KRN",.84,37418,2,1,0)
QD:Query Detailed
"KRN",.84,37418,5,0)
^.841^1^1
"KRN",.84,37418,5,1,0)
XMXSEC2
"KRN",.84,37418,5,"B","XMXSEC2",1)

"KRN",.84,37419,-1)
0^1047
"KRN",.84,37419,0)
37419^2^^MAILMAN^QN:Query Network
"KRN",.84,37419,2,0)
^^1^1^2991207^
"KRN",.84,37419,2,1,0)
QN:Query Network
"KRN",.84,37419,5,0)
^.841^1^1
"KRN",.84,37419,5,1,0)
XMXSEC2
"KRN",.84,37419,5,"B","XMXSEC2",1)

"KRN",.84,37420,-1)
0^1048
"KRN",.84,37420,0)
37420^2^^MAILMAN^QR:Query Recipients
"KRN",.84,37420,2,0)
^^1^1^2991207^
"KRN",.84,37420,2,1,0)
QR:Query Recipients
"KRN",.84,37420,5,0)
^.841^1^1
"KRN",.84,37420,5,1,0)
XMXSEC2
"KRN",.84,37420,5,"B","XMXSEC2",1)

"KRN",.84,37420.1,-1)
0^1049
"KRN",.84,37420.1,0)
37420.1^2^^MAILMAN^Q xxx:Query recipient(s) xxx
"KRN",.84,37420.1,2,0)
^^1^1^2991207^
"KRN",.84,37420.1,2,1,0)
Q xxx:Query recipient(s) xxx
"KRN",.84,37420.1,5,0)
^.841^1^1
"KRN",.84,37420.1,5,1,0)
XMJMOI
"KRN",.84,37420.1,5,"B","XMJMOI",1)

"KRN",.84,37422,-1)
0^1050
"KRN",.84,37422,0)
37422^2^^MAILMAN^R:Reply
"KRN",.84,37422,2,0)
^^1^1^2991207^
"KRN",.84,37422,2,1,0)
R:Reply
"KRN",.84,37422,5,0)
^.841^1^1
"KRN",.84,37422,5,1,0)
XMXSEC2
"KRN",.84,37422,5,"B","XMXSEC2",1)

"KRN",.84,37422.1,-1)
0^1051
"KRN",.84,37422.1,0)
37422.1^1^^MAILMAN^Only the originator may reply to an 'Info
"KRN",.84,37422.1,2,0)
^^1^1^2991207^
"KRN",.84,37422.1,2,1,0)
Only the originator may reply to an 'Information only' message.
"KRN",.84,37422.1,5,0)
^.841^1^1
"KRN",.84,37422.1,5,1,0)
XMXSEC2
"KRN",.84,37422.1,5,"B","XMXSEC2",1)

"KRN",.84,37422.2,-1)
0^1052
"KRN",.84,37422.2,0)
37422.2^1^^MAILMAN^'Information only' recipients may not repl
"KRN",.84,37422.2,2,0)
^^1^1^2991220^^
"KRN",.84,37422.2,2,1,0)
'Information only' recipients may not reply to a message.
"KRN",.84,37422.2,5,0)
^.841^1^1
"KRN",.84,37422.2,5,1,0)
XMXSEC2
"KRN",.84,37422.2,5,"B","XMXSEC2",1)

"KRN",.84,37422.3,-1)
0^1053
"KRN",.84,37422.3,0)
37422.3^1^^MAILMAN^You may not Reply to a Broadcast message
"KRN",.84,37422.3,2,0)
^.844^2^2^3010730^^
"KRN",.84,37422.3,2,1,0)
You may not Reply to a Broadcast message sent to all local users.
"KRN",.84,37422.3,2,2,0)
Send a new Broadcast, instead.
"KRN",.84,37422.3,5,0)
^.841^1^1
"KRN",.84,37422.3,5,1,0)
XMXSEC2
"KRN",.84,37422.3,5,"B","XMXSEC2",1)

"KRN",.84,37422.4,-1)
0^1054
"KRN",.84,37422.4,0)
37422.4^1^^MAILMAN^You may not Reply to a secure KIDS or Pack
"KRN",.84,37422.4,2,0)
^^1^1^2991207^
"KRN",.84,37422.4,2,1,0)
You may not Reply to a secure KIDS or PackMan message.
"KRN",.84,37422.4,5,0)
^.841^1^1
"KRN",.84,37422.4,5,1,0)
XMXSEC2
"KRN",.84,37422.4,5,"B","XMXSEC2",1)

"KRN",.84,37422.5,-1)
0^1055
"KRN",.84,37422.5,0)
37422.5^1^^MAILMAN^You may not Reply to a message from a remo
"KRN",.84,37422.5,2,0)
^^1^1^2991220^
"KRN",.84,37422.5,2,1,0)
You may not Reply to a message from a remote Postmaster.
"KRN",.84,37422.5,5,0)
^.841^1^1
"KRN",.84,37422.5,5,1,0)
XMXSEC
"KRN",.84,37422.5,5,"B","XMXSEC",1)

"KRN",.84,37422.6,-1)
0^1056
"KRN",.84,37422.6,0)
37422.6^1^^MAILMAN^SHARED,MAIL may not Reply to a message.
"KRN",.84,37422.6,2,0)
^^1^1^2991207^
"KRN",.84,37422.6,2,1,0)
SHARED,MAIL may not Reply to a message.
"KRN",.84,37422.6,5,0)
^.841^1^1
"KRN",.84,37422.6,5,1,0)
XMXSEC2
"KRN",.84,37422.6,5,"B","XMXSEC2",1)

"KRN",.84,37423,-1)
0^1057
"KRN",.84,37423,0)
37423^2^^MAILMAN^S:Save
"KRN",.84,37423,2,0)
^^1^1^2991207^
"KRN",.84,37423,2,1,0)
S:Save
"KRN",.84,37423,5,0)
^.841^1^1
"KRN",.84,37423,5,1,0)
XMXSEC2
"KRN",.84,37423,5,"B","XMXSEC2",1)

"KRN",.84,37424,-1)
0^1058
"KRN",.84,37424,0)
37424^2^^MAILMAN^T:Terminate
"KRN",.84,37424,2,0)
^^1^1^2991207^
"KRN",.84,37424,2,1,0)
T:Terminate
"KRN",.84,37424,5,0)
^.841^1^1
"KRN",.84,37424,5,1,0)
XMXSEC2
"KRN",.84,37424,5,"B","XMXSEC2",1)

"KRN",.84,37425,-1)
0^1059
"KRN",.84,37425,0)
37425^2^^MAILMAN^V:Vaporize date edit
"KRN",.84,37425,2,0)
^^1^1^2991207^
"KRN",.84,37425,2,1,0)
V:Vaporize date edit
"KRN",.84,37425,5,0)
^.841^1^1
"KRN",.84,37425,5,1,0)
XMXSEC2
"KRN",.84,37425,5,"B","XMXSEC2",1)

"KRN",.84,37425.1,-1)
0^1060
"KRN",.84,37425.1,0)
37425.1^1^^MAILMAN^This message has already been vaporized.
"KRN",.84,37425.1,2,0)
^^1^1^2991207^
"KRN",.84,37425.1,2,1,0)
This message has already been vaporized.  It's not in a basket.
"KRN",.84,37425.1,5,0)
^.841^1^1
"KRN",.84,37425.1,5,1,0)
XMXSEC2
"KRN",.84,37425.1,5,"B","XMXSEC2",1)

"KRN",.84,37426,-1)
0^1061
"KRN",.84,37426,0)
37426^2^^MAILMAN^X:Xtract
"KRN",.84,37426,2,0)
^^1^1^2991207^
"KRN",.84,37426,2,1,0)
X:Xtract
"KRN",.84,37426,5,0)
^.841^1^1
"KRN",.84,37426,5,1,0)
XMXSEC2
"KRN",.84,37426,5,"B","XMXSEC2",1)

"KRN",.84,37427,-1)
0^1062
"KRN",.84,37427,0)
37427^2^^MAILMAN^X:Xtract KIDS
"KRN",.84,37427,2,0)
^^1^1^2991207^
"KRN",.84,37427,2,1,0)
X:Xtract KIDS
"KRN",.84,37427,5,0)
^.841^1^1
"KRN",.84,37427,5,1,0)
XMXSEC2
"KRN",.84,37427,5,"B","XMXSEC2",1)

"KRN",.84,37428,-1)
0^1063
"KRN",.84,37428,0)
37428^2^^MAILMAN^X:Xtract PackMan
"KRN",.84,37428,2,0)
^^1^1^2991207^
"KRN",.84,37428,2,1,0)
X:Xtract PackMan
"KRN",.84,37428,5,0)
^.841^1^1
"KRN",.84,37428,5,1,0)
XMXSEC2
"KRN",.84,37428,5,"B","XMXSEC2",1)

"KRN",.84,37428.1,-1)
0^1064
"KRN",.84,37428.1,0)
37428.1^1^^MAILMAN^This message is neither KIDS nor Packman.
"KRN",.84,37428.1,2,0)
^^1^1^2991207^
"KRN",.84,37428.1,2,1,0)
This message is neither KIDS nor Packman.
"KRN",.84,37428.1,5,0)
^.841^1^1
"KRN",.84,37428.1,5,1,0)
XMXSEC2
"KRN",.84,37428.1,5,"B","XMXSEC2",1)

"KRN",.84,37428.2,-1)
0^1065
"KRN",.84,37428.2,0)
37428.2^1^^MAILMAN^You must hold the XUPROGMODE key to extr
"KRN",.84,37428.2,2,0)
^^1^1^2991207^
"KRN",.84,37428.2,2,1,0)
You must hold the XUPROGMODE key to extract KIDS or PackMan messages.
"KRN",.84,37428.2,5,0)
^.841^1^1
"KRN",.84,37428.2,5,1,0)
XMXSEC2
"KRN",.84,37428.2,5,"B","XMXSEC2",1)

"KRN",.84,37429,-1)
0^1066
"KRN",.84,37429,0)
37429^2^^MAILMAN^HU:Help:User Information
"KRN",.84,37429,2,0)
^^1^1^3000503^
"KRN",.84,37429,2,1,0)
HU:Help:User Information
"KRN",.84,37429,5,0)
^.841^1^1
"KRN",.84,37429,5,1,0)
XMXSEC2
"KRN",.84,37429,5,"B","XMXSEC2",1)

"KRN",.84,37430,-1)
0^1067
"KRN",.84,37430,0)
37430^2^^MAILMAN^HG:Help:Group Information
"KRN",.84,37430,2,0)
^^1^1^3000503^
"KRN",.84,37430,2,1,0)
HG:Help:Group Information
"KRN",.84,37430,5,0)
^.841^1^1
"KRN",.84,37430,5,1,0)
XMXSEC2
"KRN",.84,37430,5,"B","XMXSEC2",1)

"KRN",.84,37431,-1)
0^1068
"KRN",.84,37431,0)
37431^2^^MAILMAN^QC:Query Current
"KRN",.84,37431,2,0)
^.844^1^1^3010305^^
"KRN",.84,37431,2,1,0)
QC:Query Current
"KRN",.84,37431,5,0)
^.841^2^2
"KRN",.84,37431,5,1,0)
XMJMOI1
"KRN",.84,37431,5,2,0)
XMJMRO
"KRN",.84,37431,5,"B","XMJMOI1",1)

"KRN",.84,37431,5,"B","XMJMRO",2)

"KRN",.84,37431.9,-1)
0^1069
"KRN",.84,37431.9,0)
37431.9^2^y^MAILMAN^Local recipients who are current:
"KRN",.84,37431.9,2,0)
^.844^1^1^3010306^^
"KRN",.84,37431.9,2,1,0)
Local recipients who are current: |1| of |2|
"KRN",.84,37431.9,3,0)
^.845^2^2
"KRN",.84,37431.9,3,1,0)
1^number who are current
"KRN",.84,37431.9,3,2,0)
2^total number
"KRN",.84,37431.9,5,0)
^.841^1^1
"KRN",.84,37431.9,5,1,0)
XMJMQ
"KRN",.84,37431.9,5,"B","XMJMQ",1)

"KRN",.84,37432,-1)
0^1070
"KRN",.84,37432,0)
37432^2^^MAILMAN^QNC:Query Not Current
"KRN",.84,37432,2,0)
^^1^1^3010305^
"KRN",.84,37432,2,1,0)
QNC:Query Not Current
"KRN",.84,37432,5,0)
^.841^2^2
"KRN",.84,37432,5,1,0)
XMJMOI1
"KRN",.84,37432,5,2,0)
XMJMRO
"KRN",.84,37432,5,"B","XMJMOI1",1)

"KRN",.84,37432,5,"B","XMJMRO",2)

"KRN",.84,37432.9,-1)
0^1071
"KRN",.84,37432.9,0)
37432.9^2^y^MAILMAN^Local recipients who are not current:
"KRN",.84,37432.9,2,0)
^.844^1^1^3010306^^
"KRN",.84,37432.9,2,1,0)
Local recipients who are not current: |1| of |2|
"KRN",.84,37432.9,3,0)
^.845^2^2
"KRN",.84,37432.9,3,1,0)
1^number who aren't current
"KRN",.84,37432.9,3,2,0)
2^total number
"KRN",.84,37432.9,5,0)
^.841^1^1
"KRN",.84,37432.9,5,1,0)
XMJMQ
"KRN",.84,37432.9,5,"B","XMJMQ",1)

"KRN",.84,37433,-1)
0^1072
"KRN",.84,37433,0)
37433^2^^MAILMAN^QT:Query Terminated
"KRN",.84,37433,2,0)
^^1^1^3010305^
"KRN",.84,37433,2,1,0)
QT:Query Terminated
"KRN",.84,37433,5,0)
^.841^2^2
"KRN",.84,37433,5,1,0)
XMJMOI1
"KRN",.84,37433,5,2,0)
XMJMRO
"KRN",.84,37433,5,"B","XMJMOI1",1)

"KRN",.84,37433,5,"B","XMJMRO",2)

"KRN",.84,37433.9,-1)
0^1073
"KRN",.84,37433.9,0)
37433.9^2^y^MAILMAN^Local recipients who have terminated:
"KRN",.84,37433.9,2,0)
^.844^1^1^3010306^^
"KRN",.84,37433.9,2,1,0)
Local recipients who have terminated: |1| of |2|
"KRN",.84,37433.9,3,0)
^.845^2^2
"KRN",.84,37433.9,3,1,0)
1^number who terminated
"KRN",.84,37433.9,3,2,0)
2^total number
"KRN",.84,37433.9,5,0)
^.841^1^1
"KRN",.84,37433.9,5,1,0)
XMJMQ
"KRN",.84,37433.9,5,"B","XMJMQ",1)

"KRN",.84,37441,-1)
0^1074
"KRN",.84,37441,0)
37441^2^^MAILMAN^B:Backup
"KRN",.84,37441,2,0)
^^1^1^2991207^
"KRN",.84,37441,2,1,0)
B:Backup
"KRN",.84,37441,5,0)
^.841^1^1
"KRN",.84,37441,5,1,0)
XMXSEC2
"KRN",.84,37441,5,"B","XMXSEC2",1)

"KRN",.84,37442,-1)
0^1075
"KRN",.84,37442,0)
37442^2^^MAILMAN^I:Ignore
"KRN",.84,37442,2,0)
^^1^1^2991207^
"KRN",.84,37442,2,1,0)
I:Ignore
"KRN",.84,37442,5,0)
^.841^1^1
"KRN",.84,37442,5,1,0)
XMXSEC2
"KRN",.84,37442,5,"B","XMXSEC2",1)

"KRN",.84,37443,-1)
0^1076
"KRN",.84,37443,0)
37443^2^^MAILMAN^RI:Reply and Include responses
"KRN",.84,37443,2,0)
^^1^1^2991207^
"KRN",.84,37443,2,1,0)
RI:Reply and Include responses
"KRN",.84,37443,5,0)
^.841^1^1
"KRN",.84,37443,5,1,0)
XMJMOI
"KRN",.84,37443,5,"B","XMJMOI",1)

"KRN",.84,37444,-1)
0^1077
"KRN",.84,37444,0)
37444^2^^MAILMAN^W:Write
"KRN",.84,37444,2,0)
^^1^1^2991207^
"KRN",.84,37444,2,1,0)
W:Write
"KRN",.84,37444,5,0)
^.841^1^1
"KRN",.84,37444,5,1,0)
XMXSEC2
"KRN",.84,37444,5,"B","XMXSEC2",1)

"KRN",.84,37444.5,-1)
0^1078
"KRN",.84,37444.5,0)
37444.5^1^^MAILMAN^You need 'send' privilege to Write (send)
"KRN",.84,37444.5,2,0)
^^1^1^2991207^
"KRN",.84,37444.5,2,1,0)
You need 'send' privilege to Write (send) a message.
"KRN",.84,37444.5,5,0)
^.841^1^1
"KRN",.84,37444.5,5,1,0)
XMXSEC2
"KRN",.84,37444.5,5,"B","XMXSEC2",1)

"KRN",.84,37445,-1)
0^1079
"KRN",.84,37445,0)
37445^2^^MAILMAN^IM:Include responses from another message
"KRN",.84,37445,2,0)
^.844^1^1^3000510^^^
"KRN",.84,37445,2,1,0)
IM:Include responses from another Message
"KRN",.84,37445,5,0)
^.841^2^2
"KRN",.84,37445,5,1,0)
XMJMSO
"KRN",.84,37445,5,2,0)
XMJMOIE
"KRN",.84,37445,5,"B","XMJMOIE",2)

"KRN",.84,37445,5,"B","XMJMSO",1)

"KRN",.84,37445.4,-1)
0^1080
"KRN",.84,37445.4,0)
37445.4^2^^MAILMAN^You may not Include anything into a KIDS
"KRN",.84,37445.4,2,0)
^.844^1^1^3000511^
"KRN",.84,37445.4,2,1,0)
You may not Include anything into a KIDS or PackMan message.
"KRN",.84,37445.4,5,0)
^.841^2^2
"KRN",.84,37445.4,5,1,0)
XMJMOIE
"KRN",.84,37445.4,5,2,0)
XMJMSO
"KRN",.84,37445.4,5,"B","XMJMOIE",1)

"KRN",.84,37445.4,5,"B","XMJMSO",2)

"KRN",.84,37446,-1)
0^1081
"KRN",.84,37446,0)
37446^2^^MAILMAN^BR:Print to the Browser
"KRN",.84,37446,2,0)
^.844^1^1^3000524^^^
"KRN",.84,37446,2,1,0)
BR:Print to the Browser
"KRN",.84,37446,5,0)
^.841^1^1
"KRN",.84,37446,5,1,0)
XMJMOI
"KRN",.84,37446,5,"B","XMJMOI",1)

"KRN",.84,37446.9,-1)
0^1082
"KRN",.84,37446.9,0)
37446.9^1^^MAILMAN^The BROWSER device is not selectable from
"KRN",.84,37446.9,2,0)
^^1^1^3000525^
"KRN",.84,37446.9,2,1,0)
The BROWSER device is not selectable from this terminal.
"KRN",.84,37446.9,5,0)
^.841^1^1
"KRN",.84,37446.9,5,1,0)
XMJMOI1
"KRN",.84,37446.9,5,"B","XMJMOI1",1)

"KRN",.84,37447,-1)
0^7
"KRN",.84,37447,0)
37447^2^^MAILMAN^X:Xmit priority toggle
"KRN",.84,37447,2,0)
^^1^1^3020311^
"KRN",.84,37447,2,1,0)
X:Xmit priority toggle
"KRN",.84,37447,5,0)
^.841^1^1
"KRN",.84,37447,5,1,0)
XMXSEC3
"KRN",.84,37447,5,"B","XMXSEC3",1)

"KRN",.84,37451,-1)
0^1083
"KRN",.84,37451,0)
37451^1^^MAILMAN^'Confidential' messages are off-limits to
"KRN",.84,37451,1,0)
^^2^2^2991220^^
"KRN",.84,37451,1,1,0)
Surrogates may not read or do anything with or to 'confidential'
"KRN",.84,37451,1,2,0)
messages, except save them to other baskets or new toggle or later them.
"KRN",.84,37451,2,0)
^^1^1^2991220^^
"KRN",.84,37451,2,1,0)
'Confidential' messages are off-limits to surrogates.
"KRN",.84,37451,5,0)
^.841^1^1
"KRN",.84,37451,5,1,0)
XMXSEC
"KRN",.84,37451,5,"B","XMXSEC",1)

"KRN",.84,37452,-1)
0^1084
"KRN",.84,37452,0)
37452^1^y^MAILMAN^Surrogates may not |1| 'confidential' mess
"KRN",.84,37452,2,0)
^^1^1^2991220^^
"KRN",.84,37452,2,1,0)
Surrogates may not |1| 'confidential' messages.
"KRN",.84,37452,3,0)
^.845^1^1
"KRN",.84,37452,3,1,0)
1^type of access attempted
"KRN",.84,37452,5,0)
^.841^1^1
"KRN",.84,37452,5,1,0)
XMXSEC
"KRN",.84,37452,5,"B","XMXSEC",1)

"KRN",.84,37453,-1)
0^1085
"KRN",.84,37453,0)
37453^1^^MAILMAN^This session is concurrent with another.
"KRN",.84,37453,2,0)
^^1^1^2991207^
"KRN",.84,37453,2,1,0)
This session is concurrent with another.  You may not do this.
"KRN",.84,37453,5,0)
^.841^2^2
"KRN",.84,37453,5,1,0)
XMJMOI
"KRN",.84,37453,5,2,0)
XMJMS
"KRN",.84,37453,5,"B","XMJMOI",1)

"KRN",.84,37453,5,"B","XMJMS",2)

"KRN",.84,37455,-1)
0^1086
"KRN",.84,37455,0)
37455^1^y^MAILMAN^You do not have 'read' privilege for |1|.
"KRN",.84,37455,2,0)
^^1^1^2991220^
"KRN",.84,37455,2,1,0)
You do not have 'read' privilege for |1|.
"KRN",.84,37455,3,0)
^.845^1^1
"KRN",.84,37455,3,1,0)
1^surrogate name
"KRN",.84,37455,5,0)
^.841^1^1
"KRN",.84,37455,5,1,0)
XMXSEC
"KRN",.84,37455,5,"B","XMXSEC",1)

"KRN",.84,37456,-1)
0^1087
"KRN",.84,37456,0)
37456^1^y^MAILMAN^You do not have 'send' privilege for |1|.
"KRN",.84,37456,2,0)
^^1^1^2991220^^
"KRN",.84,37456,2,1,0)
You do not have 'send' privilege for |1|.
"KRN",.84,37456,3,0)
^.845^1^1
"KRN",.84,37456,3,1,0)
1^surrogate name
"KRN",.84,37456,5,0)
^.841^1^1
"KRN",.84,37456,5,1,0)
XMXSEC
"KRN",.84,37456,5,"B","XMXSEC",1)

"KRN",.84,37457,-1)
0^1088
"KRN",.84,37457,0)
37457^1^y^MAILMAN^You do not have 'read' or 'send' privilege
"KRN",.84,37457,2,0)
^^1^1^2991220^^
"KRN",.84,37457,2,1,0)
You do not have 'read' or 'send' privilege for |1|.
"KRN",.84,37457,3,0)
^.845^1^1
"KRN",.84,37457,3,1,0)
1^surrogate name
"KRN",.84,37457,5,0)
^.841^1^1
"KRN",.84,37457,5,1,0)
XMXSEC
"KRN",.84,37457,5,"B","XMXSEC",1)

"KRN",.84,37458,-1)
0^1089
"KRN",.84,37458,0)
37458^1^^MAILMAN^Only a POSTMASTER surrogate or XMMGR key
"KRN",.84,37458,2,0)
^^1^1^2991220^
"KRN",.84,37458,2,1,0)
Only a POSTMASTER surrogate or XMMGR key holder may do this.
"KRN",.84,37458,5,0)
^.841^1^1
"KRN",.84,37458,5,1,0)
XMXSEC
"KRN",.84,37458,5,"B","XMXSEC",1)

"KRN",.84,37461,-1)
0^1090
"KRN",.84,37461,0)
37461^1^^MAILMAN^You must be the message originator, hold
"KRN",.84,37461,2,0)
^^2^2^2991207^
"KRN",.84,37461,2,1,0)
You must be the message originator, hold the XMMGR key,
"KRN",.84,37461,2,2,0)
or be a POSTMASTER surrogate to do this in SHARED,MAIL.
"KRN",.84,37461,5,0)
^.841^1^1
"KRN",.84,37461,5,1,0)
XMXSEC2
"KRN",.84,37461,5,"B","XMXSEC2",1)

"KRN",.84,37462,-1)
0^1091
"KRN",.84,37462,0)
37462^1^^MAILMAN^You may not do this in SHARED,MAIL.
"KRN",.84,37462,2,0)
^^1^1^2991207^
"KRN",.84,37462,2,1,0)
You may not do this in SHARED,MAIL.
"KRN",.84,37462,5,0)
^.841^2^2
"KRN",.84,37462,5,1,0)
XMXSEC1
"KRN",.84,37462,5,2,0)
XMXSEC2
"KRN",.84,37462,5,"B","XMXSEC1",1)

"KRN",.84,37462,5,"B","XMXSEC2",2)

"KRN",.84,37470,-1)
0^1092
"KRN",.84,37470,0)
37470^1^y^MAILMAN^You may not copy more than the site limit
"KRN",.84,37470,2,0)
^.844^1^1^3020408^^
"KRN",.84,37470,2,1,0)
You may not copy more than the site limit of |1| lines.
"KRN",.84,37470,3,0)
^.845^1^1
"KRN",.84,37470,3,1,0)
1^max number of lines
"KRN",.84,37470,5,0)
^.841^1^1
"KRN",.84,37470,5,1,0)
XMXSEC1
"KRN",.84,37470,5,"B","XMXSEC1",1)

"KRN",.84,37471,-1)
0^1093
"KRN",.84,37471,0)
37471^1^y^MAILMAN^You may not copy more than the site limit
"KRN",.84,37471,2,0)
^^1^1^2991221^
"KRN",.84,37471,2,1,0)
You may not copy more than the site limit of |1| responses.
"KRN",.84,37471,3,0)
^.845^1^1
"KRN",.84,37471,3,1,0)
1^max number of responses
"KRN",.84,37471,5,0)
^.841^1^1
"KRN",.84,37471,5,1,0)
XMXSEC1
"KRN",.84,37471,5,"B","XMXSEC1",1)

"KRN",.84,37472,-1)
0^1094
"KRN",.84,37472,0)
37472^1^y^MAILMAN^Because this message has more than the si
"KRN",.84,37472,2,0)
^^3^3^2991221^^
"KRN",.84,37472,2,1,0)
Because this message has more than the site limit of |1| recipients,
"KRN",.84,37472,2,2,0)
we will neither list them in the text of the copy,
"KRN",.84,37472,2,3,0)
nor will we deliver the copy to them.
"KRN",.84,37472,3,0)
^.845^1^1
"KRN",.84,37472,3,1,0)
1^max number of recipients
"KRN",.84,37472,5,0)
^.841^1^1
"KRN",.84,37472,5,1,0)
XMXSEC1
"KRN",.84,37472,5,"B","XMXSEC1",1)

"KRN",.84,38001,-1)
0^1095
"KRN",.84,38001,0)
38001^1^^MAILMAN^You can't have a message forwarded to a
"KRN",.84,38001,1,0)
^^3^3^2991029^
"KRN",.84,38001,1,1,0)
A user's forwarding address can't be to another local user.
"KRN",.84,38001,1,2,0)
If you want another user to read your mail, make that user
"KRN",.84,38001,1,3,0)
your surrogate.
"KRN",.84,38001,2,0)
^^1^1^2991029^
"KRN",.84,38001,2,1,0)
You can't have a message forwarded to a local user.
"KRN",.84,38001,5,0)
^.841^1^1
"KRN",.84,38001,5,1,0)
XMXADDR
"KRN",.84,38001,5,"B","XMXADDR",1)

"KRN",.84,38002,-1)
0^1096
"KRN",.84,38002,0)
38002^2^^MAILMAN^Never
"KRN",.84,38002,2,0)
^^1^1^2991029^
"KRN",.84,38002,2,1,0)
Never
"KRN",.84,38002,5,0)
^.841^2^2
"KRN",.84,38002,5,1,0)
XMXADDR1
"KRN",.84,38002,5,2,0)
XMVVITAE
"KRN",.84,38002,5,"B","XMVVITAE",2)

"KRN",.84,38002,5,"B","XMXADDR1",1)

"KRN",.84,38003,-1)
0^1097
"KRN",.84,38003,0)
38003^2^^MAILMAN^ Last used MailMan:
"KRN",.84,38003,2,0)
^^1^1^2991029^
"KRN",.84,38003,2,1,0)
 Last used MailMan: 
"KRN",.84,38003,5,0)
^.841^1^1
"KRN",.84,38003,5,1,0)
XMXADDR1
"KRN",.84,38003,5,"B","XMXADDR1",1)

"KRN",.84,38004,-1)
0^1098
"KRN",.84,38004,0)
38004^2^^MAILMAN^Forwarding Address:
"KRN",.84,38004,2,0)
^^1^1^2991029^
"KRN",.84,38004,2,1,0)
Forwarding Address: 
"KRN",.84,38004,5,0)
^.841^1^1
"KRN",.84,38004,5,1,0)
XMXADDR1
"KRN",.84,38004,5,"B","XMXADDR1",1)

"KRN",.84,38005,-1)
0^1099
"KRN",.84,38005,0)
38005^2^^MAILMAN^, Local Delivery is ON
"KRN",.84,38005,2,0)
^^1^1^2991029^
"KRN",.84,38005,2,1,0)
, Local Delivery is ON
"KRN",.84,38005,5,0)
^.841^1^1
"KRN",.84,38005,5,1,0)
XMXADDR1
"KRN",.84,38005,5,"B","XMXADDR1",1)

"KRN",.84,38006,-1)
0^1100
"KRN",.84,38006,0)
38006^2^^MAILMAN^, Local Delivery is OFF
"KRN",.84,38006,2,0)
^^1^1^2991029^
"KRN",.84,38006,2,1,0)
, Local Delivery is OFF
"KRN",.84,38006,5,0)
^.841^1^1
"KRN",.84,38006,5,1,0)
XMXADDR1
"KRN",.84,38006,5,"B","XMXADDR1",1)

"KRN",.84,38007,-1)
0^1101
"KRN",.84,38007,0)
38007^2^^MAILMAN^Never used MailMan
"KRN",.84,38007,2,0)
^^1^1^2991101^
"KRN",.84,38007,2,1,0)
Never Used MailMan
"KRN",.84,38007,5,0)
^.841^1^1
"KRN",.84,38007,5,1,0)
XMHIG
"KRN",.84,38007,5,"B","XMHIG",1)

"KRN",.84,38008,-1)
0^1102
"KRN",.84,38008,0)
38008^2^y^MAILMAN^ (Surrogate: |1|)
"KRN",.84,38008,2,0)
^^1^1^2991101^
"KRN",.84,38008,2,1,0)
 (Surrogate: |1|)
"KRN",.84,38008,3,0)
^.845^1^1
"KRN",.84,38008,3,1,0)
1^surrogate name
"KRN",.84,38008,5,0)
^.841^3^3
"KRN",.84,38008,5,1,0)
XMXUTIL
"KRN",.84,38008,5,2,0)
XMVVITAE
"KRN",.84,38008,5,3,0)
XMKP
"KRN",.84,38008,5,"B","XMKP",3)

"KRN",.84,38008,5,"B","XMVVITAE",2)

"KRN",.84,38008,5,"B","XMXUTIL",1)

"KRN",.84,38009,-1)
0^1103
"KRN",.84,38009,0)
38009^2^^MAILMAN^User name:
"KRN",.84,38009,2,0)
^^1^1^2991102^
"KRN",.84,38009,2,1,0)
User name: 
"KRN",.84,38009,5,0)
^.841^1^1
"KRN",.84,38009,5,1,0)
XMHIU
"KRN",.84,38009,5,"B","XMHIU",1)

"KRN",.84,38010,-1)
0^1104
"KRN",.84,38010,0)
38010^2^^MAILMAN^No Mailbox for this user!
"KRN",.84,38010,2,0)
^^1^1^2991102^
"KRN",.84,38010,2,1,0)
No Mailbox for this user.
"KRN",.84,38010,5,0)
^.841^1^1
"KRN",.84,38010,5,1,0)
XMHIU
"KRN",.84,38010,5,"B","XMHIU",1)

"KRN",.84,38011,-1)
0^1105
"KRN",.84,38011,0)
38011^2^^MAILMAN^Current Banner:
"KRN",.84,38011,2,0)
^^1^1^2991102^
"KRN",.84,38011,2,1,0)
Current Banner: 
"KRN",.84,38011,5,0)
^.841^1^1
"KRN",.84,38011,5,1,0)
XMHIU
"KRN",.84,38011,5,"B","XMHIU",1)

"KRN",.84,38012,-1)
0^1106
"KRN",.84,38012,0)
38012^2^^MAILMAN^Last used MailMan:
"KRN",.84,38012,2,0)
^^1^1^2991102^
"KRN",.84,38012,2,1,0)
Last used MailMan: 
"KRN",.84,38012,5,0)
^.841^1^1
"KRN",.84,38012,5,1,0)
XMHIU
"KRN",.84,38012,5,"B","XMHIU",1)

"KRN",.84,38013,-1)
0^1107
"KRN",.84,38013,0)
38013^2^^MAILMAN^Office phone:
"KRN",.84,38013,2,0)
^^1^1^2991102^
"KRN",.84,38013,2,1,0)
Office phone:  
"KRN",.84,38013,5,0)
^.841^1^1
"KRN",.84,38013,5,1,0)
XMHIU
"KRN",.84,38013,5,"B","XMHIU",1)

"KRN",.84,38014,-1)
0^1108
"KRN",.84,38014,0)
38014^2^^MAILMAN^Fax:
"KRN",.84,38014,2,0)
^^1^1^2991102^
"KRN",.84,38014,2,1,0)
Fax:           
"KRN",.84,38014,5,0)
^.841^1^1
"KRN",.84,38014,5,1,0)
XMHIU
"KRN",.84,38014,5,"B","XMHIU",1)

"KRN",.84,38015,-1)
0^1109
"KRN",.84,38015,0)
38015^2^^MAILMAN^Voice pager:
"KRN",.84,38015,2,0)
^^1^1^2991102^
"KRN",.84,38015,2,1,0)
Voice pager:   
"KRN",.84,38015,5,0)
^.841^1^1
"KRN",.84,38015,5,1,0)
XMHIU
"KRN",.84,38015,5,"B","XMHIU",1)

"KRN",.84,38016,-1)
0^1110
"KRN",.84,38016,0)
38016^2^^MAILMAN^Digital pager:
"KRN",.84,38016,2,0)
^^1^1^2991102^
"KRN",.84,38016,2,1,0)
Digital pager: 
"KRN",.84,38016,5,0)
^.841^1^1
"KRN",.84,38016,5,1,0)
XMHIU
"KRN",.84,38016,5,"B","XMHIU",1)

"KRN",.84,38017,-1)
0^1111
"KRN",.84,38017,0)
38017^2^^MAILMAN^Add'l phone:
"KRN",.84,38017,2,0)
^^1^1^2991102^
"KRN",.84,38017,2,1,0)
Add'l phone:   
"KRN",.84,38017,5,0)
^.841^1^1
"KRN",.84,38017,5,1,0)
XMHIU
"KRN",.84,38017,5,"B","XMHIU",1)

"KRN",.84,38018,-1)
0^1112
"KRN",.84,38018,0)
38018^2^^MAILMAN^Address:
"KRN",.84,38018,2,0)
^^1^1^2991102^
"KRN",.84,38018,2,1,0)
Address: 
"KRN",.84,38018,5,0)
^.841^1^1
"KRN",.84,38018,5,1,0)
XMHIU
"KRN",.84,38018,5,"B","XMHIU",1)

"KRN",.84,38019,-1)
0^1113
"KRN",.84,38019,0)
38019^2^y^MAILMAN^NEW messages: |1| (|2| in the IN basket)
"KRN",.84,38019,2,0)
^^1^1^2991102^^
"KRN",.84,38019,2,1,0)
NEW messages: |1| (|2| in the IN basket)
"KRN",.84,38019,3,0)
^.845^2^2
"KRN",.84,38019,3,1,0)
1^number of new messages
"KRN",.84,38019,3,2,0)
2^number of new messages in IN bskt
"KRN",.84,38019,5,0)
^.841^1^1
"KRN",.84,38019,5,1,0)
XMHIU
"KRN",.84,38019,5,"B","XMHIU",1)

"KRN",.84,38020,-1)
0^1114
"KRN",.84,38020,0)
38020^2^^MAILMAN^Member
"KRN",.84,38020,2,0)
^^1^1^2991101^
"KRN",.84,38020,2,1,0)
Member
"KRN",.84,38020,5,0)
^.841^1^1
"KRN",.84,38020,5,1,0)
XMVGROUP
"KRN",.84,38020,5,"B","XMVGROUP",1)

"KRN",.84,38021,-1)
0^1115
"KRN",.84,38021,0)
38021^2^^MAILMAN^...Self Enrollment Not Allowed.
"KRN",.84,38021,2,0)
^^1^1^2991101^
"KRN",.84,38021,2,1,0)
...Self Enrollment Not Allowed.
"KRN",.84,38021,5,0)
^.841^1^1
"KRN",.84,38021,5,1,0)
XMVGROUP
"KRN",.84,38021,5,"B","XMVGROUP",1)

"KRN",.84,38022,-1)
0^1116
"KRN",.84,38022,0)
38022^1^^MAILMAN^Self enrollment is not allowed
"KRN",.84,38022,2,0)
^.844^1^1^3000727^^^
"KRN",.84,38022,2,1,0)
Self enrollment is not allowed for this mail group.
"KRN",.84,38022,5,0)
^.841^1^1
"KRN",.84,38022,5,1,0)
XMVGROUP
"KRN",.84,38022,5,"B","XMVGROUP",1)

"KRN",.84,38022.1,-1)
0^1117
"KRN",.84,38022.1,0)
38022.1^1^^MAILMAN^Self disenrollment is not allowed
"KRN",.84,38022.1,2,0)
^.844^1^1^3000727^^
"KRN",.84,38022.1,2,1,0)
Self disenrollment is not allowed for this mail group.
"KRN",.84,38022.1,5,0)
^.841^1^1
"KRN",.84,38022.1,5,1,0)
XMVGROUP
"KRN",.84,38022.1,5,"B","XMVGROUP",1)

"KRN",.84,38023,-1)
0^1118
"KRN",.84,38023,0)
38023^2^^MAILMAN^You are now a member.
"KRN",.84,38023,2,0)
^^1^1^2991101^
"KRN",.84,38023,2,1,0)
You are now a member.
"KRN",.84,38023,5,0)
^.841^1^1
"KRN",.84,38023,5,1,0)
XMVGROUP
"KRN",.84,38023,5,"B","XMVGROUP",1)

"KRN",.84,38023.1,-1)
0^1119
"KRN",.84,38023.1,0)
38023.1^2^^MAILMAN^Do you want past messages to this group
"KRN",.84,38023.1,2,0)
^^1^1^3010108^
"KRN",.84,38023.1,2,1,0)
Do you want past messages to this group to be forwarded to you
"KRN",.84,38023.1,5,0)
^.841^1^1
"KRN",.84,38023.1,5,1,0)
XMVGROUP
"KRN",.84,38023.1,5,"B","XMVGROUP",1)

"KRN",.84,38023.5,-1)
0^1120
"KRN",.84,38023.5,0)
38023.5^2^y^MAILMAN^You will now choose a date range for
"KRN",.84,38023.5,2,0)
^.844^2^2^3010112^^
"KRN",.84,38023.5,2,1,0)
You will now choose a date range for the messages to be searched
"KRN",.84,38023.5,2,2,0)
and forwarded.  The oldest message is from |1|.
"KRN",.84,38023.5,3,0)
^.845^1^1
"KRN",.84,38023.5,3,1,0)
1^date of oldest message
"KRN",.84,38023.5,5,0)
^.841^1^1
"KRN",.84,38023.5,5,1,0)
XMVGROUP
"KRN",.84,38023.5,5,"B","XMVGROUP",1)

"KRN",.84,38023.8,-1)
0^1121
"KRN",.84,38023.8,0)
38023.8^2^^MAILMAN^MailMan: Find & Forward mail group mess
"KRN",.84,38023.8,2,0)
^.844^1^1^3010108^^
"KRN",.84,38023.8,2,1,0)
MailMan: Find & Forward mail group messages
"KRN",.84,38023.8,5,0)
^.841^1^1
"KRN",.84,38023.8,5,1,0)
XMXGRP
"KRN",.84,38023.8,5,"B","XMXGRP",1)

"KRN",.84,38023.9,-1)
0^1122
"KRN",.84,38023.9,0)
38023.9^2^y^MAILMAN^Task #|1| will find and forward past
"KRN",.84,38023.9,2,0)
^^1^1^3010108^
"KRN",.84,38023.9,2,1,0)
Task #|1| will find and forward past messages.
"KRN",.84,38023.9,3,0)
^.845^1^1
"KRN",.84,38023.9,3,1,0)
1^task number
"KRN",.84,38023.9,5,0)
^.841^1^1
"KRN",.84,38023.9,5,1,0)
XMVGROUP
"KRN",.84,38023.9,5,"B","XMVGROUP",1)

"KRN",.84,38024,-1)
0^1123
"KRN",.84,38024,0)
38024^2^^MAILMAN^You are a member.  Do you want to drop out
"KRN",.84,38024,2,0)
^^1^1^2991124^^
"KRN",.84,38024,2,1,0)
You are a member.  Do you want to drop out
"KRN",.84,38024,5,0)
^.841^1^1
"KRN",.84,38024,5,1,0)
XMVGROUP
"KRN",.84,38024,5,"B","XMVGROUP",1)

"KRN",.84,38024.1,-1)
0^1124
"KRN",.84,38024.1,0)
38024.1^2^^MAILMAN^Self enrollment is not allowed for this
"KRN",.84,38024.1,2,0)
^^5^5^3000606^
"KRN",.84,38024.1,2,1,0)
You are a member.  Self enrollment is not allowed for this mail group.
"KRN",.84,38024.1,2,2,0)
If you drop out, you will not be able to re-join.  (To re-join later,
"KRN",.84,38024.1,2,3,0)
you will have to ask the group coordinator to re-enroll you.)
"KRN",.84,38024.1,2,4,0)
 
"KRN",.84,38024.1,2,5,0)
You are a member.  Do you want to drop out
"KRN",.84,38024.1,5,0)
^.841^1^1
"KRN",.84,38024.1,5,1,0)
XMVGROUP
"KRN",.84,38024.1,5,"B","XMVGROUP",1)

"KRN",.84,38025,-1)
0^1125
"KRN",.84,38025,0)
38025^3^^MAILMAN^Enter YES to remove yourself from the
"KRN",.84,38025,2,0)
^^1^1^2991101^
"KRN",.84,38025,2,1,0)
Enter YES to remove yourself from the group; NO to remain a member.
"KRN",.84,38025,5,0)
^.841^1^1
"KRN",.84,38025,5,1,0)
XMVGROUP
"KRN",.84,38025,5,"B","XMVGROUP",1)

"KRN",.84,38026,-1)
0^1126
"KRN",.84,38026,0)
38026^2^^MAILMAN^You are no longer a member.
"KRN",.84,38026,2,0)
^^1^1^2991101^
"KRN",.84,38026,2,1,0)
You are no longer a member.
"KRN",.84,38026,5,0)
^.841^1^1
"KRN",.84,38026,5,1,0)
XMVGROUP
"KRN",.84,38026,5,"B","XMVGROUP",1)

"KRN",.84,38027,-1)
0^1127
"KRN",.84,38027,0)
38027^1^y^MAILMAN^Can't add it because public group '|1|'
"KRN",.84,38027,2,0)
^^1^1^2991101^
"KRN",.84,38027,2,1,0)
Can't add it because public group '|1|' already exists.
"KRN",.84,38027,3,0)
^.845^1^1
"KRN",.84,38027,3,1,0)
1^name of public group
"KRN",.84,38027,5,0)
^.841^1^1
"KRN",.84,38027,5,1,0)
XMVGROUP
"KRN",.84,38027,5,"B","XMVGROUP",1)

"KRN",.84,38028,-1)
0^1128
"KRN",.84,38028,0)
38028^1^^MAILMAN^It can't be a local address, except for
"KRN",.84,38028,2,0)
^^1^1^2991101^
"KRN",.84,38028,2,1,0)
It can't be a local address, except for Device or Server.
"KRN",.84,38028,5,0)
^.841^1^1
"KRN",.84,38028,5,1,0)
XMVGROUP
"KRN",.84,38028,5,"B","XMVGROUP",1)

"KRN",.84,38029,-1)
0^1129
"KRN",.84,38029,0)
38029^3^^MAILMAN^Put the group in the MEMBER GROUP mul
"KRN",.84,38029,2,0)
^^1^1^2991101^
"KRN",.84,38029,2,1,0)
Put the group in the MEMBER GROUP multiple.
"KRN",.84,38029,5,0)
^.841^1^1
"KRN",.84,38029,5,1,0)
XMVGROUP
"KRN",.84,38029,5,"B","XMVGROUP",1)

"KRN",.84,38030,-1)
0^1130
"KRN",.84,38030,0)
38030^3^^MAILMAN^Put the person in the MEMBER multiple.
"KRN",.84,38030,2,0)
^^1^1^2991101^
"KRN",.84,38030,2,1,0)
Put the person in the MEMBER multiple.
"KRN",.84,38030,5,0)
^.841^1^1
"KRN",.84,38030,5,1,0)
XMVGROUP
"KRN",.84,38030,5,"B","XMVGROUP",1)

"KRN",.84,38031,-1)
0^1131
"KRN",.84,38031,0)
38031^3^y^MAILMAN^Put '|1|' in the TYPE field.
"KRN",.84,38031,2,0)
^^1^1^2991101^
"KRN",.84,38031,2,1,0)
Put '|1|' in the TYPE field.
"KRN",.84,38031,3,0)
^.845^1^1
"KRN",.84,38031,3,1,0)
1^member type
"KRN",.84,38031,5,0)
^.841^1^1
"KRN",.84,38031,5,1,0)
XMVGROUP
"KRN",.84,38031,5,"B","XMVGROUP",1)

"KRN",.84,38040,-1)
0^1132
"KRN",.84,38040,0)
38040^2^^MAILMAN^Mail Groups:
"KRN",.84,38040,2,0)
^^1^1^2991102^
"KRN",.84,38040,2,1,0)
Mail Groups: 
"KRN",.84,38040,5,0)
^.841^1^1
"KRN",.84,38040,5,1,0)
XMHIU
"KRN",.84,38040,5,"B","XMHIU",1)

"KRN",.84,38041,-1)
0^1133
"KRN",.84,38041,0)
38041^2^^MAILMAN^ (Organizer)
"KRN",.84,38041,2,0)
^^1^1^2991102^
"KRN",.84,38041,2,1,0)
 (Organizer) 
"KRN",.84,38041,5,0)
^.841^1^1
"KRN",.84,38041,5,1,0)
XMHIU
"KRN",.84,38041,5,"B","XMHIU",1)

"KRN",.84,38042,-1)
0^1134
"KRN",.84,38042,0)
38042^2^^MAILMAN^ (Private)
"KRN",.84,38042,2,0)
^^1^1^2991102^
"KRN",.84,38042,2,1,0)
 (Private)
"KRN",.84,38042,5,0)
^.841^1^1
"KRN",.84,38042,5,1,0)
XMHIU
"KRN",.84,38042,5,"B","XMHIU",1)

"KRN",.84,38043,-1)
0^1135
"KRN",.84,38043,0)
38043^2^^MAILMAN^ (Public)
"KRN",.84,38043,2,0)
^^1^1^2991102^
"KRN",.84,38043,2,1,0)
 (Public)
"KRN",.84,38043,5,0)
^.841^1^1
"KRN",.84,38043,5,1,0)
XMHIU
"KRN",.84,38043,5,"B","XMHIU",1)

"KRN",.84,38044,-1)
0^1136
"KRN",.84,38044,0)
38044^2^^MAILMAN^This user's surrogates are:
"KRN",.84,38044,2,0)
^^1^1^2991102^
"KRN",.84,38044,2,1,0)
This user's surrogates are:
"KRN",.84,38044,5,0)
^.841^1^1
"KRN",.84,38044,5,1,0)
XMHIU
"KRN",.84,38044,5,"B","XMHIU",1)

"KRN",.84,38045,-1)
0^1137
"KRN",.84,38045,0)
38045^2^^MAILMAN^This user may act as a surrogate for:
"KRN",.84,38045,2,0)
^^1^1^2991102^
"KRN",.84,38045,2,1,0)
This user may act as a surrogate for:
"KRN",.84,38045,5,0)
^.841^1^1
"KRN",.84,38045,5,1,0)
XMHIU
"KRN",.84,38045,5,"B","XMHIU",1)

"KRN",.84,38046,-1)
0^1138
"KRN",.84,38046,0)
38046^2^^MAILMAN^No Privileges
"KRN",.84,38046,2,0)
^^1^1^2991102^
"KRN",.84,38046,2,1,0)
No Privileges
"KRN",.84,38046,5,0)
^.841^2^2
"KRN",.84,38046,5,1,0)
XMHIU
"KRN",.84,38046,5,2,0)
XMVSURR
"KRN",.84,38046,5,"B","XMHIU",1)

"KRN",.84,38046,5,"B","XMVSURR",2)

"KRN",.84,38047,-1)
0^1139
"KRN",.84,38047,0)
38047^2^^MAILMAN^Read and Send Privileges
"KRN",.84,38047,2,0)
^^1^1^3000103^^
"KRN",.84,38047,2,1,0)
Read and Send Privileges
"KRN",.84,38047,5,0)
^.841^2^2
"KRN",.84,38047,5,1,0)
XMHIU
"KRN",.84,38047,5,2,0)
XMVSURR
"KRN",.84,38047,5,"B","XMHIU",1)

"KRN",.84,38047,5,"B","XMVSURR",2)

"KRN",.84,38048,-1)
0^1140
"KRN",.84,38048,0)
38048^2^^MAILMAN^Read Privilege
"KRN",.84,38048,2,0)
^^1^1^2991102^
"KRN",.84,38048,2,1,0)
Read Privilege
"KRN",.84,38048,5,0)
^.841^2^2
"KRN",.84,38048,5,1,0)
XMHIU
"KRN",.84,38048,5,2,0)
XMVSURR
"KRN",.84,38048,5,"B","XMHIU",1)

"KRN",.84,38048,5,"B","XMVSURR",2)

"KRN",.84,38049,-1)
0^1141
"KRN",.84,38049,0)
38049^2^^MAILMAN^Send Privilege
"KRN",.84,38049,2,0)
^^1^1^3000103^^
"KRN",.84,38049,2,1,0)
Send Privilege
"KRN",.84,38049,5,0)
^.841^2^2
"KRN",.84,38049,5,1,0)
XMHIU
"KRN",.84,38049,5,2,0)
XMVSURR
"KRN",.84,38049,5,"B","XMHIU",1)

"KRN",.84,38049,5,"B","XMVSURR",2)

"KRN",.84,38050,-1)
0^1142
"KRN",.84,38050,0)
38050^2^^MAILMAN^Introduction:
"KRN",.84,38050,2,0)
^^1^1^2991102^
"KRN",.84,38050,2,1,0)
Introduction:
"KRN",.84,38050,5,0)
^.841^1^1
"KRN",.84,38050,5,1,0)
XMHIU
"KRN",.84,38050,5,"B","XMHIU",1)

"KRN",.84,38051,-1)
0^1143
"KRN",.84,38051,0)
38051^2^^MAILMAN^No New Msgs
"KRN",.84,38051,2,0)
^^1^1^2991123^
"KRN",.84,38051,2,1,0)
No New Msgs
"KRN",.84,38051,5,0)
^.841^1^1
"KRN",.84,38051,5,1,0)
XMVSURR
"KRN",.84,38051,5,"B","XMVSURR",1)

"KRN",.84,38052,-1)
0^1144
"KRN",.84,38052,0)
38052^2^y^MAILMAN^|1| New Msgs
"KRN",.84,38052,2,0)
^^1^1^2991123^^
"KRN",.84,38052,2,1,0)
|1| New Msgs
"KRN",.84,38052,3,0)
^.845^1^1
"KRN",.84,38052,3,1,0)
1^number of new messages for this user
"KRN",.84,38052,5,0)
^.841^1^1
"KRN",.84,38052,5,1,0)
XMVSURR
"KRN",.84,38052,5,"B","XMVSURR",1)

"KRN",.84,38053,-1)
0^1145
"KRN",.84,38053,0)
38053^1^^MAILMAN^You have been given the XMNOPRIV key
"KRN",.84,38053,2,0)
^^1^1^2991123^
"KRN",.84,38053,2,1,0)
You have been given the XMNOPRIV key and may not become anyone's surrogate.
"KRN",.84,38053,5,0)
^.841^2^2
"KRN",.84,38053,5,1,0)
XMVSURR
"KRN",.84,38053,5,2,0)
XMXPARM
"KRN",.84,38053,5,"B","XMVSURR",1)

"KRN",.84,38053,5,"B","XMXPARM",2)

"KRN",.84,38054,-1)
0^1146
"KRN",.84,38054,0)
38054^2^^MAILMAN^You are now yourself again.
"KRN",.84,38054,2,0)
^^1^1^2991123^
"KRN",.84,38054,2,1,0)
You are now yourself again.
"KRN",.84,38054,5,0)
^.841^1^1
"KRN",.84,38054,5,1,0)
XMVSURR
"KRN",.84,38054,5,"B","XMVSURR",1)

"KRN",.84,38055,-1)
0^1147
"KRN",.84,38055,0)
38055^2^^MAILMAN^You may select yourself to resume your
"KRN",.84,38055,2,0)
^^1^1^2991123^
"KRN",.84,38055,2,1,0)
You may select yourself to resume your own identity.
"KRN",.84,38055,5,0)
^.841^1^1
"KRN",.84,38055,5,1,0)
XMVSURR
"KRN",.84,38055,5,"B","XMVSURR",1)

"KRN",.84,38056,-1)
0^1148
"KRN",.84,38056,0)
38056^2^^MAILMAN^Choose from:
"KRN",.84,38056,2,0)
^^1^1^2991123^
"KRN",.84,38056,2,1,0)
Choose from:
"KRN",.84,38056,5,0)
^.841^2^2
"KRN",.84,38056,5,1,0)
XMVSURR
"KRN",.84,38056,5,2,0)
XMXADDR2
"KRN",.84,38056,5,"B","XMVSURR",1)

"KRN",.84,38056,5,"B","XMXADDR2",2)

"KRN",.84,38100,-1)
0^1149
"KRN",.84,38100,0)
38100^3^y^MAILMAN^Domain not christened correctly
"KRN",.84,38100,2,0)
^.844^11^11^3010124^^^^
"KRN",.84,38100,2,1,0)
The domain for this facility is not christened correctly.
"KRN",.84,38100,2,2,0)
IRM must correct this for network mail to function properly.
"KRN",.84,38100,2,3,0)

"KRN",.84,38100,2,4,0)
The following pointers should contain the same numbers,
"KRN",.84,38100,2,5,0)
which should point to this facility's domain in ^DIC(4.2:
"KRN",.84,38100,2,6,0)
^XMB("NUM")=|1|          ==> |3|
"KRN",.84,38100,2,7,0)
$P(^XMB(1,1,0),U,1)=|2|  ==> |4|
"KRN",.84,38100,2,8,0)

"KRN",.84,38100,2,9,0)
The following globals should contain the domain name of this facility:
"KRN",.84,38100,2,10,0)
^XMB("NETNAME")=           |5|
"KRN",.84,38100,2,11,0)
^XMB("NAME")=              |6|
"KRN",.84,38100,3,0)
^.845^6^6
"KRN",.84,38100,3,1,0)
1^what's in the global XMB("NUM")
"KRN",.84,38100,3,2,0)
2^what's in the .01 field of the record in file 4.3
"KRN",.84,38100,3,3,0)
3^domain pointed to by global XMB("NUM")
"KRN",.84,38100,3,4,0)
4^domain pointed to by .01 field of record in file 4.3
"KRN",.84,38100,3,5,0)
5^what's in global XMB("NETNAME")
"KRN",.84,38100,3,6,0)
6^what's in global XMB("NAME")
"KRN",.84,38100,5,0)
^.841^1^1
"KRN",.84,38100,5,1,0)
XMVVITAE
"KRN",.84,38100,5,"B","XMVVITAE",1)

"KRN",.84,38105,-1)
0^1150
"KRN",.84,38105,0)
38105^1^^MAILMAN^You do not have a DUZ.
"KRN",.84,38105,2,0)
^^1^1^2991110^
"KRN",.84,38105,2,1,0)
You do not have a DUZ.
"KRN",.84,38105,5,0)
^.841^1^1
"KRN",.84,38105,5,1,0)
XMVVITAE
"KRN",.84,38105,5,"B","XMVVITAE",1)

"KRN",.84,38106,-1)
0^1151
"KRN",.84,38106,0)
38106^1^y^MAILMAN^You are not a surrogate of DUZ |1|.
"KRN",.84,38106,2,0)
^^1^1^2991110^^^
"KRN",.84,38106,2,1,0)
You are not a surrogate of DUZ |1|.
"KRN",.84,38106,3,0)
^.845^1^1
"KRN",.84,38106,3,1,0)
1^xmduz
"KRN",.84,38106,5,0)
^.841^1^1
"KRN",.84,38106,5,1,0)
XMVVITAE
"KRN",.84,38106,5,"B","XMVVITAE",1)

"KRN",.84,38107,-1)
0^1152
"KRN",.84,38107,0)
38107^1^y^MAILMAN^There is no person with DUZ |1|.
"KRN",.84,38107,2,0)
^^1^1^2991110^
"KRN",.84,38107,2,1,0)
There is no person with DUZ |1|.
"KRN",.84,38107,3,0)
^.845^1^1
"KRN",.84,38107,3,1,0)
1^xmduz
"KRN",.84,38107,5,0)
^.841^1^1
"KRN",.84,38107,5,1,0)
XMVVITAE
"KRN",.84,38107,5,"B","XMVVITAE",1)

"KRN",.84,38109,-1)
0^1153
"KRN",.84,38109,0)
38109^1^y^MAILMAN^There is no mailbox for DUZ |1|.
"KRN",.84,38109,2,0)
^^1^1^2991110^
"KRN",.84,38109,2,1,0)
There is no mailbox for DUZ |1|.
"KRN",.84,38109,3,0)
^.845^1^1
"KRN",.84,38109,3,1,0)
1^xmduz
"KRN",.84,38109,5,0)
^.841^1^1
"KRN",.84,38109,5,1,0)
XMVVITAE
"KRN",.84,38109,5,"B","XMVVITAE",1)

"KRN",.84,38110,-1)
0^1154
"KRN",.84,38110,0)
38110^2^^MAILMAN^Multiple Signon
"KRN",.84,38110,2,0)
^^1^1^2991110^
"KRN",.84,38110,2,1,0)
Multiple Signon
"KRN",.84,38110,5,0)
^.841^1^1
"KRN",.84,38110,5,1,0)
XMVVITAE
"KRN",.84,38110,5,"B","XMVVITAE",1)

"KRN",.84,38110.1,-1)
0^1155
"KRN",.84,38110.1,0)
38110.1^2^^MAILMAN^It appears someone is signed on as you
"KRN",.84,38110.1,2,0)
^.844^1^1^3010824^^
"KRN",.84,38110.1,2,1,0)
It appears someone is signed on as you already.
"KRN",.84,38110.1,5,0)
^.841^1^1
"KRN",.84,38110.1,5,1,0)
XM
"KRN",.84,38110.1,5,"B","XM",1)

"KRN",.84,38110.2,-1)
0^1156
"KRN",.84,38110.2,0)
38110.2^2^y^MAILMAN^It appears someone is signed on as |1|
"KRN",.84,38110.2,2,0)
^^1^1^3010824^
"KRN",.84,38110.2,2,1,0)
It appears someone is signed on as |1| already.
"KRN",.84,38110.2,3,0)
^.845^1^1
"KRN",.84,38110.2,3,1,0)
1^user name
"KRN",.84,38110.2,5,0)
^.841^1^1
"KRN",.84,38110.2,5,1,0)
XM
"KRN",.84,38110.2,5,"B","XM",1)

"KRN",.84,38110.3,-1)
0^1157
"KRN",.84,38110.3,0)
38110.3^2^^MAILMAN^You may not send mail or respond to mail
"KRN",.84,38110.3,2,0)
^^2^2^3010824^
"KRN",.84,38110.3,2,1,0)
You may not send mail or respond to mail in this session.
"KRN",.84,38110.3,2,2,0)
(Only the 1st of multiple MailMan sessions may send or respond to mail.)
"KRN",.84,38110.3,5,0)
^.841^1^1
"KRN",.84,38110.3,5,1,0)
XM
"KRN",.84,38110.3,5,"B","XM",1)

"KRN",.84,38111,-1)
0^1158
"KRN",.84,38111,0)
38111^2^^MAILMAN^Priority Mail
"KRN",.84,38111,2,0)
^^1^1^2991110^
"KRN",.84,38111,2,1,0)
Priority Mail
"KRN",.84,38111,5,0)
^.841^1^1
"KRN",.84,38111,5,1,0)
XMVVITAE
"KRN",.84,38111,5,"B","XMVVITAE",1)

"KRN",.84,38112,-1)
0^1159
"KRN",.84,38112,0)
38112^2^^MAILMAN^Message in Buffer
"KRN",.84,38112,2,0)
^^1^1^2991110^
"KRN",.84,38112,2,1,0)
Message in Buffer
"KRN",.84,38112,5,0)
^.841^1^1
"KRN",.84,38112,5,1,0)
XMVVITAE
"KRN",.84,38112,5,"B","XMVVITAE",1)

"KRN",.84,38113,-1)
0^1160
"KRN",.84,38113,0)
38113^2^y^MAILMAN^POSTMASTER has |1| baskets.
"KRN",.84,38113,2,0)
^^1^1^2991110^
"KRN",.84,38113,2,1,0)
POSTMASTER has |1| baskets.
"KRN",.84,38113,3,0)
^.845^1^1
"KRN",.84,38113,3,1,0)
1^number of baskets
"KRN",.84,38113,5,0)
^.841^1^1
"KRN",.84,38113,5,1,0)
XMVVITAE
"KRN",.84,38113,5,"B","XMVVITAE",1)

"KRN",.84,38113.1,-1)
0^1161
"KRN",.84,38113.1,0)
38113.1^1^^MAILMAN^Postmaster may not have more than 999 bask
"KRN",.84,38113.1,2,0)
^^3^3^3000203^
"KRN",.84,38113.1,2,1,0)
Postmaster may not have more than 999 baskets.
"KRN",.84,38113.1,2,2,0)
Baskets numbered above 999 are reserved for network transmission
"KRN",.84,38113.1,2,3,0)
queues and for server queues.
"KRN",.84,38113.1,5,0)
^.841^1^1
"KRN",.84,38113.1,5,1,0)
XMXBSKT
"KRN",.84,38113.1,5,"B","XMXBSKT",1)

"KRN",.84,38114,-1)
0^1162
"KRN",.84,38114,0)
38114^2^^MAILMAN^No Introduction
"KRN",.84,38114,2,0)
^^1^1^2991110^
"KRN",.84,38114,2,1,0)
No Introduction
"KRN",.84,38114,5,0)
^.841^1^1
"KRN",.84,38114,5,1,0)
XMVVITAE
"KRN",.84,38114,5,"B","XMVVITAE",1)

"KRN",.84,38114.1,-1)
0^1163
"KRN",.84,38114.1,0)
38114.1^2^^MAILMAN^You have not yet introduced yourself
"KRN",.84,38114.1,2,0)
^^6^6^3000714^
"KRN",.84,38114.1,2,1,0)
You have not yet introduced yourself to the group.
"KRN",.84,38114.1,2,2,0)
Please enter a short introduction, so that others may use
"KRN",.84,38114.1,2,3,0)
the HELP option to find out more about you.
"KRN",.84,38114.1,2,4,0)

"KRN",.84,38114.1,2,5,0)
You may change your INTRODUCTION later
"KRN",.84,38114.1,2,6,0)
under 'Personal Preferences|User Options Edit'.
"KRN",.84,38114.1,5,0)
^.841^1^1
"KRN",.84,38114.1,5,1,0)
XM
"KRN",.84,38114.1,5,"B","XM",1)

"KRN",.84,38130,-1)
0^1164
"KRN",.84,38130,0)
38130^1^^MAILMAN^You can't have your mail forwarded to a
"KRN",.84,38130,2,0)
^^1^1^3000727^
"KRN",.84,38130,2,1,0)
You can't have your mail forwarded to a local address.
"KRN",.84,38130,5,0)
^.841^1^1
"KRN",.84,38130,5,1,0)
XMVVITA
"KRN",.84,38130,5,"B","XMVVITA",1)

"KRN",.84,38131,-1)
0^1165
"KRN",.84,38131,0)
38131^2^^MAILMAN^Note that you have no active filters.
"KRN",.84,38131,2,0)
^^1^1^3000727^
"KRN",.84,38131,2,1,0)
Note that you have no active filters.
"KRN",.84,38131,5,0)
^.841^1^1
"KRN",.84,38131,5,1,0)
XMVVITA
"KRN",.84,38131,5,"B","XMVVITA",1)

"KRN",.84,38132,-1)
0^1166
"KRN",.84,38132,0)
38132^2^y^MAILMAN^Editing data in the |1| file:
"KRN",.84,38132,2,0)
^.844^1^1^3000727^^
"KRN",.84,38132,2,1,0)
Editing data in the |1| file:
"KRN",.84,38132,3,0)
^.845^1^1
"KRN",.84,38132,3,1,0)
1^file name
"KRN",.84,38132,5,0)
^.841^1^1
"KRN",.84,38132,5,1,0)
XMVVITA
"KRN",.84,38132,5,"B","XMVVITA",1)

"KRN",.84,38133,-1)
0^1167
"KRN",.84,38133,0)
38133^2^y^MAILMAN^ADD'L PHONE |1|
"KRN",.84,38133,2,0)
^^1^1^3000727^
"KRN",.84,38133,2,1,0)
ADD'L PHONE |1|
"KRN",.84,38133,3,0)
^.845^1^1
"KRN",.84,38133,3,1,0)
1^phone number (1 or 2)
"KRN",.84,38133,5,0)
^.841^1^1
"KRN",.84,38133,5,1,0)
XMVVITA
"KRN",.84,38133,5,"B","XMVVITA",1)

"KRN",.84,38140,-1)
0^1168
"KRN",.84,38140,0)
38140^2^^MAILMAN^Current priority order for reading baskets
"KRN",.84,38140,2,0)
^^1^1^3000719^
"KRN",.84,38140,2,1,0)
Current priority order for reading baskets with new messages:
"KRN",.84,38140,5,0)
^.841^1^1
"KRN",.84,38140,5,1,0)
XMVVITA
"KRN",.84,38140,5,"B","XMVVITA",1)

"KRN",.84,38141,-1)
0^1169
"KRN",.84,38141,0)
38141^2^^MAILMAN^Editing the priority order for read
"KRN",.84,38141,2,0)
^.844^3^3^3000719^^
"KRN",.84,38141,2,1,0)
Editing the priority order for reading baskets with new messages.
"KRN",.84,38141,2,2,0)
Note:  You don't need priority ordering unless you want to change the
"KRN",.84,38141,2,3,0)
default 'read new messages' basket from IN to other basket(s).
"KRN",.84,38141,5,0)
^.841^1^1
"KRN",.84,38141,5,1,0)
XMVVITA
"KRN",.84,38141,5,"B","XMVVITA",1)

"KRN",.84,38150,-1)
0^1170
"KRN",.84,38150,0)
38150^2^y^MAILMAN^|1| service for |2|
"KRN",.84,38150,2,0)
^^1^1^3000714^
"KRN",.84,38150,2,1,0)
|1| service for |2|
"KRN",.84,38150,3,0)
^.845^2^2
"KRN",.84,38150,3,1,0)
1^mailman version
"KRN",.84,38150,3,2,0)
2^user's network name
"KRN",.84,38150,5,0)
^.841^1^1
"KRN",.84,38150,5,1,0)
XM
"KRN",.84,38150,5,"B","XM",1)

"KRN",.84,38151,-1)
0^1171
"KRN",.84,38151,0)
38151^2^y^MAILMAN^You last used MailMan: |1|
"KRN",.84,38151,2,0)
^^1^1^3000714^
"KRN",.84,38151,2,1,0)
You last used MailMan: |1|
"KRN",.84,38151,3,0)
^.845^1^1
"KRN",.84,38151,3,1,0)
1^date last used
"KRN",.84,38151,5,0)
^.841^1^1
"KRN",.84,38151,5,1,0)
XM
"KRN",.84,38151,5,"B","XM",1)

"KRN",.84,38152,-1)
0^1172
"KRN",.84,38152,0)
38152^2^y^MAILMAN^|2| last used MailMan: |1|
"KRN",.84,38152,2,0)
^^1^1^3000714^
"KRN",.84,38152,2,1,0)
|2| last used MailMan: |1|
"KRN",.84,38152,3,0)
^.845^2^2
"KRN",.84,38152,3,1,0)
1^date last used mailman
"KRN",.84,38152,3,2,0)
2^surrogate
"KRN",.84,38152,5,0)
^.841^1^1
"KRN",.84,38152,5,1,0)
XM
"KRN",.84,38152,5,"B","XM",1)

"KRN",.84,38153,-1)
0^1173
"KRN",.84,38153,0)
38153^2^y^MAILMAN^Your current banner: |1|
"KRN",.84,38153,2,0)
^^1^1^3000714^
"KRN",.84,38153,2,1,0)
Your current banner: |1|
"KRN",.84,38153,3,0)
^.845^1^1
"KRN",.84,38153,3,1,0)
1^current banner
"KRN",.84,38153,5,0)
^.841^1^1
"KRN",.84,38153,5,1,0)
XM
"KRN",.84,38153,5,"B","XM",1)

"KRN",.84,38154,-1)
0^1174
"KRN",.84,38154,0)
38154^2^y^MAILMAN^|2|'s current banner: |1|
"KRN",.84,38154,2,0)
^^1^1^3000714^
"KRN",.84,38154,2,1,0)
|2|'s current banner: |1|
"KRN",.84,38154,3,0)
^.845^2^2
"KRN",.84,38154,3,1,0)
1^current banner
"KRN",.84,38154,3,2,0)
2^surrogate
"KRN",.84,38154,5,0)
^.841^1^1
"KRN",.84,38154,5,1,0)
XM
"KRN",.84,38154,5,"B","XM",1)

"KRN",.84,38155,-1)
0^1175
"KRN",.84,38155,0)
38155^2^y^MAILMAN^You have |1| new messages.
"KRN",.84,38155,2,0)
^^1^1^3000714^
"KRN",.84,38155,2,1,0)
You have |1| new messages.
"KRN",.84,38155,3,0)
^.845^1^1
"KRN",.84,38155,3,1,0)
1^number of new messages.
"KRN",.84,38155,5,0)
^.841^1^1
"KRN",.84,38155,5,1,0)
XM
"KRN",.84,38155,5,"B","XM",1)

"KRN",.84,38155.1,-1)
0^1176
"KRN",.84,38155.1,0)
38155.1^2^^MAILMAN^You have 1 new message.
"KRN",.84,38155.1,2,0)
^^1^1^3000714^
"KRN",.84,38155.1,2,1,0)
You have 1 new message.
"KRN",.84,38155.1,5,0)
^.841^1^1
"KRN",.84,38155.1,5,1,0)
XM
"KRN",.84,38155.1,5,"B","XM",1)

"KRN",.84,38155.2,-1)
0^1177
"KRN",.84,38155.2,0)
38155.2^2^^MAILMAN^You have no new messages.
"KRN",.84,38155.2,2,0)
^^1^1^3000714^
"KRN",.84,38155.2,2,1,0)
You have no new messages.
"KRN",.84,38155.2,5,0)
^.841^1^1
"KRN",.84,38155.2,5,1,0)
XM
"KRN",.84,38155.2,5,"B","XM",1)

"KRN",.84,38156,-1)
0^1178
"KRN",.84,38156,0)
38156^2^y^MAILMAN^|2| has |1| new messages.
"KRN",.84,38156,2,0)
^^1^1^3000714^
"KRN",.84,38156,2,1,0)
|2| has |1| new messages.
"KRN",.84,38156,3,0)
^.845^2^2
"KRN",.84,38156,3,1,0)
1^number of new messages
"KRN",.84,38156,3,2,0)
2^surrogate
"KRN",.84,38156,5,0)
^.841^1^1
"KRN",.84,38156,5,1,0)
XM
"KRN",.84,38156,5,"B","XM",1)

"KRN",.84,38156.1,-1)
0^1179
"KRN",.84,38156.1,0)
38156.1^2^y^MAILMAN^|2| has 1 new message.
"KRN",.84,38156.1,2,0)
^.844^1^1^3000714^^
"KRN",.84,38156.1,2,1,0)
|2| has 1 new message.
"KRN",.84,38156.1,3,0)
^.845^1^1
"KRN",.84,38156.1,3,1,0)
2^surrogate
"KRN",.84,38156.1,5,0)
^.841^1^1
"KRN",.84,38156.1,5,1,0)
XM
"KRN",.84,38156.1,5,"B","XM",1)

"KRN",.84,38156.2,-1)
0^1180
"KRN",.84,38156.2,0)
38156.2^2^y^MAILMAN^|2| has no new messages.
"KRN",.84,38156.2,2,0)
^^1^1^3000714^
"KRN",.84,38156.2,2,1,0)
|2| has no new messages.
"KRN",.84,38156.2,3,0)
^.845^1^1
"KRN",.84,38156.2,3,1,0)
2^surrogate
"KRN",.84,38156.2,5,0)
^.841^1^1
"KRN",.84,38156.2,5,1,0)
XM
"KRN",.84,38156.2,5,"B","XM",1)

"KRN",.84,38157,-1)
0^1181
"KRN",.84,38157,0)
38157^2^y^MAILMAN^ (|1| in the '|2|' basket)
"KRN",.84,38157,2,0)
^.844^1^1^3000714^^^
"KRN",.84,38157,2,1,0)
 (|1| in the '|2|' basket)
"KRN",.84,38157,3,0)
^.845^2^2
"KRN",.84,38157,3,1,0)
1^number of new messages
"KRN",.84,38157,3,2,0)
2^basket name
"KRN",.84,38157,5,0)
^.841^1^1
"KRN",.84,38157,5,1,0)
XM
"KRN",.84,38157,5,"B","XM",1)

"KRN",.84,38158,-1)
0^1182
"KRN",.84,38158,0)
38158^2^y^MAILMAN^(Last arrival: |1|)
"KRN",.84,38158,2,0)
^^1^1^3000714^
"KRN",.84,38158,2,1,0)
(Last arrival: |1|)
"KRN",.84,38158,3,0)
^.845^1^1
"KRN",.84,38158,3,1,0)
1^last msg arrival date/time
"KRN",.84,38158,5,0)
^.841^1^1
"KRN",.84,38158,5,1,0)
XM
"KRN",.84,38158,5,"B","XM",1)

"KRN",.84,38159,-1)
0^1183
"KRN",.84,38159,0)
38159^2^^MAILMAN^You've got PRIORITY mail!
"KRN",.84,38159,2,0)
^^1^1^3000714^
"KRN",.84,38159,2,1,0)
You've got PRIORITY mail!
"KRN",.84,38159,5,0)
^.841^1^1
"KRN",.84,38159,5,1,0)
XM
"KRN",.84,38159,5,"B","XM",1)

"KRN",.84,38159.1,-1)
0^132
"KRN",.84,38159.1,0)
38159.1^2^y^MAILMAN^|1| has PRIORITY mail!
"KRN",.84,38159.1,2,0)
^^1^1^3020406^
"KRN",.84,38159.1,2,1,0)
|1| has PRIORITY mail!
"KRN",.84,38159.1,3,0)
^.845^1^1
"KRN",.84,38159.1,3,1,0)
1^surrogate name
"KRN",.84,38159.1,5,0)
^.841^1^1
"KRN",.84,38159.1,5,1,0)
XM
"KRN",.84,38159.1,5,"B","XM",1)

"KRN",.84,38160,-1)
0^1184
"KRN",.84,38160,0)
38160^2^^MAILMAN^There's a discrepancy in the 'new message'
"KRN",.84,38160,2,0)
^^1^1^3000714^
"KRN",.84,38160,2,1,0)
There's a discrepancy in the 'new message' count.  Checking the mailbox...
"KRN",.84,38160,5,0)
^.841^1^1
"KRN",.84,38160,5,1,0)
XM
"KRN",.84,38160,5,"B","XM",1)

"KRN",.84,38161,-1)
0^1185
"KRN",.84,38161,0)
38161^2^^MAILMAN^Enter '~NML' to read your new messages.
"KRN",.84,38161,2,0)
^.844^1^1^3000714^^
"KRN",.84,38161,2,1,0)
Enter '^NML' to read your new messages.
"KRN",.84,38161,5,0)
^.841^1^1
"KRN",.84,38161,5,1,0)
XMGAPI4
"KRN",.84,38161,5,"B","XMGAPI4",1)

"KRN",.84,38162,-1)
0^1186
"KRN",.84,38162,0)
38162^2^^MAILMAN^Checking POSTMASTER mailbox.
"KRN",.84,38162,2,0)
^^1^1^3000714^
"KRN",.84,38162,2,1,0)
Checking POSTMASTER mailbox.
"KRN",.84,38162,5,0)
^.841^1^1
"KRN",.84,38162,5,1,0)
XMGAPI4
"KRN",.84,38162,5,"B","XMGAPI4",1)

"KRN",.84,38165,-1)
0^1187
"KRN",.84,38165,0)
38165^2^^MAILMAN^Ready to create a mailbox for a user.
"KRN",.84,38165,2,0)
^^2^2^3000714^
"KRN",.84,38165,2,1,0)
Ready to create a mailbox for a user.
"KRN",.84,38165,2,2,0)
You will only be able to select a user who does not already have a mailbox.
"KRN",.84,38165,5,0)
^.841^1^1
"KRN",.84,38165,5,1,0)
XM
"KRN",.84,38165,5,"B","XM",1)

"KRN",.84,38165.1,-1)
0^1188
"KRN",.84,38165.1,0)
38165.1^2^^MAILMAN^Mailbox created.
"KRN",.84,38165.1,2,0)
^^1^1^3000714^
"KRN",.84,38165.1,2,1,0)
Mailbox created.
"KRN",.84,38165.1,5,0)
^.841^1^1
"KRN",.84,38165.1,5,1,0)
XM
"KRN",.84,38165.1,5,"B","XM",1)

"KRN",.84,38170,-1)
0^1189
"KRN",.84,38170,0)
38170^2^^MAILMAN^SEND A MESSAGE
"KRN",.84,38170,2,0)
^.844^1^1^3000714^^
"KRN",.84,38170,2,1,0)
SEND A MESSAGE
"KRN",.84,38170,5,0)
^.841^1^1
"KRN",.84,38170,5,1,0)
XM
"KRN",.84,38170,5,"B","XM",1)

"KRN",.84,38171,-1)
0^1190
"KRN",.84,38171,0)
38171^2^^MAILMAN^READ/MANAGE MESSAGES
"KRN",.84,38171,2,0)
^^1^1^3000714^
"KRN",.84,38171,2,1,0)
READ/MANAGE MESSAGES
"KRN",.84,38171,5,0)
^.841^1^1
"KRN",.84,38171,5,1,0)
XM
"KRN",.84,38171,5,"B","XM",1)

"KRN",.84,38172,-1)
0^1191
"KRN",.84,38172,0)
38172^2^^MAILMAN^NEW MESSAGES AND RESPONSES
"KRN",.84,38172,2,0)
^^1^1^3000714^
"KRN",.84,38172,2,1,0)
NEW MESSAGES AND RESPONSES
"KRN",.84,38172,5,0)
^.841^1^1
"KRN",.84,38172,5,1,0)
XM
"KRN",.84,38172,5,"B","XM",1)

"KRN",.84,38173,-1)
0^1192
"KRN",.84,38173,0)
38173^2^^MAILMAN^LOAD PACKMAN MESSAGE
"KRN",.84,38173,2,0)
^^1^1^3000714^
"KRN",.84,38173,2,1,0)
LOAD PACKMAN MESSAGE
"KRN",.84,38173,5,0)
^.841^1^1
"KRN",.84,38173,5,1,0)
XM
"KRN",.84,38173,5,"B","XM",1)

"KRN",.84,38174,-1)
0^1193
"KRN",.84,38174,0)
38174^2^^MAILMAN^EDIT USER OPTIONS
"KRN",.84,38174,2,0)
^^1^1^3000714^
"KRN",.84,38174,2,1,0)
EDIT USER OPTIONS
"KRN",.84,38174,5,0)
^.841^1^1
"KRN",.84,38174,5,1,0)
XM
"KRN",.84,38174,5,"B","XM",1)

"KRN",.84,38175,-1)
0^1194
"KRN",.84,38175,0)
38175^2^^MAILMAN^PERSONAL MAIL GROUP EDIT
"KRN",.84,38175,2,0)
^^1^1^3000714^
"KRN",.84,38175,2,1,0)
PERSONAL MAIL GROUP EDIT
"KRN",.84,38175,5,0)
^.841^1^1
"KRN",.84,38175,5,1,0)
XM
"KRN",.84,38175,5,"B","XM",1)

"KRN",.84,38176,-1)
0^1195
"KRN",.84,38176,0)
38176^2^^MAILMAN^JOIN MAIL GROUP
"KRN",.84,38176,2,0)
^^1^1^3000714^
"KRN",.84,38176,2,1,0)
JOIN MAIL GROUP
"KRN",.84,38176,5,0)
^.841^1^1
"KRN",.84,38176,5,1,0)
XM
"KRN",.84,38176,5,"B","XM",1)

"KRN",.84,38177,-1)
0^1196
"KRN",.84,38177,0)
38177^2^^MAILMAN^MAILBOX CONTENTS LIST
"KRN",.84,38177,2,0)
^^1^1^3000714^
"KRN",.84,38177,2,1,0)
MAILBOX CONTENTS LIST
"KRN",.84,38177,5,0)
^.841^1^1
"KRN",.84,38177,5,1,0)
XM
"KRN",.84,38177,5,"B","XM",1)

"KRN",.84,38178,-1)
0^1197
"KRN",.84,38178,0)
38178^2^^MAILMAN^LOG-IN TO ANOTHER SYSTEM (TALKMAN)
"KRN",.84,38178,2,0)
^^1^1^3000714^
"KRN",.84,38178,2,1,0)
LOG-IN TO ANOTHER SYSTEM (TALKMAN)
"KRN",.84,38178,5,0)
^.841^1^1
"KRN",.84,38178,5,1,0)
XM
"KRN",.84,38178,5,"B","XM",1)

"KRN",.84,38179,-1)
0^1198
"KRN",.84,38179,0)
38179^2^^MAILMAN^QUERY/SEARCH FOR MESSAGES
"KRN",.84,38179,2,0)
^^1^1^3000714^
"KRN",.84,38179,2,1,0)
QUERY/SEARCH FOR MESSAGES
"KRN",.84,38179,5,0)
^.841^1^1
"KRN",.84,38179,5,1,0)
XM
"KRN",.84,38179,5,"B","XM",1)

"KRN",.84,38200,-1)
0^1199
"KRN",.84,38200,0)
38200^1^^MAILMAN^You are not authorized to edit this mail
"KRN",.84,38200,2,0)
^^1^1^3010108^
"KRN",.84,38200,2,1,0)
You are not authorized to edit this mail group.
"KRN",.84,38200,5,0)
^.841^1^1
"KRN",.84,38200,5,1,0)
XMXGRP
"KRN",.84,38200,5,"B","XMXGRP",1)

"KRN",.84,38201,-1)
0^1200
"KRN",.84,38201,0)
38201^1^^MAILMAN^Mail group is private.
"KRN",.84,38201,2,0)
^^1^1^3010111^
"KRN",.84,38201,2,1,0)
Mail group is private.
"KRN",.84,38201,5,0)
^.841^1^1
"KRN",.84,38201,5,1,0)
XMXGRP
"KRN",.84,38201,5,"B","XMXGRP",1)

"KRN",.84,38210,-1)
0^1201
"KRN",.84,38210,0)
38210^2^^MAILMAN^Allocate mail group
"KRN",.84,38210,2,0)
^^1^1^3010111^
"KRN",.84,38210,2,1,0)
Allocate mail group
"KRN",.84,38210,5,0)
^.841^1^1
"KRN",.84,38210,5,1,0)
XMVGRP
"KRN",.84,38210,5,"B","XMVGRP",1)

"KRN",.84,38211,-1)
0^1202
"KRN",.84,38211,0)
38211^2^^MAILMAN^Another mail group
"KRN",.84,38211,2,0)
^^1^1^3010111^
"KRN",.84,38211,2,1,0)
Another mail group
"KRN",.84,38211,5,0)
^.841^1^1
"KRN",.84,38211,5,1,0)
XMVGRP
"KRN",.84,38211,5,"B","XMVGRP",1)

"KRN",.84,38213,-1)
0^1203
"KRN",.84,38213,0)
38213^3^^MAILMAN^Enter the name of the mail group
"KRN",.84,38213,2,0)
^^5^5^3010111^
"KRN",.84,38213,2,1,0)
Enter the name of the mail group you wish to allocate.
"KRN",.84,38213,2,2,0)
Precede any mail group name with '-' to remove it.
"KRN",.84,38213,2,3,0)
You'll only be able to select mail groups you're authorized to edit.
"KRN",.84,38213,2,4,0)
Enter ?? for a list of mail groups you've already selected,
"KRN",.84,38213,2,5,0)
and for mail group help.
"KRN",.84,38213,5,0)
^.841^1^1
"KRN",.84,38213,5,1,0)
XMVGROUP
"KRN",.84,38213,5,"B","XMVGROUP",1)

"KRN",.84,38214,-1)
0^1204
"KRN",.84,38214,0)
38214^1^^MAILMAN^ ?? Not on current list.
"KRN",.84,38214,1,0)
^^1^1^3010111^
"KRN",.84,38214,1,1,0)
has a leading space.
"KRN",.84,38214,2,0)
^^1^1^3010111^
"KRN",.84,38214,2,1,0)
 ?? Not on current list.
"KRN",.84,38214,5,0)
^.841^1^1
"KRN",.84,38214,5,1,0)
XMVGRP
"KRN",.84,38214,5,"B","XMVGRP",1)

"KRN",.84,38215,-1)
0^1205
"KRN",.84,38215,0)
38215^2^^MAILMAN^  Deleted from current list.
"KRN",.84,38215,1,0)
^^1^1^3010111^
"KRN",.84,38215,1,1,0)
has 2 leading spaces
"KRN",.84,38215,2,0)
^^1^1^3010111^
"KRN",.84,38215,2,1,0)
  Deleted from current list.
"KRN",.84,38215,5,0)
^.841^1^1
"KRN",.84,38215,5,1,0)
XMVGRP
"KRN",.84,38215,5,"B","XMVGRP",1)

"KRN",.84,38216,-1)
0^1206
"KRN",.84,38216,0)
38216^2^^MAILMAN^You haven't selected any mail groups yet.
"KRN",.84,38216,2,0)
^^1^1^3010111^
"KRN",.84,38216,2,1,0)
You haven't selected any mail groups yet.
"KRN",.84,38216,5,0)
^.841^1^1
"KRN",.84,38216,5,1,0)
XMVGRP
"KRN",.84,38216,5,"B","XMVGRP",1)

"KRN",.84,38217,-1)
0^1207
"KRN",.84,38217,0)
38217^2^^MAILMAN^Want mail group help
"KRN",.84,38217,2,0)
^^1^1^3010111^
"KRN",.84,38217,2,1,0)
Want mail group help
"KRN",.84,38217,5,0)
^.841^1^1
"KRN",.84,38217,5,1,0)
XMVGRP
"KRN",.84,38217,5,"B","XMVGRP",1)

"KRN",.84,38218,-1)
0^1208
"KRN",.84,38218,0)
38218^2^^MAILMAN^You've selected the following mail groups:
"KRN",.84,38218,2,0)
^^1^1^3010111^
"KRN",.84,38218,2,1,0)
You've selected the following mail groups:
"KRN",.84,38218,5,0)
^.841^1^1
"KRN",.84,38218,5,1,0)
XMVGRP
"KRN",.84,38218,5,"B","XMVGRP",1)

"KRN",.84,38220,-1)
0^1209
"KRN",.84,38220,0)
38220^2^^MAILMAN^Add user: 
"KRN",.84,38220,1,0)
^^1^1^3010111^
"KRN",.84,38220,1,1,0)
has 1 trailing space
"KRN",.84,38220,2,0)
^.844^1^1^3010111^^
"KRN",.84,38220,2,1,0)
Add user: 
"KRN",.84,38220,5,0)
^.841^1^1
"KRN",.84,38220,5,1,0)
XMVGRP
"KRN",.84,38220,5,"B","XMVGRP",1)

"KRN",.84,38221,-1)
0^1210
"KRN",.84,38221,0)
38221^2^^MAILMAN^Another user: 
"KRN",.84,38221,1,0)
^^1^1^3010111^
"KRN",.84,38221,1,1,0)
has 1 trailing space
"KRN",.84,38221,2,0)
^^1^1^3010111^
"KRN",.84,38221,2,1,0)
Another user: 
"KRN",.84,38221,5,0)
^.841^1^1
"KRN",.84,38221,5,1,0)
XMVGRP
"KRN",.84,38221,5,"B","XMVGRP",1)

"KRN",.84,38222,-1)
0^1211
"KRN",.84,38222,0)
38222^1^^MAILMAN^You must select a user, or enter
"KRN",.84,38222,2,0)
^^1^1^3010111^
"KRN",.84,38222,2,1,0)
You must select a user, or enter ^ to exit.
"KRN",.84,38222,5,0)
^.841^1^1
"KRN",.84,38222,5,1,0)
XMVGRP
"KRN",.84,38222,5,"B","XMVGRP",1)

"KRN",.84,38223,-1)
0^1212
"KRN",.84,38223,0)
38223^3^^MAILMAN^Enter the name of the user you wish to add
"KRN",.84,38223,2,0)
^^5^5^3010111^
"KRN",.84,38223,2,1,0)
Enter the name of the user you wish to add to the group(s).
"KRN",.84,38223,2,2,0)
Precede any user name with '-' to remove it.
"KRN",.84,38223,2,3,0)
You'll only be able to select users with mailboxes and access codes.
"KRN",.84,38223,2,4,0)
Enter ?? for a list of users you've already selected,
"KRN",.84,38223,2,5,0)
and for user help.
"KRN",.84,38223,5,0)
^.841^1^1
"KRN",.84,38223,5,1,0)
XMVGRP
"KRN",.84,38223,5,"B","XMVGRP",1)

"KRN",.84,38224,-1)
0^1213
"KRN",.84,38224,0)
38224^2^^MAILMAN^Want user help
"KRN",.84,38224,2,0)
^^1^1^3010111^
"KRN",.84,38224,2,1,0)
Want user help
"KRN",.84,38224,5,0)
^.841^1^1
"KRN",.84,38224,5,1,0)
XMVGRP
"KRN",.84,38224,5,"B","XMVGRP",1)

"KRN",.84,38225,-1)
0^1214
"KRN",.84,38225,0)
38225^2^^MAILMAN^You've selected the following users:
"KRN",.84,38225,2,0)
^^1^1^3010111^
"KRN",.84,38225,2,1,0)
You've selected the following users:
"KRN",.84,38225,5,0)
^.841^1^1
"KRN",.84,38225,5,1,0)
XMVGRP
"KRN",.84,38225,5,"B","XMVGRP",1)

"KRN",.84,38226,-1)
0^1215
"KRN",.84,38226,0)
38226^2^^MAILMAN^You haven't selected any users yet.
"KRN",.84,38226,2,0)
^^1^1^3010111^
"KRN",.84,38226,2,1,0)
You haven't selected any users yet.
"KRN",.84,38226,5,0)
^.841^1^1
"KRN",.84,38226,5,1,0)
XMVGRP
"KRN",.84,38226,5,"B","XMVGRP",1)

"KRN",.84,38230,-1)
0^1216
"KRN",.84,38230,0)
38230^2^^MAILMAN^You are adding users to mail groups.
"KRN",.84,38230,2,0)
^^1^1^3010111^
"KRN",.84,38230,2,1,0)
You are adding users to mail groups.  Do you wish to proceed
"KRN",.84,38230,5,0)
^.841^1^1
"KRN",.84,38230,5,1,0)
XMVGRP
"KRN",.84,38230,5,"B","XMVGRP",1)

"KRN",.84,38231,-1)
0^1217
"KRN",.84,38231,0)
38231^2^^MAILMAN^Do you wish to forward past mail group
"KRN",.84,38231,2,0)
^.844^2^2^3010129^^^^
"KRN",.84,38231,2,1,0)
Do you wish to forward past mail group messages
"KRN",.84,38231,2,2,0)
to the user(s) you just added to the mail group(s)
"KRN",.84,38231,5,0)
^.841^1^1
"KRN",.84,38231,5,1,0)
XMVGRP
"KRN",.84,38231,5,"B","XMVGRP",1)

"KRN",.84,38232,-1)
0^1218
"KRN",.84,38232,0)
38232^3^^MAILMAN^Answer YES to forward past mail group mess
"KRN",.84,38232,2,0)
^.844^4^4^3010112^^
"KRN",.84,38232,2,1,0)
Answer YES to forward past mail group messages.
"KRN",.84,38232,2,2,0)
You will be asked for a time frame to search,
"KRN",.84,38232,2,3,0)
and then MailMan will create a task to find and forward
"KRN",.84,38232,2,4,0)
existing mail group messages.
"KRN",.84,38232,5,0)
^.841^1^1
"KRN",.84,38232,5,1,0)
XMVGRP
"KRN",.84,38232,5,"B","XMVGRP",1)

"KRN",.84,38233,-1)
0^1219
"KRN",.84,38233,0)
38233^2^^MAILMAN^The users have been added to the mail
"KRN",.84,38233,2,0)
^^1^1^3010111^
"KRN",.84,38233,2,1,0)
The users have been added to the mail groups.
"KRN",.84,38233,5,0)
^.841^1^1
"KRN",.84,38233,5,1,0)
XMVGRP
"KRN",.84,38233,5,"B","XMVGRP",1)

"KRN",.84,39001,-1)
0^1220
"KRN",.84,39001,0)
39001^1^y^MAILMAN^Messages longer than |1| may not be sent a
"KRN",.84,39001,1,0)
^^3^3^2991029^
"KRN",.84,39001,1,1,0)
IRM has set field 8.3 in file 4.3 to limit the number of lines
"KRN",.84,39001,1,2,0)
in a message which may be sent to another site.  This message
"KRN",.84,39001,1,3,0)
exceeds that limit.
"KRN",.84,39001,2,0)
^^1^1^2991029^
"KRN",.84,39001,2,1,0)
Messages longer than |1| lines may not be sent across the network.
"KRN",.84,39001,3,0)
^.845^1^1
"KRN",.84,39001,3,1,0)
1^Maximimum number of lines allowed
"KRN",.84,39001,5,0)
^.841^3^3
"KRN",.84,39001,5,1,0)
XMXADDR
"KRN",.84,39001,5,2,0)
XMXADDR3
"KRN",.84,39001,5,3,0)
XMJMT
"KRN",.84,39001,5,"B","XMJMT",3)

"KRN",.84,39001,5,"B","XMXADDR",1)

"KRN",.84,39001,5,"B","XMXADDR3",2)

"KRN",.84,39002,-1)
0^1221
"KRN",.84,39002,0)
39002^1^^MAILMAN^  Not found.
"KRN",.84,39002,2,0)
^^1^1^2991029^^
"KRN",.84,39002,2,1,0)
  Not found.
"KRN",.84,39002,5,0)
^.841^3^3
"KRN",.84,39002,5,1,0)
XMXADDR
"KRN",.84,39002,5,2,0)
XMXADDR1
"KRN",.84,39002,5,3,0)
XMXADDRG
"KRN",.84,39002,5,"B","XMXADDR",1)

"KRN",.84,39002,5,"B","XMXADDR1",2)

"KRN",.84,39002,5,"B","XMXADDRG",3)

"KRN",.84,39003,-1)
0^1222
"KRN",.84,39003,0)
39003^2^^MAILMAN^  Later'd Group Deleted.
"KRN",.84,39003,2,0)
^^1^1^2991029^
"KRN",.84,39003,2,1,0)
  Later'd Group Deleted.
"KRN",.84,39003,5,0)
^.841^1^1
"KRN",.84,39003,5,1,0)
XMXADDR
"KRN",.84,39003,5,"B","XMXADDR",1)

"KRN",.84,39004,-1)
0^1223
"KRN",.84,39004,0)
39004^2^^MAILMAN^Members Deleted.
"KRN",.84,39004,2,0)
^^1^1^2991029^
"KRN",.84,39004,2,1,0)
Members Deleted.
"KRN",.84,39004,5,0)
^.841^1^1
"KRN",.84,39004,5,1,0)
XMXADDR
"KRN",.84,39004,5,"B","XMXADDR",1)

"KRN",.84,39005,-1)
0^1224
"KRN",.84,39005,0)
39005^2^^MAILMAN^  Deleted.
"KRN",.84,39005,2,0)
^^1^1^2991029^
"KRN",.84,39005,2,1,0)
  Deleted.
"KRN",.84,39005,5,0)
^.841^1^1
"KRN",.84,39005,5,1,0)
XMXADDR
"KRN",.84,39005,5,"B","XMXADDR",1)

"KRN",.84,39006,-1)
0^1225
"KRN",.84,39006,0)
39006^2^^MAILMAN^* (Broadcast to all local users)
"KRN",.84,39006,2,0)
^^1^1^2991029^
"KRN",.84,39006,2,1,0)
* (Broadcast to all local users)
"KRN",.84,39006,5,0)
^.841^2^2
"KRN",.84,39006,5,1,0)
XMXADDR
"KRN",.84,39006,5,2,0)
XMKP
"KRN",.84,39006,5,"B","XMKP",2)

"KRN",.84,39006,5,"B","XMXADDR",1)

"KRN",.84,39007,-1)
0^1226
"KRN",.84,39007,0)
39007^2^^MAILMAN^But Broadcast will still go to all local
"KRN",.84,39007,2,0)
^^1^1^2991029^
"KRN",.84,39007,2,1,0)
But Broadcast will still go to all local users.
"KRN",.84,39007,5,0)
^.841^1^1
"KRN",.84,39007,5,1,0)
XMXADDR
"KRN",.84,39007,5,"B","XMXADDR",1)

"KRN",.84,39008,-1)
0^1227
"KRN",.84,39008,0)
39008^2^^MAILMAN^But message will still go to all members
"KRN",.84,39008,2,0)
^^1^1^2991029^
"KRN",.84,39008,2,1,0)
But message will still go to all members of the following later'd group(s):
"KRN",.84,39008,5,0)
^.841^1^1
"KRN",.84,39008,5,1,0)
XMXADDR
"KRN",.84,39008,5,"B","XMXADDR",1)

"KRN",.84,39009,-1)
0^1228
"KRN",.84,39009,0)
39009^2^^MAILMAN^'Later' not appropriate for this addressee
"KRN",.84,39009,2,0)
^^1^1^2991029^
"KRN",.84,39009,2,1,0)
'Later' not appropriate for this addressee.  'Later' ignored.
"KRN",.84,39009,5,0)
^.841^1^1
"KRN",.84,39009,5,1,0)
XMXADDR
"KRN",.84,39009,5,"B","XMXADDR",1)

"KRN",.84,39010,-1)
0^1229
"KRN",.84,39010,0)
39010^1^^MAILMAN^Null addressee
"KRN",.84,39010,2,0)
^^1^1^2991029^
"KRN",.84,39010,2,1,0)
Null addressee
"KRN",.84,39010,5,0)
^.841^2^2
"KRN",.84,39010,5,1,0)
XMXADDR
"KRN",.84,39010,5,2,0)
XMXADDR3
"KRN",.84,39010,5,"B","XMXADDR",1)

"KRN",.84,39010,5,"B","XMXADDR3",2)

"KRN",.84,39011,-1)
0^1230
"KRN",.84,39011,0)
39011^1^^MAILMAN^Null recipient type
"KRN",.84,39011,2,0)
^^1^1^2991029^
"KRN",.84,39011,2,1,0)
Null recipient type
"KRN",.84,39011,5,0)
^.841^1^1
"KRN",.84,39011,5,1,0)
XMXADDR
"KRN",.84,39011,5,"B","XMXADDR",1)

"KRN",.84,39012,-1)
0^1231
"KRN",.84,39012,0)
39012^1^y^MAILMAN^Invalid recipient type '|1|'
"KRN",.84,39012,2,0)
^^1^1^2991029^
"KRN",.84,39012,2,1,0)
Invalid recipient type '|1|'
"KRN",.84,39012,3,0)
^.845^1^1
"KRN",.84,39012,3,1,0)
1^recipient type
"KRN",.84,39012,5,0)
^.841^1^1
"KRN",.84,39012,5,1,0)
XMXADDR
"KRN",.84,39012,5,"B","XMXADDR",1)

"KRN",.84,39013,-1)
0^1232
"KRN",.84,39013,0)
39013^2^^MAILMAN^Later Delivery must be at least 5 minutes
"KRN",.84,39013,2,0)
^^2^2^2991029^^
"KRN",.84,39013,2,1,0)
Later Delivery must be at least 5 minutes from now.
"KRN",.84,39013,2,2,0)
When Later
"KRN",.84,39013,5,0)
^.841^1^1
"KRN",.84,39013,5,1,0)
XMXADDR
"KRN",.84,39013,5,"B","XMXADDR",1)

"KRN",.84,39014,-1)
0^1233
"KRN",.84,39014,0)
39014^1^^MAILMAN^No basket selected.
"KRN",.84,39014,2,0)
^^1^1^2991102^^
"KRN",.84,39014,2,1,0)
No basket selected.
"KRN",.84,39014,5,0)
^.841^1^1
"KRN",.84,39014,5,1,0)
XMXADDR1
"KRN",.84,39014,5,"B","XMXADDR1",1)

"KRN",.84,39015,-1)
0^1234
"KRN",.84,39015,0)
39015^2^^MAILMAN^ removed from recipient list.
"KRN",.84,39015,2,0)
^^1^1^2991029^^
"KRN",.84,39015,2,1,0)
 removed from recipient list.
"KRN",.84,39015,5,0)
^.841^2^2
"KRN",.84,39015,5,1,0)
XMXADDR
"KRN",.84,39015,5,2,0)
XMXADDR1
"KRN",.84,39015,5,"B","XMXADDR",1)

"KRN",.84,39015,5,"B","XMXADDR1",2)

"KRN",.84,39015.1,-1)
0^1235
"KRN",.84,39015.1,0)
39015.1^1^^MAILMAN^Not a current recipient.
"KRN",.84,39015.1,2,0)
^^1^1^3000705^
"KRN",.84,39015.1,2,1,0)
Not a current recipient.
"KRN",.84,39015.1,5,0)
^.841^1^1
"KRN",.84,39015.1,5,1,0)
XMXADDR3
"KRN",.84,39015.1,5,"B","XMXADDR3",1)

"KRN",.84,39016,-1)
0^1236
"KRN",.84,39016,0)
39016^2^^MAILMAN^>> Remember, you won't be able to 'minus'
"KRN",.84,39016,2,0)
^^1^1^2991029^
"KRN",.84,39016,2,1,0)
>> Remember, you won't be able to 'minus' anyone from the group. <<
"KRN",.84,39016,5,0)
^.841^1^1
"KRN",.84,39016,5,1,0)
XMXADDR
"KRN",.84,39016,5,"B","XMXADDR",1)

"KRN",.84,39017,-1)
0^1237
"KRN",.84,39017,0)
39017^2^^MAILMAN^>> Remember, you won't be able to 'minus'
"KRN",.84,39017,2,0)
^^1^1^2991029^
"KRN",.84,39017,2,1,0)
>> Remember, you won't be able to 'minus' anyone from the limited broadcast. <<
"KRN",.84,39017,5,0)
^.841^1^1
"KRN",.84,39017,5,1,0)
XMXADDR
"KRN",.84,39017,5,"B","XMXADDR",1)

"KRN",.84,39018,-1)
0^1238
"KRN",.84,39018,0)
39018^1^^MAILMAN^Addressee ambiguous.
"KRN",.84,39018,2,0)
^^1^1^2991029^
"KRN",.84,39018,2,1,0)
Addressee ambiguous.
"KRN",.84,39018,5,0)
^.841^1^1
"KRN",.84,39018,5,1,0)
XMXADDR1
"KRN",.84,39018,5,"B","XMXADDR1",1)

"KRN",.84,39019,-1)
0^1239
"KRN",.84,39019,0)
39019^1^^MAILMAN^Addressee not found.
"KRN",.84,39019,2,0)
^^1^1^2991029^
"KRN",.84,39019,2,1,0)
Addressee not found.
"KRN",.84,39019,5,0)
^.841^1^1
"KRN",.84,39019,5,1,0)
XMXADDR1
"KRN",.84,39019,5,"B","XMXADDR1",1)

"KRN",.84,39020,-1)
0^1240
"KRN",.84,39020,0)
39020^1^^MAILMAN^Closed messages may not be sent to SHARED
"KRN",.84,39020,2,0)
^^1^1^2991029^
"KRN",.84,39020,2,1,0)
Closed messages may not be sent to SHARED,MAIL.
"KRN",.84,39020,5,0)
^.841^1^1
"KRN",.84,39020,5,1,0)
XMXADDR1
"KRN",.84,39020,5,"B","XMXADDR1",1)

"KRN",.84,39021,-1)
0^1241
"KRN",.84,39021,0)
39021^1^^MAILMAN^Confidential messages may not be sent to
"KRN",.84,39021,2,0)
^^1^1^2991029^
"KRN",.84,39021,2,1,0)
Confidential messages may not be sent to SHARED,MAIL.
"KRN",.84,39021,5,0)
^.841^1^1
"KRN",.84,39021,5,1,0)
XMXADDR1
"KRN",.84,39021,5,"B","XMXADDR1",1)

"KRN",.84,39022,-1)
0^1242
"KRN",.84,39022,0)
39022^2^^MAILMAN^Select basket to send to:
"KRN",.84,39022,2,0)
^^1^1^2991029^
"KRN",.84,39022,2,1,0)
Select basket to send to: 
"KRN",.84,39022,5,0)
^.841^1^1
"KRN",.84,39022,5,1,0)
XMXADDR1
"KRN",.84,39022,5,"B","XMXADDR1",1)

"KRN",.84,39023,-1)
0^1243
"KRN",.84,39023,0)
39023^2^^MAILMAN^Enter Termination Date
"KRN",.84,39023,2,0)
^^1^1^2991029^
"KRN",.84,39023,2,1,0)
Enter Termination Date
"KRN",.84,39023,5,0)
^.841^1^1
"KRN",.84,39023,5,1,0)
XMXADDR1
"KRN",.84,39023,5,"B","XMXADDR1",1)

"KRN",.84,39024,-1)
0^1244
"KRN",.84,39024,0)
39024^3^^MAILMAN^Messages sent to SHARED,MAIL must have
"KRN",.84,39024,2,0)
^^2^2^2991029^
"KRN",.84,39024,2,1,0)
Messages sent to SHARED,MAIL must have a delete date, so
"KRN",.84,39024,2,2,0)
they may be automatically removed from SHARED,MAIL's mailbox.
"KRN",.84,39024,5,0)
^.841^1^1
"KRN",.84,39024,5,1,0)
XMXADDR1
"KRN",.84,39024,5,"B","XMXADDR1",1)

"KRN",.84,39025,-1)
0^1245
"KRN",.84,39025,0)
39025^2^^MAILMAN^Not a local user; want to check the Remote
"KRN",.84,39025,2,0)
^.844^1^1^3000504^^
"KRN",.84,39025,2,1,0)
Not a local user; want to check the Remote User Directory
"KRN",.84,39025,5,0)
^.841^1^1
"KRN",.84,39025,5,1,0)
XMXADDR1
"KRN",.84,39025,5,"B","XMXADDR1",1)

"KRN",.84,39025.1,-1)
0^1246
"KRN",.84,39025.1,0)
39025.1^3^^MAILMAN^If you're trying to address this message
"KRN",.84,39025.1,2,0)
^.844^8^8^3000504^^
"KRN",.84,39025.1,2,1,0)
If you're trying to address this message to a local user, answer NO.
"KRN",.84,39025.1,2,2,0)
 
"KRN",.84,39025.1,2,3,0)
People who have mailboxes on remote systems may have their e-mail addresses
"KRN",.84,39025.1,2,4,0)
entered into the Remote User Directory, so that local users can look up
"KRN",.84,39025.1,2,5,0)
their names and have their mail automatically addressed.
"KRN",.84,39025.1,2,6,0)
 
"KRN",.84,39025.1,2,7,0)
If you're trying to address this message to a remote user, that person's
"KRN",.84,39025.1,2,8,0)
address may be in the Remote User Directory.  Shall we see if it's there?
"KRN",.84,39025.1,5,0)
^.841^1^1
"KRN",.84,39025.1,5,1,0)
XMXADDR1
"KRN",.84,39025.1,5,"B","XMXADDR1",1)

"KRN",.84,39026,-1)
0^1247
"KRN",.84,39026,0)
39026^2^^MAILMAN^Checking for MAIL NAME: 
"KRN",.84,39026,2,0)
^^1^1^2991029^
"KRN",.84,39026,2,1,0)
Checking for MAIL NAME: 
"KRN",.84,39026,5,0)
^.841^1^1
"KRN",.84,39026,5,1,0)
XMXADDR1
"KRN",.84,39026,5,"B","XMXADDR1",1)

"KRN",.84,39027,-1)
0^1248
"KRN",.84,39027,0)
39027^2^^MAILMAN^Checking Remote User Directory: 
"KRN",.84,39027,1,0)
^^1^1^3000504^
"KRN",.84,39027,1,1,0)
There's a blank at the end of the dialog.
"KRN",.84,39027,2,0)
^.844^1^1^3000504^^
"KRN",.84,39027,2,1,0)
Checking Remote User Directory: 
"KRN",.84,39027,5,0)
^.841^1^1
"KRN",.84,39027,5,1,0)
XMXADDR1
"KRN",.84,39027,5,"B","XMXADDR1",1)

"KRN",.84,39028,-1)
0^1249
"KRN",.84,39028,0)
39028^2^^MAILMAN^Routing to Remote Address:
"KRN",.84,39028,2,0)
^^1^1^2991029^
"KRN",.84,39028,2,1,0)
Routing to Remote Address: 
"KRN",.84,39028,5,0)
^.841^1^1
"KRN",.84,39028,5,1,0)
XMXADDR1
"KRN",.84,39028,5,"B","XMXADDR1",1)

"KRN",.84,39028.1,-1)
0^1250
"KRN",.84,39028.1,0)
39028.1^1^^MAILMAN^Remote address is really local.  Deleting
"KRN",.84,39028.1,2,0)
^^1^1^3000703^
"KRN",.84,39028.1,2,1,0)
Remote address is really local.  Deleting it.
"KRN",.84,39028.1,5,0)
^.841^1^1
"KRN",.84,39028.1,5,1,0)
XMXADDR1
"KRN",.84,39028.1,5,"B","XMXADDR1",1)

"KRN",.84,39029,-1)
0^1251
"KRN",.84,39029,0)
39029^1^^MAILMAN^  Enter 'G.groupname' to identify a mail
"KRN",.84,39029,2,0)
^^1^1^2991029^
"KRN",.84,39029,2,1,0)
  Enter 'G.groupname' to identify a mail group.
"KRN",.84,39029,5,0)
^.841^1^1
"KRN",.84,39029,5,1,0)
XMXADDR1
"KRN",.84,39029,5,"B","XMXADDR1",1)

"KRN",.84,39030,-1)
0^1252
"KRN",.84,39030,0)
39030^1^^MAILMAN^  Not found in NEW PERSON file.
"KRN",.84,39030,2,0)
^^1^1^2991029^
"KRN",.84,39030,2,1,0)
  Not found in NEW PERSON file.
"KRN",.84,39030,5,0)
^.841^1^1
"KRN",.84,39030,5,1,0)
XMXADDR1
"KRN",.84,39030,5,"B","XMXADDR1",1)

"KRN",.84,39031,-1)
0^1253
"KRN",.84,39031,0)
39031^3^y^MAILMAN^If |1| is the person you're trying
"KRN",.84,39031,2,0)
^^3^3^2991029^
"KRN",.84,39031,2,1,0)
If |1| is the person you're trying to address, you can't,
"KRN",.84,39031,2,2,0)
because |1| doesn't have |2|.
"KRN",.84,39031,2,3,0)
Message addressees must have an access code and a mailbox.
"KRN",.84,39031,3,0)
^.845^2^2
"KRN",.84,39031,3,1,0)
1^addressee
"KRN",.84,39031,3,2,0)
2^why the addressee can't be addressed
"KRN",.84,39031,5,0)
^.841^1^1
"KRN",.84,39031,5,1,0)
XMXADDR1
"KRN",.84,39031,5,"B","XMXADDR1",1)

"KRN",.84,39032,-1)
0^1254
"KRN",.84,39032,0)
39032^3^^MAILMAN^an access code or a mailbox
"KRN",.84,39032,1,0)
^^1^1^2991029^
"KRN",.84,39032,1,1,0)
this is parameter 2 of dialog 39031
"KRN",.84,39032,2,0)
^^1^1^2991029^
"KRN",.84,39032,2,1,0)
an access code or a mailbox
"KRN",.84,39032,5,0)
^.841^1^1
"KRN",.84,39032,5,1,0)
XMXADDR1
"KRN",.84,39032,5,"B","XMXADDR1",1)

"KRN",.84,39033,-1)
0^1255
"KRN",.84,39033,0)
39033^3^^MAILMAN^an access code
"KRN",.84,39033,1,0)
^^1^1^2991029^^
"KRN",.84,39033,1,1,0)
this is parameter 2 of dialog 39031
"KRN",.84,39033,2,0)
^^1^1^2991029^^
"KRN",.84,39033,2,1,0)
an access code
"KRN",.84,39033,5,0)
^.841^1^1
"KRN",.84,39033,5,1,0)
XMXADDR1
"KRN",.84,39033,5,"B","XMXADDR1",1)

"KRN",.84,39034,-1)
0^1256
"KRN",.84,39034,0)
39034^3^^MAILMAN^a mailbox
"KRN",.84,39034,1,0)
^^1^1^2991029^
"KRN",.84,39034,1,1,0)
this is parameter 2 of dialog 39031
"KRN",.84,39034,2,0)
^^1^1^2991029^
"KRN",.84,39034,2,1,0)
a mailbox
"KRN",.84,39034,5,0)
^.841^1^1
"KRN",.84,39034,5,1,0)
XMXADDR1
"KRN",.84,39034,5,"B","XMXADDR1",1)

"KRN",.84,39035,-1)
0^1257
"KRN",.84,39035,0)
39035^1^^MAILMAN^Broadcast messages are not accepted
"KRN",.84,39035,2,0)
^^1^1^2991029^
"KRN",.84,39035,2,1,0)
Broadcast messages are not accepted from remote sites.
"KRN",.84,39035,5,0)
^.841^1^1
"KRN",.84,39035,5,1,0)
XMXADDR2
"KRN",.84,39035,5,"B","XMXADDR2",1)

"KRN",.84,39036,-1)
0^1258
"KRN",.84,39036,0)
39036^1^^MAILMAN^Only the postmaster or XMSTAR key holders
"KRN",.84,39036,2,0)
^^1^1^2991029^
"KRN",.84,39036,2,1,0)
Only the Postmaster or XMSTAR key holders may broadcast messages.
"KRN",.84,39036,5,0)
^.841^1^1
"KRN",.84,39036,5,1,0)
XMXADDR2
"KRN",.84,39036,5,"B","XMXADDR2",1)

"KRN",.84,39036.5,-1)
0^6
"KRN",.84,39036.5,0)
39036.5^1^^MAILMAN^Messages with replies may not be broadcast
"KRN",.84,39036.5,2,0)
^.844^4^4^3020228^^^
"KRN",.84,39036.5,2,1,0)
Messages with replies may not be broadcast.
"KRN",.84,39036.5,2,2,0)
(The replies would not be forwarded to users' auto-forward addresses.)
"KRN",.84,39036.5,2,3,0)
If you wish to broadcast this message, copy it and its replies into
"KRN",.84,39036.5,2,4,0)
a new message, and broadcast the new message.
"KRN",.84,39036.5,5,0)
^.841^1^1
"KRN",.84,39036.5,5,1,0)
XMXADDR2
"KRN",.84,39036.5,5,"B","XMXADDR2",1)

"KRN",.84,39037,-1)
0^1259
"KRN",.84,39037,0)
39037^2^^MAILMAN^  Deleting limited broadcast recipients
"KRN",.84,39037,2,0)
^^1^1^2991029^
"KRN",.84,39037,2,1,0)
  Deleting limited broadcast recipients ...
"KRN",.84,39037,5,0)
^.841^1^1
"KRN",.84,39037,5,1,0)
XMXADDR2
"KRN",.84,39037,5,"B","XMXADDR2",1)

"KRN",.84,39038,-1)
0^1260
"KRN",.84,39038,0)
39038^2^^MAILMAN^Limited broadcast recipients:
"KRN",.84,39038,2,0)
^^1^1^2991029^
"KRN",.84,39038,2,1,0)
Limited broadcast recipients:
"KRN",.84,39038,5,0)
^.841^1^1
"KRN",.84,39038,5,1,0)
XMXADDR2
"KRN",.84,39038,5,"B","XMXADDR2",1)

"KRN",.84,39039,-1)
0^1261
"KRN",.84,39039,0)
39039^1^^MAILMAN^No matches.  No recipients.
"KRN",.84,39039,2,0)
^^1^1^2991029^
"KRN",.84,39039,2,1,0)
No matches.  No recipients.
"KRN",.84,39039,5,0)
^.841^1^1
"KRN",.84,39039,5,1,0)
XMXADDR2
"KRN",.84,39039,5,"B","XMXADDR2",1)

"KRN",.84,39040,-1)
0^1262
"KRN",.84,39040,0)
39040^2^^MAILMAN^B:Broadcast to all local users
"KRN",.84,39040,1,0)
^^1^1^2991103^
"KRN",.84,39040,1,1,0)
Used in DIR set of codes.
"KRN",.84,39040,2,0)
^^1^1^2991103^^
"KRN",.84,39040,2,1,0)
B:Broadcast to all local users
"KRN",.84,39040,5,0)
^.841^1^1
"KRN",.84,39040,5,1,0)
XMXADDR2
"KRN",.84,39040,5,"B","XMXADDR2",1)

"KRN",.84,39041,-1)
0^1263
"KRN",.84,39041,0)
39041^2^^MAILMAN^L:Limited broadcast to local users
"KRN",.84,39041,1,0)
^^1^1^2991103^
"KRN",.84,39041,1,1,0)
Used in DIR set of codes.
"KRN",.84,39041,2,0)
^^1^1^2991103^^
"KRN",.84,39041,2,1,0)
L:Limited broadcast to local users
"KRN",.84,39041,5,0)
^.841^1^1
"KRN",.84,39041,5,1,0)
XMXADDR2
"KRN",.84,39041,5,"B","XMXADDR2",1)

"KRN",.84,39042,-1)
0^1264
"KRN",.84,39042,0)
39042^2^^MAILMAN^Broadcast type
"KRN",.84,39042,2,0)
^^1^1^2991029^
"KRN",.84,39042,2,1,0)
Broadcast type
"KRN",.84,39042,5,0)
^.841^1^1
"KRN",.84,39042,5,1,0)
XMXADDR2
"KRN",.84,39042,5,"B","XMXADDR2",1)

"KRN",.84,39043,-1)
0^1265
"KRN",.84,39043,0)
39043^3^^MAILMAN^Enter B to broadcast to all local users
"KRN",.84,39043,2,0)
^^8^8^2991029^
"KRN",.84,39043,2,1,0)
Enter B to broadcast to all local users.
"KRN",.84,39043,2,2,0)

"KRN",.84,39043,2,3,0)
Enter L to broadcast to a subset of local users.  Limited broadcasts
"KRN",.84,39043,2,4,0)
are to local users who have something in common, such as belonging
"KRN",.84,39043,2,5,0)
to the same DIVISION, or holding the same PRIMARY MENU.
"KRN",.84,39043,2,6,0)

"KRN",.84,39043,2,7,0)
The LIMITED BROADCASTs from which you may choose are defined by
"KRN",.84,39043,2,8,0)
your IRM in the MAILMAN SITE PARAMETERS file.
"KRN",.84,39043,5,0)
^.841^1^1
"KRN",.84,39043,5,1,0)
XMXADDR2
"KRN",.84,39043,5,"B","XMXADDR2",1)

"KRN",.84,39044,-1)
0^1266
"KRN",.84,39044,0)
39044^1^y^MAILMAN^Limited Broadcast entry |1|, field |2| is 
"KRN",.84,39044,2,0)
^^1^1^2991220^^^^
"KRN",.84,39044,2,1,0)
Limited Broadcast entry |1|, field |2| is null.
"KRN",.84,39044,3,0)
^.845^2^2
"KRN",.84,39044,3,1,0)
1^entry ien
"KRN",.84,39044,3,2,0)
2^field number
"KRN",.84,39044,5,0)
^.841^1^1
"KRN",.84,39044,5,1,0)
XMXADDR2
"KRN",.84,39044,5,"B","XMXADDR2",1)

"KRN",.84,39045,-1)
0^1267
"KRN",.84,39045,0)
39045^1^y^MAILMAN^Limited Broadcast entry |1|, field |2|:
"KRN",.84,39045,2,0)
^^1^1^2991220^^^
"KRN",.84,39045,2,1,0)
Limited Broadcast entry |1|, field |2|: '|3|' does not exist.
"KRN",.84,39045,3,0)
^.845^3^3
"KRN",.84,39045,3,1,0)
1^entry ien
"KRN",.84,39045,3,2,0)
2^field number
"KRN",.84,39045,3,3,0)
3^field value
"KRN",.84,39045,5,0)
^.841^1^1
"KRN",.84,39045,5,1,0)
XMXADDR2
"KRN",.84,39045,5,"B","XMXADDR2",1)

"KRN",.84,39046,-1)
0^1268
"KRN",.84,39046,0)
39046^2^y^MAILMAN^Select Limited Broadcast |1|:
"KRN",.84,39046,2,0)
^^1^1^2991030^
"KRN",.84,39046,2,1,0)
Select Limited Broadcast |1|: 
"KRN",.84,39046,3,0)
^.845^1^1
"KRN",.84,39046,3,1,0)
1^broadcast name
"KRN",.84,39046,5,0)
^.841^1^1
"KRN",.84,39046,5,1,0)
XMXADDR2
"KRN",.84,39046,5,"B","XMXADDR2",1)

"KRN",.84,39047,-1)
0^1269
"KRN",.84,39047,0)
39047^1^^MAILMAN^Limited Broadcast selection is null.
"KRN",.84,39047,2,0)
^^1^1^2991030^^
"KRN",.84,39047,2,1,0)
Limited Broadcast selection is null.
"KRN",.84,39047,3,0)
^.845^^0
"KRN",.84,39047,5,0)
^.841^1^1
"KRN",.84,39047,5,1,0)
XMXADDR2
"KRN",.84,39047,5,"B","XMXADDR2",1)

"KRN",.84,39047.5,-1)
0^1270
"KRN",.84,39047.5,0)
39047.5^1^^MAILMAN^Limited Broadcast parameter value is null
"KRN",.84,39047.5,2,0)
^^1^1^2991030^^
"KRN",.84,39047.5,2,1,0)
Limited Broadcast parameter value is null.
"KRN",.84,39047.5,5,0)
^.841^1^1
"KRN",.84,39047.5,5,1,0)
XMXADDR2
"KRN",.84,39047.5,5,"B","XMXADDR2",1)

"KRN",.84,39048,-1)
0^1271
"KRN",.84,39048,0)
39048^1^y^MAILMAN^Limited Broadcast selection not found: |1|
"KRN",.84,39048,2,0)
^^1^1^2991030^
"KRN",.84,39048,2,1,0)
Limited Broadcast selection not found: |1|
"KRN",.84,39048,3,0)
^.845^1^1
"KRN",.84,39048,3,1,0)
1^broadcast name user entered
"KRN",.84,39048,5,0)
^.841^1^1
"KRN",.84,39048,5,1,0)
XMXADDR2
"KRN",.84,39048,5,"B","XMXADDR2",1)

"KRN",.84,39049,-1)
0^1272
"KRN",.84,39049,0)
39049^1^y^MAILMAN^Limited Broadcast selection ambiguous:
"KRN",.84,39049,2,0)
^^1^1^2991030^
"KRN",.84,39049,2,1,0)
Limited Broadcast selection ambiguous: |1|
"KRN",.84,39049,3,0)
^.845^1^1
"KRN",.84,39049,3,1,0)
1^broadcast name user entered
"KRN",.84,39049,5,0)
^.841^1^1
"KRN",.84,39049,5,1,0)
XMXADDR2
"KRN",.84,39049,5,"B","XMXADDR2",1)

"KRN",.84,39050,-1)
0^1273
"KRN",.84,39050,0)
39050^1^y^MAILMAN^Limited Broadcast value '|1|' not found
"KRN",.84,39050,2,0)
^^1^1^2991030^^
"KRN",.84,39050,2,1,0)
Limited Broadcast value '|1|' not found in file |2|.
"KRN",.84,39050,3,0)
^.845^2^2
"KRN",.84,39050,3,1,0)
1^value looked for in pointed to file
"KRN",.84,39050,3,2,0)
2^file number of pointed to file
"KRN",.84,39050,5,0)
^.841^1^1
"KRN",.84,39050,5,1,0)
XMXADDR2
"KRN",.84,39050,5,"B","XMXADDR2",1)

"KRN",.84,39051,-1)
0^1274
"KRN",.84,39051,0)
39051^1^y^MAILMAN^Limited Broadcast value '|1|' ambiguous
"KRN",.84,39051,2,0)
^^1^1^2991030^
"KRN",.84,39051,2,1,0)
Limited Broadcast value '|1|' ambiguous in file |2|.
"KRN",.84,39051,3,0)
^.845^2^2
"KRN",.84,39051,3,1,0)
1^value searched for in pointed to file
"KRN",.84,39051,3,2,0)
2^file number of pointed to file
"KRN",.84,39051,5,0)
^.841^1^1
"KRN",.84,39051,5,1,0)
XMXADDR2
"KRN",.84,39051,5,"B","XMXADDR2",1)

"KRN",.84,39052,-1)
0^1275
"KRN",.84,39052,0)
39052^2^^MAILMAN^Do you want to see more Limited Broad
"KRN",.84,39052,2,0)
^^1^1^2991030^
"KRN",.84,39052,2,1,0)
Do you want to see more Limited Broadcast recipients
"KRN",.84,39052,5,0)
^.841^1^1
"KRN",.84,39052,5,1,0)
XMXADDR2
"KRN",.84,39052,5,"B","XMXADDR2",1)

"KRN",.84,39053,-1)
0^1276
"KRN",.84,39053,0)
39053^2^^MAILMAN^No
"KRN",.84,39053,2,0)
^^1^1^2991030^
"KRN",.84,39053,2,1,0)
No
"KRN",.84,39053,5,0)
^.841^3^3
"KRN",.84,39053,5,1,0)
XMXADDR2
"KRN",.84,39053,5,2,0)
XMJMT
"KRN",.84,39053,5,3,0)
XMJMR
"KRN",.84,39053,5,"B","XMJMR",3)

"KRN",.84,39053,5,"B","XMJMT",2)

"KRN",.84,39053,5,"B","XMXADDR2",1)

"KRN",.84,39054,-1)
0^1277
"KRN",.84,39054,0)
39054^2^^MAILMAN^Yes
"KRN",.84,39054,2,0)
^^1^1^2991102^
"KRN",.84,39054,2,1,0)
Yes
"KRN",.84,39054,5,0)
^.841^7^7
"KRN",.84,39054,5,1,0)
XMJMT
"KRN",.84,39054,5,2,0)
XMJMOI
"KRN",.84,39054,5,3,0)
XMJMOI1
"KRN",.84,39054,5,4,0)
XMJMSO
"KRN",.84,39054,5,5,0)
XMUT2
"KRN",.84,39054,5,6,0)
XMUT5
"KRN",.84,39054,5,7,0)
XMXSEND
"KRN",.84,39054,5,"B","XMJMOI",2)

"KRN",.84,39054,5,"B","XMJMOI1",3)

"KRN",.84,39054,5,"B","XMJMSO",4)

"KRN",.84,39054,5,"B","XMJMT",1)

"KRN",.84,39054,5,"B","XMUT2",5)

"KRN",.84,39054,5,"B","XMUT5",6)

"KRN",.84,39054,5,"B","XMXSEND",7)

"KRN",.84,39054.1,-1)
0^1278
"KRN",.84,39054.1,0)
39054.1^2^^MAILMAN^Y
"KRN",.84,39054.1,1,0)
^^1^1^3010821^
"KRN",.84,39054.1,1,1,0)
This is meant to be a one-character symbol, signifying 'yes'.
"KRN",.84,39054.1,2,0)
^^1^1^3010821^
"KRN",.84,39054.1,2,1,0)
Y
"KRN",.84,39054.1,5,0)
^.841^1^1
"KRN",.84,39054.1,5,1,0)
XMUTERM
"KRN",.84,39054.1,5,"B","XMUTERM",1)

"KRN",.84,39060,-1)
0^1279
"KRN",.84,39060,0)
39060^1^^MAILMAN^Invalid server name
"KRN",.84,39060,2,0)
^^1^1^2991030^
"KRN",.84,39060,2,1,0)
Invalid server name
"KRN",.84,39060,5,0)
^.841^1^1
"KRN",.84,39060,5,1,0)
XMXADDR3
"KRN",.84,39060,5,"B","XMXADDR3",1)

"KRN",.84,39061,-1)
0^1280
"KRN",.84,39061,0)
39061^1^^MAILMAN^Server ambiguous
"KRN",.84,39061,2,0)
^^1^1^2991030^
"KRN",.84,39061,2,1,0)
Server ambiguous.
"KRN",.84,39061,5,0)
^.841^1^1
"KRN",.84,39061,5,1,0)
XMXADDR3
"KRN",.84,39061,5,"B","XMXADDR3",1)

"KRN",.84,39062,-1)
0^1281
"KRN",.84,39062,0)
39062^1^^MAILMAN^Server not found.
"KRN",.84,39062,2,0)
^^1^1^2991030^
"KRN",.84,39062,2,1,0)
Server not found.
"KRN",.84,39062,5,0)
^.841^1^1
"KRN",.84,39062,5,1,0)
XMXADDR3
"KRN",.84,39062,5,"B","XMXADDR3",1)

"KRN",.84,39063,-1)
0^1282
"KRN",.84,39063,0)
39063^1^^MAILMAN^Invalid device name
"KRN",.84,39063,2,0)
^^1^1^2991030^
"KRN",.84,39063,2,1,0)
Invalid device name
"KRN",.84,39063,5,0)
^.841^1^1
"KRN",.84,39063,5,1,0)
XMXADDR3
"KRN",.84,39063,5,"B","XMXADDR3",1)

"KRN",.84,39064,-1)
0^1283
"KRN",.84,39064,0)
39064^1^^MAILMAN^Device ambiguous.
"KRN",.84,39064,2,0)
^^1^1^2991030^
"KRN",.84,39064,2,1,0)
Device ambiguous.
"KRN",.84,39064,5,0)
^.841^1^1
"KRN",.84,39064,5,1,0)
XMXADDR3
"KRN",.84,39064,5,"B","XMXADDR3",1)

"KRN",.84,39065,-1)
0^1284
"KRN",.84,39065,0)
39065^1^^MAILMAN^Device not found.
"KRN",.84,39065,2,0)
^^1^1^2991030^
"KRN",.84,39065,2,1,0)
Device not found.
"KRN",.84,39065,5,0)
^.841^1^1
"KRN",.84,39065,5,1,0)
XMXADDR3
"KRN",.84,39065,5,"B","XMXADDR3",1)

"KRN",.84,39066,-1)
0^1285
"KRN",.84,39066,0)
39066^1^^MAILMAN^You may not use P-MESSAGE in an address
"KRN",.84,39066,2,0)
^^1^1^2991030^
"KRN",.84,39066,2,1,0)
You may not use P-MESSAGE in an address.
"KRN",.84,39066,5,0)
^.841^1^1
"KRN",.84,39066,5,1,0)
XMXADDR3
"KRN",.84,39066,5,"B","XMXADDR3",1)

"KRN",.84,39067,-1)
0^1286
"KRN",.84,39067,0)
39067^1^^MAILMAN^You must specify a reachable uunet host
"KRN",.84,39067,2,0)
^^1^1^2991030^
"KRN",.84,39067,2,1,0)
You must specify a reachable uunet host.
"KRN",.84,39067,5,0)
^.841^1^1
"KRN",.84,39067,5,1,0)
XMXADDR3
"KRN",.84,39067,5,"B","XMXADDR3",1)

"KRN",.84,39068,-1)
0^1287
"KRN",.84,39068,0)
39068^1^^MAILMAN^Null domain
"KRN",.84,39068,2,0)
^^1^1^2991030^
"KRN",.84,39068,2,1,0)
Null domain
"KRN",.84,39068,5,0)
^.841^1^1
"KRN",.84,39068,5,1,0)
XMXADDR3
"KRN",.84,39068,5,"B","XMXADDR3",1)

"KRN",.84,39069,-1)
0^1288
"KRN",.84,39069,0)
39069^2^y^MAILMAN^Checking: |1|
"KRN",.84,39069,2,0)
^^1^1^2991030^
"KRN",.84,39069,2,1,0)
Checking: |1|
"KRN",.84,39069,3,0)
^.845^1^1
"KRN",.84,39069,3,1,0)
1^name being checked
"KRN",.84,39069,5,0)
^.841^1^1
"KRN",.84,39069,5,1,0)
XMXADDR3
"KRN",.84,39069,5,"B","XMXADDR3",1)

"KRN",.84,39080,-1)
0^1289
"KRN",.84,39080,0)
39080^2^^MAILMAN^Distribution List:
"KRN",.84,39080,2,0)
^^1^1^2991030^
"KRN",.84,39080,2,1,0)
Distribution List: 
"KRN",.84,39080,5,0)
^.841^2^2
"KRN",.84,39080,5,1,0)
XMXADDR4
"KRN",.84,39080,5,2,0)
XMHIG
"KRN",.84,39080,5,"B","XMHIG",2)

"KRN",.84,39080,5,"B","XMXADDR4",1)

"KRN",.84,39081,-1)
0^1290
"KRN",.84,39081,0)
39081^2^^MAILMAN^Fax Group:
"KRN",.84,39081,2,0)
^^1^1^2991030^
"KRN",.84,39081,2,1,0)
Fax Group: 
"KRN",.84,39081,5,0)
^.841^2^2
"KRN",.84,39081,5,1,0)
XMXADDR4
"KRN",.84,39081,5,2,0)
XMHIG
"KRN",.84,39081,5,"B","XMHIG",2)

"KRN",.84,39081,5,"B","XMXADDR4",1)

"KRN",.84,39082,-1)
0^1291
"KRN",.84,39082,0)
39082^2^^MAILMAN^Fax Recipient:
"KRN",.84,39082,2,0)
^^1^1^2991030^
"KRN",.84,39082,2,1,0)
Fax Recipient: 
"KRN",.84,39082,5,0)
^.841^2^2
"KRN",.84,39082,5,1,0)
XMXADDR4
"KRN",.84,39082,5,2,0)
XMHIG
"KRN",.84,39082,5,"B","XMHIG",2)

"KRN",.84,39082,5,"B","XMXADDR4",1)

"KRN",.84,39083,-1)
0^1292
"KRN",.84,39083,0)
39083^1^y^MAILMAN^Problems in member group: |1| (IEN=|2|)
"KRN",.84,39083,2,0)
^^1^1^2991030^
"KRN",.84,39083,2,1,0)
Problems in member group: |1| (IEN=|2|)
"KRN",.84,39083,3,0)
^.845^2^2
"KRN",.84,39083,3,1,0)
2^group ien
"KRN",.84,39083,3,2,0)
1^group name
"KRN",.84,39083,5,0)
^.841^1^1
"KRN",.84,39083,5,1,0)
XMXADDR4
"KRN",.84,39083,5,"B","XMXADDR4",1)

"KRN",.84,39084,-1)
0^1293
"KRN",.84,39084,0)
39084^1^^MAILMAN^Local Member:
"KRN",.84,39084,2,0)
^^1^1^2991030^^
"KRN",.84,39084,2,1,0)
Local Member: 
"KRN",.84,39084,5,0)
^.841^1^1
"KRN",.84,39084,5,1,0)
XMXADDR4
"KRN",.84,39084,5,"B","XMXADDR4",1)

"KRN",.84,39085,-1)
0^1294
"KRN",.84,39085,0)
39085^1^^MAILMAN^Remote Member:
"KRN",.84,39085,2,0)
^^1^1^2991030^^
"KRN",.84,39085,2,1,0)
Remote Member: 
"KRN",.84,39085,5,0)
^.841^2^2
"KRN",.84,39085,5,1,0)
XMXADDR4
"KRN",.84,39085,5,2,0)
XMHIG
"KRN",.84,39085,5,"B","XMHIG",2)

"KRN",.84,39085,5,"B","XMXADDR4",1)

"KRN",.84,39086,-1)
0^1295
"KRN",.84,39086,0)
39086^1^^MAILMAN^Distribution List Domain:
"KRN",.84,39086,2,0)
^^1^1^2991030^^
"KRN",.84,39086,2,1,0)
Distribution List Domain: 
"KRN",.84,39086,5,0)
^.841^1^1
"KRN",.84,39086,5,1,0)
XMXADDR4
"KRN",.84,39086,5,"B","XMXADDR4",1)

"KRN",.84,39087,-1)
0^1296
"KRN",.84,39087,0)
39087^1^^MAILMAN^Circular Group Reference:
"KRN",.84,39087,2,0)
^^1^1^2991030^^^
"KRN",.84,39087,2,1,0)
Circular Group Reference: 
"KRN",.84,39087,5,0)
^.841^1^1
"KRN",.84,39087,5,1,0)
XMXADDR4
"KRN",.84,39087,5,"B","XMXADDR4",1)

"KRN",.84,39088,-1)
0^1297
"KRN",.84,39088,0)
39088^1^^MAILMAN^Error:
"KRN",.84,39088,2,0)
^^1^1^2991030^
"KRN",.84,39088,2,1,0)
Error: 
"KRN",.84,39088,5,0)
^.841^2^2
"KRN",.84,39088,5,1,0)
XMXADDR4
"KRN",.84,39088,5,2,0)
XMXADDRD
"KRN",.84,39088,5,"B","XMXADDR4",1)

"KRN",.84,39088,5,"B","XMXADDRD",2)

"KRN",.84,39089,-1)
0^1298
"KRN",.84,39089,0)
39089^2^^MAILMAN^Authorized Sender:
"KRN",.84,39089,2,0)
^^1^1^2991101^
"KRN",.84,39089,2,1,0)
Authorized Sender: 
"KRN",.84,39089,5,0)
^.841^1^1
"KRN",.84,39089,5,1,0)
XMHIG
"KRN",.84,39089,5,"B","XMHIG",1)

"KRN",.84,39090,-1)
0^1299
"KRN",.84,39090,0)
39090^2^^MAILMAN^Member Group:
"KRN",.84,39090,2,0)
^^1^1^2991101^
"KRN",.84,39090,2,1,0)
Member Group: 
"KRN",.84,39090,5,0)
^.841^1^1
"KRN",.84,39090,5,1,0)
XMHIG
"KRN",.84,39090,5,"B","XMHIG",1)

"KRN",.84,39091,-1)
0^1300
"KRN",.84,39091,0)
39091^2^^MAILMAN^Member           Last Used MailMan
"KRN",.84,39091,2,0)
^^1^1^2991102^^
"KRN",.84,39091,2,1,0)
Member                                       Last Used MailMan
"KRN",.84,39091,5,0)
^.841^1^1
"KRN",.84,39091,5,1,0)
XMHIG
"KRN",.84,39091,5,"B","XMHIG",1)

"KRN",.84,39092,-1)
0^1301
"KRN",.84,39092,0)
39092^2^y^MAILMAN^ (To |1| Domains)
"KRN",.84,39092,2,0)
^^1^1^2991101^
"KRN",.84,39092,2,1,0)
 (To |1| Domains)
"KRN",.84,39092,3,0)
^.845^1^1
"KRN",.84,39092,3,1,0)
1^number of domains
"KRN",.84,39092,5,0)
^.841^1^1
"KRN",.84,39092,5,1,0)
XMHIG
"KRN",.84,39092,5,"B","XMHIG",1)

"KRN",.84,39093,-1)
0^1302
"KRN",.84,39093,0)
39093^2^^MAILMAN^Member of Group: 
"KRN",.84,39093,1,0)
^^1^1^3000503^
"KRN",.84,39093,1,1,0)
There's a blank at the end of the dialog.
"KRN",.84,39093,2,0)
^^1^1^3000503^
"KRN",.84,39093,2,1,0)
Member of Group: 
"KRN",.84,39093,5,0)
^.841^1^1
"KRN",.84,39093,5,1,0)
XMHIG
"KRN",.84,39093,5,"B","XMHIG",1)

"KRN",.84,39100,-1)
0^1303
"KRN",.84,39100,0)
39100^1^y^MAILMAN^Domain not found: |1|
"KRN",.84,39100,2,0)
^^1^1^2991030^
"KRN",.84,39100,2,1,0)
Domain not found: |1|
"KRN",.84,39100,3,0)
^.845^1^1
"KRN",.84,39100,3,1,0)
1^domain name
"KRN",.84,39100,5,0)
^.841^1^1
"KRN",.84,39100,5,1,0)
XMXADDRD
"KRN",.84,39100,5,"B","XMXADDRD",1)

"KRN",.84,39101,-1)
0^1304
"KRN",.84,39101,0)
39101^2^y^MAILMAN^ via |1|
"KRN",.84,39101,2,0)
^^1^1^2991030^
"KRN",.84,39101,2,1,0)
 via |1|
"KRN",.84,39101,3,0)
^.845^1^1
"KRN",.84,39101,3,1,0)
1^via which domain?
"KRN",.84,39101,5,0)
^.841^1^1
"KRN",.84,39101,5,1,0)
XMXADDRD
"KRN",.84,39101,5,"B","XMXADDRD",1)

"KRN",.84,39102,-1)
0^1305
"KRN",.84,39102,0)
39102^2^^MAILMAN^ (Queued)
"KRN",.84,39102,2,0)
^^1^1^2991030^
"KRN",.84,39102,2,1,0)
 (Queued)
"KRN",.84,39102,5,0)
^.841^1^1
"KRN",.84,39102,5,1,0)
XMXADDRD
"KRN",.84,39102,5,"B","XMXADDRD",1)

"KRN",.84,39103,-1)
0^1306
"KRN",.84,39103,0)
39103^1^y^MAILMAN^Sub-domain '|1|' not found for domain
"KRN",.84,39103,2,0)
^^1^1^2991030^
"KRN",.84,39103,2,1,0)
Sub-domain '|1|' not found for domain '|2|'
"KRN",.84,39103,3,0)
^.845^2^2
"KRN",.84,39103,3,1,0)
1^subdomain name
"KRN",.84,39103,3,2,0)
2^domain name
"KRN",.84,39103,5,0)
^.841^1^1
"KRN",.84,39103,5,1,0)
XMXADDRD
"KRN",.84,39103,5,"B","XMXADDRD",1)

"KRN",.84,39104,-1)
0^1307
"KRN",.84,39104,0)
39104^1^y^MAILMAN^Valid domain, but need subdomain: |1|
"KRN",.84,39104,2,0)
^^1^1^2991030^
"KRN",.84,39104,2,1,0)
Valid domain, but need subdomain: |1|
"KRN",.84,39104,3,0)
^.845^1^1
"KRN",.84,39104,3,1,0)
1^domain name
"KRN",.84,39104,5,0)
^.841^1^1
"KRN",.84,39104,5,1,0)
XMXADDRD
"KRN",.84,39104,5,"B","XMXADDRD",1)

"KRN",.84,39105,-1)
0^1308
"KRN",.84,39105,0)
39105^1^y^MAILMAN^Domain |1| is a valid Internet domain,
"KRN",.84,39105,2,0)
^^2^2^2991030^
"KRN",.84,39105,2,1,0)
Domain |1| is a valid Internet domain,
"KRN",.84,39105,2,2,0)
but you must specify at least one sub-domain.
"KRN",.84,39105,3,0)
^.845^1^1
"KRN",.84,39105,3,1,0)
1^Internet domain
"KRN",.84,39105,5,0)
^.841^1^1
"KRN",.84,39105,5,1,0)
XMXADDRD
"KRN",.84,39105,5,"B","XMXADDRD",1)

"KRN",.84,39106,-1)
0^1309
"KRN",.84,39106,0)
39106^1^y^MAILMAN^Domain ambiguous: |1|
"KRN",.84,39106,2,0)
^^1^1^2991030^
"KRN",.84,39106,2,1,0)
Domain ambiguous: |1|
"KRN",.84,39106,3,0)
^.845^1^1
"KRN",.84,39106,3,1,0)
1^ambiguous domain name
"KRN",.84,39106,5,0)
^.841^1^1
"KRN",.84,39106,5,1,0)
XMXADDRD
"KRN",.84,39106,5,"B","XMXADDRD",1)

"KRN",.84,39107,-1)
0^1310
"KRN",.84,39107,0)
39107^1^y^MAILMAN^Circular relay domain: |1|
"KRN",.84,39107,2,0)
^^1^1^2991030^
"KRN",.84,39107,2,1,0)
Circular relay domain: |1|
"KRN",.84,39107,3,0)
^.845^1^1
"KRN",.84,39107,3,1,0)
1^relay domain name
"KRN",.84,39107,5,0)
^.841^1^1
"KRN",.84,39107,5,1,0)
XMXADDRD
"KRN",.84,39107,5,"B","XMXADDRD",1)

"KRN",.84,39108,-1)
0^1311
"KRN",.84,39108,0)
39108^1^^MAILMAN^Domain may not contain punctuation other
"KRN",.84,39108,2,0)
^^1^1^2991030^
"KRN",.84,39108,2,1,0)
Domain may not contain punctuation other than '.' or '-'.
"KRN",.84,39108,5,0)
^.841^1^1
"KRN",.84,39108,5,1,0)
XMXADDRD
"KRN",.84,39108,5,"B","XMXADDRD",1)

"KRN",.84,39109,-1)
0^1312
"KRN",.84,39109,0)
39109^1^y^MAILMAN^Domain must be from 1 to |1| char
"KRN",.84,39109,2,0)
^^1^1^2991030^
"KRN",.84,39109,2,1,0)
Domain must be from 1 to |1| characters.
"KRN",.84,39109,3,0)
^.845^1^1
"KRN",.84,39109,3,1,0)
1^max chars in domain name
"KRN",.84,39109,5,0)
^.841^1^1
"KRN",.84,39109,5,1,0)
XMXADDRD
"KRN",.84,39109,5,"B","XMXADDRD",1)

"KRN",.84,39110,-1)
0^1313
"KRN",.84,39110,0)
39110^1^y^MAILMAN^Domain dot pieces must be from 1 to |1|
"KRN",.84,39110,2,0)
^^1^1^2991030^
"KRN",.84,39110,2,1,0)
Domain dot pieces must be from 1 to |1| characters.
"KRN",.84,39110,3,0)
^.845^1^1
"KRN",.84,39110,3,1,0)
1^max chars for domain dot piece
"KRN",.84,39110,5,0)
^.841^1^1
"KRN",.84,39110,5,1,0)
XMXADDRD
"KRN",.84,39110,5,"B","XMXADDRD",1)

"KRN",.84,39111,-1)
0^1314
"KRN",.84,39111,0)
39111^1^^MAILMAN^Domain dot pieces must begin with a letter
"KRN",.84,39111,2,0)
^^1^1^2991030^
"KRN",.84,39111,2,1,0)
Domain dot pieces must begin with a letter or number.
"KRN",.84,39111,5,0)
^.841^1^1
"KRN",.84,39111,5,1,0)
XMXADDRD
"KRN",.84,39111,5,"B","XMXADDRD",1)

"KRN",.84,39112,-1)
0^1315
"KRN",.84,39112,0)
39112^1^y^MAILMAN^|1| is not valid.
"KRN",.84,39112,2,0)
^^1^1^2991030^
"KRN",.84,39112,2,1,0)
|1| is not valid.
"KRN",.84,39112,3,0)
^.845^1^1
"KRN",.84,39112,3,1,0)
1^invalid domain name
"KRN",.84,39112,5,0)
^.841^1^1
"KRN",.84,39112,5,1,0)
XMXADDRD
"KRN",.84,39112,5,"B","XMXADDRD",1)

"KRN",.84,39113,-1)
0^1316
"KRN",.84,39113,0)
39113^2^^MAILMAN^Looking in Internet Suffix file...
"KRN",.84,39113,2,0)
^^1^1^2991030^
"KRN",.84,39113,2,1,0)
Looking in Internet Suffix file...
"KRN",.84,39113,5,0)
^.841^1^1
"KRN",.84,39113,5,1,0)
XMXADDRD
"KRN",.84,39113,5,"B","XMXADDRD",1)

"KRN",.84,39114,-1)
0^1317
"KRN",.84,39114,0)
39114^1^y^MAILMAN^Domain closed: |1|
"KRN",.84,39114,2,0)
^^1^1^2991030^
"KRN",.84,39114,2,1,0)
Domain closed: |1|
"KRN",.84,39114,3,0)
^.845^1^1
"KRN",.84,39114,3,1,0)
1^closed domain name
"KRN",.84,39114,5,0)
^.841^1^1
"KRN",.84,39114,5,1,0)
XMXADDRD
"KRN",.84,39114,5,"B","XMXADDRD",1)

"KRN",.84,39115,-1)
0^1318
"KRN",.84,39115,0)
39115^1^y^MAILMAN^You don't hold key to domain '|1|'.
"KRN",.84,39115,2,0)
^^1^1^2991030^
"KRN",.84,39115,2,1,0)
You don't hold key to domain '|1|'.
"KRN",.84,39115,3,0)
^.845^1^1
"KRN",.84,39115,3,1,0)
1^domain name
"KRN",.84,39115,5,0)
^.841^1^1
"KRN",.84,39115,5,1,0)
XMXADDRD
"KRN",.84,39115,5,"B","XMXADDRD",1)

"KRN",.84,39116,-1)
0^1319
"KRN",.84,39116,0)
39116^1^^MAILMAN^Domain dot pieces must not match Internet
"KRN",.84,39116,2,0)
^^1^1^2991030^
"KRN",.84,39116,2,1,0)
Domain dot pieces must not match Internet reserved domain names.
"KRN",.84,39116,5,0)
^.841^1^1
"KRN",.84,39116,5,1,0)
XMXADDRD
"KRN",.84,39116,5,"B","XMXADDRD",1)

"KRN",.84,39130,-1)
0^1320
"KRN",.84,39130,0)
39130^1^^MAILMAN^Must be sender or hold XM GROUP PRIORITY
"KRN",.84,39130,2,0)
^^1^1^2991221^^^
"KRN",.84,39130,2,1,0)
Must be sender or hold XM GROUP PRIORITY key to forward priority mail to groups.
"KRN",.84,39130,5,0)
^.841^1^1
"KRN",.84,39130,5,1,0)
XMXADDRG
"KRN",.84,39130,5,"B","XMXADDRG",1)

"KRN",.84,39131,-1)
0^1321
"KRN",.84,39131,0)
39131^1^^MAILMAN^Mail group ambiguous.
"KRN",.84,39131,2,0)
^^1^1^2991031^
"KRN",.84,39131,2,1,0)
Mail group ambiguous.
"KRN",.84,39131,5,0)
^.841^1^1
"KRN",.84,39131,5,1,0)
XMXADDRG
"KRN",.84,39131,5,"B","XMXADDRG",1)

"KRN",.84,39132,-1)
0^1322
"KRN",.84,39132,0)
39132^1^^MAILMAN^Mail group not found.
"KRN",.84,39132,2,0)
^^1^1^2991031^
"KRN",.84,39132,2,1,0)
Mail group not found.
"KRN",.84,39132,5,0)
^.841^1^1
"KRN",.84,39132,5,1,0)
XMXADDRG
"KRN",.84,39132,5,"B","XMXADDRG",1)

"KRN",.84,39133,-1)
0^1323
"KRN",.84,39133,0)
39133^1^^MAILMAN^Sender not authorized to group.
"KRN",.84,39133,2,0)
^^1^1^2991031^
"KRN",.84,39133,2,1,0)
Sender not authorized to group.
"KRN",.84,39133,5,0)
^.841^1^1
"KRN",.84,39133,5,1,0)
XMXADDRG
"KRN",.84,39133,5,"B","XMXADDRG",1)

"KRN",.84,39134,-1)
0^1324
"KRN",.84,39134,0)
39134^1^^MAILMAN^You may not send mail directly to this
"KRN",.84,39134,2,0)
^^2^2^3000103^^
"KRN",.84,39134,2,1,0)
You may not send mail directly to this group.
"KRN",.84,39134,2,2,0)
You must send it to an authorized sender for the group.
"KRN",.84,39134,5,0)
^.841^1^1
"KRN",.84,39134,5,1,0)
XMXADDRG
"KRN",.84,39134,5,"B","XMXADDRG",1)

"KRN",.84,39135,-1)
0^1325
"KRN",.84,39135,0)
39135^2^^MAILMAN^ [Private Mail Group]
"KRN",.84,39135,2,0)
^^1^1^2991031^
"KRN",.84,39135,2,1,0)
 [Private Mail Group]
"KRN",.84,39135,5,0)
^.841^3^3
"KRN",.84,39135,5,1,0)
XMXADDRG
"KRN",.84,39135,5,2,0)
XMXSEND
"KRN",.84,39135,5,3,0)
XMTDT
"KRN",.84,39135,5,"B","XMTDT",3)

"KRN",.84,39135,5,"B","XMXADDRG",1)

"KRN",.84,39135,5,"B","XMXSEND",2)

"KRN",.84,39136,-1)
0^1326
"KRN",.84,39136,0)
39136^2^^MAILMAN^  Deleting Members ...
"KRN",.84,39136,2,0)
^^1^1^2991031^
"KRN",.84,39136,2,1,0)
 Deleting Members ...
"KRN",.84,39136,5,0)
^.841^1^1
"KRN",.84,39136,5,1,0)
XMXADDRG
"KRN",.84,39136,5,"B","XMXADDRG",1)

"KRN",.84,39137,-1)
0^1327
"KRN",.84,39137,0)
39137^1^^MAILMAN^Mail group has no members.
"KRN",.84,39137,2,0)
^^1^1^3000824^
"KRN",.84,39137,2,1,0)
Mail group has no members.
"KRN",.84,39137,5,0)
^.841^1^1
"KRN",.84,39137,5,1,0)
XMXADDRG
"KRN",.84,39137,5,"B","XMXADDRG",1)

"KRN",.84,39138,-1)
0^1328
"KRN",.84,39138,0)
39138^2^^MAILMAN^Would you like to queue this group for
"KRN",.84,39138,2,0)
^^4^4^2991031^^
"KRN",.84,39138,2,1,0)
This group seems to be fairly big.  If you don't need to 'minus' anyone
"KRN",.84,39138,2,2,0)
from it, then you can save some time by queuing it for 'Later' delivery.
"KRN",.84,39138,2,3,0)
 
"KRN",.84,39138,2,4,0)
Would you like to queue this group for later delivery
"KRN",.84,39138,5,0)
^.841^1^1
"KRN",.84,39138,5,1,0)
XMXADDRG
"KRN",.84,39138,5,"B","XMXADDRG",1)

"KRN",.84,39139,-1)
0^1329
"KRN",.84,39139,0)
39139^2^^MAILMAN^Answer NO if
"KRN",.84,39139,2,0)
^^6^6^2991031^
"KRN",.84,39139,2,1,0)
Answer NO if
"KRN",.84,39139,2,2,0)
 - You need to delete any group members from the message.
"KRN",.84,39139,2,3,0)
 
"KRN",.84,39139,2,4,0)
Answer YES if
"KRN",.84,39139,2,5,0)
 - You don't need to delete any group members from the message
"KRN",.84,39139,2,6,0)
 - and you'd like to save a bit of time.
"KRN",.84,39139,5,0)
^.841^1^1
"KRN",.84,39139,5,1,0)
XMXADDRG
"KRN",.84,39139,5,"B","XMXADDRG",1)

"KRN",.84,39140,-1)
0^1330
"KRN",.84,39140,0)
39140^1^y^MAILMAN^Mail group contains circular reference
"KRN",.84,39140,2,0)
^^3^3^2991031^
"KRN",.84,39140,2,1,0)
Mail group contains circular reference to G.|1|.
"KRN",.84,39140,2,2,0)
Circular reference ignored.
"KRN",.84,39140,2,3,0)
This circular reference should be investigated and eliminated.
"KRN",.84,39140,3,0)
^.845^1^1
"KRN",.84,39140,3,1,0)
1^mail group name
"KRN",.84,39140,5,0)
^.841^1^1
"KRN",.84,39140,5,1,0)
XMXADDRG
"KRN",.84,39140,5,"B","XMXADDRG",1)

"KRN",.84,39141,-1)
0^1331
"KRN",.84,39141,0)
39141^2^^MAILMAN^Local
"KRN",.84,39141,2,0)
^^1^1^2991031^
"KRN",.84,39141,2,1,0)
Local
"KRN",.84,39141,5,0)
^.841^1^1
"KRN",.84,39141,5,1,0)
XMXADDRG
"KRN",.84,39141,5,"B","XMXADDRG",1)

"KRN",.84,39142,-1)
0^1332
"KRN",.84,39142,0)
39142^2^^MAILMAN^Member Group(s)
"KRN",.84,39142,2,0)
^^1^1^2991031^
"KRN",.84,39142,2,1,0)
Member Group(s)
"KRN",.84,39142,5,0)
^.841^1^1
"KRN",.84,39142,5,1,0)
XMXADDRG
"KRN",.84,39142,5,"B","XMXADDRG",1)

"KRN",.84,39143,-1)
0^1333
"KRN",.84,39143,0)
39143^2^^MAILMAN^Remote
"KRN",.84,39143,2,0)
^^1^1^2991031^
"KRN",.84,39143,2,1,0)
Remote
"KRN",.84,39143,5,0)
^.841^1^1
"KRN",.84,39143,5,1,0)
XMXADDRG
"KRN",.84,39143,5,"B","XMXADDRG",1)

"KRN",.84,39144,-1)
0^1334
"KRN",.84,39144,0)
39144^2^^MAILMAN^Distribution List(s)
"KRN",.84,39144,2,0)
^^1^1^2991031^
"KRN",.84,39144,2,1,0)
Distribution List(s)
"KRN",.84,39144,5,0)
^.841^1^1
"KRN",.84,39144,5,1,0)
XMXADDRG
"KRN",.84,39144,5,"B","XMXADDRG",1)

"KRN",.84,39145,-1)
0^1335
"KRN",.84,39145,0)
39145^2^^MAILMAN^Fax Recipient(s)
"KRN",.84,39145,2,0)
^^1^1^2991031^
"KRN",.84,39145,2,1,0)
Fax Recipient(s)
"KRN",.84,39145,5,0)
^.841^1^1
"KRN",.84,39145,5,1,0)
XMXADDRG
"KRN",.84,39145,5,"B","XMXADDRG",1)

"KRN",.84,39146,-1)
0^1336
"KRN",.84,39146,0)
39146^2^^MAILMAN^Fax Group(s)
"KRN",.84,39146,2,0)
^^1^1^2991031^
"KRN",.84,39146,2,1,0)
Fax Group(s)
"KRN",.84,39146,5,0)
^.841^1^1
"KRN",.84,39146,5,1,0)
XMXADDRG
"KRN",.84,39146,5,"B","XMXADDRG",1)

"KRN",.84,39147,-1)
0^1337
"KRN",.84,39147,0)
39147^1^y^MAILMAN^You may not access group '|1|'.
"KRN",.84,39147,2,0)
^^1^1^2991031^^
"KRN",.84,39147,2,1,0)
You may not access group '|1|'.
"KRN",.84,39147,3,0)
^.845^1^1
"KRN",.84,39147,3,1,0)
1^group name
"KRN",.84,39147,5,0)
^.841^1^1
"KRN",.84,39147,5,1,0)
XMXADDRG
"KRN",.84,39147,5,"B","XMXADDRG",1)

"KRN",.84,39148,-1)
0^1338
"KRN",.84,39148,0)
39148^2^^MAILMAN^Do you want to see more members
"KRN",.84,39148,2,0)
^^1^1^2991031^
"KRN",.84,39148,2,1,0)
Do you want to see more members
"KRN",.84,39148,5,0)
^.841^1^1
"KRN",.84,39148,5,1,0)
XMXADDRG
"KRN",.84,39148,5,"B","XMXADDRG",1)

"KRN",.84,39149,-1)
0^1339
"KRN",.84,39149,0)
39149^2^y^MAILMAN^Finished with group |1|.
"KRN",.84,39149,2,0)
^^1^1^2991031^
"KRN",.84,39149,2,1,0)
Finished with group |1|.
"KRN",.84,39149,3,0)
^.845^1^1
"KRN",.84,39149,3,1,0)
1^group name
"KRN",.84,39149,5,0)
^.841^1^1
"KRN",.84,39149,5,1,0)
XMXADDRG
"KRN",.84,39149,5,"B","XMXADDRG",1)

"KRN",.84,39200,-1)
0^1340
"KRN",.84,39200,0)
39200^1^y^MAILMAN^Message |1| is confidential.  SHARED,MAIL
"KRN",.84,39200,2,0)
^^2^2^2991101^
"KRN",.84,39200,2,1,0)
Message |1| is confidential.  SHARED,MAIL removed as recipient.
"KRN",.84,39200,2,2,0)
Confidential messages may not be forwarded to SHARED,MAIL.
"KRN",.84,39200,3,0)
^.845^1^1
"KRN",.84,39200,3,1,0)
1^xmz
"KRN",.84,39200,5,0)
^.841^1^1
"KRN",.84,39200,5,1,0)
XMXMSGS1
"KRN",.84,39200,5,"B","XMXMSGS1",1)

"KRN",.84,39201,-1)
0^1341
"KRN",.84,39201,0)
39201^1^y^MAILMAN^Message |1| is closed.  SHARED,MAIL
"KRN",.84,39201,2,0)
^^2^2^2991101^^
"KRN",.84,39201,2,1,0)
Message |1| is closed.  SHARED,MAIL removed as recipient.
"KRN",.84,39201,2,2,0)
Closed messages may not be forwarded to SHARED,MAIL.
"KRN",.84,39201,3,0)
^.845^1^1
"KRN",.84,39201,3,1,0)
1^xmz
"KRN",.84,39201,5,0)
^.841^1^1
"KRN",.84,39201,5,1,0)
XMXMSGS1
"KRN",.84,39201,5,"B","XMXMSGS1",1)

"KRN",.84,39202,-1)
0^1342
"KRN",.84,39202,0)
39202^1^y^MAILMAN^Priority message |1| not forwarded.
"KRN",.84,39202,2,0)
^^3^3^2991101^
"KRN",.84,39202,2,1,0)
Priority message |1| not forwarded.
"KRN",.84,39202,2,2,0)
Only message originator or XM GROUP PRIORITY key holders
"KRN",.84,39202,2,3,0)
may forward priority messages to groups.
"KRN",.84,39202,3,0)
^.845^1^1
"KRN",.84,39202,3,1,0)
1^xmz
"KRN",.84,39202,5,0)
^.841^1^1
"KRN",.84,39202,5,1,0)
XMXMSGS1
"KRN",.84,39202,5,"B","XMXMSGS1",1)

"KRN",.84,39203,-1)
0^1343
"KRN",.84,39203,0)
39203^1^y^MAILMAN^Message |1| not forwarded to remote
"KRN",.84,39203,2,0)
^^3^3^2991101^
"KRN",.84,39203,2,1,0)
Message |1| not forwarded to remote recipients.
"KRN",.84,39203,2,2,0)
Only XMMGR key holders may forward to remotes sites
"KRN",.84,39203,2,3,0)
messages which exceed site maximum of |2| lines.
"KRN",.84,39203,3,0)
^.845^2^2
"KRN",.84,39203,3,1,0)
1^xmz
"KRN",.84,39203,3,2,0)
2^max lines for remote xmit
"KRN",.84,39203,5,0)
^.841^1^1
"KRN",.84,39203,5,1,0)
XMXMSGS1
"KRN",.84,39203,5,"B","XMXMSGS1",1)

"KRN",.84,39204,-1)
0^1344
"KRN",.84,39204,0)
39204^1^y^MAILMAN^Message |1| has no addressees.  Not
"KRN",.84,39204,2,0)
^^1^1^2991101^
"KRN",.84,39204,2,1,0)
Message |1| has no addressees.  Not forwarded.
"KRN",.84,39204,3,0)
^.845^1^1
"KRN",.84,39204,3,1,0)
1^xmz
"KRN",.84,39204,5,0)
^.841^1^1
"KRN",.84,39204,5,1,0)
XMXMSGS1
"KRN",.84,39204,5,"B","XMXMSGS1",1)

"KRN",.84,39205,-1)
0^5
"KRN",.84,39205,0)
39205^1^y^MAILMAN^Message |1| not forwarded to broadcast.
"KRN",.84,39205,2,0)
^^7^7^3020227^
"KRN",.84,39205,2,1,0)
Message |1| not forwarded to broadcast.
"KRN",.84,39205,2,2,0)

"KRN",.84,39205,2,3,0)
Messages with replies may not be forwarded to broadcast, because
"KRN",.84,39205,2,4,0)
replies are not auto-forwarded to users with auto-forward addresses.
"KRN",.84,39205,2,5,0)

"KRN",.84,39205,2,6,0)
If you wish to broadcast this message, copy it and its replies into
"KRN",.84,39205,2,7,0)
a new message, and broadcast the new message.
"KRN",.84,39205,3,0)
^.845^1^1
"KRN",.84,39205,3,1,0)
1^Message IEN in MESSAGE file 3.9
"KRN",.84,39205,5,0)
^.841^1^1
"KRN",.84,39205,5,1,0)
XMXMSGS1
"KRN",.84,39205,5,"B","XMXMSGS1",1)

"KRN",.84,39300,-1)
0^1345
"KRN",.84,39300,0)
39300^2^^MAILMAN^Server hand off ready
"KRN",.84,39300,2,0)
^^1^1^2991110^
"KRN",.84,39300,2,1,0)
Server hand off ready
"KRN",.84,39300,5,0)
^.841^1^1
"KRN",.84,39300,5,1,0)
XMTDO
"KRN",.84,39300,5,"B","XMTDO",1)

"KRN",.84,39301,-1)
0^1346
"KRN",.84,39301,0)
39301^2^^MAILMAN^Served (hand off done)
"KRN",.84,39301,2,0)
^^1^1^2991110^
"KRN",.84,39301,2,1,0)
Served (hand off done)
"KRN",.84,39301,5,0)
^.841^1^1
"KRN",.84,39301,5,1,0)
XMTDO
"KRN",.84,39301,5,"B","XMTDO",1)

"KRN",.84,39302,-1)
0^1347
"KRN",.84,39302,0)
39302^2^^MAILMAN^Printed
"KRN",.84,39302,2,0)
^.844^1^1^3010416^^
"KRN",.84,39302,2,1,0)
Printed
"KRN",.84,39302,5,0)
^.841^1^1
"KRN",.84,39302,5,1,0)
XMTDO
"KRN",.84,39302,5,"B","XMTDO",1)

"KRN",.84,39303.1,-1)
0^1348
"KRN",.84,39303.1,0)
39303.1^2^^MAILMAN^Awaiting transmission.
"KRN",.84,39303.1,2,0)
^^1^1^3000211^
"KRN",.84,39303.1,2,1,0)
Awaiting transmission.
"KRN",.84,39303.1,5,0)
^.841^1^1
"KRN",.84,39303.1,5,1,0)
XMKP
"KRN",.84,39303.1,5,"B","XMKP",1)

"KRN",.84,39303.2,-1)
0^1349
"KRN",.84,39303.2,0)
39303.2^2^^MAILMAN^Awaiting Server.
"KRN",.84,39303.2,2,0)
^^1^1^3000211^
"KRN",.84,39303.2,2,1,0)
Awaiting Server.
"KRN",.84,39303.2,5,0)
^.841^1^1
"KRN",.84,39303.2,5,1,0)
XMKP
"KRN",.84,39303.2,5,"B","XMKP",1)

"KRN",.84,39303.3,-1)
0^1350
"KRN",.84,39303.3,0)
39303.3^2^^MAILMAN^Awaiting Device.
"KRN",.84,39303.3,2,0)
^^1^1^3000211^
"KRN",.84,39303.3,2,1,0)
Awaiting Device.
"KRN",.84,39303.3,5,0)
^.841^1^1
"KRN",.84,39303.3,5,1,0)
XMKP
"KRN",.84,39303.3,5,"B","XMKP",1)

"KRN",.84,39303.4,-1)
0^1351
"KRN",.84,39303.4,0)
39303.4^2^^MAILMAN^Awaiting H.Device.
"KRN",.84,39303.4,2,0)
^^1^1^3000211^
"KRN",.84,39303.4,2,1,0)
Awaiting H.Device.
"KRN",.84,39303.4,5,0)
^.841^1^1
"KRN",.84,39303.4,5,1,0)
XMKP
"KRN",.84,39303.4,5,"B","XMKP",1)

"KRN",.84,39303.5,-1)
0^1352
"KRN",.84,39303.5,0)
39303.5^2^^MAILMAN^Awaiting Fax.
"KRN",.84,39303.5,2,0)
^^1^1^3000211^
"KRN",.84,39303.5,2,1,0)
Awaiting Fax.
"KRN",.84,39303.5,5,0)
^.841^1^1
"KRN",.84,39303.5,5,1,0)
XMKP
"KRN",.84,39303.5,5,"B","XMKP",1)

"KRN",.84,39303.6,-1)
0^117
"KRN",.84,39303.6,0)
39303.6^2^^MAILMAN^In transit
"KRN",.84,39303.6,2,0)
^^1^1^3020405^
"KRN",.84,39303.6,2,1,0)
In transit
"KRN",.84,39303.6,5,0)
^.841^1^1
"KRN",.84,39303.6,5,1,0)
XMS1
"KRN",.84,39303.6,5,"B","XMS1",1)

"KRN",.84,39303.7,-1)
0^139
"KRN",.84,39303.7,0)
39303.7^2^^MAILMAN^Awaiting Transmission Patch
"KRN",.84,39303.7,2,0)
^^1^1^3020408^
"KRN",.84,39303.7,2,1,0)
Awaiting Transmission Path
"KRN",.84,39303.7,5,0)
^.841^1^1
"KRN",.84,39303.7,5,1,0)
XMFAX
"KRN",.84,39303.7,5,"B","XMFAX",1)

"KRN",.84,39310,-1)
0^1353
"KRN",.84,39310,0)
39310^2^^MAILMAN^MailMan: Send Message Later
"KRN",.84,39310,2,0)
^^1^1^2991112^
"KRN",.84,39310,2,1,0)
MailMan: Send Message Later
"KRN",.84,39310,5,0)
^.841^1^1
"KRN",.84,39310,5,1,0)
XMXSEND
"KRN",.84,39310,5,"B","XMXSEND",1)

"KRN",.84,39311,-1)
0^1354
"KRN",.84,39311,0)
39311^1^^MAILMAN^Task creation failed
"KRN",.84,39311,2,0)
^.844^1^1^3020221^^
"KRN",.84,39311,2,1,0)
Task creation failed.
"KRN",.84,39311,5,0)
^.841^1^1
"KRN",.84,39311,5,1,0)
XMXSEND
"KRN",.84,39311,5,"B","XMXSEND",1)

"KRN",.84,39320,-1)
0^1355
"KRN",.84,39320,0)
39320^1^^MAILMAN^No addressees.  Bulletin not sent.
"KRN",.84,39320,2,0)
^^1^1^2991123^
"KRN",.84,39320,2,1,0)
No addressees.  Bulletin not sent.
"KRN",.84,39320,5,0)
^.841^1^1
"KRN",.84,39320,5,1,0)
XMXBULL
"KRN",.84,39320,5,"B","XMXBULL",1)

"KRN",.84,39321,-1)
0^1356
"KRN",.84,39321,0)
39321^1^^MAILMAN^SHARED,MAIL may not send a bulletin.
"KRN",.84,39321,2,0)
^^1^1^2991123^
"KRN",.84,39321,2,1,0)
SHARED,MAIL may not send a bulletin.
"KRN",.84,39321,5,0)
^.841^1^1
"KRN",.84,39321,5,1,0)
XMXBULL
"KRN",.84,39321,5,"B","XMXBULL",1)

"KRN",.84,39330,-1)
0^134
"KRN",.84,39330,0)
39330^2^y^MAILMAN^Site: |1|
"KRN",.84,39330,2,0)
^^1^1^3020408^
"KRN",.84,39330,2,1,0)
Site: |1|
"KRN",.84,39330,3,0)
^.845^1^1
"KRN",.84,39330,3,1,0)
1^site name
"KRN",.84,39330,5,0)
^.841^1^1
"KRN",.84,39330,5,1,0)
XMFAX
"KRN",.84,39330,5,"B","XMFAX",1)

"KRN",.84,39331,-1)
0^135
"KRN",.84,39331,0)
39331^2^y^MAILMAN^Sender: |1|
"KRN",.84,39331,2,0)
^.844^1^1^3020408^^
"KRN",.84,39331,2,1,0)
Sender: |1|
"KRN",.84,39331,3,0)
^.845^1^1
"KRN",.84,39331,3,1,0)
1^sender's name
"KRN",.84,39331,5,0)
^.841^1^1
"KRN",.84,39331,5,1,0)
XMFAX
"KRN",.84,39331,5,"B","XMFAX",1)

"KRN",.84,39332,-1)
0^136
"KRN",.84,39332,0)
39332^2^^MAILMAN^Sending to fax
"KRN",.84,39332,2,0)
^^1^1^3020408^
"KRN",.84,39332,2,1,0)
Sending to fax
"KRN",.84,39332,5,0)
^.841^1^1
"KRN",.84,39332,5,1,0)
XMFAX
"KRN",.84,39332,5,"B","XMFAX",1)

"KRN",.84,39333,-1)
0^137
"KRN",.84,39333,0)
39333^2^y^MAILMAN^MailMan Fax for |1|
"KRN",.84,39333,2,0)
^^1^1^3020408^
"KRN",.84,39333,2,1,0)
MailMan Fax for |1|
"KRN",.84,39333,3,0)
^.845^1^1
"KRN",.84,39333,3,1,0)
1^addressee
"KRN",.84,39333,5,0)
^.841^1^1
"KRN",.84,39333,5,1,0)
XMFAX
"KRN",.84,39333,5,"B","XMFAX",1)

"KRN",.84,39334,-1)
0^138
"KRN",.84,39334,0)
39334^2^y^MAILMAN^FAXMail ID: |1|, faxed: |2|
"KRN",.84,39334,2,0)
^^1^1^3020408^
"KRN",.84,39334,2,1,0)
FAXMail ID: |1|, faxed: |2|
"KRN",.84,39334,3,0)
^.845^2^2
"KRN",.84,39334,3,1,0)
1^fax id
"KRN",.84,39334,3,2,0)
2^date/time faxed
"KRN",.84,39334,5,0)
^.841^1^1
"KRN",.84,39334,5,1,0)
XMFAX
"KRN",.84,39334,5,"B","XMFAX",1)

"KRN",.84,39401,-1)
0^1357
"KRN",.84,39401,0)
39401^1^y^MAILMAN^You are not authorized to be a surrogate
"KRN",.84,39401,2,0)
^^1^1^2991110^^
"KRN",.84,39401,2,1,0)
You are not authorized to be a surrogate of DUZ |1|.
"KRN",.84,39401,3,0)
^.845^1^1
"KRN",.84,39401,3,1,0)
1^xmduz
"KRN",.84,39401,5,0)
^.841^1^1
"KRN",.84,39401,5,1,0)
XMXPARM
"KRN",.84,39401,5,"B","XMXPARM",1)

"KRN",.84,39402,-1)
0^1358
"KRN",.84,39402,0)
39402^1^^MAILMAN^No subject.
"KRN",.84,39402,2,0)
^^1^1^2991110^
"KRN",.84,39402,2,1,0)
No subject.
"KRN",.84,39402,5,0)
^.841^1^1
"KRN",.84,39402,5,1,0)
XMXPARM
"KRN",.84,39402,5,"B","XMXPARM",1)

"KRN",.84,39403,-1)
0^1359
"KRN",.84,39403,0)
39403^1^^MAILMAN^Subject must be from 3 to 65 characters
"KRN",.84,39403,2,0)
^^1^1^2991110^
"KRN",.84,39403,2,1,0)
Subject must be from 3 to 65 characters long.
"KRN",.84,39403,5,0)
^.841^2^2
"KRN",.84,39403,5,1,0)
XMXPARM
"KRN",.84,39403,5,2,0)
XMJMS
"KRN",.84,39403,5,"B","XMJMS",2)

"KRN",.84,39403,5,"B","XMXPARM",1)

"KRN",.84,39404,-1)
0^1360
"KRN",.84,39404,0)
39404^1^^MAILMAN^Subject 'Rnnn' reserved.
"KRN",.84,39404,2,0)
^^1^1^2991110^
"KRN",.84,39404,2,1,0)
Subject 'Rnnn' reserved.
"KRN",.84,39404,5,0)
^.841^1^1
"KRN",.84,39404,5,1,0)
XMXPARM
"KRN",.84,39404,5,"B","XMXPARM",1)

"KRN",.84,39405,-1)
0^1361
"KRN",.84,39405,0)
39405^1^^MAILMAN^Message must have a body.
"KRN",.84,39405,2,0)
^^1^1^2991110^
"KRN",.84,39405,2,1,0)
Message must have a body.
"KRN",.84,39405,5,0)
^.841^1^1
"KRN",.84,39405,5,1,0)
XMXPARM
"KRN",.84,39405,5,"B","XMXPARM",1)

"KRN",.84,39406,-1)
0^1362
"KRN",.84,39406,0)
39406^1^^MAILMAN^Message body may not be called XMBODY.
"KRN",.84,39406,2,0)
^^1^1^2991110^
"KRN",.84,39406,2,1,0)
Message body may not be called XMBODY.
"KRN",.84,39406,5,0)
^.841^1^1
"KRN",.84,39406,5,1,0)
XMXPARM
"KRN",.84,39406,5,"B","XMXPARM",1)

"KRN",.84,39407,-1)
0^1363
"KRN",.84,39407,0)
39407^1^y^MAILMAN^Message body '|1|' has no data.
"KRN",.84,39407,2,0)
^^1^1^2991110^
"KRN",.84,39407,2,1,0)
Message body '|1|' has no data.
"KRN",.84,39407,3,0)
^.845^1^1
"KRN",.84,39407,3,1,0)
1^the name of the variable containing the message text
"KRN",.84,39407,5,0)
^.841^1^1
"KRN",.84,39407,5,1,0)
XMXPARM
"KRN",.84,39407,5,"B","XMXPARM",1)

"KRN",.84,39408,-1)
0^1364
"KRN",.84,39408,0)
39408^1^^MAILMAN^No recipients
"KRN",.84,39408,2,0)
^^1^1^2991110^
"KRN",.84,39408,2,1,0)
No recipients
"KRN",.84,39408,5,0)
^.841^1^1
"KRN",.84,39408,5,1,0)
XMXPARM
"KRN",.84,39408,5,"B","XMXPARM",1)

"KRN",.84,39409,-1)
0^1365
"KRN",.84,39409,0)
39409^1^^MAILMAN^Must be a date in the future.
"KRN",.84,39409,2,0)
^.844^1^1^3000517^^
"KRN",.84,39409,2,1,0)
Must be a date in the future.
"KRN",.84,39409,3,0)
^.845^^0
"KRN",.84,39409,5,0)
^.841^1^1
"KRN",.84,39409,5,1,0)
XMXPARM
"KRN",.84,39409,5,"B","XMXPARM",1)

"KRN",.84,39410,-1)
0^1366
"KRN",.84,39410,0)
39410^1^^MAILMAN^Must be from 1 to 65 characters, not a #,
"KRN",.84,39410,2,0)
^.844^1^1^3000517^^
"KRN",.84,39410,2,1,0)
Must be from 1 to 65 characters, not a #, no ^.
"KRN",.84,39410,3,0)
^.845^^0
"KRN",.84,39410,5,0)
^.841^1^1
"KRN",.84,39410,5,1,0)
XMXPARM
"KRN",.84,39410,5,"B","XMXPARM",1)

"KRN",.84,39411,-1)
0^1367
"KRN",.84,39411,0)
39411^1^^MAILMAN^May not be a real person.
"KRN",.84,39411,2,0)
^.844^1^1^3000517^^
"KRN",.84,39411,2,1,0)
May not be a real person.
"KRN",.84,39411,3,0)
^.845^^0
"KRN",.84,39411,5,0)
^.841^1^1
"KRN",.84,39411,5,1,0)
XMXPARM
"KRN",.84,39411,5,"B","XMXPARM",1)

"KRN",.84,39412,-1)
0^1368
"KRN",.84,39412,0)
39412^1^^MAILMAN^Must be 1 character.
"KRN",.84,39412,2,0)
^.844^1^1^3000517^^
"KRN",.84,39412,2,1,0)
Must be 1 character.
"KRN",.84,39412,3,0)
^.845^^0
"KRN",.84,39412,5,0)
^.841^1^1
"KRN",.84,39412,5,1,0)
XMXPARM
"KRN",.84,39412,5,"B","XMXPARM",1)

"KRN",.84,39413,-1)
0^1369
"KRN",.84,39413,0)
39413^1^y^MAILMAN^|1| is not valid.
"KRN",.84,39413,2,0)
^.844^1^1^3000517^^
"KRN",.84,39413,2,1,0)
|1| is not valid.
"KRN",.84,39413,3,0)
^.845^1^1
"KRN",.84,39413,3,1,0)
1^invalid character(s)
"KRN",.84,39413,5,0)
^.841^1^1
"KRN",.84,39413,5,1,0)
XMXPARM
"KRN",.84,39413,5,"B","XMXPARM",1)

"KRN",.84,39414,-1)
0^1370
"KRN",.84,39414,0)
39414^1^y^MAILMAN^Basket name '|1|' ambiguous.
"KRN",.84,39414,2,0)
^.844^1^1^3000517^^^
"KRN",.84,39414,2,1,0)
Basket name '|1|' ambiguous.
"KRN",.84,39414,3,0)
^.845^1^1
"KRN",.84,39414,3,1,0)
1^basket name
"KRN",.84,39414,5,0)
^.841^1^1
"KRN",.84,39414,5,1,0)
XMXPARM
"KRN",.84,39414,5,"B","XMXPARM",1)

"KRN",.84,39415,-1)
0^1371
"KRN",.84,39415,0)
39415^1^y^MAILMAN^Basket '|1|' not found.
"KRN",.84,39415,2,0)
^.844^1^1^3000517^^
"KRN",.84,39415,2,1,0)
Basket '|1|' not found.
"KRN",.84,39415,3,0)
^.845^1^1
"KRN",.84,39415,3,1,0)
1^basket name
"KRN",.84,39415,5,0)
^.841^1^1
"KRN",.84,39415,5,1,0)
XMXPARM
"KRN",.84,39415,5,"B","XMXPARM",1)

"KRN",.84,39416,-1)
0^1372
"KRN",.84,39416,0)
39416^1^^MAILMAN^Destination basket must be supplied.
"KRN",.84,39416,2,0)
^.844^1^1^3000517^^^
"KRN",.84,39416,2,1,0)
Destination basket must be supplied.
"KRN",.84,39416,5,0)
^.841^1^1
"KRN",.84,39416,5,1,0)
XMXPARM
"KRN",.84,39416,5,"B","XMXPARM",1)

"KRN",.84,39417,-1)
0^1373
"KRN",.84,39417,0)
39417^1^^MAILMAN^Vaporize date must be supplied.
"KRN",.84,39417,2,0)
^^1^1^3000607^
"KRN",.84,39417,2,1,0)
Vaporize date must be supplied.
"KRN",.84,39417,5,0)
^.841^1^1
"KRN",.84,39417,5,1,0)
XMXPARM
"KRN",.84,39417,5,"B","XMXPARM",1)

"KRN",.84,39418,-1)
0^1374
"KRN",.84,39418,0)
39418^1^^MAILMAN^No message numbers.
"KRN",.84,39418,2,0)
^^1^1^2991110^
"KRN",.84,39418,2,1,0)
No message numbers.
"KRN",.84,39418,5,0)
^.841^1^1
"KRN",.84,39418,5,1,0)
XMXPARM
"KRN",.84,39418,5,"B","XMXPARM",1)

"KRN",.84,39419,-1)
0^1375
"KRN",.84,39419,0)
39419^1^^MAILMAN^Later date must be supplied.
"KRN",.84,39419,2,0)
^^1^1^3000607^
"KRN",.84,39419,2,1,0)
Later date must be supplied.
"KRN",.84,39419,5,0)
^.841^1^1
"KRN",.84,39419,5,1,0)
XMXPARM
"KRN",.84,39419,5,"B","XMXPARM",1)

"KRN",.84,39420,-1)
0^1376
"KRN",.84,39420,0)
39420^1^^MAILMAN^Must be an exact date.
"KRN",.84,39420,2,0)
^^1^1^3000822^
"KRN",.84,39420,2,1,0)
Must be an exact date.
"KRN",.84,39420,5,0)
^.841^1^1
"KRN",.84,39420,5,1,0)
XMXPARMB
"KRN",.84,39420,5,"B","XMXPARMB",1)

"KRN",.84,39430,-1)
0^1377
"KRN",.84,39430,0)
39430^1^^MAILMAN^Bulletin name must be supplied.
"KRN",.84,39430,2,0)
^^1^1^3000517^
"KRN",.84,39430,2,1,0)
Bulletin name must be supplied.
"KRN",.84,39430,5,0)
^.841
"KRN",.84,39431,-1)
0^1378
"KRN",.84,39431,0)
39431^1^y^MAILMAN^Bulletin '|1|' not found.
"KRN",.84,39431,2,0)
^^1^1^3000517^
"KRN",.84,39431,2,1,0)
Bulletin '|1|' not found.
"KRN",.84,39431,3,0)
^.845^1^1
"KRN",.84,39431,3,1,0)
1^bulletin name
"KRN",.84,39431,5,0)
^.841^1^1
"KRN",.84,39431,5,1,0)
XMXPARM1
"KRN",.84,39431,5,"B","XMXPARM1",1)

"KRN",.84,39432,-1)
0^1379
"KRN",.84,39432,0)
39432^1^y^MAILMAN^User '|1|' ambiguous.
"KRN",.84,39432,2,0)
^^1^1^3000517^
"KRN",.84,39432,2,1,0)
User '|1|' ambiguous.
"KRN",.84,39432,3,0)
^.845^1^1
"KRN",.84,39432,3,1,0)
1^user name
"KRN",.84,39432,5,0)
^.841^1^1
"KRN",.84,39432,5,1,0)
XMXPARM1
"KRN",.84,39432,5,"B","XMXPARM1",1)

"KRN",.84,39433,-1)
0^1380
"KRN",.84,39433,0)
39433^1^y^MAILMAN^User '|1|' not found.
"KRN",.84,39433,2,0)
^^1^1^3000517^
"KRN",.84,39433,2,1,0)
User '|1|' not found.
"KRN",.84,39433,3,0)
^.845^1^1
"KRN",.84,39433,3,1,0)
1^user name
"KRN",.84,39433,5,0)
^.841^1^1
"KRN",.84,39433,5,1,0)
XMXPARM1
"KRN",.84,39433,5,"B","XMXPARM1",1)

"KRN",.84,39434,-1)
0^1381
"KRN",.84,39434,0)
39434^1^y^MAILMAN^Must be |1|-|2| characters.
"KRN",.84,39434,2,0)
^^1^1^3000517^
"KRN",.84,39434,2,1,0)
Must be |1|-|2| characters.
"KRN",.84,39434,3,0)
^.845^2^2
"KRN",.84,39434,3,1,0)
1^minimum length
"KRN",.84,39434,3,2,0)
2^maximum length
"KRN",.84,39434,5,0)
^.841^1^1
"KRN",.84,39434,5,1,0)
XMXPARM1
"KRN",.84,39434,5,"B","XMXPARM1",1)

"KRN",.84,39435,-1)
0^1382
"KRN",.84,39435,0)
39435^1^^MAILMAN^Scramble key must be supplied.
"KRN",.84,39435,2,0)
^.844^1^1^3000517^^
"KRN",.84,39435,2,1,0)
Scramble key must be supplied.
"KRN",.84,39435,5,0)
^.841^1^1
"KRN",.84,39435,5,1,0)
XMXPARM1
"KRN",.84,39435,5,"B","XMXPARM1",1)

"KRN",.84,39436,-1)
0^1383
"KRN",.84,39436,0)
39436^1^^MAILMAN^Scramble hint must be supplied.
"KRN",.84,39436,2,0)
^^1^1^3000517^
"KRN",.84,39436,2,1,0)
Scramble hint must be supplied.
"KRN",.84,39436,5,0)
^.841^1^1
"KRN",.84,39436,5,1,0)
XMXPARM1
"KRN",.84,39436,5,"B","XMXPARM1",1)

"KRN",.84,39437,-1)
0^1384
"KRN",.84,39437,0)
39437^1^^MAILMAN^Must be |1|-|2| characters,
"KRN",.84,39437,2,0)
^^1^1^3000517^
"KRN",.84,39437,2,1,0)
Must be |1|-|2| characters, no ^.
"KRN",.84,39437,5,0)
^.841^1^1
"KRN",.84,39437,5,1,0)
XMXPARM1
"KRN",.84,39437,5,"B","XMXPARM1",1)

"KRN",.84,39438,-1)
0^1385
"KRN",.84,39438,0)
39438^1^^MAILMAN^Must be one of |1|.
"KRN",.84,39438,2,0)
^^1^1^3000517^
"KRN",.84,39438,2,1,0)
Must be one of |1|.
"KRN",.84,39438,5,0)
^.841^1^1
"KRN",.84,39438,5,1,0)
XMXPARM1
"KRN",.84,39438,5,"B","XMXPARM1",1)

"KRN",.84,39440,-1)
0^1386
"KRN",.84,39440,0)
39440^1^y^MAILMAN^Basket '|1|' already exists.
"KRN",.84,39440,2,0)
^^1^1^3000808^
"KRN",.84,39440,2,1,0)
Basket '|1|' already exists.
"KRN",.84,39440,3,0)
^.845^1^1
"KRN",.84,39440,3,1,0)
1^basket name
"KRN",.84,39440,5,0)
^.841^1^1
"KRN",.84,39440,5,1,0)
XMXPARMB
"KRN",.84,39440,5,"B","XMXPARMB",1)

"KRN",.84,39441,-1)
0^1387
"KRN",.84,39441,0)
39441^1^^MAILMAN^Must be a positive number OR *.
"KRN",.84,39441,2,0)
^^1^1^3000808^
"KRN",.84,39441,2,1,0)
Must be a positive number OR *.
"KRN",.84,39441,5,0)
^.841^1^1
"KRN",.84,39441,5,1,0)
XMXPARMB
"KRN",.84,39441,5,"B","XMXPARMB",1)

"KRN",.84,39442,-1)
0^1388
"KRN",.84,39442,0)
39442^1^^MAILMAN^Server basket name must begin with 'S.'.
"KRN",.84,39442,2,0)
^^1^1^3000808^
"KRN",.84,39442,2,1,0)
Server basket name must begin with 'S.'.
"KRN",.84,39442,5,0)
^.841^1^1
"KRN",.84,39442,5,1,0)
XMXPARMB
"KRN",.84,39442,5,"B","XMXPARMB",1)

"KRN",.84,39443,-1)
0^1389
"KRN",.84,39443,0)
39443^1^y^MAILMAN^Server basket '|1|' not found.  Name must
"KRN",.84,39443,2,0)
^^2^2^3000808^
"KRN",.84,39443,2,1,0)
Server basket '|1|' not found.
"KRN",.84,39443,2,2,0)
Name must be exact.
"KRN",.84,39443,3,0)
^.845^1^1
"KRN",.84,39443,3,1,0)
1^server basket name
"KRN",.84,39443,5,0)
^.841^1^1
"KRN",.84,39443,5,1,0)
XMXPARMB
"KRN",.84,39443,5,"B","XMXPARMB",1)

"KRN",.84,39501,-1)
0^1390
"KRN",.84,39501,0)
39501^1^y^MAILMAN^Mail group '|1|' not found.
"KRN",.84,39501,2,0)
^^1^1^2991130^
"KRN",.84,39501,2,1,0)
Mail group '|1|' not found.
"KRN",.84,39501,3,0)
^.845^1^1
"KRN",.84,39501,3,1,0)
1^mail group name
"KRN",.84,39501,5,0)
^.841^1^1
"KRN",.84,39501,5,1,0)
XMXAPIG
"KRN",.84,39501,5,"B","XMXAPIG",1)

"KRN",.84,39502,-1)
0^1391
"KRN",.84,39502,0)
39502^1^y^MAILMAN^Mail group IEN '|1|' not found.
"KRN",.84,39502,2,0)
^^1^1^2991130^
"KRN",.84,39502,2,1,0)
Mail group IEN '|1|' not found.
"KRN",.84,39502,3,0)
^.845^1^1
"KRN",.84,39502,3,1,0)
1^mail group ien
"KRN",.84,39502,5,0)
^.841^1^1
"KRN",.84,39502,5,1,0)
XMXAPIG
"KRN",.84,39502,5,"B","XMXAPIG",1)

"KRN",.84,39503,-1)
0^1392
"KRN",.84,39503,0)
39503^1^y^MAILMAN^Mail group '|1|' has no active local memb
"KRN",.84,39503,2,0)
^^1^1^2991130^
"KRN",.84,39503,2,1,0)
Mail group '|1|' has no active local members.
"KRN",.84,39503,3,0)
^.845^1^1
"KRN",.84,39503,3,1,0)
1^mail group name
"KRN",.84,39503,5,0)
^.841^1^1
"KRN",.84,39503,5,1,0)
XMXAPIG
"KRN",.84,39503,5,"B","XMXAPIG",1)

"KRN",.84,39503.1,-1)
0^1393
"KRN",.84,39503.1,0)
39503.1^1^y^MAILMAN^Mail group '|1|' does not have at least
"KRN",.84,39503.1,2,0)
^^1^1^3000907^
"KRN",.84,39503.1,2,1,0)
Mail group '|1|' does not have at least |3| active local members.
"KRN",.84,39503.1,3,0)
^.845^2^2
"KRN",.84,39503.1,3,1,0)
1^mail group name
"KRN",.84,39503.1,3,2,0)
3^minimum number of local members
"KRN",.84,39503.1,5,0)
^.841^1^1
"KRN",.84,39503.1,5,1,0)
XMXAPIG
"KRN",.84,39503.1,5,"B","XMXAPIG",1)

"KRN",.84,39504,-1)
0^1394
"KRN",.84,39504,0)
39504^1^y^MAILMAN^Mail group '|1|' has no local members acti
"KRN",.84,39504,2,0)
^^1^1^2991130^
"KRN",.84,39504,2,1,0)
Mail group '|1|' has no local members active since '|2|'.
"KRN",.84,39504,3,0)
^.845^2^2
"KRN",.84,39504,3,1,0)
1^mail group name
"KRN",.84,39504,3,2,0)
2^date since no active members used MailMan
"KRN",.84,39504,5,0)
^.841^1^1
"KRN",.84,39504,5,1,0)
XMXAPIG
"KRN",.84,39504,5,"B","XMXAPIG",1)

"KRN",.84,39504.1,-1)
0^1395
"KRN",.84,39504.1,0)
39504.1^1^y^MAILMAN^Mail group '|1|' does not have at least
"KRN",.84,39504.1,2,0)
^^2^2^3000907^
"KRN",.84,39504.1,2,1,0)
Mail group '|1|' does not have at least |3| local members
"KRN",.84,39504.1,2,2,0)
who have been active since '|2|'.
"KRN",.84,39504.1,3,0)
^.845^3^3
"KRN",.84,39504.1,3,1,0)
1^mail group name
"KRN",.84,39504.1,3,2,0)
2^active cutoff date
"KRN",.84,39504.1,3,3,0)
3^minimum number of local members
"KRN",.84,39504.1,5,0)
^.841^1^1
"KRN",.84,39504.1,5,1,0)
XMXAPIG
"KRN",.84,39504.1,5,"B","XMXAPIG",1)

"KRN",.84,42000,-1)
0^1397
"KRN",.84,42000,0)
42000^2^y^MAILMAN^MailMan: To |1|
"KRN",.84,42000,2,0)
^^1^1^3000728^
"KRN",.84,42000,2,1,0)
MailMan: To |1|
"KRN",.84,42000,3,0)
^.845^1^1
"KRN",.84,42000,3,1,0)
1^domain name
"KRN",.84,42000.1,-1)
0^127
"KRN",.84,42000.1,0)
42000.1^2^y^MAILMAN^MailMan: To |1| (requeue)
"KRN",.84,42000.1,2,0)
^^1^1^3020405^
"KRN",.84,42000.1,2,1,0)
MailMan: To |1| (requeue)
"KRN",.84,42000.1,3,0)
^.845^1^1
"KRN",.84,42000.1,3,1,0)
1^site name
"KRN",.84,42000.1,5,0)
^.841^1^1
"KRN",.84,42000.1,5,1,0)
XMKPR
"KRN",.84,42000.1,5,"B","XMKPR",1)

"KRN",.84,42000.2,-1)
0^128
"KRN",.84,42000.2,0)
42000.2^2^y^MAILMAN^|1| Requeued
"KRN",.84,42000.2,2,0)
^^1^1^3020405^
"KRN",.84,42000.2,2,1,0)
|1| Requeued
"KRN",.84,42000.2,3,0)
^.845^1^1
"KRN",.84,42000.2,3,1,0)
1^site name
"KRN",.84,42000.2,5,0)
^.841^1^1
"KRN",.84,42000.2,5,1,0)
XMKPR
"KRN",.84,42000.2,5,"B","XMKPR",1)

"KRN",.84,42001,-1)
0^1398
"KRN",.84,42001,0)
42001^2^y^MAILMAN^MailMan: To Device |1|
"KRN",.84,42001,2,0)
^.844^1^1^3000728^^^
"KRN",.84,42001,2,1,0)
MailMan: To Device |1|
"KRN",.84,42001,3,0)
^.845^1^1
"KRN",.84,42001,3,1,0)
1^device name
"KRN",.84,42001,5,0)
^.841^1^1
"KRN",.84,42001,5,1,0)
XMKPO
"KRN",.84,42001,5,"B","XMKPO",1)

"KRN",.84,42002,-1)
0^1399
"KRN",.84,42002,0)
42002^2^y^MAILMAN^MailMan: To Server |1|
"KRN",.84,42002,2,0)
^^1^1^3000728^
"KRN",.84,42002,2,1,0)
MailMan: To Server |1|
"KRN",.84,42002,3,0)
^.845^1^1
"KRN",.84,42002,3,1,0)
1^server name
"KRN",.84,42002,5,0)
^.841^1^1
"KRN",.84,42002,5,1,0)
XMKPO
"KRN",.84,42002,5,"B","XMKPO",1)

"KRN",.84,42002.1,-1)
0^1400
"KRN",.84,42002.1,0)
42002.1^2^^MAILMAN^Setting up server task
"KRN",.84,42002.1,2,0)
^^1^1^3000728^
"KRN",.84,42002.1,2,1,0)
Setting up server task
"KRN",.84,42002.1,5,0)
^.841^1^1
"KRN",.84,42002.1,5,1,0)
XMKPO
"KRN",.84,42002.1,5,"B","XMKPO",1)

"KRN",.84,42002.2,-1)
0^1401
"KRN",.84,42002.2,0)
42002.2^2^y^MAILMAN^Server task #: |1|
"KRN",.84,42002.2,2,0)
^^1^1^3000728^
"KRN",.84,42002.2,2,1,0)
Server task #: |1|
"KRN",.84,42002.2,3,0)
^.845^1^1
"KRN",.84,42002.2,3,1,0)
1^task number
"KRN",.84,42002.2,5,0)
^.841^1^1
"KRN",.84,42002.2,5,1,0)
XMKPO
"KRN",.84,42002.2,5,"B","XMKPO",1)

"KRN",.84,42003,-1)
0^1402
"KRN",.84,42003,0)
42003^2^y^MAILMAN^MailMan: Bulletin |1|
"KRN",.84,42003,2,0)
^^1^1^3000728^
"KRN",.84,42003,2,1,0)
MailMan: Bulletin |1|
"KRN",.84,42003,3,0)
^.845^1^1
"KRN",.84,42003,3,1,0)
1^bulletin name
"KRN",.84,42003,5,0)
^.841^1^1
"KRN",.84,42003,5,1,0)
XMKPO
"KRN",.84,42003,5,"B","XMKPO",1)

"KRN",.84,42100,-1)
0^1403
"KRN",.84,42100,0)
42100^2^^MAILMAN^MailMan: Transmission Queue History Report
"KRN",.84,42100,2,0)
^.844^1^1^3010326^^
"KRN",.84,42100,2,1,0)
MailMan: Transmission Queue History Report
"KRN",.84,42100,5,0)
^.841^1^1
"KRN",.84,42100,5,1,0)
XMS4
"KRN",.84,42100,5,"B","XMS4",1)

"KRN",.84,42101,-1)
0^1404
"KRN",.84,42101,0)
42101^2^^MAILMAN^Transmission Queue History
"KRN",.84,42101,2,0)
^^1^1^3010326^
"KRN",.84,42101,2,1,0)
Transmission Queue History
"KRN",.84,42101,5,0)
^.841^1^1
"KRN",.84,42101,5,1,0)
XMS4
"KRN",.84,42101,5,"B","XMS4",1)

"KRN",.84,42102,-1)
0^1405
"KRN",.84,42102,0)
42102^2^^MAILMAN^Domain ...
"KRN",.84,42102,2,0)
^^1^1^3010326^
"KRN",.84,42102,2,1,0)
Domain          Queued    Sent    Rcvd   Domain          Queued    Sent    Rcvd
"KRN",.84,42102,5,0)
^.841^1^1
"KRN",.84,42102,5,1,0)
XMS4
"KRN",.84,42102,5,"B","XMS4",1)

"KRN",.84,42103,-1)
0^1406
"KRN",.84,42103,0)
42103^2^^MAILMAN^Total Domains: 
"KRN",.84,42103,1,0)
^^1^1^3010326^
"KRN",.84,42103,1,1,0)
There's a blank at the end
"KRN",.84,42103,2,0)
^^1^1^3010326^
"KRN",.84,42103,2,1,0)
Total Domains: 
"KRN",.84,42103,5,0)
^.841^3^3
"KRN",.84,42103,5,1,0)
XMS4
"KRN",.84,42103,5,2,0)
XMS5
"KRN",.84,42103,5,3,0)
XMS5A
"KRN",.84,42103,5,"B","XMS4",1)

"KRN",.84,42103,5,"B","XMS5",2)

"KRN",.84,42103,5,"B","XMS5A",3)

"KRN",.84,42104,-1)
0^1407
"KRN",.84,42104,0)
42104^2^^MAILMAN^Total Queued: 
"KRN",.84,42104,1,0)
^.842^1^1^3010326^^
"KRN",.84,42104,1,1,0)
There's a blank at the end
"KRN",.84,42104,2,0)
^.844^1^1^3010326^^
"KRN",.84,42104,2,1,0)
Total Queued: 
"KRN",.84,42104,5,0)
^.841^3^3
"KRN",.84,42104,5,1,0)
XMS4
"KRN",.84,42104,5,2,0)
XMS5^
"KRN",.84,42104,5,3,0)
XMS5A
"KRN",.84,42104,5,"B","XMS4",1)

"KRN",.84,42104,5,"B","XMS5",2)

"KRN",.84,42104,5,"B","XMS5A",3)

"KRN",.84,42105,-1)
0^1408
"KRN",.84,42105,0)
42105^2^^MAILMAN^Total Sent: 
"KRN",.84,42105,1,0)
^^1^1^3010326^
"KRN",.84,42105,1,1,0)
There's a blank at the end
"KRN",.84,42105,2,0)
^^1^1^3010326^
"KRN",.84,42105,2,1,0)
Total Sent: 
"KRN",.84,42105,5,0)
^.841^1^1
"KRN",.84,42105,5,1,0)
XMS4
"KRN",.84,42105,5,"B","XMS4",1)

"KRN",.84,42106,-1)
0^1409
"KRN",.84,42106,0)
42106^2^^MAILMAN^Total Received: 
"KRN",.84,42106,1,0)
^^1^1^3010326^
"KRN",.84,42106,1,1,0)
There's a blank at the end
"KRN",.84,42106,2,0)
^^1^1^3010326^
"KRN",.84,42106,2,1,0)
Total Received: 
"KRN",.84,42106,5,0)
^.841^1^1
"KRN",.84,42106,5,1,0)
XMS4
"KRN",.84,42106,5,"B","XMS4",1)

"KRN",.84,42110,-1)
0^1410
"KRN",.84,42110,0)
42110^2^^MAILMAN^MailMan: Active Transmission Queues Report
"KRN",.84,42110,2,0)
^.844^1^1^3010326^^^
"KRN",.84,42110,2,1,0)
MailMan: Active Transmission Queues Report
"KRN",.84,42110,5,0)
^.841^1^1
"KRN",.84,42110,5,1,0)
XMS5
"KRN",.84,42110,5,"B","XMS5",1)

"KRN",.84,42111,-1)
0^1411
"KRN",.84,42111,0)
42111^2^^MAILMAN^Active Transmission Queues
"KRN",.84,42111,2,0)
^.844^1^1^3010326^^
"KRN",.84,42111,2,1,0)
Active Transmission Queues
"KRN",.84,42111,5,0)
^.841^1^1
"KRN",.84,42111,5,1,0)
XMS5
"KRN",.84,42111,5,"B","XMS5",1)

"KRN",.84,42112,-1)
0^1412
"KRN",.84,42112,0)
42112^2^^MAILMAN^Domain ...
"KRN",.84,42112,2,0)
^^1^1^3010326^
"KRN",.84,42112,2,1,0)
Domain         Queued  Device/Protocol      Message  Line      ZTSK Err    Rate
"KRN",.84,42112,5,0)
^.841^1^1
"KRN",.84,42112,5,1,0)
XMS5
"KRN",.84,42112,5,"B","XMS5",1)

"KRN",.84,42113,-1)
0^1413
"KRN",.84,42113,0)
42113^2^y^MAILMAN^Appears Inactive - |1| Minutes
"KRN",.84,42113,2,0)
^^1^1^3010326^
"KRN",.84,42113,2,1,0)
== Appears Inactive - |1| Minutes
"KRN",.84,42113,3,0)
^.845^1^1
"KRN",.84,42113,3,1,0)
1^number of minutes
"KRN",.84,42113,5,0)
^.841^1^1
"KRN",.84,42113,5,1,0)
XMS5
"KRN",.84,42113,5,"B","XMS5",1)

"KRN",.84,42114,-1)
0^1414
"KRN",.84,42114,0)
42114^2^^MAILMAN^Connecting/Disconnecting
"KRN",.84,42114,2,0)
^^1^1^3010326^
"KRN",.84,42114,2,1,0)
Connecting/Disconnecting
"KRN",.84,42114,5,0)
^.841^1^1
"KRN",.84,42114,5,1,0)
XMS5
"KRN",.84,42114,5,"B","XMS5",1)

"KRN",.84,42115,-1)
0^1415
"KRN",.84,42115,0)
42115^2^^MAILMAN^No queues actively transmitting
"KRN",.84,42115,2,0)
^.844^1^1^3010326^^
"KRN",.84,42115,2,1,0)
No queues actively transmitting
"KRN",.84,42115,5,0)
^.841^1^1
"KRN",.84,42115,5,1,0)
XMS5
"KRN",.84,42115,5,"B","XMS5",1)

"KRN",.84,42116,-1)
0^1416
"KRN",.84,42116,0)
42116^2^^MAILMAN^Refresh
"KRN",.84,42116,2,0)
^^1^1^3010326^
"KRN",.84,42116,2,1,0)
Refresh
"KRN",.84,42116,5,0)
^.841^1^1
"KRN",.84,42116,5,1,0)
XMS5
"KRN",.84,42116,5,"B","XMS5",1)

"KRN",.84,42117,-1)
0^1417
"KRN",.84,42117,0)
42117^3^^MAILMAN^Answer YES if you want the display refresh
"KRN",.84,42117,2,0)
^^3^3^3010326^
"KRN",.84,42117,2,1,0)
Answer YES if you want the display refreshed.
"KRN",.84,42117,2,2,0)
Answer NO if you don't.
"KRN",.84,42117,2,3,0)
If you don't answer, the display will be refreshed every five seconds.
"KRN",.84,42117,5,0)
^.841^1^1
"KRN",.84,42117,5,1,0)
XMS5
"KRN",.84,42117,5,"B","XMS5",1)

"KRN",.84,42120,-1)
0^1418
"KRN",.84,42120,0)
42120^2^^MAILMAN^MailMan: Transmission Queues with Messages
"KRN",.84,42120,2,0)
^^1^1^3010326^
"KRN",.84,42120,2,1,0)
MailMan: Transmission Queues with Messages Report
"KRN",.84,42120,5,0)
^.841^1^1
"KRN",.84,42120,5,1,0)
XMS5
"KRN",.84,42120,5,"B","XMS5",1)

"KRN",.84,42121,-1)
0^1419
"KRN",.84,42121,0)
42121^2^^MAILMAN^Transmission Queues with Messages
"KRN",.84,42121,2,0)
^^1^1^3010326^
"KRN",.84,42121,2,1,0)
Transmission Queues with Messages
"KRN",.84,42121,5,0)
^.841^1^1
"KRN",.84,42121,5,1,0)
XMS5
"KRN",.84,42121,5,"B","XMS5",1)

"KRN",.84,42122,-1)
0^1420
"KRN",.84,42122,0)
42122^2^^MAILMAN^Domain ...
"KRN",.84,42122,2,0)
^^1^1^3010326^
"KRN",.84,42122,2,1,0)
Domain                                   Queued    Physical Link
"KRN",.84,42122,5,0)
^.841^1^1
"KRN",.84,42122,5,1,0)
XMS5
"KRN",.84,42122,5,"B","XMS5",1)

"KRN",.84,42123,-1)
0^1421
"KRN",.84,42123,0)
42123^2^^MAILMAN^No messages queued
"KRN",.84,42123,2,0)
^^1^1^3010326^
"KRN",.84,42123,2,1,0)
No messages queued
"KRN",.84,42125,-1)
0^1422
"KRN",.84,42125,0)
42125^2^^MAILMAN^All queues with messages have tasks.
"KRN",.84,42125,2,0)
^^1^1^3010326^
"KRN",.84,42125,2,1,0)
All queues with messages have tasks.
"KRN",.84,42125,5,0)
^.841^1^1
"KRN",.84,42125,5,1,0)
XMS5
"KRN",.84,42125,5,"B","XMS5",1)

"KRN",.84,42126,-1)
0^1423
"KRN",.84,42126,0)
42126^2^^MAILMAN^These queues with messages have no tasks:
"KRN",.84,42126,2,0)
^^1^1^3010326^
"KRN",.84,42126,2,1,0)
These queues with messages have no tasks:
"KRN",.84,42126,5,0)
^.841^1^1
"KRN",.84,42126,5,1,0)
XMS5
"KRN",.84,42126,5,"B","XMS5",1)

"KRN",.84,42127,-1)
0^1424
"KRN",.84,42127,0)
42127^2^^MAILMAN^No Send Flag - Will not task
"KRN",.84,42127,2,0)
^^1^1^3010326^
"KRN",.84,42127,2,1,0)
No Send Flag - Will not task
"KRN",.84,42127,5,0)
^.841^1^1
"KRN",.84,42127,5,1,0)
XMS5
"KRN",.84,42127,5,"B","XMS5",1)

"KRN",.84,42128,-1)
0^1425
"KRN",.84,42128,0)
42128^2^^MAILMAN^Requeue the missing tasks
"KRN",.84,42128,2,0)
^^1^1^3010326^
"KRN",.84,42128,2,1,0)
Requeue the missing tasks
"KRN",.84,42128,5,0)
^.841^1^1
"KRN",.84,42128,5,1,0)
XMS5
"KRN",.84,42128,5,"B","XMS5",1)

"KRN",.84,42129,-1)
0^1426
"KRN",.84,42129,0)
42129^3^^MAILMAN^Answer YES to create tasks to transmit
"KRN",.84,42129,2,0)
^.844^1^1^3010328^^
"KRN",.84,42129,2,1,0)
Answer YES to create tasks to transmit these queues.
"KRN",.84,42129,5,0)
^.841^1^1
"KRN",.84,42129,5,1,0)
XMS5
"KRN",.84,42129,5,"B","XMS5",1)

"KRN",.84,42130,-1)
0^1427
"KRN",.84,42130,0)
42130^2^^MAILMAN^Tasks not requeued.
"KRN",.84,42130,2,0)
^^1^1^3010326^
"KRN",.84,42130,2,1,0)
Tasks not requeued.
"KRN",.84,42130,5,0)
^.841^1^1
"KRN",.84,42130,5,1,0)
XMS5
"KRN",.84,42130,5,"B","XMS5",1)

"KRN",.84,42131,-1)
0^1428
"KRN",.84,42131,0)
42131^2^y^MAILMAN^Task |1| queued
"KRN",.84,42131,2,0)
^.844^1^1^3020221^^
"KRN",.84,42131,2,1,0)
Task |1| queued
"KRN",.84,42131,3,0)
^.845^1^1
"KRN",.84,42131,3,1,0)
1^task number
"KRN",.84,42131,5,0)
^.841^1^1
"KRN",.84,42131,5,1,0)
XMS5
"KRN",.84,42131,5,"B","XMS5",1)

"KRN",.84,42132,-1)
0^1429
"KRN",.84,42132,0)
42132^2^^MAILMAN^Finished.
"KRN",.84,42132,2,0)
^^1^1^3010326^
"KRN",.84,42132,2,1,0)
Finished.
"KRN",.84,42132,5,0)
^.841^1^1
"KRN",.84,42132,5,1,0)
XMS5
"KRN",.84,42132,5,"B","XMS5",1)

"KRN",.84,42135,-1)
0^1430
"KRN",.84,42135,0)
42135^2^^MAILMAN^MailMan: Transmission Queue Status Report
"KRN",.84,42135,2,0)
^^1^1^3010326^
"KRN",.84,42135,2,1,0)
MailMan: Transmission Queue Status Report
"KRN",.84,42135,5,0)
^.841^1^1
"KRN",.84,42135,5,1,0)
XMS5A
"KRN",.84,42135,5,"B","XMS5A",1)

"KRN",.84,42136,-1)
0^1431
"KRN",.84,42136,0)
42136^2^^MAILMAN^Transmission Queue Status
"KRN",.84,42136,2,0)
^^1^1^3010326^
"KRN",.84,42136,2,1,0)
Transmission Queue Status
"KRN",.84,42136,5,0)
^.841^1^1
"KRN",.84,42136,5,1,0)
XMS5A
"KRN",.84,42136,5,"B","XMS5A",1)

"KRN",.84,42137,-1)
0^144
"KRN",.84,42137,0)
42137^2^^MAILMAN^Domain ...
"KRN",.84,42137,2,0)
^.844^1^1^3020416^^^^
"KRN",.84,42137,2,1,0)
Domain         Queued Device/Protocol       Message S/R Time   Line Err    Rate
"KRN",.84,42137,5,0)
^.841^1^1
"KRN",.84,42137,5,1,0)
XMCQ
"KRN",.84,42137,5,"B","XMCQ",1)

"KRN",.84,42138,-1)
0^1432
"KRN",.84,42138,0)
42138^2^y^MAILMAN^No task scheduled, FLAGS=|1|
"KRN",.84,42138,2,0)
^^1^1^3010326^
"KRN",.84,42138,2,1,0)
No task scheduled, FLAGS=|1|
"KRN",.84,42138,3,0)
^.845^1^1
"KRN",.84,42138,3,1,0)
1^FLAGS
"KRN",.84,42138,5,0)
^.841^1^1
"KRN",.84,42138,5,1,0)
XMS5A
"KRN",.84,42138,5,"B","XMS5A",1)

"KRN",.84,42139,-1)
0^1433
"KRN",.84,42139,0)
42139^2^y^MAILMAN^Task |1| scheduled for |2|
"KRN",.84,42139,2,0)
^^1^1^3010326^
"KRN",.84,42139,2,1,0)
Task |1| scheduled for |2|
"KRN",.84,42139,3,0)
^.845^2^2
"KRN",.84,42139,3,1,0)
1^task number
"KRN",.84,42139,3,2,0)
2^when
"KRN",.84,42139,5,0)
^.841^1^1
"KRN",.84,42139,5,1,0)
XMS5A
"KRN",.84,42139,5,"B","XMS5A",1)

"KRN",.84,42140,-1)
0^1434
"KRN",.84,42140,0)
42140^2^y^MAILMAN^Task |1| just started
"KRN",.84,42140,2,0)
^^1^1^3010326^
"KRN",.84,42140,2,1,0)
Task |1| just started
"KRN",.84,42140,3,0)
^.845^1^1
"KRN",.84,42140,3,1,0)
1^task number
"KRN",.84,42140,5,0)
^.841^1^1
"KRN",.84,42140,5,1,0)
XMS5A
"KRN",.84,42140,5,"B","XMS5A",1)

"KRN",.84,42141,-1)
0^1435
"KRN",.84,42141,0)
42141^2^^MAILMAN^No messages queued or in active transmissi
"KRN",.84,42141,2,0)
^^1^1^3010326^
"KRN",.84,42141,2,1,0)
No messages queued or in active transmission.
"KRN",.84,42141,5,0)
^.841^1^1
"KRN",.84,42141,5,1,0)
XMS5A
"KRN",.84,42141,5,"B","XMS5A",1)

"KRN",.84,42150,-1)
0^72
"KRN",.84,42150,0)
42150^2^^MAILMAN^All domains have tasks.
"KRN",.84,42150,2,0)
^.844^1^1^3020405^^
"KRN",.84,42150,2,1,0)
All domains have tasks.
"KRN",.84,42150,5,0)
^.841^1^1
"KRN",.84,42150,5,1,0)
XMCP
"KRN",.84,42150,5,"B","XMCP",1)

"KRN",.84,42151,-1)
0^73
"KRN",.84,42151,0)
42151^2^y^MAILMAN^Task |1| is already scheduled for domain
"KRN",.84,42151,2,0)
^^1^1^3020405^
"KRN",.84,42151,2,1,0)
Task |1| is already scheduled for domain |2|
"KRN",.84,42151,3,0)
^.845^2^2
"KRN",.84,42151,3,1,0)
1^task number
"KRN",.84,42151,3,2,0)
2^domain name
"KRN",.84,42151,5,0)
^.841^1^1
"KRN",.84,42151,5,1,0)
XMCP
"KRN",.84,42151,5,"B","XMCP",1)

"KRN",.84,42152,-1)
0^74
"KRN",.84,42152,0)
42152^2^^MAILMAN^These domains lack tasks:
"KRN",.84,42152,2,0)
^.844^1^1^3020405^^
"KRN",.84,42152,2,1,0)
These domains lack tasks:
"KRN",.84,42152,5,0)
^.841^1^1
"KRN",.84,42152,5,1,0)
XMCP
"KRN",.84,42152,5,"B","XMCP",1)

"KRN",.84,42153,-1)
0^75
"KRN",.84,42153,0)
42153^3^^MAILMAN^Answer YES to schedule tasks for these
"KRN",.84,42153,2,0)
^^1^1^3020405^
"KRN",.84,42153,2,1,0)
Answer YES to schedule tasks for these domains
"KRN",.84,42153,5,0)
^.841^1^1
"KRN",.84,42153,5,1,0)
XMCP
"KRN",.84,42153,5,"B","XMCP",1)

"KRN",.84,42170,-1)
0^80
"KRN",.84,42170,0)
42170^2^^MAILMAN^Transcript recording is controlled by
"KRN",.84,42170,2,0)
^^1^1^3020405^
"KRN",.84,42170,2,1,0)
Transcript recording is controlled by field 8.2 in file 4.3.
"KRN",.84,42170,5,0)
^.841^1^1
"KRN",.84,42170,5,1,0)
XMCXT
"KRN",.84,42170,5,"B","XMCXT",1)

"KRN",.84,42171,-1)
0^81
"KRN",.84,42171,0)
42171^2^^MAILMAN^No transcripts on file.
"KRN",.84,42171,2,0)
^^1^1^3020405^
"KRN",.84,42171,2,1,0)
No transcripts on file.
"KRN",.84,42171,5,0)
^.841^1^1
"KRN",.84,42171,5,1,0)
XMCXT
"KRN",.84,42171,5,"B","XMCXT",1)

"KRN",.84,42171.1,-1)
0^82
"KRN",.84,42171.1,0)
42171.1^2^^MAILMAN^No more transcripts on file.
"KRN",.84,42171.1,2,0)
^^1^1^3020405^
"KRN",.84,42171.1,2,1,0)
No more transcripts on file.
"KRN",.84,42171.1,5,0)
^.841^1^1
"KRN",.84,42171.1,5,1,0)
XMCXT
"KRN",.84,42171.1,5,"B","XMCXT",1)

"KRN",.84,42172,-1)
0^83
"KRN",.84,42172,0)
42172^2^^MAILMAN^10 lines of transcript will be displayed
"KRN",.84,42172,2,0)
^^1^1^3020405^
"KRN",.84,42172,2,1,0)
10 lines of transcript will be displayed at a time.
"KRN",.84,42172,5,0)
^.841^1^1
"KRN",.84,42172,5,1,0)
XMCXT
"KRN",.84,42172,5,"B","XMCXT",1)

"KRN",.84,42173,-1)
0^84
"KRN",.84,42173,0)
42173^2^^MAILMAN^Continue to the next transcript
"KRN",.84,42173,2,0)
^^1^1^3020405^
"KRN",.84,42173,2,1,0)
Continue to the next transcript
"KRN",.84,42173,5,0)
^.841^1^1
"KRN",.84,42173,5,1,0)
XMCXT
"KRN",.84,42173,5,"B","XMCXT",1)

"KRN",.84,42174,-1)
0^85
"KRN",.84,42174,0)
42174^2^^MAILMAN^Delete this transcript
"KRN",.84,42174,2,0)
^^1^1^3020405^
"KRN",.84,42174,2,1,0)
Delete this transcript
"KRN",.84,42174,5,0)
^.841^1^1
"KRN",.84,42174,5,1,0)
XMCXT
"KRN",.84,42174,5,"B","XMCXT",1)

"KRN",.84,42175,-1)
0^86
"KRN",.84,42175,0)
42175^2^^MAILMAN^Retained.
"KRN",.84,42175,2,0)
^^1^1^3020405^
"KRN",.84,42175,2,1,0)
Retained.
"KRN",.84,42175,5,0)
^.841^1^1
"KRN",.84,42175,5,1,0)
XMCXT
"KRN",.84,42175,5,"B","XMCXT",1)

"KRN",.84,42176,-1)
0^87
"KRN",.84,42176,0)
42176^2^^MAILMAN^Deleted.
"KRN",.84,42176,2,0)
^^1^1^3020405^
"KRN",.84,42176,2,1,0)
Deleted.
"KRN",.84,42176,5,0)
^.841^1^1
"KRN",.84,42176,5,1,0)
XMCXT
"KRN",.84,42176,5,"B","XMCXT",1)

"KRN",.84,42177,-1)
0^88
"KRN",.84,42177,0)
42177^2^^MAILMAN^The current transcript is:
"KRN",.84,42177,2,0)
^^1^1^3020405^
"KRN",.84,42177,2,1,0)
The current transcript is:
"KRN",.84,42177,5,0)
^.841^1^1
"KRN",.84,42177,5,1,0)
XMCXT
"KRN",.84,42177,5,"B","XMCXT",1)

"KRN",.84,42190,-1)
0^126
"KRN",.84,42190,0)
42190^2^^MAILMAN^A transcript of the last delivery attempt
"KRN",.84,42190,2,0)
^^1^1^3020405^
"KRN",.84,42190,2,1,0)
A transcript of the last delivery attempt follows:
"KRN",.84,42190,5,0)
^.841^1^1
"KRN",.84,42190,5,1,0)
XMKPR
"KRN",.84,42190,5,"B","XMKPR",1)

"KRN",.84,42191,-1)
0^125
"KRN",.84,42191,0)
42191^2^^MAILMAN^The following errors occurred in previous
"KRN",.84,42191,2,0)
^^1^1^3020405^
"KRN",.84,42191,2,1,0)
The following errors occurred in previous scripts:
"KRN",.84,42191,5,0)
^.841^1^1
"KRN",.84,42191,5,1,0)
XMKPR
"KRN",.84,42191,5,"B","XMKPR",1)

"KRN",.84,42192,-1)
0^129
"KRN",.84,42192,0)
42192^2^^MAILMAN^Unknown Error
"KRN",.84,42192,2,0)
^^1^1^3020405^
"KRN",.84,42192,2,1,0)
Unknown Error
"KRN",.84,42192,5,0)
^.841^1^1
"KRN",.84,42192,5,1,0)
XMKPR
"KRN",.84,42192,5,"B","XMKPR",1)

"KRN",.84,42201,-1)
0^9
"KRN",.84,42201,0)
42201^2^^MAILMAN^MailMan Network Programmer Option
"KRN",.84,42201,2,0)
^.844^1^1^3020404^^
"KRN",.84,42201,2,1,0)
MailMan Network Programmer Option
"KRN",.84,42201.01,-1)
0^10
"KRN",.84,42201.01,0)
42201.01^2^^MAILMAN^MAILMAN
"KRN",.84,42201.01,2,0)
^^1^1^3020404^
"KRN",.84,42201.01,2,1,0)
MAILMAN
"KRN",.84,42201.02,-1)
0^11
"KRN",.84,42201.02,0)
42201.02^2^^MAILMAN^PLAY A SCRIPT
"KRN",.84,42201.02,2,0)
^.844^1^1^3020404^^
"KRN",.84,42201.02,2,1,0)
PLAY A SCRIPT
"KRN",.84,42201.03,-1)
0^12
"KRN",.84,42201.03,0)
42201.03^2^^MAILMAN^SCHEDULE TASK FOR ONE DOMAIN WITH QUEUED
"KRN",.84,42201.03,2,0)
^^1^1^3020404^
"KRN",.84,42201.03,2,1,0)
SCHEDULE TASK FOR ONE DOMAIN WITH QUEUED MESSAGES
"KRN",.84,42201.04,-1)
0^13
"KRN",.84,42201.04,0)
42201.04^2^^MAILMAN^SCHEDULE TASKS FOR ALL DOMAINS WITH QUEUED
"KRN",.84,42201.04,2,0)
^^1^1^3020404^
"KRN",.84,42201.04,2,1,0)
SCHEDULE TASKS FOR ALL DOMAINS WITH QUEUED MESSAGES
"KRN",.84,42201.05,-1)
0^14
"KRN",.84,42201.05,0)
42201.05^2^^MAILMAN^SHOW A QUEUE
"KRN",.84,42201.05,2,0)
^^1^1^3020404^
"KRN",.84,42201.05,2,1,0)
SHOW A QUEUE
"KRN",.84,42201.06,-1)
0^15
"KRN",.84,42201.06,0)
42201.06^2^^MAILMAN^LIST TRANSCRIPT
"KRN",.84,42201.06,2,0)
^^1^1^3020404^
"KRN",.84,42201.06,2,1,0)
LIST TRANSCRIPT
"KRN",.84,42201.07,-1)
0^16
"KRN",.84,42201.07,0)
42201.07^2^^MAILMAN^TRANSMIT QUEUE STATUS REPORT
"KRN",.84,42201.07,2,0)
^^1^1^3020404^
"KRN",.84,42201.07,2,1,0)
TRANSMIT QUEUE STATUS REPORT
"KRN",.84,42201.08,-1)
0^17
"KRN",.84,42201.08,0)
42201.08^2^^MAILMAN^ACTIVELY TRANSMITTING QUEUES REPORT
"KRN",.84,42201.08,2,0)
^^1^1^3020404^
"KRN",.84,42201.08,2,1,0)
ACTIVELY TRANSMITTING QUEUES REPORT
"KRN",.84,42201.09,-1)
0^18
"KRN",.84,42201.09,0)
42201.09^2^^MAILMAN^QUEUES WITH MESSAGES TO GO OUT REPORT
"KRN",.84,42201.09,2,0)
^^1^1^3020404^
"KRN",.84,42201.09,2,1,0)
QUEUES WITH MESSAGES TO GO OUT REPORT
"KRN",.84,42201.1,-1)
0^19
"KRN",.84,42201.1,0)
42201.1^2^^MAILMAN^HISTORICAL QUEUE STATISTICS REPORT
"KRN",.84,42201.1,2,0)
^^1^1^3020404^
"KRN",.84,42201.1,2,1,0)
HISTORICAL QUEUE STATISTICS REPORT
"KRN",.84,42201.11,-1)
0^20
"KRN",.84,42201.11,0)
42201.11^2^^MAILMAN^SEND MESSAGES TO ANOTHER UCI VIA %ZISL
"KRN",.84,42201.11,2,0)
^^1^1^3020404^
"KRN",.84,42201.11,2,1,0)
SEND MESSAGES TO ANOTHER UCI VIA %ZISL GLOBAL
"KRN",.84,42201.12,-1)
0^21
"KRN",.84,42201.12,0)
42201.12^2^^MAILMAN^RECEIVE MESSAGES FROM ANOTHER UCI VIA
"KRN",.84,42201.12,2,0)
^^1^1^3020404^
"KRN",.84,42201.12,2,1,0)
RECEIVE MESSAGES FROM ANOTHER UCI VIA %ZISL GLOBAL
"KRN",.84,42201.13,-1)
0^22
"KRN",.84,42201.13,0)
42201.13^2^^MAILMAN^SEQUENTIAL MEDIA QUEUE TRANSMISSION
"KRN",.84,42201.13,2,0)
^^1^1^3020404^
"KRN",.84,42201.13,2,1,0)
SEQUENTIAL MEDIA QUEUE TRANSMISSION
"KRN",.84,42201.14,-1)
0^23
"KRN",.84,42201.14,0)
42201.14^2^^MAILMAN^SEQUENTIAL MEDIA MESSAGE RECEPTION
"KRN",.84,42201.14,2,0)
^^1^1^3020404^
"KRN",.84,42201.14,2,1,0)
SEQUENTIAL MEDIA MESSAGE RECEPTION
"KRN",.84,42201.15,-1)
0^24
"KRN",.84,42201.15,0)
42201.15^2^^MAILMAN^VALIDATION NUMBER EDIT
"KRN",.84,42201.15,2,0)
^^1^1^3020404^
"KRN",.84,42201.15,2,1,0)
VALIDATION NUMBER EDIT
"KRN",.84,42201.16,-1)
0^25
"KRN",.84,42201.16,0)
42201.16^2^^MAILMAN^TOGGLE A SCRIPT OUT OF SERVICE
"KRN",.84,42201.16,2,0)
^^1^1^3020404^
"KRN",.84,42201.16,2,1,0)
TOGGLE A SCRIPT OUT OF SERVICE
"KRN",.84,42201.17,-1)
0^26
"KRN",.84,42201.17,0)
42201.17^2^^MAILMAN^EDIT A SCRIPT
"KRN",.84,42201.17,2,0)
^^1^1^3020404^
"KRN",.84,42201.17,2,1,0)
EDIT A SCRIPT
"KRN",.84,42201.18,-1)
0^27
"KRN",.84,42201.18,0)
42201.18^2^^MAILMAN^SUBROUTINE EDITOR
"KRN",.84,42201.18,2,0)
^^1^1^3020404^
"KRN",.84,42201.18,2,1,0)
SUBROUTINE EDITOR
"KRN",.84,42210,-1)
0^28
"KRN",.84,42210,0)
42210^1^^MAILMAN^Netmail transmission in progress
"KRN",.84,42210,2,0)
^^1^1^3020404^
"KRN",.84,42210,2,1,0)
Netmail transmission in progress on another channel.
"KRN",.84,42211,-1)
0^1440
"KRN",.84,42211,0)
42211^2^y^MAILMAN^To |1| from |2| on |3|
"KRN",.84,42211,2,0)
^.844^1^1^3020702^^^
"KRN",.84,42211,2,1,0)
To |1| from |2| on |3|
"KRN",.84,42211,3,0)
^.845^3^3
"KRN",.84,42211,3,1,0)
1^Site we are transmitting to
"KRN",.84,42211,3,2,0)
2^Site we are transmitting from
"KRN",.84,42211,3,3,0)
3^date/time
"KRN",.84,42212,-1)
0^30
"KRN",.84,42212,0)
42212^2^y^MAILMAN^Script: |1|
"KRN",.84,42212,2,0)
^^1^1^3020404^
"KRN",.84,42212,2,1,0)
Script: |1|
"KRN",.84,42212,3,0)
^.845^1^1
"KRN",.84,42212,3,1,0)
1^script name
"KRN",.84,42213,-1)
0^31
"KRN",.84,42213,0)
42213^2^^MAILMAN^Creating transmission script 'on the fly'
"KRN",.84,42213,2,0)
^^1^1^3020404^
"KRN",.84,42213,2,1,0)
Creating transmission script 'on the fly' ...
"KRN",.84,42214,-1)
0^32
"KRN",.84,42214,0)
42214^2^^MAILMAN^Script complete.
"KRN",.84,42214,2,0)
^^1^1^3020404^
"KRN",.84,42214,2,1,0)
Script complete.
"KRN",.84,42215,-1)
0^33
"KRN",.84,42215,0)
42215^2^^MAILMAN^Stopped because of error.
"KRN",.84,42215,2,0)
^^1^1^3020404^
"KRN",.84,42215,2,1,0)
Stopped because of error.
"KRN",.84,42216,-1)
0^34
"KRN",.84,42216,0)
42216^1^y^MAILMAN^Invalid script command |1| at line |2|.
"KRN",.84,42216,2,0)
^^1^1^3020404^
"KRN",.84,42216,2,1,0)
Invalid script command |1| at line |2|.
"KRN",.84,42216,3,0)
^.845^2^2
"KRN",.84,42216,3,1,0)
1^invalid command
"KRN",.84,42216,3,2,0)
2^line in script where the bad command is
"KRN",.84,42217,-1)
0^35
"KRN",.84,42217,0)
42217^1^y^MAILMAN^Script |1| cannot be found in file 4.6
"KRN",.84,42217,2,0)
^^1^1^3020404^
"KRN",.84,42217,2,1,0)
Script |1| cannot be found in file 4.6
"KRN",.84,42217,3,0)
^.845^1^1
"KRN",.84,42217,3,1,0)
1^script name
"KRN",.84,42218,-1)
0^36
"KRN",.84,42218,0)
42218^2^y^MAILMAN^Calling script '|1|' (file 4.6)
"KRN",.84,42218,2,0)
^^1^1^3020404^
"KRN",.84,42218,2,1,0)
Calling script '|1|' (file 4.6)
"KRN",.84,42218,3,0)
^.845^1^1
"KRN",.84,42218,3,1,0)
1^script name
"KRN",.84,42219,-1)
0^37
"KRN",.84,42219,0)
42219^2^y^MAILMAN^Returning to script '|1|'.
"KRN",.84,42219,2,0)
^^1^1^3020404^
"KRN",.84,42219,2,1,0)
Returning to script '|1|'.
"KRN",.84,42219,3,0)
^.845^1^1
"KRN",.84,42219,3,1,0)
1^script name
"KRN",.84,42220,-1)
0^38
"KRN",.84,42220,0)
42220^2^^MAILMAN^Enter number(s) to dial
"KRN",.84,42220,2,0)
^^1^1^3020404^
"KRN",.84,42220,2,1,0)
Enter number(s) to dial
"KRN",.84,42221,-1)
0^39
"KRN",.84,42221,0)
42221^2^y^MAILMAN^Dialing |1|
"KRN",.84,42221,2,0)
^^1^1^3020404^
"KRN",.84,42221,2,1,0)
Dialing |1|
"KRN",.84,42221,3,0)
^.845^1^1
"KRN",.84,42221,3,1,0)
1^number to dial
"KRN",.84,42222,-1)
0^40
"KRN",.84,42222,0)
42222^1^^MAILMAN^Call failed: no XMDIAL
"KRN",.84,42222,2,0)
^^1^1^3020404^
"KRN",.84,42222,2,1,0)
Call failed: no XMDIAL
"KRN",.84,42222.1,-1)
0^41
"KRN",.84,42222.1,0)
42222.1^1^y^MAILMAN^Call failed: |1|
"KRN",.84,42222.1,2,0)
^^1^1^3020404^
"KRN",.84,42222.1,2,1,0)
Call failed: |1|
"KRN",.84,42222.1,3,0)
^.845^1^1
"KRN",.84,42222.1,3,1,0)
1^reason for failure
"KRN",.84,42222.2,-1)
0^42
"KRN",.84,42222.2,0)
42222.2^1^^MAILMAN^Call failed: reason unknown
"KRN",.84,42222.2,2,0)
^^1^1^3020404^
"KRN",.84,42222.2,2,1,0)
Call failed: reason unknown
"KRN",.84,42223,-1)
0^43
"KRN",.84,42223,0)
42223^1^y^MAILMAN^Error msg set to '|1|'
"KRN",.84,42223,2,0)
^^1^1^3020404^
"KRN",.84,42223,2,1,0)
Error msg set to '|1|'
"KRN",.84,42223,3,0)
^.845^1^1
"KRN",.84,42223,3,1,0)
1^error message string
"KRN",.84,42224,-1)
0^44
"KRN",.84,42224,0)
42224^2^^MAILMAN^Flushing buffer
"KRN",.84,42224,2,0)
^^1^1^3020404^
"KRN",.84,42224,2,1,0)
Flushing buffer
"KRN",.84,42225,-1)
0^45
"KRN",.84,42225,0)
42225^2^^MAILMAN^Hanging up phone
"KRN",.84,42225,2,0)
^^1^1^3020404^
"KRN",.84,42225,2,1,0)
Hanging up phone
"KRN",.84,42226,-1)
0^46
"KRN",.84,42226,0)
42226^2^^MAILMAN^Beginning sender-SMTP service
"KRN",.84,42226,2,0)
^^1^1^3020404^
"KRN",.84,42226,2,1,0)
Beginning sender-SMTP service
"KRN",.84,42227,-1)
0^47
"KRN",.84,42227,0)
42227^1^^MAILMAN^Open failed
"KRN",.84,42227,2,0)
^^1^1^3020404^
"KRN",.84,42227,2,1,0)
Open failed
"KRN",.84,42228,-1)
0^48
"KRN",.84,42228,0)
42228^2^y^MAILMAN^Channel opened to |1|
"KRN",.84,42228,2,0)
^^1^1^3020404^
"KRN",.84,42228,2,1,0)
Channel opened to |1|
"KRN",.84,42228,3,0)
^.845^1^1
"KRN",.84,42228,3,1,0)
1^site name
"KRN",.84,42229,-1)
0^130
"KRN",.84,42229,0)
42229^2^y^MAILMAN^Device '|1|', Protocol '|2|' (file 3.4)
"KRN",.84,42229,2,0)
^.844^1^1^3020405^^
"KRN",.84,42229,2,1,0)
Device '|1|', Protocol '|2|' (file 3.4)
"KRN",.84,42229,3,0)
^.845^2^2
"KRN",.84,42229,3,1,0)
1^device name
"KRN",.84,42229,3,2,0)
2^protocol name
"KRN",.84,42230,-1)
0^50
"KRN",.84,42230,0)
42230^2^y^MAILMAN^Transforming '|1|' to '|2|'
"KRN",.84,42230,2,0)
^^1^1^3020404^
"KRN",.84,42230,2,1,0)
Transforming '|1|' to '|2|'
"KRN",.84,42230,3,0)
^.845^2^2
"KRN",.84,42230,3,1,0)
1^before
"KRN",.84,42230,3,2,0)
2^after
"KRN",.84,42231,-1)
0^51
"KRN",.84,42231,0)
42231^1^y^MAILMAN^Undefined reference to '|1|'
"KRN",.84,42231,2,0)
^^1^1^3020404^
"KRN",.84,42231,2,1,0)
Undefined reference to '|1|'
"KRN",.84,42231,3,0)
^.845^1^1
"KRN",.84,42231,3,1,0)
1^undefined item
"KRN",.84,42232,-1)
0^52
"KRN",.84,42232,0)
42232^2^^MAILMAN^Entering Talk mode
"KRN",.84,42232,2,0)
^^1^1^3020404^
"KRN",.84,42232,2,1,0)
Entering Talk mode
"KRN",.84,42233,-1)
0^53
"KRN",.84,42233,0)
42233^2^y^MAILMAN^Waiting |1| seconds
"KRN",.84,42233,2,0)
^^1^1^3020404^
"KRN",.84,42233,2,1,0)
Waiting |1| seconds
"KRN",.84,42233,3,0)
^.845^1^1
"KRN",.84,42233,3,1,0)
1^number of seconds
"KRN",.84,42234,-1)
0^54
"KRN",.84,42234,0)
42234^2^y^MAILMAN^Xecuting '|1|'
"KRN",.84,42234,2,0)
^^1^1^3020404^
"KRN",.84,42234,2,1,0)
Xecuting '|1|'
"KRN",.84,42234,3,0)
^.845^1^1
"KRN",.84,42234,3,1,0)
1^line being executed
"KRN",.84,42235,-1)
0^55
"KRN",.84,42235,0)
42235^1^y^MAILMAN^Can't connect using IP address '|1|'
"KRN",.84,42235,2,0)
^^1^1^3020404^
"KRN",.84,42235,2,1,0)
Can't connect using IP address '|1|'
"KRN",.84,42235,3,0)
^.845^1^1
"KRN",.84,42235,3,1,0)
1^bad IP address
"KRN",.84,42236,-1)
0^56
"KRN",.84,42236,0)
42236^2^^MAILMAN^Resume script processing from line
"KRN",.84,42236,2,0)
^^1^1^3020404^
"KRN",.84,42236,2,1,0)
Resume script processing from line
"KRN",.84,42237,-1)
0^57
"KRN",.84,42237,0)
42237^2^y^MAILMAN^Resuming script from line |1|
"KRN",.84,42237,2,0)
^^1^1^3020404^
"KRN",.84,42237,2,1,0)
Resuming script from line |1|
"KRN",.84,42237,3,0)
^.845^1^1
"KRN",.84,42237,3,1,0)
1^line number in script
"KRN",.84,42240,-1)
0^58
"KRN",.84,42240,0)
42240^2^y^MAILMAN^Look: Timeout=|1|, Command String='|2|'
"KRN",.84,42240,2,0)
^^1^1^3020404^
"KRN",.84,42240,2,1,0)
Look: Timeout=|1|, Command String='|2|'
"KRN",.84,42240,3,0)
^.845^2^2
"KRN",.84,42240,3,1,0)
1^seconds 'til timeout
"KRN",.84,42240,3,2,0)
2^string to look for
"KRN",.84,42241,-1)
0^59
"KRN",.84,42241,0)
42241^1^^MAILMAN^200 Reads!
"KRN",.84,42241,2,0)
^.844^1^1^3020404^^
"KRN",.84,42241,2,1,0)
200 Reads!
"KRN",.84,42244,-1)
0^101
"KRN",.84,42244,0)
42244^1^y^MAILMAN^Invalid Communications Protocol: '|1|'
"KRN",.84,42244,2,0)
^^1^1^3020405^
"KRN",.84,42244,2,1,0)
Invalid Communications Protocol: '|1|'
"KRN",.84,42244,3,0)
^.845^1^1
"KRN",.84,42244,3,1,0)
1^comm protocol name
"KRN",.84,42244,5,0)
^.841^1^1
"KRN",.84,42244,5,1,0)
XML
"KRN",.84,42244,5,"B","XML",1)

"KRN",.84,42245,-1)
0^60
"KRN",.84,42245,0)
42245^1^y^MAILMAN^Invalid parameter '|1|'
"KRN",.84,42245,2,0)
^^1^1^3020404^
"KRN",.84,42245,2,1,0)
Invalid parameter '|1|'
"KRN",.84,42245,3,0)
^.845^1^1
"KRN",.84,42245,3,1,0)
1^bad parameter
"KRN",.84,42246,-1)
0^61
"KRN",.84,42246,0)
42246^1^y^MAILMAN^Device '|1|' could not be opened by %ZIS.
"KRN",.84,42246,2,0)
^^1^1^3020404^
"KRN",.84,42246,2,1,0)
Device '|1|' could not be opened by %ZIS.
"KRN",.84,42246,3,0)
^.845^1^1
"KRN",.84,42246,3,1,0)
1^device name
"KRN",.84,42247,-1)
0^62
"KRN",.84,42247,0)
42247^2^y^MAILMAN^|1| sent, |2| received.
"KRN",.84,42247,2,0)
^^1^1^3020404^
"KRN",.84,42247,2,1,0)
|1| sent, |2| received.
"KRN",.84,42247,3,0)
^.845^2^2
"KRN",.84,42247,3,1,0)
1^msgs sent
"KRN",.84,42247,3,2,0)
2^msgs received
"KRN",.84,42248,-1)
0^63
"KRN",.84,42248,0)
42248^2^y^MAILMAN^|1| sent, |2| received, |3| retrans
"KRN",.84,42248,2,0)
^^1^1^3020404^
"KRN",.84,42248,2,1,0)
|1| sent, |2| received, |3| retransmissions.
"KRN",.84,42248,3,0)
^.845^3^3
"KRN",.84,42248,3,1,0)
1^msgs sent
"KRN",.84,42248,3,2,0)
2^msgs received
"KRN",.84,42248,3,3,0)
3^msgs retransmitted
"KRN",.84,42250,-1)
0^64
"KRN",.84,42250,0)
42250^1^^MAILMAN^File 4.281 is not set up properly.
"KRN",.84,42250,2,0)
^^1^1^3020405^
"KRN",.84,42250,2,1,0)
File 4.281 is not set up properly.
"KRN",.84,42250,5,0)
^.841^1^1
"KRN",.84,42250,5,1,0)
XMCB
"KRN",.84,42250,5,"B","XMCB",1)

"KRN",.84,42251,-1)
0^65
"KRN",.84,42251,0)
42251^2^^MAILMAN^This option transmits messages from one
"KRN",.84,42251,2,0)
^^16^16^3020405^
"KRN",.84,42251,2,1,0)
              ******* I M P O R T A N T *******
"KRN",.84,42251,2,2,0)

"KRN",.84,42251,2,3,0)
This option transmits messages from one UCI to another via ^%ZISL(4.281.
"KRN",.84,42251,2,4,0)
Each UCI must be running MailMan, and file 4.281 must be translated and
"KRN",.84,42251,2,5,0)
accessible from both UCIs.  In the two-step process, the messages are
"KRN",.84,42251,2,6,0)
written to the global from one UCI, and read from it from the other.
"KRN",.84,42251,2,7,0)

"KRN",.84,42251,2,8,0)
Invoke this option on the sending UCI, and select the domain whose messages
"KRN",.84,42251,2,9,0)
are to be transmitted.  (The domain name must be the exact name of the
"KRN",.84,42251,2,10,0)
domain of the receiving UCI - no synonyms.)  The messages are written to
"KRN",.84,42251,2,11,0)
file 4.281 and deleted from the transmit queue.
"KRN",.84,42251,2,12,0)

"KRN",.84,42251,2,13,0)
Log on to the receiving UCI and invoke the receiver.  It will read all
"KRN",.84,42251,2,14,0)
messages in file 4.281 which were sent to it (it can't read any messages
"KRN",.84,42251,2,15,0)
sent to any other domain), and queue them to be delivered.  The messages
"KRN",.84,42251,2,16,0)
will then be deleted from file 4.281.
"KRN",.84,42251,5,0)
^.841^1^1
"KRN",.84,42251,5,1,0)
XMCB
"KRN",.84,42251,5,"B","XMCB",1)

"KRN",.84,42252,-1)
0^66
"KRN",.84,42252,0)
42252^2^^MAILMAN^Dumping messages now
"KRN",.84,42252,2,0)
^^1^1^3020405^
"KRN",.84,42252,2,1,0)
Dumping messages now
"KRN",.84,42252,5,0)
^.841^1^1
"KRN",.84,42252,5,1,0)
XMCB
"KRN",.84,42252,5,"B","XMCB",1)

"KRN",.84,42253,-1)
0^67
"KRN",.84,42253,0)
42253^2^y^MAILMAN^Messages dumped: |1|
"KRN",.84,42253,2,0)
^^1^1^3020405^
"KRN",.84,42253,2,1,0)
Messages dumped: |1|
"KRN",.84,42253,3,0)
^.845^1^1
"KRN",.84,42253,3,1,0)
1^number of messages
"KRN",.84,42253,5,0)
^.841^1^1
"KRN",.84,42253,5,1,0)
XMCB
"KRN",.84,42253,5,"B","XMCB",1)

"KRN",.84,42254,-1)
0^68
"KRN",.84,42254,0)
42254^2^y^MAILMAN^Receive messages for |1|
"KRN",.84,42254,2,0)
^^1^1^3020405^
"KRN",.84,42254,2,1,0)
Receive messages for |1|
"KRN",.84,42254,3,0)
^.845^1^1
"KRN",.84,42254,3,1,0)
1^domain name
"KRN",.84,42254,5,0)
^.841^1^1
"KRN",.84,42254,5,1,0)
XMCB
"KRN",.84,42254,5,"B","XMCB",1)

"KRN",.84,42255,-1)
0^69
"KRN",.84,42255,0)
42255^2^y^MAILMAN^Loading entry #|1| from |2| ...
"KRN",.84,42255,2,0)
^^1^1^3020405^
"KRN",.84,42255,2,1,0)
Loading entry #|1| from |2| ...
"KRN",.84,42255,3,0)
^.845^2^2
"KRN",.84,42255,3,1,0)
1^ien in file 4.281
"KRN",.84,42255,3,2,0)
2^site which sent the messages
"KRN",.84,42255,5,0)
^.841^1^1
"KRN",.84,42255,5,1,0)
XMCB
"KRN",.84,42255,5,"B","XMCB",1)

"KRN",.84,42256,-1)
0^70
"KRN",.84,42256,0)
42256^2^y^MAILMAN^No entries found in file 4.281 for |1|.
"KRN",.84,42256,2,0)
^^1^1^3020405^
"KRN",.84,42256,2,1,0)
No entries found in file 4.281 for |1|
"KRN",.84,42256,3,0)
^.845^1^1
"KRN",.84,42256,3,1,0)
1^receiving site
"KRN",.84,42256,5,0)
^.841^1^1
"KRN",.84,42256,5,1,0)
XMCB
"KRN",.84,42256,5,"B","XMCB",1)

"KRN",.84,42257,-1)
0^71
"KRN",.84,42257,0)
42257^2^y^MAILMAN^Messages received: |1|
"KRN",.84,42257,2,0)
^^1^1^3020405^
"KRN",.84,42257,2,1,0)
Messages received: |1|
"KRN",.84,42257,3,0)
^.845^1^1
"KRN",.84,42257,3,1,0)
1^number of messages
"KRN",.84,42257,5,0)
^.841^1^1
"KRN",.84,42257,5,1,0)
XMCB
"KRN",.84,42257,5,"B","XMCB",1)

"KRN",.84,42260,-1)
0^120
"KRN",.84,42260,0)
42260^2^^MAILMAN^Call DNS for IP Address list ...
"KRN",.84,42260,2,0)
^^1^1^3020405^
"KRN",.84,42260,2,1,0)
Call DNS for IP Address list ...
"KRN",.84,42260,5,0)
^.841^1^1
"KRN",.84,42260,5,1,0)
XMKPRD
"KRN",.84,42260,5,"B","XMKPRD",1)

"KRN",.84,42260.1,-1)
0^140
"KRN",.84,42260.1,0)
42260.1^2^y^MAILMAN^Ignore '|1|' - no IP address
"KRN",.84,42260.1,2,0)
^^1^1^3020416^
"KRN",.84,42260.1,2,1,0)
Ignore '|1|' - no IP address
"KRN",.84,42260.1,3,0)
^.845^1^1
"KRN",.84,42260.1,3,1,0)
1^record returned by dns
"KRN",.84,42260.1,5,0)
^.841^1^1
"KRN",.84,42260.1,5,1,0)
XMKPRD
"KRN",.84,42260.1,5,"B","XMKPRD",1)

"KRN",.84,42260.2,-1)
0^141
"KRN",.84,42260.2,0)
42260.2^2^y^MAILMAN^Ignore '|1|' - that's a different site
"KRN",.84,42260.2,2,0)
^^1^1^3020416^
"KRN",.84,42260.2,2,1,0)
Ignore '|1|' - that's a different site
"KRN",.84,42260.2,3,0)
^.845^1^1
"KRN",.84,42260.2,3,1,0)
1^record returned by dns
"KRN",.84,42260.2,5,0)
^.841^1^1
"KRN",.84,42260.2,5,1,0)
XMKPRD
"KRN",.84,42260.2,5,"B","XMKPRD",1)

"KRN",.84,42260.3,-1)
0^142
"KRN",.84,42260.3,0)
42260.3^2^y^MAILMAN^Ignore '|1|' - already have that IP addr
"KRN",.84,42260.3,2,0)
^^1^1^3020416^
"KRN",.84,42260.3,2,1,0)
Ignore '|1|' - already have that IP address
"KRN",.84,42260.3,3,0)
^.845^1^1
"KRN",.84,42260.3,3,1,0)
1^record returned by dns
"KRN",.84,42260.3,5,0)
^.841^1^1
"KRN",.84,42260.3,5,1,0)
XMKPRD
"KRN",.84,42260.3,5,"B","XMKPRD",1)

"KRN",.84,42260.4,-1)
0^143
"KRN",.84,42260.4,0)
42260.4^2^y^MAILMAN^Accept '|1|'
"KRN",.84,42260.4,2,0)
^^1^1^3020416^
"KRN",.84,42260.4,2,1,0)
Accept '|1|'
"KRN",.84,42260.4,3,0)
^.845^1^1
"KRN",.84,42260.4,3,1,0)
1^record returned by dns
"KRN",.84,42260.4,5,0)
^.841^1^1
"KRN",.84,42260.4,5,1,0)
XMKPRD
"KRN",.84,42260.4,5,"B","XMKPRD",1)

"KRN",.84,42261,-1)
0^121
"KRN",.84,42261,0)
42261^2^^MAILMAN^Returned: Nothing!
"KRN",.84,42261,2,0)
^^1^1^3020405^
"KRN",.84,42261,2,1,0)
Returned: Nothing!
"KRN",.84,42261,5,0)
^.841^1^1
"KRN",.84,42261,5,1,0)
XMKPRD
"KRN",.84,42261,5,"B","XMKPRD",1)

"KRN",.84,42262,-1)
0^122
"KRN",.84,42262,0)
42262^2^y^MAILMAN^Returned: |1|
"KRN",.84,42262,2,0)
^^1^1^3020405^
"KRN",.84,42262,2,1,0)
Returned: |1|
"KRN",.84,42262,3,0)
^.845^1^1
"KRN",.84,42262,3,1,0)
1^ip address list
"KRN",.84,42262,5,0)
^.841^1^1
"KRN",.84,42262,5,1,0)
XMKPRD
"KRN",.84,42262,5,"B","XMKPRD",1)

"KRN",.84,42263,-1)
0^76
"KRN",.84,42263,0)
42263^2^^MAILMAN^DNS is not activated at this site
"KRN",.84,42263,2,0)
^^2^2^3020405^
"KRN",.84,42263,2,1,0)
DNS is not activated at this site, so you'll have to figure out the
"KRN",.84,42263,2,2,0)
correct IP address yourself.
"KRN",.84,42263,5,0)
^.841^1^1
"KRN",.84,42263,5,1,0)
XMCX
"KRN",.84,42263,5,"B","XMCX",1)

"KRN",.84,42264,-1)
0^77
"KRN",.84,42264,0)
42264^2^y^MAILMAN^Let's see what we can do...
"KRN",.84,42264,2,0)
^.844^2^2^3020405^^
"KRN",.84,42264,2,1,0)
Let's see what we can do...
"KRN",.84,42264,2,2,0)
We've tried these: |1|
"KRN",.84,42264,3,0)
^.845^1^1
"KRN",.84,42264,3,1,0)
1^ip addresses tried
"KRN",.84,42264,5,0)
^.841^1^1
"KRN",.84,42264,5,1,0)
XMCX
"KRN",.84,42264,5,"B","XMCX",1)

"KRN",.84,42265,-1)
0^78
"KRN",.84,42265,0)
42265^2^^MAILMAN^The DNS did not return any other addresses
"KRN",.84,42265,2,0)
^^1^1^3020405^
"KRN",.84,42265,2,1,0)
The DNS did not return any other addresses to try.  Sorry!
"KRN",.84,42265,5,0)
^.841^1^1
"KRN",.84,42265,5,1,0)
XMCX
"KRN",.84,42265,5,"B","XMCX",1)

"KRN",.84,42266,-1)
0^79
"KRN",.84,42266,0)
42266^2^y^MAILMAN^Now, let's try: |1|
"KRN",.84,42266,2,0)
^^1^1^3020405^
"KRN",.84,42266,2,1,0)
Now, let's try: |1|
"KRN",.84,42266,3,0)
^.845^1^1
"KRN",.84,42266,3,1,0)
1^ip address to try
"KRN",.84,42266,5,0)
^.841^1^1
"KRN",.84,42266,5,1,0)
XMCX
"KRN",.84,42266,5,"B","XMCX",1)

"KRN",.84,42267,-1)
0^123
"KRN",.84,42267,0)
42267^2^y^MAILMAN^Changed IP address in script from '|1|'
"KRN",.84,42267,2,0)
^^1^1^3020405^
"KRN",.84,42267,2,1,0)
Changed IP address in script from '|1|' to '|2|'
"KRN",.84,42267,3,0)
^.845^2^2
"KRN",.84,42267,3,1,0)
1^old ip
"KRN",.84,42267,3,2,0)
2^new ip
"KRN",.84,42267,5,0)
^.841^1^1
"KRN",.84,42267,5,1,0)
XMTDR
"KRN",.84,42267,5,"B","XMTDR",1)

"KRN",.84,42268,-1)
0^124
"KRN",.84,42268,0)
42268^2^y^MAILMAN^|3| - Changed IP address from '|1|' to
"KRN",.84,42268,2,0)
^^1^1^3020405^
"KRN",.84,42268,2,1,0)
|3| - Changed IP address from '|1|' to '|2|' (MailMan)
"KRN",.84,42268,3,0)
^.845^3^3
"KRN",.84,42268,3,1,0)
1^old ip
"KRN",.84,42268,3,2,0)
2^new ip
"KRN",.84,42268,3,3,0)
3^date/time
"KRN",.84,42268,5,0)
^.841^1^1
"KRN",.84,42268,5,1,0)
XMTDR
"KRN",.84,42268,5,"B","XMTDR",1)

"KRN",.84,42269,-1)
0^1443
"KRN",.84,42269,0)
42269^2^y^MAILMAN^We will not change the IP address in the
"KRN",.84,42269,2,0)
^.844^2^2^3020711^^
"KRN",.84,42269,2,1,0)
We will not change the IP address in the script because the site
"KRN",.84,42269,2,2,0)
self-identifed as |1|, which is not |2| or any of its synonyms.
"KRN",.84,42269,3,0)
^.845^2^2
"KRN",.84,42269,3,1,0)
1^Site name, as identified by the site
"KRN",.84,42269,3,2,0)
2^Site name, that we're expecting
"KRN",.84,42269,5,0)
^.841^1^1
"KRN",.84,42269,5,1,0)
XMTDR
"KRN",.84,42269,5,"B","XMTDR",1)

"KRN",.84,42281,-1)
0^90
"KRN",.84,42281,0)
42281^2^^MAILMAN^* Closed *
"KRN",.84,42281,2,0)
^^1^1^3020405^
"KRN",.84,42281,2,1,0)
* Closed *
"KRN",.84,42281,5,0)
^.841^1^1
"KRN",.84,42281,5,1,0)
XMCXU
"KRN",.84,42281,5,"B","XMCXU",1)

"KRN",.84,42282,-1)
0^91
"KRN",.84,42282,0)
42282^2^^MAILMAN^This option lets you select only those
"KRN",.84,42282,2,0)
^^2^2^3020405^
"KRN",.84,42282,2,1,0)
This option lets you select only those queues which have messages.  If
"KRN",.84,42282,2,2,0)
you can't select a queue, it either doesn't exist or it has no messages.
"KRN",.84,42282,5,0)
^.841^1^1
"KRN",.84,42282,5,1,0)
XMCXU
"KRN",.84,42282,5,"B","XMCXU",1)

"KRN",.84,42283,-1)
0^92
"KRN",.84,42283,0)
42283^2^^MAILMAN^Select queue.  Only queues with messages
"KRN",.84,42283,2,0)
^^1^1^3020405^
"KRN",.84,42283,2,1,0)
Select queue.  Only queues with messages are shown.
"KRN",.84,42283,5,0)
^.841^1^1
"KRN",.84,42283,5,1,0)
XMCXU
"KRN",.84,42283,5,"B","XMCXU",1)

"KRN",.84,42284,-1)
0^93
"KRN",.84,42284,0)
42284^2^^MAILMAN^No valid script for this domain!
"KRN",.84,42284,2,0)
^^1^1^3020405^
"KRN",.84,42284,2,1,0)
No valid script for this domain!
"KRN",.84,42284,5,0)
^.841^1^1
"KRN",.84,42284,5,1,0)
XMCXU
"KRN",.84,42284,5,"B","XMCXU",1)

"KRN",.84,42285,-1)
0^94
"KRN",.84,42285,0)
42285^2^^MAILMAN^#  Script Name   Type   Priority
"KRN",.84,42285,2,0)
^^2^2^3020405^
"KRN",.84,42285,2,1,0)
  #  Script Name              Type      Priority
"KRN",.84,42285,2,2,0)
 --  -----------              ----      --------
"KRN",.84,42285,5,0)
^.841^1^1
"KRN",.84,42285,5,1,0)
XMCXU
"KRN",.84,42285,5,"B","XMCXU",1)

"KRN",.84,42286,-1)
0^95
"KRN",.84,42286,0)
42286^2^^MAILMAN^* Out of Service *
"KRN",.84,42286,2,0)
^^1^1^3020405^
"KRN",.84,42286,2,1,0)
* Out of Service *
"KRN",.84,42286,5,0)
^.841^1^1
"KRN",.84,42286,5,1,0)
XMCXU
"KRN",.84,42286,5,"B","XMCXU",1)

"KRN",.84,42287,-1)
0^96
"KRN",.84,42287,0)
42287^2^^MAILMAN^Select Script: 
"KRN",.84,42287,1,0)
^^1^1^3020405^
"KRN",.84,42287,1,1,0)
There's a blank at the end
"KRN",.84,42287,2,0)
^.844^1^1^3020405^^
"KRN",.84,42287,2,1,0)
Select Script: 
"KRN",.84,42287,5,0)
^.841^1^1
"KRN",.84,42287,5,1,0)
XMCXU
"KRN",.84,42287,5,"B","XMCXU",1)

"KRN",.84,42288,-1)
0^97
"KRN",.84,42288,0)
42288^2^y^MAILMAN^Task |1| is transmitting this domain's
"KRN",.84,42288,2,0)
^^1^1^3020405^
"KRN",.84,42288,2,1,0)
Task |1| is transmitting this domain's messages now.
"KRN",.84,42288,3,0)
^.845^1^1
"KRN",.84,42288,3,1,0)
1^task #
"KRN",.84,42288,5,0)
^.841^1^1
"KRN",.84,42288,5,1,0)
XMCXU
"KRN",.84,42288,5,"B","XMCXU",1)

"KRN",.84,42288.1,-1)
0^98
"KRN",.84,42288.1,0)
42288.1^2^y^MAILMAN^Task |1| is scheduled to transmit this
"KRN",.84,42288.1,2,0)
^^2^2^3020405^
"KRN",.84,42288.1,2,1,0)
Task |1| is scheduled to transmit this domain's messages
"KRN",.84,42288.1,2,2,0)
on |2|.
"KRN",.84,42288.1,3,0)
^.845^2^2
"KRN",.84,42288.1,3,1,0)
1^task #
"KRN",.84,42288.1,3,2,0)
2^date/time
"KRN",.84,42288.1,5,0)
^.841^1^1
"KRN",.84,42288.1,5,1,0)
XMCXU
"KRN",.84,42288.1,5,"B","XMCXU",1)

"KRN",.84,42289,-1)
0^99
"KRN",.84,42289,0)
42289^2^y^MAILMAN^Do you want to kill task |1| and
"KRN",.84,42289,2,0)
^^1^1^3020405^
"KRN",.84,42289,2,1,0)
Do you want to kill task |1| and queue up a new one
"KRN",.84,42289,3,0)
^.845^1^1
"KRN",.84,42289,3,1,0)
1^task #
"KRN",.84,42289,5,0)
^.841^1^1
"KRN",.84,42289,5,1,0)
XMCXU
"KRN",.84,42289,5,"B","XMCXU",1)

"KRN",.84,42289.1,-1)
0^100
"KRN",.84,42289.1,0)
42289.1^2^y^MAILMAN^Do you want to kill task |1| before
"KRN",.84,42289.1,2,0)
^^1^1^3020405^
"KRN",.84,42289.1,2,1,0)
Do you want to kill task |1| before we play the script
"KRN",.84,42289.1,3,0)
^.845^1^1
"KRN",.84,42289.1,3,1,0)
1^task #
"KRN",.84,42289.1,5,0)
^.841^1^1
"KRN",.84,42289.1,5,1,0)
XMCXU
"KRN",.84,42289.1,5,"B","XMCXU",1)

"KRN",.84,42300,-1)
0^102
"KRN",.84,42300,0)
42300^2^y^MAILMAN^Transcript Date: |1|
"KRN",.84,42300,2,0)
^^1^1^3020405^
"KRN",.84,42300,2,1,0)
Transcript Date: |1|
"KRN",.84,42300,3,0)
^.845^1^1
"KRN",.84,42300,3,1,0)
1^date
"KRN",.84,42300,5,0)
^.841^1^1
"KRN",.84,42300,5,1,0)
XMR
"KRN",.84,42300,5,"B","XMR",1)

"KRN",.84,42301,-1)
0^103
"KRN",.84,42301,0)
42301^2^^MAILMAN^Waiting for input
"KRN",.84,42301,2,0)
^^1^1^3020405^
"KRN",.84,42301,2,1,0)
Waiting for input
"KRN",.84,42301,5,0)
^.841^1^1
"KRN",.84,42301,5,1,0)
XMR
"KRN",.84,42301,5,"B","XMR",1)

"KRN",.84,42305,-1)
0^104
"KRN",.84,42305,0)
42305^2^^MAILMAN^Message originated here.
"KRN",.84,42305,2,0)
^^1^1^3020405^
"KRN",.84,42305,2,1,0)
Message originated here.
"KRN",.84,42305,5,0)
^.841^1^1
"KRN",.84,42305,5,1,0)
XMR2
"KRN",.84,42305,5,"B","XMR2",1)

"KRN",.84,42306,-1)
0^105
"KRN",.84,42306,0)
42306^2^^MAILMAN^Previously received message.
"KRN",.84,42306,2,0)
^.844^1^1^3020405^^
"KRN",.84,42306,2,1,0)
Previously received message.
"KRN",.84,42306,5,0)
^.841^1^1
"KRN",.84,42306,5,1,0)
XMR2
"KRN",.84,42306,5,"B","XMR2",1)

"KRN",.84,42307,-1)
0^106
"KRN",.84,42307,0)
42307^2^^MAILMAN^Already purged.
"KRN",.84,42307,2,0)
^^1^1^3020405^
"KRN",.84,42307,2,1,0)
Already purged.
"KRN",.84,42307,5,0)
^.841^1^1
"KRN",.84,42307,5,1,0)
XMR2
"KRN",.84,42307,5,"B","XMR2",1)

"KRN",.84,42308,-1)
0^107
"KRN",.84,42308,0)
42308^2^^MAILMAN^Already purged & replaced with a differ
"KRN",.84,42308,2,0)
^^1^1^3020405^
"KRN",.84,42308,2,1,0)
Already purged & replaced with a different message.
"KRN",.84,42308,5,0)
^.841^1^1
"KRN",.84,42308,5,1,0)
XMR2
"KRN",.84,42308,5,"B","XMR2",1)

"KRN",.84,42309,-1)
0^108
"KRN",.84,42309,0)
42309^2^^MAILMAN^Delivering to additional recipients.
"KRN",.84,42309,2,0)
^^1^1^3020405^
"KRN",.84,42309,2,1,0)
Delivering to additional recipients.
"KRN",.84,42309,5,0)
^.841^1^1
"KRN",.84,42309,5,1,0)
XMR2
"KRN",.84,42309,5,"B","XMR2",1)

"KRN",.84,42315,-1)
0^109
"KRN",.84,42315,0)
42315^2^y^MAILMAN^Putting response |1| into message |2|
"KRN",.84,42315,2,0)
^^1^1^3020405^
"KRN",.84,42315,2,1,0)
> Putting response |1| into message |2|
"KRN",.84,42315,3,0)
^.845^2^2
"KRN",.84,42315,3,1,0)
1^response ien in file 3.9
"KRN",.84,42315,3,2,0)
2^message ien in file 3.9
"KRN",.84,42315,5,0)
^.841^1^1
"KRN",.84,42315,5,1,0)
XMR3
"KRN",.84,42315,5,"B","XMR3",1)

"KRN",.84,42316,-1)
0^110
"KRN",.84,42316,0)
42316^2^y^MAILMAN^Delivering message |1|
"KRN",.84,42316,2,0)
^.844^1^1^3020405^^
"KRN",.84,42316,2,1,0)
> Delivering message |1|
"KRN",.84,42316,3,0)
^.845^1^1
"KRN",.84,42316,3,1,0)
1^message ien in file 3.9
"KRN",.84,42316,5,0)
^.841^1^1
"KRN",.84,42316,5,1,0)
XMR3
"KRN",.84,42316,5,"B","XMR3",1)

"KRN",.84,42350,-1)
0^111
"KRN",.84,42350,0)
42350^1^^MAILMAN^Domain file locked.
"KRN",.84,42350,2,0)
^^1^1^3020405^
"KRN",.84,42350,2,1,0)
Domain file locked.
"KRN",.84,42350,5,0)
^.841^1^1
"KRN",.84,42350,5,1,0)
XMS
"KRN",.84,42350,5,"B","XMS",1)

"KRN",.84,42351,-1)
0^112
"KRN",.84,42351,0)
42351^1^y^MAILMAN^HELO Send failed: |1|
"KRN",.84,42351,2,0)
^^1^1^3020405^
"KRN",.84,42351,2,1,0)
HELO Send failed: |1|
"KRN",.84,42351,3,0)
^.845^1^1
"KRN",.84,42351,3,1,0)
1^error message
"KRN",.84,42351,5,0)
^.841^1^1
"KRN",.84,42351,5,1,0)
XMS
"KRN",.84,42351,5,"B","XMS",1)

"KRN",.84,42352,-1)
0^113
"KRN",.84,42352,0)
42352^1^^MAILMAN^HELO Receive failed.
"KRN",.84,42352,2,0)
^^1^1^3020405^
"KRN",.84,42352,2,1,0)
HELO Receive failed.
"KRN",.84,42352,5,0)
^.841^1^1
"KRN",.84,42352,5,1,0)
XMS
"KRN",.84,42352,5,"B","XMS",1)

"KRN",.84,42353,-1)
0^114
"KRN",.84,42353,0)
42353^1^y^MAILMAN^|1| not recognized by |2|
"KRN",.84,42353,2,0)
^^1^1^3020405^
"KRN",.84,42353,2,1,0)
|1| not recognized by |2|
"KRN",.84,42353,3,0)
^.845^2^2
"KRN",.84,42353,3,1,0)
1^this site's name
"KRN",.84,42353,3,2,0)
2^the other site's name
"KRN",.84,42353,5,0)
^.841^1^1
"KRN",.84,42353,5,1,0)
XMS
"KRN",.84,42353,5,"B","XMS",1)

"KRN",.84,42354,-1)
0^115
"KRN",.84,42354,0)
42354^1^^MAILMAN^Queue being transmitted by another job
"KRN",.84,42354,2,0)
^^1^1^3020405^
"KRN",.84,42354,2,1,0)
Queue being transmitted by another job - Aborting now.
"KRN",.84,42354,5,0)
^.841^1^1
"KRN",.84,42354,5,1,0)
XMS
"KRN",.84,42354,5,"B","XMS",1)

"KRN",.84,42355,-1)
0^116
"KRN",.84,42355,0)
42355^2^^MAILMAN^Turning around receiver
"KRN",.84,42355,2,0)
^^1^1^3020405^
"KRN",.84,42355,2,1,0)
Turning around receiver
"KRN",.84,42355,5,0)
^.841^1^1
"KRN",.84,42355,5,1,0)
XMS
"KRN",.84,42355,5,"B","XMS",1)

"KRN",.84,42355.1,-1)
0^1441
"KRN",.84,42355.1,0)
42355.1^2^y^MAILMAN^TURN command disabled for |1|
"KRN",.84,42355.1,2,0)
^^1^1^3020702^
"KRN",.84,42355.1,2,1,0)
TURN command disabled for |1|
"KRN",.84,42355.1,3,0)
^.845^1^1
"KRN",.84,42355.1,3,1,0)
1^name of site we're talking to
"KRN",.84,42355.1,5,0)
^.841^1^1
"KRN",.84,42355.1,5,1,0)
XMS
"KRN",.84,42355.1,5,"B","XMS",1)

"KRN",.84,42356,-1)
0^118
"KRN",.84,42356,0)
42356^1^^MAILMAN^Receiver will not accept DATA
"KRN",.84,42356,2,0)
^^1^1^3020405^
"KRN",.84,42356,2,1,0)
Receiver will not accept DATA.
"KRN",.84,42356,5,0)
^.841^1^1
"KRN",.84,42356,5,1,0)
XMS1
"KRN",.84,42356,5,"B","XMS1",1)

"KRN",.84,42357,-1)
0^119
"KRN",.84,42357,0)
42357^1^^MAILMAN^Msg transmit aborted - remote msg
"KRN",.84,42357,2,0)
^.844^1^1^3020405^^
"KRN",.84,42357,2,1,0)
Msg transmit aborted - remote msg with no remote msg ID.
"KRN",.84,42357,5,0)
^.841^1^1
"KRN",.84,42357,5,1,0)
XMS2
"KRN",.84,42357,5,"B","XMS2",1)

"KRN",.84,42358,-1)
0^1442
"KRN",.84,42358,0)
42358^2^^MAILMAN^There are no messages in the queue to send
"KRN",.84,42358,2,0)
^^1^1^3020702^
"KRN",.84,42358,2,1,0)
There are no messages in the queue to send
"KRN",.84,42358,5,0)
^.841^1^1
"KRN",.84,42358,5,1,0)
XMS
"KRN",.84,42358,5,"B","XMS",1)

"KRN",.84,89895015,-1)
1^1446
"KRN",.84,89895015,0)
34425
"KRN",.84,89895016,-1)
1^1447
"KRN",.84,89895016,0)
34443
"KRN",.84,89895017,-1)
1^1448
"KRN",.84,89895017,0)
34443.1
"KRN",3.6,12,-1)
0^32
"KRN",3.6,12,0)
XMRDACK^Confirmation of message
"KRN",3.6,12,1,0)
^3.61A^3^3^2990306^^^^
"KRN",3.6,12,1,1,0)
Your message:
"KRN",3.6,12,1,2,0)
Subj: |1|
"KRN",3.6,12,1,3,0)
has been read by |2|.
"KRN",3.6,12,3,0)
^3.63^4^4^2990306^^^^
"KRN",3.6,12,3,1,0)
This bulletin is used by MailMan to inform the sender of a message
"KRN",3.6,12,3,2,0)
that a recipient has read the message.
"KRN",3.6,12,3,3,0)
The sender of the message must have set the CONFIRMATION REQUESTED
"KRN",3.6,12,3,4,0)
flag to ON when the message was created.
"KRN",3.6,12,4,0)
^3.64A^2^2
"KRN",3.6,12,4,1,0)
1
"KRN",3.6,12,4,1,1,0)
^^1^1^2990306^^
"KRN",3.6,12,4,1,1,1,0)
Message subject
"KRN",3.6,12,4,2,0)
2
"KRN",3.6,12,4,2,1,0)
^^1^1^2990306^^
"KRN",3.6,12,4,2,1,1,0)
Name of the user who just read the message
"KRN",3.6,15,-1)
0^31
"KRN",3.6,15,0)
XMNEWUSER^NEW USER ADDED TO SYSTEM
"KRN",3.6,15,1,0)
^^1^1^2990617^
"KRN",3.6,15,1,1,0)
User |1| has been added to the New Person file.
"KRN",3.6,15,3,0)
^^2^2^2840514^^^
"KRN",3.6,15,3,1,0)
This message is  sent whenever a new user is added to 
"KRN",3.6,15,3,2,0)
the user file
"KRN",3.6,15,4,0)
^3.64A^1^1
"KRN",3.6,15,4,1,0)
1
"KRN",3.6,15,4,1,1,0)
^^1^1^2831210^^^
"KRN",3.6,15,4,1,1,1,0)
THE NAME OF THE USER WHO IS ADDED TO THE SYSTEM
"KRN",3.6,18,-1)
0^16
"KRN",3.6,18,0)
XM BANNER MESSAGE^CHANGE IN USER'S 'BANNER' for MAILMAN
"KRN",3.6,18,1,0)
^^2^2^2940202^^^^
"KRN",3.6,18,1,1,0)
The MailMan "banner" for |2| has been changed to read:
"KRN",3.6,18,1,2,0)
|1||TAB|
"KRN",3.6,18,3,0)
^^1^1^2931206^
"KRN",3.6,18,3,1,0)
This bulletin might be generated when a user changes his banner.
"KRN",3.6,18,4,0)
^3.64A^2^2
"KRN",3.6,18,4,1,0)
1
"KRN",3.6,18,4,1,1,0)
^^1^1^2841221^^
"KRN",3.6,18,4,1,1,1,0)
The contents of the new BANNER
"KRN",3.6,18,4,2,0)
2
"KRN",3.6,18,4,2,1,0)
^^1^1^2931206^^^^
"KRN",3.6,18,4,2,1,1,0)
Name of Mailbox holder whose banner has been changed
"KRN",3.6,25,-1)
0^36
"KRN",3.6,25,0)
XMVALBAD^Invalid validation number received
"KRN",3.6,25,1,0)
^3.61A^1^1^3020508^^^^
"KRN",3.6,25,1,1,0)
validation breach to domain |1|.
"KRN",3.6,25,3,0)
^3.63^5^5^3020508^^^^
"KRN",3.6,25,3,1,0)
This bulletin is fired whenever a remote mailman domain attempts to 
"KRN",3.6,25,3,2,0)
establish a connection with this domain and the validation numbers
"KRN",3.6,25,3,3,0)
do not properly match.  This may indicate a attempted breach of security
"KRN",3.6,25,3,4,0)
or some other network failure.  In order to re-establish communication with 
"KRN",3.6,25,3,5,0)
this domain, call the site manager to reset your validation numbers.
"KRN",3.6,25,4,0)
^3.64A^1^1
"KRN",3.6,25,4,1,0)
1
"KRN",3.6,25,4,1,1,0)
^^1^1^2861101^^^^
"KRN",3.6,25,4,1,1,1,0)
name of domain attempting to get in
"KRN",3.6,27,-1)
0^34
"KRN",3.6,27,0)
XM_TRANSMISSION_ERROR^MailMan Error Detected During Message Delivery
"KRN",3.6,27,1,0)
^3.61A^2^2^3000728^^^^
"KRN",3.6,27,1,1,0)
During message delivery, the following error was detected:
"KRN",3.6,27,1,2,0)
 
"KRN",3.6,27,3,0)
^3.63^5^5^3000728^^^^
"KRN",3.6,27,3,1,0)
This bulletin is fired off when the background delivery process
"KRN",3.6,27,3,2,0)
detects an error.  The message or response it is supposed to deliver
"KRN",3.6,27,3,3,0)
does not exist.  We just move on to the next message.
"KRN",3.6,27,3,4,0)

"KRN",3.6,27,3,5,0)
There are no parameters.  The error text is appended to the bulletin.
"KRN",3.6,27,4,0)
^3.64A^^0
"KRN",3.6,28,-1)
0^13
"KRN",3.6,28,0)
XM FWD ADDRESS CHANGE^New forwarding address for |1|
"KRN",3.6,28,1,0)
^3.61A^3^3^3020423^^^^
"KRN",3.6,28,1,1,0)
The new forwarding address for |1| is:
"KRN",3.6,28,1,2,0)

"KRN",3.6,28,1,3,0)
|2|
"KRN",3.6,28,3,0)
^3.63^3^3^3020423^^
"KRN",3.6,28,3,1,0)
This bulletin is generated when a user's forwarding address changes.
"KRN",3.6,28,3,2,0)
It is meant to be sent to IRM, or anyone with a need to know about
"KRN",3.6,28,3,3,0)
a user's forwarding address.
"KRN",3.6,28,4,0)
^3.64A^2^2
"KRN",3.6,28,4,1,0)
1
"KRN",3.6,28,4,1,1,0)
^3.65^1^1^3020423^^^^
"KRN",3.6,28,4,1,1,1,0)
User's name
"KRN",3.6,28,4,2,0)
2
"KRN",3.6,28,4,2,1,0)
^^1^1^3020423^
"KRN",3.6,28,4,2,1,1,0)
User's forwarding address
"KRN",3.6,29,-1)
0^26
"KRN",3.6,29,0)
XM SEND ERR RECIPIENT^Message not delivered to recipient
"KRN",3.6,29,1,0)
^3.61A^7^7^2980729^^^^
"KRN",3.6,29,1,1,0)
Your message [#|5|]
"KRN",3.6,29,1,2,0)
SUBJECT: |1|
"KRN",3.6,29,1,3,0)
was not delivered to |2|.
"KRN",3.6,29,1,4,0)
The error message was:
"KRN",3.6,29,1,5,0)

"KRN",3.6,29,1,6,0)
|3|
"KRN",3.6,29,1,7,0)
<|4|>
"KRN",3.6,29,3,0)
^3.63^3^3^2980529^^^^
"KRN",3.6,29,3,1,0)
This message is issued by the MailMan network processor when a message
"KRN",3.6,29,3,2,0)
recipient has been rejected by the remote node.  The rejection message
"KRN",3.6,29,3,3,0)
of the remote node is included in the bulletin.
"KRN",3.6,29,4,0)
^3.64A^5^5
"KRN",3.6,29,4,1,0)
1
"KRN",3.6,29,4,1,1,0)
^^1^1^2970902^^
"KRN",3.6,29,4,1,1,1,0)
The subject of the message
"KRN",3.6,29,4,2,0)
2
"KRN",3.6,29,4,2,1,0)
^^1^1^2970902^^^
"KRN",3.6,29,4,2,1,1,0)
The recipient, as specified by the user
"KRN",3.6,29,4,3,0)
3
"KRN",3.6,29,4,3,1,0)
^^1^1^2970902^^
"KRN",3.6,29,4,3,1,1,0)
The error message returned by the remote site.
"KRN",3.6,29,4,4,0)
4
"KRN",3.6,29,4,4,1,0)
^^1^1^2980529^^
"KRN",3.6,29,4,4,1,1,0)
The recipient, as attempted by MailMan
"KRN",3.6,29,4,5,0)
5
"KRN",3.6,29,4,5,1,0)
^^1^1^2980729^
"KRN",3.6,29,4,5,1,1,0)
This is the message IEN in the message file 3.9.
"KRN",3.6,30,-1)
0^28
"KRN",3.6,30,0)
XM SEND ERR SERVER MSG^XMIT Err:  Server Message not found
"KRN",3.6,30,1,0)
^^4^4^2970828^
"KRN",3.6,30,1,1,0)
Message not delivered to server |1|
"KRN",3.6,30,1,2,0)
because the message was not in the message file (3.9).
"KRN",3.6,30,1,3,0)

"KRN",3.6,30,1,4,0)
Task #|2| has been left for your action.
"KRN",3.6,30,3,0)
^^2^2^2970828^
"KRN",3.6,30,3,1,0)
This bulletin is fired when a task tries to send a message to a server,
"KRN",3.6,30,3,2,0)
but the message is not in the Message global.
"KRN",3.6,30,4,0)
^3.64A^2^2
"KRN",3.6,30,4,1,0)
1
"KRN",3.6,30,4,1,1,0)
^^1^1^2970828^
"KRN",3.6,30,4,1,1,1,0)
Name of the server to which the message was supposed to go.
"KRN",3.6,30,4,2,0)
2
"KRN",3.6,30,4,2,1,0)
^^1^1^2970828^
"KRN",3.6,30,4,2,1,1,0)
Task number for the task responsible for sending the message to the server.
"KRN",3.6,31,-1)
0^27
"KRN",3.6,31,0)
XM SEND ERR REMOTE MSG ID^Transmit Error: No Remote Msg ID
"KRN",3.6,31,1,0)
^^3^3^2970902^^
"KRN",3.6,31,1,1,0)
Message #|1| originated from a remote site.
"KRN",3.6,31,1,2,0)
It should have a 'remote message id' on node 5, but it doesn't.
"KRN",3.6,31,1,3,0)
To prevent duplicate message deliveries, it was not delivered.
"KRN",3.6,31,3,0)
^^6^6^2970902^^
"KRN",3.6,31,3,1,0)
While trying to send a response to a message which originated from a
"KRN",3.6,31,3,2,0)
remote site, we noticed that the 'remote message id' is missing from
"KRN",3.6,31,3,3,0)
the original message.  Without this id, we can't tell the site which
"KRN",3.6,31,3,4,0)
message we are responding to.
"KRN",3.6,31,3,5,0)

"KRN",3.6,31,3,6,0)
'remote message id' is field 9 in file 3.9.
"KRN",3.6,31,4,0)
^3.64A^1^1
"KRN",3.6,31,4,1,0)
1
"KRN",3.6,31,4,1,1,0)
^^1^1^2970828^
"KRN",3.6,31,4,1,1,1,0)
XMZ, or message number in file 3.9
"KRN",3.6,32,-1)
0^25
"KRN",3.6,32,0)
XM SEND ERR MSG^Message not delivered
"KRN",3.6,32,1,0)
^^7^7^2970902^^
"KRN",3.6,32,1,1,0)
Your message, SUBJECT: |1|
"KRN",3.6,32,1,2,0)
was rejected by |2|
"KRN",3.6,32,1,3,0)

"KRN",3.6,32,1,4,0)
The error message was:
"KRN",3.6,32,1,5,0)
|3|
"KRN",3.6,32,1,6,0)

"KRN",3.6,32,1,7,0)
Intended recipients were:
"KRN",3.6,32,3,0)
^^3^3^2970902^^
"KRN",3.6,32,3,1,0)
When a remote site rejects an entire message for whatever reason
"KRN",3.6,32,3,2,0)
(too many lines, for example), this bulletin is sent to the message
"KRN",3.6,32,3,3,0)
originator.
"KRN",3.6,32,4,0)
^3.64A^3^3
"KRN",3.6,32,4,1,0)
1
"KRN",3.6,32,4,1,1,0)
^^1^1^2970902^
"KRN",3.6,32,4,1,1,1,0)
Subject of the message
"KRN",3.6,32,4,2,0)
2
"KRN",3.6,32,4,2,1,0)
^^1^1^2970902^
"KRN",3.6,32,4,2,1,1,0)
Site which rejected the message
"KRN",3.6,32,4,3,0)
3
"KRN",3.6,32,4,3,1,0)
^^1^1^2970902^
"KRN",3.6,32,4,3,1,1,0)
Error message returned by the site
"KRN",3.6,33,-1)
0^20
"KRN",3.6,33,0)
XM FWD ADDRESS DELETE^Forwarding Address Deleted
"KRN",3.6,33,1,0)
^^4^4^2990206^
"KRN",3.6,33,1,1,0)
Your forwarding address: |1|
"KRN",3.6,33,1,2,0)
has been deleted because it is not valid.
"KRN",3.6,33,1,3,0)
The error message is:
"KRN",3.6,33,1,4,0)
|2|
"KRN",3.6,33,3,0)
^^3^3^2990208^^
"KRN",3.6,33,3,1,0)
This bulletin is sent when MailMan notices that a user has an invalid
"KRN",3.6,33,3,2,0)
forwarding address.  The forwarding address is deleted, and the user
"KRN",3.6,33,3,3,0)
is notified why.
"KRN",3.6,33,4,0)
^3.64A^2^2
"KRN",3.6,33,4,1,0)
1
"KRN",3.6,33,4,1,1,0)
^^1^1^2990206^
"KRN",3.6,33,4,1,1,1,0)
User's invalid forwarding address.
"KRN",3.6,33,4,2,0)
2
"KRN",3.6,33,4,2,1,0)
^^1^1^2990208^^
"KRN",3.6,33,4,2,1,1,0)
Error message as to why the user's address is invalid.
"KRN",3.6,34,-1)
0^22
"KRN",3.6,34,0)
XM GROUP ERROR^Error in Mail Group
"KRN",3.6,34,1,0)
^^2^2^2990213^
"KRN",3.6,34,1,1,0)
While addressing a message to mail group: |1|
"KRN",3.6,34,1,2,0)
the following problems were noted:
"KRN",3.6,34,3,0)
^^6^6^2990213^
"KRN",3.6,34,3,1,0)
Notifies selected users of problems with a mail group.
"KRN",3.6,34,3,2,0)
Such problems may include:
"KRN",3.6,34,3,3,0)
- Group contains a circular reference to a group.
"KRN",3.6,34,3,4,0)
- Local member should not be receiving mail (no access code).
"KRN",3.6,34,3,5,0)
- Remote member has invalid or ambiguous or closed domain.
"KRN",3.6,34,3,6,0)
- Distribution list domain is invalid or ambiguous or closed.
"KRN",3.6,34,4,0)
^3.64A^1^1
"KRN",3.6,34,4,1,0)
1
"KRN",3.6,34,4,1,1,0)
^^1^1^2990213^
"KRN",3.6,34,4,1,1,1,0)
The mail group under which the problems were noted.
"KRN",3.6,37,-1)
0^29
"KRN",3.6,37,0)
XM SUPER SEARCH^Super Search Conducted^90
"KRN",3.6,37,1,0)
^3.61A^3^3^3000918^^^
"KRN",3.6,37,1,1,0)
|1| conducted a Super Search of the Message file.
"KRN",3.6,37,1,2,0)
 
"KRN",3.6,37,1,3,0)
The criteria used were:
"KRN",3.6,37,3,0)
^3.63^12^12^3000907^^^^
"KRN",3.6,37,3,1,0)
Every time a super search is conducted, this bulletin is sent to alert
"KRN",3.6,37,3,2,0)
those responsible for ensuring that the capability is not misused.
"KRN",3.6,37,3,3,0)

"KRN",3.6,37,3,4,0)
A super search is a search of the entire Message file based on any number
"KRN",3.6,37,3,5,0)
of criteria.  All messages are looked at, regardless of who sent them.
"KRN",3.6,37,3,6,0)

"KRN",3.6,37,3,7,0)
This bulletin reports who performed the search and what criteria were used.
"KRN",3.6,37,3,8,0)

"KRN",3.6,37,3,9,0)
This bulletin is sent to the mail group XM SUPER SEARCH.
"KRN",3.6,37,3,10,0)
The ISO should be a member of that group.
"KRN",3.6,37,3,11,0)

"KRN",3.6,37,3,12,0)
See the XM SUPER SEARCH option for more information.
"KRN",3.6,37,4,0)
^3.64A^1^1
"KRN",3.6,37,4,1,0)
1
"KRN",3.6,37,4,1,1,0)
^3.65^1^1^3000918^^
"KRN",3.6,37,4,1,1,1,0)
The user who conducted the Super Search.
"KRN",3.6,38,-1)
0^19
"KRN",3.6,38,0)
XM FILTER FWD ADDRESS DELETE^Filter 'forward to' Address Deleted^30
"KRN",3.6,38,1,0)
^^4^4^3001017^
"KRN",3.6,38,1,1,0)
Your 'forward to' address: |1|
"KRN",3.6,38,1,2,0)
has been deleted from your filter: |2|
"KRN",3.6,38,1,3,0)
because it is not valid.  The error message is:
"KRN",3.6,38,1,4,0)
|3|
"KRN",3.6,38,3,0)
^^3^3^3001017^
"KRN",3.6,38,3,1,0)
This bulletin is sent when MailMan notices that a user has an invalid
"KRN",3.6,38,3,2,0)
'forward to' address in one of the filters.  The 'forward to' address
"KRN",3.6,38,3,3,0)
is deleted, and the user is notified why.
"KRN",3.6,38,4,0)
^3.64A^3^3
"KRN",3.6,38,4,1,0)
1
"KRN",3.6,38,4,1,1,0)
^^1^1^3001017^
"KRN",3.6,38,4,1,1,1,0)
User's invalid 'forward to' address.
"KRN",3.6,38,4,2,0)
2
"KRN",3.6,38,4,2,1,0)
^^1^1^3001017^
"KRN",3.6,38,4,2,1,1,0)
The name of the filter containing the invalid address.
"KRN",3.6,38,4,3,0)
3
"KRN",3.6,38,4,3,1,0)
^^1^1^3001017^
"KRN",3.6,38,4,3,1,1,0)
Error message as to why the address is invalid.
"KRN",3.6,39,-1)
0^17
"KRN",3.6,39,0)
XM DATE PURGE WARNING^Date Purge Scheduled for |1|^^1
"KRN",3.6,39,1,0)
^3.61A^23^23^3001121^^^^
"KRN",3.6,39,1,1,0)
Attention!  On |1|, all* messages (and their responses)
"KRN",3.6,39,1,2,0)
sent on or before |2| will be deleted from the system.
"KRN",3.6,39,1,3,0)
They will be gone forever.
"KRN",3.6,39,1,4,0)

"KRN",3.6,39,1,5,0)
You can find out if this will affect any messages in your mailbox and
"KRN",3.6,39,1,6,0)
take appropriate measures.
"KRN",3.6,39,1,7,0)

"KRN",3.6,39,1,8,0)
From the main MailMan menu, respond to the prompts as follows:
"KRN",3.6,39,1,9,0)

"KRN",3.6,39,1,10,0)
Select MailMan Menu Option: Query/Search for Messages
"KRN",3.6,39,1,11,0)
                            =
"KRN",3.6,39,1,12,0)
Select message search method: M  Search my Mailbox by multiple criteria
"KRN",3.6,39,1,13,0)
                              =
"KRN",3.6,39,1,14,0)
Select search action: Enter 'Subject contains' string// DB  Enter 'Message
"KRN",3.6,39,1,15,0)
sent on or before' date                                 ==
"KRN",3.6,39,1,16,0)
Message sent on or before: |2|
"KRN",3.6,39,1,17,0)
                           |3|
"KRN",3.6,39,1,18,0)

"KRN",3.6,39,1,19,0)
This search will find all of your messages which will be deleted.
"KRN",3.6,39,1,20,0)

"KRN",3.6,39,1,21,0)
* Messages in SHARED,MAIL's mailbox, and messages in the POSTMASTER's
"KRN",3.6,39,1,22,0)
remote transmit queues and server baskets (includes released patches
"KRN",3.6,39,1,23,0)
on FORUM) are exempt from the purge.
"KRN",3.6,39,3,0)
^3.63^3^3^3001121^^^^
"KRN",3.6,39,3,1,0)
This is the warning bulletin that is broadcast to all users whenever
"KRN",3.6,39,3,2,0)
option XMPURGE-BY-DATE is used to purge messages older than a certain
"KRN",3.6,39,3,3,0)
date.  See that option for more information.
"KRN",3.6,39,4,0)
^3.64A^3^3
"KRN",3.6,39,4,1,0)
1
"KRN",3.6,39,4,1,1,0)
^^1^1^3001116^
"KRN",3.6,39,4,1,1,1,0)
The date that the date purge will run.
"KRN",3.6,39,4,2,0)
2
"KRN",3.6,39,4,2,1,0)
^3.65^1^1^3001121^^
"KRN",3.6,39,4,2,1,1,0)
All messages this date and older will be purged.
"KRN",3.6,39,4,3,0)
3
"KRN",3.6,39,4,3,1,0)
^^1^1^3001121^
"KRN",3.6,39,4,3,1,1,0)
A line of '=', just as long as parameter 2.
"KRN",3.6,40,-1)
0^18
"KRN",3.6,40,0)
XM DOMAIN ADDED^New Domain: |1|
"KRN",3.6,40,1,0)
^3.61A^14^14^3001121^^
"KRN",3.6,40,1,1,0)
This site has just received an incoming transmission from
"KRN",3.6,40,1,2,0)
'|2|'.  Since we have no record of this domain
"KRN",3.6,40,1,3,0)
in the DOMAIN file 4.2, and did not find '|1|' in the
"KRN",3.6,40,1,4,0)
INTERNET SUFFIX file 4.2996, we have added '|1|' to the
"KRN",3.6,40,1,5,0)
DOMAIN file.
"KRN",3.6,40,1,6,0)

"KRN",3.6,40,1,7,0)
If you think this domain should be added to file 4.2996,
"KRN",3.6,40,1,8,0)
please enter a NOIS.  Only internationally recognized internet
"KRN",3.6,40,1,9,0)
suffixes should be added to file 4.2996, and then only via
"KRN",3.6,40,1,10,0)
a MailMan patch.
"KRN",3.6,40,1,11,0)

"KRN",3.6,40,1,12,0)
If you think this domain may be a poorly named VHA domain,
"KRN",3.6,40,1,13,0)
please enter a NOIS.  All new VHA domains should end in
"KRN",3.6,40,1,14,0)
'.MED.VA.GOV'.
"KRN",3.6,40,3,0)
^3.63^9^9^3001121^^
"KRN",3.6,40,3,1,0)
This bulletin is sent to alert IRM to the new domain.  This shouldn't happen
"KRN",3.6,40,3,2,0)
very often, and if it does, the domain name should be investigated.
"KRN",3.6,40,3,3,0)

"KRN",3.6,40,3,4,0)
If you think that it is a bad name, enter a NOIS so it can be investigated.
"KRN",3.6,40,3,5,0)

"KRN",3.6,40,3,6,0)
If this new top-level domain is a valid internet suffix, it should be
"KRN",3.6,40,3,7,0)
deleted from the DOMAIN file and added to file 4.2996, INTERNET SUFFIX,
"KRN",3.6,40,3,8,0)
and a NOIS should be entered for MailMan, so that a patch can be sent
"KRN",3.6,40,3,9,0)
out to add this top-level domain to file 4.2996 at every site.
"KRN",3.6,40,4,0)
^3.64A^2^2
"KRN",3.6,40,4,1,0)
1
"KRN",3.6,40,4,1,1,0)
^^1^1^3001121^
"KRN",3.6,40,4,1,1,1,0)
Top-level (last dot piece) domain name.
"KRN",3.6,40,4,2,0)
2
"KRN",3.6,40,4,2,1,0)
^^1^1^3001121^
"KRN",3.6,40,4,2,1,1,0)
Full domain name
"KRN",3.6,41,-1)
0^21
"KRN",3.6,41,0)
XM GROUP EDIT NOTIFY^Users have been added to your mail group^30
"KRN",3.6,41,1,0)
^3.61A^3^3^3010213^^^^
"KRN",3.6,41,1,1,0)
|1| added the following users
"KRN",3.6,41,1,2,0)
as members to mail group '|2|':
"KRN",3.6,41,1,3,0)
 
"KRN",3.6,41,3,0)
^3.63^5^5^3010209^^
"KRN",3.6,41,3,1,0)
This bulletin is sent to a mail group's organizer and coordinator
"KRN",3.6,41,3,2,0)
whenever someone other than themselves adds users to:
"KRN",3.6,41,3,3,0)
1) a public mail group which doesn't allow users to self-enroll, or
"KRN",3.6,41,3,4,0)
2) any private mail group.
"KRN",3.6,41,3,5,0)
The purpose is to let them know of the change.
"KRN",3.6,41,4,0)
^3.64A^2^2
"KRN",3.6,41,4,1,0)
1
"KRN",3.6,41,4,1,1,0)
^^1^1^3010209^
"KRN",3.6,41,4,1,1,1,0)
user who added members to the mail group
"KRN",3.6,41,4,2,0)
2
"KRN",3.6,41,4,2,1,0)
^^1^1^3010209^
"KRN",3.6,41,4,2,1,1,0)
mail group name
"KRN",3.6,42,-1)
0^35
"KRN",3.6,42,0)
XM SEND ERR TRANSMISSION^Transmit Failure to |1|^30
"KRN",3.6,42,1,0)
^3.61A^4^4^3020423^^
"KRN",3.6,42,1,1,0)
Transmission has failed to |1|
"KRN",3.6,42,1,2,0)
|2| times with the latest script.
"KRN",3.6,42,1,3,0)

"KRN",3.6,42,1,4,0)
The following errors occurred in the latest script:
"KRN",3.6,42,3,0)
^^2^2^3020405^
"KRN",3.6,42,3,1,0)
This bulletin is sent when MailMan is unable to transmit to a site
"KRN",3.6,42,3,2,0)
after it has tried all the available scripts.
"KRN",3.6,42,4,0)
^3.64A^2^2
"KRN",3.6,42,4,1,0)
1
"KRN",3.6,42,4,1,1,0)
^^1^1^3020405^
"KRN",3.6,42,4,1,1,1,0)
Name of site we're trying to transmit to
"KRN",3.6,42,4,2,0)
2
"KRN",3.6,42,4,2,1,0)
^^1^1^3020405^
"KRN",3.6,42,4,2,1,1,0)
Number of times this script has failed
"KRN",3.6,43,-1)
0^30
"KRN",3.6,43,0)
XM TOO MANY MESSAGES^Please Terminate Messages^30^1
"KRN",3.6,43,1,0)
^^6^6^3020410^
"KRN",3.6,43,1,1,0)
You have at least |1| messages in your mailbox.
"KRN",3.6,43,1,2,0)
(|2| in your IN basket)
"KRN",3.6,43,1,3,0)

"KRN",3.6,43,1,4,0)
Please terminate all of your unnecessary messages.
"KRN",3.6,43,1,5,0)

"KRN",3.6,43,1,6,0)
Thank-you.
"KRN",3.6,43,3,0)
^^2^2^3020410^
"KRN",3.6,43,3,1,0)
This bulletin is sent by option XMMGR-DISK-MANY MESSAGE-MAINT, to ask
"KRN",3.6,43,3,2,0)
users to terminate excess messages.
"KRN",3.6,43,4,0)
^3.64A^2^2
"KRN",3.6,43,4,1,0)
1
"KRN",3.6,43,4,1,1,0)
^^1^1^3020410^
"KRN",3.6,43,4,1,1,1,0)
number of messages in mailbox
"KRN",3.6,43,4,2,0)
2
"KRN",3.6,43,4,2,1,0)
^^1^1^3020410^
"KRN",3.6,43,4,2,1,1,0)
number of messages in IN basket
"KRN",3.6,44,-1)
0^15
"KRN",3.6,44,0)
XM FWD ADDRESS CHECK^Test new forwarding address for |1|^30
"KRN",3.6,44,1,0)
^3.61A^7^7^3020423^^
"KRN",3.6,44,1,1,0)
This is a test to confirm that the forwarding address
"KRN",3.6,44,1,2,0)

"KRN",3.6,44,1,3,0)
     |2|
"KRN",3.6,44,1,4,0)

"KRN",3.6,44,1,5,0)
belonging to |1| does not generate an error.
"KRN",3.6,44,1,6,0)

"KRN",3.6,44,1,7,0)
Please ignore this message.
"KRN",3.6,44,3,0)
^3.63^5^5^3020423^^
"KRN",3.6,44,3,1,0)
This bulletin is sent when a user's forwarding address changes.
"KRN",3.6,44,3,2,0)
It is sent to the forwarding address.  If it gets through, fine.
"KRN",3.6,44,3,3,0)
If it doesn't, then the sender of the bulletin is notified.  The
"KRN",3.6,44,3,4,0)
sender is the POSTMASTER.  Field 7.01 in file 4.3 controls whether
"KRN",3.6,44,3,5,0)
the message is also sent to the POSTMASTER.
"KRN",3.6,44,4,0)
^3.64A^2^2
"KRN",3.6,44,4,1,0)
1
"KRN",3.6,44,4,1,1,0)
^^1^1^3020410^
"KRN",3.6,44,4,1,1,1,0)
User's name
"KRN",3.6,44,4,2,0)
2
"KRN",3.6,44,4,2,1,0)
^3.65^1^1^3020423^^
"KRN",3.6,44,4,2,1,1,0)
User's forwarding address
"KRN",3.6,45,-1)
0^24
"KRN",3.6,45,0)
XM IN BASKET PURGE WARNING^Mailbox Maintenance
"KRN",3.6,45,1,0)
^^3^3^3020410^
"KRN",3.6,45,1,1,0)
You have not read the following messages in over |1| days.
"KRN",3.6,45,1,2,0)
MailMan will delete them on |2|, unless they become new
"KRN",3.6,45,1,3,0)
or you read them or save them to another basket.
"KRN",3.6,45,3,0)
^^1^1^3020410^
"KRN",3.6,45,3,1,0)
Sent by option XMMGR-IN-BASKET-PURGE
"KRN",3.6,45,4,0)
^3.64A^2^2
"KRN",3.6,45,4,1,0)
1
"KRN",3.6,45,4,1,1,0)
^^1^1^3020410^
"KRN",3.6,45,4,1,1,1,0)
messages not read in at least this many days
"KRN",3.6,45,4,2,0)
2
"KRN",3.6,45,4,2,1,0)
^^1^1^3020410^
"KRN",3.6,45,4,2,1,1,0)
Date messages will be deleted
"KRN",3.6,46,-1)
0^23
"KRN",3.6,46,0)
XM IN BASKET PURGE REQUEST^Mailbox Maintenance
"KRN",3.6,46,1,0)
^^3^3^3020410^
"KRN",3.6,46,1,1,0)
You have not read the following messages in over |1| days.
"KRN",3.6,46,1,2,0)
If you don't need them, consider deleting them.
"KRN",3.6,46,1,3,0)
MailMan will not delete them.
"KRN",3.6,46,3,0)
^3.63^1^1^3020411^^
"KRN",3.6,46,3,1,0)
Sent by TEST^XMUPIN.
"KRN",3.6,46,4,0)
^3.64A^1^1
"KRN",3.6,46,4,1,0)
1
"KRN",3.6,46,4,1,1,0)
^^1^1^3020410^
"KRN",3.6,46,4,1,1,1,0)
messages not read in at least this many days
"KRN",3.6,51,-1)
1^2
"KRN",3.6,51,0)
XMMISS
"KRN",3.6,52,-1)
1^3
"KRN",3.6,52,0)
XMNEWBUL
"KRN",3.6,53,-1)
1^4
"KRN",3.6,53,0)
XMQFAIL
"KRN",3.6,54,-1)
1^5
"KRN",3.6,54,0)
XMRDNAK
"KRN",3.6,55,-1)
1^6
"KRN",3.6,55,0)
XMREPNAK
"KRN",3.6,56,-1)
1^7
"KRN",3.6,56,0)
XMTFAIL
"KRN",3.6,57,-1)
1^8
"KRN",3.6,57,0)
XMUSERNO
"KRN",3.6,58,-1)
1^9
"KRN",3.6,58,0)
XMVADABORT
"KRN",3.6,59,-1)
1^10
"KRN",3.6,59,0)
XMDATANO
"KRN",3.6,60,-1)
1^12
"KRN",3.6,60,0)
XM-FWD-ADDRESS-CHECKER
"KRN",3.6,61,-1)
1^14
"KRN",3.6,61,0)
XMZFWDBULL
"KRN",3.8,14,-1)
0^1
"KRN",3.8,14,0)
XM SUPER SEARCH^PU^n^^^^
"KRN",3.8,14,2,0)
^3.801^15^15^3000908^^^^
"KRN",3.8,14,2,1,0)
This mail group is sent a bulletin whenever someone conducts a Super
"KRN",3.8,14,2,2,0)
Search using the XM SUPER SEARCH option.  The bulletin tells who
"KRN",3.8,14,2,3,0)
conducted the search and what search criteria were used.
"KRN",3.8,14,2,4,0)

"KRN",3.8,14,2,5,0)
Members of this mail group should be anyone who ought to be notified
"KRN",3.8,14,2,6,0)
whenever a Super Search is conducted.  At an absolute minimum, the
"KRN",3.8,14,2,7,0)
site ISO and alternate ISO(s) should be members.  There should be
"KRN",3.8,14,2,8,0)
enough responsible members of the group so that a certain level of
"KRN",3.8,14,2,9,0)
comfort is achieved that the Super Searches will only be conducted
"KRN",3.8,14,2,10,0)
for just cause.  The more people there are, who are aware that a
"KRN",3.8,14,2,11,0)
Super Search has been conducted, the less likely it is that the
"KRN",3.8,14,2,12,0)
capability will be abused.
"KRN",3.8,14,2,13,0)
 
"KRN",3.8,14,2,14,0)
The site Information Security Officer should be the coordinator of
"KRN",3.8,14,2,15,0)
this group.
"KRN",9.2,162,-1)
0^342
"KRN",9.2,162,0)
XM-U-M-PRIORITY SEND^SENDING MESSAGES WITH A PRIORITY STATUS^3020718.1348^
"KRN",9.2,162,1,0)
^9.21^21^21^3020718^^^
"KRN",9.2,162,1,1,0)
 
"KRN",9.2,162,1,2,0)
You can use the Priority Delivery action code (i.e., 'P') to send a
"KRN",9.2,162,1,3,0)
message as priority. This is a toggle action code. If you enter 'P' again,
"KRN",9.2,162,1,4,0)
the message will not be sent as priority. Priority messages are not sent
"KRN",9.2,162,1,5,0)
before other messages. However, when recipients are reading new mail,
"KRN",9.2,162,1,6,0)
priority messages are displayed first.
"KRN",9.2,162,1,7,0)
 
"KRN",9.2,162,1,8,0)
MailMan allows users to send a message as priority mail. By sending mail
"KRN",9.2,162,1,9,0)
priority, the sender indicates the message is very important and should
"KRN",9.2,162,1,10,0)
take precedence over any other mail in another recipient's mailbox.
"KRN",9.2,162,1,11,0)
Because of that, MailMan notifies recipients when they have priority mail
"KRN",9.2,162,1,12,0)
and highlights that mail in their list of messages (i.e., places an
"KRN",9.2,162,1,13,0)
exclamation point ('!') to the left of each priority message).
"KRN",9.2,162,1,14,0)
 
"KRN",9.2,162,1,15,0)
No [FORWARDING] is allowed to mail groups except by the sender of the
"KRN",9.2,162,1,16,0)
message. MailMan also provides recipients with the ability to control how
"KRN",9.2,162,1,17,0)
responses to priority mail are handled through the PRIORITY RESPONSES [FLAG]
"KRN",9.2,162,1,18,0)
and the PRIORITY RESPONSES [PROMPT] fields in the User Options Edit option.
"KRN",9.2,162,1,19,0)
 
"KRN",9.2,162,1,20,0)
To send a priority message, enter a 'P' at the 'Select Message option:
"KRN",9.2,162,1,21,0)
Transmit now//' prompt.
"KRN",9.2,162,2,0)
^9.22A^3^3
"KRN",9.2,162,2,1,0)
FORWARDING^XM-U-M-FORWARD
"KRN",9.2,162,2,2,0)
FLAG^XM-U-P-PRIORITY FLAG
"KRN",9.2,162,2,3,0)
PROMPT^XM-U-P-PRIORITY PROMPT
"KRN",9.2,166,-1)
0^100
"KRN",9.2,166,0)
XM-U-I-SHARED MAIL^SHARED,MAIL - A LIBRARY OF MESSAGES^2931222.141^
"KRN",9.2,166,1,0)
^^20^20^2981228^
"KRN",9.2,166,1,1,0)
 
"KRN",9.2,166,1,2,0)
SHARED,MAIL is a good way to distribute data, request help, and search for
"KRN",9.2,166,1,3,0)
things you need.
"KRN",9.2,166,1,4,0)
 
"KRN",9.2,166,1,5,0)
After you choose the Become a Surrogate (SHARED,MAIL or Other) option and
"KRN",9.2,166,1,6,0)
if another MailMan user has not designated you as a [SURROGATE], you are
"KRN",9.2,166,1,7,0)
automatically made a surrogate of SHARED,MAIL.
"KRN",9.2,166,1,8,0)
 
"KRN",9.2,166,1,9,0)
As a surrogate to SHARED,MAIL, the user is only allowed Read access
"KRN",9.2,166,1,10,0)
privileges. Therefore, the surrogate is able to read any piece of mail in
"KRN",9.2,166,1,11,0)
any SHARED,MAIL basket, and they can respond to any message. However, in
"KRN",9.2,166,1,12,0)
the case the user has been assigned the XMNOPRIV key, they cannot access
"KRN",9.2,166,1,13,0)
SHARED,MAIL.
"KRN",9.2,166,1,14,0)
 
"KRN",9.2,166,1,15,0)
All users can send messages to SHARED,MAIL as they would send them to any
"KRN",9.2,166,1,16,0)
other user. However, messages sent to SHARED,MAIL must be given 'Automatic
"KRN",9.2,166,1,17,0)
Deletion Dates' and be sent to a particular basket so that readers can
"KRN",9.2,166,1,18,0)
more easily find them.
"KRN",9.2,166,1,19,0)
 
"KRN",9.2,166,1,20,0)
SHARED,MAIL never has any new messages.
"KRN",9.2,166,2,0)
^9.22A^1^1
"KRN",9.2,166,2,1,0)
SURROGATE^XM-U-I-SURROGATE
"KRN",9.2,167,-1)
0^178
"KRN",9.2,167,0)
XM-U-M-VAPORIZE DATE EDIT^VAPORIZE MESSAGE WITH AUTOMATIC DELETION DATE^3000607.1526^^
"KRN",9.2,167,1,0)
^9.21^20^20^3000607^^^^
"KRN",9.2,167,1,1,0)
 
"KRN",9.2,167,1,2,0)
You can use the Vaporize Date Edit action code (i.e., 'V') to set a
"KRN",9.2,167,1,3,0)
message or group of messages to be deleted from your mailbox at a
"KRN",9.2,167,1,4,0)
specific date and time or to modify a Vaporize Date already set.
"KRN",9.2,167,1,5,0)
Vaporize means automatically delete.
"KRN",9.2,167,1,6,0)
 
"KRN",9.2,167,1,7,0)
Vaporize dates set by you (or by MailMan during message delivery) remain with
"KRN",9.2,167,1,8,0)
the message until the message is deleted or until you remove the vaporize date.
"KRN",9.2,167,1,9,0)
The vaporize date remains in effect even if the message becomes new.
"KRN",9.2,167,1,10,0)

"KRN",9.2,167,1,11,0)
Vaporize dates set by MailMan (during the IN-BASKET PURGE) remain with
"KRN",9.2,167,1,12,0)
the message only as long as the message remains dormant, or until the
"KRN",9.2,167,1,13,0)
message is deleted.  As soon as you read the message or save it to another
"KRN",9.2,167,1,14,0)
basket or it becomes new, the vaporize date will be removed.
"KRN",9.2,167,1,15,0)
 
"KRN",9.2,167,1,16,0)
A message that is scheduled for vaporization  will be deleted on the scheduled
"KRN",9.2,167,1,17,0)
date.  However, you are free to modify or remove the AUTOMATIC DELETION DATE
"KRN",9.2,167,1,18,0)
(i.e., Vaporize Date) at any time prior to the vaporization date.
"KRN",9.2,167,1,19,0)

"KRN",9.2,167,1,20,0)
 [MORE]... 
"KRN",9.2,167,2,0)
^9.22A^1^1
"KRN",9.2,167,2,1,0)
MORE^XM-U-M-VAPORIZE DATE EDIT-2
"KRN",9.2,169,-1)
0^98
"KRN",9.2,169,0)
XM-U-I-GROUP MEMBER^MEMBERS OF MAIL GROUPS^2931206.2002^
"KRN",9.2,169,1,0)
^^20^20^2990107^
"KRN",9.2,169,1,1,0)
 
"KRN",9.2,169,1,2,0)
Mail Groups can contain any combination of the following types of members:
"KRN",9.2,169,1,3,0)
 
"KRN",9.2,169,1,4,0)
  LOCAL             - Members that are individuals that use the local
"KRN",9.2,169,1,5,0)
                      system.
"KRN",9.2,169,1,6,0)
 
"KRN",9.2,169,1,7,0)
  MEMBER GROUP      - A mail group may be a member of other mail groups.
"KRN",9.2,169,1,8,0)
                      More than one mail group can concurrently be members
"KRN",9.2,169,1,9,0)
                      of the same mail group.
"KRN",9.2,169,1,10,0)
 
"KRN",9.2,169,1,11,0)
  DISTRIBUTION LIST - Distribution Lists can be set up through VA FileMan.
"KRN",9.2,169,1,12,0)
                      A Distribution List has a name and a list of
"KRN",9.2,169,1,13,0)
                      domains. If a Distribution list is a member of a
"KRN",9.2,169,1,14,0)
                      Mail Group (and more than one can be) then the
"KRN",9.2,169,1,15,0)
                      expansion of it will cause the message to be sent to
"KRN",9.2,169,1,16,0)
                      the Distribution List name at each of the domains in
"KRN",9.2,169,1,17,0)
                      the list. [PRIVATE] Mail Groups, however, cannot
"KRN",9.2,169,1,18,0)
                      contain Distribution Lists.
"KRN",9.2,169,1,19,0)
 
"KRN",9.2,169,1,20,0)
  REMOTE            - Members that are in none of the other categories.
"KRN",9.2,169,2,0)
^9.22A^1^1
"KRN",9.2,169,2,1,0)
PRIVATE^XM-U-P-GROUP PERSONAL
"KRN",9.2,170,-1)
0^181
"KRN",9.2,170,0)
XM-U-M-WRITE^SENDING A NEW MESSAGE INSTEAD OF A REPLY^2990428.0719^
"KRN",9.2,170,1,0)
^^21^21^2990428^^
"KRN",9.2,170,1,1,0)
 
"KRN",9.2,170,1,2,0)
You can use the Write action code (i.e., 'W') to 'write' (compose) a new
"KRN",9.2,170,1,3,0)
message while reading a message. The steps of creating a message using the
"KRN",9.2,170,1,4,0)
Write action code are the same as if you used the [SEND] a Message option.
"KRN",9.2,170,1,5,0)
 
"KRN",9.2,170,1,6,0)
Use the Write action code to immediately send a message while reading another
"KRN",9.2,170,1,7,0)
message. For example, if after reading a message, you suddenly remember that
"KRN",9.2,170,1,8,0)
you need to send a message about an unrelated matter to somebody else or if
"KRN",9.2,170,1,9,0)
you just want to send a message to the sender or one of the recipients of the
"KRN",9.2,170,1,10,0)
message you are reading. Rather than having to go through the Send a Message
"KRN",9.2,170,1,11,0)
option, you could simply enter the Write action code.
"KRN",9.2,170,1,12,0)
 
"KRN",9.2,170,1,13,0)
The 'Write' command allows you to compose a new message, address it to a
"KRN",9.2,170,1,14,0)
separate set of [RECIPIENTS], and deliver it. After composing and sending
"KRN",9.2,170,1,15,0)
your message, MailMan will automatically return you to the original
"KRN",9.2,170,1,16,0)
message where you can continue with your reading.
"KRN",9.2,170,1,17,0)
 
"KRN",9.2,170,1,18,0)
To write and send a new message while reading another message, enter a 'W'
"KRN",9.2,170,1,19,0)
at the 'Enter message action' prompt.
"KRN",9.2,170,1,20,0)
 
"KRN",9.2,170,1,21,0)
[MORE]... 
"KRN",9.2,170,2,0)
^9.22A^3^3
"KRN",9.2,170,2,1,0)
SEND^XM-U-M-SEND
"KRN",9.2,170,2,2,0)
RECIPIENTS^XM-U-A-ADDRESS
"KRN",9.2,170,2,3,0)
MORE^XM-U-M-WRITE-2
"KRN",9.2,171,-1)
0^94
"KRN",9.2,171,0)
XM-U-I-EDITOR FM LINE^VA FILEMAN LINE EDITOR^2990120.1619^^
"KRN",9.2,171,1,0)
^^21^21^2990120^^^
"KRN",9.2,171,1,1,0)
 
"KRN",9.2,171,1,2,0)
When using the Line Editor, one line is entered at a time, with a carriage
"KRN",9.2,171,1,3,0)
return being entered at the end of each line. Line numbers which appear at
"KRN",9.2,171,1,4,0)
the left of the screen are used for reference while editing and are not
"KRN",9.2,171,1,5,0)
part of the message. When the entire message is entered, the user enters a
"KRN",9.2,171,1,6,0)
carriage return at the line number of the next line. The 'Edit Option:'
"KRN",9.2,171,1,7,0)
prompt then appears. Entering '??' will display the editor options, which
"KRN",9.2,171,1,8,0)
include:
"KRN",9.2,171,1,9,0)
 
"KRN",9.2,171,1,10,0)
  * Add Lines              * Join List Line(s)
"KRN",9.2,171,1,11,0)
  * Break a Line           * Move Line 
"KRN",9.2,171,1,12,0)
  * Change Every String    * Print Line(s)
"KRN",9.2,171,1,13,0)
  * Delete Line(s)         * Repeat Line(s)
"KRN",9.2,171,1,14,0)
  * Edit a Line            * Search & Transfer
"KRN",9.2,171,1,15,0)
  * Insert Line(s)
"KRN",9.2,171,1,16,0)
 
"KRN",9.2,171,1,17,0)
The Transfer command allows you to use all VA FileMan text fields (via
"KRN",9.2,171,1,18,0)
extended references) and especially MailMan messages as a scratch pad. To
"KRN",9.2,171,1,19,0)
use the Transfer command enter a 'T' after the 'Edit option:' prompt and
"KRN",9.2,171,1,20,0)
enter a message subject, internal message identification number, or an
"KRN",9.2,171,1,21,0)
extended reference to any other file with a TEXT field.
"KRN",9.2,173,-1)
0^73
"KRN",9.2,173,0)
XM-U-B-XMIT PRIORITY TOGGLE^TOGGLING MESSAGE TRANSMISSION PRIORITY^3020222.1228^^
"KRN",9.2,173,1,0)
^9.21^18^18^3020222^^^^
"KRN",9.2,173,1,1,0)
 
"KRN",9.2,173,1,2,0)
Messages waiting to be sent to remote domains are placed in special baskets
"KRN",9.2,173,1,3,0)
owned by the POSTMASTER.  We call these the transmit queues.  The POSTMASTER
"KRN",9.2,173,1,4,0)
is able to manipulate, to a certain degree, the order in which they are sent.
"KRN",9.2,173,1,5,0)
 
"KRN",9.2,173,1,6,0)
Sometimes, messages stack up in the transmit queues waiting to be delivered.
"KRN",9.2,173,1,7,0)
One or more of these messages could be very important (i.e., it needs to go
"KRN",9.2,173,1,8,0)
first). For example, one of the messages could be a site's payroll data
"KRN",9.2,173,1,9,0)
destined for FOC-AUSTIN.VA.GOV. Conversely, one or more of these messages
"KRN",9.2,173,1,10,0)
could be very unimportant (i.e., it should let the others go first).
"KRN",9.2,173,1,11,0)
 
"KRN",9.2,173,1,12,0)
MailMan usually sends out the messages in the queue according to their date
"KRN",9.2,173,1,13,0)
of creation. However, the POSTMASTER may use the 'toggle transmit priority'
"KRN",9.2,173,1,14,0)
command (i.e., 'X'), to change the transmit priority. Thus, some messages
"KRN",9.2,173,1,15,0)
can be flagged to transmit before the rest (high priority), while others can
"KRN",9.2,173,1,16,0)
be flagged to transmit after the rest (low priority).
"KRN",9.2,173,1,17,0)
 
"KRN",9.2,173,1,18,0)
[MORE]...
"KRN",9.2,173,2,0)
^9.22A^2^1
"KRN",9.2,173,2,2,0)
MORE^XM-U-B-XMIT PRIORITY TOGGLE-2
"KRN",9.2,174,-1)
0^264
"KRN",9.2,174,0)
XMHELP-MANUAL^THE ONLINE MAILMAN USER MANUAL^2990121.0718^^
"KRN",9.2,174,1,0)
^^19^19^2990121^^^^
"KRN",9.2,174,1,1,0)

"KRN",9.2,174,1,2,0)
                          January 1999
"KRN",9.2,174,1,3,0)

"KRN",9.2,174,1,4,0)
                  Department of Veterans Affairs
"KRN",9.2,174,1,5,0)

"KRN",9.2,174,1,6,0)

"KRN",9.2,174,1,7,0)

"KRN",9.2,174,1,8,0)

"KRN",9.2,174,1,9,0)

"KRN",9.2,174,1,10,0)
                  To start reading, enter [MORE]...
"KRN",9.2,174,1,11,0)

"KRN",9.2,174,1,12,0)

"KRN",9.2,174,1,13,0)

"KRN",9.2,174,1,14,0)

"KRN",9.2,174,1,15,0)

"KRN",9.2,174,1,16,0)

"KRN",9.2,174,1,17,0)

"KRN",9.2,174,1,18,0)

"KRN",9.2,174,1,19,0)

"KRN",9.2,174,2,0)
^9.22^2^1
"KRN",9.2,174,2,2,0)
MORE^XMHELP
"KRN",9.2,178,-1)
0^155
"KRN",9.2,178,0)
XM-U-M-PRIORITY TOGGLE^PRIORITY REPLIES TOGGLE^2920930.1613^
"KRN",9.2,178,1,0)
^^19^19^2990427^
"KRN",9.2,178,1,1,0)
 
"KRN",9.2,178,1,2,0)
When messages are sent with a priority status, recipients can control
"KRN",9.2,178,1,3,0)
whether future responses will be delivered as priority on a message by
"KRN",9.2,178,1,4,0)
message basis.
"KRN",9.2,178,1,5,0)
 
"KRN",9.2,178,1,6,0)
You can use the Priority Replies Toggle action code (i.e., 'K') to switch
"KRN",9.2,178,1,7,0)
from receiving responses to a priority message as priority or not
"KRN",9.2,178,1,8,0)
depending on how you set your PRIORITY RESPONSES [FLAG]. To toggle between
"KRN",9.2,178,1,9,0)
'Responses are ORDINARY' and 'Responses are PRIORITY', enter a 'K' at the
"KRN",9.2,178,1,10,0)
'Enter message action' prompt.
"KRN",9.2,178,1,11,0)
 
"KRN",9.2,178,1,12,0)
The PRIORITY RESPONSES [FLAG] field is available through the User Options
"KRN",9.2,178,1,13,0)
Edit option located on the Personal Preferences menu. It controls the
"KRN",9.2,178,1,14,0)
delivery of responses to messages with a priority status.
"KRN",9.2,178,1,15,0)
 
"KRN",9.2,178,1,16,0)
In addition, you can also control whether or not you are prompted in the
"KRN",9.2,178,1,17,0)
first place by editing the PRIORITY RESPONSES [PROMPT] field also
"KRN",9.2,178,1,18,0)
available through the User Options Edit option located on the Personal
"KRN",9.2,178,1,19,0)
Preferences menu.
"KRN",9.2,178,2,0)
^9.22A^2^2
"KRN",9.2,178,2,1,0)
PROMPT^XM-U-P-PRIORITY PROMPT
"KRN",9.2,178,2,2,0)
FLAG^XM-U-P-PRIORITY FLAG
"KRN",9.2,179,-1)
0^114
"KRN",9.2,179,0)
XM-U-M-ANSWER^ANSWERING A MESSAGE (INTERNET STYLE)^2990428.0657^^
"KRN",9.2,179,1,0)
^^21^21^2990428^^
"KRN",9.2,179,1,1,0)
 
"KRN",9.2,179,1,2,0)
You can use the Answer action code (i.e., 'A') to answer a message. While
"KRN",9.2,179,1,3,0)
[REPLYING] to a message chains the new response to the original message,
"KRN",9.2,179,1,4,0)
the Answer command issues a new message to send to the sender of the original
"KRN",9.2,179,1,5,0)
message, a new message that will not be chained to the original message.
"KRN",9.2,179,1,6,0)
 
"KRN",9.2,179,1,7,0)
The 'Answer' message consists of three components in the following order:
"KRN",9.2,179,1,8,0)
 
"KRN",9.2,179,1,9,0)
  1. A copy of the message being answered.
"KRN",9.2,179,1,10,0)
  2. The text of your answer.
"KRN",9.2,179,1,11,0)
  3. The three lines of your Network Signature.
"KRN",9.2,179,1,12,0)
 
"KRN",9.2,179,1,13,0)
When you answer a message the original message is copied before you are
"KRN",9.2,179,1,14,0)
placed in the editor. Thus, 'Answer' first copies the original message,
"KRN",9.2,179,1,15,0)
adds your network signature, and then puts you into the editor. Once
"KRN",9.2,179,1,16,0)
you're finished with your answer, it is sent as a separate message to the
"KRN",9.2,179,1,17,0)
sender of the original message.
"KRN",9.2,179,1,18,0)
 
"KRN",9.2,179,1,19,0)
In order to use the Answer command, you must have a [NETWORK SIGNATURE].
"KRN",9.2,179,1,20,0)
 
"KRN",9.2,179,1,21,0)
To 'Answer' a message, enter an 'A' at the 'Enter message action' prompt.
"KRN",9.2,179,2,0)
^9.22A^2^2
"KRN",9.2,179,2,1,0)
NETWORK SIGNATURE^XM-U-P-NETWORK SIGNATURE
"KRN",9.2,179,2,2,0)
REPLYING^XM-U-M-REPLY
"KRN",9.2,181,-1)
0^86
"KRN",9.2,181,0)
XM-U-H-Q DISAPPEARED^'DISAPPEARED' MESSAGES WHICH HAVE NOT BEEN DELETED^2931023.1649^
"KRN",9.2,181,1,0)
^^14^14^2990107^
"KRN",9.2,181,1,1,0)
 
"KRN",9.2,181,1,2,0)
Sometimes the [READ] option will show only the message header without
"KRN",9.2,181,1,3,0)
the text. What happened to the original message?
"KRN",9.2,181,1,4,0)
 
"KRN",9.2,181,1,5,0)
Messages will not 'disappear' unless you specifically [DELETE] them.
"KRN",9.2,181,1,6,0)
 
"KRN",9.2,181,1,7,0)
After a message has been read, replied to, and the reply has been read,
"KRN",9.2,181,1,8,0)
the message text will no longer be displayed automatically when you
"KRN",9.2,181,1,9,0)
attempt to read the message. This is to avoid forcing you to read thru
"KRN",9.2,181,1,10,0)
text you've already seen.
"KRN",9.2,181,1,11,0)
 
"KRN",9.2,181,1,12,0)
However, the text is there. At the 'Enter message option' prompt, respond
"KRN",9.2,181,1,13,0)
with a 'B' for [BACKUP]. You can then choose the reply you wish to read.
"KRN",9.2,181,1,14,0)
Enter zero ('0') to see the original message.
"KRN",9.2,181,2,0)
^9.22A^3^3
"KRN",9.2,181,2,1,0)
READ^XM-U-R-READ
"KRN",9.2,181,2,2,0)
BACKUP^XM-U-M-BACKUP
"KRN",9.2,181,2,3,0)
DELETE^XM-U-M-DELETE
"KRN",9.2,190,-1)
0^291
"KRN",9.2,190,0)
XMNET-MULTIMEDIA^HOW MULTIMEDIA MAILMAN WORKS^2931206.2021^^
"KRN",9.2,190,1,0)
^^18^18^2981221^
"KRN",9.2,190,1,1,0)
  
"KRN",9.2,190,1,2,0)
 1. Multimedia [TECHNICAL OVERVIEW]
"KRN",9.2,190,1,3,0)
 2. Sending and Receiving BLOBs across a [BLOB NETWORK] 
"KRN",9.2,190,1,4,0)
 3. Basic [COMPONENTS] needed to run Multimedia mail
"KRN",9.2,190,1,5,0)
 4. Kernel site parameters that are used by the Multimedia sender
"KRN",9.2,190,1,6,0)
    and receiver
"KRN",9.2,190,1,7,0)
    FTP Receive Directory : This field stores the information that is
"KRN",9.2,190,1,8,0)
        passed from the receiver to the sender about where to put the
"KRN",9.2,190,1,9,0)
        file that is coming.  In this way the receiver can dynamically
"KRN",9.2,190,1,10,0)
        control where images will be received.
"KRN",9.2,190,1,11,0)
    FTP Address for BLOB Receive : This field contains an IP address so
"KRN",9.2,190,1,12,0)
        that the receiver can dynamically control the machine that the
"KRN",9.2,190,1,13,0)
        sender will connect to when it send the image.
"KRN",9.2,190,1,14,0)
    FTP Username : It contains the username that the FTP process has to 
"KRN",9.2,190,1,15,0)
        use in order to log into this system.
"KRN",9.2,190,1,16,0)
    FTP Password : It contains the logic that the sender will have to make
"KRN",9.2,190,1,17,0)
        in order to log into this system via FTP.  
"KRN",9.2,190,1,18,0)
    [FTP RECEIVE NETWORK LOCATION]
"KRN",9.2,190,2,0)
^9.22^11^4
"KRN",9.2,190,2,2,0)
TECHNICAL OVERVIEW^XMNET-MULTIMEDIA-OVERVIEW^
"KRN",9.2,190,2,3,0)
BLOB NETWORK^XMNET-BLOB-NETWORK^
"KRN",9.2,190,2,4,0)
COMPONENTS^XMNET-FTP-COMPONENTS^
"KRN",9.2,190,2,11,0)
FTP RECEIVE NETWORK LOCATION^XMNET-FTP-REC-NETWORK-LOCATION^
"KRN",9.2,191,-1)
0^293
"KRN",9.2,191,0)
XMNET-MULTIMEDIA-OVERVIEW^Multimedia Technical Overview^2931206.203^^
"KRN",9.2,191,1,0)
11^^22^22^2931206^^^^
"KRN",9.2,191,1,1,0)
 When using an imaging workstations, a user can view images that are linked
"KRN",9.2,191,1,2,0)
 to a message on a second screen.  This works using standard calls to the
"KRN",9.2,191,1,3,0)
 API of the imaging product.  Images are brought off of a file server on
"KRN",9.2,191,1,4,0)
 the local area network via ethernet and displayed.  Network transmissions 
"KRN",9.2,191,1,5,0)
 of messages are performed from a platform that has both NFS capabilities
"KRN",9.2,191,1,6,0)
 and TCP/IP.  Images are delivered off of the file server that is on the
"KRN",9.2,191,1,7,0)
 local area network into a directory that is mounted via NFS onto this 
"KRN",9.2,191,1,8,0)
 platform, again by a call to the imaging API.  The relationships of
"KRN",9.2,191,1,9,0)
 multimedia [HARDWARE] must be setup correctly.
"KRN",9.2,191,1,10,0)
 The network transmission works by sending a message first.  During the
"KRN",9.2,191,1,11,0)
 exchange of message protocol data units, information is exchanged about
"KRN",9.2,191,1,12,0)
 the [BLOB] that is going to be sent via FTP.  The sender indicates that
"KRN",9.2,191,1,13,0)
 there is a BLOB to send.  The receiver replies with the IP address to 
"KRN",9.2,191,1,14,0)
 send the message to and the directory to put it in.  The sender then
"KRN",9.2,191,1,15,0)
 constructs a series of commands that will access the FTP software
"KRN",9.2,191,1,16,0)
 running on that machine, stores in as a file that can be executed in
"KRN",9.2,191,1,17,0)
 batch mode and puts an entry MUMPS global to indicate that the file needs
"KRN",9.2,191,1,18,0)
 to be executed.  A background process in MUMPS (XMRTCP), polls this file
"KRN",9.2,191,1,19,0)
 every few seconds and when it sees an entry, it makes a request to the
"KRN",9.2,191,1,20,0)
 imaging API to move the appropriate image into the export directory.  
"KRN",9.2,191,1,21,0)
 When the image is in the export directory the aforementioned file is
"KRN",9.2,191,1,22,0)
 executed and the image is FTP'd to receiver of the message.  
"KRN",9.2,191,2,0)
^9.22^2^2
"KRN",9.2,191,2,1,0)
BLOB^XMNET-BLOB-HARDWARE^
"KRN",9.2,191,2,2,0)
HARDWARE^XMNET-MULTIMEDIA-HARDWARE^
"KRN",9.2,192,-1)
0^276
"KRN",9.2,192,0)
XMNET-BLOB-HARDWARE^BLOBs (Binary Large Objects) Message^2931206.2014^
"KRN",9.2,192,1,0)
^^18^18^2981230^
"KRN",9.2,192,1,1,0)
 
"KRN",9.2,192,1,2,0)
BLOBs exist in messages as pointers to the IMAGE file (#2005). In order to
"KRN",9.2,192,1,3,0)
attach a BLOB to a message, the BLOB must exist in that file. Each entry
"KRN",9.2,192,1,4,0)
in the IMAGE file than has the data necessary for it to be found and used
"KRN",9.2,192,1,5,0)
by the system. MailMan uses calls to the VistA Imaging package in order to
"KRN",9.2,192,1,6,0)
manipulate these non-textual Body parts. Entries in the IMAGE file are
"KRN",9.2,192,1,7,0)
looked up, displayed and moved to a disk drive where they can be
"KRN",9.2,192,1,8,0)
transmitted using FTP by calls to the VistA Imaging package.
"KRN",9.2,192,1,9,0)
  
"KRN",9.2,192,1,10,0)
Using Multimedia MailMan without a network capability is fairly simple.
"KRN",9.2,192,1,11,0)
The imaging workstation has the ability to direct an image that is stored
"KRN",9.2,192,1,12,0)
on large disk drives on a Local Area Network (LAN) to a high resolution
"KRN",9.2,192,1,13,0)
display monitor. BLOBs can be captured and recorded in the IMAGE file and
"KRN",9.2,192,1,14,0)
then attached to a message easily at any terminal. If one attempts to read
"KRN",9.2,192,1,15,0)
them from a terminal that is not capable of viewing the binary portion,
"KRN",9.2,192,1,16,0)
the user will see a textual summary of what is attached, but no BLOB. At
"KRN",9.2,192,1,17,0)
an imaging workstation, the user will be asked which BLOBs he wishes to
"KRN",9.2,192,1,18,0)
view.
"KRN",9.2,193,-1)
0^292
"KRN",9.2,193,0)
XMNET-MULTIMEDIA-HARDWARE^The relationships of Multimedia hardware^2931206.2023^^
"KRN",9.2,193,1,0)
^^13^13^2931206^^
"KRN",9.2,193,1,1,0)
  
"KRN",9.2,193,1,2,0)
 The platform that network transmission are done from, the imagimg
"KRN",9.2,193,1,3,0)
 workstation and the file server are all connected to the local area
"KRN",9.2,193,1,4,0)
 network.  Each is DDP'd to the same MUMPS database.  At least one
"KRN",9.2,193,1,5,0)
 directory that is known on the network platform (if it is a VAX) as
"KRN",9.2,193,1,6,0)
 NFA0: is mounted via NFS client software onto it from the file server, 
"KRN",9.2,193,1,7,0)
 which is running NFS server software.  This directory appears, then,
"KRN",9.2,193,1,8,0)
 as a logical device. The two subdirectories that MailMan uses during
"KRN",9.2,193,1,9,0)
 network mail transmissions must be created.  The first is called
"KRN",9.2,193,1,10,0)
 NAF0:[export.mail] and is where the Imaging API places files that
"KRN",9.2,193,1,11,0)
 MailMan has indicated via a call that it needs to send to a remote
"KRN",9.2,193,1,12,0)
 system.  The second, called NAF0:[import.mail], is where files are
"KRN",9.2,193,1,13,0)
 received.
"KRN",9.2,194,-1)
0^277
"KRN",9.2,194,0)
XMNET-BLOB-NETWORK^Sending and Receiving BLOBs across a Network^2931105.0923^
"KRN",9.2,194,1,0)
^^11^11^2931105^^
"KRN",9.2,194,1,1,0)
 
"KRN",9.2,194,1,2,0)
 Imagings have been transmitted across a wide area network, they
"KRN",9.2,194,1,3,0)
 take from 7 to 15 minutes usually to be sent this way.  Adding a very
"KRN",9.2,194,1,4,0)
 high speed channel that is capable of transmitting images in less than
"KRN",9.2,194,1,5,0)
 a minute makes the system really impress.  In both cases, it is 
"KRN",9.2,194,1,6,0)
 necessary to make the system as efficient as possible.  Our second pass
"KRN",9.2,194,1,7,0)
 at making this work included an Network File System (NFS) capability.
"KRN",9.2,194,1,8,0)
 This allowed us to perform only one FTP to get an image from site A to
"KRN",9.2,194,1,9,0)
 site B.  The first scenario tested required at least two, one to get 
"KRN",9.2,194,1,10,0)
 the file off of the LAN and a second to put the file onto the remote
"KRN",9.2,194,1,11,0)
 machine.  The use of NFS halved the time it took to deliver images.
"KRN",9.2,195,-1)
0^284
"KRN",9.2,195,0)
XMNET-FTP-REC-NETWORK-LOCATION^FTP Receive Network Location^2931028.1404^
"KRN",9.2,195,1,0)
^^5^5^2931028^
"KRN",9.2,195,1,1,0)
  
"KRN",9.2,195,1,2,0)
 This fields contains the name of the entry in the Network:Location file
"KRN",9.2,195,1,3,0)
 that corresponds to the FTP Receive Directory field so that the entry
"KRN",9.2,195,1,4,0)
 that is created in the image file to represent the BLOB can be found
"KRN",9.2,195,1,5,0)
 and displayed.
"KRN",9.2,196,-1)
0^283
"KRN",9.2,196,0)
XMNET-FTP-COMPONENTS^Basic components in setting up the Multimedia Mail^2931206.202^^
"KRN",9.2,196,1,0)
^^17^17^2931206^^
"KRN",9.2,196,1,1,0)
 
"KRN",9.2,196,1,2,0)
 Summary of needs:
"KRN",9.2,196,1,3,0)
    o  MailMan 7.1 or later version
"KRN",9.2,196,1,4,0)
          
"KRN",9.2,196,1,5,0)
               XMRTCP must running on the node that has TCPIP
"KRN",9.2,196,1,6,0)
               capability and the NFS drive mounted on it.
"KRN",9.2,196,1,7,0)
 
"KRN",9.2,196,1,8,0)
    o  Kernel 7 or later version
"KRN",9.2,196,1,9,0)
 
"KRN",9.2,196,1,10,0)
    o  FileMan 20 or later version
"KRN",9.2,196,1,11,0)
  
"KRN",9.2,196,1,12,0)
    o  Imaging system components:
"KRN",9.2,196,1,13,0)
            
"KRN",9.2,196,1,14,0)
               Abstractor code (also handles part of network mail
"KRN",9.2,196,1,15,0)
                                 interface)
"KRN",9.2,196,1,16,0)
               File Server (currently DHCP uses Novell)
"KRN",9.2,196,1,17,0)
               Imaging Workstation and appropriate $ZCALLS installed
"KRN",9.2,227,-1)
0^97
"KRN",9.2,227,0)
XM-U-I-GROUP COORDINATOR^MAILMAN MAIL GROUP COORDINATORS^2931126.1153^
"KRN",9.2,227,1,0)
^^4^4^2990111^
"KRN",9.2,227,1,1,0)
 
"KRN",9.2,227,1,2,0)
MailMan allows for package coordinators to establish and edit mail groups.
"KRN",9.2,227,1,3,0)
However, this option does not allow coordinators to edit mail groups they
"KRN",9.2,227,1,4,0)
did not create.
"KRN",9.2,229,-1)
0^341
"KRN",9.2,229,0)
XM-U-M-INFO ONLY^MESSAGES MARKED AS INFORMATION ONLY^3020718.1353^
"KRN",9.2,229,1,0)
^9.21^17^17^3020718^^^
"KRN",9.2,229,1,1,0)
 
"KRN",9.2,229,1,2,0)
You can use the Information Only action code (i.e., 'I') to send a message
"KRN",9.2,229,1,3,0)
as Information Only. Sending a message Information Only prevents all
"KRN",9.2,229,1,4,0)
recipients from [REPLYING] to your message. (You, the sender will still
"KRN",9.2,229,1,5,0)
be able to reply to the message.)  Messages can have an Information Only
"KRN",9.2,229,1,6,0)
status placed on them by the sender at anytime. This is a toggle action
"KRN",9.2,229,1,7,0)
code. If you enter 'I' again, the message will no longer be Information Only.
"KRN",9.2,229,1,8,0)
 
"KRN",9.2,229,1,9,0)
To send a message Information Only, enter an 'I' at the 'Select Message
"KRN",9.2,229,1,10,0)
option:  Transmit now//' prompt.
"KRN",9.2,229,1,11,0)
 
"KRN",9.2,229,1,12,0)
In addition to making the entire message Information Only, you can also
"KRN",9.2,229,1,13,0)
send a message as Information Only to just one individual recipient.
"KRN",9.2,229,1,14,0)
During the addressing portion of the message for a recipient, by
"KRN",9.2,229,1,15,0)
specifying the [PREFIX] 'I:xxx' (where 'xxx' represents the recipient's
"KRN",9.2,229,1,16,0)
name) after the 'And Send to:' prompt, you are telling MailMan to deliver
"KRN",9.2,229,1,17,0)
the message to this individual recipient as Information Only.
"KRN",9.2,229,2,0)
^9.22A^2^2
"KRN",9.2,229,2,1,0)
PREFIX^XM-U-A-INFO ONLY
"KRN",9.2,229,2,2,0)
REPLYING^XM-U-M-REPLY
"KRN",9.2,230,-1)
0^148
"KRN",9.2,230,0)
XM-U-M-PRINT DEVICE P-MESSAGE^P-MESSAGE DEVICE^2990213.1036^^
"KRN",9.2,230,1,0)
^^16^16^2990427^
"KRN",9.2,230,1,1,0)
 
"KRN",9.2,230,1,2,0)
Rather than printing information (e.g., a report or listing) to the screen
"KRN",9.2,230,1,3,0)
or a printer, the P-MESSAGE device can be used to send a mail message to
"KRN",9.2,230,1,4,0)
yourself and/or others that contains the information.
"KRN",9.2,230,1,5,0)
 
"KRN",9.2,230,1,6,0)
For example, you may want to keep a copy of a report by sending it to
"KRN",9.2,230,1,7,0)
yourself in a mail message by directing the report to the P-MESSAGE device.
"KRN",9.2,230,1,8,0)
 
"KRN",9.2,230,1,9,0)
MailMan gives you the choice of having the message come from yourself
"KRN",9.2,230,1,10,0)
or the 'Postmaster'. If it's from yourself, it will NOT be delivered 'new'
"KRN",9.2,230,1,11,0)
to you, but you will be able to edit it, if you send it ONLY to yourself.
"KRN",9.2,230,1,12,0)
If you choose to have it come from the Postmaster and send it to yourself,
"KRN",9.2,230,1,13,0)
it will be delivered 'new' to you, but you will NOT be able to edit it.
"KRN",9.2,230,1,14,0)
 
"KRN",9.2,230,1,15,0)
You can set the [P-MESSAGE FROM] default using the User Options Edit
"KRN",9.2,230,1,16,0)
option on the Personal Preferences menu.
"KRN",9.2,230,2,0)
^9.22A^1^1
"KRN",9.2,230,2,1,0)
P-MESSAGE FROM^XM-U-P-P-MESSAGE FROM
"KRN",9.2,232,-1)
0^61
"KRN",9.2,232,0)
XM-U-B-NEW MAIL LIST^LIST OF NEW MESSAGES IN A BASKET^2931222.1539^
"KRN",9.2,232,1,0)
^^8^8^2981222^
"KRN",9.2,232,1,1,0)
 
"KRN",9.2,232,1,2,0)
The New Message List action code (i.e., 'N') will just display the new
"KRN",9.2,232,1,3,0)
messages from a list of messages in a mail basket. This can be useful if
"KRN",9.2,232,1,4,0)
you have a mail basket with a large number of messages and you just want
"KRN",9.2,232,1,5,0)
to see/read the new messages.
"KRN",9.2,232,1,6,0)
 
"KRN",9.2,232,1,7,0)
To list just the new messages in a mail basket, enter an 'N' at the 'Enter
"KRN",9.2,232,1,8,0)
message number or command:' prompt.
"KRN",9.2,233,-1)
0^93
"KRN",9.2,233,0)
XM-U-H-USER^USER INFORMATION^2990119.1337^^
"KRN",9.2,233,1,0)
^^32^32^2990119^^
"KRN",9.2,233,1,1,0)
 
"KRN",9.2,233,1,2,0)
MailMan gives you the opportunity to obtain information on a local MailMan
"KRN",9.2,233,1,3,0)
user through the User Information option on the Help (User/Group Info.,
"KRN",9.2,233,1,4,0)
etc.) menu option located on the main MailMan Menu.
"KRN",9.2,233,1,5,0)
 
"KRN",9.2,233,1,6,0)
You can obtain the following local user information:
"KRN",9.2,233,1,7,0)
 
"KRN",9.2,233,1,8,0)
  * Name - The MailMan user's name.
"KRN",9.2,233,1,9,0)
 
"KRN",9.2,233,1,10,0)
  * Banner - The user's current MailMan banner, if any has been entered using
"KRN",9.2,233,1,11,0)
    the User Options Edit option located on the Personal Preferences menu.
"KRN",9.2,233,1,12,0)
 
"KRN",9.2,233,1,13,0)
  * General MailMan Information - The last date and time the user used
"KRN",9.2,233,1,14,0)
    MailMan and the status of messages in their mailbox.
"KRN",9.2,233,1,15,0)
 
"KRN",9.2,233,1,16,0)
  * Introduction - The user's introduction, if any has been entered using
"KRN",9.2,233,1,17,0)
    the User Options Edit option located on the Personal Preferences menu.
"KRN",9.2,233,1,18,0)
 
"KRN",9.2,233,1,19,0)
  * Office Information - The user's office information, if any has been
"KRN",9.2,233,1,20,0)
    entered using the User Options Edit option located on the Personal
"KRN",9.2,233,1,21,0)
    Preferences menu.
"KRN",9.2,233,1,22,0)
 
"KRN",9.2,233,1,23,0)
  * Mail Group Information - A list of the mail groups to which this user
"KRN",9.2,233,1,24,0)
    belongs, if any.
"KRN",9.2,233,1,25,0)
 
"KRN",9.2,233,1,26,0)
  * Surrogate Information - A list of the MailMan users for whom and in
"KRN",9.2,233,1,27,0)
    what capacity (i.e., privileges) this user may act as a surrogate, if
"KRN",9.2,233,1,28,0)
    any. Also, a list of MailMan users who can be surrogates for this user
"KRN",9.2,233,1,29,0)
    and in what capacity (i.e., privileges).
"KRN",9.2,233,1,30,0)
 
"KRN",9.2,233,1,31,0)
To display general information on a local MailMan user, choose the User
"KRN",9.2,233,1,32,0)
Information option on the Help (User/Group Info., etc.) menu.
"KRN",9.2,312,-1)
0^138
"KRN",9.2,312,0)
XM-U-M-LATER^MAKE MESSAGES NEW LATER^2911003.0855^
"KRN",9.2,312,1,0)
^^18^18^2990427^
"KRN",9.2,312,1,1,0)
 
"KRN",9.2,312,1,2,0)
You can use the Later action code (i.e., 'L') to have messages made 'new'
"KRN",9.2,312,1,3,0)
at a specified later date and time. Use this action to remind yourself of
"KRN",9.2,312,1,4,0)
important activities. Users can schedule a reminder now and not worry
"KRN",9.2,312,1,5,0)
about remembering to do it later. MailMan will act as though it were a
"KRN",9.2,312,1,6,0)
personal reminder.
"KRN",9.2,312,1,7,0)
 
"KRN",9.2,312,1,8,0)
If the message already resides in your mailbox, it will simply be made
"KRN",9.2,312,1,9,0)
'new' again. However, if the message no longer resides in your mailbox, it
"KRN",9.2,312,1,10,0)
will be redelivered to your mailbox as a 'new' message.
"KRN",9.2,312,1,11,0)
 
"KRN",9.2,312,1,12,0)
MailMan gives you the option to review ([LIST]) all messages with
"KRN",9.2,312,1,13,0)
'latered' dates and times using the Report on Later'd Messages option and
"KRN",9.2,312,1,14,0)
make any modifications to those dates and times using the [CHANGE]/Delete
"KRN",9.2,312,1,15,0)
Later'd Messages option. Both of these options are available on the Other
"KRN",9.2,312,1,16,0)
MailMan Functions menu.
"KRN",9.2,312,1,17,0)
 
"KRN",9.2,312,1,18,0)
[MORE]... 
"KRN",9.2,312,2,0)
^9.22A^5^3
"KRN",9.2,312,2,1,0)
LIST^XM-U-M-LATERED MESSAGE REPORT
"KRN",9.2,312,2,2,0)
CHANGE^XM-U-M-LATERED MESSAGE CHANGE
"KRN",9.2,312,2,5,0)
MORE^XM-U-M-LATER-2
"KRN",9.2,312,3,0)
^9.23A^^0
"KRN",9.2,314,-1)
0^337
"KRN",9.2,314,0)
XM-MASTER^VA ELECTRONIC MAIL SYSTEM^3020509.0938^^
"KRN",9.2,314,1,0)
^9.21^19^19^3020509^^^
"KRN",9.2,314,1,1,0)
 
"KRN",9.2,314,1,2,0)
MailMan, The Veterans Administration Electronic Mail System, is a
"KRN",9.2,314,1,3,0)
communications tool which is locally useful due to its teleconferencing
"KRN",9.2,314,1,4,0)
via chained responses. MailMan (along with HL7) is the transport vehicle
"KRN",9.2,314,1,5,0)
for all VA M applications. MailMan is also used to preserve updated copies
"KRN",9.2,314,1,6,0)
of software and data.
"KRN",9.2,314,1,7,0)
 
"KRN",9.2,314,1,8,0)
[MAILMAN SITE PARAMETERS] allow site managers to tailor MailMan to your
"KRN",9.2,314,1,9,0)
site.  [NETWORK] features allow users and packages to send messages to
"KRN",9.2,314,1,10,0)
remote systems. The latest version of MailMan has several [NEW FEATURES]
"KRN",9.2,314,1,11,0)
for site management. [PACKMAN] may be used to load data, software, and
"KRN",9.2,314,1,12,0)
packages into messages. Communications with remote systems may be
"KRN",9.2,314,1,13,0)
performed using [TALKMAN].
"KRN",9.2,314,1,14,0)

"KRN",9.2,314,1,15,0)
[USING] MailMan is no chore. Message actions allow users great flexibility
"KRN",9.2,314,1,16,0)
in managing personal mail. Users can address mail to individuals and groups
"KRN",9.2,314,1,17,0)
at local and remote sites, with the tedium of waiting for process completion
"KRN",9.2,314,1,18,0)
being reduced by the system's background filer. In addition, the system has
"KRN",9.2,314,1,19,0)
extensive online documentation, which may be reproduced in manual form.
"KRN",9.2,314,2,0)
^9.22A^6^6
"KRN",9.2,314,2,1,0)
MAILMAN SITE PARAMETERS^XM-I-S-SITE PARAMETERS
"KRN",9.2,314,2,2,0)
NETWORK^XM-I-N-NETWORK
"KRN",9.2,314,2,3,0)
NEW FEATURES^XM-I-NEW FEATURES
"KRN",9.2,314,2,4,0)
PACKMAN^XM-U-K-PACKMAN
"KRN",9.2,314,2,5,0)
TALKMAN^XM-I-C-TALKMAN
"KRN",9.2,314,2,6,0)
USING^XMHELP
"KRN",9.2,314,10.1)

"KRN",9.2,314,10.2)

"KRN",9.2,320,-1)
0^113
"KRN",9.2,320,0)
XM-U-K-PACKMAN SUMMARIZE^SUMMARIZE PACKMAN MESSAGE^2890609^
"KRN",9.2,320,1,0)
^^4^4^2981230^
"KRN",9.2,320,1,1,0)
 
"KRN",9.2,320,1,2,0)
The PackMan option for Displaying a summary of a PackMan message does just
"KRN",9.2,320,1,3,0)
that. Packages (and their parts), Routines, Globals (anything that can be
"KRN",9.2,320,1,4,0)
loaded) will be listed as in the message when this option is chosen.
"KRN",9.2,321,-1)
0^107
"KRN",9.2,321,0)
XM-U-K-PACKMAN COMPARE^COMPARE PACKMAN MESSAGE ROUTINES AGAINST THOSE INSTALLED NOW^2910716.0631^^
"KRN",9.2,321,1,0)
^^4^4^2981230^
"KRN",9.2,321,1,1,0)
 
"KRN",9.2,321,1,2,0)
The PackMan Compare option will check the data in the PackMan message
"KRN",9.2,321,1,3,0)
against the routines, globals, data dictionaries on disk, and list out all
"KRN",9.2,321,1,4,0)
differences.
"KRN",9.2,322,-1)
0^109
"KRN",9.2,322,0)
XM-U-K-PACKMAN LOAD GLOBALS^LOADING GLOBAL DATA INTO A PACKMAN MESSAGE^2910716.063^^
"KRN",9.2,322,1,0)
^^8^8^2981230^
"KRN",9.2,322,1,1,0)
 
"KRN",9.2,322,1,2,0)
MailMan allows global data to be loaded into a message and saved there or
"KRN",9.2,322,1,3,0)
transported via Network Mail. The data must conform to VistA standards in
"KRN",9.2,322,1,4,0)
order to ensure that this option will work properly. When the global data
"KRN",9.2,322,1,5,0)
is loaded, the address is put onto one line and the data for that address
"KRN",9.2,322,1,6,0)
onto a second line. Global data can be secured, but not scrambled. It can
"KRN",9.2,322,1,7,0)
be reinstalled. Do not expect MailMan to be able to make a backup message
"KRN",9.2,322,1,8,0)
properly when installing global data.
"KRN",9.2,323,-1)
0^108
"KRN",9.2,323,0)
XM-U-K-PACKMAN INSTALL^INSTALLING A PACKMAN MESSAGE^2890609^
"KRN",9.2,323,1,0)
^^10^10^2981230^
"KRN",9.2,323,1,1,0)
 
"KRN",9.2,323,1,2,0)
PackMan messages can be installed by using the Install option under the
"KRN",9.2,323,1,3,0)
PackMan options by entering an 'X' at the 'Enter message option' prompt.
"KRN",9.2,323,1,4,0)
Installing a message will replace the data on disk, but a BACK-UP message
"KRN",9.2,323,1,5,0)
can be created before the installation takes place. Automatic BACK-UP is
"KRN",9.2,323,1,6,0)
prompted for before installation is allowed.
"KRN",9.2,323,1,7,0)
 
"KRN",9.2,323,1,8,0)
If a message is secured, a security check takes place during the
"KRN",9.2,323,1,9,0)
installation. The message is checked against previously calculated sums,
"KRN",9.2,323,1,10,0)
and if the sums do not match, the message cannot be installed.
"KRN",9.2,324,-1)
0^110
"KRN",9.2,324,0)
XM-U-K-PACKMAN LOAD PACKAGE^LOADING AN ENTIRE PACKAGE INTO A PACKMAN MESSAGE^3020502.0706^^
"KRN",9.2,324,1,0)
^9.21^21^21^3020502^^
"KRN",9.2,324,1,1,0)
 
"KRN",9.2,324,1,2,0)
NOTE: KIDS is the preferred method for transporting packages.
"KRN",9.2,324,1,3,0)

"KRN",9.2,324,1,4,0)
You cannot actually load an entire package through MailMan from MailMan.
"KRN",9.2,324,1,5,0)
This is an option given to the creator of a set of INITS for a package
"KRN",9.2,324,1,6,0)
during a DIFROM. This is a somewhat complex option, but the programmer
"KRN",9.2,324,1,7,0)
need only answer that s/he wants the set of information he is compiling
"KRN",9.2,324,1,8,0)
via a DIFROM to be loaded into a message. He or she will then be prompted
"KRN",9.2,324,1,9,0)
for a Subject for the message and asked whether or not to secure the
"KRN",9.2,324,1,10,0)
message. In this way a message can be created, secured, and sent as a part
"KRN",9.2,324,1,11,0)
of a DIFROM and the creator need never invoke a separate MailMan process.
"KRN",9.2,324,1,12,0)
 
"KRN",9.2,324,1,13,0)
Storing a message directly into a message offers the following advantages:
"KRN",9.2,324,1,14,0)
 
"KRN",9.2,324,1,15,0)
  1. The message can be sent over the network faster. It is shorter.
"KRN",9.2,324,1,16,0)
  2. The message can be secured.
"KRN",9.2,324,1,17,0)
  3. The security is checked at installation.
"KRN",9.2,324,1,18,0)
  4. The installation goes directly from the message into the INIT saving
"KRN",9.2,324,1,19,0)
     steps for the installer.
"KRN",9.2,324,1,20,0)
  5. The installer need never be in programming mode since the install
"KRN",9.2,324,1,21,0)
     does not require any direct mode code.
"KRN",9.2,325,-1)
0^112
"KRN",9.2,325,0)
XM-U-K-PACKMAN PRINT^PRINTING PACKMAN MESSAGES^2910716.0639^^
"KRN",9.2,325,1,0)
^^5^5^2981230^^
"KRN",9.2,325,1,1,0)
 
"KRN",9.2,325,1,2,0)
There is a special option for printing PackMan messages. This is available
"KRN",9.2,325,1,3,0)
under the PackMan option (X) at the 'Enter message option' prompt. This
"KRN",9.2,325,1,4,0)
print is particularly useful for routines that are reformatted so that the
"KRN",9.2,325,1,5,0)
tags and lines of code are functionally aligned.
"KRN",9.2,326,-1)
0^111
"KRN",9.2,326,0)
XM-U-K-PACKMAN LOAD ROUTINES^LOADING ROUTINES INTO PACKMAN MESSAGES^2890609^
"KRN",9.2,326,1,0)
^^8^8^2981230^^
"KRN",9.2,326,1,1,0)
 
"KRN",9.2,326,1,2,0)
Routines can be loaded into a PackMan message. If secured, the message
"KRN",9.2,326,1,3,0)
cannot be edited. The installation feature will recognize message
"KRN",9.2,326,1,4,0)
corruption and automatically notify the installer, and perhaps, even abort
"KRN",9.2,326,1,5,0)
the installation process.
"KRN",9.2,326,1,6,0)
 
"KRN",9.2,326,1,7,0)
Once they are in a message, the [PRINT] option in PackMan does a much
"KRN",9.2,326,1,8,0)
better job of formatting the output.
"KRN",9.2,326,2,0)
^9.22A^1^1
"KRN",9.2,326,2,1,0)
PRINT^XM-U-K-PACKMAN PRINT
"KRN",9.2,331,-1)
0^48
"KRN",9.2,331,0)
XM-U-A-INFO ONLY^ADDRESSING A RECIPIENT AS INFORMATION ONLY^2990120.0658^^
"KRN",9.2,331,1,0)
^^8^8^2990120^^
"KRN",9.2,331,1,1,0)
 
"KRN",9.2,331,1,2,0)
Recipients who are addressed as 'Information Only' cannot respond to
"KRN",9.2,331,1,3,0)
the message.
"KRN",9.2,331,1,4,0)

"KRN",9.2,331,1,5,0)
To indicate an 'Information Only' addressee, prefix the
"KRN",9.2,331,1,6,0)
addressee with 'INFO:' or 'I:' (e.g., 'I:SMITH,JOHN', or 'I:G.GROUP').
"KRN",9.2,331,1,7,0)
 
"KRN",9.2,331,1,8,0)
NOTE: The sender of a message can always respond to it.
"KRN",9.2,332,-1)
0^45
"KRN",9.2,332,0)
XM-U-A-CC^ADDRESSING A RECIPIENT AS 'CARBON COPY'^2990120.0701^^
"KRN",9.2,332,1,0)
^^7^7^2990120^^^
"KRN",9.2,332,1,1,0)
 
"KRN",9.2,332,1,2,0)
A recipient who receives a message as a 'CARBON COPY' ('cc:') knows that
"KRN",9.2,332,1,3,0)
a response is not expected. However, there are no limitations on the
"KRN",9.2,332,1,4,0)
recipient.  A [QUERY] of the message shows this recipient as 'cc:USER,NAME'.
"KRN",9.2,332,1,5,0)
 
"KRN",9.2,332,1,6,0)
To address a message to someone in this manner prefix the address with 'CC:'
"KRN",9.2,332,1,7,0)
(e.g., 'CC:SMITH,R').
"KRN",9.2,332,2,0)
^9.22A^1^1
"KRN",9.2,332,2,1,0)
QUERY^XM-U-M-QUERY
"KRN",9.2,333,-1)
0^150
"KRN",9.2,333,0)
XM-U-M-PRINT NO HEADER^HEADERLESS PRINTING^2990120.0948^^
"KRN",9.2,333,1,0)
^^17^17^2990427^
"KRN",9.2,333,1,1,0)
 
"KRN",9.2,333,1,2,0)
The Headerless Print action code (i.e., 'H') allows you to print individual
"KRN",9.2,333,1,3,0)
messages or a group of messages in a mail basket without a header: 
"KRN",9.2,333,1,4,0)
 
"KRN",9.2,333,1,5,0)
  * Printing Individual messages - After reading a message, enter an 'H'
"KRN",9.2,333,1,6,0)
    at the 'Enter message action' prompt.
"KRN",9.2,333,1,7,0)
 
"KRN",9.2,333,1,8,0)
      - MailMan will first ask if you want to print a recipient list. If
"KRN",9.2,333,1,9,0)
        you choose to print recipients, you can print either a summary or
"KRN",9.2,333,1,10,0)
        detailed recipient list.
"KRN",9.2,333,1,11,0)
 
"KRN",9.2,333,1,12,0)
      - MailMan will then ask you what you want to print. The default
"KRN",9.2,333,1,13,0)
        response will always be to print the original message and all
"KRN",9.2,333,1,14,0)
        responses. However, you can choose to print any [COMBINATION] of
"KRN",9.2,333,1,15,0)
        responses (single or range), with or without the original message.
"KRN",9.2,333,1,16,0)
 
"KRN",9.2,333,1,17,0)
[MORE]... 
"KRN",9.2,333,2,0)
^9.22A^5^2
"KRN",9.2,333,2,3,0)
COMBINATION^XM-U-M-CHOOSE RESPONSES
"KRN",9.2,333,2,5,0)
MORE^XM-U-M-PRINT NO HEADER-2
"KRN",9.2,338,-1)
0^126
"KRN",9.2,338,0)
XM-U-M-COPY-2^RESPONSES TO THE COPY OPTION PROMPTS^2990122.1411^^
"KRN",9.2,338,1,0)
^^20^20^2990427^
"KRN",9.2,338,1,1,0)
 
"KRN",9.2,338,1,2,0)
Options for copying a message are as follows:
"KRN",9.2,338,1,3,0)
 
"KRN",9.2,338,1,4,0)
  *  At the 'List original recipients in text?' prompt, entering 'YES'
"KRN",9.2,338,1,5,0)
     inserts the recipient list at the end of the copied text.
"KRN",9.2,338,1,6,0)
     The recipients are those to whom the original message was forwarded
"KRN",9.2,338,1,7,0)
     or sent.
"KRN",9.2,338,1,8,0)
 
"KRN",9.2,338,1,9,0)
  *  At the 'Deliver to the same recipients?' prompt, entering 'YES'
"KRN",9.2,338,1,10,0)
     addresses the message to the same recipients.  Recipients may be
"KRN",9.2,338,1,11,0)
     added or deleted from the message at the 'And Send to' prompt.
"KRN",9.2,338,1,12,0)
 
"KRN",9.2,338,1,13,0)
  *  At the 'Select the responses to copy: 0//' prompt, you can enter the
"KRN",9.2,338,1,14,0)
     original message (default, zero) and/or any [COMBINATION] of
"KRN",9.2,338,1,15,0)
     responses you wish to include. If the message you are copying doesn't
"KRN",9.2,338,1,16,0)
     have any responses, MailMan will automatically copy the original
"KRN",9.2,338,1,17,0)
     message and not prompt you to choose any responses. If you are unsure
"KRN",9.2,338,1,18,0)
     of the responses to include, MailMan lets you enter two question
"KRN",9.2,338,1,19,0)
     marks at the 'Select the responses to copy: 0//' prompt in order to
"KRN",9.2,338,1,20,0)
     display an index of respondents to the message.
"KRN",9.2,338,2,0)
^9.22A^1^1
"KRN",9.2,338,2,1,0)
COMBINATION^XM-U-M-CHOOSE RESPONSES
"KRN",9.2,338,3,0)
^9.23A^^0
"KRN",9.2,347,-1)
0^238
"KRN",9.2,347,0)
XM-U-Q-SEARCH^SEARCHING FOR MESSAGES^3000830.065^^
"KRN",9.2,347,1,0)
^9.21^12^12^3000830^^^^
"KRN",9.2,347,1,1,0)
 
"KRN",9.2,347,1,2,0)
The MailMan interface provides the Query/Search for Messages option for you
"KRN",9.2,347,1,3,0)
to search for messages. This option is located on the main MailMan Menu.
"KRN",9.2,347,1,4,0)
 
"KRN",9.2,347,1,5,0)
You can search for any messages you sent or that were sent to you. MailMan
"KRN",9.2,347,1,6,0)
allows you to choose in what location you want to search for mail:
"KRN",9.2,347,1,7,0)
 
"KRN",9.2,347,1,8,0)
  * Search for messages anywhere on the [SYSTEM].
"KRN",9.2,347,1,9,0)
 
"KRN",9.2,347,1,10,0)
  * Search for messages anywhere in your [MAILBOX].
"KRN",9.2,347,1,11,0)
 
"KRN",9.2,347,1,12,0)
When searching for messages, you can specify a variety of search [CRITERIA].
"KRN",9.2,347,2,0)
^9.22A^3^3
"KRN",9.2,347,2,1,0)
MAILBOX^XM-U-Q-SEARCH MAILBOX
"KRN",9.2,347,2,2,0)
CRITERIA^XM-U-Q-SEARCH CRITERIA
"KRN",9.2,347,2,3,0)
SYSTEM^XM-U-Q-SEARCH SYSTEM
"KRN",9.2,349,-1)
0^53
"KRN",9.2,349,0)
XM-U-B-BASKET CONTENTS LIST^DIRECTORY OF BASKETS^2890609^
"KRN",9.2,349,1,0)
^^25^25^2981229^
"KRN",9.2,349,1,1,0)
 
"KRN",9.2,349,1,2,0)
MailMan allows you to list your messages in one or all of your mail
"KRN",9.2,349,1,3,0)
baskets in your mailbox through the Mailbox Contents List option on the
"KRN",9.2,349,1,4,0)
Other MailMan Functions menu.
"KRN",9.2,349,1,5,0)
 
"KRN",9.2,349,1,6,0)
The report provides the following information:
"KRN",9.2,349,1,7,0)
 
"KRN",9.2,349,1,8,0)
  * Basket - The mail basket name.
"KRN",9.2,349,1,9,0)
 
"KRN",9.2,349,1,10,0)
  * Message Information - A summary list of information is provided for
"KRN",9.2,349,1,11,0)
    each message found in the basket. This information includes:
"KRN",9.2,349,1,12,0)
 
"KRN",9.2,349,1,13,0)
      - Message number in that basket.
"KRN",9.2,349,1,14,0)
      - MailMan internal message identification number (in brackets).
"KRN",9.2,349,1,15,0)
      - Date the message was sent.
"KRN",9.2,349,1,16,0)
      - Subject of the message.
"KRN",9.2,349,1,17,0)
 
"KRN",9.2,349,1,18,0)
To list all of the messages in one mail basket, choose the Mailbox
"KRN",9.2,349,1,19,0)
Contents List option on the Other MailMan Functions menu and enter 'O'
"KRN",9.2,349,1,20,0)
(one) after the 'List contents of: All Baskets//' prompt.
"KRN",9.2,349,1,21,0)
 
"KRN",9.2,349,1,22,0)
To list all of the messages in your mailbox, choose the Mailbox
"KRN",9.2,349,1,23,0)
Contents List option on the Other MailMan Functions menu and enter 'A'
"KRN",9.2,349,1,24,0)
(all) after the 'List contents of: All Baskets//' prompt or accept the
"KRN",9.2,349,1,25,0)
default by pressing the Return/Enter key.
"KRN",9.2,350,-1)
0^72
"KRN",9.2,350,0)
XM-U-B-RESEQUENCE MESSAGES^RESEQUENCING MESSAGE NUMBERS^2911003.0856^
"KRN",9.2,350,1,0)
^^9^9^2990108^
"KRN",9.2,350,1,1,0)
 
"KRN",9.2,350,1,2,0)
The Resequence action code (i.e., 'R') allows you to renumber the message
"KRN",9.2,350,1,3,0)
numbers in a list of messages in a mail basket. All messages will be
"KRN",9.2,350,1,4,0)
resequenced in the order of their MailMan internal message identification
"KRN",9.2,350,1,5,0)
numbers. This helps keep your mail basket messages more orderly by
"KRN",9.2,350,1,6,0)
removing any 'gaps' in message number sequence.
"KRN",9.2,350,1,7,0)
 
"KRN",9.2,350,1,8,0)
To resequence the message numbers for a group of messages in a mail
"KRN",9.2,350,1,9,0)
basket, enter an 'R' at the 'Enter message number or command:' prompt.
"KRN",9.2,351,-1)
0^205
"KRN",9.2,351,0)
XM-U-P-FORWARDING ADDRESS^HOW TO USE THE FORWARDING ADDRESS FEATURE^3010420.0757^
"KRN",9.2,351,1,0)
^9.21^55^55^3010420^^
"KRN",9.2,351,1,1,0)
 
"KRN",9.2,351,1,2,0)
MailMan gives you the opportunity to have your mail automatically
"KRN",9.2,351,1,3,0)
forwarded to a remote e-mail address. MailMan also gives you the option to
"KRN",9.2,351,1,4,0)
continue to receive e-mail at your local address as well.
"KRN",9.2,351,1,5,0)
 
"KRN",9.2,351,1,6,0)
The MailMan interface provides the Forwarding Address Edit option located
"KRN",9.2,351,1,7,0)
on the Personal Preferences menu to allow you to have your mail
"KRN",9.2,351,1,8,0)
automatically forwarded.
"KRN",9.2,351,1,9,0)
 
"KRN",9.2,351,1,10,0)
NOTE: This option may or may not be available to you. It depends on
"KRN",9.2,351,1,11,0)
      whether or not your site restricts access to this option to users
"KRN",9.2,351,1,12,0)
      holding the XMNET security key. For example, if your site requires
"KRN",9.2,351,1,13,0)
      users to hold the XMNET security key and you don't hold that key,
"KRN",9.2,351,1,14,0)
      you won't be able to use this option.
"KRN",9.2,351,1,15,0)
 
"KRN",9.2,351,1,16,0)
The Forwarding Address Edit option asks you to enter the following
"KRN",9.2,351,1,17,0)
information:
"KRN",9.2,351,1,18,0)
 
"KRN",9.2,351,1,19,0)
  * Forwarding Address - To what remote address should the mail be routed?
"KRN",9.2,351,1,20,0)
 
"KRN",9.2,351,1,21,0)
  * Local Delivery Flag - Should the mail be sent both remotely and
"KRN",9.2,351,1,22,0)
    locally or just remotely?
"KRN",9.2,351,1,23,0)
 
"KRN",9.2,351,1,24,0)
The FORWARDING ADDRESS field contains the name of the remote address to
"KRN",9.2,351,1,25,0)
which any MailMan messages addressed to you are routed. Only the original
"KRN",9.2,351,1,26,0)
message gets forwarded, replies to messages are not forwarded.
"KRN",9.2,351,1,27,0)
Messages sent by you to yourself are not forwarded.
"KRN",9.2,351,1,28,0)
 
"KRN",9.2,351,1,29,0)
NOTE: Broadcast messages will be forwarded like any other messages sent to
"KRN",9.2,351,1,30,0)
      your mailbox. However, since the Secretary's daily broadcast message
"KRN",9.2,351,1,31,0)
      on FORUM is sent to all sites, it will NOT be forwarded from FORUM.
"KRN",9.2,351,1,32,0)
 
"KRN",9.2,351,1,33,0)
The remote address must contain the remote name, an at-sign ('@' Shift-2
"KRN",9.2,351,1,34,0)
key on most keyboards), and the remote domain name (i.e., name@domain).
"KRN",9.2,351,1,35,0)
The entry can be up to 50 characters in length.
"KRN",9.2,351,1,36,0)
 
"KRN",9.2,351,1,37,0)
The value in the LOCAL DELIVERY FLAG field works in conjunction with the
"KRN",9.2,351,1,38,0)
FORWARDING ADDRESS field. If the FORWARDING ADDRESS field contains a
"KRN",9.2,351,1,39,0)
remote e-mail address, you should also set the LOCAL DELIVERY FLAG field.
"KRN",9.2,351,1,40,0)
 
"KRN",9.2,351,1,41,0)
MailMan gives you two possible entries for this field:
"KRN",9.2,351,1,42,0)
 
"KRN",9.2,351,1,43,0)
  * No Local Delivery (default) - If you have a FORWARDING ADDRESS and you
"KRN",9.2,351,1,44,0)
    do not want your messages delivered locally, set the LOCAL DELIVERY
"KRN",9.2,351,1,45,0)
    FLAG field to 'Off' (i.e., '0'). Your messages will only be delivered
"KRN",9.2,351,1,46,0)
    to your remote addresses.
"KRN",9.2,351,1,47,0)
 
"KRN",9.2,351,1,48,0)
  * Local Delivery On - If you have a FORWARDING ADDRESS and you want your
"KRN",9.2,351,1,49,0)
    messages delivered locally as well as remotely, set the LOCAL DELIVERY
"KRN",9.2,351,1,50,0)
    FLAG field to 'On' (i.e., '1'). Your messages will be delivered to
"KRN",9.2,351,1,51,0)
    both your local and remote addresses.
"KRN",9.2,351,1,52,0)
 
"KRN",9.2,351,1,53,0)
Also, if you've set the LOCAL DELIVERY FLAG field to continue to receive
"KRN",9.2,351,1,54,0)
mail locally, you may want to choose another MailMan user to act as your
"KRN",9.2,351,1,55,0)
[SURROGATE] so that they can read your local mail.
"KRN",9.2,351,2,0)
^9.22A^1^1
"KRN",9.2,351,2,1,0)
SURROGATE^XM-U-I-SURROGATE
"KRN",9.2,352,-1)
0^254
"KRN",9.2,352,0)
XM-U-R-READ^READING AND MANAGING YOUR MAIL^2890609^^
"KRN",9.2,352,1,0)
^^20^20^2990107^^
"KRN",9.2,352,1,1,0)
 
"KRN",9.2,352,1,2,0)
The MailMan interface provides two options to read and manage your mail:
"KRN",9.2,352,1,3,0)
 
"KRN",9.2,352,1,4,0)
  * [NEW] Messages and Responses (NML)
"KRN",9.2,352,1,5,0)
 
"KRN",9.2,352,1,6,0)
  * Read/Manage Messages (RML)
"KRN",9.2,352,1,7,0)
 
"KRN",9.2,352,1,8,0)
These options are located on the main MailMan Menu.
"KRN",9.2,352,1,9,0)
 
"KRN",9.2,352,1,10,0)
The Read/Manage Messages option lets you better manage your e-mail. It
"KRN",9.2,352,1,11,0)
allows you to perform numerous actions on both new and existing messages
"KRN",9.2,352,1,12,0)
stored on the system (e.g., in a particular mail basket, mailbox, etc.).
"KRN",9.2,352,1,13,0)
 
"KRN",9.2,352,1,14,0)
The Read/Manage Messages option can be used to read and reply to messages.
"KRN",9.2,352,1,15,0)
It can also be used to delete, print, forward, save, copy, query, filter,
"KRN",9.2,352,1,16,0)
later, or terminate messages. You can also select messages for subsequent
"KRN",9.2,352,1,17,0)
group actions. As long as a message is still on the system and you were a
"KRN",9.2,352,1,18,0)
recipient or sender of the message, it is available to you for processing.
"KRN",9.2,352,1,19,0)
 
"KRN",9.2,352,1,20,0)
[MORE]...
"KRN",9.2,352,2,0)
^9.22A^12^2
"KRN",9.2,352,2,9,0)
NEW^XM-U-R-READ NEW
"KRN",9.2,352,2,12,0)
MORE^XM-U-R-READ-2
"KRN",9.2,353,-1)
0^256
"KRN",9.2,353,0)
XM-U-R-READ NEW^PROCESSING NEW MAIL^3000726.0755^^
"KRN",9.2,353,1,0)
^9.21^21^21^3000726^^^
"KRN",9.2,353,1,1,0)
 
"KRN",9.2,353,1,2,0)
The New Messages and Responses (NML) option is the option you use when you
"KRN",9.2,353,1,3,0)
specifically wish to process new mail in your mailbox (i.e., messages and
"KRN",9.2,353,1,4,0)
responses not previously read). MailMan notifies you when you have new
"KRN",9.2,353,1,5,0)
mail and precedes each new (unread) message in a list of messages with an
"KRN",9.2,353,1,6,0)
asterisk.
"KRN",9.2,353,1,7,0)
 
"KRN",9.2,353,1,8,0)
This option provides you with the following choices of how you choose to
"KRN",9.2,353,1,9,0)
read your new mail:
"KRN",9.2,353,1,10,0)
 
"KRN",9.2,353,1,11,0)
  * [READ] new mail by basket (default).
"KRN",9.2,353,1,12,0)
  * [LIST BASKETS] with new mail.
"KRN",9.2,353,1,13,0)
  * List [ALL] new messages.
"KRN",9.2,353,1,14,0)
  * List all [PRIORITY] messages.
"KRN",9.2,353,1,15,0)
  * [PRINT] all new messages.
"KRN",9.2,353,1,16,0)
  * [SCAN] all new messages.
"KRN",9.2,353,1,17,0)
  * Quit - Use the Quit option to 'quit' processing your new mail.   
"KRN",9.2,353,1,18,0)

"KRN",9.2,353,1,19,0)
You can set the default [CHOICE].
"KRN",9.2,353,1,20,0)
 
"KRN",9.2,353,1,21,0)
[MORE]... 
"KRN",9.2,353,2,0)
^9.22A^16^8
"KRN",9.2,353,2,6,0)
READ^XM-U-R-NEW READ
"KRN",9.2,353,2,9,0)
LIST BASKETS^XM-U-R-NEW LIST BASKETS
"KRN",9.2,353,2,10,0)
ALL^XM-U-R-NEW LIST ALL
"KRN",9.2,353,2,11,0)
PRIORITY^XM-U-R-NEW LIST PRIORITY
"KRN",9.2,353,2,12,0)
PRINT^XM-U-R-NEW PRINT
"KRN",9.2,353,2,13,0)
SCAN^XM-U-R-NEW SCAN
"KRN",9.2,353,2,15,0)
MORE^XM-U-R-READ NEW-2
"KRN",9.2,353,2,16,0)
CHOICE^XM-U-P-NEW MESSAGES OPTION
"KRN",9.2,355,-1)
0^127
"KRN",9.2,355,0)
XM-U-M-DELETE^DELETING MESSAGES^3000830.07^^
"KRN",9.2,355,1,0)
^9.21^19^19^3000830^^
"KRN",9.2,355,1,1,0)
 
"KRN",9.2,355,1,2,0)
The Delete action code (i.e., 'D') allows you to delete individual
"KRN",9.2,355,1,3,0)
messages or a group of messages in a mail basket by moving them to the
"KRN",9.2,355,1,4,0)
'WASTE' basket.
"KRN",9.2,355,1,5,0)
 
"KRN",9.2,355,1,6,0)
Generally, a batch job is run nightly (determined by IRM at your site) to
"KRN",9.2,355,1,7,0)
remove messages from your 'WASTE' basket, and thus, from your mailbox. You
"KRN",9.2,355,1,8,0)
can immediately remove messages from your mailbox by, again, deleting the
"KRN",9.2,355,1,9,0)
messages from your 'WASTE' basket. However, the messages remain on the
"KRN",9.2,355,1,10,0)
system until all recipients of the messages have deleted them from their
"KRN",9.2,355,1,11,0)
mailbox. If mail is deleted from the 'WASTE' basket, it is not permanently
"KRN",9.2,355,1,12,0)
gone. It can still be retrieved by a system [SEARCH] until MailMan purges
"KRN",9.2,355,1,13,0)
the message from the system.
"KRN",9.2,355,1,14,0)
 
"KRN",9.2,355,1,15,0)
If you delete a message, and someone else then replies to it, the message
"KRN",9.2,355,1,16,0)
will be redelivered to you so that it can be read again.  Contrast this to
"KRN",9.2,355,1,17,0)
the [TERMINATE] action code, which prevents the message from being redelivered.
"KRN",9.2,355,1,18,0)
 
"KRN",9.2,355,1,19,0)
[MORE]... 
"KRN",9.2,355,2,0)
^9.22A^6^3
"KRN",9.2,355,2,2,0)
TERMINATE^XM-U-M-TERMINATE
"KRN",9.2,355,2,3,0)
SEARCH^XM-U-Q-SEARCH SYSTEM
"KRN",9.2,355,2,6,0)
MORE^XM-U-M-DELETE-2
"KRN",9.2,356,-1)
0^156
"KRN",9.2,356,0)
XM-U-M-QUERY^QUERYING A MESSAGE FOR ITS STATUS^3010305.1552^^
"KRN",9.2,356,1,0)
^9.21^21^21^3010305^^^^
"KRN",9.2,356,1,1,0)
 
"KRN",9.2,356,1,2,0)
At the 'Enter message action' prompt, the user may enter a 'Q' to inquire
"KRN",9.2,356,1,3,0)
about the status of the message. The 'Query' option shows you who has read
"KRN",9.2,356,1,4,0)
the message, when the message was read, how many responses were read, and
"KRN",9.2,356,1,5,0)
other pertinent facts.
"KRN",9.2,356,1,6,0)
 
"KRN",9.2,356,1,7,0)
The query option has several forms:
"KRN",9.2,356,1,8,0)
 
"KRN",9.2,356,1,9,0)
  * 'Q' is the [GENERAL] query that tells you how the message was addressed.
"KRN",9.2,356,1,10,0)
 
"KRN",9.2,356,1,11,0)
  * 'Q xxx' is used to inquire about a [SPECIFIC] individual by entering
"KRN",9.2,356,1,12,0)
    'Q' and the individual's name (i.e., xxx = a person's name). For
"KRN",9.2,356,1,13,0)
    example, 'Q SMITH' will show the status of all 'SMITH' recipients.
"KRN",9.2,356,1,14,0)
 
"KRN",9.2,356,1,15,0)
  * 'QD' (Query [DETAILED]) displays detailed information for each
"KRN",9.2,356,1,16,0)
    individual recipient.
"KRN",9.2,356,1,17,0)
 
"KRN",9.2,356,1,18,0)
  * 'QN' (Query [NETWORK]) displays a message's network header
"KRN",9.2,356,1,19,0)
    (if it originated from a remote location).
"KRN",9.2,356,1,20,0)
 
"KRN",9.2,356,1,21,0)
[MORE]... 
"KRN",9.2,356,2,0)
^9.22A^6^5
"KRN",9.2,356,2,2,0)
GENERAL^XM-U-M-QUERY GENERAL
"KRN",9.2,356,2,3,0)
DETAILED^XM-U-M-QUERY DETAILED
"KRN",9.2,356,2,4,0)
NETWORK^XM-U-M-QUERY NETWORK
"KRN",9.2,356,2,5,0)
SPECIFIC^XM-U-M-QUERY SPECIFIC
"KRN",9.2,356,2,6,0)
MORE^XM-U-M-QUERY-2
"KRN",9.2,358,-1)
0^134
"KRN",9.2,358,0)
XM-U-M-FORWARD^FORWARDING MESSAGES^2990114.1333^^
"KRN",9.2,358,1,0)
^^14^14^2990427^
"KRN",9.2,358,1,1,0)
 
"KRN",9.2,358,1,2,0)
You can use the Forward action code (i.e., 'F') to forward messages to
"KRN",9.2,358,1,3,0)
different recipients. As forwarding sends the message to other users, you
"KRN",9.2,358,1,4,0)
will be prompted to [ADDRESS] the message to individuals or [MAIL GROUPS].
"KRN",9.2,358,1,5,0)
 
"KRN",9.2,358,1,6,0)
The person who forwarded the message and the time the message was
"KRN",9.2,358,1,7,0)
forwarded are displayed when you do a [QUERY] (QD) on the message.
"KRN",9.2,358,1,8,0)
If a message is defined to be [CLOSED], you cannot forward the message,
"KRN",9.2,358,1,9,0)
unless you sent it.
"KRN",9.2,358,1,10,0)
 
"KRN",9.2,358,1,11,0)
Forwarding cancels any previous [TERMINATION] of a message. This is true
"KRN",9.2,358,1,12,0)
when you forward a message to yourself or to other recipients.
"KRN",9.2,358,1,13,0)
 
"KRN",9.2,358,1,14,0)
[MORE]... 
"KRN",9.2,358,2,0)
^9.22A^8^6
"KRN",9.2,358,2,1,0)
QUERY^XM-U-M-QUERY DETAILED
"KRN",9.2,358,2,2,0)
CLOSED^XM-U-M-CLOSED
"KRN",9.2,358,2,3,0)
TERMINATION^XM-U-M-TERMINATE
"KRN",9.2,358,2,4,0)
MAIL GROUPS^XM-U-I-GROUP
"KRN",9.2,358,2,5,0)
ADDRESS^XM-U-A-ADDRESS
"KRN",9.2,358,2,8,0)
MORE^XM-U-M-FORWARD-2
"KRN",9.2,359,-1)
0^115
"KRN",9.2,359,0)
XM-U-M-BACKUP^BACKING UP THE MESSAGE DISPLAY^2911003.0842^
"KRN",9.2,359,1,0)
^^18^18^2990427^
"KRN",9.2,359,1,1,0)
 
"KRN",9.2,359,1,2,0)
After a message has been read, replied to, and the reply has been read,
"KRN",9.2,359,1,3,0)
MailMan will no longer display the message text automatically when you
"KRN",9.2,359,1,4,0)
attempt to read the message. This is to avoid forcing you to read through
"KRN",9.2,359,1,5,0)
text you've already seen. However, the text is still there. You can use
"KRN",9.2,359,1,6,0)
the Backup action code (i.e., 'B') to back up to any part of a message and
"KRN",9.2,359,1,7,0)
read the message from that point on:
"KRN",9.2,359,1,8,0)
 
"KRN",9.2,359,1,9,0)
  * Original message
"KRN",9.2,359,1,10,0)
 
"KRN",9.2,359,1,11,0)
  * Any specific response (if any)
"KRN",9.2,359,1,12,0)
 
"KRN",9.2,359,1,13,0)
The Backup function is also useful when viewing a new response to an old
"KRN",9.2,359,1,14,0)
message and you can't recall the previous responses. Backing up allows you
"KRN",9.2,359,1,15,0)
to review the previous responses.
"KRN",9.2,359,1,16,0)
 
"KRN",9.2,359,1,17,0)
To back up to the original message or any specific response, enter a 'B'
"KRN",9.2,359,1,18,0)
at the 'Enter message action' prompt.
"KRN",9.2,359,2,0)
^9.22A^0^0
"KRN",9.2,360,-1)
0^169
"KRN",9.2,360,0)
XM-U-M-SAVE^SAVING MESSAGES^2990114.1101^^
"KRN",9.2,360,1,0)
^^21^21^2990427^
"KRN",9.2,360,1,1,0)
 
"KRN",9.2,360,1,2,0)
The Save action code (i.e., 'S') allows you to save (move) individual
"KRN",9.2,360,1,3,0)
messages or a group of messages in a mail basket to a different existing
"KRN",9.2,360,1,4,0)
mail basket in your mailbox or to a new mail basket you create on the fly.
"KRN",9.2,360,1,5,0)
 
"KRN",9.2,360,1,6,0)
To save messages, do the following:
"KRN",9.2,360,1,7,0)
 
"KRN",9.2,360,1,8,0)
  * Individually - After reading a message, enter an 'S' at the 'Enter
"KRN",9.2,360,1,9,0)
    message action' prompt. MailMan will save the message after prompting
"KRN",9.2,360,1,10,0)
    you for a basket to save it to.
"KRN",9.2,360,1,11,0)
 
"KRN",9.2,360,1,12,0)
  * Group of Messages - Enter an 'S' at the basket option or command
"KRN",9.2,360,1,13,0)
    prompt.
"KRN",9.2,360,1,14,0)
 
"KRN",9.2,360,1,15,0)
      - MailMan will first ask you to select which messages you want to
"KRN",9.2,360,1,16,0)
        save, including a [RANGE] of messages. Also, if you are using a
"KRN",9.2,360,1,17,0)
        full-screen reader, you can pre-[SELECT] messages and then save
"KRN",9.2,360,1,18,0)
        them as a group.
"KRN",9.2,360,1,19,0)
 
"KRN",9.2,360,1,20,0)
      - MailMan will then save the messages after prompting you for a
"KRN",9.2,360,1,21,0)
        basket to save them to.
"KRN",9.2,360,2,0)
^9.22^3^2
"KRN",9.2,360,2,1,0)
RANGE^XM-U-M-CHOOSE RANGE
"KRN",9.2,360,2,3,0)
SELECT^XM-U-M-CHOOSE SELECT
"KRN",9.2,361,-1)
0^174
"KRN",9.2,361,0)
XM-U-M-TERMINATE^TERMINATING MESSAGES^2931113.2343^
"KRN",9.2,361,1,0)
^^15^15^2990427^
"KRN",9.2,361,1,1,0)
 
"KRN",9.2,361,1,2,0)
The Terminate action code (i.e., 'T') allows you to permanently delete
"KRN",9.2,361,1,3,0)
individual messages or a group of messages in a mail basket by moving them
"KRN",9.2,361,1,4,0)
to the 'WASTE' basket.
"KRN",9.2,361,1,5,0)
 
"KRN",9.2,361,1,6,0)
Unlike [DELETING] messages, terminating messages also stops any subsequent
"KRN",9.2,361,1,7,0)
replies to those messages from being delivered to you.
"KRN",9.2,361,1,8,0)
 
"KRN",9.2,361,1,9,0)
If you accidentally terminate a message and want to receive responses,
"KRN",9.2,361,1,10,0)
you may recover the message from your 'WASTE' basket, and [FORWARD] the
"KRN",9.2,361,1,11,0)
message to yourself. This will cancel the effect of your previous
"KRN",9.2,361,1,12,0)
termination. If the message is no longer in your 'WASTE' basket, you could
"KRN",9.2,361,1,13,0)
ask another recipient of the message to forward it to you.
"KRN",9.2,361,1,14,0)
 
"KRN",9.2,361,1,15,0)
[MORE]... 
"KRN",9.2,361,2,0)
^9.22A^5^3
"KRN",9.2,361,2,1,0)
FORWARD^XM-U-M-FORWARD
"KRN",9.2,361,2,2,0)
DELETING^XM-U-M-DELETE
"KRN",9.2,361,2,5,0)
MORE^XM-U-M-TERMINATE-2
"KRN",9.2,362,-1)
0^166
"KRN",9.2,362,0)
XM-U-M-REPLY^REPLYING TO A MESSAGE^3000515.0857^^
"KRN",9.2,362,1,0)
^9.21^19^19^3000515^^
"KRN",9.2,362,1,1,0)
 
"KRN",9.2,362,1,2,0)
Entering an 'R' or 'RI' at the 'Enter message action' prompt enables
"KRN",9.2,362,1,3,0)
you to reply to the message.
"KRN",9.2,362,1,4,0)
 
"KRN",9.2,362,1,5,0)
  * If you enter 'R', you will simply reply to the message.
"KRN",9.2,362,1,6,0)
 
"KRN",9.2,362,1,7,0)
  * If you enter 'RI', you will be able to include the original message
"KRN",9.2,362,1,8,0)
    and/or any [COMBINATION] of responses in your reply. (With this feature,
"KRN",9.2,362,1,9,0)
    you can more easily respond to what someone wrote, point by point.)
"KRN",9.2,362,1,10,0)
    You will also be able to include responses from another message.
"KRN",9.2,362,1,11,0)
 
"KRN",9.2,362,1,12,0)
You are then prompted to enter the text of the new reply.
"KRN",9.2,362,1,13,0)
 
"KRN",9.2,362,1,14,0)
'Reply' immediately attaches your reply to the response chain so everyone
"KRN",9.2,362,1,15,0)
on the message sees your reply, making it instantly available to anyone
"KRN",9.2,362,1,16,0)
currently reading the message. This helps facilitate 'real-time'
"KRN",9.2,362,1,17,0)
conversations among message recipients.
"KRN",9.2,362,1,18,0)
 
"KRN",9.2,362,1,19,0)
[MORE]...
"KRN",9.2,362,2,0)
^9.22A^3^2
"KRN",9.2,362,2,2,0)
COMBINATION^XM-U-M-CHOOSE RESPONSES
"KRN",9.2,362,2,3,0)
MORE^XM-U-M-REPLY-2
"KRN",9.2,363,-1)
0^263
"KRN",9.2,363,0)
XMHELP^USING MAILMAN^2990201.1346^^
"KRN",9.2,363,1,0)
^^21^21^2990513^
"KRN",9.2,363,1,1,0)
 
"KRN",9.2,363,1,2,0)
MailMan is a general purpose electronic messaging (e-mail) system. Messages
"KRN",9.2,363,1,3,0)
can be exchanged over communication lines, modems, and other networks. A
"KRN",9.2,363,1,4,0)
message is created with the [SEND] option. The message then appears in
"KRN",9.2,363,1,5,0)
each recipient's mailbox, to be [READ] after signon. Messages are tracked
"KRN",9.2,363,1,6,0)
electronically, so that each message's author and readers are identified.
"KRN",9.2,363,1,7,0)
 
"KRN",9.2,363,1,8,0)
After reading a message, a recipient can select from a variety of message
"KRN",9.2,363,1,9,0)
[ACTIONS], such as saving it into other mail baskets, deleting it, forwarding
"KRN",9.2,363,1,10,0)
it to others, or replying to it.  Replies generate new messages seen by all
"KRN",9.2,363,1,11,0)
recipients, creating an ongoing dialog among the recipients. 
"KRN",9.2,363,1,12,0)
 
"KRN",9.2,363,1,13,0)
Users can [FILTER] their mail and [SEARCH] for specific messages. Also, users
"KRN",9.2,363,1,14,0)
can designate [SURROGATES] to manage mail for them. Users can 'introduce'
"KRN",9.2,363,1,15,0)
themselves, provide contact information, and create a banner to be
"KRN",9.2,363,1,16,0)
displayed when a message is sent to them. Users can also choose a message
"KRN",9.2,363,1,17,0)
[READER] and further [CUSTOMIZE] the MailMan interface to suit their
"KRN",9.2,363,1,18,0)
needs. [GROUPS] of users may also be created.
"KRN",9.2,363,1,19,0)
 
"KRN",9.2,363,1,20,0)
There are some [NEW FEATURES] for MailMan users.  Some commonly asked
"KRN",9.2,363,1,21,0)
[QUESTIONS] and answers on MailMan may be useful in solving typical problems. 
"KRN",9.2,363,2,0)
^9.22A^22^11
"KRN",9.2,363,2,1,0)
SEND^XM-U-M-SEND^
"KRN",9.2,363,2,2,0)
READ^XM-U-R-READ^
"KRN",9.2,363,2,12,0)
GROUPS^XM-U-I-GROUP^
"KRN",9.2,363,2,13,0)
SEARCH^XM-U-Q-SEARCH
"KRN",9.2,363,2,14,0)
SURROGATES^XM-U-I-SURROGATE
"KRN",9.2,363,2,16,0)
FILTER^XM-U-P-FILTER
"KRN",9.2,363,2,17,0)
ACTIONS^XM-U-MO-READ
"KRN",9.2,363,2,18,0)
CUSTOMIZE^XM-U-P-PERSONAL PREFERENCES
"KRN",9.2,363,2,20,0)
READER^XM-U-B-READER
"KRN",9.2,363,2,21,0)
NEW FEATURES^XM-U-NEW FEATURES
"KRN",9.2,363,2,22,0)
QUESTIONS^XM-U-H-QUESTIONS
"KRN",9.2,364,-1)
0^173
"KRN",9.2,364,0)
XM-U-M-SEND^USING THE 'Send a message' OPTION^3020506.1136^^
"KRN",9.2,364,1,0)
^9.21^21^21^3020506^^^^
"KRN",9.2,364,1,1,0)
 
"KRN",9.2,364,1,2,0)
The 'Send a message' option is used to create and distribute messages.
"KRN",9.2,364,1,3,0)
MailMan allows you to send new mail in four easy steps:
"KRN",9.2,364,1,4,0)
 
"KRN",9.2,364,1,5,0)
  1. Enter the subject of the message. It must be no more than 65 characters.
"KRN",9.2,364,1,6,0)
     You can later go back and edit the [SUBJECT] before sending the message.
"KRN",9.2,364,1,7,0)
 
"KRN",9.2,364,1,8,0)
  2. Enter the text of your message. MailMan automatically places you in your
"KRN",9.2,364,1,9,0)
     [PREFERRED EDITOR]. When you have completed your text entry, exit the
"KRN",9.2,364,1,10,0)
     editor. You can later go back and edit the [TEXT] before sending the
"KRN",9.2,364,1,11,0)
     message.
"KRN",9.2,364,1,12,0)
 
"KRN",9.2,364,1,13,0)
  3. Address the message (e.g., send it to individual [RECIPIENTS] or a
"KRN",9.2,364,1,14,0)
     [MAIL GROUP]). You can later go back and edit the [ADDRESSEES] before
"KRN",9.2,364,1,15,0)
     sending the message.
"KRN",9.2,364,1,16,0)
 
"KRN",9.2,364,1,17,0)
  4. [SEND] the message. Before sending the message, you can edit it or add
"KRN",9.2,364,1,18,0)
     attributes to it at the 'Select Message option:  Transmit now//' prompt
"KRN",9.2,364,1,19,0)
     (e.g., make the message: priority, closed, confidential, information only,
"KRN",9.2,364,1,20,0)
     etc.).  You can send it now or later.  (If you send it only to yourself,
"KRN",9.2,364,1,21,0)
     you can [EDIT] it further before forwarding it on to others.)
"KRN",9.2,364,2,0)
^9.22A^11^8
"KRN",9.2,364,2,3,0)
RECIPIENTS^XM-U-A-ADDRESS^
"KRN",9.2,364,2,4,0)
TEXT^XM-U-M-EDIT TEXT^
"KRN",9.2,364,2,6,0)
SEND^XM-U-MO-SEND
"KRN",9.2,364,2,7,0)
ADDRESSEES^XM-U-M-EDIT RECIPIENTS
"KRN",9.2,364,2,8,0)
SUBJECT^XM-U-M-EDIT SUBJECT
"KRN",9.2,364,2,9,0)
MAIL GROUP^XM-U-I-GROUP
"KRN",9.2,364,2,10,0)
PREFERRED EDITOR^XM-U-P-EDITOR
"KRN",9.2,364,2,11,0)
EDIT^XM-U-MO-EDIT
"KRN",9.2,365,-1)
0^44
"KRN",9.2,365,0)
XM-U-A-ADDRESS^SENDING A MESSAGE - ADDRESSING^3020411.0735^^
"KRN",9.2,365,1,0)
^9.21^21^21^3020411^^^^
"KRN",9.2,365,1,1,0)
 
"KRN",9.2,365,1,2,0)
You can address a message at the 'Send mail to:' or 'And send mail to:'
"KRN",9.2,365,1,3,0)
prompts. As a default, MailMan will always let you send a message to yourself
"KRN",9.2,365,1,4,0)
by automatically placing your name as the default response after the first
"KRN",9.2,365,1,5,0)
'Send mail to:' prompt. As an addressee, you can [QUERY] the message to see if
"KRN",9.2,365,1,6,0)
or when the other recipients opened the message you sent. Whether you initially
"KRN",9.2,365,1,7,0)
make yourself an addressee or not, you will receive all replies to the message.
"KRN",9.2,365,1,8,0)
 
"KRN",9.2,365,1,9,0)
Messages can be addressed locally to: [USERS], devices (H. or D.device_name),
"KRN",9.2,365,1,10,0)
servers (S.option_name), or [MAIL GROUPS]. Select a mail group by entering 'G.'
"KRN",9.2,365,1,11,0)
followed by enough characters to ensure identification. For example, 'G.SOUTH'
"KRN",9.2,365,1,12,0)
identifies the SOUTH mail group. If the group is [LARGE], MailMan will suggest
"KRN",9.2,365,1,13,0)
deferring delivery to save you time.  Messages can also be addressed to REMOTE
"KRN",9.2,365,1,14,0)
users. Sending to remote users is facilitated by a directory. 
"KRN",9.2,365,1,15,0)
 
"KRN",9.2,365,1,16,0)
Recipients may be marked as [INFORMATION ONLY] or [CARBON COPY].
"KRN",9.2,365,1,17,0)
Recipients who are 'Information Only' may not respond to the message. You
"KRN",9.2,365,1,18,0)
can also [STAGGER] the delivery of the message to individual recipients.
"KRN",9.2,365,1,19,0)
 
"KRN",9.2,365,1,20,0)
To remove recipients from the recipient list, enter a minus sign (hyphen)
"KRN",9.2,365,1,21,0)
immediately followed by the user's name (e.g., -SMITH,JOE).
"KRN",9.2,365,2,0)
^9.22A^9^7
"KRN",9.2,365,2,1,0)
MAIL GROUPS^XM-U-I-GROUP^
"KRN",9.2,365,2,4,0)
INFORMATION ONLY^XM-U-A-INFO ONLY
"KRN",9.2,365,2,5,0)
CARBON COPY^XM-U-A-CC
"KRN",9.2,365,2,6,0)
STAGGER^XM-U-A-STAGGER DELIVERY
"KRN",9.2,365,2,7,0)
QUERY^XM-U-M-QUERY
"KRN",9.2,365,2,8,0)
USERS^XM-U-A-LOCAL USER NAME
"KRN",9.2,365,2,9,0)
LARGE^XM-U-A-GROUP LARGE
"KRN",9.2,365,3,0)
^9.23A^1^1
"KRN",9.2,365,3,1,0)
XMJMT
"KRN",9.2,367,-1)
0^170
"KRN",9.2,367,0)
XM-U-M-SCRAMBLE^SCRAMBLING A MESSAGE BEFORE SENDING^2890609^
"KRN",9.2,367,1,0)
^^16^16^2990427^
"KRN",9.2,367,1,1,0)
 
"KRN",9.2,367,1,2,0)
You can use the Scramble action code (i.e., 'S') to have MailMan scramble
"KRN",9.2,367,1,3,0)
(encode) your message so only those recipients who know the [PASSWORD] can
"KRN",9.2,367,1,4,0)
unscramble (decode) your message. You may decide to send a message as
"KRN",9.2,367,1,5,0)
scrambled for security or privacy reasons. The sender can provide a
"KRN",9.2,367,1,6,0)
'[SCRAMBLE HINT]' to facilitate guessing the password.
"KRN",9.2,367,1,7,0)
 
"KRN",9.2,367,1,8,0)
You scramble a message by entering an 'S' after the 'Select Message
"KRN",9.2,367,1,9,0)
option: Transmit now//' prompt.
"KRN",9.2,367,1,10,0)
 
"KRN",9.2,367,1,11,0)
If this option is chosen, prompts appear for entering the scramble
"KRN",9.2,367,1,12,0)
password and scramble hint. The password can be from 3 to 20 characters in
"KRN",9.2,367,1,13,0)
length, with upper- and lowercase characters treated the same. The hint
"KRN",9.2,367,1,14,0)
will be shown to the recipient before s/he is asked to enter the password.
"KRN",9.2,367,1,15,0)
As the password cannot be recovered after being entered, the hint can be a
"KRN",9.2,367,1,16,0)
helpful reminder to the reader of the message.
"KRN",9.2,367,2,0)
^9.22A^2^2
"KRN",9.2,367,2,1,0)
SCRAMBLE HINT^XM-U-M-SCRAMBLE HINT
"KRN",9.2,367,2,2,0)
PASSWORD^XM-U-M-SCRAMBLE PASSWORD
"KRN",9.2,368,-1)
0^124
"KRN",9.2,368,0)
XM-U-M-CONFIRM RECEIPT^REQUESTING CONFIRMATION BEFORE SENDING A MESSAGE^2990114.1355^^
"KRN",9.2,368,1,0)
^^17^17^2990114^^^^
"KRN",9.2,368,1,1,0)
 
"KRN",9.2,368,1,2,0)
You can use the Confirm Receipt action code (i.e., 'R') to have MailMan
"KRN",9.2,368,1,3,0)
notify you (confirm) when each recipient has opened your message.
"KRN",9.2,368,1,4,0)
Unfortunately, however, we can't guarantee that every recipient will
"KRN",9.2,368,1,5,0)
actually read your message! The confirmation is in the form of a new
"KRN",9.2,368,1,6,0)
message sent to you. This is a toggle action code. If you enter 'R' again,
"KRN",9.2,368,1,7,0)
you will not receive a confirm receipt.
"KRN",9.2,368,1,8,0)
 
"KRN",9.2,368,1,9,0)
To request a confirmation receipt enter an 'R' after the 'Select Message
"KRN",9.2,368,1,10,0)
option:  Transmit now//' prompt.
"KRN",9.2,368,1,11,0)
 
"KRN",9.2,368,1,12,0)
You can request a Confirm Receipt from recipients at remote locations
"KRN",9.2,368,1,13,0)
as well as from local recipients.
"KRN",9.2,368,1,14,0)
 
"KRN",9.2,368,1,15,0)
As an alternative, when reading a message, you can find out if and when
"KRN",9.2,368,1,16,0)
any local user has read it.  At the 'Enter message option' prompt, you can
"KRN",9.2,368,1,17,0)
query ('QD') [ALL] users or query ('Q xxx') [SPECIFIC] ones. 
"KRN",9.2,368,2,0)
^9.22^3^2
"KRN",9.2,368,2,2,0)
ALL^XM-U-M-QUERY DETAILED
"KRN",9.2,368,2,3,0)
SPECIFIC^XM-U-M-QUERY SPECIFIC
"KRN",9.2,369,-1)
0^56
"KRN",9.2,369,0)
XM-U-B-BASKET SELECT^RESPONDING TO THE 'MAIL BASKET' PROMPT^2890609^
"KRN",9.2,369,1,0)
^^27^27^2990108^
"KRN",9.2,369,1,1,0)
 
"KRN",9.2,369,1,2,0)
Each user has at least an 'IN' basket, into which incoming mail is stored,
"KRN",9.2,369,1,3,0)
and a 'WASTE' basket, which holds old mail temporarily before permanent
"KRN",9.2,369,1,4,0)
deletion. You may add new baskets by [SAVING] messages or create [FILTER]
"KRN",9.2,369,1,5,0)
baskets as you wish to sort out your mail for future use.
"KRN",9.2,369,1,6,0)
 
"KRN",9.2,369,1,7,0)
For example, a 'PENDING' basket might be used to store messages that
"KRN",9.2,369,1,8,0)
require some future action. By [PRINTING] out your 'PENDING' basket, you
"KRN",9.2,369,1,9,0)
could have a quick reference for pending actions. Deleting or saving
"KRN",9.2,369,1,10,0)
messages in a 'DONE' basket, would clear out the 'PENDING' basket.
"KRN",9.2,369,1,11,0)
 
"KRN",9.2,369,1,12,0)
When you select either the Read/Manage Messages or New Messages and
"KRN",9.2,369,1,13,0)
Responses option and choose to read your mail by basket, if you have mail
"KRN",9.2,369,1,14,0)
in more than one basket, MailMan will ask you to indicate which basket
"KRN",9.2,369,1,15,0)
from which to start reading. You can do any of the following:
"KRN",9.2,369,1,16,0)
 
"KRN",9.2,369,1,17,0)
  <Enter>       Press the Return/Enter key to read messages from your 'IN'
"KRN",9.2,369,1,18,0)
                basket (default basket).
"KRN",9.2,369,1,19,0)
 
"KRN",9.2,369,1,20,0)
  BASKET NAME   Enter the name of a specific basket from which you
"KRN",9.2,369,1,21,0)
                wish to start reading.
"KRN",9.2,369,1,22,0)
 
"KRN",9.2,369,1,23,0)
  '??'          Enter two question marks to see the list of existing
"KRN",9.2,369,1,24,0)
                baskets in your mailbox.
"KRN",9.2,369,1,25,0)
 
"KRN",9.2,369,1,26,0)
  '^'           Enter the up-arrow ('^' uppercase 6 on most keyboards) to
"KRN",9.2,369,1,27,0)
                exit the option.
"KRN",9.2,369,2,0)
^9.22^4^3
"KRN",9.2,369,2,2,0)
FILTER^XM-U-P-FILTER
"KRN",9.2,369,2,3,0)
SAVING^XM-U-M-SAVE
"KRN",9.2,369,2,4,0)
PRINTING^XM-U-B-BASKET CONTENTS LIST
"KRN",9.2,370,-1)
0^67
"KRN",9.2,370,0)
XM-U-B-READER DIFF^BASKET ACTION CODES^2990120.1531^^
"KRN",9.2,370,1,0)
^^21^21^2990120^^^^
"KRN",9.2,370,1,1,0)
 
"KRN",9.2,370,1,2,0)
The following basket action codes are available with all message readers:
"KRN",9.2,370,1,3,0)

"KRN",9.2,370,1,4,0)
 n        Read message n, where n is a sequence number in this basket or
"KRN",9.2,370,1,5,0)
          an internal message ID of any message on the system.
"KRN",9.2,370,1,6,0)
 [C]        Change the name of this basket.
"KRN",9.2,370,1,7,0)
 [N]        List only the new messages in this basket.
"KRN",9.2,370,1,8,0)
 [Q]        Query (search for) messages in this basket.
"KRN",9.2,370,1,9,0)
 [R]        Resequence messages in this basket.
"KRN",9.2,370,1,10,0)

"KRN",9.2,370,1,11,0)
          These act on one or more messages in this basket:
"KRN",9.2,370,1,12,0)
 [D]        Delete messages.
"KRN",9.2,370,1,13,0)
 [F]        Forward messages.
"KRN",9.2,370,1,14,0)
 [FI]       Filter messages.
"KRN",9.2,370,1,15,0)
 [L]        Later messages.
"KRN",9.2,370,1,16,0)
 [P] or [H]   Print messages with or without a header.
"KRN",9.2,370,1,17,0)
 [S]        Save messages to another basket.
"KRN",9.2,370,1,18,0)
 [T]        Terminate messages.
"KRN",9.2,370,1,19,0)
 [X]        Toggle transmit priority in remote message queues. (POSTMASTER only)
"KRN",9.2,370,1,20,0)
 
"KRN",9.2,370,1,21,0)
 [MORE]...
"KRN",9.2,370,2,0)
^9.22^34^14
"KRN",9.2,370,2,9,0)
D^XM-U-M-DELETE^
"KRN",9.2,370,2,14,0)
P^XM-U-M-PRINT^
"KRN",9.2,370,2,15,0)
Q^XM-U-Q-SEARCH^
"KRN",9.2,370,2,19,0)
R^XM-U-B-RESEQUENCE MESSAGES^
"KRN",9.2,370,2,23,0)
H^XM-U-M-PRINT NO HEADER^
"KRN",9.2,370,2,24,0)
T^XM-U-M-TERMINATE^
"KRN",9.2,370,2,25,0)
C^XM-U-B-BASKET NAME CHANGE
"KRN",9.2,370,2,26,0)
F^XM-U-M-FORWARD
"KRN",9.2,370,2,27,0)
FI^XM-U-B-FILTER
"KRN",9.2,370,2,28,0)
L^XM-U-M-LATER
"KRN",9.2,370,2,29,0)
N^XM-U-B-NEW MAIL LIST
"KRN",9.2,370,2,30,0)
S^XM-U-M-SAVE
"KRN",9.2,370,2,32,0)
MORE^XM-U-B-READER DIFF-2
"KRN",9.2,370,2,34,0)
X^XM-U-B-XMIT PRIORITY TOGGLE
"KRN",9.2,371,-1)
0^118
"KRN",9.2,371,0)
XM-U-M-CHOOSE RANGE^SPECIFYING A LIST OR RANGE OF MESSAGES^2911003.0903^
"KRN",9.2,371,1,0)
^^21^21^2981231^
"KRN",9.2,371,1,1,0)
 
"KRN",9.2,371,1,2,0)
MailMan allows you to specify a range or list of messages for deletion,
"KRN",9.2,371,1,3,0)
filtering, forwarding, latering, printing, saving, or termination from a
"KRN",9.2,371,1,4,0)
basket.
"KRN",9.2,371,1,5,0)
 
"KRN",9.2,371,1,6,0)
To specify a range or list, use the following syntax:
"KRN",9.2,371,1,7,0)
 
"KRN",9.2,371,1,8,0)
  * Enter the message numbers separated by commas (e.g., '1,5,9').
"KRN",9.2,371,1,9,0)
 
"KRN",9.2,371,1,10,0)
  * Specify a range of numbers by separating the beginning and
"KRN",9.2,371,1,11,0)
    ending numbers with a dash/hyphen (e.g., '0-10', where '0' is the
"KRN",9.2,371,1,12,0)
    original message).
"KRN",9.2,371,1,13,0)
 
"KRN",9.2,371,1,14,0)
  * Specify at what message you want MailMan to include through the
"KRN",9.2,371,1,15,0)
    remaining messages by entering a specific number followed by a
"KRN",9.2,371,1,16,0)
    dash/hyphen (e.g., 20-, MailMan would include message 20 through
"KRN",9.2,371,1,17,0)
    the remaining messages).
"KRN",9.2,371,1,18,0)
 
"KRN",9.2,371,1,19,0)
  * Specify combinations of the above by putting ranges where 
"KRN",9.2,371,1,20,0)
    numbers would go, etc. (e.g., '0-3,5,8-10,20-', where '0' is the
"KRN",9.2,371,1,21,0)
    original message).
"KRN",9.2,372,-1)
0^143
"KRN",9.2,372,0)
XM-U-M-MESSAGE HEADER^WHAT APPEARS IN THE MESSAGE HEADER^2990120.0946^^
"KRN",9.2,372,1,0)
^^21^21^2990120^^
"KRN",9.2,372,1,1,0)
 
"KRN",9.2,372,1,2,0)
A message header is displayed or printed at the top of every screen or page
"KRN",9.2,372,1,3,0)
when you read or print a message.
"KRN",9.2,372,1,4,0)
 
"KRN",9.2,372,1,5,0)
The message header contains:
"KRN",9.2,372,1,6,0)
 
"KRN",9.2,372,1,7,0)
  * The subject. 
"KRN",9.2,372,1,8,0)
 
"KRN",9.2,372,1,9,0)
  * The MailMan internal message identification number.
"KRN",9.2,372,1,10,0)
 
"KRN",9.2,372,1,11,0)
  * The date the message was sent. 
"KRN",9.2,372,1,12,0)
 
"KRN",9.2,372,1,13,0)
  * How many lines there are in the original message.
"KRN",9.2,372,1,14,0)
 
"KRN",9.2,372,1,15,0)
  * Who sent the message. 
"KRN",9.2,372,1,16,0)
 
"KRN",9.2,372,1,17,0)
  * How many total responses there are and how many you've read.
"KRN",9.2,372,1,18,0)
 
"KRN",9.2,372,1,19,0)
  * Whether the message is *NEW*.
"KRN",9.2,372,1,20,0)

"KRN",9.2,372,1,21,0)
  * Which basket the message is in.
"KRN",9.2,372,2,0)
^9.22A^0^0
"KRN",9.2,373,-1)
0^147
"KRN",9.2,373,0)
XM-U-M-PRINT^PRINTING MESSAGES^2920824.0936^^
"KRN",9.2,373,1,0)
^^17^17^2990427^
"KRN",9.2,373,1,1,0)
 
"KRN",9.2,373,1,2,0)
The Print action code (i.e., 'P') allows you to print individual messages
"KRN",9.2,373,1,3,0)
or a group of messages in a mail basket:
"KRN",9.2,373,1,4,0)
 
"KRN",9.2,373,1,5,0)
  * Printing Individual messages - After reading a message, enter a 'P' at
"KRN",9.2,373,1,6,0)
    the 'Enter message action' prompt.
"KRN",9.2,373,1,7,0)
 
"KRN",9.2,373,1,8,0)
      - MailMan will first ask if you want to print a recipient list. If
"KRN",9.2,373,1,9,0)
        you choose to print recipients, you can print either a summary or
"KRN",9.2,373,1,10,0)
        detailed recipient list.
"KRN",9.2,373,1,11,0)
 
"KRN",9.2,373,1,12,0)
      - MailMan will then ask you what you want to print. The default
"KRN",9.2,373,1,13,0)
        response will always be to print the original message and all
"KRN",9.2,373,1,14,0)
        responses. However, you can choose to print any [COMBINATION] of
"KRN",9.2,373,1,15,0)
        responses (single or range), with or without the original message.
"KRN",9.2,373,1,16,0)
 
"KRN",9.2,373,1,17,0)
[MORE]... 
"KRN",9.2,373,2,0)
^9.22^5^2
"KRN",9.2,373,2,3,0)
COMBINATION^XM-U-M-CHOOSE RESPONSES
"KRN",9.2,373,2,5,0)
MORE^XM-U-M-PRINT-2
"KRN",9.2,374,-1)
0^171
"KRN",9.2,374,0)
XM-U-M-SCRAMBLE HINT^RESPONDING TO 'Enter Scramble Hint'^2890609^
"KRN",9.2,374,1,0)
^^7^7^2981230^
"KRN",9.2,374,1,1,0)
 
"KRN",9.2,374,1,2,0)
A scramble hint is used to suggest to the reader what the scramble
"KRN",9.2,374,1,3,0)
[PASSWORD] is. Since the password is not recoverable after it is entered, 
"KRN",9.2,374,1,4,0)
the hint can be a helpful reminder to the reader of the message.
"KRN",9.2,374,1,5,0)
 
"KRN",9.2,374,1,6,0)
The hint will be shown to the recipient before being asked to enter the
"KRN",9.2,374,1,7,0)
scramble password.
"KRN",9.2,374,2,0)
^9.22A^1^1
"KRN",9.2,374,2,1,0)
PASSWORD^XM-U-M-SCRAMBLE PASSWORD
"KRN",9.2,374,3,0)
^9.23A^^0
"KRN",9.2,375,-1)
0^172
"KRN",9.2,375,0)
XM-U-M-SCRAMBLE PASSWORD^RESPONDING TO 'Enter Scramble Password'^2890609^
"KRN",9.2,375,1,0)
^^6^6^2981230^
"KRN",9.2,375,1,1,0)
 
"KRN",9.2,375,1,2,0)
The scramble password is a private code which must be exactly correct for
"KRN",9.2,375,1,3,0)
a reader to unscramble a message and make it legible. It can be from 3 to
"KRN",9.2,375,1,4,0)
20 characters long. Upper- and lowercase characters are treated the same.
"KRN",9.2,375,1,5,0)
The scramble [HINT] that accompanies the scrambled message can help
"KRN",9.2,375,1,6,0)
decipher the password.
"KRN",9.2,375,2,0)
^9.22A^1^1
"KRN",9.2,375,2,1,0)
HINT^XM-U-M-SCRAMBLE HINT
"KRN",9.2,375,3,0)
^9.23A^^0
"KRN",9.2,376,-1)
0^96
"KRN",9.2,376,0)
XM-U-I-GROUP^MAIL GROUPS^2990120.1143^^
"KRN",9.2,376,1,0)
^^20^20^2990120^^^
"KRN",9.2,376,1,1,0)
 
"KRN",9.2,376,1,2,0)
Mail groups consist of MailMan users ([MEMBERS]) with similar interests in
"KRN",9.2,376,1,3,0)
a particular topic. Mail groups provide a forum for group discussion where
"KRN",9.2,376,1,4,0)
members can share ideas and concepts related to the group. 
"KRN",9.2,376,1,5,0)
 
"KRN",9.2,376,1,6,0)
As a member of a mail group, you, along with other members, receive
"KRN",9.2,376,1,7,0)
messages directed to that mail group. One can address a message to a
"KRN",9.2,376,1,8,0)
group of recipients without having to specify them individually by name.
"KRN",9.2,376,1,9,0)
Thus, whenever mail is repeatedly sent to the same list of recipients,
"KRN",9.2,376,1,10,0)
users can save time by putting them in mail groups.
"KRN",9.2,376,1,11,0)
 
"KRN",9.2,376,1,12,0)
Members can be added or removed at any time. They can be local and remote
"KRN",9.2,376,1,13,0)
users, other mail groups, or distribution lists (nationwide mail groups). 
"KRN",9.2,376,1,14,0)
 
"KRN",9.2,376,1,15,0)
Mail groups can also be restricted to a limited set of Authorized Senders.
"KRN",9.2,376,1,16,0)
Thus, only certain users are allowed to send mail to the mail group. If
"KRN",9.2,376,1,17,0)
unspecified, then it is assumed that anyone can send mail to a group,
"KRN",9.2,376,1,18,0)
if [PUBLIC], or only members can send to it, if [PRIVATE].
"KRN",9.2,376,1,19,0)
 
"KRN",9.2,376,1,20,0)
[MORE]... 
"KRN",9.2,376,2,0)
^9.22A^8^4
"KRN",9.2,376,2,3,0)
MEMBERS^XM-U-I-GROUP MEMBER^
"KRN",9.2,376,2,6,0)
MORE^XM-U-I-GROUP-2
"KRN",9.2,376,2,7,0)
PUBLIC^XM-U-P-GROUP ENROLL
"KRN",9.2,376,2,8,0)
PRIVATE^XM-U-P-GROUP PERSONAL
"KRN",9.2,377,-1)
0^125
"KRN",9.2,377,0)
XM-U-M-COPY^COPYING A MESSAGE INTO A NEW MESSAGE^2990120.1309^^
"KRN",9.2,377,1,0)
^^15^15^2990427^
"KRN",9.2,377,1,1,0)
 
"KRN",9.2,377,1,2,0)
You can use the Copy action code (i.e., 'C') to copy a message.
"KRN",9.2,377,1,3,0)
 
"KRN",9.2,377,1,4,0)
When you copy a message, you are given several [OPTIONS] as to what should be
"KRN",9.2,377,1,5,0)
included in the copy and whether to deliver the copy to the same recipients. 
"KRN",9.2,377,1,6,0)
 
"KRN",9.2,377,1,7,0)
You can edit the copied message's subject and any part of the message text or
"KRN",9.2,377,1,8,0)
responses (e.g., delete unwanted portions or add additional text anywhere in
"KRN",9.2,377,1,9,0)
the copy).
"KRN",9.2,377,1,10,0)
 
"KRN",9.2,377,1,11,0)
As with any other message you are [SENDING], MailMan will also ask
"KRN",9.2,377,1,12,0)
you to enter the [RECIPIENTS] to receive this copied message. 
"KRN",9.2,377,1,13,0)
 
"KRN",9.2,377,1,14,0)
To copy the original message and any responses, enter a 'C' at the 'Enter
"KRN",9.2,377,1,15,0)
message action' prompt.
"KRN",9.2,377,2,0)
^9.22^16^3
"KRN",9.2,377,2,13,0)
RECIPIENTS^XM-U-A-ADDRESS
"KRN",9.2,377,2,14,0)
SENDING^XM-U-M-SEND
"KRN",9.2,377,2,16,0)
OPTIONS^XM-U-M-COPY-2
"KRN",9.2,377,3,0)
^9.23A^^0
"KRN",9.2,379,-1)
0^145
"KRN",9.2,379,0)
XM-U-M-NEW^MAKE NEW MESSAGES NOT NEW AND VICE VERSA^2991213.1443^^
"KRN",9.2,379,1,0)
^^14^14^2991213^^^
"KRN",9.2,379,1,1,0)
 
"KRN",9.2,379,1,2,0)
The New Toggle action code allows you to make existing messages appear new
"KRN",9.2,379,1,3,0)
or make new messages not new.  The toggle works as follows:
"KRN",9.2,379,1,4,0)
 
"KRN",9.2,379,1,5,0)
  * Make a message 'new' - MailMan adds the new flag (i.e., '*' asterisk)
"KRN",9.2,379,1,6,0)
    next to the message, as if it hasn't been opened/read yet.
"KRN",9.2,379,1,7,0)
 
"KRN",9.2,379,1,8,0)
  * Make a 'new' message not appear as 'new' (i.e., Un New) - MailMan
"KRN",9.2,379,1,9,0)
    removes the new flag (i.e., '*' asterisk) next to the message, as if
"KRN",9.2,379,1,10,0)
    it was already opened/read.
"KRN",9.2,379,1,11,0)
 
"KRN",9.2,379,1,12,0)
You can toggle between these two actions with this one action code.
"KRN",9.2,379,1,13,0)
 
"KRN",9.2,379,1,14,0)
 [MORE]...
"KRN",9.2,379,2,0)
^9.22^2^1
"KRN",9.2,379,2,2,0)
MORE^XM-U-M-NEW-2
"KRN",9.2,381,-1)
0^235
"KRN",9.2,381,0)
XM-U-Q-CLASSIC LOOKUP ?^LOOKING FOR MESSAGES WHOSE SUBJECT CONTAINS A SPECIFIC STRING^2990421.1237^^
"KRN",9.2,381,1,0)
^^13^13^2990421^
"KRN",9.2,381,1,1,0)
 
"KRN",9.2,381,1,2,0)
While in a basket, you can search for messages in the basket whose subject
"KRN",9.2,381,1,3,0)
contains a specific string.
"KRN",9.2,381,1,4,0)
 
"KRN",9.2,381,1,5,0)
At the 'Basket Message' prompt, enter the string preceded by a '?'. You
"KRN",9.2,381,1,6,0)
will then be shown a list of those messages in the basket which CONTAIN
"KRN",9.2,381,1,7,0)
that string in their subject, and can choose which you would like to read.
"KRN",9.2,381,1,8,0)
 
"KRN",9.2,381,1,9,0)
For example, if you want to search for messages in the basket whose
"KRN",9.2,381,1,10,0)
subject contains the word 'SCHEDULE', you would enter '?SCHEDULE'.
"KRN",9.2,381,1,11,0)
This search is with uppercase and lowercase treated identically.
"KRN",9.2,381,1,12,0)
Thus, for example, 'SCHEDULE' and 'Schedule' would both be found
"KRN",9.2,381,1,13,0)
with the search.
"KRN",9.2,381,2,0)
^9.22^0^0
"KRN",9.2,382,-1)
0^92
"KRN",9.2,382,0)
XM-U-H-QUESTIONS^FREQUENTLY ASKED QUESTIONS ABOUT MAILMAN^3020506.1119^^
"KRN",9.2,382,1,0)
^9.21^18^18^3020506^^
"KRN",9.2,382,1,1,0)
 
"KRN",9.2,382,1,2,0)
  1. [RECALLING] OR EDITING A MESSAGE AFTER TRANSMISSION
"KRN",9.2,382,1,3,0)
     Is there a way to recall or edit a message once it's been sent?
"KRN",9.2,382,1,4,0)
  2. [REMOVING] A RECIPIENT FROM THE LIST
"KRN",9.2,382,1,5,0)
     How can an accidentally chosen recipient be removed from the list?
"KRN",9.2,382,1,6,0)
  3. [LOOKING UP] A MESSAGE TO BE READ
"KRN",9.2,382,1,7,0)
     Is there a way of finding a message if you cannot recall the number?
"KRN",9.2,382,1,8,0)
  4. [DISAPPEARED] MESSAGES WHICH HAVE NOT BEEN DELETED
"KRN",9.2,382,1,9,0)
     Sometimes the read option will show only the message header without
"KRN",9.2,382,1,10,0)
     the text. What happened to the original message?
"KRN",9.2,382,1,11,0)
  5. [REPLIES] TO MESSAGES FROM UNKNOWN RECIPIENTS
"KRN",9.2,382,1,12,0)
     Why replies appear in a mailbox to a message which I didn't originate?
"KRN",9.2,382,1,13,0)
  6. [DELETED] MESSAGES
"KRN",9.2,382,1,14,0)
     Once a message is deleted, is it actually gone from the system?
"KRN",9.2,382,1,15,0)
  7. [INTERRUPTED] MESSAGES
"KRN",9.2,382,1,16,0)
     Can a message be saved temporarily after an interruption?
"KRN",9.2,382,1,17,0)
  8. [FILTERING] MAIL
"KRN",9.2,382,1,18,0)
     Can certain messages be automatically directed to specific baskets?
"KRN",9.2,382,2,0)
^9.22A^8^8
"KRN",9.2,382,2,1,0)
RECALLING^XM-U-H-Q RECALL^
"KRN",9.2,382,2,2,0)
REMOVING^XM-U-H-Q REMOVE^
"KRN",9.2,382,2,3,0)
LOOKING UP^XM-U-H-Q LOOKUP^
"KRN",9.2,382,2,4,0)
DISAPPEARED^XM-U-H-Q DISAPPEARED^
"KRN",9.2,382,2,5,0)
REPLIES^XM-U-H-Q REPLIES^
"KRN",9.2,382,2,6,0)
DELETED^XM-U-H-Q DELETE^
"KRN",9.2,382,2,7,0)
INTERRUPTED^XM-U-H-Q INTERRUPT^
"KRN",9.2,382,2,8,0)
FILTERING^XM-U-P-FILTER
"KRN",9.2,383,-1)
0^89
"KRN",9.2,383,0)
XM-U-H-Q RECALL^RECALLING OR EDITING A MESSAGE AFTER TRANSMISSION^2911001.0629^^
"KRN",9.2,383,1,0)
^^13^13^2990107^
"KRN",9.2,383,1,1,0)
 
"KRN",9.2,383,1,2,0)
Is there a way to recall or edit a message once it's been sent?
"KRN",9.2,383,1,3,0)
 
"KRN",9.2,383,1,4,0)
You cannot completely recall a message once it's been sent. However, you
"KRN",9.2,383,1,5,0)
can edit the message, provided that:
"KRN",9.2,383,1,6,0)
 
"KRN",9.2,383,1,7,0)
  * You created the message and did not send it to anyone except yourself.
"KRN",9.2,383,1,8,0)
 
"KRN",9.2,383,1,9,0)
  * The message you wish to edit is the original message and not a reply.
"KRN",9.2,383,1,10,0)
 
"KRN",9.2,383,1,11,0)
Using the [READ]/Manage Messages option, after displaying the text of the
"KRN",9.2,383,1,12,0)
message, you will be prompted with the 'Enter message option'. Enter an
"KRN",9.2,383,1,13,0)
'E' ([EDIT]) and choose from any number of edit options.
"KRN",9.2,383,2,0)
^9.22A^2^2
"KRN",9.2,383,2,1,0)
EDIT^XM-U-MO-EDIT
"KRN",9.2,383,2,2,0)
READ^XM-U-R-READ
"KRN",9.2,384,-1)
0^90
"KRN",9.2,384,0)
XM-U-H-Q REMOVE^REMOVING A RECIPIENT FROM THE LIST^2890609^
"KRN",9.2,384,1,0)
^^16^16^2981228^
"KRN",9.2,384,1,1,0)
 
"KRN",9.2,384,1,2,0)
If a user is accidently chosen as a recipient for a message, how can they
"KRN",9.2,384,1,3,0)
be removed from the list?
"KRN",9.2,384,1,4,0)
 
"KRN",9.2,384,1,5,0)
A message is not actually sent to anyone until you respond to the 'Select
"KRN",9.2,384,1,6,0)
Message option:  Transmit now//' prompt with 'T' for transmit. Enter an
"KRN",9.2,384,1,7,0)
'ER' for [EDIT RECIPIENTS] at this prompt if you wish to delete a
"KRN",9.2,384,1,8,0)
recipient.
"KRN",9.2,384,1,9,0)
 
"KRN",9.2,384,1,10,0)
To take someone off the recipient list, enter their name preceded with a
"KRN",9.2,384,1,11,0)
minus or hyphen ('-'). This will delete them from the list.
"KRN",9.2,384,1,12,0)
 
"KRN",9.2,384,1,13,0)
NOTE: You cannot remove a recipient from the list after the message has
"KRN",9.2,384,1,14,0)
      been sent. Think of the [TRANSMIT] option as dropping a message in a
"KRN",9.2,384,1,15,0)
      post office mail box. You cannot recall a message once it has been
"KRN",9.2,384,1,16,0)
      sent.
"KRN",9.2,384,2,0)
^9.22A^2^2
"KRN",9.2,384,2,1,0)
EDIT RECIPIENTS^XM-U-M-EDIT RECIPIENTS
"KRN",9.2,384,2,2,0)
TRANSMIT^XM-U-M-TRANSMIT NOW
"KRN",9.2,385,-1)
0^88
"KRN",9.2,385,0)
XM-U-H-Q LOOKUP^LOOKING UP A MESSAGE TO BE READ^2990319.1447^^
"KRN",9.2,385,1,0)
^^20^20^2990319^^^^
"KRN",9.2,385,1,1,0)
 
"KRN",9.2,385,1,2,0)
Is there a way of finding a message if you cannot recall the number?
"KRN",9.2,385,1,3,0)
 
"KRN",9.2,385,1,4,0)
Yes, there are several ways to look up a message. 
"KRN",9.2,385,1,5,0)
 
"KRN",9.2,385,1,6,0)
When you are using one of the [FULL SCREEN] message readers, MailMan
"KRN",9.2,385,1,7,0)
displays a list of messages in a basket. You can then choose from this
"KRN",9.2,385,1,8,0)
list by entering a message number after the 'Enter message number or
"KRN",9.2,385,1,9,0)
command:' prompt.
"KRN",9.2,385,1,10,0)
 
"KRN",9.2,385,1,11,0)
To see a list of messages using the [CLASSIC] message reader, enter ONE or
"KRN",9.2,385,1,12,0)
TWO question marks after the 'Basket Message' prompt. You can then choose
"KRN",9.2,385,1,13,0)
from this list by message number.
"KRN",9.2,385,1,14,0)

"KRN",9.2,385,1,15,0)
In either of the message readers, you can look up a message based on what
"KRN",9.2,385,1,16,0)
the subject [BEGINS WITH] or [CONTAINS].  You can also use the Query ('Q')
"KRN",9.2,385,1,17,0)
action code to search for messages in a basket based on multiple [CRITERIA].
"KRN",9.2,385,1,18,0)

"KRN",9.2,385,1,19,0)
On the main MailMan Menu, you can use the Query/Search for Messages option
"KRN",9.2,385,1,20,0)
to search for messages [ANYWHERE] in your mailbox or on the system.
"KRN",9.2,385,2,0)
^9.22^11^6
"KRN",9.2,385,2,3,0)
CLASSIC^XM-U-B-READER CLASSIC
"KRN",9.2,385,2,6,0)
FULL SCREEN^XM-U-B-READER FULL SCREEN
"KRN",9.2,385,2,7,0)
ANYWHERE^XM-U-Q-SEARCH
"KRN",9.2,385,2,9,0)
BEGINS WITH^XM-U-Q-CLASSIC LOOKUP ??
"KRN",9.2,385,2,10,0)
CONTAINS^XM-U-Q-CLASSIC LOOKUP ?
"KRN",9.2,385,2,11,0)
CRITERIA^XM-U-Q-SEARCH CRITERIA
"KRN",9.2,386,-1)
0^91
"KRN",9.2,386,0)
XM-U-H-Q REPLIES^REPLIES TO A MESSAGE FROM AN UNKNOWN RECIPIENT^2890609^
"KRN",9.2,386,1,0)
^^12^12^2981228^
"KRN",9.2,386,1,1,0)
 
"KRN",9.2,386,1,2,0)
Why do replies appear in the mailbox to a message I didn't originate?
"KRN",9.2,386,1,3,0)
 
"KRN",9.2,386,1,4,0)
This occurs when you are the recipient of a message that has been sent to
"KRN",9.2,386,1,5,0)
others. If one of the other recipients [REPLIES] to the message, all of
"KRN",9.2,386,1,6,0)
the other recipients receive the reply. This feature is similar to
"KRN",9.2,386,1,7,0)
teleconferencing.
"KRN",9.2,386,1,8,0)
 
"KRN",9.2,386,1,9,0)
If you are sending a message to a group of recipients and you don't want
"KRN",9.2,386,1,10,0)
any of the recipients to reply, make the message [INFORMATION ONLY]. If
"KRN",9.2,386,1,11,0)
you don't want specific recipients to reply, [PREFIX] the recipient names
"KRN",9.2,386,1,12,0)
with 'INFO:'.
"KRN",9.2,386,2,0)
^9.22A^3^3
"KRN",9.2,386,2,1,0)
REPLIES^XM-U-M-REPLY
"KRN",9.2,386,2,2,0)
PREFIX^XM-U-A-INFO ONLY
"KRN",9.2,386,2,3,0)
INFORMATION ONLY^XM-U-M-INFO ONLY
"KRN",9.2,387,-1)
0^85
"KRN",9.2,387,0)
XM-U-H-Q DELETE^DELETED MESSAGES^2890609^
"KRN",9.2,387,1,0)
^^11^11^2990108^
"KRN",9.2,387,1,1,0)
 
"KRN",9.2,387,1,2,0)
Once a message is deleted, is it actually gone from the system?
"KRN",9.2,387,1,3,0)
 
"KRN",9.2,387,1,4,0)
No. When you [DELETE] messages, they are put into your 'WASTE' basket.
"KRN",9.2,387,1,5,0)
To access these deleted messages, read messages in your 'WASTE' basket.
"KRN",9.2,387,1,6,0)
You can then [SAVE] them to a different basket.
"KRN",9.2,387,1,7,0)
 
"KRN",9.2,387,1,8,0)
The message will be deleted from your 'WASTE' basket automatically when
"KRN",9.2,387,1,9,0)
the MailMan purge utility is run. However, the message remains in the
"KRN",9.2,387,1,10,0)
system until all recipients of the message have deleted it from their
"KRN",9.2,387,1,11,0)
mailbox.
"KRN",9.2,387,2,0)
^9.22A^2^2
"KRN",9.2,387,2,1,0)
DELETE^XM-U-M-DELETE
"KRN",9.2,387,2,2,0)
SAVE^XM-U-M-SAVE
"KRN",9.2,389,-1)
0^195
"KRN",9.2,389,0)
XM-U-P-BANNER^THE MAILMAN BANNER^2890609^
"KRN",9.2,389,1,0)
^^32^32^2981229^
"KRN",9.2,389,1,1,0)
 
"KRN",9.2,389,1,2,0)
The MailMan Banner is used to display any information that you want other
"KRN",9.2,389,1,3,0)
MailMan users to see. Banners can be used to list business information,
"KRN",9.2,389,1,4,0)
personal information, favorite quotes, etc., whatever you feel is
"KRN",9.2,389,1,5,0)
appropriate in a business environment. You are not required to have a
"KRN",9.2,389,1,6,0)
MailMan Banner; it is up to you to decide.
"KRN",9.2,389,1,7,0)
 
"KRN",9.2,389,1,8,0)
Banners are displayed in the following three instances:
"KRN",9.2,389,1,9,0)
 
"KRN",9.2,389,1,10,0)
  * Your MailMan banner is displayed to anyone addressing a message to
"KRN",9.2,389,1,11,0)
    you. This is useful, for example, if you will be on vacation and
"KRN",9.2,389,1,12,0)
    wish to let others know that mail will not be regularly checked.
"KRN",9.2,389,1,13,0)
 
"KRN",9.2,389,1,14,0)
  * Your banner is also displayed whenever you enter the MailMan menu,
"KRN",9.2,389,1,15,0)
    so that you will not forget to change or delete it when it is no
"KRN",9.2,389,1,16,0)
    longer appropriate.
"KRN",9.2,389,1,17,0)
 
"KRN",9.2,389,1,18,0)
  * Your MailMan Banner is also displayed to you or others when using the
"KRN",9.2,389,1,19,0)
    User Information option on the Help (User/Group Info., etc.) menu to
"KRN",9.2,389,1,20,0)
    obtain information about you.
"KRN",9.2,389,1,21,0)
 
"KRN",9.2,389,1,22,0)
Banners can range from 2 to 200 characters in length and can contain
"KRN",9.2,389,1,23,0)
any combination of numbers, alphabetic characters, symbols (e.g., #,
"KRN",9.2,389,1,24,0)
$, %, &, *), and punctuation marks.
"KRN",9.2,389,1,25,0)
 
"KRN",9.2,389,1,26,0)
You can enter or change your banner using either of two methods:
"KRN",9.2,389,1,27,0)
 
"KRN",9.2,389,1,28,0)
  * Use the User Options Edit option with the 'BANNER:' prompt.
"KRN",9.2,389,1,29,0)
 
"KRN",9.2,389,1,30,0)
  * Use the Banner Edit option on the Personal Preferences menu.
"KRN",9.2,389,1,31,0)
 
"KRN",9.2,389,1,32,0)
NOTE: The banner is not displayed when a group of users is selected.
"KRN",9.2,390,-1)
0^211
"KRN",9.2,390,0)
XM-U-P-INTRODUCTION^INTRODUCING YOURSELF IN MAILMAN^2890609^
"KRN",9.2,390,1,0)
^^19^19^2990513^
"KRN",9.2,390,1,1,0)
 
"KRN",9.2,390,1,2,0)
In order that other users of the system can get to know new users,
"KRN",9.2,390,1,3,0)
the latter may enter several lines of introductory text, as well as an
"KRN",9.2,390,1,4,0)
address, phone number, and other [CONTACT INFORMATION]. The Introduction
"KRN",9.2,390,1,5,0)
field provides you with the opportunity to 'introduce' yourself to other
"KRN",9.2,390,1,6,0)
MailMan users. Since it is a word processing field, MailMan allows you to
"KRN",9.2,390,1,7,0)
enter as much information as you wish. You may or may not be required to
"KRN",9.2,390,1,8,0)
enter an Introduction depending on your site's policy.
"KRN",9.2,390,1,9,0)
 
"KRN",9.2,390,1,10,0)
Your Introduction is only displayed when users do a lookup on you via the
"KRN",9.2,390,1,11,0)
User Information option on the Help (User/Group Info., etc.) menu.
"KRN",9.2,390,1,12,0)
 
"KRN",9.2,390,1,13,0)
Since the Introduction field is a word processing field there is no upper
"KRN",9.2,390,1,14,0)
limit on the number of characters you can enter. You can also include any
"KRN",9.2,390,1,15,0)
combination of numbers, alphabetic characters, symbols (e.g., #, $, %, &,
"KRN",9.2,390,1,16,0)
*), and punctuation marks.
"KRN",9.2,390,1,17,0)
 
"KRN",9.2,390,1,18,0)
The 'INTRODUCTION:' field can be set through the User Options Edit option
"KRN",9.2,390,1,19,0)
on the Personal Preferences menu.
"KRN",9.2,390,2,0)
^9.22A^1^1
"KRN",9.2,390,2,1,0)
CONTACT INFORMATION^XM-U-P-OFFICE INFO
"KRN",9.2,391,-1)
0^101
"KRN",9.2,391,0)
XM-U-I-SURROGATE^MAILMAN SURROGATES^2931206.2053^
"KRN",9.2,391,1,0)
^^13^13^2990108^
"KRN",9.2,391,1,1,0)
 
"KRN",9.2,391,1,2,0)
A surrogate is someone who substitutes for someone else. MailMan gives all
"KRN",9.2,391,1,3,0)
users the opportunity to [DESIGNATE] someone to act as their surrogate. It
"KRN",9.2,391,1,4,0)
also allows all users to [BECOME] a surrogate.
"KRN",9.2,391,1,5,0)
 
"KRN",9.2,391,1,6,0)
There are several occasions when you may wish to designate someone as your
"KRN",9.2,391,1,7,0)
surrogate. For example, if you are going on vacation, you may ask someone
"KRN",9.2,391,1,8,0)
to be a surrogate for you while you are out of the office. Specifically, a
"KRN",9.2,391,1,9,0)
manager or project team member may ask their administrative assistant or
"KRN",9.2,391,1,10,0)
co-worker to read their mail while they are out of the office so that
"KRN",9.2,391,1,11,0)
critical or important messages can be read and responded to without delay.
"KRN",9.2,391,1,12,0)
 
"KRN",9.2,391,1,13,0)
[MORE]... 
"KRN",9.2,391,2,0)
^9.22A^10^3
"KRN",9.2,391,2,6,0)
BECOME^XM-U-I-SURROGATE BECOME
"KRN",9.2,391,2,9,0)
MORE^XM-U-I-SURROGATE-2
"KRN",9.2,391,2,10,0)
DESIGNATE^XM-U-P-SURROGATE EDIT
"KRN",9.2,392,-1)
0^194
"KRN",9.2,392,0)
XM-U-P-ASK BASKET^THE 'ASK BASKET' PROMPT^2890609^
"KRN",9.2,392,1,0)
^^13^13^2981229^
"KRN",9.2,392,1,1,0)
 
"KRN",9.2,392,1,2,0)
MailMan allows you to decide up front whether you want to be prompted each
"KRN",9.2,392,1,3,0)
time to choose a mail basket whenever you send yourself e-mail. You can
"KRN",9.2,392,1,4,0)
either choose to be prompted at each occurrence or automatically have the
"KRN",9.2,392,1,5,0)
mail default to the 'IN' basket.
"KRN",9.2,392,1,6,0)
 
"KRN",9.2,392,1,7,0)
To set your mail basket prompt, use the User Options Edit option on the
"KRN",9.2,392,1,8,0)
Personal Preferences menu to answer the 'ASK BASKET?:' prompt.
"KRN",9.2,392,1,9,0)
 
"KRN",9.2,392,1,10,0)
  * If 'YES' is entered, you will be asked 'What basket?' when sending a 
"KRN",9.2,392,1,11,0)
    message to yourself.
"KRN",9.2,392,1,12,0)
 
"KRN",9.2,392,1,13,0)
  * If 'NO' is entered, the message will go to your 'IN' basket.
"KRN",9.2,393,-1)
0^123
"KRN",9.2,393,0)
XM-U-M-CONFIDENTIAL^MAKING A MESSAGE CONFIDENTIAL^2890609^
"KRN",9.2,393,1,0)
^^9^9^2990111^
"KRN",9.2,393,1,1,0)
 
"KRN",9.2,393,1,2,0)
You can use the Confidential action code (i.e., 'C') to only allow the
"KRN",9.2,393,1,3,0)
designated recipient(s) and not their [SURROGATE](s) to read the message
"KRN",9.2,393,1,4,0)
you are sending, unless a surrogate trying to read the message is the
"KRN",9.2,393,1,5,0)
same surrogate that sent it. This is a toggle action code. If you enter
"KRN",9.2,393,1,6,0)
'C' again, the message will no longer be confidential.
"KRN",9.2,393,1,7,0)
 
"KRN",9.2,393,1,8,0)
To send a confidential message, enter a 'C' at the 'Select Message option:
"KRN",9.2,393,1,9,0)
Transmit now//' prompt.
"KRN",9.2,393,2,0)
^9.22A^2^1
"KRN",9.2,393,2,2,0)
SURROGATE^XM-U-I-SURROGATE
"KRN",9.2,399,-1)
0^102
"KRN",9.2,399,0)
XM-U-I-SURROGATE BECOME^BECOMING A SURROGATE^2990120.0815^^
"KRN",9.2,399,1,0)
^^18^18^2990120^^
"KRN",9.2,399,1,1,0)
 
"KRN",9.2,399,1,2,0)
All users of MailMan are given the option to act as a Surrogate for
"KRN",9.2,399,1,3,0)
[SHARED,MAIL]. If you have been [DESIGNATED] as a surrogate by other MailMan
"KRN",9.2,399,1,4,0)
users, you may act as a surrogate for those users, too.
"KRN",9.2,399,1,5,0)

"KRN",9.2,399,1,6,0)
To become a surrogate, choose the Become a Surrogate (SHARED,MAIL or Other)
"KRN",9.2,399,1,7,0)
option on the MailMan menu. If you are not anyone's surrogate, you will become
"KRN",9.2,399,1,8,0)
SHARED,MAIL.  If you are someone's surrogate, you will be asked whom you wish
"KRN",9.2,399,1,9,0)
to become.  If you enter a '?', MailMan will show you the users for whom you
"KRN",9.2,399,1,10,0)
may act as a surrogate, as well as your access privileges ([READ] or [WRITE])
"KRN",9.2,399,1,11,0)
and whether the user has any new mail. 
"KRN",9.2,399,1,12,0)
 
"KRN",9.2,399,1,13,0)
When acting as a surrogate, you will be using your own MailMan message center
"KRN",9.2,399,1,14,0)
[PREFERENCES] when reading mail and not the other user's preferences. For
"KRN",9.2,399,1,15,0)
example, if you have set your message reader to use the Detailed Full Screen
"KRN",9.2,399,1,16,0)
message reader and the user who designated you as the surrogate uses the
"KRN",9.2,399,1,17,0)
Classic message reader, you will still view that user's messages in the
"KRN",9.2,399,1,18,0)
Detailed full screen and not in the Classic message reader. 
"KRN",9.2,399,2,0)
^9.22^10^5
"KRN",9.2,399,2,1,0)
DESIGNATED^XM-U-P-SURROGATE EDIT
"KRN",9.2,399,2,4,0)
SHARED,MAIL^XM-U-I-SHARED MAIL
"KRN",9.2,399,2,6,0)
READ^XM-U-P-SURROGATE READ PRIV
"KRN",9.2,399,2,9,0)
WRITE^XM-U-P-SURROGATE WRITE PRIV
"KRN",9.2,399,2,10,0)
PREFERENCES^XM-U-P-OPTIONS
"KRN",9.2,400,-1)
0^232
"KRN",9.2,400,0)
XM-U-P-SURROGATE EDIT^SURROGATES - DESIGNATING SURROGATES^2990114.1402^^
"KRN",9.2,400,1,0)
^^21^21^2990201^
"KRN",9.2,400,1,1,0)
 
"KRN",9.2,400,1,2,0)
MailMan provides you with the Surrogate Edit option for designating
"KRN",9.2,400,1,3,0)
surrogates to read and send your own e-mail. This option is available on
"KRN",9.2,400,1,4,0)
the Personal Preferences menu.
"KRN",9.2,400,1,5,0)
 
"KRN",9.2,400,1,6,0)
You can use the Surrogate Edit option when you know you will not be able to
"KRN",9.2,400,1,7,0)
read your mail for a period of time but still want your mail monitored and
"KRN",9.2,400,1,8,0)
taken care of in a timely fashion. The people you designate as surrogates can
"KRN",9.2,400,1,9,0)
be given [READ] or read and [WRITE] access to your mail. These people have the
"KRN",9.2,400,1,10,0)
ability to [ASSUME] your identity for the purposes of reading and/or sending
"KRN",9.2,400,1,11,0)
your mail. 
"KRN",9.2,400,1,12,0)
 
"KRN",9.2,400,1,13,0)
If a message is sent [CONFIDENTIAL], surrogates cannot view it. If a
"KRN",9.2,400,1,14,0)
message has been [SCRAMBLED], surrogates that don't know the password
"KRN",9.2,400,1,15,0)
cannot read it. Thus, you would be wise to inform people from whom you
"KRN",9.2,400,1,16,0)
receive mail of a private nature (not to be read by your surrogate) to
"KRN",9.2,400,1,17,0)
send it confidential or to scramble it.
"KRN",9.2,400,1,18,0)
 
"KRN",9.2,400,1,19,0)
MailMan will record the fact that a surrogate has sent messages or
"KRN",9.2,400,1,20,0)
[REPLIED] while assuming your identity in the message. You can see this
"KRN",9.2,400,1,21,0)
when you read or [QUERY] ('QD') the message.
"KRN",9.2,400,2,0)
^9.22A^7^7
"KRN",9.2,400,2,1,0)
QUERY^XM-U-M-QUERY DETAILED
"KRN",9.2,400,2,2,0)
CONFIDENTIAL^XM-U-M-CONFIDENTIAL
"KRN",9.2,400,2,3,0)
SCRAMBLED^XM-U-M-SCRAMBLE
"KRN",9.2,400,2,4,0)
ASSUME^XM-U-I-SURROGATE BECOME
"KRN",9.2,400,2,5,0)
REPLIED^XM-U-M-REPLY
"KRN",9.2,400,2,6,0)
READ^XM-U-P-SURROGATE READ PRIV
"KRN",9.2,400,2,7,0)
WRITE^XM-U-P-SURROGATE WRITE PRIV
"KRN",9.2,401,-1)
0^87
"KRN",9.2,401,0)
XM-U-H-Q INTERRUPT^INTERRUPTED MESSAGES^2990120.1135^^
"KRN",9.2,401,1,0)
^^15^15^2990120^^
"KRN",9.2,401,1,1,0)
 
"KRN",9.2,401,1,2,0)
Can a message be saved temporarily after an interruption?
"KRN",9.2,401,1,3,0)
 
"KRN",9.2,401,1,4,0)
Yes. If you are in the middle of entering a message, and you receive a
"KRN",9.2,401,1,5,0)
phone call or some other interruption, it is often useful to transmit the
"KRN",9.2,401,1,6,0)
incomplete message to yourself. You can later return to that same message
"KRN",9.2,401,1,7,0)
through the [READ]/Manage Messages option, and complete the message using
"KRN",9.2,401,1,8,0)
the [EDIT] action. You can then [FORWARD] the message to the original
"KRN",9.2,401,1,9,0)
intended recipients.
"KRN",9.2,401,1,10,0)
 
"KRN",9.2,401,1,11,0)
Also, if you are disconnected in the middle of entering a message or
"KRN",9.2,401,1,12,0)
reply, the system will attempt to save your text in a message buffer. The
"KRN",9.2,401,1,13,0)
next time you signon, Mailman will notify you that you have an unsent
"KRN",9.2,401,1,14,0)
message or response in your buffer. You may return to complete the message
"KRN",9.2,401,1,15,0)
or response.
"KRN",9.2,401,2,0)
^9.22A^3^3
"KRN",9.2,401,2,1,0)
EDIT^XM-U-MO-EDIT
"KRN",9.2,401,2,2,0)
FORWARD^XM-U-M-FORWARD
"KRN",9.2,401,2,3,0)
READ^XM-U-R-READ
"KRN",9.2,417,-1)
0^189
"KRN",9.2,417,0)
XM-U-NEW FEATURES^NEW FEATURES AND FUNCTIONALITY^3020509.0854^^
"KRN",9.2,417,1,0)
^9.21^25^25^3020509^^^^
"KRN",9.2,417,1,1,0)
 
"KRN",9.2,417,1,2,0)
MailMan 8.0 offers you the following improvements over MailMan 7.1:
"KRN",9.2,417,1,3,0)

"KRN",9.2,417,1,4,0)
1. MailMan date/times are now in a standard format, produced by a Kernel
"KRN",9.2,417,1,5,0)
API.  For example, what used to be displayed as '03 Aug 02 15:32'  is now
"KRN",9.2,417,1,6,0)
displayed as '08/03/02@15:32'.
"KRN",9.2,417,1,7,0)

"KRN",9.2,417,1,8,0)
2. MailMan no longer displays user names by taking them directly from the
"KRN",9.2,417,1,9,0)
.01 field of the NEW PERSON file.  An API supplied as part of the Name
"KRN",9.2,417,1,10,0)
Standardization project, is used, instead. Thus, the names of people whose
"KRN",9.2,417,1,11,0)
last names, for instance, contain periods, apostrophes, or spaces, are
"KRN",9.2,417,1,12,0)
properly displayed (ST. IVES, O'MALLEY, and VAN DYKE), instead of
"KRN",9.2,417,1,13,0)
improperly (STIVES, OMALLEY, and VANDYKE). 
"KRN",9.2,417,1,14,0)

"KRN",9.2,417,1,15,0)
3. Messages with responses may no longer be forwarded to broadcast to all
"KRN",9.2,417,1,16,0)
users.  Such messages may have important information in the responses, and
"KRN",9.2,417,1,17,0)
as we all know, responses are not auto- forwarded to remote sites for users
"KRN",9.2,417,1,18,0)
with auto-forward addresses.  Users who attempt to broadcast messages with
"KRN",9.2,417,1,19,0)
responses will be encouraged to copy the message and its responses into a
"KRN",9.2,417,1,20,0)
new message, which can be broadcast. 
"KRN",9.2,417,1,21,0)

"KRN",9.2,417,1,22,0)
4. You can now send, forward, or filter-forward messages to H.device
"KRN",9.2,417,1,23,0)
(Headerless print).  It will print the message, without a header, on the
"KRN",9.2,417,1,24,0)
device.  As before, sending messages to D.device will print them with
"KRN",9.2,417,1,25,0)
a header.
"KRN",9.2,417,2,0)
^9.22A^^0
"KRN",9.2,419,-1)
0^198
"KRN",9.2,419,0)
XM-U-P-FILTER^FILTERING MAIL^3000515.1321^^
"KRN",9.2,419,1,0)
^9.21^16^16^3000515^^^
"KRN",9.2,419,1,1,0)
 
"KRN",9.2,419,1,2,0)
You can filter your mail! MailMan can use message filters, created by you,
"KRN",9.2,419,1,3,0)
to assist you with organizing your mail.
"KRN",9.2,419,1,4,0)
 
"KRN",9.2,419,1,5,0)
You can think of MailMan and message filters performing the duties of an
"KRN",9.2,419,1,6,0)
'executive assistant,' such as sorting through all of the incoming mail
"KRN",9.2,419,1,7,0)
before it reaches your 'desk.' These filters screen and categorize your
"KRN",9.2,419,1,8,0)
mail, directing it to mail baskets you specify based on certain
"KRN",9.2,419,1,9,0)
[CRITERIA]. (You can even direct 'junk mail' right to the 'WASTE' basket!)
"KRN",9.2,419,1,10,0)
Optionally, the filters can also take additional [ACTIONS] on your messages
"KRN",9.2,419,1,11,0)
during message delivery.
"KRN",9.2,419,1,12,0)
 
"KRN",9.2,419,1,13,0)
The MailMan interface provides the Message Filter Edit option located on
"KRN",9.2,419,1,14,0)
the Personal Preferences menu to create and edit message filters.
"KRN",9.2,419,1,15,0)
 
"KRN",9.2,419,1,16,0)
[MORE]...
"KRN",9.2,419,2,0)
^9.22A^7^3
"KRN",9.2,419,2,5,0)
MORE^XM-U-P-FILTER-2
"KRN",9.2,419,2,6,0)
CRITERIA^XM-U-P-FILTER CRITERIA
"KRN",9.2,419,2,7,0)
ACTIONS^XM-U-P-FILTER ACTIONS
"KRN",9.2,420,-1)
0^218
"KRN",9.2,420,0)
XM-U-P-OPTIONS^PERSONAL PREFERENCES^3000726.0625^^
"KRN",9.2,420,1,0)
^9.21^19^19^3000726^^^^
"KRN",9.2,420,1,1,0)
 
"KRN",9.2,420,1,2,0)
The User Options Edit option on the Personal Preferences menu allows you
"KRN",9.2,420,1,3,0)
to customize the MailMan interface to suit your needs. You can choose
"KRN",9.2,420,1,4,0)
from the following options:
"KRN",9.2,420,1,5,0)
 
"KRN",9.2,420,1,6,0)
  * [BANNER] - Create or edit your banner. (You can also use the Banner
"KRN",9.2,420,1,7,0)
    Edit option on the Personal Preferences menu to do the same thing.)
"KRN",9.2,420,1,8,0)
 
"KRN",9.2,420,1,9,0)
  * MESSAGE [ORDER] - Choose the order in which your messages are
"KRN",9.2,420,1,10,0)
    displayed (i.e., newest or oldest messages first).
"KRN",9.2,420,1,11,0)
 
"KRN",9.2,420,1,12,0)
  * [NEW] MESSAGES READ ORDER - Choose the order in which you want to read
"KRN",9.2,420,1,13,0)
    your new messages (i.e., newest or oldest messages first).
"KRN",9.2,420,1,14,0)
 
"KRN",9.2,420,1,15,0)
  * MESSAGE [READER] - Choose how you display your messages when using
"KRN",9.2,420,1,16,0)
    the Read/Manage Messages option (i.e., Classic, Summary Full Screen,
"KRN",9.2,420,1,17,0)
    or Detailed Full Screen.
"KRN",9.2,420,1,18,0)
 
"KRN",9.2,420,1,19,0)
[MORE]...
"KRN",9.2,420,2,0)
^9.22A^18^5
"KRN",9.2,420,2,1,0)
BANNER^XM-U-P-BANNER
"KRN",9.2,420,2,2,0)
ORDER^XM-U-P-MESSAGE ORDER
"KRN",9.2,420,2,16,0)
MORE^XM-U-P-OPTIONS-2
"KRN",9.2,420,2,17,0)
READER^XM-U-B-READER
"KRN",9.2,420,2,18,0)
NEW^XM-U-P-NEW MESSAGES READ ORDER
"KRN",9.2,423,-1)
0^58
"KRN",9.2,423,0)
XM-U-B-FILTER^FILTERING MESSAGES - BASKET ACTION^2990114.094^^
"KRN",9.2,423,1,0)
^^20^20^2990201^
"KRN",9.2,423,1,1,0)
 
"KRN",9.2,423,1,2,0)
MailMan allows you to [FILTER] your mail. You can create any number of
"KRN",9.2,423,1,3,0)
filters to automatically send your mail to any specified mail basket in
"KRN",9.2,423,1,4,0)
your mailbox based on various filtering [CRITERIA].
"KRN",9.2,423,1,5,0)
 
"KRN",9.2,423,1,6,0)
Sometimes, when managing mail in your mail baskets, you may find old
"KRN",9.2,423,1,7,0)
messages that came into your mailbox prior to your creation of mail
"KRN",9.2,423,1,8,0)
filters. Thus, you can use the Filter messages action code (i.e., 'FI')
"KRN",9.2,423,1,9,0)
to filter these 'old' messages and move them to the proper mail basket
"KRN",9.2,423,1,10,0)
(determined by your mail filters).
"KRN",9.2,423,1,11,0)
 
"KRN",9.2,423,1,12,0)
To filter messages in a basket, enter an 'FI' at the basket option or
"KRN",9.2,423,1,13,0)
command prompt.
"KRN",9.2,423,1,14,0)
 
"KRN",9.2,423,1,15,0)
  * MailMan will first ask you to select which messages you want to
"KRN",9.2,423,1,16,0)
    filter, including a [RANGE] of messages. Also, if you are using a
"KRN",9.2,423,1,17,0)
    full-screen reader, you can pre-[SELECT] messages and then filter them
"KRN",9.2,423,1,18,0)
    as a group.
"KRN",9.2,423,1,19,0)
 
"KRN",9.2,423,1,20,0)
  * MailMan will then filter the messages.  
"KRN",9.2,423,2,0)
^9.22^7^4
"KRN",9.2,423,2,1,0)
FILTER^XM-U-P-FILTER
"KRN",9.2,423,2,5,0)
CRITERIA^XM-U-P-FILTER CRITERIA
"KRN",9.2,423,2,6,0)
RANGE^XM-U-M-CHOOSE RANGE
"KRN",9.2,423,2,7,0)
SELECT^XM-U-M-CHOOSE SELECT
"KRN",9.2,424,-1)
0^202
"KRN",9.2,424,0)
XM-U-P-FILTER ORDER^FILTERING MAIL - ORDER FIELD^2981210.091047^
"KRN",9.2,424,1,0)
^^8^8^2990427^
"KRN",9.2,424,1,1,0)
 
"KRN",9.2,424,1,2,0)
A message may match several filters, depending on the conditions
"KRN",9.2,424,1,3,0)
(filtering criteria) you have set. The ORDER field is used to determine in
"KRN",9.2,424,1,4,0)
which order filters will be checked. It is here that you specify relative
"KRN",9.2,424,1,5,0)
filter priority. The value entered must be a whole number between 1 and
"KRN",9.2,424,1,6,0)
999 (no decimal digits). All filters are checked in numeric order. If
"KRN",9.2,424,1,7,0)
several filters have the same number, then the first one you entered
"KRN",9.2,424,1,8,0)
receives priority.
"KRN",9.2,424,2,0)
^9.22A^0^0
"KRN",9.2,425,-1)
0^196
"KRN",9.2,425,0)
XM-U-P-DELIVERY BASKET PRIV^DELIVERY BASKET PRIVILEGES^2981210.102542^
"KRN",9.2,425,1,0)
^^48^48^2981230^^
"KRN",9.2,425,1,1,0)
 
"KRN",9.2,425,1,2,0)
Senders of mail messages can specify or target the mail basket into which
"KRN",9.2,425,1,3,0)
a message should be delivered for all recipients. Recipients of such
"KRN",9.2,425,1,4,0)
messages can decide whether to accept or reject delivery to any targeted
"KRN",9.2,425,1,5,0)
basket by setting up their delivery privileges beforehand.
"KRN",9.2,425,1,6,0)
 
"KRN",9.2,425,1,7,0)
To set up your mail delivery privileges, use the Delivery Basket Edit
"KRN",9.2,425,1,8,0)
option on the Personal Preferences menu.
"KRN",9.2,425,1,9,0)
 
"KRN",9.2,425,1,10,0)
The Delivery Basket Edit option allows you to customize the way you
"KRN",9.2,425,1,11,0)
receive messages from other MailMan users who have targeted messages for
"KRN",9.2,425,1,12,0)
delivery to specific baskets. With this option you can, for example,
"KRN",9.2,425,1,13,0)
permit other MailMan users to direct mail to a specific mail basket in
"KRN",9.2,425,1,14,0)
your mailbox and/or create new baskets for you automatically.
"KRN",9.2,425,1,15,0)
 
"KRN",9.2,425,1,16,0)
Specifically, you can choose to do any of the following:
"KRN",9.2,425,1,17,0)
 
"KRN",9.2,425,1,18,0)
  * YES, ACCEPT IT - Choose this response if you will accept the mail in
"KRN",9.2,425,1,19,0)
    whatever mail basket is specified by the sender. If the mail basket
"KRN",9.2,425,1,20,0)
    specified does not already exist, it will automatically be created in
"KRN",9.2,425,1,21,0)
    your mailbox and the message will be delivered to this new mail
"KRN",9.2,425,1,22,0)
    basket. This is the most permissive setting.
"KRN",9.2,425,1,23,0)
 
"KRN",9.2,425,1,24,0)
  * NO, DON'T ACCEPT IT (default) - Choose this response if you will not
"KRN",9.2,425,1,25,0)
    accept the mail in the mail basket specified by the sender. Thus,
"KRN",9.2,425,1,26,0)
    regardless of what the sender specifies, the mail will be delivered as
"KRN",9.2,425,1,27,0)
    usual (i.e., to your 'IN' basket or, via your mail filters, to a
"KRN",9.2,425,1,28,0)
    different mail basket). With this default setting, no new mail baskets
"KRN",9.2,425,1,29,0)
    can be created by others in your mailbox. This is the least permissive
"KRN",9.2,425,1,30,0)
    setting.
"KRN",9.2,425,1,31,0)
 
"KRN",9.2,425,1,32,0)
  * EXISTING BASKETS ONLY - Choose this response if you will accept the
"KRN",9.2,425,1,33,0)
    mail in the specified mail basket, only if that mail basket already
"KRN",9.2,425,1,34,0)
    exists in your mailbox. Otherwise, if the specified mail basket
"KRN",9.2,425,1,35,0)
    doesn't exist, the mail will be delivered as usual (i.e., to your 'IN'
"KRN",9.2,425,1,36,0)
    basket or, via your mail filters, to a different mail basket). With
"KRN",9.2,425,1,37,0)
    this setting, no new mail baskets can be created by others in your
"KRN",9.2,425,1,38,0)
    mailbox.
"KRN",9.2,425,1,39,0)
 
"KRN",9.2,425,1,40,0)
  * SELECTED BASKETS ONLY - Choose this response if you will accept the
"KRN",9.2,425,1,41,0)
    mail in the specified mail basket, only if that mail basket already
"KRN",9.2,425,1,42,0)
    exists in your mailbox and you have specified that the basket will
"KRN",9.2,425,1,43,0)
    accept such messages. These mail baskets are also specified through
"KRN",9.2,425,1,44,0)
    the Delivery Basket Edit option. Otherwise, if the specified mail
"KRN",9.2,425,1,45,0)
    basket doesn't exist or is not set to accept the mail, the mail will
"KRN",9.2,425,1,46,0)
    be delivered as usual (i.e., to your 'IN' basket or, via your mail
"KRN",9.2,425,1,47,0)
    filters, to a different mail basket). With this setting, no new mail
"KRN",9.2,425,1,48,0)
    baskets can be created by others in your mailbox.
"KRN",9.2,426,-1)
0^228
"KRN",9.2,426,0)
XM-U-P-READER DEFAULT^DEFAULT MESSAGE READER^2990113.1538^^
"KRN",9.2,426,1,0)
^^9^9^2990113^^^
"KRN",9.2,426,1,1,0)
 
"KRN",9.2,426,1,2,0)
To choose and set your message [READER] default, use the User Options Edit
"KRN",9.2,426,1,3,0)
option on the Personal Preferences menu. Press the Return key until you
"KRN",9.2,426,1,4,0)
reach the 'MESSAGE READER:' prompt. You can choose from the Classic,
"KRN",9.2,426,1,5,0)
Summary Full Screen, or Detailed Full Screen message readers.
"KRN",9.2,426,1,6,0)
 
"KRN",9.2,426,1,7,0)
Once you have decided on a message reader, you can specify whether the
"KRN",9.2,426,1,8,0)
reader you just chose should be used all the time or whether you want to
"KRN",9.2,426,1,9,0)
be [PROMPTED] each time you use the Read/Manage Messages option.
"KRN",9.2,426,2,0)
^9.22A^2^2
"KRN",9.2,426,2,1,0)
READER^XM-U-B-READER
"KRN",9.2,426,2,2,0)
PROMPTED^XM-U-P-READER PROMPT
"KRN",9.2,427,-1)
0^213
"KRN",9.2,427,0)
XM-U-P-MESSAGE ORDER^MESSAGE LIST ORDER^3000726.0729^^
"KRN",9.2,427,1,0)
^9.21^21^21^3000726^^^^
"KRN",9.2,427,1,1,0)
 
"KRN",9.2,427,1,2,0)
MailMan allows you to choose the order in which your messages are displayed:
"KRN",9.2,427,1,3,0)

"KRN",9.2,427,1,4,0)
  1. Newest First - This means that your messages are displayed in reverse
"KRN",9.2,427,1,5,0)
     order (i.e., highest to lowest basket message sequence number order).
"KRN",9.2,427,1,6,0)
 
"KRN",9.2,427,1,7,0)
  2. Oldest First - This means that your messages are displayed in message
"KRN",9.2,427,1,8,0)
     number order (i.e., lowest to highest basket message sequence number
"KRN",9.2,427,1,9,0)
     order).
"KRN",9.2,427,1,10,0)
 
"KRN",9.2,427,1,11,0)
Generally, the basket message sequence number order will correspond to the
"KRN",9.2,427,1,12,0)
message date sent order with the following exceptions:
"KRN",9.2,427,1,13,0)

"KRN",9.2,427,1,14,0)
  * Messages not originally sent to you but forwarded to you at a later
"KRN",9.2,427,1,15,0)
    date.
"KRN",9.2,427,1,16,0)
 
"KRN",9.2,427,1,17,0)
  * Messages sent from another location via the network (e.g., messages
"KRN",9.2,427,1,18,0)
    from a different site, FORUM messages).
"KRN",9.2,427,1,19,0)
 
"KRN",9.2,427,1,20,0)
To set your message order, use the User Options Edit option on the
"KRN",9.2,427,1,21,0)
Personal Preferences menu to answer the 'MESSAGE ORDER?:' prompt.
"KRN",9.2,428,-1)
0^130
"KRN",9.2,428,0)
XM-U-M-DELIVERY BASKET SET^DELIVERY BASKET SET OPTION^2981210.10292^
"KRN",9.2,428,1,0)
^^17^17^2990427^
"KRN",9.2,428,1,1,0)
 
"KRN",9.2,428,1,2,0)
You can use the Delivery Basket Set action code (i.e., 'D') to specify the
"KRN",9.2,428,1,3,0)
intended delivery mail basket for all recipients of the message you are
"KRN",9.2,428,1,4,0)
sending. Depending on how each recipient has set their delivery basket
"KRN",9.2,428,1,5,0)
[PRIVILEGES] using the Delivery Basket Edit option on the Personal
"KRN",9.2,428,1,6,0)
Preferences menu, the message may or may not be delivered to the intended
"KRN",9.2,428,1,7,0)
basket set by you. However, the message will still be delivered to each
"KRN",9.2,428,1,8,0)
recipient's mailbox. The delivery basket specified remains in effect, even
"KRN",9.2,428,1,9,0)
if a recipient forwards the message to another MailMan user.
"KRN",9.2,428,1,10,0)
 
"KRN",9.2,428,1,11,0)
Setting a delivery basket overrides any filters created by a recipient of
"KRN",9.2,428,1,12,0)
the message. Also, if allowed by a recipient and the mail basket specified
"KRN",9.2,428,1,13,0)
does not already exist, MailMan will create the new delivery mail basket
"KRN",9.2,428,1,14,0)
for that recipient.
"KRN",9.2,428,1,15,0)
 
"KRN",9.2,428,1,16,0)
To set the delivery basket for a message, enter a 'D' at the 'Select
"KRN",9.2,428,1,17,0)
Message option:  Transmit now//' prompt.
"KRN",9.2,428,2,0)
^9.22A^1^1
"KRN",9.2,428,2,1,0)
PRIVILEGES^XM-U-P-DELIVERY BASKET PRIV
"KRN",9.2,429,-1)
0^176
"KRN",9.2,429,0)
XM-U-M-TRANSMIT LATER^SEND A MESSAGE LATER (DEFER)^2981210.103003^
"KRN",9.2,429,1,0)
^^9^9^2981230^^
"KRN",9.2,429,1,1,0)
 
"KRN",9.2,429,1,2,0)
You can use the Transmit Later action code (i.e., 'L') to send a message
"KRN",9.2,429,1,3,0)
to all recipients at a later specified date and time (up to one year).
"KRN",9.2,429,1,4,0)
This action code uses TaskMan to schedule the delivery of the 'latered' or
"KRN",9.2,429,1,5,0)
deferred message. You would use this action code after you've taken all
"KRN",9.2,429,1,6,0)
other actions on your message.
"KRN",9.2,429,1,7,0)
 
"KRN",9.2,429,1,8,0)
To send a message at a later date and time, enter an 'L' at the 'Select
"KRN",9.2,429,1,9,0)
Message option:  Transmit now//' prompt.
"KRN",9.2,429,2,0)
^9.22A^0^0
"KRN",9.2,430,-1)
0^51
"KRN",9.2,430,0)
XM-U-A-STAGGER DELIVERY^STAGGER DELIVERY OF A MESSAGE^2990114.1321^^
"KRN",9.2,430,1,0)
^^20^20^2990114^^^^
"KRN",9.2,430,1,1,0)
 
"KRN",9.2,430,1,2,0)
When addressing a message at the 'send to:' prompt, the 'L:xxx' prefix code
"KRN",9.2,430,1,3,0)
(where 'xxx' represents the addressee's name), allows you to individually enter
"KRN",9.2,430,1,4,0)
a specific delivery date and time (from at least five minutes into the future
"KRN",9.2,430,1,5,0)
up to one month) for each addressee of a message. You can use this prefix code
"KRN",9.2,430,1,6,0)
in conjunction with either the [TRANSMIT NOW] (send the message now) or the
"KRN",9.2,430,1,7,0)
[DEFERRED SEND] (send the message later) action codes. 
"KRN",9.2,430,1,8,0)

"KRN",9.2,430,1,9,0)
For example, if you want a few recipients from the list of the recipients
"KRN",9.2,430,1,10,0)
of your message to receive the message at a much later date and time, you
"KRN",9.2,430,1,11,0)
could first use the staggered delivery function to specify the later
"KRN",9.2,430,1,12,0)
delivery date and time for those specific recipients and then send the
"KRN",9.2,430,1,13,0)
message using either the TRANSMIT NOW or DEFERRED SEND action codes.
"KRN",9.2,430,1,14,0)
 
"KRN",9.2,430,1,15,0)
After the message with staggered delivery dates and times has been sent, and
"KRN",9.2,430,1,16,0)
before it has been delivered to the staggered recipients, doing a [QUERY] (Q)
"KRN",9.2,430,1,17,0)
on the message will show the intended delivery dates and times for those
"KRN",9.2,430,1,18,0)
recipients. 
"KRN",9.2,430,1,19,0)
 
"KRN",9.2,430,1,20,0)
[MORE]... 
"KRN",9.2,430,2,0)
^9.22A^4^4
"KRN",9.2,430,2,1,0)
QUERY^XM-U-M-QUERY GENERAL
"KRN",9.2,430,2,2,0)
DEFERRED SEND^XM-U-M-TRANSMIT LATER
"KRN",9.2,430,2,3,0)
TRANSMIT NOW^XM-U-M-TRANSMIT NOW
"KRN",9.2,430,2,4,0)
MORE^XM-U-A-STAGGER DELIVERY-2
"KRN",9.2,434,-1)
0^54
"KRN",9.2,434,0)
XM-U-B-BASKET NAME^NAMING BASKETS^2981210.105815^^
"KRN",9.2,434,1,0)
^^10^10^2981231^^^
"KRN",9.2,434,1,1,0)
 
"KRN",9.2,434,1,2,0)
MailMan allows you to give your mail baskets names starting with
"KRN",9.2,434,1,3,0)
alphabetic characters, symbols, or numbers and when you list your baskets,
"KRN",9.2,434,1,4,0)
they will be in alphabetical order (those baskets beginning with numbers
"KRN",9.2,434,1,5,0)
or symbols will be listed first). Mail basket names can be from 2 to 30
"KRN",9.2,434,1,6,0)
characters in length.
"KRN",9.2,434,1,7,0)
 
"KRN",9.2,434,1,8,0)
When you wish to choose a mail basket by its basket number (e.g., '.5' for
"KRN",9.2,434,1,9,0)
the 'WASTE' basket), you must now precede the mail basket number with a
"KRN",9.2,434,1,10,0)
grave accent mark or back tick (`).
"KRN",9.2,445,-1)
0^212
"KRN",9.2,445,0)
XM-U-P-MESSAGE ACTION DEFAULT^MESSAGE ACTION DEFAULT^3020507.072^^
"KRN",9.2,445,1,0)
^9.21^19^19^3020507^^^
"KRN",9.2,445,1,1,0)
 
"KRN",9.2,445,1,2,0)
MailMan allows you to decide the default response after reading a message
"KRN",9.2,445,1,3,0)
in your 'IN' mail basket via the 'MESSAGE ACTION DEFAULT:' prompt.
"KRN",9.2,445,1,4,0)
Whatever you enter into this field will control the default for the 'Enter
"KRN",9.2,445,1,5,0)
message option' prompt that you answer after reading each MailMan message
"KRN",9.2,445,1,6,0)
in your 'IN' mail basket.
"KRN",9.2,445,1,7,0)
 
"KRN",9.2,445,1,8,0)
There are two possible responses:
"KRN",9.2,445,1,9,0)
 
"KRN",9.2,445,1,10,0)
  1. Ignore (default) - Leaves the message in the same MailMan basket.
"KRN",9.2,445,1,11,0)
 
"KRN",9.2,445,1,12,0)
  2. Delete - Moves the message to your MailMan 'WASTE' basket.
"KRN",9.2,445,1,13,0)
 
"KRN",9.2,445,1,14,0)
If you do not enter anything in this field, the default will be whatever
"KRN",9.2,445,1,15,0)
IRM has set for your site in the [MAILMAN SITE PARAMETERS] file (#4.3). If
"KRN",9.2,445,1,16,0)
IRM has not set a value, the default will be 'Ignore.'
"KRN",9.2,445,1,17,0)
 
"KRN",9.2,445,1,18,0)
The 'MESSAGE ACTION DEFAULT:' can be set through the User Options Edit
"KRN",9.2,445,1,19,0)
option on the Personal Preferences menu.
"KRN",9.2,445,2,0)
^9.22A^1^1
"KRN",9.2,445,2,1,0)
MAILMAN SITE PARAMETERS^XM-I-S-SITE PARAMETERS-USER
"KRN",9.2,446,-1)
0^231
"KRN",9.2,446,0)
XM-U-P-SHOW TITLES^SHOW TITLES^3020507.0731^
"KRN",9.2,446,1,0)
^9.21^17^17^3020507^^
"KRN",9.2,446,1,1,0)
 
"KRN",9.2,446,1,2,0)
MailMan allows you to decide if you want a message sender's title to be
"KRN",9.2,446,1,3,0)
displayed in the message header. If you elect to show titles, they will be
"KRN",9.2,446,1,4,0)
preceded by a hyphen (i.e., generated by MailMan) and appear after the
"KRN",9.2,446,1,5,0)
sender's name in the 'From' portion of the message header.
"KRN",9.2,446,1,6,0)
 
"KRN",9.2,446,1,7,0)
There are two possible responses to this question:
"KRN",9.2,446,1,8,0)
 
"KRN",9.2,446,1,9,0)
  * Yes - Display a sender's title in the message header.
"KRN",9.2,446,1,10,0)
 
"KRN",9.2,446,1,11,0)
  * No (default) - Do not display a sender's title in the message header.
"KRN",9.2,446,1,12,0)
 
"KRN",9.2,446,1,13,0)
If you do not set this field, the sender's title will not appear in the
"KRN",9.2,446,1,14,0)
message header.
"KRN",9.2,446,1,15,0)
 
"KRN",9.2,446,1,16,0)
The 'SHOW TITLES:' field can be set through the User Options Edit option
"KRN",9.2,446,1,17,0)
on the Personal Preferences menu.
"KRN",9.2,447,-1)
0^224
"KRN",9.2,447,0)
XM-U-P-PRIORITY FLAG^PRIORITY RESPONSES FLAG^2981211.104425^
"KRN",9.2,447,1,0)
^^20^20^2990107^
"KRN",9.2,447,1,1,0)
 
"KRN",9.2,447,1,2,0)
The PRIORITY RESPONSES FLAG field works in conjunction with the PRIORITY
"KRN",9.2,447,1,3,0)
RESPONSES [PROMPT] field. Both of these fields can be set through the User
"KRN",9.2,447,1,4,0)
Options Edit option available on the Personal Preferences menu.
"KRN",9.2,447,1,5,0)
 
"KRN",9.2,447,1,6,0)
MailMan allows you to decide whether or not you want to have responses to
"KRN",9.2,447,1,7,0)
priority mail delivered to you as priority or ordinary responses. Setting
"KRN",9.2,447,1,8,0)
the PRIORITY RESPONSES FLAG field allows you to choose what your default
"KRN",9.2,447,1,9,0)
should be.
"KRN",9.2,447,1,10,0)
 
"KRN",9.2,447,1,11,0)
There are two possible values from which to choose when answering the
"KRN",9.2,447,1,12,0)
'PRIORITY RESPONSES FLAG:' question:
"KRN",9.2,447,1,13,0)
 
"KRN",9.2,447,1,14,0)
  * 0, Responses are PRIORITY (default) - Responses to priority mail will
"KRN",9.2,447,1,15,0)
    be delivered to you as priority responses.
"KRN",9.2,447,1,16,0)
 
"KRN",9.2,447,1,17,0)
  * 1, Responses are ORDINARY - Responses to priority mail will be
"KRN",9.2,447,1,18,0)
    delivered to you as ordinary responses.
"KRN",9.2,447,1,19,0)
 
"KRN",9.2,447,1,20,0)
If you do not set this field, then responses will be priority. 
"KRN",9.2,447,2,0)
^9.22A^1^1
"KRN",9.2,447,2,1,0)
PROMPT^XM-U-P-PRIORITY PROMPT
"KRN",9.2,448,-1)
0^225
"KRN",9.2,448,0)
XM-U-P-PRIORITY PROMPT^PRIORITY RESPONSES PROMPT^2981211.104506^
"KRN",9.2,448,1,0)
^^17^17^2990107^
"KRN",9.2,448,1,1,0)
 
"KRN",9.2,448,1,2,0)
The PRIORITY RESPONSES PROMPT field works in conjunction with the PRIORITY
"KRN",9.2,448,1,3,0)
RESPONSES [FLAG] field. Both of these fields can be set through the User
"KRN",9.2,448,1,4,0)
Options Edit option available on the Personal Preferences menu.
"KRN",9.2,448,1,5,0)
 
"KRN",9.2,448,1,6,0)
MailMan allows you to decide whether or not you will be prompted to choose
"KRN",9.2,448,1,7,0)
to have future responses to an individual priority message delivered to
"KRN",9.2,448,1,8,0)
you as priority or ordinary mail. The answer you give here determines
"KRN",9.2,448,1,9,0)
whether or not MailMan will ask you to choose each time a priority message
"KRN",9.2,448,1,10,0)
is delivered. Setting the PRIORITY RESPONSES PROMPT field allows you to
"KRN",9.2,448,1,11,0)
choose what your default will be.
"KRN",9.2,448,1,12,0)
 
"KRN",9.2,448,1,13,0)
This prompt allows you to determine on a message-by-message basis whether
"KRN",9.2,448,1,14,0)
or not MailMan will deliver responses to a priority message as priority
"KRN",9.2,448,1,15,0)
mail, regardless of what the default is for the PRIORITY RESPONSES [FLAG].
"KRN",9.2,448,1,16,0)
    
"KRN",9.2,448,1,17,0)
[MORE]... 
"KRN",9.2,448,2,0)
^9.22A^3^2
"KRN",9.2,448,2,2,0)
MORE^XM-U-P-PRIORITY PROMPT-2
"KRN",9.2,448,2,3,0)
FLAG^XM-U-P-PRIORITY FLAG
"KRN",9.2,449,-1)
0^210
"KRN",9.2,449,0)
XM-U-P-INSTITUTION^MAILMAN INSTITUTION^2981211.1047^
"KRN",9.2,449,1,0)
^^21^21^2990513^
"KRN",9.2,449,1,1,0)
 
"KRN",9.2,449,1,2,0)
The MailMan Institution is a piece of information that helps identify you
"KRN",9.2,449,1,3,0)
to other MailMan users. It is usually the office or site where you are
"KRN",9.2,449,1,4,0)
located (i.e., your physical location) and is most useful in systems such
"KRN",9.2,449,1,5,0)
as FORUM where people from many different sites interact.
"KRN",9.2,449,1,6,0)
 
"KRN",9.2,449,1,7,0)
MailMan allows you to enter your own MailMan Institution that will be
"KRN",9.2,449,1,8,0)
displayed to other users. You are not required to enter a MailMan
"KRN",9.2,449,1,9,0)
Institution on local mail. However, on FORUM, it is a policy that every
"KRN",9.2,449,1,10,0)
user must enter a MailMan Institution to better identify themselves.
"KRN",9.2,449,1,11,0)
 
"KRN",9.2,449,1,12,0)
Your MailMan Institution is displayed to others when they receive messages
"KRN",9.2,449,1,13,0)
from you. It is shown in parentheses following your name and title in the
"KRN",9.2,449,1,14,0)
heading of every local message or response that you send.
"KRN",9.2,449,1,15,0)
 
"KRN",9.2,449,1,16,0)
The MailMan Institution can range from 3 to 30 characters in length and
"KRN",9.2,449,1,17,0)
can contain any combination of numbers, alphabetic characters, symbols
"KRN",9.2,449,1,18,0)
(e.g., #, $, %, &, *), and punctuation marks.
"KRN",9.2,449,1,19,0)
 
"KRN",9.2,449,1,20,0)
The 'MAILMAN INSTITUTION:' field can be set through the User Options Edit
"KRN",9.2,449,1,21,0)
option on the Personal Preferences menu.
"KRN",9.2,450,-1)
0^214
"KRN",9.2,450,0)
XM-U-P-NETWORK SIGNATURE^NETWORK SIGNATURE^2981211.104903^
"KRN",9.2,450,1,0)
^9.21^16^16^3000509^^^
"KRN",9.2,450,1,1,0)
 
"KRN",9.2,450,1,2,0)
The Network Signature is a piece of information that helps identify you to
"KRN",9.2,450,1,3,0)
other MailMan users. It consists of three separate lines of information.
"KRN",9.2,450,1,4,0)
MailMan allows you to enter your own Network Signature. You must enter a
"KRN",9.2,450,1,5,0)
Network Signature in order to use the '[ANSWER]' command on a message.
"KRN",9.2,450,1,6,0)
 
"KRN",9.2,450,1,7,0)
Each of the three lines comprising the Network Signature can range from 3
"KRN",9.2,450,1,8,0)
to 70 characters in length and can contain any combination of numbers,
"KRN",9.2,450,1,9,0)
alphabetic characters, symbols (e.g., #, $, %, &, *), and punctuation
"KRN",9.2,450,1,10,0)
marks. In order to have a valid Network Signature recognized by MailMan,
"KRN",9.2,450,1,11,0)
you must enter data in at least one of the three Network Signature lines.
"KRN",9.2,450,1,12,0)
Any line of the three is acceptable as long as one line contains data.
"KRN",9.2,450,1,13,0)
 
"KRN",9.2,450,1,14,0)
The 'NETWORK SIGNATURE LINE n OF 3:' field (where n equals one, two, or
"KRN",9.2,450,1,15,0)
three) can be set through the User Options Edit option on the Personal
"KRN",9.2,450,1,16,0)
Preferences menu.
"KRN",9.2,450,2,0)
^9.22A^1^1
"KRN",9.2,450,2,1,0)
ANSWER^XM-U-M-ANSWER
"KRN",9.2,451,-1)
0^197
"KRN",9.2,451,0)
XM-U-P-EDITOR^PREFERRED EDITOR^2990120.1621^^
"KRN",9.2,451,1,0)
^^16^16^2990120^^^^
"KRN",9.2,451,1,1,0)
 
"KRN",9.2,451,1,2,0)
The Preferred Editor field provides you with the opportunity to choose the
"KRN",9.2,451,1,3,0)
editor you wish to use while in MailMan. You use an editor when editing a
"KRN",9.2,451,1,4,0)
VA FileMan word processing field (e.g., when you respond to or type a new
"KRN",9.2,451,1,5,0)
message). If you have chosen a Preferred Editor and you are editing a word
"KRN",9.2,451,1,6,0)
processing field, MailMan will automatically transfer you into your
"KRN",9.2,451,1,7,0)
Preferred Editor. If you don't enter a specific editor in the Preferred
"KRN",9.2,451,1,8,0)
Editor field, MailMan will default to either the VA FileMan [SCREEN] editor
"KRN",9.2,451,1,9,0)
when editing within ScreenMan or the VA FileMan [LINE] Editor in all other
"KRN",9.2,451,1,10,0)
cases.
"KRN",9.2,451,1,11,0)
 
"KRN",9.2,451,1,12,0)
Your choice of editors is based on the editors available at your particular
"KRN",9.2,451,1,13,0)
location. MailMan lets you choose from the list of available editors. 
"KRN",9.2,451,1,14,0)
 
"KRN",9.2,451,1,15,0)
The 'PREFERRED EDITOR:' field can be set through the User Options Edit option
"KRN",9.2,451,1,16,0)
on the Personal Preferences menu. 
"KRN",9.2,451,2,0)
^9.22^2^2
"KRN",9.2,451,2,1,0)
LINE^XM-U-I-EDITOR FM LINE
"KRN",9.2,451,2,2,0)
SCREEN^XM-U-I-EDITOR FM SCREEN
"KRN",9.2,452,-1)
0^217
"KRN",9.2,452,0)
XM-U-P-OFFICE INFO^CONTACT INFORMATION^3020507.0726^^
"KRN",9.2,452,1,0)
^9.21^43^43^3020507^^^^
"KRN",9.2,452,1,1,0)
 
"KRN",9.2,452,1,2,0)
Your contact information is comprised of the following fields, which
"KRN",9.2,452,1,3,0)
reside in the NEW PERSON file (#200):
"KRN",9.2,452,1,4,0)
 
"KRN",9.2,452,1,5,0)
  * STREET ADDRESS 1, 2, & 3 - These three fields are the 3 lines of the
"KRN",9.2,452,1,6,0)
    user's address.
"KRN",9.2,452,1,7,0)
 
"KRN",9.2,452,1,8,0)
  * CITY - This is the user's city.
"KRN",9.2,452,1,9,0)
 
"KRN",9.2,452,1,10,0)
  * STATE - This is the user's state.
"KRN",9.2,452,1,11,0)
 
"KRN",9.2,452,1,12,0)
  * ZIP CODE - This is the user's postal ZIP code.
"KRN",9.2,452,1,13,0)
 
"KRN",9.2,452,1,14,0)
  * OFFICE PHONE - This is the user's business/office contact telephone.
"KRN",9.2,452,1,15,0)
 
"KRN",9.2,452,1,16,0)
  * FAX NUMBER - This field contains the telephone number for a user's FAX
"KRN",9.2,452,1,17,0)
    machine. It needs to be in a format that can be understood by a
"KRN",9.2,452,1,18,0)
    sending modem.
"KRN",9.2,452,1,19,0)
 
"KRN",9.2,452,1,20,0)
  * VOICE PAGER - This field contains the telephone number for a user's
"KRN",9.2,452,1,21,0)
    analog pager. It needs to be in a format that can be understood by a
"KRN",9.2,452,1,22,0)
    sending modem.
"KRN",9.2,452,1,23,0)
 
"KRN",9.2,452,1,24,0)
  * DIGITAL PAGER - This field contains the telephone number for a user's
"KRN",9.2,452,1,25,0)
    digital page. It needs to be a format that can be understood by a
"KRN",9.2,452,1,26,0)
    sending modem.
"KRN",9.2,452,1,27,0)
 
"KRN",9.2,452,1,28,0)
  * ADD'L PHONE 1 - This is an alternate (additional) telephone number
"KRN",9.2,452,1,29,0)
    where the user might also be reached.
"KRN",9.2,452,1,30,0)
 
"KRN",9.2,452,1,31,0)
  * ADD'L PHONE 2 - This is another alternate (additional) telephone
"KRN",9.2,452,1,32,0)
    number where the user might also be reached.
"KRN",9.2,452,1,33,0)
 
"KRN",9.2,452,1,34,0)
These fields are all self-explanatory. You can use these fields to store
"KRN",9.2,452,1,35,0)
your business (or personal) information. MailMan does not require you to
"KRN",9.2,452,1,36,0)
enter any information into these fields.
"KRN",9.2,452,1,37,0)
 
"KRN",9.2,452,1,38,0)
MailMan displays your contact information when users do a lookup on you
"KRN",9.2,452,1,39,0)
through the User Information option on the Help (User/Group Info., etc.)
"KRN",9.2,452,1,40,0)
menu.
"KRN",9.2,452,1,41,0)
 
"KRN",9.2,452,1,42,0)
The contact information fields can be set through the User Options Edit
"KRN",9.2,452,1,43,0)
option on the Personal Preferences menu.
"KRN",9.2,456,-1)
0^177
"KRN",9.2,456,0)
XM-U-M-TRANSMIT NOW^SEND A MESSAGE NOW ('Transmit Now')^2981214.135807^
"KRN",9.2,456,1,0)
^^14^14^2981230^^
"KRN",9.2,456,1,1,0)
 
"KRN",9.2,456,1,2,0)
You can use the Transmit Now action code (i.e., 'T') to have MailMan
"KRN",9.2,456,1,3,0)
send your message to all recipients. You would use this action code after
"KRN",9.2,456,1,4,0)
you've taken all other actions on your message.
"KRN",9.2,456,1,5,0)
 
"KRN",9.2,456,1,6,0)
To send a message now, enter a 'T' or press the Return/Enter key to accept
"KRN",9.2,456,1,7,0)
the 'Transmit now' default at the 'Select Message option:  Transmit now//'
"KRN",9.2,456,1,8,0)
prompt.
"KRN",9.2,456,1,9,0)
 
"KRN",9.2,456,1,10,0)
MailMan automatically gives the message an internal message identification
"KRN",9.2,456,1,11,0)
number and puts the message in the delivery queue to be delivered to the
"KRN",9.2,456,1,12,0)
recipients.
"KRN",9.2,456,1,13,0)
 
"KRN",9.2,456,1,14,0)
MailMan will then notify you that the message has been sent.
"KRN",9.2,457,-1)
0^340
"KRN",9.2,457,0)
XM-U-M-CLOSED^CLOSED MESSAGES^3020718.1353^
"KRN",9.2,457,1,0)
^9.21^10^10^3020718^^^
"KRN",9.2,457,1,1,0)
 
"KRN",9.2,457,1,2,0)
When you are sending a message, you can use the Closed Message action code
"KRN",9.2,457,1,3,0)
(i.e., 'X') to prevent recipients of your message from [FORWARDING] that
"KRN",9.2,457,1,4,0)
message on to other recipients not originally included in the recipient
"KRN",9.2,457,1,5,0)
list. (You, the sender, will still be able to forward the message.)
"KRN",9.2,457,1,6,0)
This is a toggle action code. If you enter 'X' again, the message will no
"KRN",9.2,457,1,7,0)
longer be closed.
"KRN",9.2,457,1,8,0)
 
"KRN",9.2,457,1,9,0)
To make a message 'closed,' enter an 'X' at the 'Select Message option:
"KRN",9.2,457,1,10,0)
Transmit now//' prompt.
"KRN",9.2,457,2,0)
^9.22A^1^1
"KRN",9.2,457,2,1,0)
FORWARDING^XM-U-M-FORWARD
"KRN",9.2,458,-1)
0^132
"KRN",9.2,458,0)
XM-U-M-EDIT SUBJECT^EDIT THE SUBJECT OF A MESSAGE^2991213.1335^^
"KRN",9.2,458,1,0)
^^13^13^2991213^^^^
"KRN",9.2,458,1,1,0)
 
"KRN",9.2,458,1,2,0)
You can use the Edit Subject action code (i.e., 'ES') to change the
"KRN",9.2,458,1,3,0)
subject text of a message you intend on sending.
"KRN",9.2,458,1,4,0)
 
"KRN",9.2,458,1,5,0)
The subject of the message is shown whenever the message is displayed. It
"KRN",9.2,458,1,6,0)
can be from 3 to 65 characters in length. Any leading and trailing blanks
"KRN",9.2,458,1,7,0)
are deleted. Also, any sequence of three or more blanks is reduced to two
"KRN",9.2,458,1,8,0)
blanks.
"KRN",9.2,458,1,9,0)
 
"KRN",9.2,458,1,10,0)
To edit the subject of a message prior to sending it, enter an 'ES' at the
"KRN",9.2,458,1,11,0)
'Select Message option:  Transmit now//' prompt or enter an 'E' at the
"KRN",9.2,458,1,12,0)
'Enter message option' prompt and then enter 'ES' at the 'Select Edit
"KRN",9.2,458,1,13,0)
option:' prompt.
"KRN",9.2,459,-1)
0^133
"KRN",9.2,459,0)
XM-U-M-EDIT TEXT^EDIT THE TEXT OF A MESSAGE^3000515.0934^^
"KRN",9.2,459,1,0)
^9.21^9^9^3000515^^^
"KRN",9.2,459,1,1,0)
 
"KRN",9.2,459,1,2,0)
You can use the Edit Text action code (i.e., 'ET') to change the text
"KRN",9.2,459,1,3,0)
(body) of the message you intend on sending. You can add to, modify, or
"KRN",9.2,459,1,4,0)
delete any part of the text within the body of the message.
"KRN",9.2,459,1,5,0)
 
"KRN",9.2,459,1,6,0)
To edit the text of a message prior to sending it, enter an 'ET' at the
"KRN",9.2,459,1,7,0)
'Select Message option:  Transmit now//' prompt or enter an 'E' at the
"KRN",9.2,459,1,8,0)
'Enter message option' prompt and then enter 'ET' at the 'Select Edit
"KRN",9.2,459,1,9,0)
option:' prompt.
"KRN",9.2,461,-1)
0^131
"KRN",9.2,461,0)
XM-U-M-EDIT RECIPIENTS^EDIT RECIPIENTS^2981215.1038^
"KRN",9.2,461,1,0)
^^10^10^2990427^
"KRN",9.2,461,1,1,0)
 
"KRN",9.2,461,1,2,0)
You can use the Edit Recipients action code (i.e., 'ER') to add or remove
"KRN",9.2,461,1,3,0)
recipients from a message you intend on sending. 
"KRN",9.2,461,1,4,0)
 
"KRN",9.2,461,1,5,0)
To edit the recipients of a message prior to sending it, enter an 'ER' at
"KRN",9.2,461,1,6,0)
the 'Select Message option:  Transmit now//' prompt.
"KRN",9.2,461,1,7,0)
 
"KRN",9.2,461,1,8,0)
For example, to remove a recipient, type a minus sign or hyphen (i.e.,
"KRN",9.2,461,1,9,0)
'-') followed by the first portion of the recipient's last name after the
"KRN",9.2,461,1,10,0)
'And Send to:' prompt. For example: '-SMITH,JOE'.
"KRN",9.2,462,-1)
0^68
"KRN",9.2,462,0)
XM-U-B-READER DIFF-2^BASKET ACTION CODES (CONTINUED)^2990319.1451^^
"KRN",9.2,462,1,0)
^^21^21^2990319^^^^
"KRN",9.2,462,1,1,0)

"KRN",9.2,462,1,2,0)
 ?string   Search for messages in the basket whose subject
"KRN",9.2,462,1,3,0)
           [CONTAINS] the string entered.
"KRN",9.2,462,1,4,0)
 ??string  Search for messages anywhere on the system, which you ever sent
"KRN",9.2,462,1,5,0)
           or received, whose subject [BEGINS WITH] the string entered.
"KRN",9.2,462,1,6,0)
 
"KRN",9.2,462,1,7,0)
The following are available only with the Full Screen message reader:
"KRN",9.2,462,1,8,0)
 
"KRN",9.2,462,1,9,0)
 [CD]       Change detail. (Toggle between summary and detailed display.)
"KRN",9.2,462,1,10,0)
 
"KRN",9.2,462,1,11,0)
For commands which act on one or more messages, you can [SELECT] the messages
"KRN",9.2,462,1,12,0)
prior to entering the command, or specify a [RANGE] of messages after entering
"KRN",9.2,462,1,13,0)
the command. If you select messages, additional commands become available: 
"KRN",9.2,462,1,14,0)
 
"KRN",9.2,462,1,15,0)
 [O]        Opposite selection toggle.
"KRN",9.2,462,1,16,0)
 [Z]        Zoom toggle.
"KRN",9.2,462,1,17,0)
 
"KRN",9.2,462,1,18,0)
When you have a basket with a long list of messages, you can [NAVIGATE] about
"KRN",9.2,462,1,19,0)
the basket by paging through the messages.
"KRN",9.2,462,1,20,0)
 
"KRN",9.2,462,1,21,0)
 [MORE]...
"KRN",9.2,462,2,0)
^9.22^22^9
"KRN",9.2,462,2,4,0)
Z^XM-U-B-ZOOM TOGGLE
"KRN",9.2,462,2,5,0)
O^XM-U-B-OPPOSITE TOGGLE
"KRN",9.2,462,2,13,0)
MORE^XM-U-B-READER DIFF-3
"KRN",9.2,462,2,15,0)
CD^XM-U-B-CHANGE DETAIL
"KRN",9.2,462,2,16,0)
NAVIGATE^XM-U-B-NAVIGATE FULL SCREEN
"KRN",9.2,462,2,18,0)
RANGE^XM-U-M-CHOOSE RANGE
"KRN",9.2,462,2,19,0)
SELECT^XM-U-M-CHOOSE SELECT
"KRN",9.2,462,2,21,0)
BEGINS WITH^XM-U-Q-CLASSIC LOOKUP ??
"KRN",9.2,462,2,22,0)
CONTAINS^XM-U-Q-CLASSIC LOOKUP ?
"KRN",9.2,463,-1)
0^75
"KRN",9.2,463,0)
XM-U-B-ZOOM TOGGLE^ZOOM SELECTION TOGGLE^2981215.143519^
"KRN",9.2,463,1,0)
^^14^14^2981230^^
"KRN",9.2,463,1,1,0)
 
"KRN",9.2,463,1,2,0)
The Zoom Selection Toggle is used to 'zoom' in on a group of messages that
"KRN",9.2,463,1,3,0)
have been selected for subsequent group action. Using this action code
"KRN",9.2,463,1,4,0)
allows you to just display those selected messages and not the entire list
"KRN",9.2,463,1,5,0)
of messages in the mail basket. This can be useful when you have a long
"KRN",9.2,463,1,6,0)
list of messages and have selected messages throughout the entire list.
"KRN",9.2,463,1,7,0)
 
"KRN",9.2,463,1,8,0)
In order to use the Zoom Selection Toggle, you must have first selected at
"KRN",9.2,463,1,9,0)
least one message in the list of messages. When you have selected a
"KRN",9.2,463,1,10,0)
message, a right-angle bracket ('>') is displayed to the left of the
"KRN",9.2,463,1,11,0)
selected message in the list.
"KRN",9.2,463,1,12,0)
 
"KRN",9.2,463,1,13,0)
To zoom in on just the selected messages (and zoom out again), you enter
"KRN",9.2,463,1,14,0)
'Z' after the 'Enter message number or command:' prompt.
"KRN",9.2,463,2,0)
^9.22A^0^0
"KRN",9.2,464,-1)
0^62
"KRN",9.2,464,0)
XM-U-B-OPPOSITE TOGGLE^OPPOSITE SELECTION TOGGLE^2981215.143927^
"KRN",9.2,464,1,0)
^^20^20^2981230^^
"KRN",9.2,464,1,1,0)
 
"KRN",9.2,464,1,2,0)
You can use the Opposite Selection Toggle action code (i.e., 'O') to
"KRN",9.2,464,1,3,0)
reverse or choose the opposite of your selected messages in a list of
"KRN",9.2,464,1,4,0)
messages that have been selected for subsequent group action. 
"KRN",9.2,464,1,5,0)
 
"KRN",9.2,464,1,6,0)
Using this action code allows you to simply select unselected
"KRN",9.2,464,1,7,0)
messages and deselect previously selected messages. This can be useful
"KRN",9.2,464,1,8,0)
when you have a long list of messages and the majority of the messages
"KRN",9.2,464,1,9,0)
will undergo the same action. It's easier to select a smaller group that
"KRN",9.2,464,1,10,0)
won't be changing, and then, using the Opposite Selection Toggle, to
"KRN",9.2,464,1,11,0)
reverse your selection and perform the action on the majority of the
"KRN",9.2,464,1,12,0)
opposite messages in the message list.
"KRN",9.2,464,1,13,0)
 
"KRN",9.2,464,1,14,0)
In order to use the Opposite Selection Toggle, you must have first
"KRN",9.2,464,1,15,0)
selected at least one message in the list of messages. When you have
"KRN",9.2,464,1,16,0)
successfully selected a message, a right-angle bracket ('>') is displayed
"KRN",9.2,464,1,17,0)
to the left of the selected message in the list.
"KRN",9.2,464,1,18,0)
 
"KRN",9.2,464,1,19,0)
To toggle from the selected messages to the unselected messages (and vice
"KRN",9.2,464,1,20,0)
versa), you enter 'O' after the 'Enter message number or command:' prompt.
"KRN",9.2,464,2,0)
^9.22A^0^0
"KRN",9.2,465,-1)
0^57
"KRN",9.2,465,0)
XM-U-B-CHANGE DETAIL^CHANGE DETAIL^2990114.1253^^
"KRN",9.2,465,1,0)
^^16^16^2990114^^^
"KRN",9.2,465,1,1,0)
 
"KRN",9.2,465,1,2,0)
When viewing a list of messages using either the Summary or Detailed Full
"KRN",9.2,465,1,3,0)
Screen message reader, you can use the Change Detail action code (i.e.,
"KRN",9.2,465,1,4,0)
'CD') to toggle between the [SUMMARY] and [DETAILED] Full Screen message
"KRN",9.2,465,1,5,0)
readers list of messages. Simply entering the Change Detail ('CD') command
"KRN",9.2,465,1,6,0)
at the 'Enter message number or command:' prompt causes the message reader
"KRN",9.2,465,1,7,0)
to toggle.
"KRN",9.2,465,1,8,0)
 
"KRN",9.2,465,1,9,0)
Depending on which message reader you've selected (i.e., Detailed or
"KRN",9.2,465,1,10,0)
Summary Full Screen), this command either removes several columns from the
"KRN",9.2,465,1,11,0)
display giving the remaining columns space to display more information in
"KRN",9.2,465,1,12,0)
a more streamlined fashion or adds several columns from the display giving
"KRN",9.2,465,1,13,0)
you more information about each message.
"KRN",9.2,465,1,14,0)
 
"KRN",9.2,465,1,15,0)
To change detail, enter a 'CD' after the 'Enter message number or
"KRN",9.2,465,1,16,0)
command:' prompt.
"KRN",9.2,465,2,0)
^9.22^2^2
"KRN",9.2,465,2,1,0)
DETAILED^XM-U-B-READER DETAILED
"KRN",9.2,465,2,2,0)
SUMMARY^XM-U-B-READER SUMMARY
"KRN",9.2,466,-1)
0^55
"KRN",9.2,466,0)
XM-U-B-BASKET NAME CHANGE^CHANGE A MAIL BASKET NAME^2990120.1229^^
"KRN",9.2,466,1,0)
^^8^8^2990120^^^
"KRN",9.2,466,1,1,0)
 
"KRN",9.2,466,1,2,0)
The Change Basket action code (i.e., 'C') allows you to rename the mail
"KRN",9.2,466,1,3,0)
basket you are currently processing to any [VALID] mail basket name.
"KRN",9.2,466,1,4,0)
However, you are not allowed to change the 'WASTE' or 'IN' mail basket
"KRN",9.2,466,1,5,0)
names.
"KRN",9.2,466,1,6,0)
 
"KRN",9.2,466,1,7,0)
To change a mail basket name, enter a 'C' at the 'Enter message number or
"KRN",9.2,466,1,8,0)
command:' prompt.
"KRN",9.2,466,2,0)
^9.22^1^1
"KRN",9.2,466,2,1,0)
VALID^XM-U-B-BASKET NAME
"KRN",9.2,467,-1)
0^69
"KRN",9.2,467,0)
XM-U-B-READER DIFF-3^BASKET ACTION CODES (CONTINUED)^2990319.1351^^
"KRN",9.2,467,1,0)
^^15^15^2990319^^^^
"KRN",9.2,467,1,1,0)
 
"KRN",9.2,467,1,2,0)
Available only with the Classic message reader, are the following basket
"KRN",9.2,467,1,3,0)
action codes:
"KRN",9.2,467,1,4,0)
 
"KRN",9.2,467,1,5,0)
 ?               View a summary listing of messages in a basket.
"KRN",9.2,467,1,6,0)
 
"KRN",9.2,467,1,7,0)
 ??              View a detailed listing of messages in a basket.
"KRN",9.2,467,1,8,0)
 
"KRN",9.2,467,1,9,0)
 ???? or ?HELP   Display detailed help.        
"KRN",9.2,467,1,10,0)
 
"KRN",9.2,467,1,11,0)
 I               Ignore the default message to be read and make the
"KRN",9.2,467,1,12,0)
                 next message in the basket the default.
"KRN",9.2,467,1,13,0)

"KRN",9.2,467,1,14,0)
For the commands which act on one or more messages, you must specify a [RANGE]
"KRN",9.2,467,1,15,0)
of messages after entering the command. 
"KRN",9.2,467,2,0)
^9.22^3^1
"KRN",9.2,467,2,3,0)
RANGE^XM-U-M-CHOOSE RANGE
"KRN",9.2,468,-1)
0^31
"KRN",9.2,468,0)
XM-I-S-SITE PARAMETERS^MAILMAN SITE PARAMETERS FILE^3020507.082^^
"KRN",9.2,468,1,0)
^9.21^15^15^3020507^^^^
"KRN",9.2,468,1,1,0)
 
"KRN",9.2,468,1,2,0)
The MAILMAN SITE PARAMETERS file (#4.3) lets site managers tailor MailMan
"KRN",9.2,468,1,3,0)
for your site.
"KRN",9.2,468,1,4,0)
 
"KRN",9.2,468,1,5,0)
Site managers should be aware of the following areas:
"KRN",9.2,468,1,6,0)

"KRN",9.2,468,1,7,0)
  [IDENTITY] Settings
"KRN",9.2,468,1,8,0)

"KRN",9.2,468,1,9,0)
  [USER] Settings
"KRN",9.2,468,1,10,0)

"KRN",9.2,468,1,11,0)
  [LOCAL] Messaging
"KRN",9.2,468,1,12,0)

"KRN",9.2,468,1,13,0)
  [REMOTE] Messaging
"KRN",9.2,468,1,14,0)

"KRN",9.2,468,1,15,0)
  [DISK] Space Management
"KRN",9.2,468,2,0)
^9.22A^9^5
"KRN",9.2,468,2,4,0)
DISK^XM-I-S-SITE PARAMETERS-DISK
"KRN",9.2,468,2,5,0)
IDENTITY^XM-I-S-SITE PARAMETERS-ID
"KRN",9.2,468,2,6,0)
LOCAL^XM-I-S-SITE PARAMETERS-LOCAL
"KRN",9.2,468,2,8,0)
REMOTE^XM-I-S-SITE PARAMETERS-REMOTE
"KRN",9.2,468,2,9,0)
USER^XM-I-S-SITE PARAMETERS-USER
"KRN",9.2,469,-1)
0^28
"KRN",9.2,469,0)
XM-I-S-BIG GROUP SIZE^BIG GROUP SIZE FIELD^2990629.1307^
"KRN",9.2,469,1,0)
^^36^36^2990629^^^
"KRN",9.2,469,1,1,0)
 
"KRN",9.2,469,1,2,0)
When addressing messages to mail groups, mail groups can be classified as
"KRN",9.2,469,1,3,0)
'large' (site-specified) and processed differently from 'small-' to
"KRN",9.2,469,1,4,0)
'medium-sized' mail groups. A mail group may be considered 'large' when it
"KRN",9.2,469,1,5,0)
has any of the following:
"KRN",9.2,469,1,6,0)
 
"KRN",9.2,469,1,7,0)
  * A large number of local and remote members.
"KRN",9.2,469,1,8,0)
 
"KRN",9.2,469,1,9,0)
  * At least one or more member groups.
"KRN",9.2,469,1,10,0)
 
"KRN",9.2,469,1,11,0)
  * At least one or more distribution lists.
"KRN",9.2,469,1,12,0)
 
"KRN",9.2,469,1,13,0)
The BIG GROUP SIZE (Field #7.2) in the MAILMAN SITE PARAMETERS file (#4.3)
"KRN",9.2,469,1,14,0)
allows IRM to set the number used to indicate when a mail group is
"KRN",9.2,469,1,15,0)
considered 'large.' This helps eliminate the 'dots of death' when
"KRN",9.2,469,1,16,0)
addressing mail to a large group.
"KRN",9.2,469,1,17,0)
 
"KRN",9.2,469,1,18,0)
IRM can populate this field with a number ranging from 50 to 10,000 (no
"KRN",9.2,469,1,19,0)
decimal points). There is no default for this field. If BIG GROUP SIZE
"KRN",9.2,469,1,20,0)
equates to zero, then groups are processed in the foreground, as usual.
"KRN",9.2,469,1,21,0)
 
"KRN",9.2,469,1,22,0)
If IRM populates this field and if the group being addressed contains any
"KRN",9.2,469,1,23,0)
member groups, or distribution lists, or the number of local members plus
"KRN",9.2,469,1,24,0)
remote members exceeds or equals the BIG GROUP SIZE, then the user is
"KRN",9.2,469,1,25,0)
asked whether or not they want to queue the group for [LATER] delivery and
"KRN",9.2,469,1,26,0)
avoid waiting while the group is processed. The user is also warned that
"KRN",9.2,469,1,27,0)
if they choose to queue the delivery, then recipients cannot be 'minused'
"KRN",9.2,469,1,28,0)
from the group.
"KRN",9.2,469,1,29,0)
 
"KRN",9.2,469,1,30,0)
If the user chooses to queue the delivery to the group, they are asked
"KRN",9.2,469,1,31,0)
when the delivery should take place. The group will be queued for
"KRN",9.2,469,1,32,0)
processing and delivery at the specified date and time by the same
"KRN",9.2,469,1,33,0)
background job that 'news' messages.
"KRN",9.2,469,1,34,0)
 
"KRN",9.2,469,1,35,0)
If the user chooses not to queue the delivery to the group, then
"KRN",9.2,469,1,36,0)
processing proceeds in the foreground, as usual.
"KRN",9.2,469,2,0)
^9.22A^1^1
"KRN",9.2,469,2,1,0)
LATER^XM-U-M-TRANSMIT LATER
"KRN",9.2,470,-1)
0^30
"KRN",9.2,470,0)
XM-I-S-MESSAGE LINE LIMIT^P-MESSAGE LINE LIMIT FIELD^2981216.095457^
"KRN",9.2,470,1,0)
^^21^21^2981230^^
"KRN",9.2,470,1,1,0)
 
"KRN",9.2,470,1,2,0)
The P-MESSAGE LINE LIMIT field (#16.1), in the MAILMAN SITE PARAMETERS
"KRN",9.2,470,1,3,0)
file (#4.3), allows IRM to set the maximum number of lines that can be
"KRN",9.2,470,1,4,0)
written to the [P-MESSAGE] device. This helps MailMan to operate more
"KRN",9.2,470,1,5,0)
efficiently when using the P-MESSAGE device.
"KRN",9.2,470,1,6,0)
 
"KRN",9.2,470,1,7,0)
IRM can populate this field with a number ranging from 2000 to 9,999,999
"KRN",9.2,470,1,8,0)
(no decimal points). There is no default for this field.
"KRN",9.2,470,1,9,0)
 
"KRN",9.2,470,1,10,0)
If this field is null, there is no limit set when writing to the P-MESSAGE
"KRN",9.2,470,1,11,0)
device.
"KRN",9.2,470,1,12,0)
 
"KRN",9.2,470,1,13,0)
If a value is entered into this field, the number of lines written to the
"KRN",9.2,470,1,14,0)
P-MESSAGE device is limited to that value. If the number of lines exceeds
"KRN",9.2,470,1,15,0)
this value, MailMan will truncate the report when it reaches the maximum
"KRN",9.2,470,1,16,0)
number of lines and puts the following message (between lines of
"KRN",9.2,470,1,17,0)
asterisks) at the end of the message text:
"KRN",9.2,470,1,18,0)
 
"KRN",9.2,470,1,19,0)
    *******************************************************************
"KRN",9.2,470,1,20,0)
    P-MESSAGE line limit of nnnn reached.  Rest of file ignored.
"KRN",9.2,470,1,21,0)
    *******************************************************************
"KRN",9.2,470,2,0)
^9.22A^1^1
"KRN",9.2,470,2,1,0)
P-MESSAGE^XM-U-M-PRINT DEVICE P-MESSAGE
"KRN",9.2,471,-1)
0^29
"KRN",9.2,471,0)
XM-I-S-MAX DIGITS FOR MSG NUM^MAX DIGITS FOR MESSAGE NUMBER FIELD^3020506.1537^
"KRN",9.2,471,1,0)
^9.21^61^61^3020506^^^
"KRN",9.2,471,1,1,0)
 
"KRN",9.2,471,1,2,0)
MailMan can reuse/recycle internal message identification numbers when
"KRN",9.2,471,1,3,0)
creating messages. Thus, MailMan can avoid creating huge message numbers,
"KRN",9.2,471,1,4,0)
making them more manageable in size.
"KRN",9.2,471,1,5,0)
 
"KRN",9.2,471,1,6,0)
The MAX DIGITS FOR MESSAGE NUMBER field (#17.1),in the MAILMAN SITE
"KRN",9.2,471,1,7,0)
PARAMETERS file (#4.3), allows IRM to set the maximum number of digits
"KRN",9.2,471,1,8,0)
that can comprise a MailMan internal message identification number before
"KRN",9.2,471,1,9,0)
they recycle back and start again from 100,000.
"KRN",9.2,471,1,10,0)
 
"KRN",9.2,471,1,11,0)
NOTE: MailMan internal message identification numbers start at 100,000
"KRN",9.2,471,1,12,0)
      to avoid any confusion between message numbers and message
"KRN",9.2,471,1,13,0)
      sequence numbers in baskets.
"KRN",9.2,471,1,14,0)
 
"KRN",9.2,471,1,15,0)
IRM can populate this field with a number ranging from 7 to 14 (no decimal
"KRN",9.2,471,1,16,0)
points). If this field is left null, the default will be eight digits.
"KRN",9.2,471,1,17,0)
 
"KRN",9.2,471,1,18,0)
If the MailMan internal message identification number exceeds the number
"KRN",9.2,471,1,19,0)
of digits stored in this field, the message number will recycle back to
"KRN",9.2,471,1,20,0)
the next vacant message number after 99999.
"KRN",9.2,471,1,21,0)
 
"KRN",9.2,471,1,22,0)
If MailMan is not able to find a vacant message number less than the
"KRN",9.2,471,1,23,0)
allowable number (i.e., value stored in the MAX DIGITS FOR MESSAGE NUMBER
"KRN",9.2,471,1,24,0)
field), then MailMan will take the next available message number, no
"KRN",9.2,471,1,25,0)
matter how many digits it has, and automatically change this field to
"KRN",9.2,471,1,26,0)
reflect the new maximum. Thus, it is very important that the unreferenced
"KRN",9.2,471,1,27,0)
messages purge and/or date purge be run on a regular basis.
"KRN",9.2,471,1,28,0)
 
"KRN",9.2,471,1,29,0)
 
"KRN",9.2,471,1,30,0)
OTHER RELATED FIELDS:
"KRN",9.2,471,1,31,0)
 
"KRN",9.2,471,1,32,0)
Because of the MAX DIGITS FOR MESSAGE NUMBER field, the purge routines
"KRN",9.2,471,1,33,0)
operate off the LOCAL CREATE DATE field (#31), in the MAIL BOX file (#3.9)
"KRN",9.2,471,1,34,0)
and its 'C' cross-reference.
"KRN",9.2,471,1,35,0)
 
"KRN",9.2,471,1,36,0)
This field is set with the current date (no time) when a new message stub
"KRN",9.2,471,1,37,0)
is created. (For locally created messages, this will usually, but not
"KRN",9.2,471,1,38,0)
necessarily, be the same as the date sent. For incoming messages from
"KRN",9.2,471,1,39,0)
remote sites, this acts as a 'date-received' stamp.)
"KRN",9.2,471,1,40,0)
 
"KRN",9.2,471,1,41,0)
The date purge routine runs fast, because it has an appropriate
"KRN",9.2,471,1,42,0)
cross-reference to work with.
"KRN",9.2,471,1,43,0)
 
"KRN",9.2,471,1,44,0)
Other fields in Files #3.7 and #4.3, that refer to date include:
"KRN",9.2,471,1,45,0)
 
"KRN",9.2,471,1,46,0)
  MAIL BOX File (#3.7):
"KRN",9.2,471,1,47,0)
 
"KRN",9.2,471,1,48,0)
  Field Number   Field Name
"KRN",9.2,471,1,49,0)
  ------------   -----------------------
"KRN",9.2,471,1,50,0)
  3.7,1.2        DATE @ REINSTATEMENT
"KRN",9.2,471,1,51,0)
 
"KRN",9.2,471,1,52,0)
 
"KRN",9.2,471,1,53,0)
  MAILMAN SITE PARAMETERS File (#4.3):
"KRN",9.2,471,1,54,0)
 
"KRN",9.2,471,1,55,0)
  Field Number   Field Name
"KRN",9.2,471,1,56,0)
  ------------   ------------------------
"KRN",9.2,471,1,57,0)
  4.3,4.301      NO-PURGE DAYS BUFFER
"KRN",9.2,471,1,58,0)
  4.302,3        START PURGE DATE
"KRN",9.2,471,1,59,0)
  4.302,4        STOP PURGE DATE
"KRN",9.2,471,1,60,0)
  4.302,8        LAST DATE PROCESSED
"KRN",9.2,471,1,61,0)
  4.3,4.304      WEEKDAY DAYS TO PURGE
"KRN",9.2,472,-1)
0^219
"KRN",9.2,472,0)
XM-U-P-OPTIONS-2^PERSONAL PREFERENCES (CONTINUED)^3000726.0743^^
"KRN",9.2,472,1,0)
^9.21^20^20^3000726^^^^
"KRN",9.2,472,1,1,0)
 
"KRN",9.2,472,1,2,0)
  * MESSAGE [READER] PROMPT - Specify whether the reader you've chosen
"KRN",9.2,472,1,3,0)
    should be used all the time or whether you want to be asked each time
"KRN",9.2,472,1,4,0)
    you use the Read/Manage Messages option.
"KRN",9.2,472,1,5,0)
 
"KRN",9.2,472,1,6,0)
  * [NEW] MESSAGES DEFAULT OPTION - Choose your default option to appear
"KRN",9.2,472,1,7,0)
    when you select the 'New Messages and Responses' option.
"KRN",9.2,472,1,8,0)
 
"KRN",9.2,472,1,9,0)
  * SHOW MESSAGE [PREVIEW] - Choose your default message action for the
"KRN",9.2,472,1,10,0)
    'IN' basket (e.g., ignore or delete messages).
"KRN",9.2,472,1,11,0)
 
"KRN",9.2,472,1,12,0)
  * [MESSAGE ACTION] DEFAULT - Choose your default message action for the
"KRN",9.2,472,1,13,0)
    'IN' basket (e.g., ignore or delete messages).
"KRN",9.2,472,1,14,0)
 
"KRN",9.2,472,1,15,0)
  * [ASK BASKET] - Decide whether you want to be prompted each time to
"KRN",9.2,472,1,16,0)
    choose a mail basket whenever you send yourself e-mail.
"KRN",9.2,472,1,17,0)
 
"KRN",9.2,472,1,18,0)
  * SHOW [TITLES] - Decide whether you want a a sender's title displayed.
"KRN",9.2,472,1,19,0)
 
"KRN",9.2,472,1,20,0)
[MORE]...
"KRN",9.2,472,2,0)
^9.22A^11^7
"KRN",9.2,472,2,1,0)
MORE^XM-U-P-OPTIONS-4
"KRN",9.2,472,2,3,0)
ASK BASKET^XM-U-P-ASK BASKET
"KRN",9.2,472,2,7,0)
MESSAGE ACTION^XM-U-P-MESSAGE ACTION DEFAULT
"KRN",9.2,472,2,8,0)
NEW^XM-U-P-NEW MESSAGES OPTION
"KRN",9.2,472,2,9,0)
PREVIEW^XM-U-P-SHOW MESSAGE PREVIEW
"KRN",9.2,472,2,10,0)
READER^XM-U-P-READER PROMPT
"KRN",9.2,472,2,11,0)
TITLES^XM-U-P-SHOW TITLES
"KRN",9.2,473,-1)
0^220
"KRN",9.2,473,0)
XM-U-P-OPTIONS-3^PERSONAL PREFERENCES (CONTINUED)^3000726.0708^^
"KRN",9.2,473,1,0)
^9.21^16^16^3000726^^^^
"KRN",9.2,473,1,1,0)
 
"KRN",9.2,473,1,2,0)
  * MAILMAN [INSTITUTION] - Enter or edit your MailMan institution.
"KRN",9.2,473,1,3,0)
 
"KRN",9.2,473,1,4,0)
  * [NETWORK SIGNATURE] - Enter or edit your Network Signature (three
"KRN",9.2,473,1,5,0)
    lines), required when [ANSWERING] messages.
"KRN",9.2,473,1,6,0)
 
"KRN",9.2,473,1,7,0)
  * [INTRODUCTION] - Enter or edit your MailMan introduction.
"KRN",9.2,473,1,8,0)
 
"KRN",9.2,473,1,9,0)
  * READ NEW MESSAGES [BASKET] PRIORITY - Choose which, if any, baskets
"KRN",9.2,473,1,10,0)
    you'd like to read from first, if they contain new messages.
"KRN",9.2,473,1,11,0)
 
"KRN",9.2,473,1,12,0)
  * PREFERRED [EDITOR] - Choose your preferred MailMan editor when sending
"KRN",9.2,473,1,13,0)
    new or responding to messages.
"KRN",9.2,473,1,14,0)
 
"KRN",9.2,473,1,15,0)
  * [OFFICE INFORMATION] - Enter or edit your office information (e.g.,
"KRN",9.2,473,1,16,0)
    business address, telephones, etc.).
"KRN",9.2,473,2,0)
^9.22A^7^7
"KRN",9.2,473,2,1,0)
INSTITUTION^XM-U-P-INSTITUTION
"KRN",9.2,473,2,2,0)
NETWORK SIGNATURE^XM-U-P-NETWORK SIGNATURE
"KRN",9.2,473,2,3,0)
INTRODUCTION^XM-U-P-INTRODUCTION
"KRN",9.2,473,2,4,0)
EDITOR^XM-U-P-EDITOR
"KRN",9.2,473,2,5,0)
OFFICE INFORMATION^XM-U-P-OFFICE INFO
"KRN",9.2,473,2,6,0)
ANSWERING^XM-U-M-ANSWER
"KRN",9.2,473,2,7,0)
BASKET^XM-U-P-READ NEW MSGS BSKT
"KRN",9.2,474,-1)
0^49
"KRN",9.2,474,0)
XM-U-A-LOCAL USER NAME^ENTERING A LOCAL USER'S NAME IN MAILMAN^2990121.083^^
"KRN",9.2,474,1,0)
^^19^19^2990121^^
"KRN",9.2,474,1,1,0)
 
"KRN",9.2,474,1,2,0)
Local users can be selected by last name, initials, or nickname (often the
"KRN",9.2,474,1,3,0)
first name). 
"KRN",9.2,474,1,4,0)
 
"KRN",9.2,474,1,5,0)
When entering a local user name, MailMan only requires that you enter the
"KRN",9.2,474,1,6,0)
first portion of the last name (user names are not case sensitive);
"KRN",9.2,474,1,7,0)
MailMan will find the appropriate person based on your partial entry and
"KRN",9.2,474,1,8,0)
automatically display the rest of the name to you. If more than one person
"KRN",9.2,474,1,9,0)
is found based on your partial entry, MailMan will allow you to choose
"KRN",9.2,474,1,10,0)
from a list. However, you'll narrow your choices by entering more
"KRN",9.2,474,1,11,0)
characters of the name.
"KRN",9.2,474,1,12,0)

"KRN",9.2,474,1,13,0)
You can get detailed [INFORMATION] about a user in two ways:
"KRN",9.2,474,1,14,0)

"KRN",9.2,474,1,15,0)
  * From the mail MailMan menu, select Help!User Information.
"KRN",9.2,474,1,16,0)

"KRN",9.2,474,1,17,0)
  * At the 'And Send to:' prompt, enter ??, then select User Information.
"KRN",9.2,474,1,18,0)
 
"KRN",9.2,474,1,19,0)
[MORE]... 
"KRN",9.2,474,2,0)
^9.22^7^2
"KRN",9.2,474,2,6,0)
MORE^XM-U-A-LOCAL USER NAME-2
"KRN",9.2,474,2,7,0)
INFORMATION^XM-U-H-USER
"KRN",9.2,475,-1)
0^237
"KRN",9.2,475,0)
XM-U-Q-REMOTE USER NAME^ENTERING A REMOTE USER'S NAME WHEN FILTERING OR SEARCHING MAIL^2981217.080449^
"KRN",9.2,475,1,0)
^^21^21^2981230^^^^
"KRN",9.2,475,1,1,0)
 
"KRN",9.2,475,1,2,0)
When entering the name of a user at a remote location (not located at your
"KRN",9.2,475,1,3,0)
site) for filtering or searching for mail, do any of the following:
"KRN",9.2,475,1,4,0)
 
"KRN",9.2,475,1,5,0)
  * Enter any portion of the remote user's name (not case sensitive)
"KRN",9.2,475,1,6,0)
    followed by the at-sign ('@' Shift-2 key on most keyboards, i.e.,
"KRN",9.2,475,1,7,0)
    name@). The name string entered must be from 1 to 45 characters in
"KRN",9.2,475,1,8,0)
    length (not case sensitive).
"KRN",9.2,475,1,9,0)
 
"KRN",9.2,475,1,10,0)
  * Enter any portion of the remote user's name (not case sensitive),
"KRN",9.2,475,1,11,0)
    the at-sign ('@' Shift-2 key on most keyboards), and any portion of
"KRN",9.2,475,1,12,0)
    their domain name (not case sensitive, i.e., name@domain). The name
"KRN",9.2,475,1,13,0)
    and domain name strings entered must be from 1 to 45 characters in
"KRN",9.2,475,1,14,0)
    length (not case sensitive).
"KRN",9.2,475,1,15,0)
 
"KRN",9.2,475,1,16,0)
  * Enter the at-sign ('@' Shift-2 key on most keyboards) and any portion
"KRN",9.2,475,1,17,0)
    of their domain name (not case sensitive, i.e., @domain). The domain
"KRN",9.2,475,1,18,0)
    name string entered must be from 1 to 45 characters in length (not
"KRN",9.2,475,1,19,0)
    case sensitive).
"KRN",9.2,475,1,20,0)
 
"KRN",9.2,475,1,21,0)
NOTE: The more characters you provide, the narrower the search will be.
"KRN",9.2,477,-1)
0^46
"KRN",9.2,477,0)
XM-U-A-GROUP LARGE^ADDRESSING MAIL TO LARGE MAIL GROUPS^2990120.122^^
"KRN",9.2,477,1,0)
^^20^20^2990120^^
"KRN",9.2,477,1,1,0)
 
"KRN",9.2,477,1,2,0)
When addressing messages to mail groups, mail groups can be classified as
"KRN",9.2,477,1,3,0)
'large' (site-specified) and processed differently from 'small-' to
"KRN",9.2,477,1,4,0)
'medium-sized' mail groups. A mail group may be considered 'large' when it has
"KRN",9.2,477,1,5,0)
a large number of local and remote members, member groups, or distribution
"KRN",9.2,477,1,6,0)
lists (nationwide mail groups). IRM sets the number used to indicate when a
"KRN",9.2,477,1,7,0)
mail group is considered 'large' (i.e., [BIG GROUP SIZE] field). 
"KRN",9.2,477,1,8,0)
 
"KRN",9.2,477,1,9,0)
If you address a message to a 'large' mail group, MailMan gives you the
"KRN",9.2,477,1,10,0)
opportunity to queue (i.e., [LATER]) the message for delivery to that group at
"KRN",9.2,477,1,11,0)
a later date and time (background processing). Thus, you don't have to wait
"KRN",9.2,477,1,12,0)
while all members of the mail group are added to the recipient list (i.e., you
"KRN",9.2,477,1,13,0)
avoid the 'dots of death') and you are not prevented from taking other actions.
"KRN",9.2,477,1,14,0)
 
"KRN",9.2,477,1,15,0)
Addressing a message to a 'small-' or 'medium-sized' mail group is processed in
"KRN",9.2,477,1,16,0)
the foreground as usual. Also, if you choose to 'Later' a message to a 'large'
"KRN",9.2,477,1,17,0)
mail group, you will not be able to remove (minus) members from the group
"KRN",9.2,477,1,18,0)
before sending the message. 
"KRN",9.2,477,1,19,0)
 
"KRN",9.2,477,1,20,0)
[MORE]... 
"KRN",9.2,477,2,0)
^9.22A^3^3
"KRN",9.2,477,2,1,0)
BIG GROUP SIZE^XM-I-S-BIG GROUP SIZE
"KRN",9.2,477,2,2,0)
LATER^XM-U-M-TRANSMIT LATER
"KRN",9.2,477,2,3,0)
MORE^XM-U-A-GROUP LARGE-2
"KRN",9.2,481,-1)
0^229
"KRN",9.2,481,0)
XM-U-P-READER PROMPT^MESSAGE READER PROMPT^2981222.111015^
"KRN",9.2,481,1,0)
^^15^15^2990201^
"KRN",9.2,481,1,1,0)
 
"KRN",9.2,481,1,2,0)
Once you have decided on a message reader, you can specify whether the
"KRN",9.2,481,1,3,0)
reader you just chose should be used all the time or whether you want to
"KRN",9.2,481,1,4,0)
be asked each time you use the [READ]/Manage Messages option.
"KRN",9.2,481,1,5,0)
 
"KRN",9.2,481,1,6,0)
Use the User Options Edit option on the Personal Preferences menu and
"KRN",9.2,481,1,7,0)
Press the Return/Enter key until you reach the the 'MESSAGE READER
"KRN",9.2,481,1,8,0)
PROMPT:' question. The default for this prompt is 'Yes, ask me.' By
"KRN",9.2,481,1,9,0)
answering 'No' to this prompt, you avoid being asked each time to choose a
"KRN",9.2,481,1,10,0)
MailMan message reader when reading your messages.
"KRN",9.2,481,1,11,0)
 
"KRN",9.2,481,1,12,0)
For example, if you wish to use the Detailed Full Screen reader
"KRN",9.2,481,1,13,0)
exclusively, set the MESSAGE READER to 'Detailed Full Screen' and the
"KRN",9.2,481,1,14,0)
MESSAGE READER PROMPT to 'No, don't ask me, just use the default' via the
"KRN",9.2,481,1,15,0)
User Options Edit option.
"KRN",9.2,481,2,0)
^9.22A^1^1
"KRN",9.2,481,2,1,0)
READ^XM-U-R-READ
"KRN",9.2,482,-1)
0^255
"KRN",9.2,482,0)
XM-U-R-NEW READ^READ NEW MAIL BY BASKET^2981223.113516^
"KRN",9.2,482,1,0)
^^18^18^2990505^
"KRN",9.2,482,1,1,0)
 
"KRN",9.2,482,1,2,0)
You can read all of your new mail basket by basket when you choose the
"KRN",9.2,482,1,3,0)
Read new mail by basket option. This is the default. When you have new
"KRN",9.2,482,1,4,0)
mail in more than one [BASKET], MailMan will ask you to choose from which
"KRN",9.2,482,1,5,0)
basket you wish to begin reading your mail.
"KRN",9.2,482,1,6,0)
 
"KRN",9.2,482,1,7,0)
When you have read all your mail in one basket and still have new mail in
"KRN",9.2,482,1,8,0)
other mail baskets, MailMan will prompt you to choose another mail basket
"KRN",9.2,482,1,9,0)
to continue reading your new mail. If you only had new mail in one basket,
"KRN",9.2,482,1,10,0)
MailMan would immediately begin displaying your first new message in that
"KRN",9.2,482,1,11,0)
one basket. It would continue to display all subsequent new messages in
"KRN",9.2,482,1,12,0)
that basket until all new messages have been read or you quit that option
"KRN",9.2,482,1,13,0)
by entering an up-arrow ('^' Shift-6 key on most keyboards) at the message
"KRN",9.2,482,1,14,0)
option prompt.
"KRN",9.2,482,1,15,0)
 
"KRN",9.2,482,1,16,0)
As the default, MailMan will start processing new mail in your "IN"
"KRN",9.2,482,1,17,0)
basket. If you choose a basket other than "IN," MailMan "cycles" through
"KRN",9.2,482,1,18,0)
all new mail in all baskets in basket name order (alphabetically).
"KRN",9.2,482,2,0)
^9.22A^1^1
"KRN",9.2,482,2,1,0)
BASKET^XM-U-B-BASKET SELECT
"KRN",9.2,483,-1)
0^250
"KRN",9.2,483,0)
XM-U-R-NEW LIST BASKETS^LIST BASKETS WITH NEW MAIL^2981223.11375^
"KRN",9.2,483,1,0)
^^12^12^2990505^
"KRN",9.2,483,1,1,0)
 
"KRN",9.2,483,1,2,0)
You can list all of your mail baskets with new mail by choosing the List
"KRN",9.2,483,1,3,0)
Baskets with new mail option available with the New Messages and Responses
"KRN",9.2,483,1,4,0)
option.
"KRN",9.2,483,1,5,0)
 
"KRN",9.2,483,1,6,0)
MailMan will display a list of all of your mail baskets with new mail.
"KRN",9.2,483,1,7,0)
MailMan also tells you how many new messages reside in each mail basket.
"KRN",9.2,483,1,8,0)
With this information, you can choose another new mail option to read your
"KRN",9.2,483,1,9,0)
new mail (e.g., Read new mail by basket option).
"KRN",9.2,483,1,10,0)
 
"KRN",9.2,483,1,11,0)
To list baskets with new mail, enter an 'LB' after the 'Select New mail
"KRN",9.2,483,1,12,0)
option: Read new mail by basket//' prompt.
"KRN",9.2,484,-1)
0^249
"KRN",9.2,484,0)
XM-U-R-NEW LIST ALL^LIST ALL NEW MESSAGES^2990114.1012^^
"KRN",9.2,484,1,0)
^^14^14^2990114^^^
"KRN",9.2,484,1,1,0)
 
"KRN",9.2,484,1,2,0)
You can list all of your new mail in your mailbox, regardless of the mail
"KRN",9.2,484,1,3,0)
basket, when you choose the List all new messages option available with
"KRN",9.2,484,1,4,0)
the New Messages and Responses option.
"KRN",9.2,484,1,5,0)
 
"KRN",9.2,484,1,6,0)
MailMan displays [DETAILED] information on each message using the Full Screen
"KRN",9.2,484,1,7,0)
message reader.
"KRN",9.2,484,1,8,0)
 
"KRN",9.2,484,1,9,0)
To list all new messages, enter an 'LN' after the 'Select New mail
"KRN",9.2,484,1,10,0)
option: Read new mail by basket//' prompt.
"KRN",9.2,484,1,11,0)
 
"KRN",9.2,484,1,12,0)
After displaying the list of new messages, MailMan asks you to enter a
"KRN",9.2,484,1,13,0)
message number or specific command at the 'Enter message number or
"KRN",9.2,484,1,14,0)
command:' prompt. You have several [OPTIONS].
"KRN",9.2,484,2,0)
^9.22A^5^2
"KRN",9.2,484,2,1,0)
OPTIONS^XM-U-BO-FULL SCREEN LIST
"KRN",9.2,484,2,5,0)
DETAILED^XM-U-B-READER DETAILED LIST
"KRN",9.2,485,-1)
0^251
"KRN",9.2,485,0)
XM-U-R-NEW LIST PRIORITY^LIST ALL PRIORITY MESSAGES^2990114.1037^^
"KRN",9.2,485,1,0)
^^21^21^2990114^^^
"KRN",9.2,485,1,1,0)
 
"KRN",9.2,485,1,2,0)
When MailMan delivers priority mail to your mailbox, you get a special
"KRN",9.2,485,1,3,0)
notification. For example, when first entering the MailMan Menu, MailMan
"KRN",9.2,485,1,4,0)
displays any new priority message(s) before displaying the MailMan Menu
"KRN",9.2,485,1,5,0)
and displays a message (i.e., 'There is PRIORITY Mail!'). As a further
"KRN",9.2,485,1,6,0)
highlight, all priority messages displayed to you in a list will be
"KRN",9.2,485,1,7,0)
preceded by an exclamation point.
"KRN",9.2,485,1,8,0)
 
"KRN",9.2,485,1,9,0)
You can list all of your priority mail in your mailbox, regardless of the
"KRN",9.2,485,1,10,0)
mail basket, when you choose the List all priority messages option
"KRN",9.2,485,1,11,0)
available with the New Messages and Responses option.
"KRN",9.2,485,1,12,0)
 
"KRN",9.2,485,1,13,0)
MailMan displays [DETAILED] information on each message.
"KRN",9.2,485,1,14,0)
After displaying the list of new messages, MailMan asks you to enter a
"KRN",9.2,485,1,15,0)
message number or specific command at the 'Enter message number or
"KRN",9.2,485,1,16,0)
command:' prompt. You have several [OPTIONS].
"KRN",9.2,485,1,17,0)
 
"KRN",9.2,485,1,18,0)
To list all priority messages, enter an 'LP' after the 'Select New mail
"KRN",9.2,485,1,19,0)
option: Read new mail by basket//' prompt. If you use this option and you
"KRN",9.2,485,1,20,0)
don't have any new priority messages, MailMan will display the following
"KRN",9.2,485,1,21,0)
message: 'You have no new Priority messages.'
"KRN",9.2,485,2,0)
^9.22A^2^2
"KRN",9.2,485,2,1,0)
DETAILED^XM-U-B-READER DETAILED LIST
"KRN",9.2,485,2,2,0)
OPTIONS^XM-U-BO-FULL SCREEN LIST
"KRN",9.2,486,-1)
0^252
"KRN",9.2,486,0)
XM-U-R-NEW PRINT^PRINT ALL NEW MESSAGES^2981223.115245^
"KRN",9.2,486,1,0)
^^19^19^2990107^
"KRN",9.2,486,1,1,0)
 
"KRN",9.2,486,1,2,0)
You can print all of your new mail in your mailbox, regardless of the mail
"KRN",9.2,486,1,3,0)
basket, when you choose the Print all new messages option available with
"KRN",9.2,486,1,4,0)
the New Messages and Responses option. MailMan prints each message with
"KRN",9.2,486,1,5,0)
print header information. This print information helps you differentiate:
"KRN",9.2,486,1,6,0)
 
"KRN",9.2,486,1,7,0)
  * Who - For whom was the message printed.
"KRN",9.2,486,1,8,0)
 
"KRN",9.2,486,1,9,0)
  * Where - At what location was the message printed.
"KRN",9.2,486,1,10,0)
 
"KRN",9.2,486,1,11,0)
  * When - When was the message printed as opposed to when it was sent.
"KRN",9.2,486,1,12,0)
 
"KRN",9.2,486,1,13,0)
To print all of your new mail, enter a 'P' after the 'Select New mail
"KRN",9.2,486,1,14,0)
option: Read new mail by basket//' prompt.
"KRN",9.2,486,1,15,0)
 
"KRN",9.2,486,1,16,0)
Pressing the Return/Enter key after each page tells MailMan to continue
"KRN",9.2,486,1,17,0)
printing your new messages in succession. To exit this option, before
"KRN",9.2,486,1,18,0)
you've finished printing all new messages, you must enter the up-arrow
"KRN",9.2,486,1,19,0)
('^' Shift-6 key on most keyboards).
"KRN",9.2,487,-1)
0^253
"KRN",9.2,487,0)
XM-U-R-NEW SCAN^SCAN ALL NEW MESSAGES^2981223.115329^
"KRN",9.2,487,1,0)
^^18^18^2981223^
"KRN",9.2,487,1,1,0)
 
"KRN",9.2,487,1,2,0)
Scanning your new messages is similar to [READING] your new messages by
"KRN",9.2,487,1,3,0)
basket. However, when scanning messages, you are not prompted between
"KRN",9.2,487,1,4,0)
baskets. You automatically pass from reading new messages in one basket to
"KRN",9.2,487,1,5,0)
reading the new messages in the next basket without any user prompts or
"KRN",9.2,487,1,6,0)
user action required between baskets.
"KRN",9.2,487,1,7,0)
 
"KRN",9.2,487,1,8,0)
You can scan all of your new mail in your mailbox, regardless of the mail
"KRN",9.2,487,1,9,0)
basket, when you choose the Scan all new messages option available with
"KRN",9.2,487,1,10,0)
the New Messages and Responses option.
"KRN",9.2,487,1,11,0)
 
"KRN",9.2,487,1,12,0)
To scan all of your new messages, enter an 'S' after the 'Select New mail
"KRN",9.2,487,1,13,0)
option: Read new mail by basket//' prompt.
"KRN",9.2,487,1,14,0)
 
"KRN",9.2,487,1,15,0)
As you continuously press the Return/Enter key, MailMan automatically
"KRN",9.2,487,1,16,0)
displays your new mail until there is no more new mail. If you want to
"KRN",9.2,487,1,17,0)
quit scanning your new mail before reaching the end, simply enter the
"KRN",9.2,487,1,18,0)
up-arrow ('^' Shift-6 key on most keyboards) to exit the option.
"KRN",9.2,487,2,0)
^9.22A^1^1
"KRN",9.2,487,2,1,0)
READING^XM-U-R-NEW READ
"KRN",9.2,489,-1)
0^66
"KRN",9.2,489,0)
XM-U-B-READER DETAILED LIST^DETAILED INFORMATION DISPLAYED WITH MESSAGE LISTS^2990114.1018^^
"KRN",9.2,489,1,0)
^^25^25^2990114^^^^
"KRN",9.2,489,1,1,0)
 
"KRN",9.2,489,1,2,0)
MailMan provides detailed information on each message when displaying a
"KRN",9.2,489,1,3,0)
message list. This information includes the following:
"KRN",9.2,489,1,4,0)
 
"KRN",9.2,489,1,5,0)
  * Flags - Any special flag associated with the message. For example:
"KRN",9.2,489,1,6,0)
    Priority (!) or New (*) flags.
"KRN",9.2,489,1,7,0)
 
"KRN",9.2,489,1,8,0)
  * Message Number - The number associated with the message (meaningful
"KRN",9.2,489,1,9,0)
    for this list only).
"KRN",9.2,489,1,10,0)
 
"KRN",9.2,489,1,11,0)
  * Basket - Basket containing the message (e.g., 'IN').
"KRN",9.2,489,1,12,0)
 
"KRN",9.2,489,1,13,0)
  * MailMan Internal Message Identification Number - The MailMan message
"KRN",9.2,489,1,14,0)
    number generated internally for the message (displayed in brackets).
"KRN",9.2,489,1,15,0)

"KRN",9.2,489,1,16,0)
  * Message Sent Date - The date the message was sent (i.e., day, month, year).
"KRN",9.2,489,1,17,0)
 
"KRN",9.2,489,1,18,0)
  * Subject - Subject of the message.
"KRN",9.2,489,1,19,0)
 
"KRN",9.2,489,1,20,0)
  * Lines - Number of lines of text in the message.
"KRN",9.2,489,1,21,0)
 
"KRN",9.2,489,1,22,0)
  * From - The name of the person who sent the message.
"KRN",9.2,489,1,23,0)
 
"KRN",9.2,489,1,24,0)
  * Read/Rcvd - Total number of responses read and received for that message.
"KRN",9.2,489,1,25,0)
    If there are no responses to a message, no totals will be indicated.
"KRN",9.2,489,2,0)
^9.22A^0^0
"KRN",9.2,490,-1)
0^223
"KRN",9.2,490,0)
XM-U-P-PERSONAL PREFERENCES^PERSONAL PREFERENCES MENU^2981223.155129^
"KRN",9.2,490,1,0)
^^15^15^2990513^
"KRN",9.2,490,1,1,0)
 
"KRN",9.2,490,1,2,0)
The MailMan interface includes a Personal Preferences menu. It consists of
"KRN",9.2,490,1,3,0)
the following options:
"KRN",9.2,490,1,4,0)
 
"KRN",9.2,490,1,5,0)
  * [USER] Options Edit
"KRN",9.2,490,1,6,0)
  * [BANNER] Edit
"KRN",9.2,490,1,7,0)
  * [SURROGATE] Edit
"KRN",9.2,490,1,8,0)
  * Message [FILTER] Edit
"KRN",9.2,490,1,9,0)
  * [DELIVERY] Basket Edit
"KRN",9.2,490,1,10,0)
  * Enroll in (or Disenroll from) a [MAIL GROUP]
"KRN",9.2,490,1,11,0)
  * [PERSONAL] Mail Group Edit
"KRN",9.2,490,1,12,0)
  * [FORWARDING] Address Edit
"KRN",9.2,490,1,13,0)
 
"KRN",9.2,490,1,14,0)
To access this menu from the main MailMan Menu, enter 'Personal
"KRN",9.2,490,1,15,0)
Preferences' at the 'Select MailMan Menu Option:' prompt.
"KRN",9.2,490,2,0)
^9.22A^8^8
"KRN",9.2,490,2,1,0)
USER^XM-U-P-OPTIONS
"KRN",9.2,490,2,2,0)
BANNER^XM-U-P-BANNER
"KRN",9.2,490,2,3,0)
SURROGATE^XM-U-P-SURROGATE EDIT
"KRN",9.2,490,2,4,0)
FILTER^XM-U-P-FILTER
"KRN",9.2,490,2,5,0)
DELIVERY^XM-U-P-DELIVERY BASKET PRIV
"KRN",9.2,490,2,6,0)
MAIL GROUP^XM-U-P-GROUP ENROLL
"KRN",9.2,490,2,7,0)
FORWARDING^XM-U-P-FORWARDING ADDRESS
"KRN",9.2,490,2,8,0)
PERSONAL^XM-U-P-GROUP PERSONAL
"KRN",9.2,491,-1)
0^76
"KRN",9.2,491,0)
XM-U-BO-CLASSIC^CLASSIC READER BASKET MESSAGE ACTIONS^3000607.1435^^
"KRN",9.2,491,1,0)
^9.21^21^21^3000607^^^^
"KRN",9.2,491,1,1,0)
 
"KRN",9.2,491,1,2,0)
Enter ^ to exit, or press <Enter> to read the default message, or enter:
"KRN",9.2,491,1,3,0)
 ? or ??  See a [SUMMARY] or [DETAILED] list of messages in this basket,
"KRN",9.2,491,1,4,0)
          beginning with the default message.
"KRN",9.2,491,1,5,0)
 n        Read message n, where n is a sequence [NUMBER] in this basket or
"KRN",9.2,491,1,6,0)
          an internal message ID of any message on the system.
"KRN",9.2,491,1,7,0)
 
"KRN",9.2,491,1,8,0)
The following commands act on one or more messages in this basket. You
"KRN",9.2,491,1,9,0)
will be asked to specify a [RANGE] of messages after entering the command.
"KRN",9.2,491,1,10,0)
 [D]        Delete messages.
"KRN",9.2,491,1,11,0)
 [F]        Forward messages.
"KRN",9.2,491,1,12,0)
 [FI]       Filter messages.
"KRN",9.2,491,1,13,0)
 [L]        Later messages.
"KRN",9.2,491,1,14,0)
 [P] or [H]   Print messages with or without a header.
"KRN",9.2,491,1,15,0)
 [NT]       New Toggle messages.
"KRN",9.2,491,1,16,0)
 [S]        Save messages to another basket.
"KRN",9.2,491,1,17,0)
 [T]        Terminate messages.
"KRN",9.2,491,1,18,0)
 [V]        Set Vaporize date for messages.
"KRN",9.2,491,1,19,0)
 [X]        Toggle transmit priority in remote message queues. (POSTMASTER only)
"KRN",9.2,491,1,20,0)

"KRN",9.2,491,1,21,0)
 [MORE]...
"KRN",9.2,491,2,0)
^9.22A^16^16
"KRN",9.2,491,2,1,0)
D^XM-U-M-DELETE
"KRN",9.2,491,2,2,0)
F^XM-U-M-FORWARD
"KRN",9.2,491,2,3,0)
FI^XM-U-B-FILTER
"KRN",9.2,491,2,4,0)
H^XM-U-M-PRINT NO HEADER
"KRN",9.2,491,2,5,0)
L^XM-U-M-LATER
"KRN",9.2,491,2,6,0)
MORE^XM-U-BO-CLASSIC-2
"KRN",9.2,491,2,7,0)
NUMBER^XM-U-B-NAVIGATE CLASSIC
"KRN",9.2,491,2,8,0)
P^XM-U-M-PRINT
"KRN",9.2,491,2,9,0)
RANGE^XM-U-M-CHOOSE RANGE
"KRN",9.2,491,2,10,0)
S^XM-U-M-SAVE
"KRN",9.2,491,2,11,0)
T^XM-U-M-TERMINATE
"KRN",9.2,491,2,12,0)
X^XM-U-B-XMIT PRIORITY TOGGLE
"KRN",9.2,491,2,13,0)
DETAILED^XM-U-B-READER DETAILED
"KRN",9.2,491,2,14,0)
SUMMARY^XM-U-B-READER SUMMARY
"KRN",9.2,491,2,15,0)
NT^XM-U-M-NEW
"KRN",9.2,491,2,16,0)
V^XM-U-M-VAPORIZE DATE EDIT
"KRN",9.2,491,3,0)
^9.23A^1^1
"KRN",9.2,491,3,1,0)
XMJBM
"KRN",9.2,492,-1)
0^59
"KRN",9.2,492,0)
XM-U-B-NAVIGATE CLASSIC^READING A MESSAGE AND NAVIGATING IN THE CLASSIC READER^2981228.084^^
"KRN",9.2,492,1,0)
^^20^20^2990108^
"KRN",9.2,492,1,1,0)
 
"KRN",9.2,492,1,2,0)
There are several ways to read messages and navigate in the Classic Reader.
"KRN",9.2,492,1,3,0)
 
"KRN",9.2,492,1,4,0)
One is to just press <Enter> to read the default message presented to you
"KRN",9.2,492,1,5,0)
at the prompt. Once you've read it, the next message in the basket will
"KRN",9.2,492,1,6,0)
become the default.
"KRN",9.2,492,1,7,0)
 
"KRN",9.2,492,1,8,0)
You could also enter its sequence number to go directly to the message
"KRN",9.2,492,1,9,0)
you wish to read. Once you've read it, the next message after that will
"KRN",9.2,492,1,10,0)
become the default.
"KRN",9.2,492,1,11,0)
 
"KRN",9.2,492,1,12,0)
If you enter a sequence number that doesn't exist, the message whose
"KRN",9.2,492,1,13,0)
sequence number is closest to it becomes the default message.
"KRN",9.2,492,1,14,0)
 
"KRN",9.2,492,1,15,0)
You could also enter the internal message ID (the long number appearing in
"KRN",9.2,492,1,16,0)
brackets) of a message. Once you've read it, the next message after that
"KRN",9.2,492,1,17,0)
will become the default. If the message exists in another basket, you will
"KRN",9.2,492,1,18,0)
be moved from reading your current basket to reading the basket where the
"KRN",9.2,492,1,19,0)
message exists. If the message is not in any basket, but is still on the
"KRN",9.2,492,1,20,0)
system, it will be put in your basket, as the last message.
"KRN",9.2,493,-1)
0^77
"KRN",9.2,493,0)
XM-U-BO-CLASSIC-2^CLASSIC READER BASKET MESSAGE ACTIONS (CONTINUED)^2991213.1322^^
"KRN",9.2,493,1,0)
^^15^15^2991213^^
"KRN",9.2,493,1,1,0)
 
"KRN",9.2,493,1,2,0)
Enter:
"KRN",9.2,493,1,3,0)
 
"KRN",9.2,493,1,4,0)
 [C]         Change the name of this basket.
"KRN",9.2,493,1,5,0)
 I         Ignore this message and go to the next one in this basket.
"KRN",9.2,493,1,6,0)
 [N]         List only the new messages in this basket.
"KRN",9.2,493,1,7,0)
 [Q]         Query (search for) messages in this basket.
"KRN",9.2,493,1,8,0)
 [R]         Resequence messages in this basket.
"KRN",9.2,493,1,9,0)
 
"KRN",9.2,493,1,10,0)
 ?string   Search for messages in this basket whose subject [CONTAINS]
"KRN",9.2,493,1,11,0)
           a certain keyword or phrase.
"KRN",9.2,493,1,12,0)
 
"KRN",9.2,493,1,13,0)
 ??string  Search for messages anywhere on the system, whether in your
"KRN",9.2,493,1,14,0)
           mailbox or not, which you once sent or received, whose subject
"KRN",9.2,493,1,15,0)
           [BEGINS WITH] the specified string.
"KRN",9.2,493,2,0)
^9.22A^8^6
"KRN",9.2,493,2,1,0)
C^XM-U-B-BASKET NAME CHANGE
"KRN",9.2,493,2,3,0)
N^XM-U-B-NEW MAIL LIST
"KRN",9.2,493,2,4,0)
Q^XM-U-Q-SEARCH CRITERIA
"KRN",9.2,493,2,5,0)
R^XM-U-B-RESEQUENCE MESSAGES
"KRN",9.2,493,2,7,0)
BEGINS WITH^XM-U-Q-CLASSIC LOOKUP ??
"KRN",9.2,493,2,8,0)
CONTAINS^XM-U-Q-CLASSIC LOOKUP ?
"KRN",9.2,494,-1)
0^78
"KRN",9.2,494,0)
XM-U-BO-FULL SCREEN^FULL SCREEN READER BASKET MESSAGE ACTIONS^3000612.0714^^
"KRN",9.2,494,1,0)
^9.21^21^21^3000612^^^^
"KRN",9.2,494,1,1,0)
 
"KRN",9.2,494,1,2,0)
Enter ^ to exit, or enter one of the [PAGE] commands to see more messages,
"KRN",9.2,494,1,3,0)
or enter one of the following:
"KRN",9.2,494,1,4,0)
 n        Read message n, where n is a sequence number in this basket or
"KRN",9.2,494,1,5,0)
          an internal message ID of any message on the system.
"KRN",9.2,494,1,6,0)
 
"KRN",9.2,494,1,7,0)
The following commands act on one or more messages in this basket.
"KRN",9.2,494,1,8,0)
You can [SELECT] the messages prior to entering the command or 
"KRN",9.2,494,1,9,0)
specify a [RANGE] of messages after entering the command.
"KRN",9.2,494,1,10,0)
 [D]        Delete messages.
"KRN",9.2,494,1,11,0)
 [F]        Forward messages.
"KRN",9.2,494,1,12,0)
 [FI]       Filter messages.
"KRN",9.2,494,1,13,0)
 [L]        Later messages.
"KRN",9.2,494,1,14,0)
 [P] or [H]   Print messages with or without a header.
"KRN",9.2,494,1,15,0)
 [NT]       New Toggle messages.
"KRN",9.2,494,1,16,0)
 [S]        Save messages to another basket.
"KRN",9.2,494,1,17,0)
 [T]        Terminate messages.
"KRN",9.2,494,1,18,0)
 [V]        Set a Vaporize date for messages.
"KRN",9.2,494,1,19,0)
 [X]        Toggle transmit priority in remote message queues. (POSTMASTER only)
"KRN",9.2,494,1,20,0)
 
"KRN",9.2,494,1,21,0)
 [MORE]...
"KRN",9.2,494,2,0)
^9.22A^16^15
"KRN",9.2,494,2,1,0)
D^XM-U-M-DELETE
"KRN",9.2,494,2,2,0)
F^XM-U-M-FORWARD
"KRN",9.2,494,2,3,0)
FI^XM-U-B-FILTER
"KRN",9.2,494,2,4,0)
H^XM-U-M-PRINT NO HEADER
"KRN",9.2,494,2,5,0)
L^XM-U-M-LATER
"KRN",9.2,494,2,6,0)
MORE^XM-U-BO-FULL SCREEN-2
"KRN",9.2,494,2,8,0)
P^XM-U-M-PRINT
"KRN",9.2,494,2,9,0)
PAGE^XM-U-B-NAVIGATE FULL SCREEN
"KRN",9.2,494,2,10,0)
RANGE^XM-U-M-CHOOSE RANGE
"KRN",9.2,494,2,11,0)
S^XM-U-M-SAVE
"KRN",9.2,494,2,12,0)
SELECT^XM-U-M-CHOOSE SELECT
"KRN",9.2,494,2,13,0)
T^XM-U-M-TERMINATE
"KRN",9.2,494,2,14,0)
X^XM-U-B-XMIT PRIORITY TOGGLE
"KRN",9.2,494,2,15,0)
NT^XM-U-M-NEW
"KRN",9.2,494,2,16,0)
V^XM-U-M-VAPORIZE DATE EDIT
"KRN",9.2,494,3,0)
^9.23A^2^2
"KRN",9.2,494,3,1,0)
XMJMLR
"KRN",9.2,494,3,2,0)
XMJMLR1
"KRN",9.2,495,-1)
0^80
"KRN",9.2,495,0)
XM-U-BO-FULL SCREEN-2^FULL SCREEN READER BASKET MESSAGE ACTIONS (CONTINUED)^2990319.1456^^
"KRN",9.2,495,1,0)
^^15^15^2990427^
"KRN",9.2,495,1,1,0)
 
"KRN",9.2,495,1,2,0)
Enter:
"KRN",9.2,495,1,3,0)
 
"KRN",9.2,495,1,4,0)
 [C]         Change the name of this basket.
"KRN",9.2,495,1,5,0)
 [CD]        Change detail. (Toggle between [SUMMARY] and [DETAILED] display.)
"KRN",9.2,495,1,6,0)
 [N]         List only the new messages in this basket.
"KRN",9.2,495,1,7,0)
 [Q]         Query (search for) messages in this basket.
"KRN",9.2,495,1,8,0)
 [R]         Resequence messages in this basket.
"KRN",9.2,495,1,9,0)
 
"KRN",9.2,495,1,10,0)
 ?string   Search for messages in this basket whose subject [CONTAINS]
"KRN",9.2,495,1,11,0)
           a certain keyword or phrase.
"KRN",9.2,495,1,12,0)
 
"KRN",9.2,495,1,13,0)
 ??string  Search for messages anywhere on the system, whether in your
"KRN",9.2,495,1,14,0)
           mailbox or not, which you once sent or received, whose subject
"KRN",9.2,495,1,15,0)
           [BEGINS WITH] the specified string.
"KRN",9.2,495,2,0)
^9.22^11^9
"KRN",9.2,495,2,2,0)
CD^XM-U-B-CHANGE DETAIL
"KRN",9.2,495,2,3,0)
N^XM-U-B-NEW MAIL LIST
"KRN",9.2,495,2,4,0)
Q^XM-U-Q-SEARCH CRITERIA
"KRN",9.2,495,2,5,0)
R^XM-U-B-RESEQUENCE MESSAGES
"KRN",9.2,495,2,6,0)
C^XM-U-B-BASKET NAME CHANGE
"KRN",9.2,495,2,7,0)
DETAILED^XM-U-B-READER DETAILED
"KRN",9.2,495,2,8,0)
SUMMARY^XM-U-B-READER SUMMARY
"KRN",9.2,495,2,10,0)
BEGINS WITH^XM-U-Q-CLASSIC LOOKUP ??
"KRN",9.2,495,2,11,0)
CONTAINS^XM-U-Q-CLASSIC LOOKUP ?
"KRN",9.2,496,-1)
0^120
"KRN",9.2,496,0)
XM-U-M-CHOOSE SELECT^SELECTING MESSAGES^2990120.1607^^
"KRN",9.2,496,1,0)
^^20^20^2990427^
"KRN",9.2,496,1,1,0)
 
"KRN",9.2,496,1,2,0)
Select messages for subsequent action (e.g., delete, filter, forward, later,
"KRN",9.2,496,1,3,0)
print, save, or terminate) by entering a period and then the message sequence
"KRN",9.2,496,1,4,0)
number(s) in any of the following ways: 
"KRN",9.2,496,1,5,0)
 
"KRN",9.2,496,1,6,0)
 .n          Select one message. For example: .5
"KRN",9.2,496,1,7,0)
 .n-m,a,c-d  Select several messages. For example: .1,5 or .1-9 or
"KRN",9.2,496,1,8,0)
             .1-3,5,8-10
"KRN",9.2,496,1,9,0)
 .n-         Select all messages from this one onward. For example: .6-
"KRN",9.2,496,1,10,0)
 .*          Select all of the messages in the list.
"KRN",9.2,496,1,11,0)
 
"KRN",9.2,496,1,12,0)
Messages that you've selected are marked by a '>'.
"KRN",9.2,496,1,13,0)
 
"KRN",9.2,496,1,14,0)
The selections are cumulative. This means that once you have selected some
"KRN",9.2,496,1,15,0)
messages, you can select some more. (Subsequent selections do not wipe out
"KRN",9.2,496,1,16,0)
previous ones.) This is good, because if the messages you want to select are
"KRN",9.2,496,1,17,0)
on different pages, you can select the ones on one page and then go ahead and
"KRN",9.2,496,1,18,0)
select more on other pages.
"KRN",9.2,496,1,19,0)
 
"KRN",9.2,496,1,20,0)
 [MORE]...
"KRN",9.2,496,2,0)
^9.22^1^1
"KRN",9.2,496,2,1,0)
MORE^XM-U-M-CHOOSE SELECT-2
"KRN",9.2,497,-1)
0^121
"KRN",9.2,497,0)
XM-U-M-CHOOSE SELECT-2^SELECTING MESSAGES (CONTINUED)^2981231.1104^^
"KRN",9.2,497,1,0)
^^19^19^2990427^
"KRN",9.2,497,1,1,0)
 
"KRN",9.2,497,1,2,0)
After you've selected messages, you may decide to deselect some of them.
"KRN",9.2,497,1,3,0)
You can do this by entering a period, followed by the minus sign, and then
"KRN",9.2,497,1,4,0)
the message sequence numbers(s) in any of the following ways:
"KRN",9.2,497,1,5,0)
 
"KRN",9.2,497,1,6,0)
 .-n          DeSelect one message. For example: .-5
"KRN",9.2,497,1,7,0)
 .-n-m,a,c-d  DeSelect several messages. For example: .-1,5 or .-1-3,5,8-10
"KRN",9.2,497,1,8,0)
 .-n-         DeSelect all messages from this one onward. For example: .-6-
"KRN",9.2,497,1,9,0)
 .-*          DeSelect all of the messages in the list.
"KRN",9.2,497,1,10,0)
 
"KRN",9.2,497,1,11,0)
Messages that you've deselected are no longer marked by a '>'.
"KRN",9.2,497,1,12,0)
 
"KRN",9.2,497,1,13,0)
The deselections are also cumulative. You can select and deselect as much as
"KRN",9.2,497,1,14,0)
you want. Knock yourself out.
"KRN",9.2,497,1,15,0)
 
"KRN",9.2,497,1,16,0)
Once you've selected some messages, additional commands become available:
"KRN",9.2,497,1,17,0)
 
"KRN",9.2,497,1,18,0)
 [O]            Opposite selection toggle.
"KRN",9.2,497,1,19,0)
 [Z]            Zoom toggle.
"KRN",9.2,497,2,0)
^9.22^2^2
"KRN",9.2,497,2,1,0)
O^XM-U-B-OPPOSITE TOGGLE
"KRN",9.2,497,2,2,0)
Z^XM-U-B-ZOOM TOGGLE
"KRN",9.2,498,-1)
0^60
"KRN",9.2,498,0)
XM-U-B-NAVIGATE FULL SCREEN^READING A MESSAGE AND NAVIGATING IN THE FULL SCREEN READER^2990722.0912^^
"KRN",9.2,498,1,0)
^^21^21^2990722^^^
"KRN",9.2,498,1,1,0)
 
"KRN",9.2,498,1,2,0)
There are several ways to read messages and navigate in the Full Screen Reader.
"KRN",9.2,498,1,3,0)

"KRN",9.2,498,1,4,0)
Enter the sequence number of a message, and you'll read that message. Then
"KRN",9.2,498,1,5,0)
you'll be on the page with that sequence number in it. If the sequence number
"KRN",9.2,498,1,6,0)
does not exist, you'll be on the page where it would be if it did exist. 
"KRN",9.2,498,1,7,0)
 
"KRN",9.2,498,1,8,0)
Enter the internal message ID (the long number appearing in brackets) of any
"KRN",9.2,498,1,9,0)
message on the system, and you'll read that message. Then you'll be on the
"KRN",9.2,498,1,10,0)
page with that message on it. If the message exists in a different basket, you
"KRN",9.2,498,1,11,0)
won't stay in that basket, as you would with the Classic Reader; you'll return
"KRN",9.2,498,1,12,0)
to the page where you were. 
"KRN",9.2,498,1,13,0)
 
"KRN",9.2,498,1,14,0)
Press <Enter> to go to the next page, or enter:
"KRN",9.2,498,1,15,0)
 +n        Page forward n pages. (+ is the same as +1)
"KRN",9.2,498,1,16,0)
           If +n is very high (like +999), you'll go to the last page.
"KRN",9.2,498,1,17,0)
           If you're on the last page and you page forward, you'll be given
"KRN",9.2,498,1,18,0)
           the option of going to the first page or exiting the list.
"KRN",9.2,498,1,19,0)
 -n        Page backward n pages.  (- is the same as -1)
"KRN",9.2,498,1,20,0)
 0 (zero)  Go to the first page.
"KRN",9.2,498,1,21,0)
 =         Refresh the display of the current page.
"KRN",9.2,499,-1)
0^158
"KRN",9.2,499,0)
XM-U-M-QUERY GENERAL^GENERAL QUERY ON A MESSAGE^2990114.1331^^
"KRN",9.2,499,1,0)
^^14^14^2990427^
"KRN",9.2,499,1,1,0)
 
"KRN",9.2,499,1,2,0)
You can use the Query action code (i.e., 'Q') to inquire about general
"KRN",9.2,499,1,3,0)
addressee information on a message.
"KRN",9.2,499,1,4,0)
 
"KRN",9.2,499,1,5,0)
When doing a query on a message, besides the [BASIC] information, MailMan
"KRN",9.2,499,1,6,0)
will display a list of the addressees to whom the user addressed the message.
"KRN",9.2,499,1,7,0)
Addressees include local and remote users and any mail groups.
"KRN",9.2,499,1,8,0)
 
"KRN",9.2,499,1,9,0)
MailMan also displays a list of addresses to whom the message will be
"KRN",9.2,499,1,10,0)
forwarded at a later date.  These addressees were targeted for [STAGGERED]
"KRN",9.2,499,1,11,0)
delivery.
"KRN",9.2,499,1,12,0)
 
"KRN",9.2,499,1,13,0)
To query a message for general addressee information, enter a 'Q' at the
"KRN",9.2,499,1,14,0)
'Enter message action' prompt.
"KRN",9.2,499,2,0)
^9.22^2^2
"KRN",9.2,499,2,1,0)
BASIC^XM-U-M-QUERY INFO BASIC
"KRN",9.2,499,2,2,0)
STAGGERED^XM-U-A-STAGGER DELIVERY
"KRN",9.2,500,-1)
0^157
"KRN",9.2,500,0)
XM-U-M-QUERY DETAILED^DETAILED QUERY ON A MESSAGE^2990114.1306^^
"KRN",9.2,500,1,0)
^^16^16^2990427^
"KRN",9.2,500,1,1,0)
 
"KRN",9.2,500,1,2,0)
You can use the Query Detailed action code (i.e., 'QD') to retrieve
"KRN",9.2,500,1,3,0)
detailed information for each recipient of a message.
"KRN",9.2,500,1,4,0)
 
"KRN",9.2,500,1,5,0)
When doing a detailed query on a message, besides the [BASIC] information,
"KRN",9.2,500,1,6,0)
MailMan displays detailed recipient information for all [LOCAL] and
"KRN",9.2,500,1,7,0)
[REMOTE] users who are recipients of the message (including all members of
"KRN",9.2,500,1,8,0)
any mail groups).
"KRN",9.2,500,1,9,0)
 
"KRN",9.2,500,1,10,0)
Also, when you do a detailed query on a message that was sent to you and
"KRN",9.2,500,1,11,0)
you have your mail automatically forwarded to a remote address, the query
"KRN",9.2,500,1,12,0)
clearly shows that you are the one who forwarded the message to that
"KRN",9.2,500,1,13,0)
address. 
"KRN",9.2,500,1,14,0)
 
"KRN",9.2,500,1,15,0)
To query a message for detailed recipient information, enter a 'QD' at the
"KRN",9.2,500,1,16,0)
'Enter message action' prompt.
"KRN",9.2,500,2,0)
^9.22A^3^3
"KRN",9.2,500,2,1,0)
REMOTE^XM-U-M-QUERY INFO REMOTE
"KRN",9.2,500,2,2,0)
LOCAL^XM-U-M-QUERY INFO LOCAL
"KRN",9.2,500,2,3,0)
BASIC^XM-U-M-QUERY INFO BASIC
"KRN",9.2,501,-1)
0^164
"KRN",9.2,501,0)
XM-U-M-QUERY SPECIFIC^SPECIFIC QUERY ON A MESSAGE^2990114.1301^^
"KRN",9.2,501,1,0)
^^20^20^2990427^
"KRN",9.2,501,1,1,0)
 
"KRN",9.2,501,1,2,0)
You can use the Query Recipients action code (i.e., 'Q xxx' - where 'xxx'
"KRN",9.2,501,1,3,0)
represents the name of a person) to inquire about specific local and
"KRN",9.2,501,1,4,0)
remote recipients of a message. MailMan will display all recipients that
"KRN",9.2,501,1,5,0)
match your entry. The more characters entered (not case sensitive), the
"KRN",9.2,501,1,6,0)
more closely MailMan can match your entry to the list of recipients.
"KRN",9.2,501,1,7,0)
 
"KRN",9.2,501,1,8,0)
When doing a query on a message for a specific person, regardless of a
"KRN",9.2,501,1,9,0)
match, MailMan will always display the [BASIC] information about the
"KRN",9.2,501,1,10,0)
message.
"KRN",9.2,501,1,11,0)
 
"KRN",9.2,501,1,12,0)
If MailMan finds an addressee on the message that matches the person
"KRN",9.2,501,1,13,0)
entered, MailMan will display the detailed information on that [LOCAL] or
"KRN",9.2,501,1,14,0)
[REMOTE] addressee.
"KRN",9.2,501,1,15,0)
 
"KRN",9.2,501,1,16,0)
If MailMan cannot find a match, no recipient detailed information can be
"KRN",9.2,501,1,17,0)
displayed.
"KRN",9.2,501,1,18,0)
 
"KRN",9.2,501,1,19,0)
To query a message for detailed information on a specific recipient, enter
"KRN",9.2,501,1,20,0)
a 'Q' and the recipient's name at the 'Enter message action' prompt.
"KRN",9.2,501,2,0)
^9.22A^3^3
"KRN",9.2,501,2,1,0)
LOCAL^XM-U-M-QUERY INFO LOCAL
"KRN",9.2,501,2,2,0)
REMOTE^XM-U-M-QUERY INFO REMOTE
"KRN",9.2,501,2,3,0)
BASIC^XM-U-M-QUERY INFO BASIC
"KRN",9.2,502,-1)
0^79
"KRN",9.2,502,0)
XM-U-BO-FULL SCREEN LIST^FULL SCREEN READER MESSAGE LIST ACTIONS^2991214.0743^^
"KRN",9.2,502,1,0)
^^20^20^2991214^^^^
"KRN",9.2,502,1,1,0)
 
"KRN",9.2,502,1,2,0)
Enter ^ to exit, or enter one of the [PAGE] commands to see more messages,
"KRN",9.2,502,1,3,0)
or enter one of the following:
"KRN",9.2,502,1,4,0)
 
"KRN",9.2,502,1,5,0)
 n        Read message n, where n is a sequence number of a message in this
"KRN",9.2,502,1,6,0)
          list, or an internal message ID of any message on the system.
"KRN",9.2,502,1,7,0)
 [CD]       Change detail. (Toggle between summary and detailed readers.)
"KRN",9.2,502,1,8,0)
 
"KRN",9.2,502,1,9,0)
The following commands act on one or more messages in this list.
"KRN",9.2,502,1,10,0)
You can [SELECT] the messages prior to entering the command or
"KRN",9.2,502,1,11,0)
specify a [RANGE] of messages after entering the command.
"KRN",9.2,502,1,12,0)
 
"KRN",9.2,502,1,13,0)
 [D]        Delete messages.
"KRN",9.2,502,1,14,0)
 [F]        Forward messages.
"KRN",9.2,502,1,15,0)
 [FI]       Filter messages.
"KRN",9.2,502,1,16,0)
 [L]        Later messages.
"KRN",9.2,502,1,17,0)
 [NT]       New Toggle messages.
"KRN",9.2,502,1,18,0)
 [P] or [H]   Print messages with or without headers.
"KRN",9.2,502,1,19,0)
 [S]        Save messages to another basket.
"KRN",9.2,502,1,20,0)
 [T]        Terminate messages.
"KRN",9.2,502,2,0)
^9.22^15^13
"KRN",9.2,502,2,3,0)
F^XM-U-M-FORWARD
"KRN",9.2,502,2,4,0)
FI^XM-U-B-FILTER
"KRN",9.2,502,2,5,0)
H^XM-U-M-PRINT NO HEADER
"KRN",9.2,502,2,6,0)
L^XM-U-M-LATER
"KRN",9.2,502,2,7,0)
P^XM-U-M-PRINT
"KRN",9.2,502,2,8,0)
PAGE^XM-U-B-NAVIGATE FULL SCREEN
"KRN",9.2,502,2,9,0)
RANGE^XM-U-M-CHOOSE RANGE
"KRN",9.2,502,2,10,0)
S^XM-U-M-SAVE
"KRN",9.2,502,2,11,0)
SELECT^XM-U-M-CHOOSE SELECT
"KRN",9.2,502,2,12,0)
T^XM-U-M-TERMINATE
"KRN",9.2,502,2,13,0)
CD^XM-U-B-CHANGE DETAIL
"KRN",9.2,502,2,14,0)
D^XM-U-M-DELETE
"KRN",9.2,502,2,15,0)
NT^XM-U-M-NEW
"KRN",9.2,502,3,0)
^9.23A^2^2
"KRN",9.2,502,3,1,0)
XMJMLN
"KRN",9.2,502,3,2,0)
XMJMLR1
"KRN",9.2,503,-1)
0^162
"KRN",9.2,503,0)
XM-U-M-QUERY NETWORK^NETWORK QUERY ON A MESSAGE^2990428.0712^^
"KRN",9.2,503,1,0)
^^20^20^2990428^^
"KRN",9.2,503,1,1,0)
 
"KRN",9.2,503,1,2,0)
You can use the Query Network action code (i.e., 'QN') to retrieve
"KRN",9.2,503,1,3,0)
network/trace header information and [DETAILED] information about each
"KRN",9.2,503,1,4,0)
addressee ([LOCAL] and [REMOTE] recipients) of a message. However, it is
"KRN",9.2,503,1,5,0)
primarily used as a diagnostic tool.
"KRN",9.2,503,1,6,0)
 
"KRN",9.2,503,1,7,0)
NOTE: The network/trace header information includes all the different mail
"KRN",9.2,503,1,8,0)
      server relay information while the message passed from server to
"KRN",9.2,503,1,9,0)
      server to get to you.
"KRN",9.2,503,1,10,0)
 
"KRN",9.2,503,1,11,0)
Also, when messages are received from a non-MailMan remote sites, MailMan
"KRN",9.2,503,1,12,0)
captures the 'From' address from the message header and not from the
"KRN",9.2,503,1,13,0)
envelope. However, the 'From' address from the envelope is captured in a
"KRN",9.2,503,1,14,0)
field and is displayed by the QN action code when it differs from the
"KRN",9.2,503,1,15,0)
message header 'From' address.
"KRN",9.2,503,1,16,0)
 
"KRN",9.2,503,1,17,0)
NOTE: The envelope contains the 'From' and 'To' address used by the mail
"KRN",9.2,503,1,18,0)
      transport system and is not part of the message itself.
"KRN",9.2,503,1,19,0)
 
"KRN",9.2,503,1,20,0)
[MORE]... 
"KRN",9.2,503,2,0)
^9.22A^4^4
"KRN",9.2,503,2,1,0)
DETAILED^XM-U-M-QUERY DETAILED
"KRN",9.2,503,2,2,0)
MORE^XM-U-M-QUERY NETWORK-2
"KRN",9.2,503,2,3,0)
LOCAL^XM-U-M-QUERY INFO LOCAL
"KRN",9.2,503,2,4,0)
REMOTE^XM-U-M-QUERY INFO REMOTE
"KRN",9.2,504,-1)
0^247
"KRN",9.2,504,0)
XM-U-Q-SEARCH MAILBOX^SEARCHING FOR MESSAGES - SEARCHING YOUR MAILBOX^3020502.1441^^
"KRN",9.2,504,1,0)
^9.21^12^12^3020502^^^^
"KRN",9.2,504,1,1,0)
 
"KRN",9.2,504,1,2,0)
Under the 'Query/Search for Messages' option on the main MailMan menu,
"KRN",9.2,504,1,3,0)
using multiple search [CRITERIA], you can search for any messages you sent
"KRN",9.2,504,1,4,0)
or that were sent to you in any of the following locations in your mailbox:
"KRN",9.2,504,1,5,0)
 
"KRN",9.2,504,1,6,0)
  * All mail baskets in your mailbox -
"KRN",9.2,504,1,7,0)
    MailMan will look for the messages in every basket in your mailbox
"KRN",9.2,504,1,8,0)
    using the search criteria that you enter.
"KRN",9.2,504,1,9,0)
 
"KRN",9.2,504,1,10,0)
  * A specific mail basket in your mailbox -
"KRN",9.2,504,1,11,0)
    MailMan will look for the messages in a mail basket using
"KRN",9.2,504,1,12,0)
    the search criteria that you enter. 
"KRN",9.2,504,2,0)
^9.22A^5^1
"KRN",9.2,504,2,5,0)
CRITERIA^XM-U-Q-SEARCH CRITERIA
"KRN",9.2,505,-1)
0^142
"KRN",9.2,505,0)
XM-U-M-LATERED MESSAGE REPORT^REPORT ON LATERED MESSAGES^2990114.1056^^
"KRN",9.2,505,1,0)
^^21^21^2990114^^^
"KRN",9.2,505,1,1,0)
 
"KRN",9.2,505,1,2,0)
You can use the Report on Later'd Messages option available on the Other
"KRN",9.2,505,1,3,0)
MailMan Functions menu to display a list of messages that you've set to be
"KRN",9.2,505,1,4,0)
new at a future date and time ('Latered').
"KRN",9.2,505,1,5,0)
 
"KRN",9.2,505,1,6,0)
The report provides the following information:
"KRN",9.2,505,1,7,0)
 
"KRN",9.2,505,1,8,0)
  * Date - The date and time the message will be made new (i.e., 'latered'
"KRN",9.2,505,1,9,0)
    date and time).
"KRN",9.2,505,1,10,0)
 
"KRN",9.2,505,1,11,0)
  * Basket - The mailbox basket name where the 'latered' message is located.
"KRN",9.2,505,1,12,0)
 
"KRN",9.2,505,1,13,0)
  * Message - The MailMan internal message identification number of the
"KRN",9.2,505,1,14,0)
    'latered' message.
"KRN",9.2,505,1,15,0)
 
"KRN",9.2,505,1,16,0)
  * Subject - The subject of the 'latered' message.
"KRN",9.2,505,1,17,0)
 
"KRN",9.2,505,1,18,0)
To list your 'Latered' messages, choose the Report on Later'd Messages
"KRN",9.2,505,1,19,0)
option on the Other MailMan Functions menu. You can use this report to
"KRN",9.2,505,1,20,0)
decide if you want to modify any of these dates or delete any of the
"KRN",9.2,505,1,21,0)
entries using the [CHANGE]/Delete Later'd Messages option.
"KRN",9.2,505,2,0)
^9.22A^1^1
"KRN",9.2,505,2,1,0)
CHANGE^XM-U-M-LATERED MESSAGE CHANGE
"KRN",9.2,506,-1)
0^141
"KRN",9.2,506,0)
XM-U-M-LATERED MESSAGE CHANGE^CHANGE/DELETE LATERED MESSAGES^2981228.154927^
"KRN",9.2,506,1,0)
^^18^18^2981230^^
"KRN",9.2,506,1,1,0)
 
"KRN",9.2,506,1,2,0)
You can use the Change/Delete Later'd Messages option available on the
"KRN",9.2,506,1,3,0)
Other MailMan Functions menu to do the following to any message with a
"KRN",9.2,506,1,4,0)
'latered' date and time:
"KRN",9.2,506,1,5,0)
 
"KRN",9.2,506,1,6,0)
  * Change this Date - Modify the 'latered' date and time so that the
"KRN",9.2,506,1,7,0)
    message will appear as 'new' in your mailbox on that future date.
"KRN",9.2,506,1,8,0)
 
"KRN",9.2,506,1,9,0)
  * Delete this Date - Delete the 'latered' date and time so that the
"KRN",9.2,506,1,10,0)
    message will not appear as 'new' in your mailbox.
"KRN",9.2,506,1,11,0)
 
"KRN",9.2,506,1,12,0)
To change a 'Latered' date and time for a message, choose the
"KRN",9.2,506,1,13,0)
Change/Delete Later'd Messages option on the Other MailMan Functions menu
"KRN",9.2,506,1,14,0)
and then choose the 'Change this date' option.
"KRN",9.2,506,1,15,0)
 
"KRN",9.2,506,1,16,0)
To delete a 'Latered' date and time for a message, choose the
"KRN",9.2,506,1,17,0)
Change/Delete Later'd Messages option on the Other MailMan Functions menu
"KRN",9.2,506,1,18,0)
and then choose the 'Delete this date' option.
"KRN",9.2,507,-1)
0^186
"KRN",9.2,507,0)
XM-U-MO-REPLY^REPLYING TO A MESSAGE - OPTIONS AT THE 'Transmit' PROMPT^2981229.1237^^
"KRN",9.2,507,1,0)
^^9^9^2990427^
"KRN",9.2,507,1,1,0)
 
"KRN",9.2,507,1,2,0)
Enter ^ to abort the reply or press <Enter> to transmit it, or enter any
"KRN",9.2,507,1,3,0)
of the following options before transmitting your reply:
"KRN",9.2,507,1,4,0)
 
"KRN",9.2,507,1,5,0)
 [B]       Back up and read/review the original message or any responses.
"KRN",9.2,507,1,6,0)
 [E]       Edit your reply.
"KRN",9.2,507,1,7,0)
 [I]       Include the original message or any responses in your reply.
"KRN",9.2,507,1,8,0)
 [Q]       Query recipients or network header info (Q, QD, or QN).
"KRN",9.2,507,1,9,0)
 [T]       Transmit your reply now.
"KRN",9.2,507,2,0)
^9.22^5^5
"KRN",9.2,507,2,1,0)
B^XM-U-M-BACKUP
"KRN",9.2,507,2,2,0)
E^XM-U-M-EDIT TEXT
"KRN",9.2,507,2,3,0)
I^XM-U-M-REPLY INCLUDE
"KRN",9.2,507,2,4,0)
Q^XM-U-M-QUERY
"KRN",9.2,507,2,5,0)
T^XM-U-M-TRANSMIT NOW
"KRN",9.2,507,3,0)
^9.23A^1^1
"KRN",9.2,507,3,1,0)
XMJMRO
"KRN",9.2,508,-1)
0^180
"KRN",9.2,508,0)
XM-U-M-VAPORIZE DATE SEND^SET A VAPORIZE DATE WHEN SENDING A MESSAGE^2981229.114105^
"KRN",9.2,508,1,0)
^^17^17^2990121^
"KRN",9.2,508,1,1,0)
 
"KRN",9.2,508,1,2,0)
Before sending a message, you can use the Vaporize Date Set action code to
"KRN",9.2,508,1,3,0)
set a specified date and time for a message to be deleted ('vaporized')
"KRN",9.2,508,1,4,0)
from each recipient's mailbox. Thus, all senders of messages have the
"KRN",9.2,508,1,5,0)
ability to set a Vaporize Date for a message.
"KRN",9.2,508,1,6,0)
 
"KRN",9.2,508,1,7,0)
For example, set a Vaporize Date for a message, if you are sure that the
"KRN",9.2,508,1,8,0)
message is only needed until a certain date. MailMan will automatically
"KRN",9.2,508,1,9,0)
remove it from the basket it is in at that date.
"KRN",9.2,508,1,10,0)
 
"KRN",9.2,508,1,11,0)
As MailMan delivers the message with a Vaporize Date into each recipient's
"KRN",9.2,508,1,12,0)
mail basket, MailMan sets the AUTOMATIC DELETION DATE (i.e., vaporize
"KRN",9.2,508,1,13,0)
date) for the message. However, recipients are free to modify or remove
"KRN",9.2,508,1,14,0)
the AUTOMATIC DELETION DATE at any time prior to the vaporization date.
"KRN",9.2,508,1,15,0)
 
"KRN",9.2,508,1,16,0)
To set a 'Vaporize Date' for a message you are sending, enter a 'V' at the
"KRN",9.2,508,1,17,0)
'Select Message option:  Transmit now//' prompt.
"KRN",9.2,509,-1)
0^187
"KRN",9.2,509,0)
XM-U-MO-SEND^SENDING A MESSAGE - OPTIONS AT THE 'Transmit' PROMPT^3000515.0903^^
"KRN",9.2,509,1,0)
^9.21^14^14^3000515^^^
"KRN",9.2,509,1,1,0)
 
"KRN",9.2,509,1,2,0)
Enter ^ to abort the message or press <Enter> to transmit it, or enter any
"KRN",9.2,509,1,3,0)
of the following commands before sending it:
"KRN",9.2,509,1,4,0)
 
"KRN",9.2,509,1,5,0)
 [B]       Back up and review the message.
"KRN",9.2,509,1,6,0)
 [ER]      Edit the Recipients of the message.
"KRN",9.2,509,1,7,0)
 [ES]      Edit the Subject of the message.
"KRN",9.2,509,1,8,0)
 [ET]      Edit the Text of the message.
"KRN",9.2,509,1,9,0)
 [IM]      Include responses from another Message
"KRN",9.2,509,1,10,0)
 [L]       Transmit your message later.  (You'll be asked when.)
"KRN",9.2,509,1,11,0)
 [NS]      Add your network signature to the message.
"KRN",9.2,509,1,12,0)
 [T]       Transmit your message now.
"KRN",9.2,509,1,13,0)
 
"KRN",9.2,509,1,14,0)
 [MORE]...
"KRN",9.2,509,2,0)
^9.22A^18^9
"KRN",9.2,509,2,1,0)
B^XM-U-M-BACKUP BEFORE SENDING
"KRN",9.2,509,2,4,0)
ER^XM-U-M-EDIT RECIPIENTS
"KRN",9.2,509,2,5,0)
ES^XM-U-M-EDIT SUBJECT
"KRN",9.2,509,2,6,0)
ET^XM-U-M-EDIT TEXT
"KRN",9.2,509,2,8,0)
L^XM-U-M-TRANSMIT LATER
"KRN",9.2,509,2,13,0)
T^XM-U-M-TRANSMIT NOW
"KRN",9.2,509,2,16,0)
MORE^XM-U-MO-SEND-2
"KRN",9.2,509,2,17,0)
NS^XM-U-M-NETWORK SIGNATURE
"KRN",9.2,509,2,18,0)
IM^XM-U-M-INCLUDE MESSAGE
"KRN",9.2,509,3,0)
^9.23A^1^1
"KRN",9.2,509,3,1,0)
XMJMSO
"KRN",9.2,510,-1)
0^188
"KRN",9.2,510,0)
XM-U-MO-SEND-2^MORE MESSAGE OPTIONS^2990120.1312^^
"KRN",9.2,510,1,0)
^^19^19^2990427^
"KRN",9.2,510,1,1,0)
 
"KRN",9.2,510,1,2,0)
The following commands are toggles. Enter them once, and you perform the
"KRN",9.2,510,1,3,0)
associated action. Enter them again, and you undo it. If you forget what
"KRN",9.2,510,1,4,0)
state they're in (on or not), enter ? and MailMan will tell you.
"KRN",9.2,510,1,5,0)
 
"KRN",9.2,510,1,6,0)
 [C]       Make the message Confidential. (Surrogates can't read it.)
"KRN",9.2,510,1,7,0)
 [D]       Request a Delivery basket to which the message will be delivered in
"KRN",9.2,510,1,8,0)
         each recipient's Mailbox. (Whether the request is honored
"KRN",9.2,510,1,9,0)
         depends on each recipient's delivery basket privileges setting.)
"KRN",9.2,510,1,10,0)
 [I]       Make the message Information Only. (Recipients can't reply to it,
"KRN",9.2,510,1,11,0)
         but you can.)
"KRN",9.2,510,1,12,0)
 [P]       Make the message Priority. (Recipients are alerted to it.)
"KRN",9.2,510,1,13,0)
 [R]       Return receipt requested as each recipient reads the message.
"KRN",9.2,510,1,14,0)
 [S]       Scramble the text. (You'll be asked for a password and a hint.
"KRN",9.2,510,1,15,0)
         Recipients will be shown the hint and must enter the password to
"KRN",9.2,510,1,16,0)
         unscramble and read the message.)
"KRN",9.2,510,1,17,0)
 [V]       Set a date on which the message will Vaporize (be deleted) from
"KRN",9.2,510,1,18,0)
         each recipient's Mailbox. (Recipients may override.)
"KRN",9.2,510,1,19,0)
 [X]       Make the message Closed. (Recipients can't forward it, but you can.)
"KRN",9.2,510,2,0)
^9.22^8^8
"KRN",9.2,510,2,1,0)
C^XM-U-M-CONFIDENTIAL
"KRN",9.2,510,2,2,0)
D^XM-U-M-DELIVERY BASKET SET
"KRN",9.2,510,2,3,0)
I^XM-U-M-INFO ONLY
"KRN",9.2,510,2,4,0)
P^XM-U-M-PRIORITY SEND
"KRN",9.2,510,2,5,0)
R^XM-U-M-CONFIRM RECEIPT
"KRN",9.2,510,2,6,0)
S^XM-U-M-SCRAMBLE
"KRN",9.2,510,2,7,0)
V^XM-U-M-VAPORIZE DATE SEND
"KRN",9.2,510,2,8,0)
X^XM-U-M-CLOSED
"KRN",9.2,511,-1)
0^184
"KRN",9.2,511,0)
XM-U-MO-READ^READING A MESSAGE - OPTIONS^2990513.1445^^
"KRN",9.2,511,1,0)
^^19^19^2990513^^^^
"KRN",9.2,511,1,1,0)
 
"KRN",9.2,511,1,2,0)
Enter ^ to ignore the message, or enter any of the following commands:
"KRN",9.2,511,1,3,0)
 
"KRN",9.2,511,1,4,0)
 <Enter>  Accept the [DEFAULT]. (Usually Ignore, but can be Delete.)
"KRN",9.2,511,1,5,0)
 [B]        Back up to read/review from the original message or any of the
"KRN",9.2,511,1,6,0)
          responses to the end.
"KRN",9.2,511,1,7,0)
 [D]        Delete the message.
"KRN",9.2,511,1,8,0)
 [F]        Forward the message to recipients.
"KRN",9.2,511,1,9,0)
 I        Ignore the message. (Quit reading it and leave it where it is.)
"KRN",9.2,511,1,10,0)
 [L]        Later the message. (Set a date/time at which the message will
"KRN",9.2,511,1,11,0)
          be made New again.)
"KRN",9.2,511,1,12,0)
 [N]        Toggle the message New or not.
"KRN",9.2,511,1,13,0)
 [P] or [H]   Print the message with or without headers.
"KRN",9.2,511,1,14,0)
 [QUERY]    List the message's recipients and characteristics.
"KRN",9.2,511,1,15,0)
 [R] or [RI]  Reply to the message. (The other recipients will see your reply.)
"KRN",9.2,511,1,16,0)
 [S]        Save the message to another basket.
"KRN",9.2,511,1,17,0)
 [T]        Terminate the message. (Delete it and stop receiving replies.)
"KRN",9.2,511,1,18,0)
 
"KRN",9.2,511,1,19,0)
 [MORE]...
"KRN",9.2,511,2,0)
^9.22^15^14
"KRN",9.2,511,2,1,0)
B^XM-U-M-BACKUP
"KRN",9.2,511,2,2,0)
D^XM-U-M-DELETE
"KRN",9.2,511,2,3,0)
DEFAULT^XM-U-P-MESSAGE ACTION DEFAULT
"KRN",9.2,511,2,4,0)
F^XM-U-M-FORWARD
"KRN",9.2,511,2,5,0)
H^XM-U-M-PRINT NO HEADER
"KRN",9.2,511,2,7,0)
L^XM-U-M-LATER
"KRN",9.2,511,2,8,0)
MORE^XM-U-MO-READ-2
"KRN",9.2,511,2,9,0)
N^XM-U-M-NEW
"KRN",9.2,511,2,10,0)
P^XM-U-M-PRINT
"KRN",9.2,511,2,11,0)
QUERY^XM-U-M-QUERY
"KRN",9.2,511,2,12,0)
R^XM-U-M-REPLY
"KRN",9.2,511,2,13,0)
S^XM-U-M-SAVE
"KRN",9.2,511,2,14,0)
T^XM-U-M-TERMINATE
"KRN",9.2,511,2,15,0)
RI^XM-U-M-REPLY
"KRN",9.2,511,3,0)
^9.23A^1^1
"KRN",9.2,511,3,1,0)
XMJDIR
"KRN",9.2,512,-1)
0^185
"KRN",9.2,512,0)
XM-U-MO-READ-2^READING A MESSAGE - OPTIONS (CONTINUED)^3000525.0722^^
"KRN",9.2,512,1,0)
^9.21^19^19^3000525^^^^
"KRN",9.2,512,1,1,0)
 
"KRN",9.2,512,1,2,0)
 [A]        Answer the message Internet-style. (Like Reply, but only to sender.)
"KRN",9.2,512,1,3,0)
 [BR]       Print the message to the VA FileMan Browser and view it there.
"KRN",9.2,512,1,4,0)
 [C]        Copy the message and/or any of its responses to create a new message.
"KRN",9.2,512,1,5,0)
 [E]        Edit the message.
"KRN",9.2,512,1,6,0)
 [HG]       Access mail group help to get information about a mail group.
"KRN",9.2,512,1,7,0)
 [HU]       Access user help to get information about a user.
"KRN",9.2,512,1,8,0)
 [IN]       Toggle whether or not the message is Information Only.
"KRN",9.2,512,1,9,0)
          (Recipients can't reply, but you, the sender, can.)
"KRN",9.2,512,1,10,0)
 [K]        Toggle whether or not replies to a priority message are delivered
"KRN",9.2,512,1,11,0)
          to you as priority mail.
"KRN",9.2,512,1,12,0)
 [V]        Set a date on which the message should Vaporize (be deleted)
"KRN",9.2,512,1,13,0)
          from your Mailbox.
"KRN",9.2,512,1,14,0)
 [W]        Write (Send) a new message.
"KRN",9.2,512,1,15,0)
 [X]        Use PackMan options with a PackMan message.
"KRN",9.2,512,1,16,0)
 
"KRN",9.2,512,1,17,0)
Some of the commands may not be available in certain situations.
"KRN",9.2,512,1,18,0)
Enter ? to see which commands are available.
"KRN",9.2,512,1,19,0)
If you enter a command which is not available, you will be told why it isn't.
"KRN",9.2,512,2,0)
^9.22A^11^11
"KRN",9.2,512,2,1,0)
A^XM-U-M-ANSWER
"KRN",9.2,512,2,2,0)
C^XM-U-M-COPY
"KRN",9.2,512,2,3,0)
E^XM-U-MO-EDIT
"KRN",9.2,512,2,4,0)
IN^XM-U-M-INFO ONLY
"KRN",9.2,512,2,5,0)
K^XM-U-M-PRIORITY TOGGLE
"KRN",9.2,512,2,6,0)
V^XM-U-M-VAPORIZE DATE EDIT
"KRN",9.2,512,2,7,0)
W^XM-U-M-WRITE
"KRN",9.2,512,2,8,0)
X^XM-U-K-PACKMAN
"KRN",9.2,512,2,9,0)
HG^XM-U-H-GROUP
"KRN",9.2,512,2,10,0)
HU^XM-U-H-USER
"KRN",9.2,512,2,11,0)
BR^XM-U-M-BROWSER
"KRN",9.2,513,-1)
0^116
"KRN",9.2,513,0)
XM-U-M-BACKUP BEFORE SENDING^BACKUP A MESSAGE TO REVIEW BEFORE SENDING^2981229.160011^
"KRN",9.2,513,1,0)
^^7^7^2990427^
"KRN",9.2,513,1,1,0)
 
"KRN",9.2,513,1,2,0)
When sending a message, you can use the Backup action code (i.e., 'B') to
"KRN",9.2,513,1,3,0)
review a message before you send it. Based on your review, you can then
"KRN",9.2,513,1,4,0)
re-edit your message.
"KRN",9.2,513,1,5,0)
 
"KRN",9.2,513,1,6,0)
To review a message (back up) before sending it, enter a 'B' at the
"KRN",9.2,513,1,7,0)
'Select Message Option:  Transmit now//' prompt.
"KRN",9.2,514,-1)
0^183
"KRN",9.2,514,0)
XM-U-MO-EDIT^EDITING A MESSAGE^3000515.0935^^
"KRN",9.2,514,1,0)
^9.21^18^18^3000515^^^^
"KRN",9.2,514,1,1,0)
 
"KRN",9.2,514,1,2,0)
You can use the Edit action code (i.e., 'E') to edit any message created
"KRN",9.2,514,1,3,0)
by you and sent only to yourself, but not yet to other recipients.
"KRN",9.2,514,1,4,0)
Such a message is regarded as a work in progress, and still subject to change.
"KRN",9.2,514,1,5,0)
Once you send it to anyone else, or reply to it, you can no longer edit it.
"KRN",9.2,514,1,6,0)
 
"KRN",9.2,514,1,7,0)
To edit a message enter an 'E' at the 'Enter message option' prompt. You
"KRN",9.2,514,1,8,0)
can choose to edit the message as follows:
"KRN",9.2,514,1,9,0)
 
"KRN",9.2,514,1,10,0)
 [ES]        Edit the Subject of the message.
"KRN",9.2,514,1,11,0)
 [ET]        Edit the Text of the message.
"KRN",9.2,514,1,12,0)
 [IM]        Include responses from another Message
"KRN",9.2,514,1,13,0)
 [NS]        Add your Network Signature to the message.
"KRN",9.2,514,1,14,0)
 
"KRN",9.2,514,1,15,0)
 [MORE]...
"KRN",9.2,514,1,16,0)
 
"KRN",9.2,514,1,17,0)
When you complete your edits, press <Enter> to return to this menu and
"KRN",9.2,514,1,18,0)
then [FORWARD] the message to the recipients.
"KRN",9.2,514,2,0)
^9.22A^6^6
"KRN",9.2,514,2,1,0)
FORWARD^XM-U-M-FORWARD
"KRN",9.2,514,2,2,0)
MORE^XM-U-MO-SEND-2
"KRN",9.2,514,2,3,0)
ES^XM-U-M-EDIT SUBJECT
"KRN",9.2,514,2,4,0)
ET^XM-U-M-EDIT TEXT
"KRN",9.2,514,2,5,0)
NS^XM-U-M-NETWORK SIGNATURE
"KRN",9.2,514,2,6,0)
IM^XM-U-M-INCLUDE MESSAGE
"KRN",9.2,515,-1)
0^119
"KRN",9.2,515,0)
XM-U-M-CHOOSE RESPONSES^SPECIFYING A LIST OR RANGE OF RESPONSES^3000515.0906^^
"KRN",9.2,515,1,0)
^9.21^19^19^3000515^^^^
"KRN",9.2,515,1,1,0)
 
"KRN",9.2,515,1,2,0)
When you are printing or copying a message, or when you are including parts of
"KRN",9.2,515,1,3,0)
a message in a reply or a new message, MailMan allows you to specify the
"KRN",9.2,515,1,4,0)
original message and/or any combination of responses. 
"KRN",9.2,515,1,5,0)
 
"KRN",9.2,515,1,6,0)
To specify a range or list, use the following syntax:
"KRN",9.2,515,1,7,0)
 
"KRN",9.2,515,1,8,0)
  * Enter the message response numbers separated by commas (e.g., '1,5,9').
"KRN",9.2,515,1,9,0)
 
"KRN",9.2,515,1,10,0)
  * Specify a range of numbers by separating the beginning and ending numbers
"KRN",9.2,515,1,11,0)
    with a dash/hyphen (e.g., '0-10', where '0' is the original message).
"KRN",9.2,515,1,12,0)
 
"KRN",9.2,515,1,13,0)
  * Specify at what response you want MailMan to include through the remaining
"KRN",9.2,515,1,14,0)
    responses by entering a specific number followed by a dash/hyphen
"KRN",9.2,515,1,15,0)
    (e.g., 20-, MailMan would include response 20 through the remaining
"KRN",9.2,515,1,16,0)
    responses).
"KRN",9.2,515,1,17,0)
 
"KRN",9.2,515,1,18,0)
  * Specify combinations of the above by putting ranges where numbers would go,
"KRN",9.2,515,1,19,0)
    etc. (e.g., '0-3,5,8-10,20-', where '0' is the original message).
"KRN",9.2,516,-1)
0^70
"KRN",9.2,516,0)
XM-U-B-READER FULL SCREEN^FULL SCREEN MESSAGE READER^2990106.0715^^
"KRN",9.2,516,1,0)
^^16^16^2990427^
"KRN",9.2,516,1,1,0)
 
"KRN",9.2,516,1,2,0)
The Full Screen message reader enables you to read and manage messages in a
"KRN",9.2,516,1,3,0)
simulated full-screen environment. It has two levels of detail:
"KRN",9.2,516,1,4,0)
 
"KRN",9.2,516,1,5,0)
 Summary    Provides [SUMMARY] information.
"KRN",9.2,516,1,6,0)
 Detailed   Provides Summary information and additional [DETAILED] information.
"KRN",9.2,516,1,7,0)
 
"KRN",9.2,516,1,8,0)
While you are in the Full Screen message reader, you can [CHANGE DETAIL]
"KRN",9.2,516,1,9,0)
(toggle) between the Summary and Detailed displays.
"KRN",9.2,516,1,10,0)
 
"KRN",9.2,516,1,11,0)
Whereas with the Classic message reader, you must enter ? or ?? to see the
"KRN",9.2,516,1,12,0)
messages, the Full Screen message reader presents you with a screen full
"KRN",9.2,516,1,13,0)
of messages at all times, in the [ORDER] you've specified.
"KRN",9.2,516,1,14,0)
 
"KRN",9.2,516,1,15,0)
You can enter one of the [BASKET] actions, read a message and perform [MESSAGE]
"KRN",9.2,516,1,16,0)
actions on it, or [NAVIGATE] about the basket and beyond.
"KRN",9.2,516,2,0)
^9.22^7^7
"KRN",9.2,516,2,1,0)
BASKET^XM-U-BO-FULL SCREEN
"KRN",9.2,516,2,2,0)
CHANGE DETAIL^XM-U-B-CHANGE DETAIL
"KRN",9.2,516,2,3,0)
DETAILED^XM-U-B-READER DETAILED
"KRN",9.2,516,2,4,0)
MESSAGE^XM-U-MO-READ
"KRN",9.2,516,2,5,0)
NAVIGATE^XM-U-B-NAVIGATE FULL SCREEN
"KRN",9.2,516,2,6,0)
ORDER^XM-U-P-MESSAGE ORDER
"KRN",9.2,516,2,7,0)
SUMMARY^XM-U-B-READER SUMMARY
"KRN",9.2,517,-1)
0^65
"KRN",9.2,517,0)
XM-U-B-READER DETAILED^DETAILED MESSAGE INFORMATION^2981231.0818^^
"KRN",9.2,517,1,0)
^^15^15^2990108^
"KRN",9.2,517,1,1,0)
 
"KRN",9.2,517,1,2,0)
The Detailed Full Screen message reader and the Classic message reader (upon
"KRN",9.2,517,1,3,0)
entering a ??) provide, in addition to [SUMMARY] information, the following
"KRN",9.2,517,1,4,0)
detailed information for each message:
"KRN",9.2,517,1,5,0)
 
"KRN",9.2,517,1,6,0)
  * MailMan Internal Message Identification Number - The MailMan message
"KRN",9.2,517,1,7,0)
    numbers generated internally for each message (displayed in brackets).
"KRN",9.2,517,1,8,0)
 
"KRN",9.2,517,1,9,0)
  * Message Sent Date - The date each message was sent (i.e., day, month,
"KRN",9.2,517,1,10,0)
    year).
"KRN",9.2,517,1,11,0)
 
"KRN",9.2,517,1,12,0)
  * Lines - Number of lines of text for each message in the mail basket.
"KRN",9.2,517,1,13,0)
 
"KRN",9.2,517,1,14,0)
  * Read/Rcvd - Total number of responses read and received for a message.
"KRN",9.2,517,1,15,0)
    If there are no responses to a message, no totals will be indicated.
"KRN",9.2,517,2,0)
^9.22^1^1
"KRN",9.2,517,2,1,0)
SUMMARY^XM-U-B-READER SUMMARY
"KRN",9.2,518,-1)
0^71
"KRN",9.2,518,0)
XM-U-B-READER SUMMARY^SUMMARY MESSAGE INFORMATION^2981231^
"KRN",9.2,518,1,0)
^^21^21^2990108^
"KRN",9.2,518,1,1,0)
 
"KRN",9.2,518,1,2,0)
The Summary Full Screen message reader and the Classic message reader (upon
"KRN",9.2,518,1,3,0)
entering a ?) provide the following summary information:
"KRN",9.2,518,1,4,0)
 
"KRN",9.2,518,1,5,0)
  * Basket - Basket containing the messages (e.g., 'IN').
"KRN",9.2,518,1,6,0)
 
"KRN",9.2,518,1,7,0)
  * Message Totals -
"KRN",9.2,518,1,8,0)
 
"KRN",9.2,518,1,9,0)
      - How many messages in the basket.
"KRN",9.2,518,1,10,0)
      - Range of message numbers in the basket.
"KRN",9.2,518,1,11,0)
      - How many message are new in the basket.
"KRN",9.2,518,1,12,0)
 
"KRN",9.2,518,1,13,0)
  * Flags - Any special flags associated with the messages in the basket.
"KRN",9.2,518,1,14,0)
    For example: Priority (!) or New (*) flags.
"KRN",9.2,518,1,15,0)
 
"KRN",9.2,518,1,16,0)
  * Message Sequence Numbers - The numbers associated with the messages.
"KRN",9.2,518,1,17,0)
    (Meaningful only while the message remains in the basket or list.)
"KRN",9.2,518,1,18,0)
 
"KRN",9.2,518,1,19,0)
  * Subject - Subject of each message in the mail basket.
"KRN",9.2,518,1,20,0)
 
"KRN",9.2,518,1,21,0)
  * From - The name of the person who sent each message in the mail basket.
"KRN",9.2,519,-1)
0^64
"KRN",9.2,519,0)
XM-U-B-READER CLASSIC^CLASSIC MESSAGE READER^2990428.0647^^
"KRN",9.2,519,1,0)
^^15^15^2990428^^
"KRN",9.2,519,1,1,0)
 
"KRN",9.2,519,1,2,0)
The Classic message reader provides two levels of detail when listing
"KRN",9.2,519,1,3,0)
messages in a basket, depending on whether you enter one or two question marks:
"KRN",9.2,519,1,4,0)
 
"KRN",9.2,519,1,5,0)
 ?         Provides [SUMMARY] information.
"KRN",9.2,519,1,6,0)
 ??        Provides Summary information and additional [DETAILED] information.
"KRN",9.2,519,1,7,0)
 
"KRN",9.2,519,1,8,0)
The Classic message reader indicates the next message to be read in a
"KRN",9.2,519,1,9,0)
mail basket (in the [ORDER] you've specified) by displaying the basket name
"KRN",9.2,519,1,10,0)
and the message number in that basket.  Optionally, the message reader
"KRN",9.2,519,1,11,0)
will also display a [PREVIEW] of the message subject and sender.
"KRN",9.2,519,1,12,0)
 
"KRN",9.2,519,1,13,0)
At this point you can enter one or two question marks to see a message list,
"KRN",9.2,519,1,14,0)
enter one of the [BASKET] actions, read a message and perform [MESSAGE] actions
"KRN",9.2,519,1,15,0)
on it, or [NAVIGATE] about the basket and beyond.
"KRN",9.2,519,2,0)
^9.22^7^7
"KRN",9.2,519,2,1,0)
BASKET^XM-U-BO-CLASSIC
"KRN",9.2,519,2,2,0)
DETAILED^XM-U-B-READER DETAILED
"KRN",9.2,519,2,3,0)
MESSAGE^XM-U-MO-READ
"KRN",9.2,519,2,4,0)
NAVIGATE^XM-U-B-NAVIGATE CLASSIC
"KRN",9.2,519,2,5,0)
ORDER^XM-U-P-MESSAGE ORDER
"KRN",9.2,519,2,6,0)
SUMMARY^XM-U-B-READER SUMMARY
"KRN",9.2,519,2,7,0)
PREVIEW^XM-U-P-SHOW MESSAGE PREVIEW
"KRN",9.2,520,-1)
0^63
"KRN",9.2,520,0)
XM-U-B-READER^MAILMAN MESSAGE READERS^2990106.0738^^
"KRN",9.2,520,1,0)
^^15^15^2990108^
"KRN",9.2,520,1,1,0)
 
"KRN",9.2,520,1,2,0)
MailMan provides message readers for you to list, read, and manage your
"KRN",9.2,520,1,3,0)
messages when using the Read/Manage Messages option:
"KRN",9.2,520,1,4,0)
 
"KRN",9.2,520,1,5,0)
  * [CLASSIC]
"KRN",9.2,520,1,6,0)
 
"KRN",9.2,520,1,7,0)
  * [FULL SCREEN], either Detailed or Summary
"KRN",9.2,520,1,8,0)
 
"KRN",9.2,520,1,9,0)
You can set your [DEFAULT MESSAGE READER] and decide whether or not
"KRN",9.2,520,1,10,0)
MailMan should [PROMPT] you to choose a message reader whenever you read
"KRN",9.2,520,1,11,0)
messages.
"KRN",9.2,520,1,12,0)
 
"KRN",9.2,520,1,13,0)
The readers share most [BASKET] actions, which help you manage groups of
"KRN",9.2,520,1,14,0)
messages, but each reader has some actions which are unique to it. The readers
"KRN",9.2,520,1,15,0)
share the same [MESSAGE] actions, which help you manage individual messages. 
"KRN",9.2,520,2,0)
^9.22^7^6
"KRN",9.2,520,2,1,0)
BASKET^XM-U-B-READER DIFF
"KRN",9.2,520,2,2,0)
CLASSIC^XM-U-B-READER CLASSIC
"KRN",9.2,520,2,3,0)
DEFAULT MESSAGE READER^XM-U-P-READER DEFAULT
"KRN",9.2,520,2,4,0)
FULL SCREEN^XM-U-B-READER FULL SCREEN
"KRN",9.2,520,2,5,0)
MESSAGE^XM-U-MO-READ
"KRN",9.2,520,2,7,0)
PROMPT^XM-U-P-READER PROMPT
"KRN",9.2,521,-1)
0^258
"KRN",9.2,521,0)
XM-U-R-READ-2^READING AND MANAGING YOUR MAIL (CONTINUED)^2990113.1543^^
"KRN",9.2,521,1,0)
^^17^17^2990113^^
"KRN",9.2,521,1,1,0)
 
"KRN",9.2,521,1,2,0)
When reading/managing your mail, MailMan will ask you to choose the
"KRN",9.2,521,1,3,0)
following:
"KRN",9.2,521,1,4,0)
 
"KRN",9.2,521,1,5,0)
  [READER] - Optionally, MailMan may ask you to choose your message reader
"KRN",9.2,521,1,6,0)
           (i.e., Classic, Summary Full Screen, or Detailed Full
"KRN",9.2,521,1,7,0)
           Screen message readers. If you set the MESSAGE READER
"KRN",9.2,521,1,8,0)
           [PROMPT] to 'Do not ask,' MailMan will not ask for this
"KRN",9.2,521,1,9,0)
           information.
"KRN",9.2,521,1,10,0)
 
"KRN",9.2,521,1,11,0)
  [BASKET] - Choose from which basket you wish to process your mail. All
"KRN",9.2,521,1,12,0)
           users have an 'IN' basket and a 'WASTE' basket. Additionally,
"KRN",9.2,521,1,13,0)
           users may have created other 'save' baskets. When reading
"KRN",9.2,521,1,14,0)
           messages, the default is to start reading from the 'IN'
"KRN",9.2,521,1,15,0)
           basket.
"KRN",9.2,521,1,16,0)
 
"KRN",9.2,521,1,17,0)
[MORE]...
"KRN",9.2,521,2,0)
^9.22A^8^4
"KRN",9.2,521,2,4,0)
READER^XM-U-B-READER
"KRN",9.2,521,2,5,0)
BASKET^XM-U-B-BASKET SELECT
"KRN",9.2,521,2,7,0)
MORE^XM-U-R-READ-3
"KRN",9.2,521,2,8,0)
PROMPT^XM-U-P-READER PROMPT
"KRN",9.2,522,-1)
0^259
"KRN",9.2,522,0)
XM-U-R-READ-3^READING AND MANAGING YOUR MAIL (CONTINUED)^2981231.132436^^
"KRN",9.2,522,1,0)
^^18^18^2981231^
"KRN",9.2,522,1,1,0)
 
"KRN",9.2,522,1,2,0)
  [LIST]   - Using the full-screen message readers, you are presented with
"KRN",9.2,522,1,3,0)
           a list of messages, here you can choose from several options.
"KRN",9.2,522,1,4,0)
           Using the Classic message reader, MailMan will preview the
"KRN",9.2,522,1,5,0)
           message that will be read or you can enter one or two
"KRN",9.2,522,1,6,0)
           question marks to get a list of messages from which you can
"KRN",9.2,522,1,7,0)
           choose from several options.
"KRN",9.2,522,1,8,0)
 
"KRN",9.2,522,1,9,0)
  [ACTION] - After reading a message, you are prompted for a message
"KRN",9.2,522,1,10,0)
           action. Here, you can reply to the message or choose from
"KRN",9.2,522,1,11,0)
           several other options.
"KRN",9.2,522,1,12,0)
 
"KRN",9.2,522,1,13,0)
NOTE: Messages contain message [HEADERS] that are displayed prior to the
"KRN",9.2,522,1,14,0)
      text of the message.
"KRN",9.2,522,1,15,0)
 
"KRN",9.2,522,1,16,0)
      Also, you can list all messages in an individual basket or list all
"KRN",9.2,522,1,17,0)
      messages in your mailbox through the Mailbox [CONTENTS] List option
"KRN",9.2,522,1,18,0)
      on the Other MailMan Functions menu.
"KRN",9.2,522,2,0)
^9.22A^4^4
"KRN",9.2,522,2,1,0)
LIST^XM-U-B-READER DIFF
"KRN",9.2,522,2,2,0)
ACTION^XM-U-MO-READ
"KRN",9.2,522,2,3,0)
CONTENTS^XM-U-B-BASKET CONTENTS LIST
"KRN",9.2,522,2,4,0)
HEADERS^XM-U-M-MESSAGE HEADER
"KRN",9.2,523,-1)
0^168
"KRN",9.2,523,0)
XM-U-M-REPLY-2^REPLYING TO A MESSAGE (CONTINUED)^2981231.13452^
"KRN",9.2,523,1,0)
^^21^21^2990514^
"KRN",9.2,523,1,1,0)
 
"KRN",9.2,523,1,2,0)
Also, if while composing a reply to a message another reply comes in to
"KRN",9.2,523,1,3,0)
the same message, you will be prompted with the following text when
"KRN",9.2,523,1,4,0)
exiting the editor (prior to sending your reply):
"KRN",9.2,523,1,5,0)
 
"KRN",9.2,523,1,6,0)
    >> Response n has arrived - you may backup to see it. <<
"KRN",9.2,523,1,7,0)
                ^
"KRN",9.2,523,1,8,0)
                |
"KRN",9.2,523,1,9,0)
      (n = the response number)
"KRN",9.2,523,1,10,0)
 
"KRN",9.2,523,1,11,0)
When you are given the opportunity to back up to see new responses, you
"KRN",9.2,523,1,12,0)
can enter a 'B' ([BACKUP]) at the 'Select Message option:  Transmit now//'
"KRN",9.2,523,1,13,0)
prompt. The default will be to back up to this new, unseen response,
"KRN",9.2,523,1,14,0)
instead of the original message (response 0). Thus, you can back up and
"KRN",9.2,523,1,15,0)
read the latest response(s).
"KRN",9.2,523,1,16,0)
 
"KRN",9.2,523,1,17,0)
Since you haven't transmitted your response yet, you may choose to revise
"KRN",9.2,523,1,18,0)
your own reply based on that new response. You simply enter 'E' (Edit your
"KRN",9.2,523,1,19,0)
reply) at the 'Select Message option:  Transmit now//' prompt, and you are
"KRN",9.2,523,1,20,0)
put back into the editor where you can modify your reply based on what you
"KRN",9.2,523,1,21,0)
just read.
"KRN",9.2,523,2,0)
^9.22A^1^1
"KRN",9.2,523,2,1,0)
BACKUP^XM-U-M-BACKUP
"KRN",9.2,524,-1)
0^200
"KRN",9.2,524,0)
XM-U-P-FILTER CRITERIA^FILTERING MAIL CRITERIA^2990114.1325^^
"KRN",9.2,524,1,0)
^^21^21^2990427^
"KRN",9.2,524,1,1,0)
 
"KRN",9.2,524,1,2,0)
The following three criteria can be used in any combination when filtering
"KRN",9.2,524,1,3,0)
mail:
"KRN",9.2,524,1,4,0)
 
"KRN",9.2,524,1,5,0)
  * SUBJECT CONTAINS - Subject of the message. The string entered can
"KRN",9.2,524,1,6,0)
    appear anywhere in the subject.
"KRN",9.2,524,1,7,0)
 
"KRN",9.2,524,1,8,0)
  * FROM - The name of the person who sent the message (partial matching
"KRN",9.2,524,1,9,0)
    possible).
"KRN",9.2,524,1,10,0)
 
"KRN",9.2,524,1,11,0)
  * ADDRESSED TO - Addressee of the message. This includes users and mail
"KRN",9.2,524,1,12,0)
    groups. MailMan will check the addressees that you see when you
"KRN",9.2,524,1,13,0)
    [QUERY] (Q) the message.
"KRN",9.2,524,1,14,0)
 
"KRN",9.2,524,1,15,0)
For the filter to take effect, all criteria entered must be true (i.e.,
"KRN",9.2,524,1,16,0)
match the characteristics of the message). For example, if you specify the
"KRN",9.2,524,1,17,0)
'SUBJECT CONTAINS' and 'FROM,' the filter takes effect only if the subject
"KRN",9.2,524,1,18,0)
of the message contains the string you specified in the 'SUBJECT CONTAINS'
"KRN",9.2,524,1,19,0)
field and the message is from the person you specified in the 'FROM' field.
"KRN",9.2,524,1,20,0)
 
"KRN",9.2,524,1,21,0)
[MORE]...
"KRN",9.2,524,2,0)
^9.22A^2^2
"KRN",9.2,524,2,1,0)
QUERY^XM-U-M-QUERY GENERAL
"KRN",9.2,524,2,2,0)
MORE^XM-U-P-FILTER CRITERIA-2
"KRN",9.2,525,-1)
0^203
"KRN",9.2,525,0)
XM-U-P-FILTER-2^FILTERING MAIL (CONTINUED)^2981231.140839^
"KRN",9.2,525,1,0)
^^16^16^2990505^
"KRN",9.2,525,1,1,0)
 
"KRN",9.2,525,1,2,0)
In addition to setting the filtering criteria, when you want MailMan to
"KRN",9.2,525,1,3,0)
use a specific filter the following conditions must be met:
"KRN",9.2,525,1,4,0)
 
"KRN",9.2,525,1,5,0)
  * Filtering must be turned on for your mailbox.
"KRN",9.2,525,1,6,0)
 
"KRN",9.2,525,1,7,0)
  * The filter's status must be active (i.e., STATUS field).
"KRN",9.2,525,1,8,0)
 
"KRN",9.2,525,1,9,0)
  * The filter must be the first filter (i.e., controlled by the [ORDER]
"KRN",9.2,525,1,10,0)
    field) whose criteria matches the message characteristics (i.e.,
"KRN",9.2,525,1,11,0)
    subject contents, sender of the message, and/or message addressee).
"KRN",9.2,525,1,12,0)
 
"KRN",9.2,525,1,13,0)
Filtering takes place during message delivery. Filtering can also be
"KRN",9.2,525,1,14,0)
selected as a [BASKET ACTION] (i.e., FI).
"KRN",9.2,525,1,15,0)
 
"KRN",9.2,525,1,16,0)
[MORE]... 
"KRN",9.2,525,2,0)
^9.22A^3^3
"KRN",9.2,525,2,1,0)
ORDER^XM-U-P-FILTER ORDER
"KRN",9.2,525,2,2,0)
BASKET ACTION^XM-U-B-FILTER
"KRN",9.2,525,2,3,0)
MORE^XM-U-P-FILTER-3
"KRN",9.2,526,-1)
0^201
"KRN",9.2,526,0)
XM-U-P-FILTER CRITERIA-2^FILTERING MAIL CRITERIA (CONTINUED)^2981231.141918^
"KRN",9.2,526,1,0)
^^4^4^2990427^
"KRN",9.2,526,1,1,0)
 
"KRN",9.2,526,1,2,0)
If you wish the filter to take effect upon either 'SUBJECT CONTAINS' or
"KRN",9.2,526,1,3,0)
'FROM,' you must create two separate filters: one with 'SUBJECT CONTAINS'
"KRN",9.2,526,1,4,0)
and another with 'FROM' as your filter criteria.
"KRN",9.2,527,-1)
0^161
"KRN",9.2,527,0)
XM-U-M-QUERY INFO REMOTE^REMOTE USER QUERY INFORMATION^2981231.14393^
"KRN",9.2,527,1,0)
^^20^20^2981231^
"KRN",9.2,527,1,1,0)
 
"KRN",9.2,527,1,2,0)
For each remote recipient, MailMan provides the following information
"KRN",9.2,527,1,3,0)
when doing a Query:
"KRN",9.2,527,1,4,0)
 
"KRN",9.2,527,1,5,0)
  * Name - MailMan displays the name of the remote recipient.
"KRN",9.2,527,1,6,0)
 
"KRN",9.2,527,1,7,0)
  * Sent - The date and time the message was sent over the network to the
"KRN",9.2,527,1,8,0)
    remote recipient.
"KRN",9.2,527,1,9,0)
 
"KRN",9.2,527,1,10,0)
  * Time - This is the time (in seconds) it took to transmit the message
"KRN",9.2,527,1,11,0)
    over the network to the remote recipient.
"KRN",9.2,527,1,12,0)
 
"KRN",9.2,527,1,13,0)
  * Remote Message ID - If sent to a remote MailMan user, MailMan displays
"KRN",9.2,527,1,14,0)
    the internal message identification number for the message and the
"KRN",9.2,527,1,15,0)
    remote user's MailMan location. This information is not displayed when
"KRN",9.2,527,1,16,0)
    the message is sent to a non-MailMan location.
"KRN",9.2,527,1,17,0)
 
"KRN",9.2,527,1,18,0)
  * Forwarding Information - If the message was forwarded to the remote
"KRN",9.2,527,1,19,0)
    recipient, MailMan indicates the name of the person who forwarded the
"KRN",9.2,527,1,20,0)
    message and the date and time the message was forwarded.
"KRN",9.2,528,-1)
0^160
"KRN",9.2,528,0)
XM-U-M-QUERY INFO LOCAL^LOCAL USER QUERY INFORMATION^2981231.144304^
"KRN",9.2,528,1,0)
^^30^30^2990111^
"KRN",9.2,528,1,1,0)
 
"KRN",9.2,528,1,2,0)
For each local recipient, MailMan provides the following information when
"KRN",9.2,528,1,3,0)
doing a Query:
"KRN",9.2,528,1,4,0)
 
"KRN",9.2,528,1,5,0)
  * Name - MailMan displays the name of the local recipient.
"KRN",9.2,528,1,6,0)
 
"KRN",9.2,528,1,7,0)
  * Status - This indicates the current status of the message in the local
"KRN",9.2,528,1,8,0)
    recipient's mailbox. For example, if and when the recipient read the
"KRN",9.2,528,1,9,0)
    message. This includes the following information:
"KRN",9.2,528,1,10,0)
 
"KRN",9.2,528,1,11,0)
      - Not read - If the local recipient hasn't read the message, MailMan
"KRN",9.2,528,1,12,0)
        displays this message.
"KRN",9.2,528,1,13,0)
 
"KRN",9.2,528,1,14,0)
      - First read date and time - The date and time the local recipient
"KRN",9.2,528,1,15,0)
        first read the message.
"KRN",9.2,528,1,16,0)
 
"KRN",9.2,528,1,17,0)
      - Last read date and time - The date and time the local recipient
"KRN",9.2,528,1,18,0)
        last read the message. Associated with this date is the number of
"KRN",9.2,528,1,19,0)
        responses read. If the message has any responses, MailMan
"KRN",9.2,528,1,20,0)
        indicates the total number of responses read (if any).
"KRN",9.2,528,1,21,0)
 
"KRN",9.2,528,1,22,0)
      - Terminated date and time-If the local recipient has terminated the
"KRN",9.2,528,1,23,0)
        message, MailMan displays the date that they terminated the
"KRN",9.2,528,1,24,0)
        message.
"KRN",9.2,528,1,25,0)
 
"KRN",9.2,528,1,26,0)
     NOTE: MailMan also indicates when a surrogate has read a message.
"KRN",9.2,528,1,27,0)
 
"KRN",9.2,528,1,28,0)
  * Forwarding Information - If the message was forwarded to the local
"KRN",9.2,528,1,29,0)
    recipient, MailMan indicates the name of the person who forwarded the
"KRN",9.2,528,1,30,0)
    message and the date and time the message was forwarded.
"KRN",9.2,529,-1)
0^159
"KRN",9.2,529,0)
XM-U-M-QUERY INFO BASIC^BASIC QUERY INFORMATION^2981231.150607^
"KRN",9.2,529,1,0)
^^12^12^2981231^
"KRN",9.2,529,1,1,0)
 
"KRN",9.2,529,1,2,0)
When doing a query on a message, MailMan will always display the following
"KRN",9.2,529,1,3,0)
basic information about the message:
"KRN",9.2,529,1,4,0)
 
"KRN",9.2,529,1,5,0)
  * Message Header - The message header includes the 'Subject,' and 'From'
"KRN",9.2,529,1,6,0)
    information of the message.
"KRN",9.2,529,1,7,0)
 
"KRN",9.2,529,1,8,0)
  * Local Message ID - This is the MailMan internal message identification
"KRN",9.2,529,1,9,0)
    number and MailMan location.
"KRN",9.2,529,1,10,0)
 
"KRN",9.2,529,1,11,0)
  * Number of Recipients - This is the total number of recipients of the
"KRN",9.2,529,1,12,0)
    message (including the total number of members in any mail groups).
"KRN",9.2,530,-1)
0^163
"KRN",9.2,530,0)
XM-U-M-QUERY NETWORK-2^NETWORK QUERY ON A MESSAGE (CONTINUED)^2981231.151419^
"KRN",9.2,530,1,0)
^^9^9^2990427^
"KRN",9.2,530,1,1,0)
 
"KRN",9.2,530,1,2,0)
You won't notice a difference with messages from other MailMan systems.
"KRN",9.2,530,1,3,0)
However, other non-MailMan systems sometimes include clear-text names in
"KRN",9.2,530,1,4,0)
the 'From' address, in addition to the e-mail address. For example:
"KRN",9.2,530,1,5,0)
 
"KRN",9.2,530,1,6,0)
    "'Fred Smith' <fred@anydomain.com>"
"KRN",9.2,530,1,7,0)
 
"KRN",9.2,530,1,8,0)
To query a message for network and detailed recipient information, enter a
"KRN",9.2,530,1,9,0)
'QN' at the 'Enter message action' prompt.
"KRN",9.2,531,-1)
0^165
"KRN",9.2,531,0)
XM-U-M-QUERY-2^QUERYING A MESSAGE FOR ITS STATUS (CONTINUED)^3010305.1556^^
"KRN",9.2,531,1,0)
^9.21^15^15^3010305^^^^
"KRN",9.2,531,1,1,0)
 
"KRN",9.2,531,1,2,0)
  * 'QC' (Query Current) displays detailed information for each
"KRN",9.2,531,1,3,0)
    [LOCAL] recipient who is current on the message, that is,
"KRN",9.2,531,1,4,0)
    who has read the message and every response.
"KRN",9.2,531,1,5,0)

"KRN",9.2,531,1,6,0)
  * 'QNC' (Query Not Current) displays detailed information for each
"KRN",9.2,531,1,7,0)
    [LOCAL] recipient who is NOT current on the message, that is,
"KRN",9.2,531,1,8,0)
    who has NOT read the message and every response.
"KRN",9.2,531,1,9,0)

"KRN",9.2,531,1,10,0)
  * 'QT' (Query Terminated) displays detailed information for each
"KRN",9.2,531,1,11,0)
    [LOCAL] recipient who has [TERMINATED] the message.
"KRN",9.2,531,1,12,0)

"KRN",9.2,531,1,13,0)
NOTE: Since [MAIL GROUP] membership is dynamic and message recipients are
"KRN",9.2,531,1,14,0)
      resolved at the time the message is addressed, messages addressed to
"KRN",9.2,531,1,15,0)
      the same Mail Group can have different lists of recipients.
"KRN",9.2,531,2,0)
^9.22A^4^4
"KRN",9.2,531,2,1,0)
MAIL GROUP^XM-U-I-GROUP
"KRN",9.2,531,2,2,0)
LOCAL^XM-U-M-QUERY INFO LOCAL
"KRN",9.2,531,2,3,0)
TERMINATED^XM-U-M-TERMINATE
"KRN",9.2,532,-1)
0^99
"KRN",9.2,532,0)
XM-U-I-GROUP-2^MAIL GROUPS (CONTINUED)^2981231.153216^
"KRN",9.2,532,1,0)
^^20^20^2990111^
"KRN",9.2,532,1,1,0)
 
"KRN",9.2,532,1,2,0)
If a user attempts to send mail to a group that has one or more Authorized
"KRN",9.2,532,1,3,0)
Senders, and they are not one of them, they are shown a list of Authorized
"KRN",9.2,532,1,4,0)
Senders. They can send the message to one of these users who can forward
"KRN",9.2,532,1,5,0)
it to the group, if desired. Remote users cannot send mail to any local
"KRN",9.2,532,1,6,0)
group which has Authorized Senders. Any messages sent by a remote user to
"KRN",9.2,532,1,7,0)
a group with Authorized Senders will be rejected.
"KRN",9.2,532,1,8,0)
 
"KRN",9.2,532,1,9,0)
The MailMan interface provides three options to manage mail groups:
"KRN",9.2,532,1,10,0)
 
"KRN",9.2,532,1,11,0)
  * Help (User/Group Info., etc.) - Use this option to get [INFORMATION]
"KRN",9.2,532,1,12,0)
    on mail groups. This option is located on the main MailMan Menu.
"KRN",9.2,532,1,13,0)
 
"KRN",9.2,532,1,14,0)
  * Enroll in (or Disenroll from) a Mail Group - Use this option to enroll
"KRN",9.2,532,1,15,0)
    in or disenroll from [PUBLIC] mail groups. This option is located on
"KRN",9.2,532,1,16,0)
    the Personal Preferences menu.
"KRN",9.2,532,1,17,0)
 
"KRN",9.2,532,1,18,0)
  * Personal Mail Group Edit - Use this option to create your own
"KRN",9.2,532,1,19,0)
    [PERSONAL] (Private) mail groups. This option is located on the
"KRN",9.2,532,1,20,0)
    Personal Preferences menu.
"KRN",9.2,532,2,0)
^9.22A^3^3
"KRN",9.2,532,2,1,0)
INFORMATION^XM-U-H-GROUP
"KRN",9.2,532,2,2,0)
PERSONAL^XM-U-P-GROUP PERSONAL
"KRN",9.2,532,2,3,0)
PUBLIC^XM-U-P-GROUP ENROLL
"KRN",9.2,533,-1)
0^206
"KRN",9.2,533,0)
XM-U-P-GROUP ENROLL^PUBLIC MAIL GROUPS^3010213.1003^
"KRN",9.2,533,1,0)
^9.21^20^20^3010213^^
"KRN",9.2,533,1,1,0)
 
"KRN",9.2,533,1,2,0)
MailMan gives you the opportunity to enroll in Public mail groups using
"KRN",9.2,533,1,3,0)
the Enroll in (or Disenroll from) a Mail Group option. You can also remove
"KRN",9.2,533,1,4,0)
yourself (disenroll) from mail groups using the same option. The operation
"KRN",9.2,533,1,5,0)
of this option depends on your current membership status and the
"KRN",9.2,533,1,6,0)
enrollment capability of the mail group:
"KRN",9.2,533,1,7,0)
 
"KRN",9.2,533,1,8,0)
  * Enrolling - If you are not a member of a particular mail group and the
"KRN",9.2,533,1,9,0)
    mail group allows self-enrollment, MailMan will enroll you as a member
"KRN",9.2,533,1,10,0)
    in that mail group when you use the Enroll in (or Disenroll from) a
"KRN",9.2,533,1,11,0)
    Mail Group option.
"KRN",9.2,533,1,12,0)
 
"KRN",9.2,533,1,13,0)
  * Disenrolling - If you already are a member of a particular mail group
"KRN",9.2,533,1,14,0)
    and the mail group allows self-enrollment, MailMan will confirm your
"KRN",9.2,533,1,15,0)
    membership and ask you if you want to disenroll yourself from the mail
"KRN",9.2,533,1,16,0)
    group when you use the Enroll in (or Disenroll from) a Mail Group option.
"KRN",9.2,533,1,17,0)
    Note: Depending on the site, you may be able to disenroll from a non-
"KRN",9.2,533,1,18,0)
    self-enrolling group.  (This is controlled by field 22 in file 4.3.)
"KRN",9.2,533,1,19,0)
 
"KRN",9.2,533,1,20,0)
[MORE]...
"KRN",9.2,533,2,0)
^9.22A^1^1
"KRN",9.2,533,2,1,0)
MORE^XM-U-P-GROUP ENROLL-2
"KRN",9.2,534,-1)
0^207
"KRN",9.2,534,0)
XM-U-P-GROUP ENROLL-2^PUBLIC MAIL GROUPS (CONTINUED)^3010213.1016^^
"KRN",9.2,534,1,0)
^9.21^8^8^3010213^^
"KRN",9.2,534,1,1,0)
 
"KRN",9.2,534,1,2,0)
If you are not able to enroll in or disenroll from a mail group,
"KRN",9.2,534,1,3,0)
and you think you need to, you should contact the Mail Group
"KRN",9.2,534,1,4,0)
[COORDINATOR] or Organizer for that mail group and ask
"KRN",9.2,534,1,5,0)
either to be enrolled in or disenrolled from the mail group.
"KRN",9.2,534,1,6,0)
(You can find out who they are by doing a mail group [INQUIRY].)
"KRN",9.2,534,1,7,0)

"KRN",9.2,534,1,8,0)
Your last resort is to contact IRM, or a CAC or ADPAC.
"KRN",9.2,534,2,0)
^9.22A^2^2
"KRN",9.2,534,2,1,0)
COORDINATOR^XM-U-I-GROUP COORDINATOR
"KRN",9.2,534,2,2,0)
INQUIRY^XM-U-H-GROUP
"KRN",9.2,535,-1)
0^208
"KRN",9.2,535,0)
XM-U-P-GROUP PERSONAL^PERSONAL MAIL GROUPS^3010213.0916^^
"KRN",9.2,535,1,0)
^9.21^21^21^3010213^^^^
"KRN",9.2,535,1,1,0)
 
"KRN",9.2,535,1,2,0)
Personal, or Private, mail groups are ones that you create and maintain for
"KRN",9.2,535,1,3,0)
your own use, and, possibly, the use of its local members.
"KRN",9.2,535,1,4,0)

"KRN",9.2,535,1,5,0)
If the 'Restrictions' field is set to 'Organizer only', then only the creator
"KRN",9.2,535,1,6,0)
of the mail group (i.e., Organizer) can address and send mail to the group.
"KRN",9.2,535,1,7,0)

"KRN",9.2,535,1,8,0)
If the 'Restrictions' field is set to 'Unrestricted' or null, then both the
"KRN",9.2,535,1,9,0)
creator of the mail group (i.e., Organizer) and its local members can address
"KRN",9.2,535,1,10,0)
and send mail to the group.
"KRN",9.2,535,1,11,0)

"KRN",9.2,535,1,12,0)
Non-members can neither see nor address Private or Personal mail groups.
"KRN",9.2,535,1,13,0)
The creator (i.e., Organizer) and members of the personal mail group can: 
"KRN",9.2,535,1,14,0)
 
"KRN",9.2,535,1,15,0)
  * Display Information - Use the Group [INFORMATION] option on the Help
"KRN",9.2,535,1,16,0)
    (User/Group Info., etc.) menu to display information on that group.
"KRN",9.2,535,1,17,0)
 
"KRN",9.2,535,1,18,0)
  * List the Group - See the group listed  when you enter two question
"KRN",9.2,535,1,19,0)
    marks (i.e., online help) at the 'Select MAIL GROUP NAME:' prompt.
"KRN",9.2,535,1,20,0)
 
"KRN",9.2,535,1,21,0)
[MORE]... 
"KRN",9.2,535,2,0)
^9.22A^2^2
"KRN",9.2,535,2,1,0)
MORE^XM-U-P-GROUP PERSONAL-2
"KRN",9.2,535,2,2,0)
INFORMATION^XM-U-H-GROUP
"KRN",9.2,536,-1)
0^81
"KRN",9.2,536,0)
XM-U-H-GROUP^MAIL GROUP INFORMATION^2990120.1146^^
"KRN",9.2,536,1,0)
^^21^21^2990120^^
"KRN",9.2,536,1,1,0)
 
"KRN",9.2,536,1,2,0)
MailMan gives you the opportunity to obtain information on a mail group
"KRN",9.2,536,1,3,0)
through the Group Information option on the Help (User/Group Info., etc.)
"KRN",9.2,536,1,4,0)
menu option located on the main MailMan Menu.
"KRN",9.2,536,1,5,0)
 
"KRN",9.2,536,1,6,0)
You can obtain the following mail group information:
"KRN",9.2,536,1,7,0)
 
"KRN",9.2,536,1,8,0)
  * Name - The name of the mail group.
"KRN",9.2,536,1,9,0)
 
"KRN",9.2,536,1,10,0)
  * Type - The type of mail group determines who can send mail to it.
"KRN",9.2,536,1,11,0)
    Mail groups can be either of the following two types:
"KRN",9.2,536,1,12,0)
 
"KRN",9.2,536,1,13,0)
      - Public
"KRN",9.2,536,1,14,0)
      - Private ([PERSONAL])
"KRN",9.2,536,1,15,0)
 
"KRN",9.2,536,1,16,0)
    Provided there are no Authorized Senders specified, anyone can send
"KRN",9.2,536,1,17,0)
    mail to a public group and only its members can send mail to a private
"KRN",9.2,536,1,18,0)
    group. If there are Authorized Senders specified, only those users can
"KRN",9.2,536,1,19,0)
    address the group.
"KRN",9.2,536,1,20,0)
 
"KRN",9.2,536,1,21,0)
[MORE]... 
"KRN",9.2,536,2,0)
^9.22A^2^2
"KRN",9.2,536,2,1,0)
MORE^XM-U-H-GROUP-2
"KRN",9.2,536,2,2,0)
PERSONAL^XM-U-P-GROUP PERSONAL
"KRN",9.2,537,-1)
0^82
"KRN",9.2,537,0)
XM-U-H-GROUP-2^MAIL GROUP INFORMATION (CONTINUED)^3010212.1539^
"KRN",9.2,537,1,0)
^9.21^20^20^3010212^^^^
"KRN",9.2,537,1,1,0)
 
"KRN",9.2,537,1,2,0)
  * Allow Self-Enrollment? - This field is only applicable to PUBLIC mail
"KRN",9.2,537,1,3,0)
    groups.  Is self-enrollment allowed ('Yes' or 'No')?
"KRN",9.2,537,1,4,0)
    If 'Yes', you can enroll yourself in or disenroll yourself from a mail
"KRN",9.2,537,1,5,0)
    group. If 'No' or null, you must contact the Coordinator or Organizer
"KRN",9.2,537,1,6,0)
    of the mail group to either enroll you in or disenroll you from the group.
"KRN",9.2,537,1,7,0)
    Note: Depending on the site, you may be able to disenroll from a non-
"KRN",9.2,537,1,8,0)
    self-enrolling group.  (This is controlled by field 22 in file 4.3.)
"KRN",9.2,537,1,9,0)
 
"KRN",9.2,537,1,10,0)
  * Restrictions - This field is only applicable to PRIVATE mail groups.
"KRN",9.2,537,1,11,0)
    It provides the opportunity for the Organizer of the mail group to
"KRN",9.2,537,1,12,0)
    decide who may address (send messages to) this PRIVATE mail group.
"KRN",9.2,537,1,13,0)
    If 0 (zero) or null, then the group is unrestricted, and all members
"KRN",9.2,537,1,14,0)
    may address the group.  If 1, then only the organizer may address
"KRN",9.2,537,1,15,0)
    the group, and the group becomes a personal group.
"KRN",9.2,537,1,16,0)

"KRN",9.2,537,1,17,0)
  * Reference Count - How many times the mail group has been referenced
"KRN",9.2,537,1,18,0)
    (used).
"KRN",9.2,537,1,19,0)
 
"KRN",9.2,537,1,20,0)
[MORE]... 
"KRN",9.2,537,2,0)
^9.22A^2^1
"KRN",9.2,537,2,2,0)
MORE^XM-U-H-GROUP-3
"KRN",9.2,538,-1)
0^83
"KRN",9.2,538,0)
XM-U-H-GROUP-3^MAIL GROUP INFORMATION (CONTINUED)^3010208.1144^^
"KRN",9.2,538,1,0)
^9.21^20^20^3010208^^^^
"KRN",9.2,538,1,1,0)
 
"KRN",9.2,538,1,2,0)
  * Last Referenced - The last date and time this group was referenced
"KRN",9.2,538,1,3,0)
    (sent a message).
"KRN",9.2,538,1,4,0)
 
"KRN",9.2,538,1,5,0)
  * [COORDINATOR] - The person responsible for maintaining the membership
"KRN",9.2,538,1,6,0)
    of the mail group. 
"KRN",9.2,538,1,7,0)
 
"KRN",9.2,538,1,8,0)
  * Description - Description of the mail group.
"KRN",9.2,538,1,9,0)
 
"KRN",9.2,538,1,10,0)
  * Organizer - The organizer is the person who set up/created the mail
"KRN",9.2,538,1,11,0)
    group. An Organizer can add new members to a [PRIVATE] mail group.
"KRN",9.2,538,1,12,0)
 
"KRN",9.2,538,1,13,0)
  * Authorized Senders - Authorized Senders are the only users that are
"KRN",9.2,538,1,14,0)
    allowed to send mail to the mail group. If unspecified, it is assumed
"KRN",9.2,538,1,15,0)
    that anyone can send mail to the group, if [PUBLIC], or only members
"KRN",9.2,538,1,16,0)
    can send to it, if [PRIVATE]. Remote users cannot send mail to any
"KRN",9.2,538,1,17,0)
    local group which has Authorized Senders. Any messages sent by a
"KRN",9.2,538,1,18,0)
    remote user to a group with Authorized Senders will be rejected.
"KRN",9.2,538,1,19,0)
 
"KRN",9.2,538,1,20,0)
[MORE]... 
"KRN",9.2,538,2,0)
^9.22A^4^4
"KRN",9.2,538,2,1,0)
MORE^XM-U-H-GROUP-4
"KRN",9.2,538,2,2,0)
COORDINATOR^XM-U-I-GROUP COORDINATOR
"KRN",9.2,538,2,3,0)
PRIVATE^XM-U-P-GROUP PERSONAL
"KRN",9.2,538,2,4,0)
PUBLIC^XM-U-P-GROUP ENROLL
"KRN",9.2,539,-1)
0^47
"KRN",9.2,539,0)
XM-U-A-GROUP LARGE-2^ADDRESSING MAIL TO LARGE MAIL GROUPS (CONTINUED)^2981231.160231^
"KRN",9.2,539,1,0)
^^21^21^2981231^
"KRN",9.2,539,1,1,0)
 
"KRN",9.2,539,1,2,0)
If you need to selectively remove (minus) members from the group, you
"KRN",9.2,539,1,3,0)
should not 'later' the delivery of the message to that group.
"KRN",9.2,539,1,4,0)
 
"KRN",9.2,539,1,5,0)
If the total number of members in a mail group is equal to or greater than
"KRN",9.2,539,1,6,0)
the value in the [BIG GROUP SIZE] field, the mail group is considered to
"KRN",9.2,539,1,7,0)
be a 'large' mail group and treated accordingly. Conversely, if the total
"KRN",9.2,539,1,8,0)
number of members in a mail group are less than this number, they will be
"KRN",9.2,539,1,9,0)
treated as 'small-' to 'medium-sized' mail groups and processed in the
"KRN",9.2,539,1,10,0)
foreground as usual.
"KRN",9.2,539,1,11,0)
 
"KRN",9.2,539,1,12,0)
For example, let's assume that IRM set our [BIG GROUP SIZE] field to 100.
"KRN",9.2,539,1,13,0)
If we were to address a message to a mail group with 100 or more members,
"KRN",9.2,539,1,14,0)
it would be considered a 'large' mail group and MailMan would ask us if we
"KRN",9.2,539,1,15,0)
wanted to 'later' delivery to this group. Conversely, any mail addressed
"KRN",9.2,539,1,16,0)
to a mail group whose total number of members was less than 100 would be
"KRN",9.2,539,1,17,0)
considered a 'small-' to 'medium-sized' group and MailMan would not ask us
"KRN",9.2,539,1,18,0)
if we wanted to deliver the message at a later date and time.
"KRN",9.2,539,1,19,0)
 
"KRN",9.2,539,1,20,0)
NOTE: A mail group is also considered large if it contains another mail
"KRN",9.2,539,1,21,0)
      group or a distribution list.
"KRN",9.2,539,2,0)
^9.22A^1^1
"KRN",9.2,539,2,1,0)
BIG GROUP SIZE^XM-I-S-BIG GROUP SIZE
"KRN",9.2,540,-1)
0^182
"KRN",9.2,540,0)
XM-U-M-WRITE-2^SENDING A NEW MESSAGE INSTEAD OF A REPLY (CONTINUED)^2990106.143836^
"KRN",9.2,540,1,0)
^^4^4^2990106^
"KRN",9.2,540,1,1,0)
 
"KRN",9.2,540,1,2,0)
Thus, don't use 'Me too's,' Write a new message. Save the many recipients
"KRN",9.2,540,1,3,0)
the time of having to read responses that are only intended for the sender
"KRN",9.2,540,1,4,0)
or a subset of recipients. 
"KRN",9.2,541,-1)
0^135
"KRN",9.2,541,0)
XM-U-M-FORWARD-2^FORWARDING MESSAGES (CONTINUED)^2990114.1053^^
"KRN",9.2,541,1,0)
^^17^17^2990427^
"KRN",9.2,541,1,1,0)
 
"KRN",9.2,541,1,2,0)
The Forward action code allows you to forward individual messages or a
"KRN",9.2,541,1,3,0)
group of messages in a mail basket:
"KRN",9.2,541,1,4,0)
 
"KRN",9.2,541,1,5,0)
  * Individually - After reading a message, enter an 'F' at the 'Enter
"KRN",9.2,541,1,6,0)
    message action' prompt. MailMan will ask to whom you wish to forward
"KRN",9.2,541,1,7,0)
    the message.
"KRN",9.2,541,1,8,0)
 
"KRN",9.2,541,1,9,0)
  * Group of Messages - Enter an 'F' at the basket option or command
"KRN",9.2,541,1,10,0)
    prompt.
"KRN",9.2,541,1,11,0)
 
"KRN",9.2,541,1,12,0)
      - MailMan will first ask you to select which messages you want to
"KRN",9.2,541,1,13,0)
        forward, including a [RANGE] of messages. Also, if you are using a
"KRN",9.2,541,1,14,0)
        full-screen reader, you can pre-[SELECT] messages and then forward
"KRN",9.2,541,1,15,0)
        them as a group.
"KRN",9.2,541,1,16,0)
 
"KRN",9.2,541,1,17,0)
      - MailMan will then ask to whom you wish to forward the messages.
"KRN",9.2,541,2,0)
^9.22^3^2
"KRN",9.2,541,2,1,0)
RANGE^XM-U-M-CHOOSE RANGE
"KRN",9.2,541,2,3,0)
SELECT^XM-U-M-CHOOSE SELECT
"KRN",9.2,544,-1)
0^153
"KRN",9.2,544,0)
XM-U-M-PRINT-2^PRINTING MESSAGES (CONTINUED)^2990120.0936^^
"KRN",9.2,544,1,0)
^^18^18^2990120^^^
"KRN",9.2,544,1,1,0)
 
"KRN",9.2,544,1,2,0)
  * Printing a Group of Messages - Enter a 'P' at the basket option or
"KRN",9.2,544,1,3,0)
    command prompt.
"KRN",9.2,544,1,4,0)
 
"KRN",9.2,544,1,5,0)
      - MailMan will first ask you to select which messages you want to
"KRN",9.2,544,1,6,0)
        print, including a [RANGE] of messages. Also, if you are using a
"KRN",9.2,544,1,7,0)
        full-screen reader, you can pre-[SELECT] messages and then print
"KRN",9.2,544,1,8,0)
        them as a group.
"KRN",9.2,544,1,9,0)
 
"KRN",9.2,544,1,10,0)
      - MailMan will then ask if you want to print a recipient list. If
"KRN",9.2,544,1,11,0)
        you choose to print recipients, you can print either a summary or
"KRN",9.2,544,1,12,0)
        detailed recipient list.
"KRN",9.2,544,1,13,0)
 
"KRN",9.2,544,1,14,0)
When your entries are complete, MailMan will ask you to select the device
"KRN",9.2,544,1,15,0)
to which you wish to print.
"KRN",9.2,544,1,16,0)
 
"KRN",9.2,544,1,17,0)
Unlike the [HEADERLESS] Print Messages action code, the Print Messages
"KRN",9.2,544,1,18,0)
action code will print the [PRINT] header and the [MESSAGE] header.
"KRN",9.2,544,2,0)
^9.22^6^5
"KRN",9.2,544,2,1,0)
RANGE^XM-U-M-CHOOSE RANGE
"KRN",9.2,544,2,3,0)
HEADERLESS^XM-U-M-PRINT NO HEADER
"KRN",9.2,544,2,4,0)
SELECT^XM-U-M-CHOOSE SELECT
"KRN",9.2,544,2,5,0)
MESSAGE^XM-U-M-MESSAGE HEADER
"KRN",9.2,544,2,6,0)
PRINT^XM-U-M-PRINT HEADER
"KRN",9.2,545,-1)
0^151
"KRN",9.2,545,0)
XM-U-M-PRINT NO HEADER-2^HEADERLESS PRINTING (CONTINUED)^2990120.0952^^
"KRN",9.2,545,1,0)
^^18^18^2990120^^^
"KRN",9.2,545,1,1,0)
 
"KRN",9.2,545,1,2,0)
  * Printing a group of Messages - Enter an 'H' at the basket option or
"KRN",9.2,545,1,3,0)
    command prompt.
"KRN",9.2,545,1,4,0)
 
"KRN",9.2,545,1,5,0)
      - MailMan will first ask you to select which messages you want to
"KRN",9.2,545,1,6,0)
        print, including a [RANGE] of messages. Also, if you are using a
"KRN",9.2,545,1,7,0)
        full-screen reader, you can pre-[SELECT] messages and then print
"KRN",9.2,545,1,8,0)
        them as a group.
"KRN",9.2,545,1,9,0)
 
"KRN",9.2,545,1,10,0)
      - MailMan will then ask if you want to print a recipient list. If
"KRN",9.2,545,1,11,0)
        you choose to print recipients, you can print either a summary or
"KRN",9.2,545,1,12,0)
        detailed recipient list.
"KRN",9.2,545,1,13,0)
 
"KRN",9.2,545,1,14,0)
When your entries are complete, MailMan will ask you to select the device
"KRN",9.2,545,1,15,0)
to which you wish to print. 
"KRN",9.2,545,1,16,0)
 
"KRN",9.2,545,1,17,0)
Unlike the [PRINT] Messages action code, the Headerless Print Messages
"KRN",9.2,545,1,18,0)
action code will NOT print the print [HEADER] and the [MESSAGE] header.
"KRN",9.2,545,2,0)
^9.22^8^5
"KRN",9.2,545,2,1,0)
RANGE^XM-U-M-CHOOSE RANGE
"KRN",9.2,545,2,4,0)
SELECT^XM-U-M-CHOOSE SELECT
"KRN",9.2,545,2,6,0)
MESSAGE^XM-U-M-MESSAGE HEADER
"KRN",9.2,545,2,7,0)
PRINT^XM-U-M-PRINT
"KRN",9.2,545,2,8,0)
HEADER^XM-U-M-PRINT HEADER
"KRN",9.2,547,-1)
0^175
"KRN",9.2,547,0)
XM-U-M-TERMINATE-2^TERMINATING MESSAGES (CONTINUED)^2990114.1102^^
"KRN",9.2,547,1,0)
^^15^15^2990427^
"KRN",9.2,547,1,1,0)
 
"KRN",9.2,547,1,2,0)
To terminate messages, do the following:
"KRN",9.2,547,1,3,0)
 
"KRN",9.2,547,1,4,0)
  * Individually - After reading a message, enter a 'T' at the 'Enter
"KRN",9.2,547,1,5,0)
    message action' prompt. MailMan will terminate the message.
"KRN",9.2,547,1,6,0)
 
"KRN",9.2,547,1,7,0)
  * Group of Messages - Enter a 'T' at the basket option or command
"KRN",9.2,547,1,8,0)
    prompt.
"KRN",9.2,547,1,9,0)
 
"KRN",9.2,547,1,10,0)
      - MailMan will first ask you to select which messages you want to
"KRN",9.2,547,1,11,0)
        terminate, including a [RANGE] of messages. Also, if you are using
"KRN",9.2,547,1,12,0)
        a full-screen reader, you can pre-[SELECT] messages and then
"KRN",9.2,547,1,13,0)
        terminate them as a group.
"KRN",9.2,547,1,14,0)
 
"KRN",9.2,547,1,15,0)
      - MailMan will then ask you to confirm the termination.
"KRN",9.2,547,2,0)
^9.22^3^2
"KRN",9.2,547,2,1,0)
RANGE^XM-U-M-CHOOSE RANGE
"KRN",9.2,547,2,3,0)
SELECT^XM-U-M-CHOOSE SELECT
"KRN",9.2,548,-1)
0^139
"KRN",9.2,548,0)
XM-U-M-LATER-2^MAKE MESSAGES NEW LATER (CONTINUED)^2990106.160357^
"KRN",9.2,548,1,0)
^^18^18^2990427^
"KRN",9.2,548,1,1,0)
 
"KRN",9.2,548,1,2,0)
To 'later' individual messages, do the following:
"KRN",9.2,548,1,3,0)
 
"KRN",9.2,548,1,4,0)
  * After reading a message, enter an 'L' at the 'Enter message action'
"KRN",9.2,548,1,5,0)
    prompt. MailMan will then ask you to enter the date and time at which
"KRN",9.2,548,1,6,0)
    you want the message made 'new' again (i.e., 'latered').
"KRN",9.2,548,1,7,0)
 
"KRN",9.2,548,1,8,0)
  * If you later an individual message and then try to later the same
"KRN",9.2,548,1,9,0)
    message again, MailMan will notify you that the message has already
"KRN",9.2,548,1,10,0)
    been 'latered' and then gives you the chance to:
"KRN",9.2,548,1,11,0)
 
"KRN",9.2,548,1,12,0)
      - Add another 'Later' date on which this message should appear new.
"KRN",9.2,548,1,13,0)
 
"KRN",9.2,548,1,14,0)
      - Change the current 'Later' date.
"KRN",9.2,548,1,15,0)
 
"KRN",9.2,548,1,16,0)
      - Delete the current 'Later' date.
"KRN",9.2,548,1,17,0)
 
"KRN",9.2,548,1,18,0)
[MORE]...
"KRN",9.2,548,2,0)
^9.22A^1^1
"KRN",9.2,548,2,1,0)
MORE^XM-U-M-LATER-3
"KRN",9.2,549,-1)
0^140
"KRN",9.2,549,0)
XM-U-M-LATER-3^MAKE MESSAGES NEW LATER (CONTINUED)^2990114.1058^^
"KRN",9.2,549,1,0)
^^12^12^2990427^
"KRN",9.2,549,1,1,0)
 
"KRN",9.2,549,1,2,0)
To 'later' a group of messages, do the following:
"KRN",9.2,549,1,3,0)
 
"KRN",9.2,549,1,4,0)
  * Enter an 'L' at the basket option or command prompt.
"KRN",9.2,549,1,5,0)
 
"KRN",9.2,549,1,6,0)
      - MailMan will first ask you to select which messages you want to
"KRN",9.2,549,1,7,0)
        'later,' including a [RANGE] of messages. Also, if you are using
"KRN",9.2,549,1,8,0)
        a full-screen reader, you can pre-[SELECT] messages and then
"KRN",9.2,549,1,9,0)
        'later' them as a group.
"KRN",9.2,549,1,10,0)
 
"KRN",9.2,549,1,11,0)
      - MailMan will then ask you to enter the date and time at which you
"KRN",9.2,549,1,12,0)
        want the messages made 'new' again (i.e., 'latered').
"KRN",9.2,549,2,0)
^9.22^3^2
"KRN",9.2,549,2,1,0)
RANGE^XM-U-M-CHOOSE RANGE
"KRN",9.2,549,2,3,0)
SELECT^XM-U-M-CHOOSE SELECT
"KRN",9.2,550,-1)
0^128
"KRN",9.2,550,0)
XM-U-M-DELETE-2^DELETING MESSAGES (CONTINUED)^2990114.105^^
"KRN",9.2,550,1,0)
^^21^21^2990427^
"KRN",9.2,550,1,1,0)
 
"KRN",9.2,550,1,2,0)
The user can also retrieve deleted mail from the 'WASTE' basket by reading
"KRN",9.2,550,1,3,0)
it, just like any other basket. If you want to keep the message, you can
"KRN",9.2,550,1,4,0)
[SAVE] it to another basket.
"KRN",9.2,550,1,5,0)
 
"KRN",9.2,550,1,6,0)
To delete messages, do the following:
"KRN",9.2,550,1,7,0)
 
"KRN",9.2,550,1,8,0)
  * Individually - After reading a message, enter a 'D' at the 'Enter
"KRN",9.2,550,1,9,0)
    message action' prompt. MailMan will delete the message.
"KRN",9.2,550,1,10,0)
 
"KRN",9.2,550,1,11,0)
  * Group of Messages - Enter a 'D' at the basket option or command
"KRN",9.2,550,1,12,0)
    prompt.
"KRN",9.2,550,1,13,0)
 
"KRN",9.2,550,1,14,0)
      - MailMan will first ask you to select which messages you want to
"KRN",9.2,550,1,15,0)
        delete, including a [RANGE] of messages. Also, if you are using a
"KRN",9.2,550,1,16,0)
        full-screen reader, you can pre-[SELECT] messages and then delete
"KRN",9.2,550,1,17,0)
        them as a group.
"KRN",9.2,550,1,18,0)
 
"KRN",9.2,550,1,19,0)
      - MailMan will then ask you to confirm the deletion.
"KRN",9.2,550,1,20,0)
 
"KRN",9.2,550,1,21,0)
[MORE]...
"KRN",9.2,550,2,0)
^9.22A^5^4
"KRN",9.2,550,2,1,0)
MORE^XM-U-M-DELETE-3
"KRN",9.2,550,2,3,0)
RANGE^XM-U-M-CHOOSE RANGE
"KRN",9.2,550,2,4,0)
SAVE^XM-U-M-SAVE
"KRN",9.2,550,2,5,0)
SELECT^XM-U-M-CHOOSE SELECT
"KRN",9.2,551,-1)
0^129
"KRN",9.2,551,0)
XM-U-M-DELETE-3^DELETING MESSAGES (CONTINUED)^2990106.162414^
"KRN",9.2,551,1,0)
^^4^4^2990427^
"KRN",9.2,551,1,1,0)
 
"KRN",9.2,551,1,2,0)
When all messages have been deleted from a basket, MailMan will ask you if
"KRN",9.2,551,1,3,0)
the entire basket may be eliminated. If you don't want to retain this
"KRN",9.2,551,1,4,0)
empty basket in your mailbox, answer 'YES' to this prompt.
"KRN",9.2,552,-1)
0^103
"KRN",9.2,552,0)
XM-U-I-SURROGATE-2^MAILMAN SURROGATES (CONTINUED)^2990107.08154^
"KRN",9.2,552,1,0)
^^15^15^2990107^
"KRN",9.2,552,1,1,0)
 
"KRN",9.2,552,1,2,0)
The MailMan interface provides two options with regards to surrogates:
"KRN",9.2,552,1,3,0)
 
"KRN",9.2,552,1,4,0)
  * [BECOME A SURROGATE] (SHARED,MAIL or Other) - Use this option to act
"KRN",9.2,552,1,5,0)
    as a surrogate for SHARED,MAIL or another MailMan user.
"KRN",9.2,552,1,6,0)
 
"KRN",9.2,552,1,7,0)
  * [SURROGATE EDIT] - Use this option to select another user to act as
"KRN",9.2,552,1,8,0)
    your surrogate. Those assigned to as surrogates may have [READ] and
"KRN",9.2,552,1,9,0)
    [WRITE] access assigned to them. Thus, they have the ability to assume
"KRN",9.2,552,1,10,0)
    your identity for the purpose of reading and/or sending mail.
"KRN",9.2,552,1,11,0)
 
"KRN",9.2,552,1,12,0)
The MailMan surrogate options are available on the main MailMan Menu and
"KRN",9.2,552,1,13,0)
the Personal Preferences menu.
"KRN",9.2,552,1,14,0)
 
"KRN",9.2,552,1,15,0)
[MORE]... 
"KRN",9.2,552,2,0)
^9.22A^6^5
"KRN",9.2,552,2,1,0)
MORE^XM-U-I-SURROGATE-3
"KRN",9.2,552,2,3,0)
SURROGATE EDIT^XM-U-P-SURROGATE EDIT
"KRN",9.2,552,2,4,0)
BECOME A SURROGATE^XM-U-I-SURROGATE BECOME
"KRN",9.2,552,2,5,0)
READ^XM-U-P-SURROGATE READ PRIV
"KRN",9.2,552,2,6,0)
WRITE^XM-U-P-SURROGATE WRITE PRIV
"KRN",9.2,553,-1)
0^104
"KRN",9.2,553,0)
XM-U-I-SURROGATE-3^MAILMAN SURROGATES (CONTINUED)^2990107.090335^
"KRN",9.2,553,1,0)
^^18^18^2990107^
"KRN",9.2,553,1,1,0)
 
"KRN",9.2,553,1,2,0)
You can [BECOME] (act as) a surrogate in two different ways:
"KRN",9.2,553,1,3,0)
 
"KRN",9.2,553,1,4,0)
  1. Other Surrogate - Act as a surrogate for another user (i.e., Other)
"KRN",9.2,553,1,5,0)
     who has designated you as their surrogate and given you privileges
"KRN",9.2,553,1,6,0)
     to: read, reply to, and/or send messages.
"KRN",9.2,553,1,7,0)
 
"KRN",9.2,553,1,8,0)
  2. [SHARED,MAIL] Surrogate - Act as a 'special user' surrogate (i.e.,
"KRN",9.2,553,1,9,0)
     SHARED,MAIL) where you can read and reply to messages of general
"KRN",9.2,553,1,10,0)
     interest, however, you cannot send new mail. 
"KRN",9.2,553,1,11,0)
 
"KRN",9.2,553,1,12,0)
For example, you may choose to become a surrogate, if you have been asked
"KRN",9.2,553,1,13,0)
by someone else to act as their surrogate while they are out of the
"KRN",9.2,553,1,14,0)
office. As their surrogate, you can check their mail. Also, you may become
"KRN",9.2,553,1,15,0)
a surrogate of [SHARED,MAIL] in order to read about general information or
"KRN",9.2,553,1,16,0)
special announcements available to all MailMan users.
"KRN",9.2,553,1,17,0)
 
"KRN",9.2,553,1,18,0)
[MORE]... 
"KRN",9.2,553,2,0)
^9.22A^3^3
"KRN",9.2,553,2,1,0)
MORE^XM-U-I-SURROGATE-4
"KRN",9.2,553,2,2,0)
BECOME^XM-U-I-SURROGATE BECOME
"KRN",9.2,553,2,3,0)
SHARED,MAIL^XM-U-I-SHARED MAIL
"KRN",9.2,554,-1)
0^105
"KRN",9.2,554,0)
XM-U-I-SURROGATE-4^MAILMAN SURROGATES (CONTINUED)^2990107.09103^
"KRN",9.2,554,1,0)
^^10^10^2990107^
"KRN",9.2,554,1,1,0)
 
"KRN",9.2,554,1,2,0)
Surrogates may be allowed the following privileges:
"KRN",9.2,554,1,3,0)
 
"KRN",9.2,554,1,4,0)
  * [READ] only privileges.
"KRN",9.2,554,1,5,0)
 
"KRN",9.2,554,1,6,0)
  * Read and [WRITE] privileges.
"KRN",9.2,554,1,7,0)
 
"KRN",9.2,554,1,8,0)
If a message is sent [CONFIDENTIAL], a surrogate cannot view it. If a
"KRN",9.2,554,1,9,0)
message has been [SCRAMBLED], a surrogate that does not know the
"KRN",9.2,554,1,10,0)
password cannot read it.
"KRN",9.2,554,2,0)
^9.22A^4^4
"KRN",9.2,554,2,1,0)
READ^XM-U-P-SURROGATE READ PRIV
"KRN",9.2,554,2,2,0)
WRITE^XM-U-P-SURROGATE WRITE PRIV
"KRN",9.2,554,2,3,0)
CONFIDENTIAL^XM-U-M-CONFIDENTIAL
"KRN",9.2,554,2,4,0)
SCRAMBLED^XM-U-M-SCRAMBLE
"KRN",9.2,555,-1)
0^233
"KRN",9.2,555,0)
XM-U-P-SURROGATE READ PRIV^SURROGATES - READ PRIVILEGES^2990114.1404^^
"KRN",9.2,555,1,0)
^^17^17^2990114^^^^
"KRN",9.2,555,1,1,0)
 
"KRN",9.2,555,1,2,0)
Users who give surrogates 'Read' privileges allow the surrogates to do
"KRN",9.2,555,1,3,0)
any of the following:
"KRN",9.2,555,1,4,0)
 
"KRN",9.2,555,1,5,0)
  * [DELETE] messages in any mail basket.
"KRN",9.2,555,1,6,0)
 
"KRN",9.2,555,1,7,0)
  * [FORWARD] messages in any mail basket to other recipients.
"KRN",9.2,555,1,8,0)
 
"KRN",9.2,555,1,9,0)
  * [LATER] messages in any mail basket.
"KRN",9.2,555,1,10,0)
 
"KRN",9.2,555,1,11,0)
  * [NEW]/Un New messages in any mail basket.
"KRN",9.2,555,1,12,0)
 
"KRN",9.2,555,1,13,0)
  * [READ] messages (except for [CONFIDENTIAL] ones) in any mail basket.
"KRN",9.2,555,1,14,0)
 
"KRN",9.2,555,1,15,0)
  * [REPLY] to messages in any mail basket.
"KRN",9.2,555,1,16,0)
 
"KRN",9.2,555,1,17,0)
  * [SAVE] messages to any mail basket.
"KRN",9.2,555,2,0)
^9.22^8^8
"KRN",9.2,555,2,1,0)
DELETE^XM-U-M-DELETE
"KRN",9.2,555,2,2,0)
FORWARD^XM-U-M-FORWARD
"KRN",9.2,555,2,3,0)
SAVE^XM-U-M-SAVE
"KRN",9.2,555,2,4,0)
REPLY^XM-U-M-REPLY
"KRN",9.2,555,2,5,0)
LATER^XM-U-M-LATER
"KRN",9.2,555,2,6,0)
NEW^XM-U-M-NEW
"KRN",9.2,555,2,7,0)
READ^XM-U-R-READ
"KRN",9.2,555,2,8,0)
CONFIDENTIAL^XM-U-M-CONFIDENTIAL
"KRN",9.2,556,-1)
0^234
"KRN",9.2,556,0)
XM-U-P-SURROGATE WRITE PRIV^SURROGATES - WRITE PRIVILEGES^2990107.09305^^
"KRN",9.2,556,1,0)
^^14^14^2990107^^
"KRN",9.2,556,1,1,0)
 
"KRN",9.2,556,1,2,0)
Users who give surrogates 'Read and Write' privileges, in addition to all
"KRN",9.2,556,1,3,0)
the privileges of [READ] access, allow the surrogates to do any of the
"KRN",9.2,556,1,4,0)
following:
"KRN",9.2,556,1,5,0)
 
"KRN",9.2,556,1,6,0)
  * [ANSWER] messages.
"KRN",9.2,556,1,7,0)
 
"KRN",9.2,556,1,8,0)
  * [COPY] messages.
"KRN",9.2,556,1,9,0)
 
"KRN",9.2,556,1,10,0)
  * [EDIT] messages.
"KRN",9.2,556,1,11,0)
 
"KRN",9.2,556,1,12,0)
  * [SEND] messages.
"KRN",9.2,556,1,13,0)
 
"KRN",9.2,556,1,14,0)
  * [WRITE] messages.
"KRN",9.2,556,2,0)
^9.22A^6^6
"KRN",9.2,556,2,1,0)
ANSWER^XM-U-M-ANSWER
"KRN",9.2,556,2,2,0)
COPY^XM-U-M-COPY
"KRN",9.2,556,2,3,0)
WRITE^XM-U-M-WRITE
"KRN",9.2,556,2,4,0)
SEND^XM-U-M-SEND
"KRN",9.2,556,2,5,0)
EDIT^XM-U-MO-EDIT
"KRN",9.2,556,2,6,0)
READ^XM-U-P-SURROGATE READ PRIV
"KRN",9.2,559,-1)
0^239
"KRN",9.2,559,0)
XM-U-Q-SEARCH CRITERIA^SEARCHING FOR MESSAGES - SEARCH CRITERIA^3000831.1334^^
"KRN",9.2,559,1,0)
^9.21^21^21^3000831^^^^
"KRN",9.2,559,1,1,0)
 
"KRN",9.2,559,1,2,0)
When searching for messages, you can specify any combination of the
"KRN",9.2,559,1,3,0)
following search criteria:
"KRN",9.2,559,1,4,0)
 
"KRN",9.2,559,1,5,0)
  * Subject Contents - Enter the 'S' ('Subject contains') search action
"KRN",9.2,559,1,6,0)
    code and then enter any portion of the subject string (not case
"KRN",9.2,559,1,7,0)
    sensitive). The string can be from 3 to 30 characters in length.
"KRN",9.2,559,1,8,0)
 
"KRN",9.2,559,1,9,0)
  * Sender of the Message - [WHO] sent the message.
"KRN",9.2,559,1,10,0)
 
"KRN",9.2,559,1,11,0)
  * Sender of one of the Responses - [WHO] replied to the message.
"KRN",9.2,559,1,12,0)
 
"KRN",9.2,559,1,13,0)
  * Addressee of a Message - [WHO] the message was sent to.
"KRN",9.2,559,1,14,0)
 
"KRN",9.2,559,1,15,0)
  * Sent [DATE] - Approximate date range when the message was sent.
"KRN",9.2,559,1,16,0)
 
"KRN",9.2,559,1,17,0)
  * [CONTENTS] of the message - What's in the message or response text.
"KRN",9.2,559,1,18,0)
 
"KRN",9.2,559,1,19,0)
  * Lines of text - Message text contains this many lines or more.
"KRN",9.2,559,1,20,0)
 
"KRN",9.2,559,1,21,0)
[MORE]...
"KRN",9.2,559,2,0)
^9.22A^7^4
"KRN",9.2,559,2,4,0)
MORE^XM-U-Q-SEARCH CRITERIA-2
"KRN",9.2,559,2,5,0)
WHO^XM-U-Q-SEARCH CRITERIA USERS
"KRN",9.2,559,2,6,0)
CONTENTS^XM-U-Q-SEARCH CRITERIA TEXT
"KRN",9.2,559,2,7,0)
DATE^XM-U-Q-SEARCH CRITERIA DATE
"KRN",9.2,561,-1)
0^243
"KRN",9.2,561,0)
XM-U-Q-SEARCH CRITERIA-2^SEARCH CRITERIA (CONTINUED)^3000830.0921^^
"KRN",9.2,561,1,0)
^9.21^20^20^3000830^^^
"KRN",9.2,561,1,1,0)
 
"KRN",9.2,561,1,2,0)
The more search criteria you choose, the more specific (and slower!) the
"KRN",9.2,561,1,3,0)
search becomes, resulting in a smaller list of messages from which to choose. 
"KRN",9.2,561,1,4,0)
 
"KRN",9.2,561,1,5,0)
All criteria entered must be true in order to pass the search test. (This
"KRN",9.2,561,1,6,0)
is similar to using the Boolean 'AND' in Internet search engines or
"KRN",9.2,561,1,7,0)
program code).
"KRN",9.2,561,1,8,0)
 
"KRN",9.2,561,1,9,0)
MailMan displays the entire list of search criteria you've selected. To
"KRN",9.2,561,1,10,0)
cancel a single search criterion without having to start over, use the
"KRN",9.2,561,1,11,0)
at-sign ('@' Shift-2 key on most keyboards) to delete the specific search
"KRN",9.2,561,1,12,0)
criterion you no longer want.
"KRN",9.2,561,1,13,0)
 
"KRN",9.2,561,1,14,0)
When you have completed your search criteria, enter 'G' (Go search) to
"KRN",9.2,561,1,15,0)
start the search. You are automatically placed in the full-screen message
"KRN",9.2,561,1,16,0)
reader to manipulate any messages found from the search.
"KRN",9.2,561,1,17,0)
 
"KRN",9.2,561,1,18,0)
To end the query without searching, you can enter 'Q' (Quit) or enter the
"KRN",9.2,561,1,19,0)
up-arrow ('^' Shift-6 key on most keyboards) to get out of the
"KRN",9.2,561,1,20,0)
Query/Search for Messages option.
"KRN",9.2,561,2,0)
^9.22A^0^0
"KRN",9.2,565,-1)
0^50
"KRN",9.2,565,0)
XM-U-A-LOCAL USER NAME-2^ENTERING A LOCAL USER'S NAME (CONTINUED)^2990107.115556^
"KRN",9.2,565,1,0)
^^19^19^2990107^
"KRN",9.2,565,1,1,0)
 
"KRN",9.2,565,1,2,0)
In addition to entering a user's name, MailMan also allows you to enter a
"KRN",9.2,565,1,3,0)
person's local DUZ when performing the following functions:
"KRN",9.2,565,1,4,0)
 
"KRN",9.2,565,1,5,0)
  * Addressing a message (including [FORWARDING] messages).
"KRN",9.2,565,1,6,0)
 
"KRN",9.2,565,1,7,0)
  * [BECOMING] a surrogate.
"KRN",9.2,565,1,8,0)
 
"KRN",9.2,565,1,9,0)
  * [FILTERING] mail by sender and/or recipient.
"KRN",9.2,565,1,10,0)
 
"KRN",9.2,565,1,11,0)
  * [SEARCHING] for messages by sender, recipient, and/or responder
"KRN",9.2,565,1,12,0)
 
"KRN",9.2,565,1,13,0)
The DUZ is a person's unique numeric user ID. Thus, if multiple
"KRN",9.2,565,1,14,0)
addressees, for example, have similar names, you can enter their local DUZ
"KRN",9.2,565,1,15,0)
instead of their name to choose the specific person.
"KRN",9.2,565,1,16,0)
 
"KRN",9.2,565,1,17,0)
NOTE: You cannot substitute the DUZ for a name when creating members of a
"KRN",9.2,565,1,18,0)
      [PERSONAL] mail group or when [DESIGNATING] a surrogate for
"KRN",9.2,565,1,19,0)
      yourself.
"KRN",9.2,565,2,0)
^9.22A^7^6
"KRN",9.2,565,2,1,0)
FORWARDING^XM-U-M-FORWARD
"KRN",9.2,565,2,3,0)
FILTERING^XM-U-P-FILTER
"KRN",9.2,565,2,4,0)
SEARCHING^XM-U-Q-SEARCH CRITERIA
"KRN",9.2,565,2,5,0)
PERSONAL^XM-U-P-GROUP PERSONAL
"KRN",9.2,565,2,6,0)
BECOMING^XM-U-I-SURROGATE BECOME
"KRN",9.2,565,2,7,0)
DESIGNATING^XM-U-P-SURROGATE EDIT
"KRN",9.2,566,-1)
0^52
"KRN",9.2,566,0)
XM-U-A-STAGGER DELIVERY-2^STAGGER DELIVERY OF A MESSAGE (CONTINUED)^2990114.1323^^
"KRN",9.2,566,1,0)
^^4^4^2990114^^
"KRN",9.2,566,1,1,0)
 
"KRN",9.2,566,1,2,0)
After the message with staggered delivery dates and times has actually
"KRN",9.2,566,1,3,0)
been delivered to the recipients, doing a [QUERY] (QD) on the message will
"KRN",9.2,566,1,4,0)
indicate that the message was 'forwarded' to the recipients.
"KRN",9.2,566,2,0)
^9.22A^1^1
"KRN",9.2,566,2,1,0)
QUERY^XM-U-M-QUERY DETAILED
"KRN",9.2,567,-1)
0^257
"KRN",9.2,567,0)
XM-U-R-READ NEW-2^PROCESSING NEW MAIL (CONTINUED)^2990107.14333^
"KRN",9.2,567,1,0)
^^21^21^2990107^^
"KRN",9.2,567,1,1,0)
 
"KRN",9.2,567,1,2,0)
After reading a message, you can make it 'new' again by:
"KRN",9.2,567,1,3,0)
 
"KRN",9.2,567,1,4,0)
  * Entering an 'L' ([LATER]) at the 'Enter message option' prompt. You
"KRN",9.2,567,1,5,0)
    then choose the date and time that the message will appear as new
"KRN",9.2,567,1,6,0)
    again.
"KRN",9.2,567,1,7,0)
 
"KRN",9.2,567,1,8,0)
  * Entering an 'N' ([NEW]) at the 'Enter message option' prompt will
"KRN",9.2,567,1,9,0)
    cause the message to appear as new in your mailbox. If a message is
"KRN",9.2,567,1,10,0)
    already indicated to be 'new' and you enter an 'N' (toggle), the
"KRN",9.2,567,1,11,0)
    message will no longer appears as new.
"KRN",9.2,567,1,12,0)
 
"KRN",9.2,567,1,13,0)
As messages sent by users to themselves are not considered 'new,' users
"KRN",9.2,567,1,14,0)
cannot send messages to their baskets and read them using this option. To
"KRN",9.2,567,1,15,0)
read those messages, you should use the [READ]/Manage Messages option.
"KRN",9.2,567,1,16,0)
 
"KRN",9.2,567,1,17,0)
If someone [REPLIES] to a message that was [DELETED] (but not
"KRN",9.2,567,1,18,0)
[TERMINATED]) by the user, the message is redelivered to the user.
"KRN",9.2,567,1,19,0)
 
"KRN",9.2,567,1,20,0)
NOTE: Messages contain message [HEADERS] that are displayed prior to the
"KRN",9.2,567,1,21,0)
      text of the message.
"KRN",9.2,567,2,0)
^9.22A^7^7
"KRN",9.2,567,2,1,0)
LATER^XM-U-M-LATER
"KRN",9.2,567,2,2,0)
NEW^XM-U-M-NEW
"KRN",9.2,567,2,3,0)
READ^XM-U-R-READ
"KRN",9.2,567,2,4,0)
REPLIES^XM-U-M-REPLY
"KRN",9.2,567,2,5,0)
DELETED^XM-U-M-DELETE
"KRN",9.2,567,2,6,0)
TERMINATED^XM-U-M-TERMINATE
"KRN",9.2,567,2,7,0)
HEADERS^XM-U-M-MESSAGE HEADER
"KRN",9.2,569,-1)
0^226
"KRN",9.2,569,0)
XM-U-P-PRIORITY PROMPT-2^PRIORITY RESPONSES PROMPT (CONTINUED)^2990107.153856^
"KRN",9.2,569,1,0)
^^22^22^2990107^
"KRN",9.2,569,1,1,0)
 
"KRN",9.2,569,1,2,0)
MailMan will either ask or not ask you for a new value for this flag each
"KRN",9.2,569,1,3,0)
time you read a priority message, depending on what you enter in the
"KRN",9.2,569,1,4,0)
PRIORITY RESPONSES PROMPT field.
"KRN",9.2,569,1,5,0)
 
"KRN",9.2,569,1,6,0)
There are two possible choices when answering the 'PRIORITY RESPONSES
"KRN",9.2,569,1,7,0)
PROMPT:' prompt:
"KRN",9.2,569,1,8,0)
 
"KRN",9.2,569,1,9,0)
  * 0, ASK EACH TIME MESSAGE IS READ (default) - MailMan will prompt you
"KRN",9.2,569,1,10,0)
    to decide each time you read a priority mail message whether you want
"KRN",9.2,569,1,11,0)
    the future responses to be delivered as priority mail. This value
"KRN",9.2,569,1,12,0)
    allows you to override the default value you set in the PRIORITY
"KRN",9.2,569,1,13,0)
    RESPONSES [FLAG] field.
"KRN",9.2,569,1,14,0)
 
"KRN",9.2,569,1,15,0)
  * 1, DO NOT ASK EACH TIME MESSAGE IS READ - MailMan will not prompt you
"KRN",9.2,569,1,16,0)
    to decide each time you read a priority mail message whether you want
"KRN",9.2,569,1,17,0)
    the future responses to be delivered as priority mail. The default
"KRN",9.2,569,1,18,0)
    value you set in the PRIORITY RESPONSES [FLAG] field will be in
"KRN",9.2,569,1,19,0)
    effect.
"KRN",9.2,569,1,20,0)
 
"KRN",9.2,569,1,21,0)
If you do not set this field, then you will be prompted to choose whether
"KRN",9.2,569,1,22,0)
future responses will be delivered as priority or not.
"KRN",9.2,569,2,0)
^9.22A^1^1
"KRN",9.2,569,2,1,0)
FLAG^XM-U-P-PRIORITY FLAG
"KRN",9.2,570,-1)
0^209
"KRN",9.2,570,0)
XM-U-P-GROUP PERSONAL-2^PERSONAL MAIL GROUPS (CONTINUED)^3010213.091^
"KRN",9.2,570,1,0)
^9.21^16^16^3010213^^
"KRN",9.2,570,1,1,0)

"KRN",9.2,570,1,2,0)
To create a new or edit an existing personal mail group, use the Personal
"KRN",9.2,570,1,3,0)
Mail Group Edit option on the Personal Preferences menu. You can add or
"KRN",9.2,570,1,4,0)
delete members at any time. You can also use this option to delete the
"KRN",9.2,570,1,5,0)
entire personal mail group. Even though you are the Organizer of the group,
"KRN",9.2,570,1,6,0)
you are not automatically made a member. Thus, you should also make yourself
"KRN",9.2,570,1,7,0)
a member of the personal mail group if you want to receive messages addressed
"KRN",9.2,570,1,8,0)
to it.
"KRN",9.2,570,1,9,0)
 
"KRN",9.2,570,1,10,0)
MailMan will not allow you to create a personal mail group if a [PUBLIC]
"KRN",9.2,570,1,11,0)
mail group with that same name already exists.
"KRN",9.2,570,1,12,0)

"KRN",9.2,570,1,13,0)
If you want to make your group Public, you must first set the 'Restrictions'
"KRN",9.2,570,1,14,0)
field to 'Unrestricted', if it isn't already.  Then you must contact your
"KRN",9.2,570,1,15,0)
IRM, CAC, or ADPAC to request that your group be edited to convert it from
"KRN",9.2,570,1,16,0)
Private to Public.
"KRN",9.2,570,2,0)
^9.22A^1^1
"KRN",9.2,570,2,1,0)
PUBLIC^XM-U-P-GROUP ENROLL
"KRN",9.2,571,-1)
0^74
"KRN",9.2,571,0)
XM-U-B-XMIT PRIORITY TOGGLE-2^TOGGLING MESSAGE TRANSMISSION PRIORITY (CONTINUED)^3020311.081^^
"KRN",9.2,571,1,0)
^9.21^20^20^3020311^^^^
"KRN",9.2,571,1,1,0)
 
"KRN",9.2,571,1,2,0)
To change message transmission priority, do the following:
"KRN",9.2,571,1,3,0)
 
"KRN",9.2,571,1,4,0)
  * Individually - After reading a message, enter an 'X' at the 'Enter
"KRN",9.2,571,1,5,0)
    message action' prompt.
"KRN",9.2,571,1,6,0)

"KRN",9.2,571,1,7,0)
      - MailMan will ask you whether the message should be high, normal, or
"KRN",9.2,571,1,8,0)
        low priority.
"KRN",9.2,571,1,9,0)
 
"KRN",9.2,571,1,10,0)
  * Group of Messages - Enter an 'X' at the basket option or command prompt.
"KRN",9.2,571,1,11,0)

"KRN",9.2,571,1,12,0)
      - MailMan will first ask you to select which messages should have their
"KRN",9.2,571,1,13,0)
        transmit priority changed, including a [RANGE] of messages. Also, if
"KRN",9.2,571,1,14,0)
        you are using a full-screen reader, you can pre-[SELECT] messages and
"KRN",9.2,571,1,15,0)
        then change their transmit priority as a group.
"KRN",9.2,571,1,16,0)

"KRN",9.2,571,1,17,0)
      - MailMan will then ask you to confirm your intention.
"KRN",9.2,571,1,18,0)

"KRN",9.2,571,1,19,0)
      - Lastly, MailMan will ask you whether the messages should be high,
"KRN",9.2,571,1,20,0)
        normal, or low priority.
"KRN",9.2,571,2,0)
^9.22A^3^2
"KRN",9.2,571,2,1,0)
RANGE^XM-U-M-CHOOSE RANGE
"KRN",9.2,571,2,3,0)
SELECT^XM-U-M-CHOOSE SELECT
"KRN",9.2,572,-1)
0^248
"KRN",9.2,572,0)
XM-U-Q-SEARCH SYSTEM^SEARCHING FOR MESSAGES - ANYWHERE ON THE SYSTEM^3020502.1437^^
"KRN",9.2,572,1,0)
^9.21^19^19^3020502^^^^
"KRN",9.2,572,1,1,0)
 
"KRN",9.2,572,1,2,0)
You can search for any messages you ever sent or that were sent to you, if
"KRN",9.2,572,1,3,0)
they still exist anywhere on the system (i.e., located in the MESSAGE file),
"KRN",9.2,572,1,4,0)
whether they are in your mailbox or you deleted them long ago.  If they're
"KRN",9.2,572,1,5,0)
still out there, MailMan will find them.
"KRN",9.2,572,1,6,0)

"KRN",9.2,572,1,7,0)
Under the 'Query/Search for Messages' option on the main MailMan menu,
"KRN",9.2,572,1,8,0)
MailMan gives you two ways to search the entire system:
"KRN",9.2,572,1,9,0)

"KRN",9.2,572,1,10,0)
  * By Subject - You enter the string that the subject starts with, and
"KRN",9.2,572,1,11,0)
MailMan will find all messages whose subject begins with the string.  The
"KRN",9.2,572,1,12,0)
string must be in the exact upper/lower case.  Case matters!  This search
"KRN",9.2,572,1,13,0)
is relatively quick.
"KRN",9.2,572,1,14,0)

"KRN",9.2,572,1,15,0)
  * By multiple [CRITERIA] - As with the [MAILBOX] search, you enter as
"KRN",9.2,572,1,16,0)
many criteria as you like to narrow the search, and MailMan will find all
"KRN",9.2,572,1,17,0)
messages matching the criteria.  Unlike the Mailbox search, which covers only
"KRN",9.2,572,1,18,0)
the messages in your mailbox, this search covers all the messages on the
"KRN",9.2,572,1,19,0)
system.  This search can be very slow, depending on the criteria you enter.
"KRN",9.2,572,2,0)
^9.22A^2^2
"KRN",9.2,572,2,1,0)
CRITERIA^XM-U-Q-SEARCH CRITERIA
"KRN",9.2,572,2,2,0)
MAILBOX^XM-U-Q-SEARCH MAILBOX
"KRN",9.2,573,-1)
0^84
"KRN",9.2,573,0)
XM-U-H-GROUP-4^MAIL GROUP INFORMATION (CONTINUED)^3000504.0936^^
"KRN",9.2,573,1,0)
^9.21^19^19^3000504^^
"KRN",9.2,573,1,1,0)
 
"KRN",9.2,573,1,2,0)
 * Member(s) - list of members for the mail group. Members will receive
"KRN",9.2,573,1,3,0)
    all mail addressed to the group. Members can include any of the
"KRN",9.2,573,1,4,0)
    following:
"KRN",9.2,573,1,5,0)
 
"KRN",9.2,573,1,6,0)
      - Local and remote users
"KRN",9.2,573,1,7,0)
 
"KRN",9.2,573,1,8,0)
      - Other mail groups (local mail groups)
"KRN",9.2,573,1,9,0)
 
"KRN",9.2,573,1,10,0)
      - Distribution lists (nationwide mail groups)
"KRN",9.2,573,1,11,0)
 
"KRN",9.2,573,1,12,0)
 * Member of - list of mail groups to which the mail group belongs.
"KRN",9.2,573,1,13,0)
 
"KRN",9.2,573,1,14,0)
The group information can help you decide if you want to join a particular
"KRN",9.2,573,1,15,0)
mail group (e.g., the description). Also, if a mail group doesn't allow
"KRN",9.2,573,1,16,0)
self-enrollment, you can find out who the Coordinator or Organizer of the
"KRN",9.2,573,1,17,0)
group is and ask if you can become a member of or remove yourself from a
"KRN",9.2,573,1,18,0)
mail group.  Also, if a mail group has Authorized Senders, you'll know to
"KRN",9.2,573,1,19,0)
whom you should send mail, if you want to address that particular mail group.
"KRN",9.2,574,-1)
0^149
"KRN",9.2,574,0)
XM-U-M-PRINT HEADER^IDENTIFYING YOUR MESSAGE PRINTOUT^2990120.093649^
"KRN",9.2,574,1,0)
^^11^11^2990427^
"KRN",9.2,574,1,1,0)
 
"KRN",9.2,574,1,2,0)
When you print a message, the print header appears at the top of the first
"KRN",9.2,574,1,3,0)
page, and identifies it as yours.
"KRN",9.2,574,1,4,0)
 
"KRN",9.2,574,1,5,0)
The header includes:
"KRN",9.2,574,1,6,0)
 
"KRN",9.2,574,1,7,0)
  * Your name
"KRN",9.2,574,1,8,0)
 
"KRN",9.2,574,1,9,0)
  * At which site it was printed
"KRN",9.2,574,1,10,0)
 
"KRN",9.2,574,1,11,0)
  * What time it was printed
"KRN",9.2,575,-1)
0^95
"KRN",9.2,575,0)
XM-U-I-EDITOR FM SCREEN^VA FILEMAN SCREEN EDITOR^2990120.1617^^
"KRN",9.2,575,1,0)
^^10^10^2990120^^
"KRN",9.2,575,1,1,0)

"KRN",9.2,575,1,2,0)
The Full Screen Editor uses the PF set of function keys to perform word
"KRN",9.2,575,1,3,0)
processing functions (e.g., setting margins and tabs, deleting text, and
"KRN",9.2,575,1,4,0)
saving text). Help text is available while using the editor. Users can
"KRN",9.2,575,1,5,0)
also switch from the Screen Editor directly to a different editor. The
"KRN",9.2,575,1,6,0)
original text and formatting will then be transferred to the new editor.
"KRN",9.2,575,1,7,0)
 
"KRN",9.2,575,1,8,0)
For example, from within the VA FileMan Screen Editor, you can transfer
"KRN",9.2,575,1,9,0)
text to a different editor by entering PF1 and then the letter 'A'. Your
"KRN",9.2,575,1,10,0)
text is immediately transferred to the selected editor.
"KRN",9.2,639,-1)
0^236
"KRN",9.2,639,0)
XM-U-Q-CLASSIC LOOKUP ??^LOOKING FOR MESSAGES WHOSE SUBJECT BEGINS WITH A SPECIFIC STRING^2990421.1237^^
"KRN",9.2,639,1,0)
^^14^14^2990421^
"KRN",9.2,639,1,1,0)
 
"KRN",9.2,639,1,2,0)
While in a basket, you can search for messages anywhere on the system
"KRN",9.2,639,1,3,0)
whose subject begins with a certain string.
"KRN",9.2,639,1,4,0)
 
"KRN",9.2,639,1,5,0)
At the 'Basket Message' prompt, enter the string preceded by a '??'. You
"KRN",9.2,639,1,6,0)
will then be shown a list of those messages anywhere on the system, which
"KRN",9.2,639,1,7,0)
you ever sent or received, whose subject BEGINS with that string (case
"KRN",9.2,639,1,8,0)
sensitive), and can choose which you would like to read.
"KRN",9.2,639,1,9,0)
 
"KRN",9.2,639,1,10,0)
For example, if you want to search for messages whose subject begins
"KRN",9.2,639,1,11,0)
with the words 'Schedule Reports', you would enter '??Schedule Reports'.
"KRN",9.2,639,1,12,0)
Since this search is case sensitive, you must enter the string in the
"KRN",9.2,639,1,13,0)
correct case. Thus, for example, 'SCHEDULE REPORTS' and 'Schedule Reports'
"KRN",9.2,639,1,14,0)
are not considered by this search as being the same.
"KRN",9.2,639,2,0)
^9.22^0^0
"KRN",9.2,640,-1)
0^222
"KRN",9.2,640,0)
XM-U-P-P-MESSAGE FROM^P-MESSAGE FROM^2990428.0704^
"KRN",9.2,640,1,0)
^^21^21^2990428^^
"KRN",9.2,640,1,1,0)
 
"KRN",9.2,640,1,2,0)
The "P-MESSAGE FROM:" prompt pertains to anything you may print to the
"KRN",9.2,640,1,3,0)
P-MESSAGE device. MailMan allows you to decide from whom should the
"KRN",9.2,640,1,4,0)
message be. The result is a message sent to you.
"KRN",9.2,640,1,5,0)
 
"KRN",9.2,640,1,6,0)
If you queue the print, this is from whom the message will be. If you
"KRN",9.2,640,1,7,0)
don't queue the print, this is the default that will appear in a dialogue
"KRN",9.2,640,1,8,0)
with MailMan to determine from whom the message will be.
"KRN",9.2,640,1,9,0)
 
"KRN",9.2,640,1,10,0)
There are two possible responses:
"KRN",9.2,640,1,11,0)
  * ME (default) - Answer ME if the message should be from you. It will
"KRN",9.2,640,1,12,0)
    not be delivered new to you, but you will be able to edit it.
"KRN",9.2,640,1,13,0)
 
"KRN",9.2,640,1,14,0)
  * POSTMASTER - Answer POSTMASTER if the message should be from the
"KRN",9.2,640,1,15,0)
    POSTMASTER. It will be delivered new to you, but you will not be able
"KRN",9.2,640,1,16,0)
    to edit it.
"KRN",9.2,640,1,17,0)
 
"KRN",9.2,640,1,18,0)
NOTE: If you do not enter anything in this field, the default will be "ME."
"KRN",9.2,640,1,19,0)
 
"KRN",9.2,640,1,20,0)
The "P-MESSAGE FROM:" prompt can be set through the User Options Edit
"KRN",9.2,640,1,21,0)
option on the Personal Preferences menu. 
"KRN",9.2,641,-1)
0^230
"KRN",9.2,641,0)
XM-U-P-SHOW MESSAGE PREVIEW^SHOW MESSAGE PREVIEW^2990428.0655^^
"KRN",9.2,641,1,0)
^^20^20^2990428^^^^
"KRN",9.2,641,1,1,0)
 
"KRN",9.2,641,1,2,0)
The [CLASSIC] message reader can "preview" the next message to be read in
"KRN",9.2,641,1,3,0)
a mail basket by displaying the message subject and sender, in addition to
"KRN",9.2,641,1,4,0)
the mail basket, and message number in that basket.
"KRN",9.2,641,1,5,0)
 
"KRN",9.2,641,1,6,0)
Seeing the message subject and sender may help you decide whether or not
"KRN",9.2,641,1,7,0)
you wish to read the message. If you decide not to read the message, you
"KRN",9.2,641,1,8,0)
can "Ignore" it and move on to the next message.
"KRN",9.2,641,1,9,0)
 
"KRN",9.2,641,1,10,0)
Use the "SHOW MESSAGE PREVIEW:" prompt (under Personal Preferences|
"KRN",9.2,641,1,11,0)
User Options Edit) to choose whether or not MailMan will display a preview
"KRN",9.2,641,1,12,0)
of messages when you are scrolling through the messages in a basket using
"KRN",9.2,641,1,13,0)
the Classic message reader.
"KRN",9.2,641,1,14,0)
 
"KRN",9.2,641,1,15,0)
There are two possible responses:
"KRN",9.2,641,1,16,0)
 
"KRN",9.2,641,1,17,0)
  * YES - Preview messages when using the Classic message reader.
"KRN",9.2,641,1,18,0)
 
"KRN",9.2,641,1,19,0)
  * NO (default) - Don't preview messages when using the Classic message
"KRN",9.2,641,1,20,0)
                   reader.
"KRN",9.2,641,2,0)
^9.22A^1^1
"KRN",9.2,641,2,1,0)
CLASSIC^XM-U-B-READER CLASSIC
"KRN",9.2,643,-1)
0^204
"KRN",9.2,643,0)
XM-U-P-FILTER-3^FILTERING MAIL (CONTINUED)^2990427.151756^
"KRN",9.2,643,1,0)
^^19^19^2990505^
"KRN",9.2,643,1,1,0)
 
"KRN",9.2,643,1,2,0)
Also, when you create a mail filter and specify a mail basket that does
"KRN",9.2,643,1,3,0)
not currently exist in your mailbox, MailMan will allow you to create it
"KRN",9.2,643,1,4,0)
on the fly. Also, if you later delete a filter mail basket, MailMan will
"KRN",9.2,643,1,5,0)
automatically recreate it for you when the filter is used (activated) and
"KRN",9.2,643,1,6,0)
mail is directed to that basket.
"KRN",9.2,643,1,7,0)
 
"KRN",9.2,643,1,8,0)
 ************************************************************************
"KRN",9.2,643,1,9,0)
 * MailMan's background processing checks active mail filters for each  *
"KRN",9.2,643,1,10,0)
 * recipient, prior to delivery. This can be cumbersome for MailMan when*
"KRN",9.2,643,1,11,0)
 * a message has numerous recipients and each recipient has numerous    *
"KRN",9.2,643,1,12,0)
 * active mail filters. Thus, to make the delivery process more         *
"KRN",9.2,643,1,13,0)
 * efficient for everyone, we suggest you limit the number of active    *
"KRN",9.2,643,1,14,0)
 * filters for your mailbox, use the least amount of filtering criteria *
"KRN",9.2,643,1,15,0)
 * necessary to positively identify the message,  and prioritize each   *
"KRN",9.2,643,1,16,0)
 * filter by using the ORDER field. Those filters that will be used the *
"KRN",9.2,643,1,17,0)
 * most should be given the highest priority (e.g., ORDER equals one,   *
"KRN",9.2,643,1,18,0)
 * two, or three).                                                      *
"KRN",9.2,643,1,19,0)
 ************************************************************************
"KRN",9.2,644,-1)
0^146
"KRN",9.2,644,0)
XM-U-M-NEW-2^MAKE NEW MESSAGES NOT NEW AND VICE VERSA (CONTINUED)^2991213.1444^^
"KRN",9.2,644,1,0)
^^20^20^2991213^^^
"KRN",9.2,644,1,1,0)

"KRN",9.2,644,1,2,0)
To toggle messages from New to 'Un New' or vice versa, do the following: 
"KRN",9.2,644,1,3,0)
  
"KRN",9.2,644,1,4,0)
  * Individually - After reading a message, enter an 'N' at the 'Enter 
"KRN",9.2,644,1,5,0)
    message action' prompt.  
"KRN",9.2,644,1,6,0)
 
"KRN",9.2,644,1,7,0)
  * Group of Messages - Enter an 'NT' at the basket option or command prompt.  
"KRN",9.2,644,1,8,0)
 
"KRN",9.2,644,1,9,0)
     - MailMan will first ask you to select which messages you want to 
"KRN",9.2,644,1,10,0)
       new toggle, including a [RANGE] of messages.  Also, if you are using 
"KRN",9.2,644,1,11,0)
       a full-screen reader, you can pre-[SELECT] messages and then new 
"KRN",9.2,644,1,12,0)
       toggle them as a group.  
"KRN",9.2,644,1,13,0)
  
"KRN",9.2,644,1,14,0)
     - MailMan will then make any new messages 'not new' and vice versa.  
"KRN",9.2,644,1,15,0)
  
"KRN",9.2,644,1,16,0)
Enter an 'L' ([LATER]) at the 'Enter message action' prompt to make the 
"KRN",9.2,644,1,17,0)
message appear new at a later date and time (even later today). The message
"KRN",9.2,644,1,18,0)
will be made new at the requested time. These actions can be used when a
"KRN",9.2,644,1,19,0)
message cannot be handled immediately, or as a reminder of important
"KRN",9.2,644,1,20,0)
activities, making MailMan a personal reminder.  
"KRN",9.2,644,2,0)
^9.22^3^3
"KRN",9.2,644,2,1,0)
LATER^XM-U-M-LATER
"KRN",9.2,644,2,2,0)
RANGE^XM-U-M-CHOOSE RANGE
"KRN",9.2,644,2,3,0)
SELECT^XM-U-M-CHOOSE SELECT
"KRN",9.2,645,-1)
0^144
"KRN",9.2,645,0)
XM-U-M-NETWORK SIGNATURE^ADD YOUR NETWORK SIGNATURE TO A MESSAGE^2991213.152^^
"KRN",9.2,645,1,0)
^^12^12^2991213^^
"KRN",9.2,645,1,1,0)
 
"KRN",9.2,645,1,2,0)
You can use the Add Network Signature action code (i.e., 'NS') to add
"KRN",9.2,645,1,3,0)
your network signature to the end of your message.
"KRN",9.2,645,1,4,0)
 
"KRN",9.2,645,1,5,0)
You can create a [NETWORK SIGNATURE] using the User Options Edit option
"KRN",9.2,645,1,6,0)
of the Personal Preferences menu.
"KRN",9.2,645,1,7,0)
 
"KRN",9.2,645,1,8,0)
To add your network signature to a message, enter 'NS' at the 'Select
"KRN",9.2,645,1,9,0)
Message option:  Transmit now//' prompt.
"KRN",9.2,645,1,10,0)
 
"KRN",9.2,645,1,11,0)
Be careful.  This is not a toggle.  MailMan will add your network signature
"KRN",9.2,645,1,12,0)
to the message every time you invoke the NS command.
"KRN",9.2,645,2,0)
^9.22^1^1
"KRN",9.2,645,2,1,0)
NETWORK SIGNATURE^XM-U-P-NETWORK SIGNATURE
"KRN",9.2,646,-1)
0^167
"KRN",9.2,646,0)
XM-U-M-REPLY INCLUDE^INCLUDE PREVIOUS RESPONSES IN YOUR REPLY^2991213.1546^^
"KRN",9.2,646,1,0)
^^14^14^2991213^^
"KRN",9.2,646,1,1,0)
 
"KRN",9.2,646,1,2,0)
Entering an 'I' at the 'Select Message option:  Transmit now//' prompt
"KRN",9.2,646,1,3,0)
enables you to add previous responses to your reply.  You can then go back
"KRN",9.2,646,1,4,0)
and edit your reply to comment on those responses you just added.
"KRN",9.2,646,1,5,0)
 
"KRN",9.2,646,1,6,0)
(The usual method for commenting on previous responses is to enter 'RI'
"KRN",9.2,646,1,7,0)
at the 'Enter message action' prompt to tell MailMan that you want to reply
"KRN",9.2,646,1,8,0)
and include previous responses.  The 'I' command is for those times when
"KRN",9.2,646,1,9,0)
you forgot to include responses before you composed your reply, and need
"KRN",9.2,646,1,10,0)
to do it afterwards.)
"KRN",9.2,646,1,11,0)
 
"KRN",9.2,646,1,12,0)
If you enter 'I', you will be able to include the original message 
"KRN",9.2,646,1,13,0)
and/or any [COMBINATION] of responses in your reply. (With this feature, 
"KRN",9.2,646,1,14,0)
you can more easily respond to what someone wrote, point by point.) 
"KRN",9.2,646,2,0)
^9.22^1^1
"KRN",9.2,646,2,1,0)
COMBINATION^XM-U-M-CHOOSE RESPONSES
"KRN",9.2,647,-1)
0^136
"KRN",9.2,647,0)
XM-U-M-INCLUDE MESSAGE^INCLUDING A MESSAGE^3000515.0936^^
"KRN",9.2,647,1,0)
^9.21^14^14^3000515^^^
"KRN",9.2,647,1,1,0)

"KRN",9.2,647,1,2,0)
Entering an 'IM' enables you to include responses from another message
"KRN",9.2,647,1,3,0)
in your message.
"KRN",9.2,647,1,4,0)
 
"KRN",9.2,647,1,5,0)
This command is available at the 'Select Message option: Transmit now//'
"KRN",9.2,647,1,6,0)
prompt when creating a new message, or at the 'Select Edit option' prompt
"KRN",9.2,647,1,7,0)
when editing a message you've sent only to yourself.
"KRN",9.2,647,1,8,0)
 
"KRN",9.2,647,1,9,0)
If you enter 'IM', you will be asked to enter the internal entry number
"KRN",9.2,647,1,10,0)
of the message to include, and then you will be able to include the
"KRN",9.2,647,1,11,0)
original message and/or any [COMBINATION] of its responses in your message.
"KRN",9.2,647,1,12,0)
 
"KRN",9.2,647,1,13,0)
After you've included the desired responses in the text of your message,
"KRN",9.2,647,1,14,0)
you can then [EDIT] the text your message.
"KRN",9.2,647,2,0)
^9.22A^2^2
"KRN",9.2,647,2,1,0)
COMBINATION^XM-U-M-CHOOSE RESPONSES
"KRN",9.2,647,2,2,0)
EDIT^XM-U-M-EDIT TEXT
"KRN",9.2,648,-1)
0^199
"KRN",9.2,648,0)
XM-U-P-FILTER ACTIONS^FILTERING MAIL ACTIONS^3020506.0947^^
"KRN",9.2,648,1,0)
^9.21^21^21^3020506^^^^
"KRN",9.2,648,1,1,0)
 
"KRN",9.2,648,1,2,0)
When a filter is activated during message delivery, in addition to directing
"KRN",9.2,648,1,3,0)
a message to a specific basket, you can direct MailMan to perform additional
"KRN",9.2,648,1,4,0)
optional actions on the message.  (Note that these actions are not performed
"KRN",9.2,648,1,5,0)
when a filter is activated as a result of the 'FI' Filter basket action.)
"KRN",9.2,648,1,6,0)
 
"KRN",9.2,648,1,7,0)
Optional filter actions during message delivery are:
"KRN",9.2,648,1,8,0)
 
"KRN",9.2,648,1,9,0)
* Set the message VAPORIZE date to delete the message from your mailbox
"KRN",9.2,648,1,10,0)
a specified number of days after it is delivered to you.  (Default is not
"KRN",9.2,648,1,11,0)
to set any vaporize date.)  This action will only apply to messages which
"KRN",9.2,648,1,12,0)
are put into your mailbox (includes moving from the WASTE basket) as a
"KRN",9.2,648,1,13,0)
result of delivery or latering.  It won't apply to messages which are
"KRN",9.2,648,1,14,0)
already in your mailbox.
"KRN",9.2,648,1,15,0)
 
"KRN",9.2,648,1,16,0)
* Do NOT mark the message as NEW.  (Default is to mark the message as NEW.)
"KRN",9.2,648,1,17,0)
This action will only apply to messages which you have not seen before.
"KRN",9.2,648,1,18,0)
 
"KRN",9.2,648,1,19,0)
* Forward the message to others (including H. and D. devices).  This action
"KRN",9.2,648,1,20,0)
will only apply once per message. It won't apply to confidential, closed, or
"KRN",9.2,648,1,21,0)
otherwise sensitive messages. It won't apply to messages from you to yourself.
"KRN",9.2,649,-1)
0^117
"KRN",9.2,649,0)
XM-U-M-BROWSER^PRINT TO THE VA FILEMAN BROWSER^3000525^
"KRN",9.2,649,1,0)
^^21^21^3000525^
"KRN",9.2,649,1,1,0)
 
"KRN",9.2,649,1,2,0)
Your site manager may have set up an output device called BROWSER.  If so,
"KRN",9.2,649,1,3,0)
you can view any message on it, rather than the conventional 'Backup' or
"KRN",9.2,649,1,4,0)
on paper.  Do this by entering 'BR' at the "Enter Message Action: IGNORE//"
"KRN",9.2,649,1,5,0)
prompt.  (This has the same effect as Printing your message to the BROWSER
"KRN",9.2,649,1,6,0)
device instead of the HOME device or a printer.  It's a short cut.)
"KRN",9.2,649,1,7,0)

"KRN",9.2,649,1,8,0)
The Browser makes it easier to view messages on screen.  Its main features are:
"KRN",9.2,649,1,9,0)
 
"KRN",9.2,649,1,10,0)
 - Scroll forwards and backwards through a report. This means you don't lose
"KRN",9.2,649,1,11,0)
   reports "off the top" of the screen, like you do when you print to the
"KRN",9.2,649,1,12,0)
   HOME device. 
"KRN",9.2,649,1,13,0)
 
"KRN",9.2,649,1,14,0)
 - Use the Search feature to find and immediately jump to any text.
"KRN",9.2,649,1,15,0)
 
"KRN",9.2,649,1,16,0)
 - Copy text from the message to the VA FileMan Clipboard; later, if you're
"KRN",9.2,649,1,17,0)
   editing a mail message or other WORD-PROCESSING-type field with the VA
"KRN",9.2,649,1,18,0)
   FileMan Screen Editor, you can paste from the clipboard.
"KRN",9.2,649,1,19,0)
 
"KRN",9.2,649,1,20,0)
As you become accustomed to using the BROWSER device, you may find that you
"KRN",9.2,649,1,21,0)
start to save paper by viewing messages that you'd otherwise end up printing.
"KRN",9.2,650,-1)
0^179
"KRN",9.2,650,0)
XM-U-M-VAPORIZE DATE EDIT-2^VAPORIZE DATES (CONTINUED)^3000607.1522^^
"KRN",9.2,650,1,0)
^9.21^15^15^3000607^^^^
"KRN",9.2,650,1,1,0)

"KRN",9.2,650,1,2,0)
To set a 'vaporize' date for messages, do the following:
"KRN",9.2,650,1,3,0)
 
"KRN",9.2,650,1,4,0)
  * Individually - After reading a message, enter a 'V' at the 'Enter
"KRN",9.2,650,1,5,0)
    message action' prompt. MailMan will ask you for the vaporize date.
"KRN",9.2,650,1,6,0)
 
"KRN",9.2,650,1,7,0)
  * Group of Messages - Enter a 'V' at the basket option or command prompt.
"KRN",9.2,650,1,8,0)
 
"KRN",9.2,650,1,9,0)
      - MailMan will first ask you to select which messages you want
"KRN",9.2,650,1,10,0)
        to set the vaporize date for, including a [RANGE] of messages.
"KRN",9.2,650,1,11,0)
        Also, if you are using a full-screen reader, you can pre-[SELECT]
"KRN",9.2,650,1,12,0)
        messages and then set their vaporize date as a group.
"KRN",9.2,650,1,13,0)
 
"KRN",9.2,650,1,14,0)
      - MailMan will then ask you to confirm that you want to set the
"KRN",9.2,650,1,15,0)
        vaporize date, and will then ask you for that date.
"KRN",9.2,650,2,0)
^9.22A^2^2
"KRN",9.2,650,2,1,0)
RANGE^XM-U-M-CHOOSE RANGE
"KRN",9.2,650,2,2,0)
SELECT^XM-U-M-CHOOSE SELECT
"KRN",9.2,651,-1)
0^221
"KRN",9.2,651,0)
XM-U-P-OPTIONS-4^PERSONAL PREFERENCES (CONTINUED)^3000726.0641^^
"KRN",9.2,651,1,0)
^9.21^13^13^3000726^^^^
"KRN",9.2,651,1,1,0)
 
"KRN",9.2,651,1,2,0)
  * PRIORITY RESPONSES [FLAG] - Choose if you want to have responses to
"KRN",9.2,651,1,3,0)
    priority mail automatically delivered to you as priority or ordinary
"KRN",9.2,651,1,4,0)
    responses.
"KRN",9.2,651,1,5,0)
 
"KRN",9.2,651,1,6,0)
  * PRIORITY RESPONSES [PROMPT] - Choose if you want to be prompted each
"KRN",9.2,651,1,7,0)
    time to decide how future responses to a priority message are
"KRN",9.2,651,1,8,0)
    delivered to you.
"KRN",9.2,651,1,9,0)
 
"KRN",9.2,651,1,10,0)
  * [P-MESSAGE FROM] - Choose who you want your P-MESSAGEs to be from.
"KRN",9.2,651,1,11,0)
    It makes a difference.
"KRN",9.2,651,1,12,0)

"KRN",9.2,651,1,13,0)
[MORE]...
"KRN",9.2,651,2,0)
^9.22A^10^4
"KRN",9.2,651,2,7,0)
FLAG^XM-U-P-PRIORITY FLAG
"KRN",9.2,651,2,8,0)
PROMPT^XM-U-P-PRIORITY PROMPT
"KRN",9.2,651,2,9,0)
MORE^XM-U-P-OPTIONS-3
"KRN",9.2,651,2,10,0)
P-MESSAGE FROM^XM-U-P-P-MESSAGE FROM
"KRN",9.2,652,-1)
0^227
"KRN",9.2,652,0)
XM-U-P-READ NEW MSGS BSKT^READ NEW MESSAGES BASKET PRIORITY^3000726.070911^
"KRN",9.2,652,1,0)
^^19^19^3000726^
"KRN",9.2,652,1,1,0)
 
"KRN",9.2,652,1,2,0)
When you read new messages by basket, MailMan suggests the IN basket to
"KRN",9.2,652,1,3,0)
read first.  If you want MailMan to suggest other basket(s) before
"KRN",9.2,652,1,4,0)
suggesting the IN basket, then select a basket and choose its relative
"KRN",9.2,652,1,5,0)
priority (from 1 to 99).  (You will not be able to choose the IN basket.)
"KRN",9.2,652,1,6,0)
 
"KRN",9.2,652,1,7,0)
When you go to read new messages, if any of those baskets contain new
"KRN",9.2,652,1,8,0)
messages, MailMan will suggest reading them first, in the priority order
"KRN",9.2,652,1,9,0)
you set.  The IN basket will be suggested last.
"KRN",9.2,652,1,10,0)
 
"KRN",9.2,652,1,11,0)
If you deviate from the suggested priority basket, MailMan will stop
"KRN",9.2,652,1,12,0)
suggesting priority baskets, and will simply suggest the next basket in
"KRN",9.2,652,1,13,0)
alphabetical order.
"KRN",9.2,652,1,14,0)
 
"KRN",9.2,652,1,15,0)
Once all the priority baskets have been read, MailMan will suggest baskets
"KRN",9.2,652,1,16,0)
in alphabetical order.
"KRN",9.2,652,1,17,0)
 
"KRN",9.2,652,1,18,0)
To select baskets and their priority order, use the User Options Edit
"KRN",9.2,652,1,19,0)
option on the Personal Preferences menu. 
"KRN",9.2,653,-1)
0^216
"KRN",9.2,653,0)
XM-U-P-NEW MESSAGES READ ORDER^NEW MESSAGES READ ORDER^3000726.0734^
"KRN",9.2,653,1,0)
^9.21^21^21^3000726^^^
"KRN",9.2,653,1,1,0)
 
"KRN",9.2,653,1,2,0)
MailMan lets you choose the order in which you read your new messages:
"KRN",9.2,653,1,3,0)

"KRN",9.2,653,1,4,0)
  1. Newest First - This means that your new messages are read in reverse
"KRN",9.2,653,1,5,0)
     order (i.e., highest to lowest basket message sequence number order).
"KRN",9.2,653,1,6,0)
 
"KRN",9.2,653,1,7,0)
  2. Oldest First - This means that your new messages are read in message
"KRN",9.2,653,1,8,0)
     number order (i.e., lowest to highest basket message sequence number
"KRN",9.2,653,1,9,0)
     order).  This is the default if you don't choose an order.
"KRN",9.2,653,1,10,0)
 
"KRN",9.2,653,1,11,0)
Generally, the basket message sequence number order will correspond to the
"KRN",9.2,653,1,12,0)
message date sent order with the following exceptions:
"KRN",9.2,653,1,13,0)
 
"KRN",9.2,653,1,14,0)
  * Messages not originally sent to you but forwarded to you at a later
"KRN",9.2,653,1,15,0)
    date.
"KRN",9.2,653,1,16,0)
 
"KRN",9.2,653,1,17,0)
  * Messages sent from another location via the network (e.g., messages
"KRN",9.2,653,1,18,0)
    from a different site, FORUM messages).
"KRN",9.2,653,1,19,0)
 
"KRN",9.2,653,1,20,0)
To set your new message read order, use the User Options Edit option on the
"KRN",9.2,653,1,21,0)
Personal Preferences menu to answer the 'NEW MESSAGES READ ORDER:' prompt.
"KRN",9.2,654,-1)
0^215
"KRN",9.2,654,0)
XM-U-P-NEW MESSAGES OPTION^NEW MESSAGES DEFAULT OPTION^3000726.0753^^
"KRN",9.2,654,1,0)
^9.21^8^8^3000726^^^
"KRN",9.2,654,1,1,0)
 
"KRN",9.2,654,1,2,0)
The 'New Messages and Responses' option on the main menu brings up another
"KRN",9.2,654,1,3,0)
[MENU] of choices.  You may choose the default choice.
"KRN",9.2,654,1,4,0)
 
"KRN",9.2,654,1,5,0)
If you don't choose, then the default choice is 'Read new messages by basket'.
"KRN",9.2,654,1,6,0)

"KRN",9.2,654,1,7,0)
To set your default choice, use the User Options Edit option on the
"KRN",9.2,654,1,8,0)
Personal Preferences menu to answer the 'NEW MESSAGES DEFAULT OPTION:' prompt.
"KRN",9.2,654,2,0)
^9.22A^1^1
"KRN",9.2,654,2,1,0)
MENU^XM-U-R-READ NEW
"KRN",9.2,655,-1)
0^242
"KRN",9.2,655,0)
XM-U-Q-SEARCH CRITERIA USERS^SEARCH CRITERIA - SENDERS AND ADDRESSEES^3000830.085^^
"KRN",9.2,655,1,0)
^9.21^17^17^3000830^^
"KRN",9.2,655,1,1,0)

"KRN",9.2,655,1,2,0)
  * Sender of the Message - Enter the 'F' ('Message from') search action
"KRN",9.2,655,1,3,0)
    code and then enter the [LOCAL] USER NAME or [REMOTE] USER NAME.
"KRN",9.2,655,1,4,0)

"KRN",9.2,655,1,5,0)
  * Sender of a Response to the message - Enter the 'R' ('Response from')
"KRN",9.2,655,1,6,0)
    search action code and then enter the [LOCAL] USER NAME or
"KRN",9.2,655,1,7,0)
    [REMOTE] USER NAME.
"KRN",9.2,655,1,8,0)
 
"KRN",9.2,655,1,9,0)
  * Addressee of a Message - This includes messages addressed to a person
"KRN",9.2,655,1,10,0)
    or a mail group, server, or device.  MailMan will check the addressees
"KRN",9.2,655,1,11,0)
    that you see when you [QUERY] ('Q') the message.  MailMan will not check
"KRN",9.2,655,1,12,0)
    the expanded list of addresses that you see when you use the
"KRN",9.2,655,1,13,0)
    Query Detailed ('QD') action code.
"KRN",9.2,655,1,14,0)
 
"KRN",9.2,655,1,15,0)
    When searching on the addressee of a message, enter the 'T' ('Message
"KRN",9.2,655,1,16,0)
    to') search action code and then enter the [LOCAL] USER NAME or
"KRN",9.2,655,1,17,0)
    [REMOTE] USER NAME.
"KRN",9.2,655,2,0)
^9.22A^3^3
"KRN",9.2,655,2,1,0)
LOCAL^XM-U-A-LOCAL USER NAME
"KRN",9.2,655,2,2,0)
QUERY^XM-U-M-QUERY GENERAL
"KRN",9.2,655,2,3,0)
REMOTE^XM-U-Q-REMOTE USER NAME
"KRN",9.2,656,-1)
0^339
"KRN",9.2,656,0)
XM-U-Q-SEARCH CRITERIA DATE^SEARCH CRITERIA - DATE SENT^3020712.1025^
"KRN",9.2,656,1,0)
^9.21^13^13^3020712^^^^
"KRN",9.2,656,1,1,0)
 
"KRN",9.2,656,1,2,0)
  You may specify approximately when the message was sent.
"KRN",9.2,656,1,3,0)
 
"KRN",9.2,656,1,4,0)
      - Enter the 'DA' ('Message sent on or after') search action code
"KRN",9.2,656,1,5,0)
        to enter the lower end of the date range.
"KRN",9.2,656,1,6,0)
 
"KRN",9.2,656,1,7,0)
      - Enter the 'DB' ('Message sent on or before') search action code
"KRN",9.2,656,1,8,0)
        to enter to upper end of the date range.
"KRN",9.2,656,1,9,0)
 
"KRN",9.2,656,1,10,0)
  * If you are searching for messages anywhere on the system, whether they
"KRN",9.2,656,1,11,0)
    are in your mailbox or not, then a date range is mandatory, and defaults
"KRN",9.2,656,1,12,0)
    to the last 30 days, which you are free to change.  (If you are only
"KRN",9.2,656,1,13,0)
    searching your mailbox, then these are optional.)
"KRN",9.2,657,-1)
0^241
"KRN",9.2,657,0)
XM-U-Q-SEARCH CRITERIA TEXT^SEARCH CRITERIA - TEXT CONTENTS^3000830.091627^
"KRN",9.2,657,1,0)
^^16^16^3000830^
"KRN",9.2,657,1,1,0)
 
"KRN",9.2,657,1,2,0)
  * Specific Text in a Message - Enter the 'X' ('Message contains') search
"KRN",9.2,657,1,3,0)
    action code and then enter any portion of the message text string. The
"KRN",9.2,657,1,4,0)
    string can be from 3 to 30 characters in length (including spaces,
"KRN",9.2,657,1,5,0)
    symbols, and punctuation marks). MailMan prompts you to decide if the
"KRN",9.2,657,1,6,0)
    text search should be case sensitive. MailMan also prompts you to
"KRN",9.2,657,1,7,0)
    decide if the search should include:
"KRN",9.2,657,1,8,0)
 
"KRN",9.2,657,1,9,0)
      - Only the original message text.
"KRN",9.2,657,1,10,0)
 
"KRN",9.2,657,1,11,0)
      - Only the message responses text.
"KRN",9.2,657,1,12,0)
 
"KRN",9.2,657,1,13,0)
      - Both the original message and responses text.
"KRN",9.2,657,1,14,0)
 
"KRN",9.2,657,1,15,0)
    NOTE: If the string you are searching for is not all on one line in
"KRN",9.2,657,1,16,0)
          the message/responses, the search will not be able to find it.
"KRN",9.2,658,-1)
0^106
"KRN",9.2,658,0)
XM-U-K-PACKMAN^PACKMAN - MOVING ROUTINES AND DATA IN MESSAGES^3020502.0729^^
"KRN",9.2,658,1,0)
^9.21^21^21^3020502^^^^
"KRN",9.2,658,1,1,0)

"KRN",9.2,658,1,2,0)
PackMan is a method used to store and transport routines, data, and
"KRN",9.2,658,1,3,0)
packages via MailMan messages.  PackMan messages can be secured with
"KRN",9.2,658,1,4,0)
a Scramble [PASSWORD].  Users must hold the XUPROG and XUPROGMODE
"KRN",9.2,658,1,5,0)
security keys in order to fully use PackMan.
"KRN",9.2,658,1,6,0)
  
"KRN",9.2,658,1,7,0)
CREATING a Packman message:
"KRN",9.2,658,1,8,0)
  [ROUTINE LOAD]       Loads routines into a message.  
"KRN",9.2,658,1,9,0)
  [GLOBAL LOAD]        Loads global data into a message.  
"KRN",9.2,658,1,10,0)
  [PACKAGE] LOAD       Loads a package as defined in the PACKAGE file.  
"KRN",9.2,658,1,11,0)

"KRN",9.2,658,1,12,0)
INSTALLING a PackMan message:
"KRN",9.2,658,1,13,0)
  [PRINT] MESSAGE      Prints message, but recognizes content and puts it 
"KRN",9.2,658,1,14,0)
                     into a more easily read format than the standard 
"KRN",9.2,658,1,15,0)
                     message print.  
"KRN",9.2,658,1,16,0)
  [SUMMARIZE] MESSAGE  Summarizes the message content.  
"KRN",9.2,658,1,17,0)
  [COMPARE] MESSAGE    Compares routines in a PackMan message to those 
"KRN",9.2,658,1,18,0)
                     that are currently in use.  
"KRN",9.2,658,1,19,0)
  [INSTALL] MESSAGE    Installs the routines and globals. It will create 
"KRN",9.2,658,1,20,0)
                     a backup message of any routines that will be 
"KRN",9.2,658,1,21,0)
                     over-written, if you request it to.  
"KRN",9.2,658,2,0)
^9.22A^8^8
"KRN",9.2,658,2,1,0)
COMPARE^XM-U-K-PACKMAN COMPARE
"KRN",9.2,658,2,2,0)
GLOBAL LOAD^XM-U-K-PACKMAN LOAD GLOBALS
"KRN",9.2,658,2,3,0)
INSTALL^XM-U-K-PACKMAN INSTALL
"KRN",9.2,658,2,4,0)
PACKAGE^XM-U-K-PACKMAN LOAD PACKAGE
"KRN",9.2,658,2,5,0)
PASSWORD^XM-U-M-SCRAMBLE PASSWORD
"KRN",9.2,658,2,6,0)
PRINT^XM-U-K-PACKMAN PRINT
"KRN",9.2,658,2,7,0)
ROUTINE LOAD^XM-U-K-PACKMAN LOAD ROUTINES
"KRN",9.2,658,2,8,0)
SUMMARIZE^XM-U-K-PACKMAN SUMMARIZE
"KRN",9.2,659,-1)
0^2
"KRN",9.2,659,0)
XM-I-C-TALKMAN^TALKMAN^3020502.0901^^
"KRN",9.2,659,1,0)
^9.21^16^16^3020502^^
"KRN",9.2,659,1,1,0)

"KRN",9.2,659,1,2,0)
TalkMan connects a user to a remote system and then hands off control
"KRN",9.2,659,1,3,0)
to the user, who can then log onto the remote system.
"KRN",9.2,659,1,4,0)

"KRN",9.2,659,1,5,0)
TalkMan can connect to any domain in the DOMAIN file whose FLAGS field
"KRN",9.2,659,1,6,0)
contains a "T", and which has a TELNET, or TalkMan type script.
"KRN",9.2,659,1,7,0)

"KRN",9.2,659,1,8,0)
Once in the TalkMan session, the user can get TalkMan's attention by
"KRN",9.2,659,1,9,0)
typing <CTRL>A (pressing the CTRL and A keys simultaneously) and can then
"KRN",9.2,659,1,10,0)

"KRN",9.2,659,1,11,0)
[CAPTURE] the session into a message
"KRN",9.2,659,1,12,0)

"KRN",9.2,659,1,13,0)
[END]     the session
"KRN",9.2,659,1,14,0)

"KRN",9.2,659,1,15,0)
If <CTRL>A was typed by mistake, simply press the <RETURN> key to continue
"KRN",9.2,659,1,16,0)
the session.
"KRN",9.2,659,2,0)
^9.22A^2^2
"KRN",9.2,659,2,1,0)
CAPTURE^XM-I-C-TALKMAN CAPTURE
"KRN",9.2,659,2,2,0)
END^XM-I-C-TALKMAN END
"KRN",9.2,660,-1)
0^4
"KRN",9.2,660,0)
XM-I-C-TALKMAN END^ENDING A TALKMAN SESSION^3020502.090232^
"KRN",9.2,660,1,0)
^^7^7^3020502^
"KRN",9.2,660,1,1,0)

"KRN",9.2,660,1,2,0)
To end a TalkMan session, do the following:
"KRN",9.2,660,1,3,0)

"KRN",9.2,660,1,4,0)
Press <CTRL>A to get TalkMan's attention.  You will be at a command line.
"KRN",9.2,660,1,5,0)

"KRN",9.2,660,1,6,0)
Then enter 'E' (for End).  You will be back on the system from which the
"KRN",9.2,660,1,7,0)
TalkMan session was invoked.
"KRN",9.2,661,-1)
0^3
"KRN",9.2,661,0)
XM-I-C-TALKMAN CAPTURE^CAPTURING A TALKMAN SESSION^3020502.0928^
"KRN",9.2,661,1,0)
^9.21^18^18^3020502^^
"KRN",9.2,661,1,1,0)

"KRN",9.2,661,1,2,0)
To capture the TalkMan session in a MailMan message, do the following:
"KRN",9.2,661,1,3,0)

"KRN",9.2,661,1,4,0)
Press <CTRL>A to get TalkMan's attention.  You will be at a command line.
"KRN",9.2,661,1,5,0)

"KRN",9.2,661,1,6,0)
Then enter 'C' (for Capture).  Your session will be captured from that
"KRN",9.2,661,1,7,0)
point on, and you will be returned to your session.
"KRN",9.2,661,1,8,0)

"KRN",9.2,661,1,9,0)
All interaction is captured, minus any control characters.  Any line longer
"KRN",9.2,661,1,10,0)
than 75 characters will be broken up into 75-character lines.  The captured
"KRN",9.2,661,1,11,0)
session may look strange if it includes any screen mode interaction.
"KRN",9.2,661,1,12,0)

"KRN",9.2,661,1,13,0)
When you're ready to end the capture, press <CTRL>A to get TalkMan's
"KRN",9.2,661,1,14,0)
attention, and then enter 'S' (for Stop capture) or 'E' (for End session).
"KRN",9.2,661,1,15,0)

"KRN",9.2,661,1,16,0)
The MailMan message will be sent to you.  Its subject will be made up
"KRN",9.2,661,1,17,0)
of your name and the current date/time, as follows:
"KRN",9.2,661,1,18,0)
   <last,first> CAPTURE <date@time>
"KRN",9.2,662,-1)
0^5
"KRN",9.2,662,0)
XM-I-D-RECOVER MSGS^RECOVER MESSAGES FOR A USER^3020502.1351^^
"KRN",9.2,662,1,0)
^9.21^21^21^3020502^^
"KRN",9.2,662,1,1,0)

"KRN",9.2,662,1,2,0)
The 'Recover Messages' option enables you to find all messages still on
"KRN",9.2,662,1,3,0)
the system which were ever sent to a particular user, and deliver them
"KRN",9.2,662,1,4,0)
to that user if they're not already in that user's mailbox.  Obviously,
"KRN",9.2,662,1,5,0)
this is sledgehammer approach to recovering from some disaster that
"KRN",9.2,662,1,6,0)
happened to that poor user.  There are four parts to this process.
"KRN",9.2,662,1,7,0)

"KRN",9.2,662,1,8,0)
    1.  [FIND] lost messages
"KRN",9.2,662,1,9,0)
    2.  [LIST] the messages that were found
"KRN",9.2,662,1,10,0)
    3.  [SHOW] messages already in user's mailbox
"KRN",9.2,662,1,11,0)
    4.  [PUT] messages into user's 'IN' basket 
"KRN",9.2,662,1,12,0)
  
"KRN",9.2,662,1,13,0)
The procedure may be followed steps 1 thru 4.  Steps 2 and 3 exist only
"KRN",9.2,662,1,14,0)
so that the user may see the message count, and determine whether all
"KRN",9.2,662,1,15,0)
messages should be recovered via the load option.  If a user has received
"KRN",9.2,662,1,16,0)
900 messages that are recovered, it may be well to allow him/her to recover
"KRN",9.2,662,1,17,0)
a small portion of them manually.  
"KRN",9.2,662,1,18,0)
  
"KRN",9.2,662,1,19,0)
Alternatively, the user should be encouraged to use the [SEARCH] option
"KRN",9.2,662,1,20,0)
to find messages.  This option is much more powerful, in that the user can
"KRN",9.2,662,1,21,0)
tailor it with multiple search criteria.
"KRN",9.2,662,2,0)
^9.22A^5^5
"KRN",9.2,662,2,1,0)
FIND^XM-I-D-RECOVER MSGS-FIND
"KRN",9.2,662,2,2,0)
LIST^XM-I-D-RECOVER MSGS-LIST
"KRN",9.2,662,2,3,0)
PUT^XM-I-D-RECOVER MSGS-PUT
"KRN",9.2,662,2,4,0)
SEARCH^XM-U-Q-SEARCH SYSTEM
"KRN",9.2,662,2,5,0)
SHOW^XM-U-B-BASKET CONTENTS LIST
"KRN",9.2,663,-1)
0^6
"KRN",9.2,663,0)
XM-I-D-RECOVER MSGS-FIND^RECOVER MESSAGES FOR A USER - FIND THEM^3020502.135654^
"KRN",9.2,663,1,0)
^^5^5^3020502^
"KRN",9.2,663,1,1,0)

"KRN",9.2,663,1,2,0)
The 'Find Messages' option goes through all the messages in the MAILBOX
"KRN",9.2,663,1,3,0)
file (not the MESSAGE file!) and creates a list (in a temp global) of
"KRN",9.2,663,1,4,0)
all the messages addressed to the user, but not in the user's mailbox,
"KRN",9.2,663,1,5,0)
and not terminated by the user.
"KRN",9.2,664,-1)
0^8
"KRN",9.2,664,0)
XM-I-D-RECOVER MSGS-PUT^RECOVER MESSAGES FOR A USER - PUT IN USER'S MAILBOX^3020502.140857^
"KRN",9.2,664,1,0)
^^8^8^3020502^
"KRN",9.2,664,1,1,0)

"KRN",9.2,664,1,2,0)
This option presumes that you have finished
"KRN",9.2,664,1,3,0)
   'Find' the messages
"KRN",9.2,664,1,4,0)
   'List' the messages found
"KRN",9.2,664,1,5,0)

"KRN",9.2,664,1,6,0)
This option lets you (with the user looking over your shoulder) select
"KRN",9.2,664,1,7,0)
which of the messages that were found should be placed into the user's
"KRN",9.2,664,1,8,0)
'IN' basket.  There might be hundreds or thousands of messages to consider.
"KRN",9.2,665,-1)
0^7
"KRN",9.2,665,0)
XM-I-D-RECOVER MSGS-LIST^RECOVER MESSAGES FOR A USER - LIST THEM^3020502.141756^
"KRN",9.2,665,1,0)
^^14^14^3020502^
"KRN",9.2,665,1,1,0)

"KRN",9.2,665,1,2,0)
This option presumes that you have finished
"KRN",9.2,665,1,3,0)
  'Find' messages for a user
"KRN",9.2,665,1,4,0)

"KRN",9.2,665,1,5,0)
This option lets you show the user which messages were found.
"KRN",9.2,665,1,6,0)
Use the 'List Messages Found' option after searching for messages and
"KRN",9.2,665,1,7,0)
before loading them into the user's 'IN' basket.  The user may not want
"KRN",9.2,665,1,8,0)
all the messages and may find it easier to access them one at a time
"KRN",9.2,665,1,9,0)
using the MailMan option that searches for messages.
"KRN",9.2,665,1,10,0)

"KRN",9.2,665,1,11,0)
The 'List Messages Found' option will report on all the messages found
"KRN",9.2,665,1,12,0)
and give sufficient information about them to allow searches to be made
"KRN",9.2,665,1,13,0)
effectively.  Give the user a copy of this report before continuing with
"KRN",9.2,665,1,14,0)
the series of routines and performing the load.  
"KRN",9.2,666,-1)
0^27
"KRN",9.2,666,0)
XM-I-NEW FEATURES^NEW FEATURES FOR SITE MANAGERS^3020506.101204^
"KRN",9.2,666,1,0)
^^82^82^3020506^
"KRN",9.2,666,1,1,0)

"KRN",9.2,666,1,2,0)
MailMan 8.0 offers the following improvements over MailMan 7.1:
"KRN",9.2,666,1,3,0)

"KRN",9.2,666,1,4,0)
1. MailMan is now DNS aware.  It can use the Kernel API MAIL^XLFNSLK
"KRN",9.2,666,1,5,0)
to retrieve IP addresses.  It is no longer necessary to manually update the
"KRN",9.2,666,1,6,0)
IP addresses in the DOMAIN file, 4.2.  The IP address fields will remain in
"KRN",9.2,666,1,7,0)
file 4.2, and MailMan will use them.  However, if they don't work, MailMan
"KRN",9.2,666,1,8,0)
will use the Kernel API to retrieve a list of valid IP addresses.  When
"KRN",9.2,666,1,9,0)
MailMan finds one that works, MailMan will replace the non-working IP
"KRN",9.2,666,1,10,0)
address with the working one.  In order to activate DNS awareness, this
"KRN",9.2,666,1,11,0)
new field in the MAILMAN SITE PARAMETERS file 4.3 must be set to 'yes':
"KRN",9.2,666,1,12,0)
     4.3,8.22   DNS AWARE                        Yes or No?
"KRN",9.2,666,1,13,0)
Also, routine ^XLFNSLK must exist, and the following field in the
"KRN",9.2,666,1,14,0)
KERNEL SYSTEMS PARAMETERS file 8989.3 must be properly filled in with
"KRN",9.2,666,1,15,0)
an IP address:
"KRN",9.2,666,1,16,0)
     8989.3,51  DNS IP                           IP address for DNS
"KRN",9.2,666,1,17,0)

"KRN",9.2,666,1,18,0)
2. For TCP/IP connections, MailMan can now build transmission scripts on
"KRN",9.2,666,1,19,0)
the fly. For transmission scripts whose TYPE is "SMTP", "TCPCHAN", or null,
"KRN",9.2,666,1,20,0)
the transmission scripts (in the TEXT field 2, in the TRANSMISSION SCRIPT
"KRN",9.2,666,1,21,0)
multiple) in the DOMAIN file, 4.2, are no longer used if these new fields
"KRN",9.2,666,1,22,0)
in the MAILMAN SITE PARAMETERS file 4.3 are filled in:
"KRN",9.2,666,1,23,0)
     4.3,8.23   TCP/IP COMMUNICATIONS PROTOCOL   Points to file 3.4
"KRN",9.2,666,1,24,0)
     4.3,8.24   TCP/IP TRANSMISSION SCRIPT       Points to file 4.6
"KRN",9.2,666,1,25,0)

"KRN",9.2,666,1,26,0)
3. Messages in transmit queues can now be designated as low priority, as
"KRN",9.2,666,1,27,0)
well as high priority.  If a message gets stuck in a transmit queue and is
"KRN",9.2,666,1,28,0)
holding up the rest of the queue for whatever reason, MailMan will make
"KRN",9.2,666,1,29,0)
that message a low priority message, so that all the other messages are
"KRN",9.2,666,1,30,0)
transmitted ahead of it.  The postmaster can also make these priority
"KRN",9.2,666,1,31,0)
changes.  In the message queue, high-priority messages are now marked with
"KRN",9.2,666,1,32,0)
'^', instead of '$'.  Low priority messages are marked with 'v'.
"KRN",9.2,666,1,33,0)

"KRN",9.2,666,1,34,0)
The postmaster can now change the transmit priority at the message level
"KRN",9.2,666,1,35,0)
(at the 'Message action: Ignore//' prompt).  As at the basket level, the
"KRN",9.2,666,1,36,0)
command to use is 'X'.  (In a user basket, the 'X' at the message level is
"KRN",9.2,666,1,37,0)
a command to unload a PackMan message or KIDS build.  In a remote transmit
"KRN",9.2,666,1,38,0)
queue, the 'X' changes the transmit priority.  The difference is the
"KRN",9.2,666,1,39,0)
context, and writers of MailMan front-ends should take note!)
"KRN",9.2,666,1,40,0)

"KRN",9.2,666,1,41,0)
4. MailMan date/times are now in a standard format, produced by the Kernel
"KRN",9.2,666,1,42,0)
API: $$FMTE^XLFDT(datetime,"2Z").  Previously, 3020803.153204 would be
"KRN",9.2,666,1,43,0)
displayed as '03 Aug 02 15:32'.  Now, it is displayed as '08/03/02@15:32'.
"KRN",9.2,666,1,44,0)
This change is also carried through to all MailMan APIs which return
"KRN",9.2,666,1,45,0)
date/time in MailMan format.
"KRN",9.2,666,1,46,0)

"KRN",9.2,666,1,47,0)
5. MailMan remote message IDs now include the message date, to ensure that
"KRN",9.2,666,1,48,0)
if you are told that a message is a duplicate of a previously received
"KRN",9.2,666,1,49,0)
message, it really is.  Sites will no longer have problems sending messages
"KRN",9.2,666,1,50,0)
from a production account to a test account which was created by "mirroring"
"KRN",9.2,666,1,51,0)
the production account.  The remote message ID is now the message number
"KRN",9.2,666,1,52,0)
following by a period, followed by the 7-digit FileMan message creation
"KRN",9.2,666,1,53,0)
date.  Before, a remote message ID might be 34561234@FORUM.VA.GOV.  Now it
"KRN",9.2,666,1,54,0)
would be 34561234.3020803@FORUM.VA.GOV.
"KRN",9.2,666,1,55,0)

"KRN",9.2,666,1,56,0)
6. The ^XMC*, ^XMR*, ^XMS* suite of routines, which are responsible for
"KRN",9.2,666,1,57,0)
scheduling, transmitting to, and receiving messages from remote sites, have
"KRN",9.2,666,1,58,0)
been completely overhauled to make them easier to understand and easier to
"KRN",9.2,666,1,59,0)
maintain.
"KRN",9.2,666,1,60,0)

"KRN",9.2,666,1,61,0)
7. MailMan will no longer display user names by taking them directly from
"KRN",9.2,666,1,62,0)
the .01 field of the NEW PERSON file, 200.  The API, $$NAMEFMT^XLFNAME,
"KRN",9.2,666,1,63,0)
supplied as part of the Name Standardization project, is used, instead.
"KRN",9.2,666,1,64,0)
Thus, the names of people whose last names, for instance, contain periods,
"KRN",9.2,666,1,65,0)
apostrophes, or spaces, are properly displayed (ST. IVES, O'MALLEY, and
"KRN",9.2,666,1,66,0)
VAN DYKE), instead of improperly (STIVES, OMALLEY, and VANDYKE).
"KRN",9.2,666,1,67,0)

"KRN",9.2,666,1,68,0)
8. Messages with responses may no longer be forwarded to broadcast to all
"KRN",9.2,666,1,69,0)
users.  Such messages may have important information in the responses, and as
"KRN",9.2,666,1,70,0)
we all know, responses are not auto-forwarded to remote sites for users with
"KRN",9.2,666,1,71,0)
auto-forward addresses.  Users who attempt to broadcast messages with responses
"KRN",9.2,666,1,72,0)
will be encouraged to copy the message and its responses into a new message,
"KRN",9.2,666,1,73,0)
which can be broadcast. 
"KRN",9.2,666,1,74,0)

"KRN",9.2,666,1,75,0)
9. Incoming PackMan and KIDS messages are no longer subject to the
"KRN",9.2,666,1,76,0)
restriction NETWORK - MAX LINES RECEIVE (field 8.31, file 4.3).  Other kinds
"KRN",9.2,666,1,77,0)
of messages continue to be subject to that restriction.
"KRN",9.2,666,1,78,0)

"KRN",9.2,666,1,79,0)
10. If a task transmitting messages to another site fails and has to be
"KRN",9.2,666,1,80,0)
requeued, it really is requeued.  Previously, that wasn't true.  Previously,
"KRN",9.2,666,1,81,0)
the failing task queued up a new task to take its place, and then the
"KRN",9.2,666,1,82,0)
failing task stopped.
"KRN",9.2,667,-1)
0^18
"KRN",9.2,667,0)
XM-I-N-NETWORK^NETWORK OVERVIEW^3020509.0723^^
"KRN",9.2,667,1,0)
^9.21^16^16^3020509^^^^
"KRN",9.2,667,1,1,0)

"KRN",9.2,667,1,2,0)
Certain fields in the [MAILMAN SITE PARAMETERS] file and all fields in the
"KRN",9.2,667,1,3,0)
[DOMAIN] file are relevant to network transmission.
"KRN",9.2,667,1,4,0)

"KRN",9.2,667,1,5,0)
When a user addresses a message to a remote site, MailMan checks the relevant
"KRN",9.2,667,1,6,0)
[ADDRESS]ing fields in the Domain file to see how it should be handled.  When
"KRN",9.2,667,1,7,0)
the user hits 'transmit', the message is placed in a basket, or [QUEUE],
"KRN",9.2,667,1,8,0)
belonging to the Postmaster.
"KRN",9.2,667,1,9,0)

"KRN",9.2,667,1,10,0)
If the message should be sent immediately, MailMan schedules a [TASK], if one
"KRN",9.2,667,1,11,0)
isn't already scheduled, to send it and any other messages in the queue.  If
"KRN",9.2,667,1,12,0)
the task encounters any problems with the transmission, MailMan sends a
"KRN",9.2,667,1,13,0)
[BULLETIN] to the Postmaster. 
"KRN",9.2,667,1,14,0)

"KRN",9.2,667,1,15,0)
Other possibilities for transmission include [SCHEDULE]ing a task, [PLAY]ing
"KRN",9.2,667,1,16,0)
a script, [POLL]ing the site, dumping to [TAPE], or [INTER-UCI] transfer. 
"KRN",9.2,667,2,0)
^9.22A^13^11
"KRN",9.2,667,2,1,0)
BULLETIN^XM-I-N-BULLETINS
"KRN",9.2,667,2,2,0)
MAILMAN SITE PARAMETERS^XM-I-S-SITE PARAMETERS-REMOTE
"KRN",9.2,667,2,4,0)
INTER-UCI^XM-I-N-XMIT UCI
"KRN",9.2,667,2,5,0)
PLAY^XM-I-N-XMIT PLAY
"KRN",9.2,667,2,7,0)
QUEUE^XM-I-N-XMIT QUEUES
"KRN",9.2,667,2,8,0)
TAPE^XM-I-N-XMIT TAPE
"KRN",9.2,667,2,9,0)
TASK^XM-I-N-XMIT TASK
"KRN",9.2,667,2,10,0)
DOMAIN^XM-I-N-DOMAIN FILE
"KRN",9.2,667,2,11,0)
POLL^XM-I-N-XMIT POLL
"KRN",9.2,667,2,12,0)
ADDRESS^XM-I-N-DOMAIN FILE-ADDRESSING
"KRN",9.2,667,2,13,0)
SCHEDULE^XM-I-N-XMIT SCHEDULE TASK
"KRN",9.2,668,-1)
0^34
"KRN",9.2,668,0)
XM-I-S-SITE PARAMETERS-LOCAL^SITE PARAMETERS AFFECTING LOCAL MESSAGES^3020506.1531^^
"KRN",9.2,668,1,0)
^9.21^15^15^3020506^^
"KRN",9.2,668,1,1,0)

"KRN",9.2,668,1,2,0)
Here are some Site Parameters in file 4.3 which can affect local messages:
"KRN",9.2,668,1,3,0)

"KRN",9.2,668,1,4,0)
  Use the COPY LIMIT fields (#5.11, 5.12, 5.13) to limit which messages may
"KRN",9.2,668,1,5,0)
  be copied, including setting a limit on number of lines and responses.
"KRN",9.2,668,1,6,0)
 
"KRN",9.2,668,1,7,0)
  Use the [P-MESSAGE LINE LIMIT] field (#16.1) to set the maximum
"KRN",9.2,668,1,8,0)
  number of lines that can be written to the P-MESSAGE [DEVICE].
"KRN",9.2,668,1,9,0)

"KRN",9.2,668,1,10,0)
  Use [BIG GROUP SIZE] field (#7.2) to indicate when a mail group is
"KRN",9.2,668,1,11,0)
  considered 'large.'
"KRN",9.2,668,1,12,0)

"KRN",9.2,668,1,13,0)
  Use the [MAX DIGITS FOR MESSAGE NUMBER] field (#17.1) to set the maximum
"KRN",9.2,668,1,14,0)
  number of digits that can comprise a MailMan internal message
"KRN",9.2,668,1,15,0)
  identification number before they recycle back and start again from 100,000.
"KRN",9.2,668,2,0)
^9.22A^4^4
"KRN",9.2,668,2,1,0)
BIG GROUP SIZE^XM-I-S-BIG GROUP SIZE
"KRN",9.2,668,2,2,0)
MAX DIGITS FOR MESSAGE NUMBER^XM-I-S-MAX DIGITS FOR MSG NUM
"KRN",9.2,668,2,3,0)
DEVICE^XM-U-M-PRINT DEVICE P-MESSAGE
"KRN",9.2,668,2,4,0)
P-MESSAGE LINE LIMIT^XM-I-S-MESSAGE LINE LIMIT
"KRN",9.2,669,-1)
0^36
"KRN",9.2,669,0)
XM-I-S-SITE PARAMETERS-USER^SITE PARAMETERS AFFECTING USERS^3020507.0718^^
"KRN",9.2,669,1,0)
^9.21^20^20^3020507^^^
"KRN",9.2,669,1,1,0)

"KRN",9.2,669,1,2,0)
Here are some Site Parameters in file 4.3 which can affect local users.
"KRN",9.2,669,1,3,0)
(Default in each case is NO, except where specified.)
"KRN",9.2,669,1,4,0)

"KRN",9.2,669,1,5,0)
  Use REQUIRE INTRODUCTIONS? (field #7) to force a user to [INTRODUCE] himself.
"KRN",9.2,669,1,6,0)

"KRN",9.2,669,1,7,0)
  Use SHOW DUZ WHEN ADDRESS MESSAGE (field #7.3) to show a user's DUZ when a
"KRN",9.2,669,1,8,0)
  message is addressed to that user.  If the user's name is a common one, it
"KRN",9.2,669,1,9,0)
  might be easier for some people to address a message using the DUZ, rather
"KRN",9.2,669,1,10,0)
  than the name.  (Don't set this field if your site uses SSNs as DUZs.)
"KRN",9.2,669,1,11,0)

"KRN",9.2,669,1,12,0)
  Use SHOW ADDRESS ON USER LOOKUP (field #7.4) to show a user's address
"KRN",9.2,669,1,13,0)
  (fields #.111 through .116 in file 200) when showing help on that user.
"KRN",9.2,669,1,14,0)
  (Don't set this if your site puts home addresses in these fields.)
"KRN",9.2,669,1,15,0)

"KRN",9.2,669,1,16,0)
  Use MESSAGE ACTION DEFAULT (field #5.1) to set the default message action
"KRN",9.2,669,1,17,0)
  to either "Ignore" or "Delete" after a user has read a message.  (Default
"KRN",9.2,669,1,18,0)
  is "Ignore".)  The user can [OVERRIDE] this.
"KRN",9.2,669,1,19,0)

"KRN",9.2,669,1,20,0)
[MORE]...
"KRN",9.2,669,2,0)
^9.22A^3^3
"KRN",9.2,669,2,1,0)
INTRODUCE^XM-U-P-INTRODUCTION
"KRN",9.2,669,2,2,0)
MORE^XM-I-S-SITE PARAMETERS-USER-2
"KRN",9.2,669,2,3,0)
OVERRIDE^XM-U-P-MESSAGE ACTION DEFAULT
"KRN",9.2,670,-1)
0^37
"KRN",9.2,670,0)
XM-I-S-SITE PARAMETERS-USER-2^SITE PARAMETERS AFFECTING USERS (CONTINUED)^3020507.0731^^
"KRN",9.2,670,1,0)
^9.21^13^13^3020507^^^
"KRN",9.2,670,1,1,0)

"KRN",9.2,670,1,2,0)
  Use FORWARD PRIORITY MAIL TO GROUP (field #21) to allow users to forward
"KRN",9.2,670,1,3,0)
  priority messages to mail groups.
"KRN",9.2,670,1,4,0)

"KRN",9.2,670,1,5,0)
  Use DROP OUT OF RESTRICTED GROUP (field #22) to allow users to drop out of
"KRN",9.2,670,1,6,0)
  restricted mail groups.  These are groups that don't allow self-enrollment.
"KRN",9.2,670,1,7,0)

"KRN",9.2,670,1,8,0)
  Use TITLE SOURCE (field #23) to indicate which field the user's title should
"KRN",9.2,670,1,9,0)
  should be taken from.  Some sites prefer that it come from TITLE (field #8
"KRN",9.2,670,1,10,0)
  in file 200), other sites prefer SIGNATURE BLOCK TITLE (field #20.3 in file
"KRN",9.2,670,1,11,0)
  200).  The default is TITLE.  A user's [TITLE] may be displayed during message
"KRN",9.2,670,1,12,0)
  addressing if the user doing the addressing has indicated that in his
"KRN",9.2,670,1,13,0)
  personal preferences. 
"KRN",9.2,670,2,0)
^9.22A^1^1
"KRN",9.2,670,2,1,0)
TITLE^XM-U-P-SHOW TITLES
"KRN",9.2,671,-1)
0^33
"KRN",9.2,671,0)
XM-I-S-SITE PARAMETERS-ID^SITE PARAMETERS AFFECTING THE SITE^3020507.0817^
"KRN",9.2,671,1,0)
^9.21^21^21^3020507^^
"KRN",9.2,671,1,1,0)

"KRN",9.2,671,1,2,0)
Here are some Site Parameters in file 4.3 which affect the site:
"KRN",9.2,671,1,3,0)

"KRN",9.2,671,1,4,0)
  Use TIME ZONE (field #1) to indicate which time zone your site is in.  If
"KRN",9.2,671,1,5,0)
  your time zone shifts twice a year ("fall back and spring ahead"), then you
"KRN",9.2,671,1,6,0)
  must change this field manually.  Don't forget!  The time zone is attached
"KRN",9.2,671,1,7,0)
  to the date field of every message sent to another site.
"KRN",9.2,671,1,8,0)

"KRN",9.2,671,1,9,0)
  Use PARENT (field #3) to indicate the PARENT domain for your site.  For
"KRN",9.2,671,1,10,0)
  your production account, it would be either FORUM or GK.  For other accounts,
"KRN",9.2,671,1,11,0)
  it may be the production account.  In any case, an account can't be its own
"KRN",9.2,671,1,12,0)
  parent.  The parent is the site that mail is directed to if your site can't
"KRN",9.2,671,1,13,0)
  figure out (it's not in your Domain file) how to direct mail to another site.
"KRN",9.2,671,1,14,0)
  The hope is, of course, that the parent site will know.
"KRN",9.2,671,1,15,0)

"KRN",9.2,671,1,16,0)
  NOTE: Do NOT change the NAME (field #.01) in your production account.
"KRN",9.2,671,1,17,0)
  Name changes must be coordinated with national VA DNS administrators and
"KRN",9.2,671,1,18,0)
  MailMan developers, and must be done via a MailMan patch.  For non-production
"KRN",9.2,671,1,19,0)
  accounts, you should use the XMCHRIS option to perform any name changes, and
"KRN",9.2,671,1,20,0)
  make sure these changes are reflected in the Domain files of other accounts
"KRN",9.2,671,1,21,0)
  which communicate with that account.
"KRN",9.2,672,-1)
0^35
"KRN",9.2,672,0)
XM-I-S-SITE PARAMETERS-REMOTE^SITE PARAMETERS AFFECTING REMOTE MESSAGING^3020507.1043^
"KRN",9.2,672,1,0)
^9.21^21^21^3020507^^
"KRN",9.2,672,1,1,0)

"KRN",9.2,672,1,2,0)
Here are some Site Parameters in file 4.3 which affect remote messaging:
"KRN",9.2,672,1,3,0)

"KRN",9.2,672,1,4,0)
  Use NETWORK - MAX LINES SEND (field #8.3) to restrict the number of lines
"KRN",9.2,672,1,5,0)
  in a message that may be sent to another site.
"KRN",9.2,672,1,6,0)

"KRN",9.2,672,1,7,0)
  Use NETWORK - MAX LINES RECEIVE (field #8.31) to restrict the number of lines
"KRN",9.2,672,1,8,0)
  in a message that may be received from another site.
"KRN",9.2,672,1,9,0)

"KRN",9.2,672,1,10,0)
  Use DNS AWARE (field #8.22) to let MailMan use DNS to look up IP addresses.
"KRN",9.2,672,1,11,0)

"KRN",9.2,672,1,12,0)
  Use TCP/IP COMMUNICATIONS PROTOCOL (field #8.23) and TCP/IP TRANSMISSION
"KRN",9.2,672,1,13,0)
  SCRIPT (field #8.24) to enable MailMan to automatically build TCP/IP
"KRN",9.2,672,1,14,0)
  transmission scripts to transmit messages to another site.
"KRN",9.2,672,1,15,0)

"KRN",9.2,672,1,16,0)
  Use XMITS TILL ERROR MESSAGE (field #8.21) to indicate the number of times
"KRN",9.2,672,1,17,0)
  the transmission may fail before the Postmaster is notified of a problem
"KRN",9.2,672,1,18,0)
  and MailMan moves on to try another script.
"KRN",9.2,672,1,19,0)

"KRN",9.2,672,1,20,0)
  Use RECORD NETMAIL TRANSCRIPT? (field #8.2) to record every communications
"KRN",9.2,672,1,21,0)
  session with another site.  (Only 100 total sessions are kept.)
"KRN",9.2,673,-1)
0^32
"KRN",9.2,673,0)
XM-I-S-SITE PARAMETERS-DISK^SITE PARAMETERS AFFECTING DISK SPACE MANAGEMENT^3020507.0941^
"KRN",9.2,673,1,0)
^9.21^31^31^3020507^^
"KRN",9.2,673,1,1,0)

"KRN",9.2,673,1,2,0)
Here are some Site Parameters in file 4.3 which affect disk space management.
"KRN",9.2,673,1,3,0)
For these fields, see both the options and the DDs for more information:
"KRN",9.2,673,1,4,0)

"KRN",9.2,673,1,5,0)
These fields are used by option XMAUTOPURGE to purge unreferenced messages:
"KRN",9.2,673,1,6,0)

"KRN",9.2,673,1,7,0)
  Use NO-PURGE DAYS BUFFER (field #4.301) to protect the newest messages.
"KRN",9.2,673,1,8,0)

"KRN",9.2,673,1,9,0)
  Use NO-PURGE DAYS BUFFER (LOCAL) (field #142) to protect the newest locally
"KRN",9.2,673,1,10,0)
  created messages.
"KRN",9.2,673,1,11,0)

"KRN",9.2,673,1,12,0)
  Use WEEKDAY DAYS TO PURGE (field #4.304) to limit the purge to messages
"KRN",9.2,673,1,13,0)
  created recently, when the purge is run on weekdays.  When the purge is
"KRN",9.2,673,1,14,0)
  run on Saturdays, this field is ignored, and every message is considered.
"KRN",9.2,673,1,15,0)

"KRN",9.2,673,1,16,0)
  Use AUTOMATIC INTEGRITY CHECK (field #4.303) to indicate whether an integrity
"KRN",9.2,673,1,17,0)
  check of the Mailbox file 3.7 should be run before the purge.
"KRN",9.2,673,1,18,0)

"KRN",9.2,673,1,19,0)
These fields are used by option XMPURGE-BY-DATE:
"KRN",9.2,673,1,20,0)

"KRN",9.2,673,1,21,0)
  Use DATE PURGE CUTOFF DAYS (field #10.03) to calculate a cutoff date.
"KRN",9.2,673,1,22,0)

"KRN",9.2,673,1,23,0)
  Use DATE PURGE GRACE PERIOD (field #10.04) to give users a warning.
"KRN",9.2,673,1,24,0)

"KRN",9.2,673,1,25,0)
These fields are used by option XMMGR-IN-BASKET-PURGE:
"KRN",9.2,673,1,26,0)

"KRN",9.2,673,1,27,0)
  Use IN-BASKET-PURGE DAYS (field #10) to indicate how many days a message
"KRN",9.2,673,1,28,0)
  may remain unread before being considered for purge.
"KRN",9.2,673,1,29,0)

"KRN",9.2,673,1,30,0)
  Use IN-BASKET-PURGE TYPE (field #10.01) to indicate whether the purge
"KRN",9.2,673,1,31,0)
  applies to the IN basket only (default) or to all baskets.
"KRN",9.2,674,-1)
0^21
"KRN",9.2,674,0)
XM-I-N-XMIT QUEUES^TRANSMIT QUEUES^3020508.0834^
"KRN",9.2,674,1,0)
^9.21^16^16^3020508^^
"KRN",9.2,674,1,1,0)

"KRN",9.2,674,1,2,0)
When a message is addressed to a remote site, the message is placed in a
"KRN",9.2,674,1,3,0)
special basket in the Postmaster's (DUZ=.5) mailbox (file 3.7).  This basket
"KRN",9.2,674,1,4,0)
is also called a queue.  The basket IEN is 1000 plus the IEN of the Domain in
"KRN",9.2,674,1,5,0)
the Domain file (4.2).  The basket name is the name of the Domain.  For
"KRN",9.2,674,1,6,0)
example, if the message is addressed to someone at FORUM, and FORUM.VA.GOV is
"KRN",9.2,674,1,7,0)
at IEN 4 in file 4.2, then the message is placed in the Postmaster's mailbox,
"KRN",9.2,674,1,8,0)
in a basket named FORUM.VA.GOV, whose IEN is 1004.  If the basket doesn't
"KRN",9.2,674,1,9,0)
exist, it is created automatically.  Once the message has been transmitted,
"KRN",9.2,674,1,10,0)
it is deleted from the basket. (The message is not placed in the WASTE basket.)
"KRN",9.2,674,1,11,0)

"KRN",9.2,674,1,12,0)
Users who are surrogates of the Postmaster can "become" the Postmaster and
"KRN",9.2,674,1,13,0)
read the baskets containing the messages waiting to be transmitted.  They are
"KRN",9.2,674,1,14,0)
not able do anything that would let them see the text of the messages, but they
"KRN",9.2,674,1,15,0)
are able to take other actions with them, like move them to the head or end of
"KRN",9.2,674,1,16,0)
the queue.
"KRN",9.2,675,-1)
0^10
"KRN",9.2,675,0)
XM-I-N-DOMAIN FILE^DOMAIN FILE^3020507.1538^^
"KRN",9.2,675,1,0)
^9.21^9^9^3020507^^^^
"KRN",9.2,675,1,1,0)

"KRN",9.2,675,1,2,0)
The DOMAIN file, 4.2, should contain a record for every domain your site
"KRN",9.2,675,1,3,0)
communicates with on a regular basis.  Here are some of the important fields:
"KRN",9.2,675,1,4,0)

"KRN",9.2,675,1,5,0)
Fields used during [ADDRESSING]
"KRN",9.2,675,1,6,0)

"KRN",9.2,675,1,7,0)
Fields used to establish a [CONNECTION]
"KRN",9.2,675,1,8,0)

"KRN",9.2,675,1,9,0)
Fields used during the transmit [SESSION]
"KRN",9.2,675,2,0)
^9.22A^4^3
"KRN",9.2,675,2,1,0)
ADDRESSING^XM-I-N-DOMAIN FILE-ADDRESSING
"KRN",9.2,675,2,2,0)
CONNECTION^XM-I-N-DOMAIN FILE-CONNECT
"KRN",9.2,675,2,4,0)
SESSION^XM-I-N-DOMAIN FILE-SESSION
"KRN",9.2,676,-1)
0^11
"KRN",9.2,676,0)
XM-I-N-DOMAIN FILE-ADDRESSING^DOMAIN FILE FIELDS INVOLVED IN ADDRESSING^3020508.1005^^
"KRN",9.2,676,1,0)
^9.21^21^21^3020508^^
"KRN",9.2,676,1,1,0)

"KRN",9.2,676,1,2,0)
The following fields in the DOMAIN file 4.2 are used when a message is
"KRN",9.2,676,1,3,0)
addressed to a remote site:
"KRN",9.2,676,1,4,0)

"KRN",9.2,676,1,5,0)
  NAME (field #.01) is the name of the domain.  (Names of production domains
"KRN",9.2,676,1,6,0)
  should only be changed by a MailMan patch.  If a site needs to change its
"KRN",9.2,676,1,7,0)
  name, it must coordinate with the VA's national DNS team, as well as the
"KRN",9.2,676,1,8,0)
  MailMan developers.  If a site changes its name unilaterally, communication
"KRN",9.2,676,1,9,0)
  between that site and other sites will be adversely affected.)
"KRN",9.2,676,1,10,0)

"KRN",9.2,676,1,11,0)
  SYNONYM (multiple under field #5) lists other names by which this domain is
"KRN",9.2,676,1,12,0)
  known.  (If a site has its name changed via a MailMan patch, the old name
"KRN",9.2,676,1,13,0)
  becomes a synonym.)
"KRN",9.2,676,1,14,0)

"KRN",9.2,676,1,15,0)
  RELAY DOMAIN (field #2) points to a domain through which messages addressed
"KRN",9.2,676,1,16,0)
  to the domain are routed.
"KRN",9.2,676,1,17,0)

"KRN",9.2,676,1,18,0)
  [FLAGS] (field #1) controls the method used to contact the domain.
"KRN",9.2,676,1,19,0)

"KRN",9.2,676,1,20,0)
  SECURITY KEY (field #1.5), if present, allows only those users who hold the
"KRN",9.2,676,1,21,0)
  specified security key to address messages to the domain.
"KRN",9.2,676,2,0)
^9.22A^1^1
"KRN",9.2,676,2,1,0)
FLAGS^XM-I-N-DOMAIN FILE-FLAGS
"KRN",9.2,677,-1)
0^14
"KRN",9.2,677,0)
XM-I-N-DOMAIN FILE-FLAGS^DOMAIN FILE - FLAGS FIELD^3020508.0633^
"KRN",9.2,677,1,0)
^9.21^21^21^3020508^^
"KRN",9.2,677,1,1,0)

"KRN",9.2,677,1,2,0)
The FLAGS field (#1) controls the method used to contact the domain.
"KRN",9.2,677,1,3,0)
The field may contain any number of the following codes:
"KRN",9.2,677,1,4,0)

"KRN",9.2,677,1,5,0)
  C - Closed.  If the field contains a C, the domain is closed and users may
"KRN",9.2,677,1,6,0)
      not send messages to the domain.  C overrides all other codes.
"KRN",9.2,677,1,7,0)
      (Packages may still send messages if they use ^XMD, or if they set
"KRN",9.2,677,1,8,0)
      XMINSTR("ADDR FLAGS")="R", and use one of the ^XMXAPI commands, like
"KRN",9.2,677,1,9,0)
      SENDMSG^XMXAPI or FWDMSG^XMXAPI.)
"KRN",9.2,677,1,10,0)

"KRN",9.2,677,1,11,0)
  S - Send immediately.  Messages sent to the domain are transmitted ASAP.
"KRN",9.2,677,1,12,0)
      MailMan will schedule a Task to do so.  S overrides Q.  FLAGS may contain
"KRN",9.2,677,1,13,0)
      both S and P.  If FLAGS does not contain S, messages are queued.
"KRN",9.2,677,1,14,0)

"KRN",9.2,677,1,15,0)
  Q - Queue. (Default)  Messages sent to the domain are queued for later
"KRN",9.2,677,1,16,0)
      disposition.  It may be that someone will play a script to the domain or
"KRN",9.2,677,1,17,0)
      from the domain to this site.  Other possibilities exist, too.
"KRN",9.2,677,1,18,0)

"KRN",9.2,677,1,19,0)
  P - Poll.  If the poller (option XMPOLL) is scheduled to run on a regular
"KRN",9.2,677,1,20,0)
      basis, the poller will schedule a task to communicate with the domain.
"KRN",9.2,677,1,21,0)
      Messages in the queue, if any, are transmitted then.
"KRN",9.2,678,-1)
0^15
"KRN",9.2,678,0)
XM-I-N-DOMAIN FILE-SESSION^DOMAIN FILE FIELDS USED WHILE TRANSMITTING^3020507.153415^^
"KRN",9.2,678,1,0)
^^10^10^3020507^
"KRN",9.2,678,1,1,0)

"KRN",9.2,678,1,2,0)
The following fields in the DOMAIN file 4.2 are used once a connection with
"KRN",9.2,678,1,3,0)
a remote site has been established:
"KRN",9.2,678,1,4,0)

"KRN",9.2,678,1,5,0)
  [VALIDATION NUMBER] (field #1.6), if present, is used while communicating
"KRN",9.2,678,1,6,0)
  with another site to confirm that the site is really the intended one.
"KRN",9.2,678,1,7,0)

"KRN",9.2,678,1,8,0)
  [DISABLE TURN COMMAND] (field #1.7) controls whether your site will accept
"KRN",9.2,678,1,9,0)
  messages from the domain in the same session as the one in which your site
"KRN",9.2,678,1,10,0)
  sends messages to the domain.
"KRN",9.2,678,2,0)
^9.22A^2^2
"KRN",9.2,678,2,1,0)
DISABLE TURN COMMAND^XM-I-N-DOMAIN FILE-TURN
"KRN",9.2,678,2,2,0)
VALIDATION NUMBER^XM-I-N-DOMAIN FILE-VALIDATE
"KRN",9.2,679,-1)
0^12
"KRN",9.2,679,0)
XM-I-N-DOMAIN FILE-CONNECT^DOMAIN FILE FIELDS USED TO CONNECT TO A SITE^3020508.0704^^
"KRN",9.2,679,1,0)
^9.21^21^21^3020508^^^
"KRN",9.2,679,1,1,0)

"KRN",9.2,679,1,2,0)
The following fields in the DOMAIN file 4.2 are used when establishing a
"KRN",9.2,679,1,3,0)
connection to a remote site.  They all reside under the TRANSMISSION SCRIPT
"KRN",9.2,679,1,4,0)
multiple (field #4). Taken together, they provide the instructions on how to
"KRN",9.2,679,1,5,0)
connect.  A domain may have one or more transmission scripts. 
"KRN",9.2,679,1,6,0)

"KRN",9.2,679,1,7,0)
  TRANSMISSION SCRIPT (field #.01) is the name of the script.
"KRN",9.2,679,1,8,0)

"KRN",9.2,679,1,9,0)
  PRIORITY (field #1) is the relative priority (lower number = higher priority)
"KRN",9.2,679,1,10,0)
  of the script.  MailMan chooses the highest priority script to try first.
"KRN",9.2,679,1,11,0)

"KRN",9.2,679,1,12,0)
  NUMBER OF ATTEMPTS (field #1.1) notes how many times this script should be
"KRN",9.2,679,1,13,0)
  tried before moving on to the next script and notifying the Postmaster (in
"KRN",9.2,679,1,14,0)
  a bulletin) that MailMan was unable to connect using the script.
"KRN",9.2,679,1,15,0)

"KRN",9.2,679,1,16,0)
  TYPE (field #1.2) is the script type (TCPCHAN, SMTP, FTP, TELNET, or OTHER).
"KRN",9.2,679,1,17,0)

"KRN",9.2,679,1,18,0)
  PHYSICAL LINK / DEVICE (field #1.3) points to the DEVICE file to indicate
"KRN",9.2,679,1,19,0)
  the port to be used for the connection.  It may be the NULL DEVICE.
"KRN",9.2,679,1,20,0)

"KRN",9.2,679,1,21,0)
[MORE]...
"KRN",9.2,679,2,0)
^9.22A^1^1
"KRN",9.2,679,2,1,0)
MORE^XM-I-N-DOMAIN FILE-CONNECT-2
"KRN",9.2,680,-1)
0^13
"KRN",9.2,680,0)
XM-I-N-DOMAIN FILE-CONNECT-2^DOMAIN FILE FIELDS USED TO CONNECT TO A SITE (CONTINUED)^3020508.0943^^
"KRN",9.2,680,1,0)
^9.21^20^20^3020508^^^^
"KRN",9.2,680,1,1,0)

"KRN",9.2,680,1,2,0)
  NETWORK ADDRESS (MAILMAN HOST) (field #1.4) is the IP (Internet Protocol)
"KRN",9.2,680,1,3,0)
  address of the site.  The IP address is a unique address, much like a phone
"KRN",9.2,680,1,4,0)
  number.  If it doesn't work (no one answers), MailMan uses DNS (Domain Name
"KRN",9.2,680,1,5,0)
  Server) to look up the IP address (using the Domain name).  If the IP address
"KRN",9.2,680,1,6,0)
  returned by the DNS works, then MailMan puts it in this field, and makes a
"KRN",9.2,680,1,7,0)
  note to that effect in the TRANSMISSION SCRIPT NOTES field #99.
"KRN",9.2,680,1,8,0)

"KRN",9.2,680,1,9,0)
  OUT OF SERVICE (field #1.5) indicates that this script should not be used.
"KRN",9.2,680,1,10,0)

"KRN",9.2,680,1,11,0)
  TEXT (field #2) is a word-processing field containing the commands to be used
"KRN",9.2,680,1,12,0)
  to finalize the connection and begin the transmission process.  If this field
"KRN",9.2,680,1,13,0)
  is empty, and field 1.2 is TCPCHAN, MailMan is able to build a TCP/IP script
"KRN",9.2,680,1,14,0)
  on-the-fly if the necessary [MAILMAN SITE PARAMETERS] (fields 8.23 and 8.24)
"KRN",9.2,680,1,15,0)
  are filled out.
"KRN",9.2,680,1,16,0)

"KRN",9.2,680,1,17,0)
  TRANSMISSION SCRIPT NOTES (field #99) is a word-processing field in which
"KRN",9.2,680,1,18,0)
  you or MailMan may place notes about the script.  If MailMan places a new
"KRN",9.2,680,1,19,0)
  IP address in field #1.4, a note will be added, stating the date/time,
"KRN",9.2,680,1,20,0)
  the old IP address, and the new IP address.
"KRN",9.2,680,2,0)
^9.22A^1^1
"KRN",9.2,680,2,1,0)
MAILMAN SITE PARAMETERS^XM-I-S-SITE PARAMETERS-REMOTE
"KRN",9.2,681,-1)
0^17
"KRN",9.2,681,0)
XM-I-N-DOMAIN FILE-VALIDATE^DOMAIN FILE - VALIDATION NUMBER FIELD^3020508.1035^
"KRN",9.2,681,1,0)
^9.21^18^18^3020508^^
"KRN",9.2,681,1,1,0)

"KRN",9.2,681,1,2,0)
The VALIDATION NUMBER (field #1.6) is used as an extra security precaution
"KRN",9.2,681,1,3,0)
to confirm that the site really is who it says it is.
"KRN",9.2,681,1,4,0)

"KRN",9.2,681,1,5,0)
After the connection has been established, the validation numbers are compared.
"KRN",9.2,681,1,6,0)

"KRN",9.2,681,1,7,0)
If the validation numbers are null, then the security precaution is not active,
"KRN",9.2,681,1,8,0)
and the session continues.
"KRN",9.2,681,1,9,0)

"KRN",9.2,681,1,10,0)
If the validation numbers are not null, and they match, then the sites agree on
"KRN",9.2,681,1,11,0)
a new validation number to be used the next time, and the session continues.
"KRN",9.2,681,1,12,0)

"KRN",9.2,681,1,13,0)
If the validation numbers are not null, and they don't match, then the session
"KRN",9.2,681,1,14,0)
is brought to an abrupt end, and a bulletin is sent to the Postmaster to notify
"KRN",9.2,681,1,15,0)
site managers of the 'bad validation number'.  To correct this, someone at your
"KRN",9.2,681,1,16,0)
site must contact (by phone, usually) someone at the other site, and one of you
"KRN",9.2,681,1,17,0)
must change your validation number to match the other's.  Once the fields have
"KRN",9.2,681,1,18,0)
been edited to match, then you can re-schedule a task to transmit the messages.
"KRN",9.2,682,-1)
0^16
"KRN",9.2,682,0)
XM-I-N-DOMAIN FILE-TURN^DOMAIN FILE - DISABLE TURN COMMAND FIELD^3020508.075757^
"KRN",9.2,682,1,0)
^^19^19^3020508^
"KRN",9.2,682,1,1,0)

"KRN",9.2,682,1,2,0)
The DISABLE TURN COMMAND (field #1.7) is used to prevent two-way transmission.
"KRN",9.2,682,1,3,0)

"KRN",9.2,682,1,4,0)
Here's the scenario.  Once the connection has been established and the sending
"KRN",9.2,682,1,5,0)
site has sent all its messages, it generally issues a TURN command to give the
"KRN",9.2,682,1,6,0)
receiving site a chance to send all of its messages that it may have.
"KRN",9.2,682,1,7,0)

"KRN",9.2,682,1,8,0)
If the sending site has the TURN command disabled, then it will not give the
"KRN",9.2,682,1,9,0)
receiving site the chance to send its messages.  The receiving site will
"KRN",9.2,682,1,10,0)
simply end the session.  The receiving site will have to start its own session
"KRN",9.2,682,1,11,0)
to transmit its messages.
"KRN",9.2,682,1,12,0)

"KRN",9.2,682,1,13,0)
If the receiving site has the TURN command disabled, then it will refuse the
"KRN",9.2,682,1,14,0)
opportunity to send its messages.  It will send its messages in a session it
"KRN",9.2,682,1,15,0)
initiates.
"KRN",9.2,682,1,16,0)

"KRN",9.2,682,1,17,0)
On a production system, the TURN command might be disabled for the domain file
"KRN",9.2,682,1,18,0)
entries for any test accounts to avoid any inadvertent receipt of messages
"KRN",9.2,682,1,19,0)
from the test systems.
"KRN",9.2,683,-1)
0^24
"KRN",9.2,683,0)
XM-I-N-XMIT TASK^TRANSMIT TASK^3020508.0948^^
"KRN",9.2,683,1,0)
^9.21^21^21^3020508^^^^
"KRN",9.2,683,1,1,0)

"KRN",9.2,683,1,2,0)
A task to transmit messages to another site is scheduled ASAP after a message
"KRN",9.2,683,1,3,0)
has been addressed and "sent" to that site, if the [FLAGS] field of that site's
"KRN",9.2,683,1,4,0)
Domain file entry contains an "S".  Tasks can also be queued by the options
"KRN",9.2,683,1,5,0)
'Transmit a Single Queue', 'Transmit All Queues', or 'Poll Remote'. 
"KRN",9.2,683,1,6,0)

"KRN",9.2,683,1,7,0)
MailMan uses fields in the [DOMAIN] file to select a script and set up the
"KRN",9.2,683,1,8,0)
task, and schedules the task to start immediately. 
"KRN",9.2,683,1,9,0)

"KRN",9.2,683,1,10,0)
After the task has started, if anything goes wrong, MailMan will re-schedule
"KRN",9.2,683,1,11,0)
the task to begin again in one minute.  If the problem was that the IP address
"KRN",9.2,683,1,12,0)
didn't work, then MailMan consults the DNS (if activated) to see if there's any
"KRN",9.2,683,1,13,0)
other IP address to try.  If there is, then that IP address will be used when
"KRN",9.2,683,1,14,0)
the task starts up in a minute.  If not, the same IP address will be used. 
"KRN",9.2,683,1,15,0)

"KRN",9.2,683,1,16,0)
If the task has failed a certain number of times (as specified in the script),
"KRN",9.2,683,1,17,0)
MailMan sends a bulletin to the Postmaster to notify site managers of the
"KRN",9.2,683,1,18,0)
problem.  Included in the bulletin is a transcript of the latest attempt.  Then
"KRN",9.2,683,1,19,0)
MailMan selects the next script to try, and re-schedules the task to begin
"KRN",9.2,683,1,20,0)
again in one hour.  If there's no other script, the same script is used.
"KRN",9.2,683,1,21,0)
[MORE]...
"KRN",9.2,683,2,0)
^9.22A^3^3
"KRN",9.2,683,2,1,0)
DOMAIN^XM-I-N-DOMAIN FILE-CONNECT
"KRN",9.2,683,2,2,0)
FLAGS^XM-I-N-DOMAIN FILE-FLAGS
"KRN",9.2,683,2,3,0)
MORE^XM-I-N-XMIT TASK-2
"KRN",9.2,684,-1)
0^25
"KRN",9.2,684,0)
XM-I-N-XMIT TASK-2^TRANSMIT TASK (CONTINUED)^3020508.092921^
"KRN",9.2,684,1,0)
^^5^5^3020508^
"KRN",9.2,684,1,1,0)

"KRN",9.2,684,1,2,0)
If the task is successful with an IP address that is different from the one
"KRN",9.2,684,1,3,0)
in the script, then MailMan replaces the IP address in the script with the
"KRN",9.2,684,1,4,0)
successful one, and adds a comment to that effect in the transmission script
"KRN",9.2,684,1,5,0)
notes.
"KRN",9.2,685,-1)
0^9
"KRN",9.2,685,0)
XM-I-N-BULLETINS^BULLETINS SIGNALING TROUBLE IN NETWORK TRANSMISSION^3020508.1414^^
"KRN",9.2,685,1,0)
^9.21^15^15^3020508^^^^
"KRN",9.2,685,1,1,0)

"KRN",9.2,685,1,2,0)
There are two bulletins which are sent to the Postmaster in the event that
"KRN",9.2,685,1,3,0)
MailMan has any problems when communicating with a remote site.  It is
"KRN",9.2,685,1,4,0)
recommended that mail groups be added to these bulletins so that programmers
"KRN",9.2,685,1,5,0)
at your site who are responsible for MailMan will be notified, too.
"KRN",9.2,685,1,6,0)

"KRN",9.2,685,1,7,0)
  XMVALBAD - Sent because the [VALIDATION NUMBERS] at both sites don't
"KRN",9.2,685,1,8,0)
  match.  The numbers must match in order for the transmission to be
"KRN",9.2,685,1,9,0)
  accepted.
"KRN",9.2,685,1,10,0)

"KRN",9.2,685,1,11,0)
  XM SEND ERR TRANSMISSION - Sent because there were problems connecting
"KRN",9.2,685,1,12,0)
  with the site or while transmitting to the site.  This bulletin will
"KRN",9.2,685,1,13,0)
  include the number of times the transmission has failed, the reason
"KRN",9.2,685,1,14,0)
  (if known) for the problem, as well as a transcript of the latest
"KRN",9.2,685,1,15,0)
  attempt.
"KRN",9.2,685,2,0)
^9.22A^1^1
"KRN",9.2,685,2,1,0)
VALIDATION NUMBERS^XM-I-N-DOMAIN FILE-VALIDATE
"KRN",9.2,686,-1)
0^20
"KRN",9.2,686,0)
XM-I-N-XMIT POLL^POLL A SITE^3020508.1449^^
"KRN",9.2,686,1,0)
^9.21^16^16^3020508^^^
"KRN",9.2,686,1,1,0)

"KRN",9.2,686,1,2,0)
The Poller (option XMPOLL) schedules tasks to transmit to all domains
"KRN",9.2,686,1,3,0)
whose [FLAGS] contain a 'P'.  The tasks will transmit to those domains
"KRN",9.2,686,1,4,0)
whether or not there are messages in the queues for those domains.
"KRN",9.2,686,1,5,0)

"KRN",9.2,686,1,6,0)
The TURN command (assuming it isn't [DISABLED]) will "pull" any messages
"KRN",9.2,686,1,7,0)
queued at the domains waiting to be transmitted to this one.  
"KRN",9.2,686,1,8,0)

"KRN",9.2,686,1,9,0)
If a task initiated by the Poller has any problems, MailMan will not
"KRN",9.2,686,1,10,0)
re-schedule it.  The Poller will start it again the next time it is
"KRN",9.2,686,1,11,0)
scheduled.
"KRN",9.2,686,1,12,0)
  
"KRN",9.2,686,1,13,0)
XMPOLL can be scheduled through 'Schedule Tasks' on the Taskman menu.
"KRN",9.2,686,1,14,0)
Set a time for transmission such as an off-peak evening hour.  The device
"KRN",9.2,686,1,15,0)
for output may be null, the default being the device on which the Taskman
"KRN",9.2,686,1,16,0)
was started.  
"KRN",9.2,686,2,0)
^9.22A^2^2
"KRN",9.2,686,2,1,0)
DISABLED^XM-I-N-DOMAIN FILE-TURN
"KRN",9.2,686,2,2,0)
FLAGS^XM-I-N-DOMAIN FILE-FLAGS
"KRN",9.2,687,-1)
0^23
"KRN",9.2,687,0)
XM-I-N-XMIT TAPE^TRANSMIT VIA TAPE^3020508.1512^
"KRN",9.2,687,1,0)
^9.21^16^16^3020508^^
"KRN",9.2,687,1,1,0)

"KRN",9.2,687,1,2,0)
As a backup method of transmitting messages, in case the WAN is down for a
"KRN",9.2,687,1,3,0)
period of time, MailMan provides the ability to dump a queue (transmit the
"KRN",9.2,687,1,4,0)
messages) to tape (or any other sequential transportable medium), send that
"KRN",9.2,687,1,5,0)
tape to another site whose WAN is up, and have that site mount the tape and
"KRN",9.2,687,1,6,0)
receive the messages, which will then be automatically transmitted onward
"KRN",9.2,687,1,7,0)
from that site.  (The site acts as your site's relay domain in this case.)
"KRN",9.2,687,1,8,0)

"KRN",9.2,687,1,9,0)
To dump a message queue to tape, select option 'Sequential Media Queue
"KRN",9.2,687,1,10,0)
Transmission', and select the domain.  The messages will be dumped to tape.
"KRN",9.2,687,1,11,0)

"KRN",9.2,687,1,12,0)
Send the tape to a sister site (or to the site of the domain whose messages
"KRN",9.2,687,1,13,0)
you dumped).
"KRN",9.2,687,1,14,0)

"KRN",9.2,687,1,15,0)
To receive the messages from the tape, select option 'Sequential Media
"KRN",9.2,687,1,16,0)
Message Reception'.  MailMan will take it from there.
"KRN",9.2,688,-1)
0^26
"KRN",9.2,688,0)
XM-I-N-XMIT UCI^TRANSMIT BETWEEN UCI'S VIA A GLOBAL^3020509.0835^
"KRN",9.2,688,1,0)
^9.21^21^21^3020509^^^
"KRN",9.2,688,1,1,0)

"KRN",9.2,688,1,2,0)
MailMan lets you transmit messages from one UCI to another via a global.
"KRN",9.2,688,1,3,0)

"KRN",9.2,688,1,4,0)
The following conditions must be met:
"KRN",9.2,688,1,5,0)
 - MailMan must be running in each UCI.
"KRN",9.2,688,1,6,0)
 - The global, ^%ZISL(4.281, must be translated and accessible from both UCIs.
"KRN",9.2,688,1,7,0)
 - The name of the receiving UCI must exactly match its domain file entry in
"KRN",9.2,688,1,8,0)
   the sending UCI.  Synonyms will not work.
"KRN",9.2,688,1,9,0)
  
"KRN",9.2,688,1,10,0)
To transmit messages via a global:
"KRN",9.2,688,1,11,0)
  
"KRN",9.2,688,1,12,0)
  Log onto the UCI you wish to transmit messages from.  
"KRN",9.2,688,1,13,0)
 
"KRN",9.2,688,1,14,0)
  Use the option 'Send Messages to Another UCI'.  It will ask which domain
"KRN",9.2,688,1,15,0)
  and will then transmit the messages in the queue to the global.
"KRN",9.2,688,1,16,0)

"KRN",9.2,688,1,17,0)
  Log onto the UCI you wish to receive the messages into.
"KRN",9.2,688,1,18,0)

"KRN",9.2,688,1,19,0)
  Use the option 'Receive Messages from Another UCI'.  It will look in the
"KRN",9.2,688,1,20,0)
  global for entries directed to its domain, and will then receive the
"KRN",9.2,688,1,21,0)
  messages from those entries.  MailMan will take it from there.
"KRN",9.2,689,-1)
0^19
"KRN",9.2,689,0)
XM-I-N-XMIT PLAY^TRANSMIT - PLAY A SCRIPT^3020509.070451^^
"KRN",9.2,689,1,0)
^^17^17^3020509^
"KRN",9.2,689,1,1,0)

"KRN",9.2,689,1,2,0)
If you want to have total control and immediate gratification, you can play
"KRN",9.2,689,1,3,0)
a script to a domain to transmit any messages in its queue and, if the TURN
"KRN",9.2,689,1,4,0)
command is not [DISABLED], retrieve any messages from that domain which are
"KRN",9.2,689,1,5,0)
waiting to be transmitted to this one.  If there's any problem, you'll see
"KRN",9.2,689,1,6,0)
it happening.  You'll see every single interaction between the sites, 
"KRN",9.2,689,1,7,0)
including the message transmissions, in excruciating detail.  It doesn't
"KRN",9.2,689,1,8,0)
matter what the [FLAGS] field in the Domain file indicates - as long as there's
"KRN",9.2,689,1,9,0)
an entry in the [TRANSMISSION SCRIPT] multiple, you'll be able to play a script.
"KRN",9.2,689,1,10,0)

"KRN",9.2,689,1,11,0)
To play a script, select the option 'Play a script'.  You'll be asked to
"KRN",9.2,689,1,12,0)
select the domain and the transmission script (if there's more than one).  If
"KRN",9.2,689,1,13,0)
a task is already scheduled to transmit to that domain, you'll be given the
"KRN",9.2,689,1,14,0)
opportunity to cancel the task.  If a task is already actively transmitting
"KRN",9.2,689,1,15,0)
to that domain, the script will not play.  If there's problems connecting
"KRN",9.2,689,1,16,0)
using the IP address, you'll observe how MailMan calls the DNS to retrieve
"KRN",9.2,689,1,17,0)
another IP address, and immediately tries it.
"KRN",9.2,689,2,0)
^9.22A^3^3
"KRN",9.2,689,2,1,0)
DISABLED^XM-I-N-DOMAIN FILE-TURN
"KRN",9.2,689,2,2,0)
FLAGS^XM-I-N-DOMAIN FILE-FLAGS
"KRN",9.2,689,2,3,0)
TRANSMISSION SCRIPT^XM-I-N-DOMAIN FILE-CONNECT
"KRN",9.2,690,-1)
0^22
"KRN",9.2,690,0)
XM-I-N-XMIT SCHEDULE TASK^TRANSMIT - SCHEDULE A TASK^3020509.072414^^
"KRN",9.2,690,1,0)
^^17^17^3020509^
"KRN",9.2,690,1,1,0)

"KRN",9.2,690,1,2,0)
There are two options which will enable you to schedule [TASK]s to transmit
"KRN",9.2,690,1,3,0)
queues with messages.  (The queues must have messages to be considered.)
"KRN",9.2,690,1,4,0)
They are 'Transmit a Single Queue' and 'Transmit All Queues'. 
"KRN",9.2,690,1,5,0)

"KRN",9.2,690,1,6,0)
'Transmit a Single Queue' will let you select only those queues with messages.
"KRN",9.2,690,1,7,0)
It does not matter what the [FLAGS] field contains for the domain you select.
"KRN",9.2,690,1,8,0)
You will be asked to select the domain, as well as the transmission script.
"KRN",9.2,690,1,9,0)
If a task is already scheduled to transmit to that domain, you'll be given the
"KRN",9.2,690,1,10,0)
opportunity to cancel that task.  If a task is already actively transmitting to
"KRN",9.2,690,1,11,0)
that domain, you will not be able to schedule another one.  
"KRN",9.2,690,1,12,0)

"KRN",9.2,690,1,13,0)
'Transmit all Queues' will look at every queue and consider whether to schedule
"KRN",9.2,690,1,14,0)
a task for it.  If the queue has messages and its [FLAGS] field contains an 'S'
"KRN",9.2,690,1,15,0)
and there's no task currently scheduled to transmit the queue or is actively
"KRN",9.2,690,1,16,0)
transmitting, then it will schedule a task to transmit that queue's messages.
"KRN",9.2,690,1,17,0)
(MailMan will select the transmission script.)
"KRN",9.2,690,2,0)
^9.22A^2^2
"KRN",9.2,690,2,1,0)
FLAGS^XM-I-N-DOMAIN FILE-FLAGS
"KRN",9.2,690,2,2,0)
TASK^XM-I-N-XMIT TASK
"KRN",9.2,697,-1)
1^1
"KRN",9.2,697,0)
XM-BACKGROUND-FILER
"KRN",9.2,698,-1)
1^38
"KRN",9.2,698,0)
XM-IN-BASKET-PURGE
"KRN",9.2,699,-1)
1^39
"KRN",9.2,699,0)
XM-IN-BASKET-PURGE-1
"KRN",9.2,700,-1)
1^40
"KRN",9.2,700,0)
XM-IN-BASKET-PURGE-2
"KRN",9.2,701,-1)
1^41
"KRN",9.2,701,0)
XM-IN-BASKET-PURGE-3
"KRN",9.2,702,-1)
1^42
"KRN",9.2,702,0)
XM-LOCAL-LAST-SIGN-ON
"KRN",9.2,703,-1)
1^152
"KRN",9.2,703,0)
XM-U-M-PRINT NO HEADER-3
"KRN",9.2,704,-1)
1^190
"KRN",9.2,704,0)
XM-U-NEW FEATURES-2
"KRN",9.2,705,-1)
1^191
"KRN",9.2,705,0)
XM-U-NEW FEATURES-3
"KRN",9.2,706,-1)
1^192
"KRN",9.2,706,0)
XM-U-NEW FEATURES-4
"KRN",9.2,707,-1)
1^193
"KRN",9.2,707,0)
XM-U-NEW FEATURES-5
"KRN",9.2,708,-1)
1^244
"KRN",9.2,708,0)
XM-U-Q-SEARCH CRITERIA-3
"KRN",9.2,709,-1)
1^245
"KRN",9.2,709,0)
XM-U-Q-SEARCH CRITERIA-4
"KRN",9.2,710,-1)
1^246
"KRN",9.2,710,0)
XM-U-Q-SEARCH CRITERIA-5
"KRN",9.2,711,-1)
1^260
"KRN",9.2,711,0)
XMBULL+
"KRN",9.2,712,-1)
1^261
"KRN",9.2,712,0)
XMDOMAIN+
"KRN",9.2,713,-1)
1^262
"KRN",9.2,713,0)
XMFLAGS+
"KRN",9.2,714,-1)
1^265
"KRN",9.2,714,0)
XMKEYS+
"KRN",9.2,715,-1)
1^266
"KRN",9.2,715,0)
XMMG-BULLETIN-MANY-MESSAGES
"KRN",9.2,716,-1)
1^267
"KRN",9.2,716,0)
XMMG-LOCAL-DELIVERY-STATISTICS
"KRN",9.2,717,-1)
1^268
"KRN",9.2,717,0)
XMMG-LOCAL-FIRST READ
"KRN",9.2,718,-1)
1^269
"KRN",9.2,718,0)
XMMG-LOCAL-FORWARD
"KRN",9.2,719,-1)
1^270
"KRN",9.2,719,0)
XMMG-LOCAL-INTEGRITY
"KRN",9.2,720,-1)
1^271
"KRN",9.2,720,0)
XMMG-LOCAL-LARGE-REPORT
"KRN",9.2,721,-1)
1^272
"KRN",9.2,721,0)
XMMG-NEW-FEATURES
"KRN",9.2,722,-1)
1^273
"KRN",9.2,722,0)
XMMG-NEW-FEATURES-7.1
"KRN",9.2,723,-1)
1^274
"KRN",9.2,723,0)
XMMG-NEW3.1FEATURES
"KRN",9.2,724,-1)
1^275
"KRN",9.2,724,0)
XMMG-POSTMASTER-BULLETINS
"KRN",9.2,725,-1)
1^278
"KRN",9.2,725,0)
XMNET-CASE-SENSITIVE
"KRN",9.2,726,-1)
1^279
"KRN",9.2,726,0)
XMNET-DIRECTORY-REQUEST-FLAG
"KRN",9.2,727,-1)
1^280
"KRN",9.2,727,0)
XMNET-ERROR-COMMAND
"KRN",9.2,728,-1)
1^281
"KRN",9.2,728,0)
XMNET-FORWARD-ADDRESS
"KRN",9.2,729,-1)
1^282
"KRN",9.2,729,0)
XMNET-KERNEL-SITE-PARAMETERS
"KRN",9.2,730,-1)
1^285
"KRN",9.2,730,0)
XMNET-LPC-CHECKSUM
"KRN",9.2,731,-1)
1^286
"KRN",9.2,731,0)
XMNET-MAIL-NAME
"KRN",9.2,732,-1)
1^287
"KRN",9.2,732,0)
XMNET-MAILLINK
"KRN",9.2,733,-1)
1^288
"KRN",9.2,733,0)
XMNET-MAILLINK-ADDRESS
"KRN",9.2,734,-1)
1^289
"KRN",9.2,734,0)
XMNET-MAX-LINES
"KRN",9.2,735,-1)
1^290
"KRN",9.2,735,0)
XMNET-MAX-TCP-CHANNEL
"KRN",9.2,736,-1)
1^294
"KRN",9.2,736,0)
XMNET-NET-FEATURES-7.1
"KRN",9.2,737,-1)
1^295
"KRN",9.2,737,0)
XMNET-NEW-FEATURES
"KRN",9.2,738,-1)
1^296
"KRN",9.2,738,0)
XMNET-NEW-FEATURES1
"KRN",9.2,739,-1)
1^297
"KRN",9.2,739,0)
XMNET-NEW-FEATURES2
"KRN",9.2,740,-1)
1^298
"KRN",9.2,740,0)
XMNET-NEW-FEATURES3
"KRN",9.2,741,-1)
1^299
"KRN",9.2,741,0)
XMNET-NEW-features
"KRN",9.2,742,-1)
1^300
"KRN",9.2,742,0)
XMNET-NEW3.1FEATURES
"KRN",9.2,743,-1)
1^301
"KRN",9.2,743,0)
XMNET-SENDER-REJECT
"KRN",9.2,744,-1)
1^302
"KRN",9.2,744,0)
XMNET-SIZE-LIMIT
"KRN",9.2,745,-1)
1^303
"KRN",9.2,745,0)
XMNET-TCP/IP
"KRN",9.2,746,-1)
1^304
"KRN",9.2,746,0)
XMNET-TIME-ZONE
"KRN",9.2,747,-1)
1^305
"KRN",9.2,747,0)
XMNETSEND+
"KRN",9.2,748,-1)
1^306
"KRN",9.2,748,0)
XMNETWORK*
"KRN",9.2,749,-1)
1^307
"KRN",9.2,749,0)
XMPACKMAN
"KRN",9.2,750,-1)
1^308
"KRN",9.2,750,0)
XMPARENT+
"KRN",9.2,751,-1)
1^309
"KRN",9.2,751,0)
XMPHYSLINK
"KRN",9.2,752,-1)
1^310
"KRN",9.2,752,0)
XMPOLL+
"KRN",9.2,753,-1)
1^311
"KRN",9.2,753,0)
XMQUERY+
"KRN",9.2,754,-1)
1^312
"KRN",9.2,754,0)
XMQUEUE+
"KRN",9.2,755,-1)
1^313
"KRN",9.2,755,0)
XMRELAY+
"KRN",9.2,756,-1)
1^314
"KRN",9.2,756,0)
XMSCRIPT+
"KRN",9.2,757,-1)
1^315
"KRN",9.2,757,0)
XMSUBORDINATE+
"KRN",9.2,758,-1)
1^316
"KRN",9.2,758,0)
XMTALK
"KRN",9.2,759,-1)
1^317
"KRN",9.2,759,0)
XMTALK-CAPTURE
"KRN",9.2,760,-1)
1^318
"KRN",9.2,760,0)
XMTALK-END
"KRN",9.2,761,-1)
1^319
"KRN",9.2,761,0)
XMTALK-KERMIT
"KRN",9.2,762,-1)
1^320
"KRN",9.2,762,0)
XMTALK-RETURN
"KRN",9.2,763,-1)
1^321
"KRN",9.2,763,0)
XMTALK-USER
"KRN",9.2,764,-1)
1^322
"KRN",9.2,764,0)
XMTROUBLE+
"KRN",9.2,765,-1)
1^323
"KRN",9.2,765,0)
XMTURN+
"KRN",9.2,766,-1)
1^324
"KRN",9.2,766,0)
XMUT-%ZISL-SEND
"KRN",9.2,767,-1)
1^325
"KRN",9.2,767,0)
XMUT-INTEGRITY
"KRN",9.2,768,-1)
1^326
"KRN",9.2,768,0)
XMUT-REC-DEL
"KRN",9.2,769,-1)
1^327
"KRN",9.2,769,0)
XMUT-REC-FIND
"KRN",9.2,770,-1)
1^328
"KRN",9.2,770,0)
XMUT-REC-LIST
"KRN",9.2,771,-1)
1^329
"KRN",9.2,771,0)
XMUT-RECOVER MESSAGES
"KRN",9.2,772,-1)
1^330
"KRN",9.2,772,0)
XMUT-TAPE-TRANSMISSION
"KRN",9.2,773,-1)
1^331
"KRN",9.2,773,0)
XMUT4-AUTOPURGE
"KRN",9.2,774,-1)
1^332
"KRN",9.2,774,0)
XMVALID+
"KRN",9.2,775,-1)
1^333
"KRN",9.2,775,0)
XM-OUTPUT
"KRN",9.2,776,-1)
1^334
"KRN",9.2,776,0)
XM-U-Q-CLASSIC LOOKUP
"KRN",9.2,777,-1)
1^335
"KRN",9.2,777,0)
XM-U-Q-CLASSIC LOOKUP-2
"KRN",9.2,778,-1)
1^336
"KRN",9.2,778,0)
XMS-USING A FORWARDING ADDRESS
"KRN",9.2,779,-1)
1^338
"KRN",9.2,779,0)
XM-OUPUT
"KRN",19,455,-1)
0^129
"KRN",19,455,0)
XMREAD^Read/Manage Messages^^R^^^XM-U-R-READ^^^^^MAILMAN^^1^1
"KRN",19,455,1,0)
^19.06^5^5^2970730^^^^
"KRN",19,455,1,1,0)
This option is used to read MailMan messages.  The user will be asked
"KRN",19,455,1,2,0)
for a mail basket, which is normally the IN basket.  Deleted messages
"KRN",19,455,1,3,0)
may be seen by reading the WASTE basket.  Once read, messages may be
"KRN",19,455,1,4,0)
deleted, saved into other mail baskets, forwarded to other users, edited,
"KRN",19,455,1,5,0)
or queried for information regarding other recipients of the message.
"KRN",19,455,15)
D CHECKOUT^XM
"KRN",19,455,20)
D CHECKIN^XM
"KRN",19,455,25)
MANAGE^XMJBM
"KRN",19,455,99)
54766,39275
"KRN",19,455,"U")
READ/MANAGE MESSAGES
"KRN",19,456,-1)
0^132
"KRN",19,456,0)
XMSEND^Send a Message^^R^^^XM-U-M-SEND^^^^^MAILMAN^^1^1^
"KRN",19,456,1,0)
^19.06^4^4^2970730^^^^
"KRN",19,456,1,1,0)
Enables the user to send MailMan messages.  Messages may be sent
"KRN",19,456,1,2,0)
to other users or groups of users.  The sender of the message may
"KRN",19,456,1,3,0)
request a confirmation message, to be sent to him when each recipient
"KRN",19,456,1,4,0)
reads the message.
"KRN",19,456,15)
D CHECKOUT^XM
"KRN",19,456,20)
D CHECKIN^XM
"KRN",19,456,25)
SEND^XMJMS
"KRN",19,456,99)
53272,53151
"KRN",19,456,"U")
SEND A MESSAGE
"KRN",19,457,-1)
0^113
"KRN",19,457,0)
XMNEW^New Messages and Responses^^R^^^XM-U-R-READ NEW^^^^^MAILMAN^^1^1^
"KRN",19,457,1,0)
^19.06^2^2^2970730^^^^
"KRN",19,457,1,1,0)
Enables you to scan your mailbox for messages which are
"KRN",19,457,1,2,0)
either new, or have had some unseen response.
"KRN",19,457,15)
D CHECKOUT^XM
"KRN",19,457,20)
D CHECKIN^XM
"KRN",19,457,25)
NEW^XMJBN
"KRN",19,457,99)
53752,57930
"KRN",19,457,"U")
NEW MESSAGES AND RESPONSES
"KRN",19,458,-1)
3^137
"KRN",19,458,0)
XMUSER^MailMan Menu^^M^^^XMHELP^^^^^MAILMAN^^1^1^^1
"KRN",19,458,1,0)
^^3^3^2991130^^^^
"KRN",19,458,1,1,0)
This is the main MailMan option menu for normal user interaction.
"KRN",19,458,1,2,0)
It allows the user to Send and Receive messages, as well as manage
"KRN",19,458,1,3,0)
his baskets.
"KRN",19,458,10,0)
^19.01PI^8^8
"KRN",19,458,10,1,0)
457^NML^1
"KRN",19,458,10,1,"^")
XMNEW
"KRN",19,458,10,2,0)
455^RML^2
"KRN",19,458,10,2,"^")
XMREAD
"KRN",19,458,10,3,0)
456^SML^3
"KRN",19,458,10,3,"^")
XMSEND
"KRN",19,458,10,4,0)
528^^4
"KRN",19,458,10,4,"^")
XMSEARCH
"KRN",19,458,10,5,0)
469^AML^5
"KRN",19,458,10,5,"^")
XMASSUME
"KRN",19,458,10,6,0)
605^^6
"KRN",19,458,10,6,"^")
XM PERSONAL MENU
"KRN",19,458,10,7,0)
529^^7
"KRN",19,458,10,7,"^")
XMOTHER
"KRN",19,458,10,8,0)
471^^8
"KRN",19,458,10,8,"^")
XMHELP
"KRN",19,458,15)
K XMMENU D CHECKOUT^XM
"KRN",19,458,20)
S XMMENU(0)="XMUSER" D EN^XM
"KRN",19,458,26)
S XMMENU(0)="XMUSER"
"KRN",19,458,99)
58279,56457
"KRN",19,458,99.1)
54262,51324
"KRN",19,458,"U")
MAILMAN MENU
"KRN",19,458,"W")
^
"KRN",19,459,-1)
0^52
"KRN",19,459,0)
XMEDITMG^Mail Group Edit^^R^^^XM-U-I-GROUP^^^^^MAILMAN^^^
"KRN",19,459,1,0)
^19.06^2^2^2970723^^^^
"KRN",19,459,1,1,0)
This option is used to edit the mail group file, which controls the
"KRN",19,459,1,2,0)
distribution of messages to groups of users.
"KRN",19,459,15)

"KRN",19,459,20)

"KRN",19,459,25)
EDITMG^XMVGROUP
"KRN",19,459,30)

"KRN",19,459,31)

"KRN",19,459,34)

"KRN",19,459,50)

"KRN",19,459,51)

"KRN",19,459,99)
55595,47667
"KRN",19,459,"U")
MAIL GROUP EDIT
"KRN",19,460,-1)
0^135
"KRN",19,460,0)
XMSTAT^Message statistics^^R^^^^^^^^MAILMAN^^^^
"KRN",19,460,1,0)
^19.06^12^12^3010419^^^^
"KRN",19,460,1,1,0)
This interactive option displays information about past purges and
"KRN",19,460,1,2,0)
about current mailbox usage.  This option should not be scheduled.
"KRN",19,460,1,3,0)

"KRN",19,460,1,4,0)
First, it displays the types and results of the last 20 purges of the
"KRN",19,460,1,5,0)
MESSAGE file 3.9.  It tells you whether the purge was an unreferenced
"KRN",19,460,1,6,0)
message purge (option XMPURGE or XMAUTOPURGE), or a date purge (option
"KRN",19,460,1,7,0)
XMPURGE-BY-DATE).  It tells you when it started and ended, how long it
"KRN",19,460,1,8,0)
took, how many messages were purged, and how many were left.
"KRN",19,460,1,9,0)
 
"KRN",19,460,1,10,0)
Next, it displays information about each user in the MESSAGE file 3.7.
"KRN",19,460,1,11,0)
It tells you how many messages they have in their mailboxes, when they
"KRN",19,460,1,12,0)
last logged on, and when they last used MailMan.
"KRN",19,460,20)

"KRN",19,460,25)
STAT^XMA3
"KRN",19,460,"U")
MESSAGE STATISTICS
"KRN",19,461,-1)
0^126
"KRN",19,461,0)
XMPURGE^Purge Unreferenced Messages^^R^^^^^^^^^^^^
"KRN",19,461,1,0)
^19.06^7^7^3010419^^^^
"KRN",19,461,1,1,0)
This  option, if scheduled, does exactly what option XMAUTOPURGE does,
"KRN",19,461,1,2,0)
and then stops.
"KRN",19,461,1,3,0)

"KRN",19,461,1,4,0)
This  option, if run interactively, does exactly what option XMAUTOPURGE
"KRN",19,461,1,5,0)
does, and then it does exactly what option XMSTAT does, and then it stops.
"KRN",19,461,1,6,0)

"KRN",19,461,1,7,0)
You should NOT schedule this option.
"KRN",19,461,20)

"KRN",19,461,25)
SCAN^XMA3
"KRN",19,461,"U")
PURGE UNREFERENCED MESSAGES
"KRN",19,462,-1)
0^49
"KRN",19,462,0)
XMEDITBUL^Bulletin edit^^E^^^^^^^^^^
"KRN",19,462,1,0)
^19.06^2^2^2930319^^
"KRN",19,462,1,1,0)
This option will enter/edit a MailMan bulletin, change the routing
"KRN",19,462,1,2,0)
information, and document the bulletin.
"KRN",19,462,30)
XMB(3.6,
"KRN",19,462,31)
AEQMZL
"KRN",19,462,50)
XMB(3.6,
"KRN",19,462,51)
0:99
"KRN",19,462,"U")
BULLETIN EDIT
"KRN",19,463,-1)
3^160
"KRN",19,463,0)
XMMGR^Manage Mailman^^M^^^XM-MASTER^^^^^MAILMAN^^1^1^^^
"KRN",19,463,1,0)
3^19.06^3^3^3000906^^^^
"KRN",19,463,1,1,0)
This option allows the site manager to manage the MailMan system, 
"KRN",19,463,1,2,0)
by manipulating the Message, Mail group, Bulletin, and Mail Box
"KRN",19,463,1,3,0)
files.
"KRN",19,463,3)

"KRN",19,463,10,0)
^19.01IP^10^10
"KRN",19,463,10,1,0)
512
"KRN",19,463,10,1,"^")
XMUT-CHKFIL
"KRN",19,463,10,2,0)
534
"KRN",19,463,10,2,"^")
XMMGR-NEW-MAIL-BOX
"KRN",19,463,10,3,0)
523
"KRN",19,463,10,3,"^")
XMMGR-HELP
"KRN",19,463,10,4,0)
477
"KRN",19,463,10,4,"^")
XMNET
"KRN",19,463,10,5,0)
553
"KRN",19,463,10,5,"^")
XMMGR-MESSAGE-DELIVERY-MGT
"KRN",19,463,10,6,0)
550
"KRN",19,463,10,6,"^")
XMMGR-GROUP-MAINTENANCE
"KRN",19,463,10,7,0)
554
"KRN",19,463,10,7,"^")
XMMGR-DISK-SPACE-MANAGEMENT
"KRN",19,463,10,8,0)
541
"KRN",19,463,10,8,"^")
XMKSP
"KRN",19,463,10,9,0)
580
"KRN",19,463,10,9,"^")
XMMGR-DIRECTORY-MAIN
"KRN",19,463,10,10,0)
667
"KRN",19,463,10,10,"^")
XM SUPER SEARCH
"KRN",19,463,15)
K XMMENU D CHECKOUT^XM
"KRN",19,463,20)
D CHECKIN^XM S XMMENU(0)="XMUSER"
"KRN",19,463,99)
58933,30216
"KRN",19,463,99.1)
54262,51324
"KRN",19,463,"U")
MANAGE MAILMAN
"KRN",19,464,-1)
0^40
"KRN",19,464,0)
XMCLEAN^Clean out waste baskets^^R^^^^^^^^^^
"KRN",19,464,1,0)
^19.06^6^6^3010419^^^^
"KRN",19,464,1,1,0)
This option empties users' WASTE baskets, that is, it deletes all the
"KRN",19,464,1,2,0)
messages in users' WASTE baskets in the MAILBOX file 3.7.
"KRN",19,464,1,3,0)
Messages in the MESSAGE file 3.9 are not affected.
"KRN",19,464,1,4,0)

"KRN",19,464,1,5,0)
It is recommended that this option be scheduled to run daily, right
"KRN",19,464,1,6,0)
before option XMAUTOPURGE.
"KRN",19,464,25)
CLEAN^XMA3
"KRN",19,464,200.9)
y
"KRN",19,464,"U")
CLEAN OUT WASTE BASKETS
"KRN",19,465,-1)
0^120
"KRN",19,465,0)
XMPOST^Post a bulletin^^R^^^^^^^^MAILMAN
"KRN",19,465,1,0)
^19.06^2^2^2970730^^
"KRN",19,465,1,1,0)
This option allows a user to manually post a bulletin, to test its
"KRN",19,465,1,2,0)
operation.
"KRN",19,465,25)
BULLETIN^XMJMBULL
"KRN",19,465,99)
55595,48259
"KRN",19,465,"U")
POST A BULLETIN
"KRN",19,467,-1)
0^36
"KRN",19,467,0)
XMAUTOPURGE^Automatic Purge of MailMan Messages^^R^^^^^^^^^^
"KRN",19,467,1,0)
^19.06^46^46^3010425^^^^
"KRN",19,467,1,1,0)
This option automatically purges unreferenced MailMan messages, that is,
"KRN",19,467,1,2,0)
it deletes from file 3.9, MESSAGE, any messages which are not in
"KRN",19,467,1,3,0)
anyone's basket.  It is strongly recommended that this option be
"KRN",19,467,1,4,0)
scheduled to run daily, right after option XMCLEAN.
"KRN",19,467,1,5,0)

"KRN",19,467,1,6,0)
The following messages are considered 'referenced', and will not be
"KRN",19,467,1,7,0)
purged:
"KRN",19,467,1,8,0)
 - Messages in user baskets
"KRN",19,467,1,9,0)
 - Messages in transit (arriving or being sent)
"KRN",19,467,1,10,0)
 - Server messages
"KRN",19,467,1,11,0)
 - Messages being edited (including aborted edits)
"KRN",19,467,1,12,0)
 - Messages which have been latered
"KRN",19,467,1,13,0)

"KRN",19,467,1,14,0)
Several fields in file 4.3, MAILMAN SITE PARAMETERS, influence the
"KRN",19,467,1,15,0)
behavior of this option.  Here they are, but feel free to look at
"KRN",19,467,1,16,0)
their Data Dictionary descriptions for more information on them:
"KRN",19,467,1,17,0)

"KRN",19,467,1,18,0)
4.301 - NO-PURGE DAYS BUFFER - MailMan does not purge any messages
"KRN",19,467,1,19,0)
created or received in the last few days.  You choose how many days.
"KRN",19,467,1,20,0)
The default is 2.
"KRN",19,467,1,21,0)

"KRN",19,467,1,22,0)
142   - NO-PURGE DAYS BUFFER (LOCAL) - MailMan does not purge local
"KRN",19,467,1,23,0)
messages created in the last few days.  You choose how many days.
"KRN",19,467,1,24,0)
The default is 7.
"KRN",19,467,1,25,0)

"KRN",19,467,1,26,0)
4.304 - WEEKDAY DAYS TO PURGE - On Saturdays, MailMan goes through the
"KRN",19,467,1,27,0)
entire MESSAGE file looking for messages to purge.  On the other days
"KRN",19,467,1,28,0)
of the week, however, MailMan has the option of only looking at
"KRN",19,467,1,29,0)
messages created or received recently.  You choose how many days.  The
"KRN",19,467,1,30,0)
default is to go through the entire MESSAGE file.  It is strongly
"KRN",19,467,1,31,0)
recommended that you set this field to something reasonable, like 30
"KRN",19,467,1,32,0)
to 60 days.  (But only if you follow the recommendation to schedule
"KRN",19,467,1,33,0)
this option to run daily.  Otherwise leave this field blank.)
"KRN",19,467,1,34,0)

"KRN",19,467,1,35,0)
4.303 - AUTOMATIC INTEGRITY CHECK - MailMan gives you the option of
"KRN",19,467,1,36,0)
running the MAILBOX file portion of the integrity checker (option
"KRN",19,467,1,37,0)
XMUT-CHKFIL) before it actually purges the unreferenced messages.
"KRN",19,467,1,38,0)
The M xref on file 3.7 is used to determine whether a message is
"KRN",19,467,1,39,0)
referenced (in someone's basket) or not.  If the M xref is messed
"KRN",19,467,1,40,0)
up, then the purge might delete messages it shouldn't, or leave
"KRN",19,467,1,41,0)
message it should delete.  The integrity checker ensures that the
"KRN",19,467,1,42,0)
M xref is correct.  You choose whether to run it or not.  The default
"KRN",19,467,1,43,0)
is to run it.  The recommendation is to run it.  However, if you find
"KRN",19,467,1,44,0)
that it is simply taking too long, you may opt not to run it.  If
"KRN",19,467,1,45,0)
you opt not to run it, then it is recommended that you schedule option
"KRN",19,467,1,46,0)
XMUT-CHKFIL to run monthly, because globals can and do become corrupted.
"KRN",19,467,2)
n
"KRN",19,467,20)

"KRN",19,467,25)
EN^XMA3
"KRN",19,467,99)
55536,32239
"KRN",19,467,99.1)
54318,54986
"KRN",19,467,200.9)
y
"KRN",19,467,"U")
AUTOMATIC PURGE OF MAILMAN MES
"KRN",19,468,-1)
0^167
"KRN",19,468,0)
XMEDITUSER^User Options Edit^^R^^^XM-U-P-OPTIONS^^^^^MAILMAN^^
"KRN",19,468,1,0)
^19.06^21^21^3020509^^^^
"KRN",19,468,1,1,0)
Enables the user to edit various fields which identify the user and
"KRN",19,468,1,2,0)
specify his MailMan preferences.
"KRN",19,468,1,3,0)

"KRN",19,468,1,4,0)
Included are:
"KRN",19,468,1,5,0)
 - Banner
"KRN",19,468,1,6,0)
 - Message Display Order (Oldest/Newest First)
"KRN",19,468,1,7,0)
 - Message Reader (Classic/Full Screen)
"KRN",19,468,1,8,0)
 - Message Reader Prompt (ask/use default)
"KRN",19,468,1,9,0)
 - Message Action Default (Ignore/Delete)
"KRN",19,468,1,10,0)
 - Ask Baskets
"KRN",19,468,1,11,0)
 - Show Titles
"KRN",19,468,1,12,0)
 - Priority Responses Flag
"KRN",19,468,1,13,0)
 - Priority Responses Prompt
"KRN",19,468,1,14,0)
 - MailMan Institution
"KRN",19,468,1,15,0)
 - Network Signature
"KRN",19,468,1,16,0)
 - Introduction
"KRN",19,468,1,17,0)
 - Preferred Editor
"KRN",19,468,1,18,0)
 - Address
"KRN",19,468,1,19,0)
 - Phone
"KRN",19,468,1,20,0)
 - Fax
"KRN",19,468,1,21,0)
 - Pager
"KRN",19,468,25)
EDIT^XMVVITA
"KRN",19,468,99)
55394,60823
"KRN",19,468,"U")
USER OPTIONS EDIT
"KRN",19,469,-1)
0^35
"KRN",19,469,0)
XMASSUME^Become a Surrogate (SHARED,MAIL or Other)^^R^^^XM-U-I-SURROGATE^^^^^MAILMAN^^1^1
"KRN",19,469,1,0)
^^27^27^2990510^^^^
"KRN",19,469,1,1,0)
This option allows the user to act as a surrogate for another user
"KRN",19,469,1,2,0)
or for SHARED,MAIL.
"KRN",19,469,1,3,0)

"KRN",19,469,1,4,0)
Before you can act as a surrogate for another user, that user must
"KRN",19,469,1,5,0)
indicate permission by granting you surrogate privileges through
"KRN",19,469,1,6,0)
his USER OPTIONS EDIT.  You will then be able to read, answer, and
"KRN",19,469,1,7,0)
send mail for that user, depending on the level of access (read/write)
"KRN",19,469,1,8,0)
that you were granted.
"KRN",19,469,1,9,0)

"KRN",19,469,1,10,0)
You may assume the identity of a special user, 'SHARED,MAIL',
"KRN",19,469,1,11,0)
to read messages of general interest.  You will be able to read and
"KRN",19,469,1,12,0)
respond to messages there, but you will not be able to send any.
"KRN",19,469,1,13,0)
If you have been given the XMNOPRIV key, you will not be able
"KRN",19,469,1,14,0)
to access 'SHARED,MAIL'.
"KRN",19,469,1,15,0)

"KRN",19,469,1,16,0)
SHARED,MAIL is a place to send messages of general interest.
"KRN",19,469,1,17,0)
Almost all users may access this area.  When you send messages to
"KRN",19,469,1,18,0)
SHARED,MAIL, you must indicate a BASKET to deliver the messages to
"KRN",19,469,1,19,0)
so that helps others find yours.
"KRN",19,469,1,20,0)

"KRN",19,469,1,21,0)
Do not create new BASKETS unless it is really necessary.
"KRN",19,469,1,22,0)

"KRN",19,469,1,23,0)
Try to fit your message into a basket that already exists.  SHARED, MAIL
"KRN",19,469,1,24,0)
is a LIBRARY, NOT a repository for trivial or personal communications.
"KRN",19,469,1,25,0)
Please respect your privilege to be SHARED,MAIL surrogate.
"KRN",19,469,1,26,0)

"KRN",19,469,1,27,0)
The PRIVILEGE to be a SURROGATE of SHARED,MAIL may be taken away.
"KRN",19,469,15)
D CHECKOUT^XM
"KRN",19,469,20)
D CHECKIN^XM
"KRN",19,469,25)
ASSUME^XMVSURR
"KRN",19,469,"U")
BECOME A SURROGATE (SHARED,MAI
"KRN",19,470,-1)
0^37
"KRN",19,470,0)
XMBANNER^Banner Edit^^R^^^XM-U-P-BANNER^^^^^MAILMAN^^^
"KRN",19,470,1,0)
^^3^3^2971229^^^^
"KRN",19,470,1,1,0)
Enables a user to edit his "banner" message for MailMan.
"KRN",19,470,1,2,0)
When messages are addressed to users with banners, their banners
"KRN",19,470,1,3,0)
may be displayed.
"KRN",19,470,15)

"KRN",19,470,20)

"KRN",19,470,25)
BANNER^XMVVITA
"KRN",19,470,"U")
BANNER EDIT
"KRN",19,471,-1)
3^57
"KRN",19,471,0)
XMHELP^Help (User/Group Info., etc.)^^M^^^XMHELP^^^^^MAILMAN^^
"KRN",19,471,1,0)
^^1^1^2970730^^^^
"KRN",19,471,1,1,0)
Provides help for users.
"KRN",19,471,10,0)
^19.01PI^7^7
"KRN",19,471,10,1,0)
479^^1
"KRN",19,471,10,1,"^")
XMHELPUSER
"KRN",19,471,10,2,0)
472^^2
"KRN",19,471,10,2,"^")
XMHELPGROUP
"KRN",19,471,10,3,0)
565^^3
"KRN",19,471,10,3,"^")
XMHELPLNK
"KRN",19,471,10,4,0)
521^^4
"KRN",19,471,10,4,"^")
XM-NEW-FEATURES
"KRN",19,471,10,5,0)
473^^5
"KRN",19,471,10,5,"^")
XMHELPALL
"KRN",19,471,10,6,0)
499^^6
"KRN",19,471,10,6,"^")
XMHELPQUEST
"KRN",19,471,10,7,0)
548^^7
"KRN",19,471,10,7,"^")
XMHELP-ON-LINE-USER_MANUAL
"KRN",19,471,99)
58485,29408
"KRN",19,471,"U")
HELP (USER/GROUP INFO., ETC.)
"KRN",19,472,-1)
0^60
"KRN",19,472,0)
XMHELPGROUP^Group Information^^R^^^XM-U-H-GROUP^^^^^MAILMAN^^
"KRN",19,472,1,0)
^^1^1^2970730^^^^
"KRN",19,472,1,1,0)
Enables the user to get detailed information about mail groups.
"KRN",19,472,25)
HELP^XMHIG
"KRN",19,472,"U")
GROUP INFORMATION
"KRN",19,473,-1)
0^59
"KRN",19,473,0)
XMHELPALL^General MailMan Information^^A^^^^^^^^MAILMAN^^1^^
"KRN",19,473,1,0)
^^3^3^2970730^^^^
"KRN",19,473,1,1,0)
This is a general help frame that gives the most simple information
"KRN",19,473,1,2,0)
about what MailMan is and does.  It is a good starting point for the
"KRN",19,473,1,3,0)
beginner MailMan user.
"KRN",19,473,20)
S XQH="XMHELP" D EN^XQH
"KRN",19,473,"U")
GENERAL MAILMAN INFORMATION
"KRN",19,474,-1)
0^44
"KRN",19,474,0)
XMDXNAME^Name Server^^R^^^^^^^^
"KRN",19,474,1,0)
^^3^3^2850226^
"KRN",19,474,1,1,0)
This option tests the MailMan name server, allowing the user to repeatedly
"KRN",19,474,1,2,0)
enter recipient names, after which the option will show the resolution
"KRN",19,474,1,3,0)
of the name.
"KRN",19,474,25)
DX^XMA21
"KRN",19,474,"U")
NAME SERVER
"KRN",19,475,-1)
3^41
"KRN",19,475,0)
XMDX^Diagnostics^^M^^^^^^^^MAILMAN
"KRN",19,475,1,0)
^19.06^2^2^3020328^^^^
"KRN",19,475,1,1,0)
This menu contains diagnostic options, allowing the testing of various
"KRN",19,475,1,2,0)
components of the MailMan system.
"KRN",19,475,10,0)
^19.01IP^8^7
"KRN",19,475,10,1,0)
474^
"KRN",19,475,10,1,"^")
XMDXNAME
"KRN",19,475,10,2,0)
480^
"KRN",19,475,10,2,"^")
XMDXSMTP
"KRN",19,475,10,3,0)
481^
"KRN",19,475,10,3,"^")
XMDXPROT
"KRN",19,475,10,4,0)
482^
"KRN",19,475,10,4,"^")
XMDXSCRIPT
"KRN",19,475,10,6,0)
465^
"KRN",19,475,10,6,"^")
XMPOST
"KRN",19,475,10,7,0)
484^
"KRN",19,475,10,7,"^")
XMDXERROR
"KRN",19,475,10,8,0)
476^
"KRN",19,475,10,8,"^")
XMDXMODEM
"KRN",19,475,99)
58891,27535
"KRN",19,475,"U")
DIAGNOSTICS
"KRN",19,476,-1)
0^43
"KRN",19,476,0)
XMDXMODEM^Modem Autodialer test^^R^^^^^^^^
"KRN",19,476,1,0)
^^2^2^2931206^^^
"KRN",19,476,1,1,0)
This option tests the modem, allowing the user to dial and hang up the
"KRN",19,476,1,2,0)
modem to insure that the DEVICE and TERMINAL TYPE entries are correct.
"KRN",19,476,25)
DIALER^XMCD
"KRN",19,476,"U")
MODEM AUTODIALER TEST
"KRN",19,477,-1)
3^107
"KRN",19,477,0)
XMNET^Network Management^^M^^^XM-I-N-NETWORK^^^^^MAILMAN^^1^1^^
"KRN",19,477,1,0)
^^3^3^2930319^^^^
"KRN",19,477,1,1,0)
This menu allows the user to control the network; editing, playing, and
"KRN",19,477,1,2,0)
listing scripts, managing domains, christening subordinate domains, 
"KRN",19,477,1,3,0)
controlling pollers, etc.
"KRN",19,477,10,0)
^19.01PI^6^6
"KRN",19,477,10,1,0)
492
"KRN",19,477,10,1,"^")
XMSITE
"KRN",19,477,10,2,0)
493
"KRN",19,477,10,2,"^")
XMCHRIS
"KRN",19,477,10,3,0)
511
"KRN",19,477,10,3,"^")
XMNETHELP
"KRN",19,477,10,4,0)
544
"KRN",19,477,10,4,"^")
XMQDOMAINS
"KRN",19,477,10,5,0)
552
"KRN",19,477,10,5,"^")
XMNET-TRANSMISSION-MANAGEMENT
"KRN",19,477,10,6,0)
551
"KRN",19,477,10,6,"^")
XMNET-QUEUE-MANAGEMENT
"KRN",19,477,15)
D CHECKOUT^XM
"KRN",19,477,20)
D CHECKIN^XM
"KRN",19,477,25)

"KRN",19,477,99)
58946,54050
"KRN",19,477,99.1)
53415,38614
"KRN",19,477,"U")
NETWORK MANAGEMENT
"KRN",19,478,-1)
0^19
"KRN",19,478,0)
XMSCRIPTRES^Resume processing a script^^R^^^^^^^^MAILMAN
"KRN",19,478,1,0)
^19.06^2^2^3020312^^^
"KRN",19,478,1,1,0)
This option allows the user to resume the interpretation of a script,
"KRN",19,478,1,2,0)
with manual intervention.
"KRN",19,478,25)
RESUME^XMC1
"KRN",19,478,"U")
RESUME PROCESSING A SCRIPT
"KRN",19,479,-1)
0^63
"KRN",19,479,0)
XMHELPUSER^User Information^^R^^^XM-U-H-USER^^^^^MAILMAN^^
"KRN",19,479,1,0)
^^1^1^2970730^^
"KRN",19,479,1,1,0)
Enables the user to get detailed information about other MailMan users.
"KRN",19,479,25)
HELP^XMHIU
"KRN",19,479,"U")
USER INFORMATION
"KRN",19,480,-1)
0^47
"KRN",19,480,0)
XMDXSMTP^Simple Mail Transfer Protocol^^R^^^^^^^^
"KRN",19,480,1,0)
^^3^3^2850423^^
"KRN",19,480,1,1,0)
This option allows the user to enter information directly into the
"KRN",19,480,1,2,0)
SMTP protocol receiver from the keyboard.  See the ARPA manual for
"KRN",19,480,1,3,0)
further description of the protocol, or type HELP during the protocol.
"KRN",19,480,25)
SMTP^XMCD
"KRN",19,480,"U")
SIMPLE MAIL TRANSFER PROTOCOL
"KRN",19,481,-1)
0^45
"KRN",19,481,0)
XMDXPROT^Physical link protocol^^A^^^^^^^^^^1
"KRN",19,481,1,0)
^^2^2^2850226^
"KRN",19,481,1,1,0)
This message will send a line of text to the terminal, allowing the user
"KRN",19,481,1,2,0)
to respond with the appropriate response.
"KRN",19,481,20)
Q
"KRN",19,481,25)
C^XML
"KRN",19,481,"U")
PHYSICAL LINK PROTOCOL
"KRN",19,482,-1)
0^46
"KRN",19,482,0)
XMDXSCRIPT^Script processor^^R^^^^^^^^
"KRN",19,482,1,0)
^^2^2^2850424^^
"KRN",19,482,1,1,0)
This will test a script, sending a dummy message and measuring error
"KRN",19,482,1,2,0)
rates and transmission speeds.
"KRN",19,482,25)
TRAN^XMCD
"KRN",19,482,"U")
SCRIPT PROCESSOR
"KRN",19,485,-1)
0^123
"KRN",19,485,0)
XMPROU^Routine load^^R^^^^^^^^
"KRN",19,485,1,0)
^^2^2^2900806^^^
"KRN",19,485,1,1,0)
This option loads routines from the routine library to the message.
"KRN",19,485,1,2,0)
Routines may be named individually, or with the traditional "*" notation.
"KRN",19,485,25)
LOAD^XMPH
"KRN",19,485,"U")
ROUTINE LOAD
"KRN",19,486,-1)
0^118
"KRN",19,486,0)
XMPGLO^Global load^^R^^^^^^^^
"KRN",19,486,1,0)
^^1^1^2870814^^
"KRN",19,486,1,1,0)
This option loads data into the message from the global subtree indicated.
"KRN",19,486,25)
LOAD^XMPG
"KRN",19,486,"U")
GLOBAL LOAD
"KRN",19,488,-1)
0^125
"KRN",19,488,0)
XMPSUM^Summarize message^^R^^^^^^^^
"KRN",19,488,1,0)
^^3^3^2850226^
"KRN",19,488,1,1,0)
This option summarizes the message, listing each packet in the package,
"KRN",19,488,1,2,0)
along with its line number.  It does not list the contents in each packet;
"KRN",19,488,1,3,0)
the Print option does that.
"KRN",19,488,25)
XS^XMP2
"KRN",19,488,"U")
SUMMARIZE MESSAGE
"KRN",19,489,-1)
0^121
"KRN",19,489,0)
XMPPRT^Print message (formatted)^^R^^^^^^^^
"KRN",19,489,1,0)
^^3^3^2850226^
"KRN",19,489,1,1,0)
This option prints the message in a neatly formatted form.  Global data
"KRN",19,489,1,2,0)
is preceded by its subscript, routines are wrapped around, and fitted one
"KRN",19,489,1,3,0)
per page.
"KRN",19,489,25)
XP^XMP2
"KRN",19,489,"U")
PRINT MESSAGE (FORMATTED)
"KRN",19,490,-1)
0^119
"KRN",19,490,0)
XMPINS^Install Package & Run Inits^^R^^^^^^^^
"KRN",19,490,1,0)
^^3^3^2921230^^
"KRN",19,490,1,1,0)
This option installs the package contained in the message into the active
"KRN",19,490,1,2,0)
area.  It permanently updates the routines, globals, and files in doing
"KRN",19,490,1,3,0)
so.
"KRN",19,490,25)
XI^XMP2
"KRN",19,490,"U")
INSTALL PACKAGE & RUN INITS
"KRN",19,491,-1)
0^117
"KRN",19,491,0)
XMPCOM^Compare message^^R^^^^^^^^
"KRN",19,491,1,0)
^^3^3^2850226^
"KRN",19,491,1,1,0)
This option compares the message with the currently installed version of
"KRN",19,491,1,2,0)
the package, informing the user of the differences on a line by line
"KRN",19,491,1,3,0)
basis.
"KRN",19,491,25)
XC^XMP2
"KRN",19,491,99.1)
55615,38578
"KRN",19,491,"U")
COMPARE MESSAGE
"KRN",19,492,-1)
0^177
"KRN",19,492,0)
XMSITE^Site Parameters^^A^^^^^^^^^^1^^
"KRN",19,492,1,0)
^19.06^2^2^3020522^^^^
"KRN",19,492,1,1,0)
This option allows the network manager to control local site parameters, 
"KRN",19,492,1,2,0)
names, time zone, etc.
"KRN",19,492,20)
S DR=".01;1;3;5:7.4;8.15:8.4",DIE="^XMB(1,",DA=1 D ^DIE W !!,"Editing postmaster information" S DR="4;4.5;8",DIE="^XMB(3.7,",DA=.5 D ^DIE K DIE,DR,DA
"KRN",19,492,25)

"KRN",19,492,"U")
SITE PARAMETERS
"KRN",19,493,-1)
0^24
"KRN",19,493,0)
XMCHRIS^Christen a domain^^R^^^^^^^^MAILMAN^^
"KRN",19,493,1,0)
^^5^5^2940312^^^^
"KRN",19,493,1,0,"LE")
1
"KRN",19,493,1,1,0)
This option is used to christen a domain, which is required
"KRN",19,493,1,2,0)
before that domain may send or receive networked mail.  The subordinate
"KRN",19,493,1,3,0)
domain must first be initialized with the "initialize site" option at the 
"KRN",19,493,1,4,0)
local domain.  Then this option must be selected in order to establish the
"KRN",19,493,1,5,0)
network relationship.
"KRN",19,493,25)
CHRISTEN^XMUDCHR
"KRN",19,493,"U")
CHRISTEN A DOMAIN
"KRN",19,494,-1)
0^16
"KRN",19,494,0)
XMSCRIPTEDIT^Edit a script^^R^^^^^^^^MAILMAN^^
"KRN",19,494,1,0)
^19.06^1^1^3020312^^^
"KRN",19,494,1,1,0)
This option allows the editing of a script in file 4.2 for a given domain.
"KRN",19,494,25)
EDIT42^XMCE
"KRN",19,494,99)
54850,27281
"KRN",19,494,"U")
EDIT A SCRIPT
"KRN",19,495,-1)
0^5
"KRN",19,495,0)
XMLIST^List a transcript^^R^^^^^^^^MAILMAN^^
"KRN",19,495,1,0)
^19.06^1^1^3020312^^
"KRN",19,495,1,1,0)
This option lists the transcript for a previously played script.
"KRN",19,495,25)
LIST^XMCXT
"KRN",19,495,"U")
LIST A TRANSCRIPT
"KRN",19,496,-1)
0^18
"KRN",19,496,0)
XMSCRIPTPLAY^Play a script^^R^^^^^^^^MAILMAN^^
"KRN",19,496,1,0)
^19.06^9^9^3020312^^^^
"KRN",19,496,1,1,0)
If messages are queued in the Postmaster box for a given domain, you can
"KRN",19,496,1,2,0)
start those messages transmitting immediately (in the foreground) by
"KRN",19,496,1,3,0)
invoking this option.  (It will not create a task.  If you want to create
"KRN",19,496,1,4,0)
a task, then use option XMSTARTQUE.)
"KRN",19,496,1,5,0)

"KRN",19,496,1,6,0)
If you want to pull messages from another domain, this is the option to
"KRN",19,496,1,7,0)
use, whether or not there are messages queued to transmit to that domain.
"KRN",19,496,1,8,0)
(If you regularly pull messages from another domain, you may wish to
"KRN",19,496,1,9,0)
consider polling that domain.  See option XMPOLL for more information.)
"KRN",19,496,25)
PLAY^XMCX
"KRN",19,496,99)
54766,39687
"KRN",19,496,"U")
PLAY A SCRIPT
"KRN",19,499,-1)
0^62
"KRN",19,499,0)
XMHELPQUEST^Questions and Answers on MailMan^^A^^^^^^^^MAILMAN^^1^^
"KRN",19,499,1,0)
^^1^1^2970730^^^
"KRN",19,499,1,1,0)
This help frame poses and answers frequently asked questions.
"KRN",19,499,20)
S XQH="XM-U-H-QUESTIONS" D EN^XQH
"KRN",19,499,"U")
QUESTIONS AND ANSWERS ON MAILM
"KRN",19,500,-1)
3^122
"KRN",19,500,0)
XMPRECV^Package recieved^^M^^^^^^^^
"KRN",19,500,1,0)
^^1^1^2850628^
"KRN",19,500,1,1,0)
This menu will let you print, compare, and load an packman message.
"KRN",19,500,10,0)
^19.01PI^4^4
"KRN",19,500,10,1,0)
491^
"KRN",19,500,10,1,"^")
XMPCOM
"KRN",19,500,10,2,0)
489^
"KRN",19,500,10,2,"^")
XMPPRT
"KRN",19,500,10,3,0)
488^
"KRN",19,500,10,3,"^")
XMPSUM
"KRN",19,500,10,4,0)
490^
"KRN",19,500,10,4,"^")
XMPINS
"KRN",19,500,99)
56579,51892
"KRN",19,500,"U")
PACKAGE RECIEVED
"KRN",19,501,-1)
0^147
"KRN",19,501,0)
XMPACK^Load PackMan Message^^R^^XUPROGMODE^XM-U-K-PACKMAN^^^^^MAILMAN^^1^1^
"KRN",19,501,1,0)
^^1^1^2971002^^^^
"KRN",19,501,1,1,0)
Enables the user to create a PackMan message.
"KRN",19,501,15)
D CHECKOUT^XM
"KRN",19,501,20)
D CHECKIN^XM
"KRN",19,501,25)
PAKMAN^XMJMS
"KRN",19,501,99)
54082,25317
"KRN",19,501,99.1)
54447,33482
"KRN",19,501,"U")
LOAD PACKMAN MESSAGE
"KRN",19,503,-1)
0^56
"KRN",19,503,0)
XMENROLL^Enroll in (or Disenroll from) a Mail Group^^R^^^XM-U-P-GROUP ENROLL^^^^^MAILMAN^^^^
"KRN",19,503,1,0)
^^7^7^2971007^^^^
"KRN",19,503,1,1,0)
This option enables a mailman user to enroll in & disenroll from mail
"KRN",19,503,1,2,0)
groups for which self-enrollment is allowed.
"KRN",19,503,1,3,0)
The user chooses a mail group.
"KRN",19,503,1,4,0)
If the user is already a member of the group, then this option
"KRN",19,503,1,5,0)
enables the user to leave the group.
"KRN",19,503,1,6,0)
If the user is not already a member of the group, then this option
"KRN",19,503,1,7,0)
enables the user to join the group.
"KRN",19,503,20)

"KRN",19,503,25)
ENROLL^XMVGROUP
"KRN",19,503,"U")
ENROLL IN (OR DISENROLL FROM) 
"KRN",19,504,-1)
0^8
"KRN",19,504,0)
XMQDISP^Display Active & Inactive Message Queues^^R^^^^^^^y^MAILMAN^^^^^
"KRN",19,504,1,0)
^19.06^16^16^3020312^^^^
"KRN",19,504,1,1,0)
Reports on every active queue and every queue with messages.
"KRN",19,504,1,2,0)
 
"KRN",19,504,1,3,0)
For active queues, it shows much the same information as option
"KRN",19,504,1,4,0)
XMQACTIVE (Actively transmitting queues), except that instead of
"KRN",19,504,1,5,0)
the task number, it shows the date/time that the information was
"KRN",19,504,1,6,0)
last updated.
"KRN",19,504,1,7,0)
 
"KRN",19,504,1,8,0)
For inactive queues which have messages, it shows whether or not
"KRN",19,504,1,9,0)
there's a task scheduled.  If there is, it tells you what time
"KRN",19,504,1,10,0)
it's scheduled for.  If there isn't, it shows you the FLAGS field
"KRN",19,504,1,11,0)
for that domain in the DOMAIN file.  By looking at the FLAGS field,
"KRN",19,504,1,12,0)
you should be able to tell whether a task needs to be created to
"KRN",19,504,1,13,0)
transmit the queue.  Generally, if the FLAGS field contains "S"
"KRN",19,504,1,14,0)
(for SEND), and there's no task scheduled, you probably ought to
"KRN",19,504,1,15,0)
schedule one, using either option XMSTARTQUE-ALL (for all queues),
"KRN",19,504,1,16,0)
or XMSTARTQUE (for a queue of your choice).
"KRN",19,504,15)

"KRN",19,504,20)

"KRN",19,504,25)
STATUS^XMCQ
"KRN",19,504,"U")
DISPLAY ACTIVE & INACTIVE MESS
"KRN",19,505,-1)
3^124
"KRN",19,505,0)
XMPSEND^Send Package transfer (PackMan)^^M^^XUPROG^^^^^^
"KRN",19,505,1,0)
^^2^2^2850226^^
"KRN",19,505,1,1,0)
This option allows the user to load routines, globals, files, and data
"KRN",19,505,1,2,0)
dictionaries.
"KRN",19,505,10,0)
^19.01PI^7^6
"KRN",19,505,10,1,0)
485^
"KRN",19,505,10,1,"^")
XMPROU
"KRN",19,505,10,2,0)
486^
"KRN",19,505,10,2,"^")
XMPGLO
"KRN",19,505,10,3,0)
487^
"KRN",19,505,10,3,"^")
XMPDAT
"KRN",19,505,10,4,0)
488^
"KRN",19,505,10,4,"^")
XMPSUM
"KRN",19,505,10,5,0)
489^
"KRN",19,505,10,5,"^")
XMPPRT
"KRN",19,505,10,7,0)
491^
"KRN",19,505,10,7,"^")
XMPCOM
"KRN",19,505,25)

"KRN",19,505,99)
56579,51892
"KRN",19,505,"U")
SEND PACKAGE TRANSFER (PACKMAN
"KRN",19,506,-1)
0^153
"KRN",19,506,0)
XMPOLL^POLL REMOTE NODES^^R^^^^^^^^MAILMAN^^
"KRN",19,506,1,0)
^19.06^17^17^3020508^^^^
"KRN",19,506,1,1,0)
The poller schedules tasks to transmit to domains whose flags contain a 'P'. 
"KRN",19,506,1,2,0)
The tasks will play scripts to those domains whether or not there are messages
"KRN",19,506,1,3,0)
in the queues for those domains.  The TURN command (assuming it isn't disabled
"KRN",19,506,1,4,0)
(field 1.7 of file 4.2) will "pull" any messages queued at that domain waiting
"KRN",19,506,1,5,0)
to be transmitted to this one.
"KRN",19,506,1,6,0)

"KRN",19,506,1,7,0)
One of the FLAGS (file 4.2, field 1) that can be set for a particular domain
"KRN",19,506,1,8,0)
is 'P' for poller.  If FLAGS includes a 'P', the domain will be polled.
"KRN",19,506,1,9,0)

"KRN",19,506,1,10,0)
XMPOLL can be scheduled through 'Schedule Tasks' on the Taskman menu.  Set a
"KRN",19,506,1,11,0)
time for transmission such as an off-peak evening hour.  The device for output
"KRN",19,506,1,12,0)
may be null, the default being the device on which the Taskman was started.
"KRN",19,506,1,13,0)
Rescheduling frequency may also be null.  XMPOLL will then open the link for
"KRN",19,506,1,14,0)
transmission at the designated time.
"KRN",19,506,1,15,0)

"KRN",19,506,1,16,0)
Playing a script will also open the link.  So, domains with 'P' and without
"KRN",19,506,1,17,0)
'S' flags can be transmitted by playing the script to them.
"KRN",19,506,2)
n
"KRN",19,506,25)
POLL^XMCP
"KRN",19,506,200.9)
y
"KRN",19,506,"U")
POLL REMOTE NODES
"KRN",19,507,-1)
0^22
"KRN",19,507,0)
XMSUBEDIT^Subroutine editor^^R^^^^^^^^MAILMAN^^^^
"KRN",19,507,1,0)
^19.06^1^1^3020312^^^
"KRN",19,507,1,1,0)
This option edits transmission script subroutines in file 4.6.
"KRN",19,507,20)

"KRN",19,507,25)
EDIT46^XMCE
"KRN",19,507,"U")
SUBROUTINE EDITOR
"KRN",19,508,-1)
0^10
"KRN",19,508,0)
XMQSHOW^Show a queue^^R^^^^^^^y^MAILMAN^^^^
"KRN",19,508,1,0)
^19.06^1^1^3020312^^^^
"KRN",19,508,1,1,0)
Show all of the messages waiting transmission for a given queue.
"KRN",19,508,20)

"KRN",19,508,25)
SHOWQ^XMCQ
"KRN",19,508,"U")
SHOW A QUEUE
"KRN",19,510,-1)
0^156
"KRN",19,510,0)
XMSTARTQUE^Transmit a Single Queue^^R^^^XM-I-N-XMIT SCHEDULE TASK^^^^^MAILMAN^^
"KRN",19,510,1,0)
^19.06^6^6^3020312^^^^
"KRN",19,510,1,1,0)
If messages are queued in the Postmaster box for a given domain, that
"KRN",19,510,1,2,0)
domain can begin transmitting those messages by invoking this option.
"KRN",19,510,1,3,0)
Messages may be sitting in a queue for a variety of reasons (transmission
"KRN",19,510,1,4,0)
failure, waiting for poller to run, etc.).  This option will attempt
"KRN",19,510,1,5,0)
to send these messages by creating a taskmanager job which will deliver
"KRN",19,510,1,6,0)
the messages for the domain requested.
"KRN",19,510,25)
Q1^XMCX
"KRN",19,510,"U")
TRANSMIT A SINGLE QUEUE
"KRN",19,511,-1)
0^161
"KRN",19,511,0)
XMNETHELP^Network Help^^A^^^^^^^^^^1^^
"KRN",19,511,1,0)
^^1^1^2870106^
"KRN",19,511,1,1,0)
This will display all network help frames
"KRN",19,511,20)
S XQH="XM-I-N-NETWORK" D EN^XQH
"KRN",19,511,"U")
NETWORK HELP
"KRN",19,512,-1)
0^138
"KRN",19,512,0)
XMUT-CHKFIL^Check MailMan Files for Errors^^R^^XUPROG^^^^^^MAILMAN^^
"KRN",19,512,1,0)
^19.06^13^13^3010419^^^^
"KRN",19,512,1,1,0)
This option checks for and corrects errors in the MAILBOX file 3.7 and
"KRN",19,512,1,2,0)
the MESSAGE file 3.9.  It checks important fields and cross references.
"KRN",19,512,1,3,0)

"KRN",19,512,1,4,0)
It is recommended that this option be run monthly or every few months,
"KRN",19,512,1,5,0)
or whenever there seems to be a database problem.
"KRN",19,512,1,6,0)
 
"KRN",19,512,1,7,0)
It produces a report of the errors detected, and what, if anything, it
"KRN",19,512,1,8,0)
did to fix them.  If it didn't fix them, it tells you what you can do
"KRN",19,512,1,9,0)
to fix them.
"KRN",19,512,1,10,0)
 
"KRN",19,512,1,11,0)
Although the system will not fail because of errors detected, your users
"KRN",19,512,1,12,0)
may call you about the problems they experience.  This utility will allow
"KRN",19,512,1,13,0)
you to detect them first and correct them before anyone knows.
"KRN",19,512,25)
CHKFILES^XMUT4
"KRN",19,512,200.9)
y
"KRN",19,512,"U")
CHECK MAILMAN FILES FOR ERRORS
"KRN",19,513,-1)
3^152
"KRN",19,513,0)
XMUT-REC-MENU^Recover Messages into User's IN Basket^^M^^^XM-I-D-RECOVER MSGS^^^^^^^
"KRN",19,513,1,0)
^^4^4^2931206^^^^
"KRN",19,513,1,1,0)
This menu is about recovering messages for a user who has inadvertently
"KRN",19,513,1,2,0)
lost messages.  It will recover all the messages a user has ever received
"KRN",19,513,1,3,0)
and is not terminated from.  The steps are reviewed in the help
"KRN",19,513,1,4,0)
documentation.  (Enter '?HELP' to see the HELP documentation.)
"KRN",19,513,10,0)
^19.01PI^4^4
"KRN",19,513,10,1,0)
517^FRM
"KRN",19,513,10,1,"^")
XMUT-REC-FIND
"KRN",19,513,10,2,0)
518^LRM
"KRN",19,513,10,2,"^")
XMUT-REC-RPT
"KRN",19,513,10,3,0)
519^DRM
"KRN",19,513,10,3,"^")
XMUT-REC-DELIVER
"KRN",19,513,10,4,0)
532^DEL
"KRN",19,513,10,4,"^")
XMUT-REC-DELETE
"KRN",19,513,99)
58926,53193
"KRN",19,513,"U")
RECOVER MESSAGES INTO USER'S I
"KRN",19,514,-1)
0^38
"KRN",19,514,0)
XMBASKLIST^Mailbox Contents List^^R^^^XM-U-B-BASKET CONTENTS LIST^^^^^MAILMAN^^^^
"KRN",19,514,1,0)
^^4^4^2980520^^^^
"KRN",19,514,1,1,0)
Prints/Displays a list of all messages in all/one of your mail baskets.
"KRN",19,514,1,2,0)

"KRN",19,514,1,3,0)
The list is sorted by basket name, and within basket by message index
"KRN",19,514,1,4,0)
number.
"KRN",19,514,20)

"KRN",19,514,25)
LISTMBOX^XMJBL
"KRN",19,514,99)
55614,50948
"KRN",19,514,"U")
MAILBOX CONTENTS LIST
"KRN",19,515,-1)
0^148
"KRN",19,515,0)
XMTALK^TalkMan^^R^^XMTALK^XM-I-C-TALKMAN^^^^^MAILMAN^^
"KRN",19,515,1,0)
^19.06^6^6^3020312^^^^
"KRN",19,515,1,1,0)
TalkMan allows the user to communicate with another domain through the
"KRN",19,515,1,2,0)
script processing ability of MailMan.  Since the Script Processing
"KRN",19,515,1,3,0)
mode is transparent, the user need not know any security passwords...
"KRN",19,515,1,4,0)
He only needs to know the name of the Domain and have access to the
"KRN",19,515,1,5,0)
option.  In addition, the script for the domain must have a 'T' command
"KRN",19,515,1,6,0)
and the FLAGS field must contain a 'T'.
"KRN",19,515,25)
TALK^XMCTLK
"KRN",19,515,99)
55504,52838
"KRN",19,515,99.1)
55615,38578
"KRN",19,515,"U")
TALKMAN
"KRN",19,516,-1)
3^67
"KRN",19,516,0)
XMMASTER^MailMan Master Menu^^M^^^XM-MASTER^^^^^^^
"KRN",19,516,1,0)
^^4^4^2870825^^^
"KRN",19,516,1,1,0)
This is the MailMan menu with all the addressable options:
"KRN",19,516,1,2,0)
   Manage MailMan (Utilities)
"KRN",19,516,1,3,0)
   Network Management
"KRN",19,516,1,4,0)
   User Options
"KRN",19,516,10,0)
^19.01PI^3^3
"KRN",19,516,10,1,0)
458^XMU
"KRN",19,516,10,1,"^")
XMUSER
"KRN",19,516,10,2,0)
477^XMN
"KRN",19,516,10,2,"^")
XMNET
"KRN",19,516,10,3,0)
463^XMM
"KRN",19,516,10,3,"^")
XMMGR
"KRN",19,516,99)
58933,34971
"KRN",19,516,99.1)
53900,52555
"KRN",19,516,"U")
MAILMAN MASTER MENU
"KRN",19,517,-1)
0^150
"KRN",19,517,0)
XMUT-REC-FIND^Find Messages for User^^R^^^XM-I-D-RECOVER MSGS-FIND^^^^^^^
"KRN",19,517,1,0)
^^4^4^2870825^^^
"KRN",19,517,1,1,0)
Use this option to find all the messages that a user has ever had and has
"KRN",19,517,1,2,0)
not terminated from.  This list of messages can be used as input into two
"KRN",19,517,1,3,0)
other processes:  Deliver Found Messages into User's IN Basket, and List
"KRN",19,517,1,4,0)
Messages Found.
"KRN",19,517,25)
A^XMUT1
"KRN",19,517,"U")
FIND MESSAGES FOR USER
"KRN",19,518,-1)
0^151
"KRN",19,518,0)
XMUT-REC-RPT^List Messages Found^^R^^^XM-I-D-RECOVER MSGS-LIST^^^^^^^
"KRN",19,518,1,0)
^^2^2^2870825^
"KRN",19,518,1,1,0)
Use this procedure to list the messages found for users with the procedure
"KRN",19,518,1,2,0)
'Find Messages for User'.
"KRN",19,518,25)
LIST^XMUT1A
"KRN",19,518,"U")
LIST MESSAGES FOUND
"KRN",19,519,-1)
0^149
"KRN",19,519,0)
XMUT-REC-DELIVER^Deliver Found Messages into User's IN Basket^^R^^^XM-I-D-RECOVER MSGS-PUT^^^^^^^
"KRN",19,519,1,0)
^^3^3^2870825^
"KRN",19,519,1,1,0)
Use this procedure to deliver the messages found with the 'Find Messages
"KRN",19,519,1,2,0)
for User' option.  The Messages found with that option will be placed into
"KRN",19,519,1,3,0)
the user's IN basket, but only if they are not already in another basket.
"KRN",19,519,25)
G^XMUT1
"KRN",19,519,"U")
DELIVER FOUND MESSAGES INTO US
"KRN",19,520,-1)
0^155
"KRN",19,520,0)
XMSTARTQUE-ALL^Transmit All Queues^^R^^^XM-I-N-XMIT SCHEDULE TASK^^^^^MAILMAN^^
"KRN",19,520,1,0)
^19.06^5^5^3020312^^^^
"KRN",19,520,1,1,0)
If messages are queued in the Postmaster's baskets for a number of domains,
"KRN",19,520,1,2,0)
taskmanager jobs that will transmit them over the network can be created
"KRN",19,520,1,3,0)
for all of them by using this option.  A Domain's queue will not be requeued
"KRN",19,520,1,4,0)
if it is already set up as a scheduled taskmanager job.  Nor will it be
"KRN",19,520,1,5,0)
requeued if it is empty or active in the process of transmitting.
"KRN",19,520,25)
QALL^XMCX
"KRN",19,520,"U")
TRANSMIT ALL QUEUES
"KRN",19,521,-1)
0^34
"KRN",19,521,0)
XM-NEW-FEATURES^New Features in MailMan^^A^^^^^^^^MAILMAN^^1^^
"KRN",19,521,1,0)
^^3^3^2981019^^^^
"KRN",19,521,1,1,0)
Displays a help frame which informs the user about new MailMan features.
"KRN",19,521,1,2,0)
Many users do not get manuals.  
"KRN",19,521,1,3,0)
Therefore it is very important that this sort of documentation be on-line.
"KRN",19,521,20)
S XQH="XM-U-NEW FEATURES" D EN^XQH
"KRN",19,521,99)
54870,25976
"KRN",19,521,"U")
NEW FEATURES IN MAILMAN
"KRN",19,522,-1)
0^53
"KRN",19,522,0)
XMEDITPERSGROUP^Personal Mail Group Edit^^R^^^XM-U-P-GROUP PERSONAL^^^^^MAILMAN^^
"KRN",19,522,1,0)
^^5^5^2971007^^^^
"KRN",19,522,1,1,0)
This option allows the user to create or edit a personal group.
"KRN",19,522,1,2,0)
A personal group is one that only the user can access, to use
"KRN",19,522,1,3,0)
in addressing mail.  Members can not remove themselves.
"KRN",19,522,1,4,0)
The difference between a personal group and a private one is
"KRN",19,522,1,5,0)
that the personal group is restricted in its use and joining. 
"KRN",19,522,25)
PERSONAL^XMVGROUP
"KRN",19,522,99)
55469,51715
"KRN",19,522,"U")
PERSONAL MAIL GROUP EDIT
"KRN",19,523,-1)
0^157
"KRN",19,523,0)
XMMGR-HELP^New Features for Managing MailMan^^A^^^^^^^^^^1^^
"KRN",19,523,1,0)
^^1^1^2931206^
"KRN",19,523,1,1,0)
This option has help for site management.
"KRN",19,523,20)
S XQH="XM-I-NEW FEATURES" D EN^XQH
"KRN",19,523,"U")
NEW FEATURES FOR MANAGING MAIL
"KRN",19,524,-1)
0^154
"KRN",19,524,0)
XMMGR-IN-BASKET-PURGE^IN Basket Purge^^R^^^^^^^^MAILMAN^^
"KRN",19,524,1,0)
^19.06^19^19^3020509^^^^
"KRN",19,524,1,1,0)
THIS OPTION MAY RUN VIA THE TASKMANAGER.
"KRN",19,524,1,2,0)
 
"KRN",19,524,1,3,0)
This option purges 'IN' Baskets in two steps:
"KRN",19,524,1,4,0)
 
"KRN",19,524,1,5,0)
1.  In the first step messages are sent to users
"KRN",19,524,1,6,0)
    a.  Message will contain a list of messages to be purged in step two.
"KRN",19,524,1,7,0)
    b.  Message will contain list of actions that will prevent the purging
"KRN",19,524,1,8,0)
        of the listed messages.
"KRN",19,524,1,9,0)
    c.  Message will state how many days later listed messages will be 
"KRN",19,524,1,10,0)
        purged unless the action is taken on a message by message basis.
"KRN",19,524,1,11,0)
    d.  The messages listed will not have been referenced for 30 days
"KRN",19,524,1,12,0)
        or the number of days in the MAILMAN SITE PARAMETERS file, field
"KRN",19,524,1,13,0)
        'IN-BASKET-PURGE DAYS', if it is not null.
"KRN",19,524,1,14,0)
 
"KRN",19,524,1,15,0)
2.  In the second step the messages listed in the message from step 1
"KRN",19,524,1,16,0)
    will be purged not less than 30 days later unless they:
"KRN",19,524,1,17,0)
    a.  Have been saved into a basket other than the 'IN' basket.
"KRN",19,524,1,18,0)
    b.  Have been referenced (read or printed) otherwise.
"KRN",19,524,1,19,0)
    c.  Are marked as NEW.
"KRN",19,524,25)
ENTER^XMUPIN
"KRN",19,524,"U")
IN BASKET PURGE
"KRN",19,525,-1)
0^9
"KRN",19,525,0)
XMQHIST^Historical Queue Data/Stats Report^^R^^^^^^^y^MAILMAN^^
"KRN",19,525,1,0)
^19.06^5^5^3020312^^^^
"KRN",19,525,1,1,0)
Reports on network transmission queues.
"KRN",19,525,1,2,0)
It includes every domain in the DOMAIN file which has ever had any
"KRN",19,525,1,3,0)
activity.  It includes the total number of messages ever received
"KRN",19,525,1,4,0)
from or sent to each domain, as well as the number of messages
"KRN",19,525,1,5,0)
which are currently queued to be transmitted to each domain.
"KRN",19,525,25)
ENTER^XMCQH
"KRN",19,525,"U")
HISTORICAL QUEUE DATA/STATS RE
"KRN",19,526,-1)
0^7
"KRN",19,526,0)
XMQACTIVE^Actively Transmiting/Receiving Queues Report^^R^^^^^^^y^MAILMAN^^
"KRN",19,526,1,0)
^19.06^4^4^3020312^^^^
"KRN",19,526,1,1,0)
This report shows only those queues that are currently (right now)
"KRN",19,526,1,2,0)
transmitting or receiving messages.  It will state the message
"KRN",19,526,1,3,0)
numbers and the approximate line number in progress and the
"KRN",19,526,1,4,0)
characters per second.
"KRN",19,526,20)

"KRN",19,526,25)
ACTIVE^XMCQA
"KRN",19,526,"U")
ACTIVELY TRANSMITING/RECEIVING
"KRN",19,527,-1)
0^175
"KRN",19,527,0)
XMQUEUED^Queues with Messages to Transmit Report^^R^^^^^^^y^MAILMAN^^^^
"KRN",19,527,1,0)
^19.06^4^4^3020509^^^^
"KRN",19,527,1,1,0)
This option produces a report of all those queues that have messages
"KRN",19,527,1,2,0)
to go out.  The list does not say whether there is or is not a task
"KRN",19,527,1,3,0)
scheduled to send them.  Requeuing them is okay even if there is already
"KRN",19,527,1,4,0)
a task to go out.
"KRN",19,527,15)

"KRN",19,527,20)

"KRN",19,527,25)
ALL^XMCQA
"KRN",19,527,"U")
QUEUES WITH MESSAGES TO TRANSM
"KRN",19,528,-1)
0^176
"KRN",19,528,0)
XMSEARCH^Query/Search for Messages^^R^^^XM-U-Q-SEARCH^^^^^MAILMAN^^1^1
"KRN",19,528,1,0)
^19.06^16^16^3020509^^^^
"KRN",19,528,1,1,0)
Enables you to find messages sent by you or sent to you,
"KRN",19,528,1,2,0)
based on various criteria.
"KRN",19,528,1,3,0)

"KRN",19,528,1,4,0)
You may search the entire database of existing messages, regardless
"KRN",19,528,1,5,0)
of whether they are in one of your baskets or not, or whether you have
"KRN",19,528,1,6,0)
terminated them or not.  Such a search may only be made based upon
"KRN",19,528,1,7,0)
'Subject start with' a string.
"KRN",19,528,1,8,0)

"KRN",19,528,1,9,0)
Your search options vastly increase if you confine your search to
"KRN",19,528,1,10,0)
messages existing in one (or all) of your baskets.  Such a search
"KRN",19,528,1,11,0)
may be based upon any combination of the following:
"KRN",19,528,1,12,0)
 'Subject contains'
"KRN",19,528,1,13,0)
 'Sender is'
"KRN",19,528,1,14,0)
 'Message sent on or after' a certain date
"KRN",19,528,1,15,0)
 'Message sent on or before' a certain date
"KRN",19,528,1,16,0)
 'Message sent to' a certain user
"KRN",19,528,15)
D CHECKOUT^XM
"KRN",19,528,20)
D CHECKIN^XM
"KRN",19,528,25)
FIND^XMJMF
"KRN",19,528,"U")
QUERY/SEARCH FOR MESSAGES
"KRN",19,529,-1)
3^114
"KRN",19,529,0)
XMOTHER^Other MailMan Functions^^M^^^^^^^^MAILMAN^^
"KRN",19,529,1,0)
^19.06^1^1^2970730^^^^
"KRN",19,529,1,0,0,99999999)
^1^99999999
"KRN",19,529,1,0,"W")
75
"KRN",19,529,1,1,0)
This is the mailman option menu for special user activities.
"KRN",19,529,10,0)
^19.01PI^4^4
"KRN",19,529,10,1,0)
539^^1
"KRN",19,529,10,1,"^")
XMLATER-REPORT
"KRN",19,529,10,2,0)
540^^2
"KRN",19,529,10,2,"^")
XMLATER-EDIT
"KRN",19,529,10,3,0)
514^^3
"KRN",19,529,10,3,"^")
XMBASKLIST
"KRN",19,529,10,4,0)
501^LML^4
"KRN",19,529,10,4,"^")
XMPACK
"KRN",19,529,15)

"KRN",19,529,20)

"KRN",19,529,99)
58926,25775
"KRN",19,529,99.1)
54262,51324
"KRN",19,529,"U")
OTHER MAILMAN FUNCTIONS
"KRN",19,530,-1)
0^158
"KRN",19,530,0)
XMR-UCI-RCV^Receive Messages from Another UCI^^R^^^^^^^^MAILMAN^^
"KRN",19,530,1,0)
^19.06^18^18^3020509^^^^
"KRN",19,530,1,1,0)
This option is the converse to another called "SEND MESSAGES TO OTHER UCI".
"KRN",19,530,1,2,0)
The SEND side loads messages into the %ZISL(4.281 global.
"KRN",19,530,1,3,0)
The RECEIVE side reads messages from the %ZISL(4.281 global.
"KRN",19,530,1,4,0)
 
"KRN",19,530,1,5,0)
To use:
"KRN",19,530,1,6,0)
 
"KRN",19,530,1,7,0)
 1.  Log onto the UCI you wish to transmit message from.
"KRN",19,530,1,8,0)
 2.  Use the SEND option.  It will load all the messages for a particular
"KRN",19,530,1,9,0)
     domain into ^%ZISL(4.281.
"KRN",19,530,1,10,0)
 3.  Log onto the UCI you wish to receive the messages into.
"KRN",19,530,1,11,0)
 4.  Use this option.  It will read through the %ZISL(4.281 global looking
"KRN",19,530,1,12,0)
     for a message to receive (don't worry, it only checks the first line
"KRN",19,530,1,13,0)
     of each potential message/task) and creates a message for them.
"KRN",19,530,1,14,0)
 
"KRN",19,530,1,15,0)
Requirements:
"KRN",19,530,1,16,0)
 
"KRN",19,530,1,17,0)
 1.  The receive side needs to have been set up as a domain.
"KRN",19,530,1,18,0)
 2.  The %ZISL(4.281 global must be translated and accessible from both UCIs.
"KRN",19,530,25)
GLBIN^XMCB
"KRN",19,530,"U")
RECEIVE MESSAGES FROM ANOTHER 
"KRN",19,531,-1)
0^159
"KRN",19,531,0)
XMR-UCI-SEND^Send Messages to Another UCI^^R^^^^^^^^MAILMAN^^
"KRN",19,531,1,0)
^19.06^2^2^3020312^^
"KRN",19,531,1,1,0)
This option is the converse to one called "RECEIVE MESSAGES FROM ANOTHER UCI."
"KRN",19,531,1,2,0)
Please see the description of that option for further information.
"KRN",19,531,25)
GLBOUT^XMCB
"KRN",19,531,"U")
SEND MESSAGES TO ANOTHER UCI
"KRN",19,532,-1)
0^139
"KRN",19,532,0)
XMUT-REC-DELETE^Delete Found Messages from Found Messages List^^R^^^^^^^^^^
"KRN",19,532,1,0)
^^2^2^2890131^
"KRN",19,532,1,1,0)
This option deletes the temporary storage of a list of messages found 
"KRN",19,532,1,2,0)
when the "Find Messages for User" option was used by USER.
"KRN",19,532,25)
DEL^XMUT1A
"KRN",19,532,"U")
DELETE FOUND MESSAGES FROM FOU
"KRN",19,534,-1)
0^96
"KRN",19,534,0)
XMMGR-NEW-MAIL-BOX^Create a Mailbox for a user^^R^^^^^^^^MAILMAN^^^^
"KRN",19,534,1,0)
^^8^8^2970730^^^^
"KRN",19,534,1,1,0)
This option is meant to be used only on systems where Kernel 6 or later
"KRN",19,534,1,2,0)
is not running (or when a repair must be made to the 3.7 file).  A mailbox
"KRN",19,534,1,3,0)
is created for each new or reinstated user in Kernel 6 and there should be
"KRN",19,534,1,4,0)
no need to use this routine unless there was an error setting up the user
"KRN",19,534,1,5,0)
or there was a file degradation problem.  Using this option for a user whose
"KRN",19,534,1,6,0)
mailbox is partially or wholly set up will not cause data to be lost.
"KRN",19,534,1,7,0)
 
"KRN",19,534,1,8,0)
A MAILBOX may be CREATED or REPAIRED using this option.
"KRN",19,534,20)

"KRN",19,534,25)
NEWMBOX^XM
"KRN",19,534,"U")
CREATE A MAILBOX FOR A USER
"KRN",19,535,-1)
0^102
"KRN",19,535,0)
XMMGR-START-BACKGROUND-FILER^START background filer^^R^^^^^^^^MAILMAN^^^^
"KRN",19,535,1,0)
^^5^5^2980107^^^^
"KRN",19,535,1,1,0)
XMMGR-START-BACKGROUND-FILER reverses the action that was taken when the
"KRN",19,535,1,2,0)
option that is its mirror image (XMMGR-STOP-BACKGROUND-FILER) has been
"KRN",19,535,1,3,0)
run.  It also will restart the background filer if it disappears from the
"KRN",19,535,1,4,0)
system status report.  In order for this option to be effective, the Task
"KRN",19,535,1,5,0)
Manager (ZTM) must be running.
"KRN",19,535,15)

"KRN",19,535,20)

"KRN",19,535,25)
START^XMKPL
"KRN",19,535,99)
55010,54425
"KRN",19,535,"U")
START BACKGROUND FILER
"KRN",19,536,-1)
0^103
"KRN",19,536,0)
XMMGR-STOP-BACKGROUND-FILER^STOP background filer^^R^^^^^^^^MAILMAN^^^^
"KRN",19,536,1,0)
^^6^6^2980107^^
"KRN",19,536,1,1,0)
Use this option to STOP the background filer gently at the end of a delivery
"KRN",19,536,1,2,0)
before it starts to deliver any further messages.  This only stops local 
"KRN",19,536,1,3,0)
delivery operations.  ALL LOCAL MAIL DELIVERY WILL STOP until the
"KRN",19,536,1,4,0)
XMMGR-START-BACKGROUND-FILER option is run.
"KRN",19,536,1,5,0)
 
"KRN",19,536,1,6,0)
STOPS DELIVERY OF LOCAL MAIL GRACEFULLY !!
"KRN",19,536,15)

"KRN",19,536,20)

"KRN",19,536,25)
STOP^XMKPL
"KRN",19,536,99)
55010,54409
"KRN",19,536,"U")
STOP BACKGROUND FILER
"KRN",19,537,-1)
0^76
"KRN",19,537,0)
XMMGR-CHECK-BACKGROUND-FILER^CHECK background filer^^R^^^^^^^^^^
"KRN",19,537,1,0)
^^2^2^2891130^
"KRN",19,537,1,1,0)
This option tells you if the background filer is running and tells how many
"KRN",19,537,1,2,0)
recipients need delivery for each of the messages/responses in the queue.
"KRN",19,537,25)
CHECK^XMUT5
"KRN",19,537,99)
55381,48148
"KRN",19,537,"U")
CHECK BACKGROUND FILER
"KRN",19,538,-1)
0^127
"KRN",19,538,0)
XMPURGE-BY-DATE^Purge Messages by Origination Date^^R^^XMMGR^^^^^^MAILMAN^^
"KRN",19,538,1,0)
^19.06^60^60^3010514^^^^
"KRN",19,538,1,1,0)
You must hold the XMMGR and XMSTAR keys to run this option.
"KRN",19,538,1,2,0)
 
"KRN",19,538,1,3,0)
XMPURGE-BY-DATE will delete *all* messages originating before a cutoff
"KRN",19,538,1,4,0)
date. It will delete those messages from users' mailboxes, and then delete
"KRN",19,538,1,5,0)
them from the MESSAGE file, along with any responses chained to them. This
"KRN",19,538,1,6,0)
flexible option can be run interactively or scheduled to run on a
"KRN",19,538,1,7,0)
recurring basis, the cutoff date can be controlled, users may or may not
"KRN",19,538,1,8,0)
be sent a warning bulletin to warn them of the purge ahead of time, and
"KRN",19,538,1,9,0)
the option may produce a report to show how many messages and responses it
"KRN",19,538,1,10,0)
deleted.
"KRN",19,538,1,11,0)
 
"KRN",19,538,1,12,0)
When the option is run interactively:
"KRN",19,538,1,13,0)
 
"KRN",19,538,1,14,0)
1) It asks for the cutoff date. The default is based on the DATE PURGE
"KRN",19,538,1,15,0)
CUTOFF DAYS field (10.03) in the MAILMAN SITE PARAMETERS file (4.3). If
"KRN",19,538,1,16,0)
that field is null, it defaults to 730 days (2 years) in the past.
"KRN",19,538,1,17,0)
 
"KRN",19,538,1,18,0)
2) It asks whether to run the option in Test mode. In Test mode, the
"KRN",19,538,1,19,0)
option will not purge any messages, just report how many and which would
"KRN",19,538,1,20,0)
have been purged.
"KRN",19,538,1,21,0)
 
"KRN",19,538,1,22,0)
3) It asks for the output device on which to print the report. The purge
"KRN",19,538,1,23,0)
and report can be queued here to run later.
"KRN",19,538,1,24,0)
 
"KRN",19,538,1,25,0)
4) If it's queued more than 3 days in the future, the option immediately
"KRN",19,538,1,26,0)
broadcasts the XM DATE PURGE WARNING bulletin to all users to notify them
"KRN",19,538,1,27,0)
of the upcoming purge and give them a chance to save off old messages
"KRN",19,538,1,28,0)
beforehand.
"KRN",19,538,1,29,0)
 
"KRN",19,538,1,30,0)
5) If it's queued less than 3 days in the future, or is not queued, no
"KRN",19,538,1,31,0)
bulletin is sent.
"KRN",19,538,1,32,0)
 
"KRN",19,538,1,33,0)
When the option is scheduled:
"KRN",19,538,1,34,0)
 
"KRN",19,538,1,35,0)
1) The option runs at the scheduled time, as specified by the QUEUED TO
"KRN",19,538,1,36,0)
RUN AT WHAT TIME field (2) of the OPTION SCHEDULING file (19.2).
"KRN",19,538,1,37,0)
 
"KRN",19,538,1,38,0)
2) If the RESCHEDULING FREQUENCY field (6) of file 19.2 is set, the option
"KRN",19,538,1,39,0)
is scheduled to run repeatedly.
"KRN",19,538,1,40,0)
 
"KRN",19,538,1,41,0)
3) It uses the DATE PURGE CUTOFF DAYS field, or the default of 730 days if
"KRN",19,538,1,42,0)
it's empty, to calculate the cutoff date.
"KRN",19,538,1,43,0)
 
"KRN",19,538,1,44,0)
4) It does not run in Test mode.
"KRN",19,538,1,45,0)
 
"KRN",19,538,1,46,0)
5) If the DATE PURGE GRACE PERIOD field (10.04) of file 4.3 is empty, the
"KRN",19,538,1,47,0)
purge runs at the time for which the option is scheduled.
"KRN",19,538,1,48,0)
 
"KRN",19,538,1,49,0)
6) Otherwise, at the scheduled time the option only broadcasts the XM DATE
"KRN",19,538,1,50,0)
PURGE WARNING bulletin to all users and queues a second task to perform
"KRN",19,538,1,51,0)
the date purge GRACE PERIOD number of days later.
"KRN",19,538,1,52,0)
 
"KRN",19,538,1,53,0)
7) If the DEVICE FOR QUEUED JOB OUTPUT field (3) of file 19.2 is empty,
"KRN",19,538,1,54,0)
the purge runs without printing a report.
"KRN",19,538,1,55,0)
 
"KRN",19,538,1,56,0)
8) Otherwise it prints the report on the selected device.
"KRN",19,538,1,57,0)
 
"KRN",19,538,1,58,0)
*Messages in SHARED,MAIL's mailbox and messages in the POSTMASTER's
"KRN",19,538,1,59,0)
remote transmit queues and server baskets (including released patch
"KRN",19,538,1,60,0)
messages on FORUM) are exempt from the purge.
"KRN",19,538,25)
ENTER^XMA32
"KRN",19,538,200.9)
y
"KRN",19,538,"U")
PURGE MESSAGES BY ORIGINATION 
"KRN",19,539,-1)
0^66
"KRN",19,539,0)
XMLATER-REPORT^Report on Later'd Messages^^R^^^^^^^^MAILMAN^^
"KRN",19,539,1,0)
^^1^1^2970730^^^^
"KRN",19,539,1,1,0)
Prints/displays an overview of all of the user's later'd messages.
"KRN",19,539,25)
REPORT^XMJMD
"KRN",19,539,"U")
REPORT ON LATER'D MESSAGES
"KRN",19,540,-1)
0^169
"KRN",19,540,0)
XMLATER-EDIT^Change/Delete Later'd Messages^^R^^^^^^^^MAILMAN^^
"KRN",19,540,1,0)
^19.06^2^2^3020509^^^^
"KRN",19,540,1,1,0)
Enables the user to delete or change the date/time at which a message
"KRN",19,540,1,2,0)
is scheduled to become new.
"KRN",19,540,25)
EDIT^XMJMD
"KRN",19,540,"U")
CHANGE/DELETE LATER'D MESSAGES
"KRN",19,541,-1)
0^168
"KRN",19,541,0)
XMKSP^MailMan Site Parameters^^E^^^XM-I-S-SITE PARAMETERS^^^^^MAILMAN^^^
"KRN",19,541,1,0)
0^19.06^68^68^3020509^^^^
"KRN",19,541,1,1,0)
This option allows a site manager to edit the fields in the MailMan Site
"KRN",19,541,1,2,0)
Parameter file that do not have to do with christening.
"KRN",19,541,1,3,0)

"KRN",19,541,1,4,0)
(To christen a domain use the XMCHRIS option.  XMCHRIS also will allow you
"KRN",19,541,1,5,0)
to change fields set during the original christening if you set them wrong.)
"KRN",19,541,1,6,0)
 
"KRN",19,541,1,7,0)
Following are the fields which are edited, in the order in which they
"KRN",19,541,1,8,0)
are edited: 
"KRN",19,541,1,9,0)
 
"KRN",19,541,1,10,0)
 1         TIME ZONE (RP4.4'), [0;2]
"KRN",19,541,1,11,0)
 3         PARENT (P4.2'), [0;3]
"KRN",19,541,1,12,0)
 7         REQUIRE INTRODUCTIONS? (S), [0;6]
"KRN",19,541,1,13,0)
 5         SHOW INSTITUTION IN MAILMAN? (S), [0;5]
"KRN",19,541,1,14,0)
 7.3       SHOW DUZ WHEN ADDRESS MESSAGE (S), [0;8]
"KRN",19,541,1,15,0)
 7.4       SHOW ADDRESS ON USER LOOKUP (S), [0;10]
"KRN",19,541,1,16,0)
 5.1       MESSAGE ACTION DEFAULT (S), [0;15]
"KRN",19,541,1,17,0)
 21        FORWARD PRIORITY MAIL TO GROUP (S), [2;1]
"KRN",19,541,1,18,0)
 22        DROP OUT OF RESTRICTED GROUP (S), [2,2]
"KRN",19,541,1,19,0)
 23        TITLE SOURCE (S), [0;11]
"KRN",19,541,1,20,0)
 5.11      COPY LIMIT - RECIPIENTS (NJ5,0), [.11;1]
"KRN",19,541,1,21,0)
 5.12      COPY LIMIT - RESPONSES (NJ4,0), [.11;2]
"KRN",19,541,1,22,0)
 5.13      COPY LIMIT - LINES (NJ7,0), [.11;3]
"KRN",19,541,1,23,0)
 16.1      P-MESSAGE LINE LIMIT (NJ7,0), [.16;1]
"KRN",19,541,1,24,0)
 7.2       BIG GROUP SIZE (NJ5,0), [0;7]
"KRN",19,541,1,25,0)
 7.01      FWD TEST MESSAGE TO POSTMASTER (S), [FORWARD;1]
"KRN",19,541,1,26,0)
 143       FAX ENABLED (S), [0;19]
"KRN",19,541,1,27,0)
 8.14      LARGE MESSAGE REPORT LINES (NJ6,0), [XMUT2-LINES;1]
"KRN",19,541,1,28,0)
 50        LIMITED BROADCAST (Multiple-4.32), [5;0]
"KRN",19,541,1,29,0)
           .01  LIMITED BROADCAST (MF), [0;1]
"KRN",19,541,1,30,0)
           1    POINTED TO FILE (RP1'), [0;2]
"KRN",19,541,1,31,0)
           2    NEW PERSON FILE XREF (RF), [0;3]
"KRN",19,541,1,32,0)
 51        LIMITED BROADCAST DEFAULT (NJ3,0XO), [0;20]
"KRN",19,541,1,33,0)
 17.1      MAX DIGITS FOR MESSAGE NUMBER (NJ2,0), [.17;1]
"KRN",19,541,1,34,0)
 241       BACKGROUND MESSAGE DELIVERERS (FX), [6;1]
"KRN",19,541,1,35,0)
 242       BACKGROUND RESPONSE DELIVERERS (FX), [6;2]
"KRN",19,541,1,36,0)
 10.1      BACKGROUND FILER HANG TIME (NJ2,0), [0;13]
"KRN",19,541,1,37,0)
 10.2      BACKGROUND FILER RUN FLAG (S), [0;16]
"KRN",19,541,1,38,0)
 10.3      BACKGROUND FILER RUN PRIORITY (NJ2,0), [.13;1]
"KRN",19,541,1,39,0)
 7.5       CPU (UCI,VOL) FOR FILER TO RUN (F), [0;12]
"KRN",19,541,1,40,0)
 4.301     NO-PURGE DAYS BUFFER (NJ1,0), [.14;1]
"KRN",19,541,1,41,0)
 142       NO-PURGE DAYS BUFFER (LOCAL) (NJ2,0), [.14;2]
"KRN",19,541,1,42,0)
 4.303     AUTOMATIC INTEGRITY CHECK (S), [.12;1]
"KRN",19,541,1,43,0)
 4.304     WEEKDAY DAYS TO PURGE (NJ3,0), [NOTOPURGE;1]
"KRN",19,541,1,44,0)
 10        IN-BASKET-PURGE DAYS (NJ3,0), [0;9]
"KRN",19,541,1,45,0)
 10.01     IN-BASKET-PURGE TYPE (S), [.15;1]
"KRN",19,541,1,46,0)
 10.03     DATE PURGE CUTOFF DAYS (NJ4,0), [.18;1]
"KRN",19,541,1,47,0)
 10.04     DATE PURGE GRACE PERIOD (NJ2,0), [.18;2]
"KRN",19,541,1,48,0)
 8.3       NETWORK - MAX LINES SEND (NJ5,0), [NETWORK-LIMIT;1]
"KRN",19,541,1,49,0)
 8.31      NETWORK - MAX LINES RECEIVE (NJ8,0), [NETWORK-LIMIT;2]
"KRN",19,541,1,50,0)
 8.32      NETWORK - BLOCK SIZE RECEIVE (S), [NETWORK-LIMIT;3]
"KRN",19,541,1,51,0)
 8.12      TCP CHANNEL - MAXIMUM TO USE (NJ3,0), [0;17]
"KRN",19,541,1,52,0)
 8.15      TCP/IP POLLER RUN FLAG (S), [0;18]
"KRN",19,541,1,53,0)
 8.2       RECORD NETMAIL TRANSCRIPT? (S), [0;14]
"KRN",19,541,1,54,0)
 8.21      XMITS TILL ERROR MESSAGE (NJ3,0), [NETWORK;1]
"KRN",19,541,1,55,0)
 8.22      DNS AWARE (S), [NETWORK;2]
"KRN",19,541,1,56,0)
 8.23      TCP/IP COMMUNICATIONS PROTOCOL (P3.4'), [NETWORK;3]
"KRN",19,541,1,57,0)
 8.24      TCP/IP TRANSMISSION SCRIPT (P4.6'), [NETWORK;4]
"KRN",19,541,1,58,0)
 8.13      STATS NORMALIZATION (F), [7;1]
"KRN",19,541,1,59,0)
 8.4       DIRECTORY REQUEST FLAG (S), [8.4;1]
"KRN",19,541,1,60,0)
 7.6       FTP ADDRESS FOR BLOB <GET> (F), [FTP-GET;1]
"KRN",19,541,1,61,0)
 7.7       FTP RECEIVE DIRECTORY (F), [DISK/VOL;1]
"KRN",19,541,1,62,0)
 7.71      FTP RECEIVE NETWORK LOCATION (F), [FTPNETLOC;1]
"KRN",19,541,1,63,0)
 7.711     FTP RECEIVE DISK (F), [FTPRCVDISK;1]
"KRN",19,541,1,64,0)
 7.72      FTP ADDRESS FOR BLOB RECEIVE (F), [FTP-RCV;1]
"KRN",19,541,1,65,0)
 7.73      FTP USERNAME (F), [FTPUSER;1]
"KRN",19,541,1,66,0)
 7.731     FTP PASSWORD (F), [FTPPWD;1]
"KRN",19,541,1,67,0)
 7.7999    FTP NOTES (Multiple-4.37), [FTP-NOTES;0]
"KRN",19,541,1,68,0)
           .01  FTP NOTES (WL), [0;1]
"KRN",19,541,15)

"KRN",19,541,20)

"KRN",19,541,30)
XMB(1,
"KRN",19,541,31)
AEMNL
"KRN",19,541,34)
I Y=1
"KRN",19,541,50)
XMB(1,
"KRN",19,541,51)
1;3;7;5;7.3;7.4;5.1;21:29;5.11:5.13;16.1;7.2;7.01;143;8.14;50;51;17.1;241;242;10.1:10.3;7.5;4.301;142;4.303;4.304;10:10.09;8.3:8.32;8.12;8.15;8.2:8.29;8.13;8.4;7.6:7.8
"KRN",19,541,"U")
MAILMAN SITE PARAMETERS
"KRN",19,542,-1)
0^50
"KRN",19,542,0)
XMEDITDIST^Edit Distribution List^^E^^^^^^^^^^
"KRN",19,542,1,0)
^^14^14^2901102^^^
"KRN",19,542,1,1,0)
Distribution Lists may be entered as part of the delivery list for messages
"KRN",19,542,1,2,0)
in Mail Groups.  They consist of a name and a list of domains that are 
"KRN",19,542,1,3,0)
concatenated to the name for delivery of a message to multiple mail-boxes,
"KRN",19,542,1,4,0)
each of which have the same name that exist at different domains.
"KRN",19,542,1,5,0)

"KRN",19,542,1,6,0)
If the NAME is G.SUPPORT (It could be POSTMASTER.), and the domains are
"KRN",19,542,1,7,0)
FORUM.VA.GOV & ALTOONA.VA.GOV, the message will be send to:
"KRN",19,542,1,8,0)
 
"KRN",19,542,1,9,0)
     G.SUPPORT@FORUM.VA.GOV
"KRN",19,542,1,10,0)
and  G.SUPPORT@ALTOONA.VA.GOV
"KRN",19,542,1,11,0)
 
"KRN",19,542,1,12,0)
Each Distribution list may be added to more than one Mail Group.  Each Mail
"KRN",19,542,1,13,0)
Group may point at more than one Distribution List.
"KRN",19,542,1,14,0)

"KRN",19,542,30)
XMB(3.816,
"KRN",19,542,31)
AEMNL
"KRN",19,542,50)
XMB(3.816,
"KRN",19,542,51)
.01;1
"KRN",19,542,"U")
EDIT DISTRIBUTION LIST
"KRN",19,543,-1)
0^133
"KRN",19,543,0)
XMSHARE^Assume the Identity of SHARED,MAIL^^R^^^XM-U-I-SHARED MAIL^^^^^MAILMAN^^1^1^1^^
"KRN",19,543,1,0)
^^14^14^2970731^^^^
"KRN",19,543,1,1,0)
Use this option to assume the identity of a special user, 'SHARED,MAIL',
"KRN",19,543,1,2,0)
so that you may read mail send to the general public.  Users who own the
"KRN",19,543,1,3,0)
XMNOPRIV key may not do this.  SHARED,MAIL is a place to send messages of
"KRN",19,543,1,4,0)
general interest.  Almost all users may access this area.  You must
"KRN",19,543,1,5,0)
indicate a BASKET to deliver the messages to so that helps others find 
"KRN",19,543,1,6,0)
yours.
"KRN",19,543,1,7,0)

"KRN",19,543,1,8,0)
  Do not create new BASKETS unless it is really necessary.
"KRN",19,543,1,9,0)

"KRN",19,543,1,10,0)
Try to fit your message into a basket that already exists.  SHARED, MAIL
"KRN",19,543,1,11,0)
is a LIBRARY, NOT a repository for trivial or personal communications.
"KRN",19,543,1,12,0)
Please respect your privilege to be SHARED,MAIL surrogate.
"KRN",19,543,1,13,0)

"KRN",19,543,1,14,0)
The PRIVILEGE to be a SURROGATE of SHARED,MAIL may be taken away.
"KRN",19,543,3)
XMNOPRIV
"KRN",19,543,15)
D CHECKOUT^XM
"KRN",19,543,20)
D CHECKIN^XM
"KRN",19,543,25)
SHARE^XMVSURR
"KRN",19,543,99)
55054,48822
"KRN",19,543,"U")
ASSUME THE IDENTITY OF SHARED,
"KRN",19,544,-1)
0^174
"KRN",19,544,0)
XMQDOMAINS^Compare Domains in System Against Released List^^R^^^^^^^y^MAILMAN
"KRN",19,544,1,0)
^19.06^4^4^3020509^^^^
"KRN",19,544,1,1,0)
This option compares the domains in the DOMAIN file with the list of
"KRN",19,544,1,2,0)
domains in routine XMUDCHK, and generates a report of domains in
"KRN",19,544,1,3,0)
XMUDCHK which are not in the DOMAIN file.  Site managers should consider
"KRN",19,544,1,4,0)
whether the missing domains should be added to the DOMAIN file.
"KRN",19,544,25)
VALID8^XMUDCHK
"KRN",19,544,"U")
COMPARE DOMAINS IN SYSTEM AGAI
"KRN",19,545,-1)
0^15
"KRN",19,545,0)
XMS-SEQ-TRANSMIT^Sequential Media Queue Transmission^^R^^^^^^^^MAILMAN^^1^1
"KRN",19,545,1,0)
^19.06^20^20^3020312^^^^
"KRN",19,545,1,1,0)
This option allows the recording of a queue of messages onto sequential
"KRN",19,545,1,2,0)
media.  The messages so recorded may be 'read' into another MailMan system.
"KRN",19,545,1,3,0)
The option 'Sequential Media Message Reception' is the converse process.
"KRN",19,545,1,4,0)
 
"KRN",19,545,1,5,0)
This option has been developed specifically for emergency transmission of
"KRN",19,545,1,6,0)
messages when the wide area network is not available.  It can also be used
"KRN",19,545,1,7,0)
for archiving.
"KRN",19,545,1,8,0)
 
"KRN",19,545,1,9,0)
Say a bulldozer knocked out your T1 line to the WAN in front of your
"KRN",19,545,1,10,0)
computer room.  It will be three weeks until the system is reconnected to
"KRN",19,545,1,11,0)
the network.  You know that a sister installation 10 miles down the road is
"KRN",19,545,1,12,0)
still on line.  You must get your payroll information to Austin.  The
"KRN",19,545,1,13,0)
messages are ready to be sent (in the queue to FOC-AUSTIN.VA.GOV).  Quick!
"KRN",19,545,1,14,0)
Mount a tape.  Use this procedure to 'transmit' the queue onto the tape.
"KRN",19,545,1,15,0)
Have the tape delivered to your sister site (keeping it away from all
"KRN",19,545,1,16,0)
magnetic fields -- those messages are no longer in the queue).  At your
"KRN",19,545,1,17,0)
sister site the tape is delivered.  They mount it and read in the messages.
"KRN",19,545,1,18,0)
The messages are queued up for FOC-AUSTIN.VA.GOV and delivered as though
"KRN",19,545,1,19,0)
they were 'relayed' through this site.  You could also have sent the tape
"KRN",19,545,1,20,0)
directly to FOC-AUSTIN.VA.GOV where they could have been received.
"KRN",19,545,15)
D CHECKOUT^XM
"KRN",19,545,20)
D EN^XM
"KRN",19,545,25)
TAPEOUT^XMCB
"KRN",19,545,"U")
SEQUENTIAL MEDIA QUEUE TRANSMI
"KRN",19,546,-1)
0^12
"KRN",19,546,0)
XMR-SEQ-RECEIVE^Sequential Media Message Reception^^R^^^^^^^^MAILMAN^^1^1
"KRN",19,546,1,0)
^19.06^2^2^3020312^^^^
"KRN",19,546,1,1,0)
This is the converse procedure to XMS-SEQ-TRANSMIT.  Please refer to the
"KRN",19,546,1,2,0)
description of XMS-SEQ-TRANSMIT for more information.
"KRN",19,546,15)
D CHECKOUT^XM
"KRN",19,546,20)
D EN^XM
"KRN",19,546,25)
TAPEIN^XMCB
"KRN",19,546,"U")
SEQUENTIAL MEDIA MESSAGE RECEP
"KRN",19,547,-1)
0^51
"KRN",19,547,0)
XMEDITFWD^Forwarding Address Edit^^R^^^XM-U-P-FORWARDING ADDRESS^^^^^MAILMAN
"KRN",19,547,1,0)
^^1^1^2970730^^^
"KRN",19,547,1,1,0)
Enables the user to edit his forwarding address.
"KRN",19,547,25)
FORWARD^XMVVITA
"KRN",19,547,99)
54871,25646
"KRN",19,547,"U")
FORWARDING ADDRESS EDIT
"KRN",19,548,-1)
0^58
"KRN",19,548,0)
XMHELP-ON-LINE-USER_MANUAL^Manual for MailMan Users^^A^^^^^^^^MAILMAN^^1
"KRN",19,548,1,0)
^^1^1^2970730^^^^
"KRN",19,548,1,1,0)
Displays the MailMan on-line user manual.
"KRN",19,548,3.91,0)
^19.391^^0
"KRN",19,548,20)
S XQHFY="XMHELP-MANUAL" D ACTION^XQH4
"KRN",19,548,"U")
MANUAL FOR MAILMAN USERS
"KRN",19,549,-1)
3^69
"KRN",19,549,0)
XMMGR-BACKGROUND-FILER^Background Filer (XMAD)^^M^^^^^^^^
"KRN",19,549,1,0)
^^1^1^2970402^^^^
"KRN",19,549,1,1,0)
This option is a submenu of options for the background filer.
"KRN",19,549,10,0)
^19.01PI^4^4
"KRN",19,549,10,1,0)
535^
"KRN",19,549,10,1,"^")
XMMGR-START-BACKGROUND-FILER
"KRN",19,549,10,2,0)
536^
"KRN",19,549,10,2,"^")
XMMGR-STOP-BACKGROUND-FILER
"KRN",19,549,10,3,0)
537^
"KRN",19,549,10,3,"^")
XMMGR-CHECK-BACKGROUND-FILER
"KRN",19,549,10,4,0)
460^
"KRN",19,549,10,4,"^")
XMSTAT
"KRN",19,549,99)
57446,33622
"KRN",19,549,"U")
BACKGROUND FILER (XMAD)
"KRN",19,550,-1)
3^89
"KRN",19,550,0)
XMMGR-GROUP-MAINTENANCE^Group/Distribution Management^^M^^^^^^^^
"KRN",19,550,1,0)
^^1^1^2930627^^^^
"KRN",19,550,1,1,0)
This option is a submenu of Group/Distribution Management options.
"KRN",19,550,10,0)
^19.01PI^6^6
"KRN",19,550,10,1,0)
542^
"KRN",19,550,10,1,"^")
XMEDITDIST
"KRN",19,550,10,2,0)
503^
"KRN",19,550,10,2,"^")
XMENROLL
"KRN",19,550,10,3,0)
459^
"KRN",19,550,10,3,"^")
XMEDITMG
"KRN",19,550,10,4,0)
462^
"KRN",19,550,10,4,"^")
XMEDITBUL
"KRN",19,550,10,5,0)
575^
"KRN",19,550,10,5,"^")
XMMGR-MAIL-GRP-COORD-W/REMOTES
"KRN",19,550,10,6,0)
574^
"KRN",19,550,10,6,"^")
XMMGR-MAIL-GRP-COORDINATOR
"KRN",19,550,99)
58468,35439
"KRN",19,550,"U")
GROUP/DISTRIBUTION MANAGEMENT
"KRN",19,551,-1)
3^173
"KRN",19,551,0)
XMNET-QUEUE-MANAGEMENT^Queue Management^^M^^^^^^^^
"KRN",19,551,1,0)
^19.06^1^1^3020509^^^^
"KRN",19,551,1,1,0)
This option is a submenu for queue management.
"KRN",19,551,10,0)
^19.01PI^9^8
"KRN",19,551,10,1,0)
526^
"KRN",19,551,10,1,"^")
XMQACTIVE
"KRN",19,551,10,2,0)
525^
"KRN",19,551,10,2,"^")
XMQHIST
"KRN",19,551,10,3,0)
527^
"KRN",19,551,10,3,"^")
XMQUEUED
"KRN",19,551,10,4,0)
504^
"KRN",19,551,10,4,"^")
XMQDISP
"KRN",19,551,10,5,0)
520^
"KRN",19,551,10,5,"^")
XMSTARTQUE-ALL
"KRN",19,551,10,6,0)
508^
"KRN",19,551,10,6,"^")
XMQSHOW
"KRN",19,551,10,7,0)
510^
"KRN",19,551,10,7,"^")
XMSTARTQUE
"KRN",19,551,10,9,0)
495^
"KRN",19,551,10,9,"^")
XMLIST
"KRN",19,551,99)
58933,28865
"KRN",19,551,"U")
QUEUE MANAGEMENT
"KRN",19,552,-1)
3^109
"KRN",19,552,0)
XMNET-TRANSMISSION-MANAGEMENT^Transmission Management^^M^^^^^^^^
"KRN",19,552,1,0)
^^1^1^2931206^
"KRN",19,552,1,1,0)
This is a menu with options having to do with network transmissions.
"KRN",19,552,10,0)
^19.01PI^9^9
"KRN",19,552,10,1,0)
496^
"KRN",19,552,10,1,"^")
XMSCRIPTPLAY
"KRN",19,552,10,2,0)
494^
"KRN",19,552,10,2,"^")
XMSCRIPTEDIT
"KRN",19,552,10,3,0)
531^
"KRN",19,552,10,3,"^")
XMR-UCI-SEND
"KRN",19,552,10,4,0)
530^
"KRN",19,552,10,4,"^")
XMR-UCI-RCV
"KRN",19,552,10,5,0)
546^
"KRN",19,552,10,5,"^")
XMR-SEQ-RECEIVE
"KRN",19,552,10,6,0)
545^
"KRN",19,552,10,6,"^")
XMS-SEQ-TRANSMIT
"KRN",19,552,10,7,0)
507^
"KRN",19,552,10,7,"^")
XMSUBEDIT
"KRN",19,552,10,8,0)
576^
"KRN",19,552,10,8,"^")
XMEDIT-DOMAIN-VALIDATION#
"KRN",19,552,10,9,0)
594
"KRN",19,552,10,9,"^")
XMSCRIPTOUT
"KRN",19,552,99)
58933,30551
"KRN",19,552,"U")
TRANSMISSION MANAGEMENT
"KRN",19,553,-1)
3^95
"KRN",19,553,0)
XMMGR-MESSAGE-DELIVERY-MGT^Local Delivery Management^^M^^^^^^^^MAILMAN
"KRN",19,553,1,0)
^^1^1^2940214^^^^
"KRN",19,553,1,1,0)
This is a submenu of options for the background filer.
"KRN",19,553,10,0)
^19.01PI^14^12
"KRN",19,553,10,1,0)
537^
"KRN",19,553,10,1,"^")
XMMGR-CHECK-BACKGROUND-FILER
"KRN",19,553,10,2,0)
535^
"KRN",19,553,10,2,"^")
XMMGR-START-BACKGROUND-FILER
"KRN",19,553,10,3,0)
536^
"KRN",19,553,10,3,"^")
XMMGR-STOP-BACKGROUND-FILER
"KRN",19,553,10,5,0)
557^
"KRN",19,553,10,5,"^")
XMMGR-NEWMESS/LOGON-STATS
"KRN",19,553,10,6,0)
555^
"KRN",19,553,10,6,"^")
XMMGR-RESPONSE-TIME-COMPILER
"KRN",19,553,10,7,0)
556^
"KRN",19,553,10,7,"^")
XMMGR-RESPONSE-TIME-TOGGLER
"KRN",19,553,10,8,0)
558^
"KRN",19,553,10,8,"^")
XMMGR-BKFILER-ACT
"KRN",19,553,10,9,0)
559^
"KRN",19,553,10,9,"^")
XMMGR-BKFILER-EDIT-NORMALIZED
"KRN",19,553,10,10,0)
560^
"KRN",19,553,10,10,"^")
XMMGR-BKFILER-GROUP
"KRN",19,553,10,12,0)
561^
"KRN",19,553,10,12,"^")
XMMGR-BKFILER-STAT
"KRN",19,553,10,13,0)
562^
"KRN",19,553,10,13,"^")
XMMGR-BKFILER-TABBED-STATS
"KRN",19,553,10,14,0)
564^
"KRN",19,553,10,14,"^")
XMMGR-DELIVERY-STATS-COLL
"KRN",19,553,99)
57446,33622
"KRN",19,553,"U")
LOCAL DELIVERY MANAGEMENT
"KRN",19,554,-1)
3^88
"KRN",19,554,0)
XMMGR-DISK-SPACE-MANAGEMENT^Disk Space Management^^M^^^^^^^^MAILMAN
"KRN",19,554,1,0)
^19.06^2^2^3000906^^^^
"KRN",19,554,1,1,0)
 
"KRN",19,554,1,2,0)
This option is a submenu of disk space options.
"KRN",19,554,10,0)
^19.01PI^14^13
"KRN",19,554,10,1,0)
464^
"KRN",19,554,10,1,"^")
XMCLEAN
"KRN",19,554,10,2,0)
538^
"KRN",19,554,10,2,"^")
XMPURGE-BY-DATE
"KRN",19,554,10,4,0)
461^
"KRN",19,554,10,4,"^")
XMPURGE
"KRN",19,554,10,5,0)
513^
"KRN",19,554,10,5,"^")
XMUT-REC-MENU
"KRN",19,554,10,6,0)
524^
"KRN",19,554,10,6,"^")
XMMGR-IN-BASKET-PURGE
"KRN",19,554,10,7,0)
573^
"KRN",19,554,10,7,"^")
XMMGR-PURGE-AI-XREF
"KRN",19,554,10,8,0)
460^
"KRN",19,554,10,8,"^")
XMSTAT
"KRN",19,554,10,9,0)
577^
"KRN",19,554,10,9,"^")
XMMGR-LARGE-MESSAGE-REPORT
"KRN",19,554,10,10,0)
581^
"KRN",19,554,10,10,"^")
XMMGR-DISK-MANY-MESSAGE-MAINT
"KRN",19,554,10,11,0)
600
"KRN",19,554,10,11,"^")
XMMGR-TERMINATE-ONE
"KRN",19,554,10,12,0)
601
"KRN",19,554,10,12,"^")
XMMGR-TERMINATE-MANY
"KRN",19,554,10,13,0)
602
"KRN",19,554,10,13,"^")
XMMGR-TERMINATE-SUGGEST
"KRN",19,554,10,14,0)
603
"KRN",19,554,10,14,"^")
XMMGR-PURGE-MESSAGE
"KRN",19,554,99)
58933,28638
"KRN",19,554,"U")
DISK SPACE MANAGEMENT
"KRN",19,555,-1)
0^100
"KRN",19,555,0)
XMMGR-RESPONSE-TIME-COMPILER^Compile Response Time Statistics^^R^^^^^^^^MAILMAN
"KRN",19,555,1,0)
4^^4^4^2920926^
"KRN",19,555,1,1,0)
This option will be used as a background job scheduled every day
"KRN",19,555,1,2,0)
to collect statistics on the previous day's response time and put
"KRN",19,555,1,3,0)
the data into file 4.2998 .  It will then KILL off the associated
"KRN",19,555,1,4,0)
%ZRTL global nodes.
"KRN",19,555,25)
GO^XMUT5C
"KRN",19,555,"U")
COMPILE RESPONSE TIME STATISTI
"KRN",19,556,-1)
0^101
"KRN",19,556,0)
XMMGR-RESPONSE-TIME-TOGGLER^Log Response Time Toggler^^R^^^^^^^^MAILMAN
"KRN",19,556,1,0)
^^11^11^2920926^^^
"KRN",19,556,1,1,0)
This option will do the following:
"KRN",19,556,1,2,0)
 
"KRN",19,556,1,3,0)
1.  At a little after each half-hour, it will turn on the Kernel
"KRN",19,556,1,4,0)
Site Parameter for response time logging.
"KRN",19,556,1,5,0)
 
"KRN",19,556,1,6,0)
2.  It will then schedule another task to turn off the Kernel Site
"KRN",19,556,1,7,0)
Parameter for response time logging unless the time is between
"KRN",19,556,1,8,0)
4PM and 8AM .  During these hours, response time logging will remain
"KRN",19,556,1,9,0)
on unless site management interferes by canceling the tasks 
"KRN",19,556,1,10,0)
associated with this phenomenon and edits the LOG RESPONSE TIME
"KRN",19,556,1,11,0)
field for the appropriate VOLUME SET to be 'off' .
"KRN",19,556,25)
LOGON^XMUT5C
"KRN",19,556,99)
55472,33528
"KRN",19,556,"U")
LOG RESPONSE TIME TOGGLER
"KRN",19,557,-1)
0^97
"KRN",19,557,0)
XMMGR-NEWMESS/LOGON-STATS^New Messages and Logon Statistics^^R^^^^^^^^MAILMAN
"KRN",19,557,1,0)
^^2^2^2940407^^^^
"KRN",19,557,1,1,0)
This option prints the number of new messages created, logons, and
"KRN",19,557,1,2,0)
logon minutes for a specified time period.
"KRN",19,557,25)
STATS^XMUT5R1
"KRN",19,557,99)
55421,58724
"KRN",19,557,"U")
NEW MESSAGES AND LOGON STATIST
"KRN",19,558,-1)
0^70
"KRN",19,558,0)
XMMGR-BKFILER-ACT^Active Users/Deliveries Report^^R^^^^^^^^MAILMAN
"KRN",19,558,1,0)
^^3^3^2940423^^^
"KRN",19,558,1,1,0)
This report lists in 1/2 hours intervals (that is what is in the file)
"KRN",19,558,1,2,0)
active users and messages deliveries made.  The information comes from
"KRN",19,558,1,3,0)
file 4.2998 (Message Delivery Stats).
"KRN",19,558,25)
ACT^XMUT5R2
"KRN",19,558,"U")
ACTIVE USERS/DELIVERIES REPORT
"KRN",19,559,-1)
0^71
"KRN",19,559,0)
XMMGR-BKFILER-EDIT-NORMALIZED^Edit numbers to Normalize Reports^^R^^^^^^^^MAILMAN
"KRN",19,559,1,0)
^^1^1^2920926^
"KRN",19,559,1,1,0)
This option allows the user to customize the normalized report.
"KRN",19,559,25)
ASK^XMUT5R2
"KRN",19,559,"U")
EDIT NUMBERS TO NORMALIZE REPO
"KRN",19,560,-1)
0^72
"KRN",19,560,0)
XMMGR-BKFILER-GROUP^Deliveries by Group^^R^^^^^^^^MAILMAN
"KRN",19,560,1,0)
^^2^2^2920926^
"KRN",19,560,1,1,0)
This report lists in 1/2 hour intervals, deliveries made for each distinct 
"KRN",19,560,1,2,0)
delivery queue.
"KRN",19,560,25)
GROUP^XMUT5R2
"KRN",19,560,"U")
DELIVERIES BY GROUP
"KRN",19,561,-1)
0^73
"KRN",19,561,0)
XMMGR-BKFILER-STAT^Mail Delivery Statistics Report^^R^^^^^^^^MAILMAN
"KRN",19,561,1,0)
^^2^2^2920926^
"KRN",19,561,1,1,0)
This report list in 1/2 hour intervals:  active users, queue waits,
"KRN",19,561,1,2,0)
average response time, number of lines displayed to users...
"KRN",19,561,25)
STAT^XMUT5R2
"KRN",19,561,99)
55432,33299
"KRN",19,561,"U")
MAIL DELIVERY STATISTICS REPOR
"KRN",19,562,-1)
0^74
"KRN",19,562,0)
XMMGR-BKFILER-TABBED-STATS^Graphics Download (TAB separators)^^R^^^^^^^^MAILMAN
"KRN",19,562,1,0)
^^3^3^2930804^^^
"KRN",19,562,1,1,0)
This option can be used to capture a report and use the captured file in
"KRN",19,562,1,2,0)
EXCEL or other graphics packages.  The data has TABS between the fields
"KRN",19,562,1,3,0)
as delimiters.
"KRN",19,562,25)
TAB^XMUT5R2
"KRN",19,562,"U")
GRAPHICS DOWNLOAD (TAB SEPARAT
"KRN",19,563,-1)
0^75
"KRN",19,563,0)
XMMGR-BKFILER-WAIT^Delivery Queues Wait Report^^R^^^^^^^y^MAILMAN
"KRN",19,563,1,0)
^^4^4^2921006^^^
"KRN",19,563,1,1,0)
This report list in 1/2 hour intervals the seconds that the
"KRN",19,563,1,2,0)
oldest entry in a particular queue has been there (how long is
"KRN",19,563,1,3,0)
it taking to deliver messages).
"KRN",19,563,1,4,0)
 
"KRN",19,563,25)
WAIT^XMUT5R2
"KRN",19,563,"U")
DELIVERY QUEUES WAIT REPORT
"KRN",19,564,-1)
0^178
"KRN",19,564,0)
XMMGR-DELIVERY-STATS-COLL^Delivery Queue Statistics Collection^^R^^^^^^^^
"KRN",19,564,1,0)
^^6^6^2940225^^^^
"KRN",19,564,1,1,0)
This option collects delivery queue statistics.
"KRN",19,564,1,2,0)
 
"KRN",19,564,1,3,0)
Schedule option through TASKMAN, entering the initial time to start, (ie.
"KRN",19,564,1,4,0)
12:00 or 12:30). DO NOT enter data in the remainder of the fields, the
"KRN",19,564,1,5,0)
option will requeue itself automatically every Half Hour. All data
"KRN",19,564,1,6,0)
collected is stored in file 4.2998.
"KRN",19,564,25)
OPTION^XMUT5Q1
"KRN",19,564,99)
55432,53172
"KRN",19,564,200.9)
y
"KRN",19,564,"U")
DELIVERY QUEUE STATISTICS COLL
"KRN",19,565,-1)
0^61
"KRN",19,565,0)
XMHELPLNK^Remote User Information^^R^^^^^^^^MAILMAN
"KRN",19,565,1,0)
^^1^1^2970730^^^^
"KRN",19,565,1,1,0)
Enables the user to inquire into the REMOTE USER file.
"KRN",19,565,25)
R^XMJMT
"KRN",19,565,99)
55595,47727
"KRN",19,565,"U")
REMOTE USER INFORMATION
"KRN",19,566,-1)
0^39
"KRN",19,566,0)
XMBLOBSEND^Send Multimedia Message^MailMan is no longer used to send IMAGING files.^R^^XMBLOB^XM-U-M-SEND^^^^^^^1^1
"KRN",19,566,1,0)
^19.06^4^4^2940425^^^^
"KRN",19,566,1,1,0)
This option is used to send MailMan multimedia messages.  Messages may be
"KRN",19,566,1,2,0)
sent to other users or groups of users.  The sender of the message may
"KRN",19,566,1,3,0)
request a confirmation message, to be sent to him when each recipient
"KRN",19,566,1,4,0)
reads the message.
"KRN",19,566,15)
D UNLOCK^XM K XMMENU
"KRN",19,566,20)
K XMLOAD,XMDF S XMMENU(0)="XMUSER" D LOCK^XM
"KRN",19,566,25)
BLOB^XMA2B
"KRN",19,566,99)
53272,53151
"KRN",19,566,"U")
SEND MULTIMEDIA MESSAGE
"KRN",19,567,-1)
0^84
"KRN",19,567,0)
XMMGR-DIRECTORY-SEND^Send a Directory to requesting site^^S^^^^^^^^MAILMAN
"KRN",19,567,1,0)
^^1^1^2940201^^
"KRN",19,567,1,1,0)
This option is a server that sends a directory to a requesting site.
"KRN",19,567,25)
SEND^XMDIRSND
"KRN",19,567,99)
55588,55846
"KRN",19,567,220)
^R^^Y^Y^R
"KRN",19,567,"U")
SEND A DIRECTORY TO REQUESTING
"KRN",19,568,-1)
0^83
"KRN",19,568,0)
XMMGR-DIRECTORY-RECV^RECEIVE E-MAIL DIRECTORY FROM OTHER SITE^^S^^^^^^^^MAILMAN^^
"KRN",19,568,1,0)
^^2^2^2940404^^
"KRN",19,568,1,1,0)
This option is a server that receives a directory from another domain and
"KRN",19,568,1,2,0)
puts the entries into the Remote User file.
"KRN",19,568,20)

"KRN",19,568,25)
RECEIVE^XMDIRRCV
"KRN",19,568,220)
^R^^^^R
"KRN",19,568,"U")
RECEIVE E-MAIL DIRECTORY FROM 
"KRN",19,569,-1)
0^85
"KRN",19,569,0)
XMMGR-DIRECTORY-SINGLE^Request Mail Directory From a Single Domain Server^^R^^^^^^^y^MAILMAN
"KRN",19,569,1,0)
^^2^2^2930823^
"KRN",19,569,1,1,0)
This option schedules a task to run in background to update the MailLink
"KRN",19,569,1,2,0)
directory ^XMD(4.2997) from a single domain server.
"KRN",19,569,25)
SINGLE^XMDIRQST
"KRN",19,569,"U")
REQUEST MAIL DIRECTORY FROM A 
"KRN",19,570,-1)
0^80
"KRN",19,570,0)
XMMGR-DIRECTORY-GROUP^Group eMail Directory Request^^R^^^^^^^^MAILMAN
"KRN",19,570,1,0)
^^2^2^2940201^^^
"KRN",19,570,1,1,0)
This option allows site management to request directories from all the
"KRN",19,570,1,2,0)
domains in a group of domains as defined in XMMGR-DIRECTORY-EDITGRP.
"KRN",19,570,25)
GROUP^XMDIRQST
"KRN",19,570,"U")
GROUP EMAIL DIRECTORY REQUEST
"KRN",19,571,-1)
0^81
"KRN",19,571,0)
XMMGR-DIRECTORY-LISTGRP^List eMail Directory Request by Groups^^R^^^^^^^^MAILMAN
"KRN",19,571,1,0)
^^2^2^2940201^^
"KRN",19,571,1,1,0)
This option allows the site manager to list groups created by
"KRN",19,571,1,2,0)
XMMGR-DIRECTORY-EDITGRP.
"KRN",19,571,25)
LISTGRP^XMDIRQST
"KRN",19,571,"U")
LIST EMAIL DIRECTORY REQUEST B
"KRN",19,572,-1)
0^79
"KRN",19,572,0)
XMMGR-DIRECTORY-EDITGRP^Enter/Edit Directory Request Flags by Group^^R^^^^^^^^
"KRN",19,572,1,0)
^^2^2^2940223^^^^
"KRN",19,572,1,1,0)
This option allow the site management to control groups of domains
"KRN",19,572,1,2,0)
from which directories are requested.
"KRN",19,572,25)
EDIT^XMDIRQST
"KRN",19,572,"U")
ENTER/EDIT DIRECTORY REQUEST F
"KRN",19,573,-1)
0^98
"KRN",19,573,0)
XMMGR-PURGE-AI-XREF^AI x-Ref Purge of Received Network Messages^^R^^^^^^^^MAILMAN
"KRN",19,573,1,0)
^^5^5^2930615^
"KRN",19,573,1,1,0)
This option maintains the "AI" cross reference of mail messages.
"KRN",19,573,1,2,0)
This is the cross reference of messages received across the network
"KRN",19,573,1,3,0)
and it prevents duplicate messages from being received again.  The
"KRN",19,573,1,4,0)
default number of days kept is 730 (about 2 years == the amount of
"KRN",19,573,1,5,0)
days messages can exist before being purged on FORUM).
"KRN",19,573,25)
PURGE^XMUTPUR0
"KRN",19,573,200.9)
y
"KRN",19,573,"U")
AI X-REF PURGE OF RECEIVED NET
"KRN",19,574,-1)
0^94
"KRN",19,574,0)
XMMGR-MAIL-GRP-COORDINATOR^Mail Group Coordinator's Edit^^R^^^^^^^^MAILMAN
"KRN",19,574,1,0)
^^6^6^2980519^^^^
"KRN",19,574,1,1,0)
This option allows a mail group coordinator to edit the mail groups that
"KRN",19,574,1,2,0)
he or she is the coordinator of (and no others).  It does not allow edit of
"KRN",19,574,1,3,0)
remote recipients.
"KRN",19,574,1,4,0)
 
"KRN",19,574,1,5,0)
Some mail group coordinators might be given the corresponding option,
"KRN",19,574,1,6,0)
XMMGR-MAIL-GRP-COORD-W/REMOTE.
"KRN",19,574,25)
LCOORD^XMVGROUP
"KRN",19,574,"U")
MAIL GROUP COORDINATOR'S EDIT
"KRN",19,575,-1)
0^93
"KRN",19,575,0)
XMMGR-MAIL-GRP-COORD-W/REMOTES^Mail Group Coordinator's Edit W/Remotes^^R^^^^^^^^MAILMAN
"KRN",19,575,1,0)
^^8^8^2971007^^^^
"KRN",19,575,1,1,0)
This option allows a mail group coordinator to edit the mail groups that
"KRN",19,575,1,2,0)
he or she is the coordinator of (and no others).  It allows edit of
"KRN",19,575,1,3,0)
remote recipients.
"KRN",19,575,1,4,0)
 
"KRN",19,575,1,5,0)
Most mail group coordinators should be given the corresponding option,
"KRN",19,575,1,6,0)
XMMGR-MAIL-GRP-COORDINATOR that does not allow them to edit remote
"KRN",19,575,1,7,0)
recipients in the mail group to limit the responsibility for problems
"KRN",19,575,1,8,0)
delivering to incorrect addresses.
"KRN",19,575,25)
RCOORD^XMVGROUP
"KRN",19,575,"U")
MAIL GROUP COORDINATOR'S EDIT 
"KRN",19,576,-1)
0^4
"KRN",19,576,0)
XMEDIT-DOMAIN-VALIDATION#^Validation Number Edit^^R^^^^^^^^MAILMAN
"KRN",19,576,1,0)
^^5^5^2930729^
"KRN",19,576,1,1,0)
This option allows sites to edit the validation numbers so that they can be
"KRN",19,576,1,2,0)
synchronized.  The sender and the receiver must edit the numbers concurrently. 
"KRN",19,576,1,3,0)
At S1.VA.GOV they edit S2.VA.GOV's validation number.  At S2.VA.GOV they edit
"KRN",19,576,1,4,0)
S1.VA.GOV's validation number.  The same number is used for input at both
"KRN",19,576,1,5,0)
sites.  
"KRN",19,576,25)
VAL^XMCE
"KRN",19,576,"U")
VALIDATION NUMBER EDIT
"KRN",19,577,-1)
0^170
"KRN",19,577,0)
XMMGR-LARGE-MESSAGE-REPORT^Large Message Report^^R^^^^^^^^MAILMAN^^
"KRN",19,577,1,0)
^19.06^4^4^3020509^^^^
"KRN",19,577,1,1,0)
This report lists messages that either are longer than a specified
"KRN",19,577,1,2,0)
number of lines (see field 8.14 in the MailMan Site Parameters - file 4.3),
"KRN",19,577,1,3,0)
or which have either no or only one owner, or no text,
"KRN",19,577,1,4,0)
or no subject, as such messages are of interest to site management.
"KRN",19,577,20)

"KRN",19,577,25)
ENTER^XMUT2
"KRN",19,577,200.9)
y
"KRN",19,577,"U")
LARGE MESSAGE REPORT
"KRN",19,578,-1)
0^78
"KRN",19,578,0)
XMMGR-DIRECTORY-ALL^Remote Directory from all Domains^^R^^^^^^^^MAILMAN
"KRN",19,578,1,0)
^^3^3^2930823^
"KRN",19,578,1,1,0)
This option schedules tasks to run in background to update MailLink
"KRN",19,578,1,2,0)
directory ^XMD(4.2997).  Use this option cautiously because it sends
"KRN",19,578,1,3,0)
requests to all the Domains for soliciting remote user directories.
"KRN",19,578,25)
ALL^XMDIRQST
"KRN",19,578,"U")
REMOTE DIRECTORY FROM ALL DOMA
"KRN",19,579,-1)
0^86
"KRN",19,579,0)
XMMGR-DIRECTORY-VACO^Load Remote VACO (Wang/Noava) Directory^^R^^^^^^^^MAILMAN
"KRN",19,579,1,0)
^^4^4^2930823^
"KRN",19,579,1,1,0)
 
"KRN",19,579,1,2,0)
This option will load a file from Host File Server.  User has choice
"KRN",19,579,1,3,0)
whether to run this task interactively or schedule a batch job to
"KRN",19,579,1,4,0)
update the MailLink directory.
"KRN",19,579,25)
OPTION^XMDIR1
"KRN",19,579,"U")
LOAD REMOTE VACO (WANG/NOAVA) 
"KRN",19,580,-1)
3^82
"KRN",19,580,0)
XMMGR-DIRECTORY-MAIN^Remote MailLink Directory Menu^^M^^XMMGR^^^^^^MAILMAN
"KRN",19,580,1,0)
^^4^4^2940201^^^
"KRN",19,580,1,1,0)
 
"KRN",19,580,1,2,0)
This option allows the site manager to manage the remote MailLink
"KRN",19,580,1,3,0)
Directory, by loading WANG/NOAVA directory and remote domain
"KRN",19,580,1,4,0)
user directory into remote user file ^XMD(4.2997).
"KRN",19,580,10,0)
^19.01PI^7^7
"KRN",19,580,10,1,0)
572^
"KRN",19,580,10,1,"^")
XMMGR-DIRECTORY-EDITGRP
"KRN",19,580,10,2,0)
570^
"KRN",19,580,10,2,"^")
XMMGR-DIRECTORY-GROUP
"KRN",19,580,10,3,0)
571^
"KRN",19,580,10,3,"^")
XMMGR-DIRECTORY-LISTGRP
"KRN",19,580,10,4,0)
569^
"KRN",19,580,10,4,"^")
XMMGR-DIRECTORY-SINGLE
"KRN",19,580,10,5,0)
579^
"KRN",19,580,10,5,"^")
XMMGR-DIRECTORY-VACO
"KRN",19,580,10,6,0)
578^
"KRN",19,580,10,6,"^")
XMMGR-DIRECTORY-ALL
"KRN",19,580,10,7,0)
584^
"KRN",19,580,10,7,"^")
XMEDIT-REMOTE-USER
"KRN",19,580,99)
56579,51877
"KRN",19,580,"U")
REMOTE MAILLINK DIRECTORY MENU
"KRN",19,581,-1)
0^87
"KRN",19,581,0)
XMMGR-DISK-MANY-MESSAGE-MAINT^Ask users with many messages to do maintenance^^R^^^^^^^^MAILMAN
"KRN",19,581,1,0)
^^2^2^2971003^^^
"KRN",19,581,1,1,0)
This option sends messages asking users to clean out mail boxes if
"KRN",19,581,1,2,0)
they have too many messages.
"KRN",19,581,25)
ENTER^XMAI2
"KRN",19,581,200.9)
y
"KRN",19,581,"U")
ASK USERS WITH MANY MESSAGES T
"KRN",19,582,-1)
0^111
"KRN",19,582,0)
XMNET-TWIX-TRANSMIT^Transmit TWIX's^^R^^^^^^^^MAILMAN
"KRN",19,582,1,0)
^^2^2^2931205^
"KRN",19,582,1,1,0)
This option can be run interactively or scheduled as a task to run in
"KRN",19,582,1,2,0)
background to transmit TWIXs (PCTS messages).
"KRN",19,582,25)
RQ^XMRPCTS0
"KRN",19,582,"U")
TRANSMIT TWIX'S
"KRN",19,583,-1)
0^110
"KRN",19,583,0)
XMNET-TWIX-SEND^Send a TWIX via PCTS^^R^^^^^^^^MAILMAN
"KRN",19,583,1,0)
^^2^2^2931205^
"KRN",19,583,1,1,0)
This option is to be used to send messages formatted especially as
"KRN",19,583,1,2,0)
TWIXs to be sent via the PCTS system.
"KRN",19,583,25)
PCTS^XMRPCTS
"KRN",19,583,"U")
SEND A TWIX VIA PCTS
"KRN",19,584,-1)
0^166
"KRN",19,584,0)
XMEDIT-REMOTE-USER^Enter/Edit Remote User^^R^^^^^^^^MAILMAN
"KRN",19,584,1,0)
^19.06^2^2^3020509^^
"KRN",19,584,1,1,0)
This option allows a person's remote address to be put into the
"KRN",19,584,1,2,0)
Remote User Directory so messages can be automatically addressed to him.
"KRN",19,584,25)
REMOTES^XMDIR1B
"KRN",19,584,"U")
ENTER/EDIT REMOTE USER
"KRN",19,585,-1)
0^164
"KRN",19,585,0)
XM-FTP-GET^Get (Retrieve) File from Remote System^^R^^^^^^^^MAILMAN
"KRN",19,585,1,0)
^19.06^5^5^3020509^^^
"KRN",19,585,1,1,0)
This option allows a user to GET a file from another system using
"KRN",19,585,1,2,0)
the FTP protocol.  The user supplies all the information about where
"KRN",19,585,1,3,0)
the file is and MailMan creates a file that when executed will do the
"KRN",19,585,1,4,0)
retrieval.  The actual process of getting the file is handled in
"KRN",19,585,1,5,0)
the background.  See XM-FTP-PUT.
"KRN",19,585,25)
GET^XMAFTP
"KRN",19,585,"U")
GET (RETRIEVE) FILE FROM REMOT
"KRN",19,586,-1)
0^165
"KRN",19,586,0)
XM-FTP-PUT^Send (Put) File to Remote Location^^R^^^^^^^^MAILMAN
"KRN",19,586,1,0)
^19.06^5^5^3020509^^^^
"KRN",19,586,1,1,0)
This option allows a user to PUT a file on another system using
"KRN",19,586,1,2,0)
the FTP protocol.  The user supplies all the information about where
"KRN",19,586,1,3,0)
the file should go and MailMan creates a file that when executed will
"KRN",19,586,1,4,0)
do the sending.  The actual process of putting the file is handled in
"KRN",19,586,1,5,0)
the background.  See XM-FTP-GET.
"KRN",19,586,25)
PUT^XMAFTP
"KRN",19,586,"U")
SEND (PUT) FILE TO REMOTE LOCA
"KRN",19,587,-1)
3^115
"KRN",19,587,0)
XMOTHER-COMMUNICATIONS^Communications^^M^^XMNET^^^^^^MAILMAN
"KRN",19,587,1,0)
^^3^3^2940222^^
"KRN",19,587,1,1,0)
This menu contains options that allow users to send and receive data that
"KRN",19,587,1,2,0)
is not necessarily in an electronic mail message form.  FTP options to get
"KRN",19,587,1,3,0)
and put files are here.
"KRN",19,587,10,0)
^19.01PI^2^2
"KRN",19,587,10,1,0)
585^GET
"KRN",19,587,10,1,"^")
XM-FTP-GET
"KRN",19,587,10,2,0)
586^PUT
"KRN",19,587,10,2,"^")
XM-FTP-PUT
"KRN",19,587,99)
58933,48245
"KRN",19,587,"U")
COMMUNICATIONS
"KRN",19,588,-1)
0^128
"KRN",19,588,0)
XMR-BROADCAST-VA-WIDE^Server / not for a menu^^S^^^^^^^^MAILMAN
"KRN",19,588,1,0)
^^12^12^2971003^^^^
"KRN",19,588,1,1,0)
This option is set up as a server.  When a message is addressed to
"KRN",19,588,1,2,0)
this server (S.XMR-BROADCAST-VA-WIDE), It runs routine ENT^XMGAPI3
"KRN",19,588,1,3,0)
to send the message to SHARED,MAIL.
"KRN",19,588,1,4,0)

"KRN",19,588,1,5,0)
The message is marked 'closed' (may not forward) and
"KRN",19,588,1,6,0)
'information only' (may not reply).
"KRN",19,588,1,7,0)

"KRN",19,588,1,8,0)
The message is marked with a vaporization date of 30 days from
"KRN",19,588,1,9,0)
date of receipt.
"KRN",19,588,1,10,0)

"KRN",19,588,1,11,0)
Note that server XMYB-BROADCAST-VA-WIDE is similar to this one, except
"KRN",19,588,1,12,0)
that it sends the message to all users.
"KRN",19,588,25)
ENT^XMGAPI3(.6)
"KRN",19,588,220)
XQSERVER^R^^N^Y^N
"KRN",19,588,"U")
SERVER / NOT FOR A MENU
"KRN",19,589,-1)
0^136
"KRN",19,589,0)
XMSUGGESTION^Suggestion Box^^R^^^^^^^^MAILMAN
"KRN",19,589,1,0)
^^11^11^2970730^^
"KRN",19,589,1,1,0)
Enables a user to send an anonymous message to the SUGGESTION BOX basket
"KRN",19,589,1,2,0)
of SHARED,MAIL.  If the basket does not exist, it will be created.
"KRN",19,589,1,3,0)

"KRN",19,589,1,4,0)
MailMan carefully fails to record the actual identity of the sender.
"KRN",19,589,1,5,0)

"KRN",19,589,1,6,0)
The option allows users to voice complaints and concerns anonymously.  
"KRN",19,589,1,7,0)
 
"KRN",19,589,1,8,0)
To use it, put the XMSUGGESTION option onto the appropriate menu.
"KRN",19,589,1,9,0)

"KRN",19,589,1,10,0)
To stop a particular user from using it, put a 'Reverse/negative Lock'
"KRN",19,589,1,11,0)
onto the XMSUGGESTION option and assign that key to the user.
"KRN",19,589,25)
SEND^XMJMSA
"KRN",19,589,"U")
SUGGESTION BOX
"KRN",19,590,-1)
0^144
"KRN",19,590,0)
XMYB-BROADCAST-VA-WIDE^Server / not for a menu^^S^^XMMGR^^^^^^MAILMAN
"KRN",19,590,1,0)
^^12^12^2971003^^^^
"KRN",19,590,1,1,0)
This option is set up as a server.  When a message is addressed to this
"KRN",19,590,1,2,0)
server (S.XMYB-BROADCAST-VA-WIDE), it runs routine ENT^XMGAPI3 to send
"KRN",19,590,1,3,0)
the message to all users.
"KRN",19,590,1,4,0)

"KRN",19,590,1,5,0)
The message is marked 'closed' (may not forward) and
"KRN",19,590,1,6,0)
'information only' (may not reply).
"KRN",19,590,1,7,0)

"KRN",19,590,1,8,0)
The message is marked with a vaporization date of 7 days from the date
"KRN",19,590,1,9,0)
of receipt.
"KRN",19,590,1,10,0)

"KRN",19,590,1,11,0)
Note that server XMR-BROADCAST-VA-WIDE is similar to this one, except
"KRN",19,590,1,12,0)
that it sends the message to SHARED,MAIL.
"KRN",19,590,25)
ENT^XMGAPI3("*")
"KRN",19,590,220)
^R^^N^Y^N
"KRN",19,590,"U")
SERVER / NOT FOR A MENU
"KRN",19,594,-1)
0^17
"KRN",19,594,0)
XMSCRIPTOUT^Toggle a script out of service^^R^^^^^^^^MAILMAN
"KRN",19,594,1,0)
^19.06^3^3^3020312^^^^
"KRN",19,594,1,1,0)
This options lets you edit the OUT OF SERVICE field for a Transmission
"KRN",19,594,1,2,0)
Script in the Domain file. You can also requeue the Domain for transmission
"KRN",19,594,1,3,0)
from this option.
"KRN",19,594,25)
OUT^XMCE
"KRN",19,594,"U")
TOGGLE A SCRIPT OUT OF SERVICE
"KRN",19,599,-1)
0^130
"KRN",19,599,0)
XMRONT^Start XMRONT TCP Listener^^R^^^^^^^^MAILMAN
"KRN",19,599,1,0)
^^6^6^2980428^^^^
"KRN",19,599,1,1,0)
This is the TCP/IP Listener for MailMan. This option should NOT be on
"KRN",19,599,1,2,0)
any Menu and should NOT be run directly. It must be scheduled to start
"KRN",19,599,1,3,0)
every time the system is rebooted. You can schedule this option by using
"KRN",19,599,1,4,0)
the 'Schedule/Unschedule Options' option under the 'Taskman Management'
"KRN",19,599,1,5,0)
menu. You must specify the option XMRONT and then enter 'STARTUP' in the
"KRN",19,599,1,6,0)
SPECIAL QUEUING field.
"KRN",19,599,25)
GO^XMRONT
"KRN",19,599,200.9)
y
"KRN",19,599,"U")
START XMRONT TCP LISTENER
"KRN",19,600,-1)
0^172
"KRN",19,600,0)
XMMGR-TERMINATE-ONE^Terminate one mail user^^R^^^^^^^^MAILMAN
"KRN",19,600,1,0)
^19.06^18^18^3020509^^^^
"KRN",19,600,1,1,0)
This option lets you remove the mailbox of any user who meets the criteria of
"KRN",19,600,1,2,0)
either the XMMGR-TERMINATE-MANY option or the XMMGR-TERMINATE-SUGGEST option. 
"KRN",19,600,1,3,0)

"KRN",19,600,1,4,0)
Remove means:
"KRN",19,600,1,5,0)
 - Delete user's private mail groups
"KRN",19,600,1,6,0)
 - Remove user from membership in all groups
"KRN",19,600,1,7,0)
 - Remove user as an authorized sender from all groups
"KRN",19,600,1,8,0)
 - Remove user from anyone's list of surrogates
"KRN",19,600,1,9,0)
 - Delete user's latered-messages list
"KRN",19,600,1,10,0)
 - Delete user's mail box
"KRN",19,600,1,11,0)

"KRN",19,600,1,12,0)
As a result, the user will not receive any mail.
"KRN",19,600,1,13,0)

"KRN",19,600,1,14,0)
Remember,
"KRN",19,600,1,15,0)
 - Whenever you give a user a new access code, the system gives the user a
"KRN",19,600,1,16,0)
mailbox if he doesn't already have one. 
"KRN",19,600,1,17,0)
 - Whenever a user logs on, the system gives the user a mailbox if he doesn't
"KRN",19,600,1,18,0)
already have one. 
"KRN",19,600,25)
CHOOSE^XMUTERM
"KRN",19,600,"U")
TERMINATE ONE MAIL USER
"KRN",19,601,-1)
0^104
"KRN",19,601,0)
XMMGR-TERMINATE-MANY^Terminate many mail users^^R^^^^^^^^MAILMAN
"KRN",19,601,1,0)
^19.06^39^39^3010731^^^^
"KRN",19,601,1,1,0)
This option goes through the MAIL BOX global and removes any mailbox if
"KRN",19,601,1,2,0)
 - the user is not in the NEW PERSON file.
"KRN",19,601,1,3,0)
 - the user has no access code and was not terminated.
"KRN",19,601,1,4,0)
 - the user has no access code and was terminated w/o mailbox retention.
"KRN",19,601,1,5,0)
 - the user has an access code, but no primary menu.
"KRN",19,601,1,6,0)
 - the user has an access code and primary menu, but no verify code, AND
"KRN",19,601,1,7,0)
   - has never signed on or used mail, since being added before a cutoff date.
"KRN",19,601,1,8,0)
   OR
"KRN",19,601,1,9,0)
   - last signed on or used mail before a cutoff date.
"KRN",19,601,1,10,0)

"KRN",19,601,1,11,0)
However, if the user meets one of the last two conditions above, but has
"KRN",19,601,1,12,0)
a forwarding address, the user's mailbox will not be removed.  The fact
"KRN",19,601,1,13,0)
will be noted on the report, and the user should be investigated further.
"KRN",19,601,1,14,0)

"KRN",19,601,1,15,0)
Remove means:
"KRN",19,601,1,16,0)
 - Delete user's private mail groups
"KRN",19,601,1,17,0)
 - Remove user from membership in all groups
"KRN",19,601,1,18,0)
 - Remove user as an authorized sender from all groups
"KRN",19,601,1,19,0)
 - Remove user from anyone's list of surrogates
"KRN",19,601,1,20,0)
 - Delete user's latered-messages list
"KRN",19,601,1,21,0)
 - Delete user's mail box
"KRN",19,601,1,22,0)

"KRN",19,601,1,23,0)
As a result, the user will not receive any mail.
"KRN",19,601,1,24,0)

"KRN",19,601,1,25,0)
This option can be run in 'test' or 'real' mode.
"KRN",19,601,1,26,0)

"KRN",19,601,1,27,0)
The report lists, in DUZ order:
"KRN",19,601,1,28,0)
 - The user's DUZ and name
"KRN",19,601,1,29,0)
 - Whether the user has an access code, verify code, and primary menu
"KRN",19,601,1,30,0)
 - When the user was added to the NEW PERSON file
"KRN",19,601,1,31,0)
 - When the user last signed on or used mail
"KRN",19,601,1,32,0)
 - When the user was terminated (if applicable)
"KRN",19,601,1,33,0)
 - If the user was terminated, then whether the site manager chose to
"KRN",19,601,1,34,0)
   delete the user's mailbox.  (It's generally a good idea to go ahead
"KRN",19,601,1,35,0)
   and delete the mailbox upon termination.)
"KRN",19,601,1,36,0)
 - If the user has an access code and a forwarding address, the user
"KRN",19,601,1,37,0)
   is marked with '***', and the forwarding address is shown.
"KRN",19,601,1,38,0)
   (Again, the mailbox is not deleted in this case, but the user should
"KRN",19,601,1,39,0)
   be investigated further.)
"KRN",19,601,25)
ALL1^XMUTERM
"KRN",19,601,"U")
TERMINATE MANY MAIL USERS
"KRN",19,602,-1)
0^106
"KRN",19,602,0)
XMMGR-TERMINATE-SUGGEST^Terminate mail user suggestions^^R^^^^^^^^MAILMAN
"KRN",19,602,1,0)
^19.06^37^37^3020509^^^^
"KRN",19,602,1,1,0)
This option goes through the MailBox global and reports on users who
"KRN",19,602,1,2,0)
*perhaps* should have their mail access terminated.
"KRN",19,602,1,3,0)
 
"KRN",19,602,1,4,0)
Users are included in the report if
"KRN",19,602,1,5,0)
 - the user was DISUSER'd.
"KRN",19,602,1,6,0)
 - the user was terminated before a manager-supplied cutoff date
"KRN",19,602,1,7,0)
   and allowed to keep a mailbox.
"KRN",19,602,1,8,0)
 - the user has an access code, verify code, and primary menu,
"KRN",19,602,1,9,0)
   but last signed on or used mail before a manager-supplied cutoff date.
"KRN",19,602,1,10,0)
 - the user has an access code, verify code, and primary menu,
"KRN",19,602,1,11,0)
   was added before a manager-supplied cutoff date, but has never signed on
"KRN",19,602,1,12,0)
   or used mail.
"KRN",19,602,1,13,0)
 
"KRN",19,602,1,14,0)
This option does not terminate mail access.
"KRN",19,602,1,15,0)
 
"KRN",19,602,1,16,0)
The report page breaks on Service/Section and includes the following
"KRN",19,602,1,17,0)
information:
"KRN",19,602,1,18,0)
 - User's DUZ and name
"KRN",19,602,1,19,0)
 - Whether the user has an access code, a verify code, and a primary menu
"KRN",19,602,1,20,0)
 - When the user last signed on or used mail
"KRN",19,602,1,21,0)
 - When the user was terminated (if applicable)
"KRN",19,602,1,22,0)
 - If the user was terminated, then whether the site manager chose to
"KRN",19,602,1,23,0)
   delete the user's mailbox.  (Remember, you should usually answer 'yes'
"KRN",19,602,1,24,0)
   to this question, unless the user is coming back and needs to have his
"KRN",19,602,1,25,0)
   mail retained.)
"KRN",19,602,1,26,0)
 - Whether the user was DISUSER'd
"KRN",19,602,1,27,0)
 - How many new messages the user has.  (New messages are never purged,
"KRN",19,602,1,28,0)
   except during purge-by-date purges.)
"KRN",19,602,1,29,0)
 - If the user has any surrogates, the first surrogate is shown.
"KRN",19,602,1,30,0)
 - If the user has an access code and a forwarding address, the forwarding
"KRN",19,602,1,31,0)
   address is shown.
"KRN",19,602,1,32,0)

"KRN",19,602,1,33,0)
Besides being of interest to the Site Manager, this report is also
"KRN",19,602,1,34,0)
designed to be submitted to other services. The intent is that the
"KRN",19,602,1,35,0)
other services would check each of their users listed in the report,
"KRN",19,602,1,36,0)
annotate whether MailMan or VistA access should be terminated, and
"KRN",19,602,1,37,0)
return the report to the Site Manager to act on. 
"KRN",19,602,25)
ALL2^XMUTERM
"KRN",19,602,"U")
TERMINATE MAIL USER SUGGESTION
"KRN",19,603,-1)
0^171
"KRN",19,603,0)
XMMGR-PURGE-MESSAGE^Purge a message^^R^^^^^^^^MAILMAN
"KRN",19,603,1,0)
^19.06^9^9^3020509^^^
"KRN",19,603,1,1,0)
This option enables you to purge any message.
"KRN",19,603,1,2,0)

"KRN",19,603,1,3,0)
Purge means:
"KRN",19,603,1,4,0)
 -delete the message from all user mailboxes
"KRN",19,603,1,5,0)
 -delete the message from the MESSAGE file 3.9
"KRN",19,603,1,6,0)
 -delete all responses from the MESSAGE file 3.9
"KRN",19,603,1,7,0)
 -delete the message from the MESSAGES TO BE NEW AT A LATER DATE file 3.73
"KRN",19,603,1,8,0)

"KRN",19,603,1,9,0)
Purge is not reversible.  The message is gone forever.
"KRN",19,603,25)
MESSAGE^XMUTERM
"KRN",19,603,"U")
PURGE A MESSAGE
"KRN",19,604,-1)
0^162
"KRN",19,604,0)
XM FILTER EDIT^Message Filter Edit^^R^^^XM-U-P-FILTER^^^^^MAILMAN
"KRN",19,604,1,0)
^19.06^24^24^3020509^^^^
"KRN",19,604,1,1,0)
The filter is used by MailMan to determine into which basket to place a
"KRN",19,604,1,2,0)
message.
"KRN",19,604,1,3,0)

"KRN",19,604,1,4,0)
Messages can be filtered based on up to three criteria which are 'and'ed
"KRN",19,604,1,5,0)
together:
"KRN",19,604,1,6,0)
 - Subject contains
"KRN",19,604,1,7,0)
 - Message is from
"KRN",19,604,1,8,0)
 - Message is to
"KRN",19,604,1,9,0)

"KRN",19,604,1,10,0)
For example, if you specify 'subject contains' and 'message is from', the
"KRN",19,604,1,11,0)
filter takes effect only if the subject contains the string you specify AND
"KRN",19,604,1,12,0)
the message is from the person you specify. 
"KRN",19,604,1,13,0)

"KRN",19,604,1,14,0)
If you wish the filter to take effect upon 'subject contains' OR 'message
"KRN",19,604,1,15,0)
is from' you must create two filters, one with 'subject contains', and the
"KRN",19,604,1,16,0)
other with 'message is from'.
"KRN",19,604,1,17,0)

"KRN",19,604,1,18,0)
Filtering takes place during message delivery and can also be selected as a
"KRN",19,604,1,19,0)
basket action. 
"KRN",19,604,1,20,0)

"KRN",19,604,1,21,0)
The filter is ignored during delivery under the following conditions:
"KRN",19,604,1,22,0)
 - The message already exists in one of your baskets.
"KRN",19,604,1,23,0)
 - The message is from you, and you specified a basket (other than the IN
"KRN",19,604,1,24,0)
basket) at the transmit prompt.
"KRN",19,604,25)
FILTER^XMVVITA
"KRN",19,604,"U")
MESSAGE FILTER EDIT
"KRN",19,605,-1)
3^163
"KRN",19,605,0)
XM PERSONAL MENU^Personal Preferences^^M^^^XM-U-P-PERSONAL PREFERENCES^^^^^MAILMAN
"KRN",19,605,1,0)
^19.06^1^1^3020509^^^^
"KRN",19,605,1,1,0)
This menu has various options to let you configure MailMan to your liking.
"KRN",19,605,10,0)
^19.01IP^8^8
"KRN",19,605,10,1,0)
468^^1
"KRN",19,605,10,1,"^")
XMEDITUSER
"KRN",19,605,10,2,0)
470^^2
"KRN",19,605,10,2,"^")
XMBANNER
"KRN",19,605,10,3,0)
604^^4
"KRN",19,605,10,3,"^")
XM FILTER EDIT
"KRN",19,605,10,4,0)
522^^7
"KRN",19,605,10,4,"^")
XMEDITPERSGROUP
"KRN",19,605,10,5,0)
503^GML^6
"KRN",19,605,10,5,"^")
XMENROLL
"KRN",19,605,10,6,0)
547^^8
"KRN",19,605,10,6,"^")
XMEDITFWD
"KRN",19,605,10,7,0)
606^^3
"KRN",19,605,10,7,"^")
XMEDITSURR
"KRN",19,605,10,8,0)
647^^5
"KRN",19,605,10,8,"^")
XM DELIVERY BASKET EDIT
"KRN",19,605,99)
58279,55744
"KRN",19,605,"U")
PERSONAL PREFERENCES
"KRN",19,606,-1)
0^54
"KRN",19,606,0)
XMEDITSURR^Surrogate Edit^^R^^^XM-U-P-SURROGATE EDIT^^^^^MAILMAN
"KRN",19,606,1,0)
^^3^3^2971126^
"KRN",19,606,1,1,0)
This option enables you to edit your surrogate list, that is,
"KRN",19,606,1,2,0)
to choose who may act as a surrogate for you in MailMan,
"KRN",19,606,1,3,0)
and which privileges (read and/or send) you wish to grant them.
"KRN",19,606,25)
SURR^XMVVITA
"KRN",19,606,"U")
SURROGATE EDIT
"KRN",19,647,-1)
0^28
"KRN",19,647,0)
XM DELIVERY BASKET EDIT^Delivery Basket Edit^^R^^^XM-U-P-DELIVERY BASKET PRIV^^^^^MAILMAN
"KRN",19,647,1,0)
^^5^5^2980518^^
"KRN",19,647,1,1,0)
The sender of a message may specify the basket to which the message should
"KRN",19,647,1,2,0)
be delivered for all recipients.
"KRN",19,647,1,3,0)

"KRN",19,647,1,4,0)
Using this option, you indicate whether or not you accept such target
"KRN",19,647,1,5,0)
basket delivery, and if you do, to what degree you accept it.
"KRN",19,647,25)
BASKET^XMVVITA
"KRN",19,647,"U")
DELIVERY BASKET EDIT
"KRN",19,667,-1)
0^31
"KRN",19,667,0)
XM SUPER SEARCH^Super Search Message File^^R^^XM SUPER SEARCH^^^^^^MAILMAN
"KRN",19,667,1,0)
^19.06^20^20^3000907^^^^
"KRN",19,667,1,1,0)
This option lets the authorized user (anyone holding the XM SUPER SEARCH
"KRN",19,667,1,2,0)
key) search the Message file for messages meeting any number of criteria,
"KRN",19,667,1,3,0)
no matter who sent the messages.
"KRN",19,667,1,4,0)
 
"KRN",19,667,1,5,0)
This option should not be used lightly.  One example in which usage is
"KRN",19,667,1,6,0)
justified would be the search for evidence in an EEO harassment case.
"KRN",19,667,1,7,0)
 
"KRN",19,667,1,8,0)
This option should be audited to track who uses it.
"KRN",19,667,1,9,0)
 
"KRN",19,667,1,10,0)
Every search will trigger the sending of the XM SUPER SEARCH bulletin to
"KRN",19,667,1,11,0)
the XM SUPER SEARCH mail group.  The bulletin will record who (DUZ)
"KRN",19,667,1,12,0)
conducted the search and what criteria were used.  It will not record
"KRN",19,667,1,13,0)
the results of the search.
"KRN",19,667,1,14,0)
 
"KRN",19,667,1,15,0)
The XM SUPER SEARCH mail group must have at least two active local users
"KRN",19,667,1,16,0)
in it who have logged on recently.  If it doesn't, the search will not be
"KRN",19,667,1,17,0)
performed.  Members of this mail group should be anyone whose
"KRN",19,667,1,18,0)
responsibility it is to ensure that security is maintained and privileges
"KRN",19,667,1,19,0)
are not abused.  The mail group coordinator should be the site's
"KRN",19,667,1,20,0)
Information Security Officer or another responsible individual.
"KRN",19,667,25)
SUPER^XMJMF
"KRN",19,667,"U")
SUPER SEARCH MESSAGE FILE
"KRN",19,677,-1)
1^179
"KRN",19,677,0)
XMDXERROR
"KRN",19,678,-1)
1^180
"KRN",19,678,0)
XMDXSERVER
"KRN",19,679,-1)
1^181
"KRN",19,679,0)
XMDXVADATS
"KRN",19,680,-1)
1^182
"KRN",19,680,0)
XMPDAT
"KRN",19.1,20,-1)
0^10
"KRN",19.1,20,0)
XMMGR
"KRN",19.1,20,1,0)
^^3^3^2900316^^
"KRN",19.1,20,1,0,"LE")
1
"KRN",19.1,20,1,1,0)
This key is required for options that can remove data from the MailMan
"KRN",19.1,20,1,2,0)
system or for options that require most trusted employee status and are
"KRN",19.1,20,1,3,0)
used for managing MailMan.
"KRN",19.1,21,-1)
0^11
"KRN",19.1,21,0)
XMNET^MailMan Network Management^^n
"KRN",19.1,21,1,0)
^^3^3^2931204^^^
"KRN",19.1,21,1,1,0)
If a user does not hold this key, he may not use options that require
"KRN",19.1,21,1,2,0)
special privileges for use of network mail.  The ability to have and
"KRN",19.1,21,1,3,0)
change his forwarding address is controlled by this key.
"KRN",19.1,21,3,0)
^19.13P
"KRN",19.1,36,-1)
0^13
"KRN",19.1,36,0)
XMTALK
"KRN",19.1,36,1,0)
^^1^1^2900201^^^^
"KRN",19.1,36,1,1,0)
This key allows users to use TalkMan from their menu.
"KRN",19.1,74,-1)
0^12
"KRN",19.1,74,0)
XMNOPRIV
"KRN",19.1,74,1,0)
^^2^2^2910807^^^
"KRN",19.1,74,1,1,0)
The XMNOPRIV key is used to stop users from assuming the identity of the
"KRN",19.1,74,1,2,0)
SHARED,MAIL user.
"KRN",19.1,75,-1)
0^1
"KRN",19.1,75,0)
XMSTAR^MailMan Broadcast Permission^^n
"KRN",19.1,75,1,0)
^^16^16^2991130^^^^
"KRN",19.1,75,1,1,0)
Holders of the XMSTAR key may send Broadcast messages to all users.
"KRN",19.1,75,1,2,0)
They may also send Limited Broadcast messages to subsets of local users,
"KRN",19.1,75,1,3,0)
such as all users belonging to a certain division.
"KRN",19.1,75,1,4,0)

"KRN",19.1,75,1,5,0)
Give this key to users who need to send broadcast messages to all users.
"KRN",19.1,75,1,6,0)
The POSTMASTER does not need this key, but POSTMASTER surrogates do.
"KRN",19.1,75,1,7,0)

"KRN",19.1,75,1,8,0)
If a user does not need to send broadcast messages to all users, but
"KRN",19.1,75,1,9,0)
does need to be able to send limited broadcast messages to subsets of
"KRN",19.1,75,1,10,0)
local users, give the user the XMSTAR LIMITED key, instead.
"KRN",19.1,75,1,11,0)

"KRN",19.1,75,1,12,0)
The POSTMASTER and holders of the XMSTAR key do not need the 
"KRN",19.1,75,1,13,0)
XMSTAR LIMITED key.  They already have the capability to send limited
"KRN",19.1,75,1,14,0)
broadcast messages.
"KRN",19.1,75,1,15,0)

"KRN",19.1,75,1,16,0)
The XMSTAR key and the XMSTAR LIMITED key are mutually exclusive.
"KRN",19.1,75,5,0)
^19.15P^1^1
"KRN",19.1,75,5,1,0)
82
"KRN",19.1,75,5,"B",82,1)

"KRN",19.1,80,-1)
0^7
"KRN",19.1,80,0)
XM GROUP PRIORITY^Forward priority mail to group^^n
"KRN",19.1,80,1,0)
^^2^2^2961016^^
"KRN",19.1,80,1,1,0)
The holder of this key may forward priority mail to groups.  Without this key,
"KRN",19.1,80,1,2,0)
only the sender of a priority message may forward it to groups.
"KRN",19.1,81,-1)
0^8
"KRN",19.1,81,0)
XM NO BROADCASTS^^^
"KRN",19.1,81,1,0)
^^6^6^2990603^^^^
"KRN",19.1,81,1,1,0)
The holder of this key will not receive any broadcast messages, whether
"KRN",19.1,81,1,2,0)
locally-generated or from POSTMASTER@FORUM.
"KRN",19.1,81,1,3,0)

"KRN",19.1,81,1,4,0)
This key is intended for users for whom broadcasts may not be applicable.
"KRN",19.1,81,1,5,0)
For example, some VISN users typically log in to multiple sites in their
"KRN",19.1,81,1,6,0)
daily work and do not need to see broadcasts at each site.
"KRN",19.1,82,-1)
0^2
"KRN",19.1,82,0)
XMSTAR LIMITED^MailMan Limited Broadcast^^n
"KRN",19.1,82,1,0)
^^13^13^2991130^^^
"KRN",19.1,82,1,1,0)
Holders of the XMSTAR LIMITED key may send Limited Broadcast messages.
"KRN",19.1,82,1,2,0)
Give this key to users who may not send broadcast messages, but need
"KRN",19.1,82,1,3,0)
to be able to send limited broadcast messages to subsets of local users,
"KRN",19.1,82,1,4,0)
such as all users belonging to a certain division.
"KRN",19.1,82,1,5,0)

"KRN",19.1,82,1,6,0)
If a user needs to send broadcast messages to all users, give the user
"KRN",19.1,82,1,7,0)
the XMSTAR key, instead.
"KRN",19.1,82,1,8,0)

"KRN",19.1,82,1,9,0)
The POSTMASTER and holders of the XMSTAR key do not need the 
"KRN",19.1,82,1,10,0)
XMSTAR LIMITED key.  They already have the capability to send limited
"KRN",19.1,82,1,11,0)
broadcast messages.
"KRN",19.1,82,1,12,0)

"KRN",19.1,82,1,13,0)
The XMSTAR key and the XMSTAR LIMITED key are mutually exclusive.
"KRN",19.1,82,5,0)
^19.15P^1^1
"KRN",19.1,82,5,1,0)
75
"KRN",19.1,82,5,"B",75,1)

"KRN",19.1,83,-1)
0^9
"KRN",19.1,83,0)
XM SUPER SEARCH^Search all messages^
"KRN",19.1,83,1,0)
^^7^7^3000906^
"KRN",19.1,83,1,1,0)
This key lets the user use the option XM SUPER SEARCH, which performs
"KRN",19.1,83,1,2,0)
a search for messages in the MESSAGE file based on multiple criteria.
"KRN",19.1,83,1,3,0)
 
"KRN",19.1,83,1,4,0)
This key should be given, on a time-limited basis, to trusted
"KRN",19.1,83,1,5,0)
individuals who have a valid need to research messages in the MESSAGE
"KRN",19.1,83,1,6,0)
file.  For example, in sexual or other harassment cases, in which the
"KRN",19.1,83,1,7,0)
harassment is in the form of MailMan messages.
"KRN",19.1,84,-1)
0^5
"KRN",19.1,84,0)
XM CAC ADPAC^Identifies CACs & ADPACS^^
"KRN",19.1,84,1,0)
^^6^6^3010208^
"KRN",19.1,84,1,1,0)
People such as CACs and ADPACs, who need to be able to edit mail groups
"KRN",19.1,84,1,2,0)
and add new users to them should be assigned this key.  Holders of this
"KRN",19.1,84,1,3,0)
key may edit any mail group, except personal mail groups.  (Personal
"KRN",19.1,84,1,4,0)
mail groups are those which only the organizer may edit or use.)
"KRN",19.1,84,1,5,0)
Holders of the XMMGR key also have this privilege, and do not need to
"KRN",19.1,84,1,6,0)
hold the XM CAC ADPAC key.  
"KRN",19.1,85,-1)
0^6
"KRN",19.1,85,0)
XM GROUP EDIT MASTER^Edit other users' mail groups
"KRN",19.1,85,1,0)
^19.11^12^12^3010212^^^^
"KRN",19.1,85,1,1,0)
People who need to be able to edit other users' mail groups and
"KRN",19.1,85,1,2,0)
add new users to them should be assigned this key.
"KRN",19.1,85,1,3,0)
 
"KRN",19.1,85,1,4,0)
Holders of this key may edit any mail group, except personal mail
"KRN",19.1,85,1,5,0)
groups.  (Personal mail groups are those which only the organizer
"KRN",19.1,85,1,6,0)
may edit or use.)
"KRN",19.1,85,1,7,0)
 
"KRN",19.1,85,1,8,0)
The following users should NOT be given this key,
"KRN",19.1,85,1,9,0)
because they already possess the privilege this key grants:
"KRN",19.1,85,1,10,0)
 - Holders of the XMMGR key.
"KRN",19.1,85,1,11,0)
 - Clinical Application Coordinators, as identified in file 8930,
"KRN",19.1,85,1,12,0)
USR Class, belonging to the TIU package.
"KRN",19.1,87,-1)
1^3
"KRN",19.1,87,0)
XMPRIORITY
"KRN",19.1,88,-1)
1^4
"KRN",19.1,88,0)
XMPRIORITY-OVERRIDE
"MBREQ")
0
"ORD",0,9.8)
9.8;;1;RTNF^XPDTA;RTNE^XPDTA
"ORD",0,9.8,0)
ROUTINE
"ORD",1,9.2)
9.2;1;;;HELP^XPDTA1;HLPF1^XPDIA1;HLPE1^XPDIA1;HLPF2^XPDIA1;;HLPDEL^XPDIA1
"ORD",1,9.2,0)
HELP FRAME
"ORD",2,3.6)
3.6;2;1;;BUL^XPDTA1;;BULE1^XPDIA1;;;BULDEL^XPDIA1
"ORD",2,3.6,0)
BULLETIN
"ORD",3,19.1)
19.1;3;1;;KEY^XPDTA1;;;;;KEYDEL^XPDIA1
"ORD",3,19.1,0)
SECURITY KEY
"ORD",4,.5)
.5;4;;;EDEOUT^DIFROMSO(.5,DA,"",XPDA);FPRE^DIFROMSI(.5,"",XPDA);EPRE^DIFROMSI(.5,DA,"",XPDA,"",OLDA);;EPOST^DIFROMSI(.5,DA,"",XPDA)
"ORD",4,.5,0)
FUNCTION
"ORD",5,.4)
.4;5;;;EDEOUT^DIFROMSO(.4,DA,"",XPDA);FPRE^DIFROMSI(.4,"",XPDA);EPRE^DIFROMSI(.4,DA,$E("N",$G(XPDNEW)),XPDA,"",OLDA);;EPOST^DIFROMSI(.4,DA,"",XPDA);DEL^DIFROMSK(.4,"",%)
"ORD",5,.4,0)
PRINT TEMPLATE
"ORD",6,.401)
.401;6;;;EDEOUT^DIFROMSO(.401,DA,"",XPDA);FPRE^DIFROMSI(.401,"",XPDA);EPRE^DIFROMSI(.401,DA,$E("N",$G(XPDNEW)),XPDA,"",OLDA);;EPOST^DIFROMSI(.401,DA,"",XPDA);DEL^DIFROMSK(.401,"",%)
"ORD",6,.401,0)
SORT TEMPLATE
"ORD",9,.84)
.84;9;;;EDEOUT^DIFROMSO(.84,DA,"",XPDA);FPRE^DIFROMSI(.84,"",XPDA);EPRE^DIFROMSI(.84,DA,"",XPDA,"",OLDA);;EPOST^DIFROMSI(.84,DA,"",XPDA);DEL^DIFROMSK(.84,"",%)
"ORD",9,.84,0)
DIALOG
"ORD",11,3.8)
3.8;11;;;MAILG^XPDTA1;MAILGF1^XPDIA1;MAILGE1^XPDIA1;MAILGF2^XPDIA1
"ORD",11,3.8,0)
MAIL GROUP
"ORD",18,19)
19;18;;;OPT^XPDTA;OPTF1^XPDIA;OPTE1^XPDIA;OPTF2^XPDIA;;OPTDEL^XPDIA
"ORD",18,19,0)
OPTION
"PKG",8,-1)
1^1
"PKG",8,0)
MAILMAN^XM^Electronic Mail, both local and networked
"PKG",8,1,0)
^^5^5^2940602^
"PKG",8,1,1,0)
MailMan is a communications package that can be used by software
"PKG",8,1,2,0)
and hardware.  In its' user mode it operates in a kind of mode that
"PKG",8,1,3,0)
is very nice for asynchronous teleconferencing.  It has many functions
"PKG",8,1,4,0)
that can be used by software, including the ability to address messages
"PKG",8,1,5,0)
to software (servers) and extract data from message fields.
"PKG",8,20,0)
^9.402P^^
"PKG",8,22,0)
^9.49I^1^1
"PKG",8,22,1,0)
8.0^3020829
"PKG",8,22,1,1,0)
^^675^675^3020829
"PKG",8,22,1,1,1,0)
MailMan 8.0
"PKG",8,22,1,1,2,0)

"PKG",8,22,1,1,3,0)
Test Sites: FORUM, San Francisco, Central Alabama, FO-Albany, FO-Oakland
"PKG",8,22,1,1,4,0)

"PKG",8,22,1,1,5,0)
MailMan 8.0 is a maintenance release.  It includes the complete MailMan
"PKG",8,22,1,1,6,0)
suite of data dictionaries, but it does not populate the files.  This
"PKG",8,22,1,1,7,0)
version expects that a site already has MailMan 7.1 installed and running,
"PKG",8,22,1,1,8,0)
and that it is patched through XM*7.1*198.  It is also expected that
"PKG",8,22,1,1,9,0)
Kernel 8.0 and FileMan 22.0 are installed and are reasonably up-to-date
"PKG",8,22,1,1,10,0)
(through patches XU*8.0*216 and DI*22.0*68, respectively).
"PKG",8,22,1,1,11,0)

"PKG",8,22,1,1,12,0)
MailMan 8.0 offers the following improvements over MailMan 7.1:
"PKG",8,22,1,1,13,0)

"PKG",8,22,1,1,14,0)
1. MailMan is now DNS aware.  It can use the Kernel API MAIL^XLFNSLK
"PKG",8,22,1,1,15,0)
to retrieve IP addresses.  It is no longer necessary to manually update the
"PKG",8,22,1,1,16,0)
IP addresses in the DOMAIN file, 4.2.  The IP address fields will remain in
"PKG",8,22,1,1,17,0)
file 4.2, and MailMan will use them.  However, if they don't work, MailMan
"PKG",8,22,1,1,18,0)
will use the Kernel API to retrieve a list of valid IP addresses.  When
"PKG",8,22,1,1,19,0)
MailMan finds one that works, MailMan will replace the non-working IP
"PKG",8,22,1,1,20,0)
address with the working one.  In order to activate DNS awareness, this
"PKG",8,22,1,1,21,0)
new field in the MAILMAN SITE PARAMETERS file 4.3 must be set to 'yes':
"PKG",8,22,1,1,22,0)
     4.3,8.22   DNS AWARE                        Yes or No?
"PKG",8,22,1,1,23,0)
Also, routine ^XLFNSLK must exist, and the following field in the
"PKG",8,22,1,1,24,0)
KERNEL SYSTEMS PARAMETERS file 8989.3 must be properly filled in with
"PKG",8,22,1,1,25,0)
an IP address:
"PKG",8,22,1,1,26,0)
     8989.3,51  DNS IP                           IP address for DNS
"PKG",8,22,1,1,27,0)

"PKG",8,22,1,1,28,0)
2. For TCP/IP connections, MailMan can now build transmission scripts
"PKG",8,22,1,1,29,0)
on-the-fly.  (Transmission scripts exist in the DOMAIN file 4.2, in the
"PKG",8,22,1,1,30,0)
TRANSMISSION SCRIPT multiple, in the TEXT field 2.)  If the TYPE is "SMTP",
"PKG",8,22,1,1,31,0)
"TCPCHAN", or null, and the TEXT field has no records, and these fields
"PKG",8,22,1,1,32,0)
in the MAILMAN SITE PARAMETERS file 4.3 are filled in:
"PKG",8,22,1,1,33,0)
     4.3,8.23   TCP/IP COMMUNICATIONS PROTOCOL   Points to file 3.4
"PKG",8,22,1,1,34,0)
     4.3,8.24   TCP/IP TRANSMISSION SCRIPT       Points to file 4.6
"PKG",8,22,1,1,35,0)
...then MailMan creates the script.  This one is for FORUM:
"PKG",8,22,1,1,36,0)
     O H=FORUM.VA.GOV,P=TCP/IP-MAILMAN
"PKG",8,22,1,1,37,0)
     C TCPCHAN-SOCKET25
"PKG",8,22,1,1,38,0)
where:
"PKG",8,22,1,1,39,0)
     "FORUM.VA.GOV" is taken from the DOMAIN name.
"PKG",8,22,1,1,40,0)
     "TCP/IP-MAILMAN" is the protocol pointed to by field 8.23
"PKG",8,22,1,1,41,0)
     "TCPCHAN-SOCKET25" is the script pointed to by field 8.24.
"PKG",8,22,1,1,42,0)

"PKG",8,22,1,1,43,0)
3. Messages in transmit queues can now be designated as low priority, as
"PKG",8,22,1,1,44,0)
well as high priority.  If a message gets stuck in a transmit queue and is
"PKG",8,22,1,1,45,0)
holding up the rest of the queue for whatever reason, MailMan will make
"PKG",8,22,1,1,46,0)
that message a low priority message, so that all the other messages are
"PKG",8,22,1,1,47,0)
transmitted ahead of it.  The postmaster can also make these priority
"PKG",8,22,1,1,48,0)
changes.  In the message queue, high-priority messages are now marked with
"PKG",8,22,1,1,49,0)
'^', instead of '$'.  Low priority messages are marked with 'v'.
"PKG",8,22,1,1,50,0)

"PKG",8,22,1,1,51,0)
The postmaster can now change the transmit priority at the message level
"PKG",8,22,1,1,52,0)
(at the 'Message action: Ignore//' prompt).  As at the basket level, the
"PKG",8,22,1,1,53,0)
command to use is 'X'.  (In a user basket, the 'X' at the message level is
"PKG",8,22,1,1,54,0)
a command to unload a PackMan message or KIDS build.  In a remote transmit
"PKG",8,22,1,1,55,0)
queue, the 'X' changes the transmit priority.  The difference is the
"PKG",8,22,1,1,56,0)
context, and writers of MailMan front-ends should take note!)
"PKG",8,22,1,1,57,0)

"PKG",8,22,1,1,58,0)
4. MailMan date/times are now in a standard format, produced by the Kernel
"PKG",8,22,1,1,59,0)
API: $$FMTE^XLFDT(datetime,"2Z").  Previously, 3020803.153204 would be
"PKG",8,22,1,1,60,0)
displayed as '03 Aug 02 15:32'.  Now, it is displayed as '08/03/02@15:32'.
"PKG",8,22,1,1,61,0)
This change is also carried through to all MailMan APIs which return
"PKG",8,22,1,1,62,0)
date/time in MailMan format.  Users of such APIs should take note!
"PKG",8,22,1,1,63,0)

"PKG",8,22,1,1,64,0)
5. MailMan remote message IDs now include the message date, to ensure that
"PKG",8,22,1,1,65,0)
if you are told that a message is a duplicate of a previously received
"PKG",8,22,1,1,66,0)
message, it really is.  Sites will no longer have problems sending messages
"PKG",8,22,1,1,67,0)
from a production account to a test account which was created by "mirroring"
"PKG",8,22,1,1,68,0)
the production account.  The remote message ID is now the message number
"PKG",8,22,1,1,69,0)
following by a period, followed by the 7-digit FileMan message creation
"PKG",8,22,1,1,70,0)
date.  Before, a remote message ID might be 34561234@FORUM.VA.GOV.  Now it
"PKG",8,22,1,1,71,0)
would be 34561234.3020803@FORUM.VA.GOV.
"PKG",8,22,1,1,72,0)

"PKG",8,22,1,1,73,0)
6. The ^XMC*, ^XMR*, ^XMS* suite of routines, which are responsible for
"PKG",8,22,1,1,74,0)
scheduling, transmitting to, and receiving messages from remote sites, have
"PKG",8,22,1,1,75,0)
been completely overhauled to make them easier to understand and easier to
"PKG",8,22,1,1,76,0)
maintain.
"PKG",8,22,1,1,77,0)

"PKG",8,22,1,1,78,0)
7. MailMan will no longer display user names by taking them directly from
"PKG",8,22,1,1,79,0)
the .01 field of the NEW PERSON file, 200.  The API, $$NAMEFMT^XLFNAME,
"PKG",8,22,1,1,80,0)
supplied as part of the Name Standardization project, is used, instead.
"PKG",8,22,1,1,81,0)
Thus, the names of people whose last names, for instance, contain periods,
"PKG",8,22,1,1,82,0)
apostrophes, or spaces, are properly displayed (ST. IVES, O'MALLEY, and
"PKG",8,22,1,1,83,0)
VAN DYKE), instead of improperly (STIVES, OMALLEY, and VANDYKE).
"PKG",8,22,1,1,84,0)

"PKG",8,22,1,1,85,0)
8. In response to NOIS FAV-0202-71819, messages with responses may no longer
"PKG",8,22,1,1,86,0)
be forwarded to broadcast to all users.  Such messages may have important
"PKG",8,22,1,1,87,0)
information in the responses, and as we all know, responses are not auto-
"PKG",8,22,1,1,88,0)
forwarded to remote sites for users with auto-forward addresses.  Users who
"PKG",8,22,1,1,89,0)
attempt to broadcast messages with responses will be encouraged to copy the
"PKG",8,22,1,1,90,0)
message and its responses into a new message, which can be broadcast.
"PKG",8,22,1,1,91,0)

"PKG",8,22,1,1,92,0)
9. Incoming PackMan and KIDS messages are no longer subject to the
"PKG",8,22,1,1,93,0)
restriction NETWORK - MAX LINES RECEIVE (field 8.31, file 4.3).  Other kinds
"PKG",8,22,1,1,94,0)
of messages continue to be subject to that restriction.
"PKG",8,22,1,1,95,0)

"PKG",8,22,1,1,96,0)
10. If a task transmitting messages to another site fails and has to be
"PKG",8,22,1,1,97,0)
requeued, it really is requeued.  Previously, that wasn't true.  Previously,
"PKG",8,22,1,1,98,0)
the failing task queued up a new task to take its place, and then the
"PKG",8,22,1,1,99,0)
failing task stopped.
"PKG",8,22,1,1,100,0)

"PKG",8,22,1,1,101,0)
11. You can now send, forward, or filter-forward messages to H.device
"PKG",8,22,1,1,102,0)
(Headerless print).  It will print the message, without a header, on the
"PKG",8,22,1,1,103,0)
device.  As before, sending messages to D.device will print them with
"PKG",8,22,1,1,104,0)
a header.
"PKG",8,22,1,1,105,0)

"PKG",8,22,1,1,106,0)
12. In response to NOIS HWH-0502-41774, if you become a surrogate of a user,
"PKG",8,22,1,1,107,0)
and try to access a message that the user is not on (but you are), you will
"PKG",8,22,1,1,108,0)
be told that you will have to forward the message to the user, in order to
"PKG",8,22,1,1,109,0)
access it as the user.  You will then be given the opportunity to forward
"PKG",8,22,1,1,110,0)
it, if it's OK to do so.  (For example, if the message is closed, you would
"PKG",8,22,1,1,111,0)
not be allowed to forward it, if you didn't send it.)
"PKG",8,22,1,1,112,0)

"PKG",8,22,1,1,113,0)
13. In response to NOIS CHY-0597-50209, when using TalkMan to communicate
"PKG",8,22,1,1,114,0)
with a site, MailMan will only consider using scripts whose TYPE is TELNET.
"PKG",8,22,1,1,115,0)

"PKG",8,22,1,1,116,0)
14. The pre-init, PRE^XMYPRE, will
"PKG",8,22,1,1,117,0)
- K ^DOPT("XMC"), to reset the programmer options (D ^XMC).
"PKG",8,22,1,1,118,0)
- Kill the old "AC" xref definition for NETWORK PRIORITY TRANSMISSION field
"PKG",8,22,1,1,119,0)
6, in the basket multiple of file 3.7, and change all xrefs
"PKG",8,22,1,1,120,0)
^XMB(3.7,.5,2,"AC",1,XMK,XMZ) to ^XMB(3.7,.5,2,XMK,1,"AC",1,XMZ).
"PKG",8,22,1,1,121,0)
- Delete the following fields from file 4.2999, MESSAGE STATISTICS, because
"PKG",8,22,1,1,122,0)
they are not used:
"PKG",8,22,1,1,123,0)
     7  OUTGOING MESSAGE COUNT
"PKG",8,22,1,1,124,0)
     8  CHARACTERS REC'D
"PKG",8,22,1,1,125,0)
     9  INCOMING MESSAGE COUNT
"PKG",8,22,1,1,126,0)
    10  CHARACTERS SENT 
"PKG",8,22,1,1,127,0)
- Delete the ENTRY ACTION fields for options XMQSHOW, XMSUBEDIT, XMDXPROT.
"PKG",8,22,1,1,128,0)

"PKG",8,22,1,1,129,0)
15. The post-init, POST^XMYPRE, will
"PKG",8,22,1,1,130,0)
- Go through MailMan's security keys and ensure that the 'mutually
"PKG",8,22,1,1,131,0)
exclusive' keys are correct.
"PKG",8,22,1,1,132,0)

"PKG",8,22,1,1,133,0)
16. Here are DD changes:
"PKG",8,22,1,1,134,0)

"PKG",8,22,1,1,135,0)
a. MESSAGE file 3.7
"PKG",8,22,1,1,136,0)

"PKG",8,22,1,1,137,0)
- Change field 2, FORWARDING ADDRESS to fix the bulletin xref.  FileMan
"PKG",8,22,1,1,138,0)
thought that it was firing XM-FWD-ADDRESS-CHECKER, yet it was actually
"PKG",8,22,1,1,139,0)
firing XMZFWDBULL.  It now fires XM FWD ADDRESS CHANGE, a new bulletin,
"PKG",8,22,1,1,140,0)
which looks like the old ones, but has a better name.
"PKG",8,22,1,1,141,0)

"PKG",8,22,1,1,142,0)
STANDARD DATA DICTIONARY #3.7 -- MAILBOX FILE
"PKG",8,22,1,1,143,0)
STORED IN ^XMB(3.7,
"PKG",8,22,1,1,144,0)
DATA        NAME                GLOBAL        DATA
"PKG",8,22,1,1,145,0)
ELEMENT     TITLE               LOCATION      TYPE
"PKG",8,22,1,1,146,0)
---------------------------------------------------------------------------
"PKG",8,22,1,1,147,0)
3.7,2     FORWARDING ADDRESS     0;2 FREE TEXT
"PKG",8,22,1,1,148,0)
          Remote address to which mail is routed   
"PKG",8,22,1,1,149,0)
          INPUT TRANSFORM:  D XMFWD^XMVVITA(.X,$G(XMIA)) I $D(X) K:$L(X)>50
"PKG",8,22,1,1,150,0)
                            !($L(X)<1) X
"PKG",8,22,1,1,151,0)
          LAST EDITED:      APR 23, 2002 
"PKG",8,22,1,1,152,0)
          HELP-PROMPT:      Enter a forwarding address (name@domain) of up 
"PKG",8,22,1,1,153,0)
                            to 50 characters. 
"PKG",8,22,1,1,154,0)
          DESCRIPTION:      This field names an additional address to which
"PKG",8,22,1,1,155,0)
                            any messages addressed to you are routed.  This
"PKG",8,22,1,1,156,0)
                            address must be a remote address or a local
"PKG",8,22,1,1,157,0)
                            device.  
"PKG",8,22,1,1,158,0)
                                 
"PKG",8,22,1,1,159,0)
                            If you want a local user to see your messages,
"PKG",8,22,1,1,160,0)
                            make that user a surrogate.  
"PKG",8,22,1,1,161,0)
                                 
"PKG",8,22,1,1,162,0)
                            See the LOCAL DELIVERY FLAG.  If you do not
"PKG",8,22,1,1,163,0)
                            edit this field to 'ON', then mail will only be
"PKG",8,22,1,1,164,0)
                            delivered to your FORWARDING ADDRESS and not to
"PKG",8,22,1,1,165,0)
                            your Mailbox.  
"PKG",8,22,1,1,166,0)

"PKG",8,22,1,1,167,0)
          NOTES:            XXXX--CAN'T BE ALTERED EXCEPT BY PROGRAMMER
"PKG",8,22,1,1,168,0)

"PKG",8,22,1,1,169,0)
          CROSS-REFERENCE:  ^^BULLETIN MESSAGE 
"PKG",8,22,1,1,170,0)
                            1)= S Y(0)=X,D0=DA X "N DIIND F DIIND=1.001:.00
"PKG",8,22,1,1,171,0)
                            1 Q:$D(^DD(3.7,2,1,1,DIIND))[0  X ^(DIIND)" K X
"PKG",8,22,1,1,172,0)
                            MY S XMB="XM FWD ADDRESS CHANGE" D ^XMB:$D(^XMB
"PKG",8,22,1,1,173,0)
                            (3.7,"B",XMB)),ENT^XMUT7(DA) K Y,XMB
"PKG",8,22,1,1,174,0)
                            1.001)= S X=Y(0) S Y(1)=$S($D(^XMB(3.7,D0,0)):^
"PKG",8,22,1,1,175,0)
                            (0),1:"") S X=$S('$D(^VA(200,+$P(Y(1),U,1),0)):
"PKG",8,22,1,1,176,0)
                            "",1:$P(^(0),U,1)) S XMB(1)=X
"PKG",8,22,1,1,177,0)
                            1.002)= S X=Y(0) S Y(1)=$S($D(^XMB(3.7,D0,0)):^
"PKG",8,22,1,1,178,0)
                            (0),1:"") S X=$P(Y(1),U,2) S XMB(2)=X
"PKG",8,22,1,1,179,0)
                            2)= Q
"PKG",8,22,1,1,180,0)
                            CREATE PARAMETER #1)= NAME
"PKG",8,22,1,1,181,0)
                            CREATE PARAMETER #2)= FORWARDING ADDRESS
"PKG",8,22,1,1,182,0)
                            CREATE VALUE)= XM FWD ADDRESS CHANGE
"PKG",8,22,1,1,183,0)
                            DELETE VALUE)= NO EFFECT
"PKG",8,22,1,1,184,0)
                            This cross reference sends two bulletins.  
"PKG",8,22,1,1,185,0)
                                 
"PKG",8,22,1,1,186,0)
                            The first, XM FWD ADDRESS CHANGE, notifies
"PKG",8,22,1,1,187,0)
                            responsible individuals (belonging to the mail
"PKG",8,22,1,1,188,0)
                            group associated with the bulletin) that a user 
"PKG",8,22,1,1,189,0)
                            has changed his forwarding address.  This is
"PKG",8,22,1,1,190,0)
                            the "official" bulletin of this cross
"PKG",8,22,1,1,191,0)
                            reference.  
"PKG",8,22,1,1,192,0)
                                 
"PKG",8,22,1,1,193,0)
                            The second, XM FWD ADDRESS CHECK, is sent to
"PKG",8,22,1,1,194,0)
                            the user's new forwarding address as test to
"PKG",8,22,1,1,195,0)
                            see if the address is valid.  If it's not
"PKG",8,22,1,1,196,0)
                            valid, the sender (the Postmaster) will receive
"PKG",8,22,1,1,197,0)
                            an error message.  This bulletin has been
"PKG",8,22,1,1,198,0)
                            piggy-backed onto the "official" bulletin. 
"PKG",8,22,1,1,199,0)
                            FileMan is not aware of this.  
"PKG",8,22,1,1,200,0)

"PKG",8,22,1,1,201,0)
          CROSS-REFERENCE:  3.7^F 
"PKG",8,22,1,1,202,0)
                            1)= S ^XMB(3.7,"F",$E(X,1,30),DA)=""
"PKG",8,22,1,1,203,0)
                            2)= K ^XMB(3.7,"F",$E(X,1,30),DA)
"PKG",8,22,1,1,204,0)
                            This cross reference enables the site manager
"PKG",8,22,1,1,205,0)
                            to easily find a user who enters a bad
"PKG",8,22,1,1,206,0)
                            forwarding address.  
"PKG",8,22,1,1,207,0)

"PKG",8,22,1,1,208,0)
- Change field 3.702,6 - NETWORK PRIORITY TRANSMISSION
"PKG",8,22,1,1,209,0)
to expand the set of codes to add low priority, and to change the "AC" xref
"PKG",8,22,1,1,210,0)
from user-level to message-level.  (See item 3, above, for more info.)
"PKG",8,22,1,1,211,0)

"PKG",8,22,1,1,212,0)
3.702,6     NETWORK PRIORITY TRANSMISSION? 0;6 SET
"PKG",8,22,1,1,213,0)
                            '1' FOR HIGH PRIORITY; 
"PKG",8,22,1,1,214,0)
                            '0' FOR REGULAR PRIORITY; 
"PKG",8,22,1,1,215,0)
                            '2' FOR LOW PRIORITY; 
"PKG",8,22,1,1,216,0)
            HELP-PROMPT:    How should this message be handled during 
"PKG",8,22,1,1,217,0)
                            transmission? 
"PKG",8,22,1,1,218,0)
            DESCRIPTION:    This field is used to flag messages that need
"PKG",8,22,1,1,219,0)
                            to be transmitted before or after all other
"PKG",8,22,1,1,220,0)
                            messages in a queue.  
"PKG",8,22,1,1,221,0)

"PKG",8,22,1,1,222,0)
                            Messages in the queue which are flagged as HIGH
"PKG",8,22,1,1,223,0)
                            priority are transmitted before all other
"PKG",8,22,1,1,224,0)
                            messages.  
"PKG",8,22,1,1,225,0)

"PKG",8,22,1,1,226,0)
                            Messages in the queue which are flagged as
"PKG",8,22,1,1,227,0)
                            REGULAR priority (default) are transmitted
"PKG",8,22,1,1,228,0)
                            next.  
"PKG",8,22,1,1,229,0)

"PKG",8,22,1,1,230,0)
                            Messages in the queue which are flagged as LOW
"PKG",8,22,1,1,231,0)
                            priority are transmitted after all other
"PKG",8,22,1,1,232,0)
                            messages.  
"PKG",8,22,1,1,233,0)

"PKG",8,22,1,1,234,0)
                            Messages with the same priority are transmitted
"PKG",8,22,1,1,235,0)
                            in IEN order, which is not necessarily the
"PKG",8,22,1,1,236,0)
                            order in which they appear in the transmit
"PKG",8,22,1,1,237,0)
                            queue.  
"PKG",8,22,1,1,238,0)

"PKG",8,22,1,1,239,0)
                            Only the POSTMASTER (or surrogate) may change
"PKG",8,22,1,1,240,0)
                            the priority of a message in a transmit queue. 
"PKG",8,22,1,1,241,0)
                            If, during a transmission, MailMan has problems 
"PKG",8,22,1,1,242,0)
                            with a particular message, MailMan may flag
"PKG",8,22,1,1,243,0)
                            that message as LOW priority, so that other
"PKG",8,22,1,1,244,0)
                            messages in the queue will transmit, before the
"PKG",8,22,1,1,245,0)
                            problem message is attempted again.  
"PKG",8,22,1,1,246,0)

"PKG",8,22,1,1,247,0)
                            Changes to message priorities can be made even
"PKG",8,22,1,1,248,0)
                            while a queue is being transmitted.  
"PKG",8,22,1,1,249,0)

"PKG",8,22,1,1,250,0)
            FIELD INDEX:    AC (#12)    REGULAR    IR    SORTING ONLY
"PKG",8,22,1,1,251,0)
              Short Descr:  Transmission Priority Cross Reference
"PKG",8,22,1,1,252,0)
              Description:  This xref is used by MailMan during message
"PKG",8,22,1,1,253,0)
                            transmission to identify messages which should
"PKG",8,22,1,1,254,0)
                            be transmitted first (high priority) or last 
"PKG",8,22,1,1,255,0)
                            (low priority).  Messages with regular priority
"PKG",8,22,1,1,256,0)
                            are not xref'd.
"PKG",8,22,1,1,257,0)
                Set Logic:  S ^XMB(3.7,DA(2),2,DA(1),1,"AC",$E(X,1,1),DA)=""
"PKG",8,22,1,1,258,0)
                 Set Cond:  S X=X
"PKG",8,22,1,1,259,0)
               Kill Logic:  K ^XMB(3.7,DA(2),2,DA(1),1,"AC",$E(X,1,1),DA)
"PKG",8,22,1,1,260,0)
                Kill Cond:  S X=X
"PKG",8,22,1,1,261,0)
               Whole Kill:  K ^XMB(3.7,DA(2),2,DA(1),1,"AC")
"PKG",8,22,1,1,262,0)
                     X(1):  NETWORK PRIORITY TRANSMISSION?  (3.702,6)
"PKG",8,22,1,1,263,0)
                            (Subscr 1)  (Len 1)  (forwards)
"PKG",8,22,1,1,264,0)

"PKG",8,22,1,1,265,0)
b. MAIL GROUP file 3.8, add a trigger to field .01 to populate field 5.1
"PKG",8,22,1,1,266,0)

"PKG",8,22,1,1,267,0)
STANDARD DATA DICTIONARY #3.8 -- MAIL GROUP FILE
"PKG",8,22,1,1,268,0)
STORED IN ^XMB(3.8,
"PKG",8,22,1,1,269,0)
DATA       NAME                  GLOBAL        DATA
"PKG",8,22,1,1,270,0)
ELEMENT    TITLE                 LOCATION      TYPE
"PKG",8,22,1,1,271,0)
----------------------------------------------------------------------------
"PKG",8,22,1,1,272,0)
3.8,.01    NAME                   0;1 FREE TEXT (Required)
"PKG",8,22,1,1,273,0)
           MAIL GROUP NAME           
"PKG",8,22,1,1,274,0)
           INPUT TRANSFORM:  S:X?1"G.".E!(X?1"g.".E) X=$E(X,3,99) K:$L(X)>30
"PKG",8,22,1,1,275,0)
                             !($L(X)<3)!'(X'?1P.E)!(X'?.ANP) X
"PKG",8,22,1,1,276,0)
           HELP-PROMPT:      ANSWER MUST BE 3-30 CHARACTERS IN LENGTH 
"PKG",8,22,1,1,277,0)
           DESCRIPTION:      The name of a mail group, i.e. a list of
"PKG",8,22,1,1,278,0)
                             recipients who can all be addressed at once by
"PKG",8,22,1,1,279,0)
                             reference to this name.  
"PKG",8,22,1,1,280,0)
           NOTES:            XXXX--CAN'T BE ALTERED EXCEPT BY PROGRAMMER
"PKG",8,22,1,1,281,0)
           CROSS-REFERENCE:  3.8^B 
"PKG",8,22,1,1,282,0)
                             1)= S ^XMB(3.8,"B",$E(X,1,30),DA)=""
"PKG",8,22,1,1,283,0)
                             2)= K ^XMB(3.8,"B",$E(X,1,30),DA)
"PKG",8,22,1,1,284,0)
           CROSS-REFERENCE:  ^^TRIGGER^3.8^5 
"PKG",8,22,1,1,285,0)
                             1)= X ^DD(3.8,.01,1,2,1.3) I X S X=DIV S Y(1)=$
"PKG",8,22,1,1,286,0)
                             S($D(^XMB(3.8,D0,3)):^(3),1:"") S X=$P(Y(1),U,1
"PKG",8,22,1,1,287,0)
                             ),X=X S DIU=X K Y S X=DIV S X=$G(XMDUZ,DUZ) S D
"PKG",8,22,1,1,288,0)
                             IH=$G(^XMB(3.8,DIV(0),3)),DIV=X S $P(^(3),U,1)=
"PKG",8,22,1,1,289,0)
                             DIV,DIH=3.8,DIG=5 D ^DICR
"PKG",8,22,1,1,290,0)
                             1.3)= K DIV S DIV=X,D0=DA,DIV(0)=D0 S Y(0)=X S 
"PKG",8,22,1,1,291,0)
                             Y(1)=$S($D(^XMB(3.8,D0,3)):^(3),1:"") S X=$S('$
"PKG",8,22,1,1,292,0)
                             D(^VA(200,+$P(Y(1),U,1),0)):"",1:$P(^(0),U,1))=
"PKG",8,22,1,1,293,0)
                             ""
"PKG",8,22,1,1,294,0)
                             2)= Q
"PKG",8,22,1,1,295,0)
                             CREATE CONDITION)= ORGANIZER=""
"PKG",8,22,1,1,296,0)
                             CREATE VALUE)= S X=$G(XMDUZ,DUZ)
"PKG",8,22,1,1,297,0)
                             DELETE VALUE)= NO EFFECT
"PKG",8,22,1,1,298,0)
                             FIELD)= ORGANIZER
"PKG",8,22,1,1,299,0)
                             When a user creates a mail group, this trigger
"PKG",8,22,1,1,300,0)
                             makes that user the organizer of the group. 
"PKG",8,22,1,1,301,0)
                             The user is free to change that field.  
"PKG",8,22,1,1,302,0)

"PKG",8,22,1,1,303,0)
c. INTER-UCI TRANSFER file 4.281, increase domain name field lengths to 
"PKG",8,22,1,1,304,0)
agree with .01 field in file 4.2.  Also increase lengths of B & C xrefs.
"PKG",8,22,1,1,305,0)

"PKG",8,22,1,1,306,0)
STANDARD DATA DICTIONARY #4.281 -- INTER-UCI TRANSFER FILE
"PKG",8,22,1,1,307,0)
STORED IN ^%ZISL(4.281,
"PKG",8,22,1,1,308,0)
DATA        NAME                GLOBAL        DATA
"PKG",8,22,1,1,309,0)
ELEMENT     TITLE               LOCATION      TYPE
"PKG",8,22,1,1,310,0)
---------------------------------------------------------------------------
"PKG",8,22,1,1,311,0)
4.281,.01   FROM DOMAIN            0;1 FREE TEXT (Required)
"PKG",8,22,1,1,312,0)
            INPUT TRANSFORM:  K:$L(X)>64!($L(X)<3)!'(X'?1P.E) X
"PKG",8,22,1,1,313,0)
            HELP-PROMPT:      Answer must be 3-64 characters in length
"PKG",8,22,1,1,314,0)
            CROSS-REFERENCE:  4.281^B
"PKG",8,22,1,1,315,0)
                              1)= S ^%ZISL(4.281,"B",$E(X,1,64),DA)=""
"PKG",8,22,1,1,316,0)
                              2)= K ^%ZISL(4.281,"B",$E(X,1,64),DA)
"PKG",8,22,1,1,317,0)

"PKG",8,22,1,1,318,0)
4.281,1     TO DOMAIN              0;2 FREE TEXT
"PKG",8,22,1,1,319,0)
            INPUT TRANSFORM:  K:$L(X)>64!($L(X)<3) X
"PKG",8,22,1,1,320,0)
            HELP-PROMPT:      Answer must be 3-64 characters in length
"PKG",8,22,1,1,321,0)
            CROSS-REFERENCE:  4.281^C
"PKG",8,22,1,1,322,0)
                              1)= S ^%ZISL(4.281,"C",$E(X,1,64),DA)=""
"PKG",8,22,1,1,323,0)
                              2)= K ^%ZISL(4.281,"C",$E(X,1,64),DA)
"PKG",8,22,1,1,324,0)
                              3)= XXXX - Do not delete
"PKG",8,22,1,1,325,0)
                              This cross-reference is used by the receiving
"PKG",8,22,1,1,326,0)
                              UCI to find entries which have been
"PKG",8,22,1,1,327,0)
                              'transmitted' to it from other UCIs.
"PKG",8,22,1,1,328,0)

"PKG",8,22,1,1,329,0)
d. Add fields to MESSAGE STATISTICS file 4.2999.
"PKG",8,22,1,1,330,0)

"PKG",8,22,1,1,331,0)
STANDARD DATA DICTIONARY #4.2999 -- MESSAGE STATISTICS FILE
"PKG",8,22,1,1,332,0)
STORED IN ^XMBS(4.2999,
"PKG",8,22,1,1,333,0)
DATA        NAME                  GLOBAL        DATA
"PKG",8,22,1,1,334,0)
ELEMENT     TITLE                 LOCATION      TYPE
"PKG",8,22,1,1,335,0)
---------------------------------------------------------------------------
"PKG",8,22,1,1,336,0)
4.2999,8    DIRECTION              3;8 SET
"PKG",8,22,1,1,337,0)
                              'S' FOR SENDING; 
"PKG",8,22,1,1,338,0)
                              'R' FOR RECEIVING; 
"PKG",8,22,1,1,339,0)
            HELP-PROMPT:      Are we sending or receiving? 
"PKG",8,22,1,1,340,0)
            DESCRIPTION:      This field is used to report whether, at any
"PKG",8,22,1,1,341,0)
                              given time, we are sending messages to, or
"PKG",8,22,1,1,342,0)
                              receiving messages from, the site.  
"PKG",8,22,1,1,343,0)

"PKG",8,22,1,1,344,0)
4.2999,48   XMIT IP ADDRESSES TRIED 4;8 FREE TEXT
"PKG",8,22,1,1,345,0)
            INPUT TRANSFORM:  K:$L(X)>100!($L(X)<3) X
"PKG",8,22,1,1,346,0)
            HELP-PROMPT:      Answer must be 3-100 characters in length.
"PKG",8,22,1,1,347,0)
            DESCRIPTION:    This is a list of IP addresses, separated by
"PKG",8,22,1,1,348,0)
                            commas, which have already been used in
"PKG",8,22,1,1,349,0)
                            attempting to connect with the site.
"PKG",8,22,1,1,350,0)

"PKG",8,22,1,1,351,0)
                            We use this list in conjunction with the DNS
"PKG",8,22,1,1,352,0)
                            server, which returns a list of valid addresses
"PKG",8,22,1,1,353,0)
                            to try.  Using both lists, we can come up with
"PKG",8,22,1,1,354,0)
                            the next IP address to try.
"PKG",8,22,1,1,355,0)

"PKG",8,22,1,1,356,0)
4.29992,3   XMIT AUDIT IP ADDRESS  0;4 FREE TEXT
"PKG",8,22,1,1,357,0)
            INPUT TRANSFORM:  K:$L(X)>20!($L(X)<1) X
"PKG",8,22,1,1,358,0)
            HELP-PROMPT:      Answer must be 1-20 characters in length. 
"PKG",8,22,1,1,359,0)
            DESCRIPTION:      This is the IP address used for this attempt.
"PKG",8,22,1,1,360,0)

"PKG",8,22,1,1,361,0)
e. Change fields in MESSAGE STATISTICS file 4.2999.
"PKG",8,22,1,1,362,0)

"PKG",8,22,1,1,363,0)
Changed the title and description:
"PKG",8,22,1,1,364,0)

"PKG",8,22,1,1,365,0)
4.2999,.01  NAME              0;1 POINTER TO DOMAIN FILE (#4.2)
"PKG",8,22,1,1,366,0)
                                 (Required)
"PKG",8,22,1,1,367,0)
            Domain name               
"PKG",8,22,1,1,368,0)
            INPUT TRANSFORM:  S:$D(X) DINUM=X
"PKG",8,22,1,1,369,0)
            DESCRIPTION:      Domain for which network mail transmission
"PKG",8,22,1,1,370,0)
                              information is collected.
"PKG",8,22,1,1,371,0)
            NOTES:            XXXX--CAN'T BE ALTERED EXCEPT BY PROGRAMMER
"PKG",8,22,1,1,372,0)
            CROSS-REFERENCE:  4.2999^B
"PKG",8,22,1,1,373,0)
                              1)= S ^XMBS(4.2999,"B",$E(X,1,30),DA)=""
"PKG",8,22,1,1,374,0)
                              2)= K ^XMBS(4.2999,"B",$E(X,1,30),DA)
"PKG",8,22,1,1,375,0)

"PKG",8,22,1,1,376,0)
Changed to a pointer and changed the help prompt:
"PKG",8,22,1,1,377,0)

"PKG",8,22,1,1,378,0)
4.2999,2    MESSAGE IN TRANSIT     3;2 POINTER TO MESSAGE FILE (#3.9)
"PKG",8,22,1,1,379,0)
            HELP-PROMPT:    Enter the IEN of the message being transmitted.
"PKG",8,22,1,1,380,0)
            DESCRIPTION:    This points to the 3.9 (Message) file entry of
"PKG",8,22,1,1,381,0)
                            the message being transmitted.
"PKG",8,22,1,1,382,0)

"PKG",8,22,1,1,383,0)
Corrected the spelling of "included":
"PKG",8,22,1,1,384,0)

"PKG",8,22,1,1,385,0)
4.29991,103   MESSAGES RECEIVED    0;3 NUMBER
"PKG",8,22,1,1,386,0)

"PKG",8,22,1,1,387,0)
              INPUT TRANSFORM:K:+X'=X!(X>9999999)!(X<0)!(X?.E1"."1N.N) X
"PKG",8,22,1,1,388,0)
              HELP-PROMPT:  Type a Number between 0 and 9999999, 0 Decimal
"PKG",8,22,1,1,389,0)
                            Digits
"PKG",8,22,1,1,390,0)
              DESCRIPTION:  Messages received are included here even if
"PKG",8,22,1,1,391,0)
                            they are received only to be forwarded on to
"PKG",8,22,1,1,392,0)
                            another site.  Also included are responses and
"PKG",8,22,1,1,393,0)
                            messages received previously (as long as they
"PKG",8,22,1,1,394,0)
                            have additional recipients).
"PKG",8,22,1,1,395,0)

"PKG",8,22,1,1,396,0)
Increased the length of the following fields:
"PKG",8,22,1,1,397,0)

"PKG",8,22,1,1,398,0)
4.29991,104   CHARACTERS SENT      0;4 NUMBER
"PKG",8,22,1,1,399,0)
              INPUT TRANSFORM:K:+X'=X!(X>999999999)!(X<0)!(X?.E1"."1.N) X
"PKG",8,22,1,1,400,0)
              HELP-PROMPT:  Type a number between 0 and 999999999, 0
"PKG",8,22,1,1,401,0)
                            Decimal Digits
"PKG",8,22,1,1,402,0)
              DESCRIPTION:  This is a count of the number of characters in
"PKG",8,22,1,1,403,0)
                            the messages sent.
"PKG",8,22,1,1,404,0)

"PKG",8,22,1,1,405,0)
4.29991,105   CHARACTERS RECEIVED  0;5 NUMBER
"PKG",8,22,1,1,406,0)
              INPUT TRANSFORM:K:+X'=X!(X>999999999)!(X<0)!(X?.E1"."1.N) X
"PKG",8,22,1,1,407,0)
              HELP-PROMPT:  Type a number between 0 and 999999999, 0
"PKG",8,22,1,1,408,0)
                            Decimal Digits
"PKG",8,22,1,1,409,0)
              DESCRIPTION:  This is a count of the number of characters in
"PKG",8,22,1,1,410,0)
                            the messages received.
"PKG",8,22,1,1,411,0)

"PKG",8,22,1,1,412,0)
4.29991,106   LINES SENT           0;6 NUMBER
"PKG",8,22,1,1,413,0)
              INPUT TRANSFORM:K:+X'=X!(X>99999999)!(X<0)!(X?.E1"."1.N) X
"PKG",8,22,1,1,414,0)
              HELP-PROMPT:  Type a number between 0 and 99999999, 0 Decimal
"PKG",8,22,1,1,415,0)
                            Digits
"PKG",8,22,1,1,416,0)
              DESCRIPTION:  This is a count of the number of lines in the
"PKG",8,22,1,1,417,0)
                            message sent.
"PKG",8,22,1,1,418,0)

"PKG",8,22,1,1,419,0)
4.29991,107   LINES RECEIVED       0;7 NUMBER
"PKG",8,22,1,1,420,0)
              INPUT TRANSFORM:K:+X'=X!(X>99999999)!(X<0)!(X?.E1"."1.N) X
"PKG",8,22,1,1,421,0)
              HELP-PROMPT:  Type a number between 0 and 99999999, 0 Decimal
"PKG",8,22,1,1,422,0)
                            Digits
"PKG",8,22,1,1,423,0)
              DESCRIPTION:  This is a count of the number of lines in the
"PKG",8,22,1,1,424,0)
                            messages received.
"PKG",8,22,1,1,425,0)

"PKG",8,22,1,1,426,0)
f. Add fields to MAILMAN SITE PARAMETERS file 4.3
"PKG",8,22,1,1,427,0)
(See items 1 and 2, above, for more info.)
"PKG",8,22,1,1,428,0)

"PKG",8,22,1,1,429,0)
STANDARD DATA DICTIONARY #4.3 -- MAILMAN SITE PARAMETERS FILE
"PKG",8,22,1,1,430,0)
STORED IN ^XMB(1,
"PKG",8,22,1,1,431,0)
DATA        NAME            GLOBAL        DATA
"PKG",8,22,1,1,432,0)
ELEMENT     TITLE           LOCATION      TYPE
"PKG",8,22,1,1,433,0)
---------------------------------------------------------------------------
"PKG",8,22,1,1,434,0)
4.3,8.22    DNS AWARE       NETWORK;2 SET
"PKG",8,22,1,1,435,0)
                            '0' FOR NO;
"PKG",8,22,1,1,436,0)
                            '1' FOR YES;
"PKG",8,22,1,1,437,0)
            HELP-PROMPT:    Should MailMan use DNS to look up IP addresses?
"PKG",8,22,1,1,438,0)
            DESCRIPTION:    In order for MailMan to be DNS aware, the site
"PKG",8,22,1,1,439,0)
                            must have installed the requisite Kernel
"PKG",8,22,1,1,440,0)
                            patches for DNS.
"PKG",8,22,1,1,441,0)

"PKG",8,22,1,1,442,0)
                            If you answer 'no', MailMan will use the IP
"PKG",8,22,1,1,443,0)
                            addresses in the domain scripts.
"PKG",8,22,1,1,444,0)

"PKG",8,22,1,1,445,0)
                            If you answer 'yes', MailMan will use the IP
"PKG",8,22,1,1,446,0)
                            addresses in the domain scripts, but if they
"PKG",8,22,1,1,447,0)
                            fail, or don't exist, MailMan will use DNS to
"PKG",8,22,1,1,448,0)
                            ascertain other IP addresses to try.  MailMan
"PKG",8,22,1,1,449,0)
                            will replace failed script IP address with the
"PKG",8,22,1,1,450,0)
                            successful DNS IP address.
"PKG",8,22,1,1,451,0)

"PKG",8,22,1,1,452,0)
4.3,8.23  TCP/IP COMMUNICATIONS PROTOCOL NETWORK;3
"PKG",8,22,1,1,453,0)
                            POINTER TO COMMUNICATIONS PROTOCOL FILE (#3.4)
"PKG",8,22,1,1,454,0)
                            (Required)
"PKG",8,22,1,1,455,0)
          HELP-PROMPT:      Which protocol shall be used for TCP/IP?
"PKG",8,22,1,1,456,0)
          DESCRIPTION:      For TCP/IP connections, the scripts (the TEXT
"PKG",8,22,1,1,457,0)
                            field, 2, in the TRANSMISSION SCRIPT multiple,
"PKG",8,22,1,1,458,0)
                            4, of the DOMAIN file, 4.2) are ignored.
"PKG",8,22,1,1,459,0)

"PKG",8,22,1,1,460,0)
                            We identify the TCP/IP transmission scripts in
"PKG",8,22,1,1,461,0)
                            file 4.2 by the TYPE field, 1.2, within the
"PKG",8,22,1,1,462,0)
                            TRANSMISSION SCRIPT multiple.  Those whose TYPE
"PKG",8,22,1,1,463,0)
                            is 'SMTP', 'TCPCHAN', or null are considered
"PKG",8,22,1,1,464,0)
                            TCP/IP transmission scripts.
"PKG",8,22,1,1,465,0)

"PKG",8,22,1,1,466,0)
                            We can ignore the scripts, because they are
"PKG",8,22,1,1,467,0)
                            standard.
"PKG",8,22,1,1,468,0)

"PKG",8,22,1,1,469,0)
                            Here's an example of one for FORUM:
"PKG",8,22,1,1,470,0)

"PKG",8,22,1,1,471,0)
                            O H=FORUM.VA.GOV,P=TCP/IP-MAILMAN
"PKG",8,22,1,1,472,0)
                            C TCPCHAN-SOCKET25-VXD
"PKG",8,22,1,1,473,0)

"PKG",8,22,1,1,474,0)
                            In this script, the TCP/IP-MAILMAN refers to
"PKG",8,22,1,1,475,0)
                            the communications protocol to use.  This field
"PKG",8,22,1,1,476,0)
                            should point to the communications protocol in
"PKG",8,22,1,1,477,0)
                            file 3.4 that should be used for TCP/IP
"PKG",8,22,1,1,478,0)
                            connections.
"PKG",8,22,1,1,479,0)

"PKG",8,22,1,1,480,0)
4.3,8.24  TCP/IP TRANSMISSION SCRIPT NETWORK;4
"PKG",8,22,1,1,481,0)
                            POINTER TO TRANSMISSION SCRIPT FILE (#4.6)
"PKG",8,22,1,1,482,0)
                            (Required)
"PKG",8,22,1,1,483,0)
          HELP-PROMPT:      Which script shall be used for TCP/IP?
"PKG",8,22,1,1,484,0)
          DESCRIPTION:      For TCP/IP connections, the scripts (the TEXT
"PKG",8,22,1,1,485,0)
                            field, 2, in the TRANSMISSION SCRIPT multiple,
"PKG",8,22,1,1,486,0)
                            4, of the DOMAIN file, 4.2) are ignored.
"PKG",8,22,1,1,487,0)

"PKG",8,22,1,1,488,0)
                            We identify the TCP/IP transmission scripts in
"PKG",8,22,1,1,489,0)
                            file 4.2 by the TYPE field, 1.2, within the
"PKG",8,22,1,1,490,0)
                            TRANSMISSION SCRIPT multiple.  Those whose TYPE
"PKG",8,22,1,1,491,0)
                            is 'SMTP', 'TCPCHAN', or null are considered
"PKG",8,22,1,1,492,0)
                            TCP/IP transmission scripts.
"PKG",8,22,1,1,493,0)

"PKG",8,22,1,1,494,0)
                            We can ignore the scripts, because they are
"PKG",8,22,1,1,495,0)
                            standard.
"PKG",8,22,1,1,496,0)

"PKG",8,22,1,1,497,0)
                            Here's an example of one for FORUM:
"PKG",8,22,1,1,498,0)

"PKG",8,22,1,1,499,0)
                            O H=FORUM.VA.GOV,P=TCP/IP-MAILMAN
"PKG",8,22,1,1,500,0)
                            C TCPCHAN-SOCKET25-VXD
"PKG",8,22,1,1,501,0)

"PKG",8,22,1,1,502,0)
                            In this script, the TCPCHAN-SOCKET25-VXD refers
"PKG",8,22,1,1,503,0)
                            to the transmission script to use.  This field
"PKG",8,22,1,1,504,0)
                            should point to the transmission script in file
"PKG",8,22,1,1,505,0)
                            4.6 that should be used for TCP/IP connections.
"PKG",8,22,1,1,506,0)

"PKG",8,22,1,1,507,0)
NOTE: This release should be installed after hours, when user activity is at
"PKG",8,22,1,1,508,0)
a minimum.  Your site should be patched through MailMan patch XM*7.1*198.
"PKG",8,22,1,1,509,0)
It is also expected that Kernel 8.0 and FileMan 22.0 are installed and are
"PKG",8,22,1,1,510,0)
reasonably up-to-date (through patches XU*8.0*216 and DI*22.0*68,
"PKG",8,22,1,1,511,0)
respectively).  It is up to you to check this.  KIDS will not.
"PKG",8,22,1,1,512,0)
Installation will take approximately 5 minutes.
"PKG",8,22,1,1,513,0)
============================================================================ 
"PKG",8,22,1,1,514,0)

"PKG",8,22,1,1,515,0)
ROUTINES:
"PKG",8,22,1,1,516,0)
The second line of the routines now look like:
"PKG",8,22,1,1,517,0)
       ;;8.0;MailMan;;Jun 28, 2002
"PKG",8,22,1,1,518,0)
 
"PKG",8,22,1,1,519,0)
Routine list and checksums can be found in routines XMNTEG and XMNTEG0.
"PKG",8,22,1,1,520,0)

"PKG",8,22,1,1,521,0)
===========================================================================
"PKG",8,22,1,1,522,0)
 
"PKG",8,22,1,1,523,0)
INSTALLATION:
"PKG",8,22,1,1,524,0)
NOTES:
"PKG",8,22,1,1,525,0)
a. This release should be installed after hours, when user activity is at a
"PKG",8,22,1,1,526,0)
minimum.  Your site should be patched through MailMan patch XM*7.1*198.  It
"PKG",8,22,1,1,527,0)
is also expected that Kernel 8.0 and FileMan 22.0 are installed and are
"PKG",8,22,1,1,528,0)
reasonably up-to-date (through patches XU*8.0*216 and DI*22.0*68,
"PKG",8,22,1,1,529,0)
respectively).  It is up to you to check this.  KIDS will not.
"PKG",8,22,1,1,530,0)
b. Installation will take approximately 5 minutes.
"PKG",8,22,1,1,531,0)
c. DSM sites running SlotMaster may see routine mapping problems with ZSLOT
"PKG",8,22,1,1,532,0)
users, even after disabling mapping.  Therefore, such sites should consider
"PKG",8,22,1,1,533,0)
the following steps:
"PKG",8,22,1,1,534,0)
- Shutdown ZSLOT on all nodes.
"PKG",8,22,1,1,535,0)
- Disable all mapped XM routines.
"PKG",8,22,1,1,536,0)
- Install this release.
"PKG",8,22,1,1,537,0)
- Enter manual edits.
"PKG",8,22,1,1,538,0)
- Rebuild mapped routine sets.
"PKG",8,22,1,1,539,0)
- Shutdown/restart all DSM configurations.
"PKG",8,22,1,1,540,0)
An alternative to the above steps is to disable all mapped XM routines about
"PKG",8,22,1,1,541,0)
a week before you load this release.  That way you wouldn't need to shutdown
"PKG",8,22,1,1,542,0)
ZSLOT or shutdown/restart DSM configurations.
"PKG",8,22,1,1,543,0)

"PKG",8,22,1,1,544,0)
1.  Users may NOT be on the system during installation of this release.
"PKG",8,22,1,1,545,0)
2.  DSM Sites: disable mapping for all MailMan routines.
"PKG",8,22,1,1,546,0)
3.  Retrieve the MailMan 8.0 KIDS build (XM8.KID) via FTP from one of the
"PKG",8,22,1,1,547,0)
    Anonymous Directories by following the instructions in the MailMan 8.0
"PKG",8,22,1,1,548,0)
    Release Message.
"PKG",8,22,1,1,549,0)
4.  On the KIDS:Installation menu, use the following option to load the
"PKG",8,22,1,1,550,0)
    build into a Transport Global on your system:
"PKG",8,22,1,1,551,0)
       Load a Distribution
"PKG",8,22,1,1,552,0)
 Enter a Host File: E:\INETPUB\FTPROOT\XM8.KID or USR$:[USER.NAME]XM8.KID
"PKG",8,22,1,1,553,0)
                    ==========================    =======================
"PKG",8,22,1,1,554,0)
 (How you answer the above prompt depends on the system you're on and where
"PKG",8,22,1,1,555,0)
 you placed the build you retrieved in the previous step.  The answers
"PKG",8,22,1,1,556,0)
 shown are examples only.)
"PKG",8,22,1,1,557,0)
5.  Users should not be on the system.
"PKG",8,22,1,1,558,0)
    Place TaskMan in a WAIT state.
"PKG",8,22,1,1,559,0)
    You may also wish to shut down HL7 filers/LLP's and other background
"PKG",8,22,1,1,560,0)
    tasks which may attempt to create new messages.
"PKG",8,22,1,1,561,0)
6.  On the Manage MailMan:Local Delivery Management menu, use the following
"PKG",8,22,1,1,562,0)
    option to stop the background filer:
"PKG",8,22,1,1,563,0)
       STOP background filer
"PKG",8,22,1,1,564,0)
Are you sure you want Background Filers to stop delivering mail? No// YES
"PKG",8,22,1,1,565,0)
                                                                      ===
"PKG",8,22,1,1,566,0)
<< Background Filers will stop soon. >>
"PKG",8,22,1,1,567,0)
7.  On the KIDS:Installation menu, use the following options to install the
"PKG",8,22,1,1,568,0)
    Transport Global:
"PKG",8,22,1,1,569,0)
       Verify Checksums in Transport Global
"PKG",8,22,1,1,570,0)
       Print Transport Global
"PKG",8,22,1,1,571,0)
       Compare Transport Global to Current System
"PKG",8,22,1,1,572,0)
       Backup a Transport Global
"PKG",8,22,1,1,573,0)
       Install Package(s)
"PKG",8,22,1,1,574,0)
 Select INSTALL NAME:   MAILMAN 8.0   Loaded from Distribution  <date/time>
"PKG",8,22,1,1,575,0)
                        ===========
"PKG",8,22,1,1,576,0)
Install Questions for MAILMAN 8.0
"PKG",8,22,1,1,577,0)

"PKG",8,22,1,1,578,0)
Incoming Files:
"PKG",8,22,1,1,579,0)

"PKG",8,22,1,1,580,0)
   3.4       COMMUNICATIONS PROTOCOL
"PKG",8,22,1,1,581,0)
Note:  You already have the 'COMMUNICATIONS PROTOCOL' File.
"PKG",8,22,1,1,582,0)

"PKG",8,22,1,1,583,0)
   3.6       BULLETIN
"PKG",8,22,1,1,584,0)
Note:  You already have the 'BULLETIN' File.
"PKG",8,22,1,1,585,0)

"PKG",8,22,1,1,586,0)
   3.7       MAILBOX
"PKG",8,22,1,1,587,0)
Note:  You already have the 'MAILBOX' File.
"PKG",8,22,1,1,588,0)

"PKG",8,22,1,1,589,0)
   3.73      MESSAGES TO BE NEW AT A LATER DATE
"PKG",8,22,1,1,590,0)
Note:  You already have the 'MESSAGES TO BE NEW AT A LATER DATE' File.
"PKG",8,22,1,1,591,0)

"PKG",8,22,1,1,592,0)
   3.8       MAIL GROUP
"PKG",8,22,1,1,593,0)
Note:  You already have the 'MAIL GROUP' File.
"PKG",8,22,1,1,594,0)

"PKG",8,22,1,1,595,0)
   3.816     DISTRIBUTION LIST
"PKG",8,22,1,1,596,0)
Note:  You already have the 'DISTRIBUTION LIST' File.
"PKG",8,22,1,1,597,0)

"PKG",8,22,1,1,598,0)
   3.9       MESSAGE
"PKG",8,22,1,1,599,0)
Note:  You already have the 'MESSAGE' File.
"PKG",8,22,1,1,600,0)

"PKG",8,22,1,1,601,0)
   4.2       DOMAIN
"PKG",8,22,1,1,602,0)
Note:  You already have the 'DOMAIN' File.
"PKG",8,22,1,1,603,0)

"PKG",8,22,1,1,604,0)
   4.281     INTER-UCI TRANSFER
"PKG",8,22,1,1,605,0)
Note:  You already have the 'INTER-UCI TRANSFER' File.
"PKG",8,22,1,1,606,0)

"PKG",8,22,1,1,607,0)
   4.2996    INTERNET SUFFIX
"PKG",8,22,1,1,608,0)
Note:  You already have the 'INTERNET SUFFIX' File.
"PKG",8,22,1,1,609,0)

"PKG",8,22,1,1,610,0)
   4.2997    REMOTE USER DIRECTORY
"PKG",8,22,1,1,611,0)
Note:  You already have the 'REMOTE USER DIRECTORY' File.
"PKG",8,22,1,1,612,0)

"PKG",8,22,1,1,613,0)
   4.2998    MESSAGE DELIVERY STATS
"PKG",8,22,1,1,614,0)
Note:  You already have the 'MESSAGE DELIVERY STATS' File.
"PKG",8,22,1,1,615,0)

"PKG",8,22,1,1,616,0)
   4.2999    MESSAGE STATISTICS
"PKG",8,22,1,1,617,0)
Note:  You already have the 'MESSAGE STATISTICS' File.
"PKG",8,22,1,1,618,0)

"PKG",8,22,1,1,619,0)
   4.3       MAILMAN SITE PARAMETERS
"PKG",8,22,1,1,620,0)
Note:  You already have the 'MAILMAN SITE PARAMETERS' File.
"PKG",8,22,1,1,621,0)

"PKG",8,22,1,1,622,0)
   4.4       MAILMAN TIME ZONE
"PKG",8,22,1,1,623,0)
Note:  You already have the 'MAILMAN TIME ZONE' File.
"PKG",8,22,1,1,624,0)

"PKG",8,22,1,1,625,0)
   4.501     NETWORK SENDERS REJECTED
"PKG",8,22,1,1,626,0)
Note:  You already have the 'NETWORK SENDERS REJECTED' File.
"PKG",8,22,1,1,627,0)

"PKG",8,22,1,1,628,0)
   4.6       TRANSMISSION SCRIPT
"PKG",8,22,1,1,629,0)
Note:  You already have the 'TRANSMISSION SCRIPT' File.
"PKG",8,22,1,1,630,0)

"PKG",8,22,1,1,631,0)
Incoming Mail Groups:
"PKG",8,22,1,1,632,0)

"PKG",8,22,1,1,633,0)
Enter the Coordinator for Mail Group 'XM SUPER SEARCH': <Your site's ISO>
"PKG",8,22,1,1,634,0)
                                                        =================
"PKG",8,22,1,1,635,0)
Want KIDS to Rebuild Menu Trees Upon Completion of Install? YES// YES
"PKG",8,22,1,1,636,0)
                                                                  ===
"PKG",8,22,1,1,637,0)
Want KIDS to INHIBIT LOGONs during the install? YES// YES
"PKG",8,22,1,1,638,0)
                                                      ===
"PKG",8,22,1,1,639,0)
Want to DISABLE Scheduled Options, Menu Options, and Protocols? YES// NO
"PKG",8,22,1,1,640,0)
                                                                      ==
"PKG",8,22,1,1,641,0)
 Enter the Device you want to print the Install messages.
"PKG",8,22,1,1,642,0)
 You can queue the install by enter a 'Q' at the device prompt.
"PKG",8,22,1,1,643,0)
 Enter a '^' to abort the install.
"PKG",8,22,1,1,644,0)

"PKG",8,22,1,1,645,0)
 DEVICE: HOME// <Don't queue this>
"PKG",8,22,1,1,646,0)
                ------------------
"PKG",8,22,1,1,647,0)
8. Remove TaskMan from WAIT State.  If you shut down HL7 filers/LLPs or
"PKG",8,22,1,1,648,0)
   any other background tasks, you may restart them.
"PKG",8,22,1,1,649,0)
9. Start the background filer.
"PKG",8,22,1,1,650,0)
    On the Manage MailMan:Local Delivery Management menu, use the following
"PKG",8,22,1,1,651,0)
    option to start the background filer:
"PKG",8,22,1,1,652,0)
       START background filer
"PKG",8,22,1,1,653,0)
   << Background Filers will start soon. >>
"PKG",8,22,1,1,654,0)
10. Ensure that the new fields in file 4.3, MAILMAN SITE PARAMETERS, are
"PKG",8,22,1,1,655,0)
correctly entered:
"PKG",8,22,1,1,656,0)
     8.22  DNS AWARE                        Yes or No?
"PKG",8,22,1,1,657,0)
     8.23  TCP/IP COMMUNICATIONS PROTOCOL   Points to file 3.4
"PKG",8,22,1,1,658,0)
     8.24  TCP/IP TRANSMISSION SCRIPT       Points to file 4.6
"PKG",8,22,1,1,659,0)
11. DSM Sites: If your site maps routines, then rebuild your map set.
"PKG",8,22,1,1,660,0)
    Many routines have become obsolete and should be removed from the map
"PKG",8,22,1,1,661,0)
    set.  Here is a new recommended list of routines to map, should your
"PKG",8,22,1,1,662,0)
    site choose to map routines:
"PKG",8,22,1,1,663,0)
    Minimum                           Additional
"PKG",8,22,1,1,664,0)
    -------                           ----------
"PKG",8,22,1,1,665,0)
    XM                                XMC1A,XMC1B
"PKG",8,22,1,1,666,0)
    XMC1                              XMK*
"PKG",8,22,1,1,667,0)
    XMJ*                              XML
"PKG",8,22,1,1,668,0)
    XMR                               XMR1,XMR2,XMR3*
"PKG",8,22,1,1,669,0)
    XMS                               XMS1,XMS2,XMS3
"PKG",8,22,1,1,670,0)
                                      XMT*
"PKG",8,22,1,1,671,0)
                                      XMVVITAE
"PKG",8,22,1,1,672,0)
                                      XMXADDR*
"PKG",8,22,1,1,673,0)
                                      XMXSEC*
"PKG",8,22,1,1,674,0)
                                      XMXUTIL*
"PKG",8,22,1,1,675,0)
===========================================================================
"PKG",8,22,1,"PAH",0)
^9.4901^3^3
"PKG",8,22,1,"PAH",1,0)
1^3020823
"PKG",8,22,1,"PAH",1,1,0)
^^73^73^3020823
"PKG",8,22,1,"PAH",1,1,1,0)
Patch XM*8.0*1
"PKG",8,22,1,"PAH",1,1,2,0)

"PKG",8,22,1,"PAH",1,1,3,0)
NOIS: BAY-0802-31743
"PKG",8,22,1,"PAH",1,1,4,0)
Test Site:  Bay Pines, FL
"PKG",8,22,1,"PAH",1,1,5,0)
If you send or forward a message to * (Broadcast to all local users), as well
"PKG",8,22,1,"PAH",1,1,6,0)
as to SHARED,MAIL, the message is not delivered to SHARED,MAIL.  This patch
"PKG",8,22,1,"PAH",1,1,7,0)
fixes that. 
"PKG",8,22,1,"PAH",1,1,8,0)

"PKG",8,22,1,"PAH",1,1,9,0)
NOTE: This patch should be installed during off hours, when user activity
"PKG",8,22,1,"PAH",1,1,10,0)
is at a minimum.  It has no patch prerequisites, except, of course, that
"PKG",8,22,1,"PAH",1,1,11,0)
MailMan 8.0 be installed.
"PKG",8,22,1,"PAH",1,1,12,0)
============================================================================ 
"PKG",8,22,1,"PAH",1,1,13,0)

"PKG",8,22,1,"PAH",1,1,14,0)
ROUTINES:
"PKG",8,22,1,"PAH",1,1,15,0)
The second line of the routine now looks like:
"PKG",8,22,1,"PAH",1,1,16,0)
       ;;8.0;MailMan;**[patch list]**;Jun 28, 2002
"PKG",8,22,1,"PAH",1,1,17,0)

"PKG",8,22,1,"PAH",1,1,18,0)
 
"PKG",8,22,1,"PAH",1,1,19,0)
              Before          After
"PKG",8,22,1,"PAH",1,1,20,0)
Name          Checksum        Checksum        Patch List
"PKG",8,22,1,"PAH",1,1,21,0)
------------------------------------------------------------------
"PKG",8,22,1,"PAH",1,1,22,0)
XMKP          16206281        16277893        1
"PKG",8,22,1,"PAH",1,1,23,0)
XMTDL         18753082        18831179        1
"PKG",8,22,1,"PAH",1,1,24,0)
* Checksums produced by CHECK^XTSUMBLD
"PKG",8,22,1,"PAH",1,1,25,0)

"PKG",8,22,1,"PAH",1,1,26,0)
This patch introduces no new routines.
"PKG",8,22,1,"PAH",1,1,27,0)
===========================================================================
"PKG",8,22,1,"PAH",1,1,28,0)
 
"PKG",8,22,1,"PAH",1,1,29,0)
INSTALLATION:
"PKG",8,22,1,"PAH",1,1,30,0)
NOTE: This patch should be installed during off hours, when user activity
"PKG",8,22,1,"PAH",1,1,31,0)
is at a minimum.  It has no patch prerequisites, except, of course, that
"PKG",8,22,1,"PAH",1,1,32,0)
MailMan 8.0 be installed.
"PKG",8,22,1,"PAH",1,1,33,0)
1.  Users may be on the system during installation of this patch.
"PKG",8,22,1,"PAH",1,1,34,0)
2.  DSM Sites: If any of these routines is mapped, disable mapping for the 
"PKG",8,22,1,"PAH",1,1,35,0)
    affected routine(s).  
"PKG",8,22,1,"PAH",1,1,36,0)
3.  On the PackMan menu, use the 'INSTALL/CHECK MESSAGE' option.  This loads 
"PKG",8,22,1,"PAH",1,1,37,0)
    the patch into a Transport Global on your system.  
"PKG",8,22,1,"PAH",1,1,38,0)
4.  Users may be on the system.  You do not need to stop TaskMan,
"PKG",8,22,1,"PAH",1,1,39,0)
    but you should stop the background filer.
"PKG",8,22,1,"PAH",1,1,40,0)
    On the Manage MailMan:Local Delivery Management menu, use the
"PKG",8,22,1,"PAH",1,1,41,0)
    following option to stop the background filer:
"PKG",8,22,1,"PAH",1,1,42,0)
       STOP background filer
"PKG",8,22,1,"PAH",1,1,43,0)
Are you sure you want the BACKGROUND FILERS to STOP delivering mail? NO// YES
"PKG",8,22,1,"PAH",1,1,44,0)
                                                                          ===
"PKG",8,22,1,"PAH",1,1,45,0)
<< Background filer will stop soon. >>
"PKG",8,22,1,"PAH",1,1,46,0)
5.  On the KIDS:Installation menu, use the following options to install the
"PKG",8,22,1,"PAH",1,1,47,0)
    Transport Global:
"PKG",8,22,1,"PAH",1,1,48,0)
       Verify Checksums in Transport Global
"PKG",8,22,1,"PAH",1,1,49,0)
       Print Transport Global
"PKG",8,22,1,"PAH",1,1,50,0)
       Compare Transport Global to Current System
"PKG",8,22,1,"PAH",1,1,51,0)
       Backup a Transport Global
"PKG",8,22,1,"PAH",1,1,52,0)
       Install Package(s)
"PKG",8,22,1,"PAH",1,1,53,0)
 Select INSTALL NAME:    XM*8.0*1     Loaded from Distribution  <date/time>
"PKG",8,22,1,"PAH",1,1,54,0)
                         ========
"PKG",8,22,1,"PAH",1,1,55,0)
 Install Questions for XM*8.0*1
"PKG",8,22,1,"PAH",1,1,56,0)

"PKG",8,22,1,"PAH",1,1,57,0)
 Want KIDS to INHIBIT LOGONs during the install? YES// NO
"PKG",8,22,1,"PAH",1,1,58,0)
                                                       ==
"PKG",8,22,1,"PAH",1,1,59,0)
 Want to DISABLE Scheduled Options, Menu Options, and Protocols? YES// NO
"PKG",8,22,1,"PAH",1,1,60,0)
                                                                       ==
"PKG",8,22,1,"PAH",1,1,61,0)
 Enter the Device you want to print the Install messages.
"PKG",8,22,1,"PAH",1,1,62,0)
 You can queue the install by enter a 'Q' at the device prompt.
"PKG",8,22,1,"PAH",1,1,63,0)
 Enter a '^' to abort the install.
"PKG",8,22,1,"PAH",1,1,64,0)

"PKG",8,22,1,"PAH",1,1,65,0)
 DEVICE: HOME// <Do NOT queue it!>
"PKG",8,22,1,"PAH",1,1,66,0)
                ------------------
"PKG",8,22,1,"PAH",1,1,67,0)
6.  Start the background filer.
"PKG",8,22,1,"PAH",1,1,68,0)
    On the Manage MailMan:Local Delivery Management menu, use the following
"PKG",8,22,1,"PAH",1,1,69,0)
    option to start the background filer:
"PKG",8,22,1,"PAH",1,1,70,0)
       START background filer
"PKG",8,22,1,"PAH",1,1,71,0)
<< Background filer will start soon. >>
"PKG",8,22,1,"PAH",1,1,72,0)
7.  DSM Sites: After patch has installed, rebuild your map set, if necessary.
"PKG",8,22,1,"PAH",1,1,73,0)
===========================================================================
"PKG",8,22,1,"PAH",2,0)
2^3020823
"PKG",8,22,1,"PAH",2,1,0)
^^147^147^3020823
"PKG",8,22,1,"PAH",2,1,1,0)
                   * * * * *  ATTENTION  * * * * *
"PKG",8,22,1,"PAH",2,1,2,0)
         You must make manual changes to your P-MESSAGE entries
"PKG",8,22,1,"PAH",2,1,3,0)
               in your DEVICE and TERMINAL TYPE files!
"PKG",8,22,1,"PAH",2,1,4,0)
  Please read and follow the patch instructions for details on the changes!
"PKG",8,22,1,"PAH",2,1,5,0)
                   * * * * *  ATTENTION  * * * * *
"PKG",8,22,1,"PAH",2,1,6,0)

"PKG",8,22,1,"PAH",2,1,7,0)
Patch XM*8.0*2
"PKG",8,22,1,"PAH",2,1,8,0)

"PKG",8,22,1,"PAH",2,1,9,0)
Test Site: Bronx, NY; Tampa, FL
"PKG",8,22,1,"PAH",2,1,10,0)

"PKG",8,22,1,"PAH",2,1,11,0)
NOIS: BRX-0802-12085
"PKG",8,22,1,"PAH",2,1,12,0)
P-MESSAGE has the following problems:
"PKG",8,22,1,"PAH",2,1,13,0)
1) A calling program can't get the message number back.
"PKG",8,22,1,"PAH",2,1,14,0)
2) The user isn't able to specify subject, sender, and recipients if they
"PKG",8,22,1,"PAH",2,1,15,0)
queue the print.
"PKG",8,22,1,"PAH",2,1,16,0)
This patch fixes these problems, which have also been mentioned in the
"PKG",8,22,1,"PAH",2,1,17,0)
following E3Rs:
"PKG",8,22,1,"PAH",2,1,18,0)

"PKG",8,22,1,"PAH",2,1,19,0)
E3R:  5147,6405,13621
"PKG",8,22,1,"PAH",2,1,20,0)
When printing to the P-MESSAGE device, perform all user interaction before
"PKG",8,22,1,"PAH",2,1,21,0)
the text is put into the message and enable users to specify P-MESSAGE
"PKG",8,22,1,"PAH",2,1,22,0)
subject, sender, and recipients even if they queue the print.
"PKG",8,22,1,"PAH",2,1,23,0)

"PKG",8,22,1,"PAH",2,1,24,0)
E3R:  13766
"PKG",8,22,1,"PAH",2,1,25,0)
When printing to the P-MESSAGE device, return the message number of the
"PKG",8,22,1,"PAH",2,1,26,0)
message created.  The message number will be returned only if the calling
"PKG",8,22,1,"PAH",2,1,27,0)
program has set the variable XMZBACK.  If $D(XMZBACK), then XMZ will be
"PKG",8,22,1,"PAH",2,1,28,0)
set upon return, and XMZBACK will be killed.
"PKG",8,22,1,"PAH",2,1,29,0)

"PKG",8,22,1,"PAH",2,1,30,0)
E3R:  14895
"PKG",8,22,1,"PAH",2,1,31,0)
When printing to the P-MESSAGE device, and the user has chosen to have the
"PKG",8,22,1,"PAH",2,1,32,0)
message appear to be from the POSTMASTER, put the user's DUZ in field 1.1
"PKG",8,22,1,"PAH",2,1,33,0)
SENDER of the Message file.
"PKG",8,22,1,"PAH",2,1,34,0)

"PKG",8,22,1,"PAH",2,1,35,0)
NOTE: This patch should be installed during off hours, when user activity
"PKG",8,22,1,"PAH",2,1,36,0)
is at a minumum.  It requires Kernel patches XU*8.0*162 and XU*8.0*175.
"PKG",8,22,1,"PAH",2,1,37,0)
Of course, MailMan 8.0 should already be installed.
"PKG",8,22,1,"PAH",2,1,38,0)
============================================================================ 
"PKG",8,22,1,"PAH",2,1,39,0)

"PKG",8,22,1,"PAH",2,1,40,0)
ROUTINES:
"PKG",8,22,1,"PAH",2,1,41,0)
The second line of the routine now looks like:
"PKG",8,22,1,"PAH",2,1,42,0)
       ;;8.0;MailMan;**[patch list]**;Jun 28, 2002
"PKG",8,22,1,"PAH",2,1,43,0)
 
"PKG",8,22,1,"PAH",2,1,44,0)
              Before          After
"PKG",8,22,1,"PAH",2,1,45,0)
Name          Checksum        Checksum        Patch List
"PKG",8,22,1,"PAH",2,1,46,0)
--------------------------------------------------------------------------
"PKG",8,22,1,"PAH",2,1,47,0)
XMAPHOST       7077399         8988774        2
"PKG",8,22,1,"PAH",2,1,48,0)
XMYPRE1        * NEW *           68287        2
"PKG",8,22,1,"PAH",2,1,49,0)
* Checksums produced by CHECK^XTSUMBLD
"PKG",8,22,1,"PAH",2,1,50,0)

"PKG",8,22,1,"PAH",2,1,51,0)
This patch introduces the following new routine:
"PKG",8,22,1,"PAH",2,1,52,0)
XMYPRE1 has no user entry points, and may be deleted following install.
"PKG",8,22,1,"PAH",2,1,53,0)
============================================================================
"PKG",8,22,1,"PAH",2,1,54,0)
 
"PKG",8,22,1,"PAH",2,1,55,0)
INSTALLATION:
"PKG",8,22,1,"PAH",2,1,56,0)
NOTE: This patch should be installed during off hours, when user activity
"PKG",8,22,1,"PAH",2,1,57,0)
is at a minumum.  It requires Kernel patches XU*8.0*162 and XU*8.0*175.
"PKG",8,22,1,"PAH",2,1,58,0)
Of course, MailMan 8.0 should already be installed.
"PKG",8,22,1,"PAH",2,1,59,0)
1.  Users may be on the system during installation of this patch.
"PKG",8,22,1,"PAH",2,1,60,0)
2.  DSM Sites: If any of these routines is mapped, disable mapping for the 
"PKG",8,22,1,"PAH",2,1,61,0)
    affected routine(s).  
"PKG",8,22,1,"PAH",2,1,62,0)
3.  On the PackMan menu, use the 'INSTALL/CHECK MESSAGE' option.  This loads 
"PKG",8,22,1,"PAH",2,1,63,0)
    the patch into a Transport Global on your system.  
"PKG",8,22,1,"PAH",2,1,64,0)
4.  You do not need to stop TaskMan or the background filer.
"PKG",8,22,1,"PAH",2,1,65,0)
    Users may be on the system.
"PKG",8,22,1,"PAH",2,1,66,0)
5.  On the KIDS:Installation menu, use the following options to install the
"PKG",8,22,1,"PAH",2,1,67,0)
    Transport Global:
"PKG",8,22,1,"PAH",2,1,68,0)
       Verify Checksums in Transport Global
"PKG",8,22,1,"PAH",2,1,69,0)
       Print Transport Global
"PKG",8,22,1,"PAH",2,1,70,0)
       Compare Transport Global to Current System
"PKG",8,22,1,"PAH",2,1,71,0)
       Backup a Transport Global
"PKG",8,22,1,"PAH",2,1,72,0)
       Install Package(s)
"PKG",8,22,1,"PAH",2,1,73,0)
 Select INSTALL NAME:    XM*8.0*2    Loaded from Distribution  <date/time>
"PKG",8,22,1,"PAH",2,1,74,0)
                         ========
"PKG",8,22,1,"PAH",2,1,75,0)
 Install Questions:
"PKG",8,22,1,"PAH",2,1,76,0)
 Want KIDS to INHIBIT LOGONs during the install? YES// NO
"PKG",8,22,1,"PAH",2,1,77,0)
                                                       ==
"PKG",8,22,1,"PAH",2,1,78,0)
 Want to DISABLE Scheduled Options, Menu Options, and Protocols? YES// NO
"PKG",8,22,1,"PAH",2,1,79,0)
                                                                       ==
"PKG",8,22,1,"PAH",2,1,80,0)
 Enter the Device you want to print the Install messages.
"PKG",8,22,1,"PAH",2,1,81,0)
 You can queue the install by enter a 'Q' at the device prompt.
"PKG",8,22,1,"PAH",2,1,82,0)
 Enter a '^' to abort the install.
"PKG",8,22,1,"PAH",2,1,83,0)

"PKG",8,22,1,"PAH",2,1,84,0)
 DEVICE: HOME// <Do NOT queue it!>
"PKG",8,22,1,"PAH",2,1,85,0)
                ------------------
"PKG",8,22,1,"PAH",2,1,86,0)
6.  Edit the PRE-OPEN EXECUTE field for P-MESSAGE entries in the DEVICE file.
"PKG",8,22,1,"PAH",2,1,87,0)
    There may be differences, depending on your system.  Use the instructions
"PKG",8,22,1,"PAH",2,1,88,0)
    as a *pattern*.
"PKG",8,22,1,"PAH",2,1,89,0)
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
"PKG",8,22,1,"PAH",2,1,90,0)
VMS sites might look like this.  Yours might be slightly different:
"PKG",8,22,1,"PAH",2,1,91,0)
---
"PKG",8,22,1,"PAH",2,1,92,0)
Before:
"PKG",8,22,1,"PAH",2,1,93,0)
PRE-OPEN EXECUTE:
"PKG",8,22,1,"PAH",2,1,94,0)
 N % S %=$L(IO,"."),IO=$P(IO,".",1,%-1)_$J_"."_$P(IO,".",%)
"PKG",8,22,1,"PAH",2,1,95,0)
After:
"PKG",8,22,1,"PAH",2,1,96,0)
PRE-OPEN EXECUTE:
"PKG",8,22,1,"PAH",2,1,97,0)
 D EN^XMAPHOST Q:$G(POP)  N % S %=$L(IO,"."),IO=$P(IO,".",1,%-1)_$J_"."_$P(IO,
"PKG",8,22,1,"PAH",2,1,98,0)
".",%)
"PKG",8,22,1,"PAH",2,1,99,0)
 ========================= <<Add the underlined stuff to the beginning.>>
"PKG",8,22,1,"PAH",2,1,100,0)
(Please note that there are 2 spaces after the 'Q:$G(POP)'!)
"PKG",8,22,1,"PAH",2,1,101,0)

"PKG",8,22,1,"PAH",2,1,102,0)
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
"PKG",8,22,1,"PAH",2,1,103,0)
Cache OpenM/NT sites might look like this.  Yours might be slightly different:
"PKG",8,22,1,"PAH",2,1,104,0)
--------------
"PKG",8,22,1,"PAH",2,1,105,0)
Before:
"PKG",8,22,1,"PAH",2,1,106,0)
PRE-OPEN EXECUTE:
"PKG",8,22,1,"PAH",2,1,107,0)
 S IO=$P(IO,".")_$J_"."_$P(IO,".",2)
"PKG",8,22,1,"PAH",2,1,108,0)
After:
"PKG",8,22,1,"PAH",2,1,109,0)
PRE-OPEN EXECUTE:
"PKG",8,22,1,"PAH",2,1,110,0)
 D EN^XMAPHOST Q:$G(POP)  S IO=$P(IO,".")_$J_"."_$P(IO,".",2)
"PKG",8,22,1,"PAH",2,1,111,0)
 ========================= <<Add the underlined stuff to the beginning.>>
"PKG",8,22,1,"PAH",2,1,112,0)
(Please note that there are 2 spaces after the 'Q:$G(POP)'!)
"PKG",8,22,1,"PAH",2,1,113,0)
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
"PKG",8,22,1,"PAH",2,1,114,0)

"PKG",8,22,1,"PAH",2,1,115,0)
7.  Edit the CLOSE EXECUTE field for P-MESSAGE entries in the TERMINAL TYPE
"PKG",8,22,1,"PAH",2,1,116,0)
    file.  There may be differences, depending on your system.  Use the
"PKG",8,22,1,"PAH",2,1,117,0)
    instructions as a *pattern*.
"PKG",8,22,1,"PAH",2,1,118,0)

"PKG",8,22,1,"PAH",2,1,119,0)
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
"PKG",8,22,1,"PAH",2,1,120,0)
VMS sites might look like this.  Your site may vary slightly:
"PKG",8,22,1,"PAH",2,1,121,0)
---
"PKG",8,22,1,"PAH",2,1,122,0)
Before:
"PKG",8,22,1,"PAH",2,1,123,0)
CLOSE EXECUTE: 
"PKG",8,22,1,"PAH",2,1,124,0)
 W ! S XMREC="R X#255:1" X "U IO:DISCONNECT" D ^XMAPHOST,READ^XMAPHOST
"PKG",8,22,1,"PAH",2,1,125,0)
 ========================                      ==========
"PKG",8,22,1,"PAH",2,1,126,0)
 X "C IO:DELETE" K XMIO,IO(1,IO) Q
"PKG",8,22,1,"PAH",2,1,127,0)
                   =====        ==
"PKG",8,22,1,"PAH",2,1,128,0)
 <<Delete the underlined stuff.>>
"PKG",8,22,1,"PAH",2,1,129,0)
After:
"PKG",8,22,1,"PAH",2,1,130,0)
CLOSE EXECUTE: X "U IO:DISCONNECT" D READ^XMAPHOST X "C IO:DELETE" K IO(1,IO)
"PKG",8,22,1,"PAH",2,1,131,0)

"PKG",8,22,1,"PAH",2,1,132,0)
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
"PKG",8,22,1,"PAH",2,1,133,0)
Cache OpenM/NT sites might look like this.  Your site may vary slightly:
"PKG",8,22,1,"PAH",2,1,134,0)
--------------
"PKG",8,22,1,"PAH",2,1,135,0)
Before:
"PKG",8,22,1,"PAH",2,1,136,0)
CLOSE EXECUTE: 
"PKG",8,22,1,"PAH",2,1,137,0)
 W ! S XMREC="R X#255:1" U IO:DISCONNECT D ^XMAPHOST,READ^XMAPHOST
"PKG",8,22,1,"PAH",2,1,138,0)
 ========================                  ==========
"PKG",8,22,1,"PAH",2,1,139,0)
 X "C IO:DELETE" K XMIO,IO(1,IO) Q
"PKG",8,22,1,"PAH",2,1,140,0)
                   =====        ==
"PKG",8,22,1,"PAH",2,1,141,0)
 <<Delete the underlined stuff.>>
"PKG",8,22,1,"PAH",2,1,142,0)
After:
"PKG",8,22,1,"PAH",2,1,143,0)
CLOSE EXECUTE: U IO:DISCONNECT D READ^XMAPHOST X "C IO:DELETE" K IO(1,IO)
"PKG",8,22,1,"PAH",2,1,144,0)
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
"PKG",8,22,1,"PAH",2,1,145,0)

"PKG",8,22,1,"PAH",2,1,146,0)
8.  DSM Sites: After patch has installed, rebuild your map set, if necessary.
"PKG",8,22,1,"PAH",2,1,147,0)
============================================================================
"PKG",8,22,1,"PAH",3,0)
3^3020828
"PKG",8,22,1,"PAH",3,1,0)
^^127^127^3020828
"PKG",8,22,1,"PAH",3,1,1,0)
      * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
"PKG",8,22,1,"PAH",3,1,2,0)
                             ATTENTION!
"PKG",8,22,1,"PAH",3,1,3,0)

"PKG",8,22,1,"PAH",3,1,4,0)
      This patch contains a new field, which you should populate.
"PKG",8,22,1,"PAH",3,1,5,0)
      * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
"PKG",8,22,1,"PAH",3,1,6,0)

"PKG",8,22,1,"PAH",3,1,7,0)
Patch XM*8.0*3
"PKG",8,22,1,"PAH",3,1,8,0)

"PKG",8,22,1,"PAH",3,1,9,0)
NOIS: LAS-0802-62501
"PKG",8,22,1,"PAH",3,1,10,0)
Test Site:  Las Vegas, NV
"PKG",8,22,1,"PAH",3,1,11,0)
The communications testing routine, XMCDNT, distributed with MailMan 8.0
"PKG",8,22,1,"PAH",3,1,12,0)
was an old version which does not work.  This patch provides a version
"PKG",8,22,1,"PAH",3,1,13,0)
that works.
"PKG",8,22,1,"PAH",3,1,14,0)

"PKG",8,22,1,"PAH",3,1,15,0)
This patch also adds a new field to file 4.3, MAILMAN SITE PARAMETERS.
"PKG",8,22,1,"PAH",3,1,16,0)
You should fill it in with the DEVICE you normally use for your TCP/IP
"PKG",8,22,1,"PAH",3,1,17,0)
scripts in file 4.2.  With the addition of this new field, it is now
"PKG",8,22,1,"PAH",3,1,18,0)
possible to distribute new domains automatically, rather than having you
"PKG",8,22,1,"PAH",3,1,19,0)
enter them manually.  Here's the new field:
"PKG",8,22,1,"PAH",3,1,20,0)

"PKG",8,22,1,"PAH",3,1,21,0)
STANDARD DATA DICTIONARY #4.3 -- MAILMAN SITE PARAMETERS FILE
"PKG",8,22,1,"PAH",3,1,22,0)
STORED IN ^XMB(1,
"PKG",8,22,1,"PAH",3,1,23,0)

"PKG",8,22,1,"PAH",3,1,24,0)
DATA       NAME                  GLOBAL        DATA
"PKG",8,22,1,"PAH",3,1,25,0)
ELEMENT    TITLE                 LOCATION      TYPE
"PKG",8,22,1,"PAH",3,1,26,0)
----------------------------------------------------------------------------
"PKG",8,22,1,"PAH",3,1,27,0)
4.3,8.25   TCP/IP DEVICE          NETWORK;5 FREE TEXT
"PKG",8,22,1,"PAH",3,1,28,0)
           INPUT TRANSFORM:  K:$L(X)>30!($L(X)<1) X I $D(X) S %ZIS="NQRS",IO
"PKG",8,22,1,"PAH",3,1,29,0)
                             P=X D ^%ZIS K:POP X S:$D(X) X=ION W:$D(X) " Sto
"PKG",8,22,1,"PAH",3,1,30,0)
                             red internally as ",X D ^%ZISC S IOP="HOME" D ^
"PKG",8,22,1,"PAH",3,1,31,0)
                             %ZIS K IOP,%ZIS
"PKG",8,22,1,"PAH",3,1,32,0)
           HELP-PROMPT:      Which device shall be used for TCP/IP?
"PKG",8,22,1,"PAH",3,1,33,0)
           DESCRIPTION:      For TCP/IP connections, the physical
"PKG",8,22,1,"PAH",3,1,34,0)
                             link/device to be used is usually standard -
"PKG",8,22,1,"PAH",3,1,35,0)
                             some sort of NULL device.  This field is a
"PKG",8,22,1,"PAH",3,1,36,0)
                             free-text pointer to that device in the DEVICE
"PKG",8,22,1,"PAH",3,1,37,0)
                             file.
"PKG",8,22,1,"PAH",3,1,38,0)

"PKG",8,22,1,"PAH",3,1,39,0)
                             The device pointed to by this field will be
"PKG",8,22,1,"PAH",3,1,40,0)
                             used for a TCP/IP connection if, in the DOMAIN
"PKG",8,22,1,"PAH",3,1,41,0)
                             file, 4.2, the device field is null in both
"PKG",8,22,1,"PAH",3,1,42,0)
                              - field 1.3 of the TRANSMISSION SCRIPT
"PKG",8,22,1,"PAH",3,1,43,0)
                             multiple, 4
"PKG",8,22,1,"PAH",3,1,44,0)
                              - field 17
"PKG",8,22,1,"PAH",3,1,45,0)

"PKG",8,22,1,"PAH",3,1,46,0)
                             For more information, see field 17, PHYSICAL
"PKG",8,22,1,"PAH",3,1,47,0)
                             LINK DEVICE, in file 4.2.
"PKG",8,22,1,"PAH",3,1,48,0)

"PKG",8,22,1,"PAH",3,1,49,0)
           NOTES:            XXXX--CAN'T BE ALTERED EXCEPT BY PROGRAMMER
"PKG",8,22,1,"PAH",3,1,50,0)

"PKG",8,22,1,"PAH",3,1,51,0)
NOTE: This patch should be installed during off hours, when user activity
"PKG",8,22,1,"PAH",3,1,52,0)
is at a minimum.  It has no patch prerequisites, except, of course, that
"PKG",8,22,1,"PAH",3,1,53,0)
MailMan 8.0 be installed.
"PKG",8,22,1,"PAH",3,1,54,0)
============================================================================ 
"PKG",8,22,1,"PAH",3,1,55,0)

"PKG",8,22,1,"PAH",3,1,56,0)
ROUTINES:
"PKG",8,22,1,"PAH",3,1,57,0)
The second line of the routine now looks like:
"PKG",8,22,1,"PAH",3,1,58,0)
       ;;8.0;MailMan;**[patch list]**;Jun 28, 2002
"PKG",8,22,1,"PAH",3,1,59,0)

"PKG",8,22,1,"PAH",3,1,60,0)
              Before          After
"PKG",8,22,1,"PAH",3,1,61,0)
Name          Checksum        Checksum        Patch List
"PKG",8,22,1,"PAH",3,1,62,0)
------------------------------------------------------------------
"PKG",8,22,1,"PAH",3,1,63,0)
XMCDNT          401792          659873        3
"PKG",8,22,1,"PAH",3,1,64,0)
XMKPR1         5051210         5167213        3
"PKG",8,22,1,"PAH",3,1,65,0)
* Checksums produced by CHECK^XTSUMBLD
"PKG",8,22,1,"PAH",3,1,66,0)

"PKG",8,22,1,"PAH",3,1,67,0)
This patch introduces no new routines.
"PKG",8,22,1,"PAH",3,1,68,0)
===========================================================================
"PKG",8,22,1,"PAH",3,1,69,0)
 
"PKG",8,22,1,"PAH",3,1,70,0)
INSTALLATION:
"PKG",8,22,1,"PAH",3,1,71,0)
NOTE: This patch should be installed during off hours, when user activity
"PKG",8,22,1,"PAH",3,1,72,0)
is at a minimum.  It has no patch prerequisites, except, of course, that
"PKG",8,22,1,"PAH",3,1,73,0)
MailMan 8.0 be installed.
"PKG",8,22,1,"PAH",3,1,74,0)
1.  Users may be on the system during installation of this patch.
"PKG",8,22,1,"PAH",3,1,75,0)
2.  DSM Sites: If any of these routines is mapped, disable mapping for the 
"PKG",8,22,1,"PAH",3,1,76,0)
    affected routine(s).  
"PKG",8,22,1,"PAH",3,1,77,0)
3.  On the PackMan menu, use the 'INSTALL/CHECK MESSAGE' option.  This loads 
"PKG",8,22,1,"PAH",3,1,78,0)
    the patch into a Transport Global on your system.  
"PKG",8,22,1,"PAH",3,1,79,0)
4.  Users may be on the system.  You do not need to stop TaskMan or the
"PKG",8,22,1,"PAH",3,1,80,0)
    background filer.
"PKG",8,22,1,"PAH",3,1,81,0)
5.  On the KIDS:Installation menu, use the following options to install the
"PKG",8,22,1,"PAH",3,1,82,0)
    Transport Global:
"PKG",8,22,1,"PAH",3,1,83,0)
       Verify Checksums in Transport Global
"PKG",8,22,1,"PAH",3,1,84,0)
       Print Transport Global
"PKG",8,22,1,"PAH",3,1,85,0)
       Compare Transport Global to Current System
"PKG",8,22,1,"PAH",3,1,86,0)
       Backup a Transport Global
"PKG",8,22,1,"PAH",3,1,87,0)
       Install Package(s)
"PKG",8,22,1,"PAH",3,1,88,0)
 Select INSTALL NAME:    XM*8.0*3     Loaded from Distribution  <date/time>
"PKG",8,22,1,"PAH",3,1,89,0)
                         ========
"PKG",8,22,1,"PAH",3,1,90,0)
 Install Questions for XM*8.0*3
"PKG",8,22,1,"PAH",3,1,91,0)

"PKG",8,22,1,"PAH",3,1,92,0)
 Want KIDS to INHIBIT LOGONs during the install? YES// NO
"PKG",8,22,1,"PAH",3,1,93,0)
                                                       ==
"PKG",8,22,1,"PAH",3,1,94,0)
 Want to DISABLE Scheduled Options, Menu Options, and Protocols? YES// NO
"PKG",8,22,1,"PAH",3,1,95,0)
                                                                       ==
"PKG",8,22,1,"PAH",3,1,96,0)
 Enter the Device you want to print the Install messages.
"PKG",8,22,1,"PAH",3,1,97,0)
 You can queue the install by enter a 'Q' at the device prompt.
"PKG",8,22,1,"PAH",3,1,98,0)
 Enter a '^' to abort the install.
"PKG",8,22,1,"PAH",3,1,99,0)

"PKG",8,22,1,"PAH",3,1,100,0)
 DEVICE: HOME// <You may queue it if you wish>
"PKG",8,22,1,"PAH",3,1,101,0)
                ------------------------------
"PKG",8,22,1,"PAH",3,1,102,0)
6.  DSM Sites: After patch has installed, rebuild your map set, if necessary.
"PKG",8,22,1,"PAH",3,1,103,0)
7.  In field 8.25, TCP/IP DEVICE, of file 4.3, enter the name of the device
"PKG",8,22,1,"PAH",3,1,104,0)
    used at your site for TCP/IP scripts.  If you don't know it, you can
"PKG",8,22,1,"PAH",3,1,105,0)
    find it by doing a FileMan Inquiry for FORUM (or any other domain with a
"PKG",8,22,1,"PAH",3,1,106,0)
    TCP/IP script) in file 4.2:
"PKG",8,22,1,"PAH",3,1,107,0)

"PKG",8,22,1,"PAH",3,1,108,0)
Select OPTION: INQUIRE TO FILE ENTRIES
"PKG",8,22,1,"PAH",3,1,109,0)
OUTPUT FROM WHAT FILE: DEVICE// 4.2  DOMAIN  (548 entries)
"PKG",8,22,1,"PAH",3,1,110,0)
Select DOMAIN NAME: FORUM.VA.GOV
"PKG",8,22,1,"PAH",3,1,111,0)
ANOTHER ONE:
"PKG",8,22,1,"PAH",3,1,112,0)
STANDARD CAPTIONED OUTPUT? Yes//   (Yes)
"PKG",8,22,1,"PAH",3,1,113,0)
Include COMPUTED fields:  (N/Y/R/B): NO//  - No record number (IEN), no
"PKG",8,22,1,"PAH",3,1,114,0)
 Computed Fields
"PKG",8,22,1,"PAH",3,1,115,0)

"PKG",8,22,1,"PAH",3,1,116,0)
NAME: FORUM.VA.GOV                      FLAGS: S
"PKG",8,22,1,"PAH",3,1,117,0)
  PHYSICAL LINK DEVICE: NULL DEVICE  <<< 2nd choice <<<
"PKG",8,22,1,"PAH",3,1,118,0)
TRANSMISSION SCRIPT: TCP/IP             PRIORITY: 5
"PKG",8,22,1,"PAH",3,1,119,0)
  NUMBER OF ATTEMPTS: 30                TYPE: Simple Mail Transfer Protocol
"PKG",8,22,1,"PAH",3,1,120,0)
  PHYSICAL LINK / DEVICE: NULL DEVICE  <<< 1st choice <<<
"PKG",8,22,1,"PAH",3,1,121,0)

"PKG",8,22,1,"PAH",3,1,122,0)
Your first choice for the device is the one in the TCP/IP script.  If there
"PKG",8,22,1,"PAH",3,1,123,0)
isn't any there, then your second choice is as indicated.  Note:
"PKG",8,22,1,"PAH",3,1,124,0)
- Not all of the fields are shown in this example.
"PKG",8,22,1,"PAH",3,1,125,0)
- Your TCP/IP script may have a different name from the one shown.
"PKG",8,22,1,"PAH",3,1,126,0)
- Your device may have a different name from the one shown.
"PKG",8,22,1,"PAH",3,1,127,0)
===========================================================================
"PKG",8,22,1,"PAH","B",1,1)

"PKG",8,22,1,"PAH","B",2,2)

"PKG",8,22,1,"PAH","B",3,3)

"PKG",8,"DEV")
WASHINGTON ISC
"PKG",8,"VERSION")
8.0
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
386
"RTN","XM")
0^238^B66365873
"RTN","XM",1,0)
XM ;ISC-SF/GMB-MailMan Main Driver ;04/22/2002  14:31
"RTN","XM",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XM",3,0)
 ; Replaces ^XM,EN^XMA01,INTRO^XMA6,REC^XMA22,MULTI^XM0,^XMAK (ISC-WASH/CAP/THM)
"RTN","XM",4,0)
 ;
"RTN","XM",5,0)
 ; Entry points (DBIA 10064):
"RTN","XM",6,0)
 ; ^XM       Programmer entry into MailMan
"RTN","XM",7,0)
 ; CHECKIN   Meant to be included in option ENTRY ACTION
"RTN","XM",8,0)
 ; CHECKOUT  Meant to be included in option EXIT ACTION
"RTN","XM",9,0)
 ; EN        Option entry point into MailMan
"RTN","XM",10,0)
 ; HEADER    Displays user intro when entering MailMan
"RTN","XM",11,0)
 ; KILL      Kill MailMan variables
"RTN","XM",12,0)
 ; N1        Create a mailbox
"RTN","XM",13,0)
 ; NEW       Create a mailbox
"RTN","XM",14,0)
 ; $$NU      Tell user how many new messages he has
"RTN","XM",15,0)
 ; 
"RTN","XM",16,0)
 ; Entry points used by MailMan options (not covered by DBIA):
"RTN","XM",17,0)
 ; NEWMBOX   XMMGR-NEW-MAIL-BOX - Create a mailbox
"RTN","XM",18,0)
 D KILL^XUSCLEAN
"RTN","XM",19,0)
 N XMXUSEC,XMABORT,XMMENU
"RTN","XM",20,0)
 S XMMENU(0)="^XM"
"RTN","XM",21,0)
 I '$D(IOF) D HOME^%ZIS
"RTN","XM",22,0)
 D EN
"RTN","XM",23,0)
 I $D(XQUIT)!'$D(XMDUZ) K XQUIT D CLEANUP Q
"RTN","XM",24,0)
 D:'$D(^DOPT("XM")) OPTIONS
"RTN","XM",25,0)
 S XMABORT=0
"RTN","XM",26,0)
 F  D  Q:XMABORT  ; Programmer option choices
"RTN","XM",27,0)
 . N DIC,X,Y
"RTN","XM",28,0)
 . S XMXUSEC=$S($G(DUZ(0))="@":1,$D(^XUSEC("XUPROG",XMDUZ)):1,$D(^XUSEC("XUPROGMODE",XMDUZ)):1,1:0)
"RTN","XM",29,0)
 . S DIC="^DOPT(""XM"","
"RTN","XM",30,0)
 . S DIC(0)="AEQMZ"
"RTN","XM",31,0)
 . S DIC("S")="Q:XMXUSEC  I ^(0)'[""LOAD"""
"RTN","XM",32,0)
 . W !!
"RTN","XM",33,0)
 . D ^DIC I Y<0 S XMABORT=1 Q
"RTN","XM",34,0)
 . K DIC,X
"RTN","XM",35,0)
 . X $P(Y(0),U,2,999)
"RTN","XM",36,0)
 D CLEANUP
"RTN","XM",37,0)
 Q
"RTN","XM",38,0)
EN ;Initialize
"RTN","XM",39,0)
 ;N XMDUZ,XMDISPI,XMDUN,XMNOSEND,XMV
"RTN","XM",40,0)
 Q:$D(DUZ("SAV"))  ; Set by option XUTESTUSER
"RTN","XM",41,0)
 D SETUP
"RTN","XM",42,0)
 D HEADER
"RTN","XM",43,0)
 Q
"RTN","XM",44,0)
SETUP ;
"RTN","XM",45,0)
 I $G(IO)'=$G(IO(0))!'$D(IO(0)) D HOME^%ZIS U IO
"RTN","XM",46,0)
 D CHECK^XMKPL ; Make sure background filers are running.
"RTN","XM",47,0)
 I '$D(IOF)!'$D(IOM)!'$D(IOSL) S IOP="" D ^%ZIS K IOP
"RTN","XM",48,0)
 S XMDUZ=DUZ
"RTN","XM",49,0)
 D INIT^XMVVITAE
"RTN","XM",50,0)
 K XMERR,^TMP("XMERR",$J)
"RTN","XM",51,0)
 Q
"RTN","XM",52,0)
HEADER ;
"RTN","XM",53,0)
 N XMPERSON,XMPARM,XMTEXT
"RTN","XM",54,0)
 I $D(XMV("SYSERR")) D ERROR(.XMV,"SYSERR") S:$D(XMMENU) XQUIT="" Q  ; Fatal Errors
"RTN","XM",55,0)
 I $D(XMV("ERROR")) D ERROR(.XMV,"ERROR") S:$D(XMMENU) XQUIT="" Q  ; Fatal Errors
"RTN","XM",56,0)
 I $D(XMV("WARNING")) D WARNING(XMDUZ,.XMV)
"RTN","XM",57,0)
 S XMPARM(1)=XMV("VERSION"),XMPARM(2)=XMV("NETNAME")
"RTN","XM",58,0)
 W !!,$$EZBLD^DIALOG(38150,.XMPARM) ; |1| service for |2|
"RTN","XM",59,0)
 I XMDUZ'=DUZ W !,$$EZBLD^DIALOG(38008,XMV("DUZ NAME")) ; (Surrogate: |1|)
"RTN","XM",60,0)
 I XMDUZ'=.6 D
"RTN","XM",61,0)
 . S XMPARM(1)=XMV("LAST USE"),XMPARM(2)=XMV("NAME")
"RTN","XM",62,0)
 . W !,$$EZBLD^DIALOG($S(XMDUZ=DUZ:38151,1:38152),.XMPARM) ; You/|2| last used MailMan: |1|
"RTN","XM",63,0)
 . Q:'$D(XMV("BANNER"))
"RTN","XM",64,0)
 . S XMPARM(1)=XMV("BANNER"),XMPARM(2)=XMV("NAME")
"RTN","XM",65,0)
 . D BLD^DIALOG($S(XMDUZ=DUZ:38153,1:38154),.XMPARM,"","XMTEXT","F")
"RTN","XM",66,0)
 . D MSG^DIALOG("WM","","","","XMTEXT")
"RTN","XM",67,0)
 . ; Your/|2|'s current banner: |1|
"RTN","XM",68,0)
 . ;E  W !,$S(XMDUZ=DUZ:"You have",1:XMV("NAME")_" has")," no banner."
"RTN","XM",69,0)
 S XMPARM(1)=XMV("NEW MSGS"),XMPARM(2)=XMV("NAME")
"RTN","XM",70,0)
 W !,$$EZBLD^DIALOG($S(XMDUZ=DUZ:38155,1:38156)+$S(XMV("NEW MSGS")>1:0,'XMV("NEW MSGS"):.2,1:.1),.XMPARM) ; You have/|2| has |1|/no new message(s).
"RTN","XM",71,0)
 I XMV("NEW MSGS")<0!(XMV("NEW MSGS")&'$D(^XMB(3.7,XMDUZ,"N0")))!('XMV("NEW MSGS")&$D(^XMB(3.7,XMDUZ,"N0"))) D
"RTN","XM",72,0)
 . D MSG(38160)
"RTN","XM",73,0)
 . ; There's a discrepancy in the 'new message' count.  Checking the mailbox...
"RTN","XM",74,0)
 . D USER^XMUT4(XMDUZ)
"RTN","XM",75,0)
 Q
"RTN","XM",76,0)
ERROR(XMV,XMTYPE) ;
"RTN","XM",77,0)
 N I
"RTN","XM",78,0)
 S I=0
"RTN","XM",79,0)
 F  S I=$O(XMV(XMTYPE,I)) Q:I=""  W !,$C(7),XMV(XMTYPE,I)
"RTN","XM",80,0)
 K XMDUZ
"RTN","XM",81,0)
 Q
"RTN","XM",82,0)
WARNING(XMDUZ,XMV) ;
"RTN","XM",83,0)
 D:$D(XMV("WARNING",5)) POST(XMV("WARNING",5))
"RTN","XM",84,0)
 D:$D(XMV("WARNING",4)) MULTI
"RTN","XM",85,0)
 D:$D(XMV("WARNING",3)) INTRO(XMDUZ)
"RTN","XM",86,0)
 D:$D(XMV("WARNING",2)) UNSENT(XMDUZ)
"RTN","XM",87,0)
 D:$D(XMV("WARNING",1)) LISTPRI^XMJML(XMDUZ)
"RTN","XM",88,0)
 ;D:$D(XMV("WARNING",1)) PRIO^XMJML(XMDUZ)
"RTN","XM",89,0)
 K XMV("WARNING")
"RTN","XM",90,0)
 Q
"RTN","XM",91,0)
MSG(XMDIALOG) ;
"RTN","XM",92,0)
 N XMTEXT
"RTN","XM",93,0)
 W !
"RTN","XM",94,0)
 D BLD^DIALOG(XMDIALOG,"","","XMTEXT","F")
"RTN","XM",95,0)
 D MSG^DIALOG("WM","","","","XMTEXT")
"RTN","XM",96,0)
 Q
"RTN","XM",97,0)
POST(XMMSG) ;
"RTN","XM",98,0)
 W !!,$C(7),XMMSG ; "POSTMASTER has X baskets."
"RTN","XM",99,0)
 D MSG(38113.1)
"RTN","XM",100,0)
 ;POSTMASTER may not have more than 999 baskets.
"RTN","XM",101,0)
 ;Baskets numbered above 999 are reserved for network transmission
"RTN","XM",102,0)
 ;queues and for server queues.
"RTN","XM",103,0)
 Q
"RTN","XM",104,0)
MULTI ;
"RTN","XM",105,0)
 ;It appears someone is signed on as you/|1| already.
"RTN","XM",106,0)
 ;You may not send mail or respond to mail in this session.
"RTN","XM",107,0)
 ;(Only the 1st of multiple MailMan sessions may send or respond to mail.)
"RTN","XM",108,0)
 N XMTEXT
"RTN","XM",109,0)
 W !
"RTN","XM",110,0)
 D BLD^DIALOG($S(XMDUZ=DUZ:38110.1,1:38110.2),XMV("NAME"),"","XMTEXT","F")
"RTN","XM",111,0)
 D BLD^DIALOG(38110.3,"","","XMTEXT","F")
"RTN","XM",112,0)
 D MSG^DIALOG("WM","","","","XMTEXT")
"RTN","XM",113,0)
 Q
"RTN","XM",114,0)
INTRO(XMDUZ) ;
"RTN","XM",115,0)
 D MSG(38114.1)
"RTN","XM",116,0)
 ;You have not yet introduced yourself to the group.
"RTN","XM",117,0)
 ;Please enter a short introduction, so that others may use
"RTN","XM",118,0)
 ;the HELP option to find out more about you.
"RTN","XM",119,0)
 ;You may change your INTRODUCTION later
"RTN","XM",120,0)
 ;under 'Personal Preferences|User Options Edit.
"RTN","XM",121,0)
 W !!
"RTN","XM",122,0)
 N DIR S DIR(0)="E" D ^DIR Q:$D(DIRUT)
"RTN","XM",123,0)
 N DWPK,DIC
"RTN","XM",124,0)
 S DWPK=1,DIC="^XMB(3.7,XMDUZ,1,"
"RTN","XM",125,0)
 D EN^DIWE
"RTN","XM",126,0)
 Q
"RTN","XM",127,0)
UNSENT(XMDUZ) ;
"RTN","XM",128,0)
 N XMREC,XMZ
"RTN","XM",129,0)
 L +^XMB(3.7,"AD",XMDUZ):0 E  D  Q
"RTN","XM",130,0)
 . S XMV("NOSEND")=1
"RTN","XM",131,0)
 . D MULTI
"RTN","XM",132,0)
 S XMREC=^XMB(3.7,XMDUZ,"T")
"RTN","XM",133,0)
 S XMZ=$P(XMREC,U) Q:'XMZ
"RTN","XM",134,0)
 I $P(XMREC,U,3) D RECOVER^XMJMR(XMDUZ,XMZ,$P(XMREC,U,3)) Q  ; Reply
"RTN","XM",135,0)
 D RECOVER^XMJMS(XMDUZ,XMZ,$P(XMREC,U,4))  ; Original Message (w/BLOB)
"RTN","XM",136,0)
 Q
"RTN","XM",137,0)
CHECKIN ;
"RTN","XM",138,0)
 Q:$D(XMMENU(0))   ; Set by option XMUSER or other options using MailMan
"RTN","XM",139,0)
 Q:$D(DUZ("SAV"))  ; Set by option XUTESTUSER
"RTN","XM",140,0)
 D SETUP
"RTN","XM",141,0)
 I $D(XMV("WARNING")) D WARNING(XMDUZ,.XMV)
"RTN","XM",142,0)
 Q
"RTN","XM",143,0)
CHECKOUT ;
"RTN","XM",144,0)
 K XMERR,^TMP("XMERR",$J)
"RTN","XM",145,0)
 Q:$D(XMMENU(0))
"RTN","XM",146,0)
 K XMDISPI,XMDUN,XMDUZ,XMNOSEND,XMPRIV,XMV
"RTN","XM",147,0)
 L -^XMB(3.7,"AD",DUZ)
"RTN","XM",148,0)
 Q
"RTN","XM",149,0)
LOCK ;
"RTN","XM",150,0)
 S Y=1
"RTN","XM",151,0)
 Q:'$D(XMMENU(0))
"RTN","XM",152,0)
 L +^XMB(3.7,"AD",DUZ):0 E  D MULTI S Y=-1
"RTN","XM",153,0)
 Q
"RTN","XM",154,0)
UNLOCK ;
"RTN","XM",155,0)
 Q:'$D(XMMENU(0))
"RTN","XM",156,0)
 L -^XMB(3.7,"AD",DUZ)
"RTN","XM",157,0)
 Q
"RTN","XM",158,0)
CHK ; Entry used by Kernel
"RTN","XM",159,0)
 K ^TMP("XMY",$J),^TMP("XMY0",$J)
"RTN","XM",160,0)
 S XMDUZ=$G(XMDUZ,DUZ)
"RTN","XM",161,0)
 Q:XMDUZ=.6
"RTN","XM",162,0)
 D NUS(0)
"RTN","XM",163,0)
 Q
"RTN","XM",164,0)
NU(XMFORCE) ;API for new message display
"RTN","XM",165,0)
 ; XMFORCE  (in) 1=force new display; 0=display only if recent receipt
"RTN","XM",166,0)
 N XMNEW
"RTN","XM",167,0)
 D NUS(XMFORCE,.XMNEW)
"RTN","XM",168,0)
 Q XMNEW
"RTN","XM",169,0)
NUS(XMFORCE,XMNEW) ; new message display
"RTN","XM",170,0)
 ; XMFORCE  (in) 1=force new display; 0=display only if recent receipt
"RTN","XM",171,0)
 ; XMNEW    (out) number of new messages
"RTN","XM",172,0)
 ; XMLAST   last message arrival date (FM format)
"RTN","XM",173,0)
 N XMREC,XMNEW2U,XMLAST
"RTN","XM",174,0)
 S XMDUZ=$G(XMDUZ,DUZ)
"RTN","XM",175,0)
 S XMREC=$$NEWS^XMXUTIL(XMDUZ,$D(DUZ("SAV")))
"RTN","XM",176,0)
 Q:XMREC=-1
"RTN","XM",177,0)
 S XMNEW=$P(XMREC,U,1)
"RTN","XM",178,0)
 I 'XMFORCE,'XMNEW Q
"RTN","XM",179,0)
 S XMLAST=$P(XMREC,U,4)
"RTN","XM",180,0)
 S XMNEW2U=$P(XMREC,U,5)
"RTN","XM",181,0)
 I XMNEW2U!XMFORCE D
"RTN","XM",182,0)
 . N XMPARM,XMDIALOG
"RTN","XM",183,0)
 . S XMPARM(1)=XMNEW
"RTN","XM",184,0)
 . I XMDUZ=DUZ S XMDIALOG=38155
"RTN","XM",185,0)
 . E  S XMDIALOG=38156,XMPARM(2)=$$NAME^XMXUTIL(XMDUZ)
"RTN","XM",186,0)
 . W !,$$EZBLD^DIALOG(XMDIALOG+$S(XMNEW>1:0,'XMNEW:.2,1:.1),.XMPARM) ; You have/|2| has |1|/no new message(s).
"RTN","XM",187,0)
 . Q:'XMNEW
"RTN","XM",188,0)
 . W "  ",$$EZBLD^DIALOG(38158,$$MMDT^XMXUTIL1(XMLAST)) ; (Last arrival: |1|)
"RTN","XM",189,0)
 D:$P(XMREC,U,2) NOTEPRIO
"RTN","XM",190,0)
 Q
"RTN","XM",191,0)
NOTEPRIO ;
"RTN","XM",192,0)
 N XMDIALOG,XMPARM
"RTN","XM",193,0)
 I XMDUZ=DUZ S XMDIALOG=38159 ;You've got PRIORITY Mail!
"RTN","XM",194,0)
 E  S XMDIALOG=38159.1,XMPARM(1)=$$NAME^XMXUTIL(XMDUZ) ;|1| has PRIORITY Mail!
"RTN","XM",195,0)
 D ZIS
"RTN","XM",196,0)
 W $C(7),!!,$G(IORVON),$$EZBLD^DIALOG(XMDIALOG,.XMPARM),!!,$G(IORVOFF)
"RTN","XM",197,0)
 Q
"RTN","XM",198,0)
ZIS ;
"RTN","XM",199,0)
 Q:$D(IORVON)
"RTN","XM",200,0)
 N X
"RTN","XM",201,0)
 S X="IORVON;IORVOFF;IOBON;IOBOFF"
"RTN","XM",202,0)
 D ENDR^%ZISS
"RTN","XM",203,0)
 Q
"RTN","XM",204,0)
NEWMBOX ; Create a mailbox for a user
"RTN","XM",205,0)
 N DIC,XMZ
"RTN","XM",206,0)
 D MSG(38165)
"RTN","XM",207,0)
 ;Ready to create a mailbox for a user.
"RTN","XM",208,0)
 ;You will only be able to select a user who does not already have a mailbox.
"RTN","XM",209,0)
 S DIC="^VA(200,"
"RTN","XM",210,0)
 S DIC(0)="AEQM"
"RTN","XM",211,0)
 S DIC("S")="I '$D(^XMB(3.7,Y,0))"
"RTN","XM",212,0)
 D ^DIC Q:Y=-1
"RTN","XM",213,0)
 S Y=+Y
"RTN","XM",214,0)
 D NEW
"RTN","XM",215,0)
 W !,$$EZBLD^DIALOG(38165.1) ; Mailbox created.
"RTN","XM",216,0)
 Q
"RTN","XM",217,0)
N1 S Y=XMDUZ
"RTN","XM",218,0)
NEW ; CREATE MAILBOX 4 NEW USER
"RTN","XM",219,0)
N L +^XMB(3.7,0):0 E  H 1 G N
"RTN","XM",220,0)
 D CRE8MBOX^XMXMBOX(Y,$S($D(XMZ):DT,1:""))
"RTN","XM",221,0)
 L -^XMB(3.7,0)
"RTN","XM",222,0)
 D:$D(XMERR) SHOW^XMJERR
"RTN","XM",223,0)
 Q
"RTN","XM",224,0)
KILL ;
"RTN","XM",225,0)
CLEANUP ;
"RTN","XM",226,0)
 K XMV,XMDISPI,XMDUN,XMDUZ,XMPRIV,XMNOSEND,XMERR
"RTN","XM",227,0)
 K:$D(^TMP("XMERR",$J)) ^TMP("XMERR",$J)
"RTN","XM",228,0)
 D KILLALL
"RTN","XM",229,0)
 D UNLOCK
"RTN","XM",230,0)
 Q
"RTN","XM",231,0)
KILLALL ;All variables except XMDISPI,XMDUZ,XMDUN and XMPRIV are killed here on
"RTN","XM",232,0)
 ;exit from the MailMan package or by calls to this code.
"RTN","XM",233,0)
 K A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,V,W,X,Z,%,%0,%1,%2,%3,%4
"RTN","XM",234,0)
 K XM,XMA,XMA0,XMAPBLOB,XMB,XMB0
"RTN","XM",235,0)
 K XMC,XMC0,XMCH,XMCI,XMCL,XMCNT,XMCT
"RTN","XM",236,0)
 K XMD,XMD0,XMDATE,XMDI,XMDT,XME,XME0,XMF,XMF0,XMG,XMG0
"RTN","XM",237,0)
 K XMK,XMKM,XMKN,XMI,XMJ
"RTN","XM",238,0)
 K XML,XMLOAD,XMLOC,XMLOCK,XMM,XMMG,XMN,XMOUT,XMP
"RTN","XM",239,0)
 K XMR,XMRES,XMS,XMSEN,XMSUB
"RTN","XM",240,0)
 K XMT,XMTYPE,XMU,XMY,XMZ,XMZ1,XMZ2
"RTN","XM",241,0)
 Q
"RTN","XM",242,0)
DSP ;
"RTN","XM",243,0)
 D INIT^XMVVITAE
"RTN","XM",244,0)
 Q
"RTN","XM",245,0)
OPTIONS ; Set up options
"RTN","XM",246,0)
 N DIK,I,X
"RTN","XM",247,0)
 K ^DOPT("XM")
"RTN","XM",248,0)
 S DIK="^DOPT(""XM"","
"RTN","XM",249,0)
 S ^DOPT("XM",0)="MailMan Option^1N^"
"RTN","XM",250,0)
 F I=1:1 S X=$P($T(T+I)," ",1,3) Q:X=" ;;"  S X=$E(X,4,255),^DOPT("XM",I,0)=$$UP^XLFSTR($$EZBLD^DIALOG(+X))_U_$P(X,U,2,3)
"RTN","XM",251,0)
 D IXALL^DIK
"RTN","XM",252,0)
 Q
"RTN","XM",253,0)
T ;;TABLE
"RTN","XM",254,0)
 ;;38170^D SEND^XMJMS        ; SEND A MESSAGE
"RTN","XM",255,0)
 ;;38171^D MANAGE^XMJBM      ; READ/MANAGE MESSAGES
"RTN","XM",256,0)
 ;;38172^D NEW^XMJBN         ; NEW MESSAGES AND RESPONSES
"RTN","XM",257,0)
 ;;38173^D PAKMAN^XMJMS      ; LOAD PACKMAN MESSAGE
"RTN","XM",258,0)
 ;;38174^D EDIT^XMVVITA      ; EDIT USER OPTIONS
"RTN","XM",259,0)
 ;;38175^D PERSONAL^XMVGROUP ; PERSONAL MAIL GROUP EDIT
"RTN","XM",260,0)
 ;;38176^D ENROLL^XMVGROUP   ; JOIN MAIL GROUP
"RTN","XM",261,0)
 ;;38177^D LISTMBOX^XMJBL    ; MAILBOX CONTENTS LIST
"RTN","XM",262,0)
 ;;38178^D TALK^XMC          ; LOG-IN TO ANOTHER SYSTEM (TalkMan)
"RTN","XM",263,0)
 ;;38179^D FIND^XMJMF        ; QUERY/SEARCH FOR MESSAGES
"RTN","XM",264,0)
 ;;
"RTN","XM",265,0)
 ;;**OBSOLETE**
"RTN","XM",266,0)
 ;;BLOB SEND^D BLOB^XMA2B
"RTN","XM",267,0)
 ;;
"RTN","XM0")
1^100
"RTN","XMA")
0^239^B263445
"RTN","XMA",1,0)
XMA ;ISC-SF/GMB-Read Mail API ;04/17/2002  07:08
"RTN","XMA",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMA",3,0)
 ; Was (WASH ISC)/THM/CAP
"RTN","XMA",4,0)
 ;
"RTN","XMA",5,0)
 ; Entry points (DBIA 1284):
"RTN","XMA",6,0)
 ; REC    Read Mail
"RTN","XMA",7,0)
 ;
"RTN","XMA",8,0)
REC ; Read (Manage) Mail
"RTN","XMA",9,0)
 ; All input variables ignored
"RTN","XMA",10,0)
 I '$G(DUZ) W !,$C(7),$$EZBLD^DIALOG(38105) Q  ;You do not have a DUZ.
"RTN","XMA",11,0)
 D EN^XM,MANAGE^XMJBM
"RTN","XMA",12,0)
 Q
"RTN","XMA",13,0)
NNEW Q
"RTN","XMA0")
0^240^B1015526
"RTN","XMA0",1,0)
XMA0 ;ISC-SF/GMB-Print Message APIs ;04/17/2002  07:08
"RTN","XMA0",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMA0",3,0)
 ; Was (WASH ISC)/CAP/THM
"RTN","XMA0",4,0)
 ;
"RTN","XMA0",5,0)
 ; Entry points (DBIA 1230):
"RTN","XMA0",6,0)
 ; ENTPRT  Print a message (interactive)
"RTN","XMA0",7,0)
 ; HDR     Print a message (headerless)
"RTN","XMA0",8,0)
 ; PR2     Print a message
"RTN","XMA0",9,0)
 ;
"RTN","XMA0",10,0)
ENTPRT ; Print a message (interactive)
"RTN","XMA0",11,0)
 ; Needs:
"RTN","XMA0",12,0)
 ; DUZ
"RTN","XMA0",13,0)
 ; XMZ  Message number
"RTN","XMA0",14,0)
 ; XMK  Basket number
"RTN","XMA0",15,0)
 N XMV
"RTN","XMA0",16,0)
 D INITAPI^XMVVITAE
"RTN","XMA0",17,0)
 D PRINT^XMJMP(XMDUZ,XMK,XMZ)
"RTN","XMA0",18,0)
 Q
"RTN","XMA0",19,0)
HDR ; Print a message (headerless)
"RTN","XMA0",20,0)
 ; Needs:
"RTN","XMA0",21,0)
 ; DUZ
"RTN","XMA0",22,0)
 ; XMK    basket number
"RTN","XMA0",23,0)
 ; XMZ    message number
"RTN","XMA0",24,0)
 ; IO     output device
"RTN","XMA0",25,0)
 ; Optional:
"RTN","XMA0",26,0)
 ; XMDUZ
"RTN","XMA0",27,0)
 ; $P(XMTYPE,";",6) response from which to start printing
"RTN","XMA0",28,0)
 D PRINTIT(0,$G(XMTYPE))
"RTN","XMA0",29,0)
 Q
"RTN","XMA0",30,0)
PR2 ; Print a message
"RTN","XMA0",31,0)
 ; Needs:
"RTN","XMA0",32,0)
 ; DUZ
"RTN","XMA0",33,0)
 ; XMK    basket number
"RTN","XMA0",34,0)
 ; XMZ    message number
"RTN","XMA0",35,0)
 ; IO     output device
"RTN","XMA0",36,0)
 ; Optional:
"RTN","XMA0",37,0)
 ; XMDUZ
"RTN","XMA0",38,0)
 ; $P(XMTYPE,";",6) response from which to start printing
"RTN","XMA0",39,0)
 D PRINTIT(1,$G(XMTYPE))
"RTN","XMA0",40,0)
 Q
"RTN","XMA0",41,0)
PRINTIT(XMPRTHDR,XMTYPE) ;
"RTN","XMA0",42,0)
 N XMV,XMWHICH
"RTN","XMA0",43,0)
 Q:XMTYPE=U
"RTN","XMA0",44,0)
 D INITAPI^XMVVITAE
"RTN","XMA0",45,0)
 S XMWHICH=+$P(XMTYPE,";",6)_"-"  ; print from
"RTN","XMA0",46,0)
 D PRTMSG^XMJMP(XMDUZ,XMK,XMZ,XMWHICH,0,XMPRTHDR)
"RTN","XMA0",47,0)
 Q
"RTN","XMA01")
1^101
"RTN","XMA02")
1^102
"RTN","XMA03")
0^241^B121737
"RTN","XMA03",1,0)
XMA03 ;ISC-SF/GMB-Resequence messages API ;04/17/2002  07:08
"RTN","XMA03",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMA03",3,0)
 ; Was (WASH ISC)/CAP/THM
"RTN","XMA03",4,0)
 ;
"RTN","XMA03",5,0)
 ; Entry points (DBIA 1150):
"RTN","XMA03",6,0)
 ; $$REN  Resequence messages in a user's basket
"RTN","XMA03",7,0)
 ;
"RTN","XMA03",8,0)
REN(XMDUZ,XMK) ;API entry for Renumbering Mail Basket
"RTN","XMA03",9,0)
 ; XMDUZ  User's DUZ
"RTN","XMA03",10,0)
 ; XMK    Basket number
"RTN","XMA03",11,0)
 N XMMSG
"RTN","XMA03",12,0)
 D RSEQBSKT^XMXAPIB(XMDUZ,XMK,.XMMSG)
"RTN","XMA03",13,0)
 Q $G(XMMSG)
"RTN","XMA0A")
1^103
"RTN","XMA1")
1^104
"RTN","XMA10")
1^105
"RTN","XMA11")
0^242^B41447
"RTN","XMA11",1,0)
XMA11 ;(WASH ISC)/CAP/THM-Edit message info only ;04/17/2002  07:09
"RTN","XMA11",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMA11",3,0)
 ;
"RTN","XMA11",4,0)
 ; Entry point (DBIA ?):
"RTN","XMA11",5,0)
 ; INFO   Interactive change a message's 'information only' field.
"RTN","XMA11",6,0)
INFO(DA) ; Change Information Only Status
"RTN","XMA11",7,0)
 N DIE,DR
"RTN","XMA11",8,0)
 S DIE=3.9,DR="1.97"
"RTN","XMA11",9,0)
 D ^DIE
"RTN","XMA11",10,0)
 Q 0
"RTN","XMA11A")
0^243^B562876
"RTN","XMA11A",1,0)
XMA11A ;ISC-SF/GMB-Send/Answer a Message API ;04/18/2002  07:24
"RTN","XMA11A",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMA11A",3,0)
 ; Was (WASH ISC)/CAP/THM
"RTN","XMA11A",4,0)
 ;
"RTN","XMA11A",5,0)
 ; Entry points (DBIA 1233):
"RTN","XMA11A",6,0)
 ; WRITE  Send a message or Answer a message
"RTN","XMA11A",7,0)
 ;
"RTN","XMA11A",8,0)
WRITE ; Send a message or Answer a message
"RTN","XMA11A",9,0)
 ; Needs:
"RTN","XMA11A",10,0)
 ; XMDUZ  user number
"RTN","XMA11A",11,0)
 ; X      if $E(X)="A", then send an answer, else send a message
"RTN","XMA11A",12,0)
 ; XMZ    original message number, if we are sending an answer
"RTN","XMA11A",13,0)
 N XMV
"RTN","XMA11A",14,0)
 D INITAPI^XMVVITAE
"RTN","XMA11A",15,0)
 I $E(X)'="A" D SEND^XMJMS Q
"RTN","XMA11A",16,0)
 N XMZREC
"RTN","XMA11A",17,0)
 S XMZREC=^XMB(3.9,XMZ,0)
"RTN","XMA11A",18,0)
 K XMERR,^TMP("XMERR",$J)
"RTN","XMA11A",19,0)
 I '$$ANSWER^XMXSEC(XMDUZ,XMZ,XMZREC) D SHOW^XMJERR Q
"RTN","XMA11A",20,0)
 D ANSWER^XMJMA(XMDUZ,XMZ,$P(XMZREC,U,1),$P(XMZREC,U,2))
"RTN","XMA11A",21,0)
 Q
"RTN","XMA11B")
1^106
"RTN","XMA1A")
1^107
"RTN","XMA1B")
0^244^B1589781
"RTN","XMA1B",1,0)
XMA1B ;ISC-SF/GMB-Save/Delete Message APIs ;04/17/2002  07:09
"RTN","XMA1B",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMA1B",3,0)
 ; Was (WASH ISC)/CAP/THM
"RTN","XMA1B",4,0)
 ;
"RTN","XMA1B",5,0)
 ; Entry points (DBIA 10065):
"RTN","XMA1B",6,0)
 ; KL    Delete a message from a basket
"RTN","XMA1B",7,0)
 ; KLQ   Delete a message from a basket and put it in the WASTE basket.
"RTN","XMA1B",8,0)
 ; S2    Put a message in a basket
"RTN","XMA1B",9,0)
 ;
"RTN","XMA1B",10,0)
KL ; Delete a message from a basket
"RTN","XMA1B",11,0)
 ; In:
"RTN","XMA1B",12,0)
 ; XMDUZ  User's DUZ
"RTN","XMA1B",13,0)
 ; XMK    Basket number (optional)
"RTN","XMA1B",14,0)
 ; XMZ    Message number
"RTN","XMA1B",15,0)
 I '$D(XMK) S XMK=$O(^XMB(3.7,"M",XMZ,XMDUZ,0)) Q:'XMK
"RTN","XMA1B",16,0)
 I XMK,'$D(^XMB(3.7,XMDUZ,2,XMK,1,XMZ,0)) S XMK=$O(^XMB(3.7,"M",XMZ,XMDUZ,0)) Q:'XMK
"RTN","XMA1B",17,0)
 D ZAPIT^XMXMSGS2(XMDUZ,XMK,XMZ)
"RTN","XMA1B",18,0)
 Q
"RTN","XMA1B",19,0)
KLQ ; Delete a message from a basket AND put it in waste basket
"RTN","XMA1B",20,0)
 ; In:
"RTN","XMA1B",21,0)
 ; XMDUZ  User's DUZ
"RTN","XMA1B",22,0)
 ; XMK    Basket number (optional)
"RTN","XMA1B",23,0)
 ; XMZ    Message number
"RTN","XMA1B",24,0)
 D KL Q:XMK=.5
"RTN","XMA1B",25,0)
 S XMKM=.5
"RTN","XMA1B",26,0)
 ; Fall through to S2
"RTN","XMA1B",27,0)
S2 ; Put a message in a basket.
"RTN","XMA1B",28,0)
 ; In:
"RTN","XMA1B",29,0)
 ; XMDUZ   User's DUZ
"RTN","XMA1B",30,0)
 ; XMKM    Basket number
"RTN","XMA1B",31,0)
 ; XMZ     Message number
"RTN","XMA1B",32,0)
 N XMK,XMKN
"RTN","XMA1B",33,0)
 K XMERR,^TMP("XMERR",$J)
"RTN","XMA1B",34,0)
 S XMK=$$XMK^XMXPARM(XMDUZ,"XMKM",.XMKM)
"RTN","XMA1B",35,0)
 I $D(XMERR) K XMERR,^TMP("XMERR",$J) Q
"RTN","XMA1B",36,0)
 I XMK>1 S XMKN=$P(^XMB(3.7,XMDUZ,2,XMK,0),U,1)
"RTN","XMA1B",37,0)
 E  S XMKN=$$EZBLD^DIALOG($S(XMK=.5:37004,1:37005)) ; WASTE / IN
"RTN","XMA1B",38,0)
 D PUTMSG^XMXMSGS2(XMDUZ,XMK,XMKN,XMZ)
"RTN","XMA1B",39,0)
 K XMKM
"RTN","XMA1B",40,0)
 Q
"RTN","XMA1C")
0^245^B259410
"RTN","XMA1C",1,0)
XMA1C ;ISC-SF/GMB-Server Basket APIs ;04/17/2002  07:10
"RTN","XMA1C",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMA1C",3,0)
 ; Was (WASH ISC)/ACC/IHS
"RTN","XMA1C",4,0)
 ;
"RTN","XMA1C",5,0)
 ; Entry points (DBIA 10072):
"RTN","XMA1C",6,0)
 ; REMSBMSG  Remove a message from a server basket
"RTN","XMA1C",7,0)
 ; SETSB     Put a message in a server basket
"RTN","XMA1C",8,0)
 ;
"RTN","XMA1C",9,0)
SETSB ; Put a message in a server basket
"RTN","XMA1C",10,0)
 ; (Create mail basket for server under postmaster as needed)
"RTN","XMA1C",11,0)
 ; In:
"RTN","XMA1C",12,0)
 ; XMXX  Server Name (full name, starting with 'S.')
"RTN","XMA1C",13,0)
 ; XMZ   Message Number
"RTN","XMA1C",14,0)
 ;Messages to server are saved in a mail basket of the
"RTN","XMA1C",15,0)
 ;Postmaster much like transmission queues.  But while
"RTN","XMA1C",16,0)
 ;Domain queues point at the domain file (domain#+1000),
"RTN","XMA1C",17,0)
 ;Server baskets point at the option file (option#+10000).
"RTN","XMA1C",18,0)
 D PUTSERV^XMXMSGS1(XMXX,XMZ)
"RTN","XMA1C",19,0)
 Q
"RTN","XMA1C",20,0)
REMSBMSG ; Remove a message from a server basket
"RTN","XMA1C",21,0)
 ; In:
"RTN","XMA1C",22,0)
 ; XMSER  Server Name (full name, starting with 'S.')
"RTN","XMA1C",23,0)
 ; XMZ    Message number
"RTN","XMA1C",24,0)
 D ZAPSERV^XMXMSGS1(XMSER,XMZ)
"RTN","XMA1C",25,0)
 K XMKD,XMZ,XMDUZ,XMK,XMSER
"RTN","XMA1C",26,0)
 Q
"RTN","XMA1E")
1^108
"RTN","XMA2")
0^384^B2966133
"RTN","XMA2",1,0)
XMA2 ;ISC-SF/GMB-Create Message Stub API ;04/19/2002  12:35
"RTN","XMA2",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMA2",3,0)
 ; Was (WASH ISC)/CAP/THM
"RTN","XMA2",4,0)
 ;
"RTN","XMA2",5,0)
 ; Entry points (DBIA 10066):
"RTN","XMA2",6,0)
 ; GET  get a message number
"RTN","XMA2",7,0)
 ; XMZ  get a message number
"RTN","XMA2",8,0)
XMZ ; Create stub/return error
"RTN","XMA2",9,0)
 ; In:
"RTN","XMA2",10,0)
 ; XMDUZ  User's DUZ or free text
"RTN","XMA2",11,0)
 ; XMSUB  Message subject
"RTN","XMA2",12,0)
 ; Out:
"RTN","XMA2",13,0)
 ; XMZ    Message number (-1 if error)
"RTN","XMA2",14,0)
 D MAKESTUB($G(XMDUZ),XMSUB,.XMZ,1)
"RTN","XMA2",15,0)
 Q
"RTN","XMA2",16,0)
GET ; Create stub
"RTN","XMA2",17,0)
 ; In:
"RTN","XMA2",18,0)
 ; XMDUZ  User's DUZ or free text
"RTN","XMA2",19,0)
 ; XMSUB  Message subject
"RTN","XMA2",20,0)
 ; Out:
"RTN","XMA2",21,0)
 ; XMZ    Message number (HALT if error)
"RTN","XMA2",22,0)
 D MAKESTUB($G(XMDUZ),XMSUB,.XMZ)
"RTN","XMA2",23,0)
 Q
"RTN","XMA2",24,0)
MAKESTUB(XMDUZ,XMSUBJ,XMZ,XMRETURN) ;
"RTN","XMA2",25,0)
 N XMZREC,XMSENDR
"RTN","XMA2",26,0)
 I '$G(DUZ) N DUZ D DUZ^XUP(.5)
"RTN","XMA2",27,0)
 I XMDUZ=0!(XMDUZ="") S XMDUZ=DUZ
"RTN","XMA2",28,0)
 I $L(XMSUBJ)>65 S XMSUBJ=$E(XMSUBJ,1,65)
"RTN","XMA2",29,0)
 I $L(XMSUBJ)<3 S XMSUBJ=XMSUBJ_"..."
"RTN","XMA2",30,0)
 D VSUBJ^XMXPARM(.XMSUBJ)
"RTN","XMA2",31,0)
 I $D(XMERR) D  Q
"RTN","XMA2",32,0)
 . S XMZ=-1
"RTN","XMA2",33,0)
 . D:'$D(ZTQUEUED) SHOW^XMJERR
"RTN","XMA2",34,0)
 . I '$G(XMRETURN) G ABORT
"RTN","XMA2",35,0)
 D CRE8XMZ^XMXSEND(XMSUBJ,.XMZ,1)
"RTN","XMA2",36,0)
 I XMZ<1 D  Q
"RTN","XMA2",37,0)
 . I '$G(XMRETURN) G ABORT
"RTN","XMA2",38,0)
 . K XMERR,^TMP("XMERR",$J)
"RTN","XMA2",39,0)
 S XMZREC=^XMB(3.9,XMZ,0)
"RTN","XMA2",40,0)
 I XMDUZ=.6 S XMDUZ=DUZ,XMSENDR=.6
"RTN","XMA2",41,0)
 E  S XMSENDR=DUZ
"RTN","XMA2",42,0)
 I XMDUZ=.5,XMSENDR'=.5 S $P(XMZREC,U,12)="y" ;Info Only / sent by Postmaster
"RTN","XMA2",43,0)
 S $P(XMZREC,U,2,4)=XMDUZ_U_$$NOW^XLFDT()_U_$S(XMDUZ'=XMSENDR&+XMDUZ:XMSENDR,1:"")
"RTN","XMA2",44,0)
 S ^XMB(3.9,XMZ,0)=XMZREC
"RTN","XMA2",45,0)
 Q
"RTN","XMA2",46,0)
ABORT ;
"RTN","XMA2",47,0)
 S X=^TMP("XMERR",$J,1,"TEXT",1)
"RTN","XMA2",48,0)
 K XMERR,^TMP("XMERR",$J)
"RTN","XMA2",49,0)
 X X
"RTN","XMA2",50,0)
 Q
"RTN","XMA20")
1^109
"RTN","XMA21")
0^385^B12959406
"RTN","XMA21",1,0)
XMA21 ;ISC-SF/GMB-Address lookup APIs ;04/17/2002  07:12
"RTN","XMA21",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMA21",3,0)
 ; Was (WASH ISC)/CAP
"RTN","XMA21",4,0)
 ;
"RTN","XMA21",5,0)
 ; Entry points (DBIA 10067):
"RTN","XMA21",6,0)
 ; CHK   Check to see if a user is a member of a mail group.
"RTN","XMA21",7,0)
 ; DES   Interactive addressing.  Set next default recipient.
"RTN","XMA21",8,0)
 ; DEST  Interactive addressing.  Set first default recipient.
"RTN","XMA21",9,0)
 ; INST  Non-interactive addressing. (Same as WHO)
"RTN","XMA21",10,0)
 ; WHO   Non-interactive addressing.
"RTN","XMA21",11,0)
 ;
"RTN","XMA21",12,0)
 ; Entry points used by MailMan options (not covered by DBIA):
"RTN","XMA21",13,0)
 ; DX    XMDXNAME - Test name resolution (interactive)
"RTN","XMA21",14,0)
 ;
"RTN","XMA21",15,0)
CHK ; Check to see if a user is a member of a mail group.
"RTN","XMA21",16,0)
 ; Sets $T if member.
"RTN","XMA21",17,0)
 ; Needs:
"RTN","XMA21",18,0)
 ; XMDUZ  DUZ of the user
"RTN","XMA21",19,0)
 ; Y      IEN of the mail group
"RTN","XMA21",20,0)
 I $D(^XMB(3.8,Y,1,"B",XMDUZ)) Q
"RTN","XMA21",21,0)
 Q
"RTN","XMA21",22,0)
DX ;
"RTN","XMA21",23,0)
 N XMINSTR,XMV,XMABORT
"RTN","XMA21",24,0)
 D INITAPI^XMVVITAE
"RTN","XMA21",25,0)
 S XMABORT=0
"RTN","XMA21",26,0)
 D INIT^XMXADDR
"RTN","XMA21",27,0)
 D TOWHOM^XMJMT(XMDUZ,$$EZBLD^DIALOG(34110),.XMINSTR,"",XMABORT) ;Send
"RTN","XMA21",28,0)
 D CLEANUP^XMXADDR
"RTN","XMA21",29,0)
 Q
"RTN","XMA21",30,0)
DES ; Interactive addressing.  Set next default recipient.
"RTN","XMA21",31,0)
 ; XMY is not killed upon entry.
"RTN","XMA21",32,0)
 ; Needs:
"RTN","XMA21",33,0)
 ; XMMG    Next default recipient
"RTN","XMA21",34,0)
 ; See entry point TO for other needs and outputs associated with
"RTN","XMA21",35,0)
 ; this entry point.
"RTN","XMA21",36,0)
 D TO(.XMMG)
"RTN","XMA21",37,0)
 Q
"RTN","XMA21",38,0)
DEST ; Interactive addressing.  Set first default recipient.
"RTN","XMA21",39,0)
 ; XMY is killed upon entry.
"RTN","XMA21",40,0)
 ; Needs:
"RTN","XMA21",41,0)
 ; XMDUN   First default recipient
"RTN","XMA21",42,0)
 ; See entry point TO for other needs and outputs associated with
"RTN","XMA21",43,0)
 ; this entry point.
"RTN","XMA21",44,0)
 K XMY
"RTN","XMA21",45,0)
 D TO(XMDUN)
"RTN","XMA21",46,0)
 Q
"RTN","XMA21",47,0)
TO(XMTO) ;
"RTN","XMA21",48,0)
 ; Entry points DES and DEST also Need:
"RTN","XMA21",49,0)
 ; XMDUZ   DUZ of user
"RTN","XMA21",50,0)
 ; XMDF    if $D(XMDF) then do not restrict addressees
"RTN","XMA21",51,0)
 ; Output:
"RTN","XMA21",52,0)
 ; XMY(    Array of addressees:  XMY(addressee)=""
"RTN","XMA21",53,0)
 ; XMOUT   if $D(XMOUT) user aborted addressing
"RTN","XMA21",54,0)
 ; X       if X="^" user aborted addressing, else X=""
"RTN","XMA21",55,0)
 N XMV,XMINSTR,XMABORT,XMDUN
"RTN","XMA21",56,0)
 S XMABORT=0
"RTN","XMA21",57,0)
 I XMDUZ'>0 N XMDUZ S XMDUZ=DUZ
"RTN","XMA21",58,0)
 D INITAPI^XMVVITAE
"RTN","XMA21",59,0)
 I $D(XMDF) S XMINSTR("ADDR FLAGS")="R" ; No addressee restrictions
"RTN","XMA21",60,0)
 I $D(XMTO) S XMINSTR("TO PROMPT")=XMTO
"RTN","XMA21",61,0)
 D INIT^XMXADDR
"RTN","XMA21",62,0)
 D TOWHOM^XMJMT(XMDUZ,$$EZBLD^DIALOG(34110),.XMINSTR,"",.XMABORT) ;Send
"RTN","XMA21",63,0)
 I XMABORT D  Q
"RTN","XMA21",64,0)
 . S XMOUT=1,X=U
"RTN","XMA21",65,0)
 . D CLEANUP^XMXADDR
"RTN","XMA21",66,0)
 K XMOUT
"RTN","XMA21",67,0)
 S X=""
"RTN","XMA21",68,0)
 D SW
"RTN","XMA21",69,0)
 I $D(XMINSTR("SELF BSKT")) S XMY(XMDUZ,0)=XMINSTR("SELF BSKT")
"RTN","XMA21",70,0)
 I $D(XMINSTR("SHARE BSKT")) S XMY(.6,0)=XMINSTR("SHARE BSKT")
"RTN","XMA21",71,0)
 I $D(XMINSTR("SHARE DATE")) S XMY(.6,"D")=XMINSTR("SHARE DATE")
"RTN","XMA21",72,0)
 D CLEANUP^XMXADDR
"RTN","XMA21",73,0)
 Q
"RTN","XMA21",74,0)
SW ;
"RTN","XMA21",75,0)
 N %X,%Y
"RTN","XMA21",76,0)
 S %X="^TMP(""XMY"","_$J_",",%Y="XMY(" D %XY^%RCR
"RTN","XMA21",77,0)
 Q
"RTN","XMA21",78,0)
INST ; Non-interactive addressing (Just fall thru to WHO)
"RTN","XMA21",79,0)
WHO ; Non-interactive addressing
"RTN","XMA21",80,0)
 ; Needs:
"RTN","XMA21",81,0)
 ; XMDUZ user's DUZ
"RTN","XMA21",82,0)
 ; X     local or remote address
"RTN","XMA21",83,0)
 ;       (-X will remove address)
"RTN","XMA21",84,0)
 ; XMDF  if $D(XMDF) then do not restrict addressees
"RTN","XMA21",85,0)
 ; XMLOC if $D(XMLOC), forces output of XMMG error message if error
"RTN","XMA21",86,0)
 ; Output:
"RTN","XMA21",87,0)
 ; XMY   address: XMY(address)=""
"RTN","XMA21",88,0)
 ; Y     if Y=-1, then lookup has failed
"RTN","XMA21",89,0)
 ;       = <DUZ^full name> if local addressee
"RTN","XMA21",90,0)
 ;       = <domain ien^domain name> if remote addressee
"RTN","XMA21",91,0)
 ; XMMG  contains error message if Y=-1
"RTN","XMA21",92,0)
 ;       = "" if local addressee
"RTN","XMA21",93,0)
 ;       = via domain message if remote addressee
"RTN","XMA21",94,0)
 N XMV,XMINSTR,XMSTRIKE
"RTN","XMA21",95,0)
 I XMDUZ'>0 N XMDUZ S XMDUZ=DUZ
"RTN","XMA21",96,0)
 D INITAPI^XMVVITAE
"RTN","XMA21",97,0)
 I $D(XMDF) S XMINSTR("ADDR FLAGS")="R" ; No addressee restrictions
"RTN","XMA21",98,0)
 D INIT^XMXADDR
"RTN","XMA21",99,0)
 I $E(X)="-" S XMSTRIKE=1,X=$E(X,2,99)
"RTN","XMA21",100,0)
 K XMERR,^TMP("XMERR",$J)
"RTN","XMA21",101,0)
 D CHKADDR^XMXADDR(XMDUZ,X,.XMINSTR,"",.Y)
"RTN","XMA21",102,0)
 I $D(XMERR) D  Q
"RTN","XMA21",103,0)
 . S XMMG=^TMP("XMERR",$J,1,"TEXT",1)
"RTN","XMA21",104,0)
 . K XMERR,^TMP("XMERR",$J)
"RTN","XMA21",105,0)
 . S Y=-1
"RTN","XMA21",106,0)
 . I $D(XMLOC) W "  ",XMMG
"RTN","XMA21",107,0)
 . D CLEANUP^XMXADDR
"RTN","XMA21",108,0)
 I $G(XMSTRIKE) D  Q
"RTN","XMA21",109,0)
 . N XMADDR
"RTN","XMA21",110,0)
 . S X=Y
"RTN","XMA21",111,0)
 . S XMADDR=""
"RTN","XMA21",112,0)
 . F  S XMADDR=$O(^TMP("XMY",$J,XMADDR)) Q:XMADDR=""  K XMY(XMADDR)
"RTN","XMA21",113,0)
 . S XMMG=""
"RTN","XMA21",114,0)
 . D CLEANUP^XMXADDR
"RTN","XMA21",115,0)
 I Y["@" D  Q
"RTN","XMA21",116,0)
 . N XMIEN
"RTN","XMA21",117,0)
 . S XMIEN=^TMP("XMY",$J,Y)  ; IEN
"RTN","XMA21",118,0)
 . S XMY(Y)=XMIEN
"RTN","XMA21",119,0)
 . S X=$P(Y,"@",2)
"RTN","XMA21",120,0)
 . S Y=XMIEN_U_$P(^DIC(4.2,XMIEN,0),U,1)
"RTN","XMA21",121,0)
 . S XMMG="via "_$P(Y,U,2)
"RTN","XMA21",122,0)
 . D CLEANUP^XMXADDR
"RTN","XMA21",123,0)
 D SW
"RTN","XMA21",124,0)
 I $E(X,1,2)="G." D
"RTN","XMA21",125,0)
 . S X=$E(Y,3,99)
"RTN","XMA21",126,0)
 . S Y=$O(^XMB(3.8,"B",X,0))_U_X  ; ien^mail group name
"RTN","XMA21",127,0)
 E  I $L(X>2),".D.H.S."[("."_$E(X,1,2)) D
"RTN","XMA21",128,0)
 . S X=$E(Y,3,99)
"RTN","XMA21",129,0)
 . S Y=XMY(Y)_U_X  ; ien^full name
"RTN","XMA21",130,0)
 E  D
"RTN","XMA21",131,0)
 . S X=Y ; full name
"RTN","XMA21",132,0)
 . S Y=$O(XMY(""))_U_Y  ; duz^full name
"RTN","XMA21",133,0)
 S XMMG=""
"RTN","XMA21",134,0)
 D CLEANUP^XMXADDR
"RTN","XMA21",135,0)
 Q
"RTN","XMA210")
1^110
"RTN","XMA21A")
1^111
"RTN","XMA21B")
1^112
"RTN","XMA21C")
0^386^B8010998
"RTN","XMA21C",1,0)
XMA21C ;(WASH ISC)/CAP- Input Transform (3.7,.3) Mail Name ;04/17/2002  07:14
"RTN","XMA21C",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMA21C",3,0)
 ;
"RTN","XMA21C",4,0)
 ;Input transform for field .3 in file 3.7 (Mail Name)
"RTN","XMA21C",5,0)
MNAME ;Change to all upper case
"RTN","XMA21C",6,0)
 I '$D(XMDUZ) N XMDUZ S XMDUZ=DUZ
"RTN","XMA21C",7,0)
 S X=$$UP^XLFSTR(X)
"RTN","XMA21C",8,0)
 I $L(X)<7!($L(X)>30) S %="Name cannot be "_$S($L(X)<7:"LESS THAN 7",1:"GREATER THAN 30")_" characters long." G QQ
"RTN","XMA21C",9,0)
 I X'?1.AN1"."1.AN1".".E,X'?1.AN,X'?1.AN1"."1.AN S %="Name must not contain punctuation other than a '.' and a maximum of two '.'s." G QQ
"RTN","XMA21C",10,0)
 ;
"RTN","XMA21C",11,0)
 L +^XMB(3.7,"C",X):1 E  Q:$D(ZTQUEUED)!$D(XMCHAN)  S %="Please try again, Some one else is enterring a mail name." G QQ
"RTN","XMA21C",12,0)
 ;
"RTN","XMA21C",13,0)
 ;Check if unique / inform user...
"RTN","XMA21C",14,0)
 I $D(^XMB(3.7,"C",X)) S %=$C(7)_"  >> Already in use" G QQ
"RTN","XMA21C",15,0)
 N % S %=$O(^XMB(3.7,"C",X)) I $E(%,1,$L(X))=X S %=$C(7)_"  >> This name is not unique -- it is a partial match to another name" G QQ
"RTN","XMA21C",16,0)
 ;
"RTN","XMA21C",17,0)
 ;Test if Name Server can find it elsewhere
"RTN","XMA21C",18,0)
 K XMY N XMA21C S XMA21C=X D WHO^XMA21 I $L($O(XMY(""))) S %="The string '"_XMA21C_"' identifies someone else." K XMY G QQ
"RTN","XMA21C",19,0)
 ;
"RTN","XMA21C",20,0)
 ;Put into x-ref so it cannot be used immediately
"RTN","XMA21C",21,0)
 S ^XMB(3.7,"C",X,XMDUZ)=""
"RTN","XMA21C",22,0)
 ;
"RTN","XMA21C",23,0)
 G Q
"RTN","XMA21C",24,0)
QQ D Q K X Q:$D(ZTQUEUED)!$D(XMCHAN)  W !!,$C(7),%,!! Q
"RTN","XMA21C",25,0)
Q L -^XMB(3.7,"C",X) Q
"RTN","XMA21C",26,0)
 ;
"RTN","XMA21C",27,0)
 ;EXECUTABLE HELP
"RTN","XMA21C",28,0)
HELP W !!,"Mail names are used as return addresses when you send a message to someone"
"RTN","XMA21C",29,0)
 W !,"whose mail box is in a different mail environment.  It could be different"
"RTN","XMA21C",30,0)
 W !,"machines in the same facility, an entirely separate facility or simply a"
"RTN","XMA21C",31,0)
 W !,"different configuration (or UCI) on the same machine."
"RTN","XMA21C",32,0)
 W !!,"The valid format for a mail name is one that is acceptable to all"
"RTN","XMA21C",33,0)
 W !,"mail systems.  It is therefore between 7 and 30 characters long, and"
"RTN","XMA21C",34,0)
 W !,"contains no punction other than periods.  It may contain up to two (2)"
"RTN","XMA21C",35,0)
 W !,"periods each of which must be preceeded and succeeded with at least"
"RTN","XMA21C",36,0)
 W !,"one alpha or numeric character."
"RTN","XMA21C",37,0)
 Q
"RTN","XMA21FWD")
1^113
"RTN","XMA21G")
1^114
"RTN","XMA22")
1^115
"RTN","XMA23")
1^160
"RTN","XMA24")
1^116
"RTN","XMA25")
1^117
"RTN","XMA2B")
0^246^B9474956
"RTN","XMA2B",1,0)
XMA2B ;(WASH ISC)/CAP/THM-Send BLOB ;06/22/99  14:44
"RTN","XMA2B",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMA2B",3,0)
 ; Entry points used by MailMan options (not covered by DBIA):
"RTN","XMA2B",4,0)
 ; BLOB     XMBLOBSEND - Send Imaging Package message
"RTN","XMA2B",5,0)
BLOB ;Send BLOBs [Other Body Parts] in a message.
"RTN","XMA2B",6,0)
 ;Do not allow option to be used if Imaging is not set up.
"RTN","XMA2B",7,0)
 I '$O(^MAG(2005,0)) W !!,"Imaging is not installed here.  You can not send multimedia messages.",$C(7) Q
"RTN","XMA2B",8,0)
 ;
"RTN","XMA2B",9,0)
 ;First message is created with text.
"RTN","XMA2B",10,0)
 K XMA2BT
"RTN","XMA2B",11,0)
 D BLOB^XMJMS
"RTN","XMA2B",12,0)
 Q
"RTN","XMA2B",13,0)
ADD ;Then this entry point is called
"RTN","XMA2B",14,0)
 ;Called from ^XMJMS for adding BLOBS to message as other body parts
"RTN","XMA2B",15,0)
 ;
"RTN","XMA2B",16,0)
 W !,"Do you want to attach "_$S('$D(XMA2BT):"a",1:"another")_" patient's image to this message?  N// " R X:DTIME
"RTN","XMA2B",17,0)
 I X="Y"!(X="y") S MAGBLOB=1 G SEL
"RTN","XMA2B",18,0)
 I $D(MAGBLOB) I X="N"!(X="n")!(X="^")!(X="") S X="" G ADDCHK
"RTN","XMA2B",19,0)
SEL D SELIM^MAGAPI G ADDBLOB
"RTN","XMA2B",20,0)
ADDCHK G CHK:X=""
"RTN","XMA2B",21,0)
 I X["?" D HLP G ADD
"RTN","XMA2B",22,0)
 ;
"RTN","XMA2B",23,0)
 ;Remove a BLOB
"RTN","XMA2B",24,0)
 S XMN=$E(X)="-"
"RTN","XMA2B",25,0)
 I XMN S X=$E(X,2,99) D LK G ER:+Y<1 S %=$O(^XMB(3.9,XMZ,2005,"B",+Y,0)) I % K ^(%) S I=^XMB(3.9,XMZ,2005,0),%0=$P(I,U,4)-1,$P(I,U,3,4)=%0_U_%0,^(0)=I K ^(%) G ADD
"RTN","XMA2B",26,0)
 ;
"RTN","XMA2B",27,0)
 ;Add a BLOB
"RTN","XMA2B",28,0)
K S Y=-1 D LK
"RTN","XMA2B",29,0)
ADDBLOB G:$S(X["^":1,X="":1,+Y<1:1,1:0) CHK
"RTN","XMA2B",30,0)
 S %=$S($D(^XMB(3.9,XMZ,2005,0)):^(0),1:"^3.92005P"),I=$P(%,U,3)+1,$P(%,U,3)=I,$P(%,U,4)=$P(%,U,4)+1,^(0)=%,^(I,0)=+Y
"RTN","XMA2B",31,0)
 S ^XMB(3.9,XMZ,2005,"B",+Y,I)="",XMA2BT=1
"RTN","XMA2B",32,0)
 G ADD
"RTN","XMA2B",33,0)
CHK K XMA2BT Q:$S($O(^XMB(3.9,XMZ,2005,0)):1,'$O(^XMB(3.9,XMZ,2,0)):1,1:0)
"RTN","XMA2B",34,0)
 W !!,"You did not add any 'Other Body Parts' (files) to this message."
"RTN","XMA2B",35,0)
 R !!,"Do you wish to deliver just the text ? N// ",Y:DTIME
"RTN","XMA2B",36,0)
 K XMOUT
"RTN","XMA2B",37,0)
 S Y=$TR(Y,"yesno","YESNO")
"RTN","XMA2B",38,0)
 I $L(Y) Q:$E("YES",1,$L(Y))=Y
"RTN","XMA2B",39,0)
 I $E("NO",1,$L(Y))=Y G ADD
"RTN","XMA2B",40,0)
 W $C(7),"  <<< Please answer 'YES' or 'NO'"
"RTN","XMA2B",41,0)
 G CHK
"RTN","XMA2B",42,0)
 ;
"RTN","XMA2B",43,0)
LK S DIC=2005,DIC(0)="NOQFEM",DIC("S")="N % S %=^(0) I $P(%,U,6)'=9,$P(%,U,3)" D ^DIC K DIC Q
"RTN","XMA2B",44,0)
ER W " ??",$C(7) G ADD
"RTN","XMA2B",45,0)
 ;
"RTN","XMA2B",46,0)
HLP ;Help for adding/removing BLOBS
"RTN","XMA2B",47,0)
 W !!,"You may add or remove a BLOB from the message.  To add a BLOB"
"RTN","XMA2B",48,0)
 W !,"enter the name of the BLOB you wish to add to the message.  This"
"RTN","XMA2B",49,0)
 W !,"BLOB must already be in the * file.  To remove on, preceed the"
"RTN","XMA2B",50,0)
 W !,"name of the BLOB with a '-'.  Example:  To add the BLOB named"
"RTN","XMA2B",51,0)
 W !,"ZZTEMP, enter 'ZZTEMP'.  To remove it enter '-ZZTEMP'."
"RTN","XMA2B",52,0)
 Q:'$O(^XMB(3.9,XMZ,2005,0))
"RTN","XMA2B",53,0)
 W !!,"The following BLOBs have already been added to this message:",!!
"RTN","XMA2B",54,0)
 ;
"RTN","XMA2B",55,0)
 ;List BLOBS in a message
"RTN","XMA2B",56,0)
L S I=0 F  S I=$O(^XMB(3.9,XMZ,2005,I)) Q:+I'=I  S %=+^(I,0),X=$P(^MAG(2005,%,0),U) W:$L(X)+$X>79 ! W X,?$X\10*10+10
"RTN","XMA2B",57,0)
 Q
"RTN","XMA2B",58,0)
 ;
"RTN","XMA2B",59,0)
 ;Entry point to list non-textual body parts for Query.
"RTN","XMA2B",60,0)
LIST N I,X W !,"This message has non-textual body-parts: "
"RTN","XMA2B",61,0)
 G L
"RTN","XMA2C")
1^118
"RTN","XMA2C0")
1^119
"RTN","XMA2R")
0^247^B13833277
"RTN","XMA2R",1,0)
XMA2R ;ISC-SF/GMB- Reply to/Answer a message API ;04/19/2002  12:37
"RTN","XMA2R",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMA2R",3,0)
 ; Was (WASH ISC)/CAP
"RTN","XMA2R",4,0)
 ;
"RTN","XMA2R",5,0)
 ; Entry points (DBIA 1145):
"RTN","XMA2R",6,0)
 ; ENT  function for non-interactive reply to a message.
"RTN","XMA2R",7,0)
 ;      Reply is sent to all local recipients of the message.
"RTN","XMA2R",8,0)
 ;      If message if from a remote sender, the reply is sent to
"RTN","XMA2R",9,0)
 ;      the remote sender, too.
"RTN","XMA2R",10,0)
 ; ENTA function for non-interactive answer to a message
"RTN","XMA2R",11,0)
ENT(XMZ,XMSUBJ,XMTEXT,XMSTRIP,XMDUZ,XMNET) ; Send response to a message
"RTN","XMA2R",12,0)
 ;Call as follows:
"RTN","XMA2R",13,0)
 ; S var=$$ENT^XMA2R(XMZ,XMSUBJ,.XMTEXT,XMSTRIP,XMDUZ,XMNET)
"RTN","XMA2R",14,0)
 ;Where:  XMZ     = Message being responded to
"RTN","XMA2R",15,0)
 ;        XMSUBJ  = Subject of the response
"RTN","XMA2R",16,0)
 ;                  (ignored, unless message is from a remote sender)
"RTN","XMA2R",17,0)
 ;        .XMTEXT = Array containing text
"RTN","XMA2R",18,0)
 ;        XMSTRIP = Characters to be stripped from text
"RTN","XMA2R",19,0)
 ;        XMDUZ   = Sender of response (DUZ or free text)
"RTN","XMA2R",20,0)
 ;        XMNET   = Send reply over the net? (0=no (DEFAULT); 1=yes)
"RTN","XMA2R",21,0)
 ;                  (ignored, unless message is from a remote sender)
"RTN","XMA2R",22,0)
 ;OUTPUT: If results okay = internal pointer to response in file 3.9
"RTN","XMA2R",23,0)
 ;        If bad result, the letter "E" followed by a number,
"RTN","XMA2R",24,0)
 ;        followed by a space, then a human readable explanation.
"RTN","XMA2R",25,0)
 N XMV,XMZR,XMINSTR,XMMG,XMSECURE,XMZREC
"RTN","XMA2R",26,0)
 K XMERR,^TMP("XMERR",$J)
"RTN","XMA2R",27,0)
 I '$D(^XMB(3.9,XMZ,0)) Q "E5 Message "_XMZ_" does not exist."
"RTN","XMA2R",28,0)
 I '$O(^XMB(3.9,XMZ,1,0)) Q "E6 Message "_XMZ_" has no recipients."
"RTN","XMA2R",29,0)
 I $D(XMTEXT)<9 Q "E2 No message text !"
"RTN","XMA2R",30,0)
 I '$O(XMTEXT(0)) Q "E4 No message text !"
"RTN","XMA2R",31,0)
 S XMDUZ=$G(XMDUZ,DUZ)
"RTN","XMA2R",32,0)
 I XMDUZ'?.N D  Q:$D(XMMG) "E10 "_$P(XMMG,"= ",2)
"RTN","XMA2R",33,0)
 . D SETFROM^XMD(.XMDUZ,.XMINSTR)
"RTN","XMA2R",34,0)
 D INITAPI^XMVVITAE
"RTN","XMA2R",35,0)
 D CRE8XMZ^XMXSEND("R"_XMZ,.XMZR) Q:XMZR<1 $$ERR("E9")
"RTN","XMA2R",36,0)
 D MOVETEXT(XMZR,.XMTEXT)
"RTN","XMA2R",37,0)
 D CHEKBODY^XMXSEND(XMZR,$G(XMSTRIP))
"RTN","XMA2R",38,0)
 D DOREPLY^XMXREPLY(XMDUZ,XMZ,XMZR,.XMINSTR)
"RTN","XMA2R",39,0)
 S XMZREC=$G(^XMB(3.9,XMZ,0))
"RTN","XMA2R",40,0)
 I $P(XMZREC,U,2)'["@"!'$G(XMNET) Q XMZR
"RTN","XMA2R",41,0)
 I '$D(XMSUBJ) Q "E1 No subject !"
"RTN","XMA2R",42,0)
 I $L(XMSUBJ)<3!($L(XMSUBJ)>65) Q "E3 Subject too long or short !"
"RTN","XMA2R",43,0)
 S XMSUBJ=$$SCRUB^XMXUTIL1(XMSUBJ)
"RTN","XMA2R",44,0)
 S:XMSUBJ[U XMSUBJ=$$ENCODEUP^XMXUTIL1(XMSUBJ)
"RTN","XMA2R",45,0)
 N XMFROM,XMREPLTO
"RTN","XMA2R",46,0)
 D REPLYTO^XMXREPLY(XMZ,.XMFROM,.XMREPLTO)
"RTN","XMA2R",47,0)
 D INIT^XMXADDR
"RTN","XMA2R",48,0)
 D CHKADDR^XMXADDR(XMDUZ,$$REMADDR^XMXADDR3($G(XMREPLTO,XMFROM)),.XMINSTR) Q:$D(XMERR) $$ERR("E12")
"RTN","XMA2R",49,0)
 D NETREPLY^XMXREPLY(XMDUZ,XMZ,XMZR,XMSUBJ,.XMINSTR)
"RTN","XMA2R",50,0)
 D CLEANUP^XMXADDR
"RTN","XMA2R",51,0)
 Q XMZR
"RTN","XMA2R",52,0)
MOVETEXT(XMZ,XMTEXT,XMAPPEND) ;
"RTN","XMA2R",53,0)
 N I,XMLINE
"RTN","XMA2R",54,0)
 S XMLINE=$S($G(XMAPPEND):$O(^XMB(3.9,XMZ,2,":"),-1),1:0)
"RTN","XMA2R",55,0)
 S I=0
"RTN","XMA2R",56,0)
 F  S I=$O(XMTEXT(I)) Q:'I  D
"RTN","XMA2R",57,0)
 . S XMLINE=XMLINE+1
"RTN","XMA2R",58,0)
 . S ^XMB(3.9,XMZ,2,XMLINE,0)=$S($D(XMTEXT(I,0)):XMTEXT(I,0),1:XMTEXT(I))
"RTN","XMA2R",59,0)
 S ^XMB(3.9,XMZ,2,0)="^3.92A^"_XMLINE_U_XMLINE
"RTN","XMA2R",60,0)
 Q
"RTN","XMA2R",61,0)
ENTA(XMZ,XMSUBJ,XMTEXT,XMSTRIP,XMDUZ) ; Send Response Only to Sender of Original Message
"RTN","XMA2R",62,0)
 ;Call as follows:
"RTN","XMA2R",63,0)
 ; S var=$$ENT^XMA2R(XMZ,XMSUBJ,.XMTEXT,XMSTRIP,XMDUZ)
"RTN","XMA2R",64,0)
 ;Where:  XMZ     = Message being responded to
"RTN","XMA2R",65,0)
 ;        XMSUBJ  = Subject of the response
"RTN","XMA2R",66,0)
 ;        .XMTEXT = Array containing text
"RTN","XMA2R",67,0)
 ;        XMSTRIP = Characters to be stripped from text
"RTN","XMA2R",68,0)
 ;        XMDUZ   = Sender of response (DUZ or free text)
"RTN","XMA2R",69,0)
 ;
"RTN","XMA2R",70,0)
 ;OUTPUT: If results okay = internal pointer to response in file 3.9
"RTN","XMA2R",71,0)
 ;        If bad result, the letter "E" followed by a number,
"RTN","XMA2R",72,0)
 ;        followed by a space, then a human readable explanation.
"RTN","XMA2R",73,0)
 N XMV,XMZR,XMINSTR,XMMG,XMSECURE,XMZSENDR,XMZREC,XMTO
"RTN","XMA2R",74,0)
 K XMERR,^TMP("XMERR",$J)
"RTN","XMA2R",75,0)
 I '$D(^XMB(3.9,XMZ,0)) Q "E5 Message "_XMZ_" does not exist."
"RTN","XMA2R",76,0)
 I '$D(XMSUBJ) Q "E1 No subject !"
"RTN","XMA2R",77,0)
 I $D(XMTEXT)<9 Q "E2 No message text !"
"RTN","XMA2R",78,0)
 I $L(XMSUBJ)<3!($L(XMSUBJ)>65) Q "E3 Subject too long or short !"
"RTN","XMA2R",79,0)
 I '$O(XMTEXT(0)) Q "E4 No message text !"
"RTN","XMA2R",80,0)
 S XMDUZ=$G(XMDUZ,DUZ)
"RTN","XMA2R",81,0)
 I XMDUZ'?.N D  Q:$D(XMMG) "E10 "_$P(XMMG,"= ",2)
"RTN","XMA2R",82,0)
 . D SETFROM^XMD(.XMDUZ,.XMINSTR)
"RTN","XMA2R",83,0)
 D INITAPI^XMVVITAE
"RTN","XMA2R",84,0)
 S XMZREC=^XMB(3.9,XMZ,0)
"RTN","XMA2R",85,0)
 S XMZSENDR=$P(XMZREC,U,2)
"RTN","XMA2R",86,0)
 S:XMZSENDR["@" XMZSENDR=$$REPLYTO1^XMXREPLY(XMZ)
"RTN","XMA2R",87,0)
 D CRE8XMZ^XMXSEND(XMSUBJ,.XMZR) Q:XMZR<1 $$ERR("E9")
"RTN","XMA2R",88,0)
 D COPY^XMXANSER(XMZ,$P(XMZREC,U,1),XMZSENDR,$P(XMZREC,U,3),XMZR)
"RTN","XMA2R",89,0)
 D MOVETEXT(XMZR,.XMTEXT,1)
"RTN","XMA2R",90,0)
 D NETSIG^XMXEDIT(XMDUZ,XMZR)
"RTN","XMA2R",91,0)
 D CHEKBODY^XMXSEND(XMZR,$G(XMSTRIP))
"RTN","XMA2R",92,0)
 S XMTO(XMZSENDR)=""
"RTN","XMA2R",93,0)
 S XMTO(XMDUZ)=""
"RTN","XMA2R",94,0)
 S XMINSTR("ADDR FLAGS")="R"  ; No addressing restrictions
"RTN","XMA2R",95,0)
 D ADDRNSND^XMXSEND(XMDUZ,XMZR,.XMTO,.XMINSTR)
"RTN","XMA2R",96,0)
 Q:$D(XMERR) $$ERR("E11")
"RTN","XMA2R",97,0)
 Q XMZR
"RTN","XMA2R",98,0)
ERR(XMER) ;
"RTN","XMA2R",99,0)
 S XMER=XMER_" "_^TMP("XMERR",$J,1,"TEXT",1)
"RTN","XMA2R",100,0)
 K XMERR,^TMP("XMERR",$J)
"RTN","XMA2R",101,0)
 Q XMER
"RTN","XMA3")
0^248^B60737613
"RTN","XMA3",1,0)
XMA3 ;ISC-SF/GMB-XMCLEAN, XMAUTOPURGE ;04/18/2002  07:09
"RTN","XMA3",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMA3",3,0)
 ; Was (WASH ISC)/CAP
"RTN","XMA3",4,0)
 ;
"RTN","XMA3",5,0)
 ; Entry points used by MailMan options (not covered by DBIA):
"RTN","XMA3",6,0)
 ; CLEAN      Option: XMCLEAN - Clean out waste baskets and
"RTN","XMA3",7,0)
 ;                              Postmaster's ARRIVING basket
"RTN","XMA3",8,0)
 ; EN         Option: XMAUTOPURGE - Purge Unreferenced Messages
"RTN","XMA3",9,0)
 ; SCAN       Option: XMPURGE - Purge Unreferenced Messages, then STAT
"RTN","XMA3",10,0)
 ; STAT       Option: XMSTAT  - Message Statistics
"RTN","XMA3",11,0)
 Q
"RTN","XMA3",12,0)
EN ;
"RTN","XMA3",13,0)
 N XMPARM
"RTN","XMA3",14,0)
 D PURGEIT(.XMPARM)
"RTN","XMA3",15,0)
 S:$D(ZTQUEUED) ZTREQ="@"
"RTN","XMA3",16,0)
 Q
"RTN","XMA3",17,0)
STAT ;
"RTN","XMA3",18,0)
 D AUDIT^XMA30 ; Show purge audit records
"RTN","XMA3",19,0)
 D USERSTAT^XMA30 ; Show user mailbox info
"RTN","XMA3",20,0)
 Q
"RTN","XMA3",21,0)
SCAN ; PURGE MESSAGES
"RTN","XMA3",22,0)
 I $D(ZTQUEUED) G EN
"RTN","XMA3",23,0)
 N DIR,XMPARM,XMTEXT
"RTN","XMA3",24,0)
 D AUDIT^XMA30 ; Show purge audit records
"RTN","XMA3",25,0)
 S DIR(0)="E" D ^DIR Q:$D(DIRUT)  K DIR
"RTN","XMA3",26,0)
 D BLD^DIALOG(36425,"","","XMTEXT","F")
"RTN","XMA3",27,0)
 ;I will purge messages which are not in anybody's Mailbox.
"RTN","XMA3",28,0)
 ;This will be done by comparing the message numbers in the MESSAGE file
"RTN","XMA3",29,0)
 ;(3.9) against the 'M' cross reference of the MAILBOX file (3.7).
"RTN","XMA3",30,0)
 ;Because this is a real-time dynamic cross reference, it is
"RTN","XMA3",31,0)
 ;RECOMMENDED that you run the INTEGRITY CHECKER with some
"RTN","XMA3",32,0)
 ;frequency, to CORRECT problems, if any.
"RTN","XMA3",33,0)
 I '$P($G(^XMB(1,1,.12)),U) D
"RTN","XMA3",34,0)
 . D BLD^DIALOG(36426,"","","XMTEXT","SF")
"RTN","XMA3",35,0)
 . ;A Mailbox INTEGRITY CHECK will run before the PURGE.
"RTN","XMA3",36,0)
 E  D
"RTN","XMA3",37,0)
 . D BLD^DIALOG(36427,"","","XMTEXT","SF")
"RTN","XMA3",38,0)
 . ;A Mailbox INTEGRITY CHECK will NOT run before the PURGE,
"RTN","XMA3",39,0)
 . ;because your site parameters indicate you do not want it to.
"RTN","XMA3",40,0)
 . ;You may want to do a BACK-UP just before this runs, and revert
"RTN","XMA3",41,0)
 . ;to it if many problems are discovered.
"RTN","XMA3",42,0)
 W !
"RTN","XMA3",43,0)
 D MSG^DIALOG("WM","","","","XMTEXT")
"RTN","XMA3",44,0)
 W !
"RTN","XMA3",45,0)
 D GETPARMS(.XMPARM)
"RTN","XMA3",46,0)
 D BLD^DIALOG(36428,"","","DIR(""A"")") ;Do you really want to purge all unreferenced messages
"RTN","XMA3",47,0)
 S DIR("B")=$$EZBLD^DIALOG(39053) ; NO
"RTN","XMA3",48,0)
 S DIR(0)="Y"
"RTN","XMA3",49,0)
 D ^DIR Q:'Y
"RTN","XMA3",50,0)
 D WAIT^DICD
"RTN","XMA3",51,0)
 D PURGEIT(.XMPARM)
"RTN","XMA3",52,0)
 K DIR S DIR(0)="E" D ^DIR Q:$D(DIRUT)  K DIR
"RTN","XMA3",53,0)
 D STAT
"RTN","XMA3",54,0)
 Q
"RTN","XMA3",55,0)
PURGEIT(XMPARM) ;
"RTN","XMA3",56,0)
 N XMKILL,XMIEN,XMCNT,XMCRE8,XMABORT
"RTN","XMA3",57,0)
 D INIT(.XMIEN,.XMPARM,.XMKILL,.XMABORT) Q:XMABORT
"RTN","XMA3",58,0)
 D MPURGE(.XMCRE8,.XMPARM,.XMKILL,.XMCNT,.XMABORT)
"RTN","XMA3",59,0)
 D FINISH(XMIEN,XMCRE8,.XMKILL,.XMCNT,XMABORT)
"RTN","XMA3",60,0)
 Q
"RTN","XMA3",61,0)
INIT(XMIEN,XMPARM,XMKILL,XMABORT) ;
"RTN","XMA3",62,0)
 S XMABORT=0
"RTN","XMA3",63,0)
 D:'$D(XMPARM) GETPARMS(.XMPARM)
"RTN","XMA3",64,0)
 I '$P($G(^XMB(1,1,.12)),U) D MAILBOX^XMUT4(.XMABORT) Q:XMABORT  ; Integrity check
"RTN","XMA3",65,0)
 S (XMKILL("MSG"),XMKILL("RESP"))=0
"RTN","XMA3",66,0)
 S XMKILL("START")=$P(^XMB(3.9,0),U,4)
"RTN","XMA3",67,0)
 D AUDTPURG^XMA32 ; purge audit records
"RTN","XMA3",68,0)
 D DONTPURG^XMA30 ; Note all messages which shouldn't be purged
"RTN","XMA3",69,0)
 D INITAUDT^XMA32A(.XMIEN,.XMPARM)
"RTN","XMA3",70,0)
 Q
"RTN","XMA3",71,0)
GETPARMS(XMPARM) ;
"RTN","XMA3",72,0)
 N XMSBUF,XMBUFREC
"RTN","XMA3",73,0)
 S (XMPARM("TYPE"),XMPARM("START"))=0
"RTN","XMA3",74,0)
 ; Set up a date buffer, beyond which we won't purge
"RTN","XMA3",75,0)
 S XMBUFREC=$G(^XMB(1,1,.14))
"RTN","XMA3",76,0)
 S XMPARM("END")=$$PDATE(+$P(XMBUFREC,U,1),2) ; purge thru this date
"RTN","XMA3",77,0)
 S XMPARM("PDATE")=$$PDATE(+$P(XMBUFREC,U,2),7) ; don't purge local messages sent on or after this date to remote sites.
"RTN","XMA3",78,0)
 ; If today is Saturday, start purge at beginning.
"RTN","XMA3",79,0)
 ; If not Saturday, check MailMan Site Parameter file for field 4.304 ...
"RTN","XMA3",80,0)
 I $$DOW^XLFDT(DT,1)'=6 D
"RTN","XMA3",81,0)
 . S XMSBUF=+$P($G(^XMB(1,1,"NOTOPURGE")),U)
"RTN","XMA3",82,0)
 . I XMSBUF=0,($G(^XMB("NETNAME"))="FORUM.VA.GOV"!$G(^XMB("NETNAME"))="FORUM.MED.VA.GOV") S XMSBUF=45
"RTN","XMA3",83,0)
 . Q:XMSBUF=0
"RTN","XMA3",84,0)
 . S XMPARM("START")=$$PDATE(XMSBUF,45)
"RTN","XMA3",85,0)
 Q:$D(ZTQUEUED)
"RTN","XMA3",86,0)
 N XMTEXT,XMVAR
"RTN","XMA3",87,0)
 S XMVAR(1)=$$FMTE^XLFDT($S(XMPARM("START")=0:$O(^XMB(3.9,"C",0)),1:XMPARM("START")),5)
"RTN","XMA3",88,0)
 S XMVAR(2)=$$FMTE^XLFDT(XMPARM("END"),5)
"RTN","XMA3",89,0)
 S XMVAR(3)=$$FMTE^XLFDT(XMPARM("PDATE"),5)
"RTN","XMA3",90,0)
 D BLD^DIALOG(36429,.XMVAR,"","XMTEXT","F")
"RTN","XMA3",91,0)
 D MSG^DIALOG("WM","","","","XMTEXT")
"RTN","XMA3",92,0)
 ;Any unreferenced message will be purged if its local create date
"RTN","XMA3",93,0)
 ;is from |1| to |2| inclusive.
"RTN","XMA3",94,0)
 ;However, locally generated messages sent to remote sites will not be purged
"RTN","XMA3",95,0)
 ;if they were sent on or after |3|.
"RTN","XMA3",96,0)
 ;The following messages are considered 'referenced' and will not be purged:
"RTN","XMA3",97,0)
 ;- Messages in users' baskets
"RTN","XMA3",98,0)
 ;- Messages in transit (arriving or being sent)
"RTN","XMA3",99,0)
 ;- Server messages
"RTN","XMA3",100,0)
 ;- Messages being edited (includes aborted edits)
"RTN","XMA3",101,0)
 ;- Later'd messages
"RTN","XMA3",102,0)
 Q
"RTN","XMA3",103,0)
PDATE(XMDAYS,XMDEFALT) ; Subtract so many days from today and return that date.
"RTN","XMA3",104,0)
 S:+XMDAYS=0 XMDAYS=XMDEFALT ; use default if days is null
"RTN","XMA3",105,0)
 Q $$FMADD^XLFDT(DT,-XMDAYS)
"RTN","XMA3",106,0)
FINISH(XMIEN,XMCRE8,XMKILL,XMCNT,XMABORT) ;
"RTN","XMA3",107,0)
 K ^TMP("XM",$J)
"RTN","XMA3",108,0)
 S XMKILL("TOTAL")=XMKILL("MSG")+XMKILL("RESP")
"RTN","XMA3",109,0)
 ;I $G(ZTSTOP) W !!,"*** Stopping prematurely per user request ***"
"RTN","XMA3",110,0)
 I '$D(ZTQUEUED) D
"RTN","XMA3",111,0)
 . N XMVAR,XMTEXT
"RTN","XMA3",112,0)
 . S XMVAR(1)=$J(XMCNT,$L(XMKILL("START")))
"RTN","XMA3",113,0)
 . S XMVAR(2)=$J(XMKILL("TOTAL"),$L(XMKILL("START")))
"RTN","XMA3",114,0)
 . S XMVAR(3)=$J(XMKILL("START")-XMKILL("TOTAL"),$L(XMKILL("START")))
"RTN","XMA3",115,0)
 . W !
"RTN","XMA3",116,0)
 . D BLD^DIALOG(36430,.XMVAR,"","XMTEXT","F")
"RTN","XMA3",117,0)
 . D MSG^DIALOG("WM","","","","XMTEXT")
"RTN","XMA3",118,0)
 . ;|1| messages processed, |2| messages purged, |3| messages in file 3.9
"RTN","XMA3",119,0)
 D CHKAUDT^XMA32A(XMIEN,XMCRE8,.XMKILL)
"RTN","XMA3",120,0)
 Q
"RTN","XMA3",121,0)
MPURGE(XMCRE8,XMPARM,XMKILL,XMCNT,XMABORT) ;
"RTN","XMA3",122,0)
 N XMZREC,XMZ
"RTN","XMA3",123,0)
 S XMZ="",XMCNT=0
"RTN","XMA3",124,0)
 S XMCRE8=$S(XMPARM("START")=0:0,1:$O(^XMB(3.9,"C",XMPARM("START")),-1))
"RTN","XMA3",125,0)
 F  S XMCRE8=$O(^XMB(3.9,"C",XMCRE8)) Q:'XMCRE8  Q:XMCRE8>XMPARM("END")  D
"RTN","XMA3",126,0)
 . F  S XMZ=$O(^XMB(3.9,"C",XMCRE8,XMZ)) Q:'XMZ  D
"RTN","XMA3",127,0)
 . . S XMCNT=XMCNT+1 I XMCNT#5000=0 D  Q:XMABORT
"RTN","XMA3",128,0)
 . . . I '$D(ZTQUEUED) W:$X>40 ! W XMCNT,"." Q
"RTN","XMA3",129,0)
 . . . I $$S^%ZTLOAD S (XMABORT,ZTSTOP)=1 ; User asked the task to stop
"RTN","XMA3",130,0)
 . . I '$D(^XMB(3.9,XMZ)) K ^XMB(3.9,"C",XMCRE8,XMZ) Q
"RTN","XMA3",131,0)
 . . Q:$D(^XMB(3.7,"M",XMZ))        ; Msg is in someone's basket
"RTN","XMA3",132,0)
 . . Q:$D(^TMP("XM",$J,"NOP",XMZ))  ; Msg is one of "do not purge"
"RTN","XMA3",133,0)
 . . S XMZREC=$G(^XMB(3.9,XMZ,0))
"RTN","XMA3",134,0)
 . . Q:$P(XMZREC,U,8)                  ; Msg is a response
"RTN","XMA3",135,0)
 . . I $P($P(XMZREC,U,3),".")?7N,XMCRE8'<XMPARM("PDATE"),$O(^XMB(3.9,XMZ,1,"C",":"))'="" Q  ; local msg recently sent to remote site
"RTN","XMA3",136,0)
 . . D PURGE(XMZ,.XMKILL)
"RTN","XMA3",137,0)
 Q
"RTN","XMA3",138,0)
PURGE(XMZ,XMKILL) ; Purge message and responses
"RTN","XMA3",139,0)
 N XMZR,XMIEN
"RTN","XMA3",140,0)
 S XMIEN=0
"RTN","XMA3",141,0)
 F  S XMIEN=$O(^XMB(3.9,XMZ,3,XMIEN)) Q:XMIEN'>0  D
"RTN","XMA3",142,0)
 . S XMZR=$P($G(^XMB(3.9,XMZ,3,XMIEN,0)),U) Q:'XMZR
"RTN","XMA3",143,0)
 . D KILLRESP(XMZR,.XMKILL)
"RTN","XMA3",144,0)
 D KILLMSG(XMZ,.XMKILL)
"RTN","XMA3",145,0)
 Q
"RTN","XMA3",146,0)
KILLRESP(XMZ,XMKILL) ; Kill response
"RTN","XMA3",147,0)
 Q:'$D(^XMB(3.9,XMZ))      ; Response does not exist
"RTN","XMA3",148,0)
 Q:$D(^XMB(3.7,"M",XMZ))   ; Someone has response in mailbox
"RTN","XMA3",149,0)
 D KILLMSG^XMXUTIL(XMZ)
"RTN","XMA3",150,0)
 S XMKILL("RESP")=XMKILL("RESP")+1
"RTN","XMA3",151,0)
 Q
"RTN","XMA3",152,0)
KILLMSG(XMZ,XMKILL) ; Kill message
"RTN","XMA3",153,0)
 D KILLMSG^XMXUTIL(XMZ)
"RTN","XMA3",154,0)
 S XMKILL("MSG")=XMKILL("MSG")+1
"RTN","XMA3",155,0)
 Q
"RTN","XMA3",156,0)
CLEAN ; Clean various files
"RTN","XMA3",157,0)
 D CSTAT ; Clean Message Statistics file
"RTN","XMA3",158,0)
 D CMBOX ; Clean WASTE baskets & Postmaster's ARRIVING basket
"RTN","XMA3",159,0)
 S:$D(ZTQUEUED) ZTREQ="@"
"RTN","XMA3",160,0)
 Q
"RTN","XMA3",161,0)
CSTAT ; Clean Statistics file audits - delete records more than 2 years old
"RTN","XMA3",162,0)
 N XMINST,XMAUDT,XMCUTOFF,DA,DIK
"RTN","XMA3",163,0)
 S XMCUTOFF=DT\100-200   ; 2 years ago, in yyymm format
"RTN","XMA3",164,0)
 S XMINST=0
"RTN","XMA3",165,0)
 F  S XMINST=$O(^XMBS(4.2999,XMINST)) Q:XMINST'>0  D
"RTN","XMA3",166,0)
 . S DA(1)=XMINST,DIK="^XMBS(4.2999,"_DA(1)_",100,"
"RTN","XMA3",167,0)
 . S XMAUDT=0
"RTN","XMA3",168,0)
 . F  S XMAUDT=$O(^XMBS(4.2999,XMINST,100,XMAUDT)) Q:XMAUDT'>0!(XMAUDT>XMCUTOFF)  D
"RTN","XMA3",169,0)
 . . S DA=XMAUDT D ^DIK
"RTN","XMA3",170,0)
 Q
"RTN","XMA3",171,0)
CMBOX ; Clean the mailbox file
"RTN","XMA3",172,0)
 N XMDUZ,XMCNT,XMABORT
"RTN","XMA3",173,0)
 D CARRIVE
"RTN","XMA3",174,0)
 S (XMDUZ,XMCNT,XMABORT)=0
"RTN","XMA3",175,0)
 F  S XMDUZ=$O(^XMB(3.7,XMDUZ)) Q:XMDUZ'>0  D  Q:XMABORT
"RTN","XMA3",176,0)
 . D CWASTE(XMDUZ,.XMCNT,.XMABORT)
"RTN","XMA3",177,0)
 W:'$D(ZTQUEUED) !,$$EZBLD^DIALOG(36431) ; Waste & Arriving Baskets Cleaned!
"RTN","XMA3",178,0)
 Q
"RTN","XMA3",179,0)
CWASTE(XMDUZ,XMCNT,XMABORT) ; Clean a user's WASTE basket
"RTN","XMA3",180,0)
 S XMCNT=XMCNT+1 I XMCNT#100=0 D  Q:XMABORT
"RTN","XMA3",181,0)
 . I '$D(ZTQUEUED) W:$X>40 ! W XMCNT,"." Q
"RTN","XMA3",182,0)
 . I $$S^%ZTLOAD S (XMABORT,ZTSTOP)=1 ; User asked the task to stop
"RTN","XMA3",183,0)
 L +^XMB(3.7,XMDUZ,2,.5):5  E  Q
"RTN","XMA3",184,0)
 N XMZ
"RTN","XMA3",185,0)
 S XMZ=0
"RTN","XMA3",186,0)
 F  S XMZ=$O(^XMB(3.7,XMDUZ,2,.5,1,XMZ)) Q:XMZ'>0  K ^XMB(3.7,"M",XMZ,XMDUZ,.5)
"RTN","XMA3",187,0)
 K ^XMB(3.7,XMDUZ,2,.5)
"RTN","XMA3",188,0)
 S ^XMB(3.7,XMDUZ,2,.5,0)=$$EZBLD^DIALOG(37004) ; "WASTE"
"RTN","XMA3",189,0)
 S ^XMB(3.7,XMDUZ,2,.5,1,0)="^3.702P^0^0"
"RTN","XMA3",190,0)
 L -^XMB(3.7,XMDUZ,2,.5)
"RTN","XMA3",191,0)
 Q
"RTN","XMA3",192,0)
CARRIVE ; Clean the postmaster's ARRIVING basket
"RTN","XMA3",193,0)
 N XMZ,XMCNT,XMZLAST,XMDATE,XMPARM
"RTN","XMA3",194,0)
 S XMPARM("END")=$$PDATE(+$P($G(^XMB(1,1,.14)),U,1),2)
"RTN","XMA3",195,0)
 L +^XMB(3.7,.5,2,.95):5 E  Q
"RTN","XMA3",196,0)
 S (XMZ,XMCNT,XMZLAST)=0
"RTN","XMA3",197,0)
 F  S XMZ=$O(^XMB(3.7,.5,2,.95,1,XMZ)) Q:XMZ'>0  D
"RTN","XMA3",198,0)
 . I '$D(^XMB(3.9,XMZ,0)) D  Q
"RTN","XMA3",199,0)
 . . S DA=XMZ,DA(1)=.95,DA(2)=.5,DIK="^XMB(3.7,.5,2,.95,1," D ^DIK
"RTN","XMA3",200,0)
 . ; If it's still arriving, its date will be a FileMan date.
"RTN","XMA3",201,0)
 . ; After it's finished arriving, its date will be an internet (text) date.
"RTN","XMA3",202,0)
 . S XMDATE=$P($G(^XMB(3.9,XMZ,0)),U,3)
"RTN","XMA3",203,0)
 . I XMDATE?7N1".".N,XMDATE'>XMPARM("END") D  Q  ; been arriving for over 24 hours
"RTN","XMA3",204,0)
 . . S DA=XMZ,DA(1)=.95,DA(2)=.5,DIK="^XMB(3.7,.5,2,.95,1," D ^DIK
"RTN","XMA3",205,0)
 . S XMCNT=XMCNT+1,XMZLAST=XMZ
"RTN","XMA3",206,0)
 S ^XMB(3.7,.5,2,.95,0)="ARRIVING",^(1,0)="^3.702P^"_XMZLAST_U_XMCNT
"RTN","XMA3",207,0)
 L -^XMB(3.7,.5,2,.95)
"RTN","XMA3",208,0)
 Q
"RTN","XMA30")
0^1^B40089770
"RTN","XMA30",1,0)
XMA30 ;ISC-SF/GMB-XMCLEAN, XMAUTOPURGE (cont.) ;04/17/2002  07:19
"RTN","XMA30",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMA30",3,0)
 ; Was (WASH ISC)/CAP
"RTN","XMA30",4,0)
AUDIT ; Lists data from previous purges
"RTN","XMA30",5,0)
 N XMLIEN,XMREC,XMSTART,XMEND,XMLEFT,XMPURGE,XMTYPE,XMABORT
"RTN","XMA30",6,0)
 S XMABORT=0
"RTN","XMA30",7,0)
 W @IOF
"RTN","XMA30",8,0)
 D BLD^DIALOG(36432,"","","XMTEXT","F")
"RTN","XMA30",9,0)
 D MSG^DIALOG("WM","","","","XMTEXT")
"RTN","XMA30",10,0)
 ;It's a good idea to look these over.
"RTN","XMA30",11,0)
 ;Look for multiple purges running concurrently and missing purge dates.
"RTN","XMA30",12,0)
 ;Check the times the purge ended - do they conflict with user activity?
"RTN","XMA30",13,0)
 W !
"RTN","XMA30",14,0)
 D AHDR
"RTN","XMA30",15,0)
 S XMLIEN=0
"RTN","XMA30",16,0)
 F  S XMLIEN=$O(^XMB(1,1,.1,XMLIEN)) Q:XMLIEN'>0  D  Q:XMABORT
"RTN","XMA30",17,0)
 . I $Y+3>IOSL D  Q:XMABORT
"RTN","XMA30",18,0)
 . . I IOST["C-" D PAGE^XMXUTIL(.XMABORT) Q:XMABORT
"RTN","XMA30",19,0)
 . . W @IOF D AHDR
"RTN","XMA30",20,0)
 . S XMREC=^XMB(1,1,.1,XMLIEN,0)
"RTN","XMA30",21,0)
 . S XMSTART=$E($P(XMREC,U),1,12)
"RTN","XMA30",22,0)
 . S XMLEFT=$P(XMREC,U,2)
"RTN","XMA30",23,0)
 . S XMPURGE=$P(XMREC,U,3)
"RTN","XMA30",24,0)
 . S XMTYPE=$P(XMREC,U,6)
"RTN","XMA30",25,0)
 . S XMEND=$E($P(XMREC,U,8),1,12)
"RTN","XMA30",26,0)
 . I XMTYPE="",'XMEND D  ; To handle old data before XM*7.1*37
"RTN","XMA30",27,0)
 . . S XMEND=XMSTART
"RTN","XMA30",28,0)
 . . K XMSTART
"RTN","XMA30",29,0)
 . W !,$$EZBLD^DIALOG($S(+XMTYPE=0:36433,XMTYPE=1:36434,1:36435)) ; "Unref Msg" / "Date" / "Test Date"
"RTN","XMA30",30,0)
 . W ?12,$S($D(XMSTART):$J($$FMTE^XLFDT(XMSTART,5),16),1:""),$J($$FMTE^XLFDT(XMEND,5),18)
"RTN","XMA30",31,0)
 . I $D(XMSTART),XMEND>XMSTART W $J($$FMDIFF^XLFDT(XMEND,XMSTART,3),10)
"RTN","XMA30",32,0)
 . W ?58,$J(XMPURGE,9),$J(XMLEFT,12)
"RTN","XMA30",33,0)
 Q
"RTN","XMA30",34,0)
AHDR ;
"RTN","XMA30",35,0)
 N XMTEXT
"RTN","XMA30",36,0)
 D BLD^DIALOG(36436,"","","XMTEXT","F")
"RTN","XMA30",37,0)
 D MSG^DIALOG("WM","",IOM,"","XMTEXT")
"RTN","XMA30",38,0)
 W !
"RTN","XMA30",39,0)
 ;MailMan Purge History
"RTN","XMA30",40,0)
 ;Type             Start             End         Duration      Purged         Kept
"RTN","XMA30",41,0)
 Q
"RTN","XMA30",42,0)
USERSTAT ; Display statistics
"RTN","XMA30",43,0)
 N DIR,Y,XMTYPE,ZTSAVE,XMVAR,XMTEXT,XMDIALOG,XMI
"RTN","XMA30",44,0)
 W !
"RTN","XMA30",45,0)
 S XMVAR(2)=$O(^XMB(3.9,":"),-1) ; highest
"RTN","XMA30",46,0)
 S XMVAR(1)=$J($O(^XMB(3.9,0)),$L(XMVAR(2))) ; lowest
"RTN","XMA30",47,0)
 S XMVAR(3)=$J($P($G(^XMB(3.9,0)),U,4),$L(XMVAR(2))) ; how many
"RTN","XMA30",48,0)
 D BLD^DIALOG(36437,.XMVAR,"","XMTEXT","F")
"RTN","XMA30",49,0)
 D MSG^DIALOG("WM","","","","XMTEXT")
"RTN","XMA30",50,0)
 ;Lowest numbered message:  |1|
"RTN","XMA30",51,0)
 ;Highest numbered message: |2|
"RTN","XMA30",52,0)
 ;Number of messages:       |3|
"RTN","XMA30",53,0)
 D BLD^DIALOG(36438,"","","DIR(""A"")") ; Scan Option
"RTN","XMA30",54,0)
 ;A:Active Mailboxes;I:Inactive Mailboxes;M:All Mailboxes"
"RTN","XMA30",55,0)
 S DIR(0)="S^"
"RTN","XMA30",56,0)
 F XMI=36439.1,36439.2,36439.3 D
"RTN","XMA30",57,0)
 . S XMDIALOG(XMI)=$$EZBLD^DIALOG(XMI)
"RTN","XMA30",58,0)
 . S DIR(0)=DIR(0)_XMDIALOG(XMI)_";"
"RTN","XMA30",59,0)
 S DIR(0)=$E(DIR(0),1,$L(DIR(0))-1)
"RTN","XMA30",60,0)
 S DIR("B")=$P(XMDIALOG(36439.1),":",2) ; Active Mailboxes
"RTN","XMA30",61,0)
 D ^DIR Q:$D(DIRUT)
"RTN","XMA30",62,0)
 S XMI=0 F  S XMI=$O(XMDIALOG(XMI)) Q:$P(XMDIALOG(XMI),":",1)=Y
"RTN","XMA30",63,0)
 S XMTYPE=$S(XMI=36439.1:"A",36439.2:"I",1:"M")
"RTN","XMA30",64,0)
 S XMTYPE("DESC")=$P(XMDIALOG(XMI),":",2)
"RTN","XMA30",65,0)
 S ZTSAVE("XMTYPE")="",ZTSAVE("XMTYPE(")=""
"RTN","XMA30",66,0)
 D EN^XUTMDEVQ("DOSTATS^XMA30",$$EZBLD^DIALOG(36440),.ZTSAVE) ; MailMan: User Mailbox Statistics
"RTN","XMA30",67,0)
 Q
"RTN","XMA30",68,0)
DOSTATS ;
"RTN","XMA30",69,0)
 N XMTODAY,XMPAGE,XMABORT,XMDUZ,XMK,XMINCNT,XMZCNT,XMKCNT,XMBOXCNT,XMLMAIL,XMNAME,XMREC,XMSTAT,XMLSIGN,XMINACT
"RTN","XMA30",70,0)
 S XMTODAY=$$FMTE^XLFDT(DT,5),(XMPAGE,XMABORT,XMBOXCNT)=0
"RTN","XMA30",71,0)
 S:$D(ZTQUEUED) ZTREQ="@"
"RTN","XMA30",72,0)
 W:IOST["C-" @IOF D SHDR(XMTODAY,.XMPAGE)
"RTN","XMA30",73,0)
 S XMNAME="",XMINACT=$$EZBLD^DIALOG(36441) ; "Inactive"
"RTN","XMA30",74,0)
 F  S XMNAME=$O(^VA(200,"B",XMNAME)) Q:XMNAME=""  D  Q:XMABORT
"RTN","XMA30",75,0)
 . S XMDUZ=0
"RTN","XMA30",76,0)
 . F  S XMDUZ=$O(^VA(200,"B",XMNAME,XMDUZ)) Q:XMDUZ=""  D  Q:XMABORT
"RTN","XMA30",77,0)
 . . Q:'$D(^XMB(3.7,XMDUZ))
"RTN","XMA30",78,0)
 . . S XMREC=$G(^VA(200,XMDUZ,0))
"RTN","XMA30",79,0)
 . . I $P(XMREC,U,3)="" Q:XMTYPE="A"  S XMSTAT=XMINACT
"RTN","XMA30",80,0)
 . . E  I XMTYPE="I" Q
"RTN","XMA30",81,0)
 . . E  S XMSTAT=""
"RTN","XMA30",82,0)
 . . I $Y+3>IOSL D  Q:XMABORT
"RTN","XMA30",83,0)
 . . . I IOST["C-" D PAGE^XMXUTIL(.XMABORT) Q:XMABORT
"RTN","XMA30",84,0)
 . . . W @IOF D SHDR(XMTODAY,.XMPAGE)
"RTN","XMA30",85,0)
 . . S XMBOXCNT=XMBOXCNT+1
"RTN","XMA30",86,0)
 . . W !,$$NAME^XMXUTIL(XMDUZ)
"RTN","XMA30",87,0)
 . . S XMK=.9,(XMINCNT,XMZCNT)=0
"RTN","XMA30",88,0)
 . . F XMKCNT=1:1 S XMK=$O(^XMB(3.7,XMDUZ,2,XMK)) Q:XMK'>0  D
"RTN","XMA30",89,0)
 . . . D:'$D(^XMB(3.7,XMDUZ,2,XMK,1,0)) MAKENODE
"RTN","XMA30",90,0)
 . . . I XMK=1 S XMINCNT=+$P($G(^XMB(3.7,XMDUZ,2,XMK,1,0)),U,4),XMZCNT=XMINCNT Q
"RTN","XMA30",91,0)
 . . . S XMZCNT=XMZCNT+$P($G(^XMB(3.7,XMDUZ,2,XMK,1,0)),U,4)
"RTN","XMA30",92,0)
 . . S XMLMAIL=$P($G(^XMB(3.7,XMDUZ,"L")),U)
"RTN","XMA30",93,0)
 . . S XMLMAIL=$S(XMLMAIL["@":$P(XMLMAIL,"@"),1:$P(XMLMAIL," ",1,3))
"RTN","XMA30",94,0)
 . . S XMLSIGN=$P($G(^VA(200,XMDUZ,1.1)),U)
"RTN","XMA30",95,0)
 . . S XMLSIGN=$S(XMSTAT'="":XMSTAT,'XMLSIGN:$$EZBLD^DIALOG(38002),1:$J($$FMTE^XLFDT($P(XMLSIGN,"."),5),10)) ; Never
"RTN","XMA30",96,0)
 . . W ?30,$J(XMKCNT,4),$J(XMZCNT,7),$J(XMINCNT,8),?53,XMLSIGN,?67,$S($L(XMLMAIL):XMLMAIL,1:$$EZBLD^DIALOG(38002)) ; Never
"RTN","XMA30",97,0)
 Q:XMABORT
"RTN","XMA30",98,0)
 W !!,XMTYPE("DESC"),": ",XMBOXCNT
"RTN","XMA30",99,0)
 Q
"RTN","XMA30",100,0)
MAKENODE ; Create the zero node for the message multiple
"RTN","XMA30",101,0)
 N XMCNT,XMZ
"RTN","XMA30",102,0)
 Q:'$O(^XMB(3.7,XMDUZ,2,XMK,1,0))
"RTN","XMA30",103,0)
 S (XMZ,XMCNT)=0
"RTN","XMA30",104,0)
 F  S XMZ=$O(^XMB(3.7,XMDUZ,2,XMK,1,XMZ)) Q:XMZ'>0  S XMCNT=XMCNT+1
"RTN","XMA30",105,0)
 S ^XMB(3.7,XMDUZ,2,XMK,1,0)="^3.702P^"_+$O(^XMB(3.7,XMDUZ,2,XMK,1,"C"),-1)_U_XMCNT
"RTN","XMA30",106,0)
 Q
"RTN","XMA30",107,0)
SHDR(XMTODAY,XMPAGE) ; Header for Mailbox Statistics Report
"RTN","XMA30",108,0)
 S XMPAGE=XMPAGE+1
"RTN","XMA30",109,0)
 W XMTYPE("DESC"),", ",XMTODAY,?65,$J($$EZBLD^DIALOG(34542,XMPAGE),15) ; Page |1|
"RTN","XMA30",110,0)
 D BLD^DIALOG(36443,"","","XMTEXT","F")
"RTN","XMA30",111,0)
 D MSG^DIALOG("WM","",IOM,"","XMTEXT")
"RTN","XMA30",112,0)
 W !
"RTN","XMA30",113,0)
 ;User     Bskts  Msgs  IN Bskt  Last Sign on  Last Mail Use"
"RTN","XMA30",114,0)
 Q
"RTN","XMA30",115,0)
DONTPURG ; Find all messages which might not be in someone's mailbox,
"RTN","XMA30",116,0)
 ; but which shouldn't be purged anyway.
"RTN","XMA30",117,0)
 N XMDUZ,XMZ,XMZR,XMQ,XMT,XMD,XMINST,XMG
"RTN","XMA30",118,0)
 K ^TMP("XM",$J)
"RTN","XMA30",119,0)
 ;
"RTN","XMA30",120,0)
 ; DON'T PURGE LOCAL MESSAGES AND REPLIES WHICH ARE ABOUT TO BE DELIVERED
"RTN","XMA30",121,0)
 ;
"RTN","XMA30",122,0)
 S (XMT,XMG,XMZ)="" ; new messages, forwarded messages, and replies
"RTN","XMA30",123,0)
 F  S XMT=$O(^XMBPOST("BOX",XMT)) Q:XMT=""  D
"RTN","XMA30",124,0)
 . F  S XMG=$O(^XMBPOST("BOX",XMT,XMG)) Q:XMG=""  D
"RTN","XMA30",125,0)
 . . F  S XMZ=$O(^XMBPOST("BOX",XMT,XMG,XMZ)) Q:XMZ=""  S ^TMP("XM",$J,"NOP",+XMZ)="" I XMG="R" S ^TMP("XM",$J,"NOP",$P(XMZ,U,2))=""
"RTN","XMA30",126,0)
 ;
"RTN","XMA30",127,0)
 ; new messages, forwarded messages
"RTN","XMA30",128,0)
 S (XMQ,XMT,XMZ)="" ; Queue number, Timestamp, Message IEN
"RTN","XMA30",129,0)
 F  S XMQ=$O(^XMBPOST("M",XMQ)) Q:XMQ=""  D
"RTN","XMA30",130,0)
 . F  S XMT=$O(^XMBPOST("M",XMQ,XMT)) Q:XMT=""  D
"RTN","XMA30",131,0)
 . . F  S XMZ=$O(^XMBPOST("M",XMQ,XMT,XMZ)) Q:XMZ=""  S ^TMP("XM",$J,"NOP",+XMZ)=""
"RTN","XMA30",132,0)
 ;
"RTN","XMA30",133,0)
 ; replies
"RTN","XMA30",134,0)
 S (XMQ,XMZ,XMZR)="" ; Queue number, Message IEN, Reply IEN
"RTN","XMA30",135,0)
 F  S XMQ=$O(^XMBPOST("R",XMQ)) Q:XMQ=""  D
"RTN","XMA30",136,0)
 . S XMT="" ; Timestamp
"RTN","XMA30",137,0)
 . F  S XMT=$O(^XMBPOST("R",XMQ,XMT)) Q:XMT'>0  D
"RTN","XMA30",138,0)
 . . F  S XMZ=$O(^XMBPOST("R",XMQ,XMT,XMZ)) Q:XMZ=""  D
"RTN","XMA30",139,0)
 . . . S ^TMP("XM",$J,"NOP",XMZ)="" ; Original msg to new replies
"RTN","XMA30",140,0)
 . . . F  S XMZR=$O(^XMBPOST("R",XMQ,XMT,XMZ,XMZR)) Q:XMZR=""  S ^TMP("XM",$J,"NOP",XMZR)="" ; Reply
"RTN","XMA30",141,0)
 ;
"RTN","XMA30",142,0)
 ; DON'T PURGE MESSAGES QUEUED TO BE DELIVERED REMOTELY
"RTN","XMA30",143,0)
 S XMINST=999 ; Institution
"RTN","XMA30",144,0)
 F  S XMINST=$O(^XMB(3.7,.5,2,XMINST)) Q:XMINST'>0  D
"RTN","XMA30",145,0)
 . S XMZ=0
"RTN","XMA30",146,0)
 . F  S XMZ=$O(^XMB(3.7,.5,2,XMINST,1,XMZ)) Q:XMZ'>0  S ^TMP("XM",$J,"NOP",XMZ)=""
"RTN","XMA30",147,0)
 ;
"RTN","XMA30",148,0)
 ; DON'T PURGE LATER'D MESSAGES
"RTN","XMA30",149,0)
 S XMD=0 ; Date to be later'd
"RTN","XMA30",150,0)
 F  S XMD=$O(^XMB(3.73,XMD)) Q:XMD'>0  D
"RTN","XMA30",151,0)
 . S XMZ=$P(^XMB(3.73,XMD,0),U,3)
"RTN","XMA30",152,0)
 . S:XMZ ^TMP("XM",$J,"NOP",XMZ)="" ; Msg to be later'd
"RTN","XMA30",153,0)
 ;
"RTN","XMA30",154,0)
 ; DON'T PURGE MESSAGES WHICH ARE BEING EDITED
"RTN","XMA30",155,0)
 S (XMDUZ,XMZ)=""
"RTN","XMA30",156,0)
 F  S XMDUZ=$O(^XMB(3.7,"AD",XMDUZ)) Q:XMDUZ=""  D
"RTN","XMA30",157,0)
 . F  S XMZ=$O(^XMB(3.7,"AD",XMDUZ,XMZ)) Q:XMZ=""  S ^TMP("XM",$J,"NOP",XMZ)=""
"RTN","XMA30",158,0)
 ;
"RTN","XMA30",159,0)
 ; DON'T PURGE MESSAGES WHICH ARE TO BE DELIVERED LATER TO CERTAIN RECIPIENTS
"RTN","XMA30",160,0)
 S (XMD,XMZ)=""
"RTN","XMA30",161,0)
 F  S XMD=$O(^XMB(3.9,"AL",XMD)) Q:XMD=""  D
"RTN","XMA30",162,0)
 . F  S XMZ=$O(^XMB(3.9,"AL",XMD,XMZ)) Q:XMZ=""  S ^TMP("XM",$J,"NOP",XMZ)=""
"RTN","XMA30",163,0)
 Q
"RTN","XMA31")
1^161
"RTN","XMA32")
0^249^B42886226
"RTN","XMA32",1,0)
XMA32 ;ISC-SF/GMB-Purge Messages by Date ;04/17/2002  07:20
"RTN","XMA32",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMA32",3,0)
 ; Was (WASH ISC)/CAP
"RTN","XMA32",4,0)
 ;
"RTN","XMA32",5,0)
 ; Entry points used by MailMan options (not covered by DBIA):
"RTN","XMA32",6,0)
 ; ENTER   XMPURGE-BY-DATE - Purge messages by local create date.
"RTN","XMA32",7,0)
ENTER ;
"RTN","XMA32",8,0)
 N XMABORT,XMPARM
"RTN","XMA32",9,0)
 I $D(ZTQUEUED) S ZTREQ="@"
"RTN","XMA32",10,0)
 S XMABORT=0
"RTN","XMA32",11,0)
 D INIT(.XMPARM,.XMABORT) Q:XMABORT
"RTN","XMA32",12,0)
 D SETUP(.XMPARM,.XMABORT) Q:XMABORT
"RTN","XMA32",13,0)
 D PROCESS(.XMPARM)
"RTN","XMA32",14,0)
 Q
"RTN","XMA32",15,0)
INIT(XMPARM,XMABORT) ;
"RTN","XMA32",16,0)
 N XMKEY,XMTEXT
"RTN","XMA32",17,0)
 F XMKEY="XMMGR","XMSTAR" D  Q:XMABORT
"RTN","XMA32",18,0)
 . Q:$D(^XUSEC(XMKEY,DUZ))
"RTN","XMA32",19,0)
 . S XMABORT=1
"RTN","XMA32",20,0)
 . ;You must hold the |1| key to run this option.
"RTN","XMA32",21,0)
 . W !
"RTN","XMA32",22,0)
 . D BLD^DIALOG(36400,XMKEY,"","XMTEXT","F")
"RTN","XMA32",23,0)
 . D MSG^DIALOG("WE","","","","XMTEXT")
"RTN","XMA32",24,0)
 Q:XMABORT
"RTN","XMA32",25,0)
 N XMREC
"RTN","XMA32",26,0)
 S XMREC=$G(^XMB(1,1,.18))
"RTN","XMA32",27,0)
 S XMPARM("PDAYS")=$S($P(XMREC,U,1):$P(XMREC,U,1),1:730)
"RTN","XMA32",28,0)
 I $D(ZTQUEUED),XMPARM("PDAYS")<365 S XMPARM("PDAYS")=730
"RTN","XMA32",29,0)
 S XMPARM("GRACE")=+$P(XMREC,U,2)
"RTN","XMA32",30,0)
 D AUDTPURG
"RTN","XMA32",31,0)
 Q:$D(ZTQUEUED)
"RTN","XMA32",32,0)
 W !
"RTN","XMA32",33,0)
 D BLD^DIALOG(36401,"","","XMTEXT","F")
"RTN","XMA32",34,0)
 D MSG^DIALOG("WM","","","","XMTEXT")
"RTN","XMA32",35,0)
 ;This process REMOVES MESSAGES PERMANENTLY from the system.
"RTN","XMA32",36,0)
 ;             ***** BE VERY CAREFUL *****
"RTN","XMA32",37,0)
 I $D(^XMB(1,1,.1,0)) D LAST(.XMPARM)
"RTN","XMA32",38,0)
 Q
"RTN","XMA32",39,0)
LAST(XMPARM) ; Find the audit record for the last date purge
"RTN","XMA32",40,0)
 N XMLIEN,XMREC,XMDIFF,XMTEXT,XMVAR
"RTN","XMA32",41,0)
 S XMLIEN=":"
"RTN","XMA32",42,0)
 F  S XMLIEN=$O(^XMB(1,1,.1,XMLIEN),-1) Q:'XMLIEN  Q:$P(^(XMLIEN,0),U,6)
"RTN","XMA32",43,0)
 Q:'XMLIEN
"RTN","XMA32",44,0)
 S XMREC=^XMB(1,1,.1,XMLIEN,0)
"RTN","XMA32",45,0)
 D BLD^DIALOG($S($P(XMREC,U,6)["TEST":36402.1,1:36402),$$FMTE^XLFDT($P(XMREC,U),5),"","XMTEXT","F")
"RTN","XMA32",46,0)
 ;This process was last run on |1| (in TEST mode).
"RTN","XMA32",47,0)
 S XMDIFF=$$FMDIFF^XLFDT($P(XMREC,U,1),$P(XMREC,U,7),1) ; difference in days
"RTN","XMA32",48,0)
 S XMVAR(1)=$$FMTE^XLFDT($P(XMREC,U,7),5),XMVAR(2)=XMDIFF
"RTN","XMA32",49,0)
 W !
"RTN","XMA32",50,0)
 D BLD^DIALOG(36403,.XMVAR,"","XMTEXT","FS")
"RTN","XMA32",51,0)
 D MSG^DIALOG("WM","","","","XMTEXT")
"RTN","XMA32",52,0)
 ;The PURGE DATE used was |1|.
"RTN","XMA32",53,0)
 ;(Messages more than |2| days old were purged.)
"RTN","XMA32",54,0)
 W !
"RTN","XMA32",55,0)
 Q
"RTN","XMA32",56,0)
AUDTPURG ; Kill off the earliest purge entries, so that only a certain # remain.
"RTN","XMA32",57,0)
 N XMREC,XMCNT,DA,DIK,XMMAX
"RTN","XMA32",58,0)
 S XMMAX=20
"RTN","XMA32",59,0)
 S XMREC=$G(^XMB(1,1,.1,0))
"RTN","XMA32",60,0)
 S XMCNT=$P(XMREC,U,4)
"RTN","XMA32",61,0)
 Q:XMCNT'>XMMAX
"RTN","XMA32",62,0)
 S DA=0
"RTN","XMA32",63,0)
 F  S DA=$O(^XMB(1,1,.1,0)) Q:DA'>0  D  Q:XMCNT'>XMMAX
"RTN","XMA32",64,0)
 . S XMCNT=XMCNT-1
"RTN","XMA32",65,0)
 . S DA(1)=1,DIK="^XMB(1,1,.1,"
"RTN","XMA32",66,0)
 . D ^DIK
"RTN","XMA32",67,0)
 Q
"RTN","XMA32",68,0)
SETUP(XMPARM,XMABORT) ;
"RTN","XMA32",69,0)
 D PDATE(.XMPARM,.XMABORT)    Q:XMABORT  ; Purge date
"RTN","XMA32",70,0)
 D TESTMODE(.XMPARM,.XMABORT) Q:XMABORT  ; Test mode?
"RTN","XMA32",71,0)
 D GRACE(.XMPARM,.XMABORT)    Q:XMABORT  ; Grace days
"RTN","XMA32",72,0)
 Q
"RTN","XMA32",73,0)
PDATE(XMPARM,XMABORT) ;
"RTN","XMA32",74,0)
 N DIR,X,Y,XMOK,XMOLDEST,XMCUTOFF,XMOLDP1,XMDIFF,XMVAR
"RTN","XMA32",75,0)
 ; Find the oldest date.  Kill any bogus xrefs.
"RTN","XMA32",76,0)
 F  S XMOLDEST=$O(^XMB(3.9,"C","")) Q:XMOLDEST?7N  K ^XMB(3.9,"C",XMOLDEST)
"RTN","XMA32",77,0)
 S XMOLDP1=$$FMADD^XLFDT(XMOLDEST,1)
"RTN","XMA32",78,0)
 I $D(ZTQUEUED) D  Q
"RTN","XMA32",79,0)
 . S XMCUTOFF=$$FMADD^XLFDT(DT,XMPARM("GRACE")-XMPARM("PDAYS"))
"RTN","XMA32",80,0)
 . I XMOLDP1>XMCUTOFF S XMABORT=1 Q  ; Abort if no messages that old.
"RTN","XMA32",81,0)
 . S XMPARM("PDATE")=XMCUTOFF
"RTN","XMA32",82,0)
 S XMCUTOFF=$$FMADD^XLFDT(DT,-XMPARM("PDAYS"))
"RTN","XMA32",83,0)
 I XMOLDP1>XMCUTOFF S XMCUTOFF=XMOLDP1
"RTN","XMA32",84,0)
 S XMOK=0
"RTN","XMA32",85,0)
 F  D  Q:XMOK!XMABORT
"RTN","XMA32",86,0)
 . S DIR(0)="D^"_XMOLDP1_":DT:E"
"RTN","XMA32",87,0)
 . D BLD^DIALOG(36404,$$FMTE^XLFDT(XMOLDEST,5),"","DIR(""A"")")
"RTN","XMA32",88,0)
 . ;The oldest message on the system is from |1|.
"RTN","XMA32",89,0)
 . ;Purge all messages originating before
"RTN","XMA32",90,0)
 . S DIR("B")=$$FMTE^XLFDT(XMCUTOFF,5)
"RTN","XMA32",91,0)
 . D BLD^DIALOG(36405,"","","DIR(""?"")")
"RTN","XMA32",92,0)
 . ;All messages whose 'local create date' is prior to the
"RTN","XMA32",93,0)
 . ;'purge date' you enter will be deleted from the system,
"RTN","XMA32",94,0)
 . ;except those which are in one of SHARED,MAIL's baskets,
"RTN","XMA32",95,0)
 . ;OR in POSTMASTER's server baskets or remote transmit queues.
"RTN","XMA32",96,0)
 . S DIR("??")="^N %DT S %DT=0 D HELP^%DTC"
"RTN","XMA32",97,0)
 . D ^DIR I $D(DIRUT) S XMABORT=1 Q
"RTN","XMA32",98,0)
 . S XMPARM("PDATE")=Y
"RTN","XMA32",99,0)
 . I DT-Y>10000 S XMOK=1 Q
"RTN","XMA32",100,0)
 . D ZIS^XM
"RTN","XMA32",101,0)
 . ;The date you entered is less than 1 year ago.
"RTN","XMA32",102,0)
 . W !!,$S($D(IORVON):IORVON,1:""),$S($D(IOBON):IOBON,1:""),$$EZBLD^DIALOG(36406),$S($D(IOBOFF):IOBOFF,1:""),$C(7),$S($D(IORVOFF):IORVOFF,1:"")
"RTN","XMA32",103,0)
 . K DIR
"RTN","XMA32",104,0)
 . S DIR(0)="Y"
"RTN","XMA32",105,0)
 . S DIR("A")=$$EZBLD^DIALOG(36407) ; Are you sure about this date
"RTN","XMA32",106,0)
 . S DIR("B")=$$EZBLD^DIALOG(39053) ; No
"RTN","XMA32",107,0)
 . D ^DIR I $D(DIRUT) S XMABORT=1 Q
"RTN","XMA32",108,0)
 . S XMOK=Y
"RTN","XMA32",109,0)
 . K DIR
"RTN","XMA32",110,0)
 Q:XMABORT
"RTN","XMA32",111,0)
 S XMDIFF=$$FMDIFF^XLFDT(DT,XMPARM("PDATE"),1)
"RTN","XMA32",112,0)
 I XMDIFF=XMPARM("PDAYS")!(XMDIFF<365)!(XMDIFF>9999) Q
"RTN","XMA32",113,0)
 W !
"RTN","XMA32",114,0)
 K DIR,X,Y
"RTN","XMA32",115,0)
 S XMVAR(1)=XMDIFF,XMVAR(2)=XMPARM("PDAYS")
"RTN","XMA32",116,0)
 S DIR(0)="Y"
"RTN","XMA32",117,0)
 ;You have chosen to purge messages older than |1| days old,
"RTN","XMA32",118,0)
 ;which is different from the current default of |2|.
"RTN","XMA32",119,0)
 ;Do you want |1| to be the new default
"RTN","XMA32",120,0)
 D BLD^DIALOG(36408,.XMVAR,"","DIR(""A"")")
"RTN","XMA32",121,0)
 S DIR("B")=$$EZBLD^DIALOG(39053) ; No
"RTN","XMA32",122,0)
 D BLD^DIALOG(36409,.XMVAR,"","DIR(""?"")")
"RTN","XMA32",123,0)
 ;Answer YES if you want field 10.03, DATE PURGE CUTOFF DAYS,
"RTN","XMA32",124,0)
 ;in file 4.3, MAILMAN SITE PARAMETERS, to be set to |1|.
"RTN","XMA32",125,0)
 ;Answer NO if you want that field to remain |2|.
"RTN","XMA32",126,0)
 ;You can also edit this field using option XMKSP."
"RTN","XMA32",127,0)
 D ^DIR I $D(DIRUT) S XMABORT=1 Q
"RTN","XMA32",128,0)
 I Y S $P(^XMB(1,1,.18),U,1)=XMDIFF
"RTN","XMA32",129,0)
 S XMPARM("PDAYS")=XMDIFF
"RTN","XMA32",130,0)
 Q
"RTN","XMA32",131,0)
TESTMODE(XMPARM,XMABORT) ;
"RTN","XMA32",132,0)
 I $D(ZTQUEUED) D  Q
"RTN","XMA32",133,0)
 . S XMPARM("TEST")=0
"RTN","XMA32",134,0)
 . S XMPARM("TYPE")=1
"RTN","XMA32",135,0)
 W !
"RTN","XMA32",136,0)
 N DIR,X,Y
"RTN","XMA32",137,0)
 S DIR(0)="Y",DIR("A")=$$EZBLD^DIALOG(36410) ; TEST mode
"RTN","XMA32",138,0)
 S DIR("B")=$$EZBLD^DIALOG(39054) ; YES
"RTN","XMA32",139,0)
 D BLD^DIALOG(36411,"","","DIR(""?"")")
"RTN","XMA32",140,0)
 ;Test mode will not kill off messages.
"RTN","XMA32",141,0)
 ;Test mode gives you a list of what would happen in 'real' mode.
"RTN","XMA32",142,0)
 ;If you do not run in test mode, messages will be KILLED!
"RTN","XMA32",143,0)
 ;Enter YES to run in 'test' mode; NO, 'real' mode.
"RTN","XMA32",144,0)
 D ^DIR I $D(DIRUT) S XMABORT=1 Q
"RTN","XMA32",145,0)
 S XMPARM("TEST")=Y
"RTN","XMA32",146,0)
 S XMPARM("TYPE")=$S(XMPARM("TEST"):2,1:1)
"RTN","XMA32",147,0)
 Q
"RTN","XMA32",148,0)
GRACE(XMPARM,XMABORT) ;
"RTN","XMA32",149,0)
 Q:$D(ZTQUEUED)
"RTN","XMA32",150,0)
 N XMTEXT
"RTN","XMA32",151,0)
 W !
"RTN","XMA32",152,0)
 I XMPARM("TEST") D  Q
"RTN","XMA32",153,0)
 . S XMPARM("GRACE")=0
"RTN","XMA32",154,0)
 . D BLD^DIALOG(36412,"","","XMTEXT","F")
"RTN","XMA32",155,0)
 . D MSG^DIALOG("WM","","","","XMTEXT")
"RTN","XMA32",156,0)
 . ;Since we are running in test mode, no warning bulletin will be sent.
"RTN","XMA32",157,0)
 D BLD^DIALOG(36412.1,"","","XMTEXT","F")
"RTN","XMA32",158,0)
 D MSG^DIALOG("WM","","","","XMTEXT")
"RTN","XMA32",159,0)
 ;If you queue this purge to run 3 or more days from now, I will send
"RTN","XMA32",160,0)
 ;a bulletin, XM DATE PURGE WARNING, to all users to warn them of the
"RTN","XMA32",161,0)
 ;coming date purge and tell them how to identify all of the messages
"RTN","XMA32",162,0)
 ;in their mailbox, which may be affected.
"RTN","XMA32",163,0)
 Q
"RTN","XMA32",164,0)
PROCESS(XMPARM) ;
"RTN","XMA32",165,0)
 N ZTSAVE,ZTRTN,ZTDESC,ZTSK,XMHNOW
"RTN","XMA32",166,0)
 S ZTSAVE("XMPARM*")=""
"RTN","XMA32",167,0)
 S ZTDESC=$$EZBLD^DIALOG(36413) ;MailMan: MESSAGE PURGE by DATE
"RTN","XMA32",168,0)
 S ZTRTN="ENT^XMA32A"
"RTN","XMA32",169,0)
 I '$D(ZTQUEUED) D  Q:'$D(ZTSK)
"RTN","XMA32",170,0)
 . S XMHNOW=$H
"RTN","XMA32",171,0)
 . D EN^XUTMDEVQ(ZTRTN,ZTDESC,.ZTSAVE,,1)
"RTN","XMA32",172,0)
 E  D
"RTN","XMA32",173,0)
 . S ZTDTH=$$HADD^XLFDT(ZTDTH,XMPARM("GRACE"))
"RTN","XMA32",174,0)
 . D ^%ZTLOAD
"RTN","XMA32",175,0)
 I '$D(ZTQUEUED),$$HDIFF^XLFDT(ZTSK("D"),XMHNOW,1)<3 D  Q
"RTN","XMA32",176,0)
 . N XMTEXT
"RTN","XMA32",177,0)
 . W !
"RTN","XMA32",178,0)
 . D BLD^DIALOG(36414,"","","XMTEXT","F")
"RTN","XMA32",179,0)
 . D MSG^DIALOG("WM","","","","XMTEXT")
"RTN","XMA32",180,0)
 . ;Since you scheduled the date purge less than 3 days from now,
"RTN","XMA32",181,0)
 . ;no warning bulletin has been sent.
"RTN","XMA32",182,0)
 N XMP,XMINSTR
"RTN","XMA32",183,0)
 S XMINSTR("VAPOR")=$$HTFM^XLFDT($$HADD^XLFDT(ZTSK("D"),,-1)) ; Vaporize 1 hr before purge
"RTN","XMA32",184,0)
 S XMINSTR("FROM")=.5
"RTN","XMA32",185,0)
 S XMP(1)=$$HTE^XLFDT(ZTSK("D"),5)
"RTN","XMA32",186,0)
 S XMP(2)=$$FMTE^XLFDT($$FMADD^XLFDT(XMPARM("PDATE"),-1),5)
"RTN","XMA32",187,0)
 S XMP(3)=$E("==========",1,$L(XMP(2)))
"RTN","XMA32",188,0)
 D TASKBULL^XMXAPI(DUZ,"XM DATE PURGE WARNING",.XMP,,"*",.XMINSTR)
"RTN","XMA32",189,0)
 Q:$D(ZTQUEUED)
"RTN","XMA32",190,0)
 W !
"RTN","XMA32",191,0)
 W $$EZBLD^DIALOG(36415) ;The warning bulletin has been sent.
"RTN","XMA32",192,0)
 Q
"RTN","XMA32A")
0^250^B32531975
"RTN","XMA32A",1,0)
XMA32A ;ISC-SF/GMB-Purge Messages by Date (cont.) ;04/17/2002  07:28
"RTN","XMA32A",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMA32A",3,0)
 ; Was (WASH ISC)/CAP
"RTN","XMA32A",4,0)
 ;
"RTN","XMA32A",5,0)
 ; XMPARM("PDATE") Purge all messages older than this date
"RTN","XMA32A",6,0)
 ; XMCNT           Total messages processed
"RTN","XMA32A",7,0)
 ; XMKILL("START") Messages in ^XMB(3.9 before purge started
"RTN","XMA32A",8,0)
 ; XMKILL("MSG")   Messages purged
"RTN","XMA32A",9,0)
 ; XMKILL("RESP")  Responses killed
"RTN","XMA32A",10,0)
 ; XMDUZ           Pointer to mailbox
"RTN","XMA32A",11,0)
 ; XMZ             Current message being processed
"RTN","XMA32A",12,0)
ENT ;
"RTN","XMA32A",13,0)
 N XMCRE8,XMIEN,XMCNT,XMKILL,XMHDR,XMABORT
"RTN","XMA32A",14,0)
 D INIT(.XMIEN,.XMPARM,.XMKILL,.XMHDR,.XMABORT)
"RTN","XMA32A",15,0)
 D PROCESS(XMIEN,.XMCRE8,.XMPARM,.XMKILL,.XMCNT,.XMHDR,.XMABORT)
"RTN","XMA32A",16,0)
 D FINISH(XMIEN,XMCRE8,.XMPARM,.XMKILL,XMCNT,.XMHDR,.XMABORT)
"RTN","XMA32A",17,0)
 Q
"RTN","XMA32A",18,0)
INIT(XMIEN,XMPARM,XMKILL,XMHDR,XMABORT) ;
"RTN","XMA32A",19,0)
 I IO'=IO(0) U IO
"RTN","XMA32A",20,0)
 S (XMHDR("PAGE"),XMKILL("MSG"),XMKILL("RESP"),XMABORT)=0
"RTN","XMA32A",21,0)
 S XMKILL("START")=$P(^XMB(3.9,0),U,4)
"RTN","XMA32A",22,0)
 D INITAUDT(.XMIEN,.XMPARM,.XMHDR)
"RTN","XMA32A",23,0)
 S XMHDR("PDATE")=$$FMTE^XLFDT(XMPARM("PDATE"),5)
"RTN","XMA32A",24,0)
 S XMHDR("NOW")=$$FMTE^XLFDT(XMHDR("NOW"),5)
"RTN","XMA32A",25,0)
 Q:IO=""
"RTN","XMA32A",26,0)
 W:IOST["C-" @IOF D PRTHDR(.XMPARM,.XMHDR)
"RTN","XMA32A",27,0)
 Q
"RTN","XMA32A",28,0)
INITAUDT(XMIEN,XMPARM,XMHDR) ;
"RTN","XMA32A",29,0)
 N XMFDA
"RTN","XMA32A",30,0)
 S XMHDR("NOW")=$$NOW^XLFDT
"RTN","XMA32A",31,0)
 S XMFDA(4.302,"+1,1,",.01)=XMHDR("NOW")
"RTN","XMA32A",32,0)
 S:$D(XMPARM("START")) XMFDA(4.302,"+1,1,",3)=XMPARM("START")
"RTN","XMA32A",33,0)
 S:$D(XMPARM("END")) XMFDA(4.302,"+1,1,",4)=XMPARM("END")
"RTN","XMA32A",34,0)
 S XMFDA(4.302,"+1,1,",5)=$S(XMPARM("TYPE")=2:"1TEST",1:XMPARM("TYPE"))
"RTN","XMA32A",35,0)
 S XMFDA(4.302,"+1,1,",6)=XMPARM("PDATE")
"RTN","XMA32A",36,0)
 D UPDATE^DIE("","XMFDA","XMIEN")
"RTN","XMA32A",37,0)
 S XMIEN=XMIEN(1)
"RTN","XMA32A",38,0)
 Q
"RTN","XMA32A",39,0)
PROCESS(XMIEN,XMCRE8,XMPARM,XMKILL,XMCNT,XMHDR,XMABORT) ;
"RTN","XMA32A",40,0)
 N XMZ,XMZREC
"RTN","XMA32A",41,0)
 S (XMCRE8,XMZ)="",XMCNT=0
"RTN","XMA32A",42,0)
 F  S XMCRE8=$O(^XMB(3.9,"C",XMCRE8)) Q:'XMCRE8  Q:XMCRE8'<XMPARM("PDATE")  D  Q:XMABORT
"RTN","XMA32A",43,0)
 . F  S XMZ=$O(^XMB(3.9,"C",XMCRE8,XMZ)) Q:'XMZ  D  Q:XMABORT
"RTN","XMA32A",44,0)
 . . S XMCNT=XMCNT+1 I XMCNT#5000=0 D CHK(XMIEN,XMCRE8,.XMPARM,.XMKILL,XMCNT,.XMHDR,.XMABORT)
"RTN","XMA32A",45,0)
 . . I '$D(^XMB(3.9,XMZ)) K ^XMB(3.9,"C",XMCRE8,XMZ) Q
"RTN","XMA32A",46,0)
 . . S XMZREC=$G(^XMB(3.9,XMZ,0))
"RTN","XMA32A",47,0)
 . . Q:$P(XMZREC,U,8)  ; Don't kill responses (they'll be purged when their original msg is)
"RTN","XMA32A",48,0)
 . . I "^^^^^^^^"[XMZREC D KILL(XMZ,.XMKILL,.XMABORT,.XMPARM,.XMHDR) Q
"RTN","XMA32A",49,0)
 . . Q:$D(^XMB(3.7,"M",XMZ,.6))  ; Do nothing if owned by SHARED,MAIL
"RTN","XMA32A",50,0)
 . . Q:$O(^XMB(3.7,"M",XMZ,.5,999))  ; Do nothing if in Transmit queues or Server basket.
"RTN","XMA32A",51,0)
 . . D KILL(XMZ,.XMKILL,.XMABORT,.XMPARM,.XMHDR)
"RTN","XMA32A",52,0)
 . . ; Old msg; old response without original msg;
"RTN","XMA32A",53,0)
 . . ; Old msg which thinks it's also a response;
"RTN","XMA32A",54,0)
 . . ; Old response which thinks it's also the original msg.
"RTN","XMA32A",55,0)
 Q
"RTN","XMA32A",56,0)
KILL(XMZ,XMKILL,XMABORT,XMPARM,XMHDR) ;
"RTN","XMA32A",57,0)
 I $G(XMPARM("TEST")) D  Q:XMABORT
"RTN","XMA32A",58,0)
 . D HDR(2,.XMPARM,.XMHDR,.XMABORT) Q:XMABORT
"RTN","XMA32A",59,0)
 . W !,XMZ,?20,$$EZBLD^DIALOG(36416),$$FMTE^XLFDT(XMCRE8,5) ; " <<< Purge!  Date = "
"RTN","XMA32A",60,0)
 D KBASKETS(XMZ,.XMKILL,.XMPARM,.XMHDR,.XMABORT) Q:XMABORT
"RTN","XMA32A",61,0)
 D KMSG(XMZ,.XMKILL,.XMPARM,.XMHDR,.XMABORT) Q:XMABORT
"RTN","XMA32A",62,0)
 D KLATER(XMZ,.XMPARM)
"RTN","XMA32A",63,0)
 Q
"RTN","XMA32A",64,0)
KBASKETS(XMZ,XMKILL,XMPARM,XMHDR,XMABORT) ;
"RTN","XMA32A",65,0)
 N XMDUZ,XMK
"RTN","XMA32A",66,0)
 S XMDUZ="",XMKILL("MSG")=XMKILL("MSG")+1
"RTN","XMA32A",67,0)
 F  S XMDUZ=$O(^XMB(3.7,"M",XMZ,XMDUZ)) Q:XMDUZ=""!XMABORT  D
"RTN","XMA32A",68,0)
 . S XMK=$O(^XMB(3.7,"M",XMZ,XMDUZ,0))
"RTN","XMA32A",69,0)
 . Q:'XMK
"RTN","XMA32A",70,0)
 . Q:'$D(^XMB(3.7,XMDUZ,2,XMK,1,XMZ))
"RTN","XMA32A",71,0)
 . I $G(XMPARM("TEST")) D  Q
"RTN","XMA32A",72,0)
 . . D HDR(2,.XMPARM,.XMHDR,.XMABORT) Q:XMABORT
"RTN","XMA32A",73,0)
 . . W !?25,$$EZBLD^DIALOG(36417),?50,$J(XMDUZ,12),?79 ; Message deleted for DUZ:
"RTN","XMA32A",74,0)
 . D ZAPIT^XMXMSGS2(XMDUZ,XMK,XMZ) ; Delete from user's basket
"RTN","XMA32A",75,0)
 Q
"RTN","XMA32A",76,0)
KMSG(XMZ,XMKILL,XMPARM,XMHDR,XMABORT) ;
"RTN","XMA32A",77,0)
 N XMZR,XMIEN,X
"RTN","XMA32A",78,0)
 S XMIEN=0
"RTN","XMA32A",79,0)
 F  S XMIEN=$O(^XMB(3.9,XMZ,3,XMIEN)) Q:XMIEN'>0!XMABORT  D
"RTN","XMA32A",80,0)
 . S XMZR=$P($G(^XMB(3.9,XMZ,3,XMIEN,0)),U)
"RTN","XMA32A",81,0)
 . S XMKILL("RESP")=XMKILL("RESP")+1
"RTN","XMA32A",82,0)
 . I $G(XMPARM("TEST")) D  Q
"RTN","XMA32A",83,0)
 . . D HDR(2,.XMPARM,.XMHDR,.XMABORT) Q:XMABORT
"RTN","XMA32A",84,0)
 . . W !?25,$$EZBLD^DIALOG(36418),?50,$J(XMZR,20),?79 ; Response deleted:
"RTN","XMA32A",85,0)
 . D KILLMSG^XMXUTIL(XMZR)  ; Kill response
"RTN","XMA32A",86,0)
 D:'$G(XMPARM("TEST")) KILLMSG^XMXUTIL(XMZ)  ; Kill original message
"RTN","XMA32A",87,0)
 Q
"RTN","XMA32A",88,0)
KLATER(XMZ,XMPARM) ;
"RTN","XMA32A",89,0)
 Q:$G(XMPARM("TEST"))
"RTN","XMA32A",90,0)
 N DIK,DA,XMDUZ
"RTN","XMA32A",91,0)
 S DIK="^XMB(3.73,"
"RTN","XMA32A",92,0)
 S (XMDUZ,DA)=""
"RTN","XMA32A",93,0)
 F  S XMDUZ=$O(^XMB(3.73,"AC",XMZ,XMDUZ)) Q:'XMDUZ  D
"RTN","XMA32A",94,0)
 . F  S DA=$O(^XMB(3.73,"AC",XMZ,XMDUZ,DA)) Q:'DA  D ^DIK
"RTN","XMA32A",95,0)
 Q
"RTN","XMA32A",96,0)
HDR(XMLINES,XMPARM,XMHDR,XMABORT) ;
"RTN","XMA32A",97,0)
 Q:$Y+XMLINES<IOSL
"RTN","XMA32A",98,0)
 I IOST["C-" D PAGE^XMXUTIL(.XMABORT) Q:XMABORT
"RTN","XMA32A",99,0)
 W @IOF D PRTHDR(.XMPARM,.XMHDR)
"RTN","XMA32A",100,0)
 Q
"RTN","XMA32A",101,0)
PRTHDR(XMPARM,XMHDR) ;
"RTN","XMA32A",102,0)
 S XMHDR("PAGE")=XMHDR("PAGE")+1
"RTN","XMA32A",103,0)
 W $$EZBLD^DIALOG(36419),XMHDR("PDATE") ; Message purge, local create date < 
"RTN","XMA32A",104,0)
 W ?70,$$EZBLD^DIALOG(34542,XMHDR("PAGE")) ; Page |1|
"RTN","XMA32A",105,0)
 W !,$$EZBLD^DIALOG(36420),XMHDR("NOW") ; Started:
"RTN","XMA32A",106,0)
 W:XMPARM("TEST") ?60,$$EZBLD^DIALOG(36421) ; *TEST RUN*
"RTN","XMA32A",107,0)
 W !
"RTN","XMA32A",108,0)
 Q
"RTN","XMA32A",109,0)
FINISH(XMIEN,XMCRE8,XMPARM,XMKILL,XMCNT,XMHDR,XMABORT) ;
"RTN","XMA32A",110,0)
 I $D(ZTQUEUED) S ZTREQ="@"
"RTN","XMA32A",111,0)
 I XMABORT,IO'="" W @IOF D PRTHDR(.XMPARM,.XMHDR)
"RTN","XMA32A",112,0)
 D CHK(XMIEN,XMCRE8,.XMPARM,.XMKILL,XMCNT,.XMHDR,.XMABORT)
"RTN","XMA32A",113,0)
 Q:IO=""!'XMCNT
"RTN","XMA32A",114,0)
 D HDR(5+(2*$G(ZTSTOP)),.XMPARM,.XMHDR,.XMABORT)
"RTN","XMA32A",115,0)
 I $G(ZTSTOP) W !,$$EZBLD^DIALOG(36422) ; *** Stopping prematurely per user request ***
"RTN","XMA32A",116,0)
 N XMVAR,XMTEXT
"RTN","XMA32A",117,0)
 S XMVAR(1)=$$FMTE^XLFDT($$NOW^XLFDT,5),XMVAR(2)=XMCNT
"RTN","XMA32A",118,0)
 S XMVAR(3)=XMKILL("MSG"),XMVAR(4)=XMKILL("RESP")
"RTN","XMA32A",119,0)
 W !
"RTN","XMA32A",120,0)
 D BLD^DIALOG(36423,.XMVAR,"","XMTEXT","F")
"RTN","XMA32A",121,0)
 D MSG^DIALOG("WM","","","","XMTEXT")
"RTN","XMA32A",122,0)
 ;Message purge finished on |1|.
"RTN","XMA32A",123,0)
 ;|2| messages processed.
"RTN","XMA32A",124,0)
 ;|3| original messages and |4| responses purged.
"RTN","XMA32A",125,0)
 Q
"RTN","XMA32A",126,0)
CHK(XMIEN,XMCRE8,XMPARM,XMKILL,XMCNT,XMHDR,XMABORT) ;
"RTN","XMA32A",127,0)
 D CHKAUDT(XMIEN,XMCRE8,.XMKILL)
"RTN","XMA32A",128,0)
 I $D(ZTQUEUED),$$S^%ZTLOAD S (XMABORT,ZTSTOP)=1 Q  ; User has asked the task to stop
"RTN","XMA32A",129,0)
 Q:IOST'["C-"
"RTN","XMA32A",130,0)
 I $X+$L(XMCNT)+1>IOM D
"RTN","XMA32A",131,0)
 . D HDR(2,.XMPARM,.XMHDR,.XMABORT)
"RTN","XMA32A",132,0)
 . W !
"RTN","XMA32A",133,0)
 E  W " "
"RTN","XMA32A",134,0)
 W XMCNT
"RTN","XMA32A",135,0)
 Q
"RTN","XMA32A",136,0)
CHKAUDT(XMIEN,XMCRE8,XMKILL) ;
"RTN","XMA32A",137,0)
 N XMFDA
"RTN","XMA32A",138,0)
 S XMFDA(4.302,XMIEN_",1,",1)=XMKILL("START")-XMKILL("MSG")-XMKILL("RESP")
"RTN","XMA32A",139,0)
 S XMFDA(4.302,XMIEN_",1,",2)=XMKILL("MSG")+XMKILL("RESP")
"RTN","XMA32A",140,0)
 S XMFDA(4.302,XMIEN_",1,",7)=$$NOW^XLFDT
"RTN","XMA32A",141,0)
 S XMFDA(4.302,XMIEN_",1,",8)=XMCRE8
"RTN","XMA32A",142,0)
 D FILE^DIE("","XMFDA")
"RTN","XMA32A",143,0)
 Q
"RTN","XMA33")
1^162
"RTN","XMA4")
1^120
"RTN","XMA5")
1^121
"RTN","XMA50")
1^122
"RTN","XMA51")
1^124
"RTN","XMA5A")
1^123
"RTN","XMA6")
1^125
"RTN","XMA7")
0^251^B27269
"RTN","XMA7",1,0)
XMA7 ;ISC-SF/GMB-User Info ;04/18/2002  07:22
"RTN","XMA7",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMA7",3,0)
 ; Was (WASH ISC)/RJ/THM/CAP
"RTN","XMA7",4,0)
 Q
"RTN","XMA7",5,0)
EN ; This entry point is used by Kernel (XU*, XQ*)
"RTN","XMA7",6,0)
 D DISPUSER^XMHIU(Y)
"RTN","XMA7",7,0)
 Q
"RTN","XMA7G")
1^127
"RTN","XMA7G1")
1^128
"RTN","XMAD")
1^163
"RTN","XMAD0")
1^129
"RTN","XMAD1")
1^130
"RTN","XMAD1A")
1^131
"RTN","XMAD1X")
1^132
"RTN","XMAD2")
0^252^B404128
"RTN","XMAD2",1,0)
XMAD2 ;ISC-SF/GMB-Basket lookup/create API ;04/17/2002  07:31
"RTN","XMAD2",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMAD2",3,0)
 ; Was (WASH ISC)/CAP
"RTN","XMAD2",4,0)
 ;
"RTN","XMAD2",5,0)
 ; Entry points (DBIA 1147):
"RTN","XMAD2",6,0)
 ; BSKT   Lookup/create a basket, return its number
"RTN","XMAD2",7,0)
 ;
"RTN","XMAD2",8,0)
BSKT(XMKN,XMDUZ) ; Find or Create a basket / return its internal number
"RTN","XMAD2",9,0)
 ; Needs:
"RTN","XMAD2",10,0)
 ; XMKN    Basket-name
"RTN","XMAD2",11,0)
 ; XMDUZ   User's DUZ
"RTN","XMAD2",12,0)
 N XMK,XMER
"RTN","XMAD2",13,0)
 S XMK=$$FIND1^DIC(3.701,","_XMDUZ_",","X",XMKN)
"RTN","XMAD2",14,0)
 Q:XMK XMK
"RTN","XMAD2",15,0)
 D CRE8BSKT^XMXAPIB(XMDUZ,XMKN,.XMK)
"RTN","XMAD2",16,0)
 Q:'$D(XMERR) XMK
"RTN","XMAD2",17,0)
 S XMER=^TMP("XMERR",$J,1,"TEXT",1)
"RTN","XMAD2",18,0)
 K XMERR,^TMP("XMERR",$J)
"RTN","XMAD2",19,0)
 Q XMER
"RTN","XMADA")
1^133
"RTN","XMADDOC")
1^134
"RTN","XMADDOC1")
1^135
"RTN","XMADDOC2")
1^136
"RTN","XMADGO")
0^253^B22926
"RTN","XMADGO",1,0)
XMADGO ;ISC-SF/GMB-Start Background Message Delivery ;04/17/2002  07:25
"RTN","XMADGO",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMADGO",3,0)
 ; Was (WASH ISC)/CAP
"RTN","XMADGO",4,0)
 ;
"RTN","XMADGO",5,0)
 ; Entry points (DBIA 10068):
"RTN","XMADGO",6,0)
 ; ZTSK     Start tasks to deliver messages in local delivery queues
"RTN","XMADGO",7,0)
ZTSK ; Start Background Delivery Processes
"RTN","XMADGO",8,0)
 G ZTSK^XMKPLQ
"RTN","XMADGO",9,0)
 Q
"RTN","XMADGO1")
1^137
"RTN","XMADJ999")
1^138
"RTN","XMADJF0")
1^139
"RTN","XMADJF1")
1^140
"RTN","XMADJF1A")
1^141
"RTN","XMADJF1B")
1^142
"RTN","XMAFTP")
0^254^B8113913
"RTN","XMAFTP",1,0)
XMAFTP ;(WASH ISC)/TCPIP-FTP Options ;04/17/2002  07:29
"RTN","XMAFTP",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMAFTP",3,0)
 ; Entry points used by MailMan options (not covered by DBIA):
"RTN","XMAFTP",4,0)
 ; GET     XM-FTP-GET
"RTN","XMAFTP",5,0)
 ; PUT     XM-FTP-PUT
"RTN","XMAFTP",6,0)
 Q
"RTN","XMAFTP",7,0)
GO ;Come here from GET or PUT (see tags below)
"RTN","XMAFTP",8,0)
 I ^%ZOSF("OS")'["VAX DSM" W !!,"Sorry...this option only works for VAX DSM" Q
"RTN","XMAFTP",9,0)
 N $ETRAP,$ESTACK S $ETRAP=""
"RTN","XMAFTP",10,0)
 S X="EXIT^XMAFTP",@^%ZOSF("TRAP")
"RTN","XMAFTP",11,0)
 N DIC,DIE,DIK,DD,DO,DTOUT,DUOUT,XMAFTP S XMAFTP=Z
"RTN","XMAFTP",12,0)
 S DIC="^XMBX(4.2995,",DIC(0)="AEQFZ",X="TMP"_$P($H,",",2)
"RTN","XMAFTP",13,0)
 S DIC("DR")="1///"_($H*86400+$P($H,",",2))_";2///"_$S($G(XMDUZ):XMDUZ,1:DUZ)_";4///"_Z
"RTN","XMAFTP",14,0)
 K DD,DO D FILE^DICN K DD,DO
"RTN","XMAFTP",15,0)
 Q:Y<0  S DIE=DIC,DA=+Y
"RTN","XMAFTP",16,0)
 S DIE("NO^")="BACKOUTOK"
"RTN","XMAFTP",17,0)
 ;
"RTN","XMAFTP",18,0)
 ;Ask data according to Get or Put option
"RTN","XMAFTP",19,0)
 S DR=$S(XMAFTP=1:"12;13;10;11;7;8;9",XMAFTP=2:"10;11;12;13;7;8;9",1:"")
"RTN","XMAFTP",20,0)
 G EXIT:DR=""
"RTN","XMAFTP",21,0)
 D ^DIE
"RTN","XMAFTP",22,0)
 G EXIT:$S(X="":1,$D(DTOUT):1,$D(DUOUT):1,1:0)
"RTN","XMAFTP",23,0)
 D SETXMF
"RTN","XMAFTP",24,0)
 W !!,"In process...it will take a little time to complete the transmission."
"RTN","XMAFTP",25,0)
 D FTP K XMSFTP
"RTN","XMAFTP",26,0)
 Q
"RTN","XMAFTP",27,0)
EXIT S DIK="^XMBX(4.2995," D ^DIK
"RTN","XMAFTP",28,0)
 I '$D(ZTQUEUED),'$D(XMCHAN) W !!,"Process Aborted !!!",$C(7)
"RTN","XMAFTP",29,0)
 Q
"RTN","XMAFTP",30,0)
SETXMF ;Set up XMSFTP array to use when doing tag FTP
"RTN","XMAFTP",31,0)
 S %1=$G(^XMBX(4.2995,DA,1))
"RTN","XMAFTP",32,0)
 S XMSFTP(4)=$P(%1,U,4)
"RTN","XMAFTP",33,0)
 S XMSFTP(5)=$P(%1,U,5)
"RTN","XMAFTP",34,0)
 I XMAFTP=1 S XMSFTP(1)=$P(%1,U,6),XMSFTP(2)=$P(%1,U,10),XMSFTP(2,"F")=$P(%1,U,9),XMSFTP(9)=$P(%1,U,7),XMSFTP(10)=$P(%1,U,8)
"RTN","XMAFTP",35,0)
 I XMAFTP=2 S XMSFTP(3)=$P(%1,U,6),XMSFTP(2)=$P(%1,U,8),XMSFTP(2,"F")=$P(%1,U,7),XMSFTP(9)=$P(%1,U,9),XMSFTP(10)=$P(%1,U,10)
"RTN","XMAFTP",36,0)
 Q
"RTN","XMAFTP",37,0)
FTP ;Set up 4.2995 entry and XMnn.COM file
"RTN","XMAFTP",38,0)
 N XMIO S XMIO=$I
"RTN","XMAFTP",39,0)
 S (XMSFTP,X)=$G(^XMBX(4.2995,"F",0))+1,^(0)=X
"RTN","XMAFTP",40,0)
 S FILE="XM"_X_".COM" O FILE:NEW U FILE
"RTN","XMAFTP",41,0)
 W "$! FTP COM procedure for fetching file from server and sending it",!
"RTN","XMAFTP",42,0)
 W "$ set noon",!
"RTN","XMAFTP",43,0)
 W "$ assign/user nla0: sys$output",! ; Turn off echo
"RTN","XMAFTP",44,0)
 W "$ assign/user sys$input sys$command",!
"RTN","XMAFTP",45,0)
 I $L($G(XMSFTP(3))),$L($G(XMSFTP(2))) W "$ set def "_XMSFTP(2),!
"RTN","XMAFTP",46,0)
 I $L($G(XMSFTP(1))),$L($G(XMSFTP(10))) W "$ set def "_XMSFTP(10),!
"RTN","XMAFTP",47,0)
 W "$ FTP=""$TWG$TCP:[NETDIST.USER]FTP",!
"RTN","XMAFTP",48,0)
 W "$ FTP "
"RTN","XMAFTP",49,0)
 I $L($G(XMSFTP(1))) W XMSFTP(1),!
"RTN","XMAFTP",50,0)
 E  W XMSFTP(3),!
"RTN","XMAFTP",51,0)
 S %2=$G(XMSFTP(4)) W %2,!
"RTN","XMAFTP",52,0)
 S %2=$G(XMSFTP(5)) I $L(%2) W %2,!
"RTN","XMAFTP",53,0)
 W "bin",!
"RTN","XMAFTP",54,0)
TT I XMAFTP=1 D
"RTN","XMAFTP",55,0)
 .I $L($G(XMSFTP(2))) W "cd "_XMSFTP(2),!
"RTN","XMAFTP",56,0)
 .W "get "_XMSFTP(2,"F")_" "_$G(XMSFTP(9)),!
"RTN","XMAFTP",57,0)
 I XMAFTP=2 D
"RTN","XMAFTP",58,0)
 .I $L($G(XMSFTP(10))) W "cd "_XMSFTP(10),!
"RTN","XMAFTP",59,0)
 .W "put "_XMSFTP(2,"F")_" "_$G(XMSFTP(9)),!
"RTN","XMAFTP",60,0)
 W "quit",!
"RTN","XMAFTP",61,0)
 S DIE="^XMBX(4.2995,",DR=".01////"_FILE D ^DIE
"RTN","XMAFTP",62,0)
 C FILE
"RTN","XMAFTP",63,0)
 K FILE
"RTN","XMAFTP",64,0)
 U XMIO
"RTN","XMAFTP",65,0)
 Q
"RTN","XMAFTP",66,0)
GET ;Entry for GET option
"RTN","XMAFTP",67,0)
 N Z S Z=1 G GO
"RTN","XMAFTP",68,0)
PUT ;Entry for PUT option
"RTN","XMAFTP",69,0)
 N Z S Z=2 G GO
"RTN","XMAH")
0^255^B2492368
"RTN","XMAH",1,0)
XMAH ;ISC-SF/GMB-List message responses API ;04/17/2002  07:31
"RTN","XMAH",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMAH",3,0)
 ; Was (WASH ISC)/CAP
"RTN","XMAH",4,0)
 ;
"RTN","XMAH",5,0)
 ; Entry points (DBIA 1040):
"RTN","XMAH",6,0)
 ; ENT8   List responses of a message
"RTN","XMAH",7,0)
 ;
"RTN","XMAH",8,0)
ENT8 ; List message responses
"RTN","XMAH",9,0)
 ; Needs:
"RTN","XMAH",10,0)
 ; XMZ   Message number
"RTN","XMAH",11,0)
 N XMV
"RTN","XMAH",12,0)
 D INITAPI^XMVVITAE
"RTN","XMAH",13,0)
 D HELPRESP^XMJMP1(XMZ,+$P($G(^XMB(3.9,XMZ,3,0)),U,4))
"RTN","XMAH",14,0)
 Q
"RTN","XMAH",15,0)
 ; **************************************************************
"RTN","XMAH",16,0)
 ; **************************************************************
"RTN","XMAH",17,0)
ENTB W !,"The message (SUBJECT: ",$P(Y,U),")"
"RTN","XMAH",18,0)
 W !,"is a   SPOOLED DOCUMENT.  It can only be deleted.  Deletion can occur"
"RTN","XMAH",19,0)
 W !,"only one at a time from the 'Message Action' prompt.",$C(7)
"RTN","XMAH",20,0)
 ;G D3^XMA0
"RTN","XMAH",21,0)
 Q
"RTN","XMAH",22,0)
SPOOL ;FROM XMA1 - HANDLE SPOOLED DOCUMENT INTERFACE
"RTN","XMAH",23,0)
 I '$F(":D:d:L:l:N:n",":"_$E(X)_":") S X="^" W !!,"SPOOLER messages may be DELETEd, NEWed or LATERed at this time.",$C(7),!! Q
"RTN","XMAH",24,0)
 Q:"Dd"'[$E(X_" ")
"RTN","XMAH",25,0)
 S DIR("A")="This a SPOOLER message.  Do you really want to delete it "
"RTN","XMAH",26,0)
 S DIR(0)="Y",DIR("B")="YES" D ^DIR K DIR,DIRUT
"RTN","XMAH",27,0)
 I X["^"!("Nn"[$E(X_" ")) S X="^" W !!,"NOT Deleted !!",$C(7) Q
"RTN","XMAH",28,0)
 D DEL^ZISPL S X="D"
"RTN","XMAH",29,0)
 Q
"RTN","XMAH",30,0)
 ; **************************************************************
"RTN","XMAH",31,0)
 ; **************************************************************
"RTN","XMAH0")
1^143
"RTN","XMAH1")
0^256^B3811256
"RTN","XMAH1",1,0)
XMAH1 ;ISC-SF/GMB-Reply to a message API ;04/17/2002  07:33
"RTN","XMAH1",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMAH1",3,0)
 ; Was (WASH ISC)/CAP
"RTN","XMAH1",4,0)
 ;
"RTN","XMAH1",5,0)
 ; Entry points (DBIA 1232):
"RTN","XMAH1",6,0)
 ; ^XMAH1      Interactive respond to a message
"RTN","XMAH1",7,0)
 ; ENTA^XMAH1  Interactive respond to a message
"RTN","XMAH1",8,0)
 ;
"RTN","XMAH1",9,0)
ENTA ; Interactive respond to a message
"RTN","XMAH1",10,0)
 ; Needs:
"RTN","XMAH1",11,0)
 ; XMDUZ  user ID
"RTN","XMAH1",12,0)
 ; XMK    basket number
"RTN","XMAH1",13,0)
 ; XMZ    message number
"RTN","XMAH1",14,0)
 ; Optional:
"RTN","XMAH1",15,0)
 ; XMDF   If $D(XMDF), then addressing restrictions are ignored.
"RTN","XMAH1",16,0)
 N XMV,XMSUBJ,XMFROM,XMINSTR,XMKN,XMIEN,XMRESP,XMRESPSO,XMPAKMAN,XMSECURE,XMABORT
"RTN","XMAH1",17,0)
 S XMABORT=0
"RTN","XMAH1",18,0)
 D INIT(XMDUZ,XMK,.XMKN,XMZ,.XMSUBJ,.XMFROM,.XMINSTR,.XMIEN,.XMRESPSO,.XMRESP,.XMABORT) Q:XMABORT
"RTN","XMAH1",19,0)
 D REPLY^XMJMR(XMDUZ,.XMK,.XMKN,XMZ,XMSUBJ,XMFROM,.XMINSTR,XMIEN,XMRESPSO,0,XMRESP)
"RTN","XMAH1",20,0)
 Q
"RTN","XMAH1",21,0)
INIT(XMDUZ,XMK,XMKN,XMZ,XMSUBJ,XMFROM,XMINSTR,XMIEN,XMRESPSO,XMRESP,XMABORT) ;
"RTN","XMAH1",22,0)
 N XMIM,XMIU,XMZREC
"RTN","XMAH1",23,0)
 D INITAPI^XMVVITAE
"RTN","XMAH1",24,0)
 K XMERR,^TMP("XMERR",$J)
"RTN","XMAH1",25,0)
 S XMZREC=^XMB(3.9,XMZ,0)
"RTN","XMAH1",26,0)
 I '$$REPLY^XMXSEC(XMDUZ,XMZ,XMZREC) D SHOW^XMJERR S XMABORT=1 Q
"RTN","XMAH1",27,0)
 I $D(XMDF) S XMINSTR("ADDR FLAGS")="R" ; no addressing restrictions
"RTN","XMAH1",28,0)
 D INMSG^XMXUTIL2(XMDUZ,0,XMZ,XMZREC,"I",.XMIM,.XMINSTR,.XMIU)
"RTN","XMAH1",29,0)
 I $D(XMINSTR("SCR HINT")),'$D(XMSECURE),'$$KEYOK^XMJMCODE(XMZ,XMINSTR("SCR HINT")) S XMABORT=1 Q
"RTN","XMAH1",30,0)
 S XMSUBJ=XMIM("SUBJ")
"RTN","XMAH1",31,0)
 S XMFROM=XMIM("FROM")
"RTN","XMAH1",32,0)
 S XMRESPSO=XMIM("RESPS")
"RTN","XMAH1",33,0)
 S XMIEN=XMIU("IEN")
"RTN","XMAH1",34,0)
 S XMRESP=XMIU("RESP")
"RTN","XMAH1",35,0)
 S XMPAKMAN=$S(XMINSTR("TYPE")["X":1,XMINSTR("TYPE")["K":1,1:0)
"RTN","XMAH1",36,0)
 S XMKN=$P(^XMB(3.7,XMDUZ,2,XMK,0),U,1)
"RTN","XMAH1",37,0)
 Q
"RTN","XMAI")
1^144
"RTN","XMAI0")
1^145
"RTN","XMAI1")
1^146
"RTN","XMAI2")
0^257^B4319906
"RTN","XMAI2",1,0)
XMAI2 ;ISC-SF/GMB -Send a message if too many messages ;04/19/2002  12:41
"RTN","XMAI2",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMAI2",3,0)
 ; Was (WASH ISC)/CAP/L.RHODE
"RTN","XMAI2",4,0)
 ; Entry points used by MailMan options (not covered by DBIA):
"RTN","XMAI2",5,0)
 ; ENTER   XMMGR-DISK-MANY-MESSAGE-MAINT
"RTN","XMAI2",6,0)
ENTER ;
"RTN","XMAI2",7,0)
 N XMMAX,XMSAVE,XMABORT,I
"RTN","XMAI2",8,0)
 S XMABORT=0
"RTN","XMAI2",9,0)
 D INIT(.XMMAX,.XMABORT) Q:XMABORT
"RTN","XMAI2",10,0)
 I $D(ZTQUEUED) D PROCESS Q
"RTN","XMAI2",11,0)
 F I="XMMAX" S XMSAVE(I)="" ;MailMan: Many Msg Maint Request
"RTN","XMAI2",12,0)
 D EN^XUTMDEVQ("PROCESS^XMAI2",$$EZBLD^DIALOG(36600),.XMSAVE)
"RTN","XMAI2",13,0)
 Q
"RTN","XMAI2",14,0)
INIT(XMMAX,XMABORT) ;
"RTN","XMAI2",15,0)
 S XMMAX=500 ; Threshold number of messages a user can own
"RTN","XMAI2",16,0)
 Q:$D(ZTQUEUED)
"RTN","XMAI2",17,0)
 N DIR,Y,DIRUT,XMTEXT
"RTN","XMAI2",18,0)
 W !
"RTN","XMAI2",19,0)
 ;This option sends a message to every user who has more than a
"RTN","XMAI2",20,0)
 ;certain number of messages in his or her mailbox, asking the user
"RTN","XMAI2",21,0)
 ;to terminate unnecessary messages.
"RTN","XMAI2",22,0)
 D BLD^DIALOG(36601,"","","XMTEXT","F")
"RTN","XMAI2",23,0)
 D MSG^DIALOG("WM","","","","XMTEXT")
"RTN","XMAI2",24,0)
 W !
"RTN","XMAI2",25,0)
 S DIR(0)="N^10::"
"RTN","XMAI2",26,0)
 S DIR("A")=$$EZBLD^DIALOG(36602) ;Enter the 'many message' threshold
"RTN","XMAI2",27,0)
 S DIR("B")=XMMAX
"RTN","XMAI2",28,0)
 D BLD^DIALOG(36603,"","","DIR(""?"")") ;How many messages may a user have before MailMan sends a nastygram?
"RTN","XMAI2",29,0)
 D ^DIR I $D(DIRUT) S XMABORT=1 Q
"RTN","XMAI2",30,0)
 S XMMAX=Y
"RTN","XMAI2",31,0)
 W !
"RTN","XMAI2",32,0)
 ;Messages will be sent to owners of more than |1| messages.
"RTN","XMAI2",33,0)
 ;This option may take awhile - you may wish to queue it.
"RTN","XMAI2",34,0)
 D BLD^DIALOG(36604,XMMAX,"","XMTEXT","F")
"RTN","XMAI2",35,0)
 D MSG^DIALOG("WM","","","","XMTEXT")
"RTN","XMAI2",36,0)
 Q
"RTN","XMAI2",37,0)
PROCESS ; (Requires XMMAX)
"RTN","XMAI2",38,0)
 N XMUSER,XMCNT
"RTN","XMAI2",39,0)
 S XMUSER=.9999
"RTN","XMAI2",40,0)
 F  S XMUSER=$O(^XMB(3.7,XMUSER)) Q:XMUSER'>0  D
"RTN","XMAI2",41,0)
 . S XMCNT=$$TMSGCT^XMXUTIL(XMUSER)
"RTN","XMAI2",42,0)
 . D:XMCNT>XMMAX MESSAGE(XMUSER,XMCNT)
"RTN","XMAI2",43,0)
 S:$D(ZTQUEUED) ZTREQ="@"
"RTN","XMAI2",44,0)
 Q
"RTN","XMAI2",45,0)
MESSAGE(XMTO,XMCNT) ; Send message
"RTN","XMAI2",46,0)
 N XMPARM,XMINSTR
"RTN","XMAI2",47,0)
 S XMINSTR("FROM")=.5,XMINSTR("FLAGS")="I"
"RTN","XMAI2",48,0)
 S XMPARM(1)=XMCNT,XMPARM(2)=$$BMSGCT^XMXUTIL(XMTO,1)
"RTN","XMAI2",49,0)
 D TASKBULL^XMXBULL(.5,"XM TOO MANY MESSAGES",.XMPARM,"",XMTO,.XMINSTR)
"RTN","XMAI2",50,0)
 Q
"RTN","XMAK")
1^147
"RTN","XMAL0")
1^148
"RTN","XMAL0A")
1^149
"RTN","XMANON")
1^150
"RTN","XMAP")
1^151
"RTN","XMAP0")
1^152
"RTN","XMAP1")
1^153
"RTN","XMAPBLOB")
0^258^B9485803
"RTN","XMAPBLOB",1,0)
XMAPBLOB ;(WASH ISC)/CAP-DISPLAY BLOBs ;04/18/2002  07:22
"RTN","XMAPBLOB",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMAPBLOB",3,0)
 ;BLOB display
"RTN","XMAPBLOB",4,0)
BLOB Q:'$O(^XMB(3.9,XMZ,2005,0))
"RTN","XMAPBLOB",5,0)
 N %,I,XMA0,XMB0,MAGFILE2,MAGFILE
"RTN","XMAPBLOB",6,0)
 S XMA0=0,XMB0=0 I '$D(XMAPBLOB) S XMAPBLOB=1
"RTN","XMAPBLOB",7,0)
B S XMA0=$O(^XMB(3.9,XMZ,2005,XMA0)) G BQ:'XMA0 S %=+^(XMA0,0)
"RTN","XMAPBLOB",8,0)
 S XMB0=XMB0+1,XMA0(XMB0)=%,MAGXX=%
"RTN","XMAPBLOB",9,0)
 I $L($T(IMPORT^MAGBAPI)) S %=$$IMPORT^MAGBAPI("MAIL^"_MAGXX)
"RTN","XMAPBLOB",10,0)
 D ^MAGFILE
"RTN","XMAPBLOB",11,0)
 S XMA0(XMB0)=XMA0(XMB0)_U_MAGFILE1(.01)_"^^^^^^^"_MAGFILE
"RTN","XMAPBLOB",12,0)
 G B
"RTN","XMAPBLOB",13,0)
BQ S X=$O(XMA0(0)) I X,'$O(XMA0(X)) Q:$G(XMAPBLOB("DISPDONE"))
"RTN","XMAPBLOB",14,0)
 S XMAPBLOB("DISPDONE")=1
"RTN","XMAPBLOB",15,0)
 I XMB0=1 G CLRQ:$$ASK()="",PRTQ:$G(XMAPBLOB)>99 S (X,XMA0)=+XMA0(1) I 1
"RTN","XMAPBLOB",16,0)
 E  I $S($G(IOT)="IMPC":1,1:0) S X=$$BLIST() G CLRQ:X="" S XMA0=X
"RTN","XMAPBLOB",17,0)
 D ^MAGOBJ(X,"DISPLAY","")
"RTN","XMAPBLOB",18,0)
 I $S(XMB0=1:1,$O(XMA0(XMA0))=""&$O(XMA0(0))="":1,1:0) Q
"RTN","XMAPBLOB",19,0)
 G BQ
"RTN","XMAPBLOB",20,0)
CLRQ I $G(XMAPBLOB)>99 Q
"RTN","XMAPBLOB",21,0)
 G ERASE^MAGAPI
"RTN","XMAPBLOB",22,0)
 ;
"RTN","XMAPBLOB",23,0)
BLIST() ;List BLOBS in the message
"RTN","XMAPBLOB",24,0)
 I $G(IOT)="IMPC",$G(XMAPBLOB)>99 Q ""
"RTN","XMAPBLOB",25,0)
 N X,Y,DIR,DIRUT,DUOUT
"RTN","XMAPBLOB",26,0)
 I '$G(XMAPBLOB("D")),$Y>(IOSL-4) K DIR S DIR(0)="E" D ^DIR:$G(XMAPBLOB)<100 K DIR,DIRUT
"RTN","XMAPBLOB",27,0)
 I '$G(XMAPBLOB("D")) W !,"============================================================="
"RTN","XMAPBLOB",28,0)
 I  W !!,"There are non-textual parts (BLOBs) included on this message"
"RTN","XMAPBLOB",29,0)
 S XMAPBLOB("D")=1 W !!,"Object Name",?70,"Filename"
"RTN","XMAPBLOB",30,0)
 F I=0:0 S I=$O(XMA0(I)) Q:'I  W !,I_". "_$E($P(XMA0(I),U,2),1,68),?70,$E($P(XMA0(I),U,9),1,9)
"RTN","XMAPBLOB",31,0)
A I $G(XMAPBLOB)>99 Q ""
"RTN","XMAPBLOB",32,0)
 W !!,"Pick a BLOB you wish to display from the above list (1-"_XMB0_"): NONE// " R X:DTIME
"RTN","XMAPBLOB",33,0)
 S X=$TR(X,"none","NONE") I $E("NONE",1,$L(X))=X!("^"[X) Q ""
"RTN","XMAPBLOB",34,0)
 I +X'=X W !!,"Choose the index number of the BLOB you wish to display or accept the default.",! G A
"RTN","XMAPBLOB",35,0)
 I '$D(XMA0(X)) W !!,"Please choose a listed item by typing in its index number." G A
"RTN","XMAPBLOB",36,0)
 Q +XMA0(X)
"RTN","XMAPBLOB",37,0)
 ;Ask if user wants to display single BLOB
"RTN","XMAPBLOB",38,0)
ASK() I $G(XMAPBLOB)>99 Q 2
"RTN","XMAPBLOB",39,0)
 N DIR,DIRUT,DUOUT
"RTN","XMAPBLOB",40,0)
 S DIR(0)="Y",DIR("A")="Execute Other Message Part ("_$P(XMA0(1),U,2)_") Attached ",DIR("B")="NO"
"RTN","XMAPBLOB",41,0)
 D ^DIR K DIRUT I 'Y!$D(DIRUT) Q ""
"RTN","XMAPBLOB",42,0)
 Q 1
"RTN","XMAPBLOB",43,0)
NODISP ;If not proper terminal
"RTN","XMAPBLOB",44,0)
 Q:$G(XMAPBLOB("D"))  S XMAPBLOB("D")=1 Q:'$D(^XMB(3.9,XMZ,2005))
"RTN","XMAPBLOB",45,0)
 W !!,"================================================================="
"RTN","XMAPBLOB",46,0)
 W !,"There are non-textual body parts (BLOBs) attached to this"
"RTN","XMAPBLOB",47,0)
 W !,"message.  You may not execute them (display...) because you"
"RTN","XMAPBLOB",48,0)
 W !,"are not using the proper terminal."
"RTN","XMAPBLOB",49,0)
 W !!,"Query the message to see the list of BLOBs attached."
"RTN","XMAPBLOB",50,0)
 W !,"================================================================="
"RTN","XMAPBLOB",51,0)
 Q
"RTN","XMAPBLOB",52,0)
PRT ;Print BLOB list
"RTN","XMAPBLOB",53,0)
 N MAGOBJ,MAGFILE,MAGFILE1,MAGROU,X,XMAPBLOB S XMAPBLOB=100
"RTN","XMAPBLOB",54,0)
 D BLOB Q
"RTN","XMAPBLOB",55,0)
PRTQ S X=$$BLIST() Q
"RTN","XMAPHOST")
0^259^B29772497
"RTN","XMAPHOST",1,0)
XMAPHOST ;(WASH ISC)/KMB/CAP-Print to Message (P-MESSAGE) ;04/06/2002  08:39
"RTN","XMAPHOST",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMAPHOST",3,0)
 ;
"RTN","XMAPHOST",4,0)
 ;This routine is called as a close execute for the P-Message device
"RTN","XMAPHOST",5,0)
 ;to put reports written to host files (DOS,VMS...) into mail messages.
"RTN","XMAPHOST",6,0)
 ;
"RTN","XMAPHOST",7,0)
 ;It has one idiosyncracy.  If the report contains one single line
"RTN","XMAPHOST",8,0)
 ;or two lines separated with only a $C(13) instead of a CR/LF that is
"RTN","XMAPHOST",9,0)
 ;more than 254 characters long, there will be unexpected results.
"RTN","XMAPHOST",10,0)
 ;
"RTN","XMAPHOST",11,0)
 D INIT(.XMDUZ,.XMAPHOST)
"RTN","XMAPHOST",12,0)
 S %=$S($D(XMAPSUBJ):XMAPSUBJ,$D(XMSUB):XMSUB,1:"")
"RTN","XMAPHOST",13,0)
 D CRE8MSG(XMDUZ,.%,.XMAPHOST)
"RTN","XMAPHOST",14,0)
 Q
"RTN","XMAPHOST",15,0)
INIT(XMDUZ,XMAPHOST) ;
"RTN","XMAPHOST",16,0)
 I '$G(DUZ) D
"RTN","XMAPHOST",17,0)
 . I '$D(ZTQUEUED) U IO(0) W !,$C(7),$$EZBLD^DIALOG(34230) U IO ; No user id
"RTN","XMAPHOST",18,0)
 . S (XMAPHOST("SET XMDUZ"),XMAPHOST("SET DUZ"))=1
"RTN","XMAPHOST",19,0)
 . S (XMDUZ,DUZ)=.5
"RTN","XMAPHOST",20,0)
 I '$D(^XMB(3.7,DUZ,0)) D
"RTN","XMAPHOST",21,0)
 . I '$D(ZTQUEUED) U IO(0) W !,$C(7),$$EZBLD^DIALOG(34231) U IO ; No mailbox
"RTN","XMAPHOST",22,0)
 . S (XMAPHOST("SET XMDUZ"),XMAPHOST("SET DUZ"))=1
"RTN","XMAPHOST",23,0)
 . S (XMDUZ,DUZ)=.5
"RTN","XMAPHOST",24,0)
 I '$D(XMDUZ) S XMDUZ=DUZ,XMAPHOST("SET XMDUZ")=1
"RTN","XMAPHOST",25,0)
 I '$D(^XMB(3.7,XMDUZ,0)) D
"RTN","XMAPHOST",26,0)
 . I '$D(ZTQUEUED) U IO(0) W !,$C(7),$$EZBLD^DIALOG(34231) U IO ; No mailbox
"RTN","XMAPHOST",27,0)
 . S (XMAPHOST("SET XMDUZ"),XMAPHOST("SET DUZ"))=1
"RTN","XMAPHOST",28,0)
 . S (XMDUZ,DUZ)=.5
"RTN","XMAPHOST",29,0)
 I '$D(XMV("NAME")) D INITAPI^XMVVITAE S XMAPHOST("SET XMV")=1
"RTN","XMAPHOST",30,0)
 I '$D(ZTQUEUED) K XMY,XMY0
"RTN","XMAPHOST",31,0)
 Q
"RTN","XMAPHOST",32,0)
CRE8MSG(XMDUZ,XMSUBJ,XMAPHOST) ;
"RTN","XMAPHOST",33,0)
 N XMZ
"RTN","XMAPHOST",34,0)
 D INIT^XMXADDR
"RTN","XMAPHOST",35,0)
 K XMERR,^TMP("XMERR",$J)
"RTN","XMAPHOST",36,0)
 I $D(ZTQUEUED) D
"RTN","XMAPHOST",37,0)
 . S XMSUBJ=$S($L($G(XMSUBJ))>3:XMSUBJ,1:$$EZBLD^DIALOG(34233,XMV("NAME"))) ; queued mail report from
"RTN","XMAPHOST",38,0)
 E  D
"RTN","XMAPHOST",39,0)
 . U IO(0) W !!,$$EZBLD^DIALOG(34234) U IO ; moving text to msg
"RTN","XMAPHOST",40,0)
 . I $L($G(XMSUBJ))<4 K XMSUBJ
"RTN","XMAPHOST",41,0)
 . D GETSUBJ(.XMSUBJ)
"RTN","XMAPHOST",42,0)
 D CRE8XMZ^XMXSEND(XMSUBJ,.XMZ)
"RTN","XMAPHOST",43,0)
 S XMAPHOST("XMZ")=XMZ,XMAPHOST("XMSUB")=XMSUBJ
"RTN","XMAPHOST",44,0)
 Q
"RTN","XMAPHOST",45,0)
READ ; Read the host file into a message, send it, erase it.
"RTN","XMAPHOST",46,0)
 ; Read record from file.
"RTN","XMAPHOST",47,0)
 ; Each time <CR> is found in record it ends a message line.
"RTN","XMAPHOST",48,0)
 N XMNULCNT,XMLEN,XMOS,XMZ,XMREC,XMI,XMLIMIT
"RTN","XMAPHOST",49,0)
 I $$NEWERR^%ZTER N $ETRAP,$ESTACK S $ETRAP=""
"RTN","XMAPHOST",50,0)
 S X="EOF^XMAPHOST",@^%ZOSF("TRAP")
"RTN","XMAPHOST",51,0)
 S XMLIMIT=$P($G(^XMB(1,1,.16)),U) ; P-MESSAGE LINE LIMIT
"RTN","XMAPHOST",52,0)
 S:'XMLIMIT XMLIMIT=999999999999999
"RTN","XMAPHOST",53,0)
 S (XMNULCNT,XMI,XMCUTOFF)=0,XMREC="",XMZ=XMAPHOST("XMZ"),XMOS=^%ZOSF("OS")
"RTN","XMAPHOST",54,0)
 I '$D(ZTQUEUED) U IO(0) W !,"." U IO
"RTN","XMAPHOST",55,0)
 E  U IO
"RTN","XMAPHOST",56,0)
 F  S XMREC=$$GET() Q:$G(XMAPHOST("EOF"))  D  Q:$G(XMAPHOST("EOF"))!(XMI>XMLIMIT)
"RTN","XMAPHOST",57,0)
 . I XMREC="" S XMNULCNT=XMNULCNT+1 Q:XMNULCNT>999  ; consecutive null lines
"RTN","XMAPHOST",58,0)
 . E  S XMNULCNT=0
"RTN","XMAPHOST",59,0)
 . S XMLEN=$L(XMREC)
"RTN","XMAPHOST",60,0)
 . F  D  Q:XMREC=""!$G(XMAPHOST("EOF"))
"RTN","XMAPHOST",61,0)
 . . D PUT(XMZ,$P(XMREC,$C(13)),.XMI)
"RTN","XMAPHOST",62,0)
 . . S XMREC=$P(XMREC,$C(13),2,999)
"RTN","XMAPHOST",63,0)
 . . Q:XMREC=""
"RTN","XMAPHOST",64,0)
 . . S:XMLEN>254 XMREC=XMREC_$$GET(),XMLEN=0
"RTN","XMAPHOST",65,0)
 D EOF
"RTN","XMAPHOST",66,0)
 Q
"RTN","XMAPHOST",67,0)
PUT(XMZ,XMREC,XMI) ; Put data into message.
"RTN","XMAPHOST",68,0)
 S XMI=XMI+1,^XMB(3.9,XMZ,2,XMI,0)=$S(XMREC'?.E1C.E:XMREC,1:$$CTRL^XMXUTIL1(XMREC))
"RTN","XMAPHOST",69,0)
 I '$D(ZTQUEUED),XMI#10=0 U IO(0) W "." U IO
"RTN","XMAPHOST",70,0)
 Q
"RTN","XMAPHOST",71,0)
GET() ; Read a record from the file
"RTN","XMAPHOST",72,0)
 N Y,X
"RTN","XMAPHOST",73,0)
 G:$D(XMAPHOST("EOF")) GETR
"RTN","XMAPHOST",74,0)
 I $$NEWERR^%ZTER N $ETRAP,$ESTACK S $ETRAP=""
"RTN","XMAPHOST",75,0)
 S X="GETQ^XMAPHOST",@^%ZOSF("TRAP")
"RTN","XMAPHOST",76,0)
GETR R Y#255:1
"RTN","XMAPHOST",77,0)
 I XMOS["MSM" G GETQ:$ZC'=0 Q Y
"RTN","XMAPHOST",78,0)
 Q Y
"RTN","XMAPHOST",79,0)
GETQ S XMAPHOST("EOF")=1
"RTN","XMAPHOST",80,0)
 Q ""
"RTN","XMAPHOST",81,0)
EOF ;
"RTN","XMAPHOST",82,0)
 I '$$NEWERR^%ZTER S X="ERR^ZU",@^%ZOSF("TRAP")
"RTN","XMAPHOST",83,0)
 I XMI>XMLIMIT D
"RTN","XMAPHOST",84,0)
 . S XMI=XMI+1,^XMB(3.9,XMZ,2,XMI,0)=""
"RTN","XMAPHOST",85,0)
 . S XMI=XMI+1,^XMB(3.9,XMZ,2,XMI,0)="*******************************************************************"
"RTN","XMAPHOST",86,0)
 . S XMI=XMI+1,^XMB(3.9,XMZ,2,XMI,0)=$$EZBLD^DIALOG(34235,XMLIMIT)
"RTN","XMAPHOST",87,0)
 . S XMI=XMI+1,^XMB(3.9,XMZ,2,XMI,0)="*******************************************************************"
"RTN","XMAPHOST",88,0)
 . Q:$D(ZTQUEUED)
"RTN","XMAPHOST",89,0)
 . U IO(0) W !,$$EZBLD^DIALOG(34235,XMLIMIT),!
"RTN","XMAPHOST",90,0)
 E  I '$D(ZTQUEUED) U IO(0) W !,$$EZBLD^DIALOG(34236),! ; Finished moving.
"RTN","XMAPHOST",91,0)
 S ^XMB(3.9,XMAPHOST("XMZ"),2,0)="^3.92A^"_XMI_"^"_XMI
"RTN","XMAPHOST",92,0)
 D SENDMSG
"RTN","XMAPHOST",93,0)
 D CLEANUP
"RTN","XMAPHOST",94,0)
 Q
"RTN","XMAPHOST",95,0)
SENDMSG ; Here, send the message to recipient.
"RTN","XMAPHOST",96,0)
 N XMZ,XMFROM,XMINSTR,XMABORT
"RTN","XMAPHOST",97,0)
 S XMZ=XMAPHOST("XMZ")
"RTN","XMAPHOST",98,0)
 S XMFROM=$P($G(^XMB(3.7,XMDUZ,16)),U,3)
"RTN","XMAPHOST",99,0)
 K XMERR,^TMP("XMERR",$J)
"RTN","XMAPHOST",100,0)
 I $D(ZTQUEUED) D
"RTN","XMAPHOST",101,0)
 . I XMFROM="P" S XMINSTR("FROM")=.5
"RTN","XMAPHOST",102,0)
 . S XMY(XMDUZ)=""
"RTN","XMAPHOST",103,0)
 . D CHKADDR^XMXADDR(XMDUZ,.XMY,.XMINSTR)
"RTN","XMAPHOST",104,0)
 . K XMY
"RTN","XMAPHOST",105,0)
 E  D  ; ask the user for recipients.
"RTN","XMAPHOST",106,0)
 . U IO(0)
"RTN","XMAPHOST",107,0)
 . S XMABORT=0
"RTN","XMAPHOST",108,0)
 . D FROMWHOM(XMDUZ,XMFROM,.XMINSTR,.XMABORT) Q:XMABORT
"RTN","XMAPHOST",109,0)
 . D TOWHOM^XMJMT(XMDUZ,$$EZBLD^DIALOG(34110),.XMINSTR,"",.XMABORT) ; send
"RTN","XMAPHOST",110,0)
 . U IO
"RTN","XMAPHOST",111,0)
 I '$$GOTADDR^XMXADDR D  Q
"RTN","XMAPHOST",112,0)
 . D KILLMSG^XMXUTIL(XMZ)
"RTN","XMAPHOST",113,0)
 . K XMERR,^TMP("XMERR",$J)
"RTN","XMAPHOST",114,0)
 D MOVEPART^XMXSEND(XMDUZ,XMZ,.XMINSTR)
"RTN","XMAPHOST",115,0)
 I $D(XMINSTR("FROM")),$D(XMINSTR("SELF BSKT")) D
"RTN","XMAPHOST",116,0)
 . D FWD^XMKP(XMDUZ,XMZ,.XMINSTR)
"RTN","XMAPHOST",117,0)
 E  D
"RTN","XMAPHOST",118,0)
 . D SEND^XMKP(XMDUZ,XMZ,.XMINSTR)
"RTN","XMAPHOST",119,0)
 D CHECK^XMKPL
"RTN","XMAPHOST",120,0)
 I '$D(ZTQUEUED) D
"RTN","XMAPHOST",121,0)
 . N XMPARM
"RTN","XMAPHOST",122,0)
 . S XMPARM(1)=XMAPHOST("XMSUB"),XMPARM(2)=XMZ
"RTN","XMAPHOST",123,0)
 . U IO(0) W !,$$EZBLD^DIALOG(34238,.XMPARM),! H 3
"RTN","XMAPHOST",124,0)
 K XMERR,^TMP("XMERR",$J)
"RTN","XMAPHOST",125,0)
 Q
"RTN","XMAPHOST",126,0)
FROMWHOM(XMDUZ,XMFROM,XMINSTR,XMABORT) ;
"RTN","XMAPHOST",127,0)
 N DIR,X,Y,XMME,XMPOST
"RTN","XMAPHOST",128,0)
 S DIR("A")=$$EZBLD^DIALOG(34239) ; From whom
"RTN","XMAPHOST",129,0)
 S XMME=$$EZBLD^DIALOG(34240)   ; me
"RTN","XMAPHOST",130,0)
 S XMPOST=$$EZBLD^DIALOG(34241) ; postmaster
"RTN","XMAPHOST",131,0)
 S DIR(0)="S^"_XMME_";"_XMPOST
"RTN","XMAPHOST",132,0)
 S DIR("B")=$S(XMFROM="P":$P(XMPOST,":",2,9),1:$P(XMME,":",2,9))
"RTN","XMAPHOST",133,0)
 D BLD^DIALOG(34242,"","","DIR(""?"")")
"RTN","XMAPHOST",134,0)
 D ^DIR I $D(DIRUT) S XMABORT=1 Q
"RTN","XMAPHOST",135,0)
 I Y=$P(XMPOST,":",1) S XMINSTR("FROM")=.5
"RTN","XMAPHOST",136,0)
 Q
"RTN","XMAPHOST",137,0)
CLEANUP ;
"RTN","XMAPHOST",138,0)
 S IONOFF=1 ;Prevent form feed during device close
"RTN","XMAPHOST",139,0)
 D CLEANUP^XMXADDR
"RTN","XMAPHOST",140,0)
 K:$G(XMAPHOST("SET DUZ")) DUZ
"RTN","XMAPHOST",141,0)
 K:$G(XMAPHOST("SET XMDUZ")) XMDUZ
"RTN","XMAPHOST",142,0)
 K:$G(XMAPHOST("SET XMV")) XMV
"RTN","XMAPHOST",143,0)
 K %,XMAPHOST
"RTN","XMAPHOST",144,0)
 Q
"RTN","XMAPHOST",145,0)
GETSUBJ(XMSUBJ) ;
"RTN","XMAPHOST",146,0)
 N XMABORT,XMHOLD
"RTN","XMAPHOST",147,0)
 S:$D(XMSUBJ) XMHOLD=XMSUBJ
"RTN","XMAPHOST",148,0)
 U IO(0)
"RTN","XMAPHOST",149,0)
 F  D  Q:'XMABORT
"RTN","XMAPHOST",150,0)
 . S XMABORT=0
"RTN","XMAPHOST",151,0)
 . D SUBJ^XMJMS(.XMSUBJ,.XMABORT)
"RTN","XMAPHOST",152,0)
 . Q:'XMABORT
"RTN","XMAPHOST",153,0)
 . S:$D(XMHOLD) XMSUBJ=XMHOLD
"RTN","XMAPHOST",154,0)
 . W !!,$$EZBLD^DIALOG(34232) ; too late to stop
"RTN","XMAPHOST",155,0)
 U IO
"RTN","XMAPHOST",156,0)
 Q
"RTN","XMAPHOST",157,0)
 ;34110     Send
"RTN","XMAPHOST",158,0)
 ;34230     No user identity.  Using Postmaster as
"RTN","XMAPHOST",159,0)
 ;34231     You do not have a mailbox.  Using Post
"RTN","XMAPHOST",160,0)
 ;34232     Sorry, I cannot stop the creation of this
"RTN","XMAPHOST",161,0)
 ;34233     Queued Mail Report from |1|
"RTN","XMAPHOST",162,0)
 ;34234     Moving text to MailMan message...
"RTN","XMAPHOST",163,0)
 ;34235     P-MESSAGE line limit of |1| reached.
"RTN","XMAPHOST",164,0)
 ;34237     End of file reached
"RTN","XMAPHOST",165,0)
 ;34238     Message subject: |1|, Message number: |2|
"RTN","XMAPHOST",166,0)
 ;34239     From whom
"RTN","XMAPHOST",167,0)
 ;34240     M:Me
"RTN","XMAPHOST",168,0)
 ;34241     P:Postmaster
"RTN","XMAPHOST",169,0)
 ;34242     Answer 'Me' if the message should be from
"RTN","XMAREAD")
1^233
"RTN","XMASEC")
0^260^B63884
"RTN","XMASEC",1,0)
XMASEC ;(WASH ISC)/GM-Secure Packman Message ;05/06/99  15:50
"RTN","XMASEC",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMASEC",3,0)
 N XMABORT
"RTN","XMASEC",4,0)
 S XMABORT=0
"RTN","XMASEC",5,0)
 D PSECURE^XMPSEC(XMZ,.XMABORT)
"RTN","XMASEC",6,0)
 Q
"RTN","XMB")
0^2^B12706751
"RTN","XMB",1,0)
XMB ;ISC-SF/GMB-Send Bulletin APIs ;04/17/2002  07:38
"RTN","XMB",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMB",3,0)
 ; Was (WASH ISC)/THM/RWF/CAP
"RTN","XMB",4,0)
 ;
"RTN","XMB",5,0)
 ; Entry points are (DBIA 10069):
"RTN","XMB",6,0)
 ; ^XMB     Create and deliver a bulletin in the background (task).
"RTN","XMB",7,0)
 ; EN^XMB   Create a bulletin in the foreground (now) and send it in
"RTN","XMB",8,0)
 ;          the background (task)
"RTN","XMB",9,0)
 ; BULL^XMB Interactive create and send a bulletin
"RTN","XMB",10,0)
 ;
"RTN","XMB",11,0)
 ; The recipients of the bulletin include any entries in the XMY
"RTN","XMB",12,0)
 ; array that the caller has defined and the members of mail group
"RTN","XMB",13,0)
 ; that are included in the definition of the entry in the Bulletin
"RTN","XMB",14,0)
 ; file (#3.6) at the time of delivery.  There must be valid
"RTN","XMB",15,0)
 ; recipients or the message will not be delivered.
"RTN","XMB",16,0)
 ;
"RTN","XMB",17,0)
 ; I/O Variables:
"RTN","XMB",18,0)
 ; XMB             (in) Bulletin name (an entry in File #3.6)
"RTN","XMB",19,0)
 ; XMB(parameter#) (in, optional) Value to be stuffed into the bulletin
"RTN","XMB",20,0)
 ;                 for each required parameter
"RTN","XMB",21,0)
 ;                 eg. XMB(1)=data for parameter#1
"RTN","XMB",22,0)
 ; XMTEXT          (in, optional) Name of array containing
"RTN","XMB",23,0)
 ;                 additional bulletin text
"RTN","XMB",24,0)
 ; XMY             (in, optional) Array of additional recipients of a
"RTN","XMB",25,0)
 ;                 bulletin
"RTN","XMB",26,0)
 ; XMDUZ           (in, optional) Sender # or string saying who or what
"RTN","XMB",27,0)
 ;                 sent the bulletin (default=DUZ)
"RTN","XMB",28,0)
 ; XMDT            (in, optional) Date/time to send bulletin (default=now)
"RTN","XMB",29,0)
 ; XMYBLOB         (in, optional) MIME array
"RTN","XMB",30,0)
 ; XMZ             (out) Message number (if successful)
"RTN","XMB",31,0)
 ;
"RTN","XMB",32,0)
 ; Entry ^XMB:
"RTN","XMB",33,0)
 ; Needs:    XMB
"RTN","XMB",34,0)
 ; Accepts:  XMDUZ,XMTEXT,XMY,XMDT,XMYBLOB
"RTN","XMB",35,0)
 ; Returns:  (XMB=-1 if bulletin does not exist in file 3.6)
"RTN","XMB",36,0)
 ; Kills:    XMTEXT,XMY
"RTN","XMB",37,0)
 N XMINSTR,XMATTACH,XMTASK
"RTN","XMB",38,0)
 K XMERR,^TMP("XMERR",$J)
"RTN","XMB",39,0)
 I '$O(^XMB(3.6,"B",XMB,"")) S XMB=-1 Q
"RTN","XMB",40,0)
 I '$G(DUZ) N DUZ D DUZ^XUP(.5)
"RTN","XMB",41,0)
 I $G(XMDUZ)=""!($G(XMDUZ)=0) S XMDUZ=DUZ
"RTN","XMB",42,0)
 I XMDUZ'?.N S %=XMDUZ N XMDUZ S XMDUZ=% K %
"RTN","XMB",43,0)
 D:$D(XMYBLOB) SETBLOB(.XMYBLOB,.XMATTACH)
"RTN","XMB",44,0)
 D:$D(XMDT) SETLATER(XMDT,.XMINSTR)
"RTN","XMB",45,0)
 I XMDUZ'?.N D SETFROM^XMD(.XMDUZ,.XMINSTR) Q:$G(XMMG)["Error ="
"RTN","XMB",46,0)
 D INITAPI^XMVVITAE
"RTN","XMB",47,0)
 S:$D(XMTEXT) XMTEXT=$$CREF^DILF(XMTEXT)
"RTN","XMB",48,0)
 S:$D(XMDF) XMINSTR("ADDR FLAGS")="R" ; Ignore addressee restrictions
"RTN","XMB",49,0)
 S:$D(XMBTMP) XMINSTR("ADDR FLAGS")=$G(XMINSTR("ADDR FLAGS"))_"I" ; Don't initialize (kill) the ^TMP addressee global
"RTN","XMB",50,0)
 D TASKBULL^XMXBULL(XMDUZ,XMB,.XMB,.XMTEXT,.XMY,.XMINSTR,.XMTASK,.XMATTACH)
"RTN","XMB",51,0)
 K:$D(XMERR) XMERR,^TMP("XMERR",$J)
"RTN","XMB",52,0)
 K XMTEXT,XMY
"RTN","XMB",53,0)
 Q
"RTN","XMB",54,0)
EN ;Interactive Bulletin Entry Point
"RTN","XMB",55,0)
 ; Needs:    XMB
"RTN","XMB",56,0)
 ; Accepts:  XMDUZ,XMTEXT,XMY,XMDT,XMYBLOB
"RTN","XMB",57,0)
 ; Returns:  XMZ,(XMB=-1 if bulletin does not exist in file 3.6)
"RTN","XMB",58,0)
 ; Kills:    XMB,XMTEXT,XMY
"RTN","XMB",59,0)
 N XMBIEN,XMINSTR
"RTN","XMB",60,0)
 K XMERR,^TMP("XMERR",$J)
"RTN","XMB",61,0)
 S XMBIEN=$O(^XMB(3.6,"B",XMB,"")) I XMBIEN="" S XMB=-1 Q
"RTN","XMB",62,0)
 I '$G(DUZ) N DUZ D DUZ^XUP(.5)
"RTN","XMB",63,0)
 I $G(XMDUZ)=""!($G(XMDUZ)=0) S XMDUZ=DUZ
"RTN","XMB",64,0)
 I XMDUZ'?.N S %=XMDUZ N XMDUZ S XMDUZ=% K %
"RTN","XMB",65,0)
 D:$D(XMYBLOB) SETBLOB(.XMYBLOB,.XMATTACH)
"RTN","XMB",66,0)
 I XMDUZ'?.N D SETFROM^XMD(.XMDUZ,.XMINSTR) Q:$G(XMMG)["Error ="
"RTN","XMB",67,0)
 S:$D(XMTEXT) XMTEXT=$$CREF^DILF(XMTEXT)
"RTN","XMB",68,0)
 S:$D(XMDF) XMINSTR("ADDR FLAGS")="R" ; Ignore addressee restrictions
"RTN","XMB",69,0)
 S:$D(XMBTMP) XMINSTR("ADDR FLAGS")=$G(XMINSTR("ADDR FLAGS"))_"I" ; Don't initialize (kill) the ^TMP addressee global
"RTN","XMB",70,0)
 D SEND^XMXBULL(XMDUZ,XMBIEN,.XMB,.XMTEXT,.XMY,.XMINSTR,.XMZ,.XMATTACH)
"RTN","XMB",71,0)
 K:$D(XMERR) XMERR,^TMP("XMERR",$J)
"RTN","XMB",72,0)
 K XMB,XMTEXT,XMY
"RTN","XMB",73,0)
 Q
"RTN","XMB",74,0)
SETBLOB(XMYBLOB,XMATTACH) ;
"RTN","XMB",75,0)
 N %X,%Y
"RTN","XMB",76,0)
 S %X="XMYBLOB(",%Y="XMATTACH(""IMAGE""," D %XY^%RCR
"RTN","XMB",77,0)
 Q
"RTN","XMB",78,0)
SETLATER(XMDT,XMINSTR) ;
"RTN","XMB",79,0)
 S XMINSTR("LATER")=$$XMDATE^XMXPARM("XMDT",XMDT)
"RTN","XMB",80,0)
 I $D(XMERR) K XMINSTR("LATER"),XMERR,^TMP("XMERR",$J)
"RTN","XMB",81,0)
 Q
"RTN","XMB",82,0)
BULL ; Manually post a bulletin
"RTN","XMB",83,0)
 D BULLETIN^XMJMBULL
"RTN","XMB",84,0)
 Q
"RTN","XMB",85,0)
ZTSK ; Entry point for TaskMan to transmit messages to a site.
"RTN","XMB",86,0)
 ; Needed for transition from v7.1 to v8.0.  Once site has transitioned,
"RTN","XMB",87,0)
 ; this entry point can be deleted.
"RTN","XMB",88,0)
 S ZTREQ="@"
"RTN","XMB",89,0)
 S XMINST=XMB("XMSCR")
"RTN","XMB",90,0)
 Q:$$OBE^XMTDR(XMINST)
"RTN","XMB",91,0)
 S XMTREC=$G(^XMBS(4.2999,XMINST,4))
"RTN","XMB",92,0)
 S ^XMBS(4.2999,XMINST,4)=$P(XMTREC,U,1,2)_U_XMB("SCRIPT",0)_U_XMB("TRIES")_U_U_XMB("ITERATIONS")_U_XMB("FIRST SCRIPT")_U_$P(XMB("SCRIPT"),U,6)
"RTN","XMB",93,0)
 S ^XMBS(4.2999,XMINST,5)=XMB("SCRIPT")
"RTN","XMB",94,0)
 K XMB,XMTREC
"RTN","XMB",95,0)
 G TASK^XMTDR
"RTN","XMB",96,0)
 Q
"RTN","XMB1")
1^155
"RTN","XMBBLOB")
0^261^B2223259
"RTN","XMBBLOB",1,0)
XMBBLOB ;(WASH ISC)/THM/RWF/CAP-Add BLOBs to Bulletin ;04/17/2002  07:41
"RTN","XMBBLOB",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMBBLOB",3,0)
 ;Multimedia Bulletin - Add BLOBs
"RTN","XMBBLOB",4,0)
MULTI(XMZ) ;Many BLOBs at a time
"RTN","XMBBLOB",5,0)
 N XMBBLOB
"RTN","XMBBLOB",6,0)
 F XMYBLOB=0:0 S XMYBLOB=$O(XMYBLOB(XMYBLOB)) Q:'XMYBLOB  S X=$$API^XMR0BLOB(XMZ,XMYBLOB(XMYBLOB)) I 'X D ERB(X) S XMBBLOB=$G(XMBBLOB)+1
"RTN","XMBBLOB",7,0)
 Q XMBBLOB
"RTN","XMBBLOB",8,0)
 ;If BLOB Error
"RTN","XMBBLOB",9,0)
ERB(%,%0,%1) N XMR,XMZ,XMY,XMTEXT,XMSUB,XMDUZ,XMDUN,XMBSAVE
"RTN","XMBBLOB",10,0)
 S %X="^TMP(""XMY"",$J,",%Y="^TMP(""XMBSAVE"",$J," D %XY^%RCR
"RTN","XMBBLOB",11,0)
 S %X="XMY(",%Y="^TMP(""XMBSAVE"",$J," D %XY^%RCR
"RTN","XMBBLOB",12,0)
 S XMDUZ="<MailMan Bulletin API>",XMSUB="BLOB NOT SENT",XMY(%)=""
"RTN","XMBBLOB",13,0)
 S XMTEXT="XMTEXT(",XMTEXT(1)="The Bulletin '"_$P(^XMB(3.9,%0,0),U)_"'"
"RTN","XMBBLOB",14,0)
 S XMTEXT(2)="was sent without non-textual body parts (BLOBS)."
"RTN","XMBBLOB",15,0)
 S XMTEXT(3)="The error returned from the imaging API was: "
"RTN","XMBBLOB",16,0)
 S XMTEXT(4)="     "_%1
"RTN","XMBBLOB",17,0)
 D ^XMD
"RTN","XMBBLOB",18,0)
 S %Y="^TMP(""XMY"",$J,",%X="^TMP(""XMBSAVE"",$J," D %XY^%RCR
"RTN","XMBBLOB",19,0)
 Q 1
"RTN","XMBGRP")
0^387^B34058917
"RTN","XMBGRP",1,0)
XMBGRP ;ISC-SF/GMB-Mail Group APIs ;04/17/2002  07:44
"RTN","XMBGRP",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMBGRP",3,0)
 ; Was (WASH ISC)/JL,CAP
"RTN","XMBGRP",4,0)
 ;
"RTN","XMBGRP",5,0)
 ; Entry points (DBIA 1146):
"RTN","XMBGRP",6,0)
 ; $$DM  Delete local members from a mail group.
"RTN","XMBGRP",7,0)
 ; $$MG  Create a mail group or add members to an existing mail group.
"RTN","XMBGRP",8,0)
MG(XMGROUP,XMTYPE,XMORG,XMSELF,XMY,XMDESC,XMQUIET) ; Create group or add members to existing group
"RTN","XMBGRP",9,0)
 ;Example:
"RTN","XMBGRP",10,0)
 ;S X=$$MG^XMBGRP(XMGROUP,XMTYPE,XMORG,XMSELF,.XMY,.XMDESC,XMQUIET)
"RTN","XMBGRP",11,0)
 ;
"RTN","XMBGRP",12,0)
 ;XMGROUP  =group name if creating a new group;
"RTN","XMBGRP",13,0)
 ;         =group name or pointer to ^XMB(3.8,
"RTN","XMBGRP",14,0)
 ;         if adding members to an existing group.
"RTN","XMBGRP",15,0)
 ;XMTYPE   type of group - used only for creation
"RTN","XMBGRP",16,0)
 ;         0=public (default)
"RTN","XMBGRP",17,0)
 ;         1=private
"RTN","XMBGRP",18,0)
 ;XMORG    group organizer - used only for creation
"RTN","XMBGRP",19,0)
 ;         pointer to ^VA(200, (default=DUZ)
"RTN","XMBGRP",20,0)
 ;XMSELF   allow self enrollment - used only for creation
"RTN","XMBGRP",21,0)
 ;         0=no
"RTN","XMBGRP",22,0)
 ;         1=yes (default)
"RTN","XMBGRP",23,0)
 ;XMY      local group members (Array - Pass by reference)
"RTN","XMBGRP",24,0)
 ;         XMY(member DUZ)=""
"RTN","XMBGRP",25,0)
 ;XMDESC   description (Array - Pass by reference)
"RTN","XMBGRP",26,0)
 ;         - used only for creation
"RTN","XMBGRP",27,0)
 ;         Must be appropriate for FM word processing field.
"RTN","XMBGRP",28,0)
 ;XMQUIET  silent flag
"RTN","XMBGRP",29,0)
 ;         0=interactive
"RTN","XMBGRP",30,0)
 ;         1=silent (default)
"RTN","XMBGRP",31,0)
 N XMABORT,XMGIEN,XMGNAME
"RTN","XMBGRP",32,0)
 S XMABORT=0
"RTN","XMBGRP",33,0)
 D MGINIT(XMGROUP,.XMGIEN,.XMGNAME,.XMTYPE,.XMORG,.XMSELF,.XMY,.XMDESC,.XMQUIET,.XMABORT)
"RTN","XMBGRP",34,0)
 I XMABORT K XMY Q 0
"RTN","XMBGRP",35,0)
 I '$D(XMGIEN) D
"RTN","XMBGRP",36,0)
 . D CREATE(XMGNAME,.XMGIEN,XMTYPE,XMORG,XMSELF,.XMDESC,XMQUIET,.XMABORT)  Q:XMABORT
"RTN","XMBGRP",37,0)
 . Q:'$O(XMY(""))
"RTN","XMBGRP",38,0)
 . D ADD(XMGIEN,.XMY,.XMABORT) Q:XMABORT
"RTN","XMBGRP",39,0)
 . D NOTIFY("Members have been added to the "_XMGNAME_" Mail Group.",XMQUIET)
"RTN","XMBGRP",40,0)
 E  D
"RTN","XMBGRP",41,0)
 . D ADD(XMGIEN,.XMY,.XMABORT)
"RTN","XMBGRP",42,0)
 K XMY
"RTN","XMBGRP",43,0)
 Q $S(XMABORT:0,1:XMGIEN)
"RTN","XMBGRP",44,0)
MGINIT(XMGROUP,XMGIEN,XMGNAME,XMTYPE,XMORG,XMSELF,XMY,XMDESC,XMQUIET,XMABORT) ;
"RTN","XMBGRP",45,0)
 D CHKGROUP(XMGROUP,.XMGIEN,.XMGNAME,.XMABORT) Q:XMABORT
"RTN","XMBGRP",46,0)
 I $D(XMGIEN),'$O(XMY("")) D  Q
"RTN","XMBGRP",47,0)
 . D NOTIFY("E907 No members specified to add to Mail Group "_XMGNAME,XMQUIET)
"RTN","XMBGRP",48,0)
 . S XMABORT=1
"RTN","XMBGRP",49,0)
 D CHKVAL(.XMTYPE,"XMTYPE",2,0,.XMABORT) Q:XMABORT
"RTN","XMBGRP",50,0)
 S:$G(XMORG)="" XMORG=DUZ
"RTN","XMBGRP",51,0)
 S:XMORG<1 XMORG=.5
"RTN","XMBGRP",52,0)
 I '$D(^VA(200,XMORG,0)) D  Q
"RTN","XMBGRP",53,0)
 . D NOTIFY("E904 "_XMORG_" is not a user to use as an organizer of a mail group.",XMQUIET)
"RTN","XMBGRP",54,0)
 . S XMABORT=1
"RTN","XMBGRP",55,0)
 D CHKVAL(.XMSELF,"XMSELF",4,1,.XMABORT) Q:XMABORT
"RTN","XMBGRP",56,0)
 D CHKVAL(.XMQUIET,"XMQUIET",7,1,.XMABORT) Q:XMABORT
"RTN","XMBGRP",57,0)
 S:$D(ZTQUEUED) XMQUIET=1
"RTN","XMBGRP",58,0)
 Q
"RTN","XMBGRP",59,0)
CHKGROUP(XMGROUP,XMGIEN,XMGNAME,XMABORT) ;
"RTN","XMBGRP",60,0)
 I +XMGROUP=XMGROUP D  Q
"RTN","XMBGRP",61,0)
 . S XMGIEN=XMGROUP
"RTN","XMBGRP",62,0)
 . S XMGNAME=$P($G(^XMB(3.8,XMGIEN,0)),U,1)
"RTN","XMBGRP",63,0)
 . I XMGNAME="" D
"RTN","XMBGRP",64,0)
 . . D NOTIFY("E910 Mail Group "_XMGROUP_" could not be found !",XMQUIET)
"RTN","XMBGRP",65,0)
 . . S XMABORT=1
"RTN","XMBGRP",66,0)
 S XMGNAME=XMGROUP
"RTN","XMBGRP",67,0)
 I $L(XMGNAME)<3 D  Q
"RTN","XMBGRP",68,0)
 . D NOTIFY("E901 "_XMGNAME_" is not valid -- it is shorter than 3 characters",XMQUIET)
"RTN","XMBGRP",69,0)
 . S XMABORT=1
"RTN","XMBGRP",70,0)
 I $L(XMGNAME)>30 D  Q
"RTN","XMBGRP",71,0)
 . D NOTIFY("E902 "_XMGNAME_" is not valid -- it is longer than 30 characters",XMQUIET)
"RTN","XMBGRP",72,0)
 . S XMABORT=1
"RTN","XMBGRP",73,0)
 I $D(^XMB(3.8,"B",XMGNAME)) S XMGIEN=$O(^(XMGNAME,0))
"RTN","XMBGRP",74,0)
 Q
"RTN","XMBGRP",75,0)
CHKVAL(XMVAL,XMVNAME,XMPOSN,XMDEFALT,XMABORT) ;
"RTN","XMBGRP",76,0)
 S:$G(XMVAL)="" XMVAL=XMDEFALT
"RTN","XMBGRP",77,0)
 I XMVAL=0!(XMVAL=1) Q
"RTN","XMBGRP",78,0)
 D NOTIFY("E903 Parameter "_XMPOSN_"="_XMVAL_" (not valid, must be 0 or 1).",XMQUIET)
"RTN","XMBGRP",79,0)
 S XMABORT=1
"RTN","XMBGRP",80,0)
 Q
"RTN","XMBGRP",81,0)
CREATE(XMGNAME,XMGIEN,XMTYPE,XMORG,XMSELF,XMDESC,XMQUIET,XMABORT) ;
"RTN","XMBGRP",82,0)
 N DIC,Y,DA,DO,DD,X
"RTN","XMBGRP",83,0)
 S X=XMGNAME
"RTN","XMBGRP",84,0)
 S DIC="^XMB(3.8,",DIC(0)="FZMN"_$S(XMQUIET:"",1:"E")
"RTN","XMBGRP",85,0)
 S DIC("DR")="4///"_$S(XMTYPE=0:"PU",1:"PR")_";5///"_XMORG_";10///0;7///"_$S(XMSELF:"y",1:"n")
"RTN","XMBGRP",86,0)
 D FILE^DICN
"RTN","XMBGRP",87,0)
 I Y<0 D  Q
"RTN","XMBGRP",88,0)
 . D NOTIFY("Mail Group ("_XMGNAME_") creation failed!",XMQUIET)
"RTN","XMBGRP",89,0)
 . S XMABORT=1
"RTN","XMBGRP",90,0)
 S XMGIEN=+Y
"RTN","XMBGRP",91,0)
 ;Add descriptive text
"RTN","XMBGRP",92,0)
 I $O(XMDESC(""))'="" D
"RTN","XMBGRP",93,0)
 . D WP^DIE(3.8,XMGIEN_",",3,"","XMDESC")
"RTN","XMBGRP",94,0)
 . K XMDESC
"RTN","XMBGRP",95,0)
 D NOTIFY("Mail Group "_XMGROUP_" created.",XMQUIET)
"RTN","XMBGRP",96,0)
 Q
"RTN","XMBGRP",97,0)
ADD(XMGIEN,XMY,XMABORT) ; Add local members
"RTN","XMBGRP",98,0)
 L +^XMB(3.8,XMGIEN):9 E  D  Q
"RTN","XMBGRP",99,0)
 . D NOTIFY("E906 "_XMGROUP_" File could not be locked - Did not add members.",XMQUIET)
"RTN","XMBGRP",100,0)
 . S XMABORT=1
"RTN","XMBGRP",101,0)
 N XMUSER,XMFDA,XMADDCNT
"RTN","XMBGRP",102,0)
 S XMUSER="",XMADDCNT=0
"RTN","XMBGRP",103,0)
 F  S XMUSER=$O(XMY(XMUSER)) Q:XMUSER=""  D
"RTN","XMBGRP",104,0)
 . I '$D(^VA(200,XMUSER,0))!'$D(^XMB(3.7,XMUSER,0)) D  Q
"RTN","XMBGRP",105,0)
 . . D NOTIFY("E908 Invalid member ("_XMUSER_") - NOT pointer to ^VA(200",XMQUIET)
"RTN","XMBGRP",106,0)
 . Q:$D(^XMB(3.8,XMGIEN,1,"B",XMUSER))  ; already a member
"RTN","XMBGRP",107,0)
 . S XMFDA(3.81,"+1,"_XMGIEN_",",.01)=XMUSER
"RTN","XMBGRP",108,0)
 . D UPDATE^DIE("","XMFDA")
"RTN","XMBGRP",109,0)
 . S XMADDCNT=XMADDCNT+1
"RTN","XMBGRP",110,0)
 L -^XMB(3.8,XMGIEN)
"RTN","XMBGRP",111,0)
 K XMY
"RTN","XMBGRP",112,0)
 S:'XMADDCNT XMABORT=1  ; No members added
"RTN","XMBGRP",113,0)
 Q
"RTN","XMBGRP",114,0)
DM(XMGROUP,XMY,XMQUIET) ; Delete members
"RTN","XMBGRP",115,0)
 ;XMGROUP  Mail Group Name or entry number
"RTN","XMBGRP",116,0)
 ;XMY      Array of members to remove
"RTN","XMBGRP",117,0)
 ;         XMY(local member DUZ)=""
"RTN","XMBGRP",118,0)
 ;XMQUIET  Silent Flag
"RTN","XMBGRP",119,0)
 N XMGIEN,XMUSER,DIK,DA,XMABORT
"RTN","XMBGRP",120,0)
 S XMABORT=0
"RTN","XMBGRP",121,0)
 D DMINIT(XMGROUP,.XMGIEN,.XMY,.XMQUIET,.XMABORT)
"RTN","XMBGRP",122,0)
 I XMABORT K XMY Q 0
"RTN","XMBGRP",123,0)
 L +^XMB(3.8,XMGIEN):9 E  D  Q 0
"RTN","XMBGRP",124,0)
 . D NOTIFY("E906 "_XMGROUP_" File could not be locked - Did not delete members.",XMQUIET)
"RTN","XMBGRP",125,0)
 . S XMABORT=1
"RTN","XMBGRP",126,0)
 S DA(1)=XMGIEN,DIK="^XMB(3.8,"_XMGIEN_",1,"
"RTN","XMBGRP",127,0)
 S XMUSER=""
"RTN","XMBGRP",128,0)
 F  S XMUSER=$O(XMY(XMUSER)) Q:XMUSER=""  D
"RTN","XMBGRP",129,0)
 . S DA=$O(^XMB(3.8,XMGIEN,1,"B",XMUSER,0)) Q:'DA
"RTN","XMBGRP",130,0)
 . D ^DIK
"RTN","XMBGRP",131,0)
 K XMY
"RTN","XMBGRP",132,0)
 L -^XMB(3.8,XMGIEN)
"RTN","XMBGRP",133,0)
 Q 1
"RTN","XMBGRP",134,0)
DMINIT(XMGROUP,XMGIEN,XMY,XMQUIET,XMABORT) ;
"RTN","XMBGRP",135,0)
 N XMGNAME
"RTN","XMBGRP",136,0)
 D CHKGROUP(XMGROUP,.XMGIEN,.XMGNAME,.XMABORT) Q:XMABORT
"RTN","XMBGRP",137,0)
 I '$D(XMGIEN) D  Q
"RTN","XMBGRP",138,0)
 . D NOTIFY("E910 Mail Group "_XMGROUP_" could not be found !",XMQUIET)
"RTN","XMBGRP",139,0)
 . S XMABORT=1
"RTN","XMBGRP",140,0)
 D CHKVAL(.XMQUIET,"XMQUIET",3,1,.XMABORT) Q:XMABORT
"RTN","XMBGRP",141,0)
 S:$D(ZTQUEUED) XMQUIET=1
"RTN","XMBGRP",142,0)
 I '$O(XMY("")) D  Q
"RTN","XMBGRP",143,0)
 . D NOTIFY("E909 Member delete attempted with no members specified.",XMQUIET)
"RTN","XMBGRP",144,0)
 . S XMABORT=1
"RTN","XMBGRP",145,0)
 Q
"RTN","XMBGRP",146,0)
NOTIFY(XMMSG,XMQUIET) ; Notification
"RTN","XMBGRP",147,0)
 N I,XMTEXT
"RTN","XMBGRP",148,0)
 S XMTEXT(1)="There was a call to the Mail Group Applications Programmer"
"RTN","XMBGRP",149,0)
 S XMTEXT(2)="Interface (API) that required notification to the user:"
"RTN","XMBGRP",150,0)
 S XMTEXT(3)=""
"RTN","XMBGRP",151,0)
 S XMTEXT(4)=XMMSG
"RTN","XMBGRP",152,0)
 I XMQUIET D SENDMSG(.XMTEXT) Q
"RTN","XMBGRP",153,0)
 F I=1:1:4 W !,XMTEXT(I)
"RTN","XMBGRP",154,0)
 W !,$C(7)
"RTN","XMBGRP",155,0)
 Q
"RTN","XMBGRP",156,0)
SENDMSG(XMTEXT) ;
"RTN","XMBGRP",157,0)
 N XMY,XMDUZ,XMSUB
"RTN","XMBGRP",158,0)
 S XMY(.5)="",XMY(DUZ)="",XMTEXT="XMTEXT("
"RTN","XMBGRP",159,0)
 S XMDUZ=.5,XMSUB="MAIL GROUP API"
"RTN","XMBGRP",160,0)
 D ^XMD
"RTN","XMBGRP",161,0)
 Q
"RTN","XMBPOST")
1^3
"RTN","XMC")
0^4^B17110255
"RTN","XMC",1,0)
XMC ;ISC-SF/GMB-Network Programmer Options Menu ;07/11/2002  07:41
"RTN","XMC",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMC",3,0)
 ; Was (WASH ISC)/THM
"RTN","XMC",4,0)
ENTER ;
"RTN","XMC",5,0)
 I '$G(DUZ) W $C(7),!!,$$EZBLD^DIALOG(38105) Q  ; You do not have a DUZ.
"RTN","XMC",6,0)
 N XMDUZ,XMV,XMABORT,XM,XMDISPI,XMDUN
"RTN","XMC",7,0)
 D INIT^XMVVITAE
"RTN","XMC",8,0)
 I '$D(DT) D DT^DICRW
"RTN","XMC",9,0)
 I $D(IO)[0 S IOP="HOME" D ^%ZIS
"RTN","XMC",10,0)
 U IO(0) W !,^XMB("NETNAME")
"RTN","XMC",11,0)
 D:$O(^DOPT("XMC","B",""))'?1"ACT".E INIT
"RTN","XMC",12,0)
 S XMABORT=0
"RTN","XMC",13,0)
 F  D  Q:XMABORT
"RTN","XMC",14,0)
 . N DIC,X,Y
"RTN","XMC",15,0)
 . U IO(0)
"RTN","XMC",16,0)
 . W !
"RTN","XMC",17,0)
 . S DIC="^DOPT(""XMC"",",DIC(0)="AEQZ"
"RTN","XMC",18,0)
 . D ^DIC K DIC I Y<0 S XMABORT=1 Q
"RTN","XMC",19,0)
 . S X=$P(Y(0),U,2,99)
"RTN","XMC",20,0)
 . K DIC,Y
"RTN","XMC",21,0)
 . S XM="D"
"RTN","XMC",22,0)
 . D @X
"RTN","XMC",23,0)
 . I $L(IO) U IO X ^%ZOSF("EON")
"RTN","XMC",24,0)
 . D ^%ZISC
"RTN","XMC",25,0)
 . X ^%ZOSF("EON")
"RTN","XMC",26,0)
 . U IO(0)
"RTN","XMC",27,0)
 D KL
"RTN","XMC",28,0)
 Q
"RTN","XMC",29,0)
KL ;
"RTN","XMC",30,0)
 X ^%ZOSF("EON")
"RTN","XMC",31,0)
 D KL1
"RTN","XMC",32,0)
 Q
"RTN","XMC",33,0)
KL1 ;
"RTN","XMC",34,0)
 ; XMOS   - Operating System of the computer at this site
"RTN","XMC",35,0)
 D KILL
"RTN","XMC",36,0)
 K %DT,%H,ER,I,X,Y,Y1,Y3,Z
"RTN","XMC",37,0)
 K XMCNT
"RTN","XMC",38,0)
 K XMD,XMDIAL
"RTN","XMC",39,0)
 K XME,XMEC,XMER,XMESC
"RTN","XMC",40,0)
 K XMFS
"RTN","XMC",41,0)
 K XMLAN,XMLIN,XMLL,XMLT,XMLX
"RTN","XMC",42,0)
 K XMOS
"RTN","XMC",43,0)
 K XMP,XMPOLL
"RTN","XMC",44,0)
 K XMR
"RTN","XMC",45,0)
 K XMS0AJ,XMSUB,XMSUM
"RTN","XMC",46,0)
 K XMTLER
"RTN","XMC",47,0)
 K XMZ
"RTN","XMC",48,0)
 Q
"RTN","XMC",49,0)
KILL ; Kill variables used across routines
"RTN","XMC",50,0)
 ; XM      - Debug: Write all xactions to screen, too? ""=no; "D"=yes
"RTN","XMC",51,0)
 ; XMB("SCR IEN") - Script IEN
"RTN","XMC",52,0)
 ; XMB("SCR REC") - Script record
"RTN","XMC",53,0)
 ; XMC("AUDIT") - Are we auditing? 0=no; n=yes, where n is 1 to 99
"RTN","XMC",54,0)
 ; XMC("BATCH") - Batch mode (to tape or global)? 0=no; 1=yes
"RTN","XMC",55,0)
 ; XMC("DIR") - Current direction of transmission? S=sending; R=receiving
"RTN","XMC",56,0)
 ; XMC("HELO RECV") - Name of site we are receiving message from
"RTN","XMC",57,0)
 ; XMC("HELO SEND") - Name of site we are sending message to
"RTN","XMC",58,0)
 ; XMC("C","R") - # chars rcvd this session
"RTN","XMC",59,0)
 ; XMC("C","S") - # chars sent this session
"RTN","XMC",60,0)
 ; XMC("L") - # lines xmited (rcvd & sent) this session
"RTN","XMC",61,0)
 ; XMC("R") - # msgs rcvd this session
"RTN","XMC",62,0)
 ; XMC("S") - # msgs sent this session
"RTN","XMC",63,0)
 ; XMC("MAILMAN") - MailMan version # of remote site, when communicating
"RTN","XMC",64,0)
 ;                  with another MailMan site, version > 4
"RTN","XMC",65,0)
 ; XMC("SHOW TRAN") - ["S"= Write the 'send' line to the screen
"RTN","XMC",66,0)
 ;                    ["R"= Write the 'receive' line to the screen
"RTN","XMC",67,0)
 ; XMC("START") - timestamp at start of xmit session
"RTN","XMC",68,0)
 ; XMC("TALKMODE") - Are we in talk mode? 0=no; 1=yes
"RTN","XMC",69,0)
 ; XMC("TURN") - Have we turned already? 0=no; 1=yes
"RTN","XMC",70,0)
 ; XMCHAN  - Before GET^XML: Name of Comm Protocol (file 3.4) channel
"RTN","XMC",71,0)
 ;           After  GET^XML: IEN of Comm Protocol (file 3.4) channel
"RTN","XMC",72,0)
 ; XMCLOSE - Xecute this variable to close the channel (file 3.4,field 4)
"RTN","XMC",73,0)
 ; XMHOST  - IP address
"RTN","XMC",74,0)
 ; XMINST  - IEN of Domain (file 4.2) being communicated with
"RTN","XMC",75,0)
 ; XMLINE  - Tracks line number when dumping msgs to/reading from tape
"RTN","XMC",76,0)
 ; XMPROT  - Name of Communications Protocol (file 3.4) channel
"RTN","XMC",77,0)
 ; XMOPEN  - Xecute this variable to open the channel (file 3.4,field 3)
"RTN","XMC",78,0)
 ; XMREC   - Xecute this variable to receive a line (file 3.4,field 2)
"RTN","XMC",79,0)
 ; XMRG    - The line received
"RTN","XMC",80,0)
 ; XMRPORT - Port # used
"RTN","XMC",81,0)
 ; XMSEN   - Xecute this variable to send a line (file 3.4,field 1)
"RTN","XMC",82,0)
 ; XMSG    - The line to send
"RTN","XMC",83,0)
 ; XMSITE  - Name of Domain (file 4.2) being communicated with
"RTN","XMC",84,0)
 ; XMTASK  - Tracks IEN in 4.281 when dumping msgs to/reading from tape
"RTN","XMC",85,0)
 ; XMTRAN  - A line to display on the screen by TRAN^XMC1
"RTN","XMC",86,0)
 K XMB
"RTN","XMC",87,0)
 K XMC,XMCHAN
"RTN","XMC",88,0)
 K XMINST,XMSITE
"RTN","XMC",89,0)
 K XMSEN,XMREC,XMOPEN,XMCLOSE
"RTN","XMC",90,0)
 ; Kill variables in DIC(3.4 and DIC(4.6
"RTN","XMC",91,0)
 ; (Not used: XMBT,XMLCHAR)
"RTN","XMC",92,0)
 K X,ER,TCPCHAN
"RTN","XMC",93,0)
 K XM
"RTN","XMC",94,0)
 K XMBT
"RTN","XMC",95,0)
 K XMDECNET
"RTN","XMC",96,0)
 K XMER
"RTN","XMC",97,0)
 K XMHANG,XMHOST
"RTN","XMC",98,0)
 K XMLCHAR,XMLCT,XMLER,XMLINE,XMLST,XMLTCP
"RTN","XMC",99,0)
 K XMNO220
"RTN","XMC",100,0)
 K XMPROT
"RTN","XMC",101,0)
 K XMRG,XMRPORT
"RTN","XMC",102,0)
 K XMSG,XMSIO,XMSTIME
"RTN","XMC",103,0)
 K XMTASK,XMTRAN
"RTN","XMC",104,0)
 Q
"RTN","XMC",105,0)
INIT ;INITIALIZE COMMAND TABLE
"RTN","XMC",106,0)
 N I,X,DIK
"RTN","XMC",107,0)
 K ^DOPT("XMC")
"RTN","XMC",108,0)
 S ^DOPT("XMC",0)=$$EZBLD^DIALOG(42201)_"^1N^" ; MailMan Network Programmer Option
"RTN","XMC",109,0)
 F I=1:1 S X=$P($E($T(Z+I),4,99),";") Q:X=""  S ^DOPT("XMC",I,0)=$$EZBLD^DIALOG($P(X,U,1))_U_$P(X,U,2,99)
"RTN","XMC",110,0)
 S DIK="^DOPT(""XMC"","
"RTN","XMC",111,0)
 D IXALL^DIK
"RTN","XMC",112,0)
 Q
"RTN","XMC",113,0)
Z ;;
"RTN","XMC",114,0)
 ;;42201.01^^XM;MAILMAN
"RTN","XMC",115,0)
 ;;42201.02^PLAY^XMCX;PLAY A SCRIPT
"RTN","XMC",116,0)
 ;;42201.03^Q1^XMCX;SCHEDULE TASK FOR ONE DOMAIN WITH QUEUED MESSAGES
"RTN","XMC",117,0)
 ;;42201.04^QALL^XMCX;SCHEDULE TASKS FOR ALL DOMAINS WITH QUEUED MESSAGES
"RTN","XMC",118,0)
 ;;42201.05^SHOWQ^XMCQ;SHOW A QUEUE
"RTN","XMC",119,0)
 ;;42201.06^LIST^XMCXT;LIST TRANSCRIPT
"RTN","XMC",120,0)
 ;;42201.07^STATUS^XMCQ;TRANSMIT QUEUE STATUS REPORT
"RTN","XMC",121,0)
 ;;42201.08^ACTIVE^XMCQA;ACTIVELY TRANSMITTING QUEUES REPORT
"RTN","XMC",122,0)
 ;;42201.09^ALL^XMCQA;QUEUES WITH MESSAGES TO GO OUT REPORT
"RTN","XMC",123,0)
 ;;42201.1^ENTER^XMCQH;HISTORICAL QUEUE STATISTICS REPORT
"RTN","XMC",124,0)
 ;;42201.11^GLBOUT^XMCB;SEND MESSAGES TO ANOTHER UCI VIA %ZISL GLOBAL
"RTN","XMC",125,0)
 ;;42201.12^GLBIN^XMCB;RECEIVE MESSAGES FROM ANOTHER UCI VIA %ZISL GLOBAL
"RTN","XMC",126,0)
 ;;42201.13^TAPEOUT^XMCB;SEQUENTIAL MEDIA QUEUE TRANSMISSION
"RTN","XMC",127,0)
 ;;42201.14^TAPEIN^XMCB;SEQUENTIAL MEDIA MESSAGE RECEPTION
"RTN","XMC",128,0)
 ;;42201.15^VAL^XMCE;VALIDATION NUMBER EDIT
"RTN","XMC",129,0)
 ;;42201.16^OUT^XMCE;TOGGLE A SCRIPT OUT OF SERVICE
"RTN","XMC",130,0)
 ;;42201.17^EDIT42^XMCE;EDIT A SCRIPT
"RTN","XMC",131,0)
 ;;42201.18^EDIT46^XMCE;SUBROUTINE EDITOR
"RTN","XMC",132,0)
 ;;
"RTN","XMC",133,0)
 ;;**OBSOLETE**
"RTN","XMC",134,0)
 ;;BLOB SEND^BLOB^XMA2B
"RTN","XMC",135,0)
 ;;DIAL PHONE^DI^XMC1
"RTN","XMC",136,0)
 ;;HANG UP PHONE^H^XMC1
"RTN","XMC",137,0)
 ;;IMMEDIATE SCRIPT MODE^IMM^XMC11
"RTN","XMC",138,0)
 ;;RESUME SCRIPT PROCESSING^RES^XMC1
"RTN","XMC",139,0)
 ;;
"RTN","XMC1")
0^5^B47889874
"RTN","XMC1",1,0)
XMC1 ;ISC-SF/GMB-Script Interpreter ;07/23/2002  10:15
"RTN","XMC1",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMC1",3,0)
 ; Was (WASH ISC)/THM
"RTN","XMC1",4,0)
 ;
"RTN","XMC1",5,0)
 ; Entry points used by MailMan options (not covered by DBIA):
"RTN","XMC1",6,0)
 ; RESUME  XMSCRIPTRES     (was RES^XMC11)
"RTN","XMC1",7,0)
ENT ;
"RTN","XMC1",8,0)
 ; Expects as input:
"RTN","XMC1",9,0)
 ; XMINST           Domain IEN
"RTN","XMC1",10,0)
 ; XMSITE           Domain name
"RTN","XMC1",11,0)
 ; XMB("SCR IEN")   Script IEN
"RTN","XMC1",12,0)
 I $$NEWERR^%ZTER N $ETRAP,$ESTACK S $ETRAP="D C^XMCTRAP"
"RTN","XMC1",13,0)
 E  S X="C^XMCTRAP",@^%ZOSF("TRAP")
"RTN","XMC1",14,0)
 K ^TMP("XMY",$J),^TMP("XMY0",$J)
"RTN","XMC1",15,0)
 N XMLER,XMLIN
"RTN","XMC1",16,0)
 S ER=0,XMC("SHOW TRAN")="RS"
"RTN","XMC1",17,0)
 D GET^XMCXT(0)
"RTN","XMC1",18,0)
 I '$D(^XMBS(4.2999,XMINST,0)) D STAT^XMTDR(XMINST)
"RTN","XMC1",19,0)
 ; *** how about L +^XMBS(4.2999,XMINST,3) ?
"RTN","XMC1",20,0)
 I '$D(XMC("TALKMODE")) L +^DIC(4.2,XMINST,"XMNETSEND"):0 E  D  Q
"RTN","XMC1",21,0)
 . D ERTRAN(42210) ;Netmail transmission in progress on another channel
"RTN","XMC1",22,0)
 D IN
"RTN","XMC1",23,0)
 L -^DIC(4.2,XMINST,"XMNETSEND")
"RTN","XMC1",24,0)
 Q
"RTN","XMC1",25,0)
IN ;To |1| from |2| beginning |3|
"RTN","XMC1",26,0)
 D DOTRAN(42211,XMSITE,^XMB("NETNAME"),$$FMTE^XLFDT(DT,5))
"RTN","XMC1",27,0)
 D DOTRAN(42212,$P(XMB("SCR REC"),U)) ;Script: |1|
"RTN","XMC1",28,0)
 I $$USESCR(XMINST,.XMB) D
"RTN","XMC1",29,0)
 . D EN(XMINST,XMSITE,$P(XMB("SCR REC"),U),"^DIC(4.2,"_XMINST_",1,"_XMB("SCR IEN")_",1,")
"RTN","XMC1",30,0)
 E  D
"RTN","XMC1",31,0)
 . N XMNETREC,X,XMC1,XMSCRN
"RTN","XMC1",32,0)
 . S XMNETREC=$G(^XMB(1,1,"NETWORK"))
"RTN","XMC1",33,0)
 . S XMSCRN=$P(XMB("SCR REC"),U)
"RTN","XMC1",34,0)
 . D DOTRAN(42213) ;Creating transmission script 'on the fly' ...
"RTN","XMC1",35,0)
 . S X="O H="_XMSITE_",P="_$P(^DIC(3.4,$P(XMNETREC,U,3),0),U)
"RTN","XMC1",36,0)
 . S XMC1=$P(X," ",2,999)
"RTN","XMC1",37,0)
 . D O Q:ER
"RTN","XMC1",38,0)
 . S X="C "_$P(^XMB(4.6,$P(XMNETREC,U,4),0),U)
"RTN","XMC1",39,0)
 . S XMC1=$P(X," ",2,999)
"RTN","XMC1",40,0)
 . D C
"RTN","XMC1",41,0)
 Q:$D(XMC("TALKMODE"))
"RTN","XMC1",42,0)
 I ER,'$D(ER("MSG")),XMTRAN'="" D TRAN
"RTN","XMC1",43,0)
 D DOTRAN(42214) ; Script Complete.
"RTN","XMC1",44,0)
 I ER D DOTRAN(42215) ; Stopped because of error.
"RTN","XMC1",45,0)
 D CLOSE^XMC1B
"RTN","XMC1",46,0)
 Q
"RTN","XMC1",47,0)
USESCR(XMINST,XMB) ; Function returns 1 if we should use the existing
"RTN","XMC1",48,0)
 ; script, or 0 if we should build a TCP/IP script.
"RTN","XMC1",49,0)
 Q:"^^SMTP^TCPCHAN^"'[(U_$P(XMB("SCR REC"),U,4)) 1  ; Use it
"RTN","XMC1",50,0)
 N XMNETREC
"RTN","XMC1",51,0)
 S XMNETREC=$G(^XMB(1,1,"NETWORK"))
"RTN","XMC1",52,0)
 Q:'$P(XMNETREC,U,3)!'$P(XMNETREC,U,4) 1  ; Use it
"RTN","XMC1",53,0)
 Q $O(^DIC(4.2,XMINST,1,XMB("SCR IEN"),1,0))>0  ;1=Use it; 0=Build it
"RTN","XMC1",54,0)
EN(XMINST,XMSITE,XMSCRN,XMROOT) ;
"RTN","XMC1",55,0)
 I $$NEWERR^%ZTER N $ETRAP,$ESTACK S $ETRAP="D C^XMCTRAP"
"RTN","XMC1",56,0)
 E  S X="C^XMCTRAP",@^%ZOSF("TRAP")
"RTN","XMC1",57,0)
 N XMCI
"RTN","XMC1",58,0)
 S XMCI=0
"RTN","XMC1",59,0)
 F  S XMCI=$O(@(XMROOT_XMCI_")")) Q:'XMCI  D INT(@(XMROOT_XMCI_",0)"),XMCI) Q:ER
"RTN","XMC1",60,0)
 Q
"RTN","XMC1",61,0)
INT(X,XMCI) ; Interpret the script line
"RTN","XMC1",62,0)
 ; X    script line
"RTN","XMC1",63,0)
 N XMC1
"RTN","XMC1",64,0)
 S ER=0
"RTN","XMC1",65,0)
 S:$E(X)?1L X=$$UP^XLFSTR(X)_$E(X,2,999)
"RTN","XMC1",66,0)
 I "EFCXOHMDLTSW"'[$E(X)!(X="") D  Q
"RTN","XMC1",67,0)
 . D ERTRAN(42216,X,XMCI) ;Invalid script command '|1|' at line |2|
"RTN","XMC1",68,0)
 S XMC1=$P(X," ",2,999)
"RTN","XMC1",69,0)
 D @$E(X)
"RTN","XMC1",70,0)
 S:'$D(ER) ER=0
"RTN","XMC1",71,0)
 Q
"RTN","XMC1",72,0)
C ; Call a subroutine
"RTN","XMC1",73,0)
 D DOTRAN(X)
"RTN","XMC1",74,0)
 N X,Y,DIC,XMNSCR,XMNSCRN,XMER
"RTN","XMC1",75,0)
 S X=$P(XMC1,"("),DIC="^XMB(4.6,",DIC(0)="O" D ^DIC
"RTN","XMC1",76,0)
 I Y<0 D  Q
"RTN","XMC1",77,0)
 . D ERTRAN(42217,X) ;Script '|1|' cannot be found in file 4.6
"RTN","XMC1",78,0)
 S XMNSCR=+Y,XMNSCRN=$P(Y,U,2)
"RTN","XMC1",79,0)
 D DOTRAN(42218,XMNSCRN) ;Calling script '|1|' (file 4.6)
"RTN","XMC1",80,0)
 D EN(XMINST,XMSITE,XMNSCRN,"^XMB(4.6,XMNSCR,1,")
"RTN","XMC1",81,0)
 I ER D  Q  ; XMER may be set by the transmission script in file 4.6
"RTN","XMC1",82,0)
 . I $D(XMER),'$D(ER("MSG")) D ERTRAN(XMER)
"RTN","XMC1",83,0)
 D DOTRAN(42219,XMSCRN) ;Returning to script '|1|'.
"RTN","XMC1",84,0)
 Q
"RTN","XMC1",85,0)
DI ; Dial phone
"RTN","XMC1",86,0)
 N XMC1,DIR,X,Y
"RTN","XMC1",87,0)
 S DIR(0)="F^3:50"
"RTN","XMC1",88,0)
 S DIR("A")=$$EZBLD^DIALOG(42220) ;Enter number(s) to dial
"RTN","XMC1",89,0)
 D ^DIR Q:$D(DIRUT)
"RTN","XMC1",90,0)
 S XMC1=Y
"RTN","XMC1",91,0)
D ; Dial numbers sucessively (Strip all punctuation not in XMSTRIP string)
"RTN","XMC1",92,0)
 D DIAL(XMC1)
"RTN","XMC1",93,0)
 Q
"RTN","XMC1",94,0)
DIAL(XMNUMS) ;
"RTN","XMC1",95,0)
 N XMSEP,XMI,XMNUM
"RTN","XMC1",96,0)
 S XMSEP=$S($L($G(XMFIELD)):XMFIELD,1:$S($G(XMSTRIP)[",":";",1:","))
"RTN","XMC1",97,0)
 F XMI=1:1 S XMNUM=$P(XMNUMS,XMSEP,XMI) Q:XMNUM=""  D DIALTRY(XMNUM) Q:'ER
"RTN","XMC1",98,0)
 K XMSTRIP,XMFIELD
"RTN","XMC1",99,0)
 Q
"RTN","XMC1",100,0)
DIALTRY(XMNUM) ;
"RTN","XMC1",101,0)
 N XMPHONE,XMI,XMDIGIT,Y
"RTN","XMC1",102,0)
 S XMPHONE=""
"RTN","XMC1",103,0)
 F XMI=1:1:$L(XMNUM) S XMDIGIT=$E(XMNUM,XMI) I $S(XMDIGIT'?1P:1,$G(XMSTRIP)[XMDIGIT:1,1:0) S XMPHONE=XMPHONE_XMDIGIT
"RTN","XMC1",104,0)
 S ER=0
"RTN","XMC1",105,0)
 D DOTRAN(42221,XMPHONE) ;Dialing |1|
"RTN","XMC1",106,0)
 I '$D(XMDIAL) D ERTRAN(42222) Q  ;Call failed: no XMDIAL
"RTN","XMC1",107,0)
 X XMDIAL
"RTN","XMC1",108,0)
 I ER D ERTRAN($S($D(Y):42222.1,1:42222.2),$G(Y)) ;Call failed: |1| or unknown reason
"RTN","XMC1",109,0)
 Q
"RTN","XMC1",110,0)
E ; Set error message to be displayed.
"RTN","XMC1",111,0)
 S ER("MSG")=XMC1
"RTN","XMC1",112,0)
 D DOTRAN(42223,ER("MSG")) ;Error message set to '|1|'
"RTN","XMC1",113,0)
 Q
"RTN","XMC1",114,0)
F ; Flush buffer
"RTN","XMC1",115,0)
 D DOTRAN(42224) ;Flushing buffer
"RTN","XMC1",116,0)
 G BUFLUSH^XML
"RTN","XMC1",117,0)
 Q
"RTN","XMC1",118,0)
H ; Hang up phone
"RTN","XMC1",119,0)
 D DOTRAN(42225) ;Hanging up phone
"RTN","XMC1",120,0)
 Q:'$D(XMHANG)
"RTN","XMC1",121,0)
 X XMHANG
"RTN","XMC1",122,0)
 Q
"RTN","XMC1",123,0)
L ; Look for string
"RTN","XMC1",124,0)
 D LOOK^XMC1A
"RTN","XMC1",125,0)
 Q
"RTN","XMC1",126,0)
M ; Send mail
"RTN","XMC1",127,0)
 D DOTRAN(42226) ;Beginning sender-SMTP service
"RTN","XMC1",128,0)
 D ENTER^XMS
"RTN","XMC1",129,0)
 I ER D DOTRAN("ER="_ER_" - ER(""MSG"")="_$G(ER("MSG")))
"RTN","XMC1",130,0)
 Q
"RTN","XMC1",131,0)
O ; Open device, protocol, and host
"RTN","XMC1",132,0)
 D DOTRAN(X)
"RTN","XMC1",133,0)
 D OPEN^XMC1B X:'ER XMOPEN
"RTN","XMC1",134,0)
 I ER D DOTRAN(42227) Q  ;Open failed
"RTN","XMC1",135,0)
 D DOTRAN(42228,XMSITE) ;Channel opened to |1|
"RTN","XMC1",136,0)
 D FLUSH
"RTN","XMC1",137,0)
 D DOTRAN(42229,XMC("DEVICE"),XMPROT) ;Device '|1|', Protocol '|2|' (file 3.4)
"RTN","XMC1",138,0)
 N XMFDA,XMIENS
"RTN","XMC1",139,0)
 S XMIENS=XMINST_","
"RTN","XMC1",140,0)
 S XMFDA(4.2999,XMIENS,1)=$H
"RTN","XMC1",141,0)
 S XMFDA(4.2999,XMIENS,6)=IO ; Device
"RTN","XMC1",142,0)
 D FILE^DIE("","XMFDA")
"RTN","XMC1",143,0)
 Q
"RTN","XMC1",144,0)
FLUSH ; Flush buffer
"RTN","XMC1",145,0)
 Q:'$D(XMBFLUSH)
"RTN","XMC1",146,0)
 N XMLX
"RTN","XMC1",147,0)
 F  R XMLX:0 Q:'$T
"RTN","XMC1",148,0)
 Q
"RTN","XMC1",149,0)
S ; Send line
"RTN","XMC1",150,0)
 I XMC1?1"@".E D  Q:ER
"RTN","XMC1",151,0)
 . N XMSAVE
"RTN","XMC1",152,0)
 . S XMSAVE=XMC1
"RTN","XMC1",153,0)
 . D INDIR(.XMC1) Q:ER
"RTN","XMC1",154,0)
 . D DOTRAN(42230,XMSAVE,XMC1) ;Transforming '|1|' to '|2|'
"RTN","XMC1",155,0)
 I XMC("SHOW TRAN")["S" D DOTRAN("S: "_XMC1)
"RTN","XMC1",156,0)
 I XMC1["~" S XMC1=$$RTRAN^XMCU1(XMC1)
"RTN","XMC1",157,0)
 W XMC1,$C(13)
"RTN","XMC1",158,0)
 Q
"RTN","XMC1",159,0)
INDIR(XMC1) ; GET INDIRECT REFERENCE
"RTN","XMC1",160,0)
 N XMREF
"RTN","XMC1",161,0)
 S XMREF=$P(XMC1,"@",2,99)
"RTN","XMC1",162,0)
 I '$D(@XMREF) D ERTRAN(42231,XMREF) Q  ;Undefined reference to |1|
"RTN","XMC1",163,0)
 S XMC1=@XMREF
"RTN","XMC1",164,0)
 Q
"RTN","XMC1",165,0)
T ;
"RTN","XMC1",166,0)
 Q:'$D(XMC("TALKMODE"))
"RTN","XMC1",167,0)
 S XMCI=999999
"RTN","XMC1",168,0)
 D DOTRAN(42232) ;Entering Talk mode
"RTN","XMC1",169,0)
 Q
"RTN","XMC1",170,0)
W ; Wait a number of seconds
"RTN","XMC1",171,0)
 D DOTRAN(42233,XMC1) ;Waiting |1| seconds
"RTN","XMC1",172,0)
 H +XMC1
"RTN","XMC1",173,0)
 Q
"RTN","XMC1",174,0)
X ; Execute a line of code
"RTN","XMC1",175,0)
 D DOTRAN(42234,XMC1) ;Xecuting |1|
"RTN","XMC1",176,0)
 X XMC1
"RTN","XMC1",177,0)
 Q:'ER
"RTN","XMC1",178,0)
 I $E(XMC1,1,2)'="O ",$E(XMC1,1,14)'="D CALL^%ZISTCP" Q
"RTN","XMC1",179,0)
 D ERTRAN(42235,XMHOST) S ER=25 ;Can't connect using IP address |1|
"RTN","XMC1",180,0)
 Q
"RTN","XMC1",181,0)
ERTRAN(XMDIALOG,XM1,XM2,XM3) ;
"RTN","XMC1",182,0)
 D DOTRAN(XMDIALOG,.XM1,.XM2,.XM3)
"RTN","XMC1",183,0)
 S ER=1
"RTN","XMC1",184,0)
 I '$D(ER("MSG")) S ER("MSG")=XMTRAN
"RTN","XMC1",185,0)
 Q
"RTN","XMC1",186,0)
DOTRAN(XMDIALOG,XM1,XM2,XM3) ;
"RTN","XMC1",187,0)
 N XMPARM
"RTN","XMC1",188,0)
 S:$D(XM1) XMPARM(1)=XM1 S:$D(XM2) XMPARM(2)=XM2 S:$D(XM3) XMPARM(3)=XM3
"RTN","XMC1",189,0)
 S XMTRAN=$S(+XMDIALOG=XMDIALOG:$$EZBLD^DIALOG(XMDIALOG,.XMPARM),1:XMDIALOG)
"RTN","XMC1",190,0)
 ; fall through...
"RTN","XMC1",191,0)
TRAN ;
"RTN","XMC1",192,0)
 N XMTIME,XMAUDIT
"RTN","XMC1",193,0)
 S XMTIME=$P($H,",",2)
"RTN","XMC1",194,0)
 S XMAUDIT=$E($TR($J(XMTIME\3600,2)_":"_$J(XMTIME#3600\60,2)_":"_$J(XMTIME#60,2)," ","0")_" "_XMTRAN,1,245)
"RTN","XMC1",195,0)
 ; Trace / Debug transmission problems
"RTN","XMC1",196,0)
 ; Field 8.2 in file 4.3 says whether to audit.
"RTN","XMC1",197,0)
 I $G(XMC("AUDIT")) S XMC("AUDIT","I")=$G(XMC("AUDIT","I"))+1,^TMP("XMC",XMC("AUDIT"),XMC("AUDIT","I"),0)=XMAUDIT
"RTN","XMC1",198,0)
 Q:$G(XM)'["D"
"RTN","XMC1",199,0)
 U IO(0)
"RTN","XMC1",200,0)
 W !,XMAUDIT
"RTN","XMC1",201,0)
 W:$G(XMLER) "("_XMLER_")"
"RTN","XMC1",202,0)
 I IO'="",IOT'="RES" U IO
"RTN","XMC1",203,0)
 Q
"RTN","XMC1",204,0)
RESUME ; Resume script processing
"RTN","XMC1",205,0)
 N I,DIR,X,Y
"RTN","XMC1",206,0)
 S:'$D(XMCI) XMCI=0
"RTN","XMC1",207,0)
 D ^%ZIS Q:POP
"RTN","XMC1",208,0)
 S I=0
"RTN","XMC1",209,0)
 F  S I=$O(^DIC(4.2,XMINST,1,XMB("SCR IEN"),1,I)) Q:I=""  W !,$J(I,2),$S(I=XMCI:"->",1:"  "),^(I,0)
"RTN","XMC1",210,0)
 S DIR(0)="N^1:"_$O(^DIC(4.2,XMINST,1,XMB("SCR IEN"),1,""),-1)
"RTN","XMC1",211,0)
 S DIR("A")=$$EZBLD^DIALOG(42236) ;Resume script processing from line
"RTN","XMC1",212,0)
 S DIR("B")=XMCI
"RTN","XMC1",213,0)
 D ^DIR Q:$D(DIRUT)
"RTN","XMC1",214,0)
 S XMCI=Y
"RTN","XMC1",215,0)
 D DOTRAN(42237,XMCI) ;Resuming script from line |1|
"RTN","XMC1",216,0)
 S XMCI=XMCI-.1
"RTN","XMC1",217,0)
 U IO
"RTN","XMC1",218,0)
 G IN
"RTN","XMC1",219,0)
 Q
"RTN","XMC11")
0^6^B3776206
"RTN","XMC11",1,0)
XMC11 ;(WASH ISC)/THM-DECNET Communications Protocol Tools ;04/17/2002  07:51
"RTN","XMC11",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMC11",3,0)
 Q
"RTN","XMC11",4,0)
 ;ENS and ENR are used by DECNET Communications Protocol in file 3.4
"RTN","XMC11",5,0)
ENS ;Send
"RTN","XMC11",6,0)
 I $G(XMINST) D XMTSTAT^XMTDR(XMINST,"S",XMSG)
"RTN","XMC11",7,0)
 Q
"RTN","XMC11",8,0)
ENR ;Receive
"RTN","XMC11",9,0)
 I $G(XMINST) D XMTSTAT^XMTDR(XMINST,"R",XMRG)
"RTN","XMC11",10,0)
 Q
"RTN","XMC11",11,0)
 ;   *** THE FOLLOWING ARE NOT USED ***
"RTN","XMC11",12,0)
IMM ;Immediate mode interpreter
"RTN","XMC11",13,0)
 S XMC("SHOW TRAN")="RS"
"RTN","XMC11",14,0)
 I $G(XMC("AUDIT")) K ^TMP("XMC",XMC("AUDIT")),XMC("AUDIT","I")
"RTN","XMC11",15,0)
 F  R !!,"Script command: ",X:DTIME Q:X=""  D INT^XMC1(X,"you entered") U IO(0) W "  ",$S(ER:"Failed",1:"OK")
"RTN","XMC11",16,0)
 Q
"RTN","XMC11",17,0)
CHRS ;Christening operation
"RTN","XMC11",18,0)
 N XMINST,XMSITE,DIC,X,Y,DIR
"RTN","XMC11",19,0)
 I '$D(^XMB("NETNAME")) D  Q
"RTN","XMC11",20,0)
 . W !!,$C(7),"This domain is not yet christened. It cannot christen others"
"RTN","XMC11",21,0)
 . W !,"until initialized and christened by a parent domain."
"RTN","XMC11",22,0)
 W !!,"This process will create a new subordinate domain to this domain"
"RTN","XMC11",23,0)
 W !,"and update network relationships both there and here, as well as"
"RTN","XMC11",24,0)
 W !,"inform this domain's parent."
"RTN","XMC11",25,0)
 W !!,"Do you really want to do this? NO// "
"RTN","XMC11",26,0)
 R X:DTIME Q:"Yy"'[$S($L(X):$E(X),1:1)
"RTN","XMC11",27,0)
C W !!!,"Enter the name of the subordinate domain which you wish to christen"
"RTN","XMC11",28,0)
 S DIC=4.2,DIC(0)="AEQMZ"
"RTN","XMC11",29,0)
 D ^DIC Q:Y<0
"RTN","XMC11",30,0)
 S XMINST=+Y,XMSITE=$P(Y,U,2)
"RTN","XMC11",31,0)
 S XMC("CHRISTEN")=^XMB("NETNAME")_","_XMSITE
"RTN","XMC11",32,0)
 S XM="D"
"RTN","XMC11",33,0)
 D ENT^XMC1
"RTN","XMC11",34,0)
 K XMC("CHRISTEN")
"RTN","XMC11",35,0)
 Q
"RTN","XMC11A")
1^7
"RTN","XMC1A")
0^8^B15801874
"RTN","XMC1A",1,0)
XMC1A ;(WASH ISC)/THM-Script Interpreter (Look) ;04/25/2002  14:11
"RTN","XMC1A",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMC1A",3,0)
 ;LOOK For Text
"RTN","XMC1A",4,0)
 ; 
"RTN","XMC1A",5,0)
 ;  There can only be one 'B' in a LOOK command.  It may be preceeded by
"RTN","XMC1A",6,0)
 ;  at least one 'A' and succeeded by as many 'C's as desired.
"RTN","XMC1A",7,0)
 ;  The 'B' parameter may be null.  In this case two spaces would 
"RTN","XMC1A",8,0)
 ;  separate the 'A' parameters for the 'C' parameters.
"RTN","XMC1A",9,0)
 ;
"RTN","XMC1A",10,0)
 ;X=SCRIPT COMMAND 'L:Timeout A A A ... B C C C ...'
"RTN","XMC1A",11,0)
 ;
"RTN","XMC1A",12,0)
 ;The string represented by 'x' must always have a length >0.
"RTN","XMC1A",13,0)
 ;The string being looked for must always be surrounded by '|'s.
"RTN","XMC1A",14,0)
 ;To use the new form, the looked for strings must be surrounded by '|'s.
"RTN","XMC1A",15,0)
 ;    If no '|'s are found, it is assumed to be of the old form
"RTN","XMC1A",16,0)
 ;    (see example 4 below).
"RTN","XMC1A",17,0)
 ;There must not be any '|'s for the "OLD" form as the 1st character
"RTN","XMC1A",18,0)
 ;     after the 1st space in the string.
"RTN","XMC1A",19,0)
 ;The 1st character after the 1st space in the string must be a '|'
"RTN","XMC1A",20,0)
 ;     in the "NEW" form.
"RTN","XMC1A",21,0)
 ;Condition A is always checked first
"RTN","XMC1A",22,0)
 ;
"RTN","XMC1A",23,0)
 ;WHERE 'A' (mandatory) has form 'x' / QUIT on finding string 'x'
"RTN","XMC1A",24,0)
 ;                 or 'x:y' / GOTO line 'y' on finding 'x'
"RTN","XMC1A",25,0)
 ;
"RTN","XMC1A",26,0)
 ;WHERE 'C' (optional) has form 'x' / QUIT setting ER=1 on finding 'x'
"RTN","XMC1A",27,0)
 ;
"RTN","XMC1A",28,0)
 ;WHERE 'B' (optional) has form 'y' / GOTO 'y' on timeout
"RTN","XMC1A",29,0)
 ;
"RTN","XMC1A",30,0)
 ;********************************************************************
"RTN","XMC1A",31,0)
 ;
"RTN","XMC1A",32,0)
 ;Examples:
"RTN","XMC1A",33,0)
 ;
"RTN","XMC1A",34,0)
 ;    1.  Look for "LINE" or "CONNECTED" on a timeout just error out
"RTN","XMC1A",35,0)
 ;        (Where the command is on line 3)
"RTN","XMC1A",36,0)
 ;
"RTN","XMC1A",37,0)
 ;            L |LINE|:3 |CONNECTED|:3
"RTN","XMC1A",38,0)
 ;                   or
"RTN","XMC1A",39,0)
 ;            L |LINE| |CONNECTED|
"RTN","XMC1A",40,0)
 ;
"RTN","XMC1A",41,0)
 ;    2.  Look for "LINE" and if found go to line 15 of this script
"RTN","XMC1A",42,0)
 ;        Look for "CONNECTED" and if found go to line 18 of this script.
"RTN","XMC1A",43,0)
 ;        Go to line 25 of this script on a time out.
"RTN","XMC1A",44,0)
 ;        If "DISCON" is found error out.
"RTN","XMC1A",45,0)
 ;
"RTN","XMC1A",46,0)
 ;            L |LINE|:15 |CONNECTED|:18 25 |DISCON|
"RTN","XMC1A",47,0)
 ;
"RTN","XMC1A",48,0)
 ;    3.  Same case as 2 except that on a timeout just error out.
"RTN","XMC1A",49,0)
 ;
"RTN","XMC1A",50,0)
 ;            L |LINE|:15 |CONNECTED|:18  |DISCON|
"RTN","XMC1A",51,0)
 ;
"RTN","XMC1A",52,0)
 ;        (Note that '18' is followed by 2 spaces [Timeout is null])
"RTN","XMC1A",53,0)
 ;
"RTN","XMC1A",54,0)
 ;    4.  Look for 'ON LINE', then look for the string 'CONNECTED'
"RTN","XMC1A",55,0)
 ;
"RTN","XMC1A",56,0)
 ;            L |ON LINE|:6 |CONNECTED|
"RTN","XMC1A",57,0)
 ;
"RTN","XMC1A",58,0)
 ;        This is a little tricky.  The old syntax for looking for a
"RTN","XMC1A",59,0)
 ;        string took $P(X," ",2,999) as the argument, where X is the
"RTN","XMC1A",60,0)
 ;        entire script command.  To be backwards compatible, there must
"RTN","XMC1A",61,0)
 ;        be '|'s surrounding all of the strings being looked for.
"RTN","XMC1A",62,0)
 ;
"RTN","XMC1A",63,0)
 ;****************************************************************
"RTN","XMC1A",64,0)
 ;
"RTN","XMC1A",65,0)
 ;     The old syntax still works:
"RTN","XMC1A",66,0)
 ;
"RTN","XMC1A",67,0)
 ;     L ON LINE
"RTN","XMC1A",68,0)
 ;
"RTN","XMC1A",69,0)
 ;     is interpreted in the old way as look for the phrase "ON LINE"
"RTN","XMC1A",70,0)
 ;
"RTN","XMC1A",71,0)
 ;*****************************************************************
"RTN","XMC1A",72,0)
 ;
"RTN","XMC1A",73,0)
 ;  VARIABLES
"RTN","XMC1A",74,0)
 ;
"RTN","XMC1A",75,0)
 ;XMC1A(,,)   === Array of checks XMC1A(1,,)=success checks
"RTN","XMC1A",76,0)
 ;                                XMC1A(2,1,1)=timout (also XMC1A(2))
"RTN","XMC1A",77,0)
 ;                                XMC1A(3,,)=failure checks
"RTN","XMC1A",78,0)
 ;failure is type 'C', success is type 'A', time-out is Type 'B' above
"RTN","XMC1A",79,0)
LOOK ;For Text (See documentation above)
"RTN","XMC1A",80,0)
 ; X  = command line from file 4.6
"RTN","XMC1A",81,0)
 ;    = 'L:180 220'
"RTN","XMC1A",82,0)
 N XMC1A,XMK,XMTIME,C,I,J,Y,%
"RTN","XMC1A",83,0)
 S XMC1A("TIMEOUT")=+$P($P(X," "),":",2)
"RTN","XMC1A",84,0)
 I 'XMC1A("TIMEOUT") S XMC1A("TIMEOUT")=45
"RTN","XMC1A",85,0)
 S XMTIME=$$TSTAMP^XMXUTIL1+XMC1A("TIMEOUT")
"RTN","XMC1A",86,0)
 S XMK=1
"RTN","XMC1A",87,0)
 S Y=1
"RTN","XMC1A",88,0)
 ;Recode encoded control characters
"RTN","XMC1A",89,0)
 S XMC1A("LOOK")=XMC1
"RTN","XMC1A",90,0)
 I XMC1["~" S XMC1=$$RTRAN^XMCU1(XMC1)
"RTN","XMC1A",91,0)
 ;Parse to separate time-outs/success/error conditions
"RTN","XMC1A",92,0)
 ;'OLD' form
"RTN","XMC1A",93,0)
 I $E(XMC1)'="|",XMC1'?1.N1" |".E S XMC1A(1,1,1)=XMC1,XMC1A(1,1,2)="" G G
"RTN","XMC1A",94,0)
 ;'NEW' form
"RTN","XMC1A",95,0)
 S I=0
"RTN","XMC1A",96,0)
E ;
"RTN","XMC1A",97,0)
 S I=I+1
"RTN","XMC1A",98,0)
 I Y=1,XMC1?1.N1" |".E D TIMOUT G F
"RTN","XMC1A",99,0)
 I Y=1,XMC1?1"  " S Y=2,XMC1=$E(XMC1,3,999) G F
"RTN","XMC1A",100,0)
 S %=Y
"RTN","XMC1A",101,0)
 S Y=$S(Y=3:Y,Y=2:3,XMC1?1.N1" |".E:2,$E(XMC1,1,2)="  ":3,XMC1?1" "1.N1" ":2,XMC1?1" "1.N:2,Y=1&(I>1)&(XMC1?1.N):2,XMC1?1" |".E:3,1:Y)
"RTN","XMC1A",102,0)
 I Y=2 S:$E(XMC1)=" " XMC1=$E(XMC1,2,999) D TIMOUT G F
"RTN","XMC1A",103,0)
 S:Y>% I=1
"RTN","XMC1A",104,0)
 S X=$P(XMC1,"|",2)
"RTN","XMC1A",105,0)
 S XMC1=$E(XMC1,$L($P(XMC1,"|",1,2))+1,999)
"RTN","XMC1A",106,0)
 S %=""
"RTN","XMC1A",107,0)
 I $E(XMC1,1,2)="|:" S %=$P($P(XMC1," "),":",2),XMC1=$P(XMC1,"|:",2,99) I %,$E(XMC1,1,2)'="  " S XMC1=$P(XMC1," ",2,99) G E1
"RTN","XMC1A",108,0)
 I $E(XMC1)="|" S XMC1=$E(XMC1,2,99)
"RTN","XMC1A",109,0)
E1 ;
"RTN","XMC1A",110,0)
 I $S($L(X):1,$L(%):1,1:0) S XMC1A(Y,I,1)=X,XMC1A(Y,I,2)=%
"RTN","XMC1A",111,0)
F ;
"RTN","XMC1A",112,0)
 G E:$L(XMC1)
"RTN","XMC1A",113,0)
 ;Save Timeout for efficient access
"RTN","XMC1A",114,0)
 I $D(XMC1A(2)) S XMC1A(2)=XMC1A(2,1,1)
"RTN","XMC1A",115,0)
G ;
"RTN","XMC1A",116,0)
 D DOTRAN^XMC1(42240,XMC1A("TIMEOUT"),XMC1A("LOOK")) ;Look: Timeout=|1|, Command String='|2|'
"RTN","XMC1A",117,0)
 U IO
"RTN","XMC1A",118,0)
 X ^%ZOSF("TRMON")
"RTN","XMC1A",119,0)
 S ER=0,Y=^%ZOSF("TRMRD"),XMC1A("TRMRD")="N Y "_Y_" S C=Y Q"
"RTN","XMC1A",120,0)
L1 ;
"RTN","XMC1A",121,0)
 S Y=""
"RTN","XMC1A",122,0)
 D L2
"RTN","XMC1A",123,0)
 S XMK=XMK+1
"RTN","XMC1A",124,0)
 I XMC("SHOW TRAN")["R" D DOTRAN^XMC1("R: "_Y)
"RTN","XMC1A",125,0)
 G LQ:$D(XMC1A("OK"))
"RTN","XMC1A",126,0)
 I ER=1 D ERTRAN^XMC1(37001) S J=$G(XMC1A(2)) G LQ:'J S ER=0 G GO ;Time out.
"RTN","XMC1A",127,0)
 I XMK>199 D DOTRAN^XMC1(42241) S J=$G(XMC1A(2)) G GO:J S ER=1 Q  ;200 Reads!
"RTN","XMC1A",128,0)
 G L1
"RTN","XMC1A",129,0)
L2 ;
"RTN","XMC1A",130,0)
 N C,X
"RTN","XMC1A",131,0)
L3 ;
"RTN","XMC1A",132,0)
 X "R X#"_$S(XMC1A("LOOK")[220:3,220-$L(Y)>0:220-$L(Y),1:1)_$S($D(XMDECNET):"",1:":1")
"RTN","XMC1A",133,0)
 S Y=Y_X
"RTN","XMC1A",134,0)
 X XMC1A("TRMRD")
"RTN","XMC1A",135,0)
 I C>0 S Y=Y_"~"_$S(C+64<255:$C(C+64),1:"~")
"RTN","XMC1A",136,0)
 F I=1,3 F %=0:0 S %=$O(XMC1A(I,%)) Q:'%  I Y[XMC1A(I,%,1) S J=XMC1A(I,%,2) G GO:J'="",OK:I=1 S ER=1 Q
"RTN","XMC1A",137,0)
 I $S($L(Y)>220:1,C=13:1,1:0) Q
"RTN","XMC1A",138,0)
 G L3:$$TSTAMP^XMXUTIL1<XMTIME
"RTN","XMC1A",139,0)
 S ER=1
"RTN","XMC1A",140,0)
 Q
"RTN","XMC1A",141,0)
LQ ;
"RTN","XMC1A",142,0)
 K XMC1A
"RTN","XMC1A",143,0)
 X ^%ZOSF("TRMOFF")
"RTN","XMC1A",144,0)
 Q
"RTN","XMC1A",145,0)
GO ;
"RTN","XMC1A",146,0)
 S XMCI=J-.00001
"RTN","XMC1A",147,0)
OK ;
"RTN","XMC1A",148,0)
 S XMC1A("OK")=1
"RTN","XMC1A",149,0)
 Q
"RTN","XMC1A",150,0)
TIMOUT ;
"RTN","XMC1A",151,0)
 S Y=2,XMC1A(2,1,1)=+XMC1,XMC1=$P(XMC1," ",2,99)
"RTN","XMC1A",152,0)
 Q
"RTN","XMC1A1")
1^9
"RTN","XMC1B")
0^10^B5097848
"RTN","XMC1B",1,0)
XMC1B ;(WASH ISC)/THM-Script Interpreter (Open/Close) ;06/11/2002  09:33
"RTN","XMC1B",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMC1B",3,0)
 ; In:
"RTN","XMC1B",4,0)
 ; XMB
"RTN","XMC1B",5,0)
 ; XMC1
"RTN","XMC1B",6,0)
OPEN ;OPEN Command
"RTN","XMC1B",7,0)
 ; O H=FORUM.VA.GOV,P=TCP/IP-MAILMAN
"RTN","XMC1B",8,0)
 N XMI,XMCP,XMCP1,XMCP2
"RTN","XMC1B",9,0)
 F XMI=1:1:$L(XMC1,",") S XMCP=$P(XMC1,",",XMI) D  Q:ER
"RTN","XMC1B",10,0)
 . S XMCP1=$P(XMCP,"=",1),XMCP2=$P(XMCP,"=",2)
"RTN","XMC1B",11,0)
 . I XMCP1=$E("HOST",1,$L(XMCP1)) D HOST(XMCP2) Q
"RTN","XMC1B",12,0)
 . I XMCP1=$E("PROTOCOL",1,$L(XMCP1)) D PROT(XMCP2) Q
"RTN","XMC1B",13,0)
 . D ERTRAN^XMC1(42245,XMCP1) ;Invalid parameter: '|1|'
"RTN","XMC1B",14,0)
 Q:ER
"RTN","XMC1B",15,0)
 I $G(XMPROT)="" D PROT("SCP")
"RTN","XMC1B",16,0)
 D DEVICE Q:ER
"RTN","XMC1B",17,0)
 Q
"RTN","XMC1B",18,0)
HOST(X) ; Host - Set IP address used by transmission scripts in file 4.6
"RTN","XMC1B",19,0)
 S XMHOST=$P(XMB("SCR REC"),U,6)
"RTN","XMC1B",20,0)
 I XMHOST="" S XMHOST="NO-IP"
"RTN","XMC1B",21,0)
 Q
"RTN","XMC1B",22,0)
PROT(XMCHAN) ; Communications Protocol
"RTN","XMC1B",23,0)
 N Y
"RTN","XMC1B",24,0)
 D GET^XML
"RTN","XMC1B",25,0)
 Q
"RTN","XMC1B",26,0)
DEVICE ;
"RTN","XMC1B",27,0)
 S XMCP2=$S($D(ZTQUEUED)&$L($G(ZTIO)):ZTIO,$D(ZTQUEUED)&$L($G(ION)):ION,$L($G(XMIO)):XMIO,1:$P(XMB("SCR REC"),U,5))
"RTN","XMC1B",28,0)
 Q:XMCP2=""
"RTN","XMC1B",29,0)
 D TRYDEV(XMCP2) Q:'ER
"RTN","XMC1B",30,0)
 I $G(XMIO)="",$G(XMIO)=$G(ZTIO),$G(XMIO)'=XMCP2 D TRYDEV(XMIO)
"RTN","XMC1B",31,0)
 Q
"RTN","XMC1B",32,0)
TRYDEV(X) ; Device specification parsing
"RTN","XMC1B",33,0)
 S ER=0 I $D(ZTQUEUED),IO'="" U IO D D1 Q
"RTN","XMC1B",34,0)
 I X="" S ER=1 Q
"RTN","XMC1B",35,0)
 S %ZIS="R",IOP=X D ^%ZIS K IOP
"RTN","XMC1B",36,0)
 I POP D ERTRAN^XMC1(42246,X) Q  ;Device '|1|' could not be opened by %ZIS.
"RTN","XMC1B",37,0)
 S XMHANG("OPEN")=9
"RTN","XMC1B",38,0)
 D D1
"RTN","XMC1B",39,0)
 Q
"RTN","XMC1B",40,0)
D1 ;
"RTN","XMC1B",41,0)
 S XMC("DEVICE")=$P(^%ZIS(1,IOS,0),U),XMC("MODEM")=$P(^(0),U,6)
"RTN","XMC1B",42,0)
 I $L(XMC("MODEM")),$D(^%ZIS(2,XMC("MODEM"),50)) S XMDIAL=^(50),XMHANG=^(51),XMSTAT=$G(^(52))
"RTN","XMC1B",43,0)
 Q:IOT="RES"
"RTN","XMC1B",44,0)
 U IO X ^%ZOSF("EOFF") S X=255 X ^%ZOSF("RM") X ^%ZOSF("TYPE-AHEAD")
"RTN","XMC1B",45,0)
 Q
"RTN","XMC1B",46,0)
CLOSE ; Close channel
"RTN","XMC1B",47,0)
 I $G(XMHANG)'="" X XMHANG D:$L(IO) FLUSH^XMC1
"RTN","XMC1B",48,0)
 ;|1| sent, |2| received, |3| retransmissions.
"RTN","XMC1B",49,0)
 D DOTRAN^XMC1($S($G(XMTLER):42248,1:42247),+$G(XMC("S")),+$G(XMC("R")),$G(XMTLER))
"RTN","XMC1B",50,0)
 I '$D(ZTQUEUED),$G(XMHANG("OPEN"))=9 D ^%ZISC
"RTN","XMC1B",51,0)
 S IOP="HOME" D ^%ZIS
"RTN","XMC1B",52,0)
 ; Instead of the above line, v7.1 does this: *******************
"RTN","XMC1B",53,0)
 ; I '$D(ZTQUEUED) D HOME^%ZIS
"RTN","XMC1B",54,0)
 ; I $D(ZTQUEUED) S IO("C")=1 D ^%ZISC
"RTN","XMC1B",55,0)
 I $G(XMINST),$D(^XMBS(4.2999,XMINST,3)) S $P(^(3),U,1,6)="^^^^^"
"RTN","XMC1B",56,0)
 Q
"RTN","XMC2")
1^11
"RTN","XMC3")
1^12
"RTN","XMC4")
1^13
"RTN","XMCB")
0^14^B12594462
"RTN","XMCB",1,0)
XMCB ;ISC-SF/GMB- Batch Message Transmission ;04/17/2002  07:59
"RTN","XMCB",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMCB",3,0)
 ; Was (WASH ISC)/THM
"RTN","XMCB",4,0)
 ;
"RTN","XMCB",5,0)
 ; Entry points used by MailMan options (not covered by DBIA):
"RTN","XMCB",6,0)
 ; TAPEOUT  XMS-SEQ-TRANSMIT     (was BAT^XMS)
"RTN","XMCB",7,0)
 ; TAPEIN   XMR-SEQ-RECEIVE      (was BAT^XMR)
"RTN","XMCB",8,0)
 ; GLBOUT   XMR-UCI-SEND         (was TASKER^XMS)
"RTN","XMCB",9,0)
 ; GLBIN    XMR-UCI-RCV          (was TASKER^XMR)
"RTN","XMCB",10,0)
 Q
"RTN","XMCB",11,0)
TAPEOUT ; Write messages to tape.
"RTN","XMCB",12,0)
 ; (Transmit them to another site via tape.)
"RTN","XMCB",13,0)
 N XMC,XMCHAN,XMINST,XMSITE,XMABORT,ER
"RTN","XMCB",14,0)
 S XMABORT=0,XMCHAN="TAPE"
"RTN","XMCB",15,0)
 D ASKINST^XMCXU(.XMINST,.XMSITE,.XMABORT,"M") Q:XMABORT
"RTN","XMCB",16,0)
 D OPEN^XML Q:$G(ER)!$G(POP)
"RTN","XMCB",17,0)
 D OUTDO
"RTN","XMCB",18,0)
 D KL^XMC
"RTN","XMCB",19,0)
 Q
"RTN","XMCB",20,0)
TAPEIN ; Read messages from tape.
"RTN","XMCB",21,0)
 ; (Receive them from another site via tape.)
"RTN","XMCB",22,0)
 N XMC,XMCHAN,ER
"RTN","XMCB",23,0)
 S ER=0,(XMC("BATCH"),XMC("TURN"))=1,XMCHAN="T-IN"
"RTN","XMCB",24,0)
 I $$NEWERR^%ZTER N $ETRAP,$ESTACK S $ETRAP="D R^XMCTRAP"
"RTN","XMCB",25,0)
 E  S X="R^XMCTRAP",@^%ZOSF("TRAP")
"RTN","XMCB",26,0)
 D ENT^XMR
"RTN","XMCB",27,0)
 U IO(0) D ^%ZISC
"RTN","XMCB",28,0)
 G KL1^XMC
"RTN","XMCB",29,0)
 Q
"RTN","XMCB",30,0)
GLBOUT ; Write messages to a global.
"RTN","XMCB",31,0)
 ; (Transmit them to another UCI via the global.)
"RTN","XMCB",32,0)
 W $C(7),!!
"RTN","XMCB",33,0)
 I '$D(^%ZISL(4.281,0)) W !!,$$EZBLD^DIALOG(42250) Q  ;File 4.281 is not set up properly.
"RTN","XMCB",34,0)
 N XMTEXT
"RTN","XMCB",35,0)
 D BLD^DIALOG(42251,"","","XMTEXT","F")
"RTN","XMCB",36,0)
 D MSG^DIALOG("WM","","","","XMTEXT")
"RTN","XMCB",37,0)
 ;  ******* I M P O R T A N T *******"
"RTN","XMCB",38,0)
 ;This option transmits messages from one UCI to another via ^%ZISL(4.281.
"RTN","XMCB",39,0)
 ;Each UCI must be running MailMan, and file 4.281 must be translated and
"RTN","XMCB",40,0)
 ;accessible from both UCIs.  In the two-step process, the messages are
"RTN","XMCB",41,0)
 ;written to the global from one UCI, and read from it in the other.
"RTN","XMCB",42,0)
 ;
"RTN","XMCB",43,0)
 ;Invoke this option on the sending UCI, and select the domain whose
"RTN","XMCB",44,0)
 ;messages are to be transmitted.  (The domain name must be the exact
"RTN","XMCB",45,0)
 ;name of the domain of the receiving UCI - no synonyms.)  The messages
"RTN","XMCB",46,0)
 ;are written to file 4.281 and deleted from the transmit queue.
"RTN","XMCB",47,0)
 ;
"RTN","XMCB",48,0)
 ;Log on to the receiving UCI and invoke the receiver.  It will read all
"RTN","XMCB",49,0)
 ;messages in file 4.281 which were sent to it (it can't read any
"RTN","XMCB",50,0)
 ;messages sent to any other domain), and queue them to be delivered.
"RTN","XMCB",51,0)
 ;The messages will then be deleted from file 4.281.
"RTN","XMCB",52,0)
 N XMC,XMCHAN,XMLINE,XMFDA,XMIEN,XMIENS,XMABORT,XMINST,XMSITE,XMTASK,ER,Y
"RTN","XMCB",53,0)
 S XMCHAN="TASKER",(XMABORT,XMLINE)=0
"RTN","XMCB",54,0)
 D ASKINST^XMCXU(.XMINST,.XMSITE,.XMABORT,"M") Q:XMABORT
"RTN","XMCB",55,0)
 D GET^XML Q:$G(ER)!$G(POP)
"RTN","XMCB",56,0)
 S XMFDA(4.281,"+1,",.01)=^XMB("NETNAME")
"RTN","XMCB",57,0)
 D UPDATE^DIE("","XMFDA","XMIEN")
"RTN","XMCB",58,0)
 S XMTASK=XMIEN(1)
"RTN","XMCB",59,0)
 D OUTDO
"RTN","XMCB",60,0)
 S XMIENS=XMTASK_","
"RTN","XMCB",61,0)
 S XMFDA(4.281,XMIENS,1)=XMSITE
"RTN","XMCB",62,0)
 D FILE^DIE("","XMFDA")
"RTN","XMCB",63,0)
 D KL^XMC
"RTN","XMCB",64,0)
 Q
"RTN","XMCB",65,0)
OUTDO ;
"RTN","XMCB",66,0)
 N XM,XMDUZ
"RTN","XMCB",67,0)
 U IO(0)
"RTN","XMCB",68,0)
 S XM="",(XMC("BATCH"),XMC("TURN"))=1
"RTN","XMCB",69,0)
 D GET^XMCXT(0)
"RTN","XMCB",70,0)
 W !,$$EZBLD^DIALOG(42252) ;Dumping messages now
"RTN","XMCB",71,0)
 U IO
"RTN","XMCB",72,0)
 D ENTER^XMS
"RTN","XMCB",73,0)
 U IO(0)
"RTN","XMCB",74,0)
 I $D(XMC("S")) W $C(7)," ... ",$$EZBLD^DIALOG(42253,XMC("S")) ;Messages dumped: |1|
"RTN","XMCB",75,0)
 X XMCLOSE
"RTN","XMCB",76,0)
 Q
"RTN","XMCB",77,0)
GLBIN ; Read messages from a global.
"RTN","XMCB",78,0)
 ; (Receive them from another UCI via the global.)
"RTN","XMCB",79,0)
 N XM,XMC,XMCHAN,XMDUZ,XMTASK,XMNETNAM,XMSITE,XMABORT,XMI,XMIREC,XMCNT,Y
"RTN","XMCB",80,0)
 S XM=$S($D(ZTQUEUED):"",1:"D")
"RTN","XMCB",81,0)
 S XMNETNAM=^XMB("NETNAME"),XMABORT=0,XMCHAN="TASK-IN"
"RTN","XMCB",82,0)
 D GET^XML Q:$G(ER)
"RTN","XMCB",83,0)
 I XM["D" D  Q:XMABORT
"RTN","XMCB",84,0)
 . D GET^XMCXT(0)
"RTN","XMCB",85,0)
 . D DOTRAN^XMC1(42254,XMNETNAM) ;Receive messages for |1|
"RTN","XMCB",86,0)
 . D PAGE^XMXUTIL(.XMABORT)
"RTN","XMCB",87,0)
 S (XMI,XMCNT)=0
"RTN","XMCB",88,0)
 F  S XMI=$O(^%ZISL(4.281,"C",XMNETNAM,XMI)) Q:'XMI  D  Q:ER
"RTN","XMCB",89,0)
 . S XMIREC=$G(^%ZISL(4.281,XMI,0)) Q:XMIREC=""
"RTN","XMCB",90,0)
 . Q:$P(XMIREC,U,2)'=XMNETNAM
"RTN","XMCB",91,0)
 . S XMSITE=$P(XMIREC,U,1)
"RTN","XMCB",92,0)
 . S XMIREC=$G(^%ZISL(4.281,XMI,"T",1,0)) Q:XMIREC'?1"HELO ".E
"RTN","XMCB",93,0)
 . S XMCNT=XMCNT+1
"RTN","XMCB",94,0)
 . I XM["D" D DOTRAN^XMC1(42255,XMI,XMSITE) ;Loading entry #|1| from |2|
"RTN","XMCB",95,0)
 . S XMTASK=XMI,ER=0,XMLINE=.999,(XMC("BATCH"),XMC("TURN"),XMQUIET)=1
"RTN","XMCB",96,0)
 . D RECEIVE^XMR Q:ER
"RTN","XMCB",97,0)
 . N DA,DIK
"RTN","XMCB",98,0)
 . S DA=XMTASK,DIK="^%ZISL(4.281," D ^DIK
"RTN","XMCB",99,0)
 I XM["D" D
"RTN","XMCB",100,0)
 . I XMCNT D DOTRAN^XMC1(42257,XMC("R")) Q  ;Messages received: |1|
"RTN","XMCB",101,0)
 . D DOTRAN^XMC1(42256,XMNETNAM) ;No entries found in file 4.281 for |1|
"RTN","XMCB",102,0)
 D KL^XMC
"RTN","XMCB",103,0)
 Q
"RTN","XMCD")
0^15^B8363136
"RTN","XMCD",1,0)
XMCD ;(WASH ISC)/THM-Communications Diagnostics ;04/17/2002  08:27
"RTN","XMCD",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMCD",3,0)
 ; Entry points used by MailMan options (not covered by DBIA):
"RTN","XMCD",4,0)
 ; DIALER  XMDXMODEM
"RTN","XMCD",5,0)
 ; TRAN    XMDXSCRIPT
"RTN","XMCD",6,0)
 ; SMTP    XMDXSMTP
"RTN","XMCD",7,0)
 Q
"RTN","XMCD",8,0)
DIALER ; Test the modem autodialer
"RTN","XMCD",9,0)
 W !!,"This tests the modem autodialer by allowing you to enter a phone number"
"RTN","XMCD",10,0)
 W !,"which this program will then dial on the selected modem.",!!
"RTN","XMCD",11,0)
 N XMABORT,XMPHONE,XMHANG,XMSTAT,XMDIAL,DIR,X,Y
"RTN","XMCD",12,0)
 S (XMABORT,ER)=0
"RTN","XMCD",13,0)
 F  D ^%ZIS Q:POP  D  Q:XMABORT
"RTN","XMCD",14,0)
 . D D1^XMC1B
"RTN","XMCD",15,0)
 . U IO(0)
"RTN","XMCD",16,0)
 . I XMC("MODEM")="" W !,$C(7),"This device has no modem defined for it." Q
"RTN","XMCD",17,0)
 . W !,^%ZIS(2,XMC("MODEM"),0)," is the defined modem for device ",IO
"RTN","XMCD",18,0)
 . I $L(XMSTAT) W !,"Checking status..." U IO X XMSTAT U IO(0) W " Status: ",Y
"RTN","XMCD",19,0)
 . I '$L(XMDIAL) W !,"No dialer logic specified for this modem type" Q
"RTN","XMCD",20,0)
 . I '$L(XMHANG) W !,"No hangup logic specified for this modem type",$C(7) Q
"RTN","XMCD",21,0)
 . F  D  Q:XMABORT!'ER
"RTN","XMCD",22,0)
 . . K DIR,X,Y
"RTN","XMCD",23,0)
 . . S DIR(0)="F^3:30"
"RTN","XMCD",24,0)
 . . S DIR("A")="Enter the phone number to dial"
"RTN","XMCD",25,0)
 . . D ^DIR I $D(DIRUT) S XMABORT=1 Q
"RTN","XMCD",26,0)
 . . S XMPHONE=Y
"RTN","XMCD",27,0)
 . . U IO X XMDIAL U IO(0)
"RTN","XMCD",28,0)
 . . I ER W !,$C(7),"Call failed: ",Y
"RTN","XMCD",29,0)
 . Q:XMABORT
"RTN","XMCD",30,0)
 . W !,"Successful.  Now hanging up ..."
"RTN","XMCD",31,0)
 . U IO X XMHANG U IO(0)
"RTN","XMCD",32,0)
 . I ER W !,$C(7),"Hang up unsuccessful" Q
"RTN","XMCD",33,0)
 . W !,"Hang up successful."
"RTN","XMCD",34,0)
 D KILL^XMC
"RTN","XMCD",35,0)
 Q
"RTN","XMCD",36,0)
SMTP ; SMTP Tester
"RTN","XMCD",37,0)
 W !!,"This procedure will test the Simple Mail Transfer Protocol,"
"RTN","XMCD",38,0)
 W !,"allowing you to interactively enter each of the SMTP commands."
"RTN","XMCD",39,0)
 W !,"The messages will not actually be delivered to the named recipients."
"RTN","XMCD",40,0)
 W !,"That which you type will be preceded with an 'S: '."
"RTN","XMCD",41,0)
 W !,"The SMTP responses will be preceded with an 'R: '"
"RTN","XMCD",42,0)
 W !!,"Terminate the session with a QUIT command",!!
"RTN","XMCD",43,0)
 D TST^XMR
"RTN","XMCD",44,0)
 Q
"RTN","XMCD",45,0)
TRAN ; Test transmission error rates, speeds
"RTN","XMCD",46,0)
 N XMSECURE,%X,%Y
"RTN","XMCD",47,0)
 W !!,"This will test a link by executing the script, then sending 20 lines"
"RTN","XMCD",48,0)
 W !,"in echo test mode.  It will report the number of recoverable and "
"RTN","XMCD",49,0)
 W !,"unrecoverable errors, as well as the transmission efficiency."
"RTN","XMCD",50,0)
 D LOADCODE^XMJMCODE
"RTN","XMCD",51,0)
 S %X="XMSECURE(",%Y="^TMP(""XMS"",$J,""S""," D %XY^%RCR
"RTN","XMCD",52,0)
 K XMSECURE
"RTN","XMCD",53,0)
 S XMC("TEST")=1
"RTN","XMCD",54,0)
 D PLAY^XMCX
"RTN","XMCD",55,0)
 K XMC("TEST"),^TMP("XMS",$J,"S")
"RTN","XMCD",56,0)
 D KILL^XMC
"RTN","XMCD",57,0)
 Q
"RTN","XMCDNT")
0^262^B579239
"RTN","XMCDNT",1,0)
XMCDNT ;(HINES ISC)/EEJ-NT Communications Diagnostics (shareware) ;04/17/2002  08:27
"RTN","XMCDNT",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMCDNT",3,0)
 ;EEJ,hines ISC.  Will test mailers in other domains for TCP/IP
"RTN","XMCDNT",4,0)
 W !,"TCP/IP tester"
"RTN","XMCDNT",5,0)
 W !!,"Enter the TCP/IP address of remote site: "
"RTN","XMCDNT",6,0)
 R ZHOST
"RTN","XMCDNT",7,0)
 O 56::10 E  W !,"Device 56 not open" Q
"RTN","XMCDNT",8,0)
 W !!,"Testing...",!
"RTN","XMCDNT",9,0)
 U 56::"TCP"
"RTN","XMCDNT",10,0)
 W /SOCKET(ZHOST,25)
"RTN","XMCDNT",11,0)
 U 56 R ZANSWER:10
"RTN","XMCDNT",12,0)
 I ZANSWER["220" U 0 W !,ZANSWER,"     Successful."
"RTN","XMCDNT",13,0)
 E  U 0 W !,"No answer from mailer at ",ZHOST
"RTN","XMCDNT",14,0)
 C 56
"RTN","XMCDNT",15,0)
 Q
"RTN","XMCE")
0^16^B3445836
"RTN","XMCE",1,0)
XMCE ;ISC-SF/GMB-Edit Scripts ;04/17/2002  08:39
"RTN","XMCE",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMCE",3,0)
 ; Was (WASH ISC)/THM
"RTN","XMCE",4,0)
 ;
"RTN","XMCE",5,0)
 ; Entry points used by MailMan options (not covered by DBIA):
"RTN","XMCE",6,0)
 ; VAL     XMEDIT-DOMAIN-VALIDATION#     (was VAL^XMC2)
"RTN","XMCE",7,0)
 ; OUT     XMSCRIPTOUT                   (was OUT^XMC2)
"RTN","XMCE",8,0)
 ; EDIT42  XMSCRIPTEDIT                  (was EDIT^XMC11)
"RTN","XMCE",9,0)
 ; EDIT46  XMSUBEDIT                     (was EDITSC^XMC11)
"RTN","XMCE",10,0)
 Q
"RTN","XMCE",11,0)
OUT ; Toggle script out of service
"RTN","XMCE",12,0)
 N XMINST,XMSITE,XMABORT,DA,DR,DIE,X,Y
"RTN","XMCE",13,0)
 S XMABORT=0
"RTN","XMCE",14,0)
 D ASKINST^XMCXU(.XMINST,.XMSITE,.XMABORT) Q:XMABORT
"RTN","XMCE",15,0)
 S DA=XMINST
"RTN","XMCE",16,0)
 S DR="1"         ; Flags
"RTN","XMCE",17,0)
 S DR=DR_";4"     ; Scripts
"RTN","XMCE",18,0)
 S DR(2,4.21)=1.5 ; Only the 'out of order' field in the Script multiple
"RTN","XMCE",19,0)
 S DIE="^DIC(4.2,"
"RTN","XMCE",20,0)
 D ^DIE
"RTN","XMCE",21,0)
 Q:'$$BMSGCT^XMXUTIL(.5,XMINST+1000)  ; Quit if no msgs queued.
"RTN","XMCE",22,0)
 D CHKTSK^XMCXU(XMINST,1,.XMABORT) Q:XMABORT
"RTN","XMCE",23,0)
 D ASKSCR^XMCXU(XMINST,XMSITE,.XMB,.XMABORT)
"RTN","XMCE",24,0)
 D QUEUE^XMCX(XMINST,XMSITE,.XMB)
"RTN","XMCE",25,0)
 Q
"RTN","XMCE",26,0)
VAL ; Edit domain validation number
"RTN","XMCE",27,0)
 N XMINST,XMSITE,XMABORT,DA,DR,DIE,X,Y
"RTN","XMCE",28,0)
 S XMABORT=0
"RTN","XMCE",29,0)
 D ASKINST^XMCXU(.XMINST,.XMSITE,.XMABORT) Q:XMABORT
"RTN","XMCE",30,0)
 S DIE=4.2,DA=XMINST,DR="1.6"
"RTN","XMCE",31,0)
 D ^DIE
"RTN","XMCE",32,0)
 Q
"RTN","XMCE",33,0)
EDIT42 ; Edit fields in file 4.2, DOMAIN
"RTN","XMCE",34,0)
 N XMINST,XMSITE,XMTSK,XMABORT,DA,DR,DIE,X,Y
"RTN","XMCE",35,0)
 S XMABORT=0
"RTN","XMCE",36,0)
 D ASKINST^XMCXU(.XMINST,.XMSITE,.XMABORT) Q:XMABORT
"RTN","XMCE",37,0)
 S DIE=4.2,DA=XMINST,DR="17;1:4.2;6.2:6.9",DR(2,4.21)=".01;1:99"
"RTN","XMCE",38,0)
 D ^DIE
"RTN","XMCE",39,0)
 S XMTSK=$P($G(^XMBS(4.2999,DA,3)),U,7)
"RTN","XMCE",40,0)
 S DIE=4.2999,DR=25
"RTN","XMCE",41,0)
 D ^DIE
"RTN","XMCE",42,0)
 Q:'XMTSK
"RTN","XMCE",43,0)
 Q:'$P($G(^XMBS(4.2999,DA,3)),U,7)
"RTN","XMCE",44,0)
 D KILLTSK^XMKPR(DA,XMTSK)
"RTN","XMCE",45,0)
 Q
"RTN","XMCE",46,0)
EDIT46 ; Edit TRANSMISSION SCRIPT name and text in file 4.6
"RTN","XMCE",47,0)
 N DIC,DLAYGO,X,Y
"RTN","XMCE",48,0)
 S (DLAYGO,DIC)=4.6,DIC(0)="AEQML"
"RTN","XMCE",49,0)
 D ^DIC Q:Y<0
"RTN","XMCE",50,0)
 N DIE,DR,DA
"RTN","XMCE",51,0)
 S DA=+Y,DIE=4.6,DR=".01;1"
"RTN","XMCE",52,0)
 D ^DIE
"RTN","XMCE",53,0)
 Q
"RTN","XMCP")
0^17^B5676753
"RTN","XMCP",1,0)
XMCP ;ISC-SF/GMB-Poll Domains ;04/17/2002  08:40
"RTN","XMCP",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMCP",3,0)
 ; Was (WASH ISC)/CAP/RM/AML/THM
"RTN","XMCP",4,0)
 ;
"RTN","XMCP",5,0)
 ; Entry points used by MailMan options (not covered by DBIA):
"RTN","XMCP",6,0)
 ; POLL   XMPOLL     (was POLL^XMS1 and TSKPOLR^XMS5B)
"RTN","XMCP",7,0)
 ;
"RTN","XMCP",8,0)
 ; This option may be SCHEDULED.
"RTN","XMCP",9,0)
 ; It goes through a list of domains whose FLAGS field contains P,
"RTN","XMCP",10,0)
 ; meaning that the domains are to be "polled", that they should be
"RTN","XMCP",11,0)
 ; contacted whether or not there are messages in their queues.
"RTN","XMCP",12,0)
 ; If no messages are in the queues, the script for the poll domain
"RTN","XMCP",13,0)
 ; will be 'played' anyway, and the TURN command executed to pull in
"RTN","XMCP",14,0)
 ; any messages which may be waiting to be transmitted to this domain.
"RTN","XMCP",15,0)
 ;
"RTN","XMCP",16,0)
POLL ; Process domains on poll list.
"RTN","XMCP",17,0)
 S:$D(ZTQUEUED) ZTREQ="@"
"RTN","XMCP",18,0)
 K ^TMP("XM",$J)
"RTN","XMCP",19,0)
 I $$GOTTASKS W:'$D(ZTQUEUED) !!,$$EZBLD^DIALOG(42150) Q  ;All domains have tasks.
"RTN","XMCP",20,0)
 I $$XMITOK D TASKXMIT
"RTN","XMCP",21,0)
 K ^TMP("XM",$J)
"RTN","XMCP",22,0)
 Q
"RTN","XMCP",23,0)
GOTTASKS ; Does every poll site have a task?
"RTN","XMCP",24,0)
 N XMTSK,XMINST,XMSITE,XMPARM
"RTN","XMCP",25,0)
 S XMINST=0
"RTN","XMCP",26,0)
 F  S XMINST=$O(^DIC(4.2,"AC","P",XMINST)) Q:'XMINST  D
"RTN","XMCP",27,0)
 . W:'$D(ZTQUEUED) "."
"RTN","XMCP",28,0)
 . S XMSITE=$P(^DIC(4.2,XMINST,0),U)
"RTN","XMCP",29,0)
 . S XMTSK=$$GETTSK^XMKPR(XMINST)
"RTN","XMCP",30,0)
 . I XMTSK,'$$TSKEXIST^XMKPR(XMINST,XMTSK) S ^TMP("XM",$J,XMSITE)=XMINST Q
"RTN","XMCP",31,0)
 . Q:$D(ZTQUEUED)
"RTN","XMCP",32,0)
 . S XMPARM(1)=XMTSK,XMPARM(2)=XMSITE
"RTN","XMCP",33,0)
 . W !,$$EZBLD^DIALOG(42151,.XMPARM) ;Task |1| is already scheduled for domain |2|
"RTN","XMCP",34,0)
 Q '$D(^TMP("XM",$J))
"RTN","XMCP",35,0)
XMITOK ; Ask whether eligible queues should be transmitted.
"RTN","XMCP",36,0)
 N DIR,DIRUT,DTOUT,DUOUT,X,Y,XMSITE
"RTN","XMCP",37,0)
 I $D(ZTQUEUED) Q 1
"RTN","XMCP",38,0)
 W @IOF,$$EZBLD^DIALOG(42152) ;These domains lack tasks:
"RTN","XMCP",39,0)
 S XMSITE=""
"RTN","XMCP",40,0)
 F  S XMSITE=$O(^TMP("XM",$J,XMSITE)) Q:XMSITE=""  D
"RTN","XMCP",41,0)
 . I $Y+4>IOSL D
"RTN","XMCP",42,0)
 . . D WAIT^XMXUTIL
"RTN","XMCP",43,0)
 . . W @IOF
"RTN","XMCP",44,0)
 . W !?5,XMSITE
"RTN","XMCP",45,0)
 S DIR(0)="YO"
"RTN","XMCP",46,0)
 S DIR("A")=$$EZBLD^DIALOG(42128) ;Requeue the missing tasks
"RTN","XMCP",47,0)
 S DIR("B")=$$EZBLD^DIALOG(39053) ;NO
"RTN","XMCP",48,0)
 S DIR("?")=$$EZBLD^DIALOG(42153) ;Answer YES to transmit these domains.
"RTN","XMCP",49,0)
 D ^DIR
"RTN","XMCP",50,0)
 I 'Y W !!,$$EZBLD^DIALOG(42130) ;Tasks not requeued.
"RTN","XMCP",51,0)
 Q Y
"RTN","XMCP",52,0)
TASKXMIT ;
"RTN","XMCP",53,0)
 ; Task off transmission jobs
"RTN","XMCP",54,0)
 N XMINST,XMSITE,XMPOLL
"RTN","XMCP",55,0)
 I '$D(ZTQUEUED) W !
"RTN","XMCP",56,0)
 S XMSITE="",XMPOLL=1
"RTN","XMCP",57,0)
 F  S XMSITE=$O(^TMP("XM",$J,XMSITE)) Q:XMSITE=""  S XMINST=^(XMSITE) D
"RTN","XMCP",58,0)
 . D QUEUE^XMCX(XMINST,XMSITE)
"RTN","XMCP",59,0)
 W:'$D(ZTQUEUED) !,$$EZBLD^DIALOG(42132) ; Finished.
"RTN","XMCP",60,0)
 Q
"RTN","XMCQ")
0^18^B12337552
"RTN","XMCQ",1,0)
XMCQ ;ISC-SF/GMB-Transmit Queue Status Report ;06/13/2002  09:29
"RTN","XMCQ",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMCQ",3,0)
 ; Was (WASH ISC)/THM
"RTN","XMCQ",4,0)
 ;
"RTN","XMCQ",5,0)
 ; Entry points used by MailMan options (not covered by DBIA):
"RTN","XMCQ",6,0)
 ; STATUS   XMQDISP     (was ENTER^XMS5A)
"RTN","XMCQ",7,0)
 ; SHOWQ    XMQSHOW     (was QUEUE^XMC4)
"RTN","XMCQ",8,0)
STATUS ;
"RTN","XMCQ",9,0)
 D RESEQ^XMCQA
"RTN","XMCQ",10,0)
 D EN^XUTMDEVQ("QZTLOOP^XMCQ",$$EZBLD^DIALOG(42135)) ; MailMan: Transmission Queue Status Report
"RTN","XMCQ",11,0)
 Q
"RTN","XMCQ",12,0)
QZTLOOP ;
"RTN","XMCQ",13,0)
 I $G(IOST)'["C-" D  Q
"RTN","XMCQ",14,0)
 . D QZTSK
"RTN","XMCQ",15,0)
 . I $D(ZTQUEUED) S ZTREQ="@"
"RTN","XMCQ",16,0)
 F  D  Q:'(Y!$D(DTOUT))
"RTN","XMCQ",17,0)
 . D QZTSK
"RTN","XMCQ",18,0)
 . W !
"RTN","XMCQ",19,0)
 . N DIR,X,DTIME
"RTN","XMCQ",20,0)
 . S DTIME=5
"RTN","XMCQ",21,0)
 . S DIR(0)="Y",DIR("A")=$$EZBLD^DIALOG(42116) ; Refresh
"RTN","XMCQ",22,0)
 . S DIR("B")=$$EZBLD^DIALOG(39054) ; YES
"RTN","XMCQ",23,0)
 . ;Answer YES if you want the display refreshed.
"RTN","XMCQ",24,0)
 . ;Answer NO if you don't.
"RTN","XMCQ",25,0)
 . ;If you don't answer, the display will be refreshed every five seconds
"RTN","XMCQ",26,0)
 . D BLD^DIALOG(42117,"","","DIR(""?"")")
"RTN","XMCQ",27,0)
 . D ^DIR
"RTN","XMCQ",28,0)
 Q
"RTN","XMCQ",29,0)
QZTSK ;
"RTN","XMCQ",30,0)
 N XMRPT,XMNAME,XMIEN,XMREC,XMQD,XMCNT,XMABORT,XMTSK,XMDT,XMTM
"RTN","XMCQ",31,0)
 ;Transmission Queue Status
"RTN","XMCQ",32,0)
 ;Domain         Queued Device/Protocol       Message S/R Time   Line Err    Rate
"RTN","XMCQ",33,0)
 D INIT^XMCQA(.XMRPT,42136,42137)
"RTN","XMCQ",34,0)
 S (XMABORT,XMCNT)=0
"RTN","XMCQ",35,0)
 S XMNAME=""
"RTN","XMCQ",36,0)
 F  S XMNAME=$O(^DIC(4.2,"B",XMNAME)) Q:XMNAME=""  D  Q:XMABORT
"RTN","XMCQ",37,0)
 . S XMIEN=0
"RTN","XMCQ",38,0)
 . F  S XMIEN=$O(^DIC(4.2,"B",XMNAME,XMIEN)) Q:'XMIEN  D  Q:XMABORT
"RTN","XMCQ",39,0)
 . . S XMREC=$G(^XMBS(4.2999,XMIEN,3))
"RTN","XMCQ",40,0)
 . . S XMTSK=$$TSKEXIST^XMKPR(XMIEN,$P(XMREC,U,7))
"RTN","XMCQ",41,0)
 . . I +XMREC,$$HDIFF^XLFDT($H,$P(XMREC,U,1),2)>180 S XMREC=""
"RTN","XMCQ",42,0)
 . . S XMQD=$$BMSGCT^XMXUTIL(.5,XMIEN+1000)
"RTN","XMCQ",43,0)
 . . I 'XMQD,'XMTSK,'XMREC Q
"RTN","XMCQ",44,0)
 . . I $Y+3>IOSL D  Q:XMABORT
"RTN","XMCQ",45,0)
 . . . D PAGE^XMCQA(.XMABORT) Q:XMABORT
"RTN","XMCQ",46,0)
 . . . D HDR^XMCQA(.XMRPT)
"RTN","XMCQ",47,0)
 . . S XMCNT=XMCNT+1
"RTN","XMCQ",48,0)
 . . W !,$$MELD^XMXUTIL1(XMNAME,XMQD,21) ; domain, queued
"RTN","XMCQ",49,0)
 . . I +XMREC D  Q
"RTN","XMCQ",50,0)
 . . . S XMDT=$P($$HTE^XLFDT($P(XMREC,U,1),"2Z"),":",1,2)
"RTN","XMCQ",51,0)
 . . . S XMTM=$P(XMDT,"@",2)
"RTN","XMCQ",52,0)
 . . . ; device, msg #, R/S, time, line, errors, rate
"RTN","XMCQ",53,0)
 . . . W " ",$$MELD^XMXUTIL1($P(XMREC,U,6),$P(XMREC,U,2),29),"  ",$J($P(XMREC,U,8),1)," ",XMTM,$J($P(XMREC,U,3),7),$J($P(XMREC,U,4),3),$J($P(XMREC,U,5),9)
"RTN","XMCQ",54,0)
 . . I 'XMTSK D  Q
"RTN","XMCQ",55,0)
 . . . W ?26,$$EZBLD^DIALOG(42138,$P($G(^DIC(4.2,XMIEN,0)),U,2)) ; No task scheduled, FLAGS=|1|
"RTN","XMCQ",56,0)
 . . I XMTSK[U D  Q
"RTN","XMCQ",57,0)
 . . . N XMPARM ; Task |1| scheduled for |2|
"RTN","XMCQ",58,0)
 . . . S XMPARM(1)=$P(XMTSK,U),XMPARM(2)=$P($$HTE^XLFDT($P(XMTSK,U,2),"2Z"),":",1,2)
"RTN","XMCQ",59,0)
 . . . W ?26,$$EZBLD^DIALOG(42139,.XMPARM)
"RTN","XMCQ",60,0)
 . . W ?26,$$EZBLD^DIALOG(42140,XMTSK) ; Task |1| just started
"RTN","XMCQ",61,0)
 I 'XMCNT W !,$$EZBLD^DIALOG(42141) ; No messages queued or in active transmission.
"RTN","XMCQ",62,0)
 Q
"RTN","XMCQ",63,0)
SHOWQ ; Display messages in queue
"RTN","XMCQ",64,0)
 N XMDUZ,XMINST,XMSITE,XMABORT
"RTN","XMCQ",65,0)
 D CHECK^XMVVITAE
"RTN","XMCQ",66,0)
 S XMABORT=0 ; Choose queue w/msgs
"RTN","XMCQ",67,0)
 D ASKINST^XMCXU(.XMINST,.XMSITE,.XMABORT,"M") Q:XMABORT
"RTN","XMCQ",68,0)
 I DUZ=.5 D LIST^XMJMLR(.5,XMINST+1000,XMSITE,1,.XMABORT) Q
"RTN","XMCQ",69,0)
 I $D(^XUSEC("XMNOPRIV",DUZ))!'$D(^XMB(3.7,"AB",DUZ,.5)) D  Q
"RTN","XMCQ",70,0)
 . ; not a postmaster surrogate, so look only - no touch!
"RTN","XMCQ",71,0)
 . D LIST^XMJML(.5,XMINST+1000,XMSITE,"",1)
"RTN","XMCQ",72,0)
 S XMDUZ=.5
"RTN","XMCQ",73,0)
 D OTHER^XMVVITAE
"RTN","XMCQ",74,0)
 D LIST^XMJMLR(XMDUZ,XMINST+1000,XMSITE,1,.XMABORT)
"RTN","XMCQ",75,0)
 D SELF^XMVVITAE
"RTN","XMCQ",76,0)
 Q
"RTN","XMCQA")
0^19^B21177378
"RTN","XMCQA",1,0)
XMCQA ;ISC-SF/GMB-Transmit Queue Status Report (others) ;04/17/2002  08:10
"RTN","XMCQA",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMCQA",3,0)
 ; Was (WASH ISC)/CAP/RM/AML
"RTN","XMCQA",4,0)
 ;
"RTN","XMCQA",5,0)
 ; Entry points used by MailMan options (not covered by DBIA):
"RTN","XMCQA",6,0)
 ; ACTIVE  XMQACTIVE     (was GO^XMS5)
"RTN","XMCQA",7,0)
 ; ALL     XMQUEUED      (was ENT^XMS5)
"RTN","XMCQA",8,0)
 ;
"RTN","XMCQA",9,0)
ACTIVE ; Show queues actively transmitting.
"RTN","XMCQA",10,0)
 D EN^XUTMDEVQ("AZTLOOP^XMCQA",$$EZBLD^DIALOG(42110)) ; MailMan: Active Transmission Queues Report
"RTN","XMCQA",11,0)
 Q
"RTN","XMCQA",12,0)
AZTLOOP ;
"RTN","XMCQA",13,0)
 I $G(IOST)'["C-" D  Q
"RTN","XMCQA",14,0)
 . D AZTSK
"RTN","XMCQA",15,0)
 . I $D(ZTQUEUED) S ZTREQ="@"
"RTN","XMCQA",16,0)
 F  D  Q:'(Y!$D(DTOUT))
"RTN","XMCQA",17,0)
 . D AZTSK
"RTN","XMCQA",18,0)
 . W !
"RTN","XMCQA",19,0)
 . N DIR,X,DTIME
"RTN","XMCQA",20,0)
 . S DTIME=5
"RTN","XMCQA",21,0)
 . S DIR(0)="Y",DIR("A")=$$EZBLD^DIALOG(42116) ; Refresh
"RTN","XMCQA",22,0)
 . S DIR("B")=$$EZBLD^DIALOG(39054) ; YES
"RTN","XMCQA",23,0)
 . ;Answer YES if you want the display refreshed.
"RTN","XMCQA",24,0)
 . ;Answer NO if you don't.
"RTN","XMCQA",25,0)
 . ;If you don't answer, the display will be refreshed every five seconds.
"RTN","XMCQA",26,0)
 . D BLD^DIALOG(42117,"","","DIR(""?"")")
"RTN","XMCQA",27,0)
 . D ^DIR
"RTN","XMCQA",28,0)
 Q
"RTN","XMCQA",29,0)
AZTSK ;
"RTN","XMCQA",30,0)
 N XMIEN,XMSITE,XMABORT,XMRPT,XMCNT,XMREC,XMSECS,XMQD
"RTN","XMCQA",31,0)
 S (XMABORT,XMCNT,XMCNT("QD"))=0
"RTN","XMCQA",32,0)
 ;Active Transmission Queues
"RTN","XMCQA",33,0)
 ;Domain         Queued  Device/Protocol      Message  Line      ZTSK Err    Rate
"RTN","XMCQA",34,0)
 D INIT(.XMRPT,42111,42112)
"RTN","XMCQA",35,0)
 S XMSITE=""
"RTN","XMCQA",36,0)
 F  S XMSITE=$O(^DIC(4.2,"B",XMSITE)) Q:XMSITE=""  D  Q:XMABORT
"RTN","XMCQA",37,0)
 . S XMIEN=0
"RTN","XMCQA",38,0)
 . F  S XMIEN=$O(^DIC(4.2,"B",XMSITE,XMIEN)) Q:'XMIEN  D  Q:XMABORT
"RTN","XMCQA",39,0)
 . . S XMREC=$P($G(^XMBS(4.2999,XMIEN,3)),U,1,7)
"RTN","XMCQA",40,0)
 . . Q:"^^^^^^"[XMREC
"RTN","XMCQA",41,0)
 . . S XMSECS=$$HDIFF^XLFDT($H,$P(XMREC,U),2)
"RTN","XMCQA",42,0)
 . . Q:XMSECS>599
"RTN","XMCQA",43,0)
 . . Q:$P(XMREC,U,1,6)?.P
"RTN","XMCQA",44,0)
 . . S XMQD=$$BMSGCT^XMXUTIL(.5,XMIEN+1000)
"RTN","XMCQA",45,0)
 . . I $Y+3+(XMSECS>180)>IOSL D  Q:XMABORT
"RTN","XMCQA",46,0)
 . . . D PAGE(.XMABORT) Q:XMABORT
"RTN","XMCQA",47,0)
 . . . D HDR(.XMRPT)
"RTN","XMCQA",48,0)
 . . W !,$$MELD^XMXUTIL1(XMSITE,XMQD,21)," "  ; domain, q'd msgs
"RTN","XMCQA",49,0)
 . . I XMSECS>180 D
"RTN","XMCQA",50,0)
 . . . W $E($P(XMREC,U,6),1,16)
"RTN","XMCQA",51,0)
 . . . W ?40,$$EZBLD^DIALOG(42113,XMSECS\60) ; == Appears Inactive - |1| Minutes
"RTN","XMCQA",52,0)
 . . E  D
"RTN","XMCQA",53,0)
 . . . I '$P(XMREC,U,2) D  Q
"RTN","XMCQA",54,0)
 . . . . W $E($P(XMREC,U,6),1,16)
"RTN","XMCQA",55,0)
 . . . . W ?44,$$EZBLD^DIALOG(42114) ; Connecting/Disconnecting
"RTN","XMCQA",56,0)
 . . . ; Device, Msg #, xmit line, ztsk, errors, xmit rate
"RTN","XMCQA",57,0)
 . . . W $$MELD^XMXUTIL1($P(XMREC,U,6),$P(XMREC,U,2),29),$J($P(XMREC,U,3),6),$J($P(XMREC,U,7),10),$J($P(XMREC,U,4),3),$J($P(XMREC,U,5),9)
"RTN","XMCQA",58,0)
 . . S XMCNT=XMCNT+1
"RTN","XMCQA",59,0)
 . . S XMCNT("QD")=XMCNT("QD")+XMQD
"RTN","XMCQA",60,0)
 Q:XMABORT
"RTN","XMCQA",61,0)
 I 'XMCNT W !,$$EZBLD^DIALOG(42115) Q  ; No queues actively transmitting
"RTN","XMCQA",62,0)
 ;I $Y+5>IOSL D  Q:XMABORT
"RTN","XMCQA",63,0)
 ;. D PAGE(.XMABORT) Q:XMABORT
"RTN","XMCQA",64,0)
 ;. D HDR(.XMRPT)
"RTN","XMCQA",65,0)
 ;W !!,$$MELD^XMXUTIL1($$EZBLD^DIALOG(42103),XMCNT,27) ; Total Domains:
"RTN","XMCQA",66,0)
 ;W !,$$MELD^XMXUTIL1($$EZBLD^DIALOG(42104),XMCNT("QD"),27) ; Total Queued:
"RTN","XMCQA",67,0)
 Q
"RTN","XMCQA",68,0)
INIT(XMRPT,XMTITLE,XMHDR) ;
"RTN","XMCQA",69,0)
 S XMRPT("PAGE")=0
"RTN","XMCQA",70,0)
 S XMRPT("DATE")=$$MMDT^XMXUTIL1($$NOW^XLFDT)
"RTN","XMCQA",71,0)
 S XMRPT("TITLE")=$$EZBLD^DIALOG(XMTITLE)
"RTN","XMCQA",72,0)
 S XMRPT("HDR")=$$EZBLD^DIALOG(XMHDR)
"RTN","XMCQA",73,0)
 W:$G(IOST)["C-" @IOF
"RTN","XMCQA",74,0)
 D HDR(.XMRPT)
"RTN","XMCQA",75,0)
 Q
"RTN","XMCQA",76,0)
PAGE(XMABORT) ;
"RTN","XMCQA",77,0)
 I $G(IOST)["C-" D PAGE^XMXUTIL(.XMABORT) Q:XMABORT
"RTN","XMCQA",78,0)
 W @IOF
"RTN","XMCQA",79,0)
 Q
"RTN","XMCQA",80,0)
HDR(XMRPT) ;
"RTN","XMCQA",81,0)
 N XMPAGE
"RTN","XMCQA",82,0)
 S XMRPT("PAGE")=XMRPT("PAGE")+1
"RTN","XMCQA",83,0)
 W !,XMRPT("TITLE")
"RTN","XMCQA",84,0)
 W ?79-$L(XMRPT("DATE")),XMRPT("DATE")
"RTN","XMCQA",85,0)
 S XMPAGE=$$EZBLD^DIALOG(34542,$J(XMRPT("PAGE"),2))
"RTN","XMCQA",86,0)
 W !,^XMB("NETNAME"),?79-$L(XMPAGE),XMPAGE
"RTN","XMCQA",87,0)
 W !!,XMRPT("HDR"),!
"RTN","XMCQA",88,0)
 Q
"RTN","XMCQA",89,0)
ALL ; Show all queues which have messages, whether transmitting or not.
"RTN","XMCQA",90,0)
 D RESEQ
"RTN","XMCQA",91,0)
 D EN^XUTMDEVQ("QZTSK^XMCQA",$$EZBLD^DIALOG(42120)) ; MailMan: Transmission Queues with Messages Report
"RTN","XMCQA",92,0)
 Q
"RTN","XMCQA",93,0)
RESEQ ; Resequence the messages in the transmit queues.  This also has the
"RTN","XMCQA",94,0)
 ; effect of doing an integrity check on the queues.
"RTN","XMCQA",95,0)
 N XMK
"RTN","XMCQA",96,0)
 S XMK=999
"RTN","XMCQA",97,0)
 F  S XMK=$O(^XMB(3.7,.5,2,XMK)) Q:XMK'>0  Q:XMK>9999  I $O(^(XMK,1,0))  W:'$D(ZTQUEUED) "." D RSEQ^XMXBSKT(.5,XMK)
"RTN","XMCQA",98,0)
 Q
"RTN","XMCQA",99,0)
QZTSK ;
"RTN","XMCQA",100,0)
 N XMRPT,XMIEN,XMSITE,XMABORT,XMCNT,XMREC,XMQD
"RTN","XMCQA",101,0)
 S (XMABORT,XMCNT,XMCNT("QD"))=0
"RTN","XMCQA",102,0)
 ;Transmission Queues with Messages
"RTN","XMCQA",103,0)
 ;Domain                                   Queued    Physical Link
"RTN","XMCQA",104,0)
 D INIT(.XMRPT,42121,42122)
"RTN","XMCQA",105,0)
 S XMSITE=""
"RTN","XMCQA",106,0)
 F  S XMSITE=$O(^DIC(4.2,"B",XMSITE)) Q:XMSITE=""  D  Q:XMABORT
"RTN","XMCQA",107,0)
 . S XMIEN=0
"RTN","XMCQA",108,0)
 . F  S XMIEN=$O(^DIC(4.2,"B",XMSITE,XMIEN)) Q:'XMIEN  D  Q:XMABORT
"RTN","XMCQA",109,0)
 . . S XMQD=$$BMSGCT^XMXUTIL(.5,XMIEN+1000)
"RTN","XMCQA",110,0)
 . . Q:'XMQD
"RTN","XMCQA",111,0)
 . . S XMREC=^DIC(4.2,XMIEN,0)
"RTN","XMCQA",112,0)
 . . I $Y+3>IOSL D  Q:XMABORT
"RTN","XMCQA",113,0)
 . . . D PAGE(.XMABORT) Q:XMABORT
"RTN","XMCQA",114,0)
 . . . D HDR(.XMRPT)
"RTN","XMCQA",115,0)
 . . W !,$$MELD^XMXUTIL1($P(XMREC,U),XMQD,47),"    ",$P(XMREC,U,17)
"RTN","XMCQA",116,0)
 . . S XMCNT=XMCNT+1
"RTN","XMCQA",117,0)
 . . S XMCNT("QD")=XMCNT("QD")+XMQD
"RTN","XMCQA",118,0)
 Q:XMABORT
"RTN","XMCQA",119,0)
 I 'XMCNT W !,$$EZBLD^DIALOG(42123) Q  ; No messages queued
"RTN","XMCQA",120,0)
 I $Y+5>IOSL D  Q:XMABORT
"RTN","XMCQA",121,0)
 . D PAGE(.XMABORT) Q:XMABORT
"RTN","XMCQA",122,0)
 . D HDR(.XMRPT)
"RTN","XMCQA",123,0)
 W !!,$$MELD^XMXUTIL1($$EZBLD^DIALOG(42103),XMCNT,27) ; Total Domains:
"RTN","XMCQA",124,0)
 W !,$$MELD^XMXUTIL1($$EZBLD^DIALOG(42104),XMCNT("QD"),27) ; Total Queued:
"RTN","XMCQA",125,0)
 I $D(ZTQUEUED) S ZTREQ="@"
"RTN","XMCQA",126,0)
 Q
"RTN","XMCQH")
0^20^B4658509
"RTN","XMCQH",1,0)
XMCQH ;ISC-SF/GMB-Transmit Queue History ;04/18/2002  07:28
"RTN","XMCQH",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMCQH",3,0)
 ; Was (WASH ISC)/CAP/AML/RJ
"RTN","XMCQH",4,0)
 ;
"RTN","XMCQH",5,0)
 ; Entry points used by MailMan options (not covered by DBIA):
"RTN","XMCQH",6,0)
 ; ENTER   XMQHIST     (was ^XMS4)
"RTN","XMCQH",7,0)
ENTER ;
"RTN","XMCQH",8,0)
 D EN^XUTMDEVQ("ENT^XMCQH",$$EZBLD^DIALOG(42100)) ; MailMan: Transmission Queue History Report
"RTN","XMCQH",9,0)
 Q
"RTN","XMCQH",10,0)
ENT ;
"RTN","XMCQH",11,0)
 N XMNAME,XMRPT,XMIEN,XMREC,XMABORT,XMQD,XMCNT
"RTN","XMCQH",12,0)
 ;Transmission Queue History
"RTN","XMCQH",13,0)
 ;Domain          Queued    Sent    Rcvd   Domain          Queued    Sent    Rcvd
"RTN","XMCQH",14,0)
 D INIT^XMCQA(.XMRPT,42101,42102)
"RTN","XMCQH",15,0)
 S XMNAME="",(XMCNT,XMABORT,XMCNT("SENT"),XMCNT("RCVD"),XMCNT("QD"))=0
"RTN","XMCQH",16,0)
 F  S XMNAME=$O(^DIC(4.2,"B",XMNAME)) Q:XMNAME=""  D  Q:XMABORT
"RTN","XMCQH",17,0)
 . S XMIEN=""
"RTN","XMCQH",18,0)
 . F  S XMIEN=$O(^DIC(4.2,"B",XMNAME,XMIEN)) Q:'XMIEN  D  Q:XMABORT
"RTN","XMCQH",19,0)
 . . S XMREC=$G(^XMBS(4.2999,XMIEN,0))
"RTN","XMCQH",20,0)
 . . S XMSENT=+$P(XMREC,U,5),XMRCVD=+$P(XMREC,U,7)
"RTN","XMCQH",21,0)
 . . S XMQD=$$BMSGCT^XMXUTIL(.5,XMIEN+1000)
"RTN","XMCQH",22,0)
 . . I 'XMQD,'XMSENT,'XMRCVD Q
"RTN","XMCQH",23,0)
 . . S XMCNT("SENT")=XMCNT("SENT")+XMSENT
"RTN","XMCQH",24,0)
 . . S XMCNT("RCVD")=XMCNT("RCVD")+XMRCVD
"RTN","XMCQH",25,0)
 . . S XMCNT("QD")=XMCNT("QD")+XMQD
"RTN","XMCQH",26,0)
 . . S XMCNT=XMCNT+1
"RTN","XMCQH",27,0)
 . . I XMCNT#2 D  Q:XMABORT
"RTN","XMCQH",28,0)
 . . . I $Y+3>IOSL D  Q:XMABORT
"RTN","XMCQH",29,0)
 . . . . D PAGE^XMCQA(.XMABORT) Q:XMABORT
"RTN","XMCQH",30,0)
 . . . . D HDR^XMCQA(.XMRPT)
"RTN","XMCQH",31,0)
 . . . W !
"RTN","XMCQH",32,0)
 . . E  W "   "
"RTN","XMCQH",33,0)
 . . W $$MELD^XMXUTIL1(XMNAME,XMQD,22),$J(XMSENT,8),$J(XMRCVD,8)
"RTN","XMCQH",34,0)
 Q:XMABORT
"RTN","XMCQH",35,0)
 I $Y+7>IOSL D  Q:XMABORT
"RTN","XMCQH",36,0)
 . D PAGE^XMCQA(.XMABORT)
"RTN","XMCQH",37,0)
 . D HDR^XMCQA(.XMRPT)
"RTN","XMCQH",38,0)
 W !!,$$MELD^XMXUTIL1($$EZBLD^DIALOG(42103),XMCNT,27) ; Total Domains:
"RTN","XMCQH",39,0)
 W !,$$MELD^XMXUTIL1($$EZBLD^DIALOG(42104),XMCNT("QD"),27) ; Total Queued:
"RTN","XMCQH",40,0)
 W !,$$MELD^XMXUTIL1($$EZBLD^DIALOG(42105),XMCNT("SENT"),27) ; Total Sent:
"RTN","XMCQH",41,0)
 W !,$$MELD^XMXUTIL1($$EZBLD^DIALOG(42106),XMCNT("RCVD"),27) ; Total Received:
"RTN","XMCQH",42,0)
 I $D(ZTQUEUED) S ZTREQ="@"
"RTN","XMCQH",43,0)
 Q
"RTN","XMCSIZE")
0^263^B2168987
"RTN","XMCSIZE",1,0)
XMCSIZE ;(WASH ISC)/AML-Message Stats Tool (shareware) ;04/17/2002  08:26
"RTN","XMCSIZE",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMCSIZE",3,0)
 R !,"Message number: ",XMZ:$S($D(DTIME):DTIME,1:300) Q:'$T  W !,"WORKING..." S Y=0
"RTN","XMCSIZE",4,0)
 S I=0 F X=0:0 S X=$O(^XMB(3.9,XMZ,2,X)) Q:X=""  S I=I+1,Y=Y+$L(^(X,0)) I I#100=0 W "." I $X>70 W !
"RTN","XMCSIZE",5,0)
 W !,I," Lines ","   ",Y,"  Bytes ",!
"RTN","XMCSIZE",6,0)
TT R !,"Transmission time in seconds:  ",%:$S($D(DTIME):DTIME,1:300) Q:%=""!(%["^")!'$T
"RTN","XMCSIZE",7,0)
 I %'?1.N!'% W $C(7),!,"   Enter a non-zero number of seconds, please.",! G TT
"RTN","XMCSIZE",8,0)
 W !,$J(I-1/%,15,2)," Lines/sec  ",$J(Y/%,20,2),"  Bytes/sec",!
"RTN","XMCSIZE",9,0)
 Q
"RTN","XMCSIZE",10,0)
COMP ;COMPARE TWO MESSAGES
"RTN","XMCSIZE",11,0)
 R !,"First message to compare: ",XMZ1:$S($D(DTIME):DTIME,1:300) Q:XMZ1=""
"RTN","XMCSIZE",12,0)
 R !,"Second message to compare: ",XMZ2:$S($D(DTIME):DTIME,1:300) Q:XMZ2=""
"RTN","XMCSIZE",13,0)
 K ^TMP($J) F O=0:1 Q:'$D(^XMB(3.9,XMZ1,2,O+1,0))  S ^TMP($J,1,O+1,0)=^(0)
"RTN","XMCSIZE",14,0)
 F F=0:1 Q:'$D(^XMB(3.9,XMZ2,2,F+1,0))  S ^TMP($J,2,F+1,0)=^(0)
"RTN","XMCSIZE",15,0)
 ;
"RTN","XMCSIZE",16,0)
 D ^XMPC
"RTN","XMCSIZE",17,0)
 Q
"RTN","XMCSIZE",18,0)
 ;F I=1:1 Q:'$D(^XMB(3.9,XMZ1,2,I,0))  S X=^(0),Y=^XMB(3.9,XMZ2,2,I,0) D:X'=Y CHK
"RTN","XMCSIZE",19,0)
 ;Q
"RTN","XMCSIZE",20,0)
CHK ;COMPARE DIFFERENCES
"RTN","XMCSIZE",21,0)
 W !,X,!!,Y Q
"RTN","XMCTLK")
0^21^B40421145
"RTN","XMCTLK",1,0)
XMCTLK ;(WASH ISC)/CAP-TalkMan ;04/18/2002  07:29
"RTN","XMCTLK",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMCTLK",3,0)
 ; Entry points used by MailMan options (not covered by DBIA):
"RTN","XMCTLK",4,0)
 ; TALK   XMTALK
"RTN","XMCTLK",5,0)
 I '$D(DUZ) W !,$C(7),"You don't have a DUZ." Q
"RTN","XMCTLK",6,0)
 N XMABORT,XMDUZ,XMV
"RTN","XMCTLK",7,0)
 D INIT
"RTN","XMCTLK",8,0)
 S XMABORT=0
"RTN","XMCTLK",9,0)
 D HELP(.XMABORT) Q:XMABORT
"RTN","XMCTLK",10,0)
GO K XMG0
"RTN","XMCTLK",11,0)
GO1 K %ZIS
"RTN","XMCTLK",12,0)
 S %ZIS=""
"RTN","XMCTLK",13,0)
 D ^%ZIS Q:POP
"RTN","XMCTLK",14,0)
 I '$D(XMDUZ) Q:'$D(DUZ)  D INIT
"RTN","XMCTLK",15,0)
 I IO=IO(0) D ^%ZISC W !,"YOU MUST CHOOSE ANOTHER DEVICE" Q
"RTN","XMCTLK",16,0)
ENT ;
"RTN","XMCTLK",17,0)
 N XMZ,XMSUB,TN,TL,TP,TK
"RTN","XMCTLK",18,0)
 W @IOF,"<<<< You are now talking through device ",IO," >>>>"
"RTN","XMCTLK",19,0)
 X ^%ZOSF("NBRK"),^("PRIINQ") S XMP=Y,X=Y+3,XME0(0)="S R=0,XME0=$$TSTAMP^XMXUTIL1" S:X>10 X=10
"RTN","XMCTLK",20,0)
 X ^%ZOSF("PRIORITY")
"RTN","XMCTLK",21,0)
 I $$NEWERR^%ZTER N $ETRAP,$ESTACK S $ETRAP=""
"RTN","XMCTLK",22,0)
 S X="ABEND^XMCTLK",@^%ZOSF("TRAP")
"RTN","XMCTLK",23,0)
 W !,"===== Enter <control>A to stop. =====",$C(7),!
"RTN","XMCTLK",24,0)
 S XM="",D="",XMD0=0,A=""
"RTN","XMCTLK",25,0)
 S XMB0=^%ZOSF("EOFF"),XMB0("RM")="S X=0 "_^("RM"),XMC0=^("EON"),XMF0=^("TYPE-AHEAD"),XMA=^("TRMRD") F I="TRMON","TRMOFF","NBRK" S XMG0(I)=^(I)
"RTN","XMCTLK",26,0)
 S TN=$P($H,",",2),TL=TN,(TP,TK)=0 ; Times & Timed reads Port/Keyboard
"RTN","XMCTLK",27,0)
 D T
"RTN","XMCTLK",28,0)
 S D=""
"RTN","XMCTLK",29,0)
 U IO
"RTN","XMCTLK",30,0)
 G G
"RTN","XMCTLK",31,0)
 ;
"RTN","XMCTLK",32,0)
 ;MAIN LOOP / DIALOG OCCURS HERE
"RTN","XMCTLK",33,0)
R ;
"RTN","XMCTLK",34,0)
 W:$D(XMC("TALKMODE")) *17
"RTN","XMCTLK",35,0)
 U IO
"RTN","XMCTLK",36,0)
 R A#150:$S($G(R)>20:1,1:0)
"RTN","XMCTLK",37,0)
 W:$D(XMC("TALKMODE")) *19
"RTN","XMCTLK",38,0)
 S D=D_A
"RTN","XMCTLK",39,0)
 X XMA
"RTN","XMCTLK",40,0)
 S TN=$P($H,",",2)
"RTN","XMCTLK",41,0)
 S:(TN-TL>5) TP=1 ;ihs Time Now TP adjustment
"RTN","XMCTLK",42,0)
 S R=$G(R)+1
"RTN","XMCTLK",43,0)
 I Y>0 D T0 U IO(0) W A,*Y S TP=0,TL=TN X XME0(0) G R
"RTN","XMCTLK",44,0)
 D T0
"RTN","XMCTLK",45,0)
 U IO(0)
"RTN","XMCTLK",46,0)
 W A
"RTN","XMCTLK",47,0)
 I $L(A) S TP=0,TL=TN X XME0(0) D T0 G R
"RTN","XMCTLK",48,0)
S ;
"RTN","XMCTLK",49,0)
 S Y=0
"RTN","XMCTLK",50,0)
 U IO(0)
"RTN","XMCTLK",51,0)
 R A:TK S TK=0 E  U IO W A S:$L(A) TP=0,TL=TN G R:$L(A),Q:$$TSTAMP^XMXUTIL1-XME0>$S($D(DTIME):DTIME,1:300),R ;ihs timer adjustment
"RTN","XMCTLK",52,0)
 X XMA
"RTN","XMCTLK",53,0)
 G Q:Y=1
"RTN","XMCTLK",54,0)
 S:Y=27 TK=1
"RTN","XMCTLK",55,0)
 S TP=0
"RTN","XMCTLK",56,0)
 I Y=13,$D(XMG0("EON")) S TP=0 U IO(0) W ! ;ihs timer adjustment
"RTN","XMCTLK",57,0)
 U IO
"RTN","XMCTLK",58,0)
 W A,*Y
"RTN","XMCTLK",59,0)
 W:$D(XMG0("EON"))&(Y=13) !
"RTN","XMCTLK",60,0)
 S:$L(A) TP=0
"RTN","XMCTLK",61,0)
 X XME0(0)
"RTN","XMCTLK",62,0)
 G R
"RTN","XMCTLK",63,0)
Q ;
"RTN","XMCTLK",64,0)
 U IO(0)
"RTN","XMCTLK",65,0)
 W $C(7)
"RTN","XMCTLK",66,0)
 H 1
"RTN","XMCTLK",67,0)
 W $C(7)
"RTN","XMCTLK",68,0)
 X XMC0,XMF0,XMG0("TRMOFF"),XMG0("NBRK")
"RTN","XMCTLK",69,0)
 K DIR
"RTN","XMCTLK",70,0)
 S DIR("T")=9
"RTN","XMCTLK",71,0)
 S DIR(0)="S^E:END TalkMan session;C:begin CAPTURE TalkMan dialog in message;N:do NOT end TalkMan session.;K:KERMIT Transfer Files"
"RTN","XMCTLK",72,0)
 S DIR("B")="N"
"RTN","XMCTLK",73,0)
 S DIR("??")="XMTALK"
"RTN","XMCTLK",74,0)
 I '$D(XMDUZ) S $P(DIR(0),";",2,3)=$P(DIR(0),";",3) G D
"RTN","XMCTLK",75,0)
 I $D(XMSUB) S $P(DIR(0),";",2)="S:STOP capture"
"RTN","XMCTLK",76,0)
D ;
"RTN","XMCTLK",77,0)
 S XMA0=D
"RTN","XMCTLK",78,0)
 D ^DIR S:$D(DTOUT) X="^" I '$D(X) W " ???? " G D
"RTN","XMCTLK",79,0)
 S D=XMA0
"RTN","XMCTLK",80,0)
 I "N"[X D T S A=" <Continue in TalkMan Mode >" D T0 W !,A,! G G
"RTN","XMCTLK",81,0)
 ;
"RTN","XMCTLK",82,0)
 ;Using Kermit !
"RTN","XMCTLK",83,0)
 I "K"=X D  G G
"RTN","XMCTLK",84,0)
 . N X
"RTN","XMCTLK",85,0)
 . I $G(^DIC(15,0,"VR"))'>7.1 W !," <No Kermit use yet. The correct Kernel tools version is not installed !>",! Q
"RTN","XMCTLK",86,0)
 . D KERM^XTKERMIT,T
"RTN","XMCTLK",87,0)
 . W !," <Continue in TalkMan Mode >",!
"RTN","XMCTLK",88,0)
 . D U
"RTN","XMCTLK",89,0)
 . S D="",Y=1
"RTN","XMCTLK",90,0)
 I "S"=X K XMSUB W ! G G
"RTN","XMCTLK",91,0)
 G DQ:"^E"[$E(X)
"RTN","XMCTLK",92,0)
 I $D(XMZ) W ! S XMSUB=1 G G
"RTN","XMCTLK",93,0)
 S XMD0=0
"RTN","XMCTLK",94,0)
 K %I,%H
"RTN","XMCTLK",95,0)
 S XMSUB=XMDUN_" DIALOG CAPTURE "_$$HTE^XLFDT($H,5)
"RTN","XMCTLK",96,0)
 D GET^XMA2
"RTN","XMCTLK",97,0)
 W !
"RTN","XMCTLK",98,0)
 G G
"RTN","XMCTLK",99,0)
 ;
"RTN","XMCTLK",100,0)
G ;RETURN TO TALKMAN MODE
"RTN","XMCTLK",101,0)
 U IO
"RTN","XMCTLK",102,0)
 X XMB0("RM"),XMB0,XMF0,XMG0("NBRK"),XMG0("TRMON")
"RTN","XMCTLK",103,0)
 X:$D(XMG0("EON")) XMC0
"RTN","XMCTLK",104,0)
 D T
"RTN","XMCTLK",105,0)
 X XME0(0)
"RTN","XMCTLK",106,0)
 G R
"RTN","XMCTLK",107,0)
 ;
"RTN","XMCTLK",108,0)
ABEND ;Handle abnormal end
"RTN","XMCTLK",109,0)
 D ^%ZISC
"RTN","XMCTLK",110,0)
 U IO(0)
"RTN","XMCTLK",111,0)
 W $C(7)
"RTN","XMCTLK",112,0)
 H 1
"RTN","XMCTLK",113,0)
 W $C(7)
"RTN","XMCTLK",114,0)
 X XMC0,XMF0,XMG0("TRMOFF"),XMG0("NBRK")
"RTN","XMCTLK",115,0)
 G DQ
"RTN","XMCTLK",116,0)
 ;
"RTN","XMCTLK",117,0)
 ;END TALKMAN SESSION
"RTN","XMCTLK",118,0)
DQ ;
"RTN","XMCTLK",119,0)
 W $C(7),!!,"End of Talkman session."
"RTN","XMCTLK",120,0)
 W !,"You are back at your starting place.",!
"RTN","XMCTLK",121,0)
 H 1
"RTN","XMCTLK",122,0)
 W $C(7)
"RTN","XMCTLK",123,0)
 W !!
"RTN","XMCTLK",124,0)
 U IO
"RTN","XMCTLK",125,0)
 W *17
"RTN","XMCTLK",126,0)
 X XMG0("TRMOFF")
"RTN","XMCTLK",127,0)
 D ^%ZISC,HOME^%ZIS
"RTN","XMCTLK",128,0)
 D N
"RTN","XMCTLK",129,0)
 G QQ:'$D(XMZ),QQ:'XMZ
"RTN","XMCTLK",130,0)
 I 'XMD0 D KILLMSG^XMXUTIL(XMZ) G QQ
"RTN","XMCTLK",131,0)
 I $P(XMD0,U,2,999)'="" S XMSUB=1,Y=999,D=$P(XMD0,U,2,999) D T0
"RTN","XMCTLK",132,0)
 S XMD0=+XMD0
"RTN","XMCTLK",133,0)
 I XMD0 D NOW^%DTC D  K %I,%H G QQ
"RTN","XMCTLK",134,0)
 . S ^XMB(3.9,XMZ,2,0)="^3.92A^"_XMD0_U_XMD0_U_%
"RTN","XMCTLK",135,0)
 . K XMY,^TMP("XMY",$J),^TMP("XMY0",$J)
"RTN","XMCTLK",136,0)
 . S XMY($G(XMDUZ,DUZ))=""
"RTN","XMCTLK",137,0)
 . D ENT1^XMD W !,"TalkMan dialog capture being delivered now."
"RTN","XMCTLK",138,0)
 D KILLMSG^XMXUTIL(XMZ)
"RTN","XMCTLK",139,0)
QQ ;
"RTN","XMCTLK",140,0)
 W !
"RTN","XMCTLK",141,0)
 D CHK^XM
"RTN","XMCTLK",142,0)
 W !
"RTN","XMCTLK",143,0)
 S X=XMP
"RTN","XMCTLK",144,0)
 X ^%ZOSF("PRIORITY")
"RTN","XMCTLK",145,0)
 K %,X1,X2,XMA0,XMB0,XMC0,XMD0,XME0,XMF0,XMG0,XMA,XMP,XMSUB,DIR
"RTN","XMCTLK",146,0)
 S XMZ=0
"RTN","XMCTLK",147,0)
 Q
"RTN","XMCTLK",148,0)
N ;
"RTN","XMCTLK",149,0)
 U IO(0)
"RTN","XMCTLK",150,0)
 X XMC0
"RTN","XMCTLK",151,0)
 I $D(DUZ) S X=$G(^VA(200,DUZ,200)) Q:X#10'=1  Q:$P(^(200),U,9)="Y"
"RTN","XMCTLK",152,0)
 S A="NO-TYPE-AHEAD" Q:'$D(^%ZOSF(A))  X ^(A)
"RTN","XMCTLK",153,0)
 Q
"RTN","XMCTLK",154,0)
T ;
"RTN","XMCTLK",155,0)
 U IO(0)
"RTN","XMCTLK",156,0)
 S X=0
"RTN","XMCTLK",157,0)
 X ^%ZOSF("RM"),XMF0,XMB0,XMG0("TRMON"),XMG0("NBRK")
"RTN","XMCTLK",158,0)
 I $D(XMG0("EON")) X XMC0
"RTN","XMCTLK",159,0)
 Q
"RTN","XMCTLK",160,0)
T0 ;
"RTN","XMCTLK",161,0)
 I '$D(XMSUB)!(D=""&(Y'=9)) S D="" Q
"RTN","XMCTLK",162,0)
 I D'?.ANP F I=1:1 I $E(D,I)?1C S D=$E(D,1,I-1)_$S($A(D,I)=9:"",1:" ")_$E(D,I+1,999) Q:$E(D,I,999)?.ANP  S I=I-1
"RTN","XMCTLK",163,0)
T1 ;
"RTN","XMCTLK",164,0)
 I Y'=13&($L(D)<81)!(Y>0&(D="")) S XMD0=+XMD0_U_D Q:Y'=9  S D=$E(D_"         ",1,$L(D)\9+1*9),$P(XMD0,U,2)=D Q
"RTN","XMCTLK",165,0)
 I D="" S D=" "
"RTN","XMCTLK",166,0)
 S XMD0=XMD0+1,^XMB(3.9,XMZ,2,XMD0,0)=$E(D,1,80),D=$E(D,81,999)
"RTN","XMCTLK",167,0)
 G T1
"RTN","XMCTLK",168,0)
U ;
"RTN","XMCTLK",169,0)
 S XME0=$$TSTAMP^XMXUTIL1
"RTN","XMCTLK",170,0)
 Q
"RTN","XMCTLK",171,0)
 ;
"RTN","XMCTLK",172,0)
 ;GET INITIAL VALUES
"RTN","XMCTLK",173,0)
ECHO ;ENTRY TO ECHO
"RTN","XMCTLK",174,0)
 K XMG0
"RTN","XMCTLK",175,0)
 S XMG0("EON")=1
"RTN","XMCTLK",176,0)
 G GO1
"RTN","XMCTLK",177,0)
INIT ;
"RTN","XMCTLK",178,0)
 D INIT^XMVVITAE
"RTN","XMCTLK",179,0)
 K XMA0,XMB0,XMC0,XMD0,XME0,XMF0
"RTN","XMCTLK",180,0)
 G H^XUS:'$D(XMDUZ),H^XUS:'$D(XMDUN) K XMZ
"RTN","XMCTLK",181,0)
 Q
"RTN","XMCTLK",182,0)
HELP(XMABORT) ;
"RTN","XMCTLK",183,0)
 N DIR,X,Y
"RTN","XMCTLK",184,0)
 S DIR(0)="Y"
"RTN","XMCTLK",185,0)
 S DIR("A")="Do you want help"
"RTN","XMCTLK",186,0)
 S DIR("B")="NO"
"RTN","XMCTLK",187,0)
 D ^DIR I $D(DIRUT) S XMABORT=1 Q
"RTN","XMCTLK",188,0)
 Q:'Y
"RTN","XMCTLK",189,0)
 S XQH=$S($G(DUZ(0))="@":"XMTALK",$D(^XUSEC("XMMGR",DUZ)):"XMTALK",1:"XMTALK-USER")
"RTN","XMCTLK",190,0)
 D EN^XQH
"RTN","XMCTLK",191,0)
 Q
"RTN","XMCTLK",192,0)
TALK ; Talk mode entry
"RTN","XMCTLK",193,0)
 I '$D(DUZ) W !,$C(7),"You don't have a DUZ." Q
"RTN","XMCTLK",194,0)
 N XMC,XMDUZ,XMV,XMOKTYPE,XMINST,XMSITE,XMIO,XMB,XMABORT
"RTN","XMCTLK",195,0)
 N XMLER,XMLINE,XMCNT,DIC,XMA0,XMB0,XMC0,XMD0,XME0,XMF0,XMG0
"RTN","XMCTLK",196,0)
 D INIT^XMVVITAE
"RTN","XMCTLK",197,0)
 S XMC("TALKMODE")=1,XMABORT=0
"RTN","XMCTLK",198,0)
 D HELP(.XMABORT) Q:XMABORT
"RTN","XMCTLK",199,0)
 ;Ask Domain / get defaults
"RTN","XMCTLK",200,0)
 ;S (XMOKTYPE("SMTP"),XMOKTYPE("TELNET"))=""
"RTN","XMCTLK",201,0)
 S XMOKTYPE("TELNET")=""
"RTN","XMCTLK",202,0)
 D ASK^XMCXU(.XMINST,.XMSITE,.XMB,.XMABORT,"I $P(^(0),U,2)[""T""",.XMOKTYPE) Q:XMABORT
"RTN","XMCTLK",203,0)
 S XMIO=$P(XMB("SCR REC"),U,5)
"RTN","XMCTLK",204,0)
 S XM=""
"RTN","XMCTLK",205,0)
 W !,"Attempting to connect...."
"RTN","XMCTLK",206,0)
 S XMDUZO=XMDUZ
"RTN","XMCTLK",207,0)
 D ENT^XMC1
"RTN","XMCTLK",208,0)
 S XMDUZ=XMDUZO K XMDUZO
"RTN","XMCTLK",209,0)
 I ER D  Q
"RTN","XMCTLK",210,0)
 . D ^%ZISC
"RTN","XMCTLK",211,0)
 . W !,$C(7),"Could not connect to ",XMSITE,"."
"RTN","XMCTLK",212,0)
 . W !,"You are back at ",^XMB("NETNAME"),"."
"RTN","XMCTLK",213,0)
 . D KILL^XMC
"RTN","XMCTLK",214,0)
 U IO(0)
"RTN","XMCTLK",215,0)
 D ENT
"RTN","XMCTLK",216,0)
 D KILL^XMC
"RTN","XMCTLK",217,0)
 Q
"RTN","XMCTLK0")
1^22
"RTN","XMCTRAP")
0^23^B267755
"RTN","XMCTRAP",1,0)
XMCTRAP ;(WASH ISC)/THM/CAP-Error Trap ;04/17/2002  08:14
"RTN","XMCTRAP",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMCTRAP",3,0)
 ;Modified for TCP/IP under INET_SERVERS of Wollongong
"RTN","XMCTRAP",4,0)
 ;
"RTN","XMCTRAP",5,0)
C ;set in XMC1
"RTN","XMCTRAP",6,0)
 N XMCTRAP S XMCTRAP=1
"RTN","XMCTRAP",7,0)
R ;set in XMRUCX
"RTN","XMCTRAP",8,0)
TRP N %,%E,X S (%,X)=""
"RTN","XMCTRAP",9,0)
 S %E=$$EC^%ZOSV()
"RTN","XMCTRAP",10,0)
 I '$$SCREEN^%ZTER(%E) D ^%ZTER
"RTN","XMCTRAP",11,0)
 ;Error Trap for Script processing (remove back-up tasks)...
"RTN","XMCTRAP",12,0)
 I $G(ZTQUEUED),$G(XMCTRAP) D ERRTRAP^XMTDR
"RTN","XMCTRAP",13,0)
 ;I $D(XMHANG),$L(XMHANG) X XMHANG
"RTN","XMCTRAP",14,0)
 ;D:IO'=IO(0) ^%ZISC
"RTN","XMCTRAP",15,0)
 S ER=1 G UNWIND^%ZTER
"RTN","XMCU1")
0^264^B1480805
"RTN","XMCU1",1,0)
XMCU1 ;(WASH ISC)/CMW-Encode/Decode String APIs ;04/17/2002  08:30
"RTN","XMCU1",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMCU1",3,0)
 ; Entry points (DBIA 1136):
"RTN","XMCU1",4,0)
 ; $$ENCODEUP - Convert all "^" to "~U~"
"RTN","XMCU1",5,0)
 ; $$DECODEUP - Convert all "~U~" to "^"
"RTN","XMCU1",6,0)
 ; $$STRAN    - Convert all control characters to printable ones
"RTN","XMCU1",7,0)
 ; $$RTRAN    - Undo the conversion done by $$STRAN
"RTN","XMCU1",8,0)
 ;
"RTN","XMCU1",9,0)
RTRAN(XXX) ; Extrinsic Function to decode control characters
"RTN","XMCU1",10,0)
 ;Input=STRING
"RTN","XMCU1",11,0)
 ;Output=STRING
"RTN","XMCU1",12,0)
 N XMESC,X,Y,X1,I
"RTN","XMCU1",13,0)
 S XMESC="~"
"RTN","XMCU1",14,0)
 Q:XXX'[XMESC
"RTN","XMCU1",15,0)
 S Y="",X1=XXX
"RTN","XMCU1",16,0)
R1 S I=$F(X1,XMESC) I I=0 S X=Y_X1 G SET
"RTN","XMCU1",17,0)
 S Y=Y_$E(X1,1,I-2)_$C($A($E(X1,I))-64#128),X1=$E(X1,I+1,999) G R1
"RTN","XMCU1",18,0)
SET Q X
"RTN","XMCU1",19,0)
STRAN(XXX) ; Extrinsic Function to encode control characters
"RTN","XMCU1",20,0)
 ;Input=STRING
"RTN","XMCU1",21,0)
 ;Output=STRING
"RTN","XMCU1",22,0)
 N XMESC,Y,X1,I
"RTN","XMCU1",23,0)
 S XMESC="~"
"RTN","XMCU1",24,0)
 S Y="" F I=1:1:$L(XXX) S X1=$E(XXX,I) S Y=Y_$S(X1=XMESC:XMESC_$C(62),X1?1C:XMESC_$C($A(X1)+64#128),1:X1)
"RTN","XMCU1",25,0)
 Q Y
"RTN","XMCU1",26,0)
ENCODEUP(XXX) ; Extrinsic Function to encode "^" into "~U~"
"RTN","XMCU1",27,0)
 ; Input=STRING
"RTN","XMCU1",28,0)
 ; Output=STRING
"RTN","XMCU1",29,0)
 F  Q:XXX'[U  S XXX=$P(XXX,U)_"~U~"_$P(XXX,U,2,999)
"RTN","XMCU1",30,0)
 Q XXX
"RTN","XMCU1",31,0)
DECODEUP(XXX) ; Extrinsic Function to decode "~U~" to "^"
"RTN","XMCU1",32,0)
 ; Input=STRING
"RTN","XMCU1",33,0)
 ; Output=STRING
"RTN","XMCU1",34,0)
 F  Q:XXX'["~U~"  S XXX=$P(XXX,"~U~")_"^"_$P(XXX,"~U~",2,999)
"RTN","XMCU1",35,0)
 Q XXX
"RTN","XMCX")
0^24^B17138675
"RTN","XMCX",1,0)
XMCX ;ISC-SF/GMB-Play a Script / Queue Transmit Task ;07/11/2002  14:11
"RTN","XMCX",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMCX",3,0)
 ; Was (WASH ISC)/THM
"RTN","XMCX",4,0)
 ;
"RTN","XMCX",5,0)
 ; Entry points used by MailMan options (not covered by DBIA):
"RTN","XMCX",6,0)
 ; PLAY    XMSCRIPTPLAY     (was GO^XMC11)
"RTN","XMCX",7,0)
 ; Q1      XMSTARTQUE       (was Q^XMC2)
"RTN","XMCX",8,0)
 ; QALL    XMSTARTQUE-ALL   (was REQUE^XMS5)
"RTN","XMCX",9,0)
 Q
"RTN","XMCX",10,0)
PLAY ; Play a script
"RTN","XMCX",11,0)
 N XM,XMB,XMC,XMINST,XMSITE,XMIO,XMHOST,XMABORT
"RTN","XMCX",12,0)
 K XMTLER
"RTN","XMCX",13,0)
 S XM="D",XMABORT=0
"RTN","XMCX",14,0)
 D ASKINST^XMCXU(.XMINST,.XMSITE,.XMABORT) Q:XMABORT
"RTN","XMCX",15,0)
 D CHKTSK^XMCXU(XMINST,2,.XMABORT) Q:XMABORT
"RTN","XMCX",16,0)
 D ASKSCR^XMCXU(XMINST,XMSITE,.XMB,.XMABORT) Q:XMABORT
"RTN","XMCX",17,0)
 S XMIO=$P(XMB("SCR REC"),U,5)
"RTN","XMCX",18,0)
AGAIN ;
"RTN","XMCX",19,0)
 D ENT^XMC1
"RTN","XMCX",20,0)
 I ER=25!($G(XMHOST)="NO-IP") D  G:'XMABORT AGAIN
"RTN","XMCX",21,0)
 . N XMTEXT,XMIPSAVE
"RTN","XMCX",22,0)
 . I '$$USEDNS^XMKPR1 D  Q
"RTN","XMCX",23,0)
 . . S XMABORT=1
"RTN","XMCX",24,0)
 . . ;DNS is not activated at this site, so you'll have to figure
"RTN","XMCX",25,0)
 . . ;out the correct IP address yourself.
"RTN","XMCX",26,0)
 . . D BLD^DIALOG(42263,"","","XMTEXT","F")
"RTN","XMCX",27,0)
 . . D MSG^DIALOG("WM","","","","XMTEXT")
"RTN","XMCX",28,0)
 . ;Let's see what we can do...
"RTN","XMCX",29,0)
 . ;We've tried these: |1|
"RTN","XMCX",30,0)
 . D BLD^DIALOG(42264,XMB("IP TRIED"),"","XMTEXT","F")
"RTN","XMCX",31,0)
 . D MSG^DIALOG("WM","","","","XMTEXT")
"RTN","XMCX",32,0)
 . S XMB("TRIES")=XMB("TRIES")+1
"RTN","XMCX",33,0)
 . S XMIPSAVE=XMB("IP TRIED"),XMC("PLAY")=1
"RTN","XMCX",34,0)
 . D NEXTIP^XMKPR1(XMSITE,.XMB) K XMC("PLAY")
"RTN","XMCX",35,0)
 . I XMIPSAVE=XMB("IP TRIED") D  Q
"RTN","XMCX",36,0)
 . . S XMABORT=1
"RTN","XMCX",37,0)
 . . ;The DNS did not return any other addresses to try.  Sorry!
"RTN","XMCX",38,0)
 . . D BLD^DIALOG(42265,"","","XMTEXT","F")
"RTN","XMCX",39,0)
 . . D MSG^DIALOG("WM","","","","XMTEXT")
"RTN","XMCX",40,0)
 . W !,$$EZBLD^DIALOG(42266,$P(XMB("SCR REC"),U,6)) ;Now, let's try: |1|
"RTN","XMCX",41,0)
 . K ER,XMER
"RTN","XMCX",42,0)
 I 'XMABORT,'ER S XMC("PLAY")=1 D CHKSETIP^XMTDR(XMINST,XMSITE,.XMB)
"RTN","XMCX",43,0)
 D KL^XMC
"RTN","XMCX",44,0)
 Q
"RTN","XMCX",45,0)
Q1 ; Trigger a queue for transmission
"RTN","XMCX",46,0)
 N XMB,XMINST,XMSITE,XMTSK,XMABORT
"RTN","XMCX",47,0)
 S XMABORT=0 ; pick a queue w/msgs
"RTN","XMCX",48,0)
 D ASKINST^XMCXU(.XMINST,.XMSITE,.XMABORT,"M") Q:XMABORT
"RTN","XMCX",49,0)
 D CHKTSK^XMCXU(XMINST,1,.XMABORT) Q:XMABORT
"RTN","XMCX",50,0)
 D ASKSCR^XMCXU(XMINST,XMSITE,.XMB,.XMABORT) Q:XMABORT
"RTN","XMCX",51,0)
 D QUEUE(XMINST,XMSITE,.XMB)
"RTN","XMCX",52,0)
 Q
"RTN","XMCX",53,0)
TASK ;
"RTN","XMCX",54,0)
QALL ;
"RTN","XMCX",55,0)
 N XMDUZ,XMK,XMIEN,XMSITE
"RTN","XMCX",56,0)
 S:$D(ZTQUEUED) ZTREQ="@"
"RTN","XMCX",57,0)
 D RESEQ^XMCQA
"RTN","XMCX",58,0)
 K ^TMP("XM",$J)
"RTN","XMCX",59,0)
 S XMK=1000
"RTN","XMCX",60,0)
 F  S XMK=$O(^XMB(3.7,.5,2,XMK)) Q:'XMK  Q:XMK>9999  D
"RTN","XMCX",61,0)
 . Q:'$$BMSGCT^XMXUTIL(.5,XMK)
"RTN","XMCX",62,0)
 . W:'$D(ZTQUEUED) "."
"RTN","XMCX",63,0)
 . S XMIEN=XMK-1000
"RTN","XMCX",64,0)
 . S:'$$TSKEXIST^XMKPR(XMIEN) ^TMP("XM",$J,$P(^DIC(4.2,XMIEN,0),U))=XMIEN
"RTN","XMCX",65,0)
 I '$D(^TMP("XM",$J)) D  Q
"RTN","XMCX",66,0)
 . W:'$D(ZTQUEUED) !!,$$EZBLD^DIALOG(42125) ; All queues with messages have tasks.
"RTN","XMCX",67,0)
 I '$D(ZTQUEUED) D  Q:'$D(^TMP("XM",$J))
"RTN","XMCX",68,0)
 . W:$G(IOST)["C-" @IOF
"RTN","XMCX",69,0)
 . W !,$$EZBLD^DIALOG(42126),! ; These queues with messages have no tasks:
"RTN","XMCX",70,0)
 . S XMSITE=""
"RTN","XMCX",71,0)
 . F  S XMSITE=$O(^TMP("XM",$J,XMSITE)) Q:XMSITE=""  D
"RTN","XMCX",72,0)
 . . I $Y+3>IOSL D WAIT^XMXUTIL
"RTN","XMCX",73,0)
 . . S XMIEN=^TMP("XM",$J,XMSITE)
"RTN","XMCX",74,0)
 . . W !,$E(XMSITE,1,37)
"RTN","XMCX",75,0)
 . . Q:$P(^DIC(4.2,XMIEN,0),U,2)["S"
"RTN","XMCX",76,0)
 . . W ?40,$$EZBLD^DIALOG(42127) ; No Send Flag - Will not task
"RTN","XMCX",77,0)
 . . K ^TMP("XM",$J,XMSITE)
"RTN","XMCX",78,0)
 . Q:'$D(^TMP("XM",$J))
"RTN","XMCX",79,0)
 . N DIR
"RTN","XMCX",80,0)
 . S DIR(0)="YO"
"RTN","XMCX",81,0)
 . S DIR("A")=$$EZBLD^DIALOG(42128) ; Requeue the missing tasks
"RTN","XMCX",82,0)
 . S DIR("B")=$$EZBLD^DIALOG(39053) ; No
"RTN","XMCX",83,0)
 . D BLD^DIALOG(42129,"","","DIR(""?"")") ; Answer YES to create tasks to transmit these queues.
"RTN","XMCX",84,0)
 . D ^DIR Q:Y
"RTN","XMCX",85,0)
 . W !!,$$EZBLD^DIALOG(42130) ; Tasks not requeued.
"RTN","XMCX",86,0)
 . K ^TMP("XM",$J)
"RTN","XMCX",87,0)
 S XMSITE=""
"RTN","XMCX",88,0)
 F  S XMSITE=$O(^TMP("XM",$J,XMSITE)) Q:XMSITE=""  D
"RTN","XMCX",89,0)
 . S XMIEN=^TMP("XM",$J,XMSITE)
"RTN","XMCX",90,0)
 . I $$UP^XLFSTR($P(^DIC(4.2,XMIEN,0),U,2))'["S" D  Q
"RTN","XMCX",91,0)
 . . W:'$D(ZTQUEUED) !,$E(XMSITE,1,37),?40,$$EZBLD^DIALOG(42127) ; No Send Flag - Will not task
"RTN","XMCX",92,0)
 . D QUEUE(XMIEN,XMSITE)
"RTN","XMCX",93,0)
 W:'$D(ZTQUEUED) !,$$EZBLD^DIALOG(42132) ; Finished.
"RTN","XMCX",94,0)
 K ^TMP("XM",$J)
"RTN","XMCX",95,0)
 Q
"RTN","XMCX",96,0)
QUEUE(XMINST,XMSITE,XMB,XMWHEN,XMTSK) ;
"RTN","XMCX",97,0)
 D QUEUE^XMKPR(XMINST,XMSITE,.XMB,.XMWHEN,.XMTSK) Q:$D(ZTQUEUED)
"RTN","XMCX",98,0)
 ; Task |1| queued / Task creation failed
"RTN","XMCX",99,0)
 W !,$E(XMSITE,1,37),?40,$$EZBLD^DIALOG($S($D(XMTSK):42131,1:39311),$G(XMTSK))
"RTN","XMCX",100,0)
 Q
"RTN","XMCXT")
0^25^B6029680
"RTN","XMCXT",1,0)
XMCXT ;ISC-SF/GMB-View Transcripts ;04/17/2002  08:34
"RTN","XMCXT",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMCXT",3,0)
 ; Was (WASH ISC)/THM
"RTN","XMCXT",4,0)
 ;
"RTN","XMCXT",5,0)
 ; Entry points used by MailMan options (not covered by DBIA):
"RTN","XMCXT",6,0)
 ; LIST    XMLIST     (was LST^XMC2)
"RTN","XMCXT",7,0)
 Q
"RTN","XMCXT",8,0)
GET(XMFORCE) ; SEND & RECEIVE: Get # to store script in ^UTILITY/^%ZOSF(NODES)
"RTN","XMCXT",9,0)
 I $G(XMFORCE),'$G(XMC("AUDIT")) K XMC("AUDIT")
"RTN","XMCXT",10,0)
 Q:$D(XMC("AUDIT"))
"RTN","XMCXT",11,0)
 I '$P($G(^XMB(1,1,0)),U,14),'$G(XMFORCE) S XMC("AUDIT")=0 Q
"RTN","XMCXT",12,0)
 N X
"RTN","XMCXT",13,0)
 L +^TMP("XMC",0)
"RTN","XMCXT",14,0)
 S X=+$G(^TMP("XMC",0))+1#100
"RTN","XMCXT",15,0)
 S:X=0 X=1
"RTN","XMCXT",16,0)
 S (XMC("AUDIT"),^TMP("XMC",0))=X
"RTN","XMCXT",17,0)
 L -^TMP("XMC",0)
"RTN","XMCXT",18,0)
 K ^TMP("XMC",XMC("AUDIT"))
"RTN","XMCXT",19,0)
 Q
"RTN","XMCXT",20,0)
LIST ; List transmission transcripts
"RTN","XMCXT",21,0)
 N XMTEXT
"RTN","XMCXT",22,0)
 ;Transcript recording is controlled by field 8.3 in file 4.3.
"RTN","XMCXT",23,0)
 D BLD^DIALOG(42170,"","","XMTEXT","F")
"RTN","XMCXT",24,0)
 D MSG^DIALOG("WM","","","","XMTEXT")
"RTN","XMCXT",25,0)
 I '$O(^TMP("XMC","")) W !!,$C(7),$$EZBLD^DIALOG(42171) Q  ;No transcripts on file.
"RTN","XMCXT",26,0)
 N XMTID,XMABORT
"RTN","XMCXT",27,0)
 S XMABORT=0
"RTN","XMCXT",28,0)
 W !,$$EZBLD^DIALOG(42172),! ;10 lines of transcript will be displayed at a time.
"RTN","XMCXT",29,0)
 S XMTID=0
"RTN","XMCXT",30,0)
 F  S XMTID=$O(^TMP("XMC",XMTID)) Q:XMTID=""  D  Q:XMABORT
"RTN","XMCXT",31,0)
 . D SHOWTRAN(XMTID)
"RTN","XMCXT",32,0)
 . I '$O(^TMP("XMC",XMTID)) D  Q
"RTN","XMCXT",33,0)
 . . S XMABORT=1
"RTN","XMCXT",34,0)
 . . W !!,$C(7),$$EZBLD^DIALOG(42171.1) ;No more transcripts on file.
"RTN","XMCXT",35,0)
 . N DIR,X,Y
"RTN","XMCXT",36,0)
 . S DIR(0)="Y"
"RTN","XMCXT",37,0)
 . S DIR("A")=$$EZBLD^DIALOG(42173) ;Continue to the next transcript
"RTN","XMCXT",38,0)
 . S DIR("B")=$$EZBLD^DIALOG(39053) ;NO
"RTN","XMCXT",39,0)
 . D ^DIR I 'Y S XMABORT=1
"RTN","XMCXT",40,0)
 Q
"RTN","XMCXT",41,0)
SHOWTRAN(XMTID) ;
"RTN","XMCXT",42,0)
 N XMCNT,XMI,XMTREC,XMABORT
"RTN","XMCXT",43,0)
 S (XMCNT,XMI,XMABORT)=0
"RTN","XMCXT",44,0)
 F  S XMI=$O(^TMP("XMC",XMTID,XMI)) Q:'XMI  S XMTREC=^(XMI,0) D  Q:XMABORT
"RTN","XMCXT",45,0)
 . I XMCNT#10=0 D PAGE^XMXUTIL(.XMABORT) Q:XMABORT
"RTN","XMCXT",46,0)
 . S XMCNT=XMCNT+1
"RTN","XMCXT",47,0)
 . W !,XMTREC
"RTN","XMCXT",48,0)
 N DIR,X,Y
"RTN","XMCXT",49,0)
 S DIR(0)="Y"
"RTN","XMCXT",50,0)
 S DIR("A")=$$EZBLD^DIALOG(42174) ;Delete this transcript
"RTN","XMCXT",51,0)
 S DIR("B")=$$EZBLD^DIALOG(39053) ;NO
"RTN","XMCXT",52,0)
 D ^DIR I 'Y W !,$$EZBLD^DIALOG(42175) Q  ;Retained.
"RTN","XMCXT",53,0)
 K ^TMP("XMC",XMTID)
"RTN","XMCXT",54,0)
 W !,$$EZBLD^DIALOG(42176) ;Deleted.
"RTN","XMCXT",55,0)
 Q
"RTN","XMCXT",56,0)
 ; The following is not used
"RTN","XMCXT",57,0)
LISTCURR ;
"RTN","XMCXT",58,0)
 N XMI
"RTN","XMCXT",59,0)
 W !!,$$EZBLD^DIALOG(42177) ;The current transcript is:
"RTN","XMCXT",60,0)
 S XMI=0
"RTN","XMCXT",61,0)
 F  S XMI=$O(^TMP("XMC",XMC("AUDIT"),XMI)) Q:'XMI  W !,^(XMI,0)
"RTN","XMCXT",62,0)
 Q
"RTN","XMCXU")
0^26^B12784505
"RTN","XMCXU",1,0)
XMCXU ;ISC-SF/GMB- Select Domains/Scripts ;04/17/2002  08:43
"RTN","XMCXU",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMCXU",3,0)
ASK(XMINST,XMSITE,XMB,XMABORT,XMSCREEN,XMOKTYPE) ;
"RTN","XMCXU",4,0)
 D ASKINST(.XMINST,.XMSITE,.XMABORT,.XMSCREEN) Q:XMABORT
"RTN","XMCXU",5,0)
 D ASKSCR(XMINST,XMSITE,.XMB,.XMABORT,.XMOKTYPE)
"RTN","XMCXU",6,0)
 Q
"RTN","XMCXU",7,0)
ASKINST(XMINST,XMSITE,XMABORT,XMSCREEN) ; Lookup domain, perhaps using screen
"RTN","XMCXU",8,0)
 N DIC,X,Y,D,XMCX,XMCXC,XMCXM
"RTN","XMCXU",9,0)
 S XMCXM=$$EZBLD^DIALOG(34007.2) ; msgs
"RTN","XMCXU",10,0)
 S XMCXC=$$EZBLD^DIALOG(42281)   ;* Closed *
"RTN","XMCXU",11,0)
 S DIC=4.2,DIC(0)="AEQM",D="B^C"
"RTN","XMCXU",12,0)
 S DIC("W")="S XMCX=($P(^(0),U,2)[""C"") W ?50,$J($$BMSGCT^XMXUTIL(.5,Y+1000),6),XMCXM W:XMCX ?65,XMCXC"
"RTN","XMCXU",13,0)
 I $G(XMSCREEN)'="" D
"RTN","XMCXU",14,0)
 . I $L(XMSCREEN)>1 S DIC("S")=XMSCREEN
"RTN","XMCXU",15,0)
 . I XMSCREEN="M" D
"RTN","XMCXU",16,0)
 . . N XMTEXT
"RTN","XMCXU",17,0)
 . . W !
"RTN","XMCXU",18,0)
 . . ;This option lets you select only those queues which have messages.
"RTN","XMCXU",19,0)
 . . ;If you can't select a queue, it either doesn't exist or it has no messages.
"RTN","XMCXU",20,0)
 . . D BLD^DIALOG(42282,"","","XMTEXT","F")
"RTN","XMCXU",21,0)
 . . D MSG^DIALOG("WM","","","","XMTEXT")
"RTN","XMCXU",22,0)
 . . W !
"RTN","XMCXU",23,0)
 . . S DIC("S")="I $O(^XMB(3.7,.5,2,Y+1000,1,0))"
"RTN","XMCXU",24,0)
 . . ;Select queue.  Only queues with messages are shown.
"RTN","XMCXU",25,0)
 . . D BLD^DIALOG(42283,"","","DIC(""?"")")
"RTN","XMCXU",26,0)
 D MIX^DIC1 I Y=-1 S XMABORT=1 Q
"RTN","XMCXU",27,0)
 S XMINST=+Y
"RTN","XMCXU",28,0)
 S XMSITE=$P(Y,U,2)
"RTN","XMCXU",29,0)
 Q
"RTN","XMCXU",30,0)
ASKSCR(XMINST,XMSITE,XMB,XMABORT,XMOKTYPE) ;
"RTN","XMCXU",31,0)
 D SCRIPT^XMKPR1(XMINST,XMSITE,.XMB,.XMOKTYPE)
"RTN","XMCXU",32,0)
 I 'XMB("SCR IEN") W !,$$EZBLD^DIALOG(42284) S XMABORT=1 Q  ;No valid script for this domain!
"RTN","XMCXU",33,0)
 D SCRIPT(XMINST,XMSITE,.XMB,.XMABORT) Q:XMABORT
"RTN","XMCXU",34,0)
 Q
"RTN","XMCXU",35,0)
SCRIPT(XMINST,XMSITE,XMB,XMABORT) ; Ask user to select the script.
"RTN","XMCXU",36,0)
 ; List valid entries.
"RTN","XMCXU",37,0)
 N I,XMREC,XMTEXT
"RTN","XMCXU",38,0)
 W !
"RTN","XMCXU",39,0)
 ;  #  Script Name       Type       Priority
"RTN","XMCXU",40,0)
 ; --  -----------       ----       --------
"RTN","XMCXU",41,0)
 D BLD^DIALOG(42285,"","","XMTEXT","F")
"RTN","XMCXU",42,0)
 D MSG^DIALOG("WM","","","","XMTEXT")
"RTN","XMCXU",43,0)
 S I=0
"RTN","XMCXU",44,0)
 F  S I=$O(^DIC(4.2,XMINST,1,I)) Q:'I  S XMREC=^(I,0) W !,$J(I,3),?5,$P(XMREC,U),?30,$P(XMREC,U,4),?40,$J($P(XMREC,U,2),2) I $P(XMREC,U,7) W ?50,$$EZBLD^DIALOG(42286) ;* Out of Service *
"RTN","XMCXU",45,0)
 W !
"RTN","XMCXU",46,0)
 I $O(^DIC(4.2,XMINST,1,0))=XMB("SCR IEN"),+$O(^(XMB("SCR IEN")))=0 Q
"RTN","XMCXU",47,0)
 N DIC,X,Y
"RTN","XMCXU",48,0)
 S DIC="^DIC(4.2,XMINST,1,"
"RTN","XMCXU",49,0)
 S DIC(0)="AEQMNZ"
"RTN","XMCXU",50,0)
 S DIC("A")=$$EZBLD^DIALOG(42287) ;Select Script:
"RTN","XMCXU",51,0)
 S DIC("B")=XMB("SCR IEN")
"RTN","XMCXU",52,0)
 S DIC("W")="W ?30,$P(^(0),U,4),?40,$J($P(^(0),U,2),2) W:$P(^(0),U,7) ?60,$$EZBLD^DIALOG(42286)" ;* Out of Service *
"RTN","XMCXU",53,0)
 D ^DIC I Y=-1 S XMABORT=1 Q
"RTN","XMCXU",54,0)
 Q:+Y=XMB("SCR IEN")
"RTN","XMCXU",55,0)
 S (XMB("SCR IEN"),XMB("FIRST SCRIPT"))=+Y
"RTN","XMCXU",56,0)
 D INITSCR^XMKPR1(XMINST,XMSITE,.XMB)
"RTN","XMCXU",57,0)
 Q
"RTN","XMCXU",58,0)
CHKTSK(XMINST,XMCHOOSE,XMABORT) ;
"RTN","XMCXU",59,0)
 N XMTSK,XMTEXT,XMPARM
"RTN","XMCXU",60,0)
 S XMTSK=$$TSKEXIST^XMKPR(XMINST) Q:'XMTSK
"RTN","XMCXU",61,0)
 I +XMTSK=XMTSK D  Q
"RTN","XMCXU",62,0)
 . W !,$C(7) ;Task |1| is transmitting this domain's messages now.
"RTN","XMCXU",63,0)
 . D BLD^DIALOG(42288,XMTSK,"","XMTEXT","F")
"RTN","XMCXU",64,0)
 . D MSG^DIALOG("WM","","","","XMTEXT")
"RTN","XMCXU",65,0)
 . S XMABORT=1
"RTN","XMCXU",66,0)
 W !,$C(7) ;Task |1| is scheduled to transmit this domain's messages
"RTN","XMCXU",67,0)
 ;on |2|.
"RTN","XMCXU",68,0)
 S XMPARM(1)=+XMTSK,XMPARM(2)=$$HTE^XLFDT($P(XMTSK,U,2),5)
"RTN","XMCXU",69,0)
 D BLD^DIALOG(42288.1,.XMPARM,"","XMTEXT","F")
"RTN","XMCXU",70,0)
 D MSG^DIALOG("WM","","","","XMTEXT")
"RTN","XMCXU",71,0)
 S XMTSK=+XMTSK
"RTN","XMCXU",72,0)
 N DIR,X,Y
"RTN","XMCXU",73,0)
 S DIR(0)="Y",DIR("B")=$$EZBLD^DIALOG(39053) ;NO
"RTN","XMCXU",74,0)
 D BLD^DIALOG($S(XMCHOOSE=1:42289,1:42289.1),XMTSK,"","DIR(""A"")")
"RTN","XMCXU",75,0)
 ;1: Do you want to kill task |1| and queue up a new one
"RTN","XMCXU",76,0)
 ;2: Do you want to kill task |1| before we play the script
"RTN","XMCXU",77,0)
 D ^DIR I $D(DIRUT) S XMABORT=1 Q
"RTN","XMCXU",78,0)
 I 'Y S:XMCHOOSE=1 XMABORT=1 Q
"RTN","XMCXU",79,0)
 D KILLTSK^XMKPR(XMINST,XMTSK)
"RTN","XMCXU",80,0)
 Q
"RTN","XMD")
0^265^B63422057
"RTN","XMD",1,0)
XMD ;ISC-SF/GMB-Send/Forward/Add text to a message APIs ;04/19/2002  12:44
"RTN","XMD",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMD",3,0)
 ; Was (WASH ISC)/THM/CAP
"RTN","XMD",4,0)
 ;
"RTN","XMD",5,0)
 ; Entry points (DBIA 10070) are:
"RTN","XMD",6,0)
 ; ^XMD         Send a message.
"RTN","XMD",7,0)
 ;              If no recipients defined, prompt for them.
"RTN","XMD",8,0)
 ; EN1^XMD      Put text in a message.
"RTN","XMD",9,0)
 ;              If no recipients defined, prompt for them.
"RTN","XMD",10,0)
 ;              Send the message.
"RTN","XMD",11,0)
 ; ENL^XMD      Add text to an existing message.
"RTN","XMD",12,0)
 ; ENT^XMD      Interactive 'send a message'.  (Same as menu)
"RTN","XMD",13,0)
 ; ENT1^XMD     Forward a message.
"RTN","XMD",14,0)
 ; ENT2^XMD     Forward a message.
"RTN","XMD",15,0)
 ;              Prompt for recipients, whether or not any are already
"RTN","XMD",16,0)
 ;              defined.
"RTN","XMD",17,0)
 ;
"RTN","XMD",18,0)
 ; I/O Variables to the various APIs:
"RTN","XMD",19,0)
 ; XMDUZ   (in, optional) Sender DUZ or string (default=DUZ)
"RTN","XMD",20,0)
 ;              For new messages, XMDUZ may be a string, which will be
"RTN","XMD",21,0)
 ;              put in the 'message from' field.
"RTN","XMD",22,0)
 ;              For forwarded messages, XMDUZ may be a string, which
"RTN","XMD",23,0)
 ;              will be put in the 'forwarded by' field.
"RTN","XMD",24,0)
 ; XMSUB   (in) Message subject
"RTN","XMD",25,0)
 ; XMTEXT  (in) @location of message.  For example, the following are
"RTN","XMD",26,0)
 ;              among the acceptable:
"RTN","XMD",27,0)
 ;              XMTEXT="array("
"RTN","XMD",28,0)
 ;              XMTEXT="array(""node"","
"RTN","XMD",29,0)
 ;              XMTEXT="^TMP(""namespace"",$J,""array"","
"RTN","XMD",30,0)
 ;              The array must be in the acceptable FM word processing
"RTN","XMD",31,0)
 ;              format.
"RTN","XMD",32,0)
 ; XMSTRIP (in, optional) Characters that user wants stripped from text
"RTN","XMD",33,0)
 ;              of message (default=none)
"RTN","XMD",34,0)
 ; XMY     (in, optional) Array of recipients, XMY(x)="", where
"RTN","XMD",35,0)
 ;               x is a valid local or internet address.
"RTN","XMD",36,0)
 ;               XMY(x,0)=basket to deliver to, if x=sender's DUZ or .6
"RTN","XMD",37,0)
 ;               (Basket may be its number or name.  If name, and it
"RTN","XMD",38,0)
 ;               doesn't exist, it will be created.)
"RTN","XMD",39,0)
 ;               XMY(x,1)=recipient type, either "I" (info only) or
"RTN","XMD",40,0)
 ;               "C" (carbon copy)
"RTN","XMD",41,0)
 ;               XMY(x,"D")=delete date, if x=.6 ("SHARED,MAIL")
"RTN","XMD",42,0)
 ;               A local address may be a user's name or DUZ, a G.group
"RTN","XMD",43,0)
 ;               name or S.server name.
"RTN","XMD",44,0)
 ;               If not supplied and the process is not queued,
"RTN","XMD",45,0)
 ;               you will be prompted.
"RTN","XMD",46,0)
 ; XMMG    (in, optional) If XMY is not supplied and the process is not
"RTN","XMD",47,0)
 ;               queued, XMMG is used as the default for the first
"RTN","XMD",48,0)
 ;               'send to:' prompt.  It is ignored otherwise.
"RTN","XMD",49,0)
 ;         (out) Contains error message if error occurs.
"RTN","XMD",50,0)
 ;               Undefined if no error.
"RTN","XMD",51,0)
 ; DIFROM  (in, optional) ?
"RTN","XMD",52,0)
 ; XMROU   (in, optional) Array of routines to be loaded in a PackMan
"RTN","XMD",53,0)
 ;               message.   XMROU(x)="", where x=routine name.
"RTN","XMD",54,0)
 ; XMYBLOB (in, optional) Array of images from the imaging system to be
"RTN","XMD",55,0)
 ;               loaded.  XMYBLOB(y)=x, where y and x are ?
"RTN","XMD",56,0)
 ;
"RTN","XMD",57,0)
 ; Local Variables:
"RTN","XMD",58,0)
 ; XMDF    Flag that programmer interface is in use.
"RTN","XMD",59,0)
 ;         Therefore do not check for Security Keys on domains.
"RTN","XMD",60,0)
 ;
"RTN","XMD",61,0)
 ; Entry point ^XMD
"RTN","XMD",62,0)
 ; Needs:   DUZ,XMSUB,XMTEXT
"RTN","XMD",63,0)
 ; Accepts: XMDUZ,XMY,XMMG,XMSTRIP,XMROU,DIFROM,XMYBLOB,
"RTN","XMD",64,0)
 ;          and, if $D(DIFROM), XMDF
"RTN","XMD",65,0)
 ; Ignores: N/A
"RTN","XMD",66,0)
 ; Returns: XMZ(if no error),XMMG(if error)
"RTN","XMD",67,0)
 ; Kills:   XMSUB,XMTEXT,XMY,XMSTRIP,XMMG(if no error),XMYBLOB
"RTN","XMD",68,0)
 N XMV,XMINSTR,XMBLOBER,XMABORT
"RTN","XMD",69,0)
 I '$D(DIFROM) N XMDF S XMDF=1
"RTN","XMD",70,0)
 I '$G(DUZ) N DUZ D DUZ^XUP(.5)
"RTN","XMD",71,0)
 I $G(XMDUZ)=""!($G(XMDUZ)=0) S XMDUZ=DUZ
"RTN","XMD",72,0)
 I XMDUZ'?.N S %=XMDUZ N XMDUZ S XMDUZ=% K %
"RTN","XMD",73,0)
 K XMERR,^TMP("XMERR",$J)
"RTN","XMD",74,0)
 S XMABORT=0
"RTN","XMD",75,0)
 I '$D(XMTEXT) S XMMG="Error = No message text" Q
"RTN","XMD",76,0)
 I '$O(@(XMTEXT_"0)")) S XMMG="Error = No message text" Q
"RTN","XMD",77,0)
 I '$D(XMSUB)  S XMMG="Error = No message subject" Q
"RTN","XMD",78,0)
 ;I $L(XMSUB)<3!($L(XMSUB)>65) S XMMG="Error = Message subject too long or too short" Q
"RTN","XMD",79,0)
 I $L(XMSUB)<3 S XMSUB=XMSUB_"..."
"RTN","XMD",80,0)
 I $L(XMSUB)>65 S XMSUB=$E(XMSUB,1,65)
"RTN","XMD",81,0)
 I $D(XMY)'<10 K XMMG
"RTN","XMD",82,0)
 I XMDUZ'?.N D SETFROM(.XMDUZ,.XMINSTR) Q:$G(XMMG)["Error ="  ; If XMDUZ=.5, becomes POSTMASTER
"RTN","XMD",83,0)
 D INITAPI^XMVVITAE
"RTN","XMD",84,0)
 D INITLATR^XMXADDR
"RTN","XMD",85,0)
 I '$D(XMROU),'$D(DIFROM),'$D(XMYBLOB),$D(XMY) D  Q
"RTN","XMD",86,0)
 . D SEND(XMDUZ,XMSUB,XMTEXT,.XMSTRIP,.XMY,.XMINSTR,.XMMG,.XMZ)
"RTN","XMD",87,0)
 . D QUIT
"RTN","XMD",88,0)
 D CLEANUP^XMXADDR
"RTN","XMD",89,0)
 S XMSUB=$$ENCODEUP^XMXUTIL1(XMSUB)
"RTN","XMD",90,0)
 F  D CRE8XMZ^XMXSEND(XMSUB,.XMZ) Q:XMZ>0  D
"RTN","XMD",91,0)
 . K XMERR,^TMP("XMERR",$J)
"RTN","XMD",92,0)
 . I $D(ZTQUEUED) H 1 Q
"RTN","XMD",93,0)
 . W !,$C(7),$$EZBLD^DIALOG(34101),! ;Waiting for access to the Message File
"RTN","XMD",94,0)
 . N I F I=1:1:10 H 1 W "."
"RTN","XMD",95,0)
 I $D(XMYBLOB)>9 D  Q:XMBLOBER
"RTN","XMD",96,0)
 . ; Add BLOBS to message
"RTN","XMD",97,0)
 . S XMBLOBER=$$MULTI^XMBBLOB(XMZ)
"RTN","XMD",98,0)
 . K XMYBLOB
"RTN","XMD",99,0)
 . Q:'XMBLOBER
"RTN","XMD",100,0)
 . D KILLMSG^XMXUTIL(XMZ)
"RTN","XMD",101,0)
 . K XMZ
"RTN","XMD",102,0)
 D EN1A
"RTN","XMD",103,0)
 Q
"RTN","XMD",104,0)
SEND(XMDUZ,XMSUBJ,XMBODY,XMSTRIP,XMTO,XMINSTR,XMMG,XMZ) ;
"RTN","XMD",105,0)
 S XMBODY=$$CREF^DILF(XMBODY)
"RTN","XMD",106,0)
 S:$D(XMSTRIP) XMINSTR("STRIP")=XMSTRIP
"RTN","XMD",107,0)
 D CHKBSKT(.XMTO,.XMINSTR)
"RTN","XMD",108,0)
 D SENDMSG^XMXPARM(.XMDUZ,.XMSUBJ,.XMBODY,.XMTO,.XMINSTR)
"RTN","XMD",109,0)
 I $D(XMERR) D ERR1 Q
"RTN","XMD",110,0)
 S:$D(XMDF) XMINSTR("ADDR FLAGS")="R" ; Ignore addressee restrictions
"RTN","XMD",111,0)
 D SENDMSG^XMXSEND(XMDUZ,XMSUBJ,XMBODY,.XMTO,.XMINSTR,.XMZ)
"RTN","XMD",112,0)
 D:$D(XMERR) ERR1
"RTN","XMD",113,0)
 Q
"RTN","XMD",114,0)
ERR1 ;
"RTN","XMD",115,0)
 S XMMG="Error = "_^TMP("XMERR",$J,1,"TEXT",1)
"RTN","XMD",116,0)
 K XMERR,^TMP("XMERR",$J)
"RTN","XMD",117,0)
 Q
"RTN","XMD",118,0)
EN1 ; Enter text in the msg, ask for recipients if there aren't any,
"RTN","XMD",119,0)
 ; and send the msg.
"RTN","XMD",120,0)
 ; Needs:   DUZ,XMZ,XMTEXT
"RTN","XMD",121,0)
 ; Accepts: XMDF,XMY,XMMG,XMSTRIP,XMROU,DIFROM
"RTN","XMD",122,0)
 ; Ignores: XMDUZ,XMSUB
"RTN","XMD",123,0)
 ; Returns: N/A
"RTN","XMD",124,0)
 ; Kills:   XMTEXT,XMY,XMSTRIP,XMMG
"RTN","XMD",125,0)
 N XMV,XMABORT,XMDUZ,XMFROM,XMINSTR,XMSUB ; (XMSUB is newed so it isn't killed in QUIT)
"RTN","XMD",126,0)
 S XMABORT=0
"RTN","XMD",127,0)
 S XMDUZ=DUZ
"RTN","XMD",128,0)
 D INITAPI^XMVVITAE
"RTN","XMD",129,0)
 D INITLATR^XMXADDR
"RTN","XMD",130,0)
 K XMERR,^TMP("XMERR",$J)
"RTN","XMD",131,0)
 I $D(XMY)'<10 K XMMG
"RTN","XMD",132,0)
 S XMFROM=$P($G(^XMB(3.9,XMZ,0)),U,2)
"RTN","XMD",133,0)
 I XMFROM'="",XMFROM'=XMDUZ S XMINSTR("FROM")=XMFROM
"RTN","XMD",134,0)
 D EN1A
"RTN","XMD",135,0)
 Q
"RTN","XMD",136,0)
EN1A ;
"RTN","XMD",137,0)
 D EN2A
"RTN","XMD",138,0)
 Q:$D(DIFROM)
"RTN","XMD",139,0)
 D EN3A
"RTN","XMD",140,0)
 D QUIT
"RTN","XMD",141,0)
 Q
"RTN","XMD",142,0)
EN2A ;
"RTN","XMD",143,0)
 N XMI,XMBODY
"RTN","XMD",144,0)
 S XMI=0
"RTN","XMD",145,0)
 I $D(XMROU)>9,'$O(^XMB(3.9,XMZ,2,0)) D NEW^XMP S XMI=1,^XMB(3.9,XMZ,2,0)="^^1^1"
"RTN","XMD",146,0)
 S XMBODY=$$CREF^DILF(XMTEXT)
"RTN","XMD",147,0)
 D MOVEBODY^XMXSEND(XMZ,XMBODY,"A")
"RTN","XMD",148,0)
 D CHEKBODY^XMXSEND(XMZ,.XMSTRIP,XMI)
"RTN","XMD",149,0)
 S XCNP=+$P($G(^XMB(3.9,XMZ,2,0)),U,3)
"RTN","XMD",150,0)
 Q:$D(DIFROM)
"RTN","XMD",151,0)
 Q:$D(XMROU)'>9
"RTN","XMD",152,0)
 D XMROU^XMPH
"RTN","XMD",153,0)
 K XMROU
"RTN","XMD",154,0)
 D PSECURE^XMPSEC(XMZ,.XMABORT)
"RTN","XMD",155,0)
 Q
"RTN","XMD",156,0)
EN3 ; called from XPDTP (KIDS)
"RTN","XMD",157,0)
 ; XMDUZ must be valid DUZ, if provided.  It may not be a string.
"RTN","XMD",158,0)
 N XMV,XMINSTR
"RTN","XMD",159,0)
 I '$G(DUZ) N DUZ D DUZ^XUP(.5)
"RTN","XMD",160,0)
 I '$D(XMDUZ) S XMDUZ=DUZ
"RTN","XMD",161,0)
 D INITAPI^XMVVITAE
"RTN","XMD",162,0)
 D INITLATR^XMXADDR
"RTN","XMD",163,0)
 D EN3A
"RTN","XMD",164,0)
 D QUIT
"RTN","XMD",165,0)
 Q
"RTN","XMD",166,0)
EN3A ;
"RTN","XMD",167,0)
 N XMABORT
"RTN","XMD",168,0)
 S XMABORT=0
"RTN","XMD",169,0)
 S:$D(XMDF) XMINSTR("ADDR FLAGS")="R" ; Ignore addressee restrictions
"RTN","XMD",170,0)
 I $D(XMY)<10,'$$GOTADDR^XMXADDR,'$D(ZTQUEUED) D
"RTN","XMD",171,0)
 . I $D(XMMG) S XMINSTR("TO PROMPT")=XMMG K XMMG
"RTN","XMD",172,0)
 . D TOWHOM^XMJMT($G(XMDUZ,DUZ),$$EZBLD^DIALOG(34110),.XMINSTR,"",.XMABORT) ;Send
"RTN","XMD",173,0)
 E  D
"RTN","XMD",174,0)
 . D CHKBSKT(.XMY,.XMINSTR)
"RTN","XMD",175,0)
 . D CHKADDR^XMXADDR(XMDUZ,.XMY,.XMINSTR) K:$D(XMERR) XMERR,^TMP("XMERR",$J)
"RTN","XMD",176,0)
 Q:XMABORT
"RTN","XMD",177,0)
 I '$$GOTADDR^XMXADDR S:'$D(XMMG) XMMG="Error = No recipients." Q
"RTN","XMD",178,0)
 D BLDNSND^XMXSEND(XMDUZ,XMZ,.XMINSTR)
"RTN","XMD",179,0)
 Q
"RTN","XMD",180,0)
QUIT ;
"RTN","XMD",181,0)
 K XMSUB,XMTEXT,XMY,XMSTRIP
"RTN","XMD",182,0)
 D CLEANUP^XMXADDR
"RTN","XMD",183,0)
 Q
"RTN","XMD",184,0)
ENT ; Entry for outside users
"RTN","XMD",185,0)
 ; All input variables ignored
"RTN","XMD",186,0)
 I '$G(DUZ) W "  User ID needed (DUZ) !!" Q
"RTN","XMD",187,0)
 D EN^XM,SEND^XMJMS
"RTN","XMD",188,0)
 Q
"RTN","XMD",189,0)
INIT ; From DIFROM
"RTN","XMD",190,0)
 D XMZ^XMA2 Q:XMZ<1  S $P(^XMB(3.9,XMZ,0),U,7)="X" D NEW^XMP
"RTN","XMD",191,0)
 Q
"RTN","XMD",192,0)
ENT1 ; Forward a msg, do not ask for recipients
"RTN","XMD",193,0)
 ; Needs:   DUZ,XMZ,XMY
"RTN","XMD",194,0)
 ; Accepts: XMDUZ
"RTN","XMD",195,0)
 ; Ignores: XMSUB,XMTEXT,XMMG,XMSTRIP,XMROU,DIFROM,XMYBLOB
"RTN","XMD",196,0)
 ; Returns: N/A
"RTN","XMD",197,0)
 ; Kills:   XMDUZ,XMY
"RTN","XMD",198,0)
 N XMDF
"RTN","XMD",199,0)
 S XMDF=1
"RTN","XMD",200,0)
 D ENT1A(0)
"RTN","XMD",201,0)
 Q
"RTN","XMD",202,0)
ENT1A(XMASK) ;
"RTN","XMD",203,0)
 N XMV,XMINSTR,XMABORT
"RTN","XMD",204,0)
 K XMERR,^TMP("XMERR",$J)
"RTN","XMD",205,0)
 I '$G(DUZ) N DUZ D DUZ^XUP(.5)
"RTN","XMD",206,0)
 I $G(XMDUZ)=""!($G(XMDUZ)=0) S XMDUZ=DUZ
"RTN","XMD",207,0)
 S XMABORT=0
"RTN","XMD",208,0)
 D:XMDUZ'?.N SETFWD(.XMDUZ,.XMINSTR)
"RTN","XMD",209,0)
 D INITAPI^XMVVITAE
"RTN","XMD",210,0)
 D INIT^XMXADDR
"RTN","XMD",211,0)
 S:$D(XMDF) XMINSTR("ADDR FLAGS")="R" ; Ignore addressee restrictions
"RTN","XMD",212,0)
 I XMASK D TOWHOM^XMJMT(XMDUZ,$$EZBLD^DIALOG(34111),.XMINSTR,"",.XMABORT) Q:XMABORT  ;Forward
"RTN","XMD",213,0)
 D CHKBSKT(.XMY,.XMINSTR)
"RTN","XMD",214,0)
 D CHKADDR^XMXADDR(XMDUZ,.XMY,.XMINSTR) K:$D(XMERR) XMERR,^TMP("XMERR",$J)
"RTN","XMD",215,0)
 I $$GOTADDR^XMXADDR D
"RTN","XMD",216,0)
 . D FWD^XMKP(XMDUZ,XMZ,.XMINSTR)
"RTN","XMD",217,0)
 . D CHECK^XMKPL
"RTN","XMD",218,0)
 E  S:'$D(XMMG) XMMG="Error = No recipients."
"RTN","XMD",219,0)
 K XMDUZ,XMY
"RTN","XMD",220,0)
 D CLEANUP^XMXADDR
"RTN","XMD",221,0)
 Q
"RTN","XMD",222,0)
ENT2 ; Forward a msg, ask for (more) recipients
"RTN","XMD",223,0)
 ; Needs:   DUZ,XMZ
"RTN","XMD",224,0)
 ; Accepts: XMDUZ,XMY,XMDF
"RTN","XMD",225,0)
 ; Ignores: XMSUB,XMTEXT,XMMG,XMSTRIP,XMROU,DIFROM,XMYBLOB
"RTN","XMD",226,0)
 ; Returns: N/A
"RTN","XMD",227,0)
 ; Kills:   XMDUZ,XMY
"RTN","XMD",228,0)
 D ENT1A($S($D(ZTQUEUED):0,1:1))
"RTN","XMD",229,0)
 Q
"RTN","XMD",230,0)
ENX ;FROM MAILMAN
"RTN","XMD",231,0)
 S %=XMDUZ N XMDUZ,XMK S XMDUZ=% D XMD K %
"RTN","XMD",232,0)
 Q
"RTN","XMD",233,0)
ENL ; Add text to an existing message
"RTN","XMD",234,0)
 ; Needs:   XMZ,XMTEXT
"RTN","XMD",235,0)
 ; Accepts: XMSTRIP
"RTN","XMD",236,0)
 ; Ignores: DUZ,XMDUZ,XMSUB,XMMG,XMY,XMROU,DIFROM,XMYBLOB
"RTN","XMD",237,0)
 ; Returns: N/A
"RTN","XMD",238,0)
 ; Kills:   XMSTRIP
"RTN","XMD",239,0)
 N XMI,XMBODY
"RTN","XMD",240,0)
 K XMERR,^TMP("XMERR",$J)
"RTN","XMD",241,0)
 S XMBODY=$$CREF^DILF(XMTEXT)
"RTN","XMD",242,0)
 S XMI=+$P($G(^XMB(3.9,XMZ,2,0)),U,3)
"RTN","XMD",243,0)
 D MOVEBODY^XMXSEND(XMZ,XMBODY,"A")
"RTN","XMD",244,0)
 D CHEKBODY^XMXSEND(XMZ,.XMSTRIP,XMI)
"RTN","XMD",245,0)
 K XMSTRIP
"RTN","XMD",246,0)
 Q
"RTN","XMD",247,0)
CHKBSKT(XMTO,XMINSTR) ;
"RTN","XMD",248,0)
 I $D(XMTO(XMDUZ,0)) S XMINSTR("SELF BSKT")=XMTO(XMDUZ,0)
"RTN","XMD",249,0)
 I $D(XMTO(.6,0)) S XMINSTR("SHARE BSKT")=XMTO(.6,0)
"RTN","XMD",250,0)
 I $D(XMTO(.6,"D")) S XMINSTR("SHARE DATE")=XMTO(.6,"D")
"RTN","XMD",251,0)
 N XMADDR
"RTN","XMD",252,0)
 S XMADDR=""
"RTN","XMD",253,0)
 F  S XMADDR=$O(XMTO(XMADDR)) Q:XMADDR=""  I $D(XMTO(XMADDR,1)) D
"RTN","XMD",254,0)
 . S XMTO(XMTO(XMADDR,1)_":"_XMADDR)=""
"RTN","XMD",255,0)
 . K XMTO(XMADDR)
"RTN","XMD",256,0)
 Q
"RTN","XMD",257,0)
SETFROM(XMDUZ,XMINSTR) ;
"RTN","XMD",258,0)
 Q:XMDUZ=DUZ
"RTN","XMD",259,0)
 N XMPOSTPR
"RTN","XMD",260,0)
 I XMDUZ=.5 D  Q:XMPOSTPR
"RTN","XMD",261,0)
 . S XMPOSTPR=+$O(^XMB(3.7,"AB",DUZ,.5,0))
"RTN","XMD",262,0)
 . Q:'XMPOSTPR
"RTN","XMD",263,0)
 . I $P($G(^XMB(3.7,.5,9,XMPOSTPR,0)),U,3)'="y" S XMPOSTPR=0
"RTN","XMD",264,0)
 I XMDUZ'="POSTMASTER",XMDUZ'=.5 D CHKUSER(.XMDUZ) Q:+XMDUZ=XMDUZ
"RTN","XMD",265,0)
 S XMINSTR("FROM")=$$XMFROM^XMXPARM("XMDUZ",XMDUZ)
"RTN","XMD",266,0)
 I $D(XMERR) D ERR1 Q
"RTN","XMD",267,0)
 S XMDUZ=DUZ
"RTN","XMD",268,0)
 Q
"RTN","XMD",269,0)
SETFWD(XMDUZ,XMINSTR) ;
"RTN","XMD",270,0)
 Q:XMDUZ=DUZ
"RTN","XMD",271,0)
 I XMDUZ=.5,$D(^XMB(3.7,"AB",DUZ,.5)) Q
"RTN","XMD",272,0)
 I XMDUZ=.5,'$D(^XMB(3.7,"AB",DUZ,.5)) S XMDUZ="POSTMASTER"
"RTN","XMD",273,0)
 E  D CHKUSER(.XMDUZ) Q:+XMDUZ=XMDUZ
"RTN","XMD",274,0)
 S XMINSTR("FWD BY")=$$XMFROM^XMXPARM("XMDUZ",XMDUZ)
"RTN","XMD",275,0)
 I $D(XMERR) D ERR1 Q
"RTN","XMD",276,0)
 S XMDUZ=DUZ
"RTN","XMD",277,0)
 Q
"RTN","XMD",278,0)
CHKUSER(XMDUZ) ;
"RTN","XMD",279,0)
 N XMERR
"RTN","XMD",280,0)
 D CHKUSER^XMXPARM1(.XMDUZ)
"RTN","XMD",281,0)
 Q
"RTN","XMDF")
1^232
"RTN","XMDIE")
1^164
"RTN","XMDIR1")
0^266^B23954143
"RTN","XMDIR1",1,0)
XMDIR1 ;(WASH ISC)/CAP-Load VACO Directories ;04/17/2002  08:47
"RTN","XMDIR1",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMDIR1",3,0)
 ; Entry points used by MailMan options (not covered by DBIA):
"RTN","XMDIR1",4,0)
 ; OPTION   XMMGR-DIRECTORY-VACO
"RTN","XMDIR1",5,0)
 Q
"RTN","XMDIR1",6,0)
ENT ;Batch Entry point (TaskMan)
"RTN","XMDIR1",7,0)
 K ZTREQ,^TMP("XMDIR1",$J) S XMA=0
"RTN","XMDIR1",8,0)
 ;
"RTN","XMDIR1",9,0)
 ;LOCK to indicate to XMA5 that MailLink in being updated
"RTN","XMDIR1",10,0)
 L +^XMD("XMDIR1"):1 E  G RES:$D(ZTQUEUED) W !!,$C(7),"<<< This task seems to be running already !",!,"(It cannot be run multiple times concurrently.) >>>" G Q
"RTN","XMDIR1",11,0)
 ;
"RTN","XMDIR1",12,0)
 U IO(0) S XMDIR1A("CODE")=$S($G(XMDIR1A)=1:"1A",1:"1B")
"RTN","XMDIR1",13,0)
 I '$D(ZTQUEUED) W !!,"Killing off old AUTOMATIC entries for this code ("_XMDIR1A("CODE")_").",!!
"RTN","XMDIR1",14,0)
 N DIK
"RTN","XMDIR1",15,0)
 S DA=0,DIK="^XMD(4.2997,"
"RTN","XMDIR1",16,0)
 F XMA0=1:1 S DA=$O(^XMD(4.2997,"E",XMDIR1A("CODE"),DA)) Q:+DA'=DA  D ^DIK I '$D(ZTQUEUED),XMA0#10=0 W "."
"RTN","XMDIR1",17,0)
 ;
"RTN","XMDIR1",18,0)
 ;Kill off very old manual entries that haven't been used
"RTN","XMDIR1",19,0)
 S DA=0,XMDIR1=$E(DT,1,5)-200,XMDIR1("CNT")=0
"RTN","XMDIR1",20,0)
 F XMA0=XMA0:1 S DA=$O(^XMD(4.2997,"AC",DA)) Q:$S(DA>XMDIR1:1,DA="":1,1:0)  D ^DIK I '$D(ZTQUEUED),XMA0#10=0 W "."
"RTN","XMDIR1",21,0)
 ;
"RTN","XMDIR1",22,0)
 I '$D(ZTQUEUED) W !!,"Starting load",!!
"RTN","XMDIR1",23,0)
 U IO
"RTN","XMDIR1",24,0)
 ;Load WANG directory
"RTN","XMDIR1",25,0)
 I $G(XMDIR1A("CODE"))="1A" D ^XMDIR1A
"RTN","XMDIR1",26,0)
 ;
"RTN","XMDIR1",27,0)
 ;Load NOAVA directory
"RTN","XMDIR1",28,0)
 I $G(XMDIR1A("CODE"))="1B" D ^XMDIR1B
"RTN","XMDIR1",29,0)
 ;
"RTN","XMDIR1",30,0)
 K XMDIR1A,XMDIR1B
"RTN","XMDIR1",31,0)
 I '$D(ZTQUEUED) W !!!,"Task Completed"
"RTN","XMDIR1",32,0)
 ;
"RTN","XMDIR1",33,0)
 S ^TMP("XMDIR1",$J,.0001)="Remote Directories summary:"
"RTN","XMDIR1",34,0)
 S ^TMP("XMDIR1",$J,.0002)=""
"RTN","XMDIR1",35,0)
 I $D(XMDIR1("W")) S ^TMP("XMDIR1",$J,.0003)=XMDIR1("W")_" Wang system records processed."
"RTN","XMDIR1",36,0)
 I $D(XMDIR1("N")) S ^TMP("XMDIR1",$J,.0003)=XMDIR1("N")_" NOAVA system records processed."
"RTN","XMDIR1",37,0)
 S XMSUB="REMOTE DIRECTORY AUTOMATIC UPDATE",XMTEXT="^TMP(""XMDIR1"",$J,"
"RTN","XMDIR1",38,0)
 N XMDUZ S XMDUZ="|XMDIR1_REMOTE_DIRECTORY_UPDATE|",XMY("G.POSTMASTER@"_^XMB("NETNAME"))=""
"RTN","XMDIR1",39,0)
 I $D(DUZ) S XMY(DUZ)=""
"RTN","XMDIR1",40,0)
 I $O(XMY(0))="" S XMY(.5)=""
"RTN","XMDIR1",41,0)
 D ^XMD K A
"RTN","XMDIR1",42,0)
Q L -^XMD("XMDIR1") K ^TMP("XMDIR1",$J)
"RTN","XMDIR1",43,0)
 Q
"RTN","XMDIR1",44,0)
 ;
"RTN","XMDIR1",45,0)
 ;Menu option to schedule task
"RTN","XMDIR1",46,0)
OPTION G ENT:$D(ZTQUEUED)
"RTN","XMDIR1",47,0)
 N %,%0,%1,%6,D,DA,I,J,X,Y,XMA0,XMB0,XMC0,XMDUZ,XMDIR1,XMSUB,XMY,XMTEXT
"RTN","XMDIR1",48,0)
 W !!,"You are about to load a file containing a list of names and"
"RTN","XMDIR1",49,0)
 W !,"addresses into you Remote User Directory (file 4.2997).  This"
"RTN","XMDIR1",50,0)
 W !,"file originated either from a NOAVA system or a WANG system."
"RTN","XMDIR1",51,0)
 W !,"Choose the correct file.  We will check it some for format.",!!
"RTN","XMDIR1",52,0)
 S %ZIS("S")="I $P($G(^(""TYPE"")),U)[""HFS"""
"RTN","XMDIR1",53,0)
 S %ZIS("A")="Enter either HFS-WANG-DIR or HFS-NOAVA-DIR: "
"RTN","XMDIR1",54,0)
 S %ZIS("B")="HFS-NOAVA-DIR"
"RTN","XMDIR1",55,0)
 S %ZIS="Q" D ^%ZIS Q:POP
"RTN","XMDIR1",56,0)
 S XMF=IO,XMDIR1A=$S(ION="HFS-NOAVA-DIR":2,1:1)
"RTN","XMDIR1",57,0)
 R !!,"Do you want your job queued? (Answer YES or NO)  NO// ",X:DTIME
"RTN","XMDIR1",58,0)
 K D S:X="" X="NO" S X=$TR(X,"noyes","NOYES") I $E("YES",1,$L(X))=X S D=1
"RTN","XMDIR1",59,0)
 W !!,"Before the update occurs entries older than 90 days in the directory"
"RTN","XMDIR1",60,0)
 W !,"are deleted if they were automatically filed by this procedure."
"RTN","XMDIR1",61,0)
 W !,"Manually entered entries are deleted if they haven't been used"
"RTN","XMDIR1",62,0)
 W !,"for at least 2 years."
"RTN","XMDIR1",63,0)
 W !!,"Users are informed that an update is occuring if they are using"
"RTN","XMDIR1",64,0)
 W !,"MailLink help options.  But are allowed to continue.",!!
"RTN","XMDIR1",65,0)
 R !!,"Are you sure you want to do this (Answer 'YES/NO'): NO//",X:DTIME
"RTN","XMDIR1",66,0)
 S:X="" X="NO" S X=$TR(X,"noyes","NOYES") I $E("YES",1,$L(X))'=X W !!,"Nothing done.",$C(7),!! Q
"RTN","XMDIR1",67,0)
 I '$G(D) G INT
"RTN","XMDIR1",68,0)
 D ZTSK W !!,$C(7),"Task #"_ZTSK_" scheduled.",!!
"RTN","XMDIR1",69,0)
 D ^%ZISC K ZTSK,ZTRTN,ZTDTH,XMDUZ,ZTDESC,IO("Q"),XMDIR1A,XMDIR1B
"RTN","XMDIR1",70,0)
 Q
"RTN","XMDIR1",71,0)
ER ;Display error
"RTN","XMDIR1",72,0)
 S XMDIR1("CNT")=XMDIR1("CNT")+1,^TMP("XMDIR1",$J,XMDIR1("CNT"))=XME_":"_XMY Q
"RTN","XMDIR1",73,0)
ZTSK ;Schedule to run in the evening
"RTN","XMDIR1",74,0)
 S XMDUZ="[XMDIR1_DIRECTORY_CONVERSION]",ZTRTN="ENT^XMDIR1",ZTDTH=+$H_",64800",ZTSAVE("*")="",ZTDESC="Convert MailLink list"
"RTN","XMDIR1",75,0)
 S ZTDTH="" D ^%ZTLOAD Q
"RTN","XMDIR1",76,0)
 ;Job out this process from here
"RTN","XMDIR1",77,0)
JOB S ZTQUEUED=1,U="^",(IO,IO(0))="" D DT^DICRW G XMDIR1
"RTN","XMDIR1",78,0)
 ;Reschedule job to run later
"RTN","XMDIR1",79,0)
RES S ZTREQ=$$HADD^XLFDT($H,,,5)_"^^MailLink Conversion Restart @ "_$H_"^XMZWANG" Q
"RTN","XMDIR1",80,0)
HFSFILE S DIC="^%ZIS(1,",DIC(0)="AZQME",DIC("S")="I $P($G(^%ZIS(1,Y,""TYPE"")),U)[""HFS"""
"RTN","XMDIR1",81,0)
 D ^DIC Q:Y<0
"RTN","XMDIR1",82,0)
 S IOP=X D ^%ZIS Q:POP
"RTN","XMDIR1",83,0)
 S XMF=$P(^%ZIS(1,IOS,0),U,2) Q
"RTN","XMDIR1",84,0)
INT ;Interactive processing begins here
"RTN","XMDIR1",85,0)
 S XMF=$P(^%ZIS(1,IOS,0),U,2)
"RTN","XMDIR1",86,0)
 W !!,"Answer 'YES' if you mean 'YES'.  All other response mean 'NO'."
"RTN","XMDIR1",87,0)
 W !,"The first file to be processed is for the "_XMF_"."
"RTN","XMDIR1",88,0)
 W !,"Enter '^' to skip this portion of the process.",!!
"RTN","XMDIR1",89,0)
 I $$NEWERR^%ZTER N $ETRAP,$ESTACK S $ETRAP=""
"RTN","XMDIR1",90,0)
 S X="NOWANG^XMDIR1B",@^%ZOSF("TRAP")
"RTN","XMDIR1",91,0)
 U IO R Y:1 U IO(0)
"RTN","XMDIR1",92,0)
 W !!,"The following string was read from the first line of "_XMF_"."
"RTN","XMDIR1",93,0)
 W !!,Y,!!,"Is this correct ? NO// " R %:DTIME
"RTN","XMDIR1",94,0)
 S:%="" %="NO" S %=$TR(%,"noyes","NOYES")
"RTN","XMDIR1",95,0)
 I $E("YES",1,$L(%))'=% D ^%ZISC Q
"RTN","XMDIR1",96,0)
 W ! G ENT
"RTN","XMDIR1A")
0^267^B7666830
"RTN","XMDIR1A",1,0)
XMDIR1A ;(WASH ISC)/CAP-Load VACO Directories (WANG) ;04/17/2002  08:47
"RTN","XMDIR1A",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMDIR1A",3,0)
 I $$NEWERR^%ZTER N $ETRAP,$ESTACK S $ETRAP=""
"RTN","XMDIR1A",4,0)
 S X="EOF^XMDIR1A",@^%ZOSF("TRAP"),XMB0=^%ZOSF("UPPERCASE")
"RTN","XMDIR1A",5,0)
 G P:'$D(ZTQUEUED)
"RTN","XMDIR1A",6,0)
 ;Batch processing begins here
"RTN","XMDIR1A",7,0)
R1 U IO R Y:DTIME I '$D(ZTQUEUED) U IO(0)
"RTN","XMDIR1A",8,0)
 S XMA=XMA+1 I '$D(ZTQUEUED),XMA#10=0 W "."
"RTN","XMDIR1A",9,0)
P S X=Y X XMB0 F %=0:0 Q:$E(Y)'?1P  S Y=$E(Y,2,99)
"RTN","XMDIR1A",10,0)
 F %=$L(Y):-1:0 Q:$E(Y,%)?1A  S Y=$E(Y,1,%-1)
"RTN","XMDIR1A",11,0)
 K X S X=$P(Y,"*")
"RTN","XMDIR1A",12,0)
 G R1:X[" ",R1:X["@",R1:X["::",R1:X[".."
"RTN","XMDIR1A",13,0)
 S XMY=Y
"RTN","XMDIR1A",14,0)
 ;
"RTN","XMDIR1A",15,0)
1 ;Name
"RTN","XMDIR1A",16,0)
 S X("LN")=$P(X,".",$L(X,".")),X=$P(X,".",1,$L(X,".")-1)
"RTN","XMDIR1A",17,0)
 G R1:'$L(X("LN")),R1:X("LN")?1.N,R1:X("LN")?.E3N.E,R1:X("LN")["/"
"RTN","XMDIR1A",18,0)
 G R1:X("LN")?.E1C.E
"RTN","XMDIR1A",19,0)
 S X("FN")=$P(X,"."),X=$P(X,".",2,9),X("RN")=X
"RTN","XMDIR1A",20,0)
 ;
"RTN","XMDIR1A",21,0)
 ;Mail code
"RTN","XMDIR1A",22,0)
 S X=$P(Y,"*",2),X("MC")=$P(X," "),X("EMC")=X G R1:X("MC")?.E1C.E
"RTN","XMDIR1A",23,0)
 ;
"RTN","XMDIR1A",24,0)
 ;Location
"RTN","XMDIR1A",25,0)
 S X("L")=$P(Y,"*",3)
"RTN","XMDIR1A",26,0)
 ;
"RTN","XMDIR1A",27,0)
 ;Network address
"RTN","XMDIR1A",28,0)
 S Y=$P(XMY,"*") G R1:'$L(Y),R1:Y?.E1C.E S X("NET")=Y_"@VACOWMAIL.VA.GOV"
"RTN","XMDIR1A",29,0)
 I $D(^XMD(4.2997,"B",X("LN"))) S %="" F  S %=$O(^XMD(4.2997,"B",X("LN"),%)) Q:%=""  I $D(^XMD(4.2997,%,0)) S %6=^XMD(4.2997,%,0) I X("NET")=$P(%6,U,7) S XME="Already on file - not filed " D ER^XMDIR1 G R1
"RTN","XMDIR1A",30,0)
 ;
"RTN","XMDIR1A",31,0)
 D FILE(.X)
"RTN","XMDIR1A",32,0)
 G R1
"RTN","XMDIR1A",33,0)
FILE(X) ;HARD CODE
"RTN","XMDIR1A",34,0)
 ;
"RTN","XMDIR1A",35,0)
 ;X("EMC")=Extended Mail Code
"RTN","XMDIR1A",36,0)
 ;X("FN")=First name
"RTN","XMDIR1A",37,0)
 ;X("L")=Location
"RTN","XMDIR1A",38,0)
 ;X("LN")=Last name
"RTN","XMDIR1A",39,0)
 ;X("MC")=Mail Code
"RTN","XMDIR1A",40,0)
 ;X("NET")=full NETwork address
"RTN","XMDIR1A",41,0)
 ;X("PHONE")=Phone number
"RTN","XMDIR1A",42,0)
 ;X("PHONE/E")=Telephone Extension
"RTN","XMDIR1A",43,0)
 ;X("RN")=Restofname
"RTN","XMDIR1A",44,0)
 ;
"RTN","XMDIR1A",45,0)
 ;Get new entry number
"RTN","XMDIR1A",46,0)
 N %,N,Y L +^XMD(4.2997,0)
"RTN","XMDIR1A",47,0)
 S Y=^XMD(4.2997,0) F N=$P(Y,U,4)+1:1 Q:'$D(^(N))
"RTN","XMDIR1A",48,0)
 L +^XMD(4.2997,N) S $P(Y,U,4)=N,^XMD(4.2997,0)=Y
"RTN","XMDIR1A",49,0)
 ;File entry
"RTN","XMDIR1A",50,0)
 S ^XMD(4.2997,N,0)=X("LN")_U_X("FN")_U_X("RN")_U_X("MC")_U_X("EMC")_U_X("L")_U_X("NET")_U_+$H_U_XMDIR1,^("AUTO")=XMDIR1A("CODE")
"RTN","XMDIR1A",51,0)
 I $D(X("PHONE"))!$D(X("PHONE/X")) S %=$G(X("PHONE")) S:$L($G(X("PHONE/X"))) %=%_U_X("PHONE/X") S ^XMD(4.2997,N,1)=%
"RTN","XMDIR1A",52,0)
 ;Create cross references for one entry
"RTN","XMDIR1A",53,0)
 S DIK="^XMD(4.2997,",DA=N D IX^DIK L -^XMD(4.2997,0),-^XMD(4.2997,N)
"RTN","XMDIR1A",54,0)
 Q
"RTN","XMDIR1A",55,0)
EOF D ^%ZISC,END("WANG",90) Q
"RTN","XMDIR1A",56,0)
END(X,Y) ;END PROCESSING
"RTN","XMDIR1A",57,0)
 ;X=NAME OF FILE (WANG or NOAVA)
"RTN","XMDIR1A",58,0)
 ;Y=Subscript of text array
"RTN","XMDIR1A",59,0)
 N A S A=X,XMDIR1($E(X))=XMA
"RTN","XMDIR1A",60,0)
 S ^TMP("XMDIR1",$J,.01)="Normal error reported here",^(.02)="("_$ZE_")",^(.03)="should be end of File."
"RTN","XMDIR1A",61,0)
 S ^TMP("XMDIR1",$J,.04)="Done processing "_A_" file on "_$$HTE^XLFDT($H,5)
"RTN","XMDIR1A",62,0)
 S ^TMP("XMDIR1",$J,.05)=""
"RTN","XMDIR1A",63,0)
 Q
"RTN","XMDIR1B")
0^268^B5271223
"RTN","XMDIR1B",1,0)
XMDIR1B ;(WASH ISC)/CAP-Load VACO Directories (NOAVA) ;04/17/2002  08:47
"RTN","XMDIR1B",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMDIR1B",3,0)
 ; Entry points used by MailMan options (not covered by DBIA):
"RTN","XMDIR1B",4,0)
 ; REMOTES  XMEDIT-REMOTE-USER
"RTN","XMDIR1B",5,0)
 I $$NEWERR^%ZTER N $ETRAP,$ESTACK S $ETRAP=""
"RTN","XMDIR1B",6,0)
 S X="EOF^XMDIR1B",@^%ZOSF("TRAP"),XMB0=^%ZOSF("UPPERCASE")
"RTN","XMDIR1B",7,0)
GO G P:'$D(ZTQUEUED)
"RTN","XMDIR1B",8,0)
R1 U IO R Y:DTIME I '$D(ZTQUEUED) U IO(0)
"RTN","XMDIR1B",9,0)
 S XMA=XMA+1 I '$D(ZTQUEUED),XMA#10=0 W "."
"RTN","XMDIR1B",10,0)
P S X=Y X XMB0 F %=0:0 Q:$E(Y)'?1P  S Y=$E(Y,2,99)
"RTN","XMDIR1B",11,0)
 F %=$L(Y):-1:0 Q:$E(Y,%)?1A  S Y=$E(Y,1,%-1)
"RTN","XMDIR1B",12,0)
 K X S X=$$STRIP($P(Y,":"))
"RTN","XMDIR1B",13,0)
 G R1:X[" ",R1:X["@",R1:X["::",R1:X["..",R1:X="",R1:X?1.N,R1:X?.E3N.E,R1:X["/",R1:X?.E1C.E
"RTN","XMDIR1B",14,0)
 S XMY=Y
"RTN","XMDIR1B",15,0)
 ;
"RTN","XMDIR1B",16,0)
 ;Name
"RTN","XMDIR1B",17,0)
 S X("LN")=X
"RTN","XMDIR1B",18,0)
 S X=$$STRIP($P(XMY,":",2)),X("FN")=X,X("RN")=""
"RTN","XMDIR1B",19,0)
 ;
"RTN","XMDIR1B",20,0)
 ;Mail code
"RTN","XMDIR1B",21,0)
 S X=$$STRIP($P(XMY,":",6)),X("MC")=$P(X," "),X("EMC")=X G R1:X("MC")?.E1C.E
"RTN","XMDIR1B",22,0)
 ;
"RTN","XMDIR1B",23,0)
 ;Phone number / Extension
"RTN","XMDIR1B",24,0)
 S X("PHONE")=$$STRIP($P(XMY,":",5)),X("PHONE/E")=$$STRIP($P(XMY,":",7))
"RTN","XMDIR1B",25,0)
 ;
"RTN","XMDIR1B",26,0)
 ;Location
"RTN","XMDIR1B",27,0)
 S X("L")=$$STRIP($P(XMY,":",4))
"RTN","XMDIR1B",28,0)
 ;
"RTN","XMDIR1B",29,0)
 ;Network address
"RTN","XMDIR1B",30,0)
 S X=$$STRIP($P(XMY,":",9)),X=$P(X,"@")
"RTN","XMDIR1B",31,0)
 G R1:'$L(X),R1:X?.E1C.E S X("NET")=X_"@VACO.VA.GOV"
"RTN","XMDIR1B",32,0)
 I $D(^XMD(4.2997,"B",X("LN"))) S %="" F  S %=$O(^XMD(4.2997,"B",X("LN"),%)) Q:%=""  I $D(^XMD(4.2997,%,0)) S %6=^XMD(4.2997,%,0) I X("NET")=$P(%6,U,7) S XME="Already on file - not filed " D ER^XMDIR1 G R1
"RTN","XMDIR1B",33,0)
 ;
"RTN","XMDIR1B",34,0)
 D FILE^XMDIR1A(.X)
"RTN","XMDIR1B",35,0)
 G R1
"RTN","XMDIR1B",36,0)
EOF D ^%ZISC,END^XMDIR1A("NOAVA",90) Q
"RTN","XMDIR1B",37,0)
 ;
"RTN","XMDIR1B",38,0)
 ;Strip leading and trailing spaces
"RTN","XMDIR1B",39,0)
STRIP(X) F  Q:$E(X)'=" "  S X=$E(X,2,999)
"RTN","XMDIR1B",40,0)
 F  Q:$E(X,$L(X))'=" "  S X=$E(X,1,$L(X)-1)
"RTN","XMDIR1B",41,0)
 Q X
"RTN","XMDIR1B",42,0)
NOWANG D @^%ZOSF("ERRTN")
"RTN","XMDIR1B",43,0)
 I '$D(ZTQUEUED) W !!,"The error: "_$ZE_" occured !!!",!!
"RTN","XMDIR1B",44,0)
 G Q^XMDIR1
"RTN","XMDIR1B",45,0)
REMOTES ;Edit/Add Remote members
"RTN","XMDIR1B",46,0)
 N DA,DIE,DR,DIC,DLAYGO,X,Y,DUOUT,DTOUT
"RTN","XMDIR1B",47,0)
 S DIC=4.2997,DLAYGO=4.2997,DIC(0)="AELQMZ" D ^DIC
"RTN","XMDIR1B",48,0)
 Q:$S($D(DTOUT):1,$D(DUOUT):1,Y<1:1,1:0)
"RTN","XMDIR1B",49,0)
 S DA=+Y,DIE=4.2997,DR=".01:99999" D ^DIE
"RTN","XMDIR1B",50,0)
 Q
"RTN","XMDIRQST")
0^269^B14882403
"RTN","XMDIRQST",1,0)
XMDIRQST ;(WASH ISC)/CWU-Request Email Directory ;04/18/2002  07:31
"RTN","XMDIRQST",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMDIRQST",3,0)
 ; Entry points used by MailMan options (not covered by DBIA):
"RTN","XMDIRQST",4,0)
 ; ALL      XMMGR-DIRECTORY-ALL
"RTN","XMDIRQST",5,0)
 ; EDIT     XMMGR-DIRECTORY-EDITGRP
"RTN","XMDIRQST",6,0)
 ; GROUP    XMMGR-DIRECTORY-GROUP
"RTN","XMDIRQST",7,0)
 ; LISTGRP  XMMGR-DIRECTORY-LISTGRP
"RTN","XMDIRQST",8,0)
 ; SINGLE   XMMGR-DIRECTORY-SINGLE
"RTN","XMDIRQST",9,0)
 Q
"RTN","XMDIRQST",10,0)
ALL N DIR,Y,A,DTOUT,DUOUT,NETADDR,XMSUB,XMY,ZTDTH,ZTSAVE
"RTN","XMDIRQST",11,0)
 S DIR(0)="Y"
"RTN","XMDIRQST",12,0)
 S DIR("A")="Request directories from all domains"
"RTN","XMDIRQST",13,0)
 S DIR("B")="NO"
"RTN","XMDIRQST",14,0)
 S DIR("?")="Enter YES to request directories from all domains."
"RTN","XMDIRQST",15,0)
 D ^DIR I $D(DIRUT)!'Y Q
"RTN","XMDIRQST",16,0)
 S I=0 F  S I=$O(^DIC(4.2,I)) Q:I'=+I  D S(I)
"RTN","XMDIRQST",17,0)
 Q
"RTN","XMDIRQST",18,0)
SINGLE ;Send a request to one Domain
"RTN","XMDIRQST",19,0)
 W !!,"Choose Domains to request Email Directories for."
"RTN","XMDIRQST",20,0)
 N DIC,X,Y
"RTN","XMDIRQST",21,0)
 S DIC("A")="Select DOMAIN Name: ",DIC="^DIC(4.2,",DIC(0)="AEQZ"
"RTN","XMDIRQST",22,0)
 D ^DIC Q:Y<0
"RTN","XMDIRQST",23,0)
 D S(+Y)
"RTN","XMDIRQST",24,0)
 Q
"RTN","XMDIRQST",25,0)
S(I) ;Schedule Task to Send Request to Domain
"RTN","XMDIRQST",26,0)
 N %,X,R ; I=IEN
"RTN","XMDIRQST",27,0)
 ;Do not send if No Domain Information, etc.
"RTN","XMDIRQST",28,0)
 S %=$G(^DIC(4.2,+I,0)) I %="" W $C(7),"  ???  No entry in Domain File (4.2) for domain '",I,"'.  [S(I)+2^XMDIRQST]" Q
"RTN","XMDIRQST",29,0)
 S X=$P(%,U),R=$P(%,U,3) I R W $C(7),"  ??? The directory request for ",X," (`",I,") is NOT permitted since it is accessed via relay domain '",$P($G(^DIC(4.2,+R,0)),U)," (`",R,").  [S(I)+3^XMDIRQST]  " Q
"RTN","XMDIRQST",30,0)
 I X["FOC-AUSTIN" W $C(7),"  ???  The request for a directory from ",X," (`",I,") is NOT permitted as it is through FOC-AUSTIN.  [S(I)+4^XMDIRQST]" Q
"RTN","XMDIRQST",31,0)
 I $E(X,1,2)="Q-" W $C(7),"  ???  The request for a directory from ",X," (`",I,") is NOT permitted since it is a relay domain (Q-...).  [S(I)+5^XMDIRQST]" Q
"RTN","XMDIRQST",32,0)
 I X=^XMB("NETNAME") W $C(7),"  ???  You may not request a directory from your own site." Q
"RTN","XMDIRQST",33,0)
TASK ; Set up Task
"RTN","XMDIRQST",34,0)
 N XMTASK,NETADDR
"RTN","XMDIRQST",35,0)
 S XMTASK=$G(ZTSK) N ZTSK
"RTN","XMDIRQST",36,0)
 S NETADDR=X,ZTSAVE("NETADDR")=""
"RTN","XMDIRQST",37,0)
 S ZTRTN="ONE^XMDIRQST",ZTDTH=+$H_",64800"
"RTN","XMDIRQST",38,0)
 S ZTIO="",ZTDESC="Email Directory Request to - "_X
"RTN","XMDIRQST",39,0)
 D ^%ZTLOAD
"RTN","XMDIRQST",40,0)
 I 'XMTASK W !!,$C(7),"TASK #"_ZTSK_" scheduled for "_NETADDR
"RTN","XMDIRQST",41,0)
 Q
"RTN","XMDIRQST",42,0)
ONE ;
"RTN","XMDIRQST",43,0)
 N XMTEXT,XMINSTR
"RTN","XMDIRQST",44,0)
 S XMINSTR("FROM")=.5
"RTN","XMDIRQST",45,0)
 S XMTEXT(1)="Directory request"
"RTN","XMDIRQST",46,0)
 D SENDMSG^XMXSEND(.5,"Request for Email Address Directory","XMTEXT","S.XMMGR-DIRECTORY-SEND@"_NETADDR,.XMINSTR)
"RTN","XMDIRQST",47,0)
 Q
"RTN","XMDIRQST",48,0)
LISTGRP ;
"RTN","XMDIRQST",49,0)
 N LSTBYGRP S LSTBYGRP=1
"RTN","XMDIRQST",50,0)
GROUP ;
"RTN","XMDIRQST",51,0)
 N DIR,Y,DTOUT,DUOUT,NETADDR,XMGROUP,XMSUB,XMY,ZTDTH,ZTSAVE,ZTSK
"RTN","XMDIRQST",52,0)
 S DIC="^DIC(4.2,",DIC(0)="AQZXC"
"RTN","XMDIRQST",53,0)
 K DO S D="AE",DIC("A")="Enter Directory Group Number: "
"RTN","XMDIRQST",54,0)
 S DIC("S")="I $O(^DIC(4.2,""AE"",X,""""))=+Y"
"RTN","XMDIRQST",55,0)
 D IX^DIC
"RTN","XMDIRQST",56,0)
 Q:Y<1  S (X,XMGROUP)=+^DIC(4.2,+Y,50)
"RTN","XMDIRQST",57,0)
 W !!,"Group Number ",X," contains following Domain names : "
"RTN","XMDIRQST",58,0)
 S I=0 F  S I=$O(^DIC(4.2,"AE",X,I)) Q:I=""  W !,$P(^DIC(4.2,I,0),U)
"RTN","XMDIRQST",59,0)
 W !!
"RTN","XMDIRQST",60,0)
 Q:$G(LSTBYGRP)
"RTN","XMDIRQST",61,0)
 S DIR(0)="Y"
"RTN","XMDIRQST",62,0)
 S DIR("A")="Do you wish to schedule Directory Request(s) for group number "_XMGROUP
"RTN","XMDIRQST",63,0)
 S DIR("B")="NO"
"RTN","XMDIRQST",64,0)
 S DIR("?")="Enter YES if you wish to request directories from all domains in the group."
"RTN","XMDIRQST",65,0)
 D ^DIR Q:$D(DIRUT)!'Y
"RTN","XMDIRQST",66,0)
 S I=0 F  S I=$O(^DIC(4.2,"AE",XMGROUP,I)) Q:I=""  D S(I)
"RTN","XMDIRQST",67,0)
 Q
"RTN","XMDIRQST",68,0)
EDIT ;
"RTN","XMDIRQST",69,0)
 W !!,"Enter the Domain name whose Directory Requests Flag you wish to edit."
"RTN","XMDIRQST",70,0)
 K DIC S DIC="^DIC(4.2,",DIC(0)="AEQZ" D ^DIC
"RTN","XMDIRQST",71,0)
 Q:$D(DTOUT)!$D(DUOUT)!(Y<1)
"RTN","XMDIRQST",72,0)
 S DIE="^DIC(4.2,",DA=+Y,DR=50 D ^DIE
"RTN","XMDIRQST",73,0)
 G EDIT
"RTN","XMDIRRCV")
0^270^B3171429
"RTN","XMDIRRCV",1,0)
XMDIRRCV ;(WASH ISC)/CWU-Receive Email Directory ;04/18/2002  07:32
"RTN","XMDIRRCV",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMDIRRCV",3,0)
 ; Entry points used by MailMan options (not covered by DBIA):
"RTN","XMDIRRCV",4,0)
 ; RECEIVE  XMMGR-DIRECTORY-RECV
"RTN","XMDIRRCV",5,0)
RECEIVE ;
"RTN","XMDIRRCV",6,0)
 S XMA=0
"RTN","XMDIRRCV",7,0)
 ;
"RTN","XMDIRRCV",8,0)
 ;Get pointer to domain data is coming from
"RTN","XMDIRRCV",9,0)
 S %=$P($P($P(^XMB(3.9,XMZ,0),U,2),"@",2),">")
"RTN","XMDIRRCV",10,0)
 S XMDIR1A("CODE")=$S(%="":^XMB("NETNAME"),1:%)
"RTN","XMDIRRCV",11,0)
 N DIK S DA=0,DIK="^XMD(4.2997,"
"RTN","XMDIRRCV",12,0)
 F  S DA=$O(^XMD(4.2997,"E",XMDIR1A("CODE"),DA)) Q:+DA'=DA  D ^DIK
"RTN","XMDIRRCV",13,0)
 ;
"RTN","XMDIRRCV",14,0)
 ;Begin main loop
"RTN","XMDIRRCV",15,0)
 ;
"RTN","XMDIRRCV",16,0)
A ;X XMREC
"RTN","XMDIRRCV",17,0)
 ;I $D(XMER) G Q:XMER<0
"RTN","XMDIRRCV",18,0)
 ;S XMA=XMA+1
"RTN","XMDIRRCV",19,0)
 ;S XMTXT(XMA)=XMRG
"RTN","XMDIRRCV",20,0)
 ;G A
"RTN","XMDIRRCV",21,0)
Q ; SET UP FOR RECEIVING EMAIL DIRECTORY
"RTN","XMDIRRCV",22,0)
 N %,%1,%5,%6
"RTN","XMDIRRCV",23,0)
 S XMDIR1=$E(DT,1,5)-200
"RTN","XMDIRRCV",24,0)
 S %=.999999
"RTN","XMDIRRCV",25,0)
 F  S %=$O(^XMB(3.9,XMZ,2,%)) Q:%=""  S %1=$G(^XMB(3.9,XMZ,2,%,0)) D
"RTN","XMDIRRCV",26,0)
 . Q:%1=""
"RTN","XMDIRRCV",27,0)
 . S X("LN")=$P(%1,U),X("FN")=$P(%1,U,2),X("RN")=$P(%1,U,3),X("MC")=$P(%1,U,4),X("EMC")=$P(%1,U,5),X("L")=$P(%1,U,6),X("NET")=$P(%1,U,7)
"RTN","XMDIRRCV",28,0)
 . Q:X("LN")=""
"RTN","XMDIRRCV",29,0)
 . I $D(^XMD(4.2997,"B",X("LN"))) S %5="" F  S %5=$O(^XMD(4.2997,"B",X("LN"),%5)) Q:%5=""  I $D(^XMD(4.2997,%5,0)) S %6=^XMD(4.2997,%5,0) Q:X("NET")=$P(%6,U,7)
"RTN","XMDIRRCV",30,0)
 . D FILE^XMDIR1A(.X)
"RTN","XMDIRRCV",31,0)
 ;
"RTN","XMDIRRCV",32,0)
 ;FINISH UP
"RTN","XMDIRRCV",33,0)
 ;
"RTN","XMDIRRCV",34,0)
 ;Set up for call to MailMan programmer interface
"RTN","XMDIRRCV",35,0)
 S XMTEXT="XMTXT(",^TMP("XMY",$J,.5)=""
"RTN","XMDIRRCV",36,0)
 S XMTXT(XMA+1)=" "
"RTN","XMDIRRCV",37,0)
 S XMTXT(XMA+2)="This message arrived through a server routine."
"RTN","XMDIRRCV",38,0)
 ;
"RTN","XMDIRRCV",39,0)
 ;Call MailMan programmer interface
"RTN","XMDIRRCV",40,0)
 D ^XMD
"RTN","XMDIRRCV",41,0)
 D ZAPSERV^XMXMSGS1("S."_XQSOP,XQMSG)
"RTN","XMDIRRCV",42,0)
 Q
"RTN","XMDIRSND")
0^27^B3654840
"RTN","XMDIRSND",1,0)
XMDIRSND ;(WASH ISC)/CMW- Send Email Directory ;04/18/2002  07:31
"RTN","XMDIRSND",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMDIRSND",3,0)
 ; Entry points used by MailMan options (not covered by DBIA):
"RTN","XMDIRSND",4,0)
 ; SEND    XMMGR-DIRECTORY-SEND
"RTN","XMDIRSND",5,0)
SEND ;
"RTN","XMDIRSND",6,0)
 I $P($G(^XMB(1,1,8.4)),U) D
"RTN","XMDIRSND",7,0)
 . D OK(XQSND)
"RTN","XMDIRSND",8,0)
 E  D NOTOK(XQSND)
"RTN","XMDIRSND",9,0)
 D ZAPSERV^XMXMSGS1("S."_XQSOP,XQMSG)
"RTN","XMDIRSND",10,0)
 Q
"RTN","XMDIRSND",11,0)
NOTOK(XMTO) ;
"RTN","XMDIRSND",12,0)
 N XMTEXT,XMINSTR
"RTN","XMDIRSND",13,0)
 S XMINSTR("FROM")=.5
"RTN","XMDIRSND",14,0)
 S XMTO=$$REMADDR^XMXADDR3(XMTO)
"RTN","XMDIRSND",15,0)
 S XMTEXT(1)="User directory request at Domain "_^XMB("NETNAME")
"RTN","XMDIRSND",16,0)
 S XMTEXT(2)="is not granted."
"RTN","XMDIRSND",17,0)
 D SENDMSG^XMXSEND(.5,"Directory Request","XMTEXT",XMTO,.XMINSTR)
"RTN","XMDIRSND",18,0)
 Q
"RTN","XMDIRSND",19,0)
OK(XMFROM) ;
"RTN","XMDIRSND",20,0)
 N XMZ,XMUSER,XMREC,XMNAME,XMINSTR,XMTO,XMNETNAM
"RTN","XMDIRSND",21,0)
 S XMINSTR("FROM")=.5,XMNETNAM=^XMB("NETNAME")
"RTN","XMDIRSND",22,0)
 S XMTO=$P($$REMADDR^XMXADDR3(XMFROM),"@",2)
"RTN","XMDIRSND",23,0)
 S XMTO="S.XMMGR-DIRECTORY-RECV"_$S(XMTO="":"",1:"@"_XMTO)
"RTN","XMDIRSND",24,0)
 D STARTMSG^XMXSEND("Collect network user address",.XMZ)
"RTN","XMDIRSND",25,0)
 S XMUSER=0
"RTN","XMDIRSND",26,0)
 F  S XMUSER=$O(^XMB(3.7,XMUSER)) Q:XMUSER'>0  D
"RTN","XMDIRSND",27,0)
 . S XMREC=$G(^VA(200,XMUSER,0)) Q:'$L($P(XMREC,U,3))
"RTN","XMDIRSND",28,0)
 . S XMNAME("FILE")=200,XMNAME("IENS")=XMUSER_",",XMNAME("FIELD")=.01
"RTN","XMDIRSND",29,0)
 . S XMNAME=$$HLNAME^XLFNAME(.XMNAME)
"RTN","XMDIRSND",30,0)
 . ;Lname^Fname^Room#^MailCode^MailCode+^Location^Netname^Phone#^Phone_Ext
"RTN","XMDIRSND",31,0)
 . D BODYLINE^XMXSEND(XMZ,$P(XMNAME,U,1,2)_"^^^^^"_$TR($$NAME^XMXUTIL(XMUSER),". ,","+_.")_"@"_XMNETNAM)
"RTN","XMDIRSND",32,0)
 D ENDMSG^XMXSEND(.5,XMZ,XMTO,.XMINSTR)
"RTN","XMDIRSND",33,0)
 Q
"RTN","XMDOC")
1^165
"RTN","XME")
1^156
"RTN","XME1")
1^157
"RTN","XMF1")
1^271
"RTN","XMFAX")
0^28^B11327342
"RTN","XMFAX",1,0)
XMFAX ;ISC-SF/GMB-Fax ;04/08/2002  14:46
"RTN","XMFAX",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMFAX",3,0)
FAX(XMZ) ; Fax a message
"RTN","XMFAX",4,0)
 N XMABORT,XMCNT,XMFIEN,XMQUIET
"RTN","XMFAX",5,0)
 S XMQUIET=1 ; "quiet flag"
"RTN","XMFAX",6,0)
 S XMABORT=0
"RTN","XMFAX",7,0)
 D CRE8FAX(XMZ,XMQUIET,.XMCNT,.XMABORT) Q:XMABORT
"RTN","XMFAX",8,0)
 D SENDFAX(XMQUIET,XMFIEN,XMCNT)
"RTN","XMFAX",9,0)
 Q
"RTN","XMFAX",10,0)
CRE8FAX(XMZ,XMQUIET,XMCNT,XMABORT) ;
"RTN","XMFAX",11,0)
 N XMFID
"RTN","XMFAX",12,0)
 D RECORD(XMQUIET,.XMFID,.XMFIEN,.XMABORT) Q:XMABORT
"RTN","XMFAX",13,0)
 L +^AKF("FAX",XMFIEN)
"RTN","XMFAX",14,0)
 D RECIPS(XMZ,XMFID,XMFIEN,.XMCNT)
"RTN","XMFAX",15,0)
 D BODY(XMZ,XMFIEN)
"RTN","XMFAX",16,0)
 L -^AKF("FAX",XMFIEN)
"RTN","XMFAX",17,0)
 Q
"RTN","XMFAX",18,0)
RECORD(AKQ,AKFAX,AKIEN,XMABORT) ; Add record to fax file
"RTN","XMFAX",19,0)
 ; AKFAX    Fax ID
"RTN","XMFAX",20,0)
 ; AKIEN    Record number in ^AKF("FAX",
"RTN","XMFAX",21,0)
 D NE^AKFAX0 I '$D(AKFAX) S XMABORT=1 Q  ; Add record to fax file
"RTN","XMFAX",22,0)
 S $P(^AKF("FAX",AKIEN,0),U,4)=1  ; This is a MailMan-generated fax
"RTN","XMFAX",23,0)
 Q
"RTN","XMFAX",24,0)
RECIPS(XMZ,XMFID,XMFIEN,XMCNT) ; Add recipients to fax record and update recipient record in mail msg.
"RTN","XMFAX",25,0)
 N I,XMREC,XMIENS,XMFDA
"RTN","XMFAX",26,0)
 S I="",XMCNT=0
"RTN","XMFAX",27,0)
 F  S I=$O(^XMB(3.9,XMZ,1,"AFAX",I)) Q:I=""  D
"RTN","XMFAX",28,0)
 . S XMREC=$G(^AKF("FAXR",I,0)) Q:XMREC=""
"RTN","XMFAX",29,0)
 . S XMCNT=XMCNT+1
"RTN","XMFAX",30,0)
 . S XMIENS="+1,"_XMFIEN_","
"RTN","XMFAX",31,0)
 . S XMFDA(589500.01,XMIENS,.01)=I ; Pointer to recipient
"RTN","XMFAX",32,0)
 . S XMFDA(589500.01,XMIENS,1)=$$EZBLD^DIALOG(39303.7) ;Awaiting Transmission Path
"RTN","XMFAX",33,0)
 . S XMFDA(589500.01,XMIENS,2)=$P(XMREC,U,2) ; Recipient fax phone
"RTN","XMFAX",34,0)
 . S XMFDA(589500.01,XMIENS,3)=$P(XMREC,U,3) ; Recipient physical location
"RTN","XMFAX",35,0)
 . S XMFDA(589500.01,XMIENS,4)=$P(XMREC,U,4) ; Recipient voice phone
"RTN","XMFAX",36,0)
 . D UPDATE^DIE("","XMFDA") ; Add recipient to fax record
"RTN","XMFAX",37,0)
 . S XMIENS=$O(^XMB(3.9,XMZ,1,"AFAX",I,""))_","_XMZ_","
"RTN","XMFAX",38,0)
 . S XMFDA(3.91,XMIENS,4)=$$NOW^XLFDT()    ; Current date/time
"RTN","XMFAX",39,0)
 . S XMFDA(3.91,XMIENS,5)="@"  ; get rid of status
"RTN","XMFAX",40,0)
 . S XMFDA(3.91,XMIENS,13)="@" ; get rid of xref
"RTN","XMFAX",41,0)
 . S XMFDA(3.91,XMIENS,14)=XMFID ; fax id
"RTN","XMFAX",42,0)
 . D FILE^DIE("","XMFDA") ; Update mail msg recipient
"RTN","XMFAX",43,0)
 Q
"RTN","XMFAX",44,0)
BODY(XMZ,XMFIEN) ; Copy the msg text to the fax text
"RTN","XMFAX",45,0)
 N XMTEXT,XMREC,I,XMDATE,XMFROM
"RTN","XMFAX",46,0)
 S XMREC=^XMB(3.9,XMZ,0)
"RTN","XMFAX",47,0)
 S I=1,XMTEXT(I)=$$EZBLD^DIALOG(34536,$P(XMREC,U,1))_"  "_$$EZBLD^DIALOG(34537,XMZ) ; Subj: |1|  [#|1|]
"RTN","XMFAX",48,0)
 S XMDATE=$$MMDT^XMXUTIL1($P(XMREC,U,3))
"RTN","XMFAX",49,0)
 I $L(XMTEXT(I))+$L(XMDATE)+1>79 S I=I+1,XMTEXT(I)=XMDATE
"RTN","XMFAX",50,0)
 E  S XMTEXT(I)=XMTEXT(I)_" "_XMDATE
"RTN","XMFAX",51,0)
 S I=I+1,XMTEXT(I)=$$EZBLD^DIALOG(39330,^XMB("NETNAME")) ;Site: |1|
"RTN","XMFAX",52,0)
 S I=I+1,XMTEXT(I)=$$EZBLD^DIALOG(34538,$$NAME^XMXUTIL($P(XMREC,U,2),1)) ; From: |1|
"RTN","XMFAX",53,0)
 I DUZ'=$P(XMREC,U,2) S I=I+1,XMTEXT(I)=$$EZBLD^DIALOG(39331,$$NAME^XMXUTIL(DUZ,1)) ;Sender: |1|
"RTN","XMFAX",54,0)
 S I=I+1,XMTEXT(I)="-------------------------------------------------------------------------------"
"RTN","XMFAX",55,0)
 S I=I+1,XMTEXT(I)=""
"RTN","XMFAX",56,0)
 D WP^DIE(589500,XMFIEN_",",7,"","XMTEXT")
"RTN","XMFAX",57,0)
 D WP^DIE(589500,XMFIEN_",",7,"A","^XMB(3.9,"_XMZ_",2)")
"RTN","XMFAX",58,0)
 Q 
"RTN","XMFAX",59,0)
SENDFAX(AKQ,AKIEN,AKML) ;
"RTN","XMFAX",60,0)
 W !,$$EZBLD^DIALOG(39332) ;Sending to fax
"RTN","XMFAX",61,0)
 D QUE^AKFAX0
"RTN","XMFAX",62,0)
 Q
"RTN","XMFAX",63,0)
FAXHDR(XMFID,XMFTO) ; Print the fax header
"RTN","XMFAX",64,0)
 W !,$$EZBLD^DIALOG(39333,XMFTO) ;MailMan FAX for |1|
"RTN","XMFAX",65,0)
 N XMPARM S XMPARM(1)=XMFID,XMPARM(2)=$$FMTE^XLFDT($$NOW^XLFDT,5)
"RTN","XMFAX",66,0)
 W !,$$EZBLD^DIALOG(39334,.XMPARM),! ;FAXmail ID: |1|, Faxed: |2|
"RTN","XMFAX",67,0)
 Q
"RTN","XMGAPI0")
0^272^B3801409
"RTN","XMGAPI0",1,0)
XMGAPI0 ;(WASH ISC)/CAP-Validate/Get Subject APIs ;04/17/2002  08:56
"RTN","XMGAPI0",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMGAPI0",3,0)
 ; Entry points (DBIA 1142):
"RTN","XMGAPI0",4,0)
 ; $$SUBCHK - Validate a proposed message subject
"RTN","XMGAPI0",5,0)
 ; $$SUBGET - Retrieve the subject of a message
"RTN","XMGAPI0",6,0)
ENT(Y,Z) ;Check Input Subject
"RTN","XMGAPI0",7,0)
 ;Param1=String
"RTN","XMGAPI0",8,0)
 ;Param2=Silent Flag
"RTN","XMGAPI0",9,0)
 N A S A=""
"RTN","XMGAPI0",10,0)
 I $L(Y)>65 S A=1,%="Entered SUBJECT too long, "_$L($E(Y,66,999))_" characters longer than 65." S Y=$E(Y,1,250) G S:Z Q "3-"_%_U_$E(Y,1,65)
"RTN","XMGAPI0",11,0)
 ;
"RTN","XMGAPI0",12,0)
 I Y[U S Y=$$ENCODEUP^XMCU1(Y)
"RTN","XMGAPI0",13,0)
 ;
"RTN","XMGAPI0",14,0)
 ;REMOVE LEADING BLANKS
"RTN","XMGAPI0",15,0)
B I Y?1" ".E S Y=$E(Y,2,99) G B
"RTN","XMGAPI0",16,0)
 ;
"RTN","XMGAPI0",17,0)
 ;REMOVE TRAILING BLANKS
"RTN","XMGAPI0",18,0)
E I $E(Y,$L(Y))=" " S Y=$E(Y,1,$L(Y)-1) G E
"RTN","XMGAPI0",19,0)
 ;
"RTN","XMGAPI0",20,0)
 G U:Y'?.E1C.E I 'Z Q "5-Subject cannot contain control characters.^"_Y
"RTN","XMGAPI0",21,0)
 F X=1:1 I $E(Y,X)?1C S Y=$E(Y,1,X-1)_$E(Y,X+1,99) Q:Y'?.E1C.E  S X=X-1
"RTN","XMGAPI0",22,0)
 W $C(7),!,"Control characters removed ("""_Y_""" is Subject accepted).",!
"RTN","XMGAPI0",23,0)
 ;
"RTN","XMGAPI0",24,0)
U I Y="" Q ""
"RTN","XMGAPI0",25,0)
 I Y="?" S A=1,%="Enter a Message Subject, between 3 & 65 characters long or '^' to exit." G S:Z Q "4-"_%_U_Y
"RTN","XMGAPI0",26,0)
 I $L(Y)<3 S A=1,%="SUBJECT must be at least 3 characters long." G S:Z Q "1-"_%_U_Y
"RTN","XMGAPI0",27,0)
 I Y?1"R"2N.N S A=1,%="Subject names of this format (1""R""1.N) are RESERVED" G S:Z Q "2-"_%_U_Y
"RTN","XMGAPI0",28,0)
Q Q A_U_Y
"RTN","XMGAPI0",29,0)
S W !,$C(7),%,!
"RTN","XMGAPI0",30,0)
 G Q
"RTN","XMGAPI0",31,0)
SUBGET(X) ;Return Subject of a Message (""=Error, Else returns Subject)
"RTN","XMGAPI0",32,0)
 S X=$P($G(^XMB(3.9,X,0)),U) I X="" Q ""
"RTN","XMGAPI0",33,0)
 Q $$DECODEUP^XMCU1(X)
"RTN","XMGAPI0",34,0)
SUBCHK(X,Z) ;Check Subject (""=Error, Else returns Subject)
"RTN","XMGAPI0",35,0)
 ;Param1=String
"RTN","XMGAPI0",36,0)
 ;Param2=Silent Flag (0=Silent, 1=Verbose)
"RTN","XMGAPI0",37,0)
 N Y S Y=X
"RTN","XMGAPI0",38,0)
 Q $$ENT(X,Z)
"RTN","XMGAPI1")
0^29^B32088
"RTN","XMGAPI1",1,0)
XMGAPI1 ;(WASH ISC)/CAP-Get next line of a message API ;04/17/2002  09:28
"RTN","XMGAPI1",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMGAPI1",3,0)
 ; Entry points (DBIA 1048):
"RTN","XMGAPI1",4,0)
 ; $$READ - Returns next line of a message
"RTN","XMGAPI1",5,0)
 ; See REC^XMS3 for more info.
"RTN","XMGAPI1",6,0)
READ() D REC^XMS3 Q XMRG
"RTN","XMGAPI2")
0^273^B11238816
"RTN","XMGAPI2",1,0)
XMGAPI2 ;(WASH ISC)/JKL-Get Msg Header Info API ;04/17/2002  08:57
"RTN","XMGAPI2",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMGAPI2",3,0)
 ; Entry points (DBIA 1144):
"RTN","XMGAPI2",4,0)
 ; $$HDR  Get message header information
"RTN","XMGAPI2",5,0)
 ;
"RTN","XMGAPI2",6,0)
 ;USAGE:  S X=$$HDR^XMGAPI2(A,.B,C)
"RTN","XMGAPI2",7,0)
 ;WHERE: A=message or response #
"RTN","XMGAPI2",8,0)
 ;      .B=array into which data is placed
"RTN","XMGAPI2",9,0)
 ;       C=flag that determines what data is returned as follows:
"RTN","XMGAPI2",10,0)
 ;Not defined or 0 = returns a function value of 0 if successful, an
"RTN","XMGAPI2",11,0)
 ;   error message if unsuccessful, and a value array:
"RTN","XMGAPI2",12,0)
 ;   L("BROADCAST")= 1 if the message was broadcast; 0 otherwise
"RTN","XMGAPI2",13,0)
 ;   L("BSKT") = basket (of local user)
"RTN","XMGAPI2",14,0)
 ;   L("BSKT IEN") = basket IEN (of local user)
"RTN","XMGAPI2",15,0)
 ;   L("DATE") = origination date
"RTN","XMGAPI2",16,0)
 ;   L("DATE FM") = origination date in FileMan format
"RTN","XMGAPI2",17,0)
 ;   L("LINES") = number of lines in the original message
"RTN","XMGAPI2",18,0)
 ;   L("NEW") = 1 if the message is new; 0 otherwise
"RTN","XMGAPI2",19,0)
 ;   L("PXMZ") = pointer to the original message
"RTN","XMGAPI2",20,0)
 ;   L("SENDER") = sender name
"RTN","XMGAPI2",21,0)
 ;   L("SENDER DUZ") = sender DUZ
"RTN","XMGAPI2",22,0)
 ;   L("SUBJ") = subject
"RTN","XMGAPI2",23,0)
 ;   L("SURROG") = surrogate (DUZ if local user or string if not)
"RTN","XMGAPI2",24,0)
 ;   L("TYPE") = message type(s)
"RTN","XMGAPI2",25,0)
 ;   L("XMZ") = message or response number
"RTN","XMGAPI2",26,0)
 ;1 = returns function value and value array above, also
"RTN","XMGAPI2",27,0)
 ;    additional value array as follows:
"RTN","XMGAPI2",28,0)
 ;   L("RRED") = responses read
"RTN","XMGAPI2",29,0)
 ;   L("RRCV") = responses received
"RTN","XMGAPI2",30,0)
 ;   L("BLOBCNT") = number of non-textual body parts attached
"RTN","XMGAPI2",31,0)
 ;91= returns function value, value array as with flag 1,
"RTN","XMGAPI2",32,0)
 ;    and an array of response nodes and values as follows:
"RTN","XMGAPI2",33,0)
 ;   L("RSP",counter)= (pointer to 3.9 file) / array of responses
"RTN","XMGAPI2",34,0)
 ;92= returns function value, value array as with flag 1,
"RTN","XMGAPI2",35,0)
 ;    and an array of non-textual body parts as follows:
"RTN","XMGAPI2",36,0)
 ;   L("BLOB",counter) = (pointer to 2005 file) array of BLOBS
"RTN","XMGAPI2",37,0)
 ;93= returns function value, value array as with flag 1,
"RTN","XMGAPI2",38,0)
 ;    response node array, and an array of non-textual body parts.
"RTN","XMGAPI2",39,0)
HDR(XMZ,L,F) ;Entry for non-MailMan (documented)
"RTN","XMGAPI2",40,0)
GO N %,%0,D,XMBCAST
"RTN","XMGAPI2",41,0)
 S %=$G(XMZ) I +%'=%!(%<1) S %="1-Undefined message number" G ERR
"RTN","XMGAPI2",42,0)
 I XMZ="" S %="1-No message number" G ERR
"RTN","XMGAPI2",43,0)
 S %0=$G(^XMB(3.9,XMZ,0)) I %0="" S %="1-No such message" G ERR
"RTN","XMGAPI2",44,0)
 S D=$S($G(XMDUZ):XMDUZ,1:DUZ)
"RTN","XMGAPI2",45,0)
 I $S(+D'=D:1,D'>0:1,'$D(^XMB(3.7,D,0)):1,1:0) S %="4-Invalid user" G ERR
"RTN","XMGAPI2",46,0)
 S %=$P(%0,U,8),%=$S(%:%,1:XMZ)
"RTN","XMGAPI2",47,0)
 S XMBCAST=$S($D(^XMB(3.9,%,1,"C","* (Broadcast to all local users)")):1,$D(^XMB(3.9,%,1,"C","* (Broadcast to all local user")):1,1:0)
"RTN","XMGAPI2",48,0)
 I $S($P(%0,U,2)=D:0,$D(^XMB(3.9,%,1,"C",D)):0,XMBCAST:0,1:1) S %="2-User is not a sender or recipient." G ERR
"RTN","XMGAPI2",49,0)
 I $G(F)=""!'$G(F) S F=0   ;Default FLAG
"RTN","XMGAPI2",50,0)
 N %1,%2,XMK
"RTN","XMGAPI2",51,0)
 S %1=$$NET^XMRENT(XMZ)    ;get message information
"RTN","XMGAPI2",52,0)
 I %1="" S %="4-Message not defined" G ERR
"RTN","XMGAPI2",53,0)
 S L("BROADCAST")=XMBCAST
"RTN","XMGAPI2",54,0)
 S L("XMZ")=XMZ            ;set message number into array
"RTN","XMGAPI2",55,0)
 S L("DATE")=$P(%1,U)      ;get origination date
"RTN","XMGAPI2",56,0)
 S %2=$P(%0,U,3)
"RTN","XMGAPI2",57,0)
 S L("DATE FM")=$S(%2?7N1".".N:%2,%2?7N:%2,1:$$CONVERT^XMXUTIL1(%2))
"RTN","XMGAPI2",58,0)
 S:L("DATE FM")<2000000 L("DATE FM")=""
"RTN","XMGAPI2",59,0)
 S L("SENDER")=$P(%1,U,3)  ;get sender
"RTN","XMGAPI2",60,0)
 S L("SENDER DUZ")=$S($P(%0,U,2):$P(%0,U,2),1:"")
"RTN","XMGAPI2",61,0)
 S L("PXMZ")=$P(%1,U,7)    ;get pointer to original message
"RTN","XMGAPI2",62,0)
 S L("TYPE")=$P(%1,U,8)    ;Message Type(s)
"RTN","XMGAPI2",63,0)
 ;get number of message lines
"RTN","XMGAPI2",64,0)
 S L("LINES")=$S($D(^XMB(3.9,XMZ,2,0)):$P(^(0),U,4),1:"")
"RTN","XMGAPI2",65,0)
 S L("SUBJ")=$P(%1,U,6)    ;get subject
"RTN","XMGAPI2",66,0)
 S L("SURROG")=$P(%1,U,5)  ;get surrogate
"RTN","XMGAPI2",67,0)
 S XMK=$O(^XMB(3.7,"M",XMZ,D,0))  ;get basket
"RTN","XMGAPI2",68,0)
 I XMK,$D(^XMB(3.7,D,2,XMK,0)) D
"RTN","XMGAPI2",69,0)
 . S L("BSKT")=$P(^(0),U)
"RTN","XMGAPI2",70,0)
 . S L("BSKT IEN")=XMK
"RTN","XMGAPI2",71,0)
 E  D
"RTN","XMGAPI2",72,0)
 . S L("BSKT")=""
"RTN","XMGAPI2",73,0)
 . S L("BSKT IEN")=""
"RTN","XMGAPI2",74,0)
 I $G(XMK) S L("NEW")=$S($D(^XMB(3.7,D,"N0",XMK,XMZ)):1,1:0)
"RTN","XMGAPI2",75,0)
 G Q:F=0
"RTN","XMGAPI2",76,0)
 ;get responses read/received
"RTN","XMGAPI2",77,0)
 S L("RRED")="",L("RRCV")="",%1=$O(^XMB(3.9,XMZ,1,"C",D,0))
"RTN","XMGAPI2",78,0)
 I %1 S L("RRED")=$P(^XMB(3.9,XMZ,1,%1,0),U,2)
"RTN","XMGAPI2",79,0)
 I $D(^XMB(3.9,XMZ,3,0)) S L("RRCV")=$P(^(0),U,4)
"RTN","XMGAPI2",80,0)
 S L("BLOBCNT")=0          ;get blob count
"RTN","XMGAPI2",81,0)
 I $D(^XMB(3.9,XMZ,2005,0)) S L("BLOBCNT")=$P(^(0),U,3)
"RTN","XMGAPI2",82,0)
 G Q:F=1,BLOB:F=92
"RTN","XMGAPI2",83,0)
 ;flag=91 - get response numbers and values
"RTN","XMGAPI2",84,0)
 S %1=0 F  S %1=$O(^XMB(3.9,XMZ,3,%1)) Q:'%1  S L("RSP",%1)=^(%1,0)
"RTN","XMGAPI2",85,0)
 I F=91 G Q
"RTN","XMGAPI2",86,0)
 ;flag=92 - get nodes and values of non-textual body parts
"RTN","XMGAPI2",87,0)
BLOB S %1=0 F  S %1=$O(^XMB(3.9,XMZ,2005,%1)) Q:'%1  S L("BLOB",%1)=^(%1,0)
"RTN","XMGAPI2",88,0)
Q Q 0
"RTN","XMGAPI2",89,0)
ERR Q %
"RTN","XMGAPI3")
0^274^B5982411
"RTN","XMGAPI3",1,0)
XMGAPI3 ;WASH ISC/REW/LH-Deliver Broadcast Msg & Mark for Vaporization ;04/17/2002  08:59
"RTN","XMGAPI3",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMGAPI3",3,0)
 ; Entry points used by MailMan options (not covered by DBIA):
"RTN","XMGAPI3",4,0)
 ; ENT    XMR-BROADCAST-VA-WIDE
"RTN","XMGAPI3",5,0)
 ; ENT    XMYB-BROADCAST-VA-WIDE
"RTN","XMGAPI3",6,0)
ENT(XMTO) ; Meant to be invoked by a server.  Delivers a message
"RTN","XMGAPI3",7,0)
 ; either to all users or to a specific user.
"RTN","XMGAPI3",8,0)
 ; The message must have been sent by the POSTMASTER@FORUM.VA.GOV.
"RTN","XMGAPI3",9,0)
 ; The AUTOMATIC DELETE DATE for this message is set for each user
"RTN","XMGAPI3",10,0)
 ; to be in 7 days; 30 days if sent to a specific user.
"RTN","XMGAPI3",11,0)
 ; The message is made 'information only' and 'closed'.
"RTN","XMGAPI3",12,0)
 ; XMTO   *=to all users
"RTN","XMGAPI3",13,0)
 ;        DUZ=to only one person -- typically .6 to route to SHARED,MAIL
"RTN","XMGAPI3",14,0)
 ; Variables set in the server invoker:
"RTN","XMGAPI3",15,0)
 ; XQSOP  Server basket name
"RTN","XMGAPI3",16,0)
 ; XQMSG  Message number
"RTN","XMGAPI3",17,0)
 ; XMFROM Who sent the message
"RTN","XMGAPI3",18,0)
 N XMDUZ,XMKN
"RTN","XMGAPI3",19,0)
 S (XMDUZ,DUZ)=.5
"RTN","XMGAPI3",20,0)
 S XMKN="S."_XQSOP
"RTN","XMGAPI3",21,0)
 I $P(XMFROM,"@")'["POSTMASTER"!($P(XMFROM,"@",2)'["FORUM.") D
"RTN","XMGAPI3",22,0)
 . D ERR1(XMDUZ,XMKN,XMFROM)
"RTN","XMGAPI3",23,0)
 E  D
"RTN","XMGAPI3",24,0)
 . D SEND(XMDUZ,XMKN,XQMSG,XMTO,XMFROM)
"RTN","XMGAPI3",25,0)
 D CLEANUP(XMKN,XQMSG)
"RTN","XMGAPI3",26,0)
 Q
"RTN","XMGAPI3",27,0)
SEND(XMDUZ,XMKN,XMZ,XMTO,XMFROM) ;
"RTN","XMGAPI3",28,0)
 K XMERR,^TMP("XMERR",$J)
"RTN","XMGAPI3",29,0)
 D INIT^XMXADDR
"RTN","XMGAPI3",30,0)
 D CHKADDR^XMXADDR(XMDUZ,XMTO)
"RTN","XMGAPI3",31,0)
 I $D(XMERR) D  Q
"RTN","XMGAPI3",32,0)
 . D ERR2(XMDUZ,XMKN,XMTO,XMFROM)
"RTN","XMGAPI3",33,0)
 . K XMERR,^TMP("XMERR",$J)
"RTN","XMGAPI3",34,0)
 D FORCE(XMZ,$S(XMTO="*":7,1:30))
"RTN","XMGAPI3",35,0)
 D SEND^XMKP(XMDUZ,XMZ)
"RTN","XMGAPI3",36,0)
 Q
"RTN","XMGAPI3",37,0)
FORCE(DA,XMDAYS) ; Set Info Only, Closed statuses, and Purge date
"RTN","XMGAPI3",38,0)
 N DIE,DR
"RTN","XMGAPI3",39,0)
 S DIE=3.9,DR="1.95///y;1.97///y;1.6///"_$$FMADD^XLFDT(DT,XMDAYS)
"RTN","XMGAPI3",40,0)
 D ^DIE
"RTN","XMGAPI3",41,0)
 Q
"RTN","XMGAPI3",42,0)
CLEANUP(XMKN,XMZ) ; Successfully delivered message, so remove from Postmaster Server Basket
"RTN","XMGAPI3",43,0)
 D CLEANUP^XMXADDR
"RTN","XMGAPI3",44,0)
 D ZAPSERV^XMXMSGS1(XMKN,XMZ)
"RTN","XMGAPI3",45,0)
 Q
"RTN","XMGAPI3",46,0)
ERR1(XMDUZ,XMKN,XMFROM) ; Send message back to sender if not POSTMASTER@FORUM
"RTN","XMGAPI3",47,0)
 N A
"RTN","XMGAPI3",48,0)
 S A(1)="You may not send a message to the "_XMKN_" server."
"RTN","XMGAPI3",49,0)
 S A(2)="Only the Postmaster at FORUM.VA.GOV has this permission."
"RTN","XMGAPI3",50,0)
 D SENDMSG^XMXSEND(XMDUZ,"Sender of Message to Server Unacceptable","A",XMFROM)
"RTN","XMGAPI3",51,0)
 K XMERR,^TMP("XMERR",$J)
"RTN","XMGAPI3",52,0)
 Q
"RTN","XMGAPI3",53,0)
ERR2(XMDUZ,XMKN,XMTO,XMFROM) ; Send a message back to sender if single recipient is invalid
"RTN","XMGAPI3",54,0)
 N A,I,J
"RTN","XMGAPI3",55,0)
 S A(1)="Your message to the "_XMKN_" server was not accepted"
"RTN","XMGAPI3",56,0)
 S A(2)="because the lookup for the recipient specified ("_XMTO_")"
"RTN","XMGAPI3",57,0)
 S A(3)="failed, with the following message:"
"RTN","XMGAPI3",58,0)
 S J=3,I=0
"RTN","XMGAPI3",59,0)
 F  S I=$O(^TMP("XMERR",$J,XMERR,"TEXT",I)) Q:'I  S J=J+1,A(J)=^(I)
"RTN","XMGAPI3",60,0)
 D SENDMSG^XMXSEND(XMDUZ,"Server Recipient Unknown","A",XMFROM)
"RTN","XMGAPI3",61,0)
 K XMERR,^TMP("XMERR",$J)
"RTN","XMGAPI3",62,0)
 Q
"RTN","XMGAPI4")
0^275^B13644447
"RTN","XMGAPI4",1,0)
XMGAPI4 ;(WASH ISC)/CAP-Get New Msg Info ;04/17/2002  09:01
"RTN","XMGAPI4",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMGAPI4",3,0)
 ; Entry points (DBIA 1201 - Private!):
"RTN","XMGAPI4",4,0)
 ; $$NU   Get new message info
"RTN","XMGAPI4",5,0)
NU(XMFORCE,XMMOVE,XMOUT) ;API for new message display
"RTN","XMGAPI4",6,0)
 ;Usage:  S X=$$NU^XMGAPI4(1) = Display on screen
"RTN","XMGAPI4",7,0)
 ;        S X=$$NU^XMGAPI4(0) = Do not display
"RTN","XMGAPI4",8,0)
 ;        S X=$$NU^XMGAPI4(1,1,"ABC") Return displayable array "ABC"
"RTN","XMGAPI4",9,0)
 ;
"RTN","XMGAPI4",10,0)
 ;Inputs:  DUZ must exist
"RTN","XMGAPI4",11,0)
 ;         XMDUZ will exist if the context is in MailMan
"RTN","XMGAPI4",12,0)
 ;
"RTN","XMGAPI4",13,0)
 ;XMFORCE=1 to force new display
"RTN","XMGAPI4",14,0)
 ;       =0 for no display
"RTN","XMGAPI4",15,0)
 ;XMMOVE =1 will cause an array to be passed back in array XMOUT,
"RTN","XMGAPI4",16,0)
 ;          which should be passed in by value (as a quoted string).
"RTN","XMGAPI4",17,0)
 N XMARRAY,XMI,XMNEW
"RTN","XMGAPI4",18,0)
 D CHKMASTR($G(XMDUZ,DUZ),XMFORCE,.XMNEW,.XMARRAY,.XMI)
"RTN","XMGAPI4",19,0)
 I $G(XMMOVE),$G(XMOUT)?1.AN S XMARRAY=+$G(XMI) M @XMOUT=XMARRAY Q XMNEW
"RTN","XMGAPI4",20,0)
 ;Return values or write
"RTN","XMGAPI4",21,0)
 I XMFORCE S XMI=0 F  S XMI=$O(XMARRAY(XMI)) Q:'XMI  W !,XMARRAY(XMI)
"RTN","XMGAPI4",22,0)
 Q XMNEW
"RTN","XMGAPI4",23,0)
CHK ; Sets Y = number of new messages for the user.
"RTN","XMGAPI4",24,0)
 S:$G(XMDUZ)'=.6 Y=$$TNMSGCT^XMXUTIL($G(XMDUZ,DUZ))
"RTN","XMGAPI4",25,0)
 D CLEANUP^XMXADDR
"RTN","XMGAPI4",26,0)
 Q
"RTN","XMGAPI4",27,0)
CHKMASTR(XMUSER,XMFORCE,XMNEW,XMARRAY,XMI) ;
"RTN","XMGAPI4",28,0)
 D CHKUSER(XMUSER,XMFORCE,.XMNEW,.XMARRAY,.XMI)
"RTN","XMGAPI4",29,0)
 D CHKPRI(XMUSER,.XMARRAY,.XMI)
"RTN","XMGAPI4",30,0)
 Q:XMUSER=.5!'XMFORCE!'$D(^XMB(3.7,"AB",XMUSER,.5))
"RTN","XMGAPI4",31,0)
 Q:'$$TNMSGCT^XMXUTIL(.5)
"RTN","XMGAPI4",32,0)
 S XMI=$G(XMI)+1,XMARRAY(XMI)=""
"RTN","XMGAPI4",33,0)
 S XMI=XMI+1,XMARRAY(XMI)=$$EZBLD^DIALOG(38162) ; Checking POSTMASTER mailbox.
"RTN","XMGAPI4",34,0)
 D CHKUSER(.5,XMFORCE,.XMNEW,.XMARRAY,.XMI)
"RTN","XMGAPI4",35,0)
 Q
"RTN","XMGAPI4",36,0)
CHKUSER(XMUSER,XMFORCE,XMNEW,XMARRAY,XMI) ;
"RTN","XMGAPI4",37,0)
 I '$D(^XMB(3.7,XMUSER,0)) S XMNEW=0 Q
"RTN","XMGAPI4",38,0)
 N XMREC,XMPARM
"RTN","XMGAPI4",39,0)
 S XMREC=$$NEWS^XMXUTIL(XMUSER,$D(DUZ("SAV")))
"RTN","XMGAPI4",40,0)
 S XMNEW=$P(XMREC,U,1)  ; new messages
"RTN","XMGAPI4",41,0)
 Q:'XMFORCE!'XMNEW
"RTN","XMGAPI4",42,0)
 S XMPARM(1)=$P(XMREC,U,1) S:XMUSER=.5 XMPARM(2)=$$NAME^XMXUTIL(.5)
"RTN","XMGAPI4",43,0)
 S XMI=$G(XMI)+1,XMARRAY(XMI)=$$EZBLD^DIALOG($S(XMUSER=DUZ:38155,1:38156)+$S(XMPARM(1)>1:0,'XMPARM(1):.2,1:.1),.XMPARM) ; You have/|2| has |1|/no new message(s).
"RTN","XMGAPI4",44,0)
 I $P(XMREC,U,6) D  ; new messages in the default read (usually IN) basket.
"RTN","XMGAPI4",45,0)
 . S XMPARM(1)=$P(XMREC,U,6),XMPARM(2)=$P(XMREC,U,8)
"RTN","XMGAPI4",46,0)
 . S XMARRAY(XMI)=XMARRAY(XMI)_$$EZBLD^DIALOG(38157,.XMPARM) ; (|1| in the '|2|' basket)
"RTN","XMGAPI4",47,0)
 I $P(XMREC,U,5) D  ; if last arrival > latest notification...
"RTN","XMGAPI4",48,0)
 . S XMI=XMI+1,XMARRAY(XMI)=$$EZBLD^DIALOG(38158,$$MMDT^XMXUTIL1($P(XMREC,U,4))) ; (Last arrival: |1|)"
"RTN","XMGAPI4",49,0)
 Q:XMUSER=.5
"RTN","XMGAPI4",50,0)
 S XMI=XMI+1,XMARRAY(XMI)=""
"RTN","XMGAPI4",51,0)
 S XMI=XMI+1,XMARRAY(XMI)=$$EZBLD^DIALOG(38161) ; Enter '^NML' to read your new messages.
"RTN","XMGAPI4",52,0)
 Q
"RTN","XMGAPI4",53,0)
CHKPRI(XMUSER,XMARRAY,XMI) ;
"RTN","XMGAPI4",54,0)
 Q:'$D(^XMB(3.7,XMUSER,"N"))
"RTN","XMGAPI4",55,0)
 I '$D(IORVON) N IORVON,IORVOFF,IOBON,IOBOFF D ZIS^XM
"RTN","XMGAPI4",56,0)
 S XMI=$G(XMI)+1,XMARRAY(XMI)=$G(IORVON)_$$EZBLD^DIALOG(38159)_$G(IORVOFF) ; You've got PRIORITY mail!
"RTN","XMGAPI4",57,0)
 Q
"RTN","XMGAPI4",58,0)
 ; >>>> I don't think anything after here is used. <<<<
"RTN","XMGAPI4",59,0)
LST(A,X,Y) ;List NEW message (or any other) array
"RTN","XMGAPI4",60,0)
 ; A=Array to list
"RTN","XMGAPI4",61,0)
 ; X=X address of box
"RTN","XMGAPI4",62,0)
 ; Y=Y address of box
"RTN","XMGAPI4",63,0)
 N I,S
"RTN","XMGAPI4",64,0)
 S I="",$P(S," ",IOM+1)=""
"RTN","XMGAPI4",65,0)
 F  S I=$O(A(I)) Q:I=""  D
"RTN","XMGAPI4",66,0)
 . I $G(X) S DX=X,DY=Y X IOXY
"RTN","XMGAPI4",67,0)
 . E  W !
"RTN","XMGAPI4",68,0)
 . W $E(A(I)_S,1,IOM-$G(X))
"RTN","XMGAPI4",69,0)
 . I $D(Y) S Y=Y+1
"RTN","XMGAPI4",70,0)
 Q
"RTN","XMGAPI4",71,0)
PRIALRT ; Priority Mail Alert
"RTN","XMGAPI4",72,0)
 N XQAID
"RTN","XMGAPI4",73,0)
 S XQAID="XM-PRIOMESS" D ALERT
"RTN","XMGAPI4",74,0)
 I '$D(XMDUZ) N XMDUZ S XMDUZ=DUZ
"RTN","XMGAPI4",75,0)
 W !,"Select new PRIORITY messages (one at a time) from the list given."
"RTN","XMGAPI4",76,0)
 D INIT^XMVVITAE
"RTN","XMGAPI4",77,0)
 D LISTALL^XMJMLN(XMDUZ,"N")
"RTN","XMGAPI4",78,0)
 Q
"RTN","XMGAPI4",79,0)
NEWALRT ; Alert for NEW Mail
"RTN","XMGAPI4",80,0)
 N XQAID
"RTN","XMGAPI4",81,0)
 S XQAID="XM-NEWMESS" D ALERT
"RTN","XMGAPI4",82,0)
 I '$D(XMDUZ) N XMDUZ S XMDUZ=DUZ
"RTN","XMGAPI4",83,0)
 W !,"Select NEW messages (one at a time) from the list given."
"RTN","XMGAPI4",84,0)
 D INIT^XMVVITAE
"RTN","XMGAPI4",85,0)
 D LISTALL^XMJMLN(XMDUZ,"N0")
"RTN","XMGAPI4",86,0)
 Q
"RTN","XMGAPI4",87,0)
ALERT ;
"RTN","XMGAPI4",88,0)
 N X,XQAKILL
"RTN","XMGAPI4",89,0)
 S X=$$NU(1,1,"X")
"RTN","XMGAPI4",90,0)
 D LST(.X)
"RTN","XMGAPI4",91,0)
 S XQA($S($G(XMDUZ):XMDUZ,1:DUZ))="",XQAKILL=1
"RTN","XMGAPI4",92,0)
 D DELETEA^XQALERT
"RTN","XMGAPI4",93,0)
 Q
"RTN","XMHIG")
0^30^B30287826
"RTN","XMHIG",1,0)
XMHIG ;ISC-SF/GMB-Mail Group Info ;04/19/2002  10:52
"RTN","XMHIG",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMHIG",3,0)
 ; Replaces ENTQ^XMA5,GHELP^XMA7G (ISC-WASH/THM/CAP/RJ)
"RTN","XMHIG",4,0)
 ;
"RTN","XMHIG",5,0)
 ; Entry points used by MailMan options (not covered by DBIA):
"RTN","XMHIG",6,0)
 ; HELP      XMHELPGROUP - Get info on a group
"RTN","XMHIG",7,0)
HELP ; Group Info
"RTN","XMHIG",8,0)
 N DIC,Y
"RTN","XMHIG",9,0)
 D CHECK^XMVVITAE
"RTN","XMHIG",10,0)
 S DIC="^XMB(3.8,",DIC(0)="AEQMZ"
"RTN","XMHIG",11,0)
 ; Screen:  Group is public OR user is organizer OR user is member
"RTN","XMHIG",12,0)
 S DIC("S")="I $P(^(0),U,2)=""PU""!($G(^(3))=XMDUZ)!($D(^(1,""B"",XMDUZ)))"
"RTN","XMHIG",13,0)
 F  W ! D ^DIC Q:Y<0  D
"RTN","XMHIG",14,0)
 . D DISPLAY(+Y)
"RTN","XMHIG",15,0)
 Q
"RTN","XMHIG",16,0)
DISPLAY(XMGIEN) ;
"RTN","XMHIG",17,0)
 N XMABORT
"RTN","XMHIG",18,0)
 S XMABORT=0
"RTN","XMHIG",19,0)
 W @IOF
"RTN","XMHIG",20,0)
 D FIELDS(XMGIEN)
"RTN","XMHIG",21,0)
 D AUTHSEND(XMGIEN,.XMABORT) Q:XMABORT
"RTN","XMHIG",22,0)
 D MEMBERS(XMGIEN,.XMABORT) Q:XMABORT
"RTN","XMHIG",23,0)
 D GROUP(XMGIEN,.XMABORT) Q:XMABORT
"RTN","XMHIG",24,0)
 D REMOTE(XMGIEN,.XMABORT) Q:XMABORT
"RTN","XMHIG",25,0)
 D DISTR(XMGIEN,.XMABORT) Q:XMABORT
"RTN","XMHIG",26,0)
 D FAXMEMBR(XMGIEN,.XMABORT) Q:XMABORT
"RTN","XMHIG",27,0)
 D FAXGROUP(XMGIEN,.XMABORT) Q:XMABORT
"RTN","XMHIG",28,0)
 D MEMBEROF(XMGIEN,.XMABORT) Q:XMABORT
"RTN","XMHIG",29,0)
 Q
"RTN","XMHIG",30,0)
FIELDS(DA) ;
"RTN","XMHIG",31,0)
 N DIC,DR
"RTN","XMHIG",32,0)
 S DIC="^XMB(3.8,"
"RTN","XMHIG",33,0)
 F DR=0,2,3 D EN^DIQ
"RTN","XMHIG",34,0)
 Q
"RTN","XMHIG",35,0)
AUTHSEND(XMGIEN,XMABORT) ;
"RTN","XMHIG",36,0)
 Q:'$O(^XMB(3.8,XMGIEN,4,0))
"RTN","XMHIG",37,0)
 N XMI,XMMIEN
"RTN","XMHIG",38,0)
 S XMI=0
"RTN","XMHIG",39,0)
 F  S XMI=$O(^XMB(3.8,XMGIEN,4,XMI)) Q:XMI'>0  D  Q:XMABORT
"RTN","XMHIG",40,0)
 . I $Y+3>IOSL D PAGE(.XMABORT) Q:XMABORT
"RTN","XMHIG",41,0)
 . S XMMIEN=$P(^XMB(3.8,XMGIEN,4,XMI,0),U)
"RTN","XMHIG",42,0)
 . I '$D(^VA(200,XMMIEN,0)) D DELETE(XMGIEN,4,XMI) Q
"RTN","XMHIG",43,0)
 . W !,$$EZBLD^DIALOG(39089),$$NAME^XMXUTIL(XMMIEN) ;Authorized Sender:
"RTN","XMHIG",44,0)
 Q
"RTN","XMHIG",45,0)
MEMBERS(XMGIEN,XMABORT) ;
"RTN","XMHIG",46,0)
 Q:'$O(^XMB(3.8,XMGIEN,1,0))
"RTN","XMHIG",47,0)
 N XMI,XMMIEN,XMNAME,XMTITLE,XMREC,XMINST,XMTYPE
"RTN","XMHIG",48,0)
 I $Y+5>IOSL D  Q:XMABORT
"RTN","XMHIG",49,0)
 . D PAGE(.XMABORT)
"RTN","XMHIG",50,0)
 E  W !!
"RTN","XMHIG",51,0)
 D HEADER
"RTN","XMHIG",52,0)
 S XMI=0
"RTN","XMHIG",53,0)
 F  S XMI=$O(^XMB(3.8,XMGIEN,1,XMI)) Q:XMI'>0  D  Q:XMABORT
"RTN","XMHIG",54,0)
 . I $Y+3>IOSL D PAGE(.XMABORT,1) Q:XMABORT
"RTN","XMHIG",55,0)
 . S XMREC=^XMB(3.8,XMGIEN,1,XMI,0)
"RTN","XMHIG",56,0)
 . S XMMIEN=$P(XMREC,U)
"RTN","XMHIG",57,0)
 . S XMTYPE=$P(XMREC,U,2)
"RTN","XMHIG",58,0)
 . I '$D(^VA(200,XMMIEN,0)) D DELETE(XMGIEN,1,XMI) Q
"RTN","XMHIG",59,0)
 . S XMNAME=$$NAME^XMXUTIL(XMMIEN,1)
"RTN","XMHIG",60,0)
 . I XMTYPE'="" S XMNAME=XMTYPE_":"_XMNAME
"RTN","XMHIG",61,0)
 . W !,$E(XMNAME,1,44),?45,$S($D(^XMB(3.7,XMMIEN,"L")):$E($P(^("L"),U),1,35),1:$$EZBLD^DIALOG(38007)) ;Never Used MailMan
"RTN","XMHIG",62,0)
 Q
"RTN","XMHIG",63,0)
DELETE(XMGIEN,XMNODE,DA) ;
"RTN","XMHIG",64,0)
 N DIK
"RTN","XMHIG",65,0)
 L +^XMB(3.8,XMGIEN,XMNODE):1
"RTN","XMHIG",66,0)
 S DA(1)=XMGIEN
"RTN","XMHIG",67,0)
 S DIK="^XMB(3.8,"_DA(1)_","_XMNODE_","
"RTN","XMHIG",68,0)
 D ^DIK
"RTN","XMHIG",69,0)
 L -^XMB(3.8,XMGIEN,XMNODE)
"RTN","XMHIG",70,0)
 Q
"RTN","XMHIG",71,0)
GROUP(XMGIEN,XMABORT) ; Member Groups
"RTN","XMHIG",72,0)
 Q:'$O(^XMB(3.8,XMGIEN,5,0))
"RTN","XMHIG",73,0)
 N XMI,XMMIEN,XMNAME,XMREC
"RTN","XMHIG",74,0)
 W !
"RTN","XMHIG",75,0)
 S XMI=0
"RTN","XMHIG",76,0)
 F  S XMI=$O(^XMB(3.8,XMGIEN,5,XMI)) Q:XMI'>0  D  Q:XMABORT
"RTN","XMHIG",77,0)
 . I $Y+3>IOSL D PAGE(.XMABORT) Q:XMABORT
"RTN","XMHIG",78,0)
 . S XMREC=^XMB(3.8,XMGIEN,5,XMI,0)
"RTN","XMHIG",79,0)
 . S XMMIEN=$P(XMREC,U)
"RTN","XMHIG",80,0)
 . S XMTYPE=$P(XMREC,U,2)
"RTN","XMHIG",81,0)
 . S XMNAME=$P($G(^XMB(3.8,XMMIEN,0)),U)
"RTN","XMHIG",82,0)
 . I XMNAME="" D DELETE(XMGIEN,5,XMI) Q
"RTN","XMHIG",83,0)
 . I XMTYPE'="" S XMNAME=XMTYPE_":"_XMNAME
"RTN","XMHIG",84,0)
 . W !,$$EZBLD^DIALOG(39090),XMNAME ;Member Group:
"RTN","XMHIG",85,0)
 Q
"RTN","XMHIG",86,0)
REMOTE(XMGIEN,XMABORT) ; Remote Members
"RTN","XMHIG",87,0)
 Q:'$O(^XMB(3.8,XMGIEN,6,0))
"RTN","XMHIG",88,0)
 N XMI,XMNAME
"RTN","XMHIG",89,0)
 W !
"RTN","XMHIG",90,0)
 S XMI=0
"RTN","XMHIG",91,0)
 F  S XMI=$O(^XMB(3.8,XMGIEN,6,XMI)) Q:XMI'>0  D  Q:XMABORT
"RTN","XMHIG",92,0)
 . I $Y+3>IOSL D PAGE(.XMABORT) Q:XMABORT
"RTN","XMHIG",93,0)
 . S XMNAME=$P(^XMB(3.8,XMGIEN,6,XMI,0),U)
"RTN","XMHIG",94,0)
 . W !,$$EZBLD^DIALOG(39085),XMNAME ;Remote Member:
"RTN","XMHIG",95,0)
 Q
"RTN","XMHIG",96,0)
DISTR(XMGIEN,XMABORT) ; Distribution list
"RTN","XMHIG",97,0)
 Q:'$O(^XMB(3.8,XMGIEN,7,0))
"RTN","XMHIG",98,0)
 N XMI,XMMIEN,XMNAME
"RTN","XMHIG",99,0)
 W !
"RTN","XMHIG",100,0)
 S XMI=0
"RTN","XMHIG",101,0)
 F  S XMI=$O(^XMB(3.8,XMGIEN,7,XMI)) Q:XMI'>0  D  Q:XMABORT
"RTN","XMHIG",102,0)
 . I $Y+3>IOSL D PAGE(.XMABORT) Q:XMABORT
"RTN","XMHIG",103,0)
 . S XMMIEN=$P(^XMB(3.8,XMGIEN,7,XMI,0),U)
"RTN","XMHIG",104,0)
 . S XMNAME=$P($G(^XMB(3.816,XMMIEN,0)),U)
"RTN","XMHIG",105,0)
 . I XMNAME="" D DELETE(XMGIEN,7,XMI) Q
"RTN","XMHIG",106,0)
 . W !,$$EZBLD^DIALOG(39080),XMNAME ;Distribution List:
"RTN","XMHIG",107,0)
 . W:$D(^XMB(3.816,XMMIEN,1,0)) $$EZBLD^DIALOG(39092,$P(^(0),U,4)) ; (To |1| Domains)
"RTN","XMHIG",108,0)
 Q
"RTN","XMHIG",109,0)
FAXGROUP(XMGIEN,XMABORT) ; Fax Groups
"RTN","XMHIG",110,0)
 Q:'$O(^XMB(3.8,XMGIEN,9,0))
"RTN","XMHIG",111,0)
 N XMI,XMMIEN,XMNAME
"RTN","XMHIG",112,0)
 W !
"RTN","XMHIG",113,0)
 S XMI=0
"RTN","XMHIG",114,0)
 F  S XMI=$O(^XMB(3.8,XMGIEN,9,XMI)) Q:XMI'>0  D  Q:XMABORT
"RTN","XMHIG",115,0)
 . I $Y+3>IOSL D PAGE(.XMABORT) Q:XMABORT
"RTN","XMHIG",116,0)
 . S XMMIEN=$P(^XMB(3.8,XMGIEN,9,XMI,0),U)
"RTN","XMHIG",117,0)
 . S XMNAME=$P($G(^AKF("FAXG",XMMIEN,0)),U)
"RTN","XMHIG",118,0)
 . I XMNAME="" D DELETE(XMGIEN,9,XMI) Q
"RTN","XMHIG",119,0)
 . W !,$$EZBLD^DIALOG(39081),XMNAME ;Fax Group:
"RTN","XMHIG",120,0)
 Q
"RTN","XMHIG",121,0)
FAXMEMBR(XMGIEN,XMABORT) ; Fax Members
"RTN","XMHIG",122,0)
 Q:'$O(^XMB(3.8,XMGIEN,8,0))
"RTN","XMHIG",123,0)
 N XMI,XMMIEN,XMNAME
"RTN","XMHIG",124,0)
 W !
"RTN","XMHIG",125,0)
 S XMI=0
"RTN","XMHIG",126,0)
 F  S XMI=$O(^XMB(3.8,XMGIEN,8,XMI)) Q:XMI'>0  D  Q:XMABORT
"RTN","XMHIG",127,0)
 . I $Y+3>IOSL D PAGE(.XMABORT) Q:XMABORT
"RTN","XMHIG",128,0)
 . S XMMIEN=$P(^XMB(3.8,XMGIEN,8,XMI,0),U)
"RTN","XMHIG",129,0)
 . S XMNAME=$P($G(^AKF("FAXR",XMMIEN,0)),U)
"RTN","XMHIG",130,0)
 . I XMNAME="" D DELETE(XMGIEN,8,XMI) Q
"RTN","XMHIG",131,0)
 . W !,$$EZBLD^DIALOG(39082),XMNAME ;Fax Recipient:
"RTN","XMHIG",132,0)
 Q
"RTN","XMHIG",133,0)
MEMBEROF(XMGIEN,XMABORT) ; This group is a member of what other Groups
"RTN","XMHIG",134,0)
 Q:'$D(^XMB(3.8,"AD",XMGIEN))
"RTN","XMHIG",135,0)
 N XMMIEN,XMNAME
"RTN","XMHIG",136,0)
 W !
"RTN","XMHIG",137,0)
 S XMMIEN=0
"RTN","XMHIG",138,0)
 F  S XMMIEN=$O(^XMB(3.8,"AD",XMGIEN,XMMIEN)) Q:'XMMIEN  D  Q:XMABORT
"RTN","XMHIG",139,0)
 . I $Y+3>IOSL D PAGE(.XMABORT) Q:XMABORT
"RTN","XMHIG",140,0)
 . S XMNAME=$P($G(^XMB(3.8,XMMIEN,0)),U)
"RTN","XMHIG",141,0)
 . I XMNAME="" D  Q
"RTN","XMHIG",142,0)
 . . N XMI
"RTN","XMHIG",143,0)
 . . S XMI=$O(^XMB(3.8,"AD",XMGIEN,XMMIEN,0))
"RTN","XMHIG",144,0)
 . . I XMI D DELETE(XMMIEN,5,XMI) Q
"RTN","XMHIG",145,0)
 . . K ^XMB(3.8,"AD",XMGIEN,XMMIEN)
"RTN","XMHIG",146,0)
 . W !,$$EZBLD^DIALOG(39093),XMNAME ; member of group:
"RTN","XMHIG",147,0)
 Q
"RTN","XMHIG",148,0)
GSCREEN ; This routine is a screen [DIC("S")] for a fileman lookup
"RTN","XMHIG",149,0)
 ; The naked reference is set to ^XMB(3.8,Y,0)
"RTN","XMHIG",150,0)
 I $P(^(0),U,2)="PU" Q        ; Group is public
"RTN","XMHIG",151,0)
 I $G(^(3))=XMDUZ Q           ; User is organizer of the group
"RTN","XMHIG",152,0)
 I $D(^(1,"B",XMDUZ)) Q       ; User is a member of the group
"RTN","XMHIG",153,0)
 ; *** But this doesn't handle the case in which a user might not be
"RTN","XMHIG",154,0)
 ; *** a member of this group, but is a member of a member group.
"RTN","XMHIG",155,0)
 Q
"RTN","XMHIG",156,0)
PAGE(XMABORT,XMHDR) ;
"RTN","XMHIG",157,0)
 D PAGE^XMXUTIL(.XMABORT) Q:XMABORT
"RTN","XMHIG",158,0)
 W @IOF
"RTN","XMHIG",159,0)
 D:$G(XMHDR) HEADER
"RTN","XMHIG",160,0)
 Q
"RTN","XMHIG",161,0)
HEADER ;
"RTN","XMHIG",162,0)
 W $$EZBLD^DIALOG(39091) ;Member           Last Used MailMan
"RTN","XMHIG",163,0)
 Q
"RTN","XMHIU")
0^31^B25238513
"RTN","XMHIU",1,0)
XMHIU ;ISC-SF/GMB-User Info ;04/17/2002  09:52
"RTN","XMHIU",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMHIU",3,0)
 ; Replaces UHELP^XMA7 (ISC-WASH/RJ/THM/CAP)
"RTN","XMHIU",4,0)
 ; Entry points used by MailMan options (not covered by DBIA):
"RTN","XMHIU",5,0)
 ; HELP      XMHELPUSER - Get user info
"RTN","XMHIU",6,0)
HELP ; User Info
"RTN","XMHIU",7,0)
 N DIC,Y,D,XMHDUZ
"RTN","XMHIU",8,0)
 D CHECK^XMVVITAE
"RTN","XMHIU",9,0)
 S DIC=200,DIC(0)="AEQMZN",DIC("A")=$$EZBLD^DIALOG(38009) ;User name:
"RTN","XMHIU",10,0)
 S DIC("S")="I $S('$D(^VA(200,Y,0)):0,Y<1:1,$L($P(^(0),U,3)):1,1:0)"
"RTN","XMHIU",11,0)
 S DIC("W")="D USERINFO^XMXADDR1(Y)"
"RTN","XMHIU",12,0)
 S D="B^BB^C^D" ; name^alias^initial^nickname
"RTN","XMHIU",13,0)
 F  W ! D MIX^DIC1 Q:Y<0  D
"RTN","XMHIU",14,0)
 . S XMHDUZ=+Y
"RTN","XMHIU",15,0)
 . W @IOF,$$NAME^XMXUTIL(XMHDUZ,1)
"RTN","XMHIU",16,0)
 . D DISPUSER(XMHDUZ)
"RTN","XMHIU",17,0)
 . S DIC("W")="D USERINFO^XMXADDR1(Y)"
"RTN","XMHIU",18,0)
 Q
"RTN","XMHIU",19,0)
DISPUSER(XMUSER) ;
"RTN","XMHIU",20,0)
 N XMABORT
"RTN","XMHIU",21,0)
 S XMABORT=0
"RTN","XMHIU",22,0)
 D GENERAL(XMUSER,.XMABORT) Q:XMABORT  ; General info
"RTN","XMHIU",23,0)
 D GROUPS(XMUSER,.XMABORT) Q:XMABORT   ; Groups in which this user is a member
"RTN","XMHIU",24,0)
 D SURRBEU(XMUSER,.XMABORT) Q:XMABORT  ; Surrogates who may be this user
"RTN","XMHIU",25,0)
 D UBESURR(XMUSER,.XMABORT)            ; Users for whom this user may be surrogate
"RTN","XMHIU",26,0)
 Q
"RTN","XMHIU",27,0)
GENERAL(XMUSER,XMABORT) ;
"RTN","XMHIU",28,0)
 N X,XMREC
"RTN","XMHIU",29,0)
 I '$D(^XMB(3.7,XMUSER)) W !,$$EZBLD^DIALOG(38010) Q  ;No Mailbox for this user!
"RTN","XMHIU",30,0)
 S XMREC=$G(^XMB(3.7,XMUSER,0))
"RTN","XMHIU",31,0)
 Q:XMREC=""&'$D(^XMB(3.8,"AB",XMUSER))
"RTN","XMHIU",32,0)
 S X=$G(^XMB(3.7,XMUSER,"B")) W:$L(X) !,$$EZBLD^DIALOG(38011),X ;Current Banner:
"RTN","XMHIU",33,0)
 S X=$P($G(^XMB(3.7,XMUSER,"L")),U) W:$L(X) !,$$EZBLD^DIALOG(38012),X ;Last used MailMan:
"RTN","XMHIU",34,0)
 S X=$P(XMREC,U,6) I X D
"RTN","XMHIU",35,0)
 . N XMPARM S XMPARM(1)=X,XMPARM(2)=+$P(^XMB(3.7,XMUSER,2,1,0),U,2)
"RTN","XMHIU",36,0)
 . W !,$$EZBLD^DIALOG(38019,.XMPARM) ;NEW messages: |1| (|2| in the IN basket)
"RTN","XMHIU",37,0)
 S X=$P(XMREC,U,2) I $L(X) W !,$$EZBLD^DIALOG(38004),X,$$EZBLD^DIALOG($S($P(XMREC,U,8):38005,1:38006)) ; Forwarding Address: / Local Delivery is ON / OFF
"RTN","XMHIU",38,0)
 S XMREC=$G(^VA(200,XMUSER,.13))
"RTN","XMHIU",39,0)
 S X=$P(XMREC,U,2) I X'="" W !!,$$EZBLD^DIALOG(38013),X ;Office phone:
"RTN","XMHIU",40,0)
 S X=$P(XMREC,U,6) I X'="" W !,$$EZBLD^DIALOG(38014),X ;Fax:
"RTN","XMHIU",41,0)
 S X=$P(XMREC,U,7) I X'="" W !,$$EZBLD^DIALOG(38015),X ;Voice pager:
"RTN","XMHIU",42,0)
 S X=$P(XMREC,U,8) I X'="" W !,$$EZBLD^DIALOG(38016),X ;Digital pager:
"RTN","XMHIU",43,0)
 S X=$P(XMREC,U,3) I X'="" W !,$$EZBLD^DIALOG(38017),X ;Add'l phone:
"RTN","XMHIU",44,0)
 S X=$P(XMREC,U,4) I X'="" W !,$$EZBLD^DIALOG(38017),X ;Add'l phone:
"RTN","XMHIU",45,0)
 S XMREC=$G(^VA(200,XMUSER,.11),"^^")
"RTN","XMHIU",46,0)
 I $P(^XMB(1,1,0),U,10),$P(XMREC,U,1,3)'="^^" D  ; Don't show address unless site OKs it.
"RTN","XMHIU",47,0)
 . W !!,$$EZBLD^DIALOG(38018) ;Address:
"RTN","XMHIU",48,0)
 . F X=1:1:3 I $P(XMREC,U,X)'="" W !,"  ",$P(XMREC,U,X)
"RTN","XMHIU",49,0)
 . S X=$P(XMREC,U,4) I X'="" W !,"  ",X
"RTN","XMHIU",50,0)
 . S X=$P(XMREC,U,5) I X W ", ",$P($G(^DIC(5,X,0)),U,2)
"RTN","XMHIU",51,0)
 . S X=$P(XMREC,U,6) I X'="" W "  ",X
"RTN","XMHIU",52,0)
 I $D(^XMB(3.7,XMUSER,1,0)) D  Q:XMABORT
"RTN","XMHIU",53,0)
 . N XMI,XMLINE
"RTN","XMHIU",54,0)
 . I $Y+5>IOSL D PAGE(.XMABORT) Q:XMABORT
"RTN","XMHIU",55,0)
 . W !!,$$EZBLD^DIALOG(38050) ;Introduction:
"RTN","XMHIU",56,0)
 . S XMI=0
"RTN","XMHIU",57,0)
 . F  S XMI=$O(^XMB(3.7,XMUSER,1,XMI)) Q:XMI'>0  S XMLINE=^(XMI,0) D  Q:XMABORT
"RTN","XMHIU",58,0)
 . . I $Y+4>IOSL D PAGE(.XMABORT) Q:XMABORT
"RTN","XMHIU",59,0)
 . . W !,"  ",XMLINE
"RTN","XMHIU",60,0)
 Q
"RTN","XMHIU",61,0)
GROUPS(XMUSER,XMABORT) ;
"RTN","XMHIU",62,0)
 N XMGIEN,XMREC,XMTYPE
"RTN","XMHIU",63,0)
 Q:'$D(^XMB(3.8,"AB",XMUSER))
"RTN","XMHIU",64,0)
 I $Y+6>IOSL D PAGE(.XMABORT) Q:XMABORT
"RTN","XMHIU",65,0)
 W !!,$$EZBLD^DIALOG(38040) ;Mail Groups:
"RTN","XMHIU",66,0)
 S XMGIEN=""
"RTN","XMHIU",67,0)
 F  S XMGIEN=$O(^XMB(3.8,"AB",XMUSER,XMGIEN)) Q:XMGIEN=""  D  Q:XMABORT
"RTN","XMHIU",68,0)
 . S XMREC=$G(^XMB(3.8,XMGIEN,0)) Q:XMREC=""
"RTN","XMHIU",69,0)
 . S XMTYPE=$P(XMREC,U,2)
"RTN","XMHIU",70,0)
 . ; Don't show private group membership, unless user is a member, too.
"RTN","XMHIU",71,0)
 . I XMTYPE="PR",'$D(^XMB(3.8,"AB",DUZ,XMGIEN)) Q
"RTN","XMHIU",72,0)
 . I $Y+4>IOSL D PAGE(.XMABORT) Q:XMABORT
"RTN","XMHIU",73,0)
 . W !?2,$P(XMREC,U)
"RTN","XMHIU",74,0)
 . W:$G(^XMB(3.8,XMGIEN,3))=XMUSER $$EZBLD^DIALOG(38041) ;(Organizer)
"RTN","XMHIU",75,0)
 . W ?45,$$EZBLD^DIALOG($S(XMTYPE="PR":38042,1:38043)) ;(Private) / (Public)
"RTN","XMHIU",76,0)
 Q
"RTN","XMHIU",77,0)
SURRBEU(XMUSER,XMABORT) ; List surrogates for this user
"RTN","XMHIU",78,0)
 N XMSIEN
"RTN","XMHIU",79,0)
 Q:'$O(^XMB(3.7,XMUSER,9,0))
"RTN","XMHIU",80,0)
 I $Y+6>IOSL D PAGE(.XMABORT) Q:XMABORT
"RTN","XMHIU",81,0)
 W !!,$$EZBLD^DIALOG(38044) ;This user's surrogates are:
"RTN","XMHIU",82,0)
 S XMSIEN=0
"RTN","XMHIU",83,0)
 F  S XMSIEN=$O(^XMB(3.7,XMUSER,9,XMSIEN)) Q:XMSIEN=""  D  Q:XMABORT
"RTN","XMHIU",84,0)
 . D DISPSURR(2,XMUSER,XMSIEN,.XMABORT)
"RTN","XMHIU",85,0)
 Q
"RTN","XMHIU",86,0)
UBESURR(XMSURR,XMABORT) ; List users for whom this user may act as surrogate
"RTN","XMHIU",87,0)
 N XMUSER,XMSIEN
"RTN","XMHIU",88,0)
 Q:'$O(^XMB(3.7,"AB",XMSURR,0))
"RTN","XMHIU",89,0)
 I $Y+6>IOSL D PAGE(.XMABORT) Q:XMABORT
"RTN","XMHIU",90,0)
 W !!,$$EZBLD^DIALOG(38045) ;This user may act as a surrogate for:
"RTN","XMHIU",91,0)
 S XMUSER=""
"RTN","XMHIU",92,0)
 F  S XMUSER=$O(^XMB(3.7,"AB",XMSURR,XMUSER)) Q:XMUSER=""  D  Q:XMABORT
"RTN","XMHIU",93,0)
 . S XMSIEN=$O(^XMB(3.7,"AB",XMSURR,XMUSER,""))
"RTN","XMHIU",94,0)
 . D DISPSURR(1,XMUSER,XMSIEN,.XMABORT)
"RTN","XMHIU",95,0)
 Q
"RTN","XMHIU",96,0)
DISPSURR(XMFLAG,XMUSER,XMSIEN,XMABORT) ;
"RTN","XMHIU",97,0)
 N XMPRIV,XMREC,XMNIEN
"RTN","XMHIU",98,0)
 I $Y+4>IOSL D PAGE(.XMABORT) Q:XMABORT
"RTN","XMHIU",99,0)
 S XMREC=$S(XMUSER=.6:".6^y^y",1:$G(^XMB(3.7,XMUSER,9,XMSIEN,0)))
"RTN","XMHIU",100,0)
 S XMNIEN=$S(XMFLAG=1:XMUSER,1:$P(XMREC,U,1))
"RTN","XMHIU",101,0)
 Q:'XMNIEN  Q:'$D(^VA(200,XMNIEN,0))
"RTN","XMHIU",102,0)
 W !,?2,$$NAME^XMXUTIL(XMNIEN)
"RTN","XMHIU",103,0)
 S XMPRIV=$P(XMREC,U,2,3)
"RTN","XMHIU",104,0)
 I XMPRIV'["y" W ?45,$$EZBLD^DIALOG(38046) Q  ;No Privileges
"RTN","XMHIU",105,0)
 I $L(XMPRIV,"y")>2 W ?45,$$EZBLD^DIALOG(38047) Q  ;Read and Write Privileges
"RTN","XMHIU",106,0)
 W ?45,$$EZBLD^DIALOG($S($P(XMPRIV,U)["y":38048,1:38049)) ;Read Privilege / Write Privilege
"RTN","XMHIU",107,0)
 Q
"RTN","XMHIU",108,0)
PAGE(XMABORT) ;
"RTN","XMHIU",109,0)
 D PAGE^XMXUTIL(.XMABORT) Q:XMABORT
"RTN","XMHIU",110,0)
 W @IOF
"RTN","XMHIU",111,0)
 Q
"RTN","XMJBL")
0^32^B12292736
"RTN","XMJBL",1,0)
XMJBL ;ISC-SF/GMB-List contents of user's Mailbox ;04/17/2002  10:07
"RTN","XMJBL",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMJBL",3,0)
 ; Entry points used by MailMan options (not covered by DBIA):
"RTN","XMJBL",4,0)
 ; LISTMBOX  XMBASKLIST - List all messages in user's mailbox
"RTN","XMJBL",5,0)
MBOX ; List messages in mailbox of DUZ
"RTN","XMJBL",6,0)
 N DIC,Y
"RTN","XMJBL",7,0)
 S DIC(0)="AEQZ",DIC=3.7
"RTN","XMJBL",8,0)
 D ^DIC Q:Y=-1
"RTN","XMJBL",9,0)
 D LISTM(+Y,$P(Y(0,0),U))
"RTN","XMJBL",10,0)
 Q
"RTN","XMJBL",11,0)
LISTMBOX ; Option to list mailbox contents comes in here
"RTN","XMJBL",12,0)
 N ZTSAVE,XMNAME,DIR,X,Y,XMALL
"RTN","XMJBL",13,0)
 D CHECK^XMVVITAE
"RTN","XMJBL",14,0)
 S DIR("A")=$$EZBLD^DIALOG(34650) ; List contents of
"RTN","XMJBL",15,0)
 S XMALL=$$EZBLD^DIALOG(34651) ; A:All Baskets
"RTN","XMJBL",16,0)
 S DIR(0)="S^"_XMALL_";"_$$EZBLD^DIALOG(34652) ; O:One Basket
"RTN","XMJBL",17,0)
 S DIR("B")=$P(XMALL,":",2) ; All Baskets
"RTN","XMJBL",18,0)
 D ^DIR Q:$D(DIRUT)
"RTN","XMJBL",19,0)
 S XMNAME=XMV("NAME")
"RTN","XMJBL",20,0)
 S (ZTSAVE("XMDUZ"),ZTSAVE("XMNAME"),ZTSAVE("XMV(""ORDER"")"))=""
"RTN","XMJBL",21,0)
 I Y=$P(XMALL,":",1) D EN^XUTMDEVQ("ZLISTM^XMJBL",$$EZBLD^DIALOG(34654),.ZTSAVE) Q  ; MailMan: Mailbox Contents List
"RTN","XMJBL",22,0)
 N XMK,XMKN
"RTN","XMJBL",23,0)
 D SELBSKT^XMJBU(XMDUZ,34653,"","",.XMK,.XMKN) Q:XMK=U  ; List contents of MAIL BASKET:
"RTN","XMJBL",24,0)
 S (ZTSAVE("XMK"),ZTSAVE("XMKN"))=""
"RTN","XMJBL",25,0)
 D EN^XUTMDEVQ("ZLISTB^XMJBL",$$EZBLD^DIALOG(34655),.ZTSAVE) ; MailMan: Basket Contents List
"RTN","XMJBL",26,0)
 Q
"RTN","XMJBL",27,0)
LISTM(XMDUZ,XMNAME) ; List Mailbox
"RTN","XMJBL",28,0)
ZLISTM ;
"RTN","XMJBL",29,0)
 N XMPAGE,XMLEN,XMK,XMKN,XMABORT
"RTN","XMJBL",30,0)
 S XMKN=""
"RTN","XMJBL",31,0)
 S XMLEN("XMKZ")=6
"RTN","XMJBL",32,0)
 D INIT(.XMNAME,.XMLEN,.XMPAGE,.XMABORT)
"RTN","XMJBL",33,0)
 F  S XMKN=$O(^XMB(3.7,XMDUZ,2,"B",XMKN)) Q:XMKN=""  D  Q:XMABORT
"RTN","XMJBL",34,0)
 . S XMK=$O(^(XMKN,""))  ; Naked reference to above line
"RTN","XMJBL",35,0)
 . D LB(XMDUZ,XMNAME,XMK,XMKN,.XMLEN,.XMPAGE,.XMABORT)
"RTN","XMJBL",36,0)
 Q:$G(IOST)'["C-"!XMABORT
"RTN","XMJBL",37,0)
 D WAIT^XMXUTIL
"RTN","XMJBL",38,0)
 Q
"RTN","XMJBL",39,0)
LISTB(XMDUZ,XMNAME,XMK,XMKN) ; List Basket
"RTN","XMJBL",40,0)
ZLISTB ;
"RTN","XMJBL",41,0)
 N XMPAGE,XMLEN,XMABORT
"RTN","XMJBL",42,0)
 S XMLEN("XMKZ")=$L($O(^XMB(3.7,XMDUZ,2,XMK,1,"C",""),-1))
"RTN","XMJBL",43,0)
 D INIT(.XMNAME,.XMLEN,.XMPAGE,.XMABORT)
"RTN","XMJBL",44,0)
 D LB(XMDUZ,XMNAME,XMK,XMKN,.XMLEN,.XMPAGE,.XMABORT)
"RTN","XMJBL",45,0)
 Q:$G(IOST)'["C-"!XMABORT
"RTN","XMJBL",46,0)
 D WAIT^XMXUTIL
"RTN","XMJBL",47,0)
 Q
"RTN","XMJBL",48,0)
LB(XMDUZ,XMNAME,XMK,XMKN,XMLEN,XMPAGE,XMABORT) ;
"RTN","XMJBL",49,0)
 N XMKZ,XMZ,XMZREC
"RTN","XMJBL",50,0)
 I $Y+5>IOSL D PAGE Q:XMABORT
"RTN","XMJBL",51,0)
 W !!,$$EZBLD^DIALOG(34656,XMKN) ; Basket: |1|
"RTN","XMJBL",52,0)
 S XMKZ=""
"RTN","XMJBL",53,0)
 F  S XMKZ=$O(^XMB(3.7,XMDUZ,2,XMK,1,"C",XMKZ),XMV("ORDER")) Q:XMKZ'>0  D  Q:XMABORT
"RTN","XMJBL",54,0)
 . S XMZ=$O(^(XMKZ,""))  ; Naked reference to line above
"RTN","XMJBL",55,0)
 . S XMZREC=$G(^XMB(3.9,XMZ,0))
"RTN","XMJBL",56,0)
 . I XMZREC="" D ZAPIT^XMXMSGS2(XMDUZ,XMK,XMZ) Q
"RTN","XMJBL",57,0)
 . I $Y+3>IOSL D  Q:XMABORT
"RTN","XMJBL",58,0)
 . . D PAGE Q:XMABORT
"RTN","XMJBL",59,0)
 . . W !!,$$EZBLD^DIALOG(34656.1,XMKN) ; Basket: |1| (continued)
"RTN","XMJBL",60,0)
 . W !,$J(XMKZ,XMLEN("XMKZ")),". ",$J("["_XMZ_"]",XMLEN("XMZ"))," ",$$DATE^XMXUTIL2(XMZREC,1),"  ",$E($$SUBJ^XMXUTIL2(XMZREC),1,XMLEN("SUBJ"))
"RTN","XMJBL",61,0)
 Q
"RTN","XMJBL",62,0)
INIT(XMNAME,XMLEN,XMPAGE,XMABORT) ;
"RTN","XMJBL",63,0)
 I $D(ZTQUEUED) S ZTREQ="@"
"RTN","XMJBL",64,0)
 S (XMPAGE,XMABORT)=0
"RTN","XMJBL",65,0)
 S XMLEN("XMZ")=$L($O(^XMB(3.9,":"),-1))+2
"RTN","XMJBL",66,0)
 S XMLEN("DATE")=$L($$MMDT^XMXUTIL1($$NOW^XLFDT))
"RTN","XMJBL",67,0)
 S XMLEN("SUBJ")=79-XMLEN("DATE")-XMLEN("XMKZ")-XMLEN("XMZ")-5
"RTN","XMJBL",68,0)
 S XMNAME=XMNAME_" - "_$$MMDT^XMXUTIL1($$NOW^XLFDT)
"RTN","XMJBL",69,0)
 W:$G(IOST)["C-" @IOF
"RTN","XMJBL",70,0)
 D HEADER
"RTN","XMJBL",71,0)
 Q
"RTN","XMJBL",72,0)
PAGE ;
"RTN","XMJBL",73,0)
 I $G(IOST)["C-" D PAGE^XMXUTIL(.XMABORT) Q:XMABORT
"RTN","XMJBL",74,0)
 W @IOF
"RTN","XMJBL",75,0)
 D HEADER
"RTN","XMJBL",76,0)
 Q
"RTN","XMJBL",77,0)
HEADER ;
"RTN","XMJBL",78,0)
 N XMPARM
"RTN","XMJBL",79,0)
 S XMPAGE=XMPAGE+1
"RTN","XMJBL",80,0)
 S XMPARM(1)=XMNAME,XMPARM(2)=XMPAGE
"RTN","XMJBL",81,0)
 W $$EZBLD^DIALOG(34657,.XMPARM) ; Mailbox Content for |1|   Page: |2|
"RTN","XMJBL",82,0)
 W !,$$REPEAT^XLFSTR("-",79)
"RTN","XMJBL",83,0)
 Q
"RTN","XMJBM")
0^276^B53324713
"RTN","XMJBM",1,0)
XMJBM ;ISC-SF/GMB-Manage Mail in Mailbox ;05/23/2002  11:35
"RTN","XMJBM",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMJBM",3,0)
 ; Replaces ^XMA0,^XMA01 (ISC-WASH/CAP/THM)
"RTN","XMJBM",4,0)
 ; Entry points used by MailMan options (not covered by DBIA):
"RTN","XMJBM",5,0)
 ; MANAGE   XMREAD
"RTN","XMJBM",6,0)
MANAGE ; Manage existing mail in your Mailbox
"RTN","XMJBM",7,0)
 N XMABORT,XMK,XMKN,XMRDR
"RTN","XMJBM",8,0)
 S XMABORT=0
"RTN","XMJBM",9,0)
 D INIT^XMJBM1(.XMDUZ,.XMRDR,.XMABORT) Q:XMABORT
"RTN","XMJBM",10,0)
 F  D ASKBSKT^XMJBM1(XMDUZ,XMRDR,.XMK,.XMKN,.XMABORT) Q:XMABORT  D  Q:XMABORT
"RTN","XMJBM",11,0)
 . D:XMRDR="C" CLASSIC(XMDUZ,XMK,XMKN,.XMABORT) ; Classic Reader
"RTN","XMJBM",12,0)
 . D:XMRDR="D" LIST^XMJMLR(XMDUZ,XMK,.XMKN,1,.XMABORT) ; Full Screen Detail
"RTN","XMJBM",13,0)
 . D:XMRDR="S" LIST^XMJMLR(XMDUZ,XMK,.XMKN,0,.XMABORT) ; Full Screen Summary
"RTN","XMJBM",14,0)
 . I XMABORT,XMDUZ=.6 S XMABORT=0
"RTN","XMJBM",15,0)
 . I '$O(^XMB(3.7,XMDUZ,2,XMK,1,"C",0)) D NOMSGS^XMJBM1(XMDUZ,XMK,XMKN)
"RTN","XMJBM",16,0)
 Q
"RTN","XMJBM",17,0)
CLASSIC(XMDUZ,XMK,XMKN,XMABORT) ; Read Message
"RTN","XMJBM",18,0)
 N XMFIRST,XMLAST,XMZ,XMNEXT,XMKZ,XMORDER,XMPARM
"RTN","XMJBM",19,0)
 I XMDUZ=.5,XMK>999 S XMORDER=XMV("ORDER"),XMV("ORDER")=1
"RTN","XMJBM",20,0)
 S XMKZ=""
"RTN","XMJBM",21,0)
 F  D  Q:XMABORT
"RTN","XMJBM",22,0)
 . F  S XMKZ=$O(^XMB(3.7,XMDUZ,2,XMK,1,"C",XMKZ),XMV("ORDER")) Q:'XMKZ  Q:XMDUZ=DUZ  Q:'$$SURRCONF^XMXSEC(XMDUZ,$O(^(XMKZ,"")))
"RTN","XMJBM",23,0)
 . I XMKZ="" D  Q:XMABORT
"RTN","XMJBM",24,0)
 . . F  S XMKZ=$O(^XMB(3.7,XMDUZ,2,XMK,1,"C",XMKZ),XMV("ORDER")) Q:'XMKZ  Q:XMDUZ=DUZ  Q:'$$SURRCONF^XMXSEC(XMDUZ,$O(^(XMKZ,"")))
"RTN","XMJBM",25,0)
 . . I XMKZ D AGAIN^XMJMLR(.XMABORT) Q
"RTN","XMJBM",26,0)
 . . S XMABORT=1
"RTN","XMJBM",27,0)
 . . Q:'$O(^XMB(3.7,XMDUZ,2,XMK,1,"C",0))
"RTN","XMJBM",28,0)
 . . N XMTEXT
"RTN","XMJBM",29,0)
 . . W !
"RTN","XMJBM",30,0)
 . . D BLD^DIALOG(34030.9,"","","XMTEXT","F")
"RTN","XMJBM",31,0)
 . . ;All of the messages in this basket are confidential.
"RTN","XMJBM",32,0)
 . . ;Surrogates may not read confidential messages.
"RTN","XMJBM",33,0)
 . . ;Use one of the full screen readers to see a list of the messages.
"RTN","XMJBM",34,0)
 . . D MSG^DIALOG("WM","","","","XMTEXT")
"RTN","XMJBM",35,0)
 . S XMFIRST=$O(^XMB(3.7,XMDUZ,2,XMK,1,"C",""))
"RTN","XMJBM",36,0)
 . S XMLAST=$O(^XMB(3.7,XMDUZ,2,XMK,1,"C",""),-1)
"RTN","XMJBM",37,0)
 . ; have the user pick from first to last, or any xmz
"RTN","XMJBM",38,0)
 . N XMY,XMOPT,XMOX,XMPREVU
"RTN","XMJBM",39,0)
 . D SETCMD(XMDUZ,XMK,.XMOPT,.XMOX)
"RTN","XMJBM",40,0)
 . S:XMV("PREVU") XMPREVU=$$PREVU(XMDUZ,XMK,XMKN,XMKZ)
"RTN","XMJBM",41,0)
 . S XMNEXT=0
"RTN","XMJBM",42,0)
 . F  D  Q:XMNEXT!XMABORT
"RTN","XMJBM",43,0)
 . . W ! W:XMV("PREVU") !,XMPREVU
"RTN","XMJBM",44,0)
 . . S XMPARM(1)=XMKN,XMPARM(2)=XMKZ
"RTN","XMJBM",45,0)
 . . W !,$$EZBLD^DIALOG(34030,.XMPARM) ; XMKN," Basket Message: ",XMKZ,"// "
"RTN","XMJBM",46,0)
 . . R XMY:DTIME I '$T S XMABORT=1 Q
"RTN","XMJBM",47,0)
 . . I XMY[U S XMABORT=1 Q
"RTN","XMJBM",48,0)
 . . I XMY="" S XMY=XMKZ D NUMBER Q
"RTN","XMJBM",49,0)
 . . I XMY?.N D NUMBER Q
"RTN","XMJBM",50,0)
 . . I $E(XMY)="?" D QUESTION Q
"RTN","XMJBM",51,0)
 . . S XMY=$$COMMAND^XMJDIR(.XMOPT,.XMOX,XMY)
"RTN","XMJBM",52,0)
 . . I XMY=-1 D HELPSCR Q
"RTN","XMJBM",53,0)
 . . I $D(XMOPT(XMY,"?")) D SHOWERR^XMJDIR(.XMOPT,.XMY) Q
"RTN","XMJBM",54,0)
 . . D @XMY
"RTN","XMJBM",55,0)
 . . S:'$D(^XMB(3.7,XMDUZ,2,XMK,1,"C",+XMKZ)) XMNEXT=1
"RTN","XMJBM",56,0)
 I $D(XMORDER) S XMV("ORDER")=XMORDER
"RTN","XMJBM",57,0)
 Q
"RTN","XMJBM",58,0)
PREVU(XMDUZ,XMK,XMKN,XMKZ) ;
"RTN","XMJBM",59,0)
 Q:XMKZ="" ""
"RTN","XMJBM",60,0)
 N XMZ,XMZREC,XMSUBJ,XMFROM,XMLEN,XMSL,XMFL,XMPARM
"RTN","XMJBM",61,0)
 S XMZ=$O(^XMB(3.7,XMDUZ,2,XMK,1,"C",XMKZ,""))
"RTN","XMJBM",62,0)
 I '$D(^XMB(3.7,XMDUZ,2,XMK,1,XMZ,0)) D ADDITC^XMUT4A(XMDUZ,XMK,XMZ,XMKZ)
"RTN","XMJBM",63,0)
 S XMZREC=$G(^XMB(3.9,XMZ,0))
"RTN","XMJBM",64,0)
 S XMSUBJ=$$SUBJ^XMXUTIL2(XMZREC)
"RTN","XMJBM",65,0)
 S XMFROM=$$NAME^XMXUTIL($P(XMZREC,U,2))
"RTN","XMJBM",66,0)
 S XMSL=$L(XMSUBJ)
"RTN","XMJBM",67,0)
 S XMFL=$L(XMFROM)
"RTN","XMJBM",68,0)
 S XMLEN=64
"RTN","XMJBM",69,0)
 I XMSL+XMFL>XMLEN D
"RTN","XMJBM",70,0)
 . I XMSL<36 S XMFROM=$E(XMFROM,1,XMLEN-XMSL) Q
"RTN","XMJBM",71,0)
 . I XMFL<26 S XMSUBJ=$E(XMSUBJ,1,XMLEN-XMFL) Q
"RTN","XMJBM",72,0)
 . S XMSL=XMSL-(XMSL+XMFL-XMLEN\2)
"RTN","XMJBM",73,0)
 . S XMSUBJ=$E(XMSUBJ,1,XMSL)
"RTN","XMJBM",74,0)
 . S XMFROM=$E(XMFROM,1,XMLEN-XMSL)
"RTN","XMJBM",75,0)
 S XMPARM(1)=XMSUBJ,XMPARM(2)=XMFROM
"RTN","XMJBM",76,0)
 Q $$EZBLD^DIALOG(34031,.XMPARM) ; "Subj: "_XMSUBJ_"   From: "_XMFROM
"RTN","XMJBM",77,0)
SETCMD(XMDUZ,XMK,XMOPT,XMOX) ;
"RTN","XMJBM",78,0)
 D OPTGRP^XMXSEC1(XMDUZ,XMK,.XMOPT,.XMOX,1)
"RTN","XMJBM",79,0)
 I XMDUZ=.5,XMK>999 Q
"RTN","XMJBM",80,0)
 D SET^XMXSEC1("I",37241,.XMOPT,.XMOX) ; Ignore this message
"RTN","XMJBM",81,0)
 Q
"RTN","XMJBM",82,0)
NUMBER ;
"RTN","XMJBM",83,0)
 I $L(XMY)>25 W $C(7),"?" Q
"RTN","XMJBM",84,0)
 I XMY<XMFIRST D  Q
"RTN","XMJBM",85,0)
 . S XMKZ=$O(^XMB(3.7,XMDUZ,2,XMK,1,"C",""))
"RTN","XMJBM",86,0)
 . S:XMV("PREVU") XMPREVU=$$PREVU(XMDUZ,XMK,XMKN,XMKZ)
"RTN","XMJBM",87,0)
 . W $C(7),"?"
"RTN","XMJBM",88,0)
 I $D(^XMB(3.7,XMDUZ,2,XMK,1,"C",XMY)) D  Q
"RTN","XMJBM",89,0)
 . S XMKZ=XMY
"RTN","XMJBM",90,0)
 . S XMZ=$O(^XMB(3.7,XMDUZ,2,XMK,1,"C",XMKZ,""))
"RTN","XMJBM",91,0)
 . I '$D(^XMB(3.7,XMDUZ,2,XMK,1,XMZ,0)) D ADDITC^XMUT4A(XMDUZ,XMK,XMZ,XMKZ)
"RTN","XMJBM",92,0)
 . D READMSG(XMDUZ,XMK,XMKN,XMZ)
"RTN","XMJBM",93,0)
 . S XMNEXT=1
"RTN","XMJBM",94,0)
 I XMFIRST'>XMY,XMY'>XMLAST D  Q
"RTN","XMJBM",95,0)
 . S XMKZ=$O(^XMB(3.7,XMDUZ,2,XMK,1,"C",XMY),XMV("ORDER"))
"RTN","XMJBM",96,0)
 . S:XMV("PREVU") XMPREVU=$$PREVU(XMDUZ,XMK,XMKN,XMKZ)
"RTN","XMJBM",97,0)
 . W $C(7),"?"
"RTN","XMJBM",98,0)
 I $D(^XMB(3.9,XMY,0)) D NUMBERZ Q
"RTN","XMJBM",99,0)
 I XMY>XMLAST D  Q
"RTN","XMJBM",100,0)
 . S XMKZ=$O(^XMB(3.7,XMDUZ,2,XMK,1,"C",""),-1)
"RTN","XMJBM",101,0)
 . S:XMV("PREVU") XMPREVU=$$PREVU(XMDUZ,XMK,XMKN,XMKZ)
"RTN","XMJBM",102,0)
 . W $C(7),"?"
"RTN","XMJBM",103,0)
 W $C(7),"?"
"RTN","XMJBM",104,0)
 Q
"RTN","XMJBM",105,0)
NUMBERZ ;
"RTN","XMJBM",106,0)
 I $D(^XMB(3.7,"M",XMY,XMDUZ)) D  Q
"RTN","XMJBM",107,0)
 . S XMZ=XMY
"RTN","XMJBM",108,0)
 . I '$D(^XMB(3.7,XMDUZ,2,XMK,1,XMZ)) D
"RTN","XMJBM",109,0)
 . . ; It's in another basket
"RTN","XMJBM",110,0)
 . . S XMK=$O(^XMB(3.7,"M",XMZ,XMDUZ,""))
"RTN","XMJBM",111,0)
 . . S XMKN=$P(^XMB(3.7,XMDUZ,2,XMK,0),U,1)
"RTN","XMJBM",112,0)
 . S XMKZ=$P($G(^XMB(3.7,XMDUZ,2,XMK,1,XMZ,0)),U,2)
"RTN","XMJBM",113,0)
 . I 'XMKZ D ADDITM^XMUT4A(XMDUZ,XMK,XMZ,.XMKZ)
"RTN","XMJBM",114,0)
 . D READMSG(XMDUZ,XMK,XMKN,XMZ)
"RTN","XMJBM",115,0)
 . S XMNEXT=1
"RTN","XMJBM",116,0)
 I $D(^XMB(3.9,XMY,0)) D  Q
"RTN","XMJBM",117,0)
 . N XMOK,XMZREC
"RTN","XMJBM",118,0)
 . S XMZ=XMY,XMZREC=^XMB(3.9,XMZ,0)
"RTN","XMJBM",119,0)
 . I $D(XMERR) K XMERR,^TMP("XMERR",$J)
"RTN","XMJBM",120,0)
 . I '$$ACCESS^XMXSEC(XMDUZ,XMZ,XMZREC) D  Q:'XMOK
"RTN","XMJBM",121,0)
 . . W "?"
"RTN","XMJBM",122,0)
 . . D FWD^XMJMLR1(XMDUZ,XMZ,XMZREC,0,.XMOK)
"RTN","XMJBM",123,0)
 . D PUTMSG^XMXMSGS2(XMDUZ,XMK,XMKN,XMZ) ; User is a recipient, so save to user's basket
"RTN","XMJBM",124,0)
 . D READMSG(XMDUZ,XMK,XMKN,XMZ)
"RTN","XMJBM",125,0)
 . S XMNEXT=1
"RTN","XMJBM",126,0)
 Q
"RTN","XMJBM",127,0)
QUESTION ;
"RTN","XMJBM",128,0)
 I XMY="?" D LIST^XMJML(XMDUZ,XMK,XMKN,XMKZ,0) Q
"RTN","XMJBM",129,0)
 I XMY="??" D LIST^XMJML(XMDUZ,XMK,XMKN,XMKZ,1) Q
"RTN","XMJBM",130,0)
 I XMY="???" D HELPSCR Q
"RTN","XMJBM",131,0)
 I XMY?4."?"!("?HELP"[$$UP^XLFSTR(XMY)) D  Q
"RTN","XMJBM",132,0)
 . N XQH
"RTN","XMJBM",133,0)
 . S XQH="XM-U-BO-CLASSIC"
"RTN","XMJBM",134,0)
 . D EN^XQH
"RTN","XMJBM",135,0)
 I XMY?1"??".E D  Q
"RTN","XMJBM",136,0)
 . ; Search for messages whose subject starts with string
"RTN","XMJBM",137,0)
 . I $E(XMY,3,99)?.N,$D(^XMB(3.9,$E(XMY,3,999),0)) D  Q
"RTN","XMJBM",138,0)
 . . S XMY=$E(XMY,3,99)
"RTN","XMJBM",139,0)
 . . D NUMBERZ
"RTN","XMJBM",140,0)
 . D FIND^XMJMFA(XMDUZ,$E(XMY,3,99))
"RTN","XMJBM",141,0)
 I XMY?1"?".E D  Q
"RTN","XMJBM",142,0)
 . ; Search for messages whose subject contains string
"RTN","XMJBM",143,0)
 . N XMF
"RTN","XMJBM",144,0)
 . S XMF("BSKT")=XMK
"RTN","XMJBM",145,0)
 . S XMF("SUBJ")=$E(XMY,2,99)
"RTN","XMJBM",146,0)
 . D FIND1^XMJMFB(XMDUZ,.XMF)
"RTN","XMJBM",147,0)
 Q
"RTN","XMJBM",148,0)
HELPSCR ;
"RTN","XMJBM",149,0)
 N XMTEXT,XMLINES,XMPARM
"RTN","XMJBM",150,0)
 W !
"RTN","XMJBM",151,0)
 S XMPARM(1)=XMKZ,XMPARM(2)=XMFIRST,XMPARM(3)=XMLAST
"RTN","XMJBM",152,0)
 D BLD^DIALOG(34032,.XMPARM,"","XMTEXT","F")
"RTN","XMJBM",153,0)
 ; Press ENTER to read message _XMKZ_.  Enter message number (_XMFIRST_-_XMLAST_) to read
"RTN","XMJBM",154,0)
 ; a message in this basket.  Enter internal message number to read any
"RTN","XMJBM",155,0)
 ; message still on the system, which you ever sent or received.  Enter:
"RTN","XMJBM",156,0)
 ; ? or ??        Display a summary or detailed list of messages in this basket
"RTN","XMJBM",157,0)
 ; ???? or ?HELP  Display detailed help
"RTN","XMJBM",158,0)
 ; ?string        Search for messages in this basket whose subject
"RTN","XMJBM",159,0)
 ;                contains the specified string
"RTN","XMJBM",160,0)
 ; ??string       Search for messages you once sent or received
"RTN","XMJBM",161,0)
 ;                whose subject begins with the specified string
"RTN","XMJBM",162,0)
 S XMLINES=IOSL-DIHELP-3
"RTN","XMJBM",163,0)
 D MSG^DIALOG("WH","",$G(IOM),"","XMTEXT")
"RTN","XMJBM",164,0)
 D HELPCMD^XMJDIR(.XMOPT,.XMOX,XMLINES)
"RTN","XMJBM",165,0)
 Q
"RTN","XMJBM",166,0)
READMSG(XMDUZ,XMK,XMKN,XMZ) ;
"RTN","XMJBM",167,0)
 I '$D(^XMB(3.9,XMZ,0)) D ZAPIT(XMDUZ,XMK,XMZ) Q
"RTN","XMJBM",168,0)
 I XMDUZ'=DUZ,'$$SURRACC^XMXSEC(XMDUZ,"",XMZ,$G(^XMB(3.9,XMZ,0))) D  Q  ; "read"
"RTN","XMJBM",169,0)
 . D SHOW^XMJERR
"RTN","XMJBM",170,0)
 . I $G(XMRDR)'="C" D WAIT^XMXUTIL
"RTN","XMJBM",171,0)
 N XMSECURE,XMPAKMAN,XMSECBAD ; Important 'new' - part of scramble and packman handling
"RTN","XMJBM",172,0)
 D DISPMSG^XMJMP(XMDUZ,XMK,XMKN,XMZ,.XMSECBAD) Q:$G(XMSECBAD)
"RTN","XMJBM",173,0)
 D READMSG^XMJMOI(0,XMDUZ,XMK,XMKN,XMZ)
"RTN","XMJBM",174,0)
 Q
"RTN","XMJBM",175,0)
ZAPIT(XMDUZ,XMK,XMZ) ;
"RTN","XMJBM",176,0)
 W !,$C(7),$$EZBLD^DIALOG(34034) ; This references a message which doesn't exist - deleting it.
"RTN","XMJBM",177,0)
 D ZAPIT^XMXMSGS2(XMDUZ,XMK,XMZ)
"RTN","XMJBM",178,0)
 Q
"RTN","XMJBM",179,0)
C ; Change the name of the basket
"RTN","XMJBM",180,0)
 D NAMEBSKT^XMJBU(XMDUZ,XMK,.XMKN)
"RTN","XMJBM",181,0)
 Q
"RTN","XMJBM",182,0)
D ; Delete
"RTN","XMJBM",183,0)
 D DELETE^XMJMOR(XMDUZ,XMK)
"RTN","XMJBM",184,0)
 Q
"RTN","XMJBM",185,0)
F ; Forward
"RTN","XMJBM",186,0)
 D FORWARD^XMJMOR(XMDUZ,XMK)
"RTN","XMJBM",187,0)
 Q
"RTN","XMJBM",188,0)
FI ; Filter
"RTN","XMJBM",189,0)
 D FILTER^XMJMOR(XMDUZ,XMK)
"RTN","XMJBM",190,0)
 Q
"RTN","XMJBM",191,0)
H ; Headerless Print
"RTN","XMJBM",192,0)
 D PRINT^XMJMOR(XMDUZ,XMK,0)
"RTN","XMJBM",193,0)
 Q
"RTN","XMJBM",194,0)
I ; Ignore this message
"RTN","XMJBM",195,0)
 S XMNEXT=1
"RTN","XMJBM",196,0)
 Q
"RTN","XMJBM",197,0)
L ; Later
"RTN","XMJBM",198,0)
LA ; Later
"RTN","XMJBM",199,0)
 D LATER^XMJMOR(XMDUZ,XMK)
"RTN","XMJBM",200,0)
 Q
"RTN","XMJBM",201,0)
LM ; List Messages (can't read)
"RTN","XMJBM",202,0)
 D LIST^XMJML(XMDUZ,XMK,XMKN,"",1)
"RTN","XMJBM",203,0)
 Q
"RTN","XMJBM",204,0)
LN ; List New Messages
"RTN","XMJBM",205,0)
 D LISTONE^XMJMLN(XMDUZ,XMK,XMKN,"N0")
"RTN","XMJBM",206,0)
 Q
"RTN","XMJBM",207,0)
LP ; List Priority Messages
"RTN","XMJBM",208,0)
 D LISTONE^XMJMLN(XMDUZ,XMK,XMKN,"N")
"RTN","XMJBM",209,0)
 Q
"RTN","XMJBM",210,0)
N ; List New Messages (can't read)
"RTN","XMJBM",211,0)
 D LISTNEW^XMJML(XMDUZ,XMK,XMKN)
"RTN","XMJBM",212,0)
 Q
"RTN","XMJBM",213,0)
NT ; New Toggle messages
"RTN","XMJBM",214,0)
 D NEWTOGL^XMJMOR(XMDUZ,XMK)
"RTN","XMJBM",215,0)
 Q
"RTN","XMJBM",216,0)
P ; Print
"RTN","XMJBM",217,0)
 D PRINT^XMJMOR(XMDUZ,XMK)
"RTN","XMJBM",218,0)
 Q
"RTN","XMJBM",219,0)
Q ; Query by subject, sender, and/or date
"RTN","XMJBM",220,0)
 D FINDBSKT^XMJMF(XMDUZ,XMK,XMKN)
"RTN","XMJBM",221,0)
 Q
"RTN","XMJBM",222,0)
R ; Resequence
"RTN","XMJBM",223,0)
 N XMMSG
"RTN","XMJBM",224,0)
 W !,$$EZBLD^DIALOG(34035) ; Resequencing ...
"RTN","XMJBM",225,0)
 D RSEQBSKT^XMXBSKT(XMDUZ,XMK,.XMMSG)
"RTN","XMJBM",226,0)
 W !,XMMSG
"RTN","XMJBM",227,0)
 S XMKZ=""
"RTN","XMJBM",228,0)
 Q
"RTN","XMJBM",229,0)
S ; Save
"RTN","XMJBM",230,0)
 D SAVE^XMJMOR(XMDUZ,XMK)
"RTN","XMJBM",231,0)
 Q
"RTN","XMJBM",232,0)
T ; Terminate
"RTN","XMJBM",233,0)
 D TERM^XMJMOR(XMDUZ,XMK)
"RTN","XMJBM",234,0)
 Q
"RTN","XMJBM",235,0)
V ; Vaporize
"RTN","XMJBM",236,0)
 D VAPOR^XMJMOR(XMDUZ,XMK)
"RTN","XMJBM",237,0)
 Q
"RTN","XMJBM",238,0)
X ; Xmit Priority toggle (for Postmaster only)
"RTN","XMJBM",239,0)
 D XMTPRI^XMJMOR(XMDUZ,XMK)
"RTN","XMJBM",240,0)
 Q
"RTN","XMJBM1")
0^277^B8498226
"RTN","XMJBM1",1,0)
XMJBM1 ;ISC-SF/GMB-Manage Mail in Mailbox (cont.) ;07/19/2000  14:13
"RTN","XMJBM1",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMJBM1",3,0)
INIT(XMDUZ,XMRDR,XMABORT) ;
"RTN","XMJBM1",4,0)
 D CHECK^XMVVITAE
"RTN","XMJBM1",5,0)
 I XMDUZ'=DUZ,'$$RPRIV^XMXSEC D  Q
"RTN","XMJBM1",6,0)
 . S XMABORT=1
"RTN","XMJBM1",7,0)
 . D SHOW^XMJERR
"RTN","XMJBM1",8,0)
 D RDR(.XMRDR,.XMABORT)
"RTN","XMJBM1",9,0)
 Q
"RTN","XMJBM1",10,0)
RDR(XMRDR,XMABORT) ;
"RTN","XMJBM1",11,0)
 S XMRDR=XMV("RDR DEF")
"RTN","XMJBM1",12,0)
 Q:XMV("RDR ASK")="N"
"RTN","XMJBM1",13,0)
 N XMRDRTXT,XMOPT,XMOX,XMDIR
"RTN","XMJBM1",14,0)
 D SET^XMXSEC1("C",34036,.XMOPT,.XMOX) ; C:Classic
"RTN","XMJBM1",15,0)
 D SET^XMXSEC1("D",34037,.XMOPT,.XMOX) ; D:Detailed Full Screen
"RTN","XMJBM1",16,0)
 D SET^XMXSEC1("S",34038,.XMOPT,.XMOX) ; S:Summary Full Screen
"RTN","XMJBM1",17,0)
 I XMRDR="" S XMRDR="C"
"RTN","XMJBM1",18,0)
 S XMRDRTXT=XMOPT(XMRDR)
"RTN","XMJBM1",19,0)
 S XMDIR("A")=$$EZBLD^DIALOG(34047) ; Select message reader:
"RTN","XMJBM1",20,0)
 S XMDIR("B")=XMOX("O",XMRDR)_":"_XMRDRTXT
"RTN","XMJBM1",21,0)
 S XMDIR("??")="D QRDR^XMJBM1"
"RTN","XMJBM1",22,0)
 D XMDIR^XMJDIR(.XMDIR,.XMOPT,.XMOX,.XMRDR,.XMABORT)
"RTN","XMJBM1",23,0)
 Q
"RTN","XMJBM1",24,0)
QRDR ;
"RTN","XMJBM1",25,0)
 N XMTEXT
"RTN","XMJBM1",26,0)
 ;The Classic reader is the one that has been around forever.
"RTN","XMJBM1",27,0)
 ;The Full Screen reader has two flavors:
"RTN","XMJBM1",28,0)
 ;Detailed Full Screen contains a detailed message list.
"RTN","XMJBM1",29,0)
 ;Summary Full Screen contains a summary message list.
"RTN","XMJBM1",30,0)
 D BLD^DIALOG(34039,"","","XMTEXT","F")
"RTN","XMJBM1",31,0)
 I $P($G(^XMB(3.7,DUZ,0)),U,16)="" D
"RTN","XMJBM1",32,0)
 . ;You may choose a default MESSAGE READER under
"RTN","XMJBM1",33,0)
 . ;'Personal Preferences|User Options Edit'.
"RTN","XMJBM1",34,0)
 . ;Until you do, the Classic reader will be your default.
"RTN","XMJBM1",35,0)
 . D BLD^DIALOG(34040,"","","XMTEXT","F")
"RTN","XMJBM1",36,0)
 E  D
"RTN","XMJBM1",37,0)
 . ;Your default MESSAGE READER is the _XMRDRTXT_ reader.
"RTN","XMJBM1",38,0)
 . ;You may change your default MESSAGE READER under
"RTN","XMJBM1",39,0)
 . ;'Personal Preferences|User Options Edit'.
"RTN","XMJBM1",40,0)
 . D BLD^DIALOG(34041,XMRDRTXT,"","XMTEXT","F")
"RTN","XMJBM1",41,0)
 ;If you don't want to be asked this question again, and wish to use the 
"RTN","XMJBM1",42,0)
 ;XMRDRTXT_ reader exclusively, set the MESSAGE READER PROMPT to
"RTN","XMJBM1",43,0)
 ;"No, don't ask" under 'Personal Preferences|User Options Edit'.
"RTN","XMJBM1",44,0)
 D BLD^DIALOG(34042,XMRDRTXT,"","XMTEXT","F")
"RTN","XMJBM1",45,0)
 D MSG^DIALOG("WH","","","","XMTEXT")
"RTN","XMJBM1",46,0)
 Q
"RTN","XMJBM1",47,0)
ASKBSKT(XMDUZ,XMRDR,XMK,XMKN,XMABORT) ;
"RTN","XMJBM1",48,0)
 N XMKNUM
"RTN","XMJBM1",49,0)
 F  D ASKBSKT^XMJBN(XMDUZ,0,.XMK,.XMKN,.XMABORT) Q:XMABORT  D  Q:XMKNUM
"RTN","XMJBM1",50,0)
 . S XMKNUM=+$P($G(^XMB(3.7,XMDUZ,2,XMK,1,0)),U,4)
"RTN","XMJBM1",51,0)
 . D:'XMKNUM NOMSGS(XMDUZ,XMK,XMKN)
"RTN","XMJBM1",52,0)
 Q:XMABORT
"RTN","XMJBM1",53,0)
 Q:'XMKNUM
"RTN","XMJBM1",54,0)
 Q:XMRDR'="C"
"RTN","XMJBM1",55,0)
 N XMPARM,XMTEXT
"RTN","XMJBM1",56,0)
 S XMPARM(1)=$O(^XMB(3.7,XMDUZ,2,XMK,1,"C",""),-1)
"RTN","XMJBM1",57,0)
 S XMPARM(2)=XMKNUM
"RTN","XMJBM1",58,0)
 S XMPARM(3)=$P(^XMB(3.7,XMDUZ,2,XMK,0),U,2)
"RTN","XMJBM1",59,0)
 ;Last message number: |1|   Messages in basket: |2| (|3| new)
"RTN","XMJBM1",60,0)
 ;Enter ??? for help.
"RTN","XMJBM1",61,0)
 D BLD^DIALOG($S(XMPARM(3):34043.1,1:34043),.XMPARM,"","XMTEXT","F")
"RTN","XMJBM1",62,0)
 D MSG^DIALOG("WM","","","","XMTEXT")
"RTN","XMJBM1",63,0)
 Q
"RTN","XMJBM1",64,0)
NOMSGS(XMDUZ,XMK,XMKN) ;
"RTN","XMJBM1",65,0)
 W !,$$EZBLD^DIALOG(34044,XMKN) ; No messages in '|1|' basket.
"RTN","XMJBM1",66,0)
 Q:XMK<2
"RTN","XMJBM1",67,0)
 I XMDUZ'=DUZ,$G(XMV("PRIV"))'["R",$G(XMV("PRIV"))'["W" Q
"RTN","XMJBM1",68,0)
 W !
"RTN","XMJBM1",69,0)
 N DIR,DIRUT,X,Y
"RTN","XMJBM1",70,0)
 S DIR(0)="Y"
"RTN","XMJBM1",71,0)
 ;Since the '_XMKN_' basket is empty,
"RTN","XMJBM1",72,0)
 ;do you want to delete it
"RTN","XMJBM1",73,0)
 D BLD^DIALOG(34045,XMKN,"","DIR(""A"")")
"RTN","XMJBM1",74,0)
 S DIR("B")=$$EZBLD^DIALOG(39054) ; Yes
"RTN","XMJBM1",75,0)
 D ^DIR Q:'Y
"RTN","XMJBM1",76,0)
 D DELBSKT^XMXBSKT(XMDUZ,XMK)
"RTN","XMJBM1",77,0)
 W !,$$EZBLD^DIALOG(34046) ; Basket deleted.
"RTN","XMJBM1",78,0)
 Q
"RTN","XMJBN")
0^278^B36117943
"RTN","XMJBN",1,0)
XMJBN ;ISC-SF/GMB-Access new mail in mailbox ;10/30/2001  15:13
"RTN","XMJBN",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMJBN",3,0)
 ; Replaces ^XMA (ISC-WASH/THM/CAP)
"RTN","XMJBN",4,0)
 ; Entry points used by MailMan options (not covered by DBIA):
"RTN","XMJBN",5,0)
 ; NEW   XMNEW - Read new messages
"RTN","XMJBN",6,0)
NEW ;
"RTN","XMJBN",7,0)
 ; XMNEW    Number of new messages
"RTN","XMJBN",8,0)
 ; XMKMULT  1=New msgs in multiple baskets; 0=new msgs in one basket
"RTN","XMJBN",9,0)
 N XMABORT,XMK,XMKN,XMNEW,XMKMULT,XMNEWS
"RTN","XMJBN",10,0)
 S XMABORT=0
"RTN","XMJBN",11,0)
 D INIT^XMJBN1(XMDUZ,.XMK,.XMKN,.XMNEW,.XMKMULT,.XMABORT) Q:XMABORT
"RTN","XMJBN",12,0)
 S XMNEWS=1 ; Makes 'new'd msgs drop off list 'til next time
"RTN","XMJBN",13,0)
 I XMNEW=1 D  Q
"RTN","XMJBN",14,0)
 . N XMZ
"RTN","XMJBN",15,0)
 . S XMZ=$O(^XMB(3.7,XMDUZ,"N0",XMK,""))
"RTN","XMJBN",16,0)
 . I XMDUZ'=DUZ,'$$SURRACC^XMXSEC(XMDUZ,"",XMZ,$G(XMB(3.9,XMZ,0))) D  Q
"RTN","XMJBN",17,0)
 . . D ZSHOW^XMJERR
"RTN","XMJBN",18,0)
 . . D WAIT^XMXUTIL
"RTN","XMJBN",19,0)
 . I '$D(^XMB(3.7,XMDUZ,2,XMK,1,XMZ,0)) D ADDITN^XMUT4A(XMDUZ,"N0",XMK,XMZ)
"RTN","XMJBN",20,0)
 . D READNEW(XMDUZ,XMK,XMKN,XMZ)
"RTN","XMJBN",21,0)
 . D:$D(^XTMP("XM","MAKENEW",XMDUZ)) NEWAGAIN^XMJBN1(XMDUZ)
"RTN","XMJBN",22,0)
 F  D  Q:'$D(^XMB(3.7,XMDUZ,"N0"))!XMABORT
"RTN","XMJBN",23,0)
 . N XMDIR,XMOPT,XMOX,XMY
"RTN","XMJBN",24,0)
 . S XMDIR("A")=$$EZBLD^DIALOG(34085) ; Select New mail option
"RTN","XMJBN",25,0)
 . D SET^XMXSEC1("R",34086,.XMOPT,.XMOX)  ; Read new mail by basket
"RTN","XMJBN",26,0)
 . D SET^XMXSEC1("LB",34087,.XMOPT,.XMOX) ; List Baskets with new mail
"RTN","XMJBN",27,0)
 . D SET^XMXSEC1("LN",34088,.XMOPT,.XMOX) ; List all new messages
"RTN","XMJBN",28,0)
 . D SET^XMXSEC1("LP",34089,.XMOPT,.XMOX) ; List all priority messages
"RTN","XMJBN",29,0)
 . I '$D(^XMB(3.7,XMDUZ,"N")) S XMOPT("LP","?")=$$EZBLD^DIALOG(34018) ; You have no new priority messages.
"RTN","XMJBN",30,0)
 . D SET^XMXSEC1("P",34090,.XMOPT,.XMOX)  ; Print all new messages
"RTN","XMJBN",31,0)
 . D SET^XMXSEC1("S",34091,.XMOPT,.XMOX)  ; Scan all new messages
"RTN","XMJBN",32,0)
 . D SET^XMXSEC1("Q",34092,.XMOPT,.XMOX)  ; Quit
"RTN","XMJBN",33,0)
 . S XMDIR("B")=XMOX("O",XMV("NEW OPT"))_":"_XMOPT(XMV("NEW OPT"))
"RTN","XMJBN",34,0)
 . S XMDIR("??")="XM-U-R-READ NEW"
"RTN","XMJBN",35,0)
 . D XMDIR^XMJDIR(.XMDIR,.XMOPT,.XMOX,.XMY,.XMABORT) Q:XMABORT
"RTN","XMJBN",36,0)
 . K XMOPT,XMOX,XMDIR
"RTN","XMJBN",37,0)
 . D @XMY
"RTN","XMJBN",38,0)
 D:$D(^XTMP("XM","MAKENEW",XMDUZ)) NEWAGAIN^XMJBN1(XMDUZ)
"RTN","XMJBN",39,0)
 Q
"RTN","XMJBN",40,0)
LB ; List Baskets with new mail (Replaces NEW^XMA0A)
"RTN","XMJBN",41,0)
 N DIC,D,DZ
"RTN","XMJBN",42,0)
 S DIC="^XMB(3.7,"_XMDUZ_",2,"
"RTN","XMJBN",43,0)
 S DIC(0)="AEQ",D="B",DZ="??"
"RTN","XMJBN",44,0)
 S DIC("S")="I $P(^(0),U,2)"
"RTN","XMJBN",45,0)
 S DIC("W")="W ?31,$$EZBLD^DIALOG(34027.2,$P(^(0),U,2))" ; (|1| New)
"RTN","XMJBN",46,0)
 D DQ^DICQ
"RTN","XMJBN",47,0)
 Q
"RTN","XMJBN",48,0)
LN ; List all new messages (Replaces LIST^XMA0A)
"RTN","XMJBN",49,0)
 D LISTALL^XMJMLN(XMDUZ,"N0")
"RTN","XMJBN",50,0)
 Q
"RTN","XMJBN",51,0)
LP ; List all priority messages (Replaces PRIO^XMA0A)
"RTN","XMJBN",52,0)
 D LISTALL^XMJMLN(XMDUZ,"N")
"RTN","XMJBN",53,0)
 Q
"RTN","XMJBN",54,0)
P ; Print all new messages
"RTN","XMJBN",55,0)
 ; Replaces PRINT^XMA0A
"RTN","XMJBN",56,0)
 N XMSAVE,I
"RTN","XMJBN",57,0)
 F I="XMV(","DUZ","XMDUZ","XMKMULT" S XMSAVE(I)=""
"RTN","XMJBN",58,0)
 D EN^XUTMDEVQ("PRTNEW^XMJBN",$$EZBLD^DIALOG(34501),.XMSAVE) ; MailMan: Print
"RTN","XMJBN",59,0)
 Q
"RTN","XMJBN",60,0)
PRTNEW ; Print all new messages
"RTN","XMJBN",61,0)
 N XMSCAN,XMNEWPRT,XMFIRST
"RTN","XMJBN",62,0)
 S (XMSCAN,XMNEWPRT,XMFIRST)=1
"RTN","XMJBN",63,0)
 D R
"RTN","XMJBN",64,0)
 I $D(ZTQUEUED),$D(^XTMP("XM","MAKENEW",XMDUZ)) D NEWAGAIN^XMJBN1(XMDUZ)
"RTN","XMJBN",65,0)
 Q
"RTN","XMJBN",66,0)
Q ; Quit
"RTN","XMJBN",67,0)
 S XMABORT=1
"RTN","XMJBN",68,0)
 Q
"RTN","XMJBN",69,0)
S ; Scan all new messages
"RTN","XMJBN",70,0)
 N XMSCAN
"RTN","XMJBN",71,0)
 S XMSCAN=1
"RTN","XMJBN",72,0)
 D R
"RTN","XMJBN",73,0)
 Q
"RTN","XMJBN",74,0)
R ; Read new mail by basket, priority first.
"RTN","XMJBN",75,0)
 N XMTYPE,XMK,XMKN,XMZ,XMIA,XMKPRI
"RTN","XMJBN",76,0)
 S XMABORT=0 ; (required when printing new messages)
"RTN","XMJBN",77,0)
 S XMIA='$D(ZTQUEUED)
"RTN","XMJBN",78,0)
 S XMKPRI=0,(XMKN,XMKPRI("XMKN"))="" K ^TMP("XM",$J,"APX")
"RTN","XMJBN",79,0)
 F  D  Q:'$D(^XMB(3.7,XMDUZ,"N0"))!XMABORT
"RTN","XMJBN",80,0)
 . S XMTYPE=$S($D(^XMB(3.7,XMDUZ,"N")):"N",$D(^XMB(3.7,XMDUZ,"N0")):"N0",1:"")
"RTN","XMJBN",81,0)
 . I XMTYPE="" S XMABORT=1 W:'$D(ZTQUEUED) !,$$EZBLD^DIALOG(34017) Q  ; You have no new messages.
"RTN","XMJBN",82,0)
 . I 'XMKMULT D
"RTN","XMJBN",83,0)
 . . S XMK=$O(^XMB(3.7,XMDUZ,XMTYPE,0))
"RTN","XMJBN",84,0)
 . . S XMKN=$P(^XMB(3.7,XMDUZ,2,XMK,0),U)
"RTN","XMJBN",85,0)
 . E  D  Q:XMABORT
"RTN","XMJBN",86,0)
 . . D NXTBSKT^XMJBN1(XMDUZ,XMTYPE,.XMKN,.XMK,.XMKPRI) I 'XMK S XMABORT=1 Q
"RTN","XMJBN",87,0)
 . . Q:$G(XMSCAN)
"RTN","XMJBN",88,0)
 . . D ASKBSKT(XMDUZ,1,.XMK,.XMKN,.XMABORT) Q:XMABORT
"RTN","XMJBN",89,0)
 . . I XMTYPE="N",'$D(^XMB(3.7,XMDUZ,XMTYPE,XMK)) S XMTYPE="N0"
"RTN","XMJBN",90,0)
 . S XMZ=""
"RTN","XMJBN",91,0)
 . F  S XMZ=$O(^XMB(3.7,XMDUZ,XMTYPE,XMK,XMZ),XMV("NEW ORDER")) Q:XMZ=""  D  Q:XMABORT
"RTN","XMJBN",92,0)
 . . I '$D(^XMB(3.7,XMDUZ,2,XMK,1,XMZ,0)) D ADDITN^XMUT4A(XMDUZ,XMTYPE,XMK,XMZ)
"RTN","XMJBN",93,0)
 . . I $G(XMNEWPRT) D  Q
"RTN","XMJBN",94,0)
 . . . D PRTMULT^XMJMP(XMDUZ,XMK,XMKN,XMZ,0,1,.XMFIRST,"",.XMABORT)
"RTN","XMJBN",95,0)
 . . . I XMDUZ'=DUZ,$$SURRCONF^XMXSEC(XMDUZ,XMZ) D  Q
"RTN","XMJBN",96,0)
 . . . . D NONEW^XMXUTIL(XMDUZ,XMK,XMZ,1)
"RTN","XMJBN",97,0)
 . . . . S ^XTMP("XM","MAKENEW",XMDUZ,XMZ)=""
"RTN","XMJBN",98,0)
 . . I XMDUZ'=DUZ,'$$SURRACC^XMXSEC(XMDUZ,"",XMZ,$G(XMB(3.9,XMZ,0))) D  Q
"RTN","XMJBN",99,0)
 . . . D ZSHOW^XMJERR
"RTN","XMJBN",100,0)
 . . . D WAIT^XMXUTIL
"RTN","XMJBN",101,0)
 . . . D NONEW^XMXUTIL(XMDUZ,XMK,XMZ,1)
"RTN","XMJBN",102,0)
 . . . S ^XTMP("XM","MAKENEW",XMDUZ,XMZ)=""
"RTN","XMJBN",103,0)
 . . D READNEW(XMDUZ,XMK,XMKN,XMZ,.XMABORT)
"RTN","XMJBN",104,0)
 . Q:XMABORT
"RTN","XMJBN",105,0)
 . S:$D(^XMB(3.7,XMDUZ,"N0")) XMKMULT=1
"RTN","XMJBN",106,0)
 . Q:$G(XMSCAN)!'XMKMULT
"RTN","XMJBN",107,0)
 . W !!,$$EZBLD^DIALOG($S(XMTYPE="N0":34098,1:34099),XMKN) ; Done with new/priority mail in your '|1|' Basket.
"RTN","XMJBN",108,0)
 . W:$D(^XMB(3.7,XMDUZ,"N0")) !!
"RTN","XMJBN",109,0)
 K ^TMP("XM",$J,"APX")
"RTN","XMJBN",110,0)
 Q
"RTN","XMJBN",111,0)
READNEW(XMDUZ,XMK,XMKN,XMZ,XMABORT) ;
"RTN","XMJBN",112,0)
 N XMSECURE,XMPAKMAN,XMSECBAD ; Important 'new' - part of scramble and packman handling
"RTN","XMJBN",113,0)
 I '$D(^XMB(3.9,XMZ,0)) D ZAPIT^XMXMSGS2(XMDUZ,XMK,XMZ) Q
"RTN","XMJBN",114,0)
 D DISPMSG^XMJMP(XMDUZ,XMK,XMKN,XMZ,.XMSECBAD) Q:$G(XMSECBAD)
"RTN","XMJBN",115,0)
 D READMSG^XMJMOI($G(XMNEWS),XMDUZ,XMK,XMKN,XMZ,.XMABORT)
"RTN","XMJBN",116,0)
 Q
"RTN","XMJBN",117,0)
ASKBSKT(XMDUZ,XMNEWMSG,XMK,XMKN,XMABORT) ;
"RTN","XMJBN",118,0)
 ; XMNEWMSG 1=Read new mail; 0=Read any mail
"RTN","XMJBN",119,0)
 N XMDIC,XMPROMPT
"RTN","XMJBN",120,0)
 S XMDIC("W")="N XMPARM S XMPARM(2)=$P(^(0),U,2),XMPARM(1)=+$P($G(^(1,0)),U,4) W ?31,$$EZBLD^DIALOG($S(XMPARM(1)'=1:$S(XMPARM(2):34027,1:34026),XMPARM(2):34027.1,1:34026.1),.XMPARM)" ; (|1| messages, |2| new)
"RTN","XMJBN",121,0)
 I XMNEWMSG D
"RTN","XMJBN",122,0)
 . S XMPROMPT=34029 ; Read NEW mail in MAIL BASKET:
"RTN","XMJBN",123,0)
 . S XMDIC("S")="I $P(^(0),U,2)"
"RTN","XMJBN",124,0)
 . S XMDIC("B")=$P(^XMB(3.7,XMDUZ,2,XMK,0),U)
"RTN","XMJBN",125,0)
 E  S XMPROMPT=34028 ; Read mail in MAIL BASKET:
"RTN","XMJBN",126,0)
 D SELBSKT^XMJBU(XMDUZ,XMPROMPT,"",.XMDIC,.XMK,.XMKN)
"RTN","XMJBN",127,0)
 I XMK=U S XMABORT=1
"RTN","XMJBN",128,0)
 Q
"RTN","XMJBN",129,0)
NPBSKT(XMDUZ) ; Return the first priority read basket that has new messages.
"RTN","XMJBN",130,0)
 ; If none has new messages, return the first priority basket.
"RTN","XMJBN",131,0)
 N XMDEFALT
"RTN","XMJBN",132,0)
 S XMDEFALT=$$BNMSGCT^XMXUTIL(XMDUZ,1)_U_1_U_$$EZBLD^DIALOG(37005) ; IN
"RTN","XMJBN",133,0)
 I '$D(^XMB(3.7,XMDUZ,2,"AP")) Q XMDEFALT
"RTN","XMJBN",134,0)
 N XMK,XMKN
"RTN","XMJBN",135,0)
 S XMKN=""
"RTN","XMJBN",136,0)
 D NXTBSKT^XMJBN1(XMDUZ,"N0",.XMKN,.XMK)
"RTN","XMJBN",137,0)
 I $D(^TMP("XM",$J,"APX")) K ^TMP("XM",$J,"APX") Q $$BNMSGCT^XMXUTIL(XMDUZ,XMK)_U_XMK_U_XMKN
"RTN","XMJBN",138,0)
 N XMI
"RTN","XMJBN",139,0)
 S (XMI,XMK)=0
"RTN","XMJBN",140,0)
 S XMI=+$O(^XMB(3.7,XMDUZ,2,"AP",XMI))
"RTN","XMJBN",141,0)
 I 'XMI Q XMDEFALT
"RTN","XMJBN",142,0)
 F  S XMK=$O(^XMB(3.7,XMDUZ,2,"AP",XMI,XMK)) Q:'XMK  D
"RTN","XMJBN",143,0)
 . S XMK($$BSKTNAME^XMXUTIL(XMDUZ,XMK))=XMK
"RTN","XMJBN",144,0)
 S XMKN=$O(XMK(""))
"RTN","XMJBN",145,0)
 I XMKN="" Q XMDEFALT
"RTN","XMJBN",146,0)
 S XMK=XMK(XMKN)
"RTN","XMJBN",147,0)
 Q "0^"_XMK_U_XMKN
"RTN","XMJBN1")
0^279^B14482804
"RTN","XMJBN1",1,0)
XMJBN1 ;ISC-SF/GMB-Access new mail in mailbox (cont.) ;04/06/2002  08:52
"RTN","XMJBN1",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMJBN1",3,0)
INIT(XMDUZ,XMK,XMKN,XMNEW,XMKMULT,XMABORT) ;
"RTN","XMJBN1",4,0)
 N I F I="N","N0" D BOGUS(XMDUZ,I)
"RTN","XMJBN1",5,0)
 D CHECK^XMVVITAE
"RTN","XMJBN1",6,0)
 I XMDUZ'=DUZ,'$$RPRIV^XMXSEC D  Q
"RTN","XMJBN1",7,0)
 . S XMABORT=1
"RTN","XMJBN1",8,0)
 . D SHOW^XMJERR
"RTN","XMJBN1",9,0)
 S XMK=$O(^XMB(3.7,XMDUZ,"N0",0))
"RTN","XMJBN1",10,0)
 I XMK>0,XMK<1 D
"RTN","XMJBN1",11,0)
 . D FIXIT(XMDUZ)
"RTN","XMJBN1",12,0)
 . S XMK=$O(^XMB(3.7,XMDUZ,"N0",0))
"RTN","XMJBN1",13,0)
 I XMK="" D  Q
"RTN","XMJBN1",14,0)
 . S XMABORT=1
"RTN","XMJBN1",15,0)
 . S $P(^XMB(3.7,XMDUZ,0),U,6)="" ; Just to make sure we're in synch.
"RTN","XMJBN1",16,0)
 . N XMPARM S XMPARM(2)=XMV("NAME")
"RTN","XMJBN1",17,0)
 . W !,$$EZBLD^DIALOG($S(XMDUZ=DUZ:34017,1:38156.2),.XMPARM) ; You have no new messages. / |2| has no new messages.
"RTN","XMJBN1",18,0)
 S XMNEW=$$TNMSGCT^XMXUTIL(XMDUZ)
"RTN","XMJBN1",19,0)
 I $O(^XMB(3.7,XMDUZ,"N0",XMK)) D
"RTN","XMJBN1",20,0)
 . S XMKMULT=1
"RTN","XMJBN1",21,0)
 . W !!,$$EZBLD^DIALOG($S(XMDUZ=DUZ:34019,1:34019.1),XMV("NAME")) ; You have/|1| has new mail in more than one basket
"RTN","XMJBN1",22,0)
 E  S XMKMULT=0
"RTN","XMJBN1",23,0)
 S XMKN=$P(^XMB(3.7,XMDUZ,2,XMK,0),U)
"RTN","XMJBN1",24,0)
 Q
"RTN","XMJBN1",25,0)
BOGUS(XMDUZ,XMTYPE) ; Check for and kill bogus node.
"RTN","XMJBN1",26,0)
 ; This shouldn't be needed, but something (not MailMan) is setting it.
"RTN","XMJBN1",27,0)
 I $D(^XMB(3.7,XMDUZ,XMTYPE,0)) K ^XMB(3.7,XMDUZ,XMTYPE,0)
"RTN","XMJBN1",28,0)
 Q
"RTN","XMJBN1",29,0)
FIXIT(XMDUZ) ; In case mail in the waste basket is new.
"RTN","XMJBN1",30,0)
 N XMK,XMZ
"RTN","XMJBN1",31,0)
 S (XMK,XMZ)=""
"RTN","XMJBN1",32,0)
 F  S XMK=$O(^XMB(3.7,XMDUZ,"N0",XMK)) Q:XMK'<1!'XMK  D
"RTN","XMJBN1",33,0)
 . F  S XMZ=$O(^XMB(3.7,XMDUZ,"N0",XMK,XMZ)) Q:'XMZ  D
"RTN","XMJBN1",34,0)
 . . D:$D(^XMB(3.7,XMDUZ,2,XMK,1,XMZ,0)) NONEW^XMXUTIL(XMDUZ,XMK,XMZ,1)
"RTN","XMJBN1",35,0)
 . . K:$D(^XMB(3.7,XMDUZ,"N0",XMK,XMZ)) ^XMB(3.7,XMDUZ,"N0",XMK,XMZ)
"RTN","XMJBN1",36,0)
 . . K:$D(^XMB(3.7,XMDUZ,"N",XMK,XMZ)) ^XMB(3.7,XMDUZ,"N",XMK,XMZ)
"RTN","XMJBN1",37,0)
 Q
"RTN","XMJBN1",38,0)
NXTBSKT(XMDUZ,XMTYPE,XMKN,XMK,XMKPRI) ;
"RTN","XMJBN1",39,0)
 D NXTINIT(XMDUZ,XMTYPE)
"RTN","XMJBN1",40,0)
 I '$D(^TMP("XM",$J,XMTYPE)) D  Q
"RTN","XMJBN1",41,0)
 . S XMK=0,XMKN="",XMKPRI=0,XMKPRI("XMKN")=""
"RTN","XMJBN1",42,0)
 . K ^TMP("XM",$J,"APX")
"RTN","XMJBN1",43,0)
 F  D  Q:XMKN'=""
"RTN","XMJBN1",44,0)
 . I XMKN="" S XMKPRI=0,XMKPRI("XMKN")="" K ^TMP("XM",$J,"APX")
"RTN","XMJBN1",45,0)
 . I XMKN=XMKPRI("XMKN") D  Q:XMKN'=""
"RTN","XMJBN1",46,0)
 . . D NXTPRI(XMDUZ,XMTYPE,.XMKPRI)
"RTN","XMJBN1",47,0)
 . . S XMKN=XMKPRI("XMKN")
"RTN","XMJBN1",48,0)
 . E  S XMKPRI=0,XMKPRI("XMKN")=""
"RTN","XMJBN1",49,0)
 . F  S XMKN=$O(^TMP("XM",$J,XMTYPE,XMKN)) Q:XMKN=""  Q:'$D(^TMP("XM",$J,"APX",XMTYPE,XMKN))
"RTN","XMJBN1",50,0)
 S XMK=^TMP("XM",$J,XMTYPE,XMKN)
"RTN","XMJBN1",51,0)
 K ^TMP("XM",$J,XMTYPE)
"RTN","XMJBN1",52,0)
 Q
"RTN","XMJBN1",53,0)
NXTINIT(XMDUZ,XMTYPE) ;
"RTN","XMJBN1",54,0)
 N XMK,XMKN
"RTN","XMJBN1",55,0)
 K ^TMP("XM",$J,XMTYPE)
"RTN","XMJBN1",56,0)
 D BOGUS(XMDUZ,XMTYPE)
"RTN","XMJBN1",57,0)
 S XMK=0
"RTN","XMJBN1",58,0)
 F  S XMK=$O(^XMB(3.7,XMDUZ,XMTYPE,XMK)) Q:'XMK  D
"RTN","XMJBN1",59,0)
 . S XMKN=$P(^XMB(3.7,XMDUZ,2,XMK,0),U)
"RTN","XMJBN1",60,0)
 . S ^TMP("XM",$J,XMTYPE,XMKN)=XMK
"RTN","XMJBN1",61,0)
 Q
"RTN","XMJBN1",62,0)
NXTPRI(XMDUZ,XMTYPE,XMKPRI) ;
"RTN","XMJBN1",63,0)
 I XMKPRI=100 S XMKPRI("XMKN")="" Q
"RTN","XMJBN1",64,0)
 I $D(^XMB(3.7,XMDUZ,2,"AP")) D  I XMKPRI S ^TMP("XM",$J,"APX",XMTYPE,XMKPRI("XMKN"))="" Q
"RTN","XMJBN1",65,0)
 . N XMK,XMKN
"RTN","XMJBN1",66,0)
 . K ^TMP("XM",$J,"AP")
"RTN","XMJBN1",67,0)
 . S:XMKPRI XMKPRI=XMKPRI-.1
"RTN","XMJBN1",68,0)
 . S XMK=0
"RTN","XMJBN1",69,0)
 . F  S XMKPRI=$O(^XMB(3.7,XMDUZ,2,"AP",XMKPRI)) Q:'XMKPRI  D  Q:XMKPRI("XMKN")'=""
"RTN","XMJBN1",70,0)
 . . F  S XMK=$O(^XMB(3.7,XMDUZ,2,"AP",XMKPRI,XMK)) Q:'XMK  D
"RTN","XMJBN1",71,0)
 . . . S XMKN=$P(^XMB(3.7,XMDUZ,2,XMK,0),U)
"RTN","XMJBN1",72,0)
 . . . Q:'$D(^TMP("XM",$J,XMTYPE,XMKN))
"RTN","XMJBN1",73,0)
 . . . S ^TMP("XM",$J,"AP",XMKPRI,XMKN)=""
"RTN","XMJBN1",74,0)
 . . S XMKPRI("XMKN")=$O(^TMP("XM",$J,"AP",XMKPRI,XMKPRI("XMKN")))
"RTN","XMJBN1",75,0)
 . K ^TMP("XM",$J,"AP")
"RTN","XMJBN1",76,0)
 S XMKPRI=100
"RTN","XMJBN1",77,0)
 N XMIN
"RTN","XMJBN1",78,0)
 S XMIN=$$EZBLD^DIALOG(37005) ; IN
"RTN","XMJBN1",79,0)
 I $D(^TMP("XM",$J,XMTYPE,XMIN)) S XMKPRI("XMKN")=XMIN,^TMP("XM",$J,"APX",XMTYPE,XMKPRI("XMKN"))="" Q
"RTN","XMJBN1",80,0)
 S XMKPRI("XMKN")=""
"RTN","XMJBN1",81,0)
 Q
"RTN","XMJBN1",82,0)
 ; It used to be that the list of messages to "new" was kept in ^TMP.
"RTN","XMJBN1",83,0)
 ; But if the user got forced off for some reason, the global was lost,
"RTN","XMJBN1",84,0)
 ; and the messages were never "new"ed. So I changed to ^XTMP.  We check
"RTN","XMJBN1",85,0)
 ; ^XTMP whenever a user logs on (in ^XMVVITAE).
"RTN","XMJBN1",86,0)
 ; Possible problem: one user is in the middle of reading new messages
"RTN","XMJBN1",87,0)
 ; and "new"ing ones he wants to have "new" again, and a surrogate logs
"RTN","XMJBN1",88,0)
 ; on, and triggers an immediate "new"ing of all those messages.
"RTN","XMJBN1",89,0)
 ; I think it's an acceptable risk.  Maybe not.
"RTN","XMJBN1",90,0)
 ; This may be a case of 'damned if you do; damned if you don't'.
"RTN","XMJBN1",91,0)
 ; Perhaps we should also check ^XTMP in the wee hours of the morning
"RTN","XMJBN1",92,0)
 ; (in ^XMTDT), just in case the user doesn't log on again.
"RTN","XMJBN1",93,0)
NEWAGAIN(XMDUZ) ; "new" messages which the user wanted to "new".
"RTN","XMJBN1",94,0)
 S ^XTMP("XM",0)=$$FMADD^XLFDT(DT,7)_U_DT
"RTN","XMJBN1",95,0)
 N XMZ,XMK
"RTN","XMJBN1",96,0)
 S XMZ=""
"RTN","XMJBN1",97,0)
 F  S XMZ=$O(^XTMP("XM","MAKENEW",XMDUZ,XMZ)) Q:XMZ=""  D  K ^XTMP("XM","MAKENEW",XMDUZ,XMZ)
"RTN","XMJBN1",98,0)
 . S XMK=$O(^XMB(3.7,"M",XMZ,XMDUZ,0)) Q:'XMK
"RTN","XMJBN1",99,0)
 . Q:$D(^XMB(3.7,XMDUZ,"N0",XMK,XMZ))
"RTN","XMJBN1",100,0)
 . D MAKENEW^XMXUTIL(XMDUZ,XMK,XMZ,1)
"RTN","XMJBN1",101,0)
 Q
"RTN","XMJBU")
0^280^B5867813
"RTN","XMJBU",1,0)
XMJBU ;ISC-SF/GMB-Basket utilities ;04/06/2002  08:56
"RTN","XMJBU",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMJBU",3,0)
 ; (ISC-WASH/CAP/THM)
"RTN","XMJBU",4,0)
SELBSKT(XMDUZ,XMPROMPT,XMLAYGO,XMDIC,XMK,XMKN) ; Select a basket (Replaces S^XMA1B)
"RTN","XMJBU",5,0)
 ; XMPROMPT (in) Verbage for prompt
"RTN","XMJBU",6,0)
 ; XMLAYGO  (in) "L" - the user may create a new basket
"RTN","XMJBU",7,0)
 ;               ""  - the user may not create a new basket
"RTN","XMJBU",8,0)
 ; XMK      (out) basket number (=^ if user up-arrows out)
"RTN","XMJBU",9,0)
 ; XMKN     (out) basket name
"RTN","XMJBU",10,0)
 N DIC,DINUM,DA,Y,X
"RTN","XMJBU",11,0)
 I $G(XMLAYGO)["L" D
"RTN","XMJBU",12,0)
 . ; Find the first vacant basket spot.
"RTN","XMJBU",13,0)
 . F DINUM=2:1 Q:'$D(^XMB(3.7,XMDUZ,2,DINUM))
"RTN","XMJBU",14,0)
 . ; Postmaster baskets numbered above 999 are reserved for message queues.
"RTN","XMJBU",15,0)
 . I XMDUZ=.5,DINUM>999 S XMLAYGO=$TR(XMLAYGO,"L")
"RTN","XMJBU",16,0)
 ; Postmaster may not save a queued msg to his own basket. ***
"RTN","XMJBU",17,0)
 S DIC="^XMB(3.7,"_XMDUZ_",2,"
"RTN","XMJBU",18,0)
 S DA(1)=XMDUZ
"RTN","XMJBU",19,0)
 S DIC(0)="AEQ"_$G(XMLAYGO)
"RTN","XMJBU",20,0)
 I $G(XMPROMPT)'="" S DIC("A")=$S(+XMPROMPT=XMPROMPT:$$EZBLD^DIALOG(XMPROMPT),1:XMPROMPT)
"RTN","XMJBU",21,0)
 ; XMDIC("B")="@" means don't give a default
"RTN","XMJBU",22,0)
 I $G(XMDIC("B"))'="@" D
"RTN","XMJBU",23,0)
 . I $D(XMDIC("B")) S DIC("B")=XMDIC("B") Q
"RTN","XMJBU",24,0)
 . I $$BMSGCT^XMXUTIL(XMDUZ,1) S DIC("B")=$$EZBLD^DIALOG(37005) Q  ; IN
"RTN","XMJBU",25,0)
 . W !!,$$EZBLD^DIALOG(34044,$$EZBLD^DIALOG(37005)) ; No messages in 'IN' basket.
"RTN","XMJBU",26,0)
 S:$D(XMDIC("S")) DIC("S")=XMDIC("S")
"RTN","XMJBU",27,0)
 S:$D(XMDIC("W")) DIC("W")=XMDIC("W")
"RTN","XMJBU",28,0)
 D ^DIC I Y=-1 S XMK=U Q
"RTN","XMJBU",29,0)
 S XMK=$P(Y,U,1)
"RTN","XMJBU",30,0)
 S XMKN=$P(Y,U,2)
"RTN","XMJBU",31,0)
 Q
"RTN","XMJBU",32,0)
CHKXMKN(X) ; Input transform for file 3.7 (3.701,.01 BASKET)
"RTN","XMJBU",33,0)
 I X=+X,$D(^XMB(3.7,$G(XMDUZ,DUZ),2,X)) S X="`"_X Q
"RTN","XMJBU",34,0)
 K:X[""""!($A(X)=45) X I $D(X) K:$L(X)>30!($L(X)<3) X
"RTN","XMJBU",35,0)
 Q
"RTN","XMJBU",36,0)
NAMEBSKT(XMDUZ,XMK,XMKN) ; Rename an existing basket (Replaces REN^XMA11)
"RTN","XMJBU",37,0)
 ; XMK      (in) basket number
"RTN","XMJBU",38,0)
 ; XMKN     (in/out) basket name
"RTN","XMJBU",39,0)
 N DIR,X,XMFDA,XMKX
"RTN","XMJBU",40,0)
 I XMK'>1!(XMDUZ=.5&(XMK>999)) D  Q
"RTN","XMJBU",41,0)
 . W !,$$EZBLD^DIALOG(37201.1) ; The name of this basket may not be changed.
"RTN","XMJBU",42,0)
 ; *** I would rather use a ^DIE call, if I were sure that the user
"RTN","XMJBU",43,0)
 ; *** could not delete the basket or create a duplicate basket name.
"RTN","XMJBU",44,0)
 S DIR("A")=$$EZBLD^DIALOG(34048) ; Enter a new basket name
"RTN","XMJBU",45,0)
 S DIR("B")=XMKN
"RTN","XMJBU",46,0)
 S DIR(0)="3.701,.01"
"RTN","XMJBU",47,0)
 F  D ^DIR Q:$D(DIRUT)  D  Q:$D(X)
"RTN","XMJBU",48,0)
 . I X=XMKN D  Q
"RTN","XMJBU",49,0)
 . . W !,$C(7),$$EZBLD^DIALOG(34048.8) ; That's the same name.
"RTN","XMJBU",50,0)
 . . K X
"RTN","XMJBU",51,0)
 . S XMKX=$$FIND1^DIC(3.701,","_XMDUZ_",","X",X)
"RTN","XMJBU",52,0)
 . I XMKX,XMKX'=XMK D  Q
"RTN","XMJBU",53,0)
 . . W !,$C(7),$$EZBLD^DIALOG(34048.9) ; You already have a basket by this name.
"RTN","XMJBU",54,0)
 . . K X
"RTN","XMJBU",55,0)
 . S XMKN=X
"RTN","XMJBU",56,0)
 . S XMFDA(3.701,XMK_","_XMDUZ_",",.01)=XMKN
"RTN","XMJBU",57,0)
 . D FILE^DIE("","XMFDA")
"RTN","XMJBU",58,0)
 Q
"RTN","XMJDIR")
0^281^B19555701
"RTN","XMJDIR",1,0)
XMJDIR ;ISC-SF/GMB- MailMan's DIR ;10/31/2001  12:33
"RTN","XMJDIR",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMJDIR",3,0)
XMDIR(XMDIR,XMOPT,XMOX,XMY,XMABORT) ;
"RTN","XMJDIR",4,0)
 ; XMDIR("A")   User prompt
"RTN","XMJDIR",5,0)
 ; XMDIR("B")   Default choice
"RTN","XMJDIR",6,0)
 ; XMDIR(0)     Special instructions
"RTN","XMJDIR",7,0)
 ;              S - Show the choices
"RTN","XMJDIR",8,0)
 ;              C - Show choices in 2 columns, if necessary
"RTN","XMJDIR",9,0)
 ; XMDIR("?")   Help text for 1 ?
"RTN","XMJDIR",10,0)
 ; XMDIR("??")  Help text for 2 or more ?
"RTN","XMJDIR",11,0)
 N XMX
"RTN","XMJDIR",12,0)
 K XMY
"RTN","XMJDIR",13,0)
 I +XMDIR("A")=XMDIR("A") S XMDIR("A")=$$EZBLD^DIALOG(XMDIR("A"))
"RTN","XMJDIR",14,0)
 I $D(XMDIR("B")),+XMDIR("B")=XMDIR("B") S XMDIR("B")=$$EZBLD^DIALOG(XMDIR("B"))
"RTN","XMJDIR",15,0)
 I $G(XMDIR(0))["S" D
"RTN","XMJDIR",16,0)
 . W !!,?5,$$EZBLD^DIALOG(37008),! ; Select one of the following:
"RTN","XMJDIR",17,0)
 . D HELPCMD(.XMOPT,.XMOX,$S(XMDIR(0)["C":IOSL-$Y-3,1:IOSL-4))
"RTN","XMJDIR",18,0)
 F  D  Q:$D(XMY)!XMABORT
"RTN","XMJDIR",19,0)
 . W !!,XMDIR("A"),$S($D(XMDIR("B")):$P(XMDIR("B"),":",2,99)_"// ",1:"")
"RTN","XMJDIR",20,0)
 . R XMX:DTIME I '$T S XMABORT=DTIME Q
"RTN","XMJDIR",21,0)
 . I XMX[U S XMABORT=1 Q
"RTN","XMJDIR",22,0)
 . I XMX="" D  Q
"RTN","XMJDIR",23,0)
 . . I '$D(XMDIR("B")) S XMABORT=1 Q
"RTN","XMJDIR",24,0)
 . . S XMY=$P(XMDIR("B"),":",1)
"RTN","XMJDIR",25,0)
 . I $E(XMX)="?" D QHELP Q
"RTN","XMJDIR",26,0)
 . I $D(XMDIR("PRE")) X XMDIR("PRE")
"RTN","XMJDIR",27,0)
 . S XMY=$$COMMAND(.XMOPT,.XMOX,XMX)
"RTN","XMJDIR",28,0)
 . I $D(XMOPT(XMY)),'$D(XMOPT(XMY,"?")) Q
"RTN","XMJDIR",29,0)
 . I XMY=-1 D
"RTN","XMJDIR",30,0)
 . . W $C(7) D HELPSCR(.XMOPT,.XMOX)
"RTN","XMJDIR",31,0)
 . E  D SHOWERR(.XMOPT,XMY) I $D(XMOPT(XMY,"?X")) X XMOPT(XMY,"?X") I $T Q
"RTN","XMJDIR",32,0)
 . K XMY
"RTN","XMJDIR",33,0)
 Q
"RTN","XMJDIR",34,0)
SHOWERR(XMOPT,XMY) ; Show error message
"RTN","XMJDIR",35,0)
 W $C(7),!
"RTN","XMJDIR",36,0)
 I +XMOPT(XMY,"?")=XMOPT(XMY,"?") D  Q
"RTN","XMJDIR",37,0)
 . N XMTEXT
"RTN","XMJDIR",38,0)
 . D BLD^DIALOG(XMOPT(XMY,"?"),"","","XMTEXT","F")
"RTN","XMJDIR",39,0)
 . D MSG^DIALOG("WE","",IOM,"","XMTEXT")
"RTN","XMJDIR",40,0)
 I $D(XMOPT(XMY,"?",1)) D
"RTN","XMJDIR",41,0)
 . N I
"RTN","XMJDIR",42,0)
 . S I=0
"RTN","XMJDIR",43,0)
 . F  S I=$O(XMOPT(XMY,"?",I)) Q:'I  W !,XMOPT(XMY,"?",I)
"RTN","XMJDIR",44,0)
 W !,XMOPT(XMY,"?")
"RTN","XMJDIR",45,0)
 Q
"RTN","XMJDIR",46,0)
QHELP ;
"RTN","XMJDIR",47,0)
 I XMX="?" D HELPSCR(.XMOPT,.XMOX) Q
"RTN","XMJDIR",48,0)
 N XQH
"RTN","XMJDIR",49,0)
 S XQH=$G(XMDIR("??"),"XM-U-MO-READ")
"RTN","XMJDIR",50,0)
 I "@"[XQH D HELPSCR(.XMOPT,.XMOX) Q
"RTN","XMJDIR",51,0)
 I $E(XQH,1,2)="D " X XQH Q
"RTN","XMJDIR",52,0)
 D EN^XQH
"RTN","XMJDIR",53,0)
 Q
"RTN","XMJDIR",54,0)
HELPSCR(XMOPT,XMOX) ;
"RTN","XMJDIR",55,0)
 I $D(XMDIR("?")) D
"RTN","XMJDIR",56,0)
 . N XMTEXT
"RTN","XMJDIR",57,0)
 . W !
"RTN","XMJDIR",58,0)
 . D BLD^DIALOG(XMDIR("?"),"","","XMTEXT","F")
"RTN","XMJDIR",59,0)
 . D MSG^DIALOG("WH","",IOM,"","XMTEXT")
"RTN","XMJDIR",60,0)
 W !!,$$EZBLD^DIALOG(34054),! ; Enter a code from the list.
"RTN","XMJDIR",61,0)
 D HELPCMD(.XMOPT,.XMOX)
"RTN","XMJDIR",62,0)
 Q
"RTN","XMJDIR",63,0)
HELPCMD(XMOPT,XMOX,XMPMAX) ;
"RTN","XMJDIR",64,0)
 N XMCNT,XMCMD,XMROWS,I,XMHELP,XMLEN
"RTN","XMJDIR",65,0)
 S (XMCNT,XMLEN)=0,XMCMD=""
"RTN","XMJDIR",66,0)
 F  S XMCMD=$O(XMOPT(XMCMD)) Q:XMCMD=""  I '$D(XMOPT(XMCMD,"?")) S XMCNT=XMCNT+1 I $L(XMOX("O",XMCMD))>XMLEN S XMLEN=$L(XMOX("O",XMCMD))
"RTN","XMJDIR",67,0)
 I XMCNT<$G(XMPMAX,IOSL-4) D  Q
"RTN","XMJDIR",68,0)
 . F  S XMCMD=$O(XMOX("X",XMCMD)) Q:XMCMD=""  D
"RTN","XMJDIR",69,0)
 . . Q:$D(XMOPT(XMOX("X",XMCMD),"?"))
"RTN","XMJDIR",70,0)
 . . W !,?9,$E(XMCMD_"         ",1,10)_XMOPT(XMOX("X",XMCMD))
"RTN","XMJDIR",71,0)
 S XMROWS=XMCNT+1\2
"RTN","XMJDIR",72,0)
 S I=0
"RTN","XMJDIR",73,0)
 F  D  Q:I=XMROWS
"RTN","XMJDIR",74,0)
 . S XMCMD=$O(XMOX("X",XMCMD))
"RTN","XMJDIR",75,0)
 . Q:$D(XMOPT(XMOX("X",XMCMD),"?"))
"RTN","XMJDIR",76,0)
 . S I=I+1
"RTN","XMJDIR",77,0)
 . S XMHELP(I)=" "_$E(XMCMD_"      ",1,XMLEN+2)_XMOPT(XMOX("X",XMCMD))
"RTN","XMJDIR",78,0)
 S I=0
"RTN","XMJDIR",79,0)
 F  S XMCMD=$O(XMOX("X",XMCMD)) Q:XMCMD=""  D
"RTN","XMJDIR",80,0)
 . Q:$D(XMOPT(XMOX("X",XMCMD),"?"))
"RTN","XMJDIR",81,0)
 . S I=I+1
"RTN","XMJDIR",82,0)
 . W !,$E(XMHELP(I)_"                                   ",1,39)_"  "_$E(XMCMD_"      ",1,XMLEN+2)_$E(XMOPT(XMOX("X",XMCMD)),1,37-XMLEN)
"RTN","XMJDIR",83,0)
 S I=I+1
"RTN","XMJDIR",84,0)
 W:$D(XMHELP(I)) !,XMHELP(I)
"RTN","XMJDIR",85,0)
 Q
"RTN","XMJDIR",86,0)
COMMAND(XMOPT,XMOX,XMY) ; Check what the user enters against the list of
"RTN","XMJDIR",87,0)
 ; acceptable choices.  If the user enters something ambiguous,
"RTN","XMJDIR",88,0)
 ; ^DIR is called to ask the user to choose one.
"RTN","XMJDIR",89,0)
 I XMY?.E1C.E Q -1
"RTN","XMJDIR",90,0)
 I $L(XMY)>64 Q -1
"RTN","XMJDIR",91,0)
 N XMX,XMCD,XMLEN
"RTN","XMJDIR",92,0)
 S XMX=XMY
"RTN","XMJDIR",93,0)
 S XMLEN=$L(XMX)
"RTN","XMJDIR",94,0)
 S XMY=$$UP^XLFSTR(XMY)
"RTN","XMJDIR",95,0)
 I $D(XMOX("X",XMY)) D  Q XMCD
"RTN","XMJDIR",96,0)
 . S XMCD=XMOX("X",XMY)
"RTN","XMJDIR",97,0)
 . D PARROT
"RTN","XMJDIR",98,0)
 N XMTXT,XMC,XMT,XMCHOOSE
"RTN","XMJDIR",99,0)
 S XMCD=""
"RTN","XMJDIR",100,0)
 F  S XMCD=$O(XMOPT(XMCD)) Q:XMCD=""  S:'$D(XMOPT(XMCD,"?")) XMTXT(XMOPT(XMCD))=XMCD
"RTN","XMJDIR",101,0)
 S XMT=$CHAR($A($E(XMY))-1)_"~"
"RTN","XMJDIR",102,0)
 F  S XMT=$O(XMTXT(XMT)) Q:XMT=""!($E(XMT)'=$E(XMY))  I $$UP^XLFSTR($E(XMT,1,XMLEN))=XMY S XMCHOOSE(XMT)=""
"RTN","XMJDIR",103,0)
 S XMC=$CHAR($A($E(XMY))-1)_"~"
"RTN","XMJDIR",104,0)
 F  S XMC=$O(XMOX("X",XMC)) Q:XMC=""!($E(XMC)'=$E(XMY))  I $$UP^XLFSTR($E(XMC,1,XMLEN))=XMY S:'$D(XMOPT(XMOX("X",XMC),"?")) XMCHOOSE(XMOPT(XMOX("X",XMC)))=""
"RTN","XMJDIR",105,0)
 I '$D(XMCHOOSE) Q -1
"RTN","XMJDIR",106,0)
 N I,DIR,Y,X
"RTN","XMJDIR",107,0)
 S I=0,(DIR(0),XMT)=""
"RTN","XMJDIR",108,0)
 F  S XMT=$O(XMCHOOSE(XMT)) Q:XMT=""  S I=I+1,DIR(0)=DIR(0)_I_":"_XMT_";",XMCD(I)=XMTXT(XMT)
"RTN","XMJDIR",109,0)
 I I=1 D  Q $P(XMCD," ")  ; (for Q xxx)
"RTN","XMJDIR",110,0)
 . S XMCD=XMCD(I)
"RTN","XMJDIR",111,0)
 . D PARROT
"RTN","XMJDIR",112,0)
 S DIR(0)="SO^"_$E(DIR(0),1,$L(DIR(0))-1)
"RTN","XMJDIR",113,0)
 ;S DIR("A")="Choose 1-"_I
"RTN","XMJDIR",114,0)
 D ^DIR Q:$D(DIRUT) -1
"RTN","XMJDIR",115,0)
 Q $P(XMCD(Y)," ")  ; (for Q xxx)
"RTN","XMJDIR",116,0)
PARROT ;
"RTN","XMJDIR",117,0)
 I $E(XMOPT(XMCD),1,XMLEN)=XMX W $E(XMOPT(XMCD),XMLEN+1,99) Q
"RTN","XMJDIR",118,0)
 W "  ",XMOPT(XMCD)
"RTN","XMJDIR",119,0)
 Q
"RTN","XMJERR")
0^282^B630190
"RTN","XMJERR",1,0)
XMJERR ;ISC-SF/GMB-Error handling ;04/17/2002  09:54
"RTN","XMJERR",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMJERR",3,0)
ZSHOW ;
"RTN","XMJERR",4,0)
 N I,J,XMZ
"RTN","XMJERR",5,0)
 F I=1:1:XMERR D
"RTN","XMJERR",6,0)
 . W !
"RTN","XMJERR",7,0)
 . S XMZ=$G(^TMP("XMERR",$J,I,"XMZ"))
"RTN","XMJERR",8,0)
 . I XMZ D NOGOID^XMJMP2(XMZ,$G(^XMB(3.9,XMZ,0)))
"RTN","XMJERR",9,0)
 . S J=0
"RTN","XMJERR",10,0)
 . F  S J=$O(^TMP("XMERR",$J,I,"TEXT",J)) Q:'J  W !,^(J)
"RTN","XMJERR",11,0)
 W !
"RTN","XMJERR",12,0)
 K XMERR,^TMP("XMERR",$J)
"RTN","XMJERR",13,0)
 Q
"RTN","XMJERR",14,0)
SHOW ;
"RTN","XMJERR",15,0)
 N I,J
"RTN","XMJERR",16,0)
 W $C(7)
"RTN","XMJERR",17,0)
 F I=1:1:XMERR D
"RTN","XMJERR",18,0)
 . W !
"RTN","XMJERR",19,0)
 . S J=0
"RTN","XMJERR",20,0)
 . F  S J=$O(^TMP("XMERR",$J,I,"TEXT",J)) Q:'J  W !,^(J)
"RTN","XMJERR",21,0)
 K XMERR,^TMP("XMERR",$J)
"RTN","XMJERR",22,0)
 Q
"RTN","XMJMA")
0^283^B7017158
"RTN","XMJMA",1,0)
XMJMA ;ISC-SF/GMB-Interactive Answer ;04/24/2002  10:32
"RTN","XMJMA",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMJMA",3,0)
 ; Replaces ^XMA11A,^XMA11B,SH^XMA1B,^XMA2,^XMA20 (ISC-WASH/CAP/THM)
"RTN","XMJMA",4,0)
ANSWER(XMDUZ,XMZO,XMZOSUBJ,XMZOFROM) ;
"RTN","XMJMA",5,0)
 N XMABORT,XMZ,XMINSTR,XMSUBJ,XMZODATE
"RTN","XMJMA",6,0)
 S XMABORT=0
"RTN","XMJMA",7,0)
 D INIT(XMDUZ,XMZO,.XMZODATE,.XMINSTR,.XMABORT) Q:XMABORT
"RTN","XMJMA",8,0)
 S XMSUBJ=$E($$EZBLD^DIALOG(37006)_XMZOSUBJ,1,65) ; Re:
"RTN","XMJMA",9,0)
 D SUBJ^XMJMS(.XMSUBJ,.XMABORT) Q:XMABORT
"RTN","XMJMA",10,0)
 D CRE8XMZ^XMXSEND(XMSUBJ,.XMZ,1) I XMZ<1 S XMABORT=1 Q
"RTN","XMJMA",11,0)
 D EDITON^XMJMS(XMDUZ,XMZ)
"RTN","XMJMA",12,0)
 D PROCESS(XMDUZ,XMZO,XMZOSUBJ,XMZOFROM,XMZODATE,XMZ,XMSUBJ,.XMINSTR,.XMABORT)
"RTN","XMJMA",13,0)
 D CLEANUP^XMXADDR
"RTN","XMJMA",14,0)
 D:XMABORT=DTIME HALT^XMJMS($$EZBLD^DIALOG(34250)) ; answering
"RTN","XMJMA",15,0)
 D EDITOFF^XMJMS(XMDUZ)
"RTN","XMJMA",16,0)
 D:XMABORT KILLMSG^XMXUTIL(XMZ)
"RTN","XMJMA",17,0)
 Q
"RTN","XMJMA",18,0)
INIT(XMDUZ,XMZO,XMZODATE,XMINSTR,XMABORT) ;
"RTN","XMJMA",19,0)
 D INIT^XMJMS(XMDUZ,.XMABORT) Q:XMABORT
"RTN","XMJMA",20,0)
 S XMZODATE=$P($G(^XMB(3.9,XMZO,0)),U,3)
"RTN","XMJMA",21,0)
 Q:$$COPYAMT^XMXSEC1(XMZO,0)
"RTN","XMJMA",22,0)
 S XMABORT=1
"RTN","XMJMA",23,0)
 D SHOW^XMJERR
"RTN","XMJMA",24,0)
 ;This message has too many lines to 'Answer'.
"RTN","XMJMA",25,0)
 ;Use 'Write' or 'Reply', instead.
"RTN","XMJMA",26,0)
 N XMTEXT
"RTN","XMJMA",27,0)
 D BLD^DIALOG(34251,"","","XMTEXT","F")
"RTN","XMJMA",28,0)
 D MSG^DIALOG("WE","","","","XMTEXT")
"RTN","XMJMA",29,0)
 Q
"RTN","XMJMA",30,0)
PROCESS(XMDUZ,XMZO,XMZOSUBJ,XMZOFROM,XMZODATE,XMZ,XMSUBJ,XMINSTR,XMABORT) ;
"RTN","XMJMA",31,0)
 N XMRESTR ;Copying original message and network signature ...
"RTN","XMJMA",32,0)
 W !,$$EZBLD^DIALOG(34252)
"RTN","XMJMA",33,0)
 D COPY^XMXANSER(XMZO,XMZOSUBJ,XMZOFROM,XMZODATE,XMZ)
"RTN","XMJMA",34,0)
 D NETSIG^XMXEDIT(XMDUZ,XMZ)
"RTN","XMJMA",35,0)
 D BODY^XMJMS(XMDUZ,XMZ,XMSUBJ,.XMRESTR,.XMABORT) Q:XMABORT
"RTN","XMJMA",36,0)
 I XMZOFROM["@" D  Q:XMABORT
"RTN","XMJMA",37,0)
 . D REPLYTO^XMJMR(XMZO,.XMZOFROM,.XMABORT) Q:XMABORT
"RTN","XMJMA",38,0)
 . S XMINSTR("EXACT")=1 ; Match on exact domain name
"RTN","XMJMA",39,0)
 . W !,$$EZBLD^DIALOG(34253,XMZOFROM) ; Addressing answer to:
"RTN","XMJMA",40,0)
 E  W !,$$EZBLD^DIALOG(34254) ; Addressing answer to sender:
"RTN","XMJMA",41,0)
 D INIT^XMXADDR
"RTN","XMJMA",42,0)
 D ADDR^XMXADDR(XMDUZ,XMZOFROM,.XMINSTR,.XMRESTR)
"RTN","XMJMA",43,0)
 I '$D(^TMP("XMY",$J)) W !,$$EZBLD^DIALOG(34255,$$NAME^XMXUTIL(XMZOFROM)) ; Failed in addressing answer to:
"RTN","XMJMA",44,0)
 K XMRESTR("FLAGS") I $D(XMINSTR("EXACT")) K XMINSTR("EXACT")
"RTN","XMJMA",45,0)
 D TOWHOM^XMJMT(XMDUZ,$$EZBLD^DIALOG(34110),.XMINSTR,.XMRESTR,.XMABORT) Q:XMABORT  ; Send
"RTN","XMJMA",46,0)
 D SENDMSG^XMJMSO(XMDUZ,XMZ,XMSUBJ,.XMINSTR,.XMRESTR,.XMABORT) Q:XMABORT
"RTN","XMJMA",47,0)
 Q
"RTN","XMJMBULL")
0^284^B4320263
"RTN","XMJMBULL",1,0)
XMJMBULL ;ISC-SF/GMB-Manual Bulletin ;08/08/2000  14:11
"RTN","XMJMBULL",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMJMBULL",3,0)
 ; Replaces BULL^XMB (ISC-WASH/THM/RWF/CAP)
"RTN","XMJMBULL",4,0)
 ; Entry points used by MailMan options (not covered by DBIA):
"RTN","XMJMBULL",5,0)
 ; BULLETIN  XMPOST
"RTN","XMJMBULL",6,0)
BULLETIN ; Manually post a bulletin
"RTN","XMJMBULL",7,0)
 N XMBIEN,XMBNAME,XMPARM,XMINSTR,XMABORT
"RTN","XMJMBULL",8,0)
 S XMABORT=0
"RTN","XMJMBULL",9,0)
 D WHICH(.XMBIEN,.XMBNAME,.XMABORT) Q:XMABORT
"RTN","XMJMBULL",10,0)
 D GETPARMS(XMBIEN,.XMPARM,.XMINSTR,.XMABORT) Q:XMABORT
"RTN","XMJMBULL",11,0)
 D BULLETIN^XMKPO($G(XMDUZ,DUZ),XMBNAME,XMBIEN,.XMPARM,"","",.XMINSTR)
"RTN","XMJMBULL",12,0)
 Q
"RTN","XMJMBULL",13,0)
WHICH(XMBIEN,XMBNAME,XMABORT) ;
"RTN","XMJMBULL",14,0)
 N DIC
"RTN","XMJMBULL",15,0)
 S DIC(0)="AEQM",DIC="^XMB(3.6,"
"RTN","XMJMBULL",16,0)
 D ^DIC I Y=-1 S XMABORT=1 Q
"RTN","XMJMBULL",17,0)
 S XMBIEN=+Y
"RTN","XMJMBULL",18,0)
 S XMBNAME=$P(Y,U,2)
"RTN","XMJMBULL",19,0)
 Q
"RTN","XMJMBULL",20,0)
GETPARMS(XMBIEN,XMPARM,XMINSTR,XMABORT) ;
"RTN","XMJMBULL",21,0)
 N I,XMREC,XMI,DIR,Y,X,DIRUT,XMNOW
"RTN","XMJMBULL",22,0)
 S I=0
"RTN","XMJMBULL",23,0)
 F  S I=$O(^XMB(3.6,XMBIEN,1,I)) Q:'I  D  Q:XMABORT
"RTN","XMJMBULL",24,0)
 . S XMREC=^XMB(3.6,XMBIEN,1,I,0)
"RTN","XMJMBULL",25,0)
 . W !,XMREC
"RTN","XMJMBULL",26,0)
 . F  Q:XMREC'?.E1"|".N1"|".E  D  Q:XMABORT
"RTN","XMJMBULL",27,0)
 . . S XMI=+$P(XMREC,"|",2)
"RTN","XMJMBULL",28,0)
 . . S XMREC=$P(XMREC,"|",1)_$P(XMREC,"|",3,999)
"RTN","XMJMBULL",29,0)
 . . I XMI<0!(XMI>100) D  Q
"RTN","XMJMBULL",30,0)
 . . . S XMABORT=1
"RTN","XMJMBULL",31,0)
 . . . W !,$$EZBLD^DIALOG(34661,XMI) ; '|1|' is not a valid parameter.  Aborting!
"RTN","XMJMBULL",32,0)
 . . Q:$D(XMPARM(XMI))
"RTN","XMJMBULL",33,0)
 . . S DIR("A")=$$EZBLD^DIALOG(34660,XMI) ; Enter parameter |1|
"RTN","XMJMBULL",34,0)
 . . S DIR(0)="F^1:30"
"RTN","XMJMBULL",35,0)
 . . S DIR("??")="^D HELP^XMJMBULL"
"RTN","XMJMBULL",36,0)
 . . D ^DIR I $D(DIRUT) S XMABORT=1 Q
"RTN","XMJMBULL",37,0)
 . . S XMPARM(XMI)=Y
"RTN","XMJMBULL",38,0)
 Q:XMABORT
"RTN","XMJMBULL",39,0)
 S DIR("A")=$$EZBLD^DIALOG(34662) ; When do you want to send the bulletin?"
"RTN","XMJMBULL",40,0)
 S XMNOW=$$EZBLD^DIALOG(37007) ; NOW
"RTN","XMJMBULL",41,0)
 S DIR("B")=XMNOW
"RTN","XMJMBULL",42,0)
 S DIR(0)="DA^NOW::EFTX"
"RTN","XMJMBULL",43,0)
 D ^DIR I $D(DIRUT) S XMABORT=1 Q
"RTN","XMJMBULL",44,0)
 S:X'=XMNOW XMINSTR("LATER")=Y
"RTN","XMJMBULL",45,0)
 Q
"RTN","XMJMBULL",46,0)
HELP ;
"RTN","XMJMBULL",47,0)
 I '$D(^XMB(3.6,XMBIEN,4,XMI,1,1,0)) Q
"RTN","XMJMBULL",48,0)
 N I
"RTN","XMJMBULL",49,0)
 S I=0
"RTN","XMJMBULL",50,0)
 F  S I=$O(^XMB(3.6,XMBIEN,4,XMI,1,I)) Q:'I  W !,^(I,0)
"RTN","XMJMBULL",51,0)
 Q
"RTN","XMJMC")
0^285^B33661798
"RTN","XMJMC",1,0)
XMJMC ;ISC-SF/GMB-Copy message ;02/23/2000  15:34
"RTN","XMJMC",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMJMC",3,0)
 ; Replaces ^XMA2C,^XMA2C0 (ISC-WASH/CAP)
"RTN","XMJMC",4,0)
COPY(XMDUZ,XMK,XMZ,XMFROM) ;
"RTN","XMJMC",5,0)
 N XMABORT,XMWHICH,XMLR,XMSAME,XMZREC
"RTN","XMJMC",6,0)
 D INIT(XMDUZ,XMK,XMZ,XMFROM,.XMZREC,.XMWHICH,.XMLR,.XMSAME,.XMABORT) Q:XMABORT
"RTN","XMJMC",7,0)
 D COPYIT(XMDUZ,XMZ,$P(XMZREC,U,1),XMFROM,$P(XMZREC,U,3),XMWHICH,XMLR,XMSAME)
"RTN","XMJMC",8,0)
 Q
"RTN","XMJMC",9,0)
INIT(XMDUZ,XMK,XMZ,XMFROM,XMZREC,XMWHICH,XMLR,XMSAME,XMABORT) ;
"RTN","XMJMC",10,0)
 S XMZREC=^XMB(3.9,XMZ,0)
"RTN","XMJMC",11,0)
 S XMABORT=0
"RTN","XMJMC",12,0)
 D INIT^XMJMS(XMDUZ,.XMABORT) Q:XMABORT
"RTN","XMJMC",13,0)
 S XMWHICH=0
"RTN","XMJMC",14,0)
 D WHICH(XMZ,$$EZBLD^DIALOG(34600),.XMWHICH,.XMABORT) Q:XMABORT  ; copy
"RTN","XMJMC",15,0)
 I '$$COPYRECP^XMXSEC1(XMZ) D  Q
"RTN","XMJMC",16,0)
 . S (XMLR,XMSAME)=0
"RTN","XMJMC",17,0)
 . D SHOW^XMJERR
"RTN","XMJMC",18,0)
 D LISTR(.XMLR,.XMABORT) Q:XMABORT
"RTN","XMJMC",19,0)
 D TOSAME(.XMSAME,.XMABORT)
"RTN","XMJMC",20,0)
 Q
"RTN","XMJMC",21,0)
WHICH(XMZ,XMVERB,XMWHICH,XMABORT) ;
"RTN","XMJMC",22,0)
 N XMRESPS
"RTN","XMJMC",23,0)
 S XMRESPS=+$P($G(^XMB(3.9,XMZ,3,0)),U,4)
"RTN","XMJMC",24,0)
 I XMRESPS=0 S XMWHICH=0
"RTN","XMJMC",25,0)
 E  D WHICH^XMJMP(XMZ,XMRESPS,XMVERB,.XMWHICH,.XMABORT) Q:XMABORT!'$D(XMWHICH)
"RTN","XMJMC",26,0)
 Q:$$COPYAMT^XMXSEC1(XMZ,XMWHICH)
"RTN","XMJMC",27,0)
 S XMABORT=1
"RTN","XMJMC",28,0)
 D SHOW^XMJERR
"RTN","XMJMC",29,0)
 ;You may use the 'Transfer' option of the FileMan Editor
"RTN","XMJMC",30,0)
 ;to move text from this message or its responses into a new message.
"RTN","XMJMC",31,0)
 N XMTEXT
"RTN","XMJMC",32,0)
 D BLD^DIALOG(34601,"","","XMTEXT","F")
"RTN","XMJMC",33,0)
 D MSG^DIALOG("WH","","","","XMTEXT")
"RTN","XMJMC",34,0)
 Q
"RTN","XMJMC",35,0)
LISTR(XMLR,XMABORT) ;
"RTN","XMJMC",36,0)
 N DIR,Y
"RTN","XMJMC",37,0)
 S DIR("A")=$$EZBLD^DIALOG(34602) ; List original recipients in text
"RTN","XMJMC",38,0)
 S DIR("B")=$$EZBLD^DIALOG(39053),DIR(0)="Y",DIR("??")="XM-U-M-COPY-2" ; No
"RTN","XMJMC",39,0)
 D ^DIR I $D(DIRUT) S XMABORT=1 Q
"RTN","XMJMC",40,0)
 S XMLR=Y
"RTN","XMJMC",41,0)
 Q
"RTN","XMJMC",42,0)
TOSAME(XMSAME,XMABORT) ;
"RTN","XMJMC",43,0)
 N DIR,Y
"RTN","XMJMC",44,0)
 S DIR("A")=$$EZBLD^DIALOG(34603) ; Deliver to the same recipients
"RTN","XMJMC",45,0)
 S DIR("B")=$$EZBLD^DIALOG(39053),DIR(0)="Y",DIR("??")="XM-U-M-COPY-2" ; No
"RTN","XMJMC",46,0)
 D ^DIR I $D(DIRUT) S XMABORT=1 Q
"RTN","XMJMC",47,0)
 S XMSAME=Y
"RTN","XMJMC",48,0)
 Q:'XMSAME
"RTN","XMJMC",49,0)
 ;LOCAL recipients (NOT Recipients on remote network nodes) will be copied.
"RTN","XMJMC",50,0)
 N XMTEXT
"RTN","XMJMC",51,0)
 W !
"RTN","XMJMC",52,0)
 D BLD^DIALOG(34604,"","","XMTEXT","F")
"RTN","XMJMC",53,0)
 D MSG^DIALOG("WM","","","","XMTEXT")
"RTN","XMJMC",54,0)
 Q
"RTN","XMJMC",55,0)
COPYIT(XMDUZ,XMZO,XMSUBJO,XMFROM,XMDATEO,XMWHICH,XMLR,XMSAME) ;
"RTN","XMJMC",56,0)
 ; XMWHICH   List of responses to copy
"RTN","XMJMC",57,0)
 ; XMLR     1=list original recipients in msg; 0=don't
"RTN","XMJMC",58,0)
 ; XMSAME   1=deliver to the original recipients; 0=don't
"RTN","XMJMC",59,0)
 N XMZ,XMSUBJ,XMABORT
"RTN","XMJMC",60,0)
 S XMABORT=0
"RTN","XMJMC",61,0)
 D INIT^XMXADDR
"RTN","XMJMC",62,0)
 S XMSUBJ=$E($$EZBLD^DIALOG(34605,XMSUBJO),1,65) ; Copy of:
"RTN","XMJMC",63,0)
 D SUBJ^XMJMS(.XMSUBJ,.XMABORT) Q:XMABORT
"RTN","XMJMC",64,0)
 D CRE8XMZ^XMXSEND(XMSUBJ,.XMZ,1) I XMZ<1 S XMABORT=1 Q
"RTN","XMJMC",65,0)
 D:'$G(XMPAKMAN) EDITON^XMJMS(XMDUZ,XMZ)
"RTN","XMJMC",66,0)
 D CPROCESS(XMDUZ,XMZO,XMSUBJO,XMFROM,XMDATEO,XMWHICH,XMLR,XMSAME,XMZ,XMSUBJ,.XMABORT)
"RTN","XMJMC",67,0)
 D:XMABORT=DTIME HALT^XMJMS($$EZBLD^DIALOG(34606)) ; copying
"RTN","XMJMC",68,0)
 D:'$G(XMPAKMAN) EDITOFF^XMJMS(XMDUZ)
"RTN","XMJMC",69,0)
 D:XMABORT KILLMSG^XMXUTIL(XMZ)
"RTN","XMJMC",70,0)
 Q
"RTN","XMJMC",71,0)
CPROCESS(XMDUZ,XMZO,XMSUBJO,XMFROM,XMDATEO,XMWHICH,XMLR,XMSAME,XMZ,XMSUBJ,XMABORT) ;
"RTN","XMJMC",72,0)
 N XMINSTR,XMRESTR,XMC
"RTN","XMJMC",73,0)
 D COPYTEXT(XMZO,XMSUBJO,XMFROM,XMDATEO,XMZ,XMWHICH,.XMC)
"RTN","XMJMC",74,0)
 D:XMLR!XMSAME COPYRECP(XMLR,XMSAME,XMZO,XMZ,.XMINSTR,.XMC)
"RTN","XMJMC",75,0)
 S ^XMB(3.9,XMZ,2,0)="^3.92A^"_XMC_U_XMC_U_DT
"RTN","XMJMC",76,0)
 D ET^XMJMSO Q:XMABORT
"RTN","XMJMC",77,0)
 D TOWHOM^XMJMT(XMDUZ,$$EZBLD^DIALOG(34110),.XMINSTR,.XMRESTR,.XMABORT) Q:XMABORT  ; Send to add'l recipients
"RTN","XMJMC",78,0)
 I $G(XMPAKMAN) S XMINSTR("TYPE")=$S($P(^XMB(3.9,XMZO,0),U,7)["K":"K",1:"X")
"RTN","XMJMC",79,0)
 D SENDMSG^XMJMSO(XMDUZ,XMZ,XMSUBJ,.XMINSTR,.XMRESTR,.XMABORT) Q:XMABORT  ; transmit prompt
"RTN","XMJMC",80,0)
 N XMIEN
"RTN","XMJMC",81,0)
 S XMIEN=+$O(^XMB(3.9,XMZO,1,"C",XMDUZ,0))
"RTN","XMJMC",82,0)
 I XMIEN S ^XMB(3.9,XMZO,1,XMIEN,"C")=$$NOW^XLFDT
"RTN","XMJMC",83,0)
 Q
"RTN","XMJMC",84,0)
COPYTEXT(XMZO,XMSUBJO,XMFROM,XMDATEO,XMZ,XMWHICH,XMC) ;
"RTN","XMJMC",85,0)
 N I,XMRESP,XMRANGE
"RTN","XMJMC",86,0)
 W !,$$EZBLD^DIALOG(34607) ; Copying text
"RTN","XMJMC",87,0)
 D COPYHEAD(XMZO,XMSUBJO,XMFROM,XMDATEO,XMZ,"C",.XMC)
"RTN","XMJMC",88,0)
 F I=1:1:$L(XMWHICH,",") D
"RTN","XMJMC",89,0)
 . S XMRANGE=$P(XMWHICH,",",I)
"RTN","XMJMC",90,0)
 . Q:XMRANGE=""  ; (XMWHICH can end with a ",", giving us a null piece.)
"RTN","XMJMC",91,0)
 . F XMRESP=$P(XMRANGE,"-",1):1:$S(XMRANGE["-":$P(XMRANGE,"-",2),1:XMRANGE) D
"RTN","XMJMC",92,0)
 . . I XMRESP=0 D COPYRESP(XMRESP,XMZO,XMZ,.XMC) Q
"RTN","XMJMC",93,0)
 . . D COPYRESP(XMRESP,+$G(^XMB(3.9,XMZO,3,XMRESP,0)),XMZ,.XMC)
"RTN","XMJMC",94,0)
 Q
"RTN","XMJMC",95,0)
COPYHEAD(XMZO,XMSUBJ,XMFROM,XMDATE,XMZ,XMTYPE,XMC) ;
"RTN","XMJMC",96,0)
 N XMPRE
"RTN","XMJMC",97,0)
 S XMPRE=$S(XMTYPE="C":"",1:">")
"RTN","XMJMC",98,0)
 S ^XMB(3.9,XMZ,2,1,0)=XMPRE_$$EZBLD^DIALOG(34205)_": """_XMSUBJ_""""_$S(XMTYPE="C":" "_$$EZBLD^DIALOG(34537,XMZO),1:"") ; Original message:
"RTN","XMJMC",99,0)
 S ^XMB(3.9,XMZ,2,2,0)=XMPRE_$$EZBLD^DIALOG(34538,$$NAME^XMXUTIL(XMFROM)) ; From
"RTN","XMJMC",100,0)
 S ^XMB(3.9,XMZ,2,3,0)=XMPRE_$$EZBLD^DIALOG(34585,$$MMDT^XMXUTIL1(XMDATE)) ; Sent:
"RTN","XMJMC",101,0)
 S XMC=3
"RTN","XMJMC",102,0)
 Q
"RTN","XMJMC",103,0)
COPYRESP(XMRESP,XMZR,XMZ,XMC) ;
"RTN","XMJMC",104,0)
 N XMF,XMFROM,XMDT,XMZREC
"RTN","XMJMC",105,0)
 S XMC=XMC+1
"RTN","XMJMC",106,0)
 S ^XMB(3.9,XMZ,2,XMC,0)=""
"RTN","XMJMC",107,0)
 I XMRESP D
"RTN","XMJMC",108,0)
 . S XMZREC=$G(^XMB(3.9,XMZR,0))
"RTN","XMJMC",109,0)
 . S XMFROM=$$NAME^XMXUTIL($P(XMZREC,U,2))
"RTN","XMJMC",110,0)
 . S XMDT=$P(XMZREC,U,3)
"RTN","XMJMC",111,0)
 . S XMC=XMC+1
"RTN","XMJMC",112,0)
 . S ^XMB(3.9,XMZ,2,XMC,0)=$$EZBLD^DIALOG(34204,XMRESP)_": "_XMFROM_"    "_$$MMDT^XMXUTIL1(XMDT) ; Response #
"RTN","XMJMC",113,0)
 S XMF=.999999
"RTN","XMJMC",114,0)
 F  S XMF=$O(^XMB(3.9,XMZR,2,XMF)) Q:XMF=""  D
"RTN","XMJMC",115,0)
 . S XMC=XMC+1
"RTN","XMJMC",116,0)
 . W:XMC#50=0 "."
"RTN","XMJMC",117,0)
 . S ^XMB(3.9,XMZ,2,XMC,0)=^XMB(3.9,XMZR,2,XMF,0)
"RTN","XMJMC",118,0)
 Q
"RTN","XMJMC",119,0)
COPYRECP(XMLR,XMSAME,XMZO,XMZ,XMINSTR,XMC) ;
"RTN","XMJMC",120,0)
 N XMTO,XMNAME
"RTN","XMJMC",121,0)
 I XMLR D
"RTN","XMJMC",122,0)
 . W !,$$EZBLD^DIALOG($S(XMSAME:34610,1:34611)) ; Copying recipients into text (and onto message)
"RTN","XMJMC",123,0)
 . N XMTEXT,X
"RTN","XMJMC",124,0)
 . S XMTEXT=$$EZBLD^DIALOG(34608) ; Original Recipients
"RTN","XMJMC",125,0)
 . S XMC=XMC+1,^XMB(3.9,XMZ,2,XMC,0)=""
"RTN","XMJMC",126,0)
 . S XMC=XMC+1,^XMB(3.9,XMZ,2,XMC,0)=XMTEXT
"RTN","XMJMC",127,0)
 . S X="",$P(X,"-",$L(XMTEXT)+1)="" ; "-------------------"
"RTN","XMJMC",128,0)
 . S XMC=XMC+1,^XMB(3.9,XMZ,2,XMC,0)=X
"RTN","XMJMC",129,0)
 E  W !,$$EZBLD^DIALOG(34612) ; Copying recipients onto message
"RTN","XMJMC",130,0)
 S XMTO=""
"RTN","XMJMC",131,0)
 F  S XMTO=$O(^XMB(3.9,XMZO,1,"C",XMTO)) Q:XMTO=""  D
"RTN","XMJMC",132,0)
 . I XMSAME,XMTO=+XMTO W ! D ADDR^XMXADDR(XMDUZ,"`"_XMTO,.XMINSTR)
"RTN","XMJMC",133,0)
 . Q:'XMLR
"RTN","XMJMC",134,0)
 . I +XMTO=XMTO S XMNAME=$$NAME^XMXUTIL(XMTO)
"RTN","XMJMC",135,0)
 . E  I $L(XMTO)<30 S XMNAME=XMTO
"RTN","XMJMC",136,0)
 . E  S XMNAME=$P($G(^XMB(3.9,XMZO,1,$O(^XMB(3.9,XMZO,1,"C",XMTO,0)),0)),U,1)
"RTN","XMJMC",137,0)
 . S XMC=XMC+1,^XMB(3.9,XMZ,2,XMC,0)=XMNAME
"RTN","XMJMC",138,0)
 Q
"RTN","XMJMCODE")
0^286^B37745565
"RTN","XMJMCODE",1,0)
XMJMCODE ;ISC-SF/GMB-Message En/Decryption ;08/24/2001  10:56
"RTN","XMJMCODE",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMJMCODE",3,0)
 ; Replaces ^XME,^XME1 (ISC-WASH/CAP/THM)
"RTN","XMJMCODE",4,0)
ENCMSG(XMZ) ; Encode a message
"RTN","XMJMCODE",5,0)
 N I
"RTN","XMJMCODE",6,0)
 W:$G(XMIA) !,$$EZBLD^DIALOG(34615) ; Scrambling...
"RTN","XMJMCODE",7,0)
 S I=.999999
"RTN","XMJMCODE",8,0)
 F  S I=$O(^XMB(3.9,XMZ,2,I)) Q:I'>0  S ^(0)=$$ENCSTR(^XMB(3.9,XMZ,2,I,0))
"RTN","XMJMCODE",9,0)
 Q
"RTN","XMJMCODE",10,0)
ENCSTR(XMCLEAR) ; Encode a string
"RTN","XMJMCODE",11,0)
 N I,XMCODED
"RTN","XMJMCODE",12,0)
 S XMCODED=""
"RTN","XMJMCODE",13,0)
 F I=1:1:$L(XMCLEAR) S XMCODED=XMCODED_$C($F(XMSECURE(I#XMSECURE+1),$E(XMCLEAR,I))+30)
"RTN","XMJMCODE",14,0)
 Q XMCODED
"RTN","XMJMCODE",15,0)
DECMSG(XMZ) ; Decode a message
"RTN","XMJMCODE",16,0)
 N I
"RTN","XMJMCODE",17,0)
 W:$G(XMIA) !,$$EZBLD^DIALOG(34616) ; UnScrambling...
"RTN","XMJMCODE",18,0)
 S I=.999999
"RTN","XMJMCODE",19,0)
 F  S I=$O(^XMB(3.9,XMZ,2,I)) Q:I'>0  S ^(0)=$$DECSTR(^XMB(3.9,XMZ,2,I,0))
"RTN","XMJMCODE",20,0)
 Q
"RTN","XMJMCODE",21,0)
DECSTR(XMCODED) ; Decode a string
"RTN","XMJMCODE",22,0)
 N I,XMCLEAR
"RTN","XMJMCODE",23,0)
 S XMCLEAR=""
"RTN","XMJMCODE",24,0)
 F I=1:1:$L(XMCODED) S XMCLEAR=XMCLEAR_$E(XMSECURE(I#XMSECURE+1),$A(XMCODED,I)-31)
"RTN","XMJMCODE",25,0)
 Q XMCLEAR
"RTN","XMJMCODE",26,0)
CRE8KEY(XMKEY,XMHINT,XMABORT) ;
"RTN","XMJMCODE",27,0)
 D ASKKEY(.XMKEY,.XMABORT) Q:XMABORT
"RTN","XMJMCODE",28,0)
 N DIR,X,Y
"RTN","XMJMCODE",29,0)
 S DIR(0)="3.9,1.8"
"RTN","XMJMCODE",30,0)
 S DIR("A")=$$EZBLD^DIALOG(34617) ; Enter Scramble Hint
"RTN","XMJMCODE",31,0)
 D ^DIR I $D(DUOUT)!$D(DTOUT) S XMABORT=1 Q
"RTN","XMJMCODE",32,0)
 S XMHINT=Y
"RTN","XMJMCODE",33,0)
 Q
"RTN","XMJMCODE",34,0)
KEYOK(XMZ,XMHINT) ; Ask user for key and make sure it's right
"RTN","XMJMCODE",35,0)
 N XMKEY,XMTRY,XMOK,XMABORT
"RTN","XMJMCODE",36,0)
 U IO(0)
"RTN","XMJMCODE",37,0)
 W !!,$$EZBLD^DIALOG(34624) ; This message has been secured with a password:
"RTN","XMJMCODE",38,0)
 D NOGOID^XMJMP2(XMZ,$G(^XMB(3.9,XMZ,0)))
"RTN","XMJMCODE",39,0)
 I " "[XMHINT D
"RTN","XMJMCODE",40,0)
 . W !,$$EZBLD^DIALOG(34620.1) ; There is no scramble hint.
"RTN","XMJMCODE",41,0)
 E  D
"RTN","XMJMCODE",42,0)
 . ; The scramble hint is: '_XMHINT_'
"RTN","XMJMCODE",43,0)
 . W !,$$EZBLD^DIALOG(34620,XMHINT)
"RTN","XMJMCODE",44,0)
 S (XMOK,XMABORT)=0
"RTN","XMJMCODE",45,0)
 F XMTRY=1:1:3 D  Q:XMOK!XMABORT
"RTN","XMJMCODE",46,0)
 . D ASKKEY(.XMKEY,.XMABORT) Q:XMABORT
"RTN","XMJMCODE",47,0)
 . I $$GOODKEY(XMZ,XMKEY) S XMOK=1 Q
"RTN","XMJMCODE",48,0)
 . W $C(7),$$EZBLD^DIALOG(34621,XMTRY) ; "   Not the proper password.  Strike _XMTRY_.
"RTN","XMJMCODE",49,0)
 I 'XMOK,'XMABORT W $$EZBLD^DIALOG(34622) ; "  Yer out!
"RTN","XMJMCODE",50,0)
 I 'XMOK!XMABORT K XMSECURE
"RTN","XMJMCODE",51,0)
 Q 'XMABORT&XMOK
"RTN","XMJMCODE",52,0)
ASKKEY(XMKEY,XMABORT) ;
"RTN","XMJMCODE",53,0)
 F  D  Q:XMKEY'="?"!XMABORT
"RTN","XMJMCODE",54,0)
 . W !,$$EZBLD^DIALOG(34618) ; "Enter Scramble Password: "
"RTN","XMJMCODE",55,0)
 . X ^%ZOSF("EOFF") R XMKEY:15 S:'$T XMKEY=U X ^%ZOSF("EON") U IO
"RTN","XMJMCODE",56,0)
 . I XMKEY[U S XMABORT=1 Q
"RTN","XMJMCODE",57,0)
 . I $L(XMKEY)>2,$L(XMKEY)<21 S XMKEY=$$UP^XLFSTR(XMKEY) Q:$L(XMKEY)+1'=$L(XMKEY,$E(XMKEY))
"RTN","XMJMCODE",58,0)
 . S XMKEY="?"
"RTN","XMJMCODE",59,0)
 . ;The scramble password is a secret code which must be entered by the
"RTN","XMJMCODE",60,0)
 . ;reader in order to see the message.  Upper and lower case characters
"RTN","XMJMCODE",61,0)
 . ;are treated the same.  (The password is not case sensitive.)
"RTN","XMJMCODE",62,0)
 . ;The password must be from 3 to 20 characters long, and may not be
"RTN","XMJMCODE",63,0)
 . ;just one repeating character.
"RTN","XMJMCODE",64,0)
 . W !
"RTN","XMJMCODE",65,0)
 . D BLD^DIALOG(34619,"","","XMTEXT","F")
"RTN","XMJMCODE",66,0)
 . D MSG^DIALOG("WH","","","","XMTEXT")
"RTN","XMJMCODE",67,0)
 . W !
"RTN","XMJMCODE",68,0)
 Q
"RTN","XMJMCODE",69,0)
GOODKEY(XMZ,XMKEY) ; Function checks key and make sure it's right.
"RTN","XMJMCODE",70,0)
 ; If it is, XMSECURE is defined, and function returns 1;
"RTN","XMJMCODE",71,0)
 ; Else XMSECURE is not defined, and function returns 0
"RTN","XMJMCODE",72,0)
 D LOADCODE
"RTN","XMJMCODE",73,0)
 D ADJUST(.XMKEY)
"RTN","XMJMCODE",74,0)
 I $$ENCSTR(XMKEY)=$E($G(^XMB(3.9,XMZ,"K")),2,99) Q 1
"RTN","XMJMCODE",75,0)
 K XMSECURE
"RTN","XMJMCODE",76,0)
 Q 0
"RTN","XMJMCODE",77,0)
ADJUST(XMKEY) ; Capitalize the key, pad the key, & adjust cylinder with key
"RTN","XMJMCODE",78,0)
 N I,J,XMRW
"RTN","XMJMCODE",79,0)
 S:XMKEY?.E1L.E XMKEY=$$UP^XLFSTR(XMKEY)
"RTN","XMJMCODE",80,0)
 F  Q:$L(XMKEY)>XMSECURE  S XMKEY=XMKEY_XMKEY
"RTN","XMJMCODE",81,0)
 S XMKEY=$E(XMKEY,1,XMSECURE)
"RTN","XMJMCODE",82,0)
 S XMRW=0
"RTN","XMJMCODE",83,0)
 F I=1:1:XMSECURE S XMRW=XMRW+$A(XMKEY,I)
"RTN","XMJMCODE",84,0)
 S XMRW=XMRW#96
"RTN","XMJMCODE",85,0)
 S:$G(XMPAKMAN) XMPAKMAN("XMRW")=XMRW
"RTN","XMJMCODE",86,0)
 F I=1:1:XMSECURE D
"RTN","XMJMCODE",87,0)
 . S J=$F(XMSECURE(I),$E(XMKEY,I))-1+XMRW#40
"RTN","XMJMCODE",88,0)
 . S XMSECURE(I)=$E(XMSECURE(I),J,999)_$E(XMSECURE(I),1,J-1)
"RTN","XMJMCODE",89,0)
 Q
"RTN","XMJMCODE",90,0)
LOADCODE ; Load Bazeries Cylinder
"RTN","XMJMCODE",91,0)
 N XMLINE,I
"RTN","XMJMCODE",92,0)
 F I=1:1 S XMLINE=$P($T(Z+I),";",3,9) Q:XMLINE=""  S XMSECURE(I)=XMLINE
"RTN","XMJMCODE",93,0)
 S XMSECURE=I-1
"RTN","XMJMCODE",94,0)
 Q
"RTN","XMJMCODE",95,0)
Z ;;
"RTN","XMJMCODE",96,0)
 ;;j+?F}hmi<Q#uZ|]Jdgwb'52NBr,fP6&:{s./*E(4an)A-Y 7cKMt[Ce;OGD=op"~UL0Xy89x%1lv!VH@\>_R3zkTS$`WI^q
"RTN","XMJMCODE",97,0)
 ;;~7C|(lbZo5f&mz3*}E{ `eVtGSMN"I>WBy48K/THiu^[1Fcaqp,_L=h.j]X<AP?O$@YQ\d!rU9;:D)2gk+n%J-wR6vs'0x#
"RTN","XMJMCODE",98,0)
 ;;j+?F}hmi<Q#uZ|]Jdgwb'52NBr,fP6&:{s./*E(4an)A-Y 7cKMt[Ce;OGD=op"~UL0Xy89x%1lv!VH@\>_R3zkTS$`WI^q
"RTN","XMJMCODE",99,0)
 ;;:eR^K{=o1$+VM3qd@h8ks<W;Hzpu-wbrmTNix?7GYQSlv'*~(4a".c}g[E|%>9O#/0JIF\yj2!Ptn)_D B]C6A&`ZfX,U5L
"RTN","XMJMCODE",100,0)
 ;;CNl<v_F8sDZfGmUy&ui'%T:+z]$>OVxMw)^n.6d *ge;oY(kjHq,[QE-|WRh2~SP1/}aBLK"3J45t{cbpr09A`!7XI#?=@\
"RTN","XMJMCODE",101,0)
 ;;~7C|(lbZo5f&mz3*}E{ `eVtGSMN"I>WBy48K/THiu^[1Fcaqp,_L=h.j]X<AP?O$@YQ\d!rU9;:D)2gk+n%J-wR6vs'0x#
"RTN","XMJMCODE",102,0)
 ;;q^,M?Q$+E%:ICN"PxdHc3w_~k[-m.s/}u|5 zOh4'8#;v!`FeSV7t(2U]fJlpTa&D=96@\n>ZGiRKAX)1jr0bLBgYy*<o{W
"RTN","XMJMCODE",103,0)
 ;;`kC4xY$)*8-1o3NXJ.2 ;n0bK|=?d}g{HQUmsShGc[Ai<l>#F5Iqf9BMRpu~V&Z/a:!7TLtz6Ery,wePjD+v(_%^"O'@W\]
"RTN","XMJMCODE",104,0)
 ;; 6[2F5ETNc/mjglK0bZ<CHvp-)~IV%,=}79Y:i+r(yeGD;zJ"4'qd.sh?*on#&kM3XfA\!_S]BWLQO@U8RtP$`^|u>wx{1a
"RTN","XMJMCODE",105,0)
 ;;$7q_@*0u<\E~t(zW/QbT,3yR>v?}U1D^4:J|h{"nerGxsPH[ C'K8I2g)Ya&oZ#9dSi.kNjfB6A!`XF]l+-wpm=cMO;5L%V
"RTN","XMJMCODE",106,0)
 ;;fk&A^NROib:7sa>JIyo'Z;]H-)qx/dDX9FgwL8|01@r.pSQ6~432_5"}?<EC+UzntWG=,Vm*jK\#h!`M TcB{YvPeu(%l$[
"RTN","XMJMCODE",107,0)
 ;;(wFr,+[Lylm=RPJ:9DI)|_UNMT~;K/{8k6-% vzBj7q3'x\"ZgE*dHus#V4Ytpc!GCb1O0@WQah}25o&`$eS>fn<.Xi^?]A
"RTN","XMJMCODE",108,0)
 ;;`B8Fr{$hy]L,NeKXtc'asxbp*@nA~PiVQ -OoJ)R;/v_9}(?|UD<lMIz%\Y6Sw2C4=g&7u":+d!E#T.5k[j^1GHmZ0f>3qW
"RTN","XMJMCODE",109,0)
 ;;ex3:uFt*+L-hR$Mp4(<Y[ryl\~TK>1"'Pi7Nd}G5#/2WXInQ9|j{. 6!SJ0Oz8V%wA_D@Uvac=g,o;Hk?mb]EBq&f^`C)sZ
"RTN","XMJMCODE",110,0)
 ;;kO;/"1r?[x#EloIz.<Vpb|8WL{K&a%:tny}`Quv5h-m2U0>9M]j)fNX7S@PYD$='T_Cg!JAq+H^FGs(i,6ce Bwd*~RZ\43
"RTN","XMJMCODE",111,0)
 ;;(r{dz)P5F1H'a=sm^g"Eu-%7&\.UJxy<h q?vw*o+#2TV}W|L0QI9iXtOB:Y]e3>4$`p6fnj8cSM;Kb_Z[GC/A!@NlDkR~,
"RTN","XMJMCODE",112,0)
 ;;Z#;Fr|WdD\5=U{kf`XR0w~[A&L>}p"!mIMY4t2q8)1gx^hi K.Vco<7TJ3/*@QO(-SvB:y6N$a_bGj'Heu]l+%zsn9?P,EC
"RTN","XMJMCODE",113,0)
 ;;M|.y]37'\p6{UAz^fm4Ik"9c&gn;D#le+=VB*J8bG%Z2hQtu_>,~vW/}ji:X`NY0[w5rHq)O- LSo?a!T1KE@P<FxsR$C(d
"RTN","XMJMCODE",114,0)
 ;;|Qv<[=NC#}!zO$GtF/,KjU;W6S9rV+%@'-:R3e&D7TBq8(o.?k"g>L_Z)2*Pyx{X05diHaphb41fM]Im`\lYAncs~EwJ^ u
"RTN","XMJMCODE",115,0)
 ;;B*6IQt9jf|YH7%gdi<cO3\mN5{&'Uv1/^Gl0V)w>`z@#A4_To b]DnJx$Zyk+Ku8pCrPRSq!?:MaEs[,-=L2WFeX~;h(}."
"RTN","XMJMCODE",116,0)
 ;;
"RTN","XMJMD")
0^33^B29661397
"RTN","XMJMD",1,0)
XMJMD ;ISC-SF/GMB-Later Messages ;04/17/2002  09:56
"RTN","XMJMD",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMJMD",3,0)
 ; Replaces ^XMB1 (ISC-WASH/THM/CAP)
"RTN","XMJMD",4,0)
 ; Entry points are:
"RTN","XMJMD",5,0)
 ; EDIT     Change/Delete Later'd messages for a particular user
"RTN","XMJMD",6,0)
 ; REPORT   Report on Later'd messages for a particular user
"RTN","XMJMD",7,0)
 ; LATER    Add/Edit Later'd Dates for a particular user/message
"RTN","XMJMD",8,0)
 ; LTRADD   Add Later'd delivery date for a particular user/message
"RTN","XMJMD",9,0)
 ; DELUSER  Delete all Later'd messages for a particular user
"RTN","XMJMD",10,0)
 ; DELMSG   Delete all Later'd dates for a particular message
"RTN","XMJMD",11,0)
 ;
"RTN","XMJMD",12,0)
 ; Entry points used by MailMan options (not covered by DBIA):
"RTN","XMJMD",13,0)
 ; EDIT     XMLATER-EDIT
"RTN","XMJMD",14,0)
 ; REPORT   XMLATER-REPORT
"RTN","XMJMD",15,0)
REPORT ; Report on later'd messages
"RTN","XMJMD",16,0)
 N ZTSAVE,ZTDESC,ZTRTN,I
"RTN","XMJMD",17,0)
 D CHECK^XMVVITAE
"RTN","XMJMD",18,0)
 S ZTDESC=$$EZBLD^DIALOG(34639) ; MailMan: Report on Later'd Messages
"RTN","XMJMD",19,0)
 S ZTRTN="RPTLATER^XMJMD"
"RTN","XMJMD",20,0)
 F I="XMDUZ","XMV(""NAME"")" S ZTSAVE(I)=""
"RTN","XMJMD",21,0)
 D EN^XUTMDEVQ(ZTRTN,ZTDESC,.ZTSAVE)
"RTN","XMJMD",22,0)
 Q
"RTN","XMJMD",23,0)
RPTLATER ;
"RTN","XMJMD",24,0)
 ; XMDUZ,XMV("NAME") are provided
"RTN","XMJMD",25,0)
 N XMZ,XMABORT,XMWHEN,XMIEN,XMREC,XMZREC,XMPAGE,XMLEN,XMK,XMKN
"RTN","XMJMD",26,0)
 S XMLEN("DATE")=$L($$FMTE^XLFDT($E($$NOW^XLFDT,1,12),"5Z"))
"RTN","XMJMD",27,0)
 S XMLEN("XMZ")=$L($O(^XMB(3.9,":"),-1))
"RTN","XMJMD",28,0)
 S:XMLEN("XMZ")<7 XMLEN("XMZ")=7
"RTN","XMJMD",29,0)
 S XMLEN("BSKT")=10
"RTN","XMJMD",30,0)
 S XMLEN("SUBJ")=79-XMLEN("DATE")-XMLEN("XMZ")-XMLEN("BSKT")-6
"RTN","XMJMD",31,0)
 S (XMPAGE,XMABORT)=0
"RTN","XMJMD",32,0)
 W:IOST["C-" @IOF
"RTN","XMJMD",33,0)
 D RPTHDR(.XMLEN,.XMPAGE)
"RTN","XMJMD",34,0)
 S XMIEN=""
"RTN","XMJMD",35,0)
 F  S XMIEN=$O(^XMB(3.73,"C",XMDUZ,XMIEN)) Q:XMIEN=""  D  Q:XMABORT
"RTN","XMJMD",36,0)
 . S XMREC=$G(^XMB(3.73,XMIEN,0)) I XMREC="" K ^XMB(3.73,"C",XMDUZ,XMIEN) Q
"RTN","XMJMD",37,0)
 . S XMZ=+$P(XMREC,U,3)
"RTN","XMJMD",38,0)
 . S XMZREC=$G(^XMB(3.9,XMZ,0)) I XMZREC="" D DELDATE(XMIEN) Q
"RTN","XMJMD",39,0)
 . S XMWHEN=$P(XMREC,U,1)
"RTN","XMJMD",40,0)
 . S XMK=$O(^XMB(3.7,"M",XMZ,XMDUZ,""))
"RTN","XMJMD",41,0)
 . S XMKN=$S('XMK:$$EZBLD^DIALOG(34014),1:$P($G(^XMB(3.7,XMDUZ,2,XMK,0)),U)) ; * N/A *
"RTN","XMJMD",42,0)
 . I $Y+3>IOSL D  Q:XMABORT
"RTN","XMJMD",43,0)
 . . I IOST["C-" D PAGE^XMXUTIL(.XMABORT) Q:XMABORT
"RTN","XMJMD",44,0)
 . . W @IOF D RPTHDR(.XMLEN,.XMPAGE)
"RTN","XMJMD",45,0)
 . W !,$$LJ^XLFSTR($$FMTE^XLFDT($E(XMWHEN,1,12),"5Z"),XMLEN("DATE")),"  ",$$LJ^XLFSTR($E(XMKN,1,XMLEN("BSKT")),XMLEN("BSKT")),"  ",$J(XMZ,XMLEN("XMZ")),"  ",$E($$SUBJ^XMXUTIL2(XMZREC),1,XMLEN("SUBJ"))
"RTN","XMJMD",46,0)
 W:$O(^XMB(3.73,"C",XMDUZ,""))="" !,$$EZBLD^DIALOG(34630) ; No Later'd Messages
"RTN","XMJMD",47,0)
 I IOST["C-",'XMABORT D WAIT^XMXUTIL
"RTN","XMJMD",48,0)
 I $D(ZTQUEUED) S ZTREQ="@"
"RTN","XMJMD",49,0)
 Q
"RTN","XMJMD",50,0)
RPTHDR(XMLEN,XMPAGE) ;
"RTN","XMJMD",51,0)
 S XMPAGE=XMPAGE+1
"RTN","XMJMD",52,0)
 W $$EZBLD^DIALOG(34631,XMV("NAME")),?70,$$EZBLD^DIALOG(34542,XMPAGE) ; Later'd Messages Report for: / Page
"RTN","XMJMD",53,0)
 W !,$$LJ^XLFSTR($$EZBLD^DIALOG(34632),XMLEN("DATE")),"  ",$$LJ^XLFSTR($$EZBLD^DIALOG(34011),XMLEN("BSKT")),"  ",$$RJ^XLFSTR($$EZBLD^DIALOG(34633),XMLEN("XMZ")),"  ",$$EZBLD^DIALOG(34002) ; Date / Basket / Msg ID / Subject
"RTN","XMJMD",54,0)
 W !,$$REPEAT^XLFSTR("-",79)
"RTN","XMJMD",55,0)
 Q
"RTN","XMJMD",56,0)
DELUSER(XMDUZ) ; Delete all Later'd messages for a particular user
"RTN","XMJMD",57,0)
 N XMIEN
"RTN","XMJMD",58,0)
 S XMIEN=""
"RTN","XMJMD",59,0)
 F  S XMIEN=$O(^XMB(3.73,"C",XMDUZ,XMIEN)) Q:XMIEN=""  D DELDATE(XMIEN)
"RTN","XMJMD",60,0)
 Q
"RTN","XMJMD",61,0)
DELDATE(XMIEN) ; Delete a particular Later'd message date
"RTN","XMJMD",62,0)
 N DIK
"RTN","XMJMD",63,0)
 S DIK="^XMB(3.73,",DA=XMIEN
"RTN","XMJMD",64,0)
 D ^DIK
"RTN","XMJMD",65,0)
 Q
"RTN","XMJMD",66,0)
DELMSG(XMZ) ; Delete all Later'd dates for a particular message
"RTN","XMJMD",67,0)
 N XMDUZ,XMIEN
"RTN","XMJMD",68,0)
 S (XMDUZ,XMIEN)=""
"RTN","XMJMD",69,0)
 F  S XMDUZ=$O(^XMB(3.73,"AC",XMZ,XMDUZ)) Q:XMDUZ=""  D
"RTN","XMJMD",70,0)
 . F  S XMIEN=$O(^XMB(3.73,"AC",XMZ,XMDUZ,XMIEN)) Q:XMIEN=""  D DELDATE(XMIEN)
"RTN","XMJMD",71,0)
 Q
"RTN","XMJMD",72,0)
LATER(XMDUZ,XMZ) ; For a particular message,
"RTN","XMJMD",73,0)
 ; let user edit any existing latered times or add a new one.
"RTN","XMJMD",74,0)
 N XMABORT,XMWHEN
"RTN","XMJMD",75,0)
 S XMABORT=0
"RTN","XMJMD",76,0)
 I $D(^XMB(3.73,"AC",XMZ,XMDUZ)) D
"RTN","XMJMD",77,0)
 . W @IOF
"RTN","XMJMD",78,0)
 . D LATER^XMJMQ1(XMDUZ,XMZ,"","","","",.XMABORT)
"RTN","XMJMD",79,0)
 . S XMABORT=0
"RTN","XMJMD",80,0)
 . N DIR,XMIEN,XMADD,XMCHG,XMDEL
"RTN","XMJMD",81,0)
 . S XMIEN=$O(^XMB(3.73,"AC",XMZ,XMDUZ,0))
"RTN","XMJMD",82,0)
 . I $O(^XMB(3.73,"AC",XMZ,XMDUZ,XMIEN)) S XMIEN=0
"RTN","XMJMD",83,0)
 . S XMADD=$$EZBLD^DIALOG(34634) ; A:Add another date on which this message should appear new
"RTN","XMJMD",84,0)
 . S XMCHG=$$EZBLD^DIALOG($S(XMIEN:34635,1:34635.1)) ; C:Change this / a date
"RTN","XMJMD",85,0)
 . S XMDEL=$$EZBLD^DIALOG($S(XMIEN:34636,1:34636.1)) ; D:Delete this / a date
"RTN","XMJMD",86,0)
 . S DIR(0)="SO^"_XMADD_";"_XMCHG_";"_XMDEL
"RTN","XMJMD",87,0)
 . D ^DIR I $D(DIRUT) S XMABORT=1 Q
"RTN","XMJMD",88,0)
 . I Y=$P(XMADD,":",1) D  Q
"RTN","XMJMD",89,0)
 . . D LTRDATE(.XMWHEN,.XMABORT) Q:XMABORT
"RTN","XMJMD",90,0)
 . . D LTRADD(XMDUZ,XMZ,XMWHEN)
"RTN","XMJMD",91,0)
 . I 'XMIEN D WHICH(XMDUZ,XMZ,.XMIEN,.XMABORT) Q:XMABORT
"RTN","XMJMD",92,0)
 . I Y=$P(XMCHG,":",1) D CHGDATE(XMIEN) Q
"RTN","XMJMD",93,0)
 . D DELDATE(XMIEN) ; Delete this date
"RTN","XMJMD",94,0)
 . W $$EZBLD^DIALOG(34637) ; " ... deleted."
"RTN","XMJMD",95,0)
 E  D
"RTN","XMJMD",96,0)
 . D LTRDATE(.XMWHEN,.XMABORT) Q:XMABORT
"RTN","XMJMD",97,0)
 . D LTRADD(XMDUZ,XMZ,XMWHEN)
"RTN","XMJMD",98,0)
 Q
"RTN","XMJMD",99,0)
EDIT ; Change/delete later'd messages
"RTN","XMJMD",100,0)
 I '$D(^XMB(3.73,"C",XMDUZ)) W !!,$C(7),$$EZBLD^DIALOG(34638) Q  ; You have no Later'd messages.
"RTN","XMJMD",101,0)
 D LTREDIT($G(XMDUZ,DUZ))
"RTN","XMJMD",102,0)
 Q
"RTN","XMJMD",103,0)
LTREDIT(XMDUZ,XMZ) ;
"RTN","XMJMD",104,0)
 N X,Y,XMIEN,XMDEL,DIR,DIE,DR,DA,DIRUT,XMABORT
"RTN","XMJMD",105,0)
 S XMABORT=0
"RTN","XMJMD",106,0)
 D WHICH(XMDUZ,.XMZ,.XMIEN,.XMABORT) Q:XMABORT
"RTN","XMJMD",107,0)
 ; The user has chosen a record to edit (and change the later'd date)
"RTN","XMJMD",108,0)
 S XMDEL=$$EZBLD^DIALOG(34636) ; D:Delete this date
"RTN","XMJMD",109,0)
 S DIR(0)="S^"_$$EZBLD^DIALOG(34635)_";"_XMDEL ; C:Change this date
"RTN","XMJMD",110,0)
 D ^DIR Q:$D(DIRUT)
"RTN","XMJMD",111,0)
 I Y=$P(XMDEL,":",1) D  Q
"RTN","XMJMD",112,0)
 . D DELDATE(XMIEN) ; Delete this date
"RTN","XMJMD",113,0)
 . W $$EZBLD^DIALOG(34637) ; " ... deleted."
"RTN","XMJMD",114,0)
 K DIR,X,Y,DIRUT
"RTN","XMJMD",115,0)
 D CHGDATE(XMIEN) ; Change this date
"RTN","XMJMD",116,0)
 Q
"RTN","XMJMD",117,0)
WHICH(XMDUZ,XMZ,XMIEN,XMABORT) ;
"RTN","XMJMD",118,0)
 N DIC,D,X,Y
"RTN","XMJMD",119,0)
 W !
"RTN","XMJMD",120,0)
 S DIC="^XMB(3.73,"
"RTN","XMJMD",121,0)
 S DIC(0)="NEU"
"RTN","XMJMD",122,0)
 S D="C"
"RTN","XMJMD",123,0)
 I $D(XMZ) S DIC("S")="I $D(^XMB(3.73,""AC"","_XMZ_","_$G(XMDUZ,DUZ)_",Y))"
"RTN","XMJMD",124,0)
 E  S DIC("S")="I $D(^XMB(3.73,""C"","_$G(XMDUZ,DUZ)_",Y))"
"RTN","XMJMD",125,0)
 S X=$G(XMDUZ,DUZ)
"RTN","XMJMD",126,0)
 D IX^DIC I Y=-1 S XMABORT=1 Q
"RTN","XMJMD",127,0)
 S XMIEN=+Y
"RTN","XMJMD",128,0)
 Q
"RTN","XMJMD",129,0)
CHGDATE(DA) ; Change a date
"RTN","XMJMD",130,0)
 N DIE,DR,DIDEL
"RTN","XMJMD",131,0)
 S DIDEL=3.73
"RTN","XMJMD",132,0)
 S DIE=3.73
"RTN","XMJMD",133,0)
 S DR=.01
"RTN","XMJMD",134,0)
 D ^DIE
"RTN","XMJMD",135,0)
 Q
"RTN","XMJMD",136,0)
LTRDATE(Y,XMABORT) ;
"RTN","XMJMD",137,0)
 N DIR
"RTN","XMJMD",138,0)
 S DIR(0)="3.73,.01"
"RTN","XMJMD",139,0)
 S DIR("B")="T+1"
"RTN","XMJMD",140,0)
 D ^DIR I $D(DIRUT) S XMABORT=1 Q
"RTN","XMJMD",141,0)
 Q
"RTN","XMJMD",142,0)
LTRADD(XMDUZ,XMZ,XMWHEN) ;
"RTN","XMJMD",143,0)
 N XMFDA
"RTN","XMJMD",144,0)
 Q:$D(^XMB(3.73,"AB",XMWHEN,XMDUZ,XMZ))  ; Already scheduled?
"RTN","XMJMD",145,0)
 S XMFDA(3.73,"+1,",.01)=XMWHEN
"RTN","XMJMD",146,0)
 ;S XMFDA(3.73,"+1,",1)=XMDUZ  Not needed, because done by trigger
"RTN","XMJMD",147,0)
 S XMFDA(3.73,"+1,",2)=XMZ
"RTN","XMJMD",148,0)
 D UPDATE^DIE("","XMFDA")
"RTN","XMJMD",149,0)
 Q
"RTN","XMJMF")
0^287^B8951979
"RTN","XMJMF",1,0)
XMJMF ;ISC-SF/GMB-Find messages based on criteria ;07/10/2002  09:58
"RTN","XMJMF",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMJMF",3,0)
 ; Replaces ^XMA03,^XMAL0,^XMAL0A (ISC-WASH/CAP/THM)
"RTN","XMJMF",4,0)
 ; Entry points used by MailMan options (not covered by DBIA):
"RTN","XMJMF",5,0)
 ; FIND     XMSEARCH
"RTN","XMJMF",6,0)
 ; SUPER    XM SUPER SEARCH
"RTN","XMJMF",7,0)
FINDBSKT(XMDUZ,XMK,XMKN) ; Find messages in a particular basket
"RTN","XMJMF",8,0)
 D FIND^XMJMF1(XMDUZ,XMK,0,XMKN)
"RTN","XMJMF",9,0)
 Q
"RTN","XMJMF",10,0)
FIND ; Find messages in any basket or find any message
"RTN","XMJMF",11,0)
 N XMDIR,XMOX,XMOPT,XMY,XMABORT
"RTN","XMJMF",12,0)
 D CHECK^XMVVITAE
"RTN","XMJMF",13,0)
 S XMABORT=0
"RTN","XMJMF",14,0)
 S XMDIR("A")=$$EZBLD^DIALOG(34410) ; Select message search method:
"RTN","XMJMF",15,0)
 D SET^XMXSEC1("S",34411,.XMOPT,.XMOX) ; S:Search all messages by subject only
"RTN","XMJMF",16,0)
 D SET^XMXSEC1("A",34413,.XMOPT,.XMOX) ; A:Search all messages by multiple criteria
"RTN","XMJMF",17,0)
 D SET^XMXSEC1("M",34412,.XMOPT,.XMOX) ; M:Search my Mailbox by multiple criteria
"RTN","XMJMF",18,0)
 S XMDIR(0)="S" ; show the choices
"RTN","XMJMF",19,0)
 S XMDIR("?")=34414
"RTN","XMJMF",20,0)
 S XMDIR("??")="XM-U-Q-SEARCH"
"RTN","XMJMF",21,0)
 D XMDIR^XMJDIR(.XMDIR,.XMOPT,.XMOX,.XMY,.XMABORT) Q:XMABORT
"RTN","XMJMF",22,0)
 K XMOX,XMOPT,XMDIR
"RTN","XMJMF",23,0)
 D @XMY
"RTN","XMJMF",24,0)
 Q
"RTN","XMJMF",25,0)
S ; Search all existing messages by subject
"RTN","XMJMF",26,0)
 N DIR,Y,DIRUT
"RTN","XMJMF",27,0)
 S DIR(0)="FO^3:30"
"RTN","XMJMF",28,0)
 S DIR("A")=$$EZBLD^DIALOG(34415) ; Enter the string that the subject starts with
"RTN","XMJMF",29,0)
 D BLD^DIALOG(34416,"","","DIR(""?"")")
"RTN","XMJMF",30,0)
 ;The string may be from 3 to 30 characters.
"RTN","XMJMF",31,0)
 ;We will find all messages whose subject starts with the string you enter.
"RTN","XMJMF",32,0)
 ;We will search all existing messages which you have ever had access to,
"RTN","XMJMF",33,0)
 ;whether they are in your mailbox or not.
"RTN","XMJMF",34,0)
 ;The search is case-sensitive.
"RTN","XMJMF",35,0)
 S DIR("??")="XM-U-Q-SEARCH SYSTEM"
"RTN","XMJMF",36,0)
 D ^DIR Q:$D(DIRUT)
"RTN","XMJMF",37,0)
 W !,$$EZBLD^DIALOG(34417) ; Searching...
"RTN","XMJMF",38,0)
 D FIND^XMJMFA(XMDUZ,Y)
"RTN","XMJMF",39,0)
 Q
"RTN","XMJMF",40,0)
A ; Search all existing messages by multiple criteria
"RTN","XMJMF",41,0)
 D ALL(XMDUZ)
"RTN","XMJMF",42,0)
 Q
"RTN","XMJMF",43,0)
ALL(XMDUZ,XMFLAG) ;
"RTN","XMJMF",44,0)
 N XMTEXT
"RTN","XMJMF",45,0)
 W !
"RTN","XMJMF",46,0)
 ;                      * * * * * WARNING * * * * *
"RTN","XMJMF",47,0)
 I $G(XMFLAG)="U" D
"RTN","XMJMF",48,0)
 . D BLD^DIALOG(34418.5,"","","XMTEXT","F")
"RTN","XMJMF",49,0)
 . ;This is the Super Search which looks at all messages
"RTN","XMJMF",50,0)
 . ;in the MESSAGE file which were sent by anyone and everyone during the
"RTN","XMJMF",51,0)
 . ;entire time period you select, regardless of whether or not you are
"RTN","XMJMF",52,0)
 . ;party to the messages.  This is a very powerful search and should not
"RTN","XMJMF",53,0)
 . ;be abused.  You should have good reason and authorization to be here.
"RTN","XMJMF",54,0)
 E  D
"RTN","XMJMF",55,0)
 . D BLD^DIALOG(34418,"","","XMTEXT","F")
"RTN","XMJMF",56,0)
 . ;This search looks at all messages in the MESSAGE file which were sent
"RTN","XMJMF",57,0)
 . ;to you or by you during the entire time period you select.
"RTN","XMJMF",58,0)
 D BLD^DIALOG(34419,"","","XMTEXT","F")
"RTN","XMJMF",59,0)
 ;This search can take a very long time, depending on how many messages
"RTN","XMJMF",60,0)
 ;were sent at this site during the time period you select, and how many
"RTN","XMJMF",61,0)
 ;search criteria you specify.  The more messages to search, the more
"RTN","XMJMF",62,0)
 ;search criteria you specify, the longer the search will take.
"RTN","XMJMF",63,0)
 ;             This search can be VERY SLOW.  Be forewarned!
"RTN","XMJMF",64,0)
 D MSG^DIALOG("WM","",IOM,"","XMTEXT")
"RTN","XMJMF",65,0)
 W !
"RTN","XMJMF",66,0)
 D WAIT^XMXUTIL
"RTN","XMJMF",67,0)
 D FIND^XMJMF1(XMDUZ,"!",$G(XMFLAG))
"RTN","XMJMF",68,0)
 Q
"RTN","XMJMF",69,0)
M ; Search my mailbox by multiple criteria
"RTN","XMJMF",70,0)
 D FIND^XMJMF1(XMDUZ,"*",1)
"RTN","XMJMF",71,0)
 Q
"RTN","XMJMF",72,0)
SUPER ; Super Search all messages in the Message file
"RTN","XMJMF",73,0)
 N XMDUZ,XMV
"RTN","XMJMF",74,0)
 D INITAPI^XMVVITAE
"RTN","XMJMF",75,0)
 I $D(XMV("ERROR")) D ERROR^XM(.XMV,"ERROR") Q
"RTN","XMJMF",76,0)
 D ALL(DUZ,"U")
"RTN","XMJMF",77,0)
 Q
"RTN","XMJMF1")
0^288^B26707831
"RTN","XMJMF1",1,0)
XMJMF1 ;ISC-SF/GMB-XMJMF (cont.) ;07/12/2002  11:08
"RTN","XMJMF1",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMJMF1",3,0)
FIND(XMDUZ,XMK,XMKCHOOS,XMKN) ; Search mailbox or message file
"RTN","XMJMF1",4,0)
 ; XMK       !=Search the message file
"RTN","XMJMF1",5,0)
 ;           *=Search the user's mailbox
"RTN","XMJMF1",6,0)
 ;           n=Search user's basket number n
"RTN","XMJMF1",7,0)
 ; XMKCHOOS  1=user may choose which basket
"RTN","XMJMF1",8,0)
 ;           0=user is locked into current basket
"RTN","XMJMF1",9,0)
 ;           U=user is doing a Postmaster Super Search
"RTN","XMJMF1",10,0)
 N XMDIR,XMOPT,XMOX,XMY,XMF,XMABORT,XMFFRN,XMFBSKTN,XMFTDTX,XMFFDTX,XMFRFRN,XMSRCHED,XMHDR
"RTN","XMJMF1",11,0)
 S (XMABORT,XMSRCHED)=0
"RTN","XMJMF1",12,0)
 I XMK="!" D  Q:XMABORT
"RTN","XMJMF1",13,0)
 . I $G(XMKCHOOS)="U" D  Q:XMABORT
"RTN","XMJMF1",14,0)
 . . I '$$SSPRIV^XMXSEC1 D  Q
"RTN","XMJMF1",15,0)
 . . . D SHOW^XMJERR
"RTN","XMJMF1",16,0)
 . . . D WAIT^XMXUTIL
"RTN","XMJMF1",17,0)
 . . . S XMABORT=1
"RTN","XMJMF1",18,0)
 . . S XMF("FLAGS")="U"
"RTN","XMJMF1",19,0)
 . . S XMHDR=$$EZBLD^DIALOG(34435.5) ; Current 'All Messages Super Search' search criteria:
"RTN","XMJMF1",20,0)
 . E  S XMHDR=$$EZBLD^DIALOG(34435) ; Current 'All Messages' search criteria:
"RTN","XMJMF1",21,0)
 . S XMF("FDATE")=$$FMADD^XLFDT(DT,-30) ; Search period is last 30 days.
"RTN","XMJMF1",22,0)
 . S XMF("TDATE")=DT
"RTN","XMJMF1",23,0)
 . S XMFFDTX=$$MMDT^XMXUTIL1(XMF("FDATE"))
"RTN","XMJMF1",24,0)
 . S XMFTDTX=$$MMDT^XMXUTIL1(XMF("TDATE"))
"RTN","XMJMF1",25,0)
 E  D
"RTN","XMJMF1",26,0)
 . S XMHDR=$$EZBLD^DIALOG(34436) ; Current 'Mailbox' search criteria:
"RTN","XMJMF1",27,0)
 . S XMF("BSKT")=XMK
"RTN","XMJMF1",28,0)
 . I XMK S XMFBSKTN=$G(XMKN,$$BSKTNAME^XMXUTIL(XMDUZ,XMK))
"RTN","XMJMF1",29,0)
 F  D  Q:XMABORT
"RTN","XMJMF1",30,0)
 . W @IOF,XMHDR
"RTN","XMJMF1",31,0)
 . S XMDIR("A")=$$EZBLD^DIALOG(34420) ; Select search action
"RTN","XMJMF1",32,0)
 . I XMK'="!" D
"RTN","XMJMF1",33,0)
 . . I +XMF("BSKT")=XMF("BSKT") D
"RTN","XMJMF1",34,0)
 . . . W !,$$EZBLD^DIALOG(34437),":",?30,XMFBSKTN ; Search basket
"RTN","XMJMF1",35,0)
 . . . Q:'XMKCHOOS
"RTN","XMJMF1",36,0)
 . . . D SET^XMXSEC1("B",34421.1,.XMOPT,.XMOX) ; Change Search basket
"RTN","XMJMF1",37,0)
 . . . D SET^XMXSEC1("BA",34421.2,.XMOPT,.XMOX) ; Search all baskets
"RTN","XMJMF1",38,0)
 . . E  D
"RTN","XMJMF1",39,0)
 . . . W !,$$EZBLD^DIALOG(34437),":",?30,$$EZBLD^DIALOG(34437.1) ; Search basket / All baskets
"RTN","XMJMF1",40,0)
 . . . D SET^XMXSEC1("B",34421,.XMOPT,.XMOX) ; Search one basket
"RTN","XMJMF1",41,0)
 . I $D(XMF("SUBJ")) D
"RTN","XMJMF1",42,0)
 . . W !,$$EZBLD^DIALOG(34438),":",?30,XMF("SUBJ") ; Subject contains
"RTN","XMJMF1",43,0)
 . . D SET^XMXSEC1("S",34422.1,.XMOPT,.XMOX) ; Change 'Subject contains' string
"RTN","XMJMF1",44,0)
 . E  D SET^XMXSEC1("S",34422,.XMOPT,.XMOX) ; Enter 'Subject contains' string
"RTN","XMJMF1",45,0)
 . I $D(XMF("FROM")) D
"RTN","XMJMF1",46,0)
 . . W !,$$EZBLD^DIALOG(34440),":",?30,XMFFRN ; Message from
"RTN","XMJMF1",47,0)
 . . D SET^XMXSEC1("F",34423.1,.XMOPT,.XMOX) ; Change 'Message from' person
"RTN","XMJMF1",48,0)
 . E  D SET^XMXSEC1("F",34423,.XMOPT,.XMOX) ; Enter 'Message from' person
"RTN","XMJMF1",49,0)
 . I $D(XMF("TO")) D
"RTN","XMJMF1",50,0)
 . . W !,$$EZBLD^DIALOG(34440.2),":",?30,XMF("TO") ; Message to
"RTN","XMJMF1",51,0)
 . . D SET^XMXSEC1("T",34424.1,.XMOPT,.XMOX) ; Change 'Message to' addressee
"RTN","XMJMF1",52,0)
 . E  D SET^XMXSEC1("T",34424,.XMOPT,.XMOX) ; Enter 'Message to' addressee
"RTN","XMJMF1",53,0)
 . I $D(XMF("FDATE")) D
"RTN","XMJMF1",54,0)
 . . W !,$$EZBLD^DIALOG(34444),":",?30,XMFFDTX ; Message sent on or after
"RTN","XMJMF1",55,0)
 . . D SET^XMXSEC1("DA",34426.1,.XMOPT,.XMOX) ; Change 'Message sent on or after' date
"RTN","XMJMF1",56,0)
 . E  D SET^XMXSEC1("DA",34426,.XMOPT,.XMOX) ; Enter 'Message sent on or after' date
"RTN","XMJMF1",57,0)
 . I $D(XMF("TDATE")) D
"RTN","XMJMF1",58,0)
 . . W !,$$EZBLD^DIALOG(34445),":",?30,XMFTDTX ; Message sent on or before
"RTN","XMJMF1",59,0)
 . . D SET^XMXSEC1("DB",34427.1,.XMOPT,.XMOX) ; Change 'Message sent on or before' date
"RTN","XMJMF1",60,0)
 . E  D SET^XMXSEC1("DB",34427,.XMOPT,.XMOX) ; Enter 'Message sent on or before' date
"RTN","XMJMF1",61,0)
 . I $D(XMF("FLINE")) D
"RTN","XMJMF1",62,0)
 . . W !,$$EZBLD^DIALOG(34449),":",?30,XMF("FLINE") ; Lines of text, minimum
"RTN","XMJMF1",63,0)
 . . D SET^XMXSEC1("LM",34430.1,.XMOPT,.XMOX) ; Change 'Minimum Lines of text' number
"RTN","XMJMF1",64,0)
 . E  D SET^XMXSEC1("LM",34430,.XMOPT,.XMOX) ; Enter 'Minimum Lines of text' number
"RTN","XMJMF1",65,0)
 . ;I $D(XMF("TLINE")) D
"RTN","XMJMF1",66,0)
 . ;. W !,$$EZBLD^DIALOG(34450),":",?30,XMF("TLINE") ; Lines of text, maximum
"RTN","XMJMF1",67,0)
 . ;. D SET^XMXSEC1("LX",34431.1,.XMOPT,.XMOX) ; Change 'Maximum Lines of text' number
"RTN","XMJMF1",68,0)
 . ;E  D SET^XMXSEC1("LX",34431,.XMOPT,.XMOX) ; Enter 'Maximum Lines of text' number
"RTN","XMJMF1",69,0)
 . I $D(XMF("RFROM")) D
"RTN","XMJMF1",70,0)
 . . W !,$$EZBLD^DIALOG(34440.1),":",?30,XMFRFRN ; Response from
"RTN","XMJMF1",71,0)
 . . D SET^XMXSEC1("R",34428.1,.XMOPT,.XMOX) ; Change 'Response from' person
"RTN","XMJMF1",72,0)
 . E  D SET^XMXSEC1("R",34428,.XMOPT,.XMOX) ; Enter 'Response from' person
"RTN","XMJMF1",73,0)
 . I $D(XMF("TEXT")) D
"RTN","XMJMF1",74,0)
 . . ; x.1:Message / x.2:Message or Response / x.3:Response contains
"RTN","XMJMF1",75,0)
 . . W !,$$EZBLD^DIALOG(34446+(XMF("TEXT","L")/10)),":",?30,XMF("TEXT")
"RTN","XMJMF1",76,0)
 . . D SET^XMXSEC1("X",34429.1,.XMOPT,.XMOX) ; Change 'Message contains' string
"RTN","XMJMF1",77,0)
 . E  D SET^XMXSEC1("X",34429,.XMOPT,.XMOX) ; Enter 'Message contains' string
"RTN","XMJMF1",78,0)
 . D SET^XMXSEC1("Q",34420.1,.XMOPT,.XMOX) ; Quit
"RTN","XMJMF1",79,0)
 . I $D(XMF("SUBJ"))!$D(XMF("FROM"))!$D(XMF("FDATE"))!$D(XMF("TDATE"))!$D(XMF("TO"))!$D(XMF("RFROM"))!$D(XMF("TEXT"))!$D(XMF("FLINE"))!$D(XMF("TLINE")) D
"RTN","XMJMF1",80,0)
 . . D SET^XMXSEC1("G",34420.2,.XMOPT,.XMOX) ; Go search
"RTN","XMJMF1",81,0)
 . . S XMDIR("B")=$S(XMSRCHED:34420.1,1:34420.2) ; Q:Quit / G:Go search
"RTN","XMJMF1",82,0)
 . E  D
"RTN","XMJMF1",83,0)
 . . S XMDIR("B")=34422 ; S:Enter 'Subject contains' string
"RTN","XMJMF1",84,0)
 . S XMDIR("??")="XM-U-Q-SEARCH CRITERIA"
"RTN","XMJMF1",85,0)
 . S XMDIR(0)="SC" ; show choices/split into columns, if necessary
"RTN","XMJMF1",86,0)
 . D XMDIR^XMJDIR(.XMDIR,.XMOPT,.XMOX,.XMY,.XMABORT) Q:XMABORT
"RTN","XMJMF1",87,0)
 . S XMSRCHED=(XMY="G")
"RTN","XMJMF1",88,0)
 . K XMOPT,XMOX,XMDIR
"RTN","XMJMF1",89,0)
 . D @XMY^XMJMF2
"RTN","XMJMF1",90,0)
 Q
"RTN","XMJMF2")
0^34^B36466615
"RTN","XMJMF2",1,0)
XMJMF2 ;ISC-SF/GMB-XMJMF (cont.) ;07/12/2002  10:11
"RTN","XMJMF2",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMJMF2",3,0)
B ; Search one basket
"RTN","XMJMF2",4,0)
 N XMDIC,XMFBSKT
"RTN","XMJMF2",5,0)
 S XMDIC("B")=$G(XMFBSKTN,$$EZBLD^DIALOG(37005)) ; IN
"RTN","XMJMF2",6,0)
 D SELBSKT^XMJBU(XMDUZ,34439,"",.XMDIC,.XMFBSKT,.XMFBSKTN) I XMFBSKT=U S XMABORT=1 Q  ; Select basket to search:
"RTN","XMJMF2",7,0)
 S XMF("BSKT")=XMFBSKT
"RTN","XMJMF2",8,0)
 Q
"RTN","XMJMF2",9,0)
BA ; Search all baskets
"RTN","XMJMF2",10,0)
 S XMF("BSKT")="*"
"RTN","XMJMF2",11,0)
 Q
"RTN","XMJMF2",12,0)
DA ; Message sent on or after date
"RTN","XMJMF2",13,0)
 N DIR,Y,X
"RTN","XMJMF2",14,0)
 S DIR(0)="DO^:"_$G(XMF("TDATE"),DT)_":EX"
"RTN","XMJMF2",15,0)
 S DIR("A")=$$EZBLD^DIALOG(34444) ; Message sent on or after
"RTN","XMJMF2",16,0)
 D BLD^DIALOG(34444.1,"","","DIR(""?"")")
"RTN","XMJMF2",17,0)
 ; Enter a date.  It must include day, month, and year.
"RTN","XMJMF2",18,0)
 S:$D(XMF("FDATE")) DIR("B")=XMFFDTX
"RTN","XMJMF2",19,0)
 D ^DIR I $D(DUOUT)!$D(DTOUT) S XMABORT=1 Q
"RTN","XMJMF2",20,0)
 I X="@" D  Q
"RTN","XMJMF2",21,0)
 . I XMK="!" D NODELETE Q
"RTN","XMJMF2",22,0)
 . K XMF("FDATE")
"RTN","XMJMF2",23,0)
 Q:Y=""
"RTN","XMJMF2",24,0)
 S XMF("FDATE")=Y
"RTN","XMJMF2",25,0)
 S XMFFDTX=$$MMDT^XMXUTIL1(XMF("FDATE"))
"RTN","XMJMF2",26,0)
 Q
"RTN","XMJMF2",27,0)
NODELETE ;This search requires a date range.
"RTN","XMJMF2",28,0)
 ;You may change the dates, but you may not delete them.
"RTN","XMJMF2",29,0)
 N XMTEXT
"RTN","XMJMF2",30,0)
 D BLD^DIALOG(34444.5,"","","XMTEXT","F")
"RTN","XMJMF2",31,0)
 D MSG^DIALOG("WE","","","","XMTEXT")
"RTN","XMJMF2",32,0)
 D WAIT^XMXUTIL
"RTN","XMJMF2",33,0)
 Q
"RTN","XMJMF2",34,0)
DB ; Message sent on or before date
"RTN","XMJMF2",35,0)
 N DIR,Y,X
"RTN","XMJMF2",36,0)
 S DIR(0)="DO^"_$G(XMF("FDATE"))_":DT:EX"
"RTN","XMJMF2",37,0)
 S DIR("A")=$$EZBLD^DIALOG(34445) ; Message sent on or before
"RTN","XMJMF2",38,0)
 D BLD^DIALOG(34444.1,"","","DIR(""?"")")
"RTN","XMJMF2",39,0)
 ; Enter a date.  It must include day, month, and year.
"RTN","XMJMF2",40,0)
 S:$D(XMF("TDATE")) DIR("B")=XMFTDTX
"RTN","XMJMF2",41,0)
 D ^DIR I $D(DUOUT)!$D(DTOUT) S XMABORT=1 Q
"RTN","XMJMF2",42,0)
 I X="@" D  Q
"RTN","XMJMF2",43,0)
 . I XMK="!" D NODELETE Q
"RTN","XMJMF2",44,0)
 . K XMF("TDATE")
"RTN","XMJMF2",45,0)
 Q:Y=""
"RTN","XMJMF2",46,0)
 S XMF("TDATE")=Y
"RTN","XMJMF2",47,0)
 S XMFTDTX=$$MMDT^XMXUTIL1(XMF("TDATE"))
"RTN","XMJMF2",48,0)
 Q
"RTN","XMJMF2",49,0)
F ; Message from
"RTN","XMJMF2",50,0)
 D GETPERS(XMDUZ,.XMF,"FROM",.XMFFRN,34440,34441,.XMABORT)
"RTN","XMJMF2",51,0)
 Q
"RTN","XMJMF2",52,0)
G ; Go search
"RTN","XMJMF2",53,0)
 W !,$$EZBLD^DIALOG(34417) ; Searching...
"RTN","XMJMF2",54,0)
 I XMK="!" D FIND^XMJMFC(XMDUZ,.XMF,1) Q
"RTN","XMJMF2",55,0)
 I $G(XMF("BSKT"))="*" D FINDALL^XMJMFB(XMDUZ,.XMF) Q
"RTN","XMJMF2",56,0)
 D FIND1^XMJMFB(XMDUZ,.XMF,1)
"RTN","XMJMF2",57,0)
 Q
"RTN","XMJMF2",58,0)
LM ; Message has this many lines or more
"RTN","XMJMF2",59,0)
 N DIR,Y,X
"RTN","XMJMF2",60,0)
 S DIR(0)="FO^1:12^K:'$$LMOK^XMJMF2(X) X"
"RTN","XMJMF2",61,0)
 S DIR("A")=$$EZBLD^DIALOG(34449) ; Lines of text, minimum
"RTN","XMJMF2",62,0)
 D BLD^DIALOG(34449.1,"","","DIR(""?"")")
"RTN","XMJMF2",63,0)
 ; Enter a number from 100 to 100,000.
"RTN","XMJMF2",64,0)
 ; We will find all messages with that many lines of text or more.
"RTN","XMJMF2",65,0)
 S:$D(XMF("FLINE")) DIR("B")=XMF("FLINE")
"RTN","XMJMF2",66,0)
 D ^DIR I $D(DUOUT)!$D(DTOUT) S XMABORT=1 Q
"RTN","XMJMF2",67,0)
 I X="@" K XMF("FLINE") Q
"RTN","XMJMF2",68,0)
 I Y S XMF("FLINE")=Y
"RTN","XMJMF2",69,0)
 Q
"RTN","XMJMF2",70,0)
LMOK(X) ;
"RTN","XMJMF2",71,0)
 I X="@" Q 1
"RTN","XMJMF2",72,0)
 I X'?1N.N Q 0
"RTN","XMJMF2",73,0)
 I $G(XMF("TLINE")),X>XMF("TLINE") Q 0
"RTN","XMJMF2",74,0)
 I X<100 Q 0
"RTN","XMJMF2",75,0)
 I X>100000 Q 0
"RTN","XMJMF2",76,0)
 Q 1
"RTN","XMJMF2",77,0)
LX ; Message has this many lines or less
"RTN","XMJMF2",78,0)
 N DIR,Y,X
"RTN","XMJMF2",79,0)
 S DIR(0)="FO^1:12^K:'$$LXOK^XMJMF2(X) X"
"RTN","XMJMF2",80,0)
 S DIR("A")=$$EZBLD^DIALOG(34450) ; Lines of text, maximum
"RTN","XMJMF2",81,0)
 D BLD^DIALOG(34450.1,"","","DIR(""?"")")
"RTN","XMJMF2",82,0)
 ; Enter a number from 100 to 100,000.
"RTN","XMJMF2",83,0)
 ; We will find all messages with that many lines of text or less.
"RTN","XMJMF2",84,0)
 S:$D(XMF("TLINE")) DIR("B")=XMF("TLINE")
"RTN","XMJMF2",85,0)
 D ^DIR I $D(DUOUT)!$D(DTOUT) S XMABORT=1 Q
"RTN","XMJMF2",86,0)
 I X="@" K XMF("TLINE") Q
"RTN","XMJMF2",87,0)
 I Y S XMF("TLINE")=Y
"RTN","XMJMF2",88,0)
 Q
"RTN","XMJMF2",89,0)
LXOK(X) ;
"RTN","XMJMF2",90,0)
 I X="@" Q 1
"RTN","XMJMF2",91,0)
 I X'?1N.N Q 0
"RTN","XMJMF2",92,0)
 I $G(XMF("FLINE")),X<XMF("FLINE") Q 0
"RTN","XMJMF2",93,0)
 I X<100 Q 0
"RTN","XMJMF2",94,0)
 I X>100000 Q 0
"RTN","XMJMF2",95,0)
 Q 1
"RTN","XMJMF2",96,0)
Q ; Quit
"RTN","XMJMF2",97,0)
 S XMABORT=1
"RTN","XMJMF2",98,0)
 Q
"RTN","XMJMF2",99,0)
R ; Response from
"RTN","XMJMF2",100,0)
 D GETPERS(XMDUZ,.XMF,"RFROM",.XMFRFRN,34440.1,34441.1,.XMABORT)
"RTN","XMJMF2",101,0)
 Q
"RTN","XMJMF2",102,0)
S ; Subject contains
"RTN","XMJMF2",103,0)
 N DIR,Y,X
"RTN","XMJMF2",104,0)
 S DIR(0)="FO^3:30"
"RTN","XMJMF2",105,0)
 S DIR("A")=$$EZBLD^DIALOG(34438) ; Subject contains
"RTN","XMJMF2",106,0)
 S:$D(XMF("SUBJ")) DIR("B")=XMF("SUBJ")
"RTN","XMJMF2",107,0)
 D BLD^DIALOG(34438.1,"","","DIR(""?"")")
"RTN","XMJMF2",108,0)
 ;Enter the string that the subject contains.
"RTN","XMJMF2",109,0)
 ;It may be from 3 to 30 characters.
"RTN","XMJMF2",110,0)
 ;The search is NOT case-sensitive.
"RTN","XMJMF2",111,0)
 D ^DIR I $D(DUOUT)!$D(DTOUT) S XMABORT=1 Q
"RTN","XMJMF2",112,0)
 I X="@" K XMF("SUBJ") Q
"RTN","XMJMF2",113,0)
 Q:Y=""
"RTN","XMJMF2",114,0)
 S XMF("SUBJ")=Y
"RTN","XMJMF2",115,0)
 Q
"RTN","XMJMF2",116,0)
T ; Message to
"RTN","XMJMF2",117,0)
 D GETPERS(XMDUZ,.XMF,"TO",$G(XMF("TO")),34440.2,34441.2,.XMABORT)
"RTN","XMJMF2",118,0)
 Q
"RTN","XMJMF2",119,0)
X ; Message contains
"RTN","XMJMF2",120,0)
 N DIR,Y,X
"RTN","XMJMF2",121,0)
 S DIR(0)="FO^3:30"
"RTN","XMJMF2",122,0)
 S DIR("A")=$$EZBLD^DIALOG(34446.1) ; Message contains
"RTN","XMJMF2",123,0)
 S:$D(XMF("TEXT")) DIR("B")=XMF("TEXT")
"RTN","XMJMF2",124,0)
 D BLD^DIALOG(34446.4,"","","DIR(""?"")")
"RTN","XMJMF2",125,0)
 ;Enter the string to search for.  It may be from 3 to 30 characters.
"RTN","XMJMF2",126,0)
 ;Note that if the string you are searching for is not all on one line
"RTN","XMJMF2",127,0)
 ;in the message, the search will not be able to find it.
"RTN","XMJMF2",128,0)
 D ^DIR I $D(DUOUT)!$D(DTOUT) S XMABORT=1 Q
"RTN","XMJMF2",129,0)
 I X="@" K XMF("TEXT") Q
"RTN","XMJMF2",130,0)
 Q:Y=""
"RTN","XMJMF2",131,0)
 S XMF("TEXT")=Y
"RTN","XMJMF2",132,0)
 K DIR,X,Y
"RTN","XMJMF2",133,0)
 S DIR(0)="Y"
"RTN","XMJMF2",134,0)
 S DIR("A")=$$EZBLD^DIALOG(34447) ; Should the search be case-sensitive
"RTN","XMJMF2",135,0)
 S DIR("B")=$$EZBLD^DIALOG($S($G(XMF("TEXT","C"),1):39054,1:39053)) ; Yes/No
"RTN","XMJMF2",136,0)
 D BLD^DIALOG(34447.1,"","","DIR(""?"")")
"RTN","XMJMF2",137,0)
 ;Your answer determines whether case (upper/lower) matters in the search.
"RTN","XMJMF2",138,0)
 ;It also affects the speed of the search.
"RTN","XMJMF2",139,0)
 ;A case-sensitive search (one in which case matters) is faster.
"RTN","XMJMF2",140,0)
 ;A case-insensitive search (one in which case does not matter) may find
"RTN","XMJMF2",141,0)
 ;more matches, but will be slower.
"RTN","XMJMF2",142,0)
 ;Answer YES for a faster search, when case matters.
"RTN","XMJMF2",143,0)
 ;Answer NO for a slower search, when case does not matter.
"RTN","XMJMF2",144,0)
 D ^DIR I $D(DUOUT)!$D(DTOUT) S XMABORT=1 Q
"RTN","XMJMF2",145,0)
 S XMF("TEXT","C")=Y
"RTN","XMJMF2",146,0)
 K DIR,X,Y N I
"RTN","XMJMF2",147,0)
 S DIR("A")=$$EZBLD^DIALOG(34448) ; Where should we search
"RTN","XMJMF2",148,0)
 ; x.1:Message only / x.2:Message and Responses / x.3:Responses only
"RTN","XMJMF2",149,0)
 S DIR(0)=""
"RTN","XMJMF2",150,0)
 F I=1,2,3 S DIR(0)=DIR(0)_";"_I_":"_$$EZBLD^DIALOG(34448+(I/10))
"RTN","XMJMF2",151,0)
 S DIR(0)="S^"_$E(DIR(0),2,999)
"RTN","XMJMF2",152,0)
 ; x.1:Message only / x.2:Message and Responses / x.3:Responses only
"RTN","XMJMF2",153,0)
 S DIR("B")=$$EZBLD^DIALOG(34448+($G(XMF("TEXT","L"),1)/10))
"RTN","XMJMF2",154,0)
 D ^DIR I $D(DUOUT)!$D(DTOUT) S XMABORT=1 Q
"RTN","XMJMF2",155,0)
 S XMF("TEXT","L")=Y
"RTN","XMJMF2",156,0)
 Q
"RTN","XMJMF2",157,0)
GETPERS(XMDUZ,XMF,XMWHICH,XMNAME,XMPROMPT,XMHELP,XMABORT) ;
"RTN","XMJMF2",158,0)
 N DIR,Y,X,XMOK
"RTN","XMJMF2",159,0)
 S DIR(0)="FO^1:30"
"RTN","XMJMF2",160,0)
 S DIR("A")=$$EZBLD^DIALOG(XMPROMPT) ; Message from / Message to / Response from
"RTN","XMJMF2",161,0)
 S DIR("?")="^D HGETPERS^XMJMF2"
"RTN","XMJMF2",162,0)
 I $D(XMF(XMWHICH)) D
"RTN","XMJMF2",163,0)
 . S DIR("B")=XMNAME
"RTN","XMJMF2",164,0)
 . I XMNAME'["@" S DIR(0)="FrO^1:30" ; ('r' means no 'replace...with...' prompt)
"RTN","XMJMF2",165,0)
 . Q:XMWHICH'="TO"
"RTN","XMJMF2",166,0)
 . Q:"^G.^g.^"'[(U_$E(XMNAME,1,2)_U)
"RTN","XMJMF2",167,0)
 . N XMPRIVAT
"RTN","XMJMF2",168,0)
 . S XMPRIVAT=$$EZBLD^DIALOG(39135) ; " [Private Mail Group]"
"RTN","XMJMF2",169,0)
 . I XMNAME[XMPRIVAT S DIR("B")=$P(XMNAME,XMPRIVAT)
"RTN","XMJMF2",170,0)
 F  D  Q:XMABORT!XMOK
"RTN","XMJMF2",171,0)
 . S XMOK=1
"RTN","XMJMF2",172,0)
 . D ^DIR I $D(DUOUT)!$D(DTOUT) S XMABORT=1 Q
"RTN","XMJMF2",173,0)
 . I X="@" K XMF(XMWHICH),XMNAME Q
"RTN","XMJMF2",174,0)
 . I Y="" Q
"RTN","XMJMF2",175,0)
 . I X["@" S (XMNAME,XMF(XMWHICH))=$$UP^XLFSTR(Y) Q
"RTN","XMJMF2",176,0)
 . I XMWHICH="TO" D  Q
"RTN","XMJMF2",177,0)
 . . N XMINSTR
"RTN","XMJMF2",178,0)
 . . K XMNAME
"RTN","XMJMF2",179,0)
 . . S XMINSTR("ADDR FLAGS")="X"  ; don't create ^TMP("XMY" globals
"RTN","XMJMF2",180,0)
 . . D ADDR^XMXADDR(XMDUZ,X,.XMINSTR,"",.XMNAME)
"RTN","XMJMF2",181,0)
 . . I '$D(XMNAME) S XMOK=0 Q
"RTN","XMJMF2",182,0)
 . . S XMF(XMWHICH)=XMNAME
"RTN","XMJMF2",183,0)
 . N DIC,X
"RTN","XMJMF2",184,0)
 . S X=Y
"RTN","XMJMF2",185,0)
 . S DIC="^VA(200,",DIC(0)="MNEQ"
"RTN","XMJMF2",186,0)
 . D ^DIC I $D(DUOUT)!$D(DTOUT) S XMABORT=1 Q
"RTN","XMJMF2",187,0)
 . I Y=-1 S XMOK=0 Q
"RTN","XMJMF2",188,0)
 . S XMF(XMWHICH)=+Y
"RTN","XMJMF2",189,0)
 . S XMNAME=$$NAME^XMXUTIL(+Y)
"RTN","XMJMF2",190,0)
 Q
"RTN","XMJMF2",191,0)
HGETPERS ;
"RTN","XMJMF2",192,0)
 N XMTEXT
"RTN","XMJMF2",193,0)
 D BLD^DIALOG(XMHELP,"","","XMTEXT","F")
"RTN","XMJMF2",194,0)
 ;Enter the name of the person who sent the message/response.
"RTN","XMJMF2",195,0)
 ; - or -
"RTN","XMJMF2",196,0)
 ;Enter the message addressee.  It may be a person, group, device, or server.
"RTN","XMJMF2",197,0)
 I XMWHICH'="TO" D BLD^DIALOG(34441.3,"","","XMTEXT","F")
"RTN","XMJMF2",198,0)
 ;If it's from a local VistA package/fake sender, just put '@' after
"RTN","XMJMF2",199,0)
 ;the sender, like ACCOUNTS RECEIVABLE@
"RTN","XMJMF2",200,0)
 D BLD^DIALOG(34442,"","","XMTEXT","F")
"RTN","XMJMF2",201,0)
 ;For remote users, enter name@, name@domain, or @domain.
"RTN","XMJMF2",202,0)
 ;'Name' must be found somewhere in the user's name.
"RTN","XMJMF2",203,0)
 ;'Domain' must be found somewhere in the user's domain.
"RTN","XMJMF2",204,0)
 ;The more characters you provide, the narrower the search will be.
"RTN","XMJMF2",205,0)
 ;MailMan may capitalize some names to facilitate filtering.
"RTN","XMJMF2",206,0)
 D MSG^DIALOG("WH","",IOM,"","XMTEXT")
"RTN","XMJMF2",207,0)
 Q
"RTN","XMJMFA")
0^289^B15433328
"RTN","XMJMFA",1,0)
XMJMFA ;ISC-SF/GMB-Find message: Subject starts with ;04/18/2002  07:47
"RTN","XMJMFA",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMJMFA",3,0)
 ; Search for message subjects that partial match input.
"RTN","XMJMFA",4,0)
 ; Replaces ^XMA03 (ISC-WASH/CAP/THM)
"RTN","XMJMFA",5,0)
FIND(XMDUZ,XMSTRING,XMWAIT) ;
"RTN","XMJMFA",6,0)
 N XMKZ,XMCNT,XMABORT,XMLEN,XMFIRST,XMPAGE,XMDETAIL,XMPMAX,XMMORE,XMFLAGS,XMSCREEN,XMFROM,XMZOOM,XMCD,XMOPT,XMOX
"RTN","XMJMFA",7,0)
 K ^TMP("XM",$J,"MSG"),^TMP("XM",$J,".")
"RTN","XMJMFA",8,0)
 S (XMKZ,XMZ,XMPAGE,XMCNT,XMZOOM,XMCD,XMABORT)=0,(XMDETAIL,XMMORE)=1,XMPMAX=IOSL-3
"RTN","XMJMFA",9,0)
 D SRCHINIT(XMDUZ,.XMFLAGS,.XMSCREEN)
"RTN","XMJMFA",10,0)
 D INIT(XMDUZ,XMDETAIL,.XMLEN)
"RTN","XMJMFA",11,0)
 D SETOPT^XMJMLR1(XMDUZ,0,.XMOPT,.XMOX)
"RTN","XMJMFA",12,0)
 F  D  Q:XMABORT
"RTN","XMJMFA",13,0)
 . I XMCD S XMCD=0,XMDETAIL='XMDETAIL D INIT(XMDUZ,XMDETAIL,.XMLEN)
"RTN","XMJMFA",14,0)
 . D DISPLAY(XMDUZ,XMSTRING,XMFLAGS,XMSCREEN,.XMFROM,XMDETAIL,.XMKZ,.XMCNT,.XMFIRST,.XMPAGE,.XMMORE,.XMLEN,XMZOOM,XMPMAX)
"RTN","XMJMFA",15,0)
 . I XMCNT=0 S XMABORT=1 Q
"RTN","XMJMFA",16,0)
 . D CHOOSE^XMJMLN(XMDUZ,1,0,.XMKZ,.XMFIRST,.XMPAGE,XMMORE,.XMLEN,.XMZOOM,.XMOPT,.XMOX,"READMSG^XMJMFA",.XMABORT)
"RTN","XMJMFA",17,0)
 . S:'$D(^TMP("XM",$J,"MSG")) XMABORT=1
"RTN","XMJMFA",18,0)
 I XMCNT=0 D
"RTN","XMJMFA",19,0)
 . W $$EZBLD^DIALOG(34401) ;   No matches found.
"RTN","XMJMFA",20,0)
 . Q:'$G(XMWAIT)
"RTN","XMJMFA",21,0)
 . W ! D WAIT^XMXUTIL
"RTN","XMJMFA",22,0)
 K ^TMP("XM",$J,"MSG"),^TMP("XM",$J,".")
"RTN","XMJMFA",23,0)
 Q
"RTN","XMJMFA",24,0)
SRCHINIT(XMDUZ,XMFLAGS,XMSCREEN) ;
"RTN","XMJMFA",25,0)
 S XMSCREEN="",XMFLAGS=$S(XMV("ORDER")=-1:"B",1:"")
"RTN","XMJMFA",26,0)
 I XMDUZ=.5 S XMFLAGS=XMFLAGS_"U" Q  ; Ignore file screen
"RTN","XMJMFA",27,0)
 S XMSCREEN=XMSCREEN_"N X S X=^(0)"
"RTN","XMJMFA",28,0)
 N XMMIN
"RTN","XMJMFA",29,0)
 S XMMIN=$P(^XMB(3.7,XMDUZ,0),U,7)
"RTN","XMJMFA",30,0)
 ; If minimum date, don't choose lower date unless already in user's bskt
"RTN","XMJMFA",31,0)
 I XMMIN>0 S XMSCREEN=" I ^(.6)'<"_XMMIN_"!$D(^XMB(3.7,""M"",Y,XMDUZ))"
"RTN","XMJMFA",32,0)
 ; Msg must not be SPOOL, msg must not be a reply.
"RTN","XMJMFA",33,0)
 S XMSCREEN=XMSCREEN_" I $P(X,U,7)'=""S"",$S($P(X,U,8):0,$P(X,U)?1""R"".N:0,1:1)"
"RTN","XMJMFA",34,0)
 Q
"RTN","XMJMFA",35,0)
INIT(XMDUZ,XMDETAIL,XMLEN) ;
"RTN","XMJMFA",36,0)
 S XMLEN("BSKT")=10
"RTN","XMJMFA",37,0)
 S XMLEN("XMKZ")=3
"RTN","XMJMFA",38,0)
 D INIT^XMJML(XMDUZ,"","",XMDETAIL,.XMLEN)
"RTN","XMJMFA",39,0)
 Q
"RTN","XMJMFA",40,0)
DISPLAY(XMDUZ,XMSTRING,XMFLAGS,XMSCREEN,XMFROM,XMDETAIL,XMKZ,XMCNT,XMFIRST,XMPAGE,XMMORE,XMLEN,XMZOOM,XMPMAX) ;
"RTN","XMJMFA",41,0)
 N XMREC
"RTN","XMJMFA",42,0)
 S XMFIRST(XMPAGE)=XMKZ
"RTN","XMJMFA",43,0)
 D HEADER^XMJML(XMDETAIL,.XMLEN,$$EZBLD^DIALOG(34403)) ; All Messages Search
"RTN","XMJMFA",44,0)
 I XMZOOM D  Q
"RTN","XMJMFA",45,0)
 . F  S XMKZ=$O(^TMP("XM",$J,".",XMKZ)) Q:XMKZ=""  D  Q:$Y>XMPMAX
"RTN","XMJMFA",46,0)
 . . S XMREC=^TMP("XM",$J,"MSG",XMKZ)
"RTN","XMJMFA",47,0)
 . . D LISTMSG^XMJML($P(XMREC,U,1),$P(XMREC,U,2),XMKZ,$P(XMREC,U,3),XMDETAIL,.XMLEN)
"RTN","XMJMFA",48,0)
 F  S XMKZ=$O(^TMP("XM",$J,"MSG",XMKZ)) Q:XMKZ=""  D  Q:$Y>XMPMAX
"RTN","XMJMFA",49,0)
 . S XMREC=^TMP("XM",$J,"MSG",XMKZ)
"RTN","XMJMFA",50,0)
 . D LISTMSG^XMJML($P(XMREC,U,1),$P(XMREC,U,2),XMKZ,$P(XMREC,U,3),XMDETAIL,.XMLEN)
"RTN","XMJMFA",51,0)
 Q:$Y>XMPMAX!'XMMORE
"RTN","XMJMFA",52,0)
 ; File screen ^DD(3.9,0,"SCR") insists that user be author or recipient.
"RTN","XMJMFA",53,0)
 ; If FLAGS["U", then file screen is ignored.
"RTN","XMJMFA",54,0)
 D LIST^DIC(3.9,"","@",XMFLAGS,XMPMAX-$Y+1,.XMFROM,XMSTRING,"",XMSCREEN)
"RTN","XMJMFA",55,0)
 S:$P(^TMP("DILIST",$J,0),U,3)=0 XMMORE=0
"RTN","XMJMFA",56,0)
 D LISTMSG(XMDUZ,XMDETAIL,.XMCNT,.XMLEN)
"RTN","XMJMFA",57,0)
 S XMKZ=XMCNT
"RTN","XMJMFA",58,0)
 K ^TMP("DILIST",$J)
"RTN","XMJMFA",59,0)
 W:'XMMORE !,$$EZBLD^DIALOG(34402) ; Search finished.
"RTN","XMJMFA",60,0)
 Q
"RTN","XMJMFA",61,0)
LISTMSG(XMDUZ,XMDETAIL,XMCNT,XMLEN) ; Check and List
"RTN","XMJMFA",62,0)
 N XMK,XMKN,XMZ,I
"RTN","XMJMFA",63,0)
 S I=""
"RTN","XMJMFA",64,0)
 F  S I=$O(^TMP("DILIST",$J,2,I),XMV("ORDER")) Q:I'>0  D
"RTN","XMJMFA",65,0)
 . S XMCNT=XMCNT+1
"RTN","XMJMFA",66,0)
 . S XMZ=^TMP("DILIST",$J,2,I)
"RTN","XMJMFA",67,0)
 . S XMK=+$O(^XMB(3.7,"M",XMZ,XMDUZ,0))
"RTN","XMJMFA",68,0)
 . S XMKN=$S(XMK:$P(^XMB(3.7,XMDUZ,2,XMK,0),U),1:$$EZBLD^DIALOG(34014)) ; * N/A *
"RTN","XMJMFA",69,0)
 . I XMK,'$D(^XMB(3.7,XMDUZ,2,XMK,1,XMZ,0)) D ADDITM^XMUT4A(XMDUZ,XMK,XMZ)
"RTN","XMJMFA",70,0)
 . D LISTMSG^XMJML(XMK,XMKN,XMCNT,XMZ,XMDETAIL,.XMLEN)
"RTN","XMJMFA",71,0)
 . S ^TMP("XM",$J,"MSG",XMCNT)=XMK_U_XMKN_U_XMZ
"RTN","XMJMFA",72,0)
 Q
"RTN","XMJMFA",73,0)
READMSG ; (XMDUZ,XMKZ,XMREC) <- needed!
"RTN","XMJMFA",74,0)
 N XMK,XMKN,XMZ,XMRDR  ; $G(XMRDR) is checked in READMSG^XMJBM
"RTN","XMJMFA",75,0)
 S XMK=$P(XMREC,U,1),XMKN=$P(XMREC,U,2),XMZ=$P(XMREC,U,3)
"RTN","XMJMFA",76,0)
 I XMDUZ=.5,'XMK,'$$ACCESS^XMXSEC(XMDUZ,XMZ,$G(^XMB(3.9,XMZ,0))) D  Q
"RTN","XMJMFA",77,0)
 . D SHOW^XMJERR
"RTN","XMJMFA",78,0)
 . D WAIT^XMXUTIL
"RTN","XMJMFA",79,0)
 D READMSG^XMJBM(XMDUZ,XMK,XMKN,XMZ)
"RTN","XMJMFA",80,0)
 Q:$D(^XMB(3.7,"M",XMZ,XMDUZ,XMK))
"RTN","XMJMFA",81,0)
 S XMK=+$O(^XMB(3.7,"M",XMZ,XMDUZ,0))
"RTN","XMJMFA",82,0)
 S ^TMP("XM",$J,"MSG",XMKZ)=XMK_U_$S(XMK=0:$$EZBLD^DIALOG(34014),1:$P(^XMB(3.7,XMDUZ,2,XMK,0),U))_U_XMZ ; * N/A *
"RTN","XMJMFA",83,0)
 Q
"RTN","XMJMFB")
0^290^B72865137
"RTN","XMJMFB",1,0)
XMJMFB ;ISC-SF/GMB-Find message: multiple conditions ;07/12/2002  10:40
"RTN","XMJMFB",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMJMFB",3,0)
 ; Replaces ^XMAL0,^XMAL0A (ISC-WASH/JSH/CAP)
"RTN","XMJMFB",4,0)
 ; XMF("BSKT")  =number - Look in this basket ONLY
"RTN","XMJMFB",5,0)
 ;              =*      - Look in all baskets
"RTN","XMJMFB",6,0)
 ; XMF("SUBJ")  Subject contains this string
"RTN","XMJMFB",7,0)
 ; XMF("SUBJ","S") Look for this string in the subject
"RTN","XMJMFB",8,0)
 ; XMF("FLINE") Message has this many or more lines
"RTN","XMJMFB",9,0)
 ; XMF("TLINE") Message has this many or fewer lines
"RTN","XMJMFB",10,0)
 ; XMF("FROM")  Message is from this person
"RTN","XMJMFB",11,0)
 ; XMF("TO")    Message is to this person
"RTN","XMJMFB",12,0)
 ; XMF("FDATE") Message was sent on or after this date
"RTN","XMJMFB",13,0)
 ; XMF("TDATE") Message was sent on or before this date
"RTN","XMJMFB",14,0)
 ; XMF("RFROM") Message has a response from this person
"RTN","XMJMFB",15,0)
 ; XMF("TEXT")  Message contains this string
"RTN","XMJMFB",16,0)
 ; XMF("TEXT","S") Look for this string in the message
"RTN","XMJMFB",17,0)
 ; XMF("TEXT","L") =1 - Look in message only
"RTN","XMJMFB",18,0)
 ;                 =2 - Look in both message and responses
"RTN","XMJMFB",19,0)
 ;                 =3 - Look in responses only
"RTN","XMJMFB",20,0)
 ; XMF("TEXT","C") =0 - Search is not case-sensitive
"RTN","XMJMFB",21,0)
 ;                 =1 - Search is case-sensitive
"RTN","XMJMFB",22,0)
FIND1(XMDUZ,XMF,XMWAIT) ;
"RTN","XMJMFB",23,0)
 N XMK,XMKN,XMKZ,XMCNT,XMABORT,XMLEN,XMFIRST,XMPAGE,XMDETAIL,XMPMAX,XMMORE,XMZOOM,XMCD,XMOPT,XMOX
"RTN","XMJMFB",24,0)
 K ^TMP("XM",$J,"MSG"),^TMP("XM",$J,".")
"RTN","XMJMFB",25,0)
 S XMKZ="",(XMPAGE,XMCNT,XMZOOM,XMCD,XMABORT)=0,(XMDETAIL,XMMORE)=1,XMPMAX=IOSL-3
"RTN","XMJMFB",26,0)
 D INIT1(XMDUZ,.XMF,XMDETAIL,XMPMAX,.XMK,.XMKN,.XMLEN)
"RTN","XMJMFB",27,0)
 D SETOPT^XMJMLR1(XMDUZ,$S(XMDUZ'=.5:0,XMK<1000:0,1:XMK),.XMOPT,.XMOX)
"RTN","XMJMFB",28,0)
 F  D  Q:XMABORT
"RTN","XMJMFB",29,0)
 . I XMCD S XMCD=0,XMDETAIL='XMDETAIL D INIT1(XMDUZ,.XMF,XMDETAIL,XMPMAX,.XMK,.XMKN,.XMLEN)
"RTN","XMJMFB",30,0)
 . D DISPLAY1(XMDUZ,.XMF,XMDETAIL,.XMK,XMKN,.XMKZ,.XMCNT,.XMFIRST,.XMPAGE,.XMMORE,.XMLEN,XMZOOM,XMPMAX)
"RTN","XMJMFB",31,0)
 . I XMCNT=0 S XMABORT=1 Q
"RTN","XMJMFB",32,0)
 . D CHOOSE^XMJMLN(XMDUZ,0,XMK,.XMKZ,.XMFIRST,.XMPAGE,XMMORE,.XMLEN,.XMZOOM,.XMOPT,.XMOX,"READMSG^XMJMFB",.XMABORT)
"RTN","XMJMFB",33,0)
 . S:'$D(^TMP("XM",$J,"MSG")) XMABORT=1
"RTN","XMJMFB",34,0)
 I XMCNT=0 D
"RTN","XMJMFB",35,0)
 . W $C(7),$$EZBLD^DIALOG(34401) ;   No matches found.
"RTN","XMJMFB",36,0)
 . Q:'$G(XMWAIT)
"RTN","XMJMFB",37,0)
 . W ! D WAIT^XMXUTIL
"RTN","XMJMFB",38,0)
 K ^TMP("XM",$J,"MSG"),^TMP("XM",$J,".")
"RTN","XMJMFB",39,0)
 Q
"RTN","XMJMFB",40,0)
INIT1(XMDUZ,XMF,XMDETAIL,XMPMAX,XMK,XMKN,XMLEN) ;
"RTN","XMJMFB",41,0)
 S:$D(XMF("SUBJ")) XMF("SUBJ","S")=$$UP^XLFSTR(XMF("SUBJ"))
"RTN","XMJMFB",42,0)
 S:$D(XMF("TEXT")) XMF("TEXT","S")=$S('XMF("TEXT","C"):$$UP^XLFSTR(XMF("TEXT")),1:XMF("TEXT"))
"RTN","XMJMFB",43,0)
 S XMK=XMF("BSKT")
"RTN","XMJMFB",44,0)
 S XMKN=$P(^XMB(3.7,XMDUZ,2,XMK,0),U)
"RTN","XMJMFB",45,0)
 D INIT^XMJML(XMDUZ,XMK,XMKN,XMDETAIL,.XMLEN,1)
"RTN","XMJMFB",46,0)
 Q
"RTN","XMJMFB",47,0)
DISPLAY1(XMDUZ,XMF,XMDETAIL,XMK,XMKN,XMKZ,XMCNT,XMFIRST,XMPAGE,XMMORE,XMLEN,XMZOOM,XMPMAX) ;
"RTN","XMJMFB",48,0)
 N XMREC,XMZ
"RTN","XMJMFB",49,0)
 S XMFIRST(XMPAGE)=XMKZ
"RTN","XMJMFB",50,0)
 D HEADER^XMJML(XMDETAIL,.XMLEN,$$EZBLD^DIALOG(34404,XMKN)) ; XMKN_ Basket Search
"RTN","XMJMFB",51,0)
 I XMZOOM D  Q
"RTN","XMJMFB",52,0)
 . F  S XMKZ=$O(^TMP("XM",$J,".",XMKZ),XMV("ORDER")) Q:XMKZ=""  D  Q:$Y>XMPMAX
"RTN","XMJMFB",53,0)
 . . S XMREC=^TMP("XM",$J,"MSG",XMKZ)
"RTN","XMJMFB",54,0)
 . . D LISTMSG^XMJML($P(XMREC,U,1),$P(XMREC,U,2),XMKZ,$P(XMREC,U,3),XMDETAIL,.XMLEN)
"RTN","XMJMFB",55,0)
 F  S XMKZ=$O(^TMP("XM",$J,"MSG",XMKZ),XMV("ORDER")) Q:XMKZ=""  D  Q:$Y>XMPMAX
"RTN","XMJMFB",56,0)
 . S XMREC=^TMP("XM",$J,"MSG",XMKZ)
"RTN","XMJMFB",57,0)
 . D LISTMSG^XMJML($P(XMREC,U,1),$P(XMREC,U,2),XMKZ,$P(XMREC,U,3),XMDETAIL,.XMLEN)
"RTN","XMJMFB",58,0)
 Q:$Y>XMPMAX!'XMMORE
"RTN","XMJMFB",59,0)
 D CHKNLST1(XMDUZ,.XMF,XMDETAIL,XMK,XMKN,.XMKZ,.XMCNT,XMPMAX,.XMLEN)
"RTN","XMJMFB",60,0)
 S:XMKZ'>0 XMMORE=0
"RTN","XMJMFB",61,0)
 W:'XMMORE !,$$EZBLD^DIALOG(34402) ; Search finished.
"RTN","XMJMFB",62,0)
 Q
"RTN","XMJMFB",63,0)
CHKNLST1(XMDUZ,XMF,XMDETAIL,XMK,XMKN,XMKZ,XMCNT,XMPMAX,XMLEN) ; Check and List
"RTN","XMJMFB",64,0)
 N XMZ
"RTN","XMJMFB",65,0)
 S:XMKZ="" XMKZ=$O(^TMP("XM",$J,"MSG",""),-XMV("ORDER"))
"RTN","XMJMFB",66,0)
 F  S XMKZ=$O(^XMB(3.7,XMDUZ,2,XMK,1,"C",XMKZ),XMV("ORDER")) Q:XMKZ'>0  D  Q:$Y>XMPMAX
"RTN","XMJMFB",67,0)
 . S XMZ=$O(^XMB(3.7,XMDUZ,2,XMK,1,"C",XMKZ,0))
"RTN","XMJMFB",68,0)
 . I '$D(^XMB(3.7,XMDUZ,2,XMK,1,XMZ,0)) D ADDITC^XMUT4A(XMDUZ,XMK,XMZ,XMKZ)
"RTN","XMJMFB",69,0)
 . Q:'$$GOODMSG(XMDUZ,XMK,XMZ,.XMF)
"RTN","XMJMFB",70,0)
 . S XMCNT=XMCNT+1
"RTN","XMJMFB",71,0)
 . D LISTMSG^XMJML(XMK,XMKN,XMKZ,XMZ,XMDETAIL,.XMLEN)
"RTN","XMJMFB",72,0)
 . S ^TMP("XM",$J,"MSG",XMKZ)=XMK_U_XMKN_U_XMZ
"RTN","XMJMFB",73,0)
 Q
"RTN","XMJMFB",74,0)
FINDALL(XMDUZ,XMF) ;
"RTN","XMJMFB",75,0)
 N XMK,XMKN,XMKZZ,XMKZ,XMCNT,XMABORT,XMLEN,XMFIRST,XMPAGE,XMDETAIL,XMPMAX,XMMORE,XMZOOM,XMCD,XMOPT,XMOX
"RTN","XMJMFB",76,0)
 S (XMKZ,XMKZZ)="",(XMK,XMPAGE,XMCNT,XMZOOM,XMCD,XMABORT)=0,(XMDETAIL,XMMORE)=1,XMPMAX=IOSL-3
"RTN","XMJMFB",77,0)
 D INITA(XMDUZ,.XMF,.XMK,.XMKN,.XMKZZ,.XMLEN,.XMABORT) Q:XMABORT
"RTN","XMJMFB",78,0)
 D SETOPT^XMJMLR1(XMDUZ,0,.XMOPT,.XMOX)
"RTN","XMJMFB",79,0)
 K ^TMP("XM",$J,"MSG"),^TMP("XM",$J,".")
"RTN","XMJMFB",80,0)
 F  D  Q:XMABORT
"RTN","XMJMFB",81,0)
 . D DISPLAYA(XMDUZ,.XMF,.XMDETAIL,.XMK,XMKN,.XMKZZ,.XMKZ,.XMCNT,.XMFIRST,.XMPAGE,.XMMORE,.XMLEN,XMZOOM,XMPMAX)
"RTN","XMJMFB",82,0)
 . D CHOOSE^XMJMLN(XMDUZ,1,0,.XMKZ,.XMFIRST,.XMPAGE,XMMORE,.XMLEN,.XMZOOM,.XMOPT,.XMOX,"READMSG^XMJMFB",.XMABORT)
"RTN","XMJMFB",83,0)
 . S:'$D(^TMP("XM",$J,"MSG")) XMABORT=1
"RTN","XMJMFB",84,0)
 K ^TMP("XM",$J,"MSG"),^TMP("XM",$J,".")
"RTN","XMJMFB",85,0)
 Q
"RTN","XMJMFB",86,0)
INITA(XMDUZ,XMF,XMK,XMKN,XMKZZ,XMLEN,XMABORT) ;
"RTN","XMJMFB",87,0)
 S:$D(XMF("SUBJ")) XMF("SUBJ","S")=$$UP^XLFSTR(XMF("SUBJ"))
"RTN","XMJMFB",88,0)
 S:$D(XMF("TEXT")) XMF("TEXT","S")=$S('XMF("TEXT","C"):$$UP^XLFSTR(XMF("TEXT")),1:XMF("TEXT"))
"RTN","XMJMFB",89,0)
 S XMLEN("XMKZ")=0
"RTN","XMJMFB",90,0)
 F  S XMK=$O(^XMB(3.7,XMDUZ,2,XMK)) Q:XMK'>0  D  Q:$D(XMKN)
"RTN","XMJMFB",91,0)
 . F  S XMKZZ=$O(^XMB(3.7,XMDUZ,2,XMK,1,"C",XMKZZ),XMV("ORDER")) Q:XMKZZ'>0  D  Q:$D(XMKN)
"RTN","XMJMFB",92,0)
 . . S XMZ=$O(^XMB(3.7,XMDUZ,2,XMK,1,"C",XMKZZ,0))
"RTN","XMJMFB",93,0)
 . . Q:'$$GOODMSG(XMDUZ,XMK,XMZ,.XMF)
"RTN","XMJMFB",94,0)
 . . S XMKN=$P(^XMB(3.7,XMDUZ,2,XMK,0),U)
"RTN","XMJMFB",95,0)
 I $D(XMKN) S XMKZZ=XMKZZ-XMV("ORDER") Q
"RTN","XMJMFB",96,0)
 S XMABORT=1
"RTN","XMJMFB",97,0)
 W $C(7),$$EZBLD^DIALOG(34401),! ;   No matches found.
"RTN","XMJMFB",98,0)
 D WAIT^XMXUTIL
"RTN","XMJMFB",99,0)
 Q
"RTN","XMJMFB",100,0)
DISPLAYA(XMDUZ,XMF,XMDETAIL,XMK,XMKN,XMKZZ,XMKZ,XMCNT,XMFIRST,XMPAGE,XMMORE,XMLEN,XMZOOM,XMPMAX) ;
"RTN","XMJMFB",101,0)
 N XMREC,XMZ
"RTN","XMJMFB",102,0)
 S XMFIRST(XMPAGE)=XMKZ
"RTN","XMJMFB",103,0)
 I XMCD D
"RTN","XMJMFB",104,0)
 . S XMCD=0,XMDETAIL='XMDETAIL
"RTN","XMJMFB",105,0)
 . D INIT^XMJML(XMDUZ,XMK,XMKN,XMDETAIL,.XMLEN)
"RTN","XMJMFB",106,0)
 E  I $L(XMCNT+XMPMAX)>XMLEN("XMKZ") D
"RTN","XMJMFB",107,0)
 . S XMLEN("XMKZ")=$L(XMCNT+XMPMAX)
"RTN","XMJMFB",108,0)
 . D INIT^XMJML(XMDUZ,XMK,XMKN,XMDETAIL,.XMLEN)
"RTN","XMJMFB",109,0)
 D HEADER^XMJML(XMDETAIL,.XMLEN,$$EZBLD^DIALOG(34405)) ; All Baskets Search
"RTN","XMJMFB",110,0)
 I XMZOOM D  Q
"RTN","XMJMFB",111,0)
 . F  S XMKZ=$O(^TMP("XM",$J,".",XMKZ)) Q:XMKZ=""  D  Q:$Y>XMPMAX
"RTN","XMJMFB",112,0)
 . . S XMREC=^TMP("XM",$J,"MSG",XMKZ)
"RTN","XMJMFB",113,0)
 . . D LISTMSG^XMJML($P(XMREC,U,1),$P(XMREC,U,2),XMKZ,$P(XMREC,U,3),XMDETAIL,.XMLEN)
"RTN","XMJMFB",114,0)
 F  S XMKZ=$O(^TMP("XM",$J,"MSG",XMKZ)) Q:XMKZ=""  D  Q:$Y>XMPMAX
"RTN","XMJMFB",115,0)
 . S XMREC=^TMP("XM",$J,"MSG",XMKZ)
"RTN","XMJMFB",116,0)
 . D LISTMSG^XMJML($P(XMREC,U,1),$P(XMREC,U,2),XMKZ,$P(XMREC,U,3),XMDETAIL,.XMLEN)
"RTN","XMJMFB",117,0)
 Q:$Y>XMPMAX!'XMMORE
"RTN","XMJMFB",118,0)
 S XMK=XMK-.01
"RTN","XMJMFB",119,0)
 F  S XMK=$O(^XMB(3.7,XMDUZ,2,XMK)) Q:XMK'>0  D  Q:$Y>XMPMAX
"RTN","XMJMFB",120,0)
 . S XMKN=$P(^XMB(3.7,XMDUZ,2,XMK,0),U)
"RTN","XMJMFB",121,0)
 . D CHKNLSTA(XMDUZ,.XMF,XMDETAIL,XMK,XMKN,.XMKZZ,.XMCNT,XMPMAX,.XMLEN)
"RTN","XMJMFB",122,0)
 I XMK'>0,XMKZZ'>0 S XMMORE=0
"RTN","XMJMFB",123,0)
 S XMKZ=XMCNT
"RTN","XMJMFB",124,0)
 W:'XMMORE !,$$EZBLD^DIALOG(34402) ; Search finished.
"RTN","XMJMFB",125,0)
 Q
"RTN","XMJMFB",126,0)
CHKNLSTA(XMDUZ,XMF,XMDETAIL,XMK,XMKN,XMKZZ,XMCNT,XMPMAX,XMLEN) ; Check and List
"RTN","XMJMFB",127,0)
 N XMZ
"RTN","XMJMFB",128,0)
 F  S XMKZZ=$O(^XMB(3.7,XMDUZ,2,XMK,1,"C",XMKZZ),XMV("ORDER")) Q:XMKZZ'>0  D  Q:$Y>XMPMAX
"RTN","XMJMFB",129,0)
 . S XMZ=$O(^XMB(3.7,XMDUZ,2,XMK,1,"C",XMKZZ,0))
"RTN","XMJMFB",130,0)
 . I '$D(^XMB(3.7,XMDUZ,2,XMK,1,XMZ,0)) D ADDITC^XMUT4A(XMDUZ,XMK,XMZ,XMKZZ)
"RTN","XMJMFB",131,0)
 . Q:'$$GOODMSG(XMDUZ,XMK,XMZ,.XMF)
"RTN","XMJMFB",132,0)
 . I $L(XMKN)>$G(XMLEN("BSKT")) D
"RTN","XMJMFB",133,0)
 . . S XMLEN("BSKT")=$$MIN^XLFMTH($L(XMKN),10)
"RTN","XMJMFB",134,0)
 . . D INIT^XMJML(XMDUZ,XMK,XMKN,XMDETAIL,.XMLEN)
"RTN","XMJMFB",135,0)
 . S XMCNT=XMCNT+1
"RTN","XMJMFB",136,0)
 . D LISTMSG^XMJML(XMK,XMKN,XMCNT,XMZ,XMDETAIL,.XMLEN)
"RTN","XMJMFB",137,0)
 . S ^TMP("XM",$J,"MSG",XMCNT)=XMK_U_XMKN_U_XMZ
"RTN","XMJMFB",138,0)
 Q
"RTN","XMJMFB",139,0)
GOODMSG(XMDUZ,XMK,XMZ,XMF) ;
"RTN","XMJMFB",140,0)
 N XMZREC,XMNOGOOD,XMZFROM,XMZDATE
"RTN","XMJMFB",141,0)
 S XMZREC=$G(^XMB(3.9,XMZ,0))
"RTN","XMJMFB",142,0)
 I XMZREC="",XMK D ZAPIT^XMXMSGS2(XMDUZ,XMK,XMZ) Q 0
"RTN","XMJMFB",143,0)
 I $D(XMF("SUBJ")),$$UP^XLFSTR($P(XMZREC,U,1))'[XMF("SUBJ","S") Q 0
"RTN","XMJMFB",144,0)
 I $D(XMF("FROM")) Q:'$$GOODFROM(XMZREC,XMF("FROM")) 0
"RTN","XMJMFB",145,0)
 I $D(XMF("FLINE"))!$D(XMF("TLINE")) D  Q:XMNOGOOD 0
"RTN","XMJMFB",146,0)
 . N XMLINES
"RTN","XMJMFB",147,0)
 . S XMNOGOOD=1
"RTN","XMJMFB",148,0)
 . S XMLINES=$$LINE^XMXUTIL2(XMZ)
"RTN","XMJMFB",149,0)
 . I $D(XMF("FLINE")),XMLINES<XMF("FLINE") Q
"RTN","XMJMFB",150,0)
 . I $D(XMF("TLINE")),XMF("TLINE")<XMLINES Q
"RTN","XMJMFB",151,0)
 . S XMNOGOOD=0
"RTN","XMJMFB",152,0)
 I $D(XMF("FDATE"))!$D(XMF("TDATE")) D  Q:XMNOGOOD 0
"RTN","XMJMFB",153,0)
 . S XMNOGOOD=1
"RTN","XMJMFB",154,0)
 . S XMZDATE=$P(XMZREC,U,3)
"RTN","XMJMFB",155,0)
 . S:XMZDATE'=+XMZDATE XMZDATE=$$CONVERT^XMXUTIL1(XMZDATE)
"RTN","XMJMFB",156,0)
 . S XMZDATE=$P(XMZDATE,".")
"RTN","XMJMFB",157,0)
 . I $D(XMF("FDATE")),XMZDATE<XMF("FDATE") Q
"RTN","XMJMFB",158,0)
 . I $D(XMF("TDATE")),XMF("TDATE")<XMZDATE Q
"RTN","XMJMFB",159,0)
 . S XMNOGOOD=0
"RTN","XMJMFB",160,0)
 I $D(XMF("TO")) D  Q:XMNOGOOD 0
"RTN","XMJMFB",161,0)
 . I $D(^XMB(3.9,XMZ,6,"B",XMF("TO"))) S XMNOGOOD=0 Q
"RTN","XMJMFB",162,0)
 . I $L(XMF("TO"))>30,$D(^XMB(3.9,XMZ,6,"B",$E(XMF("TO"),1,30))),XMF("TO")=$P($G(^XMB(3.9,XMZ,6,+$O(^XMB(3.9,XMZ,6,"B",$E(XMF("TO"),1,30),0)),0)),U,1) S XMNOGOOD=0 Q
"RTN","XMJMFB",163,0)
 . S XMNOGOOD=1
"RTN","XMJMFB",164,0)
 . Q:XMF("TO")'["@"
"RTN","XMJMFB",165,0)
 . N XMTOX,XMTO
"RTN","XMJMFB",166,0)
 . S XMTO=""
"RTN","XMJMFB",167,0)
 . F  S XMTO=$O(^XMB(3.9,XMZ,6,"B",XMTO)) Q:XMTO=""  D  Q:'XMNOGOOD
"RTN","XMJMFB",168,0)
 . . Q:XMTO'["@"
"RTN","XMJMFB",169,0)
 . . S XMTOX=$$UP^XLFSTR(XMTO)
"RTN","XMJMFB",170,0)
 . . Q:$P(XMTOX,"@")'[$P(XMF("TO"),"@")
"RTN","XMJMFB",171,0)
 . . Q:$P(XMTOX,"@",2)'[$P(XMF("TO"),"@",2)
"RTN","XMJMFB",172,0)
 . . S XMNOGOOD=0
"RTN","XMJMFB",173,0)
 I $D(XMF("RFROM")) D  Q:XMNOGOOD 0
"RTN","XMJMFB",174,0)
 . N XMIEN,XMZR
"RTN","XMJMFB",175,0)
 . S XMNOGOOD=1
"RTN","XMJMFB",176,0)
 . S XMIEN=0
"RTN","XMJMFB",177,0)
 . F  S XMIEN=$O(^XMB(3.9,XMZ,3,XMIEN)) Q:'XMIEN  S XMZR=^(XMIEN,0) I $$GOODFROM($G(^XMB(3.9,XMZR,0)),XMF("RFROM")) S XMNOGOOD=0 Q
"RTN","XMJMFB",178,0)
 I $D(XMF("TEXT")) D  Q:XMNOGOOD 0
"RTN","XMJMFB",179,0)
 . S XMNOGOOD=1
"RTN","XMJMFB",180,0)
 . I XMF("TEXT","L")<3 D  Q:XMF("TEXT","L")=1!(XMNOGOOD=0)
"RTN","XMJMFB",181,0)
 . . S:$$GOODTEXT(XMZ,XMF("TEXT","S"),XMF("TEXT","C")) XMNOGOOD=0
"RTN","XMJMFB",182,0)
 . N XMIEN,XMZR
"RTN","XMJMFB",183,0)
 . S XMIEN=0
"RTN","XMJMFB",184,0)
 . F  S XMIEN=$O(^XMB(3.9,XMZ,3,XMIEN)) Q:'XMIEN  S XMZR=^(XMIEN,0) I $$GOODTEXT(XMZR,XMF("TEXT","S"),XMF("TEXT","C")) S XMNOGOOD=0 Q
"RTN","XMJMFB",185,0)
 Q 1
"RTN","XMJMFB",186,0)
GOODFROM(XMZREC,XMF) ; Returns 1 if msg is from XMF; 0 if not
"RTN","XMJMFB",187,0)
 N XMZFROM
"RTN","XMJMFB",188,0)
 S XMZFROM=$P(XMZREC,U,2)
"RTN","XMJMFB",189,0)
 I XMF=+XMF,XMF=XMZFROM Q 1
"RTN","XMJMFB",190,0)
 Q:XMF'["@" 0
"RTN","XMJMFB",191,0)
 S XMZFROM=$$UP^XLFSTR(XMZFROM)
"RTN","XMJMFB",192,0)
 Q:$P(XMZFROM,"@")'[$P(XMF,"@") 0
"RTN","XMJMFB",193,0)
 Q:$P(XMZFROM,"@",2)'[$P(XMF,"@",2) 0
"RTN","XMJMFB",194,0)
 Q 1
"RTN","XMJMFB",195,0)
GOODTEXT(XMZ,XMF,XMFMATTR) ; Returns positive number if msg contains XMF; 0 if not
"RTN","XMJMFB",196,0)
 N I
"RTN","XMJMFB",197,0)
 S I=.999999
"RTN","XMJMFB",198,0)
 I XMFMATTR D
"RTN","XMJMFB",199,0)
 . F  S I=$O(^XMB(3.9,XMZ,2,I)) Q:'I  Q:^(I,0)[XMF
"RTN","XMJMFB",200,0)
 E  D
"RTN","XMJMFB",201,0)
 . F  S I=$O(^XMB(3.9,XMZ,2,I)) Q:'I  Q:$$UP^XLFSTR(^(I,0))[XMF
"RTN","XMJMFB",202,0)
 Q +I
"RTN","XMJMFB",203,0)
READMSG ; (XMDUZ,XMKZ,XMREC) <- needed!
"RTN","XMJMFB",204,0)
 N XMK,XMKN,XMZ,XMRDR  ; $G(XMRDR) is checked in READMSG^XMJBM
"RTN","XMJMFB",205,0)
 S XMK=$P(XMREC,U,1),XMKN=$P(XMREC,U,2),XMZ=$P(XMREC,U,3)
"RTN","XMJMFB",206,0)
 D READMSG^XMJBM(XMDUZ,XMK,XMKN,XMZ)
"RTN","XMJMFB",207,0)
 Q:$D(^XMB(3.7,"M",XMZ,XMDUZ,XMK))
"RTN","XMJMFB",208,0)
 I XMF("BSKT")=XMK K ^TMP("XM",$J,"MSG",XMKZ) Q
"RTN","XMJMFB",209,0)
 S XMK=+$O(^XMB(3.7,"M",XMZ,XMDUZ,0))
"RTN","XMJMFB",210,0)
 S ^TMP("XM",$J,"MSG",XMKZ)=XMK_U_$S(XMK=0:$$EZBLD^DIALOG(34014),1:$P(^XMB(3.7,XMDUZ,2,XMK,0),U))_U_XMZ ; * N/A *
"RTN","XMJMFB",211,0)
 Q
"RTN","XMJMFC")
0^291^B36679658
"RTN","XMJMFC",1,0)
XMJMFC ;ISC-SF/GMB-Find message in file 3.9 ;07/12/2002  10:34
"RTN","XMJMFC",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMJMFC",3,0)
 ; Search for messages in the MESSAGE file
"RTN","XMJMFC",4,0)
FIND(XMDUZ,XMF,XMWAIT) ;
"RTN","XMJMFC",5,0)
 I $G(XMF("FLAGS"))["U",'$$SSPRIV^XMXSEC1 D  Q
"RTN","XMJMFC",6,0)
 . D SHOW^XMJERR
"RTN","XMJMFC",7,0)
 . D WAIT^XMXUTIL
"RTN","XMJMFC",8,0)
 N XMKZ,XMCNT,XMABORT,XMLEN,XMFIRST,XMPAGE,XMDETAIL,XMPMAX,XMMORE,XMFLAGS,XMSCREEN,XMFROM,XMZOOM,XMCD,XMOPT,XMOX,XMSAVE
"RTN","XMJMFC",9,0)
 S XMSAVE("FDATE")=XMF("FDATE") K XMF("FDATE")
"RTN","XMJMFC",10,0)
 S XMSAVE("TDATE")=XMF("TDATE") K XMF("TDATE")
"RTN","XMJMFC",11,0)
 K ^TMP("XM",$J,"MSG"),^TMP("XM",$J,".")
"RTN","XMJMFC",12,0)
 S (XMKZ,XMZ,XMPAGE,XMCNT,XMZOOM,XMCD,XMABORT)=0,(XMDETAIL,XMMORE)=1,XMPMAX=IOSL-3
"RTN","XMJMFC",13,0)
 D SRCHINIT(XMDUZ,.XMF,.XMFLAGS,.XMSCREEN,.XMFROM,.XMABORT) Q:XMABORT
"RTN","XMJMFC",14,0)
 D INIT(XMDUZ,XMFLAGS,XMDETAIL,.XMLEN)
"RTN","XMJMFC",15,0)
 D SETOPT^XMJMLR1(XMDUZ,$S(XMFLAGS["U":"!",1:0),.XMOPT,.XMOX)
"RTN","XMJMFC",16,0)
 F  D  Q:XMABORT
"RTN","XMJMFC",17,0)
 . I XMCD S XMCD=0,XMDETAIL='XMDETAIL D INIT(XMDUZ,XMFLAGS,XMDETAIL,.XMLEN)
"RTN","XMJMFC",18,0)
 . D DISPLAY(XMDUZ,.XMF,XMFLAGS,XMSCREEN,.XMFROM,XMDETAIL,.XMKZ,.XMCNT,.XMFIRST,.XMPAGE,.XMMORE,.XMLEN,XMZOOM,XMPMAX)
"RTN","XMJMFC",19,0)
 . I XMCNT=0 S XMABORT=1 Q
"RTN","XMJMFC",20,0)
 . D CHOOSE^XMJMLN(XMDUZ,1,0,.XMKZ,.XMFIRST,.XMPAGE,XMMORE,.XMLEN,.XMZOOM,.XMOPT,.XMOX,"READMSG^XMJMFC",.XMABORT)
"RTN","XMJMFC",21,0)
 . S:'$D(^TMP("XM",$J,"MSG")) XMABORT=1
"RTN","XMJMFC",22,0)
 I XMCNT=0 D
"RTN","XMJMFC",23,0)
 . W $$EZBLD^DIALOG(34401) ;   No matches found.
"RTN","XMJMFC",24,0)
 . Q:'$G(XMWAIT)
"RTN","XMJMFC",25,0)
 . W ! D WAIT^XMXUTIL
"RTN","XMJMFC",26,0)
 K ^TMP("XM",$J,"MSG"),^TMP("XM",$J,".")
"RTN","XMJMFC",27,0)
 S XMF("FDATE")=XMSAVE("FDATE"),XMF("TDATE")=XMSAVE("TDATE")
"RTN","XMJMFC",28,0)
 Q
"RTN","XMJMFC",29,0)
INIT(XMDUZ,XMFLAGS,XMDETAIL,XMLEN) ;
"RTN","XMJMFC",30,0)
 I XMFLAGS'["U" S XMLEN("BSKT")=10
"RTN","XMJMFC",31,0)
 S XMLEN("XMKZ")=3
"RTN","XMJMFC",32,0)
 D INIT^XMJML(XMDUZ,"","",XMDETAIL,.XMLEN,XMFLAGS["U")
"RTN","XMJMFC",33,0)
 Q
"RTN","XMJMFC",34,0)
SRCHINIT(XMDUZ,XMF,XMFLAGS,XMSCREEN,XMFROM,XMABORT) ;
"RTN","XMJMFC",35,0)
 I XMV("ORDER")=-1 D
"RTN","XMJMFC",36,0)
 . S XMFLAGS="B"
"RTN","XMJMFC",37,0)
 . S XMFROM=$O(^XMB(3.9,"C",XMSAVE("TDATE")))
"RTN","XMJMFC",38,0)
 E  D
"RTN","XMJMFC",39,0)
 . S XMFLAGS=""
"RTN","XMJMFC",40,0)
 . S XMFROM=$O(^XMB(3.9,"C",XMSAVE("FDATE")),-1)
"RTN","XMJMFC",41,0)
 S XMFLAGS=$S(XMV("ORDER")=-1:"B",1:"")
"RTN","XMJMFC",42,0)
 I $G(XMF("FLAGS"))["U" D  Q:XMABORT
"RTN","XMJMFC",43,0)
 . S XMFLAGS=XMFLAGS_"U" ; Ignore file screen
"RTN","XMJMFC",44,0)
 . D AUDIT(.XMF)
"RTN","XMJMFC",45,0)
 . Q:'$D(XMERR)
"RTN","XMJMFC",46,0)
 . S XMABORT=1
"RTN","XMJMFC",47,0)
 . D SHOW^XMJERR
"RTN","XMJMFC",48,0)
 . D WAIT^XMXUTIL
"RTN","XMJMFC",49,0)
 S:$D(XMF("SUBJ")) XMF("SUBJ","S")=$$UP^XLFSTR(XMF("SUBJ"))
"RTN","XMJMFC",50,0)
 S:$D(XMF("TEXT")) XMF("TEXT","S")=$S('XMF("TEXT","C"):$$UP^XLFSTR(XMF("TEXT")),1:XMF("TEXT"))
"RTN","XMJMFC",51,0)
 S XMSCREEN=$$SCREEN(XMDUZ)
"RTN","XMJMFC",52,0)
 Q
"RTN","XMJMFC",53,0)
AUDIT(XMF) ; Send a bulletin to G.XM SUPER SEARCH
"RTN","XMJMFC",54,0)
 N XMINSTR,XMPARM,XMTEXT,I
"RTN","XMJMFC",55,0)
 I '$$GOTLOCAL^XMXAPIG("XM SUPER SEARCH",90,2) D ERRSET^XMXUTIL(34413.6) Q
"RTN","XMJMFC",56,0)
 S XMINSTR("FROM")=.5
"RTN","XMJMFC",57,0)
 S XMPARM(1)=XMV("DUZ NAME")
"RTN","XMJMFC",58,0)
 S I=1,XMTEXT(I)=$$LJ^XLFSTR($$EZBLD^DIALOG(34443)_":",30)_$$FMTE^XLFDT(XMSAVE("FDATE"))_" - "_$$FMTE^XLFDT(XMSAVE("TDATE")) ; Search period
"RTN","XMJMFC",59,0)
 I $D(XMF("SUBJ")) D  ; Subject contains
"RTN","XMJMFC",60,0)
 . S I=I+1,XMTEXT(I)=$$LJ^XLFSTR($$EZBLD^DIALOG(34438)_":",30)_XMF("SUBJ")
"RTN","XMJMFC",61,0)
 I $D(XMF("FROM")) D  ; Message from
"RTN","XMJMFC",62,0)
 . S I=I+1,XMTEXT(I)=$$LJ^XLFSTR($$EZBLD^DIALOG(34440)_":",30)_$$NAME^XMXUTIL(XMF("FROM"))
"RTN","XMJMFC",63,0)
 I $D(XMF("TO")) D  ; Message to
"RTN","XMJMFC",64,0)
 . S I=I+1,XMTEXT(I)=$$LJ^XLFSTR($$EZBLD^DIALOG(34440.2)_":",30)_XMF("TO")
"RTN","XMJMFC",65,0)
 I $D(XMF("FLINE")) D  ; Lines of text, minimum
"RTN","XMJMFC",66,0)
 . S I=I+1,XMTEXT(I)=$$LJ^XLFSTR($$EZBLD^DIALOG(34449)_":",30)_XMF("FLINE")
"RTN","XMJMFC",67,0)
 ;I $D(XMF("TLINE")) D  ; Lines of text, maximum
"RTN","XMJMFC",68,0)
 ;. S I=I+1,XMTEXT(I)=$$LJ^XLFSTR($$EZBLD^DIALOG(34450)_":",30)_XMF("TLINE")
"RTN","XMJMFC",69,0)
 I $D(XMF("RFROM")) D  ; Response from
"RTN","XMJMFC",70,0)
 . S I=I+1,XMTEXT(I)=$$LJ^XLFSTR($$EZBLD^DIALOG(34440.1)_":",30)_$$NAME^XMXUTIL(XMF("RFROM"))
"RTN","XMJMFC",71,0)
 I $D(XMF("TEXT")) D
"RTN","XMJMFC",72,0)
 . ; x.1:Message / x.2:Message or Response / x.3:Response contains
"RTN","XMJMFC",73,0)
 . S I=I+1,XMTEXT(I)=$$LJ^XLFSTR($$EZBLD^DIALOG(34446+(XMF("TEXT","L")/10))_":",30)_XMF("TEXT")
"RTN","XMJMFC",74,0)
 D SENDBULL^XMXBULL(DUZ,"XM SUPER SEARCH",.XMPARM,"XMTEXT","G.XM SUPER SEARCH",.XMINSTR)
"RTN","XMJMFC",75,0)
 I $D(XMERR) D ERRSET^XMXUTIL(34413.6)
"RTN","XMJMFC",76,0)
 Q
"RTN","XMJMFC",77,0)
SCREEN(XMDUZ) ;
"RTN","XMJMFC",78,0)
 S XMSCREEN="N X S X=^(0)"
"RTN","XMJMFC",79,0)
 I XMDUZ'=.5 D
"RTN","XMJMFC",80,0)
 . N XMMIN
"RTN","XMJMFC",81,0)
 . S XMMIN=$P(^XMB(3.7,XMDUZ,0),U,7)
"RTN","XMJMFC",82,0)
 . ; If minimum date, don't choose lower date unless already in user's bskt
"RTN","XMJMFC",83,0)
 . I XMMIN>0 S XMSCREEN=" I ^(.6)'<"_XMMIN_"!$D(^XMB(3.7,""M"",Y,XMDUZ))"
"RTN","XMJMFC",84,0)
 ; Msg must not be SPOOL, msg must not be a reply.
"RTN","XMJMFC",85,0)
 Q XMSCREEN_" I $P(X,U,7)'=""S"",'$P(X,U,8),$P(X,U)'?1""R"".N,$$GOODMSG^XMJMFB(XMDUZ,0,Y,.XMF)"
"RTN","XMJMFC",86,0)
DISPLAY(XMDUZ,XMF,XMFLAGS,XMSCREEN,XMFROM,XMDETAIL,XMKZ,XMCNT,XMFIRST,XMPAGE,XMMORE,XMLEN,XMZOOM,XMPMAX) ;
"RTN","XMJMFC",87,0)
 N XMREC
"RTN","XMJMFC",88,0)
 S XMFIRST(XMPAGE)=XMKZ
"RTN","XMJMFC",89,0)
 D HEADER^XMJML(XMDETAIL,.XMLEN,$$EZBLD^DIALOG($S(XMFLAGS["U":34403.5,1:34403))) ; All Messages Super Search / All Messages Search
"RTN","XMJMFC",90,0)
 I XMZOOM D  Q
"RTN","XMJMFC",91,0)
 . F  S XMKZ=$O(^TMP("XM",$J,".",XMKZ)) Q:XMKZ=""  D  Q:$Y>XMPMAX
"RTN","XMJMFC",92,0)
 . . S XMREC=^TMP("XM",$J,"MSG",XMKZ)
"RTN","XMJMFC",93,0)
 . . D LISTMSG^XMJML($P(XMREC,U,1),$P(XMREC,U,2),XMKZ,$P(XMREC,U,3),XMDETAIL,.XMLEN)
"RTN","XMJMFC",94,0)
 F  S XMKZ=$O(^TMP("XM",$J,"MSG",XMKZ)) Q:XMKZ=""  D  Q:$Y>XMPMAX
"RTN","XMJMFC",95,0)
 . S XMREC=^TMP("XM",$J,"MSG",XMKZ)
"RTN","XMJMFC",96,0)
 . D LISTMSG^XMJML($P(XMREC,U,1),$P(XMREC,U,2),XMKZ,$P(XMREC,U,3),XMDETAIL,.XMLEN)
"RTN","XMJMFC",97,0)
 Q:$Y>XMPMAX!'XMMORE
"RTN","XMJMFC",98,0)
 ; File screen ^DD(3.9,0,"SCR") insists that user be author or recipient.
"RTN","XMJMFC",99,0)
 ; If FLAGS["U", then file screen is ignored.
"RTN","XMJMFC",100,0)
 D LIST^DIC(3.9,"","@",XMFLAGS,XMPMAX-$Y+1,.XMFROM,"","C",XMSCREEN)
"RTN","XMJMFC",101,0)
 S:$P(^TMP("DILIST",$J,0),U,3)=0 XMMORE=0
"RTN","XMJMFC",102,0)
 D LISTMSG(XMDUZ,XMDETAIL,.XMCNT,.XMLEN,.XMMORE)
"RTN","XMJMFC",103,0)
 S XMKZ=XMCNT
"RTN","XMJMFC",104,0)
 K ^TMP("DILIST",$J)
"RTN","XMJMFC",105,0)
 W:'XMMORE !,$$EZBLD^DIALOG(34402) ; Search finished.
"RTN","XMJMFC",106,0)
 Q
"RTN","XMJMFC",107,0)
LISTMSG(XMDUZ,XMDETAIL,XMCNT,XMLEN,XMMORE) ; Check and List
"RTN","XMJMFC",108,0)
 N XMK,XMKN,XMZ,I,XMNA,XMSTOP,XMDATE
"RTN","XMJMFC",109,0)
 S I="",XMSTOP=0,XMNA=$$EZBLD^DIALOG(34014) ; * N/A *
"RTN","XMJMFC",110,0)
 I XMFLAGS["U" S XMK=0,XMKN=XMNA
"RTN","XMJMFC",111,0)
 F  S I=$O(^TMP("DILIST",$J,2,I),XMV("ORDER")) Q:I'>0  D  Q:XMSTOP
"RTN","XMJMFC",112,0)
 . S XMCNT=XMCNT+1
"RTN","XMJMFC",113,0)
 . S XMZ=^TMP("DILIST",$J,2,I)
"RTN","XMJMFC",114,0)
 . S XMDATE=+$G(^XMB(3.9,XMZ,.6))
"RTN","XMJMFC",115,0)
 . I XMDATE,XMDATE<XMSAVE("FDATE")!(XMDATE>XMSAVE("TDATE")) D  Q
"RTN","XMJMFC",116,0)
 . . S XMMORE=0,XMSTOP=1
"RTN","XMJMFC",117,0)
 . I XMFLAGS'["U" D
"RTN","XMJMFC",118,0)
 . . S XMK=+$O(^XMB(3.7,"M",XMZ,XMDUZ,0))
"RTN","XMJMFC",119,0)
 . . S XMKN=$S(XMK:$P(^XMB(3.7,XMDUZ,2,XMK,0),U),1:XMNA)
"RTN","XMJMFC",120,0)
 . . I XMK,'$D(^XMB(3.7,XMDUZ,2,XMK,1,XMZ,0)) D ADDITM^XMUT4A(XMDUZ,XMK,XMZ)
"RTN","XMJMFC",121,0)
 . D LISTMSG^XMJML(XMK,XMKN,XMCNT,XMZ,XMDETAIL,.XMLEN)
"RTN","XMJMFC",122,0)
 . S ^TMP("XM",$J,"MSG",XMCNT)=XMK_U_XMKN_U_XMZ
"RTN","XMJMFC",123,0)
 Q
"RTN","XMJMFC",124,0)
READMSG ; (XMDUZ,XMKZ,XMREC) <- needed!
"RTN","XMJMFC",125,0)
 N XMK,XMKN,XMZ,XMRDR  ; $G(XMRDR) is checked in READMSG^XMJBM
"RTN","XMJMFC",126,0)
 I XMFLAGS["U" D
"RTN","XMJMFC",127,0)
 . S XMK="!",XMKN=$$EZBLD^DIALOG(34014) ; * N/A *
"RTN","XMJMFC",128,0)
 E  D
"RTN","XMJMFC",129,0)
 . S XMK=$P(XMREC,U,1),XMKN=$P(XMREC,U,2)
"RTN","XMJMFC",130,0)
 S XMZ=$P(XMREC,U,3)
"RTN","XMJMFC",131,0)
 D READMSG^XMJBM(XMDUZ,XMK,XMKN,XMZ)
"RTN","XMJMFC",132,0)
 Q:XMFLAGS["U"
"RTN","XMJMFC",133,0)
 Q:$D(^XMB(3.7,"M",XMZ,XMDUZ,XMK))
"RTN","XMJMFC",134,0)
 S XMK=+$O(^XMB(3.7,"M",XMZ,XMDUZ,0))
"RTN","XMJMFC",135,0)
 S ^TMP("XM",$J,"MSG",XMKZ)=XMK_U_$S(XMK=0:$$EZBLD^DIALOG(34014),1:$P(^XMB(3.7,XMDUZ,2,XMK,0),U))_U_XMZ ; * N/A *
"RTN","XMJMFC",136,0)
 Q
"RTN","XMJML")
0^35^B38830599
"RTN","XMJML",1,0)
XMJML ;ISC-SF/GMB-List messages in basket (can't read) ;04/17/2002  10:03
"RTN","XMJML",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMJML",3,0)
 ; Replaces 1^XMAL0 (ISC-WASH/THM/CAP)
"RTN","XMJML",4,0)
LIST(XMDUZ,XMK,XMKN,XMKZ,XMDETAIL) ; List messages in one basket
"RTN","XMJML",5,0)
 ; (This routine does NOT let the user read the messages.)
"RTN","XMJML",6,0)
 ; XMDETAIL 0=Summary; 1=Detailed
"RTN","XMJML",7,0)
 N XMLEN,XMORDER,XMHDLINE,XMABORT
"RTN","XMJML",8,0)
 I XMDUZ=.5,XMK>999 S XMORDER=XMV("ORDER"),XMV("ORDER")=1
"RTN","XMJML",9,0)
 S XMABORT=0
"RTN","XMJML",10,0)
 D INIT(XMDUZ,XMK,XMKN,XMDETAIL,.XMLEN,1)
"RTN","XMJML",11,0)
 S XMHDLINE=$$HEADLINE(XMDUZ,XMK,XMKN)
"RTN","XMJML",12,0)
 D HEADER(XMDETAIL,.XMLEN,XMHDLINE)
"RTN","XMJML",13,0)
 S:XMKZ'="" XMKZ=XMKZ-XMV("ORDER")
"RTN","XMJML",14,0)
 F  S XMKZ=$O(^XMB(3.7,XMDUZ,2,XMK,1,"C",XMKZ),XMV("ORDER")) Q:XMKZ=""  D  Q:XMABORT
"RTN","XMJML",15,0)
 . S XMZ=$O(^XMB(3.7,XMDUZ,2,XMK,1,"C",XMKZ,""))
"RTN","XMJML",16,0)
 . I '$D(^XMB(3.7,XMDUZ,2,XMK,1,XMZ,0)) D ADDITC^XMUT4A(XMDUZ,XMK,XMZ,XMKZ)
"RTN","XMJML",17,0)
 . I '$D(^XMB(3.9,XMZ,0)) D ZAPIT^XMXMSGS2(XMDUZ,XMK,XMZ) Q
"RTN","XMJML",18,0)
 . I $Y+4>IOSL D PAGE^XMXUTIL(.XMABORT) Q:XMABORT  D
"RTN","XMJML",19,0)
 . . D HEADER(XMDETAIL,.XMLEN,XMHDLINE)
"RTN","XMJML",20,0)
 . D LISTMSG(XMK,XMKN,XMKZ,XMZ,XMDETAIL,.XMLEN)
"RTN","XMJML",21,0)
 I $D(XMORDER) S XMV("ORDER")=XMORDER
"RTN","XMJML",22,0)
 Q
"RTN","XMJML",23,0)
LISTNEW(XMDUZ,XMK,XMKN) ; List new messages in one basket
"RTN","XMJML",24,0)
 ; (This routine does NOT let the user read the messages.)
"RTN","XMJML",25,0)
 ; XMDETAIL 0=Summary; 1=Detailed
"RTN","XMJML",26,0)
 I '$O(^XMB(3.7,XMDUZ,"N0",XMK,0)) D  Q
"RTN","XMJML",27,0)
 . I $P(^XMB(3.7,XMDUZ,2,XMK,0),U,2) S $P(^(0),U,2)=0
"RTN","XMJML",28,0)
 . W !!,$C(7),$$EZBLD^DIALOG(34013),! ;No NEW messages
"RTN","XMJML",29,0)
 N XMKZ,XMZ,XMLEN,XMDETAIL,XMTYPE,XMHDLINE,XMABORT
"RTN","XMJML",30,0)
 S XMDETAIL=1,XMTYPE="N0",XMABORT=0
"RTN","XMJML",31,0)
 D INIT(XMDUZ,XMK,XMKN,XMDETAIL,.XMLEN,1)
"RTN","XMJML",32,0)
 S XMHDLINE=$$HEADLINE^XMJMLN(XMDUZ,0,XMK,XMKN,XMTYPE)
"RTN","XMJML",33,0)
 D HEADER(XMDETAIL,.XMLEN,XMHDLINE)
"RTN","XMJML",34,0)
 S XMZ=""
"RTN","XMJML",35,0)
 F  S XMZ=$O(^XMB(3.7,XMDUZ,XMTYPE,XMK,XMZ),XMV("ORDER")) Q:XMZ=""  D  Q:XMABORT
"RTN","XMJML",36,0)
 . S XMKZ=$P($G(^XMB(3.7,XMDUZ,2,XMK,1,XMZ,0)),U,2)
"RTN","XMJML",37,0)
 . I 'XMKZ D
"RTN","XMJML",38,0)
 . . D ADDITN^XMUT4A(XMDUZ,XMTYPE,XMK,XMZ)
"RTN","XMJML",39,0)
 . . S XMKZ=$P($G(^XMB(3.7,XMDUZ,2,XMK,1,XMZ,0)),U,2)
"RTN","XMJML",40,0)
 . I '$D(^XMB(3.9,XMZ,0)) D ZAPIT^XMXMSGS2(XMDUZ,XMK,XMZ) Q
"RTN","XMJML",41,0)
 . I $Y+4>IOSL D PAGE^XMXUTIL(.XMABORT) Q:XMABORT  D
"RTN","XMJML",42,0)
 . . D HEADER(XMDETAIL,.XMLEN,XMHDLINE)
"RTN","XMJML",43,0)
 . D LISTMSG(XMK,XMKN,XMKZ,XMZ,XMDETAIL,.XMLEN)
"RTN","XMJML",44,0)
 Q
"RTN","XMJML",45,0)
LISTPRI(XMDUZ) ; List priority messages in all baskets (Replaces PRIO^XMAL0)
"RTN","XMJML",46,0)
 ; (This routine does NOT let the user read the messages.)
"RTN","XMJML",47,0)
 ; XMDETAIL 0=Summary; 1=Detailed
"RTN","XMJML",48,0)
 N XMK,XMKN,XMKZ,XMZ,XMLEN,XMDETAIL,XMTYPE,XMHDLINE,XMABORT
"RTN","XMJML",49,0)
 S XMDETAIL=1,XMTYPE="N",XMABORT=0
"RTN","XMJML",50,0)
 D INIT^XMJMLN(XMDUZ,XMTYPE,XMDETAIL,1,.XMLEN)
"RTN","XMJML",51,0)
 S XMHDLINE=$$HEADLINE^XMJMLN(XMDUZ,1,"","",XMTYPE)
"RTN","XMJML",52,0)
 D HEADER(XMDETAIL,.XMLEN,XMHDLINE)
"RTN","XMJML",53,0)
 S XMK=""
"RTN","XMJML",54,0)
 F  S XMK=$O(^XMB(3.7,XMDUZ,XMTYPE,XMK)) Q:XMK=""  D  Q:XMABORT
"RTN","XMJML",55,0)
 . S XMZ="",XMKN=$P(^XMB(3.7,XMDUZ,2,XMK,0),U,1)
"RTN","XMJML",56,0)
 . F  S XMZ=$O(^XMB(3.7,XMDUZ,XMTYPE,XMK,XMZ),XMV("ORDER")) Q:XMZ=""  D  Q:XMABORT
"RTN","XMJML",57,0)
 . . S XMKZ=$P($G(^XMB(3.7,XMDUZ,2,XMK,1,XMZ,0)),U,2)
"RTN","XMJML",58,0)
 . . I 'XMKZ D
"RTN","XMJML",59,0)
 . . . D ADDITN^XMUT4A(XMDUZ,XMTYPE,XMK,XMZ)
"RTN","XMJML",60,0)
 . . . S XMKZ=$P($G(^XMB(3.7,XMDUZ,2,XMK,1,XMZ,0)),U,2)
"RTN","XMJML",61,0)
 . . I '$D(^XMB(3.9,XMZ,0)) D ZAPIT^XMXMSGS2(XMDUZ,XMK,XMZ) Q
"RTN","XMJML",62,0)
 . . I $Y+4>IOSL D PAGE^XMXUTIL(.XMABORT) Q:XMABORT  D
"RTN","XMJML",63,0)
 . . . D HEADER(XMDETAIL,.XMLEN,XMHDLINE)
"RTN","XMJML",64,0)
 . . D LISTMSG(XMK,XMKN,XMKZ,XMZ,XMDETAIL,.XMLEN)
"RTN","XMJML",65,0)
 Q
"RTN","XMJML",66,0)
INIT(XMDUZ,XMK,XMKN,XMDETAIL,XMLEN,XMONE) ;
"RTN","XMJML",67,0)
 N XMLEFT
"RTN","XMJML",68,0)
 S XMLEFT=79
"RTN","XMJML",69,0)
 I XMDETAIL D
"RTN","XMJML",70,0)
 . S XMLEN("XMZ")=$L($O(^XMB(3.9,":"),-1))+2
"RTN","XMJML",71,0)
 . ;S XMLEN("XMZ")=$L($O(^XMB(3.7,XMDUZ,2,XMK,1,":"),-1))+2
"RTN","XMJML",72,0)
 . S XMLEN("LINE")=5
"RTN","XMJML",73,0)
 . I '$G(XMONE),'$D(XMLEN("BSKT")) S XMLEN("BSKT")=$$MIN^XLFMTH($L(XMKN),10)
"RTN","XMJML",74,0)
 . S XMLEN("RESP")=9
"RTN","XMJML",75,0)
 . S XMLEN("DATE")=$L($$MMDT^XMXUTIL1(DT))
"RTN","XMJML",76,0)
 . S XMLEFT=XMLEFT-XMLEN("XMZ")-XMLEN("LINE")-$G(XMLEN("BSKT"))-XMLEN("RESP")-XMLEN("DATE")-3+$S($G(XMLEN("BSKT")):0,1:1)
"RTN","XMJML",77,0)
 S:'$D(XMLEN("XMKZ")) XMLEN("XMKZ")=$L($O(^XMB(3.7,XMDUZ,2,XMK,1,"C",""),-1))
"RTN","XMJML",78,0)
 S XMLEFT=XMLEFT-XMLEN("XMKZ")-5
"RTN","XMJML",79,0)
 S XMLEN("SUBJ")=XMLEFT*2\3
"RTN","XMJML",80,0)
 S XMLEN("FROM")=XMLEFT-XMLEN("SUBJ")
"RTN","XMJML",81,0)
 Q
"RTN","XMJML",82,0)
LISTMSG(XMK,XMKN,XMKZ,XMZ,XMDETAIL,XMLEN) ;
"RTN","XMJML",83,0)
 N XMZREC
"RTN","XMJML",84,0)
 S XMZREC=$G(^XMB(3.9,XMZ,0))
"RTN","XMJML",85,0)
 I XMDUZ=.5,XMK>999 D
"RTN","XMJML",86,0)
 . N XMTPRI ; Transmit priority
"RTN","XMJML",87,0)
 . S XMTPRI=$P($G(^XMB(3.7,.5,2,XMK,1,XMZ,0)),U,6)
"RTN","XMJML",88,0)
 . W !,$S($D(^TMP("XM",$J,".",XMKZ)):">",1:" "),$S('XMTPRI:" ",XMTPRI=1:"^",1:"v"),$J(XMKZ,XMLEN("XMKZ")),". "
"RTN","XMJML",89,0)
 E  W !,$S($D(^TMP("XM",$J,".",XMKZ)):">",1:" "),$S('$D(^XMB(3.7,XMDUZ,"N0",XMK,XMZ)):" ",$P(XMZREC,U,7)["P":"!",1:"*"),$J(XMKZ,XMLEN("XMKZ")),". "
"RTN","XMJML",90,0)
 I XMDETAIL D
"RTN","XMJML",91,0)
 . W:$D(XMLEN("BSKT")) $$LJ^XLFSTR($E(XMKN,1,XMLEN("BSKT")),XMLEN("BSKT"))," "
"RTN","XMJML",92,0)
 . W $J("["_XMZ_"]",XMLEN("XMZ"))," ",$$DATE^XMXUTIL2(XMZREC,0)
"RTN","XMJML",93,0)
 . W " ",$$MELD^XMXUTIL1($$SUBJ^XMXUTIL2(XMZREC),$$LINES(XMZ),XMLEN("SUBJ")+XMLEN("LINE"))
"RTN","XMJML",94,0)
 . W " ",$$MELD^XMXUTIL1($$NAME^XMXUTIL($P(XMZREC,U,2)),$$RESPONSE(XMDUZ,XMK,XMZ),XMLEN("FROM")+9)
"RTN","XMJML",95,0)
 E  D
"RTN","XMJML",96,0)
 . W $$LJ^XLFSTR($E($$SUBJ^XMXUTIL2(XMZREC),1,XMLEN("SUBJ")),XMLEN("SUBJ"))," ",$E($$NAME^XMXUTIL($P(XMZREC,U,2)),1,XMLEN("FROM"))
"RTN","XMJML",97,0)
 Q
"RTN","XMJML",98,0)
HEADLINE(XMDUZ,XMK,XMKN) ;
"RTN","XMJML",99,0)
 N XMNEWCNT,XMCNT
"RTN","XMJML",100,0)
 S XMNEWCNT=$P(^XMB(3.7,XMDUZ,2,XMK,0),U,2)
"RTN","XMJML",101,0)
 S XMCNT=$P(^XMB(3.7,XMDUZ,2,XMK,1,0),U,4)
"RTN","XMJML",102,0)
 ;Basket / messages / message / new
"RTN","XMJML",103,0)
 Q XMKN_" "_$$EZBLD^DIALOG(34011)_", "_XMCNT_$S(XMCNT>1:$$EZBLD^DIALOG(34007.1)_" ("_$O(^XMB(3.7,XMDUZ,2,XMK,1,"C",0))_"-"_$O(^(""),-1)_")",1:$$EZBLD^DIALOG(34007))_$S(XMNEWCNT:", "_XMNEWCNT_$$EZBLD^DIALOG(34008),1:"")
"RTN","XMJML",104,0)
HEADER(XMDETAIL,XMLEN,XMHDLINE) ;
"RTN","XMJML",105,0)
 I $D(XMHDLINE) W @IOF,XMHDLINE,!
"RTN","XMJML",106,0)
 E  W @IOF
"RTN","XMJML",107,0)
 I XMDETAIL D
"RTN","XMJML",108,0)
 . W $$LJ^XLFSTR($$EZBLD^DIALOG(34001),XMLEN("XMZ")+$G(XMLEN("BSKT"),-1)+XMLEN("XMKZ")+XMLEN("DATE")+7,".") ;*=New/!=Priority
"RTN","XMJML",109,0)
 . W $$COMBO($$EZBLD^DIALOG(34002),$$EZBLD^DIALOG(34003.1),XMLEN("SUBJ")+XMLEN("LINE")) ;Subject / Lines
"RTN","XMJML",110,0)
 . W "."
"RTN","XMJML",111,0)
 . W $$COMBO($$EZBLD^DIALOG(34006),$$EZBLD^DIALOG(34004),XMLEN("FROM")+XMLEN("RESP")) ;From / Read/Rcvd
"RTN","XMJML",112,0)
 E  D
"RTN","XMJML",113,0)
 . W $$LJ^XLFSTR($$EZBLD^DIALOG(34005),79-XMLEN("FROM"),"."),$$LJ^XLFSTR($$EZBLD^DIALOG(34006),XMLEN("FROM"),".") ;*=New/!=Priority.......Subject / From
"RTN","XMJML",114,0)
 Q
"RTN","XMJML",115,0)
COMBO(XMSTR1,XMSTR2,XMLEN) ;
"RTN","XMJML",116,0)
 Q $$LJ^XLFSTR($E(XMSTR1,1,XMLEN-$L(XMSTR2)-1),XMLEN-$L(XMSTR2),".")_XMSTR2
"RTN","XMJML",117,0)
LINES(XMZ) ;
"RTN","XMJML",118,0)
 Q +$P($G(^XMB(3.9,XMZ,2,0)),U,4)
"RTN","XMJML",119,0)
RESPONSE(XMDUZ,XMK,XMZ) ;
"RTN","XMJML",120,0)
 I XMDUZ=.5,XMK>999 Q ""
"RTN","XMJML",121,0)
 N XMPTR,XMRESP,XMRESPS
"RTN","XMJML",122,0)
 S XMRESPS=+$P($G(^XMB(3.9,XMZ,3,0)),U,4)
"RTN","XMJML",123,0)
 I XMRESPS=0 Q ""
"RTN","XMJML",124,0)
 ;S XMPTR=$O(^XMB(3.9,XMZ,1,"C",$S(XMDUZ=.6:DUZ,1:XMDUZ),0))
"RTN","XMJML",125,0)
 S XMPTR=+$O(^XMB(3.9,XMZ,1,"C",XMDUZ,0))
"RTN","XMJML",126,0)
 S XMRESP=+$P($G(^XMB(3.9,XMZ,1,XMPTR,0)),U,2)
"RTN","XMJML",127,0)
 Q XMRESP_"/"_XMRESPS
"RTN","XMJML",128,0)
LISTTMP ; List messages in ^TMP global
"RTN","XMJML",129,0)
 ; (This routine does NOT let the user read the messages.)
"RTN","XMJML",130,0)
 ; The following variables are expected to exist:
"RTN","XMJML",131,0)
 ; XMDETAIL 0=Summary; 1=Detailed
"RTN","XMJML",132,0)
 ; XMLEN
"RTN","XMJML",133,0)
 N XMK,XMKN,XMKZ,XMZ,XMABORT,XMREC
"RTN","XMJML",134,0)
 S XMABORT=0
"RTN","XMJML",135,0)
 D HEADER(XMDETAIL,.XMLEN)
"RTN","XMJML",136,0)
 S XMKZ=0
"RTN","XMJML",137,0)
 F  S XMKZ=$O(^TMP("XM",$J,"MSG",XMKZ)) Q:XMKZ=""  D  Q:XMABORT
"RTN","XMJML",138,0)
 . I $Y+4>IOSL D PAGE^XMXUTIL(.XMABORT) Q:XMABORT  D
"RTN","XMJML",139,0)
 . . D HEADER(XMDETAIL,.XMLEN)
"RTN","XMJML",140,0)
 . S XMREC=^TMP("XM",$J,"MSG",XMKZ)
"RTN","XMJML",141,0)
 . S XMK=$P(XMREC,U,1),XMKN=$P(XMREC,U,2),XMZ=$P(XMREC,U,3)
"RTN","XMJML",142,0)
 . D LISTMSG(XMK,XMKN,XMKZ,XMZ,XMDETAIL,.XMLEN)
"RTN","XMJML",143,0)
 Q
"RTN","XMJMLN")
0^292^B61825279
"RTN","XMJMLN",1,0)
XMJMLN ;ISC-SF/GB-List/Read new messages ;12/12/2001  08:53
"RTN","XMJMLN",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMJMLN",3,0)
 ; Replaces LIST,PRIO^XMA0A (ISC-WASH/CAP)
"RTN","XMJMLN",4,0)
LISTONE(XMDUZ,XMK,XMKN,XMTYPE) ; List new/priority messages in one basket
"RTN","XMJMLN",5,0)
 ; XMTYPE   N0=New; N=Priority
"RTN","XMJMLN",6,0)
 N XMKZ,XMZ,XMCNT,XMABORT,XMLEN,XMFIRST,XMPAGE,XMDETAIL,XMPMAX,XMKALL,XMIA,XMZOOM,XMMORE,XMCD,XMOPT,XMOX
"RTN","XMJMLN",7,0)
 S XMIA=1 ; Interactive
"RTN","XMJMLN",8,0)
 I '$D(^XMB(3.7,XMDUZ,XMTYPE,XMK)) D  Q
"RTN","XMJMLN",9,0)
 . W !!,$$EZBLD^DIALOG($S(XMTYPE="N":34016,1:34015)) ; You have no new (priority) messages in this basket.
"RTN","XMJMLN",10,0)
 K ^TMP("XM",$J,"MSG"),^TMP("XM",$J,".")
"RTN","XMJMLN",11,0)
 S (XMKZ,XMZ)="",(XMPAGE,XMCNT,XMKALL,XMZOOM,XMCD,XMABORT)=0,(XMDETAIL,XMMORE)=1
"RTN","XMJMLN",12,0)
 S XMPMAX=IOSL-3
"RTN","XMJMLN",13,0)
 D SETOPT^XMJMLR1(XMDUZ,0,.XMOPT,.XMOX)
"RTN","XMJMLN",14,0)
 S XMLEN("XMKZ")=$L($P(^XMB(3.7,XMDUZ,2,XMK,0),U,2))
"RTN","XMJMLN",15,0)
 D INIT^XMJML(XMDUZ,XMK,XMKN,XMDETAIL,.XMLEN,1)
"RTN","XMJMLN",16,0)
 F  D  Q:XMABORT
"RTN","XMJMLN",17,0)
 . I XMCD S XMCD=0,XMDETAIL='XMDETAIL D INIT^XMJML(XMDUZ,XMK,XMKN,XMDETAIL,.XMLEN,1)
"RTN","XMJMLN",18,0)
 . D DISPLAY(XMDUZ,XMKALL,XMTYPE,XMDETAIL,XMK,XMKN,.XMKZ,.XMZ,.XMCNT,.XMFIRST,.XMPAGE,.XMMORE,.XMLEN,XMZOOM,XMPMAX)
"RTN","XMJMLN",19,0)
 . D CHOOSE(XMDUZ,XMKALL,XMK,.XMKZ,.XMFIRST,.XMPAGE,XMMORE,.XMLEN,.XMZOOM,.XMOPT,.XMOX,"READMSG",.XMABORT)
"RTN","XMJMLN",20,0)
 . S:'$D(^XMB(3.7,XMDUZ,XMTYPE,XMK)) XMABORT=1
"RTN","XMJMLN",21,0)
 K ^TMP("XM",$J,"MSG"),^TMP("XM",$J,".")
"RTN","XMJMLN",22,0)
 Q
"RTN","XMJMLN",23,0)
LISTALL(XMDUZ,XMTYPE) ; List new/priority messages in all baskets
"RTN","XMJMLN",24,0)
 ; XMTYPE   N0=New; N=Priority
"RTN","XMJMLN",25,0)
 N XMK,XMKZ,XMZ,XMCNT,XMABORT,XMLEN,XMFIRST,XMPAGE,XMDETAIL,XMPMAX,XMKALL,XMIA,XMZOOM,XMMORE,XMCD,XMOPT,XMOX
"RTN","XMJMLN",26,0)
 S XMIA=1 ; Interactive
"RTN","XMJMLN",27,0)
 I '$D(^XMB(3.7,XMDUZ,XMTYPE)) D  Q
"RTN","XMJMLN",28,0)
 . W !!,$$EZBLD^DIALOG($S(XMTYPE="N":34018,1:34017)) ; You have no new (priority) messages.
"RTN","XMJMLN",29,0)
 K ^TMP("XM",$J,"MSG"),^TMP("XM",$J,".")
"RTN","XMJMLN",30,0)
 S (XMKZ,XMZ)="",(XMPAGE,XMCNT,XMZOOM,XMCD,XMABORT)=0,(XMK,XMDETAIL,XMMORE,XMKALL)=1
"RTN","XMJMLN",31,0)
 S XMPMAX=IOSL-3
"RTN","XMJMLN",32,0)
 D SETOPT^XMJMLR1(XMDUZ,0,.XMOPT,.XMOX)
"RTN","XMJMLN",33,0)
 D INIT(XMDUZ,XMTYPE,XMDETAIL,0,.XMLEN)
"RTN","XMJMLN",34,0)
 F  D  Q:XMABORT
"RTN","XMJMLN",35,0)
 . I XMCD S XMCD=0,XMDETAIL='XMDETAIL D INIT(XMDUZ,XMTYPE,XMDETAIL,0,.XMLEN)
"RTN","XMJMLN",36,0)
 . D DISPLAY(XMDUZ,XMKALL,XMTYPE,XMDETAIL,.XMK,"",.XMKZ,.XMZ,.XMCNT,.XMFIRST,.XMPAGE,.XMMORE,.XMLEN,XMZOOM,XMPMAX)
"RTN","XMJMLN",37,0)
 . D CHOOSE(XMDUZ,XMKALL,0,.XMKZ,.XMFIRST,.XMPAGE,XMMORE,.XMLEN,.XMZOOM,.XMOPT,.XMOX,"READMSG",.XMABORT)
"RTN","XMJMLN",38,0)
 . S:'$D(^XMB(3.7,XMDUZ,XMTYPE)) XMABORT=1
"RTN","XMJMLN",39,0)
 K ^TMP("XM",$J,"MSG"),^TMP("XM",$J,".")
"RTN","XMJMLN",40,0)
 Q
"RTN","XMJMLN",41,0)
INIT(XMDUZ,XMTYPE,XMDETAIL,XMACTUAL,XMLEN) ;
"RTN","XMJMLN",42,0)
 ; XMACTUAL 1/0=do/do not use actual XMKZ
"RTN","XMJMLN",43,0)
 N XMK,XMKN,XMKNMAX,XMKZL
"RTN","XMJMLN",44,0)
 S XMLEN("XMKZ")=$S(XMACTUAL:0,1:$L($P(^XMB(3.7,XMDUZ,0),U,6)))
"RTN","XMJMLN",45,0)
 S XMK=0,XMKNMAX=""
"RTN","XMJMLN",46,0)
 F  S XMK=$O(^XMB(3.7,XMDUZ,XMTYPE,XMK)) Q:XMK=""  D
"RTN","XMJMLN",47,0)
 . S XMKN=$P(^XMB(3.7,XMDUZ,2,XMK,0),U,1)
"RTN","XMJMLN",48,0)
 . S:$L(XMKN)>$L(XMKNMAX) XMKNMAX=XMKN
"RTN","XMJMLN",49,0)
 . Q:'XMACTUAL
"RTN","XMJMLN",50,0)
 . S XMKZL=$L($O(^XMB(3.7,XMDUZ,2,XMK,1,"C",""),-1))
"RTN","XMJMLN",51,0)
 . S:XMKZL>XMLEN("XMKZ") XMLEN("XMKZ")=XMKZL
"RTN","XMJMLN",52,0)
 D INIT^XMJML(XMDUZ,"",XMKNMAX,XMDETAIL,.XMLEN)
"RTN","XMJMLN",53,0)
 Q
"RTN","XMJMLN",54,0)
DISPLAY(XMDUZ,XMKALL,XMTYPE,XMDETAIL,XMK,XMKN,XMKZ,XMZ,XMCNT,XMFIRST,XMPAGE,XMMORE,XMLEN,XMZOOM,XMPMAX) ;
"RTN","XMJMLN",55,0)
 N XMREC,XMHDLINE
"RTN","XMJMLN",56,0)
 S XMFIRST(XMPAGE)=XMKZ
"RTN","XMJMLN",57,0)
 S XMHDLINE=$$HEADLINE(XMDUZ,XMKALL,XMK,XMKN,XMTYPE)
"RTN","XMJMLN",58,0)
 D HEADER^XMJML(XMDETAIL,.XMLEN,XMHDLINE)
"RTN","XMJMLN",59,0)
 I XMZOOM D  Q
"RTN","XMJMLN",60,0)
 . F  S XMKZ=$O(^TMP("XM",$J,".",XMKZ)) Q:XMKZ=""  D  Q:$Y>XMPMAX
"RTN","XMJMLN",61,0)
 . . S XMREC=^TMP("XM",$J,"MSG",XMKZ)
"RTN","XMJMLN",62,0)
 . . D LISTMSG^XMJML($P(XMREC,U,1),$P(XMREC,U,2),XMKZ,$P(XMREC,U,3),XMDETAIL,.XMLEN)
"RTN","XMJMLN",63,0)
 F  S XMKZ=$O(^TMP("XM",$J,"MSG",XMKZ)) Q:XMKZ=""  D  Q:$Y>XMPMAX
"RTN","XMJMLN",64,0)
 . S XMREC=^TMP("XM",$J,"MSG",XMKZ)
"RTN","XMJMLN",65,0)
 . D LISTMSG^XMJML($P(XMREC,U,1),$P(XMREC,U,2),XMKZ,$P(XMREC,U,3),XMDETAIL,.XMLEN)
"RTN","XMJMLN",66,0)
 Q:$Y>XMPMAX!'XMMORE
"RTN","XMJMLN",67,0)
 I XMKALL D
"RTN","XMJMLN",68,0)
 . S XMK=XMK-.01
"RTN","XMJMLN",69,0)
 . F  S XMK=$O(^XMB(3.7,XMDUZ,XMTYPE,XMK)) Q:XMK=""  D  Q:$Y>XMPMAX
"RTN","XMJMLN",70,0)
 . . S XMKN=$P(^XMB(3.7,XMDUZ,2,XMK,0),U)
"RTN","XMJMLN",71,0)
 . . D LISTBSKT(XMDUZ,XMTYPE,XMDETAIL,XMK,XMKN,.XMZ,.XMCNT,.XMLEN,XMPMAX)
"RTN","XMJMLN",72,0)
 . S XMMORE=$S('XMK:0,$O(^XMB(3.7,XMDUZ,XMTYPE,XMK)):1,XMZ="":0,$O(^XMB(3.7,XMDUZ,XMTYPE,XMK,XMZ),XMV("ORDER")):1,1:0)
"RTN","XMJMLN",73,0)
 E  D
"RTN","XMJMLN",74,0)
 . D LISTBSKT(XMDUZ,XMTYPE,XMDETAIL,XMK,XMKN,.XMZ,.XMCNT,.XMLEN,XMPMAX)
"RTN","XMJMLN",75,0)
 . S XMMORE=$S(XMZ="":0,$O(^XMB(3.7,XMDUZ,XMTYPE,XMK,XMZ),XMV("ORDER")):1,1:0)
"RTN","XMJMLN",76,0)
 S XMKZ=XMCNT
"RTN","XMJMLN",77,0)
 Q
"RTN","XMJMLN",78,0)
HEADLINE(XMDUZ,XMKALL,XMK,XMKN,XMTYPE) ;
"RTN","XMJMLN",79,0)
 N XMDIALOG,XMPARM
"RTN","XMJMLN",80,0)
 I XMTYPE="N0" D
"RTN","XMJMLN",81,0)
 . I XMKALL S XMDIALOG=34022,XMPARM(1)=$P(^XMB(3.7,XMDUZ,0),U,6) Q
"RTN","XMJMLN",82,0)
 . S XMDIALOG=34024,XMPARM(1)=$P(^XMB(3.7,XMDUZ,2,XMK,0),U,2),XMPARM(3)=XMKN
"RTN","XMJMLN",83,0)
 E  D
"RTN","XMJMLN",84,0)
 . I XMKALL S XMDIALOG=34023,XMPARM(2)=$$TPMSGCT^XMXUTIL(XMDUZ) Q
"RTN","XMJMLN",85,0)
 . S XMDIALOG=34024,XMPARM(2)=$$BPMSGCT^XMXUTIL(XMDUZ,XMK),XMPARM(3)=XMKN
"RTN","XMJMLN",86,0)
 Q $$EZBLD^DIALOG(XMDIALOG,.XMPARM)
"RTN","XMJMLN",87,0)
LISTBSKT(XMDUZ,XMTYPE,XMDETAIL,XMK,XMKN,XMZ,XMCNT,XMLEN,XMPMAX) ;
"RTN","XMJMLN",88,0)
 F  S XMZ=$O(^XMB(3.7,XMDUZ,XMTYPE,XMK,XMZ),XMV("ORDER")) Q:XMZ=""  D  Q:$Y>XMPMAX
"RTN","XMJMLN",89,0)
 . I '$D(^XMB(3.7,XMDUZ,2,XMK,1,XMZ,0)) D ADDITN^XMUT4A(XMDUZ,XMTYPE,XMK,XMZ)
"RTN","XMJMLN",90,0)
 . I '$D(^XMB(3.9,XMZ,0)) D ZAPIT^XMXMSGS2(XMDUZ,XMK,XMZ) Q
"RTN","XMJMLN",91,0)
 . S XMCNT=XMCNT+1
"RTN","XMJMLN",92,0)
 . S ^TMP("XM",$J,"MSG",XMCNT)=XMK_U_XMKN_U_XMZ
"RTN","XMJMLN",93,0)
 . D LISTMSG^XMJML(XMK,XMKN,XMCNT,XMZ,XMDETAIL,.XMLEN)
"RTN","XMJMLN",94,0)
 Q
"RTN","XMJMLN",95,0)
CHOOSE(XMDUZ,XMKALL,XMK,XMKZ,XMFIRST,XMPAGE,XMMORE,XMLEN,XMZOOM,XMOPT,XMOX,XMREAD,XMABORT) ;
"RTN","XMJMLN",96,0)
 N XMY,XMHI,XMLO
"RTN","XMJMLN",97,0)
 I XMZOOM D
"RTN","XMJMLN",98,0)
 . S XMMORE=$S(XMKZ="":0,1:1)
"RTN","XMJMLN",99,0)
 E  I $O(XMFIRST(XMPAGE)),XMKZ,$O(^TMP("XM",$J,"MSG",XMKZ)) D
"RTN","XMJMLN",100,0)
 . S XMMORE=1
"RTN","XMJMLN",101,0)
 . S XMFIRST(XMPAGE+1)=XMKZ
"RTN","XMJMLN",102,0)
 S XMLO=$O(^TMP("XM",$J,"MSG",""))
"RTN","XMJMLN",103,0)
 S XMHI=$O(^TMP("XM",$J,"MSG",""),-1)
"RTN","XMJMLN",104,0)
 D XMDIR^XMJMLR1(XMDUZ,XMLO,XMHI,XMPAGE,XMMORE,"XM-U-BO-FULL SCREEN LIST","",.XMOPT,.XMOX,.XMY,.XMABORT) Q:XMABORT
"RTN","XMJMLN",105,0)
 I '$D(XMY) S XMKZ=XMFIRST(XMPAGE) Q
"RTN","XMJMLN",106,0)
 I XMY=""!($E(XMY)="+") D  Q  ; Next page
"RTN","XMJMLN",107,0)
 . I XMMORE S XMPAGE=XMPAGE+1 Q
"RTN","XMJMLN",108,0)
 . I XMPAGE=0 S XMABORT=1 Q
"RTN","XMJMLN",109,0)
 . D AGAIN^XMJMLR(.XMABORT) Q:XMABORT
"RTN","XMJMLN",110,0)
 . S XMPAGE=0
"RTN","XMJMLN",111,0)
 . S XMKZ=XMFIRST(XMPAGE)
"RTN","XMJMLN",112,0)
 I $E(XMY)="." D  Q  ; (De)Select messages
"RTN","XMJMLN",113,0)
 . D DODOT
"RTN","XMJMLN",114,0)
 . I XMZOOM,'$D(^TMP("XM",$J,".")) D Z
"RTN","XMJMLN",115,0)
 . S XMKZ=XMFIRST(XMPAGE)
"RTN","XMJMLN",116,0)
 I XMY>0 D  Q
"RTN","XMJMLN",117,0)
 . N XMREC
"RTN","XMJMLN",118,0)
 . S XMREC=$G(^TMP("XM",$J,"MSG",XMY))
"RTN","XMJMLN",119,0)
 . I XMREC="" D
"RTN","XMJMLN",120,0)
 . . W $C(7)
"RTN","XMJMLN",121,0)
 . E  D
"RTN","XMJMLN",122,0)
 . . N XMKZ
"RTN","XMJMLN",123,0)
 . . S XMKZ=XMY
"RTN","XMJMLN",124,0)
 . . D @XMREAD
"RTN","XMJMLN",125,0)
 . . I XMZOOM,'$D(^TMP("XM",$J,".")) D Z
"RTN","XMJMLN",126,0)
 . S XMKZ=XMFIRST(XMPAGE)
"RTN","XMJMLN",127,0)
 I XMY=0 D  Q  ; First page
"RTN","XMJMLN",128,0)
 . S XMPAGE=0
"RTN","XMJMLN",129,0)
 . S XMKZ=XMFIRST(XMPAGE)
"RTN","XMJMLN",130,0)
 I $E(XMY)="-" D  Q  ; Previous page
"RTN","XMJMLN",131,0)
 . S:XMPAGE>0 XMPAGE=XMPAGE-1
"RTN","XMJMLN",132,0)
 . S XMKZ=XMFIRST(XMPAGE)
"RTN","XMJMLN",133,0)
 D @XMY
"RTN","XMJMLN",134,0)
 S XMKZ=XMFIRST(XMPAGE)
"RTN","XMJMLN",135,0)
 Q
"RTN","XMJMLN",136,0)
READMSG ; (XMDUZ,XMKZ,XMREC,XMTYPE) <- needed!
"RTN","XMJMLN",137,0)
 N XMK,XMKN,XMZ
"RTN","XMJMLN",138,0)
 S XMK=$P(XMREC,U,1),XMKN=$P(XMREC,U,2),XMZ=$P(XMREC,U,3)
"RTN","XMJMLN",139,0)
 I XMDUZ'=DUZ,'$$SURRACC^XMXSEC(XMDUZ,"",XMZ,$G(^XMB(3.9,XMZ,0))) D  Q  ; "read"
"RTN","XMJMLN",140,0)
 . D SHOW^XMJERR
"RTN","XMJMLN",141,0)
 . D WAIT^XMXUTIL
"RTN","XMJMLN",142,0)
 D READNEW^XMJBN(XMDUZ,XMK,XMKN,XMZ)
"RTN","XMJMLN",143,0)
 Q:$D(^XMB(3.7,XMDUZ,XMTYPE,XMK,XMZ))
"RTN","XMJMLN",144,0)
 K ^TMP("XM",$J,"MSG",XMKZ)
"RTN","XMJMLN",145,0)
 K:$D(^TMP("XM",$J,".",XMKZ)) ^TMP("XM",$J,".",XMKZ)
"RTN","XMJMLN",146,0)
 Q
"RTN","XMJMLN",147,0)
DODOT ;
"RTN","XMJMLN",148,0)
 N I,XMSTRIKE,XM1,XMN,XMKZ
"RTN","XMJMLN",149,0)
 I $E(XMY,2)="-" S XMSTRIKE=1,XMY=$E(XMY,3,999)
"RTN","XMJMLN",150,0)
 E  S XMSTRIKE=0,XMY=$E(XMY,2,999)
"RTN","XMJMLN",151,0)
 I XMY="*" D  Q
"RTN","XMJMLN",152,0)
 . I XMSTRIKE K ^TMP("XM",$J,".") Q
"RTN","XMJMLN",153,0)
 . S XMKZ=""
"RTN","XMJMLN",154,0)
 . F  S XMKZ=$O(^TMP("XM",$J,"MSG",XMKZ)) Q:'XMKZ  S ^TMP("XM",$J,".",XMKZ)=""
"RTN","XMJMLN",155,0)
 F I=1:1:$L(XMY,",") D
"RTN","XMJMLN",156,0)
 . S XMKZ=$P(XMY,",",I)
"RTN","XMJMLN",157,0)
 . I XMKZ["-" D  Q
"RTN","XMJMLN",158,0)
 . . S XM1=$P(XMKZ,"-")
"RTN","XMJMLN",159,0)
 . . S XMN=$P(XMKZ,"-",2) S:XMN="" XMN=XMHI
"RTN","XMJMLN",160,0)
 . . S XMKZ=XM1-.1
"RTN","XMJMLN",161,0)
 . . I 'XMSTRIKE D  Q
"RTN","XMJMLN",162,0)
 . . . F  S XMKZ=$O(^TMP("XM",$J,"MSG",XMKZ)) Q:XMKZ>XMN!'XMKZ  D
"RTN","XMJMLN",163,0)
 . . . . S:'$D(^TMP("XM",$J,".",XMKZ)) ^TMP("XM",$J,".",XMKZ)=""
"RTN","XMJMLN",164,0)
 . . F  S XMKZ=$O(^TMP("XM",$J,".",XMKZ)) Q:XMKZ>XMN!'XMKZ  K ^TMP("XM",$J,".",XMKZ)
"RTN","XMJMLN",165,0)
 . I 'XMSTRIKE D  Q
"RTN","XMJMLN",166,0)
 . . I $D(^TMP("XM",$J,"MSG",XMKZ)),'$D(^TMP("XM",$J,".",XMKZ)) S ^TMP("XM",$J,".",XMKZ)=""
"RTN","XMJMLN",167,0)
 . I $D(^TMP("XM",$J,".",XMKZ)) K ^TMP("XM",$J,".",XMKZ)
"RTN","XMJMLN",168,0)
 Q
"RTN","XMJMLN",169,0)
CD ; Change Detail
"RTN","XMJMLN",170,0)
 S XMCD=1
"RTN","XMJMLN",171,0)
 Q
"RTN","XMJMLN",172,0)
D ; Delete messages
"RTN","XMJMLN",173,0)
 D DELETE^XMJMORX(XMDUZ,XMKALL,XMK)
"RTN","XMJMLN",174,0)
 D WAIT^XMXUTIL
"RTN","XMJMLN",175,0)
 I XMZOOM,'$D(^TMP("XM",$J,".")) D Z
"RTN","XMJMLN",176,0)
 Q
"RTN","XMJMLN",177,0)
F ; Forward messages
"RTN","XMJMLN",178,0)
 D FORWARD^XMJMORX(XMDUZ,XMKALL,XMK)
"RTN","XMJMLN",179,0)
 D WAIT^XMXUTIL
"RTN","XMJMLN",180,0)
 Q
"RTN","XMJMLN",181,0)
FI ; Filter messages
"RTN","XMJMLN",182,0)
 D FILTER^XMJMORX(XMDUZ,XMKALL,XMK)
"RTN","XMJMLN",183,0)
 D WAIT^XMXUTIL
"RTN","XMJMLN",184,0)
 Q
"RTN","XMJMLN",185,0)
H ; Headerless Print messages
"RTN","XMJMLN",186,0)
 D PRINT^XMJMORX(XMDUZ,0)
"RTN","XMJMLN",187,0)
 D WAIT^XMXUTIL
"RTN","XMJMLN",188,0)
 Q
"RTN","XMJMLN",189,0)
L ; Later messages
"RTN","XMJMLN",190,0)
 D LATER^XMJMORX(XMDUZ,XMKALL,XMK)
"RTN","XMJMLN",191,0)
 D WAIT^XMXUTIL
"RTN","XMJMLN",192,0)
 Q
"RTN","XMJMLN",193,0)
NT ; New Toggle messages
"RTN","XMJMLN",194,0)
 D NEWTOGL^XMJMORX(XMDUZ,XMKALL,XMK)
"RTN","XMJMLN",195,0)
 D WAIT^XMXUTIL
"RTN","XMJMLN",196,0)
 Q
"RTN","XMJMLN",197,0)
O ; Opposite toggle
"RTN","XMJMLN",198,0)
 N XMKZ
"RTN","XMJMLN",199,0)
 S XMKZ=0
"RTN","XMJMLN",200,0)
 F  S XMKZ=$O(^TMP("XM",$J,"MSG",XMKZ)) Q:'XMKZ  D
"RTN","XMJMLN",201,0)
 . I $D(^TMP("XM",$J,".",XMKZ)) K ^TMP("XM",$J,".",XMKZ) Q
"RTN","XMJMLN",202,0)
 . S ^TMP("XM",$J,".",XMKZ)=""
"RTN","XMJMLN",203,0)
 S XMPAGE=0
"RTN","XMJMLN",204,0)
 Q
"RTN","XMJMLN",205,0)
P ; Print messages
"RTN","XMJMLN",206,0)
 D PRINT^XMJMORX(XMDUZ,1)
"RTN","XMJMLN",207,0)
 D WAIT^XMXUTIL
"RTN","XMJMLN",208,0)
 Q
"RTN","XMJMLN",209,0)
S ; Save messages
"RTN","XMJMLN",210,0)
 D SAVE^XMJMORX(XMDUZ,XMKALL,XMK)
"RTN","XMJMLN",211,0)
 D WAIT^XMXUTIL
"RTN","XMJMLN",212,0)
 I XMZOOM,'$D(^TMP("XM",$J,".")) D Z
"RTN","XMJMLN",213,0)
 Q
"RTN","XMJMLN",214,0)
T ; Terminate messages
"RTN","XMJMLN",215,0)
 D TERM^XMJMORX(XMDUZ,XMKALL,XMK)
"RTN","XMJMLN",216,0)
 D WAIT^XMXUTIL
"RTN","XMJMLN",217,0)
 I XMZOOM,'$D(^TMP("XM",$J,".")) D Z
"RTN","XMJMLN",218,0)
 Q
"RTN","XMJMLN",219,0)
V ; Vaporize messages
"RTN","XMJMLN",220,0)
 D VAPOR^XMJMORX(XMDUZ,XMKALL,XMK)
"RTN","XMJMLN",221,0)
 D WAIT^XMXUTIL
"RTN","XMJMLN",222,0)
 Q
"RTN","XMJMLN",223,0)
X ; Xmit Priority Toggle messages (for Postmaster only)
"RTN","XMJMLN",224,0)
 D XMTPRI^XMJMOR(XMDUZ,XMK)
"RTN","XMJMLN",225,0)
 D WAIT^XMXUTIL
"RTN","XMJMLN",226,0)
 Q
"RTN","XMJMLN",227,0)
Z ; Zoom toggle
"RTN","XMJMLN",228,0)
 N I
"RTN","XMJMLN",229,0)
 I XMZOOM D
"RTN","XMJMLN",230,0)
 . S XMZOOM=0
"RTN","XMJMLN",231,0)
 . S I=""
"RTN","XMJMLN",232,0)
 . F  S I=$O(XMFIRST(0,I)) Q:I=""  S XMFIRST(I)=XMFIRST(0,I)
"RTN","XMJMLN",233,0)
 . S XMPAGE=XMPAGE(0)
"RTN","XMJMLN",234,0)
 E  D
"RTN","XMJMLN",235,0)
 . S XMZOOM=1
"RTN","XMJMLN",236,0)
 . S I=""
"RTN","XMJMLN",237,0)
 . F  S I=$O(XMFIRST(I)) Q:I=""  S XMFIRST(0,I)=XMFIRST(I)
"RTN","XMJMLN",238,0)
 . S XMPAGE(0)=XMPAGE
"RTN","XMJMLN",239,0)
 . S XMPAGE=0
"RTN","XMJMLN",240,0)
 Q
"RTN","XMJMLR")
0^293^B74217777
"RTN","XMJMLR",1,0)
XMJMLR ;ISC-SF/GMB-List/Read messages in basket ;05/21/2002  06:46
"RTN","XMJMLR",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMJMLR",3,0)
 ; Replaces 1^XMAL0 (ISC-WASH/THM/CAP)
"RTN","XMJMLR",4,0)
LIST(XMDUZ,XMK,XMKN,XMDETAIL,XMABORT) ; List messages in basket 
"RTN","XMJMLR",5,0)
 ; XMDETAIL 0=Summary; 1=Detailed
"RTN","XMJMLR",6,0)
 N XMKZ,XMLEN,XMFIRST,XMPAGE,XMPMAX,XMZOOM,XMINSTR,XMOPT,XMOX,XMORDER
"RTN","XMJMLR",7,0)
 I XMDUZ=.5,XMK>999 S XMORDER=XMV("ORDER"),XMV("ORDER")=1
"RTN","XMJMLR",8,0)
 S XMINSTR("GOTO")=1  ; may go to another page
"RTN","XMJMLR",9,0)
 D SETOPT^XMJMLR1(XMDUZ,XMK,.XMOPT,.XMOX)
"RTN","XMJMLR",10,0)
 K ^TMP("XM",$J,".")
"RTN","XMJMLR",11,0)
 S XMKZ="",(XMPAGE,XMZOOM)=0,XMPMAX=IOSL-3
"RTN","XMJMLR",12,0)
 D INIT^XMJML(XMDUZ,XMK,XMKN,XMDETAIL,.XMLEN,1)
"RTN","XMJMLR",13,0)
 F  D  Q:XMABORT!'$D(^XMB(3.7,XMDUZ,2,XMK,1,"C"))
"RTN","XMJMLR",14,0)
 . D DISPLAY(XMDUZ,XMDETAIL,XMK,XMKN,.XMKZ,.XMFIRST,.XMPAGE,.XMLEN,XMZOOM,XMPMAX)
"RTN","XMJMLR",15,0)
 . D CHOOSE(XMDUZ,.XMK,.XMKZ,.XMFIRST,.XMPAGE,.XMLEN,.XMZOOM,.XMINSTR,.XMOPT,.XMOX,.XMABORT)
"RTN","XMJMLR",16,0)
 K ^TMP("XM",$J,".")
"RTN","XMJMLR",17,0)
 I $D(XMORDER) S XMV("ORDER")=XMORDER
"RTN","XMJMLR",18,0)
 Q
"RTN","XMJMLR",19,0)
DISPLAY(XMDUZ,XMDETAIL,XMK,XMKN,XMKZ,XMFIRST,XMPAGE,XMLEN,XMZOOM,XMPMAX) ;
"RTN","XMJMLR",20,0)
 N XMZ
"RTN","XMJMLR",21,0)
 S XMFIRST(XMPAGE)=XMKZ
"RTN","XMJMLR",22,0)
 D HEADER^XMJML(XMDETAIL,.XMLEN,$$HEADLINE^XMJML(XMDUZ,XMK,XMKN))
"RTN","XMJMLR",23,0)
 I XMZOOM D  Q
"RTN","XMJMLR",24,0)
 . F  S XMKZ=$O(^TMP("XM",$J,".",XMKZ),XMV("ORDER")) Q:XMKZ=""  D  Q:$Y>XMPMAX
"RTN","XMJMLR",25,0)
 . . D LISTMSG^XMJML(XMK,XMKN,XMKZ,$O(^XMB(3.7,XMDUZ,2,XMK,1,"C",XMKZ,"")),XMDETAIL,.XMLEN)
"RTN","XMJMLR",26,0)
 F  S XMKZ=$O(^XMB(3.7,XMDUZ,2,XMK,1,"C",XMKZ),XMV("ORDER")) Q:XMKZ=""  D  Q:$Y>XMPMAX
"RTN","XMJMLR",27,0)
 . S XMZ=$O(^XMB(3.7,XMDUZ,2,XMK,1,"C",XMKZ,""))
"RTN","XMJMLR",28,0)
 . I '$D(^XMB(3.7,XMDUZ,2,XMK,1,XMZ,0)) D ADDITC^XMUT4A(XMDUZ,XMK,XMZ,XMKZ)
"RTN","XMJMLR",29,0)
 . I '$D(^XMB(3.9,XMZ,0)) D ZAPIT^XMXMSGS2(XMDUZ,XMK,XMZ) Q
"RTN","XMJMLR",30,0)
 . D LISTMSG^XMJML(XMK,XMKN,XMKZ,XMZ,XMDETAIL,.XMLEN)
"RTN","XMJMLR",31,0)
 Q
"RTN","XMJMLR",32,0)
CHOOSE(XMDUZ,XMK,XMKZ,XMFIRST,XMPAGE,XMLEN,XMZOOM,XMINSTR,XMOPT,XMOX,XMABORT) ;
"RTN","XMJMLR",33,0)
 N XMY,XMZ,XMMORE,XMHI,XMLO
"RTN","XMJMLR",34,0)
 S XMMORE=$S(XMKZ="":0,'$O(^XMB(3.7,XMDUZ,2,XMK,1,"C",XMKZ),XMV("ORDER")):0,1:1)
"RTN","XMJMLR",35,0)
 S XMLO=$O(^XMB(3.7,XMDUZ,2,XMK,1,"C",""))
"RTN","XMJMLR",36,0)
 S XMHI=$O(^XMB(3.7,XMDUZ,2,XMK,1,"C",""),-1)
"RTN","XMJMLR",37,0)
 D XMDIR^XMJMLR1(XMDUZ,XMLO,XMHI,XMPAGE,XMMORE,"XM-U-BO-FULL SCREEN",.XMINSTR,.XMOPT,.XMOX,.XMY,.XMABORT) Q:XMABORT
"RTN","XMJMLR",38,0)
 I '$D(XMY) S XMKZ=XMFIRST(XMPAGE) Q
"RTN","XMJMLR",39,0)
 I XMY=""!($E(XMY)="+") D  Q  ; Page forward
"RTN","XMJMLR",40,0)
 . I XMMORE D PFWD Q
"RTN","XMJMLR",41,0)
 . I XMPAGE=0 S XMABORT=1 Q
"RTN","XMJMLR",42,0)
 . D AGAIN(.XMABORT) Q:XMABORT
"RTN","XMJMLR",43,0)
 . S XMPAGE=0
"RTN","XMJMLR",44,0)
 . S XMKZ=XMFIRST(XMPAGE)
"RTN","XMJMLR",45,0)
 I $E(XMY)="." D  Q  ; (De)Select messages
"RTN","XMJMLR",46,0)
 . D DODOT
"RTN","XMJMLR",47,0)
 . I XMZOOM,'$D(^TMP("XM",$J,".")) D Z
"RTN","XMJMLR",48,0)
 . S XMKZ=XMFIRST(XMPAGE)
"RTN","XMJMLR",49,0)
 I XMY>0 D  Q  ;
"RTN","XMJMLR",50,0)
 . N XMKZLAST
"RTN","XMJMLR",51,0)
 . S XMKZLAST=XMKZ
"RTN","XMJMLR",52,0)
 . S XMKZ=XMY
"RTN","XMJMLR",53,0)
 . S XMZ=$O(^XMB(3.7,XMDUZ,2,XMK,1,"C",XMKZ,""))
"RTN","XMJMLR",54,0)
 . I XMZ D
"RTN","XMJMLR",55,0)
 . . I '$D(^XMB(3.7,XMDUZ,2,XMK,1,XMZ,0)) D ADDITC^XMUT4A(XMDUZ,XMK,XMZ,XMKZ)
"RTN","XMJMLR",56,0)
 . . D READMSG(XMDUZ,XMK,XMKN,XMKZ,XMZ,XMZOOM)
"RTN","XMJMLR",57,0)
 . . D FINDXMKZ(XMDUZ,XMK,.XMFIRST,.XMPAGE,XMKZLAST,XMKZ)
"RTN","XMJMLR",58,0)
 . E  D
"RTN","XMJMLR",59,0)
 . . S XMZ=XMY
"RTN","XMJMLR",60,0)
 . . I $D(^XMB(3.7,XMDUZ,2,XMK,1,XMZ,0)) D  Q
"RTN","XMJMLR",61,0)
 . . . S XMKZ=$P(^XMB(3.7,XMDUZ,2,XMK,1,XMZ,0),U,2)
"RTN","XMJMLR",62,0)
 . . . I 'XMKZ D ADDITM^XMUT4A(XMDUZ,XMK,XMZ,.XMKZ)
"RTN","XMJMLR",63,0)
 . . . D READMSG(XMDUZ,XMK,XMKN,XMKZ,XMZ,XMZOOM)
"RTN","XMJMLR",64,0)
 . . . D FINDXMKZ(XMDUZ,XMK,.XMFIRST,.XMPAGE,XMKZLAST,XMKZ)
"RTN","XMJMLR",65,0)
 . . I '$D(^XMB(3.9,XMZ,0)) D  Q
"RTN","XMJMLR",66,0)
 . . . W $C(7)
"RTN","XMJMLR",67,0)
 . . . Q:XMZ>$O(^XMB(3.7,XMDUZ,2,XMK,1,"C",""),-1)
"RTN","XMJMLR",68,0)
 . . . S XMKZ=$O(^XMB(3.7,XMDUZ,2,XMK,1,"C",XMZ),XMV("ORDER"))
"RTN","XMJMLR",69,0)
 . . . I 'XMKZ S XMKZ=$O(^XMB(3.7,XMDUZ,2,XMK,1,"C",XMZ),-XMV("ORDER"))
"RTN","XMJMLR",70,0)
 . . . D FINDXMKZ(XMDUZ,XMK,.XMFIRST,.XMPAGE,XMKZLAST,XMKZ)
"RTN","XMJMLR",71,0)
 . . N XMK,XMKN,XMOK
"RTN","XMJMLR",72,0)
 . . S XMK=+$O(^XMB(3.7,"M",XMZ,XMDUZ,0))
"RTN","XMJMLR",73,0)
 . . I 'XMK D  Q:'XMOK
"RTN","XMJMLR",74,0)
 . . . N XMZREC
"RTN","XMJMLR",75,0)
 . . . S XMZREC=^XMB(3.9,XMZ,0)
"RTN","XMJMLR",76,0)
 . . . I $D(XMERR) K XMERR,^TMP("XMERR",$J)
"RTN","XMJMLR",77,0)
 . . . S XMOK=$$ACCESS^XMXSEC(XMDUZ,XMZ,XMZREC) Q:XMOK
"RTN","XMJMLR",78,0)
 . . . D FWD^XMJMLR1(XMDUZ,XMZ,XMZREC,1,.XMOK)
"RTN","XMJMLR",79,0)
 . . S XMKN=$S(XMK:$P(^XMB(3.7,XMDUZ,2,XMK,0),U,1),1:$$EZBLD^DIALOG(34014)) ; * N/A *
"RTN","XMJMLR",80,0)
 . . I XMK,'$D(^XMB(3.7,XMDUZ,2,XMK,1,XMZ,0)) D ADDITM^XMUT4A(XMDUZ,XMK,XMZ)
"RTN","XMJMLR",81,0)
 . . D READMSG^XMJBM(XMDUZ,XMK,XMKN,XMZ)
"RTN","XMJMLR",82,0)
 . S XMKZ=XMFIRST(XMPAGE)
"RTN","XMJMLR",83,0)
 I XMY=0 D  Q  ; First page
"RTN","XMJMLR",84,0)
 . S XMPAGE=0
"RTN","XMJMLR",85,0)
 . S XMKZ=XMFIRST(XMPAGE)
"RTN","XMJMLR",86,0)
 I $E(XMY)="-" D  Q  ; Page back
"RTN","XMJMLR",87,0)
 . N XMCNT
"RTN","XMJMLR",88,0)
 . S XMCNT=$E(XMY,2,99)
"RTN","XMJMLR",89,0)
 . S:XMCNT="" XMCNT=1
"RTN","XMJMLR",90,0)
 . S XMPAGE=XMPAGE-XMCNT
"RTN","XMJMLR",91,0)
 . S:XMPAGE<0 XMPAGE=0
"RTN","XMJMLR",92,0)
 . S XMKZ=XMFIRST(XMPAGE)
"RTN","XMJMLR",93,0)
 D @XMY
"RTN","XMJMLR",94,0)
 S XMKZ=XMFIRST(XMPAGE)
"RTN","XMJMLR",95,0)
 Q
"RTN","XMJMLR",96,0)
PFWD ;
"RTN","XMJMLR",97,0)
 N XMCNT,XMPDEST
"RTN","XMJMLR",98,0)
 S XMCNT=$E(XMY,2,99)
"RTN","XMJMLR",99,0)
 S:XMCNT="" XMCNT=1
"RTN","XMJMLR",100,0)
 I XMCNT=1 S XMPAGE=XMPAGE+1 Q
"RTN","XMJMLR",101,0)
 S XMPDEST=XMPAGE+XMCNT
"RTN","XMJMLR",102,0)
 D FINDPAGE(.XMFIRST,.XMPAGE,XMKZ,XMPDEST)
"RTN","XMJMLR",103,0)
 S XMKZ=XMFIRST(XMPAGE)
"RTN","XMJMLR",104,0)
 Q
"RTN","XMJMLR",105,0)
FINDPAGE(XMFIRST,XMPAGE,XMKZ,XMPDEST) ;
"RTN","XMJMLR",106,0)
 N XMO,I
"RTN","XMJMLR",107,0)
 S XMO=$S(XMPDEST>XMPAGE:1,1:-1)
"RTN","XMJMLR",108,0)
 F XMPAGE=XMPAGE+XMO:XMO S XMFIRST(XMPAGE)=XMKZ Q:XMPAGE=XMPDEST  D  Q:XMKZ=""
"RTN","XMJMLR",109,0)
 . F I=1:1:XMPMAX S XMKZ=$O(^XMB(3.7,XMDUZ,2,XMK,1,"C",XMKZ),XMO*XMV("ORDER")) Q:XMKZ=""
"RTN","XMJMLR",110,0)
 I '$O(^XMB(3.7,XMDUZ,2,XMK,1,"C",XMFIRST(XMPAGE)),XMO*XMV("ORDER")) S XMPAGE=XMPAGE-XMO Q
"RTN","XMJMLR",111,0)
 Q
"RTN","XMJMLR",112,0)
FINDXMKZ(XMDUZ,XMK,XMFIRST,XMPAGE,XMKZLAST,XMKZF) ; Find the page with XMKZF on it
"RTN","XMJMLR",113,0)
 Q:'$D(^XMB(3.7,XMDUZ,2,XMK,1,"C",XMKZF))
"RTN","XMJMLR",114,0)
 I XMV("ORDER")=-1 D  Q
"RTN","XMJMLR",115,0)
 . I $S(XMFIRST(XMPAGE):XMFIRST(XMPAGE)>XMKZF,1:1),XMKZF'<XMKZLAST Q
"RTN","XMJMLR",116,0)
 . N XMKZ,I
"RTN","XMJMLR",117,0)
 . I XMKZF<XMKZLAST D  Q  ; Go forward
"RTN","XMJMLR",118,0)
 . . S XMKZ=XMKZLAST
"RTN","XMJMLR",119,0)
 . . F XMPAGE=XMPAGE+1:1 D  Q:XMKZ=XMKZF
"RTN","XMJMLR",120,0)
 . . . S XMFIRST(XMPAGE)=XMKZ
"RTN","XMJMLR",121,0)
 . . . F I=1:1:XMPMAX S XMKZ=$O(^XMB(3.7,XMDUZ,2,XMK,1,"C",XMKZ),-1) Q:XMKZ=XMKZF
"RTN","XMJMLR",122,0)
 . E  D  ; Go back
"RTN","XMJMLR",123,0)
 . . F XMPAGE=XMPAGE-1:-1 Q:XMFIRST(XMPAGE)>XMKZF!'XMPAGE
"RTN","XMJMLR",124,0)
 . . ;S XMKZ=XMFIRST(XMPAGE)-1
"RTN","XMJMLR",125,0)
 . . ;F XMPAGE=XMPAGE-1:-1 D  Q:XMFIRST(XMPAGE)>XMKZF
"RTN","XMJMLR",126,0)
 . . ;. F I=1:1:XMPMAX S XMKZ=$O(^XMB(3.7,XMDUZ,2,XMK,1,"C",XMKZ)) Q:XMKZ=""
"RTN","XMJMLR",127,0)
 . . ;. S XMFIRST(XMPAGE)=$S(XMKZ:XMKZ+1,1:XMKZ)
"RTN","XMJMLR",128,0)
 I XMFIRST(XMPAGE)<XMKZF,$S(XMKZLAST:XMKZF'>XMKZLAST,1:1) Q
"RTN","XMJMLR",129,0)
 N XMKZ,I
"RTN","XMJMLR",130,0)
 I XMKZF>XMKZLAST D  Q  ; Go forward
"RTN","XMJMLR",131,0)
 . S XMKZ=XMKZLAST
"RTN","XMJMLR",132,0)
 . F XMPAGE=XMPAGE+1:1 D  Q:XMKZ=XMKZF
"RTN","XMJMLR",133,0)
 . . S XMFIRST(XMPAGE)=XMKZ
"RTN","XMJMLR",134,0)
 . . F I=1:1:XMPMAX S XMKZ=$O(^XMB(3.7,XMDUZ,2,XMK,1,"C",XMKZ)) Q:XMKZ=XMKZF
"RTN","XMJMLR",135,0)
 E  D  ; Go back
"RTN","XMJMLR",136,0)
 . F XMPAGE=XMPAGE-1:-1 Q:XMFIRST(XMPAGE)<XMKZF!'XMPAGE
"RTN","XMJMLR",137,0)
 . ;S XMKZ=XMFIRST(XMPAGE)-1
"RTN","XMJMLR",138,0)
 . ;F XMPAGE=XMPAGE-1:-1 D  Q:XMFIRST(XMPAGE)<XMKZF
"RTN","XMJMLR",139,0)
 . ;. F I=1:1:XMPMAX S XMKZ=$O(^XMB(3.7,XMDUZ,2,XMK,1,"C",XMKZ),-1) Q:XMKZ=""
"RTN","XMJMLR",140,0)
 . ;. S XMFIRST(XMPAGE)=$S(XMKZ:XMKZ+1,1:XMKZ)
"RTN","XMJMLR",141,0)
 Q
"RTN","XMJMLR",142,0)
READMSG(XMDUZ,XMK,XMKN,XMKZ,XMZ,XMZOOM) ;
"RTN","XMJMLR",143,0)
 D READMSG^XMJBM(XMDUZ,XMK,XMKN,XMZ)
"RTN","XMJMLR",144,0)
 I $D(^TMP("XM",$J,".",XMKZ)),'$D(^XMB(3.7,XMDUZ,2,XMK,1,"C",XMKZ,XMZ)) K ^TMP("XM",$J,".",XMKZ)
"RTN","XMJMLR",145,0)
 I XMZOOM,'$D(^TMP("XM",$J,".")) D Z
"RTN","XMJMLR",146,0)
 Q
"RTN","XMJMLR",147,0)
AGAIN(XMABORT) ;
"RTN","XMJMLR",148,0)
 N DIR,Y
"RTN","XMJMLR",149,0)
 W !
"RTN","XMJMLR",150,0)
 S DIR("A")=$$EZBLD^DIALOG(34020) ; End reached.  Begin again
"RTN","XMJMLR",151,0)
 S DIR(0)="Y",DIR("B")=$$EZBLD^DIALOG(39053) ; No
"RTN","XMJMLR",152,0)
 D BLD^DIALOG(34021,"","","DIR(""?"")") ; Enter 'Yes' if you wish to continue reading messages; 'No' if you don't.
"RTN","XMJMLR",153,0)
 D ^DIR
"RTN","XMJMLR",154,0)
 Q:Y=1        ; Yes, begin again
"RTN","XMJMLR",155,0)
 S XMABORT=1  ; No, exit.
"RTN","XMJMLR",156,0)
 Q
"RTN","XMJMLR",157,0)
DODOT ;
"RTN","XMJMLR",158,0)
 N I,XMSTRIKE,XM1,XMN,XMKZ
"RTN","XMJMLR",159,0)
 I $E(XMY,2)="-" S XMSTRIKE=1,XMY=$E(XMY,3,999)
"RTN","XMJMLR",160,0)
 E  S XMSTRIKE=0,XMY=$E(XMY,2,999)
"RTN","XMJMLR",161,0)
 I XMY="*" D  Q
"RTN","XMJMLR",162,0)
 . I XMSTRIKE K ^TMP("XM",$J,".") Q
"RTN","XMJMLR",163,0)
 . S XMKZ=""
"RTN","XMJMLR",164,0)
 . F  S XMKZ=$O(^XMB(3.7,XMDUZ,2,XMK,1,"C",XMKZ)) Q:'XMKZ  S ^TMP("XM",$J,".",XMKZ)=""
"RTN","XMJMLR",165,0)
 F I=1:1:$L(XMY,",") D
"RTN","XMJMLR",166,0)
 . S XMKZ=$P(XMY,",",I)
"RTN","XMJMLR",167,0)
 . I XMKZ["-" D  Q
"RTN","XMJMLR",168,0)
 . . S XM1=$P(XMKZ,"-")
"RTN","XMJMLR",169,0)
 . . S XMN=$P(XMKZ,"-",2) S:XMN="" XMN=XMHI
"RTN","XMJMLR",170,0)
 . . S XMKZ=XM1-.1
"RTN","XMJMLR",171,0)
 . . I 'XMSTRIKE D  Q
"RTN","XMJMLR",172,0)
 . . . F  S XMKZ=$O(^XMB(3.7,XMDUZ,2,XMK,1,"C",XMKZ)) Q:XMKZ>XMN!'XMKZ  S:'$D(^TMP("XM",$J,".",XMKZ)) ^(XMKZ)=""
"RTN","XMJMLR",173,0)
 . . F  S XMKZ=$O(^XMB(3.7,XMDUZ,2,XMK,1,"C",XMKZ)) Q:XMKZ>XMN!'XMKZ  K:$D(^TMP("XM",$J,".",XMKZ)) ^(XMKZ)
"RTN","XMJMLR",174,0)
 . I 'XMSTRIKE D  Q
"RTN","XMJMLR",175,0)
 . . I $D(^XMB(3.7,XMDUZ,2,XMK,1,"C",XMKZ)),'$D(^TMP("XM",$J,".",XMKZ)) S ^(XMKZ)=""
"RTN","XMJMLR",176,0)
 . K:$D(^TMP("XM",$J,".",XMKZ)) ^(XMKZ)
"RTN","XMJMLR",177,0)
 Q
"RTN","XMJMLR",178,0)
C ; Change the name of this basket
"RTN","XMJMLR",179,0)
 D NAMEBSKT^XMJBU(XMDUZ,XMK,.XMKN)
"RTN","XMJMLR",180,0)
 K XMLEN
"RTN","XMJMLR",181,0)
 D INIT^XMJML(XMDUZ,XMK,XMKN,XMDETAIL,.XMLEN,1)
"RTN","XMJMLR",182,0)
 Q
"RTN","XMJMLR",183,0)
CD ; Change Detail
"RTN","XMJMLR",184,0)
 S XMDETAIL='XMDETAIL
"RTN","XMJMLR",185,0)
 D INIT^XMJML(XMDUZ,XMK,XMKN,XMDETAIL,.XMLEN,1)
"RTN","XMJMLR",186,0)
 Q
"RTN","XMJMLR",187,0)
D ; Delete messages
"RTN","XMJMLR",188,0)
 D DELETE^XMJMOR(XMDUZ,XMK)
"RTN","XMJMLR",189,0)
 D WAIT^XMXUTIL
"RTN","XMJMLR",190,0)
 I XMZOOM,'$D(^TMP("XM",$J,".")) D Z
"RTN","XMJMLR",191,0)
 Q
"RTN","XMJMLR",192,0)
F ; Forward messages
"RTN","XMJMLR",193,0)
 D FORWARD^XMJMOR(XMDUZ,XMK)
"RTN","XMJMLR",194,0)
 D WAIT^XMXUTIL
"RTN","XMJMLR",195,0)
 Q
"RTN","XMJMLR",196,0)
FI ; Filter messages
"RTN","XMJMLR",197,0)
 D FILTER^XMJMOR(XMDUZ,XMK)
"RTN","XMJMLR",198,0)
 D WAIT^XMXUTIL
"RTN","XMJMLR",199,0)
 Q
"RTN","XMJMLR",200,0)
H ; Headerless Print messages
"RTN","XMJMLR",201,0)
 D PRINT^XMJMOR(XMDUZ,XMK,0)
"RTN","XMJMLR",202,0)
 D WAIT^XMXUTIL
"RTN","XMJMLR",203,0)
 Q
"RTN","XMJMLR",204,0)
L ; Later messages
"RTN","XMJMLR",205,0)
 D LATER^XMJMOR(XMDUZ,XMK)
"RTN","XMJMLR",206,0)
 D WAIT^XMXUTIL
"RTN","XMJMLR",207,0)
 I XMZOOM,'$D(^TMP("XM",$J,".")) D Z
"RTN","XMJMLR",208,0)
 Q
"RTN","XMJMLR",209,0)
N ; New message list
"RTN","XMJMLR",210,0)
 D LISTONE^XMJMLN(XMDUZ,XMK,XMKN,"N0")
"RTN","XMJMLR",211,0)
 D WAIT^XMXUTIL
"RTN","XMJMLR",212,0)
 Q
"RTN","XMJMLR",213,0)
NT ; New Toggle messages
"RTN","XMJMLR",214,0)
 D NEWTOGL^XMJMOR(XMDUZ,XMK)
"RTN","XMJMLR",215,0)
 D WAIT^XMXUTIL
"RTN","XMJMLR",216,0)
 Q
"RTN","XMJMLR",217,0)
O ; Opposite toggle
"RTN","XMJMLR",218,0)
 N XMKZ
"RTN","XMJMLR",219,0)
 S XMKZ=0
"RTN","XMJMLR",220,0)
 F  S XMKZ=$O(^XMB(3.7,XMDUZ,2,XMK,1,"C",XMKZ)) Q:'XMKZ  D
"RTN","XMJMLR",221,0)
 . I $D(^TMP("XM",$J,".",XMKZ)) K ^TMP("XM",$J,".",XMKZ) Q
"RTN","XMJMLR",222,0)
 . S ^TMP("XM",$J,".",XMKZ)=""
"RTN","XMJMLR",223,0)
 S XMPAGE=0
"RTN","XMJMLR",224,0)
 Q
"RTN","XMJMLR",225,0)
P ; Print messages
"RTN","XMJMLR",226,0)
 D PRINT^XMJMOR(XMDUZ,XMK)
"RTN","XMJMLR",227,0)
 D WAIT^XMXUTIL
"RTN","XMJMLR",228,0)
 Q
"RTN","XMJMLR",229,0)
Q ; Query messages
"RTN","XMJMLR",230,0)
 D FINDBSKT^XMJMF(XMDUZ,XMK,XMKN)
"RTN","XMJMLR",231,0)
 Q
"RTN","XMJMLR",232,0)
Q1 ; ?string - search for messages in this basket whose subject contains string.
"RTN","XMJMLR",233,0)
 N XMF
"RTN","XMJMLR",234,0)
 S XMF("BSKT")=XMK
"RTN","XMJMLR",235,0)
 S XMF("SUBJ")=XMY(0)
"RTN","XMJMLR",236,0)
 D FIND1^XMJMFB(XMDUZ,.XMF,1)
"RTN","XMJMLR",237,0)
 Q
"RTN","XMJMLR",238,0)
Q2 ; ??string - search for messages whose subject starts with string.
"RTN","XMJMLR",239,0)
 D FIND^XMJMFA(XMDUZ,XMY(0),1)
"RTN","XMJMLR",240,0)
 Q
"RTN","XMJMLR",241,0)
R ; Resequence messages
"RTN","XMJMLR",242,0)
 D R^XMJBM
"RTN","XMJMLR",243,0)
 S XMPAGE=0
"RTN","XMJMLR",244,0)
 K XMLEN,XMFIRST
"RTN","XMJMLR",245,0)
 S XMFIRST(0)=""
"RTN","XMJMLR",246,0)
 D INIT^XMJML(XMDUZ,XMK,XMKN,XMDETAIL,.XMLEN,1)
"RTN","XMJMLR",247,0)
 D WAIT^XMXUTIL
"RTN","XMJMLR",248,0)
 Q
"RTN","XMJMLR",249,0)
S ; Save messages
"RTN","XMJMLR",250,0)
 D SAVE^XMJMOR(XMDUZ,XMK)
"RTN","XMJMLR",251,0)
 D WAIT^XMXUTIL
"RTN","XMJMLR",252,0)
 Q
"RTN","XMJMLR",253,0)
T ; Terminate messages
"RTN","XMJMLR",254,0)
 D TERM^XMJMOR(XMDUZ,XMK)
"RTN","XMJMLR",255,0)
 D WAIT^XMXUTIL
"RTN","XMJMLR",256,0)
 I XMZOOM,'$D(^TMP("XM",$J,".")) D Z
"RTN","XMJMLR",257,0)
 Q
"RTN","XMJMLR",258,0)
V ; Vaporize messages
"RTN","XMJMLR",259,0)
 D VAPOR^XMJMOR(XMDUZ,XMK)
"RTN","XMJMLR",260,0)
 D WAIT^XMXUTIL
"RTN","XMJMLR",261,0)
 Q
"RTN","XMJMLR",262,0)
X ; Xmit priority toggle messages
"RTN","XMJMLR",263,0)
 D XMTPRI^XMJMOR(XMDUZ,XMK)
"RTN","XMJMLR",264,0)
 D WAIT^XMXUTIL
"RTN","XMJMLR",265,0)
 Q
"RTN","XMJMLR",266,0)
Z ; Zoom toggle
"RTN","XMJMLR",267,0)
 N I
"RTN","XMJMLR",268,0)
 I XMZOOM D
"RTN","XMJMLR",269,0)
 . S XMZOOM=0
"RTN","XMJMLR",270,0)
 . S I=""
"RTN","XMJMLR",271,0)
 . F  S I=$O(XMFIRST(0,I)) Q:I=""  S XMFIRST(I)=XMFIRST(0,I)
"RTN","XMJMLR",272,0)
 . S XMPAGE=XMPAGE(0)
"RTN","XMJMLR",273,0)
 E  D
"RTN","XMJMLR",274,0)
 . S XMZOOM=1
"RTN","XMJMLR",275,0)
 . S I=""
"RTN","XMJMLR",276,0)
 . F  S I=$O(XMFIRST(I)) Q:I=""  S XMFIRST(0,I)=XMFIRST(I)
"RTN","XMJMLR",277,0)
 . S XMPAGE(0)=XMPAGE
"RTN","XMJMLR",278,0)
 . S XMPAGE=0
"RTN","XMJMLR",279,0)
 Q
"RTN","XMJMLR1")
0^294^B28231874
"RTN","XMJMLR1",1,0)
XMJMLR1 ;ISC-SF/GMB-List/Read messages in basket (cont.) ;05/20/2002  15:15
"RTN","XMJMLR1",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMJMLR1",3,0)
 ; Replaces 1^XMAL0 (ISC-WASH/THM/CAP)
"RTN","XMJMLR1",4,0)
XMDIR(XMDUZ,XMLO,XMHI,XMPAGE,XMMORE,XMHELP,XMINSTR,XMOPT,XMOX,XMY,XMABORT) ;
"RTN","XMJMLR1",5,0)
 N XMX K XMY
"RTN","XMJMLR1",6,0)
 D ZOOMOPT(.XMOPT)
"RTN","XMJMLR1",7,0)
 F  D  Q:$D(XMY)!XMABORT
"RTN","XMJMLR1",8,0)
 . W !,$$EZBLD^DIALOG(34050) ; Enter message number or command:
"RTN","XMJMLR1",9,0)
 . R XMX:DTIME I '$T S XMABORT=1 Q
"RTN","XMJMLR1",10,0)
 . I XMX[U S XMABORT=1 Q
"RTN","XMJMLR1",11,0)
 . I "="[XMX S XMY=XMX Q
"RTN","XMJMLR1",12,0)
 . I XMX?.E1C.E D HELPSCR Q
"RTN","XMJMLR1",13,0)
 . I $E(XMX)="?" D QUESTION Q
"RTN","XMJMLR1",14,0)
 . I '$$OK K XMY D HELPSCR Q
"RTN","XMJMLR1",15,0)
 . Q:'$D(XMOPT(XMY,"?"))
"RTN","XMJMLR1",16,0)
 . D SHOWERR
"RTN","XMJMLR1",17,0)
 I $G(XMY)="=" K XMY
"RTN","XMJMLR1",18,0)
 Q
"RTN","XMJMLR1",19,0)
OK() ;
"RTN","XMJMLR1",20,0)
 N XMLO
"RTN","XMJMLR1",21,0)
 S XMLO=0
"RTN","XMJMLR1",22,0)
 I XMX?1N.N Q $$NUMBERZ
"RTN","XMJMLR1",23,0)
 I $E(XMX)="." Q $$DOT
"RTN","XMJMLR1",24,0)
 S XMY=XMX
"RTN","XMJMLR1",25,0)
 I XMX?1(1"+",1"-").N Q $L(XMX)<26
"RTN","XMJMLR1",26,0)
 S XMY=$$COMMAND^XMJDIR(.XMOPT,.XMOX,XMX)
"RTN","XMJMLR1",27,0)
 Q XMY'=-1
"RTN","XMJMLR1",28,0)
NUMBERZ() ;
"RTN","XMJMLR1",29,0)
 Q:$L(XMX)>25 0
"RTN","XMJMLR1",30,0)
 S (XMX,XMY)=+XMX
"RTN","XMJMLR1",31,0)
 I XMX'<XMLO,XMX'>XMHI Q 1
"RTN","XMJMLR1",32,0)
 I $D(^XMB(3.9,XMX,0)) Q 1
"RTN","XMJMLR1",33,0)
 Q 0
"RTN","XMJMLR1",34,0)
DOT() ;
"RTN","XMJMLR1",35,0)
 N XMXR,I,XMOK,XMSTRIKE
"RTN","XMJMLR1",36,0)
 S XMOK=1
"RTN","XMJMLR1",37,0)
 S XMX=$TR(XMX," ")
"RTN","XMJMLR1",38,0)
 I $E(XMX,2)="-" S XMSTRIKE=1,XMX=$E(XMX,3,999)
"RTN","XMJMLR1",39,0)
 E  S XMSTRIKE=0,XMX=$E(XMX,2,999)
"RTN","XMJMLR1",40,0)
 I XMX="*" S XMY="."_$S(XMSTRIKE:"-",1:"")_XMX Q 1
"RTN","XMJMLR1",41,0)
 F I=1:1:$L(XMX,",") D  Q:'XMOK
"RTN","XMJMLR1",42,0)
 . S XMXR=$P(XMX,",",I)
"RTN","XMJMLR1",43,0)
 . I XMXR?1.25N1"-"1.25N D  Q
"RTN","XMJMLR1",44,0)
 . . I $P(XMXR,"-",1)<XMLO S XMOK=0 Q
"RTN","XMJMLR1",45,0)
 . . I $P(XMXR,"-",2)>XMHI S XMOK=0 Q
"RTN","XMJMLR1",46,0)
 . . I $P(XMXR,"-",1)>$P(XMXR,"-",2) S XMOK=0
"RTN","XMJMLR1",47,0)
 . I XMXR?1.25N D  Q
"RTN","XMJMLR1",48,0)
 . . I XMXR<XMLO S XMOK=0 Q
"RTN","XMJMLR1",49,0)
 . . I XMXR>XMHI S XMOK=0
"RTN","XMJMLR1",50,0)
 . I XMXR?1.25N1"-" D  Q
"RTN","XMJMLR1",51,0)
 . . I $P(XMXR,"-",1)<XMLO S XMOK=0 Q
"RTN","XMJMLR1",52,0)
 . . I $P(XMXR,"-",1)>XMHI S XMOK=0
"RTN","XMJMLR1",53,0)
 . S XMOK=0
"RTN","XMJMLR1",54,0)
 I XMOK S XMY="."_$S(XMSTRIKE:"-",1:"")_XMX Q 1
"RTN","XMJMLR1",55,0)
 Q 0
"RTN","XMJMLR1",56,0)
SHOWERR ;
"RTN","XMJMLR1",57,0)
 D SHOWERR^XMJDIR(.XMOPT,XMY)
"RTN","XMJMLR1",58,0)
 D WAIT^XMXUTIL
"RTN","XMJMLR1",59,0)
 S XMY="="
"RTN","XMJMLR1",60,0)
 Q
"RTN","XMJMLR1",61,0)
QUESTION ;
"RTN","XMJMLR1",62,0)
 I XMX="?" D HELPSCR Q
"RTN","XMJMLR1",63,0)
 I XMX?2."?"!("?HELP"[$$UP^XLFSTR(XMX)) S XQH=XMHELP D EN^XQH S XMY="=" Q
"RTN","XMJMLR1",64,0)
 I $L(XMX)>64 D HELPSCR Q
"RTN","XMJMLR1",65,0)
 I XMX?2"?"1N.N,$D(^XMB(3.9,$E(XMX,3,99),0)) S XMY=$E(XMX,3,99) Q
"RTN","XMJMLR1",66,0)
 I '$D(XMOPT("Q")) D HELPSCR Q
"RTN","XMJMLR1",67,0)
 S XMY="Q"
"RTN","XMJMLR1",68,0)
 I $D(XMOPT("Q","?")) D SHOWERR Q
"RTN","XMJMLR1",69,0)
 N I F I=1,2 Q:$E(XMX,I+1)'="?"
"RTN","XMJMLR1",70,0)
 S XMY=XMY_I,XMY(0)=$E(XMX,I+1,99)
"RTN","XMJMLR1",71,0)
 Q
"RTN","XMJMLR1",72,0)
HELPSCR ;
"RTN","XMJMLR1",73,0)
 N XMTEXT,XMPARM,XMLINES
"RTN","XMJMLR1",74,0)
 W !
"RTN","XMJMLR1",75,0)
 S XMPARM(1)=XMLO,XMPARM(2)=XMHI
"RTN","XMJMLR1",76,0)
 D BLD^DIALOG($S($G(XMINSTR("GOTO")):34051,1:34051.1),.XMPARM,"","XMTEXT","F") ; Enter a message number (_XMLO_-_XMHI_) to read a message.
"RTN","XMJMLR1",77,0)
 I $D(XMOPT("Q")),'$D(XMOPT("Q","?")) D BLD^DIALOG(34052,"","","XMTEXT","FS")
"RTN","XMJMLR1",78,0)
 ; ?string             Search for messages in this basket whose subject
"RTN","XMJMLR1",79,0)
 ;                     contains the specified string
"RTN","XMJMLR1",80,0)
 ; ??string            Search for messages you once sent or received
"RTN","XMJMLR1",81,0)
 ;                     whose subject begins with the specified string
"RTN","XMJMLR1",82,0)
 D BLD^DIALOG(34053,"","","XMTEXT","FS")
"RTN","XMJMLR1",83,0)
 ; .(-)n or n-m,a,c-d  (de)select message n or a list of messages
"RTN","XMJMLR1",84,0)
 ; .(-)*               (de)select all messages
"RTN","XMJMLR1",85,0)
 S XMLINES=IOSL-DIHELP-5
"RTN","XMJMLR1",86,0)
 D MSG^DIALOG("WH","",$G(IOM),"","XMTEXT")
"RTN","XMJMLR1",87,0)
 D HELPCMD^XMJDIR(.XMOPT,.XMOX,.XMLINES)
"RTN","XMJMLR1",88,0)
 I XMMORE D
"RTN","XMJMLR1",89,0)
 . I XMPAGE D BLD^DIALOG($S($G(XMINSTR("GOTO")):34055,1:34056),"","","XMTEXT","FS") Q
"RTN","XMJMLR1",90,0)
 . D BLD^DIALOG($S($G(XMINSTR("GOTO")):34057,1:34058),"","","XMTEXT","FS")
"RTN","XMJMLR1",91,0)
 E  D
"RTN","XMJMLR1",92,0)
 . I XMPAGE D BLD^DIALOG($S($G(XMINSTR("GOTO")):34060,1:34061),"","","XMTEXT","FS") Q
"RTN","XMJMLR1",93,0)
 . D BLD^DIALOG(34059,"","","XMTEXT","FS")
"RTN","XMJMLR1",94,0)
 ; Press ENTER or + to go to the next page.  Enter +n to page forward n pages.
"RTN","XMJMLR1",95,0)
 ; Enter - to go to the previous page.  Enter -n to page back n pages.
"RTN","XMJMLR1",96,0)
 ; Enter 0 to go to the first page; = to refresh this page; ^ to exit.
"RTN","XMJMLR1",97,0)
 D MSG^DIALOG("WH","",$G(IOM),"","XMTEXT")
"RTN","XMJMLR1",98,0)
 W !
"RTN","XMJMLR1",99,0)
 Q
"RTN","XMJMLR1",100,0)
SETOPT(XMDUZ,XMK,XMOPT,XMOX) ;
"RTN","XMJMLR1",101,0)
 D OPTGRP^XMXSEC1(XMDUZ,XMK,.XMOPT,.XMOX,1)
"RTN","XMJMLR1",102,0)
 D SET^XMXSEC1("CD",37221,.XMOPT,.XMOX) ; Change Detail
"RTN","XMJMLR1",103,0)
 D SET^XMXSEC1("O",37222,.XMOPT,.XMOX) ; Opposite selection toggle
"RTN","XMJMLR1",104,0)
 D SET^XMXSEC1("Z",37223,.XMOPT,.XMOX) ; Zoom selection toggle
"RTN","XMJMLR1",105,0)
 Q
"RTN","XMJMLR1",106,0)
ZOOMOPT(XMOPT) ;
"RTN","XMJMLR1",107,0)
 N I
"RTN","XMJMLR1",108,0)
 I $D(^TMP("XM",$J,".")) D  Q
"RTN","XMJMLR1",109,0)
 . I $D(XMOPT("Z","?")) K XMOPT("O","?"),XMOPT("Z","?")
"RTN","XMJMLR1",110,0)
 . I $D(XMOPT("Q")) F I="Q","N","R" S XMOPT(I,"?")=37232 ; You can't do this with messages selected.
"RTN","XMJMLR1",111,0)
 F I="O","Z" S XMOPT(I,"?")=37231 ; You can't do this unless messages are selected.
"RTN","XMJMLR1",112,0)
 I $D(XMOPT("Q")) K XMOPT("Q","?"),XMOPT("N","?"),XMOPT("R","?")
"RTN","XMJMLR1",113,0)
 Q
"RTN","XMJMLR1",114,0)
FWD(XMDUZ,XMZ,XMZREC,XMWAIT,XMOK) ; User is trying to access a message.
"RTN","XMJMLR1",115,0)
 N X        ; User (XMDUZ) is not authorized to see it.  If user (DUZ)
"RTN","XMJMLR1",116,0)
 S XMOK=0   ; is, then we'll give him a chance to forward it.
"RTN","XMJMLR1",117,0)
 I '$D(^TMP("XMERR",$J,"E",37103)) D  Q
"RTN","XMJMLR1",118,0)
 . D SHOW^XMJERR ; User (XMDUZ and/or DUZ) is not authorized to see it.
"RTN","XMJMLR1",119,0)
 . D:XMWAIT WAIT^XMXUTIL
"RTN","XMJMLR1",120,0)
 ; User is trying to access a message as a surrogate for someone else.
"RTN","XMJMLR1",121,0)
 ; User (DUZ) is authorized to see the message, but the someone else
"RTN","XMJMLR1",122,0)
 ; (XMDUZ) isn't.  We must check to see if we can allow the user to
"RTN","XMJMLR1",123,0)
 ; forward the message to XMDUZ. 
"RTN","XMJMLR1",124,0)
 D NOGOID^XMJMP2(XMZ,XMZREC,1) ; Show 'subject' & 'from'
"RTN","XMJMLR1",125,0)
 D SHOW^XMJERR
"RTN","XMJMLR1",126,0)
 S X=$$FORWARD^XMXSEC(DUZ,XMZ,XMZREC)
"RTN","XMJMLR1",127,0)
 I XMDUZ=.6 D
"RTN","XMJMLR1",128,0)
 . I $$CLOSED^XMXSEC(XMZREC) D ERRSET^XMXUTIL(39020) Q
"RTN","XMJMLR1",129,0)
 . I $$CONFID^XMXSEC(XMZREC) D ERRSET^XMXUTIL(39021)
"RTN","XMJMLR1",130,0)
 I $D(XMERR) D  Q
"RTN","XMJMLR1",131,0)
 . D SHOW^XMJERR
"RTN","XMJMLR1",132,0)
 . D:XMWAIT WAIT^XMXUTIL
"RTN","XMJMLR1",133,0)
 N DIR,X,Y
"RTN","XMJMLR1",134,0)
 W !
"RTN","XMJMLR1",135,0)
 S DIR(0)="Y"
"RTN","XMJMLR1",136,0)
 ;Do you want to forward this message to |1|
"RTN","XMJMLR1",137,0)
 D BLD^DIALOG(37104,XMV("NAME"),"","DIR(""A"")","F")
"RTN","XMJMLR1",138,0)
 S DIR("B")=$$EZBLD^DIALOG(39053) ; No
"RTN","XMJMLR1",139,0)
 D ^DIR Q:'Y!$D(DIRUT)
"RTN","XMJMLR1",140,0)
 K DIR,X,Y
"RTN","XMJMLR1",141,0)
 N XMERROR,XMINSTR,XMMSG
"RTN","XMJMLR1",142,0)
 I XMDUZ=.6 D ASKSHARE^XMXADDR1(.XMINSTR) Q:$D(XMERROR)
"RTN","XMJMLR1",143,0)
 S XMINSTR("FWD BY")=XMV("DUZ NAME")
"RTN","XMJMLR1",144,0)
 D FWDMSG^XMXMSGS(DUZ,"",XMZ,XMDUZ,.XMINSTR,.XMMSG)
"RTN","XMJMLR1",145,0)
 I $D(XMERR) D  Q
"RTN","XMJMLR1",146,0)
 . D SHOW^XMJERR
"RTN","XMJMLR1",147,0)
 . D:XMWAIT WAIT^XMXUTIL
"RTN","XMJMLR1",148,0)
 I $D(XMMSG) D
"RTN","XMJMLR1",149,0)
 . W !,XMMSG
"RTN","XMJMLR1",150,0)
 . D:XMWAIT WAIT^XMXUTIL
"RTN","XMJMLR1",151,0)
 S XMOK=1
"RTN","XMJMLR1",152,0)
 Q
"RTN","XMJMOI")
0^39^B72054294
"RTN","XMJMOI",1,0)
XMJMOI ;ISC-SF/GMB-Options at Ignore prompt ;05/13/2002  14:05
"RTN","XMJMOI",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMJMOI",3,0)
 ; Replaces ^XMA1,^XMA10 (ISC-WASH/CAP/THM)
"RTN","XMJMOI",4,0)
READMSG(XMNEWS,XMDUZ,XMK,XMKN,XMZ,XMABORT) ;
"RTN","XMJMOI",5,0)
 N XMFINISH,XMFROM,XMINSTR,XMRESTR,XMIEN,XMSUBJ,XMSETPRI,XMRESPSO,XMRESP,XMORIGN8,XMDIR,XMY,XMOPT,XMOX
"RTN","XMJMOI",6,0)
 D INIT^XMJMOI1(XMDUZ,XMZ,.XMSUBJ,.XMFROM,.XMORIGN8,.XMINSTR,.XMRESTR,.XMIEN,.XMRESPSO,.XMRESP)
"RTN","XMJMOI",7,0)
 S (XMFINISH,XMABORT)=0
"RTN","XMJMOI",8,0)
 F  D  Q:XMFINISH!XMABORT
"RTN","XMJMOI",9,0)
 . N XMNAME,XMEDITOK
"RTN","XMJMOI",10,0)
 . D CHKBSKT(XMDUZ,XMZ,.XMK,.XMKN)
"RTN","XMJMOI",11,0)
 . D READSET^XMJMOI1(XMDUZ,XMK,XMKN,XMZ,XMFROM,XMORIGN8,.XMINSTR,XMIEN,.XMDIR,.XMOPT,.XMOX)
"RTN","XMJMOI",12,0)
 . I XMIEN,'$D(XMOPT("B","?")) D CHKRESP^XMJMP(XMDUZ,XMZ,XMRESPSO,XMRESP)
"RTN","XMJMOI",13,0)
 . D XMDIR^XMJDIR(.XMDIR,.XMOPT,.XMOX,.XMY,.XMABORT)
"RTN","XMJMOI",14,0)
 . S XMEDITOK='$D(XMOPT("E","?")) ; Used in 'forward'
"RTN","XMJMOI",15,0)
 . K XMDIR,XMOPT,XMOX
"RTN","XMJMOI",16,0)
 . Q:XMABORT
"RTN","XMJMOI",17,0)
 . D CHKBSKT(XMDUZ,XMZ,.XMK,.XMKN)
"RTN","XMJMOI",18,0)
 . D @XMY
"RTN","XMJMOI",19,0)
 D:XMINSTR("FLAGS")["P" PRIORITY^XMJMOI1
"RTN","XMJMOI",20,0)
 I XMINSTR("FLAGS")["N" D  Q
"RTN","XMJMOI",21,0)
 . I XMNEWS D  Q
"RTN","XMJMOI",22,0)
 . . I $D(^XTMP("XM","MAKENEW",XMDUZ,XMZ)),$D(^XMB(3.7,XMDUZ,"N0",XMK,XMZ)) D NONEW^XMXUTIL(XMDUZ,XMK,XMZ,1)
"RTN","XMJMOI",23,0)
 . D MAKENEW^XMXUTIL(XMDUZ,XMK,XMZ,1)
"RTN","XMJMOI",24,0)
 ;I 'XMABORT,$D(^XMB(3.7,XMDUZ,"N0",XMK,XMZ)),+XMRESP=+$P($G(^XMB(3.9,XMZ,3,0)),U,4) D NONEW^XMXUTIL(XMDUZ,XMK,XMZ,1)
"RTN","XMJMOI",25,0)
 I 'XMABORT,$D(^XMB(3.7,XMDUZ,"N0",XMK,XMZ)) D NONEW^XMXUTIL(XMDUZ,XMK,XMZ,1)
"RTN","XMJMOI",26,0)
 I XMABORT,XMNEWS,'$D(^XMB(3.7,XMDUZ,"N0",XMK,XMZ)) S ^XTMP("XM","MAKENEW",XMDUZ,XMZ)=""
"RTN","XMJMOI",27,0)
 Q
"RTN","XMJMOI",28,0)
CHKBSKT(XMDUZ,XMZ,XMK,XMKN) ; Is the message still where we think it is?
"RTN","XMJMOI",29,0)
 I XMK,'$D(^XMB(3.7,"M",XMZ,XMDUZ,XMK)) D RESETXMK^XMJMOI1(XMDUZ,XMZ,.XMK,.XMKN) Q
"RTN","XMJMOI",30,0)
 I 'XMK,$D(^XMB(3.7,"M",XMZ,XMDUZ)) D RESETXMK^XMJMOI1(XMDUZ,XMZ,.XMK,.XMKN)
"RTN","XMJMOI",31,0)
 Q
"RTN","XMJMOI",32,0)
A ; Answer to sender only
"RTN","XMJMOI",33,0)
 I '$$GOTNS^XMVVITA(XMDUZ) D  Q:'$$GOTNS^XMVVITA(XMDUZ)
"RTN","XMJMOI",34,0)
 . W !!,$$EZBLD^DIALOG(37401.1) ; You must have a Network Signature to Answer a message.
"RTN","XMJMOI",35,0)
 . D CRE8NS^XMVVITA
"RTN","XMJMOI",36,0)
 D ANSWER^XMJMA(XMDUZ,XMZ,XMSUBJ,XMFROM)
"RTN","XMJMOI",37,0)
 D IMBACK^XMJMOI1(34070) ; Finished with 'Answer' command.
"RTN","XMJMOI",38,0)
 Q
"RTN","XMJMOI",39,0)
AA ; Access Attachments
"RTN","XMJMOI",40,0)
 N XMAPBLOB
"RTN","XMJMOI",41,0)
 I $G(IOT)="IMPC" D BLOB^XMAPBLOB Q
"RTN","XMJMOI",42,0)
 D NODISP^XMAPBLOB
"RTN","XMJMOI",43,0)
 Q
"RTN","XMJMOI",44,0)
B ; Backup
"RTN","XMJMOI",45,0)
 D BACKUP^XMJMP(XMDUZ,XMK,XMKN,XMZ)
"RTN","XMJMOI",46,0)
 S XMRESP=$P($G(^XMB(3.9,XMZ,1,XMIEN,0)),U,2)
"RTN","XMJMOI",47,0)
 Q
"RTN","XMJMOI",48,0)
BR ; Print to the Browser
"RTN","XMJMOI",49,0)
 D PRINT(1,1)
"RTN","XMJMOI",50,0)
 Q
"RTN","XMJMOI",51,0)
C ; Copy
"RTN","XMJMOI",52,0)
 D COPY^XMJMC(XMDUZ,XMK,XMZ,XMFROM)
"RTN","XMJMOI",53,0)
 D IMBACK^XMJMOI1(34071) ; Finished with 'Copy' command.
"RTN","XMJMOI",54,0)
 Q
"RTN","XMJMOI",55,0)
D ; Delete
"RTN","XMJMOI",56,0)
 D DEL^XMXMSGS2(XMDUZ,XMK,XMZ)
"RTN","XMJMOI",57,0)
 W !,$$EZBLD^DIALOG(34302.2) ; Message deleted.
"RTN","XMJMOI",58,0)
 S XMFINISH=1
"RTN","XMJMOI",59,0)
 Q:XMINSTR("FLAGS")'["N"
"RTN","XMJMOI",60,0)
 S XMINSTR("FLAGS")=$TR(XMINSTR("FLAGS"),"N")
"RTN","XMJMOI",61,0)
 K:XMNEWS ^XTMP("XM","MAKENEW",XMDUZ,XMZ)
"RTN","XMJMOI",62,0)
 Q
"RTN","XMJMOI",63,0)
E ; Edit
"RTN","XMJMOI",64,0)
 D EDIT^XMJMOIE(XMDUZ,XMK,XMZ,.XMSUBJ,.XMINSTR,.XMRESTR)
"RTN","XMJMOI",65,0)
 Q
"RTN","XMJMOI",66,0)
F ; Forward
"RTN","XMJMOI",67,0)
 N XMABORT
"RTN","XMJMOI",68,0)
 D GETRESTR^XMJMOI1(XMDUZ,XMZ,"",.XMINSTR,.XMRESTR)
"RTN","XMJMOI",69,0)
 S XMABORT=0
"RTN","XMJMOI",70,0)
 D INIT^XMXADDR
"RTN","XMJMOI",71,0)
 D TOWHOM^XMJMT(XMDUZ,$$EZBLD^DIALOG(34111),.XMINSTR,.XMRESTR,.XMABORT)  ; Find out to whom to forward
"RTN","XMJMOI",72,0)
 I 'XMABORT D
"RTN","XMJMOI",73,0)
 . I XMEDITOK,'$D(XMINSTR("VAPOR")),$$BCAST^XMJMSO,$$QVAPOR^XMJMSO D V^XMJMOIE
"RTN","XMJMOI",74,0)
 . D FWD^XMKP(XMDUZ,XMZ,.XMINSTR)
"RTN","XMJMOI",75,0)
 . W !,$$EZBLD^DIALOG(34309.2) ; Message forwarded.
"RTN","XMJMOI",76,0)
 D CLEANUP^XMXADDR
"RTN","XMJMOI",77,0)
 Q
"RTN","XMJMOI",78,0)
H ; Headerless Print
"RTN","XMJMOI",79,0)
 D PRINT(0)
"RTN","XMJMOI",80,0)
 Q
"RTN","XMJMOI",81,0)
HG ; Help:Group Information
"RTN","XMJMOI",82,0)
 D HELP^XMHIG
"RTN","XMJMOI",83,0)
 Q
"RTN","XMJMOI",84,0)
HU ; Help:User Information
"RTN","XMJMOI",85,0)
 D HELP^XMHIU
"RTN","XMJMOI",86,0)
 Q
"RTN","XMJMOI",87,0)
I ; Ignore
"RTN","XMJMOI",88,0)
 S XMFINISH=1
"RTN","XMJMOI",89,0)
 Q
"RTN","XMJMOI",90,0)
IN ; Information Only toggle
"RTN","XMJMOI",91,0)
 I $G(XMINSTR("FLAGS"))["I" D
"RTN","XMJMOI",92,0)
 . S XMINSTR("FLAGS")=$TR(XMINSTR("FLAGS"),"I")
"RTN","XMJMOI",93,0)
 . S $P(^XMB(3.9,XMZ,0),U,12)=""
"RTN","XMJMOI",94,0)
 . W !,$$EZBLD^DIALOG(37409.9) ; Message is no longer 'Information only'.
"RTN","XMJMOI",95,0)
 E  D
"RTN","XMJMOI",96,0)
 . S XMINSTR("FLAGS")=$G(XMINSTR("FLAGS"))_"I"
"RTN","XMJMOI",97,0)
 . S $P(^XMB(3.9,XMZ,0),U,12)="y"
"RTN","XMJMOI",98,0)
 . W !,$$EZBLD^DIALOG(37408.9) ; Message is now 'Information only'.  No one may reply.
"RTN","XMJMOI",99,0)
 Q
"RTN","XMJMOI",100,0)
K ; Toggle Priority of future replies
"RTN","XMJMOI",101,0)
 I $G(XMINSTR("FLAGS"))["K" D
"RTN","XMJMOI",102,0)
 . S XMINSTR("FLAGS")=$TR(XMINSTR("FLAGS"),"K")
"RTN","XMJMOI",103,0)
 . S $P(^XMB(3.9,XMZ,1,XMIEN,0),U,9)=1
"RTN","XMJMOI",104,0)
 . W !,$$EZBLD^DIALOG(37412.9) ; Responses will not be delivered as Priority Mail.
"RTN","XMJMOI",105,0)
 E  D
"RTN","XMJMOI",106,0)
 . S XMINSTR("FLAGS")=$G(XMINSTR("FLAGS"))_"K"
"RTN","XMJMOI",107,0)
 . S $P(^XMB(3.9,XMZ,1,XMIEN,0),U,9)=""
"RTN","XMJMOI",108,0)
 . W !,$$EZBLD^DIALOG(37411.9) ; Responses will be delivered as Priority Mail.
"RTN","XMJMOI",109,0)
 S XMSETPRI=1
"RTN","XMJMOI",110,0)
 Q
"RTN","XMJMOI",111,0)
L ; Later
"RTN","XMJMOI",112,0)
 D LATER^XMJMD(XMDUZ,XMZ)
"RTN","XMJMOI",113,0)
 Q
"RTN","XMJMOI",114,0)
N ; Toggle New
"RTN","XMJMOI",115,0)
 I XMINSTR("FLAGS")["N" D
"RTN","XMJMOI",116,0)
 . S XMINSTR("FLAGS")=$TR(XMINSTR("FLAGS"),"N")
"RTN","XMJMOI",117,0)
 . K:XMNEWS ^XTMP("XM","MAKENEW",XMDUZ,XMZ)
"RTN","XMJMOI",118,0)
 . W !,$$EZBLD^DIALOG(37415.9) ; Message will NOT be new next time.
"RTN","XMJMOI",119,0)
 E  D
"RTN","XMJMOI",120,0)
 . S XMINSTR("FLAGS")=XMINSTR("FLAGS")_"N"
"RTN","XMJMOI",121,0)
 . S:XMNEWS ^XTMP("XM","MAKENEW",XMDUZ,XMZ)=""
"RTN","XMJMOI",122,0)
 . W !,$$EZBLD^DIALOG(37414.9) ; Message will be new next time.
"RTN","XMJMOI",123,0)
 . I XMK>.5!XMNEWS Q
"RTN","XMJMOI",124,0)
 . D SAVEMSG(XMDUZ,.XMK,.XMKN,XMZ,XMSUBJ,XMFROM,$G(XMINSTR("RCPT BSKT")))
"RTN","XMJMOI",125,0)
 Q
"RTN","XMJMOI",126,0)
P ; Print
"RTN","XMJMOI",127,0)
 D PRINT(1)
"RTN","XMJMOI",128,0)
 Q
"RTN","XMJMOI",129,0)
PRINT(XMPRTHDR,XMBROWSE) ;
"RTN","XMJMOI",130,0)
 N XMABORT
"RTN","XMJMOI",131,0)
 S XMABORT=0
"RTN","XMJMOI",132,0)
 I '$G(XMBROWSE),XMINSTR("TYPE")["K"!(XMINSTR("TYPE")["X") D  Q:XMABORT
"RTN","XMJMOI",133,0)
 . N DIR,XMMSG,XMPARM
"RTN","XMJMOI",134,0)
 . S XMMSG=$$EZBLD^DIALOG($S(XMINSTR("TYPE")["K":34076,1:34077)) ; KIDS build / PackMan message
"RTN","XMJMOI",135,0)
 . D BLD^DIALOG(34078,XMMSG,"","DIR(""A"")") ; Print just the descriptive text of this _XMMSG
"RTN","XMJMOI",136,0)
 . ;This is a _XMMSG_.
"RTN","XMJMOI",137,0)
 . ;Answer YES to print just the descriptive text.
"RTN","XMJMOI",138,0)
 . ;Answer NO to print the whole thing (x lines) and/or any responses.
"RTN","XMJMOI",139,0)
 . S XMPARM(1)=XMMSG,XMPARM(2)=$$LINE^XMXUTIL2(XMZ)
"RTN","XMJMOI",140,0)
 . D BLD^DIALOG(34079,.XMPARM,"","DIR(""?"")") ; Print just the descriptive text of this _XMMSG
"RTN","XMJMOI",141,0)
 . S DIR(0)="Y",DIR("B")=$$EZBLD^DIALOG(39054) ; Yes
"RTN","XMJMOI",142,0)
 . D ^DIR I $D(DIRUT) S XMABORT=1 Q
"RTN","XMJMOI",143,0)
 . Q:'Y
"RTN","XMJMOI",144,0)
 . N A,DIE,DIF,X,XCF,XCN,XMR
"RTN","XMJMOI",145,0)
 . S XMR=^XMB(3.9,XMZ,0)
"RTN","XMJMOI",146,0)
 . D XT^XMP2
"RTN","XMJMOI",147,0)
 . S XMABORT=1
"RTN","XMJMOI",148,0)
 D PRINT^XMJMP(XMDUZ,XMK,XMZ,XMPRTHDR,.XMBROWSE)
"RTN","XMJMOI",149,0)
 S XMRESP=$P($G(^XMB(3.9,XMZ,1,XMIEN,0)),U,2)
"RTN","XMJMOI",150,0)
 Q
"RTN","XMJMOI",151,0)
Q ; Query
"RTN","XMJMOI",152,0)
 D Q^XMJMQ(XMDUZ,XMK,XMKN,XMZ)
"RTN","XMJMOI",153,0)
 Q
"RTN","XMJMOI",154,0)
QC ; Query Current
"RTN","XMJMOI",155,0)
 D QX^XMJMQ(XMDUZ,XMK,XMKN,XMZ,"QC")
"RTN","XMJMOI",156,0)
 Q
"RTN","XMJMOI",157,0)
QD ; Query Detailed
"RTN","XMJMOI",158,0)
 I $D(XMNAME) D QNAMEX^XMJMQ(XMDUZ,XMK,XMKN,XMZ,XMNAME) Q
"RTN","XMJMOI",159,0)
 D QD^XMJMQ(XMDUZ,XMK,XMKN,XMZ)
"RTN","XMJMOI",160,0)
 Q
"RTN","XMJMOI",161,0)
QN ; Query Network
"RTN","XMJMOI",162,0)
 D QN^XMJMQ(XMDUZ,XMK,XMKN,XMZ)
"RTN","XMJMOI",163,0)
 Q
"RTN","XMJMOI",164,0)
QNC ; Query Not Current
"RTN","XMJMOI",165,0)
 D QX^XMJMQ(XMDUZ,XMK,XMKN,XMZ,"QNC")
"RTN","XMJMOI",166,0)
 Q
"RTN","XMJMOI",167,0)
QT ; Query Terminated
"RTN","XMJMOI",168,0)
 D QX^XMJMQ(XMDUZ,XMK,XMKN,XMZ,"QT")
"RTN","XMJMOI",169,0)
 Q
"RTN","XMJMOI",170,0)
RI ; Reply, Include previous response(s)
"RTN","XMJMOI",171,0)
R ; Reply
"RTN","XMJMOI",172,0)
 N XMINCL
"RTN","XMJMOI",173,0)
 S XMINCL=(XMY="RI")
"RTN","XMJMOI",174,0)
 I $D(^XMB(3.7,XMDUZ,"N0",XMK,XMZ)),+XMRESP=+$P($G(^XMB(3.9,XMZ,3,0)),U,4) D NONEW^XMXUTIL(XMDUZ,XMK,XMZ,1)
"RTN","XMJMOI",175,0)
 D REPLY^XMJMR(XMDUZ,.XMK,.XMKN,XMZ,XMSUBJ,XMFROM,.XMINSTR,XMIEN,XMRESPSO,XMINCL,.XMRESP)
"RTN","XMJMOI",176,0)
 Q
"RTN","XMJMOI",177,0)
S ; Save (replaces S^XMA1B)
"RTN","XMJMOI",178,0)
 N XMKTO,XMDIC
"RTN","XMJMOI",179,0)
 I XMK,XMK'=.5 S XMDIC("B")="@" ; no default basket
"RTN","XMJMOI",180,0)
 E  D
"RTN","XMJMOI",181,0)
 . N XMKTO
"RTN","XMJMOI",182,0)
 . S XMKTO=0
"RTN","XMJMOI",183,0)
 . D CHEKBSKT^XMTDL2(XMDUZ,.XMKTO,XMSUBJ,XMFROM,$G(XMINSTR("RCPT BSKT")))
"RTN","XMJMOI",184,0)
 . S XMDIC("B")=$P(^XMB(3.7,XMDUZ,2,XMKTO,0),U)
"RTN","XMJMOI",185,0)
 D SELBSKT^XMJBU(XMDUZ,$$EZBLD^DIALOG(34325.1),"L",.XMDIC,.XMKTO) Q:XMKTO=U  ; Save message into basket:
"RTN","XMJMOI",186,0)
 D CHKBSKT(XMDUZ,XMZ,.XMK,.XMKN)
"RTN","XMJMOI",187,0)
 I XMKTO=XMK D
"RTN","XMJMOI",188,0)
 . W !,$$EZBLD^DIALOG(34326.1) ; That's the same basket the message is already in.
"RTN","XMJMOI",189,0)
 E  D
"RTN","XMJMOI",190,0)
 . I $D(^XMB(3.7,XMDUZ,"N0",XMK,XMZ)) D NONEW^XMXUTIL(XMDUZ,XMK,XMZ,1)
"RTN","XMJMOI",191,0)
 . D MOVEIT^XMXMSGS2(XMDUZ,XMK,XMZ,XMKTO)
"RTN","XMJMOI",192,0)
 . W !,$$EZBLD^DIALOG(34324.2) ; Message saved.
"RTN","XMJMOI",193,0)
 . S XMK=XMKTO
"RTN","XMJMOI",194,0)
 S XMFINISH=1
"RTN","XMJMOI",195,0)
 Q
"RTN","XMJMOI",196,0)
T ; Terminate (replaces T^XMA1)
"RTN","XMJMOI",197,0)
 D TERM^XMXMSGS2(XMDUZ,XMK,XMZ)
"RTN","XMJMOI",198,0)
 W !,$$EZBLD^DIALOG($S(XMK<1:34331.1,1:34331)) ; You won't see future replies.  (In WASTE basket)
"RTN","XMJMOI",199,0)
 S XMFINISH=1
"RTN","XMJMOI",200,0)
 S:XMINSTR("FLAGS")["P" XMINSTR("FLAGS")=$TR(XMINSTR("FLAGS"),"P")
"RTN","XMJMOI",201,0)
 Q:XMINSTR("FLAGS")'["N"
"RTN","XMJMOI",202,0)
 S XMINSTR("FLAGS")=$TR(XMINSTR("FLAGS"),"N")
"RTN","XMJMOI",203,0)
 K:XMNEWS ^XTMP("XM","MAKENEW",XMDUZ,XMZ)
"RTN","XMJMOI",204,0)
 Q
"RTN","XMJMOI",205,0)
V ; Set Vaporize date for msg in basket (replaces DATE^XMA11A)
"RTN","XMJMOI",206,0)
 N DIE,DA,DR
"RTN","XMJMOI",207,0)
 L +^XMB(3.7,XMDUZ,2,XMK,1,XMZ,0):1
"RTN","XMJMOI",208,0)
 S DIE="^XMB(3.7,"_XMDUZ_",2,"_XMK_",1,"
"RTN","XMJMOI",209,0)
 S DA(2)=XMDUZ,DA(1)=XMK,DA=XMZ
"RTN","XMJMOI",210,0)
 S DR=5
"RTN","XMJMOI",211,0)
 D ^DIE
"RTN","XMJMOI",212,0)
 L -^XMB(3.7,XMDUZ,2,XMK,1,XMZ,0)
"RTN","XMJMOI",213,0)
 Q
"RTN","XMJMOI",214,0)
W ; Write a new msg
"RTN","XMJMOI",215,0)
 N XMSECURE,XMPAKMAN,XMSECBAD  ; Needed!  (In case Write from KIDS msg.)
"RTN","XMJMOI",216,0)
 D SEND^XMJMS
"RTN","XMJMOI",217,0)
 D IMBACK^XMJMOI1(34072) ; Finished with 'Write' command.
"RTN","XMJMOI",218,0)
 Q
"RTN","XMJMOI",219,0)
X ; Xtract PackMan msg
"RTN","XMJMOI",220,0)
 I XMDUZ=.5,XMK>999 G XP
"RTN","XMJMOI",221,0)
 N X,DIC,C,I,ER,J,K,T,X2,XCF,XCM,XCN,XMLOC,XMN,XMP0,XMR,XMS
"RTN","XMJMOI",222,0)
 S X=XMZ,DIC(0)="N"
"RTN","XMJMOI",223,0)
 D MM^XMP
"RTN","XMJMOI",224,0)
 Q
"RTN","XMJMOI",225,0)
XP ; Xmit Priority Toggle (for remote transmit queues only)
"RTN","XMJMOI",226,0)
 N XMTPRI,XMABORT
"RTN","XMJMOI",227,0)
 S XMABORT=0
"RTN","XMJMOI",228,0)
 D ASKPRI^XMJMORX(.XMTPRI,.XMABORT) Q:XMABORT
"RTN","XMJMOI",229,0)
 D XP^XMXMSGS1(XMDUZ,XMK,XMZ,XMTPRI)
"RTN","XMJMOI",230,0)
 Q
"RTN","XMJMOI",231,0)
SAVEMSG(XMDUZ,XMK,XMKN,XMZ,XMSUBJ,XMFROM,XMZBSKT) ;
"RTN","XMJMOI",232,0)
 ; The message is currently in the waste basket or no basket.
"RTN","XMJMOI",233,0)
 ; Save it to an appropriate (not waste) basket.
"RTN","XMJMOI",234,0)
 N XMKTO
"RTN","XMJMOI",235,0)
 S XMKTO=0
"RTN","XMJMOI",236,0)
 D CHEKBSKT^XMTDL2(XMDUZ,.XMKTO,XMSUBJ,XMFROM,$G(XMINSTR("RCPT BSKT")))
"RTN","XMJMOI",237,0)
 S:XMKTO=.5 XMKTO=1
"RTN","XMJMOI",238,0)
 S XMKN=$P(^XMB(3.7,XMDUZ,2,XMKTO,0),U,1)
"RTN","XMJMOI",239,0)
 I 'XMK D
"RTN","XMJMOI",240,0)
 . D PUTMSG^XMXMSGS2(XMDUZ,XMKTO,XMKN,XMZ)
"RTN","XMJMOI",241,0)
 E  D
"RTN","XMJMOI",242,0)
 . ; Message is in waste basket
"RTN","XMJMOI",243,0)
 . D COPYIT^XMXMSGS2(XMDUZ,.5,XMZ,XMKTO)
"RTN","XMJMOI",244,0)
 . D ZAPIT^XMXMSGS2(XMDUZ,.5,XMZ)
"RTN","XMJMOI",245,0)
 S XMK=XMKTO
"RTN","XMJMOI",246,0)
 W !,$$EZBLD^DIALOG(34325.9,XMKN) ; Message saved to _XMKN_ basket.
"RTN","XMJMOI",247,0)
 Q
"RTN","XMJMOI1")
0^295^B18562704
"RTN","XMJMOI1",1,0)
XMJMOI1 ;ISC-SF/GMB-Options at Ignore prompt (cont.) ;05/14/2002  15:28
"RTN","XMJMOI1",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMJMOI1",3,0)
INIT(XMDUZ,XMZ,XMSUBJ,XMFROM,XMORIGN8,XMINSTR,XMRESTR,XMIEN,XMRESPSO,XMRESP) ;
"RTN","XMJMOI1",4,0)
 N XMZREC,XMIM,XMIU
"RTN","XMJMOI1",5,0)
 S XMZREC=^XMB(3.9,XMZ,0)
"RTN","XMJMOI1",6,0)
 D INMSG^XMXUTIL2(XMDUZ,0,XMZ,XMZREC,"I",.XMIM,.XMINSTR,.XMIU)
"RTN","XMJMOI1",7,0)
 S XMSUBJ=XMIM("SUBJ")
"RTN","XMJMOI1",8,0)
 S XMFROM=XMIM("FROM")
"RTN","XMJMOI1",9,0)
 S XMRESPSO=XMIM("RESPS")
"RTN","XMJMOI1",10,0)
 S XMIEN=XMIU("IEN")
"RTN","XMJMOI1",11,0)
 S XMORIGN8=XMIU("ORIGN8")
"RTN","XMJMOI1",12,0)
 S XMRESP=XMIU("RESP")
"RTN","XMJMOI1",13,0)
 D GETRESTR(XMDUZ,XMZ,XMZREC,.XMINSTR,.XMRESTR)
"RTN","XMJMOI1",14,0)
 Q
"RTN","XMJMOI1",15,0)
GETRESTR(XMDUZ,XMZ,XMZREC,XMINSTR,XMRESTR) ;
"RTN","XMJMOI1",16,0)
 D GETRESTR^XMXSEC1(XMDUZ,XMZ,XMZREC,.XMINSTR,.XMRESTR) ; Get restricts
"RTN","XMJMOI1",17,0)
 I $D(XMRESTR("FLAGS")) K XMRESTR("FLAGS") ; We'll have these in XMINSTR("FLAGS"), and they may be changed during user edit.
"RTN","XMJMOI1",18,0)
 Q
"RTN","XMJMOI1",19,0)
IMBACK(XMDIALOG) ;
"RTN","XMJMOI1",20,0)
 W $C(7),!!,$$EZBLD^DIALOG(XMDIALOG),!,$$EZBLD^DIALOG(34075),!! ; Finished.  Now back to:
"RTN","XMJMOI1",21,0)
 D HEADER^XMJMP1(XMDUZ,XMK,XMKN,XMZ,$$ZREAD^XMXUTIL2(XMDUZ,XMZ),^XMB(3.9,XMZ,0),$$EZBLD^DIALOG(34536,XMSUBJ),$$EZBLD^DIALOG(34537,XMZ)) ; Subj: _XMSUBJ / [#_XMZ_]
"RTN","XMJMOI1",22,0)
 Q
"RTN","XMJMOI1",23,0)
PRIORITY ; For priority msgs, ask user if replies should be priority.
"RTN","XMJMOI1",24,0)
 ; Don't ask if the user has already issued a priority toggle,
"RTN","XMJMOI1",25,0)
 ; or if the user has chosen never to be asked.
"RTN","XMJMOI1",26,0)
 Q:XMDUZ=.5&(XMK>999)
"RTN","XMJMOI1",27,0)
 Q:$G(XMSETPRI)!$P(^XMB(3.7,DUZ,0),U,12)
"RTN","XMJMOI1",28,0)
 N DIR,Y,DIRUT
"RTN","XMJMOI1",29,0)
 ;This message is a priority message.
"RTN","XMJMOI1",30,0)
 ;Deliver future responses to this message as Priority Mail
"RTN","XMJMOI1",31,0)
 W !
"RTN","XMJMOI1",32,0)
 S DIR(0)="Y"
"RTN","XMJMOI1",33,0)
 D BLD^DIALOG(34081,"","","DIR(""A"")")
"RTN","XMJMOI1",34,0)
 S DIR("B")=$$EZBLD^DIALOG($S(XMINSTR("FLAGS")["K":39054,1:39053)) ; Yes / No
"RTN","XMJMOI1",35,0)
 S DIR("??")="^D QQPRI^XMJMOI1"
"RTN","XMJMOI1",36,0)
 D ^DIR Q:$D(DIRUT)
"RTN","XMJMOI1",37,0)
 I (XMINSTR("FLAGS")["K"&(Y=0))!(XMINSTR("FLAGS")'["K"&(Y=1)) D K^XMJMOI
"RTN","XMJMOI1",38,0)
 Q
"RTN","XMJMOI1",39,0)
QQPRI ;
"RTN","XMJMOI1",40,0)
 N XMTEXT
"RTN","XMJMOI1",41,0)
 D BLD^DIALOG(34082,"","","XMTEXT","F")
"RTN","XMJMOI1",42,0)
 D MSG^DIALOG("WH","","","","XMTEXT")
"RTN","XMJMOI1",43,0)
 ;Your answer determines, for this message,
"RTN","XMJMOI1",44,0)
 ;how MailMan delivers responses to you.
"RTN","XMJMOI1",45,0)
 ;Note: Recipients can determine for themselves, on a message by message
"RTN","XMJMOI1",46,0)
 ;basis, how responses to priority messages are delivered to them.
"RTN","XMJMOI1",47,0)
 ;It follows that responses to priority messages are not necessarily
"RTN","XMJMOI1",48,0)
 ;delivered as Priority Mail to all recipients.
"RTN","XMJMOI1",49,0)
 Q
"RTN","XMJMOI1",50,0)
RESETXMK(XMDUZ,XMZ,XMK,XMKN) ;
"RTN","XMJMOI1",51,0)
 D BSKT^XMJMP1(XMDUZ,XMZ,.XMK,.XMKN)
"RTN","XMJMOI1",52,0)
 N XMTEXT,XMPARM
"RTN","XMJMOI1",53,0)
 S XMPARM(1)=XMKN,XMPARM(2)=XMV("NAME")
"RTN","XMJMOI1",54,0)
 W !
"RTN","XMJMOI1",55,0)
 D BLD^DIALOG(34068,.XMPARM,"","XMTEXT","F")
"RTN","XMJMOI1",56,0)
 D MSG^DIALOG("WM","","","","XMTEXT")
"RTN","XMJMOI1",57,0)
 W !
"RTN","XMJMOI1",58,0)
 ; This message is now in the '|1|' basket.
"RTN","XMJMOI1",59,0)
 ; Someone acting for |2| must have moved it.
"RTN","XMJMOI1",60,0)
 Q
"RTN","XMJMOI1",61,0)
READSET(XMDUZ,XMK,XMKN,XMZ,XMFROM,XMORIGN8,XMINSTR,XMIEN,XMDIR,XMOPT,XMOX) ;
"RTN","XMJMOI1",62,0)
 N XMIM,XMIU,XMDEF
"RTN","XMJMOI1",63,0)
 S XMIM("FROM")=XMFROM
"RTN","XMJMOI1",64,0)
 S XMIU("ORIGN8")=XMORIGN8
"RTN","XMJMOI1",65,0)
 S XMIU("IEN")=XMIEN
"RTN","XMJMOI1",66,0)
 D OPTMSG^XMXSEC2(XMDUZ,XMK,XMZ,.XMIM,.XMINSTR,.XMIU,.XMOPT,.XMOX,1)
"RTN","XMJMOI1",67,0)
 K XMOPT("QR"),XMOX("X",XMOX("O","QR")),XMOX("O","QR")
"RTN","XMJMOI1",68,0)
 D SET^XMXSEC1("Q xxx",37420.1,.XMOPT,.XMOX) ; Query recipient(s) xxx
"RTN","XMJMOI1",69,0)
 D SET^XMXSEC1("HU",37429,.XMOPT,.XMOX) ; Help:User Information
"RTN","XMJMOI1",70,0)
 D SET^XMXSEC1("HG",37430,.XMOPT,.XMOX) ; Help:Group Information
"RTN","XMJMOI1",71,0)
 D SET^XMXSEC1("BR",37446,.XMOPT,.XMOX) ; Print to the Browser
"RTN","XMJMOI1",72,0)
 I $D(XMOPT("B","?")) S XMOPT("BR","?")=XMOPT("B","?")
"RTN","XMJMOI1",73,0)
 E  I '$$TEST^DDBRT S XMOPT("BR","?")=37446.9 ; The BROWSER device is not selectable from this terminal.
"RTN","XMJMOI1",74,0)
 S XMDIR("A")=$$EZBLD^DIALOG(34065,XMKN) ; Enter message action (in _XMKN_ basket):
"RTN","XMJMOI1",75,0)
 S XMDEF=$S(XMDUZ=.6:"I",XMINSTR("FLAGS")["N":"I",XMK=1:XMV("MSG DEF"),1:"I")
"RTN","XMJMOI1",76,0)
 S XMDIR("B")=XMOX("O",XMDEF)_":"_XMOPT(XMDEF)
"RTN","XMJMOI1",77,0)
 S XMDIR("PRE")="I XMX?1(1"""_XMOX("O","Q")_" "",1"""_$$LOW^XLFSTR(XMOX("O","Q"))_" "",1"""_XMOX("O","QD")_" "",1"""_$$LOW^XLFSTR(XMOX("O","QD"))_" "").E S XMNAME=$P(XMX,"" "",2,99),XMX="""_XMOX("O","QD")_""""
"RTN","XMJMOI1",78,0)
 Q:XMK="!"  ; Super Search (option XM SUPER SEARCH)
"RTN","XMJMOI1",79,0)
 I XMV("NOSEND") D
"RTN","XMJMOI1",80,0)
 . N I
"RTN","XMJMOI1",81,0)
 . F I="A","C","R","W" S XMOPT(I,"?")=37453 ; This session is concurrent with another.  You may not do this.
"RTN","XMJMOI1",82,0)
 E  I $G(XMOPT("A","?"))=37401.1 K XMOPT("A","?") ; You must have a Network Signature to Answer a message.
"RTN","XMJMOI1",83,0)
 D SET^XMXSEC1("RI",37443,.XMOPT,.XMOX) ; Reply and Include responses
"RTN","XMJMOI1",84,0)
 I $D(XMOPT("R","?")) S XMOPT("RI","?")=XMOPT("R","?")
"RTN","XMJMOI1",85,0)
 Q
"RTN","XMJMOIE")
0^296^B9940499
"RTN","XMJMOIE",1,0)
XMJMOIE ;ISC-SF/GMB-Edit msg that user has sent to self ;04/19/2002  11:01
"RTN","XMJMOIE",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMJMOIE",3,0)
EDIT(XMDUZ,XMK,XMZ,XMSUBJ,XMINSTR,XMRESTR) ;
"RTN","XMJMOIE",4,0)
 N XMABORT,XMDIR,XMOPT,XMOX,XMY
"RTN","XMJMOIE",5,0)
 S XMABORT=0
"RTN","XMJMOIE",6,0)
 F  D  Q:XMABORT
"RTN","XMJMOIE",7,0)
 . D SENDSET(.XMINSTR,.XMOPT,.XMOX,.XMDIR)
"RTN","XMJMOIE",8,0)
 . D XMDIR^XMJDIR(.XMDIR,.XMOPT,.XMOX,.XMY,.XMABORT) Q:XMABORT
"RTN","XMJMOIE",9,0)
 . K XMDIR,XMOPT,XMOX
"RTN","XMJMOIE",10,0)
 . D @XMY
"RTN","XMJMOIE",11,0)
 Q
"RTN","XMJMOIE",12,0)
SENDSET(XMINSTR,XMOPT,XMOX,XMDIR) ;
"RTN","XMJMOIE",13,0)
 D OPTEDIT^XMXSEC2(.XMINSTR,.XMOPT,.XMOX,1)
"RTN","XMJMOIE",14,0)
 I $G(XMOPT("NS","?"))=37309.1 K XMOPT("NS","?") ; You have no Network Signature.
"RTN","XMJMOIE",15,0)
 D SET^XMXSEC2("IM",37445,.XMOPT,.XMOX) ; Include responses from another message
"RTN","XMJMOIE",16,0)
 S XMDIR("A")=$$EZBLD^DIALOG(34066) ; Select Edit option:
"RTN","XMJMOIE",17,0)
 S XMDIR("??")="XM-U-MO-EDIT"
"RTN","XMJMOIE",18,0)
 Q
"RTN","XMJMOIE",19,0)
C ; Confidential msg
"RTN","XMJMOIE",20,0)
 N XMMSG
"RTN","XMJMOIE",21,0)
 D CONFID^XMXEDIT(XMZ,.XMINSTR,.XMMSG) I $D(XMERR) D SHOW^XMJERR Q
"RTN","XMJMOIE",22,0)
 W !,XMMSG
"RTN","XMJMOIE",23,0)
 Q
"RTN","XMJMOIE",24,0)
D ; Delivery basket
"RTN","XMJMOIE",25,0)
 N XMMSG
"RTN","XMJMOIE",26,0)
 I $D(XMINSTR("RCPT BSKT")) D  Q
"RTN","XMJMOIE",27,0)
 . D DELIVER^XMXEDIT(XMZ,"@",.XMINSTR,.XMMSG)
"RTN","XMJMOIE",28,0)
 . W !,XMMSG
"RTN","XMJMOIE",29,0)
 D D^XMJMSO
"RTN","XMJMOIE",30,0)
 Q:'$D(XMINSTR("RCPT BSKT"))
"RTN","XMJMOIE",31,0)
 D DELIVER^XMXEDIT(XMZ,XMINSTR("RCPT BSKT"),.XMINSTR,.XMMSG)
"RTN","XMJMOIE",32,0)
 Q
"RTN","XMJMOIE",33,0)
ES ; Edit Subject
"RTN","XMJMOIE",34,0)
 D ES^XMJMSO
"RTN","XMJMOIE",35,0)
 Q
"RTN","XMJMOIE",36,0)
ET ; Edit Text
"RTN","XMJMOIE",37,0)
 I $G(XMPAKMAN) Q:$$NOPAKEDT^XMJMSO
"RTN","XMJMOIE",38,0)
 I $D(XMSECURE) D
"RTN","XMJMOIE",39,0)
 . N XMIA S XMIA=1
"RTN","XMJMOIE",40,0)
 . D DECMSG^XMJMCODE(XMZ)
"RTN","XMJMOIE",41,0)
 D BODY^XMJMS(XMDUZ,XMZ,XMSUBJ,.XMRESTR)
"RTN","XMJMOIE",42,0)
 I $D(XMSECURE) D
"RTN","XMJMOIE",43,0)
 . N XMIA S XMIA=1
"RTN","XMJMOIE",44,0)
 . D ENCMSG^XMJMCODE(XMZ)
"RTN","XMJMOIE",45,0)
 Q
"RTN","XMJMOIE",46,0)
I ; Information only msg
"RTN","XMJMOIE",47,0)
 N XMMSG
"RTN","XMJMOIE",48,0)
 D INFO^XMXEDIT(XMZ,.XMINSTR,.XMMSG)
"RTN","XMJMOIE",49,0)
 W !,XMMSG
"RTN","XMJMOIE",50,0)
 Q
"RTN","XMJMOIE",51,0)
IM ; Include responses from another message
"RTN","XMJMOIE",52,0)
 ;I $G(XMPAKMAN) Q:$$NOPAKEDT^XMJMSO
"RTN","XMJMOIE",53,0)
 I $G(XMPAKMAN) D  Q
"RTN","XMJMOIE",54,0)
 . W !,$$EZBLD^DIALOG(37445.4) ; You may not Include anything into a KIDS or PackMan message.
"RTN","XMJMOIE",55,0)
 I $D(XMSECURE) D
"RTN","XMJMOIE",56,0)
 . N XMIA S XMIA=1
"RTN","XMJMOIE",57,0)
 . D DECMSG^XMJMCODE(XMZ)
"RTN","XMJMOIE",58,0)
 D INCL^XMJMRO(XMDUZ,XMZ,XMZ,XMSUBJ,.XMRESTR,2,.XMABORT)
"RTN","XMJMOIE",59,0)
 I $D(XMSECURE) D
"RTN","XMJMOIE",60,0)
 . N XMIA S XMIA=1
"RTN","XMJMOIE",61,0)
 . D ENCMSG^XMJMCODE(XMZ)
"RTN","XMJMOIE",62,0)
 Q
"RTN","XMJMOIE",63,0)
NS ; Add Network Signature
"RTN","XMJMOIE",64,0)
 D NS^XMJMSO
"RTN","XMJMOIE",65,0)
 Q
"RTN","XMJMOIE",66,0)
P ; Priority msg
"RTN","XMJMOIE",67,0)
 N XMMSG
"RTN","XMJMOIE",68,0)
 D PRIORITY^XMXEDIT(XMZ,.XMINSTR,.XMMSG)
"RTN","XMJMOIE",69,0)
 W !,XMMSG
"RTN","XMJMOIE",70,0)
 Q
"RTN","XMJMOIE",71,0)
R ; Confirm receipt of msg
"RTN","XMJMOIE",72,0)
 N XMMSG
"RTN","XMJMOIE",73,0)
 D CONFIRM^XMXEDIT(XMZ,.XMINSTR,.XMMSG)
"RTN","XMJMOIE",74,0)
 W !,XMMSG
"RTN","XMJMOIE",75,0)
 Q
"RTN","XMJMOIE",76,0)
S ; Scramble msg
"RTN","XMJMOIE",77,0)
 N XMMSG
"RTN","XMJMOIE",78,0)
 I $D(XMSECURE) D  Q
"RTN","XMJMOIE",79,0)
 . D SCRAMBLE^XMXEDIT(XMZ,.XMINSTR,.XMMSG)
"RTN","XMJMOIE",80,0)
 . W !,XMMSG
"RTN","XMJMOIE",81,0)
 D S^XMJMSO
"RTN","XMJMOIE",82,0)
 Q:'$D(XMINSTR("SCR KEY"))
"RTN","XMJMOIE",83,0)
 D SCRAMBLE^XMXEDIT(XMZ,.XMINSTR,.XMMSG)
"RTN","XMJMOIE",84,0)
 Q
"RTN","XMJMOIE",85,0)
V ; Vaporize date
"RTN","XMJMOIE",86,0)
 N XMMSG
"RTN","XMJMOIE",87,0)
 I $G(XMINSTR("VAPOR")) D  Q
"RTN","XMJMOIE",88,0)
 . D VAPOR^XMXEDIT(XMZ,"@",.XMINSTR,.XMMSG)
"RTN","XMJMOIE",89,0)
 . I XMK D KVAPOR^XMXUTIL(XMDUZ,XMK,XMZ,"@")
"RTN","XMJMOIE",90,0)
 . W !,XMMSG
"RTN","XMJMOIE",91,0)
 D V^XMJMSO
"RTN","XMJMOIE",92,0)
 Q:'$D(XMINSTR("VAPOR"))
"RTN","XMJMOIE",93,0)
 I XMK D KVAPOR^XMXUTIL(XMDUZ,XMK,XMZ,XMINSTR("VAPOR"))
"RTN","XMJMOIE",94,0)
 D VAPOR^XMXEDIT(XMZ,XMINSTR("VAPOR"),.XMINSTR,.XMMSG)
"RTN","XMJMOIE",95,0)
 Q
"RTN","XMJMOIE",96,0)
X ; Closed msg
"RTN","XMJMOIE",97,0)
 N XMMSG
"RTN","XMJMOIE",98,0)
 D CLOSED^XMXEDIT(XMZ,.XMINSTR,.XMMSG) I $D(XMERR) D SHOW^XMJERR Q
"RTN","XMJMOIE",99,0)
 W !,XMMSG
"RTN","XMJMOIE",100,0)
 Q
"RTN","XMJMOR")
0^36^B82943223
"RTN","XMJMOR",1,0)
XMJMOR ;ISC-SF/GMB-Range actions ;02/22/2002  14:04
"RTN","XMJMOR",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMJMOR",3,0)
 ; Replaces ^XMA0,^XMA01 (ISC-WASH/CAP)
"RTN","XMJMOR",4,0)
DELETE(XMDUZ,XMK) ; Delete a range of messages
"RTN","XMJMOR",5,0)
 N XMWHICH,XMMSG,XMABORT
"RTN","XMJMOR",6,0)
 S XMABORT=0
"RTN","XMJMOR",7,0)
 I $D(^TMP("XM",$J,".")) D
"RTN","XMJMOR",8,0)
 . D SELMSG^XMJMORX1(XMDUZ,0,0,XMK,"XDEL",34302,34303,.XMMSG,.XMABORT)
"RTN","XMJMOR",9,0)
 . ;K ^TMP("XM",$J,".")
"RTN","XMJMOR",10,0)
 E  D
"RTN","XMJMOR",11,0)
 . D WHICH(XMDUZ,XMK,34301,34303.1,.XMWHICH,.XMABORT) Q:XMABORT
"RTN","XMJMOR",12,0)
 . D DELMSG^XMXMSGS(XMDUZ,XMK,XMWHICH,.XMMSG)
"RTN","XMJMOR",13,0)
 . D:$D(XMERR) ZSHOW^XMJERR
"RTN","XMJMOR",14,0)
 Q:XMABORT
"RTN","XMJMOR",15,0)
 W:$D(XMMSG) !,XMMSG
"RTN","XMJMOR",16,0)
 Q
"RTN","XMJMOR",17,0)
FILTER(XMDUZ,XMK) ; Filter a range of messages
"RTN","XMJMOR",18,0)
 N XMWHICH,XMMSG,XMABORT
"RTN","XMJMOR",19,0)
 S XMABORT=0
"RTN","XMJMOR",20,0)
 I $D(^TMP("XM",$J,".")) D
"RTN","XMJMOR",21,0)
 . N XMKZ
"RTN","XMJMOR",22,0)
 . D SELMSG(XMDUZ,XMK,"XFLTR^XMXMSGS2",34306,.XMMSG)
"RTN","XMJMOR",23,0)
 . S XMKZ=""
"RTN","XMJMOR",24,0)
 . F  S XMKZ=$O(^TMP("XM",$J,".",XMKZ)) Q:'XMKZ  K:'$D(^XMB(3.7,XMDUZ,2,XMK,1,"C",XMKZ)) ^TMP("XM",$J,".",XMKZ)
"RTN","XMJMOR",25,0)
 E  D
"RTN","XMJMOR",26,0)
 . D WHICH(XMDUZ,XMK,34305,0,.XMWHICH,.XMABORT) Q:XMABORT
"RTN","XMJMOR",27,0)
 . D FLTRMSG^XMXMSGS(XMDUZ,XMK,XMWHICH,.XMMSG)
"RTN","XMJMOR",28,0)
 . D:$D(XMERR) ZSHOW^XMJERR
"RTN","XMJMOR",29,0)
 Q:XMABORT
"RTN","XMJMOR",30,0)
 W:$D(XMMSG) !,XMMSG
"RTN","XMJMOR",31,0)
 Q
"RTN","XMJMOR",32,0)
FORWARD(XMDUZ,XMK) ; Forward a range of messages
"RTN","XMJMOR",33,0)
 N XMWHICH,XMMSG,XMABORT,XMINSTR
"RTN","XMJMOR",34,0)
 S XMABORT=0
"RTN","XMJMOR",35,0)
 I $D(^TMP("XM",$J,".")) D  Q
"RTN","XMJMOR",36,0)
 . N XMKZ
"RTN","XMJMOR",37,0)
 . D INIT^XMXADDR
"RTN","XMJMOR",38,0)
 . S XMKZ=$O(^TMP("XM",$J,".",""))
"RTN","XMJMOR",39,0)
 . I '$O(^TMP("XM",$J,".",XMKZ)) D  Q
"RTN","XMJMOR",40,0)
 . . D FWDONE(XMDUZ,$O(^XMB(3.7,XMDUZ,2,XMK,1,"C",XMKZ,"")),.XMINSTR,.XMABORT)
"RTN","XMJMOR",41,0)
 . D TOWHOM^XMJMT(XMDUZ,$$EZBLD^DIALOG(34111),.XMINSTR,"",.XMABORT) Q:XMABORT  ; Forward
"RTN","XMJMOR",42,0)
 . D SELMSG(XMDUZ,XMK,"XFWD^XMXMSGS1",34309,.XMMSG)
"RTN","XMJMOR",43,0)
 . D CLEANUP^XMXADDR
"RTN","XMJMOR",44,0)
 . D:$D(XMERR) ZSHOW^XMJERR
"RTN","XMJMOR",45,0)
 . W:$D(XMMSG) !,XMMSG
"RTN","XMJMOR",46,0)
 D WHICH(XMDUZ,XMK,34308,0,.XMWHICH,.XMABORT) Q:XMABORT
"RTN","XMJMOR",47,0)
 D INIT^XMXADDR
"RTN","XMJMOR",48,0)
 I $P(XMWHICH,",",2,99)="",$P(XMWHICH,",",1)=+XMWHICH D  Q
"RTN","XMJMOR",49,0)
 . N XMZ
"RTN","XMJMOR",50,0)
 . S XMZ=$O(^XMB(3.7,XMDUZ,2,XMK,1,"C",+XMWHICH,""))
"RTN","XMJMOR",51,0)
 . I 'XMZ W !,$$EZBLD^DIALOG(34309.3) Q  ; No messages forwarded.
"RTN","XMJMOR",52,0)
 . D FWDONE(XMDUZ,XMZ,.XMINSTR,.XMABORT)
"RTN","XMJMOR",53,0)
 D TOWHOM^XMJMT(XMDUZ,$$EZBLD^DIALOG(34111),.XMINSTR,"",.XMABORT) Q:XMABORT  ; Forward
"RTN","XMJMOR",54,0)
 S XMINSTR("ADDR FLAGS")="I"
"RTN","XMJMOR",55,0)
 D FWDMSG^XMXMSGS(XMDUZ,XMK,XMWHICH,"",.XMINSTR,.XMMSG)
"RTN","XMJMOR",56,0)
 D:$D(XMERR) ZSHOW^XMJERR
"RTN","XMJMOR",57,0)
 W:$D(XMMSG) !,XMMSG
"RTN","XMJMOR",58,0)
 Q
"RTN","XMJMOR",59,0)
FWDONE(XMDUZ,XMZ,XMINSTR,XMABORT) ; Forward just one message
"RTN","XMJMOR",60,0)
 N XMZREC,XMRESTR
"RTN","XMJMOR",61,0)
 S XMZREC=^XMB(3.9,XMZ,0)
"RTN","XMJMOR",62,0)
 I '$$FORWARD^XMXSEC(XMDUZ,XMZ,XMZREC) D SHOW^XMJERR Q
"RTN","XMJMOR",63,0)
 D GETRESTR^XMXSEC1(XMDUZ,XMZ,XMZREC,"",.XMRESTR) ; Get restrictions on the msg
"RTN","XMJMOR",64,0)
 D TOWHOM^XMJMT(XMDUZ,$$EZBLD^DIALOG(34111),.XMINSTR,.XMRESTR,.XMABORT) Q:XMABORT  ; Forward
"RTN","XMJMOR",65,0)
 D FWD^XMKP(XMDUZ,XMZ,.XMINSTR)
"RTN","XMJMOR",66,0)
 D CLEANUP^XMXADDR
"RTN","XMJMOR",67,0)
 W !,$$EZBLD^DIALOG(34309.2) ; Message forwarded.
"RTN","XMJMOR",68,0)
 Q
"RTN","XMJMOR",69,0)
LATER(XMDUZ,XMK) ; Later a range of messages
"RTN","XMJMOR",70,0)
 N XMWHICH,XMMSG,XMABORT,XMWHEN
"RTN","XMJMOR",71,0)
 S XMABORT=0
"RTN","XMJMOR",72,0)
 I $D(^TMP("XM",$J,".")) D
"RTN","XMJMOR",73,0)
 . D LTRDATE^XMJMD(.XMWHEN,.XMABORT) Q:XMABORT
"RTN","XMJMOR",74,0)
 . D SELMSG(XMDUZ,XMK,"XLATER^XMXMSGS2",34312,.XMMSG)
"RTN","XMJMOR",75,0)
 E  D
"RTN","XMJMOR",76,0)
 . D WHICH(XMDUZ,XMK,34311,0,.XMWHICH,.XMABORT) Q:XMABORT
"RTN","XMJMOR",77,0)
 . D LTRDATE^XMJMD(.XMWHEN,.XMABORT) Q:XMABORT
"RTN","XMJMOR",78,0)
 . D LATERMSG^XMXMSGS(XMDUZ,XMK,XMWHICH,XMWHEN,.XMMSG)
"RTN","XMJMOR",79,0)
 . D:$D(XMERR) ZSHOW^XMJERR
"RTN","XMJMOR",80,0)
 Q:XMABORT
"RTN","XMJMOR",81,0)
 W:$D(XMMSG) !,XMMSG
"RTN","XMJMOR",82,0)
 Q
"RTN","XMJMOR",83,0)
NEWTOGL(XMDUZ,XMK) ; New Toggle a range of messages
"RTN","XMJMOR",84,0)
 N XMWHICH,XMMSG,XMABORT
"RTN","XMJMOR",85,0)
 S XMABORT=0
"RTN","XMJMOR",86,0)
 I $D(^TMP("XM",$J,".")) D
"RTN","XMJMOR",87,0)
 . N XMKZ
"RTN","XMJMOR",88,0)
 . D SELMSG(XMDUZ,XMK,"XNTOGL^XMXMSGS2",34315,.XMMSG)
"RTN","XMJMOR",89,0)
 . S XMKZ=""
"RTN","XMJMOR",90,0)
 . F  S XMKZ=$O(^TMP("XM",$J,".",XMKZ)) Q:'XMKZ  K:'$D(^XMB(3.7,XMDUZ,2,XMK,1,"C",XMKZ)) ^TMP("XM",$J,".",XMKZ)
"RTN","XMJMOR",91,0)
 E  D
"RTN","XMJMOR",92,0)
 . D WHICH(XMDUZ,XMK,34314,0,.XMWHICH,.XMABORT) Q:XMABORT
"RTN","XMJMOR",93,0)
 . D NTOGLMSG^XMXMSGS(XMDUZ,XMK,XMWHICH,.XMMSG)
"RTN","XMJMOR",94,0)
 . D:$D(XMERR) ZSHOW^XMJERR
"RTN","XMJMOR",95,0)
 Q:XMABORT
"RTN","XMJMOR",96,0)
 W:$D(XMMSG) !,XMMSG
"RTN","XMJMOR",97,0)
 Q
"RTN","XMJMOR",98,0)
PRINT(XMDUZ,XMK,XMPRTHDR) ; Print a range of messages
"RTN","XMJMOR",99,0)
 N XMWHICH,XMMSG,XMRECIPS,XMABORT
"RTN","XMJMOR",100,0)
 ; XMPRTHDR 1=Print header
"RTN","XMJMOR",101,0)
 ;          0=don't (headerless print)
"RTN","XMJMOR",102,0)
 ; XMRECIPS 0=Don't print recipients
"RTN","XMJMOR",103,0)
 ;          1=Print summary recipients
"RTN","XMJMOR",104,0)
 ;          2=Print detail recipients
"RTN","XMJMOR",105,0)
 N XMSAVE,XMMSG,XMZLIST,I
"RTN","XMJMOR",106,0)
 S XMABORT=0
"RTN","XMJMOR",107,0)
 S:$G(XMPRTHDR)="" XMPRTHDR=1  ; default is to print with headers
"RTN","XMJMOR",108,0)
 I $D(^TMP("XM",$J,".")) D
"RTN","XMJMOR",109,0)
 . D LISTSEL(XMDUZ,XMK,.XMZLIST)
"RTN","XMJMOR",110,0)
 E  D  Q:XMABORT
"RTN","XMJMOR",111,0)
 . N XMWHICH
"RTN","XMJMOR",112,0)
 . D WHICH(XMDUZ,XMK,$S(XMPRTHDR:34317,1:34317.1),0,.XMWHICH,.XMABORT) Q:XMABORT
"RTN","XMJMOR",113,0)
 . D LIST(XMDUZ,XMK,.XMWHICH,.XMZLIST)
"RTN","XMJMOR",114,0)
 I '$D(XMZLIST) W !!,$$EZBLD^DIALOG(34319) Q  ; No valid messages selected.
"RTN","XMJMOR",115,0)
 I +XMZLIST(1)=XMZLIST(1) D PRTONE(XMDUZ,XMK,XMZLIST(1),XMPRTHDR,.XMABORT) Q
"RTN","XMJMOR",116,0)
 D QRECIP^XMJMP(.XMRECIPS,.XMABORT) Q:XMABORT
"RTN","XMJMOR",117,0)
 F I="DUZ","XMDUZ","XMV(","XMZLIST(","XMRECIPS","XMPRTHDR" S XMSAVE(I)=""
"RTN","XMJMOR",118,0)
 D EN^XUTMDEVQ("PLISTX^XMJMP",$$EZBLD^DIALOG(34501),.XMSAVE) ; MailMan: Print
"RTN","XMJMOR",119,0)
 Q:XMABORT
"RTN","XMJMOR",120,0)
 W:$D(XMMSG) !!,XMMSG
"RTN","XMJMOR",121,0)
 Q
"RTN","XMJMOR",122,0)
LISTSEL(XMDUZ,XMK,XMZLIST) ;
"RTN","XMJMOR",123,0)
 N XMKZ,J,XMZ
"RTN","XMJMOR",124,0)
 S (XMKZ,J)=0
"RTN","XMJMOR",125,0)
 F  S XMKZ=$O(^TMP("XM",$J,".",XMKZ)) Q:'XMKZ  D
"RTN","XMJMOR",126,0)
 . S XMZ=$O(^XMB(3.7,XMDUZ,2,XMK,1,"C",XMKZ,"")) Q:'XMZ
"RTN","XMJMOR",127,0)
 . I J=0 S J=1,XMZLIST(1)=XMZ Q
"RTN","XMJMOR",128,0)
 . I $L(XMZLIST(J))+$L(XMZ)>240 S J=J+1,XMZLIST(J)=XMZ Q
"RTN","XMJMOR",129,0)
 . S XMZLIST(J)=XMZLIST(J)_","_XMZ
"RTN","XMJMOR",130,0)
 Q
"RTN","XMJMOR",131,0)
LIST(XMDUZ,XMK,XMWHICH,XMZLIST) ;
"RTN","XMJMOR",132,0)
 N I,J,XMRANGE,XMKZ,XMZ,XMLAST
"RTN","XMJMOR",133,0)
 S J=0
"RTN","XMJMOR",134,0)
 F I=1:1:$L(XMWHICH,",") D
"RTN","XMJMOR",135,0)
 . S XMRANGE=$P(XMWHICH,",",I)
"RTN","XMJMOR",136,0)
 . Q:'XMRANGE
"RTN","XMJMOR",137,0)
 . S XMKZ=$P(XMRANGE,"-",1)-.1
"RTN","XMJMOR",138,0)
 . S XMLAST=$S(XMRANGE["-":$P(XMRANGE,"-",2),1:XMRANGE)
"RTN","XMJMOR",139,0)
 . F  S XMKZ=$O(^XMB(3.7,XMDUZ,2,XMK,1,"C",XMKZ)) Q:'XMKZ!(XMKZ>XMLAST)  D
"RTN","XMJMOR",140,0)
 . . S XMZ=$O(^XMB(3.7,XMDUZ,2,XMK,1,"C",XMKZ,"")) Q:'XMZ
"RTN","XMJMOR",141,0)
 . . I J=0 S J=1,XMZLIST(1)=XMZ Q
"RTN","XMJMOR",142,0)
 . . I $L(XMZLIST(J))+$L(XMZ)>240 S J=J+1,XMZLIST(J)=XMZ Q
"RTN","XMJMOR",143,0)
 . . S XMZLIST(J)=XMZLIST(J)_","_XMZ
"RTN","XMJMOR",144,0)
 Q
"RTN","XMJMOR",145,0)
PRTONE(XMDUZ,XMK,XMZ,XMPRTHDR,XMABORT) ;
"RTN","XMJMOR",146,0)
 D PONE^XMJMP(XMDUZ,XMK,XMZ,XMPRTHDR,.XMABORT)
"RTN","XMJMOR",147,0)
 W !!,$$EZBLD^DIALOG($S(XMABORT:34318.4,1:34318.1)) ; Message (not) printed.
"RTN","XMJMOR",148,0)
 Q
"RTN","XMJMOR",149,0)
SAVE(XMDUZ,XMK) ; Save a range of messages to another basket
"RTN","XMJMOR",150,0)
 N XMWHICH,XMMSG,XMABORT,XMKTO,XMDIC
"RTN","XMJMOR",151,0)
 S XMABORT=0
"RTN","XMJMOR",152,0)
 S XMDIC("B")="@"  ; no default basket
"RTN","XMJMOR",153,0)
 I $D(^TMP("XM",$J,".")) D
"RTN","XMJMOR",154,0)
 . D SELBSKT^XMJBU(XMDUZ,$$EZBLD^DIALOG(34325),"L",.XMDIC,.XMKTO) ; Save messages to which basket?
"RTN","XMJMOR",155,0)
 . I XMKTO=U S XMMSG=$$EZBLD^DIALOG(34324.3) Q  ; No messages saved.
"RTN","XMJMOR",156,0)
 . I XMKTO=XMK S XMMSG=$$EZBLD^DIALOG(34326) Q  ; Same basket.  No messages saved.
"RTN","XMJMOR",157,0)
 . D SELMSG(XMDUZ,XMK,"XMOVE^XMXMSGS2",34324,.XMMSG)
"RTN","XMJMOR",158,0)
 . K ^TMP("XM",$J,".")
"RTN","XMJMOR",159,0)
 E  D
"RTN","XMJMOR",160,0)
 . D WHICH(XMDUZ,XMK,34323,0,.XMWHICH,.XMABORT) Q:XMABORT
"RTN","XMJMOR",161,0)
 . D SELBSKT^XMJBU(XMDUZ,$$EZBLD^DIALOG(34325),"L",.XMDIC,.XMKTO) ; Save messages to which basket?
"RTN","XMJMOR",162,0)
 . I XMKTO=U S XMMSG=$$EZBLD^DIALOG(34324.3) Q  ; No messages saved.
"RTN","XMJMOR",163,0)
 . I XMKTO=XMK S XMMSG=$$EZBLD^DIALOG(34326) Q  ; Same basket.  No messages saved.
"RTN","XMJMOR",164,0)
 . D MOVEMSG^XMXMSGS(XMDUZ,XMK,XMWHICH,XMKTO,.XMMSG)
"RTN","XMJMOR",165,0)
 . D:$D(XMERR) ZSHOW^XMJERR
"RTN","XMJMOR",166,0)
 Q:XMABORT
"RTN","XMJMOR",167,0)
 W:$D(XMMSG) !,XMMSG
"RTN","XMJMOR",168,0)
 Q
"RTN","XMJMOR",169,0)
TERM(XMDUZ,XMK) ; Terminate a range of messages
"RTN","XMJMOR",170,0)
 N XMWHICH,XMMSG,XMABORT
"RTN","XMJMOR",171,0)
 S XMABORT=0
"RTN","XMJMOR",172,0)
 I $D(^TMP("XM",$J,".")) D
"RTN","XMJMOR",173,0)
 . D SELMSG^XMJMORX1(XMDUZ,0,0,XMK,"XTERM",34329,34330,.XMMSG,.XMABORT)
"RTN","XMJMOR",174,0)
 . ;K ^TMP("XM",$J,".")
"RTN","XMJMOR",175,0)
 E  D
"RTN","XMJMOR",176,0)
 . D WHICH(XMDUZ,XMK,34328,34330.1,.XMWHICH,.XMABORT) Q:XMABORT
"RTN","XMJMOR",177,0)
 . D TERMMSG^XMXMSGS(XMDUZ,XMK,XMWHICH,.XMMSG)
"RTN","XMJMOR",178,0)
 . D:$D(XMERR) ZSHOW^XMJERR
"RTN","XMJMOR",179,0)
 Q:XMABORT
"RTN","XMJMOR",180,0)
 Q:'$D(XMMSG)
"RTN","XMJMOR",181,0)
 W !,XMMSG
"RTN","XMJMOR",182,0)
 I XMMSG W !,$$EZBLD^DIALOG($S(XMK<1:34331.1,1:34331)) ; You won't see future responses.  (In WASTE basket)
"RTN","XMJMOR",183,0)
 Q
"RTN","XMJMOR",184,0)
VAPOR(XMDUZ,XMK) ; Set Vaporize date for a range of messages
"RTN","XMJMOR",185,0)
 N XMWHICH,XMMSG,XMABORT,XMWHEN
"RTN","XMJMOR",186,0)
 S XMABORT=0
"RTN","XMJMOR",187,0)
 I $D(^TMP("XM",$J,".")) D
"RTN","XMJMOR",188,0)
 . D VAPRDATE(.XMWHEN,.XMABORT) Q:XMABORT
"RTN","XMJMOR",189,0)
 . D SELMSG^XMJMORX1(XMDUZ,0,0,XMK,"XVAPOR^XMXMSGS2",$S(XMWHEN="@":34337.2,1:34337),$S(XMWHEN="@":34338.2,1:34338),.XMMSG,.XMABORT)
"RTN","XMJMOR",190,0)
 E  D
"RTN","XMJMOR",191,0)
 . D VAPRDATE(.XMWHEN,.XMABORT) Q:XMABORT
"RTN","XMJMOR",192,0)
 . D WHICH(XMDUZ,XMK,$S(XMWHEN="@":34336.1,1:34336),$S(XMWHEN="@":34338.3,1:34338.1),.XMWHICH,.XMABORT) Q:XMABORT
"RTN","XMJMOR",193,0)
 . D VAPORMSG^XMXMSGS(XMDUZ,XMK,XMWHICH,XMWHEN,.XMMSG)
"RTN","XMJMOR",194,0)
 . D:$D(XMERR) ZSHOW^XMJERR
"RTN","XMJMOR",195,0)
 Q:XMABORT
"RTN","XMJMOR",196,0)
 W:$D(XMMSG) !,XMMSG
"RTN","XMJMOR",197,0)
 Q
"RTN","XMJMOR",198,0)
VAPRDATE(XMWHEN,XMABORT) ;
"RTN","XMJMOR",199,0)
 N DIR,X,Y
"RTN","XMJMOR",200,0)
 S DIR(0)="DO^NOW::EFT"
"RTN","XMJMOR",201,0)
 D BLD^DIALOG(37317.1,"","","DIR(""A"")")
"RTN","XMJMOR",202,0)
 D BLD^DIALOG(34339,"","","DIR(""?"")")
"RTN","XMJMOR",203,0)
 D ^DIR
"RTN","XMJMOR",204,0)
 I X="@" S XMWHEN="@" Q
"RTN","XMJMOR",205,0)
 I $D(DIRUT) S XMABORT=1 Q
"RTN","XMJMOR",206,0)
 S XMWHEN=Y
"RTN","XMJMOR",207,0)
 Q
"RTN","XMJMOR",208,0)
XMTPRI(XMDUZ,XMK) ; Toggle transmission priority for a range of msgs
"RTN","XMJMOR",209,0)
 ; XMDUZ better be .5 and XMK better be > 999!
"RTN","XMJMOR",210,0)
 N XMTPRI,XMWHICH,XMMSG,XMABORT
"RTN","XMJMOR",211,0)
 S XMABORT=0
"RTN","XMJMOR",212,0)
 I $D(^TMP("XM",$J,".")) D
"RTN","XMJMOR",213,0)
 . D ASKPRI^XMJMORX(.XMTPRI,.XMABORT) Q:XMABORT
"RTN","XMJMOR",214,0)
 . D SELMSG^XMJMORX1(XMDUZ,0,0,XMK,"XXP^XMXMSGS1",34334,34335,.XMMSG,.XMABORT)
"RTN","XMJMOR",215,0)
 E  D
"RTN","XMJMOR",216,0)
 . D WHICH(XMDUZ,XMK,34333,34335.1,.XMWHICH,.XMABORT) Q:XMABORT
"RTN","XMJMOR",217,0)
 . D ASKPRI^XMJMORX(.XMTPRI,.XMABORT) Q:XMABORT
"RTN","XMJMOR",218,0)
 . D XPMSG^XMXMSGS(XMDUZ,XMK,XMWHICH,XMTPRI,.XMMSG)
"RTN","XMJMOR",219,0)
 . D:$D(XMERR) ZSHOW^XMJERR
"RTN","XMJMOR",220,0)
 Q:XMABORT
"RTN","XMJMOR",221,0)
 W:$D(XMMSG) !,XMMSG
"RTN","XMJMOR",222,0)
 Q
"RTN","XMJMOR",223,0)
WHICH(XMDUZ,XMK,XMPROMPT,XMCONFRM,XMWHICH,XMABORT) ;
"RTN","XMJMOR",224,0)
 N DIR,X,Y,XMHI,XMLO
"RTN","XMJMOR",225,0)
 S XMLO=$O(^XMB(3.7,XMDUZ,2,XMK,1,"C",""))
"RTN","XMJMOR",226,0)
 S XMHI=$O(^XMB(3.7,XMDUZ,2,XMK,1,"C",""),-1)
"RTN","XMJMOR",227,0)
 S DIR("A")=$$EZBLD^DIALOG(XMPROMPT) ; ... which messages?
"RTN","XMJMOR",228,0)
 S DIR("??")="XM-U-M-CHOOSE RANGE"
"RTN","XMJMOR",229,0)
 S DIR(0)="LC^"_XMLO_":"_XMHI
"RTN","XMJMOR",230,0)
 D ^DIR I $D(DIRUT) S XMABORT=1 Q
"RTN","XMJMOR",231,0)
 S XMWHICH=Y
"RTN","XMJMOR",232,0)
 I XMCONFRM D CONFIRM(XMCONFRM,.XMABORT)
"RTN","XMJMOR",233,0)
 Q
"RTN","XMJMOR",234,0)
CONFIRM(XMCONFRM,XMABORT) ;
"RTN","XMJMOR",235,0)
 N DIR
"RTN","XMJMOR",236,0)
 D BLD^DIALOG(XMCONFRM,"","","DIR(""A"")") ; Do you really want to ... these messages?
"RTN","XMJMOR",237,0)
 S DIR("B")=$$EZBLD^DIALOG(39053) ; No
"RTN","XMJMOR",238,0)
 S DIR(0)="Y"
"RTN","XMJMOR",239,0)
 D ^DIR I $D(DIRUT)!'Y S XMABORT=1
"RTN","XMJMOR",240,0)
 Q
"RTN","XMJMOR",241,0)
POSTPRIV() ;
"RTN","XMJMOR",242,0)
 Q:$$POSTPRIV^XMXSEC 1
"RTN","XMJMOR",243,0)
 D SHOW^XMJERR
"RTN","XMJMOR",244,0)
 Q 0
"RTN","XMJMOR",245,0)
SELMSG(XMDUZ,XMK,XMRTN,XMSUM,XMMSG) ;
"RTN","XMJMOR",246,0)
 N XMCNT,XMKZ,XMZ,XMKALL
"RTN","XMJMOR",247,0)
 S (XMCNT,XMKZ)=0
"RTN","XMJMOR",248,0)
 F  S XMKZ=$O(^TMP("XM",$J,".",XMKZ)) Q:'XMKZ  D
"RTN","XMJMOR",249,0)
 . S XMZ=$O(^XMB(3.7,XMDUZ,2,XMK,1,"C",XMKZ,"")) Q:'XMZ
"RTN","XMJMOR",250,0)
 . D @XMRTN
"RTN","XMJMOR",251,0)
 S XMMSG=$$EZBLD^DIALOG($S(XMCNT=1:XMSUM+.1,1:XMSUM),XMCNT)
"RTN","XMJMOR",252,0)
 D INCRDECR^XMXMSGS(XMDUZ,.XMCNT)
"RTN","XMJMOR",253,0)
 Q
"RTN","XMJMORX")
0^37^B63081012
"RTN","XMJMORX",1,0)
XMJMORX ;ISC-SF/GMB-Range actions for ^TMP message lists ;03/11/2002  08:12
"RTN","XMJMORX",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMJMORX",3,0)
 ; Similar to ^XMJMOR
"RTN","XMJMORX",4,0)
DELETE(XMDUZ,XMKALL,XMK) ; Delete
"RTN","XMJMORX",5,0)
 N XMMSG,XMABORT
"RTN","XMJMORX",6,0)
 S XMABORT=0
"RTN","XMJMORX",7,0)
 I $D(^TMP("XM",$J,".")) D
"RTN","XMJMORX",8,0)
 . D SELMSG^XMJMORX1(XMDUZ,1,XMKALL,XMK,"XDEL",34302,34303,.XMMSG,.XMABORT)
"RTN","XMJMORX",9,0)
 . ;K:'XMKALL ^TMP("XM",$J,".")
"RTN","XMJMORX",10,0)
 E  D
"RTN","XMJMORX",11,0)
 . D ACTWHICH^XMJMORX1(XMDUZ,1,XMKALL,XMK,"XDEL",34301,34302,34303.1,.XMMSG,.XMABORT)
"RTN","XMJMORX",12,0)
 Q:XMABORT
"RTN","XMJMORX",13,0)
 W:$D(XMMSG) !,XMMSG
"RTN","XMJMORX",14,0)
 Q
"RTN","XMJMORX",15,0)
FILTER(XMDUZ,XMKALL,XMK) ; Filter
"RTN","XMJMORX",16,0)
 N XMMSG,XMABORT
"RTN","XMJMORX",17,0)
 S XMABORT=0
"RTN","XMJMORX",18,0)
 I $D(^TMP("XM",$J,".")) D
"RTN","XMJMORX",19,0)
 . D SELMSG^XMJMORX1(XMDUZ,1,XMKALL,XMK,"XFLTR",34306,0,.XMMSG)
"RTN","XMJMORX",20,0)
 E  D
"RTN","XMJMORX",21,0)
 . D ACTWHICH^XMJMORX1(XMDUZ,1,XMKALL,XMK,"XFLTR",34305,34306,0,.XMMSG,.XMABORT)
"RTN","XMJMORX",22,0)
 Q:XMABORT
"RTN","XMJMORX",23,0)
 W:$D(XMMSG) !,XMMSG
"RTN","XMJMORX",24,0)
 Q
"RTN","XMJMORX",25,0)
FORWARD(XMDUZ,XMKALL,XMK) ; Forward
"RTN","XMJMORX",26,0)
 N XMWHICH,XMMSG,XMABORT,XMINSTR
"RTN","XMJMORX",27,0)
 S XMABORT=0
"RTN","XMJMORX",28,0)
 I $D(^TMP("XM",$J,".")) D  Q
"RTN","XMJMORX",29,0)
 . N XMKZ
"RTN","XMJMORX",30,0)
 . D INIT^XMXADDR
"RTN","XMJMORX",31,0)
 . S XMKZ=$O(^TMP("XM",$J,".",""))
"RTN","XMJMORX",32,0)
 . I '$O(^TMP("XM",$J,".",XMKZ)) D  Q
"RTN","XMJMORX",33,0)
 . . D FWDONE^XMJMOR(XMDUZ,$P(^TMP("XM",$J,"MSG",XMKZ),U,3),.XMINSTR,.XMABORT)
"RTN","XMJMORX",34,0)
 . D TOWHOM^XMJMT(XMDUZ,$$EZBLD^DIALOG(34111),.XMINSTR,"",.XMABORT) Q:XMABORT  ; Forward
"RTN","XMJMORX",35,0)
 . D SELMSG^XMJMORX1(XMDUZ,1,XMKALL,XMK,"XFWD^XMXMSGS1",34309,0,.XMMSG)
"RTN","XMJMORX",36,0)
 . D CLEANUP^XMXADDR
"RTN","XMJMORX",37,0)
 . I $D(XMERR) D ZSHOW^XMJERR
"RTN","XMJMORX",38,0)
 . W:$D(XMMSG) !,XMMSG
"RTN","XMJMORX",39,0)
 D WHICH^XMJMORX1(34308,0,.XMWHICH,.XMABORT) Q:XMABORT
"RTN","XMJMORX",40,0)
 D INIT^XMXADDR
"RTN","XMJMORX",41,0)
 I $P(XMWHICH,",",2,99)="",$P(XMWHICH,",",1)=+XMWHICH D  Q
"RTN","XMJMORX",42,0)
 . N XMZ
"RTN","XMJMORX",43,0)
 . S XMZ=$P($G(^TMP("XM",$J,"MSG",+XMWHICH)),U,3)
"RTN","XMJMORX",44,0)
 . I 'XMZ W !,$$EZBLD^DIALOG(34309.3) Q  ; No messages forwarded.
"RTN","XMJMORX",45,0)
 . D FWDONE^XMJMOR(XMDUZ,XMZ,.XMINSTR,.XMABORT)
"RTN","XMJMORX",46,0)
 D TOWHOM^XMJMT(XMDUZ,$$EZBLD^DIALOG(34111),.XMINSTR,"",.XMABORT) Q:XMABORT  ; Forward
"RTN","XMJMORX",47,0)
 D ACTMSG^XMJMORX1(XMDUZ,1,XMKALL,XMK,XMWHICH,"XFWD^XMXMSGS1",34309,.XMMSG)
"RTN","XMJMORX",48,0)
 D CLEANUP^XMXADDR
"RTN","XMJMORX",49,0)
 I $D(XMERR) D ZSHOW^XMJERR
"RTN","XMJMORX",50,0)
 W:$D(XMMSG) !,XMMSG
"RTN","XMJMORX",51,0)
 Q
"RTN","XMJMORX",52,0)
LATER(XMDUZ,XMKALL,XMK) ; Later
"RTN","XMJMORX",53,0)
 N XMWHICH,XMMSG,XMABORT,XMWHEN
"RTN","XMJMORX",54,0)
 S XMABORT=0
"RTN","XMJMORX",55,0)
 I $D(^TMP("XM",$J,".")) D
"RTN","XMJMORX",56,0)
 . D LTRDATE^XMJMD(.XMWHEN,.XMABORT) Q:XMABORT
"RTN","XMJMORX",57,0)
 . D SELMSG^XMJMORX1(XMDUZ,1,XMKALL,XMK,"XLATER^XMXMSGS2",34312,0,.XMMSG)
"RTN","XMJMORX",58,0)
 E  D
"RTN","XMJMORX",59,0)
 . D WHICH^XMJMORX1(34311,0,.XMWHICH,.XMABORT) Q:XMABORT
"RTN","XMJMORX",60,0)
 . D LTRDATE^XMJMD(.XMWHEN,.XMABORT) Q:XMABORT
"RTN","XMJMORX",61,0)
 . D ACTMSG^XMJMORX1(XMDUZ,1,XMKALL,XMK,XMWHICH,"XLATER^XMXMSGS2",34312,.XMMSG)
"RTN","XMJMORX",62,0)
 Q:XMABORT
"RTN","XMJMORX",63,0)
 W:$D(XMMSG) !,XMMSG
"RTN","XMJMORX",64,0)
 Q
"RTN","XMJMORX",65,0)
NEWTOGL(XMDUZ,XMKALL,XMK) ; New Toggle
"RTN","XMJMORX",66,0)
 N XMMSG,XMABORT
"RTN","XMJMORX",67,0)
 S XMABORT=0
"RTN","XMJMORX",68,0)
 I $D(^TMP("XM",$J,".")) D
"RTN","XMJMORX",69,0)
 . D SELMSG^XMJMORX1(XMDUZ,1,XMKALL,XMK,"XNTOGL",34315,0,.XMMSG)
"RTN","XMJMORX",70,0)
 E  D
"RTN","XMJMORX",71,0)
 . D ACTWHICH^XMJMORX1(XMDUZ,1,XMKALL,XMK,"XNTOGL",34314,34315,0,.XMMSG,.XMABORT)
"RTN","XMJMORX",72,0)
 Q:XMABORT
"RTN","XMJMORX",73,0)
 W:$D(XMMSG) !,XMMSG
"RTN","XMJMORX",74,0)
 Q
"RTN","XMJMORX",75,0)
PRINT(XMDUZ,XMPRTHDR) ; Print (Needs XMTYPE)
"RTN","XMJMORX",76,0)
 N XMRECIPS,XMABORT,XMSAVE,XMMSG,XMWHICH,XMZLIST,I
"RTN","XMJMORX",77,0)
 ; XMPRTHDR 1=Print header
"RTN","XMJMORX",78,0)
 ;          0=don't (headerless print)
"RTN","XMJMORX",79,0)
 ; XMRECIPS 0=Don't print recipients
"RTN","XMJMORX",80,0)
 ;          1=Print summary recipients
"RTN","XMJMORX",81,0)
 ;          2=Print detail recipients
"RTN","XMJMORX",82,0)
 S XMABORT=0
"RTN","XMJMORX",83,0)
 S:$G(XMPRTHDR)="" XMPRTHDR=1  ; default is to print with headers
"RTN","XMJMORX",84,0)
 I $D(^TMP("XM",$J,".")) D
"RTN","XMJMORX",85,0)
 . D LISTSEL(.XMZLIST)
"RTN","XMJMORX",86,0)
 E  D  Q:XMABORT
"RTN","XMJMORX",87,0)
 . D WHICH^XMJMORX1($S(XMPRTHDR:34317,1:34317.1),0,.XMWHICH,.XMABORT) Q:XMABORT
"RTN","XMJMORX",88,0)
 . D LIST(.XMWHICH,.XMZLIST)
"RTN","XMJMORX",89,0)
 I '$D(XMZLIST) W !!,$$EZBLD^DIALOG(34319) Q  ; No valid messages selected.
"RTN","XMJMORX",90,0)
 I +XMZLIST(1)=XMZLIST(1) D
"RTN","XMJMORX",91,0)
 . D PRTONE^XMJMOR(XMDUZ,$$BSKT^XMXUTIL2(XMDUZ,XMZLIST(1)),XMZLIST(1),XMPRTHDR,.XMABORT)
"RTN","XMJMORX",92,0)
 E  D
"RTN","XMJMORX",93,0)
 . D QRECIP^XMJMP(.XMRECIPS,.XMABORT) Q:XMABORT
"RTN","XMJMORX",94,0)
 . F I="DUZ","XMDUZ","XMV(","XMZLIST(","XMRECIPS","XMPRTHDR" S XMSAVE(I)=""
"RTN","XMJMORX",95,0)
 . D EN^XUTMDEVQ("PLISTX^XMJMP",$$EZBLD^DIALOG(34501),.XMSAVE) ; MailMan: Print
"RTN","XMJMORX",96,0)
 . W:$D(XMMSG) !!,XMMSG
"RTN","XMJMORX",97,0)
 Q:$G(XMTYPE)'["N"!XMABORT
"RTN","XMJMORX",98,0)
 N XMKZ,XMZ,XMRANGE
"RTN","XMJMORX",99,0)
 I $D(^TMP("XM",$J,".")) D  Q
"RTN","XMJMORX",100,0)
 . S XMKZ=""
"RTN","XMJMORX",101,0)
 . F  S XMKZ=$O(^TMP("XM",$J,".",XMKZ)) Q:'XMKZ  D
"RTN","XMJMORX",102,0)
 . . S XMZ=$P(^TMP("XM",$J,"MSG",XMKZ),U,3)
"RTN","XMJMORX",103,0)
 . . Q:$D(^XMB(3.7,XMDUZ,XMTYPE,XMK,XMZ))
"RTN","XMJMORX",104,0)
 . . K ^TMP("XM",$J,"MSG",XMKZ)
"RTN","XMJMORX",105,0)
 . . K ^TMP("XM",$J,".",XMKZ)
"RTN","XMJMORX",106,0)
 F I=1:1:$L(XMWHICH,",") D
"RTN","XMJMORX",107,0)
 . S XMRANGE=$P(XMWHICH,",",I)
"RTN","XMJMORX",108,0)
 . Q:'XMRANGE
"RTN","XMJMORX",109,0)
 . F XMKZ=$P(XMRANGE,"-",1):1:$S(XMRANGE["-":$P(XMRANGE,"-",2),1:XMRANGE) D
"RTN","XMJMORX",110,0)
 . . Q:'$D(^TMP("XM",$J,"MSG",XMKZ))
"RTN","XMJMORX",111,0)
 . . S XMZ=$P(^TMP("XM",$J,"MSG",XMKZ),U,3)
"RTN","XMJMORX",112,0)
 . . K:'$D(^XMB(3.7,XMDUZ,XMTYPE,XMK,XMZ)) ^TMP("XM",$J,"MSG",XMKZ)
"RTN","XMJMORX",113,0)
 Q
"RTN","XMJMORX",114,0)
LISTSEL(XMZLIST) ;
"RTN","XMJMORX",115,0)
 N XMKZ,J,XMZ
"RTN","XMJMORX",116,0)
 S (XMKZ,J)=0
"RTN","XMJMORX",117,0)
 F  S XMKZ=$O(^TMP("XM",$J,".",XMKZ)) Q:'XMKZ  D
"RTN","XMJMORX",118,0)
 . S XMZ=$P(^TMP("XM",$J,"MSG",XMKZ),U,3)
"RTN","XMJMORX",119,0)
 . I J=0 S J=1,XMZLIST(1)=XMZ Q
"RTN","XMJMORX",120,0)
 . I $L(XMZLIST(J))+$L(XMZ)>240 S J=J+1,XMZLIST(J)=XMZ Q
"RTN","XMJMORX",121,0)
 . S XMZLIST(J)=XMZLIST(J)_","_XMZ
"RTN","XMJMORX",122,0)
 Q
"RTN","XMJMORX",123,0)
LIST(XMWHICH,XMZLIST) ;
"RTN","XMJMORX",124,0)
 N I,J,XMRANGE,XMKZ,XMZ
"RTN","XMJMORX",125,0)
 S J=0
"RTN","XMJMORX",126,0)
 F I=1:1:$L(XMWHICH,",") D
"RTN","XMJMORX",127,0)
 . S XMRANGE=$P(XMWHICH,",",I)
"RTN","XMJMORX",128,0)
 . Q:'XMRANGE
"RTN","XMJMORX",129,0)
 . F XMKZ=$P(XMRANGE,"-",1):1:$S(XMRANGE["-":$P(XMRANGE,"-",2),1:XMRANGE) D
"RTN","XMJMORX",130,0)
 . . S XMZ=$P($G(^TMP("XM",$J,"MSG",XMKZ)),U,3) Q:'XMZ
"RTN","XMJMORX",131,0)
 . . I J=0 S J=1,XMZLIST(1)=XMZ Q
"RTN","XMJMORX",132,0)
 . . I $L(XMZLIST(J))+$L(XMZ)>240 S J=J+1,XMZLIST(J)=XMZ Q
"RTN","XMJMORX",133,0)
 . . S XMZLIST(J)=XMZLIST(J)_","_XMZ
"RTN","XMJMORX",134,0)
 Q
"RTN","XMJMORX",135,0)
SAVE(XMDUZ,XMKALL,XMK) ; Save a range of messages to another basket
"RTN","XMJMORX",136,0)
 N XMWHICH,XMMSG,XMABORT,XMKTO,XMDIC,XMKNTO
"RTN","XMJMORX",137,0)
 S XMABORT=0
"RTN","XMJMORX",138,0)
 S XMDIC("B")="@" ; no default bskt
"RTN","XMJMORX",139,0)
 I $D(^TMP("XM",$J,".")) D
"RTN","XMJMORX",140,0)
 . D SELBSKT^XMJBU(XMDUZ,$$EZBLD^DIALOG(34325),"L",.XMDIC,.XMKTO,.XMKNTO) I XMKTO=U S XMABORT=1 Q  ; Save messages to which basket?
"RTN","XMJMORX",141,0)
 . I 'XMKALL,XMKTO=XMK S XMMSG=$$EZBLD^DIALOG(34326) Q  ; Same basket.  No messages saved.
"RTN","XMJMORX",142,0)
 . D SELMSG^XMJMORX1(XMDUZ,1,XMKALL,XMK,"XSAVE",34324,0,.XMMSG)
"RTN","XMJMORX",143,0)
 . K:'XMKALL ^TMP("XM",$J,".")
"RTN","XMJMORX",144,0)
 E  D
"RTN","XMJMORX",145,0)
 . D WHICH^XMJMORX1(34323,0,.XMWHICH,.XMABORT) Q:XMABORT
"RTN","XMJMORX",146,0)
 . D SELBSKT^XMJBU(XMDUZ,$$EZBLD^DIALOG(34325),"L",.XMDIC,.XMKTO,.XMKNTO) ; Save messages to which basket?
"RTN","XMJMORX",147,0)
 . I XMKTO=U S XMABORT=1 Q
"RTN","XMJMORX",148,0)
 . I 'XMKALL,XMKTO=XMK S XMMSG=$$EZBLD^DIALOG(34326) Q  ; Same basket.  No messages saved.
"RTN","XMJMORX",149,0)
 . D ACTMSG^XMJMORX1(XMDUZ,1,XMKALL,XMK,XMWHICH,"XSAVE",34324,.XMMSG)
"RTN","XMJMORX",150,0)
 Q:XMABORT
"RTN","XMJMORX",151,0)
 W:$D(XMMSG) !,XMMSG
"RTN","XMJMORX",152,0)
 Q
"RTN","XMJMORX",153,0)
TERM(XMDUZ,XMKALL,XMK) ; Terminate a range of messages
"RTN","XMJMORX",154,0)
 N XMMSG,XMABORT
"RTN","XMJMORX",155,0)
 S XMABORT=0
"RTN","XMJMORX",156,0)
 I $D(^TMP("XM",$J,".")) D
"RTN","XMJMORX",157,0)
 . D SELMSG^XMJMORX1(XMDUZ,1,XMKALL,XMK,"XTERM",34329,34330,.XMMSG,.XMABORT)
"RTN","XMJMORX",158,0)
 . ;K:'XMKALL ^TMP("XM",$J,".")
"RTN","XMJMORX",159,0)
 E  D
"RTN","XMJMORX",160,0)
 . D ACTWHICH^XMJMORX1(XMDUZ,1,XMKALL,XMK,"XTERM",34328,34329,34330.1,.XMMSG,.XMABORT)
"RTN","XMJMORX",161,0)
 Q:XMABORT
"RTN","XMJMORX",162,0)
 Q:'$D(XMMSG)
"RTN","XMJMORX",163,0)
 W !,XMMSG
"RTN","XMJMORX",164,0)
 I XMMSG W !,$$EZBLD^DIALOG($S(XMK<1:34331.1,1:34331)) ; You won't see future responses.  (In WASTE basket)
"RTN","XMJMORX",165,0)
 Q
"RTN","XMJMORX",166,0)
VAPOR(XMDUZ,XMKALL,XMK) ; Set vaporize date for a range of messages
"RTN","XMJMORX",167,0)
 N XMWHICH,XMMSG,XMABORT,XMWHEN
"RTN","XMJMORX",168,0)
 S XMABORT=0
"RTN","XMJMORX",169,0)
 I $D(^TMP("XM",$J,".")) D
"RTN","XMJMORX",170,0)
 . D VAPRDATE^XMJMOR(.XMWHEN,.XMABORT) Q:XMABORT
"RTN","XMJMORX",171,0)
 . D SELMSG^XMJMORX1(XMDUZ,1,XMKALL,XMK,"XVAPOR^XMXMSGS2",$S(XMWHEN="@":34337.2,1:34337),$S(XMWHEN="@":34338.2,1:34338),.XMMSG)
"RTN","XMJMORX",172,0)
 E  D
"RTN","XMJMORX",173,0)
 . D VAPRDATE^XMJMOR(.XMWHEN,.XMABORT) Q:XMABORT
"RTN","XMJMORX",174,0)
 . D WHICH^XMJMORX1($S(XMWHEN="@":34336.1,1:34336),$S(XMWHEN="@":34338.3,1:34338.1),.XMWHICH,.XMABORT) Q:XMABORT
"RTN","XMJMORX",175,0)
 . D ACTMSG^XMJMORX1(XMDUZ,1,XMKALL,XMK,XMWHICH,"XVAPOR^XMXMSGS2",34337,.XMMSG)
"RTN","XMJMORX",176,0)
 Q:XMABORT
"RTN","XMJMORX",177,0)
 W:$D(XMMSG) !,XMMSG
"RTN","XMJMORX",178,0)
 Q
"RTN","XMJMORX",179,0)
XMTPRI(XMDUZ,XMKALL,XMK) ; Toggle transmit priority
"RTN","XMJMORX",180,0)
 ; XMDUZ better be .5 and XMK better be > 1000!
"RTN","XMJMORX",181,0)
 N XMTPRI,XMWHICH,XMMSG,XMABORT
"RTN","XMJMORX",182,0)
 S XMABORT=0
"RTN","XMJMORX",183,0)
 I $D(^TMP("XM",$J,".")) D
"RTN","XMJMORX",184,0)
 . D ASKPRI(.XMTPRI,.XMABORT) Q:XMABORT
"RTN","XMJMORX",185,0)
 . D SELMSG^XMJMORX1(XMDUZ,1,XMKALL,XMK,"XXP^XMXMSGS1",34334,34335,.XMMSG,.XMABORT)
"RTN","XMJMORX",186,0)
 E  D
"RTN","XMJMORX",187,0)
 . D WHICH^XMJMORX1(34333,34335.1,.XMWHICH,.XMABORT) Q:XMABORT
"RTN","XMJMORX",188,0)
 . D ASKPRI(.XMTPRI,.XMABORT) Q:XMABORT
"RTN","XMJMORX",189,0)
 . D ACTMSG^XMJMORX1(XMDUZ,1,XMKALL,XMK,XMWHICH,"XXP^XMXMSGS1",34334,.XMMSGT)
"RTN","XMJMORX",190,0)
 Q:XMABORT
"RTN","XMJMORX",191,0)
 W:$D(XMMSG) !,XMMSG
"RTN","XMJMORX",192,0)
 Q
"RTN","XMJMORX",193,0)
ASKPRI(XMTPRI,XMABORT) ;
"RTN","XMJMORX",194,0)
 N XMTXT,XMOPT,XMOX,XMDIR
"RTN","XMJMORX",195,0)
 D SET^XMXSEC1("H",34332.3,.XMOPT,.XMOX) ; H:High
"RTN","XMJMORX",196,0)
 D SET^XMXSEC1("L",34332.1,.XMOPT,.XMOX) ; L:Low
"RTN","XMJMORX",197,0)
 D SET^XMXSEC1("N",34332.2,.XMOPT,.XMOX) ; N:Normal
"RTN","XMJMORX",198,0)
 S XMDIR("A")=$$EZBLD^DIALOG(34332) ; Select transmit priority:
"RTN","XMJMORX",199,0)
 I $G(XMTPRI)'="" D
"RTN","XMJMORX",200,0)
 . S XMTXT=XMOPT(XMTPRI)
"RTN","XMJMORX",201,0)
 . S XMDIR("B")=XMOX("O",XMTPRI)_":"_XMTXT
"RTN","XMJMORX",202,0)
 S XMDIR("??")="XM-U-B-XMIT PRIORITY TOGGLE"
"RTN","XMJMORX",203,0)
 D XMDIR^XMJDIR(.XMDIR,.XMOPT,.XMOX,.XMTPRI,.XMABORT) Q:XMABORT
"RTN","XMJMORX",204,0)
 S XMTPRI=$S(XMTPRI="N":0,XMTPRI="H":1,1:2)
"RTN","XMJMORX",205,0)
 Q
"RTN","XMJMORX1")
0^297^B30705892
"RTN","XMJMORX1",1,0)
XMJMORX1 ;ISC-SF/GMB-^XMJMORX (cont.) ;05/29/2001  09:20
"RTN","XMJMORX1",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMJMORX1",3,0)
 ;DELMSG(XMDUZ,XMK,XMKZ,XMZ,XMCNT)
"RTN","XMJMORX1",4,0)
XDEL ;
"RTN","XMJMORX1",5,0)
 Q:'XMK
"RTN","XMJMORX1",6,0)
 K XMERR,^TMP("XMERR",$J)
"RTN","XMJMORX1",7,0)
 D DEL^XMXMSGS2(XMDUZ,XMK,XMZ,.XMCNT)
"RTN","XMJMORX1",8,0)
 I $D(XMERR) D ZSHOW^XMJERR Q
"RTN","XMJMORX1",9,0)
 I XMKALL,$G(XMTYPE)'["N" D  Q
"RTN","XMJMORX1",10,0)
 . S ^TMP("XM",$J,"MSG",XMKZ)=$S(XMK'=.5:".5^"_$$EZBLD^DIALOG(37004),1:"0^"_$$EZBLD^DIALOG(34014))_U_XMZ ; "WASTE" / "* N/A *"
"RTN","XMJMORX1",11,0)
 K:XMTMP ^TMP("XM",$J,"MSG",XMKZ)
"RTN","XMJMORX1",12,0)
 K:$D(^TMP("XM",$J,".",XMKZ)) ^TMP("XM",$J,".",XMKZ)
"RTN","XMJMORX1",13,0)
 Q
"RTN","XMJMORX1",14,0)
 ;FLTRMSG(XMDUZ,XMK,XMKZ,XMZ,XMCNT)
"RTN","XMJMORX1",15,0)
XFLTR ;
"RTN","XMJMORX1",16,0)
 N XMKN,XMKTO,XMKNTO
"RTN","XMJMORX1",17,0)
 S XMKN=$P(^TMP("XM",$J,"MSG",XMKZ),U,2)
"RTN","XMJMORX1",18,0)
 D FLTR^XMXMSGS2(XMDUZ,XMK,XMKN,XMZ,.XMCNT,.XMKTO,.XMKNTO)
"RTN","XMJMORX1",19,0)
 I $D(XMERR) D ZSHOW^XMJERR Q
"RTN","XMJMORX1",20,0)
 I XMKALL D  Q
"RTN","XMJMORX1",21,0)
 . S:XMKN'=XMKNTO ^TMP("XM",$J,"MSG",XMKZ)=XMKTO_U_XMKNTO_U_XMZ
"RTN","XMJMORX1",22,0)
 Q:XMKN=XMKNTO
"RTN","XMJMORX1",23,0)
 K ^TMP("XM",$J,"MSG",XMKZ)
"RTN","XMJMORX1",24,0)
 K:$D(^TMP("XM",$J,".",XMKZ)) ^TMP("XM",$J,".",XMKZ)
"RTN","XMJMORX1",25,0)
 Q
"RTN","XMJMORX1",26,0)
 ;NTOGLMSG(XMDUZ,XMK,XMKZ,XMZ,XMCNT)
"RTN","XMJMORX1",27,0)
XNTOGL ;
"RTN","XMJMORX1",28,0)
 N XMKN,XMKTO,XMKNTO
"RTN","XMJMORX1",29,0)
 S XMKN=$P(^TMP("XM",$J,"MSG",XMKZ),U,2)
"RTN","XMJMORX1",30,0)
 D NTOGL^XMXMSGS2(XMDUZ,XMK,XMKN,XMZ,.XMCNT,.XMKTO,.XMKNTO)
"RTN","XMJMORX1",31,0)
 I $D(XMERR) D ZSHOW^XMJERR Q
"RTN","XMJMORX1",32,0)
 I XMKALL D  Q
"RTN","XMJMORX1",33,0)
 . S:XMKN'=XMKNTO ^TMP("XM",$J,"MSG",XMKZ)=XMKTO_U_XMKNTO_U_XMZ
"RTN","XMJMORX1",34,0)
 Q:XMKN=XMKNTO
"RTN","XMJMORX1",35,0)
 K ^TMP("XM",$J,"MSG",XMKZ)
"RTN","XMJMORX1",36,0)
 K:$D(^TMP("XM",$J,".",XMKZ)) ^TMP("XM",$J,".",XMKZ)
"RTN","XMJMORX1",37,0)
 Q
"RTN","XMJMORX1",38,0)
 ;SAVEMSG(XMDUZ,XMK,XMKTO,XMKNTO,XMKZ,XMZ,XMCNT)
"RTN","XMJMORX1",39,0)
XSAVE ;
"RTN","XMJMORX1",40,0)
 Q:XMK=XMKTO
"RTN","XMJMORX1",41,0)
 D MOVE^XMXMSGS2(XMDUZ,XMK,XMZ,XMKTO,.XMCNT)
"RTN","XMJMORX1",42,0)
 I $D(XMERR) D ZSHOW^XMJERR Q
"RTN","XMJMORX1",43,0)
 I XMKALL D  Q
"RTN","XMJMORX1",44,0)
 . S ^TMP("XM",$J,"MSG",XMKZ)=XMKTO_U_XMKNTO_U_XMZ
"RTN","XMJMORX1",45,0)
 K ^TMP("XM",$J,"MSG",XMKZ)
"RTN","XMJMORX1",46,0)
 ;K:$D(^TMP("XM",$J,".",XMKZ)) ^TMP("XM",$J,".",XMKZ)
"RTN","XMJMORX1",47,0)
 Q
"RTN","XMJMORX1",48,0)
 ;TERMMSG(XMDUZ,XMK,XMKZ,XMZ,XMCNT)
"RTN","XMJMORX1",49,0)
XTERM ;
"RTN","XMJMORX1",50,0)
 Q:'XMK
"RTN","XMJMORX1",51,0)
 K XMERR,^TMP("XMERR",$J)
"RTN","XMJMORX1",52,0)
 D TERM^XMXMSGS2(XMDUZ,XMK,XMZ,.XMCNT)
"RTN","XMJMORX1",53,0)
 I $D(XMERR) D ZSHOW^XMJERR Q
"RTN","XMJMORX1",54,0)
 I XMKALL,$G(XMTYPE)'["N" D  Q
"RTN","XMJMORX1",55,0)
 . S ^TMP("XM",$J,"MSG",XMKZ)=$S(XMK'=.5:".5^"_$$EZBLD^DIALOG(37004),1:"0^"_$$EZBLD^DIALOG(34014))_U_XMZ ; "WASTE" / "* N/A *"
"RTN","XMJMORX1",56,0)
 K:XMTMP ^TMP("XM",$J,"MSG",XMKZ)
"RTN","XMJMORX1",57,0)
 K:$D(^TMP("XM",$J,".",XMKZ)) ^TMP("XM",$J,".",XMKZ)
"RTN","XMJMORX1",58,0)
 Q
"RTN","XMJMORX1",59,0)
LISTSEL(XMZLIST) ;
"RTN","XMJMORX1",60,0)
 N XMKZ,J,XMZ
"RTN","XMJMORX1",61,0)
 S (XMKZ,J)=0
"RTN","XMJMORX1",62,0)
 F  S XMKZ=$O(^TMP("XM",$J,".",XMKZ)) Q:'XMKZ  D
"RTN","XMJMORX1",63,0)
 . S XMZ=$P(^TMP("XM",$J,"MSG",XMKZ),U,3)
"RTN","XMJMORX1",64,0)
 . I J=0 S J=1,XMZLIST(1)=XMZ Q
"RTN","XMJMORX1",65,0)
 . I $L(XMZLIST(J))+$L(XMZ)>240 S J=J+1,XMZLIST(J)=XMZ Q
"RTN","XMJMORX1",66,0)
 . S XMZLIST(J)=XMZLIST(J)_","_XMZ
"RTN","XMJMORX1",67,0)
 Q
"RTN","XMJMORX1",68,0)
LIST(XMWHICH,XMZLIST) ;
"RTN","XMJMORX1",69,0)
 N I,J,XMRANGE,XMKZ,XMZ
"RTN","XMJMORX1",70,0)
 S J=0
"RTN","XMJMORX1",71,0)
 F I=1:1:$L(XMWHICH,",") D
"RTN","XMJMORX1",72,0)
 . S XMRANGE=$P(XMWHICH,",",I)
"RTN","XMJMORX1",73,0)
 . Q:'XMRANGE
"RTN","XMJMORX1",74,0)
 . F XMKZ=$P(XMRANGE,"-",1):1:$S(XMRANGE["-":$P(XMRANGE,"-",2),1:XMRANGE) D
"RTN","XMJMORX1",75,0)
 . . S XMZ=$P($G(^TMP("XM",$J,"MSG",XMKZ)),U,3) Q:'XMZ
"RTN","XMJMORX1",76,0)
 . . I J=0 S J=1,XMZLIST(1)=XMZ Q
"RTN","XMJMORX1",77,0)
 . . I $L(XMZLIST(J))+$L(XMZ)>240 S J=J+1,XMZLIST(J)=XMZ Q
"RTN","XMJMORX1",78,0)
 . . S XMZLIST(J)=XMZLIST(J)_","_XMZ
"RTN","XMJMORX1",79,0)
 Q
"RTN","XMJMORX1",80,0)
ACTWHICH(XMDUZ,XMTMP,XMKALL,XMK,XMRTN,XMPROMPT,XMSUM,XMCONFRM,XMMSG,XMABORT) ;,XMKTO)
"RTN","XMJMORX1",81,0)
 N XMWHICH
"RTN","XMJMORX1",82,0)
 D WHICH(XMPROMPT,XMCONFRM,.XMWHICH,.XMABORT) Q:XMABORT
"RTN","XMJMORX1",83,0)
 D ACTMSG(XMDUZ,XMTMP,XMKALL,XMK,XMWHICH,XMRTN,XMSUM,.XMMSG)
"RTN","XMJMORX1",84,0)
 Q
"RTN","XMJMORX1",85,0)
WHICH(XMPROMPT,XMCONFRM,XMWHICH,XMABORT) ;
"RTN","XMJMORX1",86,0)
 N DIR,Y,XMHI,XMLO
"RTN","XMJMORX1",87,0)
 S XMLO=$O(^TMP("XM",$J,"MSG",""))
"RTN","XMJMORX1",88,0)
 S XMHI=$O(^TMP("XM",$J,"MSG",""),-1)
"RTN","XMJMORX1",89,0)
 S DIR("A")=$$EZBLD^DIALOG(XMPROMPT) ; ... which messages?
"RTN","XMJMORX1",90,0)
 S DIR("??")="XM-U-M-CHOOSE RANGE"
"RTN","XMJMORX1",91,0)
 S DIR(0)="LC^"_XMLO_":"_XMHI
"RTN","XMJMORX1",92,0)
 D ^DIR I $D(DIRUT) S XMABORT=1 Q
"RTN","XMJMORX1",93,0)
 S XMWHICH=Y
"RTN","XMJMORX1",94,0)
 I XMCONFRM D CONFIRM^XMJMOR(XMCONFRM,.XMABORT)
"RTN","XMJMORX1",95,0)
 Q
"RTN","XMJMORX1",96,0)
ACTMSG(XMDUZ,XMTMP,XMKALL,XMK,XMKZA,XMRTN,XMSUM,XMMSG) ;,XMKTO)
"RTN","XMJMORX1",97,0)
 ; XMKZA    Array of msg numbers  DEL("1-3,7,11-15")
"RTN","XMJMORX1",98,0)
 ; XMKZL    List of msg numbers   1-3,7,11-15
"RTN","XMJMORX1",99,0)
 ;          (It is OK if the list ends with a comma)
"RTN","XMJMORX1",100,0)
 ; XMKZR    Range of msg numbers  1-3
"RTN","XMJMORX1",101,0)
 ; XMKZ1    First number in range 1
"RTN","XMJMORX1",102,0)
 ; XMKZN    Last number in range  3
"RTN","XMJMORX1",103,0)
 N XMKZ,XMREC,XMKZL,XMKZR,I,XMKZ1,XMKZN,XMZ,XMCNT,XMPIECES
"RTN","XMJMORX1",104,0)
 S XMCNT=0
"RTN","XMJMORX1",105,0)
 ; is this an array or a variable?
"RTN","XMJMORX1",106,0)
 I $G(XMKZA)]"",$O(XMKZA(""))="" S XMKZA(XMKZA)=""
"RTN","XMJMORX1",107,0)
 S XMKZL=""
"RTN","XMJMORX1",108,0)
 F  S XMKZL=$O(XMKZA(XMKZL)) Q:XMKZL=""  D
"RTN","XMJMORX1",109,0)
 . S XMPIECES=$L(XMKZL,",")
"RTN","XMJMORX1",110,0)
 . S:'$P(XMKZL,",",XMPIECES) XMPIECES=XMPIECES-1
"RTN","XMJMORX1",111,0)
 . F I=1:1:XMPIECES D
"RTN","XMJMORX1",112,0)
 . . S XMKZR=$P(XMKZL,",",I)
"RTN","XMJMORX1",113,0)
 . . I XMKZR["-" D  Q
"RTN","XMJMORX1",114,0)
 . . . ; deal with a range of msg #s
"RTN","XMJMORX1",115,0)
 . . . S XMKZ1=$P(XMKZR,"-",1)
"RTN","XMJMORX1",116,0)
 . . . S XMKZN=$P(XMKZR,"-",2)
"RTN","XMJMORX1",117,0)
 . . . S XMKZ=XMKZ1-.1
"RTN","XMJMORX1",118,0)
 . . . I XMTMP D  Q
"RTN","XMJMORX1",119,0)
 . . . . F  S XMKZ=$O(^TMP("XM",$J,"MSG",XMKZ)) Q:XMKZ>XMKZN!'XMKZ  D
"RTN","XMJMORX1",120,0)
 . . . . . S XMREC=^TMP("XM",$J,"MSG",XMKZ)
"RTN","XMJMORX1",121,0)
 . . . . . S:XMKALL XMK=$P(XMREC,U,1)
"RTN","XMJMORX1",122,0)
 . . . . . S XMZ=$P(XMREC,U,3) Q:'XMZ
"RTN","XMJMORX1",123,0)
 . . . . . D @XMRTN ;(XMDUZ,XMK,XMZ)
"RTN","XMJMORX1",124,0)
 . . . F  S XMKZ=$O(^XMB(3.7,XMDUZ,2,XMK,1,"C",XMKZ)) Q:XMKZ>XMKZN!'XMKZ  D
"RTN","XMJMORX1",125,0)
 . . . . S XMZ=$O(^XMB(3.7,XMDUZ,2,XMK,1,"C",XMKZ,0)) Q:'XMZ
"RTN","XMJMORX1",126,0)
 . . . . D @XMRTN ;(XMDUZ,XMK,XMZ)
"RTN","XMJMORX1",127,0)
 . . S XMKZ=XMKZR
"RTN","XMJMORX1",128,0)
 . . I XMTMP D  Q
"RTN","XMJMORX1",129,0)
 . . . S XMREC=$G(^TMP("XM",$J,"MSG",XMKZ))
"RTN","XMJMORX1",130,0)
 . . . I XMREC="" S XMZ=0 Q
"RTN","XMJMORX1",131,0)
 . . . S:XMKALL XMK=$P(XMREC,U,1)
"RTN","XMJMORX1",132,0)
 . . . S XMZ=$P(XMREC,U,3) Q:'XMZ
"RTN","XMJMORX1",133,0)
 . . . D @XMRTN ;(XMDUZ,XMK,XMZ)
"RTN","XMJMORX1",134,0)
 . . S XMZ=$O(^XMB(3.7,XMDUZ,2,XMK,1,"C",XMKZ,0)) Q:'XMZ
"RTN","XMJMORX1",135,0)
 . . D @XMRTN ;(XMDUZ,XMK,XMZ)
"RTN","XMJMORX1",136,0)
 S XMMSG=$$EZBLD^DIALOG($S(XMCNT=1:XMSUM+.1,1:XMSUM),XMCNT)
"RTN","XMJMORX1",137,0)
 D INCRDECR^XMXMSGS(XMDUZ,.XMCNT)
"RTN","XMJMORX1",138,0)
 Q
"RTN","XMJMORX1",139,0)
SELMSG(XMDUZ,XMTMP,XMKALL,XMK,XMRTN,XMSUM,XMCONFRM,XMMSG,XMABORT) ;,XMKTO,XMWHEN)
"RTN","XMJMORX1",140,0)
 I XMCONFRM D CONFIRM^XMJMOR(XMCONFRM,.XMABORT) Q:XMABORT
"RTN","XMJMORX1",141,0)
 N XMCNT,XMKZ,XMREC,XMZ
"RTN","XMJMORX1",142,0)
 S (XMCNT,XMKZ)=0
"RTN","XMJMORX1",143,0)
 F  S XMKZ=$O(^TMP("XM",$J,".",XMKZ)) Q:'XMKZ  D
"RTN","XMJMORX1",144,0)
 . I XMTMP D  Q
"RTN","XMJMORX1",145,0)
 . . S XMREC=^TMP("XM",$J,"MSG",XMKZ)
"RTN","XMJMORX1",146,0)
 . . S:XMKALL XMK=$P(XMREC,U,1)
"RTN","XMJMORX1",147,0)
 . . S XMZ=$P(XMREC,U,3) Q:'XMZ
"RTN","XMJMORX1",148,0)
 . . D @XMRTN ;(XMDUZ,XMK,XMZ)
"RTN","XMJMORX1",149,0)
 . S XMZ=$O(^XMB(3.7,XMDUZ,2,XMK,1,"C",XMKZ,"")) Q:'XMZ
"RTN","XMJMORX1",150,0)
 . D @XMRTN ;(XMDUZ,XMK,XMZ)
"RTN","XMJMORX1",151,0)
 S XMMSG=$$EZBLD^DIALOG($S(XMCNT=1:XMSUM+.1,1:XMSUM),XMCNT)
"RTN","XMJMORX1",152,0)
 D INCRDECR^XMXMSGS(XMDUZ,.XMCNT)
"RTN","XMJMORX1",153,0)
 Q
"RTN","XMJMP")
0^298^B62577394
"RTN","XMJMP",1,0)
XMJMP ;ISC-SF/GMB-Print,Backup messages ;09/28/2000  16:03
"RTN","XMJMP",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMJMP",3,0)
 ; PRINT  Replaces ENTPRT^XMA0,^XMA02,ENTPRT^XMAP,QE2^XMA5
"RTN","XMJMP",4,0)
 ; BACKUP Replaces E^XMA1,ENT8^XMAH,ENTR^XMAP,ENTBCK^XMAP
"RTN","XMJMP",5,0)
 ; (ISC-WASH/CAP/THM)
"RTN","XMJMP",6,0)
PRINT(XMDUZ,XMK,XMZ,XMPRTHDR,XMBROWSE) ; Print
"RTN","XMJMP",7,0)
 ; XMPRTHDR 1=Print header
"RTN","XMJMP",8,0)
 ;          0=don't (headerless print)
"RTN","XMJMP",9,0)
 ; XMRECIPS 0=Don't print recipients
"RTN","XMJMP",10,0)
 ;          1=Print summary recipients
"RTN","XMJMP",11,0)
 ;          2=Print detail recipients
"RTN","XMJMP",12,0)
 ; XMBROWSE 0=Print normally
"RTN","XMJMP",13,0)
 ;          1=Direct the print to the VA FileMan Browser
"RTN","XMJMP",14,0)
 N XMWHICH,XMRESPS,XMABORT,XMRECIPS,XMSAVE,ZTSK
"RTN","XMJMP",15,0)
 S XMABORT=0
"RTN","XMJMP",16,0)
 I $G(XMBROWSE) S XMRECIPS=0
"RTN","XMJMP",17,0)
 E  D QRECIP(.XMRECIPS,.XMABORT) Q:XMABORT
"RTN","XMJMP",18,0)
 S XMRESPS=$$RESP^XMXUTIL2(XMZ)
"RTN","XMJMP",19,0)
 I XMRESPS D  Q:XMABORT
"RTN","XMJMP",20,0)
 . S XMWHICH="0-"_XMRESPS
"RTN","XMJMP",21,0)
 . D WHICH(XMZ,XMRESPS,$$EZBLD^DIALOG(34500),.XMWHICH,.XMABORT) ; Print
"RTN","XMJMP",22,0)
 . ; If responses includes from x through the end, then set it so that
"RTN","XMJMP",23,0)
 . ; if the user queues for later printing, any new add'l responses
"RTN","XMJMP",24,0)
 . ; will be printed, too.
"RTN","XMJMP",25,0)
 . I XMWHICH["-",$P(XMWHICH,"-",$L(XMWHICH,"-"))=XMRESPS S XMWHICH=$P(XMWHICH,"-",1,$L(XMWHICH,"-")-1)_"-"
"RTN","XMJMP",26,0)
 E  S XMWHICH="0-"
"RTN","XMJMP",27,0)
 S:$G(XMPRTHDR)="" XMPRTHDR=1  ; default is to print with headers
"RTN","XMJMP",28,0)
 F I="DUZ","XMDUZ","XMV(","XMK","XMZ","XMWHICH","XMRECIPS","XMPRTHDR" S XMSAVE(I)=""
"RTN","XMJMP",29,0)
 I $D(XMSECURE) F I="XMPAKMAN","XMSECURE","XMSECURE(" S XMSAVE(I)=""
"RTN","XMJMP",30,0)
 I $G(XMBROWSE) N IOP,DDBDMSG S IOP="BROWSER",DDBDMSG=$$EZBLD^DIALOG(34537,XMZ)_" "_$$ZSUBJ^XMXUTIL2(XMZ) ; (Instead of "VA FileMan Browser")
"RTN","XMJMP",31,0)
 D EN^XUTMDEVQ("PRTMSGX^XMJMP",$$EZBLD^DIALOG(34501),.XMSAVE,,1) ; MailMan: Print
"RTN","XMJMP",32,0)
 I $D(ZTSK) W !,$$EZBLD^DIALOG(34501.1,ZTSK) ; Request queued.  Task number: |1|
"RTN","XMJMP",33,0)
 Q
"RTN","XMJMP",34,0)
PRTMSG(XMDUZ,XMK,XMZ,XMWHICH,XMRECIPS,XMPRTHDR) ;
"RTN","XMJMP",35,0)
PRTMSGX ;
"RTN","XMJMP",36,0)
PRINTMSG ;
"RTN","XMJMP",37,0)
 N XMKN,XMRESPS,XMZREC,XMPTR
"RTN","XMJMP",38,0)
 S XMZREC=$G(^XMB(3.9,XMZ,0)) Q:XMZREC=""
"RTN","XMJMP",39,0)
 D BSKT^XMJMP1(XMDUZ,XMZ,.XMK,.XMKN)
"RTN","XMJMP",40,0)
 D RESPONSE(XMDUZ,XMZ,.XMRESPS,.XMPTR)
"RTN","XMJMP",41,0)
 W:$G(IOST)["C-" @IOF
"RTN","XMJMP",42,0)
 D:XMPRTHDR IDHDR(XMDUZ)
"RTN","XMJMP",43,0)
 D PRINTIT^XMJMP1(XMDUZ,XMK,XMKN,XMZ,XMZREC,XMRESPS,XMPTR,XMWHICH,XMRECIPS,0,XMPRTHDR)
"RTN","XMJMP",44,0)
 I $D(ZTQUEUED) S ZTREQ="@" D ^%ZISC ; This close device is needed to preserve the temp global used by p-message.
"RTN","XMJMP",45,0)
 Q
"RTN","XMJMP",46,0)
IDHDR(XMDUZ) ; Header: "MailMan msg for..."
"RTN","XMJMP",47,0)
 N XMREC,XMPARM
"RTN","XMJMP",48,0)
 S XMREC=$G(^VA(200,XMDUZ,0))
"RTN","XMJMP",49,0)
 W *13,$$EZBLD^DIALOG(34502,XMV("NAME")) ; MailMan message for
"RTN","XMJMP",50,0)
 I $P(XMREC,U,9)'="",$D(^DIC(3.1,+$P(XMREC,U,9),0)) W "  ",$P(^(0),U,1) ; VA TITLE
"RTN","XMJMP",51,0)
 S XMPARM(1)=^XMB("NETNAME"),XMPARM(2)=$$MMDT^XMXUTIL1($$NOW^XLFDT)
"RTN","XMJMP",52,0)
 W !,$$EZBLD^DIALOG(34503,.XMPARM),! ; Printed at site  date
"RTN","XMJMP",53,0)
 Q
"RTN","XMJMP",54,0)
QRECIP(XMRECIPS,XMABORT) ;
"RTN","XMJMP",55,0)
 N DIR,DIRUT,Y,XMSUMRY
"RTN","XMJMP",56,0)
 S DIR(0)="Y"
"RTN","XMJMP",57,0)
 S DIR("A")=$$EZBLD^DIALOG(34504) ; Print recipient list
"RTN","XMJMP",58,0)
 S DIR("B")=$$EZBLD^DIALOG(39053) ; No
"RTN","XMJMP",59,0)
 D BLD^DIALOG(34505,"","","DIR(""?"")")
"RTN","XMJMP",60,0)
 D ^DIR I $D(DIRUT) S XMABORT=1 Q
"RTN","XMJMP",61,0)
 I Y=0 S XMRECIPS=0 Q
"RTN","XMJMP",62,0)
 S XMSUMRY=$$EZBLD^DIALOG(34507)
"RTN","XMJMP",63,0)
 S DIR(0)="SM^"_$$EZBLD^DIALOG(34506)_";"_XMSUMRY
"RTN","XMJMP",64,0)
 S DIR("A")=$$EZBLD^DIALOG(34508) ; Print Detail or Summary recipient chain
"RTN","XMJMP",65,0)
 S DIR("B")=$P(XMSUMRY,":",2,99) ; Summary
"RTN","XMJMP",66,0)
 D ^DIR I $D(DIRUT) S XMABORT=1 Q
"RTN","XMJMP",67,0)
 S XMRECIPS=$S(Y=$P(XMSUMRY,":",1):1,1:2)
"RTN","XMJMP",68,0)
 Q
"RTN","XMJMP",69,0)
DISPMSG(XMDUZ,XMK,XMKN,XMZ,XMSECBAD,XMNOBACK) ; Display message
"RTN","XMJMP",70,0)
 N XMRESPS,XMRESP,XMPTR,XMZREC,XMBACKUP
"RTN","XMJMP",71,0)
 S XMZREC=^XMB(3.9,XMZ,0)
"RTN","XMJMP",72,0)
 S XMPAKMAN=$$PAKMAN^XMXSEC1(XMZ,XMZREC)
"RTN","XMJMP",73,0)
 D RESPONSE(XMDUZ,XMZ,.XMRESPS,.XMPTR,.XMRESP)
"RTN","XMJMP",74,0)
 I XMRESP'="",XMRESPS S XMRESP=XMRESP+1 I XMRESP>XMRESPS,'$G(XMNOBACK) S XMBACKUP=1
"RTN","XMJMP",75,0)
 I XMDUZ=.5,XMK>999 S XMRESP=XMRESPS+1 K:$D(XMBACKUP) XMBACKUP
"RTN","XMJMP",76,0)
 E  I $D(^XMB(3.9,XMZ,"K")),'$D(XMSECURE),'$$KEYOK^XMJMCODE(XMZ,$P(XMZREC,U,10)) S XMSECBAD=1 Q
"RTN","XMJMP",77,0)
 W @IOF
"RTN","XMJMP",78,0)
 D PRINTIT^XMJMP1(XMDUZ,XMK,XMKN,XMZ,XMZREC,XMRESPS,XMPTR,+XMRESP_"-",0,1,1)
"RTN","XMJMP",79,0)
 I $G(XMBACKUP) W !!,$$EZBLD^DIALOG(34509) ; You are at the end of this message.  Enter 'B' to Backup and review it.
"RTN","XMJMP",80,0)
 Q
"RTN","XMJMP",81,0)
RESPONSE(XMDUZ,XMZ,XMRESPS,XMPTR,XMRESP) ;
"RTN","XMJMP",82,0)
 ; XMRESP="" if the user hasn't read the message at all
"RTN","XMJMP",83,0)
 ;        0  if the user has read the original message only
"RTN","XMJMP",84,0)
 ;        n  if the user has read thru response n
"RTN","XMJMP",85,0)
 S XMRESPS=+$P($G(^XMB(3.9,XMZ,3,0)),U,4)
"RTN","XMJMP",86,0)
 ;S XMPTR=+$O(^XMB(3.9,XMZ,1,"C",$S(XMDUZ=.6:DUZ,1:XMDUZ),0))
"RTN","XMJMP",87,0)
 S XMPTR=+$O(^XMB(3.9,XMZ,1,"C",XMDUZ,0))
"RTN","XMJMP",88,0)
 S XMRESP=$P($G(^XMB(3.9,XMZ,1,XMPTR,0)),U,2)
"RTN","XMJMP",89,0)
 Q
"RTN","XMJMP",90,0)
CHKRESP(XMDUZ,XMZO,XMRESPSO,XMRESP) ;
"RTN","XMJMP",91,0)
 N XMRESPS
"RTN","XMJMP",92,0)
 S XMRESPS=+$P($G(^XMB(3.9,XMZO,3,0)),U,4)
"RTN","XMJMP",93,0)
 Q:XMRESPS=+XMRESP  ; No new responses
"RTN","XMJMP",94,0)
 I XMRESPSO>XMRESP D  Q:XMRESPSO=XMRESPS
"RTN","XMJMP",95,0)
 . I XMRESPSO-1>XMRESP D
"RTN","XMJMP",96,0)
 . . ; >> You haven't read responses |1|-|2|.  You may backup to see them. <<
"RTN","XMJMP",97,0)
 . . N XMPARM
"RTN","XMJMP",98,0)
 . . S XMPARM(1)=XMRESP+1,XMPARM(2)=XMRESPSO
"RTN","XMJMP",99,0)
 . . W !,$$EZBLD^DIALOG(34510,.XMPARM)
"RTN","XMJMP",100,0)
 . E  W !,$$EZBLD^DIALOG(34511,XMRESP+1) ; >> You haven't read response |1|.  You may backup to see it. <<
"RTN","XMJMP",101,0)
 . S XMRESP=XMRESPSO
"RTN","XMJMP",102,0)
 N XMZ
"RTN","XMJMP",103,0)
 F  S XMRESP=$O(^XMB(3.9,XMZO,3,XMRESP)) Q:'XMRESP  S XMZ=$P($G(^(XMRESP,0)),U,1) I XMZ,$P($G(^XMB(3.9,XMZ,0)),U,2)'=XMDUZ Q
"RTN","XMJMP",104,0)
 Q:'XMRESP
"RTN","XMJMP",105,0)
 W !,$$EZBLD^DIALOG(34512,XMRESP) ; >> Response |1| has arrived - you may backup to see it. <<
"RTN","XMJMP",106,0)
 Q
"RTN","XMJMP",107,0)
BACKUP(XMDUZ,XMK,XMKN,XMZ) ; Backup
"RTN","XMJMP",108,0)
 N XMWHICH,XMRESPS,XMABORT,XMZREC,XMPTR
"RTN","XMJMP",109,0)
 S XMZREC=^XMB(3.9,XMZ,0)
"RTN","XMJMP",110,0)
 I $D(^XMB(3.9,XMZ,"K")),'$D(XMSECURE) Q:'$$KEYOK^XMJMCODE(XMZ,$P(XMZREC,U,10))
"RTN","XMJMP",111,0)
 S XMABORT=0
"RTN","XMJMP",112,0)
 D RESPONSE(XMDUZ,XMZ,.XMRESPS,.XMPTR,.XMWHICH)
"RTN","XMJMP",113,0)
 I XMRESPS D HOWMUCH^XMJMP1(XMZ,XMRESPS,.XMWHICH,.XMABORT) Q:XMABORT
"RTN","XMJMP",114,0)
 W @IOF
"RTN","XMJMP",115,0)
 D PRINTIT^XMJMP1(XMDUZ,XMK,XMKN,XMZ,XMZREC,XMRESPS,XMPTR,XMWHICH,0,1,1)
"RTN","XMJMP",116,0)
 Q
"RTN","XMJMP",117,0)
WHICH(XMZ,XMRESPS,XMVERB,XMWHICH,XMABORT) ;
"RTN","XMJMP",118,0)
 N DIR,DIRUT,Y,XMTEXT
"RTN","XMJMP",119,0)
 ; There is 1 response. / There are X responses. Response 0 is the original message.  (?? shows index)
"RTN","XMJMP",120,0)
 D BLD^DIALOG($S(XMRESPS=1:34514,1:34515),XMRESPS,"","XMTEXT")
"RTN","XMJMP",121,0)
 M DIR("A")=XMTEXT
"RTN","XMJMP",122,0)
 S DIR("A")=$$EZBLD^DIALOG(34516,XMVERB) ; Select the responses to |1|:
"RTN","XMJMP",123,0)
 S:$D(XMWHICH) DIR("B")=XMWHICH
"RTN","XMJMP",124,0)
 S DIR("PRE")="I X?.E1N1""-"" S X=X_XMRESPS W XMRESPS"
"RTN","XMJMP",125,0)
 S DIR(0)="LACO^0:"_XMRESPS
"RTN","XMJMP",126,0)
 S DIR("??")="^D HELPRESP^XMJMP1(XMZ,XMRESPS)"
"RTN","XMJMP",127,0)
 D ^DIR I $D(DTOUT)!$D(DUOUT) S XMABORT=1 Q
"RTN","XMJMP",128,0)
 S:X'="" XMWHICH=$E(Y,1,$L(Y)-1)
"RTN","XMJMP",129,0)
 Q
"RTN","XMJMP",130,0)
PONE(XMDUZ,XMK,XMZ,XMPRTHDR,XMABORT) ;
"RTN","XMJMP",131,0)
PONEX ; Print one message.  Check it to see if
"RTN","XMJMP",132,0)
 ; the user is allowed to see it.  (confidential, scrambled)
"RTN","XMJMP",133,0)
 ; If not, print an error message.
"RTN","XMJMP",134,0)
 N XMZREC
"RTN","XMJMP",135,0)
 I $G(XMK)="" S XMK=$$BSKT^XMXUTIL2(XMDUZ,XMZ)
"RTN","XMJMP",136,0)
 I '$D(^XMB(3.9,XMZ,0)),XMK D ZAPIT^XMJBM(XMDUZ,XMK,XMZ) S XMABORT=1 Q
"RTN","XMJMP",137,0)
 S XMZREC=^XMB(3.9,XMZ,0)
"RTN","XMJMP",138,0)
 I XMDUZ'=DUZ,'$$SURRACC^XMXSEC(XMDUZ,"",XMZ,XMZREC) D  Q  ; "access"
"RTN","XMJMP",139,0)
 . D SHOW^XMJERR
"RTN","XMJMP",140,0)
 . S XMABORT=1
"RTN","XMJMP",141,0)
 N XMSECURE,XMPAKMAN ; Important 'new' - part of scramble and packman handling
"RTN","XMJMP",142,0)
 S XMPAKMAN=$$PAKMAN^XMXSEC1(XMZ,XMZREC)
"RTN","XMJMP",143,0)
 I $D(^XMB(3.9,XMZ,"K")),'$$KEYOK^XMJMCODE(XMZ,$P(XMZREC,U,10)) S XMABORT=1 Q
"RTN","XMJMP",144,0)
 N XMRECIPS,XMRESPS,XMWHICH
"RTN","XMJMP",145,0)
 D QRECIP(.XMRECIPS,.XMABORT) Q:XMABORT
"RTN","XMJMP",146,0)
 D RESPONSE(XMDUZ,XMZ,.XMRESPS,"",.XMWHICH)
"RTN","XMJMP",147,0)
 I XMRESPS D  Q:XMABORT
"RTN","XMJMP",148,0)
 . N XMRESP
"RTN","XMJMP",149,0)
 . S XMRESP=XMWHICH
"RTN","XMJMP",150,0)
 . I $D(^XMB(3.7,XMDUZ,"N0",XMK,XMZ)),XMRESP S:XMRESP'=XMRESPS XMRESP=XMRESP+1
"RTN","XMJMP",151,0)
 . E  S XMRESP=0
"RTN","XMJMP",152,0)
 . I XMRESP=XMRESPS S XMWHICH=XMRESP
"RTN","XMJMP",153,0)
 . E  S XMWHICH=XMRESP_"-"_XMRESPS
"RTN","XMJMP",154,0)
 . D WHICH(XMZ,XMRESPS,$$EZBLD^DIALOG(34500),.XMWHICH,.XMABORT) ; Print
"RTN","XMJMP",155,0)
 E  S XMWHICH=0
"RTN","XMJMP",156,0)
 F I="DUZ","XMDUZ","XMV(","XMK","XMZ","XMWHICH","XMRECIPS","XMPRTHDR" S XMSAVE(I)=""
"RTN","XMJMP",157,0)
 I $D(XMSECURE) F I="XMPAKMAN","XMSECURE","XMSECURE(" S XMSAVE(I)=""
"RTN","XMJMP",158,0)
 D EN^XUTMDEVQ("PRTMSGX^XMJMP",$$EZBLD^DIALOG(34501),.XMSAVE) ; MailMan: Print
"RTN","XMJMP",159,0)
 Q
"RTN","XMJMP",160,0)
 ;PLIST(XMDUZ,XMZLIST,XMRECIPS,XMPRTHDR,XMMSG)
"RTN","XMJMP",161,0)
PLISTX ;
"RTN","XMJMP",162,0)
 ; Print a list of messages.
"RTN","XMJMP",163,0)
 ; Check each message as we come to it to see if
"RTN","XMJMP",164,0)
 ; the user is allowed to see it.  (confidential, scrambled)
"RTN","XMJMP",165,0)
 ; If not, print an error message.
"RTN","XMJMP",166,0)
 N I,J,XMK,XMKN,XMZ,XMFIRST,XMCNT,XMABORT
"RTN","XMJMP",167,0)
 S XMFIRST=1,(XMCNT,XMABORT,I)=0
"RTN","XMJMP",168,0)
 F  S I=$O(XMZLIST(I)) Q:'I  D  Q:XMABORT
"RTN","XMJMP",169,0)
 . F J=1:1:$L(XMZLIST(I),",") D  Q:XMABORT
"RTN","XMJMP",170,0)
 . . S XMZ=$P(XMZLIST(I),",",J)
"RTN","XMJMP",171,0)
 . . Q:'$D(^XMB(3.9,XMZ,0))
"RTN","XMJMP",172,0)
 . . D BSKT^XMJMP1(XMDUZ,XMZ,.XMK,.XMKN)
"RTN","XMJMP",173,0)
 . . D PRTMULT(XMDUZ,XMK,XMKN,XMZ,XMRECIPS,XMPRTHDR,.XMFIRST,.XMCNT,.XMABORT)
"RTN","XMJMP",174,0)
 Q:$D(ZTQUEUED)
"RTN","XMJMP",175,0)
 S XMMSG=$$EZBLD^DIALOG($S(XMCNT=1:34318.1,1:34318),XMCNT)
"RTN","XMJMP",176,0)
 Q
"RTN","XMJMP",177,0)
PRTMULT(XMDUZ,XMK,XMKN,XMZ,XMRECIPS,XMPRTHDR,XMFIRST,XMCNT,XMABORT) ; Multiple message print
"RTN","XMJMP",178,0)
 N XMNOGO,XMZREC,XMRESPS,XMRESP,XMPTR,XMSECURE,XMPAKMAN
"RTN","XMJMP",179,0)
 I $D(ZTQUEUED) S ZTREQ="@"
"RTN","XMJMP",180,0)
 S XMNOGO=0
"RTN","XMJMP",181,0)
 S XMZREC=$G(^XMB(3.9,XMZ,0))
"RTN","XMJMP",182,0)
 I XMZREC="" D ZAPIT^XMXMSGS2(XMDUZ,XMK,XMZ) Q
"RTN","XMJMP",183,0)
 S XMPAKMAN=$$PAKMAN^XMXSEC1(XMZ,XMZREC)
"RTN","XMJMP",184,0)
 D CHECK^XMJMP2(XMDUZ,XMZ,XMZREC,.XMNOGO)  Q:XMNOGO&'$D(ZTQUEUED)
"RTN","XMJMP",185,0)
 I IOST["C-"!'XMFIRST W @IOF
"RTN","XMJMP",186,0)
 S XMFIRST=0
"RTN","XMJMP",187,0)
 D:XMPRTHDR IDHDR(XMDUZ)
"RTN","XMJMP",188,0)
 I XMNOGO D NOGOMSG^XMJMP2(XMDUZ,XMZ,XMZREC,.XMNOGO) Q
"RTN","XMJMP",189,0)
 D RESPONSE(XMDUZ,XMZ,.XMRESPS,.XMPTR,.XMRESP)
"RTN","XMJMP",190,0)
 I $D(^XMB(3.7,XMDUZ,"N0",XMK,XMZ)),XMRESP S:XMRESP'=XMRESPS XMRESP=XMRESP+1
"RTN","XMJMP",191,0)
 E  S XMRESP=0
"RTN","XMJMP",192,0)
 D PRINTIT^XMJMP1(XMDUZ,XMK,XMKN,XMZ,XMZREC,XMRESPS,XMPTR,XMRESP_"-",XMRECIPS,0,XMPRTHDR,1,.XMABORT)
"RTN","XMJMP",193,0)
 S XMCNT=XMCNT+1
"RTN","XMJMP",194,0)
 ;Q:XMABORT
"RTN","XMJMP",195,0)
 ;I IOST["C-" D PAGE^XMXUTIL(.XMABORT)
"RTN","XMJMP",196,0)
 Q
"RTN","XMJMP1")
0^38^B73787234
"RTN","XMJMP1",1,0)
XMJMP1 ;ISC-SF/GMB-Print,Backup (cont.) ;04/17/2002  10:10
"RTN","XMJMP1",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMJMP1",3,0)
BSKT(XMDUZ,XMZ,XMK,XMKN) ;
"RTN","XMJMP1",4,0)
 I +$G(XMK),$D(^XMB(3.7,"M",XMZ,XMDUZ,XMK)) S XMKN=$$BSKTNAME^XMXUTIL(XMDUZ,XMK) Q
"RTN","XMJMP1",5,0)
 N XMKSTR
"RTN","XMJMP1",6,0)
 S XMKSTR=$$BSKT^XMXUTIL2(XMDUZ,XMZ,1)
"RTN","XMJMP1",7,0)
 S XMK=$P(XMKSTR,U,1),XMKN=$S(XMK:$P(XMKSTR,U,2),1:$$EZBLD^DIALOG(34014)) ; * N/A *
"RTN","XMJMP1",8,0)
 Q
"RTN","XMJMP1",9,0)
HOWMUCH(XMZ,XMRESPS,XMWHICH,XMABORT) ;
"RTN","XMJMP1",10,0)
 N DIR,DIRUT,Y,XMRESP,XMTEXT
"RTN","XMJMP1",11,0)
 ; There is 1 response. / There are X responses. Response 0 is the original message.  (?? shows index)
"RTN","XMJMP1",12,0)
 D BLD^DIALOG($S(XMRESPS=1:34514,1:34515),XMRESPS,"","XMTEXT")
"RTN","XMJMP1",13,0)
 M DIR("A")=XMTEXT
"RTN","XMJMP1",14,0)
 I XMWHICH<XMRESPS,XMWHICH'="" D  ; (On broadcasts with responses, XMWHICH will usually be null.)
"RTN","XMJMP1",15,0)
 . S DIR("A")=$$EZBLD^DIALOG(34518) ; Backup to:
"RTN","XMJMP1",16,0)
 . S DIR("B")=+$O(^XMB(3.9,XMZ,3,XMWHICH)) ; (XMWHICH+1)
"RTN","XMJMP1",17,0)
 E  D
"RTN","XMJMP1",18,0)
 . S DIR("A")=$$EZBLD^DIALOG(34519) ; Backup to: Original message
"RTN","XMJMP1",19,0)
 . S DIR("B")=0
"RTN","XMJMP1",20,0)
 S DIR(0)="NA^-"_XMRESPS_":"_XMRESPS
"RTN","XMJMP1",21,0)
 D BLD^DIALOG(34520,"","","DIR(""?"")")
"RTN","XMJMP1",22,0)
 ;If you select 0, you will Backup to the original message.
"RTN","XMJMP1",23,0)
 ;If you select one of the responses, you will Backup to it.
"RTN","XMJMP1",24,0)
 S DIR("??")="^D HELPRESP^XMJMP1(XMZ,XMRESPS)"
"RTN","XMJMP1",25,0)
 D ^DIR I $D(DIRUT) S XMABORT=1 Q
"RTN","XMJMP1",26,0)
 S XMRESP=$S(Y<0:XMRESPS+Y+1,1:Y)
"RTN","XMJMP1",27,0)
 S XMWHICH=$S(XMRESP=XMRESPS:XMRESP,1:XMRESP_"-"_XMRESPS)
"RTN","XMJMP1",28,0)
 Q
"RTN","XMJMP1",29,0)
HELPRESP(XMZ,XMRESPS) ;
"RTN","XMJMP1",30,0)
 N XMRESP,XMLEN,XMABORT
"RTN","XMJMP1",31,0)
 S XMABORT=0
"RTN","XMJMP1",32,0)
 W @IOF,$$EZBLD^DIALOG($S(XMRESPS=1:34530,1:34531),XMRESPS)
"RTN","XMJMP1",33,0)
 ;There is 1 response / There are _XMRESPS_ responses.  Response 0 is the original message.
"RTN","XMJMP1",34,0)
 S XMRESP=$S(XMV("ORDER")=1:0,1:XMRESPS+1)
"RTN","XMJMP1",35,0)
 W ! D HRHDR(XMRESPS,XMRESP,.XMLEN)
"RTN","XMJMP1",36,0)
 D:XMV("ORDER")=1 HRLINE(XMZ,0)
"RTN","XMJMP1",37,0)
 F  S XMRESP=$O(^XMB(3.9,XMZ,3,XMRESP),XMV("ORDER")) Q:XMRESP'>0  D  Q:XMABORT
"RTN","XMJMP1",38,0)
 . I $Y+3>IOSL D PAGE^XMXUTIL(.XMABORT) Q:XMABORT  D 
"RTN","XMJMP1",39,0)
 . . W @IOF D HRHDR(XMRESPS,XMRESP,.XMLEN)
"RTN","XMJMP1",40,0)
 . D HRLINE($P(^XMB(3.9,XMZ,3,XMRESP,0),U),XMRESP)
"RTN","XMJMP1",41,0)
 Q:XMABORT
"RTN","XMJMP1",42,0)
 Q:XMV("ORDER")=1
"RTN","XMJMP1",43,0)
 I $Y+3>IOSL D PAGE^XMXUTIL(.XMABORT) Q:XMABORT  D
"RTN","XMJMP1",44,0)
 . W @IOF D HRHDR(XMRESPS,XMRESP,.XMLEN)
"RTN","XMJMP1",45,0)
 D HRLINE(XMZ,0)
"RTN","XMJMP1",46,0)
 Q
"RTN","XMJMP1",47,0)
HRHDR(XMRESPS,XMRESP,XMLEN) ;
"RTN","XMJMP1",48,0)
 S XMLEN("RESP")=$S(XMV("ORDER")=1:$L($$MIN^XLFMTH(XMRESPS,XMRESP+IOSL)),1:$L(XMRESP))
"RTN","XMJMP1",49,0)
 S XMLEN("DATE")=$L($$MMDT^XMXUTIL1(DT))
"RTN","XMJMP1",50,0)
 S XMLEN("LINE")=5
"RTN","XMJMP1",51,0)
 S XMLEN("FROM")=79-XMLEN("RESP")-XMLEN("DATE")-XMLEN("LINE")-3
"RTN","XMJMP1",52,0)
 W $$LJ^XLFSTR($$EZBLD^DIALOG(34532),XMLEN("RESP")+XMLEN("DATE")+3,"."),$$LJ^XLFSTR($$EZBLD^DIALOG(34006),XMLEN("FROM"),"."),$$EZBLD^DIALOG(34003.1) ; "Response"/"From"/"Lines"
"RTN","XMJMP1",53,0)
 Q
"RTN","XMJMP1",54,0)
HRLINE(XMZ,XMRESP) ;
"RTN","XMJMP1",55,0)
 N XMZREC
"RTN","XMJMP1",56,0)
 S XMZREC=$G(^XMB(3.9,XMZ,0))
"RTN","XMJMP1",57,0)
 W !,$J(XMRESP,XMLEN("RESP")),") ",$$DATE^XMXUTIL2(XMZREC,0)," ",$$MELD^XMXUTIL1($$NAME^XMXUTIL($P(XMZREC,U,2),1),+$P($G(^XMB(3.9,XMZ,2,0)),U,4),XMLEN("FROM")+XMLEN("LINE"))
"RTN","XMJMP1",58,0)
 Q
"RTN","XMJMP1",59,0)
RESPHDR(XMZ,XMRESP) ;
"RTN","XMJMP1",60,0)
 N XMZREC
"RTN","XMJMP1",61,0)
 S XMZREC=$G(^XMB(3.9,XMZ,0))
"RTN","XMJMP1",62,0)
 D WL(XMRESP_") "_$$NAME^XMXUTIL($P(XMZREC,U,2),1))
"RTN","XMJMP1",63,0)
 D:$P(XMZREC,U,4)'="" W(" ",$$EZBLD^DIALOG(34533,$$NAME^XMXUTIL($P(XMZREC,U,4),1))) ; (Sender: x)
"RTN","XMJMP1",64,0)
 D W("  ",$$DATE($P(XMZREC,U,3)))
"RTN","XMJMP1",65,0)
 D W("  ",$$LINES(XMZ))
"RTN","XMJMP1",66,0)
 Q
"RTN","XMJMP1",67,0)
DATE(XMDT) ;
"RTN","XMJMP1",68,0)
 Q:XMDT'=+XMDT XMDT
"RTN","XMJMP1",69,0)
 Q $$MMDT^XMXUTIL1(XMDT)
"RTN","XMJMP1",70,0)
LINES(XMZ) ;
"RTN","XMJMP1",71,0)
 N XMLINES
"RTN","XMJMP1",72,0)
 S XMLINES=+$P($G(^XMB(3.9,XMZ,2,0)),U,4)
"RTN","XMJMP1",73,0)
 Q $$EZBLD^DIALOG($S(XMLINES=1:34534.1,1:34534),XMLINES)  ; line/lines
"RTN","XMJMP1",74,0)
PRINTIT(XMDUZ,XMK,XMKN,XMZ,XMZREC,XMRESPS,XMPTR,XMWHICH,XMRECIPS,XMDISP,XMPRTHDR,XMMULT,XMABORT) ;
"RTN","XMJMP1",75,0)
 N XMSUBJ,XMPAGE,XMZSTR,I,XMRESP,XMRANGE,XMREMMSG
"RTN","XMJMP1",76,0)
 S:'$D(XMABORT) XMABORT=0
"RTN","XMJMP1",77,0)
 S XMSUBJ=$P(XMZREC,U,1) S:XMSUBJ["~U~" XMSUBJ=$$DECODEUP^XMXUTIL1(XMSUBJ)
"RTN","XMJMP1",78,0)
 S XMSUBJ=$$EZBLD^DIALOG(34536,XMSUBJ),XMZSTR=$$EZBLD^DIALOG(34537,XMZ) ; Subj: x / [#x]
"RTN","XMJMP1",79,0)
 S XMREMMSG=($P(XMZREC,U,2)["@")
"RTN","XMJMP1",80,0)
 S XMPAGE=1
"RTN","XMJMP1",81,0)
 D:XMPRTHDR HEADER(XMDUZ,XMK,XMKN,XMZ,XMRESPS,XMZREC,XMSUBJ,XMZSTR)
"RTN","XMJMP1",82,0)
 I XMWHICH>XMRESPS D:$D(^XMB(3.7,XMDUZ,"N0",XMK,XMZ)) NONEW^XMXUTIL(XMDUZ,XMK,XMZ,1) Q
"RTN","XMJMP1",83,0)
 F I=1:1:$L(XMWHICH,",") D  Q:XMABORT
"RTN","XMJMP1",84,0)
 . S XMRANGE=$P(XMWHICH,",",I)
"RTN","XMJMP1",85,0)
 . S:$E(XMRANGE,$L(XMRANGE))="-" XMRANGE=XMRANGE_XMRESPS
"RTN","XMJMP1",86,0)
 . F XMRESP=$P(XMRANGE,"-",1):1:$S(XMRANGE["-":$P(XMRANGE,"-",2),1:XMRANGE) D  Q:XMABORT
"RTN","XMJMP1",87,0)
 . . I XMRESP>0 D RESPONSE(XMZ,.XMRESP,XMSUBJ,XMZSTR,XMDISP,XMPRTHDR,XMREMMSG,.XMPAGE,.XMABORT) Q
"RTN","XMJMP1",88,0)
 . . D BODY(XMZ,XMSUBJ,XMZSTR,XMDISP,XMPRTHDR,.XMPAGE,.XMABORT)
"RTN","XMJMP1",89,0)
 D:XMPTR LASTACC(XMDUZ,XMK,XMZ,XMZREC,XMSUBJ,XMPTR,XMRESP,+$G(XMMULT))
"RTN","XMJMP1",90,0)
 Q:XMABORT
"RTN","XMJMP1",91,0)
 D:XMRECIPS PRECIPS(XMDUZ,XMK,XMZ,XMRECIPS,XMSUBJ,XMZSTR,XMPRTHDR,.XMPAGE,.XMABORT)
"RTN","XMJMP1",92,0)
 I XMK,$D(^XMB(3.7,XMDUZ,"N0",XMK,XMZ)),+XMRESP=+$P($G(^XMB(3.9,XMZ,3,0)),U,4) D NONEW^XMXUTIL(XMDUZ,XMK,XMZ,1)
"RTN","XMJMP1",93,0)
 Q
"RTN","XMJMP1",94,0)
LASTACC(XMDUZ,XMK,XMZ,XMZREC,XMSUBJ,XMPTR,XMRESP,XMMULT) ; Note first, last accesses, number of responses read
"RTN","XMJMP1",95,0)
 N XMIM,XMIU,XMINSTR,XMCONFRM
"RTN","XMJMP1",96,0)
 S XMIM("SUBJ")=$P(XMSUBJ," ",2,99)
"RTN","XMJMP1",97,0)
 S XMIM("FROM")=$P(XMZREC,U,2)
"RTN","XMJMP1",98,0)
 S XMINSTR("FLAGS")=$S("^Y^y^"[(U_$P(XMZREC,U,5)_U):"R",1:"")
"RTN","XMJMP1",99,0)
 S XMIU("IEN")=XMPTR
"RTN","XMJMP1",100,0)
 S XMIU("RESP")=XMRESP
"RTN","XMJMP1",101,0)
 D LASTACC^XMXUTIL(XMDUZ,XMK,XMZ,XMRESP,.XMIM,.XMINSTR,.XMIU,.XMCONFRM)
"RTN","XMJMP1",102,0)
 Q:'XMCONFRM!$D(ZTQUEUED)
"RTN","XMJMP1",103,0)
 U IO(0)
"RTN","XMJMP1",104,0)
 D:XMMULT NOGOID^XMJMP2(XMZ,XMZREC)
"RTN","XMJMP1",105,0)
 W !,$$EZBLD^DIALOG(34540) ; >> Confirmation message sent to sender. <<
"RTN","XMJMP1",106,0)
 U IO
"RTN","XMJMP1",107,0)
 Q
"RTN","XMJMP1",108,0)
PRECIPS(XMDUZ,XMK,XMZ,XMRECIPS,XMSUBJ,XMZSTR,XMPRTHDR,XMPAGE,XMABORT) ; Print recipients (replaces QE2^XMA5)
"RTN","XMJMP1",109,0)
 D INFO^XMJMQ1(XMDUZ,XMK,XMZ,XMPRTHDR,XMSUBJ,XMZSTR,.XMPAGE,.XMABORT) Q:XMABORT
"RTN","XMJMP1",110,0)
 D LATER^XMJMQ1(XMDUZ,XMZ,XMPRTHDR,XMSUBJ,XMZSTR,.XMPAGE,.XMABORT) Q:XMABORT
"RTN","XMJMP1",111,0)
 I XMRECIPS=1 D
"RTN","XMJMP1",112,0)
 . D SUMMARY^XMJMQ1(XMZ,XMPRTHDR,XMSUBJ,XMZSTR,.XMPAGE,.XMABORT)
"RTN","XMJMP1",113,0)
 E  D DETAIL^XMJMQ(XMZ,XMPRTHDR,XMSUBJ,XMZSTR,.XMPAGE,.XMABORT)
"RTN","XMJMP1",114,0)
 Q
"RTN","XMJMP1",115,0)
HEADER(XMDUZ,XMK,XMKN,XMZ,XMRESPS,XMZREC,XMSUBJ,XMZSTR) ;
"RTN","XMJMP1",116,0)
 D PAGE1HDR(XMDUZ,XMK,XMKN,XMZ,XMRESPS,XMZREC,XMSUBJ,XMZSTR)
"RTN","XMJMP1",117,0)
 D W("   ",$$EZBLD^DIALOG(34541)) ; Page 1
"RTN","XMJMP1",118,0)
 I XMK,$D(^XMB(3.7,XMDUZ,"N0",XMK,XMZ)) D W("  ",$$EZBLD^DIALOG($S($D(^XMB(3.7,XMDUZ,"N",XMK,XMZ)):34543,1:34544))) ; Priority! /  *New*
"RTN","XMJMP1",119,0)
 D LINE
"RTN","XMJMP1",120,0)
 Q
"RTN","XMJMP1",121,0)
LINE ;
"RTN","XMJMP1",122,0)
 W !,"-------------------------------------------------------------------------------"
"RTN","XMJMP1",123,0)
 Q
"RTN","XMJMP1",124,0)
PAGE1HDR(XMDUZ,XMK,XMKN,XMZ,XMRESPS,XMZREC,XMSUBJ,XMZSTR) ;
"RTN","XMJMP1",125,0)
 W XMSUBJ
"RTN","XMJMP1",126,0)
 D W("  ",XMZSTR)
"RTN","XMJMP1",127,0)
 D W(" ",$$DATE($P(XMZREC,U,3)))
"RTN","XMJMP1",128,0)
 D W("  ",$$LINES(XMZ))
"RTN","XMJMP1",129,0)
 ;D:$O(^XMB(3.9,XMZ,2005,0)) W(" ",$$EZBLD^DIALOG(34573)) ; Attachment(s).
"RTN","XMJMP1",130,0)
 D WL($$EZBLD^DIALOG(34538,$$NAME^XMXUTIL($P(XMZREC,U,2),1))) ; From:
"RTN","XMJMP1",131,0)
 D:$P(XMZREC,U,4)'="" W(" ",$$EZBLD^DIALOG(34533,$$NAME^XMXUTIL($P(XMZREC,U,4),1))) ; (Sender: x)
"RTN","XMJMP1",132,0)
 I XMRESPS>0 D
"RTN","XMJMP1",133,0)
 . N XMPTR,XMRESP,XMPARM
"RTN","XMJMP1",134,0)
 . ;S XMPTR=+$O(^XMB(3.9,XMZ,1,"C",$S(XMDUZ=.6:DUZ,1:XMDUZ),0))
"RTN","XMJMP1",135,0)
 . S XMPTR=+$O(^XMB(3.9,XMZ,1,"C",XMDUZ,0))
"RTN","XMJMP1",136,0)
 . S XMRESP=+$P($G(^XMB(3.9,XMZ,1,XMPTR,0)),U,2)
"RTN","XMJMP1",137,0)
 . S XMPARM(1)=XMRESP,XMPARM(2)=XMRESPS
"RTN","XMJMP1",138,0)
 . D W("  ",$$EZBLD^DIALOG($S(XMRESPS=1:34545,1:34546),.XMPARM)) ; XMRESP_ of _XMRESPS_ response(s) read.
"RTN","XMJMP1",139,0)
 D W("  ",$$EZBLD^DIALOG(34539,XMKN)) ; In '_XMKN_' basket.
"RTN","XMJMP1",140,0)
 I $O(^XMB(3.73,"AC",XMZ,XMDUZ,0)) D W("  ",$$EZBLD^DIALOG(34595.1)) ; Message will be NEW Later.
"RTN","XMJMP1",141,0)
 I XMK D
"RTN","XMJMP1",142,0)
 . N XMVAPOR
"RTN","XMJMP1",143,0)
 . S XMVAPOR=$P($G(^XMB(3.7,XMDUZ,2,XMK,1,XMZ,0)),U,5)
"RTN","XMJMP1",144,0)
 . I XMVAPOR D W("  ",$$EZBLD^DIALOG(34572,$$FMTE^XLFDT(XMVAPOR))) ; Automatic Deletion Date:
"RTN","XMJMP1",145,0)
 Q
"RTN","XMJMP1",146,0)
WL(XMSTRING) ;
"RTN","XMJMP1",147,0)
 I $L(XMSTRING)'<IOM,IOM>1 F  D  Q:$L(XMSTRING)<IOM
"RTN","XMJMP1",148,0)
 . W !,$E(XMSTRING,1,IOM-1)
"RTN","XMJMP1",149,0)
 . S XMSTRING=$E(XMSTRING,IOM,999)
"RTN","XMJMP1",150,0)
 W !,XMSTRING
"RTN","XMJMP1",151,0)
 Q
"RTN","XMJMP1",152,0)
W(XMSPACE,XMSTRING) ;
"RTN","XMJMP1",153,0)
 I $X+$L(XMSPACE)+$L(XMSTRING)>IOM D WL(XMSTRING) Q
"RTN","XMJMP1",154,0)
 W XMSPACE,XMSTRING
"RTN","XMJMP1",155,0)
 Q
"RTN","XMJMP1",156,0)
BODY(XMZ,XMSUBJ,XMZSTR,XMDISP,XMPRTHDR,XMPAGE,XMABORT) ;
"RTN","XMJMP1",157,0)
 N XMTEXT,I,J
"RTN","XMJMP1",158,0)
 S I=.999999
"RTN","XMJMP1",159,0)
 F  S I=$O(^XMB(3.9,XMZ,2,I)) Q:I'>0  D  Q:XMABORT
"RTN","XMJMP1",160,0)
 . S XMTEXT=^XMB(3.9,XMZ,2,I,0)
"RTN","XMJMP1",161,0)
 . I $D(XMSECURE),'$G(XMPAKMAN) S XMTEXT=$$DECSTR^XMJMCODE(XMTEXT) ; PackMan messages are never scrambled, just "secured".
"RTN","XMJMP1",162,0)
 . I $E(XMTEXT,1)="$",$F("$TXT$END",$E(XMTEXT,1,4))#4=1 S XMTEXT=$P(XMTEXT,U) ; hide code for secured packman msg.
"RTN","XMJMP1",163,0)
 . I XMTEXT["|TAB|" F  S J=$F(XMTEXT,"|TAB|")-6 Q:J<0  S XMTEXT=$E(XMTEXT,1,J)_$E("         ",1,9-(J-(J\9*9)))_$E(XMTEXT,J+6,999)
"RTN","XMJMP1",164,0)
 . ; A site was sending a print to a device whose IOM was 0.
"RTN","XMJMP1",165,0)
 . ; In such a case, we should ignore IOM.
"RTN","XMJMP1",166,0)
 . F  D  Q:$L(XMTEXT)<IOM!XMABORT!(IOM<2)  S XMTEXT=$E(XMTEXT,IOM,999)
"RTN","XMJMP1",167,0)
 . . I $Y+3+($G(IOST)["C-")>IOSL D  Q:XMABORT
"RTN","XMJMP1",168,0)
 . . . D PAGE(XMZ,XMSUBJ,XMZSTR,XMDISP,XMPRTHDR,.XMPAGE,.XMABORT)
"RTN","XMJMP1",169,0)
 . . E  W !
"RTN","XMJMP1",170,0)
 . . W $S(IOM>1:$E(XMTEXT,1,IOM-1),1:XMTEXT)
"RTN","XMJMP1",171,0)
 Q
"RTN","XMJMP1",172,0)
PAGE(XMZ,XMSUBJ,XMZSTR,XMDISP,XMPRTHDR,XMPAGE,XMABORT) ;
"RTN","XMJMP1",173,0)
 I $G(IOST)["C-",XMDISP W ! D PAGE^XMXUTIL(.XMABORT) Q:XMABORT
"RTN","XMJMP1",174,0)
 W @IOF
"RTN","XMJMP1",175,0)
 D:XMPRTHDR PAGE2HDR(XMSUBJ,XMZSTR,.XMPAGE)
"RTN","XMJMP1",176,0)
 Q
"RTN","XMJMP1",177,0)
PAGE2HDR(XMSUBJ,XMZSTR,XMPAGE) ;
"RTN","XMJMP1",178,0)
 S XMPAGE=XMPAGE+1
"RTN","XMJMP1",179,0)
 W XMSUBJ
"RTN","XMJMP1",180,0)
 D W("  ",XMZSTR)
"RTN","XMJMP1",181,0)
 D W("   ",$$EZBLD^DIALOG(34542,XMPAGE)) ; Page x
"RTN","XMJMP1",182,0)
 D LINE
"RTN","XMJMP1",183,0)
 W !
"RTN","XMJMP1",184,0)
 Q
"RTN","XMJMP1",185,0)
RESPONSE(XMZ,XMRESP,XMSUBJ,XMZSTR,XMDISP,XMPRTHDR,XMREMMSG,XMPAGE,XMABORT) ;
"RTN","XMJMP1",186,0)
 N XMZR,XMRSUBJ,XMREMREP
"RTN","XMJMP1",187,0)
 S XMZR=+$P($G(^XMB(3.9,XMZ,3,XMRESP,0)),U)
"RTN","XMJMP1",188,0)
 ;I '$D(^XMB(3.9,XMZR,0)) D  Q
"RTN","XMJMP1",189,0)
 ;. ;N DA,DIK
"RTN","XMJMP1",190,0)
 ;. ;S DA(1)=XMZ,DA=XMRESP
"RTN","XMJMP1",191,0)
 ;. ;S DIK="^XMB(3.9,XMZ,3,"
"RTN","XMJMP1",192,0)
 ;. ;D ^DIK
"RTN","XMJMP1",193,0)
 S XMRSUBJ=$P($G(^XMB(3.9,XMZR,0)),U)
"RTN","XMJMP1",194,0)
 S XMREMREP=$S(XMRSUBJ?1"R"1.N:0,XMRSUBJ="":0,1:1) ; Reply is to or from a remote site
"RTN","XMJMP1",195,0)
 I $Y+(XMREMMSG!XMREMREP)+7+($G(IOST)["C-")>IOSL D  Q:XMABORT
"RTN","XMJMP1",196,0)
 . D PAGE(XMZR,XMSUBJ,XMZSTR,XMDISP,XMPRTHDR,.XMPAGE,.XMABORT)
"RTN","XMJMP1",197,0)
 . S:XMABORT XMRESP=XMRESP-1
"RTN","XMJMP1",198,0)
 E  W !
"RTN","XMJMP1",199,0)
 D RESPHDR(XMZR,XMRESP)
"RTN","XMJMP1",200,0)
 I XMREMREP D
"RTN","XMJMP1",201,0)
 . W !,"   ",$$EZBLD^DIALOG(34536,$S(XMRSUBJ["~U~":$$DECODEUP^XMXUTIL1(XMRSUBJ),1:XMRSUBJ)) ; Subj:
"RTN","XMJMP1",202,0)
 E  I XMREMMSG D
"RTN","XMJMP1",203,0)
 . W !,"   ",$$EZBLD^DIALOG(34535) ; <Local Reply>
"RTN","XMJMP1",204,0)
 W !
"RTN","XMJMP1",205,0)
 D BODY(XMZR,XMSUBJ,XMZSTR,XMDISP,XMPRTHDR,.XMPAGE,.XMABORT)
"RTN","XMJMP1",206,0)
 Q
"RTN","XMJMP2")
0^299^B6095644
"RTN","XMJMP2",1,0)
XMJMP2 ;ISC-SF/GMB-Print,Backup (cont.) ;05/20/2002  14:21
"RTN","XMJMP2",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMJMP2",3,0)
CHECK(XMDUZ,XMZ,XMZREC,XMNOGO) ;
"RTN","XMJMP2",4,0)
 D CONFID(XMDUZ,XMZ,XMZREC,.XMNOGO) Q:XMNOGO
"RTN","XMJMP2",5,0)
 D SCRAMBLE(XMZ,XMZREC,.XMNOGO)
"RTN","XMJMP2",6,0)
 Q
"RTN","XMJMP2",7,0)
CONFID(XMDUZ,XMZ,XMZREC,XMNOGO) ; Check to see if msg is confidential
"RTN","XMJMP2",8,0)
 Q:XMDUZ=DUZ
"RTN","XMJMP2",9,0)
 Q:$$SURRACC^XMXSEC(XMDUZ,"",XMZ,XMZREC)  ; "access"
"RTN","XMJMP2",10,0)
 S XMNOGO=1
"RTN","XMJMP2",11,0)
 I $D(ZTQUEUED) D  Q
"RTN","XMJMP2",12,0)
 . S XMNOGO(1)=^TMP("XMERR",$J,XMERR,"TEXT",1)
"RTN","XMJMP2",13,0)
 . K XMERR,^TMP("XMERR",$J)
"RTN","XMJMP2",14,0)
 U IO(0)  ; In case we are not printing to terminal
"RTN","XMJMP2",15,0)
 D NOGOID(XMZ,XMZREC)
"RTN","XMJMP2",16,0)
 W !,^TMP("XMERR",$J,XMERR,"TEXT",1)
"RTN","XMJMP2",17,0)
 K XMERR,^TMP("XMERR",$J)
"RTN","XMJMP2",18,0)
 U IO
"RTN","XMJMP2",19,0)
 Q
"RTN","XMJMP2",20,0)
SCRAMBLE(XMZ,XMZREC,XMNOGO) ;
"RTN","XMJMP2",21,0)
 ; If '$D(ZTQUEUED), and scrambled, ask the user for the password.
"RTN","XMJMP2",22,0)
 Q:'$D(^XMB(3.9,XMZ,"K"))!$D(XMSECURE)
"RTN","XMJMP2",23,0)
 I XMPAKMAN D  Q
"RTN","XMJMP2",24,0)
 . N XMERRMSG
"RTN","XMJMP2",25,0)
 . S XMERRMSG=$$EZBLD^DIALOG(37416.4) ; You may not Print a secure KIDS or PackMan message.
"RTN","XMJMP2",26,0)
 . S XMNOGO=1
"RTN","XMJMP2",27,0)
 . I $D(ZTQUEUED) D  Q
"RTN","XMJMP2",28,0)
 . . S XMNOGO(1)=XMERRMSG
"RTN","XMJMP2",29,0)
 . U IO(0)  ; In case we are not printing to terminal
"RTN","XMJMP2",30,0)
 . D NOGOID(XMZ,XMZREC)
"RTN","XMJMP2",31,0)
 . W !,XMERRMSG
"RTN","XMJMP2",32,0)
 . U IO
"RTN","XMJMP2",33,0)
 I $D(ZTQUEUED) D  Q
"RTN","XMJMP2",34,0)
 . S XMNOGO=1
"RTN","XMJMP2",35,0)
 . ;This message has been secured with a password.
"RTN","XMJMP2",36,0)
 . ;When a range of messages is queued to print,
"RTN","XMJMP2",37,0)
 . ;those messages with passwords cannot be printed because
"RTN","XMJMP2",38,0)
 . ;there is no opportunity to ask for the password.
"RTN","XMJMP2",39,0)
 . D BLD^DIALOG(34521,"","","XMNOGO")
"RTN","XMJMP2",40,0)
 U IO(0)  ; In case we are not printing to terminal
"RTN","XMJMP2",41,0)
 S:'$$KEYOK^XMJMCODE(XMZ,$P(XMZREC,U,10)) XMNOGO=1
"RTN","XMJMP2",42,0)
 U IO
"RTN","XMJMP2",43,0)
 Q
"RTN","XMJMP2",44,0)
NOGOID(XMZ,XMZREC,XMNOCR) ;
"RTN","XMJMP2",45,0)
 N XMSUBJ
"RTN","XMJMP2",46,0)
 S XMSUBJ=$P(XMZREC,U,1)
"RTN","XMJMP2",47,0)
 S:XMSUBJ["~U~" XMSUBJ=$$DECODEUP^XMXUTIL1(XMSUBJ)
"RTN","XMJMP2",48,0)
 W !,$$EZBLD^DIALOG(34536,XMSUBJ),"  ",$$EZBLD^DIALOG(34537,XMZ) ; Subj: _XMSUBJ_  _[#_XMZ_]
"RTN","XMJMP2",49,0)
 W !,$$EZBLD^DIALOG(34538,$$NAME^XMXUTIL($P(XMZREC,U,2),1)) ; From:
"RTN","XMJMP2",50,0)
 W:'$G(XMNOCR) !
"RTN","XMJMP2",51,0)
 Q
"RTN","XMJMP2",52,0)
NOGOMSG(XMDUZ,XMZ,XMZREC,XMNOGO) ;
"RTN","XMJMP2",53,0)
 N I
"RTN","XMJMP2",54,0)
 D NOGOID(XMZ,XMZREC)
"RTN","XMJMP2",55,0)
 S I=""
"RTN","XMJMP2",56,0)
 F  S I=$O(XMNOGO(I)) Q:I=""  D
"RTN","XMJMP2",57,0)
 . W !,XMNOGO(I)
"RTN","XMJMP2",58,0)
 Q
"RTN","XMJMQ")
0^226^B54683650
"RTN","XMJMQ",1,0)
XMJMQ ;ISC-SF/GMB-Q,QD,QN Query recipients ;04/17/2002  10:10
"RTN","XMJMQ",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMJMQ",3,0)
 ; Replaces ^XMA5,^XMA5A (ISC-WASH/THM/CAP)
"RTN","XMJMQ",4,0)
Q(XMDUZ,XMK,XMKN,XMZ) ; Query
"RTN","XMJMQ",5,0)
 N XMRESPM,XMABORT
"RTN","XMJMQ",6,0)
 D QINIT^XMJMQ1(XMDUZ,XMK,XMKN,XMZ,.XMRESPM,.XMABORT)
"RTN","XMJMQ",7,0)
 D SUMMARY^XMJMQ1(XMZ,0,"","","",.XMABORT)
"RTN","XMJMQ",8,0)
 Q
"RTN","XMJMQ",9,0)
QD(XMDUZ,XMK,XMKN,XMZ) ; Query Detail
"RTN","XMJMQ",10,0)
 N XMRESPM,XMABORT
"RTN","XMJMQ",11,0)
 D QINIT^XMJMQ1(XMDUZ,XMK,XMKN,XMZ,.XMRESPM,.XMABORT)
"RTN","XMJMQ",12,0)
 D DETAIL(XMZ,0,"","","",.XMABORT)
"RTN","XMJMQ",13,0)
 Q
"RTN","XMJMQ",14,0)
QN(XMDUZ,XMK,XMKN,XMZ) ; Query Network
"RTN","XMJMQ",15,0)
 N XMRESPM,XMABORT
"RTN","XMJMQ",16,0)
 D QINIT^XMJMQ1(XMDUZ,XMK,XMKN,XMZ,.XMRESPM,.XMABORT)
"RTN","XMJMQ",17,0)
 D NETWORK^XMJMQ1(XMZ,.XMABORT) Q:XMABORT
"RTN","XMJMQ",18,0)
 D DETAIL(XMZ,0,"","","",.XMABORT)
"RTN","XMJMQ",19,0)
 Q
"RTN","XMJMQ",20,0)
QX(XMDUZ,XMK,XMKN,XMZ,XMWHAT) ; Query Special
"RTN","XMJMQ",21,0)
 ; XMWHAT = "QC"  - show local users who are current
"RTN","XMJMQ",22,0)
 ;          "QNC" - show local users who are not current
"RTN","XMJMQ",23,0)
 ;          "QT"  - show local users who have terminated
"RTN","XMJMQ",24,0)
 N XMRESPM,XMABORT,XMTO,XMIEN,XMTYPE,XMRESPS,XMCNT,XMTOTAL,XMPHDR
"RTN","XMJMQ",25,0)
 D QINIT^XMJMQ1(XMDUZ,XMK,XMKN,XMZ,.XMRESPM,.XMABORT)
"RTN","XMJMQ",26,0)
 I $Y+3>IOSL D PAGE(.XMABORT) Q:XMABORT
"RTN","XMJMQ",27,0)
 S XMRESPS=+$P($G(^XMB(3.9,XMZ,3,0)),U,4)
"RTN","XMJMQ",28,0)
 W !
"RTN","XMJMQ",29,0)
 S (XMPHDR,XMCNT,XMTOTAL,XMTO)=0
"RTN","XMJMQ",30,0)
 F  S XMTO=$O(^XMB(3.9,XMZ,1,"C",XMTO)) Q:+XMTO'=XMTO  D  Q:XMABORT
"RTN","XMJMQ",31,0)
 . S XMTOTAL=XMTOTAL+1
"RTN","XMJMQ",32,0)
 . S XMIEN=$O(^XMB(3.9,XMZ,1,"C",XMTO,""))
"RTN","XMJMQ",33,0)
 . I XMWHAT="QC",$P(^XMB(3.9,XMZ,1,XMIEN,0),U,2)'=XMRESPS Q  ; not current
"RTN","XMJMQ",34,0)
 . I XMWHAT="QNC",$P(^XMB(3.9,XMZ,1,XMIEN,0),U,2)=XMRESPS Q  ; current
"RTN","XMJMQ",35,0)
 . I XMWHAT="QT",'$G(^XMB(3.9,XMZ,1,XMIEN,"D")) Q  ; not terminated
"RTN","XMJMQ",36,0)
 . S XMCNT=XMCNT+1
"RTN","XMJMQ",37,0)
 . D WNAME(XMZ,$$NAME^XMXUTIL(XMTO),XMIEN,XMRESPM,.XMTYPE,.XMABORT)
"RTN","XMJMQ",38,0)
 Q:XMABORT
"RTN","XMJMQ",39,0)
 I $Y+3+(XMCNT>0)>IOSL D PAGE(.XMABORT) Q:XMABORT
"RTN","XMJMQ",40,0)
 N XMTEXT,XMPARM
"RTN","XMJMQ",41,0)
 I XMCNT W !
"RTN","XMJMQ",42,0)
 S XMPARM(1)=XMCNT,XMPARM(2)=XMTOTAL
"RTN","XMJMQ",43,0)
 D BLD^DIALOG($S(XMWHAT="QC":37431.9,XMWHAT="QNC":37432.9,1:37433.9),.XMPARM,"","XMTEXT","F")
"RTN","XMJMQ",44,0)
 D MSG^DIALOG("WM","",IOM,"","XMTEXT")
"RTN","XMJMQ",45,0)
 ; Local recipients who are (not) current: |1| of |2|
"RTN","XMJMQ",46,0)
 ; Local recipients who have terminated: |1| of |2|
"RTN","XMJMQ",47,0)
 Q
"RTN","XMJMQ",48,0)
QNAME(XMDUZ,XMK,XMKN,XMZ) ; Query someone's name
"RTN","XMJMQ",49,0)
 N XMRESPM,XMABORT,DIR,Y,DIRUT,XMNAME
"RTN","XMJMQ",50,0)
 F  D  Q:$D(DIRUT)
"RTN","XMJMQ",51,0)
 . S DIR(0)="FO^1:30^K:"", ""[$E(X) X"
"RTN","XMJMQ",52,0)
 . S DIR("A")=$$EZBLD^DIALOG(34555) ; Enter the person's name or partial name
"RTN","XMJMQ",53,0)
 . D BLD^DIALOG(34556,"","","DIR(""?"")")
"RTN","XMJMQ",54,0)
 . ;Name must be from 1 to 30 characters,
"RTN","XMJMQ",55,0)
 . ;and must not contain ^, or begin with comma or space.
"RTN","XMJMQ",56,0)
 . D ^DIR Q:$D(DIRUT)
"RTN","XMJMQ",57,0)
 . S XMNAME=Y
"RTN","XMJMQ",58,0)
 . D QINIT^XMJMQ1(XMDUZ,XMK,XMKN,XMZ,.XMRESPM,.XMABORT)
"RTN","XMJMQ",59,0)
 . D SEARCH^XMJMQ1(XMZ,XMNAME,XMRESPM)
"RTN","XMJMQ",60,0)
 Q
"RTN","XMJMQ",61,0)
QNAMEX(XMDUZ,XMK,XMKN,XMZ,XMNAME) ; Query someone's name (name is supplied)
"RTN","XMJMQ",62,0)
 N XMRESPM,XMABORT
"RTN","XMJMQ",63,0)
 I ($L(XMNAME)<1)!($L(XMNAME)>30)!(XMNAME[U)!(", "[$E(XMNAME,1)) D  Q
"RTN","XMJMQ",64,0)
 . N XMTEXT
"RTN","XMJMQ",65,0)
 . W $C(7)
"RTN","XMJMQ",66,0)
 . D BLD^DIALOG(34556,"","","XMTEXT","F")
"RTN","XMJMQ",67,0)
 . D MSG^DIALOG("WH","","","","XMTEXT")
"RTN","XMJMQ",68,0)
 . ;Name must be from 1 to 30 characters,
"RTN","XMJMQ",69,0)
 . ;and must not contain ^, or begin with comma or space.
"RTN","XMJMQ",70,0)
 D QINIT^XMJMQ1(XMDUZ,XMK,XMKN,XMZ,.XMRESPM,.XMABORT)
"RTN","XMJMQ",71,0)
 D SEARCH^XMJMQ1(XMZ,XMNAME,XMRESPM)
"RTN","XMJMQ",72,0)
 Q
"RTN","XMJMQ",73,0)
DETAIL(XMZ,XMPHDR,XMSUBJ,XMZSTR,XMPAGE,XMABORT) ;
"RTN","XMJMQ",74,0)
 ; XMRESPM  Last part msg: of Number of responses in msg
"RTN","XMJMQ",75,0)
 N XMTO,XMRESPM,XMNAME,XMIEN,XMTYPE
"RTN","XMJMQ",76,0)
 I $Y+3>IOSL D PAGE(.XMABORT) Q:XMABORT
"RTN","XMJMQ",77,0)
 W !
"RTN","XMJMQ",78,0)
 S XMRESPM=+$P($G(^XMB(3.9,XMZ,3,0)),U,4)
"RTN","XMJMQ",79,0)
 S XMRESPM=$$EZBLD^DIALOG($S(XMRESPM=1:34557.1,1:34557),XMRESPM) ; XMRESPM_ response / responses
"RTN","XMJMQ",80,0)
 S XMTO="*" ; Show broadcast first.
"RTN","XMJMQ",81,0)
 F  S XMTO=$O(^XMB(3.9,XMZ,1,"C",XMTO)) Q:$E(XMTO,1,1)'="*"  D  Q:XMABORT
"RTN","XMJMQ",82,0)
 . S XMIEN=$O(^XMB(3.9,XMZ,1,"C",XMTO,""))
"RTN","XMJMQ",83,0)
 . S XMNAME=$P(^XMB(3.9,XMZ,1,XMIEN,0),U,1)
"RTN","XMJMQ",84,0)
 . D WNAME(XMZ,XMNAME,XMIEN,XMRESPM,.XMTYPE,.XMABORT)
"RTN","XMJMQ",85,0)
 Q:XMABORT
"RTN","XMJMQ",86,0)
 S XMTO=""
"RTN","XMJMQ",87,0)
 F  S XMTO=$O(^XMB(3.9,XMZ,1,"C",XMTO)) Q:XMTO=""  D  Q:XMABORT
"RTN","XMJMQ",88,0)
 . S XMIEN=$O(^XMB(3.9,XMZ,1,"C",XMTO,""))
"RTN","XMJMQ",89,0)
 . I XMTO=+XMTO D
"RTN","XMJMQ",90,0)
 . . S XMNAME=$$NAME^XMXUTIL(XMTO)
"RTN","XMJMQ",91,0)
 . E  D  Q:$E(XMTO,1,1)="*"
"RTN","XMJMQ",92,0)
 . . I $L(XMTO)>29 S XMNAME=$P(^XMB(3.9,XMZ,1,XMIEN,0),U,1) Q
"RTN","XMJMQ",93,0)
 . . S XMNAME=XMTO
"RTN","XMJMQ",94,0)
 . D WNAME(XMZ,XMNAME,XMIEN,XMRESPM,.XMTYPE,.XMABORT)
"RTN","XMJMQ",95,0)
 Q
"RTN","XMJMQ",96,0)
WNAME(XMZ,XMNAME,XMIEN,XMRESPM,XMTYPE,XMABORT) ;
"RTN","XMJMQ",97,0)
 N XMREC
"RTN","XMJMQ",98,0)
 S XMREC=^XMB(3.9,XMZ,1,XMIEN,0)
"RTN","XMJMQ",99,0)
 I $Y+3>IOSL D PAGE(.XMABORT) Q:XMABORT
"RTN","XMJMQ",100,0)
 W !
"RTN","XMJMQ",101,0)
 I $D(^XMB(3.9,XMZ,1,XMIEN,"T")) D  ; CC: Info: Thru:
"RTN","XMJMQ",102,0)
 . S XMTYPE=$P(^XMB(3.9,XMZ,1,XMIEN,"T"),U,1)
"RTN","XMJMQ",103,0)
 . Q:XMTYPE=""
"RTN","XMJMQ",104,0)
 . S:'$D(XMTYPE(XMTYPE)) XMTYPE(XMTYPE)=$$EXTERNAL^DILFD(3.91,6.5,"",XMTYPE)
"RTN","XMJMQ",105,0)
 . W XMTYPE(XMTYPE),": "
"RTN","XMJMQ",106,0)
 W XMNAME
"RTN","XMJMQ",107,0)
 W:$X<18 ?18
"RTN","XMJMQ",108,0)
 I +$P(XMREC,U,1)=$P(XMREC,U,1) D  Q  ; local user
"RTN","XMJMQ",109,0)
 . I $P(XMREC,U,3)="" D
"RTN","XMJMQ",110,0)
 . . W $$EZBLD^DIALOG(34574) ; " Not read."
"RTN","XMJMQ",111,0)
 . E  D  Q:XMABORT
"RTN","XMJMQ",112,0)
 . . D W3(34575,$$MMDT^XMXUTIL1($P(XMREC,U,3)),.XMABORT) Q:XMABORT  ; Last read:
"RTN","XMJMQ",113,0)
 . . I $P(XMREC,U,2) D  Q:XMABORT
"RTN","XMJMQ",114,0)
 . . . N XMPARM
"RTN","XMJMQ",115,0)
 . . . S XMPARM(1)=$P(XMREC,U,2),XMPARM(2)=XMRESPM
"RTN","XMJMQ",116,0)
 . . . D W3(34576,.XMPARM,.XMABORT) ; (x of y responses)
"RTN","XMJMQ",117,0)
 . . I $P(XMREC,U,10)'="" D W3(34577,$$MMDT^XMXUTIL1($P(XMREC,U,10)),.XMABORT) Q:XMABORT  ; [First read: x]
"RTN","XMJMQ",118,0)
 . . I $D(^XMB(3.9,XMZ,1,XMIEN,"C")) D W3(34578,$$MMDT^XMXUTIL1(^("C")),.XMABORT) Q:XMABORT  ; Copied:
"RTN","XMJMQ",119,0)
 . . I $D(^XMB(3.9,XMZ,1,XMIEN,"S")) D W3(34580,^("S"),.XMABORT) Q:XMABORT  ; Surrogate:
"RTN","XMJMQ",120,0)
 . . I $D(^XMB(3.9,XMZ,1,XMIEN,"D")),^("D") D W3(34581,$$MMDT^XMXUTIL1(^("D")),.XMABORT) Q:XMABORT  ; Terminated:
"RTN","XMJMQ",121,0)
 . I $D(^XMB(3.9,XMZ,1,XMIEN,"F")) D FWD(XMZ,XMIEN,.XMABORT) Q:XMABORT
"RTN","XMJMQ",122,0)
 I $E(XMNAME,1,2)="F.",$P(XMREC,U,12)'=""!$P(XMREC,U,11) D  Q
"RTN","XMJMQ",123,0)
 . I $P(XMREC,U,5)'="" D W3(34582,$$MMDT^XMXUTIL1($P(XMREC,U,5)),.XMABORT) Q:XMABORT  ; Sent to fax:
"RTN","XMJMQ",124,0)
 . I $P(XMREC,U,6)'="" D W3(34583,$P(XMREC,U,6),.XMABORT) Q:XMABORT  ; Status:
"RTN","XMJMQ",125,0)
 . I $P(XMREC,U,12)'="" D W3(34584,$P(XMREC,U,12),.XMABORT) Q:XMABORT  ; Fax ID:
"RTN","XMJMQ",126,0)
 . I $D(^XMB(3.9,XMZ,1,XMIEN,"F")) D FWD(XMZ,XMIEN,.XMABORT) Q:XMABORT
"RTN","XMJMQ",127,0)
 I XMNAME["@" D  Q
"RTN","XMJMQ",128,0)
 . I $P(XMREC,U,5)'="" D W3(34585,$$MMDT^XMXUTIL1($P(XMREC,U,5)),.XMABORT) Q:XMABORT  ; Sent:
"RTN","XMJMQ",129,0)
 . I $P(XMREC,U,8)'="" D W3($S($P(XMREC,U,8)=1:34586,1:34587),$P(XMREC,U,8),.XMABORT) Q:XMABORT  ; Time: x seconds
"RTN","XMJMQ",130,0)
 . I $P(XMREC,U,7)'="",$D(^DIC(4.2,$P(XMREC,U,7),0)) D W3(34588,$P(^(0),U),.XMABORT) Q:XMABORT  ; Path:
"RTN","XMJMQ",131,0)
 . I $P(XMREC,U,4)'="" D W3(34590,$P(XMREC,U,4),.XMABORT) Q:XMABORT  ; Message ID:
"RTN","XMJMQ",132,0)
 . I $P(XMREC,U,6)'="" D W3(34583,$P(XMREC,U,6),.XMABORT) Q:XMABORT  ; Status:
"RTN","XMJMQ",133,0)
 . I $D(^XMB(3.9,XMZ,1,XMIEN,"F")) D FWD(XMZ,XMIEN,.XMABORT) Q:XMABORT
"RTN","XMJMQ",134,0)
 I $E(XMNAME,1,3)="* (" D  Q  ; Broadcast
"RTN","XMJMQ",135,0)
 . I $D(^XMB(3.9,XMZ,1,XMIEN,"F")) D FWD(XMZ,XMIEN,.XMABORT)
"RTN","XMJMQ",136,0)
 I ".D.H.S."[("."_$E(XMNAME,1,2)) D  Q
"RTN","XMJMQ",137,0)
 . I $P(XMREC,U,3)'="" D W3(34591,$$MMDT^XMXUTIL1($P(XMREC,U,3)),.XMABORT) Q:XMABORT  ; Date:
"RTN","XMJMQ",138,0)
 . I $P(XMREC,U,6)'="" D W3(34583,$P(XMREC,U,6),.XMABORT) Q:XMABORT  ; Status:
"RTN","XMJMQ",139,0)
 . I $D(^XMB(3.9,XMZ,1,XMIEN,"F")) D FWD(XMZ,XMIEN,.XMABORT) Q:XMABORT
"RTN","XMJMQ",140,0)
 Q
"RTN","XMJMQ",141,0)
FWD(XMZ,XMIEN,XMABORT) ;
"RTN","XMJMQ",142,0)
 N XMFWDREC,XMFWDBY,XMFWDTYP
"RTN","XMJMQ",143,0)
 S XMFWDREC=^XMB(3.9,XMZ,1,XMIEN,"F")
"RTN","XMJMQ",144,0)
 S XMFWDBY=$P(XMFWDREC,U)
"RTN","XMJMQ",145,0)
 I $E(XMFWDBY,1)=" " D W3(34592,XMFWDBY,.XMABORT) Q  ; Forwarded on:
"RTN","XMJMQ",146,0)
 I $E(XMFWDBY,1)?1N!($E(XMFWDBY,1)=".") D W3(34593,$$NAME^XMXUTIL(+XMFWDBY)_" "_$P(XMFWDBY," ",2,99),.XMABORT) Q  ; Forwarded by:
"RTN","XMJMQ",147,0)
 S XMFWDTYP=$P(XMFWDREC,U,3)
"RTN","XMJMQ",148,0)
 D W3($S(XMFWDTYP="A":34593.1,XMFWDTYP="F":34593.2,1:34593),XMFWDBY,.XMABORT) ; Auto-Forwarded / Filter-Forwarded / Forwarded by:
"RTN","XMJMQ",149,0)
 Q:$P(XMFWDREC,U,4)=""
"RTN","XMJMQ",150,0)
 N XMPARM
"RTN","XMJMQ",151,0)
 S XMPARM(1)=$$NAME^XMXUTIL($P(XMFWDREC,U,2))
"RTN","XMJMQ",152,0)
 S XMPARM(2)=$P(XMFWDREC,U,4)
"RTN","XMJMQ",153,0)
 S XMFWDTYP=$P(XMFWDREC,U,5)
"RTN","XMJMQ",154,0)
 ; Filter-Forwarded / Forwarded to |1| by: |2|
"RTN","XMJMQ",155,0)
 D W3($S(XMFWDTYP="F":34594.1,1:34594),.XMPARM,.XMABORT)
"RTN","XMJMQ",156,0)
 Q
"RTN","XMJMQ",157,0)
W3(XMPIECE,XMPARM,XMABORT) ;
"RTN","XMJMQ",158,0)
 S XMPIECE=$$EZBLD^DIALOG(XMPIECE,.XMPARM)
"RTN","XMJMQ",159,0)
 I 1+$L(XMPIECE)+$X>IOM D  Q:XMABORT
"RTN","XMJMQ",160,0)
 . I $Y+3+($L(XMPIECE)-1\60)>IOSL D PAGE(.XMABORT) Q:XMABORT
"RTN","XMJMQ",161,0)
 . W !,?18
"RTN","XMJMQ",162,0)
 . Q:$L(XMPIECE)<61
"RTN","XMJMQ",163,0)
 . F  D  Q:$L(XMPIECE)<61
"RTN","XMJMQ",164,0)
 . . W " ",$E(XMPIECE,1,60),!,?18
"RTN","XMJMQ",165,0)
 . . S XMPIECE=$E(XMPIECE,61,999)
"RTN","XMJMQ",166,0)
 W " ",XMPIECE
"RTN","XMJMQ",167,0)
 Q
"RTN","XMJMQ",168,0)
 ;PAGE(XMPHDR,XMSUBJ,XMZSTR,XMPAGE,XMABORT);
"RTN","XMJMQ",169,0)
PAGE(XMABORT) ;
"RTN","XMJMQ",170,0)
 I $G(IOST)["C-" D PAGE^XMXUTIL(.XMABORT) Q:XMABORT
"RTN","XMJMQ",171,0)
 W @IOF
"RTN","XMJMQ",172,0)
 Q:'XMPHDR
"RTN","XMJMQ",173,0)
 D PAGE2HDR^XMJMP1(XMSUBJ,XMZSTR,.XMPAGE)
"RTN","XMJMQ",174,0)
 Q
"RTN","XMJMQ1")
0^300^B48669689
"RTN","XMJMQ1",1,0)
XMJMQ1 ;ISC-SF/GMB-Q,QD,QN Query recipients (cont.) ;04/17/2002  10:11
"RTN","XMJMQ1",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMJMQ1",3,0)
 ; Replaces ^XMA5,^XMA5A (ISC-WASH/THM/CAP)
"RTN","XMJMQ1",4,0)
QINIT(XMDUZ,XMK,XMKN,XMZ,XMRESPM,XMABORT) ;
"RTN","XMJMQ1",5,0)
 N XMZSTR,XMSUBJ,XMRESPS
"RTN","XMJMQ1",6,0)
 S XMABORT=0
"RTN","XMJMQ1",7,0)
 S XMZSTR=$$EZBLD^DIALOG(34537,XMZ) ; [#_XMZ_]
"RTN","XMJMQ1",8,0)
 S XMSUBJ=$P(^XMB(3.9,XMZ,0),U)
"RTN","XMJMQ1",9,0)
 S:XMSUBJ["~U~" XMSUBJ=$$DECODEUP^XMXUTIL1(XMSUBJ)
"RTN","XMJMQ1",10,0)
 S XMSUBJ=$$EZBLD^DIALOG(34536,XMSUBJ) ; Subj: _XMSUBJ
"RTN","XMJMQ1",11,0)
 S XMRESPS=+$P($G(^XMB(3.9,XMZ,3,0)),U,4)
"RTN","XMJMQ1",12,0)
 S XMRESPM=$$EZBLD^DIALOG($S(XMRESPS=1:34557.1,1:34557),XMRESPS) ; XMRESPS_ response / responses
"RTN","XMJMQ1",13,0)
 W @IOF
"RTN","XMJMQ1",14,0)
 D PAGE1HDR^XMJMP1(XMDUZ,XMK,XMKN,XMZ,XMRESPS,^XMB(3.9,XMZ,0),XMSUBJ,XMZSTR)
"RTN","XMJMQ1",15,0)
 D INFO(XMDUZ,XMK,XMZ,0,"","","",.XMABORT)
"RTN","XMJMQ1",16,0)
 Q
"RTN","XMJMQ1",17,0)
INFO(XMDUZ,XMK,XMZ,XMPHDR,XMSUBJ,XMZSTR,XMPAGE,XMABORT) ;
"RTN","XMJMQ1",18,0)
 N XMREC,XMRECIPS,XMDIALOG
"RTN","XMJMQ1",19,0)
 S XMREC=^XMB(3.9,XMZ,0)
"RTN","XMJMQ1",20,0)
 I $Y+4>IOSL D  Q:XMABORT
"RTN","XMJMQ1",21,0)
 . D PAGE^XMJMQ(.XMABORT)
"RTN","XMJMQ1",22,0)
 E  W !
"RTN","XMJMQ1",23,0)
 W !,$$EZBLD^DIALOG(34559,XMZ_"@"_^XMB("NETNAME")) ; Local Message-ID:
"RTN","XMJMQ1",24,0)
 S XMDIALOG=$S($P(XMREC,U,7)["P":34543,$P(XMREC,U,7)["S":34560,$P(XMREC,U,8):34561,1:0) I XMDIALOG D W(XMDIALOG) ; Priority! / [SPOOL] / <RESPONSE>
"RTN","XMJMQ1",25,0)
 S XMRECIPS=+$P($G(^XMB(3.9,XMZ,1,0)),U,4)
"RTN","XMJMQ1",26,0)
 I XMRECIPS D W($S(XMRECIPS=1:34562.1,1:34562),XMRECIPS) ; (_XMRECIPS_ Recipient(s))
"RTN","XMJMQ1",27,0)
 I "^Y^y^"[(U_$P(XMREC,U,5)_U) D W(34564) ; Confirmation requested.
"RTN","XMJMQ1",28,0)
 I $D(^XMB(3.9,XMZ,"K")) D W($S(" "[$P(XMREC,U,10):34565,1:34566),$P(XMREC,U,10)) ; Scramble Hint:
"RTN","XMJMQ1",29,0)
 I $O(^XMB(3.9,XMZ,2005,0)) D LIST^XMA2B ; MIME body parts
"RTN","XMJMQ1",30,0)
 I "^Y^y^"[(U_$P(XMREC,U,9)_U) D W(34567) ; Closed.
"RTN","XMJMQ1",31,0)
 I "^Y^y^"[(U_$P(XMREC,U,11)_U) D W(34568) ; Confidential.
"RTN","XMJMQ1",32,0)
 I "^Y^y^"[(U_$P(XMREC,U,12)_U) D W(34570) ; 'Information only' for all recipients.
"RTN","XMJMQ1",33,0)
 I $D(^XMB(3.9,XMZ,.5)) D
"RTN","XMJMQ1",34,0)
 . S XMREC=^XMB(3.9,XMZ,.5)
"RTN","XMJMQ1",35,0)
 . I $P(XMREC,U,1)'="" D W(34571,$P(XMREC,U,1)) ; Delivery basket:
"RTN","XMJMQ1",36,0)
 ; The following is already listed in the message header:
"RTN","XMJMQ1",37,0)
 ;I $D(^XMB(3.7,XMDUZ,2,XMK,1,XMZ,0)) D
"RTN","XMJMQ1",38,0)
 ;. N XMVAPOR
"RTN","XMJMQ1",39,0)
 ;. S XMVAPOR=$P($G(^XMB(3.7,XMDUZ,2,XMK,1,XMZ,0)),U,5)
"RTN","XMJMQ1",40,0)
 ;. I XMVAPOR D W(34572,$$MMDT^XMXUTIL1(XMVAPOR)) ; Automatic Deletion Date:
"RTN","XMJMQ1",41,0)
 D LATER(XMDUZ,XMZ,XMPHDR,XMSUBJ,XMZSTR,.XMPAGE,.XMABORT)
"RTN","XMJMQ1",42,0)
 Q
"RTN","XMJMQ1",43,0)
LATER(XMDUZ,XMZ,XMPHDR,XMSUBJ,XMZSTR,XMPAGE,XMABORT) ; List dates message will be new on 'later'
"RTN","XMJMQ1",44,0)
 Q:'$O(^XMB(3.73,"AC",XMZ,XMDUZ,0))
"RTN","XMJMQ1",45,0)
 N XMIEN,XMSEP
"RTN","XMJMQ1",46,0)
 I $Y+3>IOSL D PAGE^XMJMQ(.XMABORT) Q:XMABORT
"RTN","XMJMQ1",47,0)
 W !,$$EZBLD^DIALOG(34595) ; Message will be NEW on:
"RTN","XMJMQ1",48,0)
 S XMIEN="",XMSEP=" "
"RTN","XMJMQ1",49,0)
 F  S XMIEN=$O(^XMB(3.73,"AC",XMZ,XMDUZ,XMIEN)) Q:XMIEN=""  D
"RTN","XMJMQ1",50,0)
 . D W2(XMSEP,$$FMTE^XLFDT($E($P(^XMB(3.73,XMIEN,0),U),1,12)),.XMABORT)
"RTN","XMJMQ1",51,0)
 . S XMSEP=", "
"RTN","XMJMQ1",52,0)
 Q
"RTN","XMJMQ1",53,0)
W(XMPIECE,XMPARM) ;
"RTN","XMJMQ1",54,0)
 S XMPIECE=$$EZBLD^DIALOG(XMPIECE,.XMPARM)
"RTN","XMJMQ1",55,0)
 I 1+$L(XMPIECE)+$X>IOM D  Q:XMABORT
"RTN","XMJMQ1",56,0)
 . I $Y+3>IOSL D PAGE^XMJMQ(.XMABORT) Q:XMABORT
"RTN","XMJMQ1",57,0)
 . W !
"RTN","XMJMQ1",58,0)
 W " ",XMPIECE
"RTN","XMJMQ1",59,0)
 Q
"RTN","XMJMQ1",60,0)
W2(XMSEP,XMPIECE,XMABORT) ;
"RTN","XMJMQ1",61,0)
 I $X+$L(XMSEP)+$L(XMPIECE)>IOM D  Q:XMABORT
"RTN","XMJMQ1",62,0)
 . I $Y+3>IOSL D PAGE^XMJMQ(.XMABORT) Q:XMABORT
"RTN","XMJMQ1",63,0)
 . W !,XMPIECE
"RTN","XMJMQ1",64,0)
 E  W XMSEP,XMPIECE
"RTN","XMJMQ1",65,0)
 Q
"RTN","XMJMQ1",66,0)
NETWORK(XMZ,XMABORT) ;
"RTN","XMJMQ1",67,0)
 N I,J,XMLINE,XMPOS,XMPHDR
"RTN","XMJMQ1",68,0)
 I $O(^XMB(3.9,XMZ,2,0))'<1 D  Q
"RTN","XMJMQ1",69,0)
 . W !!,$$EZBLD^DIALOG(34550) ; This message originated locally.  There is no network header.
"RTN","XMJMQ1",70,0)
 I $D(^XMB(3.9,XMZ,.7)) W !!,$$EZBLD^DIALOG(34551,$P(^XMB(3.9,XMZ,.7),U,1)) ; Envelope From:
"RTN","XMJMQ1",71,0)
 W !!,$$EZBLD^DIALOG(34552),! ; Network header:
"RTN","XMJMQ1",72,0)
 S (I,XMPHDR)=0
"RTN","XMJMQ1",73,0)
 F  S I=$O(^XMB(3.9,XMZ,2,I)) Q:I=""!(I'<1)  D  Q:XMABORT
"RTN","XMJMQ1",74,0)
 . S XMLINE=^XMB(3.9,XMZ,2,I,0)
"RTN","XMJMQ1",75,0)
 . I $Y+3>IOSL D PAGE^XMJMQ(.XMABORT) Q:XMABORT
"RTN","XMJMQ1",76,0)
 . I $L(XMLINE)<IOM W !,XMLINE Q
"RTN","XMJMQ1",77,0)
 . S XMPOS=0
"RTN","XMJMQ1",78,0)
 . F  D  Q:XMLINE=""!XMABORT
"RTN","XMJMQ1",79,0)
 . . I $L(XMLINE)+XMPOS+1>IOM F J=IOM-XMPOS-1:-1:IOM-XMPOS-20 Q:", -;)"[$E(XMLINE,J)
"RTN","XMJMQ1",80,0)
 . . I $Y+3>IOSL D PAGE^XMJMQ(.XMABORT) Q:XMABORT
"RTN","XMJMQ1",81,0)
 . . W !,?XMPOS,$E(XMLINE,1,J)
"RTN","XMJMQ1",82,0)
 . . S XMPOS=10
"RTN","XMJMQ1",83,0)
 . . S XMLINE=$E(XMLINE,J+1,999)
"RTN","XMJMQ1",84,0)
 Q
"RTN","XMJMQ1",85,0)
SUMMARY(XMZ,XMPHDR,XMSUBJ,XMZSTR,XMPAGE,XMABORT) ;
"RTN","XMJMQ1",86,0)
 N XMTYPE
"RTN","XMJMQ1",87,0)
 I $Y+3>IOSL D PAGE^XMJMQ(.XMABORT) Q:XMABORT
"RTN","XMJMQ1",88,0)
 W !
"RTN","XMJMQ1",89,0)
 I '$O(^XMB(3.9,XMZ,6,0)),'$O(^XMB(3.9,XMZ,7,0)) D  Q
"RTN","XMJMQ1",90,0)
 . N XMTEXT
"RTN","XMJMQ1",91,0)
 . D BLD^DIALOG(34596,"","","XMTEXT","F")
"RTN","XMJMQ1",92,0)
 . D MSG^DIALOG("WM","","","","XMTEXT")
"RTN","XMJMQ1",93,0)
 . ;This is an old message which has no summary recipient list.
"RTN","XMJMQ1",94,0)
 . ;Only the Detail Query (QD) is available.
"RTN","XMJMQ1",95,0)
 W !,$$EZBLD^DIALOG(34597),! ; This message was addressed as follows:
"RTN","XMJMQ1",96,0)
 D PRTADDR(XMZ,6,.XMTYPE,.XMABORT) Q:XMABORT  ; addressed to
"RTN","XMJMQ1",97,0)
 D PRTADDR(XMZ,7,.XMTYPE,.XMABORT)            ; deliver later to
"RTN","XMJMQ1",98,0)
 Q
"RTN","XMJMQ1",99,0)
PRTADDR(XMZ,XMNODE,XMTYPE,XMABORT) ;
"RTN","XMJMQ1",100,0)
 N XMTO
"RTN","XMJMQ1",101,0)
 S XMTO="*" ; List Broadcasts first
"RTN","XMJMQ1",102,0)
 F  S XMTO=$O(^XMB(3.9,XMZ,XMNODE,"B",XMTO)) Q:$E(XMTO,1,1)'="*"  D PRTSUMRY(XMZ,XMNODE,XMTO,.XMTYPE,.XMABORT)  Q:XMABORT
"RTN","XMJMQ1",103,0)
 Q:XMABORT
"RTN","XMJMQ1",104,0)
 S XMTO="G." ; List Groups next
"RTN","XMJMQ1",105,0)
 F  S XMTO=$O(^XMB(3.9,XMZ,XMNODE,"B",XMTO)) Q:$E(XMTO,1,2)'="G."  D PRTSUMRY(XMZ,XMNODE,XMTO,.XMTYPE,.XMABORT)  Q:XMABORT
"RTN","XMJMQ1",106,0)
 Q:XMABORT
"RTN","XMJMQ1",107,0)
 S XMTO=""  ; Now list the rest
"RTN","XMJMQ1",108,0)
 F  S XMTO=$O(^XMB(3.9,XMZ,XMNODE,"B",XMTO)) Q:XMTO=""  D  Q:XMABORT
"RTN","XMJMQ1",109,0)
 . Q:$E(XMTO,1,2)="G."
"RTN","XMJMQ1",110,0)
 . Q:$E(XMTO,1,1)="*"
"RTN","XMJMQ1",111,0)
 . D PRTSUMRY(XMZ,XMNODE,XMTO,.XMTYPE,.XMABORT)
"RTN","XMJMQ1",112,0)
 Q
"RTN","XMJMQ1",113,0)
PRTSUMRY(XMZ,XMNODE,XMTO,XMTYPE,XMABORT) ;
"RTN","XMJMQ1",114,0)
 N XMIEN,XMREC
"RTN","XMJMQ1",115,0)
 S XMIEN=$O(^XMB(3.9,XMZ,XMNODE,"B",XMTO,0)) Q:'XMIEN
"RTN","XMJMQ1",116,0)
 S XMREC=$G(^XMB(3.9,XMZ,XMNODE,XMIEN,0)) Q:XMREC=""
"RTN","XMJMQ1",117,0)
 I $Y+3>IOSL D PAGE^XMJMQ(.XMABORT) Q:XMABORT
"RTN","XMJMQ1",118,0)
 I $P(XMREC,U,2)'="" D
"RTN","XMJMQ1",119,0)
 . S XMTYPE=$P(XMREC,U,2)
"RTN","XMJMQ1",120,0)
 . I '$D(XMTYPE(XMTYPE)) S XMTYPE(XMTYPE)=$$EXTERNAL^DILFD(3.91,6.5,"",XMTYPE) I $D(DIERR) S XMTYPE(XMTYPE)=XMTYPE
"RTN","XMJMQ1",121,0)
 . W !,XMTYPE(XMTYPE),":",$P(XMREC,U,1)
"RTN","XMJMQ1",122,0)
 E  W !,$P(XMREC,U,1)
"RTN","XMJMQ1",123,0)
 Q:XMNODE=6
"RTN","XMJMQ1",124,0)
 N XMPARM
"RTN","XMJMQ1",125,0)
 S XMPARM(1)=$$MMDT^XMXUTIL1($P(XMREC,U,5)),XMPARM(2)=$P(XMREC,U,4)
"RTN","XMJMQ1",126,0)
 D W(34598,.XMPARM) ; for delivery x by y
"RTN","XMJMQ1",127,0)
 Q
"RTN","XMJMQ1",128,0)
SEARCH(XMZ,XMNAME,XMRESPM) ;
"RTN","XMJMQ1",129,0)
 N XMPHDR,XMUSER,XMSITE
"RTN","XMJMQ1",130,0)
 S XMPHDR=0
"RTN","XMJMQ1",131,0)
 I $Y+5>IOSL D  Q:XMABORT
"RTN","XMJMQ1",132,0)
 . D PAGE^XMJMQ(.XMABORT)
"RTN","XMJMQ1",133,0)
 E  W !
"RTN","XMJMQ1",134,0)
 W !,$$EZBLD^DIALOG(34554,XMNAME),! ; Searching for recipients that match '_XMNAME_'.
"RTN","XMJMQ1",135,0)
 I XMNAME["@" D
"RTN","XMJMQ1",136,0)
 . S XMSITE=$$UP^XLFSTR($P(XMNAME,"@",2,99))
"RTN","XMJMQ1",137,0)
 . ;S XMUSER=$P(XMNAME,"@",1)_$S(XMNAME[",":"@",1:",")
"RTN","XMJMQ1",138,0)
 . S XMUSER=$P($P(XMNAME,"@",1),",",1)_","
"RTN","XMJMQ1",139,0)
 . S XMNAME=XMUSER_XMSITE
"RTN","XMJMQ1",140,0)
 E  D  Q:XMABORT
"RTN","XMJMQ1",141,0)
 . D FIND^DIC(200,"","@;.01","AP",XMNAME,"","B^BB^C^D","I $D(^XMB(3.9,XMZ,1,""C"",+Y))")
"RTN","XMJMQ1",142,0)
 . I '$D(DIERR) D PSEARCH(200,XMZ,XMRESPM,.XMABORT) Q:XMABORT
"RTN","XMJMQ1",143,0)
 Q:$O(^XMB(3.9,XMZ,1,"C",":"))=""  ; Quit if there aren't any non-local addressees
"RTN","XMJMQ1",144,0)
 N XMSCREEN
"RTN","XMJMQ1",145,0)
 S XMSCREEN=$S(+XMNAME=XMNAME:"I '$D(^XMB(3.9,XMZ,1,""C"",XMNAME))",1:"")
"RTN","XMJMQ1",146,0)
 D FIND^DIC(3.91,","_XMZ_",","","CP",XMNAME,"","C",XMSCREEN)
"RTN","XMJMQ1",147,0)
 I '$D(DIERR) D PSEARCH(3.91,XMZ,XMRESPM,.XMABORT)
"RTN","XMJMQ1",148,0)
 Q:$E(XMNAME)'?1U  ; Quit if the search string does not begin with an upper case letter
"RTN","XMJMQ1",149,0)
 Q:$O(^XMB(3.9,XMZ,1,"C","`"))=""  ; Quit if there aren't any lower case addressees
"RTN","XMJMQ1",150,0)
 ; FM will translate lower case to upper case in its search, but won't
"RTN","XMJMQ1",151,0)
 ; translate upper to lower, so we do it here.
"RTN","XMJMQ1",152,0)
 S XMSCREEN="I ^(0)]""`""" ; Limit search to lower case addresses
"RTN","XMJMQ1",153,0)
 S XMNAME=$S($D(XMSITE):$$LOW^XLFSTR(XMUSER)_XMSITE,1:$$LOW^XLFSTR(XMNAME))
"RTN","XMJMQ1",154,0)
 D FIND^DIC(3.91,","_XMZ_",","","CP",XMNAME,"","C",XMSCREEN)
"RTN","XMJMQ1",155,0)
 I '$D(DIERR) D PSEARCH(3.91,XMZ,XMRESPM,.XMABORT)
"RTN","XMJMQ1",156,0)
 Q
"RTN","XMJMQ1",157,0)
PSEARCH(XMFILE,XMZ,XMRESPM,XMABORT) ; Print search results
"RTN","XMJMQ1",158,0)
 N XMI,XMIEN,XMTYPE,XMREC
"RTN","XMJMQ1",159,0)
 S XMI=0
"RTN","XMJMQ1",160,0)
 F  S XMI=$O(^TMP("DILIST",$J,XMI)) Q:'XMI  S XMREC=^(XMI,0) D  Q:XMABORT
"RTN","XMJMQ1",161,0)
 . S XMIEN=$S(XMFILE=200:$O(^XMB(3.9,XMZ,1,"C",$P(XMREC,U,1),0)),1:$P(XMREC,U,1))
"RTN","XMJMQ1",162,0)
 . D WNAME^XMJMQ(XMZ,$P(XMREC,U,2),XMIEN,XMRESPM,.XMTYPE,.XMABORT)
"RTN","XMJMQ1",163,0)
 Q
"RTN","XMJMR")
0^301^B29191383
"RTN","XMJMR",1,0)
XMJMR ;ISC-SF/GMB-Interactive Reply ;04/24/2002  10:28
"RTN","XMJMR",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMJMR",3,0)
 ; Replaces REPLY^XMA11,^XMA2,^XMA20,^XMAH1 (ISC-WASH/CAP/THM)
"RTN","XMJMR",4,0)
REPLY(XMDUZ,XMK,XMKN,XMZO,XMZOSUBJ,XMZOFROM,XMINSTR,XMPTR,XMRESPSO,XMINCL,XMRESP) ;
"RTN","XMJMR",5,0)
 N XMABORT,XMZ,XMID,XMWHICH,XMZI
"RTN","XMJMR",6,0)
 S XMABORT=0
"RTN","XMJMR",7,0)
 D INIT^XMJMR1(XMDUZ,.XMK,.XMKN,XMZO,XMZOSUBJ,XMZOFROM,.XMINSTR,XMINCL,.XMZI,.XMWHICH,.XMABORT) Q:XMABORT
"RTN","XMJMR",8,0)
 D CRE8XMZ^XMXSEND("R"_XMZO,.XMZ,1) I XMZ<1 S XMABORT=1 Q
"RTN","XMJMR",9,0)
 S XMID=$S(XMDUZ=.6:DUZ,1:XMDUZ)
"RTN","XMJMR",10,0)
 D EDITON^XMJMS(XMID,XMZ,XMZO)
"RTN","XMJMR",11,0)
 D PROCESS(XMID,XMK,XMKN,XMZO,XMZOSUBJ,XMZOFROM,XMZ,.XMINSTR,XMPTR,XMRESPSO,.XMRESP,.XMZI,.XMWHICH,.XMABORT)
"RTN","XMJMR",12,0)
 I XMABORT=DTIME D HALT^XMJMS($$EZBLD^DIALOG(34220)) ; replying to
"RTN","XMJMR",13,0)
 D EDITOFF^XMJMS(XMID)
"RTN","XMJMR",14,0)
 D:XMABORT KILLMSG^XMXUTIL(XMZ)
"RTN","XMJMR",15,0)
 Q
"RTN","XMJMR",16,0)
PROCESS(XMDUZ,XMK,XMKN,XMZO,XMZOSUBJ,XMZOFROM,XMZ,XMINSTR,XMPTR,XMRESPSO,XMRESP,XMZI,XMWHICH,XMABORT) ;
"RTN","XMJMR",17,0)
 N XMRESTR
"RTN","XMJMR",18,0)
 S XMRESTR("REPLYTO")=XMZO
"RTN","XMJMR",19,0)
 D:$D(XMWHICH) COPYTEXT^XMJMR1(XMZI,XMZ,XMWHICH,(XMZI'=XMZO))
"RTN","XMJMR",20,0)
 D BODY^XMJMS(XMDUZ,XMZ,XMZOSUBJ,.XMRESTR,.XMABORT) Q:XMABORT
"RTN","XMJMR",21,0)
 D REPLYMSG^XMJMRO(XMDUZ,XMK,XMKN,XMZO,XMZ,XMZOSUBJ,.XMRESTR,XMPTR,XMRESPSO,.XMRESP,.XMABORT) Q:XMABORT
"RTN","XMJMR",22,0)
 I XMZOFROM["@",$$UP^XLFSTR(XMZOFROM)'["POSTMASTER" D REMOTE(XMDUZ,XMZO,XMZOSUBJ,XMZ,.XMINSTR)
"RTN","XMJMR",23,0)
 Q
"RTN","XMJMR",24,0)
REMOTE(XMDUZ,XMZO,XMZOSUBJ,XMZ,XMINSTR) ;
"RTN","XMJMR",25,0)
 N DIR,Y,XMSUBJ,XMTO,XMABORT
"RTN","XMJMR",26,0)
 S XMABORT=0
"RTN","XMJMR",27,0)
 S DIR("A")=$$EZBLD^DIALOG(34206) ; Do you wish to send this reply across the network?
"RTN","XMJMR",28,0)
 S DIR(0)="Y",DIR("B")=$$EZBLD^DIALOG(39053) ; No
"RTN","XMJMR",29,0)
 D BLD^DIALOG(34207,"","","DIR(""?"")") ; Enter YES if you wish your response ...
"RTN","XMJMR",30,0)
 S DIR("??")="^D RHELP^XMJMR"
"RTN","XMJMR",31,0)
 D ^DIR Q:'Y!$D(DIRUT)
"RTN","XMJMR",32,0)
 S XMRE=$$EZBLD^DIALOG(37006) ; Re:
"RTN","XMJMR",33,0)
 S XMSUBJ=$S($$UP^XLFSTR($E(XMZOSUBJ,1,$L(XMRE)))=$$UP^XLFSTR(XMRE):XMZOSUBJ,1:$E(XMRE_XMZOSUBJ,1,65))
"RTN","XMJMR",34,0)
 D SUBJ^XMJMS(.XMSUBJ,.XMABORT) Q:XMABORT
"RTN","XMJMR",35,0)
 D REPLYTO(XMZO,.XMTO,.XMABORT) Q:XMABORT
"RTN","XMJMR",36,0)
 W !,$$EZBLD^DIALOG(34211,XMTO) ; Addressing the reply to: |1|
"RTN","XMJMR",37,0)
 D INIT^XMXADDR
"RTN","XMJMR",38,0)
 S XMINSTR("EXACT")=1 ; Match on exact domain name
"RTN","XMJMR",39,0)
 D ADDR^XMXADDR(XMDUZ,XMTO,.XMINSTR)
"RTN","XMJMR",40,0)
 K XMINSTR("EXACT")
"RTN","XMJMR",41,0)
 ;S:XMTO[".VA.GOV" XMTO=$TR($P(XMTO,"@"),"._+",", .")_"@"_$P(XMTO,"@",2)
"RTN","XMJMR",42,0)
 I $$GOTADDR^XMXADDR D
"RTN","XMJMR",43,0)
 . W !,$$EZBLD^DIALOG(34212) ; Sending network reply...
"RTN","XMJMR",44,0)
 . D NETREPLY^XMXREPLY(XMDUZ,XMZO,XMZ,XMSUBJ,.XMINSTR)
"RTN","XMJMR",45,0)
 . W $$EZBLD^DIALOG(34213) ; Sent
"RTN","XMJMR",46,0)
 D CLEANUP^XMXADDR
"RTN","XMJMR",47,0)
 Q
"RTN","XMJMR",48,0)
RHELP ;
"RTN","XMJMR",49,0)
 N XMTEXT
"RTN","XMJMR",50,0)
 D BLD^DIALOG(34208,"","","XMTEXT","F") ; A network response will go to all message ... (explains network reply)
"RTN","XMJMR",51,0)
 D MSG^DIALOG("WH","","","","XMTEXT")
"RTN","XMJMR",52,0)
 Q
"RTN","XMJMR",53,0)
REPLYTO(XMZ,XMFROM,XMABORT) ;
"RTN","XMJMR",54,0)
 N XMREPLTO,XMF,XMR
"RTN","XMJMR",55,0)
 D REPLYTO^XMXREPLY(XMZ,.XMFROM,.XMREPLTO)
"RTN","XMJMR",56,0)
 S XMF=XMFROM
"RTN","XMJMR",57,0)
 S XMFROM=$$REMADDR^XMXADDR3(XMFROM)
"RTN","XMJMR",58,0)
 Q:$G(XMREPLTO)=""
"RTN","XMJMR",59,0)
 S XMR=XMREPLTO
"RTN","XMJMR",60,0)
 S XMREPLTO=$$REMADDR^XMXADDR3(XMREPLTO)
"RTN","XMJMR",61,0)
 Q:$$UP^XLFSTR(XMREPLTO)=$$UP^XLFSTR(XMFROM)
"RTN","XMJMR",62,0)
 N DIR,Y
"RTN","XMJMR",63,0)
 S DIR(0)="S^"
"RTN","XMJMR",64,0)
 S DIR(0)=DIR(0)_"F:'FROM'     "_XMF
"RTN","XMJMR",65,0)
 S DIR(0)=DIR(0)_";R:'REPLY-TO' "_XMR
"RTN","XMJMR",66,0)
 S DIR("B")="R"
"RTN","XMJMR",67,0)
 D BLD^DIALOG(34214,"","","DIR(""A"")") ; This message has a 'reply-to' address ... (use which address?)
"RTN","XMJMR",68,0)
 D BLD^DIALOG(34215,"","","DIR(""?"")") ; Generally, we recommend that you use ...
"RTN","XMJMR",69,0)
 D ^DIR I $D(DIRUT) S XMABORT=1 Q
"RTN","XMJMR",70,0)
 S:Y="R" XMFROM=XMREPLTO
"RTN","XMJMR",71,0)
 Q
"RTN","XMJMR",72,0)
RECOVER(XMDUZ,XMZ,XMZO) ;
"RTN","XMJMR",73,0)
 I XMDUZ'=DUZ,$$ZCONFID^XMXSEC(XMZO) D  Q
"RTN","XMJMR",74,0)
 . ; If user is surrogate & msg is confidential, delete unsent reply.
"RTN","XMJMR",75,0)
 . D EDITOFF^XMJMS(XMDUZ)
"RTN","XMJMR",76,0)
 . D KILLMSG^XMXUTIL(XMZ)
"RTN","XMJMR",77,0)
 N XMSUBJ,DIR,Y,XMTEXT
"RTN","XMJMR",78,0)
 S XMSUBJ=$P(^XMB(3.9,XMZO,0),U,1)
"RTN","XMJMR",79,0)
 S:XMSUBJ["~U~" XMSUBJ=$$DECODEUP^XMXUTIL1(XMSUBJ)
"RTN","XMJMR",80,0)
 W $C(7),!
"RTN","XMJMR",81,0)
 ;You have / |1| has an unsent response in your buffer.
"RTN","XMJMR",82,0)
 D BLD^DIALOG($S(XMDUZ=DUZ:34222,1:34222.1),XMV("NAME"),"","XMTEXT","F")
"RTN","XMJMR",83,0)
 ;Subj: _XMSUBJ
"RTN","XMJMR",84,0)
 D BLD^DIALOG(34536,XMSUBJ,"","XMTEXT","FS")
"RTN","XMJMR",85,0)
 D MSG^DIALOG("WM","",79,"","XMTEXT")
"RTN","XMJMR",86,0)
 W !
"RTN","XMJMR",87,0)
 ;You may continue to reply, or delete the remaining text.
"RTN","XMJMR",88,0)
 ;Shall we delete the unsent response?
"RTN","XMJMR",89,0)
 D BLD^DIALOG(34222.3,"","","DIR(""A"")")
"RTN","XMJMR",90,0)
 S DIR(0)="Y"
"RTN","XMJMR",91,0)
 S DIR("B")=$$EZBLD^DIALOG(39053) ; No
"RTN","XMJMR",92,0)
 D BLD^DIALOG(34223,"","","DIR(""?"")") ; Enter YES to delete the unsent response...
"RTN","XMJMR",93,0)
 D ^DIR
"RTN","XMJMR",94,0)
 I $D(DTOUT) D HALT^XMJMS($$EZBLD^DIALOG(34221)) ; recovering
"RTN","XMJMR",95,0)
 I Y=1!$D(DUOUT) D  Q
"RTN","XMJMR",96,0)
 . D EDITOFF^XMJMS(XMDUZ)
"RTN","XMJMR",97,0)
 . D KILLMSG^XMXUTIL(XMZ)
"RTN","XMJMR",98,0)
 N XMK,XMKN,XMZOSUBJ,XMZOFROM,XMINSTR,XMABORT,XMSECURE,XMPAKMAN,XMWHICH,XMPTR,XMRESPSO,XMRESP
"RTN","XMJMR",99,0)
 S XMABORT=0
"RTN","XMJMR",100,0)
 D RECINIT(XMDUZ,XMZO,.XMK,.XMKN,.XMZOSUBJ,.XMZOFROM,.XMINSTR,.XMPTR,.XMRESPSO,.XMRESP)
"RTN","XMJMR",101,0)
 D WAIT^XMXUTIL
"RTN","XMJMR",102,0)
 D INIT^XMJMR1(XMDUZ,.XMK,.XMKN,XMZO,XMZOSUBJ,XMZOFROM,.XMINSTR,0,"",.XMWHICH,.XMABORT) Q:XMV("NOSEND")
"RTN","XMJMR",103,0)
 I XMABORT D HALT^XMJMS($$EZBLD^DIALOG(34221)) ; recovering
"RTN","XMJMR",104,0)
 D PROCESS(XMDUZ,XMK,XMKN,XMZO,XMZOSUBJ,XMZOFROM,XMZ,.XMINSTR,XMPTR,XMRESPSO,.XMRESP,"",.XMWHICH,.XMABORT)
"RTN","XMJMR",105,0)
 I XMABORT=DTIME D HALT^XMJMS($$EZBLD^DIALOG(34220)) ; replying to
"RTN","XMJMR",106,0)
 D EDITOFF^XMJMS(XMDUZ)
"RTN","XMJMR",107,0)
 D:XMABORT KILLMSG^XMXUTIL(XMZ)
"RTN","XMJMR",108,0)
 Q
"RTN","XMJMR",109,0)
RECINIT(XMDUZ,XMZO,XMK,XMKN,XMZOSUBJ,XMZOFROM,XMINSTR,XMPTR,XMRESPSO,XMRESP) ;
"RTN","XMJMR",110,0)
 N XMSECBAD,XMIM,XMIU
"RTN","XMJMR",111,0)
 S XMK=+$O(^XMB(3.7,"M",XMZO,XMDUZ,""))
"RTN","XMJMR",112,0)
 S XMKN=$P($G(^XMB(3.7,XMDUZ,2,XMK,0)),U,1)
"RTN","XMJMR",113,0)
 D DISPMSG^XMJMP(XMDUZ,XMK,XMKN,XMZO,.XMSECBAD,1)
"RTN","XMJMR",114,0)
 I $G(XMSECBAD) D HALT^XMJMS($$EZBLD^DIALOG(34221)) ; recovering
"RTN","XMJMR",115,0)
 D INMSG^XMXUTIL2(XMDUZ,0,XMZO,"","I",.XMIM,.XMINSTR,.XMIU)
"RTN","XMJMR",116,0)
 S XMZOSUBJ=XMIM("SUBJ")
"RTN","XMJMR",117,0)
 S XMZOFROM=XMIM("FROM")
"RTN","XMJMR",118,0)
 S XMRESPSO=XMIM("RESPS")
"RTN","XMJMR",119,0)
 S XMPTR=XMIU("IEN")
"RTN","XMJMR",120,0)
 S XMRESP=XMIU("RESP")
"RTN","XMJMR",121,0)
 Q
"RTN","XMJMR1")
0^302^B28685507
"RTN","XMJMR1",1,0)
XMJMR1 ;ISC-SF/GMB-Interactive Reply (cont.) ;08/24/2001  08:29
"RTN","XMJMR1",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMJMR1",3,0)
INIT(XMDUZ,XMK,XMKN,XMZO,XMZOSUBJ,XMZOFROM,XMINSTR,XMINCL,XMZI,XMWHICH,XMABORT) ;
"RTN","XMJMR1",4,0)
 N DIR,Y,DIRUT,XMRESPS
"RTN","XMJMR1",5,0)
 I XMDUZ=.6,DUZ=.6 D  Q
"RTN","XMJMR1",6,0)
 . ; This is already handled in OPTMSG^XMXSEC2, but, just in case...
"RTN","XMJMR1",7,0)
 . S XMABORT=1
"RTN","XMJMR1",8,0)
 . W !,$$EZBLD^DIALOG(37422.6) ; SHARED,MAIL may not Reply to a message.
"RTN","XMJMR1",9,0)
 . G H^XUS
"RTN","XMJMR1",10,0)
 D CHKLOCK^XMJMS(XMDUZ,.XMABORT) Q:XMABORT
"RTN","XMJMR1",11,0)
 I XMINSTR("FLAGS")["P" D  Q:XMABORT
"RTN","XMJMR1",12,0)
 . N XMTEXT
"RTN","XMJMR1",13,0)
 . W !,$C(7)
"RTN","XMJMR1",14,0)
 . D BLD^DIALOG(34200,"","","XMTEXT","F") ; Responses to priority messages are not ... (need priority? send a new msg)
"RTN","XMJMR1",15,0)
 . D MSG^DIALOG("WH","","","","XMTEXT")
"RTN","XMJMR1",16,0)
 . W !
"RTN","XMJMR1",17,0)
 . D PAGE^XMXUTIL(.XMABORT)
"RTN","XMJMR1",18,0)
 I XMZOFROM["POSTMASTER",XMZOFROM["@" D  Q:XMABORT
"RTN","XMJMR1",19,0)
 . N XMTEXT
"RTN","XMJMR1",20,0)
 . W !,$C(7)
"RTN","XMJMR1",21,0)
 . D BLD^DIALOG(34201,"","","XMTEXT","F") ; Because this message is from a remote ... (reply stays local)
"RTN","XMJMR1",22,0)
 . D MSG^DIALOG("WH","","","","XMTEXT")
"RTN","XMJMR1",23,0)
 . W !
"RTN","XMJMR1",24,0)
 . D PAGE^XMXUTIL(.XMABORT)
"RTN","XMJMR1",25,0)
 D CHKBSKT^XMJMOI(XMDUZ,XMZO,.XMK,.XMKN)
"RTN","XMJMR1",26,0)
 I +XMK<1 D
"RTN","XMJMR1",27,0)
 . W !
"RTN","XMJMR1",28,0)
 . D SAVEMSG^XMJMOI(XMDUZ,.XMK,.XMKN,XMZO,XMZOSUBJ,XMZOFROM,$G(XMINSTR("RCPT BSKT")))
"RTN","XMJMR1",29,0)
 S XMRESPS=+$P($G(^XMB(3.9,XMZO,3,0)),U,4)
"RTN","XMJMR1",30,0)
 D WHICH(XMDUZ,XMZO,XMINCL,.XMZI,.XMWHICH,.XMABORT)
"RTN","XMJMR1",31,0)
 Q
"RTN","XMJMR1",32,0)
WHICH(XMDUZ,XMZO,XMINCL,XMZI,XMWHICH,XMABORT) ;
"RTN","XMJMR1",33,0)
 ; XMINCL =0 Do not include previous responses.  Just reply.
"RTN","XMJMR1",34,0)
 ;        =1 Include previous response(s) from this message
"RTN","XMJMR1",35,0)
 ;           or include response(s) from another message in reply.
"RTN","XMJMR1",36,0)
 ;        =2 Include response(s) from another message in a new message.
"RTN","XMJMR1",37,0)
 Q:XMINCL=0
"RTN","XMJMR1",38,0)
 D WHICHMSG(XMDUZ,XMZO,XMINCL,.XMZI,.XMABORT) Q:XMABORT
"RTN","XMJMR1",39,0)
 D WHICH^XMJMC(XMZI,$$EZBLD^DIALOG(34209),.XMWHICH,.XMABORT) ; include
"RTN","XMJMR1",40,0)
 Q
"RTN","XMJMR1",41,0)
WHICHMSG(XMDUZ,XMZO,XMINCL,XMZI,XMABORT) ; Include responses from which (different) message
"RTN","XMJMR1",42,0)
 N DIR,X,Y,XMIN,XMAX,XMPARM
"RTN","XMJMR1",43,0)
 S (XMPARM(1),XMIN)=$O(^XMB(3.9,0)),(XMPARM(2),XMAX)=$O(^XMB(3.9,":"),-1)
"RTN","XMJMR1",44,0)
 W !
"RTN","XMJMR1",45,0)
 S DIR("A")=$$EZBLD^DIALOG(34270) ; Include responses from which message
"RTN","XMJMR1",46,0)
 I XMINCL=1 D
"RTN","XMJMR1",47,0)
 . S DIR("B")=$$EZBLD^DIALOG(34271) ; This message
"RTN","XMJMR1",48,0)
 . S DIR(0)="FO^"_$$MIN^XLFMTH($L(XMIN),$L(DIR("B")))_":"_$$MAX^XLFMTH($L(XMAX),$L(DIR("B")))_"^D CHKMSG^XMJMR1(.Y)"
"RTN","XMJMR1",49,0)
 . D BLD^DIALOG(34272,.XMPARM,"","DIR(""?"")")
"RTN","XMJMR1",50,0)
 . ;Press Enter to include previous responses from this message
"RTN","XMJMR1",51,0)
 . ;or enter the internal entry number of a different message
"RTN","XMJMR1",52,0)
 . ;(_XMIN_-_XMAX_) to include any of its responses.
"RTN","XMJMR1",53,0)
 E  D
"RTN","XMJMR1",54,0)
 . S DIR(0)="NO^"_XMIN_":"_XMAX_":0^D CHKMSG^XMJMR1(.Y)"
"RTN","XMJMR1",55,0)
 . D BLD^DIALOG(34273,.XMPARM,"","DIR(""?"")")
"RTN","XMJMR1",56,0)
 . ;Enter the internal entry number of a different message
"RTN","XMJMR1",57,0)
 . ;(_XMIN_-_XMAX_) to include any of its responses.
"RTN","XMJMR1",58,0)
 D ^DIR
"RTN","XMJMR1",59,0)
 I 'Y S XMABORT=1 Q
"RTN","XMJMR1",60,0)
 S XMZI=+Y
"RTN","XMJMR1",61,0)
 Q:XMINCL=1
"RTN","XMJMR1",62,0)
 ; Do you want to review this message first?
"RTN","XMJMR1",63,0)
 Q
"RTN","XMJMR1",64,0)
CHKMSG(XMZI) ;
"RTN","XMJMR1",65,0)
 I XMINCL=1,XMZI=DIR("B") S XMZI=XMZO Q  ; Include previous responses from this message.
"RTN","XMJMR1",66,0)
 I XMINCL=1,$S(XMZI'?.N:1,XMZI<XMIN:1,XMZI>XMAX:1,1:0) K X W $C(7)," ?" Q
"RTN","XMJMR1",67,0)
 I XMINCL=2,XMZI=XMZO D  Q
"RTN","XMJMR1",68,0)
 . K X
"RTN","XMJMR1",69,0)
 . W !,$$EZBLD^DIALOG(34274) ; You can't include the message you're editing.
"RTN","XMJMR1",70,0)
 N XMZIREC ; Include responses from another message.
"RTN","XMJMR1",71,0)
 S XMZIREC=$G(^XMB(3.9,XMZI,0))
"RTN","XMJMR1",72,0)
 I XMZIREC="" K X Q
"RTN","XMJMR1",73,0)
 I '$$INCLUDE^XMXSEC(XMDUZ,XMZI) D  Q
"RTN","XMJMR1",74,0)
 . K X
"RTN","XMJMR1",75,0)
 . D SHOW^XMJERR
"RTN","XMJMR1",76,0)
 W "  ",$P(XMZIREC,U,1)
"RTN","XMJMR1",77,0)
 Q
"RTN","XMJMR1",78,0)
COPYTEXT(XMZI,XMZ,XMWHICH,XMHDR) ;
"RTN","XMJMR1",79,0)
 N I,XMRESP,XMRANGE,XMC
"RTN","XMJMR1",80,0)
 I $G(XMHDR) S XMHDR("XMZ")=XMZI,XMHDR("REC")=^XMB(3.9,XMZI,0)
"RTN","XMJMR1",81,0)
 W !,$$EZBLD^DIALOG(34202) ; Copying...
"RTN","XMJMR1",82,0)
 S XMC=+$O(^XMB(3.9,XMZ,2,""),-1)
"RTN","XMJMR1",83,0)
 F I=1:1:$L(XMWHICH,",") D
"RTN","XMJMR1",84,0)
 . S XMRANGE=$P(XMWHICH,",",I)
"RTN","XMJMR1",85,0)
 . Q:XMRANGE=""  ; (XMWHICH can end with a ",", giving us a null piece.)
"RTN","XMJMR1",86,0)
 . F XMRESP=$P(XMRANGE,"-",1):1:$S(XMRANGE["-":$P(XMRANGE,"-",2),1:XMRANGE) D
"RTN","XMJMR1",87,0)
 . . I XMRESP=0 D COPYRESP(XMRESP,XMZI,XMZ,.XMC,.XMHDR) Q
"RTN","XMJMR1",88,0)
 . . D COPYRESP(XMRESP,+$G(^XMB(3.9,XMZI,3,XMRESP,0)),XMZ,.XMC,.XMHDR)
"RTN","XMJMR1",89,0)
 S ^XMB(3.9,XMZ,2,0)="^3.92A^"_XMC_U_XMC_U_DT
"RTN","XMJMR1",90,0)
 Q
"RTN","XMJMR1",91,0)
COPYRESP(XMRESP,XMZI,XMZ,XMC,XMHDR) ;
"RTN","XMJMR1",92,0)
 N XMF,XMFROM,XMDT,XMZREC,XMPARM
"RTN","XMJMR1",93,0)
 S XMC=XMC+1
"RTN","XMJMR1",94,0)
 S ^XMB(3.9,XMZ,2,XMC,0)=""
"RTN","XMJMR1",95,0)
 S XMZREC=$G(^XMB(3.9,XMZI,0))
"RTN","XMJMR1",96,0)
 S XMFROM=$$NAME^XMXUTIL($P(XMZREC,U,2))
"RTN","XMJMR1",97,0)
 S XMDT=$P(XMZREC,U,3)
"RTN","XMJMR1",98,0)
 I $G(XMHDR) D
"RTN","XMJMR1",99,0)
 . S XMC=XMC+1
"RTN","XMJMR1",100,0)
 . S ^XMB(3.9,XMZ,2,XMC,0)="In the message:"
"RTN","XMJMR1",101,0)
 . S XMC=XMC+1
"RTN","XMJMR1",102,0)
 . S ^XMB(3.9,XMZ,2,XMC,0)=">"_$$EZBLD^DIALOG(34536,$$SUBJ^XMXUTIL2(XMHDR("REC")))_"  "_$$EZBLD^DIALOG(34537,XMHDR("XMZ")) ; Subj: / [#]
"RTN","XMJMR1",103,0)
 . S XMC=XMC+1
"RTN","XMJMR1",104,0)
 . S ^XMB(3.9,XMZ,2,XMC,0)=">"_$$EZBLD^DIALOG(34538,$$FROM^XMXUTIL2(XMHDR("REC")))_$S($P(XMHDR("REC"),U,4)="":"",1:" "_$$EZBLD^DIALOG(34533,$$NAME^XMXUTIL($P(XMHDR("REC"),U,4)))) ; From: |1| (Sender: |1|)
"RTN","XMJMR1",105,0)
 . S XMC=XMC+1
"RTN","XMJMR1",106,0)
 . S ^XMB(3.9,XMZ,2,XMC,0)=">"_$$EZBLD^DIALOG(34585,$$MMDT^XMXUTIL1($P(XMHDR("REC"),U,3))) ; Sent: |1|
"RTN","XMJMR1",107,0)
 S XMC=XMC+1
"RTN","XMJMR1",108,0)
 S XMPARM(1)=$$MMDT^XMXUTIL1(XMDT)
"RTN","XMJMR1",109,0)
 S XMPARM(2)=$S(XMRESP:$$EZBLD^DIALOG(34204,XMRESP),1:$$EZBLD^DIALOG(34205)) ; Response #|1| / Original message
"RTN","XMJMR1",110,0)
 S XMPARM(3)=XMFROM
"RTN","XMJMR1",111,0)
 S ^XMB(3.9,XMZ,2,XMC,0)=$$EZBLD^DIALOG(34203,.XMPARM) ; On |1| (|2|) |3| wrote:
"RTN","XMJMR1",112,0)
 S XMF=.999999
"RTN","XMJMR1",113,0)
 F  S XMF=$O(^XMB(3.9,XMZI,2,XMF)) Q:XMF=""  D
"RTN","XMJMR1",114,0)
 . S XMC=XMC+1
"RTN","XMJMR1",115,0)
 . W:XMC#50=0 "."
"RTN","XMJMR1",116,0)
 . S ^XMB(3.9,XMZ,2,XMC,0)=$E(">"_^XMB(3.9,XMZI,2,XMF,0),1,254)
"RTN","XMJMR1",117,0)
 Q
"RTN","XMJMRO")
0^303^B10100070
"RTN","XMJMRO",1,0)
XMJMRO ;ISC-SF/GMB-Options at 'reply' transmit prompt ;12/05/2001  15:40
"RTN","XMJMRO",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMJMRO",3,0)
 ; Replaces ^XMA22 (ISC-WASH/CAP/THM)
"RTN","XMJMRO",4,0)
REPLYMSG(XMDUZ,XMK,XMKN,XMZO,XMZ,XMSUBJ,XMRESTR,XMPTR,XMRESPSO,XMRESP,XMABORT) ;
"RTN","XMJMRO",5,0)
 N XMFINISH,XMLINE,XMDIR,XMY,XMOPT,XMOX
"RTN","XMJMRO",6,0)
 S XMFINISH=0
"RTN","XMJMRO",7,0)
 F  D  Q:XMFINISH!XMABORT
"RTN","XMJMRO",8,0)
 . N XMNAME
"RTN","XMJMRO",9,0)
 . I XMPTR D CHKRESP^XMJMP(XMDUZ,XMZO,XMRESPSO,XMRESP)
"RTN","XMJMRO",10,0)
 . D REPLYSET(XMDUZ,.XMOPT,.XMOX,.XMDIR)
"RTN","XMJMRO",11,0)
 . D XMDIR^XMJDIR(.XMDIR,.XMOPT,.XMOX,.XMY,.XMABORT) Q:XMABORT
"RTN","XMJMRO",12,0)
 . K XMDIR,XMOPT,XMOX
"RTN","XMJMRO",13,0)
 . D @XMY
"RTN","XMJMRO",14,0)
 Q
"RTN","XMJMRO",15,0)
REPLYSET(XMDUZ,XMOPT,XMOX,XMDIR) ;
"RTN","XMJMRO",16,0)
 D SET^XMXSEC2("B",37331,.XMOPT,.XMOX) ; Backup to review message
"RTN","XMJMRO",17,0)
 D SET^XMXSEC2("E",37341,.XMOPT,.XMOX) ; Edit Reply
"RTN","XMJMRO",18,0)
 D SET^XMXSEC2("I",37342,.XMOPT,.XMOX) ; Include previous responses in reply
"RTN","XMJMRO",19,0)
 D SET^XMXSEC2("Q",37417,.XMOPT,.XMOX) ; Query
"RTN","XMJMRO",20,0)
 D SET^XMXSEC2("Q xxx",37420.1,.XMOPT,.XMOX) ; Query recipient(s) xxx
"RTN","XMJMRO",21,0)
 D SET^XMXSEC2("QD",37418,.XMOPT,.XMOX) ; Query Detailed
"RTN","XMJMRO",22,0)
 D SET^XMXSEC2("QN",37419,.XMOPT,.XMOX) ; Query Network
"RTN","XMJMRO",23,0)
 D SET^XMXSEC2("QC",37431,.XMOPT,.XMOX) ; Query Current
"RTN","XMJMRO",24,0)
 D SET^XMXSEC2("QNC",37432,.XMOPT,.XMOX) ; Query Not Current
"RTN","XMJMRO",25,0)
 D SET^XMXSEC2("QT",37433,.XMOPT,.XMOX) ; Query Terminated
"RTN","XMJMRO",26,0)
 D SET^XMXSEC2("T",37334,.XMOPT,.XMOX) ; Transmit now
"RTN","XMJMRO",27,0)
 S XMDIR("A")=$$EZBLD^DIALOG(34067) ; Select Message option:
"RTN","XMJMRO",28,0)
 S XMDIR("B")=XMOX("O","T")_":"_XMOPT("T")
"RTN","XMJMRO",29,0)
 S XMDIR("PRE")="I XMX?1(1"""_XMOX("O","Q")_" "",1"""_$$LOW^XLFSTR(XMOX("O","Q"))_" "",1"""_XMOX("O","QD")_" "",1"""_$$LOW^XLFSTR(XMOX("O","QD"))_" "").E S XMNAME=$P(XMX,"" "",2,99),XMX="""_XMOX("O","QD")_""""
"RTN","XMJMRO",30,0)
 S XMDIR("??")="XM-U-MO-REPLY"
"RTN","XMJMRO",31,0)
 Q
"RTN","XMJMRO",32,0)
B ; Backup to review message
"RTN","XMJMRO",33,0)
 D BACKUP^XMJMP(XMDUZ,XMK,XMKN,XMZO)
"RTN","XMJMRO",34,0)
 S XMRESP=$P($G(^XMB(3.9,XMZO,1,XMPTR,0)),U,2)
"RTN","XMJMRO",35,0)
 Q
"RTN","XMJMRO",36,0)
E ; Edit msg
"RTN","XMJMRO",37,0)
 D BODY^XMJMS(XMDUZ,XMZ,XMSUBJ,.XMRESTR,.XMABORT)
"RTN","XMJMRO",38,0)
 Q
"RTN","XMJMRO",39,0)
I ; Include responses from this or another message in reply
"RTN","XMJMRO",40,0)
 D INCL(XMDUZ,XMZO,XMZ,XMSUBJ,.XMRESTR,1,.XMABORT)
"RTN","XMJMRO",41,0)
 Q
"RTN","XMJMRO",42,0)
INCL(XMDUZ,XMZO,XMZ,XMSUBJ,XMRESTR,XMINCL,XMABORT) ; Include responses in a message
"RTN","XMJMRO",43,0)
 N XMWHICH,XMNONE,XMZI
"RTN","XMJMRO",44,0)
 S XMNONE=0
"RTN","XMJMRO",45,0)
 D WHICH^XMJMR1(XMDUZ,XMZO,XMINCL,.XMZI,.XMWHICH,.XMNONE) Q:XMNONE
"RTN","XMJMRO",46,0)
 Q:'$D(XMWHICH)
"RTN","XMJMRO",47,0)
 D COPYTEXT^XMJMR1(XMZI,XMZ,XMWHICH,(XMZI'=XMZO))
"RTN","XMJMRO",48,0)
 D BODY^XMJMS(XMDUZ,XMZ,XMSUBJ,.XMRESTR,.XMABORT)
"RTN","XMJMRO",49,0)
 Q
"RTN","XMJMRO",50,0)
Q ; Query
"RTN","XMJMRO",51,0)
 D Q^XMJMQ(XMDUZ,XMK,XMKN,XMZO)
"RTN","XMJMRO",52,0)
 Q
"RTN","XMJMRO",53,0)
QC ; Query Current
"RTN","XMJMRO",54,0)
 D QX^XMJMQ(XMDUZ,XMK,XMKN,XMZO,"QC")
"RTN","XMJMRO",55,0)
 Q
"RTN","XMJMRO",56,0)
QD ; Query Detailed
"RTN","XMJMRO",57,0)
 I $D(XMNAME) D QNAMEX^XMJMQ(XMDUZ,XMK,XMKN,XMZO,XMNAME) Q
"RTN","XMJMRO",58,0)
 D QD^XMJMQ(XMDUZ,XMK,XMKN,XMZO)
"RTN","XMJMRO",59,0)
 Q
"RTN","XMJMRO",60,0)
QN ; Query Network
"RTN","XMJMRO",61,0)
 D QN^XMJMQ(XMDUZ,XMK,XMKN,XMZO)
"RTN","XMJMRO",62,0)
 Q
"RTN","XMJMRO",63,0)
QNC ; Query Not Current
"RTN","XMJMRO",64,0)
 D QX^XMJMQ(XMDUZ,XMK,XMKN,XMZO,"QNC")
"RTN","XMJMRO",65,0)
 Q
"RTN","XMJMRO",66,0)
QT ; Query Terminated
"RTN","XMJMRO",67,0)
 D QX^XMJMQ(XMDUZ,XMK,XMKN,XMZO,"QT")
"RTN","XMJMRO",68,0)
 Q
"RTN","XMJMRO",69,0)
T ; Transmit now
"RTN","XMJMRO",70,0)
 N XMIA
"RTN","XMJMRO",71,0)
 S (XMFINISH,XMIA)=1
"RTN","XMJMRO",72,0)
 W $$EZBLD^DIALOG(34216) ; Sending local reply...
"RTN","XMJMRO",73,0)
 D DOREPLY^XMXREPLY(XMDUZ,XMZO,XMZ)
"RTN","XMJMRO",74,0)
 W !,$$EZBLD^DIALOG(34213) ;   Sent
"RTN","XMJMRO",75,0)
 Q
"RTN","XMJMS")
0^304^B38369904
"RTN","XMJMS",1,0)
XMJMS ;ISC-SF/GMB-Interactive Send ;08/24/2001  12:02
"RTN","XMJMS",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMJMS",3,0)
 ; Replaces ^XMA2,^XMA20 (ISC-WASH/CAP/THM)
"RTN","XMJMS",4,0)
 ; Entry points used by MailMan options (not covered by DBIA):
"RTN","XMJMS",5,0)
 ; PAKMAN  XMPACK - Load PackMan message
"RTN","XMJMS",6,0)
 ; SEND    XMSEND - Send a message
"RTN","XMJMS",7,0)
 ; *** BLOB^XMA2B (Imaging package) calls entry BLOB
"RTN","XMJMS",8,0)
SEND ;
"RTN","XMJMS",9,0)
 N XMSUBJ,XMZ,XMABORT
"RTN","XMJMS",10,0)
 S XMABORT=0
"RTN","XMJMS",11,0)
 D INIT(XMDUZ,.XMABORT) Q:XMABORT
"RTN","XMJMS",12,0)
 D SUBJ(.XMSUBJ,.XMABORT) Q:XMABORT
"RTN","XMJMS",13,0)
 D CRE8XMZ^XMXSEND(XMSUBJ,.XMZ,1) I XMZ<1 S XMABORT=1 Q
"RTN","XMJMS",14,0)
 D:'$G(XMPAKMAN) EDITON(XMDUZ,XMZ,"",.XMBLOB)
"RTN","XMJMS",15,0)
 D PROCESS(XMDUZ,XMZ,XMSUBJ,.XMABORT)
"RTN","XMJMS",16,0)
 D:XMABORT=DTIME HALT($$EZBLD^DIALOG(34260)) ; sending
"RTN","XMJMS",17,0)
 D:'$G(XMPAKMAN) EDITOFF(XMDUZ)
"RTN","XMJMS",18,0)
 D:XMABORT KILLMSG^XMXUTIL(XMZ)
"RTN","XMJMS",19,0)
 Q
"RTN","XMJMS",20,0)
PAKMAN ;
"RTN","XMJMS",21,0)
 N XMPAKMAN,XMLOAD,X,XMR
"RTN","XMJMS",22,0)
 S (XMPAKMAN,XMLOAD)=1
"RTN","XMJMS",23,0)
 D SEND
"RTN","XMJMS",24,0)
 Q
"RTN","XMJMS",25,0)
BLOB ;
"RTN","XMJMS",26,0)
 N XMBLOB,XMOUT
"RTN","XMJMS",27,0)
 S XMBLOB=1
"RTN","XMJMS",28,0)
 D SEND
"RTN","XMJMS",29,0)
 Q
"RTN","XMJMS",30,0)
INIT(XMDUZ,XMABORT) ; Clean up and initialize for Sending a message
"RTN","XMJMS",31,0)
 D CHECK^XMVVITAE
"RTN","XMJMS",32,0)
 I XMDUZ'=DUZ,'$$WPRIV^XMXSEC D  Q  ; Replaces SUR^XMA22
"RTN","XMJMS",33,0)
 . S XMABORT=1
"RTN","XMJMS",34,0)
 . D SHOW^XMJERR
"RTN","XMJMS",35,0)
 D CHKLOCK(XMDUZ,.XMABORT)
"RTN","XMJMS",36,0)
 Q
"RTN","XMJMS",37,0)
CHKLOCK(XMDUZ,XMABORT) ;
"RTN","XMJMS",38,0)
 ; FYI, The menu system releases all locks upon exit from an option.
"RTN","XMJMS",39,0)
 I $G(XMV("PRIV"),"W")["W" S XMV("NOSEND")=0
"RTN","XMJMS",40,0)
 I 'XMV("NOSEND") D
"RTN","XMJMS",41,0)
 . L +^XMB(3.7,"AD",XMDUZ):0 E  S XMV("NOSEND")=1
"RTN","XMJMS",42,0)
 I XMV("NOSEND") D  Q  ; Replaces TWO^XMA1E
"RTN","XMJMS",43,0)
 . W !,$$EZBLD^DIALOG(37453) ; This session is concurrent with another.  You may not do this.
"RTN","XMJMS",44,0)
 . S XMABORT=1
"RTN","XMJMS",45,0)
 Q
"RTN","XMJMS",46,0)
PROCESS(XMDUZ,XMZ,XMSUBJ,XMABORT) ;
"RTN","XMJMS",47,0)
 N XMINSTR,XMRESTR
"RTN","XMJMS",48,0)
 I '$G(XMPAKMAN) D BODY(XMDUZ,XMZ,XMSUBJ,.XMRESTR,.XMABORT) Q:XMABORT
"RTN","XMJMS",49,0)
 I $G(XMBLOB) D ADD^XMA2B K XMBLOB I $D(XMOUT) S XMABORT=1 Q
"RTN","XMJMS",50,0)
 I $G(XMPAKMAN) D PACKIT(XMDUZ,XMZ,XMSUBJ,.XMABORT) Q:XMABORT
"RTN","XMJMS",51,0)
 D INIT^XMXADDR
"RTN","XMJMS",52,0)
 D TOWHOM^XMJMT(XMDUZ,$$EZBLD^DIALOG(34110),.XMINSTR,.XMRESTR,.XMABORT) ; Send
"RTN","XMJMS",53,0)
 I $G(XMPAKMAN),'XMABORT D PSECURE^XMPSEC(XMZ,.XMABORT)
"RTN","XMJMS",54,0)
 D:'XMABORT SENDMSG^XMJMSO(XMDUZ,XMZ,XMSUBJ,.XMINSTR,.XMRESTR,.XMABORT)
"RTN","XMJMS",55,0)
 D CLEANUP^XMXADDR
"RTN","XMJMS",56,0)
 Q
"RTN","XMJMS",57,0)
SUBJ(XMSUBJ,XMABORT) ; ask subject
"RTN","XMJMS",58,0)
 N DIR,X,Y,XMY
"RTN","XMJMS",59,0)
 S DIR("A")=$$EZBLD^DIALOG(34002) ; Subject:
"RTN","XMJMS",60,0)
 S DIR(0)="FOU^3:65"
"RTN","XMJMS",61,0)
 S:$D(XMSUBJ) DIR("B")=XMSUBJ
"RTN","XMJMS",62,0)
 S DIR("?")=$$EZBLD^DIALOG(39403) ; Subject must be from 3 to 65 characters long.
"RTN","XMJMS",63,0)
 S DIR("??")="^D QSUBJ^XMJMS"
"RTN","XMJMS",64,0)
 F  D  Q:XMY'=""!XMABORT
"RTN","XMJMS",65,0)
 . W !
"RTN","XMJMS",66,0)
 . D ^DIR S XMY=Y
"RTN","XMJMS",67,0)
 . I $D(DTOUT)!$D(DUOUT) S XMABORT=1 Q
"RTN","XMJMS",68,0)
 . D VSUBJ^XMXPARM(.XMY)
"RTN","XMJMS",69,0)
 . I $D(XMERR) D SHOW^XMJERR S XMY=""
"RTN","XMJMS",70,0)
 Q:XMABORT
"RTN","XMJMS",71,0)
 S XMSUBJ=$S(XMY[U:$$ENCODEUP^XMXUTIL1(XMY),1:XMY)
"RTN","XMJMS",72,0)
 Q
"RTN","XMJMS",73,0)
QSUBJ ;
"RTN","XMJMS",74,0)
 ;This is the subject of the message, shown whenever the message is displayed.
"RTN","XMJMS",75,0)
 ;Leading and trailing blanks are deleted.
"RTN","XMJMS",76,0)
 ;Any sequence of 3 or more blanks is reduced to 2 blanks.
"RTN","XMJMS",77,0)
 N XMTEXT
"RTN","XMJMS",78,0)
 D BLD^DIALOG(34261,"","","XMTEXT","F")
"RTN","XMJMS",79,0)
 D MSG^DIALOG("WH","",79,"","XMTEXT")
"RTN","XMJMS",80,0)
 Q:$D(XMSUBJ)
"RTN","XMJMS",81,0)
 W !!,$$EZBLD^DIALOG(34262) ; If you want to send a message with no subject, just press ENTER.
"RTN","XMJMS",82,0)
 Q
"RTN","XMJMS",83,0)
BODY(XMDUZ,XMZ,DIWESUB,XMRESTR,XMABORT) ; Replaces ENT1^XMA2
"RTN","XMJMS",84,0)
 N DIC
"RTN","XMJMS",85,0)
 ;W !,"You may ",$S($D(^XMB(3.9,XMZ,2,0)):"edit",1:"enter")," the ",$S($G(XMPAKMAN):"description of the PackMan",1:"text of the")," message..."
"RTN","XMJMS",86,0)
 W !,$$EZBLD^DIALOG($S($D(^XMB(3.9,XMZ,2,0)):34263.1,1:34263)) ; You may edit/enter the text of the message...
"RTN","XMJMS",87,0)
 S DWPK=1,DWLW=75,DIC="^XMB(3.9,"_XMZ_",2,"
"RTN","XMJMS",88,0)
 D EN^DIWE
"RTN","XMJMS",89,0)
 ; The following $D check is to recover from situations in which a user
"RTN","XMJMS",90,0)
 ; is in the middle of replying to a message, then opens a 2nd session,
"RTN","XMJMS",91,0)
 ; and somehow the reply message stub gets deleted in the 2nd session,
"RTN","XMJMS",92,0)
 ; and when the user returns to the 1st session and sends the reply, it
"RTN","XMJMS",93,0)
 ; says the reply is from * No Name *.  A lock on ^XMB(3.7,"AD",XMDUZ)
"RTN","XMJMS",94,0)
 ; is supposed to prevent the second session from doing this, but for
"RTN","XMJMS",95,0)
 ; some reason, at some sites, the second session does not see the lock.
"RTN","XMJMS",96,0)
 ; So we recreate the message stub here, in the 1st session, if it was
"RTN","XMJMS",97,0)
 ; deleted in the 2nd session.
"RTN","XMJMS",98,0)
 I '$D(^XMB(3.9,XMZ,0)) D
"RTN","XMJMS",99,0)
 . N XMSUBJ
"RTN","XMJMS",100,0)
 . S XMSUBJ=$S($D(XMRESTR("REPLYTO")):"R"_XMRESTR("REPLYTO"),1:DIWESUB)
"RTN","XMJMS",101,0)
 . S ^XMB(3.9,XMZ,0)=XMSUBJ
"RTN","XMJMS",102,0)
 . S ^XMB(3.9,"B",$E(XMSUBJ,1,30),XMZ)=""
"RTN","XMJMS",103,0)
 . I '$D(^XMB(3.9,XMZ,.6)) S ^XMB(3.9,XMZ,.6)=DT,^XMB(3.9,"C",DT,XMZ)=""
"RTN","XMJMS",104,0)
 I '$O(^XMB(3.9,XMZ,2,0)) S XMABORT=1 Q
"RTN","XMJMS",105,0)
 D CHKLINES^XMXSEC1(XMDUZ,XMZ,.XMRESTR)
"RTN","XMJMS",106,0)
 Q
"RTN","XMJMS",107,0)
PACKIT(XMDUZ,XMZ,XMSUBJ,XMABORT) ;
"RTN","XMJMS",108,0)
 N XCF,XCN,XMA,XMB0,XMP2,X,Y
"RTN","XMJMS",109,0)
 D ^XMP
"RTN","XMJMS",110,0)
 I X=U,Y=-1 S XMABORT=1
"RTN","XMJMS",111,0)
 Q
"RTN","XMJMS",112,0)
EDITON(XMDUZ,XMZ,XMZR,XMBLOB) ; Note that msg is being edited.  Replaces D^XMA0A
"RTN","XMJMS",113,0)
 N XMFDA,XMIENS
"RTN","XMJMS",114,0)
 S XMIENS=XMDUZ_","
"RTN","XMJMS",115,0)
 S XMFDA(3.7,XMIENS,5)=XMZ          ; current message/response
"RTN","XMJMS",116,0)
 S XMFDA(3.7,XMIENS,7)=$G(XMZR)     ; original message for response
"RTN","XMJMS",117,0)
 S XMFDA(3.7,XMIENS,7.5)=$G(XMBLOB) ; 0/1=BLOB yes/no
"RTN","XMJMS",118,0)
 D FILE^DIE("","XMFDA")
"RTN","XMJMS",119,0)
 Q
"RTN","XMJMS",120,0)
EDITOFF(XMDUZ) ; Note that msg is no longer being edited.
"RTN","XMJMS",121,0)
 N XMFDA,XMIENS
"RTN","XMJMS",122,0)
 S XMIENS=XMDUZ_","
"RTN","XMJMS",123,0)
 S XMFDA(3.7,XMIENS,5)="@"
"RTN","XMJMS",124,0)
 S XMFDA(3.7,XMIENS,7)="@"
"RTN","XMJMS",125,0)
 S XMFDA(3.7,XMIENS,7.5)="@"
"RTN","XMJMS",126,0)
 D FILE^DIE("","XMFDA")
"RTN","XMJMS",127,0)
 Q
"RTN","XMJMS",128,0)
HALT(XMACTION) ;
"RTN","XMJMS",129,0)
 W $C(7),!
"RTN","XMJMS",130,0)
 ;You have timed out while _XMACTION_ a message.
"RTN","XMJMS",131,0)
 ;You can resume when you log back on and re-enter MailMan.
"RTN","XMJMS",132,0)
 ;Do it today, or your text may be purged this evening.
"RTN","XMJMS",133,0)
 N XMTEXT
"RTN","XMJMS",134,0)
 D BLD^DIALOG(34264,XMACTION,"","XMTEXT","F")
"RTN","XMJMS",135,0)
 D MSG^DIALOG("WM","",79,"","XMTEXT")
"RTN","XMJMS",136,0)
 G H^XUS
"RTN","XMJMS",137,0)
RECOVER(XMDUZ,XMZ,XMBLOB) ;
"RTN","XMJMS",138,0)
 N XMTEXT,XMSUBJ,XMABORT
"RTN","XMJMS",139,0)
 S XMABORT=0
"RTN","XMJMS",140,0)
 W $C(7),!
"RTN","XMJMS",141,0)
 ;You have / |1| has an unsent message in your buffer.
"RTN","XMJMS",142,0)
 D BLD^DIALOG($S(XMDUZ=DUZ:34265,1:34265.1),XMV("NAME"),"","XMTEXT","F")
"RTN","XMJMS",143,0)
 I $G(XMV("PRIV"),"W")'["W" D  Q
"RTN","XMJMS",144,0)
 . ;Since you don't have 'send' privilege, you may not complete this
"RTN","XMJMS",145,0)
 . ;message.  If we delete this message, you'll be able to read and
"RTN","XMJMS",146,0)
 . ;reply to messages in this mailbox.  If we leave it alone, you'll
"RTN","XMJMS",147,0)
 . ;be able to read messages, but you won't be able to reply to them.
"RTN","XMJMS",148,0)
 . D BLD^DIALOG(34267,"","","XMTEXT","F")
"RTN","XMJMS",149,0)
 . D MSG^DIALOG("WM","",79,"","XMTEXT")
"RTN","XMJMS",150,0)
 . W !
"RTN","XMJMS",151,0)
 . N DIR,X,Y
"RTN","XMJMS",152,0)
 . S DIR(0)="Y"
"RTN","XMJMS",153,0)
 . S DIR("A")=$$EZBLD^DIALOG(34267.1) ; Shall we delete the message?
"RTN","XMJMS",154,0)
 . S DIR("B")=$$EZBLD^DIALOG(39054) ; YES
"RTN","XMJMS",155,0)
 . D ^DIR
"RTN","XMJMS",156,0)
 . I $D(DTOUT) D HALT($$EZBLD^DIALOG(34221)) ; recovering
"RTN","XMJMS",157,0)
 . I Y D  Q
"RTN","XMJMS",158,0)
 . . D EDITOFF(XMDUZ)
"RTN","XMJMS",159,0)
 . . D KILLMSG^XMXUTIL(XMZ)
"RTN","XMJMS",160,0)
 . S XMV("NOSEND")=1
"RTN","XMJMS",161,0)
 . W !
"RTN","XMJMS",162,0)
 . ;OK, you'll be able to read messages,
"RTN","XMJMS",163,0)
 . ;but you won't be able to reply to them.
"RTN","XMJMS",164,0)
 . D BLD^DIALOG(34267.2,"","","XMTEXT","F")
"RTN","XMJMS",165,0)
 . D MSG^DIALOG("WM","",79,"","XMTEXT")
"RTN","XMJMS",166,0)
 S XMSUBJ=$P(^XMB(3.9,XMZ,0),U,1)
"RTN","XMJMS",167,0)
 S:XMSUBJ["~U~" XMSUBJ=$$DECODEUP^XMXUTIL1(XMSUBJ)
"RTN","XMJMS",168,0)
 ;Subj: _XMSUBJ
"RTN","XMJMS",169,0)
 D BLD^DIALOG(34536,XMSUBJ,"","XMTEXT","FS")
"RTN","XMJMS",170,0)
 ;Some of the text may have been lost.
"RTN","XMJMS",171,0)
 ;You must re-enter recipients and any special handling instructions.
"RTN","XMJMS",172,0)
 D BLD^DIALOG(34266,"","","XMTEXT","FS")
"RTN","XMJMS",173,0)
 D MSG^DIALOG("WM","",79,"","XMTEXT")
"RTN","XMJMS",174,0)
 W !
"RTN","XMJMS",175,0)
 D INIT(XMDUZ,.XMABORT) Q:XMV("NOSEND")
"RTN","XMJMS",176,0)
 D WAIT^XMXUTIL
"RTN","XMJMS",177,0)
 I XMABORT D HALT($$EZBLD^DIALOG(34221)) ; recovering
"RTN","XMJMS",178,0)
 D PROCESS(XMDUZ,XMZ,XMSUBJ,.XMABORT)
"RTN","XMJMS",179,0)
 I XMABORT=DTIME D HALT($$EZBLD^DIALOG(34260)) ; sending
"RTN","XMJMS",180,0)
 D EDITOFF(XMDUZ)
"RTN","XMJMS",181,0)
 D:XMABORT KILLMSG^XMXUTIL(XMZ)
"RTN","XMJMS",182,0)
 Q
"RTN","XMJMSA")
0^305^B5186637
"RTN","XMJMSA",1,0)
XMJMSA ;ISC-SF/GMB-Send Anonymous User Suggestion Message ;04/17/2002  10:12
"RTN","XMJMSA",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMJMSA",3,0)
 ; Replaces ^XMANON (ISC-WASH/CAP)
"RTN","XMJMSA",4,0)
 ; Entry points used by MailMan options (not covered by DBIA):
"RTN","XMJMSA",5,0)
 ; SEND    XMSUGGESTION
"RTN","XMJMSA",6,0)
 ; This routine allows a user to send an anonymous message to the
"RTN","XMJMSA",7,0)
 ; SUGGESTION BOX basket of SHARED,MAIL.  If this basket doesn't exist,
"RTN","XMJMSA",8,0)
 ; it will be created.
"RTN","XMJMSA",9,0)
 ;
"RTN","XMJMSA",10,0)
 ; MailMan masks (does not record) the actual identity of the sender.
"RTN","XMJMSA",11,0)
 ;
"RTN","XMJMSA",12,0)
 ; To use it, put the XMSUGGESTION option onto the appropriate menu.
"RTN","XMJMSA",13,0)
 ; To stop a particular person from using it, put a 'Reverse/negative
"RTN","XMJMSA",14,0)
 ; Lock' onto the XMSUGGESTION option and assign that key to the
"RTN","XMJMSA",15,0)
 ; person you do not want to be able to use it.
"RTN","XMJMSA",16,0)
SEND ;
"RTN","XMJMSA",17,0)
 N XMSUBJ,XMABORT,XMFINISH,XMDIR,XMY,XMOPT,XMOX
"RTN","XMJMSA",18,0)
 D SET^XMXSEC2("ES",37305,.XMOPT,.XMOX) ; Edit Subject
"RTN","XMJMSA",19,0)
 D SET^XMXSEC2("ET",37306,.XMOPT,.XMOX) ; Edit Text
"RTN","XMJMSA",20,0)
 D SET^XMXSEC2("T",37334,.XMOPT,.XMOX) ; Transmit now
"RTN","XMJMSA",21,0)
 S XMDIR("A")=$$EZBLD^DIALOG(34067) ; Select Message option:
"RTN","XMJMSA",22,0)
 S XMDIR("B")=XMOX("O","T")_":"_XMOPT("T") ; Transmit now
"RTN","XMJMSA",23,0)
 S XMDIR("??")="@" ; no help screen
"RTN","XMJMSA",24,0)
 S XMABORT=0
"RTN","XMJMSA",25,0)
 ;D WARNING(.XMABORT) Q:XMABORT
"RTN","XMJMSA",26,0)
 D ES Q:XMABORT  ; Edit the subject
"RTN","XMJMSA",27,0)
 K ^TMP("XM",$J)
"RTN","XMJMSA",28,0)
 D ET Q:XMABORT  ; Edit the text
"RTN","XMJMSA",29,0)
 S XMFINISH=0
"RTN","XMJMSA",30,0)
 F  D  Q:XMFINISH!XMABORT
"RTN","XMJMSA",31,0)
 . D XMDIR^XMJDIR(.XMDIR,.XMOPT,.XMOX,.XMY,.XMABORT) Q:XMABORT
"RTN","XMJMSA",32,0)
 . D @XMY
"RTN","XMJMSA",33,0)
 K ^TMP("XM",$J)
"RTN","XMJMSA",34,0)
 Q
"RTN","XMJMSA",35,0)
ES ;
"RTN","XMJMSA",36,0)
 D SUBJ^XMJMS(.XMSUBJ,.XMABORT)
"RTN","XMJMSA",37,0)
 Q
"RTN","XMJMSA",38,0)
ET ; Edit text
"RTN","XMJMSA",39,0)
 N DIC
"RTN","XMJMSA",40,0)
 S DWPK=1,DWLW=75,DIC="^TMP(""XM"",$J,"
"RTN","XMJMSA",41,0)
 S DIWESUB=XMSUBJ
"RTN","XMJMSA",42,0)
 D EN^DIWE
"RTN","XMJMSA",43,0)
 I '$O(^TMP("XM",$J,0)) S XMABORT=1 Q
"RTN","XMJMSA",44,0)
 Q
"RTN","XMJMSA",45,0)
T ; Transmit the message
"RTN","XMJMSA",46,0)
 N XMDUZ,DUZ,XMINSTR,XMZ
"RTN","XMJMSA",47,0)
 S XMFINISH=1,(XMDUZ,DUZ)=.6
"RTN","XMJMSA",48,0)
 S XMINSTR("FROM")=$$EZBLD^DIALOG(34665) ; Anonymous
"RTN","XMJMSA",49,0)
 S XMINSTR("SHARE DATE")="3991231"
"RTN","XMJMSA",50,0)
 S XMINSTR("SHARE BSKT")=$$EZBLD^DIALOG(34666) ; SUGGESTION BOX
"RTN","XMJMSA",51,0)
 D CRE8XMZ^XMXSEND(XMSUBJ,.XMZ,1) Q:XMZ<1
"RTN","XMJMSA",52,0)
 W $$EZBLD^DIALOG(34217,XMZ) ; Sending [|1|]...
"RTN","XMJMSA",53,0)
 D MOVEBODY^XMXSEND(XMZ,"^TMP(""XM"",$J)")
"RTN","XMJMSA",54,0)
 D ADDRNSND^XMXSEND(XMDUZ,XMZ,XMDUZ,.XMINSTR)
"RTN","XMJMSA",55,0)
 W !,$$EZBLD^DIALOG(34213) ;  Sent
"RTN","XMJMSA",56,0)
 Q
"RTN","XMJMSA",57,0)
WARNING(XMABORT) ;
"RTN","XMJMSA",58,0)
 ;                 * * * * *  ATTENTION  * * * * *
"RTN","XMJMSA",59,0)
 ;      Anonymous messages may or may not be totally anonymous.
"RTN","XMJMSA",60,0)
 ;                Please check with your local IRM
"RTN","XMJMSA",61,0)
 ; to find out if your facility has methods in place to identify you.
"RTN","XMJMSA",62,0)
 N XMTEXT
"RTN","XMJMSA",63,0)
 W @IOF
"RTN","XMJMSA",64,0)
 D BLD^DIALOG(34667,"","","XMTEXT","F")
"RTN","XMJMSA",65,0)
 D MSG^DIALOG("WM","",79,"","XMTEXT")
"RTN","XMJMSA",66,0)
 W !!
"RTN","XMJMSA",67,0)
 D PAGE^XMXUTIL(.XMABORT)
"RTN","XMJMSA",68,0)
 Q
"RTN","XMJMSO")
0^306^B49837651
"RTN","XMJMSO",1,0)
XMJMSO ;ISC-SF/GMB-Options at 'send' transmit prompt ;11/01/2001  08:13
"RTN","XMJMSO",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMJMSO",3,0)
 ; Replaces ^XMA22 (ISC-WASH/CAP/THM)
"RTN","XMJMSO",4,0)
SENDMSG(XMDUZ,XMZ,XMSUBJ,XMINSTR,XMRESTR,XMABORT) ;
"RTN","XMJMSO",5,0)
 N XMFINISH,XMDIR,XMY,XMOPT,XMOX
"RTN","XMJMSO",6,0)
 I $$BCAST,'$D(XMINSTR("VAPOR")),$$QVAPOR D V
"RTN","XMJMSO",7,0)
 S XMFINISH=0
"RTN","XMJMSO",8,0)
 F  D  Q:XMFINISH!XMABORT
"RTN","XMJMSO",9,0)
 . D SENDSET(.XMINSTR,.XMOPT,.XMOX,.XMDIR)
"RTN","XMJMSO",10,0)
 . D XMDIR^XMJDIR(.XMDIR,.XMOPT,.XMOX,.XMY,.XMABORT) Q:XMABORT
"RTN","XMJMSO",11,0)
 . K XMDIR,XMOPT,XMOX
"RTN","XMJMSO",12,0)
 . D @XMY
"RTN","XMJMSO",13,0)
 Q
"RTN","XMJMSO",14,0)
SENDSET(XMINSTR,XMOPT,XMOX,XMDIR) ;
"RTN","XMJMSO",15,0)
 D OPTEDIT^XMXSEC2(.XMINSTR,.XMOPT,.XMOX,1)
"RTN","XMJMSO",16,0)
 D SET^XMXSEC2("B",37331,.XMOPT,.XMOX) ; Backup to review message
"RTN","XMJMSO",17,0)
 D SET^XMXSEC2("ER",37332,.XMOPT,.XMOX) ; Edit Recipients
"RTN","XMJMSO",18,0)
 D SET^XMXSEC2("L",37333,.XMOPT,.XMOX) ; Transmit later
"RTN","XMJMSO",19,0)
 D SET^XMXSEC2("IM",37445,.XMOPT,.XMOX) ; Include responses from another message
"RTN","XMJMSO",20,0)
 D SET^XMXSEC2("T",37334,.XMOPT,.XMOX) ; Transmit now
"RTN","XMJMSO",21,0)
 I $G(XMOPT("NS","?"))=37309.1 K XMOPT("NS","?") ; You have no Network Signature.
"RTN","XMJMSO",22,0)
 S XMDIR("A")=$$EZBLD^DIALOG(34067) ; Select Message option:
"RTN","XMJMSO",23,0)
 S XMDIR("B")=XMOX("O","T")_":"_XMOPT("T") ; Transmit now
"RTN","XMJMSO",24,0)
 S XMDIR("??")="XM-U-MO-SEND"
"RTN","XMJMSO",25,0)
 Q
"RTN","XMJMSO",26,0)
B ; Backup to review message
"RTN","XMJMSO",27,0)
 D BACKUP^XMJMP(XMDUZ,0,"",XMZ)
"RTN","XMJMSO",28,0)
 ; OR D PRINTIT^XMJMP1(....)
"RTN","XMJMSO",29,0)
 Q
"RTN","XMJMSO",30,0)
FLAGTOGL(XMINSTR,XMFLAG,XMSET,XMREMOVE) ; Flag Toggle
"RTN","XMJMSO",31,0)
 I $G(XMINSTR("FLAGS"))[XMFLAG D
"RTN","XMJMSO",32,0)
 . S XMINSTR("FLAGS")=$TR(XMINSTR("FLAGS"),XMFLAG)
"RTN","XMJMSO",33,0)
 . W !,$$EZBLD^DIALOG(XMREMOVE)
"RTN","XMJMSO",34,0)
 E  D
"RTN","XMJMSO",35,0)
 . S XMINSTR("FLAGS")=$G(XMINSTR("FLAGS"))_XMFLAG
"RTN","XMJMSO",36,0)
 . W !,$$EZBLD^DIALOG(XMSET)
"RTN","XMJMSO",37,0)
 Q
"RTN","XMJMSO",38,0)
C ; Confidential msg
"RTN","XMJMSO",39,0)
 D FLAGTOGL(.XMINSTR,"C",37301.9,37302.9)
"RTN","XMJMSO",40,0)
 Q
"RTN","XMJMSO",41,0)
D ; Deliver to recipient basket
"RTN","XMJMSO",42,0)
 I $D(XMINSTR("RCPT BSKT")) D  Q
"RTN","XMJMSO",43,0)
 . K XMINSTR("RCPT BSKT")
"RTN","XMJMSO",44,0)
 . W !,$$EZBLD^DIALOG(37304.9) ; Delivery basket removed.
"RTN","XMJMSO",45,0)
 N XMTEXT
"RTN","XMJMSO",46,0)
 W !
"RTN","XMJMSO",47,0)
 D BLD^DIALOG(37303.1,"","","XMTEXT","F")
"RTN","XMJMSO",48,0)
 D MSG^DIALOG("WM","",80,"","XMTEXT")
"RTN","XMJMSO",49,0)
 W !
"RTN","XMJMSO",50,0)
 ;The delivery basket is the basket to which this message should be delivered
"RTN","XMJMSO",51,0)
 ;for all recipients (even future ones, should the message be forwarded).
"RTN","XMJMSO",52,0)
 ;Any message filters, which the recipient might have, are ignored."
"RTN","XMJMSO",53,0)
 ;If the basket does not exist, it will be created."
"RTN","XMJMSO",54,0)
 ;Note: The recipients must have chosen to allow delivery baskets by setting
"RTN","XMJMSO",55,0)
 ;ACCEPT DELIVERY BASKET? under 'Personal Preferences|Delivery Basket Edit'
"RTN","XMJMSO",56,0)
 ;to one of the following:
"RTN","XMJMSO",57,0)
 ; YES    - If basket doesn't exist, create it, and deliver the message to it.
"RTN","XMJMSO",58,0)
 ; EXIST  - If the basket already exists, then deliver the message to it.
"RTN","XMJMSO",59,0)
 ;          Else, just deliver the message as usual.
"RTN","XMJMSO",60,0)
 ; SELECT - If the basket already exists AND accepts such messages,
"RTN","XMJMSO",61,0)
 ;          then deliver the message to it.
"RTN","XMJMSO",62,0)
 ;          Else, just deliver the message as usual.
"RTN","XMJMSO",63,0)
 ;If the recipient has not set this field or has set it to NO, then
"RTN","XMJMSO",64,0)
 ;the message would be delivered as usual.
"RTN","XMJMSO",65,0)
 N XMDIC,XMK,XMKN
"RTN","XMJMSO",66,0)
 S XMDIC("B")="@"
"RTN","XMJMSO",67,0)
 S XMDIC("S")="I Y>1"
"RTN","XMJMSO",68,0)
 D SELBSKT^XMJBU(XMDUZ,$$EZBLD^DIALOG(37303.2),"L",.XMDIC,.XMK,.XMKN) ; Select delivery basket:
"RTN","XMJMSO",69,0)
 Q:XMK=U
"RTN","XMJMSO",70,0)
 S XMINSTR("RCPT BSKT")=XMKN
"RTN","XMJMSO",71,0)
 Q
"RTN","XMJMSO",72,0)
ER ; Additional Recipients
"RTN","XMJMSO",73,0)
 D TOWHOM^XMJMT(XMDUZ,$$EZBLD^DIALOG(34110),.XMINSTR,.XMRESTR,.XMABORT) ; Send
"RTN","XMJMSO",74,0)
 Q
"RTN","XMJMSO",75,0)
ES ; Edit Subject
"RTN","XMJMSO",76,0)
 N XMOLDSUB,XMABORT
"RTN","XMJMSO",77,0)
 S XMOLDSUB=XMSUBJ,XMABORT=0
"RTN","XMJMSO",78,0)
 D SUBJ^XMJMS(.XMSUBJ,.XMABORT) Q:XMABORT
"RTN","XMJMSO",79,0)
 Q:XMSUBJ=XMOLDSUB
"RTN","XMJMSO",80,0)
 N XMFDA
"RTN","XMJMSO",81,0)
 S XMFDA(3.9,XMZ_",",.01)=XMSUBJ
"RTN","XMJMSO",82,0)
 D FILE^DIE("","XMFDA")
"RTN","XMJMSO",83,0)
 Q
"RTN","XMJMSO",84,0)
ET ; Edit msg
"RTN","XMJMSO",85,0)
 I $G(XMPAKMAN) Q:$$NOPAKEDT
"RTN","XMJMSO",86,0)
 D BODY^XMJMS(XMDUZ,XMZ,XMSUBJ,.XMRESTR,.XMABORT)
"RTN","XMJMSO",87,0)
 Q
"RTN","XMJMSO",88,0)
NOPAKEDT() ; Function returns 0 if OK to edit; 1, if not OK.
"RTN","XMJMSO",89,0)
 I $D(XMSECURE) W !,$$EZBLD^DIALOG(37405.4) Q 1  ; You may not edit a secure KIDS or PackMan message.
"RTN","XMJMSO",90,0)
 N DIR,X,Y,DIRUT
"RTN","XMJMSO",91,0)
 W @IOF
"RTN","XMJMSO",92,0)
 N XMTEXT
"RTN","XMJMSO",93,0)
 D BLD^DIALOG(37306.1,"","","XMTEXT","F")
"RTN","XMJMSO",94,0)
 D MSG^DIALOG("WM","",80,"","XMTEXT")
"RTN","XMJMSO",95,0)
 ;                    W A R N I N G
"RTN","XMJMSO",96,0)
 ;  You are about to edit what appears to be a PackMan message.
"RTN","XMJMSO",97,0)
 ;  Please note the following:
"RTN","XMJMSO",98,0)
 ;  1. If you edit this message you may compromise its integrity.
"RTN","XMJMSO",99,0)
 ;  2. If you must edit it,
"RTN","XMJMSO",100,0)
 ;     - Do not edit the code.
"RTN","XMJMSO",101,0)
 ;     - Confine your editing to the text (the lines between $TXT and $ENDTXT).
"RTN","XMJMSO",102,0)
 ;     - You may insert lines in the text.
"RTN","XMJMSO",103,0)
 ;     - Do not begin any line with a '$' (dollar sign).
"RTN","XMJMSO",104,0)
 ;     - Be careful!
"RTN","XMJMSO",105,0)
 S DIR(0)="Y"
"RTN","XMJMSO",106,0)
 S DIR("A")=$$EZBLD^DIALOG(37306.2) ; Are you sure you want to edit this message
"RTN","XMJMSO",107,0)
 S DIR("B")=$$EZBLD^DIALOG(39053) ; NO
"RTN","XMJMSO",108,0)
 D ^DIR
"RTN","XMJMSO",109,0)
 Q 'Y
"RTN","XMJMSO",110,0)
I ; Information only msg
"RTN","XMJMSO",111,0)
 D FLAGTOGL(.XMINSTR,"I",37307.9,37308.9)
"RTN","XMJMSO",112,0)
 Q
"RTN","XMJMSO",113,0)
IM ; Include responses from another message
"RTN","XMJMSO",114,0)
 I $G(XMPAKMAN) D  Q
"RTN","XMJMSO",115,0)
 . W !,$$EZBLD^DIALOG(37445.4) ; You may not Include anything into a KIDS or PackMan message.
"RTN","XMJMSO",116,0)
 D INCL^XMJMRO(XMDUZ,XMZ,XMZ,XMSUBJ,.XMRESTR,2,.XMABORT)
"RTN","XMJMSO",117,0)
 Q
"RTN","XMJMSO",118,0)
L ; Transmit Later
"RTN","XMJMSO",119,0)
 N DIR,X,Y,XMWHEN,ZTRTN,ZTDTH,ZTDESC,ZTIO,ZTSAVE,ZTSK,XMROOT,I,DIRUT
"RTN","XMJMSO",120,0)
 I $E($O(^TMP("XMY0",$J,"G.")),1,2)="G." D
"RTN","XMJMSO",121,0)
 . ;Note: When you send a message Later, it is sent to all members of
"RTN","XMJMSO",122,0)
 . ;the groups to which you addressed it, even if you 'minus'ed anyone.
"RTN","XMJMSO",123,0)
 . ;To have your 'minus'es honored, you must ^-out of this and Transmit
"RTN","XMJMSO",124,0)
 . ;Now, not Later.  If you didn't 'minus' anyone from the groups, just
"RTN","XMJMSO",125,0)
 . ;ignore this note, and continue ...
"RTN","XMJMSO",126,0)
 . N XMTEXT
"RTN","XMJMSO",127,0)
 . W !
"RTN","XMJMSO",128,0)
 . D BLD^DIALOG(37333.3,"","","XMTEXT","F")
"RTN","XMJMSO",129,0)
 . D MSG^DIALOG("WM","",80,"","XMTEXT")
"RTN","XMJMSO",130,0)
 . W !
"RTN","XMJMSO",131,0)
 S DIR(0)="D^NOW:"_$$SCH^XLFDT("12M",DT)_":ETX"
"RTN","XMJMSO",132,0)
 S DIR("A")=$$EZBLD^DIALOG(37333.1) ; Enter Date@time at which to send this message
"RTN","XMJMSO",133,0)
 D ^DIR Q:$D(DIRUT)
"RTN","XMJMSO",134,0)
 S XMWHEN=Y
"RTN","XMJMSO",135,0)
 W !,$$EZBLD^DIALOG(37333.2) ;  Latering ...
"RTN","XMJMSO",136,0)
 S ZTIO=""
"RTN","XMJMSO",137,0)
 S ZTRTN="LATER^XMXSEND"
"RTN","XMJMSO",138,0)
 S ZTDTH=$$FMTH^XLFDT(XMWHEN)
"RTN","XMJMSO",139,0)
 S ZTDESC=$$EZBLD^DIALOG(39310) ; MailMan: Send Message Later
"RTN","XMJMSO",140,0)
 S XMROOT=$$GET1^DIQ(3.9,XMZ_",",3,"","^TMP(""XM"",$J,""BODY"")")
"RTN","XMJMSO",141,0)
 F I="DUZ","XMDUZ","XMSUBJ","^TMP(""XMY0"",$J,","^TMP(""XM"",$J,""BODY"",","XMINSTR(" S ZTSAVE(I)=""
"RTN","XMJMSO",142,0)
 D ^%ZTLOAD
"RTN","XMJMSO",143,0)
 ;D HOME^%ZIS call this only if preceded by call to ^%ZIS
"RTN","XMJMSO",144,0)
 I $D(ZTSK) D
"RTN","XMJMSO",145,0)
 . S XMFINISH=1
"RTN","XMJMSO",146,0)
 . W $$EZBLD^DIALOG(37333.9,ZTSK) ;  Latered (Task #_ZTSK_)
"RTN","XMJMSO",147,0)
 . D KILLMSG^XMXUTIL(XMZ)
"RTN","XMJMSO",148,0)
 . D CLEANUP^XMXADDR
"RTN","XMJMSO",149,0)
 E  D
"RTN","XMJMSO",150,0)
 . W !,$C(7),$$EZBLD^DIALOG(37333.8) ; Latering was not successful.  Try again or transmit now.
"RTN","XMJMSO",151,0)
 K ^TMP("XM",$J,"BODY")
"RTN","XMJMSO",152,0)
 Q
"RTN","XMJMSO",153,0)
NS ; Add Network Signature
"RTN","XMJMSO",154,0)
 I '$$GOTNS^XMVVITA(XMDUZ) D  Q:'$$GOTNS^XMVVITA(XMDUZ)
"RTN","XMJMSO",155,0)
 . W !!,$$EZBLD^DIALOG(37309.1) ; You have no Network Signature.
"RTN","XMJMSO",156,0)
 . D CRE8NS^XMVVITA
"RTN","XMJMSO",157,0)
 N XMMSG
"RTN","XMJMSO",158,0)
 D NETSIG^XMXEDIT(XMDUZ,XMZ,.XMINSTR,.XMMSG)
"RTN","XMJMSO",159,0)
 W !,XMMSG
"RTN","XMJMSO",160,0)
 Q
"RTN","XMJMSO",161,0)
P ; Priority msg
"RTN","XMJMSO",162,0)
 D FLAGTOGL(.XMINSTR,"P",37311.9,37312.9)
"RTN","XMJMSO",163,0)
 Q
"RTN","XMJMSO",164,0)
R ; Confirm receipt of msg
"RTN","XMJMSO",165,0)
 D FLAGTOGL(.XMINSTR,"R",37313.9,37314.9)
"RTN","XMJMSO",166,0)
 Q
"RTN","XMJMSO",167,0)
S ; Scramble text
"RTN","XMJMSO",168,0)
 I $D(XMINSTR("SCR KEY")) D  Q
"RTN","XMJMSO",169,0)
 . K XMINSTR("SCR KEY"),XMINSTR("SCR HINT")
"RTN","XMJMSO",170,0)
 . W !,$$EZBLD^DIALOG(37316.8) ; Scramble removed
"RTN","XMJMSO",171,0)
 N XMKEY,XMHINT,XMABORT
"RTN","XMJMSO",172,0)
 S XMABORT=0
"RTN","XMJMSO",173,0)
 D CRE8KEY^XMJMCODE(.XMKEY,.XMHINT,.XMABORT)
"RTN","XMJMSO",174,0)
 I XMABORT W !,$$EZBLD^DIALOG(37315.8) Q  ; Scramble aborted.
"RTN","XMJMSO",175,0)
 S XMINSTR("SCR KEY")=XMKEY
"RTN","XMJMSO",176,0)
 S XMINSTR("SCR HINT")=XMHINT
"RTN","XMJMSO",177,0)
 Q
"RTN","XMJMSO",178,0)
T ; Transmit now
"RTN","XMJMSO",179,0)
 S XMFINISH=1
"RTN","XMJMSO",180,0)
 W $$EZBLD^DIALOG(34217,XMZ) ;   Sending [_XMZ_]...
"RTN","XMJMSO",181,0)
 D MOVEPART^XMXSEND(XMDUZ,XMZ,.XMINSTR)
"RTN","XMJMSO",182,0)
 D SEND^XMKP(XMDUZ,XMZ,.XMINSTR)
"RTN","XMJMSO",183,0)
 D CHECK^XMKPL
"RTN","XMJMSO",184,0)
 W !,$$EZBLD^DIALOG(34213) ;   Sent"
"RTN","XMJMSO",185,0)
 Q
"RTN","XMJMSO",186,0)
V ; Vaporize date
"RTN","XMJMSO",187,0)
 I $G(XMINSTR("VAPOR")) D  Q
"RTN","XMJMSO",188,0)
 . K XMINSTR("VAPOR")
"RTN","XMJMSO",189,0)
 . W !,$$EZBLD^DIALOG(37318.9) ; Vaporize Date removed
"RTN","XMJMSO",190,0)
 N DIR,X,Y,DIRUT,XMTP1
"RTN","XMJMSO",191,0)
 S XMTP1=$$FMADD^XLFDT(DT,1)
"RTN","XMJMSO",192,0)
 S DIR(0)="3.9,1.6"
"RTN","XMJMSO",193,0)
 S DIR("A")=$$EZBLD^DIALOG(37317.1) ; Enter Vaporize Date
"RTN","XMJMSO",194,0)
 S DIR("B")=$$MMDT^XMXUTIL1($$FMADD^XLFDT(DT,30))
"RTN","XMJMSO",195,0)
V2 D ^DIR Q:$D(DIRUT)
"RTN","XMJMSO",196,0)
 I Y<XMTP1 D  G V2
"RTN","XMJMSO",197,0)
 . W " ??",$C(7),!,$$EZBLD^DIALOG(37317.2),! ; Must be no earlier than tomorrow.
"RTN","XMJMSO",198,0)
 S XMINSTR("VAPOR")=Y
"RTN","XMJMSO",199,0)
 Q
"RTN","XMJMSO",200,0)
X ; Closed msg
"RTN","XMJMSO",201,0)
 D FLAGTOGL(.XMINSTR,"X",37319.9,37320.9)
"RTN","XMJMSO",202,0)
 Q
"RTN","XMJMSO",203,0)
BCAST() ; Is this a broadcast (regular or limited)?
"RTN","XMJMSO",204,0)
 N XMTO
"RTN","XMJMSO",205,0)
 S XMTO=$O(^TMP("XMY0",$J,"*"))
"RTN","XMJMSO",206,0)
 I $E(XMTO)="*" Q 1
"RTN","XMJMSO",207,0)
 Q 0
"RTN","XMJMSO",208,0)
QVAPOR() ;
"RTN","XMJMSO",209,0)
 N DIR
"RTN","XMJMSO",210,0)
 W !
"RTN","XMJMSO",211,0)
 S DIR(0)="Y"
"RTN","XMJMSO",212,0)
 D BLD^DIALOG(37350,"","","DIR(""A"")")
"RTN","XMJMSO",213,0)
 D BLD^DIALOG(37351,"","","DIR(""?"")")
"RTN","XMJMSO",214,0)
 S DIR("??")="XM-U-M-VAPORIZE DATE SEND"
"RTN","XMJMSO",215,0)
 S DIR("B")=$$EZBLD^DIALOG(39054) ; Yes
"RTN","XMJMSO",216,0)
 D ^DIR Q:$D(DIRUT) 0
"RTN","XMJMSO",217,0)
 Q Y
"RTN","XMJMT")
0^307^B25844973
"RTN","XMJMT",1,0)
XMJMT ;ISC-SF/GMB-Interactive Send to whom ;04/17/2002  10:33
"RTN","XMJMT",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMJMT",3,0)
 ; Entry points used by MailMan options (not covered by DBIA):
"RTN","XMJMT",4,0)
 ; R     XMHELPLNK - Get help on remote addresses (mail link)
"RTN","XMJMT",5,0)
TOWHOM(XMDUZ,XMTYPE,XMINSTR,XMRESTR,XMABORT) ;
"RTN","XMJMT",6,0)
 N DIR,X,Y,XMTO
"RTN","XMJMT",7,0)
 S XMTO="?"
"RTN","XMJMT",8,0)
 F  D  Q:XMTO=""!XMABORT
"RTN","XMJMT",9,0)
 . K DIR
"RTN","XMJMT",10,0)
 . I $D(^TMP("XMY0",$J)) D
"RTN","XMJMT",11,0)
 . . S DIR("A")=$$EZBLD^DIALOG(34113,XMTYPE) ;And |1| to
"RTN","XMJMT",12,0)
 . . S DIR(0)="FrO^1:100" ; ('r' means no 'replace...with...' prompt)
"RTN","XMJMT",13,0)
 . E  D
"RTN","XMJMT",14,0)
 . . S DIR("A")=$$EZBLD^DIALOG(34112,XMTYPE) ;|1| mail to
"RTN","XMJMT",15,0)
 . . I XMTYPE=$$EZBLD^DIALOG(34110) S DIR("B")=$G(XMINSTR("TO PROMPT"),XMV("NAME")) ;Send
"RTN","XMJMT",16,0)
 . . E  I $G(XMINSTR("TO PROMPT")) S DIR("B")=XMINSTR("TO PROMPT")
"RTN","XMJMT",17,0)
 . . S DIR(0)="Fr^1:100"
"RTN","XMJMT",18,0)
 . D BLD^DIALOG(34114,"","","DIR(""?"")") ;Enter the name(s) of the recipient(s)
"RTN","XMJMT",19,0)
 . S DIR("??")="^D QQ^XMJMT"
"RTN","XMJMT",20,0)
 . D ^DIR I $D(DTOUT) S XMABORT=DTIME Q
"RTN","XMJMT",21,0)
 . I $D(DUOUT) D  Q
"RTN","XMJMT",22,0)
 . . I XMTYPE=$$EZBLD^DIALOG(34111) S XMABORT=1 Q  ;Forward
"RTN","XMJMT",23,0)
 . . N DIR,DIRUT,X,Y
"RTN","XMJMT",24,0)
 . . S DIR("A")=$$EZBLD^DIALOG(34115) ;Shall we forget the whole thing
"RTN","XMJMT",25,0)
 . . S DIR("B")=$$EZBLD^DIALOG(39053) ;No
"RTN","XMJMT",26,0)
 . . S DIR(0)="Y"
"RTN","XMJMT",27,0)
 . . D BLD^DIALOG(34116,"","","DIR(""?"")") ;Enter YES to abort this message.
"RTN","XMJMT",28,0)
 . . D ^DIR
"RTN","XMJMT",29,0)
 . . I Y=1!$D(DIRUT) S XMABORT=1
"RTN","XMJMT",30,0)
 . S XMTO=Y Q:XMTO=""
"RTN","XMJMT",31,0)
 . I $G(XMRESTR("NOFPG")),$E(XMTO,1,2)="G." D  Q
"RTN","XMJMT",32,0)
 . . ;Only the message originator or XM GROUP PRIORITY key
"RTN","XMJMT",33,0)
 . . ;holders may forward priority messages to Mail Groups.
"RTN","XMJMT",34,0)
 . . N XMTEXT
"RTN","XMJMT",35,0)
 . . D BLD^DIALOG(34117,"","","XMTEXT","F")
"RTN","XMJMT",36,0)
 . . D MSG^DIALOG("WE","","","","XMTEXT")
"RTN","XMJMT",37,0)
 . I $G(XMRESTR("NONET")),XMTO["@" D  Q
"RTN","XMJMT",38,0)
 . . N XMTEXT
"RTN","XMJMT",39,0)
 . . W $C(7)
"RTN","XMJMT",40,0)
 . . ;Messages longer than |1| lines may not be sent across the network.
"RTN","XMJMT",41,0)
 . . D BLD^DIALOG(39001,XMRESTR("NONET"),"","XMTEXT","F")
"RTN","XMJMT",42,0)
 . . D MSG^DIALOG("WE","","","","XMTEXT")
"RTN","XMJMT",43,0)
 . I XMTO=XMV("NAME"),$G(DIR("B"))=XMV("NAME") S XMTO="`"_XMDUZ ; to avoid ambiguity in case 2 users have the same name.
"RTN","XMJMT",44,0)
 . D ADDR^XMXADDR(XMDUZ,XMTO,.XMINSTR,.XMRESTR)
"RTN","XMJMT",45,0)
 Q
"RTN","XMJMT",46,0)
QQ ; "??" help
"RTN","XMJMT",47,0)
 N DIR,X,Y,XMCHOICE,I
"RTN","XMJMT",48,0)
 S DIR("A")=$$EZBLD^DIALOG(34120) ;Enter the kind of help you'd like
"RTN","XMJMT",49,0)
 S I=$$EZBLD^DIALOG(34126),XMCHOICE($P(I,":"))="U" ;U:User information
"RTN","XMJMT",50,0)
 S DIR(0)="SO^"_I
"RTN","XMJMT",51,0)
 S I=$$EZBLD^DIALOG(34121),XMCHOICE($P(I,":"))="G" ;G:Mail Group information
"RTN","XMJMT",52,0)
 S DIR(0)=DIR(0)_";"_I
"RTN","XMJMT",53,0)
 S I=$$EZBLD^DIALOG(34122),XMCHOICE($P(I,":"))="D" ;D:Domain information
"RTN","XMJMT",54,0)
 S DIR(0)=DIR(0)_";"_I
"RTN","XMJMT",55,0)
 I $O(^XMD(4.2997,0)) D
"RTN","XMJMT",56,0)
 . S I=$$EZBLD^DIALOG(34123),XMCHOICE($P(I,":"))="R" ;R:Remote user information
"RTN","XMJMT",57,0)
 . S DIR(0)=DIR(0)_";"_I
"RTN","XMJMT",58,0)
 I $D(^TMP("XMY0",$J)) D
"RTN","XMJMT",59,0)
 . S I=$$EZBLD^DIALOG(34124),XMCHOICE($P(I,":"))="S" ;S:Show current recipients of this message
"RTN","XMJMT",60,0)
 . S DIR(0)=DIR(0)_";"_I
"RTN","XMJMT",61,0)
 S I=$$EZBLD^DIALOG(34125),XMCHOICE($P(I,":"))="M" ;M:More help
"RTN","XMJMT",62,0)
 S DIR(0)=DIR(0)_";"_I
"RTN","XMJMT",63,0)
 F  D ^DIR Q:$D(DIRUT)  D @XMCHOICE(Y)
"RTN","XMJMT",64,0)
 Q
"RTN","XMJMT",65,0)
S ; Show Current Recipients
"RTN","XMJMT",66,0)
 N XMTO,XMABORT,DIR,X,Y
"RTN","XMJMT",67,0)
 I '$D(^TMP("XMY0",$J)) W !,$$EZBLD^DIALOG(34130) Q  ;There aren't any recipients so far.
"RTN","XMJMT",68,0)
 W @IOF,$$EZBLD^DIALOG(34131) ;Current recipients are:
"RTN","XMJMT",69,0)
 S XMTO="",XMABORT=0
"RTN","XMJMT",70,0)
 F  S XMTO=$O(^TMP("XMY0",$J,XMTO)) Q:XMTO=""  D  Q:XMABORT
"RTN","XMJMT",71,0)
 . D:$Y+3>IOSL PAGE(.XMABORT)
"RTN","XMJMT",72,0)
 . W !,?3,$S($D(^TMP("XMY0",$J,XMTO,1)):^(1)_":",1:""),XMTO
"RTN","XMJMT",73,0)
 . W:$D(^TMP("XMY0",$J,XMTO,"L")) ?40,$$EZBLD^DIALOG(34132),$$MMDT^XMXUTIL1(^("L")) ;Deliver:
"RTN","XMJMT",74,0)
 Q:XMABORT
"RTN","XMJMT",75,0)
 Q:'$D(^TMP("XMY",$J))
"RTN","XMJMT",76,0)
 S DIR(0)="Y"
"RTN","XMJMT",77,0)
 S DIR("A")=$$EZBLD^DIALOG(34133) ;Like more detail
"RTN","XMJMT",78,0)
 S DIR("B")=$$EZBLD^DIALOG(39054) ;Yes
"RTN","XMJMT",79,0)
 D ^DIR
"RTN","XMJMT",80,0)
 Q:Y'=1
"RTN","XMJMT",81,0)
 ;Expanded Recipient List
"RTN","XMJMT",82,0)
 S XMTO=""
"RTN","XMJMT",83,0)
 F  S XMTO=$O(^TMP("XMY",$J,XMTO)) Q:XMTO=""  D  Q:XMABORT
"RTN","XMJMT",84,0)
 . D:$Y+3>IOSL PAGE(.XMABORT)
"RTN","XMJMT",85,0)
 . W !,?3,$S($D(^TMP("XMY",$J,XMTO,1)):^(1)_":",1:""),$$NAME^XMXUTIL(XMTO)
"RTN","XMJMT",86,0)
 D PAGE(.XMABORT)
"RTN","XMJMT",87,0)
 Q
"RTN","XMJMT",88,0)
PAGE(XMABORT) ;
"RTN","XMJMT",89,0)
 D PAGE^XMXUTIL(.XMABORT) Q:XMABORT
"RTN","XMJMT",90,0)
 W @IOF
"RTN","XMJMT",91,0)
 Q
"RTN","XMJMT",92,0)
U ; User Info
"RTN","XMJMT",93,0)
 D HELP^XMHIU
"RTN","XMJMT",94,0)
 Q
"RTN","XMJMT",95,0)
G ; Group Info
"RTN","XMJMT",96,0)
 N DIR
"RTN","XMJMT",97,0)
 D HELP^XMHIG
"RTN","XMJMT",98,0)
 Q
"RTN","XMJMT",99,0)
D ; Domain Info (Replaces QQ2^XMA50)
"RTN","XMJMT",100,0)
 N DIC,X,Y,XMSTATE,XMREC
"RTN","XMJMT",101,0)
 S DIC="^DIC(4.2,",DIC(0)="AEQMZ"
"RTN","XMJMT",102,0)
 F  W ! D ^DIC Q:Y<0  D
"RTN","XMJMT",103,0)
 . S XMREC=Y(0)
"RTN","XMJMT",104,0)
 . W:$L($P(XMREC,U,14)) !,$$EZBLD^DIALOG(34140),$P(XMREC,U,14) ;Routing indicator:
"RTN","XMJMT",105,0)
 . I $D(^XUSEC("XMMGR",DUZ)) D
"RTN","XMJMT",106,0)
 . . W:$L($P(XMREC,U,12)) !,$$EZBLD^DIALOG(34141),$P(XMREC,U,12) ;MailMan Host Number:
"RTN","XMJMT",107,0)
 . . W:$L($P(XMREC,U,11)) !,$$EZBLD^DIALOG(34142),$P(XMREC,U,11) ;Security Key:
"RTN","XMJMT",108,0)
 . W:$P(XMREC,U,3) !,$$EZBLD^DIALOG(34143),$P(^DIC(4.2,$P(XMREC,U,3),0),U,1) ;Relay Domain:
"RTN","XMJMT",109,0)
 . S XMSTATE=$P(XMREC,U,2)
"RTN","XMJMT",110,0)
 . W !,$$EZBLD^DIALOG($S(XMSTATE["C":34144,XMSTATE'["S":34145,1:34146))
"RTN","XMJMT",111,0)
 . ; 34144 - Messages cannot be sent, because this domain is CLOSED
"RTN","XMJMT",112,0)
 . ; 34145 - Messages are QUEUED for later transmission
"RTN","XMJMT",113,0)
 . ; 34146 - Messages are SENT immediately
"RTN","XMJMT",114,0)
 Q
"RTN","XMJMT",115,0)
R ; Remote User Info (Replaces QQ3A,QQ3B^XMA5)
"RTN","XMJMT",116,0)
 N DIC,X,Y,DR,DA
"RTN","XMJMT",117,0)
 S DIC="^XMD(4.2997,",DIC(0)="AEFMQ"
"RTN","XMJMT",118,0)
 S DIC("A")=$$EZBLD^DIALOG(34149) ; Enter LASTNAME, MAIL CODE, or LOCATION
"RTN","XMJMT",119,0)
 F  W ! D ^DIC Q:Y<0  D
"RTN","XMJMT",120,0)
 . S DA=+Y,DR=0 D EN^DIQ
"RTN","XMJMT",121,0)
 Q
"RTN","XMJMT",122,0)
M ;
"RTN","XMJMT",123,0)
 N XQH,DIR,X,Y
"RTN","XMJMT",124,0)
 S XQH="XM-U-A-ADDRESS"
"RTN","XMJMT",125,0)
 D EN^XQH
"RTN","XMJMT",126,0)
 Q
"RTN","XMKP")
0^40^B71100476
"RTN","XMKP",1,0)
XMKP ;ISC-SF/GMB-Address and Post msg ;04/17/2002  10:53
"RTN","XMKP",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMKP",3,0)
 ; Replaces ENT1^XMAD1,ENT^XMAD1,FINAL^XMAD1X (ISC-WASH/CAP)
"RTN","XMKP",4,0)
SEND(XMDUZ,XMZ,XMINSTR) ;
"RTN","XMKP",5,0)
 ; XMINSTR("SHARE DATE")  Delete date for mail addressed to SHARED,MAIL
"RTN","XMKP",6,0)
 ; XMINSTR("SHARE BSKT")  Basket for mail addressed to SHARED,MAIL
"RTN","XMKP",7,0)
 ; XMINSTR("SELF BSKT")   Basket to deliver to if recipient is the sender
"RTN","XMKP",8,0)
 N XMTOCNT,XMPRI,XMINST
"RTN","XMKP",9,0)
 S XMPRI=($G(XMINSTR("FLAGS"))["P")
"RTN","XMKP",10,0)
 D SADDRTO(XMDUZ,XMZ) ; Populate ADDRESSED TO multiple
"RTN","XMKP",11,0)
 D SRECIP(XMDUZ,XMZ,XMPRI,.XMTOCNT) ; Populate RECIPIENT multiple
"RTN","XMKP",12,0)
 I XMTOCNT!$$BRODCAST D SPOST(XMDUZ,XMZ,XMTOCNT,.XMINSTR)
"RTN","XMKP",13,0)
 S XMINST=""
"RTN","XMKP",14,0)
 F  S XMINST=$O(^XMB(3.9,XMZ,1,"AQUEUE",XMINST)) Q:'XMINST  D
"RTN","XMKP",15,0)
 . D REMOTE^XMKPR(XMZ,XMINST)
"RTN","XMKP",16,0)
 D:$D(^XMB(3.9,XMZ,1,"AFAX")) FAX^XMFAX(XMZ)
"RTN","XMKP",17,0)
 Q
"RTN","XMKP",18,0)
SPOST(XMDUZ,XMZ,XMTOCNT,XMINSTR) ;
"RTN","XMKP",19,0)
 N XMTSTAMP,XMPREC
"RTN","XMKP",20,0)
 S XMTSTAMP=$$TSTAMP^XMXUTIL1
"RTN","XMKP",21,0)
 S XMPREC=XMTOCNT
"RTN","XMKP",22,0)
 I $D(^TMP("XMY",$J,XMDUZ)) D
"RTN","XMKP",23,0)
 . S $P(XMPREC,U,2)=$G(XMINSTR("SELF BSKT"),1)
"RTN","XMKP",24,0)
 I $D(^TMP("XMY",$J,.6)) D
"RTN","XMKP",25,0)
 . S $P(XMPREC,U,3,4)=$G(XMINSTR("SHARE BSKT"),1)_U_$G(XMINSTR("SHARE DATE"),$$FMADD^XLFDT(DT,30))
"RTN","XMKP",26,0)
 I $$BRODCAST D
"RTN","XMKP",27,0)
 . S $P(XMPREC,U,1)=$P(^XMB(3.7,0),U,4)
"RTN","XMKP",28,0)
 . S $P(XMPREC,U,5)="*"
"RTN","XMKP",29,0)
 S ^XMBPOST("BOX",XMTSTAMP,"M",XMZ)=XMPREC
"RTN","XMKP",30,0)
 Q
"RTN","XMKP",31,0)
BRODCAST() ;
"RTN","XMKP",32,0)
 Q $D(^TMP("XMY",$J,$$EZBLD^DIALOG(39006))) ; * (Broadcast to all local users)
"RTN","XMKP",33,0)
SRECIP(XMDUZ,XMZ,XMPRI,XMTOCNT) ; "Send" to recipients
"RTN","XMKP",34,0)
 N XMTO,XMFDA,XMIEN,XMIENS,XMPREFIX,XMNOW
"RTN","XMKP",35,0)
 ; Put addressees into RECIPIENT multiple
"RTN","XMKP",36,0)
 S XMTO="",XMTOCNT=0
"RTN","XMKP",37,0)
 F  S XMTO=$O(^TMP("XMY",$J,XMTO)) Q:XMTO=""  D
"RTN","XMKP",38,0)
 . K XMPREFIX,XMIEN
"RTN","XMKP",39,0)
 . D NEW(XMZ,XMPRI,XMTO,$G(^TMP("XMY",$J,XMTO,1)),.XMFDA,.XMIENS)            ; New recipient
"RTN","XMKP",40,0)
 . I $D(^TMP("XMY",$J,XMTO,"F")) D
"RTN","XMKP",41,0)
 . . S:'$D(XMNOW) XMNOW=$$MMDT^XMXUTIL1($P(^XMB(3.9,XMZ,0),U,3))
"RTN","XMKP",42,0)
 . . D RCPTFWD^XMKP1("S",XMTO,.XMFDA,XMIENS,XMNOW)
"RTN","XMKP",43,0)
 . I +XMTO=XMTO S XMTOCNT=XMTOCNT+1
"RTN","XMKP",44,0)
 . E  D STATUS(XMTO,.XMFDA,XMIENS,.XMPREFIX)  ; Transmission Status
"RTN","XMKP",45,0)
 . D UPDATE^DIE("","XMFDA","XMIEN")
"RTN","XMKP",46,0)
 . S XMIENS=XMIEN(1)_","_XMZ_","
"RTN","XMKP",47,0)
 . I ".D.H.S."[("."_$G(XMPREFIX)_".") D OPOST(XMDUZ,XMZ,XMTO,XMIENS,XMPREFIX)
"RTN","XMKP",48,0)
 Q
"RTN","XMKP",49,0)
SADDRTO(XMDUZ,XMZ) ; Put addressees into ADDRESSED TO multiple
"RTN","XMKP",50,0)
 N XMTO
"RTN","XMKP",51,0)
 S XMTO=""
"RTN","XMKP",52,0)
 F  S XMTO=$O(^TMP("XMY0",$J,XMTO)) Q:XMTO=""  D ADDRTO(XMDUZ,XMZ,XMTO)
"RTN","XMKP",53,0)
 Q
"RTN","XMKP",54,0)
ADDRTO(XMDUZ,XMZ,XMTO) ;
"RTN","XMKP",55,0)
 N XMFDA,XMPREFIX,XMMULT
"RTN","XMKP",56,0)
 S XMPREFIX=$G(^TMP("XMY0",$J,XMTO,1))
"RTN","XMKP",57,0)
 I $D(^TMP("XMY0",$J,XMTO,"L")) D
"RTN","XMKP",58,0)
 . I XMTO=XMV("NAME") D  Q
"RTN","XMKP",59,0)
 . . D LTRADD^XMJMD(XMDUZ,XMZ,$G(^TMP("XMY0",$J,XMTO,"L")))
"RTN","XMKP",60,0)
 . . S XMMULT=3.911
"RTN","XMKP",61,0)
 . S XMMULT=3.914
"RTN","XMKP",62,0)
 . S XMFDA(3.914,"?+1,"_XMZ_",",2)=XMDUZ
"RTN","XMKP",63,0)
 . S XMFDA(3.914,"?+1,"_XMZ_",",3)=XMV("NAME")_$S(XMDUZ=DUZ:"",1:$$EZBLD^DIALOG(38008,XMV("DUZ NAME"))) ; " (Surrogate: _x_)"
"RTN","XMKP",64,0)
 . S XMFDA(3.914,"?+1,"_XMZ_",",4)=^TMP("XMY0",$J,XMTO,"L")
"RTN","XMKP",65,0)
 E  S XMMULT=3.911
"RTN","XMKP",66,0)
 S XMFDA(XMMULT,"?+1,"_XMZ_",",.01)=XMTO
"RTN","XMKP",67,0)
 S:XMPREFIX'="" XMFDA(XMMULT,"?+1,"_XMZ_",",1)=XMPREFIX
"RTN","XMKP",68,0)
 D UPDATE^DIE("","XMFDA")
"RTN","XMKP",69,0)
 Q
"RTN","XMKP",70,0)
NEW(XMZ,XMPRI,XMTO,XMTYPE,XMFDA,XMIENS) ;
"RTN","XMKP",71,0)
 S XMIENS="+1,"_XMZ_","
"RTN","XMKP",72,0)
 S XMFDA(3.91,XMIENS,.01)=XMTO
"RTN","XMKP",73,0)
 ; If addressee is also the creator of the msg, then I: or C: does not
"RTN","XMKP",74,0)
 ; apply.
"RTN","XMKP",75,0)
 I $G(XMTYPE)'="" S XMFDA(3.91,XMIENS,6.5)=XMTYPE
"RTN","XMKP",76,0)
 I XMPRI,XMTO=+XMTO,$P($G(^XMB(3.7,XMTO,0)),U,11) S XMFDA(3.91,XMIENS,10)=$P(^(0),U,11)   ; Priority response flag
"RTN","XMKP",77,0)
 Q
"RTN","XMKP",78,0)
STATUS(XMTO,XMFDA,XMIENS,XMPREFIX) ;
"RTN","XMKP",79,0)
 I $E(XMTO,1,2)="F.",$P(^XMB(1,1,0),U,19),$D(^AKF("FAXR")),$E(XMTO,3,99)=$P($G(^AKF("FAXR",^TMP("XMY",$J,XMTO),0)),U) D  Q
"RTN","XMKP",80,0)
 . S XMFDA(3.91,XMIENS,5)=$$EZBLD^DIALOG(39303.5) ; Awaiting Fax.
"RTN","XMKP",81,0)
 . S XMFDA(3.91,XMIENS,13)=^TMP("XMY",$J,XMTO)
"RTN","XMKP",82,0)
 I XMTO["@" D  Q
"RTN","XMKP",83,0)
 . S XMFDA(3.91,XMIENS,5)=$$EZBLD^DIALOG(39303.1) ; Awaiting transmission.
"RTN","XMKP",84,0)
 . S XMFDA(3.91,XMIENS,6)=^TMP("XMY",$J,XMTO) ; sets x-ref "AQUEUE"
"RTN","XMKP",85,0)
 I $E(XMTO,2,2)="." D
"RTN","XMKP",86,0)
 . S XMPREFIX=$E(XMTO,1,1) ; We know it is upper case
"RTN","XMKP",87,0)
 . Q:"SDH"'[XMPREFIX
"RTN","XMKP",88,0)
 . S XMFDA(3.91,XMIENS,5)=$$EZBLD^DIALOG($S(XMPREFIX="S":39303.2,XMPREFIX="D":39303.3,1:39303.4)) ; "Awaiting Server."/"Awaiting Device."/"Awaiting H.Device."
"RTN","XMKP",89,0)
 Q
"RTN","XMKP",90,0)
OPOST(XMDUZ,XMZ,XMTO,XMIENS,XMPREFIX) ;
"RTN","XMKP",91,0)
 I XMPREFIX="S" D SERVER^XMKPO(XMZ,XMTO,XMIENS) Q
"RTN","XMKP",92,0)
 I XMPREFIX="D" D DEVICE^XMKPO(XMDUZ,XMZ,XMTO,XMIENS,1) Q
"RTN","XMKP",93,0)
 I XMPREFIX="H" D DEVICE^XMKPO(XMDUZ,XMZ,XMTO,XMIENS,0) Q  ; Headerless
"RTN","XMKP",94,0)
 Q
"RTN","XMKP",95,0)
FWD(XMDUZ,XMZ,XMINSTR) ;
"RTN","XMKP",96,0)
 ; XMFWDTYP      fwding person recipient type:  I:, CC:
"RTN","XMKP",97,0)
 ; XMPRI         1=msg is priority msg; 0=not
"RTN","XMKP",98,0)
 ; XMINSTR("SHARE DATE")  Delete date for mail addressed to SHARED,MAIL
"RTN","XMKP",99,0)
 ; XMINSTR("SHARE BSKT")  Basket for mail addressed to SHARED,MAIL
"RTN","XMKP",100,0)
 ; XMINSTR("FWD BY")  String to replace standard 'Forwarded by'
"RTN","XMKP",101,0)
 ; XMTOLIST      Array of local recipients
"RTN","XMKP",102,0)
 ; XMTOCNT       Number of valid recipients
"RTN","XMKP",103,0)
 N XMTOLIST,XMPRI,XMFWDTYP,XMIEN,XMREMOTE,XMINST
"RTN","XMKP",104,0)
 S XMIEN=$O(^XMB(3.9,XMZ,1,"C",XMDUZ,0)) ; May have been fwd'd by a remote person
"RTN","XMKP",105,0)
 S XMFWDTYP=$S('XMIEN:"",1:$P($G(^XMB(3.9,XMZ,1,XMIEN,"T")),U))
"RTN","XMKP",106,0)
 S XMPRI=($P(^XMB(3.9,XMZ,0),U,7)["P")
"RTN","XMKP",107,0)
 D FADDRTO(XMDUZ,XMZ) ; Populate ADDRESSED TO multiple
"RTN","XMKP",108,0)
 D FRECIP(XMDUZ,XMZ,.XMINSTR,XMFWDTYP,XMPRI,.XMTOLIST,.XMREMOTE)
"RTN","XMKP",109,0)
 D:XMTOLIST(1)'=""!$$BRODCAST FPOST(XMDUZ,XMZ,.XMTOLIST,.XMINSTR)
"RTN","XMKP",110,0)
 S XMINST=""
"RTN","XMKP",111,0)
 F  S XMINST=$O(XMREMOTE(XMINST)) Q:'XMINST  D
"RTN","XMKP",112,0)
 . D REMOTE^XMKPR(XMZ,XMINST)
"RTN","XMKP",113,0)
 D:$D(^XMB(3.9,XMZ,1,"AFAX")) FAX^XMFAX(XMZ)
"RTN","XMKP",114,0)
 Q
"RTN","XMKP",115,0)
FADDRTO(XMDUZ,XMZ) ; Put addressees into ADDRESSED TO multiple
"RTN","XMKP",116,0)
 N XMTO
"RTN","XMKP",117,0)
 S XMTO=""
"RTN","XMKP",118,0)
 F  S XMTO=$O(^TMP("XMY0",$J,XMTO)) Q:XMTO=""  D
"RTN","XMKP",119,0)
 . I '$$FIND1^DIC(3.911,","_XMZ_",","QX",XMTO,"B") D  Q
"RTN","XMKP",120,0)
 . . D ADDRTO(XMDUZ,XMZ,XMTO)
"RTN","XMKP",121,0)
 . Q:'$D(^TMP("XMY0",$J,XMTO,"L"))
"RTN","XMKP",122,0)
 . I XMTO=XMV("NAME") D  Q
"RTN","XMKP",123,0)
 . . D LTRADD^XMJMD(XMDUZ,XMZ,$G(^TMP("XMY0",$J,XMTO,"L")))
"RTN","XMKP",124,0)
 . N XMFDA,XMIENS
"RTN","XMKP",125,0)
 . S XMIENS="?+1,"_XMZ_","
"RTN","XMKP",126,0)
 . S XMFDA(3.914,XMIENS,.01)=XMTO
"RTN","XMKP",127,0)
 . ; we ignore any 'prefix' because these addressees are already on the msg
"RTN","XMKP",128,0)
 . S XMFDA(3.914,XMIENS,2)=XMDUZ
"RTN","XMKP",129,0)
 . S XMFDA(3.914,XMIENS,3)=XMV("NAME")_$S(XMDUZ=DUZ:"",1:$$EZBLD^DIALOG(38008,XMV("DUZ NAME"))) ; " (Surrogate: _x_)"
"RTN","XMKP",130,0)
 . S XMFDA(3.914,XMIENS,4)=^TMP("XMY0",$J,XMTO,"L")
"RTN","XMKP",131,0)
 . D UPDATE^DIE("","XMFDA")
"RTN","XMKP",132,0)
 Q
"RTN","XMKP",133,0)
FPOST(XMDUZ,XMZ,XMTOLIST,XMINSTR) ; For local delivery
"RTN","XMKP",134,0)
 N XMTSTAMP,XMTOCNT,I,XMUID,XMPREC
"RTN","XMKP",135,0)
 S XMTSTAMP=$$TSTAMP^XMXUTIL1
"RTN","XMKP",136,0)
 I $D(^TMP("XMY",$J,XMDUZ)) D
"RTN","XMKP",137,0)
 . S $P(XMPREC,U,2)=$G(XMINSTR("SELF BSKT"),1)
"RTN","XMKP",138,0)
 I $D(^TMP("XMY",$J,.6)) D
"RTN","XMKP",139,0)
 . S $P(XMPREC,U,3,4)=$G(XMINSTR("SHARE BSKT"),1)_U_$G(XMINSTR("SHARE DATE"),$$FMADD^XLFDT(DT,30))
"RTN","XMKP",140,0)
 S XMUID=XMZ_U_$S(XMDUZ=.6:DUZ,1:XMDUZ)_U_$J
"RTN","XMKP",141,0)
 I $$BRODCAST D
"RTN","XMKP",142,0)
 . S $P(XMPREC,U,1)=$P(^XMB(3.7,0),U,4)
"RTN","XMKP",143,0)
 . S $P(XMPREC,U,5)="*"
"RTN","XMKP",144,0)
 . I $P(^XMB(3.9,XMZ,0),U,12)'="y" S $P(^(0),U,12)="y" ; If not info only, make it so.
"RTN","XMKP",145,0)
 E  D
"RTN","XMKP",146,0)
 . S (I,XMTOCNT)=0
"RTN","XMKP",147,0)
 . F  S I=$O(XMTOLIST(I)) Q:I=""  D
"RTN","XMKP",148,0)
 . . S XMTOCNT=XMTOCNT+$L(XMTOLIST(I),U)-1
"RTN","XMKP",149,0)
 . . S ^XMBPOST("FWD",XMUID_U_XMTSTAMP,I)=$P(XMTOLIST(I),U,2,999)
"RTN","XMKP",150,0)
 . S $P(XMPREC,U,1)=XMTOCNT
"RTN","XMKP",151,0)
 S ^XMBPOST("BOX",XMTSTAMP,"M",XMUID)=XMPREC
"RTN","XMKP",152,0)
 Q
"RTN","XMKP",153,0)
FRECIP(XMDUZ,XMZ,XMINSTR,XMFWDTYP,XMPRI,XMTOLIST,XMREMOTE) ; "Forward" to recipients
"RTN","XMKP",154,0)
 ; XMFWDBY  Forwarded by:  name (surrogate)
"RTN","XMKP",155,0)
 N XMTO,XMX,XMIEN,XMFDA,XMIENS,XMPREFIX,XMFWDBY,XMNOW
"RTN","XMKP",156,0)
 S XMNOW=$$MMDT^XMXUTIL1($$NOW^XLFDT)
"RTN","XMKP",157,0)
 S XMFWDBY=$S($D(XMINSTR("FWD BY")):XMINSTR("FWD BY"),1:XMV("NAME")_$S(XMDUZ=DUZ:"",1:$$EZBLD^DIALOG(38008,XMV("DUZ NAME")))) ; " (Surrogate: _x_)"
"RTN","XMKP",158,0)
 ; Put addressees into RECIPIENT multiple
"RTN","XMKP",159,0)
 S XMTO="",XMX=1,XMTOLIST(XMX)=""
"RTN","XMKP",160,0)
 F  S XMTO=$O(^TMP("XMY",$J,XMTO)) Q:XMTO=""  D
"RTN","XMKP",161,0)
 . K XMPREFIX
"RTN","XMKP",162,0)
 . I +XMTO=XMTO D
"RTN","XMKP",163,0)
 . . S XMIEN=$O(^XMB(3.9,XMZ,1,"C",XMTO,0))
"RTN","XMKP",164,0)
 . E  S XMIEN=$$FIND1^DIC(3.91,","_XMZ_",",$S(XMTO["@":"O",1:"QX"),XMTO,"C")
"RTN","XMKP",165,0)
 . I +XMIEN=0 D  ; New recipient
"RTN","XMKP",166,0)
 . . N XMTYPE
"RTN","XMKP",167,0)
 . . ; If you are an info only recipient, then so is anyone you fwd to.
"RTN","XMKP",168,0)
 . . S XMTYPE=$S(XMFWDTYP'="":XMFWDTYP,1:$G(^TMP("XMY",$J,XMTO,1)))
"RTN","XMKP",169,0)
 . . D NEW(XMZ,XMPRI,XMTO,XMTYPE,.XMFDA,.XMIENS) ; New recipient
"RTN","XMKP",170,0)
 . E  D
"RTN","XMKP",171,0)
 . . S XMIENS=XMIEN_","_XMZ_","
"RTN","XMKP",172,0)
 . . S:$G(^XMB(3.9,XMZ,1,XMIEN,"D")) XMFDA(3.91,XMIENS,7)="@" ; Unterminate
"RTN","XMKP",173,0)
 . I +XMTO'=XMTO D
"RTN","XMKP",174,0)
 . . D STATUS(XMTO,.XMFDA,XMIENS,.XMPREFIX) ; Transmission Status
"RTN","XMKP",175,0)
 . . S:$D(XMFDA(3.91,XMIENS,6)) XMREMOTE(XMFDA(3.91,XMIENS,6))=""
"RTN","XMKP",176,0)
 . I $D(^TMP("XMY",$J,XMTO,"F")) D
"RTN","XMKP",177,0)
 . . D RCPTFWD^XMKP1("F",XMTO,.XMFDA,XMIENS,XMNOW,XMFWDBY)
"RTN","XMKP",178,0)
 . E  D
"RTN","XMKP",179,0)
 . . S XMFDA(3.91,XMIENS,8)=XMFWDBY_" "_XMNOW ; fwd by name date time
"RTN","XMKP",180,0)
 . . I '$D(XMINSTR("FWD BY"))!$D(XMINSTR("FWD BY XMDUZ")) S XMFDA(3.91,XMIENS,8.01)=XMDUZ  ; fwd by duz
"RTN","XMKP",181,0)
 . I '$D(XMFDA(3.91,XMIENS,8.02)) D  ; Filter-Forward or Regular-Forward
"RTN","XMKP",182,0)
 . . S XMFDA(3.91,XMIENS,8.02)=$S($G(XMINSTR("FWD BY XMDUZ"))="F":"F",1:"@")
"RTN","XMKP",183,0)
 . I XMIEN D
"RTN","XMKP",184,0)
 . . I '$D(XMFDA(3.91,XMIENS,8.03)) D
"RTN","XMKP",185,0)
 . . . S XMFDA(3.91,XMIENS,8.03)="@"
"RTN","XMKP",186,0)
 . . . S XMFDA(3.91,XMIENS,8.04)="@"
"RTN","XMKP",187,0)
 . . D FILE^DIE("","XMFDA")
"RTN","XMKP",188,0)
 . E  D
"RTN","XMKP",189,0)
 . . K XMIEN
"RTN","XMKP",190,0)
 . . D UPDATE^DIE("","XMFDA","XMIEN")
"RTN","XMKP",191,0)
 . . S XMIENS=XMIEN(1)_","_XMZ_","
"RTN","XMKP",192,0)
 . D:"^D^H^S^"[(U_$G(XMPREFIX)_U) OPOST(XMDUZ,XMZ,XMTO,XMIENS,XMPREFIX)
"RTN","XMKP",193,0)
 . Q:+XMTO'=XMTO  ; Quit if addressee not local
"RTN","XMKP",194,0)
 . I $L(XMTOLIST(XMX))+$L(XMTO)>244 S XMX=XMX+1,XMTOLIST(XMX)=""
"RTN","XMKP",195,0)
 . S XMTOLIST(XMX)=XMTOLIST(XMX)_U_XMTO
"RTN","XMKP",196,0)
 Q
"RTN","XMKP",197,0)
RPOST(XMDUZ,XMZ,XMZR) ;
"RTN","XMKP",198,0)
 N XMFDA
"RTN","XMKP",199,0)
RADD ; Add response to response multiple in original msg
"RTN","XMKP",200,0)
 S XMFDA(3.9001,"+1,"_XMZ_",",.01)=XMZR
"RTN","XMKP",201,0)
 D UPDATE^DIE("","XMFDA")
"RTN","XMKP",202,0)
 I $D(DIERR),$P(^XMB(3.9,XMZ,0),U,1)="" D  G RADD
"RTN","XMKP",203,0)
 . S $P(^XMB(3.9,XMZ,0),U,1)=$$EZBLD^DIALOG(34012) ; * No Subject *
"RTN","XMKP",204,0)
 . S ^XMB(3.9,"B",$$EZBLD^DIALOG(34012),XMZ)=""
"RTN","XMKP",205,0)
 ; Now put the message in the post box to be delivered.
"RTN","XMKP",206,0)
 ; (If this is not a locally generated reply, then XMDUZ is "NR".)
"RTN","XMKP",207,0)
 S ^XMBPOST("BOX",$$TSTAMP^XMXUTIL1,"R",XMZ_U_XMZR)=$P(^XMB(3.9,XMZ,1,0),U,4)_U_$S(XMDUZ=.6:DUZ,1:XMDUZ)
"RTN","XMKP",208,0)
 Q
"RTN","XMKP1")
0^230^B2528182
"RTN","XMKP1",1,0)
XMKP1 ;ISC-SF/GMB-Address and Post msg (cont.) ;04/17/2002  10:54
"RTN","XMKP1",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMKP1",3,0)
RCPTFWD(XMSF,XMTO,XMFDA,XMIENS,XMNOW,XMFWDBY) ; Someone special fwded to this particular recipient
"RTN","XMKP1",4,0)
 N XMBY,XMFREC
"RTN","XMKP1",5,0)
 S XMFREC=^TMP("XMY",$J,XMTO,"F")
"RTN","XMKP1",6,0)
 S XMBY=$P(XMFREC,U)
"RTN","XMKP1",7,0)
 I +XMBY=XMBY D
"RTN","XMKP1",8,0)
 . ; Recipient has fwding address; note that recipient fwded.
"RTN","XMKP1",9,0)
 . S XMFDA(3.91,XMIENS,8)=$$NAME^XMXUTIL(XMBY)_" "_XMNOW   ; fwd by name date time
"RTN","XMKP1",10,0)
 . S XMFDA(3.91,XMIENS,8.01)=XMBY ; fwd by duz
"RTN","XMKP1",11,0)
 . S XMFDA(3.91,XMIENS,8.02)="A"  ; Auto-Forward
"RTN","XMKP1",12,0)
 . Q:XMSF="S"
"RTN","XMKP1",13,0)
 . I $P(XMFREC,U,2)'="" D  Q  ; original forwarder is from remote site
"RTN","XMKP1",14,0)
 . . S XMFDA(3.91,XMIENS,8.03)=$P(XMFREC,U,2)
"RTN","XMKP1",15,0)
 . . S XMFDA(3.91,XMIENS,8.04)="@"
"RTN","XMKP1",16,0)
 . S XMFDA(3.91,XMIENS,8.03)=XMFWDBY
"RTN","XMKP1",17,0)
 . S XMFDA(3.91,XMIENS,8.04)=$S($G(XMINSTR("FWD BY XMDUZ"))="F":"F",1:"@") ; Filter-Forward or otherwise
"RTN","XMKP1",18,0)
 E  D
"RTN","XMKP1",19,0)
 . ; Forwarded from remote site.
"RTN","XMKP1",20,0)
 . S XMFDA(3.91,XMIENS,8)=XMBY_" "_XMNOW   ; fwd by name date time
"RTN","XMKP1",21,0)
 . S XMFDA(3.91,XMIENS,8.01)="@" ; fwd by duz
"RTN","XMKP1",22,0)
 Q
"RTN","XMKPL")
0^308^B6248412
"RTN","XMKPL",1,0)
XMKPL ;ISC-SF/GMB-Manage the local mail posting process ;04/17/2002  10:54
"RTN","XMKPL",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMKPL",3,0)
 ; Replaces ^XMADGO1,^XMADGO (ISC-WASH/CAP)
"RTN","XMKPL",4,0)
 ; Entry points (not covered by DBIA):
"RTN","XMKPL",5,0)
 ; CHECK   Check the local processes.
"RTN","XMKPL",6,0)
 ;         If they haven't been deliberately STOP'd,
"RTN","XMKPL",7,0)
 ;         and if they are not running,
"RTN","XMKPL",8,0)
 ;         then task them.
"RTN","XMKPL",9,0)
 ; STATUS  Get status of local processes.
"RTN","XMKPL",10,0)
 ;
"RTN","XMKPL",11,0)
 ; Entry points used by MailMan options (not covered by DBIA):
"RTN","XMKPL",12,0)
 ; STOP    XMMGR-STOP-BACKGROUND-FILER  - Stop the local processes.
"RTN","XMKPL",13,0)
 ; START   XMMGR-START-BACKGROUND-FILER - Start the local processes.
"RTN","XMKPL",14,0)
 ;
"RTN","XMKPL",15,0)
CHECK ; Task Background Filer processes if any missing
"RTN","XMKPL",16,0)
 Q:$P(^XMB(1,1,0),U,16)  ; Quit if 'background filer stop flag' set.
"RTN","XMKPL",17,0)
 N XMPROC,XMSTATUS
"RTN","XMKPL",18,0)
 D STATUS(.XMSTATUS)
"RTN","XMKPL",19,0)
 Q:'$D(XMSTATUS)
"RTN","XMKPL",20,0)
 S XMPROC=""
"RTN","XMKPL",21,0)
 F  S XMPROC=$O(XMSTATUS(XMPROC)) Q:XMPROC=""  D QUEUE(XMPROC)
"RTN","XMKPL",22,0)
 Q
"RTN","XMKPL",23,0)
STATUS(XMSTATUS) ;Check status of background filer
"RTN","XMKPL",24,0)
 N XMPROC,XMLOCK
"RTN","XMKPL",25,0)
 F XMPROC="Mover","Tickler" D
"RTN","XMKPL",26,0)
 . S XMLOCK="POST_"_XMPROC
"RTN","XMKPL",27,0)
 . L +^XMBPOST(XMLOCK):0 E  Q
"RTN","XMKPL",28,0)
 . S XMSTATUS(XMPROC)=$$EZBLD^DIALOG($S(XMPROC="Mover":36224.1,1:36224.2)) ; The Mover/Tickler is not running!
"RTN","XMKPL",29,0)
 . L -^XMBPOST(XMLOCK)
"RTN","XMKPL",30,0)
 Q
"RTN","XMKPL",31,0)
QUEUE(XMPROC) ;Start Queue processors
"RTN","XMKPL",32,0)
 N XMHANG,ZTRTN,ZTDESC,ZTSAVE,X,ZTSK,ZTQUEUED,ZTCPU,ZTDTH,ZTIO
"RTN","XMKPL",33,0)
 S XMHANG=$$HANG
"RTN","XMKPL",34,0)
 S ZTDESC=$$EZBLD^DIALOG($S(XMPROC="Mover":36227,1:36228)) ; MailMan: Background Filer (Mover/Tickler)
"RTN","XMKPL",35,0)
 S ZTSAVE("XMHANG")=""
"RTN","XMKPL",36,0)
 S ZTRTN=$S(XMPROC="Mover":"GO^XMKPLQ",1:"GO^XMTDT")
"RTN","XMKPL",37,0)
 I $D(^XMB(1,1,0)) S X=$P(^(0),U,12) I X'="" S ZTCPU=$P(X,",",2)
"RTN","XMKPL",38,0)
 S ZTIO="",ZTDTH=$H
"RTN","XMKPL",39,0)
 D ^%ZTLOAD
"RTN","XMKPL",40,0)
 Q
"RTN","XMKPL",41,0)
HANG() ; Get Hangtime for delivery modules
"RTN","XMKPL",42,0)
 N X
"RTN","XMKPL",43,0)
 S X=$P($G(^XMB(1,1,0)),U,13)
"RTN","XMKPL",44,0)
 Q $S(X:X,1:5)
"RTN","XMKPL",45,0)
STOP ; Stop Background mail delivery processes
"RTN","XMKPL",46,0)
 N DIR,Y,DIRUT
"RTN","XMKPL",47,0)
 S DIR(0)="Y"
"RTN","XMKPL",48,0)
 D BLD^DIALOG(36229,"","","DIR(""A"")")
"RTN","XMKPL",49,0)
 ;Are you sure you want the Background Filers to stop delivering mail
"RTN","XMKPL",50,0)
 S DIR("B")=$$EZBLD^DIALOG(39053) ; No
"RTN","XMKPL",51,0)
 D ^DIR Q:'Y
"RTN","XMKPL",52,0)
 S $P(^XMB(1,1,0),U,16)=1  ; Set 'background filer stop flag'
"RTN","XMKPL",53,0)
 W:'$D(ZTQUEUED) !!,$C(7),$$EZBLD^DIALOG(36229.1) ; << Background Filers will stop soon. >>
"RTN","XMKPL",54,0)
 Q
"RTN","XMKPL",55,0)
START ; Start the local processes (usually after they had been STOP'd).
"RTN","XMKPL",56,0)
 S $P(^XMB(1,1,0),U,16)=""  ; Reset 'background filer stop flag'
"RTN","XMKPL",57,0)
 D CHECK
"RTN","XMKPL",58,0)
 W:'$D(ZTQUEUED) !!,$C(7),$$EZBLD^DIALOG(36229.2) ; << Background Filers will start soon. >>
"RTN","XMKPL",59,0)
 Q
"RTN","XMKPLQ")
0^309^B15760272
"RTN","XMKPLQ",1,0)
XMKPLQ ;ISC-SF/GMB-Post local msgs to correct queues ;07/28/2000  14:34
"RTN","XMKPLQ",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMKPLQ",3,0)
 ; Replaces ^XMADJF0, ZTSK^XMADGO (ISC-WASH/CAP)
"RTN","XMKPLQ",4,0)
GO ;
"RTN","XMKPLQ",5,0)
 ; Variables provided through TASKMAN:  XMHANG
"RTN","XMKPLQ",6,0)
 N XMACTIVE,XMUID,XMQLIST,XMTSTAMP,XMGROUP,XMCNT,XMQUEUE,XMREC
"RTN","XMKPLQ",7,0)
 I $D(ZTQUEUED) S ZTREQ="@"
"RTN","XMKPLQ",8,0)
 L +^XMBPOST("POST_Mover"):1 E  Q
"RTN","XMKPLQ",9,0)
 I $D(ZTQUEUED) S %=$$PSET^%ZTLOAD(ZTSK)
"RTN","XMKPLQ",10,0)
 S XMACTIVE=$$TSTAMP^XMXUTIL1
"RTN","XMKPLQ",11,0)
 F  D  Q:$P($G(^XMB(1,1,0)),U,16)
"RTN","XMKPLQ",12,0)
 . D GETQ(.XMQLIST) ; Get new parameters for grouping
"RTN","XMKPLQ",13,0)
 . S XMTSTAMP=""
"RTN","XMKPLQ",14,0)
 . F  S XMTSTAMP=$O(^XMBPOST("BOX",XMTSTAMP)) Q:XMTSTAMP=""  D  Q:$$TSTAMP^XMXUTIL1-XMACTIVE>30
"RTN","XMKPLQ",15,0)
 . . S XMGROUP=""
"RTN","XMKPLQ",16,0)
 . . F  S XMGROUP=$O(^XMBPOST("BOX",XMTSTAMP,XMGROUP)) Q:XMGROUP=""  D
"RTN","XMKPLQ",17,0)
 . . . S XMUID=0
"RTN","XMKPLQ",18,0)
 . . . F  S XMUID=$O(^XMBPOST("BOX",XMTSTAMP,XMGROUP,XMUID)) Q:XMUID=""  S XMREC=^(XMUID)  D
"RTN","XMKPLQ",19,0)
 . . . . S XMCNT=+XMREC
"RTN","XMKPLQ",20,0)
 . . . . S XMQUEUE=$$WHICHQ(XMQLIST(XMGROUP),XMCNT)
"RTN","XMKPLQ",21,0)
 . . . . I XMGROUP="M" D
"RTN","XMKPLQ",22,0)
 . . . . . D MQUEUE(XMTSTAMP,XMUID,XMQUEUE,XMREC)
"RTN","XMKPLQ",23,0)
 . . . . E  D
"RTN","XMKPLQ",24,0)
 . . . . . D RQUEUE(XMTSTAMP,XMUID,XMQUEUE,XMREC)
"RTN","XMKPLQ",25,0)
 . . . . D STATS(XMGROUP,XMQUEUE,XMCNT)
"RTN","XMKPLQ",26,0)
 . . . . K ^XMBPOST("BOX",XMTSTAMP,XMGROUP,XMUID)
"RTN","XMKPLQ",27,0)
 . I $$TSTAMP^XMXUTIL1-XMACTIVE>30 D  Q
"RTN","XMKPLQ",28,0)
 . . D ZTSK
"RTN","XMKPLQ",29,0)
 . . S XMACTIVE=$$TSTAMP^XMXUTIL1
"RTN","XMKPLQ",30,0)
 . H XMHANG
"RTN","XMKPLQ",31,0)
 L -^XMBPOST("POST_Mover")
"RTN","XMKPLQ",32,0)
 I $D(ZTQUEUED) D PCLEAR^%ZTLOAD(ZTSK)
"RTN","XMKPLQ",33,0)
 Q
"RTN","XMKPLQ",34,0)
GETQ(XMQLIST) ;
"RTN","XMKPLQ",35,0)
 N X
"RTN","XMKPLQ",36,0)
 S X=$G(^XMB(1,1,6))
"RTN","XMKPLQ",37,0)
 S XMQLIST("M")=$P(X,U),XMQLIST("R")=$P(X,U,2)
"RTN","XMKPLQ",38,0)
 Q
"RTN","XMKPLQ",39,0)
WHICHQ(XMQLIST,XMCNT) ;
"RTN","XMKPLQ",40,0)
 N XMQUEUE,XMQLEN
"RTN","XMKPLQ",41,0)
 I XMQLIST'["," Q 1
"RTN","XMKPLQ",42,0)
 S XMQLEN=$L(XMQLIST,",")
"RTN","XMKPLQ",43,0)
 F XMQUEUE=1:1:$L(XMQLIST,",") Q:XMCNT<$P(XMQLIST,",",XMQUEUE)
"RTN","XMKPLQ",44,0)
 Q $S(XMCNT<$P(XMQLIST,",",XMQUEUE):XMQUEUE,1:XMQUEUE+1)
"RTN","XMKPLQ",45,0)
RQUEUE(XMTSTAMP,XMUID,XMQUEUE,XMREC) ; Put replies into queue
"RTN","XMKPLQ",46,0)
 N XMZ,XMTSQ
"RTN","XMKPLQ",47,0)
 ;If the response is already in the queue, find out its Timestamp
"RTN","XMKPLQ",48,0)
 ;and file the new response right next to it.
"RTN","XMKPLQ",49,0)
 S XMZ=$P(XMUID,U,1)
"RTN","XMKPLQ",50,0)
 S XMTSQ=$O(^XMBPOST("R",XMQUEUE,"B",XMZ,0))
"RTN","XMKPLQ",51,0)
 I XMTSQ S XMTSTAMP=XMTSQ
"RTN","XMKPLQ",52,0)
 E  S ^XMBPOST("R",XMQUEUE,"B",XMZ,XMTSTAMP)=""
"RTN","XMKPLQ",53,0)
 S ^XMBPOST("R",XMQUEUE,XMTSTAMP,XMZ,$P(XMUID,U,2))=XMREC
"RTN","XMKPLQ",54,0)
 Q
"RTN","XMKPLQ",55,0)
MQUEUE(XMTSTAMP,XMUID,XMQUEUE,XMREC) ; Put new & forwarded messages into queue
"RTN","XMKPLQ",56,0)
 S ^XMBPOST("M",XMQUEUE,XMTSTAMP,XMUID)=XMREC
"RTN","XMKPLQ",57,0)
 Q
"RTN","XMKPLQ",58,0)
STATS(XMGROUP,XMQUEUE,XMCNT) ;
"RTN","XMKPLQ",59,0)
 N XMSTATS
"RTN","XMKPLQ",60,0)
 L +^XMBPOST("QSTATS",XMGROUP,XMQUEUE)
"RTN","XMKPLQ",61,0)
 S XMSTATS=$G(^XMBPOST(XMGROUP,XMQUEUE)),^(XMQUEUE)=($P(XMSTATS,U,1)+1)_U_($P(XMSTATS,U,2)+XMCNT)
"RTN","XMKPLQ",62,0)
 L -^XMBPOST("QSTATS",XMGROUP,XMQUEUE)
"RTN","XMKPLQ",63,0)
 Q
"RTN","XMKPLQ",64,0)
ZTSK ; START Delivery Background Processes
"RTN","XMKPLQ",65,0)
 Q:$P(^XMB(1,1,0),U,16)  ;Quit if Background Filer Stop Flag
"RTN","XMKPLQ",66,0)
 N XMGROUP,XMQUEUE,ZTRTN,ZTSAVE,ZTDESC
"RTN","XMKPLQ",67,0)
 F XMGROUP="M","R" D  ; Check each queue for messages
"RTN","XMKPLQ",68,0)
 . S XMQUEUE=""
"RTN","XMKPLQ",69,0)
 . F  S XMQUEUE=$O(^XMBPOST(XMGROUP,XMQUEUE)) Q:XMQUEUE'>0  D
"RTN","XMKPLQ",70,0)
 . . Q:$D(^XMBPOST(XMGROUP,XMQUEUE))<10  ; Quit if nothing in queue
"RTN","XMKPLQ",71,0)
 . . L +^XMBPOST(XMGROUP,XMQUEUE):1 E  Q  ; If node locked, there is already one running
"RTN","XMKPLQ",72,0)
 . . S (ZTSAVE("XMGROUP"),ZTSAVE("XMQUEUE"),ZTSAVE("XMHANG"))=""
"RTN","XMKPLQ",73,0)
 . . S ZTDESC=$$EZBLD^DIALOG($S(XMGROUP="M":36230,1:36231),XMQUEUE) ; MailMan: Message/Response Delivery Queue |1|
"RTN","XMKPLQ",74,0)
 . . S ZTRTN="GO^XMTDL"
"RTN","XMKPLQ",75,0)
 . . D TASKIT(ZTRTN,ZTDESC,.ZTSAVE) H 0 ; Start a job, Give TaskMan a chance to start it (hang)
"RTN","XMKPLQ",76,0)
 . . L -^XMBPOST(XMGROUP,XMQUEUE)
"RTN","XMKPLQ",77,0)
 Q
"RTN","XMKPLQ",78,0)
TASKIT(ZTRTN,ZTDESC,ZTSAVE) ;
"RTN","XMKPLQ",79,0)
 N X,ZTSK,ZTQUEUED,ZTCPU,ZTDTH,ZTIO
"RTN","XMKPLQ",80,0)
 I '$D(ZTCPU),$D(^XMB(1,1,0)) S X=$P(^(0),U,12) I X'="" S ZTCPU=$P(X,",",2)
"RTN","XMKPLQ",81,0)
 S ZTIO="",ZTDTH=$H
"RTN","XMKPLQ",82,0)
 D ^%ZTLOAD
"RTN","XMKPLQ",83,0)
 Q
"RTN","XMKPLQ",84,0)
JOB ;Start background filer when TaskMan can't
"RTN","XMKPLQ",85,0)
JOBGO S IO="",IO(0)="" D DT^DICRW G GO^XMTDL
"RTN","XMKPLQ",86,0)
 Q
"RTN","XMKPLQ",87,0)
CHKQ ; Input transform for file 4.3, fields 241 and 242
"RTN","XMKPLQ",88,0)
 K:$L(X)>120!($L(X)<1) X Q:'$D(X)
"RTN","XMKPLQ",89,0)
 K:X'?1.N.9(1","1.N) X Q:'$D(X)
"RTN","XMKPLQ",90,0)
 N I
"RTN","XMKPLQ",91,0)
 F I=1:1:$L(X,",")-1 I $P(X,",",I)'<$P(X,",",I+1) K X Q
"RTN","XMKPLQ",92,0)
 Q
"RTN","XMKPLQ",93,0)
HELPQ ; Executable help for file 4.3, fields 241 and 242
"RTN","XMKPLQ",94,0)
 ;You determine the number of delivery queues (10 max.) ...
"RTN","XMKPLQ",95,0)
 N XMTEXT
"RTN","XMKPLQ",96,0)
 D BLD^DIALOG(36232,"","","XMTEXT","F")
"RTN","XMKPLQ",97,0)
 D MSG^DIALOG("WM","",79,"","XMTEXT")
"RTN","XMKPLQ",98,0)
 Q
"RTN","XMKPO")
0^41^B4343165
"RTN","XMKPO",1,0)
XMKPO ;ISC-SF/GMB-Post, other ;04/11/2002  07:08
"RTN","XMKPO",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMKPO",3,0)
 ; Replaces ^XMBPOST and the first part of ^XMS1 (ISC-WASH/THM/RWF/CAP)
"RTN","XMKPO",4,0)
 ; Schedule a task to deliver bulletin, server, device
"RTN","XMKPO",5,0)
DEVICE(XMDUZ,XMZ,XMDEVICE,XMDVIENS,XMPRTHDR) ; For D.Device or H.Device
"RTN","XMKPO",6,0)
 N I,ZTRTN,ZTDESC,ZTSAVE,ZTDTH,ZTSK,ZTIO
"RTN","XMKPO",7,0)
 F I="XMDUZ","XMZ","XMDVIENS","XMPRTHDR" S ZTSAVE(I)=""
"RTN","XMKPO",8,0)
 S ZTIO=$P(XMDEVICE,".",2,99)
"RTN","XMKPO",9,0)
 S ZTDTH=$H
"RTN","XMKPO",10,0)
 S ZTRTN="DEVICE^XMTDO"
"RTN","XMKPO",11,0)
 S ZTDESC=$$EZBLD^DIALOG(42001,XMDEVICE) ; MailMan: To Device |1|
"RTN","XMKPO",12,0)
 D ^%ZTLOAD  ; Schedule Task
"RTN","XMKPO",13,0)
 Q
"RTN","XMKPO",14,0)
SERVER(XMZ,XMSERVER,XMSVIENS) ; For S.Server
"RTN","XMKPO",15,0)
 N I,ZTRTN,ZTDESC,ZTSAVE,ZTDTH,ZTSK,ZTIO
"RTN","XMKPO",16,0)
 D SETSTAT^XMTDO(XMSVIENS,$$EZBLD^DIALOG(42002.1)) ; Setting up server task
"RTN","XMKPO",17,0)
 F I="XMZ","XMSERVER","XMSVIENS" S ZTSAVE(I)=""
"RTN","XMKPO",18,0)
 S ZTDTH=$H
"RTN","XMKPO",19,0)
 S ZTRTN="SERVER^XMTDO"
"RTN","XMKPO",20,0)
 S ZTDESC=$$EZBLD^DIALOG(42002,XMSERVER) ; MailMan: To Server |1|
"RTN","XMKPO",21,0)
 S ZTIO=""
"RTN","XMKPO",22,0)
 D ^%ZTLOAD  ; Schedule Task
"RTN","XMKPO",23,0)
 D SETSTAT^XMTDO(XMSVIENS,$$EZBLD^DIALOG(42002.2,$G(ZTSK))) ; Server task #: |1|
"RTN","XMKPO",24,0)
 Q
"RTN","XMKPO",25,0)
BULLETIN(XMDUZ,XMBNAME,XMBIEN,XMPARM,XMBODY,XMTO,XMINSTR,ZTSK,XMATTACH) ;
"RTN","XMKPO",26,0)
 N I,XMB,ZTRTN,ZTDESC,ZTSAVE,ZTDTH,ZTIO
"RTN","XMKPO",27,0)
 I $G(XMBODY)'="",$D(@XMBODY)>9 D
"RTN","XMKPO",28,0)
 . S ZTSAVE("XMBODY")=""
"RTN","XMKPO",29,0)
 . S ZTSAVE($$OREF^DILF(XMBODY))=""
"RTN","XMKPO",30,0)
 F I="XMDUZ","XMBIEN","XMPARM(","XMTO","XMTO(","XMINSTR(","XMATTACH(" S ZTSAVE(I)=""
"RTN","XMKPO",31,0)
 I $G(XMINSTR("ADDR FLAGS"))["I" F I="^TMP(""XMY"",$J,","^TMP(""XMY0"",$J," S ZTSAVE(I)=""
"RTN","XMKPO",32,0)
 I $D(XMINSTR("LATER")) S ZTDTH=$$FMTH^XLFDT(XMINSTR("LATER"))
"RTN","XMKPO",33,0)
 E  S ZTDTH=$H
"RTN","XMKPO",34,0)
 S ZTRTN="TASK^XMXBULL"
"RTN","XMKPO",35,0)
 S ZTDESC=$$EZBLD^DIALOG(42003,XMBNAME) ; MailMan: Bulletin |1|
"RTN","XMKPO",36,0)
 S ZTIO=""
"RTN","XMKPO",37,0)
 D ^%ZTLOAD  ; Schedule Task
"RTN","XMKPO",38,0)
 Q
"RTN","XMKPR")
0^42^B40462386
"RTN","XMKPR",1,0)
XMKPR ;ISC-SF/GMB-Post, remote ;07/23/2002  10:14
"RTN","XMKPR",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMKPR",3,0)
 ; Replaces ^XMBPOST and the first part of ^XMS1 (ISC-WASH/THM/RWF/CAP)
"RTN","XMKPR",4,0)
 ; Schedule a task to deliver remote
"RTN","XMKPR",5,0)
REMOTE(XMZ,XMINST) ; For addresses containing "@"
"RTN","XMKPR",6,0)
 N XMSITE,XMREC,XMPOLL
"RTN","XMKPR",7,0)
 S XMREC=^DIC(4.2,XMINST,0)
"RTN","XMKPR",8,0)
 S XMSITE=$P(XMREC,U)
"RTN","XMKPR",9,0)
 D PUTMSG^XMXMSGS2(.5,XMINST+1000,XMSITE,XMZ)
"RTN","XMKPR",10,0)
 Q:$P(XMREC,U,2)'["S"  ; S means to start task immediately
"RTN","XMKPR",11,0)
 D:'$$TSKEXIST(XMINST) QUEUE(XMINST,XMSITE)
"RTN","XMKPR",12,0)
 Q
"RTN","XMKPR",13,0)
TSKEXIST(XMINST,XMTSK) ;Is Task scheduled ? (0=no,ZTSK^$H=pending,ZTSK=running)
"RTN","XMKPR",14,0)
 ; Note: ZTSK does not exist when 'playing a script', or for an incoming
"RTN","XMKPR",15,0)
 ; transmission.
"RTN","XMKPR",16,0)
 S:'$G(XMTSK) XMTSK=$$GETTSK(XMINST)
"RTN","XMKPR",17,0)
 Q:'XMTSK 0
"RTN","XMKPR",18,0)
 I $D(ZTQUEUED),$G(ZTSK)=XMTSK Q ZTSK
"RTN","XMKPR",19,0)
 N ZTSK
"RTN","XMKPR",20,0)
 S ZTSK=XMTSK
"RTN","XMKPR",21,0)
 D STAT^%ZTLOAD
"RTN","XMKPR",22,0)
 Q:ZTSK(1)=0 0  ; "Undefined"
"RTN","XMKPR",23,0)
 I ZTSK(1)=1 D  Q ZTSK_U_ZTSK("D")  ; "Active: Pending"
"RTN","XMKPR",24,0)
 . D ISQED^%ZTLOAD ; ZTSK("D")=$H when scheduled
"RTN","XMKPR",25,0)
 I ZTSK(1)=2 Q ZTSK  ; "Active: Running"
"RTN","XMKPR",26,0)
 ;I ZTSK(1)=2 N %1 D  L -^DIC(4.2,+$G(XMINST),"XMNETSEND") Q %1
"RTN","XMKPR",27,0)
 ;. ; "Active: Running" - This check isn't reliable,
"RTN","XMKPR",28,0)
 ;. ; because the lock is not set for incoming, only for outgoing.
"RTN","XMKPR",29,0)
 ;. L +^DIC(4.2,+$G(XMINST),"XMNETSEND"):2 ; Is it really running?
"RTN","XMKPR",30,0)
 ;. I $T D KILLTSK(XMINST,ZTSK) S %1=0 Q  ; Nope
"RTN","XMKPR",31,0)
 ;. S %1=ZTSK  ; Yep
"RTN","XMKPR",32,0)
 Q:ZTSK(1)=3 0  ; "Inactive: Finished"
"RTN","XMKPR",33,0)
 I ZTSK(1)=4 D KILLTSK(XMINST,ZTSK) Q 0  ; "Inactive: Available"
"RTN","XMKPR",34,0)
 I ZTSK(1)=5 D KILLTSK(XMINST,ZTSK) Q 0  ; "Interrupted"
"RTN","XMKPR",35,0)
 Q
"RTN","XMKPR",36,0)
GETTSK(XMINST) ;
"RTN","XMKPR",37,0)
 L +^XMBS(4.2999,XMINST,3):0 L -^XMBS(4.2999,XMINST,3) ; ensure latest
"RTN","XMKPR",38,0)
 Q $P($G(^XMBS(4.2999,XMINST,3)),U,7)
"RTN","XMKPR",39,0)
KILLTSK(XMINST,ZTSK) ;
"RTN","XMKPR",40,0)
 D KILL^%ZTLOAD
"RTN","XMKPR",41,0)
 S $P(^XMBS(4.2999,XMINST,3),U,7)=""
"RTN","XMKPR",42,0)
 S $P(^XMBS(4.2999,XMINST,4),U,2)=$$NOW^XLFDT
"RTN","XMKPR",43,0)
 Q
"RTN","XMKPR",44,0)
QUEUE(XMINST,XMSITE,XMB,ZTDTH,ZTSK) ;
"RTN","XMKPR",45,0)
 ; Was ENQ^XMS1 used by ^XMC2,^XMS5,^XMS5B ***
"RTN","XMKPR",46,0)
 ; in:
"RTN","XMKPR",47,0)
 ; XMINST domain IEN in domain file
"RTN","XMKPR",48,0)
 ; XMSITE domain name
"RTN","XMKPR",49,0)
 ; XMB    (optional) script choice (default: highest priority script)
"RTN","XMKPR",50,0)
 ; ZTDTH  (optional) task start time (default: now)
"RTN","XMKPR",51,0)
 ; out:
"RTN","XMKPR",52,0)
 ; ZTSK   task number
"RTN","XMKPR",53,0)
 N XMIENS,XMFDA,ZTIO,ZTDESC,ZTRTN
"RTN","XMKPR",54,0)
 I '$D(^XMBS(4.2999,XMINST,0)) D STAT^XMTDR(XMINST)
"RTN","XMKPR",55,0)
 L +^XMBS(4.2999,XMINST):1
"RTN","XMKPR",56,0)
 I '$G(XMB("SCR IEN")) D  Q:'XMB("SCR IEN")
"RTN","XMKPR",57,0)
 . D XMTCHECK(XMINST,.XMB)
"RTN","XMKPR",58,0)
 . D SCRIPT^XMKPR1(XMINST,XMSITE,.XMB)
"RTN","XMKPR",59,0)
 S ZTIO=$P(XMB("SCR REC"),U,5)
"RTN","XMKPR",60,0)
 S ZTDESC=$$EZBLD^DIALOG(42000,XMSITE) ; MailMan: To |1|
"RTN","XMKPR",61,0)
 S:'$G(ZTDTH) ZTDTH=$H
"RTN","XMKPR",62,0)
 F I="XMINST","XMPOLL" S ZTSAVE(I)=""
"RTN","XMKPR",63,0)
 S ZTRTN="TASK^XMTDR"
"RTN","XMKPR",64,0)
 D ^%ZTLOAD
"RTN","XMKPR",65,0)
 S ^XMBS(4.2999,XMINST,3)="" ; current xmit stats
"RTN","XMKPR",66,0)
 S $P(^XMBS(4.2999,XMINST,3),U,7)=ZTSK
"RTN","XMKPR",67,0)
 S XMIENS=XMINST_","
"RTN","XMKPR",68,0)
 I 'XMB("TRIES"),'XMB("ITERATIONS") D
"RTN","XMKPR",69,0)
 . S XMFDA(4.2999,XMIENS,41)="@" ; xmit start date/time
"RTN","XMKPR",70,0)
 . S XMFDA(4.2999,XMIENS,42)="@" ; xmit finish date/time
"RTN","XMKPR",71,0)
 . S XMFDA(4.2999,XMIENS,45)="@" ; xmit latest try date/time
"RTN","XMKPR",72,0)
 . K ^XMBS(4.2999,XMINST,6)      ; xmit audit multiple
"RTN","XMKPR",73,0)
 S XMFDA(4.2999,XMIENS,25)=ZTSK                ; task number
"RTN","XMKPR",74,0)
 S XMFDA(4.2999,XMIENS,43)=XMB("SCR IEN")      ; ien of script to be used
"RTN","XMKPR",75,0)
 S XMFDA(4.2999,XMIENS,44)=XMB("TRIES")        ; xmit tries
"RTN","XMKPR",76,0)
 S XMFDA(4.2999,XMIENS,46)=XMB("ITERATIONS")   ; xmit iterations
"RTN","XMKPR",77,0)
 S XMFDA(4.2999,XMIENS,47)=XMB("FIRST SCRIPT") ; ien of first script
"RTN","XMKPR",78,0)
 S XMFDA(4.2999,XMIENS,48)=XMB("IP TRIED")     ; IP addresses tried
"RTN","XMKPR",79,0)
 S XMFDA(4.2999,XMIENS,51)=XMB("SCR REC")      ; script record
"RTN","XMKPR",80,0)
 D FILE^DIE("","XMFDA")
"RTN","XMKPR",81,0)
 L -^XMBS(4.2999,XMINST)
"RTN","XMKPR",82,0)
 Q
"RTN","XMKPR",83,0)
XMTCHECK(XMINST,XMB) ;
"RTN","XMKPR",84,0)
 N XMTREC
"RTN","XMKPR",85,0)
 L +^XMBS(4.2999,XMINST,4):0 L -^XMBS(4.2999,XMINST,4) ; ensure latest
"RTN","XMKPR",86,0)
 S XMTREC=$G(^XMBS(4.2999,XMINST,4))
"RTN","XMKPR",87,0)
 Q:'$P(XMTREC,U,1)!$P(XMTREC,U,2)
"RTN","XMKPR",88,0)
 ; Start time, but no finish time.
"RTN","XMKPR",89,0)
 ; Previous transmission attempt was aborted. Pick up where we left off.
"RTN","XMKPR",90,0)
 S XMB("SCR IEN")=$P(XMTREC,U,3)
"RTN","XMKPR",91,0)
 S XMB("TRIES")=$P(XMTREC,U,4)
"RTN","XMKPR",92,0)
 S XMB("LAST TRY")=$P(XMTREC,U,5)
"RTN","XMKPR",93,0)
 S XMB("ITERATIONS")=$P(XMTREC,U,6)
"RTN","XMKPR",94,0)
 S XMB("FIRST SCRIPT")=$P(XMTREC,U,7)
"RTN","XMKPR",95,0)
 S XMB("IP TRIED")=$P(XMTREC,U,8)
"RTN","XMKPR",96,0)
 S XMB("SCR REC")=$G(^XMBS(4.2999,XMINST,5))
"RTN","XMKPR",97,0)
 Q
"RTN","XMKPR",98,0)
REQUEUE(XMINST,XMSITE,XMB) ;
"RTN","XMKPR",99,0)
 N XMFDA,XMIENS,ZTDTH,ZTIO,ZTDESC,ZTRTN
"RTN","XMKPR",100,0)
 S XMFDA(4.29992,XMB("AUDIT IENS"),2)=$E($G(ER("MSG"),$$EZBLD^DIALOG(42192)),1,200) ;Unknown Error
"RTN","XMKPR",101,0)
 D FILE^DIE("","XMFDA")
"RTN","XMKPR",102,0)
 I XMB("TRIES")+1=$P(XMB("SCR REC"),U,3) D POSTFAIL(XMINST,XMSITE,.XMB)
"RTN","XMKPR",103,0)
 D SCRIPT^XMKPR1(XMINST,XMSITE,.XMB) Q:'XMB("SCR IEN")
"RTN","XMKPR",104,0)
 S XMIENS=XMINST_","
"RTN","XMKPR",105,0)
 S XMFDA(4.2999,XMIENS,43)=XMB("SCR IEN")    ; ien of script to be used
"RTN","XMKPR",106,0)
 S XMFDA(4.2999,XMIENS,44)=XMB("TRIES")      ; xmit tries
"RTN","XMKPR",107,0)
 S XMFDA(4.2999,XMIENS,46)=XMB("ITERATIONS") ; xmit iterations
"RTN","XMKPR",108,0)
 S XMFDA(4.2999,XMIENS,48)=XMB("IP TRIED")   ; IP addresses tried
"RTN","XMKPR",109,0)
 S XMFDA(4.2999,XMIENS,51)=XMB("SCR REC")    ; script record
"RTN","XMKPR",110,0)
 D FILE^DIE("","XMFDA")
"RTN","XMKPR",111,0)
 ; XMB("TRIES") starts off at 0 with every script.
"RTN","XMKPR",112,0)
 ; Each time the script is retried, XMB("TRIES") is bumped up by 1.
"RTN","XMKPR",113,0)
 ; XMB("ITERATIONS") starts off at 0.  After a cycle of scripts is tried,
"RTN","XMKPR",114,0)
 ; XMB("ITERATIONS") is bumped up by 1 when the cycle is started again.
"RTN","XMKPR",115,0)
 ; We start every new cycle after one hour.
"RTN","XMKPR",116,0)
 ; We start every new try after one minute
"RTN","XMKPR",117,0)
 I XMB("TRIES") D
"RTN","XMKPR",118,0)
 . S ZTDTH=$$HADD^XLFDT($H,"","",1) ; New try, add 1 minute
"RTN","XMKPR",119,0)
 E  I XMB("ITERATIONS"),XMB("SCR IEN")=XMB("FIRST SCRIPT") D
"RTN","XMKPR",120,0)
 . S ZTDTH=$$HADD^XLFDT($H,"",1) ; New iteration, add 1 hour
"RTN","XMKPR",121,0)
 E  S ZTDTH=$H  ; First try, new script within same iteration
"RTN","XMKPR",122,0)
 S ZTIO=$P(XMB("SCR REC"),U,5)
"RTN","XMKPR",123,0)
 S ZTDESC=$$EZBLD^DIALOG(42000.1,XMSITE) ;MailMan: To |1| (requeue)
"RTN","XMKPR",124,0)
 ; ("_XMB("ITERATIONS")_","_XMB("SCR IEN")_","_XMB("TRIES")_")"
"RTN","XMKPR",125,0)
 S ZTRTN="TASK^XMTDR"
"RTN","XMKPR",126,0)
 S ZTREQ=ZTDTH_U_ZTIO_U_ZTDESC_U_ZTRTN
"RTN","XMKPR",127,0)
 D DOTRAN^XMC1(42000.2,XMSITE) ;|1| Requeued
"RTN","XMKPR",128,0)
 Q
"RTN","XMKPR",129,0)
POSTFAIL(XMINST,XMSITE,XMB) ; Postmaster message on queue failure
"RTN","XMKPR",130,0)
 N XMPARM,XMINSTR,XMI,XMJ,XMTRIES,XMFIRST
"RTN","XMKPR",131,0)
 K ^TMP("XM",$J)
"RTN","XMKPR",132,0)
 S XMINSTR("FROM")="POSTMASTER",XMINSTR("ADDR FLAGS")="R"
"RTN","XMKPR",133,0)
 S XMTRIES=$P(XMB("SCR REC"),U,3)
"RTN","XMKPR",134,0)
 S XMPARM(1)=XMSITE,XMPARM(2)=XMTRIES
"RTN","XMKPR",135,0)
 S XMJ=0
"RTN","XMKPR",136,0)
 S XMJ=XMJ+1,^TMP("XM",$J,XMJ,0)=""
"RTN","XMKPR",137,0)
 S XMFIRST=$P($G(^XMBS(4.2999,XMINST,6,0)),U,3)-XMTRIES
"RTN","XMKPR",138,0)
 S:XMFIRST<0 XMFIRST=0
"RTN","XMKPR",139,0)
 S XMI=XMFIRST ; Get tries audit from ^XMBS(4.2999, "XMIT AUDIT" multiple
"RTN","XMKPR",140,0)
 F  S XMI=$O(^XMBS(4.2999,XMINST,6,XMI)) Q:'XMI  S XMJ=XMJ+1,^TMP("XM",$J,XMJ,0)=^(XMI,0)
"RTN","XMKPR",141,0)
 S XMJ=XMJ+1,^TMP("XM",$J,XMJ,0)=""
"RTN","XMKPR",142,0)
 S XMJ=XMJ+1,^TMP("XM",$J,XMJ,0)=$$EZBLD^DIALOG(42190) ;A transcript of the last delivery attempt follows:
"RTN","XMKPR",143,0)
 S XMJ=XMJ+1,^TMP("XM",$J,XMJ,0)=""
"RTN","XMKPR",144,0)
 S XMI=0
"RTN","XMKPR",145,0)
 F  S XMI=$O(^TMP("XMC",XMC("AUDIT"),XMI)) Q:'XMI  S XMJ=XMJ+1,^TMP("XM",$J,XMJ,0)=^(XMI,0)
"RTN","XMKPR",146,0)
 I XMFIRST'=0 D
"RTN","XMKPR",147,0)
 . S XMJ=XMJ+1,^TMP("XM",$J,XMJ,0)="**********************************************"
"RTN","XMKPR",148,0)
 . S XMJ=XMJ+1,^TMP("XM",$J,XMJ,0)=$$EZBLD^DIALOG(42191) ;The following errors occurred in previous scripts:
"RTN","XMKPR",149,0)
 . S XMI=0 ; Get tries audit from ^XMBS(4.2999, "XMIT AUDIT" multiple
"RTN","XMKPR",150,0)
 . F  S XMI=$O(^XMBS(4.2999,XMINST,6,XMI)) Q:XMI=XMFIRST  S XMJ=XMJ+1,^TMP("XM",$J,XMJ,0)=^(XMI,0)
"RTN","XMKPR",151,0)
 D TASKBULL^XMXBULL(.5,"XM SEND ERR TRANSMISSION",.XMPARM,"^TMP(""XM"",$J)",.5,.XMINSTR)
"RTN","XMKPR",152,0)
 K ^TMP("XM",$J)
"RTN","XMKPR",153,0)
 Q
"RTN","XMKPR1")
0^216^B14608787
"RTN","XMKPR1",1,0)
XMKPR1 ;ISC-SF/GMB-^XMKPR (cont.) ;05/14/2002  08:37
"RTN","XMKPR1",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMKPR1",3,0)
SCRIPT(XMINST,XMSITE,XMB,XMOKTYPE) ; Get first/next Transmission Script
"RTN","XMKPR1",4,0)
 ; XMINST   (in)  Pointer to domain file
"RTN","XMKPR1",5,0)
 ; XMSITE   (in)  Name (.01 field) of domain pointed to by XMINST
"RTN","XMKPR1",6,0)
 ; XMOKTYPE (in)  array of script types which are acceptable
"RTN","XMKPR1",7,0)
 ; XMB      (out) XMB("SCR IEN")      Pointer to script within domain
"RTN","XMKPR1",8,0)
 ;                XMB("FIRST SCRIPT") Pointer to first script tried
"RTN","XMKPR1",9,0)
 ;                XMB("SCR REC")      Script zero node
"RTN","XMKPR1",10,0)
 ;                XMB("ITERATIONS")   Number of cycles of scripts
"RTN","XMKPR1",11,0)
 ;                XMB("TRIES")        Number of tries with one script
"RTN","XMKPR1",12,0)
 ;                XMB("IP TRIED")     IP addresses tried so far
"RTN","XMKPR1",13,0)
 ; If no transmission scripts are prioritized use old data/defaults.
"RTN","XMKPR1",14,0)
 ; If failure, then XMB("SCR IEN")=0
"RTN","XMKPR1",15,0)
 ; XMPRI    Priority
"RTN","XMKPR1",16,0)
 ; XMTYPE   Script type
"RTN","XMKPR1",17,0)
 ; XMDEFALT Default script settings
"RTN","XMKPR1",18,0)
 ; XMSLIST  Array of possible scripts
"RTN","XMKPR1",19,0)
 ; XMSFIRST First possible script
"RTN","XMKPR1",20,0)
 ; XMSNEXT  Next possible script
"RTN","XMKPR1",21,0)
 N XMSLIST,XMSFIRST,XMSNEXT,XMPRI,XMTYPE,I,XMREC,XMIEN
"RTN","XMKPR1",22,0)
 I $D(XMB("SCR REC")),(XMB("TRIES")+1)<$P(XMB("SCR REC"),U,3) D  Q
"RTN","XMKPR1",23,0)
 . S XMB("TRIES")=XMB("TRIES")+1
"RTN","XMKPR1",24,0)
 . D DEFAULT(XMINST,XMSITE,.XMB) ; refresh the script
"RTN","XMKPR1",25,0)
 . ;I $G(ER)=25,$$USEDNS D NEXTIP(XMSITE,.XMB)
"RTN","XMKPR1",26,0)
 . I $G(ER)=25!($P(XMB("SCR REC"),U,6)=""),$$USEDNS D NEXTIP(XMSITE,.XMB)
"RTN","XMKPR1",27,0)
 ; We are here because the # attempts made is more than the max allowed,
"RTN","XMKPR1",28,0)
 ; or because we are about to make our first attempt.
"RTN","XMKPR1",29,0)
 ; In either case, we need a (next) script to try.
"RTN","XMKPR1",30,0)
 I '$D(XMOKTYPE) S (XMOKTYPE("SMTP"),XMOKTYPE("TCPCHAN"),XMOKTYPE("NONE"))=""
"RTN","XMKPR1",31,0)
 S XMIEN=0
"RTN","XMKPR1",32,0)
 F  S XMIEN=$O(^DIC(4.2,XMINST,1,XMIEN)) Q:XMIEN'>0  D
"RTN","XMKPR1",33,0)
 . S XMREC=$G(^DIC(4.2,XMINST,1,XMIEN,0))
"RTN","XMKPR1",34,0)
 . Q:$P(XMREC,U,7)  ; Out of service
"RTN","XMKPR1",35,0)
 . S XMTYPE=$P(XMREC,U,4)
"RTN","XMKPR1",36,0)
 . S:XMTYPE="" XMTYPE="NONE"
"RTN","XMKPR1",37,0)
 . Q:'$D(XMOKTYPE(XMTYPE))
"RTN","XMKPR1",38,0)
 . S XMPRI=$P(XMREC,U,2) S:XMPRI="" XMPRI=9999
"RTN","XMKPR1",39,0)
 . S XMSLIST(XMPRI,XMIEN)=XMIEN
"RTN","XMKPR1",40,0)
 I '$D(XMSLIST) S XMB("SCR IEN")=0 Q
"RTN","XMKPR1",41,0)
 S XMIEN=+$G(XMB("SCR IEN"))
"RTN","XMKPR1",42,0)
 S XMSFIRST="XMSLIST"
"RTN","XMKPR1",43,0)
 S XMSFIRST=$Q(@XMSFIRST)
"RTN","XMKPR1",44,0)
 I XMIEN=0!('$D(^DIC(4.2,XMINST,1,XMIEN,0))) D  ; First attempt, so take the first script
"RTN","XMKPR1",45,0)
 . S XMB("SCR IEN")=@XMSFIRST
"RTN","XMKPR1",46,0)
 . S XMB("FIRST SCRIPT")=XMB("SCR IEN")
"RTN","XMKPR1",47,0)
 . S XMB("ITERATIONS")=0
"RTN","XMKPR1",48,0)
 E  D  ; Try the next script after the one we just tried.
"RTN","XMKPR1",49,0)
 . ; If that was the last one, go back to the first.
"RTN","XMKPR1",50,0)
 . S XMPRI=$P(^DIC(4.2,XMINST,1,XMIEN,0),U,2) S:XMPRI="" XMPRI=9999
"RTN","XMKPR1",51,0)
 . S XMSNEXT="XMSLIST(XMPRI,XMIEN)"
"RTN","XMKPR1",52,0)
 . S XMSNEXT=$Q(@XMSNEXT)
"RTN","XMKPR1",53,0)
 . I XMSNEXT="" D
"RTN","XMKPR1",54,0)
 . . S XMB("SCR IEN")=@XMSFIRST
"RTN","XMKPR1",55,0)
 . . S XMB("ITERATIONS")=XMB("ITERATIONS")+1
"RTN","XMKPR1",56,0)
 . E  S XMB("SCR IEN")=@XMSNEXT
"RTN","XMKPR1",57,0)
 D INITSCR(XMINST,XMSITE,.XMB)
"RTN","XMKPR1",58,0)
 Q
"RTN","XMKPR1",59,0)
NEXTIP(XMSITE,XMB) ;
"RTN","XMKPR1",60,0)
 I ","_$G(XMB("IP TRIED"))_","[(","_$P(XMB("SCR REC"),U,6)_",")!($P(XMB("SCR REC"),U,6)="") D
"RTN","XMKPR1",61,0)
 . N XMIP
"RTN","XMKPR1",62,0)
 . S XMIP=$$NEXTIPF^XMKPRD(XMSITE,$G(XMB("IP TRIED")))
"RTN","XMKPR1",63,0)
 . I XMIP'="" S $P(XMB("SCR REC"),U,6)=XMIP
"RTN","XMKPR1",64,0)
 I $P(XMB("SCR REC"),U,6)="" S $P(XMB("SCR REC"),U,6)=$P($G(XMB("IP TRIED")),",",1)
"RTN","XMKPR1",65,0)
 I $G(XMB("IP TRIED"))="" S XMB("IP TRIED")=$P(XMB("SCR REC"),U,6) Q
"RTN","XMKPR1",66,0)
 I ","_XMB("IP TRIED")_","[(","_$P(XMB("SCR REC"),U,6)_",") Q
"RTN","XMKPR1",67,0)
 S XMB("IP TRIED")=XMB("IP TRIED")_","_$P(XMB("SCR REC"),U,6)
"RTN","XMKPR1",68,0)
 Q
"RTN","XMKPR1",69,0)
INITSCR(XMINST,XMSITE,XMB) ;
"RTN","XMKPR1",70,0)
 S:'$D(XMB("ITERATIONS")) XMB("ITERATIONS")=0
"RTN","XMKPR1",71,0)
 S XMB("TRIES")=0
"RTN","XMKPR1",72,0)
 S:'$D(XMB("FIRST SCRIPT")) XMB("FIRST SCRIPT")=XMB("SCR IEN")
"RTN","XMKPR1",73,0)
 S XMB("IP TRIED")=""
"RTN","XMKPR1",74,0)
 D DEFAULT(XMINST,XMSITE,.XMB)
"RTN","XMKPR1",75,0)
 S:XMB("IP TRIED")="" XMB("IP TRIED")=$P(XMB("SCR REC"),U,6)
"RTN","XMKPR1",76,0)
 Q
"RTN","XMKPR1",77,0)
DEFAULT(XMINST,XMSITE,XMB) ;
"RTN","XMKPR1",78,0)
 N XMDEFALT,I
"RTN","XMKPR1",79,0)
 ; Pickup data from selected script
"RTN","XMKPR1",80,0)
 S XMB("SCR REC")=^DIC(4.2,XMINST,1,XMB("SCR IEN"),0)
"RTN","XMKPR1",81,0)
 ;I $P(XMB("SCR REC"),U,6)="",$$USEDNS D NEXTIP(XMSITE,.XMB)
"RTN","XMKPR1",82,0)
 ; Create defaults
"RTN","XMKPR1",83,0)
 S XMDEFALT=^DIC(4.2,XMINST,0)
"RTN","XMKPR1",84,0)
 ; Piece 17=Physical link device; Piece 12=Host IP Address;
"RTN","XMKPR1",85,0)
 ; $P(^XMB(1,1,"NETWORK"),U,1) is the number of attempts before failure
"RTN","XMKPR1",86,0)
 S XMDEFALT=$P(XMDEFALT,U)_"^0^"_$S(+$G(^XMB(1,1,"NETWORK")):+^("NETWORK"),1:10)_"^SMTP^"_$P(XMDEFALT,U,17)_U_$P(XMDEFALT,U,12)
"RTN","XMKPR1",87,0)
 ;
"RTN","XMKPR1",88,0)
 ;Use defaults if no data in transmission script fields
"RTN","XMKPR1",89,0)
 F I=3:1:$L(XMDEFALT,U) S:$P(XMB("SCR REC"),U,I)="" $P(XMB("SCR REC"),U,I)=$P(XMDEFALT,U,I)
"RTN","XMKPR1",90,0)
 Q
"RTN","XMKPR1",91,0)
USEDNS() ; Function returns 1 if we can use DNS; 0 if we can't.
"RTN","XMKPR1",92,0)
 Q:'$P($G(^XMB(1,1,"NETWORK")),U,2) 0  ; Site says don't use DNS
"RTN","XMKPR1",93,0)
 Q:$T(^XLFNSLK)="" 0  ; DNS API is not present
"RTN","XMKPR1",94,0)
 Q:$P($G(^XTV(8989.3,1,"DNS")),U,1)="" 0  ; No DNS IP address
"RTN","XMKPR1",95,0)
 Q 1
"RTN","XMKPRD")
0^217^B15344166
"RTN","XMKPRD",1,0)
XMKPRD ;ISC-SF/GMB-DNS Interface ;07/11/2002  08:09
"RTN","XMKPRD",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMKPRD",3,0)
NEXTIPF(XMSITE,XMIPT,XMIPLIST) ; Function returns next IP address to try.
"RTN","XMKPRD",4,0)
 ; IN:
"RTN","XMKPRD",5,0)
 ; XMSITE   - .01 field of domain in file 4.2 (not a synonym)
"RTN","XMKPRD",6,0)
 ; XMIPT    - List of IP addresses, separated by ",", already tried
"RTN","XMKPRD",7,0)
 ; XMIPLIST - (optional) List of IP addresses, separated by ",", to try
"RTN","XMKPRD",8,0)
 I '$D(XMIPLIST) D
"RTN","XMKPRD",9,0)
 . D SHOW(42260) ;Call DNS for IP Address list ...
"RTN","XMKPRD",10,0)
 . S XMIPLIST=$$IPADDR(XMSITE)
"RTN","XMKPRD",11,0)
 . D SHOW($S(XMIPLIST="":42261,1:42262),XMIPLIST) ;Returned: Nothing!/|1|
"RTN","XMKPRD",12,0)
 I XMIPLIST="" Q ""
"RTN","XMKPRD",13,0)
 I $G(XMIPT)="" Q $P(XMIPLIST,",")
"RTN","XMKPRD",14,0)
 N XMJ,XMIP
"RTN","XMKPRD",15,0)
 F XMJ=1:1:$L(XMIPT,",") D  Q:XMIP=""!(","_XMIPT_","'[(","_XMIP_","))
"RTN","XMKPRD",16,0)
 . S XMIP=$P(XMIPT,",",XMJ)
"RTN","XMKPRD",17,0)
 . D NEXTIP(.XMIP,.XMIPLIST)
"RTN","XMKPRD",18,0)
 Q XMIP
"RTN","XMKPRD",19,0)
IPADDR(XMSITE) ;
"RTN","XMKPRD",20,0)
 N XMIPARY,XMIP,XMIPSITE,XMI,XMIPREC,XMIPLIST
"RTN","XMKPRD",21,0)
 D MAIL^XLFNSLK(.XMIPARY,XMSITE)
"RTN","XMKPRD",22,0)
 S XMI=0
"RTN","XMKPRD",23,0)
 F  S XMI=$O(XMIPARY(XMI)) Q:'XMI  D
"RTN","XMKPRD",24,0)
 . S XMIPREC=XMIPARY(XMI)
"RTN","XMKPRD",25,0)
 . S XMIP=$P(XMIPREC,U,2)
"RTN","XMKPRD",26,0)
 . ;I XMIP'?1.N1"."1.N1"."1.N1".".E D  Q
"RTN","XMKPRD",27,0)
 . I XMIP="" D  Q
"RTN","XMKPRD",28,0)
 . . D SHOW(42260.1,XMIPREC) ;Ignore '|1|' - no IP address
"RTN","XMKPRD",29,0)
 . S XMIPSITE=$$UP^XLFSTR($P(XMIPREC,U,1))
"RTN","XMKPRD",30,0)
 . ; Accept whatever DNS returns, except for FORUM.  We accept FORUM if
"RTN","XMKPRD",31,0)
 . ; we're trying to get to FORUM, but we don't want messages destined
"RTN","XMKPRD",32,0)
 . ; for another site to be routed through FORUM.  If this is a non-VA
"RTN","XMKPRD",33,0)
 . ; site, then it's OK to route through FORUM.
"RTN","XMKPRD",34,0)
 . I ^XMB("NETNAME")[".VA.GOV",XMSITE'["FORUM.VA.GOV",XMIPSITE["FORUM.VA.GOV" D  Q
"RTN","XMKPRD",35,0)
 . . D SHOW(42260.2,XMIPREC) ;Ignore '|1|' - that's a different site
"RTN","XMKPRD",36,0)
 . ;I '$$SAMESITE(XMIPSITE,XMSITE) D  Q
"RTN","XMKPRD",37,0)
 . ;. D SHOW(42260.2,XMIPREC) ;Ignore '|1|' - that's a different site
"RTN","XMKPRD",38,0)
 . I ","_$G(XMIPLIST)_","[(","_XMIP_",") D  Q
"RTN","XMKPRD",39,0)
 . . D SHOW(42260.3,XMIPREC) ;Ignore '|1|' - already have that IP address
"RTN","XMKPRD",40,0)
 . D SHOW(42260.4,XMIPREC) ;Accept '|1|'
"RTN","XMKPRD",41,0)
 . I $G(XMIPLIST)="" S XMIPLIST=XMIP Q
"RTN","XMKPRD",42,0)
 . S XMIPLIST=XMIPLIST_","_XMIP
"RTN","XMKPRD",43,0)
 Q $G(XMIPLIST)
"RTN","XMKPRD",44,0)
SAMESITE(X,XMSITE) ;
"RTN","XMKPRD",45,0)
 N DIC,Y,D
"RTN","XMKPRD",46,0)
 I $E(X,$L(X))="." S X=$E(X,1,$L(X)-1)
"RTN","XMKPRD",47,0)
 S DIC="^DIC(4.2,",DIC(0)="FMXZ",D="B^C"
"RTN","XMKPRD",48,0)
 F  D MIX^DIC1 Q:Y>0!(X'[".")  S X=$P(X,".",2,99)
"RTN","XMKPRD",49,0)
 I Y,Y(0,0)=XMSITE Q 1
"RTN","XMKPRD",50,0)
 Q 0
"RTN","XMKPRD",51,0)
SHOW(XMDIALOG,XM1) ;
"RTN","XMKPRD",52,0)
 I $D(ZTQUEUED)!'$G(XMC("PLAY")) Q
"RTN","XMKPRD",53,0)
 I +XMDIALOG=XMDIALOG W !,$$EZBLD^DIALOG(XMDIALOG,$G(XM1)) Q
"RTN","XMKPRD",54,0)
 W !,XMDIALOG
"RTN","XMKPRD",55,0)
 Q
"RTN","XMKPRD",56,0)
NEXTIP(XMIP,XMIPLIST) ;
"RTN","XMKPRD",57,0)
 N XMI
"RTN","XMKPRD",58,0)
 F XMI=1:1:$L(XMIPLIST,",") Q:$P(XMIPLIST,",",XMI)=XMIP
"RTN","XMKPRD",59,0)
 I XMIP'=$P(XMIPLIST,",",XMI) S XMIP=$P(XMIPLIST,","),XMIPLIST=$P(XMIPLIST,",",2,99) Q
"RTN","XMKPRD",60,0)
 I XMI=1 S XMIPLIST=$P(XMIPLIST,",",2,99)
"RTN","XMKPRD",61,0)
 E  I XMI=$L(XMIPLIST,",") S XMIPLIST=$P(XMIPLIST,",",1,XMI-1)
"RTN","XMKPRD",62,0)
 E  S XMIPLIST=$P(XMIPLIST,",",1,XMI-1)_","_$P(XMIPLIST,",",XMI+1,99)
"RTN","XMKPRD",63,0)
 S XMIP=$P(XMIPLIST,","),XMIPLIST=$P(XMIPLIST,",",2,99)
"RTN","XMKPRD",64,0)
 Q
"RTN","XMKPRD",65,0)
 ; *** The following is not used ***
"RTN","XMKPRD",66,0)
CONNECT(XMSITE,XMIP,XMPORT) ; Function tries to connect to site.
"RTN","XMKPRD",67,0)
 ; Returns the IP address if success; 0 if failure
"RTN","XMKPRD",68,0)
 ; XMSITE - Site name to connect to
"RTN","XMKPRD",69,0)
 ; XMIP   - Site IP address to try first (optional).  If none given,
"RTN","XMKPRD",70,0)
 ;           or if attempt fails, DNS is called to retrieve address(es).
"RTN","XMKPRD",71,0)
 ; XMPORT - Port number to use (optional, default=25)
"RTN","XMKPRD",72,0)
 N XMIPLIST,XMOK
"RTN","XMKPRD",73,0)
 I '$G(XMPORT) S XMPORT=25
"RTN","XMKPRD",74,0)
 D SHOW("Connect to "_XMSITE_" on port "_XMPORT_$S($G(XMIP):", IP Address "_XMIP,1:""))
"RTN","XMKPRD",75,0)
 I $G(XMIP)="" D NEXTIPR(XMSITE,.XMIP,.XMIPLIST) Q:XMIP="" 0
"RTN","XMKPRD",76,0)
 S XMOK=0
"RTN","XMKPRD",77,0)
 F  D TRYIP(XMIP,.XMOK) Q:XMOK  D NEXTIPR(XMSITE,.XMIP,.XMIPLIST) Q:XMIP=""
"RTN","XMKPRD",78,0)
 Q:XMOK XMIP
"RTN","XMKPRD",79,0)
 D SHOW("Connect failed.  Try again later.")
"RTN","XMKPRD",80,0)
 Q 0
"RTN","XMKPRD",81,0)
NEXTIPR(XMSITE,XMIP,XMIPLIST) ; Routine returns next IP address to try
"RTN","XMKPRD",82,0)
 ; IN/OUT:
"RTN","XMKPRD",83,0)
 ; XMIP     - in:  Last IP address tried
"RTN","XMKPRD",84,0)
 ;            out: Next IP address to try
"RTN","XMKPRD",85,0)
 ; XMIPLIST - in:  (optional) List of IP addresses, separated by ",",
"RTN","XMKPRD",86,0)
 ;                 we haven't yet tried
"RTN","XMKPRD",87,0)
 ;            out: Same, but with XMIP (out) removed
"RTN","XMKPRD",88,0)
 I '$D(XMIPLIST) D
"RTN","XMKPRD",89,0)
 . D SHOW(42260) ;Call DNS for IP Address list ...
"RTN","XMKPRD",90,0)
 . S XMIPLIST=$$IPADDR(XMSITE)
"RTN","XMKPRD",91,0)
 . D SHOW($S(XMIPLIST="":42261,1:42262),XMIPLIST) ;Returned: Nothing!/|1|
"RTN","XMKPRD",92,0)
 I XMIPLIST="" S XMIP="" Q
"RTN","XMKPRD",93,0)
 I $G(XMIP)="" S XMIP=$P(XMIPLIST,","),XMIPLIST=$P(XMIPLIST,",",2,99) Q
"RTN","XMKPRD",94,0)
 D NEXTIP(.XMIP,.XMIPLIST)
"RTN","XMKPRD",95,0)
 Q
"RTN","XMKPRD",96,0)
TRYIP(XMIP,XMOK) ; Try the IP address, if it works, set XMOK=1
"RTN","XMKPRD",97,0)
 D SHOW("Trying "_XMIP)
"RTN","XMKPRD",98,0)
 D CALL^%ZISTCP(XMIP,XMPORT)
"RTN","XMKPRD",99,0)
 S XMOK='POP
"RTN","XMKPRD",100,0)
 I 'XMOK D SHOW("Attempt failed.")
"RTN","XMKPRD",101,0)
 Q
"RTN","XML")
0^43^B16315182
"RTN","XML",1,0)
XML ;(WASH ISC)/THM/GJL-MailMan Physical link ;06/04/2002  08:26
"RTN","XML",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XML",3,0)
 ; Entry points (DBIA 1283):
"RTN","XML",4,0)
 ; GET  - Set up variables for communications protocol in file 3.4
"RTN","XML",5,0)
 ;
"RTN","XML",6,0)
 ; Entry points used by MailMan options (not covered by DBIA):
"RTN","XML",7,0)
 ; C     XMDXPROT
"RTN","XML",8,0)
OPEN ;
"RTN","XML",9,0)
 N Y
"RTN","XML",10,0)
 I $G(XMCHAN)="" S XMCHAN="SCP"
"RTN","XML",11,0)
 D GET Q:ER
"RTN","XML",12,0)
 D OP Q:ER
"RTN","XML",13,0)
 S:'$D(XMESC) XMESC="~"
"RTN","XML",14,0)
 S:'$D(XMFS) XMFS=255
"RTN","XML",15,0)
 S:'$D(XM) XM=""
"RTN","XML",16,0)
 Q
"RTN","XML",17,0)
GET ; Set up variables for communications protocol in file 3.4
"RTN","XML",18,0)
 ; In:
"RTN","XML",19,0)
 ; XMCHAN  - Name of the communications protocol
"RTN","XML",20,0)
 ; Out:
"RTN","XML",21,0)
 ; XMCHAN  - IEN of the communications protocol
"RTN","XML",22,0)
 ; XMPROT  - Name of the communications protocol
"RTN","XML",23,0)
 ; XMSEN   - Xecute this variable to send a line
"RTN","XML",24,0)
 ; XMREC   - Xecute this variable to receive a line
"RTN","XML",25,0)
 ; XMOPEN  - Xecute this variable to open the channel
"RTN","XML",26,0)
 ; XMCLOSE - Xecute this variable to close the channel
"RTN","XML",27,0)
 ; XMOS    - Operating System, used in ^XMLTCP
"RTN","XML",28,0)
 N DIC,X
"RTN","XML",29,0)
 S X=XMCHAN,DIC="^DIC(3.4,",DIC(0)="FO"
"RTN","XML",30,0)
 D ^DIC I Y<0 D  Q
"RTN","XML",31,0)
 . D ERTRAN^XMC1(42244,XMCHAN) ;Invalid Communications Protocol: '|1|'
"RTN","XML",32,0)
 . S Y=XMTRAN
"RTN","XML",33,0)
 S XMCHAN=+Y,XMPROT=$P(Y,U,2)
"RTN","XML",34,0)
 S XMSEN=$G(^DIC(3.4,XMCHAN,1),"Q"),XMREC=$G(^(2),"Q"),XMOPEN=$G(^(3),"Q"),XMCLOSE=$G(^(4),"Q")
"RTN","XML",35,0)
 S XMOS=^%ZOSF("OS")
"RTN","XML",36,0)
 I XMOS["MSM" D
"RTN","XML",37,0)
 . S XMOS("MSMVER")=$P($ZV," 4.0.",2)
"RTN","XML",38,0)
 . S:+XMOS("MSMVER")=0 XMOS("MSMVER")=8
"RTN","XML",39,0)
 Q
"RTN","XML",40,0)
OP ;
"RTN","XML",41,0)
 I "Q"'[$G(XMOPEN) X XMOPEN
"RTN","XML",42,0)
 I 'XMC("BATCH"),'$D(XMQUIET) S X=255 X ^%ZOSF("RM")
"RTN","XML",43,0)
 Q
"RTN","XML",44,0)
C X ^%ZOSF("EON")
"RTN","XML",45,0)
 I $D(XMCLOSE) X:$L(XMCLOSE) XMCLOSE
"RTN","XML",46,0)
 Q
"RTN","XML",47,0)
 ; The following has nothing to do with the above.
"RTN","XML",48,0)
 ; These are used by the SCP Communications Protocol in file 3.4.
"RTN","XML",49,0)
SEND ; Sends XMSG, returns ER=0 or 1, and XMLER=number of "soft" errors
"RTN","XML",50,0)
 I $L(XMSG)>255 S XMLER=0,ER=1 G SRQ
"RTN","XML",51,0)
 I XMSG'?.ANP F %=1:1:$L(XMSG) I $E(XMSG,%)?1C,$A(XMSG,%)'=9 S XMSG=$E(XMSG,1,%-1)_$E(XMSG,%+1,999) Q:XMSG?.ANP  S %=%-1
"RTN","XML",52,0)
 D SRINIT S X=XMSG D SUM
"RTN","XML",53,0)
 I $G(XMINST) D XMTSTAT^XMTDR(XMINST,"S",XMSG,0)
"RTN","XML",54,0)
SL S XMLER=XMLER+1 I (XMLER+1)>XMLMAXER D NEWSTRAT
"RTN","XML",55,0)
 I ER W XMLERR,$C(13) G SRQ
"RTN","XML",56,0)
 D BUFLUSH W XMSG,$C(13) W XMLINE,U,XMSUM,$C(13) R XMLX:XMLTIME G:XMLX=(XMLINE_U_XMLACK) SRQ
"RTN","XML",57,0)
 S XMLY=XMLX=(XMLINE_U_XMLNAK),XMLZ=0 D:'XMLY ENQ G SL:XMLY,SRQ
"RTN","XML",58,0)
ENQ ; ACK/NAK garbled - try to re-establish contact
"RTN","XML",59,0)
 S XMLZ=XMLZ+1 I XMLZ>XMLMAXER S (ER,XMLY)=1 Q
"RTN","XML",60,0)
 D BUFLUSH W XMLENQ,$C(13) R XMLX:XMLTIME Q:XMLX=(XMLINE_U_XMLACK)
"RTN","XML",61,0)
 I XMLX[XMLACK!(XMLX[XMLNAK),+XMLX=XMLINE!(+XMLX=XMLINE-1) S XMLY=1 Q
"RTN","XML",62,0)
 H 1 G ENQ
"RTN","XML",63,0)
REC ; Receives XMRG, returns ER=0 or 1, and XMLER=number of "soft" errors
"RTN","XML",64,0)
 D SRINIT S:'$D(XMLAN) XMLAN=XMLINE_U_XMLNAK
"RTN","XML",65,0)
 I $D(XMRG),$G(XMINST) D XMTSTAT^XMTDR(XMINST,"R",XMRG,0)
"RTN","XML",66,0)
RL S XMLER=XMLER+1 I (XMLER+1)>XMLMAXER D NEWSTRAT I ER=1 G SRQ
"RTN","XML",67,0)
 R XMRG#255:$S($D(XMSTIME):XMSTIME,1:XMLTIME)
"RTN","XML",68,0)
 S XMLZ=$S('$T:-1,XMRG=XMLENQ:0,XMRG=XMLERR:2,1:1)
"RTN","XML",69,0)
 S ER=XMLZ=2 G:XMLZ>1 SRQ I 'XMLZ D BUFLUSH W XMLAN,$C(13) G RL
"RTN","XML",70,0)
 R XMLY:XMLTIME
"RTN","XML",71,0)
 I +XMLY=XMLINE S X=XMRG D SUM S XMLZ=XMSUM=$P(XMLY,U,2) G RL2
"RTN","XML",72,0)
 S XMLZ=0 I +XMLY=(XMLINE-1),XMLINE'=1 D BUFLUSH W +XMLY,U,XMLACK,$C(13) G RL
"RTN","XML",73,0)
RL2 S XMLAN=XMLINE_U_$S(XMLZ:XMLACK,1:XMLNAK) D BUFLUSH W XMLAN,$C(13)
"RTN","XML",74,0)
 G SRQ:XMLZ,RL
"RTN","XML",75,0)
SRINIT ; Initialize variables for Send/Receive
"RTN","XML",76,0)
 S XMLINE=$S('$D(XMLINE):1,1:XMLINE+1),XMLACK="ACK",XMLNAK="NAK"
"RTN","XML",77,0)
 S XMLENQ=$C(9)_"ENQ"_$C(9),XMLERR=$C(9)_"ERROR"_$C(9)
"RTN","XML",78,0)
 S XMLER=-1 ;soft error count
"RTN","XML",79,0)
 S XMLMAXER=5 ;maximum allowable soft errors
"RTN","XML",80,0)
 S XMLTIME=30 ;length of READ time
"RTN","XML",81,0)
 S ER=0 ;non-recoverable error flag
"RTN","XML",82,0)
 Q
"RTN","XML",83,0)
NEWSTRAT ; Select new strategy, one or both machines may be slow
"RTN","XML",84,0)
 I XMLMAXER=5 S ER=1 Q  ;already tried new strategy, give up.
"RTN","XML",85,0)
 S XMTLER=$S('$D(XMTLER):XMLER,1:XMTLER+XMLER),XMLER=0 ;add to total
"RTN","XML",86,0)
 S XMLMAXER=5 ;reduce allowable soft errors
"RTN","XML",87,0)
 S XMLTIME=30 ;increase the READ time
"RTN","XML",88,0)
 Q
"RTN","XML",89,0)
SRQ ; Exit from Send/Receive
"RTN","XML",90,0)
 S XMTLER=$S('$D(XMTLER):XMLER,1:XMTLER+XMLER) ;Total errors
"RTN","XML",91,0)
 K XMLACK,XMLNAK,XMLENQ,XMLERR,XMLMAXER,XMLTIME,XMLX,XMLY,XMLZ
"RTN","XML",92,0)
 Q
"RTN","XML",93,0)
BUFLUSH ; Flush buffer
"RTN","XML",94,0)
 Q:'$D(XMBFLUSH)
"RTN","XML",95,0)
 X ^%ZOSF("TRMON") S X=$P($H,",",2) F %=1:1 R %:0 Q:'$T  S %=$P($H,",",2) S:%<X %=%+86400 Q:%-X>15
"RTN","XML",96,0)
 X ^%ZOSF("TRMOFF")
"RTN","XML",97,0)
 Q
"RTN","XML",98,0)
SUM ; Calculate checksum, accounting also for the character's position
"RTN","XML",99,0)
 S XMSUM=0 F %=1:1:$L(X) S XMSUM=XMSUM+($A(X,%)*%)
"RTN","XML",100,0)
 Q
"RTN","XML1")
1^166
"RTN","XML1CRC")
0^219^B12736464
"RTN","XML1CRC",1,0)
XML1CRC ;(WASH ISC)/RJ-OS Check Sum ;04/17/2002  10:58
"RTN","XML1CRC",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XML1CRC",3,0)
OPEN D GET,OP
"RTN","XML1CRC",4,0)
 S:'$D(XMESC) XMESC="~" S:'$D(XMFS) XMFS=255 S:'$D(XM) XM="" S (XMSSQ,XMRSQ)=1 Q
"RTN","XML1CRC",5,0)
GET S X=XMCHAN,DIC="^DIC(3.4,",DIC(0)="Z" D ^DIC S XMCHAN=+Y
"RTN","XML1CRC",6,0)
 I '$D(^DIC(3.4,XMCHAN,0)) S ER=1,Y="Invalid channel" Q
"RTN","XML1CRC",7,0)
G2 S XMPROT=$P(^DIC(3.4,XMCHAN,0),U)
"RTN","XML1CRC",8,0)
 F X=1:1:4 S @($P("XMSEN^XMREC^XMOPEN^XMCLOSE",U,X))=$S($D(^(X)):^(X),1:"Q")
"RTN","XML1CRC",9,0)
 Q
"RTN","XML1CRC",10,0)
OP I $D(XMOPEN) X:$L(XMOPEN) XMOPEN
"RTN","XML1CRC",11,0)
 I '$D(XMQUIET) S X=255 X ^%ZOSF("RM")
"RTN","XML1CRC",12,0)
 Q
"RTN","XML1CRC",13,0)
C X ^%ZOSF("EON")
"RTN","XML1CRC",14,0)
 I $D(XMCLOSE) X:$L(XMCLOSE) XMCLOSE
"RTN","XML1CRC",15,0)
 Q
"RTN","XML1CRC",16,0)
SEND ;returns ER(0 OR 1), XMLER=number of "soft" errors
"RTN","XML1CRC",17,0)
 I $L(XMSG)>255 S XMLER=0,ER=1 G SRQ
"RTN","XML1CRC",18,0)
 I XMSG'?.ANP F %=1:1:$L(XMSG) I $E(XMSG,%)?1C,$A(XMSG,%)'=9 S XMSG=$E(XMSG,1,%-1)_$E(XMSG,%+1,999) Q:XMSG?.ANP  S %=%-1
"RTN","XML1CRC",19,0)
 D SRINIT S X=XMSG D SUM
"RTN","XML1CRC",20,0)
 I $G(XMINST) D XMTSTAT^XMTDR(XMINST,"S",XMSG,0) ; 1SCP
"RTN","XML1CRC",21,0)
SL S XMLER=XMLER+1 I (XMLER+1)>XMLMAXER D NEWSTRAT
"RTN","XML1CRC",22,0)
 I ER W XMLERR,$C(13) G SRQ
"RTN","XML1CRC",23,0)
 D BUFLUSH W XMSG,$C(13),XMLINE,U,XMSUM,$C(13) R XMLX:XMLTIME G:XMLX=(XMLINE_U_XMLACK) SRQ
"RTN","XML1CRC",24,0)
 S XMLY=XMLX=(XMLINE_U_XMLNAK),XMLZ=0 D:'XMLY ENQ G SL:XMLY,SRQ
"RTN","XML1CRC",25,0)
ENQ ;ACK/NAK garbled / re-establish contact
"RTN","XML1CRC",26,0)
 S XMLZ=XMLZ+1 I XMLZ>XMLMAXER S (ER,XMLY)=1 Q
"RTN","XML1CRC",27,0)
 D BUFLUSH W XMLENQ,$C(13) R XMLX:XMLTIME Q:XMLX=(XMLINE_U_XMLACK)
"RTN","XML1CRC",28,0)
 I XMLX[XMLACK!(XMLX[XMLNAK),+XMLX=XMLINE!(+XMLX=XMLINE-1) S XMLY=1 Q
"RTN","XML1CRC",29,0)
 H 1 G ENQ
"RTN","XML1CRC",30,0)
REC ;SEE SEND
"RTN","XML1CRC",31,0)
 D SRINIT S:'$D(XMLAN) XMLAN=XMLINE_U_XMLNAK
"RTN","XML1CRC",32,0)
 I $D(XMRG),$G(XMINST) D XMTSTAT^XMTDR(XMINST,"R",XMRG,0) ; 1SCP
"RTN","XML1CRC",33,0)
RL S XMLER=XMLER+1 I (XMLER+1)>XMLMAXER D NEWSTRAT I ER=1 G SRQ
"RTN","XML1CRC",34,0)
 R XMRG#255:$S($D(XMSTIME):XMSTIME,1:XMLTIME)
"RTN","XML1CRC",35,0)
 S XMLZ=$S('$T:-1,XMRG=XMLENQ:0,XMRG=XMLERR:2,1:1)
"RTN","XML1CRC",36,0)
 S ER=XMLZ=2 G:XMLZ>1 SRQ I 'XMLZ D BUFLUSH W XMLAN,$C(13) G RL
"RTN","XML1CRC",37,0)
 R XMLY:XMLTIME I +XMLY=XMLINE S X=XMRG D SUM S XMLZ=XMSUM=$P(XMLY,U,2) G RL2
"RTN","XML1CRC",38,0)
 S XMLZ=0 I +XMLY=(XMLINE-1),XMLINE'=1 D BUFLUSH W +XMLY,U,XMLACK,$C(13) G RL
"RTN","XML1CRC",39,0)
RL2 S XMLAN=XMLINE_U_$S(XMLZ:XMLACK,1:XMLNAK) D BUFLUSH W XMLAN,$C(13)
"RTN","XML1CRC",40,0)
 G SRQ:XMLZ,RL
"RTN","XML1CRC",41,0)
SRINIT ;
"RTN","XML1CRC",42,0)
 S XMLINE=$S('$D(XMLINE):1,1:XMLINE+1),XMLACK="ACK",XMLNAK="NAK"
"RTN","XML1CRC",43,0)
 S XMLENQ=$C(9)_"ENQ"_$C(9),XMLERR=$C(9)_"ERROR"_$C(9)
"RTN","XML1CRC",44,0)
 S XMLER=-1 ;soft error count
"RTN","XML1CRC",45,0)
 S XMLMAXER=5 ;maximum allowable soft errors
"RTN","XML1CRC",46,0)
 S XMLTIME=30 ;length of READ time
"RTN","XML1CRC",47,0)
 S ER=0 ;non-recoverable error flag
"RTN","XML1CRC",48,0)
 Q
"RTN","XML1CRC",49,0)
NEWSTRAT ;machines have various loads
"RTN","XML1CRC",50,0)
 I XMLMAXER=5 S ER=1 Q  ;already tried new strategy, give up.
"RTN","XML1CRC",51,0)
 S XMTLER=$S('$D(XMTLER):XMLER,1:XMTLER+XMLER),XMLER=0 ;add to total
"RTN","XML1CRC",52,0)
 S XMLMAXER=5 ;reduce allowable soft errors
"RTN","XML1CRC",53,0)
 S XMLTIME=30 ;increase the READ time
"RTN","XML1CRC",54,0)
 Q
"RTN","XML1CRC",55,0)
SRQ ;Exit from Send/Receive
"RTN","XML1CRC",56,0)
 S XMTLER=$S('$D(XMTLER):XMLER,1:XMTLER+XMLER) ;Total errors
"RTN","XML1CRC",57,0)
 K XMLACK,XMLNAK,XMLENQ,XMLERR,XMLMAXER,XMLTIME,XMLX,XMLY,XMLZ
"RTN","XML1CRC",58,0)
 Q
"RTN","XML1CRC",59,0)
BUFLUSH ;Flush any characters out of the buffer
"RTN","XML1CRC",60,0)
 Q:'$D(XMBFLUSH)
"RTN","XML1CRC",61,0)
 X ^%ZOSF("TRMON") S X=$P($H,",",2) F %=1:1 R %:0 Q:'$T  S %=$P($H,",",2) S:%<X %=%+86400 Q:%-X>15
"RTN","XML1CRC",62,0)
 X ^%ZOSF("TRMOFF") Q
"RTN","XML1CRC",63,0)
SUM ;Calculate checksum
"RTN","XML1CRC",64,0)
 I '$D(XMOS) D LPC^XMLSWP0
"RTN","XML1CRC",65,0)
 I $D(XMOS(0)) X XMOS(0) S XMSUM=Y Q
"RTN","XML1CRC",66,0)
 I XMOS["VAX DSM" S XMSUM=$ZC(%LPC,X) Q
"RTN","XML1CRC",67,0)
 I XMOS["DSM" S XMSUM=$ZC(LPC,X) Q
"RTN","XML1CRC",68,0)
 I XMOS["M/11"!(XMOS["M/VX") S XMSUM=$ZC(X) Q
"RTN","XML1CRC",69,0)
 S XMSUM=$A(X) Q:$L(X)=1  S I=1
"RTN","XML1CRC",70,0)
A S I=I+1 I $L(X)<I K %,%0,%1 S XMSUM=XMSUM+$L(X)*$L(X) Q
"RTN","XML1CRC",71,0)
 S Y=$A(X,I) F %=256:0 Q:%\4<Y  S %=%\2
"RTN","XML1CRC",72,0)
B S %0=XMSUM#%,%=%\2 G A:%=0 S %0=%0\%,%1=Y\% I %1=1 S Y=Y-%
"RTN","XML1CRC",73,0)
 G B:%1+%0=0 I %1'=%0 S:%0=0 XMSUM=XMSUM+% G B
"RTN","XML1CRC",74,0)
 G B:%0=0 S XMSUM=XMSUM-%
"RTN","XML1CRC",75,0)
 G B
"RTN","XML3")
1^167
"RTN","XML4CRC")
0^220^B19924261
"RTN","XML4CRC",1,0)
XML4CRC ;(WASH ISC)/RFJ-Block Mode Protocol ;03/27/2002  15:47
"RTN","XML4CRC",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XML4CRC",3,0)
SEND ;Sender
"RTN","XML4CRC",4,0)
 S %=1 D PROG G SEND^XML4CRC1:'$D(XMBLOCK)!'$D(J),SEND^XML4CRC1:J<1
"RTN","XML4CRC",5,0)
 S:'$D(XMLBTSUM) XMLBTSUM=0,XML4S(0)=0 I '$D(XML4S)!'$D(XMLBCHR) D SINIT Q:ER  S XMLBER=0
"RTN","XML4CRC",6,0)
 I XMSG'?.ANP S X=XMSG,XMSG="" F %=1:1:$L(X) S:$E(X,%)'?1C!($A(X,%)=9) XMSG=XMSG_$E(X,%)
"RTN","XML4CRC",7,0)
 S XMSG=XMSG_XMLBCHR,X=XMSG D SUM,BUFLUSH
"RTN","XML4CRC",8,0)
 W XMSG,$C(13)
"RTN","XML4CRC",9,0)
 S XMLBTSUM=XMLBTSUM+XMSUM,XMLINE=XMLINE+1,XMLCC=XMLCC+$L(XMSG)
"RTN","XML4CRC",10,0)
 I XMLINE#4=0 H 1
"RTN","XML4CRC",11,0)
 D PAUSE S %=1,XML4S(0)=XML4S(0)+1 I $S(XML4S(0)#XML4S=0:1,'$D(XML4END):0,XMS0AJ'<XML4END:1,1:0) S %=1 D STAT,SCHECK S XMLBTSUM=0,XML4S(0)=0 Q
"RTN","XML4CRC",12,0)
 I '$D(XML4END) S XMLBVAR=$O(^XMB(3.9,XMZ,2,XMS0AJ)) I XMLBVAR<1 D SCHECK S XMLBTSUM=0,XML4S(0)=0
"RTN","XML4CRC",13,0)
 Q
"RTN","XML4CRC",14,0)
SINIT ;
"RTN","XML4CRC",15,0)
 D BLSIZE,LAST I '$D(XMLCC) S XMLCC=0
"RTN","XML4CRC",16,0)
 S XMLBPAUS=1,XMLBNAK="NAK",XMLBACK="ACK",XMLBCHR=$C(42),XMLBCHR1=$C(42)_$C(126),XMLBMER=4,XMLBTIME=90,XMLBTSUM=0,ER=0,XMLBER=0,XMLBCHR2=$C(126)_$C(42)_$C(126),XMLBSTRT="0^0",X="HELO BMP"_U_XMLBMER D SUM
"RTN","XML4CRC",17,0)
SBLSZ S XMLINE=XMLINE+1 W X,XMLBCHR1,XMSUM,$C(13) R %:XMLBTIME
"RTN","XML4CRC",18,0)
 I %[XMLBACK S X=% Q
"RTN","XML4CRC",19,0)
 D SBERROR S XMLBPAUS=XMLBPAUS+10 G SBLSZ:XMLBPAUS<1000 S X=% G ER
"RTN","XML4CRC",20,0)
SCHECK ;Sender check block sum
"RTN","XML4CRC",21,0)
 S XMLINE=XMLINE+1,XMTRAN="Sent Checksum" D T W XMLBCHR2,U,J,U,XMLBTSUM,U,XMLINE,$C(13) R X:XMLBTIME E  G ER
"RTN","XML4CRC",22,0)
 I X[XMLBACK S XMLBER=0,XMLBSTRT=XMS0AJ_U_J D BLSIZE Q
"RTN","XML4CRC",23,0)
 I X[XMLBNAK D ERROR Q:ER  S XMS0AJ=+XMLBSTRT,J=+$P(XMLBSTRT,U,2),XMTRAN="Rec'd NAK" D T S:XML4S>2 XML4S=XML4S\2 Q
"RTN","XML4CRC",24,0)
ER D ER1 Q
"RTN","XML4CRC",25,0)
ER1 N % S %=0
"RTN","XML4CRC",26,0)
ER2 S XMTRAN="Rec'd "_$G(X) D T R X:9 I $T S %=$G(%)+1 I %<99 G ER2:$T
"RTN","XML4CRC",27,0)
 S ER=1 K XMBLOCK Q
"RTN","XML4CRC",28,0)
SBERROR ;
"RTN","XML4CRC",29,0)
 N X D ERROR Q
"RTN","XML4CRC",30,0)
REC ;Receiver
"RTN","XML4CRC",31,0)
 I '$D(XMLBMER) D RINIT S XMLIN=0 Q
"RTN","XML4CRC",32,0)
 I XMLBCHR2_"^"=$E(XMRG,1,4) S %=2 D STAT,RCHECK S XMLBTSUM=0 Q
"RTN","XML4CRC",33,0)
 S X=XMRG D SUM S XMLBTSUM=XMLBTSUM+XMSUM,XMRG=$E(XMRG,1,($L(XMRG)-1)),XMLBMSG=XMRG Q
"RTN","XML4CRC",34,0)
RINIT ;
"RTN","XML4CRC",35,0)
 S XMLBPAUS=0,XMLBER=0,XMLBMER=4,XMLBTIME=15,XMLBNAK="NAK",XMLBACK="ACK",XMLBCHR=$C(42),XMLBCHR1=$C(42)_$C(126),XMLBCHR2=$C(126)_$C(42)_$C(126),XMLBLINE=XMLIN,XMLBTSUM=0,XMLBMSG="",XMLBSTRT=XMLIN-1,XML4S(0)=0,XML4S=0
"RTN","XML4CRC",36,0)
 S X=$P(XMRG,XMLBCHR1,1) D SUM I XMSUM=$P(XMRG,XMLBCHR1,2) S XMLBMER=$P(X,U,2),XMLBER=0 W XMLBACK,$C(13) Q
"RTN","XML4CRC",37,0)
 W XMLBNAK,$C(13) D ERROR K XMLBMER Q
"RTN","XML4CRC",38,0)
RCHECK ;Check block sum
"RTN","XML4CRC",39,0)
 I XMLBTSUM=0,XML4S(0)=0 G REC^XML4CRC1
"RTN","XML4CRC",40,0)
 S XMLINE=$P(XMRG,U,4),XMLIN=XMLIN-1,XMRG=$P(XMRG,U,2,3),X=XMLIN_U_XMLBTSUM I XMRG=X W XMLBACK,$C(13) S XMLBER=0,XMRG=XMLBMSG,XMLBSTRT=XMLIN Q
"RTN","XML4CRC",41,0)
 W XMLBNAK,$C(13) S XMLIN=XMLBSTRT,XMRG=$S($D(^XMB(3.9,XMZ,2,XMLIN,0)):^(0),1:""),XMTRAN="NAK'd block" D ERROR,T Q
"RTN","XML4CRC",42,0)
ERROR ;Log error, new delay factor
"RTN","XML4CRC",43,0)
 D BUFLUSH S XMLBER=XMLBER+1,XMTLER=XMTLER+1 S:XMTLER#XMLBMER=0 XMLBPAUS=XMLBPAUS*2 D:XMLBPAUS>1000 END Q
"RTN","XML4CRC",44,0)
BUFLUSH ;Flush any characters out of the buffer
"RTN","XML4CRC",45,0)
 Q:'$D(XMBFLUSH)
"RTN","XML4CRC",46,0)
 X ^%ZOSF("TRMON") S X=$P($H,",",2) F %=1:1 R %:0 Q:'$T  S %=$P($H,",",2) S:%<X %=%+86400 Q:%-X>15
"RTN","XML4CRC",47,0)
 X ^%ZOSF("TRMOFF") Q
"RTN","XML4CRC",48,0)
PAUSE ;Delay
"RTN","XML4CRC",49,0)
 F %=1:1:XMLBPAUS
"RTN","XML4CRC",50,0)
 Q
"RTN","XML4CRC",51,0)
PROG ;Statistics
"RTN","XML4CRC",52,0)
 S %1=$S(%=1:$S('$D(XMSG):0,1:$L(XMSG)),1:$S($D(XMRG):$L(XMRG),1:0)),XMLCT=$S($D(XMLCT):XMLCT+%1,1:%1)
"RTN","XML4CRC",53,0)
 Q
"RTN","XML4CRC",54,0)
STAT Q:$S('$D(XMINST):1,'$L(XMINST):1,1:0)
"RTN","XML4CRC",55,0)
 S %1=$H_U_$S($D(XMZ):XMZ,1:"")_U_XMLINE_U_$S($D(XMTLER):XMTLER+XMLER-1,1:XMLER-1)_U_$J(XMLCC/($H-XMLBTST*86400+($P($H,",",2)-$P(XMLBTST,",",2))),0,2)_U_IO_" "_XMPROT
"RTN","XML4CRC",56,0)
 S %0=$S($D(^XMBS(4.2999,XMINST,3))#10:^(3),1:""),$P(%0,U,1,6)=%1,^(3)=%0,XMLCT=0,XMLL=XMLINE,XMLT=$P($H,",",2)
"RTN","XML4CRC",57,0)
 K %,%1,%0 Q
"RTN","XML4CRC",58,0)
BLSIZE ;block size
"RTN","XML4CRC",59,0)
 S XML4S=$S($D(XML4S)#10=0:100,XML4S*2<100:XML4S*2,1:100),XML4S(0)=0 Q
"RTN","XML4CRC",60,0)
LAST ;FIND LAST LINE
"RTN","XML4CRC",61,0)
 K XML4END S %=$P(^XMB(3.9,XMZ,2,0),U,3) I '% S %=^(0,0,99999999),%=$P(%,U,$L(%,U)-1)
"RTN","XML4CRC",62,0)
 Q:'$D(^XMB(3.9,XMZ,2,%))  F %=%-1:0 S Y=$O(^(%)) Q:Y=""  S %=Y
"RTN","XML4CRC",63,0)
 S XML4END=% Q
"RTN","XML4CRC",64,0)
SUM ;Calculate Checksum
"RTN","XML4CRC",65,0)
 I '$D(XMOS) D LPC^XMLSWP0
"RTN","XML4CRC",66,0)
 I $D(XMOS(0)) X XMOS(0) Q
"RTN","XML4CRC",67,0)
 I XMOS["VAX DSM" S XMSUM=$ZC(%LPC,X)+$L(X)*$L(X) Q
"RTN","XML4CRC",68,0)
 I XMOS["DSM" S XMSUM=$ZC(LPC,X)+$L(X)*$L(X) Q
"RTN","XML4CRC",69,0)
 I XMOS["M/11"!(XMOS["M/VX") S XMSUM=$ZC(X)+$L(X)*$L(X) Q
"RTN","XML4CRC",70,0)
 S XMSUM=0 Q
"RTN","XML4CRC",71,0)
KILL ;Kill variables
"RTN","XML4CRC",72,0)
 K XMBLOCK,XMLBTSUM,XML4S,XMLBER,XMLBCHR,XMLBCHR1,XMLBCHR2,XMLBVAR,XMLBPAUS,XMLBNAK,XMLBACK,XMLBMER,XMLBTIME,XMLBSTRT,XMLBLINE,XMLBMSG Q
"RTN","XML4CRC",73,0)
END ;Errors/Quit.
"RTN","XML4CRC",74,0)
 G ER
"RTN","XML4CRC",75,0)
T D TRAN^XMC1 Q
"RTN","XML4CRC1")
0^310^B12792269
"RTN","XML4CRC1",1,0)
XML4CRC1 ;(WASH ISC)/RFJ-Block Mode Protocol ;04/17/2002  10:57
"RTN","XML4CRC1",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XML4CRC1",3,0)
OPEN D GET,OP
"RTN","XML4CRC1",4,0)
 S:'$D(XMESC) XMESC=$C(126) S:'$D(XMFS) XMFS=255 S:'$D(XM) XM="" S (XMSSQ,XMRSQ)=1 Q
"RTN","XML4CRC1",5,0)
GET S X=XMCHAN,DIC="^DIC(3.4,",DIC(0)="Z" D ^DIC S XMCHAN=+Y
"RTN","XML4CRC1",6,0)
 I '$D(^DIC(3.4,XMCHAN,0)) S ER=1,Y="Invalid channel" Q
"RTN","XML4CRC1",7,0)
G2 S XMPROT=$P(^DIC(3.4,XMCHAN,0),U,1)
"RTN","XML4CRC1",8,0)
 F X=1:1:4 S @($P("XMSEN^XMREC^XMOPEN^XMCLOSE",U,X))=$S($D(^(X)):^(X),1:"Q")
"RTN","XML4CRC1",9,0)
 Q
"RTN","XML4CRC1",10,0)
OP I $D(XMOPEN) X:$L(XMOPEN) XMOPEN
"RTN","XML4CRC1",11,0)
 I '$D(XMQUIET) S X=255 X ^%ZOSF("RM")
"RTN","XML4CRC1",12,0)
 Q
"RTN","XML4CRC1",13,0)
C X ^%ZOSF("EON")
"RTN","XML4CRC1",14,0)
 I $D(XMCLOSE) X:$L(XMCLOSE) XMCLOSE
"RTN","XML4CRC1",15,0)
 Q
"RTN","XML4CRC1",16,0)
SEND ;Sends XMSG, returns ER=0 or 1, and XMLER=number of "soft" errors
"RTN","XML4CRC1",17,0)
 I $L(XMSG)>255 S XMLER=0,ER=1 G SRQ
"RTN","XML4CRC1",18,0)
 I XMSG'?.ANP S X=XMSG,XMSG="" F %=1:1:$L(X) S:$E(X,%)'?1C!($A(X,%)=9) XMSG=XMSG_$E(X,%)
"RTN","XML4CRC1",19,0)
 D SRINIT S X=XMSG,XMLCC=XMLCC+$L(XMSG) D SUM
"RTN","XML4CRC1",20,0)
SL S XMLER=XMLER+1 I (XMLER+1)>XMLMAXER D NEWSTRAT
"RTN","XML4CRC1",21,0)
 I ER W XMLERR,$C(13) G SRQ
"RTN","XML4CRC1",22,0)
 D BUFLUSH W XMSG,$C(13) W XMLINE,U,XMSUM,$C(13) R XMLX:XMLTIME G:XMLX=(XMLINE_U_XMLACK) SRQ
"RTN","XML4CRC1",23,0)
 S XMLY=XMLX=(XMLINE_U_XMLNAK),XMLZ=0 D:'XMLY ENQ G SL:XMLY,SRQ
"RTN","XML4CRC1",24,0)
ENQ ;Assume the ACK/NAK was garbled by noise and try to re-establish contact
"RTN","XML4CRC1",25,0)
 S XMLZ=XMLZ+1 I XMLZ>XMLMAXER S (ER,XMLY)=1 Q
"RTN","XML4CRC1",26,0)
 D BUFLUSH W XMLENQ,$C(13) R XMLX:XMLTIME Q:XMLX=(XMLINE_U_XMLACK)
"RTN","XML4CRC1",27,0)
 I XMLX[XMLACK!(XMLX[XMLNAK),+XMLX=XMLINE!(+XMLX=XMLINE-1) S XMLY=1 Q
"RTN","XML4CRC1",28,0)
 H 1 G ENQ
"RTN","XML4CRC1",29,0)
REC ;Receives XMRG, returns ER=0 or 1, and XMLER=number of "soft" errors
"RTN","XML4CRC1",30,0)
 D SRINIT S:'$D(XMLAN) XMLAN=XMLINE_U_XMLNAK
"RTN","XML4CRC1",31,0)
RL S XMLER=XMLER+1 I (XMLER+1)>XMLMAXER D NEWSTRAT I ER=1 G SRQ
"RTN","XML4CRC1",32,0)
 R XMRG#255:$S($D(XMSTIME):XMSTIME,1:XMLTIME) S XMLCC=$S('$D(XMLCC):$L(XMRG),1:XMLCC+$L(XMRG)),XMLZ=$S('$T:-1,XMRG=XMLENQ:0,XMRG=XMLERR:2,1:1),%=2
"RTN","XML4CRC1",33,0)
 S %=2 D PROG^XML4CRC I $D(XMLIN),XMLIN'<1 G REC^XML4CRC:XMRG["*"
"RTN","XML4CRC1",34,0)
 S ER=XMLZ=2 G:XMLZ>1 SRQ I XMLZ<1 D BUFLUSH W XMLAN,$C(13) G RL
"RTN","XML4CRC1",35,0)
 R XMLY:XMLTIME I +XMLY=XMLINE S X=XMRG D SUM S XMLZ=XMSUM=$P(XMLY,U,2) G RL2
"RTN","XML4CRC1",36,0)
 S XMLZ=0 I +XMLY=(XMLINE-1),XMLINE'=1 D BUFLUSH W +XMLY,U,XMLACK,$C(13) G RL
"RTN","XML4CRC1",37,0)
RL2 D:$D(XMLBMER) KILL^XML4CRC S XMLAN=XMLINE_U_$S(XMLZ:XMLACK,1:XMLNAK) D BUFLUSH W XMLAN,$C(13)
"RTN","XML4CRC1",38,0)
 G SRQ:XMLZ,RL
"RTN","XML4CRC1",39,0)
SRINIT ;Initialize variables for Send/Receive
"RTN","XML4CRC1",40,0)
 I '$D(XMLBTST) S XMLBTST=+$H_","_($P($H,",",2)-.001),XMLCC=0 ;Time stamp when message started
"RTN","XML4CRC1",41,0)
 S XMLINE=$S('$D(XMLINE):1,1:XMLINE+1),XMLACK="ACK",XMLNAK="NAK"
"RTN","XML4CRC1",42,0)
 S XMLENQ=$C(9)_"ENQ"_$C(9),XMLERR=$C(9)_"ERROR"_$C(9)
"RTN","XML4CRC1",43,0)
 S XMLER=-1 ;soft error count
"RTN","XML4CRC1",44,0)
 S XMLMAXER=5 ;maximum allowable soft errors
"RTN","XML4CRC1",45,0)
 S XMLTIME=10 ;length of READ time
"RTN","XML4CRC1",46,0)
 S ER=0 ;non-recoverable error flag
"RTN","XML4CRC1",47,0)
 Q
"RTN","XML4CRC1",48,0)
NEWSTRAT ;Select new strategy, one or both machines may be slow
"RTN","XML4CRC1",49,0)
 I XMLMAXER=5 S ER=1 Q  ;already tried new strategy, give up.
"RTN","XML4CRC1",50,0)
 S XMTLER=$S('$D(XMTLER):XMLER,1:XMTLER+XMLER),XMLER=0 ;add to total
"RTN","XML4CRC1",51,0)
 S XMLMAXER=5 ;reduce allowable soft errors
"RTN","XML4CRC1",52,0)
 S XMLTIME=30 ;increase the READ time
"RTN","XML4CRC1",53,0)
 Q
"RTN","XML4CRC1",54,0)
SRQ ;Exit from Send/Receive
"RTN","XML4CRC1",55,0)
 S XMTLER=$S('$D(XMTLER):XMLER,1:XMTLER+XMLER) ;Total errors
"RTN","XML4CRC1",56,0)
 K XMLACK,XMLNAK,XMLENQ,XMLERR,XMLMAXER,XMLTIME,XMLX,XMLY,XMLZ
"RTN","XML4CRC1",57,0)
 Q
"RTN","XML4CRC1",58,0)
BUFLUSH ;Flush any characters out of the buffer
"RTN","XML4CRC1",59,0)
 Q:'$D(XMBFLUSH)
"RTN","XML4CRC1",60,0)
 X ^%ZOSF("TRMON") S X=$P($H,",",2) F %=1:1 R %:0 Q:'$T  S %=$P($H,",",2) S:%<X %=%+86400 Q:%-X>15
"RTN","XML4CRC1",61,0)
 X ^%ZOSF("TRMOFF") Q
"RTN","XML4CRC1",62,0)
SUM ;Calculate checksum, accounting also for the character's position
"RTN","XML4CRC1",63,0)
 I '$D(XMOS) D LPC^XMLSWP0
"RTN","XML4CRC1",64,0)
 I $D(XMOS(0)) X XMOS(0) Q
"RTN","XML4CRC1",65,0)
 I XMOS["VAX DSM" S XMSUM=$ZC(%LPC,X)+$L(X)*$L(X) Q
"RTN","XML4CRC1",66,0)
 I XMOS["DSM" S XMSUM=$ZC(LPC,X)+$L(X)*$L(X) Q
"RTN","XML4CRC1",67,0)
 I XMOS["M/11"!(XMOS["M/VX") S XMSUM=$ZC(X)+$L(X)*$L(X) Q
"RTN","XML4CRC1",68,0)
 S XMSUM=0 F %=1:1:$L(X) S XMSUM=XMSUM+($A(X,%)*%)
"RTN","XML4CRC1",69,0)
 Q
"RTN","XML98")
1^168
"RTN","XMLPC")
0^221^B5775025
"RTN","XMLPC",1,0)
XMLPC ;(WASH ISC)/CAP-Protocol 4 PC Platforms ;03/27/2002  15:54
"RTN","XMLPC",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMLPC",3,0)
SEND ;returns ER(0 OR 1), XMLER=number of "soft" errors
"RTN","XMLPC",4,0)
 S (XMLER,XMLZ,XMTLER)=0 I $L(XMSG)>255 S ER=1 G SRQ
"RTN","XMLPC",5,0)
 I XMSG'?.ANP F %=1:1:$L(XMSG) I $E(XMSG,%)?1C,$A(XMSG,%)'=9 S XMSG=$E(XMSG,1,%-1)_$E(XMSG,%+1,999) Q:XMSG?.ANP  S %=%-1
"RTN","XMLPC",6,0)
 D SRINIT S X=XMSG D SUM
"RTN","XMLPC",7,0)
 I $G(XMINST) D XMTSTAT^XMTDR(XMINST,"S",XMSG,0) ; PC1
"RTN","XMLPC",8,0)
SL S XMLER=XMLER+1 I XMLER>XMLMAXER S ER=1 G SRQ
"RTN","XMLPC",9,0)
 W "~*~^",$C(13),XMSG,$C(13),XMLINE,U,XMSUM,$C(13)
"RTN","XMLPC",10,0)
SA R XMLX:XMLTIME I XMLX?.E1"ACK" W XMLX_$C(13) G SRQ:XMLX-XMLINE=0,SA
"RTN","XMLPC",11,0)
 S XMLZ=XMLZ+1 I XMLZ>XMLMAXER S ER=1 G SRQ
"RTN","XMLPC",12,0)
 G SL
"RTN","XMLPC",13,0)
REC ;SEE SEND
"RTN","XMLPC",14,0)
 D SRINIT
"RTN","XMLPC",15,0)
 I $D(XMRG),$G(XMINST) D XMTSTAT^XMTDR(XMINST,"R",XMRG,0) ; PC1
"RTN","XMLPC",16,0)
RL S XMLER=XMLER+1 I XMLER>XMLMAXER S ER=1 G SRQ
"RTN","XMLPC",17,0)
 R X:XMLTIME I X'="~*~^" G RL
"RTN","XMLPC",18,0)
 R XMRG#255:$S($D(XMSTIME):XMSTIME,1:XMLTIME)
"RTN","XMLPC",19,0)
 I $E(XMRG,1,5)=" ~*~^" S XMRG=$E(XMRG,2,$L(XMRG))
"RTN","XMLPC",20,0)
 R XMLY:XMLTIME
"RTN","XMLPC",21,0)
 I +XMLY-XMLINE<0 S X=$$ACK(+XMLY_"ACK") G RL
"RTN","XMLPC",22,0)
 S X=XMRG D SUM S XMLZ=XMSUM=$P(XMLY,U,2)
"RTN","XMLPC",23,0)
 S X=$$ACK(XMLINE_"ACK"),(XMLER,XMTLER)=0
"RTN","XMLPC",24,0)
 G SRQ:X=1 S ER=1 G SRQ
"RTN","XMLPC",25,0)
ACK(Y) N X,I S I=0
"RTN","XMLPC",26,0)
AA S I=I+1 I I>30 Q 0
"RTN","XMLPC",27,0)
 W Y_$C(13) R X:XMLTIME
"RTN","XMLPC",28,0)
 G AA:X'=Y
"RTN","XMLPC",29,0)
 Q 1
"RTN","XMLPC",30,0)
SRINIT ;
"RTN","XMLPC",31,0)
 S XMLINE=$S('$D(XMLINE):1,1:XMLINE+1)
"RTN","XMLPC",32,0)
 S XMLENQ=$C(9)_"ENQ"_$C(9),XMLERR=$C(9)_"ERROR"_$C(9)
"RTN","XMLPC",33,0)
 S XMLER=-1 ;soft error count
"RTN","XMLPC",34,0)
 S XMLMAXER=500 ;maximum allowable soft errors
"RTN","XMLPC",35,0)
 S XMLTIME=9 ;length of READ time
"RTN","XMLPC",36,0)
 S ER=0 ;non-recoverable error flag
"RTN","XMLPC",37,0)
 Q
"RTN","XMLPC",38,0)
SRQ ;Exit from Send/Receive
"RTN","XMLPC",39,0)
 S XMTLER=$S('$D(XMTLER):XMLER,1:XMTLER+XMLER) ;Total errors
"RTN","XMLPC",40,0)
 K XMLERR,XMLMAXER,XMLTIME,XMLX,XMLY,XMLZ
"RTN","XMLPC",41,0)
 Q
"RTN","XMLPC",42,0)
SUM ;Calculate checksum
"RTN","XMLPC",43,0)
 I '$D(XMOS) D LPC^XMLSWP0
"RTN","XMLPC",44,0)
 I $D(XMOS(0)) X XMOS(0) S XMSUM=Y Q
"RTN","XMLPC",45,0)
 S XMSUM=$A(X) Q:$L(X)=1  S I=1
"RTN","XMLPC",46,0)
A S I=I+1 I $L(X)<I K %,%0,%1 S XMSUM=XMSUM+$L(X)*$L(X) Q
"RTN","XMLPC",47,0)
 S Y=$A(X,I) F %=256:0 Q:%\4<Y  S %=%\2
"RTN","XMLPC",48,0)
B S %0=XMSUM#%,%=%\2 G A:%=0 S %0=%0\%,%1=Y\% I %1=1 S Y=Y-%
"RTN","XMLPC",49,0)
 G B:%1+%0=0 I %1'=%0 S:%0=0 XMSUM=XMSUM+% G B
"RTN","XMLPC",50,0)
 G B:%0=0 S XMSUM=XMSUM-%
"RTN","XMLPC",51,0)
 G B
"RTN","XMLPC",52,0)
OPEN ;SET DEVICE PARAMETERS
"RTN","XMLPC",53,0)
 N X S X=$G(^%ZOSF("OS")) I X["VAX" S X=0 X ^%ZOSF("RM") U IO:PACK
"RTN","XMLPC",54,0)
 I X["DTM" U IO:WRAP=0
"RTN","XMLPC",55,0)
 Q
"RTN","XMLSTAT")
1^218
"RTN","XMLSWP")
0^311^B10276184
"RTN","XMLSWP",1,0)
XMLSWP ;(WASH ISC)/CAP-Sliding Window Protocol ;04/17/2002  10:58
"RTN","XMLSWP",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMLSWP",3,0)
SEND ;
"RTN","XMLSWP",4,0)
 S X=1 G I^XMLSWP0
"RTN","XMLSWP",5,0)
1 ;I $L(XMSG)>245 G E
"RTN","XMLSWP",6,0)
 I XMSG'?.ANP F %=1:1:$L(XMSG) I $E(XMSG,%)?1C,$A(XMSG,%)'=9 S XMSG=$E(XMSG,1,%-1)_$E(XMSG,%+1,999) Q:XMSG?.ANP  S %=%-1
"RTN","XMLSWP",7,0)
 S C=C+$L(XMSG),F=0 I G S A=A+1,XMLIN=$S(J<1:"",1:XMLIN\1+1),(M,B(1))=0,XMLCT=$S($D(XMLCT):XMLCT+$L(XMSG),1:$L(XMSG))
"RTN","XMLSWP",8,0)
D S I=$S('G:"",1:XMLIN),X=XMSG D SUM S Q=I_U_S_"^~^^"_$S(XMSG=".":"<<END~OF~FILE>>",1:"") D CHK S $P(Q,U,4)=S
"RTN","XMLSWP",9,0)
 W X_$C(13),Q_$C(13) S D=X X P("S")
"RTN","XMLSWP",10,0)
 I G,I'="" S W(I,0)=J,W(I,1)=$P(Q,U,2),W(I,2)=Q
"RTN","XMLSWP",11,0)
 I $D(XMINST),$L(XMINST),$S(I<100&(I#20=0):1,I#100=0:1,I<1:1,B(1):1,'J:1,1:0) D PROGS^XMLSWP2
"RTN","XMLSWP",12,0)
 ;
"RTN","XMLSWP",13,0)
C G Q:$S(ER:1,1:0) I G,$D(XMLIN),XMLIN G W
"RTN","XMLSWP",14,0)
2 I G,XMLIN,'$O(W(0)) G Q:J<1!'J,W
"RTN","XMLSWP",15,0)
 R X:$S('$D(XMLIN):30,XMLIN="":30,'G:30,W<8:9,1:5) E  S:M M=2 G U:'$L(X)
"RTN","XMLSWP",16,0)
 I X'?.".".N1"^"1N.N1"^~".E G:'G 1:X="!@~^NAK^~@!",C S G=G+1 G C:G<3,W
"RTN","XMLSWP",17,0)
 S D=X,$P(X,U,4)="" D SUM S X=D I S'=$P(X,U,4) G G:G S F=F+1 G 2:F<9,QQQ
"RTN","XMLSWP",18,0)
 S B=0 I X?1"!@~^"1N.N1"^~@!^"1N.N1"^Resynch" S D=X,B=0 X P("R") S Y=X G G2
"RTN","XMLSWP",19,0)
 I $S('$D(XMLIN):1,XMLIN="":1,'G:1,1:0) G Q:X=Q S F=F+1 G 2:F<9,QQQ
"RTN","XMLSWP",20,0)
3 I '$D(W(+X)) G G9:M="END",W
"RTN","XMLSWP",21,0)
 I W(+X,1)-$P(X,U,2)'=0 S D="BAD Acknowledgement" X P("I") G R
"RTN","XMLSWP",22,0)
 I $O(W(0))=+X D K S G=1 G G9:M="END",W:'M,C
"RTN","XMLSWP",23,0)
 I $D(W(+X)) D K S G=G+1 S:W<G W=$S(W-4>6:W-4,W>6:6,1:W),V=0 G G:W<G I W*2<G S G=1 G R
"RTN","XMLSWP",24,0)
 I $O(W(0)) S G=G+1 G G9:M="END",G:'M,C:M=1 I W*2<G S G=1 G G
"RTN","XMLSWP",25,0)
W I $S(W<5&(W*2<A):1,W/2+W<A:1,1:0) G 2
"RTN","XMLSWP",26,0)
 I $D(Z),$P(Z,U)="@" G G9:Z="@^1" S M=0,Z=Z_"^1" G G9
"RTN","XMLSWP",27,0)
 S J=$O(^XMB(3.9,XMZ,2,J)) I J S XMSG=^(J,0) G 1:$E(XMSG)'="." S XMSG="."_XMSG G 1
"RTN","XMLSWP",28,0)
 S Z="@" G C
"RTN","XMLSWP",29,0)
E D E^XMLSWP0
"RTN","XMLSWP",30,0)
QQQ G QQQ^XMLSWP2
"RTN","XMLSWP",31,0)
QQ G QQ^XMLSWP2
"RTN","XMLSWP",32,0)
Q G Q^XMLSWP2
"RTN","XMLSWP",33,0)
R G R^XMLSWP2
"RTN","XMLSWP",34,0)
 ;ACK
"RTN","XMLSWP",35,0)
K S V=V+1 I $D(W(+X)) S A=A-1 K W(+X)
"RTN","XMLSWP",36,0)
 Q:$S(W<5&(W*2>V):1,W>4&(W*3>V):1,1:0)
"RTN","XMLSWP",37,0)
 S V=0 I $D(IOST),$E(IOST,1,6)="C-MINI" S W=$S(W<8:8,W<9:10,W<12:12,1:W)
"RTN","XMLSWP",38,0)
 E  S W=$S(W<4:4,1:5)
"RTN","XMLSWP",39,0)
 Q
"RTN","XMLSWP",40,0)
 ;Timeout
"RTN","XMLSWP",41,0)
U S B(1)=B(1)+1,D="Time-out ["_B(1)_"]" X P("I") I B(1)<$S(G:4,1:2) G:'$O(W(0)) W:G,D S I=XMLIN G R:A>W,W:G,D
"RTN","XMLSWP",42,0)
 G E
"RTN","XMLSWP",43,0)
CHK N X S X=Q
"RTN","XMLSWP",44,0)
SUM ;Calculate S=checksum
"RTN","XMLSWP",45,0)
 I $D(XMOS(0)) X XMOS(0) S S=XMSUM Q
"RTN","XMLSWP",46,0)
 I XMOS["VAX DSM" S S=$ZC(%LPC,X)+$L(X)*$L(X) Q
"RTN","XMLSWP",47,0)
 I XMOS["DSM" S S=$ZC(LPC,X)+$L(X)*$L(X) Q
"RTN","XMLSWP",48,0)
 I XMOS["M/11"!(XMOS["M/VX") S S=$ZC(X)+$L(X)*$L(X) Q
"RTN","XMLSWP",49,0)
 G ZSUM^XMLSWP0
"RTN","XMLSWP",50,0)
 ;RE-SYNCH Sender
"RTN","XMLSWP",51,0)
G S (B,XMLSWPQ,M)=0 I M,'$O(W(0)) G W
"RTN","XMLSWP",52,0)
 I M'=1 G W:'$O(W(0)) S M=1 G 2
"RTN","XMLSWP",53,0)
G0 S XMLSWPQ=$G(XMLSWPQ)+1 R Y:(9+B) G:'$T G9:XMLSWPQ>20,G0 K XMLSWPQ I B>$S(M:3,1:33) G Q:'M,E
"RTN","XMLSWP",54,0)
 G G9:'$L(Y) S D=Y X P("R") I Y="A-OK" R Y:(9+B) G G9:Y="",G9:Y'="^432^~" F D=0:0 R Y:4 E  G R:$O(W(0)),QQ
"RTN","XMLSWP",55,0)
 G G1:Y?1"!@~^"1N.N1"^~@!^"1N.N1"^Resynch" I 'M S M=0 G G9:'$O(W(0)) S X=Y,M="END" G 3
"RTN","XMLSWP",56,0)
 G W:Y=O,G9
"RTN","XMLSWP",57,0)
G1 S (D,X)=Y,$P(X,U,4)="" D SUM G G9:S'=$P(D,U,4)
"RTN","XMLSWP",58,0)
G2 S D="Rec'r reqests "_$P(Y,U,2) X P("I") S B=0 G R:$O(W(0)),QQQ
"RTN","XMLSWP",59,0)
G9 S (D,X)=O,B=B+1 D SUM S X=U_S_"^~^^@@<<Ctrl-Packet>>" D SUM S $P(X,U,4)=S W O_$C(13)_X_$C(13) X P("S")
"RTN","XMLSWP",60,0)
 G G0
"RTN","XMLSWP0")
0^312^B10066868
"RTN","XMLSWP0",1,0)
XMLSWP0 ;(WASH ISC)/CAP-Sliding Window Protocol ;04/17/2002  10:59
"RTN","XMLSWP0",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMLSWP0",3,0)
REC ;SEE SEND
"RTN","XMLSWP0",4,0)
 S X=0 G I
"RTN","XMLSWP0",5,0)
RL ;
"RTN","XMLSWP0",6,0)
 R X:$S($D(XMSTIME):XMSTIME,1:15) S Z=$T,(XMRG,D)=X X P("R")
"RTN","XMLSWP0",7,0)
 I 'Z S B=B+1 G RL:B<3 S B=0,B(0)=$S($D(B(0)):B(0)+1,1:1) G:B(0)<4&G F:'M,RL D E G ER
"RTN","XMLSWP0",8,0)
 S (B,B(0))=0
"RTN","XMLSWP0",9,0)
Y S L=X D SUM I $D(XMLIN),XMLIN>1,X?1"..".E S (XMRG,X)=$E(X,2,999)
"RTN","XMLSWP0",10,0)
 R W:15 E  S B=B+1 G RL
"RTN","XMLSWP0",11,0)
 G Z:L'=".",Z:$P(W,U,2)'=47,Z:$P(W,U,5)'="<<END~OF~FILE>>"
"RTN","XMLSWP0",12,0)
 S (D,V)=1,F=0 I $O(W(0)) G F
"RTN","XMLSWP0",13,0)
V S XMRG="." K XMBLOCK F XMLIN=XMLIN+1:1 Q:'$D(^XMB(3.9,XMZ,2,XMLIN))
"RTN","XMLSWP0",14,0)
 D SEND Q:D  S F=F+1 G ER
"RTN","XMLSWP0",15,0)
Z S D=0 I W'?.".".N1"^"1N.N1"^~".E S (XMRG,X)=W G Y
"RTN","XMLSWP0",16,0)
 I S-$P(W,U,2)=0 S D=1 D SEND
"RTN","XMLSWP0",17,0)
 I D,L=O G F:$P(W,"@@",2)="<<Ctrl-Packet>>"
"RTN","XMLSWP0",18,0)
 I 'D G F:G S F=F+1,ER=1 Q:F>3  W "!@~^NAK^~@!",$C(13) S ER=0 G RL
"RTN","XMLSWP0",19,0)
 Q:'$D(XMLIN)!'+W  Q:XMLIN=0  S M=$S(L="QUIT":99,1:0),F=0
"RTN","XMLSWP0",20,0)
 I XMLIN>1,XMLIN+1-W'=0,W-XMLIN>0 F D=W-1:-1 Q:D<1!$D(^XMB(3.9,XMZ,2,D,0))  S W(D)=""
"RTN","XMLSWP0",21,0)
 S D=$S(1-W>0:XMLIN+.001,1:+W) S:D-XMLIN>0 XMLIN=+W K W(+W) I '$D(^XMB(3.9,XMZ,2,D,0)) S ^(0)=XMRG,C=C+$L(XMRG)
"RTN","XMLSWP0",22,0)
 I $D(XMINST),$L(XMINST) S I=XMLIN D P
"RTN","XMLSWP0",23,0)
 G W:XMLIN#10'=0,W:'$O(W(0)) D E S D="Didn't receive "_$O(W(0)) X P("I")
"RTN","XMLSWP0",24,0)
 G F
"RTN","XMLSWP0",25,0)
W G RL:'V,F:$O(W(0)),V
"RTN","XMLSWP0",26,0)
 ;
"RTN","XMLSWP0",27,0)
 ;QUIT control
"RTN","XMLSWP0",28,0)
E S F=F+1 S D="Errors ("_F_")" X P("I") Q
"RTN","XMLSWP0",29,0)
 Q
"RTN","XMLSWP0",30,0)
SUM ;Calculate S=checksum
"RTN","XMLSWP0",31,0)
 I $D(XMOS(0)) X XMOS(0) S S=XMSUM Q
"RTN","XMLSWP0",32,0)
 I XMOS["VAX DSM" S S=$ZC(%LPC,X)+$L(X)*$L(X) Q
"RTN","XMLSWP0",33,0)
 I XMOS["DSM" S S=$ZC(LPC,X)+$L(X)*$L(X) Q
"RTN","XMLSWP0",34,0)
 I XMOS["M/11"!(XMOS["M/VX") S S=$ZC(X)+$L(X)*$L(X) Q
"RTN","XMLSWP0",35,0)
ZSUM S S=$A(X) Q:$L(X)=1  N J S J=1
"RTN","XMLSWP0",36,0)
A S J=J+1 I $L(X)<J K %,%0,%1 S S=S+$L(X)*$L(X) Q
"RTN","XMLSWP0",37,0)
 S Y=$A(X,J) F %=256:0 Q:%\4<Y  S %=%\2
"RTN","XMLSWP0",38,0)
B S %0=S#%,%=%\2 G A:%=0 S %0=%0\%,%1=Y\% I %1=1 S Y=Y-%
"RTN","XMLSWP0",39,0)
 G B:%1+%0=0 I %1'=%0 S:%0=0 S=S+% G B
"RTN","XMLSWP0",40,0)
 G B:%0=0 S S=S-%
"RTN","XMLSWP0",41,0)
 G B
"RTN","XMLSWP0",42,0)
P N G S G=1,XMLCT=$S($D(XMLCT):XMLCT+$L(XMRG),1:$L(XMRG)) Q:$S(XMLIN<100&(XMLIN#20'=0):1,XMLIN#100'=0:1,1:0)  G PROGR^XMLSWP2
"RTN","XMLSWP0",43,0)
I ;Initialize
"RTN","XMLSWP0",44,0)
 N %,A,B,C,D,E,F,G,I,L,M,O,P,Q,S,T,Y,Z
"RTN","XMLSWP0",45,0)
 I $D(XMS0AJ),XMS0AJ<1 N J S (XMLIN,J)=XMS0AJ
"RTN","XMLSWP0",46,0)
 F I=73,83,82 S P($C(I))="I $D(XMLD) S XMTRAN="_$C(34,I,58,32,34)_"_$E(D,1,240) D TRAN^XMLSWP2"
"RTN","XMLSWP0",47,0)
 K Z,W,M S ER=0,(A,B,B(0),B(1),C,E,F,G,M,Q,V)=0,(I,L)="",O="!@~^Resynch^~@!1545",W=$S($E(IOST,1,6)="C-MINI":2,1:1)*3,T=$H*86400+$P($H,",",2)-1
"RTN","XMLSWP0",48,0)
 I $D(XMBLOCK) G ER:'$D(XMS0AJ) S G=1,XMLIN=$S('$D(XMLIN):0,1:XMLIN),J=XMS0AJ G ER:XMTLER
"RTN","XMLSWP0",49,0)
 D LPC:'$D(XMOS) G 1^XMLSWP:X,RL
"RTN","XMLSWP0",50,0)
 ;
"RTN","XMLSWP0",51,0)
 ;RE-SYNCH Receiver
"RTN","XMLSWP0",52,0)
F I '$O(W(0)) W "A-OK"_$C(13)_"^432^~"_$C(13) G RL
"RTN","XMLSWP0",53,0)
 S (B(0),B)=0,M=50
"RTN","XMLSWP0",54,0)
 S (D,X)="!@~^"_+$O(W(0))_"^~@!^^Resynch" D SUM S $P(D,U,4)=S W D,$C(13) X P("S")
"RTN","XMLSWP0",55,0)
 G RL
"RTN","XMLSWP0",56,0)
ER S ER=1 Q
"RTN","XMLSWP0",57,0)
SEND S X=W,$P(X,U,4)="" D SUM I S=$P(W,U,4) Q:$P(W,"@@",2)="<<Ctrl-Packet>>"  W W_$C(13) Q
"RTN","XMLSWP0",58,0)
 S D=0 Q
"RTN","XMLSWP0",59,0)
LPC ;GET CORRECT LPC checksum information
"RTN","XMLSWP0",60,0)
 S XMOS=$S($D(^%ZOSF("OS")):^("OS"),1:0) I $D(^("LPC")) S XMOS(0)=^("LPC")
"RTN","XMLSWP0",61,0)
 I '$D(XMOS(0)),$D(^XMB(1,1,"LPC")) S XMOS(0)=^("LPC")
"RTN","XMLSWP0",62,0)
 I $D(XMOS(0)) S XMOS(0)=XMOS(0)_",XMSUM=Y+$L(X)*$L(X)"
"RTN","XMLSWP0",63,0)
 Q
"RTN","XMLSWP2")
0^222^B4108377
"RTN","XMLSWP2",1,0)
XMLSWP2 ;(WASH ISC)/CAP-Sliding Window Protocol ;04/17/2002  10:59
"RTN","XMLSWP2",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMLSWP2",3,0)
TRAN Q:$S('$D(XM):1,XM'["D":1,1:0)  N I,X,Y,% S X=$P($H,",",2),Y=X\3600_":"_$J(X#3600\60,2)_":"_$J(X#60,2) F I=1:1 Q:Y'[" "  S Y=$P(Y," ")_0_$P(Y," ",2,4)
"RTN","XMLSWP2",4,0)
 S %=$E(Y_" ",1,$L(XMTRAN)<245*99),%=%_$E(XMTRAN,1,245-$L(%)) U IO(0) W !,% I IO'="" U IO
"RTN","XMLSWP2",5,0)
 Q
"RTN","XMLSWP2",6,0)
PROG ;Statistics
"RTN","XMLSWP2",7,0)
 I '$D(T) S T=$H*86400+$P($H,",",2)-1
"RTN","XMLSWP2",8,0)
 N D,X S D=$S($D(^XMBS(4.2999,XMINST,3))#10:^(3),1:""),$P(D,U,1,6)=$H_U_$S($D(XMZ):XMZ,1:"")_U_I_U_E_U_$J(C/($H*86400+$P($H,",",2)-T),0,2)_U_IO_" SWP" S ^(3)=D,XMLCT=0
"RTN","XMLSWP2",9,0)
 Q:$S('$D(XMLIN):1,XMLIN="":1,'G:1,1:0)
"RTN","XMLSWP2",10,0)
 S D="Line: "_$P(D,U,3)_", Speed: "_$P(D,U,5) Q:$S('$D(W):1,+W'=W:1,1:0)
"RTN","XMLSWP2",11,0)
 S D=D_", Window: "_W_", Out: ",A=0
"RTN","XMLSWP2",12,0)
 F X=0:0 S X=$O(W(X)),A=A+1 I '$O(W(X)) S D=D_$O(W(0))_"/"_X Q
"RTN","XMLSWP2",13,0)
 S D=D_", Status: "_G_"/"_E X P("I")
"RTN","XMLSWP2",14,0)
 Q
"RTN","XMLSWP2",15,0)
PROGS N % S %=1 G PROG
"RTN","XMLSWP2",16,0)
PROGR N % S %=2 G PROG
"RTN","XMLSWP2",17,0)
QQQ S ER=F>9,E=E+1 R X:4 G Q:'$T,QQQ
"RTN","XMLSWP2",18,0)
QQ K W S ER=0
"RTN","XMLSWP2",19,0)
Q K XMLSWPQ S:$D(XMBLOCK) XMS0AJ=J G:'ER R:$O(W(0)) S XMTLER=$S('$D(XMTLER):E,1:XMTLER+E) G U:ER
"RTN","XMLSWP2",20,0)
 S:$O(W(0)) XMS0AJ=$O(W(0))-.000001
"RTN","XMLSWP2",21,0)
 I G,$D(Z),$P(Z,U)="@" S XMS0AJ="@"
"RTN","XMLSWP2",22,0)
U K W,Y Q:'ER  K XMBLOCK Q
"RTN","XMLSWP2",23,0)
R S X=$O(W(0)),V=0,W=$S(W-4>6:W-4,W>6:6,1:W),E=E+1 D E^XMLSWP0 G QQQ:E>199 I 'X S A=0 G W^XMLSWP
"RTN","XMLSWP2",24,0)
 S %X=^XMB(3.9,XMZ,2,W(X,0),0) I $E(%X)="." S %X="."_%X
"RTN","XMLSWP2",25,0)
 W %X,$C(13),W(X,2),$C(13) S (ER,F)=0,D="Retransmit line "_X X P("S")
"RTN","XMLSWP2",26,0)
 K %X H 3 G 2^XMLSWP
"RTN","XMLTCP")
0^44^B4491324
"RTN","XMLTCP",1,0)
XMLTCP ;(WASH ISC)/CAP-TCP/IP to MailMan ;07/23/2002  06:54
"RTN","XMLTCP",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMLTCP",3,0)
 ; modified to run with MSM NT and Protocol TCP/IP-MAILMAN (file 3.4)
"RTN","XMLTCP",4,0)
SEND ;returns ER(0 OR 1), XMLER=number of "soft" errors
"RTN","XMLTCP",5,0)
 I $$NEWERR^%ZTER N $ETRAP,$ESTACK S $ETRAP="D C^XMCTRAP"
"RTN","XMLTCP",6,0)
 E  S X="C^XMCTRAP",@^%ZOSF("TRAP")
"RTN","XMLTCP",7,0)
 I $G(XMINST) D XMTSTAT^XMTDR(XMINST,"S",XMSG,1)
"RTN","XMLTCP",8,0)
 W XMSG,$C(13,10),!
"RTN","XMLTCP",9,0)
 Q
"RTN","XMLTCP",10,0)
REC ;Receive a line (must keep buffer / lines divided by LF)
"RTN","XMLTCP",11,0)
 I $$NEWERR^%ZTER N $ETRAP,$ESTACK S $ETRAP="D C^XMCTRAP"
"RTN","XMLTCP",12,0)
 E  S X="C^XMCTRAP",@^%ZOSF("TRAP")
"RTN","XMLTCP",13,0)
 ;Return line if read last time
"RTN","XMLTCP",14,0)
RE G R:XMLTCP[$C(10) S %=255-$L(XMLTCP) G R:%<1
"RTN","XMLTCP",15,0)
 ;Insure can clean up if line dropped, etc.
"RTN","XMLTCP",16,0)
 I $S(XMOS["VAX":1,+$G(XMOS("MSMVER"))<8:1,XMOS["OpenM-NT":1,1:0) R X#$S(%:%,1:1):$G(XMSTIME,160) G RE2
"RTN","XMLTCP",17,0)
 ;Compliant with M standard
"RTN","XMLTCP",18,0)
 R X:$G(XMSTIME,60)
"RTN","XMLTCP",19,0)
 ;
"RTN","XMLTCP",20,0)
RE2 I '$T,"."_$C(10)'=XMLTCP S XMRG="" D ERTRAN^XMC1("Receiver timed out") Q
"RTN","XMLTCP",21,0)
 I X="" S ER=ER+.1 S:ER=1 XMRG="" Q:ER=1  H 1 G RE
"RTN","XMLTCP",22,0)
 S XMLTCP=XMLTCP_X I XMLTCP'[$C(10) G RE
"RTN","XMLTCP",23,0)
R S %=$F(XMLTCP,$C(10))
"RTN","XMLTCP",24,0)
 ;
"RTN","XMLTCP",25,0)
 ;Strip out LF (and CR, if present)
"RTN","XMLTCP",26,0)
 I %,%<256 S XMRG=$E(XMLTCP,1,%-3+($A(XMLTCP,%-2)'=13)),XMLTCP=$E(XMLTCP,%,$L(XMLTCP)) G RQ
"RTN","XMLTCP",27,0)
 ;
"RTN","XMLTCP",28,0)
 ;Line too long or doesn't contain a Line Feed, return first 255 chars.
"RTN","XMLTCP",29,0)
 S XMRG=$E(XMLTCP,1,255),XMLTCP=$E(XMLTCP,256,$L(XMLTCP))
"RTN","XMLTCP",30,0)
 ;S:$E(XMLTCP)="." XMLTCP="."_XMLTCP
"RTN","XMLTCP",31,0)
 ;
"RTN","XMLTCP",32,0)
RQ I $L(XMRG),$C(13,10)[$E(XMRG) S XMRG=$E(XMRG,2,$L(XMRG)) G RQ
"RTN","XMLTCP",33,0)
 I $G(XMINST) D XMTSTAT^XMTDR(XMINST,"R",XMRG)
"RTN","XMLTCP",34,0)
 Q
"RTN","XMLTCP",35,0)
SNDGTM ; Send for GT.M
"RTN","XMLTCP",36,0)
 I $$NEWERR^%ZTER N $ETRAP,$ESTACK S $ETRAP="D C^XMCTRAP"
"RTN","XMLTCP",37,0)
 E  S X="C^XMCTRAP",@^%ZOSF("TRAP")
"RTN","XMLTCP",38,0)
 I $G(XMINST) D XMTSTAT^XMTDR(XMINST,"S",XMSG,1)
"RTN","XMLTCP",39,0)
 W XMSG,$C(13,10),#
"RTN","XMLTCP",40,0)
 Q
"RTN","XMLTCP",41,0)
RECGTM ; Receive for GT.M
"RTN","XMLTCP",42,0)
 I $$NEWERR^%ZTER N $ETRAP,$ESTACK S $ETRAP="D C^XMCTRAP"
"RTN","XMLTCP",43,0)
 E  S X="C^XMCTRAP",@^%ZOSF("TRAP")
"RTN","XMLTCP",44,0)
 R XMRG:$G(XMSTIME,60)
"RTN","XMLTCP",45,0)
 I '$T S XMRG="" D ERTRAN^XMC1("Receiver timed out") Q
"RTN","XMLTCP",46,0)
 S XMRG=$TR(XMRG,$C(10,12,13))
"RTN","XMLTCP",47,0)
 I $G(XMINST) D XMTSTAT^XMTDR(XMINST,"R",XMRG)
"RTN","XMLTCP",48,0)
 Q
"RTN","XMM1")
0^313^B7787825
"RTN","XMM1",1,0)
XMM1 ;(WASH ISC)/THM-MODEM CONTROL VADIC 3451, MICROCOM PCS 2000 ;7/10/89  12:44 ;
"RTN","XMM1",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMM1",3,0)
 Q
"RTN","XMM1",4,0)
PCS2000 ;MICROCOM PCS 2000
"RTN","XMM1",5,0)
DIAL ;DIAL NUMBER IN <XMPHONE>, MODEM'S RESPONSE IN Y, ER=0/1 FOR CONNECT/NO CONNECT
"RTN","XMM1",6,0)
 S ER=1 W "D ",XMPHONE,! R Y:35,Y:3
"RTN","XMM1",7,0)
 S:Y["CONNECT " ER=0 Q
"RTN","XMM1",8,0)
HANG ;HANG UP PHONE
"RTN","XMM1",9,0)
 W *2,! R Z:1 W "H",! R Y:1,Y:1,Z:1 S ER=Z'["NO CONN" Q
"RTN","XMM1",10,0)
 Q
"RTN","XMM1",11,0)
 ;
"RTN","XMM1",12,0)
RESET S X=1 ;RESET MODEM
"RTN","XMM1",13,0)
R W "4" H 1 W "5" H 1 W "SE2",! R Z:2,Y:2 S ER=Y'="!" Q:'ER
"RTN","XMM1",14,0)
 S X=X+1 Q:X>2  D HANG G R
"RTN","XMM1",15,0)
 ;
"RTN","XMM1",16,0)
STAT ;STATUS OF MODEM
"RTN","XMM1",17,0)
 S Y="no status report",ER=0 Q
"RTN","XMM1",18,0)
VADIC ;VADIC 3451 (NEEDS HELP HANGING UP)
"RTN","XMM1",19,0)
 ;
"RTN","XMM1",20,0)
DIAL3451 S ER=1 W *5,*13 R Y:2 H 1 W "D",*13 R Y:2 Q:Y'["*"  H 1 W XMPHONE,*13 H 2 W *13 R Y:1,Y:60 S:Y["ONLINE" ER=0 Q
"RTN","XMM1",21,0)
HANG3451 Q
"RTN","XMM1",22,0)
STAT3451 S Y="no status report",ER=0 Q
"RTN","XMM1",23,0)
 ;
"RTN","XMM1",24,0)
 ;HAYES SMART MODEM 1200 LOGIC
"RTN","XMM1",25,0)
 ;
"RTN","XMM1",26,0)
DHAYES D CLEAR U IO S ER=1 W "ATDT",XMPHONE,! F %=1:1:5 U IO R Y:10 Q:Y["CONNECT"
"RTN","XMM1",27,0)
 Q:Y'["CONNECT"
"RTN","XMM1",28,0)
 S ER=0 Q
"RTN","XMM1",29,0)
HHAYES D CLEAR U IO H 2 W "+++" H 2 W "ATH0",! H 2 D CLEAR S ER=0 Q
"RTN","XMM1",30,0)
HSTAT S ER=0 Q
"RTN","XMM1",31,0)
DRV2400 S ER=1 W *5,*13 R Y:2 H 1 W "D",*13 R Y:2 Q:Y'["*"  H 1 W XMPHONE,*13 H 2 W *13 R Y:1,Y:60 S:Y["ONLINE" ER=0 Q
"RTN","XMM1",32,0)
HRV2400 W *3,*4 Q
"RTN","XMM1",33,0)
SRV2400 S Y="no status report",ER=0 Q
"RTN","XMM1",34,0)
ATT212C ;AT&T 300/1200 AUTODIAL MODEM
"RTN","XMM1",35,0)
D212C F I=1:1:$L(XMPHONE) I (($E(XMPHONE,I)="P")!($E(XMPHONE,I)="p")) S XMPHONE=$E(XMPHONE,0,I-1)_","_$E(XMPHONE,I+1,999)
"RTN","XMM1",36,0)
D2 I $L(XMPHONE)>36 S ER=1 Q
"RTN","XMM1",37,0)
 F I=1:1:6 U IO W *13 U IO R X:2 Q:X[":"
"RTN","XMM1",38,0)
 I I=6 K I S ER=1 Q
"RTN","XMM1",39,0)
 K I
"RTN","XMM1",40,0)
D3 ;
"RTN","XMM1",41,0)
 U IO W XMPHONE,"/",*13 R X:70 I '$T U IO W "$B$:",*13 S ER=1 Q
"RTN","XMM1",42,0)
 F I=1:1:7 U IO R X:30 Q:X["Conn"  Q:X["Answ"  Q:+X
"RTN","XMM1",43,0)
 I ((X["Con")!(X["Ans")) S ER=0 Q
"RTN","XMM1",44,0)
 I '+X S ER=1 Q
"RTN","XMM1",45,0)
 S ER=0 Q
"RTN","XMM1",46,0)
H212C U IO W "$B" H 3 R X:3,X:0 U IO W "$:" H 3 R X:3,X:0
"RTN","XMM1",47,0)
 U IO W "TALK",*13 H 5 S ER=1 F I=1:1:10 R X:3 Q:X[":"
"RTN","XMM1",48,0)
 K:I=10 I Q:'$D(I)  K I S ER=0 Q
"RTN","XMM1",49,0)
S212C F I=1:1 U IO R X:1 Q:'$T
"RTN","XMM1",50,0)
S2 S ER=1,%=^%ZOSF("TRMRD")
"RTN","XMM1",51,0)
 U IO X ^%ZOSF("TRMON") W *13 H 2 R X:4 I X'[":" R X:2
"RTN","XMM1",52,0)
 W "S",*13 H 3 F I=1:1 U IO R X:3 Q:'$T  U IO(0) W X X % W *Y
"RTN","XMM1",53,0)
 X ^%ZOSF("TRMOFF") K I S ER=0 Q
"RTN","XMM1",54,0)
R212C D H212C F I=1:1 U IO R X:3 Q:'$T
"RTN","XMM1",55,0)
 U IO W "ATZO1=Y,O2=Y,O3=Y,O4=Y,O5=Y,O6=N,O7=Y,08=N,09=Y,O10=N,O11=Y,O12=N,O13=Y,O14=N,O15=Y,O16=Y,O17=Y,O18=N,O19=Y,O20=1,O21=N,O22=:,O23=",$C(8),",O24=@,O25=$B,O26=$:",*13
"RTN","XMM1",56,0)
 S ER=1 F I=1:1:10 U IO W *13 U IO R X:3 Q:X[":"
"RTN","XMM1",57,0)
 K:I=10 I Q:'$D(I)  S ER=0 Q
"RTN","XMM1",58,0)
 Q
"RTN","XMM1",59,0)
CLEAR F %=1:1 U IO R Y:1 Q:'$T
"RTN","XMM1",60,0)
 Q
"RTN","XMM2")
0^314^B3732331
"RTN","XMM2",1,0)
XMM2 ;(WASH ISC)/THM-CERMATEK INFO MATE 212A MODEM ;7/10/89  12:46 ;
"RTN","XMM2",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMM2",3,0)
O ;DON'T USE "UNLISTEN COMMAND", LEAVE COMMAND CHARACTER TO BE CONTROL-N
"RTN","XMM2",4,0)
 ;THIS PROTOCOL USES ONLY DIAL, END, QUERY, AND RESET COMMANDS
"RTN","XMM2",5,0)
 Q
"RTN","XMM2",6,0)
DIAL ;
"RTN","XMM2",7,0)
 W $C(14),"Q",! R %:1 I %["O" S ER=0,Y="Already off-hook" Q
"RTN","XMM2",8,0)
 W $C(14),"D '",XMPHONE,"'",! S ER=1 R %:30 I '$T S Y="Timeout" Q
"RTN","XMM2",9,0)
 R X:30 I '$T S Y="Timeout" Q
"RTN","XMM2",10,0)
 I X["A" S Y="Connected",ER=0 Q
"RTN","XMM2",11,0)
 I X["B" S Y="Busy" Q
"RTN","XMM2",12,0)
 I X["N" S Y="No Answer" Q
"RTN","XMM2",13,0)
 I X["X" S Y="No dial tone detected" Q
"RTN","XMM2",14,0)
 S Y="Info-mate modem status: '"_X_"'" Q
"RTN","XMM2",15,0)
HANG ; HANG UP MODEM
"RTN","XMM2",16,0)
 W $C(14),"E",!,$C(14),! R X:15 I '$T S Y="Timeout",ER=1 Q
"RTN","XMM2",17,0)
 S ER=0,Y="Successfully hung up" Q
"RTN","XMM2",18,0)
RESET ; RESET MODEM
"RTN","XMM2",19,0)
 W $C(14),"R",!,$C(14),!
"RTN","XMM2",20,0)
 Q
"RTN","XMM2",21,0)
STATUS ; DISPLAY INFO-MATE STATUS INFO
"RTN","XMM2",22,0)
 W $C(14),"Q ",! R X:5 I '$T S Y="Timeout-modem probably not active.",ER=1 Q
"RTN","XMM2",23,0)
EN S Y="",%=$P(X,"/",1),J="OCHMLSARDUXZ"
"RTN","XMM2",24,0)
 S K="Offhook,connected,1200 baud,300 baud,110 baud,Self test enabled,Analog test enabled,Remote originated loop,Digital loop,Unlisten enabled,Command echos,Remote digital loop enabled"
"RTN","XMM2",25,0)
 F I=1:1 S A=$E(J,I) Q:A=""  S:%[A Y=Y_$P(K,",",I)_", "
"RTN","XMM2",26,0)
 S Y=Y_$P(X,"/",2)_" errors."
"RTN","XMM2",27,0)
 Q
"RTN","XMNETV")
1^169
"RTN","XMNTEG")
0^170^B20704578
"RTN","XMNTEG",1,0)
XMNTEG ;ISC/XTSUMBLD KERNEL - Package checksum checker ;07/23/2002  10:18
"RTN","XMNTEG",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMNTEG",3,0)
 ;;7.3;Apr 19, 2002@07:52:43
"RTN","XMNTEG",4,0)
 S XT4="I 1",X=$T(+3) W !!,"Checksum routine created on ",$P(X,";",4)," by KERNEL V",$P(X,";",3),!
"RTN","XMNTEG",5,0)
CONT F XT1=1:1 S XT2=$T(ROU+XT1) Q:XT2=""  S X=$P(XT2," ",1),XT3=$P(XT2,";",3) X XT4 I $T W !,X X ^%ZOSF("TEST") S:'$T XT3=0 X:XT3 ^%ZOSF("RSUM") W ?10,$S('XT3:"Routine not in UCI",XT3'=Y:"Calculated "_$C(7)_Y_", off by "_(Y-XT3),1:"ok")
"RTN","XMNTEG",6,0)
 G CONT^XMNTEG0
"RTN","XMNTEG",7,0)
 K %1,%2,%3,X,Y,XT1,XT2,XT3,XT4 Q
"RTN","XMNTEG",8,0)
ONE S XT4="I $D(^UTILITY($J,X))",X=$T(+3) W !!,"Checksum routine created on ",$P(X,";",4)," by KERNEL V",$P(X,";",3),!
"RTN","XMNTEG",9,0)
 W !,"Check a subset of routines:" K ^UTILITY($J) X ^%ZOSF("RSEL")
"RTN","XMNTEG",10,0)
 W ! G CONT
"RTN","XMNTEG",11,0)
ROU ;;
"RTN","XMNTEG",12,0)
XM ;;10750940
"RTN","XMNTEG",13,0)
XMA ;;193377
"RTN","XMNTEG",14,0)
XMA0 ;;305822
"RTN","XMNTEG",15,0)
XMA03 ;;66257
"RTN","XMNTEG",16,0)
XMA11 ;;19543
"RTN","XMNTEG",17,0)
XMA11A ;;295406
"RTN","XMNTEG",18,0)
XMA1B ;;741680
"RTN","XMNTEG",19,0)
XMA1C ;;99629
"RTN","XMNTEG",20,0)
XMA2 ;;1117192
"RTN","XMNTEG",21,0)
XMA21 ;;2501947
"RTN","XMNTEG",22,0)
XMA21C ;;5477330
"RTN","XMNTEG",23,0)
XMA2B ;;4983521
"RTN","XMNTEG",24,0)
XMA2R ;;3986868
"RTN","XMNTEG",25,0)
XMA3 ;;11956281
"RTN","XMNTEG",26,0)
XMA30 ;;10571799
"RTN","XMNTEG",27,0)
XMA32 ;;8481844
"RTN","XMNTEG",28,0)
XMA32A ;;9150003
"RTN","XMNTEG",29,0)
XMA7 ;;16522
"RTN","XMNTEG",30,0)
XMAD2 ;;208202
"RTN","XMNTEG",31,0)
XMADGO ;;10833
"RTN","XMNTEG",32,0)
XMAFTP ;;3725650
"RTN","XMNTEG",33,0)
XMAH ;;1584093
"RTN","XMNTEG",34,0)
XMAH1 ;;2176845
"RTN","XMNTEG",35,0)
XMAI2 ;;2084332
"RTN","XMNTEG",36,0)
XMAPBLOB ;;4954112
"RTN","XMNTEG",37,0)
XMAPHOST ;;7077399
"RTN","XMNTEG",38,0)
XMASEC ;;46560
"RTN","XMNTEG",39,0)
XMB ;;4289569
"RTN","XMNTEG",40,0)
XMBBLOB ;;1692263
"RTN","XMNTEG",41,0)
XMBGRP ;;8136862
"RTN","XMNTEG",42,0)
XMC ;;3542655
"RTN","XMNTEG",43,0)
XMC1 ;;9454283
"RTN","XMNTEG",44,0)
XMC11 ;;2246886
"RTN","XMNTEG",45,0)
XMC1A ;;3411138
"RTN","XMNTEG",46,0)
XMC1B ;;2460937
"RTN","XMNTEG",47,0)
XMCB ;;3553056
"RTN","XMNTEG",48,0)
XMCD ;;4131908
"RTN","XMNTEG",49,0)
XMCDNT ;;401792
"RTN","XMNTEG",50,0)
XMCE ;;1460559
"RTN","XMNTEG",51,0)
XMCP ;;2311480
"RTN","XMNTEG",52,0)
XMCQ ;;4988121
"RTN","XMNTEG",53,0)
XMCQA ;;6380548
"RTN","XMNTEG",54,0)
XMCQH ;;2468361
"RTN","XMNTEG",55,0)
XMCSIZE ;;1758419
"RTN","XMNTEG",56,0)
XMCTLK ;;8483546
"RTN","XMNTEG",57,0)
XMCTRAP ;;161791
"RTN","XMNTEG",58,0)
XMCU1 ;;787300
"RTN","XMNTEG",59,0)
XMCX ;;5550363
"RTN","XMNTEG",60,0)
XMCXT ;;2533239
"RTN","XMNTEG",61,0)
XMCXU ;;5743394
"RTN","XMNTEG",62,0)
XMD ;;7748228
"RTN","XMNTEG",63,0)
XMDIR1 ;;9778409
"RTN","XMNTEG",64,0)
XMDIR1A ;;4299248
"RTN","XMNTEG",65,0)
XMDIR1B ;;3077473
"RTN","XMNTEG",66,0)
XMDIRQST ;;7707598
"RTN","XMNTEG",67,0)
XMDIRRCV ;;1925075
"RTN","XMNTEG",68,0)
XMDIRSND ;;2039595
"RTN","XMNTEG",69,0)
XMFAX ;;5011960
"RTN","XMNTEG",70,0)
XMGAPI0 ;;2470973
"RTN","XMNTEG",71,0)
XMGAPI1 ;;22159
"RTN","XMNTEG",72,0)
XMGAPI2 ;;3885630
"RTN","XMNTEG",73,0)
XMGAPI3 ;;2143520
"RTN","XMNTEG",74,0)
XMGAPI4 ;;5418259
"RTN","XMNTEG",75,0)
XMHIG ;;6374158
"RTN","XMNTEG",76,0)
XMHIU ;;9084627
"RTN","XMNTEG",77,0)
XMJBL ;;4988691
"RTN","XMNTEG",78,0)
XMJBM ;;11064135
"RTN","XMNTEG",79,0)
XMJBM1 ;;3151843
"RTN","XMNTEG",80,0)
XMJBN ;;10845646
"RTN","XMNTEG",81,0)
XMJBN1 ;;5454531
"RTN","XMNTEG",82,0)
XMJBU ;;2768827
"RTN","XMNTEG",83,0)
XMJDIR ;;6153613
"RTN","XMNTEG",84,0)
XMJERR ;;375271
"RTN","XMNTEG",85,0)
XMJMA ;;3612338
"RTN","XMNTEG",86,0)
XMJMBULL ;;1994222
"RTN","XMNTEG",87,0)
XMJMC ;;9725999
"RTN","XMNTEG",88,0)
XMJMCODE ;;12533067
"RTN","XMNTEG",89,0)
XMJMD ;;9375016
"RTN","XMNTEG",90,0)
XMJMF ;;3844343
"RTN","XMNTEG",91,0)
XMJMF1 ;;11350281
"RTN","XMNTEG",92,0)
XMJMF2 ;;6670003
"RTN","XMNTEG",93,0)
XMJMFA ;;6729708
"RTN","XMNTEG",94,0)
XMJMFB ;;17121533
"RTN","XMNTEG",95,0)
XMJMFC ;;12108437
"RTN","XMNTEG",96,0)
XMJML ;;12709285
"RTN","XMNTEG",97,0)
XMJMLN ;;14794710
"RTN","XMNTEG",98,0)
XMJMLR ;;14272339
"RTN","XMNTEG",99,0)
XMJMLR1 ;;6881581
"RTN","XMNTEG",100,0)
XMJMOI ;;14666274
"RTN","XMNTEG",101,0)
XMJMOI1 ;;8385762
"RTN","XMNTEG",102,0)
XMJMOIE ;;3277725
"RTN","XMNTEG",103,0)
XMJMP ;;15497599
"RTN","XMNTEG",104,0)
XMJMP1 ;;18918998
"RTN","XMNTEG",105,0)
XMJMP2 ;;2708969
"RTN","XMNTEG",106,0)
XMJMQ ;;14078177
"RTN","XMNTEG",107,0)
XMJMQ1 ;;13480745
"RTN","XMNTEG",108,0)
XMJMR ;;10472863
"RTN","XMNTEG",109,0)
XMJMR1 ;;10598504
"RTN","XMNTEG",110,0)
XMJMRO ;;5049970
"RTN","XMNTEG",111,0)
XMJMS ;;7995221
"RTN","XMNTEG",112,0)
XMJMSA ;;1902278
"RTN","XMNTEG",113,0)
XMJMSO ;;10097928
"RTN","XMNTEG",114,0)
XMJMT ;;8959953
"RTN","XMNTEG",115,0)
XMKP ;;16206281
"RTN","XMNTEG",116,0)
XMKP1 ;;1811191
"RTN","XMNTEG",117,0)
XMKPL ;;2912755
"RTN","XMNTEG",118,0)
XMKPLQ ;;5786623
"RTN","XMNTEG",119,0)
XMKPO ;;2469366
"RTN","XMNTEG",120,0)
XMKPR ;;10051281
"RTN","XMNTEG",121,0)
XMKPR1 ;;5051210
"RTN","XMNTEG",122,0)
XMKPRD ;;5470763
"RTN","XMNTEG",123,0)
XML ;;5119164
"RTN","XMNTEG",124,0)
XML1CRC ;;5596625
"RTN","XMNTEG",125,0)
XML4CRC ;;11722711
"RTN","XMNTEG",126,0)
XML4CRC1 ;;6216754
"RTN","XMNTEG",127,0)
XMLPC ;;2821947
"RTN","XMNTEG",128,0)
XMLSWP ;;5626101
"RTN","XMNTEG",129,0)
XMLSWP0 ;;5152871
"RTN","XMNTEG",130,0)
XMLSWP2 ;;3134547
"RTN","XMNTEG",131,0)
XMLTCP ;;2332071
"RTN","XMNTEG",132,0)
XMM1 ;;3866874
"RTN","XMNTEG",133,0)
XMM2 ;;2670817
"RTN","XMNTEG",134,0)
XMP ;;8830587
"RTN","XMNTEG",135,0)
XMP2 ;;9384926
"RTN","XMNTEG",136,0)
XMP2A ;;8263048
"RTN","XMNTEG",137,0)
XMJMOR ;;14793912
"RTN","XMNTEG",138,0)
XMJMORX ;;13578226
"RTN","XMNTEG",139,0)
XMJMORX1 ;;7116146
"RTN","XMNTEG",140,0)
XMP3 ;;6720603
"RTN","XMNTEG",141,0)
XMPC ;;5352206
"RTN","XMNTEG",142,0)
XMPG ;;4410165
"RTN","XMNTEG",143,0)
XMPH ;;4952939
"RTN","XMNTEG",144,0)
XMPSEC ;;7152889
"RTN","XMNTEG",145,0)
XMR ;;11613068
"RTN","XMNTEG",146,0)
XMR0BLOB ;;4867143
"RTN","XMNTEG",147,0)
XMR1 ;;10825754
"RTN","XMNTEG",148,0)
XMR2 ;;2314394
"RTN","XMNTEG",149,0)
XMR3 ;;14650619
"RTN","XMNTEG",150,0)
XMR3A ;;2650246
"RTN","XMNTEG",151,0)
XMR4 ;;11545724
"RTN","XMNTEG",152,0)
XMRENT ;;2261713
"RTN","XMNTEG",153,0)
XMRFTP ;;3153916
"RTN","XMNTEG",154,0)
XMRFTPUX ;;3165955
"RTN","XMNTEG",155,0)
XMRINETD ;;363486
"RTN","XMNTEG",156,0)
XMRMSM ;;338607
"RTN","XMNTEG",157,0)
XMRONT ;;390591
"RTN","XMNTEG",158,0)
XMRPCTS ;;4756429
"RTN","XMNTEG",159,0)
XMRPCTS0 ;;5251212
"RTN","XMNTEG",160,0)
XMRPCTS1 ;;5706972
"RTN","XMNTEG",161,0)
XMRPCTSA ;;3495721
"RTN","XMNTEG",162,0)
XMRPOP ;;11311549
"RTN","XMNTEG",163,0)
XMRTCP ;;3549159
"RTN","XMNTEG",164,0)
XMRTCPGO ;;2857890
"RTN","XMNTEG",165,0)
XMRUCX ;;1143285
"RTN","XMNTEG",166,0)
XMS ;;8210098
"RTN","XMNTEG",167,0)
XMS0BLOB ;;6743955
"RTN","XMNTEG",168,0)
XMS1 ;;9572683
"RTN","XMNTEG",169,0)
XMS2 ;;5021128
"RTN","XMNTEG",170,0)
XMS3 ;;11387711
"RTN","XMNTEG",171,0)
XMSFTP ;;3096740
"RTN","XMNTEG",172,0)
XMSFTPUX ;;3150307
"RTN","XMNTEG",173,0)
XMTDF ;;7250797
"RTN","XMNTEG",174,0)
XMTDL ;;18753082
"RTN","XMNTEG",175,0)
XMTDL1 ;;4584627
"RTN","XMNTEG",176,0)
XMTDL2 ;;10414584
"RTN","XMNTEG",177,0)
XMTDO ;;1726768
"RTN","XMNTEG",178,0)
XMTDR ;;10257008
"RTN","XMNTEG",179,0)
XMTDT ;;8338601
"RTN","XMNTEG",180,0)
XMUCXPOP ;;361549
"RTN","XMNTEG",181,0)
XMUDCHK ;;1578565
"RTN","XMNTEG",182,0)
XMUDCHR ;;8046508
"RTN","XMNTEG",183,0)
XMUDNC ;;14028901
"RTN","XMNTEG",184,0)
XMUDTOP ;;3796998
"RTN","XMNTEG0")
0^171^B7139150
"RTN","XMNTEG0",1,0)
XMNTEG0 ;ISC/XTSUMBLD KERNEL - Package checksum checker ;08/29/2002  09:16
"RTN","XMNTEG0",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMNTEG0",3,0)
 ;;7.3;Apr 19, 2002@07:52:43
"RTN","XMNTEG0",4,0)
 S XT4="I 1",X=$T(+3) W !!,"Checksum routine created on ",$P(X,";",4)," by KERNEL V",$P(X,";",3),!
"RTN","XMNTEG0",5,0)
CONT F XT1=1:1 S XT2=$T(ROU+XT1) Q:XT2=""  S X=$P(XT2," ",1),XT3=$P(XT2,";",3) X XT4 I $T W !,X X ^%ZOSF("TEST") S:'$T XT3=0 X:XT3 ^%ZOSF("RSUM") W ?10,$S('XT3:"Routine not in UCI",XT3'=Y:"Calculated "_$C(7)_Y_", off by "_(Y-XT3),1:"ok")
"RTN","XMNTEG0",6,0)
 ;
"RTN","XMNTEG0",7,0)
 K %1,%2,%3,X,Y,XT1,XT2,XT3,XT4 Q
"RTN","XMNTEG0",8,0)
ONE S XT4="I $D(^UTILITY($J,X))",X=$T(+3) W !!,"Checksum routine created on ",$P(X,";",4)," by KERNEL V",$P(X,";",3),!
"RTN","XMNTEG0",9,0)
 W !,"Check a subset of routines:" K ^UTILITY($J) X ^%ZOSF("RSEL")
"RTN","XMNTEG0",10,0)
 W ! G CONT
"RTN","XMNTEG0",11,0)
ROU ;;
"RTN","XMNTEG0",12,0)
XMUPIN ;;10484796
"RTN","XMNTEG0",13,0)
XMUT1 ;;4713080
"RTN","XMNTEG0",14,0)
XMUT1A ;;4119010
"RTN","XMNTEG0",15,0)
XMUT2 ;;6124745
"RTN","XMNTEG0",16,0)
XMUT4 ;;14014054
"RTN","XMNTEG0",17,0)
XMUT41 ;;6742163
"RTN","XMNTEG0",18,0)
XMUT4A ;;1491748
"RTN","XMNTEG0",19,0)
XMUT4C ;;8776176
"RTN","XMNTEG0",20,0)
XMUT5 ;;6643977
"RTN","XMNTEG0",21,0)
XMUT5B ;;1726462
"RTN","XMNTEG0",22,0)
XMUT5C ;;3073565
"RTN","XMNTEG0",23,0)
XMUT5G ;;338629
"RTN","XMNTEG0",24,0)
XMUT5Q ;;8506023
"RTN","XMNTEG0",25,0)
XMUT5Q1 ;;4388458
"RTN","XMNTEG0",26,0)
XMUT5R1 ;;2364051
"RTN","XMNTEG0",27,0)
XMUT5R2 ;;3211915
"RTN","XMNTEG0",28,0)
XMUT6 ;;2312993
"RTN","XMNTEG0",29,0)
XMUT7 ;;411505
"RTN","XMNTEG0",30,0)
XMUTCOM1 ;;2620897
"RTN","XMNTEG0",31,0)
XMUTERM ;;7174403
"RTN","XMNTEG0",32,0)
XMUTERM1 ;;17510874
"RTN","XMNTEG0",33,0)
XMUTERM2 ;;10583278
"RTN","XMNTEG0",34,0)
XMUTPUR0 ;;2780450
"RTN","XMNTEG0",35,0)
XMVGROUP ;;13634422
"RTN","XMNTEG0",36,0)
XMVGRP ;;11462353
"RTN","XMNTEG0",37,0)
XMVSURR ;;3022444
"RTN","XMNTEG0",38,0)
XMVVITA ;;7297401
"RTN","XMNTEG0",39,0)
XMVVITAE ;;11577437
"RTN","XMNTEG0",40,0)
XMXADDR ;;16602920
"RTN","XMNTEG0",41,0)
XMXADDR1 ;;13510282
"RTN","XMNTEG0",42,0)
XMXADDR2 ;;14695480
"RTN","XMNTEG0",43,0)
XMXADDR3 ;;8833831
"RTN","XMNTEG0",44,0)
XMXADDR4 ;;7884015
"RTN","XMNTEG0",45,0)
XMXADDRD ;;10571405
"RTN","XMNTEG0",46,0)
XMXADDRG ;;16118455
"RTN","XMNTEG0",47,0)
XMXANSER ;;2014179
"RTN","XMNTEG0",48,0)
XMXAPI ;;7362843
"RTN","XMNTEG0",49,0)
XMXAPIB ;;3472533
"RTN","XMNTEG0",50,0)
XMXAPIG ;;5257560
"RTN","XMNTEG0",51,0)
XMXAPIU ;;596863
"RTN","XMNTEG0",52,0)
XMXBSKT ;;12498784
"RTN","XMNTEG0",53,0)
XMXBULL ;;5251831
"RTN","XMNTEG0",54,0)
XMXEDIT ;;7275716
"RTN","XMNTEG0",55,0)
XMXGRP ;;9498223
"RTN","XMNTEG0",56,0)
XMXGRP1 ;;10875164
"RTN","XMNTEG0",57,0)
XMXLIST ;;6277109
"RTN","XMNTEG0",58,0)
XMXLIST1 ;;12801864
"RTN","XMNTEG0",59,0)
XMXLIST2 ;;6802380
"RTN","XMNTEG0",60,0)
XMXMBOX ;;1530327
"RTN","XMNTEG0",61,0)
XMXMSGS ;;10893386
"RTN","XMNTEG0",62,0)
XMXMSGS1 ;;7497318
"RTN","XMNTEG0",63,0)
XMXMSGS2 ;;8470689
"RTN","XMNTEG0",64,0)
XMXPARM ;;14944409
"RTN","XMNTEG0",65,0)
XMXPARM1 ;;4016561
"RTN","XMNTEG0",66,0)
XMXPARMB ;;3923435
"RTN","XMNTEG0",67,0)
XMXPRT ;;3257492
"RTN","XMNTEG0",68,0)
XMXREPLY ;;5837087
"RTN","XMNTEG0",69,0)
XMXSEC ;;21878434
"RTN","XMNTEG0",70,0)
XMXSEC1 ;;14620130
"RTN","XMNTEG0",71,0)
XMXSEC2 ;;24844137
"RTN","XMNTEG0",72,0)
XMXSEC3 ;;3540050
"RTN","XMNTEG0",73,0)
XMXSEND ;;10773097
"RTN","XMNTEG0",74,0)
XMXTO ;;1746429
"RTN","XMNTEG0",75,0)
XMXUTIL ;;12300932
"RTN","XMNTEG0",76,0)
XMXUTIL1 ;;6906795
"RTN","XMNTEG0",77,0)
XMXUTIL2 ;;7664489
"RTN","XMNTEG0",78,0)
XMXUTIL3 ;;5771323
"RTN","XMNTEG0",79,0)
XMXUTIL4 ;;9367334
"RTN","XMNTEG0",80,0)
XMYPRE ;;2625462
"RTN","XMP")
0^45^B13644218
"RTN","XMP",1,0)
XMP ;(WASH ISC)/THM/CAP-PackMan ;04/17/2002  11:03
"RTN","XMP",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMP",3,0)
NOKL G F:$D(^DOPT("XMP"))
"RTN","XMP",4,0)
GO K ^DOPT("XMP") S DIK="^DOPT(""XMP"","
"RTN","XMP",5,0)
 S ^DOPT("XMP",0)="PackMan function^1N^"
"RTN","XMP",6,0)
 F I=1:1 S X=$E($T(TABLE+I),4,99) Q:X=""  S ^DOPT("XMP",I,0)=X
"RTN","XMP",7,0)
 D IXALL^DIK Q:$D(DIFROM)!'$D(XMZ)
"RTN","XMP",8,0)
F D NEW ;Q:Y<0
"RTN","XMP",9,0)
FX S DIC="^DOPT(""XMP"",",DIC(0)="AEQZ" D ^DIC W ! K DIC
"RTN","XMP",10,0)
 S XMR=^XMB(3.9,XMZ,0) G Q:Y<0 S X=$P(Y(0),U,2,99) K DD,DO,Y
"RTN","XMP",11,0)
 I $D(^XMB(3.9,XMZ,2,0)) S XCNP=$P(^(0),U,3)
"RTN","XMP",12,0)
 I $D(XCNP),XCNP>1,X["LOAD"!(X["PACK") S Y=$O(^XMB(3.9,XMZ,1,"C",0)) I $L(Y),$S(Y'=XMDUZ&Y:1,Y'=$P(XMR,U,2):1,$O(^(Y))'="":1,1:0) W !,"This message has already been SENT.  You may not CHANGE it.",$C(7) G FX
"RTN","XMP",13,0)
 I X["LOAD"!(X["PACK"),$S('$D(DUZ(0)):1,DUZ(0)="@":0,$D(^XUSEC("XUPROG",DUZ)):0,1:1) W !,"You do not have the privilege to LOAD packages nor routines nor globals.",$C(7) G FX
"RTN","XMP",14,0)
 I X="XI^XMP2",$S('$D(DUZ(0)):1,DUZ(0)="@":0,$D(^XUSEC("XUPROGMODE",DUZ)):0,1:1)
"RTN","XMP",15,0)
 I  W !!,$C(7),"You may only check the security of this message.",!,$S($P(^XMB(3.9,XMZ,0),U,10)'="":"You will not be allowed to install it.",1:"This message was not secured -- nothing done"),!!
"RTN","XMP",16,0)
 D @X D ^%ZISC D Q G FX
"RTN","XMP",17,0)
Q W ! K DIE,DIF,XMSUB,XCNP
"RTN","XMP",18,0)
 Q
"RTN","XMP",19,0)
TABLE ;;;DESCRIPTION^PROGRAM OR TAG^PROGRAM
"RTN","XMP",20,0)
 ;;ROUTINE LOAD^LOAD^XMPH
"RTN","XMP",21,0)
 ;;GLOBAL LOAD^LOAD^XMPG
"RTN","XMP",22,0)
 ;;PACKAGE LOAD^PACK^XMPH
"RTN","XMP",23,0)
 ;;SUMMARIZE MESSAGE^XS^XMP2
"RTN","XMP",24,0)
 ;;PRINT MESSAGE^XP^XMP2
"RTN","XMP",25,0)
 ;;INSTALL/CHECK MESSAGE^XI^XMP2
"RTN","XMP",26,0)
 ;;INSTALL SELECTED ROUTINE(S)^XR^XMP2
"RTN","XMP",27,0)
 ;;TEXT PRINT/DISPLAY^XT^XMP2
"RTN","XMP",28,0)
 ;;COMPARE MESSAGE^XC^XMP2
"RTN","XMP",29,0)
 ;;
"RTN","XMP",30,0)
 ;;DATA LOAD^LOAD^XMPDAT  ***** FILEMANAGER DATA MOVE ***** NOT READY
"RTN","XMP",31,0)
 ;;
"RTN","XMP",32,0)
 ;;
"RTN","XMP",33,0)
KIDS ;from XPDTP
"RTN","XMP",34,0)
 D XMZ^XMA2 Q:XMZ<1  S $P(^XMB(3.9,XMZ,0),U,7)="K" G DIFROM
"RTN","XMP",35,0)
NEW I $S($D(DIFROM):1,$D(ZTQUEUED):1,$D(XMDF):1,1:0) G DIFROM
"RTN","XMP",36,0)
 W !,"Please enter description of PACKMAN Message",!,$C(7)
"RTN","XMP",37,0)
 S DWPK=1,DWLW=75,DIC="^TMP(""XMP"",$J,",DIA("P")=3.9
"RTN","XMP",38,0)
 S DIWESUB=$G(XMSUB,XMSUBJ)
"RTN","XMP",39,0)
 D EN^DIWE
"RTN","XMP",40,0)
DIFROM S %="Created ",(DIF,DIE)="^XMB(3.9,XMZ,2,"
"RTN","XMP",41,0)
 I $D(DUZ),$D(^VA(200,DUZ,0)) S %=%_"by "_$$NAME^XMXUTIL(DUZ)_" "
"RTN","XMP",42,0)
 I $D(^XMB("NETNAME")) S %=%_"at "_$P(^("NETNAME"),U)_" "
"RTN","XMP",43,0)
 I $D(DIFROM) S %=%_" (KIDS) "
"RTN","XMP",44,0)
 S XMA0=%
"RTN","XMP",45,0)
 S XMA=$E($$NOW^XLFDT_"0000",1,12),@(DIF_"0)")="^3.92A^2^2^"_$P(XMA,"."),^(1,0)="$TXT "_XMA0_"on "_$$DOW^XLFDT(XMA)_", "_$$FMTE^XLFDT($P(XMA,".",1),"2Z")_" at "_$E(XMA,9,10)_":"_$E(XMA,11,12)
"RTN","XMP",46,0)
 I '$O(^TMP("XMP",$J,0)) S ^XMB(3.9,XMZ,2,2,0)="$END TXT",XCNP=2 G OLD
"RTN","XMP",47,0)
 S I=2,J=0,^XMB(3.9,XMZ,2,2,0)=" "
"RTN","XMP",48,0)
 F  S J=$O(^TMP("XMP",$J,J)) Q:J=""  S %=^(J,0) S:$E(%)="$" %=" "_% S I=I+1,^XMB(3.9,XMZ,2,I,0)=%
"RTN","XMP",49,0)
 S ^XMB(3.9,XMZ,2,I+1,0)=" ",^XMB(3.9,XMZ,2,I+2,0)="$END TXT",XCNP=I+2,^XMB(3.9,XMZ,2,0)="^3.92A^"_XCNP_U_XCNP_U_$P(XMA,".") K ^TMP("XMP",$J),XMA0,%
"RTN","XMP",50,0)
OLD S XCN=0 K ^TMP("XMP",$J),XMA0 I '$D(ZTQUEUED) W !
"RTN","XMP",51,0)
O1 D NT Q:+XCN'=XCN  Q:X'["$TXT"  W:'$D(ZTQUEUED) !,$P(X,"TXT",2,999) G O1
"RTN","XMP",52,0)
NT S XCN=$O(@(DIE_XCN_")")) Q:+XCN'=XCN  S X=^(XCN,0) Q
"RTN","XMP",53,0)
MM S (DIE,DIF)="^XMB(3.9,XMZ,2," G FX
"RTN","XMP2")
0^315^B33252211
"RTN","XMP2",1,0)
XMP2 ;(WASH ISC)/GM/CAP-PackMan Print/Install/Summarize/Compare ;04/17/2002  11:07
"RTN","XMP2",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMP2",3,0)
 ; Entry points used by MailMan options (not covered by DBIA):
"RTN","XMP2",4,0)
 ; XC     XMPCOM - Compare message
"RTN","XMP2",5,0)
 ; XI     XMPINS - Install message
"RTN","XMP2",6,0)
 ; XP     XMPPRT - Print message
"RTN","XMP2",7,0)
 ; XS     XMPSUM - Summarize message
"RTN","XMP2",8,0)
 ;;XMP2 IS INSTALLED AS XMP2Z TO AVOID CLOBBER ERRORS / FILE AS XMP2
"RTN","XMP2",9,0)
 Q
"RTN","XMP2",10,0)
 ;
"RTN","XMP2",11,0)
LIST ;LIST MESSAGE
"RTN","XMP2",12,0)
 S XCN=.999 F M=1:1 D NT Q:+XCN'=XCN  W !,X
"RTN","XMP2",13,0)
 Q
"RTN","XMP2",14,0)
 ;
"RTN","XMP2",15,0)
 ;
"RTN","XMP2",16,0)
PP ;PRETTY PRINT
"RTN","XMP2",17,0)
 S:'$D(XCN) XCN=.999 S XCN=+XCN K XMOUT
"RTN","XMP2",18,0)
 F I=1:1 D NT Q:XCN'=+XCN  Q:$E(X)="$"  D @($P("P1,G1,G2,K1",",",%1)) Q:$D(XMOUT)
"RTN","XMP2",19,0)
 Q
"RTN","XMP2",20,0)
 ;
"RTN","XMP2",21,0)
P1 Q:X?1"KEY ;;;".E
"RTN","XMP2",22,0)
 I XMP2="T" W !,$P(X," ",1)_" " S X=$P(X," ",2,99)
"RTN","XMP2",23,0)
 E  W !,$P(X," ",1)," ",?8 S X=$P(X," ",2,999)
"RTN","XMP2",24,0)
P2 I $Y+5>IOSL K DIR S DIR(0)="E" D:'$D(ZTQUEUED) ^DIR:$E(IOST)="C"&$S('$D(XMP):1,'XMP:1,1:0) K DIR,DIRUT W @IOF I $D(DTOUT)!$D(DUOUT) S XMOUT=1 Q
"RTN","XMP2",25,0)
 I $G(XMP2(0))=1 W "=" K XMP2(0)
"RTN","XMP2",26,0)
 I $X+$L(X)+1<IOM!(IOM<22) W X Q
"RTN","XMP2",27,0)
 F J=(IOM-$X-1):-1:20 Q:"),@_:"[$E(X,J)  Q:J<20  I $E(X,J)?1P Q:$E(X,J-2)'=" "
"RTN","XMP2",28,0)
 W $E(X,1,J),!,?10 S X=$E(X,J+1,999)
"RTN","XMP2",29,0)
 G P2
"RTN","XMP2",30,0)
 ;
"RTN","XMP2",31,0)
XT S XMP2="T" G 1
"RTN","XMP2",32,0)
 ;
"RTN","XMP2",33,0)
XP S XMP2="P"
"RTN","XMP2",34,0)
1 I $D(XMLOAD) W $C(7),!,"YOU CAN NOT PRINT a message while you are creating it." Q
"RTN","XMP2",35,0)
 S XCF=1 D MM,SP G SC
"RTN","XMP2",36,0)
 ;
"RTN","XMP2",37,0)
XR S XMP2="R" G 0
"RTN","XMP2",38,0)
 ;
"RTN","XMP2",39,0)
XI S XMP2="I"
"RTN","XMP2",40,0)
0 D MM S XCF=2 G ENH^XMP2A
"RTN","XMP2",41,0)
 ;
"RTN","XMP2",42,0)
ENI D ^XMP3 G Q:X=U D S G Q:XMP2'="I"
"RTN","XMP2",43,0)
 I $D(XMINIT),$P(XMR,U,7)="X" D @XMINIT
"RTN","XMP2",44,0)
 I $D(XMINTEG) D @XMINTEG
"RTN","XMP2",45,0)
Q K XMA0,XMB0,XMP2,XMPASS,XMPKIDS,XMINIT,XMINTEG Q
"RTN","XMP2",46,0)
 ;
"RTN","XMP2",47,0)
XC S XCF=3,XMP2="C" D MM,SP G SC ; Compare Message (DOPT 9)
"RTN","XMP2",48,0)
 ;
"RTN","XMP2",49,0)
XS S XCF=0,XMP2="S" D MM,SP G SC
"RTN","XMP2",50,0)
 ;
"RTN","XMP2",51,0)
SP G DEV^XMPH ; Output where? Queued by default. AND !!!  Runs @XMP2 opt.
"RTN","XMP2",52,0)
 ;
"RTN","XMP2",53,0)
SC K XMP2 Q
"RTN","XMP2",54,0)
 ;
"RTN","XMP2",55,0)
 ;
"RTN","XMP2",56,0)
 ; From DEV+2^XMPH and ZTASK+4^XMPH only   for EVERYTHING!!!!  XMP2=What
"RTN","XMP2",57,0)
S S XCN=.999 G ENTR^XMP2A:XMP2="R",ENTT^XMP2A:XMP2="T" I '$D(XMR) S XMR=^XMB(3.9,XMZ,0)
"RTN","XMP2",58,0)
 F I=1:1 D NT Q:+XCN'=XCN  D:$E(X)="$" S1:X'["$TXT" Q:+XCN'=XCN  I $D(XMOUT) K XMOUT Q
"RTN","XMP2",59,0)
 Q
"RTN","XMP2",60,0)
 ;
"RTN","XMP2",61,0)
S1 Q:$E(X,1,5)="$END "!($E(X,1,5)'?1"$"3U1" ")
"RTN","XMP2",62,0)
 I XMP2="I",$P(XMR,U,7)["X",$E(X,1,9)'="$END ROU ",$E(X,1,5)'="$ROU " S XMOUT=1 Q
"RTN","XMP2",63,0)
 S T=$E(X,2,4),A=$T(@T) I A="" W $C(7),"Unknown identifier '",A,"'" K A Q
"RTN","XMP2",64,0)
 W:XCF=1 @IOF W !,"Line ",XCN,?10,"Message #"_XMZ,?29 W:XCF $P(",Unloading,Comparing,Verifying",",",XCF) W " ",$P(A,";;",2),"  ",$E(X,5,999)
"RTN","XMP2",65,0)
 I XCF=0 D:$E(A,1,3)="KID" K2 Q
"RTN","XMP2",66,0)
 S A=$P($T(@T+XCF),";;",2,999) I A=";" W !,"Not implemented yet" Q
"RTN","XMP2",67,0)
 I $E(X,1,4)="$ROU",'$D(XMINIT),XMP2="I" S %=$P(X," ",2) S:%?.1"^".AN1"INIT" XMINIT="^"_% I %?.1"^".AN1"NTEG" S XMINTEG="^"_%
"RTN","XMP2",68,0)
 X A K A Q
"RTN","XMP2",69,0)
 ;
"RTN","XMP2",70,0)
NT S XCN=$O(^XMB(3.9,XMZ,2,XCN)) Q:+XCN'=XCN  S X=^(XCN,0) D:$E(X)="$" CHECK^XMPSEC Q
"RTN","XMP2",71,0)
 ;
"RTN","XMP2",72,0)
MM S (DIE,DIF)="^XMB(3.9,XMZ,2," Q
"RTN","XMP2",73,0)
 ;
"RTN","XMP2",74,0)
G1 W !,X D NT Q:+XCN'=XCN  G P2
"RTN","XMP2",75,0)
 ;
"RTN","XMP2",76,0)
G2 W !,X D NT Q:+XCN'=XCN  S XMP2(0)=1 G P2
"RTN","XMP2",77,0)
 ;
"RTN","XMP2",78,0)
K1 ;print KIDS Distribution routines
"RTN","XMP2",79,0)
 F  S XCN=$O(^XMB(3.9,XMZ,2,XCN)) Q:+XCN'=XCN  S X=^(XCN,0) Q:$E(X)="$"  D:X?1"""RTN"","""1.8AN1""")"
"RTN","XMP2",80,0)
 .S XCN=XCN+1,X1=$E(X,1,$L(X)-1) W !,"Routine  ",$TR($P(X1,",",2),"""")
"RTN","XMP2",81,0)
 .F  S XCN=$O(^XMB(3.9,XMZ,2,XCN)) Q:+XCN'=XCN  S X=^(XCN,0) Q:$P(X,",",1,2)'=X1  S XCN=$O(^XMB(3.9,XMZ,2,XCN)),X=^(XCN,0) D P1 Q:$D(XMOUT)
"RTN","XMP2",82,0)
 .S:XCN=+XCN XCN=XCN-1
"RTN","XMP2",83,0)
 S XMOUT=1 Q
"RTN","XMP2",84,0)
 ;
"RTN","XMP2",85,0)
K2 ;print summary of KIDS Distribution
"RTN","XMP2",86,0)
 Q:$T(XMP2^XPDDP)=""  K ^TMP($J,"BLD"),M
"RTN","XMP2",87,0)
 F  S XCN=$O(^XMB(3.9,XMZ,2,XCN)) Q:+XCN'=XCN  S X=^(XCN,0) Q:$E(X)="$"  I X?1"""BLD"","1.N1",0)" S XCN=$O(^XMB(3.9,XMZ,2,XCN)),M=^(XCN,0) Q
"RTN","XMP2",88,0)
 Q:'$D(M)  S @("^TMP("_$J_","_X)=M,X1=$P(X,",",1,2)
"RTN","XMP2",89,0)
 F  S XCN=$O(^XMB(3.9,XMZ,2,XCN)) Q:+XCN'=XCN  S X=^(XCN,0) Q:$P(X,",",1,2)'=X1  S XCN=$O(^XMB(3.9,XMZ,2,XCN)),M=^(XCN,0),@("^TMP("_$J_","_X)=M
"RTN","XMP2",90,0)
 D XMP2^XPDDP("TMP("_$J_","_X1_")",$P(X1,",",2))
"RTN","XMP2",91,0)
 S XMOUT=1 Q
"RTN","XMP2",92,0)
 ;
"RTN","XMP2",93,0)
SAVE D NT Q:"$END "_T=$P(X," ",1,2)  S X1=X D NT Q:"$END "_T=$P(X," ",1,2)
"RTN","XMP2",94,0)
 ;I $A(X)=126 S %=X D NT S X=%_$E(X,2,999) ; Set by ^DIFROM1, but DIFROM is no longer used.
"RTN","XMP2",95,0)
 S @X1=$E(X,2-$G(XMP2(0)),999)
"RTN","XMP2",96,0)
 G SAVE
"RTN","XMP2",97,0)
 ;
"RTN","XMP2",98,0)
BEG S %=0,ROU=$E(X,6,99),^TMP("XMS",$J,ROU,0,1)="""" F %0=1:1 D NT Q:$E(X)="$"  S ^TMP("XMS",$J,ROU,0,%0)=X,%=%+$L(X)
"RTN","XMP2",99,0)
 S ^TMP("XMS",$J,ROU,0)=%,%0=%0-1 Q
"RTN","XMP2",100,0)
 ;
"RTN","XMP2",101,0)
COMP D NT Q:$E(X)="$"
"RTN","XMP2",102,0)
 S X1=X D NT Q:$E(X)="$"
"RTN","XMP2",103,0)
 ;
"RTN","XMP2",104,0)
 ;Globals
"RTN","XMP2",105,0)
 ;I $A(X)=126 S %=$E(X,2,999) D NT S X=%_$E(X,2,999) ; Set by ^DIFROM1, but DIFROM is no longer used.
"RTN","XMP2",106,0)
 I '$D(@X1) W !,"Node '",X1,"' not on disk." G COMP
"RTN","XMP2",107,0)
 S Y=@X1,B=$E(X,2-$G(XMP2(0)),999)
"RTN","XMP2",108,0)
 G COMP:Y=B
"RTN","XMP2",109,0)
 W !,"Node: ",X1,!,"Disk:    ",Y
"RTN","XMP2",110,0)
 W !,"Message: ",$E(X,2-$G(XMP2(0)),99)
"RTN","XMP2",111,0)
 S X=$E(X,2,999) F J=1:1:$L(X) Q:$E(X,J)'=$E(Y,J)
"RTN","XMP2",112,0)
 W !,?12+J,"^"
"RTN","XMP2",113,0)
 G COMP
"RTN","XMP2",114,0)
 ;
"RTN","XMP2",115,0)
 ;TAG ;;Description of type of PackMan Data
"RTN","XMP2",116,0)
 ;    ;;Executable Print Code
"RTN","XMP2",117,0)
 ;    ;;Executable Installation code
"RTN","XMP2",118,0)
 ;    ;;Executable Comparison to Installed
"RTN","XMP2",119,0)
 ;    ;;Executable Verification code
"RTN","XMP2",120,0)
 ;
"RTN","XMP2",121,0)
ROU ;;Routine
"RTN","XMP2",122,0)
 ;;S %1=1 D PP
"RTN","XMP2",123,0)
 ;;S X=$P(X," ",2) S:X="XMP2" X="XMP2Z" S DIE="^XMB(3.9,XMZ,2," X ^%ZOSF("SAVE") W:X="XMP2Z" !,$C(7),"CHANGE NAME OF ROUTINE XMP2Z TO XMP2"
"RTN","XMP2",124,0)
 ;;D LOAD^XMPC
"RTN","XMP2",125,0)
 ;;G BEG
"RTN","XMP2",126,0)
DDD ;;Data Dictionary
"RTN","XMP2",127,0)
 ;;S %1=2 D PP
"RTN","XMP2",128,0)
 ;;D SAVE
"RTN","XMP2",129,0)
 ;;D COMP
"RTN","XMP2",130,0)
 ;;
"RTN","XMP2",131,0)
OPT ;;Options
"RTN","XMP2",132,0)
 ;;S %1=2 D PP
"RTN","XMP2",133,0)
 ;;D SAVE
"RTN","XMP2",134,0)
 ;;Q
"RTN","XMP2",135,0)
 ;;
"RTN","XMP2",136,0)
HEL ;;Help Frames
"RTN","XMP2",137,0)
 ;;S %1=2 D PP
"RTN","XMP2",138,0)
 ;;D SAVE
"RTN","XMP2",139,0)
 ;;Q
"RTN","XMP2",140,0)
 ;;
"RTN","XMP2",141,0)
BUL ;;Bulletins
"RTN","XMP2",142,0)
 ;;S %1=2 D PP
"RTN","XMP2",143,0)
 ;;D SAVE
"RTN","XMP2",144,0)
 ;;Q
"RTN","XMP2",145,0)
 ;;
"RTN","XMP2",146,0)
KEY ;;Security keys
"RTN","XMP2",147,0)
 ;;S %1=2 D PP
"RTN","XMP2",148,0)
 ;;D SAVE
"RTN","XMP2",149,0)
 ;;Q
"RTN","XMP2",150,0)
 ;;
"RTN","XMP2",151,0)
FUN ;;Functions
"RTN","XMP2",152,0)
 ;;S %1=2 D PP
"RTN","XMP2",153,0)
 ;;D SAVE
"RTN","XMP2",154,0)
 ;;Q
"RTN","XMP2",155,0)
 ;;
"RTN","XMP2",156,0)
PKG ;;Package File
"RTN","XMP2",157,0)
 ;;S %1=2 D PP
"RTN","XMP2",158,0)
 ;;D SAVE
"RTN","XMP2",159,0)
 ;;Q
"RTN","XMP2",160,0)
 ;;
"RTN","XMP2",161,0)
RTN ;;Routine Documentation
"RTN","XMP2",162,0)
 ;;S %1=2 D PP
"RTN","XMP2",163,0)
 ;;D SAVE
"RTN","XMP2",164,0)
 ;;Q
"RTN","XMP2",165,0)
 ;;
"RTN","XMP2",166,0)
DIE ;;Input Templates
"RTN","XMP2",167,0)
 ;;S %1=2 D PP
"RTN","XMP2",168,0)
 ;;D SAVE
"RTN","XMP2",169,0)
 ;;Q
"RTN","XMP2",170,0)
 ;;
"RTN","XMP2",171,0)
DIP ;;Print Templates
"RTN","XMP2",172,0)
 ;;S %1=2 D PP
"RTN","XMP2",173,0)
 ;;D SAVE
"RTN","XMP2",174,0)
 ;;Q
"RTN","XMP2",175,0)
 ;;
"RTN","XMP2",176,0)
DIB ;;Sort Templates
"RTN","XMP2",177,0)
 ;;S %1=2 D PP
"RTN","XMP2",178,0)
 ;;D SAVE
"RTN","XMP2",179,0)
 ;;Q
"RTN","XMP2",180,0)
 ;;
"RTN","XMP2",181,0)
GLB ;;Global
"RTN","XMP2",182,0)
 ;;S %1=2 D PP
"RTN","XMP2",183,0)
 ;;D SAVE
"RTN","XMP2",184,0)
 ;;D COMP
"RTN","XMP2",185,0)
 ;;
"RTN","XMP2",186,0)
DTA ;;FileMan Data
"RTN","XMP2",187,0)
 ;;S %1=1 D PP
"RTN","XMP2",188,0)
 ;;D SAVE
"RTN","XMP2",189,0)
 ;;Q
"RTN","XMP2",190,0)
 ;;
"RTN","XMP2",191,0)
TXT ;;Text
"RTN","XMP2",192,0)
 ;;Q
"RTN","XMP2",193,0)
 ;;Q
"RTN","XMP2",194,0)
 ;;Q
"RTN","XMP2",195,0)
 ;;Q
"RTN","XMP2",196,0)
GLO ;;Global
"RTN","XMP2",197,0)
 ;;S %1=3 D PP
"RTN","XMP2",198,0)
 ;;S XMP2(0)=1 D SAVE K XMP2(0)
"RTN","XMP2",199,0)
 ;;S XMP2(0)=1 D COMP K XMP2(0)
"RTN","XMP2",200,0)
 ;;Q
"RTN","XMP2",201,0)
KID ;;KIDS Distribution
"RTN","XMP2",202,0)
 ;;S %1=4 D PP
"RTN","XMP2",203,0)
 ;;I $T(XMP2^XPDIPM)]"" D XMP2^XPDIPM
"RTN","XMP2",204,0)
 ;;;
"RTN","XMP2",205,0)
 ;;;
"RTN","XMP2A")
0^316^B13988849
"RTN","XMP2A",1,0)
XMP2A ;(WASH ISC)/GM/CAP-PackMan Install ;04/19/2002  12:48
"RTN","XMP2A",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMP2A",3,0)
ENH I $P(XMR,U,7)]"" D  G:$D(XMPKIDS) 2
"RTN","XMP2A",4,0)
 .;check if KIDS format
"RTN","XMP2A",5,0)
 .I $P(XMR,U,7)["K",$$CHECK1("I $E(XMB0,1,5)=""$KID """) S XMPKIDS=1 Q
"RTN","XMP2A",6,0)
 .I $P(XMR,U,7)["X",$$CHECK1("I $E(XMB0,1,11)=""$TXT $KIDS """) S XMPKIDS=1 Q
"RTN","XMP2A",7,0)
 ;check if KIDS but Message Type field got lost
"RTN","XMP2A",8,0)
 I $P(XMR,U,7)="",$$CHECK1("I $E(XMB0,1,5)=""$KID """) S XMPKIDS=1 G 2
"RTN","XMP2A",9,0)
 G 1:$S('$D(DUZ(0)):1,DUZ(0)="@":0,$D(^XUSEC("XUPROGMODE",DUZ)):0,1:1)
"RTN","XMP2A",10,0)
 W !!,$C(7),"Warning:  Installing this message will cause a permanent update of globals"
"RTN","XMP2A",11,0)
 W !,"and routines"_$S($P(XMR,U,7)["X":" and run the INIT",1:"")_"." D  Q:'Y
"RTN","XMP2A",12,0)
 .N DIR,DIRUT
"RTN","XMP2A",13,0)
 .S DIR(0)="Y",DIR("B")="NO",DIR("A")="Do you really want to do this"
"RTN","XMP2A",14,0)
 .D ^DIR
"RTN","XMP2A",15,0)
1 D CHECK D:Y<0  G:'Y Q
"RTN","XMP2A",16,0)
 .N DIR,DIRUT
"RTN","XMP2A",17,0)
 .S DIR(0)="Y",DIR("B")="NO",DIR("A")="This doesn't appear to be an installable message, do you wish to continue"
"RTN","XMP2A",18,0)
 .D ^DIR
"RTN","XMP2A",19,0)
2 S XMPASS=1,XMA0=^XMB(3.9,XMZ,0) I $L(XMB0),$L($P(XMA0,U,10)),$D(^("K")) D ^XMPSEC G 3:$S('$D(DUZ(0)):0,DUZ(0)="@":1,$D(^XUSEC("XUPROGMODE",DUZ)):1,1:0)
"RTN","XMP2A",20,0)
 I $P(XMB0," at ",3)["on" S XMPASS=0 D FAIL^XMPSEC
"RTN","XMP2A",21,0)
 I $S('$D(DUZ(0)):1,DUZ(0)="@":0,$D(^XUSEC("XUPROGMODE",DUZ)):0,1:1) G Q
"RTN","XMP2A",22,0)
3 G X:XMP2="R",ENI^XMP2:XMPASS'=0
"RTN","XMP2A",23,0)
 W !,"This message may not be installed !!" G Q
"RTN","XMP2A",24,0)
X G Z:'$D(XMP2),Z:XMP2'="R" K DIR
"RTN","XMP2A",25,0)
 S DIR("A")="ROUTINE(S)",DIR(0)="FO^2:30",DIR("?")="^D HLP^XMP2A"
"RTN","XMP2A",26,0)
Y D ^DIR K DIRUT G Z:$D(DTOUT)!$D(DUOUT) G:X="" Q:$O(XMP2(""))="",ENI^XMP2
"RTN","XMP2A",27,0)
 I X'?1.A.AN.1"*" W $C(7)," ???" G Y
"RTN","XMP2A",28,0)
 S XMP2(X)="" G Y
"RTN","XMP2A",29,0)
Z G Q^XMP2
"RTN","XMP2A",30,0)
Q K DIR G Q^XMP2
"RTN","XMP2A",31,0)
ENTT ;LIST/PRINT TEXT ONLY
"RTN","XMP2A",32,0)
 N XMI,XMTEXT,XMABORT,XMPAGE
"RTN","XMP2A",33,0)
 S XMI=.999999,XMABORT=0,XMPAGE=1
"RTN","XMP2A",34,0)
 F  S XMI=$O(^XMB(3.9,XMZ,2,XMI)) Q:'XMI  S XMTEXT=^(XMI,0) D  Q:XMABORT
"RTN","XMP2A",35,0)
 . I $E(XMTEXT,1,8)="$END TXT" S XMABORT=1 Q
"RTN","XMP2A",36,0)
 . F  D  Q:$L(XMTEXT)<IOM!XMABORT!(IOM<2)  S XMTEXT=$E(XMTEXT,IOM,999)
"RTN","XMP2A",37,0)
 . . I $Y+3+($G(IOST)["C-")>IOSL D  Q:XMABORT
"RTN","XMP2A",38,0)
 . . . I $G(IOST)["C-" W ! D PAGE^XMXUTIL(.XMABORT) Q:XMABORT
"RTN","XMP2A",39,0)
 . . . W @IOF Q:$G(IOST)["C-"
"RTN","XMP2A",40,0)
 . . . D PAGE2HDR^XMJMP1(XMSUBJ,XMZSTR,.XMPAGE)
"RTN","XMP2A",41,0)
 . . E  W !
"RTN","XMP2A",42,0)
 . . W $S(IOM>1:$E(XMTEXT,1,IOM-1),1:XMTEXT)
"RTN","XMP2A",43,0)
 Q
"RTN","XMP2A",44,0)
ENTR ;INSTALL SELECTED ROUTINE(S) [IN XMP2 ARRAY]
"RTN","XMP2A",45,0)
 F I=0:0 S XCN=$O(^XMB(3.9,XMZ,2,XCN)) Q:XCN=""  S X=^(XCN,0) I $E(X)="$" S Y=$P(X," ",2),J="" F I=0:0 S J=$O(XMP2(J)),K=$L(J)-1 Q:J=""  I $S(J=Y:1,J'?.AN1"*":0,$E(J,1,K)=$E(Y,1,K):1,1:0) D S1^XMP2
"RTN","XMP2A",46,0)
 Q
"RTN","XMP2A",47,0)
HLP ;Routine selection
"RTN","XMP2A",48,0)
 W !!,"Choose routines that you wish to install from this message by entering",!,"single names or a series (XMP2*=all routines that begin with 'XMP2')."
"RTN","XMP2A",49,0)
 W !,"The message is not checked to see if there are any matches to your input.",!,"It may be helpful to request a SUMMARY of the message first."
"RTN","XMP2A",50,0)
 W !,"Only routines selected for installation are backed up.",!!
"RTN","XMP2A",51,0)
 Q
"RTN","XMP2A",52,0)
CHECK ;check text header
"RTN","XMP2A",53,0)
 S %="I $E(XMB0,1,5)=""$TXT "",$P(XMB0,""Created ""_$S(XMB0[""BACKUP"":""on "",1:""by ""),2)?1E.E1"" at "".E1"" at "".E",%=$$CHECK1(%)
"RTN","XMP2A",54,0)
 S Y=$S(%:%,1:-1)
"RTN","XMP2A",55,0)
 Q
"RTN","XMP2A",56,0)
CHECK1(XMCHK) ;Check text header meets condition XMCHK
"RTN","XMP2A",57,0)
 ;returns line number of text header or 0, XMB0=text header
"RTN","XMP2A",58,0)
 N XMCNT,XMFLAG
"RTN","XMP2A",59,0)
 S XMFLAG=0,XMCNT=.999,XMB0=""
"RTN","XMP2A",60,0)
 F  S XMCNT=$O(^XMB(3.9,XMZ,2,XMCNT)) Q:'XMCNT  S XMB0=$G(^(XMCNT,0)) D  Q:'XMCNT
"RTN","XMP2A",61,0)
 .X XMCHK I  S XMFLAG=XMCNT,XMCNT=""
"RTN","XMP2A",62,0)
 Q XMFLAG
"RTN","XMP3")
0^46^B19117242
"RTN","XMP3",1,0)
XMP3 ;(WASH ISC)/AML/CAP-PackMan Build Backup Msg ;04/17/2002  11:07
"RTN","XMP3",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMP3",3,0)
ENTER ; This routine backs up what's on disk into a packman message.
"RTN","XMP3",4,0)
 S X=""
"RTN","XMP3",5,0)
 Q:$D(XMPKIDS)
"RTN","XMP3",6,0)
 N XMABORT,XMANSER
"RTN","XMP3",7,0)
 S XMABORT=0
"RTN","XMP3",8,0)
 D QBACKUP(.XMANSER,.XMABORT) I XMABORT S X=U Q
"RTN","XMP3",9,0)
 I 'XMANSER W !,"No backup message built.",! Q
"RTN","XMP3",10,0)
 D BACKUP(XMDUZ,XMZ,.XMP2,.XMABORT) I XMABORT S X=U
"RTN","XMP3",11,0)
 Q
"RTN","XMP3",12,0)
QBACKUP(Y,XMABORT) ;
"RTN","XMP3",13,0)
 N DIR,DIRUT,X
"RTN","XMP3",14,0)
 W !!,"Routines are the only parts that are backed up.  NO other parts"
"RTN","XMP3",15,0)
 W !,"are backed up, not even globals.  You may use the 'Summarize Message'"
"RTN","XMP3",16,0)
 W !,"option of PackMan to see what parts the message contains."
"RTN","XMP3",17,0)
 W !,"Those parts that are not routines should be backed up separately"
"RTN","XMP3",18,0)
 W !,"if they need to be preserved.",!!
"RTN","XMP3",19,0)
 S DIR(0)="Y"
"RTN","XMP3",20,0)
 S DIR("A")="Shall I preserve the routines on disk in a separate back-up message"
"RTN","XMP3",21,0)
 S DIR("B")="YES"
"RTN","XMP3",22,0)
 S DIR("?",1)="If YES I will build a MailMan message containing the routines that will"
"RTN","XMP3",23,0)
 S DIR("?",2)="be replaced by the Install."
"RTN","XMP3",24,0)
 S DIR("?")="If NO then you will have no automatic backup of routines."
"RTN","XMP3",25,0)
 D ^DIR I $D(DIRUT) S XMABORT=1
"RTN","XMP3",26,0)
 Q
"RTN","XMP3",27,0)
BACKUP(XMDUZ,XMZ,XMSELECT,XMABORT) ;
"RTN","XMP3",28,0)
 ;Initialize message, reset & quit if abort
"RTN","XMP3",29,0)
 N XMINSTR,XMPXMZ
"RTN","XMP3",30,0)
 D BINIT(XMDUZ,.XMPXMZ,.XMINSTR,.XMABORT) Q:XMABORT
"RTN","XMP3",31,0)
 D BTEXT(XMZ,.XMSELECT,XMPXMZ)
"RTN","XMP3",32,0)
 D MOVEPART^XMXSEND(XMDUZ,XMPXMZ,.XMINSTR)
"RTN","XMP3",33,0)
 D SEND^XMKP(XMDUZ,XMPXMZ,.XMINSTR)
"RTN","XMP3",34,0)
 D CHECK^XMKPL
"RTN","XMP3",35,0)
 D CLEANUP^XMXADDR
"RTN","XMP3",36,0)
 W !,"PackMan backup message [",XMPXMZ,"] sent."
"RTN","XMP3",37,0)
 Q
"RTN","XMP3",38,0)
BTEXT(XMZ,XMSELECT,XMPXMZ) ;
"RTN","XMP3",39,0)
 N XCNP,XMCN,XMREC,XMTYPE
"RTN","XMP3",40,0)
 S XCNP=1,XMCN=0
"RTN","XMP3",41,0)
 F  S XMCN=$O(^XMB(3.9,XMZ,2,XMCN)) Q:XMCN'>0  S XMREC=^(XMCN,0)  D
"RTN","XMP3",42,0)
 . Q:$E(XMREC)'="$"
"RTN","XMP3",43,0)
 . Q:"^$TXT^$END^"[(U_$E(XMREC,1,4)_U)
"RTN","XMP3",44,0)
 . S XMTYPE=$E(XMREC,2,4)
"RTN","XMP3",45,0)
 . D @($S(":ROU:GLB:GLO:DDD:DAT:OPT:HEL:BUL:KEY:FUN:PKG:RTN:DIE:DIB:DIP:"[(":"_XMTYPE_":"):XMTYPE,1:"NO"))
"RTN","XMP3",46,0)
 Q
"RTN","XMP3",47,0)
ROU ;save routine
"RTN","XMP3",48,0)
 N X,XMROU
"RTN","XMP3",49,0)
 S X=$P(XMREC," ",2) S:X[U X=$P(X,U,2)
"RTN","XMP3",50,0)
 X ^%ZOSF("TEST") E  W !,"Routine ",X," is not on the disk." Q
"RTN","XMP3",51,0)
 I $O(XMSELECT(""))="" D BROU Q
"RTN","XMP3",52,0)
 S XMROU=""
"RTN","XMP3",53,0)
 F  S XMROU=$O(XMSELECT(XMROU)) Q:XMROU=""!(X=XMROU)  I $E(XMROU,$L(XMROU))="*" Q:$E(X,1,$L(XMROU)-1)=$E(XMROU,1,$L(XMROU)-1)
"RTN","XMP3",54,0)
 D:XMROU'="" BROU
"RTN","XMP3",55,0)
 Q
"RTN","XMP3",56,0)
BROU ;
"RTN","XMP3",57,0)
 N DIF
"RTN","XMP3",58,0)
 S DIF="^XMB(3.9,XMPXMZ,2,"
"RTN","XMP3",59,0)
 S XCNP=XCNP+1
"RTN","XMP3",60,0)
 S ^XMB(3.9,XMPXMZ,2,XCNP,0)="$ROU "_X_" (PACKMAN-BACKUP)"
"RTN","XMP3",61,0)
 X ^%ZOSF("LOAD")
"RTN","XMP3",62,0)
 S ^XMB(3.9,XMPXMZ,2,XCNP,0)="$END ROU "_X_" (PACKMAN-BACKUP)"
"RTN","XMP3",63,0)
 S ^XMB(3.9,XMPXMZ,2,0)="^3.92A^"_XCNP_U_XCNP_U_DT
"RTN","XMP3",64,0)
 Q
"RTN","XMP3",65,0)
GLO ;New global section
"RTN","XMP3",66,0)
GLB ;global...save the part to be updated
"RTN","XMP3",67,0)
 W !,"GLOBAL..................NO BACKUP" Q
"RTN","XMP3",68,0)
DDD ;data dictionary...
"RTN","XMP3",69,0)
 W !,"DATA DICTIONARY.........NO BACKUP" Q
"RTN","XMP3",70,0)
DAT ;fileman data...what to do
"RTN","XMP3",71,0)
 W !,"FILEMAN DATA............NO BACKUP" Q
"RTN","XMP3",72,0)
OPT ;Options
"RTN","XMP3",73,0)
 W !,"OPTIONS.................NO BACKUP" Q
"RTN","XMP3",74,0)
HEL ;Help Frames
"RTN","XMP3",75,0)
 W !,"HELP FRAMES.............NO BACKUP" Q
"RTN","XMP3",76,0)
BUL ;Bulletins
"RTN","XMP3",77,0)
 W !,"BULLETINS...............NO BACKUP" Q
"RTN","XMP3",78,0)
KEY ;Security Keys
"RTN","XMP3",79,0)
 W !,"SECURITY KEYS...........NO BACKUP" Q
"RTN","XMP3",80,0)
FUN ;Functions
"RTN","XMP3",81,0)
 W !,"FUNCTIONS...............NO BACKUP" Q
"RTN","XMP3",82,0)
PKG ;Package File
"RTN","XMP3",83,0)
 W !,"PACKAGE FILE............NO BACKUP" Q
"RTN","XMP3",84,0)
RTN ;Routine Documentation
"RTN","XMP3",85,0)
 W !,"ROUTINE DOCUMENTATION...NO BACKUP" Q
"RTN","XMP3",86,0)
DIE ;Input Templates
"RTN","XMP3",87,0)
 W !,"INPUT TEMPLATES.........NO BACKUP" Q
"RTN","XMP3",88,0)
DIP ;Print Templates
"RTN","XMP3",89,0)
 W !,"PRINT TEMPLATES.........NO BACKUP" Q
"RTN","XMP3",90,0)
DIB ;Sort Templates
"RTN","XMP3",91,0)
 W !,"SORT TEMPLATES..........NO BACKUP" Q
"RTN","XMP3",92,0)
NO ;no way
"RTN","XMP3",93,0)
 W !,"UNDEFINED FUNCTION" Q
"RTN","XMP3",94,0)
BINIT(XMDUZ,XMPXMZ,XMINSTR,XMABORT) ; setup for first routine
"RTN","XMP3",95,0)
 N XMSUBJ,XMREC,XMDT
"RTN","XMP3",96,0)
 D SUBJ^XMJMS(.XMSUBJ,.XMABORT) Q:XMABORT
"RTN","XMP3",97,0)
 D CRE8XMZ^XMXSEND(XMSUBJ,.XMPXMZ,1) I XMPXMZ<1 S XMABORT=1 Q
"RTN","XMP3",98,0)
 D INIT^XMXADDR
"RTN","XMP3",99,0)
 D TOWHOM^XMJMT(XMDUZ,"Send",.XMINSTR,"",.XMABORT)
"RTN","XMP3",100,0)
 I XMABORT D KILLMSG^XMXUTIL(XMPXMZ) Q
"RTN","XMP3",101,0)
 W !,"Building PackMan backup message with subject ",XMSUBJ,!!
"RTN","XMP3",102,0)
 S XMDT=$E($$NOW^XLFDT_"0000",1,12)
"RTN","XMP3",103,0)
 S XMREC="PACKMAN BACKUP Created on "_$$DOW^XLFDT(XMDT)_", "_$$FMTE^XLFDT($P(XMDT,".",1),"2Z")_" at "_$E(XMDT,9,10)_":"_$E(XMDT,11,12)_" "
"RTN","XMP3",104,0)
 I $D(DUZ),$D(^VA(200,DUZ,0)) S XMREC=XMREC_"by "_$$NAME^XMXUTIL(DUZ)_" "
"RTN","XMP3",105,0)
 S:$D(^XMB("NETNAME")) XMREC=XMREC_"at "_$P(^("NETNAME"),U)_" "
"RTN","XMP3",106,0)
 S ^XMB(3.9,XMPXMZ,2,0)=""
"RTN","XMP3",107,0)
 S ^XMB(3.9,XMPXMZ,2,1,0)="$TXT "_XMREC
"RTN","XMP3",108,0)
 Q
"RTN","XMPC")
0^317^B8382242
"RTN","XMPC",1,0)
XMPC ;(WASH ISC)/THM/CAP-PackMan Compare ;04/17/2002  11:09
"RTN","XMPC",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMPC",3,0)
 S S="",%2="",C=IOM-2/2\1,(M,B)=0,H=3
"RTN","XMPC",4,0)
D S M=M+1,B=B+1 G:M>O!(B>F) WRI G:^TMP($J,1,M,0)=^TMP($J,2,B,0) D S W=^TMP($J,1,M,0),(%4,%3)=""
"RTN","XMPC",5,0)
 F I=B:1:$S(B+5<F:B+5,1:F) S V=^TMP($J,2,I,0) D DDD G D:%4="EQUAL"
"RTN","XMPC",6,0)
 S Z=1,G=M D HEAD:'$D(%2) D WP S B=B-1 G D
"RTN","XMPC",7,0)
DDD F K=1:5:26 Q:$L($E(V,K,K+10))<7  I $F(W,$E(V,K,K+10)) S %3="MPART" G E1
"RTN","XMPC",8,0)
 Q
"RTN","XMPC",9,0)
E1 D HEAD G MAT:%3="MPART"!(%4="EQUAL") S Z=1,G=M D WP S B=B-1,%4="EQUAL" Q
"RTN","XMPC",10,0)
MAT S Q=1 F J=B:1:I-1 S X=^TMP($J,2,J,0),Z=1,G=J D WF1
"RTN","XMPC",11,0)
 S B=B+(I-B) S:W=V %4="EQUAL" Q:%4="EQUAL"
"RTN","XMPC",12,0)
 S %4=W,%3=^TMP($J,2,B,0),Q=0,Z=1,L=0
"RTN","XMPC",13,0)
 F K=1:1 S X=$E(%4,1,C-5) S:K=1 G=M D WP1 S Y=X,X=$E(%3,1,C-5) S:K=1 G=B,Z=1 D WF1 S %4=$E(%4,C-4,255),%3=$E(%3,C-4,255) D:X'=Y&$D(S)&(L=0) S I '$L(%3)&('$L(%4)) S %4="EQUAL" Q
"RTN","XMPC",14,0)
 Q
"RTN","XMPC",15,0)
WRI I M>O&(B<(F+1)) F I=B:1:F S X=^TMP($J,2,I,0),Q=1,Z=1,G=I D WF1
"RTN","XMPC",16,0)
 I B>F&(M<(O+1)) F I=M:1:O S X=^TMP($J,1,I,0),Z=1,G=I D WP1
"RTN","XMPC",17,0)
 K %,%0,%1,%2,%3,%4,B,C,D,F,G,H,J,K,L,M,N,O,P,Q,R,S,T,V,W,X,Z
"RTN","XMPC",18,0)
W W !,"-----------------------------------------------------------------------------"
"RTN","XMPC",19,0)
 Q
"RTN","XMPC",20,0)
WP S X=W
"RTN","XMPC",21,0)
WP1 W ! Q:'$L(X)  W " ",$S(Z:$J(G,2),1:"  "),"{",$E(X,1,C-5),$C(125) S Z=0 Q:$L(X)<(C-4)  S X=$E(X,C-4,255) G WP1
"RTN","XMPC",22,0)
WF1 W:Q=1 ! Q:'$L(X)  W ?C+2 W $S(Z:$J(G,2),1:"  "),"{",$E(X,1,C-5),$C(125) S Z=0 Q:$L(X)<(C-4)  S X=$E(X,C-4,255) G WF1
"RTN","XMPC",23,0)
HEAD S:H=2 H=0 Q:H'=0  W !,P," (",IOD,")",?C+1,P," (",E,")" S H=1 Q
"RTN","XMPC",24,0)
S F L=1:1:$L(X) G:$E(X,L)'=$E(Y,L) S1
"RTN","XMPC",25,0)
S1 W !?L+3,"^",?L+C+4,"^" Q
"RTN","XMPC",26,0)
LOAD K ^TMP($J,1),^TMP($J,2) S (X,R)=$P(X," ",2) S:X[U (X,R)=$P(R,U,2) I '$D(^%ZOSF("TEST")) W !,"Routine compare not available. " Q
"RTN","XMPC",27,0)
 X ^%ZOSF("TEST") I '$T W !,"Routine ",R," missing from disk." G W
"RTN","XMPC",28,0)
 S DIF="^TMP($J,1,",XCNP=0,X=R X ^%ZOSF("LOAD") S O=XCNP
"RTN","XMPC",29,0)
L3 F F=0:0 D NT Q:+XCN'=XCN!($E(X,1,4)["$END")  I $E(X)'="$" S F=F+1,^TMP($J,2,F,0)=X
"RTN","XMPC",30,0)
 S O=O-1 G XMPC
"RTN","XMPC",31,0)
NT S XCN=$O(@(DIE_XCN_")")) Q:+XCN'=XCN  S X=^(XCN,0) Q
"RTN","XMPC",32,0)
COMP ;COMPARE MESSAGE X TO MESSAGE Y
"RTN","XMPC",33,0)
 S J=.999
"RTN","XMPC",34,0)
C1 S J=$O(^XMB(3.9,X,2,J)) Q:J=""  G C1:^(J,0)=^XMB(3.9,Y,2,J,0)
"RTN","XMPC",35,0)
 W !,"NOT THE SAME" Q
"RTN","XMPC",36,0)
TOP ;W @IOF,!,"MailMan PackMan Compare - For "_XMDUN
"RTN","XMPC",37,0)
 I '$D(XMR) S XMR=^XMB(3.9,XMZ,0)
"RTN","XMPC",38,0)
 I $G(IOST)'["C-" D
"RTN","XMPC",39,0)
 . W "MailMan PackMan Compare - For ",XMV("NAME")
"RTN","XMPC",40,0)
 . W !,"Message #"_XMZ,!,"Subject: "_$P(XMR,U),!,"From: "_$$NAME^XMXUTIL($P(XMR,U,2))
"RTN","XMPC",41,0)
 . D NOW^%DTC S XMA=%,X=% D DW^%DTC W !,X,"  " S Y=XMA D DD^%DT
"RTN","XMPC",42,0)
 . W Y X ^%ZOSF("UCI") W " ("_Y_")",!
"RTN","XMPC",43,0)
 S I="",$P(I,"*",81)=""
"RTN","XMPC",44,0)
 W !,I,!,"Message #"_XMZ_"     Routine from DISK on LEFT - from Message on RIGHT",!,I,!
"RTN","XMPC",45,0)
 K %H,%T,%Y,%,XMA
"RTN","XMPC",46,0)
 Q
"RTN","XMPD")
1^172
"RTN","XMPDAT")
1^224
"RTN","XMPG")
0^318^B10765431
"RTN","XMPG",1,0)
XMPG ;(WASH ISC)/THM/CAP-PackMan Global List/Load ;04/17/2002  11:12
"RTN","XMPG",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMPG",3,0)
 ; Entry point (DBIA 10071):
"RTN","XMPG",4,0)
 ; ENT  Load and send a packman message with globals
"RTN","XMPG",5,0)
 ;
"RTN","XMPG",6,0)
 ; Entry points used by MailMan options (not covered by DBIA):
"RTN","XMPG",7,0)
 ; LOAD  XMPGLO - Load global
"RTN","XMPG",8,0)
 ;
"RTN","XMPG",9,0)
 ; If you D ^XMPG, you are asked for a global, and it is printed
"RTN","XMPG",10,0)
 ; to whichever device you choose.
"RTN","XMPG",11,0)
 S %1="W !,D,""="",@D",%2="W !,%G_I_"")="",%T"
"RTN","XMPG",12,0)
 D ^%ZIS G K:POP
"RTN","XMPG",13,0)
 D R
"RTN","XMPG",14,0)
 I IO(0)'=IO U IO D ^%ZISC
"RTN","XMPG",15,0)
 D HOME^%ZIS
"RTN","XMPG",16,0)
 Q
"RTN","XMPG",17,0)
R D N G R:K G K:%G="" U IO D EN G R
"RTN","XMPG",18,0)
EN K I,R G K:%G="" S %0=0,Q=$C(34),R=1 D GP
"RTN","XMPG",19,0)
 S D=$P(%G,"(",1) I @("$D("_D_")#2"),$L(@D) X %1
"RTN","XMPG",20,0)
 D S Q
"RTN","XMPG",21,0)
S S I=Q_Q
"RTN","XMPG",22,0)
DISK S @("I=$O("_%G_I_"))") Q:I=""  S D=$D(^(I)),%0=%0+1 S:D#2 %T=^(I)
"RTN","XMPG",23,0)
 F J=1:1:$L(I) S J=$F(I,Q,J) Q:J=0  S I=$E(I,1,J-1)_Q_$E(I,J,999)
"RTN","XMPG",24,0)
 I I'?1.N&(I'?.N1"."1.N)!(I?1"0".1"."1.N)!(I?.N1".".N1."0") S I=""""_I_""""
"RTN","XMPG",25,0)
 X:D#2 %2 I D>9 D PUSH S %G=%G_I_"," D S,POP
"RTN","XMPG",26,0)
 G DISK
"RTN","XMPG",27,0)
PUSH S R=R+1,I(R)=I,R(R)=%G Q
"RTN","XMPG",28,0)
POP S I=I(R),%G=R(R),R=R-1 Q
"RTN","XMPG",29,0)
K K %,%0,%1,%2,%D,%G,%GQ,%T,D,I,K,POP,Q,R
"RTN","XMPG",30,0)
 Q
"RTN","XMPG",31,0)
 ;
"RTN","XMPG",32,0)
LOAD ;LOAD GLOBAL INTO MESSAGE DEFINED IN <DIE>
"RTN","XMPG",33,0)
 S (DIE,DIF)="^XMB(3.9,XMZ,2," S:'$D(XCNP) XCNP=0 D %
"RTN","XMPG",34,0)
L1 D N G L1:K I %G="" S @(DIE_"0)")="^^"_XCNP_U_XCNP G K
"RTN","XMPG",35,0)
 W "   Loading..." D MOVE G L1
"RTN","XMPG",36,0)
SET S XCNP=XCNP+1,@(DIE_XCNP_",0)")=%D Q
"RTN","XMPG",37,0)
GP S R=1,%G=$E("^",$E(%G)'="^")_%G
"RTN","XMPG",38,0)
 I ",("'[$E(%G,$L(%G)) S %G=%G_$E("(,",%G["("+1)
"RTN","XMPG",39,0)
 Q
"RTN","XMPG",40,0)
N ;GET NAME OF GLOBAL
"RTN","XMPG",41,0)
 U IO(0) S K=0 R !,"Global: ",%G:DTIME S I=$E(%G) Q:I=""
"RTN","XMPG",42,0)
 I I="^",I=%G S %G="" Q
"RTN","XMPG",43,0)
 I I'?1A,I'="%" G N1
"RTN","XMPG",44,0)
 I I'?1A,I'="%" S %G="",K=1 W !,"MUST BEGIN WITH % OR LETTER" Q
"RTN","XMPG",45,0)
 I I="^" S %G=$E(%G,2,99)
"RTN","XMPG",46,0)
 I $P(%G,"(")'?0.1"%".AN D N1 Q
"RTN","XMPG",47,0)
 I $E(%G,$L(%G))=")" S %G="",K=1 W !,"DO NOT END GLOBAL REFERENCE WITH ')'" Q
"RTN","XMPG",48,0)
 S I=$P(%G,"(",2,99) F J=1:1 Q:$P(I,",",J,99)=""  I $P(I,",",J)="" S K=1 W $C(7),!,"EACH SUBSCRIPT MUST HAVE A VALUE" Q
"RTN","XMPG",49,0)
 F J=1:1 S I=$P($P(%G,"(",2),",",J) Q:I=""  I +I'=I S I=$S($E(I)'=$C(34):1,$E(I,$L(I))'=$C(34):2,$L(I,$C(34))-1#2:3,1:0) I I S K=1 W $C(7),!,"Invalid entry !  Please enter the EXACT values of the subscripts." Q
"RTN","XMPG",50,0)
 Q
"RTN","XMPG",51,0)
N1 S %G="",K=1 W !,"GLOBAL NAME MUST BEGIN WITH '%' OR LETTER" Q
"RTN","XMPG",52,0)
 ;
"RTN","XMPG",53,0)
ENT ;LOAD UP GLOBAL ENTRY POINT FROM OUTSIDE ROUTINES
"RTN","XMPG",54,0)
 ; Input:
"RTN","XMPG",55,0)
 ; DUZ    Sender's DUZ
"RTN","XMPG",56,0)
 ; XMSUB  Message subject
"RTN","XMPG",57,0)
 ; XMY    Recipient array
"RTN","XMPG",58,0)
 ; XMTEXT String of open global roots separated by semicolon
"RTN","XMPG",59,0)
 ; Output:
"RTN","XMPG",60,0)
 ; XMZ    Message number
"RTN","XMPG",61,0)
 ; Kills:
"RTN","XMPG",62,0)
 ; XMY
"RTN","XMPG",63,0)
 N XMV,XMDF,XMINSTR,XMPIECE
"RTN","XMPG",64,0)
 K XMERR,^TMP("XMERR",$J)
"RTN","XMPG",65,0)
 S XMDF=1
"RTN","XMPG",66,0)
 S XMINSTR("ADDR FLAGS")="R"
"RTN","XMPG",67,0)
 D INIT^XMVVITAE
"RTN","XMPG",68,0)
 D CRE8XMZ^XMXSEND(XMSUB,.XMZ)
"RTN","XMPG",69,0)
 I $D(XMERR) D  Q
"RTN","XMPG",70,0)
 . S XMMG=^TMP("XMERR",$J,1,"TEXT",1)
"RTN","XMPG",71,0)
 . K XMERR,^TMP("XMERR",$J)
"RTN","XMPG",72,0)
 D NEW^XMP
"RTN","XMPG",73,0)
 D %
"RTN","XMPG",74,0)
 S (DIE,DIF)="^XMB(3.9,XMZ,2,"
"RTN","XMPG",75,0)
 F XMPIECE=1:1:$L(XMTEXT,";") D
"RTN","XMPG",76,0)
 . S %G=$P(XMTEXT,";",XMPIECE)
"RTN","XMPG",77,0)
 . Q:%G=""
"RTN","XMPG",78,0)
 . D MOVE
"RTN","XMPG",79,0)
 K XCNP
"RTN","XMPG",80,0)
 D K
"RTN","XMPG",81,0)
 Q:'$O(^XMB(3.9,XMZ,2,1))
"RTN","XMPG",82,0)
 D ADDRNSND^XMXSEND(XMDUZ,XMZ,.XMY,.XMINSTR)
"RTN","XMPG",83,0)
 K:$D(XMERR) XMERR,^TMP("XMERR",$J)
"RTN","XMPG",84,0)
 K XMY
"RTN","XMPG",85,0)
 Q
"RTN","XMPG",86,0)
MOVE ;MOVE GLOBAL INTO MESSAGE
"RTN","XMPG",87,0)
 S %D="$GLO "_%G D SET
"RTN","XMPG",88,0)
 D EN S %D="$END GLO "_%G D SET
"RTN","XMPG",89,0)
 S $P(@(DIE_"0)"),U,3,4)=XCNP_U_XCNP
"RTN","XMPG",90,0)
 Q
"RTN","XMPG",91,0)
% ;SET UP EXECUTABLE STRINGS
"RTN","XMPG",92,0)
 S %1="S %D=D D SET S %D=@D D SET"
"RTN","XMPG",93,0)
 S %2="S %D=%G_I_"")"" D SET S %D=%T D SET W:'(%0#25)&'$D(ZTQUEUED) ""."""
"RTN","XMPG",94,0)
 Q
"RTN","XMPH")
0^319^B11811007
"RTN","XMPH",1,0)
XMPH ;(WASH ISC)/THM/CAP-PackMan Load Routines/Print Msg ;04/17/2002  11:13
"RTN","XMPH",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMPH",3,0)
 ; Entry points used by MailMan options (not covered by DBIA):
"RTN","XMPH",4,0)
 ; LOAD   XMPROU - Load routines
"RTN","XMPH",5,0)
 ;USER ENTRY LIST OF ROUTINES
"RTN","XMPH",6,0)
 Q
"RTN","XMPH",7,0)
DEV ;GET OUTPUT DEVICE / QUEUE PACKMAN PRINT
"RTN","XMPH",8,0)
 N I,ZTSAVE
"RTN","XMPH",9,0)
 F I="DIE","XMZ","XMDUZ","XMV(","XMP2","XMR","XCF" S ZTSAVE(I)=""
"RTN","XMPH",10,0)
 D EN^XUTMDEVQ("ZTSK^XMPH","MailMan: PackMan Print",.ZTSAVE)
"RTN","XMPH",11,0)
 Q
"RTN","XMPH",12,0)
ZTSK ;QUEUED PRINT COMES HERE
"RTN","XMPH",13,0)
 N XMSUBJ,XMZSTR
"RTN","XMPH",14,0)
 I XCF=3 D
"RTN","XMPH",15,0)
 . D TOP^XMPC
"RTN","XMPH",16,0)
 E  I $G(IOST)'["C-" D
"RTN","XMPH",17,0)
 . N XMPARM,XMZREC
"RTN","XMPH",18,0)
 . S XMZREC=$G(^XMB(3.9,XMZ,0))
"RTN","XMPH",19,0)
 . W $$EZBLD^DIALOG($S($P(XMZREC,U,7)["K":34076,1:34077)) ; KIDS Build / PackMan message
"RTN","XMPH",20,0)
 . W $S(XMP2="T":" text print for ",1:" print for "),XMV("NAME")
"RTN","XMPH",21,0)
 . S XMPARM(1)=^XMB("NETNAME"),XMPARM(2)=$$MMDT^XMXUTIL1($$NOW^XLFDT)
"RTN","XMPH",22,0)
 . W !,$$EZBLD^DIALOG(34503,.XMPARM) ; Printed at |1| |2|
"RTN","XMPH",23,0)
 . Q:XMP2="S"
"RTN","XMPH",24,0)
 . S XMSUBJ=$$EZBLD^DIALOG(34536,$$SUBJ^XMXUTIL2(XMZREC)) ; Subj: |1|
"RTN","XMPH",25,0)
 . S XMZSTR=$$EZBLD^DIALOG(34537,XMZ) ; [#|1|]
"RTN","XMPH",26,0)
 . W !,XMSUBJ
"RTN","XMPH",27,0)
 . D W^XMJMP1("  ",XMZSTR)
"RTN","XMPH",28,0)
 . D W^XMJMP1(" ",$$DATE^XMXUTIL2(XMZREC))
"RTN","XMPH",29,0)
 . D WL^XMJMP1($$EZBLD^DIALOG(34538,$$NAME^XMXUTIL($P(XMZREC,U,2),1))) ; From:
"RTN","XMPH",30,0)
 . D W^XMJMP1(" ",$$EZBLD^DIALOG(34541)) ; Page 1
"RTN","XMPH",31,0)
 . D LINE^XMJMP1
"RTN","XMPH",32,0)
 . W !
"RTN","XMPH",33,0)
 D S^XMP2
"RTN","XMPH",34,0)
 I $D(ZTQUEUED) S ZTREQ="@"
"RTN","XMPH",35,0)
 Q
"RTN","XMPH",36,0)
LOAD ;LOAD ROUTINE FROM <X> INTO GLOBAL <DIF>_I_",0)"
"RTN","XMPH",37,0)
 ;
"RTN","XMPH",38,0)
 ;DIFROM NEEDS A MESSAGE NUMBER
"RTN","XMPH",39,0)
 ;
"RTN","XMPH",40,0)
 S (DIE,DIF)="^XMB(3.9,XMZ,2,"
"RTN","XMPH",41,0)
 I $D(DIFROM) W !!,"Please enter the names of the routines you wish to load into this message.",!!,"Only routines will be loaded."
"RTN","XMPH",42,0)
 I  W !!,"INITs, will be sent automatically.",!!
"RTN","XMPH",43,0)
 ;K ^UTILITY($J#256)
"RTN","XMPH",44,0)
 X ^%ZOSF("RSEL") Q:$O(^UTILITY($J,0))=""
"RTN","XMPH",45,0)
 S X=0 S:'$D(XCNP) XCNP=0
"RTN","XMPH",46,0)
 F  S X=$O(^UTILITY($J,X)) Q:X=""  D LL
"RTN","XMPH",47,0)
 K ^UTILITY($J)
"RTN","XMPH",48,0)
 Q
"RTN","XMPH",49,0)
LL N XMHOLD S XMHOLD=XCNP
"RTN","XMPH",50,0)
 W !,"Loading ",X S DIF=DIE,XCNP=XCNP+1,@(DIF_XCNP_",0)")="$ROU "_X
"RTN","XMPH",51,0)
 X ^%ZOSF("LOAD") S $P(@(DIF_"0)"),U,3,4)=XCNP_U_XCNP
"RTN","XMPH",52,0)
 S @(DIF_XCNP_",0)")="$END ROU "_X
"RTN","XMPH",53,0)
 ;
"RTN","XMPH",54,0)
 ;Check for control characters in text
"RTN","XMPH",55,0)
 F XMHOLD=XMHOLD:1:XCNP I $G(@(DIF_XMHOLD_",0)"))?.E1C.E D  S XQCH="HALT" G H^XUS
"RTN","XMPH",56,0)
 . W !!,$C(7),"Errored out loading routine ",X," - control character in text."
"RTN","XMPH",57,0)
 . W !,"Use ^XINDEX to identify it, then remove from routine and try again.",!!
"RTN","XMPH",58,0)
 . D KILLMSG^XMXUTIL(XMZ)
"RTN","XMPH",59,0)
 Q
"RTN","XMPH",60,0)
 ;
"RTN","XMPH",61,0)
PACK ;LOAD ENTIRE PACKAGE (ROUTINES ONLY)
"RTN","XMPH",62,0)
 ;
"RTN","XMPH",63,0)
 S:'$D(XCNP) XCNP=0
"RTN","XMPH",64,0)
 I '$D(DIFROM) S DIC="^DIC(9.4,",DIC(0)="AEQM" D ^DIC Q:Y<0  S DA=+Y
"RTN","XMPH",65,0)
 S XMROU="^DIC(9.4,"_DA_",2,""B"","
"RTN","XMPH",66,0)
P S (XMA0,XMB0)="",(DIE,DIF)="^XMB(3.9,"_XMZ_",2,"
"RTN","XMPH",67,0)
 G P9:'$D(^%ZOSF("TEST")) S XMB=^("TEST")
"RTN","XMPH",68,0)
P1 S XMA0=$O(@(XMROU_"XMA0)")) I $L(XMA0) D TST G P1
"RTN","XMPH",69,0)
 G ER:XMB0
"RTN","XMPH",70,0)
P9 S XMA0=$O(@(XMROU_"XMA0)")) G Q:XMA0="" S X=XMA0 D LL G P9
"RTN","XMPH",71,0)
 ;
"RTN","XMPH",72,0)
XMROU ;LOAD ROUTINES (FROM XMD)
"RTN","XMPH",73,0)
 ;
"RTN","XMPH",74,0)
 S XCNP=XCNP+1,$P(^XMB(3.9,XMZ,2,0),U,3,4)=XCNP_U_XCNP,^(XCNP,0)="$END TXT"
"RTN","XMPH",75,0)
 S XMROU="XMROU(" G P
"RTN","XMPH",76,0)
 ;
"RTN","XMPH",77,0)
TST S X=XMA0 X XMB Q:$T  S XMB0=1 W !,"Program ",X," does not exist." Q
"RTN","XMPH",78,0)
ER W !!,"<< Correct the errors listed above.",!,"Then you may try again.",!
"RTN","XMPH",79,0)
Q K XMA0,XMB0,XMB,XMROU,DIE,DIF Q
"RTN","XMPSEC")
0^320^B22927463
"RTN","XMPSEC",1,0)
XMPSEC ;ISC-SF/GMB-PackMan Security ;04/17/2002  11:13
"RTN","XMPSEC",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMPSEC",3,0)
 ; Code rewritten.  Originally (ISC-WASH/GM/CAP)
"RTN","XMPSEC",4,0)
 ; Includes the former ^XMASEC (ISC-WASH/GM)
"RTN","XMPSEC",5,0)
 N I,XMTVAL,XMSTR
"RTN","XMPSEC",6,0)
 W !,"This message has been secured!"
"RTN","XMPSEC",7,0)
 S XMPASS=1
"RTN","XMPSEC",8,0)
 I '$D(XMSECURE),'$$KEYOK^XMJMCODE(XMZ,$P(XMA0,U,10)) S XMPASS=0 Q
"RTN","XMPSEC",9,0)
 W !,"Checking the package's integrity... (This may take some time.)",!
"RTN","XMPSEC",10,0)
 S I=$O(^XMB(3.9,XMZ,2,.999))
"RTN","XMPSEC",11,0)
 I $P(^(I,0),U,3,9999)'=$$ENCSTR^XMJMCODE("$SEC^3") S XMPASS=0 D FAIL Q
"RTN","XMPSEC",12,0)
 S I=1,XMTVAL=0
"RTN","XMPSEC",13,0)
P0 F  S I=$O(^XMB(3.9,XMZ,2,I)) Q:'I  D
"RTN","XMPSEC",14,0)
 . Q:'$D(^(I,0))  ; naked reference to line above
"RTN","XMPSEC",15,0)
 . S XMSTR=^(0)   ; naked reference to line above
"RTN","XMPSEC",16,0)
 . I $E(XMSTR)="$" D CSCRAM(XMSTR) Q
"RTN","XMPSEC",17,0)
 . I 'XMB0 W:$X>75 ! W "." Q
"RTN","XMPSEC",18,0)
 . D VAL(XMSTR,.XMTVAL)
"RTN","XMPSEC",19,0)
 W !,"<<< DONE >>>",!
"RTN","XMPSEC",20,0)
 D:'XMPASS FAIL
"RTN","XMPSEC",21,0)
 Q
"RTN","XMPSEC",22,0)
VAL(XMSTR,XMTVAL) ;
"RTN","XMPSEC",23,0)
 N XMLVAL,I
"RTN","XMPSEC",24,0)
 S XMLVAL=0
"RTN","XMPSEC",25,0)
 F I=1:1:$L(XMSTR) S XMLVAL=$A(XMSTR,I)*I+XMLVAL
"RTN","XMPSEC",26,0)
 S XMTVAL=XMTVAL+XMLVAL+$L(XMSTR)
"RTN","XMPSEC",27,0)
 Q
"RTN","XMPSEC",28,0)
CSCRAM(XMSTR) ;
"RTN","XMPSEC",29,0)
 S XMB0=$S(XMSTR'["TXT":1,1:0)
"RTN","XMPSEC",30,0)
 I XMSTR["ROU",$P(XMSTR," ",2)?1"^".AN1"NTEG" D CNTEG Q
"RTN","XMPSEC",31,0)
 I XMSTR'["$END"!($E(XMSTR,1,8)="$END TXT"&'XMB0) S XMTVAL=0,XMA0=$P(XMSTR," ",2) Q
"RTN","XMPSEC",32,0)
 W "." I $P(XMSTR," ",2)="MESSAGE" Q
"RTN","XMPSEC",33,0)
 S XMA0=$S(XMSTR["$GLB":$P(XMSTR,U,2),XMSTR["$GLO":$P(XMSTR,U,2),1:$P($P(XMSTR,U)," ",3))
"RTN","XMPSEC",34,0)
 I XMSTR["ROU" W:$X>70 ! W $J($E(XMA0,1,9),10)
"RTN","XMPSEC",35,0)
 E  W !,$P($E(XMSTR,5,99),U)
"RTN","XMPSEC",36,0)
 ;CHECK SUM EVALUTAION
"RTN","XMPSEC",37,0)
 Q:$P(XMSTR,U,2,999)=$$ENCSTR^XMJMCODE("$SEC"_U_(XMTVAL+XMPAKMAN("XMRW")))
"RTN","XMPSEC",38,0)
 W !!,"******** ",$J(XMA0,10)," has failed !!!!!!!!!!!",!!
"RTN","XMPSEC",39,0)
 S (XMTVAL,XMPASS)=0
"RTN","XMPSEC",40,0)
 Q
"RTN","XMPSEC",41,0)
FAIL ;
"RTN","XMPSEC",42,0)
 N XMTEXT,XMTO,XMFROM
"RTN","XMPSEC",43,0)
 S:'$D(XMPASS) XMPASS=0
"RTN","XMPSEC",44,0)
 S XMTEXT(1,0)="A package with the subject: "_$P(^XMB(3.9,XMZ,0),U)
"RTN","XMPSEC",45,0)
 S XMTEXT(2,0)="failed the security check during installation"_$S($D(XMPASS):".",1:", but was installed anyway.")
"RTN","XMPSEC",46,0)
 S XMFROM=$P(^XMB(3.9,XMZ,0),U,2)
"RTN","XMPSEC",47,0)
 I $G(XMFROM)["<" S XMTO(P($P(XMFROM,"<",2),">"))=""
"RTN","XMPSEC",48,0)
 S XMTO(XMDUZ)=""
"RTN","XMPSEC",49,0)
 D SENDMSG^XMXSEND(XMDUZ,"Failed Security","XMTEXT",.XMTO)
"RTN","XMPSEC",50,0)
 Q
"RTN","XMPSEC",51,0)
CHECK ;FROM XMP2
"RTN","XMPSEC",52,0)
 Q:XCF'=2
"RTN","XMPSEC",53,0)
 I "$DDD$RTN$DIE$DIB$DIP$ROU$GLB$GLO$OPT$HEL$BUL$KEY$PKG$FUN"[$E(X,1,4),X[U D  Q
"RTN","XMPSEC",54,0)
 . D:'$D(XMPASS) FAIL
"RTN","XMPSEC",55,0)
 . S X=$P(X,U)_$P(X,U,2)
"RTN","XMPSEC",56,0)
 . S:$P(X," ",2)?.EU1"INIT"&($E(X,1,4)="$ROU") XMINIT=U_$P(X," ",2)
"RTN","XMPSEC",57,0)
 I $E(X,1,12)="$END MESSAGE",'$D(XMPASS) D FAIL
"RTN","XMPSEC",58,0)
 Q
"RTN","XMPSEC",59,0)
CNTEG ; Skip processing XXXINTEG program
"RTN","XMPSEC",60,0)
 S XMINTEG=$P(X," ",2)
"RTN","XMPSEC",61,0)
 F  S I=$O(^XMB(3.9,XMZ,2,I)) Q:'I  Q:"$END"[$E(^(I,0),1,4)
"RTN","XMPSEC",62,0)
 Q
"RTN","XMPSEC",63,0)
PSECURE(XMZ,XMABORT) ; Secure the PackMan message
"RTN","XMPSEC",64,0)
 N XMKEY,XMHINT,XMNO,XMSECURE
"RTN","XMPSEC",65,0)
 S XMABORT=0
"RTN","XMPSEC",66,0)
 D PQSEC(.XMNO,.XMABORT) Q:XMNO!XMABORT
"RTN","XMPSEC",67,0)
 D CRE8KEY^XMJMCODE(.XMKEY,.XMHINT,.XMABORT) Q:XMABORT
"RTN","XMPSEC",68,0)
 W !!,"Securing the message now.  This may take a while.",!
"RTN","XMPSEC",69,0)
 D LOADCODE^XMJMCODE
"RTN","XMPSEC",70,0)
 D ADJUST^XMJMCODE(.XMKEY)
"RTN","XMPSEC",71,0)
 D PSTORE(XMZ,XMKEY,XMHINT)
"RTN","XMPSEC",72,0)
 D PSECIT(XMZ)
"RTN","XMPSEC",73,0)
 Q
"RTN","XMPSEC",74,0)
PQSEC(XMOK,XMABORT) ;
"RTN","XMPSEC",75,0)
 N DIR,Y,X
"RTN","XMPSEC",76,0)
 S DIR(0)="Y"
"RTN","XMPSEC",77,0)
 S DIR("A")="Do you wish to secure this message"
"RTN","XMPSEC",78,0)
 S DIR("B")="NO"
"RTN","XMPSEC",79,0)
 S DIR("?",1)="If you answer yes, this message will be secured"
"RTN","XMPSEC",80,0)
 S DIR("?")="to ensure that what you send is what is actually received."
"RTN","XMPSEC",81,0)
 D ^DIR
"RTN","XMPSEC",82,0)
 I $D(DIRUT) S XMABORT=1
"RTN","XMPSEC",83,0)
 S XMNO='Y
"RTN","XMPSEC",84,0)
 Q
"RTN","XMPSEC",85,0)
PSTORE(XMZ,XMKEY,XMHINT) ;
"RTN","XMPSEC",86,0)
 N XMFDA,XMIENS
"RTN","XMPSEC",87,0)
 S XMIENS=XMZ_","
"RTN","XMPSEC",88,0)
 S XMFDA(3.9,XMIENS,1.8)=$S($G(XMHINT)="":" ",1:XMHINT)
"RTN","XMPSEC",89,0)
 S XMFDA(3.9,XMIENS,1.85)="1"_$$ENCSTR^XMJMCODE(XMKEY)
"RTN","XMPSEC",90,0)
 D FILE^DIE("","XMFDA")
"RTN","XMPSEC",91,0)
 Q
"RTN","XMPSEC",92,0)
PSECIT(XMZ) ;
"RTN","XMPSEC",93,0)
 N XMSTR,I,XMTVAL
"RTN","XMPSEC",94,0)
 S I=$O(^XMB(3.9,XMZ,2,.999))
"RTN","XMPSEC",95,0)
 S XMSTR=^XMB(3.9,XMZ,2,I,0)
"RTN","XMPSEC",96,0)
 S XMSTR=$P(XMSTR,"on")_"at "_$P(XMSTR," at ",3)_" on"_$P($P(XMSTR,"on",2)," at",1)
"RTN","XMPSEC",97,0)
 S ^XMB(3.9,XMZ,2,I,0)=XMSTR_U_$$ENCSTR^XMJMCODE("$SEC^3")
"RTN","XMPSEC",98,0)
 S I=0
"RTN","XMPSEC",99,0)
 F  S I=$O(^XMB(3.9,XMZ,2,I)) Q:'I  D
"RTN","XMPSEC",100,0)
 . Q:'$D(^(I,0))   ; naked reference to line above
"RTN","XMPSEC",101,0)
 . S XMSTR=^(0)    ; naked reference to line above
"RTN","XMPSEC",102,0)
 . I $E(XMSTR)="$" D PSCRAM(XMZ,.I,XMSTR,.XMTVAL) Q
"RTN","XMPSEC",103,0)
 . D VAL(XMSTR,.XMTVAL)
"RTN","XMPSEC",104,0)
 S XMSTR(1)="$END MESSAGE"
"RTN","XMPSEC",105,0)
 D MOVEBODY^XMXSEND(XMZ,"XMSTR","A")
"RTN","XMPSEC",106,0)
 Q
"RTN","XMPSEC",107,0)
PSCRAM(XMZ,I,XMSTR,XMTVAL) ;
"RTN","XMPSEC",108,0)
 I $E(XMSTR,1,4)="$END" S $P(^XMB(3.9,XMZ,2,I,0),U,2)=$$ENCSTR^XMJMCODE("$SEC"_U_(XMTVAL+XMPAKMAN("XMRW"))) Q
"RTN","XMPSEC",109,0)
 I $E(XMSTR,1,4)="$ROU" D  I $P(XMSTR," ",2)?.AN1"NTEG" D PNTEG(XMZ,.I,XMSTR) Q
"RTN","XMPSEC",110,0)
 . W:$X>70 !
"RTN","XMPSEC",111,0)
 . W $J($P(XMSTR," ",2),10)
"RTN","XMPSEC",112,0)
 S XMTVAL=0
"RTN","XMPSEC",113,0)
 S $P(^XMB(3.9,XMZ,2,I,0)," ",2)=$S($E(XMSTR,1,4)'="$KID":U,1:"")_$P(XMSTR," ",2)
"RTN","XMPSEC",114,0)
 Q
"RTN","XMPSEC",115,0)
PNTEG(XMZ,I,XMSTR) ;
"RTN","XMPSEC",116,0)
 S $P(^XMB(3.9,XMZ,2,I,0)," ",2)=U_$P(XMSTR," ",2)
"RTN","XMPSEC",117,0)
 F  S I=$O(^XMB(3.9,XMZ,2,I)) Q:'I  S XMSTR=^(I,0) Q:"$END"[$E(XMSTR_" ",1,4)  D
"RTN","XMPSEC",118,0)
 . S:XMSTR?.UN1" ;;".N $P(^XMB(3.9,XMZ,2,I,0),";",3)=$$ENCSTR^XMJMCODE($P(XMSTR,";",3)+XMPAKMAN("XMRW"))
"RTN","XMPSEC",119,0)
 Q
"RTN","XMPX")
1^234
"RTN","XMR")
0^47^B45958212
"RTN","XMR",1,0)
XMR ;ISC-SF/GMB-SMTP Receiver (RFC 821) ;05/07/2002  13:13
"RTN","XMR",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMR",3,0)
ENT ; INITIALIZE
"RTN","XMR",4,0)
 S ER=0
"RTN","XMR",5,0)
 S XMC("NOREQUEUE")=1
"RTN","XMR",6,0)
 D GET^XMCXT(0)
"RTN","XMR",7,0)
 I '$D(XMC("BATCH")) S XMC("BATCH")=0
"RTN","XMR",8,0)
 D OPEN^XML I ER D  Q
"RTN","XMR",9,0)
 . D ^%ZISC:IO'=$G(IO(0)) W !,$C(7),$$EZBLD^DIALOG(42227) ;Open failed
"RTN","XMR",10,0)
 S:'$D(XM) XM=""
"RTN","XMR",11,0)
 I XMC("BATCH") U IO
"RTN","XMR",12,0)
 E  D
"RTN","XMR",13,0)
 . X ^%ZOSF("EOFF")
"RTN","XMR",14,0)
 . S X=255
"RTN","XMR",15,0)
 . X ^%ZOSF("RM"),^%ZOSF("TYPE-AHEAD")
"RTN","XMR",16,0)
 S XMC("START")=$$TSTAMP^XMXUTIL1-.001
"RTN","XMR",17,0)
 D RECEIVE
"RTN","XMR",18,0)
 ;I $G(XMINST) D XMTFINIS^XMTDR(XMINST)
"RTN","XMR",19,0)
 Q
"RTN","XMR",20,0)
RECEIVE ; BEGINNING OF INTERPRETER
"RTN","XMR",21,0)
 ; The following variables are used in here only.  They are not
"RTN","XMR",22,0)
 ; 'new'd because this routine may be called recursively via the
"RTN","XMR",23,0)
 ; TURN command, which alternates sending and receiving.
"RTN","XMR",24,0)
 S XMC("DIR")="R"
"RTN","XMR",25,0)
 D KILL
"RTN","XMR",26,0)
 S XMEC=0,XMCONT="^HELP^NOOP^RSET^QUIT^VRFY^EXPN^STAT^CHRS^ECHO^"
"RTN","XMR",27,0)
 D DOTRAN^XMC1(42300,$$FMTE^XLFDT(DT,5)) ;Transcript Date: |1|
"RTN","XMR",28,0)
 S XMSTATE="^HELO^QUIT^"
"RTN","XMR",29,0)
 I 'XMC("BATCH") D
"RTN","XMR",30,0)
 . D BUFLUSH^XML
"RTN","XMR",31,0)
 . W:'$D(XMNO220) 220
"RTN","XMR",32,0)
 . H 2
"RTN","XMR",33,0)
 . S XMSG="220 "_$G(^XMB("NETNAME"))_" MailMan "_$P($T(XMR+1),";",3)_" ready" X XMSEN
"RTN","XMR",34,0)
 F  D  Q:ER!($G(XMCMD)="QUIT")!$G(XMC("QUIT"))
"RTN","XMR",35,0)
 . D DOTRAN^XMC1(42301) ;Waiting for input
"RTN","XMR",36,0)
 . S XMSTIME=300 X XMREC K XMSTIME Q:ER
"RTN","XMR",37,0)
 . S XMP=XMRG
"RTN","XMR",38,0)
 . F I=$C(9),"  " F  Q:XMP'[I  S XMP=$P(XMP,I,1)_" "_$P(XMP,I,2,999) ; strip tabs / extra blanks
"RTN","XMR",39,0)
 . S XMCMD=$$UP^XLFSTR($P(XMP," ")),XMP=$P(XMP," ",2,999)
"RTN","XMR",40,0)
 . Q:XMCMD=""
"RTN","XMR",41,0)
 . I XMSTATE_XMCONT'[(U_XMCMD_U) D ERRCMD Q
"RTN","XMR",42,0)
 . I $T(@XMCMD)="" S XMSG="502 Command not implemented" X XMSEN Q
"RTN","XMR",43,0)
 . D @XMCMD
"RTN","XMR",44,0)
 I $G(XMCMD)="QUIT"!ER,$G(XMZ) D ZAPIT^XMXMSGS2(.5,.95,XMZ)
"RTN","XMR",45,0)
 S:$G(XMINST) $P(^XMBS(4.2999,XMINST,3),U,1,6)="^^^^^"
"RTN","XMR",46,0)
 D KILL
"RTN","XMR",47,0)
 Q
"RTN","XMR",48,0)
KILL ;
"RTN","XMR",49,0)
 K I,X,XMC("HELO RECV"),XMCMD,XMCONT,XMEC,XMINSTR,XMNVFROM,XMP
"RTN","XMR",50,0)
 K XMREMID,XMRXMZ,XMRVAL,XMSTATE,XM2LONG,XMZ,XMZFDA,XMZIENS
"RTN","XMR",51,0)
 K XMERR,^TMP("XMERR",$J)
"RTN","XMR",52,0)
 Q
"RTN","XMR",53,0)
CHRS ;;Christen this domain syntax: CHRS <parent>,<child>
"RTN","XMR",54,0)
 N XMPARENT,XMCHILD,X,Y,DIC
"RTN","XMR",55,0)
 S XMPARENT=$P(XMP,",",1),XMCHILD=$P(XMP,",",2)
"RTN","XMR",56,0)
 S X=XMPARENT
"RTN","XMR",57,0)
 S DIC=4.2,DIC(0)="MF"
"RTN","XMR",58,0)
 D ^DIC
"RTN","XMR",59,0)
 I +Y'=$P(^XMB(1,1,0),U,3) S XMSG="550 Parent name does not match locally initialized parent name" X XMSEN Q
"RTN","XMR",60,0)
 S X=XMCHILD
"RTN","XMR",61,0)
 S DIC=4.2
"RTN","XMR",62,0)
 D ^DIC
"RTN","XMR",63,0)
 I +Y'=$P(^XMB(1,1,0),U,1) S XMSG="550 Child name does not match locally initialized domain name" X XMSEN Q
"RTN","XMR",64,0)
 S ^XMB("NETNAME")=$P(Y,U,2)
"RTN","XMR",65,0)
 S $P(^XMB(1,1,0),U,4)=DT
"RTN","XMR",66,0)
 S XMSG="250 Local domain "_$P(Y,U,2)_" successfully christened by parent "_XMPARENT X XMSEN
"RTN","XMR",67,0)
 Q
"RTN","XMR",68,0)
DATA ;;TEXT / ASSUMES VALID RECIPIENT
"RTN","XMR",69,0)
 D DATA^XMR3
"RTN","XMR",70,0)
 Q
"RTN","XMR",71,0)
ECHO ;;ECHO TEST
"RTN","XMR",72,0)
 S XMSG="314 Echo mode. Received messages will be echoed until a single period is received" X XMSEN Q:ER
"RTN","XMR",73,0)
 F  X XMREC Q:ER  Q:XMRG="."  S XMSG=XMRG X XMSEN Q:ER
"RTN","XMR",74,0)
 Q:ER
"RTN","XMR",75,0)
 S XMSG="250 End of echo mode" X XMSEN
"RTN","XMR",76,0)
 Q
"RTN","XMR",77,0)
EXPN ;;EXPAND MAILING LIST
"RTN","XMR",78,0)
 N XMIEN,XMPTR,XMCNT,XMNETNAM,Y,X,DIC
"RTN","XMR",79,0)
 S X=XMP
"RTN","XMR",80,0)
 I X["<" S X=$P($P(X,"<",2),">")
"RTN","XMR",81,0)
 I "^G.^g.^"[(U_$E(X,1,2)_U) S X=$E(X,3,999)
"RTN","XMR",82,0)
 S DIC="^XMB(3.8,",DIC(0)="MF"
"RTN","XMR",83,0)
 D ^DIC I Y<0 S XMSG="550 mail group not found" X XMSEN Q
"RTN","XMR",84,0)
 S XMIEN=+Y,XMCNT=0,XMNETNAM=^XMB("NETNAME"),XMPTR=""
"RTN","XMR",85,0)
 F  S XMPTR=$O(^XMB(3.8,XMIEN,1,"B",XMPTR)) Q:'XMPTR  D  Q:ER
"RTN","XMR",86,0)
 . Q:'$D(^VA(200,XMPTR,0))
"RTN","XMR",87,0)
 . S XMCNT=XMCNT+1
"RTN","XMR",88,0)
 . S XMSG="250 <"_$TR($$NAME^XMXUTIL(XMPTR),". ,","+_.")_"@"_XMNETNAM_">" X XMSEN
"RTN","XMR",89,0)
 I 'XMCNT S XMSG="250 No LOCAL members in group" X XMSEN Q:ER
"RTN","XMR",90,0)
 S XMSG="250 List SHOWS local members only, not member groups, remote members or distribution lists." X XMSEN
"RTN","XMR",91,0)
 Q
"RTN","XMR",92,0)
HELO ;;HELO COMMAND
"RTN","XMR",93,0)
 D HELO^XMR1
"RTN","XMR",94,0)
 Q
"RTN","XMR",95,0)
HELP ;;DISPLAY HELP MESSAGE
"RTN","XMR",96,0)
 D HELPME^XMR4
"RTN","XMR",97,0)
 Q
"RTN","XMR",98,0)
MAIL ;;START
"RTN","XMR",99,0)
 D:$D(XMRVAL) VALSET^XMR1(XMINST,.XMRVAL)
"RTN","XMR",100,0)
 D MAIL^XMR1
"RTN","XMR",101,0)
 Q
"RTN","XMR",102,0)
MESS ;;
"RTN","XMR",103,0)
 D MESS^XMR2
"RTN","XMR",104,0)
 Q
"RTN","XMR",105,0)
NOOP ;;NO OPERATION FOR TESTING
"RTN","XMR",106,0)
 S XMSG="250 OK" X XMSEN
"RTN","XMR",107,0)
 Q
"RTN","XMR",108,0)
QUIT ;;
"RTN","XMR",109,0)
 D:$D(XMRVAL) VALSET^XMR1(XMINST,.XMRVAL)
"RTN","XMR",110,0)
 S XMSG="221 "_$G(^XMB("NETNAME"))_" Service closing transmission channel" X XMSEN
"RTN","XMR",111,0)
 S XMC("QUIT")=1
"RTN","XMR",112,0)
 Q
"RTN","XMR",113,0)
RCPT ;;
"RTN","XMR",114,0)
 D RCPT^XMR1
"RTN","XMR",115,0)
 Q
"RTN","XMR",116,0)
RSET ;;RESET STATE TABLES
"RTN","XMR",117,0)
 N X,XMI,Y,DIC
"RTN","XMR",118,0)
 I $G(XMZ) D
"RTN","XMR",119,0)
 . I $D(^XMB(3.9,XMZ,0)),'$D(^XMB(3.9,XMZ,1,0)) D KILLMSG^XMXUTIL(XMZ)
"RTN","XMR",120,0)
 . I $D(^XMB(3.7,.5,2,.95,1,XMZ)) D ZAPIT^XMXMSGS2(.5,.95,XMZ)
"RTN","XMR",121,0)
 S XMSTATE="HELO^MAIL^"
"RTN","XMR",122,0)
 K XMZ,XMZFDA,XMZIENS,^TMP("XMY",$J),^TMP("XMY0",$J)
"RTN","XMR",123,0)
 S XMSG="250" X XMSEN Q
"RTN","XMR",124,0)
 Q
"RTN","XMR",125,0)
STAT ;;
"RTN","XMR",126,0)
 N K,I,J
"RTN","XMR",127,0)
 I $G(XMNVFROM)'="" S XMSG="211-Current reverse path is: "_XMNVFROM X XMSEN Q:ER
"RTN","XMR",128,0)
 I $G(XMINST)'="" S XMSG="211-Current sender is: "_$P(^DIC(4.2,XMINST,0),U) X XMSEN Q:ER
"RTN","XMR",129,0)
 S XMSG="211-Acceptable commands at the moment are: " X XMSEN Q:ER
"RTN","XMR",130,0)
 S XMSG="211-"
"RTN","XMR",131,0)
 S K=XMSTATE_XMCONT F I=1:1:$L(K,U) S J=$P(K,U,I) I J'="" S XMSG=XMSG_J_" "
"RTN","XMR",132,0)
 X XMSEN Q:ER
"RTN","XMR",133,0)
 I $D(XMZ),$O(^XMB(3.9,XMZ,2,0))>0 D  Q:ER
"RTN","XMR",134,0)
 . S J=0
"RTN","XMR",135,0)
 . S XMSG="211-Current text buffer is:" X XMSEN Q:ER
"RTN","XMR",136,0)
 . F  S J=$O(^XMB(3.9,XMZ,2,J)) Q:J'>0  S XMSG="211-"_J_"  "_^(J,0) X XMSEN Q:ER
"RTN","XMR",137,0)
 Q:ER
"RTN","XMR",138,0)
 I $O(^TMP("XMY",$J,""))'="" D  Q:ER
"RTN","XMR",139,0)
 . S J=""
"RTN","XMR",140,0)
 . S XMSG="211-Current recipients are: " X XMSEN Q:ER
"RTN","XMR",141,0)
 . F  S J=$O(^TMP("XMY",$J,J)) Q:J=""  S XMSG="211-"_$S('J:J,1:$$NAME^XMXUTIL(J)) X XMSEN Q:ER
"RTN","XMR",142,0)
 Q:ER
"RTN","XMR",143,0)
 S XMSG="211 OK" X XMSEN
"RTN","XMR",144,0)
 Q
"RTN","XMR",145,0)
TURN ;;
"RTN","XMR",146,0)
 D:$D(XMRVAL) VALSET^XMR1(XMINST,.XMRVAL)
"RTN","XMR",147,0)
 ;TURN AROUND PROTOCOL
"RTN","XMR",148,0)
 I $F("Yy",$P(^DIC(4.2,XMINST,0),U,16))>1 S XMSG="502 "_^XMB("NETNAME")_" has TURN disabled." X XMSEN Q
"RTN","XMR",149,0)
 I '$O(^XMB(3.7,.5,2,XMINST+1000,1,0)) S XMSG="502 "_^XMB("NETNAME")_" has no messages to export" X XMSEN Q
"RTN","XMR",150,0)
 I $P(^DIC(4.2,XMINST,0),U)'=$G(XMC("HELO RECV")) S XMSG="502 TURN command rejected." X XMSEN Q
"RTN","XMR",151,0)
 S XMSG="250 "_^XMB("NETNAME")_" has messages to export" X XMSEN Q:ER
"RTN","XMR",152,0)
 D KILL
"RTN","XMR",153,0)
 G SEND^XMS
"RTN","XMR",154,0)
VRFY ;;VERIFY USER EXISTS
"RTN","XMR",155,0)
 N XMNAME
"RTN","XMR",156,0)
 S XMINSTR("ADDR FLAGS")="X" ; Do not expand
"RTN","XMR",157,0)
 S XMNAME=$$LOOKUP^XMR1(XMP,.XMINSTR)
"RTN","XMR",158,0)
 K XMINSTR("ADDR FLAGS")
"RTN","XMR",159,0)
 Q:XMNAME=0
"RTN","XMR",160,0)
 S XMSG="250 "_XMNAME_" <"_$TR(Y,". ,","+_.")_"@"_^XMB("NETNAME")_">" X XMSEN
"RTN","XMR",161,0)
 Q
"RTN","XMR",162,0)
ERRCMD ;
"RTN","XMR",163,0)
 S XMEC=XMEC+1
"RTN","XMR",164,0)
 I XMEC>9 S ER=1,XMSG="500 too many errors or fatal error, closing channel"
"RTN","XMR",165,0)
 E  S XMSG="500 Syntax error, command ("_XMCMD_") out of sequence, or unrecognized command"
"RTN","XMR",166,0)
 X XMSEN
"RTN","XMR",167,0)
 Q
"RTN","XMR",168,0)
TST ;
"RTN","XMR",169,0)
 S XM="",XMC("BATCH")=0,XMC("DX")=1,XMCHAN="TEST"
"RTN","XMR",170,0)
 D OPEN^XML
"RTN","XMR",171,0)
 D RECEIVE
"RTN","XMR",172,0)
 D KILL^XMC
"RTN","XMR",173,0)
 Q
"RTN","XMR",174,0)
DECNET ; Task-Task Communications
"RTN","XMR",175,0)
 I $$NEWERR^%ZTER N $ETRAP,$ESTACK S $ETRAP="D R^XMCTRAP"
"RTN","XMR",176,0)
 E  S X="R^XMCTRAP",@^%ZOSF("TRAP")
"RTN","XMR",177,0)
 S (IO,I0(0))="SYS$NET",XMCHAN="DECNET" D DT^DICRW O IO U IO
"RTN","XMR",178,0)
 G ENT
"RTN","XMR0")
1^48
"RTN","XMR0A")
1^49
"RTN","XMR0B")
1^50
"RTN","XMR0BLOB")
0^321^B9857085
"RTN","XMR0BLOB",1,0)
XMR0BLOB ;(WASH ISC)/CAP-BLOB Receive ;09/15/97  09:28
"RTN","XMR0BLOB",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMR0BLOB",3,0)
 ;
"RTN","XMR0BLOB",4,0)
 ;This routine receives BLOBS (Basic Large OBjects), also known in the
"RTN","XMR0BLOB",5,0)
 ;messaging world as 'Other Body Parts' of messages.
"RTN","XMR0BLOB",6,0)
 ;It can do this only with Mailman systems after (not including)
"RTN","XMR0BLOB",7,0)
 ;version 7.0.
"RTN","XMR0BLOB",8,0)
 ;
"RTN","XMR0BLOB",9,0)
 ;A later capability is planned to receive TCP/IP-SMTP messaes that
"RTN","XMR0BLOB",10,0)
 ;conform to MIME (MEE-MEE), an extension to RFC-822 that MailMan will
"RTN","XMR0BLOB",11,0)
 ;conform to.
"RTN","XMR0BLOB",12,0)
 ;
"RTN","XMR0BLOB",13,0)
 ;Message Protocol Data Unit (MPDU) received in X (from XMR0A) contains:
"RTN","XMR0BLOB",14,0)
 ;
"RTN","XMR0BLOB",15,0)
 ;file_name^BLOB_name^BLOB_type^Origin Date
"RTN","XMR0BLOB",16,0)
 ;(Eg.  X="XIMAGE.756^XRAY2-ulna^STLL IMAGE^2930430
"RTN","XMR0BLOB",17,0)
 ;API entry requires Path, Netmail entry automatically defaults it
"RTN","XMR0BLOB",18,0)
 ;
"RTN","XMR0BLOB",19,0)
 ;Returns: 250 Okay file_path
"RTN","XMR0BLOB",20,0)
 ;
"RTN","XMR0BLOB",21,0)
BLOB(X) ;Receive BLOB
"RTN","XMR0BLOB",22,0)
 ;
"RTN","XMR0BLOB",23,0)
 ;Reject BLOBs
"RTN","XMR0BLOB",24,0)
 I '$D(^DD(2005)) S XMSG="555 Reject - Imaging not installed at "_^XMB("NETNAME"),ER=1 X XMSEN G Q
"RTN","XMR0BLOB",25,0)
 ;Cannot recieve BLOB without REGISTERED SUBDIRECTORY in DOMAIN file
"RTN","XMR0BLOB",26,0)
 F  Q:$E(X)'=" "  S X=$E(X,2,999)
"RTN","XMR0BLOB",27,0)
 ;
"RTN","XMR0BLOB",28,0)
 S %=$G(^DIC(4.2,XMINST,"FTP/DIR"))
"RTN","XMR0BLOB",29,0)
 ;FTP DIRECTORY (File 4.2, Field 6.7) -- Sub-directory for a domain
"RTN","XMR0BLOB",30,0)
 ;
"RTN","XMR0BLOB",31,0)
 ;Receive message into Kernel Site Parameter DISK/VOL (7.7) entry
"RTN","XMR0BLOB",32,0)
 S Y=$G(^XMB(1,1,"DISK/VOL"))
"RTN","XMR0BLOB",33,0)
 I %_Y="",'$L($P($G(^XMB(1,1,"FTPRCVDISK")),U)) S XMSG="550 Reject - No DISK/VOL or DOMAIN Directory defined in Kernel Site Parameters at "_^XMB("NETNAME") X XMSEN G Q
"RTN","XMR0BLOB",34,0)
 S XMR0BLOB("DISK")=Y_$S(%="":"",1:$S($L(Y,"\")>1:"",1:"\"))_%
"RTN","XMR0BLOB",35,0)
 ;
"RTN","XMR0BLOB",36,0)
 S XMR0BLOB("FILE")=$P(X,U),XMR0BLOB("NAME")=$P(X,U,2),XMR0BLOB("TYPE")=$P(X,U,3),XMR0BLOB("FTP")=Y,XMR0BLOB("DATE")=$P(X,U,4)
"RTN","XMR0BLOB",37,0)
 ;
"RTN","XMR0BLOB",38,0)
 ;
"RTN","XMR0BLOB",39,0)
FILE K DIC
"RTN","XMR0BLOB",40,0)
 ;First make sure pointer fields exist in pointed at files
"RTN","XMR0BLOB",41,0)
 ;Network Location
"RTN","XMR0BLOB",42,0)
 ;Is it there ?
"RTN","XMR0BLOB",43,0)
 S X=$P($G(^XMB(1,1,"FTPNETLOC")),U),X=$S($L(X):X,1:"MAG1"),DIC=2005.2,DIC(0)="XF" D ^DIC
"RTN","XMR0BLOB",44,0)
 ;If not there set it up
"RTN","XMR0BLOB",45,0)
 I Y<0 D FILE^DICN
"RTN","XMR0BLOB",46,0)
 S XMR0BLOB("DISK")=Y
"RTN","XMR0BLOB",47,0)
 ;
"RTN","XMR0BLOB",48,0)
 ;(TYPE)
"RTN","XMR0BLOB",49,0)
 ;Is it there ?
"RTN","XMR0BLOB",50,0)
 K DIC S DIC=2005.02,DIC(0)="FX",X=XMR0BLOB("TYPE") D ^DIC
"RTN","XMR0BLOB",51,0)
 ;If not there set it up
"RTN","XMR0BLOB",52,0)
 I Y<0 D FILE^DICN
"RTN","XMR0BLOB",53,0)
 S XMRBLOB("TYPE")=+Y
"RTN","XMR0BLOB",54,0)
 ;
"RTN","XMR0BLOB",55,0)
 ;Is it already in the file ?
"RTN","XMR0BLOB",56,0)
 S X=XMR0BLOB("NAME"),DIC="^MAG(2005,",DIC(0)="FO" D ^DIC I +Y>0 S XMSG="442 File previously exists",X=$$2005(Y) X XMSEN G Q
"RTN","XMR0BLOB",57,0)
 ;
"RTN","XMR0BLOB",58,0)
 ;Finally it's time to stuff the entry in the master file
"RTN","XMR0BLOB",59,0)
 ;Sends: FTP Address^ ^ ^ ^ Path ^ Username ^ Password ^ Physical Disk
"RTN","XMR0BLOB",60,0)
 ;EG. 250 Okay^1.2.0.1^^^image\subdir^USERNAME^PASSWORD^_nfa0:
"RTN","XMR0BLOB",61,0)
 S XMSG="250 Okay ^"_$G(^XMB(1,1,"FTP-RCV"))_"^^^"_$G(^("DISK/VOL"))_U_$G(^("FTPUSER"))_U_$G(^("FTPPWD"))_U_$P($G(^("FTPRCVDISK")),U)
"RTN","XMR0BLOB",62,0)
 X XMSEN G Q:ER
"RTN","XMR0BLOB",63,0)
 S DIC="^MAG(2005,",DIC(0)="FI",X=XMR0BLOB("NAME") D FILE^DICN
"RTN","XMR0BLOB",64,0)
 S DIE="^MAG(2005,",DR="2///"_+XMR0BLOB("DISK")_";1///"_XMR0BLOB("FILE")_";3///"_XMR0BLOB("TYPE")_$S($L(XMR0BLOB("DATE")):";14///"_XMR0BLOB("DATE"),1:""),DA=+Y
"RTN","XMR0BLOB",65,0)
 D ^DIE S X=$$2005(DA)
"RTN","XMR0BLOB",66,0)
Q K DO,DD,DIC,DO,DD,DA,XMR0BLOB
"RTN","XMR0BLOB",67,0)
 Q
"RTN","XMR0BLOB",68,0)
2005(X) ;Add to Message BLOB list
"RTN","XMR0BLOB",69,0)
 N XMFDA
"RTN","XMR0BLOB",70,0)
 S XMFDA(3.92005,"?+1,"_$G(XMZIENS,XMZ_","),.01)=X
"RTN","XMR0BLOB",71,0)
 D UPDATE^DIE("","XMFDA")
"RTN","XMR0BLOB",72,0)
 Q 1
"RTN","XMR0BLOB",73,0)
API(X) ;BLOB (XMD,XMB)
"RTN","XMR0BLOB",74,0)
 N %,I,XMMG,XMR0BLOB,XMSEN,XMSG,XMREC
"RTN","XMR0BLOB",75,0)
 F %=1:1:5 S XMR0BLOB($P("FILE^TYPE^NAME^DATE^DISK",U,I))=$P(X,U,I)
"RTN","XMR0BLOB",76,0)
 D FILE
"RTN","XMR0BLOB",77,0)
 Q $S(+XMSG=250:1,+XMSG=440:1,1:0)
"RTN","XMR1")
0^51^B49978938
"RTN","XMR1",1,0)
XMR1 ;ISC-SF/GMB-SMTP Receiver HELO/MAIL/RCPT (RFC 821) ;06/25/2002  07:06
"RTN","XMR1",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMR1",3,0)
HELO ; Recv: "HELO REMOTE.MED.VA.GOV <security num>"
"RTN","XMR1",4,0)
 ; Send: "250 OK LOCAL.MED.VA.GOV <security num> [8.0,DUP,SER,FTP]"
"RTN","XMR1",5,0)
 N X,Y,XMDOMREC
"RTN","XMR1",6,0)
 I XMP="" S XMSG="501 Missing domain specification" X XMSEN Q
"RTN","XMR1",7,0)
 I '$D(^XMB("NETNAME")) S XMSG="550 Unchristened local domain" X XMSEN Q
"RTN","XMR1",8,0)
 S X=$P(XMP,"<")
"RTN","XMR1",9,0)
 I $E(X,$L(X))="." S XMSG="501 Invalid Domain Name" X XMSEN Q
"RTN","XMR1",10,0)
 S XMSTATE="^HELO^QUIT^"
"RTN","XMR1",11,0)
 S X=$$UP^XLFSTR(X)
"RTN","XMR1",12,0)
 S Y=$$FACILITY(X)
"RTN","XMR1",13,0)
 I Y>0 D
"RTN","XMR1",14,0)
 . S XMINST=+Y
"RTN","XMR1",15,0)
 . S (XMSITE,XMC("HELO RECV"))=$P(Y,U,2)
"RTN","XMR1",16,0)
 E  D
"RTN","XMR1",17,0)
 . S XMC("HELO RECV")=X
"RTN","XMR1",18,0)
 . S Y=$$DOMAIN(X)
"RTN","XMR1",19,0)
 . S XMINST=+Y
"RTN","XMR1",20,0)
 . S XMSITE=$P(Y,U,2)
"RTN","XMR1",21,0)
 ;
"RTN","XMR1",22,0)
 ; We want to prevent this site from unwittingly acting as a relay
"RTN","XMR1",23,0)
 ; domain for spammers.  Spammers typically route their mail through
"RTN","XMR1",24,0)
 ; unsuspecting sites to "launder" it.  The unsuspecting sites forward
"RTN","XMR1",25,0)
 ; it onward.  XMC("HELO RECV") contains the sending site's name.  If we
"RTN","XMR1",26,0)
 ; were to be truly vigorous about this, we would find out the IP
"RTN","XMR1",27,0)
 ; address of the site and do a reverse DNS lookup to verify the site's
"RTN","XMR1",28,0)
 ; name.  We don't yet have that capability, so we'll have to make do
"RTN","XMR1",29,0)
 ; with XMC("HELO RECV") and trust that the site is who it says it is.
"RTN","XMR1",30,0)
 ;
"RTN","XMR1",31,0)
 ; (We're de-activating this code, because it was wreaking havoc with
"RTN","XMR1",32,0)
 ; POP3 clients.)
"RTN","XMR1",33,0)
 ;I ^XMB("NETNAME")["VA.GOV" D
"RTN","XMR1",34,0)
 ;. ; This is a VA site.  Is it OK to relay mail from another site to a
"RTN","XMR1",35,0)
 ;. ; non-VA site?  It is if the other site is a VA site.  It isn't if
"RTN","XMR1",36,0)
 ;. ; the other site is a non-VA site.
"RTN","XMR1",37,0)
 ;. S XMC("MY DOMAIN")=".VA.GOV"
"RTN","XMR1",38,0)
 ;. S XMC("RELAY OK")=(XMC("HELO RECV")[XMC("MY DOMAIN"))
"RTN","XMR1",39,0)
 ;E  S XMC("RELAY OK")=1
"RTN","XMR1",40,0)
 ;; Instead of the above line, non-VA sites running MailMan should add
"RTN","XMR1",41,0)
 ;; their own code here to detect and prevent relaying.  Perhaps:
"RTN","XMR1",42,0)
 ;;E  D
"RTN","XMR1",43,0)
 ;;. S XMC("MY DOMAIN")=^XMB("NETNAME")
"RTN","XMR1",44,0)
 ;;. S XMC("RELAY OK")=(XMC("HELO RECV")[XMC("MY DOMAIN"))
"RTN","XMR1",45,0)
 I XMC("BATCH") S XMSTATE="^MAIL^",XMCONT=XMCONT_"TURN^MESS^" Q
"RTN","XMR1",46,0)
 S XMDOMREC=^DIC(4.2,XMINST,0)
"RTN","XMR1",47,0)
 I $P(XMDOMREC,U,15) D VALPROC(XMINST,XMDOMREC,XMP,.XMRVAL) Q:'$D(XMRVAL)
"RTN","XMR1",48,0)
 S XMSG="250 OK "_^XMB("NETNAME")_$S($D(XMRVAL):" <"_XMRVAL_">",1:"")_" ["_$P($T(XMR1+1),";",3)_",DUP,SER,FTP]" X XMSEN
"RTN","XMR1",49,0)
 S XMSTATE="^MAIL^",XMCONT=XMCONT_"TURN^MESS^"
"RTN","XMR1",50,0)
 Q
"RTN","XMR1",51,0)
FACILITY(X) ; If full domain name is found in domain file, either as main
"RTN","XMR1",52,0)
 ; entry or as synonym, return main entry.  "Domain IEN^Domain name"
"RTN","XMR1",53,0)
 N DIC,Y,D
"RTN","XMR1",54,0)
 S DIC="^DIC(4.2,",DIC(0)="FMOZ",D="B^C"
"RTN","XMR1",55,0)
 D MIX^DIC1
"RTN","XMR1",56,0)
 Q $S(Y>0:+Y_U_Y(0,0),1:Y)
"RTN","XMR1",57,0)
DOMAIN(XMDOMAIN) ; Try to find the domain.
"RTN","XMR1",58,0)
 N DIC,X,Y,D
"RTN","XMR1",59,0)
 S (X,XMDOMAIN)=$$UP^XLFSTR(XMDOMAIN)
"RTN","XMR1",60,0)
 S DIC="^DIC(4.2,",DIC(0)="FMXZ",D="B^C"
"RTN","XMR1",61,0)
 F  D MIX^DIC1 Q:Y>0!(X'[".")  S X=$P(X,".",2,99)
"RTN","XMR1",62,0)
 Q:Y>0 +Y_U_Y(0,0)
"RTN","XMR1",63,0)
 N XMTOP
"RTN","XMR1",64,0)
 S XMTOP=X
"RTN","XMR1",65,0)
 ; If the top-level domain is found in the Internet Suffix file, then
"RTN","XMR1",66,0)
 ; just pretend that we're talking to this site's parent.
"RTN","XMR1",67,0)
 ; (TURN command will be disabled.)
"RTN","XMR1",68,0)
 I $$FIND1^DIC(4.2996,"","QX",XMTOP) Q ^XMB("PARENT")_U_$P(^DIC(4.2,^XMB("PARENT"),0),U,1)
"RTN","XMR1",69,0)
 ; Add the top-level domain to the DOMAIN file.
"RTN","XMR1",70,0)
 N XMFDA,XMIENS,XMIEN
"RTN","XMR1",71,0)
 S XMIENS="?+1,"
"RTN","XMR1",72,0)
 S XMFDA(4.2,XMIENS,.01)=XMTOP        ; Top-level domain name
"RTN","XMR1",73,0)
 S XMFDA(4.2,XMIENS,1)="C"            ; Closed
"RTN","XMR1",74,0)
 S XMFDA(4.2,XMIENS,1.7)="y"          ; Disable TURN command
"RTN","XMR1",75,0)
 S XMFDA(4.2,XMIENS,2)=^XMB("PARENT") ; Relay domain
"RTN","XMR1",76,0)
 D UPDATE^DIE("","XMFDA","XMIEN")
"RTN","XMR1",77,0)
 ; If there's a problem with adding the top-level domain to the DOMAIN
"RTN","XMR1",78,0)
 ; file, just pretend that we're talking to this site's parent.
"RTN","XMR1",79,0)
 ; (TURN command will be disabled.)
"RTN","XMR1",80,0)
 I $D(DIERR) Q ^XMB("PARENT")_U_$P(^DIC(4.2,^XMB("PARENT"),0),U,1)
"RTN","XMR1",81,0)
 ; Notify someone that we've added a new domain to the DOMAIN file.
"RTN","XMR1",82,0)
 N XMINSTR,XMPARM
"RTN","XMR1",83,0)
 S XMPARM(1)=XMTOP
"RTN","XMR1",84,0)
 S XMPARM(2)=XMDOMAIN
"RTN","XMR1",85,0)
 S XMINSTR("FROM")="POSTMASTER"
"RTN","XMR1",86,0)
 D TASKBULL^XMXBULL(.5,"XM DOMAIN ADDED",.XMPARM,,,.XMINSTR)
"RTN","XMR1",87,0)
 Q XMIEN(1)_U_XMTOP
"RTN","XMR1",88,0)
VALPROC(XMINST,XMDOMREC,XMP,XMRVAL) ; Check validation number
"RTN","XMR1",89,0)
 L +^DIC(4.2,XMINST,0):0 E  S XMSG="550 Domain file locked, try later" X XMSEN Q
"RTN","XMR1",90,0)
 S XMRVAL=$P($P(XMP,"<",2),">")
"RTN","XMR1",91,0)
 D VALCHK(.XMDOMREC,XMRVAL)
"RTN","XMR1",92,0)
 I '$D(XMRVAL) L -^DIC(4.2,XMINST,0) Q
"RTN","XMR1",93,0)
 S XMRVAL=$R(8000000)+1000000 ; generate new validation number
"RTN","XMR1",94,0)
 ;set val. num in return message, set new Val. num field
"RTN","XMR1",95,0)
 S $P(XMDOMREC,U,18)=XMRVAL
"RTN","XMR1",96,0)
 S ^DIC(4.2,XMINST,0)=XMDOMREC
"RTN","XMR1",97,0)
 Q
"RTN","XMR1",98,0)
VALCHK(XMDOMREC,XMRVAL) ; Check the validation number
"RTN","XMR1",99,0)
 Q:XMRVAL=$P(XMDOMREC,U,15)  ; 15=current number; 18=new number
"RTN","XMR1",100,0)
 I XMRVAL=$P(XMDOMREC,U,18) S $P(XMDOMREC,U,15)=$P(XMDOMREC,U,18) Q
"RTN","XMR1",101,0)
 K XMRVAL
"RTN","XMR1",102,0)
 N XMPARM,XMINSTR
"RTN","XMR1",103,0)
 S XMINSTR("FROM")="POSTMASTER"
"RTN","XMR1",104,0)
 S XMPARM(1)=XMC("HELO RECV")
"RTN","XMR1",105,0)
 D TASKBULL^XMXBULL(.5,"XMVALBAD",.XMPARM,"","",.XMINSTR)
"RTN","XMR1",106,0)
 S XMSG="550 Bad validation number" X XMSEN
"RTN","XMR1",107,0)
 Q
"RTN","XMR1",108,0)
VALSET(XMINST,XMRVAL) ;check validation number
"RTN","XMR1",109,0)
 ;if new val. num. exist, then set val. num. to it and set to null
"RTN","XMR1",110,0)
 Q:'$G(XMRVAL)
"RTN","XMR1",111,0)
 N XMDOMREC
"RTN","XMR1",112,0)
 S XMDOMREC=$G(^DIC(4.2,XMINST,0))
"RTN","XMR1",113,0)
 S $P(XMDOMREC,U,15)=XMRVAL
"RTN","XMR1",114,0)
 S $P(XMDOMREC,U,18)=""
"RTN","XMR1",115,0)
 S ^DIC(4.2,XMINST,0)=XMDOMREC
"RTN","XMR1",116,0)
 L -^DIC(4.2,XMINST,0)
"RTN","XMR1",117,0)
 K XMRVAL
"RTN","XMR1",118,0)
 Q
"RTN","XMR1",119,0)
MAIL ; Recv: "MAIL FROM:<USER.JOE@REMOTE.MED.VA.GOV>"
"RTN","XMR1",120,0)
 ; Send: "250 OK Message-ID:12345@LOCAL.MED.VA.GOV"
"RTN","XMR1",121,0)
 N XMD
"RTN","XMR1",122,0)
 S XMP=$P(XMP,":",2,999)
"RTN","XMR1",123,0)
 S XMP=$$SCRUB^XMR3(XMP)
"RTN","XMR1",124,0)
 I XMP'?1"<>",(XMP'?1"<"1.E1"@"1.E1">") S XMSG="501 Invalid reverse-path specification" X XMSEN Q
"RTN","XMR1",125,0)
 I $$REJECT(XMP) S XMSG="502 No message receipt authorization." X XMSEN Q
"RTN","XMR1",126,0)
 K XMINSTR,XMNVFROM,XMREMID,XMRXMZ,XM2LONG,XMZ,XMZFDA,XMZIENS,^TMP("XMY",$J),^TMP("XMY0",$J)
"RTN","XMR1",127,0)
 S XMINSTR("FWD BY")="" ; We're not sure who sent/forwarded it
"RTN","XMR1",128,0)
 S XMINSTR("ADDR FLAGS")="R"
"RTN","XMR1",129,0)
 K:$D(XMERR) XMERR K:$D(^TMP("XMERR",$J)) ^TMP("XMERR",$J)
"RTN","XMR1",130,0)
 D CRE8XMZ^XMXSEND($$EZBLD^DIALOG(34012),.XMZ) ; * No Subject *
"RTN","XMR1",131,0)
 I $D(XMERR) D  Q
"RTN","XMR1",132,0)
 . S XMSG="555 "_^TMP("XMERR",$J,1,"TEXT",1)
"RTN","XMR1",133,0)
 . K XMERR,^TMP("XMERR",$J)
"RTN","XMR1",134,0)
 . X XMSEN
"RTN","XMR1",135,0)
 S XMZIENS=XMZ_","
"RTN","XMR1",136,0)
 S (XMNVFROM,XMZFDA(3.9,XMZIENS,1),XMZFDA(3.9,XMZIENS,41))=XMP ; mail from
"RTN","XMR1",137,0)
 S XMSTATE="^RCPT^DATA"
"RTN","XMR1",138,0)
 S (XMD,XMZFDA(3.9,XMZIENS,1.4))=$$NOW^XLFDT() ; Message date default
"RTN","XMR1",139,0)
 S $P(^XMB(3.9,XMZ,0),U,3)=XMD
"RTN","XMR1",140,0)
 D PUTMSG^XMXMSGS2(.5,.95,"ARRIVING",XMZ)
"RTN","XMR1",141,0)
 S XMSG="250 OK Message-ID:"_XMZ_"@"_^XMB("NETNAME") X XMSEN Q:ER
"RTN","XMR1",142,0)
 S XMD=$$INDT^XMXUTIL1(XMD)
"RTN","XMR1",143,0)
 ;DON'T CHANGE ORDER OF .001 & .002 LINES !
"RTN","XMR1",144,0)
 S ^XMB(3.9,XMZ,2,.001,0)="Received: "_$S($L($G(XMC("HELO RECV"))):"from "_XMC("HELO RECV")_" by "_^XMB("NETNAME")_" (MailMan/"_$P($T(XMR1+1),";",3)_" "_XMPROT_")",1:"(BATCH)")_" id "_XMZ_" ; "_XMD
"RTN","XMR1",145,0)
 N XMFDA,XMIENS
"RTN","XMR1",146,0)
 S XMIENS=XMINST_","
"RTN","XMR1",147,0)
 S XMFDA(4.2999,XMIENS,1)=$H
"RTN","XMR1",148,0)
 S XMFDA(4.2999,XMIENS,2)=XMZ   ; Message in transit
"RTN","XMR1",149,0)
 ;S XMFDA(4.2999,XMIENS,3)="@"   ; Last line xmit'd
"RTN","XMR1",150,0)
 D FILE^DIE("","XMFDA")
"RTN","XMR1",151,0)
 Q
"RTN","XMR1",152,0)
REJECT(XMNVFROM) ; Check Senders rejected list
"RTN","XMR1",153,0)
 Q:'$O(^XMBX(4.501,0)) 0
"RTN","XMR1",154,0)
 N XMNO,XMREJECT,XMIEN,XMREC
"RTN","XMR1",155,0)
 S XMNVFROM=$$UP^XLFSTR(XMNVFROM)
"RTN","XMR1",156,0)
 S XMNO="",XMREJECT=0
"RTN","XMR1",157,0)
 F  S XMNO=$O(^XMBX(4.501,"B",XMNO)) Q:XMNO=""  D  Q:XMREJECT
"RTN","XMR1",158,0)
 . Q:XMNVFROM'[$$UP^XLFSTR(XMNO)
"RTN","XMR1",159,0)
 . S XMIEN=$O(^XMBX(4.501,"B",XMNO,0)) Q:'XMIEN
"RTN","XMR1",160,0)
 . S XMREC=$G(^XMBX(4.501,XMIEN,0)) Q:XMREC=""
"RTN","XMR1",161,0)
 . I XMNVFROM[$$UP^XLFSTR($P(XMREC,U,1)),'$P(XMREC,U,2) S XMREJECT=1
"RTN","XMR1",162,0)
 Q XMREJECT
"RTN","XMR1",163,0)
RCPT ; Specify recipients
"RTN","XMR1",164,0)
 S XMP=$P(XMP,":",2,999) I XMP="" S XMSG="501 Invalid forward path specification" X XMSEN Q
"RTN","XMR1",165,0)
 I XMP["> FWD BY:" S XMINSTR("NET FWD BY")=$P(XMP,"> FWD BY:",2)
"RTN","XMR1",166,0)
 E  K XMINSTR("NET FWD BY")
"RTN","XMR1",167,0)
 Q:$$LOOKUP(XMP,.XMINSTR)=0
"RTN","XMR1",168,0)
 S XMSG="250 'RCPT' accepted" X XMSEN
"RTN","XMR1",169,0)
 S XMSTATE="^DATA^RCPT"
"RTN","XMR1",170,0)
 Q
"RTN","XMR1",171,0)
LOOKUP(XMTO,XMINSTR) ;
"RTN","XMR1",172,0)
 N XMFULL,XMRESTR
"RTN","XMR1",173,0)
 S XMRESTR("NET RECEIVE")=$G(XMNVFROM)
"RTN","XMR1",174,0)
 S XMTO=$TR($P($P(XMTO,">",1),"<",2,99),"<")  ; I've seen <<user@site> and <<user@site>>
"RTN","XMR1",175,0)
 I XMTO="" S XMSG="550 Malformed address" X XMSEN Q 0
"RTN","XMR1",176,0)
 I $E(XMTO,1)'="""",XMTO?1"@"1.E1":"1.E1"@"1.E S XMTO=$P(XMTO,":",2)
"RTN","XMR1",177,0)
 D CHKADDR^XMXADDR(.5,XMTO,.XMINSTR,.XMRESTR,.XMFULL)
"RTN","XMR1",178,0)
 I $D(XMERR) D  Q 0
"RTN","XMR1",179,0)
 . S XMSG="550 "_^TMP("XMERR",$J,XMERR,"TEXT",1)
"RTN","XMR1",180,0)
 . X XMSEN
"RTN","XMR1",181,0)
 . K XMERR,^TMP("XMERR",$J)
"RTN","XMR1",182,0)
 I $G(XMFULL)="SHARED,MAIL" D  Q 0
"RTN","XMR1",183,0)
 . S XMSG="550 'Shared,Mail' user may not receive network mail."
"RTN","XMR1",184,0)
 . X XMSEN
"RTN","XMR1",185,0)
 . K ^TMP("XMY",$J,.6),^TMP("XMY0",$J,"SHARED,MAIL")
"RTN","XMR1",186,0)
 Q XMFULL
"RTN","XMR1",187,0)
 ;I XMFULL'["@" Q XMFULL
"RTN","XMR1",188,0)
 ;; Don't act as a relay domain for unauthorized sites.
"RTN","XMR1",189,0)
 ;I 'XMC("RELAY OK"),$P(XMFULL,"@",2)'[XMC("MY DOMAIN") D  Q 0
"RTN","XMR1",190,0)
 ;. S XMSG="550 Relaying denied."
"RTN","XMR1",191,0)
 ;. X XMSEN
"RTN","XMR1",192,0)
 ;. K ^TMP("XMY",$J,XMFULL),^TMP("XMY0",$J,XMFULL)
"RTN","XMR1",193,0)
 ;Q XMFULL
"RTN","XMR1A")
1^52
"RTN","XMR2")
0^53^B5718588
"RTN","XMR2",1,0)
XMR2 ;ISC-SF/GMB-SMTP Receiver (non-standard) ;04/17/2002  11:15
"RTN","XMR2",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMR2",3,0)
 ; *** Note that this command (MESS <what:parm>) is not standard.
"RTN","XMR2",4,0)
 ; *** MESS ID, in particular, may return 'RSET', which is supposed
"RTN","XMR2",5,0)
 ;     to be sent only by the sender, not by the receiver.
"RTN","XMR2",6,0)
MESS ; CHECK IF DUPLICATE MESSAGE / USERS...
"RTN","XMR2",7,0)
 N XMWHAT,XMPARM
"RTN","XMR2",8,0)
 I XMP="" D ERRCMD^XMR Q
"RTN","XMR2",9,0)
 S XMWHAT=$E($P(XMP,":"),1,6),XMPARM=$P(XMP,":",2,99)
"RTN","XMR2",10,0)
 I $T(@XMWHAT)="" D ERRCMD^XMR Q
"RTN","XMR2",11,0)
 D @XMWHAT
"RTN","XMR2",12,0)
 Q
"RTN","XMR2",13,0)
BLOB ;; MESS BLOB
"RTN","XMR2",14,0)
 D BLOB^XMR0BLOB(XMPARM)
"RTN","XMR2",15,0)
 Q
"RTN","XMR2",16,0)
CLOSED ;; MESS CLOSED
"RTN","XMR2",17,0)
 S XMZFDA(3.9,XMZIENS,1.95)="y"
"RTN","XMR2",18,0)
 S XMSG="250 OK" X XMSEN
"RTN","XMR2",19,0)
 Q
"RTN","XMR2",20,0)
CONFID ;; MESS CONFIDENTIAL
"RTN","XMR2",21,0)
 S XMZFDA(3.9,XMZIENS,1.96)="y"
"RTN","XMR2",22,0)
 S XMSG="250 OK" X XMSEN
"RTN","XMR2",23,0)
 Q
"RTN","XMR2",24,0)
CONFIR ;; MESS CONFIRMATION
"RTN","XMR2",25,0)
 S XMZFDA(3.9,XMZIENS,1.3)="y"
"RTN","XMR2",26,0)
 S XMSG="250 OK" X XMSEN
"RTN","XMR2",27,0)
 Q
"RTN","XMR2",28,0)
ID ;;
"RTN","XMR2",29,0)
 N XMZCHK
"RTN","XMR2",30,0)
 S XMREMID=XMPARM
"RTN","XMR2",31,0)
 S XMZCHK=$$LOCALXMZ^XMR3A(XMREMID)
"RTN","XMR2",32,0)
 I 'XMZCHK S XMSG="250 OK" X XMSEN Q
"RTN","XMR2",33,0)
 I $P(XMZCHK,U,2,3)="1^P" S XMSG="250 OK" X XMSEN Q
"RTN","XMR2",34,0)
 ;Message originated here.  /  Previously received message.
"RTN","XMR2",35,0)
 D DOTRAN^XMC1($S($P(XMZCHK,U,2):42305,1:42306))
"RTN","XMR2",36,0)
 S XMRXMZ=+XMZCHK
"RTN","XMR2",37,0)
 I $P(XMZCHK,U,3)'="E"!(XMRXMZ=XMZ) D  Q
"RTN","XMR2",38,0)
 . I $P(XMZCHK,U,3)="P" D DOTRAN^XMC1(42307) ;Already purged.
"RTN","XMR2",39,0)
 . I $P(XMZCHK,U,3)="R" D DOTRAN^XMC1(42308) ;Already purged & replaced with a different message.
"RTN","XMR2",40,0)
 . S XMSG="RSET:"_XMRXMZ_"@"_^XMB("NETNAME")_":Duplicate purged" X XMSEN
"RTN","XMR2",41,0)
 D DOTRAN^XMC1(42309) ;Delivering to additional recipients.
"RTN","XMR2",42,0)
 S XMSG="RSET:"_XMRXMZ_"@"_^XMB("NETNAME")_":Previously received" X XMSEN
"RTN","XMR2",43,0)
 Q
"RTN","XMR2",44,0)
INFO ;; MESS INFORMATION 
"RTN","XMR2",45,0)
 S XMZFDA(3.9,XMZIENS,1.97)="y"
"RTN","XMR2",46,0)
 S XMSG="250 OK" X XMSEN
"RTN","XMR2",47,0)
 Q
"RTN","XMR2",48,0)
LINES ;; MESS LINES
"RTN","XMR2",49,0)
 N XMLINES,XMLIMIT
"RTN","XMR2",50,0)
 S XMLIMIT=$P($G(^XMB(1,1,"NETWORK-LIMIT")),U,2)
"RTN","XMR2",51,0)
 S XMLINES=XMPARM
"RTN","XMR2",52,0)
 I 'XMLIMIT!(XMLINES'>XMLIMIT) S XMSG="250 OK" X XMSEN Q
"RTN","XMR2",53,0)
 S XMSG="RSET:"_XMLIMIT_":Max lines exceeded" X XMSEN
"RTN","XMR2",54,0)
 S XM2LONG=1
"RTN","XMR2",55,0)
 Q
"RTN","XMR2",56,0)
TYPE ;; MESS TYPE
"RTN","XMR2",57,0)
 S XMZFDA(3.9,XMZIENS,1.7)=XMPARM
"RTN","XMR2",58,0)
 S XMSG="250 OK" X XMSEN
"RTN","XMR2",59,0)
 Q
"RTN","XMR3")
0^54^B72491233
"RTN","XMR3",1,0)
XMR3 ;ISC-SF/GMB-SMTP Receiver (RFC 822) ;07/01/2002  14:11
"RTN","XMR3",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMR3",3,0)
DATA ; TEXT / ASSUMES VALID RECIPIENT
"RTN","XMR3",4,0)
 ; Incoming Variables:
"RTN","XMR3",5,0)
 ; XMINSTR("FWD BY")=""
"RTN","XMR3",6,0)
 ; XMZ        message number of new message
"RTN","XMR3",7,0)
 ; XMZFDA     FM FDA for new message
"RTN","XMR3",8,0)
 ; XMZIENS    IENS for new message
"RTN","XMR3",9,0)
 ; $D(XMC("DX"))  means Test mode: Messages will not be delivered
"RTN","XMR3",10,0)
 ; If the msg is from a VA site, the following may be set:
"RTN","XMR3",11,0)
 ; XMREMID    always set if the msg is from a VA site
"RTN","XMR3",12,0)
 ; $G(XMRXMZ) message number of message we already have.
"RTN","XMR3",13,0)
 ;            Set if new message is a duplicate of one we already have.
"RTN","XMR3",14,0)
 N XMLIN,XMINCR,XMHDR,XMREJECT,XMSUBJ,XMFROM,XMDATE,XMENCR,XMZO,XMSENDER,XMREPLTO
"RTN","XMR3",15,0)
 D GETDATA Q:ER
"RTN","XMR3",16,0)
 I '$G(XMRXMZ),'$D(XMC("DX")) D HDRPROC Q:ER
"RTN","XMR3",17,0)
 I '$G(XMREJECT),'$D(XMC("DX")) D SET
"RTN","XMR3",18,0)
 S XMSTATE="^HELO^MAIL^"
"RTN","XMR3",19,0)
 K ^TMP("XMY",$J),^TMP("XMY0",$J)
"RTN","XMR3",20,0)
 D ZAPIT^XMXMSGS2(.5,.95,XMZ)
"RTN","XMR3",21,0)
 I '$G(XMREJECT) D
"RTN","XMR3",22,0)
 . S XMSG="250 'data' accepted" X XMSEN
"RTN","XMR3",23,0)
 . D XMTHIST^XMTDR(XMINST,"R",$P($G(^XMB(3.9,XMZ,2,0)),U,4))
"RTN","XMR3",24,0)
 K XMNVFROM,XMINSTR,XMREMID,XMRXMZ,XMZ,XMZIENS,XMZFDA
"RTN","XMR3",25,0)
 Q
"RTN","XMR3",26,0)
GETDATA ;
"RTN","XMR3",27,0)
 N XMH
"RTN","XMR3",28,0)
 S XMSG="354 Enter data" X XMSEN Q:ER
"RTN","XMR3",29,0)
 S XMLIN=.001,XMINCR=.001,XMH=""
"RTN","XMR3",30,0)
 F  X XMREC Q:ER  Q:XMRG="."  D
"RTN","XMR3",31,0)
 . I $E(XMRG)="." S XMRG=$E(XMRG,2,999)
"RTN","XMR3",32,0)
 . S XMLIN=XMLIN+XMINCR
"RTN","XMR3",33,0)
 . S ^XMB(3.9,XMZ,2,XMLIN,0)=XMRG
"RTN","XMR3",34,0)
 . Q:XMINCR=1
"RTN","XMR3",35,0)
 . I XMRG="" S XMINCR=1,XMLIN=0 Q
"RTN","XMR3",36,0)
 . I XMLIN=.99 S XMINCR=.000001
"RTN","XMR3",37,0)
 . I $E(XMRG,1)=" "!($E(XMRG,1)=$C(9)) Q:XMH=""  D NEXT(XMH,.XMHDR,XMRG) Q
"RTN","XMR3",38,0)
 . ;I $E(XMRG,1)=" " Q:XMH=""  D NEXT(XMH,.XMHDR,XMRG)
"RTN","XMR3",39,0)
 . S XMH=$$UP^XLFSTR($P(XMRG,":"))
"RTN","XMR3",40,0)
 . I "^DATE^FROM^IMPORTANCE^IN-REPLY-TO^MESSAGE-ID^SUBJECT^"[(U_XMH_U) S XMH=$E($TR(XMH,"-"),1,4),XMHDR(XMH)=$$SCRUB($P(XMRG,":",2,99)) Q
"RTN","XMR3",41,0)
 . I "^ENCRYPTED^EXPIRY-DATE^REFERENCES^REPLY-TO^RETURN-RECEIPT-TO^SENDER^SENSITIVITY^"[(U_XMH_U) S XMH=$E($TR(XMH,"-"),1,4),XMHDR(XMH)=$$SCRUB($P(XMRG,":",2,99)) Q
"RTN","XMR3",42,0)
 . I "^X-PRIORITY^"[(U_XMH_U) S XMH=$E($P(XMH,"-",2),1,4),XMHDR(XMH)=$$SCRUB($P(XMRG,":",2,99)) Q
"RTN","XMR3",43,0)
 . I "^X-MM-BASKET^X-MM-CLOSED^X-MM-INFO-ONLY^X-MM-TYPE^"[(U_XMH_U) S XMH=$E($P(XMH,"-",3),1,4),XMHDR(XMH)=$$SCRUB($P(XMRG,":",2,99)) Q
"RTN","XMR3",44,0)
 . S XMH=""
"RTN","XMR3",45,0)
 Q:ER
"RTN","XMR3",46,0)
 Q
"RTN","XMR3",47,0)
NEXT(XMH,XMHDR,XMDATA) ;
"RTN","XMR3",48,0)
 N I
"RTN","XMR3",49,0)
 S XMDATA=$$SCRUB(XMDATA) Q:XMDATA=""
"RTN","XMR3",50,0)
 I XMHDR(XMH)="" S XMHDR(XMH)=XMDATA Q
"RTN","XMR3",51,0)
 I $L(XMHDR(XMH))+$L(XMDATA)<255 S XMHDR(XMH)=XMHDR(XMH)_" "_XMDATA Q
"RTN","XMR3",52,0)
 S I=$O(^XMHDR(XMH,":"),-1)+1
"RTN","XMR3",53,0)
 I $G(XMHDR(XMH,I))'="",$L(XMHDR(XMH,I))+$L(XMDATA)<255 S XMHDR(XMH,I)=$G(XMHDR(XMH,I))_" "_XMDATA Q
"RTN","XMR3",54,0)
 S XMHDR(XMH,I+1)=XMDATA
"RTN","XMR3",55,0)
 Q
"RTN","XMR3",56,0)
HDRPROC ; Process header commands
"RTN","XMR3",57,0)
 N XMH,XMP,XMRINFO
"RTN","XMR3",58,0)
 I XMLIN,$O(^XMB(3.9,XMZ,2,XMLIN)) D  Q
"RTN","XMR3",59,0)
 . S XMREJECT=1
"RTN","XMR3",60,0)
 . S XMSG="500 Synchronization Lost.  Msg rejected." X XMSEN
"RTN","XMR3",61,0)
 . D KILLIT^XMR3A
"RTN","XMR3",62,0)
 ;I '$D(XMHDR("FROM")) D  Q
"RTN","XMR3",63,0)
 ;. S XMREJECT=1
"RTN","XMR3",64,0)
 ;. S XMSG="501 Missing FROM Header.  Msg rejected." X XMSEN
"RTN","XMR3",65,0)
 ;. D KILLIT^XMR3A
"RTN","XMR3",66,0)
 I $$TOOLONG D  Q
"RTN","XMR3",67,0)
 . S XMREJECT=1
"RTN","XMR3",68,0)
 . S XMSG="551 Too many lines.  Msg rejected." X XMSEN
"RTN","XMR3",69,0)
 . D KILLIT^XMR3A
"RTN","XMR3",70,0)
 I '$D(XMREMID) S XMREMID=""
"RTN","XMR3",71,0)
 S (XMH,XMZO,XMFROM,XMENCR,XMSENDER,XMDATE,XMSUBJ)=""
"RTN","XMR3",72,0)
 F  S XMH=$O(XMHDR(XMH)) Q:XMH=""  D
"RTN","XMR3",73,0)
 . S XMP=XMHDR(XMH)
"RTN","XMR3",74,0)
 . D @XMH
"RTN","XMR3",75,0)
 I '$O(^XMB(3.9,XMZ,2,.999999)),'$D(XMZFDA(3.9,XMZIENS,.01)) D  Q
"RTN","XMR3",76,0)
 . S XMSG="552 No subject or text.  Msg rejected." X XMSEN
"RTN","XMR3",77,0)
 . D KILLIT^XMR3A
"RTN","XMR3",78,0)
 . S XMREJECT=1
"RTN","XMR3",79,0)
 I $G(XMRINFO) D  Q
"RTN","XMR3",80,0)
 . S XMSG="555 Reply to 'Info Only'.  Msg rejected." X XMSEN
"RTN","XMR3",81,0)
 . D KILLIT^XMR3A
"RTN","XMR3",82,0)
 . S XMREJECT=1
"RTN","XMR3",83,0)
 ;I $G(XMZFDA(3.9,XMZIENS,9))="" D  Q
"RTN","XMR3",84,0)
 ;. S XMSG="501 No MESSAGE-ID.  Msg rejected." X XMSEN
"RTN","XMR3",85,0)
 ;. D KILLIT^XMR3A
"RTN","XMR3",86,0)
 ;. S XMREJECT=1
"RTN","XMR3",87,0)
 ;I '$O(^XMB(3.9,XMZ,2,.999999)) S ^XMB(3.9,XMZ,2,1,0)=" "
"RTN","XMR3",88,0)
 S ^XMB(3.9,XMZ,2,0)="^^"_XMLIN_U_XMLIN
"RTN","XMR3",89,0)
 Q
"RTN","XMR3",90,0)
TOOLONG() ;
"RTN","XMR3",91,0)
 N XMLIMIT
"RTN","XMR3",92,0)
 S XMLIMIT=$P($G(^XMB(1,1,"NETWORK-LIMIT")),U,2)
"RTN","XMR3",93,0)
 Q:'XMLIMIT 0
"RTN","XMR3",94,0)
 Q:$G(XM2LONG) 1
"RTN","XMR3",95,0)
 Q:XMLIN'>XMLIMIT 0
"RTN","XMR3",96,0)
 I $G(XMHDR("TYPE"))["X"!($G(XMHDR("TYPE"))["K") Q 0
"RTN","XMR3",97,0)
 Q 1
"RTN","XMR3",98,0)
SCRUB(X) ; Strip ctrl chars and leading/trailing blanks
"RTN","XMR3",99,0)
 S:X?.E1C.E X=$$CTRL^XMXUTIL1(X)
"RTN","XMR3",100,0)
 S:$E(X,1)=" "!($E(X,$L(X))=" ") X=$$STRIP^XMXUTIL1(X)
"RTN","XMR3",101,0)
 Q X
"RTN","XMR3",102,0)
BASK ; "X-MM-BASKET:" (Delivery Basket)
"RTN","XMR3",103,0)
 S:$D(XMZIENS) XMZFDA(3.9,XMZIENS,21)=XMP
"RTN","XMR3",104,0)
 Q
"RTN","XMR3",105,0)
CLOS ; "X-MM-CLOSED:YES"
"RTN","XMR3",106,0)
 S:$D(XMZIENS) XMZFDA(3.9,XMZIENS,1.95)="y"
"RTN","XMR3",107,0)
 Q
"RTN","XMR3",108,0)
DATE ; "DATE:"
"RTN","XMR3",109,0)
 S XMDATE=XMP
"RTN","XMR3",110,0)
 S:$D(XMZIENS) XMZFDA(3.9,XMZIENS,1.4)=XMDATE
"RTN","XMR3",111,0)
 Q
"RTN","XMR3",112,0)
ENCR ; "ENCRYPT:"
"RTN","XMR3",113,0)
 S XMENCR=XMP
"RTN","XMR3",114,0)
 Q:'$D(XMZIENS)
"RTN","XMR3",115,0)
 S XMZFDA(3.9,XMZIENS,1.8)=$P(XMENCR,U,1)        ; scramble hint
"RTN","XMR3",116,0)
 S XMZFDA(3.9,XMZIENS,1.85)=$P(XMENCR,U,2,999)   ; scramble key
"RTN","XMR3",117,0)
 Q
"RTN","XMR3",118,0)
EXPI ; "EXPIRY-DATE:" (vaporize date)
"RTN","XMR3",119,0)
 N XMVAPOR
"RTN","XMR3",120,0)
 S XMVAPOR=$$CONVERT^XMXUTIL1(XMP,1) Q:XMVAPOR=-1
"RTN","XMR3",121,0)
 S:$D(XMZIENS) XMZFDA(3.9,XMZIENS,1.6)=XMVAPOR
"RTN","XMR3",122,0)
 Q
"RTN","XMR3",123,0)
FROM ; "FROM:"
"RTN","XMR3",124,0)
 S XMFROM=XMP
"RTN","XMR3",125,0)
 Q:'$D(XMZIENS)
"RTN","XMR3",126,0)
 ;I $D(XMHDR("FROM",1)) D CONTINU(.XMFROM,"FROM",.XMHDR)
"RTN","XMR3",127,0)
 S XMZFDA(3.9,XMZIENS,1)=XMFROM
"RTN","XMR3",128,0)
 Q
"RTN","XMR3",129,0)
CONTINU(XMVBL,XMH,XMHDR) ;
"RTN","XMR3",130,0)
 N I
"RTN","XMR3",131,0)
 S I=0
"RTN","XMR3",132,0)
 F  S I=$O(XMHDR(XMH,I)) Q:'I  S XMVBL=XMVBL_" "_XMHDR(XMH,I)
"RTN","XMR3",133,0)
 Q
"RTN","XMR3",134,0)
IMPO ; "IMPORTANCE:HIGH" (Priority)
"RTN","XMR3",135,0)
 I $$UP^XLFSTR(XMP)'="HIGH"!'$D(XMZIENS) Q
"RTN","XMR3",136,0)
 S:$G(XMZFDA(3.9,XMZIENS,1.7))'["P" XMZFDA(3.9,XMZIENS,1.7)=$G(XMZFDA(3.9,XMZIENS,1.7))_"P"
"RTN","XMR3",137,0)
 Q
"RTN","XMR3",138,0)
INFO ; "X-MM-INFO-ONLY:YES"
"RTN","XMR3",139,0)
 S:$D(XMZIENS) XMZFDA(3.9,XMZIENS,1.97)="y"
"RTN","XMR3",140,0)
 Q
"RTN","XMR3",141,0)
REFE ; "REFERENCES:" (used by some systems, instead of 'in-reply-to')
"RTN","XMR3",142,0)
 Q
"RTN","XMR3",143,0)
INRE ; "IN-REPLY-TO:" message at this site
"RTN","XMR3",144,0)
 N I,XMLOCID,XMREC
"RTN","XMR3",145,0)
 S XMLOCID=$$REMID(XMP)
"RTN","XMR3",146,0)
 S XMZO=$$LOCALXMZ^XMR3A(XMLOCID)
"RTN","XMR3",147,0)
 Q:'XMZO
"RTN","XMR3",148,0)
 I $P(XMZO,U,3)'="E" S XMZO="" Q
"RTN","XMR3",149,0)
 S XMZO=+XMZO
"RTN","XMR3",150,0)
 S XMREC=$G(^XMB(3.9,XMZO,0))
"RTN","XMR3",151,0)
 I $P(XMREC,U,8) D  ; If reply to a reply, get original msg #
"RTN","XMR3",152,0)
 . S XMZO=$P(XMREC,U,8)
"RTN","XMR3",153,0)
 . S XMREC=$G(^XMB(3.9,XMZO,0))
"RTN","XMR3",154,0)
 I XMREC="" S XMZO="" Q  ; Original message not found, so make this reply a message.
"RTN","XMR3",155,0)
 I "^y^Y^"[(U_$P(XMREC,U,12)_U) S XMRINFO=1 Q  ; Reply to 'info only' msg
"RTN","XMR3",156,0)
 S:$D(XMZIENS) XMZFDA(3.9,XMZIENS,1.35)=XMZO  ; Point from response to original msg
"RTN","XMR3",157,0)
 Q
"RTN","XMR3",158,0)
REMID(X) ;
"RTN","XMR3",159,0)
 Q:X["<" $TR($P(X,">",1),"<")
"RTN","XMR3",160,0)
 ; I've seen some like this: "<<...>>"
"RTN","XMR3",161,0)
 ; I've seen some like this: "<...>; comment here"
"RTN","XMR3",162,0)
 Q X
"RTN","XMR3",163,0)
MESS ; "MESSAGE-ID:" at site where message originated
"RTN","XMR3",164,0)
 S XMREMID=$$REMID(XMP)
"RTN","XMR3",165,0)
 S:$D(XMZIENS) XMZFDA(3.9,XMZIENS,9)=XMREMID
"RTN","XMR3",166,0)
 Q
"RTN","XMR3",167,0)
PRIO ; "X-PRIORITY:1" (Priority)
"RTN","XMR3",168,0)
 I $$UP^XLFSTR(XMP)'=1!'$D(XMZIENS) Q
"RTN","XMR3",169,0)
 S:$G(XMZFDA(3.9,XMZIENS,1.7))'["P" XMZFDA(3.9,XMZIENS,1.7)=$G(XMZFDA(3.9,XMZIENS,1.7))_"P"
"RTN","XMR3",170,0)
 Q
"RTN","XMR3",171,0)
REPL ; "REPLY-TO:"
"RTN","XMR3",172,0)
 S XMREPLTO=XMP
"RTN","XMR3",173,0)
 ;I $D(XMHDR("REPL",1)) D CONTINU(.XMREPLTO,"REPL",.XMHDR)
"RTN","XMR3",174,0)
 Q
"RTN","XMR3",175,0)
RETU ; "RETURN-RECEIPT-TO:"
"RTN","XMR3",176,0)
 S:$D(XMZIENS) XMZFDA(3.9,XMZIENS,1.3)="y"
"RTN","XMR3",177,0)
 Q
"RTN","XMR3",178,0)
SEND ; "SENDER:" (Surrogate)
"RTN","XMR3",179,0)
 S XMSENDER=XMP
"RTN","XMR3",180,0)
 ;I $D(XMHDR("SEND",1)) D CONTINU(.XMSENDER,"SEND",.XMHDR)
"RTN","XMR3",181,0)
 Q:XMSENDER=$G(XMFROM)
"RTN","XMR3",182,0)
 S:$D(XMZIENS) XMZFDA(3.9,XMZIENS,1.1)=XMSENDER
"RTN","XMR3",183,0)
 Q
"RTN","XMR3",184,0)
SENS ; "SENSITIVITY:PERSONAL" (Confidential)
"RTN","XMR3",185,0)
 Q:"^PERSONAL^PRIVATE^COMPANY-CONFIDENTIAL^"'[(U_$$UP^XLFSTR(XMP)_U)
"RTN","XMR3",186,0)
 S:$D(XMZIENS) XMZFDA(3.9,XMZIENS,1.96)="y"
"RTN","XMR3",187,0)
 Q
"RTN","XMR3",188,0)
SUBJ ; "SUBJECT:"
"RTN","XMR3",189,0)
 S XMSUBJ=XMP
"RTN","XMR3",190,0)
 I XMSUBJ["   " S XMSUBJ=$$MAXBLANK^XMXUTIL1(XMSUBJ)
"RTN","XMR3",191,0)
 I XMSUBJ["^" S XMSUBJ=$$ENCODEUP^XMXUTIL1(XMSUBJ)
"RTN","XMR3",192,0)
 S XMSUBJ=$E(XMSUBJ,1,65)
"RTN","XMR3",193,0)
 Q:XMSUBJ=""!'$D(XMZIENS)
"RTN","XMR3",194,0)
 I $L(XMSUBJ)<3 S XMSUBJ="..."
"RTN","XMR3",195,0)
 S XMZFDA(3.9,XMZIENS,.01)=XMSUBJ
"RTN","XMR3",196,0)
 Q
"RTN","XMR3",197,0)
TYPE ; "X-MM-TYPE:"
"RTN","XMR3",198,0)
 S:$D(XMZIENS) XMZFDA(3.9,XMZIENS,1.7)=XMP
"RTN","XMR3",199,0)
 Q
"RTN","XMR3",200,0)
SET ; Set data into message file
"RTN","XMR3",201,0)
 I $G(XMREMID)'="" D CHEKDUP^XMR3A Q:$G(XMREJECT)
"RTN","XMR3",202,0)
 I $D(XMZFDA) D
"RTN","XMR3",203,0)
 . I $D(XMZFDA(3.9,XMZIENS,1.1)),$L(XMZFDA(3.9,XMZIENS,1))+$L(XMZFDA(3.9,XMZIENS,1.1))>130 S XMZFDA(3.9,XMZIENS,1.1)=$E($$REMADDR^XMXADDR3(XMZFDA(3.9,XMZIENS,1.1)),1,64)
"RTN","XMR3",204,0)
 . I $L(XMZFDA(3.9,XMZIENS,1))>100 S XMZFDA(3.9,XMZIENS,1)="<"_$$REMADDR^XMXADDR3(XMZFDA(3.9,XMZIENS,1))_">"
"RTN","XMR3",205,0)
 . D FILE^DIE("","XMZFDA")
"RTN","XMR3",206,0)
 ;SENDER only RCPT / REMOTE sender drops thru (local>0=pointer)
"RTN","XMR3",207,0)
 I $G(XMZO) D  Q:$O(^TMP("XMY",$J,""))  ; I don't understand this.
"RTN","XMR3",208,0)
 . D DOTRAN^XMC1(42315,XMZ,XMZO) ;> Putting response |1| into message |2|
"RTN","XMR3",209,0)
 . D DOTRAN^XMC1(42316,XMZO)     ;> Delivering message |1|
"RTN","XMR3",210,0)
 . D RPOST^XMKP("NR",XMZO,XMZ)
"RTN","XMR3",211,0)
 D FWD^XMKP(.5,XMZ,.XMINSTR)
"RTN","XMR3",212,0)
 D CHECK^XMKPL
"RTN","XMR3",213,0)
 Q
"RTN","XMR3",214,0)
PARSE(XMZ,XMREMID,XMSUBJ,XMFROM,XMDATE,XMSENDER,XMENCR,XMZO) ; Get data for remotely originated message
"RTN","XMR3",215,0)
 ; This is used by ^XMRENT & ^XMS3
"RTN","XMR3",216,0)
 ; XMSUBJ   subject
"RTN","XMR3",217,0)
 ; XMFROM   from
"RTN","XMR3",218,0)
 ; XMDATE   date
"RTN","XMR3",219,0)
 ; XMENCR   scramble hint "^" scramble key
"RTN","XMR3",220,0)
 ; XMREMID  message id at site where msg originated (not necessarily at the sending site)
"RTN","XMR3",221,0)
 ; XMZO     original message xmz (to which this msg is a response)
"RTN","XMR3",222,0)
 N XMP,XMH,XMHDR,XMRINFO,XMZFDA,XMZIENS,XMFIND
"RTN","XMR3",223,0)
 ; Don't add anything to this list:
"RTN","XMR3",224,0)
 S XMFIND="^DATE^ENCRYPTED^FROM^IN-REPLY-TO^MESSAGE-ID^SENDER^SUBJECT^"
"RTN","XMR3",225,0)
 D HDRFIND(XMZ,XMFIND,.XMHDR)
"RTN","XMR3",226,0)
 S XMH=""
"RTN","XMR3",227,0)
 F  S XMH=$O(XMHDR(XMH)) Q:XMH=""  D
"RTN","XMR3",228,0)
 . S XMP=XMHDR(XMH)
"RTN","XMR3",229,0)
 . D @XMH
"RTN","XMR3",230,0)
 Q
"RTN","XMR3",231,0)
HDRFIND(XMZ,XMFIND,XMHDR) ;
"RTN","XMR3",232,0)
 N XMH,XMI,XMREC
"RTN","XMR3",233,0)
 I XMFIND'?1"^".E1"^" D
"RTN","XMR3",234,0)
 . I $E(XMFIND,1)'=U S XMFIND=U_XMFIND
"RTN","XMR3",235,0)
 . I $E(XMFIND,$L(XMFIND))'=U S XMFIND=XMFIND_U
"RTN","XMR3",236,0)
 S XMI=0
"RTN","XMR3",237,0)
 F  S XMI=$O(^XMB(3.9,XMZ,2,XMI)) Q:XMI'<1!'XMI  S XMREC=^(XMI,0) Q:XMREC=""  D
"RTN","XMR3",238,0)
 . I $E(XMREC,1)=" "!($E(XMREC,1)=$C(9)) Q:XMH=""  D NEXT(XMH,.XMHDR,XMREC) Q
"RTN","XMR3",239,0)
 . S XMH=$$UP^XLFSTR($P(XMREC,":"))
"RTN","XMR3",240,0)
 . I XMFIND'[(U_XMH_U) S XMH="" Q
"RTN","XMR3",241,0)
 . I "^DATE^FROM^IMPORTANCE^IN-REPLY-TO^MESSAGE-ID^SUBJECT^"[(U_XMH_U) S XMH=$E($TR(XMH,"-"),1,4),XMHDR(XMH)=$$SCRUB($P(XMREC,":",2,99)) Q
"RTN","XMR3",242,0)
 . I "^ENCRYPTED^EXPIRY-DATE^REFERENCES^REPLY-TO^RETURN-RECEIPT-TO^SENDER^SENSITIVITY^"[(U_XMH_U) S XMH=$E($TR(XMH,"-"),1,4),XMHDR(XMH)=$$SCRUB($P(XMREC,":",2,99)) Q
"RTN","XMR3",243,0)
 . I "^X-PRIORITY^"[(U_XMH_U) S XMH=$E($P(XMH,"-",2),1,4),XMHDR(XMH)=$$SCRUB($P(XMREC,":",2,99)) Q
"RTN","XMR3",244,0)
 . I "^X-MM-BASKET^X-MM-CLOSED^X-MM-INFO-ONLY^X-MM-TYPE^"[(U_XMH_U) S XMH=$E($P(XMH,"-",3),1,4),XMHDR(XMH)=$$SCRUB($P(XMREC,":",2,99)) Q
"RTN","XMR3",245,0)
 . S XMH=""
"RTN","XMR3",246,0)
 Q
"RTN","XMR3A")
0^55^B6907946
"RTN","XMR3A",1,0)
XMR3A ;ISC-SF/GMB-XMR3 (cont.) ;04/17/2002  11:16
"RTN","XMR3A",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMR3A",3,0)
CHEKDUP ;
"RTN","XMR3A",4,0)
 N XMZCHK,XMTO
"RTN","XMR3A",5,0)
 ;REJECT ON PURGED MESSAGE PROTECT FOC-AUSTIN
"RTN","XMR3A",6,0)
 ;DO NOT CHANGE WITHOUT COORDINATING
"RTN","XMR3A",7,0)
 S XMZCHK=$$LOCALXMZ(XMREMID)
"RTN","XMR3A",8,0)
 ;Set up "AI" cross reference -- since XMBX is replicated at FOC-Austin
"RTN","XMR3A",9,0)
 ;set pseudo node first so that if DDP is down, failure will occur before
"RTN","XMR3A",10,0)
 ;message is considered received.
"RTN","XMR3A",11,0)
 ;
"RTN","XMR3A",12,0)
 ;Accept as new message if NOT HERE
"RTN","XMR3A",13,0)
 Q:'XMZCHK
"RTN","XMR3A",14,0)
 ; We already have the message
"RTN","XMR3A",15,0)
 I $P(XMZCHK,U,3)'="E"!(XMZ=+XMZCHK) D  Q
"RTN","XMR3A",16,0)
 . S XMSG="554 Duplicate (purged).  Msg rejected." X XMSEN
"RTN","XMR3A",17,0)
 . D KILLIT
"RTN","XMR3A",18,0)
 . S XMREJECT=1
"RTN","XMR3A",19,0)
 S XMTO=""
"RTN","XMR3A",20,0)
 F  S XMTO=$O(^TMP("XMY",$J,XMTO)) Q:XMTO=""  I $D(^XMB(3.7,"M",+XMZCHK,XMTO)) K ^TMP("XMY",$J,XMTO)
"RTN","XMR3A",21,0)
 I $O(^TMP("XMY",$J,""))="" D  Q
"RTN","XMR3A",22,0)
 . S XMSG="254 Duplicate (no add'l recipients).  Msg rejected." X XMSEN
"RTN","XMR3A",23,0)
 . D KILLIT
"RTN","XMR3A",24,0)
 . S XMREJECT=1
"RTN","XMR3A",25,0)
 ; We are forwarding a msg which already exists on our system
"RTN","XMR3A",26,0)
 ; to recipients who don't currently have it in their mailbox.
"RTN","XMR3A",27,0)
 K XMZFDA  ; When we implement true 'forwarded by', we'll have to retain that.
"RTN","XMR3A",28,0)
 D KILLIT
"RTN","XMR3A",29,0)
 S XMZ=+XMZCHK
"RTN","XMR3A",30,0)
 Q
"RTN","XMR3A",31,0)
KILLIT ;
"RTN","XMR3A",32,0)
 K XMREMID
"RTN","XMR3A",33,0)
 D ZAPIT^XMXMSGS2(.5,.95,XMZ)
"RTN","XMR3A",34,0)
 D KILLMSG^XMXUTIL(XMZ)
"RTN","XMR3A",35,0)
 Q
"RTN","XMR3A",36,0)
LOCALXMZ(XMREMID) ; Given a remote id, function returns XMZ if the message
"RTN","XMR3A",37,0)
 ; can be or was ever found locally.
"RTN","XMR3A",38,0)
 ; If no record of it, returns null.
"RTN","XMR3A",39,0)
 ; Otherwise, returns:
"RTN","XMR3A",40,0)
 ; Piece 1: local XMZ
"RTN","XMR3A",41,0)
 ; Piece 2: originated here? (0=no; 1=yes)
"RTN","XMR3A",42,0)
 ; Piece 3: still exists? (P=no, purged;
"RTN","XMR3A",43,0)
 ;                         R=no, purged, & replaced with something else;
"RTN","XMR3A",44,0)
 ;                         E=yes, it still exists here)
"RTN","XMR3A",45,0)
 N XMZCHK,XMP1,XMP2
"RTN","XMR3A",46,0)
 S XMP1=$P(XMREMID,"@",1),XMP2=$P(XMREMID,"@",2)
"RTN","XMR3A",47,0)
 I XMP1=""!(XMP2="") Q ""
"RTN","XMR3A",48,0)
 S XMZCHK=$$FINDXMZ(XMP1,XMP2)
"RTN","XMR3A",49,0)
 I XMZCHK Q XMZCHK
"RTN","XMR3A",50,0)
 S XMZCHK=$$FINDXMZ(XMP2,XMP1)
"RTN","XMR3A",51,0)
 I XMZCHK Q XMZCHK
"RTN","XMR3A",52,0)
 Q ""
"RTN","XMR3A",53,0)
FINDXMZ(XMP1,XMP2) ;
"RTN","XMR3A",54,0)
 I XMP1?.N!(XMP1?.N1"."7N) Q:XMP2=^XMB("NETNAME") $$LOCXMZ(XMP1)  Q:$$FIND1^DIC(4.2,"","QX",XMP2,"B^C")=^XMB("NUM") $$LOCXMZ(XMP1)
"RTN","XMR3A",55,0)
 N XMZ
"RTN","XMR3A",56,0)
TRY S XMZ=$O(^XMBX(3.9,"AI",$E(XMP2,1,64),$E(XMP1,1,64),0))
"RTN","XMR3A",57,0)
 I XMZ Q $$REMXMZ(XMZ,XMP2,XMP1)
"RTN","XMR3A",58,0)
 I XMP1?.N1"."7N S XMP1=$P(XMP1,".") G TRY
"RTN","XMR3A",59,0)
 Q ""
"RTN","XMR3A",60,0)
LOCXMZ(XMZ) ; Message originated here.
"RTN","XMR3A",61,0)
 I XMZ'["." Q XMZ_"^1^"_$S($D(^XMB(3.9,XMZ,0)):"E",1:"P")
"RTN","XMR3A",62,0)
 ; The following code won't activate until MailMan message IDs contain
"RTN","XMR3A",63,0)
 ; dates.  Message IDs are created in $$NETID^XMS3.
"RTN","XMR3A",64,0)
 N XMCRE8
"RTN","XMR3A",65,0)
 S XMCRE8=$P(XMZ,".",2),XMZ=$P(XMZ,".",1)
"RTN","XMR3A",66,0)
 Q XMZ_"^1^"_$S('$D(^XMB(3.9,XMZ,0)):"P",$P($G(^XMB(3.9,XMZ,.6)),U,1)=XMCRE8:"E",1:"R")
"RTN","XMR3A",67,0)
REMXMZ(XMZ,XMP2,XMP1) ; Message originated somewhere else.
"RTN","XMR3A",68,0)
 I '$D(^XMB(3.9,XMZ,0)) Q XMZ_"^0^P"
"RTN","XMR3A",69,0)
 N XMREMID
"RTN","XMR3A",70,0)
 S XMREMID=$G(^XMB(3.9,XMZ,5))
"RTN","XMR3A",71,0)
 I XMREMID="" Q XMZ_"^0^R"
"RTN","XMR3A",72,0)
 I XMP1_"@"_XMP2=XMREMID Q XMZ_"^0^E"
"RTN","XMR3A",73,0)
 I XMP2_"@"_XMP1=XMREMID Q XMZ_"^0^E"
"RTN","XMR3A",74,0)
 Q XMZ_"^0^R"
"RTN","XMR4")
0^56^B39144591
"RTN","XMR4",1,0)
XMR4 ;ISC-SF/GMB-SMTP HELP ;04/17/2002  11:17
"RTN","XMR4",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMR4",3,0)
HELPME ;
"RTN","XMR4",4,0)
 N XMALL
"RTN","XMR4",5,0)
 S XMALL="HHHH^EXPN^HELO^HELP^MAIL^NOOP^QUIT^RCPT^RSET^TURN^VRFY"
"RTN","XMR4",6,0)
 I XMP="ALL" D ALL G END
"RTN","XMR4",7,0)
 I U_XMALL_U[(U_XMP_U) D SHOW(XMP) G END
"RTN","XMR4",8,0)
 D SHOW("HHHH")
"RTN","XMR4",9,0)
END I 'ER S XMSG="214 " X XMSEN
"RTN","XMR4",10,0)
 Q
"RTN","XMR4",11,0)
ALL ;
"RTN","XMR4",12,0)
 N I,J
"RTN","XMR4",13,0)
 F I=1:1:$L(XMALL,U) D SHOW($P(XMALL,U,I)) Q:ER
"RTN","XMR4",14,0)
 Q
"RTN","XMR4",15,0)
SHOW(XMCMD) ;
"RTN","XMR4",16,0)
 N I
"RTN","XMR4",17,0)
 F I=0:1 S XMSG="214-"_$P($T(@XMCMD+I),";",3,99) Q:$L(XMSG)=4  X XMSEN Q:ER
"RTN","XMR4",18,0)
 Q
"RTN","XMR4",19,0)
HHHH ;; 
"RTN","XMR4",20,0)
 ;;This is the simple mail transfer protocol receiver
"RTN","XMR4",21,0)
 ;;Commands currently understood are: 
"RTN","XMR4",22,0)
 ;;HELO <domain> (which initiates a transaction)
"RTN","XMR4",23,0)
 ;;MAIL FROM: <reverse-path>
"RTN","XMR4",24,0)
 ;;RCPT TO: <forward-path>  (which names a recipient)
"RTN","XMR4",25,0)
 ;;DATA (terminated with a single line of '.')
"RTN","XMR4",26,0)
 ;;HELP (which displays this text)
"RTN","XMR4",27,0)
 ;;NOOP (which does nothing)
"RTN","XMR4",28,0)
 ;;RSET <reason for> which stops transmission of message
"RTN","XMR4",29,0)
 ;;STAT (which displays the current status of the receiver)
"RTN","XMR4",30,0)
 ;;VRFY <user> (which verifies the existence of a user)
"RTN","XMR4",31,0)
 ;;TURN (Which turns around the line; Sender becomes receiver)
"RTN","XMR4",32,0)
 ;;EXPN <mail group> (which lists the members of a group)
"RTN","XMR4",33,0)
 ;;QUIT (which terminates the connection)
"RTN","XMR4",34,0)
 ;; 
"RTN","XMR4",35,0)
 ;;CHRS <domain> initialize a remote domain
"RTN","XMR4",36,0)
 ;;Extensions:
"RTN","XMR4",37,0)
 ;;MESS ID:XMREMID Sending message remote ID to allow processing to stop
"RTN","XMR4",38,0)
 ;; 
"RTN","XMR4",39,0)
 ;;Enter HELP ALL to see further discussion on all commands, or
"RTN","XMR4",40,0)
 ;;HELP <command> to see further discussion of <command>.
"RTN","XMR4",41,0)
 ;;
"RTN","XMR4",42,0)
HELO ;; 
"RTN","XMR4",43,0)
 ;;The HELO command is used to identify the sending host to the receiver:
"RTN","XMR4",44,0)
 ;; 
"RTN","XMR4",45,0)
 ;;   HELO <domain>
"RTN","XMR4",46,0)
 ;; 
"RTN","XMR4",47,0)
 ;; Where <domain> is the name of the sending host.
"RTN","XMR4",48,0)
 ;; 
"RTN","XMR4",49,0)
 ;;If the receiver will accept mail, it responds with its name.
"RTN","XMR4",50,0)
 ;; 
"RTN","XMR4",51,0)
 ;;The HELO command must be the first command of a mail sequence.
"RTN","XMR4",52,0)
 ;;
"RTN","XMR4",53,0)
MAIL ;; 
"RTN","XMR4",54,0)
 ;;The MAIL command is used after a HELO command to ask a receiver to
"RTN","XMR4",55,0)
 ;;accept a mail message.  The format is:
"RTN","XMR4",56,0)
 ;; 
"RTN","XMR4",57,0)
 ;;  MAIL FROM: <user>@<site>
"RTN","XMR4",58,0)
 ;; 
"RTN","XMR4",59,0)
 ;;where <user> is the name of the user sending the message, and <site>
"RTN","XMR4",60,0)
 ;;is the name of the site sending the mail, in Internet domain
"RTN","XMR4",61,0)
 ;;format.
"RTN","XMR4",62,0)
 ;;
"RTN","XMR4",63,0)
 ;;The receiver will respond with "250 OK" if accepted, and "501 Invalid
"RTN","XMR4",64,0)
 ;;Reverse path specification" if not.
"RTN","XMR4",65,0)
 ;; 
"RTN","XMR4",66,0)
 ;;This command is followed with RCPT and DATA commands to name
"RTN","XMR4",67,0)
 ;;and transfer the data, respectively.
"RTN","XMR4",68,0)
 ;;
"RTN","XMR4",69,0)
RCPT ;; 
"RTN","XMR4",70,0)
 ;;This command is used to identify the recipients of the mail.
"RTN","XMR4",71,0)
 ;;Its format is:
"RTN","XMR4",72,0)
 ;; 
"RTN","XMR4",73,0)
 ;;   RCPT TO: <user>
"RTN","XMR4",74,0)
 ;; 
"RTN","XMR4",75,0)
 ;;If the user is found, the receiver will respond with "250 OK";
"RTN","XMR4",76,0)
 ;;Otherwise, it will say "501 Invalid forward path specification".
"RTN","XMR4",77,0)
 ;; 
"RTN","XMR4",78,0)
 ;;Each recipient of the message is named individually.  The VRFY
"RTN","XMR4",79,0)
 ;;command can be used to confirm the existence of a user without
"RTN","XMR4",80,0)
 ;;actually putting him on the recipient list. 
"RTN","XMR4",81,0)
 ;;After recipients are specified, the DATA command is used to transfer
"RTN","XMR4",82,0)
 ;;the body of the message.
"RTN","XMR4",83,0)
 ;;
"RTN","XMR4",84,0)
DATA ;; 
"RTN","XMR4",85,0)
 ;;The DATA command is used after the MAIL and RCPT commands to transmit
"RTN","XMR4",86,0)
 ;;the body of the message.  The command has no arguments.  The receiver's
"RTN","XMR4",87,0)
 ;;response to the command is to either issue an error message:
"RTN","XMR4",88,0)
 ;;"503 no recipients specified" or "354 Start mail input".
"RTN","XMR4",89,0)
 ;; 
"RTN","XMR4",90,0)
 ;;Data will be accepted until a line consisting of a single period is
"RTN","XMR4",91,0)
 ;;detected.  If any line begins with a period, it must have an
"RTN","XMR4",92,0)
 ;;additional period inserted at the beginning of the line.
"RTN","XMR4",93,0)
 ;; 
"RTN","XMR4",94,0)
 ;;After the DATA command is completed, the receiver will respond with
"RTN","XMR4",95,0)
 ;;"250 OK" if the message was accepted, or an error message if 
"RTN","XMR4",96,0)
 ;;otherwise.
"RTN","XMR4",97,0)
 ;;
"RTN","XMR4",98,0)
RSET ;; 
"RTN","XMR4",99,0)
 ;;The RSET (Reset) command is used to reset the receiver to its initial
"RTN","XMR4",100,0)
 ;;state and cancel any mail in progress.  The sender does not need to
"RTN","XMR4",101,0)
 ;;issue HELO again.
"RTN","XMR4",102,0)
 ;;
"RTN","XMR4",103,0)
VRFY ;; 
"RTN","XMR4",104,0)
 ;;The VRFY (Verify) command is used to verify the existence of a user
"RTN","XMR4",105,0)
 ;;at the receiver.  The format is:
"RTN","XMR4",106,0)
 ;; 
"RTN","XMR4",107,0)
 ;;   VRFY <user>
"RTN","XMR4",108,0)
 ;;  
"RTN","XMR4",109,0)
 ;;The computer will respond with the user's full name if found, or
"RTN","XMR4",110,0)
 ;;"550 User not found" if not.  This command can be issued at any 
"RTN","XMR4",111,0)
 ;;time, and does not affect the recipient list.
"RTN","XMR4",112,0)
 ;;
"RTN","XMR4",113,0)
EXPN ;; 
"RTN","XMR4",114,0)
 ;;The EXPN (Expand) command causes the receiver to expand a mailing
"RTN","XMR4",115,0)
 ;;list, showing the sender the list of individuals in the list.
"RTN","XMR4",116,0)
 ;;
"RTN","XMR4",117,0)
HELP ;;
"RTN","XMR4",118,0)
 ;;The HELP command displays user assistance information for interactive
"RTN","XMR4",119,0)
 ;;users.  If issued without an argument, it gives a general introduction.
"RTN","XMR4",120,0)
 ;;If given an argument naming a command, it gives further information
"RTN","XMR4",121,0)
 ;;on that command.  If given an argument of "ALL", it displays 
"RTN","XMR4",122,0)
 ;;help on all arguments.
"RTN","XMR4",123,0)
 ;;
"RTN","XMR4",124,0)
NOOP ;; 
"RTN","XMR4",125,0)
 ;;The NOOP (no operation) command causes the receiver to respond with
"RTN","XMR4",126,0)
 ;;a "250 OK" message.
"RTN","XMR4",127,0)
 ;;
"RTN","XMR4",128,0)
QUIT ;; 
"RTN","XMR4",129,0)
 ;;The QUIT command is used to terminate the mail transfer process.
"RTN","XMR4",130,0)
 ;;The connection will be closed, and any mail transfers not concluded
"RTN","XMR4",131,0)
 ;;with a successful DATA command will be lost.
"RTN","XMR4",132,0)
 ;;
"RTN","XMR4",133,0)
TURN ;;  
"RTN","XMR4",134,0)
 ;;
"RTN","XMRENT")
0^57^B4269431
"RTN","XMRENT",1,0)
XMRENT ;ISC-SF/GMB-Msg Network Header Info API ;04/19/2002  13:17
"RTN","XMRENT",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMRENT",3,0)
 ; Was (WASH ISC)/CMW
"RTN","XMRENT",4,0)
 ;
"RTN","XMRENT",5,0)
 ; Entry points (DBIA 1143):
"RTN","XMRENT",6,0)
 ; $$NET  Get message information.
"RTN","XMRENT",7,0)
 ;
"RTN","XMRENT",8,0)
 ;Extrinsic Function for API call to parse network header
"RTN","XMRENT",9,0)
 ;Parameter #1=Message #
"RTN","XMRENT",10,0)
 ;
"RTN","XMRENT",11,0)
 ;Output=STRING
"RTN","XMRENT",12,0)
 ; Message-date ^ Encryption-code ^ Returned addr of sender ^ Message ID
"RTN","XMRENT",13,0)
 ; ^ Sender ^ Message subject ^ Message ID of In-reply-to ^ Message Type
"RTN","XMRENT",14,0)
 ;
"RTN","XMRENT",15,0)
NET(XMZ) ;
"RTN","XMRENT",16,0)
 Q:'$D(^XMB(3.9,XMZ,0)) ""
"RTN","XMRENT",17,0)
 N XMDATE,XMENCR,XMFROM,XMREMID,XMSEND,XMSUBJ,XMZO,XMFIRST
"RTN","XMRENT",18,0)
 S XMFIRST=$O(^XMB(3.9,XMZ,2,0))
"RTN","XMRENT",19,0)
 I XMFIRST,XMFIRST<1 D
"RTN","XMRENT",20,0)
 . D NETMAIL(XMZ,.XMREMID,.XMSUBJ,.XMFROM,.XMDATE,.XMSEND,.XMENCR,.XMZO)
"RTN","XMRENT",21,0)
 E  D
"RTN","XMRENT",22,0)
 . D LOCMAIL(XMZ,.XMREMID,.XMSUBJ,.XMFROM,.XMDATE,.XMSEND,.XMENCR,.XMZO)
"RTN","XMRENT",23,0)
 Q $G(XMDATE)_U_$G(XMENCR)_U_$G(XMFROM)_U_$G(XMREMID)_U_$G(XMSEND)_U_$G(XMSUBJ)_U_$G(XMZO)_U_$P($G(^XMB(3.9,XMZ,0)),U,7)
"RTN","XMRENT",24,0)
LOCMAIL(XMZ,XMREMID,XMSUBJ,XMFROM,XMDATE,XMSEND,XMENCR,XMZO) ; Get data for Locally originated message
"RTN","XMRENT",25,0)
 N XMZREC,Y
"RTN","XMRENT",26,0)
 S XMZREC=^XMB(3.9,XMZ,0)
"RTN","XMRENT",27,0)
 S Y=$P(XMZREC,U,3),%DT="S" D DD^%DT S XMDATE=Y
"RTN","XMRENT",28,0)
 S:$P(XMZREC,U,8) XMZO=^XMB("NETNAME")_"@"_$P(XMZREC,U,8)
"RTN","XMRENT",29,0)
 S XMSEND=$S($P(XMZREC,U,4)="":"",1:$$NAME^XMXUTIL($P(XMZREC,U,4)))
"RTN","XMRENT",30,0)
 S XMENCR=$P(XMZREC,U,10)
"RTN","XMRENT",31,0)
 S XMFROM=$$NAME^XMXUTIL($P(XMZREC,U,2))
"RTN","XMRENT",32,0)
 S XMSUBJ=$$SUBJ^XMXUTIL2(XMZREC)
"RTN","XMRENT",33,0)
 S XMREMID=$$NETID^XMS3(XMZ)
"RTN","XMRENT",34,0)
 Q
"RTN","XMRENT",35,0)
NETMAIL(XMZ,XMREMID,XMSUBJ,XMFROM,XMDATE,XMSEND,XMENCR,XMZO) ; Get data for Message that originated from another domain
"RTN","XMRENT",36,0)
 D PARSE^XMR3(XMZ,.XMREMID,.XMSUBJ,.XMFROM,.XMDATE,.XMSEND,.XMENCR,.XMZO)
"RTN","XMRENT",37,0)
 S:$G(XMSUBJ)="" XMSUBJ=" "
"RTN","XMRENT",38,0)
 S XMFROM="<"_$$REMADDR^XMXADDR3(XMFROM)_">"
"RTN","XMRENT",39,0)
 S:XMREMID[".VA.GOV" XMFROM=$TR($P(XMFROM,"@"),"._+",", .")_"@"_$P(XMFROM,"@",2)
"RTN","XMRENT",40,0)
 Q
"RTN","XMRFTP")
0^322^B6643646
"RTN","XMRFTP",1,0)
XMRFTP ;(WASH ISC)/THM/CAP-SMTP Receiver (RFC 821) ;04/17/2002  11:20
"RTN","XMRFTP",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMRFTP",3,0)
 ;Modified for TCP/IP under INET_SERVERS of Wollongong
"RTN","XMRFTP",4,0)
 ;Send out FTP jobs that are due
"RTN","XMRFTP",5,0)
FTP N %,DA,DIK,XMA0,XMC0,XMSFTP,Y,Z,XMCOM S XMA0=$H*86400+$P($H,",",2)
"RTN","XMRFTP",6,0)
F1 S Z=0,Z=$O(^XMBX(4.2995,Z)) G FQ:+Z'=Z I '$D(^(Z,0)) G QQ^XMRTCP
"RTN","XMRFTP",7,0)
 S Y=^XMBX(4.2995,Z,0),XMSFTP=$P(Y,U,4),XMRTCPY="MM-FTP-"_$P(Y,U),XMCOM=$P(Y,U)
"RTN","XMRFTP",8,0)
 I XMCOM'?1"XM".E D RUNQ G QQ^XMRTCP
"RTN","XMRFTP",9,0)
F2 F  S %=$S($G(XMC0):XMC0,1:$$CK^XMRTCP(1)) G F3:%
"RTN","XMRFTP",10,0)
 ;Copy file to export directory
"RTN","XMRFTP",11,0)
F3 S XMC0=% I XMSFTP S %=$$FCHK(Z,XMA0,XMSFTP) G F1:%
"RTN","XMRFTP",12,0)
 S XMRTCP("NAME")=XMRTCPY D REN
"RTN","XMRFTP",13,0)
 G RUN
"RTN","XMRFTP",14,0)
FQ I $G(XMC0) L -^XMBX("TCPCHAN-COUNT",XMC0)
"RTN","XMRFTP",15,0)
 Q
"RTN","XMRFTP",16,0)
 ;Submit FTP process
"RTN","XMRFTP",17,0)
RUN I $$NEWERR^%ZTER N $ETRAP,$ESTACK S $ETRAP=""
"RTN","XMRFTP",18,0)
 S X="RUNQ^XMRFTP",@^%ZOSF("TRAP")
"RTN","XMRFTP",19,0)
 S %=$ZC(%SPAWN,"@"_XMCOM),%=$ZC(%SPAWN,"DELETE "_XMCOM_".*")
"RTN","XMRFTP",20,0)
RUNQ ;Remove from 4.2995
"RTN","XMRFTP",21,0)
 I $D(Z) N DIK,DA S DIK="^XMBX(4.2995,",DA=Z K XMRTCPY D ^DIK Q
"RTN","XMRFTP",22,0)
 Q
"RTN","XMRFTP",23,0)
REN I $$NEWERR^%ZTER N $ETRAP,$ESTACK S $ETRAP=""
"RTN","XMRFTP",24,0)
 S X="DUPNAME^XMRTCP",@^%ZOSF("TRAP")
"RTN","XMRFTP",25,0)
 I ^%ZOSF("OS")["VAX" S X=$ZC(%SETPRN,$E(XMRTCP("NAME"),1,13))
"RTN","XMRFTP",26,0)
 D START^XMRTCPGO
"RTN","XMRFTP",27,0)
 Q
"RTN","XMRFTP",28,0)
FCHK(Z,Y,F) ;Is file in export directory ?
"RTN","XMRFTP",29,0)
 N %,%0,%1,%2,I,X,XMIO
"RTN","XMRFTP",30,0)
 S XMIO=$I,%=^XMBX(4.2995,Z,0),%0=$P(%,U,5),%2=$P(%,U,4)
"RTN","XMRFTP",31,0)
 I '%0 S $P(^XMBX(4.2995,Z,0),U,5)=Y,%=$$EXPORT^MAGAPI("MAIL",F,"WAIT") Q %
"RTN","XMRFTP",32,0)
 S %=$P(^MAG(2005,%2,0),U,2)
"RTN","XMRFTP",33,0)
CONT S %0="XMS"_$E(Z,$L(Z)-4,$L(Z))_".LIS"
"RTN","XMRFTP",34,0)
 I $$NEWERR^%ZTER N $ETRAP,$ESTACK S $ETRAP=""
"RTN","XMRFTP",35,0)
 S X="FPQ^XMRFTP",@^%ZOSF("TRAP"),X=$ZC(%SPAWN,"PURGE "_%0)
"RTN","XMRFTP",36,0)
FPQ I $$NEWERR^%ZTER N $ETRAP,$ESTACK S $ETRAP=""
"RTN","XMRFTP",37,0)
 S X="Q0^XMRFTP",@^%ZOSF("TRAP"),X=$ZC(%SPAWN,"DIR/OUTPUT="_%0_" NFA0:[EXPORT.MAIL]"_%)
"RTN","XMRFTP",38,0)
 O %0 U %0
"RTN","XMRFTP",39,0)
 I $$NEWERR^%ZTER N $ETRAP,$ESTACK S $ETRAP=""
"RTN","XMRFTP",40,0)
 S X="FCHKQ^XMRFTP",@^%ZOSF("TRAP")
"RTN","XMRFTP",41,0)
 F  R X:9 Q:X[%
"RTN","XMRFTP",42,0)
FCHKQ C %0 U XMIO
"RTN","XMRFTP",43,0)
 I X'[% Q 1
"RTN","XMRFTP",44,0)
 Q 0
"RTN","XMRFTP",45,0)
Q0 Q 1
"RTN","XMRFTP",46,0)
FER N X S X=$P($G(^XMBX(4.2995,Z,0)),U,2)
"RTN","XMRFTP",47,0)
 I 'X S X=$H*86400+$P($H,",",2),$P(^(0),U,2)=X
"RTN","XMRFTP",48,0)
 Q:$H*86400+$P($H,",",2)-%>99
"RTN","XMRFTP",49,0)
 N Z S XMDUZ=.5,XMSUB="ERROR moving File from Image Server"
"RTN","XMRFTP",50,0)
 S XMTEXT="A(",A(1)="The error was: "_%_"."
"RTN","XMRFTP",51,0)
 S A(2)="The COM file being processed was: "_Y,XMY(.5)=""
"RTN","XMRFTP",52,0)
 D ^XMD Q
"RTN","XMRFTP",53,0)
IMAGENT(Y,F) ;
"RTN","XMRFTP",54,0)
 N %,%0,XMIO,X
"RTN","XMRFTP",55,0)
 I ^%ZOSF("OS")["MSM" S X=$ZOS(12,NEWPATH,"") I $P(X,U)=F QUIT "5 -IMAGE ALREADY THERE"
"RTN","XMRFTP",56,0)
 S Z=$P($H,",",2)#1000,XMIO=$I,%=F
"RTN","XMRFTP",57,0)
 G CONT
"RTN","XMRFTPUX")
0^323^B6748352
"RTN","XMRFTPUX",1,0)
XMRFTPUX ;(WASH ISC)/THM/CAP-SMTP Receiver (RFC 821) ;04/17/2002  11:20
"RTN","XMRFTPUX",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMRFTPUX",3,0)
 ;Modified for TCP/IP under INET_SERVERS of Wollongong
"RTN","XMRFTPUX",4,0)
 ;Send out FTP jobs that are due
"RTN","XMRFTPUX",5,0)
FTP N %,DA,DIK,XMA0,XMC0,XMSFTP,Y,Z,XMCOM S XMA0=$H*86400+$P($H,",",2)
"RTN","XMRFTPUX",6,0)
F1 S Z=0,Z=$O(^XMBX(4.2995,Z)) G FQ:+Z'=Z I '$D(^(Z,0)) G QQ^XMRTCP
"RTN","XMRFTPUX",7,0)
 S Y=^XMBX(4.2995,Z,0),XMSFTP=$P(Y,U,4),XMRTCPY="MM-FTP-"_$P(Y,U),XMCOM=$P(Y,U)
"RTN","XMRFTPUX",8,0)
 I XMCOM'?1"XM".E D RUNQ G QQ^XMRTCP
"RTN","XMRFTPUX",9,0)
F2 F  S %=$S($G(XMC0):XMC0,1:$$CK^XMRTCP(1)) G F3:%
"RTN","XMRFTPUX",10,0)
 ;Copy file to export directory
"RTN","XMRFTPUX",11,0)
F3 S XMC0=% I XMSFTP S %=$$FCHK(Z,XMA0,XMSFTP) G F1:%
"RTN","XMRFTPUX",12,0)
 S XMRTCP("NAME")=XMRTCPY D REN
"RTN","XMRFTPUX",13,0)
 G RUN
"RTN","XMRFTPUX",14,0)
FQ I $G(XMC0) L -^XMBX("TCPCHAN-COUNT",XMC0)
"RTN","XMRFTPUX",15,0)
 Q
"RTN","XMRFTPUX",16,0)
 ;Submit FTP process
"RTN","XMRFTPUX",17,0)
RUN I $$NEWERR^%ZTER N $ETRAP,$ESTACK S $ETRAP=""
"RTN","XMRFTPUX",18,0)
 S X="RUNQ^XMRFTP",@^%ZOSF("TRAP")
"RTN","XMRFTPUX",19,0)
 S %=$ZC(%SPAWN,"@"_XMCOM),%=$ZC(%SPAWN,"DELETE "_XMCOM_".*")
"RTN","XMRFTPUX",20,0)
RUNQ ;Remove from 4.2995
"RTN","XMRFTPUX",21,0)
 I $D(Z) N DIK,DA S DIK="^XMBX(4.2995,",DA=Z K XMRTCPY D ^DIK Q
"RTN","XMRFTPUX",22,0)
 Q
"RTN","XMRFTPUX",23,0)
REN I $$NEWERR^%ZTER N $ETRAP,$ESTACK S $ETRAP=""
"RTN","XMRFTPUX",24,0)
 S X="DUPNAME^XMRTCP",@^%ZOSF("TRAP")
"RTN","XMRFTPUX",25,0)
 I ^%ZOSF("OS")["VAX" S X=$ZC(%SETPRN,$E(XMRTCP("NAME"),1,13))
"RTN","XMRFTPUX",26,0)
 D START^XMRTCPGO
"RTN","XMRFTPUX",27,0)
 Q
"RTN","XMRFTPUX",28,0)
FCHK(Z,Y,F) ;Is file in export directory ?
"RTN","XMRFTPUX",29,0)
 Q 0 ;****************
"RTN","XMRFTPUX",30,0)
 N %,%0,%1,%2,I,X,XMIO
"RTN","XMRFTPUX",31,0)
 S XMIO=$I,%=^XMBX(4.2995,Z,0),%0=$P(%,U,5),%2=$P(%,U,4)
"RTN","XMRFTPUX",32,0)
 I '%0 S $P(^XMBX(4.2995,Z,0),U,5)=Y,%=$$EXPORT^MAGAPI("MAIL",F,"WAIT") Q %
"RTN","XMRFTPUX",33,0)
 S %=$P(^MAG(2005,%2,0),U,2)
"RTN","XMRFTPUX",34,0)
CONT S %0="XMS"_$E(Z,$L(Z)-4,$L(Z))_".LIS"
"RTN","XMRFTPUX",35,0)
 I $$NEWERR^%ZTER N $ETRAP,$ESTACK S $ETRAP=""
"RTN","XMRFTPUX",36,0)
 S X="FPQ^XMRFTP",@^%ZOSF("TRAP"),X=$ZC(%SPAWN,"PURGE "_%0)
"RTN","XMRFTPUX",37,0)
FPQ I $$NEWERR^%ZTER N $ETRAP,$ESTACK S $ETRAP=""
"RTN","XMRFTPUX",38,0)
 S X="Q0^XMRFTP",@^%ZOSF("TRAP"),X=$ZC(%SPAWN,"DIR/OUTPUT="_%0_" NFA0:[EXPORT.MAIL]"_%)
"RTN","XMRFTPUX",39,0)
 O %0 U %0
"RTN","XMRFTPUX",40,0)
 I $$NEWERR^%ZTER N $ETRAP,$ESTACK S $ETRAP=""
"RTN","XMRFTPUX",41,0)
 S X="FCHKQ^XMRFTP",@^%ZOSF("TRAP")
"RTN","XMRFTPUX",42,0)
 F  R X:9 Q:X[%
"RTN","XMRFTPUX",43,0)
FCHKQ C %0 U XMIO
"RTN","XMRFTPUX",44,0)
 I X'[% Q 1
"RTN","XMRFTPUX",45,0)
 Q 0
"RTN","XMRFTPUX",46,0)
Q0 Q 1
"RTN","XMRFTPUX",47,0)
FER N X S X=$P($G(^XMBX(4.2995,Z,0)),U,2)
"RTN","XMRFTPUX",48,0)
 I 'X S X=$H*86400+$P($H,",",2),$P(^(0),U,2)=X
"RTN","XMRFTPUX",49,0)
 Q:$H*86400+$P($H,",",2)-%>99
"RTN","XMRFTPUX",50,0)
 N Z S XMDUZ=.5,XMSUB="ERROR moving File from Image Server"
"RTN","XMRFTPUX",51,0)
 S XMTEXT="A(",A(1)="The error was: "_%_"."
"RTN","XMRFTPUX",52,0)
 S A(2)="The COM file being processed was: "_Y,XMY(.5)=""
"RTN","XMRFTPUX",53,0)
 D ^XMD Q
"RTN","XMRFTPUX",54,0)
IMAGENT(Y,F) ;
"RTN","XMRFTPUX",55,0)
 N %,%0,XMIO,X
"RTN","XMRFTPUX",56,0)
 I ^%ZOSF("OS")["MSM" S X=$ZOS(12,NEWPATH,"") I $P(X,U)=F QUIT "5 -IMAGE ALREADY THERE"
"RTN","XMRFTPUX",57,0)
 S Z=$P($H,",",2)#1000,XMIO=$I,%=F
"RTN","XMRFTPUX",58,0)
 G CONT
"RTN","XMRINETD")
0^324^B448081
"RTN","XMRINETD",1,0)
XMRINETD ;(WASH ISC)/LH-Process MSM-NT TCP Request ;04/17/2002  11:21
"RTN","XMRINETD",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMRINETD",3,0)
GO O 56 U 56::"TCP" W /SOCKET("",25)
"RTN","XMRINETD",4,0)
 S X=^%ZOSF("VOL")
"RTN","XMRINETD",5,0)
CHK S CHECK=0 I $G(^%ZIS(14.5,"LOGON",X))=1 S CHECK=1 H 60
"RTN","XMRINETD",6,0)
 J GO^XMRINETD
"RTN","XMRINETD",7,0)
 I $G(CHECK) W "421 SMTP Service temporarily down.",$C(13,10),! C 56 Q
"RTN","XMRINETD",8,0)
 S %="MSM TCP "_$J G SOC25^XMRMSM
"RTN","XMRMSM")
0^325^B465912
"RTN","XMRMSM",1,0)
XMRMSM ;(WASH ISC)/CAP-MSM TCP/IP Front End ;04/30/2002  07:24
"RTN","XMRMSM",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMRMSM",3,0)
 Q
"RTN","XMRMSM",4,0)
 ;%=socket number
"RTN","XMRMSM",5,0)
SOC25 S XMRPORT=$G(%),IOT="TCP",(IO,IO(0))=56,DIQUIET=1
"RTN","XMRMSM",6,0)
 I $$NEWERR^%ZTER N $ETRAP,$ESTACK S $ETRAP="D TRP^XMCTRAP"
"RTN","XMRMSM",7,0)
 E  S X="TRP^XMCTRAP",@^%ZOSF("TRAP")
"RTN","XMRMSM",8,0)
 D DT^DICRW,DUZ^XUP(.5)
"RTN","XMRMSM",9,0)
 S ER=0
"RTN","XMRMSM",10,0)
 U IO
"RTN","XMRMSM",11,0)
 S XMCHAN="TCP/IP-MAILMAN",XMNO220=""
"RTN","XMRMSM",12,0)
 D ENT^XMR
"RTN","XMRMSM",13,0)
HALT ;Unlock all locks, disconnect the connection and quit
"RTN","XMRMSM",14,0)
 G ^XUSCLEAN
"RTN","XMRONT")
0^326^B718752
"RTN","XMRONT",1,0)
XMRONT ;(SF-ISC)/RWF - OpenM-NT TCP/IP INETD and Front End ;04/30/2002  07:24
"RTN","XMRONT",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMRONT",3,0)
 ; Entry points used by MailMan options (not covered by DBIA):
"RTN","XMRONT",4,0)
 ; GO   XMRONT
"RTN","XMRONT",5,0)
 ;This routine starts a listener for TCP mail Connects.
"RTN","XMRONT",6,0)
 ; It takes the place of the INETD Unix process
"RTN","XMRONT",7,0)
 ;
"RTN","XMRONT",8,0)
GO ;Open port 25 in Accept mode.
"RTN","XMRONT",9,0)
 S XMRSOCK=25
"RTN","XMRONT",10,0)
 D LISTEN^%ZISTCPS(XMRSOCK,"SOC25^XMRONT")
"RTN","XMRONT",11,0)
 ;HALT
"RTN","XMRONT",12,0)
 G HALT
"RTN","XMRONT",13,0)
 ;
"RTN","XMRONT",14,0)
SOC25 ;This entry point is started as a new process by %ZISTCPS.
"RTN","XMRONT",15,0)
 S (XMRPORT,IO,IO(0))=$IO,IOT="TCP"
"RTN","XMRONT",16,0)
 I $$NEWERR^%ZTER N $ETRAP,$ESTACK S $ETRAP="D TRP^XMCTRAP"
"RTN","XMRONT",17,0)
 E  S X="TRP^XMCTRAP",@^%ZOSF("TRAP")
"RTN","XMRONT",18,0)
 S DIQUIET=1 D DT^DICRW,DUZ^XUP(.5)
"RTN","XMRONT",19,0)
 S ER=0,XMCHAN="TCP/IP-MAILMAN",XMNO220=""
"RTN","XMRONT",20,0)
 U IO
"RTN","XMRONT",21,0)
 D ENT^XMR
"RTN","XMRONT",22,0)
HALT ;Unlock all locks, close the connection and quit
"RTN","XMRONT",23,0)
 ;L ;C IO  The close caused a problem under OpenM 52e, so it was removed
"RTN","XMRONT",24,0)
 G ^XUSCLEAN
"RTN","XMRONT",25,0)
 Q
"RTN","XMRPCTS")
0^327^B8341164
"RTN","XMRPCTS",1,0)
XMRPCTS ;(KC-VAMC)/XXX-Steal TWIX's from PCTS Host [RCVR] ;03/18/2002  09:10
"RTN","XMRPCTS",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMRPCTS",3,0)
 ; Entry points used by MailMan options (not covered by DBIA):
"RTN","XMRPCTS",4,0)
 ; PCTS     XMNET-TWIX-SEND
"RTN","XMRPCTS",5,0)
PCTS ;
"RTN","XMRPCTS",6,0)
 S %=$$DSP("==>STARTING PCTS DIALOGUE<=="),XMRPCTS("R")=0
"RTN","XMRPCTS",7,0)
 S XMCOUNT=0
"RTN","XMRPCTS",8,0)
ST I $$NEWERR^%ZTER N $ETRAP,$ESTACK S $ETRAP="D ERR^XMRPCTSA"
"RTN","XMRPCTS",9,0)
 E  S X="ERR^XMRPCTSA",@^%ZOSF("TRAP")
"RTN","XMRPCTS",10,0)
 D INIT^XMRPCTSA
"RTN","XMRPCTS",11,0)
 S %=$$DSP("==>Handshaking with PCTS - This make take a while<==")
"RTN","XMRPCTS",12,0)
 F I=1:1:3 R X:5 Q:$T
"RTN","XMRPCTS",13,0)
 I X["MREQ" R X:3 S XMMN=$P(X,XMLF,2) G:X[XMET!(XMMN'?1N.N) EXIT S %=$$DSP("==>MREQ") G MAK1
"RTN","XMRPCTS",14,0)
 I X["MAOK" S %=$$DSP("==>MAOK") D ^XMRPCTS0 G EXIT ; We can send stuff here
"RTN","XMRPCTS",15,0)
 I X["MEND"!(X[XMET) S %=$$DSP("==>MENDing<==") G EXIT
"RTN","XMRPCTS",16,0)
 ;S %=$$DSP("===>'"_X_"' Received / Not Understood !!!")
"RTN","XMRPCTS",17,0)
 S XMCOUNT=XMCOUNT+1 G ST:XMCOUNT<3,EXIT
"RTN","XMRPCTS",18,0)
 ;
"RTN","XMRPCTS",19,0)
MAK1 W "MAK1",XMCR,XMLF,XMMN,XMCR,XMLF,XMET,XMCR S %=$$DSP("<==MAK1/"_XMMN),%=0
"RTN","XMRPCTS",20,0)
 ;
"RTN","XMRPCTS",21,0)
 S XMCOUNT=0
"RTN","XMRPCTS",22,0)
MDTA F I=1:1:3 R X:5 Q:$T
"RTN","XMRPCTS",23,0)
 I X["MDTA" R X:3 S XMMN=$P(X,XMLF,2) G:X[XMET EXIT S %=$$DSP("==>MDTA,  AMS Message #"_XMMN),XMSUB="PCTS==> AMS Message Number: "_XMMN G SH
"RTN","XMRPCTS",24,0)
 I X["MEND"!(X[XMET) S %=$$DSP("==>MENDing<==") G EXIT
"RTN","XMRPCTS",25,0)
 ;S %=$$DSP("===>'"_X_"' Received & Not Understood !!!")
"RTN","XMRPCTS",26,0)
 S XMCOUNT=XMCOUNT+1 G MDTA:XMCOUNT<3,EXIT
"RTN","XMRPCTS",27,0)
 ;
"RTN","XMRPCTS",28,0)
SH R X:5 G:'$T EXIT S XMHDR=$P(X,XMSH,2) S %=$$DSP("==>"_XMHDR),^TMP($J,1,0)=XMHDR,XMLPC=$$CSUM($C(XMLPC)_XMHDR_XMCR)
"RTN","XMRPCTS",29,0)
TT S X1="" F I=2:1 R X:5 Q:'$T  D
"RTN","XMRPCTS",30,0)
 .I X1["NNNN"&(($A($E(X,1)=10))&($A($E(X,2)=25))) R X2:5 Q
"RTN","XMRPCTS",31,0)
 .S XMLPC=$$CSUM($C(XMLPC)_X_XMCR),X=$$STRLF(X),X1=X
"RTN","XMRPCTS",32,0)
 .S ^TMP($J,I,0)=X,%=$$DSP("==>"_X)
"RTN","XMRPCTS",33,0)
 I X1["NNNN" S ^TMP($J,I,0)="------  End of PCTS Message  ------",%=$$DSP("==>NNNN Received") D CHKSUM(X) D XM^XMRPCTSA,REPLY^XMRPCTSA K X1 G ST
"RTN","XMRPCTS",34,0)
 I X1'["NNNN" S %=$$DSP("==>No 'NNNN', End of Message Found") K X1 G EXIT
"RTN","XMRPCTS",35,0)
CHKSUM(X) ;Verify the Checksum, We MUST agree.
"RTN","XMRPCTS",36,0)
 S XMLPC=$$CSUM($C(XMLPC)_XMLF) ;Add in that last LineFeed
"RTN","XMRPCTS",37,0)
 S XMLPC=$E(XMDH,XMLPC\16+1)_$E(XMDH,XMLPC#16+1) ;The Magic Code
"RTN","XMRPCTS",38,0)
 ;U IO R X:5 S X=$P(X,$C(25),2) ;Em is 25
"RTN","XMRPCTS",39,0)
 ;S XMLPC=$S(X=XMLPC:1,1:0) ;Do the checksums match ?
"RTN","XMRPCTS",40,0)
 ;Hardwire checksum evaluation to be true
"RTN","XMRPCTS",41,0)
 S XMLPC=1
"RTN","XMRPCTS",42,0)
 S %=$$DSP("==>CHECKSUM "_$S(XMLPC:"OK",1:"FAILED")_"<==")
"RTN","XMRPCTS",43,0)
 Q
"RTN","XMRPCTS",44,0)
DSP(XMTRAN) D TRAN^XMC1
"RTN","XMRPCTS",45,0)
 Q "" ;Show us what is going on
"RTN","XMRPCTS",46,0)
 ;
"RTN","XMRPCTS",47,0)
EXIT X ^%ZOSF("TRMOFF")
"RTN","XMRPCTS",48,0)
 K XMCR,XMLF,XMET,XMSH,XMLPC,XMLMN,XMMN,XMDH
"RTN","XMRPCTS",49,0)
 S %=$$DSP("==>ENDING PCTS DIALOGUE & RETURNING TO MAILMAN SCRIPT<==")
"RTN","XMRPCTS",50,0)
 F %="R","S" S XMCNT(%)=$S($G(XMRPCTS(%)):XMRPCTS(%),1:0)
"RTN","XMRPCTS",51,0)
 Q
"RTN","XMRPCTS",52,0)
 ;
"RTN","XMRPCTS",53,0)
STRLF(X) ;Remove leading LineFeed(s) from String
"RTN","XMRPCTS",54,0)
 N I F I=1:1:$L(X) Q:X'[$C(10)  I $A(X)=10 S X=$E(X,2,$L(X))
"RTN","XMRPCTS",55,0)
 Q (X)
"RTN","XMRPCTS",56,0)
CSUM(X) ;Calculate Checksum
"RTN","XMRPCTS",57,0)
 N Y X ^%ZOSF("LPC") Q Y
"RTN","XMRPCTS0")
0^58^B13546596
"RTN","XMRPCTS0",1,0)
XMRPCTS0 ;(KC-VAMC)/XXX-Send TWIX's to PCTS Host [XMTR] ;03/21/2002  07:49
"RTN","XMRPCTS0",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMRPCTS0",3,0)
 ; Entry points used by MailMan options (not covered by DBIA):
"RTN","XMRPCTS0",4,0)
 ; RQ       XMNET-TWIX-TRANSMIT
"RTN","XMRPCTS0",5,0)
 ;+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
"RTN","XMRPCTS0",6,0)
 ; Walk through this Domains Transmit Basket and send them.
"RTN","XMRPCTS0",7,0)
 ; If there is an error, record the error message, copy of
"RTN","XMRPCTS0",8,0)
 ; the message, and drop to PCTS Mailgroup.
"RTN","XMRPCTS0",9,0)
 ;-------------------------------------------------------------
"RTN","XMRPCTS0",10,0)
 D DSP^XMRPCTS("==>Checking for PCTS Messages to Transmit<==")
"RTN","XMRPCTS0",11,0)
 ;Get domain # for the PCTS domain
"RTN","XMRPCTS0",12,0)
 S XMINST=$O(^DIC(4.2,"B","VHA.DMIA",0))
"RTN","XMRPCTS0",13,0)
 S XMK=XMINST+1000,XMDUZ=.5,XMZ=0,U="^" D INIT^XMRPCTSA S XMRPCTS("S")=0
"RTN","XMRPCTS0",14,0)
WALK D DSP("==>Checking for messages in basket # "_XMK_"<==")
"RTN","XMRPCTS0",15,0)
 S XMZ=$O(^XMB(3.7,.5,2,XMK,1,XMZ)) G EXIT:XMZ<1
"RTN","XMRPCTS0",16,0)
 I '$D(^XMB(3.9,XMZ,0)) D ZAPIT^XMXMSGS2(.5,XMK,XMZ) G WALK ;Message is Gone?
"RTN","XMRPCTS0",17,0)
 D DSP("<==MREQ for local "_XMZ) W "MREQ",!,XMZ,!,"PCTS",!,"AMS",!,"TAB",!,XMET,XMCR S %=0
"RTN","XMRPCTS0",18,0)
 ;
"RTN","XMRPCTS0",19,0)
MREQ F I=1:1:3 R X:5 Q:$T
"RTN","XMRPCTS0",20,0)
 I X["MAK1" R X:3 S XMMN=$P(X,XMLF,2) G:X[XMET!(XMMN'=XMZ) EXIT G REM
"RTN","XMRPCTS0",21,0)
 I X["MEND"!(X[XMET) D DSP("==>MENDing<==") G EXIT
"RTN","XMRPCTS0",22,0)
 S %=%+1 G MREQ:%<3,EXIT
"RTN","XMRPCTS0",23,0)
REM R X:3 S XMMN=$P(X,XMLF,2) G:X[XMET!(XMMN'?1N.N) EXIT
"RTN","XMRPCTS0",24,0)
 D DSP("==>MAK1 for REMOTE "_XMMN)
"RTN","XMRPCTS0",25,0)
MDTA ;
"RTN","XMRPCTS0",26,0)
 D DSP("<==MDTA, Now Sending Message #"_XMZ)
"RTN","XMRPCTS0",27,0)
 S ^XMBS(4.2999,XMINST,3)=$H_"^"_XMZ_"^^^^DMI/MM-SSP" ; mailman status
"RTN","XMRPCTS0",28,0)
 W "MDTA",!,XMZ,!,XMMN,!,XMSH S XMLPC=0 ;Here we go!
"RTN","XMRPCTS0",29,0)
 F X=0:0 S X=$O(^XMB(3.9,XMZ,2,X)) Q:X<1  I $D(^(X,0)) S Z=^(0) D  Q:$E(Z,1,6)["NNNN"
"RTN","XMRPCTS0",30,0)
 . N X,Y S X=$C(XMLPC)_Z_XMCR_XMLF X ^%ZOSF("LPC") S XMLPC=Y W Z,!
"RTN","XMRPCTS0",31,0)
 ;S X=$C(XMLPC)_XMLF) X ^%ZOSF("LPC") S XMLPC=Y ;We like that extra lf calculated
"RTN","XMRPCTS0",32,0)
 S XMLPC=$E(XMDH,XMLPC\16+1)_$E(XMDH,XMLPC#16+1) ;The Magic Code
"RTN","XMRPCTS0",33,0)
 W $C(25),XMLPC,XMET,XMCR S %=1 ;Write the checksum
"RTN","XMRPCTS0",34,0)
MAK2 F I=1:1:3 R X:5 Q:$T  ;Look for the status of the one we just sent
"RTN","XMRPCTS0",35,0)
 I X["MAK2" S XMSTAT="Sent-> AMS Msg# "_XMMN R X:3 R X:3 D STAT S XMRPCTS("S")=XMRPCTS("S")+1 G WALK
"RTN","XMRPCTS0",36,0)
 I $E(X["MN") R X:3 R X:3 S XMSTAT="Error: "_$P(X,XMLF,2) D STAT,ERR G WALK
"RTN","XMRPCTS0",37,0)
 S %=%+1 G MAK2:%<3
"RTN","XMRPCTS0",38,0)
 ;
"RTN","XMRPCTS0",39,0)
 D DSP("==>INVALID RESPONSE from RCVR, Expecting MAK2, Closing up")
"RTN","XMRPCTS0",40,0)
 G EXIT
"RTN","XMRPCTS0",41,0)
 ;
"RTN","XMRPCTS0",42,0)
 Q
"RTN","XMRPCTS0",43,0)
JD() ; Returns today's Julian date
"RTN","XMRPCTS0",44,0)
 N XMDDD,XMHHMM,XMNOW,XMDT
"RTN","XMRPCTS0",45,0)
 S XMNOW=$$NOW^XLFDT
"RTN","XMRPCTS0",46,0)
 S XMDT=$E(XMNOW,1,7)
"RTN","XMRPCTS0",47,0)
 S XMDDD=$$RJ^XLFSTR($$FMDIFF^XLFDT(XMDT,$E(XMDT,1,3)_"0101",1)+1,3,"0")
"RTN","XMRPCTS0",48,0)
 S XMHHMM=$$LJ^XLFSTR($E(XMNOW,9,12),4,"0")
"RTN","XMRPCTS0",49,0)
 Q XMDDD_XMHHMM
"RTN","XMRPCTS0",50,0)
 ;
"RTN","XMRPCTS0",51,0)
DSP(XMTRAN) ;
"RTN","XMRPCTS0",52,0)
 D TRAN^XMC1
"RTN","XMRPCTS0",53,0)
 S %="" ;Show us what is going on
"RTN","XMRPCTS0",54,0)
 Q
"RTN","XMRPCTS0",55,0)
 ;
"RTN","XMRPCTS0",56,0)
STAT ;Update the Mailman Status
"RTN","XMRPCTS0",57,0)
 S X=$O(^XMB(3.9,XMZ,1,"C","XXX@"_$P(^DIC(4.2,+XMINST,0),U),0))
"RTN","XMRPCTS0",58,0)
 I X>0 S $P(^XMB(3.9,XMZ,1,X,0),U,5,6)=$$DT_U_XMSTAT
"RTN","XMRPCTS0",59,0)
 S ^XMBS(4.2999,XMINST,3)="" ;Mailman Status
"RTN","XMRPCTS0",60,0)
 D ZAPIT^XMXMSGS2(.5,XMK,XMZ) ;Remove it from the Domains Basket
"RTN","XMRPCTS0",61,0)
 Q
"RTN","XMRPCTS0",62,0)
ERR N %,X,XMSUB,XMTEXT,XMY,Y
"RTN","XMRPCTS0",63,0)
 D DSP("==>Recording Rejected Message #"_XMZ_"  "_XMSTAT)
"RTN","XMRPCTS0",64,0)
 S XMTEXT="^XMB(3.9,"_XMZ_",2,"
"RTN","XMRPCTS0",65,0)
 N XMZ,DIC,XMDF
"RTN","XMRPCTS0",66,0)
 S XMSUB="PCTS Message Returned "_XMSTAT,XMDF=1
"RTN","XMRPCTS0",67,0)
 S XMY("G.PCTS")="" ; Mail group PCTS must be created on the system
"RTN","XMRPCTS0",68,0)
 S XMY(.5)=""
"RTN","XMRPCTS0",69,0)
 D ^XMD
"RTN","XMRPCTS0",70,0)
 Q  ;Send it to the PostMaster anyway
"RTN","XMRPCTS0",71,0)
 ;
"RTN","XMRPCTS0",72,0)
DT() N X,Y,%DT S %DT="T",X="N" D ^%DT Q (Y)
"RTN","XMRPCTS0",73,0)
EXIT D DSP("==>Quitting<==")
"RTN","XMRPCTS0",74,0)
 W "MEND",!
"RTN","XMRPCTS0",75,0)
 Q
"RTN","XMRPCTS0",76,0)
RQ ;Force this domain to play its script, it plays regardless...
"RTN","XMRPCTS0",77,0)
 ;Queue this puppy to run at regular intervals.
"RTN","XMRPCTS0",78,0)
 N XMDUZ,XMSITE,XMINST,XMB,%
"RTN","XMRPCTS0",79,0)
 S XMDUZ=.5
"RTN","XMRPCTS0",80,0)
 S XMSITE="VHA.DMIA"
"RTN","XMRPCTS0",81,0)
 S XMINST=$O(^DIC(4.2,"B",XMSITE,0))
"RTN","XMRPCTS0",82,0)
 I $D(ZTQUEUED) D  I $$OBE^XMTDR(XMINST) G QQ
"RTN","XMRPCTS0",83,0)
 . S ZTREQ="@"
"RTN","XMRPCTS0",84,0)
 E  I $$TSKEXIST^XMKPR(XMINST) G QQ
"RTN","XMRPCTS0",85,0)
 D SCRIPT^XMKPR1(XMINST,XMSITE,.XMB)
"RTN","XMRPCTS0",86,0)
 I 'XMB("SCR IEN") G QQ
"RTN","XMRPCTS0",87,0)
 D PLAY^XMTDR(XMINST,XMSITE,.XMB)
"RTN","XMRPCTS0",88,0)
QQ ;
"RTN","XMRPCTS0",89,0)
 D DSP("Quitting from sending TWIX's")
"RTN","XMRPCTS0",90,0)
 ;D KL1^XMC
"RTN","XMRPCTS0",91,0)
 L
"RTN","XMRPCTS0",92,0)
 K DIC,X,Y,XMDT,ZTPAR
"RTN","XMRPCTS0",93,0)
 Q:'$G(XMRPCTS0)
"RTN","XMRPCTS0",94,0)
 S XMCI=XMRPCTS0
"RTN","XMRPCTS0",95,0)
 Q
"RTN","XMRPCTS1")
0^328^B21126453
"RTN","XMRPCTS1",1,0)
XMRPCTS1 ;(KC-VAMC)/XXX-Simple PCTS front end to MailMan ;02/06/99  10:32
"RTN","XMRPCTS1",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMRPCTS1",3,0)
 N XMUS,XMFM,XMSTR,XMRI,XMTO,XMABORT
"RTN","XMRPCTS1",4,0)
 ;+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
"RTN","XMRPCTS1",5,0)
 ;All should be sent to XXX@VHA.DMIA the local PCTS Domain
"RTN","XMRPCTS1",6,0)
 ;Edit these for your site.
"RTN","XMRPCTS1",7,0)
 S XMUS="XXXX" ;Local routing indicator
"RTN","XMRPCTS1",8,0)
 S XMFM="YYYY" ;from line
"RTN","XMRPCTS1",9,0)
 I XMUS="XXXX"!(XMFM="YYYY") S %="FIX Routing codes !!!"_XMPCTS0("ERR")
"RTN","XMRPCTS1",10,0)
 ;-------------------------------------------------------------
"RTN","XMRPCTS1",11,0)
 S XMABORT=0
"RTN","XMRPCTS1",12,0)
 D INIT(.XMDUZ,XMUS,.XMSTR,.XMRI,.XMTO,.XMABORT) Q:XMABORT
"RTN","XMRPCTS1",13,0)
 D CRE8XMZ^XMXSEND("Local PCTS Transmission.",.XMZ,1) I XMZ<1 S XMABORT=1 Q
"RTN","XMRPCTS1",14,0)
 D EDITON^XMJMS(XMDUZ,XMZ)
"RTN","XMRPCTS1",15,0)
 D PROCESS(XMDUZ,XMSTR,XMFM,XMRI,XMTO,.XMZ,.XMABORT)
"RTN","XMRPCTS1",16,0)
 D EDITOFF^XMJMS(XMDUZ)
"RTN","XMRPCTS1",17,0)
 Q:'XMABORT
"RTN","XMRPCTS1",18,0)
 W !!,"TWIX Send aborted !",$C(7)
"RTN","XMRPCTS1",19,0)
 H 2
"RTN","XMRPCTS1",20,0)
 D KILLMSG^XMXUTIL(XMZ)
"RTN","XMRPCTS1",21,0)
 Q
"RTN","XMRPCTS1",22,0)
INIT(XMDUZ,XMUS,XMSTR,XMRI,XMTO,XMABORT) ;
"RTN","XMRPCTS1",23,0)
 N XMSEQ
"RTN","XMRPCTS1",24,0)
 I '$D(DUZ)#2 D  Q
"RTN","XMRPCTS1",25,0)
 . W !!,"DUZ not defined..."
"RTN","XMRPCTS1",26,0)
 . S XMABORT=1
"RTN","XMRPCTS1",27,0)
 D EN^XM
"RTN","XMRPCTS1",28,0)
 W !!,"Create PCTS/AMS message.",!
"RTN","XMRPCTS1",29,0)
 ;Making this the pseudo-sequence number - meaningless.
"RTN","XMRPCTS1",30,0)
 S XMSEQ=$P(^XMB(3.9,0),U,3),XMSEQ=$$RJ^XLFSTR($E(XMSEQ,$L(XMSEQ)-3,99),4,"0")
"RTN","XMRPCTS1",31,0)
 ;Build the Header
"RTN","XMRPCTS1",32,0)
 S XMSTR="PAAUIJAZ "_XMUS_XMSEQ_" "_$$JD^XMRPCTS0_"-UUUU--"
"RTN","XMRPCTS1",33,0)
 D RI(.XMRI,.XMABORT) Q:XMABORT
"RTN","XMRPCTS1",34,0)
 D TO(.XMTO,.XMABORT)
"RTN","XMRPCTS1",35,0)
 Q
"RTN","XMRPCTS1",36,0)
RI(XMRI,XMABORT) ;
"RTN","XMRPCTS1",37,0)
 N DIR,DIRUT,Y,X,DTOUT,DUOUT
"RTN","XMRPCTS1",38,0)
 S DIR(0)="FO^3:30^K X'?1UP.UP X"
"RTN","XMRPCTS1",39,0)
 S DIR("A")="Destination RI"
"RTN","XMRPCTS1",40,0)
 S DIR("?")="Enter the Destination Routing Indicator, like RUCHJBO."
"RTN","XMRPCTS1",41,0)
 D ^DIR I $D(DTOUT)!$D(DUOUT) S XMABORT=1 Q
"RTN","XMRPCTS1",42,0)
 I Y="" S Y="<RI>" W "<blank>"
"RTN","XMRPCTS1",43,0)
 S XMRI=Y
"RTN","XMRPCTS1",44,0)
 S:$E(XMRI,$L(XMRI))'="." XMRI=XMRI_"."
"RTN","XMRPCTS1",45,0)
 Q
"RTN","XMRPCTS1",46,0)
TO(XMTO,XMABORT) ;
"RTN","XMRPCTS1",47,0)
 N DIR,DIRUT,Y,X,DTOUT,DUOUT
"RTN","XMRPCTS1",48,0)
 S DIR(0)="F^3:60"
"RTN","XMRPCTS1",49,0)
 S DIR("A")="Destination TO line"
"RTN","XMRPCTS1",50,0)
 S DIR("?")="Enter the content of the TO line of the message."
"RTN","XMRPCTS1",51,0)
 D ^DIR I $D(DTOUT)!$D(DUOUT) S XMABORT=1 Q
"RTN","XMRPCTS1",52,0)
 S XMTO=Y
"RTN","XMRPCTS1",53,0)
 Q
"RTN","XMRPCTS1",54,0)
PROCESS(XMDUZ,XMSTR,XMFM,XMRI,XMTO,XMZ,XMABORT) ;
"RTN","XMRPCTS1",55,0)
 N I,%,XMTEXT,XMINSTR,XMRESTR
"RTN","XMRPCTS1",56,0)
 S %="ZNR UUUUU"
"RTN","XMRPCTS1",57,0)
 F I="RUCH","RUEV","RUWL","RUGS" I XMRI[I S %="VADM"
"RTN","XMRPCTS1",58,0)
 S I=0
"RTN","XMRPCTS1",59,0)
 S I=I+1,XMTEXT(I)=XMSTR_XMRI ;header line
"RTN","XMRPCTS1",60,0)
 S I=I+1,XMTEXT(I)=%
"RTN","XMRPCTS1",61,0)
 S I=I+1,XMTEXT(I)="FM "_XMFM ;from line
"RTN","XMRPCTS1",62,0)
 S I=I+1,XMTEXT(I)="TO "_XMTO ;to line
"RTN","XMRPCTS1",63,0)
 S I=I+1,XMTEXT(I)="BT"
"RTN","XMRPCTS1",64,0)
 S I=I+1,XMTEXT(I)=""
"RTN","XMRPCTS1",65,0)
 S I=I+1,XMTEXT(I)="<text>"
"RTN","XMRPCTS1",66,0)
 S I=I+1,XMTEXT(I)=""
"RTN","XMRPCTS1",67,0)
 S I=I+1,XMTEXT(I)="BT"
"RTN","XMRPCTS1",68,0)
 S I=I+1,XMTEXT(I)=""
"RTN","XMRPCTS1",69,0)
 S I=I+1,XMTEXT(I)="NNNN"
"RTN","XMRPCTS1",70,0)
 D MOVEBODY^XMXSEND(XMZ,"XMTEXT")
"RTN","XMRPCTS1",71,0)
 D E Q:XMABORT
"RTN","XMRPCTS1",72,0)
 D INIT^XMXADDR
"RTN","XMRPCTS1",73,0)
 D READY(XMDUZ,.XMINSTR,.XMRESTR,.XMABORT) Q:XMABORT
"RTN","XMRPCTS1",74,0)
 W !,"You may add recipients to this message."
"RTN","XMRPCTS1",75,0)
 D TOWHOM^XMJMT(XMDUZ,"Send",.XMINSTR,.XMRESTR,.XMABORT)
"RTN","XMRPCTS1",76,0)
 D:'XMABORT XMIT(XMDUZ,XMZ,.XMINSTR,.XMABORT)
"RTN","XMRPCTS1",77,0)
 D CLEANUP^XMXADDR
"RTN","XMRPCTS1",78,0)
 Q
"RTN","XMRPCTS1",79,0)
XMIT(XMDUZ,XMZ,XMINSTR,XMABORT) ;
"RTN","XMRPCTS1",80,0)
 N DIR,Y,X,DIRUT,XMFINISH
"RTN","XMRPCTS1",81,0)
 S XMFINISH=0
"RTN","XMRPCTS1",82,0)
 F  D  Q:XMFINISH!XMABORT
"RTN","XMRPCTS1",83,0)
 . S DIR(0)="SAM^E:Edit Text;T:Transmit now"
"RTN","XMRPCTS1",84,0)
 . S DIR("A")="Select Message option:  "
"RTN","XMRPCTS1",85,0)
 . S DIR("B")="Transmit now"
"RTN","XMRPCTS1",86,0)
 . S DIR("??")="^D Q^XMRPCTS1"
"RTN","XMRPCTS1",87,0)
 . D ^DIR I $D(DIRUT) S XMABORT=1 Q
"RTN","XMRPCTS1",88,0)
 . D @Y
"RTN","XMRPCTS1",89,0)
 Q
"RTN","XMRPCTS1",90,0)
E ; Edit Text
"RTN","XMRPCTS1",91,0)
 F  D BODY^XMJMS(XMDUZ,XMZ,.XMRESTR,.XMABORT) Q:XMABORT!$$NCHECK(XMZ)
"RTN","XMRPCTS1",92,0)
 Q
"RTN","XMRPCTS1",93,0)
NCHECK(XMZ) ; If "NNNN" found in text, issue error
"RTN","XMRPCTS1",94,0)
 N NCNT,I
"RTN","XMRPCTS1",95,0)
 S (NCNT,I)=0
"RTN","XMRPCTS1",96,0)
 F  S I=$O(^XMB(3.9,XMZ,2,I)) Q:'I  I ^XMB(3.9,XMZ,2,I,0)["NNNN" S NCNT=NCNT+1
"RTN","XMRPCTS1",97,0)
 Q:NCNT'>1 1
"RTN","XMRPCTS1",98,0)
 W !!,"<< 4 CONSECUTIVE N's ARE NOT ALLOWED IN THE MSG TEXT !!! >>",!!,$C(7)
"RTN","XMRPCTS1",99,0)
 H 5
"RTN","XMRPCTS1",100,0)
 Q 0
"RTN","XMRPCTS1",101,0)
T ; Transmit
"RTN","XMRPCTS1",102,0)
 S XMFINISH=1
"RTN","XMRPCTS1",103,0)
 D BLDNSND^XMXSEND(XMDUZ,XMZ,.XMINSTR)
"RTN","XMRPCTS1",104,0)
 Q
"RTN","XMRPCTS1",105,0)
Q W !,"Answer: ",!
"RTN","XMRPCTS1",106,0)
 W !,"T  (or just return) to PERMANENTLY transmit the message."
"RTN","XMRPCTS1",107,0)
 W !,"E                   to Edit the text of the message."
"RTN","XMRPCTS1",108,0)
 W !,"'^'  to cancel the message."
"RTN","XMRPCTS1",109,0)
 Q
"RTN","XMRPCTS1",110,0)
READY(XMDUZ,XMINSTR,XMRESTR,XMABORT) ;
"RTN","XMRPCTS1",111,0)
 N DIR,DIRUT,Y
"RTN","XMRPCTS1",112,0)
 S DIR(0)="Y"
"RTN","XMRPCTS1",113,0)
 S DIR("A")="Ready to send to the Austin AMS System"
"RTN","XMRPCTS1",114,0)
 S DIR("?",1)="'YES' will place the message in the queue for transmission through the AMS System."
"RTN","XMRPCTS1",115,0)
 S DIR("?")="'NO' will place the message only in your IN basket."
"RTN","XMRPCTS1",116,0)
 D ^DIR I $D(DIRUT) S XMABORT=1 Q
"RTN","XMRPCTS1",117,0)
 Q:'Y
"RTN","XMRPCTS1",118,0)
 W !,"Send to:  XXX@VHA.DMIA"
"RTN","XMRPCTS1",119,0)
 D ADDR^XMXADDR(XMDUZ,"XXX@VHA.DMIA",.XMINSTR,.XMRESTR)
"RTN","XMRPCTS1",120,0)
 Q
"RTN","XMRPCTS1",121,0)
EXIT ;
"RTN","XMRPCTS1",122,0)
 K I,XMTO,XMFM,XMSTR,XMUS,XMTM,XMRI,DIC,XCNP,XMXUSEC,ZTPAR,XMSEQ,XMOUT,DTOUT
"RTN","XMRPCTS1",123,0)
 K ^TMP("XMY",$J),^TMP("XMY0",$J)
"RTN","XMRPCTS1",124,0)
 Q
"RTN","XMRPCTSA")
0^329^B7279851
"RTN","XMRPCTSA",1,0)
XMRPCTSA ;(KC-VAMC)/XXX-Steal TWIX's from PCTS Host [RCVR] ;04/08/98  10:39
"RTN","XMRPCTSA",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMRPCTSA",3,0)
 ; Create a Mailgroup called PCTS, all messages will be sent to its
"RTN","XMRPCTSA",4,0)
 ; membership.  This can be called from a mailman script, it should
"RTN","XMRPCTSA",5,0)
 ; look something like this:
"RTN","XMRPCTSA",6,0)
 ; 
"RTN","XMRPCTSA",7,0)
 ; O H=VHA.DMIA,P=SCP     <---- Domain name and protocol are meaningless
"RTN","XMRPCTSA",8,0)
 ; C MINI
"RTN","XMRPCTSA",9,0)
 ; L ogin:
"RTN","XMRPCTSA",10,0)
 ; S pcts
"RTN","XMRPCTSA",11,0)
 ; L CODE:
"RTN","XMRPCTSA",12,0)
 ; X W "PCTS RUCHxxx",!    <---- This is your local routing indicator
"RTN","XMRPCTSA",13,0)
 ; X S XMRPCTS0=XMCI+1
"RTN","XMRPCTSA",14,0)
 ; X D ^XMRPCTS              <---- Call this routine
"RTN","XMRPCTSA",15,0)
 ; X K XMRPCTS0
"RTN","XMRPCTSA",16,0)
 ;-----------------
"RTN","XMRPCTSA",17,0)
 ; Mailman Host: VHA.DMIA, Physical Link: MINIOUT
"RTN","XMRPCTSA",18,0)
 ;-------------------------------------------------------------
"RTN","XMRPCTSA",19,0)
XM N %,DIC,X,XMDF,XMTEXT,XXX,XMY,XMZ,Y
"RTN","XMRPCTSA",20,0)
 S %=$$DSP("<==Locally Mailing AMS Message"),XMRPCTS("R")=XMRPCTS("R")+1
"RTN","XMRPCTSA",21,0)
 N XM,XMCHAN,ZTSK,ZTQUEUED S ZTSK=1,ZTQUEUED=1,XMCHAN=1
"RTN","XMRPCTSA",22,0)
 S XMDF=1,U="^",XMTEXT="^TMP($J,",XMDUZ=.5
"RTN","XMRPCTSA",23,0)
 S XMY("G.PCTS")="",XMY(XMDUZ)="",XXX=XMSUB D ^XMD S XMLMN=XMZ
"RTN","XMRPCTSA",24,0)
 ;--Make it look like a network message so we can track some info
"RTN","XMRPCTSA",25,0)
 S ^XMB(3.9,XMZ,2,.001,0)="Received: from PCTS/AMS by "_^XMB("NETNAME")_" via DMI/MM translation with SSP."
"RTN","XMRPCTSA",26,0)
 S ^XMB(3.9,XMZ,2,.002,0)="Subject: "_XXX
"RTN","XMRPCTSA",27,0)
 S ^XMB(3.9,XMZ,2,.003,0)="Date: "_$$INDT^XMXUTIL1($$NOW^XLFDT())
"RTN","XMRPCTSA",28,0)
 S ^XMB(3.9,XMZ,2,.004,0)="Message-ID:<"_$P(XMMN," ")_"@AMS>"
"RTN","XMRPCTSA",29,0)
 S ^XMB(3.9,XMZ,2,.005,0)="From: The Austin AMS System"
"RTN","XMRPCTSA",30,0)
 S ^XMB(3.9,XMZ,2,.006,0)="To: G.PCTS"
"RTN","XMRPCTSA",31,0)
 S ^XMB(3.9,XMZ,2,.007,0)="X-Another service provided by DHCP"
"RTN","XMRPCTSA",32,0)
 S ^XMB(3.9,XMZ,2,.008,0)=""
"RTN","XMRPCTSA",33,0)
 Q
"RTN","XMRPCTSA",34,0)
REPLY ;Let AMS know we have the message OK and what our local msg number is
"RTN","XMRPCTSA",35,0)
 S %=$$DSP("<==MAK2, Message #"_XMLMN_" Removed from AMS Queue")
"RTN","XMRPCTSA",36,0)
 U IO W "MAK2",!,XMMN,!,"#"_XMLMN,!,XMET,XMCR Q
"RTN","XMRPCTSA",37,0)
 ;
"RTN","XMRPCTSA",38,0)
INIT ;called from XMRPCTS & XMRPCTS0
"RTN","XMRPCTSA",39,0)
 S %=$$DSP("==>Initializing<==")
"RTN","XMRPCTSA",40,0)
 I '$G(XMCI) S XMCI=$S($G(XMRPCTS0):XMRPCTS0,1:999999) I XMCI>999 S ER=1,Y="Lost the counter to the script processor (XMCI)."
"RTN","XMRPCTSA",41,0)
 S %=0,XMCR=$C(13),XMLF=$C(10),XMET=$C(4),XMSH=$C(1)
"RTN","XMRPCTSA",42,0)
 D TERMON
"RTN","XMRPCTSA",43,0)
 K ^TMP($J) ;Scratch Space
"RTN","XMRPCTSA",44,0)
 S XMLPC=0 ;Longitudinal Parity Check for SSP
"RTN","XMRPCTSA",45,0)
 S XMDH="0123456789ABCDEF" ; for LPC calculations
"RTN","XMRPCTSA",46,0)
 Q
"RTN","XMRPCTSA",47,0)
 ;
"RTN","XMRPCTSA",48,0)
TERMON ;Need to change read terminators
"RTN","XMRPCTSA",49,0)
 I ^%ZOSF("OS")["DSM" U IO:TERM=$C(3,4,13,27) Q
"RTN","XMRPCTSA",50,0)
 I ^%ZOSF("OS")["MSM" U IO:(::::::::$C(3,4,13,27)) Q
"RTN","XMRPCTSA",51,0)
 I ^%ZOSF("OS")["OpenM-NT" U $I:("":"+I-T":$C(3,4,13,27)) Q
"RTN","XMRPCTSA",52,0)
 W XMRPCTS("ERROR"),"Terminators not defined for this operating system",!
"RTN","XMRPCTSA",53,0)
 Q
"RTN","XMRPCTSA",54,0)
 ;
"RTN","XMRPCTSA",55,0)
DSP(XMTRAN) D TRAN^XMC1
"RTN","XMRPCTSA",56,0)
 Q ""
"RTN","XMRPCTSA",57,0)
 ;
"RTN","XMRPCTSA",58,0)
ERR D ^%ZTER S %=$$DSP("ERROR captured in error trap !!!")
"RTN","XMRPCTSA",59,0)
 G UNWIND^%ZTER
"RTN","XMRPOP")
0^330^B58705120
"RTN","XMRPOP",1,0)
XMRPOP ;ISC-SF/GMB-POP3 Server (RFC 1939) ;05/20/2002  07:05
"RTN","XMRPOP",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMRPOP",3,0)
 ; Replaces the class III routines ^XMRPOPA, ^XMRPOPB, ^XMRPOPC,
"RTN","XMRPOP",4,0)
 ; which were written by Chiao-Ming Wu, WASH-ISC.
"RTN","XMRPOP",5,0)
 ;
"RTN","XMRPOP",6,0)
 ; Implements RFC 1939 (replaces RFC 1725)
"RTN","XMRPOP",7,0)
 ; Post Office Protocol - Version 3 (POP3) maildrop service
"RTN","XMRPOP",8,0)
 ;
"RTN","XMRPOP",9,0)
 ; Rather than locking the user's IN basket, which severely disrupts
"RTN","XMRPOP",10,0)
 ; mail delivery, we take a snapshot of it, and keep the snapshot in
"RTN","XMRPOP",11,0)
 ; a temp global.  We then use the temp global during the session.
"RTN","XMRPOP",12,0)
 ; Here is the layout of the global:
"RTN","XMRPOP",13,0)
 ;
"RTN","XMRPOP",14,0)
 ; ^TMP("XM",$J,"POP3")=# msgs^# octets   ; total msgs in IN basket
"RTN","XMRPOP",15,0)
 ;                                        ; (updated if msgs are deleted)
"RTN","XMRPOP",16,0)
 ; ^TMP("XM",$J,"POP3",1)=XMZ^# octets    ; msgs 1 thru n are in
"RTN","XMRPOP",17,0)
 ;         ...                            ; IN basket.
"RTN","XMRPOP",18,0)
 ; ^TMP("XM",$J,"POP3",i)=XMZ^# octets    ; 
"RTN","XMRPOP",19,0)
 ; ^TMP("XM",$J,"POP3",j)=XMZ^# octets    ; 
"RTN","XMRPOP",20,0)
 ;         ...                            ; 
"RTN","XMRPOP",21,0)
 ; ^TMP("XM",$J,"POP3",n)=XMZ^# octets    ; 
"RTN","XMRPOP",22,0)
 ;                                        ;
"RTN","XMRPOP",23,0)
 ; ^TMP("XM",$J,"POP3","D",i)=XMZ         ; user deleted msg i
"RTN","XMRPOP",24,0)
 ; ^TMP("XM",$J,"POP3","D",j)=XMZ         ; user deleted msg j
"RTN","XMRPOP",25,0)
ENTRY ;
"RTN","XMRPOP",26,0)
 N XMK,XMSTATE,XMCMDS,XMCMD,XMDUZ,XMACCESS,XMVERIFY,XMTRY,XMTMSGS,XMTOCTS,XMV
"RTN","XMRPOP",27,0)
 I '$D(ZTQUEUED) S X=$S($D(^%ZOSF("ERRTN")):^("ERRTN"),1:"ERR^ZU"),@(^%ZOSF("TRAP"))
"RTN","XMRPOP",28,0)
 I '$G(DUZ) S DUZ=.5
"RTN","XMRPOP",29,0)
 I '$D(XMDUZ) S XMDUZ=DUZ
"RTN","XMRPOP",30,0)
 I '$D(XMC("BATCH")) S XMC("BATCH")=0
"RTN","XMRPOP",31,0)
 I $S('$D(XMCHAN):1,XMCHAN="":1,1:0) S XMCHAN="TCP/IP-MAILMAN"
"RTN","XMRPOP",32,0)
 D OPEN^XML
"RTN","XMRPOP",33,0)
 I $G(ER)=1 D ^%ZISC:IO'=$G(IO(0)) W !,"Device open failed !",$C(7) Q
"RTN","XMRPOP",34,0)
 S:'$D(XM) XM=""
"RTN","XMRPOP",35,0)
 I 'XMC("BATCH") X ^%ZOSF("EOFF") S X=255 X ^%ZOSF("RM"),^%ZOSF("TYPE-AHEAD")
"RTN","XMRPOP",36,0)
 S ER=0
"RTN","XMRPOP",37,0)
 S XMK=1
"RTN","XMRPOP",38,0)
 S XMSG="+OK "_^XMB("NETNAME")_" POP3 server ready (Comments to: POSTMASTER@"_^XMB("NETNAME")_")" X XMSEN Q:ER
"RTN","XMRPOP",39,0)
 S XMCMDS("AUTH")="^PASS^QUIT^USER^"
"RTN","XMRPOP",40,0)
 S XMCMDS("TRAN")="^DELE^LIST^NOOP^QUIT^RETR^RSET^STAT^TOP^UIDL^"
"RTN","XMRPOP",41,0)
 S XMSTATE="AUTH"
"RTN","XMRPOP",42,0)
 F  X XMREC Q:ER  D  Q:XMCMD="QUIT"!ER
"RTN","XMRPOP",43,0)
 . I XMRG="" S ER=1,XMCMD="" Q
"RTN","XMRPOP",44,0)
 . S XMCMD=$P(XMRG," ",1)
"RTN","XMRPOP",45,0)
 . I $L(XMCMD)<3!($L(XMCMD)>4)!(XMCMD'?.U) S XMSG="-ERR no such command" X XMSEN Q
"RTN","XMRPOP",46,0)
 . I $T(@XMCMD)'[";;" S XMSG="-ERR no such command" X XMSEN Q
"RTN","XMRPOP",47,0)
 . I XMCMDS(XMSTATE)'[(U_XMCMD_U)="" S XMSG="-ERR no such command in "_XMSTATE_" state" X XMSEN Q
"RTN","XMRPOP",48,0)
 . D @XMCMD
"RTN","XMRPOP",49,0)
 I ER,$G(XMCMD)'="QUIT" D QUIT
"RTN","XMRPOP",50,0)
 Q
"RTN","XMRPOP",51,0)
DELE ;;
"RTN","XMRPOP",52,0)
 N XMID
"RTN","XMRPOP",53,0)
 S XMID=$P(XMRG," ",2,999)
"RTN","XMRPOP",54,0)
 Q:'$$OKID(XMID)
"RTN","XMRPOP",55,0)
 N XMREC,XMZ,XMOCTS
"RTN","XMRPOP",56,0)
 S XMZ=+^TMP("XM",$J,"POP3",XMID),XMOCTS=$P(^(XMID),U,2)
"RTN","XMRPOP",57,0)
 S ^TMP("XM",$J,"POP3","D",XMID)=XMZ
"RTN","XMRPOP",58,0)
 S XMREC=^TMP("XM",$J,"POP3")
"RTN","XMRPOP",59,0)
 S ^TMP("XM",$J,"POP3")=($P(XMREC,U,1)-1)_U_($P(XMREC,U,2)-XMOCTS)
"RTN","XMRPOP",60,0)
 S XMSG="+OK message "_XMID_" deleted" X XMSEN
"RTN","XMRPOP",61,0)
 Q
"RTN","XMRPOP",62,0)
OKID(XMID) ;
"RTN","XMRPOP",63,0)
 I XMID="" S XMSG="-ERR message-id required" X XMSEN Q 0
"RTN","XMRPOP",64,0)
 I +XMID'=XMID S XMSG="-ERR improper message-id" X XMSEN Q 0
"RTN","XMRPOP",65,0)
 I '$D(^TMP("XM",$J,"POP3",XMID)) S XMSG="-ERR no such message" X XMSEN Q 0
"RTN","XMRPOP",66,0)
 I $D(^TMP("XM",$J,"POP3","D",XMID)) S XMSG="-ERR message "_XMID_" already deleted" X XMSEN Q 0
"RTN","XMRPOP",67,0)
 Q 1
"RTN","XMRPOP",68,0)
LIST ;;
"RTN","XMRPOP",69,0)
 N XMID,XMOCTS
"RTN","XMRPOP",70,0)
 S XMID=$P(XMRG," ",2,999)
"RTN","XMRPOP",71,0)
 I XMID="" D  Q
"RTN","XMRPOP",72,0)
 . S XMSG="+OK "_$P(^TMP("XM",$J,"POP3"),U,1)_" messages ("_$P(^("POP3"),U,2)_" octets)" X XMSEN Q:ER
"RTN","XMRPOP",73,0)
 . F  S XMID=$O(^TMP("XM",$J,"POP3",XMID)) Q:'XMID  S XMOCTS=$P(^(XMID),U,2) D  Q:ER
"RTN","XMRPOP",74,0)
 . . Q:$D(^TMP("XM",$J,"POP3","D",XMID))
"RTN","XMRPOP",75,0)
 . . S XMSG=XMID_" "_XMOCTS X XMSEN
"RTN","XMRPOP",76,0)
 . S XMSG="." X XMSEN
"RTN","XMRPOP",77,0)
 Q:'$$OKID(XMID)
"RTN","XMRPOP",78,0)
 S XMSG="+OK "_XMID_" "_$P(^TMP("XM",$J,"POP3",XMID),U,2) X XMSEN
"RTN","XMRPOP",79,0)
 Q
"RTN","XMRPOP",80,0)
NOOP ;;
"RTN","XMRPOP",81,0)
 S XMSG="+OK" X XMSEN
"RTN","XMRPOP",82,0)
 Q
"RTN","XMRPOP",83,0)
PASS ;;
"RTN","XMRPOP",84,0)
 I '$D(XMACCESS) D LOGINERR("-ERR sorry, USER access code expected") Q
"RTN","XMRPOP",85,0)
 S XMVERIFY=$P(XMRG," ",2,999)
"RTN","XMRPOP",86,0)
 I XMVERIFY'="" D LOGIN Q
"RTN","XMRPOP",87,0)
 D LOGINERR("-ERR sorry, PASS verify code expected")
"RTN","XMRPOP",88,0)
 Q
"RTN","XMRPOP",89,0)
LOGIN ;
"RTN","XMRPOP",90,0)
 N XMLOGIN
"RTN","XMRPOP",91,0)
 S XMLOGIN=$$LOGINOK
"RTN","XMRPOP",92,0)
 I 'XMLOGIN D LOGINERR("-ERR "_$P(XMLOGIN,U,2)) Q
"RTN","XMRPOP",93,0)
 K XMACCESS,XMVERIFY
"RTN","XMRPOP",94,0)
 S XMSTATE="TRAN"
"RTN","XMRPOP",95,0)
 S XMDUZ=DUZ
"RTN","XMRPOP",96,0)
 D INIT^XMVVITAE
"RTN","XMRPOP",97,0)
 D MAILDROP
"RTN","XMRPOP",98,0)
 D RSET
"RTN","XMRPOP",99,0)
 Q
"RTN","XMRPOP",100,0)
LOGINOK() ;
"RTN","XMRPOP",101,0)
 I $T(@"USERSET^XUSRA")="" Q $$OLDCHK
"RTN","XMRPOP",102,0)
 Q $$USERSET^XUSRA(XMACCESS_";"_XMVERIFY)
"RTN","XMRPOP",103,0)
OLDCHK() ;
"RTN","XMRPOP",104,0)
 N XUSER,XUF,%1,XMLOGIN
"RTN","XMRPOP",105,0)
 S XUF=0
"RTN","XMRPOP",106,0)
 S XMLOGIN=$$CHECKAV^XUS(XMACCESS_";"_XMVERIFY)
"RTN","XMRPOP",107,0)
 I XMLOGIN S DUZ=XMLOGIN Q 1
"RTN","XMRPOP",108,0)
 Q "0^Not a valid ACCESS CODE/VERIFY CODE pair"
"RTN","XMRPOP",109,0)
MAILDROP ;
"RTN","XMRPOP",110,0)
 N XMKZ,XMZ,XMOCTS,XMID
"RTN","XMRPOP",111,0)
 K ^TMP("XM",$J,"POP3")
"RTN","XMRPOP",112,0)
 S (XMID,XMKZ,XMTOCTS)=0
"RTN","XMRPOP",113,0)
 F  S XMKZ=$O(^XMB(3.7,XMDUZ,2,XMK,1,"C",XMKZ)) Q:'XMKZ  D
"RTN","XMRPOP",114,0)
 . S XMZ=$O(^XMB(3.7,XMDUZ,2,XMK,1,"C",XMKZ,0))
"RTN","XMRPOP",115,0)
 . I '$D(^XMB(3.7,XMDUZ,2,XMK,1,XMZ,0)) D ADDITC^XMUT4A(XMDUZ,XMK,XMZ,XMKZ)
"RTN","XMRPOP",116,0)
 . I '$D(^XMB(3.9,XMZ,0)) D ZAPIT^XMXMSGS2(XMDUZ,XMK,XMZ) Q
"RTN","XMRPOP",117,0)
 . S XMID=XMID+1
"RTN","XMRPOP",118,0)
 . S XMOCTS=$$OCTETS(XMZ)
"RTN","XMRPOP",119,0)
 . S XMTOCTS=XMTOCTS+XMOCTS
"RTN","XMRPOP",120,0)
 . S ^TMP("XM",$J,"POP3",XMID)=XMZ_U_XMOCTS
"RTN","XMRPOP",121,0)
 S XMTMSGS=XMID
"RTN","XMRPOP",122,0)
 Q
"RTN","XMRPOP",123,0)
OCTETS(XMZ) ; Returns the number of 'octets' in a message.
"RTN","XMRPOP",124,0)
 ; Basically, that's a count of the number of characters.
"RTN","XMRPOP",125,0)
 ; We estimate it by multiplying the number of lines by 50.
"RTN","XMRPOP",126,0)
 Q $P($G(^XMB(3.9,XMZ,2,0)),U,4)*50
"RTN","XMRPOP",127,0)
LOGINERR(XMSG) ;
"RTN","XMRPOP",128,0)
 K XMACCESS,XMVERIFY
"RTN","XMRPOP",129,0)
 S XMTRY=$G(XMTRY)+1
"RTN","XMRPOP",130,0)
 I XMTRY<3 X XMSEN Q
"RTN","XMRPOP",131,0)
 D SIGNOFF(XMSG_"; 3 tries and you're out!")
"RTN","XMRPOP",132,0)
 S XMCMD="QUIT"
"RTN","XMRPOP",133,0)
 Q
"RTN","XMRPOP",134,0)
QUIT ;;
"RTN","XMRPOP",135,0)
 I XMSTATE="TRAN",'ER D UPDATE
"RTN","XMRPOP",136,0)
 K ^TMP("XM",$J,"POP3")
"RTN","XMRPOP",137,0)
 D SIGNOFF("")
"RTN","XMRPOP",138,0)
 Q
"RTN","XMRPOP",139,0)
SIGNOFF(XMSG) ;
"RTN","XMRPOP",140,0)
 S XMSG=$S(XMSG'="":XMSG_"; ",ER:"-ERR ",1:"+OK ")_^XMB("NETNAME")_" POP3 server signing off" X XMSEN
"RTN","XMRPOP",141,0)
 Q
"RTN","XMRPOP",142,0)
RETR ;;
"RTN","XMRPOP",143,0)
 N XMID
"RTN","XMRPOP",144,0)
 S XMID=$P(XMRG," ",2,999)
"RTN","XMRPOP",145,0)
 Q:'$$OKID(XMID)
"RTN","XMRPOP",146,0)
 S XMSG="+OK "_$P(^TMP("XM",$J,"POP3",XMID),U,2)_" octets" X XMSEN Q:ER
"RTN","XMRPOP",147,0)
 D RETRIEVE(XMID,"*")
"RTN","XMRPOP",148,0)
 Q
"RTN","XMRPOP",149,0)
RSET ;;
"RTN","XMRPOP",150,0)
 K ^TMP("XM",$J,"POP3","D")
"RTN","XMRPOP",151,0)
 S ^TMP("XM",$J,"POP3")=XMTMSGS_U_XMTOCTS
"RTN","XMRPOP",152,0)
 S XMSG="+OK maildrop has "_XMTMSGS_" messages ("_XMTOCTS_" octets)" X XMSEN
"RTN","XMRPOP",153,0)
 Q
"RTN","XMRPOP",154,0)
STAT ;;
"RTN","XMRPOP",155,0)
 S XMSG="+OK "_$P(^TMP("XM",$J,"POP3"),U,1)_" "_$P(^("POP3"),U,2) X XMSEN
"RTN","XMRPOP",156,0)
 Q
"RTN","XMRPOP",157,0)
TOP ;;
"RTN","XMRPOP",158,0)
 N XMID,XMLINES
"RTN","XMRPOP",159,0)
 S XMID=$P(XMRG," ",2)
"RTN","XMRPOP",160,0)
 Q:'$$OKID(XMID)
"RTN","XMRPOP",161,0)
 S XMLINES=$P(XMRG," ",3,999)
"RTN","XMRPOP",162,0)
 I +XMLINES'=XMLINES S XMSG="-ERR improper number of lines" X XMSEN Q
"RTN","XMRPOP",163,0)
 S XMSG="+OK" X XMSEN Q:ER
"RTN","XMRPOP",164,0)
 D RETRIEVE(XMID,XMLINES)
"RTN","XMRPOP",165,0)
 Q
"RTN","XMRPOP",166,0)
UIDL ;;
"RTN","XMRPOP",167,0)
 N XMID,XMZ
"RTN","XMRPOP",168,0)
 S XMID=$P(XMRG," ",2,999)
"RTN","XMRPOP",169,0)
 I XMID="" D  Q
"RTN","XMRPOP",170,0)
 . S XMSG="+OK" X XMSEN Q:ER
"RTN","XMRPOP",171,0)
 . F  S XMID=$O(^TMP("XM",$J,"POP3",XMID)) Q:'XMID  S XMZ=+^(XMID) D  Q:ER
"RTN","XMRPOP",172,0)
 . . Q:$D(^TMP("XM",$J,"POP3","D",XMID))
"RTN","XMRPOP",173,0)
 . . S XMSG=XMID_" "_XMZ X XMSEN
"RTN","XMRPOP",174,0)
 . S XMSG="." X XMSEN
"RTN","XMRPOP",175,0)
 Q:'$$OKID(XMID)
"RTN","XMRPOP",176,0)
 S XMSG="+OK "_XMID_" "_+^TMP("XM",$J,"POP3",XMID) X XMSEN
"RTN","XMRPOP",177,0)
 Q
"RTN","XMRPOP",178,0)
USER ;;
"RTN","XMRPOP",179,0)
 S XMACCESS=$P(XMRG," ",2,999)
"RTN","XMRPOP",180,0)
 I XMACCESS'="" S XMSG="+OK" X XMSEN Q
"RTN","XMRPOP",181,0)
 D LOGINERR("-ERR sorry, USER access code expected")
"RTN","XMRPOP",182,0)
 Q
"RTN","XMRPOP",183,0)
UPDATE ;
"RTN","XMRPOP",184,0)
 N XMID,XMZ
"RTN","XMRPOP",185,0)
 S XMID=0
"RTN","XMRPOP",186,0)
 F  S XMID=$O(^TMP("XM",$J,"POP3","D",XMID)) Q:'XMID  S XMZ=+^(XMID) D DEL^XMXMSGS2(XMDUZ,"",XMZ)
"RTN","XMRPOP",187,0)
 Q
"RTN","XMRPOP",188,0)
RETRIEVE(XMID,XMLINES) ;
"RTN","XMRPOP",189,0)
 N XMZ,XMRESP,XMIM,XMINSTR,XMIU
"RTN","XMRPOP",190,0)
 S XMZ=+^TMP("XM",$J,"POP3",XMID)
"RTN","XMRPOP",191,0)
 D INMSG^XMXUTIL2(XMDUZ,"",XMZ,"","I",.XMIM,.XMINSTR,.XMIU)
"RTN","XMRPOP",192,0)
 D RETRXMZ(XMZ,XMLINES,.XMIM) Q:ER
"RTN","XMRPOP",193,0)
 I 'XMLINES,XMIM("RESPS") D  Q:ER
"RTN","XMRPOP",194,0)
 . F XMRESP=XMIU("RESP")+1:1:XMIM("RESPS") D  Q:ER
"RTN","XMRPOP",195,0)
 . . N XMIR
"RTN","XMRPOP",196,0)
 . . D INRESP^XMXUTIL2(XMZ,XMRESP,"I",.XMIR) Q:'$D(XMIR)
"RTN","XMRPOP",197,0)
 . . I XMIR("SUBJ")?1"R".N S XMIR("SUBJ")="Re: "_XMIM("SUBJ")
"RTN","XMRPOP",198,0)
 . . S XMSG="" X XMSEN Q:ER  ; just for visual separation
"RTN","XMRPOP",199,0)
 . . D RETRXMZ(XMIR("XMZ"),"*",.XMIR,XMZ) Q:ER
"RTN","XMRPOP",200,0)
 E  S XMRESP=0
"RTN","XMRPOP",201,0)
 S XMSG="." X XMSEN Q:ER
"RTN","XMRPOP",202,0)
 D LASTACC^XMXUTIL(XMDUZ,XMK,XMZ,XMRESP,.XMIM,.XMINSTR,.XMIU)
"RTN","XMRPOP",203,0)
 I $D(^XMB(3.7,XMDUZ,"N0",XMK,XMZ)),+XMRESP=+$P($G(^XMB(3.9,XMZ,3,0)),U,4) D NONEW^XMXUTIL(XMDUZ,XMK,XMZ,1)
"RTN","XMRPOP",204,0)
 Q
"RTN","XMRPOP",205,0)
RETRXMZ(XMZ,XMLINES,XMIM,XMZO) ;
"RTN","XMRPOP",206,0)
 N XMI
"RTN","XMRPOP",207,0)
 I $O(^XMB(3.9,XMZ,2,0))'<1 D CRE8HDR(XMZ,.XMIM,.XMZO) Q:ER
"RTN","XMRPOP",208,0)
 S XMI=0
"RTN","XMRPOP",209,0)
 F  S XMI=$O(^XMB(3.9,XMZ,2,XMI)) Q:'XMI  S XMSG=^(XMI,0) S:$E(XMSG)="." XMSG="."_XMSG X XMSEN Q:ER  I XMLINES,XMI'<XMLINES Q
"RTN","XMRPOP",210,0)
 Q
"RTN","XMRPOP",211,0)
CRE8HDR(XMZ,XMIM,XMZO) ;
"RTN","XMRPOP",212,0)
 S XMSG="Message-ID: <"_XMZ_"@"_^XMB("NETNAME")_">" X XMSEN Q:ER
"RTN","XMRPOP",213,0)
 S XMSG="From: <"_$$NETNAME^XMXUTIL(XMIM("FROM"))_">" X XMSEN Q:ER
"RTN","XMRPOP",214,0)
 S XMSG="To: <"_XMV("NETNAME")_">" X XMSEN Q:ER
"RTN","XMRPOP",215,0)
 S XMSG="Subject: "_XMIM("SUBJ") X XMSEN Q:ER
"RTN","XMRPOP",216,0)
 S XMSG="Date: "_$$INDT^XMXUTIL1(XMIM("DATE")) X XMSEN Q:ER
"RTN","XMRPOP",217,0)
 S XMSG="" X XMSEN Q:ER
"RTN","XMRPOP",218,0)
 Q
"RTN","XMRTCP")
0^59^B9528522
"RTN","XMRTCP",1,0)
XMRTCP ;(WASH ISC)/THM/CAP-SMTP Receiver ;05/20/2002  08:51
"RTN","XMRTCP",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMRTCP",3,0)
 ;Modified for TCP/IP under INET_SERVERS of Wollongong
"RTN","XMRTCP",4,0)
 ;
"RTN","XMRTCP",5,0)
POLL ;Poll all domains with flags set
"RTN","XMRTCP",6,0)
 ;Fake TaskMan Env.
"RTN","XMRTCP",7,0)
 S U="^",X="ERR^XMRTCP",@^%ZOSF("TRAP"),XMDUZ=.5
"RTN","XMRTCP",8,0)
 K XM S IOP="NULL",%IS=0 D ^%ZIS I '$D(IOT) S IOT=""
"RTN","XMRTCP",9,0)
HANG S IO(0)=IO,ZTQUEUED=$S($D(ZTQUEUED):ZTQUEUED,1:1),ZTSK=$S($D(ZTSK):ZTSK,1:"N/A"),XM="",XMLTCPT=""
"RTN","XMRTCP",10,0)
 I $G(^TMP("XMRTCP",0)) S XMLTCPT=^(0) K ^(0)
"RTN","XMRTCP",11,0)
L Q:$P(^XMB(1,1,0),U,18)=1
"RTN","XMRTCP",12,0)
 ;
"RTN","XMRTCP",13,0)
 ;Any queues flagged (x-ref is set by TCP/IP POLL FLAG in domain file)
"RTN","XMRTCP",14,0)
 S XMLTCPT=$O(^DIC(4.2,"ATCP",1,XMLTCPT)) G QQ:XMLTCPT=""
"RTN","XMRTCP",15,0)
 S XMINST=XMLTCPT
"RTN","XMRTCP",16,0)
 ;
"RTN","XMRTCP",17,0)
RQ ;Transmit messages / execute TURN command
"RTN","XMRTCP",18,0)
 ;Are there messages to send ?
"RTN","XMRTCP",19,0)
 I '$O(^XMB(3.7,.5,2,XMINST+1000,1,0)) G L
"RTN","XMRTCP",20,0)
 ;Job out, if all slots full wait and try again.
"RTN","XMRTCP",21,0)
 S %=$$CK(1) I '% S XMLTCPT=$O(^DIC(4.2,"ATCP",1,XMLTCPT),-1) H 60 G L
"RTN","XMRTCP",22,0)
 D SETUP L +^XMBX("TCPCHAN",XMINST):3 E  L -^XMBX("TCPCHAN-COUNT",%) G L
"RTN","XMRTCP",23,0)
 ;
"RTN","XMRTCP",24,0)
 S XMRTCP("CNT")=%
"RTN","XMRTCP",25,0)
 ;
"RTN","XMRTCP",26,0)
 ;Change name (prevent dupe error), then JOB myself
"RTN","XMRTCP",27,0)
 Q:$E($G(XMRTCP("NAME")),1,6)="MM-FTP"
"RTN","XMRTCP",28,0)
 S XMRTCP("NAME")="MM-TCP-"_XMINST D REN^XMRFTP
"RTN","XMRTCP",29,0)
 S X=^%ZOSF("ERRTN"),@^%ZOSF("TRAP")
"RTN","XMRTCP",30,0)
 ;
"RTN","XMRTCP",31,0)
 ;Deliver messages
"RTN","XMRTCP",32,0)
 ;
"RTN","XMRTCP",33,0)
 ;INIT
"RTN","XMRTCP",34,0)
 S XMSITE=$P(^DIC(4.2,XMINST,0),"^")
"RTN","XMRTCP",35,0)
 D XMTCHECK^XMKPR(XMINST,.XMB)
"RTN","XMRTCP",36,0)
 S XMOKTYPE("TCPCHAN")="" ;Find and use TCP/IP channel script
"RTN","XMRTCP",37,0)
 D SCRIPT^XMKPR1(XMINST,XMSITE,.XMB,.XMOKTYPE) Q:'XMB("SCR IEN")
"RTN","XMRTCP",38,0)
 ; Check that last try is at least 1 minute ago.
"RTN","XMRTCP",39,0)
 ; If we've completed a cycle of scripts, wait until 1 hour has passed
"RTN","XMRTCP",40,0)
 ; before we start the next cycle.
"RTN","XMRTCP",41,0)
 I XMB("TRIES"),$$FMDIFF^XLFDT($$NOW^XLFDT,XMB("LASTTRY"),2)\60<1 G HALT
"RTN","XMRTCP",42,0)
 E  I XMB("ITERATIONS"),XMB("SCR IEN")=XMB("FIRST SCRIPT"),$$FMDIFF^XLFDT($$NOW^XLFDT,XMB("LASTTRY"),2)\60\60<1 G HALT
"RTN","XMRTCP",43,0)
 S ZTIO=$P(XMB("SCRIPT"),U,5)
"RTN","XMRTCP",44,0)
 D XMTAUDT^XMTDR(XMINST,.XMB)
"RTN","XMRTCP",45,0)
 D ENT^XMC1
"RTN","XMRTCP",46,0)
 H 30
"RTN","XMRTCP",47,0)
 D KILL
"RTN","XMRTCP",48,0)
 G HALT
"RTN","XMRTCP",49,0)
 ;
"RTN","XMRTCP",50,0)
 ;Pause between POLLINGS
"RTN","XMRTCP",51,0)
QQ D KILL S X=$H*86400+$P($H,",",2) G:$O(^XMBX(4.2995,0)) FTP^XMRFTP
"RTN","XMRTCP",52,0)
 S X=22-($H*86400+$P($H,",",2)-X) I X>0 H X
"RTN","XMRTCP",53,0)
 G POLL
"RTN","XMRTCP",54,0)
 ;
"RTN","XMRTCP",55,0)
 ;Entry on dupe name
"RTN","XMRTCP",56,0)
DUPNAME S X="ERR^XMRTCP",@^%ZOSF("TRAP") H 15 G L
"RTN","XMRTCP",57,0)
 ;
"RTN","XMRTCP",58,0)
 ;Clean up before next transmission
"RTN","XMRTCP",59,0)
KILL D KL1^XMC K DIC,XMB,XMDT,ZTPAR
"RTN","XMRTCP",60,0)
 L  Q
"RTN","XMRTCP",61,0)
 ;
"RTN","XMRTCP",62,0)
SETUP ;Set up environment
"RTN","XMRTCP",63,0)
 N IO S IO="",IO(0)="" D DT^DICRW
"RTN","XMRTCP",64,0)
 Q
"RTN","XMRTCP",65,0)
ERR D @^%ZOSF("ERRTN") H 60
"RTN","XMRTCP",66,0)
 I '$F(":MM-TCP:MM-FTP:",":"_$E($G(XMRTCP("NAME")),1,6)_":") D KILL G POLL
"RTN","XMRTCP",67,0)
HALT ;
"RTN","XMRTCP",68,0)
 ;I ^%ZOSF("OS")["VAX" U IO:DISCONNECT
"RTN","XMRTCP",69,0)
 ;G ^XUSCLEAN  ; Writes to IO. 
"RTN","XMRTCP",70,0)
 G H2^XUSCLEAN ; Supposedly doesn't write to IO.
"RTN","XMRTCP",71,0)
 ;
"RTN","XMRTCP",72,0)
 ;Entry for Inet_servers interface RECEIVER
"RTN","XMRTCP",73,0)
 ;SMTP service request invokes MailMan
"RTN","XMRTCP",74,0)
 ;
"RTN","XMRTCP",75,0)
SOC25 S (XMRPORT,IO,IO(0))=%,X=$E(%_"-INETMM",1,15) D SETENV^%ZOSV
"RTN","XMRTCP",76,0)
 D DT^DICRW,DUZ^XUP(.5)
"RTN","XMRTCP",77,0)
 S X="ERR^ZU",@^%ZOSF("TRAP"),ER=0
"RTN","XMRTCP",78,0)
 O IO:(SHARE,MAILBOX) U IO
"RTN","XMRTCP",79,0)
 S XMCHAN="TCP/IP-MAILMAN",XMNO220=""
"RTN","XMRTCP",80,0)
 D ENT^XMR
"RTN","XMRTCP",81,0)
 G HALT
"RTN","XMRTCP",82,0)
 ;
"RTN","XMRTCP",83,0)
 ;Check if slot on TCP/IP to use
"RTN","XMRTCP",84,0)
CK(X) S I=$P(^XMB(1,1,0),"^",17)
"RTN","XMRTCP",85,0)
 F %=1:1 L +^XMBX("TCPCHAN-COUNT",%):1 Q:$T  Q:%=I
"RTN","XMRTCP",86,0)
 Q $S($T:%,1:0)
"RTN","XMRTCP",87,0)
JOB ;
"RTN","XMRTCP",88,0)
 H 90 ;wait for RVG mounts
"RTN","XMRTCP",89,0)
 S $P(^XMB(1,1,0),"^",18)="" ;Clear the TCP/IP poller run flag
"RTN","XMRTCP",90,0)
START G START^XMRTCPGO
"RTN","XMRTCP",91,0)
ERRSCRPT ;TRAP transmission errors
"RTN","XMRTCP",92,0)
 S ER=1
"RTN","XMRTCP",93,0)
 I ^%ZOSF("OS")["VAX DSM" S $ECODE=""
"RTN","XMRTCP",94,0)
 Q
"RTN","XMRTCPGO")
0^331^B3838958
"RTN","XMRTCPGO",1,0)
XMRTCPGO ;(WASH ISC)/THM/CAP-Start XMRTCP ;02/19/98  14:32
"RTN","XMRTCPGO",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMRTCPGO",3,0)
JOB ;Job itself out for TCPQUE.COM to use for polling TCPFLAG'd sites
"RTN","XMRTCPGO",4,0)
 ;
"RTN","XMRTCPGO",5,0)
 ;XMRTCP must have VMS context
"RTN","XMRTCPGO",6,0)
 ;The following code starts job w/o VMS context
"RTN","XMRTCPGO",7,0)
 ;N % S %="MM-TCP-Poller" I $G(XMINST) S ^TMP("XMRTCP",0)=XMINST
"RTN","XMRTCPGO",8,0)
 ;J POLL^XMRTCP:(NAME=%) Q
"RTN","XMRTCPGO",9,0)
 ;
"RTN","XMRTCPGO",10,0)
 ;Start job with VMS CONTEXT
"RTN","XMRTCPGO",11,0)
 G START^XMRTCPGO
"RTN","XMRTCPGO",12,0)
 Q
"RTN","XMRTCPGO",13,0)
START ;Start XMRTCP w/DCL context
"RTN","XMRTCPGO",14,0)
 I $G(XMINST) S ^TMP("XMRTCP",0)=XMINST
"RTN","XMRTCPGO",15,0)
 I ^%ZOSF("OS")["MSM" J POLL^XMRTCP Q
"RTN","XMRTCPGO",16,0)
 D SPN("XMRTCP","POLL^XMRTCP")
"RTN","XMRTCPGO",17,0)
 Q
"RTN","XMRTCPGO",18,0)
 ;Spawn out from VMS / run w/DCL context
"RTN","XMRTCPGO",19,0)
SPN(X,Y) ;X=Filename right-hand side / Y=Entry point
"RTN","XMRTCPGO",20,0)
 D DEL N % S F=X_".COM" O F:NEW U F S F=$ZIO
"RTN","XMRTCPGO",21,0)
 W "$DSM/UCI="_$P($ZU(0),",")_"/ENVIRONMENT="_$$OPTION^%SYSUTL("ENVIRONMENT")_" "_Y,!
"RTN","XMRTCPGO",22,0)
 S %="$run sys$system:loginout/input="_F_"/output=XMRTCP.log/detach/ast=300/buffer=40960/enqueu=300/file=99/io_buf=64/io_dir=64/job_tab=1024/maximum_work=1864/page=10240/queue_lim=10/work=900/subprocess=30/process=MM-TCP-Poller"
"RTN","XMRTCPGO",23,0)
 C F S %=$ZC(%SPAWN,%) I 1
"RTN","XMRTCPGO",24,0)
 Q
"RTN","XMRTCPGO",25,0)
DEL N %,X S X="DELER^XMRTCPGO",@^%ZOSF("TRAP")
"RTN","XMRTCPGO",26,0)
 S %=$ZC(%SPAWN,"DELETE XMRTCP.COM.*")
"RTN","XMRTCPGO",27,0)
 S %=$ZC(%SPAWN,"DELETE XMRTCP.LOG.*")
"RTN","XMRTCPGO",28,0)
DELER Q
"RTN","XMRUCX")
0^332^B2418489
"RTN","XMRUCX",1,0)
XMRUCX ;(WASH ISC)/THM/CAP-SMTP Receiver (RFC 821) for UCX ;07/23/2002  07:28
"RTN","XMRUCX",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMRUCX",3,0)
 ;
"RTN","XMRUCX",4,0)
 ;Entry for Inet_servers interface RECEIVER
"RTN","XMRUCX",5,0)
 ;SMTP service request invokes MailMan
"RTN","XMRUCX",6,0)
SOC25 ;
"RTN","XMRUCX",7,0)
 ;S (XMRPORT,IO,IO(0))=%,X=$E(%_"-INETMM",1,15) D SETENV^%ZOSV
"RTN","XMRUCX",8,0)
 ;I $$NEWERR^%ZTER N $ETRAP,$ESTACK S $ETRAP="D R^XMCTRAP Q"
"RTN","XMRUCX",9,0)
 ;E  S X="R^XMCTRAP",@^%ZOSF("TRAP")
"RTN","XMRUCX",10,0)
 ;D DT^DICRW,DUZ^XUP(.5)
"RTN","XMRUCX",11,0)
 ;S ER=0
"RTN","XMRUCX",12,0)
 ;O IO:(SHARE) U IO
"RTN","XMRUCX",13,0)
 ;S XMCHAN="TCP/IP-MAILMAN",XMNO220=""
"RTN","XMRUCX",14,0)
 ;D ENT^XMR
"RTN","XMRUCX",15,0)
 ;;G HALT^XMRTCP
"RTN","XMRUCX",16,0)
 ;Q
"RTN","XMRUCX",17,0)
SOC ;
"RTN","XMRUCX",18,0)
 S (XMRPORT,IO,IO(0))="SYS$NET",X=$E(%_"INETMM",1,15) D SETENV^%ZOSV
"RTN","XMRUCX",19,0)
 I $$NEWERR^%ZTER N $ETRAP,$ESTACK S $ETRAP="S ZZIO=$ZIO H 33 D R^XMCTRAP Q"
"RTN","XMRUCX",20,0)
 E  S X="R^XMCTRAP",@^%ZOSF("TRAP")
"RTN","XMRUCX",21,0)
 D DT^DICRW,DUZ^XUP(.5)
"RTN","XMRUCX",22,0)
 S ER=0
"RTN","XMRUCX",23,0)
 O IO:(TCPDEV):33 U IO
"RTN","XMRUCX",24,0)
 S XMCHAN="TCP/IP-MAILMAN",XMNO220=""
"RTN","XMRUCX",25,0)
 D ENT^XMR
"RTN","XMRUCX",26,0)
 ;G HALT^XMRTCP
"RTN","XMRUCX",27,0)
 Q
"RTN","XMRUCX",28,0)
GTM2 ;Entry point for %ZISTCPS to GT.M
"RTN","XMRUCX",29,0)
 ;The device has been open and setup in %ZISTCPS
"RTN","XMRUCX",30,0)
 N $ETRAP,$ESTACK S $ETRAP="D ^%ZTER S ZZIO=$ZIO H 33 D R^XMCTRAP Q"
"RTN","XMRUCX",31,0)
 S XMRPORT=IO
"RTN","XMRUCX",32,0)
 D SETNM^%ZOSV($E(IO_"INETMM",1,15)),COUNT^XUSLOG(1) ;Process counting under GT.M
"RTN","XMRUCX",33,0)
 S DIQUIET=1 D DT^DICRW,DUZ^XUP(.5)
"RTN","XMRUCX",34,0)
 S ER=0,XMS0C=1
"RTN","XMRUCX",35,0)
 U IO:(DELIMITER=$C(13))
"RTN","XMRUCX",36,0)
 S XMCHAN="TCP/GTM" ;,XMNO220=""
"RTN","XMRUCX",37,0)
 D ENT^XMR
"RTN","XMRUCX",38,0)
 D COUNT^XUSLOG(-1) ;Check out GT.M counting
"RTN","XMRUCX",39,0)
 Q
"RTN","XMRUCX",40,0)
STARTGTM ;Start the %ZISTCPS service
"RTN","XMRUCX",41,0)
 D LISTEN^%ZISTCPS(2525,"GTM2^XMRUCX")
"RTN","XMRUCX",42,0)
 Q
"RTN","XMS")
0^60^B39486750
"RTN","XMS",1,0)
XMS ;ISC-SF/GMB-SMTP Send ;07/11/2002  07:52
"RTN","XMS",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMS",3,0)
ENTER ; 
"RTN","XMS",4,0)
 ; Variables
"RTN","XMS",5,0)
 ; XMINST   Institution number
"RTN","XMS",6,0)
 ; XMSITE   Institution name
"RTN","XMS",7,0)
 ; XMIO     same as ZTIO
"RTN","XMS",8,0)
 D INIT
"RTN","XMS",9,0)
 ; Fall through...
"RTN","XMS",10,0)
SEND ;
"RTN","XMS",11,0)
 S XMC("DIR")="S"
"RTN","XMS",12,0)
 S:'$D(XMC("TURN")) XMC("TURN")=0
"RTN","XMS",13,0)
 D SYNCH Q:ER
"RTN","XMS",14,0)
 I $D(XMC("CHRISTEN")) D CHRISTN,TESTLNK Q
"RTN","XMS",15,0)
 I $D(XMC("TEST")) D TESTLNK Q
"RTN","XMS",16,0)
 D HELO(XMINST,XMSITE) L -^DIC(4.2,XMINST,0) Q:ER
"RTN","XMS",17,0)
 D PROCESS(XMINST,.XMB)
"RTN","XMS",18,0)
 D TURN(XMINST)
"RTN","XMS",19,0)
 D QUIT
"RTN","XMS",20,0)
 Q
"RTN","XMS",21,0)
INIT ;
"RTN","XMS",22,0)
 S ER=0
"RTN","XMS",23,0)
 S $P(^XMBS(4.2999,XMINST,3),U,6)=$E(IO,1,9)_" "_XMPROT
"RTN","XMS",24,0)
 S:'$D(XMC("START")) XMC("START")=$$TSTAMP^XMXUTIL1-.001
"RTN","XMS",25,0)
 I '$D(DT) D DT^DICRW
"RTN","XMS",26,0)
 S:'$D(XMC("BATCH")) XMC("BATCH")=0
"RTN","XMS",27,0)
 S XMTLER=0
"RTN","XMS",28,0)
 Q
"RTN","XMS",29,0)
SYNCH ; Recv: "220 REMOTE.MED.VA.GOV MailMan 8.0 ready"
"RTN","XMS",30,0)
 I XMC("BATCH") S XMC("MAILMAN")=+$P($T(XMS+1),";",3) Q
"RTN","XMS",31,0)
 S XMC("MAILMAN")=0
"RTN","XMS",32,0)
 N XMI,XMX
"RTN","XMS",33,0)
 F XMI=1:1:5 D  Q:ER  Q:$E(XMRG)=2
"RTN","XMS",34,0)
 . X XMREC Q:ER
"RTN","XMS",35,0)
 . S XMX=$P(XMRG," MailMan ",2)
"RTN","XMS",36,0)
 . I XMX>4,XMX[" ready" S XMC("MAILMAN")=+XMX
"RTN","XMS",37,0)
 . I $E(XMRG)'=2 S XMSG="NOOP" X XMSEN Q
"RTN","XMS",38,0)
 Q
"RTN","XMS",39,0)
HELO(XMINST,XMSITE) ;
"RTN","XMS",40,0)
 ; Send: "HELO LOCAL.MED.VA.GOV <security num>"
"RTN","XMS",41,0)
 ; Recv: "250 OK REMOTE.MED.VA.GOV <security num> [8.0,DUP,SER,FTP]"
"RTN","XMS",42,0)
 N XMINREC,XMSVAL,I
"RTN","XMS",43,0)
 S XMINREC=^DIC(4.2,XMINST,0)
"RTN","XMS",44,0)
 S XMSVAL=$P(XMINREC,U,15) ; Security code
"RTN","XMS",45,0)
 I XMSVAL L +^DIC(4.2,XMINST,0):0 E  D  Q
"RTN","XMS",46,0)
 . D ERTRAN^XMC1(42350) ;Domain file locked.
"RTN","XMS",47,0)
 S XMSG="HELO "_^XMB("NETNAME")_$S('XMSVAL:"",1:"<"_XMSVAL_">") X XMSEN
"RTN","XMS",48,0)
 I ER D ERTRAN^XMC1(42351,XMSG) Q  ;HELO SEND failed: |1|
"RTN","XMS",49,0)
 Q:XMC("BATCH")
"RTN","XMS",50,0)
 X XMREC I ER D ERTRAN^XMC1(42352) Q  ;HELO RECEIVE failed.
"RTN","XMS",51,0)
 I $E(XMRG)'=2 D  Q
"RTN","XMS",52,0)
 . D ERTRAN^XMC1(42353,^XMB("NETNAME"),XMSITE) ;|1| not recognized by |2|
"RTN","XMS",53,0)
 ;I $P(XMRG,"[",2)'="" S XMC("CAPABLE")=$P(XMRG,"[",2)
"RTN","XMS",54,0)
 F I=1:1:$L(XMRG," ") Q:$P(XMRG," ",I)["."
"RTN","XMS",55,0)
 S XMC("HELO SEND")=$P(XMRG," ",I)
"RTN","XMS",56,0)
 Q:'XMSVAL
"RTN","XMS",57,0)
 S XMSVAL=$P($P(XMRG,"<",2),">")
"RTN","XMS",58,0)
 I XMSVAL<1000000 D  Q
"RTN","XMS",59,0)
 . N XMPARM,XMINSTR
"RTN","XMS",60,0)
 . S XMSG="500 Invalid domain validation response" X XMSEN
"RTN","XMS",61,0)
 . S XMPARM(1)=XMSITE,XMINSTR("FROM")="POSTMASTER"
"RTN","XMS",62,0)
 . D TASKBULL^XMXBULL(.5,"XMVALBAD",.XMPARM,,,.XMINSTR)
"RTN","XMS",63,0)
 . S ER=1,ER("MSG")=XMSG
"RTN","XMS",64,0)
 ;Double set below prevents replicated ^DIC from
"RTN","XMS",65,0)
 ;going out of synch when link is down.
"RTN","XMS",66,0)
 S ^DIC(4.2,XMINST,0)=XMINREC,$P(XMINREC,U,15)=XMSVAL,^(0)=XMINREC
"RTN","XMS",67,0)
 Q
"RTN","XMS",68,0)
PROCESS(XMINST,XMB) ;
"RTN","XMS",69,0)
 N XMK,XMZ
"RTN","XMS",70,0)
 S XMK=XMINST+1000
"RTN","XMS",71,0)
 I '$$BMSGCT^XMXUTIL(.5,XMK) D  Q
"RTN","XMS",72,0)
 . D DOTRAN^XMC1(42358) ; There are no messages in the queue to send
"RTN","XMS",73,0)
 ; First send msgs the postmaster has flagged to go first
"RTN","XMS",74,0)
 ; (NETWORK MESSAGE FLAG) set to 1), then send rest.
"RTN","XMS",75,0)
 F  S XMZ=$$NEXT(XMK) Q:XMZ=""  D  Q:ER
"RTN","XMS",76,0)
 . L +^XMNET(XMINST,XMZ):0 E  D  Q
"RTN","XMS",77,0)
 . . S XMC("NOREQUEUE")=1
"RTN","XMS",78,0)
 . . D ERTRAN^XMC1(42354) ;Queue being transmitted by another job - Aborting now.
"RTN","XMS",79,0)
 . D SENDMSG^XMS1(XMK,XMZ,.XMB)
"RTN","XMS",80,0)
 . I '$D(^XMB(3.9,XMZ,1,"AQUEUE",XMINST)) D ZAPIT^XMXMSGS2(.5,XMK,XMZ) H 1
"RTN","XMS",81,0)
 . I ER,$G(ER("NONFATAL")) D
"RTN","XMS",82,0)
 . . K ER S ER=0
"RTN","XMS",83,0)
 . . I $D(^XMB(3.7,.5,2,XMK,1,XMZ,0)) D XP^XMXMSGS1(.5,XMK,XMZ,2) ; Set xmit priority LOW
"RTN","XMS",84,0)
 . . D RSET
"RTN","XMS",85,0)
 . L -^XMNET(XMINST,XMZ)
"RTN","XMS",86,0)
 Q
"RTN","XMS",87,0)
NEXT(XMK) ; Returns the next message (XMZ) in basket XMK to go out.
"RTN","XMS",88,0)
 ; The next XMZ flagged 'high-priority' is next.
"RTN","XMS",89,0)
 ; Barring that, the next 'regular-priority' XMZ is next.
"RTN","XMS",90,0)
 ; Barring that, the next 'low-priority' XMZ is next.
"RTN","XMS",91,0)
 ; If an XMZ was involved in the failure of the previous transmission,
"RTN","XMS",92,0)
 ; that XMZ will be 'low-priority'.
"RTN","XMS",93,0)
 N XMZ,XMOK
"RTN","XMS",94,0)
 S XMZ=$$NEXTPRI(XMK,1) Q:XMZ XMZ  ; Get next high priority msg, if any
"RTN","XMS",95,0)
 S (XMZ,XMOK)=0 ; Get next regular priority msg, if any
"RTN","XMS",96,0)
 F  S XMZ=$O(^XMB(3.7,.5,2,XMK,1,XMZ)) Q:'XMZ  D  Q:XMOK
"RTN","XMS",97,0)
 . Q:$D(^XMB(3.7,.5,2,XMK,1,"AC",2,XMZ))  ; Skip if low priority
"RTN","XMS",98,0)
 . S:$$NEXTOK(XMK,XMZ) XMOK=1 ; Check msg OK
"RTN","XMS",99,0)
 Q:XMZ XMZ
"RTN","XMS",100,0)
 Q $$NEXTPRI(XMK,2)  ; Get next low priority msg, if any
"RTN","XMS",101,0)
NEXTPRI(XMK,XMTPRI) ; Get the next high/low priority message
"RTN","XMS",102,0)
 N XMZ
"RTN","XMS",103,0)
 F  S XMZ=$O(^XMB(3.7,.5,2,XMK,1,"AC",XMTPRI,0)) Q:'XMZ  D  Q:XMZ
"RTN","XMS",104,0)
 . I '$D(^XMB(3.7,.5,2,XMK,1,XMZ,0)) D  Q
"RTN","XMS",105,0)
 . . K ^XMB(3.7,.5,2,XMK,1,"AC",XMTPRI,XMZ) ; msg not in bskt, kill xref
"RTN","XMS",106,0)
 . . S XMZ=0
"RTN","XMS",107,0)
 . I '$$NEXTOK(XMK,XMZ) S XMZ=0 ; Check msg OK
"RTN","XMS",108,0)
 Q XMZ
"RTN","XMS",109,0)
NEXTOK(XMK,XMZ) ; Ensure msg is in file 3.9 & still has recipients q'd 
"RTN","XMS",110,0)
 I $D(^XMB(3.9,XMZ,0)),$O(^XMB(3.9,XMZ,1,"AQUEUE",XMK-1000,0)) Q 1
"RTN","XMS",111,0)
 D ZAPIT^XMXMSGS2(.5,XMK,XMZ)
"RTN","XMS",112,0)
 Q 0
"RTN","XMS",113,0)
QUIT ;
"RTN","XMS",114,0)
 Q:$G(XMC("QUIT"))
"RTN","XMS",115,0)
 S XMSG="QUIT" X XMSEN Q:ER
"RTN","XMS",116,0)
 X XMREC
"RTN","XMS",117,0)
 S XMC("QUIT")=1
"RTN","XMS",118,0)
 Q
"RTN","XMS",119,0)
RSET ; Send: "RSET"
"RTN","XMS",120,0)
 ; Recv: "250"
"RTN","XMS",121,0)
 S XMSG="RSET" X XMSEN Q:ER!XMC("BATCH")
"RTN","XMS",122,0)
 X XMREC Q:ER
"RTN","XMS",123,0)
 I $E(XMRG)'=2 S ER=1
"RTN","XMS",124,0)
 Q
"RTN","XMS",125,0)
TURN(XMINST) ; Turn around channel
"RTN","XMS",126,0)
 ; Send: "TURN"
"RTN","XMS",127,0)
 ; Recv: "250 REMOTE.MED.VA.GOV has messages to export"
"RTN","XMS",128,0)
 ;   or: "502 REMOTE.MED.VA.GOV has no messages to export"
"RTN","XMS",129,0)
 Q:XMC("TURN")!XMC("BATCH")
"RTN","XMS",130,0)
 I $F("Yy",$P(^DIC(4.2,XMINST,0),U,16))>1 D  Q
"RTN","XMS",131,0)
 . D DOTRAN^XMC1(42355.1,XMSITE) ; TURN command disabled for |1|
"RTN","XMS",132,0)
 S XMC("TURN")=1
"RTN","XMS",133,0)
 N XMFDA,XMIENS
"RTN","XMS",134,0)
 S XMIENS=XMINST_","
"RTN","XMS",135,0)
 S XMFDA(4.2999,XMIENS,1)=$H
"RTN","XMS",136,0)
 S XMFDA(4.2999,XMIENS,25)=$S($D(ZTQUEUED):$G(ZTSK),1:"@") ; Task number
"RTN","XMS",137,0)
 D FILE^DIE("","XMFDA")
"RTN","XMS",138,0)
 S XMSG="TURN" X XMSEN Q:ER
"RTN","XMS",139,0)
 X XMREC Q:$E(XMRG)'="2"!ER
"RTN","XMS",140,0)
 D DOTRAN^XMC1(42355) ;Turning around receiver
"RTN","XMS",141,0)
 G RECEIVE^XMR ; Go into receive mode
"RTN","XMS",142,0)
 Q
"RTN","XMS",143,0)
CHRISTN ; Christen the remote domain
"RTN","XMS",144,0)
 S XMSG="CHRS "_XMC("CHRISTEN") X XMSEN Q:ER  X XMREC Q:ER
"RTN","XMS",145,0)
 Q
"RTN","XMS",146,0)
TESTLNK ; Test the link
"RTN","XMS",147,0)
 N XMSTIME,XMETIME,XMTLER,XMCHARS,XMUERR,XMLINES
"RTN","XMS",148,0)
 S XMSG="ECHO" X XMSEN I ER D TESTERR Q
"RTN","XMS",149,0)
 X XMREC I ER D TESTERR Q
"RTN","XMS",150,0)
 S XMSTIME=$$NOW^XLFDT
"RTN","XMS",151,0)
 D TESTIT(.XMLINES,.XMCHARS,.XMUERR,.XMTLER)
"RTN","XMS",152,0)
 S XMETIME=$$NOW^XLFDT
"RTN","XMS",153,0)
 D:ER TESTERR
"RTN","XMS",154,0)
 U IO(0)
"RTN","XMS",155,0)
 D TESTRSLT(XMSTIME,XMETIME,XMLINES,XMCHARS,XMUERR,XMTLER)
"RTN","XMS",156,0)
 Q
"RTN","XMS",157,0)
TESTERR ;
"RTN","XMS",158,0)
 S XMSG="****Physical link protocol error.  Unable to proceed" D TRAN^XMC1
"RTN","XMS",159,0)
 Q
"RTN","XMS",160,0)
TESTIT(XMLINES,XMCHARS,XMUERR,XMTLER) ;
"RTN","XMS",161,0)
 N I
"RTN","XMS",162,0)
 S (I,XMLINES,XMCHARS,XMUERR,XMTLER)=0
"RTN","XMS",163,0)
 F  S I=$O(^TMP("XMS",$J,"S",I)) Q:'I  S XMSG=^(I) D  Q:ER
"RTN","XMS",164,0)
 . S XMLINES=XMLINES+1
"RTN","XMS",165,0)
 . S XMCHARS=XMCHARS+$L(XMSG)
"RTN","XMS",166,0)
 . X XMSEN Q:ER  X XMREC Q:ER
"RTN","XMS",167,0)
 . Q:XMRG=XMSG
"RTN","XMS",168,0)
 . S XMUERR=XMUERR+1
"RTN","XMS",169,0)
 . U IO(0)
"RTN","XMS",170,0)
 . S XMSG="*****Sent:  "_XMSG D TRAN^XMC1
"RTN","XMS",171,0)
 . S XMSG="*****Rec'd: "_XMRG D TRAN^XMC1
"RTN","XMS",172,0)
 . U IO
"RTN","XMS",173,0)
 Q:ER
"RTN","XMS",174,0)
 S XMSG="." X XMSEN Q:ER  X XMREC
"RTN","XMS",175,0)
 Q
"RTN","XMS",176,0)
TESTRSLT(XMSTIME,XMETIME,XMLINES,XMCHARS,XMUERR,XMTLER) ;
"RTN","XMS",177,0)
 S XMSG=XMLINES_" Lines,"_XMCHARS_" characters transmitted." D TRAN^XMC1
"RTN","XMS",178,0)
 S XMSG="Errors detected: "_XMUERR_" unrecoverable, "_XMTLER_" recoverable."
"RTN","XMS",179,0)
 S XMSG=$J(XMCHARS/$$FMDIFF^XLFDT(XMETIME,XMSTIME,2),0,1)_" chars/sec effective transmission rate." D TRAN^XMC1
"RTN","XMS",180,0)
 Q
"RTN","XMS0")
1^61
"RTN","XMS0A")
1^62
"RTN","XMS0BLOB")
0^63^B13857394
"RTN","XMS0BLOB",1,0)
XMS0BLOB ;(WASH ISC)/CAP-Send BLOBs (other body parts) ;04/18/2002  07:52
"RTN","XMS0BLOB",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMS0BLOB",3,0)
 ;
"RTN","XMS0BLOB",4,0)
 ;This routine sends BLOBS (Basic Large Objects), also known in the
"RTN","XMS0BLOB",5,0)
 ;messaging world as 'Other Body Parts' of messages.
"RTN","XMS0BLOB",6,0)
 ;It can do this only with MailMan systems after (not including)
"RTN","XMS0BLOB",7,0)
 ;version 7.0.
"RTN","XMS0BLOB",8,0)
 ;
"RTN","XMS0BLOB",9,0)
 ;A second portion of this code will be able to send to TCP/IP-SMTP
"RTN","XMS0BLOB",10,0)
 ;systems that conform to MIME (MEE-MEE), an extension of RFC-822 that
"RTN","XMS0BLOB",11,0)
 ;MailMan will conform to when dealing with MIME compatible structures.
"RTN","XMS0BLOB",12,0)
 ;
"RTN","XMS0BLOB",13,0)
 ;See XMR0BLOB for documentation on MPDUs (Message Protocol Data Units)
"RTN","XMS0BLOB",14,0)
 ;exchanged between sender and receiver.
"RTN","XMS0BLOB",15,0)
 ;
"RTN","XMS0BLOB",16,0)
 ;Get data on BLOB from Imaging files
"RTN","XMS0BLOB",17,0)
 S XMSBLOBX=0
"RTN","XMS0BLOB",18,0)
0 S XMSBLOBX=$O(^XMB(3.9,XMZ,2005,XMSBLOBX)) G Q:XMSBLOBX="" S Y=$G(^(XMSBLOBX,0)) G 0:Y=""
"RTN","XMS0BLOB",19,0)
 S X=+Y,ER=0,Y=$G(^MAG(2005,X,0)) G 0:Y=""
"RTN","XMS0BLOB",20,0)
 S XMSBLOBT=Y,XMSBLOBT("#")=X,XMSBLOBT("NAME")=$P(Y,U),XMSBLOBT("FILE")=$P(Y,U,2),XMSBLOBT("DATE")=$P(Y,U,9)
"RTN","XMS0BLOB",21,0)
 S Y(0)="" F %=3,4,5 S X=$P(Y,U,%) I X S Y(0)=$G(^MAG(2005.2,X,0)) Q:$L(Y(0))
"RTN","XMS0BLOB",22,0)
 G 0:'$L(Y(0)) ;BLOB can not be sent -- no known disk reference
"RTN","XMS0BLOB",23,0)
 S XMSBLOBT("DISK")=$P(Y(0),U,2),DIC=2005.02,DIC(0)="NZ"
"RTN","XMS0BLOB",24,0)
 S X=$P(XMSBLOBT,U,6) D ^DIC G 0:Y<1 S XMSBLOBT("TYPE")=$P(Y,U,2)
"RTN","XMS0BLOB",25,0)
 ;
"RTN","XMS0BLOB",26,0)
 ;Send MPDU (Message Protocol Data Unit), Directory to send to returned
"RTN","XMS0BLOB",27,0)
 ;
"RTN","XMS0BLOB",28,0)
 S XMSG="MESS BLOB: "_XMSBLOBT("FILE")_"^"_XMSBLOBT("NAME")_"^"_XMSBLOBT("TYPE")_"^"_XMSBLOBT("DATE")
"RTN","XMS0BLOB",29,0)
1 X XMSEN Q:ER  X XMREC Q:ER  I +XMRG'=250 G 0:$E(XMRG)=4 K ^XMB(3.9,XMZ,1,"AQUEUE",XMINST) N XMA0 S XMA0=XMCI_U_XMINST_U_XMZ D ERRR S XMINST=$P(XMA0,U,2),XMBLOBER=1,XMCI=$P(XMA0,U),XMZ=$P(XMA0,U,3) Q
"RTN","XMS0BLOB",30,0)
 ;
"RTN","XMS0BLOB",31,0)
 ;Determine IP address to send BLOB to / Use domain file data if it exists
"RTN","XMS0BLOB",32,0)
 S %=$P(XMRG,U,2),X=$P($G(^DIC(4.2,XMINST,"IP")),U),%=$S($L(X):X,$L(%):%,1:"")
"RTN","XMS0BLOB",33,0)
 I %="" S XMSG="MESS BLOB: < BLOB(s) not sent - No FTP channel defined !!! >" X XMSEN G ERR
"RTN","XMS0BLOB",34,0)
 S XMSBLOBT("IP")=%
"RTN","XMS0BLOB",35,0)
 ;
"RTN","XMS0BLOB",36,0)
 ;FTP file to remote site
"RTN","XMS0BLOB",37,0)
 ;
"RTN","XMS0BLOB",38,0)
 K XMSFTP S XMSFTP(1)=$P($G(^XMB(1,1,"FTP-GET")),U),XMSFTP(2)=$P(XMRG,U,5),XMSFTP(2,"F")=XMSBLOBT("FILE"),XMSFTP(3)=XMSBLOBT("IP"),XMSFTP("IMAGE-PTR")=XMSBLOBT("#")
"RTN","XMS0BLOB",39,0)
 F I=6,7,8 S XMSFTP(I)=$P(XMRG,U,I)
"RTN","XMS0BLOB",40,0)
 I '$L($G(XMSFTP(6))) S %=$G(^DIC(4.2,XMINST,3)) I $L(%) S XMSFTP(7)=$P(%,";"),XMSFTP(7.1)=$P(%,";",2)
"RTN","XMS0BLOB",41,0)
 D ^XMSFTP K XMSFTP
"RTN","XMS0BLOB",42,0)
 G 0
"RTN","XMS0BLOB",43,0)
 ;
"RTN","XMS0BLOB",44,0)
 ;Record error, set error flag to RESET message transmission,
"RTN","XMS0BLOB",45,0)
 ;remove message from queue, send message to sender.
"RTN","XMS0BLOB",46,0)
ERRR N ER,XMA0
"RTN","XMS0BLOB",47,0)
ERR ;
"RTN","XMS0BLOB",48,0)
 N I,XMTEXT,XMSEN,XMREC,XMRECIP,XMSITE,XMSUBJ,XMIEN,XMTO,XMINSTR
"RTN","XMS0BLOB",49,0)
 S XMINSTR("FROM")=.5
"RTN","XMS0BLOB",50,0)
 S XMSUBJ="TRANSMISSION ERROR (Non-Textual Body-Part Message [BLOB])"
"RTN","XMS0BLOB",51,0)
 S XMTEXT(1)="Error (sending your Multi-Body-Part Message):"
"RTN","XMS0BLOB",52,0)
 S XMTEXT(2)=" "
"RTN","XMS0BLOB",53,0)
 S XMTEXT(3)="Subject: "_$P(XMR,U)
"RTN","XMS0BLOB",54,0)
 S XMTEXT(4)=" "
"RTN","XMS0BLOB",55,0)
 S XMTEXT(5)=XMSG
"RTN","XMS0BLOB",56,0)
 S XMTEXT(6)=" "
"RTN","XMS0BLOB",57,0)
 S XMTEXT(7)="The message was not sent.  It was removed from the transmission queue."
"RTN","XMS0BLOB",58,0)
 S XMTEXT(8)="You should get this problem fixed and reforward this message"
"RTN","XMS0BLOB",59,0)
 S XMSITE=$P(^DIC(4.2,XMINST,0),U)
"RTN","XMS0BLOB",60,0)
 S XMTEXT(9)="to the recipients at "_XMSITE_":"
"RTN","XMS0BLOB",61,0)
 S XMRECIP=":",I=9
"RTN","XMS0BLOB",62,0)
 F  S XMRECIP=$O(^XMB(3.9,XMZ,1,"C",XMRECIP)) Q:XMRECIP=""  D
"RTN","XMS0BLOB",63,0)
 . S XMIEN=""
"RTN","XMS0BLOB",64,0)
 . F  S XMIEN=$O(^XMB(3.9,XMZ,1,"C",XMRECIP,XMIEN)) Q:XMIEN=""  D
"RTN","XMS0BLOB",65,0)
 . . S XMREC=$G(^XMB(3.9,XMZ,1,XMIEN,0))
"RTN","XMS0BLOB",66,0)
 . . Q:$P($P(XMREC,U,1),"@",2)'=XMSITE
"RTN","XMS0BLOB",67,0)
 . . S I=I+1,XMTEXT(I)=$P(XMREC,U,1)
"RTN","XMS0BLOB",68,0)
 . . S XMFWDBY=$P($G(^XMB(3.9,XMZ,1,XMIEN,"F")),U,2)
"RTN","XMS0BLOB",69,0)
 . . S:XMFWDBY'="" XMTO(XMFWDBY)=""
"RTN","XMS0BLOB",70,0)
 S:'$D(XMTO) XMTO($P(XMR,U,2))=""  ; Sender of the message
"RTN","XMS0BLOB",71,0)
 D SENDMSG^XMXSEND(.5,XMSUBJ,"XMTEXT",XMTO,.XMINSTR)
"RTN","XMS0BLOB",72,0)
 Q
"RTN","XMS0BLOB",73,0)
 ;Clean up and quit
"RTN","XMS0BLOB",74,0)
Q K XMSBLOBT,XMSBLOBX,DIC Q
"RTN","XMS0BLOB",75,0)
 ;
"RTN","XMS0BLOB",76,0)
TEST S XMSEN="Q",XMREC="S XMRG=250",XMZ=18067
"RTN","XMS0BLOB",77,0)
 G XMS0BLOB
"RTN","XMS1")
0^64^B43515829
"RTN","XMS1",1,0)
XMS1 ;ISC-SF/GMB-SMTP Send (RFC 821) ;05/20/2002  08:40
"RTN","XMS1",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMS1",3,0)
 ; Was ISC-WASH/THM/CAP
"RTN","XMS1",4,0)
 ;
"RTN","XMS1",5,0)
 ; Entry points (DBIA 1151):
"RTN","XMS1",6,0)
 ; $$SRVTIME Set message transmission status information
"RTN","XMS1",7,0)
 ; $$STATUS  Get message transmission status information
"RTN","XMS1",8,0)
SENDMSG(XMK,XMZ,XMB) ;
"RTN","XMS1",9,0)
 N XMZREC,XMNVFROM,XMFROM,XMRCPT,XMNETNAM,XMRZ,XMCM
"RTN","XMS1",10,0)
 ; XMCM("START") - timestamp at start of msg xmit
"RTN","XMS1",11,0)
 ; XMCM("START","FM") - FM date/time (no seconds) at start of msg xmit
"RTN","XMS1",12,0)
 K XMTLER,XMBLOCK,XMLIN
"RTN","XMS1",13,0)
 D INIT(XMINST,XMZ,.XMZREC,.XMNVFROM,.XMFROM,.XMNETNAM)
"RTN","XMS1",14,0)
 D ENVELOPE(XMNETNAM,XMINST,XMZ,XMZREC,XMNVFROM,.XMRZ,.XMRCPT) Q:ER
"RTN","XMS1",15,0)
 D FINISH(XMINST,XMZ,XMRZ)
"RTN","XMS1",16,0)
 Q
"RTN","XMS1",17,0)
INIT(XMINST,XMZ,XMZREC,XMNVFROM,XMFROM,XMNETNAM) ;
"RTN","XMS1",18,0)
 N XMFDA,XMIENS
"RTN","XMS1",19,0)
 S XMIENS=XMINST_","
"RTN","XMS1",20,0)
 S XMFDA(4.2999,XMIENS,1)=$H
"RTN","XMS1",21,0)
 S XMFDA(4.2999,XMIENS,2)=XMZ ; Message in transit
"RTN","XMS1",22,0)
 ;S XMFDA(4.2999,XMIENS,3)="@" ; Last line xmit'd
"RTN","XMS1",23,0)
 D FILE^DIE("","XMFDA")
"RTN","XMS1",24,0)
 S XMNETNAM=^XMB("NETNAME")
"RTN","XMS1",25,0)
 S XMCM("START")=$$TSTAMP^XMXUTIL1
"RTN","XMS1",26,0)
 S XMCM("START","FM")=+$E($$NOW^XLFDT,1,12) ; Strip off the seconds
"RTN","XMS1",27,0)
 S XMZREC=^XMB(3.9,XMZ,0)
"RTN","XMS1",28,0)
 S XMFROM=$$FROM($P(XMZREC,U,2),XMNETNAM)
"RTN","XMS1",29,0)
 S XMNVFROM=$P($G(^XMB(3.9,XMZ,.7)),U,1) ; envelope from
"RTN","XMS1",30,0)
 I XMNVFROM="" S XMNVFROM=XMFROM
"RTN","XMS1",31,0)
 Q
"RTN","XMS1",32,0)
ENVELOPE(XMNETNAM,XMINST,XMZ,XMZREC,XMNVFROM,XMRZ,XMRCPT) ;
"RTN","XMS1",33,0)
 ; These commands are part of RFC 821 - SMTP.
"RTN","XMS1",34,0)
 N XMRSET
"RTN","XMS1",35,0)
 D MAIL(XMZ,XMZREC,.XMNVFROM,.XMRZ) Q:ER
"RTN","XMS1",36,0)
 D RCPT(XMNETNAM,XMINST,XMZ,XMZREC,XMNVFROM,.XMRCPT) Q:ER
"RTN","XMS1",37,0)
 ;I 'XMC("MAILMAN") D CHEKSPEC^XMS2(XMZREC)
"RTN","XMS1",38,0)
 I XMC("MAILMAN") D NONSTD^XMS2(XMNETNAM,XMZ,XMZREC,.XMRZ,.XMRSET) Q:ER
"RTN","XMS1",39,0)
 D DATACMD Q:ER
"RTN","XMS1",40,0)
 I $G(XMRSET) D  Q:ER  ; Send: "" (if 'duplicate message')
"RTN","XMS1",41,0)
 . S XMSG="" X XMSEN
"RTN","XMS1",42,0)
 E  D  Q:ER  ; Send: header records followed by message text
"RTN","XMS1",43,0)
 . I '$D(^XMB(3.9,XMZ,2,.001)) D  Q:ER
"RTN","XMS1",44,0)
 . . D HEADER^XMS3(XMZ,XMZREC,XMFROM,XMNETNAM) Q:ER
"RTN","XMS1",45,0)
 . . S XMSG="" X XMSEN Q:ER
"RTN","XMS1",46,0)
 . D TEXT^XMS3(XMZ)
"RTN","XMS1",47,0)
 ; Send: "."
"RTN","XMS1",48,0)
 ; Recv: "250 'data' accepted"
"RTN","XMS1",49,0)
 ;   or: "254 Duplicate (no add'l recipients).  Msg rejected."
"RTN","XMS1",50,0)
 ;   or: "551 Too many lines.  Msg rejected."
"RTN","XMS1",51,0)
 ;   or: "554 Duplicate (purged).  Msg rejected."
"RTN","XMS1",52,0)
 ;   or: "555 Reply to 'Info Only'.  Msg rejected."
"RTN","XMS1",53,0)
 S XMSG="." X XMSEN Q:ER
"RTN","XMS1",54,0)
 I 'XMC("BATCH") S XMSTIME=300 X XMREC K XMSTIME Q:ER
"RTN","XMS1",55,0)
 S:XMC("BATCH") XMRG="250 OK"
"RTN","XMS1",56,0)
 Q:$E(XMRG)=2
"RTN","XMS1",57,0)
 S (ER,ER("NONFATAL"))=1
"RTN","XMS1",58,0)
 I "^551^554^555^"'[(U_$E(XMRG,1,3)_U) Q
"RTN","XMS1",59,0)
 S XMRZ=$P(XMRG," ",2,99)
"RTN","XMS1",60,0)
 D MSGERR^XMS3(XMSITE,XMINST,XMRG,XMZ,XMZREC,XMNVFROM,.XMRCPT)
"RTN","XMS1",61,0)
 Q
"RTN","XMS1",62,0)
DATACMD ; Send: "DATA"
"RTN","XMS1",63,0)
 ; Recv: "354 Enter data"
"RTN","XMS1",64,0)
 S XMSG="DATA" X XMSEN Q:ER
"RTN","XMS1",65,0)
 I 'XMC("BATCH") X XMREC Q:ER
"RTN","XMS1",66,0)
 S:XMC("BATCH") XMRG=300
"RTN","XMS1",67,0)
 Q:$E(XMRG)=3
"RTN","XMS1",68,0)
 D ERTRAN^XMC1(42356) ;Receiver will not accept DATA.
"RTN","XMS1",69,0)
 S ER("MSG")=XMTRAN_" - "_XMRG
"RTN","XMS1",70,0)
 Q
"RTN","XMS1",71,0)
MAIL(XMZ,XMZREC,XMNVFROM,XMRZ) ; Send mail
"RTN","XMS1",72,0)
 ; Send: "MAIL FROM:<USER.JOE@LOCAL.MED.VA.GOV>"
"RTN","XMS1",73,0)
 ; Recv: "250 OK Message-ID:123456@REMOTE.MED.VA.GOV"
"RTN","XMS1",74,0)
 S XMSG="MAIL FROM:"_XMNVFROM X XMSEN Q:ER
"RTN","XMS1",75,0)
 I 'XMC("BATCH") S XMSTIME=300 X XMREC K XMSTIME Q:ER
"RTN","XMS1",76,0)
 I XMC("BATCH") S XMRG="200 ID:Batch"
"RTN","XMS1",77,0)
 I $E(XMRG)'=2 D  Q
"RTN","XMS1",78,0)
 . S (ER,ER("NONFATAL"))=1
"RTN","XMS1",79,0)
 . Q:"^501^502^553^"'[(U_$E(XMRG,1,3)_U)
"RTN","XMS1",80,0)
 . ; 501: Exchange says Syntax error
"RTN","XMS1",81,0)
 . ; 502: MailMan says it won't accept msgs from you.
"RTN","XMS1",82,0)
 . ; 553: Exchange says something's wrong with your FROM address.
"RTN","XMS1",83,0)
 . D MSGERR^XMS3(XMSITE,XMINST,XMRG,XMZ,XMZREC,XMNVFROM)
"RTN","XMS1",84,0)
 S XMRZ=$P(XMRG,"ID:",2)
"RTN","XMS1",85,0)
 Q
"RTN","XMS1",86,0)
FROM(XMFROM,XMNETNAM) ;
"RTN","XMS1",87,0)
 I $F(XMFROM,"@"_XMNETNAM)>$L(XMFROM) S XMFROM=$P(XMFROM,"@"_XMNETNAM)
"RTN","XMS1",88,0)
 I XMFROM'["@" Q "<"_$$NETNAME^XMXUTIL(XMFROM)_">"
"RTN","XMS1",89,0)
 Q "<"_$$REMADDR^XMXADDR3(XMFROM)_">"
"RTN","XMS1",90,0)
RCPT(XMNETNAM,XMINST,XMZ,XMZREC,XMNVFROM,XMRCPT) ; Identify Recipients
"RTN","XMS1",91,0)
 ; Send: "RCPT TO:<USER.JANE@REMOTE.MED.VA.GOV>"
"RTN","XMS1",92,0)
 ; Recv: "250 'RCPT' accepted"
"RTN","XMS1",93,0)
 ;   or: "550 Addressee not found." or "550 Addressee ambiguous."
"RTN","XMS1",94,0)
 ;
"RTN","XMS1",95,0)
 ; When communicating with a MailMan site, we also can add non-standard
"RTN","XMS1",96,0)
 ; information on who forwarded the message to this recipient, and/or
"RTN","XMS1",97,0)
 ; whether the recipient is 'information only' or 'copy'.
"RTN","XMS1",98,0)
 ; Send: "RCPT TO:<I:USER.JANE@REMOTE.MED.VA.GOV> FWD BY:<USER.LEX@LOCAL.MED.VA.GOV>"
"RTN","XMS1",99,0)
 N XMIEN,XMTO,XMTOREC,XMPREFIX,XMTOX,XMTRY,XMFWDBY,XM2MANY
"RTN","XMS1",100,0)
 S (XMIEN,XM2MANY)=0
"RTN","XMS1",101,0)
 F  S XMIEN=$O(^XMB(3.9,XMZ,1,"AQUEUE",XMINST,XMIEN)) Q:XMIEN=""  D  Q:ER!XM2MANY
"RTN","XMS1",102,0)
 . S XMTOREC=$G(^XMB(3.9,XMZ,1,XMIEN,0))
"RTN","XMS1",103,0)
 . I $P(XMTOREC,U,7)'=XMINST D  Q
"RTN","XMS1",104,0)
 . . K ^XMB(3.9,XMZ,1,"AQUEUE",XMINST,XMIEN)
"RTN","XMS1",105,0)
 . I XMC("MAILMAN") D
"RTN","XMS1",106,0)
 . . S XMPREFIX=$P($G(^XMB(3.9,XMZ,1,XMIEN,"T")),U)
"RTN","XMS1",107,0)
 . . S XMFWDBY=$G(^XMB(3.9,XMZ,1,XMIEN,"F"))
"RTN","XMS1",108,0)
 . . I XMFWDBY'="" S XMFWDBY=$$FWDBY(XMFWDBY)
"RTN","XMS1",109,0)
 . E  S (XMPREFIX,XMFWDBY)=""
"RTN","XMS1",110,0)
 . S XMTO=$$TOFORMAT($P(XMTOREC,U),XMPREFIX)
"RTN","XMS1",111,0)
 . S XMSG="RCPT TO:<"_XMTO_">"_$S(XMFWDBY="":"",1:" FWD BY:"_XMFWDBY) X XMSEN Q:ER
"RTN","XMS1",112,0)
 . I 'XMC("BATCH") S XMSTIME=300 X XMREC K XMSTIME Q:ER
"RTN","XMS1",113,0)
 . I XMC("BATCH") S XMRG="250 In transit"
"RTN","XMS1",114,0)
 . I $E(XMRG,1,2)=25 S XMRCPT(XMIEN)="" Q
"RTN","XMS1",115,0)
 . I $E(XMRG,1,3)=552 S XM2MANY=1 Q  ; 552: Too many recipients / exceed storage allocation
"RTN","XMS1",116,0)
 . I $E(XMRG,1,3)=221 S ER=1 Q  ; 221: Closing Connection
"RTN","XMS1",117,0)
 . D RCPTERR^XMS3(XMRG,XMZ,XMZREC,XMNVFROM,$P(XMTOREC,U),XMTO,XMIEN)
"RTN","XMS1",118,0)
 S:'$D(XMRCPT) (ER,ER("NONFATAL"))=1
"RTN","XMS1",119,0)
 Q
"RTN","XMS1",120,0)
TOFORMAT(XMTO,XMPREFIX) ;
"RTN","XMS1",121,0)
 N XMDOM
"RTN","XMS1",122,0)
 S XMDOM=$S(XMTO["@":$P(XMTO,"@",2,99),1:XMNETNAM)
"RTN","XMS1",123,0)
 S XMTO=$$TO($P(XMTO,"@"))
"RTN","XMS1",124,0)
 Q $S(XMPREFIX="":"",$E(XMTO,1)=$C(34):"",1:XMPREFIX_":")_XMTO_"@"_XMDOM
"RTN","XMS1",125,0)
TO(XMTO) ;
"RTN","XMS1",126,0)
 I XMTO?.E1C.E S XMTO=$$CTRL^XMXUTIL1(XMTO)
"RTN","XMS1",127,0)
 Q:XMTO?.A XMTO
"RTN","XMS1",128,0)
 I $E(XMTO)=$C(34),$E(XMTO,$L(XMTO))=$C(34) Q XMTO
"RTN","XMS1",129,0)
 ; If we translate blanks to underscores, we have to be careful with
"RTN","XMS1",130,0)
 ; G. and S. names which contain blanks.  ^XMXADDR* looks for G. and
"RTN","XMS1",131,0)
 ; S. names, and it will translate them back, if necessary.
"RTN","XMS1",132,0)
 ; But Austin is running pre-patch 50 v7.1 MailMan code, which will not
"RTN","XMS1",133,0)
 ; translate them back.  So... for G. and S., we will only translate
"RTN","XMS1",134,0)
 ; when sending to non-MailMan sites.
"RTN","XMS1",135,0)
 I XMTO[","!XMTO[" " D
"RTN","XMS1",136,0)
 . I ".G.g.D.d.H.h.S.s."[("."_$E(XMTO,1,2)),XMC("MAILMAN") Q
"RTN","XMS1",137,0)
 . S XMTO=$TR(XMTO,", .","._+")
"RTN","XMS1",138,0)
 ;Allowed punctuation (without quoting rcpt name is .%_-@+!
"RTN","XMS1",139,0)
 I $TR(XMTO,"()<>@,;:\[]"_$C(34),"")=XMTO Q XMTO
"RTN","XMS1",140,0)
 N I,% ; Reformat name for \ and " characters
"RTN","XMS1",141,0)
 F %="\",$C(34) D
"RTN","XMS1",142,0)
 . S I=0
"RTN","XMS1",143,0)
 . F  S I=$F(XMTO,%,I+1) Q:'I  S XMTO=$E(XMTO,1,I-2)_"\"_$E(XMTO,I-1,999)
"RTN","XMS1",144,0)
 Q XMTO
"RTN","XMS1",145,0)
FWDBY(XMFREC) ;
"RTN","XMS1",146,0)
 I $E(XMFREC,1)=" " Q ""
"RTN","XMS1",147,0)
 I $E(XMFREC,1)="<" Q $P(XMFREC,">",1)_">"
"RTN","XMS1",148,0)
 N XMFDUZ
"RTN","XMS1",149,0)
 S XMFDUZ=$P(XMFREC,U,2)
"RTN","XMS1",150,0)
 I +XMFDUZ=XMFDUZ Q "<"_$$NETNAME^XMXUTIL(XMFDUZ)_">"
"RTN","XMS1",151,0)
 Q ""
"RTN","XMS1",152,0)
FINISH(XMINST,XMZ,XMRZ) ;
"RTN","XMS1",153,0)
 D XMTHIST^XMTDR(XMINST,"S",$P($G(^XMB(3.9,XMZ,2,0)),U,4))
"RTN","XMS1",154,0)
 N XMIEN,XMIENS
"RTN","XMS1",155,0)
 S XMIEN=0
"RTN","XMS1",156,0)
 F  S XMIEN=$O(XMRCPT(XMIEN)) Q:'XMIEN  D
"RTN","XMS1",157,0)
 . N XMFDA
"RTN","XMS1",158,0)
 . S XMIENS=XMIEN_","_XMZ_","
"RTN","XMS1",159,0)
 . S XMFDA(3.91,XMIENS,3)=XMRZ   ; remote msg id
"RTN","XMS1",160,0)
 . S XMFDA(3.91,XMIENS,4)=XMCM("START","FM") ; xmit date/time
"RTN","XMS1",161,0)
 . S XMFDA(3.91,XMIENS,5)=$S(XMC("BATCH"):$$EZBLD^DIALOG(39303.6),1:"@")   ; status: In transit
"RTN","XMS1",162,0)
 . S XMFDA(3.91,XMIENS,6)="@"    ; path
"RTN","XMS1",163,0)
 . S XMFDA(3.91,XMIENS,9)=$$TSTAMP^XMXUTIL1-XMCM("START") ; xmit time (seconds)
"RTN","XMS1",164,0)
 . D FILE^DIE("","XMFDA")
"RTN","XMS1",165,0)
 . S $P(^XMB(3.9,XMZ,1,XMIEN,0),U,7)=XMINST_":"_XMINST ; violates the DD, but we've always done this, and it might help in debugging.
"RTN","XMS1",166,0)
 Q
"RTN","XMS1",167,0)
 ; The following have nothing to do with the above.
"RTN","XMS1",168,0)
 ; They are simply here because of an existing DBIA.
"RTN","XMS1",169,0)
STATUS(XMZ,XMRECIP) ; Get Recipient Status
"RTN","XMS1",170,0)
 N XMIEN
"RTN","XMS1",171,0)
 S XMIEN=$$FIND1^DIC(3.91,","_XMZ_",","QX",XMRECIP,"C") Q:'XMIEN ""
"RTN","XMS1",172,0)
 Q $P($G(^XMB(3.9,XMZ,1,XMIEN,0)),U,6)
"RTN","XMS1",173,0)
SRVTIME(XMZ,XMRECIP,XMSTRING) ; Set Recipient Status
"RTN","XMS1",174,0)
 ;Returns 0 for success, 1 for failure
"RTN","XMS1",175,0)
 ;Parameters=(Message#,Recipient,Status)
"RTN","XMS1",176,0)
 I $L(XMSTRING)>30 Q "2 Status too long"
"RTN","XMS1",177,0)
 I XMSTRING[U Q "3 Bad Characters in Status"
"RTN","XMS1",178,0)
 N XMIEN,XMIENS
"RTN","XMS1",179,0)
 S XMIEN=$$FIND1^DIC(3.91,","_XMZ_",","QX",XMRECIP,"C") Q:'XMIEN "1 No Update"
"RTN","XMS1",180,0)
 S XMIENS=XMIEN_","_XMZ_","
"RTN","XMS1",181,0)
 D SETSTAT^XMTDO(XMIENS,XMSTRING)
"RTN","XMS1",182,0)
 Q 0
"RTN","XMS1P")
1^65
"RTN","XMS2")
0^66^B13825076
"RTN","XMS2",1,0)
XMS2 ;ISC-SF/GMB-SMTP Send (non-standard) ;04/25/2002  14:14
"RTN","XMS2",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMS2",3,0)
NONSTD(XMNETNAM,XMZ,XMZREC,XMRZ,XMRSET) ; Non-Standard commands,
"RTN","XMS2",4,0)
 ; used only when communicating with other MailMan sites.
"RTN","XMS2",5,0)
 I $O(^XMB(3.9,XMZ,2005,0)),XMC("MAILMAN")>7 D  Q:ER
"RTN","XMS2",6,0)
 . N XMBLOBER ; Send other Body parts
"RTN","XMS2",7,0)
 . S XMBLOBER=0
"RTN","XMS2",8,0)
 . D ^XMS0BLOB
"RTN","XMS2",9,0)
 . I XMBLOBER S ER=1,ER("NONFATAL")=1
"RTN","XMS2",10,0)
 D MESSID(XMNETNAM,XMZ,.XMRZ,.XMRSET) Q:ER!$G(XMRSET)
"RTN","XMS2",11,0)
 I XMC("MAILMAN")<8 D  Q:ER
"RTN","XMS2",12,0)
 . D SPECIAL(XMZREC) Q:ER
"RTN","XMS2",13,0)
 E  D  Q:ER
"RTN","XMS2",14,0)
 . D LINES Q:ER!$G(XMRSET)
"RTN","XMS2",15,0)
 Q
"RTN","XMS2",16,0)
MESSID(XMNETNAM,XMZ,XMRZ,XMRSET) ;
"RTN","XMS2",17,0)
 ; This is a head's up on which message is being sent, and allows the
"RTN","XMS2",18,0)
 ; receiving site to say, "don't bother, I've already received it long
"RTN","XMS2",19,0)
 ; ago and it's already been purged." or "I've already got it, so don't
"RTN","XMS2",20,0)
 ; bother sending the text again, but maybe you've got some new
"RTN","XMS2",21,0)
 ; recipients for me."
"RTN","XMS2",22,0)
 ; Send: "MESS ID:654321@LOCAL.MED.VA.GOV"
"RTN","XMS2",23,0)
 ; Recv: "250 OK"
"RTN","XMS2",24,0)
 ;   or: "RSET :21212@REMOTE.MED.VA.GOV:Duplicate purged"
"RTN","XMS2",25,0)
 ;   or: "RSET :21212@REMOTE.MED.VA.GOV:Previously received"
"RTN","XMS2",26,0)
 N XMREMID
"RTN","XMS2",27,0)
 S XMREMID=$$NETID^XMS3(XMZ)
"RTN","XMS2",28,0)
 I XMREMID="" D  Q
"RTN","XMS2",29,0)
 . ; *** Maybe the thing to do here is to just assign it a net id
"RTN","XMS2",30,0)
 . ; *** and go on our merry way.
"RTN","XMS2",31,0)
 . D ERTRAN^XMC1(42357) ;Msg transmit aborted - remote msg with no remote msg ID
"RTN","XMS2",32,0)
 . S ER("NONFATAL")=1
"RTN","XMS2",33,0)
 . D DOTRAN^XMC1("")
"RTN","XMS2",34,0)
 . N XMPARM,XMINSTR
"RTN","XMS2",35,0)
 . S XMINSTR("FROM")="POSTMASTER"
"RTN","XMS2",36,0)
 . S XMPARM(1)=XMZ
"RTN","XMS2",37,0)
 . D TASKBULL^XMXBULL(.5,"XM SEND ERR REMOTE MSG ID",.XMPARM,"",.5,.XMINSTR)
"RTN","XMS2",38,0)
 S XMSG="MESS ID:"_XMREMID X XMSEN Q:ER
"RTN","XMS2",39,0)
 X XMREC Q:ER
"RTN","XMS2",40,0)
 I $E(XMRG,1,4)="RSET" S XMRSET=1,XMRZ=$P(XMRG,":",2) Q
"RTN","XMS2",41,0)
 Q
"RTN","XMS2",42,0)
LINES ; If message is at least 1000 lines, and it's not a PackMan message,
"RTN","XMS2",43,0)
 ; let the other site know.  If the other site says it's too many lines,
"RTN","XMS2",44,0)
 ; we don't have to bother with the text.
"RTN","XMS2",45,0)
 N XMLINES
"RTN","XMS2",46,0)
 S XMLINES=$$LINE^XMXUTIL2(XMZ) Q:XMLINES<1000
"RTN","XMS2",47,0)
 Q:$$PAKMAN^XMXSEC1(XMZ)
"RTN","XMS2",48,0)
 S XMSG="MESS LINES:"_XMLINES X XMSEN Q:ER
"RTN","XMS2",49,0)
 X XMREC Q:ER
"RTN","XMS2",50,0)
 I $E(XMRG,1,4)="RSET" S XMRSET=1 Q
"RTN","XMS2",51,0)
 Q
"RTN","XMS2",52,0)
SPECIAL(XMZREC) ; Special message characteristics
"RTN","XMS2",53,0)
 ;I 'XMC("MAILMAN") D CHEKSPEC(XMINST,XMSITE,XMZ,XMZREC,XMNVFROM) Q
"RTN","XMS2",54,0)
 N I
"RTN","XMS2",55,0)
 S I=7 I $P(XMZREC,U,I)'="" D SPECSEND(I,$P(XMZREC,U,I)) Q:ER
"RTN","XMS2",56,0)
 Q:ER
"RTN","XMS2",57,0)
 F I=5,9,11,12 I "^Y^y^"[(U_$P(XMZREC,U,I)_U) D SPECSEND(I,$P(XMZREC,U,I)) Q:ER
"RTN","XMS2",58,0)
 Q:ER
"RTN","XMS2",59,0)
 Q
"RTN","XMS2",60,0)
SPECSEND(I,XMVAL) ;
"RTN","XMS2",61,0)
 S XMSG="MESS "_$P("^^^^CONFIRMATION^^TYPE^^CLOSED^^CONFIDENTIAL^INFO",U,I)_":"_XMVAL X XMSEN Q:ER
"RTN","XMS2",62,0)
 X XMREC
"RTN","XMS2",63,0)
 Q
"RTN","XMS2",64,0)
 ; *** The following is not used ***
"RTN","XMS2",65,0)
CHEKSPEC(XMINST,XMSITE,XMZ,XMZREC,XMNVFROM) ; If special VA-only instructions exist, send msg to user
"RTN","XMS2",66,0)
 N I,XMSPEC
"RTN","XMS2",67,0)
 F I=6,7 I $P(XMZREC,U,I)'="" D SPECSET(I,.XMSPEC)
"RTN","XMS2",68,0)
 F I=5,9,11,12 I "^Y^y^"[(U_$P(XMZREC,U,I)_U) D SPECSET(I,.XMSPEC)
"RTN","XMS2",69,0)
 Q:'$D(XMSPEC)
"RTN","XMS2",70,0)
 N XMTEXT,J,XMINSTR,XMTO,XMIEN
"RTN","XMS2",71,0)
 S XMINSTR("FROM")="POSTMASTER"
"RTN","XMS2",72,0)
 S I=0
"RTN","XMS2",73,0)
 S I=I+1,XMTEXT(I)="Your message to "_XMSITE_","
"RTN","XMS2",74,0)
 S I=I+1,XMTEXT(I)="Subject: "_$P(XMZREC,U,1)_" ["_XMZ_"]"
"RTN","XMS2",75,0)
 S I=I+1,XMTEXT(I)="will not include any special instructions, since that site"
"RTN","XMS2",76,0)
 S I=I+1,XMTEXT(I)="is running a very old MailMan version: "_XMC("MAILMAN")
"RTN","XMS2",77,0)
 S I=I+1,XMTEXT(I)=""
"RTN","XMS2",78,0)
 S I=I+1,XMTEXT(I)="The special instructions to be ignored are:"
"RTN","XMS2",79,0)
 S I=I+1,XMTEXT(I)=""
"RTN","XMS2",80,0)
 S J=""
"RTN","XMS2",81,0)
 F  S J=$O(XMSPEC(J)) Q:J=""  S I=I+1,XMTEXT(I)="   "_J
"RTN","XMS2",82,0)
 S XMIEN=""
"RTN","XMS2",83,0)
 F  S XMIEN=$O(^XMB(3.9,XMZ,1,"AQUEUE",XMINST,XMIEN)) Q:XMIEN=""  S XMTO($$SENDER^XMS3(XMZ,XMZREC,XMNVFROM,XMIEN))=""
"RTN","XMS2",84,0)
 D SENDMSG^XMXSEND(.5,"Special Instructions Ignored","XMTEXT",.XMTO,.XMINSTR)
"RTN","XMS2",85,0)
 Q
"RTN","XMS2",86,0)
SPECSET(I,XMSPEC) ;
"RTN","XMS2",87,0)
 S XMSPEC($P("^^^^CONFIRMATION request^VAPORIZE date^TYPE^^CLOSED status^^CONFIDENTIAL status^INFO status",U,I))=""
"RTN","XMS2",88,0)
 Q
"RTN","XMS3")
0^67^B52710665
"RTN","XMS3",1,0)
XMS3 ;ISC-SF/GMB-SMTP Send (RFC 822) ;04/25/2002  14:15
"RTN","XMS3",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMS3",3,0)
 ; Entry points (DBIA 10073):
"RTN","XMS3",4,0)
 ; REC   Get the next line of message text
"RTN","XMS3",5,0)
 Q
"RTN","XMS3",6,0)
HEADER(XMZ,XMZREC,XMFROM,XMNETNAM) ; RFC 822 - Header Records
"RTN","XMS3",7,0)
 ; These records are what you see when you do a "QN" at the prompt:
"RTN","XMS3",8,0)
 ; "Message Action: Ignore//"
"RTN","XMS3",9,0)
 S XMSG="Subject: "_$S($P(XMZREC,U)=$$EZBLD^DIALOG(34012):"",1:$P(XMZREC,U)) X XMSEN Q:ER
"RTN","XMS3",10,0)
 S XMSG="Date: "_$$INDT^XMXUTIL1($P(XMZREC,U,3)) X XMSEN Q:ER
"RTN","XMS3",11,0)
 S XMSG="Message-ID: <"_$$NETID(XMZ)_">" X XMSEN Q:ER
"RTN","XMS3",12,0)
 I $D(^XMB(3.9,XMZ,"IN")) D  Q:ER
"RTN","XMS3",13,0)
 . N XMINRE
"RTN","XMS3",14,0)
 . S XMINRE=^XMB(3.9,XMZ,"IN")
"RTN","XMS3",15,0)
 . I $P(XMINRE,"@",1)?.E1".VA.GOV"!($P(XMINRE,"@",2)?.N) S XMINRE=$P(XMINRE,"@",2)_"@"_$P(XMINRE,"@")
"RTN","XMS3",16,0)
 . S XMSG="In-reply-to: <"_XMINRE_">" X XMSEN
"RTN","XMS3",17,0)
 I "^Y^y^"[(U_$P(XMZREC,U,5)_U) D  Q:ER
"RTN","XMS3",18,0)
 . S XMSG="Return-Receipt-To: "_XMFROM X XMSEN
"RTN","XMS3",19,0)
 I $D(^XMB(3.9,XMZ,"K")) D  Q:ER
"RTN","XMS3",20,0)
 . S XMSG="Encrypted: "_$P(XMZREC,U,10)_U_^("K") X XMSEN
"RTN","XMS3",21,0)
 I $P(XMZREC,U,4)'="" D  Q:ER
"RTN","XMS3",22,0)
 . S XMSG="Sender: "_$$FROM^XMS1($P(XMZREC,U,4),XMNETNAM) X XMSEN
"RTN","XMS3",23,0)
 S XMSG="From: "_XMFROM X XMSEN Q:ER
"RTN","XMS3",24,0)
 I $P(XMZREC,U,6)'="" D  Q:ER
"RTN","XMS3",25,0)
 . S XMSG="Expiry-Date: "_$$INDT^XMXUTIL1($P(XMZREC,U,6)) X XMSEN
"RTN","XMS3",26,0)
 I $P(XMZREC,U,7)["P" D  Q:ER
"RTN","XMS3",27,0)
 . S XMSG="Importance: high" X XMSEN Q:ER
"RTN","XMS3",28,0)
 . S XMSG="X-Priority: 1" X XMSEN
"RTN","XMS3",29,0)
 I "^Y^y^"[(U_$P(XMZREC,U,11)_U) D  Q:ER
"RTN","XMS3",30,0)
 . S XMSG="Sensitivity: Private" X XMSEN
"RTN","XMS3",31,0)
 I $D(^XMB(3.9,XMZ,.5)) D  Q:ER
"RTN","XMS3",32,0)
 . N XMZBSKT
"RTN","XMS3",33,0)
 . S XMZBSKT=$P($G(^XMB(3.9,XMZ,.5)),U,1)
"RTN","XMS3",34,0)
 . Q:XMZBSKT=""
"RTN","XMS3",35,0)
 . S XMSG="X-MM-Basket: "_XMZBSKT X XMSEN
"RTN","XMS3",36,0)
 I $P(XMZREC,U,7)'="",$P(XMZREC,U,7)'="P" D  Q:ER
"RTN","XMS3",37,0)
 . S XMSG="X-MM-Type: "_$P(XMZREC,U,7) X XMSEN
"RTN","XMS3",38,0)
 I "^Y^y^"[(U_$P(XMZREC,U,9)_U) D  Q:ER
"RTN","XMS3",39,0)
 . S XMSG="X-MM-Closed: YES" X XMSEN
"RTN","XMS3",40,0)
 I "^Y^y^"[(U_$P(XMZREC,U,12)_U) D  Q:ER
"RTN","XMS3",41,0)
 . S XMSG="X-MM-Info-Only: YES" X XMSEN
"RTN","XMS3",42,0)
 D TOLIST(XMZ,XMNETNAM) Q:ER
"RTN","XMS3",43,0)
 Q
"RTN","XMS3",44,0)
NETID(XMZ) ;
"RTN","XMS3",45,0)
 N XMCRE8
"RTN","XMS3",46,0)
 S XMCRE8=$P($G(^XMB(3.9,XMZ,.6)),U,1)
"RTN","XMS3",47,0)
 I 'XMCRE8 D
"RTN","XMS3",48,0)
 . S XMCRE8=$P($G(^XMB(3.9,XMZ,0)),U,3)
"RTN","XMS3",49,0)
 . I $P(XMCRE8,".")?7N S XMCRE8=$P(XMCRE8,".")
"RTN","XMS3",50,0)
 . E  D
"RTN","XMS3",51,0)
 . . S XMCRE8=$$CONVERT^XMXUTIL1(XMCRE8)
"RTN","XMS3",52,0)
 . . I XMCRE8=-1 S XMCRE8=DT
"RTN","XMS3",53,0)
 . S $P(^XMB(3.9,XMZ,.6),U,1)=XMCRE8
"RTN","XMS3",54,0)
 . S ^XMB(3.9,"C",XMCRE8,XMZ)=""
"RTN","XMS3",55,0)
 N XMREMID
"RTN","XMS3",56,0)
 I $D(^XMB(3.9,XMZ,5)) D  Q:XMREMID'="" XMREMID
"RTN","XMS3",57,0)
 . S XMREMID=^XMB(3.9,XMZ,5)
"RTN","XMS3",58,0)
 . I $P(XMREMID,"@",1)?.E1".VA.GOV"!($P(XMREMID,"@",2)?.N) S XMREMID=$P(XMREMID,"@",2)_"@"_$P(XMREMID,"@")
"RTN","XMS3",59,0)
 . Q:XMREMID'=""
"RTN","XMS3",60,0)
 . D PARSE^XMR3(XMZ,.XMREMID)
"RTN","XMS3",61,0)
 ;Q XMZ_"@"_^XMB("NETNAME")
"RTN","XMS3",62,0)
 Q XMZ_"."_XMCRE8_"@"_^XMB("NETNAME")
"RTN","XMS3",63,0)
TOLIST(XMZ,XMNETNAM) ;
"RTN","XMS3",64,0)
 N XMTO,XMIEN
"RTN","XMS3",65,0)
 S XMIEN=$O(^XMB(3.9,XMZ,6,0)),XMSG="To: "_$$TOFORMAT($P(^XMB(3.9,XMZ,6,XMIEN,0),U,1),$S($G(XMC("MAILMAN")):$P(^(0),U,2),1:""))
"RTN","XMS3",66,0)
 F  S XMIEN=$O(^XMB(3.9,XMZ,6,XMIEN)) Q:'XMIEN!(XMIEN>50)  D  Q:ER
"RTN","XMS3",67,0)
 . S XMTO=$$TOFORMAT($P(^XMB(3.9,XMZ,6,XMIEN,0),U,1),$S($G(XMC("MAILMAN")):$P(^(0),U,2),1:""))
"RTN","XMS3",68,0)
 . S XMSG=XMSG_","
"RTN","XMS3",69,0)
 . I $L(XMSG)+$L(XMTO)>80 D TOSEND(.XMSG) Q:ER
"RTN","XMS3",70,0)
 . S XMSG=XMSG_" "_XMTO
"RTN","XMS3",71,0)
 Q:ER
"RTN","XMS3",72,0)
 D TOSEND(.XMSG) Q:ER
"RTN","XMS3",73,0)
 I XMIEN>50 S XMSG="(Too many recipients to list...)" D TOSEND(.XMSG) Q:ER
"RTN","XMS3",74,0)
 Q
"RTN","XMS3",75,0)
TOFORMAT(XMTO,XMPREFIX) ;
"RTN","XMS3",76,0)
 N XMDOM
"RTN","XMS3",77,0)
 S XMDOM=$S(XMTO["@":$P(XMTO,"@",2,99),1:XMNETNAM)
"RTN","XMS3",78,0)
 S XMTO=$$TO($P(XMTO,"@"))
"RTN","XMS3",79,0)
 Q $S(XMPREFIX="":"",$E(XMTO,1)=$C(34):"",1:XMPREFIX_":")_XMTO_"@"_XMDOM
"RTN","XMS3",80,0)
TO(XMTO) ;
"RTN","XMS3",81,0)
 I $E(XMTO)'=$C(34),(XMTO[",")!(XMTO[" ") D
"RTN","XMS3",82,0)
 . I XMTO["," S XMTO=$TR(XMTO,", .","._+")
"RTN","XMS3",83,0)
 . I XMTO[" " S XMTO=$C(34)_XMTO_$C(34)
"RTN","XMS3",84,0)
 Q XMTO
"RTN","XMS3",85,0)
TOSEND(XMSG) ;
"RTN","XMS3",86,0)
 I $L(XMSG)>80 D  Q
"RTN","XMS3",87,0)
 . N XMSGHOLD,XMPIECES
"RTN","XMS3",88,0)
 . S XMPIECES=$L(XMSG,"@")
"RTN","XMS3",89,0)
 . S XMSGHOLD=$P(XMSG,"@",XMPIECES)
"RTN","XMS3",90,0)
 . S XMSG=$P(XMSG,"@",1,XMPIECES-1)
"RTN","XMS3",91,0)
 . X XMSEN
"RTN","XMS3",92,0)
 . S XMSG="    @"_XMSGHOLD
"RTN","XMS3",93,0)
 X XMSEN
"RTN","XMS3",94,0)
 S XMSG="   "
"RTN","XMS3",95,0)
 Q
"RTN","XMS3",96,0)
TEXT(XMZ) ; Send body of text
"RTN","XMS3",97,0)
 N XMS0AJ
"RTN","XMS3",98,0)
 ;S XMBLOCK=1 ; *** What's this?  See ^XML4CRC* & ^XMLSWP*
"RTN","XMS3",99,0)
 S XMS0AJ=0
"RTN","XMS3",100,0)
 F  S XMS0AJ=$O(^XMB(3.9,XMZ,2,XMS0AJ)) Q:XMS0AJ'>0  D  Q:ER
"RTN","XMS3",101,0)
 . S XMSG=^XMB(3.9,XMZ,2,XMS0AJ,0)
"RTN","XMS3",102,0)
 . I $E(XMSG)="." S XMSG="."_XMSG
"RTN","XMS3",103,0)
 . E  I $E(XMSG,1,4)="~*~^" S XMSG=" "_XMSG  ; *** What's this?
"RTN","XMS3",104,0)
 . X XMSEN
"RTN","XMS3",105,0)
 I ER S ER("MSG")="Error sending msg "_XMZ_", text line "_XMS0AJ Q
"RTN","XMS3",106,0)
 ;D:$D(XMBLOCK) KILL^XML4CRC
"RTN","XMS3",107,0)
 Q
"RTN","XMS3",108,0)
RCPTERR(XMERRMSG,XMZ,XMZREC,XMNVFROM,XMRCPTO,XMRCPT,XMIEN) ; Non-delivery to recipient
"RTN","XMS3",109,0)
 N XMFDA,XMIENS,XMTO,XMPARM,XMINSTR
"RTN","XMS3",110,0)
 S XMIENS=XMIEN_","_XMZ_","
"RTN","XMS3",111,0)
 S XMFDA(3.91,XMIENS,3)="@"                ; remote msg id
"RTN","XMS3",112,0)
 S XMFDA(3.91,XMIENS,4)=XMCM("START","FM") ; xmit date/time
"RTN","XMS3",113,0)
 S XMFDA(3.91,XMIENS,5)=$E($P(XMERRMSG," ",2,999),1,30)  ; status
"RTN","XMS3",114,0)
 S XMFDA(3.91,XMIENS,6)="@"                ; path
"RTN","XMS3",115,0)
 D FILE^DIE("","XMFDA")
"RTN","XMS3",116,0)
 S XMTO=$$SENDER(XMZ,XMZREC,XMNVFROM,XMIEN,1,XMERRMSG) Q:"<>"[XMTO
"RTN","XMS3",117,0)
 S XMINSTR("FROM")="POSTMASTER"
"RTN","XMS3",118,0)
 S XMPARM(1)=$P(XMZREC,U,1) ; subject
"RTN","XMS3",119,0)
 S XMPARM(2)=XMRCPTO
"RTN","XMS3",120,0)
 S XMPARM(3)=XMERRMSG
"RTN","XMS3",121,0)
 S XMPARM(4)=XMRCPT
"RTN","XMS3",122,0)
 S XMPARM(5)=$S(XMTO["@":$G(^XMB(3.9,XMZ,5)),1:XMZ)
"RTN","XMS3",123,0)
 D TASKBULL^XMXBULL(.5,"XM SEND ERR RECIPIENT",.XMPARM,"",XMTO,.XMINSTR)
"RTN","XMS3",124,0)
 Q
"RTN","XMS3",125,0)
MSGERR(XMSITE,XMINST,XMERRMSG,XMZ,XMZREC,XMNVFROM,XMRCPT) ;
"RTN","XMS3",126,0)
 ; If a message is rejected at a site for any reason (the whole message,
"RTN","XMS3",127,0)
 ; not just one recipient), then this message may be sent.
"RTN","XMS3",128,0)
 N XMTO,XMPARM,XMIEN,XMNAME,XMCNT,XMINSTR
"RTN","XMS3",129,0)
 D DOTRAN^XMC1(XMERRMSG)
"RTN","XMS3",130,0)
 S XMPARM(3)=XMERRMSG
"RTN","XMS3",131,0)
 S XMERRMSG=$E($P(XMERRMSG," ",2,999),1,30)
"RTN","XMS3",132,0)
 K ^TMP("XM",$J,"REJECT")
"RTN","XMS3",133,0)
 S XMIEN=""
"RTN","XMS3",134,0)
 F  S XMIEN=$S($D(XMRCPT):$O(XMRCPT(XMIEN)),1:$O(^XMB(3.9,XMZ,1,"AQUEUE",XMINST,XMIEN))) Q:XMIEN=""  D
"RTN","XMS3",135,0)
 . N XMFDA,XMIENS
"RTN","XMS3",136,0)
 . S XMIENS=XMIEN_","_XMZ_","
"RTN","XMS3",137,0)
 . S XMFDA(3.91,XMIENS,3)="@"      ; remote msg id
"RTN","XMS3",138,0)
 . S XMFDA(3.91,XMIENS,4)=XMCM("START","FM") ; xmit date/time
"RTN","XMS3",139,0)
 . S XMFDA(3.91,XMIENS,5)=XMERRMSG ; status
"RTN","XMS3",140,0)
 . S XMFDA(3.91,XMIENS,6)="@"      ; path
"RTN","XMS3",141,0)
 . S XMFDA(3.91,XMIENS,9)="@"      ; xmit time
"RTN","XMS3",142,0)
 . D FILE^DIE("","XMFDA")
"RTN","XMS3",143,0)
 . S XMNAME=$P($G(^XMB(3.9,XMZ,1,XMIEN,0)),U,1) Q:XMNAME=""
"RTN","XMS3",144,0)
 . S XMTO=$$SENDER(XMZ,XMZREC,XMNVFROM,XMIEN) Q:"<>"[XMTO
"RTN","XMS3",145,0)
 . S (XMCNT,^(XMTO))=$G(^TMP("XM",$J,"REJECT",XMTO))+1
"RTN","XMS3",146,0)
 . S ^TMP("XM",$J,"REJECT",XMTO,XMCNT)=XMNAME
"RTN","XMS3",147,0)
 S XMINSTR("FROM")="POSTMASTER"
"RTN","XMS3",148,0)
 S XMPARM(1)=$P(XMZREC,U,1) ; subject
"RTN","XMS3",149,0)
 S XMPARM(2)=XMSITE
"RTN","XMS3",150,0)
 S XMTO=""
"RTN","XMS3",151,0)
 F  S XMTO=$O(^TMP("XM",$J,"REJECT",XMTO)) Q:XMTO=""  D TASKBULL^XMXBULL(.5,"XM SEND ERR MSG",.XMPARM,"^TMP(""XM"",$J,""REJECT"",XMTO)",XMTO,.XMINSTR)
"RTN","XMS3",152,0)
 K ^TMP("XM",$J,"REJECT")
"RTN","XMS3",153,0)
 Q
"RTN","XMS3",154,0)
SENDER(XMZ,XMZREC,XMNVFROM,XMIEN,XMDELFWD,XMERRMSG) ; Function returns 'to whom to send error message'
"RTN","XMS3",155,0)
 N XMFWDREC,XMFWDR
"RTN","XMS3",156,0)
 S XMFWDREC=$G(^XMB(3.9,XMZ,1,XMIEN,"F")) ; Try to find forwarder
"RTN","XMS3",157,0)
 S XMFWDR=$P(XMFWDREC,U,2)
"RTN","XMS3",158,0)
 I XMFWDR'="" D  Q XMFWDR  ; Forwarder is local
"RTN","XMS3",159,0)
 . I $G(XMDELFWD) D DELFWD(XMZ,XMIEN,XMFWDR,XMERRMSG)
"RTN","XMS3",160,0)
 I $E(XMFWDREC)="<" Q $E($P($P(XMFWDREC,U,1),">",1),2,999)  ; Forwarder is remote
"RTN","XMS3",161,0)
 Q:$D(^XMB(3.9,XMZ,.7)) XMNVFROM  ; Sender is remote
"RTN","XMS3",162,0)
 N XMFROM
"RTN","XMS3",163,0)
 S XMFROM=$P(XMZREC,U,2)
"RTN","XMS3",164,0)
 I +XMFROM=XMFROM Q XMFROM  ; Sender is local
"RTN","XMS3",165,0)
 I XMFROM'["@" Q .5         ; Sender is fictitious, so notify postmaster
"RTN","XMS3",166,0)
 Q XMNVFROM  ; Sender is remote
"RTN","XMS3",167,0)
DELFWD(XMZ,XMIEN,XMFWDR,XMERRMSG) ; Delete user's forwarding address
"RTN","XMS3",168,0)
 Q:+XMFWDR'=XMFWDR
"RTN","XMS3",169,0)
 N XMFWD
"RTN","XMS3",170,0)
 S XMFWD=$P(^XMB(3.7,XMFWDR,0),U,2) Q:XMFWD=""
"RTN","XMS3",171,0)
 N XMINSTR,XMADDR,XMFULL,XMERROR,XMFDA,XMTXT
"RTN","XMS3",172,0)
 S XMINSTR("ADDR FLAGS")="X" ; do not create ^TMP(, just check.
"RTN","XMS3",173,0)
 S XMADDR=$P(^XMB(3.9,XMZ,1,XMIEN,0),U,1)
"RTN","XMS3",174,0)
 D ADDRESS^XMXADDR(DUZ,XMFWD,.XMFULL,.XMERROR)
"RTN","XMS3",175,0)
 I '$D(XMERROR),XMADDR'=$G(XMFULL) Q
"RTN","XMS3",176,0)
 D DELFWD^XMVVITA(XMFWDR,XMFWD,XMERRMSG)
"RTN","XMS3",177,0)
 Q
"RTN","XMS3",178,0)
 ; The following has nothing to do with the above.
"RTN","XMS3",179,0)
 ; These are used by the SERVER Communications Protocol in file 3.4.
"RTN","XMS3",180,0)
REC ; Read the next line of text from the message.  When called for the
"RTN","XMS3",181,0)
 ; first time, returns the first line.
"RTN","XMS3",182,0)
 ; In:
"RTN","XMS3",183,0)
 ; XMZ   - IEN of the message in file 3.9
"RTN","XMS3",184,0)
 ; XMPOS - (optional) line number of the previous line read
"RTN","XMS3",185,0)
 ;         Default is .999999
"RTN","XMS3",186,0)
 ; Out:
"RTN","XMS3",187,0)
 ; XMPOS - line number of XMRG
"RTN","XMS3",188,0)
 ; XMRG  - =the next line of text, if OK; ="" if end of text reached
"RTN","XMS3",189,0)
 ; XMER  - =0 if OK; =-1 if end of text reached
"RTN","XMS3",190,0)
 S XMPOS=$S('$D(XMPOS):.999999,XMPOS<.999999:.999999,1:XMPOS)
"RTN","XMS3",191,0)
 S XMPOS=$O(^XMB(3.9,XMZ,2,XMPOS))
"RTN","XMS3",192,0)
 I +XMPOS'=XMPOS S XMER=-1,XMRG="" Q
"RTN","XMS3",193,0)
 S XMRG=^XMB(3.9,XMZ,2,XMPOS,0),XMER=0
"RTN","XMS3",194,0)
 Q
"RTN","XMS3",195,0)
SEN ; Send a line to the return message
"RTN","XMS3",196,0)
 S XMSLINE=XMSLINE+1,^XMB(3.9,XMZ,2,XMSLINE,0)=XMSG
"RTN","XMS3",197,0)
 Q
"RTN","XMS3",198,0)
OPEN ; Open the reverse message path
"RTN","XMS3",199,0)
 Q
"RTN","XMS3",200,0)
CLOSE ; Close the reverse message
"RTN","XMS3",201,0)
 S ^XMB(3.9,XMZ,2,0)="^3.92A^"_XMSLINE_U_XMSLINE_U_DT
"RTN","XMS3",202,0)
 Q
"RTN","XMS4")
1^68
"RTN","XMS5")
1^69
"RTN","XMS5A")
1^70
"RTN","XMS5B")
1^71
"RTN","XMSER")
1^173
"RTN","XMSERR")
1^72
"RTN","XMSFTP")
0^333^B8502703
"RTN","XMSFTP",1,0)
XMSFTP ;(WASH ISC)/CAP-TCP/IP-FTP Sender ;04/17/2002  11:29
"RTN","XMSFTP",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMSFTP",3,0)
 ;TCP/IP-FTP COMMUNICATIONS
"RTN","XMSFTP",4,0)
 ;Send file via FTP / File located on another TCP/IP node
"RTN","XMSFTP",5,0)
FTP K TEST N XMIO S XMIO=$I
"RTN","XMSFTP",6,0)
 ;
"RTN","XMSFTP",7,0)
 ;Get unique number for file to send
"RTN","XMSFTP",8,0)
 S (XMSFTP,X)=$G(^XMBX(4.2995,"F",0))+1,^(0)=X
"RTN","XMSFTP",9,0)
 ;
"RTN","XMSFTP",10,0)
 S FILE="XM"_X_".COM" O FILE:NEW U FILE
"RTN","XMSFTP",11,0)
 W "$! FTP COM procedure for fetching file from server and sending it",!
"RTN","XMSFTP",12,0)
 W "$ set noon",!
"RTN","XMSFTP",13,0)
 W "$ assign/user nla0: sys$output",! ;Turn off echo
"RTN","XMSFTP",14,0)
 W "$ assign/user sys$input sys$command",!
"RTN","XMSFTP",15,0)
 ;
"RTN","XMSFTP",16,0)
 ;FTP to Get or Put location
"RTN","XMSFTP",17,0)
 W "$ FTP=""$TWG$TCP:[NETDIST.USER]FTP",!
"RTN","XMSFTP",18,0)
 W "$ FTP "
"RTN","XMSFTP",19,0)
 I $L($G(XMSFTP(1))) W XMSFTP(1),!
"RTN","XMSFTP",20,0)
 E  W XMSFTP(3),! G PUT
"RTN","XMSFTP",21,0)
 ;
"RTN","XMSFTP",22,0)
 ;Get file from local network
"RTN","XMSFTP",23,0)
 S %=$G(XMSFTP(4)) W %,!
"RTN","XMSFTP",24,0)
 S %=$G(XMSFTP(5)) I $L(%) W %,!
"RTN","XMSFTP",25,0)
 W "bin",!
"RTN","XMSFTP",26,0)
 W "get "_$P(XMSFTP(2),U,2)_XMSFTP(2,"F")_" "_XMSFTP(2,"F"),!
"RTN","XMSFTP",27,0)
 W "close",!
"RTN","XMSFTP",28,0)
 ;
"RTN","XMSFTP",29,0)
 ;Put file to remote location
"RTN","XMSFTP",30,0)
 W "open "_XMSFTP(3),! G P
"RTN","XMSFTP",31,0)
PUT S %=$G(XMSFTP(6)) W %,!
"RTN","XMSFTP",32,0)
P S %=$G(XMSFTP(7)) I $L(%) H 3 W %,! I $L($G(XMSFTP(7.1))) H 3 W XMSFTP(7.1),!
"RTN","XMSFTP",33,0)
 W "bin",!
"RTN","XMSFTP",34,0)
 W "cd nfa0:[IMPORT.MAIL]",!
"RTN","XMSFTP",35,0)
 ;
"RTN","XMSFTP",36,0)
 ;Need to know directory on remote side
"RTN","XMSFTP",37,0)
 S %=$G(XMSFTP(8)) I $L(%) W "cd "_%,!
"RTN","XMSFTP",38,0)
 S %=$G(XMSFTP(2)) I $L(%) W "cd "_%,!
"RTN","XMSFTP",39,0)
 W "delete "_XMSFTP(2,"F"),!
"RTN","XMSFTP",40,0)
 W "put nfa0:[EXPORT.MAIL]"_XMSFTP(2,"F"),!
"RTN","XMSFTP",41,0)
 C FILE
"RTN","XMSFTP",42,0)
 ;
"RTN","XMSFTP",43,0)
 ;The following code originally spawned off an FTP transaction
"RTN","XMSFTP",44,0)
 ;immediately when the XMnnn.COM file was created.  It has been
"RTN","XMSFTP",45,0)
 ;replaced with code in XMRTCP.
"RTN","XMSFTP",46,0)
 ;
"RTN","XMSFTP",47,0)
 ;S %=$H*86400+$P($H,",",2)+600,%H=%\86400_","_(%#86400) D YX^%DTC S %=$P($P(Y,",")," ",2)_"-"_$P(Y," ")_"-"_$P($P(Y,"@"),", ",2)_":"_$P(Y,"@",2)
"RTN","XMSFTP",48,0)
 ;
"RTN","XMSFTP",49,0)
 S X=$$FILE(FILE) K FILE,XMTMPFIL
"RTN","XMSFTP",50,0)
 U XMIO Q
"RTN","XMSFTP",51,0)
B36 ;Calculate base 36 number
"RTN","XMSFTP",52,0)
 N %,N,O,I,Z S O=X,%=X#36+1 D N S Y=N
"RTN","XMSFTP",53,0)
 S %=X\(36)#36+1 D N S Y=N_Y
"RTN","XMSFTP",54,0)
 S %=X\(36*36)#36+1 D N S Y=N_Y
"RTN","XMSFTP",55,0)
 S %=X\(36*36*36)#36+1 D N S Y=N_Y
"RTN","XMSFTP",56,0)
 S X=O Q
"RTN","XMSFTP",57,0)
 Q
"RTN","XMSFTP",58,0)
N S N=$E("0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ",%)
"RTN","XMSFTP",59,0)
 Q
"RTN","XMSFTP",60,0)
FILE(X) ;Add record to FTP list
"RTN","XMSFTP",61,0)
 N DD,DO,DIC,DTOUT,DUOUT,Y
"RTN","XMSFTP",62,0)
 S DIC="^XMBX(4.2995,",DIC(0)="LF",DIC("DR")="1///"_($H*86400+$P($H,",",2))_";2///"_$S($G(XMDUZ):XMDUZ,1:DUZ)
"RTN","XMSFTP",63,0)
 D FILE^DICN S %=$G(XMSFTP("IMAGE-PTR")) I % S $P(^XMBX(4.2995,+Y,0),U,4)=%
"RTN","XMSFTP",64,0)
 Q Y
"RTN","XMSFTP",65,0)
TEST S TEST=1
"RTN","XMSFTP",66,0)
 ;;XMSFTP(1)=get file IP address (EG   89.0.0.79 - sstu)
"RTN","XMSFTP",67,0)
 ;;XMSFTP(2)=DOS dir / subdir... Other than default to IMPORT file into
"RTN","XMSFTP",68,0)
 ;;XMSFTP(2,"F")=File to get (s:\image\nfibpd2.756)
"RTN","XMSFTP",69,0)
 ;;XMSFTP(3)=put to IP address
"RTN","XMSFTP",70,0)
 ;;XMSFTP(4)=User ID at origination node
"RTN","XMSFTP",71,0)
 ;;XMSFTP(5)=User Password at origination node
"RTN","XMSFTP",72,0)
 ;;XMSFTP(6)=User ID at destination node
"RTN","XMSFTP",73,0)
 ;;XMSFTP(7)=User Password at destination node
"RTN","XMSFTP",74,0)
 ;;XMSFTP(8)=FTP IMPORT PATH [VMS has DIR.SUBD..., see XMSFTP(2) for DOS]
"RTN","XMSFTP",75,0)
 Q
"RTN","XMSFTP",76,0)
 ;
"RTN","XMSFTP",77,0)
 ;To display image on Pete's terminal
"RTN","XMSFTP",78,0)
 ;>stage
"RTN","XMSFTP",79,0)
 ;>C:\t\test3 file_name
"RTN","XMSFTP",80,0)
 ;
"RTN","XMSFTP",81,0)
 ;find differences:  diff file1 file2 (no display=no differences)
"RTN","XMSFTPUX")
0^334^B9247891
"RTN","XMSFTPUX",1,0)
XMSFTPUX ;(WASH ISC)/CAP-TCP/IP-FTP Sender ;04/17/2002  11:30
"RTN","XMSFTPUX",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMSFTPUX",3,0)
 ;+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
"RTN","XMSFTPUX",4,0)
 ;XXX/KCMO - Modified for UCX, added a field to the network location
"RTN","XMSFTPUX",5,0)
 ;file called 'maps to reference' that can be used to map the DOS 
"RTN","XMSFTPUX",6,0)
 ;locations to Unix/VMS references.
"RTN","XMSFTPUX",7,0)
 ;-----------------------------------------------------------------
"RTN","XMSFTPUX",8,0)
 ;
"RTN","XMSFTPUX",9,0)
 ;TCP/IP-FTP COMMUNICATIONS
"RTN","XMSFTPUX",10,0)
 ;Send file via FTP / File located on another TCP/IP node
"RTN","XMSFTPUX",11,0)
FTP K TEST N XMIO,OREF,LOC,FILE,IFILE S XMIO=$I
"RTN","XMSFTPUX",12,0)
 ;
"RTN","XMSFTPUX",13,0)
 ;Get unique number for file to send
"RTN","XMSFTPUX",14,0)
 S (XMSFTP,X)=$G(^XMBX(4.2995,"F",0))+1,^(0)=X
"RTN","XMSFTPUX",15,0)
 ;
"RTN","XMSFTPUX",16,0)
XX S LOC=$P($G(^MAG(2005,+XMSFTP("IMAGE-PTR"),0)),U,3)
"RTN","XMSFTPUX",17,0)
 S OREF=$P($G(^MAG(2005.2,LOC,589001)),U)
"RTN","XMSFTPUX",18,0)
 ;
"RTN","XMSFTPUX",19,0)
 S FILE="XM"_X_".COM",IFILE="XM"_X_".INP" O FILE:NEW O IFILE:NEW U FILE
"RTN","XMSFTPUX",20,0)
 W "$! FTP COM procedure for sending binary files, UCX/XXX",!
"RTN","XMSFTPUX",21,0)
 W "$ set noon",!
"RTN","XMSFTPUX",22,0)
 W "$ ftp:=$ucx$ftp/ultrix",!
"RTN","XMSFTPUX",23,0)
 W "$ ftp /input="_IFILE_" "_XMSFTP(3),!
"RTN","XMSFTPUX",24,0)
 W "$ exit !Need to check status",! C FILE G PUT
"RTN","XMSFTPUX",25,0)
 ;
"RTN","XMSFTPUX",26,0)
 ;Get file from local network
"RTN","XMSFTPUX",27,0)
 S %=$G(XMSFTP(4)) W %,!
"RTN","XMSFTPUX",28,0)
 S %=$G(XMSFTP(5)) I $L(%) W %,!
"RTN","XMSFTPUX",29,0)
 W "bin",!
"RTN","XMSFTPUX",30,0)
 W "get "_$P(XMSFTP(2),U,2)_XMSFTP(2,"F")_" "_XMSFTP(2,"F"),!
"RTN","XMSFTPUX",31,0)
 W "close",!
"RTN","XMSFTPUX",32,0)
 ;
"RTN","XMSFTPUX",33,0)
 ;Put file to remote location
"RTN","XMSFTPUX",34,0)
 W "open "_XMSFTP(3),! G P
"RTN","XMSFTPUX",35,0)
 ;
"RTN","XMSFTPUX",36,0)
PUT U IFILE
"RTN","XMSFTPUX",37,0)
 S %=$G(XMSFTP(6)) W "user ",%," "
"RTN","XMSFTPUX",38,0)
P S %=$G(XMSFTP(7)) I $L(%) H 3 W %,! I $L($G(XMSFTP(7.1))) H 3 W XMSFTP(7.1),!
"RTN","XMSFTPUX",39,0)
 W "bin",!
"RTN","XMSFTPUX",40,0)
 W "lcd ",OREF,!
"RTN","XMSFTPUX",41,0)
 ;
"RTN","XMSFTPUX",42,0)
 ;Need to know directory on remote side
"RTN","XMSFTPUX",43,0)
 S %=$G(XMSFTP(8)) I $L(%) W "cd "_%,!
"RTN","XMSFTPUX",44,0)
 S %=$G(XMSFTP(2)) I $L(%) W "cd "_%,!
"RTN","XMSFTPUX",45,0)
 W "delete "_XMSFTP(2,"F")_";*",!
"RTN","XMSFTPUX",46,0)
 W "put ",XMSFTP(2,"F"),!
"RTN","XMSFTPUX",47,0)
 C IFILE
"RTN","XMSFTPUX",48,0)
 ;
"RTN","XMSFTPUX",49,0)
 ;The following code originally spawned off an FTP transaction
"RTN","XMSFTPUX",50,0)
 ;immediately when the XMnnn.COM file was created.  It has been
"RTN","XMSFTPUX",51,0)
 ;replaced with code in XMRTCP.
"RTN","XMSFTPUX",52,0)
 ;
"RTN","XMSFTPUX",53,0)
 ;S %=$H*86400+$P($H,",",2)+600,%H=%\86400_","_(%#86400) D YX^%DTC S %=$P($P(Y,",")," ",2)_"-"_$P(Y," ")_"-"_$P($P(Y,"@"),", ",2)_":"_$P(Y,"@",2)
"RTN","XMSFTPUX",54,0)
 ;
"RTN","XMSFTPUX",55,0)
 S X=$$FILE(FILE) K FILE,XMTMPFIL
"RTN","XMSFTPUX",56,0)
 U XMIO Q
"RTN","XMSFTPUX",57,0)
B36 ;Calculate base 36 number
"RTN","XMSFTPUX",58,0)
 N %,N,O,I,Z S O=X,%=X#36+1 D N S Y=N
"RTN","XMSFTPUX",59,0)
 S %=X\(36)#36+1 D N S Y=N_Y
"RTN","XMSFTPUX",60,0)
 S %=X\(36*36)#36+1 D N S Y=N_Y
"RTN","XMSFTPUX",61,0)
 S %=X\(36*36*36)#36+1 D N S Y=N_Y
"RTN","XMSFTPUX",62,0)
 S X=O Q
"RTN","XMSFTPUX",63,0)
 Q
"RTN","XMSFTPUX",64,0)
N S N=$E("0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ",%)
"RTN","XMSFTPUX",65,0)
 Q
"RTN","XMSFTPUX",66,0)
FILE(X) ;Add record to FTP list
"RTN","XMSFTPUX",67,0)
 N DD,DO,DIC,DTOUT,DUOUT,Y
"RTN","XMSFTPUX",68,0)
 S DIC="^XMBX(4.2995,",DIC(0)="LF",DIC("DR")="1///"_($H*86400+$P($H,",",2))_";2///"_$S($G(XMDUZ):XMDUZ,1:DUZ)
"RTN","XMSFTPUX",69,0)
 D FILE^DICN S %=$G(XMSFTP("IMAGE-PTR")) I % S $P(^XMBX(4.2995,+Y,0),U,4)=%
"RTN","XMSFTPUX",70,0)
 Q Y
"RTN","XMSFTPUX",71,0)
TEST S TEST=1
"RTN","XMSFTPUX",72,0)
 ;;XMSFTP(1)=get file IP address (EG   89.0.0.79 - sstu)
"RTN","XMSFTPUX",73,0)
 ;;XMSFTP(2)=DOS dir / subdir... Other than default to IMPORT file into
"RTN","XMSFTPUX",74,0)
 ;;XMSFTP(2,"F")=File to get (s:\image\nfibpd2.756)
"RTN","XMSFTPUX",75,0)
 ;;XMSFTP(3)=put to IP address
"RTN","XMSFTPUX",76,0)
 ;;XMSFTP(4)=User ID at origination node
"RTN","XMSFTPUX",77,0)
 ;;XMSFTP(5)=User Password at origination node
"RTN","XMSFTPUX",78,0)
 ;;XMSFTP(6)=User ID at destination node
"RTN","XMSFTPUX",79,0)
 ;;XMSFTP(7)=User Password at destination node
"RTN","XMSFTPUX",80,0)
 ;;XMSFTP(8)=FTP IMPORT PATH [VMS has DIR.SUBD..., see XMSFTP(2) for DOS]
"RTN","XMSFTPUX",81,0)
 Q
"RTN","XMSFTPUX",82,0)
 ;
"RTN","XMSFTPUX",83,0)
 ;To display image on Pete's terminal
"RTN","XMSFTPUX",84,0)
 ;>stage
"RTN","XMSFTPUX",85,0)
 ;>C:\t\test3 file_name
"RTN","XMSFTPUX",86,0)
 ;
"RTN","XMSFTPUX",87,0)
 ;find differences:  diff file1 file2 (no display=no differences)
"RTN","XMSM")
1^73
"RTN","XMSM1")
1^74
"RTN","XMSMAIL")
1^75
"RTN","XMTDF")
0^335^B26187152
"RTN","XMTDF",1,0)
XMTDF ;ISC-SF/GMB-Filter message: multiple conditions ;03/01/2001  10:17
"RTN","XMTDF",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMTDF",3,0)
 ; XMF("SUBJ")  Subject contains this string
"RTN","XMTDF",4,0)
 ; XMF("FROM")  Message is from this person
"RTN","XMTDF",5,0)
 ; XMF("TO")    Message is to this person
"RTN","XMTDF",6,0)
FILTER(XMDUZ,XMZ,XMZSUBJ,XMZFROM,XMK,XMKN,XMACT) ; figures out which basket to save to
"RTN","XMTDF",7,0)
 ; the message should be put in.
"RTN","XMTDF",8,0)
 ; Defaults: the "IN" basket.
"RTN","XMTDF",9,0)
 ; If basket doesn't exist, it creates the basket.
"RTN","XMTDF",10,0)
 ; Returns:
"RTN","XMTDF",11,0)
 ; XMK  basket number
"RTN","XMTDF",12,0)
 ; XMKN basket name
"RTN","XMTDF",13,0)
 ; Optionally, if specified by user:
"RTN","XMTDF",14,0)
 ; XMACT("VDAYS") set vaporize date to this many days from today.
"RTN","XMTDF",15,0)
 ; XMACT("NONEW") don't make this message new.
"RTN","XMTDF",16,0)
 ; XMACT("FWD")   forward this message
"RTN","XMTDF",17,0)
 N XMORDER,XMIEN,XMFREC
"RTN","XMTDF",18,0)
 K XMK,XMKN
"RTN","XMTDF",19,0)
 S (XMORDER,XMIEN)=0
"RTN","XMTDF",20,0)
 F  S XMORDER=$O(^XMB(3.7,XMDUZ,15,"AF",XMORDER)) Q:'XMORDER  D  Q:$D(XMKN)
"RTN","XMTDF",21,0)
 . F  S XMIEN=$O(^XMB(3.7,XMDUZ,15,"AF",XMORDER,XMIEN)) Q:'XMIEN  D  Q:$D(XMKN)
"RTN","XMTDF",22,0)
 . . N XMF
"RTN","XMTDF",23,0)
 . . S XMFREC=$G(^XMB(3.7,XMDUZ,15,XMIEN,0))
"RTN","XMTDF",24,0)
 . . S:$P(XMFREC,U,5)]"" XMF("SUBJ")=$P(XMFREC,U,5)
"RTN","XMTDF",25,0)
 . . S:$P(XMFREC,U,6)]"" XMF("FROM")=$P(XMFREC,U,6)
"RTN","XMTDF",26,0)
 . . S:$P(XMFREC,U,7)]"" XMF("TO")=$P(XMFREC,U,7)
"RTN","XMTDF",27,0)
 . . S:$$GOODMSG(XMZ,XMZSUBJ,XMZFROM,.XMF) XMKN=$P(XMFREC,U,3)
"RTN","XMTDF",28,0)
 I '$D(XMKN) D  Q
"RTN","XMTDF",29,0)
 . S XMK=1,XMKN=$$EZBLD^DIALOG(37005)   ; Default to "IN" basket
"RTN","XMTDF",30,0)
 . D:'$D(^XMB(3.7,XMDUZ,2,XMK,0)) MAKEBSKT^XMXBSKT(XMDUZ,XMK,XMKN)
"RTN","XMTDF",31,0)
 S XMK=$O(^XMB(3.7,XMDUZ,2,"B",XMKN,0))
"RTN","XMTDF",32,0)
 I $P(XMFREC,U,8) S XMACT("VDAYS")=$P(XMFREC,U,8)
"RTN","XMTDF",33,0)
 I $P(XMFREC,U,9)="N" S XMACT("NONEW")=1
"RTN","XMTDF",34,0)
 I $D(^XMB(3.7,XMDUZ,15,XMIEN,1,"B")),$$OKFWD(XMZ) S XMACT("FWD")=XMIEN
"RTN","XMTDF",35,0)
 Q:XMK
"RTN","XMTDF",36,0)
 I XMKN=$$EZBLD^DIALOG(37004) S XMK=.5 D MAKEBSKT^XMXBSKT(XMDUZ,XMK,XMKN) Q  ; "WASTE"
"RTN","XMTDF",37,0)
 D MAKEBSKT^XMXBSKT(XMDUZ,.XMK,XMKN)
"RTN","XMTDF",38,0)
 Q
"RTN","XMTDF",39,0)
GOODMSG(XMZ,XMZSUBJ,XMZFROM,XMF) ;
"RTN","XMTDF",40,0)
 ; This function is a copy of $$GOODMSG^XMJMFB, but with fewer
"RTN","XMTDF",41,0)
 ; conditions to match on.
"RTN","XMTDF",42,0)
 N XMNOGOOD
"RTN","XMTDF",43,0)
 I $D(XMF("SUBJ")),$$UP^XLFSTR(XMZSUBJ)'[XMF("SUBJ") Q 0
"RTN","XMTDF",44,0)
 I $D(XMF("FROM")) D  Q:XMNOGOOD 0
"RTN","XMTDF",45,0)
 . I XMF("FROM")=+XMF("FROM"),XMF("FROM")=XMZFROM S XMNOGOOD=0 Q
"RTN","XMTDF",46,0)
 . S XMNOGOOD=1
"RTN","XMTDF",47,0)
 . Q:XMF("FROM")'["@"
"RTN","XMTDF",48,0)
 . S XMZFROM=$$UP^XLFSTR(XMZFROM)
"RTN","XMTDF",49,0)
 . Q:$P(XMZFROM,"@")'[$P(XMF("FROM"),"@")
"RTN","XMTDF",50,0)
 . Q:$P(XMZFROM,"@",2)'[$P(XMF("FROM"),"@",2)
"RTN","XMTDF",51,0)
 . S XMNOGOOD=0
"RTN","XMTDF",52,0)
 I $D(XMF("TO")) D  Q:XMNOGOOD 0
"RTN","XMTDF",53,0)
 . I $D(^XMB(3.9,XMZ,6,"B",XMF("TO"))) S XMNOGOOD=0 Q
"RTN","XMTDF",54,0)
 . I $L(XMF("TO"))>30,$D(^XMB(3.9,XMZ,6,"B",$E(XMF("TO"),1,30))),XMF("TO")=$P($G(^XMB(3.9,XMZ,6,+$O(^XMB(3.9,XMZ,6,"B",$E(XMF("TO"),1,30),0)),0)),U,1) S XMNOGOOD=0 Q
"RTN","XMTDF",55,0)
 . S XMNOGOOD=1
"RTN","XMTDF",56,0)
 . Q:XMF("TO")'["@"
"RTN","XMTDF",57,0)
 . N XMTOX,XMTO
"RTN","XMTDF",58,0)
 . S XMTO=""
"RTN","XMTDF",59,0)
 . F  S XMTO=$O(^XMB(3.9,XMZ,6,"B",XMTO)) Q:XMTO=""  D  Q:'XMNOGOOD
"RTN","XMTDF",60,0)
 . . Q:XMTO'["@"
"RTN","XMTDF",61,0)
 . . S XMTOX=$$UP^XLFSTR(XMTO)
"RTN","XMTDF",62,0)
 . . Q:$P(XMTOX,"@")'[$P(XMF("TO"),"@")
"RTN","XMTDF",63,0)
 . . Q:$P(XMTOX,"@",2)'[$P(XMF("TO"),"@",2)
"RTN","XMTDF",64,0)
 . . S XMNOGOOD=0
"RTN","XMTDF",65,0)
 Q 1
"RTN","XMTDF",66,0)
BASKET(X) ; Input Transform for file 3.7, subfile 3.715, field 2 BASKET
"RTN","XMTDF",67,0)
 N DIC,Y,DA
"RTN","XMTDF",68,0)
 S DA(1)=$G(XMDUZ,DUZ)
"RTN","XMTDF",69,0)
 S DIC="^XMB(3.7,"_DA(1)_",2,"
"RTN","XMTDF",70,0)
 S DIC("P")=3.701
"RTN","XMTDF",71,0)
 S DIC(0)="EQL"
"RTN","XMTDF",72,0)
 D ^DIC
"RTN","XMTDF",73,0)
 I $P(Y,U)=1 K X Q  ; May not filter to the IN basket
"RTN","XMTDF",74,0)
 I Y>0 S X=$P(Y,U,2) Q
"RTN","XMTDF",75,0)
 K X
"RTN","XMTDF",76,0)
 Q
"RTN","XMTDF",77,0)
BSKTHELP ; Executable Help for file 3.7, subfile 3.715, field 2 BASKET
"RTN","XMTDF",78,0)
 N DIC,Y
"RTN","XMTDF",79,0)
 Q:"??"'[X
"RTN","XMTDF",80,0)
 S DIC("S")="I X'="""_$$EZBLD^DIALOG(37005)_"""" ; IN
"RTN","XMTDF",81,0)
 S DIC="^XMB(3.7,"_$G(XMDUZ,DUZ)_",2,"
"RTN","XMTDF",82,0)
 S DIC(0)="EQL"
"RTN","XMTDF",83,0)
 D ^DIC
"RTN","XMTDF",84,0)
 Q
"RTN","XMTDF",85,0)
FROM(X) ; Input Transform for file 3.7, subfile 3.715, field 5 FROM
"RTN","XMTDF",86,0)
 S X=$$UP^XLFSTR(X)
"RTN","XMTDF",87,0)
 I X["@" K:$L(X)<2!($L(X)>45) X Q
"RTN","XMTDF",88,0)
 N DIC,Y
"RTN","XMTDF",89,0)
 S DIC="^VA(200,",DIC(0)="MNE"
"RTN","XMTDF",90,0)
 D ^DIC
"RTN","XMTDF",91,0)
 I Y=-1 K X Q
"RTN","XMTDF",92,0)
 S X=+Y
"RTN","XMTDF",93,0)
 Q
"RTN","XMTDF",94,0)
TO(X) ; Input Transform for file 3.7, subfile 3.715, field 6 ADDRESSED TO
"RTN","XMTDF",95,0)
 I X["@" D  Q
"RTN","XMTDF",96,0)
 . S X=$$UP^XLFSTR(X)
"RTN","XMTDF",97,0)
 . K:$L(X)<2!($L(X)>55) X
"RTN","XMTDF",98,0)
 I $E(X,1,2)="G."!($E(X,1,2)="g.") D  Q
"RTN","XMTDF",99,0)
 . ; See GETPERS^XMJMF2 for another way to do the lookup.  The difference
"RTN","XMTDF",100,0)
 . ; is that the other way does not let unauthorized senders pick groups
"RTN","XMTDF",101,0)
 . ; which have authorized senders.
"RTN","XMTDF",102,0)
 . S X=$E(X,3,99)
"RTN","XMTDF",103,0)
 . N DIC,Y
"RTN","XMTDF",104,0)
 . ; Screen:  Group is public OR user is organizer
"RTN","XMTDF",105,0)
 . ;          OR group is unrestricted and user is member
"RTN","XMTDF",106,0)
 . S DIC("S")="N XMR S XMR=^(0) I $S($P(XMR,U,2)=""PU"":1,$P($G(^XMB(3.8,+Y,3),.5),U)=$G(XMDUZ,DUZ):1,+$P(XMR,U,6):0,$D(^XMB(3.8,+Y,1,""B"",$G(XMDUZ,DUZ))):1,1:0)"
"RTN","XMTDF",107,0)
 . S DIC="^XMB(3.8,"
"RTN","XMTDF",108,0)
 . S DIC(0)="MEZ"
"RTN","XMTDF",109,0)
 . D ^DIC
"RTN","XMTDF",110,0)
 . I Y=-1 K X Q
"RTN","XMTDF",111,0)
 . S X="G."_$P(Y,U,2)_$S($P(Y(0),U,6):$$EZBLD^DIALOG(39135),1:"") ; " [Private Mail Group]"
"RTN","XMTDF",112,0)
 S X=$$UP^XLFSTR(X)
"RTN","XMTDF",113,0)
 N DIC,Y
"RTN","XMTDF",114,0)
 S DIC="^VA(200,",DIC(0)="MNE"
"RTN","XMTDF",115,0)
 D ^DIC
"RTN","XMTDF",116,0)
 I Y=-1 K X Q
"RTN","XMTDF",117,0)
 S X=$P(Y,U,2)
"RTN","XMTDF",118,0)
 Q
"RTN","XMTDF",119,0)
FWDTO(XMADDR,XMIA) ; Input Transform for file 3.7, subfile 3.715,
"RTN","XMTDF",120,0)
 ; subfile 3.7159, field .01 FORWARD TO
"RTN","XMTDF",121,0)
 N DO ; to keep FileMan from exploding (that's D-oh)
"RTN","XMTDF",122,0)
 N XMERROR,XMRESTR,XMINSTR,XMFULL
"RTN","XMTDF",123,0)
 S XMINSTR("ADDR FLAGS")="X" ; do not create ^TMP(, just check.
"RTN","XMTDF",124,0)
 D ADDRESS^XMXADDR(DUZ,XMADDR,.XMFULL,.XMERROR)
"RTN","XMTDF",125,0)
 I $D(XMERROR) K XMADDR Q
"RTN","XMTDF",126,0)
 S XMADDR=XMFULL
"RTN","XMTDF",127,0)
 Q
"RTN","XMTDF",128,0)
DELFWDTO(XMUSER,XMFILTER,XMIEN,XMFWD,XMERROR) ; Delete a user's invalid FORWARD TO address.
"RTN","XMTDF",129,0)
 N XMPARM,XMINSTR,XMFDA
"RTN","XMTDF",130,0)
 S XMFDA(3.7159,XMIEN_","_XMFILTER_","_XMUSER_",",.01)="@"
"RTN","XMTDF",131,0)
 D FILE^DIE("","XMFDA")
"RTN","XMTDF",132,0)
 S XMINSTR("FROM")=.5
"RTN","XMTDF",133,0)
 S XMPARM(1)=XMFWD,XMPARM(3)=XMERROR
"RTN","XMTDF",134,0)
 S XMPARM(2)=$P(^XMB(3.7,XMUSER,15,XMFILTER,0),U,1) ; filter name
"RTN","XMTDF",135,0)
 D TASKBULL^XMXBULL(.5,"XM FILTER FWD ADDRESS DELETE",.XMPARM,"",XMUSER,.XMINSTR)
"RTN","XMTDF",136,0)
 Q
"RTN","XMTDF",137,0)
OKFWD(XMZ) ; Is it OK to automatically forward this message?
"RTN","XMTDF",138,0)
 N XMZREC
"RTN","XMTDF",139,0)
 S XMZREC=$G(^XMB(3.9,XMZ,0))
"RTN","XMTDF",140,0)
 Q:$$CLOSED^XMXSEC(XMZREC) 0
"RTN","XMTDF",141,0)
 Q:$$CONFID^XMXSEC(XMZREC) 0
"RTN","XMTDF",142,0)
 Q 1
"RTN","XMTDL")
0^76^B60982718
"RTN","XMTDL",1,0)
XMTDL ;ISC-SF/GMB-Deliver local mail to mailbox ;05/21/2002  06:54
"RTN","XMTDL",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMTDL",3,0)
 ; Replaces ^XMAD0,GO^XMADGO,STATS^XMADJF0,^XMADJF1,^XMADJF1A (ISC-WASH/CAP)
"RTN","XMTDL",4,0)
GO ;
"RTN","XMTDL",5,0)
 ; Variables provided through TASKMAN: XMHANG,XMGROUP,XMQUEUE
"RTN","XMTDL",6,0)
 N XMTSTAMP,XMUID,XMIDLE,X,XMMCNT,XMRCNT,XMACNT
"RTN","XMTDL",7,0)
 ; XMMCNT  # of messages/responses processed
"RTN","XMTDL",8,0)
 ; XMRCNT  # of potential local recipients to process
"RTN","XMTDL",9,0)
 ; XMACNT  # of actual local recipients processed
"RTN","XMTDL",10,0)
 S:$D(ZTQUEUED) ZTREQ="@"
"RTN","XMTDL",11,0)
 Q:$P($G(^XMB(1,1,0)),U,16)
"RTN","XMTDL",12,0)
 I $$NEWERR^%ZTER N $ETRAP,$ESTACK S $ETRAP="D R^XMCTRAP"
"RTN","XMTDL",13,0)
 E  S X="R^XMCTRAP",@^%ZOSF("TRAP")
"RTN","XMTDL",14,0)
 I $D(^%ZOSF("TRAP")) S X="^%ET",@^("TRAP")
"RTN","XMTDL",15,0)
 I $D(^%ZOSF("PRIORITY")) S X=$S(+$G(^XMB(1,1,.13)):+^(.13),1:5) X ^%ZOSF("PRIORITY")
"RTN","XMTDL",16,0)
 L +^XMBPOST(XMGROUP,XMQUEUE):0 E  H 0 Q
"RTN","XMTDL",17,0)
 S XMIDLE=0
"RTN","XMTDL",18,0)
 F  D  Q:$P($G(^XMB(1,1,0)),U,16)!($$TSTAMP^XMXUTIL1-XMIDLE>900)
"RTN","XMTDL",19,0)
 . F  S XMTSTAMP=$O(^XMBPOST(XMGROUP,XMQUEUE,"")) Q:XMTSTAMP'>0  D
"RTN","XMTDL",20,0)
 . . S XMIDLE=0
"RTN","XMTDL",21,0)
 . . F  S XMUID=$O(^XMBPOST(XMGROUP,XMQUEUE,XMTSTAMP,"")) Q:XMUID=""  D
"RTN","XMTDL",22,0)
 . . . I XMGROUP="M" D
"RTN","XMTDL",23,0)
 . . . . D MDELIVER(XMGROUP,XMQUEUE,XMTSTAMP,XMUID,.XMMCNT,.XMRCNT,.XMACNT)
"RTN","XMTDL",24,0)
 . . . E  D
"RTN","XMTDL",25,0)
 . . . . D RDELIVER(XMGROUP,XMQUEUE,XMTSTAMP,XMUID,.XMMCNT,.XMRCNT,.XMACNT)
"RTN","XMTDL",26,0)
 . . . K ^XMBPOST(XMGROUP,XMQUEUE,XMTSTAMP,XMUID)
"RTN","XMTDL",27,0)
 . . . D:'$D(^XMBPOST("STATS","OFF")) STATS^XMTDL1(XMGROUP,XMQUEUE,XMMCNT,XMRCNT,XMACNT)  ; Delivered to # users
"RTN","XMTDL",28,0)
 . L +^XMBPOST("QSTATS",XMGROUP,XMQUEUE)
"RTN","XMTDL",29,0)
 . S ^XMBPOST(XMGROUP,XMQUEUE)=""
"RTN","XMTDL",30,0)
 . L -^XMBPOST("QSTATS",XMGROUP,XMQUEUE)
"RTN","XMTDL",31,0)
 . S:XMIDLE=0 XMIDLE=$$TSTAMP^XMXUTIL1
"RTN","XMTDL",32,0)
 . H XMHANG
"RTN","XMTDL",33,0)
 L -^XMBPOST(XMGROUP,XMQUEUE)
"RTN","XMTDL",34,0)
 Q
"RTN","XMTDL",35,0)
RDELIVER(XMGROUP,XMQUEUE,XMTSTAMP,XMZ,XMMCNT,XMRCNT,XMACNT) ; was ^XMADJF1
"RTN","XMTDL",36,0)
 ; Note: We know that XMGROUP="R" here
"RTN","XMTDL",37,0)
 N XMZR,XMREC,XMFROM,XMFLIST,XMFIRST,XMFDA,I,XMZREC,XMZSUBJ,XMZFROM,XMZDATE,XMRESPS,XMTO,XMZRLIST
"RTN","XMTDL",38,0)
 ; XMFIRST sender of the first response processed
"RTN","XMTDL",39,0)
 K ^XMBPOST(XMGROUP,XMQUEUE,"B",XMZ,XMTSTAMP) ; Accept no more additions to this batch of replies
"RTN","XMTDL",40,0)
 ;Post responses to message response multiple, keeping track of number of deliveries
"RTN","XMTDL",41,0)
 S (XMMCNT,XMRCNT,XMACNT)=0
"RTN","XMTDL",42,0)
 I '$D(^XMB(3.9,XMZ,0)) D  Q
"RTN","XMTDL",43,0)
 . D BADERR(36240,XMZ) ; Message |1| does not exist.  Can't post responses to it.
"RTN","XMTDL",44,0)
 . S XMZR=""
"RTN","XMTDL",45,0)
 . F  S XMZR=$O(^XMBPOST(XMGROUP,XMQUEUE,XMTSTAMP,XMZ,XMZR)) Q:XMZR=""  S XMRCNT=XMRCNT+^(XMZR),XMMCNT=XMMCNT+1
"RTN","XMTDL",46,0)
 S XMZREC=^XMB(3.9,XMZ,0)
"RTN","XMTDL",47,0)
 S XMZSUBJ=$P(XMZREC,U),XMZFROM=$P(XMZREC,U,2),XMZDATE=$P(XMZREC,U,3)
"RTN","XMTDL",48,0)
 S:XMZFROM="" XMZFROM=.5
"RTN","XMTDL",49,0)
 ; If the sender of the original msg is not a recipient, make him one.
"RTN","XMTDL",50,0)
 I XMZFROM=+XMZFROM,'$D(^XMB(3.9,XMZ,1,"C",XMZFROM)) D
"RTN","XMTDL",51,0)
 . D ADDRECP(XMZ,$P(XMZREC,U,7)["P",XMZFROM)
"RTN","XMTDL",52,0)
 . ;D LASTREAD(XMZ,XMZFROM,XMZDATE)
"RTN","XMTDL",53,0)
 S XMZR=""
"RTN","XMTDL",54,0)
 F  S XMZR=$O(^XMBPOST(XMGROUP,XMQUEUE,XMTSTAMP,XMZ,XMZR)) Q:XMZR=""  S XMREC=^(XMZR) D
"RTN","XMTDL",55,0)
 . S XMMCNT=XMMCNT+1
"RTN","XMTDL",56,0)
 . S XMRCNT=XMRCNT+$P(XMREC,U,1)
"RTN","XMTDL",57,0)
 . I '$D(^XMB(3.9,XMZR)) D  Q
"RTN","XMTDL",58,0)
 . . N XMPARM S XMPARM(1)=XMZ,XMPARM(2)=XMZR
"RTN","XMTDL",59,0)
 . . D BADERR(36241,.XMPARM) ; Response |2| to message |1| does not exist.  Can't deliver it.
"RTN","XMTDL",60,0)
 . ;S XMFDA(3.9001,"+1,"_XMZ_",",.01)=XMZR ; *** Moved to ^XMKP ***
"RTN","XMTDL",61,0)
 . ;D UPDATE^DIE("","XMFDA")  ; Add to response multiple in original msg
"RTN","XMTDL",62,0)
 . S XMZRLIST(XMZR)="" ; (not used, but helps in debugging)
"RTN","XMTDL",63,0)
 . S XMFROM=$P(XMREC,U,2)
"RTN","XMTDL",64,0)
 . S:'$D(XMFIRST) XMFIRST=XMFROM
"RTN","XMTDL",65,0)
 . S XMFLIST(XMFROM)=$G(XMFLIST(XMFROM))+1  ; Number of replies by this user
"RTN","XMTDL",66,0)
 . Q:XMFROM="NR"  ; Network reply *** If we implement fully networked mail, we must get the real sender, and make sure s/he's in the 'addressed to' and 'recipient' multiples.
"RTN","XMTDL",67,0)
 . ; If the sender of the reply is not a recipient, make him one.
"RTN","XMTDL",68,0)
 . I XMFROM,'$D(^XMB(3.9,XMZ,1,"C",XMFROM)) D ADDRECP(XMZ,$P(XMZREC,U,7)["P",XMFROM)
"RTN","XMTDL",69,0)
 Q:'$D(XMFLIST)
"RTN","XMTDL",70,0)
 I $O(XMFLIST(""))=XMFIRST,$O(XMFLIST(XMFIRST))="" S XMFROM=XMFIRST  ; There's one sender
"RTN","XMTDL",71,0)
 E  S XMFROM=""  ; There's multiple senders
"RTN","XMTDL",72,0)
 ; At this point, XMFROM has the sender's DUZ (or 'NR' if remote)
"RTN","XMTDL",73,0)
 ; if there was only 1 sender.
"RTN","XMTDL",74,0)
 ; If there was more than 1 sender, then XMFROM="", so that ^XMTDL1 will
"RTN","XMTDL",75,0)
 ; make the msg new for all recipients.
"RTN","XMTDL",76,0)
 ; Now, deliver replies...
"RTN","XMTDL",77,0)
 S XMRESPS=$P(^XMB(3.9,XMZ,3,0),U,4)  ; Number of replies to msg
"RTN","XMTDL",78,0)
 S XMTO=""
"RTN","XMTDL",79,0)
 F  S XMTO=$O(^XMB(3.9,XMZ,1,"C",XMTO)) Q:XMTO'>0  D
"RTN","XMTDL",80,0)
 . S I=$O(^XMB(3.9,XMZ,1,"C",XMTO,0))
"RTN","XMTDL",81,0)
 . Q:$G(^XMB(3.9,XMZ,1,I,"D"))  ; User terminated
"RTN","XMTDL",82,0)
 . I $D(XMFLIST(XMTO)) D:XMTO=XMFIRST GOTREPLY(XMZ,XMRESPS,I,XMFLIST(XMTO)) Q:XMTO=XMFROM  ; If recipient is the only sender, don't bother delivering to him, because he's already seen it.
"RTN","XMTDL",83,0)
 . Q:$P(^XMB(3.9,XMZ,1,I,0),U,2)=XMRESPS  ; Don't deliver if recipient has already seen all responses
"RTN","XMTDL",84,0)
 . S XMACNT=XMACNT+1
"RTN","XMTDL",85,0)
 . D DELIVER^XMTDL2(XMTO,XMZ,XMZSUBJ,XMZFROM,XMFROM,1)
"RTN","XMTDL",86,0)
 Q
"RTN","XMTDL",87,0)
ADDRECP(XMZ,XMPRI,XMRECP) ; Add a recipient to the message
"RTN","XMTDL",88,0)
 N XMFDA
"RTN","XMTDL",89,0)
 S XMFDA(3.91,"+1,"_XMZ_",",.01)=XMRECP
"RTN","XMTDL",90,0)
 I XMPRI,+XMRECP=XMRECP,$P($G(^XMB(3.7,XMRECP,0)),U,11) S XMFDA(3.91,"+1,"_XMZ_",",10)=$P(^(0),U,11) ; priority response flag
"RTN","XMTDL",91,0)
 D UPDATE^DIE("","XMFDA")
"RTN","XMTDL",92,0)
 S XMFDA(3.911,"+1,"_XMZ_",",.01)=$$NAME^XMXUTIL(XMRECP)
"RTN","XMTDL",93,0)
 D UPDATE^DIE("","XMFDA")
"RTN","XMTDL",94,0)
 Q
"RTN","XMTDL",95,0)
LASTREAD(XMZ,XMZFROM,XMZDATE) ; Note that the sender has read the original message
"RTN","XMTDL",96,0)
 N XMFDA,XMIEN
"RTN","XMTDL",97,0)
 S XMIEN=$O(^XMB(3.9,XMZ,1,"C",XMZFROM,0)) Q:'XMIEN
"RTN","XMTDL",98,0)
 S XMFDA(3.91,XMIEN_","_XMZ_",",1)=0        ; Read the original msg
"RTN","XMTDL",99,0)
 S XMFDA(3.91,XMIEN_","_XMZ_",",2)=XMZDATE  ; Last Read
"RTN","XMTDL",100,0)
 S XMFDA(3.91,XMIEN_","_XMZ_",",11)=XMZDATE ; First Read
"RTN","XMTDL",101,0)
 D FILE^DIE("","XMFDA")
"RTN","XMTDL",102,0)
 Q
"RTN","XMTDL",103,0)
GOTREPLY(XMZ,XMRESPS,XMIEN,XMRNEW) ; Note that recipient has seen his own reply.
"RTN","XMTDL",104,0)
 N XMFDA
"RTN","XMTDL",105,0)
 ; If last reply seen + # responses made = total responses...
"RTN","XMTDL",106,0)
 I $P(^XMB(3.9,XMZ,1,XMIEN,0),U,2)+XMRNEW=XMRESPS D
"RTN","XMTDL",107,0)
 . S XMFDA(3.91,XMIEN_","_XMZ_",",1)=XMRESPS
"RTN","XMTDL",108,0)
 . D FILE^DIE("","XMFDA")
"RTN","XMTDL",109,0)
 Q
"RTN","XMTDL",110,0)
MDELIVER(XMGROUP,XMQUEUE,XMTSTAMP,XMUID,XMMCNT,XMRCNT,XMACNT) ; was ^XMADJF1
"RTN","XMTDL",111,0)
 N XMZSUBJ,XMZFROM,XMZDATE,XMZPDATE,XMZBSKT,XMREC,XMZ,XMK,XMDEL,XMBCAST
"RTN","XMTDL",112,0)
 ; Note: We know that XMGROUP="M" here
"RTN","XMTDL",113,0)
 ; If $L(XMUID,U)>1, it's a forwarded message, else it's a new message.
"RTN","XMTDL",114,0)
 S XMMCNT=1
"RTN","XMTDL",115,0)
 S XMREC=^XMBPOST(XMGROUP,XMQUEUE,XMTSTAMP,XMUID)
"RTN","XMTDL",116,0)
 S XMRCNT=+$P(XMREC,U,1)
"RTN","XMTDL",117,0)
 S XMACNT=0
"RTN","XMTDL",118,0)
 S XMZ=+XMUID
"RTN","XMTDL",119,0)
 I '$D(^XMB(3.9,XMZ,0)) D  Q
"RTN","XMTDL",120,0)
 . I $L(XMUID,U)>1 K ^XMBPOST("FWD",XMUID_U_XMTSTAMP)
"RTN","XMTDL",121,0)
 . D BADERR(36242,XMZ) ; Message |1| does not exist.  Can't deliver it.
"RTN","XMTDL",122,0)
 S XMZSUBJ=$P(^XMB(3.9,XMZ,0),U),XMZFROM=$P(^(0),U,2),XMZDATE=$P(^(0),U,3),XMZPDATE=$P(^(0),U,6)
"RTN","XMTDL",123,0)
 S:XMZFROM="" XMZFROM=.5
"RTN","XMTDL",124,0)
 I XMZPDATE,XMZPDATE'>DT D  Q  ; If purge date has passed, don't deliver
"RTN","XMTDL",125,0)
 . I $L(XMUID,U)>1 K ^XMBPOST("FWD",XMUID_U_XMTSTAMP)
"RTN","XMTDL",126,0)
 I $P(XMREC,U,2)'="" D  ; basket selection
"RTN","XMTDL",127,0)
 . I $L(XMUID,U)=1 S XMK(XMZFROM)=$P(XMREC,U,2) Q  ; sending person
"RTN","XMTDL",128,0)
 . I $P(XMUID,U,2) S XMK($P(XMUID,U,2))=$P(XMREC,U,2) ; forwarding person
"RTN","XMTDL",129,0)
 I $P(XMREC,U,3)'="" S XMK(.6)=$P(XMREC,U,3)
"RTN","XMTDL",130,0)
 I $P(XMREC,U,4) S XMDEL(.6)=$P(XMREC,U,4)
"RTN","XMTDL",131,0)
 S XMBCAST=($P(XMREC,U,5)'="")
"RTN","XMTDL",132,0)
 S XMZBSKT=$P($G(^XMB(3.9,XMZ,.5)),U,1)
"RTN","XMTDL",133,0)
 I $L(XMUID,U)=1 D NEW(XMGROUP,XMQUEUE,XMTSTAMP,XMZ,XMBCAST,.XMK,.XMDEL,XMZSUBJ,XMZFROM,XMZDATE,XMZPDATE,XMZBSKT,.XMACNT) Q
"RTN","XMTDL",134,0)
 D FORWARD(XMGROUP,XMQUEUE,XMTSTAMP,XMUID,XMZ,XMBCAST,.XMK,.XMDEL,XMZSUBJ,XMZFROM,XMZPDATE,XMZBSKT,.XMACNT)
"RTN","XMTDL",135,0)
 Q
"RTN","XMTDL",136,0)
NEW(XMGROUP,XMQUEUE,XMTSTAMP,XMZ,XMBCAST,XMK,XMDEL,XMZSUBJ,XMZFROM,XMZDATE,XMZPDATE,XMZBSKT,XMACNT) ;
"RTN","XMTDL",137,0)
 D:XMZFROM=+XMZFROM LASTREAD(XMZ,XMZFROM,XMZDATE)
"RTN","XMTDL",138,0)
 I XMBCAST D BRODCAST^XMTDL1(XMZ,XMZSUBJ,XMZFROM,XMZFROM,.XMK,.XMDEL,XMZPDATE,XMZBSKT,.XMACNT) Q
"RTN","XMTDL",139,0)
 N XMTO
"RTN","XMTDL",140,0)
 S XMTO=0  ; Q: on next line ensures only local user delivery
"RTN","XMTDL",141,0)
 F  S XMTO=$O(^XMB(3.9,XMZ,1,"C",XMTO)) Q:XMTO'>0  D
"RTN","XMTDL",142,0)
 . S XMACNT=XMACNT+1
"RTN","XMTDL",143,0)
 . D DELIVER^XMTDL2(XMTO,XMZ,XMZSUBJ,XMZFROM,XMZFROM,0,$G(XMK(XMTO)),$G(XMDEL(XMTO),XMZPDATE),XMZBSKT)
"RTN","XMTDL",144,0)
 Q
"RTN","XMTDL",145,0)
FORWARD(XMGROUP,XMQUEUE,XMTSTAMP,XMUID,XMZ,XMBCAST,XMK,XMDEL,XMZSUBJ,XMZFROM,XMZPDATE,XMZBSKT,XMACNT) ;
"RTN","XMTDL",146,0)
 N I,J,XMFROM,XMTO,XMTOLIST
"RTN","XMTDL",147,0)
 S XMFROM=$P(XMUID,U,2)
"RTN","XMTDL",148,0)
 I XMBCAST D  Q  ; Broadcast message
"RTN","XMTDL",149,0)
 . D BRODCAST^XMTDL1(XMZ,XMZSUBJ,XMZFROM,XMFROM,.XMK,.XMDEL,XMZPDATE,XMZBSKT,.XMACNT)
"RTN","XMTDL",150,0)
 S I=0
"RTN","XMTDL",151,0)
 S XMUID=XMUID_U_XMTSTAMP
"RTN","XMTDL",152,0)
 F  S I=$O(^XMBPOST("FWD",XMUID,I)) Q:'I  S XMTOLIST=^(I) D
"RTN","XMTDL",153,0)
 . F J=1:1:$L(XMTOLIST,U) D
"RTN","XMTDL",154,0)
 . . S XMTO=$P(XMTOLIST,U,J)
"RTN","XMTDL",155,0)
 . . Q:$O(^XMB(3.7,"M",XMZ,XMTO,""))  ; User already has msg
"RTN","XMTDL",156,0)
 . . Q:'$D(^XMB(3.9,XMZ,1,"C",XMTO))  ; User is not on recipient list (Should never happen
"RTN","XMTDL",157,0)
 . . S XMACNT=XMACNT+1
"RTN","XMTDL",158,0)
 . . D DELIVER^XMTDL2(XMTO,XMZ,XMZSUBJ,XMZFROM,XMFROM,0,$G(XMK(XMTO)),$G(XMDEL(XMTO),XMZPDATE),XMZBSKT)
"RTN","XMTDL",159,0)
 K ^XMBPOST("FWD",XMUID)
"RTN","XMTDL",160,0)
 Q
"RTN","XMTDL",161,0)
BADERR(XMDIALOG,XMPARM) ;
"RTN","XMTDL",162,0)
 N XMTEXT,XMINSTR
"RTN","XMTDL",163,0)
 D BLD^DIALOG(XMDIALOG,.XMPARM,"","XMTEXT")
"RTN","XMTDL",164,0)
 S XMINSTR("FROM")="MailMan"
"RTN","XMTDL",165,0)
 D TASKBULL^XMXBULL(DUZ,"XM_TRANSMISSION_ERROR","","XMTEXT",.5,.XMINSTR)
"RTN","XMTDL",166,0)
 Q
"RTN","XMTDL1")
0^336^B6567327
"RTN","XMTDL1",1,0)
XMTDL1 ;ISC-SF/GMB-Deliver local mail to mailbox (cont.) ;08/19/2002  09:43
"RTN","XMTDL1",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMTDL1",3,0)
BRODCAST(XMZ,XMZSUBJ,XMZFROM,XMFROM,XMK,XMDEL,XMZPDATE,XMZBSKT,XMACNT) ;
"RTN","XMTDL1",4,0)
 N XMTO,XMREC,XMIA,XMNOFWD
"RTN","XMTDL1",5,0)
 ; Don't forward message if this is FORUM and it was sent to G.EVERYBODY.
"RTN","XMTDL1",6,0)
 S XMNOFWD=$S('$$FORUM^XMXADDRD:0,'$D(^XMB(3.9,XMZ,6,"B","G.EVERYBODY")):0,1:1)
"RTN","XMTDL1",7,0)
 D INIT^XMXADDR
"RTN","XMTDL1",8,0)
 S (XMTO,XMIA)=0
"RTN","XMTDL1",9,0)
 F  S XMTO=$O(^XMB(3.7,XMTO)) Q:'XMTO  D
"RTN","XMTDL1",10,0)
 . Q:$P($G(^VA(200,XMTO,0)),U,3)=""!($P($G(^(.1)),U,2)="")!($P($G(^(201)),U)="")  ; Quit if no access code, or verify code, or primary menu
"RTN","XMTDL1",11,0)
 . Q:$D(^XUSEC("XM NO BROADCASTS",XMTO))  ; Quit if user doesn't want broadcast messages
"RTN","XMTDL1",12,0)
 . S XMACNT=XMACNT+1
"RTN","XMTDL1",13,0)
 . S XMREC=$G(^XMB(3.7,XMTO,0)) Q:XMREC=""
"RTN","XMTDL1",14,0)
 . I $P(XMREC,U,2)=""!XMNOFWD D DELIVER^XMTDL2(XMTO,XMZ,XMZSUBJ,XMZFROM,XMFROM,0,$G(XMK(XMTO)),$G(XMDEL(XMTO),XMZPDATE),XMZBSKT) Q
"RTN","XMTDL1",15,0)
 . N XMERROR,XMFULL
"RTN","XMTDL1",16,0)
 . D REMOTE^XMXADDR3(.5,$P(XMREC,U,2),0,"","",.XMFULL)
"RTN","XMTDL1",17,0)
 . I $D(XMERROR) D DELFWD^XMVVITA(XMTO,$P(XMREC,U,2),XMERROR)
"RTN","XMTDL1",18,0)
 . I '$D(XMERROR),$D(^TMP("XMY",$J,XMFULL)) S ^TMP("XMY",$J,XMFULL,"F")=XMTO
"RTN","XMTDL1",19,0)
 . I $P(XMREC,U,8)!$D(XMERROR)!'$D(^TMP("XMY",$J,$G(XMFULL,"?"))) D DELIVER^XMTDL2(XMTO,XMZ,XMZSUBJ,XMZFROM,XMFROM,0,$G(XMK(XMTO)),$G(XMDEL(XMTO),XMZPDATE),XMZBSKT)
"RTN","XMTDL1",20,0)
 S XMTO=0
"RTN","XMTDL1",21,0)
 F  S XMTO=$O(^TMP("XMY",$J,XMTO)) Q:+XMTO'=XMTO  K ^(XMTO) ; Don't forward to locals
"RTN","XMTDL1",22,0)
 I $$GOTADDR^XMXADDR D
"RTN","XMTDL1",23,0)
 . N XMINSTR
"RTN","XMTDL1",24,0)
 . S XMINSTR("FWD BY")=""
"RTN","XMTDL1",25,0)
 . D FWD^XMKP(.5,XMZ,.XMINSTR)
"RTN","XMTDL1",26,0)
 D CLEANUP^XMXADDR
"RTN","XMTDL1",27,0)
 Q
"RTN","XMTDL1",28,0)
STATS(XMGROUP,XMQUEUE,XMMCNT,XMRCNT,XMACNT) ;
"RTN","XMTDL1",29,0)
 ; The following global is incremented in STATS^XMKPLQ
"RTN","XMTDL1",30,0)
 ; # messages in queue^# recipients anticipated
"RTN","XMTDL1",31,0)
 N XMSTATS
"RTN","XMTDL1",32,0)
 L +^XMBPOST("QSTATS",XMGROUP,XMQUEUE)
"RTN","XMTDL1",33,0)
 S XMSTATS=^XMBPOST(XMGROUP,XMQUEUE),^(XMQUEUE)=($P(XMSTATS,U)-XMMCNT)_U_($P(XMSTATS,U,2)-XMRCNT)
"RTN","XMTDL1",34,0)
 L -^XMBPOST("QSTATS",XMGROUP,XMQUEUE)
"RTN","XMTDL1",35,0)
 ; The following global is incremented here only.
"RTN","XMTDL1",36,0)
 ; # recipients delivered
"RTN","XMTDL1",37,0)
 L +^XMBPOST("GSTATS",XMGROUP)
"RTN","XMTDL1",38,0)
 S ^(XMGROUP)=$G(^XMBPOST("STATS",XMGROUP))+$G(XMACNT)
"RTN","XMTDL1",39,0)
 L -^XMBPOST("GSTATS",XMGROUP)
"RTN","XMTDL1",40,0)
 Q
"RTN","XMTDL2")
0^337^B37771292
"RTN","XMTDL2",1,0)
XMTDL2 ;ISC-SF/GMB-Deliver local mail to mailbox (cont.) ;04/17/2002  11:31
"RTN","XMTDL2",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMTDL2",3,0)
 ; Replaces ^XMADJF1B (ISC-WASH/CAP)
"RTN","XMTDL2",4,0)
 ; XMTO     Recipient DUZ
"RTN","XMTDL2",5,0)
 ; XMZ      Original XMZ
"RTN","XMTDL2",6,0)
 ; XMZSUBJ  Msg subject
"RTN","XMTDL2",7,0)
 ; XMZFROM  Who sent the original message
"RTN","XMTDL2",8,0)
 ; XMFROM   Who sent the msg or reply, or who forwarded the msg
"RTN","XMTDL2",9,0)
 ; XMREPLY  0=msg is not a reply; 1=msg is a reply
"RTN","XMTDL2",10,0)
 ; XMK      Basket number (or name) to deliver to (as specified by sender XMFROM)
"RTN","XMTDL2",11,0)
 ; XMDEL    Delete Date (as specified by sender XMZFROM)
"RTN","XMTDL2",12,0)
 ; XMKCURR  Basket the msg is currently in
"RTN","XMTDL2",13,0)
DELIVER(XMTO,XMZ,XMZSUBJ,XMZFROM,XMFROM,XMREPLY,XMK,XMDEL,XMZBSKT) ;
"RTN","XMTDL2",14,0)
 N XMKCURR,XMACT
"RTN","XMTDL2",15,0)
 I +XMTO'>0!'$D(^XMB(3.7,XMTO,2)) Q  ; Do not deliver if invalid mailbox
"RTN","XMTDL2",16,0)
 S XMFROM=+$G(XMFROM),XMREPLY=+$G(XMREPLY),XMK=$G(XMK),XMDEL=+$G(XMDEL),XMZBSKT=$G(XMZBSKT)
"RTN","XMTDL2",17,0)
 I XMTO=.6,XMREPLY Q  ; Do not deliver response to Shared,Mail
"RTN","XMTDL2",18,0)
 S XMKCURR=$O(^XMB(3.7,"M",XMZ,XMTO,0)) ; Get basket it is in
"RTN","XMTDL2",19,0)
 I XMKCURR D  Q  ; Already in a basket (ignore any basket sender may have specified)
"RTN","XMTDL2",20,0)
 . Q:'XMREPLY  ; If this is a reply, continue, else it must be a forwarded msg, so quit.
"RTN","XMTDL2",21,0)
 . I XMKCURR=.5 D  Q  ; Msg is in waste basket
"RTN","XMTDL2",22,0)
 . . D CHEKBSKT(XMTO,.XMK,XMZSUBJ,XMZFROM,XMZBSKT,.XMACT) ; Where should it go?
"RTN","XMTDL2",23,0)
 . . Q:XMK=.5
"RTN","XMTDL2",24,0)
 . . D MOVENEW(XMFROM,XMTO,XMK,XMZ,.XMACT) ; Move msg and make it new.
"RTN","XMTDL2",25,0)
 . ; Msg is not in waste basket.  Make the msg new.
"RTN","XMTDL2",26,0)
 . Q:$D(^XMB(3.7,XMTO,"N0",XMKCURR,XMZ))  ; Already new.
"RTN","XMTDL2",27,0)
 . D:XMFROM'=XMTO MAKENEW(XMTO,XMKCURR,XMZ)
"RTN","XMTDL2",28,0)
 ; Not yet in a basket.
"RTN","XMTDL2",29,0)
 ; Reinstated user may not see replies to old msgs which he doesn't already have.
"RTN","XMTDL2",30,0)
 I XMREPLY,$P(^XMB(3.7,XMTO,0),U,7) Q:$$SECRET($P(^(0),U,7),XMZ)
"RTN","XMTDL2",31,0)
 S:$G(XMK)="" XMK=0
"RTN","XMTDL2",32,0)
 I +XMK=XMK D
"RTN","XMTDL2",33,0)
 . D CHEKBSKT(XMTO,.XMK,XMZSUBJ,XMZFROM,XMZBSKT,.XMACT)
"RTN","XMTDL2",34,0)
 E  D
"RTN","XMTDL2",35,0)
 . S XMK=$$NAMEBSKT(XMTO,XMK,"Y")
"RTN","XMTDL2",36,0)
 D ADDNEW($S(XMREPLY:XMFROM,1:XMZFROM),XMTO,XMK,XMZ,XMDEL,.XMACT,XMREPLY)
"RTN","XMTDL2",37,0)
 Q
"RTN","XMTDL2",38,0)
CHEKBSKT(XMTO,XMK,XMZSUBJ,XMZFROM,XMZBSKT,XMACT) ; Basket number (or no basket at all)
"RTN","XMTDL2",39,0)
 N XMREC
"RTN","XMTDL2",40,0)
 S XMREC=$G(^XMB(3.7,XMTO,16))
"RTN","XMTDL2",41,0)
 ; If the message hasn't been sent to a specific basket for this user
"RTN","XMTDL2",42,0)
 ; and the sender specified a delivery basket, and the recipient is
"RTN","XMTDL2",43,0)
 ; OK with that, then use the delivery basket.
"RTN","XMTDL2",44,0)
 ; Note: The IN basket is not considered a 'specific basket'.
"RTN","XMTDL2",45,0)
 I XMK<2,XMZBSKT'="","^^N^"'[(U_$P(XMREC,U,2)_U) S XMK=$$NAMEBSKT(XMTO,XMZBSKT,$P(XMREC,U,2)) Q:XMK
"RTN","XMTDL2",46,0)
 ; If the message hasn't been sent to a specific basket for this user
"RTN","XMTDL2",47,0)
 ; and active filters exist, and filtering is turned on,
"RTN","XMTDL2",48,0)
 ; then filter the message.
"RTN","XMTDL2",49,0)
 I XMK<2,$D(^XMB(3.7,XMTO,15,"AF")),$P(XMREC,U,1)="Y" D FILTER^XMTDF(XMTO,XMZ,XMZSUBJ,XMZFROM,.XMK,"",.XMACT) Q
"RTN","XMTDL2",50,0)
 ; The message was sent to a specific basket for this user.
"RTN","XMTDL2",51,0)
 I XMK Q:$D(^XMB(3.7,XMTO,2,XMK,0))  ; Quit if the basket XMK exists.
"RTN","XMTDL2",52,0)
 S XMK=1 ; Since the basket doesn't exist, force to the IN basket
"RTN","XMTDL2",53,0)
 Q:$D(^XMB(3.7,XMTO,2,XMK,0))  ; Quit if the IN basket exists.
"RTN","XMTDL2",54,0)
 D MAKEBSKT^XMXBSKT(XMTO,XMK,$$EZBLD^DIALOG(37005)) ; Create the "IN" basket
"RTN","XMTDL2",55,0)
 Q
"RTN","XMTDL2",56,0)
NAMEBSKT(XMTO,XMKN,XMZBOK) ; Basket name (not number)
"RTN","XMTDL2",57,0)
 N XMK
"RTN","XMTDL2",58,0)
 S XMK=$O(^XMB(3.7,XMTO,2,"B",XMKN,0))
"RTN","XMTDL2",59,0)
 S:'XMK XMK=$$FIND1^DIC(3.701,","_XMTO_",","X",$$LOW^XLFSTR(XMKN))
"RTN","XMTDL2",60,0)
 I XMK D  Q XMK
"RTN","XMTDL2",61,0)
 . Q:XMZBOK'="S"  ; 'YES' or 'EXISTING ONLY'
"RTN","XMTDL2",62,0)
 . S:$P(^XMB(3.7,XMTO,2,XMK,0),U,3)'="Y" XMK=0  ; 'SELECTED ONLY'
"RTN","XMTDL2",63,0)
 ; Basket not found
"RTN","XMTDL2",64,0)
 Q:XMZBOK'="Y" 0  ; quit if not 'YES'
"RTN","XMTDL2",65,0)
 I XMKN=$$EZBLD^DIALOG(37004) S XMK=.5 D MAKEBSKT^XMXBSKT(XMTO,XMK,XMKN) Q XMK  ; "WASTE"
"RTN","XMTDL2",66,0)
 I XMKN=$$EZBLD^DIALOG(37005) S XMK=1 D MAKEBSKT^XMXBSKT(XMTO,XMK,XMKN) Q XMK  ; "IN"
"RTN","XMTDL2",67,0)
 D MAKEBSKT^XMXBSKT(XMTO,.XMK,XMKN)
"RTN","XMTDL2",68,0)
 Q XMK
"RTN","XMTDL2",69,0)
ADDNEW(XMFROM,XMTO,XMK,XMZ,XMDEL,XMACT,XMREPLY) ;
"RTN","XMTDL2",70,0)
 N XMFDA,XMIENS,XMIEN,XMTRIES
"RTN","XMTDL2",71,0)
 S XMIENS="+1,"_XMK_","_XMTO_","
"RTN","XMTDL2",72,0)
 S XMIEN(1)=XMZ
"RTN","XMTDL2",73,0)
 S XMFDA(3.702,XMIENS,.01)=XMZ
"RTN","XMTDL2",74,0)
 I XMK'=.5 D
"RTN","XMTDL2",75,0)
 . I XMFROM'=XMTO D
"RTN","XMTDL2",76,0)
 . . I $G(XMACT("NONEW")),'$$RESP^XMXUTIL2(XMZ),$$ZREAD^XMXUTIL2(XMTO,XMZ)="" Q
"RTN","XMTDL2",77,0)
 . . S XMFDA(3.702,XMIENS,3)=1  ; new flag
"RTN","XMTDL2",78,0)
 . . D INCRNEW^XMXUTIL(XMTO,XMK)  ; New counts
"RTN","XMTDL2",79,0)
 . I $G(XMACT("VDAYS")) D  Q
"RTN","XMTDL2",80,0)
 . . S XMFDA(3.702,XMIENS,5)=$$FMADD^XLFDT(DT,XMACT("VDAYS"))  ; vapor date
"RTN","XMTDL2",81,0)
 . . S XMFDA(3.702,XMIENS,7)=0  ; vapor date set by user
"RTN","XMTDL2",82,0)
 . I XMDEL S XMFDA(3.702,XMIENS,5)=XMDEL  ; vapor date
"RTN","XMTDL2",83,0)
 ; Basket sequence number (XMKZ), and priority & new xrefs are handled by FM triggers.
"RTN","XMTDL2",84,0)
ATRY D UPDATE^DIE("S","XMFDA","XMIEN")
"RTN","XMTDL2",85,0)
 I '$D(DIERR) D  Q
"RTN","XMTDL2",86,0)
 . Q:'$D(XMACT("FWD"))
"RTN","XMTDL2",87,0)
 . I 'XMREPLY,XMFROM'=XMTO D FORWARD(XMTO,XMZ,XMACT("FWD"))
"RTN","XMTDL2",88,0)
 S XMTRIES=$G(XMTRIES)+1
"RTN","XMTDL2",89,0)
 I $D(^TMP("DIERR",$J,"E",110)) H 1 G ATRY ; Try again if can't lock
"RTN","XMTDL2",90,0)
 Q
"RTN","XMTDL2",91,0)
MAKENEW(XMTO,XMK,XMZ) ;
"RTN","XMTDL2",92,0)
 ; We ignore any "vapor" date here because this is an existing msg
"RTN","XMTDL2",93,0)
 N XMFDA,XMREC
"RTN","XMTDL2",94,0)
 S XMREC=$G(^XMB(3.7,XMTO,2,XMK,1,XMZ,0))
"RTN","XMTDL2",95,0)
 I XMREC="" D  Q:XMREC=""
"RTN","XMTDL2",96,0)
 . ; Message entry should have been there, but it wasn't.  Add it.
"RTN","XMTDL2",97,0)
 . D FIXBSKT(XMTO,XMK,XMZ)
"RTN","XMTDL2",98,0)
 . S XMREC=$G(^XMB(3.7,XMTO,2,XMK,1,XMZ,0)) Q:XMREC'=""
"RTN","XMTDL2",99,0)
 . D ADDNEW(0,XMTO,XMK,XMZ,0)
"RTN","XMTDL2",100,0)
 S XMFDA(3.702,XMZ_","_XMK_","_XMTO_",",3)=1  ; new flag
"RTN","XMTDL2",101,0)
 ; Delete 'automatic delete date' if it was set by the system
"RTN","XMTDL2",102,0)
 ; (during IN BASKET PURGE).
"RTN","XMTDL2",103,0)
 S:$P(XMREC,U,7) XMFDA(3.702,XMZ_","_XMK_","_XMTO_",",5)="@"
"RTN","XMTDL2",104,0)
 L +^XMB(3.7,XMTO,2,XMK,1,XMZ,0):1 ; Lock message
"RTN","XMTDL2",105,0)
 ; Priority & new xrefs are handled by FM triggers.
"RTN","XMTDL2",106,0)
 D FILE^DIE("","XMFDA")
"RTN","XMTDL2",107,0)
 L -^XMB(3.7,XMTO,2,XMK,1,XMZ,0)
"RTN","XMTDL2",108,0)
 D INCRNEW^XMXUTIL(XMTO,XMK) ; New counts
"RTN","XMTDL2",109,0)
 Q
"RTN","XMTDL2",110,0)
SECRET(XMDATE,XMZ) ;
"RTN","XMTDL2",111,0)
 ; Don't need to check to see if the user already has the msg, because
"RTN","XMTDL2",112,0)
 ; at this point, we already know that he doesn't.
"RTN","XMTDL2",113,0)
 N XMCRE8
"RTN","XMTDL2",114,0)
 S XMCRE8=$P($G(^XMB(3.9,XMZ,.6)),U)
"RTN","XMTDL2",115,0)
 Q $S('XMCRE8:0,XMDATE>XMCRE8:1,1:0)  ; 1 means user may NOT see the msg.
"RTN","XMTDL2",116,0)
MOVENEW(XMFROM,XMTO,XMK,XMZ,XMACT) ; Move msg from WASTE bskt and make new
"RTN","XMTDL2",117,0)
 N XMFDA,XMREC,XMIENS,XMIEN,XMTRIES
"RTN","XMTDL2",118,0)
 S XMREC=$G(^XMB(3.7,XMTO,2,.5,1,XMZ,0))
"RTN","XMTDL2",119,0)
 I XMREC="" D  Q:XMREC=""
"RTN","XMTDL2",120,0)
 . ; Message entry should have been there, but it wasn't.
"RTN","XMTDL2",121,0)
 . D FIXBSKT(XMTO,.5,XMZ)
"RTN","XMTDL2",122,0)
 . S XMREC=$G(^XMB(3.7,XMTO,2,.5,1,XMZ,0)) Q:XMREC'=""
"RTN","XMTDL2",123,0)
 . D ADDNEW(XMFROM,XMTO,XMK,XMZ,0)
"RTN","XMTDL2",124,0)
 S XMIENS="+1,"_XMK_","_XMTO_","
"RTN","XMTDL2",125,0)
 S XMIEN(1)=XMZ
"RTN","XMTDL2",126,0)
 S XMFDA(3.702,XMIENS,.01)=XMZ
"RTN","XMTDL2",127,0)
 S:XMFROM'=XMTO XMFDA(3.702,XMIENS,3)=1 ; new flag
"RTN","XMTDL2",128,0)
 S:$P(XMREC,U,4) XMFDA(3.702,XMIENS,4)=$P(XMREC,U,4) ; date last accessed
"RTN","XMTDL2",129,0)
 ;I '$P(XMREC,U,7),$P(XMREC,U,5)>DT S XMFDA(3.702,XMIENS,5)=$P(XMREC,U,5) ; vapor date set by user, not system
"RTN","XMTDL2",130,0)
 I $G(XMACT("VDAYS")) D
"RTN","XMTDL2",131,0)
 . S XMFDA(3.702,XMIENS,5)=$$FMADD^XLFDT(DT,XMACT("VDAYS"))  ; vapor date
"RTN","XMTDL2",132,0)
 . S XMFDA(3.702,XMIENS,7)=0  ; vapor date set by user
"RTN","XMTDL2",133,0)
MTRY D UPDATE^DIE("S","XMFDA","XMIEN")
"RTN","XMTDL2",134,0)
 I '$D(DIERR) D  Q
"RTN","XMTDL2",135,0)
 . D:XMFROM'=XMTO INCRNEW^XMXUTIL(XMTO,XMK) ; Increment new counts
"RTN","XMTDL2",136,0)
 . N DA,DIK
"RTN","XMTDL2",137,0)
 . S DA(2)=XMTO,DA(1)=.5,DA=XMZ
"RTN","XMTDL2",138,0)
 . S DIK="^XMB(3.7,"_XMTO_",2,.5,1,"
"RTN","XMTDL2",139,0)
 . D ^DIK ; delete msg from waste bskt
"RTN","XMTDL2",140,0)
 S XMTRIES=$G(XMTRIES)+1
"RTN","XMTDL2",141,0)
 I $D(^TMP("DIERR",$J,"E",110)) H 1 G MTRY ; Try again if can't lock
"RTN","XMTDL2",142,0)
 Q
"RTN","XMTDL2",143,0)
FIXBSKT(XMTO,XMK,XMZ) ; Basket integrity check
"RTN","XMTDL2",144,0)
 N XMERROR ; (set in ^XMUT4)
"RTN","XMTDL2",145,0)
 L +^XMB(3.7,XMTO,2,XMK):1
"RTN","XMTDL2",146,0)
 K ^XMB(3.7,"M",XMZ,XMTO,XMK) ; This xref is wrong.
"RTN","XMTDL2",147,0)
 D BSKT^XMUT4(XMTO,XMK)
"RTN","XMTDL2",148,0)
 L -^XMB(3.7,XMTO,2,XMK)
"RTN","XMTDL2",149,0)
 Q
"RTN","XMTDL2",150,0)
FORWARD(XMTO,XMZ,XMFIEN) ;
"RTN","XMTDL2",151,0)
 ; XMFIEN  IEN of the filter which activated.
"RTN","XMTDL2",152,0)
 N XMUPTR
"RTN","XMTDL2",153,0)
 S XMUPTR=+$O(^XMB(3.9,XMZ,1,"C",XMTO,0))
"RTN","XMTDL2",154,0)
 Q:$P($G(^XMB(3.9,XMZ,1,XMUPTR,0)),U,13)'=""  ; already forwarded once.
"RTN","XMTDL2",155,0)
 N XMFDA
"RTN","XMTDL2",156,0)
 S XMFDA(3.91,XMUPTR_","_XMZ_",",15)=XMFIEN
"RTN","XMTDL2",157,0)
 D FILE^DIE("","XMFDA")
"RTN","XMTDL2",158,0)
 Q
"RTN","XMTDO")
0^77^B3548599
"RTN","XMTDO",1,0)
XMTDO ;ISC-SF/GMB-Deliver other (server,device) ;04/11/2002  07:05
"RTN","XMTDO",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMTDO",3,0)
 ; Replaces ZSER^, ZDEV^XMS1 (ISC-WASH/THM/CAP)
"RTN","XMTDO",4,0)
SERVER ; S.server TASKMAN ENTRY
"RTN","XMTDO",5,0)
 ; Variables supplied by TaskMan:  XMZ,XMSERVER,XMSVIENS
"RTN","XMTDO",6,0)
 ; XMSERVER  Name of the server option (includes leading S.)
"RTN","XMTDO",7,0)
 N XMZREC,XMFROM,XMSERR,XMSUBJ
"RTN","XMTDO",8,0)
 D DUZ^XUP(.5)
"RTN","XMTDO",9,0)
 S XMZREC=$G(^XMB(3.9,XMZ,0)) I XMZREC="" D  Q
"RTN","XMTDO",10,0)
 . N XMPARM,XMINSTR
"RTN","XMTDO",11,0)
 . S XMINSTR("FROM")=.5
"RTN","XMTDO",12,0)
 . S XMPARM(1)=XMSERVER
"RTN","XMTDO",13,0)
 . S XMPARM(2)=ZTSK
"RTN","XMTDO",14,0)
 . D TASKBULL^XMXBULL(.5,"XM SEND ERR SERVER MSG",.XMPARM,"",.5,.XMINSTR)
"RTN","XMTDO",15,0)
 S XMSUBJ=$P(XMZREC,U,1)
"RTN","XMTDO",16,0)
 S:XMSUBJ["~U~" XMSUB=$$DECODEUP^XMXUTIL1(XMSUBJ)
"RTN","XMTDO",17,0)
 S XMFROM=$P(XMZREC,U,2)
"RTN","XMTDO",18,0)
 S:XMFROM["@" XMFROM=$$REPLYTO1^XMXREPLY(XMZ)
"RTN","XMTDO",19,0)
 D SETSTAT(XMSVIENS,$$EZBLD^DIALOG(39300)) ; Server hand off ready
"RTN","XMTDO",20,0)
 D DOSERV($E(XMSERVER,3,99),XMZ,XMFROM,XMSUBJ,.XMSERR)
"RTN","XMTDO",21,0)
 D SETSTAT(XMSVIENS,$S($D(XMSERR):XMSERR,1:$$EZBLD^DIALOG(39301))) ; Served (hand off done)
"RTN","XMTDO",22,0)
 S ZTREQ="@"
"RTN","XMTDO",23,0)
 Q
"RTN","XMTDO",24,0)
DOSERV(XMXX,XMZ,XMFROM,XMSUBJ,XQSRVOK) ;
"RTN","XMTDO",25,0)
 N XMCHAN,XMPROT,X,Y,XMSEN,XMREC,XMOPEN,XMCLOSE,XMSVIENS
"RTN","XMTDO",26,0)
 S XMCHAN="SERVER"
"RTN","XMTDO",27,0)
 D GET^XML
"RTN","XMTDO",28,0)
 S X=XMXX_U_XMZ_U_XMFROM_U_XMSUBJ
"RTN","XMTDO",29,0)
 D ^XQSRV
"RTN","XMTDO",30,0)
 ; ^XQSRV1 calls SETSB^XMA1C to put the msg in the postmaster's bskt.
"RTN","XMTDO",31,0)
 ; Instead, that line could read:
"RTN","XMTDO",32,0)
 ; D:XQSRV PUTSERV^XMXMSGS1(XQSOP,XQMSG)
"RTN","XMTDO",33,0)
 Q
"RTN","XMTDO",34,0)
DEVICE ; D.device or H.device TASKMAN ENTRY
"RTN","XMTDO",35,0)
 ; Variables supplied by TaskMan:  XMDUZ,XMZ,XMDVIENS,XMPRTHDR
"RTN","XMTDO",36,0)
 ; TaskMan opens and closes the device.
"RTN","XMTDO",37,0)
 N XMV
"RTN","XMTDO",38,0)
 I '$G(DUZ) D DUZ^XUP(XMDUZ)
"RTN","XMTDO",39,0)
 D INITAPI^XMVVITAE
"RTN","XMTDO",40,0)
 D PRTMSG^XMJMP(XMDUZ,"?",XMZ,"0-",0,$G(XMPRTHDR,1))
"RTN","XMTDO",41,0)
 D SETSTAT(XMDVIENS,$$EZBLD^DIALOG(39302)) ; Printed
"RTN","XMTDO",42,0)
 S ZTREQ="@"
"RTN","XMTDO",43,0)
 Q
"RTN","XMTDO",44,0)
SETSTAT(XMIENS,XMSTATUS) ; Record Time/Status in msg file
"RTN","XMTDO",45,0)
 N XMFDA
"RTN","XMTDO",46,0)
 S XMFDA(3.91,XMIENS,2)=$$NOW^XLFDT
"RTN","XMTDO",47,0)
 S XMFDA(3.91,XMIENS,5)=XMSTATUS
"RTN","XMTDO",48,0)
 D FILE^DIE("","XMFDA")
"RTN","XMTDO",49,0)
 Q
"RTN","XMTDR")
0^78^B41196621
"RTN","XMTDR",1,0)
XMTDR ;ISC-SF/GMB-Transmit messages in a queue ;07/23/2002  10:13
"RTN","XMTDR",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMTDR",3,0)
PLAY(XMINST,XMSITE,XMB) ; 
"RTN","XMTDR",4,0)
 N XMIO,XMTLER,XM,XMTURN
"RTN","XMTDR",5,0)
 S:'$D(ZTQUEUED) XM="D"
"RTN","XMTDR",6,0)
 S XMIO=$P(XMB("SCR REC"),U,5)
"RTN","XMTDR",7,0)
 D ENT^XMC1
"RTN","XMTDR",8,0)
 Q
"RTN","XMTDR",9,0)
TASK ; Task Manager comes here to send message to remote site
"RTN","XMTDR",10,0)
 ; (Tasked by QUEUE^XMKPR or REQUEUE^XMKPR)
"RTN","XMTDR",11,0)
 ; Was ZTSK^XMS0 (ISC-WASH/THM/CAP)
"RTN","XMTDR",12,0)
 ; Variables supplied by TaskMan:
"RTN","XMTDR",13,0)
 ; XMINST   Institution number
"RTN","XMTDR",14,0)
 ; XMPOLL   Are we polling?  0=no; 1=yes
"RTN","XMTDR",15,0)
 ;
"RTN","XMTDR",16,0)
 ; Variables used here:
"RTN","XMTDR",17,0)
 ; XMSITE   Institution name
"RTN","XMTDR",18,0)
 ; XMIO     same as ZTIO
"RTN","XMTDR",19,0)
 ; XMB("SCR IEN") Points to which script for XMINST in ^DIC(4.2 to use
"RTN","XMTDR",20,0)
 ; XMB("SCR REC") The script record
"RTN","XMTDR",21,0)
 ; XMB("TRIES")   # of tries
"RTN","XMTDR",22,0)
 I '$D(XMINST) S XMINST=XMB("XMSCR") K XMB ; Transition: v7.1 to v8.0
"RTN","XMTDR",23,0)
 S ZTREQ="@"
"RTN","XMTDR",24,0)
 Q:$$OBE(XMINST)
"RTN","XMTDR",25,0)
 I '$$NEXT^XMS(XMINST+1000),'$G(XMPOLL) D XMTFINIS(XMINST) Q
"RTN","XMTDR",26,0)
 N XMB,XMC,XMSITE,XM,XMIO
"RTN","XMTDR",27,0)
 S XM=$G(XM)
"RTN","XMTDR",28,0)
 S XMIO=ZTIO
"RTN","XMTDR",29,0)
 S XMSITE=$P(^DIC(4.2,XMINST,0),U,1)
"RTN","XMTDR",30,0)
 D XMTGET(XMINST,.XMB)
"RTN","XMTDR",31,0)
 D XMTAUDT(XMINST,.XMB)
"RTN","XMTDR",32,0)
 I XMB("TRIES")+1=$P(XMB("SCR REC"),U,3) D GET^XMCXT(1) ; Record transcript
"RTN","XMTDR",33,0)
 D ENT^XMC1
"RTN","XMTDR",34,0)
 I $G(ER),'$G(XMPOLL),'$G(XMC("NOREQUEUE")) D REQUEUE^XMKPR(XMINST,XMSITE,.XMB) Q
"RTN","XMTDR",35,0)
 D XMTFINIS(XMINST)
"RTN","XMTDR",36,0)
 I $G(XMC("S"))!$G(XMC("R")) D CHKSETIP(XMINST,XMSITE,.XMB)
"RTN","XMTDR",37,0)
 Q
"RTN","XMTDR",38,0)
CHKSETIP(XMINST,XMSITE,XMB) ;
"RTN","XMTDR",39,0)
 N XMOLDIP,XMIP,XMIENS,XMTXT,XMPARM
"RTN","XMTDR",40,0)
 S XMIP=$P(XMB("SCR REC"),U,6) Q:XMIP=""
"RTN","XMTDR",41,0)
 S XMIENS=XMINST_","
"RTN","XMTDR",42,0)
 ;I $P(^DIC(4.2,XMINST,0),U,12)'=XMIP D
"RTN","XMTDR",43,0)
 ;. S XMFDA(4.2,XMIENS,6.5)=XMIP ; successful IP address
"RTN","XMTDR",44,0)
 ;. D FILE^DIE("","XMFDA")
"RTN","XMTDR",45,0)
 Q:+XMB("SCR IEN")'=XMB("SCR IEN")!'XMB("SCR IEN")
"RTN","XMTDR",46,0)
 S XMOLDIP=$P(^DIC(4.2,XMINST,1,XMB("SCR IEN"),0),U,6)
"RTN","XMTDR",47,0)
 Q:XMOLDIP=XMIP
"RTN","XMTDR",48,0)
 I $$FIND1^DIC(4.2,"","MQX",XMC("HELO SEND"),"B^C")'=XMINST D  Q
"RTN","XMTDR",49,0)
 . Q:'$G(XMC("PLAY"))!$D(ZTQUEUED)
"RTN","XMTDR",50,0)
 . ;We will not change the IP address in the script because the site
"RTN","XMTDR",51,0)
 . ;self-identifed as |1|, which is not |2| or any of its synonyms.
"RTN","XMTDR",52,0)
 . N XMPARM,XMTEXT
"RTN","XMTDR",53,0)
 . S XMPARM(1)=XMC("HELO SEND"),XMPARM(2)=XMSITE
"RTN","XMTDR",54,0)
 . D BLD^DIALOG(42269,.XMPARM,"","XMTEXT","F")
"RTN","XMTDR",55,0)
 . D MSG^DIALOG("WM","","","","XMTEXT")
"RTN","XMTDR",56,0)
 S XMIENS=XMB("SCR IEN")_","_XMIENS
"RTN","XMTDR",57,0)
 S XMFDA(4.21,XMIENS,1.4)=XMIP ; successful IP address
"RTN","XMTDR",58,0)
 D FILE^DIE("","XMFDA")
"RTN","XMTDR",59,0)
 S XMPARM(1)=XMOLDIP,XMPARM(2)=XMIP,XMPARM(3)=$$MMDT^XMXUTIL1($$NOW^XLFDT)
"RTN","XMTDR",60,0)
 I $G(XMC("PLAY")),'$D(ZTQUEUED) W !,$$EZBLD^DIALOG(42267,.XMPARM) ;Changed IP address in script from '|1|' to '|2|'
"RTN","XMTDR",61,0)
 S XMTXT(1,0)=$$EZBLD^DIALOG(42268,.XMPARM) ;|3| - Changed IP address from '|1|' to '|2|' (MailMan)
"RTN","XMTDR",62,0)
 D WP^DIE(4.21,XMIENS,99,"A","XMTXT") ; Add line to script notes
"RTN","XMTDR",63,0)
 Q
"RTN","XMTDR",64,0)
OBE(XMINST) ; Overcome by Events?
"RTN","XMTDR",65,0)
 N XMTSK
"RTN","XMTDR",66,0)
 S XMTSK=+$$TSKEXIST^XMKPR(XMINST)
"RTN","XMTDR",67,0)
 I XMTSK,ZTSK'=XMTSK Q 1
"RTN","XMTDR",68,0)
 Q 0
"RTN","XMTDR",69,0)
XMTGET(XMINST,XMB) ;
"RTN","XMTDR",70,0)
 N XMTREC
"RTN","XMTDR",71,0)
 L +^XMBS(4.2999,XMINST,4):0 L -^XMBS(4.2999,XMINST,4) ; ensure latest
"RTN","XMTDR",72,0)
 S XMTREC=^XMBS(4.2999,XMINST,4)
"RTN","XMTDR",73,0)
 S XMB("SCR IEN")=$P(XMTREC,U,3)
"RTN","XMTDR",74,0)
 S XMB("TRIES")=$P(XMTREC,U,4)
"RTN","XMTDR",75,0)
 S XMB("ITERATIONS")=$P(XMTREC,U,6)
"RTN","XMTDR",76,0)
 S XMB("FIRST SCRIPT")=$P(XMTREC,U,7)
"RTN","XMTDR",77,0)
 S XMB("IP TRIED")=$P(XMTREC,U,8)
"RTN","XMTDR",78,0)
 S XMB("SCR REC")=^XMBS(4.2999,XMINST,5)
"RTN","XMTDR",79,0)
 Q
"RTN","XMTDR",80,0)
XMTAUDT(XMINST,XMB) ;
"RTN","XMTDR",81,0)
 N XMTREC,XMFDA,XMIENS,XMIEN,XMNOW
"RTN","XMTDR",82,0)
 L +^XMBS(4.2999,XMINST)
"RTN","XMTDR",83,0)
 S XMNOW=$$NOW^XLFDT
"RTN","XMTDR",84,0)
 S XMIENS=XMINST_","
"RTN","XMTDR",85,0)
 S XMFDA(4.2999,XMIENS,1)="@" ; current time
"RTN","XMTDR",86,0)
 S XMFDA(4.2999,XMIENS,2)="@" ; msg in transit
"RTN","XMTDR",87,0)
 S XMFDA(4.2999,XMIENS,3)="@" ; line last transmitted
"RTN","XMTDR",88,0)
 S XMFDA(4.2999,XMIENS,4)="@" ; errors this transmission
"RTN","XMTDR",89,0)
 S XMFDA(4.2999,XMIENS,5)="@" ; rate of transmission
"RTN","XMTDR",90,0)
 S XMFDA(4.2999,XMIENS,6)="@" ; device
"RTN","XMTDR",91,0)
 S XMTREC=^XMBS(4.2999,XMINST,4)
"RTN","XMTDR",92,0)
 I '$P(XMTREC,U,1)!$P(XMTREC,U,2) D
"RTN","XMTDR",93,0)
 . ; There's no start time or there is a finish time, so start audit anew
"RTN","XMTDR",94,0)
 . K ^XMBS(4.2999,XMINST,6)        ; kill off the audit multiple
"RTN","XMTDR",95,0)
 . S XMFDA(4.2999,XMIENS,41)=XMNOW ; start time
"RTN","XMTDR",96,0)
 . S XMFDA(4.2999,XMIENS,42)="@"   ; finish time
"RTN","XMTDR",97,0)
 S XMFDA(4.2999,XMIENS,45)=XMNOW   ; latest try time
"RTN","XMTDR",98,0)
 D FILE^DIE("","XMFDA")
"RTN","XMTDR",99,0)
 K XMFDA
"RTN","XMTDR",100,0)
 S XMFDA(4.29992,"+1,"_XMIENS,.01)=XMNOW ; audit try time
"RTN","XMTDR",101,0)
 S XMFDA(4.29992,"+1,"_XMIENS,1)=$E($P(XMB("SCR REC"),U),1,10) ; audit script name
"RTN","XMTDR",102,0)
 S XMFDA(4.29992,"+1,"_XMIENS,3)=$E($P(XMB("SCR REC"),U,6),1,20) ; audit IP address
"RTN","XMTDR",103,0)
 D UPDATE^DIE("","XMFDA","XMIEN")
"RTN","XMTDR",104,0)
 L -^XMBS(4.2999,XMINST)
"RTN","XMTDR",105,0)
 S XMB("AUDIT IENS")=XMIEN(1)_","_XMIENS
"RTN","XMTDR",106,0)
 Q
"RTN","XMTDR",107,0)
XMTFINIS(XMINST) ;
"RTN","XMTDR",108,0)
 N XMFDA,XMIENS
"RTN","XMTDR",109,0)
 L +^XMBS(4.2999,XMINST)
"RTN","XMTDR",110,0)
 K ^XMBS(4.2999,XMINST,3)  ; current xmit stats
"RTN","XMTDR",111,0)
 ;K ^XMBS(4.2999,XMINST,4) ; latest xmit info (don't delete)
"RTN","XMTDR",112,0)
 ;K ^XMBS(4.2999,XMINST,5) ; script
"RTN","XMTDR",113,0)
 ;K ^XMBS(4.2999,XMINST,6) ; xmit audit history (don't delete)
"RTN","XMTDR",114,0)
 S XMIENS=XMINST_","
"RTN","XMTDR",115,0)
 S XMFDA(4.2999,XMIENS,42)=$$NOW^XLFDT ; finish time
"RTN","XMTDR",116,0)
 D FILE^DIE("","XMFDA")
"RTN","XMTDR",117,0)
 L -^XMBS(4.2999,XMINST)
"RTN","XMTDR",118,0)
 Q
"RTN","XMTDR",119,0)
ERRTRAP ; (Called from ^XMCTRAP)
"RTN","XMTDR",120,0)
 I '$D(ZTSK)!$G(XMPOLL) D XMTFINIS Q
"RTN","XMTDR",121,0)
 D REQUEUE^XMKPR(XMINST,XMSITE,.XMB)
"RTN","XMTDR",122,0)
 Q
"RTN","XMTDR",123,0)
XMTSTAT(XMINST,XMWHICH,XMTXT,XMINCR) ; Statistics recording for message transmission
"RTN","XMTDR",124,0)
 ; We write to 4.2999 every 20 lines up to 100, and then every 100 lines
"RTN","XMTDR",125,0)
 ; after that.
"RTN","XMTDR",126,0)
 ; XMWHICH   S=Send; R=Receive
"RTN","XMTDR",127,0)
 ; XMTXT     XMSG or XMRG (What is sent or received)
"RTN","XMTDR",128,0)
 S XMC("C",XMWHICH)=$G(XMC("C",XMWHICH))+$L(XMTXT) ; chars xmit this session
"RTN","XMTDR",129,0)
 S XMC("L")=$G(XMC("L"))+$G(XMINCR,1) ; lines xmit this session
"RTN","XMTDR",130,0)
 Q:XMC("L")#$S(XMC("L")>100:100,1:20)
"RTN","XMTDR",131,0)
 S ^XMBS(4.2999,XMINST,3)=$H_U_$G(XMZ)_U_XMC("L")_U_$G(XMLER)_U_$J($G(XMC("C","R"))+$G(XMC("C","S"))/($$TSTAMP^XMXUTIL1-XMC("START")),0,0)_U_$E(IO,1,9)_" "_XMPROT_U_$G(ZTSK)_U_$G(XMC("DIR"))
"RTN","XMTDR",132,0)
 Q
"RTN","XMTDR",133,0)
XMTHIST(XMINST,XMWHICH,XMLINES) ; Update history statistics for sending/receiving msgs
"RTN","XMTDR",134,0)
 N XMMONTH,XMREC,XMOFF
"RTN","XMTDR",135,0)
 S XMMONTH=$E(DT,1,5)
"RTN","XMTDR",136,0)
 S XMREC=$G(^XMBS(4.2999,XMINST,100,XMMONTH,0))
"RTN","XMTDR",137,0)
 I XMREC="" D
"RTN","XMTDR",138,0)
 . S XMREC=XMMONTH_"00"
"RTN","XMTDR",139,0)
 . D STATMON(XMINST,XMMONTH)
"RTN","XMTDR",140,0)
 S XMC(XMWHICH)=$G(XMC(XMWHICH))+1
"RTN","XMTDR",141,0)
 S XMOFF=(XMWHICH="R") ; 0 if "S"; 1 if "R"
"RTN","XMTDR",142,0)
 S $P(XMREC,U,2+XMOFF)=$P(XMREC,U,2+XMOFF)+1 ; msgs sent/rcvd
"RTN","XMTDR",143,0)
 S $P(XMREC,U,4)=$P(XMREC,U,4)+$G(XMC("C","S"))-$G(XMC("C","S","CHK")) ; chars sent
"RTN","XMTDR",144,0)
 S $P(XMREC,U,5)=$P(XMREC,U,5)+$G(XMC("C","R"))-$G(XMC("C","R","CHK")) ; chars rcvd
"RTN","XMTDR",145,0)
 S $P(XMREC,U,6+XMOFF)=$P(XMREC,U,6+XMOFF)+XMLINES ; lines sent/rcvd
"RTN","XMTDR",146,0)
 S ^XMBS(4.2999,XMINST,100,XMMONTH,0)=XMREC
"RTN","XMTDR",147,0)
 S XMC("C","S","CHK")=$G(XMC("C","S")) ; chars sent checkpoint
"RTN","XMTDR",148,0)
 S XMC("C","R","CHK")=$G(XMC("C","R")) ; chars rcvd checkpoint
"RTN","XMTDR",149,0)
 Q
"RTN","XMTDR",150,0)
STATMON(XMINST,XMMONTH) ; Set up a record for a month for a domain
"RTN","XMTDR",151,0)
 D:'$D(^XMBS(4.2999,XMINST,0)) STAT(XMINST)
"RTN","XMTDR",152,0)
 N XMFDA,XMIEN
"RTN","XMTDR",153,0)
 S XMFDA(4.29991,"+1,"_XMINST_",",.01)=XMMONTH_"00"
"RTN","XMTDR",154,0)
 S XMIEN(1)=XMMONTH
"RTN","XMTDR",155,0)
 D UPDATE^DIE("","XMFDA","XMIEN")
"RTN","XMTDR",156,0)
 Q
"RTN","XMTDR",157,0)
STAT(XMINST) ; Set up record for domain in 4.2999 MESSAGE STATISTICS file
"RTN","XMTDR",158,0)
 Q:$D(^XMBS(4.2999,XMINST,0))
"RTN","XMTDR",159,0)
 N XMFDA,XMIEN
"RTN","XMTDR",160,0)
 S XMFDA(4.2999,"+1,",.01)=XMINST
"RTN","XMTDR",161,0)
 S XMIEN(1)=XMINST
"RTN","XMTDR",162,0)
 D UPDATE^DIE("","XMFDA","XMIEN") Q:'$D(DIERR)
"RTN","XMTDR",163,0)
 ; Just in case the call fails, we must do it ourselves
"RTN","XMTDR",164,0)
 S ^XMBS(4.2999,XMINST,0)=XMINST
"RTN","XMTDR",165,0)
 S ^XMBS(4.2999,"B",XMINST,XMINST)=""
"RTN","XMTDR",166,0)
 Q
"RTN","XMTDT")
0^338^B25044230
"RTN","XMTDT",1,0)
XMTDT ;ISC-SF/GMB-Deliver later'd msgs & delete inactive msgs ;04/10/2001  13:30
"RTN","XMTDT",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMTDT",3,0)
 ; Replaces ^XMADJ999,LATER^XMAD2 (ISC-WASH/CAP)
"RTN","XMTDT",4,0)
GO ;
"RTN","XMTDT",5,0)
 N XMWAIT
"RTN","XMTDT",6,0)
 I $D(ZTQUEUED) S ZTREQ="@"
"RTN","XMTDT",7,0)
 L +^XMBPOST("POST_Tickler"):1 E  Q
"RTN","XMTDT",8,0)
 I $D(ZTQUEUED) S %=$$PSET^%ZTLOAD(ZTSK)
"RTN","XMTDT",9,0)
 F  Q:$P($G(^XMB(1,1,0)),U,16)  D
"RTN","XMTDT",10,0)
 . D LATERNEW
"RTN","XMTDT",11,0)
 . D LATERFWD
"RTN","XMTDT",12,0)
 . D PURGEOLD
"RTN","XMTDT",13,0)
 . D FILTRFWD
"RTN","XMTDT",14,0)
 . S XMWAIT=$$TSTAMP^XMXUTIL1      ; Why can't we just H 60?
"RTN","XMTDT",15,0)
 . F  D  Q:$$TSTAMP^XMXUTIL1-XMWAIT>60
"RTN","XMTDT",16,0)
 . . H XMHANG
"RTN","XMTDT",17,0)
 L -^XMBPOST("POST_Tickler")
"RTN","XMTDT",18,0)
 I $D(ZTQUEUED) D PCLEAR^%ZTLOAD(ZTSK)
"RTN","XMTDT",19,0)
 Q
"RTN","XMTDT",20,0)
LATERNEW ; This routine takes care of 'new'ing messages which the user
"RTN","XMTDT",21,0)
 ; had previously 'later'ed for himself.
"RTN","XMTDT",22,0)
 N XMNOW,XMLATER,DIK,XMDUZ,XMZ,DA,XMZREC,XMINACT
"RTN","XMTDT",23,0)
 S XMNOW=$$NOW^XLFDT
"RTN","XMTDT",24,0)
 S XMLATER=0
"RTN","XMTDT",25,0)
 F  S XMLATER=$O(^XMB(3.73,"AB",XMLATER)) Q:XMLATER'>0!(XMLATER>XMNOW)  D
"RTN","XMTDT",26,0)
 . S DIK="^XMB(3.73,"
"RTN","XMTDT",27,0)
 . S XMDUZ=0
"RTN","XMTDT",28,0)
 . F  S XMDUZ=$O(^XMB(3.73,"AB",XMLATER,XMDUZ)) Q:'XMDUZ  D
"RTN","XMTDT",29,0)
 . . S XMINACT=$S($P($G(^VA(200,XMDUZ,0)),U,3)="":1,$P($G(^(.1)),U,2)="":1,$P($G(^(201)),U)="":1,1:0)  ; user is inactive if no access code, or verify code, or primary menu
"RTN","XMTDT",30,0)
 . . S XMZ=0
"RTN","XMTDT",31,0)
 . . F  S XMZ=$O(^XMB(3.73,"AB",XMLATER,XMDUZ,XMZ)) Q:'XMZ  D
"RTN","XMTDT",32,0)
 . . . S DA=$O(^XMB(3.73,"AB",XMLATER,XMDUZ,XMZ,0)) Q:'DA
"RTN","XMTDT",33,0)
 . . . I '$D(^XMB(3.73,DA,0)) D  Q  ; *** This should not be necessary
"RTN","XMTDT",34,0)
 . . . . K ^XMB(3.73,"AB",XMLATER,XMDUZ,XMZ,DA)
"RTN","XMTDT",35,0)
 . . . . K ^XMB(3.73,"AC",XMZ,XMDUZ,DA)
"RTN","XMTDT",36,0)
 . . . . K ^XMB(3.73,"C",XMDUZ,DA)
"RTN","XMTDT",37,0)
 . . . D ^DIK
"RTN","XMTDT",38,0)
 . . . Q:XMINACT
"RTN","XMTDT",39,0)
 . . . S XMZREC=$G(^XMB(3.9,XMZ,0)) Q:XMZREC=""
"RTN","XMTDT",40,0)
 . . . D RESURECT^XMXMSGS2(XMDUZ,XMZ)
"RTN","XMTDT",41,0)
 . . . D DELIVER^XMTDL2(XMDUZ,XMZ,$P(XMZREC,U,1),$P(XMZREC,U,2),0,1)
"RTN","XMTDT",42,0)
 Q
"RTN","XMTDT",43,0)
LATERFWD ; This routine takes care of forwarding messages which a user
"RTN","XMTDT",44,0)
 ; had previously scheduled for 'later' delivery to other users.
"RTN","XMTDT",45,0)
 N XMDUZ,XMNOW,XMLATER,DIK,XMIEN,XMZ,DA,XMREC,XMV,XMINSTR,XMTO,XMPRIVAT
"RTN","XMTDT",46,0)
 K XMERR,^TMP("XMERR",$J)
"RTN","XMTDT",47,0)
 S XMPRIVAT=$$EZBLD^DIALOG(39135) ; " [Private Mail Group]"
"RTN","XMTDT",48,0)
 S XMINSTR("FWD BY XMDUZ")=""
"RTN","XMTDT",49,0)
 S XMNOW=$$NOW^XLFDT
"RTN","XMTDT",50,0)
 S XMLATER=0
"RTN","XMTDT",51,0)
 F  S XMLATER=$O(^XMB(3.9,"AL",XMLATER)) Q:XMLATER'>0!(XMLATER>XMNOW)  D
"RTN","XMTDT",52,0)
 . S XMZ=0
"RTN","XMTDT",53,0)
 . F  S XMZ=$O(^XMB(3.9,"AL",XMLATER,XMZ)) Q:'XMZ  D
"RTN","XMTDT",54,0)
 . . S DA(1)=XMZ
"RTN","XMTDT",55,0)
 . . S DIK="^XMB(3.9,"_DA(1)_",7,"
"RTN","XMTDT",56,0)
 . . S XMIEN=0
"RTN","XMTDT",57,0)
 . . F  S XMIEN=$O(^XMB(3.9,"AL",XMLATER,XMZ,XMIEN)) Q:'XMIEN  D
"RTN","XMTDT",58,0)
 . . . S XMREC=$G(^XMB(3.9,XMZ,7,XMIEN,0))
"RTN","XMTDT",59,0)
 . . . I XMREC="" K ^XMB(3.9,"AL",XMLATER,XMZ,XMIEN) Q
"RTN","XMTDT",60,0)
 . . . S XMDUZ=$P(XMREC,U,3)
"RTN","XMTDT",61,0)
 . . . S XMTO=$P(XMREC,U,1)
"RTN","XMTDT",62,0)
 . . . I XMTO[XMPRIVAT S XMTO=$P(XMTO,XMPRIVAT,1) ; " [Private Mail Group]" (set in ^XMXADDRG)
"RTN","XMTDT",63,0)
 . . . I $P(XMREC,U,2)'="" S XMTO=$P(XMREC,U,2)_":"_XMTO
"RTN","XMTDT",64,0)
 . . . D INIT^XMXADDR
"RTN","XMTDT",65,0)
 . . . D CHKADDR^XMXADDR(XMDUZ,XMTO) K:$D(XMERR) XMERR,^TMP("XMERR",$J)
"RTN","XMTDT",66,0)
 . . . S XMINSTR("FWD BY")=$P(XMREC,U,4)
"RTN","XMTDT",67,0)
 . . . D:$D(^TMP("XMY",$J)) FWD^XMKP(XMDUZ,XMZ,.XMINSTR)
"RTN","XMTDT",68,0)
 . . . D CLEANUP^XMXADDR
"RTN","XMTDT",69,0)
 . . . S DA=XMIEN
"RTN","XMTDT",70,0)
 . . . D ^DIK
"RTN","XMTDT",71,0)
 Q
"RTN","XMTDT",72,0)
PURGEOLD ; This routine deletes msgs marked for automatic deletion,
"RTN","XMTDT",73,0)
 ; whether marked by the user, or marked by the 'in basket purge'
"RTN","XMTDT",74,0)
 ; because they hadn't been accessed for a certain number of days.
"RTN","XMTDT",75,0)
 ; Replaces ^XMAI0 (ISC-WASH/CAP/RJ)
"RTN","XMTDT",76,0)
 ; XMDDATE  Message delete date
"RTN","XMTDT",77,0)
 N XMDDATE,XMDUZ,XMK,XMZ,XMNOW
"RTN","XMTDT",78,0)
 S XMNOW=$$NOW^XLFDT
"RTN","XMTDT",79,0)
 S (XMDDATE,XMDUZ,XMK,XMZ)=""
"RTN","XMTDT",80,0)
 F  S XMDDATE=$O(^XMB(3.7,"AC",XMDDATE)) Q:XMDDATE=""!(XMDDATE>XMNOW)  D
"RTN","XMTDT",81,0)
 . F  S XMDUZ=$O(^XMB(3.7,"AC",XMDDATE,XMDUZ)) Q:XMDUZ=""  D
"RTN","XMTDT",82,0)
 . . F  S XMK=$O(^XMB(3.7,"AC",XMDDATE,XMDUZ,XMK)) Q:XMK=""  D
"RTN","XMTDT",83,0)
 . . . F  S XMZ=$O(^XMB(3.7,"AC",XMDDATE,XMDUZ,XMK,XMZ)) Q:XMZ=""  D
"RTN","XMTDT",84,0)
 . . . . I $D(^XMB(3.7,XMDUZ,2,XMK,1,XMZ,0)) D ZAPIT^XMXMSGS2(XMDUZ,XMK,XMZ) Q
"RTN","XMTDT",85,0)
 . . . . K ^XMB(3.7,"AC",XMDDATE,XMDUZ,XMK,XMZ)
"RTN","XMTDT",86,0)
 Q
"RTN","XMTDT",87,0)
FILTRFWD ; This routine forwards messages for a user when a filter
"RTN","XMTDT",88,0)
 ; with 'forward to' recipients has activated during message delivery.
"RTN","XMTDT",89,0)
 N XMDUZ,XMUPTR,XMZ,XMREC,XMV,XMINSTR,XMTO,XMPRIVAT,XMFIEN,XMFWDIEN
"RTN","XMTDT",90,0)
 S XMPRIVAT=$$EZBLD^DIALOG(39135) ; " [Private Mail Group]"
"RTN","XMTDT",91,0)
 S XMINSTR("FWD BY XMDUZ")="F"
"RTN","XMTDT",92,0)
 S XMFIEN=0
"RTN","XMTDT",93,0)
 F  S XMFIEN=$O(^XMB(3.9,"AF",XMFIEN)) Q:'XMFIEN  D
"RTN","XMTDT",94,0)
 . S XMZ=0
"RTN","XMTDT",95,0)
 . F  S XMZ=$O(^XMB(3.9,"AF",XMFIEN,XMZ)) Q:'XMZ  D
"RTN","XMTDT",96,0)
 . . S XMUPTR=0
"RTN","XMTDT",97,0)
 . . F  S XMUPTR=$O(^XMB(3.9,"AF",XMFIEN,XMZ,XMUPTR)) Q:'XMUPTR  D
"RTN","XMTDT",98,0)
 . . . S XMREC=$G(^XMB(3.9,XMZ,1,XMUPTR,0))
"RTN","XMTDT",99,0)
 . . . S XMDUZ=$P(XMREC,U,1)
"RTN","XMTDT",100,0)
 . . . I XMREC=""!'XMDUZ!($P(XMREC,U,13)'=XMFIEN) K ^XMB(3.9,"AF",XMFIEN,XMZ,XMUPTR) Q
"RTN","XMTDT",101,0)
 . . . S XMFWDIEN=0
"RTN","XMTDT",102,0)
 . . . D INIT^XMXADDR
"RTN","XMTDT",103,0)
 . . . F  S XMFWDIEN=$O(^XMB(3.7,XMDUZ,15,XMFIEN,1,XMFWDIEN)) Q:'XMFWDIEN  S XMREC=$G(^(XMFWDIEN,0)) D
"RTN","XMTDT",104,0)
 . . . . S XMTO=$P(XMREC,U,1) Q:XMTO=""
"RTN","XMTDT",105,0)
 . . . . N XMERROR,XMFULL
"RTN","XMTDT",106,0)
 . . . . I XMTO[XMPRIVAT S XMTO=$P(XMTO,XMPRIVAT,1) ; " [Private Mail Group]" (set in ^XMXADDRG)
"RTN","XMTDT",107,0)
 . . . . ;I $P(XMREC,U,2)'="" S XMTO=$P(XMREC,U,2)_":"_XMTO
"RTN","XMTDT",108,0)
 . . . . D ADDRESS^XMXADDR(XMDUZ,XMTO,.XMFULL,.XMERROR) Q:'$D(XMERROR)
"RTN","XMTDT",109,0)
 . . . . D DELFWDTO^XMTDF(XMDUZ,XMFIEN,XMFWDIEN,XMTO,$$GETERR^XMXADDR4)
"RTN","XMTDT",110,0)
 . . . S XMINSTR("FWD BY")=$$NAME^XMXUTIL(XMDUZ)
"RTN","XMTDT",111,0)
 . . . D:$D(^TMP("XMY",$J)) FWD^XMKP(XMDUZ,XMZ,.XMINSTR)
"RTN","XMTDT",112,0)
 . . . D CLEANUP^XMXADDR
"RTN","XMTDT",113,0)
 . . . N XMFDA
"RTN","XMTDT",114,0)
 . . . S XMFDA(3.91,XMUPTR_","_XMZ_",",15)=0 ; filter forward completed
"RTN","XMTDT",115,0)
 . . . D FILE^DIE("","XMFDA")
"RTN","XMTDT",116,0)
 Q
"RTN","XMUCXPOP")
0^388^B526376
"RTN","XMUCXPOP",1,0)
XMUCXPOP ;ISC-SF/GMB-POP3 Server for UCX (RFC 1939) ;04/17/2002  11:46
"RTN","XMUCXPOP",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMUCXPOP",3,0)
 ;Entry for Inet_servers interface RECEIVER
"RTN","XMUCXPOP",4,0)
 ;SMTP service request invokes MailMan POP Server
"RTN","XMUCXPOP",5,0)
SOC110 ;
"RTN","XMUCXPOP",6,0)
 I $$NEWERR^%ZTER N $ETRAP,$ESTACK S $ETRAP="D ^%ZTER H"
"RTN","XMUCXPOP",7,0)
 E  S X="D ^%ZTER H",@^%ZOSF("TRAP")
"RTN","XMUCXPOP",8,0)
 S (XMRPORT,IO,IO(0))=%,X=$E(%_"-XMPOP",1,15) D SETENV^%ZOSV
"RTN","XMUCXPOP",9,0)
 D DT^DICRW,DUZ^XUP(.5)
"RTN","XMUCXPOP",10,0)
 S ER=0
"RTN","XMUCXPOP",11,0)
 ;O IO:(SHARE) U IO
"RTN","XMUCXPOP",12,0)
 O IO:(TCPDEV):33 U IO
"RTN","XMUCXPOP",13,0)
 S XMCHAN="TCP/IP-MAILMAN",XMNO220=""
"RTN","XMUCXPOP",14,0)
 D ENTRY^XMRPOP
"RTN","XMUCXPOP",15,0)
 G HALT^XMRTCP
"RTN","XMUDCHK")
0^231^B14580607
"RTN","XMUDCHK",1,0)
XMUDCHK ;(WASH ISC)/CAP-Validate DOMAIN file ;04/24/2002  08:27
"RTN","XMUDCHK",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMUDCHK",3,0)
 ; Entry points used by MailMan options (not covered by DBIA):
"RTN","XMUDCHK",4,0)
 ; VALID8   XMQDOMAINS
"RTN","XMUDCHK",5,0)
VALID8 ;
"RTN","XMUDCHK",6,0)
 N XMI,XMNO,XMDOM
"RTN","XMUDCHK",7,0)
 W !!!,"Validating domain file",!
"RTN","XMUDCHK",8,0)
 S XMNO=0
"RTN","XMUDCHK",9,0)
 F XMI=1:1 S X=$T(TABLE+XMI) Q:X=""  D
"RTN","XMUDCHK",10,0)
 . S XMDOM=$P(X,";",3)
"RTN","XMUDCHK",11,0)
 . W !,XMDOM
"RTN","XMUDCHK",12,0)
 . Q:$$FIND1^DIC(4.2,"","QO",XMDOM,"B^C")
"RTN","XMUDCHK",13,0)
 . I $L(XMDOM,".")<3 D
"RTN","XMUDCHK",14,0)
 . . Q:$$FIND1^DIC(4.2,"","QO",XMDOM_".MED.VA.GOV","B^C")
"RTN","XMUDCHK",15,0)
 . . Q:$$FIND1^DIC(4.2,"","QO",XMDOM_".VA.GOV","B^C")
"RTN","XMUDCHK",16,0)
 . W $S($L(XMDOM,".")<3:".MED.VA.GOV",1:"")," is not in your domain file." S XMNO=XMNO+1
"RTN","XMUDCHK",17,0)
 Q
"RTN","XMUDCHK",18,0)
TABLE ;;Name
"RTN","XMUDCHK",19,0)
 ;;ALBUQUERQUE
"RTN","XMUDCHK",20,0)
 ;;ALEXANDRIA
"RTN","XMUDCHK",21,0)
 ;;ALTOONA
"RTN","XMUDCHK",22,0)
 ;;AMARILLO
"RTN","XMUDCHK",23,0)
 ;;ANCHORAGE
"RTN","XMUDCHK",24,0)
 ;;ANN-ARBOR
"RTN","XMUDCHK",25,0)
 ;;ASHEVILLE
"RTN","XMUDCHK",26,0)
 ;;ATLANTA
"RTN","XMUDCHK",27,0)
 ;;AUGUSTA
"RTN","XMUDCHK",28,0)
 ;;BALTIMORE
"RTN","XMUDCHK",29,0)
 ;;BATTLE-CREEK
"RTN","XMUDCHK",30,0)
 ;;BAY-PINES
"RTN","XMUDCHK",31,0)
 ;;BECKLEY
"RTN","XMUDCHK",32,0)
 ;;BEDFORD
"RTN","XMUDCHK",33,0)
 ;;BIG-SPRING
"RTN","XMUDCHK",34,0)
 ;;BILOXI
"RTN","XMUDCHK",35,0)
 ;;BIRMINGHAM
"RTN","XMUDCHK",36,0)
 ;;BLACK-HILLS
"RTN","XMUDCHK",37,0)
 ;;BOISE
"RTN","XMUDCHK",38,0)
 ;;BOSTON
"RTN","XMUDCHK",39,0)
 ;;BRONX
"RTN","XMUDCHK",40,0)
 ;;BUTLER
"RTN","XMUDCHK",41,0)
 ;;CENTRAL-ALABAMA
"RTN","XMUDCHK",42,0)
 ;;CENTRAL-PLAINS
"RTN","XMUDCHK",43,0)
 ;;CENTRAL-TEXAS
"RTN","XMUDCHK",44,0)
 ;;CHARLESTON
"RTN","XMUDCHK",45,0)
 ;;CHEYENNE
"RTN","XMUDCHK",46,0)
 ;;CHICAGO-WEST
"RTN","XMUDCHK",47,0)
 ;;CHILLICOTHE
"RTN","XMUDCHK",48,0)
 ;;CINCINNATI
"RTN","XMUDCHK",49,0)
 ;;CLARKSBURG
"RTN","XMUDCHK",50,0)
 ;;CLEVELAND
"RTN","XMUDCHK",51,0)
 ;;CMOP-BED
"RTN","XMUDCHK",52,0)
 ;;CMOP-CHAR
"RTN","XMUDCHK",53,0)
 ;;CMOP-DAL
"RTN","XMUDCHK",54,0)
 ;;CMOP-HINES
"RTN","XMUDCHK",55,0)
 ;;CMOP-LEAV
"RTN","XMUDCHK",56,0)
 ;;CMOP-MURF
"RTN","XMUDCHK",57,0)
 ;;CMOP-LA
"RTN","XMUDCHK",58,0)
 ;;COATESVILLE
"RTN","XMUDCHK",59,0)
 ;;COLUMBIA-SC
"RTN","XMUDCHK",60,0)
 ;;COLUMBUS
"RTN","XMUDCHK",61,0)
 ;;DALLAS
"RTN","XMUDCHK",62,0)
 ;;DANVILLE
"RTN","XMUDCHK",63,0)
 ;;DAYTON
"RTN","XMUDCHK",64,0)
 ;;DENVER
"RTN","XMUDCHK",65,0)
 ;;DETROIT
"RTN","XMUDCHK",66,0)
 ;;DUBLIN
"RTN","XMUDCHK",67,0)
 ;;DURHAM
"RTN","XMUDCHK",68,0)
 ;;EAST-ORANGE
"RTN","XMUDCHK",69,0)
 ;;EL-PASO
"RTN","XMUDCHK",70,0)
 ;;ERIE
"RTN","XMUDCHK",71,0)
 ;;FARGO
"RTN","XMUDCHK",72,0)
 ;;FAYETTVL-AR
"RTN","XMUDCHK",73,0)
 ;;FAYETTVL-NC
"RTN","XMUDCHK",74,0)
 ;;FHIE
"RTN","XMUDCHK",75,0)
 ;;FO-ALBANY
"RTN","XMUDCHK",76,0)
 ;;FO-BAYPINES
"RTN","XMUDCHK",77,0)
 ;;FO-BIRM
"RTN","XMUDCHK",78,0)
 ;;FO-DALLAS
"RTN","XMUDCHK",79,0)
 ;;FO-HINES
"RTN","XMUDCHK",80,0)
 ;;FO-OAKLAND
"RTN","XMUDCHK",81,0)
 ;;FO-SLC
"RTN","XMUDCHK",82,0)
 ;;FO-WASH
"RTN","XMUDCHK",83,0)
 ;;FOC-AUSTIN.VA.GOV
"RTN","XMUDCHK",84,0)
 ;;FORT-LYON
"RTN","XMUDCHK",85,0)
 ;;FORUM.VA.GOV
"RTN","XMUDCHK",86,0)
 ;;FRESNO
"RTN","XMUDCHK",87,0)
 ;;GK.VA.GOV
"RTN","XMUDCHK",88,0)
 ;;GRAND-JUNCT
"RTN","XMUDCHK",89,0)
 ;;HAC
"RTN","XMUDCHK",90,0)
 ;;HAMPTON
"RTN","XMUDCHK",91,0)
 ;;HINES
"RTN","XMUDCHK",92,0)
 ;;HONOLULU
"RTN","XMUDCHK",93,0)
 ;;HOUSTON
"RTN","XMUDCHK",94,0)
 ;;HQ
"RTN","XMUDCHK",95,0)
 ;;HUNTINGTON
"RTN","XMUDCHK",96,0)
 ;;INDIANAPOLIS
"RTN","XMUDCHK",97,0)
 ;;IPDB-CHICAGO
"RTN","XMUDCHK",98,0)
 ;;IRON-MTN
"RTN","XMUDCHK",99,0)
 ;;IVM
"RTN","XMUDCHK",100,0)
 ;;JACKSON
"RTN","XMUDCHK",101,0)
 ;;KANSAS-CITY
"RTN","XMUDCHK",102,0)
 ;;LAS-VEGAS
"RTN","XMUDCHK",103,0)
 ;;LEBANON
"RTN","XMUDCHK",104,0)
 ;;LEXINGTON
"RTN","XMUDCHK",105,0)
 ;;LITTLE-ROCK
"RTN","XMUDCHK",106,0)
 ;;LOMA-LINDA
"RTN","XMUDCHK",107,0)
 ;;LONG-BEACH
"RTN","XMUDCHK",108,0)
 ;;LOUISVILLE
"RTN","XMUDCHK",109,0)
 ;;MADISON
"RTN","XMUDCHK",110,0)
 ;;MAIL.CIO
"RTN","XMUDCHK",111,0)
 ;;MAIL.VA.GOV
"RTN","XMUDCHK",112,0)
 ;;MANCHESTER
"RTN","XMUDCHK",113,0)
 ;;MANILA
"RTN","XMUDCHK",114,0)
 ;;MARTINEZ
"RTN","XMUDCHK",115,0)
 ;;MARTINSBURG
"RTN","XMUDCHK",116,0)
 ;;MED.VA.GOV
"RTN","XMUDCHK",117,0)
 ;;MEMPHIS
"RTN","XMUDCHK",118,0)
 ;;MHSHG.PITTS-HGHLND
"RTN","XMUDCHK",119,0)
 ;;MIAMI
"RTN","XMUDCHK",120,0)
 ;;MILWAUKEE
"RTN","XMUDCHK",121,0)
 ;;MINNEAPOLIS
"RTN","XMUDCHK",122,0)
 ;;MONTANA
"RTN","XMUDCHK",123,0)
 ;;MONTROSE
"RTN","XMUDCHK",124,0)
 ;;MPI-AUSTIN
"RTN","XMUDCHK",125,0)
 ;;MTN-HOME
"RTN","XMUDCHK",126,0)
 ;;MUSKOGEE
"RTN","XMUDCHK",127,0)
 ;;N-CHICAGO
"RTN","XMUDCHK",128,0)
 ;;NEW-ORLEANS
"RTN","XMUDCHK",129,0)
 ;;NORTH-FLORIDA
"RTN","XMUDCHK",130,0)
 ;;NORTHAMPTON
"RTN","XMUDCHK",131,0)
 ;;NORTHERN-INDIANA
"RTN","XMUDCHK",132,0)
 ;;NORTHPORT
"RTN","XMUDCHK",133,0)
 ;;NY-HARBOR
"RTN","XMUDCHK",134,0)
 ;;OKLAHOMA
"RTN","XMUDCHK",135,0)
 ;;PACE-WASH
"RTN","XMUDCHK",136,0)
 ;;PALO-ALTO
"RTN","XMUDCHK",137,0)
 ;;PHILADELPHIA
"RTN","XMUDCHK",138,0)
 ;;PHOENIX
"RTN","XMUDCHK",139,0)
 ;;PITTSBURGH
"RTN","XMUDCHK",140,0)
 ;;PORTLAND
"RTN","XMUDCHK",141,0)
 ;;PRESCOTT
"RTN","XMUDCHK",142,0)
 ;;PROVIDENCE
"RTN","XMUDCHK",143,0)
 ;;PUGET-SOUND
"RTN","XMUDCHK",144,0)
 ;;RENO
"RTN","XMUDCHK",145,0)
 ;;RICHMOND
"RTN","XMUDCHK",146,0)
 ;;ROSEBURG
"RTN","XMUDCHK",147,0)
 ;;SAGINAW
"RTN","XMUDCHK",148,0)
 ;;SALEM
"RTN","XMUDCHK",149,0)
 ;;SALISBURY
"RTN","XMUDCHK",150,0)
 ;;SALT-LAKE
"RTN","XMUDCHK",151,0)
 ;;SAN-ANTONIO
"RTN","XMUDCHK",152,0)
 ;;SAN-DIEGO
"RTN","XMUDCHK",153,0)
 ;;SAN-JUAN
"RTN","XMUDCHK",154,0)
 ;;SANFRANCISCO
"RTN","XMUDCHK",155,0)
 ;;SHERIDAN
"RTN","XMUDCHK",156,0)
 ;;SHREVEPORT
"RTN","XMUDCHK",157,0)
 ;;SIOUX-FALLS
"RTN","XMUDCHK",158,0)
 ;;SPOKANE
"RTN","XMUDCHK",159,0)
 ;;ST-CLOUD
"RTN","XMUDCHK",160,0)
 ;;ST-LOUIS
"RTN","XMUDCHK",161,0)
 ;;SUPP-CHICAGO
"RTN","XMUDCHK",162,0)
 ;;TAMPA
"RTN","XMUDCHK",163,0)
 ;;TENNESSEEVALLEY
"RTN","XMUDCHK",164,0)
 ;;TOGUS
"RTN","XMUDCHK",165,0)
 ;;TOMAH
"RTN","XMUDCHK",166,0)
 ;;TUCSON
"RTN","XMUDCHK",167,0)
 ;;TUSCALOOSA
"RTN","XMUDCHK",168,0)
 ;;V02
"RTN","XMUDCHK",169,0)
 ;;VBA.VA.GOV
"RTN","XMUDCHK",170,0)
 ;;WALLA-WALLA
"RTN","XMUDCHK",171,0)
 ;;WASHINGTON
"RTN","XMUDCHK",172,0)
 ;;WEST-HAVEN
"RTN","XMUDCHK",173,0)
 ;;WEST-LA
"RTN","XMUDCHK",174,0)
 ;;WEST-PALM
"RTN","XMUDCHK",175,0)
 ;;WHITE-CITY
"RTN","XMUDCHK",176,0)
 ;;WHITE-RIVER
"RTN","XMUDCHK",177,0)
 ;;WILKES-BARRE
"RTN","XMUDCHK",178,0)
 ;;WILMINGTON
"RTN","XMUDCHR")
0^179^B21201807
"RTN","XMUDCHR",1,0)
XMUDCHR ;ISC-SF/GMB-Christen Site ;04/17/2002  11:48
"RTN","XMUDCHR",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMUDCHR",3,0)
 ; Entry points used by MailMan options (not covered by DBIA):
"RTN","XMUDCHR",4,0)
 ; CHRISTEN      XMCHRIS - Edit MailMan Site Parameters
"RTN","XMUDCHR",5,0)
CHRISTEN ;Set up/Change MailMan Site Parameters
"RTN","XMUDCHR",6,0)
 N XMREC,XMABORT
"RTN","XMUDCHR",7,0)
 S XMABORT=0
"RTN","XMUDCHR",8,0)
 S XMREC=$G(^XMB(1,1,0)) I '+XMREC,$O(^XMB(1,0)) G E
"RTN","XMUDCHR",9,0)
 I XMREC="" D
"RTN","XMUDCHR",10,0)
 . D INIT
"RTN","XMUDCHR",11,0)
 E  D
"RTN","XMUDCHR",12,0)
 . D CHANGE
"RTN","XMUDCHR",13,0)
 Q:XMABORT
"RTN","XMUDCHR",14,0)
 D PARENT
"RTN","XMUDCHR",15,0)
 D SCRIPT
"RTN","XMUDCHR",16,0)
 G Q
"RTN","XMUDCHR",17,0)
INIT ; Initial Christening
"RTN","XMUDCHR",18,0)
 N DIC,DIE,Y,DA,XMFDA
"RTN","XMUDCHR",19,0)
 S DIC=4.2,DIC(0)="AEMQ"
"RTN","XMUDCHR",20,0)
 D ^DIC I Y<1 S XMABORT=1 D E1 Q
"RTN","XMUDCHR",21,0)
 S XMFDA(4.3,"+1,",.01)=+Y
"RTN","XMUDCHR",22,0)
 D UPDATE^DIE("","XMFDA")
"RTN","XMUDCHR",23,0)
 K DIC,Y
"RTN","XMUDCHR",24,0)
 S DR="3//FORUM.VA.GOV;1//EST"
"RTN","XMUDCHR",25,0)
 S DIE=4.3,DA=1
"RTN","XMUDCHR",26,0)
 D ^DIE I $D(Y) S XMABORT=1 D E1
"RTN","XMUDCHR",27,0)
 Q
"RTN","XMUDCHR",28,0)
CHANGE ;
"RTN","XMUDCHR",29,0)
 N XMSITE,DIE,DA,DR,DIC,X,Y
"RTN","XMUDCHR",30,0)
 S XMSITE=$S($D(^XMB("NETNAME")):^XMB("NETNAME"),$D(^XMB("NAME")):^XMB("NAME"),$D(^DIC(4.2,+XMREC,0)):$P(^(0),U),1:XMREC)
"RTN","XMUDCHR",31,0)
 I '$$SURE(XMSITE) S XMABORT=1 Q  ; Are you sure?
"RTN","XMUDCHR",32,0)
 S DIC=4.2,DIC(0)="AEMQ",DIC("B")=$S($D(^DIC(4.2,+XMREC,0)):$P(^(0),U),1:XMSITE)
"RTN","XMUDCHR",33,0)
 D ^DIC I Y=-1 S XMABORT=1 Q
"RTN","XMUDCHR",34,0)
 I XMSITE'=$P(Y,U,2) D
"RTN","XMUDCHR",35,0)
 . I +Y=^XMB("NUM") D
"RTN","XMUDCHR",36,0)
 . . ; The domain name in file 4.2 has been changed.
"RTN","XMUDCHR",37,0)
 . . ; The pointer to file 4.2 has stayed the same.
"RTN","XMUDCHR",38,0)
 . . ; The filer won't fire the xrefs, so we need to do it manually
"RTN","XMUDCHR",39,0)
 . . S (^XMB("NETNAME"),^XMB("NAME"))=$P(Y,U,2)
"RTN","XMUDCHR",40,0)
 . E  D
"RTN","XMUDCHR",41,0)
 . . N XMFDA
"RTN","XMUDCHR",42,0)
 . . S XMFDA(4.3,"1,",.01)=+Y
"RTN","XMUDCHR",43,0)
 . . D FILE^DIE("","XMFDA")
"RTN","XMUDCHR",44,0)
 . W !!,"The domain name for this facility is now: ",^XMB("NETNAME")
"RTN","XMUDCHR",45,0)
 E  D
"RTN","XMUDCHR",46,0)
 . W !!,"The domain name for this facility remains: ",^XMB("NETNAME")
"RTN","XMUDCHR",47,0)
 K DIC,Y
"RTN","XMUDCHR",48,0)
 S DR="3//FORUM.VA.GOV;1//EST"
"RTN","XMUDCHR",49,0)
 S DIE=4.3,DA=1
"RTN","XMUDCHR",50,0)
 D ^DIE
"RTN","XMUDCHR",51,0)
 Q
"RTN","XMUDCHR",52,0)
SURE(XMSITE) ;  Function returns 1 if sure; 0 if not
"RTN","XMUDCHR",53,0)
 N DIR,X,Y
"RTN","XMUDCHR",54,0)
 W !!!,"         * * * *  WARNING  * * * *"
"RTN","XMUDCHR",55,0)
 W !!,"You are about to change the domain name of this facility"
"RTN","XMUDCHR",56,0)
 W !,"in the MailMan Site Parameters file."
"RTN","XMUDCHR",57,0)
 W !!,"Currently, this facility is named: ",XMSITE
"RTN","XMUDCHR",58,0)
 W !!,"You must be extremely sure before you proceed!",!
"RTN","XMUDCHR",59,0)
 S DIR("A")="Are you sure you want to change the name of this facility"
"RTN","XMUDCHR",60,0)
 S DIR("B")="NO"
"RTN","XMUDCHR",61,0)
 S DIR(0)="Y"
"RTN","XMUDCHR",62,0)
 D ^DIR Q:Y 1  ; Sure do!
"RTN","XMUDCHR",63,0)
 Q 0  ; Nope, I'm not sure!
"RTN","XMUDCHR",64,0)
PARENT ;
"RTN","XMUDCHR",65,0)
 N XMPARENT
"RTN","XMUDCHR",66,0)
 S XMPARENT=+$G(^XMB("PARENT"))
"RTN","XMUDCHR",67,0)
 I XMPARENT S XMPARENT=$S($D(^DIC(4.2,XMPARENT,0)):$P(^(0),U),1:0)
"RTN","XMUDCHR",68,0)
 I XMPARENT'=0 D
"RTN","XMUDCHR",69,0)
 . W !!,XMPARENT," has been initialized as your 'parent' domain."
"RTN","XMUDCHR",70,0)
 . W !,"(Forum is usually the parent domain, unless this is a subordinate domain.)"
"RTN","XMUDCHR",71,0)
 . W !!,"You may edit the MailMan Site Parameter file to change your parent domain."
"RTN","XMUDCHR",72,0)
 E  D
"RTN","XMUDCHR",73,0)
 . W !!,$C(7),"*** YOUR PARENT DOMAIN HAS NOT BEEN INITIALIZED !!! ***"
"RTN","XMUDCHR",74,0)
 . W !!,"You MUST edit the MailMan Site Parameter file to ENTER your parent domain."
"RTN","XMUDCHR",75,0)
 Q
"RTN","XMUDCHR",76,0)
SCRIPT ;RESET AUSTIN SCRIPT
"RTN","XMUDCHR",77,0)
 ;G SCRIPT^XMYPDOM
"RTN","XMUDCHR",78,0)
 W !!,"We will not initialize your transmission scripts."
"RTN","XMUDCHR",79,0)
 Q
"RTN","XMUDCHR",80,0)
Q W !!,"Use the 'Subroutine editor' option under network management menu to add your"
"RTN","XMUDCHR",81,0)
 W !,"site passwords to the MINIENGINE script, and the 'Edit a script' option"
"RTN","XMUDCHR",82,0)
 W !,"to edit any domain scripts that you choose to."
"RTN","XMUDCHR",83,0)
 ;D ^XMYPDOM
"RTN","XMUDCHR",84,0)
 Q
"RTN","XMUDCHR",85,0)
PMB S Y=Y+1000,^XMB(3.7,.5,2,+Y,1,0)=^TMP("XM",I,1,0),^XMB(3.7,.5,2,"B",$E($P(Y(0),U,1),1,30),+Y)="",^XMB(3.7,.5,2,+Y,0)=$P(Y(0),U)
"RTN","XMUDCHR",86,0)
 F J=0:0 S J=$O(^TMP("XM",I,1,J)) Q:J'>0  S ^XMB(3.7,.5,2,+Y,1,J,0)=J W "."
"RTN","XMUDCHR",87,0)
 Q
"RTN","XMUDCHR",88,0)
E W $C(7),!!,"There is a FILE INTEGRITY problem in your MailMan Site Parameters file",!,"There should only be one entry and that entry should be entry number 1.",!
"RTN","XMUDCHR",89,0)
E1 W $C(7),!,"Your MailMan site parameters MUST be reviewed."
"RTN","XMUDCHR",90,0)
EQ W !!,"Then you can finish the INIT by executing POST^XMYPOST.",! Q
"RTN","XMUDCHR",91,0)
E2 W $C(7),!,"You do not yet have an entry in your MailMan Site Parameters File",!,"Use FileMan to make an entry." G EQ
"RTN","XMUDNC")
0^339^B66680721
"RTN","XMUDNC",1,0)
XMUDNC ;ISC-SF/GMB-Domain Name Change ;04/17/2002  11:48
"RTN","XMUDNC",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMUDNC",3,0)
 ; A domain name change happens in two steps, in two patches:
"RTN","XMUDNC",4,0)
 ; 1. The first patch adds the new name as a synonym to the site's
"RTN","XMUDNC",5,0)
 ;    DOMAIN file entry at all sites.  (Entry SYNONYM)
"RTN","XMUDNC",6,0)
 ; 2. When all sites have added the synonym, the second patch switches
"RTN","XMUDNC",7,0)
 ;    the names in the DOMAIN file at all sites.  The synonym becomes
"RTN","XMUDNC",8,0)
 ;    the domain name, and old domain name becomes the synonym.
"RTN","XMUDNC",9,0)
 ;    The domain name is changed in each TCP/IP script, too.
"RTN","XMUDNC",10,0)
 ;    The domain name is changed in the Postmaster's basket.
"RTN","XMUDNC",11,0)
 ;    The site's name is changed in file 4.3 MAILMAN SITE PARAMETERS.
"RTN","XMUDNC",12,0)
 ;    (Entry CHANGE)
"RTN","XMUDNC",13,0)
SYNONYM ;
"RTN","XMUDNC",14,0)
 D BMES^XPDUTL("Add <new site name> as synonym for <current site name> in DOMAIN file.")
"RTN","XMUDNC",15,0)
 D REINDEX
"RTN","XMUDNC",16,0)
 N XMB,XMI,XMDOM,XMSUBDOM,XMSYN
"RTN","XMUDNC",17,0)
 ;D INIT("S") Q:'$D(^DOPT("XMSYN",$J))
"RTN","XMUDNC",18,0)
 S (XMB,XMI)=""
"RTN","XMUDNC",19,0)
 F  S XMB=$O(^DIC(4.2,"B",XMB)) Q:XMB=""  D
"RTN","XMUDNC",20,0)
 . F  S XMI=$O(^DIC(4.2,"B",XMB,XMI)) Q:XMI=""  D
"RTN","XMUDNC",21,0)
 . . N DIC,X,Y
"RTN","XMUDNC",22,0)
 . . S (X,XMDOM)=$P(^DIC(4.2,XMI,0),U,1)
"RTN","XMUDNC",23,0)
 . . S XMSUBDOM=""
"RTN","XMUDNC",24,0)
 . . S DIC="^DOPT(""XMSYN"",$J,"
"RTN","XMUDNC",25,0)
 . . S DIC(0)="XZ"
"RTN","XMUDNC",26,0)
 . . F  D ^DIC Q:Y>0!($L(X,".")<4)  D
"RTN","XMUDNC",27,0)
 . . . S XMSUBDOM=XMSUBDOM_$P(X,".")_"."
"RTN","XMUDNC",28,0)
 . . . S X=$P(X,".",2,99)
"RTN","XMUDNC",29,0)
 . . Q:Y<0  ; Quit if (sub) domain is not in the table
"RTN","XMUDNC",30,0)
 . . D BMES^XPDUTL("Domain: "_XMDOM)
"RTN","XMUDNC",31,0)
 . . S XMSYN=$P(Y(0),U,2)
"RTN","XMUDNC",32,0)
 . . I XMSYN="" S XMSYN=$P(XMDOM,".",1,$L(XMDOM,".")-2)_".MED.VA.GOV"
"RTN","XMUDNC",33,0)
 . . E  S XMSYN=XMSUBDOM_XMSYN
"RTN","XMUDNC",34,0)
 . . D CHKSYN(XMI,XMSYN)
"RTN","XMUDNC",35,0)
 K ^DOPT("XMSYN",$J)
"RTN","XMUDNC",36,0)
 Q
"RTN","XMUDNC",37,0)
INIT(XMENTRY) ; Load table into global
"RTN","XMUDNC",38,0)
 ; XMENTRY - An entry point in a pre-init (for synonyms) or post-init
"RTN","XMUDNC",39,0)
 ;           (for changes).
"RTN","XMUDNC",40,0)
 N DIK,I,X
"RTN","XMUDNC",41,0)
 K ^DOPT("XMSYN",$J)
"RTN","XMUDNC",42,0)
 F I=1:1 S X=$T(@XMENTRY+I) Q:X=" ;;"  S ^DOPT("XMSYN",$J,I,0)=$E(X,4,255)
"RTN","XMUDNC",43,0)
 Q:'$D(^DOPT("XMSYN",$J))
"RTN","XMUDNC",44,0)
 S ^DOPT("XMSYN",$J,0)="Domain Synonyms^1N^"
"RTN","XMUDNC",45,0)
 S DIK="^DOPT(""XMSYN"",$J,"
"RTN","XMUDNC",46,0)
 D IXALL^DIK
"RTN","XMUDNC",47,0)
 Q
"RTN","XMUDNC",48,0)
CHKSYN(XMDIEN,XMSYN) ;
"RTN","XMUDNC",49,0)
 N XMSIEN
"RTN","XMUDNC",50,0)
 D MES^XPDUTL("Lookup Synonym: "_XMSYN)
"RTN","XMUDNC",51,0)
 S XMSIEN=$$FIND1^DIC(4.2,"","MQX",XMSYN,"B^C")
"RTN","XMUDNC",52,0)
 I $D(DIERR) D  Q
"RTN","XMUDNC",53,0)
 . N XMI
"RTN","XMUDNC",54,0)
 . D MES^XPDUTL("*** Error on look up!")
"RTN","XMUDNC",55,0)
 . D MES^XPDUTL("*** Usually means more than one occurence.")
"RTN","XMUDNC",56,0)
 . I $D(^DIC(4.2,"B",XMSYN)) D MES^XPDUTL("*** Synonym is also a domain!")
"RTN","XMUDNC",57,0)
 . S XMI=0
"RTN","XMUDNC",58,0)
 . F  S XMI=$O(^DIC(4.2,"C",XMSYN,XMI)) Q:'XMI  D
"RTN","XMUDNC",59,0)
 . . D MES^XPDUTL("*** Synonym is for domain IEN "_XMI_", name "_$P(^DIC(4.2,XMI,0),U,1))
"RTN","XMUDNC",60,0)
 . D MES^XPDUTL("*** No action taken.  Please investigate and fix.")
"RTN","XMUDNC",61,0)
 I XMSIEN=XMDIEN D MES^XPDUTL("Already there.") Q
"RTN","XMUDNC",62,0)
 I XMSIEN D  Q
"RTN","XMUDNC",63,0)
 . I $D(^DIC(4.2,"B",XMSYN)) D MES^XPDUTL("*** Synonym is also a domain!")
"RTN","XMUDNC",64,0)
 . E  D MES^XPDUTL("*** Synonym is for domain IEN "_XMSIEN_", name "_$P(^DIC(4.2,XMSIEN,0),U,1))
"RTN","XMUDNC",65,0)
 . D MES^XPDUTL("*** No action taken.  Please investigate and fix.")
"RTN","XMUDNC",66,0)
 D MES^XPDUTL("Not found.  Adding it.")
"RTN","XMUDNC",67,0)
 S XMFDA(4.23,"+1,"_XMDIEN_",",.01)=XMSYN
"RTN","XMUDNC",68,0)
 D UPDATE^DIE("","XMFDA")
"RTN","XMUDNC",69,0)
 I $D(DIERR) D MES^XPDUTL("*** Error adding it!")
"RTN","XMUDNC",70,0)
 Q
"RTN","XMUDNC",71,0)
CHANGE ;
"RTN","XMUDNC",72,0)
 D BMES^XPDUTL("Change <current site name> to <new site name> in DOMAIN file.")
"RTN","XMUDNC",73,0)
 D REINDEX
"RTN","XMUDNC",74,0)
 N XMB,XMI,XMDOM,XMSUBDOM,XMSYN
"RTN","XMUDNC",75,0)
 ;D INIT("C") Q:'$D(^DOPT("XMSYN",$J))
"RTN","XMUDNC",76,0)
 K ^TMP("XM",$J)
"RTN","XMUDNC",77,0)
 S (XMB,XMI)=""
"RTN","XMUDNC",78,0)
 F  S XMB=$O(^DIC(4.2,"B",XMB)) Q:XMB=""  D
"RTN","XMUDNC",79,0)
 . F  S XMI=$O(^DIC(4.2,"B",XMB,XMI)) Q:XMI=""  D
"RTN","XMUDNC",80,0)
 . . N DIC,X,Y,XMSTAT
"RTN","XMUDNC",81,0)
 . . S (X,XMDOM)=$P(^DIC(4.2,XMI,0),U,1)
"RTN","XMUDNC",82,0)
 . . S XMSUBDOM=""
"RTN","XMUDNC",83,0)
 . . S DIC="^DOPT(""XMSYN"",$J,"
"RTN","XMUDNC",84,0)
 . . S DIC(0)="XZ"
"RTN","XMUDNC",85,0)
 . . F  D ^DIC Q:Y>0!($L(X,".")<4)  D
"RTN","XMUDNC",86,0)
 . . . S XMSUBDOM=XMSUBDOM_$P(X,".")_"."
"RTN","XMUDNC",87,0)
 . . . S X=$P(X,".",2,99)
"RTN","XMUDNC",88,0)
 . . Q:Y<0  ; Quit if (sub) domain is not in the table
"RTN","XMUDNC",89,0)
 . . D BMES^XPDUTL("Domain: "_XMDOM)
"RTN","XMUDNC",90,0)
 . . S XMSYN=$P(Y(0),U,2)
"RTN","XMUDNC",91,0)
 . . I XMSYN="" S XMSYN=$P(XMDOM,".",1,$L(XMDOM,".")-2)_".MED.VA.GOV"
"RTN","XMUDNC",92,0)
 . . E  S XMSYN=XMSUBDOM_XMSYN
"RTN","XMUDNC",93,0)
 . . D CHKNAME(XMI,XMDOM,XMSYN,.XMSTAT)
"RTN","XMUDNC",94,0)
 . . S ^TMP("XM",$J,XMDOM)=XMSYN_U_$G(XMSTAT,"ERROR")
"RTN","XMUDNC",95,0)
 I $G(^XMB("NUM"))'=$P(^XMB(1,1,0),U,1) S ^XMB("NUM")=$P(^XMB(1,1,0),U,1)
"RTN","XMUDNC",96,0)
 I ^XMB("NETNAME")'=$P(^DIC(4.2,^XMB("NUM"),0),U,1) D
"RTN","XMUDNC",97,0)
 . S (^XMB("NETNAME"),^XMB("NETNAME"))=$P(^DIC(4.2,^XMB("NUM"),0),U,1)
"RTN","XMUDNC",98,0)
 . D BMES^XPDUTL("The name of this site has been changed to "_^XMB("NETNAME"))
"RTN","XMUDNC",99,0)
 D CSUMM
"RTN","XMUDNC",100,0)
 Q
"RTN","XMUDNC",101,0)
CHKNAME(XMDIEN,XMDOM,XMSYN,XMSTAT) ;
"RTN","XMUDNC",102,0)
 N XMSIEN
"RTN","XMUDNC",103,0)
 D MES^XPDUTL("Lookup Synonym: "_XMSYN)
"RTN","XMUDNC",104,0)
 S XMSIEN=$$FIND1^DIC(4.2,"","MQX",XMSYN,"B^C")
"RTN","XMUDNC",105,0)
 I $D(DIERR) D  Q
"RTN","XMUDNC",106,0)
 . N XMI
"RTN","XMUDNC",107,0)
 . D MES^XPDUTL("*** Error on look up!")
"RTN","XMUDNC",108,0)
 . D MES^XPDUTL("*** Usually means more than one occurence.")
"RTN","XMUDNC",109,0)
 . I $D(^DIC(4.2,"B",XMSYN)) D MES^XPDUTL("*** Synonym is also a domain!")
"RTN","XMUDNC",110,0)
 . S XMI=0
"RTN","XMUDNC",111,0)
 . F  S XMI=$O(^DIC(4.2,"C",XMSYN,XMI)) Q:'XMI  D
"RTN","XMUDNC",112,0)
 . . D MES^XPDUTL("*** Synonym is for domain IEN "_XMI_", name "_$P(^DIC(4.2,XMI,0),U,1))
"RTN","XMUDNC",113,0)
 . D MES^XPDUTL("*** No action taken.  Please investigate and fix.")
"RTN","XMUDNC",114,0)
 I XMSIEN=XMDIEN D  Q
"RTN","XMUDNC",115,0)
 . D MES^XPDUTL("Already there.  Reversing domain/synonym:")
"RTN","XMUDNC",116,0)
 . D REVERSE(XMDIEN,XMDOM,XMSYN,.XMSTAT)
"RTN","XMUDNC",117,0)
 I XMSIEN D  Q
"RTN","XMUDNC",118,0)
 . I $D(^DIC(4.2,"B",XMSYN)) D MES^XPDUTL("*** Synonym is also a domain!")
"RTN","XMUDNC",119,0)
 . E  D MES^XPDUTL("*** Synonym is for domain IEN "_XMSIEN_", name "_$P(^DIC(4.2,XMSIEN,0),U,1))
"RTN","XMUDNC",120,0)
 . D MES^XPDUTL("*** No action taken.  Please investigate and fix.")
"RTN","XMUDNC",121,0)
 D MES^XPDUTL("Not found.  Adding it.")
"RTN","XMUDNC",122,0)
 S XMFDA(4.23,"+1,"_XMDIEN_",",.01)=XMSYN
"RTN","XMUDNC",123,0)
 D UPDATE^DIE("","XMFDA")
"RTN","XMUDNC",124,0)
 I $D(DIERR) D MES^XPDUTL("*** Error adding it!") Q
"RTN","XMUDNC",125,0)
 D MES^XPDUTL("Reversing domain/synonym:")
"RTN","XMUDNC",126,0)
 D REVERSE(XMDIEN,XMDOM,XMSYN,.XMSTAT)
"RTN","XMUDNC",127,0)
 Q
"RTN","XMUDNC",128,0)
REVERSE(XMDIEN,XMOLDNAM,XMNEWNAM,XMSTAT) ;
"RTN","XMUDNC",129,0)
 I '$D(^DIC(4.2,"C",XMOLDNAM,XMDIEN)) D  Q:$D(DIERR)
"RTN","XMUDNC",130,0)
 . D MES^XPDUTL(XMOLDNAM_" is not yet a synonym of itself.  Adding it.")
"RTN","XMUDNC",131,0)
 . S XMFDA(4.23,"+1,"_XMDIEN_",",.01)=XMOLDNAM
"RTN","XMUDNC",132,0)
 . D UPDATE^DIE("","XMFDA")
"RTN","XMUDNC",133,0)
 . I $D(DIERR) D MES^XPDUTL("*** Error adding it!")
"RTN","XMUDNC",134,0)
 E  D MES^XPDUTL(XMOLDNAM_" is already a synonym of itself.")
"RTN","XMUDNC",135,0)
 D MES^XPDUTL("Change the domain name in the transmission scripts.")
"RTN","XMUDNC",136,0)
 N XMI,XMJ,XMTEXT
"RTN","XMUDNC",137,0)
 S XMI=0
"RTN","XMUDNC",138,0)
 F  S XMI=$O(^DIC(4.2,XMDIEN,1,XMI)) Q:'XMI  D
"RTN","XMUDNC",139,0)
 . S XMJ=0
"RTN","XMUDNC",140,0)
 . F  S XMJ=$O(^DIC(4.2,XMDIEN,1,XMI,1,XMJ)) Q:'XMJ  D
"RTN","XMUDNC",141,0)
 . . Q:^DIC(4.2,XMDIEN,1,XMI,1,XMJ,0)'[XMOLDNAM
"RTN","XMUDNC",142,0)
 . . S XMTEXT=^DIC(4.2,XMDIEN,1,XMI,1,XMJ,0)
"RTN","XMUDNC",143,0)
 . . S ^DIC(4.2,XMDIEN,1,XMI,1,XMJ,0)=$P(XMTEXT,XMOLDNAM,1)_XMNEWNAM_$P(XMTEXT,XMOLDNAM,2)
"RTN","XMUDNC",144,0)
 I $D(^XMB(3.7,.5,2,1000+XMDIEN,0)) D
"RTN","XMUDNC",145,0)
 . D MES^XPDUTL("Change the transmission queue name to "_XMNEWNAM_".")
"RTN","XMUDNC",146,0)
 . S XMFDA(3.701,1000+XMDIEN_",.5,",.01)=$E(XMNEWNAM,1,30)
"RTN","XMUDNC",147,0)
 . D FILE^DIE("","XMFDA")
"RTN","XMUDNC",148,0)
 . I $D(DIERR) D MES^XPDUTL("*** Error changing it!")
"RTN","XMUDNC",149,0)
 E  D MES^XPDUTL("There is no transmission queue for this domain.  That's OK.")
"RTN","XMUDNC",150,0)
 D MES^XPDUTL("Change the domain name to "_XMNEWNAM_".")
"RTN","XMUDNC",151,0)
 S XMFDA(4.2,XMDIEN_",",.01)=XMNEWNAM
"RTN","XMUDNC",152,0)
 D FILE^DIE("","XMFDA")
"RTN","XMUDNC",153,0)
 I $D(DIERR) D MES^XPDUTL("*** Error changing it!") Q
"RTN","XMUDNC",154,0)
 S XMSTAT="DONE"
"RTN","XMUDNC",155,0)
 Q
"RTN","XMUDNC",156,0)
CSUMM ;
"RTN","XMUDNC",157,0)
 N XMI,XMREC,XMOLD,XMNEW,XMCHK
"RTN","XMUDNC",158,0)
 S XMI=0
"RTN","XMUDNC",159,0)
 F  S XMI=$O(^DOPT("XMSYN",$J,XMI)) Q:'XMI  S XMREC=^(XMI,0) D
"RTN","XMUDNC",160,0)
 . S XMOLD=$P(XMREC,U,1)
"RTN","XMUDNC",161,0)
 . Q:$D(^TMP("XM",$J,XMOLD))
"RTN","XMUDNC",162,0)
 . S (XMNEW,XMCHK)=$P(XMREC,U,2) I XMNEW="" S XMNEW="xxx.MED.VA.GOV",XMCHK=$P(XMOLD,".",1,$L(XMOLD,".")-2)_".MED.VA.GOV"
"RTN","XMUDNC",163,0)
 . S ^TMP("XM",$J,XMOLD)=XMNEW_U_$S($D(^DIC(4.2,"B",XMCHK)):"OK",1:"???")
"RTN","XMUDNC",164,0)
 D BMES^XPDUTL("Summary for Domain Name Change")
"RTN","XMUDNC",165,0)
 D MES^XPDUTL("Status key:")
"RTN","XMUDNC",166,0)
 D MES^XPDUTL("  OK:    Already changed, did not check further.")
"RTN","XMUDNC",167,0)
 D MES^XPDUTL("  DONE:  Name changed during this install.")
"RTN","XMUDNC",168,0)
 D MES^XPDUTL("  ERROR: Error noted.  See listing above and fix.")
"RTN","XMUDNC",169,0)
 D MES^XPDUTL("  ???:   Not in your DOMAIN file.  Consider adding it.")
"RTN","XMUDNC",170,0)
 D BMES^XPDUTL($$LJ^XLFSTR("Old Name",34)_" "_$$LJ^XLFSTR("New Name",37)_" Status")
"RTN","XMUDNC",171,0)
 D MES^XPDUTL($$LJ^XLFSTR("",34,"-")_" "_$$LJ^XLFSTR("",37,"-")_" ------")
"RTN","XMUDNC",172,0)
 S XMOLD=""
"RTN","XMUDNC",173,0)
 F  S XMOLD=$O(^TMP("XM",$J,XMOLD)) Q:XMOLD=""  S XMREC=^(XMOLD) D
"RTN","XMUDNC",174,0)
 . D MES^XPDUTL($$LJ^XLFSTR($E(XMOLD,1,34),35)_$$LJ^XLFSTR($E($P(XMREC,U,1),1,37),38)_$E($P(XMREC,U,2),1,6))
"RTN","XMUDNC",175,0)
 K ^DOPT("XMSYN",$J),^TMP("XM",$J)
"RTN","XMUDNC",176,0)
 Q
"RTN","XMUDNC",177,0)
REINDEX ;
"RTN","XMUDNC",178,0)
 D MES^XPDUTL("First, let's reindex the B and C xrefs.")
"RTN","XMUDNC",179,0)
 N DIK,DA,XMI
"RTN","XMUDNC",180,0)
 K ^DIC(4.2,"B"),^DIC(4.2,"C")
"RTN","XMUDNC",181,0)
 S DIK="^DIC(4.2,",DIK(1)=".01^B" D ENALL^DIK
"RTN","XMUDNC",182,0)
 S XMI=0
"RTN","XMUDNC",183,0)
 F  S XMI=$O(^DIC(4.2,XMI)) Q:'XMI  D
"RTN","XMUDNC",184,0)
 . N DIK,DA
"RTN","XMUDNC",185,0)
 . Q:'$O(^DIC(4.2,XMI,2,0))
"RTN","XMUDNC",186,0)
 . S DA(1)=XMI,DIK="^DIC(4.2,"_DA(1)_",2,",DIK(1)=".01^C" D ENALL^DIK
"RTN","XMUDNC",187,0)
 D MES^XPDUTL("Done reindexing.  Let's get down to business...")
"RTN","XMUDNC",188,0)
 Q
"RTN","XMUDNC",189,0)
S ;;current site name^new site name (Add synonyms)
"RTN","XMUDNC",190,0)
 ;;ISC-SF.VA.GOV^FO-OAKLAND.MED.VA.GOV
"RTN","XMUDNC",191,0)
 ;;
"RTN","XMUDNC",192,0)
C ;;current site name^new site name (Change the names)
"RTN","XMUDNC",193,0)
 ;;ISC-SF.VA.GOV^FO-OAKLAND.MED.VA.GOV
"RTN","XMUDNC",194,0)
 ;;
"RTN","XMUDTOP")
0^340^B52913690
"RTN","XMUDTOP",1,0)
XMUDTOP ;ISC-SF/GMB-Top-Level Domain Names ;04/17/2002  11:48
"RTN","XMUDTOP",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMUDTOP",3,0)
 Q
"RTN","XMUDTOP",4,0)
ENTRY ; Populate file 4.2996 with the proper, recognized top-level domains.
"RTN","XMUDTOP",5,0)
 D DELALL
"RTN","XMUDTOP",6,0)
 D ADD
"RTN","XMUDTOP",7,0)
 Q
"RTN","XMUDTOP",8,0)
DELALL ; Delete all entries.
"RTN","XMUDTOP",9,0)
 N DIK,DA
"RTN","XMUDTOP",10,0)
 S DIK="^DIC(4.2996,"
"RTN","XMUDTOP",11,0)
 S DA=0
"RTN","XMUDTOP",12,0)
 F  S DA=$O(^DIC(4.2996,DA)) Q:'DA  D ^DIK
"RTN","XMUDTOP",13,0)
 K ^DIC(4.2996,"B")
"RTN","XMUDTOP",14,0)
 Q
"RTN","XMUDTOP",15,0)
ADD ; Add entries
"RTN","XMUDTOP",16,0)
 N I,XMFDA,XMIEN,XMREC
"RTN","XMUDTOP",17,0)
 F I=1:1 S X=$T(T+I) Q:X=" ;;"  D
"RTN","XMUDTOP",18,0)
 . S XMREC=$E(X,4,255)
"RTN","XMUDTOP",19,0)
 . S XMIENS="?+1,"
"RTN","XMUDTOP",20,0)
 . S XMFDA(4.2996,XMIENS,.01)=$P(XMREC,U,1)
"RTN","XMUDTOP",21,0)
 . S XMFDA(4.2996,XMIENS,1)=$P(XMREC,U,2)
"RTN","XMUDTOP",22,0)
 . D UPDATE^DIE("","XMFDA")
"RTN","XMUDTOP",23,0)
 . I $D(DIERR) W !,"ERROR=",XMREC
"RTN","XMUDTOP",24,0)
 Q
"RTN","XMUDTOP",25,0)
T ;
"RTN","XMUDTOP",26,0)
 ;;AERO^AIR TRANSPORT INDUSTRY
"RTN","XMUDTOP",27,0)
 ;;BIZ^BUSINESS
"RTN","XMUDTOP",28,0)
 ;;COM^COMMERCIAL
"RTN","XMUDTOP",29,0)
 ;;COOP^NON-PROFIT COOPERATIVE
"RTN","XMUDTOP",30,0)
 ;;EDU^EDUCATIONAL
"RTN","XMUDTOP",31,0)
 ;;GOV^US GOVERNMENT
"RTN","XMUDTOP",32,0)
 ;;INFO^GENERAL USE
"RTN","XMUDTOP",33,0)
 ;;INT^INTERNATIONAL ORGANIZATION
"RTN","XMUDTOP",34,0)
 ;;MIL^US MILITARY
"RTN","XMUDTOP",35,0)
 ;;MUSEUM^ACCREDITED MUSEUM
"RTN","XMUDTOP",36,0)
 ;;NAME^INDIVIDUALS
"RTN","XMUDTOP",37,0)
 ;;NET^NETWORK PROVIDER
"RTN","XMUDTOP",38,0)
 ;;ORG^NON-PROFIT ORGANIZATION
"RTN","XMUDTOP",39,0)
 ;;PRO^PROFESSIONAL
"RTN","XMUDTOP",40,0)
 ;;AC^ASCENSION ISLAND
"RTN","XMUDTOP",41,0)
 ;;AD^ANDORRA
"RTN","XMUDTOP",42,0)
 ;;AE^UNITED ARAB EMIRATES
"RTN","XMUDTOP",43,0)
 ;;AF^AFGHANISTAN
"RTN","XMUDTOP",44,0)
 ;;AG^ANTIGUA AND BARBUDA
"RTN","XMUDTOP",45,0)
 ;;AI^ANGUILLA
"RTN","XMUDTOP",46,0)
 ;;AL^ALBANIA
"RTN","XMUDTOP",47,0)
 ;;AM^ARMENIA
"RTN","XMUDTOP",48,0)
 ;;AN^NETHERLANDS ANTILLES
"RTN","XMUDTOP",49,0)
 ;;AO^ANGOLA
"RTN","XMUDTOP",50,0)
 ;;AQ^ANTARCTICA
"RTN","XMUDTOP",51,0)
 ;;AR^ARGENTINA
"RTN","XMUDTOP",52,0)
 ;;AS^AMERICAN SAMOA
"RTN","XMUDTOP",53,0)
 ;;AT^AUSTRIA
"RTN","XMUDTOP",54,0)
 ;;AU^AUSTRALIA
"RTN","XMUDTOP",55,0)
 ;;AW^ARUBA
"RTN","XMUDTOP",56,0)
 ;;AZ^AZERBAIJAN
"RTN","XMUDTOP",57,0)
 ;;BA^BOSNIA AND HERZEGOVINA
"RTN","XMUDTOP",58,0)
 ;;BB^BARBADOS
"RTN","XMUDTOP",59,0)
 ;;BD^BANGLADESH
"RTN","XMUDTOP",60,0)
 ;;BE^BELGIUM
"RTN","XMUDTOP",61,0)
 ;;BF^BURKINA FASO
"RTN","XMUDTOP",62,0)
 ;;BG^BULGARIA
"RTN","XMUDTOP",63,0)
 ;;BH^BAHRAIN
"RTN","XMUDTOP",64,0)
 ;;BI^BURUNDI
"RTN","XMUDTOP",65,0)
 ;;BJ^BENIN
"RTN","XMUDTOP",66,0)
 ;;BM^BERMUDA
"RTN","XMUDTOP",67,0)
 ;;BN^BRUNEI DARUSSALAM
"RTN","XMUDTOP",68,0)
 ;;BO^BOLIVIA
"RTN","XMUDTOP",69,0)
 ;;BR^BRAZIL
"RTN","XMUDTOP",70,0)
 ;;BS^BAHAMAS
"RTN","XMUDTOP",71,0)
 ;;BT^BHUTAN
"RTN","XMUDTOP",72,0)
 ;;BV^BOUVET ISLAND
"RTN","XMUDTOP",73,0)
 ;;BW^BOTSWANA
"RTN","XMUDTOP",74,0)
 ;;BY^BELARUS
"RTN","XMUDTOP",75,0)
 ;;BZ^BELIZE
"RTN","XMUDTOP",76,0)
 ;;CA^CANADA
"RTN","XMUDTOP",77,0)
 ;;CC^COCOS (KEELING) ISLANDS
"RTN","XMUDTOP",78,0)
 ;;CD^CONGO, DEMOCRATIC PEOPLE'S REPUBLIC
"RTN","XMUDTOP",79,0)
 ;;CF^CENTRAL AFRICAN REPUBLIC
"RTN","XMUDTOP",80,0)
 ;;CG^CONGO, REPUBLIC OF
"RTN","XMUDTOP",81,0)
 ;;CH^SWITZERLAND
"RTN","XMUDTOP",82,0)
 ;;CI^COTE D'IVOIRE
"RTN","XMUDTOP",83,0)
 ;;CK^COOK ISLANDS
"RTN","XMUDTOP",84,0)
 ;;CL^CHILE
"RTN","XMUDTOP",85,0)
 ;;CM^CAMEROON
"RTN","XMUDTOP",86,0)
 ;;CN^CHINA
"RTN","XMUDTOP",87,0)
 ;;CO^COLOMBIA
"RTN","XMUDTOP",88,0)
 ;;CR^COSTA RICA
"RTN","XMUDTOP",89,0)
 ;;CU^CUBA
"RTN","XMUDTOP",90,0)
 ;;CV^CAPE VERDE
"RTN","XMUDTOP",91,0)
 ;;CX^CHRISTMAS ISLAND
"RTN","XMUDTOP",92,0)
 ;;CY^CYPRUS
"RTN","XMUDTOP",93,0)
 ;;CZ^CZECH REPUBLIC
"RTN","XMUDTOP",94,0)
 ;;DE^GERMANY
"RTN","XMUDTOP",95,0)
 ;;DJ^DJIBOUTI
"RTN","XMUDTOP",96,0)
 ;;DK^DENMARK
"RTN","XMUDTOP",97,0)
 ;;DM^DOMINICA
"RTN","XMUDTOP",98,0)
 ;;DO^DOMINICAN REPUBLIC
"RTN","XMUDTOP",99,0)
 ;;DZ^ALGERIA
"RTN","XMUDTOP",100,0)
 ;;EC^ECUADOR
"RTN","XMUDTOP",101,0)
 ;;EE^ESTONIA
"RTN","XMUDTOP",102,0)
 ;;EG^EGYPT
"RTN","XMUDTOP",103,0)
 ;;EH^WESTERN SAHARA
"RTN","XMUDTOP",104,0)
 ;;ER^ERITREA
"RTN","XMUDTOP",105,0)
 ;;ES^SPAIN
"RTN","XMUDTOP",106,0)
 ;;ET^ETHIOPIA
"RTN","XMUDTOP",107,0)
 ;;FI^FINLAND
"RTN","XMUDTOP",108,0)
 ;;FJ^FIJI
"RTN","XMUDTOP",109,0)
 ;;FK^FALKLAND ISLANDS (MALVINAS)
"RTN","XMUDTOP",110,0)
 ;;FM^MICRONESIA, FEDERATED STATES OF
"RTN","XMUDTOP",111,0)
 ;;FO^FAROE ISLANDS
"RTN","XMUDTOP",112,0)
 ;;FR^FRANCE
"RTN","XMUDTOP",113,0)
 ;;GA^GABON
"RTN","XMUDTOP",114,0)
 ;;GB^UNITED KINGDOM
"RTN","XMUDTOP",115,0)
 ;;GD^GRENADA
"RTN","XMUDTOP",116,0)
 ;;GE^GEORGIA
"RTN","XMUDTOP",117,0)
 ;;GF^FRENCH GUIANA
"RTN","XMUDTOP",118,0)
 ;;GG^GUERNSEY
"RTN","XMUDTOP",119,0)
 ;;GH^GHANA
"RTN","XMUDTOP",120,0)
 ;;GI^GIBRALTAR
"RTN","XMUDTOP",121,0)
 ;;GL^GREENLAND
"RTN","XMUDTOP",122,0)
 ;;GM^GAMBIA
"RTN","XMUDTOP",123,0)
 ;;GN^GUINEA
"RTN","XMUDTOP",124,0)
 ;;GP^GUADELOUPE
"RTN","XMUDTOP",125,0)
 ;;GQ^EQUATORIAL GUINEA
"RTN","XMUDTOP",126,0)
 ;;GR^GREECE
"RTN","XMUDTOP",127,0)
 ;;GS^SOUTH GEORGIA AND THE SOUTH SANDWICH ISLANDS
"RTN","XMUDTOP",128,0)
 ;;GT^GUATEMALA
"RTN","XMUDTOP",129,0)
 ;;GU^GUAM
"RTN","XMUDTOP",130,0)
 ;;GW^GUINEA-BISSAU
"RTN","XMUDTOP",131,0)
 ;;GY^GUYANA
"RTN","XMUDTOP",132,0)
 ;;HK^HONG KONG
"RTN","XMUDTOP",133,0)
 ;;HM^HEARD ISLAND AND MCDONALD ISLANDS
"RTN","XMUDTOP",134,0)
 ;;HN^HONDURAS
"RTN","XMUDTOP",135,0)
 ;;HR^CROATIA/HRVATSKA
"RTN","XMUDTOP",136,0)
 ;;HT^HAITI
"RTN","XMUDTOP",137,0)
 ;;HU^HUNGARY
"RTN","XMUDTOP",138,0)
 ;;ID^INDONESIA
"RTN","XMUDTOP",139,0)
 ;;IE^IRELAND
"RTN","XMUDTOP",140,0)
 ;;IL^ISRAEL
"RTN","XMUDTOP",141,0)
 ;;IM^ISLE OF MAN
"RTN","XMUDTOP",142,0)
 ;;IN^INDIA
"RTN","XMUDTOP",143,0)
 ;;IO^BRITISH INDIAN OCEAN TERRITORY
"RTN","XMUDTOP",144,0)
 ;;IQ^IRAQ
"RTN","XMUDTOP",145,0)
 ;;IR^IRAN, ISLAMIC REPUBLIC OF
"RTN","XMUDTOP",146,0)
 ;;IS^ICELAND
"RTN","XMUDTOP",147,0)
 ;;IT^ITALY
"RTN","XMUDTOP",148,0)
 ;;JE^JERSEY
"RTN","XMUDTOP",149,0)
 ;;JM^JAMAICA
"RTN","XMUDTOP",150,0)
 ;;JO^JORDAN
"RTN","XMUDTOP",151,0)
 ;;JP^JAPAN
"RTN","XMUDTOP",152,0)
 ;;KE^KENYA
"RTN","XMUDTOP",153,0)
 ;;KG^KYRGYZSTAN
"RTN","XMUDTOP",154,0)
 ;;KH^CAMBODIA
"RTN","XMUDTOP",155,0)
 ;;KI^KIRIBATI
"RTN","XMUDTOP",156,0)
 ;;KM^COMOROS
"RTN","XMUDTOP",157,0)
 ;;KN^SAINT KITTS AND NEVIS
"RTN","XMUDTOP",158,0)
 ;;KP^KOREA, DEMOCRATIC PEOPLE'S REPUBLIC OF
"RTN","XMUDTOP",159,0)
 ;;KR^KOREA, REPUBLIC OF
"RTN","XMUDTOP",160,0)
 ;;KW^KUWAIT
"RTN","XMUDTOP",161,0)
 ;;KY^CAYMAN ISLANDS
"RTN","XMUDTOP",162,0)
 ;;KZ^KAZAKSTAN
"RTN","XMUDTOP",163,0)
 ;;LA^LAO PEOPLE'S DEMOCRATIC REPUBLIC
"RTN","XMUDTOP",164,0)
 ;;LB^LEBANON
"RTN","XMUDTOP",165,0)
 ;;LC^SAINT LUCIA
"RTN","XMUDTOP",166,0)
 ;;LI^LIECHTENSTEIN
"RTN","XMUDTOP",167,0)
 ;;LK^SRI LANKA
"RTN","XMUDTOP",168,0)
 ;;LR^LIBERIA
"RTN","XMUDTOP",169,0)
 ;;LS^LESOTHO
"RTN","XMUDTOP",170,0)
 ;;LT^LITHUANIA
"RTN","XMUDTOP",171,0)
 ;;LU^LUXEMBOURG
"RTN","XMUDTOP",172,0)
 ;;LV^LATVIA
"RTN","XMUDTOP",173,0)
 ;;LY^LIBYAN ARAB JAMAHIRIYA
"RTN","XMUDTOP",174,0)
 ;;MA^MOROCCO
"RTN","XMUDTOP",175,0)
 ;;MC^MONACO
"RTN","XMUDTOP",176,0)
 ;;MD^MOLDOVA, REPUBLIC OF
"RTN","XMUDTOP",177,0)
 ;;MG^MADAGASCAR
"RTN","XMUDTOP",178,0)
 ;;MH^MARSHALL ISLANDS
"RTN","XMUDTOP",179,0)
 ;;MK^MACEDONIA, FORMER YUGOSLAV REPUBLIC OF
"RTN","XMUDTOP",180,0)
 ;;ML^MALI
"RTN","XMUDTOP",181,0)
 ;;MM^MYANMAR
"RTN","XMUDTOP",182,0)
 ;;MN^MONGOLIA
"RTN","XMUDTOP",183,0)
 ;;MO^MACAU
"RTN","XMUDTOP",184,0)
 ;;MP^NORTHERN MARIANA ISLANDS
"RTN","XMUDTOP",185,0)
 ;;MQ^MARTINIQUE
"RTN","XMUDTOP",186,0)
 ;;MR^MAURITANIA
"RTN","XMUDTOP",187,0)
 ;;MS^MONTSERRAT
"RTN","XMUDTOP",188,0)
 ;;MT^MALTA
"RTN","XMUDTOP",189,0)
 ;;MU^MAURITIUS
"RTN","XMUDTOP",190,0)
 ;;MV^MALDIVES
"RTN","XMUDTOP",191,0)
 ;;MW^MALAWI
"RTN","XMUDTOP",192,0)
 ;;MX^MEXICO
"RTN","XMUDTOP",193,0)
 ;;MY^MALAYSIA
"RTN","XMUDTOP",194,0)
 ;;MZ^MOZAMBIQUE
"RTN","XMUDTOP",195,0)
 ;;NA^NAMIBIA
"RTN","XMUDTOP",196,0)
 ;;NC^NEW CALEDONIA
"RTN","XMUDTOP",197,0)
 ;;NE^NIGER
"RTN","XMUDTOP",198,0)
 ;;NF^NORFOLK ISLAND
"RTN","XMUDTOP",199,0)
 ;;NG^NIGERIA
"RTN","XMUDTOP",200,0)
 ;;NI^NICARAGUA
"RTN","XMUDTOP",201,0)
 ;;NL^NETHERLANDS
"RTN","XMUDTOP",202,0)
 ;;NO^NORWAY
"RTN","XMUDTOP",203,0)
 ;;NP^NEPAL
"RTN","XMUDTOP",204,0)
 ;;NR^NAURU
"RTN","XMUDTOP",205,0)
 ;;NU^NIUE
"RTN","XMUDTOP",206,0)
 ;;NZ^NEW ZEALAND
"RTN","XMUDTOP",207,0)
 ;;OM^OMAN
"RTN","XMUDTOP",208,0)
 ;;PA^PANAMA
"RTN","XMUDTOP",209,0)
 ;;PE^PERU
"RTN","XMUDTOP",210,0)
 ;;PF^FRENCH POLYNESIA
"RTN","XMUDTOP",211,0)
 ;;PG^PAPUA NEW GUINEA
"RTN","XMUDTOP",212,0)
 ;;PH^PHILIPPINES
"RTN","XMUDTOP",213,0)
 ;;PK^PAKISTAN
"RTN","XMUDTOP",214,0)
 ;;PL^POLAND
"RTN","XMUDTOP",215,0)
 ;;PM^SAINT PIERRE AND MIQUELON
"RTN","XMUDTOP",216,0)
 ;;PN^PITCAIRN ISLAND
"RTN","XMUDTOP",217,0)
 ;;PR^PUERTO RICO
"RTN","XMUDTOP",218,0)
 ;;PS^PALESTINIAN TERRITORIES
"RTN","XMUDTOP",219,0)
 ;;PT^PORTUGAL
"RTN","XMUDTOP",220,0)
 ;;PW^PALAU
"RTN","XMUDTOP",221,0)
 ;;PY^PARAGUAY
"RTN","XMUDTOP",222,0)
 ;;QA^QATAR
"RTN","XMUDTOP",223,0)
 ;;RE^REUNION ISLAND
"RTN","XMUDTOP",224,0)
 ;;RO^ROMANIA
"RTN","XMUDTOP",225,0)
 ;;RU^RUSSIAN FEDERATION
"RTN","XMUDTOP",226,0)
 ;;RW^RWANDA
"RTN","XMUDTOP",227,0)
 ;;SA^SAUDI ARABIA
"RTN","XMUDTOP",228,0)
 ;;SB^SOLOMON ISLANDS
"RTN","XMUDTOP",229,0)
 ;;SC^SEYCHELLES
"RTN","XMUDTOP",230,0)
 ;;SD^SUDAN
"RTN","XMUDTOP",231,0)
 ;;SE^SWEDEN
"RTN","XMUDTOP",232,0)
 ;;SG^SINGAPORE
"RTN","XMUDTOP",233,0)
 ;;SH^SAINT HELENA
"RTN","XMUDTOP",234,0)
 ;;SI^SLOVENIA
"RTN","XMUDTOP",235,0)
 ;;SJ^SVALBARD AND JAN MAYEN
"RTN","XMUDTOP",236,0)
 ;;SK^SLOVAK REPUBLIC
"RTN","XMUDTOP",237,0)
 ;;SL^SIERRA LEONE
"RTN","XMUDTOP",238,0)
 ;;SM^SAN MARINO
"RTN","XMUDTOP",239,0)
 ;;SN^SENEGAL
"RTN","XMUDTOP",240,0)
 ;;SO^SOMALIA
"RTN","XMUDTOP",241,0)
 ;;SR^SURINAME
"RTN","XMUDTOP",242,0)
 ;;ST^SAO TOME AND PRINCIPE
"RTN","XMUDTOP",243,0)
 ;;SV^EL SALVADOR
"RTN","XMUDTOP",244,0)
 ;;SY^SYRIAN ARAB REPUBLIC
"RTN","XMUDTOP",245,0)
 ;;SZ^SWAZILAND
"RTN","XMUDTOP",246,0)
 ;;TC^TURKS AND CAICOS ISLANDS
"RTN","XMUDTOP",247,0)
 ;;TD^CHAD
"RTN","XMUDTOP",248,0)
 ;;TF^FRENCH SOUTHERN TERRITORIES
"RTN","XMUDTOP",249,0)
 ;;TG^TOGO
"RTN","XMUDTOP",250,0)
 ;;TH^THAILAND
"RTN","XMUDTOP",251,0)
 ;;TJ^TAJIKISTAN
"RTN","XMUDTOP",252,0)
 ;;TK^TOKELAU
"RTN","XMUDTOP",253,0)
 ;;TM^TURKMENISTAN
"RTN","XMUDTOP",254,0)
 ;;TN^TUNISIA
"RTN","XMUDTOP",255,0)
 ;;TO^TONGA
"RTN","XMUDTOP",256,0)
 ;;TP^EAST TIMOR
"RTN","XMUDTOP",257,0)
 ;;TR^TURKEY
"RTN","XMUDTOP",258,0)
 ;;TT^TRINIDAD AND TOBAGO
"RTN","XMUDTOP",259,0)
 ;;TV^TUVALU
"RTN","XMUDTOP",260,0)
 ;;TW^TAIWAN
"RTN","XMUDTOP",261,0)
 ;;TZ^TANZANIA
"RTN","XMUDTOP",262,0)
 ;;UA^UKRAINE
"RTN","XMUDTOP",263,0)
 ;;UG^UGANDA
"RTN","XMUDTOP",264,0)
 ;;UK^UNITED KINGDOM
"RTN","XMUDTOP",265,0)
 ;;UM^UNITED STATES MINOR OUTLYING ISLANDS
"RTN","XMUDTOP",266,0)
 ;;US^UNITED STATES
"RTN","XMUDTOP",267,0)
 ;;UY^URUGUAY
"RTN","XMUDTOP",268,0)
 ;;UZ^UZBEKISTAN
"RTN","XMUDTOP",269,0)
 ;;VA^HOLY SEE (VATICAN CITY STATE)
"RTN","XMUDTOP",270,0)
 ;;VC^SAINT VINCENT AND THE GRENADINES
"RTN","XMUDTOP",271,0)
 ;;VE^VENEZUELA
"RTN","XMUDTOP",272,0)
 ;;VG^VIRGIN ISLANDS, BRITISH
"RTN","XMUDTOP",273,0)
 ;;VI^VIRGIN ISLANDS, U.S.
"RTN","XMUDTOP",274,0)
 ;;VN^VIETNAM
"RTN","XMUDTOP",275,0)
 ;;VU^VANUATU
"RTN","XMUDTOP",276,0)
 ;;WF^WALLIS AND FUTUNA ISLANDS
"RTN","XMUDTOP",277,0)
 ;;WS^WESTERN SAMOA
"RTN","XMUDTOP",278,0)
 ;;YE^YEMEN
"RTN","XMUDTOP",279,0)
 ;;YT^MAYOTTE
"RTN","XMUDTOP",280,0)
 ;;YU^YUGOSLAVIA
"RTN","XMUDTOP",281,0)
 ;;ZA^SOUTH AFRICA
"RTN","XMUDTOP",282,0)
 ;;ZM^ZAMBIA
"RTN","XMUDTOP",283,0)
 ;;ZR^ZAIRE
"RTN","XMUDTOP",284,0)
 ;;ZW^ZIMBABWE
"RTN","XMUDTOP",285,0)
 ;;
"RTN","XMUPIN")
0^341^B32693876
"RTN","XMUPIN",1,0)
XMUPIN ;ISC-SF/GMB-IN Basket Purge ;04/11/2002  08:33
"RTN","XMUPIN",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMUPIN",3,0)
 ; Replaces ^XMAI,^XMAI0,^XMAI1 (ISC-WASH/CAP)
"RTN","XMUPIN",4,0)
 ; Entry points used by MailMan options (not covered by DBIA):
"RTN","XMUPIN",5,0)
 ; ENTER  XMMGR-IN-BASKET-PURGE
"RTN","XMUPIN",6,0)
ENTER ;
"RTN","XMUPIN",7,0)
 ; XMIDAYS  If msg hasn't been read for this many days, flag for deletion
"RTN","XMUPIN",8,0)
 ; XMDDAYS  If flagged msg hasn't been read after this many days, delete it
"RTN","XMUPIN",9,0)
 N XMIDAYS,XMDDAYS,XMKALL,XMEXEMPT,XMABORT,XMTEST
"RTN","XMUPIN",10,0)
 D INIT(.XMDUZ,.XMTEST,.XMDDAYS,.XMIDAYS,.XMKALL,.XMABORT) Q:XMABORT
"RTN","XMUPIN",11,0)
 D PROCESS(XMTEST,XMDDAYS,XMIDAYS,XMKALL,.XMEXEMPT)
"RTN","XMUPIN",12,0)
 Q
"RTN","XMUPIN",13,0)
TEST ;
"RTN","XMUPIN",14,0)
 N XMIDAYS,XMDDAYS,XMKALL,XMEXEMPT,XMABORT,XMTEST
"RTN","XMUPIN",15,0)
 S XMTEST=1
"RTN","XMUPIN",16,0)
 D INIT(.XMDUZ,.XMTEST,.XMDDAYS,.XMIDAYS,.XMKALL,.XMABORT) Q:XMABORT
"RTN","XMUPIN",17,0)
 D PROCESS(XMTEST,XMDDAYS,XMIDAYS,XMKALL,.XMEXEMPT)
"RTN","XMUPIN",18,0)
 Q
"RTN","XMUPIN",19,0)
INIT(XMDUZ,XMTEST,XMDDAYS,XMIDAYS,XMKALL,XMABORT) ;
"RTN","XMUPIN",20,0)
 I '$G(DUZ) W $C(7),!!,$$EZBLD^DIALOG(38105) G H^XUS ; You do not have a DUZ.
"RTN","XMUPIN",21,0)
 I '$D(XMDUZ) S XMDUZ=.5
"RTN","XMUPIN",22,0)
 D DT^DICRW ; Set up required FM variables
"RTN","XMUPIN",23,0)
 S:'$D(XMTEST) XMTEST=0
"RTN","XMUPIN",24,0)
 S XMDDAYS=30,XMABORT=0
"RTN","XMUPIN",25,0)
 S XMIDAYS=+$P($G(^XMB(1,1,0)),U,9)
"RTN","XMUPIN",26,0)
 S:'XMIDAYS XMIDAYS=30
"RTN","XMUPIN",27,0)
 S XMKALL=+$P($G(^XMB(1,1,.15)),U)
"RTN","XMUPIN",28,0)
 Q:$D(ZTQUEUED)
"RTN","XMUPIN",29,0)
 N DIR,Y,DIRUT,XMPARM
"RTN","XMUPIN",30,0)
 W !
"RTN","XMUPIN",31,0)
 S XMPARM(1)=XMIDAYS,XMPARM(2)=XMDDAYS
"RTN","XMUPIN",32,0)
 ;This process cleans out old messages from user mailboxes.
"RTN","XMUPIN",33,0)
 ;
"RTN","XMUPIN",34,0)
 ;Fields in the MAILMAN SITE PARAMETERS file 4.3 let you fine-tune:
"RTN","XMUPIN",35,0)
 ; - field 10:    Number of days since the messages have been read
"RTN","XMUPIN",36,0)
 ; - field 10.01: Examine ALL baskets or just the IN basket.
"RTN","XMUPIN",37,0)
 ;
"RTN","XMUPIN",38,0)
 ;Messages that are not 'NEW' and have NOT been READ for |1| days are
"RTN","XMUPIN",39,0)
 ;marked for automatic deletion.  Messages so marked, which have not been
"RTN","XMUPIN",40,0)
 ;read nor saved into another Basket within |2| days, will be deleted
"RTN","XMUPIN",41,0)
 ;automatically from users' mailboxes.
"RTN","XMUPIN",42,0)
 ;
"RTN","XMUPIN",43,0)
 ;Each user will receive a message listing messages that are marked
"RTN","XMUPIN",44,0)
 ;for deletion.  The |2| day grace period allows users to receive
"RTN","XMUPIN",45,0)
 ;this message and have time to prevent messages they want to keep from
"RTN","XMUPIN",46,0)
 ;being deleted from their Mail Baskets.
"RTN","XMUPIN",47,0)
 ;
"RTN","XMUPIN",48,0)
 ;Even then many of the messages may still be recalled via the
"RTN","XMUPIN",49,0)
 ;search process that can be invoked to search for messages that
"RTN","XMUPIN",50,0)
 ;the user is a recipient of.  As long as the 'AUTOPURGE' has not
"RTN","XMUPIN",51,0)
 ;been run or another user has kept a copy, messages can be recovered.
"RTN","XMUPIN",52,0)
 D BLD^DIALOG(36610,.XMPARM,"","XMTEXT","F")
"RTN","XMUPIN",53,0)
 D MSG^DIALOG("WM","","","","XMTEXT")
"RTN","XMUPIN",54,0)
 W ! ;This may take some time.  Do you wish to continue
"RTN","XMUPIN",55,0)
 D BLD^DIALOG(36611,"","","DIR(""A"")")
"RTN","XMUPIN",56,0)
 S DIR(0)="Y",DIR("B")=$$EZBLD^DIALOG(39053) ;No
"RTN","XMUPIN",57,0)
 S DIR("??")="XM-IN-BASKET-PURGE"
"RTN","XMUPIN",58,0)
 D ^DIR I 'Y S XMABORT=1 Q
"RTN","XMUPIN",59,0)
 W !
"RTN","XMUPIN",60,0)
 D BLD^DIALOG($S(XMKALL:36612,1:36613),XMDDAYS,"","XMTEXT","F")
"RTN","XMUPIN",61,0)
 D MSG^DIALOG("WM","","","","XMTEXT")
"RTN","XMUPIN",62,0)
 ;Compiling lists of messages to PURGE in |1| days from *all*/IN baskets
"RTN","XMUPIN",63,0)
 Q
"RTN","XMUPIN",64,0)
PROCESS(XMTEST,XMDDAYS,XMIDAYS,XMKALL,XMEXEMPT) ;
"RTN","XMUPIN",65,0)
 ; XMDDATE  Deletion date for inactive messages (FM format)
"RTN","XMUPIN",66,0)
 ; XMDDATEX Deletion date for inactive messages (external format)
"RTN","XMUPIN",67,0)
 ; XMIDATE  Date beyond which message has had no activity (and thus
"RTN","XMUPIN",68,0)
 ;          becomes candidate for deletion).
"RTN","XMUPIN",69,0)
 ; XMKALL   1=all baskets; 0=IN basket only
"RTN","XMUPIN",70,0)
 ; XMEXEMPT Users exempt from purge (":duz1:duz2:...:duzn:")
"RTN","XMUPIN",71,0)
 N XMDDATE,XMDDATEX,XMIDATE,XMUSER,XMK,XMI,XMLEN,XMLEFT,XMHDR
"RTN","XMUPIN",72,0)
 S XMLEFT=79
"RTN","XMUPIN",73,0)
 S XMLEN("XMZ")=$L($O(^XMB(3.9,":"),-1))+2
"RTN","XMUPIN",74,0)
 S XMLEN("DATE")=$L($$MMDT^XMXUTIL1(DT))
"RTN","XMUPIN",75,0)
 S XMLEFT=XMLEFT-XMLEN("XMZ")-(2*XMLEN("DATE"))-6
"RTN","XMUPIN",76,0)
 S XMLEN("SUBJ")=XMLEFT*2\3
"RTN","XMUPIN",77,0)
 S XMLEN("FROM")=XMLEFT-XMLEN("SUBJ")
"RTN","XMUPIN",78,0)
 S XMHDR(1)=$$LJ^XLFSTR($$EZBLD^DIALOG(34633),XMLEN("XMZ")+1)_$$LJ^XLFSTR($$EZBLD^DIALOG(34632),XMLEN("DATE")+1)_$$LJ^XLFSTR($$EZBLD^DIALOG(34002),XMLEN("SUBJ")+2) ;Msg ID / Date / Subject
"RTN","XMUPIN",79,0)
 S XMHDR(1)=XMHDR(1)_$$LJ^XLFSTR($$EZBLD^DIALOG(34006),XMLEN("FROM")+2)_$$EZBLD^DIALOG(36614) ;From  / Last Read
"RTN","XMUPIN",80,0)
 S XMHDR(2)=$$REPEAT^XLFSTR("-",XMLEN("XMZ"))_" "_$$REPEAT^XLFSTR("-",XMLEN("DATE"))_" "_$$REPEAT^XLFSTR("-",XMLEN("SUBJ"))_"  "_$$REPEAT^XLFSTR("-",XMLEN("FROM"))_"  "_$$REPEAT^XLFSTR("-",XMLEN("DATE"))
"RTN","XMUPIN",81,0)
 S XMDDATE=$$FMADD^XLFDT(DT,30)
"RTN","XMUPIN",82,0)
 S XMDDATEX=$$MMDT^XMXUTIL1(XMDDATE)
"RTN","XMUPIN",83,0)
 S XMIDATE=$$FMADD^XLFDT(DT,-XMIDAYS)
"RTN","XMUPIN",84,0)
 S XMUSER=.999
"RTN","XMUPIN",85,0)
 K ^TMP("XM",$J)
"RTN","XMUPIN",86,0)
 F  S XMUSER=$O(^XMB(3.7,XMUSER)) Q:XMUSER'>0  D
"RTN","XMUPIN",87,0)
 . Q:$G(XMEXEMPT)[(":"_XMUSER_":")
"RTN","XMUPIN",88,0)
 . S XMI=0
"RTN","XMUPIN",89,0)
 . I XMKALL D
"RTN","XMUPIN",90,0)
 . . S XMK=.99
"RTN","XMUPIN",91,0)
 . . F  S XMK=$O(^XMB(3.7,XMUSER,2,XMK)) Q:XMK'>0  D BASKET(XMTEST,XMK,$P($G(^(XMK,0),"NO NAME"),U),XMIDATE,XMDDATE,.XMLEN,.XMHDR,.XMI)
"RTN","XMUPIN",92,0)
 . E  D BASKET(XMTEST,1,$$EZBLD^DIALOG(37005),XMIDATE,XMDDATE,.XMLEN,.XMHDR,.XMI) ;IN
"RTN","XMUPIN",93,0)
 . Q:'$D(^TMP("XM",$J))
"RTN","XMUPIN",94,0)
 . D SENDMSG(XMTEST,XMKALL,XMIDAYS,XMDDATEX,XMUSER)
"RTN","XMUPIN",95,0)
 . K ^TMP("XM",$J)
"RTN","XMUPIN",96,0)
 Q
"RTN","XMUPIN",97,0)
BASKET(XMTEST,XMK,XMKN,XMIDATE,XMDDATE,XMLEN,XMHDR,XMI) ; Process Basket
"RTN","XMUPIN",98,0)
 N XMZ,XMZDATE,XMREC,XMZREC,XMFDA,XMIENS,XMFIRST,XMIREC
"RTN","XMUPIN",99,0)
 S XMZ=0,XMFIRST=1
"RTN","XMUPIN",100,0)
 F  S XMZ=$O(^XMB(3.7,XMUSER,2,XMK,1,XMZ)) Q:XMZ'>0  S XMREC=$G(^(XMZ,0)) D
"RTN","XMUPIN",101,0)
 . ; Quit if no data OR new msg OR already scheduled for deletion
"RTN","XMUPIN",102,0)
 . ; OR activity after the cutoff date
"RTN","XMUPIN",103,0)
 . Q:XMREC=""!$P(XMREC,U,3)!$P(XMREC,U,5)!($P(XMREC,U,4)>XMIDATE)
"RTN","XMUPIN",104,0)
 . S XMZREC=$G(^XMB(3.9,XMZ,0))
"RTN","XMUPIN",105,0)
 . S XMZDATE=$P(XMZREC,U,3)
"RTN","XMUPIN",106,0)
 . S:XMZDATE'?7N1".".N XMZDATE=$$CONVERT^XMXUTIL1(XMZDATE)
"RTN","XMUPIN",107,0)
 . I $P(XMREC,U,4)="" Q:XMZDATE>XMIDATE
"RTN","XMUPIN",108,0)
 . I 'XMTEST D  ; Mark message w/delete date ("AC" x-ref created by trigger)
"RTN","XMUPIN",109,0)
 . . S XMIENS=XMZ_","_XMK_","_XMUSER_","
"RTN","XMUPIN",110,0)
 . . S XMFDA(3.702,XMIENS,5)=XMDDATE
"RTN","XMUPIN",111,0)
 . . S XMFDA(3.702,XMIENS,7)=1
"RTN","XMUPIN",112,0)
 . . D FILE^DIE("","XMFDA")
"RTN","XMUPIN",113,0)
 . I XMFIRST D
"RTN","XMUPIN",114,0)
 . . S XMFIRST=0
"RTN","XMUPIN",115,0)
 . . S XMI=XMI+1,^TMP("XM",$J,XMI)=""
"RTN","XMUPIN",116,0)
 . . S XMI=XMI+1,^TMP("XM",$J,XMI)=$$EZBLD^DIALOG(34656,XMKN) ;Basket: |1|
"RTN","XMUPIN",117,0)
 . . S XMI=XMI+1,^TMP("XM",$J,XMI)=""
"RTN","XMUPIN",118,0)
 . . S XMI=XMI+1,^TMP("XM",$J,XMI)=XMHDR(1)
"RTN","XMUPIN",119,0)
 . . S XMI=XMI+1,^TMP("XM",$J,XMI)=XMHDR(2)
"RTN","XMUPIN",120,0)
 . S XMIREC=$J("["_XMZ_"]",XMLEN("XMZ"))_" "_$E($$MMDT^XMXUTIL1(XMZDATE),1,XMLEN("DATE"))_" "_$$LJ^XLFSTR($E($$SUBJ^XMXUTIL2(XMZREC),1,XMLEN("SUBJ")),XMLEN("SUBJ"))
"RTN","XMUPIN",121,0)
 . S XMIREC=XMIREC_"  "_$$LJ^XLFSTR($E($$NAME^XMXUTIL($P(XMZREC,U,2)),1,XMLEN("FROM")),XMLEN("FROM"))_"  "_$$MMDT^XMXUTIL1($P($P(XMREC,U,4),".",1))
"RTN","XMUPIN",122,0)
 . S XMI=XMI+1,^TMP("XM",$J,XMI)=XMIREC
"RTN","XMUPIN",123,0)
 Q
"RTN","XMUPIN",124,0)
SENDMSG(XMTEST,XMKALL,XMIDAYS,XMDDATEX,XMTO) ; Send a message to the user
"RTN","XMUPIN",125,0)
 N XMINSTR,XMPARM,XMBULL
"RTN","XMUPIN",126,0)
 S XMINSTR("FLAGS")="I" ; Info only
"RTN","XMUPIN",127,0)
 S XMINSTR("FROM")=.5
"RTN","XMUPIN",128,0)
 S XMPARM(1)=XMIDAYS,XMPARM(2)=XMDDATEX
"RTN","XMUPIN",129,0)
 S XMBULL=$S(XMTEST:"XM IN BASKET PURGE REQUEST",1:"XM IN BASKET PURGE WARNING")
"RTN","XMUPIN",130,0)
 D TASKBULL^XMXBULL(.5,XMBULL,.XMPARM,"^TMP(""XM"",$J)",XMTO,.XMINSTR)
"RTN","XMUPIN",131,0)
 Q
"RTN","XMUT1")
0^80^B8182432
"RTN","XMUT1",1,0)
XMUT1 ;(WASH ISC)/CAP-Recover msgs for a user ;04/17/2002  11:49
"RTN","XMUT1",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMUT1",3,0)
 ; Entry points used by MailMan options (not covered by DBIA):
"RTN","XMUT1",4,0)
 ; A   XMUT-REC-FIND
"RTN","XMUT1",5,0)
 ; G   XMUT-REC-DELIVER
"RTN","XMUT1",6,0)
 Q
"RTN","XMUT1",7,0)
A ;
"RTN","XMUT1",8,0)
 W !!,"WE WILL FIND THE MESSAGES AND STORE THEM IN ^TMP('XMUT1'..."
"RTN","XMUT1",9,0)
 W !,"LATER WE WILL LOAD THEM INTO PERSON'S MAILBOX.",!!
"RTN","XMUT1",10,0)
 W !!,"This routine recovers 'ALL' messages that the user has not been"
"RTN","XMUT1",11,0)
 W !,"terminated from.  It will not recover some messages that were"
"RTN","XMUT1",12,0)
 W !,"sent after reinstatement if the user previously lost Mail-Baskets."
"RTN","XMUT1",13,0)
 S DIR(0)="Y",DIR("B")="N",DIR("A")="THIS MAY TAKE A LONG TIME.... DO YOU WISH TO CONTINUE" D ^DIR K DIR,DIRUT G EXIT:"yY"'[$E(X)!(X="")
"RTN","XMUT1",14,0)
 S XMA0=^DD("DD")
"RTN","XMUT1",15,0)
B S DIC("A")="Enter the USER for whom you wish to recover messages: "
"RTN","XMUT1",16,0)
 S DIC="^VA(200,",DIC(0)="AEQZM" D ^DIC
"RTN","XMUT1",17,0)
 K DIC I "^"[$E(X) G EXIT
"RTN","XMUT1",18,0)
 I Y<1 W !,"Enter '^' to abort or a Valid User who has a Mailbox." G B
"RTN","XMUT1",19,0)
 I '$D(^XMB(3.7,+Y,2,1,0)) W $C(7),"You cannot recover messages for this user (no Mailbox)." G B
"RTN","XMUT1",20,0)
 S XMC0=+Y,XMB0=Y(0) K Y
"RTN","XMUT1",21,0)
 S DIR(0)="Y",DIR("B")="NO",DIR("A")="DO YOU MEAN '"_$P(XMB0,"^")_"' "
"RTN","XMUT1",22,0)
 D ^DIR K DIR,DIRUT I "Yy"'[$E(X)!(X="") G B
"RTN","XMUT1",23,0)
 S (F,A,G)=0,D=XMC0 K XMC0
"RTN","XMUT1",24,0)
 W !!,"*=100 MESSAGES PROCESSED",!!
"RTN","XMUT1",25,0)
L S A=$O(^XMB(3.7,"M",A)) G Q:'A,L:$D(^(A,D)) S G=G+1 W:G#100=0 "*" S E=$O(^XMB(3.9,A,1,"C",D,0)) G L:'E,L:$D(^XMB(3.9,A,1,E,"D"))
"RTN","XMUT1",26,0)
 S F=F+1,X=^XMB(3.9,A,0),^TMP("XMUT1",D,A)=X W !,$P(X,"^"),!
"RTN","XMUT1",27,0)
 G L
"RTN","XMUT1",28,0)
Q W !!,G," MESSAGES PROCESSED, ",F," MESSAGES FOUND"
"RTN","XMUT1",29,0)
 K %1,A,D,E,F,G,X,XMA0,XMB0,Y,Z,%,%H,%DT
"RTN","XMUT1",30,0)
 Q
"RTN","XMUT1",31,0)
QQ S (A,G,F)=0,C=1,XMA0=^DD("DD") H 3600 D L G H^XUS
"RTN","XMUT1",32,0)
 ;
"RTN","XMUT1",33,0)
G ;LOAD DOCUMENTS FOUND INTO USER'S 'IN' BOX
"RTN","XMUT1",34,0)
 S (J,C,F)="" W !!,"CHOOSE FROM:",!
"RTN","XMUT1",35,0)
 F I=0:0 S I=$O(^TMP("XMUT1",I)) Q:'I  I $D(^VA(200,I,0)) W !,$J(I,8),"   ",$$NAME^XMXUTIL(I) I 'J S J=I
"RTN","XMUT1",36,0)
 I 'J W !!!,"NONE RECOVERED FOR ANYBODY !!!" K C,F,I,J,X Q
"RTN","XMUT1",37,0)
F W !!,"WHICH ONE: ",J,"// " R X:DTIME I X="" S X=J
"RTN","XMUT1",38,0)
 G E:"^"[$E(X) I X="?" D H1^XMUT1A G F
"RTN","XMUT1",39,0)
 I X="??" G G
"RTN","XMUT1",40,0)
 S D=X I '$D(^TMP("XMUT1",D)) W "   << NOT ON LIST !!!",$C(7) G G
"RTN","XMUT1",41,0)
 W !!,"RECOVERING MESSAGES ('+'=RECOVERED, '.'=MESSAGE PROCESSED)",!!
"RTN","XMUT1",42,0)
 S D=X,(C,F)=0
"RTN","XMUT1",43,0)
P S A=$O(^TMP("XMUT1",D,0)) G QQQ:'A W "." I $X>77 W !
"RTN","XMUT1",44,0)
 S C=C+1 W "+" G T:$D(^XMB(3.7,"M",A,D)),T:'$D(^XMB(3.9,A))
"RTN","XMUT1",45,0)
 S F=F+1
"RTN","XMUT1",46,0)
 L +^XMB(3.7,D)
"RTN","XMUT1",47,0)
 D PUTMSG^XMXMSGS2(D,1,"IN",A)
"RTN","XMUT1",48,0)
 L -^XMB(3.7,D)
"RTN","XMUT1",49,0)
T K ^TMP("XMUT1",D,A) G P
"RTN","XMUT1",50,0)
QQQ W !!,C," POTENTIAL ENTRIES PROCESSED.  ",F," MESSAGES RECOVERED.",!!
"RTN","XMUT1",51,0)
E K %,%1,A,C,D,F,I,J,Y,Z,%H
"RTN","XMUT1",52,0)
 Q
"RTN","XMUT1",53,0)
EXIT K X1,X2
"RTN","XMUT1",54,0)
 Q
"RTN","XMUT1",55,0)
 ;
"RTN","XMUT1",56,0)
 ;LIST MESSAGES IN MAILBOXES OF DUZ
"RTN","XMUT1",57,0)
M G MBOX^XMJBL
"RTN","XMUT1",58,0)
 Q
"RTN","XMUT1A")
0^81^B9388357
"RTN","XMUT1A",1,0)
XMUT1A ;(WASH ISC)/CAP-Recover msgs for a user (cont.) ;04/17/2002  11:50
"RTN","XMUT1A",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMUT1A",3,0)
 ; Entry points used by MailMan options (not covered by DBIA):
"RTN","XMUT1A",4,0)
 ; DEL      XMUT-REC-DELETE
"RTN","XMUT1A",5,0)
 ; LIST     XMUT-REC-RPT
"RTN","XMUT1A",6,0)
NOKL G FX:$D(^DOPT("XMUT1",1)) S DIK="^DOPT(""XMUT1"","
"RTN","XMUT1A",7,0)
GO S ^DOPT("XMUT1",0)="Recover Messages Function^1N^"
"RTN","XMUT1A",8,0)
 F I=1:1 S X=$E($T(TABLE+I),4,99) Q:X=""  S ^DOPT("XMUT1",I,0)=X
"RTN","XMUT1A",9,0)
 D IXALL^DIK
"RTN","XMUT1A",10,0)
FX S DIC="^DOPT(""XMUT1"",",DIC(0)="AEQZ" D ^DIC K DIC Q:Y<0
"RTN","XMUT1A",11,0)
 S X=$P(Y(0),U,2,99) K DD,DO,Y D @X
"RTN","XMUT1A",12,0)
 D ^%ZISC
"RTN","XMUT1A",13,0)
 W ! K DIE,DIF G FX
"RTN","XMUT1A",14,0)
TABLE ;;;DESCRIPTION^PROGRAM OR TAG^PROGRAM
"RTN","XMUT1A",15,0)
 ;;FIND MESSAGES FOR USER^A^XMUT1
"RTN","XMUT1A",16,0)
 ;;LIST MESSAGES IN USER'S BASKETS^M^XMUT1
"RTN","XMUT1A",17,0)
 ;;LOAD MESSAGES INTO IN-BASKET^G^XMUT1
"RTN","XMUT1A",18,0)
 ;;LIST MESSAGES FOUND^LIST^XMUT1A
"RTN","XMUT1A",19,0)
 ;;DELETE LIST OF RECOVERED MESSAGES FROM THE UTILITY GLOBAL^DEL^XMUT1A
"RTN","XMUT1A",20,0)
 ;;
"RTN","XMUT1A",21,0)
LIST ;LIST MESSAGES FOUND
"RTN","XMUT1A",22,0)
 N J,C,F,I,X,XME0
"RTN","XMUT1A",23,0)
 S (J,C,F)="" W !!,"CHOOSE FROM:",!
"RTN","XMUT1A",24,0)
 F I=0:0 S I=$O(^TMP("XMUT1",I)) Q:'I  I $D(^VA(200,I,0)) W !,$J(I,8),"   ",$$NAME^XMXUTIL(I) I 'J S J=I
"RTN","XMUT1A",25,0)
 I 'J G NO
"RTN","XMUT1A",26,0)
L W !!,"WHICH ONE: ",J,"//" R X:DTIME I X="" S X=J
"RTN","XMUT1A",27,0)
 Q:"^"[$E(X)  I X="?" D H1 G L
"RTN","XMUT1A",28,0)
 I X="??" G LIST
"RTN","XMUT1A",29,0)
 I '$D(^TMP("XMUT1",X)) D H1 G LIST
"RTN","XMUT1A",30,0)
 S XME0=X,ZTSAVE("XME0")=""
"RTN","XMUT1A",31,0)
 D EN^XUTMDEVQ("ZTSK^XMUT1A","MailMan List Messages Found (XMUT-REC-RPT)",.ZTSAVE)
"RTN","XMUT1A",32,0)
 Q
"RTN","XMUT1A",33,0)
ZTSK ;
"RTN","XMUT1A",34,0)
 D NOW^%DTC S Y=%,XMF0=^DD("DD") K %,%I,%H X XMF0
"RTN","XMUT1A",35,0)
 S XMC0=0,XMB0=0 S XMA0=$$NAME^XMXUTIL(XME0)_" - "_Y D H
"RTN","XMUT1A",36,0)
N S XMC0=$O(^TMP("XMUT1",XME0,XMC0)) G NQ:'XMC0
"RTN","XMUT1A",37,0)
 S I=$G(^XMB(3.9,XMC0,0))
"RTN","XMUT1A",38,0)
 I I="" W !!,"Message removed from list - no longer in 3.9 file.",! K ^TMP("XMUT1",XME0,XMC0) G N
"RTN","XMUT1A",39,0)
 S XMD0=XMD0+1,Y=$P(I,"^",3) I Y?7N!(Y?7N1"."1N.N) X XMF0
"RTN","XMUT1A",40,0)
 W !?2,Y,?22,$P(I,"^")
"RTN","XMUT1A",41,0)
 G N:IOSL-6>XMD0 I $E(IOST,1,2)'="C-" D H G N
"RTN","XMUT1A",42,0)
 I '$D(ZTQUEUED) U IO(0) K DIR S DIR(0)="E" D ^DIR K DIR,DIRUT G NQ:X["^" U IO
"RTN","XMUT1A",43,0)
 D H G N
"RTN","XMUT1A",44,0)
H S XMB0=XMB0+1,XMD0=5
"RTN","XMUT1A",45,0)
 W @IOF,!,"CONTENTS OF MAILBOXES FOR ",XMA0,?60,"PAGE: ",XMB0,!!
"RTN","XMUT1A",46,0)
 W "  DATE@TIME",?22,"SUBJECT",!!
"RTN","XMUT1A",47,0)
 Q
"RTN","XMUT1A",48,0)
NQ K XMA0,XMB0,XMD0,XMC0,XME0,XMF0
"RTN","XMUT1A",49,0)
 I $D(ZTQUEUED) W @IOF K ZTSK S ZTREQ="@" Q
"RTN","XMUT1A",50,0)
 D ^%ZISC
"RTN","XMUT1A",51,0)
 Q
"RTN","XMUT1A",52,0)
 ;
"RTN","XMUT1A",53,0)
DEL ;DELETE LIST FROM ^TMP("XMUT1"...
"RTN","XMUT1A",54,0)
 S (J,C,F)="" W !!,"CHOOSE FROM:",!
"RTN","XMUT1A",55,0)
 F I=0:0 S I=$O(^TMP("XMUT1",I)) Q:'I  I $D(^VA(200,I,0)) W !,$J(I,8),"   ",$$NAME^XMXUTIL(I) I 'J S J=I
"RTN","XMUT1A",56,0)
 I 'J G NO
"RTN","XMUT1A",57,0)
D W !!,"WHICH ONE ",J,"//" R X:DTIME I X="" S X=J
"RTN","XMUT1A",58,0)
 Q:"^"[$E(X)  I X="?" D H1 G D
"RTN","XMUT1A",59,0)
 I X="??" D H1 G DEL
"RTN","XMUT1A",60,0)
 I '$D(^TMP("XMUT1",X)) D H1 G DEL
"RTN","XMUT1A",61,0)
 S XME0=X,XMB0=$G(^VA(200,XME0,0))
"RTN","XMUT1A",62,0)
 I XMB0="" W !,"  NO SUCH USER !!!",$C(7) G DQ
"RTN","XMUT1A",63,0)
 S DIR(0)="Y",DIR("B")="NO",DIR("A")="DO YOU MEAN '"_$$NAME^XMXUTIL(XME0)_"' "
"RTN","XMUT1A",64,0)
 D ^DIR K DIR,DIRUT Q:"^"[X!("yY"'[X)
"RTN","XMUT1A",65,0)
DQ K ^TMP("XMUT1",XME0) W "  << DELETED !!!" K XME0 Q
"RTN","XMUT1A",66,0)
H1 W !!,"Choose NUMBER from list.  Or enter '??' for a list.",!,$C(7) Q
"RTN","XMUT1A",67,0)
NO W !!!,"NO MESSAGES RECOVERED FOR ANYBODY !!!" Q
"RTN","XMUT1B")
1^235
"RTN","XMUT2")
0^342^B15678954
"RTN","XMUT2",1,0)
XMUT2 ;(WASH ISC)/CAP-Large Msg Report ;04/19/2002  12:55
"RTN","XMUT2",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMUT2",3,0)
 ; Entry points used by MailMan options (not covered by DBIA):
"RTN","XMUT2",4,0)
 ; ENTER    XMMGR-LARGE-MESSAGE-REPORT
"RTN","XMUT2",5,0)
ENTER ;
"RTN","XMUT2",6,0)
 N XMABORT,XML,XMD,I,XMSAVE
"RTN","XMUT2",7,0)
 S XMABORT=0
"RTN","XMUT2",8,0)
 D INIT(.XML,.XMD,.XMABORT) Q:XMABORT
"RTN","XMUT2",9,0)
 I $D(ZTQUEUED) D PROCESS(XML,XMD) Q
"RTN","XMUT2",10,0)
 F I="XML","XMD" S XMSAVE(I)=""
"RTN","XMUT2",11,0)
 D EN^XUTMDEVQ("PROC^XMUT2",$$EZBLD^DIALOG(36200),.XMSAVE) ; MailMan: Large Message Report
"RTN","XMUT2",12,0)
 Q
"RTN","XMUT2",13,0)
INIT(XML,XMD,XMABORT) ;
"RTN","XMUT2",14,0)
 S XML=$G(^XMB(1,1,"XMUT2-LINES")) I 'XML S XML=100
"RTN","XMUT2",15,0)
 S XMD=$O(^XMB(3.9,"C",""))
"RTN","XMUT2",16,0)
 Q:$D(ZTQUEUED)
"RTN","XMUT2",17,0)
 W !,$$EZBLD^DIALOG(36201),! ; This report lists messages longer than a certain number of lines.
"RTN","XMUT2",18,0)
 D MINLINES(.XML,.XMABORT) Q:XMABORT
"RTN","XMUT2",19,0)
 D STARTDT(.XMD,.XMABORT) Q:XMABORT
"RTN","XMUT2",20,0)
 Q
"RTN","XMUT2",21,0)
MINLINES(XML,XMABORT) ;
"RTN","XMUT2",22,0)
 N DIR,X,Y,DA
"RTN","XMUT2",23,0)
 ;Report on messages longer than this many lines
"RTN","XMUT2",24,0)
 D BLD^DIALOG(36203,"","","DIR(""A"")")
"RTN","XMUT2",25,0)
 S DIR(0)="4.3,8.14",DA=1
"RTN","XMUT2",26,0)
 D ^DIR I $D(DIRUT) S XMABORT=1 Q
"RTN","XMUT2",27,0)
 Q:Y=XML
"RTN","XMUT2",28,0)
 S XML=Y
"RTN","XMUT2",29,0)
 K DIR,X,Y,DA
"RTN","XMUT2",30,0)
 ;Make this the default for future reports
"RTN","XMUT2",31,0)
 D BLD^DIALOG(36204,"","","DIR(""A"")")
"RTN","XMUT2",32,0)
 S DIR("B")=$$EZBLD^DIALOG(39054) ; Yes
"RTN","XMUT2",33,0)
 S DIR(0)="Y"
"RTN","XMUT2",34,0)
 D ^DIR I $D(DIRUT) S XMABORT=1 Q
"RTN","XMUT2",35,0)
 Q:'Y
"RTN","XMUT2",36,0)
 S $P(^XMB(1,1,"XMUT2-LINES"),U)=XML
"RTN","XMUT2",37,0)
 Q
"RTN","XMUT2",38,0)
STARTDT(XMD,XMABORT) ;
"RTN","XMUT2",39,0)
 N DIR,X
"RTN","XMUT2",40,0)
 ;The default starting date is the date of the oldest message.
"RTN","XMUT2",41,0)
 ;Enter the start date
"RTN","XMUT2",42,0)
 W !
"RTN","XMUT2",43,0)
 D BLD^DIALOG(36202,"","","DIR(""A"")")
"RTN","XMUT2",44,0)
 S DIR("B")=$$FMTE^XLFDT(XMD,5)
"RTN","XMUT2",45,0)
 S DIR(0)="D^"_XMD_":"_DT_";EP"
"RTN","XMUT2",46,0)
 D ^DIR I $D(DIRUT) S XMABORT=1
"RTN","XMUT2",47,0)
 S XMD=Y
"RTN","XMUT2",48,0)
 Q
"RTN","XMUT2",49,0)
PROCESS(XML,XMD) ;
"RTN","XMUT2",50,0)
PROC ;
"RTN","XMUT2",51,0)
 N XMABORT,XMPAGE,XMCNT,XMDATE,XMREC,XMLINES,XMLEN,XMZ,XMLEFT
"RTN","XMUT2",52,0)
 S XMLEN("XMZ")=$$MAX^XLFMTH($L($O(^XMB(3.9,"A"),-1)),$L($$EZBLD^DIALOG(34633))) ;Msg ID
"RTN","XMUT2",53,0)
 S XMLEN("LINE")=$$MAX^XLFMTH(7,$L($$EZBLD^DIALOG(34003.1))+1) ;Lines
"RTN","XMUT2",54,0)
 S XMLEN("RCPT")=$$MAX^XLFMTH(6,$L($$EZBLD^DIALOG(36207))+1) ;Rcpts
"RTN","XMUT2",55,0)
 S XMLEFT=75-XMLEN("XMZ")-XMLEN("LINE")-XMLEN("RCPT")
"RTN","XMUT2",56,0)
 S XMLEN("FROM")=XMLEFT\2
"RTN","XMUT2",57,0)
 S XMLEN("SUBJ")=XMLEFT-XMLEN("FROM")
"RTN","XMUT2",58,0)
 S (XMABORT,XMCNT,XMPAGE)=0
"RTN","XMUT2",59,0)
 S XMDATE=$$FMTE^XLFDT(DT,5)
"RTN","XMUT2",60,0)
 W:IOST["C-" @IOF
"RTN","XMUT2",61,0)
 D HDR
"RTN","XMUT2",62,0)
 S XMD=XMD-.1
"RTN","XMUT2",63,0)
 S XMZ=""
"RTN","XMUT2",64,0)
 F  S XMD=$O(^XMB(3.9,"C",XMD)) Q:XMD=""  D  Q:XMABORT
"RTN","XMUT2",65,0)
 . F  S XMZ=$O(^XMB(3.9,"C",XMD,XMZ)) Q:XMZ=""  D  Q:XMABORT
"RTN","XMUT2",66,0)
 . . S XMCNT=XMCNT+1
"RTN","XMUT2",67,0)
 . . S XMLINES=+$P($G(^XMB(3.9,XMZ,2,0)),U,4)
"RTN","XMUT2",68,0)
 . . I IOST["C-",XMCNT#1000=0 W:$X>50 ! W "."
"RTN","XMUT2",69,0)
 . . Q:XMLINES'>XML
"RTN","XMUT2",70,0)
 . . S XMREC=$G(^XMB(3.9,XMZ,0))
"RTN","XMUT2",71,0)
 . . Q:$P(XMREC,U)?1"R"1N.N
"RTN","XMUT2",72,0)
 . . S XMRECIPS=+$P($G(^XMB(3.9,XMZ,1,0)),U,4)
"RTN","XMUT2",73,0)
 . . I $Y+3>IOSL D PAGE(.XMABORT) Q:XMABORT
"RTN","XMUT2",74,0)
 . . W !,$J(XMZ,XMLEN("XMZ")),$J(XMLINES,XMLEN("LINE")),$J(XMRECIPS,XMLEN("RCPT")),"  "
"RTN","XMUT2",75,0)
 . . W $$LJ^XLFSTR($E($$NAME^XMXUTIL($P(XMREC,U,2)),1,XMLEN("FROM")),XMLEN("FROM")),"  ",$$LJ^XLFSTR($E($$SUBJ^XMXUTIL2(XMREC),1,XMLEN("SUBJ")),XMLEN("SUBJ"))
"RTN","XMUT2",76,0)
 Q:XMABORT
"RTN","XMUT2",77,0)
 I IOST["C-" D WAIT^XMXUTIL
"RTN","XMUT2",78,0)
 I $D(ZTQUEUED) S ZTREQ="@"
"RTN","XMUT2",79,0)
 Q
"RTN","XMUT2",80,0)
PAGE(XMABORT) ;
"RTN","XMUT2",81,0)
 I IOST["C-" D PAGE^XMXUTIL(.XMABORT) Q:XMABORT
"RTN","XMUT2",82,0)
 W @IOF
"RTN","XMUT2",83,0)
 D HDR
"RTN","XMUT2",84,0)
 Q
"RTN","XMUT2",85,0)
HDR ;
"RTN","XMUT2",86,0)
 S XMPAGE=XMPAGE+1
"RTN","XMUT2",87,0)
 ;Messages with more than _XML_ lines,?50,Report date: _XMDATE_  _Page
"RTN","XMUT2",88,0)
 W $$EZBLD^DIALOG(36205,XML),?50,$$EZBLD^DIALOG(36206,XMDATE),"  ",$$EZBLD^DIALOG(34542,XMPAGE)
"RTN","XMUT2",89,0)
 ; Msg ID / Lines / Rcpts / From / Subject
"RTN","XMUT2",90,0)
 W !!,$J($$EZBLD^DIALOG(34633),XMLEN("XMZ")),$J($$EZBLD^DIALOG(34003.1),XMLEN("LINE")),$J($$EZBLD^DIALOG(36207),XMLEN("RCPT")),"  ",$$LJ^XLFSTR($$EZBLD^DIALOG(34006),XMLEN("FROM")),"  ",$$EZBLD^DIALOG(34002),!
"RTN","XMUT2",91,0)
 Q
"RTN","XMUT2",92,0)
ENT ;
"RTN","XMUT2",93,0)
 N XML,XMD
"RTN","XMUT2",94,0)
 S XML=1000,XMD=0
"RTN","XMUT2",95,0)
 F I="XML","XMD" S XMSAVE(I)=""
"RTN","XMUT2",96,0)
 D EN^XUTMDEVQ("PROC^XMUT2",$$EZBLD^DIALOG(36200),.XMSAVE) ; MailMan: Large Message Report
"RTN","XMUT2",97,0)
 Q
"RTN","XMUT4")
0^343^B63689784
"RTN","XMUT4",1,0)
XMUT4 ;ISC-SF/GMB-Integrity Checker for files 3.7, 3.9 ;07/15/2002  07:25
"RTN","XMUT4",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMUT4",3,0)
 ; Was (WASH ISC)/CAP
"RTN","XMUT4",4,0)
 ;
"RTN","XMUT4",5,0)
 ; Entry points used by MailMan options (not covered by DBIA):
"RTN","XMUT4",6,0)
 ; CHKFILES   XMUT-CHKFIL
"RTN","XMUT4",7,0)
 Q
"RTN","XMUT4",8,0)
CHKFILES ;
"RTN","XMUT4",9,0)
 I $D(ZTQUEUED) D PROCESS Q
"RTN","XMUT4",10,0)
 N XMABORT
"RTN","XMUT4",11,0)
 S XMABORT=0
"RTN","XMUT4",12,0)
 D WARNING^XMUT41(.XMABORT) Q:XMABORT
"RTN","XMUT4",13,0)
 D EN^XUTMDEVQ("PROCESS^XMUT4",$$EZBLD^DIALOG(36080)) ; MailMan: Global Integrity Checker
"RTN","XMUT4",14,0)
 Q
"RTN","XMUT4",15,0)
PROCESS ;
"RTN","XMUT4",16,0)
 I $D(ZTQUEUED) S ZTREQ="@"
"RTN","XMUT4",17,0)
 N XMABORT
"RTN","XMUT4",18,0)
 S XMABORT=0
"RTN","XMUT4",19,0)
 D MAILBOX(.XMABORT)
"RTN","XMUT4",20,0)
 D:'XMABORT MESSAGE^XMUT4C(.XMABORT)
"RTN","XMUT4",21,0)
 D SUMMARY^XMUT41(XMABORT)
"RTN","XMUT4",22,0)
 Q
"RTN","XMUT4",23,0)
MAILBOX(XMABORT) ;
"RTN","XMUT4",24,0)
 W:'$D(ZTQUEUED) !!,$$EZBLD^DIALOG(36081) ; Checking MAILBOX file 3.7
"RTN","XMUT4",25,0)
 D USERS(.XMABORT) Q:XMABORT
"RTN","XMUT4",26,0)
 D MXREF^XMUT41(.XMABORT) Q:XMABORT
"RTN","XMUT4",27,0)
 D POSTBSKT^XMUT41
"RTN","XMUT4",28,0)
 Q
"RTN","XMUT4",29,0)
USERS(XMABORT) ;
"RTN","XMUT4",30,0)
 ; XMUCNT   # users
"RTN","XMUT4",31,0)
 ; XMUKCNT  # bskts for a particular user
"RTN","XMUT4",32,0)
 ; XMUECNT  # msg entries for a particular user
"RTN","XMUT4",33,0)
 ; XMKCNT   # bskts
"RTN","XMUT4",34,0)
 ; XMECNT   # msg entries
"RTN","XMUT4",35,0)
 N XMUSER,XMECNT,XMUCNT,XMKCNT,XMUKCNT,XMUECNT
"RTN","XMUT4",36,0)
 W:'$D(ZTQUEUED) !!,$$EZBLD^DIALOG(36082),! ; Checking each user mailbox
"RTN","XMUT4",37,0)
 S (XMUSER,XMECNT,XMUCNT,XMKCNT)=0
"RTN","XMUT4",38,0)
 F  S XMUSER=$O(^XMB(3.7,XMUSER)) Q:XMUSER'>0  D  Q:XMABORT
"RTN","XMUT4",39,0)
 . S XMUCNT=XMUCNT+1 I XMUCNT#20=0 D  Q:XMABORT
"RTN","XMUT4",40,0)
 . . I '$D(ZTQUEUED) W:$X>40 ! W XMUCNT,"." Q
"RTN","XMUT4",41,0)
 . . I $$S^%ZTLOAD S (XMABORT,ZTSTOP)=1 ; User asked the task to stop
"RTN","XMUT4",42,0)
 . D USER(XMUSER,.XMUKCNT,.XMUECNT)
"RTN","XMUT4",43,0)
 . S XMKCNT=XMKCNT+XMUKCNT
"RTN","XMUT4",44,0)
 . S XMECNT=XMECNT+XMUECNT
"RTN","XMUT4",45,0)
 Q:XMABORT
"RTN","XMUT4",46,0)
 I '$D(ZTQUEUED) D
"RTN","XMUT4",47,0)
 . N XMPARM,XMTEXT
"RTN","XMUT4",48,0)
 . S XMPARM(1)=XMUCNT,XMPARM(2)=XMKCNT,XMPARM(3)=XMECNT
"RTN","XMUT4",49,0)
 . W !
"RTN","XMUT4",50,0)
 . D BLD^DIALOG(36083,.XMPARM,"","XMTEXT","F")
"RTN","XMUT4",51,0)
 . D MSG^DIALOG("WM","","","","XMTEXT")
"RTN","XMUT4",52,0)
 . ;|1| Users, |2| Baskets, |3| Msg Entries"
"RTN","XMUT4",53,0)
 I $D(^XMB(3.7,0)) S:$P(^XMB(3.7,0),U,4)'=XMUCNT $P(^(0),U,4)=XMUCNT Q
"RTN","XMUT4",54,0)
 S ^XMB(3.7,0)="MAILBOX^3.7P^3^"_XMUCNT
"RTN","XMUT4",55,0)
 Q
"RTN","XMUT4",56,0)
USER(XMUSER,XMUKCNT,XMUECNT) ;
"RTN","XMUT4",57,0)
 ; XMUNCNT  # new msgs for a user
"RTN","XMUT4",58,0)
 ; XMUKECNT # msgs in a user's bskt
"RTN","XMUT4",59,0)
 ; XMUKNCNT # new msgs in a user's bskt
"RTN","XMUT4",60,0)
 N XMK,XMUKNCNT,XMUKECNT,XMUNCNT
"RTN","XMUT4",61,0)
 D BXREF(XMUSER)
"RTN","XMUT4",62,0)
 D N0XREF(XMUSER)
"RTN","XMUT4",63,0)
 S (XMK,XMUKCNT,XMUNCNT,XMUECNT)=0
"RTN","XMUT4",64,0)
 F  S XMK=$O(^XMB(3.7,XMUSER,2,XMK)) Q:XMK'>0  D
"RTN","XMUT4",65,0)
 . Q:XMK=.95
"RTN","XMUT4",66,0)
 . S XMUKCNT=XMUKCNT+1
"RTN","XMUT4",67,0)
 . D BSKT(XMUSER,XMK,.XMUKNCNT,.XMUKECNT)
"RTN","XMUT4",68,0)
 . S XMUNCNT=XMUNCNT+XMUKNCNT
"RTN","XMUT4",69,0)
 . S XMUECNT=XMUECNT+XMUKECNT
"RTN","XMUT4",70,0)
 S:$P($G(^XMB(3.7,XMUSER,0)),U,1)'=XMUSER $P(^(0),U,1)=XMUSER
"RTN","XMUT4",71,0)
 S:$P(^XMB(3.7,XMUSER,0),U,6)'=XMUNCNT $P(^(0),U,6)=XMUNCNT
"RTN","XMUT4",72,0)
 S:'$D(^XMB(3.7,"B",XMUSER,XMUSER)) ^XMB(3.7,"B",XMUSER,XMUSER)=""
"RTN","XMUT4",73,0)
 I $D(^XMB(3.7,XMUSER,2,0)) S:$P(^XMB(3.7,XMUSER,2,0),U,4)'=XMUKCNT $P(^(0),U,4)=XMUKCNT Q
"RTN","XMUT4",74,0)
 S ^XMB(3.7,XMUSER,2,0)="^3.701^"_$O(^XMB(3.7,XMUSER,2,"B"),-1)_U_XMUKCNT
"RTN","XMUT4",75,0)
 Q
"RTN","XMUT4",76,0)
BSKT(XMUSER,XMK,XMUKNCNT,XMUKECNT) ;
"RTN","XMUT4",77,0)
 N XMKN,XMKZ,XMZ,XMREC,XMRESEQ,XMKNAME
"RTN","XMUT4",78,0)
 S XMKNAME(1)=$$EZBLD^DIALOG(37005) ; IN
"RTN","XMUT4",79,0)
 S XMKNAME(.5)=$$EZBLD^DIALOG(37004) ; WASTE
"RTN","XMUT4",80,0)
 S XMKNAME("?")=$$EZBLD^DIALOG(34009) ; * No Name *
"RTN","XMUT4",81,0)
 D CXREF(XMUSER,XMK,.XMRESEQ)
"RTN","XMUT4",82,0)
 S (XMZ,XMUKNCNT,XMUKECNT)=0
"RTN","XMUT4",83,0)
 F  S XMZ=$O(^XMB(3.7,XMUSER,2,XMK,1,XMZ)) Q:XMZ'>0  D
"RTN","XMUT4",84,0)
 . S XMREC=^XMB(3.7,XMUSER,2,XMK,1,XMZ,0)
"RTN","XMUT4",85,0)
 . I $P(XMREC,U,1)'=XMZ D
"RTN","XMUT4",86,0)
 . . S $P(^XMB(3.7,XMUSER,2,XMK,1,XMZ,0),U,1)=XMZ
"RTN","XMUT4",87,0)
 . . D ERR(103,XMUSER,XMK,XMZ) ; Msg in bskt, but no .01 field: .01 field created
"RTN","XMUT4",88,0)
 . I '$D(^XMB(3.9,XMZ,0)) D  Q
"RTN","XMUT4",89,0)
 . . D ERR(101,XMUSER,XMK,XMZ) ; Msg in bskt, but no msg: removed from bskt
"RTN","XMUT4",90,0)
 . . D ZAPIT^XMXMSGS2(XMUSER,XMK,XMZ)
"RTN","XMUT4",91,0)
 . S XMUKECNT=XMUKECNT+1
"RTN","XMUT4",92,0)
 . S XMKZ=$P(XMREC,U,2)
"RTN","XMUT4",93,0)
 . I XMKZ D
"RTN","XMUT4",94,0)
 . . I '$D(^XMB(3.7,XMUSER,2,XMK,1,"C",XMKZ,XMZ)) S ^(XMZ)="" D ERR(112,XMUSER,XMK,XMZ) ; Msg in bskt, but no C xref: xref created
"RTN","XMUT4",95,0)
 . E  D
"RTN","XMUT4",96,0)
 . . S XMKZ=$O(^XMB(3.7,XMUSER,2,XMK,1,"C",""),-1)+1
"RTN","XMUT4",97,0)
 . . S $P(^XMB(3.7,XMUSER,2,XMK,1,XMZ,0),U,2)=XMKZ
"RTN","XMUT4",98,0)
 . . S ^XMB(3.7,XMUSER,2,XMK,1,"C",XMKZ,XMZ)=""
"RTN","XMUT4",99,0)
 . . D ERR(102,XMUSER,XMK,XMZ) ; Msg in bskt, but no seq #: seq # created
"RTN","XMUT4",100,0)
 . I '$D(^XMB(3.7,"M",XMZ,XMUSER,XMK,XMZ)) S ^(XMZ)="" D ERR(111,XMUSER,XMK,XMZ) ; Msg in bskt, but no M xref: xref created
"RTN","XMUT4",101,0)
 . ;I XMUSER=.5,XMK>999 Q
"RTN","XMUT4",102,0)
 . I $P(XMREC,U,3) D
"RTN","XMUT4",103,0)
 . . I XMK=.5 D  Q
"RTN","XMUT4",104,0)
 . . . D ERR(104,XMUSER,XMK,XMZ) ; New msg in WASTE bskt: msg made not new
"RTN","XMUT4",105,0)
 . . . S $P(^XMB(3.7,XMUSER,2,XMK,1,XMZ,0),U,3)=""
"RTN","XMUT4",106,0)
 . . . K ^XMB(3.7,XMUSER,"N0",XMK,XMZ)
"RTN","XMUT4",107,0)
 . . S XMUKNCNT=XMUKNCNT+1
"RTN","XMUT4",108,0)
 . . I '$D(^XMB(3.7,XMUSER,"N0",XMK,XMZ)) S ^(XMZ)="" D ERR(113,XMUSER,XMK,XMZ) ; New msg, but no N0 xref: xref created
"RTN","XMUT4",109,0)
 I '$D(^XMB(3.7,XMUSER,2,XMK,0)) D
"RTN","XMUT4",110,0)
 . S XMKN=$G(XMKNAME(XMK),XMKNAME("?"))
"RTN","XMUT4",111,0)
 . S ^XMB(3.7,XMUSER,2,XMK,0)=XMKN
"RTN","XMUT4",112,0)
 . D ERR(131,XMUSER,XMK) ; No bskt 0 node: created
"RTN","XMUT4",113,0)
 E  D
"RTN","XMUT4",114,0)
 . S XMKN=$P(^XMB(3.7,XMUSER,2,XMK,0),U)
"RTN","XMUT4",115,0)
 . I XMKN="" D  Q
"RTN","XMUT4",116,0)
 . . S XMKN=$G(XMKNAME(XMK),XMKNAME("?"))
"RTN","XMUT4",117,0)
 . . S $P(^XMB(3.7,XMUSER,2,XMK,0),U)=XMKN
"RTN","XMUT4",118,0)
 . . D ERR(132,XMUSER,XMK) ; Bskt name null: created
"RTN","XMUT4",119,0)
 . Q:XMK>1
"RTN","XMUT4",120,0)
 . Q:'$D(XMKNAME(XMK))
"RTN","XMUT4",121,0)
 . Q:XMKN=XMKNAME(XMK)
"RTN","XMUT4",122,0)
 . N XMKNBAD
"RTN","XMUT4",123,0)
 . S XMKNBAD=XMKN
"RTN","XMUT4",124,0)
 . S XMKN=XMKNAME(XMK)
"RTN","XMUT4",125,0)
 . S $P(^XMB(3.7,XMUSER,2,XMK,0),U)=XMKN
"RTN","XMUT4",126,0)
 . K ^XMB(3.7,XMUSER,2,"B",XMKNBAD,XMK)
"RTN","XMUT4",127,0)
 . D ERR(134,XMUSER,XMK,"",XMKNBAD) ; Bskt name '|1|' wrong: corrected
"RTN","XMUT4",128,0)
 I '$D(^XMB(3.7,XMUSER,2,"B",$E(XMKN,1,30),XMK)) S ^(XMK)="" D ERR(141,XMUSER,XMK) ; Bskt name, but no B xref: xref created
"RTN","XMUT4",129,0)
 S:$P(^XMB(3.7,XMUSER,2,XMK,0),U,2)'=XMUKNCNT $P(^(0),U,2)=XMUKNCNT
"RTN","XMUT4",130,0)
 I $D(^XMB(3.7,XMUSER,2,XMK,1,0)) D
"RTN","XMUT4",131,0)
 . S:$P(^XMB(3.7,XMUSER,2,XMK,1,0),U,4)'=XMUKECNT $P(^(0),U,4)=XMUKECNT
"RTN","XMUT4",132,0)
 E  I XMUKECNT D
"RTN","XMUT4",133,0)
 . S ^XMB(3.7,XMUSER,2,XMK,1,0)="^3.702P^"_$O(^XMB(3.7,XMUSER,2,XMK,1,"C"),-1)_U_XMUKECNT
"RTN","XMUT4",134,0)
 . D ERR(133,XMUSER,XMK) ; No msg multiple 0 node: created
"RTN","XMUT4",135,0)
 Q:'$G(XMRESEQ)
"RTN","XMUT4",136,0)
 D RSEQ^XMXBSKT(XMUSER,XMK)
"RTN","XMUT4",137,0)
 D ERR(125,XMUSER,XMK) ; C xref duplicate seq #s: bskt reseq'd
"RTN","XMUT4",138,0)
 Q
"RTN","XMUT4",139,0)
CXREF(XMUSER,XMK,XMRESEQ) ; Check the bskt's C xref (msg seq numbers in bskt)
"RTN","XMUT4",140,0)
 N XMKZ,XMZ,XMCNT
"RTN","XMUT4",141,0)
 S XMKZ=0
"RTN","XMUT4",142,0)
 F  S XMKZ=$O(^XMB(3.7,XMUSER,2,XMK,1,"C",XMKZ)) Q:'XMKZ  D
"RTN","XMUT4",143,0)
 . S (XMZ,XMCNT)=0
"RTN","XMUT4",144,0)
 . F  S XMZ=$O(^XMB(3.7,XMUSER,2,XMK,1,"C",XMKZ,XMZ)) Q:'XMZ  D
"RTN","XMUT4",145,0)
 . . S XMCNT=XMCNT+1
"RTN","XMUT4",146,0)
 . . Q:$P($G(^XMB(3.7,XMUSER,2,XMK,1,XMZ,0)),U,2)=XMKZ
"RTN","XMUT4",147,0)
 . . I '$D(^XMB(3.7,XMUSER,2,XMK,1,XMZ,0)) D  Q
"RTN","XMUT4",148,0)
 . . . S ^XMB(3.7,XMUSER,2,XMK,1,XMZ,0)=XMZ_U_XMKZ
"RTN","XMUT4",149,0)
 . . . D ERR(122,XMUSER,XMK,XMZ) ; C xref, but msg not in bskt: put in bskt
"RTN","XMUT4",150,0)
 . . I $P(^XMB(3.7,XMUSER,2,XMK,1,XMZ,0),U,2)="" D  Q
"RTN","XMUT4",151,0)
 . . . S $P(^XMB(3.7,XMUSER,2,XMK,1,XMZ,0),U,2)=XMKZ
"RTN","XMUT4",152,0)
 . . . D ERR(123,XMUSER,XMK,XMZ) ; C xref, but no msg seq #: set seq # using xref
"RTN","XMUT4",153,0)
 . . K ^XMB(3.7,XMUSER,2,XMK,1,"C",XMKZ,XMZ)
"RTN","XMUT4",154,0)
 . . D ERR(124,XMUSER,XMK,XMZ) ; C xref does not match msg seq #: xref killed
"RTN","XMUT4",155,0)
 . S:XMCNT>1 XMRESEQ=1
"RTN","XMUT4",156,0)
 Q
"RTN","XMUT4",157,0)
N0XREF(XMUSER) ; Check the user's N0 xref (new msgs)
"RTN","XMUT4",158,0)
 N XMK,XMZ
"RTN","XMUT4",159,0)
 S XMK=0
"RTN","XMUT4",160,0)
 F  S XMK=$O(^XMB(3.7,XMUSER,"N0",XMK)) Q:'XMK  D
"RTN","XMUT4",161,0)
 . S XMZ=0
"RTN","XMUT4",162,0)
 . F  S XMZ=$O(^XMB(3.7,XMUSER,"N0",XMK,XMZ)) Q:'XMZ  D
"RTN","XMUT4",163,0)
 . . Q:$P($G(^XMB(3.7,XMUSER,2,XMK,1,XMZ,0)),U,3)=1
"RTN","XMUT4",164,0)
 . . I '$D(^XMB(3.7,XMUSER,2,XMK,1,XMZ,0)) D  Q
"RTN","XMUT4",165,0)
 . . . S ^XMB(3.7,XMUSER,2,XMK,1,XMZ,0)=XMZ_"^^1"
"RTN","XMUT4",166,0)
 . . . D ERR(126,XMUSER,XMK,XMZ) ; N0 xref, but msg not in bskt: msg put in bskt
"RTN","XMUT4",167,0)
 . . S $P(^XMB(3.7,XMUSER,2,XMK,1,XMZ,0),U,3)=1
"RTN","XMUT4",168,0)
 . . D ERR(127,XMUSER,XMK,XMZ) ; N0 xref, but msg not new: new flag set
"RTN","XMUT4",169,0)
 Q
"RTN","XMUT4",170,0)
BXREF(XMUSER) ; Check the user's B xref (bskt names)
"RTN","XMUT4",171,0)
 N XMK,XMKN
"RTN","XMUT4",172,0)
 S XMKN=""
"RTN","XMUT4",173,0)
 F  S XMKN=$O(^XMB(3.7,XMUSER,2,"B",XMKN)) Q:XMKN=""  D
"RTN","XMUT4",174,0)
 . S XMK=0
"RTN","XMUT4",175,0)
 . F  S XMK=$O(^XMB(3.7,XMUSER,2,"B",XMKN,XMK)) Q:'XMK  D
"RTN","XMUT4",176,0)
 . . Q:$E($P($G(^XMB(3.7,XMUSER,2,XMK,0)),U),1,30)=XMKN
"RTN","XMUT4",177,0)
 . . I $D(^XMB(3.7,XMUSER,2,XMK,0)) D  Q
"RTN","XMUT4",178,0)
 . . . I $P($G(^XMB(3.7,XMUSER,2,XMK,0)),U)="" D  Q
"RTN","XMUT4",179,0)
 . . . . S $P(^XMB(3.7,XMUSER,2,XMK,0),U)=XMKN
"RTN","XMUT4",180,0)
 . . . . D ERR(151,XMUSER,XMK) ; B xref, but bskt name null: name set using xref
"RTN","XMUT4",181,0)
 . . . D ERR(153,XMUSER,XMK) ; B xref does not match bskt name: xref killed
"RTN","XMUT4",182,0)
 . . . K ^XMB(3.7,XMUSER,2,"B",XMKN,XMK)
"RTN","XMUT4",183,0)
 . . S $P(^XMB(3.7,XMUSER,2,XMK,0),U)=XMKN
"RTN","XMUT4",184,0)
 . . D ERR(152,XMUSER,XMK) ; B xref, but no bskt node: node set using xref
"RTN","XMUT4",185,0)
 Q
"RTN","XMUT4",186,0)
ERR(XMERRNUM,XMUSER,XMK,XMZ,XMDPARM) ;
"RTN","XMUT4",187,0)
 S XMERROR(XMERRNUM)=$G(XMERROR(XMERRNUM))+1
"RTN","XMUT4",188,0)
 Q:$D(ZTQUEUED)
"RTN","XMUT4",189,0)
 N XMPARM
"RTN","XMUT4",190,0)
 S XMPARM(1)=XMUSER,XMPARM(2)=XMK,XMPARM(3)=XMERRNUM
"RTN","XMUT4",191,0)
 S XMPARM(4)=$$EZBLD^DIALOG(36000+XMERRNUM,.XMDPARM)
"RTN","XMUT4",192,0)
 ;DUZ=|1|, Bskt=|2|$S($G(XMZ):", Msg=|5|",1:""), Err=|3| |4|
"RTN","XMUT4",193,0)
 I $G(XMZ) S XMPARM(5)=XMZ W !,$$EZBLD^DIALOG(36099,.XMPARM) Q
"RTN","XMUT4",194,0)
 W !,$$EZBLD^DIALOG(36098,.XMPARM)
"RTN","XMUT4",195,0)
 Q
"RTN","XMUT4",196,0)
 ;34009     * No Name *
"RTN","XMUT4",197,0)
 ;37004     WASTE
"RTN","XMUT4",198,0)
 ;37005     IN
"RTN","XMUT4",199,0)
 ;36098     DUZ=|1|, Bskt=|2|, Err=|3| |4|
"RTN","XMUT4",200,0)
 ;36099     DUZ=|1|, Bskt=|2|, Msg=|5|, Err=|3| |4|
"RTN","XMUT4",201,0)
 ;36101     Msg in bskt, but no msg: removed from bskt
"RTN","XMUT4",202,0)
 ;36102     Msg in bskt, but no seq #: seq # created
"RTN","XMUT4",203,0)
 ;36103     Msg in bskt, but no .01 field: .01 field
"RTN","XMUT4",204,0)
 ;36104     New msg in WASTE bskt: msg made not new
"RTN","XMUT4",205,0)
 ;36111     Msg in bskt, but no M xref: xref created
"RTN","XMUT4",206,0)
 ;36112     Msg in bskt, but no C xref: xref created
"RTN","XMUT4",207,0)
 ;36113     New msg, but no N0 xref: xref created
"RTN","XMUT4",208,0)
 ;36122     C xref, but msg not in bskt: put in bskt
"RTN","XMUT4",209,0)
 ;36123     C xref, but no msg seq #: set seq # using
"RTN","XMUT4",210,0)
 ;36124     C xref does not match msg seq #: xref kill
"RTN","XMUT4",211,0)
 ;36125     C xref duplicate seq #s: bskt reseq'd
"RTN","XMUT4",212,0)
 ;36126     N0 xref, but msg not in bskt: msg put in
"RTN","XMUT4",213,0)
 ;36127     N0 xref, but msg not new: new flag set
"RTN","XMUT4",214,0)
 ;36131     No bskt 0 node: created
"RTN","XMUT4",215,0)
 ;36132     Bskt name null: created
"RTN","XMUT4",216,0)
 ;36133     No msg multiple 0 node: created
"RTN","XMUT4",217,0)
 ;36134     Bskt name '|1|' wrong: corrected
"RTN","XMUT4",218,0)
 ;36141     Bskt name, but no B xref: xref created
"RTN","XMUT4",219,0)
 ;36151     B xref, but bskt name null: name set using
"RTN","XMUT4",220,0)
 ;36152     B xref, but no bskt node: node set using
"RTN","XMUT4",221,0)
 ;36153     B xref does not match bskt name: xref kill
"RTN","XMUT41")
0^344^B18956511
"RTN","XMUT41",1,0)
XMUT41 ;(ISC-SF/GMB- XMUT4 (Cont.) ;04/17/2002  11:52
"RTN","XMUT41",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMUT41",3,0)
WARNING(XMABORT) ;
"RTN","XMUT41",4,0)
 N DIR,X,Y,XMTEXT
"RTN","XMUT41",5,0)
 W !
"RTN","XMUT41",6,0)
 D BLD^DIALOG(36084,"","","XMTEXT","F")
"RTN","XMUT41",7,0)
 D MSG^DIALOG("WM","","","","XMTEXT")
"RTN","XMUT41",8,0)
 W !
"RTN","XMUT41",9,0)
 ;The MailMan file checker may take some time to process.
"RTN","XMUT41",10,0)
 ;If you have not tried it before, PLEASE try it when the
"RTN","XMUT41",11,0)
 ;system will be quiescent for a LONG period of time.
"RTN","XMUT41",12,0)
 ;Errors listed are generally not fatal.  Most errors are
"RTN","XMUT41",13,0)
 ;corrected.  Please enter a NOIS if there are many errors.
"RTN","XMUT41",14,0)
 ;Keep the error printout for future reference.  If you see
"RTN","XMUT41",15,0)
 ;errors in MailMan, the printout may help to resolve them.
"RTN","XMUT41",16,0)
 S DIR(0)="Y",DIR("A")=$$EZBLD^DIALOG(36085) ; Do you wish to proceed
"RTN","XMUT41",17,0)
 S DIR("B")=$$EZBLD^DIALOG(39053) ; "NO"
"RTN","XMUT41",18,0)
 D ^DIR
"RTN","XMUT41",19,0)
 I $D(DIRUT)!'Y S XMABORT=1
"RTN","XMUT41",20,0)
 Q
"RTN","XMUT41",21,0)
MXREF(XMABORT) ;
"RTN","XMUT41",22,0)
 ; XMECNT   # msgs in mailbox
"RTN","XMUT41",23,0)
 N XMZ,XMUSER,XMECNT,XMK
"RTN","XMUT41",24,0)
 W:'$D(ZTQUEUED) !!,$$EZBLD^DIALOG(36086),! ; Checking M xref
"RTN","XMUT41",25,0)
 S (XMZ,XMECNT)=0
"RTN","XMUT41",26,0)
 F  S XMZ=$O(^XMB(3.7,"M",XMZ)) Q:'XMZ  D  Q:XMABORT
"RTN","XMUT41",27,0)
 . S XMECNT=XMECNT+1 I XMECNT#5000=0 D  Q:XMABORT
"RTN","XMUT41",28,0)
 . . I '$D(ZTQUEUED) W:$X>40 ! W XMECNT,"." Q
"RTN","XMUT41",29,0)
 . . I $$S^%ZTLOAD S (XMABORT,ZTSTOP)=1 ; User asked the task to stop
"RTN","XMUT41",30,0)
 . S XMUSER=""
"RTN","XMUT41",31,0)
 . F  S XMUSER=$O(^XMB(3.7,"M",XMZ,XMUSER)) Q:'XMUSER  D
"RTN","XMUT41",32,0)
 . . S XMK=""
"RTN","XMUT41",33,0)
 . . F  S XMK=$O(^XMB(3.7,"M",XMZ,XMUSER,XMK)) Q:'XMK  D
"RTN","XMUT41",34,0)
 . . . Q:$D(^XMB(3.7,XMUSER,2,XMK,1,XMZ,0))
"RTN","XMUT41",35,0)
 . . . K ^XMB(3.7,"M",XMZ,XMUSER,XMK)
"RTN","XMUT41",36,0)
 . . . D ERR^XMUT4(121,XMUSER,XMK,XMZ) ; M xref, but msg not in bskt: xref killed
"RTN","XMUT41",37,0)
 Q:XMABORT!$D(ZTQUEUED)
"RTN","XMUT41",38,0)
 W !
"RTN","XMUT41",39,0)
 D BLD^DIALOG(36092,XMECNT,"","XMTEXT","F")
"RTN","XMUT41",40,0)
 D MSG^DIALOG("WM","",IOM,"","XMTEXT")
"RTN","XMUT41",41,0)
 ;|1| unique messages referenced in MAILBOX file 3.7
"RTN","XMUT41",42,0)
 Q
"RTN","XMUT41",43,0)
POSTBSKT ; Check the Postmaster's bskts to see if any remote bskts
"RTN","XMUT41",44,0)
 ; are numbered below 1000.  If so, move them.
"RTN","XMUT41",45,0)
 N XMK,XMKN,XMKINST,XMZ,XMINST,XMPUT
"RTN","XMUT41",46,0)
 S XMK=1
"RTN","XMUT41",47,0)
 F  S XMK=$O(^XMB(3.7,.5,2,XMK)) Q:XMK>999!'XMK  S XMKN=$P(^(XMK,0),U,1)  D
"RTN","XMUT41",48,0)
 . S XMINST=$$FIND1^DIC(4.2,"","XQ",XMKN)
"RTN","XMUT41",49,0)
 . Q:'XMINST
"RTN","XMUT41",50,0)
 . D ERR^XMUT4(160,.5,XMK) ; Xmit basket<1000 has domain name: investigate msgs.
"RTN","XMUT41",51,0)
 . ; This bskt has a remote site name.  Does it have msgs to xmit?
"RTN","XMUT41",52,0)
 . S XMKINST=XMINST+1000
"RTN","XMUT41",53,0)
 . I '$D(^XMB(3.7,.5,2,XMKINST)) D MAKEBSKT^XMXBSKT(.5,XMKINST,XMKN)
"RTN","XMUT41",54,0)
 . S (XMZ,XMPUT)=0
"RTN","XMUT41",55,0)
 . F  S XMZ=$O(^XMB(3.7,.5,2,XMK,1,XMZ)) Q:'XMZ  D
"RTN","XMUT41",56,0)
 . . I '$D(^XMB(3.9,XMZ,1,"AQUEUE",XMINST)) D  Q
"RTN","XMUT41",57,0)
 . . . ; This msg does not need to be transmitted.  Does it belong here?
"RTN","XMUT41",58,0)
 . . . Q:$D(^XMB(3.9,XMZ,1,"C",.5))!$$BCAST^XMXSEC(XMZ)
"RTN","XMUT41",59,0)
 . . . D ERR^XMUT4(161,.5,XMK,XMZ) ; Msg in xmit basket<1000 not addressed to Postmaster: deleted.
"RTN","XMUT41",60,0)
 . . . D ZAPIT^XMXMSGS2(.5,XMK,XMZ)
"RTN","XMUT41",61,0)
 . . ; This msg needs to be transmitted.  Is it in the real xmit bskt?
"RTN","XMUT41",62,0)
 . . Q:$D(^XMB(3.7,.5,2,XMKINST,1,XMZ))  ; already there
"RTN","XMUT41",63,0)
 . . S XMPUT=XMPUT+1
"RTN","XMUT41",64,0)
 . . I $D(^XMB(3.9,XMZ,1,"C",.5))!$$BCAST^XMXSEC(XMZ) D  Q
"RTN","XMUT41",65,0)
 . . . D ERR^XMUT4(162,.5,XMK,XMZ) ; Msg in xmit basket<1000: copied to proper bskt.
"RTN","XMUT41",66,0)
 . . . D PUTMSG^XMXMSGS2(.5,XMKINST,XMKN,XMZ)
"RTN","XMUT41",67,0)
 . . D ERR^XMUT4(163,.5,XMK,XMZ) ; Msg in xmit basket<1000: moved to proper bskt.
"RTN","XMUT41",68,0)
 . . D COPYIT^XMXMSGS2(.5,XMK,XMZ,XMKINST)
"RTN","XMUT41",69,0)
 . . D ZAPIT^XMXMSGS2(.5,XMK,XMZ)
"RTN","XMUT41",70,0)
 . Q:$$BMSGCT^XMXUTIL(.5,XMK)
"RTN","XMUT41",71,0)
 . N XMFDA
"RTN","XMUT41",72,0)
 . S XMFDA(3.701,XMK_",.5,",.01)="@"
"RTN","XMUT41",73,0)
 . D FILE^DIE("","XMFDA")
"RTN","XMUT41",74,0)
 . D ERR^XMUT4(164,.5,XMK) ; Xmit basket<1000 with no msgs: deleted.
"RTN","XMUT41",75,0)
 Q
"RTN","XMUT41",76,0)
SUMMARY(XMABORT) ;
"RTN","XMUT41",77,0)
 I $G(ZTSTOP) W !!,$$EZBLD^DIALOG(36422) ; *** Stopping prematurely per user request ***
"RTN","XMUT41",78,0)
 W !!,$$EZBLD^DIALOG(36087)   ; Summary of Integrity Check:
"RTN","XMUT41",79,0)
 D SUM(36089,36000.1,99,199)  ; Results for MAILBOX file 3.7:
"RTN","XMUT41",80,0)
 D SUM(36091,36300.1,199,299) ; Results for MESSAGE file 3.9:
"RTN","XMUT41",81,0)
 K XMERROR
"RTN","XMUT41",82,0)
 Q
"RTN","XMUT41",83,0)
SUM(XMTITLE,XMBASE,XMSTART,XMLIMIT) ;
"RTN","XMUT41",84,0)
 N XMERRNUM,XMPARM,XMTEXT
"RTN","XMUT41",85,0)
 W !!,$$EZBLD^DIALOG(XMTITLE) ; Results for xxx file xxx:
"RTN","XMUT41",86,0)
 S XMERRNUM=XMSTART
"RTN","XMUT41",87,0)
 F  S XMERRNUM=$O(XMERROR(XMERRNUM)) Q:'XMERRNUM!(XMERRNUM>XMLIMIT)  D
"RTN","XMUT41",88,0)
 . S XMPARM(1)=$J(XMERRNUM,3),XMPARM(2)=XMERROR(XMERRNUM)
"RTN","XMUT41",89,0)
 . W !!,$$EZBLD^DIALOG(36090,.XMPARM) ; Type |1| errors=|2|
"RTN","XMUT41",90,0)
 . D BLD^DIALOG(XMBASE+XMERRNUM,"","","XMTEXT","F")
"RTN","XMUT41",91,0)
 . D MSG^DIALOG("WE","",IOM,"","XMTEXT")
"RTN","XMUT41",92,0)
 I '$D(XMPARM) W !,$$EZBLD^DIALOG(36088) ; No errors to report.
"RTN","XMUT41",93,0)
 Q
"RTN","XMUT4A")
0^345^B2183742
"RTN","XMUT4A",1,0)
XMUT4A ;ISC-SF/GMB- Integrity Checker for file 3.7 ;04/17/2002  11:54
"RTN","XMUT4A",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMUT4A",3,0)
ADDITC(XMDUZ,XMK,XMZ,XMKZ) ; "C" xref, but msg not in bskt.  Fix it.
"RTN","XMUT4A",4,0)
 S ^XMB(3.7,XMDUZ,2,XMK,1,XMZ,0)=XMZ_U_XMKZ_U_$S($D(^XMB(3.7,XMDUZ,"N0",XMK,XMZ)):"1",$D(^XMB(3.7,XMDUZ,"N",XMK,XMZ)):"1",1:"")
"RTN","XMUT4A",5,0)
 S:'$D(^XMB(3.7,"M",XMZ,XMDUZ,XMK,XMZ)) ^XMB(3.7,"M",XMZ,XMDUZ,XMK,XMZ)=""
"RTN","XMUT4A",6,0)
 Q
"RTN","XMUT4A",7,0)
ADDITM(XMDUZ,XMK,XMZ,XMKZ) ; "M" xref, but msg not in bskt.  Fix it.
"RTN","XMUT4A",8,0)
 ; out: XMKZ
"RTN","XMUT4A",9,0)
 S XMKZ=$$GETXMKZ(XMDUZ,XMK,XMZ)
"RTN","XMUT4A",10,0)
 D ADDITC(XMDUZ,XMK,XMZ,XMKZ)
"RTN","XMUT4A",11,0)
 Q
"RTN","XMUT4A",12,0)
ADDITN(XMDUZ,XMTYPE,XMK,XMZ) ; "N" or "N0" xref, but msg not in bskt.  Fix it.
"RTN","XMUT4A",13,0)
 N XMKZ
"RTN","XMUT4A",14,0)
 S XMKZ=$$GETXMKZ(XMDUZ,XMK,XMZ)
"RTN","XMUT4A",15,0)
 S ^XMB(3.7,XMDUZ,2,XMK,1,XMZ,0)=XMZ_U_XMKZ_"^1"
"RTN","XMUT4A",16,0)
 S:'$D(^XMB(3.7,"M",XMZ,XMDUZ,XMK,XMZ)) ^XMB(3.7,"M",XMZ,XMDUZ,XMK,XMZ)=""
"RTN","XMUT4A",17,0)
 Q
"RTN","XMUT4A",18,0)
GETXMKZ(XMDUZ,XMK,XMZ) ; Find or create the message's basket sequence number.
"RTN","XMUT4A",19,0)
 N XMKZ
"RTN","XMUT4A",20,0)
 S XMKZ=0
"RTN","XMUT4A",21,0)
 F  S XMKZ=$O(^XMB(3.7,XMDUZ,2,XMK,1,"C",XMKZ)) Q:'XMKZ  Q:$D(^(XMKZ,XMZ))
"RTN","XMUT4A",22,0)
 Q:XMKZ XMKZ
"RTN","XMUT4A",23,0)
 L +^XMB(3.7,XMDUZ,2,XMK)
"RTN","XMUT4A",24,0)
 S XMKZ=$O(^XMB(3.7,XMDUZ,2,XMK,1,"C",""),-1)+1
"RTN","XMUT4A",25,0)
 S ^XMB(3.7,XMDUZ,2,XMK,1,"C",XMKZ,XMZ)=""
"RTN","XMUT4A",26,0)
 L -^XMB(3.7,XMDUZ,2,XMK)
"RTN","XMUT4A",27,0)
 Q XMKZ
"RTN","XMUT4B")
1^158
"RTN","XMUT4BA")
1^159
"RTN","XMUT4C")
0^346^B34612432
"RTN","XMUT4C",1,0)
XMUT4C ;ISC-SF/GMB-Integrity Checker for file 3.9 ;04/19/2002  13:00
"RTN","XMUT4C",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMUT4C",3,0)
 ; Was (WASH ISC)/CAP
"RTN","XMUT4C",4,0)
MESSAGE(XMABORT) ;
"RTN","XMUT4C",5,0)
 N XMZ,XMCNT,XMZREC,XMCRE8
"RTN","XMUT4C",6,0)
 W !!,$$EZBLD^DIALOG(36094),! ; Checking MESSAGE file 3.9
"RTN","XMUT4C",7,0)
 F  S XMZ=$O(^XMB(3.9,":"),-1) Q:XMZ?1N.N  D BOGUS(XMZ)
"RTN","XMUT4C",8,0)
 S (XMZ,XMCNT)=0
"RTN","XMUT4C",9,0)
 F  S XMZ=$O(^XMB(3.9,XMZ)) Q:XMZ'>0  D  Q:XMABORT
"RTN","XMUT4C",10,0)
 . I XMZ'?1N.N D BOGUS(XMZ) Q
"RTN","XMUT4C",11,0)
 . S XMCNT=XMCNT+1 I XMCNT#5000=0 D  Q:XMABORT
"RTN","XMUT4C",12,0)
 . . I '$D(ZTQUEUED) W:$X>40 ! W XMCNT,"." Q
"RTN","XMUT4C",13,0)
 . . I $$S^%ZTLOAD S (XMABORT,ZTSTOP)=1 ; User asked the task to stop
"RTN","XMUT4C",14,0)
 . S XMZREC=$G(^XMB(3.9,XMZ,0))
"RTN","XMUT4C",15,0)
 . I "^^^^^^^^"[XMZREC D
"RTN","XMUT4C",16,0)
 . . D ERR(XMZ,201) ; Msg has bad/no 0 node: not fixed
"RTN","XMUT4C",17,0)
 . E  D
"RTN","XMUT4C",18,0)
 . . D SUBJ(XMZ,XMZREC)
"RTN","XMUT4C",19,0)
 . . I $P(XMZREC,U,2)="" D
"RTN","XMUT4C",20,0)
 . . . S $P(^XMB(3.9,XMZ,0),U,2)=$$EZBLD^DIALOG(34009) ;* No Name *
"RTN","XMUT4C",21,0)
 . . . D ERR(XMZ,206) ; Msg has no sender: fixed
"RTN","XMUT4C",22,0)
 . . I $P(XMZREC,U,3)="" D
"RTN","XMUT4C",23,0)
 . . . S $P(^XMB(3.9,XMZ,0),U,3)=DT
"RTN","XMUT4C",24,0)
 . . . D ERR(XMZ,207) ; Msg has no date/time: fixed
"RTN","XMUT4C",25,0)
 . D CRE8DT(XMZ,$P(XMZREC,U,3))
"RTN","XMUT4C",26,0)
 . D RESP(XMZ,XMZREC)
"RTN","XMUT4C",27,0)
 . D:$D(^XMB(3.9,XMZ,1)) RECIP(XMZ)
"RTN","XMUT4C",28,0)
 Q:XMABORT
"RTN","XMUT4C",29,0)
 W !!,$$EZBLD^DIALOG(36093,XMCNT) ; |1| messages in the MESSAGE file 3.9
"RTN","XMUT4C",30,0)
 I XMCNT=$P(^XMB(3.9,0),U,4) W !,$$EZBLD^DIALOG(36095) Q  ; Zero node is OK
"RTN","XMUT4C",31,0)
 L +^XMB(3.9,0):1
"RTN","XMUT4C",32,0)
 S $P(^XMB(3.9,0),U,4)=XMCNT
"RTN","XMUT4C",33,0)
 L -^XMB(3.9,0)
"RTN","XMUT4C",34,0)
 W !,$$EZBLD^DIALOG(36096) ; I reset the zero node.
"RTN","XMUT4C",35,0)
 Q
"RTN","XMUT4C",36,0)
BOGUS(XMZ) ;
"RTN","XMUT4C",37,0)
 D ERR(XMZ,210) ; Msg IEN is corrupted: fixed
"RTN","XMUT4C",38,0)
 I $L($P($G(^XMB(3.9,XMZ,0)),U,1)) K ^XMB(3.9,"B",$E($P(^XMB(3.9,XMZ,0),U,1),1,30),XMZ)
"RTN","XMUT4C",39,0)
 K ^XMB(3.9,"C",+$P($G(^XMB(3.9,XMZ,.6)),U,1),XMZ)
"RTN","XMUT4C",40,0)
 K ^XMB(3.9,XMZ)
"RTN","XMUT4C",41,0)
 Q
"RTN","XMUT4C",42,0)
SUBJ(XMZ,XMZREC) ;
"RTN","XMUT4C",43,0)
 N XMSUBJ
"RTN","XMUT4C",44,0)
 S XMSUBJ=$P(XMZREC,U)
"RTN","XMUT4C",45,0)
 I XMSUBJ="" D
"RTN","XMUT4C",46,0)
 . S XMSUBJ=$$EZBLD^DIALOG(34012) ;* No Subject *
"RTN","XMUT4C",47,0)
 . S $P(^XMB(3.9,XMZ,0),U,1)=XMSUBJ
"RTN","XMUT4C",48,0)
 . S ^XMB(3.9,"B",XMSUBJ,XMZ)=""
"RTN","XMUT4C",49,0)
 . D ERR(XMZ,202) ; Msg has no subject: fixed
"RTN","XMUT4C",50,0)
 I '$D(^XMB(3.9,"B",$E(XMSUBJ,1,30),XMZ)) D
"RTN","XMUT4C",51,0)
 . I $L(XMSUBJ)>30,$D(^XMB(3.9,"B",XMSUBJ,XMZ)) D
"RTN","XMUT4C",52,0)
 . . K ^XMB(3.9,"B",XMSUBJ,XMZ)
"RTN","XMUT4C",53,0)
 . . D ERR(XMZ,205) ; Subject B xref too long: xref shortened
"RTN","XMUT4C",54,0)
 . E  D ERR(XMZ,204) ; Subject has no B xref: xref created
"RTN","XMUT4C",55,0)
 . S ^XMB(3.9,"B",$E(XMSUBJ,1,30),XMZ)=""
"RTN","XMUT4C",56,0)
 I $L(XMSUBJ)<3!($L(XMSUBJ)>65) D
"RTN","XMUT4C",57,0)
 . D ERR(XMZ,203) ; Msg subject <3 or >65: fixed
"RTN","XMUT4C",58,0)
 . S XMSUBJ=$S($L(XMSUBJ)<3:XMSUBJ_"...",1:$E(XMSUBJ,1,65))
"RTN","XMUT4C",59,0)
 . N XMFDA
"RTN","XMUT4C",60,0)
 . S XMFDA(3.9,XMZ_",",.01)=XMSUBJ
"RTN","XMUT4C",61,0)
 . D FILE^DIE("","XMFDA")
"RTN","XMUT4C",62,0)
 Q
"RTN","XMUT4C",63,0)
RESP(XMZ,XMZREC) ;
"RTN","XMUT4C",64,0)
 N XMZO
"RTN","XMUT4C",65,0)
 I $P(XMZREC,U,8) D  Q
"RTN","XMUT4C",66,0)
 . S XMZO=$P(XMZREC,U,8)
"RTN","XMUT4C",67,0)
 . I XMZO=XMZ D  Q
"RTN","XMUT4C",68,0)
 . . D ERR(XMZ,211) ; Message thinks it's a response to itself: fixed
"RTN","XMUT4C",69,0)
 . . S $P(^XMB(3.9,XMZ,0),U,8)=""
"RTN","XMUT4C",70,0)
 . I '$D(^XMB(3.9,XMZO,0)) D  Q
"RTN","XMUT4C",71,0)
 . . D ERR(XMZ,212,XMZO) ; No original message |1| for this response: fixed
"RTN","XMUT4C",72,0)
 . . S $P(^XMB(3.9,XMZ,0),U,8)=""
"RTN","XMUT4C",73,0)
 . I $$ATTACHED(XMZO,XMZ) Q
"RTN","XMUT4C",74,0)
 . D ERR(XMZ,213,XMZO) ; Not in response chain of |1|: fixed
"RTN","XMUT4C",75,0)
 . S $P(^XMB(3.9,XMZ,0),U,8)=""
"RTN","XMUT4C",76,0)
 N XMSUBJ
"RTN","XMUT4C",77,0)
 S XMSUBJ=$P(XMZREC,U)
"RTN","XMUT4C",78,0)
 Q:XMSUBJ'?1"R"1.N
"RTN","XMUT4C",79,0)
 Q:$P(XMZREC,U,2)["@"
"RTN","XMUT4C",80,0)
 S XMZO=+$E(XMSUBJ,2,99)
"RTN","XMUT4C",81,0)
 I '$D(^XMB(3.9,XMZO,0)) D  Q
"RTN","XMUT4C",82,0)
 . D ERR(XMZ,216,XMZO) ; No original message |1| for this response: not fixed
"RTN","XMUT4C",83,0)
 I '$$ATTACHED(XMZO,XMZ) D  Q
"RTN","XMUT4C",84,0)
 . D ERR(XMZ,217,XMZO) ; Not in response chain of |1|: not fixed
"RTN","XMUT4C",85,0)
 D ERR(XMZ,218,XMZO) ; Piece 8 didn't point to original message |1|: fixed
"RTN","XMUT4C",86,0)
 S $P(^XMB(3.9,XMZ,0),U,8)=XMZO
"RTN","XMUT4C",87,0)
 Q
"RTN","XMUT4C",88,0)
ATTACHED(XMZO,XMZ) ; Is XMZ in the response chain of XMZO?
"RTN","XMUT4C",89,0)
 N I
"RTN","XMUT4C",90,0)
 S I=0
"RTN","XMUT4C",91,0)
 F  S I=$O(^XMB(3.9,XMZO,3,I)) Q:'I  Q:$P($G(^(I,0)),U)=XMZ
"RTN","XMUT4C",92,0)
 Q +I
"RTN","XMUT4C",93,0)
CRE8DT(XMZ,XMDATE) ;
"RTN","XMUT4C",94,0)
 S XMCRE8=$P($G(^XMB(3.9,XMZ,.6)),U,1)
"RTN","XMUT4C",95,0)
 I 'XMCRE8 D  Q
"RTN","XMUT4C",96,0)
 . I $P(XMDATE,".",1)?7N S XMDATE=$P(XMDATE,".",1)
"RTN","XMUT4C",97,0)
 . E  I XMDATE="" S XMDATE=DT
"RTN","XMUT4C",98,0)
 . E  D
"RTN","XMUT4C",99,0)
 . . S XMDATE=$$CONVERT^XMXUTIL1(XMDATE)
"RTN","XMUT4C",100,0)
 . . S:XMDATE=-1 XMDATE=DT
"RTN","XMUT4C",101,0)
 . S $P(^XMB(3.9,XMZ,.6),U,1)=XMDATE
"RTN","XMUT4C",102,0)
 . S ^XMB(3.9,"C",XMDATE,XMZ)=""
"RTN","XMUT4C",103,0)
 . D ERR(XMZ,208) ; Msg has no local create date: fixed
"RTN","XMUT4C",104,0)
 I '$D(^XMB(3.9,"C",XMCRE8,XMZ)) D
"RTN","XMUT4C",105,0)
 . S ^XMB(3.9,"C",XMCRE8,XMZ)=""
"RTN","XMUT4C",106,0)
 . D ERR(XMZ,209) ; Local create date C xref missing: fixed
"RTN","XMUT4C",107,0)
 Q
"RTN","XMUT4C",108,0)
RECIP(XMZ) ; Check recipient multiple
"RTN","XMUT4C",109,0)
 N I,XMVAL,XMXREF,XMRECIPS
"RTN","XMUT4C",110,0)
 D CXREF(XMZ)
"RTN","XMUT4C",111,0)
 S (I,XMRECIPS)=0
"RTN","XMUT4C",112,0)
 F  S I=$O(^XMB(3.9,XMZ,1,I)) Q:'I  D
"RTN","XMUT4C",113,0)
 . S XMVAL=$P($G(^XMB(3.9,XMZ,1,I,0)),U)
"RTN","XMUT4C",114,0)
 . I XMVAL="" D  Q
"RTN","XMUT4C",115,0)
 . . Q:$P(^XMB(3.9,XMZ,.6),U,1)=DT
"RTN","XMUT4C",116,0)
 . . K ^XMB(3.9,XMZ,1,I)
"RTN","XMUT4C",117,0)
 . . D ERR(XMZ,221,I) ; Recipient |1| null, no C xref: fixed
"RTN","XMUT4C",118,0)
 . S XMRECIPS=XMRECIPS+1
"RTN","XMUT4C",119,0)
 . Q:$D(^XMB(3.9,XMZ,1,"C",$E(XMVAL,1,30),I))
"RTN","XMUT4C",120,0)
 . I $L(XMVAL)>30,$D(^XMB(3.9,XMZ,1,"C",XMVAL,I)) D  Q
"RTN","XMUT4C",121,0)
 . . ;K ^XMB(3.9,XMZ,1,"C",XMVAL,I)
"RTN","XMUT4C",122,0)
 . . ;D ERR(XMZ,223,I) ; Recipient |1| C xref too long: xref shortened
"RTN","XMUT4C",123,0)
 . . ;S ^XMB(3.9,XMZ,1,"C",$E(XMVAL,1,30),I)=""
"RTN","XMUT4C",124,0)
 . D ERR(XMZ,222,I) ; Recipient |1| no C xref: xref created
"RTN","XMUT4C",125,0)
 . S ^XMB(3.9,XMZ,1,"C",$E(XMVAL,1,30),I)=""
"RTN","XMUT4C",126,0)
 I $D(^XMB(3.9,XMZ,1,0)) S:$P(^XMB(3.9,XMZ,1,0),U,4)'=XMRECIPS $P(^(0),U,4)=XMRECIPS Q
"RTN","XMUT4C",127,0)
 S ^XMB(3.9,XMZ,1,0)="^3.91A^"_I_U_XMRECIPS
"RTN","XMUT4C",128,0)
 Q
"RTN","XMUT4C",129,0)
CXREF(XMZ) ; Check C xref for Recipient multiple
"RTN","XMUT4C",130,0)
 N I,XMVAL,XMXREF
"RTN","XMUT4C",131,0)
 S (I,XMXREF)=""
"RTN","XMUT4C",132,0)
 F  S XMXREF=$O(^XMB(3.9,XMZ,1,"C",XMXREF)) Q:XMXREF=""  D
"RTN","XMUT4C",133,0)
 . F  S I=$O(^XMB(3.9,XMZ,1,"C",XMXREF,I)) Q:'I  D
"RTN","XMUT4C",134,0)
 . . S XMVAL=$P($G(^XMB(3.9,XMZ,1,I,0)),U)
"RTN","XMUT4C",135,0)
 . . Q:$E(XMVAL,1,30)=$E(XMXREF,1,30)
"RTN","XMUT4C",136,0)
 . . I XMVAL="" D  Q
"RTN","XMUT4C",137,0)
 . . . S $P(^XMB(3.9,XMZ,1,I,0),U)=XMXREF
"RTN","XMUT4C",138,0)
 . . . I $L(XMXREF)<30 D ERR(XMZ,231,I) Q  ; C xref, but recip |1| null: fixed using xref
"RTN","XMUT4C",139,0)
 . . . D ERR(XMZ,232,I) ; C xref, but recip |1| null: fixed, but CHECK
"RTN","XMUT4C",140,0)
 . . K ^XMB(3.9,XMZ,1,"C",XMXREF,I)
"RTN","XMUT4C",141,0)
 . . D ERR(XMZ,233,I) ; C xref for recip |1| doesn't match recip: xref killed
"RTN","XMUT4C",142,0)
 Q
"RTN","XMUT4C",143,0)
ERR(XMZ,XMERRNUM,XMDPARM) ;
"RTN","XMUT4C",144,0)
 N XMPARM
"RTN","XMUT4C",145,0)
 S XMERROR(XMERRNUM)=$G(XMERROR(XMERRNUM))+1
"RTN","XMUT4C",146,0)
 S XMPARM(1)=XMZ,XMPARM(2)=$J(XMERRNUM,3)
"RTN","XMUT4C",147,0)
 S XMPARM(3)=$$EZBLD^DIALOG(36300+XMERRNUM,.XMDPARM)
"RTN","XMUT4C",148,0)
 W !,$$EZBLD^DIALOG(36097,.XMPARM) ;Msg=|1|, Err=|2| |3|
"RTN","XMUT4C",149,0)
 Q
"RTN","XMUT5")
0^347^B15655517
"RTN","XMUT5",1,0)
XMUT5 ;ISC-SF/GMB-Check Background Filer (local delivery queues) ;04/17/2002  11:57
"RTN","XMUT5",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMUT5",3,0)
 ;(WASH ISC)/CAP
"RTN","XMUT5",4,0)
 ;
"RTN","XMUT5",5,0)
 ; Entry points used by MailMan options (not covered by DBIA):
"RTN","XMUT5",6,0)
 ; CHECK    XMMGR-CHECK-BACKGROUND-FILER
"RTN","XMUT5",7,0)
CHECK ;
"RTN","XMUT5",8,0)
 N XMTEXT
"RTN","XMUT5",9,0)
 ;* Latest Delivery shows last user with message in mailbox.
"RTN","XMUT5",10,0)
 ;Meaningful for new messages, possibly meaningful for (f) forwarded messages.
"RTN","XMUT5",11,0)
 ;Not meaningful and not shown for responses.
"RTN","XMUT5",12,0)
 D BLD^DIALOG(36222,"","","XMTEXT(""*"")","F")
"RTN","XMUT5",13,0)
 D BLD^DIALOG(36219,"","","XMTEXT(""M"")","F")
"RTN","XMUT5",14,0)
 D BLD^DIALOG(36220,"","","XMTEXT(""R"")","F")
"RTN","XMUT5",15,0)
 I $D(ZTQUEUED)!($G(IOST)'["C-") D DISPLAY Q
"RTN","XMUT5",16,0)
 F  D DISPLAY D  Q:'(Y!$D(DTOUT))
"RTN","XMUT5",17,0)
 . W !
"RTN","XMUT5",18,0)
 . N DIR,X,DTIME
"RTN","XMUT5",19,0)
 . S DTIME=5
"RTN","XMUT5",20,0)
 . S DIR(0)="Y",DIR("A")=$$EZBLD^DIALOG(36210) ; Refresh
"RTN","XMUT5",21,0)
 . S DIR("B")=$$EZBLD^DIALOG(39054) ; YES
"RTN","XMUT5",22,0)
 . D BLD^DIALOG(36211,"","","DIR(""?"")")
"RTN","XMUT5",23,0)
 . ;Answer YES if you want the display refreshed.
"RTN","XMUT5",24,0)
 . ;Answer NO if you don't.
"RTN","XMUT5",25,0)
 . ;If you don't answer, the display will be refreshed every five seconds.
"RTN","XMUT5",26,0)
 . D ^DIR
"RTN","XMUT5",27,0)
 Q
"RTN","XMUT5",28,0)
DISPLAY ;
"RTN","XMUT5",29,0)
 N XMQLIST,M,R,XMTSTAMP,XMPARM
"RTN","XMUT5",30,0)
 W !!,$$EZBLD^DIALOG(36212,$$FMTE^XLFDT($$NOW^XLFDT,5)),! ; Delivery Queue Status as of
"RTN","XMUT5",31,0)
 ;W !,"Lines displayed since last 1/2 hour: ",+$G(^XMBPOST("LINES_READ",0))
"RTN","XMUT5",32,0)
 S M=$G(^XMBPOST("STATS","M")),R=$G(^("R"))
"RTN","XMUT5",33,0)
 I M+R>0 D
"RTN","XMUT5",34,0)
 . S XMPARM(1)=M+R,XMPARM(2)=M,XMPARM(3)=R
"RTN","XMUT5",35,0)
 . W !,$$EZBLD^DIALOG(36213,.XMPARM) ; Deliveries COMPLETED since last 1/2 hour: _M+R_ (_M_ Msg, _R_ Resp)
"RTN","XMUT5",36,0)
 D GO^XMUT5B
"RTN","XMUT5",37,0)
 D GETQ^XMKPLQ(.XMQLIST)
"RTN","XMUT5",38,0)
 S XMPARM(1)=$L(XMQLIST("M"),",")+1,XMPARM(2)=$L(XMQLIST("R"),",")+1
"RTN","XMUT5",39,0)
 W !,$$EZBLD^DIALOG(36214,.XMPARM) ; Number of delivery queues: X Message and Y Response
"RTN","XMUT5",40,0)
 S XMTSTAMP=$O(^XMBPOST("BOX",0))
"RTN","XMUT5",41,0)
 I XMTSTAMP W !,$$EZBLD^DIALOG(36215,$$WAITIME(XMTSTAMP)) ; Waiting time for items to be put in the delivery queues:
"RTN","XMUT5",42,0)
 E  W !,$$EZBLD^DIALOG(36216) ; Nothing waiting to be put in the delivery queues.
"RTN","XMUT5",43,0)
 I M("T")+R("T")<1 W !!,$$EZBLD^DIALOG(36217) ; Nothing in the delivery queues.
"RTN","XMUT5",44,0)
 E  D
"RTN","XMUT5",45,0)
 . W !,$$EZBLD^DIALOG(36218,M("T")+R("T")) ; Items currently waiting in delivery queues:
"RTN","XMUT5",46,0)
 . I M("T")>0 D SHOWQ("M",.M,XMQLIST("M"))
"RTN","XMUT5",47,0)
 . I R("T")>0 D SHOWQ("R",.R,XMQLIST("R"))
"RTN","XMUT5",48,0)
 . I M("T") D MSG^DIALOG("SWM","",80,"","XMTEXT(""*"")")
"RTN","XMUT5",49,0)
 D SHOWFILR
"RTN","XMUT5",50,0)
 Q
"RTN","XMUT5",51,0)
SHOWQ(XMGROUP,Q,XMQLIST) ;
"RTN","XMUT5",52,0)
 D MSG^DIALOG("SWM","",80,"","XMTEXT(XMGROUP)")
"RTN","XMUT5",53,0)
 N I,XMCNT
"RTN","XMUT5",54,0)
 S XMCNT=0
"RTN","XMUT5",55,0)
 F I=1:1:10 I Q("O",I) D
"RTN","XMUT5",56,0)
 . S XMCNT=XMCNT+1
"RTN","XMUT5",57,0)
 . W !,$J(I,2),"  ",$$QRANGE(XMQLIST,I)
"RTN","XMUT5",58,0)
 . W ?17,$J(+Q("O",I),7),?27,$J($P(Q("O",I),U,3),8),?39,$J($$WAITIME($P(Q("O",I),U,2)),12),$J($P(Q("O",I),U,4),16),$J($P(Q("O",I),U,5),3),$J($P(Q("O",I),U,6),9)
"RTN","XMUT5",59,0)
 I XMCNT>1 W !,?3,$$EZBLD^DIALOG(36221),?17,$J(+Q("T"),7),?27,$J($P(Q("T"),U,3),8),?39,$J($$WAITIME($P(Q("T"),U,2)),12) ; Summary
"RTN","XMUT5",60,0)
 Q
"RTN","XMUT5",61,0)
SHOWFILR ;
"RTN","XMUT5",62,0)
 N XMSTATUS,I
"RTN","XMUT5",63,0)
 D STATUS^XMKPL(.XMSTATUS)
"RTN","XMUT5",64,0)
 W !!,$$EZBLD^DIALOG(36224) ; Background filer status:
"RTN","XMUT5",65,0)
 I $D(XMSTATUS)<10 D
"RTN","XMUT5",66,0)
 . W $$EZBLD^DIALOG(36225) ; ALL Background Delivery jobs are RUNNING.
"RTN","XMUT5",67,0)
 E  D
"RTN","XMUT5",68,0)
 . I $P(^XMB(1,1,0),U,16) D
"RTN","XMUT5",69,0)
 . . N XMTEXT ; The Background Filers have been shut down.
"RTN","XMUT5",70,0)
 . . D BLD^DIALOG(36226,"","","XMTEXT","F")
"RTN","XMUT5",71,0)
 . . D MSG^DIALOG("SWM","",80,"","XMTEXT")
"RTN","XMUT5",72,0)
 . W !
"RTN","XMUT5",73,0)
 . S I=""
"RTN","XMUT5",74,0)
 . F  S I=$O(XMSTATUS(I)) Q:I=""  W !,XMSTATUS(I)
"RTN","XMUT5",75,0)
 Q
"RTN","XMUT5",76,0)
QRANGE(XMQLIST,I) ; Queue range
"RTN","XMUT5",77,0)
 I XMQLIST="" Q "(...)"
"RTN","XMUT5",78,0)
 I I=1 Q "<"_+XMQLIST
"RTN","XMUT5",79,0)
 I I>$L(XMQLIST,",") Q $P(XMQLIST,",",I-1)_"+"
"RTN","XMUT5",80,0)
 Q $P(XMQLIST,",",I-1)_"-"_($P(XMQLIST,",",I)-1)
"RTN","XMUT5",81,0)
WAITIME(X) ;
"RTN","XMUT5",82,0)
 N XMDIFF,XMWAIT
"RTN","XMUT5",83,0)
 S XMDIFF=$$TSTAMP^XMXUTIL1-X
"RTN","XMUT5",84,0)
 S XMWAIT=""
"RTN","XMUT5",85,0)
 S:XMDIFF'<86400 XMWAIT=(XMDIFF\86400)_" "
"RTN","XMUT5",86,0)
 S:XMDIFF#86400 XMWAIT=XMWAIT_(XMDIFF#86400\3600)_":"_$E(XMDIFF#3600\60+100,2,3)_":"_$E(XMDIFF#60+100,2,3)
"RTN","XMUT5",87,0)
 Q XMWAIT
"RTN","XMUT5B")
0^389^B2957494
"RTN","XMUT5B",1,0)
XMUT5B ;(WASH ISC)/CAP-Gather Delivery Queue Data ;04/17/2002  12:05
"RTN","XMUT5B",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMUT5B",3,0)
 ;;XX.XX
"RTN","XMUT5B",4,0)
 ;
"RTN","XMUT5B",5,0)
 ;M("O") & R("O") = #items ^ timestamp of oldest ^ #deliveries
"RTN","XMUT5B",6,0)
 ;M("T") & R("T") = same as "O" above except for all messages/responses
"RTN","XMUT5B",7,0)
GO ;S X="USERY^XMUT5B",@^%ZOSF("TRAP"),X=$ZC(%SPAWN,"SUBMIT/QUE=FORUM7_BATCH LEEUSER.COM")
"RTN","XMUT5B",8,0)
GP ;
"RTN","XMUT5B",9,0)
 N I,XMFWD
"RTN","XMUT5B",10,0)
 S XMFWD=$$EZBLD^DIALOG(36223) ; (f)
"RTN","XMUT5B",11,0)
 S M("T")=0
"RTN","XMUT5B",12,0)
 F I=1:1:10 S M("O",I)=0 I $D(^XMBPOST("M",I)) D Q("M",.M,I)
"RTN","XMUT5B",13,0)
 S R("T")=0
"RTN","XMUT5B",14,0)
 F I=1:1:10 S R("O",I)=0 I $D(^XMBPOST("R",I)) D Q("R",.R,I)
"RTN","XMUT5B",15,0)
 Q
"RTN","XMUT5B",16,0)
Q(XMGROUP,XMQ,I) ;
"RTN","XMUT5B",17,0)
 N XMREC,XMTSTAMP,XMZ
"RTN","XMUT5B",18,0)
 S XMREC=$G(^XMBPOST(XMGROUP,I)),XMTSTAMP=$O(^(I,0)) S XMZ=$S(XMTSTAMP:$O(^(XMTSTAMP,"")),1:"")
"RTN","XMUT5B",19,0)
 I XMGROUP="M",XMZ D
"RTN","XMUT5B",20,0)
 . I XMZ[U S XMZ=$P(XMZ,U,1)_U_XMFWD ; if [U, then it's a forward
"RTN","XMUT5B",21,0)
 . E  S XMZ=XMZ_U
"RTN","XMUT5B",22,0)
 . S XMZ=XMZ_U_$O(^XMB(3.7,"M",$P(XMZ,U,1),""),-1) ; latest delivery
"RTN","XMUT5B",23,0)
 S XMQ("O",I)=+XMREC_U_XMTSTAMP_U_$P(XMREC,U,2)_U_XMZ
"RTN","XMUT5B",24,0)
 Q:'XMREC
"RTN","XMUT5B",25,0)
 S $P(XMQ("T"),U)=$P(XMQ("T"),U)+XMREC,$P(XMQ("T"),U,3)=$P(XMQ("T"),U,3)+$P(XMREC,U,2)
"RTN","XMUT5B",26,0)
 I $S('$P(XMQ("T"),U,2):1,$P(XMQ("T"),U,2)>XMTSTAMP:1,1:0) S $P(XMQ("T"),U,2)=XMTSTAMP
"RTN","XMUT5B",27,0)
 Q
"RTN","XMUT5B",28,0)
USERS(%) ;Get the number of ZSLOT users
"RTN","XMUT5B",29,0)
 ;%=1 do not display output, %=0 display
"RTN","XMUT5B",30,0)
 N X,A,B,C,Y,Z,ZSLOTDSP S ZSLOTDSP=%
"RTN","XMUT5B",31,0)
 ;
"RTN","XMUT5B",32,0)
 ;First -- is the ZSLOT software installed ?
"RTN","XMUT5B",33,0)
 S X="ZSLOT" X ^%ZOSF("TEST") E  S %=0 G USERQ
"RTN","XMUT5B",34,0)
 ;
"RTN","XMUT5B",35,0)
 ;Call ZSLOT for count of ZSLOT users
"RTN","XMUT5B",36,0)
 S %="N/A" I $T(ENTCLUST^ZSLOT)'="" D ENTCLUST^ZSLOT S %=Y
"RTN","XMUT5B",37,0)
USERQ Q %
"RTN","XMUT5C")
0^348^B5865266
"RTN","XMUT5C",1,0)
XMUT5C ;(WASH ISC)/CAP-Response Time Logger/Purge ;04/17/2002  11:59
"RTN","XMUT5C",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMUT5C",3,0)
 ; Entry points used by MailMan options (not covered by DBIA):
"RTN","XMUT5C",4,0)
 ; GO     XMMGR-RESPONSE-TIME-COMPILER
"RTN","XMUT5C",5,0)
 ; LOGON  XMMGR-RESPONSE-TIME-TOGGLER
"RTN","XMUT5C",6,0)
 I '$D(ZTQUEUED) U IO(0) W !!,"Compiling Data..."
"RTN","XMUT5C",7,0)
GO ;Entry for Tasked report
"RTN","XMUT5C",8,0)
 ;
"RTN","XMUT5C",9,0)
 S XMV=^%ZOSF("PROD"),(D,Z)=0
"RTN","XMUT5C",10,0)
 ;
"RTN","XMUT5C",11,0)
 ;Are there statistics to gather ?  Only gather statistics till T-1.
"RTN","XMUT5C",12,0)
 ;
"RTN","XMUT5C",13,0)
 ;Is there a date ?
"RTN","XMUT5C",14,0)
Z S Z=$O(^%ZRTL(3,XMV,Z)) G Q:$H-Z'>0,Q:Z=""
"RTN","XMUT5C",15,0)
 ;Is there Response Time data for MailMan ?
"RTN","XMUT5C",16,0)
 S J=$O(^%ZRTL(3,XMV,Z,"XMA1-DEL/TERM",0)) D S:J
"RTN","XMUT5C",17,0)
 ;
"RTN","XMUT5C",18,0)
 ;Kill off Response time data for this date (stored in XMBX now)
"RTN","XMUT5C",19,0)
 K ^%ZRTL(3,XMV,Z,"XMA1-DEL/TERM") G Z
"RTN","XMUT5C",20,0)
 ;
"RTN","XMUT5C",21,0)
 ;Gather 1 days' statistics
"RTN","XMUT5C",22,0)
S S %H=Z D YMD^%DTC S (E,XMA)=X,S=0
"RTN","XMUT5C",23,0)
 I '$D(ZTQUEUED) W !,"DATE="_$$FMTE^XLFDT($P(XMA,".",1),"2Z"),! S D=D+1
"RTN","XMUT5C",24,0)
0 S XMA=$O(^XMBX(4.2998,"B",XMA)) I $S('XMA:1,XMA-E>.999:1,1:0) Q
"RTN","XMUT5C",25,0)
 S %=$P(XMA,".",2),L=$E(%,1,2)*3600+($E(%,3,4)*60)+$E(%,5,6),(C,T)=0 D G
"RTN","XMUT5C",26,0)
 S %=$O(^XMBX(4.2998,"B",XMA,0)),$P(^XMBX(4.2998,%,0),U,8)=$S(C>0:$FN(T/C,"",1),1:"")
"RTN","XMUT5C",27,0)
 G 0
"RTN","XMUT5C",28,0)
 ;
"RTN","XMUT5C",29,0)
 ;Get response time out of %ZRTL
"RTN","XMUT5C",30,0)
G S S=$O(^%ZRTL(3,XMV,Z,"XMA1-DEL/TERM",S)) Q:S=""  I S>L S S=L Q
"RTN","XMUT5C",31,0)
 S %=^(S),C=C+1,T=S-$P($P(%,"^"),",",2)+T I '$D(ZTQUEUED),C#100=0 W "."
"RTN","XMUT5C",32,0)
 G G
"RTN","XMUT5C",33,0)
 ;
"RTN","XMUT5C",34,0)
 ;Write totals and quit
"RTN","XMUT5C",35,0)
Q I '$D(ZTQUEUED) W !!,?2,$S(D:D_" Dates Processed and Purged",1:"<<<< Nothing to process >>>>"),!
"RTN","XMUT5C",36,0)
 K %,%H,%I,C,D,E,J,L,S,T,X,Y,Z,XMA,XMC,XMD,XMV
"RTN","XMUT5C",37,0)
 Q
"RTN","XMUT5C",38,0)
ZTSK S ZTRTN="GO^XMUT5C",ZTDTH=$S($D(ZTQUEUED):1,1:0)+$H_","_(3600*18),ZTDESC="Response Time accumulator for file 4.2998",ZTIO="" D ^%ZTLOAD
"RTN","XMUT5C",39,0)
 Q
"RTN","XMUT5C",40,0)
LOGON ;Turn ON response time logging
"RTN","XMUT5C",41,0)
 S X="y" D LOG
"RTN","XMUT5C",42,0)
 ;Schedule next task
"RTN","XMUT5C",43,0)
 K ZTREQ S ZTIO="",ZTRTN="LOGOFF^XMUT5C",X=$P($H,",",2),ZTDESC="Turn OFF response Time Logging"
"RTN","XMUT5C",44,0)
 K % I X<28800 S %=+$H_",29100"
"RTN","XMUT5C",45,0)
 I X>57600 S %=$H+1_",29100"
"RTN","XMUT5C",46,0)
 I $D(%) S ZTDTH=%
"RTN","XMUT5C",47,0)
 E  S %=$H*86400+X+300,ZTDTH=%\86400_","_(%#86400)
"RTN","XMUT5C",48,0)
 D ^%ZTLOAD S ZTREQ="@" Q
"RTN","XMUT5C",49,0)
LOGOFF ;Turn OFF response time logging
"RTN","XMUT5C",50,0)
 S X="n"
"RTN","XMUT5C",51,0)
 ;Update Kernel Site Parameters LOG RESPONSE TIME FIELD
"RTN","XMUT5C",52,0)
LOG L +^XTV(8989.3,1)
"RTN","XMUT5C",53,0)
 S %=^%ZOSF("VOL"),%=$O(^XTV(8989.3,1,4,"B",%,0)),$P(^XTV(8989.3,1,4,%,0),U,6)=X
"RTN","XMUT5C",54,0)
 L -^XTV(8989.3,1) K %,X S ZTREQ="@"
"RTN","XMUT5C",55,0)
 Q
"RTN","XMUT5G")
0^349^B429148
"RTN","XMUT5G",1,0)
XMUT5G ;(WASH ISC)/CAP-Validate Mail Group Members ;04/17/2002  12:00
"RTN","XMUT5G",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMUT5G",3,0)
 S DIC="^XMB(3.8,",DIC(0)="AEO" D ^DIC
"RTN","XMUT5G",4,0)
 S A=0,XMA0=+Y,C=0 W !,"Analyzing "_$P(Y,U,2)_" Mail Group",!!
"RTN","XMUT5G",5,0)
A S A=$O(^XMB(3.8,XMA0,1,"B",A)) G Q:'A
"RTN","XMUT5G",6,0)
 S C=C+1 I C#100=0 W "***"_A_"*** "
"RTN","XMUT5G",7,0)
 S F=$G(^VA(200,A,0))
"RTN","XMUT5G",8,0)
 I '$L($P(F,U,2))!$L($P(F,U,11)) W A," "
"RTN","XMUT5G",9,0)
 G A
"RTN","XMUT5G",10,0)
Q K A,C,XMA0,DIC,DTOUT,DUOUT Q
"RTN","XMUT5Q")
0^350^B18391915
"RTN","XMUT5Q",1,0)
XMUT5Q ;(WASH ISC)/CAP-Delivery Queue Analysis ;04/17/2002  12:03
"RTN","XMUT5Q",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMUT5Q",3,0)
 Q
"RTN","XMUT5Q",4,0)
QUIT ;End process
"RTN","XMUT5Q",5,0)
 D REC
"RTN","XMUT5Q",6,0)
QUIT1 K %,A,B,I,J,RSP,X,Y,ZTSK,ZTSAVE,ZTRTN,ZTDTH
"RTN","XMUT5Q",7,0)
 K:'$D(ZTQUEUED) C,M,R
"RTN","XMUT5Q",8,0)
 G ZTSK0
"RTN","XMUT5Q",9,0)
 ;
"RTN","XMUT5Q",10,0)
ZTSK ;SCHEDULE TO RUN
"RTN","XMUT5Q",11,0)
 K XMUT5,XMUT5Q S ZTRTN="GO^XMUT5Q1" G GO
"RTN","XMUT5Q",12,0)
ZTSK0 ;Reschedules itself here
"RTN","XMUT5Q",13,0)
 S ZTRTN="GO2^XMUT5Q1"
"RTN","XMUT5Q",14,0)
GO Q:$S($D(XMUT5NO):1,'$D(XMUT5F):0,'$D(XMUT5Q):0,XMUT5Q>XMUT5F:1,1:0)
"RTN","XMUT5Q",15,0)
 S:'$D(XMUT5S) XMUT5S=1800
"RTN","XMUT5Q",16,0)
 K XMUT5N S XMUT5Q=$G(XMUT5Q)+1,ZTSAVE("C*")="",ZTSAVE("XMZUT*")="",ZTREQ="@" I $D(ZTQUEUED) S XMUT5=1
"RTN","XMUT5Q",17,0)
 S X=$H*86400+$P($H,",",2)+XMUT5S\XMUT5S*XMUT5S,ZTDTH=X\86400_","_(X#86400),ZTDESC="MGRMAIL "_XMUT5S_" second interval Delivery Queue Check"
"RTN","XMUT5Q",18,0)
 S:'$D(ZTRTN) ZTRTN="GO^XMUT5Q1" S ZTIO="" D ^%ZTLOAD
"RTN","XMUT5Q",19,0)
 Q
"RTN","XMUT5Q",20,0)
REC ;RECORD QUEUE STATUS
"RTN","XMUT5Q",21,0)
 D NOW^%DTC
"RTN","XMUT5Q",22,0)
 ;
"RTN","XMUT5Q",23,0)
 ;Look to see if data already file and quit if it is there
"RTN","XMUT5Q",24,0)
 S X=$P(%,".")_"."_$E($P(%,".",2),1,2) I $E($P(%,".",2),3)>2 S X=X_3
"RTN","XMUT5Q",25,0)
 S X=$O(^XMBX(4.2998,"B",X)),DA=$S(X="":"",1:$O(^(X,0))) Q:DA
"RTN","XMUT5Q",26,0)
 I 'DA S X=%,DIC="^XMBX(4.2998,",DIC(0)="FI",Y=0 D FILE^DICN
"RTN","XMUT5Q",27,0)
 S DIE="^XMBX(4.2998,",DA=+Y,XMUSER=$$USERS^XMUT5B(0)
"RTN","XMUT5Q",28,0)
 ;zero node
"RTN","XMUT5Q",29,0)
 S DR="1///"_(M("T")+R("T"))_";11///"_+M("T")_";12///"_+R("T")_";43///"_$P(^XMB(3.9,0),U,3)
"RTN","XMUT5Q",30,0)
 I $G(XMUSER) S DR=DR_";39///"_XMUSER_";38///"_XMUSER
"RTN","XMUT5Q",31,0)
 S %="LINES_READ" I $D(^XMBPOST(%)) L +^XMBPOST(%) S DR=DR_";15///"_^XMBPOST(%,0) S ^(0)=0 L -^XMBPOST(%)
"RTN","XMUT5Q",32,0)
 ;File it
"RTN","XMUT5Q",33,0)
 D ^DIE K DR
"RTN","XMUT5Q",34,0)
 L +^XMBPOST("GSTATS","R")
"RTN","XMUT5Q",35,0)
 S %=$G(^XMBPOST("STATS","R")) S:%>0 DR="45///"_+% S ^("R")=0
"RTN","XMUT5Q",36,0)
 L -^XMBPOST("GSTATS","R")
"RTN","XMUT5Q",37,0)
 L +^XMBPOST("GSTATS","M")
"RTN","XMUT5Q",38,0)
 S %=$G(^XMBPOST("STATS","M")) S:%>0 DR=$S($D(DR):DR_";",1:"")_"44///"_+% S ^("M")=0
"RTN","XMUT5Q",39,0)
 L -^XMBPOST("GSTATS","M")
"RTN","XMUT5Q",40,0)
 S (%0,%)="" F I=1:1:10 S %0=$G(^XMBPOST("M",I)) S %=%+$P(%0,U,2)
"RTN","XMUT5Q",41,0)
 S:%>0 DR=$S($D(DR):DR_";",1:"")_"46///"_%
"RTN","XMUT5Q",42,0)
 S (%0,%)="" F I=1:1:10 S %0=$G(^XMBPOST("R",I)) S %=%+$P(%0,U,2)
"RTN","XMUT5Q",43,0)
 S:%>0 DR=$S($D(DR):DR_";",1:"")_"47///"_% K %0
"RTN","XMUT5Q",44,0)
 I $D(DR) D ^DIE K DR
"RTN","XMUT5Q",45,0)
 ;1 node
"RTN","XMUT5Q",46,0)
 S %=$P(M("T"),U,2) I % S DR=$S($D(DR):DR_";",1:"")_"101///"_($H*86400+$P($H,",",2)-%)
"RTN","XMUT5Q",47,0)
 S %=$P(R("T"),U,2) I % S DR=$S($D(DR):DR_";",1:"")_"102///"_($H*86400+$P($H,",",2)-%)
"RTN","XMUT5Q",48,0)
 S %=$S($D(^XMB(1,1,6)):^(6),1:"10^50,400"),DR=$S($D(DR):DR_";",1:"")_"103///"_$P(%,U,2)_";104///"_$P(%,U)
"RTN","XMUT5Q",49,0)
 ;File it
"RTN","XMUT5Q",50,0)
 I $D(DR) D ^DIE K DR
"RTN","XMUT5Q",51,0)
 ;2 & 3 nodes
"RTN","XMUT5Q",52,0)
 S I=201,DR="" D DR
"RTN","XMUT5Q",53,0)
 D ^DIE:$L($G(DR)) K DR
"RTN","XMUT5Q",54,0)
 ;4 & 5 nodes
"RTN","XMUT5Q",55,0)
 S I=401,DR="" D DR
"RTN","XMUT5Q",56,0)
 ;File it
"RTN","XMUT5Q",57,0)
 D ^DIE:$L($G(DR)) K DR
"RTN","XMUT5Q",58,0)
 ;Nodes 6 & 7 - Deliveries
"RTN","XMUT5Q",59,0)
 F I=1:1:10 S %=$P(R("O",I),U,3) I % S DR=$S($D(DR):DR_";",1:"")_60_I_"///"_%
"RTN","XMUT5Q",60,0)
 F I=1:1:10 S %=$P(M("O",I),U,3) I % S DR=$S($D(DR):DR_";",1:"")_70_I_"///"_%
"RTN","XMUT5Q",61,0)
 D ^DIE:$L($G(DR))
"RTN","XMUT5Q",62,0)
 K %H,D,D0,DI,DIE,DIC,DA,DO,DR,DQ,X
"RTN","XMUT5Q",63,0)
 Q
"RTN","XMUT5Q",64,0)
DR F I=I:1:I+9 S:$E(I)=2 %=R("O",I#100) S:$E(I)=4 %=M("O",I#100) I +% S:$L(DR) DR=$G(DR)_";" S DR=$G(DR)_(I+100)_"///"_+% I +$P(%,U,2) S DR=$G(DR)_";"_I_"///"_($H*86400+$P($H,",",2)-$P(%,U,2))
"RTN","XMUT5Q",65,0)
 Q
"RTN","XMUT5Q",66,0)
GET N J S J=I N I S I=J,Z=J
"RTN","XMUT5Q",67,0)
GET1 W !!,"Please enter the following for "_$P("ORIGINAL MESSAGES: ,RESPONSES: ",",",Z)
"RTN","XMUT5Q",68,0)
 R !!,"Enter up to 9 numbers separated by commas to determine statistical groupings.",!,"EG:  50,100,500 will create 4 groups: 1-49, 50-99, 100-499 & 500 and above.",!!,"Enter them now: ",X:DTIME
"RTN","XMUT5Q",69,0)
 Q:"^"[X
"RTN","XMUT5Q",70,0)
 F I=1:1 S A=$P(X,",",I) Q:A=""  S B=$P(X,",",I+1) I $S(+A'=A:1,I>10:1,1:0)!(B'>A&B) D ERR G GET1
"RTN","XMUT5Q",71,0)
 Q
"RTN","XMUT5Q",72,0)
ENUSER ;Entry point called by VMS job that calculates active logons
"RTN","XMUT5Q",73,0)
 ;Parameter passed has three comma (",") pieces for active logons
"RTN","XMUT5Q",74,0)
 ;
"RTN","XMUT5Q",75,0)
 ;**** REVISED 1/93 ****
"RTN","XMUT5Q",76,0)
 ;VMS JOB NO LONGER WORKS -- ZSLOT USER ARE KEPT TRCK OF DIFFERENTLY
"RTN","XMUT5Q",77,0)
 ;
"RTN","XMUT5Q",78,0)
 ;$P(%,",",1)=Total - $P(%,",",2)=ZSLOT - $P(%,",",3)=Non-ZSLOT
"RTN","XMUT5Q",79,0)
 ;$P(%,",",4)=VMS style date (N-MMM-YYY HH:MM:SS:xx)
"RTN","XMUT5Q",80,0)
 ;
"RTN","XMUT5Q",81,0)
 S U="^" L +^XMBX(4.2998)
"RTN","XMUT5Q",82,0)
 S XMA0=%,%=$P(%,",",4),DA=$P($G(^XMBX(4.2998,0)),U,3) Q:'DA
"RTN","XMUT5Q",83,0)
 ;
"RTN","XMUT5Q",84,0)
 ;Re-construct VMS date to date FileMan's conversion can handle as input
"RTN","XMUT5Q",85,0)
 F I=0:0 Q:$E(%)'=" "  S %=$E(%,2,99)
"RTN","XMUT5Q",86,0)
 S X=$P(%,"-",2)_" "_$E("0",$L(+%))_+%_", "_+$P(%,"-",3),XMB0=$P(%," ",2)
"RTN","XMUT5Q",87,0)
 ;
"RTN","XMUT5Q",88,0)
 ;If this data applies to the last entry made for statistics (within
"RTN","XMUT5Q",89,0)
 ;1/2 hour) file it in this entry.
"RTN","XMUT5Q",90,0)
 ;
"RTN","XMUT5Q",91,0)
 D ^%DT S X=Y_"."_$P(XMB0,":")_$P(XMB0,":",2),(%0,Y)=^XMBX(4.2998,DA,0)
"RTN","XMUT5Q",92,0)
 I X-Y<.003 F %=22,23 S X=$P(XMA0,",",%-20) I X>$P(Y,"^",%) S $P(Y,"^",%)=X,$P(Y,"^",21)=$P(Y,"^",21)+X
"RTN","XMUT5Q",93,0)
 S ^XMBX(4.2998,DA,0)=Y L -^XMBX(4.2998) K DA,XMA0
"RTN","XMUT5Q",94,0)
 Q
"RTN","XMUT5Q",95,0)
ERR W $C(7),"  ???" S X="" Q
"RTN","XMUT5Q",96,0)
 ;
"RTN","XMUT5Q",97,0)
NOTASK ;Run in foreground
"RTN","XMUT5Q",98,0)
 S XMUT5NO=1,XMUT5=1
"RTN","XMUT5Q",99,0)
 R !!,"Initialize time stamps in queue (necessary 1st run): NO// ",X:DTIME
"RTN","XMUT5Q",100,0)
 K:$E(X)="Y" XMUT5
"RTN","XMUT5Q",101,0)
 G 0^XMUT5Q1
"RTN","XMUT5Q1")
0^351^B8959791
"RTN","XMUT5Q1",1,0)
XMUT5Q1 ;(WASH ISC)/CAP-Delivery Queue Analysis (start/init) ;04/17/2002  12:02
"RTN","XMUT5Q1",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMUT5Q1",3,0)
 ; Entry points used by MailMan options (not covered by DBIA):
"RTN","XMUT5Q1",4,0)
 ; OPTION   XMMGR-DELIVERY-STATS-COLL
"RTN","XMUT5Q1",5,0)
 ;
"RTN","XMUT5Q1",6,0)
 ;R array is for responses
"RTN","XMUT5Q1",7,0)
 ;M array is for messages
"RTN","XMUT5Q1",8,0)
 ;
"RTN","XMUT5Q1",9,0)
 ;("T")=total
"RTN","XMUT5Q1",10,0)
 ;("N")=Not queued last check
"RTN","XMUT5Q1",11,0)
 ;("D")=[time stamped entries] = frequency ^ total time in queue
"RTN","XMUT5Q1",12,0)
 ;("O",I)=Oldest message for grouping I -- Up to 10 groupings
"RTN","XMUT5Q1",13,0)
 ;    1st piece is frequency, 2nd piece is time in queue
"RTN","XMUT5Q1",14,0)
 ;
"RTN","XMUT5Q1",15,0)
 ;Killing XMUT5NO causes the process to be tasked into background
"RTN","XMUT5Q1",16,0)
 K XMUT5NO
"RTN","XMUT5Q1",17,0)
 ;
"RTN","XMUT5Q1",18,0)
 ;GET GROUPINGS INTERACTIVELY
"RTN","XMUT5Q1",19,0)
0 K C S I=1 D GET^XMUT5Q Q:X[U  S C("MGROUPS")=X
"RTN","XMUT5Q1",20,0)
 S I=2 D GET^XMUT5Q Q:X[U  S C("RGROUPS")=X
"RTN","XMUT5Q1",21,0)
 G TASKED:$D(XMUT5NO)
"RTN","XMUT5Q1",22,0)
 ;
"RTN","XMUT5Q1",23,0)
1 W !!,"Run at 30-minute intervals !!",!!
"RTN","XMUT5Q1",24,0)
 ;I X["?" W !,"This is the interval that backgroud tasks will be rescheduled.",!,"Long intervals may not pick up any data.  Short intervals are best,",!,"because the times collected may be off by as much as the interval for the"
"RTN","XMUT5Q1",25,0)
 ;I  W !,"interval a message was in the queue for.  ENTER THE NUMBER OF SECONDS !"
"RTN","XMUT5Q1",26,0)
 ;I  G 1
"RTN","XMUT5Q1",27,0)
 ;I X'?1.N W "  Enter a time in seconds" G 1
"RTN","XMUT5Q1",28,0)
 ;I X<300 W "  Intervals must be at least 5 minutes apart." G 1
"RTN","XMUT5Q1",29,0)
 ;I X>1800 W "  Intervals must be less than 1/2 hour." G 1
"RTN","XMUT5Q1",30,0)
 S XMUT5S=X
"RTN","XMUT5Q1",31,0)
 ;
"RTN","XMUT5Q1",32,0)
2 R !!,"How many times do you want to analyze the message delivery queue: 4//",X:DTIME I X="" S XMUT5F=0 G GO
"RTN","XMUT5Q1",33,0)
 I X["?" W !,"The analysis will be automatically rescheduled this number of times." G 2
"RTN","XMUT5Q1",34,0)
 I X'?1.N!(X>9999999) W $C(7),!,"Type in a number between 0 and 9999999." G 2
"RTN","XMUT5Q1",35,0)
 S XMUT5F=X
"RTN","XMUT5Q1",36,0)
 ;
"RTN","XMUT5Q1",37,0)
TASKED ;Don't queue task if $D(XMUT5NO)
"RTN","XMUT5Q1",38,0)
 G GO:$D(XMUT5NO)
"RTN","XMUT5Q1",39,0)
 ;
"RTN","XMUT5Q1",40,0)
 W !!,"I am queuing this job to run on the next half-hour.  It will run every half-hour",!,"on the hour until the task is deleted or it is stopped by setting",!,"^XMBPOST(""XMUT5STOP"")=1."
"RTN","XMUT5Q1",41,0)
 K ^XMBPOST("XMUT5STOP") D ZTSK^XMUT5Q W !!,"QUEUED !!! TASK # "_ZTSK,!!
"RTN","XMUT5Q1",42,0)
 Q
"RTN","XMUT5Q1",43,0)
 ;
"RTN","XMUT5Q1",44,0)
GO S %=$G(^XMB(1,1,6)) I $L(%) S C("MGROUPS")=$P(%,"^"),C("RGROUPS")=$P(%,"^",2)
"RTN","XMUT5Q1",45,0)
GO2 ;
"RTN","XMUT5Q1",46,0)
 ;
"RTN","XMUT5Q1",47,0)
 ;Delete reschedule frequency just in case -- reschedules itself
"RTN","XMUT5Q1",48,0)
 S (DIE,DIC)="^DIC(19,",DIC(0)="",X="XMMGR-DELIVERY-STATS-COLL" D ^DIC
"RTN","XMUT5Q1",49,0)
 I Y>0 S DA=+Y,DR="202///@" D ^DIE
"RTN","XMUT5Q1",50,0)
 K DIC,DR,DIE
"RTN","XMUT5Q1",51,0)
 I '$D(ZTQUEUED) W !!,"Analysis of queue starts now !!!",!
"RTN","XMUT5Q1",52,0)
 S XMUT5=1 K A,B,M,R,RSP G ZTSK0^XMUT5Q:$D(^XMBPOST("XMUT5STOP"))
"RTN","XMUT5Q1",53,0)
 S (A,C,M,R)=0
"RTN","XMUT5Q1",54,0)
 F I="A","N","D","T",1:1:10 S:'I M(I)=0,R(I)=0 S:I M("O",I)=0,R("O",I)=0
"RTN","XMUT5Q1",55,0)
 S:'$D(XMUT5S) XMUT5S=1800 D ^XMUT5B
"RTN","XMUT5Q1",56,0)
QUIT ;End process
"RTN","XMUT5Q1",57,0)
 G QUIT^XMUT5Q
"RTN","XMUT5Q1",58,0)
NOTASK ;Run in foreground once
"RTN","XMUT5Q1",59,0)
 G NOTASK^XMUT5Q
"RTN","XMUT5Q1",60,0)
OPTION ;
"RTN","XMUT5Q1",61,0)
 D ^XMUT5B,REC^XMUT5Q
"RTN","XMUT5Q1",62,0)
 I $D(ZTQUEUED) S ZTRTN="OPTION^XMUT5Q1" D GO^XMUT5Q S ZTREQ="@" Q
"RTN","XMUT5Q1",63,0)
 W !!,"Stats collected.  If you would like them to be collected automatically",!
"RTN","XMUT5Q1",64,0)
 W !,"every 1/2 hour, please schedule this option via TaskMan.",!!
"RTN","XMUT5Q1",65,0)
 Q
"RTN","XMUT5R")
1^236
"RTN","XMUT5R1")
0^352^B4780533
"RTN","XMUT5R1",1,0)
XMUT5R1 ;(WASH ISC)/CAP-Mail Statistics Report ;05/28/2002  07:19
"RTN","XMUT5R1",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMUT5R1",3,0)
 ; Entry points used by MailMan options (not covered by DBIA):
"RTN","XMUT5R1",4,0)
 ; STATS   XMMGR-NEWMESS/LOGON-STATS
"RTN","XMUT5R1",5,0)
 ; 0       XMMGR-BKFILER-LONGTERM-STATS (not part of 8.0)
"RTN","XMUT5R1",6,0)
STATS ;
"RTN","XMUT5R1",7,0)
0 ;
"RTN","XMUT5R1",8,0)
 N XMEND,XMSTART,XMABORT
"RTN","XMUT5R1",9,0)
 S XMABORT=0
"RTN","XMUT5R1",10,0)
 D INIT(.XMSTART,.XMEND,.XMABORT) Q:XMABORT
"RTN","XMUT5R1",11,0)
 D REPORT(XMSTART,XMEND)
"RTN","XMUT5R1",12,0)
 Q
"RTN","XMUT5R1",13,0)
INIT(XMSTART,XMEND,XMABORT) ;
"RTN","XMUT5R1",14,0)
 N DIR,X,Y,DIRUT
"RTN","XMUT5R1",15,0)
 S XMEND=$$FMADD^XLFDT($E(DT,1,5)_"01",-1)  ; last day of last month
"RTN","XMUT5R1",16,0)
 S XMSTART=$E(XMEND,1,5)_"01"  ; first day of last month
"RTN","XMUT5R1",17,0)
 Q:$D(ZTQUEUED)
"RTN","XMUT5R1",18,0)
 S DIR("A")="START Date"
"RTN","XMUT5R1",19,0)
 S DIR("B")=$$FMTE^XLFDT(XMSTART,"2D")   ; MM/DD/YY
"RTN","XMUT5R1",20,0)
 S DIR(0)="D^:"_$$FMADD^XLFDT(DT,-1)_":EX"
"RTN","XMUT5R1",21,0)
 D ^DIR I $D(DIRUT) S XMABORT=1 Q
"RTN","XMUT5R1",22,0)
 S XMSTART=Y
"RTN","XMUT5R1",23,0)
 K X,Y,DIR,DIRUT
"RTN","XMUT5R1",24,0)
 S XMEND=$$FMADD^XLFDT(XMSTART,-1)
"RTN","XMUT5R1",25,0)
 S XMEND=$$SCH^XLFDT("1M",XMEND)       ; 1 month from XMSTART
"RTN","XMUT5R1",26,0)
 S DIR("A")="END Date"
"RTN","XMUT5R1",27,0)
 S DIR("B")=$$FMTE^XLFDT($$MIN^XLFMTH(XMEND,DT),"2D")   ; MM/DD/YY
"RTN","XMUT5R1",28,0)
 S DIR(0)="D^"_$$FMADD^XLFDT(XMSTART,+1)_":DT:EX"
"RTN","XMUT5R1",29,0)
 D ^DIR I $D(DIRUT) S XMABORT=1 Q
"RTN","XMUT5R1",30,0)
 S XMEND=Y
"RTN","XMUT5R1",31,0)
 Q
"RTN","XMUT5R1",32,0)
REPORT(XMA,XMB) ;
"RTN","XMUT5R1",33,0)
ZTSK ;Entry for Tasked report
"RTN","XMUT5R1",34,0)
 ;XMA=Start Date FM format
"RTN","XMUT5R1",35,0)
 ;XMAH=Start Date $H format
"RTN","XMUT5R1",36,0)
 ;XMB=End Date FM format
"RTN","XMUT5R1",37,0)
 ;XMBH=End Date $H format
"RTN","XMUT5R1",38,0)
 N XMC,XMD,XMV,BY,DIC,FLDS,FR,TO,L,X
"RTN","XMUT5R1",39,0)
 S X=XMB
"RTN","XMUT5R1",40,0)
 I '$D(ZTQUEUED) W !!,"Calling FileMan template ..."
"RTN","XMUT5R1",41,0)
 S XMD=$$FMTE^XLFDT(DT,"1D")  ; mmm dd, yyyy
"RTN","XMUT5R1",42,0)
 S XMC=$P(^XMB("NETNAME"),".")_" MailMan Activity Report"
"RTN","XMUT5R1",43,0)
 S XMV=^%ZOSF("PROD")
"RTN","XMUT5R1",44,0)
 S BY="[XMMGR-BKFILER-DAY@23:30]",FLDS="[XMMGR-BKFILER-LONGTERM-STATS]",FR=XMA,TO=XMB_".2359",DIC="^XMBX(4.2998,",L="Report on Statistics"
"RTN","XMUT5R1",45,0)
 S:$D(ZTQUEUED) IOP=ZTIO
"RTN","XMUT5R1",46,0)
 D EN1^DIP
"RTN","XMUT5R1",47,0)
 K DIS,XMA,XMB,XMAH,XMBH,X,Y,Z,%ZIS,ZTRTN,ZTSAVE,ZTDTH
"RTN","XMUT5R1",48,0)
 I '$D(ZTQUEUED) K ZTSK
"RTN","XMUT5R1",49,0)
 Q
"RTN","XMUT5R2")
0^353^B7682921
"RTN","XMUT5R2",1,0)
XMUT5R2 ;(WASH ISC)/CAP-Daily Reports on mail deliveries ;04/17/2002  12:07
"RTN","XMUT5R2",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMUT5R2",3,0)
 ; Entry points used by MailMan options (not covered by DBIA):
"RTN","XMUT5R2",4,0)
 ; ACT     XMMGR-BKFILER-ACT
"RTN","XMUT5R2",5,0)
 ; ASK     XMMGR-BKFILER-EDIT-NORMALIZED
"RTN","XMUT5R2",6,0)
 ; GROUP   XMMGR-BKFILER-GROUP
"RTN","XMUT5R2",7,0)
 ; STAT    XMMGR-BKFILER-STAT
"RTN","XMUT5R2",8,0)
 ; TAB     XMMGR-BKFILER-TABBED-STATS
"RTN","XMUT5R2",9,0)
 ; WAIT    XMMGR-BKFILER-WAIT
"RTN","XMUT5R2",10,0)
0 ;
"RTN","XMUT5R2",11,0)
 N Y
"RTN","XMUT5R2",12,0)
 S XMA=$$FMADD^XLFDT(DT,-1)
"RTN","XMUT5R2",13,0)
 I '$D(ZTQUEUED) S XMA=$$DATE("RUN",$$FMTE^XLFDT(XMA,"2Z")) Q:XMA=""
"RTN","XMUT5R2",14,0)
 S XMB=XMA_".2359"
"RTN","XMUT5R2",15,0)
 S Y=DT D DD^%DT S XMD=Y
"RTN","XMUT5R2",16,0)
 Q
"RTN","XMUT5R2",17,0)
GO ;Call FileMan to produce report
"RTN","XMUT5R2",18,0)
 S XMC=$P(^XMB("NETNAME"),".")_" "_L
"RTN","XMUT5R2",19,0)
 I '$D(ZTQUEUED) W !!,"Calling FileMan template ..."
"RTN","XMUT5R2",20,0)
 ;
"RTN","XMUT5R2",21,0)
 ;XMA=Start Date FM format
"RTN","XMUT5R2",22,0)
 ;XMAH=Start Date $H format
"RTN","XMUT5R2",23,0)
 ;XMB=End Date FM format
"RTN","XMUT5R2",24,0)
 ;XMBH=End Date $H format
"RTN","XMUT5R2",25,0)
 S XMV=^%ZOSF("PROD")
"RTN","XMUT5R2",26,0)
 S:'$D(BY) BY=.01 S FR=XMA,TO=XMB,DIC="^XMBX(4.2998,"
"RTN","XMUT5R2",27,0)
 S:$D(ZTQUEUED) IOP=ZTIO D EN1^DIP
"RTN","XMUT5R2",28,0)
Q ;
"RTN","XMUT5R2",29,0)
 K BY,DIC,DIS,FLDS,FROM,TO,XMA,XMB,XMAH,XMBH,X,Y,Z,%ZIS,ZTRTN,ZTSAVE,ZTDTH
"RTN","XMUT5R2",30,0)
 I '$D(ZTQUEUED) K ZTSK
"RTN","XMUT5R2",31,0)
 Q
"RTN","XMUT5R2",32,0)
DATE(X,Z) ;Calculate Date - Ask Start and End Dates
"RTN","XMUT5R2",33,0)
 N DUOUT,DTOUT,XMA,DIR,Y S DIR(0)="D^::XEP",DIR("A")=X_" Date",DIR("B")=Z
"RTN","XMUT5R2",34,0)
D D ^DIR K DIRUT I $D(DUOUT)!$D(DTOUT) Q ""
"RTN","XMUT5R2",35,0)
 S XMA=Y I XMA'?7N.E D ^%DT X XMA=Y
"RTN","XMUT5R2",36,0)
 D NOW^%DTC I %-XMA<0 W !,$C(7)," No Future Dates !!!" G D
"RTN","XMUT5R2",37,0)
 Q XMA
"RTN","XMUT5R2",38,0)
ACT ;Active Users verses Deliveries Report
"RTN","XMUT5R2",39,0)
 D 0 Q:XMA=""  K BY
"RTN","XMUT5R2",40,0)
 S FLDS="[XMMGR-BKFILER-ACTIVE_USERS/DEL]",L="Active Users/Deliveries Report"
"RTN","XMUT5R2",41,0)
 G GO
"RTN","XMUT5R2",42,0)
GROUP ;Deliveries by group
"RTN","XMUT5R2",43,0)
 D 0 Q:XMA=""  K BY
"RTN","XMUT5R2",44,0)
 S FLDS="[XMMGR-BKFILER-DEL_BY_GROUP]",L="Deliveries by Group Report"
"RTN","XMUT5R2",45,0)
 G GO
"RTN","XMUT5R2",46,0)
QUEUE ;Queue Length
"RTN","XMUT5R2",47,0)
 D 0 Q:XMA=""  K BY
"RTN","XMUT5R2",48,0)
 S FLDS="[XMMGR-BKFILER-LENGTH_OF_QUEUES]",L="Length of Delivery Queues Report"
"RTN","XMUT5R2",49,0)
 G GO
"RTN","XMUT5R2",50,0)
WAIT ;Queue Wait
"RTN","XMUT5R2",51,0)
 D 0 Q:XMA=""  K BY
"RTN","XMUT5R2",52,0)
 S FLDS="[XMMGR-BKFILER-QUEUE-WAIT]",L="Active Users/Deliveries Report"
"RTN","XMUT5R2",53,0)
 G GO
"RTN","XMUT5R2",54,0)
STAT ;Statistics / Active Users, Deliveries, Queue Wait, Response Time
"RTN","XMUT5R2",55,0)
 D 0 Q:XMA=""  K BY
"RTN","XMUT5R2",56,0)
 S FLDS="[XMMGR-BKFILER-STATS-PLUS]",L="Statistics Report"
"RTN","XMUT5R2",57,0)
 G GO
"RTN","XMUT5R2",58,0)
TAB ;Statistics for download to graphics package
"RTN","XMUT5R2",59,0)
 D 0 Q:XMA=""  S BY="@.01"
"RTN","XMUT5R2",60,0)
 S FLDS="[XMMGR-BKFILER-STATS/TABBED]",L=""
"RTN","XMUT5R2",61,0)
 G GO
"RTN","XMUT5R2",62,0)
ASK ;Ask parameters
"RTN","XMUT5R2",63,0)
 N DIRUT F X=1:1:5 S A=$$ASS(X) Q:$D(DIRUT)  S $P(^XMB(1,1,7),",",X)=A
"RTN","XMUT5R2",64,0)
 Q
"RTN","XMUT5R2",65,0)
ASS(I) N DIR,X,Y,Z
"RTN","XMUT5R2",66,0)
 S X=$P("Active Users,Lines Displayed,Message & Response Deliveries,Queue Lengths,Response Time",",",I)
"RTN","XMUT5R2",67,0)
 S DIR(0)="N^.1:9999999999",DIR("A")="Enter normalized "_X,DIR("B")=$P($G(^XMB(1,1,7)),",",I)
"RTN","XMUT5R2",68,0)
 D ^DIR
"RTN","XMUT5R2",69,0)
 Q X
"RTN","XMUT6")
0^354^B4028377
"RTN","XMUT6",1,0)
XMUT6 ;(WASH ISC)/CAP-Check delivery queue ;04/17/2002  12:07
"RTN","XMUT6",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMUT6",3,0)
 W !!,"Checking Delivery Queue: " S %H=$H D YX^%DTC W Y
"RTN","XMUT6",4,0)
 D GO^XMUT5B I M("T")+R("T")<1 W !!,"NOTHING IS IN THE DELIVERY QUEUE !!" Q
"RTN","XMUT6",5,0)
 ;
"RTN","XMUT6",6,0)
GO ;Go through the queues and see if the data in them is correct
"RTN","XMUT6",7,0)
 K M,R,T
"RTN","XMUT6",8,0)
 S (M,R,T,M("D"),R("D"),T("D"))=0 F I=1:1:10 S (M(I),M("D",I),R(I),R("D",I))=0
"RTN","XMUT6",9,0)
 F I="M","R" F J=1:1:10 D COUNT
"RTN","XMUT6",10,0)
 W !!,"Total items Waiting to be delivered: ",T
"RTN","XMUT6",11,0)
 W !,"Messages: "_M,"   Responses: "_R
"RTN","XMUT6",12,0)
 W !,"Message Deliveries: "_M("D")_"   Response Deliveries: "_R("D")
"RTN","XMUT6",13,0)
 I M>0 W !!,"Message Group      # Messages    # Deliveries"
"RTN","XMUT6",14,0)
 I  F I=1:1:10 Q:'$D(M(I))  W !,?5,I,?25,M(I),?40,M("D",I),?53
"RTN","XMUT6",15,0)
 I R>0 W !!,"Response Group     # Responses   # Deliveries"
"RTN","XMUT6",16,0)
 I  F I=1:1:10 Q:'$D(R(I))  W !,?5,I,?25,R(I),?40,R("D",I),?53
"RTN","XMUT6",17,0)
Q D ^XMUT5
"RTN","XMUT6",18,0)
 Q
"RTN","XMUT6",19,0)
 ;
"RTN","XMUT6",20,0)
 ;Count the actual stuff in the queues
"RTN","XMUT6",21,0)
COUNT S (A,B,C)=0 ; I=group, J=queue, A=timestamp, B=id
"RTN","XMUT6",22,0)
A S A=$O(^XMBPOST(I,J,A)) Q:A'>0  S B=""
"RTN","XMUT6",23,0)
B S B=$O(^XMBPOST(I,J,A,B)) G A:B=""
"RTN","XMUT6",24,0)
 ;
"RTN","XMUT6",25,0)
 ;Messages
"RTN","XMUT6",26,0)
 I I="R" S C="" G C
"RTN","XMUT6",27,0)
 I B[U D FWD
"RTN","XMUT6",28,0)
 E  S %=+$G(^(B))
"RTN","XMUT6",29,0)
 S T=T+1,M=M+1,M(J)=M(J)+1,M("D")=M("D")+%,M("D",J)=M("D",J)+%,T("D")=T("D")+%
"RTN","XMUT6",30,0)
 G B
"RTN","XMUT6",31,0)
 ;
"RTN","XMUT6",32,0)
 ;Responses
"RTN","XMUT6",33,0)
C S C=$O(^XMBPOST(I,J,A,B,C)) G B:C="" S %=+$G(^(C)) G C:'%
"RTN","XMUT6",34,0)
 S T=T+1,R=R+1,R(J)=R(J)+1,R("D")=R("D")+%,R("D",J)=R("D",J)+%,T("D")=T("D")+%
"RTN","XMUT6",35,0)
 G C
"RTN","XMUT6",36,0)
 ;
"RTN","XMUT6",37,0)
 ;Sum up forwards
"RTN","XMUT6",38,0)
FWD S (%,K)=0 F  S K=$O(^XMBPOST("FWD",B_U_A,K)) Q:'K  S %=%+$L($G(^(K)),U)
"RTN","XMUT6",39,0)
 Q
"RTN","XMUT6",40,0)
MOVE ;Move queue 1 to queue 3
"RTN","XMUT6",41,0)
 S A="^XMBPOST(""R"",1)",B=0
"RTN","XMUT6",42,0)
MA S A=$Q(@A) Q:$P(A,$C(34),2)'="R"
"RTN","XMUT6",43,0)
 S B=B+1 G MA:B<2 S C=@A,D=A,$P(D,",",2)=3,@D=C K @A G MA
"RTN","XMUT6",44,0)
 ;
"RTN","XMUT6",45,0)
KILL ;Kill off X-ref of Responses
"RTN","XMUT6",46,0)
 S A="R"
"RTN","XMUT6",47,0)
KA S A=$O(^XMBPOST("R",A)) Q:A=""  W A,"  " K ^(A) G KA
"RTN","XMUT7")
0^82^B651942
"RTN","XMUT7",1,0)
XMUT7 ;ISC-SF/GMB-Send Message to Forwarding Address ;04/17/2002  12:08
"RTN","XMUT7",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMUT7",3,0)
 ; Was (WASH ISC)/CAP
"RTN","XMUT7",4,0)
 ;
"RTN","XMUT7",5,0)
 ; Entry points covered by DBIA 1132:
"RTN","XMUT7",6,0)
 ; ENT   Send bulletin to check forwarding address.
"RTN","XMUT7",7,0)
ENT(XMUSER) ; Send bulletin to check forwarding address.
"RTN","XMUT7",8,0)
 ; See DD for file 3.7, field 2
"RTN","XMUT7",9,0)
 ; XMUSER - DUZ of user, whose forwarding address we are checking.
"RTN","XMUT7",10,0)
 N XMPARM,XMINSTR,XMTO
"RTN","XMUT7",11,0)
 S XMINSTR("FROM")=.5
"RTN","XMUT7",12,0)
 S XMPARM(1)=$$NAME^XMXUTIL(XMUSER)
"RTN","XMUT7",13,0)
 S XMPARM(2)=$P(^XMB(3.7,XMUSER,0),U,2) Q:XMPARM(2)=""
"RTN","XMUT7",14,0)
 S XMTO(XMPARM(2))=""
"RTN","XMUT7",15,0)
 I '+$G(^XMB(1,1,"FORWARD")) S XMTO(.5)=""
"RTN","XMUT7",16,0)
 D TASKBULL^XMXBULL(.5,"XM FWD ADDRESS CHECK",.XMPARM,"",.XMTO,.XMINSTR)
"RTN","XMUT7",17,0)
 Q
"RTN","XMUTASK")
1^237
"RTN","XMUTCOM1")
0^355^B6233052
"RTN","XMUTCOM1",1,0)
XMUTCOM1 ;(WASH ISC)/CAP-XMUSRCNT.COM Count users (shareware) ;04/17/2002  12:10
"RTN","XMUTCOM1",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMUTCOM1",3,0)
ZZZ ;$!USERS.COM
"RTN","XMUTCOM1",4,0)
 ;;$!            milt's special
"RTN","XMUTCOM1",5,0)
 ;;$ set noon
"RTN","XMUTCOM1",6,0)
 ;;$ ANS="N"
"RTN","XMUTCOM1",7,0)
 ;;$ pur/nolog leeuser.log
"RTN","XMUTCOM1",8,0)
 ;;$! del/nolog u1*.tmp.*,u2*.tmp.*
"RTN","XMUTCOM1",9,0)
 ;;$! say " Scanning VMS interactive users..............."
"RTN","XMUTCOM1",10,0)
 ;;$ SH USER/INTER/full/OUTPUT=U1.TMP
"RTN","XMUTCOM1",11,0)
 ;;$! say " Scanning VMS batch users (ZSLOT) ............"
"RTN","XMUTCOM1",12,0)
 ;;$ SH USER/BATCH/full/OUTPUT=U2.TMP
"RTN","XMUTCOM1",13,0)
 ;;$ search/output=u11.tmp u1.tmp forum
"RTN","XMUTCOM1",14,0)
 ;;$ search/output=u22.tmp u2.tmp bf
"RTN","XMUTCOM1",15,0)
 ;;$ search/output=u222.tmp u22.tmp op_/match=nor
"RTN","XMUTCOM1",16,0)
 ;;$ APPEND U222.TMP U11.TMP
"RTN","XMUTCOM1",17,0)
 ;;$ cnt=0
"RTN","XMUTCOM1",18,0)
 ;;$ bfcnt=0
"RTN","XMUTCOM1",19,0)
 ;;$ open/read a U11.TMP
"RTN","XMUTCOM1",20,0)
 ;;$READ_LOOP:    !read USERS.tmp and start extracting what we need
"RTN","XMUTCOM1",21,0)
 ;;$ read/end=eof/error=error a line
"RTN","XMUTCOM1",22,0)
 ;;$ if f$extract(0,1,ans) .nes. ""  then goto next_step
"RTN","XMUTCOM1",23,0)
 ;;$! say line
"RTN","XMUTCOM1",24,0)
 ;;$ next_step:
"RTN","XMUTCOM1",25,0)
 ;;$ if f$extract(1,2,line) .eqs. "BF" then bfcnt=bfcnt+1
"RTN","XMUTCOM1",26,0)
 ;;$ cnt=cnt+1
"RTN","XMUTCOM1",27,0)
 ;;$ goto read_loop
"RTN","XMUTCOM1",28,0)
 ;;$ next_one:
"RTN","XMUTCOM1",29,0)
 ;;$EOF:   !end of file
"RTN","XMUTCOM1",30,0)
 ;;$ close a
"RTN","XMUTCOM1",31,0)
 ;;$ set ver
"RTN","XMUTCOM1",32,0)
 ;;$ open/append a XMUSRCNT.sav
"RTN","XMUTCOM1",33,0)
 ;;$ vmscnt=cnt-bfcnt
"RTN","XMUTCOM1",34,0)
 ;;$ time_stamp=f$time()
"RTN","XMUTCOM1",35,0)
 ;;$ scnt=f$string(cnt)
"RTN","XMUTCOM1",36,0)
 ;;$ svmscnt=f$string(vmscnt)
"RTN","XMUTCOM1",37,0)
 ;;$ sbfcnt=f$string(bfcnt)
"RTN","XMUTCOM1",38,0)
 ;;$ usercnt="''scnt',''sbfcnt',''svmscnt',''time_stamp'"
"RTN","XMUTCOM1",39,0)
 ;;$ write a "*****************************************************"
"RTN","XMUTCOM1",40,0)
 ;;$ write a time_stamp
"RTN","XMUTCOM1",41,0)
 ;;$ write a " VMS logins = "'VMSCNT'"."
"RTN","XMUTCOM1",42,0)
 ;;$ write a " VMS Batch jobs running = "'bfcnt'"."
"RTN","XMUTCOM1",43,0)
 ;;$ write a " TOTAL Interactive and Batch users = "'CNT'"."
"RTN","XMUTCOM1",44,0)
 ;;$ write a ''usercnt'
"RTN","XMUTCOM1",45,0)
 ;;$ close a
"RTN","XMUTCOM1",46,0)
 ;;$ purge/nolog leeuser.sav
"RTN","XMUTCOM1",47,0)
 ;;$ delete/nolog U1*.TMP.*,U2*.TMP.*
"RTN","XMUTCOM1",48,0)
 ;;$ dsm/envir=mgrmail/data="''usercnt'" ENUSER^XMUT5Q
"RTN","XMUTCOM1",49,0)
 ;;$! submit/que=forum7_batch XMUSRCNT.COM
"RTN","XMUTCOM1",50,0)
 ;;$ set nover
"RTN","XMUTCOM1",51,0)
 ;;$ exit
"RTN","XMUTCOM1",52,0)
 ;;$ERROR:
"RTN","XMUTCOM1",53,0)
 ;;$ say "Error has occurred during processing."
"RTN","XMUTCOM1",54,0)
 ;;$ SAY " "
"RTN","XMUTCOM1",55,0)
 ;;$! goto eof
"RTN","XMUTCOM1",56,0)
 ;;$exit
"RTN","XMUTERM")
0^356^B30239309
"RTN","XMUTERM",1,0)
XMUTERM ;ISC-SF/GMB-Delete Mailbox/Delete Message ;04/17/2002  12:08
"RTN","XMUTERM",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMUTERM",3,0)
 ; Taken from XUSTERM (SEA/AMF/WDE)
"RTN","XMUTERM",4,0)
 ; Entry points used by MailMan options (not covered by DBIA):
"RTN","XMUTERM",5,0)
 ; ALL1     XMMGR-TERMINATE-MANY
"RTN","XMUTERM",6,0)
 ; ALL2     XMMGR-TERMINATE-SUGGEST
"RTN","XMUTERM",7,0)
 ; CHOOSE   XMMGR-TERMINATE-ONE
"RTN","XMUTERM",8,0)
 ; MESSAGE  XMMGR-PURGE-MESSAGE
"RTN","XMUTERM",9,0)
MESSAGE ; Manager chooses messages to purge
"RTN","XMUTERM",10,0)
 N DIR,XMABORT,XMZ,XMKILL,XMPARM
"RTN","XMUTERM",11,0)
 Q:$$NOTAUTH()
"RTN","XMUTERM",12,0)
 W @IOF
"RTN","XMUTERM",13,0)
 D BLD^DIALOG(36301,"","","","F")
"RTN","XMUTERM",14,0)
 D MSG^DIALOG("WM","",IOM)
"RTN","XMUTERM",15,0)
 ;This option enables you to purge any message.
"RTN","XMUTERM",16,0)
 ;Purge means:
"RTN","XMUTERM",17,0)
 ;-delete the message from all user mailboxes
"RTN","XMUTERM",18,0)
 ;-delete the message from the MESSAGE file ^XMB(3.9
"RTN","XMUTERM",19,0)
 ;-delete all responses from the MESSAGE file ^XMB(3.9
"RTN","XMUTERM",20,0)
 ;-delete the message from the MESSAGES TO BE NEW AT A LATER DATE file ^XMB(3.73
"RTN","XMUTERM",21,0)
 ;Purge is not reversible.  The message is gone forever.
"RTN","XMUTERM",22,0)
 F  S XMZ=$O(^XMB(3.9,":"),-1) Q:XMZ?1N.N  K ^XMB(3.9,XMZ) ; kill bogus nodes
"RTN","XMUTERM",23,0)
 S (XMABORT,XMKILL)=0
"RTN","XMUTERM",24,0)
 F  D  Q:XMABORT
"RTN","XMUTERM",25,0)
 . W !
"RTN","XMUTERM",26,0)
 . S DIR(0)="NO^1:"_$O(^XMB(3.9,":"),-1)_":0^D CHKMSG^XMUTERM(Y)",DIR("A")=$$EZBLD^DIALOG(36302) ; Purge MESSAGE
"RTN","XMUTERM",27,0)
 . S DIR("?")=$$EZBLD^DIALOG(36303) ; This response must be a message number
"RTN","XMUTERM",28,0)
 . D ^DIR K DIR I $D(DIRUT) S XMABORT=1 Q
"RTN","XMUTERM",29,0)
 . S XMZ=+Y
"RTN","XMUTERM",30,0)
 . S DIR(0)="Y",DIR("A")=$$EZBLD^DIALOG(36304),DIR("B")=$$EZBLD^DIALOG(39053) ; Are you sure / NO
"RTN","XMUTERM",31,0)
 . D ^DIR K DIR I 'Y!$D(DIRUT) W !,$$EZBLD^DIALOG(36305) Q  ;Message not purged.
"RTN","XMUTERM",32,0)
 . S (XMKILL("MSG"),XMKILL("RESP"))=0
"RTN","XMUTERM",33,0)
 . D KILL^XMA32A(XMZ,.XMKILL,XMABORT)
"RTN","XMUTERM",34,0)
 . S XMPARM(1)=XMKILL("MSG"),XMPARM(2)=XMKILL("RESP")
"RTN","XMUTERM",35,0)
 . W !!,$$EZBLD^DIALOG(36306,.XMPARM) ; XMKILL("MSG") message and XMKILL("RESP") response(s) purged.
"RTN","XMUTERM",36,0)
 . S XMKILL=XMKILL+XMKILL("MSG")+XMKILL("RESP")
"RTN","XMUTERM",37,0)
 Q
"RTN","XMUTERM",38,0)
CHKMSG(XMZ) ;
"RTN","XMUTERM",39,0)
 I '$D(^XMB(3.9,XMZ)) K X Q
"RTN","XMUTERM",40,0)
 W "  ",$P($G(^XMB(3.9,XMZ,0)),U,1)
"RTN","XMUTERM",41,0)
 Q
"RTN","XMUTERM",42,0)
ALL1 ; MailMan chooses users to remove from MailMan
"RTN","XMUTERM",43,0)
 ; (Users who shouldn't have mailboxes.)
"RTN","XMUTERM",44,0)
 N XMTEST,DIR,XMABORT,XMCUTOFF,XMGRACE
"RTN","XMUTERM",45,0)
 Q:$$NOTAUTH()
"RTN","XMUTERM",46,0)
 S XMABORT=0
"RTN","XMUTERM",47,0)
 W @IOF
"RTN","XMUTERM",48,0)
 D BLD^DIALOG(36309,"","","","F")
"RTN","XMUTERM",49,0)
 ;This option goes through the MailBox global and deletes the user's mailbox if
"RTN","XMUTERM",50,0)
 D HELP1
"RTN","XMUTERM",51,0)
 D BLD^DIALOG(36309.5,"","","","F")
"RTN","XMUTERM",52,0)
 ;However, if the user meets one of the last two conditions above, but has a
"RTN","XMUTERM",53,0)
 ;forwarding address, the user's mailbox will not be deleted.  The fact will be
"RTN","XMUTERM",54,0)
 ;noted, and the user should be investigated further.  
"RTN","XMUTERM",55,0)
 ;
"RTN","XMUTERM",56,0)
 D MSG^DIALOG("WM","",IOM)
"RTN","XMUTERM",57,0)
 D CUTOFF(1,.XMGRACE,.XMCUTOFF,.XMABORT) Q:XMABORT
"RTN","XMUTERM",58,0)
 S DIR(0)="SO^"_$$EZBLD^DIALOG(36321)_";"_$$EZBLD^DIALOG(36322) ; T:Test Mode only;R:Real Mode
"RTN","XMUTERM",59,0)
 S DIR("B")=$P($$EZBLD^DIALOG(36321),":",2) ; Test Mode only
"RTN","XMUTERM",60,0)
 S DIR("A")=$$EZBLD^DIALOG(36323) ; Select Run Option
"RTN","XMUTERM",61,0)
 D BLD^DIALOG(36324,"","","DIR(""?"")","F")
"RTN","XMUTERM",62,0)
 ;'Real Mode' will remove qualifying users from MailMan.
"RTN","XMUTERM",63,0)
 ;'Test Mode' will not.
"RTN","XMUTERM",64,0)
 ;Select 'Test Mode' to see who would be removed.
"RTN","XMUTERM",65,0)
 ;Select 'Real Mode' to remove them.
"RTN","XMUTERM",66,0)
 D ^DIR Q:$D(DIRUT)
"RTN","XMUTERM",67,0)
 S XMTEST=$S(X="R":0,1:1)
"RTN","XMUTERM",68,0)
 S (ZTSAVE("XMTEST"),ZTSAVE("XMCUTOFF"),ZTSAVE("XMGRACE"))=""
"RTN","XMUTERM",69,0)
 W !
"RTN","XMUTERM",70,0)
 D BLD^DIALOG(36325,"","","","F")
"RTN","XMUTERM",71,0)
 D MSG^DIALOG("WM","",IOM)
"RTN","XMUTERM",72,0)
 ;This report may take a while.  You might consider spooling it.
"RTN","XMUTERM",73,0)
 D EN^XUTMDEVQ("ALL1TASK^XMUTERM1",$$EZBLD^DIALOG(36326),.ZTSAVE) ; MailMan: Remove user Mailboxes
"RTN","XMUTERM",74,0)
 Q
"RTN","XMUTERM",75,0)
ALL2 ; MailMan reports on users who maybe should be removed from MailMan
"RTN","XMUTERM",76,0)
 ; (Users who haven't logged on in a while.)
"RTN","XMUTERM",77,0)
 N XMTEST,DIR,XMABORT,XMCUTOFF,XMGRACE
"RTN","XMUTERM",78,0)
 Q:$$NOTAUTH()
"RTN","XMUTERM",79,0)
 S XMABORT=0
"RTN","XMUTERM",80,0)
 W @IOF
"RTN","XMUTERM",81,0)
 D BLD^DIALOG(36312,"","","","F")
"RTN","XMUTERM",82,0)
 ;This option goes through the MailBox global and reports if
"RTN","XMUTERM",83,0)
 D HELP2
"RTN","XMUTERM",84,0)
 D BLD^DIALOG(36314,"","","","F")
"RTN","XMUTERM",85,0)
 ;This option does not delete any mailboxes.  Use the XM-TERMINATE-ONE-USER
"RTN","XMUTERM",86,0)
 ;option to delete any user mailboxes identified in this report.
"RTN","XMUTERM",87,0)
 D MSG^DIALOG("WM","",IOM)
"RTN","XMUTERM",88,0)
 D CUTOFF(2,.XMGRACE,.XMCUTOFF,.XMABORT) Q:XMABORT
"RTN","XMUTERM",89,0)
 S ZTSAVE("XMCUTOFF")=""
"RTN","XMUTERM",90,0)
 W !
"RTN","XMUTERM",91,0)
 D BLD^DIALOG(36325,"","","","F")
"RTN","XMUTERM",92,0)
 D MSG^DIALOG("WM","",IOM)
"RTN","XMUTERM",93,0)
 ;This report may take a while.  You might consider spooling it.
"RTN","XMUTERM",94,0)
 D EN^XUTMDEVQ("ALL2TASK^XMUTERM1",$$EZBLD^DIALOG(36327),.ZTSAVE) ; MailMan: Suggest Remove user Mailboxes
"RTN","XMUTERM",95,0)
 Q
"RTN","XMUTERM",96,0)
NOTAUTH() ;
"RTN","XMUTERM",97,0)
 Q:$D(^XUSEC("XMMGR",DUZ)) 0
"RTN","XMUTERM",98,0)
 W !,$C(7)
"RTN","XMUTERM",99,0)
 D BLD^DIALOG(36300,"","","","F")
"RTN","XMUTERM",100,0)
 D MSG^DIALOG("WE","",IOM)
"RTN","XMUTERM",101,0)
 ;You must hold the XMMGR key to run this option.
"RTN","XMUTERM",102,0)
 Q 1
"RTN","XMUTERM",103,0)
HELP1 ;
"RTN","XMUTERM",104,0)
 D BLD^DIALOG(36311,"","","","SF")
"RTN","XMUTERM",105,0)
 ;- the user is not in the NEW PERSON file.
"RTN","XMUTERM",106,0)
 ;- the user has no access code and was not terminated.
"RTN","XMUTERM",107,0)
 ;- the user has no access code and was terminated w/o mailbox retention.
"RTN","XMUTERM",108,0)
 ;- the user has an access code, but no primary menu.
"RTN","XMUTERM",109,0)
 ;- the user has an access code and primary menu, but no verify code AND
"RTN","XMUTERM",110,0)
 ;  - has never signed on or used mail, since being added before a cutoff date.
"RTN","XMUTERM",111,0)
 ;  OR
"RTN","XMUTERM",112,0)
 ;  - last signed on or used mail before a cutoff date.
"RTN","XMUTERM",113,0)
 ;'Delete mailbox' includes:
"RTN","XMUTERM",114,0)
 ;- Delete user's private mail groups
"RTN","XMUTERM",115,0)
 ;- Remove user from membership in any group
"RTN","XMUTERM",116,0)
 ;- Remove user as authorized sender from any group
"RTN","XMUTERM",117,0)
 ;- Remove user from anyone's list of surrogates
"RTN","XMUTERM",118,0)
 ;- Delete user's mailbox
"RTN","XMUTERM",119,0)
 ;As a result, the user will not receive any mail.
"RTN","XMUTERM",120,0)
 Q
"RTN","XMUTERM",121,0)
HELP2 ;
"RTN","XMUTERM",122,0)
 D BLD^DIALOG(36313,"","","","SF")
"RTN","XMUTERM",123,0)
 ;- the user was DISUSER'd.
"RTN","XMUTERM",124,0)
 ;- the user was terminated before a cutoff date and allowed to keep a mailbox.
"RTN","XMUTERM",125,0)
 ;- the user has an access code, verify code, and primary menu, AND
"RTN","XMUTERM",126,0)
 ;  - has never signed on or used mail, since being added before a cutoff date.
"RTN","XMUTERM",127,0)
 ;  OR
"RTN","XMUTERM",128,0)
 ;  - last signed on or used mail before a cutoff date.
"RTN","XMUTERM",129,0)
 Q
"RTN","XMUTERM",130,0)
CUTOFF(XMWHICH,XMGRACE,XMCUTOFF,XMABORT) ;
"RTN","XMUTERM",131,0)
 N DIR
"RTN","XMUTERM",132,0)
 W !
"RTN","XMUTERM",133,0)
 S XMGRACE=$$FMADD^XLFDT(DT,-30)
"RTN","XMUTERM",134,0)
 S DIR(0)="D^:"_XMGRACE_":EP"
"RTN","XMUTERM",135,0)
 S DIR("A")=$$EZBLD^DIALOG(36315) ; Logon cutoff date
"RTN","XMUTERM",136,0)
 S DIR("B")=$$FMTE^XLFDT(DT-10000)
"RTN","XMUTERM",137,0)
 S DIR("??")="^D HCUTOFF^XMUTERM(XMWHICH)"
"RTN","XMUTERM",138,0)
 D ^DIR I $D(DIRUT) S XMABORT=1 Q
"RTN","XMUTERM",139,0)
 S XMCUTOFF=Y
"RTN","XMUTERM",140,0)
 Q
"RTN","XMUTERM",141,0)
HCUTOFF(XMWHICH) ;
"RTN","XMUTERM",142,0)
 D BLD^DIALOG(36316,"","","","F")
"RTN","XMUTERM",143,0)
 ;The cutoff date must be more than 30 days ago.
"RTN","XMUTERM",144,0)
 ;It is used during the check to see if
"RTN","XMUTERM",145,0)
 I XMWHICH="*"!(XMWHICH=1) D
"RTN","XMUTERM",146,0)
 . D BLD^DIALOG(36317,"","","","SF")
"RTN","XMUTERM",147,0)
 . ;- the user has an access code and primary menu, but no verify code, AND
"RTN","XMUTERM",148,0)
 . ;  - has never signed on or used mail, since being added before a cutoff date.
"RTN","XMUTERM",149,0)
 . ;  OR
"RTN","XMUTERM",150,0)
 . ;  - last signed on or used mail before a cutoff date.
"RTN","XMUTERM",151,0)
 I XMWHICH="*"!(XMWHICH=2) D
"RTN","XMUTERM",152,0)
 . D BLD^DIALOG(36318,"","","","SF")
"RTN","XMUTERM",153,0)
 . ;- the user has an access code, verify code, and primary menu, AND
"RTN","XMUTERM",154,0)
 . ;  - has never signed on or used mail, since being added before a cutoff date.
"RTN","XMUTERM",155,0)
 . ;  OR
"RTN","XMUTERM",156,0)
 . ;  - last signed on or used mail before a cutoff date.
"RTN","XMUTERM",157,0)
 D BLD^DIALOG(36319,"","","","F")
"RTN","XMUTERM",158,0)
 ;(If you do not wish to check mailboxes based on a cutoff date, enter '1900'.)
"RTN","XMUTERM",159,0)
 ;Please enter that cutoff date.
"RTN","XMUTERM",160,0)
 D MSG^DIALOG("WH","",IOM)
"RTN","XMUTERM",161,0)
 Q
"RTN","XMUTERM",162,0)
CHOOSE ; Manager chooses user to remove from MailMan
"RTN","XMUTERM",163,0)
 N XMCUTOFF,XMABORT,XMI,XMGRACE
"RTN","XMUTERM",164,0)
 S XMABORT=0
"RTN","XMUTERM",165,0)
 Q:$$NOTAUTH()
"RTN","XMUTERM",166,0)
 W @IOF
"RTN","XMUTERM",167,0)
 D BLD^DIALOG(36310,"","","","F")
"RTN","XMUTERM",168,0)
 ;This option lets you delete the mailbox of a user if
"RTN","XMUTERM",169,0)
 D HELP2
"RTN","XMUTERM",170,0)
 D HELP1
"RTN","XMUTERM",171,0)
 D MSG^DIALOG("WM","",IOM)
"RTN","XMUTERM",172,0)
 D CUTOFF("*",.XMGRACE,.XMCUTOFF,.XMABORT) Q:XMABORT
"RTN","XMUTERM",173,0)
 N DIR
"RTN","XMUTERM",174,0)
 S DIR(0)="SO^"_$$EZBLD^DIALOG(36330) ; M:MailMan presents;I:I select
"RTN","XMUTERM",175,0)
 D BLD^DIALOG(36332,"","","DIR(""?"")","F")
"RTN","XMUTERM",176,0)
 ;Select 'M' if you want MailMan to $order through the MailBox file and
"RTN","XMUTERM",177,0)
 ;present to you candidates for mailbox deletion.
"RTN","XMUTERM",178,0)
 ;Select 'I' if you want to do the selection directly.
"RTN","XMUTERM",179,0)
 D ^DIR Q:$D(DIRUT)
"RTN","XMUTERM",180,0)
 I Y="M" D MMCHOOSE^XMUTERM2(XMGRACE,XMCUTOFF) Q
"RTN","XMUTERM",181,0)
 D ICHOOSE^XMUTERM2(XMGRACE,XMCUTOFF)
"RTN","XMUTERM",182,0)
 Q
"RTN","XMUTERM1")
0^83^B64992482
"RTN","XMUTERM1",1,0)
XMUTERM1 ;ISC-SF/GMB-Delete Mailbox (cont.) ;04/17/2002  12:09
"RTN","XMUTERM1",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMUTERM1",3,0)
 ; Taken from XUSTERM (SEA/AMF/WDE)
"RTN","XMUTERM1",4,0)
ALL1TASK ; Deletions
"RTN","XMUTERM1",5,0)
 N XMI,XMABORT,XMTERM,XMNAME,XMWHY,XMCUTEXT,XMLEN,XMCNT,XMADDED,XMAC,XMVC,XMPM,XMLASTON,XMTDATE,XMDELM,XMTOTAL,XMNEW,XMFWD,XMYES
"RTN","XMUTERM1",6,0)
 S XMYES=$$EZBLD^DIALOG(39054.1) ; Y
"RTN","XMUTERM1",7,0)
 S XMCUTEXT=$$FMTE^XLFDT(XMCUTOFF,"2DF")
"RTN","XMUTERM1",8,0)
 S XMLEN=$L($P(^VA(200,0),U,3))
"RTN","XMUTERM1",9,0)
 S (XMCNT,XMABORT,XMTOTAL)=0
"RTN","XMUTERM1",10,0)
 W:IOST["C-" @IOF D HEADER1
"RTN","XMUTERM1",11,0)
 S XMI=.999
"RTN","XMUTERM1",12,0)
 F  S XMI=$O(^XMB(3.7,XMI)) Q:XMI'>0  D  Q:XMABORT
"RTN","XMUTERM1",13,0)
 . S XMTOTAL=XMTOTAL+1 I '$D(ZTQUEUED),'(XMTOTAL#1000) U IO(0) W:$X>50 ! W "." U IO
"RTN","XMUTERM1",14,0)
 . D CHECK1(XMI,XMGRACE,XMCUTOFF,.XMTERM,.XMNAME,.XMWHY) Q:'XMTERM
"RTN","XMUTERM1",15,0)
 . D GETDATA(XMI,.XMADDED,.XMAC,.XMVC,.XMPM,.XMLASTON,.XMTDATE,.XMDELM,.XMNEW,.XMFWD)
"RTN","XMUTERM1",16,0)
 . I $Y+3+(XMAC=XMYES&(XMFWD'=""))>IOSL D  Q:XMABORT
"RTN","XMUTERM1",17,0)
 . . I IOST["C-" D PAGE^XMXUTIL(.XMABORT) Q:XMABORT
"RTN","XMUTERM1",18,0)
 . . W @IOF D HEADER1
"RTN","XMUTERM1",19,0)
 . W !,$J(XMI,XMLEN)," ",$E(XMNAME,1,32-XMLEN),?34,XMADDED,?44,XMAC,?47,XMVC,?50,XMPM,?53,XMLASTON,?63,XMTDATE,?76,XMDELM
"RTN","XMUTERM1",20,0)
 . I XMAC=XMYES,XMFWD'="" W !,$$EZBLD^DIALOG(36347),$$EZBLD^DIALOG(38004),XMFWD Q  ; *** not deleted - Forwarding Address:
"RTN","XMUTERM1",21,0)
 . S XMCNT=XMCNT+1
"RTN","XMUTERM1",22,0)
 . D:'XMTEST TERMINAT(XMI)  ; Delete if real mode
"RTN","XMUTERM1",23,0)
 W:XMCNT=0 !!,$$EZBLD^DIALOG(36351) ; No user mailboxes deleted.
"RTN","XMUTERM1",24,0)
 S:$D(ZTQUEUED) ZTREQ="@"
"RTN","XMUTERM1",25,0)
 Q
"RTN","XMUTERM1",26,0)
HEADER1 ;
"RTN","XMUTERM1",27,0)
 N XMPARM
"RTN","XMUTERM1",28,0)
 S XMPARM(1)=$S(XMTEST:$$EZBLD^DIALOG(36352),1:"") ; Test:
"RTN","XMUTERM1",29,0)
 S XMPARM(2)=XMCUTEXT
"RTN","XMUTERM1",30,0)
 D BLD^DIALOG(36353,.XMPARM,"","","F")
"RTN","XMUTERM1",31,0)
 D MSG^DIALOG("WM","",IOM)
"RTN","XMUTERM1",32,0)
 ;|1|Delete user mailbox
"RTN","XMUTERM1",33,0)
 ;(Logon cutoff date: |2|, AC=Access Code, VC=Verify Code, PM=Primary Menu)
"RTN","XMUTERM1",34,0)
 ;                                           Last
"RTN","XMUTERM1",35,0)
 ;                       ^VA(200             Mail/  Terminate  Delete
"RTN","XMUTERM1",36,0)
 ;Delete Mailbox         Created  AC VC PM  Sign on    Date     Mail
"RTN","XMUTERM1",37,0)
 ;-----------------------------------------------------------------------
"RTN","XMUTERM1",38,0)
 ;                      xx/xx/xx  y  y  y  xx/xx/xx  xx/xx/xx     y
"RTN","XMUTERM1",39,0)
 Q
"RTN","XMUTERM1",40,0)
CHECK1(XMI,XMGRACE,XMCUTOFF,XMTERM,XMNAME,XMWHY) ;
"RTN","XMUTERM1",41,0)
 N XMREC,XMADDED
"RTN","XMUTERM1",42,0)
 S XMTERM=0
"RTN","XMUTERM1",43,0)
 Q:XMI<1
"RTN","XMUTERM1",44,0)
 S XMREC=$G(^VA(200,XMI,0))
"RTN","XMUTERM1",45,0)
 I XMREC="" D  Q
"RTN","XMUTERM1",46,0)
 . S XMTERM=1
"RTN","XMUTERM1",47,0)
 . S XMNAME=$$EZBLD^DIALOG(34009) ; * No Name *
"RTN","XMUTERM1",48,0)
 . S XMWHY=$$EZBLD^DIALOG(36346) ; Not in NEW PERSON file
"RTN","XMUTERM1",49,0)
 ; User is in NEW PERSON file
"RTN","XMUTERM1",50,0)
 S XMADDED=$P($G(^VA(200,XMI,1)),U,7)
"RTN","XMUTERM1",51,0)
 Q:XMADDED>XMGRACE
"RTN","XMUTERM1",52,0)
 I $P(XMREC,U,3)="" D  Q  ; if no access code...
"RTN","XMUTERM1",53,0)
 . N XMTDATE
"RTN","XMUTERM1",54,0)
 . S XMTDATE=$P(XMREC,U,11)
"RTN","XMUTERM1",55,0)
 . I XMTDATE="" D  Q
"RTN","XMUTERM1",56,0)
 . . S XMTERM=1
"RTN","XMUTERM1",57,0)
 . . S XMNAME=$$NAME^XMXUTIL(XMI)
"RTN","XMUTERM1",58,0)
 . . S XMWHY=$$EZBLD^DIALOG(36357) ; No AC, no termination date
"RTN","XMUTERM1",59,0)
 . I XMTDATE'<DT Q  ; To be Terminated in the future
"RTN","XMUTERM1",60,0)
 . I $P(XMREC,U,5)="n" Q  ; Terminated w/mail retention
"RTN","XMUTERM1",61,0)
 . S XMTERM=1
"RTN","XMUTERM1",62,0)
 . S XMNAME=$$NAME^XMXUTIL(XMI)
"RTN","XMUTERM1",63,0)
 . S XMWHY=$$EZBLD^DIALOG(36358) ; No AC, terminated w/o mail retention
"RTN","XMUTERM1",64,0)
 ; User has access code
"RTN","XMUTERM1",65,0)
 I $P($G(^VA(200,XMI,201)),U,1)="" D  Q  ; if no primary menu...
"RTN","XMUTERM1",66,0)
 . S XMTERM=1
"RTN","XMUTERM1",67,0)
 . S XMNAME=$$NAME^XMXUTIL(XMI)
"RTN","XMUTERM1",68,0)
 . S XMWHY=$$EZBLD^DIALOG(36359) ; AC, but no PM
"RTN","XMUTERM1",69,0)
 ; User has primary menu
"RTN","XMUTERM1",70,0)
 I $P($G(^VA(200,XMI,.1)),U,2)="" D  Q  ; if no verify code...
"RTN","XMUTERM1",71,0)
 . N XMLASTON  ; latest of 'last sign on' or 'last mailman use'
"RTN","XMUTERM1",72,0)
 . S XMLASTON=$$MAX^XLFMTH(+$P($G(^VA(200,XMI,1.1)),U),+$P($G(^XMB(3.7,XMI,"L")),U,2))
"RTN","XMUTERM1",73,0)
 . I XMLASTON=0 D  Q
"RTN","XMUTERM1",74,0)
 . . I XMADDED<XMCUTOFF D  Q
"RTN","XMUTERM1",75,0)
 . . . S XMTERM=1
"RTN","XMUTERM1",76,0)
 . . . S XMNAME=$$NAME^XMXUTIL(XMI)
"RTN","XMUTERM1",77,0)
 . . . S XMWHY=$$EZBLD^DIALOG(36360,$$FMTE^XLFDT(XMADDED,"2DF")) ; AC & PM, no VC, no logon, added |1|
"RTN","XMUTERM1",78,0)
 . I XMLASTON<XMCUTOFF D  Q
"RTN","XMUTERM1",79,0)
 . . S XMTERM=1
"RTN","XMUTERM1",80,0)
 . . S XMNAME=$$NAME^XMXUTIL(XMI)
"RTN","XMUTERM1",81,0)
 . . S XMWHY=$$EZBLD^DIALOG(36361,$$FMTE^XLFDT(XMLASTON,"2DF")) ; AC & PM, no VC, last logon |1|
"RTN","XMUTERM1",82,0)
 ; User has verify code
"RTN","XMUTERM1",83,0)
 Q
"RTN","XMUTERM1",84,0)
GETDATA(XMI,XMADDED,XMAC,XMVC,XMPM,XMLASTON,XMTDATE,XMDELM,XMNEW,XMFWD,XMDIS) ;
"RTN","XMUTERM1",85,0)
 N XMREC
"RTN","XMUTERM1",86,0)
 S XMREC=$G(^VA(200,XMI,0))
"RTN","XMUTERM1",87,0)
 S XMADDED=$P($G(^VA(200,XMI,1)),U,7) ; date added to NEW PERSON file
"RTN","XMUTERM1",88,0)
 S XMADDED=$S(XMADDED="":"",1:$$FMTE^XLFDT(XMADDED,"2DF"))
"RTN","XMUTERM1",89,0)
 S XMAC=$S($P(XMREC,U,3)="":"",1:XMYES) ; access code
"RTN","XMUTERM1",90,0)
 S XMVC=$S($P($G(^VA(200,XMI,.1)),U,2)="":"",1:XMYES) ; verify code
"RTN","XMUTERM1",91,0)
 S XMPM=$S($P($G(^VA(200,XMI,201)),U,1)="":"",1:XMYES) ; primary menu
"RTN","XMUTERM1",92,0)
 S XMLASTON=$$MAX^XLFMTH(+$P($G(^VA(200,XMI,1.1)),U),+$P($G(^XMB(3.7,XMI,"L")),U,2)) ; last sign on / mailman use
"RTN","XMUTERM1",93,0)
 S XMLASTON=$S(XMLASTON=0:"",1:$$FMTE^XLFDT(XMLASTON,"2DF"))
"RTN","XMUTERM1",94,0)
 S XMTDATE=$P(XMREC,U,11) ; termination date
"RTN","XMUTERM1",95,0)
 S XMTDATE=$S(XMTDATE="":"",1:$$FMTE^XLFDT(XMTDATE,"2DF"))
"RTN","XMUTERM1",96,0)
 S XMDELM=$$UP^XLFSTR($P(XMREC,U,5)) ; delete mail on termination
"RTN","XMUTERM1",97,0)
 S XMDIS=$S($P(XMREC,U,7):XMYES,1:"") ; DISUSER'd
"RTN","XMUTERM1",98,0)
 S XMREC=$G(^XMB(3.7,XMI,0))
"RTN","XMUTERM1",99,0)
 S XMFWD=$P(XMREC,U,2) ; Forwarding address
"RTN","XMUTERM1",100,0)
 S XMNEW=$P(XMREC,U,6) ; New messages
"RTN","XMUTERM1",101,0)
 Q
"RTN","XMUTERM1",102,0)
ALL2TASK ; Suggestions
"RTN","XMUTERM1",103,0)
 N XMI,XMABORT,XMTERM,XMNAME,XMWHY,XMCUTEXT,XMSVC,XMLEN,XMCNT,XMADDED,XMAC,XMVC,XMPM,XMLASTON,XMTDATE,XMDELM,XMREC,XMTOTAL,XMNEW,XMFWD,XMFIRST,XMYES,XMDIS,XMSURR,XMSNAM
"RTN","XMUTERM1",104,0)
 S XMYES=$$EZBLD^DIALOG(39054.1) ; Y
"RTN","XMUTERM1",105,0)
 K ^TMP("XM",$J)
"RTN","XMUTERM1",106,0)
 S XMCUTEXT=$$FMTE^XLFDT(XMCUTOFF,"2DF")
"RTN","XMUTERM1",107,0)
 S XMLEN=$L($P(^VA(200,0),U,3))
"RTN","XMUTERM1",108,0)
 S (XMCNT,XMABORT,XMTOTAL)=0,XMFIRST=1
"RTN","XMUTERM1",109,0)
 S XMI=.999
"RTN","XMUTERM1",110,0)
 F  S XMI=$O(^XMB(3.7,XMI)) Q:XMI'>0  D  Q:XMABORT
"RTN","XMUTERM1",111,0)
 . S XMTOTAL=XMTOTAL+1 I '$D(ZTQUEUED),'(XMTOTAL#1000) U IO(0) W:$X>50 ! W "." U IO
"RTN","XMUTERM1",112,0)
 . D CHECK2(XMI,XMCUTOFF,.XMTERM,.XMNAME,.XMWHY) Q:'XMTERM
"RTN","XMUTERM1",113,0)
 . S XMCNT=XMCNT+1
"RTN","XMUTERM1",114,0)
 . D GETDATA(XMI,.XMADDED,.XMAC,.XMVC,.XMPM,.XMLASTON,.XMTDATE,.XMDELM,.XMNEW,.XMFWD,.XMDIS)
"RTN","XMUTERM1",115,0)
 . S XMSVC=$S($P($G(^VA(200,XMI,5)),U,1)="":$$EZBLD^DIALOG(36334),1:$P($G(^DIC(49,$P(^(5),U,1),0),$$EZBLD^DIALOG(36334)),U,1)) ; NONE
"RTN","XMUTERM1",116,0)
 . S ^TMP("XM",$J,XMSVC,$S(XMNAME="":$$EZBLD^DIALOG(34009),1:$E(XMNAME,1,25-XMLEN)),XMI)=XMAC_U_XMVC_U_XMPM_U_XMLASTON_U_XMTDATE_U_XMDELM_U_XMDIS_U_XMNEW_U_XMFWD ; * No Name *
"RTN","XMUTERM1",117,0)
 S (XMSVC,XMNAME,XMI)=""
"RTN","XMUTERM1",118,0)
 F  S XMSVC=$O(^TMP("XM",$J,XMSVC)) Q:XMSVC=""  D  Q:XMABORT
"RTN","XMUTERM1",119,0)
 . I XMFIRST D
"RTN","XMUTERM1",120,0)
 . . S XMFIRST=0
"RTN","XMUTERM1",121,0)
 . . W:IOST["C-" @IOF D HEADER2
"RTN","XMUTERM1",122,0)
 . E  D PAGE2(.XMABORT) Q:XMABORT
"RTN","XMUTERM1",123,0)
 . F  S XMNAME=$O(^TMP("XM",$J,XMSVC,XMNAME)) Q:XMNAME=""  D  Q:XMABORT
"RTN","XMUTERM1",124,0)
 . . F  S XMI=$O(^TMP("XM",$J,XMSVC,XMNAME,XMI)) Q:XMI=""  D  Q:XMABORT
"RTN","XMUTERM1",125,0)
 . . . S XMREC=^TMP("XM",$J,XMSVC,XMNAME,XMI)
"RTN","XMUTERM1",126,0)
 . . . I $Y+3+($P(XMREC,U,1)=XMYES&($P(XMREC,U,9)'=""))>IOSL D PAGE2(.XMABORT) Q:XMABORT
"RTN","XMUTERM1",127,0)
 . . . W !,$J(XMI,XMLEN)," ",XMNAME,?27,$P(XMREC,U,1),?30,$P(XMREC,U,2),?33,$P(XMREC,U,3),?35,$P(XMREC,U,4),?44,$P(XMREC,U,5),?54,$P(XMREC,U,6),?58,$P(XMREC,U,7),?60,$J($P(XMREC,U,8),6)
"RTN","XMUTERM1",128,0)
 . . . S XMSURR=0,XMSNAM=""
"RTN","XMUTERM1",129,0)
 . . . F  S XMSURR=$O(^XMB(3.7,XMI,9,XMSURR)) Q:'XMSURR  D  Q:XMSNAM'=""
"RTN","XMUTERM1",130,0)
 . . . . S XMSNAM=$S($D(^VA(200,+$G(^XMB(3.7,XMI,9,XMSURR,0)),0)):$$NAME^XMXUTIL(+^XMB(3.7,XMI,9,XMSURR,0)),1:"")
"RTN","XMUTERM1",131,0)
 . . . I XMSNAM'="" W " ",$E(XMSNAM,1,12)
"RTN","XMUTERM1",132,0)
 . . . I $P(XMREC,U,1)=XMYES,$P(XMREC,U,9)'="" W !,?XMLEN+1,$$EZBLD^DIALOG(38004),$P(XMREC,U,9) ; Forwarding address:
"RTN","XMUTERM1",133,0)
 W:XMCNT=0 !!,$$EZBLD^DIALOG(36362) ; No user mailboxes to report.
"RTN","XMUTERM1",134,0)
 K ^TMP("XM",$J)
"RTN","XMUTERM1",135,0)
 S:$D(ZTQUEUED) ZTREQ="@"
"RTN","XMUTERM1",136,0)
 Q
"RTN","XMUTERM1",137,0)
PAGE2(XMABORT) ;
"RTN","XMUTERM1",138,0)
 I IOST["C-" D PAGE^XMXUTIL(.XMABORT) Q:XMABORT
"RTN","XMUTERM1",139,0)
 W @IOF D HEADER2
"RTN","XMUTERM1",140,0)
 Q
"RTN","XMUTERM1",141,0)
HEADER2 ;
"RTN","XMUTERM1",142,0)
 N XMPARM
"RTN","XMUTERM1",143,0)
 S XMPARM(1)=XMSVC
"RTN","XMUTERM1",144,0)
 S XMPARM(2)=XMCUTEXT
"RTN","XMUTERM1",145,0)
 D BLD^DIALOG(36364,.XMPARM,"","","F")
"RTN","XMUTERM1",146,0)
 D MSG^DIALOG("WM","",IOM)
"RTN","XMUTERM1",147,0)
 ;Check user mailbox for Service/Section: |1|
"RTN","XMUTERM1",148,0)
 ;
"RTN","XMUTERM1",149,0)
 ;(Logon cutoff date: |2|, AC=Access Code, VC=Verify Code, PM=Primary Menu)
"RTN","XMUTERM1",150,0)
 ;
"RTN","XMUTERM1",151,0)
 ;                            Last
"RTN","XMUTERM1",152,0)
 ;                            Mail/    Term   Del  DIS  New
"RTN","XMUTERM1",153,0)
 ;Check Mailbox    AC VC PM  Sign on   Date  Mail USER Msgs Surrogate
"RTN","XMUTERM1",154,0)
 ;----------------------------------------------------------------------
"RTN","XMUTERM1",155,0)
 ;                  y  y  y xx/xx/xx xx/xx/xx  y   y xxxxxx xxxxxxxxxxxx
"RTN","XMUTERM1",156,0)
 Q
"RTN","XMUTERM1",157,0)
CHECK2(XMI,XMCUTOFF,XMTERM,XMNAME,XMWHY) ;
"RTN","XMUTERM1",158,0)
 N XMREC
"RTN","XMUTERM1",159,0)
 S XMTERM=0
"RTN","XMUTERM1",160,0)
 Q:XMI<1
"RTN","XMUTERM1",161,0)
 S XMREC=$G(^VA(200,XMI,0))
"RTN","XMUTERM1",162,0)
 Q:XMREC=""  ; not in NEW PERSON file
"RTN","XMUTERM1",163,0)
 I $P(XMREC,U,7) D  Q
"RTN","XMUTERM1",164,0)
 . ; DISUSER'd
"RTN","XMUTERM1",165,0)
 . S XMTERM=1
"RTN","XMUTERM1",166,0)
 . S XMNAME=$$NAME^XMXUTIL(XMI)
"RTN","XMUTERM1",167,0)
 . S XMWHY=$$EZBLD^DIALOG(36366) ; DISUSER'd
"RTN","XMUTERM1",168,0)
 I $P(XMREC,U,3)="" D  Q
"RTN","XMUTERM1",169,0)
 . ; no access code
"RTN","XMUTERM1",170,0)
 . N XMTDATE
"RTN","XMUTERM1",171,0)
 . S XMTDATE=$P(XMREC,U,11)
"RTN","XMUTERM1",172,0)
 . Q:XMTDATE=""  ; not terminated
"RTN","XMUTERM1",173,0)
 . Q:XMTDATE'<XMCUTOFF  ; terminated after cutoff date
"RTN","XMUTERM1",174,0)
 . Q:$P(XMREC,U,5)'="n"  ; Terminated w/o mail retention
"RTN","XMUTERM1",175,0)
 . S XMTERM=1
"RTN","XMUTERM1",176,0)
 . S XMNAME=$$NAME^XMXUTIL(XMI)
"RTN","XMUTERM1",177,0)
 . S XMWHY=$$EZBLD^DIALOG(36367) ; No AC, terminated w/mail retention
"RTN","XMUTERM1",178,0)
 ; User has access code
"RTN","XMUTERM1",179,0)
 Q:$P($G(^VA(200,XMI,201)),U,1)=""  ; no primary menu
"RTN","XMUTERM1",180,0)
 Q:$P($G(^VA(200,XMI,.1)),U,2)=""   ; no verify code
"RTN","XMUTERM1",181,0)
 ; User has verify code and primary menu
"RTN","XMUTERM1",182,0)
 N XMLASTON  ; latest of last sign on / mailman use
"RTN","XMUTERM1",183,0)
 S XMLASTON=$$MAX^XLFMTH(+$P($G(^VA(200,XMI,1.1)),U),+$P($G(^XMB(3.7,XMI,"L")),U,2))
"RTN","XMUTERM1",184,0)
 I XMLASTON<XMCUTOFF D  Q
"RTN","XMUTERM1",185,0)
 . S XMNAME=$$NAME^XMXUTIL(XMI)
"RTN","XMUTERM1",186,0)
 . I XMLASTON="" D  Q
"RTN","XMUTERM1",187,0)
 . . N XMADDED
"RTN","XMUTERM1",188,0)
 . . S XMADDED=$P($G(^VA(200,XMI,1)),U,7)
"RTN","XMUTERM1",189,0)
 . . Q:XMADDED'<XMCUTOFF
"RTN","XMUTERM1",190,0)
 . . S XMTERM=1
"RTN","XMUTERM1",191,0)
 . . S XMWHY=$$EZBLD^DIALOG(36368,$$FMTE^XLFDT(XMADDED,"2DF")) ; AC, VC, & PM, no logon, added |1|
"RTN","XMUTERM1",192,0)
 . S XMTERM=1
"RTN","XMUTERM1",193,0)
 . S XMWHY=$$EZBLD^DIALOG(36369,$$FMTE^XLFDT(XMLASTON,"2DF")) ; AC, VC, & PM, last logon |1|
"RTN","XMUTERM1",194,0)
 Q
"RTN","XMUTERM1",195,0)
 ; The following entry is called from a Kernel routine.
"RTN","XMUTERM1",196,0)
TERMINAT(XMDUZ) ; Remove user from MailMan
"RTN","XMUTERM1",197,0)
 D GROUP^XMUTERM2(XMDUZ)
"RTN","XMUTERM1",198,0)
 D SURROGAT^XMUTERM2(XMDUZ)
"RTN","XMUTERM1",199,0)
 D MAILBOX^XMUTERM2(XMDUZ)
"RTN","XMUTERM1",200,0)
 D LATERNEW^XMUTERM2(XMDUZ)
"RTN","XMUTERM1",201,0)
 D LATERSND^XMUTERM2(XMDUZ)
"RTN","XMUTERM1",202,0)
 Q
"RTN","XMUTERM2")
0^84^B24703189
"RTN","XMUTERM2",1,0)
XMUTERM2 ;ISC-SF/GMB-Delete Mailbox (cont.) ;04/17/2002  12:09
"RTN","XMUTERM2",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMUTERM2",3,0)
 ;
"RTN","XMUTERM2",4,0)
 ; The following are called from CHOOSE^XMUTERM
"RTN","XMUTERM2",5,0)
 ;
"RTN","XMUTERM2",6,0)
MMCHOOSE(XMGRACE,XMCUTOFF) ;
"RTN","XMUTERM2",7,0)
 N XMI,XMABORT,XMTERM
"RTN","XMUTERM2",8,0)
 S (XMI,XMABORT)=0
"RTN","XMUTERM2",9,0)
 F  S XMI=$O(^XMB(3.7,XMI)) Q:XMI'>0  D  Q:XMABORT
"RTN","XMUTERM2",10,0)
 . D CHECK1^XMUTERM1(XMI,XMGRACE,XMCUTOFF,.XMTERM) I XMTERM D DELETE(XMI,.XMABORT) Q
"RTN","XMUTERM2",11,0)
 . D CHECK2^XMUTERM1(XMI,XMCUTOFF,.XMTERM) I XMTERM D DELETE(XMI,.XMABORT)
"RTN","XMUTERM2",12,0)
 Q
"RTN","XMUTERM2",13,0)
ICHOOSE(XMGRACE,XMCUTOFF) ;
"RTN","XMUTERM2",14,0)
 F  D  Q:XMABORT
"RTN","XMUTERM2",15,0)
 . N DIC,Y
"RTN","XMUTERM2",16,0)
 . S DIC="^XMB(3.7,"
"RTN","XMUTERM2",17,0)
 . S DIC(0)="AEQM"
"RTN","XMUTERM2",18,0)
 . S DIC("S")="N XMTERM,XMFORGET D CHECK1^XMUTERM1(Y,XMGRACE,XMCUTOFF,.XMTERM),CHECK2^XMUTERM1(Y,XMCUTOFF,.XMFORGET) I XMTERM!XMFORGET"
"RTN","XMUTERM2",19,0)
 . W ! D ^DIC I Y=-1 S XMABORT=1 Q
"RTN","XMUTERM2",20,0)
 . D DELETE(+Y)
"RTN","XMUTERM2",21,0)
 Q
"RTN","XMUTERM2",22,0)
DELETE(XMI,XMABORT) ;
"RTN","XMUTERM2",23,0)
 N XMREC1,XMREC2,XMDELETE
"RTN","XMUTERM2",24,0)
 S XMREC1=$G(^VA(200,XMI,0))
"RTN","XMUTERM2",25,0)
 I XMREC1'="" D  Q:'XMDELETE
"RTN","XMUTERM2",26,0)
 . N DIR,Y
"RTN","XMUTERM2",27,0)
 . W !!,$$NAME^XMXUTIL(XMI)
"RTN","XMUTERM2",28,0)
 . W !,$$EZBLD^DIALOG(36336),$$EZBLD^DIALOG($S($P(XMREC1,U,3)="":36334,1:36335)) ; Access Code: NONE / <Hidden>
"RTN","XMUTERM2",29,0)
 . W ?25,$$EZBLD^DIALOG(36337),$$EZBLD^DIALOG($S($P($G(^VA(200,XMI,.1)),U,2)="":36334,1:36335)) ; Verify Code: NONE / <hidden>
"RTN","XMUTERM2",30,0)
 . W ?50,$$EZBLD^DIALOG(36338),$S($P($G(^VA(200,XMI,201)),U,1)="":$$EZBLD^DIALOG(36334),1:$P($G(^DIC(19,$P(^(201),U),0)),U)) ; Primary Menu: NONE / ...
"RTN","XMUTERM2",31,0)
 . W !,$$EZBLD^DIALOG(36339),$S($P($G(^VA(200,XMI,1)),U,7)="":$$EZBLD^DIALOG(36334),1:$$FMTE^XLFDT($P(^(1),U,7),"2D")) ; Date Entered: NONE / date
"RTN","XMUTERM2",32,0)
 . W ?25,$$EZBLD^DIALOG(36340),$S($P($G(^VA(200,XMI,1.1)),U,1)="":$$EZBLD^DIALOG(36334),1:$$FMTE^XLFDT($P(^(1.1),U,1),"2D")) ; Last Logon: NONE / date
"RTN","XMUTERM2",33,0)
 . W ?50,"DISUSER: ",$$EZBLD^DIALOG($S($P(XMREC1,U,7):39054,1:39053)) ; YES / NO
"RTN","XMUTERM2",34,0)
 . W !,$$EZBLD^DIALOG(36341),$S($P(XMREC1,U,11)="":$$EZBLD^DIALOG(36334),1:$$FMTE^XLFDT($P(XMREC1,U,11),"2D")) ; Term Date: NONE / date
"RTN","XMUTERM2",35,0)
 . W:$P(XMREC1,U,11) ?25,$$EZBLD^DIALOG(36342),$$EZBLD^DIALOG($S($P(XMREC1,U,5)="y":39054,1:39053)) ; Delete Mail: YES / NO
"RTN","XMUTERM2",36,0)
 . S XMREC2=^XMB(3.7,XMI,0)
"RTN","XMUTERM2",37,0)
 . W ?50,$$EZBLD^DIALOG(36343),$P(XMREC2,U,6) ; New Messages:
"RTN","XMUTERM2",38,0)
 . W !,$$EZBLD^DIALOG(38012),$S($P($G(^XMB(3.7,XMI,"L")),U)="":$$EZBLD^DIALOG(38002),1:$P(^("L"),U)) ; last used mailman: Never / date
"RTN","XMUTERM2",39,0)
 . W !,$$EZBLD^DIALOG(38004) ; Forwarding Address:
"RTN","XMUTERM2",40,0)
 . I $P(XMREC2,U,2)="" D
"RTN","XMUTERM2",41,0)
 . . W $$EZBLD^DIALOG(36334) ; NONE
"RTN","XMUTERM2",42,0)
 . E  D
"RTN","XMUTERM2",43,0)
 . . W $P(XMREC2,U,2),$$EZBLD^DIALOG($S($P(XMREC2,U,8):38005,1:38006)) ; fwding addr, local deliver on/off
"RTN","XMUTERM2",44,0)
 . W !
"RTN","XMUTERM2",45,0)
 . S DIR(0)="Y"
"RTN","XMUTERM2",46,0)
 . S DIR("B")=$$EZBLD^DIALOG(39053) ; NO
"RTN","XMUTERM2",47,0)
 . S DIR("A")=$$EZBLD^DIALOG(36344) ; Delete this user's mailbox
"RTN","XMUTERM2",48,0)
 . D ^DIR I $D(DIRUT) S XMDELETE=0,XMABORT=1 Q
"RTN","XMUTERM2",49,0)
 . I 'Y S XMDELETE=0 Q
"RTN","XMUTERM2",50,0)
 . S XMDELETE=1
"RTN","XMUTERM2",51,0)
 N XMPARM
"RTN","XMUTERM2",52,0)
 S XMPARM(1)=XMI,XMPARM(2)=$S(XMREC1="":$$EZBLD^DIALOG(36346),1:$P(XMREC1,U)) ; * not in NEW PERSON file *
"RTN","XMUTERM2",53,0)
 W !,$$EZBLD^DIALOG(36345,.XMPARM) ; Deleting mailbox for user |1| |2|
"RTN","XMUTERM2",54,0)
 D TERMINAT^XMUTERM1(XMI)
"RTN","XMUTERM2",55,0)
 Q
"RTN","XMUTERM2",56,0)
 ;
"RTN","XMUTERM2",57,0)
 ; The following are called from TERMINAT^XMUTERM1
"RTN","XMUTERM2",58,0)
 ;
"RTN","XMUTERM2",59,0)
GROUP(XMDUZ) ; Remove user from mail groups
"RTN","XMUTERM2",60,0)
 N XMI,XMJ,DIK,DA
"RTN","XMUTERM2",61,0)
 ; Remove user as member from all mail groups
"RTN","XMUTERM2",62,0)
 S XMI=0
"RTN","XMUTERM2",63,0)
 F  S XMI=$O(^XMB(3.8,"AB",XMDUZ,XMI)) Q:XMI'>0  D
"RTN","XMUTERM2",64,0)
 . S DA(1)=XMI,DIK="^XMB(3.8,XMI,1,",XMJ=0
"RTN","XMUTERM2",65,0)
 . F  S XMJ=$O(^XMB(3.8,"AB",XMDUZ,XMI,XMJ)) Q:XMJ'>0  S DA=XMJ D ^DIK
"RTN","XMUTERM2",66,0)
 K ^XMB(3.8,"AB",XMDUZ)
"RTN","XMUTERM2",67,0)
 ; Remove user as coordinator from all mail groups
"RTN","XMUTERM2",68,0)
 S XMI=0
"RTN","XMUTERM2",69,0)
 F  S XMI=$O(^XMB(3.8,"AC",XMDUZ,XMI)) Q:XMI'>0  D
"RTN","XMUTERM2",70,0)
 . S XMFDA(3.8,XMI_",",5.1)=.5 ; (change coord to postmaster)
"RTN","XMUTERM2",71,0)
 . D FILE^DIE("","XMFDA")
"RTN","XMUTERM2",72,0)
 K ^XMB(3.8,"AC",XMDUZ)
"RTN","XMUTERM2",73,0)
 ; Remove user's personal mail groups, and
"RTN","XMUTERM2",74,0)
 ; remove user as organizer or authorized sender from all mail groups.
"RTN","XMUTERM2",75,0)
 S XMI=0
"RTN","XMUTERM2",76,0)
 F  S XMI=$O(^XMB(3.8,XMI)) Q:XMI'>0  D
"RTN","XMUTERM2",77,0)
 . I +$G(^XMB(3.8,XMI,3))=XMDUZ D  ; user is organizer
"RTN","XMUTERM2",78,0)
 . . I $P(^XMB(3.8,XMI,0),U,6)=1 S DA=XMI,DIK="^XMB(3.8," D ^DIK Q  ; delete personal group
"RTN","XMUTERM2",79,0)
 . . S XMFDA(3.8,XMI_",",5)=.5 ; (change organizer to postmaster)
"RTN","XMUTERM2",80,0)
 . . D FILE^DIE("","XMFDA")
"RTN","XMUTERM2",81,0)
 . ; Remove user as authorized sender from all mail groups
"RTN","XMUTERM2",82,0)
 . Q:'$D(^XMB(3.8,XMI,4,"B",XMDUZ))
"RTN","XMUTERM2",83,0)
 . S DA=$O(^XMB(3.8,XMI,4,"B",XMDUZ,0))
"RTN","XMUTERM2",84,0)
 . I '$D(^XMB(3.8,XMI,4,DA,0)) K ^XMB(3.8,XMI,4,"B",XMDUZ) Q
"RTN","XMUTERM2",85,0)
 . S DA(1)=XMI,DIK="^XMB(3.8,XMI,4," D ^DIK
"RTN","XMUTERM2",86,0)
 Q
"RTN","XMUTERM2",87,0)
SURROGAT(XMDUZ) ; Remove as mail surrogate
"RTN","XMUTERM2",88,0)
 N XMI,DA,DIK
"RTN","XMUTERM2",89,0)
 S XMI=0,DIK="^XMB(3.7,XMI,9,"
"RTN","XMUTERM2",90,0)
 F  S XMI=$O(^XMB(3.7,"AB",XMDUZ,XMI)) Q:XMI'>0  D
"RTN","XMUTERM2",91,0)
 . S DA=$O(^XMB(3.7,"AB",XMDUZ,XMI,0))
"RTN","XMUTERM2",92,0)
 . I '$D(^XMB(3.7,XMI,9,DA,0)) K ^XMB(3.7,"AB",XMDUZ,XMI) Q
"RTN","XMUTERM2",93,0)
 . S DA(1)=XMI D ^DIK
"RTN","XMUTERM2",94,0)
 K ^XMB(3.7,"AB",XMDUZ)
"RTN","XMUTERM2",95,0)
 Q
"RTN","XMUTERM2",96,0)
MAILBOX(XMDUZ) ; Remove user's mailbox
"RTN","XMUTERM2",97,0)
 Q:'$D(^XMB(3.7,XMDUZ))
"RTN","XMUTERM2",98,0)
 N DIK,DA
"RTN","XMUTERM2",99,0)
 S DIK="^XMB(3.7,",DA=XMDUZ D ^DIK
"RTN","XMUTERM2",100,0)
 K:$D(^XMB(3.7,XMDUZ)) ^XMB(3.7,XMDUZ) ; just in case!
"RTN","XMUTERM2",101,0)
 K:$D(^XMB(3.7,"B",XMDUZ)) ^XMB(3.7,"B",XMDUZ)
"RTN","XMUTERM2",102,0)
 Q
"RTN","XMUTERM2",103,0)
LATERNEW(XMDUZ) ; Remove the scheduling of any messages slated to become new for this user
"RTN","XMUTERM2",104,0)
 N DIK,DA
"RTN","XMUTERM2",105,0)
 S DIK="^XMB(3.73,"
"RTN","XMUTERM2",106,0)
 S DA=""
"RTN","XMUTERM2",107,0)
 F  S DA=$O(^XMB(3.73,"C",XMDUZ,DA)) Q:'DA  D ^DIK
"RTN","XMUTERM2",108,0)
 Q
"RTN","XMUTERM2",109,0)
LATERSND(XMDUZ) ; Remove the scheduling of any messages slated to be sent by this user.
"RTN","XMUTERM2",110,0)
 N XMZ,DIK,DA
"RTN","XMUTERM2",111,0)
 S XMZ=0
"RTN","XMUTERM2",112,0)
 F  S XMZ=$O(^XMB(3.9,"AW",XMDUZ,XMZ)) Q:'XMZ  D
"RTN","XMUTERM2",113,0)
 . S DA(1)=XMZ
"RTN","XMUTERM2",114,0)
 . S DIK="^XMB(3.9,"_DA(1)_",7,"
"RTN","XMUTERM2",115,0)
 . S DA=0
"RTN","XMUTERM2",116,0)
 . F  S DA=$O(^XMB(3.9,"AW",XMDUZ,XMZ,DA)) Q:'DA  D ^DIK
"RTN","XMUTERM2",117,0)
 Q
"RTN","XMUTPUR0")
0^357^B5569328
"RTN","XMUTPUR0",1,0)
XMUTPUR0 ;(KVAMC)/XXX-Purge "AI" X-ref ;04/17/2002  12:10
"RTN","XMUTPUR0",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMUTPUR0",3,0)
 ; Entry points used by MailMan options (not covered by DBIA):
"RTN","XMUTPUR0",4,0)
 ; PURGE  XMMGR-PURGE-AI-XREF
"RTN","XMUTPUR0",5,0)
PURGE ;
"RTN","XMUTPUR0",6,0)
 N XMQUIET,XMABORT,XMDT
"RTN","XMUTPUR0",7,0)
 S XMABORT=0,XMQUIET=$D(ZTQUEUED)!(IOST'["C-")
"RTN","XMUTPUR0",8,0)
 D INIT(.XMDT,XMQUIET,.XMABORT)
"RTN","XMUTPUR0",9,0)
 I XMABORT W:'XMQUIET !,"Process aborted." Q
"RTN","XMUTPUR0",10,0)
 D PROCESS(XMDT,XMQUIET)
"RTN","XMUTPUR0",11,0)
 Q
"RTN","XMUTPUR0",12,0)
INIT(XMDT,XMQUIET,XMABORT) ;
"RTN","XMUTPUR0",13,0)
 I $D(^XMBX(3.9,"AI"))<10 S XMABORT=1 W:'XMQUIET !,"XMBX Global 'AI' Node empty!" Q
"RTN","XMUTPUR0",14,0)
 S XMDT=$$FMADD^XLFDT(DT,-730)
"RTN","XMUTPUR0",15,0)
 Q:XMQUIET
"RTN","XMUTPUR0",16,0)
 N DIR,X,Y
"RTN","XMUTPUR0",17,0)
 S DIR(0)="D^:"_$$FMADD^XLFDT(DT,-1)_":EP"
"RTN","XMUTPUR0",18,0)
 S DIR("A")="Kill all XMBX 'AI' nodes older than"
"RTN","XMUTPUR0",19,0)
 S DIR("B")=$$FMTE^XLFDT(XMDT)
"RTN","XMUTPUR0",20,0)
 D ^DIR I $D(DIRUT) S XMABORT=1 Q
"RTN","XMUTPUR0",21,0)
 I XMDT'=Y D  Q:XMABORT
"RTN","XMUTPUR0",22,0)
 . S XMDT=Y
"RTN","XMUTPUR0",23,0)
 . K DIR,X,Y
"RTN","XMUTPUR0",24,0)
 . S DIR(0)="Y"
"RTN","XMUTPUR0",25,0)
 . S DIR("A")="Are you sure"
"RTN","XMUTPUR0",26,0)
 . S DIR("B")="NO"
"RTN","XMUTPUR0",27,0)
 . D ^DIR I 'Y!$D(DIRUT) S XMABORT=1
"RTN","XMUTPUR0",28,0)
 W !,"We will kill all nodes older than ",$$FMTE^XLFDT(XMDT),"."
"RTN","XMUTPUR0",29,0)
 W !!,"***** Starting at " D ^%T W !
"RTN","XMUTPUR0",30,0)
 Q
"RTN","XMUTPUR0",31,0)
PROCESS(XMDT,XMQUIET) ;
"RTN","XMUTPUR0",32,0)
 N XMS,XMI,XMZ,XMXDT,XMCNT,XMKILL
"RTN","XMUTPUR0",33,0)
 S (XMCNT,XMKILL)=0 ; XMCNT=#nodes, XMKILL=#killed
"RTN","XMUTPUR0",34,0)
 S (XMS,XMI,XMZ)="" ; XMS=Site, XMI=Msg ID, XMZ=Msg # here at this site
"RTN","XMUTPUR0",35,0)
 F  S XMS=$O(^XMBX(3.9,"AI",XMS)) Q:XMS=""  D
"RTN","XMUTPUR0",36,0)
 . F  S XMI=$O(^XMBX(3.9,"AI",XMS,XMI)) Q:XMI=""  D
"RTN","XMUTPUR0",37,0)
 . . S XMZ=$O(^XMBX(3.9,"AI",XMS,XMI,""))
"RTN","XMUTPUR0",38,0)
 . . I XMZ="" K ^XMBX(3.9,"AI",XMS,XMI) Q
"RTN","XMUTPUR0",39,0)
 . . S XMXDT=$G(^XMBX(3.9,"AI",XMS,XMI,XMZ))
"RTN","XMUTPUR0",40,0)
 . . S XMCNT=XMCNT+1
"RTN","XMUTPUR0",41,0)
 . . I 'XMQUIET,XMCNT#1000=0 W:$X>70 ! W ".",XMCNT
"RTN","XMUTPUR0",42,0)
 . . I 'XMXDT S ^XMBX(3.9,"AI",XMS,XMI,XMZ)=DT Q
"RTN","XMUTPUR0",43,0)
 . . I XMXDT<XMDT K ^XMBX(3.9,"AI",XMS,XMI,XMZ) S XMKILL=XMKILL+1
"RTN","XMUTPUR0",44,0)
 Q:XMQUIET
"RTN","XMUTPUR0",45,0)
 W !,"Nodes Reviewed:",?16,$J($FN(XMCNT,","),10),!,"Nodes Killed:",?16,$J($FN(XMKILL,","),10),!,"Nodes Remaining:",?16,$J($FN(XMCNT-XMKILL,","),10)
"RTN","XMUTPUR0",46,0)
 W !,"***** Finished at " D ^%T
"RTN","XMUTPUR0",47,0)
 Q
"RTN","XMVA")
1^174
"RTN","XMVCODE")
1^175
"RTN","XMVGROUP")
0^227^B58696222
"RTN","XMVGROUP",1,0)
XMVGROUP ;ISC-SF/GMB-Group creation/enrollment ;04/19/2002  11:21
"RTN","XMVGROUP",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMVGROUP",3,0)
 ; Replaces JOIN, ENT^XMA7G & ^XMA7G1 (ISC-WASH/RJ/THM/CAP/JA)
"RTN","XMVGROUP",4,0)
 ; Entry points used by MailMan options (not covered by DBIA):
"RTN","XMVGROUP",5,0)
 ; EDITMG    XMEDITMG        - Mail Group Edit
"RTN","XMVGROUP",6,0)
 ; ENROLL    XMENROLL        - Enroll in / Disenroll from a group
"RTN","XMVGROUP",7,0)
 ; LCOORD    XMMGR-MAIL-GRP-COORDINATOR
"RTN","XMVGROUP",8,0)
 ; RCOORD    XMMGR-MAIL-GRP-COORD-W/REMOTES
"RTN","XMVGROUP",9,0)
 ; PERSONAL  XMEDITPERSGROUP - Edit user's personal group.
"RTN","XMVGROUP",10,0)
ENROLL ; Enroll in / Disenroll from a group
"RTN","XMVGROUP",11,0)
 N DIC,Y,XMABORT,XMIEN,XMSELF,XMIA
"RTN","XMVGROUP",12,0)
 S XMABORT=0
"RTN","XMVGROUP",13,0)
 S:'$D(XMDUZ) XMDUZ=DUZ
"RTN","XMVGROUP",14,0)
 S XMSELF=+$P($G(^XMB(1,1,2)),U,2) ; Is self-disenrollment allowed in a non-self enrolling mail group?
"RTN","XMVGROUP",15,0)
 F  D  Q:XMABORT
"RTN","XMVGROUP",16,0)
 . S DIC="^XMB(3.8,",DIC(0)="AEQMZ"
"RTN","XMVGROUP",17,0)
 . S DIC("S")="I $S($P(^(0),U,2)=""PU"":1,$D(^XMB(3.8,+Y,1,""B"",XMDUZ)):1,1:0)"
"RTN","XMVGROUP",18,0)
 . S DIC("W")="W:$D(^XMB(3.8,+Y,1,""B"",XMDUZ)) ?35,"""_$$EZBLD^DIALOG(38020)_""" I $P(^XMB(3.8,+Y,0),U,3)'=""y"" W ?43,"""_$$EZBLD^DIALOG(38021)_"""" ; Member / ...Self Enrollment Not Allowed.
"RTN","XMVGROUP",19,0)
 . W !
"RTN","XMVGROUP",20,0)
 . D ^DIC I Y<0 S XMABORT=1 Q
"RTN","XMVGROUP",21,0)
 . S XMIEN=+Y
"RTN","XMVGROUP",22,0)
 . I $D(^XMB(3.8,XMIEN,1,"B",XMDUZ)) D  Q
"RTN","XMVGROUP",23,0)
 . . I $P(^XMB(3.8,XMIEN,0),U,3)'="y",'XMSELF W !,$$EZBLD^DIALOG(38022.1) Q  ;Self enrollment is not allowed for this mail group.
"RTN","XMVGROUP",24,0)
 . . D DROP(XMIEN,XMDUZ)
"RTN","XMVGROUP",25,0)
 . I $P(^XMB(3.8,XMIEN,0),U,3)'="y" W !,$$EZBLD^DIALOG(38022) Q  ;Self enrollment is not allowed for this mail group.
"RTN","XMVGROUP",26,0)
 . D JOIN(XMIEN,XMDUZ)
"RTN","XMVGROUP",27,0)
 Q
"RTN","XMVGROUP",28,0)
JOIN(XMIEN,XMDUZ) ; Enroll in a group
"RTN","XMVGROUP",29,0)
 N XMFDA
"RTN","XMVGROUP",30,0)
 S XMFDA(3.81,"+1,"_XMIEN_",",.01)=XMDUZ
"RTN","XMVGROUP",31,0)
 D UPDATE^DIE("","XMFDA")
"RTN","XMVGROUP",32,0)
 W !,$$EZBLD^DIALOG(38023) ;You are now a member.
"RTN","XMVGROUP",33,0)
 N DIR,X,Y
"RTN","XMVGROUP",34,0)
 S DIR(0)="Y"
"RTN","XMVGROUP",35,0)
 ; Do you want past messages to this group to be forwarded to you?
"RTN","XMVGROUP",36,0)
 D BLD^DIALOG(38023.1,"","","DIR(""A"")")
"RTN","XMVGROUP",37,0)
 S DIR("B")=$$EZBLD^DIALOG(39053) ; no
"RTN","XMVGROUP",38,0)
 D BLD^DIALOG(38232,"","","DIR(""?"")")
"RTN","XMVGROUP",39,0)
 ;Answer YES to forward past mail group messages.
"RTN","XMVGROUP",40,0)
 ;You will be asked for a time frame to search,
"RTN","XMVGROUP",41,0)
 ;and then MailMan will create a task to find and forward
"RTN","XMVGROUP",42,0)
 ;existing mail group messages.
"RTN","XMVGROUP",43,0)
 D ^DIR Q:$D(DIRUT)!'Y
"RTN","XMVGROUP",44,0)
 N XMINSTR,XMTSK,XMABORT
"RTN","XMVGROUP",45,0)
 I '$D(XMV) N XMV,XMDISPI,XMDUN,XMNOSEND,XMPRIV D INITAPI^XMVVITAE
"RTN","XMVGROUP",46,0)
 S XMABORT=0,XMINSTR("FLAGS")="F"
"RTN","XMVGROUP",47,0)
 D FWDBSKT(XMDUZ,.XMINSTR,.XMABORT) Q:XMABORT
"RTN","XMVGROUP",48,0)
 D FWDDATES^XMVGRP(XMDUZ,.XMINSTR,.XMABORT) Q:XMABORT
"RTN","XMVGROUP",49,0)
 D FAFMSGS^XMXGRP1(XMDUZ,$P($G(^XMB(3.8,XMIEN,0)),U,1),XMDUZ,.XMINSTR,.XMTSK)
"RTN","XMVGROUP",50,0)
 D FWDTSK(XMTSK)
"RTN","XMVGROUP",51,0)
 Q
"RTN","XMVGROUP",52,0)
FWDBSKT(XMDUZ,XMINSTR,XMABORT) ; Select basket to forward to
"RTN","XMVGROUP",53,0)
 N XMDIC,XMK
"RTN","XMVGROUP",54,0)
 S XMDIC("B")=$$EZBLD^DIALOG(37005) ;IN
"RTN","XMVGROUP",55,0)
 D SELBSKT^XMJBU(XMDUZ,39022,"L",.XMDIC,.XMK) I XMK=U S XMABORT=1 Q
"RTN","XMVGROUP",56,0)
 S XMINSTR("SELF BSKT")=XMK
"RTN","XMVGROUP",57,0)
 Q
"RTN","XMVGROUP",58,0)
FWDTSK(XMTSK) ;
"RTN","XMVGROUP",59,0)
 W !
"RTN","XMVGROUP",60,0)
 ;Task #|1| will find and forward past messages.
"RTN","XMVGROUP",61,0)
 N XMTEXT
"RTN","XMVGROUP",62,0)
 D BLD^DIALOG(38023.9,XMTSK,"","XMTEXT","F")
"RTN","XMVGROUP",63,0)
 D MSG^DIALOG("WM","",IOM,"","XMTEXT")
"RTN","XMVGROUP",64,0)
 Q
"RTN","XMVGROUP",65,0)
DROP(XMIEN,XMDUZ) ; Disenroll from a group
"RTN","XMVGROUP",66,0)
 N DIR,X,Y
"RTN","XMVGROUP",67,0)
 S DIR(0)="Y"
"RTN","XMVGROUP",68,0)
 I $P(^XMB(3.8,XMIEN,0),U,3)'="y" D
"RTN","XMVGROUP",69,0)
 . ;You're a member. Self enrollment is not allowed for this mail group.
"RTN","XMVGROUP",70,0)
 . ;If you drop out, you will not be able to re-join. (To re-join later,
"RTN","XMVGROUP",71,0)
 . ;you will have to ask the group coordinator to re-enroll you.)
"RTN","XMVGROUP",72,0)
 . ;You are a member.  Do you want to drop out
"RTN","XMVGROUP",73,0)
 . D BLD^DIALOG(38024.1,"","","DIR(""A"")")
"RTN","XMVGROUP",74,0)
 E  D  ;You are a member.  Do you want to drop out
"RTN","XMVGROUP",75,0)
 . S DIR("A")=$$EZBLD^DIALOG(38024)
"RTN","XMVGROUP",76,0)
 S DIR("B")=$$EZBLD^DIALOG(39053) ;No
"RTN","XMVGROUP",77,0)
 ;Enter YES to remove yourself from the group; NO to remain a member.
"RTN","XMVGROUP",78,0)
 D BLD^DIALOG(38025,"","","DIR(""?"")")
"RTN","XMVGROUP",79,0)
 D ^DIR Q:$D(DIRUT)!'Y
"RTN","XMVGROUP",80,0)
 K DIR,X,Y
"RTN","XMVGROUP",81,0)
 N DA,DIK
"RTN","XMVGROUP",82,0)
 S DA(1)=XMIEN,DA=$O(^XMB(3.8,XMIEN,1,"B",XMDUZ,0)),DIK="^XMB(3.8,"_XMIEN_",1,"
"RTN","XMVGROUP",83,0)
 D ^DIK
"RTN","XMVGROUP",84,0)
 W !,$$EZBLD^DIALOG(38026) ;You are no longer a member.
"RTN","XMVGROUP",85,0)
 Q
"RTN","XMVGROUP",86,0)
PERSONAL ; Enter/Edit Personal Group
"RTN","XMVGROUP",87,0)
 ; See entry EDIT for info on XMIA & XMTRKNEW
"RTN","XMVGROUP",88,0)
 N DIC,DLAYGO,X,Y,XMABORT,XMIA,XMTRKNEW
"RTN","XMVGROUP",89,0)
 S XMABORT=0,(XMIA,XMTRKNEW)=1
"RTN","XMVGROUP",90,0)
 S DIC="^XMB(3.8,",DIC(0)="AEQMZL",DLAYGO=3.8
"RTN","XMVGROUP",91,0)
 ; Group is private, and user is organizer
"RTN","XMVGROUP",92,0)
 S DIC("S")="I $P(^(0),U,2)=""PR"",$P($G(^XMB(3.8,+Y,3)),U)=$G(XMDUZ,DUZ)"
"RTN","XMVGROUP",93,0)
 F  D  Q:XMABORT
"RTN","XMVGROUP",94,0)
 . W !
"RTN","XMVGROUP",95,0)
 . D ^DIC I Y<0 S XMABORT=1 Q
"RTN","XMVGROUP",96,0)
 . N XMDR,XMNEW
"RTN","XMVGROUP",97,0)
 . S XMNEW=$P(Y,U,3)
"RTN","XMVGROUP",98,0)
 . S:XMNEW XMDR="4////PR;5////"_$G(XMDUZ,DUZ)_";10////1;"
"RTN","XMVGROUP",99,0)
 . S XMDR=$G(XMDR)_".01T;2;3" ; name, members, description
"RTN","XMVGROUP",100,0)
 . S XMDR=XMDR_";10;12" ; restrictions, remote members
"RTN","XMVGROUP",101,0)
 . D EDIT(+Y,XMDR,XMNEW)
"RTN","XMVGROUP",102,0)
 Q
"RTN","XMVGROUP",103,0)
EDIT(XMG,DR,XMNEW) ; Edit mail group
"RTN","XMVGROUP",104,0)
 ; XMIA is used for interaction on the REMOTE MEMBER input transform
"RTN","XMVGROUP",105,0)
 ; to facilitate lookup.  XMTRKNEW is used by the AC xref on the
"RTN","XMVGROUP",106,0)
 ; .01 field of the LOCAL MEMBER multiple.  If local members are added
"RTN","XMVGROUP",107,0)
 ; to the group, XMNEWMBR is set by the AC xref.
"RTN","XMVGROUP",108,0)
 N DIE,DIDEL,Y,DIC,DA,XMNEWMBR
"RTN","XMVGROUP",109,0)
 S (DIDEL,DIE)=3.8,DA=XMG
"RTN","XMVGROUP",110,0)
 S:$P(^XMB(1,1,0),U,19) DR=DR_";14;15" ; fax recipients, fax groups
"RTN","XMVGROUP",111,0)
 D ^DIE
"RTN","XMVGROUP",112,0)
 I 'XMNEW,$D(XMNEWMBR) D FWD(XMG,.XMNEWMBR)
"RTN","XMVGROUP",113,0)
 Q
"RTN","XMVGROUP",114,0)
FWD(XMG,XMTO) ; Forward past mail group messages to new local members
"RTN","XMVGROUP",115,0)
 N XMI
"RTN","XMVGROUP",116,0)
 S XMI=""
"RTN","XMVGROUP",117,0)
 F  S XMI=$O(XMTO(XMI)) Q:'XMI  K:'$D(^XMB(3.8,XMG,1,"B",XMI)) XMTO(XMI)
"RTN","XMVGROUP",118,0)
 Q:'$D(XMTO)
"RTN","XMVGROUP",119,0)
 I '$D(XMV) N XMV,XMDISPI,XMDUN,XMNOSEND,XMPRIV D INITAPI^XMVVITAE
"RTN","XMVGROUP",120,0)
 D NOTIFY^XMXGRP1(XMG,.XMTO)
"RTN","XMVGROUP",121,0)
 N XMINSTR,XMTSK,XMABORT
"RTN","XMVGROUP",122,0)
 S XMABORT=0
"RTN","XMVGROUP",123,0)
 D ENFWD^XMVGRP(XMDUZ,.XMINSTR,.XMABORT) Q:XMABORT
"RTN","XMVGROUP",124,0)
 D FAFMSGS^XMXGRP1(XMDUZ,$P(^XMB(3.8,XMG,0),U,1),.XMTO,.XMINSTR,.XMTSK)
"RTN","XMVGROUP",125,0)
 D FWDTSK(XMTSK)
"RTN","XMVGROUP",126,0)
 Q
"RTN","XMVGROUP",127,0)
LAYGO(X) ; Prevent someone from adding a (private) group with the same name as a public one.
"RTN","XMVGROUP",128,0)
 ; This function is invoked by the LAYGO field of ^XMB(3.8,.01)
"RTN","XMVGROUP",129,0)
 ; Returns 1 if group X may be created; 0 if not.
"RTN","XMVGROUP",130,0)
 N IEN,LAYGO
"RTN","XMVGROUP",131,0)
 S IEN="",LAYGO=1
"RTN","XMVGROUP",132,0)
 F  S IEN=$O(^XMB(3.8,"B",X,IEN)) Q:IEN=""  D  Q:'LAYGO
"RTN","XMVGROUP",133,0)
 . Q:$P(^XMB(3.8,IEN,0),U,2)="PR"
"RTN","XMVGROUP",134,0)
 . S LAYGO=0 ;Can't add it because public group '|1|' already exists.
"RTN","XMVGROUP",135,0)
 . D EN^DDIOL($$EZBLD^DIALOG(38027,X),"","!,$C(7)")
"RTN","XMVGROUP",136,0)
 Q LAYGO
"RTN","XMVGROUP",137,0)
REMOTE(XMADDR,XMIA) ; Serves as input transform for 'remote member'
"RTN","XMVGROUP",138,0)
 ; Allow remote addressees or local devices or local servers
"RTN","XMVGROUP",139,0)
 N XMERROR,XMRESTR,XMINSTR,XMFULL,XMPREFIX,DIX,DO
"RTN","XMVGROUP",140,0)
 S XMINSTR("ADDR FLAGS")="X" ; do not create ^TMP(, just check.
"RTN","XMVGROUP",141,0)
 I XMADDR[":" D  Q:'$D(XMADDR)
"RTN","XMVGROUP",142,0)
 . D RTYPE^XMXADDR($P(XMADDR,":")) I $D(XMERROR) K XMADDR Q
"RTN","XMVGROUP",143,0)
 . D PREFIX^XMXADDR(.XMADDR,.XMPREFIX) I $D(XMERROR) K XMADDR Q
"RTN","XMVGROUP",144,0)
 I XMADDR'["@",".D.d.H.h.S.s."'[("."_$E(XMADDR,1,2)),'$D(XMPREFIX) K XMADDR Q
"RTN","XMVGROUP",145,0)
 D ADDRESS^XMXADDR(DUZ,XMADDR,.XMFULL,.XMERROR)
"RTN","XMVGROUP",146,0)
 I $D(XMERROR) K XMADDR Q
"RTN","XMVGROUP",147,0)
 I XMFULL'["@" D
"RTN","XMVGROUP",148,0)
 . I ".D.H.S."[("."_$E(XMFULL,1,2)) S XMFULL=XMFULL_"@"_^XMB("NETNAME") Q
"RTN","XMVGROUP",149,0)
 . ;I $G(XMPREFIX)'="" S XMFULL=XMFULL_"@"_^XMB("NETNAME") Q
"RTN","XMVGROUP",150,0)
 I XMFULL'["@" D  Q
"RTN","XMVGROUP",151,0)
 . K XMADDR
"RTN","XMVGROUP",152,0)
 . D EN^DDIOL($$EZBLD^DIALOG(38028)) ;It can't be a local address, except for Device or Server.
"RTN","XMVGROUP",153,0)
 . I $E(XMFULL,1,2)="G." D EN^DDIOL($$EZBLD^DIALOG(38029)) ;Put the group in the MEMBER GROUP multiple.
"RTN","XMVGROUP",154,0)
 . E  D EN^DDIOL($$EZBLD^DIALOG(38030)) ;Put the person in the MEMBER multiple.
"RTN","XMVGROUP",155,0)
 . I $G(XMPREFIX)'="" D EN^DDIOL($$EZBLD^DIALOG(38031,XMPREFIX)) ;Put '|1|' in the TYPE field.
"RTN","XMVGROUP",156,0)
 I $G(XMPREFIX)'="" S XMFULL=XMPREFIX_":"_XMFULL
"RTN","XMVGROUP",157,0)
 S XMADDR=XMFULL
"RTN","XMVGROUP",158,0)
 Q
"RTN","XMVGROUP",159,0)
EDITMG ; Mail Group Edit
"RTN","XMVGROUP",160,0)
 ; See entry EDIT for info on XMIA & XMTRKNEW
"RTN","XMVGROUP",161,0)
 N DIC,XMABORT,DLAYGO,X,Y,XMIA,XMTRKNEW,XMREC
"RTN","XMVGROUP",162,0)
 S XMABORT=0,(XMIA,XMTRKNEW)=1,DLAYGO=3.8
"RTN","XMVGROUP",163,0)
 S DIC(0)="AEQLM",DIC="^XMB(3.8,"
"RTN","XMVGROUP",164,0)
 S DIC("S")=$$GRPSCR(0)
"RTN","XMVGROUP",165,0)
 F  D  Q:XMABORT
"RTN","XMVGROUP",166,0)
 . W !
"RTN","XMVGROUP",167,0)
 . D ^DIC I Y<0 S XMABORT=1 Q
"RTN","XMVGROUP",168,0)
 . N XMDR
"RTN","XMVGROUP",169,0)
 . S XMDR=".01T;2;3" ; name, members, description
"RTN","XMVGROUP",170,0)
 . ; type - if type is public, ask about self enrollment,
"RTN","XMVGROUP",171,0)
 . ;        else ask about restrictions.
"RTN","XMVGROUP",172,0)
 . S XMDR=XMDR_";4;I X=""PU"" S Y=7;10;S Y=5;7"
"RTN","XMVGROUP",173,0)
 . S XMDR=XMDR_";5:6.9" ; organizer, coordinator, authorized senders
"RTN","XMVGROUP",174,0)
 . S XMDR=XMDR_";10.1:13.9" ; member groups, remote members, distr list
"RTN","XMVGROUP",175,0)
 . D EDIT(+Y,XMDR,$P(Y,U,3))
"RTN","XMVGROUP",176,0)
 Q
"RTN","XMVGROUP",177,0)
GRPSCR(XMCOORD) ; Who may edit a mail group?
"RTN","XMVGROUP",178,0)
 N XMSCR,XMOK
"RTN","XMVGROUP",179,0)
 S XMOK=0
"RTN","XMVGROUP",180,0)
 I $T(ISA^USRLM)'="" S XMOK=$$ISA^USRLM(DUZ,"CLINICAL COORDINATOR")
"RTN","XMVGROUP",181,0)
 I $D(^XUSEC("XMMGR",DUZ))!$D(^XUSEC("XM GROUP EDIT MASTER",DUZ))!XMOK D
"RTN","XMVGROUP",182,0)
 . ; Screen whether group is public or (private and) unrestricted
"RTN","XMVGROUP",183,0)
 . S XMSCR="N XMREC S XMREC=^(0) I $P(XMREC,U,2)=""PU""!'$P(XMREC,U,6)!"
"RTN","XMVGROUP",184,0)
 E  S XMSCR="I " ; Or, at the very minimum,
"RTN","XMVGROUP",185,0)
 ; Screen whether user is organizer or coordinator.
"RTN","XMVGROUP",186,0)
 Q XMSCR_"($P($G(^XMB(3.8,+Y,3)),U,1)=$G(XMDUZ,DUZ))"_$S($G(XMCOORD):"!$D(^XMB(3.8,""AC"",$G(XMDUZ,DUZ),+Y))",1:"")
"RTN","XMVGROUP",187,0)
 ;
"RTN","XMVGROUP",188,0)
LCOORD ; Mail Group Coordinator edit w/o remote members
"RTN","XMVGROUP",189,0)
 D COORD(0)
"RTN","XMVGROUP",190,0)
 Q
"RTN","XMVGROUP",191,0)
RCOORD ; Mail Group Coordinator edit w/remote members
"RTN","XMVGROUP",192,0)
 D COORD(1)
"RTN","XMVGROUP",193,0)
 Q
"RTN","XMVGROUP",194,0)
COORD(XMREMOTE) ;
"RTN","XMVGROUP",195,0)
 ; See entry EDIT for info on XMIA & XMTRKNEW
"RTN","XMVGROUP",196,0)
 N DIC,XMABORT,DLAYGO,X,Y,XMIA,XMTRKNEW
"RTN","XMVGROUP",197,0)
 S XMABORT=0,(XMIA,XMTRKNEW)=1
"RTN","XMVGROUP",198,0)
 S DIC(0)="AEQM",DIC="^XMB(3.8,"
"RTN","XMVGROUP",199,0)
 S DIC("S")=$$GRPSCR(1)
"RTN","XMVGROUP",200,0)
 F  D  Q:XMABORT
"RTN","XMVGROUP",201,0)
 . W !
"RTN","XMVGROUP",202,0)
 . D ^DIC I Y<0 S XMABORT=1 Q
"RTN","XMVGROUP",203,0)
 . ; edit local members, member groups, & perhaps, remote members
"RTN","XMVGROUP",204,0)
 . D EDIT(+Y,"2;11"_$S(XMREMOTE:";12",1:""),0)
"RTN","XMVGROUP",205,0)
 Q
"RTN","XMVGRP")
0^85^B47750952
"RTN","XMVGRP",1,0)
XMVGRP ;ISC-SF/GMB-Group creation/enrollment ;03/07/2002  07:01
"RTN","XMVGRP",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMVGRP",3,0)
 ; Entry points used by MailMan options (not covered by DBIA):
"RTN","XMVGRP",4,0)
 ; ENLOCAL    XMxxxxx - Add local users to mail groups
"RTN","XMVGRP",5,0)
ENLOCAL1(XMXQUSER) ; Add local user(s) to group(s) - called from Kernel
"RTN","XMVGRP",6,0)
 ; XMXQUSER - first user being added (duz or name)
"RTN","XMVGRP",7,0)
 I '$D(XMV) N XMV,XMDISPI,XMDUN,XMNOSEND,XMPRIV
"RTN","XMVGRP",8,0)
 D INITAPI^XMVVITAE
"RTN","XMVGRP",9,0)
ENLOCAL ; Add local user(s) to mail group(s).
"RTN","XMVGRP",10,0)
 N XMGRP,XMMBR,XMINSTR,XMTSK,XMTO,XMABORT
"RTN","XMVGRP",11,0)
 S XMABORT=0
"RTN","XMVGRP",12,0)
 D ENGRP(.XMGRP,.XMABORT) Q:XMABORT!'$D(XMGRP)  ; select groups
"RTN","XMVGRP",13,0)
 D ENUSER(.XMMBR,.XMABORT,.XMXQUSER) Q:XMABORT  ; select users
"RTN","XMVGRP",14,0)
 D ENCONF(.XMGRP,.XMMBR,.XMABORT) Q:XMABORT     ; confirm it
"RTN","XMVGRP",15,0)
 D ADD2GRPZ^XMXGRP(.XMGRP,.XMMBR,.XMTO)         ; add users to groups
"RTN","XMVGRP",16,0)
 W !!,$$EZBLD^DIALOG(38233) ; Users have been added to the mail groups
"RTN","XMVGRP",17,0)
 D ENFWD(XMDUZ,.XMINSTR,.XMABORT) Q:XMABORT     ; forward msgs?
"RTN","XMVGRP",18,0)
 D FAFMSGS^XMXGRP1(XMDUZ,.XMGRP,.XMTO,.XMINSTR,.XMTSK) ; yup.
"RTN","XMVGRP",19,0)
 D FWDTSK^XMVGROUP(XMTSK) ; tell the user the task number.
"RTN","XMVGRP",20,0)
 Q
"RTN","XMVGRP",21,0)
ENGRP(XMGRP,XMABORT) ;
"RTN","XMVGRP",22,0)
 N Y
"RTN","XMVGRP",23,0)
 F  D  Q:Y=-1!XMABORT
"RTN","XMVGRP",24,0)
 . N DIC,DIR,X,XMDEL
"RTN","XMVGRP",25,0)
 . S DIR("A")=$$EZBLD^DIALOG($S($D(XMGRP):38211,1:38210)) ; Another mail group / Allocate mail group
"RTN","XMVGRP",26,0)
 . S DIR("PRE")="I $E(X)=""-"" S XMDEL=1,X=$E(X,2,99)"
"RTN","XMVGRP",27,0)
 . D BLD^DIALOG(38213,"","","DIR(""?"")")
"RTN","XMVGRP",28,0)
 . ;Enter the name of the mail group you wish to allocate.
"RTN","XMVGRP",29,0)
 . ;Precede any mail group name with '-' to remove it.
"RTN","XMVGRP",30,0)
 . ;You'll only be able to select mail groups you're authorized to edit.
"RTN","XMVGRP",31,0)
 . ;Enter ?? for a list of mail groups you've already selected,
"RTN","XMVGRP",32,0)
 . ;and for mail group help.
"RTN","XMVGRP",33,0)
 . S DIR("??")="^D HELPGRP^XMVGRP"
"RTN","XMVGRP",34,0)
 . S DIR(0)="PO^3.8:FEMQ"
"RTN","XMVGRP",35,0)
 . S DIC("S")=$$GRPSCR^XMVGROUP(1)
"RTN","XMVGRP",36,0)
 . D ^DIR I $D(DTOUT)!$D(DUOUT) S XMABORT=1 Q
"RTN","XMVGRP",37,0)
 . Q:Y=-1
"RTN","XMVGRP",38,0)
 . I '$G(XMDEL) S XMGRP($P(Y,U,2))=+Y Q
"RTN","XMVGRP",39,0)
 . I '$D(XMGRP($P(Y,U,2))) W $C(7),$$EZBLD^DIALOG(38214) Q  ; ?? Not on current list.
"RTN","XMVGRP",40,0)
 . K XMGRP($P(Y,U,2))
"RTN","XMVGRP",41,0)
 . W $$EZBLD^DIALOG(38215) ;   Deleted from current list.
"RTN","XMVGRP",42,0)
 Q
"RTN","XMVGRP",43,0)
HELPGRP ;
"RTN","XMVGRP",44,0)
 I '$D(XMGRP) W !,$$EZBLD^DIALOG(38216) ; You haven't selected any mail groups yet.
"RTN","XMVGRP",45,0)
 E  D SHOWGRP
"RTN","XMVGRP",46,0)
 N DIR,X,Y,DIRUT,DTOUT,DIRUT
"RTN","XMVGRP",47,0)
 S DIR("A")=$$EZBLD^DIALOG(38217) ; Want mail group help
"RTN","XMVGRP",48,0)
 S DIR(0)="Y"
"RTN","XMVGRP",49,0)
 S DIR("B")=$$EZBLD^DIALOG(39053) ; NO
"RTN","XMVGRP",50,0)
 D ^DIR Q:'Y
"RTN","XMVGRP",51,0)
 ;D HELP^XMHIG
"RTN","XMVGRP",52,0)
 N DIC,X,Y,DLAYGO
"RTN","XMVGRP",53,0)
 S DIC(0)="AEQM",DIC="^XMB(3.8,"
"RTN","XMVGRP",54,0)
 S DIC("S")=$$GRPSCR^XMVGROUP(1)
"RTN","XMVGRP",55,0)
 F  W ! D ^DIC Q:Y<0  D
"RTN","XMVGRP",56,0)
 . D DISPLAY^XMHIG(+Y)
"RTN","XMVGRP",57,0)
 Q
"RTN","XMVGRP",58,0)
SHOWGRP ;
"RTN","XMVGRP",59,0)
 N XMI,XMJ,XML,XMLN
"RTN","XMVGRP",60,0)
 W !!,$$EZBLD^DIALOG(38218) ; You've selected the following mail groups:
"RTN","XMVGRP",61,0)
 S XML=0,XMI="" F  S XMI=$O(XMGRP(XMI)) Q:XMI=""  I $L(XMI)>XML S XML=$L(XMI)
"RTN","XMVGRP",62,0)
 S XML=XML+3,XMLN=80\XML
"RTN","XMVGRP",63,0)
 S XMI=""
"RTN","XMVGRP",64,0)
 F XMJ=0:1 S XMI=$O(XMGRP(XMI)) Q:XMI=""  D
"RTN","XMVGRP",65,0)
 . W:'(XMJ#XMLN) ! W ?(XMJ#XMLN*XML),XMI
"RTN","XMVGRP",66,0)
 Q
"RTN","XMVGRP",67,0)
ENUSER(XMMBR,XMABORT,XMUSER) ;
"RTN","XMVGRP",68,0)
 N XMX,XMDONE
"RTN","XMVGRP",69,0)
 W !
"RTN","XMVGRP",70,0)
 S XMDONE=0
"RTN","XMVGRP",71,0)
 F  D  Q:XMDONE!XMABORT
"RTN","XMVGRP",72,0)
 . N XMDEL
"RTN","XMVGRP",73,0)
 . W !,$$EZBLD^DIALOG($S($D(XMMBR):38221,1:38220)) ; Another user: / Add user:
"RTN","XMVGRP",74,0)
 . I $G(XMUSER)'="" D
"RTN","XMVGRP",75,0)
 . . S XMX=XMUSER
"RTN","XMVGRP",76,0)
 . . K XMUSER
"RTN","XMVGRP",77,0)
 . . W XMX
"RTN","XMVGRP",78,0)
 . E  D  Q:XMX=""
"RTN","XMVGRP",79,0)
 . . R XMX:DTIME S:'$T XMX=U I XMX[U S XMABORT=1 Q
"RTN","XMVGRP",80,0)
 . . I XMX="" D  Q
"RTN","XMVGRP",81,0)
 . . . I $D(XMMBR) S XMDONE=1 Q
"RTN","XMVGRP",82,0)
 . . . W $C(7)," ??",!,$$EZBLD^DIALOG(38222) ; You must select a user, or enter ^ to exit.
"RTN","XMVGRP",83,0)
 . . I XMX?1."?" D HELPUSR(XMX) S:XMX'="?" XMX="" Q
"RTN","XMVGRP",84,0)
 . . I $E(XMX)="-" S XMDEL=1,XMX=$E(XMX,2,99) W:XMX="" " ??",$C(7)
"RTN","XMVGRP",85,0)
 . N DIC,D,X,Y,DLAYGO,XMNAME
"RTN","XMVGRP",86,0)
 . S X=$$UP^XLFSTR(XMX)
"RTN","XMVGRP",87,0)
 . S DIC("S")="I $L($P(^(0),U,3)),$D(^XMB(3.7,+Y,2))" ; User must have an access code & mailbox
"RTN","XMVGRP",88,0)
 . S DIC("W")="I Y'=DUZ D USERINFO^XMXADDR1(Y)"
"RTN","XMVGRP",89,0)
 . S DIC="^VA(200,"
"RTN","XMVGRP",90,0)
 . S DIC(0)="FEMN"  ; 'N' means if user enters a DUZ, ask "OK?"
"RTN","XMVGRP",91,0)
 . S D="B^BB^C^D" ; name^alias^initial^nickname
"RTN","XMVGRP",92,0)
 . D MIX^DIC1 I $D(DTOUT)!$D(DUOUT) S XMABORT=1 Q
"RTN","XMVGRP",93,0)
 . I Y<0 W " ??",$C(7) Q
"RTN","XMVGRP",94,0)
 . S XMNAME=$$NAME^XMXUTIL(+Y) ; $P(Y,U,2)
"RTN","XMVGRP",95,0)
 . I '$G(XMDEL) S XMMBR(XMNAME)=+Y Q
"RTN","XMVGRP",96,0)
 . I '$D(XMMBR(XMNAME)) W !,$C(7),$$EZBLD^DIALOG(38214) Q  ; ?? Not on current list.
"RTN","XMVGRP",97,0)
 . K XMMBR(XMNAME)
"RTN","XMVGRP",98,0)
 . W !,$$EZBLD^DIALOG(38215) ;  Deleted from current list.
"RTN","XMVGRP",99,0)
 Q
"RTN","XMVGRP",100,0)
HELPUSR(XMX) ;
"RTN","XMVGRP",101,0)
 I XMX="?" D  Q
"RTN","XMVGRP",102,0)
 . N XMTEXT
"RTN","XMVGRP",103,0)
 . D BLD^DIALOG(38223,"","","XMTEXT","F")
"RTN","XMVGRP",104,0)
 . D MSG^DIALOG("WH","","","","XMTEXT")
"RTN","XMVGRP",105,0)
 . ;Enter the name of the user you wish to add to the group(s).
"RTN","XMVGRP",106,0)
 . ;Precede any user name with '-' to remove it.
"RTN","XMVGRP",107,0)
 . ;You'll only be able to select users with mailboxes and access codes.
"RTN","XMVGRP",108,0)
 . ;Enter ?? for a list of users you've already selected,
"RTN","XMVGRP",109,0)
 . ;and for user help.
"RTN","XMVGRP",110,0)
 I '$D(XMMBR) W !,$$EZBLD^DIALOG(38226) ;You haven't selected any users yet.
"RTN","XMVGRP",111,0)
 E  D SHOWUSR
"RTN","XMVGRP",112,0)
 N DIR,X,Y,DIRUT,DTOUT,DIRUT
"RTN","XMVGRP",113,0)
 S DIR("A")=$$EZBLD^DIALOG(38224) ; Want user help
"RTN","XMVGRP",114,0)
 S DIR(0)="Y"
"RTN","XMVGRP",115,0)
 S DIR("B")=$$EZBLD^DIALOG(39053) ; NO
"RTN","XMVGRP",116,0)
 D ^DIR Q:'Y
"RTN","XMVGRP",117,0)
 D HELP^XMHIU
"RTN","XMVGRP",118,0)
 Q
"RTN","XMVGRP",119,0)
SHOWUSR ;
"RTN","XMVGRP",120,0)
 N XMI,XMJ,XML,XMLN
"RTN","XMVGRP",121,0)
 W !!,$$EZBLD^DIALOG(38225) ; You've selected the following users:
"RTN","XMVGRP",122,0)
 S XML=0,XMI="" F  S XMI=$O(XMMBR(XMI)) Q:XMI=""  I $L(XMI)>XML S XML=$L(XMI)
"RTN","XMVGRP",123,0)
 S XML=XML+3,XMLN=80\XML
"RTN","XMVGRP",124,0)
 S XMI=""
"RTN","XMVGRP",125,0)
 F XMJ=0:1 S XMI=$O(XMMBR(XMI)) Q:XMI=""  D
"RTN","XMVGRP",126,0)
 . W:'(XMJ#XMLN) ! W ?(XMJ#XMLN*XML),XMI
"RTN","XMVGRP",127,0)
 Q
"RTN","XMVGRP",128,0)
ENCONF(XMGRP,XMMBR,XMABORT) ;
"RTN","XMVGRP",129,0)
 D SHOWGRP
"RTN","XMVGRP",130,0)
 D SHOWUSR
"RTN","XMVGRP",131,0)
 W !
"RTN","XMVGRP",132,0)
 N DIR,X,Y
"RTN","XMVGRP",133,0)
 D BLD^DIALOG(38230,"","","DIR(""A"")") ; You are adding users to mail groups.  Do you wish to proceed
"RTN","XMVGRP",134,0)
 S DIR(0)="Y"
"RTN","XMVGRP",135,0)
 S DIR("B")=$$EZBLD^DIALOG(39054) ; yes
"RTN","XMVGRP",136,0)
 D ^DIR I 'Y S XMABORT=1
"RTN","XMVGRP",137,0)
 Q
"RTN","XMVGRP",138,0)
ENFWD(XMDUZ,XMINSTR,XMABORT) ;
"RTN","XMVGRP",139,0)
 W !
"RTN","XMVGRP",140,0)
 N DIR,X,Y
"RTN","XMVGRP",141,0)
 D BLD^DIALOG(38231,"","","DIR(""A"")")
"RTN","XMVGRP",142,0)
 ;Do you wish to forward past mail group messages
"RTN","XMVGRP",143,0)
 ;to the user(s) you just added to the mail group(s)
"RTN","XMVGRP",144,0)
 D BLD^DIALOG(38232,"","","DIR(""?"")")
"RTN","XMVGRP",145,0)
 ;Answer YES to forward past mail group messages.
"RTN","XMVGRP",146,0)
 ;You will be asked for a time frame to search,
"RTN","XMVGRP",147,0)
 ;and then MailMan will create a task to find and forward
"RTN","XMVGRP",148,0)
 ;existing mail group messages.
"RTN","XMVGRP",149,0)
 S DIR(0)="Y"
"RTN","XMVGRP",150,0)
 S DIR("B")=$$EZBLD^DIALOG(39053) ; no
"RTN","XMVGRP",151,0)
 D ^DIR I $D(DIRUT)!'Y S XMABORT=1 Q
"RTN","XMVGRP",152,0)
 D FWDDATES(XMDUZ,.XMINSTR,.XMABORT) Q:XMABORT
"RTN","XMVGRP",153,0)
 S XMINSTR("FLAGS")="F"
"RTN","XMVGRP",154,0)
 Q
"RTN","XMVGRP",155,0)
FWDDATES(XMDUZ,XMINSTR,XMABORT) ;
"RTN","XMVGRP",156,0)
 ; Message sent on or before date
"RTN","XMVGRP",157,0)
 N DIR,Y,X,XMOLDEST,XMTEXT
"RTN","XMVGRP",158,0)
 ;S XMOLDEST=$O(^XMB(3.9,"C",""))
"RTN","XMVGRP",159,0)
 F  S XMOLDEST=$O(^XMB(3.9,"C","")) Q:XMOLDEST?1N.N  K ^XMB(3.9,"C",XMOLDEST) ; kill bogus nodes
"RTN","XMVGRP",160,0)
 ; You will now choose a date range for the messages to be searched
"RTN","XMVGRP",161,0)
 ; and forwarded.  The oldest message is from XMOLDEST.
"RTN","XMVGRP",162,0)
 W !
"RTN","XMVGRP",163,0)
 D BLD^DIALOG(38023.5,$$FMTE^XLFDT(XMOLDEST,5),"","XMTEXT","F")
"RTN","XMVGRP",164,0)
 D MSG^DIALOG("WM","",IOM,"","XMTEXT")
"RTN","XMVGRP",165,0)
 I $P(^XMB(3.7,XMDUZ,0),U,7) D
"RTN","XMVGRP",166,0)
 . N XMCUT
"RTN","XMVGRP",167,0)
 . S XMCUT=$P(^XMB(3.7,XMDUZ,0),U,7)
"RTN","XMVGRP",168,0)
 . Q:XMCUT<XMOLDEST
"RTN","XMVGRP",169,0)
 . ; You may not access any message prior to |1| unless someone
"RTN","XMVGRP",170,0)
 . ; forwards it to you.
"RTN","XMVGRP",171,0)
 . D BLD^DIALOG(37100,$$FMTE^XLFDT(XMCUT,5),"","XMTEXT","F")
"RTN","XMVGRP",172,0)
 . D MSG^DIALOG("WE","",IOM,"","XMTEXT")
"RTN","XMVGRP",173,0)
 . S XMOLDEST=XMCUT
"RTN","XMVGRP",174,0)
 W !
"RTN","XMVGRP",175,0)
 S DIR(0)="DO^"_XMOLDEST_":DT:EX"
"RTN","XMVGRP",176,0)
 S DIR("A")=$$EZBLD^DIALOG(34444) ; Message sent on or after
"RTN","XMVGRP",177,0)
 D BLD^DIALOG(34444.1,"","","DIR(""?"")")
"RTN","XMVGRP",178,0)
 ; Enter a date.  It must include day, month, and year.
"RTN","XMVGRP",179,0)
 S DIR("B")=$$FMTE^XLFDT($$MAX^XLFMTH(XMOLDEST,$$FMADD^XLFDT(DT,-365)),5)
"RTN","XMVGRP",180,0)
 D ^DIR I $D(DIRUT) S XMABORT=1 Q
"RTN","XMVGRP",181,0)
 S XMINSTR("FDATE")=Y
"RTN","XMVGRP",182,0)
 ; Message sent on or before date
"RTN","XMVGRP",183,0)
 I XMINSTR("FDATE")=DT S XMINSTR("TDATE")=DT Q
"RTN","XMVGRP",184,0)
 K DIR,Y,X
"RTN","XMVGRP",185,0)
 S DIR(0)="DO^"_XMINSTR("FDATE")_":DT:EX"
"RTN","XMVGRP",186,0)
 S DIR("A")=$$EZBLD^DIALOG(34445) ; Message sent on or before
"RTN","XMVGRP",187,0)
 D BLD^DIALOG(34444.1,"","","DIR(""?"")")
"RTN","XMVGRP",188,0)
 ; Enter a date.  It must include day, month, and year.
"RTN","XMVGRP",189,0)
 S DIR("B")=$$FMTE^XLFDT(DT,5)
"RTN","XMVGRP",190,0)
 D ^DIR I $D(DIRUT) S XMABORT=1 Q
"RTN","XMVGRP",191,0)
 S XMINSTR("TDATE")=Y
"RTN","XMVGRP",192,0)
 Q
"RTN","XMVPIC")
1^176
"RTN","XMVSTUFF")
1^177
"RTN","XMVSURR")
0^358^B8214736
"RTN","XMVSURR",1,0)
XMVSURR ;ISC-SF/GMB-Surrogate management ;04/19/2002  11:32
"RTN","XMVSURR",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMVSURR",3,0)
 ; Replaces ^XMA7 (ISC-WASH/RJ/THM/CAP)
"RTN","XMVSURR",4,0)
 ; Entry points used by MailMan options (not covered by DBIA):
"RTN","XMVSURR",5,0)
 ; SHARE    XMSHARE  - Become SHARED,MAIL
"RTN","XMVSURR",6,0)
 ; ASSUME   XMASSUME - Become another user
"RTN","XMVSURR",7,0)
SHARE ; Assume the identity of SHARED,MAIL
"RTN","XMVSURR",8,0)
 Q:'$$CHKOK
"RTN","XMVSURR",9,0)
 S XMDUZ=.6
"RTN","XMVSURR",10,0)
 D SURROGAT^XMVVITAE(XMDUZ,.XMV,.XMDUN,"",.XMPRIV)
"RTN","XMVSURR",11,0)
 D HEADER^XM
"RTN","XMVSURR",12,0)
 D MANAGE^XMJBM
"RTN","XMVSURR",13,0)
 D SELF
"RTN","XMVSURR",14,0)
 Q
"RTN","XMVSURR",15,0)
CHKOK() ;
"RTN","XMVSURR",16,0)
 I $D(^XUSEC("XMNOPRIV",DUZ)) D  Q 0
"RTN","XMVSURR",17,0)
 . N XMTEXT  ;You have been given the XMNOPRIV key
"RTN","XMVSURR",18,0)
 . W $C(7) ;and may not become anyone's surrogate.
"RTN","XMVSURR",19,0)
 . D BLD^DIALOG(38053,"","","XMTEXT","F")
"RTN","XMVSURR",20,0)
 . D MSG^DIALOG("WE","","","","XMTEXT")
"RTN","XMVSURR",21,0)
 D CHECK^XMVVITAE
"RTN","XMVSURR",22,0)
 Q 1
"RTN","XMVSURR",23,0)
SELF ;
"RTN","XMVSURR",24,0)
 D SELF^XMVVITAE
"RTN","XMVSURR",25,0)
 W $C(7),!,$$EZBLD^DIALOG(38054),! ;You are now yourself again.
"RTN","XMVSURR",26,0)
 D HEADER^XM
"RTN","XMVSURR",27,0)
 Q
"RTN","XMVSURR",28,0)
ASSUME ; Assume someone else's identity
"RTN","XMVSURR",29,0)
 I '$D(^XMB(3.7,"AB",DUZ)) D SHARE Q
"RTN","XMVSURR",30,0)
 Q:'$$CHKOK
"RTN","XMVSURR",31,0)
 D LISTEM
"RTN","XMVSURR",32,0)
 N DIC,Y
"RTN","XMVSURR",33,0)
 S DIC(0)="AEMQZ"
"RTN","XMVSURR",34,0)
 S D="B^BB^C^D"
"RTN","XMVSURR",35,0)
 S DIC="^VA(200,"
"RTN","XMVSURR",36,0)
 S DIC("W")="D SHOWPRIV^XMVSURR(Y)"
"RTN","XMVSURR",37,0)
 S DIC("S")="I Y=.6!$D(^XMB(3.7,""AB"",DUZ,Y))"
"RTN","XMVSURR",38,0)
 I XMDUZ=DUZ D
"RTN","XMVSURR",39,0)
 . S DIC("B")=$$NAME^XMXUTIL(.6) ; SHARED,MAIL
"RTN","XMVSURR",40,0)
 E  D
"RTN","XMVSURR",41,0)
 . N XMTEXT
"RTN","XMVSURR",42,0)
 . S DIC("S")=DIC("S")_"!(Y=DUZ),Y'=XMDUZ"
"RTN","XMVSURR",43,0)
 . S DIC("B")=XMV("DUZ NAME")
"RTN","XMVSURR",44,0)
 . ;You may select yourself to resume your own identity.
"RTN","XMVSURR",45,0)
 . D BLD^DIALOG(38055,"","","XMTEXT","F")
"RTN","XMVSURR",46,0)
 . D MSG^DIALOG("WE","","","","XMTEXT")
"RTN","XMVSURR",47,0)
 D MIX^DIC1 I Y=-1!$D(DUOUT)!$D(DTOUT) Q
"RTN","XMVSURR",48,0)
 S XMDUZ=+Y
"RTN","XMVSURR",49,0)
 I XMDUZ=DUZ D SELF Q
"RTN","XMVSURR",50,0)
 I XMDUZ=.6 D SHARE Q
"RTN","XMVSURR",51,0)
 D OTHER^XMVVITAE
"RTN","XMVSURR",52,0)
 D HEADER^XM
"RTN","XMVSURR",53,0)
 Q
"RTN","XMVSURR",54,0)
LISTEM ; List surrogates a user may become
"RTN","XMVSURR",55,0)
 N XMDUZ
"RTN","XMVSURR",56,0)
 W !,$$EZBLD^DIALOG(38056) ;Choose from:
"RTN","XMVSURR",57,0)
 S XMDUZ=0
"RTN","XMVSURR",58,0)
 F  S XMDUZ=$O(^XMB(3.7,"AB",DUZ,XMDUZ)) Q:'XMDUZ  W !,?3,$E($$NAME^XMXUTIL(XMDUZ),1,32) D SHOWPRIV(XMDUZ)
"RTN","XMVSURR",59,0)
 W !,?3,$$NAME^XMXUTIL(.6) D SHOWPRIV(.6) W !
"RTN","XMVSURR",60,0)
 Q
"RTN","XMVSURR",61,0)
SHOWPRIV(XMDUZ) ;
"RTN","XMVSURR",62,0)
 Q:XMDUZ=DUZ
"RTN","XMVSURR",63,0)
 I XMDUZ=.6 W ?37,$$EZBLD^DIALOG(38048) Q  ;Read Privilege
"RTN","XMVSURR",64,0)
 N XMPRIV,XMNEW
"RTN","XMVSURR",65,0)
 S XMPRIV=$P($G(^XMB(3.7,XMDUZ,9,+$O(^XMB(3.7,"AB",DUZ,XMDUZ,0)),0)),U,2,3)
"RTN","XMVSURR",66,0)
 I XMPRIV'["y" W ?37,$$EZBLD^DIALOG(38046) Q  ;No Privileges
"RTN","XMVSURR",67,0)
 I $L(XMPRIV,"y")>2 W ?37,$$EZBLD^DIALOG(38047) ;Read and Send Privileges
"RTN","XMVSURR",68,0)
 E  W ?37,$$EZBLD^DIALOG($S($P(XMPRIV,U)["y":38048,1:38049)) ; Read/Send Privilege
"RTN","XMVSURR",69,0)
 S XMNEW=$$TNMSGCT^XMXUTIL(XMDUZ)
"RTN","XMVSURR",70,0)
 W " ",$J($$EZBLD^DIALOG($S(XMNEW:38052,1:38051),XMNEW),79-$X) ; x/No New Msgs
"RTN","XMVSURR",71,0)
 Q
"RTN","XMVTEST")
1^178
"RTN","XMVVITA")
0^225^B34730890
"RTN","XMVVITA",1,0)
XMVVITA ;ISC-SF/GMB-Edit User's MailMan Variables ;04/11/2002  10:39
"RTN","XMVVITA",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMVVITA",3,0)
 ; Replaces ^XMGAPI1,FWD^XMA21FWD,BANNER^XMA6,EDIT^XMA7 (ISC-WASH/CAP)
"RTN","XMVVITA",4,0)
 ;
"RTN","XMVVITA",5,0)
 ; Entry points used by MailMan options (not covered by DBIA):
"RTN","XMVVITA",6,0)
 ; BANNER   XMBANNER       - Edit user's banner
"RTN","XMVVITA",7,0)
 ; EDIT     XMEDITUSER     - Edit user's preferences
"RTN","XMVVITA",8,0)
 ; FILTER   XM FILTER EDIT - Edit user's message filters
"RTN","XMVVITA",9,0)
 ; BASKET   XM DELIVERY BASKET EDIT - Edit user's delivery basket preferences
"RTN","XMVVITA",10,0)
 ; FORWARD  XMEDITFWD      - Edit user's forwarding address
"RTN","XMVVITA",11,0)
 ; SURR     XMEDITSURR     - Edit user's surrogates
"RTN","XMVVITA",12,0)
FORWARD ; Edit forwarding address
"RTN","XMVVITA",13,0)
 N XMIA
"RTN","XMVVITA",14,0)
 S XMIA=1
"RTN","XMVVITA",15,0)
 N DIE,DA,DR
"RTN","XMVVITA",16,0)
 S DIE=3.7
"RTN","XMVVITA",17,0)
 S DA=DUZ
"RTN","XMVVITA",18,0)
 S DR="2;2.1"
"RTN","XMVVITA",19,0)
 D ^DIE
"RTN","XMVVITA",20,0)
 Q
"RTN","XMVVITA",21,0)
XMFWD(XMADDR,XMIA) ; Serves as input transform for 'forwarding address'
"RTN","XMVVITA",22,0)
 N XMERROR,XMRESTR,XMINSTR,XMFULL
"RTN","XMVVITA",23,0)
 I XMADDR'["@",".D.d.H.h.S.s."'[("."_$E(XMADDR,1,2)) K XMADDR Q
"RTN","XMVVITA",24,0)
 S XMINSTR("ADDR FLAGS")="X" ; do not create ^TMP(, just check.
"RTN","XMVVITA",25,0)
 D ADDRESS^XMXADDR(DUZ,XMADDR,.XMFULL,.XMERROR)
"RTN","XMVVITA",26,0)
 I $D(XMERROR) K XMADDR Q
"RTN","XMVVITA",27,0)
 I XMFULL'["@" D
"RTN","XMVVITA",28,0)
 . ; Remote address is really local.  OK if device or server.
"RTN","XMVVITA",29,0)
 . I ".D.H.S."[("."_$E(XMFULL,1,2)) S XMFULL=XMFULL_"@"_^XMB("NETNAME")
"RTN","XMVVITA",30,0)
 I XMFULL'["@" D  Q
"RTN","XMVVITA",31,0)
 . ; Remote address is really local
"RTN","XMVVITA",32,0)
 . K XMADDR
"RTN","XMVVITA",33,0)
 . D EN^DDIOL($$EZBLD^DIALOG(38130)) ; You can't have your mail forwarded to a local address.
"RTN","XMVVITA",34,0)
 S XMADDR=XMFULL
"RTN","XMVVITA",35,0)
 Q
"RTN","XMVVITA",36,0)
DELFWD(XMUSER,XMFWD,XMERROR) ; Delete a user's invalid forwarding address.
"RTN","XMVVITA",37,0)
 S XMFDA(3.7,XMUSER_",",2)="@"
"RTN","XMVVITA",38,0)
 D FILE^DIE("","XMFDA")
"RTN","XMVVITA",39,0)
 N XMPARM,XMINSTR
"RTN","XMVVITA",40,0)
 S XMINSTR("FROM")=.5
"RTN","XMVVITA",41,0)
 S XMPARM(1)=XMFWD,XMPARM(2)=XMERROR
"RTN","XMVVITA",42,0)
 D TASKBULL^XMXBULL(.5,"XM FWD ADDRESS DELETE",.XMPARM,"",XMUSER,.XMINSTR)
"RTN","XMVVITA",43,0)
 Q
"RTN","XMVVITA",44,0)
BANNER ; Edit banner
"RTN","XMVVITA",45,0)
 N DIE,DA,DR
"RTN","XMVVITA",46,0)
 S DIE=3.7
"RTN","XMVVITA",47,0)
 S (XMDUZ,DA)=$G(XMDUZ,DUZ)
"RTN","XMVVITA",48,0)
 S DR=4
"RTN","XMVVITA",49,0)
 D ^DIE
"RTN","XMVVITA",50,0)
 D SETBAN^XMVVITAE(XMDUZ,.XMV)
"RTN","XMVVITA",51,0)
 Q
"RTN","XMVVITA",52,0)
FILTER ; Edit filters
"RTN","XMVVITA",53,0)
 N DIE,DA,DR,XMIA
"RTN","XMVVITA",54,0)
 S XMIA=1
"RTN","XMVVITA",55,0)
 S DIE=3.7
"RTN","XMVVITA",56,0)
 S DA=DUZ
"RTN","XMVVITA",57,0)
 S DR="16;15"     ; Message filters flag ; Message filters
"RTN","XMVVITA",58,0)
 D ^DIE
"RTN","XMVVITA",59,0)
 Q:$D(^XMB(3.7,DUZ,15,"AF"))
"RTN","XMVVITA",60,0)
 W !!,$C(7),$$EZBLD^DIALOG(38131) ; Note that you have no active filters.
"RTN","XMVVITA",61,0)
 Q
"RTN","XMVVITA",62,0)
BASKET ; Edit delivery baskets
"RTN","XMVVITA",63,0)
 N DIE,DA,DR
"RTN","XMVVITA",64,0)
 S DIE=3.7
"RTN","XMVVITA",65,0)
 S DA=DUZ
"RTN","XMVVITA",66,0)
 S DR="16.2;S:X'=""S"" Y=0;1"     ; Accept delivery basket? ; Select basket.
"RTN","XMVVITA",67,0)
 S DR(2,3.701)="3" ; Is this a delivery basket?
"RTN","XMVVITA",68,0)
 D ^DIE
"RTN","XMVVITA",69,0)
 Q
"RTN","XMVVITA",70,0)
SURR ; Edit Surrogates
"RTN","XMVVITA",71,0)
 N DIE,DA,DR
"RTN","XMVVITA",72,0)
 S DIE="^XMB(3.7,"
"RTN","XMVVITA",73,0)
 S DA=DUZ
"RTN","XMVVITA",74,0)
 S DR="8"         ; surrogate
"RTN","XMVVITA",75,0)
 D ^DIE
"RTN","XMVVITA",76,0)
 Q
"RTN","XMVVITA",77,0)
EDIT ; Edit User Preferences
"RTN","XMVVITA",78,0)
 N DIE,DA,DR
"RTN","XMVVITA",79,0)
 D CHECK^XMVVITAE
"RTN","XMVVITA",80,0)
 W !!,$$EZBLD^DIALOG(38132,$$GET1^DID(3.7,"","","NAME")) ; Editing data in the MAILBOX file:
"RTN","XMVVITA",81,0)
 S DIE="^XMB(3.7,"
"RTN","XMVVITA",82,0)
 S DA=DUZ
"RTN","XMVVITA",83,0)
 S DR=""
"RTN","XMVVITA",84,0)
 S DR=DR_";4"         ; banner
"RTN","XMVVITA",85,0)
 S DR=DR_";17"        ; message display order
"RTN","XMVVITA",86,0)
 S DR=DR_";21"        ; new message read order
"RTN","XMVVITA",87,0)
 S DR=DR_";18"        ; message reader default
"RTN","XMVVITA",88,0)
 S DR=DR_";19"        ; message reader prompt
"RTN","XMVVITA",89,0)
 S DR=DR_";20"        ; new messages default option
"RTN","XMVVITA",90,0)
 S DR=DR_";6"         ; show message preview
"RTN","XMVVITA",91,0)
 S DR=DR_";11"        ; message action default
"RTN","XMVVITA",92,0)
 S DR=DR_";12"        ; ask basket
"RTN","XMVVITA",93,0)
 S DR=DR_";13"        ; show titles
"RTN","XMVVITA",94,0)
 S DR=DR_";14"        ; priority responses flag
"RTN","XMVVITA",95,0)
 S DR=DR_";14.1"      ; priority responses prompt
"RTN","XMVVITA",96,0)
 S DR=DR_";16.3"      ; p-message queued from
"RTN","XMVVITA",97,0)
 S DR=DR_";9"         ; mailman institution
"RTN","XMVVITA",98,0)
 S DR=DR_";2.21:2.23" ; network signature lines
"RTN","XMVVITA",99,0)
 S DR=DR_";4.5"       ; introduction
"RTN","XMVVITA",100,0)
 S DR=$E(DR,2,99)
"RTN","XMVVITA",101,0)
 D ^DIE
"RTN","XMVVITA",102,0)
 D NEWORDER
"RTN","XMVVITA",103,0)
 W !!,$$EZBLD^DIALOG(38132,$$GET1^DID(200,"","","NAME")) ; Editing data in the NEW PERSON file:
"RTN","XMVVITA",104,0)
 S DIE="^VA(200,"
"RTN","XMVVITA",105,0)
 S DA=DUZ
"RTN","XMVVITA",106,0)
 S DR=""
"RTN","XMVVITA",107,0)
 S DR=DR_";31.3"      ; preferred editor
"RTN","XMVVITA",108,0)
 S DR=DR_";.111"      ; street address 1
"RTN","XMVVITA",109,0)
 S DR=DR_";.112"      ; street address 2
"RTN","XMVVITA",110,0)
 S DR=DR_";.113"      ; street address 3
"RTN","XMVVITA",111,0)
 S DR=DR_";.114"      ; city
"RTN","XMVVITA",112,0)
 S DR=DR_";.115"      ; state
"RTN","XMVVITA",113,0)
 S DR=DR_";.116"      ; zip
"RTN","XMVVITA",114,0)
 S DR=DR_";.132"      ; office phone
"RTN","XMVVITA",115,0)
 S DR=DR_";.136"      ; fax #
"RTN","XMVVITA",116,0)
 S DR=DR_";.137"      ; voice pager
"RTN","XMVVITA",117,0)
 S DR=DR_";.138"      ; digital pager
"RTN","XMVVITA",118,0)
 S DR=DR_";.133"_$$EZBLD^DIALOG(38133,1) ; ADD'L PHONE 1  phone #3
"RTN","XMVVITA",119,0)
 S DR=DR_";.134"_$$EZBLD^DIALOG(38133,2) ; ADD'L PHONE 2  phone #4
"RTN","XMVVITA",120,0)
 S DR=$E(DR,2,99)
"RTN","XMVVITA",121,0)
 D ^DIE
"RTN","XMVVITA",122,0)
 D PREFER^XMVVITAE(DUZ,.XMV,.XMDISPI)
"RTN","XMVVITA",123,0)
 D SETBAN^XMVVITAE(XMDUZ,.XMV)
"RTN","XMVVITA",124,0)
 D SETNET^XMVVITAE(XMDUZ,.XMV)
"RTN","XMVVITA",125,0)
 Q
"RTN","XMVVITA",126,0)
NEWORDER ;
"RTN","XMVVITA",127,0)
 N XMDIC,XMK
"RTN","XMVVITA",128,0)
 I $D(^XMB(3.7,DUZ,2,"AP")) D
"RTN","XMVVITA",129,0)
 . N I,XMKN,XMTEXT
"RTN","XMVVITA",130,0)
 . W !
"RTN","XMVVITA",131,0)
 . ;Current priority order for reading baskets with new messages:
"RTN","XMVVITA",132,0)
 . D BLD^DIALOG(38140,"","","XMTEXT","F")
"RTN","XMVVITA",133,0)
 . D MSG^DIALOG("WM","","","","XMTEXT")
"RTN","XMVVITA",134,0)
 . S (I,XMK)=0
"RTN","XMVVITA",135,0)
 . F  S I=$O(^XMB(3.7,DUZ,2,"AP",I)) Q:'I  D
"RTN","XMVVITA",136,0)
 . . F  S XMK=$O(^XMB(3.7,DUZ,2,"AP",I,XMK)) Q:'XMK  D
"RTN","XMVVITA",137,0)
 . . . S ^TMP("XM",$J,"AP",I,$$BSKTNAME^XMXUTIL(DUZ,XMK))=""
"RTN","XMVVITA",138,0)
 . S I=0,XMKN=""
"RTN","XMVVITA",139,0)
 . F  S I=$O(^TMP("XM",$J,"AP",I)) Q:'I  D
"RTN","XMVVITA",140,0)
 . . F  S XMKN=$O(^TMP("XM",$J,"AP",I,XMKN)) Q:XMKN=""  D
"RTN","XMVVITA",141,0)
 . . . W !,$J(I,4),?8,XMKN
"RTN","XMVVITA",142,0)
 . K ^TMP("XM",$J,"AP")
"RTN","XMVVITA",143,0)
 W !
"RTN","XMVVITA",144,0)
 ;Editing the priority order for reading baskets with new messages.
"RTN","XMVVITA",145,0)
 ;Note:  You don't need priority ordering unless you want to change the
"RTN","XMVVITA",146,0)
 ;default 'read new messages' basket from IN to other basket(s).
"RTN","XMVVITA",147,0)
 D BLD^DIALOG(38141,"","","XMTEXT","F")
"RTN","XMVVITA",148,0)
 D MSG^DIALOG("WM","","","","XMTEXT")
"RTN","XMVVITA",149,0)
 F  D  Q:XMK=U
"RTN","XMVVITA",150,0)
 . S XMDIC("B")="@" ; no default basket
"RTN","XMVVITA",151,0)
 . S XMDIC("S")="I Y>1" ; can't select IN or WASTE baskets
"RTN","XMVVITA",152,0)
 . S XMDIC("W")="W ?40,$P(^(0),U,4)"
"RTN","XMVVITA",153,0)
 . W !
"RTN","XMVVITA",154,0)
 . D SELBSKT^XMJBU(DUZ,"","",.XMDIC,.XMK) Q:XMK=U
"RTN","XMVVITA",155,0)
 . N DA,DR,DIE
"RTN","XMVVITA",156,0)
 . S DIE="^XMB(3.7,"_DUZ_",2,"
"RTN","XMVVITA",157,0)
 . S DA(1)=DUZ,DA=XMK
"RTN","XMVVITA",158,0)
 . S DR="4T"    ; Read new messages basket priority
"RTN","XMVVITA",159,0)
 . D ^DIE
"RTN","XMVVITA",160,0)
 Q
"RTN","XMVVITA",161,0)
GOTNS(XMDUZ) ; Function: Does the user have a network signature? (1=yes; 0=no)
"RTN","XMVVITA",162,0)
 Q "^^"'[$G(^XMB(3.7,XMDUZ,"NS1"))
"RTN","XMVVITA",163,0)
CRE8NS ; The user does not have a network signature.
"RTN","XMVVITA",164,0)
 ; Does the user want to create a network signature now?
"RTN","XMVVITA",165,0)
 ; If the user creates one, routine sets $T to true; else false
"RTN","XMVVITA",166,0)
 N DIR,X,Y
"RTN","XMVVITA",167,0)
 S DIR(0)="Y",DIR("B")=$$EZBLD^DIALOG(39054) ; Yes
"RTN","XMVVITA",168,0)
 S DIR("A")=$$EZBLD^DIALOG(37309.5) ; Would you like to create a Network Signature now
"RTN","XMVVITA",169,0)
 D ^DIR Q:'Y
"RTN","XMVVITA",170,0)
 K DIR
"RTN","XMVVITA",171,0)
 D EDITNS
"RTN","XMVVITA",172,0)
 I $$GOTNS(DUZ)
"RTN","XMVVITA",173,0)
 Q
"RTN","XMVVITA",174,0)
EDITNS ; Edit network signature
"RTN","XMVVITA",175,0)
 N DIE,DA,DR
"RTN","XMVVITA",176,0)
 S DIE="^XMB(3.7,",DA=DUZ,DR="2.21:2.23" D ^DIE
"RTN","XMVVITA",177,0)
 Q
"RTN","XMVVITAE")
0^86^B48248055
"RTN","XMVVITAE",1,0)
XMVVITAE ;ISC-SF/GMB-Initialize User's MailMan Variables ;04/19/2002  13:26
"RTN","XMVVITAE",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMVVITAE",3,0)
 ; Replaces ^XMGAPI1,FWD^XMA21,FWD,BANNER^XMA6,EDIT^XMA7 (ISC-WASH/CAP)
"RTN","XMVVITAE",4,0)
 ; Entry points (DBIA 2728):
"RTN","XMVVITAE",5,0)
 ; INIT     Set up variables for DUZ or XMDUZ.
"RTN","XMVVITAE",6,0)
 ; OTHER    Set up variables to become a surrogate of someone else.
"RTN","XMVVITAE",7,0)
 ; SELF     Return from being a surrogate to being oneself again.
"RTN","XMVVITAE",8,0)
 Q
"RTN","XMVVITAE",9,0)
INIT ; Set up one's variables (for yourself or as a surrogate).
"RTN","XMVVITAE",10,0)
 N XMAPI
"RTN","XMVVITAE",11,0)
INIT2 K XMV
"RTN","XMVVITAE",12,0)
 D SYSTEM(.XMV)
"RTN","XMVVITAE",13,0)
 S:'$D(XMDUZ) XMDUZ=DUZ
"RTN","XMVVITAE",14,0)
 D DUZ(DUZ,.XMV,.XMDUN,.XMDISPI,.XMNOSEND)
"RTN","XMVVITAE",15,0)
 D:XMDUZ'=DUZ SURROGAT(XMDUZ,.XMV,.XMDUN,.XMNOSEND,.XMPRIV)
"RTN","XMVVITAE",16,0)
 Q
"RTN","XMVVITAE",17,0)
INITAPI ; (For MailMan use only) Set up variables for an API call.
"RTN","XMVVITAE",18,0)
 N XMAPI
"RTN","XMVVITAE",19,0)
 S XMAPI=1 ; "last used MailMan" will not be recorded.
"RTN","XMVVITAE",20,0)
 G INIT2
"RTN","XMVVITAE",21,0)
CHECK ; Check to make sure one's variables exist.
"RTN","XMVVITAE",22,0)
 I '$D(XMV("NAME"))!'$D(XMV("RDR DEF")) D INIT
"RTN","XMVVITAE",23,0)
 Q
"RTN","XMVVITAE",24,0)
OTHER ; Become someone else.  INIT should have been called previously.
"RTN","XMVVITAE",25,0)
 I '$D(XMV) D INIT Q
"RTN","XMVVITAE",26,0)
 N XMAPI
"RTN","XMVVITAE",27,0)
 D SURROGAT(XMDUZ,.XMV,.XMDUN,.XMNOSEND,.XMPRIV)
"RTN","XMVVITAE",28,0)
 Q
"RTN","XMVVITAE",29,0)
SELF ; Return to oneself after having become someone else.
"RTN","XMVVITAE",30,0)
 ; INIT should have been called previously.
"RTN","XMVVITAE",31,0)
 S XMDUZ=DUZ
"RTN","XMVVITAE",32,0)
 I '$D(XMV) D INIT Q
"RTN","XMVVITAE",33,0)
 N XMAPI
"RTN","XMVVITAE",34,0)
 D USER(XMDUZ,.XMV,.XMNOSEND,.XMDUN)
"RTN","XMVVITAE",35,0)
 D LASTUSE(XMDUZ,.XMV)
"RTN","XMVVITAE",36,0)
 Q
"RTN","XMVVITAE",37,0)
SYSTEM(XMV) ;
"RTN","XMVVITAE",38,0)
 ; XMV("VERSION")
"RTN","XMVVITAE",39,0)
 I '$D(DT) D DT^DICRW
"RTN","XMVVITAE",40,0)
 S XMV("VERSION")="VA MailMan "_$P($T(XMVVITAE+1),";",3)
"RTN","XMVVITAE",41,0)
 ; Check to make sure that important variables are defined correctly.
"RTN","XMVVITAE",42,0)
 I +$G(^XMB("NUM")),$G(^XMB("NAME"))=$G(^XMB("NETNAME")),$G(^XMB("NETNAME"))=$P($G(^DIC(4.2,+$G(^XMB("NUM")),0)),U,1),$G(^XMB("NUM"))=$P($G(^XMB(1,1,0)),U,1) Q
"RTN","XMVVITAE",43,0)
 N XMPARM  ; The domain for this facility is not christened correctly.
"RTN","XMVVITAE",44,0)
 S XMPARM(1)=$G(^XMB("NUM"))
"RTN","XMVVITAE",45,0)
 S XMPARM(2)=$P($G(^XMB(1,1,0)),U,1)
"RTN","XMVVITAE",46,0)
 S XMPARM(3)=$P($G(^DIC(4.2,+$G(^XMB("NUM")),0)),U,1)
"RTN","XMVVITAE",47,0)
 S XMPARM(4)=$P($G(^DIC(4.2,+XMPARM(2),0)),U,1)
"RTN","XMVVITAE",48,0)
 S XMPARM(5)=$G(^XMB("NETNAME"))
"RTN","XMVVITAE",49,0)
 S XMPARM(6)=$G(^XMB("NAME"))
"RTN","XMVVITAE",50,0)
 F I=1:1:6 I XMPARM(I)="" S XMPARM(I)="?"
"RTN","XMVVITAE",51,0)
 ;The domain for this facility is not christened correctly.
"RTN","XMVVITAE",52,0)
 ;IRM must correct this for network mail to function properly.
"RTN","XMVVITAE",53,0)
 ;The following pointers should contain the same numbers,
"RTN","XMVVITAE",54,0)
 ;which should point to this facility's domain in ^DIC(4.2:
"RTN","XMVVITAE",55,0)
 ;^XMB("NUM")=|1|          ==> |3|
"RTN","XMVVITAE",56,0)
 ;$P(^XMB(1,1,0),U,1)=|2|  ==> |4|
"RTN","XMVVITAE",57,0)
 ;The following globals should contain the domain name of this facility:
"RTN","XMVVITAE",58,0)
 ;^XMB("NETNAME")=           |5|
"RTN","XMVVITAE",59,0)
 ;^XMB("NAME")=              |6|
"RTN","XMVVITAE",60,0)
 D BLD^DIALOG(38100,.XMPARM,"","XMV(""SYSERR"")")
"RTN","XMVVITAE",61,0)
 Q
"RTN","XMVVITAE",62,0)
DUZ(XMDUZ,XMV,XMDUN,XMDISPI,XMNOSEND) ;
"RTN","XMVVITAE",63,0)
 ; XMV("DUZ NAME")
"RTN","XMVVITAE",64,0)
 K XMV("ERROR")
"RTN","XMVVITAE",65,0)
 I $G(DUZ,0)=0 S XMV("ERROR",1)=$$EZBLD^DIALOG(38105) Q  ;You do not have a DUZ.
"RTN","XMVVITAE",66,0)
 D USER(XMDUZ,.XMV,.XMNOSEND,.XMDUN) Q:$D(XMV("ERROR"))
"RTN","XMVVITAE",67,0)
 S XMV("DUZ NAME")=XMV("NAME")
"RTN","XMVVITAE",68,0)
 D LASTUSE(XMDUZ,.XMV)
"RTN","XMVVITAE",69,0)
 D PREFER(XMDUZ,.XMV,.XMDISPI)
"RTN","XMVVITAE",70,0)
 Q
"RTN","XMVVITAE",71,0)
SURROGAT(XMDUZ,XMV,XMDUN,XMNOSEND,XMPRIV) ;
"RTN","XMVVITAE",72,0)
 ; XMV("PRIV")
"RTN","XMVVITAE",73,0)
 ; XMPRIV
"RTN","XMVVITAE",74,0)
 Q:XMDUZ=DUZ
"RTN","XMVVITAE",75,0)
 K XMV("ERROR"),XMV("WARNING")
"RTN","XMVVITAE",76,0)
 I XMDUZ=.6 D  Q
"RTN","XMVVITAE",77,0)
 . S XMV("PRIV")="R",XMPRIV="y^n"
"RTN","XMVVITAE",78,0)
 . S (XMDUN,XMV("NAME"))=$$NAME^XMXUTIL(.6)
"RTN","XMVVITAE",79,0)
 . D SETNET(XMDUZ,.XMV)
"RTN","XMVVITAE",80,0)
 . S XMV("NEW MSGS")=+$P(^XMB(3.7,XMDUZ,0),U,6)
"RTN","XMVVITAE",81,0)
 E  D  Q:$D(XMV("ERROR"))
"RTN","XMVVITAE",82,0)
 . N XMIEN
"RTN","XMVVITAE",83,0)
 . S XMIEN=+$O(^XMB(3.7,"AB",DUZ,XMDUZ,0))
"RTN","XMVVITAE",84,0)
 . ;Commented out because we shouldn't be here if not a valid surrogate
"RTN","XMVVITAE",85,0)
 . ;I 'XMIEN S XMV("ERROR",5)=$$EZBLD^DIALOG(38106,XMDUZ) Q  ;You are not a surrogate of DUZ |1|.
"RTN","XMVVITAE",86,0)
 . S XMPRIV=$G(^XMB(3.7,XMDUZ,9,XMIEN,0))
"RTN","XMVVITAE",87,0)
 . S XMV("PRIV")=$S($P(XMPRIV,U,2)="y":"R",1:"")_$S($P(XMPRIV,U,3)="y":"W",1:"")
"RTN","XMVVITAE",88,0)
 D USER(XMDUZ,.XMV,.XMNOSEND,.XMDUN) Q:$D(XMV("ERROR"))
"RTN","XMVVITAE",89,0)
 D LASTUSE(XMDUZ,.XMV)
"RTN","XMVVITAE",90,0)
 Q
"RTN","XMVVITAE",91,0)
USER(XMDUZ,XMV,XMNOSEND,XMDUN) ;
"RTN","XMVVITAE",92,0)
 ; XMV("WARNING")
"RTN","XMVVITAE",93,0)
 ; XMV("ERROR")
"RTN","XMVVITAE",94,0)
 ; XMV("NEW MSGS")
"RTN","XMVVITAE",95,0)
 ; XMV("NAME")
"RTN","XMVVITAE",96,0)
 ; XMV("NOSEND")
"RTN","XMVVITAE",97,0)
 ; XMNOSEND
"RTN","XMVVITAE",98,0)
 ; XMDUN
"RTN","XMVVITAE",99,0)
 N XMREC
"RTN","XMVVITAE",100,0)
 K XMV("ERROR"),XMV("WARNING")
"RTN","XMVVITAE",101,0)
 S XMREC=$G(^VA(200,XMDUZ,0))
"RTN","XMVVITAE",102,0)
 I XMREC="" S XMV("ERROR",2)=$$EZBLD^DIALOG(38107,XMDUZ) Q  ;There is no person with DUZ |1|.
"RTN","XMVVITAE",103,0)
 I $P(XMREC,U,3)="" S XMV("ERROR",3)=$$EZBLD^DIALOG(38108,XMDUZ) Q  ; There is no Access Code for DUZ XMDUZ
"RTN","XMVVITAE",104,0)
 I '$D(^XMB(3.7,XMDUZ,0)) S XMV("ERROR",4)=$$EZBLD^DIALOG(38109,XMDUZ) Q  ;There is no mailbox for DUZ |1|.
"RTN","XMVVITAE",105,0)
 S XMV("NOSEND")=0
"RTN","XMVVITAE",106,0)
 S (XMDUN,XMV("NAME"))=$$NAME^XMXUTIL(XMDUZ)
"RTN","XMVVITAE",107,0)
 D SETNET(XMDUZ,.XMV)
"RTN","XMVVITAE",108,0)
 Q:$D(ZTQUEUED)!$G(XMAPI)
"RTN","XMVVITAE",109,0)
 I $D(^XTMP("XM","MAKENEW",XMDUZ)) D NEWAGAIN^XMJBN1(XMDUZ)
"RTN","XMVVITAE",110,0)
 I '$D(DUZ("SAV")),$D(XMMENU(0)) L +^XMB(3.7,"AD",DUZ):0 E  S (XMV("NOSEND"),XMNOSEND)=1,XMV("WARNING",4)=$$EZBLD^DIALOG(38110) ;Multiple Signon
"RTN","XMVVITAE",111,0)
 S:$D(^XMB(3.7,XMDUZ,"N")) XMV("WARNING",1)=$$EZBLD^DIALOG(38111) ;Priority Mail
"RTN","XMVVITAE",112,0)
 I '$D(DUZ("SAV")),'XMV("NOSEND"),$D(^XMB(3.7,"AD",XMDUZ)) D
"RTN","XMVVITAE",113,0)
 . I XMDUZ='DUZ,$G(XMV("PRIV"))'["W" Q
"RTN","XMVVITAE",114,0)
 . N XMZ
"RTN","XMVVITAE",115,0)
 . S XMREC=$G(^XMB(3.7,XMDUZ,"T"))
"RTN","XMVVITAE",116,0)
 . S XMZ=$P(XMREC,U,1) I XMZ="" K ^XMB(3.7,"AD",XMDUZ) Q
"RTN","XMVVITAE",117,0)
 . I '$D(^XMB(3.9,XMZ,0)) K ^XMB(3.7,XMDUZ,"T"),^XMB(3.7,"AD",XMDUZ) Q
"RTN","XMVVITAE",118,0)
 . S XMZ=$P(XMREC,U,3)
"RTN","XMVVITAE",119,0)
 . I XMZ,'$D(^XMB(3.9,XMZ,0)) K ^XMB(3.7,XMDUZ,"T"),^XMB(3.7,"AD",XMDUZ) Q
"RTN","XMVVITAE",120,0)
 . S XMV("WARNING",2)=$$EZBLD^DIALOG(38112) ;Message in Buffer
"RTN","XMVVITAE",121,0)
 S XMV("NEW MSGS")=+$P(^XMB(3.7,XMDUZ,0),U,6)
"RTN","XMVVITAE",122,0)
 I XMDUZ=.5 D
"RTN","XMVVITAE",123,0)
 . N I,XMK
"RTN","XMVVITAE",124,0)
 . S XMK=.99
"RTN","XMVVITAE",125,0)
 . F I=1:1 S XMK=$O(^XMB(3.7,.5,2,XMK)) Q:XMK>999!'XMK
"RTN","XMVVITAE",126,0)
 . S:I>900 XMV("WARNING",5)=$$EZBLD^DIALOG(38113,I) ;POSTMASTER has |1| baskets.
"RTN","XMVVITAE",127,0)
 D SETBAN(XMDUZ,.XMV)
"RTN","XMVVITAE",128,0)
 Q
"RTN","XMVVITAE",129,0)
SETNET(XMDUZ,XMV) ;
"RTN","XMVVITAE",130,0)
 ; XMV("NETNAME")
"RTN","XMVVITAE",131,0)
 S XMV("NETNAME")=$$NETNAME^XMXUTIL(XMDUZ)
"RTN","XMVVITAE",132,0)
 Q
"RTN","XMVVITAE",133,0)
SETBAN(XMDUZ,XMV) ;
"RTN","XMVVITAE",134,0)
 ; XMV("BANNER")
"RTN","XMVVITAE",135,0)
 N XMBANNER
"RTN","XMVVITAE",136,0)
 S XMBANNER=$G(^XMB(3.7,XMDUZ,"B"))
"RTN","XMVVITAE",137,0)
 I XMBANNER="" K XMV("BANNER")
"RTN","XMVVITAE",138,0)
 E  S XMV("BANNER")=XMBANNER
"RTN","XMVVITAE",139,0)
 Q
"RTN","XMVVITAE",140,0)
PREFER(XMDUZ,XMV,XMDISPI) ;
"RTN","XMVVITAE",141,0)
 ; XMV("SHOW INST")
"RTN","XMVVITAE",142,0)
 ; XMV("SHOW TITL")
"RTN","XMVVITAE",143,0)
 ; XMV("SHOW DUZ")
"RTN","XMVVITAE",144,0)
 ; XMV("ASK BSKT")
"RTN","XMVVITAE",145,0)
 ; XMV("MSG DEF")
"RTN","XMVVITAE",146,0)
 ; XMV("RDR DEF")
"RTN","XMVVITAE",147,0)
 ; XMV("RDR ASK")
"RTN","XMVVITAE",148,0)
 ; XMV("ORDER")
"RTN","XMVVITAE",149,0)
 ; XMV("PREVU")
"RTN","XMVVITAE",150,0)
 ; XMV("NEW OPT")
"RTN","XMVVITAE",151,0)
 ; XMV("NEW ORDER")
"RTN","XMVVITAE",152,0)
 ; XMDISPI
"RTN","XMVVITAE",153,0)
 N XMUREC,XMSREC
"RTN","XMVVITAE",154,0)
 S XMSREC=$G(^XMB(1,1,0)) ; Site's preferences
"RTN","XMVVITAE",155,0)
 S XMUREC=^XMB(3.7,DUZ,0) ; User's preferences
"RTN","XMVVITAE",156,0)
 S XMV("SHOW INST")=$S($P(XMSREC,U,5)["y":1,1:0)  ; Show Institution
"RTN","XMVVITAE",157,0)
 S XMV("SHOW TITL")=$S($P(XMUREC,U,10)=1:1,1:0)   ; Show Titles
"RTN","XMVVITAE",158,0)
 I XMV("SHOW TITL") S XMV("TITL SRC")=$S($P(XMSREC,U,11)'="":$P(XMSREC,U,11),1:"T") ; Title Source (Signature Block or Title)
"RTN","XMVVITAE",159,0)
 Q:$D(ZTQUEUED)
"RTN","XMVVITAE",160,0)
 S XMV("SHOW DUZ")=+$P(XMSREC,U,8)  ; Show DUZ when addressing messages
"RTN","XMVVITAE",161,0)
 S XMV("PREVU")=$S($P(XMUREC,U,4)="Y":1,1:0)
"RTN","XMVVITAE",162,0)
 S XMV("ASK BSKT")=$S($P(XMUREC,U,5)'["n":1,1:0)
"RTN","XMVVITAE",163,0)
 ; User's default message action (Delete, Ignore). If user doesn't have one, take site's.  If site doesn't have one, make it Ignore.
"RTN","XMVVITAE",164,0)
 S XMV("MSG DEF")=$S($P(XMUREC,U,9)'="":$P(XMUREC,U,9),$P(XMSREC,U,15)'="":$P(XMSREC,U,15),1:"I")
"RTN","XMVVITAE",165,0)
 S XMV("ORDER")=$S($P(XMUREC,U,13)="N":-1,1:1)
"RTN","XMVVITAE",166,0)
 S XMV("RDR DEF")=$S($P(XMUREC,U,16)'="":$P(XMUREC,U,16),1:"C")
"RTN","XMVVITAE",167,0)
 S XMV("RDR ASK")=$S($P(XMUREC,U,17)'="":$P(XMUREC,U,17),1:"Y")
"RTN","XMVVITAE",168,0)
 S XMV("NEW OPT")=$S($P(XMUREC,U,18)'="":$P(XMUREC,U,18),1:"R")
"RTN","XMVVITAE",169,0)
 S XMV("NEW ORDER")=$S($P(XMUREC,U,19)="N":-1,1:1)
"RTN","XMVVITAE",170,0)
 Q:$G(XMAPI)
"RTN","XMVVITAE",171,0)
 I $P(XMSREC,U,6)["y",'$D(^XMB(3.7,XMDUZ,1,1,0)) S XMV("WARNING",3)=$$EZBLD^DIALOG(38114) ;No Introduction
"RTN","XMVVITAE",172,0)
 S XMDISPI="X"  ; Show Help (Not used?)
"RTN","XMVVITAE",173,0)
 I XMV("SHOW INST") S XMDISPI=XMDISPI_"I"
"RTN","XMVVITAE",174,0)
 I XMV("SHOW TITL") S XMDISPI=XMDISPI_"T"
"RTN","XMVVITAE",175,0)
 I XMV("ASK BSKT") S XMDISPI=XMDISPI_"A"
"RTN","XMVVITAE",176,0)
 S XMDISPI=XMDISPI_U_XMV("MSG DEF")
"RTN","XMVVITAE",177,0)
 Q
"RTN","XMVVITAE",178,0)
LASTUSE(XMDUZ,XMV) ;
"RTN","XMVVITAE",179,0)
 ; XMV("LAST USE")
"RTN","XMVVITAE",180,0)
 I XMDUZ=.6!$D(ZTQUEUED)!$G(XMAPI) Q
"RTN","XMVVITAE",181,0)
 S XMV("LAST USE")=$P($G(^XMB(3.7,XMDUZ,"L"),$$EZBLD^DIALOG(38002)),U,1) ;Never
"RTN","XMVVITAE",182,0)
 Q:$D(DUZ("SAV"))
"RTN","XMVVITAE",183,0)
 S ^XMB(3.7,XMDUZ,"L")=$$MMDT^XMXUTIL1($$NOW^XLFDT)_$S(XMDUZ'=DUZ:$$EZBLD^DIALOG(38008,XMV("DUZ NAME")),1:"")_U_DT_U_DUZ ; (Surrogate: |1|)
"RTN","XMVVITAE",184,0)
 Q
"RTN","XMXADDR")
0^87^B66876638
"RTN","XMXADDR",1,0)
XMXADDR ;ISC-SF/GMB-Address checker ;04/17/2002  12:47
"RTN","XMXADDR",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMXADDR",3,0)
 ; Replaces ^XMA21,^XMA210,^XMA24 (ISC-WASH/CAP/AML/LL)
"RTN","XMXADDR",4,0)
 ; XMIA     1=Interactive; 0=not
"RTN","XMXADDR",5,0)
CHKADDR(XMDUZ,XMTO,XMINSTR,XMRESTR,XMFULL) ; Check addressee(s) NON-INTERACTIVE
"RTN","XMXADDR",6,0)
 ; This entry point is meant for calls in which the addressees are
"RTN","XMXADDR",7,0)
 ; already in an array:
"RTN","XMXADDR",8,0)
 ; XMTO("addressee 1")=""
"RTN","XMXADDR",9,0)
 ; XMTO("addressee 2")=""
"RTN","XMXADDR",10,0)
 ; or for just a single addressee:  "addressee 1"
"RTN","XMXADDR",11,0)
 N XMADDR,XMIA
"RTN","XMXADDR",12,0)
 ;K XMERR,^TMP("XMERR",$J) DO NOT PUT THIS LINE IN HERE!
"RTN","XMXADDR",13,0)
 S XMIA=0
"RTN","XMXADDR",14,0)
 I $G(XMTO)]"",$O(XMTO(""))="" D  Q
"RTN","XMXADDR",15,0)
 . N XMERROR K XMFULL
"RTN","XMXADDR",16,0)
 . D ADDRESS(XMDUZ,XMTO,.XMFULL,.XMERROR) Q:'$D(XMERROR)
"RTN","XMXADDR",17,0)
 . S XMERROR("PARAM","ID")="XMTO",XMERROR("PARAM","VALUE")=XMTO
"RTN","XMXADDR",18,0)
 . D ERRSET^XMXUTIL(XMERROR,.XMERROR)
"RTN","XMXADDR",19,0)
 . S:'$D(XMFULL) ^TMP("XMERR",$J,XMERR,"PARM")=XMTO
"RTN","XMXADDR",20,0)
 I $O(XMTO(""))="" D  Q
"RTN","XMXADDR",21,0)
 . ;S XMERR=$G(XMERR)+1,^TMP("XMERR",$J,XMERR,"TEXT",1)="Null addressee"
"RTN","XMXADDR",22,0)
 S XMADDR=""
"RTN","XMXADDR",23,0)
 F  S XMADDR=$O(XMTO(XMADDR)) Q:XMADDR=""  D
"RTN","XMXADDR",24,0)
 . N XMERROR,XMFULL
"RTN","XMXADDR",25,0)
 . D ADDRESS(XMDUZ,XMADDR,.XMFULL,.XMERROR) Q:'$D(XMERROR)
"RTN","XMXADDR",26,0)
 . S XMERROR("PARAM","ID")="XMTO",XMERROR("PARAM","VALUE")=XMADDR
"RTN","XMXADDR",27,0)
 . D ERRSET^XMXUTIL(XMERROR,.XMERROR)
"RTN","XMXADDR",28,0)
 . S:'$D(XMFULL) ^TMP("XMERR",$J,XMERR,"PARM")=XMADDR
"RTN","XMXADDR",29,0)
 Q
"RTN","XMXADDR",30,0)
INIT ;
"RTN","XMXADDR",31,0)
 K ^TMP("XMY",$J),^TMP("XMY0",$J),^TMP("XMYL",$J)
"RTN","XMXADDR",32,0)
INITLATR ;
"RTN","XMXADDR",33,0)
 N XMNOW
"RTN","XMXADDR",34,0)
 S XMNOW=$$NOW^XLFDT
"RTN","XMXADDR",35,0)
 S XMINLATR=$E($$FMADD^XLFDT(XMNOW,"","",5),1,12)  ; Staggered delivery must be at least 5 minutes from now
"RTN","XMXADDR",36,0)
 S XMAXLATR=$$SCH^XLFDT("1M",XMNOW)  ; Staggered delivery must be at most 1 month from now
"RTN","XMXADDR",37,0)
 S XMBIGGRP=$P(^XMB(1,1,0),U,7)  ; Big group size
"RTN","XMXADDR",38,0)
 Q
"RTN","XMXADDR",39,0)
CLEANUP ;
"RTN","XMXADDR",40,0)
 K ^TMP("XMY",$J),^TMP("XMY0",$J),^TMP("XMYL",$J),XMINLATR,XMAXLATR,XMBIGGRP
"RTN","XMXADDR",41,0)
 Q
"RTN","XMXADDR",42,0)
ADDR(XMDUZ,XMADDR,XMINSTR,XMRESTR,XMFULL) ; Check one addressee (INTERACTIVE)
"RTN","XMXADDR",43,0)
 N XMIA
"RTN","XMXADDR",44,0)
 S XMIA=1
"RTN","XMXADDR",45,0)
 D ADDRESS(XMDUZ,XMADDR,.XMFULL)
"RTN","XMXADDR",46,0)
 Q
"RTN","XMXADDR",47,0)
ADDRESS(XMDUZ,XMADDR,XMFULL,XMERROR) ; Check one addressee
"RTN","XMXADDR",48,0)
 ; XMADDR   (in) Addressee (if number, assumed to be a person's DUZ)
"RTN","XMXADDR",49,0)
 ; XMFULL   (out) The full address of the addressee
"RTN","XMXADDR",50,0)
 N XMSTRIKE,XMPREFIX,XMLATER,XMFWDADD,XMGCIRCL,XMGMBRS,XMG
"RTN","XMXADDR",51,0)
 D CHKPARM(.XMADDR,.XMSTRIKE,.XMPREFIX,.XMLATER) Q:$D(XMERROR)
"RTN","XMXADDR",52,0)
 I $G(XMINSTR("ADDR FLAGS"))["X",$G(XMINSTR("ADDR FLAGS"))'["Y" S XMSTRIKE=0,XMLATER="",XMPREFIX=""
"RTN","XMXADDR",53,0)
 I XMADDR["@"!(XMADDR["!") D
"RTN","XMXADDR",54,0)
 . I $D(XMRESTR("NONET")) D  Q
"RTN","XMXADDR",55,0)
 . . ;Messages longer than |1| lines may not be sent across the network.
"RTN","XMXADDR",56,0)
 . . D SETERR^XMXADDR4($G(XMIA),"!",39001,XMRESTR("NONET"))
"RTN","XMXADDR",57,0)
 . D REMOTE^XMXADDR3(XMDUZ,XMADDR,XMSTRIKE,XMPREFIX,.XMLATER,.XMFULL)
"RTN","XMXADDR",58,0)
 E  D LOCAL(XMDUZ,XMADDR,XMSTRIKE,XMPREFIX,.XMLATER,.XMFULL,.XMG)
"RTN","XMXADDR",59,0)
 D:'$D(XMERROR) SET(XMFULL,$G(XMG),XMSTRIKE,XMPREFIX,XMLATER)
"RTN","XMXADDR",60,0)
 Q
"RTN","XMXADDR",61,0)
LOCAL(XMDUZ,XMADDR,XMSTRIKE,XMPREFIX,XMLATER,XMFULL,XMG) ;
"RTN","XMXADDR",62,0)
 I $E(XMADDR,1)="*" D  Q
"RTN","XMXADDR",63,0)
 . D BRODCAST^XMXADDR2(XMDUZ,XMADDR,XMSTRIKE,XMPREFIX,.XMLATER,.XMFULL)
"RTN","XMXADDR",64,0)
 I $L(XMADDR)>2,".G.g.D.d.H.h.S.s."[("."_$E(XMADDR,1,2)) D  Q
"RTN","XMXADDR",65,0)
 . N XMADDR1
"RTN","XMXADDR",66,0)
 . S XMADDR1=$E(XMADDR,1)
"RTN","XMXADDR",67,0)
 . I "Gg"[XMADDR1 D EXPAND^XMXADDRG(XMDUZ,XMADDR,XMSTRIKE,XMPREFIX,.XMLATER,.XMFULL,.XMG) Q
"RTN","XMXADDR",68,0)
 . I "Ss"[XMADDR1 D SERVER^XMXADDR3(XMADDR,XMSTRIKE,XMPREFIX,.XMLATER,.XMFULL) Q
"RTN","XMXADDR",69,0)
 . I "DdHh"[XMADDR1 D DEVICE^XMXADDR3(XMADDR,XMSTRIKE,XMPREFIX,.XMLATER,.XMFULL) Q
"RTN","XMXADDR",70,0)
 I XMADDR?1N.N,$L(XMADDR)>25 D  Q
"RTN","XMXADDR",71,0)
 . D SETERR^XMXADDR4($G(XMIA),"!,$C(7)",39002) ;Not found.
"RTN","XMXADDR",72,0)
 I $G(XMIA) D
"RTN","XMXADDR",73,0)
 . D IPERSON^XMXADDR1(XMDUZ,.XMADDR,XMSTRIKE,XMPREFIX,.XMLATER,.XMG,.XMFULL) Q:$D(XMERROR)
"RTN","XMXADDR",74,0)
 . I XMLATER="?",XMG'=.6 D QLATER(XMFULL,.XMLATER)
"RTN","XMXADDR",75,0)
 E  D
"RTN","XMXADDR",76,0)
 . D PERSON^XMXADDR1(XMDUZ,.XMADDR,XMSTRIKE,XMPREFIX,XMLATER,.XMG,.XMFULL)
"RTN","XMXADDR",77,0)
 Q:$D(XMERROR)
"RTN","XMXADDR",78,0)
 D:XMFULL'["@" INDIV(XMDUZ,XMG,XMSTRIKE,XMPREFIX,XMLATER)
"RTN","XMXADDR",79,0)
 Q
"RTN","XMXADDR",80,0)
INDIV(XMDUZ,XMG,XMSTRIKE,XMPREFIX,XMLATER) ;
"RTN","XMXADDR",81,0)
 N XMGREC,XMIASAVE
"RTN","XMXADDR",82,0)
 I $D(XMFWDADD) D  Q
"RTN","XMXADDR",83,0)
 . ;You can't have a message forwarded to a local user.
"RTN","XMXADDR",84,0)
 . D SETERR^XMXADDR4(0,"",38001)
"RTN","XMXADDR",85,0)
 S XMGREC=^XMB(3.7,XMG,0)
"RTN","XMXADDR",86,0)
 I $P(XMGREC,U,2)=""!(XMG=DUZ) D SETEXP(XMG,"",XMSTRIKE,XMPREFIX,XMLATER) Q
"RTN","XMXADDR",87,0)
 ; Addressee has a forwarding address.
"RTN","XMXADDR",88,0)
 ; Ignore it if message is from remote postmaster (OR envelope from is empty) and forwarding address is to a remote site (to avoid looping error messages to bad fwding address).
"RTN","XMXADDR",89,0)
 I $D(XMRESTR("NET RECEIVE")),($$UP^XLFSTR(XMRESTR("NET RECEIVE"))["POSTMASTER"!("<>"[XMRESTR("NET RECEIVE"))),$$FIND1^DIC(4.2,"","QX",$P($P(XMGREC,U,2),"@",2),"B^C")'=^XMB("NUM") D SETEXP(XMG,"",XMSTRIKE,XMPREFIX,XMLATER) Q
"RTN","XMXADDR",90,0)
 N XMFULL,XMERROR
"RTN","XMXADDR",91,0)
 S XMFWDADD=$P(XMGREC,U,2)
"RTN","XMXADDR",92,0)
 I $G(XMIA) S XMIA=0,XMIASAVE=1
"RTN","XMXADDR",93,0)
 D REMOTE^XMXADDR3(XMDUZ,$P(XMGREC,U,2),XMSTRIKE,XMPREFIX,.XMLATER,.XMFULL)
"RTN","XMXADDR",94,0)
 K XMFWDADD
"RTN","XMXADDR",95,0)
 I $G(XMIASAVE) S XMIA=1
"RTN","XMXADDR",96,0)
 I '$D(XMERROR) D  Q:'$P(XMGREC,U,8)  ; quit if no local delivery
"RTN","XMXADDR",97,0)
 . Q:XMSTRIKE
"RTN","XMXADDR",98,0)
 . ; Note that recipient fwded
"RTN","XMXADDR",99,0)
 . I $D(XMINSTR("NET FWD BY")),$D(XMRESTR("NET RECEIVE")) S ^TMP("XMY",$J,XMFULL,"F")=XMG_U_XMINSTR("NET FWD BY") Q
"RTN","XMXADDR",100,0)
 . S ^TMP("XMY",$J,XMFULL,"F")=XMG
"RTN","XMXADDR",101,0)
 D SETEXP(XMG,"",XMSTRIKE,XMPREFIX,XMLATER)
"RTN","XMXADDR",102,0)
 D:$D(XMERROR) DELFWD^XMVVITA(XMG,$P(XMGREC,U,2),$$GETERR^XMXADDR4)
"RTN","XMXADDR",103,0)
 Q
"RTN","XMXADDR",104,0)
SET(XMTO,XMG,XMSTRIKE,XMPREFIX,XMLATER) ;
"RTN","XMXADDR",105,0)
 I $G(XMINSTR("ADDR FLAGS"))["X",$G(XMINSTR("ADDR FLAGS"))'["Y" Q
"RTN","XMXADDR",106,0)
 I XMSTRIKE D  Q
"RTN","XMXADDR",107,0)
 . I $G(XMIA) D
"RTN","XMXADDR",108,0)
 . . I $E(XMTO,1,2)="G."!($E(XMTO,1,2)="*;") D
"RTN","XMXADDR",109,0)
 . . . I $D(^TMP("XMY0",$J,XMTO,"L")) D  Q
"RTN","XMXADDR",110,0)
 . . . . W $$EZBLD^DIALOG(39003) ;Later'd Group Deleted.
"RTN","XMXADDR",111,0)
 . . . . K ^TMP("XMYL",$J,XMTO)
"RTN","XMXADDR",112,0)
 . . . W !,$$EZBLD^DIALOG(39004) ;Members Deleted.
"RTN","XMXADDR",113,0)
 . . E  W:$X>70 ! W $$EZBLD^DIALOG(39005) ;Deleted.
"RTN","XMXADDR",114,0)
 . . ; 39006 - * (Broadcast to all local users)
"RTN","XMXADDR",115,0)
 . . I XMTO'=$$EZBLD^DIALOG(39006),$D(^TMP("XMY0",$J,$$EZBLD^DIALOG(39006))) W !,$$EZBLD^DIALOG(39007) ;But Broadcast will still go to all local users
"RTN","XMXADDR",116,0)
 . . Q:'$D(^TMP("XMYL",$J))
"RTN","XMXADDR",117,0)
 . . N XMGRP,XMTEXT ;But message will still go to all members of the following later'd group(s):
"RTN","XMXADDR",118,0)
 . . D BLD^DIALOG(39008,"","","XMTEXT","F")
"RTN","XMXADDR",119,0)
 . . D MSG^DIALOG("WM","","","","XMTEXT")
"RTN","XMXADDR",120,0)
 . . S XMGRP="" F  S XMGRP=$O(^TMP("XMYL",$J,XMGRP)) Q:XMGRP=""  W !,XMGRP
"RTN","XMXADDR",121,0)
 . K ^TMP("XMY0",$J,XMTO)
"RTN","XMXADDR",122,0)
 . K:$D(^TMP("XMYL",$J,XMTO)) ^TMP("XMYL",$J,XMTO)
"RTN","XMXADDR",123,0)
 S ^TMP("XMY0",$J,XMTO)=XMG    ; =XMIEN
"RTN","XMXADDR",124,0)
 I XMPREFIX'="" S ^TMP("XMY0",$J,XMTO,1)=$$UP^XLFSTR(XMPREFIX)
"RTN","XMXADDR",125,0)
 I XMLATER S ^TMP("XMY0",$J,XMTO,"L")=XMLATER I $E(XMTO,1,2)="G."!($E(XMTO,1,2)="*;") S ^TMP("XMYL",$J,XMTO)=""
"RTN","XMXADDR",126,0)
 I XMLATER="?",$G(XMIA) W !,$C(7),$$EZBLD^DIALOG(39009) ;'Later' not appropriate for this addressee
"RTN","XMXADDR",127,0)
 Q
"RTN","XMXADDR",128,0)
SETEXP(XMTO,XMIEN,XMSTRIKE,XMPREFIX,XMLATER) ;
"RTN","XMXADDR",129,0)
 Q:$G(XMINSTR("ADDR FLAGS"))["X"
"RTN","XMXADDR",130,0)
 I XMSTRIKE K ^TMP("XMY",$J,XMTO) Q
"RTN","XMXADDR",131,0)
 I XMLATER,XMTO'=XMDUZ Q
"RTN","XMXADDR",132,0)
 S ^TMP("XMY",$J,XMTO)=XMIEN
"RTN","XMXADDR",133,0)
 I XMPREFIX'="" S ^TMP("XMY",$J,XMTO,1)=$$UP^XLFSTR(XMPREFIX)
"RTN","XMXADDR",134,0)
 I $D(XMINSTR("NET FWD BY")),$D(XMRESTR("NET RECEIVE")) S ^TMP("XMY",$J,XMTO,"F")=XMINSTR("NET FWD BY")
"RTN","XMXADDR",135,0)
 Q
"RTN","XMXADDR",136,0)
GOTADDR() ; Function returns 1 if addressees exist; 0 if not.
"RTN","XMXADDR",137,0)
 Q:$D(^TMP("XMY",$J)) 1
"RTN","XMXADDR",138,0)
 Q:$D(^TMP("XMYL",$J)) 1
"RTN","XMXADDR",139,0)
 Q:'$D(^TMP("XMY0",$J)) 0
"RTN","XMXADDR",140,0)
 N XMTO
"RTN","XMXADDR",141,0)
 S XMTO=$O(^TMP("XMY0",$J,""))
"RTN","XMXADDR",142,0)
 Q:$D(^TMP("XMY0",$J,XMTO,"L")) 1
"RTN","XMXADDR",143,0)
 Q 0
"RTN","XMXADDR",144,0)
CHKPARM(XMADDR,XMSTRIKE,XMPREFIX,XMLATER) ;
"RTN","XMXADDR",145,0)
 I $E(XMADDR,1)="-" D
"RTN","XMXADDR",146,0)
 . S XMSTRIKE=1
"RTN","XMXADDR",147,0)
 . S XMADDR=$E(XMADDR,2,999)
"RTN","XMXADDR",148,0)
 E  S XMSTRIKE=0
"RTN","XMXADDR",149,0)
 I $E(XMADDR,1)=" "!($E(XMADDR,$L(XMADDR))=" ") S XMADDR=$$STRIP^XMXUTIL1(XMADDR)
"RTN","XMXADDR",150,0)
 I $P(XMADDR,"@",1)="" D  Q
"RTN","XMXADDR",151,0)
 . D SETERR^XMXADDR4($G(XMIA),"!",39010) ;Null addressee
"RTN","XMXADDR",152,0)
 I $E(XMADDR,1)'="""",XMADDR[":" D  Q
"RTN","XMXADDR",153,0)
 . D PREFIX(.XMADDR,.XMPREFIX,.XMLATER)
"RTN","XMXADDR",154,0)
 . I XMSTRIKE,XMLATER="?" S XMLATER=""
"RTN","XMXADDR",155,0)
 S XMPREFIX=""
"RTN","XMXADDR",156,0)
 S XMLATER=""
"RTN","XMXADDR",157,0)
 Q
"RTN","XMXADDR",158,0)
PREFIX(XMADDR,XMPREFIX,XMLATER) ;
"RTN","XMXADDR",159,0)
 N XMPRE
"RTN","XMXADDR",160,0)
 S XMPRE=$P(XMADDR,":",1)
"RTN","XMXADDR",161,0)
 I XMPRE="" D  Q
"RTN","XMXADDR",162,0)
 . D SETERR^XMXADDR4($G(XMIA),"!",39011) ;Null recipient type
"RTN","XMXADDR",163,0)
 S (XMLATER,XMPREFIX)=""
"RTN","XMXADDR",164,0)
 S XMPRE=$$UP^XLFSTR(XMPRE)
"RTN","XMXADDR",165,0)
 I $P(XMPRE,"@",1)["L",'$D(XMRESTR("NET RECEIVE")) D
"RTN","XMXADDR",166,0)
 . D LATER($P(XMPRE,"@",2,99),.XMLATER)
"RTN","XMXADDR",167,0)
 . S XMPRE=$TR($P(XMPRE,"@",1),"L")
"RTN","XMXADDR",168,0)
 D:XMPRE'="" RTYPE(XMPRE,.XMPREFIX)
"RTN","XMXADDR",169,0)
 I $D(XMERROR),$D(XMRESTR("NET RECEIVE")),$$FIND1^DIC(4.2,"","QX",$P(XMADDR,"@",2),"B^C")'=^XMB("NUM") K XMERROR Q
"RTN","XMXADDR",170,0)
 S XMADDR=$P(XMADDR,":",2)
"RTN","XMXADDR",171,0)
 Q
"RTN","XMXADDR",172,0)
LATER(XMWHEN,XMLATER) ; (XMWHEN=user-supplied date/time)
"RTN","XMXADDR",173,0)
 I $G(XMIA),XMWHEN="" S XMLATER="?" Q
"RTN","XMXADDR",174,0)
 I '$D(XMINLATR) D INITLATR
"RTN","XMXADDR",175,0)
 D DT^DILF("FTX",XMWHEN,.XMLATER,XMINLATR)
"RTN","XMXADDR",176,0)
 Q:XMLATER>0
"RTN","XMXADDR",177,0)
 S XMLATER=$S($G(XMIA):"?",1:"")
"RTN","XMXADDR",178,0)
 Q
"RTN","XMXADDR",179,0)
RTYPE(XMPRE,XMPREFIX) ;
"RTN","XMXADDR",180,0)
 N XMINTRNL
"RTN","XMXADDR",181,0)
 D CHK^DIE(3.91,6.5,"",XMPRE,.XMINTRNL)
"RTN","XMXADDR",182,0)
 I XMINTRNL="^" D  Q  ;Invalid recipient type '|1|'
"RTN","XMXADDR",183,0)
 . D SETERR^XMXADDR4($G(XMIA),"!",39012,XMPRE)
"RTN","XMXADDR",184,0)
 S XMPREFIX=XMINTRNL
"RTN","XMXADDR",185,0)
 Q
"RTN","XMXADDR",186,0)
QLATER(XMFULL,XMLATER) ;
"RTN","XMXADDR",187,0)
 N DIR,Y
"RTN","XMXADDR",188,0)
 I '$D(XMINLATR) D INITLATR
"RTN","XMXADDR",189,0)
 W !
"RTN","XMXADDR",190,0)
 S DIR(0)="DO^"_XMINLATR_":"_XMAXLATR_":EXT"
"RTN","XMXADDR",191,0)
 ;Later Delivery must be at least 5 minutes from now.
"RTN","XMXADDR",192,0)
 D BLD^DIALOG(39013,"","","DIR(""A"")") ;When Later
"RTN","XMXADDR",193,0)
 S DIR("B")=$$MMDT^XMXUTIL1($$FMADD^XLFDT($$NOW^XLFDT,"","",5)) ; (in 5 minutes)
"RTN","XMXADDR",194,0)
 S DIR("B")=$P(DIR("B")," ",1,3)_"@"_$P(DIR("B")," ",4)
"RTN","XMXADDR",195,0)
 D ^DIR I $D(DIRUT) D  Q
"RTN","XMXADDR",196,0)
 . S XMLATER=""
"RTN","XMXADDR",197,0)
 . D SETERR^XMXADDR4(0,"",37002) ;up-arrow or time out.
"RTN","XMXADDR",198,0)
 . W !,XMFULL,$$EZBLD^DIALOG(39015) ;removed from recipient list.
"RTN","XMXADDR",199,0)
 S XMLATER=Y
"RTN","XMXADDR",200,0)
 ;>> Remember, you won't be able to 'minus' anyone from the ...
"RTN","XMXADDR",201,0)
 I $E(XMFULL,1,2)="G." W !!,$$EZBLD^DIALOG(39016) ; group <<
"RTN","XMXADDR",202,0)
 I $E(XMFULL,1,2)="*;" W !!,$$EZBLD^DIALOG(39017) ; limited broadcast <<
"RTN","XMXADDR",203,0)
 Q
"RTN","XMXADDR1")
0^88^B49188214
"RTN","XMXADDR1",1,0)
XMXADDR1 ;ISC-SF/GMB-XMXADDR (cont.) ;05/21/2002  07:00
"RTN","XMXADDR1",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMXADDR1",3,0)
PERSON(XMDUZ,XMADDR,XMSTRIKE,XMPREFIX,XMLATER,XMG,XMFULL) ;
"RTN","XMXADDR1",4,0)
 N XMSCREEN,XMNOTFND
"RTN","XMXADDR1",5,0)
 S XMADDR=$$UP^XLFSTR(XMADDR)
"RTN","XMXADDR1",6,0)
 S XMSCREEN="I $L($P(^(0),U,3)),$D(^XMB(3.7,+Y,2))"  ; User must have an access code & mailbox
"RTN","XMXADDR1",7,0)
 ; "B^BB^C^D" = name^alias^initial^nickname            
"RTN","XMXADDR1",8,0)
 S XMG=$$FIND1^DIC(200,"","O",$S(+XMADDR=XMADDR:"`"_XMADDR,1:XMADDR),"B^BB^C^D",XMSCREEN)
"RTN","XMXADDR1",9,0)
 I XMG D  Q
"RTN","XMXADDR1",10,0)
 . S XMFULL=$$NAME^XMXUTIL(XMG)
"RTN","XMXADDR1",11,0)
 . Q:XMG'=.6
"RTN","XMXADDR1",12,0)
 . D CHKSHARE
"RTN","XMXADDR1",13,0)
 . S:XMLATER XMLATER="?"  ; Can't 'later' to SHARED,MAIL
"RTN","XMXADDR1",14,0)
 S XMNOTFND=$S($D(DIERR):39018,1:39019) ;Addressee ambiguous. / Addressee not found.
"RTN","XMXADDR1",15,0)
 I +XMADDR=XMADDR D  Q
"RTN","XMXADDR1",16,0)
 . D SETERR^XMXADDR4(0,"",XMNOTFND)
"RTN","XMXADDR1",17,0)
 ; Not found in NEW PERSON file, see if there's a MAIL NAME
"RTN","XMXADDR1",18,0)
 I $D(^XMB(3.7,"C")) D  Q:XMG
"RTN","XMXADDR1",19,0)
 . S XMSCREEN="I $L($P(^VA(200,+Y,0),U,3))"  ; User must have an access code
"RTN","XMXADDR1",20,0)
 . S XMG=$$FIND1^DIC(3.7,"","OQ",XMADDR,"C",XMSCREEN) Q:'XMG
"RTN","XMXADDR1",21,0)
 . S XMFULL=$$NAME^XMXUTIL(XMG)
"RTN","XMXADDR1",22,0)
 ; Not a Mail Name, see if it's in the Remote User Directory.
"RTN","XMXADDR1",23,0)
 N XMINDEX,I,XMG
"RTN","XMXADDR1",24,0)
 S XMINDEX="" F I="B","F" S:$D(^DIC(4.2997,I)) XMINDEX=XMINDEX_U_I
"RTN","XMXADDR1",25,0)
 I XMINDEX'="" D  Q:XMG
"RTN","XMXADDR1",26,0)
 . S XMINDEX=$E(XMINDEX,2,99)
"RTN","XMXADDR1",27,0)
 . S XMG=$$FIND1^DIC(4.2997,"","OQ",XMADDR,XMINDEX) Q:'XMG
"RTN","XMXADDR1",28,0)
 . S XMADDR=$P(^XMD(4.2997,XMG,0),U,7)
"RTN","XMXADDR1",29,0)
 . D CHKREM(XMG,XMADDR) Q:$D(XMERROR)
"RTN","XMXADDR1",30,0)
 . D REMDT(XMG)
"RTN","XMXADDR1",31,0)
 . D REMOTE^XMXADDR3(XMDUZ,XMADDR,XMSTRIKE,XMPREFIX,XMLATER,.XMFULL)
"RTN","XMXADDR1",32,0)
 D SETERR^XMXADDR4(0,"",XMNOTFND)
"RTN","XMXADDR1",33,0)
 Q
"RTN","XMXADDR1",34,0)
CHKSHARE ;
"RTN","XMXADDR1",35,0)
 I $G(XMINSTR("FLAGS"))["X"!($G(XMRESTR("FLAGS"))["X") D  Q
"RTN","XMXADDR1",36,0)
 . ;Closed messages may not be sent to SHARED,MAIL.
"RTN","XMXADDR1",37,0)
 . D SETERR^XMXADDR4(0,"",39020)
"RTN","XMXADDR1",38,0)
 I $G(XMINSTR("FLAGS"))["C"!($G(XMRESTR("FLAGS"))["C") D  Q
"RTN","XMXADDR1",39,0)
 . ;Confidential messages may not be sent to SHARED,MAIL.
"RTN","XMXADDR1",40,0)
 . D SETERR^XMXADDR4(0,"",39021)
"RTN","XMXADDR1",41,0)
 Q
"RTN","XMXADDR1",42,0)
REMDT(XMG) ;
"RTN","XMXADDR1",43,0)
 N XMFDA
"RTN","XMXADDR1",44,0)
 S XMFDA(4.2997,XMG_",",6)=$E(DT,1,5)  ; Date (YYYMM) remote address last used
"RTN","XMXADDR1",45,0)
 D FILE^DIE("","XMFDA")
"RTN","XMXADDR1",46,0)
 Q
"RTN","XMXADDR1",47,0)
IPERSON(XMDUZ,XMADDR,XMSTRIKE,XMPREFIX,XMLATER,XMG,XMFULL) ;
"RTN","XMXADDR1",48,0)
 N DIC,D,X,Y,XMINDEX
"RTN","XMXADDR1",49,0)
 S XMADDR=$$UP^XLFSTR(XMADDR)
"RTN","XMXADDR1",50,0)
 S DIC("S")="I $L($P(^(0),U,3)),$D(^XMB(3.7,+Y,2))"  ; User must have an access code & mailbox
"RTN","XMXADDR1",51,0)
 I XMSTRIKE S DIC("S")=DIC("S")_",$D(^TMP(""XMY"",$J,+Y))" ; If '-', must already have been chosen
"RTN","XMXADDR1",52,0)
 S DIC("W")="I Y'=DUZ D USERINFO^XMXADDR1(Y)"
"RTN","XMXADDR1",53,0)
 S DIC="^VA(200,"
"RTN","XMXADDR1",54,0)
 S DIC(0)="FEZMN"  ; If user enters a DUZ, ask "OK?"
"RTN","XMXADDR1",55,0)
 S X=XMADDR
"RTN","XMXADDR1",56,0)
 ;S DIC(0)="FEZM"  ; If user enters a DUZ, do NOT ask "OK?"
"RTN","XMXADDR1",57,0)
 ;S X=$S(XMADDR=+XMADDR:"`"_XMADDR,1:XMADDR)
"RTN","XMXADDR1",58,0)
 S (XMINDEX,D)="B^BB^C^D" ; name^alias^initial^nickname
"RTN","XMXADDR1",59,0)
 D MIX^DIC1
"RTN","XMXADDR1",60,0)
 I Y>0 D  Q
"RTN","XMXADDR1",61,0)
 . S XMG=+Y
"RTN","XMXADDR1",62,0)
 . S XMFULL=$$NAME^XMXUTIL(XMG) ; $P(Y,U,2)
"RTN","XMXADDR1",63,0)
 . Q:XMSTRIKE
"RTN","XMXADDR1",64,0)
 . ; Sending to yourself, and ask bskt, and not creating a forwarding address
"RTN","XMXADDR1",65,0)
 . I XMG=XMDUZ,$G(XMINSTR("ADDR FLAGS"))'["X",XMV("ASK BSKT") D
"RTN","XMXADDR1",66,0)
 . . N XMK,XMDIC
"RTN","XMXADDR1",67,0)
 . . S XMDIC("B")=$$EZBLD^DIALOG(37005) ;IN
"RTN","XMXADDR1",68,0)
 . . D SELBSKT^XMJBU(XMDUZ,$$EZBLD^DIALOG(39022),"L",.XMDIC,.XMK) ;Select basket to send to:
"RTN","XMXADDR1",69,0)
 . . I XMK=U D SETERR^XMXADDR4(0,"",39014) Q  ;No basket selected.
"RTN","XMXADDR1",70,0)
 . . S XMINSTR("SELF BSKT")=XMK
"RTN","XMXADDR1",71,0)
 . E  I XMG=.6 D
"RTN","XMXADDR1",72,0)
 . . D CHKSHARE
"RTN","XMXADDR1",73,0)
 . . I $D(XMERROR) D WRIERR^XMXADDR4("!") Q
"RTN","XMXADDR1",74,0)
 . . D ASKSHARE(.XMINSTR)
"RTN","XMXADDR1",75,0)
 . I $D(XMERROR) W !,XMFULL,$$EZBLD^DIALOG(39015) ;removed from recipient list.
"RTN","XMXADDR1",76,0)
 I $D(DUOUT)!$D(DTOUT) D  Q  ;up-arrow out. / time out.
"RTN","XMXADDR1",77,0)
 . D SETERR^XMXADDR4(0,"",$S($D(DUOUT):37000,1:37001))
"RTN","XMXADDR1",78,0)
 D NOTFOUND(XMADDR,XMINDEX)
"RTN","XMXADDR1",79,0)
 I XMADDR=+XMADDR D SETERR^XMXADDR4(0,"",39002) Q  ;Not found.
"RTN","XMXADDR1",80,0)
 W !,$C(7),$$EZBLD^DIALOG(39026),XMADDR ;Checking for MAIL NAME:
"RTN","XMXADDR1",81,0)
 S X=XMADDR
"RTN","XMXADDR1",82,0)
 K DIC("S"),DIC("W")
"RTN","XMXADDR1",83,0)
 S DIC(0)="FEZ"
"RTN","XMXADDR1",84,0)
 S D="C"
"RTN","XMXADDR1",85,0)
 S DIC="^XMB(3.7,"
"RTN","XMXADDR1",86,0)
 D IX^DIC
"RTN","XMXADDR1",87,0)
 I Y>0 D  Q
"RTN","XMXADDR1",88,0)
 . S XMG=+Y
"RTN","XMXADDR1",89,0)
 . S XMFULL=Y(0,0)
"RTN","XMXADDR1",90,0)
 I $D(DUOUT)!$D(DTOUT) D  Q  ;up-arrow out. / time out.
"RTN","XMXADDR1",91,0)
 . D SETERR^XMXADDR4(0,"",$S($D(DUOUT):37000,1:37001))
"RTN","XMXADDR1",92,0)
 ; Not a Mail Name, see if it's in the Remote User Directory.
"RTN","XMXADDR1",93,0)
 N XMFIND,DIR,XMG
"RTN","XMXADDR1",94,0)
 S XMFIND=X
"RTN","XMXADDR1",95,0)
 W !
"RTN","XMXADDR1",96,0)
 D BLD^DIALOG(39025,"","","DIR(""A"")") ; Not a local user; want to check the Remote User Directory?
"RTN","XMXADDR1",97,0)
 S DIR(0)="Y",DIR("B")=$$EZBLD^DIALOG(39053) ; No
"RTN","XMXADDR1",98,0)
 D BLD^DIALOG(39025.1,"","","DIR(""?"")")
"RTN","XMXADDR1",99,0)
 D ^DIR
"RTN","XMXADDR1",100,0)
 I 'Y W !
"RTN","XMXADDR1",101,0)
 E  D  Q:$D(XMG)
"RTN","XMXADDR1",102,0)
 . S X=XMFIND  ;Not a local user; checking Remote User Directory
"RTN","XMXADDR1",103,0)
 . W !,$C(7),$$EZBLD^DIALOG(39027),X
"RTN","XMXADDR1",104,0)
 . S DIC(0)="MFEVZ"
"RTN","XMXADDR1",105,0)
 . S D="B^F"
"RTN","XMXADDR1",106,0)
 . S DIC="^XMD(4.2997,"
"RTN","XMXADDR1",107,0)
 . D MIX^DIC1 Q:Y<0
"RTN","XMXADDR1",108,0)
 . S XMG=+Y
"RTN","XMXADDR1",109,0)
 . S XMADDR=$P(Y(0),U,7)
"RTN","XMXADDR1",110,0)
 . D CHKREM(XMG,XMADDR) Q:$D(XMERROR)
"RTN","XMXADDR1",111,0)
 . D REMDT(XMG)
"RTN","XMXADDR1",112,0)
 . W !,$$EZBLD^DIALOG(39028),XMADDR ;Routing to Remote Address:
"RTN","XMXADDR1",113,0)
 . D REMOTE^XMXADDR3(XMDUZ,XMADDR,XMSTRIKE,XMPREFIX,.XMLATER,.XMFULL) ;Q:$D(XMERROR)
"RTN","XMXADDR1",114,0)
 I $D(DUOUT)!$D(DTOUT) D  Q  ;up-arrow out. / time out.
"RTN","XMXADDR1",115,0)
 . D SETERR^XMXADDR4(0,"",$S($D(DUOUT):37000,1:37001))
"RTN","XMXADDR1",116,0)
 ; Not in Remote User Directory, see if it's a Mail Group
"RTN","XMXADDR1",117,0)
 S DIC="^XMB(3.8,"
"RTN","XMXADDR1",118,0)
 S D="B"
"RTN","XMXADDR1",119,0)
 S DIC(0)="O"
"RTN","XMXADDR1",120,0)
 D IX^DIC
"RTN","XMXADDR1",121,0)
 I Y>0 D  Q  ;Enter 'G.groupname' to identify a mail group
"RTN","XMXADDR1",122,0)
 . D SETERR^XMXADDR4(1,"!",39029)
"RTN","XMXADDR1",123,0)
 D SETERR^XMXADDR4(1,"",39002) ;Not found.
"RTN","XMXADDR1",124,0)
 Q
"RTN","XMXADDR1",125,0)
ASKSHARE(XMINSTR) ;
"RTN","XMXADDR1",126,0)
 N XMK,XMDIC
"RTN","XMXADDR1",127,0)
 S XMDIC("B")=$$EZBLD^DIALOG(37005) ;IN
"RTN","XMXADDR1",128,0)
 D SELBSKT^XMJBU(.6,$$EZBLD^DIALOG(39022),"L",.XMDIC,.XMK) ;Select basket to send to:
"RTN","XMXADDR1",129,0)
 I XMK=U D SETERR^XMXADDR4(0,"",39014) Q  ;No basket selected.
"RTN","XMXADDR1",130,0)
 N DIR,X,Y
"RTN","XMXADDR1",131,0)
 S DIR("A")=$$EZBLD^DIALOG(39023) ;Enter Termination Date
"RTN","XMXADDR1",132,0)
 S DIR("B")="T+30"
"RTN","XMXADDR1",133,0)
 S DIR(0)="D^"_DT_"::ENX"
"RTN","XMXADDR1",134,0)
 ;Messages sent to SHARED,MAIL must have a delete date, so
"RTN","XMXADDR1",135,0)
 ;they may be automatically removed from SHARED,MAIL's mailbox.
"RTN","XMXADDR1",136,0)
 D BLD^DIALOG(39024,"","","DIR(""?"")")
"RTN","XMXADDR1",137,0)
 S DIR("??")="^D HELP^%DTC"
"RTN","XMXADDR1",138,0)
 D ^DIR
"RTN","XMXADDR1",139,0)
 I $D(DIRUT) D SETERR^XMXADDR4(0,"",37002) Q  ;up-arrow or time out.
"RTN","XMXADDR1",140,0)
 S XMINSTR("SHARE BSKT")=XMK
"RTN","XMXADDR1",141,0)
 S XMINSTR("SHARE DATE")=Y
"RTN","XMXADDR1",142,0)
 Q
"RTN","XMXADDR1",143,0)
CHKREM(DA,XMADDR) ; Is the remote address really local?
"RTN","XMXADDR1",144,0)
 S XMADDR=$$UP^XLFSTR($P(XMADDR,"@",2))
"RTN","XMXADDR1",145,0)
 I $$FIND1^DIC(4.2,"","QO",XMADDR,"B^C")'=^XMB("NUM") Q
"RTN","XMXADDR1",146,0)
 N DIK
"RTN","XMXADDR1",147,0)
 S DIK="^XMD(4.2997,"
"RTN","XMXADDR1",148,0)
 D ^DIK
"RTN","XMXADDR1",149,0)
 I '$G(XMIA) D SETERR^XMXADDR4(0,"",39002) Q  ;Not found.
"RTN","XMXADDR1",150,0)
 D SETERR^XMXADDR4(1,"!",39028.1) ; Remote address is really local.  Deleting it.
"RTN","XMXADDR1",151,0)
 Q
"RTN","XMXADDR1",152,0)
USERINFO(XMDUZ) ;
"RTN","XMXADDR1",153,0)
 N %
"RTN","XMXADDR1",154,0)
 W:XMV("SHOW DUZ") " (DUZ ",XMDUZ,")"
"RTN","XMXADDR1",155,0)
 S %=$P($G(^VA(200,XMDUZ,5)),U,1)  ; Service/Section
"RTN","XMXADDR1",156,0)
 I % S %=$P($G(^DIC(49,%,0)),U,1) W:$L(%)+$X+1>79 !,?4 W " ",%," "
"RTN","XMXADDR1",157,0)
 S %=$P($G(^XMB(3.7,XMDUZ,"L"),$$EZBLD^DIALOG(38002)),U,1) ;Never
"RTN","XMXADDR1",158,0)
 W:$L(%)+$X+20>79 !,?4 W $$EZBLD^DIALOG(38003),% ;Last used MailMan:
"RTN","XMXADDR1",159,0)
 S %=$G(^XMB(3.7,XMDUZ,0))
"RTN","XMXADDR1",160,0)
 I $L($P(%,U,2)) W !,?5,$$EZBLD^DIALOG(38004),$P(%,U,2),$S($P(%,U,8):$$EZBLD^DIALOG(38005),1:$$EZBLD^DIALOG(38006)) ;Forwarding Address: / Local Delivery is ON / Local Delivery is OFF
"RTN","XMXADDR1",161,0)
 S %=$G(^XMB(3.7,XMDUZ,"B")) W:%'="" !,?10,%
"RTN","XMXADDR1",162,0)
 Q
"RTN","XMXADDR1",163,0)
NOTFOUND(XMADDR,XMINDEX) ;
"RTN","XMXADDR1",164,0)
 N XMI,XMREC
"RTN","XMXADDR1",165,0)
 S XMI=$$FIND1^DIC(200,"","O",$S(+XMADDR=XMADDR:"`"_XMADDR,1:XMADDR),XMINDEX)
"RTN","XMXADDR1",166,0)
 I 'XMI W $C(7),$$EZBLD^DIALOG(39030) Q  ;Not found in NEW PERSON file.
"RTN","XMXADDR1",167,0)
 ; found user, but missing access/verify/mailbox
"RTN","XMXADDR1",168,0)
 S XMREC=^VA(200,XMI,0)
"RTN","XMXADDR1",169,0)
 I $D(^XMB(3.7,XMI,2)),$P(XMREC,U,3)'="" Q
"RTN","XMXADDR1",170,0)
 N XMPARM,XMTEXT
"RTN","XMXADDR1",171,0)
 S XMPARM(1)=$$NAME^XMXUTIL(XMI)
"RTN","XMXADDR1",172,0)
 S XMPARM(2)=$S($P(XMREC,U,3)'="":$$EZBLD^DIALOG(39034),$D(^XMB(3.7,XMI,2)):$$EZBLD^DIALOG(39032),1:$$EZBLD^DIALOG(39033)) ;a mailbox / an access code or a mailbox / an access code
"RTN","XMXADDR1",173,0)
 ;If |1| is the person you're trying to address, you can't,
"RTN","XMXADDR1",174,0)
 ;because |1| doesn't have |2|.
"RTN","XMXADDR1",175,0)
 D BLD^DIALOG(39031,.XMPARM,"","XMTEXT","F")
"RTN","XMXADDR1",176,0)
 D MSG^DIALOG("WH","","","","XMTEXT")
"RTN","XMXADDR1",177,0)
 Q
"RTN","XMXADDR2")
0^89^B44254386
"RTN","XMXADDR2",1,0)
XMXADDR2 ;ISC-SF/GMB-XMXADDR (cont.) ;04/17/2002  13:42
"RTN","XMXADDR2",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMXADDR2",3,0)
BRODCAST(XMDUZ,XMADDR,XMSTRIKE,XMPREFIX,XMLATER,XMFULL) ;
"RTN","XMXADDR2",4,0)
 I $D(XMRESTR("NET RECEIVE")) D SETERR^XMXADDR4(0,"",39035) Q  ;Broadcast messages are not accepted from remote sites.
"RTN","XMXADDR2",5,0)
 I DUZ'=.5,'$D(^XUSEC("XMSTAR",DUZ)),'$D(^XUSEC("XMSTAR LIMITED",DUZ)) D  Q
"RTN","XMXADDR2",6,0)
 . ;Only the Postmaster or XMSTAR key holders may broadcast messages.
"RTN","XMXADDR2",7,0)
 . D SETERR^XMXADDR4($G(XMIA),"!",39036)
"RTN","XMXADDR2",8,0)
 I $D(XMRESTR("NOBCAST")) D SETERR^XMXADDR4($G(XMIA),"P",39036.5) Q  ; Messages with replies may not be broadcast.
"RTN","XMXADDR2",9,0)
 N XMCAST
"RTN","XMXADDR2",10,0)
 I DUZ=.5!$D(^XUSEC("XMSTAR",DUZ)) D  Q:$D(XMERROR)
"RTN","XMXADDR2",11,0)
 . I '$G(XMIA) S XMCAST=$S(XMADDR="*":"F",1:"L") Q
"RTN","XMXADDR2",12,0)
 . I XMADDR'="*" S XMCAST="L" Q
"RTN","XMXADDR2",13,0)
 . D TYPECAST(.XMCAST)
"RTN","XMXADDR2",14,0)
 E  S XMCAST="L"
"RTN","XMXADDR2",15,0)
 I XMCAST="F" D FULLCAST(XMSTRIKE,XMPREFIX,XMLATER,.XMFULL) Q
"RTN","XMXADDR2",16,0)
 ; Doing a limited broadcast...
"RTN","XMXADDR2",17,0)
 N XMLTD
"RTN","XMXADDR2",18,0)
 I XMADDR'="*" D
"RTN","XMXADDR2",19,0)
 . D CHECKIT(XMADDR,.XMLTD)
"RTN","XMXADDR2",20,0)
 E  D
"RTN","XMXADDR2",21,0)
 . D TYPELTD(.XMLTD) Q:$D(XMERROR)
"RTN","XMXADDR2",22,0)
 . D PARMLTD(.XMLTD) Q:$D(XMERROR)
"RTN","XMXADDR2",23,0)
 Q:$D(XMERROR)
"RTN","XMXADDR2",24,0)
 ;S XMFULL="* (Limited Broadcast)"
"RTN","XMXADDR2",25,0)
 S XMFULL="*;"_XMLTD("TYPE")_";"_XMLTD("PARM")
"RTN","XMXADDR2",26,0)
 I $G(XMINSTR("ADDR FLAGS"))["X" Q
"RTN","XMXADDR2",27,0)
 I XMSTRIKE Q:$D(^TMP("XMY0",$J,XMFULL,"L"))  W:$G(XMIA) $$EZBLD^DIALOG(39037) ;Deleting limited broadcast recipients
"RTN","XMXADDR2",28,0)
 I $G(XMIA),'XMSTRIKE,XMLATER="?" D QLATER^XMXADDR(XMFULL,.XMLATER)  Q:$D(XMERROR)
"RTN","XMXADDR2",29,0)
 I XMLATER,'$G(XMIA) Q
"RTN","XMXADDR2",30,0)
 I 'XMSTRIKE,$G(XMIA) W !,$$EZBLD^DIALOG(39038),! ;Limited broadcast recipients:
"RTN","XMXADDR2",31,0)
 N XMSCREEN
"RTN","XMXADDR2",32,0)
 ; User must have access code, verify code, primary menu, and mailbox
"RTN","XMXADDR2",33,0)
 S XMSCREEN="I $L($P(^(0),U,3)),$L($P($G(^(.1)),U,2)),$L($P($G(^(201)),U,1)),$D(^XMB(3.7,+Y,2))"
"RTN","XMXADDR2",34,0)
 D FIND^DIC(200,"","@","QX",XMLTD("PARM IEN"),"",XMLTD("XREF"),XMSCREEN)
"RTN","XMXADDR2",35,0)
 I '$D(^TMP("DILIST",$J)) D  Q
"RTN","XMXADDR2",36,0)
 . D SETERR^XMXADDR4($G(XMIA),"",39039) ;No matches.  No recipients.
"RTN","XMXADDR2",37,0)
 D SHOWLTD(XMDUZ,XMSTRIKE,XMPREFIX,XMLATER,$G(XMIA))
"RTN","XMXADDR2",38,0)
 Q
"RTN","XMXADDR2",39,0)
TYPECAST(XMCAST) ;
"RTN","XMXADDR2",40,0)
 N DIR,XMALL
"RTN","XMXADDR2",41,0)
 S XMALL=$$EZBLD^DIALOG(39040) ;Broadcast to all local users
"RTN","XMXADDR2",42,0)
 S DIR(0)="S^"_XMALL_";"_$$EZBLD^DIALOG(39041) ;Limited broadcast to local users
"RTN","XMXADDR2",43,0)
 D BLD^DIALOG(39042,"","","DIR(""A"")") ;Broadcast type
"RTN","XMXADDR2",44,0)
 S DIR("B")=$P(XMALL,":",2,9)
"RTN","XMXADDR2",45,0)
 ;Enter B to broadcast to all local users.
"RTN","XMXADDR2",46,0)
 ;Enter L to broadcast to a subset of local users.  Limited broadcasts
"RTN","XMXADDR2",47,0)
 ;are to local users who have something in common, such as belonging
"RTN","XMXADDR2",48,0)
 ;to the same DIVISION, or holding the same PRIMARY MENU.
"RTN","XMXADDR2",49,0)
 ;The LIMITED BROADCASTs from which you may choose are defined by
"RTN","XMXADDR2",50,0)
 ;your IRM in the MAILMAN SITE PARAMETERS file.
"RTN","XMXADDR2",51,0)
 D BLD^DIALOG(39043,"","","DIR(""?"")")
"RTN","XMXADDR2",52,0)
 D ^DIR I $D(DIRUT) D SETERR^XMXADDR4(0,"",37002) Q  ;up-arrow or time out.
"RTN","XMXADDR2",53,0)
 S XMCAST=$S(Y=$P(XMALL,":",1):"F",1:"L")
"RTN","XMXADDR2",54,0)
 Q
"RTN","XMXADDR2",55,0)
FULLCAST(XMSTRIKE,XMPREFIX,XMLATER,XMFULL) ;
"RTN","XMXADDR2",56,0)
 S XMFULL=$$EZBLD^DIALOG(39006) ;* (Broadcast to all local users)
"RTN","XMXADDR2",57,0)
 W:$G(XMIA) $E(XMFULL,2,99)
"RTN","XMXADDR2",58,0)
 D SETEXP^XMXADDR(XMFULL,"",XMSTRIKE,XMPREFIX,XMLATER)
"RTN","XMXADDR2",59,0)
 Q
"RTN","XMXADDR2",60,0)
TYPELTD(XMLTD) ;
"RTN","XMXADDR2",61,0)
 N DIC,DA,X,Y,DIR,XMDEF
"RTN","XMXADDR2",62,0)
 S DA(1)=1
"RTN","XMXADDR2",63,0)
 S DIC="^XMB(1,1,5,"
"RTN","XMXADDR2",64,0)
 S XMDEF=$P(^XMB(1,1,0),U,20) I XMDEF S XMDEF=$P($G(^XMB(1,1,5,XMDEF,0)),U,1) I XMDEF'="" S DIC("B")=XMDEF
"RTN","XMXADDR2",65,0)
 S DIC(0)="AEQZ"
"RTN","XMXADDR2",66,0)
 D ^DIC I Y=-1!$D(DTOUT)!$D(DUOUT) D SETERR^XMXADDR4(0,"",37002) Q  ;up-arrow or time out.
"RTN","XMXADDR2",67,0)
 S XMLTD("TYPE IEN")=+Y
"RTN","XMXADDR2",68,0)
 S XMLTD("TYPE")=$P(Y(0),U,1)
"RTN","XMXADDR2",69,0)
 S XMLTD("FILE")=$P(Y(0),U,2)
"RTN","XMXADDR2",70,0)
 S XMLTD("XREF")=$P(Y(0),U,3)
"RTN","XMXADDR2",71,0)
 D CHKFILE(.XMLTD) Q:$D(XMERROR)
"RTN","XMXADDR2",72,0)
 D CHKXREF(.XMLTD) Q:$D(XMERROR)
"RTN","XMXADDR2",73,0)
 Q
"RTN","XMXADDR2",74,0)
CHKFILE(XMLTD) ;
"RTN","XMXADDR2",75,0)
 I XMLTD("FILE")="" D  Q
"RTN","XMXADDR2",76,0)
 . ;Limited Broadcast entry |1|, field |2| is null.
"RTN","XMXADDR2",77,0)
 . D SETERR^XMXADDR4($G(XMIA),"!",39044,XMLTD("TYPE IEN"),1)
"RTN","XMXADDR2",78,0)
 I '$$VFILE^DILFD(XMLTD("FILE")) D  Q
"RTN","XMXADDR2",79,0)
 . ;Limited Broadcast entry |1|, field |2|: '|3|' does not exist.
"RTN","XMXADDR2",80,0)
 . D SETERR^XMXADDR4($G(XMIA),"!",39045,XMLTD("TYPE IEN"),1,XMLTD("FILE"))
"RTN","XMXADDR2",81,0)
 Q
"RTN","XMXADDR2",82,0)
CHKXREF(XMLTD) ;
"RTN","XMXADDR2",83,0)
 I XMLTD("XREF")="" D  Q
"RTN","XMXADDR2",84,0)
 . ;Limited Broadcast entry |1|, field |2| is null.
"RTN","XMXADDR2",85,0)
 . D SETERR^XMXADDR4($G(XMIA),"!",39044,XMLTD("TYPE IEN"),2)
"RTN","XMXADDR2",86,0)
 I '$D(^VA(200,XMLTD("XREF"))) D  Q
"RTN","XMXADDR2",87,0)
 . ;Limited Broadcast entry |1|, field |2|: '|3|' does not exist.
"RTN","XMXADDR2",88,0)
 . D SETERR^XMXADDR4($G(XMIA),"!",39045,XMLTD("TYPE IEN"),2,XMLTD("XREF"))
"RTN","XMXADDR2",89,0)
 Q
"RTN","XMXADDR2",90,0)
PARMLTD(XMLTD) ;
"RTN","XMXADDR2",91,0)
 N DIC,DIR,X,Y
"RTN","XMXADDR2",92,0)
 S DIC=$$ROOT^DILFD(XMLTD("FILE"))
"RTN","XMXADDR2",93,0)
 S DIC(0)="AEQZ"
"RTN","XMXADDR2",94,0)
 S DIC("S")="I $D(^VA(200,"""_XMLTD("XREF")_""",+Y))"
"RTN","XMXADDR2",95,0)
 S DIC("A")=$$EZBLD^DIALOG(39046,XMLTD("TYPE")) ;Select Limited Broadcast |1|:
"RTN","XMXADDR2",96,0)
 D ^DIC I Y=-1!$D(DTOUT)!$D(DUOUT) D SETERR^XMXADDR4(0,"",37002) Q  ;up-arrow or time out.
"RTN","XMXADDR2",97,0)
 S XMLTD("PARM IEN")=+Y
"RTN","XMXADDR2",98,0)
 S XMLTD("PARM")=Y(0,0)
"RTN","XMXADDR2",99,0)
 Q
"RTN","XMXADDR2",100,0)
CHECKIT(XMADDR,XMLTD) ;
"RTN","XMXADDR2",101,0)
 S XMLTD("TYPE")=$P(XMADDR,";",2) I XMLTD("TYPE")="" D SETERR^XMXADDR4($G(XMIA),"!",39047) Q  ;Limited Broadcast selection is null.
"RTN","XMXADDR2",102,0)
 S XMLTD("PARM")=$P(XMADDR,";",3) I XMLTD("PARM")="" D SETERR^XMXADDR4($G(XMIA),"!",39047.5) Q  ;Limited Broadcast selection value is null.
"RTN","XMXADDR2",103,0)
 S XMLTD("TYPE IEN")=$$FIND1^DIC(4.32,",1,","OQ",XMLTD("TYPE"))
"RTN","XMXADDR2",104,0)
 I 'XMLTD("TYPE IEN") D SETERR^XMXADDR4($G(XMIA),"!",$S(XMLTD("TYPE IEN")=0:39048,1:39049),XMLTD("TYPE")) Q  ;Limited Broadcast selection not found: |1| / Limited Broadcast selection ambiguous: |1|
"RTN","XMXADDR2",105,0)
 N XMREC
"RTN","XMXADDR2",106,0)
 S XMREC=$G(^XMB(1,1,5,XMLTD("TYPE IEN"),0))
"RTN","XMXADDR2",107,0)
 S XMLTD("TYPE")=$P(XMREC,U,1)
"RTN","XMXADDR2",108,0)
 S XMLTD("FILE")=$P(XMREC,U,2)
"RTN","XMXADDR2",109,0)
 S XMLTD("XREF")=$P(XMREC,U,3)
"RTN","XMXADDR2",110,0)
 D CHKFILE(.XMLTD) Q:$D(XMERROR)
"RTN","XMXADDR2",111,0)
 D CHKXREF(.XMLTD) Q:$D(XMERROR)
"RTN","XMXADDR2",112,0)
 S XMLTD("PARM IEN")=$$FIND1^DIC(XMLTD("FILE"),"","OQ",XMLTD("PARM"))
"RTN","XMXADDR2",113,0)
 I XMLTD("PARM IEN") S XMLTD("PARM")=$$GET1^DIQ(XMLTD("FILE"),XMLTD("PARM IEN")_",",.01) Q
"RTN","XMXADDR2",114,0)
 N XMPARM S XMPARM(1)=XMLTD("PARM"),XMPARM(2)=XMLTD("FILE")
"RTN","XMXADDR2",115,0)
 D SETERR^XMXADDR4($G(XMIA),"!",$S(XMLTD("PARM IEN")=0:39050,1:39051),.XMPARM) ;Limited Broadcast value '|1|' not found / Limited Broadcast value '|1|' ambiguous
"RTN","XMXADDR2",116,0)
 Q
"RTN","XMXADDR2",117,0)
SHOWLTD(XMDUZ,XMSTRIKE,XMPREFIX,XMLATER,XMIA) ;
"RTN","XMXADDR2",118,0)
 N XMI,XMGM,XMCNT
"RTN","XMXADDR2",119,0)
 S (XMI,XMCNT)=0
"RTN","XMXADDR2",120,0)
 F  S XMI=$O(^TMP("DILIST",$J,2,XMI)) Q:'XMI  S XMGM=^(XMI) D
"RTN","XMXADDR2",121,0)
 . N XMERROR,XMFWDADD
"RTN","XMXADDR2",122,0)
 . I 'XMLATER D INDIV^XMXADDR(XMDUZ,XMGM,XMSTRIKE,XMPREFIX,XMLATER)
"RTN","XMXADDR2",123,0)
 . Q:'XMIA
"RTN","XMXADDR2",124,0)
 . I XMCNT,XMCNT#16=0 D  Q:'XMIA
"RTN","XMXADDR2",125,0)
 . . N DIR,Y ;Do you want to see more Limited Broadcast recipients
"RTN","XMXADDR2",126,0)
 . . S DIR("A")=$$EZBLD^DIALOG(39052)
"RTN","XMXADDR2",127,0)
 . . S DIR(0)="Y",DIR("B")=$$EZBLD^DIALOG(39053) ;No
"RTN","XMXADDR2",128,0)
 . . D ^DIR
"RTN","XMXADDR2",129,0)
 . . S XMIA=+Y  ; The '+' takes care of $D(DIRUT)
"RTN","XMXADDR2",130,0)
 . S XMCNT=XMCNT+1
"RTN","XMXADDR2",131,0)
 . W:XMCNT#4-1=0 !
"RTN","XMXADDR2",132,0)
 . W ?XMCNT-1#4*20,$E($S(XMPREFIX="":"",1:XMPREFIX_":")_$$NAME^XMXUTIL(XMGM),1,19)
"RTN","XMXADDR2",133,0)
 K ^TMP("DILIST",$J)
"RTN","XMXADDR2",134,0)
 Q
"RTN","XMXADDR2",135,0)
INXFORM(X) ; Input transform for file 4.3, field 51 LIMITED BROADCAST DEFAULT
"RTN","XMXADDR2",136,0)
 N DIC,DA,Y,DIR,XMERROR,XMLTD,XMIA
"RTN","XMXADDR2",137,0)
 I '$D(ZTQUEUED) S XMIA=1
"RTN","XMXADDR2",138,0)
 S DA(1)=1
"RTN","XMXADDR2",139,0)
 S DIC="^XMB(1,1,5,"
"RTN","XMXADDR2",140,0)
 S DIC(0)="EQZ"
"RTN","XMXADDR2",141,0)
 D ^DIC I Y=-1!$D(DTOUT)!$D(DUOUT) K X Q
"RTN","XMXADDR2",142,0)
 S XMLTD("TYPE IEN")=+Y
"RTN","XMXADDR2",143,0)
 S XMLTD("TYPE")=$P(Y(0),U,1)
"RTN","XMXADDR2",144,0)
 S XMLTD("FILE")=$P(Y(0),U,2)
"RTN","XMXADDR2",145,0)
 S XMLTD("XREF")=$P(Y(0),U,3)
"RTN","XMXADDR2",146,0)
 D CHKFILE(.XMLTD) I $D(XMERROR) K X Q
"RTN","XMXADDR2",147,0)
 D CHKXREF(.XMLTD) I $D(XMERROR) K X Q
"RTN","XMXADDR2",148,0)
 S X=XMLTD("TYPE IEN")
"RTN","XMXADDR2",149,0)
 Q
"RTN","XMXADDR2",150,0)
EXHELP ; Executable help for file 4.3, field 51 LIMITED BROADCAST DEFAULT
"RTN","XMXADDR2",151,0)
 N I
"RTN","XMXADDR2",152,0)
 D EN^DDIOL($$EZBLD^DIALOG(38056)) ; Choose from:
"RTN","XMXADDR2",153,0)
 S I=0
"RTN","XMXADDR2",154,0)
 F  S I=$O(^XMB(1,1,5,I)) Q:'I  D EN^DDIOL($P(^(I,0),U,1))
"RTN","XMXADDR2",155,0)
 Q
"RTN","XMXADDR3")
0^223^B27839753
"RTN","XMXADDR3",1,0)
XMXADDR3 ;ISC-SF/GMB-XMXADDR (cont.) ;04/17/2002  13:47
"RTN","XMXADDR3",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMXADDR3",3,0)
SERVER(XMADDR,XMSTRIKE,XMPREFIX,XMLATER,XMFULL) ;
"RTN","XMXADDR3",4,0)
 N XMG
"RTN","XMXADDR3",5,0)
 S XMADDR=$P(XMADDR,".",2,99)
"RTN","XMXADDR3",6,0)
 I $G(XMIA) D
"RTN","XMXADDR3",7,0)
 . N DIC,X
"RTN","XMXADDR3",8,0)
 . S X=XMADDR
"RTN","XMXADDR3",9,0)
 . S DIC="^DIC(19,"
"RTN","XMXADDR3",10,0)
 . S DIC(0)="FEZ"_$S($D(XMGCIRCL):"O",1:"")
"RTN","XMXADDR3",11,0)
 . D ^DIC
"RTN","XMXADDR3",12,0)
 . I Y<0 D SETERR^XMXADDR4(1,"!",39060) Q  ;Invalid server name
"RTN","XMXADDR3",13,0)
 . S XMG=+Y
"RTN","XMXADDR3",14,0)
 E  D
"RTN","XMXADDR3",15,0)
 . S XMG=$$FIND1^DIC(19,"","O",XMADDR) I 'XMG D SETERR^XMXADDR4(0,"",$S($D(DIERR):39061,1:39062)) ; Server ambiguous / Server not found.
"RTN","XMXADDR3",16,0)
 Q:$D(XMERROR)
"RTN","XMXADDR3",17,0)
 S XMFULL="S."_$P(^DIC(19,XMG,0),U,1)
"RTN","XMXADDR3",18,0)
 D SETEXP^XMXADDR(XMFULL,XMG,XMSTRIKE,XMPREFIX,XMLATER)
"RTN","XMXADDR3",19,0)
 Q
"RTN","XMXADDR3",20,0)
DEVICE(XMADDR,XMSTRIKE,XMPREFIX,XMLATER,XMFULL) ;
"RTN","XMXADDR3",21,0)
 N XMG
"RTN","XMXADDR3",22,0)
 S XMADDR1=$$UP^XLFSTR($E(XMADDR,1))
"RTN","XMXADDR3",23,0)
 S XMADDR=$P(XMADDR,".",2,99)
"RTN","XMXADDR3",24,0)
 I $G(XMIA) D
"RTN","XMXADDR3",25,0)
 . N DIC,X
"RTN","XMXADDR3",26,0)
 . S X=XMADDR
"RTN","XMXADDR3",27,0)
 . S DIC="^%ZIS(1,"   ; file 3.5
"RTN","XMXADDR3",28,0)
 . S DIC(0)="EF"_$S($D(XMGCIRCL):"O",1:"")
"RTN","XMXADDR3",29,0)
 . D ^DIC
"RTN","XMXADDR3",30,0)
 . I Y<0 D SETERR^XMXADDR4(1,"!",39063) Q  ;Invalid device name
"RTN","XMXADDR3",31,0)
 . S XMG=+Y
"RTN","XMXADDR3",32,0)
 . S XMADDR=$P(Y,U,2)
"RTN","XMXADDR3",33,0)
 E  D
"RTN","XMXADDR3",34,0)
 . S XMG=$$FIND1^DIC(3.5,"","O",XMADDR) I 'XMG D SETERR^XMXADDR4(0,"",$S($D(DIERR):39064,1:39065)) Q  ; Device ambiguous. / Device not found.
"RTN","XMXADDR3",35,0)
 . S XMADDR=$P(^%ZIS(1,XMG,0),U,1)
"RTN","XMXADDR3",36,0)
 Q:$D(XMERROR)
"RTN","XMXADDR3",37,0)
 I XMADDR["P-MESSAGE" D  Q  ;You may not use P-MESSAGE in an address.
"RTN","XMXADDR3",38,0)
 . D SETERR^XMXADDR4($G(XMIA),"!",39066)
"RTN","XMXADDR3",39,0)
 S XMFULL=XMADDR1_"."_XMADDR
"RTN","XMXADDR3",40,0)
 D SETEXP^XMXADDR(XMFULL,XMG,XMSTRIKE,XMPREFIX,XMLATER)
"RTN","XMXADDR3",41,0)
 Q
"RTN","XMXADDR3",42,0)
REMOTE(XMDUZ,XMADDR,XMSTRIKE,XMPREFIX,XMLATER,XMFULL) ;
"RTN","XMXADDR3",43,0)
 ; XMVIA    IEN of domain in ^DIC(4.2 via which the msg will be sent
"RTN","XMXADDR3",44,0)
 ; XMVIAN   Name of domain via which the msg will be sent
"RTN","XMXADDR3",45,0)
 ; XMDOMAIN Domain of the addressee
"RTN","XMXADDR3",46,0)
 ; XMNAME   Name of the addressee
"RTN","XMXADDR3",47,0)
 N XMVIA,XMVIAN,XMDOMAIN,XMNAME
"RTN","XMXADDR3",48,0)
 S:XMADDR["<"!(XMADDR[" ") XMADDR=$$REMADDR(XMADDR)
"RTN","XMXADDR3",49,0)
 S XMNAME=$P(XMADDR,"@",1)
"RTN","XMXADDR3",50,0)
 I XMNAME="" D  Q
"RTN","XMXADDR3",51,0)
 . D SETERR^XMXADDR4($G(XMIA),"!",39010) ;Null addressee
"RTN","XMXADDR3",52,0)
 S XMDOMAIN=$P(XMADDR,"@",2,99)
"RTN","XMXADDR3",53,0)
 I XMDOMAIN="" D  Q
"RTN","XMXADDR3",54,0)
 . ; You must specify a reachable uunet host / Null domain
"RTN","XMXADDR3",55,0)
 . D SETERR^XMXADDR4($G(XMIA),"!",$S(XMNAME["!":39067,1:39068))
"RTN","XMXADDR3",56,0)
 ; find out the full domain name, and
"RTN","XMXADDR3",57,0)
 ; whether the domain is valid, and if so, via which entry in DIC(4.2
"RTN","XMXADDR3",58,0)
 D DNS^XMXADDRD(XMDUZ,.XMDOMAIN,.XMVIA,.XMVIAN) Q:$D(XMERROR)
"RTN","XMXADDR3",59,0)
 I XMDOMAIN=^XMB("NETNAME") D  ; the full domain name = the local domain
"RTN","XMXADDR3",60,0)
 . N XMQUOTED
"RTN","XMXADDR3",61,0)
 . I XMNAME?1""""1.E1"""" S XMNAME=$E(XMNAME,2,$L(XMNAME)-1),XMQUOTED=1
"RTN","XMXADDR3",62,0)
 . I $E(XMNAME,1)=" "!($E(XMNAME,$L(XMNAME))=" ") S XMNAME=$$STRIP^XMXUTIL1(XMNAME)
"RTN","XMXADDR3",63,0)
 . D LOCAL^XMXADDR(XMDUZ,XMNAME,XMSTRIKE,XMPREFIX,.XMLATER,.XMFULL)
"RTN","XMXADDR3",64,0)
 . Q:'$D(XMERROR)
"RTN","XMXADDR3",65,0)
 . Q:$G(XMQUOTED)
"RTN","XMXADDR3",66,0)
 . N XMSAVE
"RTN","XMXADDR3",67,0)
 . S XMSAVE=XMNAME
"RTN","XMXADDR3",68,0)
 . I ".G.g.D.d.H.h.S.s."[("."_$E(XMNAME,1,2)) S XMNAME=$E(XMNAME,1,2)_$TR($E(XMNAME,3,99),"._+",", .")
"RTN","XMXADDR3",69,0)
 . E  S XMNAME=$TR(XMNAME,"._+",", .")
"RTN","XMXADDR3",70,0)
 . I XMSAVE'=XMNAME D  Q:'$D(XMERROR)
"RTN","XMXADDR3",71,0)
 . . K XMERROR
"RTN","XMXADDR3",72,0)
 . . I $G(XMIA) D EN^DDIOL($$EZBLD^DIALOG(39069,XMNAME)) ;Checking: |1|
"RTN","XMXADDR3",73,0)
 . . D LOCAL^XMXADDR(XMDUZ,XMNAME,XMSTRIKE,XMPREFIX,.XMLATER,.XMFULL)
"RTN","XMXADDR3",74,0)
 . Q:'$G(XMRESTR("NET RECEIVE"))
"RTN","XMXADDR3",75,0)
 . Q:"^39062^39065^39132^"'[(U_XMERROR_U)
"RTN","XMXADDR3",76,0)
 . ; Server, Device, or Group not found.  Try lower case.
"RTN","XMXADDR3",77,0)
 . ; (We do not need to try local user again.)
"RTN","XMXADDR3",78,0)
 . S XMSAVE=XMNAME,XMNAME=$$LOW^XLFSTR(XMNAME) Q:XMSAVE=XMNAME
"RTN","XMXADDR3",79,0)
 . K XMERROR
"RTN","XMXADDR3",80,0)
 . D LOCAL^XMXADDR(XMDUZ,XMNAME,XMSTRIKE,XMPREFIX,.XMLATER,.XMFULL)
"RTN","XMXADDR3",81,0)
 E  D
"RTN","XMXADDR3",82,0)
 . I $D(XMRESTR("NONET")) D  Q
"RTN","XMXADDR3",83,0)
 . . ;Messages longer than |1| lines may not be sent across the network.
"RTN","XMXADDR3",84,0)
 . . D SETERR^XMXADDR4($G(XMIA),"!",39001,XMRESTR("NONET"))
"RTN","XMXADDR3",85,0)
 . ; I XMDOMAIN?.E1".VA.GOV" D
"RTN","XMXADDR3",86,0)
 . ;. ; Check the address before the @ to find any obvious errors
"RTN","XMXADDR3",87,0)
 . ; Now transform spaces, commas, and periods in XMNAME
"RTN","XMXADDR3",88,0)
 . S XMFULL=XMNAME_"@"_XMDOMAIN
"RTN","XMXADDR3",89,0)
 . I XMSTRIKE D REMINUS(.XMFULL,XMNAME,XMDOMAIN) Q:$D(XMERROR)
"RTN","XMXADDR3",90,0)
 . I XMLATER="?" D QLATER^XMXADDR(XMFULL,.XMLATER) Q:$D(XMERROR)
"RTN","XMXADDR3",91,0)
 . D SETEXP^XMXADDR(XMFULL,XMVIA,XMSTRIKE,XMPREFIX,XMLATER)
"RTN","XMXADDR3",92,0)
 Q
"RTN","XMXADDR3",93,0)
REMINUS(XMFULL,XMNAME,XMDOMAIN) ;
"RTN","XMXADDR3",94,0)
 Q:$D(^TMP("XMY",$J,XMFULL))
"RTN","XMXADDR3",95,0)
 I $O(^TMP("XMY",$J,":"))="" Q:'$G(XMIA)  D  Q
"RTN","XMXADDR3",96,0)
 . D SETERR^XMXADDR4($G(XMIA),"!",39015.1) ;Not a current recipient.
"RTN","XMXADDR3",97,0)
 N XMTRY,XMTO
"RTN","XMXADDR3",98,0)
 S XMTRY=$$LOW^XLFSTR(XMNAME)_"@"_XMDOMAIN
"RTN","XMXADDR3",99,0)
 I $D(^TMP("XMY",$J,XMTRY)) S XMFULL=XMTRY Q
"RTN","XMXADDR3",100,0)
 S XMTRY=$$UP^XLFSTR(XMNAME)_"@"_XMDOMAIN
"RTN","XMXADDR3",101,0)
 I $D(^TMP("XMY",$J,XMTRY)) S XMFULL=XMTRY Q
"RTN","XMXADDR3",102,0)
 S XMTO=":"
"RTN","XMXADDR3",103,0)
 F  S XMTO=$O(^TMP("XMY",$J,XMTO)) Q:XMTO=""  Q:$$UP^XLFSTR(XMTO)=XMTRY
"RTN","XMXADDR3",104,0)
 I XMTO="" Q:'$G(XMIA)  D SETERR^XMXADDR4($G(XMIA),"!",39015.1) Q  ;Not a current recipient.
"RTN","XMXADDR3",105,0)
 S XMFULL=XMTO
"RTN","XMXADDR3",106,0)
 Q
"RTN","XMXADDR3",107,0)
REMADDR(XMADDR) ;
"RTN","XMXADDR3",108,0)
 I XMADDR["<" Q $TR($P($P(XMADDR,">",1),"<",2,99),"<")  ; handles <addr> and <<addr>>
"RTN","XMXADDR3",109,0)
 Q:XMADDR'[" " XMADDR
"RTN","XMXADDR3",110,0)
 I $E(XMADDR,1)=" "!($E(XMADDR,$L(XMADDR))=" ") S XMADDR=$$STRIP^XMXUTIL1(XMADDR)
"RTN","XMXADDR3",111,0)
 I XMADDR'["""",XMADDR'["(" Q XMADDR
"RTN","XMXADDR3",112,0)
 I XMADDR["""@" D  Q XMADDR
"RTN","XMXADDR3",113,0)
 . ; "first last"@domain
"RTN","XMXADDR3",114,0)
 . N I,J,XMDOM
"RTN","XMXADDR3",115,0)
 . S I=$F(XMADDR,"""@")
"RTN","XMXADDR3",116,0)
 . S XMDOM=$E(XMADDR,I,999)
"RTN","XMXADDR3",117,0)
 . S XMDOM=$P(XMDOM," ",1)
"RTN","XMXADDR3",118,0)
 . S J=$F(XMADDR,"""")
"RTN","XMXADDR3",119,0)
 . S XMADDR=$E(XMADDR,J-1,I-J)_"@"_XMDOM
"RTN","XMXADDR3",120,0)
 ; last.first@domain (first last)
"RTN","XMXADDR3",121,0)
 N I
"RTN","XMXADDR3",122,0)
 F I=1:1:$L(XMADDR," ") Q:$P(XMADDR," ",I)["@"
"RTN","XMXADDR3",123,0)
 S XMADDR=$P(XMADDR," ",1,I)
"RTN","XMXADDR3",124,0)
 Q XMADDR
"RTN","XMXADDR4")
0^90^B24786676
"RTN","XMXADDR4",1,0)
XMXADDR4 ;ISC-SF/GMB-XMXADDRG (cont.) ;04/17/2002  13:50
"RTN","XMXADDR4",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMXADDR4",3,0)
DISTR(XMDUZ,XMG,XMSTRIKE,XMPREFIX,XMLATER) ;
"RTN","XMXADDR4",4,0)
 ; XMGN     Distribution group name
"RTN","XMXADDR4",5,0)
 N XMGM,XMGN
"RTN","XMXADDR4",6,0)
 S XMGM=""
"RTN","XMXADDR4",7,0)
 F  S XMGM=$O(^XMB(3.8,XMG,7,"B",XMGM)) Q:'XMGM  D  I XMLATER,'$G(XMIA) Q
"RTN","XMXADDR4",8,0)
 . I '$D(^XMB(3.816,XMGM)) D DELETE1(XMG,7,XMGM) Q
"RTN","XMXADDR4",9,0)
 . S XMGN=$P(^XMB(3.816,XMGM,0),U,1) Q:XMGN=""
"RTN","XMXADDR4",10,0)
 . I ".S.s.D.d.H.h.G.g."'[("."_$E(XMGN,1,2)) S XMGN="G."_XMGN
"RTN","XMXADDR4",11,0)
 . W:$G(XMIA) !,$$EZBLD^DIALOG(39080),XMGN ;Distribution List:
"RTN","XMXADDR4",12,0)
 . D:'XMLATER EXPDISTR(XMDUZ,XMG,XMGM,XMGN,XMSTRIKE,XMPREFIX,XMLATER)
"RTN","XMXADDR4",13,0)
 Q
"RTN","XMXADDR4",14,0)
EXPDISTR(XMDUZ,XMG,XMGM,XMGN,XMSTRIKE,XMPREFIX,XMLATER) ;
"RTN","XMXADDR4",15,0)
 N XMI,XMDOMAIN
"RTN","XMXADDR4",16,0)
 ;S:".G.g."'[("."_$E(XMGM,1,2)) XMLATER=""  ; XMLATER not appropriate for Servers or Devices.
"RTN","XMXADDR4",17,0)
 S XMI=0
"RTN","XMXADDR4",18,0)
 F  S XMI=$O(^XMB(3.816,XMGM,1,"B",XMI)) Q:'XMI  D
"RTN","XMXADDR4",19,0)
 . Q:XMI=^XMB("NUM")
"RTN","XMXADDR4",20,0)
 . S XMDOMAIN=$P($G(^DIC(4.2,XMI,0)),U,1) Q:XMDOMAIN=""
"RTN","XMXADDR4",21,0)
 . N XMERROR,XMIA,XMVIA
"RTN","XMXADDR4",22,0)
 . D DNS^XMXADDRD(XMDUZ,XMDOMAIN,.XMVIA)
"RTN","XMXADDR4",23,0)
 . I $D(XMERROR) S ^TMP("XM",$J,"GRPERR",XMG,"D",XMGN_"@"_XMDOMAIN)=$$GETERR Q
"RTN","XMXADDR4",24,0)
 . S XMGMBRS=1
"RTN","XMXADDR4",25,0)
 . D SETEXP^XMXADDR(XMGN_"@"_XMDOMAIN,XMVIA,XMSTRIKE,XMPREFIX,XMLATER)
"RTN","XMXADDR4",26,0)
 Q
"RTN","XMXADDR4",27,0)
FAXGROUP(XMDUZ,XMG,XMSTRIKE,XMPREFIX,XMLATER) ;
"RTN","XMXADDR4",28,0)
 N XMGM,XMI
"RTN","XMXADDR4",29,0)
 S XMGM=""
"RTN","XMXADDR4",30,0)
 F  S XMGM=$O(^XMB(3.8,XMG,9,"B",XMGM)) Q:XMGM=""  D  I XMLATER,'$G(XMIA) Q
"RTN","XMXADDR4",31,0)
 . S XMGN=$P($G(^AKF("FAXG",XMGM,0)),U)
"RTN","XMXADDR4",32,0)
 . I XMGN="" D DELETE1(XMG,9,XMGM) Q
"RTN","XMXADDR4",33,0)
 . W:$G(XMIA) !,$$EZBLD^DIALOG(39081),XMGN ;Fax Group:
"RTN","XMXADDR4",34,0)
 . S XMI=""
"RTN","XMXADDR4",35,0)
 . F  S XMI=$O(^AKF("FAXG",XMGM,2,"B",XMI)) Q:XMI=""  D FAX(XMDUZ,XMI,XMSTRIKE,XMPREFIX,XMLATER)
"RTN","XMXADDR4",36,0)
 Q
"RTN","XMXADDR4",37,0)
FAX(XMDUZ,XMG,XMSTRIKE,XMPREFIX,XMLATER) ;
"RTN","XMXADDR4",38,0)
 N XMGN
"RTN","XMXADDR4",39,0)
 S XMGN=$P($G(^AKF("FAXR",XMG,0)),U)
"RTN","XMXADDR4",40,0)
 Q:XMGN=""
"RTN","XMXADDR4",41,0)
 W:$G(XMIA) !,$$EZBLD^DIALOG(39082),XMGN ;Fax Recipient:
"RTN","XMXADDR4",42,0)
 ;D SETEXP^XMXADDR("F."_XMGN,XMG,XMSTRIKE,XMPREFIX,"")  ; XMLATER not appropriate
"RTN","XMXADDR4",43,0)
 D:'XMLATER SETEXP^XMXADDR("F."_XMGN,XMG,XMSTRIKE,XMPREFIX,XMLATER)
"RTN","XMXADDR4",44,0)
 S XMGMBRS=1
"RTN","XMXADDR4",45,0)
 Q
"RTN","XMXADDR4",46,0)
FAXINDIV(XMDUZ,XMG,XMSTRIKE,XMPREFIX,XMLATER) ;
"RTN","XMXADDR4",47,0)
 ; XMGM     Group member
"RTN","XMXADDR4",48,0)
 N XMGM,XMCNT
"RTN","XMXADDR4",49,0)
 S XMGM="",XMCNT=0
"RTN","XMXADDR4",50,0)
 F  S XMGM=$O(^XMB(3.8,XMG,8,"B",XMGM)) Q:XMGM=""  D  I XMLATER,'$G(XMIA) Q
"RTN","XMXADDR4",51,0)
 . I '$D(^AKF("FAXR",XMGM)) D DELETE1(XMG,8,XMGM) Q
"RTN","XMXADDR4",52,0)
 . D FAX(XMDUZ,XMGM,XMSTRIKE,XMPREFIX,XMLATER)
"RTN","XMXADDR4",53,0)
 Q
"RTN","XMXADDR4",54,0)
DELETE1(XMGIEN,XMNODE,XMGM) ;
"RTN","XMXADDR4",55,0)
 N DIK,DA
"RTN","XMXADDR4",56,0)
 L +^XMB(3.8,XMGIEN,XMNODE):0 E  Q
"RTN","XMXADDR4",57,0)
 S DA=$O(^XMB(3.8,XMG,XMNODE,"B",XMGM,0))
"RTN","XMXADDR4",58,0)
 S DA(1)=XMGIEN
"RTN","XMXADDR4",59,0)
 S DIK="^XMB(3.8,"_DA(1)_","_XMNODE_","
"RTN","XMXADDR4",60,0)
 D ^DIK
"RTN","XMXADDR4",61,0)
 L -^XMB(3.8,XMGIEN,XMNODE)
"RTN","XMXADDR4",62,0)
 Q
"RTN","XMXADDR4",63,0)
DELETE2(XMGIEN,XMNODE,DA) ;
"RTN","XMXADDR4",64,0)
 N DIK
"RTN","XMXADDR4",65,0)
 L +^XMB(3.8,XMGIEN,XMNODE):0 E  Q
"RTN","XMXADDR4",66,0)
 S DA(1)=XMGIEN
"RTN","XMXADDR4",67,0)
 S DIK="^XMB(3.8,"_DA(1)_","_XMNODE_","
"RTN","XMXADDR4",68,0)
 D ^DIK
"RTN","XMXADDR4",69,0)
 L -^XMB(3.8,XMGIEN,XMNODE)
"RTN","XMXADDR4",70,0)
 Q
"RTN","XMXADDR4",71,0)
GRPERR(XMDUZ,XMG,XMGN) ; Send a bulletin about errors in groups.
"RTN","XMXADDR4",72,0)
 N XMGIEN,XMPARM,XMINSTR
"RTN","XMXADDR4",73,0)
 S XMINSTR("FROM")=.5
"RTN","XMXADDR4",74,0)
 S XMPARM(1)=XMGN
"RTN","XMXADDR4",75,0)
 S XMGIEN=0
"RTN","XMXADDR4",76,0)
 F  S XMGIEN=$O(^TMP("XM",$J,"GRPERR",XMGIEN)) Q:'XMGIEN  D
"RTN","XMXADDR4",77,0)
 . N XMTXT,XMI,XMTO
"RTN","XMXADDR4",78,0)
 . S XMI=0
"RTN","XMXADDR4",79,0)
 . I XMGIEN'=XMG D
"RTN","XMXADDR4",80,0)
 . . N XMPARM S XMPARM(1)=$P($G(^XMB(3.8,XMGIEN,0)),U,1),XMPARM(2)=XMGIEN
"RTN","XMXADDR4",81,0)
 . . S XMI=XMI+1,XMTXT(XMI)=""
"RTN","XMXADDR4",82,0)
 . . S XMI=XMI+1,XMTXT(XMI)=$$EZBLD^DIALOG(39083,.XMPARM) ;Problems in member group: |1| (IEN=|2|)
"RTN","XMXADDR4",83,0)
 . I $D(^TMP("XM",$J,"GRPERR",XMGIEN,"L")) D GRPTXT(XMGIEN,"L",39084,.XMTXT,.XMI) ;Local Member:
"RTN","XMXADDR4",84,0)
 . I $D(^TMP("XM",$J,"GRPERR",XMGIEN,"R")) D GRPTXT(XMGIEN,"R",39085,.XMTXT,.XMI) ;Remote Member:
"RTN","XMXADDR4",85,0)
 . I $D(^TMP("XM",$J,"GRPERR",XMGIEN,"D")) D GRPTXT(XMGIEN,"D",39086,.XMTXT,.XMI) ;Distribution List Domain:
"RTN","XMXADDR4",86,0)
 . I $D(^TMP("XM",$J,"GRPERR",XMGIEN,"C")) D GRPTXT(XMGIEN,"C",39087,.XMTXT,.XMI) ;Circular Group Reference:
"RTN","XMXADDR4",87,0)
 . S XMTO(XMDUZ)=""  ; Person sending the message
"RTN","XMXADDR4",88,0)
 . D GRPADDR(XMG,.XMTO)
"RTN","XMXADDR4",89,0)
 . I XMG'=XMGIEN D GRPADDR(XMGIEN,.XMTO)
"RTN","XMXADDR4",90,0)
 . D TASKBULL^XMXBULL(XMDUZ,"XM GROUP ERROR",.XMPARM,"XMTXT",.XMTO,.XMINSTR)
"RTN","XMXADDR4",91,0)
 Q
"RTN","XMXADDR4",92,0)
GRPTXT(XMGIEN,XMTYPE,XMPROB,XMTXT,XMI) ;
"RTN","XMXADDR4",93,0)
 N XMNAME
"RTN","XMXADDR4",94,0)
 S XMNAME=""
"RTN","XMXADDR4",95,0)
 F  S XMNAME=$O(^TMP("XM",$J,"GRPERR",XMGIEN,XMTYPE,XMNAME)) Q:XMNAME=""  D
"RTN","XMXADDR4",96,0)
 . S XMI=XMI+1,XMTXT(XMI)=""
"RTN","XMXADDR4",97,0)
 . S XMI=XMI+1,XMTXT(XMI)=$$EZBLD^DIALOG(XMPROB)_XMNAME
"RTN","XMXADDR4",98,0)
 . S XMI=XMI+1,XMTXT(XMI)=$$EZBLD^DIALOG(39088)_^TMP("XM",$J,"GRPERR",XMGIEN,XMTYPE,XMNAME) ;Error:
"RTN","XMXADDR4",99,0)
 Q
"RTN","XMXADDR4",100,0)
GRPADDR(XMGIEN,XMTO) ;
"RTN","XMXADDR4",101,0)
 N I
"RTN","XMXADDR4",102,0)
 S I=$P($G(^XMB(3.8,XMGIEN,3)),U,1) S:I XMTO(I)="" ; Organizer
"RTN","XMXADDR4",103,0)
 S I=$P($G(^XMB(3.8,XMGIEN,0)),U,7) S:I XMTO(I)="" ; Coordinator
"RTN","XMXADDR4",104,0)
 Q:'$D(^XMB(3.8,XMGIEN,4,"B"))
"RTN","XMXADDR4",105,0)
 S I=0
"RTN","XMXADDR4",106,0)
 F  S I=$O(^XMB(3.8,XMGIEN,4,"B",I)) Q:'I  D
"RTN","XMXADDR4",107,0)
 . S XMTO(I)="" ; Authorized sender
"RTN","XMXADDR4",108,0)
 Q
"RTN","XMXADDR4",109,0)
SETERR(XMIA,XMFORMAT,XMDIALOG,XMP1,XMP2,XMP3) ;
"RTN","XMXADDR4",110,0)
 S XMERROR=XMDIALOG
"RTN","XMXADDR4",111,0)
 I $D(XMP1) S XMERROR(1)=XMP1
"RTN","XMXADDR4",112,0)
 I $D(XMP2) S XMERROR(2)=XMP2
"RTN","XMXADDR4",113,0)
 I $D(XMP3) S XMERROR(3)=XMP3
"RTN","XMXADDR4",114,0)
 I XMIA D WRIERR(XMFORMAT)
"RTN","XMXADDR4",115,0)
 Q
"RTN","XMXADDR4",116,0)
WRIERR(XMFORMAT) ;
"RTN","XMXADDR4",117,0)
 I XMFORMAT="" W $$GETERR Q
"RTN","XMXADDR4",118,0)
 I XMFORMAT'="P" D EN^DDIOL($$GETERR,"",XMFORMAT) Q
"RTN","XMXADDR4",119,0)
 N XMTEXT
"RTN","XMXADDR4",120,0)
 D BLD^DIALOG(XMERROR,.XMERROR,"","XMTEXT","F")
"RTN","XMXADDR4",121,0)
 D MSG^DIALOG("WE","","","","XMTEXT")
"RTN","XMXADDR4",122,0)
 Q
"RTN","XMXADDR4",123,0)
GETERR() ;
"RTN","XMXADDR4",124,0)
 Q $$EZBLD^DIALOG(XMERROR,.XMERROR)
"RTN","XMXADDRD")
0^359^B40495890
"RTN","XMXADDRD",1,0)
XMXADDRD ;ISC-SF/GMB-Lookup Domain Name ;04/24/2002  10:36
"RTN","XMXADDRD",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMXADDRD",3,0)
 ; Replaces PSP^XMA210,^XMA21A,^XMA21B (ISC-WASH/CAP)
"RTN","XMXADDRD",4,0)
DNS(XMDUZ,XMDOMAIN,XMVIA,XMVIAN) ;
"RTN","XMXADDRD",5,0)
 ; XMDOMAIN - (in/out) Domain name.  May be mixed case.  Must already be
"RTN","XMXADDRD",6,0)
 ;            in xxx.xxx.xxx format.
"RTN","XMXADDRD",7,0)
 ; XMVIA    - (out) IEN of (relay) domain (in ^DIC(4.2))
"RTN","XMXADDRD",8,0)
 ; XMVIAN   - (out) Name of (relay) domain
"RTN","XMXADDRD",9,0)
 N XMVIAREC,XMNETNAM
"RTN","XMXADDRD",10,0)
 S XMNETNAM=^XMB("NETNAME")
"RTN","XMXADDRD",11,0)
 S XMDOMAIN=$$UP^XLFSTR(XMDOMAIN)
"RTN","XMXADDRD",12,0)
 I XMDOMAIN=XMNETNAM D  Q
"RTN","XMXADDRD",13,0)
 . S XMVIA=^XMB("NUM")
"RTN","XMXADDRD",14,0)
 . S XMVIAN=XMNETNAM
"RTN","XMXADDRD",15,0)
 D FINDDOMN
"RTN","XMXADDRD",16,0)
 Q:$D(XMERROR)
"RTN","XMXADDRD",17,0)
 I XMVIAN="VA.GOV",$$FORUM D  Q
"RTN","XMXADDRD",18,0)
 . D SETERR^XMXADDR4($G(XMIA),"!",39100,XMDOMAIN) ;Domain not found: |1|
"RTN","XMXADDRD",19,0)
 I $G(XMIA) D
"RTN","XMXADDRD",20,0)
 . W:XMDOMAIN'=XMVIAN $$EZBLD^DIALOG(39101,XMVIAN) ;via |1|
"RTN","XMXADDRD",21,0)
 . I XMVIAN'=XMNETNAM,$P(XMVIAREC,U,2)'["S" W $$EZBLD^DIALOG(39102) ; queued
"RTN","XMXADDRD",22,0)
 Q
"RTN","XMXADDRD",23,0)
FORUM() ; Is this FORUM or GATEWAY?
"RTN","XMXADDRD",24,0)
 Q $S($G(XMNETNAM,^XMB("NETNAME"))'["FORUM.":0,1:1)
"RTN","XMXADDRD",25,0)
FINDDOMN ; Look up domain
"RTN","XMXADDRD",26,0)
 N XMSUBDOM,XMFLAGS,DIC,X,Y,XMDCIRCL
"RTN","XMXADDRD",27,0)
 S XMSUBDOM="",X=XMDOMAIN
"RTN","XMXADDRD",28,0)
 ;S XMFLAGS="ZMF"_$S('$G(XMIA):"O",$G(XMINSTR("EXACT")):"OE",$D(XMGCIRCL):"OE",1:"E")
"RTN","XMXADDRD",29,0)
 S XMFLAGS="ZMF"_$S($G(XMINSTR("EXACT")):"X",'$G(XMIA):"O",$D(XMGCIRCL):"O",1:"")_$S($G(XMIA):"E",1:"")
"RTN","XMXADDRD",30,0)
 S DIC="^DIC(4.2,",DIC(0)=XMFLAGS
"RTN","XMXADDRD",31,0)
 F  S D="B^C" D MIX^DIC1 Q:Y>0!(X'[".")!$D(DUOUT)!$D(DTOUT)  D  Q:X=XMNETNAM
"RTN","XMXADDRD",32,0)
 . S XMSUBDOM=XMSUBDOM_$P(X,".")_"."
"RTN","XMXADDRD",33,0)
 . S X=$P(X,".",2,999)
"RTN","XMXADDRD",34,0)
 I Y'>0,X'[".",'$G(XMIA),$L(X)<4 S DIC(0)="ZFX",D="C" D IX^DIC  ; Look for COM,MIL,NET,etc. as synonym for one of the domains.
"RTN","XMXADDRD",35,0)
 I Y>0 D  Q   ; Domain successfully found
"RTN","XMXADDRD",36,0)
 . I XMSUBDOM'="" D  Q:$D(XMERROR)
"RTN","XMXADDRD",37,0)
 . . D CHKDOM($E(XMSUBDOM,1,$L(XMSUBDOM)-1)) Q:$D(XMERROR)
"RTN","XMXADDRD",38,0)
 . . Q:Y(0,0)'=XMNETNAM
"RTN","XMXADDRD",39,0)
 . . D SETERR^XMXADDR4($G(XMIA),"!",39103,$E(XMSUBDOM,1,$L(XMSUBDOM)-1),X) ; Sub-domain '|1|' not found for domain '|2|'
"RTN","XMXADDRD",40,0)
 . I XMSUBDOM="",X'[".",$L(X)<4,$$FIND1^DIC(4.2996,"","QX",X) D NEEDSUB(X) Q
"RTN","XMXADDRD",41,0)
 . S XMDOMAIN=$S(XMSUBDOM="":Y(0,0),1:XMSUBDOM_X) ; MailMan's klugey way
"RTN","XMXADDRD",42,0)
 . ;S XMDOMAIN=XMSUBDOM_X ; Proper way?  Nope.
"RTN","XMXADDRD",43,0)
 . S XMVIA=+Y
"RTN","XMXADDRD",44,0)
 . S XMVIAREC=Y(0)
"RTN","XMXADDRD",45,0)
 . D VIA(.XMVIA,.XMVIAREC,.XMVIAN,.XMDCIRCL)
"RTN","XMXADDRD",46,0)
 I '$G(XMIA),X'=XMNETNAM D  Q:$D(XMERROR)
"RTN","XMXADDRD",47,0)
 . N Y,X
"RTN","XMXADDRD",48,0)
 . S X=XMDOMAIN
"RTN","XMXADDRD",49,0)
 . F  S Y=$$FIND1^DIC(4.2,"","MOQ",X,"B^C") Q:Y>0!$D(DIERR)!(X'[".")  D
"RTN","XMXADDRD",50,0)
 . . S X=$P(X,".",2,999)
"RTN","XMXADDRD",51,0)
 . Q:Y!'$D(DIERR)  ; (Y should never be >0, because we didn't find it before.)
"RTN","XMXADDRD",52,0)
 . I X'[".",$$FIND1^DIC(4.2996,"","QX",X) Q
"RTN","XMXADDRD",53,0)
 . D SETERR^XMXADDR4(0,"",39106,X) ;Domain ambiguous: |1|
"RTN","XMXADDRD",54,0)
 I $D(DTOUT)!$D(DUOUT) D  Q
"RTN","XMXADDRD",55,0)
 . ;up-arrow out. / time out.
"RTN","XMXADDRD",56,0)
 . D SETERR^XMXADDR4(1,"!",$S($D(DUOUT):37000,1:37001))
"RTN","XMXADDRD",57,0)
 I X'["." D  Q  ; Domain not found, look in internet suffix file
"RTN","XMXADDRD",58,0)
 . D LOOKSFX Q:$D(XMERROR)
"RTN","XMXADDRD",59,0)
 . I X=XMDOMAIN D NEEDSUB(X) Q
"RTN","XMXADDRD",60,0)
 . D CHKDOM($E(XMSUBDOM,1,$L(XMSUBDOM)-1))
"RTN","XMXADDRD",61,0)
 I X=XMNETNAM D  Q  ;Sub-domain '|1|' not found for domain '|2|'
"RTN","XMXADDRD",62,0)
 . D SETERR^XMXADDR4($G(XMIA),"!",39103,$E(XMSUBDOM,1,$L(XMSUBDOM)-1),X)
"RTN","XMXADDRD",63,0)
 Q
"RTN","XMXADDRD",64,0)
NEEDSUB(X) ;
"RTN","XMXADDRD",65,0)
 D SETERR^XMXADDR4(0,"",39104,X) ;Valid domain, but need subdomain: |1|
"RTN","XMXADDRD",66,0)
 Q:'$G(XMIA)
"RTN","XMXADDRD",67,0)
 ;Domain |1| is a valid Internet domain,
"RTN","XMXADDRD",68,0)
 ;but you must specify at least one sub-domain.
"RTN","XMXADDRD",69,0)
 N XMTEXT
"RTN","XMXADDRD",70,0)
 D BLD^DIALOG(39105,X,"","XMTEXT","F")
"RTN","XMXADDRD",71,0)
 D MSG^DIALOG("WE","","","","XMTEXT")
"RTN","XMXADDRD",72,0)
 Q
"RTN","XMXADDRD",73,0)
VIA(XMVIA,XMVIAREC,XMVIAN,XMDCIRCL) ;
"RTN","XMXADDRD",74,0)
 S XMVIAN=$P(XMVIAREC,U,1)
"RTN","XMXADDRD",75,0)
 Q:XMVIAN=XMNETNAM
"RTN","XMXADDRD",76,0)
 D CHKPRMIT(XMDUZ,XMVIAREC) Q:$D(XMERROR)
"RTN","XMXADDRD",77,0)
 I $D(XMDCIRCL(XMVIA)) D  Q
"RTN","XMXADDRD",78,0)
 . I $G(XMIA) D EN^DDIOL($$EZBLD^DIALOG(39088)) ;Error:
"RTN","XMXADDRD",79,0)
 . ;Circular relay domain: |1|
"RTN","XMXADDRD",80,0)
 . D SETERR^XMXADDR4($G(XMIA),"",39107,XMVIAN)
"RTN","XMXADDRD",81,0)
 I $P(XMVIAREC,U,3) D  Q  ; If there's a relay domain, follow it.
"RTN","XMXADDRD",82,0)
 . S XMDCIRCL(XMVIA)=""
"RTN","XMXADDRD",83,0)
 . S XMVIA=$P(XMVIAREC,U,3),XMVIAREC=$G(^DIC(4.2,XMVIA,0))
"RTN","XMXADDRD",84,0)
 . D VIA(.XMVIA,.XMVIAREC,.XMVIAN,.XMDCIRCL)
"RTN","XMXADDRD",85,0)
 Q:$P(XMVIAREC,U,2)'["S"
"RTN","XMXADDRD",86,0)
 Q:$O(^DIC(4.2,XMVIA,1,0))  ; Domain has script(s).
"RTN","XMXADDRD",87,0)
 Q:$L(XMVIAN)+1=$F(XMVIAN,XMNETNAM)  ; Subdomain of this domain.
"RTN","XMXADDRD",88,0)
 N Y
"RTN","XMXADDRD",89,0)
 I $L(XMVIAN,".")>3 D  I Y,$P(^DIC(4.2,+Y,0),U,1)=XMNETNAM Q  ; Subdomain of this domain.
"RTN","XMXADDRD",90,0)
 . N X
"RTN","XMXADDRD",91,0)
 . S X=$P(XMVIAN,".",2,999)
"RTN","XMXADDRD",92,0)
 . F  S Y=$$FIND1^DIC(4.2,"","QX",X,"C") Q:Y!($L(X,".")<3)  D
"RTN","XMXADDRD",93,0)
 . . S X=$P(X,".",2,999)
"RTN","XMXADDRD",94,0)
 ; No script, so send to parent domain, if there is one,
"RTN","XMXADDRD",95,0)
 ; and if the parent isn't the same as this domain.
"RTN","XMXADDRD",96,0)
 Q:'$G(^XMB("PARENT"))
"RTN","XMXADDRD",97,0)
 Q:'$G(^XMB("NUM"))
"RTN","XMXADDRD",98,0)
 Q:^XMB("PARENT")=^XMB("NUM")
"RTN","XMXADDRD",99,0)
 Q:'$D(^DIC(4.2,^XMB("PARENT"),0))
"RTN","XMXADDRD",100,0)
 S XMVIA=^XMB("PARENT")
"RTN","XMXADDRD",101,0)
 S XMVIAREC=^DIC(4.2,XMVIA,0)
"RTN","XMXADDRD",102,0)
 S XMVIAN=$P(XMVIAREC,U,1)
"RTN","XMXADDRD",103,0)
 Q
"RTN","XMXADDRD",104,0)
CHKDOM(XMDOM,XMMAXDOM,XMMAXDOT) ;
"RTN","XMXADDRD",105,0)
 N I,XMSUBDOM
"RTN","XMXADDRD",106,0)
 I $TR(XMDOM,".-","")'?.AN D  Q
"RTN","XMXADDRD",107,0)
 . ;Domain may not contain punctuation other than '.' or '-'.
"RTN","XMXADDRD",108,0)
 . D SETERR^XMXADDR4($G(XMIA),"!",39108)
"RTN","XMXADDRD",109,0)
 I '$D(XMMAXDOM) S XMMAXDOM=255
"RTN","XMXADDRD",110,0)
 I $L(XMDOM)>XMMAXDOM D  Q
"RTN","XMXADDRD",111,0)
 . ;Domain must be from 1 to |1| characters.
"RTN","XMXADDRD",112,0)
 . D SETERR^XMXADDR4($G(XMIA),"!",39109,XMMAXDOM)
"RTN","XMXADDRD",113,0)
 I '$D(XMMAXDOT) S XMMAXDOT=63
"RTN","XMXADDRD",114,0)
 F I=1:1:$L(XMDOM,".") D  Q:$D(XMERROR)
"RTN","XMXADDRD",115,0)
 . S XMSUBDOM=$P(XMDOM,".",I)
"RTN","XMXADDRD",116,0)
 . I XMSUBDOM?1AN.E,$L(XMSUBDOM)'>XMMAXDOT Q
"RTN","XMXADDRD",117,0)
 . ; 39110 - Domain dot pieces must be from 1 to |1| characters.
"RTN","XMXADDRD",118,0)
 . ; 39111 - Domain dot pieces must begin with a letter or number.
"RTN","XMXADDRD",119,0)
 . D SETERR^XMXADDR4($G(XMIA),"!",$S($L(XMSUBDOM,I)>XMMAXDOT:39110,1:39111),XMMAXDOT)
"RTN","XMXADDRD",120,0)
 . Q:'$G(XMIA)
"RTN","XMXADDRD",121,0)
 . D EN^DDIOL($$EZBLD^DIALOG(39112,XMSUBDOM)) ;|1| is not valid.
"RTN","XMXADDRD",122,0)
 Q
"RTN","XMXADDRD",123,0)
LOOKSFX ; Look for top level domain in internet suffix file
"RTN","XMXADDRD",124,0)
 ; Instead of looking in the file, we could call the COTS DNS, if it exists.
"RTN","XMXADDRD",125,0)
 N DIC,Y
"RTN","XMXADDRD",126,0)
 I $G(XMIA) D
"RTN","XMXADDRD",127,0)
 . D EN^DDIOL($$EZBLD^DIALOG(39113)) ;Looking in Internet Suffix file...
"RTN","XMXADDRD",128,0)
 . S DIC(0)=$TR(XMFLAGS,"O")_"X"
"RTN","XMXADDRD",129,0)
 E  S DIC(0)="X"
"RTN","XMXADDRD",130,0)
 S DIC="^DIC(4.2996,"
"RTN","XMXADDRD",131,0)
 S:$G(XMIA) DIC("W")="W ""  "",$P(^(0),U,2)"  ; high-level domain purpose/country
"RTN","XMXADDRD",132,0)
 D ^DIC
"RTN","XMXADDRD",133,0)
 I Y>0 D  Q:XMVIA
"RTN","XMXADDRD",134,0)
 . S XMVIA=$G(^XMB("PARENT"))
"RTN","XMXADDRD",135,0)
 . I 'XMVIA S XMVIA=$$FIND1^DIC(4.2,"","MQX",$S($$FORUM:"GK.VA.GOV",1:"FORUM.VA.GOV"),"B^C") Q:'XMVIA
"RTN","XMXADDRD",136,0)
 . S XMVIAREC=^DIC(4.2,XMVIA,0)
"RTN","XMXADDRD",137,0)
 . S XMVIAN=$P(XMVIAREC,U)
"RTN","XMXADDRD",138,0)
 D SETERR^XMXADDR4($G(XMIA),"!",39100,X) ;Domain not found: |1|
"RTN","XMXADDRD",139,0)
 Q
"RTN","XMXADDRD",140,0)
CHKPRMIT(XMDUZ,XMVIAREC) ;
"RTN","XMXADDRD",141,0)
 I $G(XMINSTR("ADDR FLAGS"))["R",'$D(XMRESTR("NET RECEIVE")) Q
"RTN","XMXADDRD",142,0)
 I $P(XMVIAREC,U,2)["C",$P(XMVIAREC,U,2)'["S" D  Q  ;Domain closed: |1|
"RTN","XMXADDRD",143,0)
 . D SETERR^XMXADDR4($G(XMIA),"!",39114,$P(XMVIAREC,U,1))
"RTN","XMXADDRD",144,0)
 Q:$G(XMINSTR("ADDR FLAGS"))["R"
"RTN","XMXADDRD",145,0)
 I $P(XMVIAREC,U,11)'="",'$D(^XUSEC($P(XMVIAREC,U,11),XMDUZ)) D  Q
"RTN","XMXADDRD",146,0)
 . ;You don't hold key to domain '|1|'.
"RTN","XMXADDRD",147,0)
 . D SETERR^XMXADDR4($G(XMIA),"!",39115,$P(XMVIAREC,U,1))
"RTN","XMXADDRD",148,0)
 ; Maybe the following belongs in XMFWD^XMVVITAE:
"RTN","XMXADDRD",149,0)
 ;I $P(XMVIAREC,U,2)["N" D  Q
"RTN","XMXADDRD",150,0)
 ;. D SETERR^XMXADDR4($G(XMIA),"!",XXXXX,$P(XMVIAREC,U,1)) ; No forwarding to domain '|1|'.
"RTN","XMXADDRD",151,0)
 Q
"RTN","XMXADDRD",152,0)
CHKNAME ; Input transform for .01 field of DOMAIN file 4.2
"RTN","XMXADDRD",153,0)
 N XMIA,XMERROR,I
"RTN","XMXADDRD",154,0)
 S XMIA=0
"RTN","XMXADDRD",155,0)
 S X=$$UP^XLFSTR(X)
"RTN","XMXADDRD",156,0)
 D CHKDOM(X,64,20)
"RTN","XMXADDRD",157,0)
 I $D(XMERROR) D  Q
"RTN","XMXADDRD",158,0)
 . D WRIERR^XMXADDR4("!,$C(7)")
"RTN","XMXADDRD",159,0)
 . K X
"RTN","XMXADDRD",160,0)
 Q:$D(DIFROM)
"RTN","XMXADDRD",161,0)
 F I=1:1:$L(X,".")-1 D  Q:'$D(X)
"RTN","XMXADDRD",162,0)
 . Q:'$D(^DIC(4.2996,"B",$P(X,".",I),0))
"RTN","XMXADDRD",163,0)
 . D EN^DDIOL($$EZBLD^DIALOG(39116),"","!,$C(7)")
"RTN","XMXADDRD",164,0)
 . K X ;Domain dot pieces must not match Internet reserved domain names.
"RTN","XMXADDRD",165,0)
 Q
"RTN","XMXADDRG")
0^360^B70083077
"RTN","XMXADDRG",1,0)
XMXADDRG ;ISC-SF/GMB-Expand group ;04/17/2002  14:06
"RTN","XMXADDRG",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMXADDRG",3,0)
 ; Replaces ^XMA21G (ISC-WASH/CAP)
"RTN","XMXADDRG",4,0)
EXPAND(XMDUZ,XMADDR,XMSTRIKE,XMPREFIX,XMLATER,XMFULL,XMG) ;
"RTN","XMXADDRG",5,0)
 ; XMG      IEN of group in ^XMB(3.8)
"RTN","XMXADDRG",6,0)
 ; XMGN     Name of group
"RTN","XMXADDRG",7,0)
 ; XMGPRIV  Restrictions on use of group
"RTN","XMXADDRG",8,0)
 ; XMGMREC  Group member's ^XMB(3.7,x,0 record
"RTN","XMXADDRG",9,0)
 ; XMGCIRCL Array used to guard against circular references
"RTN","XMXADDRG",10,0)
 N XMGREC,XMGN,XMGPRIV,XMSCREEN,XMGCIRCL,XMIASAVE,XMGMBRS
"RTN","XMXADDRG",11,0)
 I $D(XMRESTR("NOFPG")) D  Q  ;Must be sender or hold XM GROUP PRIORITY
"RTN","XMXADDRG",12,0)
 . ;key to forward priority mail to groups.
"RTN","XMXADDRG",13,0)
 . D SETERR^XMXADDR4($G(XMIA),"!",39130)
"RTN","XMXADDRG",14,0)
 S XMADDR=$E(XMADDR,3,999)
"RTN","XMXADDRG",15,0)
 ; Screen:  Group is public OR user is organizer
"RTN","XMXADDRG",16,0)
 ;          OR group is unrestricted and user is member
"RTN","XMXADDRG",17,0)
 S XMSCREEN="N XMR S XMR=^(0) I $S($P(XMR,U,2)=""PU"":1,$P($G(^XMB(3.8,+Y,3),.5),U)=XMDUZ:1,+$P(XMR,U,6):0,$D(^XMB(3.8,+Y,1,""B"",XMDUZ)):1,1:0)"
"RTN","XMXADDRG",18,0)
 I $G(XMIA) D  Q:$D(XMERROR)
"RTN","XMXADDRG",19,0)
 . N DIC,X
"RTN","XMXADDRG",20,0)
 . S X=XMADDR
"RTN","XMXADDRG",21,0)
 . S DIC("S")=XMSCREEN
"RTN","XMXADDRG",22,0)
 . S DIC="^XMB(3.8,"
"RTN","XMXADDRG",23,0)
 . S DIC(0)="MEZ"
"RTN","XMXADDRG",24,0)
 . D ^DIC
"RTN","XMXADDRG",25,0)
 . I Y<0 D SETERR^XMXADDR4(XMADDR'="?","",39002) Q  ;Not found.
"RTN","XMXADDRG",26,0)
 . S XMG=+Y
"RTN","XMXADDRG",27,0)
 . S XMGN=$P(Y,U,2)
"RTN","XMXADDRG",28,0)
 . S XMGREC=Y(0)
"RTN","XMXADDRG",29,0)
 E  D  Q:$D(XMERROR)
"RTN","XMXADDRG",30,0)
 . S XMG=$$FIND1^DIC(3.8,"","MO",XMADDR,"",XMSCREEN) I 'XMG D SETERR^XMXADDR4(0,"",$S($D(DIERR):39131,1:39132)) Q  ; Mail group ambiguous. / Mail group not found.
"RTN","XMXADDRG",31,0)
 . S XMGREC=^XMB(3.8,XMG,0)
"RTN","XMXADDRG",32,0)
 . S XMGN=$P(XMGREC,U)
"RTN","XMXADDRG",33,0)
 I $D(^XMB(3.8,XMG,4,"B")),'$D(^("B",XMDUZ))!$D(XMRESTR("NET RECEIVE")) D  Q
"RTN","XMXADDRG",34,0)
 . ; If the group has authorized senders, then the sender must be local.
"RTN","XMXADDRG",35,0)
 . ; Incoming network mail may not address such a group.
"RTN","XMXADDRG",36,0)
 . D SETERR^XMXADDR4(0,"",39133) ;Sender not authorized to group.
"RTN","XMXADDRG",37,0)
 . Q:'$G(XMIA)
"RTN","XMXADDRG",38,0)
 . N XMABORT,XMTEXT
"RTN","XMXADDRG",39,0)
 . S XMABORT=0
"RTN","XMXADDRG",40,0)
 . W @IOF
"RTN","XMXADDRG",41,0)
 . ;You may not send mail directly to this group.
"RTN","XMXADDRG",42,0)
 . ;You must send it to an authorized sender for the group.
"RTN","XMXADDRG",43,0)
 . D BLD^DIALOG(39134,"","","XMTEXT","F")
"RTN","XMXADDRG",44,0)
 . D MSG^DIALOG("WE","","","","XMTEXT")
"RTN","XMXADDRG",45,0)
 . D AUTHSEND^XMHIG(XMG,XMABORT)
"RTN","XMXADDRG",46,0)
 S XMGPRIV=$P(XMGREC,U,6)
"RTN","XMXADDRG",47,0)
 S XMFULL="G."_XMGN_$S($G(XMINSTR("ADDR FLAGS"))["Y":"",XMGPRIV:$$EZBLD^DIALOG(39135),1:"") ;[Private Mail Group]
"RTN","XMXADDRG",48,0)
 I $G(XMINSTR("ADDR FLAGS"))["X" Q
"RTN","XMXADDRG",49,0)
 I XMSTRIKE Q:$D(^TMP("XMY0",$J,XMFULL,"L"))  W:$G(XMIA) $$EZBLD^DIALOG(39136) ;Deleting Members ...
"RTN","XMXADDRG",50,0)
 I $G(XMIA),'XMSTRIKE D  Q:$D(XMERROR)
"RTN","XMXADDRG",51,0)
 . I XMLATER="",$G(XMBIGGRP),$$BIG(XMG) D LATERIT(XMFULL,.XMLATER)
"RTN","XMXADDRG",52,0)
 . I XMLATER="?" D QLATER^XMXADDR(XMFULL,.XMLATER)
"RTN","XMXADDRG",53,0)
 I XMLATER,'$G(XMIA) Q
"RTN","XMXADDRG",54,0)
 I $D(XMIA) S XMIASAVE=XMIA
"RTN","XMXADDRG",55,0)
 I $D(^TMP("XM",$J,"GRPERR")) K ^TMP("XM",$J,"GRPERR")
"RTN","XMXADDRG",56,0)
 D EXPGROUP(XMDUZ,XMG,XMGREC,XMSTRIKE,XMPREFIX,XMLATER,.XMGCIRCL)
"RTN","XMXADDRG",57,0)
 I '$G(XMGMBRS),'XMLATER D
"RTN","XMXADDRG",58,0)
 . D SETERR^XMXADDR4($G(XMIA),"",39137) ;Mail group has no members
"RTN","XMXADDRG",59,0)
 I $D(^TMP("XM",$J,"GRPERR")) D
"RTN","XMXADDRG",60,0)
 . D GRPERR^XMXADDR4(XMDUZ,XMG,XMGN)
"RTN","XMXADDRG",61,0)
 . K ^TMP("XM",$J,"GRPERR")
"RTN","XMXADDRG",62,0)
 K XMIA
"RTN","XMXADDRG",63,0)
 I $D(XMIASAVE) S XMIA=XMIASAVE
"RTN","XMXADDRG",64,0)
 Q
"RTN","XMXADDRG",65,0)
BIG(XMIEN) ; Function returns 1 if big group, 0 if not
"RTN","XMXADDRG",66,0)
 Q:$D(^XMB(3.8,XMIEN,5,"B")) 1  ; has member groups
"RTN","XMXADDRG",67,0)
 Q:$D(^XMB(3.8,XMIEN,7,"B")) 1  ; has distribution list
"RTN","XMXADDRG",68,0)
 ;Q:$D(^XMB(3.8,XMIEN,9,"B")) 1  ; has fax groups
"RTN","XMXADDRG",69,0)
 N XMCNT,XMNODE
"RTN","XMXADDRG",70,0)
 S XMCNT=0
"RTN","XMXADDRG",71,0)
 F XMNODE=1,6,8 D  ; local, remote, & fax members
"RTN","XMXADDRG",72,0)
 . Q:'$D(^XMB(3.8,XMIEN,XMNODE,0))
"RTN","XMXADDRG",73,0)
 . S XMCNT=XMCNT+$P($G(^XMB(3.8,XMIEN,XMNODE,0)),U,4)
"RTN","XMXADDRG",74,0)
 Q XMCNT'<XMBIGGRP
"RTN","XMXADDRG",75,0)
LATERIT(XMFULL,XMLATER) ;
"RTN","XMXADDRG",76,0)
 N DIR,X,Y,DIRUT
"RTN","XMXADDRG",77,0)
 ;This group seems to be fairly big.  If you don't need to 'minus'
"RTN","XMXADDRG",78,0)
 ;anyone from it, then you can save some time by queuing it for 'Later'
"RTN","XMXADDRG",79,0)
 ;delivery.  Would you like to queue this group for later delivery
"RTN","XMXADDRG",80,0)
 D BLD^DIALOG(39138,"","","DIR(""A"")")
"RTN","XMXADDRG",81,0)
 S DIR(0)="Y"
"RTN","XMXADDRG",82,0)
 S DIR("B")=$$EZBLD^DIALOG(39053) ;No
"RTN","XMXADDRG",83,0)
 ;Answer NO if
"RTN","XMXADDRG",84,0)
 ; - You need to delete any group members from the message.
"RTN","XMXADDRG",85,0)
 ;Answer YES if
"RTN","XMXADDRG",86,0)
 ; - You don't need to delete any group members from the message
"RTN","XMXADDRG",87,0)
 ; - and you'd like to save a bit of time.
"RTN","XMXADDRG",88,0)
 D BLD^DIALOG(39139,"","","DIR(""?"")")
"RTN","XMXADDRG",89,0)
 D ^DIR I $D(DIRUT) D  Q
"RTN","XMXADDRG",90,0)
 . D SETERR^XMXADDR4(0,"",37002) ;up-arrow or time out.
"RTN","XMXADDRG",91,0)
 . D EN^DDIOL(XMFULL_$$EZBLD^DIALOG(39015)) ;removed from recipient list.
"RTN","XMXADDRG",92,0)
 Q:'Y
"RTN","XMXADDRG",93,0)
 S XMLATER="?"
"RTN","XMXADDRG",94,0)
 Q
"RTN","XMXADDRG",95,0)
EXPGROUP(XMDUZ,XMG,XMGREC,XMSTRIKE,XMPREFIX,XMLATER,XMGCIRCL) ;
"RTN","XMXADDRG",96,0)
 ;Q:'$$AUTHGRP(XMDUZ,XMG,XMGREC)
"RTN","XMXADDRG",97,0)
 S XMGCIRCL(XMG)=""
"RTN","XMXADDRG",98,0)
 S $P(^XMB(3.8,XMG,0),U,4,5)=$P(XMGREC,U,4)+1_U_DT ; # references to group^date last ref'd
"RTN","XMXADDRG",99,0)
 I $G(XMIA) D
"RTN","XMXADDRG",100,0)
 . W !
"RTN","XMXADDRG",101,0)
 . D DISPCNT(XMG,1,39141) ;Local
"RTN","XMXADDRG",102,0)
 . D DISPCNT(XMG,5,39142) ;Member Group(s)
"RTN","XMXADDRG",103,0)
 . D DISPCNT(XMG,6,39143) ;Remote
"RTN","XMXADDRG",104,0)
 . D DISPCNT(XMG,7,39144) ;Distribution List(s)
"RTN","XMXADDRG",105,0)
 . D DISPCNT(XMG,8,39145) ;Fax Recipient(s)
"RTN","XMXADDRG",106,0)
 . D DISPCNT(XMG,9,39146) ;Fax Group(s)
"RTN","XMXADDRG",107,0)
 . I $X>1 W ":",!
"RTN","XMXADDRG",108,0)
 D INDIV(XMDUZ,XMG,XMSTRIKE,XMPREFIX,XMLATER) I XMLATER,'$G(XMIA) K XMGCIRCL(XMG) Q
"RTN","XMXADDRG",109,0)
 D GROUP(XMDUZ,XMG,XMSTRIKE,XMPREFIX,XMLATER,.XMGCIRCL) I XMLATER,'$G(XMIA) K XMGCIRCL(XMG) Q
"RTN","XMXADDRG",110,0)
 D REMOTE(XMDUZ,XMG,XMSTRIKE,XMPREFIX,XMLATER) I XMLATER,'$G(XMIA) K XMGCIRCL(XMG) Q
"RTN","XMXADDRG",111,0)
 D DISTR^XMXADDR4(XMDUZ,XMG,XMSTRIKE,XMPREFIX,XMLATER) I XMLATER,'$G(XMIA) K XMGCIRCL(XMG) Q
"RTN","XMXADDRG",112,0)
 I $P(^XMB(1,1,0),U,19) D FAXGROUP^XMXADDR4(XMDUZ,XMG,XMSTRIKE,XMPREFIX,XMLATER) I XMLATER,'$G(XMIA) K XMGCIRCL(XMG) Q
"RTN","XMXADDRG",113,0)
 I $P(^XMB(1,1,0),U,19) D FAXINDIV^XMXADDR4(XMDUZ,XMG,XMSTRIKE,XMPREFIX,XMLATER) I XMLATER,'$G(XMIA) K XMGCIRCL(XMG) Q
"RTN","XMXADDRG",114,0)
 K XMGCIRCL(XMG)
"RTN","XMXADDRG",115,0)
 Q
"RTN","XMXADDRG",116,0)
DISPCNT(XMIEN,XMNODE,XMDESCR) ;
"RTN","XMXADDRG",117,0)
 N XMCNT
"RTN","XMXADDRG",118,0)
 S XMDESCR=$$EZBLD^DIALOG(XMDESCR)
"RTN","XMXADDRG",119,0)
 S XMCNT=$P($G(^XMB(3.8,XMIEN,XMNODE,0)),U,4) Q:'XMCNT
"RTN","XMXADDRG",120,0)
 I $X+3+$L(XMCNT)+$L(XMDESCR)>IOM W ",",!
"RTN","XMXADDRG",121,0)
 E  W:$X>4 ", "
"RTN","XMXADDRG",122,0)
 W XMCNT," ",XMDESCR
"RTN","XMXADDRG",123,0)
 Q
"RTN","XMXADDRG",124,0)
AUTHGRP(XMDUZ,XMG,XMGREC) ;
"RTN","XMXADDRG",125,0)
 ; Screen:  Group is public OR user is owner
"RTN","XMXADDRG",126,0)
 ;          OR group is unrestricted and user is member
"RTN","XMXADDRG",127,0)
 N XMOWNER
"RTN","XMXADDRG",128,0)
 I $P(XMGREC,U,2)="PU" Q 1  ; Group is public
"RTN","XMXADDRG",129,0)
 S XMOWNER=$P(^XMB(3.8,XMG,3),U,1) S:XMOWNER="" XMOWNER=.5
"RTN","XMXADDRG",130,0)
 I XMDUZ=XMOWNER Q 1  ; User is owner of group
"RTN","XMXADDRG",131,0)
 I +$P(XMGREC,U,6)=0,$D(^XMB(3.8,XMG,1,"B",XMDUZ)) Q 1  ; Group is unrestricted and user is a member
"RTN","XMXADDRG",132,0)
 D SETERR^XMXADDR4($G(XMIA),"!",39147,$P(XMGREC,U,1))
"RTN","XMXADDRG",133,0)
 Q 0  ;You may not access group '|1|'.
"RTN","XMXADDRG",134,0)
INDIV(XMDUZ,XMG,XMSTRIKE,XMPREFIX,XMLATER) ;
"RTN","XMXADDRG",135,0)
 ; XMGM     Group member
"RTN","XMXADDRG",136,0)
 N XMI,XMGM,XMCNT,XMREC,XMTYPE
"RTN","XMXADDRG",137,0)
 S XMI=0,XMCNT=0
"RTN","XMXADDRG",138,0)
 F  S XMI=$O(^XMB(3.8,XMG,1,XMI)) Q:'XMI  S XMREC=^(XMI,0) D  I XMLATER,'$G(XMIA) Q
"RTN","XMXADDRG",139,0)
 . S XMGM=$P(XMREC,U,1),XMTYPE=$P(XMREC,U,2)
"RTN","XMXADDRG",140,0)
 . ; If SHARED,MAIL or no mailbox, then delete from group.
"RTN","XMXADDRG",141,0)
 . I XMGM=.6!'$D(^XMB(3.7,XMGM))!'$D(^VA(200,XMGM,0)) D DELETE2^XMXADDR4(XMG,1,XMI) Q
"RTN","XMXADDRG",142,0)
 . N XMFULL,XMERROR,XMFWDADD
"RTN","XMXADDRG",143,0)
 . D PERSON^XMXADDR1(XMDUZ,XMGM,"","","","",.XMFULL)
"RTN","XMXADDRG",144,0)
 . I $D(XMERROR) D  Q
"RTN","XMXADDRG",145,0)
 . . ; Commenting out because I'm not sure it should be reported.
"RTN","XMXADDRG",146,0)
 . . ;S XMFULL=$P($G(^VA(200,XMGM,0)),U,1)
"RTN","XMXADDRG",147,0)
 . . ;I XMFULL="" S XMFULL="USER #"_XMGM
"RTN","XMXADDRG",148,0)
 . . ;S ^TMP("XM",$J,"GRPERR",XMG,"L",XMFULL)=XMERROR
"RTN","XMXADDRG",149,0)
 . S XMGMBRS=1
"RTN","XMXADDRG",150,0)
 . I 'XMLATER D INDIV^XMXADDR(XMDUZ,XMGM,XMSTRIKE,$S(XMPREFIX'="":XMPREFIX,1:XMTYPE),XMLATER)
"RTN","XMXADDRG",151,0)
 . Q:'$G(XMIA)
"RTN","XMXADDRG",152,0)
 . I XMCNT,XMCNT#16=0 D  Q:'$G(XMIA)
"RTN","XMXADDRG",153,0)
 . . N DIR,Y
"RTN","XMXADDRG",154,0)
 . . S DIR("A")=$$EZBLD^DIALOG(39148) ;Do you want to see more members
"RTN","XMXADDRG",155,0)
 . . S DIR(0)="Y",DIR("B")=$$EZBLD^DIALOG(39053) ;No
"RTN","XMXADDRG",156,0)
 . . D ^DIR
"RTN","XMXADDRG",157,0)
 . . S XMIA=+Y  ; The '+' takes care of $D(DIRUT)
"RTN","XMXADDRG",158,0)
 . S XMCNT=XMCNT+1
"RTN","XMXADDRG",159,0)
 . W:XMCNT#4-1=0 !
"RTN","XMXADDRG",160,0)
 . W ?XMCNT-1#4*20,$E($S(XMPREFIX'="":XMPREFIX_":",XMTYPE="":"",1:XMTYPE_":")_XMFULL,1,19)
"RTN","XMXADDRG",161,0)
 Q
"RTN","XMXADDRG",162,0)
GROUP(XMDUZ,XMG,XMSTRIKE,XMPREFIX,XMLATER,XMGCIRCL) ;
"RTN","XMXADDRG",163,0)
 N XMIEN,XMI,XMREC,XMTYPE
"RTN","XMXADDRG",164,0)
 S XMI=0
"RTN","XMXADDRG",165,0)
 F  S XMI=$O(^XMB(3.8,XMG,5,XMI)) Q:'XMI  S XMREC=^(XMI,0) D  I XMLATER,'$G(XMIA) Q
"RTN","XMXADDRG",166,0)
 . S XMIEN=$P(XMREC,U,1),XMTYPE=$P(XMREC,U,2)
"RTN","XMXADDRG",167,0)
 . I '$D(^XMB(3.8,XMIEN,0)) D DELETE2^XMXADDR4(XMG,5,XMI) Q
"RTN","XMXADDRG",168,0)
 . S XMREC=^XMB(3.8,XMIEN,0)
"RTN","XMXADDRG",169,0)
 . W:$G(XMIA) !,$S(XMPREFIX'="":"",XMTYPE="":"",1:XMTYPE_":"),"G.",$P(XMREC,U,1),":"
"RTN","XMXADDRG",170,0)
 . I $D(XMGCIRCL(XMIEN)) D  Q
"RTN","XMXADDRG",171,0)
 . . ; Circular (infinite loop) reference!  Don't go there!
"RTN","XMXADDRG",172,0)
 . . S ^TMP("XM",$J,"GRPERR",XMG,"C",$P(XMREC,U,1))="" Q
"RTN","XMXADDRG",173,0)
 . . Q:'$G(XMIASAVE)
"RTN","XMXADDRG",174,0)
 . . N XMTEXT
"RTN","XMXADDRG",175,0)
 . . ;Mail group contains circular reference to G.|1|.
"RTN","XMXADDRG",176,0)
 . . ;Circular reference ignored.
"RTN","XMXADDRG",177,0)
 . . ;This circular reference should be investigated and eliminated.
"RTN","XMXADDRG",178,0)
 . . D BLD^DIALOG(39140,$P(XMGREC,U,1),"","XMTEXT","F")
"RTN","XMXADDRG",179,0)
 . . D MSG^DIALOG("WE","","","","XMTEXT")
"RTN","XMXADDRG",180,0)
 . D EXPGROUP(XMDUZ,XMIEN,XMREC,XMSTRIKE,$S(XMPREFIX'="":XMPREFIX,1:XMTYPE),XMLATER,.XMGCIRCL)
"RTN","XMXADDRG",181,0)
 . W:$G(XMIA) !,$$EZBLD^DIALOG(39149,$P(XMREC,U,1)) ;Finished with group |1|.
"RTN","XMXADDRG",182,0)
 Q
"RTN","XMXADDRG",183,0)
REMOTE(XMDUZ,XMG,XMSTRIKE,XMPREFIX,XMLATER) ;
"RTN","XMXADDRG",184,0)
 N XMGM,XMI
"RTN","XMXADDRG",185,0)
 S XMI=0
"RTN","XMXADDRG",186,0)
 F  S XMI=$O(^XMB(3.8,XMG,6,XMI)) Q:XMI'>0  D  I XMLATER,'$G(XMIA) Q
"RTN","XMXADDRG",187,0)
 . S XMGM=$P(^XMB(3.8,XMG,6,XMI,0),U)
"RTN","XMXADDRG",188,0)
 . Q:XMGM=""  ; Really should delete it from the remotes.
"RTN","XMXADDRG",189,0)
 . W:$G(XMIA) !,XMGM
"RTN","XMXADDRG",190,0)
 . Q:XMLATER
"RTN","XMXADDRG",191,0)
 . D DOREMOTE(XMDUZ,XMGM,XMSTRIKE,XMPREFIX,XMLATER)
"RTN","XMXADDRG",192,0)
 Q
"RTN","XMXADDRG",193,0)
DOREMOTE(XMDUZ,XMGM,XMSTRIKE,XMPREFIX,XMLATER) ;
"RTN","XMXADDRG",194,0)
 N XMERROR
"RTN","XMXADDRG",195,0)
 I XMGM[":" D  Q:$D(XMERROR)
"RTN","XMXADDRG",196,0)
 . I XMPREFIX="" D
"RTN","XMXADDRG",197,0)
 . . D PREFIX^XMXADDR(.XMGM,.XMPREFIX)
"RTN","XMXADDRG",198,0)
 . E  D
"RTN","XMXADDRG",199,0)
 . . D PREFIX^XMXADDR(.XMGM)
"RTN","XMXADDRG",200,0)
 . I $D(XMERROR) S ^TMP("XM",$J,"GRPERR",XMG,"R",XMGM)=$$GETERR^XMXADDR4
"RTN","XMXADDRG",201,0)
 D REMOTE^XMXADDR3(XMDUZ,XMGM,XMSTRIKE,XMPREFIX,XMLATER)
"RTN","XMXADDRG",202,0)
 I '$D(XMERROR) S XMGMBRS=1 Q
"RTN","XMXADDRG",203,0)
 ;37000 - up-arrow out.
"RTN","XMXADDRG",204,0)
 ;37001 - time out.
"RTN","XMXADDRG",205,0)
 ;37002 - up-arrow or time out.
"RTN","XMXADDRG",206,0)
 ;39015.1 - Not a current recipient.
"RTN","XMXADDRG",207,0)
 ;39133 - Sender not authorized to group.
"RTN","XMXADDRG",208,0)
 I "^37000^37001^37002^39015.1^39133^"[(U_XMERROR_U) S XMGMBRS=1 Q
"RTN","XMXADDRG",209,0)
 S ^TMP("XM",$J,"GRPERR",XMG,"R",XMGM)=$$GETERR^XMXADDR4
"RTN","XMXADDRG",210,0)
 Q
"RTN","XMXANSER")
0^361^B6003785
"RTN","XMXANSER",1,0)
XMXANSER ;ISC-SF/GMB-Answer a msg ;04/24/2002  10:08
"RTN","XMXANSER",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMXANSER",3,0)
 ; Replaces ^XMA11A (ISC-WASH/CAP/THM)
"RTN","XMXANSER",4,0)
 ; XMDUZ             DUZ of who the msg is from
"RTN","XMXANSER",5,0)
 ; XMSUBJ            Subject of the msg (defaults to 'Re:' original subject)
"RTN","XMXANSER",6,0)
 ; XMBODY            Closed root of Body of the msg
"RTN","XMXANSER",7,0)
 ;                   Must be closed root, passed by value.  See WP_ROOT
"RTN","XMXANSER",8,0)
 ;                   definition for WP^DIE(), FM word processing filer.
"RTN","XMXANSER",9,0)
 ; XMTO              Additional addressees, besides msg originator
"RTN","XMXANSER",10,0)
 ; XMINSTR("FROM")   String saying from whom (default is user)
"RTN","XMXANSER",11,0)
 ; XMINSTR("SELF BSKT") Basket to deliver to if sender is recipient
"RTN","XMXANSER",12,0)
 ; XMINSTR("SHARE BSKT") Basket to deliver to if recipient is "SHARED,MAIL"
"RTN","XMXANSER",13,0)
 ; XMINSTR("SHARE DATE") Delete date if recipient is "SHARED,MAIL"
"RTN","XMXANSER",14,0)
 ; XMINSTR("RCPT BSKT") Basket name (only) to deliver to for other recipients
"RTN","XMXANSER",15,0)
 ; XMINSTR("VAPOR")  Date on which to vaporize (delete) this message
"RTN","XMXANSER",16,0)
 ;                   from recipient baskets
"RTN","XMXANSER",17,0)
 ; XMINSTR("LATER")  Date on which to send this msg, if not now
"RTN","XMXANSER",18,0)
 ; XMINSTR("FLAGS")  Any or all of the following:
"RTN","XMXANSER",19,0)
 ;                   P Priority
"RTN","XMXANSER",20,0)
 ;                   I Information only (may not be replied to)
"RTN","XMXANSER",21,0)
 ;                   X Closed msg (may not be forwarded)
"RTN","XMXANSER",22,0)
 ;                   C Confidential (surrogates may not read)
"RTN","XMXANSER",23,0)
 ;                   S Send to sender (make sender a recipient)
"RTN","XMXANSER",24,0)
 ;                   R Confirm receipt
"RTN","XMXANSER",25,0)
 ; XMINSTR("SCR KEY")   Scramble key (implies that msg should be scrambled)
"RTN","XMXANSER",26,0)
 ; XMINSTR("SCR HINT")  Hint (to guess the scramble key)
"RTN","XMXANSER",27,0)
 ; XMINSTR("KEYS")   List of keys needed by recipient to read msg (NOT IMPLEMENTED)
"RTN","XMXANSER",28,0)
 ; XMINSTR("TYPE")   Msg type is one of the following:
"RTN","XMXANSER",29,0)
 ;                   D Document
"RTN","XMXANSER",30,0)
 ;                   S Spooled Document
"RTN","XMXANSER",31,0)
 ;                   X DIFROM
"RTN","XMXANSER",32,0)
 ;                   O ODIF
"RTN","XMXANSER",33,0)
 ;                   B BLOB
"RTN","XMXANSER",34,0)
 ;                   K KIDS
"RTN","XMXANSER",35,0)
 ;
"RTN","XMXANSER",36,0)
 ; Output:
"RTN","XMXANSER",37,0)
 ; XMZR              The number of the message containing the answer.
"RTN","XMXANSER",38,0)
ANSRMSG(XMDUZ,XMK,XMKZ,XMSUBJ,XMBODY,XMTO,XMINSTR,XMZR) ;
"RTN","XMXANSER",39,0)
 N XMZ,XMZREC,XMZSENDR
"RTN","XMXANSER",40,0)
 K XMERR,^TMP("XMERR",$J)
"RTN","XMXANSER",41,0)
 D CHKMSG^XMXSEC1(XMDUZ,.XMK,.XMKZ,.XMZ,.XMZREC) Q:$D(XMERR)
"RTN","XMXANSER",42,0)
 Q:'$$ANSWER^XMXSEC(XMDUZ,XMZ,XMZREC)
"RTN","XMXANSER",43,0)
 S:$G(XMSUBJ)="" XMSUBJ=$E($$EZBLD^DIALOG(37006)_$P(XMZREC,U,1),1,65) ; Re:
"RTN","XMXANSER",44,0)
 D CRE8XMZ^XMXSEND(XMSUBJ,.XMZR) Q:$D(XMERR)
"RTN","XMXANSER",45,0)
 S XMZSENDR=$P(XMZREC,U,2)
"RTN","XMXANSER",46,0)
 S:XMZSENDR["@" XMZSENDR=$$REPLYTO1^XMXREPLY(XMZ)
"RTN","XMXANSER",47,0)
 D COMPOSE(XMDUZ,XMZ,$P(XMZREC,U,1),XMZSENDR,$P(XMZREC,U,3),XMZR,XMBODY)
"RTN","XMXANSER",48,0)
 S XMTO(XMZSENDR)=""
"RTN","XMXANSER",49,0)
 S XMINSTR("EXACT")=1 ; Match on exact domain name
"RTN","XMXANSER",50,0)
 D ADDRNSND^XMXSEND(XMDUZ,XMZR,.XMTO,.XMINSTR)
"RTN","XMXANSER",51,0)
 K XMINSTR("EXACT")
"RTN","XMXANSER",52,0)
 Q
"RTN","XMXANSER",53,0)
COMPOSE(XMDUZ,XMZ,XMZSUBJ,XMZSENDR,XMZDATE,XMZR,XMBODY) ;
"RTN","XMXANSER",54,0)
 D COPY(XMZ,XMZSUBJ,XMZSENDR,XMZDATE,XMZR)
"RTN","XMXANSER",55,0)
 ; File XMBODY, with the "append" option
"RTN","XMXANSER",56,0)
 D MOVEBODY^XMXSEND(XMZR,XMBODY,"A") ; Put the msg body in place
"RTN","XMXANSER",57,0)
 D NETSIG^XMXEDIT(XMDUZ,XMZR)
"RTN","XMXANSER",58,0)
 Q
"RTN","XMXANSER",59,0)
COPY(XMZO,XMZOSUBJ,XMZOFROM,XMZODATE,XMZ) ; Copy the original msg, putting ">" in front of each line.
"RTN","XMXANSER",60,0)
 N I,J
"RTN","XMXANSER",61,0)
 D COPYHEAD^XMJMC(XMZO,XMZOSUBJ,XMZOFROM,XMZODATE,XMZ,"A",.J)
"RTN","XMXANSER",62,0)
 S J=J+1,^XMB(3.9,XMZ,2,J,0)=">"
"RTN","XMXANSER",63,0)
 S I=.999999
"RTN","XMXANSER",64,0)
 F  S I=$O(^XMB(3.9,XMZO,2,I)) Q:I=""  S J=J+1,^XMB(3.9,XMZ,2,J,0)=$E(">"_^(I,0),1,254)
"RTN","XMXANSER",65,0)
 S J=J+1,^XMB(3.9,XMZ,2,J,0)=""
"RTN","XMXANSER",66,0)
 S J=J+1,^XMB(3.9,XMZ,2,J,0)=""
"RTN","XMXANSER",67,0)
 S ^XMB(3.9,XMZ,2,0)="^3.92A^"_J_U_J_U_DT
"RTN","XMXANSER",68,0)
 Q
"RTN","XMXAPI")
0^362^B39021968
"RTN","XMXAPI",1,0)
XMXAPI ;ISC-SF/GMB-Message APIs ;04/17/2002  14:06
"RTN","XMXAPI",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMXAPI",3,0)
 ; All entry points covered by DBIA 2729.
"RTN","XMXAPI",4,0)
 ; Variables input:
"RTN","XMXAPI",5,0)
 ; XMATTACH  Imaging system BLOB attachment array
"RTN","XMXAPI",6,0)
 ; XMBODY    Message text (MUST NOT BE "XMBODY")
"RTN","XMXAPI",7,0)
 ;              (must be closed root, passed by value.  See WP_ROOT
"RTN","XMXAPI",8,0)
 ;               definition for WP^DIE(), FM word processing filer)
"RTN","XMXAPI",9,0)
 ; XMDUZ     User's DUZ, or enough of user's name for a positive ID
"RTN","XMXAPI",10,0)
 ;              eg: 1301 or "lastname,firs"
"RTN","XMXAPI",11,0)
 ; XMK       Basket number, or enough of a name for a positive ID
"RTN","XMXAPI",12,0)
 ;              eg: 1 or "IN"
"RTN","XMXAPI",13,0)
 ; XMKZ      Message number in basket XMK
"RTN","XMXAPI",14,0)
 ;           OR
"RTN","XMXAPI",15,0)
 ;           if $G(XMK)="", Message number in ^XMB(3.9
"RTN","XMXAPI",16,0)
 ; XMKZA     Message number list or list array in basket XMK
"RTN","XMXAPI",17,0)
 ;              eg: "1,3,5-7" or ARRAY("1,3")=""
"RTN","XMXAPI",18,0)
 ;                               ARRAY("5-7")=""
"RTN","XMXAPI",19,0)
 ;              (list may end in comma)
"RTN","XMXAPI",20,0)
 ;              (ARRAY must be passed by reference)
"RTN","XMXAPI",21,0)
 ;           OR
"RTN","XMXAPI",22,0)
 ;           if $G(XMK)="", Message number list or list array in ^XMB(3.9
"RTN","XMXAPI",23,0)
 ;              (same rules, but number ranges are NOT allowed)
"RTN","XMXAPI",24,0)
 ; XMSUBJ    Message subject
"RTN","XMXAPI",25,0)
 ; XMTO      Addressee or addressee array
"RTN","XMXAPI",26,0)
 ;              (array must be passed by reference)
"RTN","XMXAPI",27,0)
 ;           User's DUZ, or enough of user's name for a positive ID
"RTN","XMXAPI",28,0)
 ;              eg: 1301 or "lastname,firs" or ARRAY(1301)=""
"RTN","XMXAPI",29,0)
 ;                                             ARRAY("lastname,firs")=""
"RTN","XMXAPI",30,0)
 ;           G.group name (enough for positive ID)
"RTN","XMXAPI",31,0)
 ;           S.server name (enough for positive ID)
"RTN","XMXAPI",32,0)
 ;           D.device name (enough for positive ID)
"RTN","XMXAPI",33,0)
 ;           prefix above (except devices and servers) by:
"RTN","XMXAPI",34,0)
 ;              I: for 'information only' recipient (may not reply)
"RTN","XMXAPI",35,0)
 ;                 eg: "I:1301" or "I:lastname,firs"
"RTN","XMXAPI",36,0)
 ;              C: for 'copy' recipient (not expected to reply)
"RTN","XMXAPI",37,0)
 ;                 eg: "C:1301" or "C:lastname,firs"
"RTN","XMXAPI",38,0)
 ;              L@datetime: for when (in future) to send to this recipient
"RTN","XMXAPI",39,0)
 ;                 (datetime may be anything accepted by FM)
"RTN","XMXAPI",40,0)
 ;                 eg: "L@25 DEC@0500:1301" or "L@1 JAN:lastname,firs"
"RTN","XMXAPI",41,0)
 ;                     or "L@2981225.05:1301"
"RTN","XMXAPI",42,0)
 ;              (may combine IL@datetime:  or  CL@datetime:)
"RTN","XMXAPI",43,0)
 ;           To delete recipient, prefix by -
"RTN","XMXAPI",44,0)
 ;                 eg: -1301 or "-lastname,firs"
"RTN","XMXAPI",45,0)
 ; XMZ       message number in ^XMB(3.9,
"RTN","XMXAPI",46,0)
 ;
"RTN","XMXAPI",47,0)
 ; Variables output (must be passed by reference):
"RTN","XMXAPI",48,0)
 ; XMFULL    expanded address of last addressee
"RTN","XMXAPI",49,0)
 ; XMMSG     simple message telling how many messages were acted on
"RTN","XMXAPI",50,0)
 ; XMZ       message number created in ^XMB(3.9,
"RTN","XMXAPI",51,0)
 ;
"RTN","XMXAPI",52,0)
 ; Errors
"RTN","XMXAPI",53,0)
 ; XMERR     if there's any errors, then XMERR is set to the number of
"RTN","XMXAPI",54,0)
 ;           errors, otherwise XMERR is undefined.
"RTN","XMXAPI",55,0)
 ;           ^TMP("XMERR",$J,error number,"TEXT",line number)=error text
"RTN","XMXAPI",56,0)
ANSRMSG(XMDUZ,XMK,XMKZ,XMSUBJ,XMBODY,XMTO,XMINSTR,XMZR) ; Answer a msg (Send new msg with copy of original msg inside)
"RTN","XMXAPI",57,0)
 ; In:  User, basket, msg #
"RTN","XMXAPI",58,0)
 ; Out: XMZR (message number of answer)
"RTN","XMXAPI",59,0)
 I '$D(XMV) N XMV,XMDISPI,XMDUN,XMNOSEND,XMPRIV
"RTN","XMXAPI",60,0)
 D ANSRMSG^XMXPARM(.XMDUZ,.XMK,.XMKZ,.XMSUBJ,.XMBODY,.XMTO,.XMINSTR) Q:$D(XMERR)
"RTN","XMXAPI",61,0)
 D ANSRMSG^XMXANSER(XMDUZ,.XMK,XMKZ,.XMSUBJ,XMBODY,.XMTO,.XMINSTR,.XMZR)
"RTN","XMXAPI",62,0)
 Q
"RTN","XMXAPI",63,0)
DELMSG(XMDUZ,XMK,XMKZA,XMMSG) ; Delete msgs from a basket
"RTN","XMXAPI",64,0)
 I '$D(XMV) N XMV,XMDISPI,XMDUN,XMNOSEND,XMPRIV
"RTN","XMXAPI",65,0)
 D ACTMSGS^XMXPARM(.XMDUZ,.XMK,.XMKZA) Q:$D(XMERR)
"RTN","XMXAPI",66,0)
 D DELMSG^XMXMSGS(XMDUZ,.XMK,.XMKZA,.XMMSG)
"RTN","XMXAPI",67,0)
 Q
"RTN","XMXAPI",68,0)
FLTRMSG(XMDUZ,XMK,XMKZA,XMMSG) ; Filters msgs in a basket
"RTN","XMXAPI",69,0)
 I '$D(XMV) N XMV,XMDISPI,XMDUN,XMNOSEND,XMPRIV
"RTN","XMXAPI",70,0)
 D ACTMSGS^XMXPARM(.XMDUZ,.XMK,.XMKZA) Q:$D(XMERR)
"RTN","XMXAPI",71,0)
 D FLTRMSG^XMXMSGS(XMDUZ,.XMK,.XMKZA,.XMMSG)
"RTN","XMXAPI",72,0)
 Q
"RTN","XMXAPI",73,0)
FWDMSG(XMDUZ,XMK,XMKZA,XMTO,XMINSTR,XMMSG) ; Forward msgs
"RTN","XMXAPI",74,0)
 ; XMINSTR("SHARE DATE")
"RTN","XMXAPI",75,0)
 ; XMINSTR("SHARE BSKT")
"RTN","XMXAPI",76,0)
 ; XMINSTR("SELF BSKT")
"RTN","XMXAPI",77,0)
 ; XMINSTR("FWD BY") substitute any string instead of XMDUZ name
"RTN","XMXAPI",78,0)
 I '$D(XMV) N XMV,XMDISPI,XMDUN,XMNOSEND,XMPRIV
"RTN","XMXAPI",79,0)
 D FWDMSG^XMXPARM(.XMDUZ,.XMK,.XMKZA,.XMTO,.XMINSTR) Q:$D(XMERR)
"RTN","XMXAPI",80,0)
 D FWDMSG^XMXMSGS(XMDUZ,.XMK,.XMKZA,.XMTO,.XMINSTR,.XMMSG)
"RTN","XMXAPI",81,0)
 Q
"RTN","XMXAPI",82,0)
LATERMSG(XMDUZ,XMK,XMKZA,XMINSTR,XMMSG) ; Later msgs
"RTN","XMXAPI",83,0)
 ; XMINSTR("LATER")
"RTN","XMXAPI",84,0)
 I '$D(XMV) N XMV,XMDISPI,XMDUN,XMNOSEND,XMPRIV
"RTN","XMXAPI",85,0)
 D LATERMSG^XMXPARM(.XMDUZ,.XMK,.XMKZA,.XMINSTR) Q:$D(XMERR)
"RTN","XMXAPI",86,0)
 D LATERMSG^XMXMSGS(XMDUZ,.XMK,.XMKZA,.XMINSTR,.XMMSG)
"RTN","XMXAPI",87,0)
 Q
"RTN","XMXAPI",88,0)
MOVEMSG(XMDUZ,XMK,XMKZA,XMKTO,XMMSG) ; Move msgs from one basket to another
"RTN","XMXAPI",89,0)
 ; XMKTO   Basket number, or enough of a name for a positive ID.
"RTN","XMXAPI",90,0)
 ;         Identifies basket to move to
"RTN","XMXAPI",91,0)
 I '$D(XMV) N XMV,XMDISPI,XMDUN,XMNOSEND,XMPRIV
"RTN","XMXAPI",92,0)
 D MOVEMSG^XMXPARM(.XMDUZ,.XMK,.XMKZA,.XMKTO) Q:$D(XMERR)
"RTN","XMXAPI",93,0)
 D MOVEMSG^XMXMSGS(XMDUZ,.XMK,.XMKZA,XMKTO,.XMMSG)
"RTN","XMXAPI",94,0)
 Q
"RTN","XMXAPI",95,0)
NTOGLMSG(XMDUZ,XMK,XMKZA,XMMSG) ; New Toggle msgs
"RTN","XMXAPI",96,0)
 I '$D(XMV) N XMV,XMDISPI,XMDUN,XMNOSEND,XMPRIV
"RTN","XMXAPI",97,0)
 D ACTMSGS^XMXPARM(.XMDUZ,.XMK,.XMKZA) Q:$D(XMERR)
"RTN","XMXAPI",98,0)
 D NTOGLMSG^XMXMSGS(XMDUZ,.XMK,.XMKZA,.XMMSG)
"RTN","XMXAPI",99,0)
 Q
"RTN","XMXAPI",100,0)
PRTMSG(XMDUZ,XMK,XMKZA,XMPRTTO,XMINSTR,XMMSG,XMTASK,XMSUBJ,XMTO) ; Print msgs
"RTN","XMXAPI",101,0)
 ; XMINSTR("HDR"), "RESPS", "RECIPS", "WHEN"
"RTN","XMXAPI",102,0)
 ; XMPRTTO Printer name
"RTN","XMXAPI",103,0)
 ; XMSUBJ & XMTO used only if XMPRTTO is a P-MESSAGE device.  Even then, they're optional.
"RTN","XMXAPI",104,0)
 I '$D(XMV) N XMV,XMDISPI,XMDUN,XMNOSEND,XMPRIV
"RTN","XMXAPI",105,0)
 D PRTMSG^XMXPARM(.XMDUZ,.XMK,.XMKZA,.XMPRTTO,.XMINSTR,.XMSUBJ,.XMTO) Q:$D(XMERR)
"RTN","XMXAPI",106,0)
 D PRTMSG^XMXMSGS(XMDUZ,.XMK,.XMKZA,XMPRTTO,.XMINSTR,.XMMSG,.XMTASK,.XMSUBJ,.XMTO)
"RTN","XMXAPI",107,0)
 Q
"RTN","XMXAPI",108,0)
PUTSERV(XMKN,XMZ) ; Put a message in a server basket
"RTN","XMXAPI",109,0)
 ; XMKN   full server name, including "S."
"RTN","XMXAPI",110,0)
 D SERV^XMXPARMB(.XMKN,.XMZ) Q:$D(XMERR)
"RTN","XMXAPI",111,0)
 D PUTSERV^XMXMSGS1(XMKN,XMZ)
"RTN","XMXAPI",112,0)
 Q
"RTN","XMXAPI",113,0)
REPLYMSG(XMDUZ,XMK,XMKZ,XMBODY,XMINSTR,XMZR) ; Reply to msg (Attach reply to original msg)
"RTN","XMXAPI",114,0)
 ; XMINSTR("NET REPLY") 1=send over the network; 0=don't (default)
"RTN","XMXAPI",115,0)
 ; XMINSTR("NET SUBJ")  Network Reply subject (see XMSUBJ)
"RTN","XMXAPI",116,0)
 ; Out: XMZR (message number of answer)
"RTN","XMXAPI",117,0)
 I '$D(XMV) N XMV,XMDISPI,XMDUN,XMNOSEND,XMPRIV
"RTN","XMXAPI",118,0)
 D REPLYMSG^XMXPARM(.XMDUZ,.XMK,.XMKZ,.XMBODY,.XMINSTR) Q:$D(XMERR)
"RTN","XMXAPI",119,0)
 D REPLYMSG^XMXREPLY(XMDUZ,.XMK,XMKZ,XMBODY,.XMINSTR,.XMZR)
"RTN","XMXAPI",120,0)
 Q
"RTN","XMXAPI",121,0)
SENDBULL(XMDUZ,XMBN,XMPARM,XMBODY,XMTO,XMINSTR,XMZ,XMATTACH) ; Send a bulletin (returns XMZ)
"RTN","XMXAPI",122,0)
 ; In:  User, bulletin name, bulletin parameters, add'l text,
"RTN","XMXAPI",123,0)
 ;      add'l recipients, send now or later (when?), opt'l BLOB
"RTN","XMXAPI",124,0)
 I '$D(XMV) N XMV,XMDISPI,XMDUN,XMNOSEND,XMPRIV
"RTN","XMXAPI",125,0)
 D BULLETIN^XMXPARM(.XMDUZ,.XMBN,.XMPARM,.XMBODY,.XMTO,.XMINSTR,.XMATTACH) Q:$D(XMERR)
"RTN","XMXAPI",126,0)
 D SENDBULL^XMXBULL(XMDUZ,XMBN,.XMPARM,.XMBODY,.XMTO,.XMINSTR,.XMZ,.XMATTACH)
"RTN","XMXAPI",127,0)
 Q
"RTN","XMXAPI",128,0)
SENDMSG(XMDUZ,XMSUBJ,XMBODY,XMTO,XMINSTR,XMZ,XMATTACH) ; Send a msg
"RTN","XMXAPI",129,0)
 ; In:  User, basket (if you are recipient), all msg parts,
"RTN","XMXAPI",130,0)
 ;      priority?, closed?, (info?,cc?), send now or later (when?),
"RTN","XMXAPI",131,0)
 ;      (KIDS,MIME,text,PackMan), delete date (if to shared,mail)
"RTN","XMXAPI",132,0)
 ; XMINSTR("RCPT BSKT")
"RTN","XMXAPI",133,0)
 I '$D(XMV) N XMV,XMDISPI,XMDUN,XMNOSEND,XMPRIV
"RTN","XMXAPI",134,0)
 D SENDMSG^XMXPARM(.XMDUZ,.XMSUBJ,.XMBODY,.XMTO,.XMINSTR,.XMATTACH) Q:$D(XMERR)
"RTN","XMXAPI",135,0)
 D SENDMSG^XMXSEND(XMDUZ,XMSUBJ,XMBODY,.XMTO,.XMINSTR,.XMZ,.XMATTACH)
"RTN","XMXAPI",136,0)
 Q
"RTN","XMXAPI",137,0)
TASKBULL(XMDUZ,XMBN,XMPARM,XMBODY,XMTO,XMINSTR,XMTASK,XMATTACH) ; Send a bulletin (Task it - does not return XMZ)
"RTN","XMXAPI",138,0)
 ; XMBN     Bulletin name (must be full name)
"RTN","XMXAPI",139,0)
 ; XMPARM   Array of parameters necessary for bulletin
"RTN","XMXAPI",140,0)
 ;             ARRAY(1)="parameter 1"
"RTN","XMXAPI",141,0)
 ;             ARRAY(2)="parameter 2"
"RTN","XMXAPI",142,0)
 ; XMBODY   Additional text to append to the bulletin text
"RTN","XMXAPI",143,0)
 ;              (must be closed root, passed by value.  See WP_ROOT
"RTN","XMXAPI",144,0)
 ;               definition for WP^DIE(), FM word processing filer)
"RTN","XMXAPI",145,0)
 ; XMTO     Additional addressee(s)
"RTN","XMXAPI",146,0)
 ; XMINSTR("SELF BSKT")
"RTN","XMXAPI",147,0)
 ;  ***ETC.***
"RTN","XMXAPI",148,0)
 ; In:  User, bulletin name, bulletin parameters, add'l text,
"RTN","XMXAPI",149,0)
 ;      add'l recipients, send now or later (when?), opt'l BLOB
"RTN","XMXAPI",150,0)
 ; Out: XMTASK (task number)
"RTN","XMXAPI",151,0)
 I '$D(XMV) N XMV,XMDISPI,XMDUN,XMNOSEND,XMPRIV
"RTN","XMXAPI",152,0)
 D BULLETIN^XMXPARM(.XMDUZ,.XMBN,.XMPARM,.XMBODY,.XMTO,.XMINSTR,.XMATTACH) Q:$D(XMERR)
"RTN","XMXAPI",153,0)
 D TASKBULL^XMXBULL(XMDUZ,XMBN,.XMPARM,.XMBODY,.XMTO,.XMINSTR,.XMTASK,.XMATTACH)
"RTN","XMXAPI",154,0)
 Q
"RTN","XMXAPI",155,0)
TERMMSG(XMDUZ,XMK,XMKZA,XMMSG) ; Terminate msgs
"RTN","XMXAPI",156,0)
 I '$D(XMV) N XMV,XMDISPI,XMDUN,XMNOSEND,XMPRIV
"RTN","XMXAPI",157,0)
 D ACTMSGS^XMXPARM(.XMDUZ,.XMK,.XMKZA) Q:$D(XMERR)
"RTN","XMXAPI",158,0)
 D TERMMSG^XMXMSGS(XMDUZ,.XMK,.XMKZA,.XMMSG)
"RTN","XMXAPI",159,0)
 Q
"RTN","XMXAPI",160,0)
VAPORMSG(XMDUZ,XMK,XMKZA,XMINSTR,XMMSG) ; Set vaporize date for msgs in a basket
"RTN","XMXAPI",161,0)
 ; XMINSTR("VAPOR")
"RTN","XMXAPI",162,0)
 I '$D(XMV) N XMV,XMDISPI,XMDUN,XMNOSEND,XMPRIV
"RTN","XMXAPI",163,0)
 D VAPORMSG^XMXPARM(.XMDUZ,.XMK,.XMKZA,.XMINSTR) Q:$D(XMERR)
"RTN","XMXAPI",164,0)
 D VAPORMSG^XMXMSGS(XMDUZ,.XMK,.XMKZA,.XMINSTR,.XMMSG)
"RTN","XMXAPI",165,0)
 Q
"RTN","XMXAPI",166,0)
ZAPSERV(XMKN,XMZ) ; Delete a message from a server basket
"RTN","XMXAPI",167,0)
 ; XMKN   full server name, including "S."
"RTN","XMXAPI",168,0)
 D SERV^XMXPARMB(.XMKN,.XMZ) Q:$D(XMERR)
"RTN","XMXAPI",169,0)
 D ZAPSERV^XMXMSGS1(XMKN,XMZ)
"RTN","XMXAPI",170,0)
 Q
"RTN","XMXAPI",171,0)
 ; ***** other actions
"RTN","XMXAPI",172,0)
ADDRNSND(XMDUZ,XMZ,XMTO,XMINSTR) ; Build a message part 2 (address and send)
"RTN","XMXAPI",173,0)
 ; XMZ (in)
"RTN","XMXAPI",174,0)
 I '$D(XMV) N XMV,XMDISPI,XMDUN,XMNOSEND,XMPRIV
"RTN","XMXAPI",175,0)
 D ADDRNSND^XMXPARM(.XMDUZ,.XMZ,.XMTO,.XMINSTR) Q:$D(XMERR)
"RTN","XMXAPI",176,0)
 D ADDRNSND^XMXSEND(XMDUZ,XMZ,.XMTO,.XMINSTR)
"RTN","XMXAPI",177,0)
 Q
"RTN","XMXAPI",178,0)
CRE8XMZ(XMSUBJ,XMZ) ; Build a message part 1 (create)
"RTN","XMXAPI",179,0)
 ; In:  subject
"RTN","XMXAPI",180,0)
 ; Out: XMZ
"RTN","XMXAPI",181,0)
 D VSUBJ^XMXPARM(.XMSUBJ) Q:$D(XMERR)
"RTN","XMXAPI",182,0)
 D CRE8XMZ^XMXSEND(XMSUBJ,.XMZ)
"RTN","XMXAPI",183,0)
 Q
"RTN","XMXAPI",184,0)
TOWHOM(XMDUZ,XMZ,XMTYPE,XMTO,XMINSTR,XMFULL) ; Check ONE msg addressee
"RTN","XMXAPI",185,0)
 ; XMFULL   Expanded address of the addressee
"RTN","XMXAPI",186,0)
 I '$D(XMV) N XMV,XMDISPI,XMDUN,XMNOSEND,XMPRIV
"RTN","XMXAPI",187,0)
 D TOWHOM^XMXPARM(.XMDUZ,.XMZ,.XMTYPE,XMTO,.XMINSTR) Q:$D(XMERR)
"RTN","XMXAPI",188,0)
 D TOWHOM^XMXTO(XMDUZ,.XMZ,XMTYPE,XMTO,.XMINSTR,.XMFULL)
"RTN","XMXAPI",189,0)
 Q
"RTN","XMXAPI",190,0)
VSUBJ(XMSUBJ) ; Validate a subject
"RTN","XMXAPI",191,0)
 D VSUBJ^XMXPARM(.XMSUBJ)
"RTN","XMXAPI",192,0)
 Q
"RTN","XMXAPIB")
0^363^B10245722
"RTN","XMXAPIB",1,0)
XMXAPIB ;ISC-SF/GMB-Mailbox and Mail Basket APIs ;04/17/2002  14:07
"RTN","XMXAPIB",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMXAPIB",3,0)
 ; All entry points covered by DBIA 2723.
"RTN","XMXAPIB",4,0)
 ; XMDUZ   User's DUZ, or enough of user's name for a positive ID
"RTN","XMXAPIB",5,0)
 ; XMK     Basket number, or enough of a name for a positive ID
"RTN","XMXAPIB",6,0)
 ; ***** Mailbox actions
"RTN","XMXAPIB",7,0)
CRE8MBOX(XMDUZ,XMDATE) ; Create a mailbox
"RTN","XMXAPIB",8,0)
 ; In:  User
"RTN","XMXAPIB",9,0)
 ; User must be POSTMASTER or POSTMASTER surrogate and possess XMMGR key.
"RTN","XMXAPIB",10,0)
 I '$D(XMV) N XMV,XMDISPI,XMDUN,XMNOSEND,XMPRIV
"RTN","XMXAPIB",11,0)
 D CRE8MBOX^XMXPARMB(.XMDUZ,.XMDATE) Q:$D(XMERR)
"RTN","XMXAPIB",12,0)
 D CRE8MBOX^XMXMBOX(XMDUZ,.XMDATE)
"RTN","XMXAPIB",13,0)
 Q
"RTN","XMXAPIB",14,0)
FLTRMBOX(XMDUZ,XMMSG) ; Filter all messages in a user's mailbox
"RTN","XMXAPIB",15,0)
 ; In:  User
"RTN","XMXAPIB",16,0)
 I '$D(XMV) N XMV,XMDISPI,XMDUN,XMNOSEND,XMPRIV
"RTN","XMXAPIB",17,0)
 D MBOX^XMXPARMB(.XMDUZ) Q:$D(XMERR)
"RTN","XMXAPIB",18,0)
 D FLTRMBOX^XMXMBOX(XMDUZ,.XMMSG)
"RTN","XMXAPIB",19,0)
 Q
"RTN","XMXAPIB",20,0)
QMBOX(XMDUZ,XMMSG) ; Query a mailbox
"RTN","XMXAPIB",21,0)
 ; # msgs^# new msgs^date/time last msg received^priority mail (0/1)
"RTN","XMXAPIB",22,0)
 ; In:  User, Query type
"RTN","XMXAPIB",23,0)
 I '$D(XMV) N XMV,XMDISPI,XMDUN,XMNOSEND,XMPRIV
"RTN","XMXAPIB",24,0)
 D MBOX^XMXPARMB(.XMDUZ) Q:$D(XMERR)
"RTN","XMXAPIB",25,0)
 D QMBOX^XMXMBOX(XMDUZ,.XMMSG)
"RTN","XMXAPIB",26,0)
 Q
"RTN","XMXAPIB",27,0)
TERMMBOX(XMDUZ) ; Remove all traces of a user in MM globals
"RTN","XMXAPIB",28,0)
 ; In:  User
"RTN","XMXAPIB",29,0)
 ; User must be POSTMASTER or POSTMASTER surrogate and possess XMMGR key.
"RTN","XMXAPIB",30,0)
 I '$D(XMV) N XMV,XMDISPI,XMDUN,XMNOSEND,XMPRIV
"RTN","XMXAPIB",31,0)
 D TERMMBOX^XMXPARMB(.XMDUZ) Q:$D(XMERR)
"RTN","XMXAPIB",32,0)
 D TERMMBOX^XMXMBOX(XMDUZ)
"RTN","XMXAPIB",33,0)
 Q
"RTN","XMXAPIB",34,0)
 ; ***** Basket actions
"RTN","XMXAPIB",35,0)
CRE8BSKT(XMDUZ,XMKN,XMK) ; Create a basket
"RTN","XMXAPIB",36,0)
 ; In:  User, basket name
"RTN","XMXAPIB",37,0)
 ; Out: Basket number
"RTN","XMXAPIB",38,0)
 I '$D(XMV) N XMV,XMDISPI,XMDUN,XMNOSEND,XMPRIV
"RTN","XMXAPIB",39,0)
 D CRE8BSKT^XMXPARMB(.XMDUZ,.XMKN) Q:$D(XMERR)
"RTN","XMXAPIB",40,0)
 D CRE8BSKT^XMXBSKT(XMDUZ,XMKN,.XMK)
"RTN","XMXAPIB",41,0)
 Q
"RTN","XMXAPIB",42,0)
DELBSKT(XMDUZ,XMK,XMFLAGS) ; Delete basket
"RTN","XMXAPIB",43,0)
 ; In:  User, basket
"RTN","XMXAPIB",44,0)
 I '$D(XMV) N XMV,XMDISPI,XMDUN,XMNOSEND,XMPRIV
"RTN","XMXAPIB",45,0)
 D DELBSKT^XMXPARMB(.XMDUZ,.XMK,.XMFLAGS) Q:$D(XMERR)
"RTN","XMXAPIB",46,0)
 D DELBSKT^XMXBSKT(XMDUZ,XMK,.XMFLAGS)
"RTN","XMXAPIB",47,0)
 Q
"RTN","XMXAPIB",48,0)
FLTRBSKT(XMDUZ,XMK,XMMSG) ; Filter all messages in a user's basket
"RTN","XMXAPIB",49,0)
 ; In:  User
"RTN","XMXAPIB",50,0)
 I '$D(XMV) N XMV,XMDISPI,XMDUN,XMNOSEND,XMPRIV
"RTN","XMXAPIB",51,0)
 D BSKT^XMXPARMB(.XMDUZ,.XMK) Q:$D(XMERR)
"RTN","XMXAPIB",52,0)
 D FLTRBSKT^XMXBSKT(XMDUZ,XMK,.XMMSG)
"RTN","XMXAPIB",53,0)
 Q
"RTN","XMXAPIB",54,0)
LISTBSKT(XMDUZ,XMFLAGS,XMAMT,XMSTART,XMPART,XMTROOT) ;
"RTN","XMXAPIB",55,0)
 I '$D(XMV) N XMV,XMDISPI,XMDUN,XMNOSEND,XMPRIV
"RTN","XMXAPIB",56,0)
 D LISTBSKT^XMXPARMB(XMDUZ,.XMFLAGS,.XMAMT,.XMSTART,.XMPART,.XMTROOT) Q:$D(XMERR)
"RTN","XMXAPIB",57,0)
 D LISTBSKT^XMXBSKT(XMDUZ,.XMFLAGS,.XMAMT,.XMSTART,.XMPART,.XMTROOT)
"RTN","XMXAPIB",58,0)
 Q
"RTN","XMXAPIB",59,0)
LISTMSGS(XMDUZ,XMK,XMFLDS,XMFLAGS,XMAMT,XMSTART,XMCRIT,XMTROOT) ; List messages
"RTN","XMXAPIB",60,0)
 I '$D(XMV) N XMV,XMDISPI,XMDUN,XMNOSEND,XMPRIV
"RTN","XMXAPIB",61,0)
 D LISTMSGS^XMXPARMB(.XMDUZ,.XMK,.XMFLDS,.XMFLAGS,.XMAMT,.XMSTART,.XMCRIT,.XMTROOT) Q:$D(XMERR)
"RTN","XMXAPIB",62,0)
 D LISTMSGS^XMXLIST(XMDUZ,.XMK,.XMFLDS,.XMFLAGS,.XMAMT,.XMSTART,.XMCRIT,.XMTROOT)
"RTN","XMXAPIB",63,0)
 Q
"RTN","XMXAPIB",64,0)
NAMEBSKT(XMDUZ,XMK,XMKN) ; Change the name of a basket
"RTN","XMXAPIB",65,0)
 ; In:  User, basket, new basket name (@ will delete)
"RTN","XMXAPIB",66,0)
 I '$D(XMV) N XMV,XMDISPI,XMDUN,XMNOSEND,XMPRIV
"RTN","XMXAPIB",67,0)
 D NAMEBSKT^XMXPARMB(.XMDUZ,.XMK,.XMKN) Q:$D(XMERR)
"RTN","XMXAPIB",68,0)
 D NAMEBSKT^XMXBSKT(XMDUZ,XMK,XMKN)
"RTN","XMXAPIB",69,0)
 Q
"RTN","XMXAPIB",70,0)
QBSKT(XMDUZ,XMK,XMMSG) ; Get info on a basket
"RTN","XMXAPIB",71,0)
 ; In:  User, basket
"RTN","XMXAPIB",72,0)
 ; Out: basket ien^basket name^# msgs^# new msgs
"RTN","XMXAPIB",73,0)
 I '$D(XMV) N XMV,XMDISPI,XMDUN,XMNOSEND,XMPRIV
"RTN","XMXAPIB",74,0)
 D BSKT^XMXPARMB(.XMDUZ,.XMK) Q:$D(XMERR)
"RTN","XMXAPIB",75,0)
 D QBSKT^XMXBSKT(XMDUZ,XMK,.XMMSG)
"RTN","XMXAPIB",76,0)
 Q
"RTN","XMXAPIB",77,0)
RSEQBSKT(XMDUZ,XMK,XMMSG) ; Resequence msgs in a basket
"RTN","XMXAPIB",78,0)
 ; In:  User, basket
"RTN","XMXAPIB",79,0)
 I '$D(XMV) N XMV,XMDISPI,XMDUN,XMNOSEND,XMPRIV
"RTN","XMXAPIB",80,0)
 D BSKT^XMXPARMB(.XMDUZ,.XMK) Q:$D(XMERR)
"RTN","XMXAPIB",81,0)
 D RSEQBSKT^XMXBSKT(XMDUZ,XMK,.XMMSG)
"RTN","XMXAPIB",82,0)
 Q
"RTN","XMXAPIG")
0^364^B12997724
"RTN","XMXAPIG",1,0)
XMXAPIG ;ISC-SF/GMB-Mail Group APIs ;04/19/2002  11:46
"RTN","XMXAPIG",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMXAPIG",3,0)
 ; All entry points covered by DBIA 3006
"RTN","XMXAPIG",4,0)
 ; Variables input:
"RTN","XMXAPIG",5,0)
 ; XMGROUP  Group's IEN or exact name
"RTN","XMXAPIG",6,0)
ADDMBRS(XMDUZ,XMGRP,XMMBR,XMINSTR,XMTSK) ; Add members to groups
"RTN","XMXAPIG",7,0)
 ; XMGRP    Same as XMGROUP, or array XMGRP(XMGROUP)=""
"RTN","XMXAPIG",8,0)
 ; XMMBR    Member or array of members to add.
"RTN","XMXAPIG",9,0)
 I '$D(XMV) N XMV,XMDISPI,XMDUN,XMNOSEND,XMPRIV
"RTN","XMXAPIG",10,0)
 K XMERR,^TMP("XMERR",$J)
"RTN","XMXAPIG",11,0)
 D XMDUZ^XMXPARM(.XMDUZ,.XMV)
"RTN","XMXAPIG",12,0)
 I $D(XMINSTR) D XMINSTR(.XMINSTR)
"RTN","XMXAPIG",13,0)
 Q:$D(XMERR)
"RTN","XMXAPIG",14,0)
 D ADDMBRS^XMXGRP(XMDUZ,.XMGRP,.XMMBR,.XMINSTR,.XMTSK)
"RTN","XMXAPIG",15,0)
 Q
"RTN","XMXAPIG",16,0)
JOIN(XMDUZ,XMGROUP,XMINSTR,XMTSK) ; User chooses to join a group.
"RTN","XMXAPIG",17,0)
 I '$D(XMV) N XMV,XMDISPI,XMDUN,XMNOSEND,XMPRIV
"RTN","XMXAPIG",18,0)
 K XMERR,^TMP("XMERR",$J)
"RTN","XMXAPIG",19,0)
 D XMDUZ^XMXPARM(.XMDUZ,.XMV)
"RTN","XMXAPIG",20,0)
 I $D(XMINSTR) D XMINSTR(.XMINSTR)
"RTN","XMXAPIG",21,0)
 D JOIN^XMXGRP(XMDUZ,XMGROUP,.XMINSTR,.XMTSK)
"RTN","XMXAPIG",22,0)
 Q
"RTN","XMXAPIG",23,0)
DROP(XMDUZ,XMGROUP) ; User chooses to drop from a group.
"RTN","XMXAPIG",24,0)
 I '$D(XMV) N XMV,XMDISPI,XMDUN,XMNOSEND,XMPRIV
"RTN","XMXAPIG",25,0)
 K XMERR,^TMP("XMERR",$J)
"RTN","XMXAPIG",26,0)
 D XMDUZ^XMXPARM(.XMDUZ,.XMV) Q:$D(XMERR)
"RTN","XMXAPIG",27,0)
 D DROP^XMXGRP(XMDUZ,XMGROUP)
"RTN","XMXAPIG",28,0)
 Q
"RTN","XMXAPIG",29,0)
XMINSTR(XMINSTR) ;
"RTN","XMXAPIG",30,0)
 S:$D(XMINSTR("SELF BSKT")) XMINSTR("SELF BSKT")=$$XMK^XMXPARM(XMDUZ,"XMINSTR(""SELF BSKT"")",XMINSTR("SELF BSKT"),1)
"RTN","XMXAPIG",31,0)
 I $D(XMINSTR("FLAGS")) D XMFLAG^XMXPARM("XMINSTR(""FLAGS"")",XMINSTR("FLAGS"),"AF")
"RTN","XMXAPIG",32,0)
 S:$D(XMINSTR("FDATE")) XMINSTR("FDATE")=$$XMDATE^XMXPARMB("XMINSTR(""FDATE"")",XMINSTR("FDATE"))
"RTN","XMXAPIG",33,0)
 S:$D(XMINSTR("TDATE")) XMINSTR("TDATE")=$$XMDATE^XMXPARMB("XMINSTR(""TDATE"")",XMINSTR("TDATE"))
"RTN","XMXAPIG",34,0)
 Q
"RTN","XMXAPIG",35,0)
GOTLOCAL(XMGROUP,XMDAYS,XMMBRS) ; Function: Any active local members?  (1=yes; 0=no)
"RTN","XMXAPIG",36,0)
 ; XMDAYS (optional) add'l requirement that the member must have used
"RTN","XMXAPIG",37,0)
 ;                   MailMan within the last XMDAYS days.
"RTN","XMXAPIG",38,0)
 ; XMMBRS (optional) add'l requirement that this many local members must
"RTN","XMXAPIG",39,0)
 ;                   be in the group.  (default is 1)
"RTN","XMXAPIG",40,0)
 N XMGIEN,XMSCREEN,XMLIST
"RTN","XMXAPIG",41,0)
 K XMERR,^TMP("XMERR",$J)
"RTN","XMXAPIG",42,0)
 S XMGIEN=$$IEN(XMGROUP) Q:$D(XMERR) 0
"RTN","XMXAPIG",43,0)
 ; User must have access code and mailbox
"RTN","XMXAPIG",44,0)
 S XMSCREEN="N XM S XM=+^(0) I $L($P($G(^VA(200,XM,0)),U,3)),$D(^XMB(3.7,XM,2))"
"RTN","XMXAPIG",45,0)
 I $G(XMDAYS) S XMSCREEN=XMSCREEN_",$P($G(^(""L"")),U,2)'<"_$$FMADD^XLFDT(DT,-XMDAYS)
"RTN","XMXAPIG",46,0)
 I '$G(XMMBRS) S XMMBRS=1
"RTN","XMXAPIG",47,0)
 D LIST^DIC(3.81,","_XMGIEN_",","@","I",XMMBRS,"","","",XMSCREEN,"","XMLIST")
"RTN","XMXAPIG",48,0)
 Q:+XMLIST("DILIST",0)=XMMBRS 1
"RTN","XMXAPIG",49,0)
 ; none found
"RTN","XMXAPIG",50,0)
 K:$D(DIERR) DIERR,^TMP("DIERR",$J)
"RTN","XMXAPIG",51,0)
 N XMPARM,XMDIALOG
"RTN","XMXAPIG",52,0)
 S XMPARM(1)=$$NAME(XMGIEN),XMDIALOG=39503 ;Mail group '|1|' has no active local members
"RTN","XMXAPIG",53,0)
 I $G(XMDAYS) S XMPARM(2)=$$FMTE^XLFDT($$FMADD^XLFDT(DT,-XMDAYS),5),XMDIALOG=39504 ;Mail group '|1|' has no local members active since '|2|'
"RTN","XMXAPIG",54,0)
 I $G(XMMBRS) S XMPARM(3)=XMMBRS,XMDIALOG=XMDIALOG+.1
"RTN","XMXAPIG",55,0)
 ;38503.1-Mail group '|1|' does not have at least |3| active local members
"RTN","XMXAPIG",56,0)
 ;38504.1-Mail group '|1|' does not have at least |3| active local members
"RTN","XMXAPIG",57,0)
 D ERRSET^XMXUTIL(XMDIALOG,.XMPARM)
"RTN","XMXAPIG",58,0)
 Q 0
"RTN","XMXAPIG",59,0)
IEN(XMGROUP) ; INTERNAL USE ONLY function, given group's ien or exact name, returns ien
"RTN","XMXAPIG",60,0)
 I +XMGROUP=XMGROUP D  Q XMGROUP
"RTN","XMXAPIG",61,0)
 . I $D(^XMB(3.8,XMGROUP,0)) Q
"RTN","XMXAPIG",62,0)
 . D ERRSET^XMXUTIL(39502,XMGROUP) ;Mail group IEN '|1|' not found.
"RTN","XMXAPIG",63,0)
 . S XMGROUP=0
"RTN","XMXAPIG",64,0)
 N XMGIEN
"RTN","XMXAPIG",65,0)
 S XMGIEN=$O(^XMB(3.8,"B",XMGROUP,0)) Q:XMGIEN XMGIEN
"RTN","XMXAPIG",66,0)
 D ERRSET^XMXUTIL(39501,XMGROUP) ;Mail group '|1|' not found.
"RTN","XMXAPIG",67,0)
 Q 0
"RTN","XMXAPIG",68,0)
NAME(XMGIEN) ; INTERNAL USE ONLY function, given group's ien, returns name
"RTN","XMXAPIG",69,0)
 Q $P($G(^XMB(3.8,XMGIEN,0)),U,1)
"RTN","XMXAPIG",70,0)
MEMBER(XMDUZ,XMGROUP,XMCHKSUB) ; Is user a member of the group?
"RTN","XMXAPIG",71,0)
 ; XMCHKSUB - Check member groups, too? (0=no; 1=yes)
"RTN","XMXAPIG",72,0)
 N XMGIEN,XMCHECKD
"RTN","XMXAPIG",73,0)
 K XMERR,^TMP("XMERR",$J)
"RTN","XMXAPIG",74,0)
 S XMGIEN=$$IEN(XMGROUP) Q:$D(XMERR) 0
"RTN","XMXAPIG",75,0)
 I '$G(XMCHKSUB) Q $D(^XMB(3.8,XMGIEN,1,"B",XMDUZ))>0
"RTN","XMXAPIG",76,0)
 Q $$SUBMBR(XMDUZ,XMGIEN)
"RTN","XMXAPIG",77,0)
SUBMBR(XMDUZ,XMGIEN) ;
"RTN","XMXAPIG",78,0)
 I $D(^XMB(3.8,XMGIEN,1,"B",XMDUZ)) Q 1
"RTN","XMXAPIG",79,0)
 N XMI,XMMBR
"RTN","XMXAPIG",80,0)
 S XMCHECKD(XMGIEN)=""
"RTN","XMXAPIG",81,0)
 S XMI=0
"RTN","XMXAPIG",82,0)
 F  S XMI=$O(^XMB(3.8,XMGIEN,5,"B",XMI)) Q:'XMI  D  Q:$G(XMMBR)
"RTN","XMXAPIG",83,0)
 . Q:'$D(^XMB(3.8,XMI))
"RTN","XMXAPIG",84,0)
 . Q:$D(XMCHECKD(XMI))
"RTN","XMXAPIG",85,0)
 . S XMMBR=$$SUBMBR(XMDUZ,XMI)
"RTN","XMXAPIG",86,0)
 Q +$G(XMMBR)
"RTN","XMXAPIU")
0^365^B1235647
"RTN","XMXAPIU",1,0)
XMXAPIU ;ISC-SF/GMB-APIs for users to use interactively ;04/17/2002  14:07
"RTN","XMXAPIU",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMXAPIU",3,0)
 ; All entry points covered by DBIA 2774.
"RTN","XMXAPIU",4,0)
 ;
"RTN","XMXAPIU",5,0)
 ; The following are meant to be in an option's ROUTINE field.
"RTN","XMXAPIU",6,0)
 ; They expect that DUZ exists, and if the user is acting as a surrogate,
"RTN","XMXAPIU",7,0)
 ; that XMDUZ exists, too.  Otherwise, XMDUZ will be set to DUZ.
"RTN","XMXAPIU",8,0)
 ; If the XMV variables do not exist, INIT^XMVVITAE will be called.
"RTN","XMXAPIU",9,0)
 Q
"RTN","XMXAPIU",10,0)
READ ; Read/Manage messages in your Mailbox
"RTN","XMXAPIU",11,0)
 ; Needs XMDUZ
"RTN","XMXAPIU",12,0)
 I '$D(XMV) N XMV,XMDISPI,XMDUN,XMNOSEND,XMPRIV
"RTN","XMXAPIU",13,0)
 G MANAGE^XMJBM
"RTN","XMXAPIU",14,0)
 Q
"RTN","XMXAPIU",15,0)
READNEW ; Read new messages in your Mailbox
"RTN","XMXAPIU",16,0)
 I '$D(XMV) N XMV,XMDISPI,XMDUN,XMNOSEND,XMPRIV
"RTN","XMXAPIU",17,0)
 G NEW^XMJBN
"RTN","XMXAPIU",18,0)
 Q
"RTN","XMXAPIU",19,0)
SEND ; Send a message
"RTN","XMXAPIU",20,0)
 I '$D(XMV) N XMV,XMDISPI,XMDUN,XMNOSEND,XMPRIV
"RTN","XMXAPIU",21,0)
 G SEND^XMJMS
"RTN","XMXAPIU",22,0)
 Q
"RTN","XMXAPIU",23,0)
 ; The following are meant to be called from within a program.
"RTN","XMXAPIU",24,0)
TOWHOM(XMDUZ,XMZ,XMTYPE,XMINSTR) ; Ask user for msg addressees
"RTN","XMXAPIU",25,0)
 ; XMDUZ     User's DUZ
"RTN","XMXAPIU",26,0)
 ; XMZ       message number in ^XMB(3.9,
"RTN","XMXAPIU",27,0)
 ; XMTYPE
"RTN","XMXAPIU",28,0)
 ; XMINSTR
"RTN","XMXAPIU",29,0)
 ; XMERR     If there's any errors, then XMERR is set to the number of
"RTN","XMXAPIU",30,0)
 ;           errors, otherwise XMERR is undefined.
"RTN","XMXAPIU",31,0)
 ;           ^TMP("XMERR",$J,error number,"TEXT",line number)=error text
"RTN","XMXAPIU",32,0)
 I '$D(XMV) N XMV,XMDISPI,XMDUN,XMNOSEND,XMPRIV
"RTN","XMXAPIU",33,0)
 D ITOWHOM^XMXPARM(.XMDUZ,.XMZ,.XMTYPE,.XMINSTR) Q:$D(XMERR)
"RTN","XMXAPIU",34,0)
 D ITOWHOM^XMXTO(XMDUZ,.XMZ,XMTYPE,.XMINSTR)
"RTN","XMXAPIU",35,0)
 Q
"RTN","XMXBSKT")
0^366^B42208664
"RTN","XMXBSKT",1,0)
XMXBSKT ;ISC-SF/GMB-Basket APIs ;04/17/2002  14:07
"RTN","XMXBSKT",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMXBSKT",3,0)
CRE8BSKT(XMDUZ,XMKN,XMK) ; Routine creates basket, given name, and
"RTN","XMXBSKT",4,0)
 ; returns basket number.
"RTN","XMXBSKT",5,0)
 K XMERR,^TMP("XMERR",$J)
"RTN","XMXBSKT",6,0)
 I XMDUZ=.6,'$$POSTPRIV^XMXSEC Q
"RTN","XMXBSKT",7,0)
 I XMDUZ'=DUZ,'$$RPRIV^XMXSEC Q
"RTN","XMXBSKT",8,0)
 S XMK=$$FIND1^DIC(3.701,","_XMDUZ_",","X",XMKN)
"RTN","XMXBSKT",9,0)
 I XMK D  Q
"RTN","XMXBSKT",10,0)
 .; (It might be better if used an index which was the upper case of
"RTN","XMXBSKT",11,0)
 .;  the basket name, and if we checked for upper case of XMKN)
"RTN","XMXBSKT",12,0)
 . D ERRSET^XMXUTIL(37201.3,XMKN) ; Basket '_XMKN_' already exists.
"RTN","XMXBSKT",13,0)
 I XMDUZ=.5 D  Q:$G(XMERR)
"RTN","XMXBSKT",14,0)
 . N I,XMK
"RTN","XMXBSKT",15,0)
 . S XMK=.99
"RTN","XMXBSKT",16,0)
 . F I=1:1 S XMK=$O(^XMB(3.7,.5,2,XMK)) Q:XMK>999!'XMK
"RTN","XMXBSKT",17,0)
 . Q:I<999
"RTN","XMXBSKT",18,0)
 . D ERRSET^XMXUTIL(38113.1) ; Postmaster may not have more than 999 baskets.  (>999=Network msg queues)
"RTN","XMXBSKT",19,0)
 ;D VAL^DIE(3.701,"1,"_XMDUZ_",",.01,"H",XMKN) ; validate the name
"RTN","XMXBSKT",20,0)
 D MAKEBSKT(XMDUZ,.XMK,XMKN)
"RTN","XMXBSKT",21,0)
 Q
"RTN","XMXBSKT",22,0)
MAKEBSKT(XMDUZ,XMK,XMKN) ; Create a basket (For internal MM use only)
"RTN","XMXBSKT",23,0)
 ; If you give it an XMK, it'll put it there,
"RTN","XMXBSKT",24,0)
 ; else, it'll find a vacant XMK.
"RTN","XMXBSKT",25,0)
 N XMFDA,XMIEN,XMTRIES
"RTN","XMXBSKT",26,0)
 I 'XMK F XMK=2:1 Q:'$D(^XMB(3.7,XMDUZ,2,XMK))  ; Find 1st vacant bskt #
"RTN","XMXBSKT",27,0)
 S XMFDA(3.701,"+1,"_XMDUZ_",",.01)=XMKN
"RTN","XMXBSKT",28,0)
 S XMIEN(1)=XMK
"RTN","XMXBSKT",29,0)
MTRY D UPDATE^DIE("S","XMFDA","XMIEN") Q:'$D(DIERR)
"RTN","XMXBSKT",30,0)
 S XMTRIES=$G(XMTRIES)+1
"RTN","XMXBSKT",31,0)
 I $D(^TMP("DIERR",$J,"E",110)) H 1 G MTRY ; Try again if can't lock
"RTN","XMXBSKT",32,0)
 Q
"RTN","XMXBSKT",33,0)
DELBSKT(XMDUZ,XMK,XMFLAGS) ;
"RTN","XMXBSKT",34,0)
 ; XMK      Basket IEN
"RTN","XMXBSKT",35,0)
 N XMNEW
"RTN","XMXBSKT",36,0)
 K XMERR,^TMP("XMERR",$J)
"RTN","XMXBSKT",37,0)
 I XMDUZ=.6,'$$POSTPRIV^XMXSEC Q
"RTN","XMXBSKT",38,0)
 I XMDUZ'=DUZ,'$$RPRIV^XMXSEC Q
"RTN","XMXBSKT",39,0)
 I XMK'>1 D  Q
"RTN","XMXBSKT",40,0)
 . D ERRSET^XMXUTIL(37215.2,$P(^XMB(3.7,XMDUZ,2,XMK,0),U,1)) ; The '_IN/WASTE_' basket may not be deleted.
"RTN","XMXBSKT",41,0)
 I $G(XMFLAGS)'["D",$$BMSGCT^XMXUTIL(XMDUZ,XMK)>0 D  Q
"RTN","XMXBSKT",42,0)
 . D ERRSET^XMXUTIL(37215.4,$P(^XMB(3.7,XMDUZ,2,XMK,0),U,1)) ; The '_x_' basket may not be deleted, because it still has messages in it.
"RTN","XMXBSKT",43,0)
 S XMNEW=$$BNMSGCT^XMXUTIL(XMDUZ,XMK)
"RTN","XMXBSKT",44,0)
 L +^XMB(3.7,XMDUZ):1
"RTN","XMXBSKT",45,0)
 S:XMNEW $P(^(0),U,6)=$P(^XMB(3.7,XMDUZ,0),U,6)-XMNEW
"RTN","XMXBSKT",46,0)
 N XMFDA
"RTN","XMXBSKT",47,0)
 S XMFDA(3.701,XMK_","_XMDUZ_",",.01)="@"
"RTN","XMXBSKT",48,0)
 D FILE^DIE("","XMFDA")
"RTN","XMXBSKT",49,0)
 L -^XMB(3.7,XMDUZ)
"RTN","XMXBSKT",50,0)
 Q
"RTN","XMXBSKT",51,0)
LISTBSKT(XMDUZ,XMFLAGS,XMAMT,XMSTART,XMPART,XMTROOT) ;
"RTN","XMXBSKT",52,0)
 N XMORDER,XMI,XMCNT,XMK,XMKREC,XMSCREEN,XMFMFLAG
"RTN","XMXBSKT",53,0)
 I XMDUZ'=DUZ,'$$RPRIV^XMXSEC Q
"RTN","XMXBSKT",54,0)
 I $D(XMTROOT),XMTROOT'="" D
"RTN","XMXBSKT",55,0)
 . K @$$CREF^DILF(XMTROOT)
"RTN","XMXBSKT",56,0)
 . S XMTROOT=$$OREF^DILF(XMTROOT)_"""XMLIST"","
"RTN","XMXBSKT",57,0)
 E  D
"RTN","XMXBSKT",58,0)
 . K ^TMP("XMLIST",$J)
"RTN","XMXBSKT",59,0)
 . S XMTROOT="^TMP(""XMLIST"",$J,"
"RTN","XMXBSKT",60,0)
 I $G(XMFLAGS)["N" S XMSCREEN="I $P(^(0),U,2)" ; Only baskets w/new msgs
"RTN","XMXBSKT",61,0)
 E  S XMSCREEN=""
"RTN","XMXBSKT",62,0)
 S XMFMFLAG="I"
"RTN","XMXBSKT",63,0)
 I $G(XMFLAGS)["B" S XMFMFLAG=XMFMFLAG_"B"
"RTN","XMXBSKT",64,0)
 D LIST^DIC(3.701,","_XMDUZ_",","",XMFMFLAG,.XMAMT,.XMSTART,.XMPART,"",XMSCREEN)
"RTN","XMXBSKT",65,0)
 S @(XMTROOT_"0)")=^TMP("DILIST",$J,0)
"RTN","XMXBSKT",66,0)
 S XMORDER=$S($G(XMFLAGS)["B":-1,1:1)
"RTN","XMXBSKT",67,0)
 S XMCNT=0,XMI=""
"RTN","XMXBSKT",68,0)
 F  S XMI=$O(^TMP("DILIST",$J,2,XMI),XMORDER) Q:'XMI  S XMK=^(XMI) D
"RTN","XMXBSKT",69,0)
 . S XMCNT=XMCNT+1
"RTN","XMXBSKT",70,0)
 . S XMKREC=^XMB(3.7,XMDUZ,2,XMK,0)
"RTN","XMXBSKT",71,0)
 . S @(XMTROOT_XMCNT_")")=XMK_U_$P(XMKREC,U,1)_U_$$BMSGCT^XMXUTIL(XMDUZ,XMK)_U_+$P(XMKREC,U,2) ; basket ien^basket name^# msgs^# new msgs
"RTN","XMXBSKT",72,0)
 . I '$G(XMAMT) S @(XMTROOT_"""BSKT"",$$UP^XLFSTR($P(XMKREC,U,1)),"_XMCNT_")")=""
"RTN","XMXBSKT",73,0)
 K ^TMP("DILIST",$J)
"RTN","XMXBSKT",74,0)
 Q
"RTN","XMXBSKT",75,0)
NAMEBSKT(XMDUZ,XMK,XMKN) ;
"RTN","XMXBSKT",76,0)
 ; XMK      Basket IEN
"RTN","XMXBSKT",77,0)
 ; XMKN     New basket name
"RTN","XMXBSKT",78,0)
 K XMERR,^TMP("XMERR",$J)
"RTN","XMXBSKT",79,0)
 I XMDUZ=.6,'$$POSTPRIV^XMXSEC Q
"RTN","XMXBSKT",80,0)
 I XMDUZ'=DUZ,'$$WPRIV^XMXSEC  Q
"RTN","XMXBSKT",81,0)
 I XMK'>1!XMK>999 D  Q
"RTN","XMXBSKT",82,0)
 . D ERRSET^XMXUTIL(37201.2,$P(^XMB(3.7,XMDUZ,2,XMK,0),U,1)) ; The '_x_' basket name may not be changed.
"RTN","XMXBSKT",83,0)
 N XMFDA
"RTN","XMXBSKT",84,0)
 S XMFDA(3.701,XMK_","_XMDUZ_",",.01)=XMKN
"RTN","XMXBSKT",85,0)
 D FILE^DIE("","XMFDA")
"RTN","XMXBSKT",86,0)
 Q
"RTN","XMXBSKT",87,0)
QBSKT(XMDUZ,XMK,XMMSG) ; Message counts for a mail basket
"RTN","XMXBSKT",88,0)
 N XMKREC
"RTN","XMXBSKT",89,0)
 K XMERR,^TMP("XMERR",$J)
"RTN","XMXBSKT",90,0)
 S XMMSG=""
"RTN","XMXBSKT",91,0)
 I XMDUZ'=DUZ,'$$RPRIV^XMXSEC  Q
"RTN","XMXBSKT",92,0)
 S XMKREC=^XMB(3.7,XMDUZ,2,XMK,0)
"RTN","XMXBSKT",93,0)
 S XMMSG=XMK_U_$P(XMKREC,U,1)_U_$$BMSGCT^XMXUTIL(XMDUZ,XMK)_U_+$P(XMKREC,U,2) ; basket ien^basket name^# msgs^# new msgs
"RTN","XMXBSKT",94,0)
 Q
"RTN","XMXBSKT",95,0)
RSEQBSKT(XMDUZ,XMK,XMMSG) ; Resequence message numbers
"RTN","XMXBSKT",96,0)
 ; XMZ      - Unique message number
"RTN","XMXBSKT",97,0)
 ; XMK      - basket number
"RTN","XMXBSKT",98,0)
 ; XMKZ     - Message number in basket
"RTN","XMXBSKT",99,0)
 ; XMKZCNT  - Number of messages in basket
"RTN","XMXBSKT",100,0)
 N XMKZCNT,XMERROR  ; (XMERROR is set in XMUT4)
"RTN","XMXBSKT",101,0)
 K XMERR,^TMP("XMERR",$J)
"RTN","XMXBSKT",102,0)
 S XMMSG=""
"RTN","XMXBSKT",103,0)
 ;I XMDUZ=.6,'$$POSTPRIV^XMXSEC Q  ; Shouldn't need special privileges.
"RTN","XMXBSKT",104,0)
 I XMDUZ'=DUZ,'$$RPRIV^XMXSEC  Q
"RTN","XMXBSKT",105,0)
 D BSKT^XMUT4(XMDUZ,XMK)     ; Basket integrity check
"RTN","XMXBSKT",106,0)
 D RSEQ(XMDUZ,XMK,.XMKZCNT)  ; resequence
"RTN","XMXBSKT",107,0)
 S XMMSG=$$EZBLD^DIALOG(37212.9,XMKZCNT) ; Resequenced from 1 to _XMKZCNT.
"RTN","XMXBSKT",108,0)
 Q
"RTN","XMXBSKT",109,0)
RSEQ(XMDUZ,XMK,XMKZNEW) ; Internal MailMan entry point to resequence a basket
"RTN","XMXBSKT",110,0)
 ; *** IN create date/xmz SEQUENCE ***
"RTN","XMXBSKT",111,0)
 N XMKZ,XMZ,XMFDA,XMCRE8DT
"RTN","XMXBSKT",112,0)
 K ^TMP("XM",$J,"RSEQ")
"RTN","XMXBSKT",113,0)
 S XMZ=0
"RTN","XMXBSKT",114,0)
 F  S XMZ=$O(^XMB(3.7,XMDUZ,2,XMK,1,XMZ)) Q:XMZ'>0  S ^TMP("XM",$J,"RSEQ",+$P($G(^XMB(3.9,XMZ,.6)),U),XMZ)=""
"RTN","XMXBSKT",115,0)
 S XMKZNEW=0,(XMCRE8DT,XMZ)=""
"RTN","XMXBSKT",116,0)
 F  S XMCRE8DT=$O(^TMP("XM",$J,"RSEQ",XMCRE8DT)) Q:XMCRE8DT=""  D  Q:$D(XMERR)
"RTN","XMXBSKT",117,0)
 . F  S XMZ=$O(^TMP("XM",$J,"RSEQ",XMCRE8DT,XMZ)) Q:'XMZ  D  Q:$D(XMERR)
"RTN","XMXBSKT",118,0)
 . . S XMKZ=$P($G(^XMB(3.7,XMDUZ,2,XMK,1,XMZ,0)),U,2) Q:'XMKZ
"RTN","XMXBSKT",119,0)
 . . S XMKZNEW=XMKZNEW+1
"RTN","XMXBSKT",120,0)
 . . Q:XMKZ=XMKZNEW
"RTN","XMXBSKT",121,0)
 . . S XMFDA(3.702,XMZ_","_XMK_","_XMDUZ_",",2)=XMKZNEW
"RTN","XMXBSKT",122,0)
 . . D FILE^DIE("","XMFDA") I $D(DIERR) D ERRSET^XMXUTIL(37212.8,$P(^XMB(3.7,XMDUZ,2,XMK,0),U,1)) ; Error resequencing the '_x_' basket.
"RTN","XMXBSKT",123,0)
 K ^TMP("XM",$J,"RSEQ")
"RTN","XMXBSKT",124,0)
 Q:$D(XMERR)
"RTN","XMXBSKT",125,0)
 S:+$P($G(^XMB(3.7,XMDUZ,2,XMK,1,0)),U,4)'=XMKZNEW $P(^(0),U,4)=XMKZNEW
"RTN","XMXBSKT",126,0)
 Q
"RTN","XMXBSKT",127,0)
XRSEQ(XMDUZ,XMK,XMKZNEW) ; Internal MailMan entry point to resequence a basket
"RTN","XMXBSKT",128,0)
 ; *** IN XMKZ SEQUENCE ***
"RTN","XMXBSKT",129,0)
 N XMKZ,XMZ,XMFDA
"RTN","XMXBSKT",130,0)
 S (XMKZ,XMKZNEW)=0
"RTN","XMXBSKT",131,0)
 F  S XMKZ=$O(^XMB(3.7,XMDUZ,2,XMK,1,"C",XMKZ)) Q:XMKZ'>0  D  Q:$D(XMERR)
"RTN","XMXBSKT",132,0)
 . I XMKZ'>XMKZNEW S XMKZNEW=XMKZ-1
"RTN","XMXBSKT",133,0)
 . S XMZ=0
"RTN","XMXBSKT",134,0)
 . F  S XMZ=$O(^XMB(3.7,XMDUZ,2,XMK,1,"C",XMKZ,XMZ)) Q:XMZ'>0  D  Q:$D(XMERR)
"RTN","XMXBSKT",135,0)
 . . S XMKZNEW=XMKZNEW+1
"RTN","XMXBSKT",136,0)
 . . Q:XMKZ=XMKZNEW
"RTN","XMXBSKT",137,0)
 . . S XMFDA(3.702,XMZ_","_XMK_","_XMDUZ_",",2)=XMKZNEW
"RTN","XMXBSKT",138,0)
 . . D FILE^DIE("","XMFDA") I $D(DIERR) D ERRSET^XMXUTIL(37212.8,$P(^XMB(3.7,XMDUZ,2,XMK,0),U,1)) ; Error resequencing the '_x_' basket.
"RTN","XMXBSKT",139,0)
 Q:$D(XMERR)
"RTN","XMXBSKT",140,0)
 S:+$P($G(^XMB(3.7,XMDUZ,2,XMK,1,0)),U,4)'=XMKZNEW $P(^(0),U,4)=XMKZNEW
"RTN","XMXBSKT",141,0)
 Q
"RTN","XMXBSKT",142,0)
FLTRBSKT(XMDUZ,XMK,XMMSG) ; Filter a basket
"RTN","XMXBSKT",143,0)
 ; XMZ      - Unique message number
"RTN","XMXBSKT",144,0)
 ; XMK      - basket number
"RTN","XMXBSKT",145,0)
 K XMERR,^TMP("XMERR",$J)
"RTN","XMXBSKT",146,0)
 S XMMSG=""
"RTN","XMXBSKT",147,0)
 I XMDUZ=.6,'$$POSTPRIV^XMXSEC Q
"RTN","XMXBSKT",148,0)
 I XMDUZ'=DUZ,'$$RPRIV^XMXSEC Q
"RTN","XMXBSKT",149,0)
 I XMK'=.5,'$D(^XMB(3.7,XMDUZ,15,"AF")) D  Q
"RTN","XMXBSKT",150,0)
 . D ERRSET^XMXUTIL($S(XMDUZ=DUZ:37204.1,1:37204.2),XMV("NAME")) ; You have / x has no message filters defined.
"RTN","XMXBSKT",151,0)
 I XMDUZ=.5,XMK>1000 D  Q
"RTN","XMXBSKT",152,0)
 . D ERRSET^XMXUTIL(37251) ; You may not do this with messages in the transmit queues.
"RTN","XMXBSKT",153,0)
 N XMZ,XMKN
"RTN","XMXBSKT",154,0)
 S XMKN=$P(^XMB(3.7,XMDUZ,2,XMK,0),U,1)
"RTN","XMXBSKT",155,0)
 S XMZ=0
"RTN","XMXBSKT",156,0)
 F  S XMZ=$O(^XMB(3.7,XMDUZ,2,XMK,1,XMZ)) Q:XMZ'>0  D FLTR^XMXMSGS2(XMDUZ,XMK,XMKN,XMZ)
"RTN","XMXBSKT",157,0)
 S XMMSG=$$EZBLD^DIALOG(34306.2) ; Basket filtered.
"RTN","XMXBSKT",158,0)
 Q
"RTN","XMXBULL")
0^367^B18811259
"RTN","XMXBULL",1,0)
XMXBULL ;ISC-SF/GMB-Send Bulletin ;04/23/2002  08:46
"RTN","XMXBULL",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMXBULL",3,0)
 ; Replaces ^XMB (ISC-WASH/THM/RWF/CAP)
"RTN","XMXBULL",4,0)
 ; TASKBULL creates and delivers a bulletin in background.
"RTN","XMXBULL",5,0)
 ; SENDBULL creates bulletin in foreground; delivers in background
"RTN","XMXBULL",6,0)
 ; TASK     for use by TaskMan only
"RTN","XMXBULL",7,0)
 ; The recipients of the message include any entries in the XMTO
"RTN","XMXBULL",8,0)
 ; array that the caller has defined and the members of mail groups
"RTN","XMXBULL",9,0)
 ; that are included in the definition of the entry in the Bulletin
"RTN","XMXBULL",10,0)
 ; file (#3.6) at the time of delivery.  There must be valid
"RTN","XMXBULL",11,0)
 ; recipients or the message will not be delivered.
"RTN","XMXBULL",12,0)
 ; Inputs:
"RTN","XMXBULL",13,0)
 ; XMDUZ    Sender DUZ
"RTN","XMXBULL",14,0)
 ; XMBNAME  The name of a bulletin (an entry in File #3.6)
"RTN","XMXBULL",15,0)
 ; XMPARM(parameter#)=The value to be stuffed into the bulletin for each
"RTN","XMXBULL",16,0)
 ;       required parameter.  (eg. XMPARM(1)=data for parameter#1
"RTN","XMXBULL",17,0)
 ; XMBODY   (optional) Additional text of the message
"RTN","XMXBULL",18,0)
 ; XMTO     (optional) Array of recipients of a bulletin
"RTN","XMXBULL",19,0)
 ; XMINSTR("FLAGS") (optional)
"RTN","XMXBULL",20,0)
 ;                     ["P" - priority
"RTN","XMXBULL",21,0)
 ; XMINSTR("FROM")  (optional) String saying from whom (default is sender)
"RTN","XMXBULL",22,0)
 ; XMINSTR("LATER") (optional) date/time to send the bulletin (default is now)
"RTN","XMXBULL",23,0)
 ; XMINSTR("VAPOR") (optional) date/time to vaporize the bulletin.
"RTN","XMXBULL",24,0)
 ;                  If supplied, it takes precedence over the bulletin's
"RTN","XMXBULL",25,0)
 ;                  RETENTION DAYS field.
"RTN","XMXBULL",26,0)
 ; XMATTACH    (in)  Array of files to attach to message
"RTN","XMXBULL",27,0)
 ;                   ("IMAGE",x) imaging (BLOB) files
"RTN","XMXBULL",28,0)
 ; Output:
"RTN","XMXBULL",29,0)
 ; XMZ      (from entry SENDBULL only) Message number if successful
"RTN","XMXBULL",30,0)
 ; XMTASK   (from entry TASKBULL only) Task number (ZTSK) if successful
"RTN","XMXBULL",31,0)
TASKBULL(XMDUZ,XMBNAME,XMPARM,XMBODY,XMTO,XMINSTR,XMTASK,XMATTACH) ; Tasks it
"RTN","XMXBULL",32,0)
 N XMBIEN
"RTN","XMXBULL",33,0)
 K XMERR,^TMP("XMERR",$J)
"RTN","XMXBULL",34,0)
 I XMDUZ=.6 D ERRSET^XMXUTIL(39321) Q  ;SHARED,MAIL may not send a bulletin.
"RTN","XMXBULL",35,0)
 S XMBIEN=$O(^XMB(3.6,"B",XMBNAME,""))
"RTN","XMXBULL",36,0)
 D BULLETIN^XMKPO(XMDUZ,XMBNAME,XMBIEN,.XMPARM,.XMBODY,.XMTO,.XMINSTR,.XMTASK,.XMATTACH)
"RTN","XMXBULL",37,0)
 Q
"RTN","XMXBULL",38,0)
TASK ; TaskMan uses this entry point, and supplies variables:
"RTN","XMXBULL",39,0)
 ; XMDUZ,XMBIEN,XMPARM,XMBODY,XMTO,XMINSTR,XMATTACH
"RTN","XMXBULL",40,0)
 N XMZ
"RTN","XMXBULL",41,0)
 K XMERR,^TMP("XMERR",$J)
"RTN","XMXBULL",42,0)
 D SEND(XMDUZ,XMBIEN,.XMPARM,.XMBODY,.XMTO,.XMINSTR,.XMZ,.XMATTACH)
"RTN","XMXBULL",43,0)
 S ZTREQ="@"
"RTN","XMXBULL",44,0)
 Q
"RTN","XMXBULL",45,0)
SENDBULL(XMDUZ,XMBNAME,XMPARM,XMBODY,XMTO,XMINSTR,XMZ,XMATTACH) ; Does it now
"RTN","XMXBULL",46,0)
 N XMBIEN
"RTN","XMXBULL",47,0)
 K XMERR,^TMP("XMERR",$J)
"RTN","XMXBULL",48,0)
 I XMDUZ=.6 D ERRSET^XMXUTIL(39321) Q  ;SHARED,MAIL may not send a bulletin.
"RTN","XMXBULL",49,0)
 S XMBIEN=$O(^XMB(3.6,"B",XMBNAME,""))
"RTN","XMXBULL",50,0)
 D SEND(XMDUZ,XMBIEN,.XMPARM,.XMBODY,.XMTO,.XMINSTR,.XMZ,.XMATTACH)
"RTN","XMXBULL",51,0)
 Q
"RTN","XMXBULL",52,0)
SEND(XMDUZ,XMBIEN,XMPARM,XMBODY,XMTO,XMINSTR,XMZ,XMATTACH) ; Create and send the bulletin
"RTN","XMXBULL",53,0)
 N XMREC,XMSUBJ,XMVDAYS
"RTN","XMXBULL",54,0)
 S XMREC=^XMB(3.6,XMBIEN,0)
"RTN","XMXBULL",55,0)
 S XMSUBJ=$$SUBJECT($P(XMREC,U,2),.XMPARM) Q:$D(XMERR)
"RTN","XMXBULL",56,0)
 S XMVDAYS=$P(XMREC,U,3)
"RTN","XMXBULL",57,0)
 I XMVDAYS,'$D(XMINSTR("VAPOR")) D
"RTN","XMXBULL",58,0)
 . S XMINSTR("VAPOR")=$$FMADD^XLFDT(DT,XMVDAYS)
"RTN","XMXBULL",59,0)
 E  K XMVDAYS
"RTN","XMXBULL",60,0)
 D CRE8XMZ^XMXSEND(XMSUBJ,.XMZ) Q:$D(XMERR)
"RTN","XMXBULL",61,0)
 D:$G(XMINSTR("ADDR FLAGS"))'["I" INIT^XMXADDR
"RTN","XMXBULL",62,0)
 D BULLADDR(XMDUZ,XMBIEN,.XMINSTR)
"RTN","XMXBULL",63,0)
 D CHKADDR^XMXADDR(XMDUZ,.XMTO,.XMINSTR)
"RTN","XMXBULL",64,0)
 I '$$GOTADDR^XMXADDR D  Q
"RTN","XMXBULL",65,0)
 . D CLEANUP^XMXADDR
"RTN","XMXBULL",66,0)
 . D ERRSET^XMXUTIL(39320) ;No addressees.  Bulletin not sent.
"RTN","XMXBULL",67,0)
 . D KILLMSG^XMXUTIL(XMZ)
"RTN","XMXBULL",68,0)
 . S XMZ=-1
"RTN","XMXBULL",69,0)
 I $P(XMREC,U,4),$G(XMINSTR("FLAGS"))'["P" S XMINSTR("FLAGS")=$G(XMINSTR("FLAGS"))_"P"
"RTN","XMXBULL",70,0)
 D:$D(XMATTACH("IMAGE"))>9 ADDBLOB^XMXSEND(XMZ,.XMATTACH)
"RTN","XMXBULL",71,0)
 D MOVEPART^XMXSEND(XMDUZ,XMZ,.XMINSTR)
"RTN","XMXBULL",72,0)
 D MOVEBODY^XMXSEND(XMZ,"^XMB(3.6,"_XMBIEN_",1)") ; Bulletin text
"RTN","XMXBULL",73,0)
 D DOPARMS(XMZ,.XMPARM)
"RTN","XMXBULL",74,0)
 I $G(XMBODY)'="",$D(@XMBODY)>9,$O(@XMBODY@(0)) D MOVEBODY^XMXSEND(XMZ,XMBODY,"A") ; Append the text (no parm translation)
"RTN","XMXBULL",75,0)
 I $E(XMREC,1,2)="XM" D CHKNONVF(XMZ,$P(XMREC,U))
"RTN","XMXBULL",76,0)
 D SEND^XMKP(XMDUZ,XMZ)
"RTN","XMXBULL",77,0)
 I $D(XMVDAYS) K XMINSTR("VAPOR")
"RTN","XMXBULL",78,0)
 D CLEANUP^XMXADDR
"RTN","XMXBULL",79,0)
 D CHECK^XMKPL
"RTN","XMXBULL",80,0)
 Q
"RTN","XMXBULL",81,0)
BULLADDR(XMDUZ,XMBIEN,XMINSTR) ;
"RTN","XMXBULL",82,0)
 N XMGIEN,XMGROUP
"RTN","XMXBULL",83,0)
 S XMGIEN=""
"RTN","XMXBULL",84,0)
 F  S XMGIEN=$O(^XMB(3.6,XMBIEN,2,"B",XMGIEN)) Q:XMGIEN=""  D
"RTN","XMXBULL",85,0)
 . S XMGROUP="G."_$P($G(^XMB(3.8,XMGIEN,0)),U,1)
"RTN","XMXBULL",86,0)
 . D:XMGROUP]"G." CHKADDR^XMXADDR(XMDUZ,XMGROUP,.XMINSTR)
"RTN","XMXBULL",87,0)
 Q
"RTN","XMXBULL",88,0)
SUBJECT(XMSUBJ,XMPARM) ;
"RTN","XMXBULL",89,0)
 D:XMSUBJ["|" FILL(.XMSUBJ,.XMPARM)
"RTN","XMXBULL",90,0)
 I $L(XMSUBJ)<3 S XMSUBJ=XMSUBJ_"..."
"RTN","XMXBULL",91,0)
 I $L(XMSUBJ)>65 S XMSUBJ=$E(XMSUBJ,1,65)
"RTN","XMXBULL",92,0)
 Q $$XMSUBJ^XMXPARM("XMSUBJ",XMSUBJ)
"RTN","XMXBULL",93,0)
DOPARMS(XMZ,XMPARM) ;
"RTN","XMXBULL",94,0)
 N I,XMLINE
"RTN","XMXBULL",95,0)
 S I=0
"RTN","XMXBULL",96,0)
 F  S I=$O(^XMB(3.9,XMZ,2,I)) Q:I=""  D
"RTN","XMXBULL",97,0)
 . Q:^XMB(3.9,XMZ,2,I,0)'["|"
"RTN","XMXBULL",98,0)
 . S XMLINE=^XMB(3.9,XMZ,2,I,0)
"RTN","XMXBULL",99,0)
 . D:XMLINE["|" FILL(.XMLINE,.XMPARM)
"RTN","XMXBULL",100,0)
 . S ^XMB(3.9,XMZ,2,I,0)=XMLINE
"RTN","XMXBULL",101,0)
 Q
"RTN","XMXBULL",102,0)
FILL(XMLINE,XMPARM) ;
"RTN","XMXBULL",103,0)
 ; This gets confused by "\027||1|, your Help Request from, |2|,":
"RTN","XMXBULL",104,0)
 ;F  D  Q:XMLINE'["|"
"RTN","XMXBULL",105,0)
 ;. S XMLINE=$P(XMLINE,"|",1)_$G(XMPARM(+$P(XMLINE,"|",2)))_$P(XMLINE,"|",3,999)
"RTN","XMXBULL",106,0)
 ; This can handle it:
"RTN","XMXBULL",107,0)
 Q:XMLINE'?.E1"|"1.N1"|".E
"RTN","XMXBULL",108,0)
 N XML
"RTN","XMXBULL",109,0)
 S XML=""
"RTN","XMXBULL",110,0)
 F  D  Q:XMLINE'?.E1"|"1.N1"|".E
"RTN","XMXBULL",111,0)
 . I $P(XMLINE,"|",2)?1N.N S XMLINE=$P(XMLINE,"|",1)_$G(XMPARM(+$P(XMLINE,"|",2)))_$P(XMLINE,"|",3,999) Q
"RTN","XMXBULL",112,0)
 . S XML=XML_$P(XMLINE,"|",1)_"|",XMLINE=$P(XMLINE,"|",2,999)
"RTN","XMXBULL",113,0)
 S XMLINE=XML_XMLINE
"RTN","XMXBULL",114,0)
 Q
"RTN","XMXBULL",115,0)
CHKNONVF(XMZ,XMBNAME) ; (CHecK NO eNVelope From)
"RTN","XMXBULL",116,0)
 Q:$O(^TMP("XMY",$J,""),-1)'["@"
"RTN","XMXBULL",117,0)
 I XMBNAME'="XM SEND ERR RECIPIENT",XMBNAME'="XM SEND ERR MSG" Q
"RTN","XMXBULL",118,0)
 ; This is an error bulletin sent by MailMan to someone at a remote site
"RTN","XMXBULL",119,0)
 ; indicating that their message could not be delivered for some reason.
"RTN","XMXBULL",120,0)
 ; We want to make sure that the 'envelope from' is null, so we pre-set
"RTN","XMXBULL",121,0)
 ; it here.  It's a little trick.
"RTN","XMXBULL",122,0)
 S $P(^XMB(3.9,XMZ,.7),U,1)="<>"
"RTN","XMXBULL",123,0)
 Q
"RTN","XMXEDIT")
0^368^B25275913
"RTN","XMXEDIT",1,0)
XMXEDIT ;ISC-SF/GMB-Edit msg that user has sent to self ;05/19/2000  13:41
"RTN","XMXEDIT",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMXEDIT",3,0)
 ; All entry points covered by DBIA 2730.
"RTN","XMXEDIT",4,0)
 ; These entry points edit a message.  They do not perform any checks to
"RTN","XMXEDIT",5,0)
 ; see whether it is appropriate to do so.  That is the responsibility
"RTN","XMXEDIT",6,0)
 ; of the calling routine.
"RTN","XMXEDIT",7,0)
 ; For these entry points, it is expected that:
"RTN","XMXEDIT",8,0)
 ; OPTMSG^XMXSEC2  has been called and has given its permission to
"RTN","XMXEDIT",9,0)
 ;                 edit the message or to toggle information only.
"RTN","XMXEDIT",10,0)
 ; OPTEDIT^XMXSEC2 has been called and has given its permission to
"RTN","XMXEDIT",11,0)
 ;                 edit the particular thing we are editing here.
"RTN","XMXEDIT",12,0)
 ; INMSG2^XMXUTIL2 has been called to set XMINSTR.  These routines expect
"RTN","XMXEDIT",13,0)
 ;                 that XMINSTR has been correctly set.  They will change
"RTN","XMXEDIT",14,0)
 ;                 XMINSTR according to the edit.
"RTN","XMXEDIT",15,0)
CLOSED(XMZ,XMINSTR,XMMSG) ; Toggle Closed msg
"RTN","XMXEDIT",16,0)
 I $D(^TMP("XMY",$J,.6)) D ERRSET^XMXUTIL(37320.6) Q  ; Messages addressed to SHARED,MAIL may not be closed
"RTN","XMXEDIT",17,0)
 D FLAGTOGL(XMZ,1.95,.XMINSTR,"X",37319.9,37320.9,.XMMSG)
"RTN","XMXEDIT",18,0)
 Q
"RTN","XMXEDIT",19,0)
CONFID(XMZ,XMINSTR,XMMSG) ; Toggle Confidential msg
"RTN","XMXEDIT",20,0)
 I $D(^TMP("XMY",$J,.6)) D ERRSET^XMXUTIL(37301.6) Q  ; Messages addressed to SHARED,MAIL may not be confidential
"RTN","XMXEDIT",21,0)
 D FLAGTOGL(XMZ,1.96,.XMINSTR,"C",37301.9,37302.9,.XMMSG)
"RTN","XMXEDIT",22,0)
 Q
"RTN","XMXEDIT",23,0)
CONFIRM(XMZ,XMINSTR,XMMSG) ; Toggle Confirm receipt of msg
"RTN","XMXEDIT",24,0)
 D FLAGTOGL(XMZ,1.3,.XMINSTR,"R",37313.9,37314.9,.XMMSG)
"RTN","XMXEDIT",25,0)
 Q
"RTN","XMXEDIT",26,0)
DELIVER(XMZ,XMDBSKT,XMINSTR,XMMSG) ; Delivery basket
"RTN","XMXEDIT",27,0)
 I XMDBSKT="@" D  Q
"RTN","XMXEDIT",28,0)
 . K XMINSTR("RCPT BSKT")
"RTN","XMXEDIT",29,0)
 . S XMFDA(3.9,XMZ_",",21)="@"
"RTN","XMXEDIT",30,0)
 . D FILE^DIE("","XMFDA")
"RTN","XMXEDIT",31,0)
 . S XMMSG=$$EZBLD^DIALOG(37304.9) ; Delivery basket removed
"RTN","XMXEDIT",32,0)
 S XMINSTR("RCPT BSKT")=XMDBSKT
"RTN","XMXEDIT",33,0)
 S XMFDA(3.9,XMZ_",",21)=XMINSTR("RCPT BSKT")
"RTN","XMXEDIT",34,0)
 D FILE^DIE("","XMFDA")
"RTN","XMXEDIT",35,0)
 S XMMSG=$$EZBLD^DIALOG(37303.9) ; Delivery basket set
"RTN","XMXEDIT",36,0)
 Q
"RTN","XMXEDIT",37,0)
INFO(XMZ,XMINSTR,XMMSG) ; Toggle Information only msg
"RTN","XMXEDIT",38,0)
 D FLAGTOGL(XMZ,1.97,.XMINSTR,"I",37307.9,37308.9,.XMMSG)
"RTN","XMXEDIT",39,0)
 Q
"RTN","XMXEDIT",40,0)
NETSIG(XMDUZ,XMZ,XMINSTR,XMMSG) ; Add Network Signature
"RTN","XMXEDIT",41,0)
 N I,XMNSIG
"RTN","XMXEDIT",42,0)
 S XMNSIG(.1)=""
"RTN","XMXEDIT",43,0)
 S XMNSIG(.2)=""
"RTN","XMXEDIT",44,0)
 S XMNSIG(.3)=$$REPEAT^XLFSTR("-",79)
"RTN","XMXEDIT",45,0)
 S XMNSIG=$G(^XMB(3.7,XMDUZ,"NS1"))
"RTN","XMXEDIT",46,0)
 F I=1:1:3 S:$P(XMNSIG,U,I)'="" XMNSIG(I)=$P(XMNSIG,U,I)
"RTN","XMXEDIT",47,0)
 N XMABORT
"RTN","XMXEDIT",48,0)
 I $D(^XMB(3.9,XMZ,"K")) D  Q:XMABORT
"RTN","XMXEDIT",49,0)
 . ; If XMSECURE does not exist, then XMINSTR("SCR KEY") must hold the
"RTN","XMXEDIT",50,0)
 . ; correct scramble key.
"RTN","XMXEDIT",51,0)
 . I '$D(XMSECURE) N XMSECURE
"RTN","XMXEDIT",52,0)
 . I '$D(XMSECURE),'$$GOODKEY^XMJMCODE(XMZ,XMINSTR("SCR KEY")) D  Q
"RTN","XMXEDIT",53,0)
 . . D ERRSET^XMXUTIL(34623) ; The key is not correct.
"RTN","XMXEDIT",54,0)
 . . S XMABORT=1
"RTN","XMXEDIT",55,0)
 . S XMABORT=0
"RTN","XMXEDIT",56,0)
 . S I=0
"RTN","XMXEDIT",57,0)
 . F  S I=$O(XMNSIG(I)) Q:'I  S XMNSIG(I)=$$ENCSTR^XMJMCODE(XMNSIG(I))
"RTN","XMXEDIT",58,0)
 D MOVEBODY^XMXSEND(XMZ,"XMNSIG","A") ; Add the network signature
"RTN","XMXEDIT",59,0)
 S XMMSG=$$EZBLD^DIALOG(37309.9) ; Network Signature added
"RTN","XMXEDIT",60,0)
 Q
"RTN","XMXEDIT",61,0)
PRIORITY(XMZ,XMINSTR,XMMSG) ; Toggle Priority msg
"RTN","XMXEDIT",62,0)
 D FLAGTOGL(XMZ,1.7,.XMINSTR,"P",37311.9,37312.9,.XMMSG)
"RTN","XMXEDIT",63,0)
 Q
"RTN","XMXEDIT",64,0)
SCRAMBLE(XMZ,XMINSTR,XMMSG) ; Scramble or Unscramble the message text
"RTN","XMXEDIT",65,0)
 N XMFDA,XMIENS
"RTN","XMXEDIT",66,0)
 S XMIENS=XMZ_","
"RTN","XMXEDIT",67,0)
 I $D(^XMB(3.9,XMZ,"K")) D  Q
"RTN","XMXEDIT",68,0)
 . ; Unscramble the text.
"RTN","XMXEDIT",69,0)
 . ; If XMSECURE does not exist, then XMINSTR("SCR KEY") must hold the
"RTN","XMXEDIT",70,0)
 . ; correct scramble key.
"RTN","XMXEDIT",71,0)
 . I '$D(XMSECURE),'$$GOODKEY^XMJMCODE(XMZ,XMINSTR("SCR KEY")) D ERRSET^XMXUTIL(34623) Q  ; The key is not correct.
"RTN","XMXEDIT",72,0)
 . S XMFDA(3.9,XMIENS,1.8)="@"
"RTN","XMXEDIT",73,0)
 . S XMFDA(3.9,XMIENS,1.85)="@"
"RTN","XMXEDIT",74,0)
 . D FILE^DIE("","XMFDA")
"RTN","XMXEDIT",75,0)
 . D DECMSG^XMJMCODE(XMZ)
"RTN","XMXEDIT",76,0)
 . K XMSECURE,XMINSTR("SCR KEY"),XMINSTR("SCR HINT"),^XMB(3.9,XMZ,"K")
"RTN","XMXEDIT",77,0)
 . S XMMSG=$$EZBLD^DIALOG(37316.9) ; Message text UnScrambled
"RTN","XMXEDIT",78,0)
 ; Check the key and hint
"RTN","XMXEDIT",79,0)
 D XMKEY^XMXPARM1($G(XMINSTR("SCR KEY")))
"RTN","XMXEDIT",80,0)
 D:$G(XMINSTR("SCR HINT"))'="" XMHINT^XMXPARM1(XMINSTR("SCR HINT"))
"RTN","XMXEDIT",81,0)
 Q:$D(XMERR)
"RTN","XMXEDIT",82,0)
 ; Scramble the text.
"RTN","XMXEDIT",83,0)
 N XMKEY
"RTN","XMXEDIT",84,0)
 K XMSECURE
"RTN","XMXEDIT",85,0)
 S XMFDA(3.9,XMIENS,1.8)=$S($G(XMINSTR("SCR HINT"))="":" ",1:XMINSTR("SCR HINT"))
"RTN","XMXEDIT",86,0)
 D LOADCODE^XMJMCODE ; XMSECURE is created here
"RTN","XMXEDIT",87,0)
 S XMKEY=XMINSTR("SCR KEY")
"RTN","XMXEDIT",88,0)
 D ADJUST^XMJMCODE(.XMKEY) ; XMSECURE is adjusted here
"RTN","XMXEDIT",89,0)
 S XMFDA(3.9,XMIENS,1.85)="1"_$$ENCSTR^XMJMCODE(XMKEY)
"RTN","XMXEDIT",90,0)
 D ENCMSG^XMJMCODE(XMZ)
"RTN","XMXEDIT",91,0)
 D FILE^DIE("","XMFDA")
"RTN","XMXEDIT",92,0)
 S XMMSG=$$EZBLD^DIALOG(37315.9) ; Message text Scrambled
"RTN","XMXEDIT",93,0)
 Q
"RTN","XMXEDIT",94,0)
SUBJ(XMZ,XMSUBJ,XMIM) ; Replace Subject
"RTN","XMXEDIT",95,0)
 S XMSUBJ=$$XMSUBJ^XMXPARM("XMSUBJ",$G(XMSUBJ)) Q:$D(XMERR)
"RTN","XMXEDIT",96,0)
 S (XMIM("SUBJ"),XMFDA(3.9,XMZ_",",.01))=$$ENCODEUP^XMXUTIL1(XMSUBJ)
"RTN","XMXEDIT",97,0)
 D FILE^DIE("","XMFDA")
"RTN","XMXEDIT",98,0)
 Q
"RTN","XMXEDIT",99,0)
TEXT(XMZ,XMBODY) ; Replace Text
"RTN","XMXEDIT",100,0)
 D WP^DIE(3.9,XMZ_",",3,"",XMBODY)
"RTN","XMXEDIT",101,0)
 Q
"RTN","XMXEDIT",102,0)
VAPOR(XMZ,XMVAPOR,XMINSTR,XMMSG) ; Vaporize date
"RTN","XMXEDIT",103,0)
 I XMVAPOR="@" D  Q
"RTN","XMXEDIT",104,0)
 . K XMINSTR("VAPOR")
"RTN","XMXEDIT",105,0)
 . S XMFDA(3.9,XMZ_",",1.6)="@"
"RTN","XMXEDIT",106,0)
 . D FILE^DIE("","XMFDA")
"RTN","XMXEDIT",107,0)
 . S XMMSG=$$EZBLD^DIALOG(37318.9) ; Vaporize Date removed
"RTN","XMXEDIT",108,0)
 S XMINSTR("VAPOR")=XMVAPOR
"RTN","XMXEDIT",109,0)
 S XMFDA(3.9,XMZ_",",1.6)=XMINSTR("VAPOR")
"RTN","XMXEDIT",110,0)
 D FILE^DIE("","XMFDA")
"RTN","XMXEDIT",111,0)
 S XMMSG=$$EZBLD^DIALOG(37317.9) ; Vaporize Date set
"RTN","XMXEDIT",112,0)
 Q
"RTN","XMXEDIT",113,0)
FLAGTOGL(XMZ,XMFIELD,XMINSTR,XMFLAG,XMSET,XMREMOVE,XMMSG) ; Flag Toggle (For internal MM use only!)
"RTN","XMXEDIT",114,0)
 N XMFDA
"RTN","XMXEDIT",115,0)
 I $G(XMINSTR("FLAGS"))[XMFLAG D
"RTN","XMXEDIT",116,0)
 . S XMINSTR("FLAGS")=$TR(XMINSTR("FLAGS"),XMFLAG)
"RTN","XMXEDIT",117,0)
 . S XMMSG=$$EZBLD^DIALOG(XMREMOVE)
"RTN","XMXEDIT",118,0)
 . I XMFLAG="P" D
"RTN","XMXEDIT",119,0)
 . . S XMFDA(3.9,XMZ_",",XMFIELD)=$S($G(XMINSTR("TYPE"))="":"@",1:XMINSTR("TYPE"))
"RTN","XMXEDIT",120,0)
 . E  S XMFDA(3.9,XMZ_",",XMFIELD)="@"
"RTN","XMXEDIT",121,0)
 E  D
"RTN","XMXEDIT",122,0)
 . S XMINSTR("FLAGS")=$G(XMINSTR("FLAGS"))_XMFLAG
"RTN","XMXEDIT",123,0)
 . S XMMSG=$$EZBLD^DIALOG(XMSET)
"RTN","XMXEDIT",124,0)
 . I XMFLAG="P" S XMFDA(3.9,XMZ_",",XMFIELD)=$G(XMINSTR("TYPE"))_"P"
"RTN","XMXEDIT",125,0)
 . E  S XMFDA(3.9,XMZ_",",XMFIELD)="y"
"RTN","XMXEDIT",126,0)
 D FILE^DIE("","XMFDA")
"RTN","XMXEDIT",127,0)
 Q
"RTN","XMXGRP")
0^228^B53414420
"RTN","XMXGRP",1,0)
XMXGRP ;ISC-SF/GMB-Group creation/enrollment ;04/11/2002  10:42
"RTN","XMXGRP",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMXGRP",3,0)
 ; Entry points used by MailMan options (not covered by DBIA):
"RTN","XMXGRP",4,0)
 ; ADDMBRS - Add new members / Edit existing members
"RTN","XMXGRP",5,0)
 ; DELMBRS - Delete existing members
"RTN","XMXGRP",6,0)
 ; DROP    - A user chooses to drop
"RTN","XMXGRP",7,0)
 ; JOIN    - A user chooses to join
"RTN","XMXGRP",8,0)
ADDMBRS(XMDUZ,XMGROUP,XMMBR,XMINSTR,XMTSK) ; Add users to groups, if they aren't
"RTN","XMXGRP",9,0)
 ; already members.  This API handles adding local users, devices,
"RTN","XMXGRP",10,0)
 ; server options, mail groups, and remote users to mail groups.
"RTN","XMXGRP",11,0)
 ; It does not handle adding distribution lists or fax recipients
"RTN","XMXGRP",12,0)
 ; or fax groups.
"RTN","XMXGRP",13,0)
 ; 
"RTN","XMXGRP",14,0)
 ; Optionally, forward existing messages which are addressed to the
"RTN","XMXGRP",15,0)
 ; groups to the users, and/or add the users to the messages, so that
"RTN","XMXGRP",16,0)
 ; they will receive responses.  (LOCAL USERS ONLY!)
"RTN","XMXGRP",17,0)
 ; XMDUZ   - The user who is doing this.  Must be authorized to edit
"RTN","XMXGRP",18,0)
 ;           the mail groups.
"RTN","XMXGRP",19,0)
 ; XMGROUP - The name or IEN (or list of same) of the groups.
"RTN","XMXGRP",20,0)
 ; XMMBR   - The user (or list of users) to add to the groups.
"RTN","XMXGRP",21,0)
 ; XMINSTR - Special instructions
"RTN","XMXGRP",22,0)
 ;     ("FLAGS") - Flags, may contain any combination of the following:
"RTN","XMXGRP",23,0)
 ;                 "A" - Add users to messages, but don't forward.
"RTN","XMXGRP",24,0)
 ;                       (Messages will be delivered the next time
"RTN","XMXGRP",25,0)
 ;                       someone replies, and users will be able to
"RTN","XMXGRP",26,0)
 ;                       Query/Search for them at any time.)
"RTN","XMXGRP",27,0)
 ;                 "F" - Forward messages to users, if the users aren't
"RTN","XMXGRP",28,0)
 ;                       already on the messages.
"RTN","XMXGRP",29,0)
 ;                 Closed messages will be ignored.  Users will not be
"RTN","XMXGRP",30,0)
 ;                 added to them.
"RTN","XMXGRP",31,0)
 ; Note: If FLAGS contains only an "A", then FDATE and TDATE apply.
"RTN","XMXGRP",32,0)
 ;       If FLAGS contains only an "F", then FDATE and TDATE apply.
"RTN","XMXGRP",33,0)
 ;       If FLAGS contains "A" and "F", then messages from FDATE thru
"RTN","XMXGRP",34,0)
 ;       TDATE will be "F"orwarded, and all other messages will have
"RTN","XMXGRP",35,0)
 ;       the users "A"dded to them, without forwarding.
"RTN","XMXGRP",36,0)
 ; Note: Currently, FLAGS may not contain "A".  We don't yet have a way
"RTN","XMXGRP",37,0)
 ; to mark users (recipients) who have been added to a message, but will
"RTN","XMXGRP",38,0)
 ; not receive them until someone replies on the message, or until the
"RTN","XMXGRP",39,0)
 ; user searches for them and reads them.  This is a problem, because
"RTN","XMXGRP",40,0)
 ; if someone does a QD on them, they have no idea why these recipients
"RTN","XMXGRP",41,0)
 ; haven't read the message.  Perhaps we could mark them 'Parked until
"RTN","XMXGRP",42,0)
 ; next reply.'  That would require a new field, and other routines would
"RTN","XMXGRP",43,0)
 ; have to be aware of and handle this new field.  Until that happens,
"RTN","XMXGRP",44,0)
 ; we are stripping any "A" from XMINSTR("FLAGS").
"RTN","XMXGRP",45,0)
 ;     ("FDATE") - Add users to messages originating on or after this
"RTN","XMXGRP",46,0)
 ;                 date.  Must be FM format.  Default is from the
"RTN","XMXGRP",47,0)
 ;                 beginning of time.  Used in conjunction with FLAGS.
"RTN","XMXGRP",48,0)
 ;     ("TDATE") - Add users to messages originating on or before this
"RTN","XMXGRP",49,0)
 ;                 date.  Must be FM format.  Default is to the present.
"RTN","XMXGRP",50,0)
 ;                 Used in conjunction with FLAGS.
"RTN","XMXGRP",51,0)
 ; XMTSK           Output task number
"RTN","XMXGRP",52,0)
 N XMGRP,XMTO,XMCUT
"RTN","XMXGRP",53,0)
 D CHKGRPS(XMDUZ,.XMGROUP,.XMGRP) Q:'$D(XMGRP)
"RTN","XMXGRP",54,0)
 D CHKMBRS(XMDUZ,.XMMBR) Q:'$D(^TMP("XMY0",$J))
"RTN","XMXGRP",55,0)
 D ADD2GRPS(.XMGRP,.XMTO,.XMINSTR)
"RTN","XMXGRP",56,0)
 Q:'$D(XMTO)  ; Quit if no local users added to groups.
"RTN","XMXGRP",57,0)
 Q:'$D(XMINSTR("FLAGS"))
"RTN","XMXGRP",58,0)
 I $G(XMINSTR("FDATE"),$O(^XMB(3.9,"C",2500000)))>$G(XMINSTR("TDATE"),DT) Q  ; Quit if 'from' date is greater than 'to' date.
"RTN","XMXGRP",59,0)
 S XMCUT=$P(^XMB(3.7,XMDUZ,0),U,7)
"RTN","XMXGRP",60,0)
 I XMCUT>$G(XMINSTR("FDATE")) D
"RTN","XMXGRP",61,0)
 . S XMINSTR("FDATE")=XMCUT
"RTN","XMXGRP",62,0)
 . D ERRSET^XMXUTIL(37100,$$FMTE^XLFDT(XMCUT,5))
"RTN","XMXGRP",63,0)
 . ; You may not access any message prior to |1| unless someone forwards
"RTN","XMXGRP",64,0)
 . ; it to you.
"RTN","XMXGRP",65,0)
 D FAFMSGS^XMXGRP1(XMDUZ,.XMGRP,.XMTO,.XMINSTR,.XMTSK)
"RTN","XMXGRP",66,0)
 Q
"RTN","XMXGRP",67,0)
CHKGRPS(XMDUZ,XMGROUP,XMGRP) ;
"RTN","XMXGRP",68,0)
 I $G(XMGROUP)]"",$O(XMGROUP(""))="" D  Q
"RTN","XMXGRP",69,0)
 . D CHKGRP(XMDUZ,XMGROUP,.XMGRP)
"RTN","XMXGRP",70,0)
 N XMI
"RTN","XMXGRP",71,0)
 S XMI=""
"RTN","XMXGRP",72,0)
 F  S XMI=$O(XMGROUP(XMI)) Q:XMI=""  D
"RTN","XMXGRP",73,0)
 . D CHKGRP(XMDUZ,XMI,.XMGRP)
"RTN","XMXGRP",74,0)
 Q
"RTN","XMXGRP",75,0)
CHKGRP(XMDUZ,XMGROUP,XMGRP) ;
"RTN","XMXGRP",76,0)
 N XMGNAME,XMGIEN,XMABORT
"RTN","XMXGRP",77,0)
 S XMABORT=0
"RTN","XMXGRP",78,0)
 D GRPOK(XMGROUP,.XMGNAME,.XMGIEN,.XMABORT) Q:XMABORT
"RTN","XMXGRP",79,0)
 D AUTHOK(XMDUZ,.XMGIEN,.XMABORT) Q:XMABORT
"RTN","XMXGRP",80,0)
 S XMGRP(XMGNAME)=XMGIEN
"RTN","XMXGRP",81,0)
 Q
"RTN","XMXGRP",82,0)
GRPOK(XMGROUP,XMGNAME,XMGIEN,XMABORT) ;
"RTN","XMXGRP",83,0)
 ; make sure group name is good, translate to group ien.
"RTN","XMXGRP",84,0)
 S XMGIEN=$$IEN^XMXAPIG(XMGROUP) I 'XMGIEN S XMABORT=1 Q
"RTN","XMXGRP",85,0)
 S XMGNAME=$$NAME^XMXAPIG(XMGIEN)
"RTN","XMXGRP",86,0)
 Q
"RTN","XMXGRP",87,0)
AUTHOK(XMDUZ,XMGIEN,XMABORT) ;
"RTN","XMXGRP",88,0)
 ; make sure user is authorized to add members to group.
"RTN","XMXGRP",89,0)
 N XMOK
"RTN","XMXGRP",90,0)
 S XMOK=0
"RTN","XMXGRP",91,0)
 I $T(ISA^USRLM)'="" S XMOK=$$ISA^USRLM(DUZ,"CLINICAL COORDINATOR") ; CAC?
"RTN","XMXGRP",92,0)
 I $D(^XUSEC("XMMGR",DUZ))!$D(^XUSEC("XM GROUP EDIT MASTER",DUZ))!XMOK I $S($P(^XMB(3.8,XMGIEN,0),U,2)="PU":1,'$P(^(0),U,6):1,1:0) Q  ; If holds proper key, then group must be public or (private and) unrestricted.
"RTN","XMXGRP",93,0)
 I $D(^XMB(3.8,"AC",XMDUZ,XMGIEN)) Q  ; User is coordinator
"RTN","XMXGRP",94,0)
 I $P($G(^XMB(3.8,XMGIEN,3)),U,1)=XMDUZ Q  ; User is organizer
"RTN","XMXGRP",95,0)
 S XMABORT=1
"RTN","XMXGRP",96,0)
 N XMP
"RTN","XMXGRP",97,0)
 S XMP("PARAM","ID")="XMGROUP"
"RTN","XMXGRP",98,0)
 S XMP("PARAM","VALUE")=$$NAME^XMXAPIG(XMGIEN)
"RTN","XMXGRP",99,0)
 ; You are not authorized to edit this mail group
"RTN","XMXGRP",100,0)
 D ERRSET^XMXUTIL(38200,.XMP)
"RTN","XMXGRP",101,0)
 Q
"RTN","XMXGRP",102,0)
CHKMBRS(XMDUZ,XMMBR) ; Check the users to add.
"RTN","XMXGRP",103,0)
 N XMINSTR
"RTN","XMXGRP",104,0)
 D INIT^XMXADDR
"RTN","XMXGRP",105,0)
 S XMINSTR("ADDR FLAGS")="XY" ; Create only the ^TMP("XMY0") global.
"RTN","XMXGRP",106,0)
 D CHKADDR^XMXADDR(XMDUZ,.XMMBR,.XMINSTR)
"RTN","XMXGRP",107,0)
 Q:$D(^TMP("XMY0",$J))
"RTN","XMXGRP",108,0)
 D CLEANUP^XMXADDR
"RTN","XMXGRP",109,0)
 Q
"RTN","XMXGRP",110,0)
ADD2GRPS(XMGRP,XMTO,XMINSTR) ; See if members already in the groups.
"RTN","XMXGRP",111,0)
 ; If not, add them
"RTN","XMXGRP",112,0)
 ; >> Question: May a broadcast or limited broadcast be added to a group?
"RTN","XMXGRP",113,0)
 N XMGN,XMGI,XMM,XMTRKNEW
"RTN","XMXGRP",114,0)
 S (XMGN,XMM)=""
"RTN","XMXGRP",115,0)
 F  S XMGN=$O(XMGRP(XMGN)) Q:XMGN=""  S XMGI=XMGRP(XMGN) D
"RTN","XMXGRP",116,0)
 . N XMNEWMBR
"RTN","XMXGRP",117,0)
 . F  S XMM=$O(^TMP("XMY0",$J,XMM)) Q:XMM=""  D
"RTN","XMXGRP",118,0)
 . . D AM(XMGI,XMM,^TMP("XMY0",$J,XMM),$G(^(XMM,1),"@"),.XMTO,.XMINSTR)
"RTN","XMXGRP",119,0)
 ; If we added a member group, shouldn't we also forward the msgs to
"RTN","XMXGRP",120,0)
 ; local members of the group, too?
"RTN","XMXGRP",121,0)
 D CLEANUP^XMXADDR
"RTN","XMXGRP",122,0)
 Q
"RTN","XMXGRP",123,0)
AM(XMG,XMM,XMMIEN,XMTYPE,XMTO,XMINSTR) ; Add/edit a member (not delete)
"RTN","XMXGRP",124,0)
 N XMFDA,XMIEN,XMMULT,XMABORT
"RTN","XMXGRP",125,0)
 S XMABORT=0
"RTN","XMXGRP",126,0)
 D AMINIT(XMG,.XMM,XMMIEN,.XMMULT,.XMABORT) Q:$G(XMABORT)
"RTN","XMXGRP",127,0)
 S XMFDA(XMMULT,"?+1,"_XMG_",",.01)=XMM
"RTN","XMXGRP",128,0)
 S XMFDA(XMMULT,"?+1,"_XMG_",",1)=XMTYPE
"RTN","XMXGRP",129,0)
 I "AF"[$G(XMINSTR("FLAGS"),U),XMMULT=3.81 S XMTO($S(XMTYPE?1U:XMTYPE_":",1:"")_XMM)=""
"RTN","XMXGRP",130,0)
 D UPDATE^DIE("","XMFDA","XMIEN")
"RTN","XMXGRP",131,0)
 ;I XMIEN(1,0)="+" S XMCNT=$G(XMCNT)+1
"RTN","XMXGRP",132,0)
 ; Need to create array showing which were added and which were edited.
"RTN","XMXGRP",133,0)
 ; Counts for each.
"RTN","XMXGRP",134,0)
 Q
"RTN","XMXGRP",135,0)
AMINIT(XMG,XMM,XMMIEN,XMMULT,XMABORT) ;
"RTN","XMXGRP",136,0)
 I XMM["@" S XMMULT=3.813 Q  ; Remote member
"RTN","XMXGRP",137,0)
 I ".D.H.S."[("."_$E(XMM,1,2)) D  Q
"RTN","XMXGRP",138,0)
 . S XMMULT=3.813 ; Remote member
"RTN","XMXGRP",139,0)
 . S XMM=XMM_"@"_^XMB("NETNAME")
"RTN","XMXGRP",140,0)
 I $E(XMM,1,2)="G." D  Q
"RTN","XMXGRP",141,0)
 . I XMMIEN=XMG D  Q
"RTN","XMXGRP",142,0)
 . . S XMABORT=1
"RTN","XMXGRP",143,0)
 . . ; Group cannot be a member of itself.
"RTN","XMXGRP",144,0)
 . S XMM=XMMIEN
"RTN","XMXGRP",145,0)
 . S XMMULT=3.811 ; Group member
"RTN","XMXGRP",146,0)
 S XMM=XMMIEN
"RTN","XMXGRP",147,0)
 S XMMULT=3.81 ; Local member
"RTN","XMXGRP",148,0)
 Q
"RTN","XMXGRP",149,0)
JOIN(XMDUZ,XMGROUP,XMINSTR,XMTSK) ; User chooses to join a group.
"RTN","XMXGRP",150,0)
 ; XMGROUP - The name (or IEN) of the group. (Just one group!)
"RTN","XMXGRP",151,0)
 ; XMINSTR - Special instructions.  See ADDMBR, above
"RTN","XMXGRP",152,0)
 ;           Also, if XMINSTR("FLAGS")["F", may specify:
"RTN","XMXGRP",153,0)
 ;     ("SELF BSKT") - direct forwarded messages to a specific basket.
"RTN","XMXGRP",154,0)
 N XMABORT,XMGNAME,XMGIEN,XMTYPE,XMSELF,XMMBR
"RTN","XMXGRP",155,0)
 S XMABORT=0
"RTN","XMXGRP",156,0)
 D GRPOK(XMGROUP,.XMGNAME,.XMGIEN,.XMABORT) Q:XMABORT
"RTN","XMXGRP",157,0)
 D GRPINFO(XMDUZ,XMGIEN,.XMTYPE,.XMSELF,.XMMBR,.XMABORT) Q:XMABORT
"RTN","XMXGRP",158,0)
 I 'XMMBR D  Q:XMABORT
"RTN","XMXGRP",159,0)
 . I 'XMSELF D  Q
"RTN","XMXGRP",160,0)
 . . S XMABORT=1
"RTN","XMXGRP",161,0)
 . . N XMP
"RTN","XMXGRP",162,0)
 . . S XMP("PARAM","ID")="XMGROUP"
"RTN","XMXGRP",163,0)
 . . S XMP("PARAM","VALUE")=XMGNAME
"RTN","XMXGRP",164,0)
 . . D ERRSET^XMXUTIL(38022,.XMP) ; Self enrollment not allowed.
"RTN","XMXGRP",165,0)
 . N XMFDA ; Add user to group.
"RTN","XMXGRP",166,0)
 . S XMFDA(3.81,"?+1,"_XMGIEN_",",.01)=XMDUZ
"RTN","XMXGRP",167,0)
 . D UPDATE^DIE("","XMFDA")
"RTN","XMXGRP",168,0)
 Q:'$D(XMINSTR("FLAGS"))
"RTN","XMXGRP",169,0)
 D FAFMSGS^XMXGRP1(XMDUZ,XMGNAME,XMDUZ,.XMINSTR,.XMTSK)
"RTN","XMXGRP",170,0)
 Q
"RTN","XMXGRP",171,0)
DROP(XMDUZ,XMGROUP) ; User chooses to drop from a group.
"RTN","XMXGRP",172,0)
 ; XMGROUP - The name (or IEN) of the group.
"RTN","XMXGRP",173,0)
 N XMABORT,XMGNAME,XMGIEN,XMTYPE,XMSELF,XMMBR
"RTN","XMXGRP",174,0)
 S XMABORT=0
"RTN","XMXGRP",175,0)
 D GRPOK(XMGROUP,.XMGNAME,.XMGIEN,.XMABORT) Q:XMABORT
"RTN","XMXGRP",176,0)
 D GRPINFO(XMDUZ,XMGIEN,.XMTYPE,.XMSELF,.XMMBR,.XMABORT) Q:XMABORT
"RTN","XMXGRP",177,0)
 I XMMBR D
"RTN","XMXGRP",178,0)
 . I 'XMSELF,'$P($G(^XMB(1,1,2)),U,2) D  Q
"RTN","XMXGRP",179,0)
 . . S XMABORT=1
"RTN","XMXGRP",180,0)
 . . N XMP
"RTN","XMXGRP",181,0)
 . . S XMP("PARAM","ID")="XMGROUP"
"RTN","XMXGRP",182,0)
 . . S XMP("PARAM","VALUE")=XMGNAME
"RTN","XMXGRP",183,0)
 . . D ERRSET^XMXUTIL(38022.1,.XMP) ; Self dis-enrollment not allowed.
"RTN","XMXGRP",184,0)
 . N DIR,X,Y,DA,DIK ; Drop user from group.
"RTN","XMXGRP",185,0)
 . S DA(1)=XMGIEN,DA=XMMBR,DIK="^XMB(3.8,"_XMGIEN_",1,"
"RTN","XMXGRP",186,0)
 . D ^DIK
"RTN","XMXGRP",187,0)
 Q
"RTN","XMXGRP",188,0)
GRPINFO(XMDUZ,XMGIEN,XMTYPE,XMSELF,XMMBR,XMABORT) ;
"RTN","XMXGRP",189,0)
 N XMREC
"RTN","XMXGRP",190,0)
 S XMMBR=+$O(^XMB(3.8,XMGIEN,1,"B",XMDUZ,0)) ; Is user a member?
"RTN","XMXGRP",191,0)
 S XMREC=^XMB(3.8,XMGIEN,0)
"RTN","XMXGRP",192,0)
 S XMSELF=($P(XMREC,U,3)="y") ; Self enrollment allowed?
"RTN","XMXGRP",193,0)
 S XMTYPE=$P(XMREC,U,2) ; Public or Private?
"RTN","XMXGRP",194,0)
 I XMTYPE="PU"
"RTN","XMXGRP",195,0)
 E  I XMTYPE="PR" D
"RTN","XMXGRP",196,0)
 . Q:XMMBR
"RTN","XMXGRP",197,0)
 . S XMABORT=1
"RTN","XMXGRP",198,0)
 . N XMP
"RTN","XMXGRP",199,0)
 . S XMP("PARAM","ID")="XMGROUP"
"RTN","XMXGRP",200,0)
 . S XMP("PARAM","VALUE")=$P(XMREC,U,1)
"RTN","XMXGRP",201,0)
 . D ERRSET^XMXUTIL(38201) ; Group is private.
"RTN","XMXGRP",202,0)
 ;E  D
"RTN","XMXGRP",203,0)
 ;. S XMABORT=1
"RTN","XMXGRP",204,0)
 ;. D ERRSET^XMXUTIL() ; Group must be designated as PUBLIC or PRIVATE.
"RTN","XMXGRP",205,0)
 Q
"RTN","XMXGRP",206,0)
ADD2GRPZ(XMGRP,XMMBR,XMTO) ; See if members already in the groups.
"RTN","XMXGRP",207,0)
 ; If not, add them
"RTN","XMXGRP",208,0)
 N XMGN,XMGI,XMM,XMTRKNEW
"RTN","XMXGRP",209,0)
 S (XMGN,XMM)="",XMTRKNEW=1
"RTN","XMXGRP",210,0)
 F  S XMGN=$O(XMGRP(XMGN)) Q:XMGN=""  S XMGI=XMGRP(XMGN) D
"RTN","XMXGRP",211,0)
 . N XMNEWMBR
"RTN","XMXGRP",212,0)
 . F  S XMM=$O(XMMBR(XMM)) Q:XMM=""  D
"RTN","XMXGRP",213,0)
 . . D AMZ(XMGI,XMMBR(XMM),$G(XMMBR(XMM,1),"@"),.XMTO)
"RTN","XMXGRP",214,0)
 . I $G(XMNEWMBR) D NOTIFY^XMXGRP1(XMGI,.XMNEWMBR)
"RTN","XMXGRP",215,0)
 Q
"RTN","XMXGRP",216,0)
AMZ(XMG,XMM,XMTYPE,XMTO) ; Add/edit a member (not delete)
"RTN","XMXGRP",217,0)
 N XMFDA,XMIEN
"RTN","XMXGRP",218,0)
 S XMFDA(3.81,"?+1,"_XMG_",",.01)=XMM
"RTN","XMXGRP",219,0)
 S XMFDA(3.81,"?+1,"_XMG_",",1)=XMTYPE
"RTN","XMXGRP",220,0)
 S XMTO($S(XMTYPE?1U:XMTYPE_":",1:"")_XMM)=""
"RTN","XMXGRP",221,0)
 D UPDATE^DIE("","XMFDA","XMIEN")
"RTN","XMXGRP",222,0)
 ;I XMIEN(1,0)="+" S XMCNT=$G(XMCNT)+1
"RTN","XMXGRP",223,0)
 ; Need to create array showing which were added and which were edited.
"RTN","XMXGRP",224,0)
 ; Counts for each.
"RTN","XMXGRP",225,0)
 Q
"RTN","XMXGRP1")
0^369^B31227909
"RTN","XMXGRP1",1,0)
XMXGRP1 ;ISC-SF/GMB-Group creation/enrollment (cont.) ;04/17/2002  14:10
"RTN","XMXGRP1",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMXGRP1",3,0)
FAFMSGS(XMDUZ,XMGRP,XMTO,XMINSTR,ZTSK) ; Create task to find and forward messages
"RTN","XMXGRP1",4,0)
 ; The following line can be deleted once we enable "A":
"RTN","XMXGRP1",5,0)
 S XMINSTR("FLAGS")=$TR($G(XMINSTR("FLAGS")),"A") Q:$G(XMINSTR("FLAGS"))'["F"
"RTN","XMXGRP1",6,0)
 N ZTSAVE,ZTDESC,ZTRTN,ZTDTH,ZTIO,I
"RTN","XMXGRP1",7,0)
 S ZTDESC=$$EZBLD^DIALOG(38023.8) ; MailMan: Find & Forward mail group messages
"RTN","XMXGRP1",8,0)
 S ZTIO="",ZTDTH=$H,ZTRTN="FAFTSK^XMXGRP1"
"RTN","XMXGRP1",9,0)
 F I="DUZ","XMDUZ","XMGRP*","XMTO*","XMINSTR(" S ZTSAVE(I)=""
"RTN","XMXGRP1",10,0)
 D ^%ZTLOAD
"RTN","XMXGRP1",11,0)
 Q
"RTN","XMXGRP1",12,0)
FAFTSK ; Find and add/forward messages
"RTN","XMXGRP1",13,0)
 N XMFDATE,XMTDATE,XMGROUP,XMX,XMFIRST,XMABORT
"RTN","XMXGRP1",14,0)
 S XMABORT=0
"RTN","XMXGRP1",15,0)
 D INIT Q:XMABORT
"RTN","XMXGRP1",16,0)
 D PROCESS
"RTN","XMXGRP1",17,0)
 D CLEANUP^XMXADDR
"RTN","XMXGRP1",18,0)
 K ^TMP("XM",$J,"SAVE")
"RTN","XMXGRP1",19,0)
 Q
"RTN","XMXGRP1",20,0)
PROCESS ;
"RTN","XMXGRP1",21,0)
 I XMINSTR("FLAGS")["A",XMINSTR("FLAGS")["F" D  Q  ; Forward some of the messages to the users, and add the users to the rest of the messages.
"RTN","XMXGRP1",22,0)
 . D SAVFWD(.XMX)
"RTN","XMXGRP1",23,0)
 . I XMFIRST<XMFDATE D
"RTN","XMXGRP1",24,0)
 . . D CHKADD(.XMX) Q:'$D(^TMP("XMY",$J))
"RTN","XMXGRP1",25,0)
 . . D ADDFWD(XMDUZ,.XMGROUP,"A",XMFIRST,XMFDATE-1,.XMX) ; add
"RTN","XMXGRP1",26,0)
 . . M ^TMP("XMY",$J)=^TMP("XM",$J,"SAVE")
"RTN","XMXGRP1",27,0)
 . D ADDFWD(XMDUZ,.XMGROUP,"F",XMFDATE,XMTDATE,.XMX) ; forward
"RTN","XMXGRP1",28,0)
 . I XMTDATE<DT D
"RTN","XMXGRP1",29,0)
 . . I XMX("RESTORE") M ^TMP("XMY",$J)=^TMP("XM",$J,"SAVE") S XMX("RESTORE")=0
"RTN","XMXGRP1",30,0)
 . . D CHKADD(.XMX) Q:'$D(^TMP("XMY",$J))
"RTN","XMXGRP1",31,0)
 . . D ADDFWD(XMDUZ,.XMGROUP,"A",XMTDATE+.1,DT,.XMX) ; add
"RTN","XMXGRP1",32,0)
 I XMINSTR("FLAGS")["F" D  Q  ; Just forward messages to users
"RTN","XMXGRP1",33,0)
 . D SAVFWD(.XMX)
"RTN","XMXGRP1",34,0)
 . D ADDFWD(XMDUZ,.XMGROUP,"F",XMFDATE,XMTDATE,.XMX) ; forward
"RTN","XMXGRP1",35,0)
 I XMINSTR("FLAGS")["A" D  Q  ; Just add users to messages
"RTN","XMXGRP1",36,0)
 . D CHKADD(.XMX) Q:'$D(^TMP("XMY",$J))
"RTN","XMXGRP1",37,0)
 . D ADDFWD(XMDUZ,.XMGROUP,"A",XMFDATE,XMTDATE,.XMX) ; add
"RTN","XMXGRP1",38,0)
 Q
"RTN","XMXGRP1",39,0)
INIT ;
"RTN","XMXGRP1",40,0)
 N XMPRIVAT,XMGN,XMI
"RTN","XMXGRP1",41,0)
 S ZTREQ="@"
"RTN","XMXGRP1",42,0)
 S XMPRIVAT=$$EZBLD^DIALOG(39135) ; " [Private Mail Group]"
"RTN","XMXGRP1",43,0)
 S XMFIRST=$O(^XMB(3.9,"C",2500000)) ; earliest message date (after 1950!)
"RTN","XMXGRP1",44,0)
 S XMFDATE=$G(XMINSTR("FDATE"),XMFIRST)
"RTN","XMXGRP1",45,0)
 S XMTDATE=$G(XMINSTR("TDATE"),DT)
"RTN","XMXGRP1",46,0)
 D INITAPI^XMVVITAE
"RTN","XMXGRP1",47,0)
 D INIT^XMXADDR
"RTN","XMXGRP1",48,0)
 D CHKADDR^XMXADDR(XMDUZ,.XMTO)
"RTN","XMXGRP1",49,0)
 I '$$GOTADDR^XMXADDR S XMABORT=1 Q
"RTN","XMXGRP1",50,0)
 I $G(XMGRP)]"" S XMGRP(XMGRP)=$O(^XMB(3.8,"B",XMGRP,0))
"RTN","XMXGRP1",51,0)
 S XMGN=""
"RTN","XMXGRP1",52,0)
 F  S XMGN=$O(XMGRP(XMGN)) Q:XMGN=""  D
"RTN","XMXGRP1",53,0)
 . S XMI=XMGRP(XMGN)
"RTN","XMXGRP1",54,0)
 . S XMGROUP("G."_XMGN_$S($P($G(^XMB(3.8,XMI,0)),U,2)="PR":XMPRIVAT,1:""))=XMI
"RTN","XMXGRP1",55,0)
 K XMGRP
"RTN","XMXGRP1",56,0)
 I $D(XMINSTR("SELF BSKT")) S XMX("SELF BSKT")=XMINSTR("SELF BSKT")
"RTN","XMXGRP1",57,0)
 Q
"RTN","XMXGRP1",58,0)
SAVFWD(XMX) ;
"RTN","XMXGRP1",59,0)
 S XMX("RESTORE")=0
"RTN","XMXGRP1",60,0)
 M ^TMP("XM",$J,"SAVE")=^TMP("XMY",$J)
"RTN","XMXGRP1",61,0)
 S XMX("ONE")=$O(^TMP("XMY",$J,"")) ; First recipient.  Is it the only one?
"RTN","XMXGRP1",62,0)
 I $O(^TMP("XMY",$J,XMX("ONE")))'="" S XMX("ONE")=0 ; There's more than one recipient
"RTN","XMXGRP1",63,0)
 Q
"RTN","XMXGRP1",64,0)
CHKADD(XMX) ;
"RTN","XMXGRP1",65,0)
 S XMX("FWDBY")=XMV("NAME")_$S(XMDUZ=DUZ:"",1:$$EZBLD^DIALOG(38008,XMV("DUZ NAME")))_" "_$$MMDT^XMXUTIL1($$NOW^XLFDT) ; " (Surrogate: _x_)"
"RTN","XMXGRP1",66,0)
 S XMI=0 ; Delete any remote addresses - responses won't be forwarded.
"RTN","XMXGRP1",67,0)
 F  S XMI=$O(^TMP("XMY",$J,XMI)) Q:XMI=""  K:+XMI'=XMI ^(XMI)
"RTN","XMXGRP1",68,0)
 Q
"RTN","XMXGRP1",69,0)
ADDFWD(XMDUZ,XMGROUP,XMWHAT,XMFDATE,XMTDATE,XMX) ;
"RTN","XMXGRP1",70,0)
 N XMZ,XMCRE8,XMGN
"RTN","XMXGRP1",71,0)
 S XMZ=0
"RTN","XMXGRP1",72,0)
 S XMCRE8=XMFDATE-.1
"RTN","XMXGRP1",73,0)
 F  S XMCRE8=$O(^XMB(3.9,"C",XMCRE8)) Q:'XMCRE8  Q:XMCRE8>XMTDATE  D  Q:$G(ZTSTOP)
"RTN","XMXGRP1",74,0)
 . I $$S^%ZTLOAD S ZTSTOP=1 Q
"RTN","XMXGRP1",75,0)
 . F  S XMZ=$O(^XMB(3.9,"C",XMCRE8,XMZ)) Q:'XMZ  D
"RTN","XMXGRP1",76,0)
 . . Q:$$ZCLOSED^XMXSEC(XMZ)  ; Message is closed
"RTN","XMXGRP1",77,0)
 . . S XMGN=""
"RTN","XMXGRP1",78,0)
 . . F  S XMGN=$O(XMGROUP(XMGN)) Q:XMGN=""  Q:$S($L(XMGN)<31:$D(^XMB(3.9,XMZ,6,"B",XMGN)),$D(^XMB(3.9,XMZ,6,"B",$E(XMGN,1,30))):(XMGN=$P($G(^XMB(3.9,XMZ,6,+$O(^XMB(3.9,XMZ,6,"B",$E(XMGN,1,30),0)),0)),U,1)),1:0)
"RTN","XMXGRP1",79,0)
 . . Q:XMGN=""  ; Message is not addressed to any of the groups
"RTN","XMXGRP1",80,0)
 . . I XMWHAT="F" D FWD(XMDUZ,XMZ,.XMX) Q
"RTN","XMXGRP1",81,0)
 . . D ADD(XMDUZ,XMZ,.XMX)
"RTN","XMXGRP1",82,0)
 Q
"RTN","XMXGRP1",83,0)
FWD(XMDUZ,XMZ,XMX) ; Forward the message to the user
"RTN","XMXGRP1",84,0)
 N XMINSTR
"RTN","XMXGRP1",85,0)
 I $D(XMX("SELF BSKT")) S XMINSTR("SELF BSKT")=XMX("SELF BSKT")
"RTN","XMXGRP1",86,0)
 I XMX("ONE")'=0 Q:$D(^XMB(3.9,XMZ,1,"C",XMX("ONE")))  ; User already on msg.
"RTN","XMXGRP1",87,0)
 I XMX("ONE")=0 D  Q:'$D(^TMP("XMY",$J))
"RTN","XMXGRP1",88,0)
 . I XMX("RESTORE") M ^TMP("XMY",$J)=^TMP("XM",$J,"SAVE") S XMX("RESTORE")=0
"RTN","XMXGRP1",89,0)
 . N XMI
"RTN","XMXGRP1",90,0)
 . S XMI=""
"RTN","XMXGRP1",91,0)
 . F  S XMI=$O(^TMP("XMY",$J,XMI)) Q:XMI=""  D
"RTN","XMXGRP1",92,0)
 . . Q:'$D(^XMB(3.9,XMZ,1,"C",XMI))  ; User not yet on msg.
"RTN","XMXGRP1",93,0)
 . . K ^TMP("XMY",$J,XMI)  ; User on msg - don't forward to user.
"RTN","XMXGRP1",94,0)
 . . S XMX("RESTORE")=1
"RTN","XMXGRP1",95,0)
 D FWD^XMKP(XMDUZ,XMZ,.XMINSTR)
"RTN","XMXGRP1",96,0)
 Q
"RTN","XMXGRP1",97,0)
ADD(XMDUZ,XMZ,XMX) ; Add user(s) to message.
"RTN","XMXGRP1",98,0)
 ; XMX("FWDBY")
"RTN","XMXGRP1",99,0)
 N XMI,XMFDA,XMIENS,XMPRI
"RTN","XMXGRP1",100,0)
 S XMPRI=$$ZPRI^XMXUTIL2(XMZ) ; Is msg priority?
"RTN","XMXGRP1",101,0)
 ; Put users into RECIPIENT multiple
"RTN","XMXGRP1",102,0)
 S XMI=0
"RTN","XMXGRP1",103,0)
 F  S XMI=$O(^TMP("XMY",$J,XMI)) Q:'XMI  D
"RTN","XMXGRP1",104,0)
 . Q:$D(^XMB(3.9,XMZ,1,"C",XMI))  ; User already on msg - don't add.
"RTN","XMXGRP1",105,0)
 . D NEW^XMKP(XMZ,XMPRI,XMI,$G(^TMP("XMY",$J,XMI,1)),.XMFDA,.XMIENS) ; New recipient
"RTN","XMXGRP1",106,0)
 . S XMFDA(3.91,XMIENS,8)=XMX("FWDBY") ; fwd by name date time
"RTN","XMXGRP1",107,0)
 . S XMFDA(3.91,XMIENS,8.01)=XMDUZ  ; fwd by duz
"RTN","XMXGRP1",108,0)
 . ; Need new field that says 'parked until next reply'.
"RTN","XMXGRP1",109,0)
 . D UPDATE^DIE("","XMFDA")
"RTN","XMXGRP1",110,0)
 Q
"RTN","XMXGRP1",111,0)
NOTIFY(XMG,XMNEWMBR) ; If the group is restricted in any way,
"RTN","XMXGRP1",112,0)
 ; notify the organizer & coordinator of the new members.
"RTN","XMXGRP1",113,0)
 N XMREC,XMTO,I
"RTN","XMXGRP1",114,0)
 S XMREC=^XMB(3.8,XMG,0)
"RTN","XMXGRP1",115,0)
 I $P(XMREC,U,2)="PU",$P(XMREC,U,3)="y" Q
"RTN","XMXGRP1",116,0)
 S I=$P($G(^XMB(3.8,XMG,3)),U) S:I XMTO(I)="" ; organizer
"RTN","XMXGRP1",117,0)
 S I=$P(XMREC,U,7) S:I XMTO(I)="" ; coordinator
"RTN","XMXGRP1",118,0)
 Q:$D(XMTO(DUZ))
"RTN","XMXGRP1",119,0)
 N XMPARM,XMTEXT,XMINSTR,XMNAME,J
"RTN","XMXGRP1",120,0)
 S I=0 F  S I=$O(XMNEWMBR(I)) Q:'I  S XMNAME($$NAME^XMXUTIL(I,1))=""
"RTN","XMXGRP1",121,0)
 S J="" F I=1:1 S J=$O(XMNAME(J)) Q:J=""  S XMTEXT(I)=J
"RTN","XMXGRP1",122,0)
 S XMINSTR("FROM")=.5
"RTN","XMXGRP1",123,0)
 S XMPARM(1)=$$NAME^XMXUTIL(DUZ),XMPARM(2)=$P(^XMB(3.8,XMG,0),U,1)
"RTN","XMXGRP1",124,0)
 D TASKBULL^XMXBULL(DUZ,"XM GROUP EDIT NOTIFY",.XMPARM,"XMTEXT",.XMTO,.XMINSTR)
"RTN","XMXGRP1",125,0)
 Q
"RTN","XMXLIST")
0^370^B30457906
"RTN","XMXLIST",1,0)
XMXLIST ;ISC-SF/GMB-List message: multiple conditions ;03/01/2001  09:40
"RTN","XMXLIST",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMXLIST",3,0)
LISTMSGS(XMDUZ,XMK,XMFLDS,XMFLAGS,XMAMT,XMSTART,XMF,XMTROOT) ;
"RTN","XMXLIST",4,0)
 ; XMDUZ is the user doing the search
"RTN","XMXLIST",5,0)
 ; XMK is the place to look
"RTN","XMXLIST",6,0)
 ;              =number - Look in this basket of the mailbox of XMDUZ
"RTN","XMXLIST",7,0)
 ;              =*      - Look in all baskets of the mailbox of XMDUZ
"RTN","XMXLIST",8,0)
 ;              =!      - Look in the MESSAGE file for all messages
"RTN","XMXLIST",9,0)
 ;                        that XMDUZ sent or received.  If XMFLAGS["U"
"RTN","XMXLIST",10,0)
 ;                        and the user (DUZ) holds the XM SUPER SEARCH
"RTN","XMXLIST",11,0)
 ;                        key, ALL messages are examined,
"RTN","XMXLIST",12,0)
 ;                        regardless of ownership.
"RTN","XMXLIST",13,0)
 ; XMFLDS is a list, separated by ';', of fields to retrieve.
"RTN","XMXLIST",14,0)
 ; e.g. XMFLDS="SUBJ;DATE" means retrieve subject and date.
"RTN","XMXLIST",15,0)
 ;       "BSKT" = basket (default: <basket ien>^<basket name>)
"RTN","XMXLIST",16,0)
 ;                optionally followed by ":" and
"RTN","XMXLIST",17,0)
 ;                "I" for basket IEN only (no 2nd piece)
"RTN","XMXLIST",18,0)
 ;                "X" adds basket name xref
"RTN","XMXLIST",19,0)
 ;                (If XMK="!", and msg is not in user's mailbox, will be:
"RTN","XMXLIST",20,0)
 ;                 "0^* N/A *")
"RTN","XMXLIST",21,0)
 ;       "DATE" = date sent (default: <internal date>^<dd mmm yy hh:mm>)
"RTN","XMXLIST",22,0)
 ;                optionally followed by ":" and
"RTN","XMXLIST",23,0)
 ;                "I" for internal date only (no 2nd piece)
"RTN","XMXLIST",24,0)
 ;                "F" for FileMan date as the 2nd piece
"RTN","XMXLIST",25,0)
 ;                "X" adds FileMan date xref
"RTN","XMXLIST",26,0)
 ;       "FROM" = message from (default: <internal from>^<external from>)
"RTN","XMXLIST",27,0)
 ;                optionally followed by ":" and
"RTN","XMXLIST",28,0)
 ;                "I" for internal from only (no 2nd piece)
"RTN","XMXLIST",29,0)
 ;                "X" adds external from xref
"RTN","XMXLIST",30,0)
 ;       "LINE" = number of lines in the message
"RTN","XMXLIST",31,0)
 ;       "NEW"  = is the msg new? (0=no; 1=yes; 2=yes, and priority, too)
"RTN","XMXLIST",32,0)
 ;       "PRI"  = is the message priority? (0=no; 1=yes)
"RTN","XMXLIST",33,0)
 ;       "READ" = how much of the message has the user read?
"RTN","XMXLIST",34,0)
 ;                null   = has not read the message at all
"RTN","XMXLIST",35,0)
 ;                0      = has read the message, but no responses
"RTN","XMXLIST",36,0)
 ;                number = has read through this response
"RTN","XMXLIST",37,0)
 ;       "RESP" = how many responses does the message have?
"RTN","XMXLIST",38,0)
 ;                0      = none
"RTN","XMXLIST",39,0)
 ;                number = this many
"RTN","XMXLIST",40,0)
 ;       "SEQN" = sequence number in basket (If XMK="!", and msg is not
"RTN","XMXLIST",41,0)
 ;                in user's mailbox, will not be returned at all.)
"RTN","XMXLIST",42,0)
 ;       "SUBJ" = message subject (always external)
"RTN","XMXLIST",43,0)
 ;                optionally followed by ":" and
"RTN","XMXLIST",44,0)
 ;                "X" adds subject xref
"RTN","XMXLIST",45,0)
 ; XMFLAGS are used to control processing
"RTN","XMXLIST",46,0)
 ;              =B Backwards order (Default is traverse forward)
"RTN","XMXLIST",47,0)
 ;              =U Ignore the file screen on file 3.9 so that all
"RTN","XMXLIST",48,0)
 ;                 messages can be examined.  (valid only if user holds
"RTN","XMXLIST",49,0)
 ;                 XM SUPER SEARCH key and XMK="!")
"RTN","XMXLIST",50,0)
 ;              If XMK="!", the following flags are ignored:
"RTN","XMXLIST",51,0)
 ;              =C Use basket C-xref (Default is message IEN)
"RTN","XMXLIST",52,0)
 ;              =N New messages only (C flag ignored)
"RTN","XMXLIST",53,0)
 ;              =P New Priority messages only (C, N flags ignored)
"RTN","XMXLIST",54,0)
 ; XMAMT        How many?
"RTN","XMXLIST",55,0)
 ;              =number - Get this many
"RTN","XMXLIST",56,0)
 ;              =*      - Get all (default)
"RTN","XMXLIST",57,0)
 ; XMSTART is used to start the lister going.  The lister will keep it
"RTN","XMXLIST",58,0)
 ; updated from call to call.  (If XMK="!", FileMan handles XMSTART,
"RTN","XMXLIST",59,0)
 ; and you should look at FM documentation for an explanation.)
"RTN","XMXLIST",60,0)
 ; XMSTART("XMK")  Start with this basket IEN (valid only if XMK="*")
"RTN","XMXLIST",61,0)
 ;                 Continues from there, with each successive call,
"RTN","XMXLIST",62,0)
 ;                 to the end.
"RTN","XMXLIST",63,0)
 ;                 (Default is to start with basket .5, the WASTE basket)
"RTN","XMXLIST",64,0)
 ; XMSTART("XMZ")  Start AFTER this message IEN (valid only if no C flag)
"RTN","XMXLIST",65,0)
 ;                 Continues from there, with each successive call,
"RTN","XMXLIST",66,0)
 ;                 to the end.
"RTN","XMXLIST",67,0)
 ;                 (Default is to start at the beginning (or end) of the
"RTN","XMXLIST",68,0)
 ;                 basket)
"RTN","XMXLIST",69,0)
 ; XMSTART("XMKZ") Start AFTER this message C-xref (valid only if C flag)
"RTN","XMXLIST",70,0)
 ;                 Continues from there, with each successive call,
"RTN","XMXLIST",71,0)
 ;                 to the end.
"RTN","XMXLIST",72,0)
 ;                 (Default is to start at the beginning (or end) of the
"RTN","XMXLIST",73,0)
 ;                 basket)
"RTN","XMXLIST",74,0)
 ; XMF contains conditions which are 'and'ed together to select only
"RTN","XMXLIST",75,0)
 ; those messages which meet the conditions.
"RTN","XMXLIST",76,0)
 ; XMF("FROM")  Message is from this person
"RTN","XMXLIST",77,0)
 ; XMF("FDATE") Message was sent on or after this date
"RTN","XMXLIST",78,0)
 ;              (If XMK="!", make sure this doesn't conflict w/XMF("PD"))
"RTN","XMXLIST",79,0)
 ; XMF("FLINE") Message has this many or more lines
"RTN","XMXLIST",80,0)
 ; XMF("PD")    Message was sent in this period (FM equiv. of yyy/yyymm)
"RTN","XMXLIST",81,0)
 ;              (default is current month) (valid only if XMK="!")
"RTN","XMXLIST",82,0)
 ; XMF("RFROM") Message has a response from this person
"RTN","XMXLIST",83,0)
 ; XMF("SUBJ")  Subject contains this string
"RTN","XMXLIST",84,0)
 ; XMF("SUBJ","C") =0 - Search is not case-sensitive (default)
"RTN","XMXLIST",85,0)
 ;                 =1 - Search is case-sensitive
"RTN","XMXLIST",86,0)
 ; XMF("TDATE") Message was sent on or before this date
"RTN","XMXLIST",87,0)
 ;              (If XMK="!", make sure this doesn't conflict w/XMF("PD"))
"RTN","XMXLIST",88,0)
 ; XMF("TEXT")  Message contains this string
"RTN","XMXLIST",89,0)
 ; XMF("TEXT","L") =1 - Look in message only (default)
"RTN","XMXLIST",90,0)
 ;                 =2 - Look in both message and responses
"RTN","XMXLIST",91,0)
 ;                 =3 - Look in responses only
"RTN","XMXLIST",92,0)
 ; XMF("TEXT","C") =0 - Search is not case-sensitive (default)
"RTN","XMXLIST",93,0)
 ;                 =1 - Search is case-sensitive
"RTN","XMXLIST",94,0)
 ; XMF("TLINE") Message has this many or fewer lines
"RTN","XMXLIST",95,0)
 ; XMF("TO")    Message is to this person
"RTN","XMXLIST",96,0)
 ; XMTROOT is the target root to receive the message list.
"RTN","XMXLIST",97,0)
 ;              (default is ^TMP("XMLIST",$J))
"RTN","XMXLIST",98,0)
 ;
"RTN","XMXLIST",99,0)
 ; Variables set and used by the routine:
"RTN","XMXLIST",100,0)
 ; XMF("SUBJ","S") Look for this string in the subject
"RTN","XMXLIST",101,0)
 ; XMF("TEXT","S") Look for this string in the message
"RTN","XMXLIST",102,0)
 ; XMF("PD","S")   Look for messages created during this period
"RTN","XMXLIST",103,0)
 N XMORDER
"RTN","XMXLIST",104,0)
 I XMDUZ'=DUZ,'$$RPRIV^XMXSEC Q
"RTN","XMXLIST",105,0)
 D INIT(.XMFLDS,.XMFLAGS,.XMAMT,.XMORDER,.XMF,.XMTROOT)
"RTN","XMXLIST",106,0)
 I XMK="!" D ALLMSGS(XMDUZ,$G(XMFLAGS),XMORDER,.XMFLDS,XMAMT,.XMSTART,.XMF,XMTROOT) Q
"RTN","XMXLIST",107,0)
 I XMK="*" D  Q
"RTN","XMXLIST",108,0)
 . I XMFLAGS["P" D NEWA^XMXLIST1(XMDUZ,"N",XMORDER,.XMFLDS,XMAMT,.XMSTART,.XMF,XMTROOT) Q
"RTN","XMXLIST",109,0)
 . I XMFLAGS["N" D NEWA^XMXLIST1(XMDUZ,"N0",XMORDER,.XMFLDS,XMAMT,.XMSTART,.XMF,XMTROOT) Q
"RTN","XMXLIST",110,0)
 . I XMFLAGS["C" D REGAC^XMXLIST1(XMDUZ,XMORDER,.XMFLDS,XMAMT,.XMSTART,.XMF,XMTROOT) Q
"RTN","XMXLIST",111,0)
 . D REGAZ^XMXLIST1(XMDUZ,XMORDER,.XMFLDS,XMAMT,.XMSTART,.XMF,XMTROOT)
"RTN","XMXLIST",112,0)
 N XMKN
"RTN","XMXLIST",113,0)
 S XMKN=$P(^XMB(3.7,XMDUZ,2,XMK,0),U,1)
"RTN","XMXLIST",114,0)
 I XMFLAGS["P" D NEW1^XMXLIST2(XMDUZ,XMK,XMKN,"N",XMORDER,.XMFLDS,XMAMT,.XMSTART,.XMF,XMTROOT) Q
"RTN","XMXLIST",115,0)
 I XMFLAGS["N" D NEW1^XMXLIST2(XMDUZ,XMK,XMKN,"N0",XMORDER,.XMFLDS,XMAMT,.XMSTART,.XMF,XMTROOT) Q
"RTN","XMXLIST",116,0)
 I XMFLAGS["C" D REG1C^XMXLIST2(XMDUZ,XMK,XMKN,XMORDER,.XMFLDS,XMAMT,.XMSTART,.XMF,XMTROOT) Q
"RTN","XMXLIST",117,0)
 D REG1Z^XMXLIST2(XMDUZ,XMK,XMKN,XMORDER,.XMFLDS,XMAMT,.XMSTART,.XMF,XMTROOT)
"RTN","XMXLIST",118,0)
 Q
"RTN","XMXLIST",119,0)
INIT(XMFLDS,XMFLAGS,XMAMT,XMORDER,XMF,XMTROOT) ;
"RTN","XMXLIST",120,0)
 I $D(XMFLDS),XMFLDS="" K XMFLDS
"RTN","XMXLIST",121,0)
 I $D(XMTROOT),XMTROOT'="" D
"RTN","XMXLIST",122,0)
 . K @$$CREF^DILF(XMTROOT)
"RTN","XMXLIST",123,0)
 . S XMTROOT=$$OREF^DILF(XMTROOT)_"""XMLIST"","
"RTN","XMXLIST",124,0)
 E  D
"RTN","XMXLIST",125,0)
 . K ^TMP("XMLIST",$J)
"RTN","XMXLIST",126,0)
 . S XMTROOT="^TMP(""XMLIST"",$J,"
"RTN","XMXLIST",127,0)
 I $D(XMF) D
"RTN","XMXLIST",128,0)
 . I $D(XMF)'>9 K XMF Q
"RTN","XMXLIST",129,0)
 . S:$D(XMF("SUBJ")) XMF("SUBJ","S")=$S('$G(XMF("SUBJ","C")):$$UP^XLFSTR(XMF("SUBJ")),1:XMF("SUBJ"))
"RTN","XMXLIST",130,0)
 . I $D(XMF("TEXT")) D
"RTN","XMXLIST",131,0)
 . . S XMF("TEXT","S")=$S('$G(XMF("TEXT","C")):$$UP^XLFSTR(XMF("TEXT")),1:XMF("TEXT"))
"RTN","XMXLIST",132,0)
 . . I '$D(XMF("TEXT","L")) S XMF("TEXT","L")=1
"RTN","XMXLIST",133,0)
 . I $D(XMF("PD")) S XMF("PD","S")=$S($E(XMF("PD"),4,5)="00":$E(XMF("PD"),1,3),1:$E(XMF("PD"),1,5))
"RTN","XMXLIST",134,0)
 . I $D(XMF("FROM")) S XMF("FROM")=$$UP^XLFSTR(XMF("FROM"))
"RTN","XMXLIST",135,0)
 . I $D(XMF("RFROM")) S XMF("RFROM")=$$UP^XLFSTR(XMF("RFROM"))
"RTN","XMXLIST",136,0)
 . I $D(XMF("TO")),XMF("TO")["@" S XMF("TO")=$$UP^XLFSTR(XMF("TO"))
"RTN","XMXLIST",137,0)
 S XMFLAGS=$G(XMFLAGS)
"RTN","XMXLIST",138,0)
 S XMORDER=$S(XMFLAGS["B":-1,1:1)
"RTN","XMXLIST",139,0)
 I $G(XMAMT)="" S XMAMT="*"
"RTN","XMXLIST",140,0)
 Q
"RTN","XMXLIST",141,0)
ALLMSGS(XMDUZ,XMFLAGS,XMORDER,XMFLDS,XMAMT,XMSTART,XMF,XMTROOT) ; Look in the entire MESSAGE file.
"RTN","XMXLIST",142,0)
 N XMSCREEN,XMK,XMKN,XMZ,I,XMNA,XMCNT
"RTN","XMXLIST",143,0)
 I XMFLAGS["U",'$$SSPRIV^XMXSEC1 Q
"RTN","XMXLIST",144,0)
 S XMFLAGS=$TR(XMFLAGS,"CNP")
"RTN","XMXLIST",145,0)
 I XMFLAGS["U" D AUDIT^XMJMFC(.XMF) Q:$D(XMERR)
"RTN","XMXLIST",146,0)
 S XMSCREEN=$$SCREEN^XMJMFC(XMDUZ)
"RTN","XMXLIST",147,0)
 ; File screen ^DD(3.9,0,"SCR") insists that user be author or recipient.
"RTN","XMXLIST",148,0)
 ; If FLAGS["U", then file screen is ignored.
"RTN","XMXLIST",149,0)
 D LIST^DIC(3.9,"","@",XMFLAGS,XMAMT,.XMSTART,$G(XMF("PD","S"),$E(DT,1,5)),"C",XMSCREEN)
"RTN","XMXLIST",150,0)
 S I="",XMCNT=0,XMNA=$$EZBLD^DIALOG(34014) ; * N/A *
"RTN","XMXLIST",151,0)
 F  S I=$O(^TMP("DILIST",$J,2,I),XMORDER) Q:I'>0  D
"RTN","XMXLIST",152,0)
 . S XMZ=^TMP("DILIST",$J,2,I)
"RTN","XMXLIST",153,0)
 . S XMCNT=XMCNT+1
"RTN","XMXLIST",154,0)
 . S @(XMTROOT_XMCNT_")")=XMZ
"RTN","XMXLIST",155,0)
 . Q:'$D(XMFLDS)
"RTN","XMXLIST",156,0)
 . I $S(XMFLDS["BSKT":1,XMFLDS["NEW":1,XMFLDS["SEQN":1,1:0) D
"RTN","XMXLIST",157,0)
 . . S XMK=+$O(^XMB(3.7,"M",XMZ,XMDUZ,0))
"RTN","XMXLIST",158,0)
 . . S XMKN=$S(XMK:$P(^XMB(3.7,XMDUZ,2,XMK,0),U),1:XMNA)
"RTN","XMXLIST",159,0)
 . . Q:'XMK
"RTN","XMXLIST",160,0)
 . . I '$D(^XMB(3.7,XMDUZ,2,XMK,1,XMZ,0)) D ADDITM^XMUT4A(XMDUZ,XMK,XMZ)
"RTN","XMXLIST",161,0)
 . . I XMFLDS["SEQN" D KSEQN^XMXLIST1(XMDUZ,XMK,XMZ,.XMFLDS,XMTROOT,XMCNT)
"RTN","XMXLIST",162,0)
 . D FIELDS^XMXLIST1(XMDUZ,.XMK,.XMKN,XMZ,.XMFLDS,XMTROOT,XMCNT)
"RTN","XMXLIST",163,0)
 S @(XMTROOT_"0)")=$G(^TMP("DILIST",$J,0)) ; # found^# requested^more?
"RTN","XMXLIST",164,0)
 K ^TMP("DILIST",$J)
"RTN","XMXLIST",165,0)
 Q
"RTN","XMXLIST1")
0^371^B45274144
"RTN","XMXLIST1",1,0)
XMXLIST1 ;ISC-SF/GMB-List message: multiple conditions (cont.) ;08/30/2000  15:29
"RTN","XMXLIST1",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMXLIST1",3,0)
 ; Look in all of the user's baskets.
"RTN","XMXLIST1",4,0)
NEWA(XMDUZ,XMTYPE,XMORDER,XMFLDS,XMAMT,XMSTART,XMF,XMTROOT) ; New messages in all baskets
"RTN","XMXLIST1",5,0)
 N XMCNT,XMK,XMKN,XMZ
"RTN","XMXLIST1",6,0)
 S XMCNT=0
"RTN","XMXLIST1",7,0)
 S XMK=+$G(XMSTART("XMK")) I XMK S XMK=XMK-.01
"RTN","XMXLIST1",8,0)
 S XMZ=$G(XMSTART("XMZ"))
"RTN","XMXLIST1",9,0)
 F  S XMK=$O(^XMB(3.7,XMDUZ,XMTYPE,XMK)) Q:'XMK  D  Q:XMCNT=XMAMT
"RTN","XMXLIST1",10,0)
 . S XMKN=$P(^XMB(3.7,XMDUZ,2,XMK,0),U,1)
"RTN","XMXLIST1",11,0)
 . F  S XMZ=$O(^XMB(3.7,XMDUZ,XMTYPE,XMK,XMZ),XMORDER) Q:'XMZ  D  Q:XMCNT=XMAMT
"RTN","XMXLIST1",12,0)
 . . I '$D(^XMB(3.7,XMDUZ,2,XMK,1,XMZ,0)) D ADDITN^XMUT4A(XMDUZ,XMTYPE,XMK,XMZ)
"RTN","XMXLIST1",13,0)
 . . I '$D(^XMB(3.9,XMZ,0)) D ZAPIT^XMXMSGS2(XMDUZ,XMK,XMZ) Q
"RTN","XMXLIST1",14,0)
 . . I $D(XMF) Q:'$$GOODMSG^XMJMFB(XMDUZ,XMK,XMZ,.XMF)
"RTN","XMXLIST1",15,0)
 . . S XMCNT=XMCNT+1
"RTN","XMXLIST1",16,0)
 . . S @(XMTROOT_XMCNT_")")=XMZ
"RTN","XMXLIST1",17,0)
 . . Q:'$D(XMFLDS)
"RTN","XMXLIST1",18,0)
 . . D FIELDS(XMDUZ,XMK,XMKN,XMZ,.XMFLDS,XMTROOT,XMCNT)
"RTN","XMXLIST1",19,0)
 . . I XMFLDS["SEQN" D KSEQN(XMDUZ,XMK,XMZ,.XMFLDS,XMTROOT,XMCNT)
"RTN","XMXLIST1",20,0)
 S XMSTART("XMK")=XMK
"RTN","XMXLIST1",21,0)
 S XMSTART("XMZ")=XMZ
"RTN","XMXLIST1",22,0)
 S @(XMTROOT_"0)")=XMCNT_U_XMAMT
"RTN","XMXLIST1",23,0)
 ; Any more?
"RTN","XMXLIST1",24,0)
 I 'XMK S @(XMTROOT_"0)")=@(XMTROOT_"0)")_"^0" Q
"RTN","XMXLIST1",25,0)
 I '$O(^XMB(3.7,XMDUZ,XMTYPE,XMK)),'$O(^XMB(3.7,XMDUZ,XMTYPE,XMK,XMZ),XMORDER) S @(XMTROOT_"0)")=@(XMTROOT_"0)")_"^0" Q
"RTN","XMXLIST1",26,0)
 I '$D(XMF) S @(XMTROOT_"0)")=@(XMTROOT_"0)")_"^1" Q
"RTN","XMXLIST1",27,0)
 N XMORE
"RTN","XMXLIST1",28,0)
 S XMORE=0,XMK=XMK-.01
"RTN","XMXLIST1",29,0)
 F  S XMK=$O(^XMB(3.7,XMDUZ,XMTYPE,XMK)) Q:'XMK  D  Q:XMORE
"RTN","XMXLIST1",30,0)
 . F  S XMZ=$O(^XMB(3.7,XMDUZ,XMTYPE,XMK,XMZ),XMORDER) Q:'XMZ  D  Q:XMORE
"RTN","XMXLIST1",31,0)
 . . I '$D(^XMB(3.7,XMDUZ,2,XMK,1,XMZ,0)) D ADDITN^XMUT4A(XMDUZ,XMTYPE,XMK,XMZ)
"RTN","XMXLIST1",32,0)
 . . I '$D(^XMB(3.9,XMZ,0)) D ZAPIT^XMXMSGS2(XMDUZ,XMK,XMZ) Q
"RTN","XMXLIST1",33,0)
 . . I $$GOODMSG^XMJMFB(XMDUZ,XMK,XMZ,.XMF) S XMORE=1
"RTN","XMXLIST1",34,0)
 S @(XMTROOT_"0)")=@(XMTROOT_"0)")_U_XMORE
"RTN","XMXLIST1",35,0)
 Q
"RTN","XMXLIST1",36,0)
REGAC(XMDUZ,XMORDER,XMFLDS,XMAMT,XMSTART,XMF,XMTROOT) ; Messages (by C-xref) in all baskets
"RTN","XMXLIST1",37,0)
 N XMCNT,XMK,XMKN,XMKZ,XMZ
"RTN","XMXLIST1",38,0)
 S XMCNT=0
"RTN","XMXLIST1",39,0)
 S XMK=+$G(XMSTART("XMK")) I XMK S XMK=XMK-.01
"RTN","XMXLIST1",40,0)
 S XMKZ=$G(XMSTART("XMKZ"))
"RTN","XMXLIST1",41,0)
 F  S XMK=$O(^XMB(3.7,XMDUZ,2,XMK)) Q:'XMK  D  Q:XMCNT=XMAMT
"RTN","XMXLIST1",42,0)
 . S XMKN=$P(^XMB(3.7,XMDUZ,2,XMK,0),U,1)
"RTN","XMXLIST1",43,0)
 . F  S XMKZ=$O(^XMB(3.7,XMDUZ,2,XMK,1,"C",XMKZ),XMORDER) Q:'XMKZ  S XMZ=$O(^(XMKZ,"")) D  Q:XMCNT=XMAMT
"RTN","XMXLIST1",44,0)
 . . I '$D(^XMB(3.7,XMDUZ,2,XMK,1,XMZ,0)) D ADDITC^XMUT4A(XMDUZ,XMK,XMZ,XMKZ)
"RTN","XMXLIST1",45,0)
 . . I '$D(^XMB(3.9,XMZ,0)) D ZAPIT^XMXMSGS2(XMDUZ,XMK,XMZ) Q
"RTN","XMXLIST1",46,0)
 . . I $D(XMF) Q:'$$GOODMSG^XMJMFB(XMDUZ,XMK,XMZ,.XMF)
"RTN","XMXLIST1",47,0)
 . . S XMCNT=XMCNT+1
"RTN","XMXLIST1",48,0)
 . . S @(XMTROOT_XMCNT_")")=XMZ
"RTN","XMXLIST1",49,0)
 . . Q:'$D(XMFLDS)
"RTN","XMXLIST1",50,0)
 . . D FIELDS(XMDUZ,XMK,XMKN,XMZ,.XMFLDS,XMTROOT,XMCNT)
"RTN","XMXLIST1",51,0)
 . . I XMFLDS["SEQN" D SEQN(XMDUZ,XMKZ,.XMFLDS,XMTROOT,XMCNT)
"RTN","XMXLIST1",52,0)
 S XMSTART("XMK")=XMK
"RTN","XMXLIST1",53,0)
 S XMSTART("XMKZ")=XMKZ
"RTN","XMXLIST1",54,0)
 S @(XMTROOT_"0)")=XMCNT_U_XMAMT
"RTN","XMXLIST1",55,0)
 ; Any more?
"RTN","XMXLIST1",56,0)
 I 'XMK S @(XMTROOT_"0)")=@(XMTROOT_"0)")_"^0" Q
"RTN","XMXLIST1",57,0)
 I '$O(^XMB(3.7,XMDUZ,2,XMK)),'$O(^XMB(3.7,XMDUZ,2,XMK,1,"C",XMKZ),XMORDER) S @(XMTROOT_"0)")=@(XMTROOT_"0)")_"^0" Q
"RTN","XMXLIST1",58,0)
 I '$D(XMF) S @(XMTROOT_"0)")=@(XMTROOT_"0)")_"^1" Q
"RTN","XMXLIST1",59,0)
 N XMORE
"RTN","XMXLIST1",60,0)
 S XMORE=0,XMK=XMK-.01
"RTN","XMXLIST1",61,0)
 F  S XMK=$O(^XMB(3.7,XMDUZ,2,XMK)) Q:'XMK  D  Q:XMORE
"RTN","XMXLIST1",62,0)
 . F  S XMKZ=$O(^XMB(3.7,XMDUZ,2,XMK,1,"C",XMKZ),XMORDER) Q:'XMKZ  S XMZ=$O(^(XMKZ,"")) D  Q:XMORE
"RTN","XMXLIST1",63,0)
 . . I '$D(^XMB(3.7,XMDUZ,2,XMK,1,XMZ,0)) D ADDITC^XMUT4A(XMDUZ,XMK,XMZ,XMKZ)
"RTN","XMXLIST1",64,0)
 . . I '$D(^XMB(3.9,XMZ,0)) D ZAPIT^XMXMSGS2(XMDUZ,XMK,XMZ) Q
"RTN","XMXLIST1",65,0)
 . . I $$GOODMSG^XMJMFB(XMDUZ,XMK,XMZ,.XMF) S XMORE=1
"RTN","XMXLIST1",66,0)
 S @(XMTROOT_"0)")=@(XMTROOT_"0)")_U_XMORE
"RTN","XMXLIST1",67,0)
 Q
"RTN","XMXLIST1",68,0)
REGAZ(XMDUZ,XMORDER,XMFLDS,XMAMT,XMSTART,XMF,XMTROOT) ; Messages (by IEN) in all baskets
"RTN","XMXLIST1",69,0)
 N XMCNT,XMK,XMKN,XMZ
"RTN","XMXLIST1",70,0)
 S XMCNT=0
"RTN","XMXLIST1",71,0)
 S XMK=+$G(XMSTART("XMK")) I XMK S XMK=XMK-.01
"RTN","XMXLIST1",72,0)
 S XMZ=$G(XMSTART("XMZ"))
"RTN","XMXLIST1",73,0)
 F  S XMK=$O(^XMB(3.7,XMDUZ,2,XMK)) Q:'XMK  D  Q:XMCNT=XMAMT
"RTN","XMXLIST1",74,0)
 . S XMKN=$P(^XMB(3.7,XMDUZ,2,XMK,0),U,1)
"RTN","XMXLIST1",75,0)
 . I +XMZ=0 S XMZ=0 I XMORDER=-1 S XMZ=":"
"RTN","XMXLIST1",76,0)
 . F  S XMZ=$O(^XMB(3.7,XMDUZ,2,XMK,1,XMZ),XMORDER) Q:'XMZ  D  Q:XMCNT=XMAMT
"RTN","XMXLIST1",77,0)
 . . I '$D(^XMB(3.9,XMZ,0)) D ZAPIT^XMXMSGS2(XMDUZ,XMK,XMZ) Q
"RTN","XMXLIST1",78,0)
 . . I $D(XMF) Q:'$$GOODMSG^XMJMFB(XMDUZ,XMK,XMZ,.XMF)
"RTN","XMXLIST1",79,0)
 . . S XMCNT=XMCNT+1
"RTN","XMXLIST1",80,0)
 . . S @(XMTROOT_XMCNT_")")=XMZ
"RTN","XMXLIST1",81,0)
 . . Q:'$D(XMFLDS)
"RTN","XMXLIST1",82,0)
 . . D FIELDS(XMDUZ,XMK,XMKN,XMZ,.XMFLDS,XMTROOT,XMCNT)
"RTN","XMXLIST1",83,0)
 . . I XMFLDS["SEQN" D KSEQN(XMDUZ,XMK,XMZ,.XMFLDS,XMTROOT,XMCNT)
"RTN","XMXLIST1",84,0)
 S XMSTART("XMK")=XMK
"RTN","XMXLIST1",85,0)
 S XMSTART("XMZ")=XMZ
"RTN","XMXLIST1",86,0)
 S @(XMTROOT_"0)")=XMCNT_U_XMAMT
"RTN","XMXLIST1",87,0)
 ; Any more?
"RTN","XMXLIST1",88,0)
 I 'XMK S @(XMTROOT_"0)")=@(XMTROOT_"0)")_"^0" Q
"RTN","XMXLIST1",89,0)
 I '$O(^XMB(3.7,XMDUZ,2,XMK)),'$O(^XMB(3.7,XMDUZ,2,XMK,1,XMZ),XMORDER) S @(XMTROOT_"0)")=@(XMTROOT_"0)")_"^0" Q
"RTN","XMXLIST1",90,0)
 I '$D(XMF) S @(XMTROOT_"0)")=@(XMTROOT_"0)")_"^1" Q
"RTN","XMXLIST1",91,0)
 N XMORE
"RTN","XMXLIST1",92,0)
 S XMORE=0,XMK=XMK-.01
"RTN","XMXLIST1",93,0)
 F  S XMK=$O(^XMB(3.7,XMDUZ,2,XMK)) Q:'XMK  D  Q:XMORE
"RTN","XMXLIST1",94,0)
 . I +XMZ=0 S XMZ=0 I XMORDER=-1 S XMZ=":"
"RTN","XMXLIST1",95,0)
 . F  S XMZ=$O(^XMB(3.7,XMDUZ,2,XMK,1,XMZ),XMORDER) Q:'XMZ  D  Q:XMORE
"RTN","XMXLIST1",96,0)
 . . I '$D(^XMB(3.9,XMZ,0)) D ZAPIT^XMXMSGS2(XMDUZ,XMK,XMZ) Q
"RTN","XMXLIST1",97,0)
 . . I $$GOODMSG^XMJMFB(XMDUZ,XMK,XMZ,.XMF) S XMORE=1
"RTN","XMXLIST1",98,0)
 S @(XMTROOT_"0)")=@(XMTROOT_"0)")_U_XMORE
"RTN","XMXLIST1",99,0)
 Q
"RTN","XMXLIST1",100,0)
FIELDS(XMDUZ,XMK,XMKN,XMZ,XMFLDS,XMTROOT,XMCNT) ;
"RTN","XMXLIST1",101,0)
 N XMZREC,XMLOOK,XMVAL
"RTN","XMXLIST1",102,0)
 I XMFLDS["BSKT" D
"RTN","XMXLIST1",103,0)
 . S XMLOOK=$P($P(XMFLDS,"BSKT",2),";",1)
"RTN","XMXLIST1",104,0)
 . S @(XMTROOT_XMCNT_",""BSKT"")")=XMK_$S(XMLOOK["I":"",1:U_XMKN)
"RTN","XMXLIST1",105,0)
 . I XMLOOK["X" S @(XMTROOT_"""BSKT"",XMKN,XMCNT)")=""
"RTN","XMXLIST1",106,0)
 I XMFLDS["FROM" D
"RTN","XMXLIST1",107,0)
 . I '$D(XMZREC) S XMZREC=$G(^XMB(3.9,XMZ,0))
"RTN","XMXLIST1",108,0)
 . S XMLOOK=$P($P(XMFLDS,"FROM",2),";",1)
"RTN","XMXLIST1",109,0)
 . I XMLOOK["I" S @(XMTROOT_XMCNT_",""FROM"")")=$P(XMZREC,U,2) Q:XMLOOK'["X"
"RTN","XMXLIST1",110,0)
 . S XMVAL=$$FROM^XMXUTIL2(XMZREC)
"RTN","XMXLIST1",111,0)
 . I $E(XMVAL)="<" S XMVAL=$E(XMVAL,2,$L(XMVAL)-1)
"RTN","XMXLIST1",112,0)
 . I XMLOOK'["I" S @(XMTROOT_XMCNT_",""FROM"")")=$P(XMZREC,U,2)_U_XMVAL Q:XMLOOK'["X"
"RTN","XMXLIST1",113,0)
 . S @(XMTROOT_"""FROM"",XMVAL,XMCNT)")=""
"RTN","XMXLIST1",114,0)
 I XMFLDS["DATE" D
"RTN","XMXLIST1",115,0)
 . I '$D(XMZREC) S XMZREC=$G(^XMB(3.9,XMZ,0))
"RTN","XMXLIST1",116,0)
 . S XMLOOK=$P($P(XMFLDS,"DATE",2),";",1)
"RTN","XMXLIST1",117,0)
 . I XMLOOK'["X" D  Q
"RTN","XMXLIST1",118,0)
 . . I XMLOOK["I" S @(XMTROOT_XMCNT_",""DATE"")")=$P(XMZREC,U,3) Q
"RTN","XMXLIST1",119,0)
 . . I XMLOOK["F" D  Q
"RTN","XMXLIST1",120,0)
 . . . S XMVAL=$P(XMZREC,U,3)
"RTN","XMXLIST1",121,0)
 . . . I XMVAL'?7N.E S XMVAL=$$CONVERT^XMXUTIL1(XMVAL,1) I XMVAL=-1 S XMVAL=$P(XMZREC,U,3)
"RTN","XMXLIST1",122,0)
 . . . S @(XMTROOT_XMCNT_",""DATE"")")=$P(XMZREC,U,3)_U_XMVAL
"RTN","XMXLIST1",123,0)
 . . S @(XMTROOT_XMCNT_",""DATE"")")=$P(XMZREC,U,3)_U_$$DATE^XMXUTIL2(XMZREC)
"RTN","XMXLIST1",124,0)
 . S XMVAL=$P(XMZREC,U,3)
"RTN","XMXLIST1",125,0)
 . I XMVAL'?7N.E S XMVAL=$$CONVERT^XMXUTIL1(XMVAL,1)
"RTN","XMXLIST1",126,0)
 . S @(XMTROOT_"""DATE"",XMVAL,XMCNT)")=""
"RTN","XMXLIST1",127,0)
 . I XMLOOK["I" S @(XMTROOT_XMCNT_",""DATE"")")=$P(XMZREC,U,3) Q
"RTN","XMXLIST1",128,0)
 . I XMLOOK["F" S @(XMTROOT_XMCNT_",""DATE"")")=$P(XMZREC,U,3)_U_XMVAL Q
"RTN","XMXLIST1",129,0)
 . S @(XMTROOT_XMCNT_",""DATE"")")=$P(XMZREC,U,3)_U_$$DATE^XMXUTIL2(XMZREC)
"RTN","XMXLIST1",130,0)
 I XMFLDS["SUBJ" D
"RTN","XMXLIST1",131,0)
 . I '$D(XMZREC) S XMZREC=$G(^XMB(3.9,XMZ,0))
"RTN","XMXLIST1",132,0)
 . S XMLOOK=$P($P(XMFLDS,"SUBJ",2),";",1)
"RTN","XMXLIST1",133,0)
 . I XMLOOK'["X" S @(XMTROOT_XMCNT_",""SUBJ"")")=$$SUBJ^XMXUTIL2(XMZREC) Q
"RTN","XMXLIST1",134,0)
 . S XMVAL=$$SUBJ^XMXUTIL2(XMZREC)
"RTN","XMXLIST1",135,0)
 . S @(XMTROOT_XMCNT_",""SUBJ"")")=XMVAL
"RTN","XMXLIST1",136,0)
 . S @(XMTROOT_"""SUBJ"",XMVAL,XMCNT)")=""
"RTN","XMXLIST1",137,0)
 I XMFLDS["PRI" D
"RTN","XMXLIST1",138,0)
 . I '$D(XMZREC) S XMZREC=$G(^XMB(3.9,XMZ,0))
"RTN","XMXLIST1",139,0)
 . S @(XMTROOT_XMCNT_",""PRI"")")=$$PRI^XMXUTIL2(XMZREC)
"RTN","XMXLIST1",140,0)
 I XMFLDS["LINE" S @(XMTROOT_XMCNT_",""LINE"")")=$$LINE^XMXUTIL2(XMZ)
"RTN","XMXLIST1",141,0)
 I XMFLDS["NEW" S @(XMTROOT_XMCNT_",""NEW"")")=$$NEW^XMXUTIL2(XMDUZ,XMK,XMZ)
"RTN","XMXLIST1",142,0)
 I XMFLDS["RESP" S @(XMTROOT_XMCNT_",""RESP"")")=$$RESP^XMXUTIL2(XMZ)
"RTN","XMXLIST1",143,0)
 I XMFLDS["READ" S @(XMTROOT_XMCNT_",""READ"")")=$$ZREAD^XMXUTIL2(XMDUZ,XMZ)
"RTN","XMXLIST1",144,0)
 Q
"RTN","XMXLIST1",145,0)
KSEQN(XMDUZ,XMK,XMZ,XMFLDS,XMTROOT,XMCNT) ;
"RTN","XMXLIST1",146,0)
 S @(XMTROOT_XMCNT_",""SEQN"")")=$$KSEQN^XMXUTIL2(XMDUZ,XMK,XMZ)
"RTN","XMXLIST1",147,0)
 Q
"RTN","XMXLIST1",148,0)
SEQN(XMDUZ,XMKZ,XMFLDS,XMTROOT,XMCNT) ;
"RTN","XMXLIST1",149,0)
 S @(XMTROOT_XMCNT_",""SEQN"")")=XMKZ
"RTN","XMXLIST1",150,0)
 Q
"RTN","XMXLIST2")
0^372^B16392703
"RTN","XMXLIST2",1,0)
XMXLIST2 ;ISC-SF/GMB-List message: multiple conditions (cont.) ;08/30/2000  11:01
"RTN","XMXLIST2",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMXLIST2",3,0)
 ; Look in just one of the user's baskets.
"RTN","XMXLIST2",4,0)
NEW1(XMDUZ,XMK,XMKN,XMTYPE,XMORDER,XMFLDS,XMAMT,XMSTART,XMF,XMTROOT) ; New messages in 1 basket
"RTN","XMXLIST2",5,0)
 N XMCNT,XMZ
"RTN","XMXLIST2",6,0)
 S XMKN=$P(^XMB(3.7,XMDUZ,2,XMK,0),U,1)
"RTN","XMXLIST2",7,0)
 S XMCNT=0
"RTN","XMXLIST2",8,0)
 S XMZ=$G(XMSTART("XMZ"))
"RTN","XMXLIST2",9,0)
 F  S XMZ=$O(^XMB(3.7,XMDUZ,XMTYPE,XMK,XMZ),XMORDER) Q:'XMZ  D  Q:XMCNT=XMAMT
"RTN","XMXLIST2",10,0)
 . I '$D(^XMB(3.7,XMDUZ,2,XMK,1,XMZ,0)) D ADDITN^XMUT4A(XMDUZ,XMTYPE,XMK,XMZ)
"RTN","XMXLIST2",11,0)
 . I '$D(^XMB(3.9,XMZ,0)) D ZAPIT^XMXMSGS2(XMDUZ,XMK,XMZ) Q
"RTN","XMXLIST2",12,0)
 . I $D(XMF) Q:'$$GOODMSG^XMJMFB(XMDUZ,XMK,XMZ,.XMF)
"RTN","XMXLIST2",13,0)
 . S XMCNT=XMCNT+1
"RTN","XMXLIST2",14,0)
 . S @(XMTROOT_XMCNT_")")=XMZ
"RTN","XMXLIST2",15,0)
 . Q:'$D(XMFLDS)
"RTN","XMXLIST2",16,0)
 . D FIELDS^XMXLIST1(XMDUZ,XMK,XMKN,XMZ,.XMFLDS,XMTROOT,XMCNT)
"RTN","XMXLIST2",17,0)
 . I XMFLDS["SEQN" D KSEQN^XMXLIST1(XMDUZ,XMK,XMZ,.XMFLDS,XMTROOT,XMCNT)
"RTN","XMXLIST2",18,0)
 S XMSTART("XMZ")=XMZ
"RTN","XMXLIST2",19,0)
 S @(XMTROOT_"0)")=XMCNT_U_XMAMT
"RTN","XMXLIST2",20,0)
 ; Any more?
"RTN","XMXLIST2",21,0)
 I 'XMZ S @(XMTROOT_"0)")=@(XMTROOT_"0)")_"^0" Q
"RTN","XMXLIST2",22,0)
 I '$O(^XMB(3.7,XMDUZ,XMTYPE,XMK,XMZ),XMORDER) S @(XMTROOT_"0)")=@(XMTROOT_"0)")_"^0" Q
"RTN","XMXLIST2",23,0)
 I '$D(XMF) S @(XMTROOT_"0)")=@(XMTROOT_"0)")_"^1" Q
"RTN","XMXLIST2",24,0)
 N XMORE
"RTN","XMXLIST2",25,0)
 S XMORE=0
"RTN","XMXLIST2",26,0)
 F  S XMZ=$O(^XMB(3.7,XMDUZ,XMTYPE,XMK,XMZ),XMORDER) Q:'XMZ  D  Q:XMORE
"RTN","XMXLIST2",27,0)
 . I '$D(^XMB(3.7,XMDUZ,2,XMK,1,XMZ,0)) D ADDITN^XMUT4A(XMDUZ,XMTYPE,XMK,XMZ)
"RTN","XMXLIST2",28,0)
 . I '$D(^XMB(3.9,XMZ,0)) D ZAPIT^XMXMSGS2(XMDUZ,XMK,XMZ) Q
"RTN","XMXLIST2",29,0)
 . I $$GOODMSG^XMJMFB(XMDUZ,XMK,XMZ,.XMF) S XMORE=1
"RTN","XMXLIST2",30,0)
 S @(XMTROOT_"0)")=@(XMTROOT_"0)")_U_XMORE
"RTN","XMXLIST2",31,0)
 Q
"RTN","XMXLIST2",32,0)
REG1C(XMDUZ,XMK,XMKN,XMORDER,XMFLDS,XMAMT,XMSTART,XMF,XMTROOT) ; Messages (by C-xref) in one basket
"RTN","XMXLIST2",33,0)
 N XMCNT,XMKZ,XMZ
"RTN","XMXLIST2",34,0)
 S XMCNT=0
"RTN","XMXLIST2",35,0)
 S XMKZ=$G(XMSTART("XMKZ"))
"RTN","XMXLIST2",36,0)
 F  S XMKZ=$O(^XMB(3.7,XMDUZ,2,XMK,1,"C",XMKZ),XMORDER) Q:'XMKZ  S XMZ=$O(^(XMKZ,"")) D  Q:XMCNT=XMAMT
"RTN","XMXLIST2",37,0)
 . I '$D(^XMB(3.7,XMDUZ,2,XMK,1,XMZ,0)) D ADDITC^XMUT4A(XMDUZ,XMK,XMZ,XMKZ)
"RTN","XMXLIST2",38,0)
 . I '$D(^XMB(3.9,XMZ,0)) D ZAPIT^XMXMSGS2(XMDUZ,XMK,XMZ) Q
"RTN","XMXLIST2",39,0)
 . I $D(XMF) Q:'$$GOODMSG^XMJMFB(XMDUZ,XMK,XMZ,.XMF)
"RTN","XMXLIST2",40,0)
 . S XMCNT=XMCNT+1
"RTN","XMXLIST2",41,0)
 . S @(XMTROOT_XMCNT_")")=XMZ
"RTN","XMXLIST2",42,0)
 . Q:'$D(XMFLDS)
"RTN","XMXLIST2",43,0)
 . D FIELDS^XMXLIST1(XMDUZ,XMK,XMKN,XMZ,.XMFLDS,XMTROOT,XMCNT)
"RTN","XMXLIST2",44,0)
 . I FIELDS["SEQN" D SEQN^XMXLIST1(XMDUZ,XMKZ,.XMFLDS,XMTROOT,XMCNT)
"RTN","XMXLIST2",45,0)
 S XMSTART("XMKZ")=XMKZ
"RTN","XMXLIST2",46,0)
 S @(XMTROOT_"0)")=XMCNT_U_XMAMT
"RTN","XMXLIST2",47,0)
 ; Any more?
"RTN","XMXLIST2",48,0)
 I 'XMKZ S @(XMTROOT_"0)")=@(XMTROOT_"0)")_"^0" Q
"RTN","XMXLIST2",49,0)
 I '$O(^XMB(3.7,XMDUZ,2,XMK,1,"C",XMKZ),XMORDER) S @(XMTROOT_"0)")=@(XMTROOT_"0)")_"^0" Q
"RTN","XMXLIST2",50,0)
 I '$D(XMF) S @(XMTROOT_"0)")=@(XMTROOT_"0)")_"^1" Q
"RTN","XMXLIST2",51,0)
 N XMORE
"RTN","XMXLIST2",52,0)
 S XMORE=0
"RTN","XMXLIST2",53,0)
 F  S XMKZ=$O(^XMB(3.7,XMDUZ,2,XMK,1,"C",XMKZ),XMORDER) Q:'XMKZ  S XMZ=$O(^(XMKZ,"")) D  Q:XMORE
"RTN","XMXLIST2",54,0)
 . I '$D(^XMB(3.7,XMDUZ,2,XMK,1,XMZ,0)) D ADDITC^XMUT4A(XMDUZ,XMK,XMZ,XMKZ)
"RTN","XMXLIST2",55,0)
 . I '$D(^XMB(3.9,XMZ,0)) D ZAPIT^XMXMSGS2(XMDUZ,XMK,XMZ) Q
"RTN","XMXLIST2",56,0)
 . I $$GOODMSG^XMJMFB(XMDUZ,XMK,XMZ,.XMF) S XMORE=1
"RTN","XMXLIST2",57,0)
 S @(XMTROOT_"0)")=@(XMTROOT_"0)")_U_XMORE
"RTN","XMXLIST2",58,0)
 Q
"RTN","XMXLIST2",59,0)
REG1Z(XMDUZ,XMK,XMKN,XMORDER,XMFLDS,XMAMT,XMSTART,XMF,XMTROOT) ; Messages (by IEN) in one basket
"RTN","XMXLIST2",60,0)
 N XMCNT,XMZ
"RTN","XMXLIST2",61,0)
 S XMCNT=0
"RTN","XMXLIST2",62,0)
 S XMZ=$G(XMSTART("XMZ"))
"RTN","XMXLIST2",63,0)
 I +XMZ=0 S XMZ=0 I XMORDER=-1 S XMZ=":"
"RTN","XMXLIST2",64,0)
 F  S XMZ=$O(^XMB(3.7,XMDUZ,2,XMK,1,XMZ),XMORDER) Q:'XMZ  D  Q:XMCNT=XMAMT
"RTN","XMXLIST2",65,0)
 . I '$D(^XMB(3.9,XMZ,0)) D ZAPIT^XMXMSGS2(XMDUZ,XMK,XMZ) Q
"RTN","XMXLIST2",66,0)
 . I $D(XMF) Q:'$$GOODMSG^XMJMFB(XMDUZ,XMK,XMZ,.XMF)
"RTN","XMXLIST2",67,0)
 . S XMCNT=XMCNT+1
"RTN","XMXLIST2",68,0)
 . S @(XMTROOT_XMCNT_")")=XMZ
"RTN","XMXLIST2",69,0)
 . Q:'$D(XMFLDS)
"RTN","XMXLIST2",70,0)
 . D FIELDS^XMXLIST1(XMDUZ,XMK,XMKN,XMZ,.XMFLDS,XMTROOT,XMCNT)
"RTN","XMXLIST2",71,0)
 . I XMFLDS["SEQN" D KSEQN^XMXLIST1(XMDUZ,XMK,XMZ,.XMFLDS,XMTROOT,XMCNT)
"RTN","XMXLIST2",72,0)
 S XMSTART("XMZ")=XMZ
"RTN","XMXLIST2",73,0)
 S @(XMTROOT_"0)")=XMCNT_U_XMAMT
"RTN","XMXLIST2",74,0)
 ; Any more?
"RTN","XMXLIST2",75,0)
 I 'XMZ S @(XMTROOT_"0)")=@(XMTROOT_"0)")_"^0" Q
"RTN","XMXLIST2",76,0)
 I '$O(^XMB(3.7,XMDUZ,2,XMK,1,XMZ),XMORDER) S @(XMTROOT_"0)")=@(XMTROOT_"0)")_"^0" Q
"RTN","XMXLIST2",77,0)
 I '$D(XMF) S @(XMTROOT_"0)")=@(XMTROOT_"0)")_"^1" Q
"RTN","XMXLIST2",78,0)
 N XMORE
"RTN","XMXLIST2",79,0)
 S XMORE=0
"RTN","XMXLIST2",80,0)
 F  S XMZ=$O(^XMB(3.7,XMDUZ,2,XMK,1,XMZ),XMORDER) Q:'XMZ  D  Q:XMORE
"RTN","XMXLIST2",81,0)
 . I '$D(^XMB(3.9,XMZ,0)) D ZAPIT^XMXMSGS2(XMDUZ,XMK,XMZ) Q
"RTN","XMXLIST2",82,0)
 . I $$GOODMSG^XMJMFB(XMDUZ,XMK,XMZ,.XMF) S XMORE=1
"RTN","XMXLIST2",83,0)
 S @(XMTROOT_"0)")=@(XMTROOT_"0)")_U_XMORE
"RTN","XMXLIST2",84,0)
 Q
"RTN","XMXMBOX")
0^373^B3516978
"RTN","XMXMBOX",1,0)
XMXMBOX ;ISC-SF/GMB-Mailbox APIs ;04/17/2002  14:10
"RTN","XMXMBOX",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMXMBOX",3,0)
QMBOX(XMDUZ,XMMSG) ; Message counts for a mailbox
"RTN","XMXMBOX",4,0)
 K XMERR,^TMP("XMERR",$J)
"RTN","XMXMBOX",5,0)
 S XMMSG=""
"RTN","XMXMBOX",6,0)
 I XMDUZ'=DUZ,'$$RPRIV^XMXSEC  Q
"RTN","XMXMBOX",7,0)
 S XMMSG=$$NEWS^XMXUTIL(XMDUZ)
"RTN","XMXMBOX",8,0)
 Q
"RTN","XMXMBOX",9,0)
FLTRMBOX(XMDUZ,XMMSG) ; Filter all the messages in a user's mailbox.
"RTN","XMXMBOX",10,0)
 K XMERR,^TMP("XMERR",$J)
"RTN","XMXMBOX",11,0)
 S XMMSG=""
"RTN","XMXMBOX",12,0)
 I XMDUZ'=DUZ,'$$RPRIV^XMXSEC Q
"RTN","XMXMBOX",13,0)
 N XMK
"RTN","XMXMBOX",14,0)
 S XMK=.99
"RTN","XMXMBOX",15,0)
 F  S XMK=$O(^XMB(3.7,XMDUZ,2,XMK)) Q:XMK'>0!(XMDUZ=.5&(XMK>999))  D
"RTN","XMXMBOX",16,0)
 . D FLTRBSKT^XMXBSKT(XMDUZ,XMK)
"RTN","XMXMBOX",17,0)
 S XMMSG=$$EZBLD^DIALOG(34306.3) ; Mailbox filtered.
"RTN","XMXMBOX",18,0)
 Q
"RTN","XMXMBOX",19,0)
CRE8MBOX(XMDUZ,XMDATE) ; Create a Mailbox for a user
"RTN","XMXMBOX",20,0)
 ; XMDUZ  The user's DUZ
"RTN","XMXMBOX",21,0)
 ; XMDATE The user has been reinstated after not having worked here a
"RTN","XMXMBOX",22,0)
 ;        while.  Please note the earliest message date which the user
"RTN","XMXMBOX",23,0)
 ;        may access, and don't let the user access any messages before
"RTN","XMXMBOX",24,0)
 ;        that date, except for any which someone might forward to the
"RTN","XMXMBOX",25,0)
 ;        user.
"RTN","XMXMBOX",26,0)
 ;        =fileman date or any supported date format that FileMan
"RTN","XMXMBOX",27,0)
 ;         recognizes (The date must be exact.)
"RTN","XMXMBOX",28,0)
 ;         The user may not access any before this date.
"RTN","XMXMBOX",29,0)
 ;        =0      - (default) The user may access any old msgs which had
"RTN","XMXMBOX",30,0)
 ;                  been addressed to the user.
"RTN","XMXMBOX",31,0)
 K XMERR,^TMP("XMERR",$J)
"RTN","XMXMBOX",32,0)
 ;I DUZ'=.5,'$$POSTPRIV^XMXSEC Q
"RTN","XMXMBOX",33,0)
 I '$D(^XMB(3.7,XMDUZ,0)) D
"RTN","XMXMBOX",34,0)
 . N XMFDA,XMIEN,XMTRIES
"RTN","XMXMBOX",35,0)
 . S XMFDA(3.7,"+1,",.01)=XMDUZ
"RTN","XMXMBOX",36,0)
 . S XMIEN(1)=XMDUZ
"RTN","XMXMBOX",37,0)
CTRY . D UPDATE^DIE("S","XMFDA","XMIEN") Q:'$D(DIERR)
"RTN","XMXMBOX",38,0)
 . S XMTRIES=$G(XMTRIES)+1
"RTN","XMXMBOX",39,0)
 . I $D(^TMP("DIERR",$J,"E",110)) H 1 G CTRY ; Try again if can't lock
"RTN","XMXMBOX",40,0)
 D:'$D(^XMB(3.7,XMDUZ,2,.5,0)) MAKEBSKT^XMXBSKT(XMDUZ,.5,$$EZBLD^DIALOG(37004)) ; WASTE
"RTN","XMXMBOX",41,0)
 D:'$D(^XMB(3.7,XMDUZ,2,1,0)) MAKEBSKT^XMXBSKT(XMDUZ,1,$$EZBLD^DIALOG(37005)) ; IN
"RTN","XMXMBOX",42,0)
 ; Limit message access at reinstatement?
"RTN","XMXMBOX",43,0)
 Q:$G(XMDATE)=""!($G(XMDATE)=0)
"RTN","XMXMBOX",44,0)
 N XMFDA
"RTN","XMXMBOX",45,0)
 S XMFDA(3.7,XMDUZ_",",1.2)=XMDATE
"RTN","XMXMBOX",46,0)
 D FILE^DIE("E","XMFDA")
"RTN","XMXMBOX",47,0)
 Q
"RTN","XMXMBOX",48,0)
TERMMBOX(XMDUZ) ; Terminate a user's Mailbox
"RTN","XMXMBOX",49,0)
 ; (Delete all traces of a user in MailMan)
"RTN","XMXMBOX",50,0)
 ; XMDUZ  The user's DUZ
"RTN","XMXMBOX",51,0)
 K XMERR,^TMP("XMERR",$J)
"RTN","XMXMBOX",52,0)
 I DUZ'=.5,'$$POSTPRIV^XMXSEC Q
"RTN","XMXMBOX",53,0)
 D TERMINAT^XMUTERM1(XMDUZ)
"RTN","XMXMBOX",54,0)
 Q
"RTN","XMXMSGS")
0^91^B44667143
"RTN","XMXMSGS",1,0)
XMXMSGS ;ISC-SF/GMB-Message APIs ;08/06/2002  06:45
"RTN","XMXMSGS",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMXMSGS",3,0)
DELMSG(XMDUZ,XMK,XMKZA,XMMSG) ; Delete msgs in mailbox
"RTN","XMXMSGS",4,0)
 K XMERR,^TMP("XMERR",$J)
"RTN","XMXMSGS",5,0)
 I XMDUZ'=DUZ,'$$RPRIV^XMXSEC Q
"RTN","XMXMSGS",6,0)
 D ACTMSG("XDEL^XMXMSGS2",34302) ;,XMDUZ,XMK,.XMKZA,"",.XMMSG)
"RTN","XMXMSGS",7,0)
 Q
"RTN","XMXMSGS",8,0)
FLTRMSG(XMDUZ,XMK,XMKZA,XMMSG) ; Filter msgs
"RTN","XMXMSGS",9,0)
 K XMERR,^TMP("XMERR",$J)
"RTN","XMXMSGS",10,0)
 I XMDUZ'=DUZ,'$$RPRIV^XMXSEC Q
"RTN","XMXMSGS",11,0)
 N XMKN,XMKTO,XMKNTO
"RTN","XMXMSGS",12,0)
 I $G(XMK)'=.5,'$G(XMK),'$D(^XMB(3.7,XMDUZ,15,"AF")) D ERRSET^XMXUTIL(37204.1) Q  ; You have no message filters defined.
"RTN","XMXMSGS",13,0)
 I $G(XMK) S XMKN=$P(^XMB(3.7,XMDUZ,2,XMK,0),U,1)
"RTN","XMXMSGS",14,0)
 D ACTMSG("XFLTR^XMXMSGS2",34306) ;,XMDUZ,XMK,XMKN,.XMKZA,"",.XMMSG)
"RTN","XMXMSGS",15,0)
 Q
"RTN","XMXMSGS",16,0)
FWDMSG(XMDUZ,XMK,XMKZA,XMTO,XMINSTR,XMMSG) ; Forward msgs
"RTN","XMXMSGS",17,0)
 ; XMINSTR("SHARE DATE")  delete date if SHARED,MAIL is recipient
"RTN","XMXMSGS",18,0)
 ; XMINSTR("SHARE BSKT")  basket if SHARED,MAIL is recipient
"RTN","XMXMSGS",19,0)
 K XMERR,^TMP("XMERR",$J)
"RTN","XMXMSGS",20,0)
 I XMDUZ'=DUZ,'$$RPRIV^XMXSEC Q
"RTN","XMXMSGS",21,0)
 N XMRTN
"RTN","XMXMSGS",22,0)
 I $$ONEMSG(.XMKZA) D
"RTN","XMXMSGS",23,0)
 . S XMRTN="XFWDONE^XMXMSGS1" ; just one msg
"RTN","XMXMSGS",24,0)
 E  D
"RTN","XMXMSGS",25,0)
 . S XMRTN="XFWD^XMXMSGS1"
"RTN","XMXMSGS",26,0)
 . I $G(XMINSTR("ADDR FLAGS"))'["I" D INIT^XMXADDR
"RTN","XMXMSGS",27,0)
 . D CHKADDR^XMXADDR(XMDUZ,.XMTO,.XMINSTR)
"RTN","XMXMSGS",28,0)
 D ACTMSG(XMRTN,34309) ;,XMDUZ,XMK,.XMKZA,.XMINSTR,.XMMSG)
"RTN","XMXMSGS",29,0)
 D CLEANUP^XMXADDR
"RTN","XMXMSGS",30,0)
 Q
"RTN","XMXMSGS",31,0)
ONEMSG(XMKZA) ; Function decides if just one message
"RTN","XMXMSGS",32,0)
 N XMONE,XMMSGS
"RTN","XMXMSGS",33,0)
 I $G(XMKZA)]"" D  Q XMONE
"RTN","XMXMSGS",34,0)
 . I $O(XMKZA(""))="",+XMKZA=XMKZA S XMONE=1 Q
"RTN","XMXMSGS",35,0)
 . S XMONE=0
"RTN","XMXMSGS",36,0)
 S XMMSGS=$O(XMKZA(""))
"RTN","XMXMSGS",37,0)
 I $O(XMKZA(XMMSGS))'="" Q 0
"RTN","XMXMSGS",38,0)
 I +XMMSGS=XMMSGS Q 1
"RTN","XMXMSGS",39,0)
 Q 0
"RTN","XMXMSGS",40,0)
LATERMSG(XMDUZ,XMK,XMKZA,XMINSTR,XMMSG) ; Later msgs
"RTN","XMXMSGS",41,0)
 ; XMINSTR("LATER")  FM date/time when msg should be made new.
"RTN","XMXMSGS",42,0)
 K XMERR,^TMP("XMERR",$J)
"RTN","XMXMSGS",43,0)
 Q:'$$LATER^XMXSEC(XMDUZ)
"RTN","XMXMSGS",44,0)
 N XMWHEN
"RTN","XMXMSGS",45,0)
 S XMWHEN=$G(XMINSTR("LATER"),$G(XMINSTR))
"RTN","XMXMSGS",46,0)
 D ACTMSG("XLATER^XMXMSGS2",34312) ;,XMDUZ,XMK,.XMKZA,.XMINSTR,.XMMSG)
"RTN","XMXMSGS",47,0)
 Q
"RTN","XMXMSGS",48,0)
MOVEMSG(XMDUZ,XMK,XMKZA,XMKTO,XMMSG) ; Move msgs to a basket
"RTN","XMXMSGS",49,0)
 K XMERR,^TMP("XMERR",$J)
"RTN","XMXMSGS",50,0)
 I XMDUZ'=DUZ,'$$RPRIV^XMXSEC Q
"RTN","XMXMSGS",51,0)
 Q:$G(XMK)=XMKTO
"RTN","XMXMSGS",52,0)
 D ACTMSG("XMOVE^XMXMSGS2",34324) ;,XMDUZ,XMK,.XMKZA,XMKTO,.XMMSG)
"RTN","XMXMSGS",53,0)
 Q
"RTN","XMXMSGS",54,0)
NTOGLMSG(XMDUZ,XMK,XMKZA,XMMSG) ; New toggle msgs
"RTN","XMXMSGS",55,0)
 K XMERR,^TMP("XMERR",$J)
"RTN","XMXMSGS",56,0)
 Q:'$$LATER^XMXSEC(XMDUZ)
"RTN","XMXMSGS",57,0)
 N XMKN,XMKTO,XMKNTO
"RTN","XMXMSGS",58,0)
 S:XMK XMKN=$P(^XMB(3.7,XMDUZ,2,XMK,0),U,1)
"RTN","XMXMSGS",59,0)
 D ACTMSG("XNTOGL^XMXMSGS2",34315) ;,XMDUZ,XMK,XMKN,.XMKZA,"",.XMMSG)
"RTN","XMXMSGS",60,0)
 Q
"RTN","XMXMSGS",61,0)
PRTMSG(XMDUZ,XMK,XMKZA,XMPRTTO,XMINSTR,XMMSG,XMTASK,XMSUBJ,XMTO) ; Print msgs
"RTN","XMXMSGS",62,0)
 K XMERR,^TMP("XMERR",$J),^TMP("XM",$J,"XMZ")
"RTN","XMXMSGS",63,0)
 D ACTMSG("XPRT^XMXMSGS1",34320) ;,XMDUZ,XMK,.XMKZA,.XMINSTR,.XMMSG)
"RTN","XMXMSGS",64,0)
 Q:+XMMSG=0
"RTN","XMXMSGS",65,0)
 I +XMMSG=1 D
"RTN","XMXMSGS",66,0)
 . D PRINT1^XMXPRT(XMDUZ,$O(^TMP("XM",$J,"XMZ","")),XMPRTTO,.XMINSTR,.XMTASK,.XMSUBJ,.XMTO)
"RTN","XMXMSGS",67,0)
 E  D
"RTN","XMXMSGS",68,0)
 . D PRINTM^XMXPRT(XMDUZ,XMPRTTO,.XMINSTR,.XMTASK,.XMSUBJ,.XMTO)
"RTN","XMXMSGS",69,0)
 K ^TMP("XM",$J,"XMZ")
"RTN","XMXMSGS",70,0)
 Q:$D(XMTASK)
"RTN","XMXMSGS",71,0)
 S XMMSG=$$EZBLD^DIALOG(34321) ; 0 messages sent to printer.  TaskMan Problem.
"RTN","XMXMSGS",72,0)
 D ERRSET^XMXUTIL(34311) ; Task creation not successful.
"RTN","XMXMSGS",73,0)
 Q
"RTN","XMXMSGS",74,0)
TERMMSG(XMDUZ,XMK,XMKZA,XMMSG) ; Terminate msgs
"RTN","XMXMSGS",75,0)
 K XMERR,^TMP("XMERR",$J)
"RTN","XMXMSGS",76,0)
 I XMDUZ'=DUZ,'$$RPRIV^XMXSEC Q
"RTN","XMXMSGS",77,0)
 D ACTMSG("XTERM^XMXMSGS2",34329) ;,XMDUZ,XMK,.XMKZA,"",.XMMSG)
"RTN","XMXMSGS",78,0)
 Q
"RTN","XMXMSGS",79,0)
VAPORMSG(XMDUZ,XMK,XMKZA,XMINSTR,XMMSG) ; Set vaporize dates for msgs in mailbox
"RTN","XMXMSGS",80,0)
 K XMERR,^TMP("XMERR",$J)
"RTN","XMXMSGS",81,0)
 I XMDUZ'=DUZ,'$$RPRIV^XMXSEC Q
"RTN","XMXMSGS",82,0)
 N XMWHEN
"RTN","XMXMSGS",83,0)
 S XMWHEN=$G(XMINSTR("VAPOR"),$G(XMINSTR))
"RTN","XMXMSGS",84,0)
 D ACTMSG("XVAPOR^XMXMSGS2",$S(XMWHEN="@":34337.2,1:34337)) ;,XMDUZ,XMK,.XMKZA,XMWHEN,.XMMSG)
"RTN","XMXMSGS",85,0)
 Q
"RTN","XMXMSGS",86,0)
XPMSG(XMDUZ,XMK,XMKZA,XMINSTR,XMMSG) ; Postmaster transmit priority toggle
"RTN","XMXMSGS",87,0)
 K XMERR,^TMP("XMERR",$J)
"RTN","XMXMSGS",88,0)
 I XMDUZ'=DUZ,'$$RPRIV^XMXSEC Q
"RTN","XMXMSGS",89,0)
 I XMDUZ'=.5!(XMK'>999) D ERRSET^XMXUTIL(37219.5) Q  ;Transmission Priority toggle valid only for Postmaster Transmission Queues.
"RTN","XMXMSGS",90,0)
 N XMTPRI
"RTN","XMXMSGS",91,0)
 S XMTPRI=$G(XMINSTR("XMIT PRI"),$G(XMINSTR))
"RTN","XMXMSGS",92,0)
 D ACTMSG("XXP^XMXMSGS1",34334) ;,XMDUZ,XMK,.XMKZA,XMTPRI,.XMMSG)
"RTN","XMXMSGS",93,0)
 Q
"RTN","XMXMSGS",94,0)
ACTMSG(XMRTN,XMSUM) ;,XMDUZ,XMK,XMKZA,XMKTO,XMMSG)
"RTN","XMXMSGS",95,0)
 ; XMKZA    Array of msg numbers  DEL("1-3,7,11-15")
"RTN","XMXMSGS",96,0)
 ; XMKZL    List of msg numbers   1-3,7,11-15
"RTN","XMXMSGS",97,0)
 ;          (It is OK if the list ends with a comma)
"RTN","XMXMSGS",98,0)
 ; XMKZR    Range of msg numbers  1-3
"RTN","XMXMSGS",99,0)
 ; XMKZ1    First number in range 1
"RTN","XMXMSGS",100,0)
 ; XMKZN    Last number in range  3
"RTN","XMXMSGS",101,0)
 ; XMKZ     Message number
"RTN","XMXMSGS",102,0)
 N XMCNT,XMI,XMZ,XMPIECES
"RTN","XMXMSGS",103,0)
 S XMCNT=0
"RTN","XMXMSGS",104,0)
 I $G(XMK) D
"RTN","XMXMSGS",105,0)
 . N XMKZ,XMKZL,XMKZR,XMKZ1,XMKZN
"RTN","XMXMSGS",106,0)
 . ; is this an array or a variable?
"RTN","XMXMSGS",107,0)
 . I $G(XMKZA)]"",$O(XMKZA(""))="" S XMKZA(XMKZA)=""
"RTN","XMXMSGS",108,0)
 . S XMKZL=""
"RTN","XMXMSGS",109,0)
 . F  S XMKZL=$O(XMKZA(XMKZL)) Q:XMKZL=""  D
"RTN","XMXMSGS",110,0)
 . . S XMPIECES=$L(XMKZL,",")
"RTN","XMXMSGS",111,0)
 . . S:$P(XMKZL,",",XMPIECES)="" XMPIECES=XMPIECES-1
"RTN","XMXMSGS",112,0)
 . . F XMI=1:1:XMPIECES D
"RTN","XMXMSGS",113,0)
 . . . S XMKZR=$P(XMKZL,",",XMI)
"RTN","XMXMSGS",114,0)
 . . . I XMKZR["-" D
"RTN","XMXMSGS",115,0)
 . . . . ; deal with a range of msg #s
"RTN","XMXMSGS",116,0)
 . . . . S XMKZ1=$P(XMKZR,"-",1)
"RTN","XMXMSGS",117,0)
 . . . . S XMKZN=$P(XMKZR,"-",2)
"RTN","XMXMSGS",118,0)
 . . . . I XMKZ1>XMKZN D  Q
"RTN","XMXMSGS",119,0)
 . . . . . N XMPARM
"RTN","XMXMSGS",120,0)
 . . . . . S XMPARM(1)=XMKZ1,XMPARM(2)=XMKZN
"RTN","XMXMSGS",121,0)
 . . . . . D ERRSET^XMXUTIL(34350,.XMPARM) ; Range '_XMKZ1_-_XMKZN_' invalid.
"RTN","XMXMSGS",122,0)
 . . . . S XMKZ=XMKZ1-.1
"RTN","XMXMSGS",123,0)
 . . . . F  S XMKZ=$O(^XMB(3.7,XMDUZ,2,XMK,1,"C",XMKZ)) Q:'XMKZ!(XMKZ>XMKZN)  D
"RTN","XMXMSGS",124,0)
 . . . . . S XMZ=$O(^XMB(3.7,XMDUZ,2,XMK,1,"C",XMKZ,""))
"RTN","XMXMSGS",125,0)
 . . . . . I 'XMZ D  Q
"RTN","XMXMSGS",126,0)
 . . . . . . N XMPARM
"RTN","XMXMSGS",127,0)
 . . . . . . S XMPARM(1)=XMKZ,XMPARM(2)=XMK
"RTN","XMXMSGS",128,0)
 . . . . . . D ERRSET^XMXUTIL(34351,.XMPARM) ; Message _XMKZ_ in basket _XMK_ does not exist.
"RTN","XMXMSGS",129,0)
 . . . . . I '$D(^XMB(3.9,XMZ,0)) D  Q
"RTN","XMXMSGS",130,0)
 . . . . . . N XMPARM
"RTN","XMXMSGS",131,0)
 . . . . . . S XMPARM(1)=XMZ,XMPARM(2)=XMKZ,XMPARM(3)=XMK
"RTN","XMXMSGS",132,0)
 . . . . . . D ERRSET^XMXUTIL(34352,.XMPARM) ; Message '_XMZ_' (message _XMKZ_ in basket _XMK_) does not exist.
"RTN","XMXMSGS",133,0)
 . . . . . D @XMRTN ;(XMDUZ,XMK,XMZ)
"RTN","XMXMSGS",134,0)
 . . . E  D
"RTN","XMXMSGS",135,0)
 . . . . S XMKZ=XMKZR
"RTN","XMXMSGS",136,0)
 . . . . S XMZ=$O(^XMB(3.7,XMDUZ,2,XMK,1,"C",XMKZ,""))
"RTN","XMXMSGS",137,0)
 . . . . I 'XMZ D  Q
"RTN","XMXMSGS",138,0)
 . . . . . N XMPARM
"RTN","XMXMSGS",139,0)
 . . . . . S XMPARM(1)=XMKZ,XMPARM(2)=XMK
"RTN","XMXMSGS",140,0)
 . . . . . D ERRSET^XMXUTIL(34351,.XMPARM) ; Message _XMKZ_ in basket _XMK_ does not exist.
"RTN","XMXMSGS",141,0)
 . . . . I '$D(^XMB(3.9,XMZ,0)) D  Q
"RTN","XMXMSGS",142,0)
 . . . . . N XMPARM
"RTN","XMXMSGS",143,0)
 . . . . . S XMPARM(1)=XMZ,XMPARM(2)=XMKZ,XMPARM(3)=XMK
"RTN","XMXMSGS",144,0)
 . . . . . D ERRSET^XMXUTIL(34352,.XMPARM) ; Message '_XMZ_' (message _XMKZ_ in basket _XMK_) does not exist.
"RTN","XMXMSGS",145,0)
 . . . . D @XMRTN ;(XMDUZ,XMK,XMZ)
"RTN","XMXMSGS",146,0)
 E  D
"RTN","XMXMSGS",147,0)
 . N XMZL,XMZREC
"RTN","XMXMSGS",148,0)
 . ; is this an array or a variable?
"RTN","XMXMSGS",149,0)
 . I $G(XMKZA)]"",$O(XMKZA(""))="" S XMKZA(XMKZA)=""
"RTN","XMXMSGS",150,0)
 . S XMZL=""
"RTN","XMXMSGS",151,0)
 . F  S XMZL=$O(XMKZA(XMZL)) Q:XMZL=""  D
"RTN","XMXMSGS",152,0)
 . . I XMZL["-" D ERRSET^XMXUTIL(34353) Q  ; XMZ message ranges are not allowed.
"RTN","XMXMSGS",153,0)
 . . S XMPIECES=$L(XMZL,",")
"RTN","XMXMSGS",154,0)
 . . S:'$P(XMZL,",",XMPIECES) XMPIECES=XMPIECES-1
"RTN","XMXMSGS",155,0)
 . . F XMI=1:1:XMPIECES D
"RTN","XMXMSGS",156,0)
 . . . N XMK
"RTN","XMXMSGS",157,0)
 . . . S XMZ=$P(XMZL,",",XMI)
"RTN","XMXMSGS",158,0)
 . . . I '$D(^XMB(3.9,XMZ,0)) D ERRSET^XMXUTIL(34354,XMZ) Q  ; Message '_XMZ_' does not exist."
"RTN","XMXMSGS",159,0)
 . . . S XMZREC=$G(^XMB(3.9,XMZ,0))
"RTN","XMXMSGS",160,0)
 . . . Q:'$$ACCESS^XMXSEC(XMDUZ,XMZ,XMZREC)
"RTN","XMXMSGS",161,0)
 . . . D @XMRTN ;(XMDUZ,XMK,XMZ)
"RTN","XMXMSGS",162,0)
 S XMMSG=$$EZBLD^DIALOG($S(XMCNT=1:XMSUM+.1,1:XMSUM),XMCNT)
"RTN","XMXMSGS",163,0)
 D INCRDECR(XMDUZ,.XMCNT)
"RTN","XMXMSGS",164,0)
 Q
"RTN","XMXMSGS",165,0)
INCRDECR(XMDUZ,XMCNT) ; Update the "new messages" counts.
"RTN","XMXMSGS",166,0)
 N XMK
"RTN","XMXMSGS",167,0)
 S XMK=0
"RTN","XMXMSGS",168,0)
 F  S XMK=$O(XMCNT(XMK)) Q:'XMK  D
"RTN","XMXMSGS",169,0)
 . S XMCNT=$G(XMCNT(XMK,"INCR"))-$G(XMCNT(XMK,"DECR"))
"RTN","XMXMSGS",170,0)
 . Q:'XMCNT
"RTN","XMXMSGS",171,0)
 . I XMCNT<0 D DECRNEW^XMXUTIL(XMDUZ,XMK,-XMCNT) Q
"RTN","XMXMSGS",172,0)
 . D INCRNEW^XMXUTIL(XMDUZ,XMK,XMCNT)
"RTN","XMXMSGS",173,0)
 Q
"RTN","XMXMSGS1")
0^92^B26176553
"RTN","XMXMSGS1",1,0)
XMXMSGS1 ;ISC-SF/GMB-Message APIs (cont.) ;04/19/2002  11:58
"RTN","XMXMSGS1",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMXMSGS1",3,0)
FWD(XMDUZ,XMZ,XMINSTR,XMCNT) ;
"RTN","XMXMSGS1",4,0)
XFWD ; (Need XMDUZ, XMZ, XMINSTR.  XMK not needed.)
"RTN","XMXMSGS1",5,0)
 ; XMZREC   Zero node of the msg record
"RTN","XMXMSGS1",6,0)
 N XMZREC,%X,%Y,XMRESTR
"RTN","XMXMSGS1",7,0)
 S XMZREC=^XMB(3.9,XMZ,0)
"RTN","XMXMSGS1",8,0)
 Q:'$$FORWARD^XMXSEC(XMDUZ,XMZ,XMZREC)
"RTN","XMXMSGS1",9,0)
 D GETRESTR^XMXSEC1(XMDUZ,XMZ,XMZREC,.XMINSTR,.XMRESTR)
"RTN","XMXMSGS1",10,0)
 D CHKSHARE(XMDUZ,XMZ,.XMRESTR)
"RTN","XMXMSGS1",11,0)
 I $G(XMINSTR("ADDR FLAGS"))'["R" D CHKRESTR(XMDUZ,XMZ,.XMRESTR)
"RTN","XMXMSGS1",12,0)
 D FWDIT(XMDUZ,XMZ,.XMINSTR,.XMCNT)
"RTN","XMXMSGS1",13,0)
 I $D(^TMP("XM",$J,"SAVE")) D RESTADDR
"RTN","XMXMSGS1",14,0)
 Q
"RTN","XMXMSGS1",15,0)
CHKSHARE(XMDUZ,XMZ,XMRESTR) ;
"RTN","XMXMSGS1",16,0)
 I $G(XMRESTR("FLAGS"))["C",$D(^TMP("XMY",$J,.6)) D
"RTN","XMXMSGS1",17,0)
 . D ERRSET^XMXUTIL(39200,XMZ,XMZ)
"RTN","XMXMSGS1",18,0)
 . ;Confidential messages may not be forwarded to SHARED,MAIL.
"RTN","XMXMSGS1",19,0)
 . D SAVEADDR
"RTN","XMXMSGS1",20,0)
 . D CHKADDR^XMXADDR(XMDUZ,"-.6")
"RTN","XMXMSGS1",21,0)
 I $G(XMRESTR("FLAGS"))["X",$D(^TMP("XMY",$J,.6)) D
"RTN","XMXMSGS1",22,0)
 . D ERRSET^XMXUTIL(39201,XMZ,XMZ)
"RTN","XMXMSGS1",23,0)
 . ;Message |1| is closed.  SHARED,MAIL removed as recipient.
"RTN","XMXMSGS1",24,0)
 . ;Closed messages may not be forwarded to SHARED,MAIL.
"RTN","XMXMSGS1",25,0)
 . D SAVEADDR
"RTN","XMXMSGS1",26,0)
 . D CHKADDR^XMXADDR(XMDUZ,"-.6")
"RTN","XMXMSGS1",27,0)
 Q
"RTN","XMXMSGS1",28,0)
CHKRESTR(XMDUZ,XMZ,XMRESTR) ;
"RTN","XMXMSGS1",29,0)
 N XMTO
"RTN","XMXMSGS1",30,0)
 I $D(XMRESTR("NOBCAST")) D
"RTN","XMXMSGS1",31,0)
 . ; The user is not allowed to forward this message to broadcast
"RTN","XMXMSGS1",32,0)
 . ; because it has replies, and users with autoforward would not
"RTN","XMXMSGS1",33,0)
 . ; see the replies.  Search for any broadcasts and delete them.
"RTN","XMXMSGS1",34,0)
 . N XMOK
"RTN","XMXMSGS1",35,0)
 . S XMTO="",XMOK=1
"RTN","XMXMSGS1",36,0)
 . F  S XMTO=$O(^TMP("XMY0",$J,XMTO)) Q:XMTO=""  D
"RTN","XMXMSGS1",37,0)
 . . Q:$E(XMTO)'="*"
"RTN","XMXMSGS1",38,0)
 . . S XMOK=0
"RTN","XMXMSGS1",39,0)
 . . I '$D(^TMP("XM",$J,"SAVE")) D SAVEADDR
"RTN","XMXMSGS1",40,0)
 . . D CHKADDR^XMXADDR(XMDUZ,"-"_XMTO)
"RTN","XMXMSGS1",41,0)
 . Q:XMOK
"RTN","XMXMSGS1",42,0)
 . D ERRSET^XMXUTIL(39205,XMZ,XMZ)
"RTN","XMXMSGS1",43,0)
 I $D(XMRESTR("NOFPG")) D
"RTN","XMXMSGS1",44,0)
 . ; The user is not allowed to forward this priority message to groups
"RTN","XMXMSGS1",45,0)
 . ; because s/he is not the originator and does not possess the proper
"RTN","XMXMSGS1",46,0)
 . ; security key.  Search for any groups and delete them.
"RTN","XMXMSGS1",47,0)
 . N XMOK
"RTN","XMXMSGS1",48,0)
 . S XMTO="",XMOK=1
"RTN","XMXMSGS1",49,0)
 . F  S XMTO=$O(^TMP("XMY0",$J,XMTO)) Q:XMTO=""  D
"RTN","XMXMSGS1",50,0)
 . . Q:$E(XMTO,1,2)'="G."
"RTN","XMXMSGS1",51,0)
 . . S XMOK=0
"RTN","XMXMSGS1",52,0)
 . . I '$D(^TMP("XM",$J,"SAVE")) D SAVEADDR
"RTN","XMXMSGS1",53,0)
 . . D CHKADDR^XMXADDR(XMDUZ,"-"_XMTO)
"RTN","XMXMSGS1",54,0)
 . Q:XMOK
"RTN","XMXMSGS1",55,0)
 . D ERRSET^XMXUTIL(39202,XMZ,XMZ)
"RTN","XMXMSGS1",56,0)
 . ;Priority message |1| not forwarded.
"RTN","XMXMSGS1",57,0)
 . ;Only message originator or XM GROUP PRIORITY key holders
"RTN","XMXMSGS1",58,0)
 . ;may forward priority messages to groups.
"RTN","XMXMSGS1",59,0)
 I $D(XMRESTR("NONET")) D
"RTN","XMXMSGS1",60,0)
 . ; The user is not allowed to forward this message to remote sites
"RTN","XMXMSGS1",61,0)
 . ; because it exceeds the site maximum number of lines and
"RTN","XMXMSGS1",62,0)
 . ; s/he does not possess the proper security key.
"RTN","XMXMSGS1",63,0)
 . ; Search for any remote addressees and delete them.
"RTN","XMXMSGS1",64,0)
 . N XMOK
"RTN","XMXMSGS1",65,0)
 . S XMTO="",XMOK=1
"RTN","XMXMSGS1",66,0)
 . F  S XMTO=$O(^TMP("XMY0",$J,XMTO)) Q:XMTO=""  D
"RTN","XMXMSGS1",67,0)
 . . Q:XMTO'["@"
"RTN","XMXMSGS1",68,0)
 . . S XMOK=0
"RTN","XMXMSGS1",69,0)
 . . I '$D(^TMP("XM",$J,"SAVE")) D SAVEADDR
"RTN","XMXMSGS1",70,0)
 . . D CHKADDR^XMXADDR(XMDUZ,"-"_XMTO)
"RTN","XMXMSGS1",71,0)
 . Q:XMOK
"RTN","XMXMSGS1",72,0)
 . N XMPARM S XMPARM(1)=XMZ,XMPARM(2)=XMRESTR("NONET")
"RTN","XMXMSGS1",73,0)
 . D ERRSET^XMXUTIL(39203,.XMPARM,XMZ)
"RTN","XMXMSGS1",74,0)
 . ;Message |1| not forwarded to remote recipients.
"RTN","XMXMSGS1",75,0)
 . ;Only XMMGR key holders may forward to remotes sites
"RTN","XMXMSGS1",76,0)
 . ;messages which exceed site maximum of |2| lines.
"RTN","XMXMSGS1",77,0)
 Q
"RTN","XMXMSGS1",78,0)
SAVEADDR ; Save addressees
"RTN","XMXMSGS1",79,0)
 S %X="^TMP(""XMY"",$J,",%Y="^TMP(""XM"",$J,""SAVE"",""XMY""," D %XY^%RCR
"RTN","XMXMSGS1",80,0)
 S %X="^TMP(""XMY0"",$J,",%Y="^TMP(""XM"",$J,""SAVE"",""XMY0""," D %XY^%RCR
"RTN","XMXMSGS1",81,0)
 Q
"RTN","XMXMSGS1",82,0)
RESTADDR ; Restore addressees
"RTN","XMXMSGS1",83,0)
 S %X="^TMP(""XM"",$J,""SAVE"",""XMY"",",%Y="^TMP(""XMY"",$J," D %XY^%RCR
"RTN","XMXMSGS1",84,0)
 S %X="^TMP(""XM"",$J,""SAVE"",""XMY0"",",%Y="^TMP(""XMY0"",$J," D %XY^%RCR
"RTN","XMXMSGS1",85,0)
 K ^TMP("XM",$J,"SAVE")
"RTN","XMXMSGS1",86,0)
 Q
"RTN","XMXMSGS1",87,0)
FWDONE(XMDUZ,XMZ,XMTO,XMINSTR,XMCNT) ; Forward one message
"RTN","XMXMSGS1",88,0)
XFWDONE ;
"RTN","XMXMSGS1",89,0)
 N XMZREC,XMRESTR
"RTN","XMXMSGS1",90,0)
 S XMZREC=^XMB(3.9,XMZ,0)
"RTN","XMXMSGS1",91,0)
 Q:'$$FORWARD^XMXSEC(XMDUZ,XMZ,XMZREC)
"RTN","XMXMSGS1",92,0)
 D:$G(XMINSTR("ADDR FLAGS"))'["I" INIT^XMXADDR
"RTN","XMXMSGS1",93,0)
 D:$G(XMINSTR("ADDR FLAGS"))'["R" GETRESTR^XMXSEC1(XMDUZ,XMZ,XMZREC,.XMRESTR)
"RTN","XMXMSGS1",94,0)
 D CHKADDR^XMXADDR(XMDUZ,.XMTO,.XMINSTR,.XMRESTR)
"RTN","XMXMSGS1",95,0)
 D FWDIT(XMDUZ,XMZ,.XMINSTR,.XMCNT)
"RTN","XMXMSGS1",96,0)
 Q
"RTN","XMXMSGS1",97,0)
FWDIT(XMDUZ,XMZ,XMINSTR,XMCNT) ;
"RTN","XMXMSGS1",98,0)
 I $$GOTADDR^XMXADDR D  Q
"RTN","XMXMSGS1",99,0)
 . D FWD^XMKP(XMDUZ,XMZ,.XMINSTR)
"RTN","XMXMSGS1",100,0)
 . S:$D(XMCNT) XMCNT=XMCNT+1
"RTN","XMXMSGS1",101,0)
 ;Message |1| has no addressees.  Not forwarded.
"RTN","XMXMSGS1",102,0)
 D ERRSET^XMXUTIL(39204,XMZ,XMZ)
"RTN","XMXMSGS1",103,0)
 Q
"RTN","XMXMSGS1",104,0)
PRT(XMDUZ,XMZ) ; Print
"RTN","XMXMSGS1",105,0)
XPRT ;
"RTN","XMXMSGS1",106,0)
 S ^TMP("XM",$J,"XMZ",XMZ)=""
"RTN","XMXMSGS1",107,0)
 S XMCNT=$G(XMCNT)+1
"RTN","XMXMSGS1",108,0)
 Q
"RTN","XMXMSGS1",109,0)
XP(XMDUZ,XMK,XMZ,XMTPRI,XMCNT)      ; Toggle Transmission Priority
"RTN","XMXMSGS1",110,0)
XXP ;
"RTN","XMXMSGS1",111,0)
 S:'$G(XMK) XMK=$O(^XMB(3.7,"M",XMZ,XMDUZ,""))
"RTN","XMXMSGS1",112,0)
 I XMDUZ'=.5!(XMK'>999) D  Q  ;Transmit priority toggle valid only
"RTN","XMXMSGS1",113,0)
 . D ERRSET^XMXUTIL(37219.5)  ;for Postmaster transmission queues.
"RTN","XMXMSGS1",114,0)
 Q:XMTPRI=$P(^XMB(3.7,XMDUZ,2,XMK,1,XMZ,0),U,6)
"RTN","XMXMSGS1",115,0)
 N XMFDA
"RTN","XMXMSGS1",116,0)
 S XMFDA(3.702,XMZ_","_XMK_","_XMDUZ_",",6)=XMTPRI
"RTN","XMXMSGS1",117,0)
 D FILE^DIE("","XMFDA")
"RTN","XMXMSGS1",118,0)
 S:$D(XMCNT) XMCNT=XMCNT+1
"RTN","XMXMSGS1",119,0)
 Q
"RTN","XMXMSGS1",120,0)
PUTSERV(XMKN,XMZ) ; Replaces SETSB^XMA1C (ISC-WASH/ACC/IHS)
"RTN","XMXMSGS1",121,0)
 ; Put message in Postmaster's basket for this server.
"RTN","XMXMSGS1",122,0)
 ; Create server basket as needed.
"RTN","XMXMSGS1",123,0)
 ; XMKN  Full server name (with S.)
"RTN","XMXMSGS1",124,0)
 ; XMZ   Message number
"RTN","XMXMSGS1",125,0)
 ;
"RTN","XMXMSGS1",126,0)
 ; Messages to server are saved in a mail basket of the
"RTN","XMXMSGS1",127,0)
 ; Postmaster much like transmission queues.  But while
"RTN","XMXMSGS1",128,0)
 ; Domain queues point at the domain file (domain#+1000),
"RTN","XMXMSGS1",129,0)
 ; Server baskets point at the option file (option#+10000).
"RTN","XMXMSGS1",130,0)
 N XMK
"RTN","XMXMSGS1",131,0)
 S XMK=$O(^DIC(19,"B",$E(XMKN,3,999),0)) Q:'XMK
"RTN","XMXMSGS1",132,0)
 S XMK=XMK+10000
"RTN","XMXMSGS1",133,0)
 D PUTMSG^XMXMSGS2(.5,XMK,XMKN,XMZ)
"RTN","XMXMSGS1",134,0)
 Q
"RTN","XMXMSGS1",135,0)
ZAPSERV(XMKN,XMZ) ; Replaces REMSBMSG^XMA1C (ISC-WASH/ACC/IHS)
"RTN","XMXMSGS1",136,0)
 ; Remove message from server basket
"RTN","XMXMSGS1",137,0)
 ; XMKN  Full server name (with S.)
"RTN","XMXMSGS1",138,0)
 ; XMZ   Message number
"RTN","XMXMSGS1",139,0)
 N XMK
"RTN","XMXMSGS1",140,0)
 S XMK=$O(^XMB(3.7,.5,2,"B",XMKN,0)) Q:'XMK  Q:XMK'>10000
"RTN","XMXMSGS1",141,0)
 D ZAPIT^XMXMSGS2(.5,XMK,XMZ)
"RTN","XMXMSGS1",142,0)
 Q
"RTN","XMXMSGS2")
0^374^B45234380
"RTN","XMXMSGS2",1,0)
XMXMSGS2 ;ISC-SF/GMB-Message APIs (cont.) ;04/17/2002  14:11
"RTN","XMXMSGS2",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMXMSGS2",3,0)
DEL(XMDUZ,XMK,XMZ,XMCNT) ; For many messages, pass in XMCNT; for 1, don't
"RTN","XMXMSGS2",4,0)
XDEL ;
"RTN","XMXMSGS2",5,0)
 I '$G(XMK) S XMK=$O(^XMB(3.7,"M",XMZ,XMDUZ,"")) Q:'XMK
"RTN","XMXMSGS2",6,0)
 I XMDUZ'=DUZ,'$$DELETE^XMXSEC(XMDUZ,XMK,XMZ) Q
"RTN","XMXMSGS2",7,0)
 S:$D(XMCNT) XMCNT=XMCNT+1
"RTN","XMXMSGS2",8,0)
 D ZAPIT(XMDUZ,XMK,XMZ,.XMCNT)
"RTN","XMXMSGS2",9,0)
 D WASTEIT(XMDUZ,XMK,XMZ)
"RTN","XMXMSGS2",10,0)
 Q
"RTN","XMXMSGS2",11,0)
FLTR(XMDUZ,XMK,XMKN,XMZ,XMCNT,XMKTO,XMKNTO) ; Filter message
"RTN","XMXMSGS2",12,0)
XFLTR ;
"RTN","XMXMSGS2",13,0)
 ; XMK    (in) the basket # the message is currently in.  (May be 0 if
"RTN","XMXMSGS2",14,0)
 ;             the message isn't currently in a basket.)
"RTN","XMXMSGS2",15,0)
 ; XMKN   (in) the name of basket XMK
"RTN","XMXMSGS2",16,0)
 ; XMKTO  (out) the basket # this routine decides to put the message in
"RTN","XMXMSGS2",17,0)
 ; XMKNTO (out) the name of basket XMKTO
"RTN","XMXMSGS2",18,0)
 ; This routine decides which basket the message belongs in.
"RTN","XMXMSGS2",19,0)
 ; If this is the same basket it is currently in, it sets XMKTO and
"RTN","XMXMSGS2",20,0)
 ; XMKNTO to the current basket.
"RTN","XMXMSGS2",21,0)
 ; Otherwise, it moves the message (from the current basket) to the
"RTN","XMXMSGS2",22,0)
 ; decided-upon basket and sets XMKTO and XMKNTO to that basket.
"RTN","XMXMSGS2",23,0)
 ; If the message is in the WASTE basket, and no filters are defined,
"RTN","XMXMSGS2",24,0)
 ; it will be moved to the IN basket.
"RTN","XMXMSGS2",25,0)
 I '$G(XMK) D
"RTN","XMXMSGS2",26,0)
 . S XMK=$O(^XMB(3.7,"M",XMZ,XMDUZ,""))
"RTN","XMXMSGS2",27,0)
 . S:XMK XMKN=$P(^XMB(3.7,XMDUZ,2,XMK,0),U,1)
"RTN","XMXMSGS2",28,0)
 I XMDUZ=.6,XMK'=.5,'$$MOVE^XMXSEC(XMDUZ,XMZ) Q
"RTN","XMXMSGS2",29,0)
 S:$D(XMCNT) XMCNT=XMCNT+1
"RTN","XMXMSGS2",30,0)
 I $D(^XMB(3.7,XMDUZ,15,"AF")) D
"RTN","XMXMSGS2",31,0)
 . N XMZREC
"RTN","XMXMSGS2",32,0)
 . S XMZREC=$G(^XMB(3.9,XMZ,0))
"RTN","XMXMSGS2",33,0)
 . D FILTER^XMTDF(XMDUZ,XMZ,$P(XMZREC,U,1),$P(XMZREC,U,2),.XMKTO,.XMKNTO)
"RTN","XMXMSGS2",34,0)
 . I XMKTO=1,XMK>1 S XMKTO=XMK,XMKNTO=XMKN
"RTN","XMXMSGS2",35,0)
 E  I XMK>1 S XMKTO=XMK,XMKNTO=XMKN
"RTN","XMXMSGS2",36,0)
 E  S XMKTO=1,XMKNTO=$$EZBLD^DIALOG(37005) ; "IN"
"RTN","XMXMSGS2",37,0)
 Q:XMK=XMKTO
"RTN","XMXMSGS2",38,0)
 I XMK D MOVEIT(XMDUZ,XMK,XMZ,XMKTO,.XMCNT) Q
"RTN","XMXMSGS2",39,0)
 D PUTMSG(XMDUZ,XMKTO,XMKNTO,XMZ)
"RTN","XMXMSGS2",40,0)
 Q
"RTN","XMXMSGS2",41,0)
LATER(XMDUZ,XMZ,XMWHEN,XMCNT) ;
"RTN","XMXMSGS2",42,0)
XLATER ;
"RTN","XMXMSGS2",43,0)
 S:$D(XMCNT) XMCNT=XMCNT+1
"RTN","XMXMSGS2",44,0)
 D LTRADD^XMJMD(XMDUZ,XMZ,XMWHEN)
"RTN","XMXMSGS2",45,0)
 Q
"RTN","XMXMSGS2",46,0)
MOVE(XMDUZ,XMK,XMZ,XMKTO,XMCNT) ;
"RTN","XMXMSGS2",47,0)
XMOVE ;
"RTN","XMXMSGS2",48,0)
 I XMDUZ=.6,'$$MOVE^XMXSEC(XMDUZ,XMZ) Q
"RTN","XMXMSGS2",49,0)
 ; If 2 users are reading the same msg at the same time, one may get an
"RTN","XMXMSGS2",50,0)
 ; abort if tries to save msg to another bskt, if the msg has already
"RTN","XMXMSGS2",51,0)
 ; been moved by the other user.  So this next line makes sure no abort.
"RTN","XMXMSGS2",52,0)
 I '$D(^XMB(3.7,"M",XMZ,XMDUZ,+$G(XMK))) S XMK=$O(^XMB(3.7,"M",XMZ,XMDUZ,""))
"RTN","XMXMSGS2",53,0)
 Q:XMK=XMKTO
"RTN","XMXMSGS2",54,0)
 I XMKTO=.5,'$$DELETE^XMXSEC(XMDUZ,"",XMZ) Q  ; Can't save confidential to WASTE bskt.
"RTN","XMXMSGS2",55,0)
 D MOVEIT(XMDUZ,XMK,XMZ,XMKTO,.XMCNT)
"RTN","XMXMSGS2",56,0)
 S:$D(XMCNT) XMCNT=XMCNT+1
"RTN","XMXMSGS2",57,0)
 Q
"RTN","XMXMSGS2",58,0)
MOVEIT(XMDUZ,XMK,XMZ,XMKTO,XMCNT) ;
"RTN","XMXMSGS2",59,0)
 I XMK D
"RTN","XMXMSGS2",60,0)
 . D COPYIT(XMDUZ,XMK,XMZ,XMKTO,.XMCNT)
"RTN","XMXMSGS2",61,0)
 . D ZAPIT(XMDUZ,XMK,XMZ,.XMCNT)
"RTN","XMXMSGS2",62,0)
 ; The message is not in the user's mailbox
"RTN","XMXMSGS2",63,0)
 E  D PUTMSG(XMDUZ,XMKTO,$P(^XMB(3.7,XMDUZ,2,XMKTO,0),U),XMZ)
"RTN","XMXMSGS2",64,0)
 Q
"RTN","XMXMSGS2",65,0)
NTOGL(XMDUZ,XMK,XMKN,XMZ,XMCNT,XMKTO,XMKNTO) ;
"RTN","XMXMSGS2",66,0)
XNTOGL ;
"RTN","XMXMSGS2",67,0)
 ; If XMK>.5, then it's simple.  Just toggle the 'new' flag.
"RTN","XMXMSGS2",68,0)
 ; If XMK<1, we know the message is not new, and we need to make it new.
"RTN","XMXMSGS2",69,0)
 ; Filter it, but if it filters to the WASTE basket put it in the IN.
"RTN","XMXMSGS2",70,0)
 ; Then make it new.
"RTN","XMXMSGS2",71,0)
 I '$G(XMK) D
"RTN","XMXMSGS2",72,0)
 . S XMK=$O(^XMB(3.7,"M",XMZ,XMDUZ,""))
"RTN","XMXMSGS2",73,0)
 . S:XMK XMKN=$P(^XMB(3.7,XMDUZ,2,XMK,0),U,1)
"RTN","XMXMSGS2",74,0)
 I XMK<1 D
"RTN","XMXMSGS2",75,0)
 . I $D(^XMB(3.7,XMDUZ,15,"AF")) D
"RTN","XMXMSGS2",76,0)
 . . N XMZREC
"RTN","XMXMSGS2",77,0)
 . . S XMZREC=$G(^XMB(3.9,XMZ,0))
"RTN","XMXMSGS2",78,0)
 . . D FILTER^XMTDF(XMDUZ,XMZ,$P(XMZREC,U,1),$P(XMZREC,U,2),.XMKTO,.XMKNTO)
"RTN","XMXMSGS2",79,0)
 . . I XMKTO=1,XMK>1 S XMKTO=XMK,XMKNTO=XMKN Q
"RTN","XMXMSGS2",80,0)
 . . I XMKTO<1 S XMKTO=1,XMKNTO=$$EZBLD^DIALOG(37005) ; "IN"
"RTN","XMXMSGS2",81,0)
 . E  I XMK>1 S XMKTO=XMK,XMKNTO=XMKN
"RTN","XMXMSGS2",82,0)
 . E  S XMKTO=1,XMKNTO=$$EZBLD^DIALOG(37005) ; "IN"
"RTN","XMXMSGS2",83,0)
 . Q:XMK=XMKTO
"RTN","XMXMSGS2",84,0)
 . I XMK D MOVEIT(XMDUZ,XMK,XMZ,XMKTO,.XMCNT) Q
"RTN","XMXMSGS2",85,0)
 . D PUTMSG(XMDUZ,XMKTO,XMKNTO,XMZ)
"RTN","XMXMSGS2",86,0)
 E  S XMKTO=XMK,XMKNTO=XMKN
"RTN","XMXMSGS2",87,0)
 I $D(XMCNT) D  Q
"RTN","XMXMSGS2",88,0)
 . N XMFDA
"RTN","XMXMSGS2",89,0)
 . I $$NEW^XMXUTIL2(XMDUZ,XMKTO,XMZ) D
"RTN","XMXMSGS2",90,0)
 . . S XMFDA(3.702,XMZ_","_XMKTO_","_XMDUZ_",",3)="@" ; no longer new
"RTN","XMXMSGS2",91,0)
 . . S XMCNT(XMKTO,"DECR")=$G(XMCNT(XMKTO,"DECR"))+1
"RTN","XMXMSGS2",92,0)
 . E  D
"RTN","XMXMSGS2",93,0)
 . . S XMFDA(3.702,XMZ_","_XMKTO_","_XMDUZ_",",3)="1" ; new
"RTN","XMXMSGS2",94,0)
 . . S XMCNT(XMKTO,"INCR")=$G(XMCNT(XMKTO,"INCR"))+1
"RTN","XMXMSGS2",95,0)
 . D FILE^DIE("","XMFDA")
"RTN","XMXMSGS2",96,0)
 . S XMCNT=XMCNT+1
"RTN","XMXMSGS2",97,0)
 I $$NEW^XMXUTIL2(XMDUZ,XMKTO,XMZ) D NONEW^XMXUTIL(XMDUZ,XMKTO,XMZ) Q
"RTN","XMXMSGS2",98,0)
 D MAKENEW^XMXUTIL(XMDUZ,XMKTO,XMZ)
"RTN","XMXMSGS2",99,0)
 Q
"RTN","XMXMSGS2",100,0)
TERM(XMDUZ,XMK,XMZ,XMCNT) ;
"RTN","XMXMSGS2",101,0)
XTERM ;
"RTN","XMXMSGS2",102,0)
 N XMIEN
"RTN","XMXMSGS2",103,0)
 S:'$G(XMK) XMK=$O(^XMB(3.7,"M",XMZ,XMDUZ,""))
"RTN","XMXMSGS2",104,0)
 I XMDUZ'=DUZ,'$$DELETE^XMXSEC(XMDUZ,XMK,XMZ) Q
"RTN","XMXMSGS2",105,0)
 I XMK D
"RTN","XMXMSGS2",106,0)
 . D ZAPIT(XMDUZ,XMK,XMZ,.XMCNT)
"RTN","XMXMSGS2",107,0)
 . D WASTEIT(XMDUZ,XMK,XMZ)
"RTN","XMXMSGS2",108,0)
 S XMIEN=+$O(^XMB(3.9,XMZ,1,"C",XMDUZ,0))
"RTN","XMXMSGS2",109,0)
 S:XMIEN ^XMB(3.9,XMZ,1,XMIEN,"D")=DT
"RTN","XMXMSGS2",110,0)
 S:$D(XMCNT) XMCNT=XMCNT+1
"RTN","XMXMSGS2",111,0)
 Q
"RTN","XMXMSGS2",112,0)
VAPOR(XMDUZ,XMK,XMZ,XMWHEN,XMCNT) ;
"RTN","XMXMSGS2",113,0)
XVAPOR ;
"RTN","XMXMSGS2",114,0)
 I '$G(XMK) S XMK=$O(^XMB(3.7,"M",XMZ,XMDUZ,"")) Q:'XMK
"RTN","XMXMSGS2",115,0)
 I XMDUZ'=DUZ,'$$DELETE^XMXSEC(XMDUZ,XMK,XMZ) Q
"RTN","XMXMSGS2",116,0)
 S:$D(XMCNT) XMCNT=XMCNT+1
"RTN","XMXMSGS2",117,0)
 D KVAPOR^XMXUTIL(XMDUZ,XMK,XMZ,XMWHEN)
"RTN","XMXMSGS2",118,0)
 Q
"RTN","XMXMSGS2",119,0)
PUTMSG(XMDUZ,XMK,XMKN,XMZ) ; For internal MM use only.
"RTN","XMXMSGS2",120,0)
 ; Replaces SETSB^XMA1C, SET^XMS1, & part of MAIL^XMR0B
"RTN","XMXMSGS2",121,0)
 ; Put a msg in the Postmaster's (or anyone else's) basket.
"RTN","XMXMSGS2",122,0)
 ; The msg is NOT made new.
"RTN","XMXMSGS2",123,0)
 ; The basket has a specific name and number.
"RTN","XMXMSGS2",124,0)
 ; If the basket doesn't exist, create it.
"RTN","XMXMSGS2",125,0)
 ; XMK      Basket number
"RTN","XMXMSGS2",126,0)
 ; XMKN     Basket name
"RTN","XMXMSGS2",127,0)
 ; XMZ      Msg number
"RTN","XMXMSGS2",128,0)
 N XMFDA,XMIEN,XMTRIES
"RTN","XMXMSGS2",129,0)
 Q:$D(^XMB(3.7,XMDUZ,2,XMK,1,XMZ,0))
"RTN","XMXMSGS2",130,0)
 I XMDUZ'=.5 D RESURECT(XMDUZ,XMZ)
"RTN","XMXMSGS2",131,0)
 I $D(^XMB(3.7,XMDUZ,2,XMK)) D
"RTN","XMXMSGS2",132,0)
 . S XMFDA(3.702,"+1,"_XMK_","_XMDUZ_",",.01)=XMZ
"RTN","XMXMSGS2",133,0)
 . S XMIEN(1)=XMZ
"RTN","XMXMSGS2",134,0)
 E  D
"RTN","XMXMSGS2",135,0)
 . S XMFDA(3.701,"+1,"_XMDUZ_",",.01)=XMKN
"RTN","XMXMSGS2",136,0)
 . S XMFDA(3.702,"+2,+1,"_XMDUZ_",",.01)=XMZ
"RTN","XMXMSGS2",137,0)
 . S XMIEN(1)=XMK
"RTN","XMXMSGS2",138,0)
 . S XMIEN(2)=XMZ
"RTN","XMXMSGS2",139,0)
PTRY D UPDATE^DIE("S","XMFDA","XMIEN") Q:'$D(DIERR)
"RTN","XMXMSGS2",140,0)
 S XMTRIES=$G(XMTRIES)+1
"RTN","XMXMSGS2",141,0)
 I $D(^TMP("DIERR",$J,"E",110)) H 1 G PTRY ; Try again if can't lock
"RTN","XMXMSGS2",142,0)
 Q
"RTN","XMXMSGS2",143,0)
COPYIT(XMDUZ,XMK,XMZ,XMKTO,XMCNT) ;
"RTN","XMXMSGS2",144,0)
 Q:$D(^XMB(3.7,XMDUZ,2,XMKTO,1,XMZ))  ; Message already exists at destination
"RTN","XMXMSGS2",145,0)
 N XMFDA,XMKREC,XMIENS,XMIEN,XMTRIES
"RTN","XMXMSGS2",146,0)
 S XMKREC=^XMB(3.7,XMDUZ,2,XMK,1,XMZ,0)
"RTN","XMXMSGS2",147,0)
 S XMIENS="+1,"_XMKTO_","_XMDUZ_","
"RTN","XMXMSGS2",148,0)
 S XMIEN(1)=XMZ
"RTN","XMXMSGS2",149,0)
 S XMFDA(3.702,XMIENS,.01)=XMZ
"RTN","XMXMSGS2",150,0)
 I XMKTO'=.5 D
"RTN","XMXMSGS2",151,0)
 . I $P(XMKREC,U,3) S XMFDA(3.702,XMIENS,3)=$P(XMKREC,U,3) ; new flag
"RTN","XMXMSGS2",152,0)
 . I '$P(XMKREC,U,7),$P(XMKREC,U,5) S XMFDA(3.702,XMIENS,5)=$P(XMKREC,U,5) ; vapor date
"RTN","XMXMSGS2",153,0)
 S:$P(XMKREC,U,4) XMFDA(3.702,XMIENS,4)=$P(XMKREC,U,4) ; date last accessed
"RTN","XMXMSGS2",154,0)
 S:$P(XMKREC,U,6) XMFDA(3.702,XMIENS,6)=$P(XMKREC,U,6) ; ntwk msg flag
"RTN","XMXMSGS2",155,0)
CTRY D UPDATE^DIE("S","XMFDA","XMIEN")
"RTN","XMXMSGS2",156,0)
 I '$D(DIERR) D  Q
"RTN","XMXMSGS2",157,0)
 . I XMK=.5 D RESURECT(XMDUZ,XMZ) Q
"RTN","XMXMSGS2",158,0)
 . Q:'$G(XMFDA(3.702,XMIENS,3))  ; quit if not new
"RTN","XMXMSGS2",159,0)
 . I $D(XMCNT) S XMCNT(XMKTO,"INCR")=$G(XMCNT(XMKTO,"INCR"))+1 Q
"RTN","XMXMSGS2",160,0)
 . D INCRNEW^XMXUTIL(XMDUZ,XMKTO) ; Increment new counts
"RTN","XMXMSGS2",161,0)
 S XMTRIES=$G(XMTRIES)+1
"RTN","XMXMSGS2",162,0)
 I $D(^TMP("DIERR",$J,"E",110)) H 1 G CTRY ; Try again if can't lock
"RTN","XMXMSGS2",163,0)
 Q
"RTN","XMXMSGS2",164,0)
RESURECT(XMDUZ,XMZ) ; If msg was terminated, "unterminate" it.
"RTN","XMXMSGS2",165,0)
 N XMIEN
"RTN","XMXMSGS2",166,0)
 S XMIEN=+$O(^XMB(3.9,XMZ,1,"C",XMDUZ,0))
"RTN","XMXMSGS2",167,0)
 K:$D(^XMB(3.9,XMZ,1,XMIEN,"D")) ^XMB(3.9,XMZ,1,XMIEN,"D")
"RTN","XMXMSGS2",168,0)
 Q
"RTN","XMXMSGS2",169,0)
ZAPIT(XMDUZ,XMK,XMZ,XMCNT) ;
"RTN","XMXMSGS2",170,0)
 I $D(^XMB(3.7,XMDUZ,"N0",XMK,XMZ)) D
"RTN","XMXMSGS2",171,0)
 . I $D(XMCNT) S XMCNT(XMK,"DECR")=$G(XMCNT(XMK,"DECR"))+1 Q
"RTN","XMXMSGS2",172,0)
 . D DECRNEW^XMXUTIL(XMDUZ,XMK)
"RTN","XMXMSGS2",173,0)
 N DA,DIK
"RTN","XMXMSGS2",174,0)
 S DA(2)=XMDUZ,DA(1)=XMK,DA=XMZ
"RTN","XMXMSGS2",175,0)
 S DIK="^XMB(3.7,"_XMDUZ_",2,"_XMK_",1,"
"RTN","XMXMSGS2",176,0)
 D ^DIK
"RTN","XMXMSGS2",177,0)
 Q
"RTN","XMXMSGS2",178,0)
WASTEIT(XMDUZ,XMK,XMZ) ;
"RTN","XMXMSGS2",179,0)
 Q:XMK=.5
"RTN","XMXMSGS2",180,0)
 Q:$D(^XMB(3.7,XMDUZ,2,.5,1,XMZ))  ; Already in wastebasket
"RTN","XMXMSGS2",181,0)
 N XMFDA,XMIENS,XMIEN,XMTRIES
"RTN","XMXMSGS2",182,0)
 S XMK=.5
"RTN","XMXMSGS2",183,0)
 D:'$D(^XMB(3.7,XMDUZ,2,.5,0)) MAKEBSKT^XMXBSKT(XMDUZ,.5,$$EZBLD^DIALOG(37004)) ; WASTE
"RTN","XMXMSGS2",184,0)
 S XMIENS="+1,"_XMK_","_XMDUZ_","
"RTN","XMXMSGS2",185,0)
 S XMIEN(1)=XMZ
"RTN","XMXMSGS2",186,0)
 S XMFDA(3.702,XMIENS,.01)=XMZ
"RTN","XMXMSGS2",187,0)
 S XMFDA(3.702,XMIENS,4)=DT  ; date last accessed
"RTN","XMXMSGS2",188,0)
WTRY D UPDATE^DIE("S","XMFDA","XMIEN") Q:'$D(DIERR)
"RTN","XMXMSGS2",189,0)
 S XMTRIES=$G(XMTRIES)+1
"RTN","XMXMSGS2",190,0)
 I $D(^TMP("DIERR",$J,"E",110)) H 1 G WTRY ; Try again if can't lock
"RTN","XMXMSGS2",191,0)
 Q
"RTN","XMXPARM")
0^93^B71472333
"RTN","XMXPARM",1,0)
XMXPARM ;ISC-SF/GMB-Parameter check ;04/19/2002  12:11
"RTN","XMXPARM",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMXPARM",3,0)
ACTMSGS(XMDUZ,XMK,XMKZA) ;
"RTN","XMXPARM",4,0)
 K XMERR,^TMP("XMERR",$J)
"RTN","XMXPARM",5,0)
 D XMDUZ(.XMDUZ,.XMV)
"RTN","XMXPARM",6,0)
 I $G(XMK)'="" S XMK=$$XMK(XMDUZ,"XMK",XMK)
"RTN","XMXPARM",7,0)
 D XMKZA^XMXPARM1(.XMKZA)
"RTN","XMXPARM",8,0)
 Q
"RTN","XMXPARM",9,0)
ACTMSG(XMDUZ,XMK,XMKZ) ;
"RTN","XMXPARM",10,0)
 K XMERR,^TMP("XMERR",$J)
"RTN","XMXPARM",11,0)
 D XMDUZ(.XMDUZ,.XMV)
"RTN","XMXPARM",12,0)
 I $G(XMK)'="" D
"RTN","XMXPARM",13,0)
 . S XMK=$$XMK(XMDUZ,"XMK",XMK)
"RTN","XMXPARM",14,0)
 . D XMKZ^XMXPARM1(XMK,.XMKZ)
"RTN","XMXPARM",15,0)
 E  D XMZ(.XMKZ)
"RTN","XMXPARM",16,0)
 Q
"RTN","XMXPARM",17,0)
ANSRMSG(XMDUZ,XMK,XMKZ,XMSUBJ,XMBODY,XMTO,XMINSTR) ;
"RTN","XMXPARM",18,0)
 D ACTMSG(.XMDUZ,.XMK,.XMKZ)
"RTN","XMXPARM",19,0)
 I $G(XMSUBJ)'="" S XMSUBJ=$$XMSUBJ("XMSUBJ",$G(XMSUBJ))
"RTN","XMXPARM",20,0)
 D XMBODY^XMXPARM1(.XMBODY)
"RTN","XMXPARM",21,0)
 D:$D(XMTO) XMTO^XMXPARM1(.XMTO,$G(XMINSTR("ADDR FLAGS"))["I") ; truly optional
"RTN","XMXPARM",22,0)
 D:$D(XMINSTR) XMINSTR(.XMINSTR)
"RTN","XMXPARM",23,0)
 Q
"RTN","XMXPARM",24,0)
BULLETIN(XMDUZ,XMBN,XMPARM,XMBODY,XMTO,XMINSTR,XMATTACH) ;
"RTN","XMXPARM",25,0)
 K XMERR,^TMP("XMERR",$J)
"RTN","XMXPARM",26,0)
 D XMDUZ(.XMDUZ,.XMV)
"RTN","XMXPARM",27,0)
 D XMBN^XMXPARM1(.XMBN)
"RTN","XMXPARM",28,0)
 D:$D(XMBODY) XMBODY^XMXPARM1(.XMBODY,1)
"RTN","XMXPARM",29,0)
 D:$D(XMTO) XMTO^XMXPARM1(.XMTO,$G(XMINSTR("ADDR FLAGS"))["I") ; truly optional
"RTN","XMXPARM",30,0)
 D:$D(XMINSTR) XMINSTR(.XMINSTR)
"RTN","XMXPARM",31,0)
 Q
"RTN","XMXPARM",32,0)
FWDMSG(XMDUZ,XMK,XMKZA,XMTO,XMINSTR) ;
"RTN","XMXPARM",33,0)
 D ACTMSGS(.XMDUZ,.XMK,.XMKZA)
"RTN","XMXPARM",34,0)
 D XMTO^XMXPARM1(.XMTO,$G(XMINSTR("ADDR FLAGS"))["I") ; need at least one
"RTN","XMXPARM",35,0)
 D:$D(XMINSTR) XMINSTR(.XMINSTR)
"RTN","XMXPARM",36,0)
 Q
"RTN","XMXPARM",37,0)
LATERMSG(XMDUZ,XMK,XMKZA,XMINSTR) ;
"RTN","XMXPARM",38,0)
 D ACTMSGS(.XMDUZ,.XMK,.XMKZA)
"RTN","XMXPARM",39,0)
 I $D(XMINSTR("LATER")) D  Q
"RTN","XMXPARM",40,0)
 . ;I XMINSTR("LATER")="@" Q
"RTN","XMXPARM",41,0)
 . S XMINSTR("LATER")=$$XMDATE("XMINSTR(""LATER"")",XMINSTR("LATER"))
"RTN","XMXPARM",42,0)
 I $G(XMINSTR)'="" D  Q
"RTN","XMXPARM",43,0)
 . ;I XMINSTR="@" Q
"RTN","XMXPARM",44,0)
 . S XMINSTR=$$XMDATE("LATER",XMINSTR)
"RTN","XMXPARM",45,0)
 D ERRSET^XMXUTIL(39419) ;Later date must be supplied.
"RTN","XMXPARM",46,0)
 Q
"RTN","XMXPARM",47,0)
MOVEMSG(XMDUZ,XMK,XMKZA,XMKTO) ;
"RTN","XMXPARM",48,0)
 D ACTMSGS(.XMDUZ,.XMK,.XMKZA)
"RTN","XMXPARM",49,0)
 D XMKTO(XMDUZ,.XMKTO)
"RTN","XMXPARM",50,0)
 Q
"RTN","XMXPARM",51,0)
PRTMSG(XMDUZ,XMK,XMKZA,XMPRTTO,XMINSTR,XMSUBJ,XMTO) ;
"RTN","XMXPARM",52,0)
 D ACTMSGS(.XMDUZ,.XMK,.XMKZA)
"RTN","XMXPARM",53,0)
 Q:'$D(XMINSTR)
"RTN","XMXPARM",54,0)
 I $D(XMINSTR("WHEN")) S XMINSTR("WHEN")=$$XMDATE("XMINSTR(""WHEN"")",XMINSTR("WHEN"))
"RTN","XMXPARM",55,0)
 I $D(XMINSTR("HDR")) D XMCODE^XMXPARM1("XMINSTR(""HDR"")",XMINSTR("HDR"),"^0^1^")
"RTN","XMXPARM",56,0)
 I $D(XMINSTR("RECIPS")) D XMCODE^XMXPARM1("XMINSTR(""RECIPS"")",XMINSTR("RECIPS"),"^0^1^2^")
"RTN","XMXPARM",57,0)
 I $G(XMSUBJ)'="" S XMSUBJ=$$XMSUBJ("XMSUBJ",$G(XMSUBJ))
"RTN","XMXPARM",58,0)
 I $D(XMTO) D XMTO^XMXPARM1(.XMTO,$G(XMINSTR("ADDR FLAGS"))["I") ; ok
"RTN","XMXPARM",59,0)
 Q
"RTN","XMXPARM",60,0)
REPLYMSG(XMDUZ,XMK,XMKZ,XMBODY,XMINSTR) ;
"RTN","XMXPARM",61,0)
 D ACTMSG(.XMDUZ,.XMK,.XMKZ)
"RTN","XMXPARM",62,0)
 D XMBODY^XMXPARM1(.XMBODY)
"RTN","XMXPARM",63,0)
 D:$D(XMINSTR) XMINSTR(.XMINSTR)
"RTN","XMXPARM",64,0)
 I $G(XMINSTR("NET REPLY")),$G(XMINSTR("NET SUBJ"))'="" S XMINSTR("NET SUBJ")=$$XMSUBJ("XMINSTR(""NET SUBJ"")",XMINSTR("NET SUBJ"))
"RTN","XMXPARM",65,0)
 Q
"RTN","XMXPARM",66,0)
SENDMSG(XMDUZ,XMSUBJ,XMBODY,XMTO,XMINSTR,XMATTACH) ;
"RTN","XMXPARM",67,0)
 K XMERR,^TMP("XMERR",$J)
"RTN","XMXPARM",68,0)
 D XMDUZ(.XMDUZ,.XMV)
"RTN","XMXPARM",69,0)
 S XMSUBJ=$$XMSUBJ("XMSUBJ",$G(XMSUBJ))
"RTN","XMXPARM",70,0)
 D XMBODY^XMXPARM1(.XMBODY)
"RTN","XMXPARM",71,0)
 D XMTO^XMXPARM1(.XMTO,$G(XMINSTR("ADDR FLAGS"))["I") ; need at least one
"RTN","XMXPARM",72,0)
 D:$D(XMINSTR) XMINSTR(.XMINSTR)
"RTN","XMXPARM",73,0)
 D:$D(XMATTACH) XMATTACH^XMXPARM1(.XMATTACH)
"RTN","XMXPARM",74,0)
 Q
"RTN","XMXPARM",75,0)
VAPORMSG(XMDUZ,XMK,XMKZA,XMINSTR) ;
"RTN","XMXPARM",76,0)
 D ACTMSGS(.XMDUZ,.XMK,.XMKZA)
"RTN","XMXPARM",77,0)
 I $D(XMINSTR("VAPOR")) D  Q
"RTN","XMXPARM",78,0)
 . I XMINSTR("VAPOR")="@" Q
"RTN","XMXPARM",79,0)
 . S XMINSTR("VAPOR")=$$XMDATE("XMINSTR(""VAPOR"")",XMINSTR("VAPOR"))
"RTN","XMXPARM",80,0)
 I $G(XMINSTR)'="" D  Q
"RTN","XMXPARM",81,0)
 . I XMINSTR="@" Q
"RTN","XMXPARM",82,0)
 . S XMINSTR=$$XMDATE("VAPOR",XMINSTR)
"RTN","XMXPARM",83,0)
 D ERRSET^XMXUTIL(39417) ;Vaporize date must be supplied.
"RTN","XMXPARM",84,0)
 Q
"RTN","XMXPARM",85,0)
ADDRNSND(XMDUZ,XMZ,XMTO,XMINSTR) ;
"RTN","XMXPARM",86,0)
 K XMERR,^TMP("XMERR",$J)
"RTN","XMXPARM",87,0)
 D XMDUZ(.XMDUZ,.XMV)
"RTN","XMXPARM",88,0)
 D XMZ(.XMZ)
"RTN","XMXPARM",89,0)
 D XMTO^XMXPARM1(.XMTO,$G(XMINSTR("ADDR FLAGS"))["I") ; need at least one
"RTN","XMXPARM",90,0)
 D:$D(XMINSTR) XMINSTR(.XMINSTR)
"RTN","XMXPARM",91,0)
 Q
"RTN","XMXPARM",92,0)
VSUBJ(XMSUBJ) ;
"RTN","XMXPARM",93,0)
 K XMERR,^TMP("XMERR",$J)
"RTN","XMXPARM",94,0)
 S XMSUBJ=$$XMSUBJ("XMSUBJ",$G(XMSUBJ))
"RTN","XMXPARM",95,0)
 Q
"RTN","XMXPARM",96,0)
ITOWHOM(XMDUZ,XMZ,XMTYPE,XMINSTR) ;
"RTN","XMXPARM",97,0)
 K XMERR,^TMP("XMERR",$J)
"RTN","XMXPARM",98,0)
 D XMDUZ(.XMDUZ,.XMV)
"RTN","XMXPARM",99,0)
 D XMFLAG("XMTYPE",XMTYPE,"SF")
"RTN","XMXPARM",100,0)
 I XMTYPE'="S",XMINSTR("ADDR FLAGS")'["R" D XMZ(.XMZ)
"RTN","XMXPARM",101,0)
 D:$D(XMINSTR) XMINSTR(.XMINSTR)
"RTN","XMXPARM",102,0)
 Q
"RTN","XMXPARM",103,0)
TOWHOM(XMDUZ,XMZ,XMTYPE,XMTO,XMINSTR) ;
"RTN","XMXPARM",104,0)
 D ITOWHOM(.XMDUZ,.XMZ,.XMTYPE,.XMINSTR)
"RTN","XMXPARM",105,0)
 D XMTO^XMXPARM1(XMTO,$G(XMINSTR("ADDR FLAGS"))["I") ; need at least one
"RTN","XMXPARM",106,0)
 Q
"RTN","XMXPARM",107,0)
XMDUZ(XMDUZ,XMV) ;
"RTN","XMXPARM",108,0)
 S:$G(XMDUZ)="" XMDUZ=DUZ
"RTN","XMXPARM",109,0)
 D CHKUSER^XMXPARM1(.XMDUZ)
"RTN","XMXPARM",110,0)
 ; Need XMV "NAME","DUZ NAME", "NETNAME", "VERSION"
"RTN","XMXPARM",111,0)
 ; ^XMB("NETNAME"),^XMB("NUM"),^XMB("VIA")
"RTN","XMXPARM",112,0)
 I XMDUZ'=DUZ D
"RTN","XMXPARM",113,0)
 . I $D(^XUSEC("XMNOPRIV",DUZ)) D  Q  ;You have been given the XMNOPRIV
"RTN","XMXPARM",114,0)
 . . D ERRSET^XMXUTIL(38053) ;key and may not become anyone's surrogate.
"RTN","XMXPARM",115,0)
 . I XMDUZ'=.6,'$D(^XMB(3.7,"AB",DUZ,XMDUZ)) D  Q
"RTN","XMXPARM",116,0)
 . . ;You are not authorized to be a surrogate of DUZ |1|.
"RTN","XMXPARM",117,0)
 . . D ERRSET^XMXUTIL(39401,XMDUZ)
"RTN","XMXPARM",118,0)
 I $D(XMV("VERSION")),$G(XMV("DUZ NAME"))=$$NAME^XMXUTIL(DUZ),$G(XMV("NAME"))=$$NAME^XMXUTIL(XMDUZ) Q
"RTN","XMXPARM",119,0)
 D INITAPI^XMVVITAE
"RTN","XMXPARM",120,0)
 Q
"RTN","XMXPARM",121,0)
XMSUBJ(XMPARM,XMSUBJ) ; Validate a prospective message subject
"RTN","XMXPARM",122,0)
 ;I $G(XMSUBJ)="" D ERRSET^XMXUTIL(39402) Q ""  ;No subject.
"RTN","XMXPARM",123,0)
 I XMSUBJ?.E1C.E S XMSUBJ=$$CTRL^XMXUTIL1(XMSUBJ)
"RTN","XMXPARM",124,0)
 I $E(XMSUBJ,1)=" "!($E(XMSUBJ,$L(XMSUBJ))=" ") S XMSUBJ=$$STRIP^XMXUTIL1(XMSUBJ)
"RTN","XMXPARM",125,0)
 I XMSUBJ["   " S XMSUBJ=$$MAXBLANK^XMXUTIL1(XMSUBJ)
"RTN","XMXPARM",126,0)
 I $G(XMSUBJ)="" Q $$EZBLD^DIALOG(34012) ;* No Subject *
"RTN","XMXPARM",127,0)
 I $L(XMSUBJ)+(2*($L(XMSUBJ,U)-1))>65!($L(XMSUBJ)<3) D  Q XMSUBJ
"RTN","XMXPARM",128,0)
 . D ERRSET^XMXUTIL(39403) ;Subject must be from 3 to 65 characters long.
"RTN","XMXPARM",129,0)
 I XMSUBJ?1"R".N D  Q XMSUBJ
"RTN","XMXPARM",130,0)
 . D ERRSET^XMXUTIL(39404) ;Subject 'Rnnn' reserved.
"RTN","XMXPARM",131,0)
 ;D CHK^DIE(3.9,.01,"H",XMSUBJ)
"RTN","XMXPARM",132,0)
 Q XMSUBJ
"RTN","XMXPARM",133,0)
XMINSTR(XMINSTR) ; Validate special instructions
"RTN","XMXPARM",134,0)
 S:$D(XMINSTR("RCPT BSKT")) XMINSTR("RCPT BSKT")=$$XMKN^XMXPARMB(XMDUZ,"XMINSTR(""RCPT BSKT"")",XMINSTR("RCPT BSKT"),1)
"RTN","XMXPARM",135,0)
 S:$D(XMINSTR("SELF BSKT")) XMINSTR("SELF BSKT")=$$XMK(XMDUZ,"XMINSTR(""SELF BSKT"")",XMINSTR("SELF BSKT"),1)
"RTN","XMXPARM",136,0)
 I $D(XMINSTR("SHARE DATE")) S XMINSTR("SHARE DATE")=$$XMDATE("XMINSTR(""SHARE DATE"")",XMINSTR("SHARE DATE"))
"RTN","XMXPARM",137,0)
 S:$D(XMINSTR("SHARE BSKT")) XMINSTR("SHARE BSKT")=$$XMK(.6,"XMINSTR(""SHARE BSKT"")",XMINSTR("SHARE BSKT"),1)
"RTN","XMXPARM",138,0)
 I $D(XMINSTR("VAPOR")) S XMINSTR("VAPOR")=$$XMDATE("XMINSTR(""VAPOR"")",XMINSTR("VAPOR"))
"RTN","XMXPARM",139,0)
 I $D(XMINSTR("LATER")) S XMINSTR("LATER")=$$XMDATE("XMINSTR(""LATER"")",XMINSTR("LATER"))
"RTN","XMXPARM",140,0)
 I $D(XMINSTR("FROM")) S XMINSTR("FROM")=$$XMFROM("XMINSTR(""FROM"")",XMINSTR("FROM"))
"RTN","XMXPARM",141,0)
 I $D(XMINSTR("FWD BY")) S XMINSTR("FWD BY")=$$XMFROM("XMINSTR(""FWD BY"")",XMINSTR("FWD BY"))
"RTN","XMXPARM",142,0)
 D:$D(XMINSTR("FLAGS")) XMFLAG("XMINSTR(""FLAGS"")",XMINSTR("FLAGS"),"CIPRSX")
"RTN","XMXPARM",143,0)
 I $D(XMINSTR("SCR KEY"))!$D(XMINSTR("SCR HINT")) D
"RTN","XMXPARM",144,0)
 . D XMKEY^XMXPARM1($G(XMINSTR("SCR KEY")))
"RTN","XMXPARM",145,0)
 . D XMHINT^XMXPARM1($G(XMINSTR("SCR HINT")))
"RTN","XMXPARM",146,0)
 D:$D(XMINSTR("TYPE")) XMTYPE(XMINSTR("TYPE"))
"RTN","XMXPARM",147,0)
 D:$D(XMINSTR("STRIP")) XMSTRIP^XMXPARM1(XMINSTR("STRIP"))
"RTN","XMXPARM",148,0)
 Q
"RTN","XMXPARM",149,0)
XMDATE(XMPARM,XMDATE) ;
"RTN","XMXPARM",150,0)
 N %DT,Y,X
"RTN","XMXPARM",151,0)
 S X=XMDATE
"RTN","XMXPARM",152,0)
 S %DT="FT",%DT(0)="NOW"
"RTN","XMXPARM",153,0)
 D ^%DT
"RTN","XMXPARM",154,0)
 Q:Y>0 Y
"RTN","XMXPARM",155,0)
 N XMP
"RTN","XMXPARM",156,0)
 S XMP("PARAM","ID")=XMPARM
"RTN","XMXPARM",157,0)
 S XMP("PARAM","VALUE")=XMDATE
"RTN","XMXPARM",158,0)
 D ERRSET^XMXUTIL(39409,.XMP) ;Must be a date in the future.
"RTN","XMXPARM",159,0)
 Q XMDATE
"RTN","XMXPARM",160,0)
XMFROM(XMPARM,XMFROM) ;
"RTN","XMXPARM",161,0)
 N XMHOLD
"RTN","XMXPARM",162,0)
 Q:XMFROM=.5 XMFROM
"RTN","XMXPARM",163,0)
 I +XMFROM=XMFROM!(XMFROM[U)!($L(XMFROM)>65)!(XMFROM="") D  Q XMFROM
"RTN","XMXPARM",164,0)
 . N XMP S XMP("PARAM","ID")=XMPARM,XMP("PARAM","VALUE")=XMFROM
"RTN","XMXPARM",165,0)
 . ;S XMP("PARAM","FILE")=X,XMP("PARAM","FIELD")=Y
"RTN","XMXPARM",166,0)
 . ;Must be from 1 to 65 characters, no # or ^.
"RTN","XMXPARM",167,0)
 . D ERRSET^XMXUTIL(39410,.XMP)
"RTN","XMXPARM",168,0)
 S XMHOLD=XMFROM
"RTN","XMXPARM",169,0)
 S XMFROM=$$CTRL^XMXUTIL1(XMFROM)
"RTN","XMXPARM",170,0)
 S XMFROM=$$STRIP^XMXUTIL1(XMFROM)
"RTN","XMXPARM",171,0)
 S XMFROM=$$MAXBLANK^XMXUTIL1(XMFROM)
"RTN","XMXPARM",172,0)
 Q:XMFROM["POSTMASTER" XMFROM
"RTN","XMXPARM",173,0)
 ; "B^BB^C^D" = name^alias^initial^nickname
"RTN","XMXPARM",174,0)
 I $$FIND1^DIC(200,"","O",$$UP^XLFSTR(XMFROM),"B^BB^C^D")!$D(DIERR) D  Q XMHOLD
"RTN","XMXPARM",175,0)
 . N XMP S XMP("PARAM","ID")=XMPARM,XMP("PARAM","VALUE")=XMHOLD
"RTN","XMXPARM",176,0)
 . ;S XMP("PARAM","FILE")=X,XMP("PARAM","FIELD")=Y
"RTN","XMXPARM",177,0)
 . D ERRSET^XMXUTIL(39411,.XMP) ;May not be a real person.
"RTN","XMXPARM",178,0)
 Q XMFROM
"RTN","XMXPARM",179,0)
XMTYPE(XMTYPE) ; Validate a message type
"RTN","XMXPARM",180,0)
 I $L(XMTYPE)'=1 D  Q
"RTN","XMXPARM",181,0)
 . N XMP S XMP("PARAM","ID")="XMINSTR(""TYPE"")",XMP("PARAM","VALUE")=XMTYPE
"RTN","XMXPARM",182,0)
 . ;S XMPARM("PARAM","FILE")=3.9,XMPARM("PARAM","FIELD")=1.7
"RTN","XMXPARM",183,0)
 . D ERRSET^XMXUTIL(39412,.XMP) ;Must be 1 character.
"RTN","XMXPARM",184,0)
 D XMFLAG("XMINSTR(""TYPE"")",XMTYPE,"BDKOSX")
"RTN","XMXPARM",185,0)
 Q
"RTN","XMXPARM",186,0)
XMFLAG(XMPARM,XMFLAG,FLAGSET) ;
"RTN","XMXPARM",187,0)
 N XMLEFT
"RTN","XMXPARM",188,0)
 S XMLEFT=$TR(XMFLAG,FLAGSET,"")
"RTN","XMXPARM",189,0)
 Q:XMLEFT=""
"RTN","XMXPARM",190,0)
 N XMP S XMP("PARAM","ID")=XMPARM,XMP("PARAM","VALUE")=XMFLAG,XMP(1)=XMLEFT
"RTN","XMXPARM",191,0)
 D ERRSET^XMXUTIL(39413,.XMP) ;|1| is not valid.
"RTN","XMXPARM",192,0)
 Q
"RTN","XMXPARM",193,0)
XMKTO(XMDUZ,XMKTO) ;
"RTN","XMXPARM",194,0)
 I $G(XMKTO)="" D  Q
"RTN","XMXPARM",195,0)
 . N XMP S XMP("PARAM","ID")="XMKTO",XMP("PARAM","VALUE")=""
"RTN","XMXPARM",196,0)
 . D ERRSET^XMXUTIL(39416,.XMP) ;Destination basket must be supplied.
"RTN","XMXPARM",197,0)
 S XMKTO=$$XMK(XMDUZ,"XMKTO",XMKTO)
"RTN","XMXPARM",198,0)
 Q
"RTN","XMXPARM",199,0)
XMK(XMDUZ,XMPARM,XMK,XMOPTNL) ;
"RTN","XMXPARM",200,0)
 I +XMK=XMK,$D(^XMB(3.7,XMDUZ,2,XMK)) Q XMK
"RTN","XMXPARM",201,0)
 ; Just in case a name was passed...
"RTN","XMXPARM",202,0)
 N XMKN
"RTN","XMXPARM",203,0)
 S XMKN=XMK
"RTN","XMXPARM",204,0)
 S XMK=$$FIND1^DIC(3.701,","_XMDUZ_",","OQ",XMKN)
"RTN","XMXPARM",205,0)
 Q:XMK XMK
"RTN","XMXPARM",206,0)
 I '$D(DIERR),$G(XMOPTNL) Q XMKN  ; Basket not found.  Will create on delivery.
"RTN","XMXPARM",207,0)
 N XMP S XMP("PARAM","ID")=XMPARM,XMP("PARAM","VALUE")=XMKN,XMP(1)=XMKN
"RTN","XMXPARM",208,0)
 ;Basket name '|1|' ambiguous / not found.
"RTN","XMXPARM",209,0)
 D ERRSET^XMXUTIL($S($D(DIERR):39414,1:39415),.XMP)
"RTN","XMXPARM",210,0)
 Q XMKN
"RTN","XMXPARM",211,0)
XMZ(XMZ) ;
"RTN","XMXPARM",212,0)
 I $G(XMZ),$D(^XMB(3.9,XMZ,0)) Q
"RTN","XMXPARM",213,0)
 D ERRSET^XMXUTIL(34353,XMZ) ;Message '|1|' does not exist.
"RTN","XMXPARM",214,0)
 Q
"RTN","XMXPARM1")
0^375^B10264070
"RTN","XMXPARM1",1,0)
XMXPARM1 ;ISC-SF/GMB-Parameter check (cont.) ;04/19/2002  12:14
"RTN","XMXPARM1",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMXPARM1",3,0)
CHKUSER(XMDUZ,XMNOMBOX) ; Ascertain/verify user's DUZ, and make sure authorized to use MailMan
"RTN","XMXPARM1",4,0)
 ; XMNOMBOX Is it possible that this user does not have a mailbox?
"RTN","XMXPARM1",5,0)
 ;          0=no (default); 1=yes
"RTN","XMXPARM1",6,0)
 N XMSCREEN,XMUSER,XMADDR
"RTN","XMXPARM1",7,0)
 S XMADDR=XMDUZ
"RTN","XMXPARM1",8,0)
 S XMADDR=$$UP^XLFSTR(XMADDR)
"RTN","XMXPARM1",9,0)
 S:'$G(XMNOMBOX) XMSCREEN="I $L($P(^(0),U,3)),$D(^XMB(3.7,+Y,2))"  ; User must have an access code & mailbox
"RTN","XMXPARM1",10,0)
 ; "B^BB^C^D" = name^alias^initial^nickname
"RTN","XMXPARM1",11,0)
 S XMDUZ=$$FIND1^DIC(200,"","O",$S(+XMADDR=XMADDR:"`"_XMADDR,1:XMADDR),"B^BB^C^D",.XMSCREEN)
"RTN","XMXPARM1",12,0)
 Q:XMDUZ
"RTN","XMXPARM1",13,0)
 S XMDUZ=XMADDR
"RTN","XMXPARM1",14,0)
 D ERRSET^XMXUTIL($S($D(DIERR):39432,1:39433),XMDUZ) ; User '|1|' ambiguous / not found.
"RTN","XMXPARM1",15,0)
 Q
"RTN","XMXPARM1",16,0)
XMATTACH(XMATTACH) ; Validate attachments
"RTN","XMXPARM1",17,0)
 Q
"RTN","XMXPARM1",18,0)
XMBN(XMBN) ; Check bulletin name
"RTN","XMXPARM1",19,0)
 I $G(XMBN)="" D ERRSET^XMXUTIL(39430) Q  ; Bulletin name must be supplied.
"RTN","XMXPARM1",20,0)
 Q:$D(^XMB(3.6,"B",XMBN))
"RTN","XMXPARM1",21,0)
 D ERRSET^XMXUTIL(39431,XMBN) ; Bulletin '|1|' not found.
"RTN","XMXPARM1",22,0)
 Q
"RTN","XMXPARM1",23,0)
XMBODY(XMBODY,XMOPTNL) ; Check the body of the message (just make sure there is a body)
"RTN","XMXPARM1",24,0)
 I $G(XMBODY)="" D  Q
"RTN","XMXPARM1",25,0)
 . I '$G(XMOPTNL) D ERRSET^XMXUTIL(39405) ;Message must have a body.
"RTN","XMXPARM1",26,0)
 I $E(XMBODY,1,6)="XMBODY" D  Q
"RTN","XMXPARM1",27,0)
 . D ERRSET^XMXUTIL(39406) ;Message body may not be called XMBODY.
"RTN","XMXPARM1",28,0)
 I $D(@XMBODY)'>9 D  Q
"RTN","XMXPARM1",29,0)
 . D ERRSET^XMXUTIL(39407,XMBODY) ;Message body '|1|' has no data.
"RTN","XMXPARM1",30,0)
 Q
"RTN","XMXPARM1",31,0)
XMCODE(XMPARM,XMCODE,XMSET) ;
"RTN","XMXPARM1",32,0)
 Q:XMSET[(U_XMCODE_U)
"RTN","XMXPARM1",33,0)
 N XMP
"RTN","XMXPARM1",34,0)
 S XMP("PARAM","ID")=XMPARM
"RTN","XMXPARM1",35,0)
 S XMP("PARAM","VALUE")=XMCODE
"RTN","XMXPARM1",36,0)
 ;S XMP("PARAM","FILE")=3.901,XMP("PARAM","FIELD")=1.8
"RTN","XMXPARM1",37,0)
 S XMP(1)=XMSET
"RTN","XMXPARM1",38,0)
 D ERRSET^XMXUTIL(39438,.XMP) ; Must be one of |1|.
"RTN","XMXPARM1",39,0)
 Q
"RTN","XMXPARM1",40,0)
XMHINT(XMHINT) ; Validate a scramble hint
"RTN","XMXPARM1",41,0)
 I $G(XMHINT)="" Q
"RTN","XMXPARM1",42,0)
 ;I $G(XMHINT)="" D ERRSET^XMXUTIL(39436) Q  ; Scramble hint must be supplied
"RTN","XMXPARM1",43,0)
 ;D CHK^DIE(3.9,1.8,"H",XMHINT)
"RTN","XMXPARM1",44,0)
 I $L(XMHINT)>0,$L(XMHINT)<41,XMHINT'[U Q
"RTN","XMXPARM1",45,0)
 N XMP
"RTN","XMXPARM1",46,0)
 S XMP("PARAM","ID")="XMINSTR(""SCR HINT"")"
"RTN","XMXPARM1",47,0)
 S XMP("PARAM","VALUE")=XMHINT
"RTN","XMXPARM1",48,0)
 ;S XMP("PARAM","FILE")=3.901,XMP("PARAM","FIELD")=1.8
"RTN","XMXPARM1",49,0)
 S XMP(1)=1,XMP(2)=40
"RTN","XMXPARM1",50,0)
 D ERRSET^XMXUTIL(39437,.XMP) ; Must be |1|-|2| characters, no ^.
"RTN","XMXPARM1",51,0)
 Q
"RTN","XMXPARM1",52,0)
XMKEY(XMKEY) ; Validate a scramble key
"RTN","XMXPARM1",53,0)
 I $G(XMKEY)="" D ERRSET^XMXUTIL(39435) Q  ; Scramble key must be supplied.
"RTN","XMXPARM1",54,0)
 ;D CHK^DIE(3.9,1.85,"H",XMKEY)
"RTN","XMXPARM1",55,0)
 I $L(XMKEY)>2,$L(XMKEY)<21 Q
"RTN","XMXPARM1",56,0)
 N XMP
"RTN","XMXPARM1",57,0)
 S XMP("PARAM","ID")="XMINSTR(""SCR KEY"")"
"RTN","XMXPARM1",58,0)
 S XMP("PARAM","VALUE")=XMKEY
"RTN","XMXPARM1",59,0)
 ;S XMP("PARAM","FILE")=3.9,XMP("PARAM","FIELD")=1.85
"RTN","XMXPARM1",60,0)
 S XMP(1)=3,XMP(2)=20
"RTN","XMXPARM1",61,0)
 D ERRSET^XMXUTIL(39434,.XMP) ; Must be |1|-|2| characters.
"RTN","XMXPARM1",62,0)
 Q
"RTN","XMXPARM1",63,0)
XMKZ(XMK,XMKZ) ;
"RTN","XMXPARM1",64,0)
 I $G(XMKZ),$D(^XMB(3.7,XMDUZ,2,XMK,1,"C",XMKZ)) Q
"RTN","XMXPARM1",65,0)
 N XMP S XMP(1)=XMKZ,XMP(2)=XMK
"RTN","XMXPARM1",66,0)
 D ERRSET^XMXUTIL(34351,.XMP) ; message not found in basket
"RTN","XMXPARM1",67,0)
 Q
"RTN","XMXPARM1",68,0)
XMKZA(XMKZA) ; Check the message numbers (just make sure there is at least one)
"RTN","XMXPARM1",69,0)
 Q:$D(XMKZA)
"RTN","XMXPARM1",70,0)
 D ERRSET^XMXUTIL(39418) ;No message numbers.
"RTN","XMXPARM1",71,0)
 Q
"RTN","XMXPARM1",72,0)
XMROOT(XMPARM,XMROOT) ; Validate root
"RTN","XMXPARM1",73,0)
 Q
"RTN","XMXPARM1",74,0)
XMSTRIP(XMSTRIP) ; Validate a message strip string
"RTN","XMXPARM1",75,0)
 I $L(XMSTRIP)>0,$L(XMSTRIP)<21 Q
"RTN","XMXPARM1",76,0)
 N XMP
"RTN","XMXPARM1",77,0)
 S XMP("PARAM","ID")="XMINSTR(""STRIP"")"
"RTN","XMXPARM1",78,0)
 S XMP("PARAM","VALUE")=XMSTRIP
"RTN","XMXPARM1",79,0)
 S XMP(1)=1,XMP(2)=20
"RTN","XMXPARM1",80,0)
 D ERRSET^XMXUTIL(39434,.XMP) ; Must be |1|-|2| characters.
"RTN","XMXPARM1",81,0)
 Q
"RTN","XMXPARM1",82,0)
XMTO(XMTO,XMOPTNL) ; Check the addressees (just make sure there is at least one)
"RTN","XMXPARM1",83,0)
 Q:$D(XMTO)
"RTN","XMXPARM1",84,0)
 I $G(XMOPTNL),$$GOTADDR^XMXADDR Q
"RTN","XMXPARM1",85,0)
 D ERRSET^XMXUTIL(39408) ;No recipients
"RTN","XMXPARM1",86,0)
 Q
"RTN","XMXPARMB")
0^376^B14713222
"RTN","XMXPARMB",1,0)
XMXPARMB ;ISC-SF/GMB-Parameter check for XMXAPIB ;04/17/2002  14:12
"RTN","XMXPARMB",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMXPARMB",3,0)
CRE8MBOX(XMDUZ,XMDATE) ; Create a mailbox for a user
"RTN","XMXPARMB",4,0)
 K XMERR,^TMP("XMERR",$J)
"RTN","XMXPARMB",5,0)
 D CHKUSER^XMXPARM1(.XMDUZ,1)
"RTN","XMXPARMB",6,0)
 I $D(XMDATE) S XMDATE=$$XMDATE("XMDATE",XMDATE)
"RTN","XMXPARMB",7,0)
 Q
"RTN","XMXPARMB",8,0)
XMDATE(XMPARM,XMDATE) ;
"RTN","XMXPARMB",9,0)
 N %DT,Y,X
"RTN","XMXPARMB",10,0)
 S X=XMDATE ;,%DT(0)="-NOW"
"RTN","XMXPARMB",11,0)
 S %DT="X"
"RTN","XMXPARMB",12,0)
 D ^%DT
"RTN","XMXPARMB",13,0)
 Q:Y>0 Y
"RTN","XMXPARMB",14,0)
 N XMP
"RTN","XMXPARMB",15,0)
 S XMP("PARAM","ID")=XMPARM
"RTN","XMXPARMB",16,0)
 S XMP("PARAM","VALUE")=XMDATE
"RTN","XMXPARMB",17,0)
 D ERRSET^XMXUTIL(39420,.XMP) ; Must be an exact date.
"RTN","XMXPARMB",18,0)
 Q XMDATE
"RTN","XMXPARMB",19,0)
VA200(XMDUZ) ; Make sure DUZ exists
"RTN","XMXPARMB",20,0)
 Q:$D(^VA(200,XMDUZ,0))
"RTN","XMXPARMB",21,0)
 N XMP
"RTN","XMXPARMB",22,0)
 S XMP("PARAM","ID")="XMDUZ"
"RTN","XMXPARMB",23,0)
 S XMP("PARAM","VALUE")=XMDUZ,XMP(1)=XMDUZ
"RTN","XMXPARMB",24,0)
 D ERRSET^XMXUTIL(39433,.XMP) ; User '|1|' not found.
"RTN","XMXPARMB",25,0)
 Q
"RTN","XMXPARMB",26,0)
TERMMBOX(XMDUZ) ; Terminate a mailbox (delete all traces of user in MailMan)
"RTN","XMXPARMB",27,0)
 K XMERR,^TMP("XMERR",$J)
"RTN","XMXPARMB",28,0)
 D CHKUSER^XMXPARM1(.XMDUZ,1)
"RTN","XMXPARMB",29,0)
 Q
"RTN","XMXPARMB",30,0)
MBOX(XMDUZ) ; 
"RTN","XMXPARMB",31,0)
 K XMERR,^TMP("XMERR",$J)
"RTN","XMXPARMB",32,0)
 D XMDUZ^XMXPARM(.XMDUZ,.XMV)
"RTN","XMXPARMB",33,0)
 Q
"RTN","XMXPARMB",34,0)
LISTBSKT(XMDUZ,XMFLAGS,XMAMT,XMSTART,XMPART,XMTROOT) ;
"RTN","XMXPARMB",35,0)
 K XMERR,^TMP("XMERR",$J)
"RTN","XMXPARMB",36,0)
 D XMDUZ^XMXPARM(.XMDUZ,.XMV)
"RTN","XMXPARMB",37,0)
 I $D(XMFLAGS) D XMFLAG^XMXPARM("XMFLAGS",XMFLAGS,"BN")
"RTN","XMXPARMB",38,0)
 I $D(XMAMT) D XMAMT("XMAMT",.XMAMT)
"RTN","XMXPARMB",39,0)
 Q
"RTN","XMXPARMB",40,0)
LISTMSGS(XMDUZ,XMK,XMFLDS,XMFLAGS,XMAMT,XMSTART,XMF,XMTROOT) ;
"RTN","XMXPARMB",41,0)
 K XMERR,^TMP("XMERR",$J)
"RTN","XMXPARMB",42,0)
 D XMDUZ^XMXPARM(.XMDUZ,.XMV)
"RTN","XMXPARMB",43,0)
 I $D(XMK) S:"^*^!^"'[(U_XMK_U) XMK=$$XMK^XMXPARM(XMDUZ,"XMK",XMK)
"RTN","XMXPARMB",44,0)
 I $D(XMFLAGS) D XMFLAG^XMXPARM("XMFLAGS",XMFLAGS,"BCNP")
"RTN","XMXPARMB",45,0)
 I $D(XMAMT) D XMAMT("XMAMT",.XMAMT)
"RTN","XMXPARMB",46,0)
 Q
"RTN","XMXPARMB",47,0)
DELBSKT(XMDUZ,XMK,XMFLAGS) ;
"RTN","XMXPARMB",48,0)
 D BSKT(.XMDUZ,.XMK)
"RTN","XMXPARMB",49,0)
 I $D(XMFLAGS) D XMFLAG^XMXPARM("XMFLAGS",XMFLAGS,"D")
"RTN","XMXPARMB",50,0)
 Q
"RTN","XMXPARMB",51,0)
BSKT(XMDUZ,XMK) ; Make sure basket exists
"RTN","XMXPARMB",52,0)
 K XMERR,^TMP("XMERR",$J)
"RTN","XMXPARMB",53,0)
 D XMDUZ^XMXPARM(.XMDUZ,.XMV)
"RTN","XMXPARMB",54,0)
 S:$D(XMK) XMK=$$XMK^XMXPARM(XMDUZ,"XMK",XMK)
"RTN","XMXPARMB",55,0)
 Q
"RTN","XMXPARMB",56,0)
CRE8BSKT(XMDUZ,XMKN) ;
"RTN","XMXPARMB",57,0)
 K XMERR,^TMP("XMERR",$J)
"RTN","XMXPARMB",58,0)
 D XMDUZ^XMXPARM(.XMDUZ,.XMV)
"RTN","XMXPARMB",59,0)
 S XMKN=$$XMKN(XMDUZ,"XMKN",XMKN)
"RTN","XMXPARMB",60,0)
 Q
"RTN","XMXPARMB",61,0)
NAMEBSKT(XMDUZ,XMK,XMKN) ;
"RTN","XMXPARMB",62,0)
 K XMERR,^TMP("XMERR",$J)
"RTN","XMXPARMB",63,0)
 D XMDUZ^XMXPARM(.XMDUZ,.XMV)
"RTN","XMXPARMB",64,0)
 S XMK=$$XMK^XMXPARM(XMDUZ,"XMK",.XMK)
"RTN","XMXPARMB",65,0)
 S XMKN=$$XMKN(XMDUZ,"XMKN",XMKN)
"RTN","XMXPARMB",66,0)
 Q
"RTN","XMXPARMB",67,0)
XMKN(XMDUZ,XMPARM,XMKN,XMOKXST) ; Validate a prospective basket name
"RTN","XMXPARMB",68,0)
 ; XMKN     prospective basket name
"RTN","XMXPARMB",69,0)
 ; XMOKXST  is it OK if a basket with that name already exists? (0=no; 1=yes)
"RTN","XMXPARMB",70,0)
 N XMOK
"RTN","XMXPARMB",71,0)
 I '$G(XMOKXST) D  Q:$D(XMERR) XMKN
"RTN","XMXPARMB",72,0)
 . Q:'$$FIND1^DIC(3.701,","_XMDUZ_",","XQ",XMKN)
"RTN","XMXPARMB",73,0)
 . N XMP
"RTN","XMXPARMB",74,0)
 . S XMP("PARAM","ID")=XMPARM
"RTN","XMXPARMB",75,0)
 . S XMP("PARAM","VALUE")=XMKN,XMP(1)=XMKN
"RTN","XMXPARMB",76,0)
 . D ERRSET^XMXUTIL(39440,.XMP) ; Basket '|1|' already exists.
"RTN","XMXPARMB",77,0)
 D VAL^DIE(3.701,"1,"_XMDUZ_",",.01,"",XMKN,.XMOK) Q:XMOK'=U XMKN
"RTN","XMXPARMB",78,0)
 N XMP
"RTN","XMXPARMB",79,0)
 S XMP("PARAM","ID")=XMPARM
"RTN","XMXPARMB",80,0)
 S XMP("PARAM","VALUE")=XMKN,XMP(1)=2,XMP(2)=30
"RTN","XMXPARMB",81,0)
 D ERRSET^XMXUTIL(39437,.XMP) ; Must be |1|-|2| characters, no ^.
"RTN","XMXPARMB",82,0)
 Q XMKN
"RTN","XMXPARMB",83,0)
XMAMT(XMPARM,XMAMT) ;
"RTN","XMXPARMB",84,0)
 Q:'$D(XMAMT)
"RTN","XMXPARMB",85,0)
 Q:XMAMT=""
"RTN","XMXPARMB",86,0)
 Q:XMAMT="*"
"RTN","XMXPARMB",87,0)
 Q:XMAMT=+XMAMT&(XMAMT>0)
"RTN","XMXPARMB",88,0)
 N XMP
"RTN","XMXPARMB",89,0)
 S XMP("PARAM","ID")=XMPARM
"RTN","XMXPARMB",90,0)
 S XMP("PARAM","VALUE")=XMAMT,XMP(1)=XMAMT
"RTN","XMXPARMB",91,0)
 D ERRSET^XMXUTIL(39441,.XMP) ; Must be a positive number OR *.
"RTN","XMXPARMB",92,0)
 Q
"RTN","XMXPARMB",93,0)
SERV(XMKN,XMZ) ;
"RTN","XMXPARMB",94,0)
 K XMERR,^TMP("XMERR",$J)
"RTN","XMXPARMB",95,0)
 D XMSERV(.XMKN)
"RTN","XMXPARMB",96,0)
 D XMZ^XMXPARM(.XMZ)
"RTN","XMXPARMB",97,0)
 Q
"RTN","XMXPARMB",98,0)
XMSERV(XMKN) ;
"RTN","XMXPARMB",99,0)
 I $E(XMKN,1,2)'="S." D  Q
"RTN","XMXPARMB",100,0)
 . N XMP
"RTN","XMXPARMB",101,0)
 . S XMP("PARAM","ID")="XMKN"
"RTN","XMXPARMB",102,0)
 . S XMP("PARAM","VALUE")=XMKN,XMP(1)=XMKN
"RTN","XMXPARMB",103,0)
 . D ERRSET^XMXUTIL(39442,.XMP) ; Server basket name must begin with 'S.'.
"RTN","XMXPARMB",104,0)
 Q:$O(^DIC(19,"B",$E(XMKN,3,999),0))
"RTN","XMXPARMB",105,0)
 N XMP
"RTN","XMXPARMB",106,0)
 S XMP("PARAM","ID")="XMKN"
"RTN","XMXPARMB",107,0)
 S XMP("PARAM","VALUE")=XMKN,XMP(1)=XMKN
"RTN","XMXPARMB",108,0)
 D ERRSET^XMXUTIL(39443,.XMP) ; Server basket '|1|' not found.  Name must be exact.
"RTN","XMXPARMB",109,0)
 Q
"RTN","XMXPRT")
0^377^B6915293
"RTN","XMXPRT",1,0)
XMXPRT ;ISC-SF/GMB-Print messages ;08/08/2000  14:08
"RTN","XMXPRT",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMXPRT",3,0)
 ; For messages printed to the P-MESSAGE device,
"RTN","XMXPRT",4,0)
 ; XMAPSUBJ = message subject
"RTN","XMXPRT",5,0)
 ; XMY      = message addressees
"RTN","XMXPRT",6,0)
PRINT1(XMDUZ,XMZ,XMPRTTO,XMINSTR,ZTSK,XMAPSUBJ,XMY) ; Print one message
"RTN","XMXPRT",7,0)
 N XMWHICH,XMRECIPS,XMPRTHDR,ZTSAVE,ZTRTN,ZTDESC,ZTIO,ZTDTH,ZTUCI
"RTN","XMXPRT",8,0)
 D PINIT(.XMINSTR,.XMPRTHDR,.XMRECIPS,.XMWHICH,.ZTDTH)
"RTN","XMXPRT",9,0)
 F I="XMV(","DUZ","XMDUZ","XMZ","XMWHICH","XMRECIPS","XMPRTHDR","XMAPSUBJ","XMY(" S ZTSAVE(I)=""
"RTN","XMXPRT",10,0)
 ;S:$D(XMSECURE) (ZTSAVE("XMSECURE"),ZTSAVE("XMSECURE("))=""
"RTN","XMXPRT",11,0)
 S ZTIO=XMPRTTO
"RTN","XMXPRT",12,0)
 S ZTDESC=$$EZBLD^DIALOG(34501) ; MailMan: Print
"RTN","XMXPRT",13,0)
 S ZTRTN="XPMSG^XMXPRT"
"RTN","XMXPRT",14,0)
 D ^%ZTLOAD
"RTN","XMXPRT",15,0)
 Q
"RTN","XMXPRT",16,0)
PRINTM(XMDUZ,XMPRTTO,XMINSTR,ZTSK,XMAPSUBJ,XMY) ; Print more than one message
"RTN","XMXPRT",17,0)
 N XMWHICH,XMRECIPS,XMPRTHDR,ZTSAVE,ZTRTN,ZTDESC,ZTIO,ZTDTH,ZTUCI
"RTN","XMXPRT",18,0)
 D PINIT(.XMINSTR,.XMPRTHDR,.XMRECIPS,.XMWHICH,.ZTDTH)
"RTN","XMXPRT",19,0)
 I "^0^*^"'[(U_XMWHICH_U) S XMWHICH="*"
"RTN","XMXPRT",20,0)
 F I="XMV(","DUZ","XMDUZ","XMZ","XMWHICH","XMRECIPS","XMPRTHDR","^TMP(""XM"",$J,""XMZ"",","XMAPSUBJ","XMY(" S ZTSAVE(I)=""
"RTN","XMXPRT",21,0)
 ;S:$D(XMSECURE) (ZTSAVE("XMSECURE"),ZTSAVE("XMSECURE("))=""
"RTN","XMXPRT",22,0)
 S ZTIO=XMPRTTO
"RTN","XMXPRT",23,0)
 S ZTDESC=$$EZBLD^DIALOG(34501) ; MailMan: Print
"RTN","XMXPRT",24,0)
 S ZTRTN="XPRANGE^XMXPRT"
"RTN","XMXPRT",25,0)
 D ^%ZTLOAD
"RTN","XMXPRT",26,0)
 Q
"RTN","XMXPRT",27,0)
PINIT(XMINSTR,XMPRTHDR,XMRECIPS,XMWHICH,XMWHEN) ;
"RTN","XMXPRT",28,0)
 ; XMPRTHDR 1=Print header (default)
"RTN","XMXPRT",29,0)
 ;          0=don't (headerless print)
"RTN","XMXPRT",30,0)
 ; XMRECIPS 0=Don't print recipients (default)
"RTN","XMXPRT",31,0)
 ;          1=Print summary recipients
"RTN","XMXPRT",32,0)
 ;          2=Print detail recipients
"RTN","XMXPRT",33,0)
 S XMPRTHDR=+$G(XMINSTR("HDR"),1)
"RTN","XMXPRT",34,0)
 S XMRECIPS=+$G(XMINSTR("RECIPS"))
"RTN","XMXPRT",35,0)
 S XMWHICH=$G(XMINSTR("RESPS"),"*")
"RTN","XMXPRT",36,0)
 S XMWHEN=$G(XMINSTR("WHEN"),"NOW")
"RTN","XMXPRT",37,0)
 S XMWHEN=$S(XMWHEN="NOW":$H,1:$$FMTH^XLFDT(XMWHEN))
"RTN","XMXPRT",38,0)
 Q
"RTN","XMXPRT",39,0)
PMSG(XMDUZ,XMZ,XMWHICH,XMRECIPS,XMPRTHDR,XMFIRST) ;
"RTN","XMXPRT",40,0)
XPMSG ;
"RTN","XMXPRT",41,0)
 N XMK,XMKN,XMZREC,XMRESPS,XMPTR
"RTN","XMXPRT",42,0)
 S ZTREQ="@"
"RTN","XMXPRT",43,0)
 S XMK=+$O(^XMB(3.7,"M",XMZ,XMDUZ,""))
"RTN","XMXPRT",44,0)
 S XMKN=$S(XMK:$P(^XMB(3.7,XMDUZ,2,XMK,0),U,1),1:$$EZBLD^DIALOG(34014)) ; * N/A *
"RTN","XMXPRT",45,0)
 D RESPONSE^XMJMP(XMDUZ,XMZ,.XMRESPS,.XMPTR)
"RTN","XMXPRT",46,0)
 S:XMWHICH="*" XMWHICH=$S(XMRESPS:"0-"_XMRESPS,1:0)
"RTN","XMXPRT",47,0)
 S XMZREC=^XMB(3.9,XMZ,0)
"RTN","XMXPRT",48,0)
 I IOST["C-"!'$G(XMFIRST,1) W @IOF
"RTN","XMXPRT",49,0)
 D:XMPRTHDR IDHDR^XMJMP(XMDUZ)
"RTN","XMXPRT",50,0)
 D PRINTIT^XMJMP1(XMDUZ,XMK,XMKN,XMZ,XMZREC,XMRESPS,XMPTR,XMWHICH,XMRECIPS,0,XMPRTHDR)
"RTN","XMXPRT",51,0)
 Q
"RTN","XMXPRT",52,0)
PRANGE(XMDUZ,XMWHICH,XMRECIPS,XMPRTHDR) ;
"RTN","XMXPRT",53,0)
XPRANGE ; Print a range of messages.
"RTN","XMXPRT",54,0)
 N XMZ,XMFIRST
"RTN","XMXPRT",55,0)
 S XMZ=""
"RTN","XMXPRT",56,0)
 S XMFIRST=1
"RTN","XMXPRT",57,0)
 F  S XMZ=$O(^TMP("XM",$J,"XMZ",XMZ)) Q:'XMZ  D
"RTN","XMXPRT",58,0)
 . Q:'$D(^XMB(3.9,XMZ,0))
"RTN","XMXPRT",59,0)
 . D PMSG(XMDUZ,XMZ,XMWHICH,XMRECIPS,XMPRTHDR,.XMFIRST)
"RTN","XMXPRT",60,0)
 . S XMFIRST=0
"RTN","XMXPRT",61,0)
 Q
"RTN","XMXREPLY")
0^94^B15685689
"RTN","XMXREPLY",1,0)
XMXREPLY ;ISC-SF/GMB-Reply to a msg ;04/24/2002  10:29
"RTN","XMXREPLY",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMXREPLY",3,0)
REPLYMSG(XMDUZ,XMK,XMKZ,XMBODY,XMINSTR,XMZR) ;
"RTN","XMXREPLY",4,0)
 ; XMDUZ    DUZ of who the msg is from
"RTN","XMXREPLY",5,0)
 ; XMBODY   Body of the msg
"RTN","XMXREPLY",6,0)
 ;          Must be closed root, passed by value.  See WP_ROOT
"RTN","XMXREPLY",7,0)
 ;          definition for WP^DIE(), FM word processing filer.
"RTN","XMXREPLY",8,0)
 ; XMINSTR("FROM")     String saying from whom (default is XMDUZ)
"RTN","XMXREPLY",9,0)
 ; XMINSTR("STRIP")    String containing chars to strip from msg text
"RTN","XMXREPLY",10,0)
 ; XMINSTR("SCR HINT") Hint to guess the scramble key
"RTN","XMXREPLY",11,0)
 ;                     (must be the hint from original message)
"RTN","XMXREPLY",12,0)
 ; XMINSTR("SCR KEY")  Scramble key, if original message was scrambled.
"RTN","XMXREPLY",13,0)
 ;                     (must be the key from original message, as
"RTN","XMXREPLY",14,0)
 ;                     entered by the user: unscrambled!)
"RTN","XMXREPLY",15,0)
 ; *NOTE: SCR hint and key needed only for remote replies.  Even then,
"RTN","XMXREPLY",16,0)
 ;        they are ignored.  That info is gotten from the original msg.
"RTN","XMXREPLY",17,0)
 ; XMINSTR("NET REPLY") Should reply go over the network? 1=yes; 0=no
"RTN","XMXREPLY",18,0)
 ; XMINSTR("NET SUBJ") Subject for network reply msg, else default to
"RTN","XMXREPLY",19,0)
 ;          "Re: original msg subject"
"RTN","XMXREPLY",20,0)
 ; XMZSENDR XMDUZ of the person who created and sent the msg
"RTN","XMXREPLY",21,0)
 ; If you are not a recipient or the sender, you may not reply.
"RTN","XMXREPLY",22,0)
 ; If msg is in SHARED,MAIL and your DUZ is .6, ERROR! G H^XUS ***
"RTN","XMXREPLY",23,0)
 ; If msg is info only AND you are not the sender, you may not reply.
"RTN","XMXREPLY",24,0)
 ; If msg is info only and broadcast to all local users, may not reply
"RTN","XMXREPLY",25,0)
 ; If you are info only, you may not reply.
"RTN","XMXREPLY",26,0)
 ; If msg is from a remote POSTMASTER, may not reply.
"RTN","XMXREPLY",27,0)
 ; If msg is in waste basket or no basket, move it to a basket.
"RTN","XMXREPLY",28,0)
 ;
"RTN","XMXREPLY",29,0)
 ; Output:
"RTN","XMXREPLY",30,0)
 ; XMZR     msg # holding the reply to XMZ
"RTN","XMXREPLY",31,0)
 N XMZ,XMZREC,XMZSENDR,XMNETMSG
"RTN","XMXREPLY",32,0)
 K XMERR,^TMP("XMERR",$J)
"RTN","XMXREPLY",33,0)
 D CHKMSG^XMXSEC1(XMDUZ,.XMK,.XMKZ,.XMZ,.XMZREC) Q:$D(XMERR)
"RTN","XMXREPLY",34,0)
 Q:'$$REPLY^XMXSEC(XMDUZ,XMZ,XMZREC)
"RTN","XMXREPLY",35,0)
 D:XMK<1 FLTR^XMXMSGS2(XMDUZ,XMK,$S(XMK=.5:$$EZBLD^DIALOG(37004),1:""),XMZ) ; Move msg from WASTE basket
"RTN","XMXREPLY",36,0)
 D CRE8XMZ^XMXSEND("R"_XMZ,.XMZR) Q:$D(XMERR)  ; Create a place for the response in the msg file
"RTN","XMXREPLY",37,0)
 D MOVEBODY^XMXSEND(XMZR,XMBODY) ; Put the msg body in place
"RTN","XMXREPLY",38,0)
 D CHEKBODY^XMXSEND(XMZR,$G(XMINSTR("STRIP")))
"RTN","XMXREPLY",39,0)
 D DOREPLY(XMDUZ,XMZ,XMZR,.XMINSTR)
"RTN","XMXREPLY",40,0)
 S XMZSENDR=$P(XMZREC,U,2)
"RTN","XMXREPLY",41,0)
 S XMNETMSG=$S(XMZSENDR["@":1,1:0)
"RTN","XMXREPLY",42,0)
 I 'XMNETMSG!'$G(XMINSTR("NET REPLY")) Q
"RTN","XMXREPLY",43,0)
 N XMFROM,XMREPLTO
"RTN","XMXREPLY",44,0)
 D REPLYTO(XMZ,.XMFROM,.XMREPLTO)
"RTN","XMXREPLY",45,0)
 D INIT^XMXADDR
"RTN","XMXREPLY",46,0)
 S XMINSTR("EXACT")=1 ; Match on exact domain name
"RTN","XMXREPLY",47,0)
 D CHKADDR^XMXADDR(XMDUZ,$$REMADDR^XMXADDR3($G(XMREPLTO,XMFROM)),.XMINSTR)
"RTN","XMXREPLY",48,0)
 K XMINSTR("EXACT")
"RTN","XMXREPLY",49,0)
 D:'$D(XMERR) NETREPLY(XMDUZ,XMZ,XMZR,$S($G(XMINSTR("NET SUBJ"))'="":XMINSTR("NET SUBJ"),$E($P(XMZREC,U,1),1,4)=$$EZBLD^DIALOG(37006):$E($P(XMZREC,U,1),1,65),1:$E($$EZBLD^DIALOG(37006)_$P(XMZREC,U,1),1,65)),.XMINSTR) ;Re:
"RTN","XMXREPLY",50,0)
 D CLEANUP^XMXADDR
"RTN","XMXREPLY",51,0)
 Q
"RTN","XMXREPLY",52,0)
DOREPLY(XMDUZ,XMZ,XMZR,XMINSTR) ;
"RTN","XMXREPLY",53,0)
 D:$D(XMSECURE) ENCMSG^XMJMCODE(XMZR) ; Scramble the msg, if needed
"RTN","XMXREPLY",54,0)
 D MOVER(XMDUZ,XMZ,XMZR,.XMINSTR) ; Point from response back to original msg
"RTN","XMXREPLY",55,0)
 D RPOST^XMKP(XMDUZ,XMZ,XMZR) ; Point from original msg to response and send the msg
"RTN","XMXREPLY",56,0)
 D CHECK^XMKPL
"RTN","XMXREPLY",57,0)
 Q
"RTN","XMXREPLY",58,0)
NETREPLY(XMDUZ,XMZ,XMZR,XMZRSUBJ,XMINSTR) ;
"RTN","XMXREPLY",59,0)
 N XMFDA,XMIENS
"RTN","XMXREPLY",60,0)
 S XMIENS=XMZR_","
"RTN","XMXREPLY",61,0)
 S XMFDA(3.9,XMIENS,.01)=XMZRSUBJ
"RTN","XMXREPLY",62,0)
 I $D(XMSECURE) D  ; Scramble hint / Scramble key
"RTN","XMXREPLY",63,0)
 . S XMFDA(3.9,XMIENS,1.8)=$P(^XMB(3.9,XMZ,0),U,10) ;XMINSTR("SCR HINT")
"RTN","XMXREPLY",64,0)
 . S XMFDA(3.9,XMIENS,1.85)=^XMB(3.9,XMZ,"K") ;XMINSTR("SCR KEY")
"RTN","XMXREPLY",65,0)
 I $G(^XMB(3.9,XMZ,5))'="" D  ; In response to remote msg id
"RTN","XMXREPLY",66,0)
 . S XMFDA(3.9,XMIENS,9.5)=$E(^XMB(3.9,XMZ,5),1,110)
"RTN","XMXREPLY",67,0)
 D FILE^DIE("","XMFDA")
"RTN","XMXREPLY",68,0)
 D SEND^XMKP(XMDUZ,XMZR)
"RTN","XMXREPLY",69,0)
 Q
"RTN","XMXREPLY",70,0)
MOVER(XMDUZ,XMZ,XMZR,XMINSTR) ;
"RTN","XMXREPLY",71,0)
 N XMFDA,XMIENS
"RTN","XMXREPLY",72,0)
 S XMIENS=XMZR_","
"RTN","XMXREPLY",73,0)
 I $D(XMINSTR("FROM")) D
"RTN","XMXREPLY",74,0)
 . S XMFDA(3.9,XMIENS,1)=XMINSTR("FROM")
"RTN","XMXREPLY",75,0)
 . ;S XMFDA(3.9,XMIENS,1.1)=DUZ
"RTN","XMXREPLY",76,0)
 E  D
"RTN","XMXREPLY",77,0)
 . S XMFDA(3.9,XMIENS,1)=XMDUZ
"RTN","XMXREPLY",78,0)
 . S:XMDUZ'=DUZ XMFDA(3.9,XMIENS,1.1)=DUZ
"RTN","XMXREPLY",79,0)
 S XMFDA(3.9,XMIENS,1.4)=$$NOW^XLFDT()
"RTN","XMXREPLY",80,0)
 S XMFDA(3.9,XMIENS,1.35)=XMZ
"RTN","XMXREPLY",81,0)
 D FILE^DIE("","XMFDA")
"RTN","XMXREPLY",82,0)
 Q
"RTN","XMXREPLY",83,0)
REPLYTO(XMZ,XMFROM,XMREPLTO) ; Get from and reply-to address, if any
"RTN","XMXREPLY",84,0)
 N XMHDR,XMFIND
"RTN","XMXREPLY",85,0)
 S XMFIND="^FROM^REPLY-TO^"
"RTN","XMXREPLY",86,0)
 D HDRFIND^XMR3(XMZ,XMFIND,.XMHDR)
"RTN","XMXREPLY",87,0)
 I $D(XMHDR("FROM")) S XMFROM=XMHDR("FROM")
"RTN","XMXREPLY",88,0)
 E  S XMFROM=$P($G(^XMB(3.9,XMZ,0)),U,2)  ; not really remote msg?
"RTN","XMXREPLY",89,0)
 I $D(XMHDR("REPL")) S XMREPLTO=XMHDR("REPL")
"RTN","XMXREPLY",90,0)
 Q
"RTN","XMXREPLY",91,0)
REPLYTO1(XMZ) ;
"RTN","XMXREPLY",92,0)
 N XMFROM,XMREPLTO
"RTN","XMXREPLY",93,0)
 D REPLYTO(XMZ,.XMFROM,.XMREPLTO)
"RTN","XMXREPLY",94,0)
 Q $$REMADDR^XMXADDR3($G(XMREPLTO,XMFROM))
"RTN","XMXSEC")
0^378^B67205765
"RTN","XMXSEC",1,0)
XMXSEC ;ISC-SF/GMB-Message security and restrictions ;05/17/2002  13:25
"RTN","XMXSEC",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMXSEC",3,0)
 ; All entry points covered by DBIA 2731.
"RTN","XMXSEC",4,0)
BCAST(XMZ) ; 0=msg was not broadcast; 1=msg was broadcast
"RTN","XMXSEC",5,0)
 N XMBCAST
"RTN","XMXSEC",6,0)
 S XMBCAST=$$EZBLD^DIALOG(39006) ; * (Broadcast to all local users)
"RTN","XMXSEC",7,0)
 Q:$D(^XMB(3.9,XMZ,1,"C",$E(XMBCAST,1,30))) 1
"RTN","XMXSEC",8,0)
 Q:$D(^XMB(3.9,XMZ,1,"C",XMBCAST)) 1
"RTN","XMXSEC",9,0)
 Q 0
"RTN","XMXSEC",10,0)
ZCLOSED(XMZ) ;
"RTN","XMXSEC",11,0)
 Q $$CLOSED($G(^XMB(3.9,XMZ,0)))
"RTN","XMXSEC",12,0)
CLOSED(XMZREC) ; 0=msg is not closed; 1=msg is closed
"RTN","XMXSEC",13,0)
 Q "^Y^y^"[(U_$P(XMZREC,U,9)_U)
"RTN","XMXSEC",14,0)
ZCONFID(XMZ) ;
"RTN","XMXSEC",15,0)
 Q $$CONFID($G(^XMB(3.9,XMZ,0)))
"RTN","XMXSEC",16,0)
CONFID(XMZREC) ; 0=msg is not confidential; 1=msg is confidential
"RTN","XMXSEC",17,0)
 Q "^Y^y^"[(U_$P(XMZREC,U,11)_U)
"RTN","XMXSEC",18,0)
ZCONFIRM(XMZ) ;
"RTN","XMXSEC",19,0)
 Q $$CONFIRM($G(^XMB(3.9,XMZ,0)))
"RTN","XMXSEC",20,0)
CONFIRM(XMZREC) ; 0=msg is not confirm receipt requested; 1=msg is confirm
"RTN","XMXSEC",21,0)
 Q "^Y^y^"[(U_$P(XMZREC,U,5)_U)
"RTN","XMXSEC",22,0)
ZINFO(XMZ) ;
"RTN","XMXSEC",23,0)
 Q $$INFO($G(^XMB(3.9,XMZ,0)))
"RTN","XMXSEC",24,0)
INFO(XMZREC) ; 0=msg is not information only; 1=msg is information only
"RTN","XMXSEC",25,0)
 Q "^Y^y^"[(U_$P(XMZREC,U,12)_U)
"RTN","XMXSEC",26,0)
ZORIGIN8(XMDUZ,XMZ) ;
"RTN","XMXSEC",27,0)
 Q $$ORIGIN8R(XMDUZ,$G(^XMB(3.9,XMZ,0)))
"RTN","XMXSEC",28,0)
ORIGIN8R(XMDUZ,XMZREC) ; Did the user send the message?
"RTN","XMXSEC",29,0)
 ; 1=user is the originator ; 0=user is NOT the originator
"RTN","XMXSEC",30,0)
 Q:XMDUZ=$P(XMZREC,U,2) 1
"RTN","XMXSEC",31,0)
 Q:XMDUZ=$P(XMZREC,U,4) 1
"RTN","XMXSEC",32,0)
 Q:XMDUZ=DUZ 0
"RTN","XMXSEC",33,0)
 Q:DUZ=$P(XMZREC,U,2) 1
"RTN","XMXSEC",34,0)
 Q:DUZ=$P(XMZREC,U,4) 1
"RTN","XMXSEC",35,0)
 Q 0
"RTN","XMXSEC",36,0)
ZPRI(XMZ) ;
"RTN","XMXSEC",37,0)
 Q $$PRIORITY($G(^XMB(3.9,XMZ,0)))
"RTN","XMXSEC",38,0)
PRIORITY(XMZREC) ; 0=msg is not priority; 1=msg is priority
"RTN","XMXSEC",39,0)
 Q $P(XMZREC,U,7)["P"
"RTN","XMXSEC",40,0)
SURRCONF(XMDUZ,XMZ) ; 0=msg is not confidential; 1=msg is confidential, and surrogate may not read it.
"RTN","XMXSEC",41,0)
 ; We already know that XMDUZ'=DUZ.
"RTN","XMXSEC",42,0)
 ; But the surrogate may read a confidential message if it was the
"RTN","XMXSEC",43,0)
 ; surrogate who sent it.
"RTN","XMXSEC",44,0)
 Q:"^Y^y^"'[(U_$P($G(^XMB(3.9,+XMZ,0)),U,11)_U) 0
"RTN","XMXSEC",45,0)
 Q:DUZ=$P(^(0),U,2) 0  ; naked ref from above
"RTN","XMXSEC",46,0)
 Q:DUZ=$P(^(0),U,4) 0  ; naked ref from above
"RTN","XMXSEC",47,0)
 Q 1
"RTN","XMXSEC",48,0)
ACCESS(XMDUZ,XMZ,XMZREC) ; Determines user access to a message.
"RTN","XMXSEC",49,0)
 ; 1=user may access; 0=user may not access
"RTN","XMXSEC",50,0)
 Q:$D(^XMB(3.7,"M",XMZ,XMDUZ)) $S(XMDUZ=DUZ:1,1:$$SURRACC(XMDUZ,"",XMZ,$G(XMZREC)))  ; Message is in user's mailbox
"RTN","XMXSEC",51,0)
 N XMPRE
"RTN","XMXSEC",52,0)
 S XMPRE=$P(^XMB(3.7,XMDUZ,0),U,7)
"RTN","XMXSEC",53,0)
 I XMPRE,$P($G(^XMB(3.9,XMZ,.6)),U,1)<XMPRE D  Q 0
"RTN","XMXSEC",54,0)
 . D ERRSET^XMXUTIL(37100,$$MMDT^XMXUTIL1(XMPRE),XMZ) ; You may not access any message prior to _X_ unless someone forwards it to you.
"RTN","XMXSEC",55,0)
 Q:$D(^XMB(3.9,XMZ,1,"C",XMDUZ)) $S(XMDUZ=DUZ:1,1:$$SURRACC(XMDUZ,"",XMZ,$G(XMZREC)))  ; User is recipient
"RTN","XMXSEC",56,0)
 ;Q:$D(^XMB(3.9,XMZ,1,"C",DUZ)) 1 ; Surrogate is a recipient.
"RTN","XMXSEC",57,0)
 ; We comment out the above line, because it's not enough that the
"RTN","XMXSEC",58,0)
 ; surrogate is a recipient of the message.  If the surrogate wants to
"RTN","XMXSEC",59,0)
 ; access the message as XMDUZ, and the message is not in the mailbox
"RTN","XMXSEC",60,0)
 ; of XMDUZ, then the message must have been sent by or to XMDUZ.
"RTN","XMXSEC",61,0)
 Q:$$BCAST(XMZ) 1
"RTN","XMXSEC",62,0)
 I $G(XMZREC)="" S XMZREC=$G(^XMB(3.9,XMZ,0))
"RTN","XMXSEC",63,0)
 I $P(XMZREC,U,8) D  Q 0
"RTN","XMXSEC",64,0)
 . N XMPARM
"RTN","XMXSEC",65,0)
 . S XMPARM(1)=XMZ,XMPARM(2)=$P(XMZREC,U,8)
"RTN","XMXSEC",66,0)
 . D ERRSET^XMXUTIL(37101,.XMPARM,XMZ) ; Message _XMZ_ is a response to message _$P(XMZREC,U,8)_.
"RTN","XMXSEC",67,0)
 ; User (XMDUZ) is not a recipient.  Investigate further.
"RTN","XMXSEC",68,0)
 Q $$ACCESS2^XMXSEC1(XMDUZ,XMZ,XMZREC)
"RTN","XMXSEC",69,0)
SURRACC(XMDUZ,XMACCESS,XMZ,XMZREC) ; Determines surrogate access to a message.
"RTN","XMXSEC",70,0)
 ; Assumes that we already know that XMDUZ is authorized to see this
"RTN","XMXSEC",71,0)
 ; message, and that XMDUZ'=DUZ.  Now we want to know if DUZ may see it.
"RTN","XMXSEC",72,0)
 ; 1=surrogate may access; 0=surrogate may not access
"RTN","XMXSEC",73,0)
 I $G(XMZREC)="" S XMZREC=$G(^XMB(3.9,XMZ,0))
"RTN","XMXSEC",74,0)
 Q:'$$CONFID(XMZREC) 1  ; Message isn't confidential.
"RTN","XMXSEC",75,0)
 Q:DUZ=$P(XMZREC,U,2) 1 ; Surrogate sent the message.
"RTN","XMXSEC",76,0)
 Q:DUZ=$P(XMZREC,U,4) 1 ; Surrogate sent the message.
"RTN","XMXSEC",77,0)
 ;Q:$D(^XMB(3.9,XMZ,1,"C",DUZ)) 1 ; Surrogate is a recipient.
"RTN","XMXSEC",78,0)
 I $G(XMACCESS)'="" D ERRSET^XMXUTIL(37452,XMACCESS,XMZ) Q 0  ; Surrogates may not _XMACCESS_ CONFIDENTIAL messages.
"RTN","XMXSEC",79,0)
 D ERRSET^XMXUTIL(37451,XMZ) ; Surrogates may not access or do anything to Confidential messages.
"RTN","XMXSEC",80,0)
 Q 0
"RTN","XMXSEC",81,0)
ANSWER(XMDUZ,XMZ,XMZREC) ; Answer (1=may, 0=may not)
"RTN","XMXSEC",82,0)
 I DUZ=.6!(XMDUZ=.6) D ERRSET^XMXUTIL(37462,"",XMZ) Q 0  ; You may not do this in SHARED,MAIL.
"RTN","XMXSEC",83,0)
 I XMDUZ'=DUZ Q:'$$WPRIV 0  Q:'$$SURRACC(XMDUZ,"",XMZ,.XMZREC) 0  ; "answer"
"RTN","XMXSEC",84,0)
 I $G(XMZREC)="" S XMZREC=$G(^XMB(3.9,XMZ,0))
"RTN","XMXSEC",85,0)
 I $$PAKMAN^XMXSEC1(XMZ,XMZREC) D ERRSET^XMXUTIL(37401.4,"",XMZ) Q 0  ; May not answer a PackMan message.
"RTN","XMXSEC",86,0)
 I $D(^XMB(3.9,XMZ,"K")) D ERRSET^XMXUTIL(47401.2,"",XMZ) Q 0  ; May not answer a scrambled message.  Use Reply.
"RTN","XMXSEC",87,0)
 I '$$GOTNS^XMVVITA(XMDUZ) D ERRSET^XMXUTIL($S(XMDUZ=DUZ:37401.1,1:37401.3),XMV("NAME"),XMZ) Q 0  ; You / X must have a network signature in order to answer a message.
"RTN","XMXSEC",88,0)
 Q 1
"RTN","XMXSEC",89,0)
COPY(XMDUZ,XMZ,XMZREC) ; Copy (1=may, 0=may not)
"RTN","XMXSEC",90,0)
 I XMDUZ'=DUZ Q:'$$WPRIV 0  Q:'$$SURRACC(XMDUZ,"",XMZ,.XMZREC) 0  ; "copy"
"RTN","XMXSEC",91,0)
 I $G(XMZREC)="" S XMZREC=$G(^XMB(3.9,XMZ,0))
"RTN","XMXSEC",92,0)
 I $$CLOSED(XMZREC),'$$ORIGIN8R(XMDUZ,XMZREC) D ERRSET^XMXUTIL(37403.1,"",XMZ) Q 0  ; Only the message originator may copy CLOSED messages.
"RTN","XMXSEC",93,0)
 I XMDUZ=.6,DUZ'=$P(XMZREC,U,2),DUZ'=$P(XMZREC,U,4) D ERRSET^XMXUTIL(37403.6,"",XMZ) Q 0  ; Only the originator may copy messages in SHARED,MAIL.
"RTN","XMXSEC",94,0)
 I $D(^XMB(3.9,XMZ,"K")) D ERRSET^XMXUTIL(37403.2,"",XMZ) Q 0  ; May not copy a scrambled message.
"RTN","XMXSEC",95,0)
 Q 1
"RTN","XMXSEC",96,0)
INCLUDE(XMDUZ,XMZ,XMZREC) ; Include message XMZ as part of another message (1=may, 0=may not)
"RTN","XMXSEC",97,0)
 ; If XMDUZ'=DUZ, assumes that surrogate has the privilege to
"RTN","XMXSEC",98,0)
 ; send a new message, or reply to a message.
"RTN","XMXSEC",99,0)
 Q:'$$ACCESS(XMDUZ,XMZ,.XMZREC) 0
"RTN","XMXSEC",100,0)
 I $G(XMZREC)="" S XMZREC=$G(^XMB(3.9,XMZ,0))
"RTN","XMXSEC",101,0)
 I $$CLOSED(XMZREC),'$$ORIGIN8R(XMDUZ,XMZREC) D ERRSET^XMXUTIL(37403.1,"",XMZ) Q 0  ; Only the message originator may copy CLOSED messages.
"RTN","XMXSEC",102,0)
 I $D(^XMB(3.9,XMZ,"K")) D ERRSET^XMXUTIL(37403.2,"",XMZ) Q 0  ; May not copy a scrambled message.
"RTN","XMXSEC",103,0)
 Q 1
"RTN","XMXSEC",104,0)
DELETE(XMDUZ,XMK,XMZ,XMZREC) ; Delete, Terminate (1=may, 0=may not)
"RTN","XMXSEC",105,0)
 Q:XMDUZ=DUZ 1
"RTN","XMXSEC",106,0)
 Q:'$$RWPRIV 0
"RTN","XMXSEC",107,0)
 ;I XMDUZ=.5,$G(XMK,$O(^XMB(3.7,"M",XMZ,XMDUZ,"")))>999 Q 1
"RTN","XMXSEC",108,0)
 I XMDUZ=.5 Q 1
"RTN","XMXSEC",109,0)
 Q:'$$SURRACC(XMDUZ,"",XMZ,.XMZREC) 0  ; "delete"
"RTN","XMXSEC",110,0)
 I $G(XMZREC)="" S XMZREC=$G(^XMB(3.9,XMZ,0))
"RTN","XMXSEC",111,0)
 I XMDUZ=.6,DUZ'=$P(XMZREC,U,2),DUZ'=$P(XMZREC,U,4),'$D(^XUSEC("XMMGR",DUZ)),'$D(^XMB(3.7,"AB",DUZ,.5,0)) D  Q 0
"RTN","XMXSEC",112,0)
 . D ERRSET^XMXUTIL(37461,"",XMZ) ; Only the originator, postmaster surrogate, or XMMGR key holder may do this in SHARED,MAIL.
"RTN","XMXSEC",113,0)
 Q 1
"RTN","XMXSEC",114,0)
FORWARD(XMDUZ,XMZ,XMZREC) ; Forward (1=may, 0=may not)
"RTN","XMXSEC",115,0)
 I XMDUZ'=DUZ Q:'$$RWPRIV 0  Q:'$$SURRACC(XMDUZ,"",XMZ,.XMZREC) 0  ; "forward"
"RTN","XMXSEC",116,0)
 I $G(XMZREC)="" S XMZREC=$G(^XMB(3.9,XMZ,0))
"RTN","XMXSEC",117,0)
 I $$CLOSED(XMZREC),'$$ORIGIN8R(XMDUZ,XMZREC) D ERRSET^XMXUTIL(37406.1,"",XMZ) Q 0  ; Only the message originator may forward CLOSED messages.
"RTN","XMXSEC",118,0)
 I XMDUZ=.6,DUZ'=$P(XMZREC,U,2),DUZ'=$P(XMZREC,U,4) D ERRSET^XMXUTIL(37406.6,"",XMZ) Q 0  ; Only the originator may forward messages in SHARED,MAIL.
"RTN","XMXSEC",119,0)
 Q 1
"RTN","XMXSEC",120,0)
LATER(XMDUZ) ; Later or New Toggle (1=may, 0=may not)
"RTN","XMXSEC",121,0)
 I DUZ=.6!(XMDUZ=.6) D ERRSET^XMXUTIL(37462) Q 0  ; SHARED,MAIL may not 'later' or 'new toggle' a message.
"RTN","XMXSEC",122,0)
 Q:XMDUZ=DUZ 1
"RTN","XMXSEC",123,0)
 Q $$RWPRIV
"RTN","XMXSEC",124,0)
MOVE(XMDUZ,XMZ,XMZREC) ; Save or Filter (1=may, 0=may not)
"RTN","XMXSEC",125,0)
 Q:XMDUZ=DUZ 1
"RTN","XMXSEC",126,0)
 Q:'$$RWPRIV 0
"RTN","XMXSEC",127,0)
 ;Q:'$$SURRACC(XMDUZ,"",XMZ,.XMZREC) 0  ; "save"
"RTN","XMXSEC",128,0)
 I $G(XMZREC)="" S XMZREC=$G(^XMB(3.9,XMZ,0))
"RTN","XMXSEC",129,0)
 I XMDUZ=.6,DUZ'=$P(XMZREC,U,2),DUZ'=$P(XMZREC,U,4),'$D(^XUSEC("XMMGR",DUZ)),'$D(^XMB(3.7,"AB",DUZ,.5,0)) D  Q 0
"RTN","XMXSEC",130,0)
 . D ERRSET^XMXUTIL(37461,"",XMZ) ; Only the originator, postmaster surrogate, or XMMGR key holder may do this in SHARED,MAIL.
"RTN","XMXSEC",131,0)
 Q 1
"RTN","XMXSEC",132,0)
READ(XMDUZ,XMZ,XMZREC) ; Read or Print (1=may, 0=may not)
"RTN","XMXSEC",133,0)
 Q:XMDUZ=DUZ 1
"RTN","XMXSEC",134,0)
 Q $$SURRACC(XMDUZ,"",XMZ,.XMZREC)  ; "access"
"RTN","XMXSEC",135,0)
REPLY(XMDUZ,XMZ,XMZREC) ; Reply (1=may, 0=may not)
"RTN","XMXSEC",136,0)
 ; Should we make sure XMZ is an original msg and not a reply?
"RTN","XMXSEC",137,0)
 ; Should we make sure the msg has recipients?
"RTN","XMXSEC",138,0)
 I DUZ=.6 D ERRSET^XMXUTIL(37422.6,"",XMZ) Q 0  ; May not reply to message as SHARED,MAIL.
"RTN","XMXSEC",139,0)
 I XMDUZ'=DUZ Q:'$$RWPRIV 0  Q:'$$SURRACC(XMDUZ,"",XMZ,.XMZREC) 0  ; "reply to"
"RTN","XMXSEC",140,0)
 I $G(XMZREC)="" S XMZREC=$G(^XMB(3.9,XMZ,0))
"RTN","XMXSEC",141,0)
 I $D(^XMB(3.9,XMZ,"K")),$$PAKMAN^XMXSEC1(XMZ,XMZREC) D ERRSET^XMXUTIL(37422.4,"",XMZ) Q 0  ; May not reply to secure PackMan message.
"RTN","XMXSEC",142,0)
 Q:$$ORIGIN8R(XMDUZ,XMZREC) 1
"RTN","XMXSEC",143,0)
 I $$INFO(XMZREC) D ERRSET^XMXUTIL(37422.1,"",XMZ) Q 0  ; Only originator may reply to 'INFORMATION ONLY' message.
"RTN","XMXSEC",144,0)
 I $P($G(^XMB(3.9,XMZ,1,+$O(^XMB(3.9,XMZ,1,"C",XMDUZ,0)),"T")),U,1)["I" D ERRSET^XMXUTIL(37422.2,"",XMZ) Q 0  ; 'INFORMATION ONLY' recipient may not reply to message.
"RTN","XMXSEC",145,0)
 I $P(XMZREC,U,2)["POSTMASTER@" D ERRSET^XMXUTIL(37422.5,"",XMZ) Q 0  ; You may not reply to a message from a remote Postmaster."
"RTN","XMXSEC",146,0)
 Q 1
"RTN","XMXSEC",147,0)
SEND(XMDUZ,XMINSTR) ; Send (1=may, 0=may not)
"RTN","XMXSEC",148,0)
 I DUZ=.6!(XMDUZ=.6) D ERRSET^XMXUTIL(37462) Q 0  ; You may not do this in SHARED,MAIL.
"RTN","XMXSEC",149,0)
 Q:XMDUZ=DUZ 1
"RTN","XMXSEC",150,0)
 Q:$D(XMINSTR("FROM")) 1
"RTN","XMXSEC",151,0)
 Q:XMDUZ=.5 1
"RTN","XMXSEC",152,0)
 Q $$WPRIV
"RTN","XMXSEC",153,0)
RWPRIV() ; Does the surrogate have 'read' or 'send' privilege? (1=yes, 0=no)
"RTN","XMXSEC",154,0)
 Q:$G(XMV("PRIV"))["R"!($G(XMV("PRIV"))["W") 1
"RTN","XMXSEC",155,0)
 D ERRSET^XMXUTIL(37457,XMV("NAME")) ; You do not have 'read' or 'send' privilege for "_XMV("NAME")
"RTN","XMXSEC",156,0)
 Q 0
"RTN","XMXSEC",157,0)
RPRIV() ; Does the surrogate have 'read' privilege? (1=yes, 0=no)
"RTN","XMXSEC",158,0)
 Q:$G(XMV("PRIV"))["R" 1
"RTN","XMXSEC",159,0)
 D ERRSET^XMXUTIL(37455,XMV("NAME")) ; You do not have 'read' privilege for "_XMV("NAME")
"RTN","XMXSEC",160,0)
 Q 0
"RTN","XMXSEC",161,0)
WPRIV() ; Does the surrogate have 'send' privilege? (1=yes, 0=no)
"RTN","XMXSEC",162,0)
 Q:$G(XMV("PRIV"))["W" 1
"RTN","XMXSEC",163,0)
 D ERRSET^XMXUTIL(37456,XMV("NAME")) ; You do not have 'send' privilege for "_XMV("NAME")
"RTN","XMXSEC",164,0)
 Q 0
"RTN","XMXSEC",165,0)
POSTPRIV() ; Perform postmaster actions (1=may, 0=may not)
"RTN","XMXSEC",166,0)
 ; This includes permission to perform group message actions in Shared,Mail.
"RTN","XMXSEC",167,0)
 I '$D(^XUSEC("XMMGR",DUZ)),'$D(^XMB(3.7,"AB",DUZ,.5)) D ERRSET^XMXUTIL(37458) Q 0  ; Only a POSTMASTER surrogate or XMMGR key holder may do this.
"RTN","XMXSEC",168,0)
 Q 1
"RTN","XMXSEC",169,0)
ZPOSTPRV() ; Perform postmaster actions (1=may, 0=may not)
"RTN","XMXSEC",170,0)
 ; This includes permission to perform group message actions in Shared,Mail.
"RTN","XMXSEC",171,0)
 Q:$D(^XUSEC("XMMGR",DUZ)) 1
"RTN","XMXSEC",172,0)
 Q:$D(^XMB(3.7,"AB",DUZ,.5)) 1
"RTN","XMXSEC",173,0)
 Q 0
"RTN","XMXSEC1")
0^95^B64148927
"RTN","XMXSEC1",1,0)
XMXSEC1 ;ISC-SF/GMB-Message security and restrictions (cont.) ;05/17/2002  13:26
"RTN","XMXSEC1",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMXSEC1",3,0)
 ; All entry points covered by DBIA 2732.
"RTN","XMXSEC1",4,0)
GETRESTR(XMDUZ,XMZ,XMZREC,XMINSTR,XMRESTR) ;
"RTN","XMXSEC1",5,0)
 ; If a message is closed, it may not be forwarded to SHARED,MAIL, even by the sender
"RTN","XMXSEC1",6,0)
 I $G(XMZREC)="" S XMZREC=$G(^XMB(3.9,XMZ,0))
"RTN","XMXSEC1",7,0)
 I "^Y^y^"[(U_$P(XMZREC,U,9)_U) D
"RTN","XMXSEC1",8,0)
 . S:$G(XMRESTR("FLAGS"))'["X" XMRESTR("FLAGS")=$G(XMRESTR("FLAGS"))_"X"
"RTN","XMXSEC1",9,0)
 E  I $G(XMRESTR("FLAGS"))["X" S XMRESTR("FLAGS")=$TR(XMRESTR("FLAGS"),"X")
"RTN","XMXSEC1",10,0)
 ; If a message is confidential, it may not be forwarded to SHARED,MAIL
"RTN","XMXSEC1",11,0)
 I "^Y^y^"[(U_$P(XMZREC,U,11)_U) D
"RTN","XMXSEC1",12,0)
 . S:$G(XMRESTR("FLAGS"))'["C" XMRESTR("FLAGS")=$G(XMRESTR("FLAGS"))_"C"
"RTN","XMXSEC1",13,0)
 E  I $G(XMRESTR("FLAGS"))["C" S XMRESTR("FLAGS")=$TR(XMRESTR("FLAGS"),"C")
"RTN","XMXSEC1",14,0)
 Q:$G(XMINSTR("ADDR FLAGS"))["R"
"RTN","XMXSEC1",15,0)
 ; If a message is priority, it may not be forwarded to groups unless
"RTN","XMXSEC1",16,0)
 ; the site has chosen to allow it, or if
"RTN","XMXSEC1",17,0)
 ; the user is the originator or possesses the proper security key,
"RTN","XMXSEC1",18,0)
 I $P(XMZREC,U,7)["P",'$P($G(^XMB(1,1,2)),U,1),'$$ORIGIN8R^XMXSEC(XMDUZ,XMZREC),'$D(^XUSEC("XM GROUP PRIORITY",XMDUZ)) S XMRESTR("NOFPG")=""
"RTN","XMXSEC1",19,0)
 E  K:$D(XMRESTR("NOFPG")) XMRESTR("NOFPG")
"RTN","XMXSEC1",20,0)
 ; If a message has responses, it may not be broadcast.  Users w/auto-
"RTN","XMXSEC1",21,0)
 ; forward addresses would not see the responses.
"RTN","XMXSEC1",22,0)
 I $O(^XMB(3.9,XMZ,3,0)) S XMRESTR("NOBCAST")=""
"RTN","XMXSEC1",23,0)
 ; If a message is more lines than the limit,
"RTN","XMXSEC1",24,0)
 ; then it may not be sent/forwarded to a remote site.
"RTN","XMXSEC1",25,0)
 D CHKLINES(XMDUZ,XMZ,.XMRESTR)
"RTN","XMXSEC1",26,0)
 Q
"RTN","XMXSEC1",27,0)
CHKLINES(XMDUZ,XMZ,XMRESTR) ; Replaces NO^XMA21A
"RTN","XMXSEC1",28,0)
 N XMLIMIT
"RTN","XMXSEC1",29,0)
 Q:$D(^XUSEC("XMMGR",XMDUZ))
"RTN","XMXSEC1",30,0)
 S XMLIMIT=$P($G(^XMB(1,1,"NETWORK-LIMIT")),U)
"RTN","XMXSEC1",31,0)
 I XMLIMIT,$P($G(^XMB(3.9,XMZ,2,0)),U,4)>XMLIMIT S XMRESTR("NONET")=XMLIMIT Q
"RTN","XMXSEC1",32,0)
 K:$D(XMRESTR("NONET")) XMRESTR("NONET")
"RTN","XMXSEC1",33,0)
 Q
"RTN","XMXSEC1",34,0)
CHKMSG(XMDUZ,XMK,XMKZ,XMZ,XMZREC) ; Is the message where the calling routine says it is,
"RTN","XMXSEC1",35,0)
 ; and is the user authorized to access it?
"RTN","XMXSEC1",36,0)
 I $G(XMK) D  Q
"RTN","XMXSEC1",37,0)
 . S XMZ=$O(^XMB(3.7,XMDUZ,2,XMK,1,"C",XMKZ,""))
"RTN","XMXSEC1",38,0)
 . I 'XMZ D  Q
"RTN","XMXSEC1",39,0)
 . . N XMPARM
"RTN","XMXSEC1",40,0)
 . . S XMPARM(1)=XMKZ,XMPARM(2)=XMK
"RTN","XMXSEC1",41,0)
 . . D ERRSET^XMXUTIL(34351,.XMPARM) ; Message _XMKZ_ in basket _XMK_ does not exist.
"RTN","XMXSEC1",42,0)
 . S XMZREC=$G(^XMB(3.9,XMZ,0))
"RTN","XMXSEC1",43,0)
 . I XMZREC'="" D:XMDUZ'=DUZ  Q
"RTN","XMXSEC1",44,0)
 . . N X
"RTN","XMXSEC1",45,0)
 . . S X=$$SURRACC^XMXSEC(XMDUZ,"",XMZ,XMZREC)
"RTN","XMXSEC1",46,0)
 . N XMPARM
"RTN","XMXSEC1",47,0)
 . S XMPARM(1)=XMZ,XMPARM(2)=XMKZ,XMPARM(3)=XMK
"RTN","XMXSEC1",48,0)
 . D ERRSET^XMXUTIL(34352,.XMPARM) ; Message _XMZ_ (message _XMKZ_ in basket _XMK_) does not exist.
"RTN","XMXSEC1",49,0)
 S XMZ=XMKZ
"RTN","XMXSEC1",50,0)
 S XMZREC=$G(^XMB(3.9,XMZ,0))
"RTN","XMXSEC1",51,0)
 I XMZREC="" D ERRSET^XMXUTIL(34354,XMZ) Q  ; Message _XMZ_ does not exist.
"RTN","XMXSEC1",52,0)
 Q:'$$ACCESS^XMXSEC(XMDUZ,XMZ,XMZREC)
"RTN","XMXSEC1",53,0)
 S XMK=+$O(^XMB(3.7,"M",XMZ,XMDUZ,""))
"RTN","XMXSEC1",54,0)
 Q:'XMK
"RTN","XMXSEC1",55,0)
 S XMKZ=$P($G(^XMB(3.7,XMDUZ,2,XMK,1,XMZ,0)),U,2)
"RTN","XMXSEC1",56,0)
 I 'XMKZ D ADDITM^XMUT4A(XMDUZ,XMK,XMZ,.XMKZ)
"RTN","XMXSEC1",57,0)
 Q
"RTN","XMXSEC1",58,0)
PAKMAN(XMZ,XMZREC) ; Returns 1 if this is a packman msg; 0 if not.
"RTN","XMXSEC1",59,0)
 ; Unfortunately, there isn't always an "X" in piece 7 of the zero node,
"RTN","XMXSEC1",60,0)
 ; so we must go check out the first line of text.
"RTN","XMXSEC1",61,0)
 N XMTYPE
"RTN","XMXSEC1",62,0)
 I $G(XMZREC)="" S XMZREC=$G(^XMB(3.9,XMZ,0))
"RTN","XMXSEC1",63,0)
 S XMTYPE=$P(XMZREC,U,7)
"RTN","XMXSEC1",64,0)
 I "P"[XMTYPE D  Q XMTYPE  ; "P" means priority, and it exists along with
"RTN","XMXSEC1",65,0)
 . ; message type in piece 7 in all MailMan versions thru 7.*
"RTN","XMXSEC1",66,0)
 . N XMREC,XMI
"RTN","XMXSEC1",67,0)
 . S XMTYPE=0
"RTN","XMXSEC1",68,0)
 . S XMI=$O(^XMB(3.9,XMZ,2,.999999)) I 'XMI Q
"RTN","XMXSEC1",69,0)
 . S XMREC=^XMB(3.9,XMZ,2,XMI,0)
"RTN","XMXSEC1",70,0)
 . Q:$E(XMREC,1)'="$"
"RTN","XMXSEC1",71,0)
 . I XMREC?1"$TXT Created by".E1" at ".E1" on ".E S XMTYPE=1 Q  ; Unsecured PackMan
"RTN","XMXSEC1",72,0)
 . I XMREC?1"$TXT PACKMAN BACKUP".E S XMTYPE=1 Q  ; PackMan Backup
"RTN","XMXSEC1",73,0)
 . I XMREC?1"$TXT ^Created by".E1" at ".E1" on ".E S XMTYPE=1 Q  ; Secured PackMan
"RTN","XMXSEC1",74,0)
 Q:XMTYPE="K"!(XMTYPE="X") 1  ; PackMan message (KIDS or regular)
"RTN","XMXSEC1",75,0)
 Q 0
"RTN","XMXSEC1",76,0)
OPTGRP(XMDUZ,XMK,XMOPT,XMOX,XMQDNUM) ; What may the user do at the basket/message group level?
"RTN","XMXSEC1",77,0)
 I XMK D
"RTN","XMXSEC1",78,0)
 . I XMDUZ=.5,XMK>999 D OPTPOST(.XMOPT,.XMOX) Q
"RTN","XMXSEC1",79,0)
 . D OPTUSER1(XMDUZ,.XMOPT,.XMOX)
"RTN","XMXSEC1",80,0)
 . D OPTUSER2(XMK,.XMOPT,.XMOX)
"RTN","XMXSEC1",81,0)
 E  D
"RTN","XMXSEC1",82,0)
 . I XMK="!" D OPTSS(XMDUZ,.XMOPT,.XMOX) Q
"RTN","XMXSEC1",83,0)
 . D OPTUSER1(XMDUZ,.XMOPT,.XMOX)
"RTN","XMXSEC1",84,0)
 Q
"RTN","XMXSEC1",85,0)
SET(XMCD,XMDN,XMOPT,XMOX) ;
"RTN","XMXSEC1",86,0)
 N XMDREC
"RTN","XMXSEC1",87,0)
 S XMDREC=$$EZBLD^DIALOG(XMDN)
"RTN","XMXSEC1",88,0)
 S XMOPT(XMCD)=$P(XMDREC,":",2,99)
"RTN","XMXSEC1",89,0)
 S XMOX("O",XMCD)=$P(XMDREC,":",1) ; "O"=original english to foreign
"RTN","XMXSEC1",90,0)
 S XMOX("X",$P(XMDREC,":",1))=XMCD ; "X"=translate foreign to english
"RTN","XMXSEC1",91,0)
 Q
"RTN","XMXSEC1",92,0)
Q(XMCD,XMDN) ;
"RTN","XMXSEC1",93,0)
 I $G(XMQDNUM) S XMOPT(XMCD,"?")=XMDN Q
"RTN","XMXSEC1",94,0)
 S XMOPT(XMCD,"?")=$$EZBLD^DIALOG(XMDN)
"RTN","XMXSEC1",95,0)
 Q
"RTN","XMXSEC1",96,0)
OPTUSER1(XMDUZ,XMOPT,XMOX) ;
"RTN","XMXSEC1",97,0)
 D SET("D",37202,.XMOPT,.XMOX) ; Delete messages
"RTN","XMXSEC1",98,0)
 D SET("F",37203,.XMOPT,.XMOX) ; Forward messages
"RTN","XMXSEC1",99,0)
 D SET("FI",37204,.XMOPT,.XMOX) ; Filter messages
"RTN","XMXSEC1",100,0)
 D SET("H",37205,.XMOPT,.XMOX) ; Headerless Print messages
"RTN","XMXSEC1",101,0)
 D SET("L",37206,.XMOPT,.XMOX) ; Later messages
"RTN","XMXSEC1",102,0)
 D SET("NT",37208,.XMOPT,.XMOX) ; New Toggle messages
"RTN","XMXSEC1",103,0)
 D SET("P",37209,.XMOPT,.XMOX) ; Print messages
"RTN","XMXSEC1",104,0)
 D SET("S",37213,.XMOPT,.XMOX) ; Save messages to another basket
"RTN","XMXSEC1",105,0)
 D SET("T",37214,.XMOPT,.XMOX) ; Terminate messages
"RTN","XMXSEC1",106,0)
 I '$D(^XMB(3.7,XMDUZ,15,"AF")) D
"RTN","XMXSEC1",107,0)
 . I XMDUZ=DUZ D Q("FI",37204.1) Q  ; You have no message filters defined.
"RTN","XMXSEC1",108,0)
 . S XMOPT("FI","?")=$$EZBLD^DIALOG(37204.2,XMV("NAME")) ; |1| has no message filters defined.
"RTN","XMXSEC1",109,0)
 D SET("V",37216,.XMOPT,.XMOX) ; Vaporize date set messages
"RTN","XMXSEC1",110,0)
 Q:XMDUZ'=.6
"RTN","XMXSEC1",111,0)
 D Q("L",37462) ; You may not do this in SHARED,MAIL.
"RTN","XMXSEC1",112,0)
 S XMOPT("NT","?")=XMOPT("L","?")
"RTN","XMXSEC1",113,0)
 Q:$$ZPOSTPRV^XMXSEC()
"RTN","XMXSEC1",114,0)
 ; You must hold the XMMGR key or be a POSTMASTER surrogate to do this in SHARED,MAIL.
"RTN","XMXSEC1",115,0)
 I $G(XMQDNUM) D  Q
"RTN","XMXSEC1",116,0)
 . F I="D","F","FI","S","T","V" S XMOPT(I,"?")=37261
"RTN","XMXSEC1",117,0)
 N DIR
"RTN","XMXSEC1",118,0)
 D BLD^DIALOG(37261,"","","DIR(""?"")")
"RTN","XMXSEC1",119,0)
 F I="D","F","FI","S","T","V" M XMOPT(I,"?")=DIR("?")
"RTN","XMXSEC1",120,0)
 Q
"RTN","XMXSEC1",121,0)
OPTUSER2(XMK,XMOPT,XMOX) ;
"RTN","XMXSEC1",122,0)
 D SET("C",37201,.XMOPT,.XMOX) ; Change the name of this basket
"RTN","XMXSEC1",123,0)
 D SET("N",37207,.XMOPT,.XMOX) ; New message list
"RTN","XMXSEC1",124,0)
 D SET("Q",37211,.XMOPT,.XMOX) ; Query (search for) messages in this basket
"RTN","XMXSEC1",125,0)
 D SET("R",37212,.XMOPT,.XMOX) ; Resequence messages
"RTN","XMXSEC1",126,0)
 I XMK'>1 D Q("C",37201.1) ; The name of this basket may not be changed.
"RTN","XMXSEC1",127,0)
 ;"The name of "_$S(XMK=1:"the IN",XMK=.5:"the WASTE",1:"this")_" basket may not be changed."
"RTN","XMXSEC1",128,0)
 Q:XMDUZ'=.6!$$ZPOSTPRV^XMXSEC()
"RTN","XMXSEC1",129,0)
 ; You must hold the XMMGR key or be a POSTMASTER surrogate to do this in SHARED,MAIL.
"RTN","XMXSEC1",130,0)
 I $G(XMQDNUM) S XMOPT("C","?")=37261 Q
"RTN","XMXSEC1",131,0)
 N DIR
"RTN","XMXSEC1",132,0)
 D BLD^DIALOG(37261,"","","DIR(""?"")")
"RTN","XMXSEC1",133,0)
 M XMOPT("C","?")=DIR("?")
"RTN","XMXSEC1",134,0)
 Q
"RTN","XMXSEC1",135,0)
OPTPOST(XMOPT,XMOX) ;
"RTN","XMXSEC1",136,0)
 D SET("D",37202,.XMOPT,.XMOX) ; Delete messages
"RTN","XMXSEC1",137,0)
 D SET("F",37203,.XMOPT,.XMOX) ; Forward messages (Added so that postmaster could reroute messages which for some reason were addressed to the wrong domain.)
"RTN","XMXSEC1",138,0)
 D SET("Q",37211,.XMOPT,.XMOX) ; Query (search for) messages in this basket
"RTN","XMXSEC1",139,0)
 D SET("R",37212,.XMOPT,.XMOX) ; Resequence messages
"RTN","XMXSEC1",140,0)
 D SET("X",37219,.XMOPT,.XMOX) ; Xmit Priority toggle
"RTN","XMXSEC1",141,0)
 Q
"RTN","XMXSEC1",142,0)
OPTSS(XMDUZ,XMOPT,XMOX) ; Super Search
"RTN","XMXSEC1",143,0)
 D SET("H",37205,.XMOPT,.XMOX) ; Headerless Print messages
"RTN","XMXSEC1",144,0)
 D SET("P",37209,.XMOPT,.XMOX) ; Print messages
"RTN","XMXSEC1",145,0)
 Q
"RTN","XMXSEC1",146,0)
COPYAMT(XMZ,XMWHICH) ; Checks total number of lines to be copied and total number of responses to be copied.
"RTN","XMXSEC1",147,0)
 ; Function returns 1 if OK; 0 if not OK.
"RTN","XMXSEC1",148,0)
 ; XMWHICH string of which responses to copy (0=original msg).
"RTN","XMXSEC1",149,0)
 ;         Default = original msg and all responses.
"RTN","XMXSEC1",150,0)
 N XMLIMIT,XMRESPS,XMABORT
"RTN","XMXSEC1",151,0)
 S XMABORT=0
"RTN","XMXSEC1",152,0)
 S XMLIMIT=$$COPYLIMS
"RTN","XMXSEC1",153,0)
 S XMRESPS=+$P($G(^XMB(3.9,XMZ,3,0)),U,4)
"RTN","XMXSEC1",154,0)
 I XMRESPS=0 D TOOMANY(+$P($G(^XMB(3.9,XMZ,2,0)),U,4),$P(XMLIMIT,U,3),37470,.XMABORT) Q 'XMABORT
"RTN","XMXSEC1",155,0)
 N I,J,XMRANGE,XMLINES
"RTN","XMXSEC1",156,0)
 S:'$D(XMWHICH) XMWHICH="0-"_XMRESPS
"RTN","XMXSEC1",157,0)
 S (XMRESPS,XMLINES)=0
"RTN","XMXSEC1",158,0)
 F I=1:1:$L(XMWHICH,",")-1 D
"RTN","XMXSEC1",159,0)
 . S XMRANGE=$P(XMWHICH,",",I)
"RTN","XMXSEC1",160,0)
 . F J=$P(XMRANGE,"-",1):1:$S(XMRANGE["-":$P(XMRANGE,"-",2),1:XMRANGE) D
"RTN","XMXSEC1",161,0)
 . . S XMRESPS=XMRESPS+1
"RTN","XMXSEC1",162,0)
 . . I J=0 S XMLINES=XMLINES+$P($G(^XMB(3.9,XMZ,2,0)),U,4) Q
"RTN","XMXSEC1",163,0)
 . . S XMLINES=XMLINES+$P($G(^XMB(3.9,+$G(^XMB(3.9,XMZ,3,J,0)),2,0)),U,4)
"RTN","XMXSEC1",164,0)
 D TOOMANY(XMLINES,$P(XMLIMIT,U,3),37470,.XMABORT) Q:XMABORT 0
"RTN","XMXSEC1",165,0)
 D TOOMANY(XMRESPS,$P(XMLIMIT,U,2),37471,.XMABORT) Q:XMABORT 0
"RTN","XMXSEC1",166,0)
 Q 1
"RTN","XMXSEC1",167,0)
TOOMANY(HOWMANY,XMLIMIT,XMDIALOG,XMABORT) ;
"RTN","XMXSEC1",168,0)
 Q:HOWMANY'>XMLIMIT
"RTN","XMXSEC1",169,0)
 S XMABORT=1
"RTN","XMXSEC1",170,0)
 D ERRSET^XMXUTIL(XMDIALOG,XMLIMIT) ; You may not copy more than the site limit of _XMLIMIT_ lines / responses.
"RTN","XMXSEC1",171,0)
 Q
"RTN","XMXSEC1",172,0)
COPYLIMS() ; Function returns copy limits string.
"RTN","XMXSEC1",173,0)
 ; limits:  # recipients^# responses^# lines
"RTN","XMXSEC1",174,0)
 N I
"RTN","XMXSEC1",175,0)
 S XMLIMIT=$G(^XMB(1,1,.11))
"RTN","XMXSEC1",176,0)
 F I=1:1:3 I '$P(XMLIMIT,U,I) S $P(XMLIMIT,U,I)=$P("2999^99^3999",U,I)
"RTN","XMXSEC1",177,0)
 Q XMLIMIT
"RTN","XMXSEC1",178,0)
COPYRECP(XMZ) ; Checks total number of recipients to see if it's OK to list them in the copy text and send the copy to them, too.
"RTN","XMXSEC1",179,0)
 ; Function returns 1 if OK; 0 if not OK.
"RTN","XMXSEC1",180,0)
 N XMLIMIT
"RTN","XMXSEC1",181,0)
 S XMLIMIT=$$COPYLIMS
"RTN","XMXSEC1",182,0)
 Q:$P($G(^XMB(3.9,XMZ,1,0)),U,4)'>$P(XMLIMIT,U,1) 1
"RTN","XMXSEC1",183,0)
 D ERRSET^XMXUTIL(37472,$P(XMLIMIT,U,1))
"RTN","XMXSEC1",184,0)
 ;Because this message has more than the site limit of _X_ recipients,
"RTN","XMXSEC1",185,0)
 ;we will neither list them in the text of the copy,
"RTN","XMXSEC1",186,0)
 ;nor will we deliver the copy to them.
"RTN","XMXSEC1",187,0)
 Q 0
"RTN","XMXSEC1",188,0)
SSPRIV() ; Is the user authorized to conduct a super search?
"RTN","XMXSEC1",189,0)
 Q:$$ZSSPRIV 1
"RTN","XMXSEC1",190,0)
 D ERRSET^XMXUTIL(34413.5)
"RTN","XMXSEC1",191,0)
 Q 0
"RTN","XMXSEC1",192,0)
ZSSPRIV() ; Is the user authorized to conduct a super search?
"RTN","XMXSEC1",193,0)
 I DUZ'<1,$D(^XUSEC("XM SUPER SEARCH",DUZ)) Q 1
"RTN","XMXSEC1",194,0)
 Q 0
"RTN","XMXSEC1",195,0)
ACCESS2(XMDUZ,XMZ,XMZREC) ; The user (XMDUZ) is not a recipient
"RTN","XMXSEC1",196,0)
 N XMOK                  ; of the message, but did he send it?
"RTN","XMXSEC1",197,0)
 I XMDUZ=$P(XMZREC,U,2)!(XMDUZ=$P(XMZREC,U,4)) D  Q XMOK
"RTN","XMXSEC1",198,0)
 . I XMDUZ='DUZ,'$$SURRACC^XMXSEC(XMDUZ,"",XMZ,XMZREC) S XMOK=0 Q
"RTN","XMXSEC1",199,0)
 . ; The user sent the message, so add him to it.
"RTN","XMXSEC1",200,0)
 . D ADDRECP^XMTDL(XMZ,$P(XMZREC,U,7)["P",XMDUZ)
"RTN","XMXSEC1",201,0)
 . S XMOK=1
"RTN","XMXSEC1",202,0)
 I XMDUZ'=DUZ D  Q 0
"RTN","XMXSEC1",203,0)
 . Q:'$$ACCESS^XMXSEC(DUZ,XMZ,XMZREC)
"RTN","XMXSEC1",204,0)
 . D ERRSET^XMXUTIL(37103,XMV("NAME"),XMZ)
"RTN","XMXSEC1",205,0)
 . ; You may not access this message as |1| unless you
"RTN","XMXSEC1",206,0)
 . ; or someone else on the message forwards it to |1|.
"RTN","XMXSEC1",207,0)
 D ERRSET^XMXUTIL(37102,"",XMZ)
"RTN","XMXSEC1",208,0)
 ; You are neither a sender nor a recipient of this message.
"RTN","XMXSEC1",209,0)
 ; If you need to see it, ask someone to forward it to you.
"RTN","XMXSEC1",210,0)
 Q 0
"RTN","XMXSEC2")
0^379^B66090183
"RTN","XMXSEC2",1,0)
XMXSEC2 ;ISC-SF/GMB-Message security and restrictions (cont.) ;04/18/2002  08:01
"RTN","XMXSEC2",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMXSEC2",3,0)
 ; All entry points covered by DBIA 2733.
"RTN","XMXSEC2",4,0)
EDIT(XMDUZ,XMZ,XMZREC) ; May the user edit the message? (1=may, 0=may not)
"RTN","XMXSEC2",5,0)
 I '$$ORIGIN8R^XMXSEC(XMDUZ,.XMZREC) D ERRSET^XMXUTIL(37405.1) Q 0  ; Only the originator may Edit a message.
"RTN","XMXSEC2",6,0)
 I $P($G(^XMB(3.9,XMZ,1,0)),U,4)>1!($P(XMZREC,U,2)'=$O(^XMB(3.9,XMZ,1,"C",0))) D ERRSET^XMXUTIL(37405.2) Q 0  ; You may not Edit a message you have already sent to someone else.
"RTN","XMXSEC2",7,0)
 I $O(^XMB(3.9,XMZ,3,0)) D ERRSET^XMXUTIL(37405.3) Q 0  ; You may not Edit a message which has a reply.
"RTN","XMXSEC2",8,0)
 I $D(^XMB(3.9,XMZ,"K")),XMINSTR("TYPE")["X"!(XMINSTR("TYPE")["K") D ERRSET^XMXUTIL(37405.4) ; You may not Edit a secure KIDS or PackMan message.
"RTN","XMXSEC2",9,0)
 Q 1
"RTN","XMXSEC2",10,0)
OPTEDIT(XMINSTR,XMOPT,XMOX,XMQDNUM) ; We know the user may edit the message.
"RTN","XMXSEC2",11,0)
 ; Now, what, exactly, may be edited?
"RTN","XMXSEC2",12,0)
 D SET("C",$S($G(XMINSTR("FLAGS"))["C":37302,1:37301),.XMOPT,.XMOX) ; UnConfidential (surrogate may read) / Confidential (surrogate can't read)
"RTN","XMXSEC2",13,0)
 D SET("D",$S($D(XMINSTR("RCPT BSKT")):37304,1:37303),.XMOPT,.XMOX) ; Delivery basket remove / Delivery basket set
"RTN","XMXSEC2",14,0)
 D SET("I",$S($G(XMINSTR("FLAGS"))["I":37308,1:37307),.XMOPT,.XMOX) ; UnInformation only / Information only
"RTN","XMXSEC2",15,0)
 D SET("NS",37309,.XMOPT,.XMOX) ; Add Network Signature
"RTN","XMXSEC2",16,0)
 D SET("P",$S($G(XMINSTR("FLAGS"))["P":37312,1:37311),.XMOPT,.XMOX) ; Normal delivery / Priority delivery
"RTN","XMXSEC2",17,0)
 D SET("R",$S($G(XMINSTR("FLAGS"))["R":37314,1:37313),.XMOPT,.XMOX) ; No Confirm receipt / Confirm receipt
"RTN","XMXSEC2",18,0)
 D SET("ES",37305,.XMOPT,.XMOX) ; Edit Subject
"RTN","XMXSEC2",19,0)
 D SET("ET",37306,.XMOPT,.XMOX) ; Edit Text
"RTN","XMXSEC2",20,0)
 D SET("V",$S($G(XMINSTR("VAPOR")):37318,1:37317),.XMOPT,.XMOX) ; Vaporize date remove / Vaporize date set
"RTN","XMXSEC2",21,0)
 D SET("X",$S($G(XMINSTR("FLAGS"))["X":37320,1:37319),.XMOPT,.XMOX) ; UnClose (forward allowed) / Closed (no forward allowed)
"RTN","XMXSEC2",22,0)
 D SET("S",$S($D(^XMB(3.9,XMZ,"K")):37316,$D(XMINSTR("SCR KEY")):37316,1:37315),.XMOPT,.XMOX) ; UnScramble / Scramble message text
"RTN","XMXSEC2",23,0)
 I $G(XMPAKMAN)!($G(XMINSTR("TYPE"))["X")!($G(XMINSTR("TYPE"))["K") D
"RTN","XMXSEC2",24,0)
 . D Q("NX",37309.4) ; You may not add a Network Signature to a KIDS or PackMan message.
"RTN","XMXSEC2",25,0)
 . D Q("S",37315.4) ; Sorry, but we can't (un)secure a KIDS or PackMan message here.
"RTN","XMXSEC2",26,0)
 I '$D(XMOPT("NS","?")),'$$GOTNS^XMVVITA(XMDUZ) D
"RTN","XMXSEC2",27,0)
 . ; pgmr note: this must be the last place that sets XMOPT("NS","?").
"RTN","XMXSEC2",28,0)
 . I XMDUZ=DUZ D Q("NS",37309.1) Q  ; You have no Network Signature.
"RTN","XMXSEC2",29,0)
 . S XMOPT("NS","?")=$$EZBLD^DIALOG(37309.3,XMV("NAME")) ; |1| has no Network Signature.
"RTN","XMXSEC2",30,0)
 I $D(^TMP("XMY",$J,.6)) D
"RTN","XMXSEC2",31,0)
 . D Q("C",37301.6) ; Messages addressed to SHARED,MAIL may not be 'Confidential'.
"RTN","XMXSEC2",32,0)
 . D Q("X",37320.6) ; Messages addressed to SHARED,MAIL may not be 'Closed'.
"RTN","XMXSEC2",33,0)
 Q
"RTN","XMXSEC2",34,0)
SET(XMCD,XMDN,XMOPT,XMOX) ;
"RTN","XMXSEC2",35,0)
 N XMDREC
"RTN","XMXSEC2",36,0)
 S XMDREC=$$EZBLD^DIALOG(XMDN)
"RTN","XMXSEC2",37,0)
 S XMOPT(XMCD)=$P(XMDREC,":",2,99)
"RTN","XMXSEC2",38,0)
 S XMOX("O",XMCD)=$P(XMDREC,":",1) ; "O"=original english to foreign
"RTN","XMXSEC2",39,0)
 S XMOX("X",$P(XMDREC,":",1))=XMCD ; "X"=translate foreign to english
"RTN","XMXSEC2",40,0)
 Q
"RTN","XMXSEC2",41,0)
Q(XMCD,XMDN) ;
"RTN","XMXSEC2",42,0)
 I $G(XMQDNUM) S XMOPT(XMCD,"?")=XMDN Q
"RTN","XMXSEC2",43,0)
 S XMOPT(XMCD,"?")=$$EZBLD^DIALOG(XMDN)
"RTN","XMXSEC2",44,0)
 Q
"RTN","XMXSEC2",45,0)
OPTMSG(XMDUZ,XMK,XMZ,XMIM,XMINSTR,XMIU,XMOPT,XMOX,XMQDNUM) ; The user has access to the message.  Now what may the user do with it?
"RTN","XMXSEC2",46,0)
 ; in:
"RTN","XMXSEC2",47,0)
 ; XMDUZ  = the user
"RTN","XMXSEC2",48,0)
 ; XMK    = basket IEN if message is in a basket
"RTN","XMXSEC2",49,0)
 ;        = ! if super search (option XM SUPER SEARCH)
"RTN","XMXSEC2",50,0)
 ;        = 0 otherwise
"RTN","XMXSEC2",51,0)
 ; XMZ    = the message IEN
"RTN","XMXSEC2",52,0)
 ; The following are set by INMSG1 and INMSG2^XMXUTIL2
"RTN","XMXSEC2",53,0)
 ; XMIM("FROM")  = piece 2 of the message's zero node
"RTN","XMXSEC2",54,0)
 ; XMINSTR       = special instructions
"RTN","XMXSEC2",55,0)
 ; XMIU("ORIGN8")=
"RTN","XMXSEC2",56,0)
 ; XMIU("IEN")   = the user's IEN in the message's recipient multiple
"RTN","XMXSEC2",57,0)
 ; XMQDNUM = 0 - set XMOPT(<opt>,"?")=dialog text (default)
"RTN","XMXSEC2",58,0)
 ;           1 - set XMOPT(<opt>,"?")=dialog number (all are TYPE: ERROR)
"RTN","XMXSEC2",59,0)
 ;           FYI, XMOPT(<opt>,"?") is displayed in SHOWERR^XMJDIR.
"RTN","XMXSEC2",60,0)
 ; out:
"RTN","XMXSEC2",61,0)
 ; XMOPT(<opt>) Possible options
"RTN","XMXSEC2",62,0)
 ; '$D(XMOPT(<opt>,"?")) User may do these things.
"RTN","XMXSEC2",63,0)
 ;  $D(XMOPT(<opt>,"?")) User may NOT do these things.
"RTN","XMXSEC2",64,0)
 N XMSECPAK
"RTN","XMXSEC2",65,0)
 I $D(^XMB(3.9,XMZ,"K")),XMINSTR("TYPE")["X"!(XMINSTR("TYPE")["K") S XMSECPAK=1 ; secure packman
"RTN","XMXSEC2",66,0)
 E  S XMSECPAK=0
"RTN","XMXSEC2",67,0)
 K XMOPT,XMOX
"RTN","XMXSEC2",68,0)
 D SET("B",37441,.XMOPT,.XMOX) ; Backup
"RTN","XMXSEC2",69,0)
 D SET("I",37442,.XMOPT,.XMOX) ; Ignore
"RTN","XMXSEC2",70,0)
 D SET("P",37416,.XMOPT,.XMOX) ; Print
"RTN","XMXSEC2",71,0)
 D SET("Q",37417,.XMOPT,.XMOX) ; Query
"RTN","XMXSEC2",72,0)
 D SET("QC",37431,.XMOPT,.XMOX) ; Query Current
"RTN","XMXSEC2",73,0)
 D SET("QD",37418,.XMOPT,.XMOX) ; Query Detailed
"RTN","XMXSEC2",74,0)
 D SET("QN",37419,.XMOPT,.XMOX) ; Query Network
"RTN","XMXSEC2",75,0)
 D SET("QNC",37432,.XMOPT,.XMOX) ; Query Not Current
"RTN","XMXSEC2",76,0)
 D SET("QR",37420,.XMOPT,.XMOX) ; Query Recipients
"RTN","XMXSEC2",77,0)
 D SET("QT",37433,.XMOPT,.XMOX) ; Query Terminated
"RTN","XMXSEC2",78,0)
 Q:XMK="!"
"RTN","XMXSEC2",79,0)
 D SET("A",37401,.XMOPT,.XMOX) ; Answer
"RTN","XMXSEC2",80,0)
 D SET("AA",37402,.XMOPT,.XMOX) ; Access Attachments
"RTN","XMXSEC2",81,0)
 D SET("C",37403,.XMOPT,.XMOX) ; Copy
"RTN","XMXSEC2",82,0)
 D SET("D",37404,.XMOPT,.XMOX) ; Delete
"RTN","XMXSEC2",83,0)
 D SET("E",37405,.XMOPT,.XMOX) ; Edit
"RTN","XMXSEC2",84,0)
 D SET("F",37406,.XMOPT,.XMOX) ; Forward
"RTN","XMXSEC2",85,0)
 D SET("IN",$S($G(XMINSTR("FLAGS"))["I":37409,1:37408),.XMOPT,.XMOX) ; UnInformation only / Information only
"RTN","XMXSEC2",86,0)
 D SET("H",37407,.XMOPT,.XMOX) ; Headerless Print
"RTN","XMXSEC2",87,0)
 D SET("K",$S($G(XMINSTR("FLAGS"))["K":37412,1:37411),.XMOPT,.XMOX) ; UnPriority replies / Priority replies
"RTN","XMXSEC2",88,0)
 D SET("L",37413,.XMOPT,.XMOX) ; Later
"RTN","XMXSEC2",89,0)
 D SET("N",$S($G(XMINSTR("FLAGS"))["N":37415,1:37414),.XMOPT,.XMOX) ; UnNew / New
"RTN","XMXSEC2",90,0)
 D SET("R",37422,.XMOPT,.XMOX) ; Reply
"RTN","XMXSEC2",91,0)
 D SET("S",37423,.XMOPT,.XMOX) ; Save
"RTN","XMXSEC2",92,0)
 D SET("T",37424,.XMOPT,.XMOX) ; Terminate
"RTN","XMXSEC2",93,0)
 D SET("V",37425,.XMOPT,.XMOX) ; Vaporize date edit
"RTN","XMXSEC2",94,0)
 D SET("W",37444,.XMOPT,.XMOX) ; Write
"RTN","XMXSEC2",95,0)
 D SET("X",$S($G(XMINSTR("TYPE"))["K":37427,$G(XMINSTR("TYPE"))["X":37428,1:37426),.XMOPT,.XMOX) ; Xtract KIDS / Xtract PackMan / Xtract
"RTN","XMXSEC2",96,0)
 I XMDUZ=DUZ!($G(XMV("PRIV"))["W") D
"RTN","XMXSEC2",97,0)
 . D OPTW(XMDUZ,XMZ,XMIM("FROM"),XMIU("ORIGN8"),XMSECPAK,.XMINSTR)
"RTN","XMXSEC2",98,0)
 E  D
"RTN","XMXSEC2",99,0)
 . D OPTWNO^XMXSEC3(XMIU("ORIGN8"))
"RTN","XMXSEC2",100,0)
 D OPTR(XMDUZ,XMK,XMZ,.XMIU,XMSECPAK,.XMINSTR)
"RTN","XMXSEC2",101,0)
 I DUZ=.6 D Q("R",37422.6) ; SHARED,MAIL may not Reply to a message.
"RTN","XMXSEC2",102,0)
 I XMDUZ=.6 D DOSHARE^XMXSEC3(XMDUZ,XMK,XMIU("ORIGN8"),.XMINSTR) Q
"RTN","XMXSEC2",103,0)
 I XMDUZ=.5,XMK>999 D DOPOST^XMXSEC3
"RTN","XMXSEC2",104,0)
 Q
"RTN","XMXSEC2",105,0)
OPTW(XMDUZ,XMZ,XMFROM,XMORIGN8,XMSECPAK,XMINSTR) ; User must be self or have 'write' privilege as surrogate.
"RTN","XMXSEC2",106,0)
 I XMINSTR("TYPE")["X"!(XMINSTR("TYPE")["K") D Q("A",37401.4) ; You may not Answer a KIDS or PackMan message.
"RTN","XMXSEC2",107,0)
 I XMINSTR("FLAGS")["X",'XMORIGN8 D Q("C",37403.1) ; Only the originator may Copy a 'closed' message.
"RTN","XMXSEC2",108,0)
 I $D(^XMB(3.9,XMZ,"K")) D
"RTN","XMXSEC2",109,0)
 . I XMSECPAK D Q("C",37403.4) ; You may not Copy a secure KIDS or PackMan message.
"RTN","XMXSEC2",110,0)
 . E  D
"RTN","XMXSEC2",111,0)
 . . I '$D(XMOPT("A","?")) D Q("A",37401.2) ; You may not Answer a scrambled message.  Use Reply.
"RTN","XMXSEC2",112,0)
 . . I '$D(XMOPT("C","?")) D Q("C",37403.2) ; You may not Copy a scrambled message.
"RTN","XMXSEC2",113,0)
 I '$D(XMOPT("A","?")),'$$GOTNS^XMVVITA(XMDUZ) D
"RTN","XMXSEC2",114,0)
 . ; pgmr note: this must be the last place that sets XMOPT("A","?").
"RTN","XMXSEC2",115,0)
 . I XMDUZ=DUZ D Q("A",37401.1) Q  ; You must have a Network Signature to Answer a message.
"RTN","XMXSEC2",116,0)
 . S XMOPT("A","?")=$$EZBLD^DIALOG(37401.3,XMV("NAME")) ; |1| must have a Network Signature to Answer a message.
"RTN","XMXSEC2",117,0)
 I 'XMORIGN8 D  Q
"RTN","XMXSEC2",118,0)
 . D Q("IN",37409.1) ; Only the originator may toggle 'Information only'.
"RTN","XMXSEC2",119,0)
 . D Q("E",37405.1) ; Only the originator may Edit a message.
"RTN","XMXSEC2",120,0)
 I $P($G(^XMB(3.9,XMZ,1,0)),U,4)>1!(XMFROM'=$O(^XMB(3.9,XMZ,1,"C",0))) D  Q
"RTN","XMXSEC2",121,0)
 . ; You may not Edit a message you have already sent to someone else.
"RTN","XMXSEC2",122,0)
 . ; You may toggle the 'information only' switch, if you wish.
"RTN","XMXSEC2",123,0)
 . I $G(XMQDNUM) S XMOPT("E","?")=37405.2 Q
"RTN","XMXSEC2",124,0)
 . N DIR
"RTN","XMXSEC2",125,0)
 . D BLD^DIALOG(37405.2,"","","DIR(""?"")")
"RTN","XMXSEC2",126,0)
 . M XMOPT("E","?")=DIR("?")
"RTN","XMXSEC2",127,0)
 I $O(^XMB(3.9,XMZ,3,0)) D Q("E",37405.3) Q  ; You may not Edit a message which has a reply.
"RTN","XMXSEC2",128,0)
 I XMSECPAK D Q("E",37405.4) ; You may not Edit a secure KIDS or PackMan message.
"RTN","XMXSEC2",129,0)
 Q
"RTN","XMXSEC2",130,0)
OPTR(XMDUZ,XMK,XMZ,XMIU,XMSECPAK,XMINSTR) ; User must be self or have 'read' privilege as surrogate.
"RTN","XMXSEC2",131,0)
 I '$O(^XMB(3.9,XMZ,2005,0)) D Q("AA",37402.1) ; This message has no Attachments.
"RTN","XMXSEC2",132,0)
 I 'XMK D
"RTN","XMXSEC2",133,0)
 . D Q("D",37404.1) ; This message has already been deleted.  It's not in a basket.
"RTN","XMXSEC2",134,0)
 . D Q("V",37425.1) ; This message has already vaporized.  It's not in a basket.
"RTN","XMXSEC2",135,0)
 I XMINSTR("FLAGS")'["P" D Q("K",37412.1) ; The message must be 'priority' in order to toggle 'Priority replies'.
"RTN","XMXSEC2",136,0)
 I XMINSTR("FLAGS")["X",'XMIU("ORIGN8") D Q("F",37406.1) ; Only the originator may forward a 'closed' message.
"RTN","XMXSEC2",137,0)
 I XMSECPAK D
"RTN","XMXSEC2",138,0)
 . D Q("P",37416.4) ; You may not Print a secure KIDS or PackMan message.
"RTN","XMXSEC2",139,0)
 . S XMOPT("H","?")=XMOPT("P","?")
"RTN","XMXSEC2",140,0)
 . D Q("R",37422.4) ; You may not Reply to a secure KIDS or PackMan message.
"RTN","XMXSEC2",141,0)
 E  I 'XMIU("ORIGN8") D
"RTN","XMXSEC2",142,0)
 . I XMINSTR("FLAGS")["I" D Q("R",37422.1) Q  ; Only the originator may Reply to an 'Information only' message.
"RTN","XMXSEC2",143,0)
 . I $P($G(^XMB(3.9,XMZ,1,XMIU("IEN"),"T")),U,1)="I" D Q("R",37422.2) ; 'Information only' recipients may not reply to a message.
"RTN","XMXSEC2",144,0)
 E  I $$BCAST^XMXSEC(XMZ) D Q("R",37422.3) ; May not reply to a Broadcast message.  Send a new one.
"RTN","XMXSEC2",145,0)
 I XMINSTR("TYPE")["X"!(XMINSTR("TYPE")["K") D
"RTN","XMXSEC2",146,0)
 . I '$D(^XUSEC("XUPROGMODE",DUZ)) D Q("X",37428.2) ; You must hold the XUPROGMODE key to extract KIDS or PackMan messages.
"RTN","XMXSEC2",147,0)
 E  D Q("X",37428.1) ; This message is neither KIDS nor PackMan.
"RTN","XMXSEC2",148,0)
 Q
"RTN","XMXSEC3")
0^96^B5539815
"RTN","XMXSEC3",1,0)
XMXSEC3 ;ISC-SF/GMB-Message security and restrictions (cont.) ;04/18/2002  08:01
"RTN","XMXSEC3",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMXSEC3",3,0)
 ; All entry points covered by DBIA 2733.
"RTN","XMXSEC3",4,0)
OPTWNO(XMORIGN8) ; Surrogate does not have 'write' privilege.
"RTN","XMXSEC3",5,0)
 D Q("A",37401.5) ; You need 'send' privilege to Answer a message.
"RTN","XMXSEC3",6,0)
 D Q("C",37403.5) ; You need 'send' privilege to Copy a message.
"RTN","XMXSEC3",7,0)
 D Q("E",37405.5) ; You need 'send' privilege to Edit a message.
"RTN","XMXSEC3",8,0)
 I XMORIGN8 D Q("IN",37409.5) ; You need 'send' privilege to toggle 'Information only'.
"RTN","XMXSEC3",9,0)
 E  D Q("IN",37409.1) ; Only the originator may toggle 'Information only'.
"RTN","XMXSEC3",10,0)
 D Q("W",37444.5) ; You need 'send' privilege to Write (send) a message.
"RTN","XMXSEC3",11,0)
 Q
"RTN","XMXSEC3",12,0)
Q(XMCD,XMDN) ;
"RTN","XMXSEC3",13,0)
 I $G(XMQDNUM) S XMOPT(XMCD,"?")=XMDN Q
"RTN","XMXSEC3",14,0)
 S XMOPT(XMCD,"?")=$$EZBLD^DIALOG(XMDN)
"RTN","XMXSEC3",15,0)
 Q
"RTN","XMXSEC3",16,0)
DOSHARE(XMDUZ,XMK,XMORIGN8,XMINSTR) ;
"RTN","XMXSEC3",17,0)
 N I,XMNO
"RTN","XMXSEC3",18,0)
 S XMNO=$S($G(XMQDNUM):37462,1:$$EZBLD^DIALOG(37462)) ; You may not do this in SHARED,MAIL.
"RTN","XMXSEC3",19,0)
 F I="A","E","IN","K","L","N","W","X" S XMOPT(I,"?")=XMNO
"RTN","XMXSEC3",20,0)
 Q:XMORIGN8
"RTN","XMXSEC3",21,0)
 D Q("C",37403.6) ; Only the originator may Copy a message in SHARED,MAIL.
"RTN","XMXSEC3",22,0)
 D Q("F",37406.6) ; Only the originator may Forward a message from SHARED,MAIL.
"RTN","XMXSEC3",23,0)
 I XMK,$S($D(^XUSEC("XMMGR",DUZ)):0,$D(^XMB(3.7,"AB",DUZ,.5)):0,1:1) D
"RTN","XMXSEC3",24,0)
 . N DIR,I
"RTN","XMXSEC3",25,0)
 . ; You must be the originator, hold the XMMGR key,
"RTN","XMXSEC3",26,0)
 . ; or be a POSTMASTER surrogate to do this in SHARED,MAIL.
"RTN","XMXSEC3",27,0)
 . I $G(XMQDNUM) D  Q
"RTN","XMXSEC3",28,0)
 . . F I="D","S","T","V" S XMOPT(I,"?")=37461
"RTN","XMXSEC3",29,0)
 . D BLD^DIALOG(37461,"","","DIR(""?"")")
"RTN","XMXSEC3",30,0)
 . F I="D","S","T","V" M XMOPT(I,"?")=DIR("?")
"RTN","XMXSEC3",31,0)
 Q
"RTN","XMXSEC3",32,0)
DOPOST ; You may not do this with messages in the transmit queues.
"RTN","XMXSEC3",33,0)
 N XMNO,I
"RTN","XMXSEC3",34,0)
 S XMNO=$S($G(XMQDNUM):37251,1:$$EZBLD^DIALOG(37251))
"RTN","XMXSEC3",35,0)
 F I="A","AA","B","C","E","IN","H","K","L","N","P","R","S","T","V","W","X" S XMOPT(I,"?")=XMNO
"RTN","XMXSEC3",36,0)
 K XMOPT("X"),XMOX("X",XMOX("O","X")),XMOX("O","X")
"RTN","XMXSEC3",37,0)
 D SET^XMXSEC2("X",37447,.XMOPT,.XMOX) ; Xmit Priority Toggle
"RTN","XMXSEC3",38,0)
 Q
"RTN","XMXSEND")
0^380^B65629156
"RTN","XMXSEND",1,0)
XMXSEND ;ISC-SF/GMB-Send a msg ;06/19/2002  07:01
"RTN","XMXSEND",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMXSEND",3,0)
 ; Entry points:
"RTN","XMXSEND",4,0)
 ; SENDMSG  Send a message
"RTN","XMXSEND",5,0)
 ; CRE8XMZ  Setup a message. (1st part of 3-part message sending process)
"RTN","XMXSEND",6,0)
 ;          In the second part, the programmer directly sets the message
"RTN","XMXSEND",7,0)
 ;          text into the global.
"RTN","XMXSEND",8,0)
 ; ADDRNSND Send the message created by CRE8XMZ and 'texted' by the
"RTN","XMXSEND",9,0)
 ;          programmer.  (3rd part of 3-part message sending process)
"RTN","XMXSEND",10,0)
 ;          Involves checking the addressees, loading the message,
"RTN","XMXSEND",11,0)
 ;          putting the addressees in the message,
"RTN","XMXSEND",12,0)
 ;          and sending the message.
"RTN","XMXSEND",13,0)
 ; LATER    TaskMan entry point to send a 'later'd message
"RTN","XMXSEND",14,0)
SENDMSG(XMDUZ,XMSUBJ,XMBODY,XMTO,XMINSTR,XMZ,XMATTACH) ;
"RTN","XMXSEND",15,0)
 ; XMDUZ             DUZ of who the msg is from
"RTN","XMXSEND",16,0)
 ; XMSUBJ            Subject of the msg
"RTN","XMXSEND",17,0)
 ; XMBODY            Body of the msg
"RTN","XMXSEND",18,0)
 ;                   Must be closed root, passed by value.  See WP_ROOT
"RTN","XMXSEND",19,0)
 ;                   definition for WP^DIE(), FM word processing filer.
"RTN","XMXSEND",20,0)
 ; XMTO              Addressees
"RTN","XMXSEND",21,0)
 ; XMINSTR("SELF BSKT") Basket to deliver to if sender is recipient
"RTN","XMXSEND",22,0)
 ; XMINSTR("SHARE DATE") Delete date if recipient is "SHARED,MAIL"
"RTN","XMXSEND",23,0)
 ; XMINSTR("SHARE BSKT") Basket if recipient is "SHARED,MAIL"
"RTN","XMXSEND",24,0)
 ; XMINSTR("RCPT BSKT") Basket name (only) to deliver to for other recipients
"RTN","XMXSEND",25,0)
 ; XMINSTR("VAPOR")  Date on which to vaporize (delete) this message
"RTN","XMXSEND",26,0)
 ;                   from recipient baskets
"RTN","XMXSEND",27,0)
 ; XMINSTR("LATER")  Date on which to send this msg, if not now
"RTN","XMXSEND",28,0)
 ; XMINSTR("FROM")   String saying from whom (default is user)
"RTN","XMXSEND",29,0)
 ; XMINSTR("FLAGS")  Any or all of the following:
"RTN","XMXSEND",30,0)
 ;                   P Priority
"RTN","XMXSEND",31,0)
 ;                   I Information only (may not be replied to)
"RTN","XMXSEND",32,0)
 ;                   X Closed msg (may not be forwarded)
"RTN","XMXSEND",33,0)
 ;                   C Confidential (surrogates may not read)
"RTN","XMXSEND",34,0)
 ;                   S Send to sender (make sender a recipient)
"RTN","XMXSEND",35,0)
 ;                   R Confirm receipt
"RTN","XMXSEND",36,0)
 ; XMINSTR("SCR KEY") Scramble key (implies that msg should be scrambled)
"RTN","XMXSEND",37,0)
 ; XMINSTR("SCR HINT") Hint (to guess the scramble key)
"RTN","XMXSEND",38,0)
 ; XMINSTR("STRIP")  String containing characters to strip from the message text
"RTN","XMXSEND",39,0)
 ; XMINSTR("TYPE")   Msg type is one of the following:
"RTN","XMXSEND",40,0)
 ;                   D Document          (NOT IMPLEMENTED)
"RTN","XMXSEND",41,0)
 ;                   S Spooled Document  (NOT IMPLEMENTED)
"RTN","XMXSEND",42,0)
 ;                   X DIFROM            (NOT IMPLEMENTED)
"RTN","XMXSEND",43,0)
 ;                   O ODIF              (NOT IMPLEMENTED)
"RTN","XMXSEND",44,0)
 ;                   B BLOB
"RTN","XMXSEND",45,0)
 ;                   K KIDS              (NOT IMPLEMENTED)
"RTN","XMXSEND",46,0)
 ; XMINSTR("ADDR FLAGS")   Any or all of the following:
"RTN","XMXSEND",47,0)
 ;                   I Do not Initialize (kill) the ^TMP addressee global
"RTN","XMXSEND",48,0)
 ;                   R Do not Restrict addressees
"RTN","XMXSEND",49,0)
 ; XMZ         (out) msg number in ^XMB(3.9 (BUT IF $D(XMINSTR("LATER")),
"RTN","XMXSEND",50,0)
 ;                   then XMZ contains the task number)
"RTN","XMXSEND",51,0)
 ; XMATTACH    (in)  Array of files to attach to message
"RTN","XMXSEND",52,0)
 ;                   ("IMAGE",x) imaging (BLOB) files
"RTN","XMXSEND",53,0)
 ;                   ("ROU",x)   routines (NOT IMPLEMENTED)
"RTN","XMXSEND",54,0)
 K XMERR,^TMP("XMERR",$J)
"RTN","XMXSEND",55,0)
 Q:'$$SEND^XMXSEC(XMDUZ,.XMINSTR)
"RTN","XMXSEND",56,0)
 I $D(XMINSTR("LATER")) D  Q
"RTN","XMXSEND",57,0)
 . N XMTASK
"RTN","XMXSEND",58,0)
 . D PSNDLATR(XMDUZ,XMSUBJ,XMBODY,.XMTO,.XMINSTR,.XMTASK,.XMATTACH)
"RTN","XMXSEND",59,0)
 . I $D(XMTASK) S XMZ=XMTASK
"RTN","XMXSEND",60,0)
 D CRE8XMZ(XMSUBJ,.XMZ) Q:$D(XMERR)  ; Create a place for the msg in the msg file
"RTN","XMXSEND",61,0)
 D:$D(XMATTACH("IMAGE"))>9 ADDBLOB(XMZ,.XMATTACH) Q:$D(XMERR)
"RTN","XMXSEND",62,0)
 D MOVEBODY(XMZ,XMBODY) ; Put the msg body in place
"RTN","XMXSEND",63,0)
 D CHEKBODY(XMZ,$G(XMINSTR("STRIP")))
"RTN","XMXSEND",64,0)
 D ADDRNSND(XMDUZ,XMZ,.XMTO,.XMINSTR)
"RTN","XMXSEND",65,0)
 Q
"RTN","XMXSEND",66,0)
ADDRNSND(XMDUZ,XMZ,XMTO,XMINSTR) ;
"RTN","XMXSEND",67,0)
 D CHEKADDR(XMDUZ,XMZ,.XMTO,.XMINSTR)
"RTN","XMXSEND",68,0)
 D BLDNSND(XMDUZ,XMZ,.XMINSTR)
"RTN","XMXSEND",69,0)
 D CLEANUP^XMXADDR
"RTN","XMXSEND",70,0)
 Q
"RTN","XMXSEND",71,0)
CHEKADDR(XMDUZ,XMZ,XMTO,XMINSTR) ;
"RTN","XMXSEND",72,0)
 N XMRESTR
"RTN","XMXSEND",73,0)
 D:$G(XMINSTR("ADDR FLAGS"))'["I" INIT^XMXADDR
"RTN","XMXSEND",74,0)
 D:$G(XMINSTR("ADDR FLAGS"))'["R" CHKLINES^XMXSEC1(XMDUZ,XMZ,.XMRESTR)
"RTN","XMXSEND",75,0)
 D:$G(XMINSTR("FLAGS"))["S" CHKADDR^XMXADDR(XMDUZ,XMDUZ)
"RTN","XMXSEND",76,0)
 D CHKADDR^XMXADDR(XMDUZ,.XMTO,.XMINSTR,.XMRESTR) ; Address the msg
"RTN","XMXSEND",77,0)
 Q
"RTN","XMXSEND",78,0)
BLDNSND(XMDUZ,XMZ,XMINSTR) ;
"RTN","XMXSEND",79,0)
 D MOVEPART(XMDUZ,XMZ,.XMINSTR) ; Put various parts of the msg in place
"RTN","XMXSEND",80,0)
 I '$$GOTADDR^XMXADDR D ERRSET^XMXUTIL(34100) Q  ; No addressees.  Message not sent.
"RTN","XMXSEND",81,0)
 D SEND^XMKP(XMDUZ,XMZ,.XMINSTR) ; Send the msg
"RTN","XMXSEND",82,0)
 D CHECK^XMKPL
"RTN","XMXSEND",83,0)
 Q
"RTN","XMXSEND",84,0)
ADDBLOB(XMZ,XMATTACH) ;
"RTN","XMXSEND",85,0)
 N X,XMYBLOB,%X,%Y
"RTN","XMXSEND",86,0)
 S %X="XMATTACH(""IMAGE"",",%Y="XMYBLOB(" D %XY^%RCR
"RTN","XMXSEND",87,0)
 S X=$$MULTI^XMBBLOB(XMZ)
"RTN","XMXSEND",88,0)
 Q:'X
"RTN","XMXSEND",89,0)
 S XMERR=$G(XMERR)+1,^TMP("XMERR",$J,XMERR,"TEXT",1)="Error with $$MULTI^XMBBLOB"
"RTN","XMXSEND",90,0)
 D KILLMSG^XMXUTIL(XMZ)
"RTN","XMXSEND",91,0)
 Q
"RTN","XMXSEND",92,0)
CRE8XMZ(XMSUBJ,XMZ,XMIA) ; Create a place for the msg in the msg file
"RTN","XMXSEND",93,0)
 N XMFDA,XMIEN,XMMAXDIG,XMRESET
"RTN","XMXSEND",94,0)
 I XMSUBJ[U S XMSUBJ=$$ENCODEUP^XMXUTIL1(XMSUBJ)
"RTN","XMXSEND",95,0)
 S XMMAXDIG=$P($G(^XMB(1,1,.17),8),U,1) I 'XMMAXDIG S XMMAXDIG=8
"RTN","XMXSEND",96,0)
 S XMRESET=0
"RTN","XMXSEND",97,0)
TRYXMZ ;
"RTN","XMXSEND",98,0)
 S XMFDA(3.9,"+1,",.01)=XMSUBJ
"RTN","XMXSEND",99,0)
 S XMFDA(3.9,"+1,",31)=DT ; local create date
"RTN","XMXSEND",100,0)
 D UPDATE^DIE("","XMFDA","XMIEN")
"RTN","XMXSEND",101,0)
 I $D(DIERR) D  Q
"RTN","XMXSEND",102,0)
 . S XMZ=-1
"RTN","XMXSEND",103,0)
 . ; Call to UPDATE^DIE failed.  Can't get a message number.
"RTN","XMXSEND",104,0)
 . ; Here's the error returned by FileMan:
"RTN","XMXSEND",105,0)
 . D ERRSET^XMXUTIL(34107)
"RTN","XMXSEND",106,0)
 . N I,J,K
"RTN","XMXSEND",107,0)
 . S J=0
"RTN","XMXSEND",108,0)
 . S I=$O(^TMP("XMERR",$J,XMERR,"TEXT",":"),-1)
"RTN","XMXSEND",109,0)
 . F K=1:1:+DIERR D
"RTN","XMXSEND",110,0)
 . . F  S J=$O(^TMP("DIERR",$J,K,"TEXT",J)) Q:'J  D
"RTN","XMXSEND",111,0)
 . . . S I=I+1,^TMP("XMERR",$J,XMERR,"TEXT",I)=^TMP("DIERR",$J,K,"TEXT",J)
"RTN","XMXSEND",112,0)
 . Q:'$G(XMIA)!$D(ZTQUEUED)
"RTN","XMXSEND",113,0)
 . D SHOW^XMJERR
"RTN","XMXSEND",114,0)
 . D WAIT^XMXUTIL
"RTN","XMXSEND",115,0)
 S XMZ=XMIEN(1)
"RTN","XMXSEND",116,0)
 Q:$L(XMZ)'>XMMAXDIG
"RTN","XMXSEND",117,0)
 I XMRESET S $P(^XMB(1,1,.17),U,1)=$L(XMZ) Q
"RTN","XMXSEND",118,0)
 ; Recycle message numbers, because this one's too big...
"RTN","XMXSEND",119,0)
 K XMIEN
"RTN","XMXSEND",120,0)
 S XMRESET=1
"RTN","XMXSEND",121,0)
 I '$D(^XMB(3.9,99999,0)) D
"RTN","XMXSEND",122,0)
 . ; We do this so that if message 100000 is created and then deleted,
"RTN","XMXSEND",123,0)
 . ; FM will set piece 3 of ^XMB(3.9,0) to 99999.  We don't want any
"RTN","XMXSEND",124,0)
 . ; message number lower than 100000 to be created, so that message
"RTN","XMXSEND",125,0)
 . ; numbers can't be confused with message sequence numbers in baskets
"RTN","XMXSEND",126,0)
 . S ^XMB(3.9,99999,0)="place holder"
"RTN","XMXSEND",127,0)
 . S ^XMB(3.9,"B","place holder",99999)=""
"RTN","XMXSEND",128,0)
 L +^XMB(3.9,0):1
"RTN","XMXSEND",129,0)
 I $L($P(^XMB(3.9,0),U,3))>XMMAXDIG S $P(^XMB(3.9,0),U,3)=99999
"RTN","XMXSEND",130,0)
 N DIK,DA S DIK="^XMB(3.9,",DA=XMZ D ^DIK ; Delete the message stub.
"RTN","XMXSEND",131,0)
 L -^XMB(3.9,0)
"RTN","XMXSEND",132,0)
 G TRYXMZ ; Go get another
"RTN","XMXSEND",133,0)
MOVEBODY(XMZ,XMBODY,XMFLAG) ;
"RTN","XMXSEND",134,0)
 D WP^DIE(3.9,XMZ_",",3,$G(XMFLAG),XMBODY)
"RTN","XMXSEND",135,0)
 Q
"RTN","XMXSEND",136,0)
CHEKBODY(XMZ,XMSTRIP,XMI) ; Remove XMSTRIP, control characters from text
"RTN","XMXSEND",137,0)
 N XMLINE,I,XMLEN,XMALTRD
"RTN","XMXSEND",138,0)
 S XMI=+$G(XMI)
"RTN","XMXSEND",139,0)
 F  S XMI=$O(^XMB(3.9,XMZ,2,XMI)) Q:'XMI  S XMLINE=^(XMI,0) D
"RTN","XMXSEND",140,0)
 . S XMALTRD=0
"RTN","XMXSEND",141,0)
 . I $G(XMSTRIP)'="" S XMLEN=$L(XMLINE),XMLINE=$TR(XMLINE,XMSTRIP) I XMLEN>$L(XMLINE) S XMALTRD=1
"RTN","XMXSEND",142,0)
 . I XMLINE?.E1C.E D
"RTN","XMXSEND",143,0)
 . . S (I,XMALTRD)=1
"RTN","XMXSEND",144,0)
 . . F  D  Q:XMLINE'?.E1C.E
"RTN","XMXSEND",145,0)
 . . . I $E(XMLINE,I)?1C S XMLINE=$E(XMLINE,1,I-1)_$E(XMLINE,I+1,999) Q
"RTN","XMXSEND",146,0)
 . . . S I=I+1
"RTN","XMXSEND",147,0)
 . S:XMALTRD ^XMB(3.9,XMZ,2,XMI,0)=XMLINE
"RTN","XMXSEND",148,0)
 Q
"RTN","XMXSEND",149,0)
MOVEPART(XMDUZ,XMZ,XMINSTR) ; Put various parts of the msg in place
"RTN","XMXSEND",150,0)
 N XMFDA,XMIENS
"RTN","XMXSEND",151,0)
 S XMIENS=XMZ_","
"RTN","XMXSEND",152,0)
 I $D(XMINSTR("FROM")) S XMFDA(3.9,XMIENS,1)=XMINSTR("FROM")
"RTN","XMXSEND",153,0)
 E  D
"RTN","XMXSEND",154,0)
 . S XMFDA(3.9,XMIENS,1)=XMDUZ
"RTN","XMXSEND",155,0)
 . S:XMDUZ'=DUZ XMFDA(3.9,XMIENS,1.1)=DUZ
"RTN","XMXSEND",156,0)
 S XMFDA(3.9,XMIENS,1.4)=$$NOW^XLFDT()
"RTN","XMXSEND",157,0)
 I $D(XMINSTR) D
"RTN","XMXSEND",158,0)
 . S:$G(XMINSTR("FLAGS"))["R" XMFDA(3.9,XMIENS,1.3)="y"
"RTN","XMXSEND",159,0)
 . S:$D(XMINSTR("VAPOR")) XMFDA(3.9,XMIENS,1.6)=XMINSTR("VAPOR")
"RTN","XMXSEND",160,0)
 . S:$D(XMINSTR("TYPE")) XMFDA(3.9,XMIENS,1.7)=XMINSTR("TYPE")
"RTN","XMXSEND",161,0)
 . I $D(XMINSTR("SCR KEY")) D
"RTN","XMXSEND",162,0)
 . . N XMKEY,XMSECURE  ; XMSECURE is new'd for scramble
"RTN","XMXSEND",163,0)
 . . S XMFDA(3.9,XMIENS,1.8)=$S($G(XMINSTR("SCR HINT"))="":" ",1:XMINSTR("SCR HINT"))
"RTN","XMXSEND",164,0)
 . . D LOADCODE^XMJMCODE
"RTN","XMXSEND",165,0)
 . . S XMKEY=XMINSTR("SCR KEY")
"RTN","XMXSEND",166,0)
 . . D ADJUST^XMJMCODE(.XMKEY)
"RTN","XMXSEND",167,0)
 . . S XMFDA(3.9,XMIENS,1.85)="1"_$$ENCSTR^XMJMCODE(XMKEY)
"RTN","XMXSEND",168,0)
 . . D ENCMSG^XMJMCODE(XMZ)
"RTN","XMXSEND",169,0)
 . S:$G(XMINSTR("FLAGS"))["X" XMFDA(3.9,XMIENS,1.95)="y"
"RTN","XMXSEND",170,0)
 . S:$G(XMINSTR("FLAGS"))["C" XMFDA(3.9,XMIENS,1.96)="y"
"RTN","XMXSEND",171,0)
 . S:$G(XMINSTR("FLAGS"))["I" XMFDA(3.9,XMIENS,1.97)="y"
"RTN","XMXSEND",172,0)
 . S:$G(XMINSTR("FLAGS"))["P" XMFDA(3.9,XMIENS,1.7)=$G(XMFDA(3.9,XMIENS,1.7))_"P"
"RTN","XMXSEND",173,0)
 . S:$D(XMINSTR("RCPT BSKT")) XMFDA(3.9,XMIENS,21)=XMINSTR("RCPT BSKT")
"RTN","XMXSEND",174,0)
 S:$$BRODCAST^XMKP XMFDA(3.9,XMIENS,1.97)="y"
"RTN","XMXSEND",175,0)
 D FILE^DIE("","XMFDA")
"RTN","XMXSEND",176,0)
 Q
"RTN","XMXSEND",177,0)
LATER ; TaskMan entry point to send a user's latered message
"RTN","XMXSEND",178,0)
 N XMI,XMLATER,XMPREFIX,XMTO,XMV,XMPRIVAT,XMBCAST
"RTN","XMXSEND",179,0)
 S XMPRIVAT=$$EZBLD^DIALOG(39135) ; " [Private Mail Group]"
"RTN","XMXSEND",180,0)
 S XMBCAST=$$EZBLD^DIALOG(39006) ; "* (Broadcast to all local users)"
"RTN","XMXSEND",181,0)
 D INIT^XMVVITAE
"RTN","XMXSEND",182,0)
 S XMI=""
"RTN","XMXSEND",183,0)
 F  S XMI=$O(^TMP("XMY0",$J,XMI)) Q:XMI=""  D
"RTN","XMXSEND",184,0)
 . S XMPREFIX=$G(^TMP("XMY0",$J,XMI,1)) ; prefix (I:,C:)
"RTN","XMXSEND",185,0)
 . S XMLATER=$G(^TMP("XMY0",$J,XMI,"L"))
"RTN","XMXSEND",186,0)
 . S:XMLATER'="" XMPREFIX=XMPREFIX_"L@"_XMLATER
"RTN","XMXSEND",187,0)
 . S:XMPREFIX'="" XMPREFIX=XMPREFIX_":"
"RTN","XMXSEND",188,0)
 . S XMTO(XMPREFIX_$S(XMI[XMPRIVAT:$P(XMI,XMPRIVAT,1),XMI=XMBCAST:"*",1:XMI))="" ; (set in ^XMXADDRG)
"RTN","XMXSEND",189,0)
 D SENDMSG(XMDUZ,XMSUBJ,"^TMP(""XM"",$J,""BODY"")",.XMTO,.XMINSTR)
"RTN","XMXSEND",190,0)
 S ZTREQ="@"
"RTN","XMXSEND",191,0)
 Q
"RTN","XMXSEND",192,0)
PSNDLATR(XMDUZ,XMSUBJ,XMBODY,XMTO,XMINSTR,ZTSK,XMATTACH) ; Set up a task for a program to send a message later
"RTN","XMXSEND",193,0)
 N ZTRTN,ZTDTH,ZTDESC,ZTIO,ZTSAVE
"RTN","XMXSEND",194,0)
 S ZTIO=""
"RTN","XMXSEND",195,0)
 S ZTRTN="PTSKLATR^XMXSEND"
"RTN","XMXSEND",196,0)
 S ZTDTH=$$FMTH^XLFDT(XMINSTR("LATER"))
"RTN","XMXSEND",197,0)
 S ZTDESC=$$EZBLD^DIALOG(39310) ; MailMan: Send Message Later
"RTN","XMXSEND",198,0)
 S ZTSAVE($$OREF^DILF(XMBODY))=""
"RTN","XMXSEND",199,0)
 F I="DUZ","XMDUZ","XMSUBJ","XMBODY","XMTO","XMTO(","XMINSTR(","XMATTACH(" S ZTSAVE(I)=""
"RTN","XMXSEND",200,0)
 D ^%ZTLOAD
"RTN","XMXSEND",201,0)
 ;D HOME^%ZIS call this only if preceded by call to ^%ZIS
"RTN","XMXSEND",202,0)
 I '$D(ZTSK) D ERRSET^XMXUTIL(39311) ; Task creation not successful
"RTN","XMXSEND",203,0)
 Q
"RTN","XMXSEND",204,0)
PTSKLATR ; TaskMan entry point to send a program's latered message
"RTN","XMXSEND",205,0)
 K XMINSTR("LATER")
"RTN","XMXSEND",206,0)
 D SENDMSG(XMDUZ,XMSUBJ,XMBODY,.XMTO,.XMINSTR,"",.XMATTACH)
"RTN","XMXSEND",207,0)
 S ZTREQ="@"
"RTN","XMXSEND",208,0)
 Q
"RTN","XMXSEND",209,0)
STARTMSG(XMSUBJ,XMZ) ;
"RTN","XMXSEND",210,0)
 K XMERR,^TMP("XMERR",$J)
"RTN","XMXSEND",211,0)
 D CRE8XMZ(XMSUBJ,.XMZ) Q:$D(XMERR)
"RTN","XMXSEND",212,0)
 S XMLCNT=0
"RTN","XMXSEND",213,0)
 Q
"RTN","XMXSEND",214,0)
BODYLINE(XMZ,XMLINE) ; Put the msg body in place, line by line
"RTN","XMXSEND",215,0)
 S XMLCNT=XMLCNT+1
"RTN","XMXSEND",216,0)
 S ^XMB(3.9,XMZ,2,XMLCNT,0)=XMLINE
"RTN","XMXSEND",217,0)
 Q
"RTN","XMXSEND",218,0)
ENDMSG(XMDUZ,XMZ,XMTO,XMINSTR) ;
"RTN","XMXSEND",219,0)
 S ^XMB(3.9,XMZ,2,0)="^^"_XMLCNT_U_XMLCNT_U_DT
"RTN","XMXSEND",220,0)
 K XMLCNT
"RTN","XMXSEND",221,0)
 D ADDRNSND(XMDUZ,XMZ,.XMTO,.XMINSTR)
"RTN","XMXSEND",222,0)
 Q
"RTN","XMXSEND",223,0)
POSTMAST(XMDUZ,XMINSTR) ;
"RTN","XMXSEND",224,0)
 S:'$D(XMDUZ) XMDUZ=DUZ
"RTN","XMXSEND",225,0)
 D:'$G(XMV("PRIV")) INIT^XMVVITAE
"RTN","XMXSEND",226,0)
 S XMINSTR("FROM")=.5
"RTN","XMXSEND",227,0)
 Q
"RTN","XMXTO")
0^381^B4749458
"RTN","XMXTO",1,0)
XMXTO ;ISC-SF/GMB-Address a msg ;08/08/2000  14:38
"RTN","XMXTO",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMXTO",3,0)
 ; Entry points:
"RTN","XMXTO",4,0)
 ; ITOWHOM  Interactive 'to whom:'
"RTN","XMXTO",5,0)
 ; TOWHOM   Silent 'to whom:'
"RTN","XMXTO",6,0)
ITOWHOM(XMDUZ,XMZ,XMTYPE,XMINSTR) ; Interactive
"RTN","XMXTO",7,0)
 ; XMDUZ             DUZ of who is sending or forwarding the message
"RTN","XMXTO",8,0)
 ; XMZ               The message number
"RTN","XMXTO",9,0)
 ;                   (need not be supplied if XMTYPE="S" and
"RTN","XMXTO",10,0)
 ;                   XMINSTR("ADDR FLAGS")["R")
"RTN","XMXTO",11,0)
 ; XMTYPE            S='Send to:'
"RTN","XMXTO",12,0)
 ;                   F='Forward to:'
"RTN","XMXTO",13,0)
 ; XMINSTR("SELF BSKT") Basket to deliver to if sender is recipient
"RTN","XMXTO",14,0)
 ; XMINSTR("SHARE DATE") Delete date if recipient is "SHARED,MAIL"
"RTN","XMXTO",15,0)
 ; XMINSTR("SHARE BSKT") Basket if recipient is "SHARED,MAIL"
"RTN","XMXTO",16,0)
 ; XMINSTR("TO PROMPT") Initial prompt to whom to send the message (default=XMDUZ)
"RTN","XMXTO",17,0)
 ; XMINSTR("FLAGS")  Any or all or none of the following:
"RTN","XMXTO",18,0)
 ;                   (Necessary only if XMTYPE="S" and XMINSTR("ADDR FLAGS")["R")
"RTN","XMXTO",19,0)
 ;                   X Closed msg (may not be forwarded)
"RTN","XMXTO",20,0)
 ;                   C Confidential msg (surrogates may not read)
"RTN","XMXTO",21,0)
 ; XMINSTR("ADDR FLAGS")   Any or all of the following:
"RTN","XMXTO",22,0)
 ;                   I Do not Initialize (kill) the ^TMP addressee global
"RTN","XMXTO",23,0)
 ;                   R Do not Restrict addressees
"RTN","XMXTO",24,0)
 N XMRESTR,XMABORT
"RTN","XMXTO",25,0)
 K XMERR,^TMP("XMERR",$J)
"RTN","XMXTO",26,0)
 D INIT(XMDUZ,.XMZ,XMTYPE,.XMINSTR,.XMRESTR,.XMPROMPT) Q:$D(XMERR)
"RTN","XMXTO",27,0)
 S XMABORT=0
"RTN","XMXTO",28,0)
 D TOWHOM^XMJMT(XMDUZ,XMPROMPT,.XMINSTR,.XMRESTR,.XMABORT)
"RTN","XMXTO",29,0)
 Q:'XMABORT
"RTN","XMXTO",30,0)
 D ERRSET^XMXUTIL($S(XMABORT=1:37000,1:37001)) ; up-arrow out. / time out.
"RTN","XMXTO",31,0)
 Q
"RTN","XMXTO",32,0)
TOWHOM(XMDUZ,XMZ,XMTYPE,XMTO,XMINSTR,XMFULL) ; Silent
"RTN","XMXTO",33,0)
 ; XMDUZ       (in)  DUZ of who is sending or forwarding the message
"RTN","XMXTO",34,0)
 ; XMZ         (in)  The message number
"RTN","XMXTO",35,0)
 ;                   (need not be supplied if XMTYPE="S" and
"RTN","XMXTO",36,0)
 ;                   XMINSTR("ADDR FLAGS")["R")
"RTN","XMXTO",37,0)
 ; XMTYPE      (in)  S='Send to:'
"RTN","XMXTO",38,0)
 ;                   F='Forward to:'
"RTN","XMXTO",39,0)
 ; XMTO        (in)  ONE addressee
"RTN","XMXTO",40,0)
 ; XMINSTR("SELF BSKT")  (in) Basket to deliver to if sender is recipient
"RTN","XMXTO",41,0)
 ; XMINSTR("SHARE DATE") (in) Delete date if recipient is "SHARED,MAIL"
"RTN","XMXTO",42,0)
 ; XMINSTR("SHARE BSKT") (in) Basket if recipient is "SHARED,MAIL"
"RTN","XMXTO",43,0)
 ; XMINSTR("FLAGS")      (in) Any or all or none of the following:
"RTN","XMXTO",44,0)
 ;                   (Necessary only if XMTYPE="S" and XMINSTR("ADDR FLAGS")["R")
"RTN","XMXTO",45,0)
 ;                   X Closed msg (may not be forwarded)
"RTN","XMXTO",46,0)
 ;                   C Confidential msg (surrogates may not read)
"RTN","XMXTO",47,0)
 ; XMINSTR("ADDR FLAGS")   Any or all of the following:
"RTN","XMXTO",48,0)
 ;                   I Do not Initialize (kill) the ^TMP addressee global
"RTN","XMXTO",49,0)
 ;                   R Do not Restrict addressees
"RTN","XMXTO",50,0)
 ; XMFULL      (out) the full address
"RTN","XMXTO",51,0)
 N XMRESTR
"RTN","XMXTO",52,0)
 K XMERR,^TMP("XMERR",$J)
"RTN","XMXTO",53,0)
 D INIT(XMDUZ,.XMZ,XMTYPE,.XMINSTR,.XMRESTR) Q:$D(XMERR)
"RTN","XMXTO",54,0)
 D CHKADDR^XMXADDR(XMDUZ,.XMTO,.XMINSTR,.XMRESTR,.XMFULL)
"RTN","XMXTO",55,0)
 Q
"RTN","XMXTO",56,0)
INIT(XMDUZ,XMZ,XMTYPE,XMINSTR,XMRESTR,XMPROMPT) ;
"RTN","XMXTO",57,0)
 I XMTYPE="S" D
"RTN","XMXTO",58,0)
 . S XMPROMPT=$$EZBLD^DIALOG(34110) ; Send
"RTN","XMXTO",59,0)
 . D:$G(XMINSTR("ADDR FLAGS"))'["R" CHKLINES^XMXSEC1(XMDUZ,XMZ,.XMRESTR)
"RTN","XMXTO",60,0)
 E  D
"RTN","XMXTO",61,0)
 . N XMZREC
"RTN","XMXTO",62,0)
 . S XMZREC=^XMB(3.9,XMZ,0)
"RTN","XMXTO",63,0)
 . S XMPROMPT=$$EZBLD^DIALOG(34111) ; Forward
"RTN","XMXTO",64,0)
 . Q:'$$FORWARD^XMXSEC(XMDUZ,XMZ,XMZREC)
"RTN","XMXTO",65,0)
 . D:$G(XMINSTR("ADDR FLAGS"))'["R" GETRESTR^XMXSEC1(XMDUZ,XMZ,XMZREC,.XMINSTR,.XMRESTR)
"RTN","XMXTO",66,0)
 D:$G(XMINSTR("ADDR FLAGS"))'["I" INIT^XMXADDR
"RTN","XMXTO",67,0)
 Q
"RTN","XMXUTIL")
0^97^B61068501
"RTN","XMXUTIL",1,0)
XMXUTIL ;ISC-SF/GMB-Message & Mailbox Utilities ;06/19/2002  07:39
"RTN","XMXUTIL",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMXUTIL",3,0)
 ; All entry points covered by DBIA 2734.
"RTN","XMXUTIL",4,0)
WAIT ;
"RTN","XMXUTIL",5,0)
 N DIR,Y,DIRUT S DIR(0)="E",DIR("A")=$$EZBLD^DIALOG(37003) D ^DIR ; Press RETURN to continue
"RTN","XMXUTIL",6,0)
 Q
"RTN","XMXUTIL",7,0)
PAGE(XMABORT) ;
"RTN","XMXUTIL",8,0)
 N DIR,Y,DIRUT S DIR(0)="E" D ^DIR I $D(DIRUT) S XMABORT=1
"RTN","XMXUTIL",9,0)
 Q
"RTN","XMXUTIL",10,0)
NEWS(XMDUZ,XMTEST) ;
"RTN","XMXUTIL",11,0)
 ; Given:
"RTN","XMXUTIL",12,0)
 ;   XMDUZ    User's DUZ
"RTN","XMXUTIL",13,0)
 ;   XMTEST   0=this is not a test. (DEFAULT)
"RTN","XMXUTIL",14,0)
 ;            (Field 1.12 LAST NEW MSG NOTIFY DATE/TIME may be updated)
"RTN","XMXUTIL",15,0)
 ;            1=this is just a test.
"RTN","XMXUTIL",16,0)
 ;            (Field 1.12 will not be updated)
"RTN","XMXUTIL",17,0)
 ; Returns:
"RTN","XMXUTIL",18,0)
 ;   -1       If no record of this user
"RTN","XMXUTIL",19,0)
 ;   0        If no new mail
"RTN","XMXUTIL",20,0)
 ; Otherwise, if the user has new mail, returns an ^-delimited string:
"RTN","XMXUTIL",21,0)
 ;   Piece 1:  # New Msgs
"RTN","XMXUTIL",22,0)
 ;   Piece 2:  Does the user have new priority mail? (1=yes;0=no)
"RTN","XMXUTIL",23,0)
 ;   Piece 3:  # New Msgs in IN basket
"RTN","XMXUTIL",24,0)
 ;   Piece 4:  Date/Time (FileMan) that the last msg was received
"RTN","XMXUTIL",25,0)
 ;   Piece 5:  Have there been any new messages since the last time
"RTN","XMXUTIL",26,0)
 ;             this function was called? (1=yes;0=no)
"RTN","XMXUTIL",27,0)
 ; And for the first priority read basket with new messages in it:
"RTN","XMXUTIL",28,0)
 ; (If none has new messages, then first priority read basket)
"RTN","XMXUTIL",29,0)
 ;   Piece 6:  # New Msgs in basket
"RTN","XMXUTIL",30,0)
 ;   Piece 7:  Basket IEN
"RTN","XMXUTIL",31,0)
 ;   Piece 8:  Basket name
"RTN","XMXUTIL",32,0)
 N XMREC,XMNEW,XMRECEIV,XMNOTIFY
"RTN","XMXUTIL",33,0)
 S XMREC=$G(^XMB(3.7,XMDUZ,0))
"RTN","XMXUTIL",34,0)
 Q:XMREC="" -1
"RTN","XMXUTIL",35,0)
 S XMNEW=+$P(XMREC,U,6)
"RTN","XMXUTIL",36,0)
 Q:'XMNEW 0
"RTN","XMXUTIL",37,0)
 S XMRECEIV=$P(XMREC,U,14) ; date/time last msg received
"RTN","XMXUTIL",38,0)
 S XMNOTIFY=$P(XMREC,U,15) ; date/time user last notified
"RTN","XMXUTIL",39,0)
 I XMRECEIV>XMNOTIFY,'$G(XMTEST) S $P(^XMB(3.7,XMDUZ,0),U,15)=XMRECEIV
"RTN","XMXUTIL",40,0)
 Q XMNEW_U_($D(^XMB(3.7,XMDUZ,"N"))>0)_U_+$P(^XMB(3.7,XMDUZ,2,1,0),U,2)_U_XMRECEIV_U_(XMRECEIV>XMNOTIFY)_U_$$NPBSKT^XMJBN(XMDUZ)
"RTN","XMXUTIL",41,0)
TNMSGCT(XMDUZ) ; Total new msg count
"RTN","XMXUTIL",42,0)
 Q +$P(^XMB(3.7,XMDUZ,0),U,6)
"RTN","XMXUTIL",43,0)
BNMSGCT(XMDUZ,XMK) ; Basket new msg count
"RTN","XMXUTIL",44,0)
 Q +$P(^XMB(3.7,XMDUZ,2,XMK,0),U,2)
"RTN","XMXUTIL",45,0)
TPMSGCT(XMDUZ) ; Total new priority msg count
"RTN","XMXUTIL",46,0)
 I '$D(^XMB(3.7,XMDUZ,"N")) Q 0
"RTN","XMXUTIL",47,0)
 N XMK,I,XMZ
"RTN","XMXUTIL",48,0)
 S (XMK,I,XMZ)=0
"RTN","XMXUTIL",49,0)
 F  S XMK=$O(^XMB(3.7,XMDUZ,"N",XMK)) Q:'XMK  D
"RTN","XMXUTIL",50,0)
 . F I=I:1 S XMZ=$O(^XMB(3.7,XMDUZ,"N",XMK,XMZ)) Q:'XMZ
"RTN","XMXUTIL",51,0)
 Q I
"RTN","XMXUTIL",52,0)
BPMSGCT(XMDUZ,XMK) ; Basket new priority msg count
"RTN","XMXUTIL",53,0)
 I '$D(^XMB(3.7,XMDUZ,"N",XMK)) Q 0
"RTN","XMXUTIL",54,0)
 N I,XMZ
"RTN","XMXUTIL",55,0)
 S XMZ=0
"RTN","XMXUTIL",56,0)
 F I=0:1 S XMZ=$O(^XMB(3.7,XMDUZ,"N",XMK,XMZ)) Q:'XMZ
"RTN","XMXUTIL",57,0)
 Q I
"RTN","XMXUTIL",58,0)
TMSGCT(XMDUZ) ; Total msg count
"RTN","XMXUTIL",59,0)
 N I,XMK
"RTN","XMXUTIL",60,0)
 S I=0,XMK=.99
"RTN","XMXUTIL",61,0)
 F  S XMK=$O(^XMB(3.7,XMDUZ,2,XMK)) Q:XMK'>0  S I=I+$$BMSGCT(XMDUZ,XMK)
"RTN","XMXUTIL",62,0)
 Q I
"RTN","XMXUTIL",63,0)
BMSGCT(XMDUZ,XMK) ; Basket msg count
"RTN","XMXUTIL",64,0)
 Q +$P($G(^XMB(3.7,XMDUZ,2,XMK,1,0)),U,4)
"RTN","XMXUTIL",65,0)
KVAPOR(XMDUZ,XMK,XMZ,XMVAPOR,XMIU) ; Set/delete a message's vaporize date in user's basket
"RTN","XMXUTIL",66,0)
 ; XMVAPOR ="@"           delete it
"RTN","XMXUTIL",67,0)
 ;         =FM date/time  set/change it
"RTN","XMXUTIL",68,0)
 N XMFDA,XMIENS
"RTN","XMXUTIL",69,0)
 S XMIENS=XMZ_","_XMK_","_XMDUZ_","
"RTN","XMXUTIL",70,0)
 S XMFDA(3.702,XMIENS,5)=XMVAPOR
"RTN","XMXUTIL",71,0)
 I XMVAPOR="@" D
"RTN","XMXUTIL",72,0)
 . K XMIU("KVAPOR")
"RTN","XMXUTIL",73,0)
 . S XMFDA(3.702,XMIENS,7)="@"
"RTN","XMXUTIL",74,0)
 E  D
"RTN","XMXUTIL",75,0)
 . S XMIU("KVAPOR")=XMVAPOR
"RTN","XMXUTIL",76,0)
 . S XMFDA(3.702,XMIENS,7)=0
"RTN","XMXUTIL",77,0)
 D FILE^DIE("","XMFDA")
"RTN","XMXUTIL",78,0)
 Q
"RTN","XMXUTIL",79,0)
BSKTNAME(XMDUZ,XMK) ; What's the name of this basket for this user?
"RTN","XMXUTIL",80,0)
 Q $P($G(^XMB(3.7,XMDUZ,2,XMK,0)),U,1)
"RTN","XMXUTIL",81,0)
NAME(XMID,XMIT) ; Given a name or DUZ, return the name
"RTN","XMXUTIL",82,0)
 ; XMID user's DUZ or name
"RTN","XMXUTIL",83,0)
 ; XMIT 1=if DUZ, return institution and title, too, if needed
"RTN","XMXUTIL",84,0)
 ;      0=just return the name (default)
"RTN","XMXUTIL",85,0)
 Q:+XMID'=XMID $S(XMID'="":XMID,1:$$EZBLD^DIALOG(34009)) ; * No Name *
"RTN","XMXUTIL",86,0)
 N XMNAME,XMTITLE,XMINST
"RTN","XMXUTIL",87,0)
 I '$D(^VA(200,XMID,0)) Q $$EZBLD^DIALOG(34010,XMID) ; * User #|1| * (not in NEW PERSON file)
"RTN","XMXUTIL",88,0)
 S XMNAME("FILE")=200,XMNAME("IENS")=XMID_",",XMNAME("FIELD")=.01
"RTN","XMXUTIL",89,0)
 S XMNAME=$$NAMEFMT^XLFNAME(.XMNAME,"F","C")
"RTN","XMXUTIL",90,0)
 Q:'$G(XMIT) XMNAME
"RTN","XMXUTIL",91,0)
 I XMV("SHOW TITL") D
"RTN","XMXUTIL",92,0)
 . I XMV("TITL SRC")="S" S XMTITLE=$P($G(^VA(200,XMID,20)),U,3) ; field 20.3, SIGNATURE BLOCK TITLE
"RTN","XMXUTIL",93,0)
 . I $G(XMTITLE)="",$P(^VA(200,XMID,0),U,9) S XMTITLE=$P($G(^DIC(3.1,$P(^(0),U,9),0)),U) ; field 8, TITLE
"RTN","XMXUTIL",94,0)
 . S:$G(XMTITLE)'="" XMNAME=XMNAME_" - "_XMTITLE
"RTN","XMXUTIL",95,0)
 I XMV("SHOW INST"),$D(^XMB(3.7,XMID,6000)) D
"RTN","XMXUTIL",96,0)
 . S XMINST=$P(^XMB(3.7,XMID,6000),U)
"RTN","XMXUTIL",97,0)
 . S:XMINST'="" XMNAME=XMNAME_" ("_XMINST_")"
"RTN","XMXUTIL",98,0)
 Q XMNAME
"RTN","XMXUTIL",99,0)
NETNAME(XMDUZ) ; Given a DUZ or a string, return an internet name @ site name.
"RTN","XMXUTIL",100,0)
 N XMNETNAM
"RTN","XMXUTIL",101,0)
 Q:XMDUZ["@" XMDUZ
"RTN","XMXUTIL",102,0)
 I +XMDUZ=XMDUZ!(XMDUZ="") D
"RTN","XMXUTIL",103,0)
 . S:'XMDUZ XMDUZ=.5
"RTN","XMXUTIL",104,0)
 . ; Use Mail Name.  Lacking that, use real name.
"RTN","XMXUTIL",105,0)
 . S XMNETNAM=$S($L($P($G(^XMB(3.7,XMDUZ,.3)),U)):$P(^(.3),U),1:$$NAME(XMDUZ))
"RTN","XMXUTIL",106,0)
 . I $E(XMNETNAM)=$C(34),$E(XMNETNAM,$L(XMNETNAM))=$C(34) Q  ; Ignore if quoted
"RTN","XMXUTIL",107,0)
 . I XMNETNAM?.E1C.E!($TR(XMNETNAM,$C(34)_"<>()[];:")'=XMNETNAM) S XMNETNAM=$C(34)_XMNETNAM_$C(34) Q  ; Quote if illegal
"RTN","XMXUTIL",108,0)
 . I XMNETNAM[","!(XMNETNAM[" ") S XMNETNAM=$TR(XMNETNAM,", .","._+")  ; Translate
"RTN","XMXUTIL",109,0)
 E  D
"RTN","XMXUTIL",110,0)
 . S XMNETNAM=XMDUZ
"RTN","XMXUTIL",111,0)
 . I $E(XMNETNAM)'=$C(34),$E(XMNETNAM,$L(XMNETNAM))'=$C(34) D
"RTN","XMXUTIL",112,0)
 . . I $E(XMNETNAM)="<",$E(XMNETNAM,$L(XMNETNAM))=">" D  I $E(XMNETNAM)=$C(34),$E(XMNETNAM,$L(XMNETNAM))=$C(34) Q
"RTN","XMXUTIL",113,0)
 . . . S XMNETNAM=$E(XMNETNAM,2,$L(XMNETNAM)-1)
"RTN","XMXUTIL",114,0)
 . . I XMNETNAM?.E1C.E!($TR(XMNETNAM,$C(34)_" ,<>()[];:")'=XMNETNAM) S XMNETNAM=$C(34)_XMNETNAM_$C(34) ; Quote if illegal
"RTN","XMXUTIL",115,0)
 Q XMNETNAM_"@"_^XMB("NETNAME")
"RTN","XMXUTIL",116,0)
LOCK(XMDOOR,XMLOCKED,XMWAIT) ; Lock a global (** NOT USED **)
"RTN","XMXUTIL",117,0)
 L +@XMDOOR:$G(XMWAIT,0) E  S XMLOCKED=0 Q
"RTN","XMXUTIL",118,0)
 S XMLOCKED=1
"RTN","XMXUTIL",119,0)
 Q
"RTN","XMXUTIL",120,0)
MAKENEW(XMDUZ,XMK,XMZ,XMLOCKIT) ; Make a message new
"RTN","XMXUTIL",121,0)
 ; Should lock before calling AND unlock after.
"RTN","XMXUTIL",122,0)
 ; If you set XMLOCKIT=1, I'll do the locking for you.
"RTN","XMXUTIL",123,0)
 Q:$D(^XMB(3.7,XMDUZ,"N0",XMK,XMZ))
"RTN","XMXUTIL",124,0)
 Q:'$D(^XMB(3.7,XMDUZ,2,XMK,1,XMZ))
"RTN","XMXUTIL",125,0)
 N XMFDA
"RTN","XMXUTIL",126,0)
 S XMFDA(3.702,XMZ_","_XMK_","_XMDUZ_",",3)="1" ; new
"RTN","XMXUTIL",127,0)
 I $G(XMLOCKIT) L +^XMB(3.7,XMDUZ,2,XMK,1,XMZ,0):1
"RTN","XMXUTIL",128,0)
 D FILE^DIE("","XMFDA")
"RTN","XMXUTIL",129,0)
 I $G(XMLOCKIT) L -^XMB(3.7,XMDUZ,2,XMK,1,XMZ,0)
"RTN","XMXUTIL",130,0)
 D INCRNEW(XMDUZ,XMK)
"RTN","XMXUTIL",131,0)
 Q
"RTN","XMXUTIL",132,0)
INCRNEW(XMDUZ,XMK,XMCNT) ; Increment the number of new messages in a basket
"RTN","XMXUTIL",133,0)
 ; For internal use only!
"RTN","XMXUTIL",134,0)
 S:'$D(XMCNT) XMCNT=1
"RTN","XMXUTIL",135,0)
 L +^XMB(3.7,XMDUZ,0):1
"RTN","XMXUTIL",136,0)
 S $P(^(0),U,2)=$P(^XMB(3.7,XMDUZ,2,XMK,0),U,2)+XMCNT ; New msgs in bskt
"RTN","XMXUTIL",137,0)
 S $P(^(0),U,6)=$P(^XMB(3.7,XMDUZ,0),U,6)+XMCNT ; New msgs for user
"RTN","XMXUTIL",138,0)
 S $P(^XMB(3.7,XMDUZ,0),U,14)=$$NOW^XLFDT ; When last msg rec'd
"RTN","XMXUTIL",139,0)
 L -^XMB(3.7,XMDUZ,0)
"RTN","XMXUTIL",140,0)
 Q
"RTN","XMXUTIL",141,0)
NONEW(XMDUZ,XMK,XMZ,XMLOCKIT) ; Make a message not new
"RTN","XMXUTIL",142,0)
 ; Should lock before calling AND unlock after.
"RTN","XMXUTIL",143,0)
 ; If you set XMLOCKIT=1, I'll do the locking for you.
"RTN","XMXUTIL",144,0)
 Q:'$D(^XMB(3.7,XMDUZ,"N0",XMK,XMZ))
"RTN","XMXUTIL",145,0)
 N XMFDA
"RTN","XMXUTIL",146,0)
 S XMFDA(3.702,XMZ_","_XMK_","_XMDUZ_",",3)="@" ; no longer new
"RTN","XMXUTIL",147,0)
 I $G(XMLOCKIT) L +^XMB(3.7,XMDUZ,2,XMK,1,XMZ,0):1
"RTN","XMXUTIL",148,0)
 D FILE^DIE("","XMFDA")
"RTN","XMXUTIL",149,0)
 I $G(XMLOCKIT) L -^XMB(3.7,XMDUZ,2,XMK,1,XMZ,0)
"RTN","XMXUTIL",150,0)
 D DECRNEW(XMDUZ,XMK)
"RTN","XMXUTIL",151,0)
 Q
"RTN","XMXUTIL",152,0)
DECRNEW(XMDUZ,XMK,XMCNT) ; Decrement the number of new messages in a basket
"RTN","XMXUTIL",153,0)
 ; For internal use only!
"RTN","XMXUTIL",154,0)
 S:'$D(XMCNT) XMCNT=1
"RTN","XMXUTIL",155,0)
 L +^XMB(3.7,XMDUZ,0):1
"RTN","XMXUTIL",156,0)
 I $P(^XMB(3.7,XMDUZ,2,XMK,0),U,2) S $P(^(0),U,2)=$P(^(0),U,2)-XMCNT ; New msgs in bskt
"RTN","XMXUTIL",157,0)
 I $P(^XMB(3.7,XMDUZ,0),U,6) S $P(^(0),U,6)=$P(^(0),U,6)-XMCNT ; New msgs for user
"RTN","XMXUTIL",158,0)
 L -^XMB(3.7,XMDUZ,0)
"RTN","XMXUTIL",159,0)
 Q
"RTN","XMXUTIL",160,0)
KILLMSG(DA) ; For internal MM use only.  Kill a msg in ^XMB(3.9
"RTN","XMXUTIL",161,0)
 N DIK
"RTN","XMXUTIL",162,0)
 S DIK="^XMB(3.9,"
"RTN","XMXUTIL",163,0)
 L +^XMB(3.9,0):1
"RTN","XMXUTIL",164,0)
 D ^DIK
"RTN","XMXUTIL",165,0)
 L -^XMB(3.9,0)
"RTN","XMXUTIL",166,0)
 Q
"RTN","XMXUTIL",167,0)
LASTACC(XMDUZ,XMK,XMZ,XMRESP,XMIM,XMINSTR,XMIU,XMCONFRM) ; Note first, last accesses, number of responses read
"RTN","XMXUTIL",168,0)
 ; in:
"RTN","XMXUTIL",169,0)
 ; XMDUZ,XMK,XMZ the usual.  If message not in basket, set XMK=0.
"RTN","XMXUTIL",170,0)
 ; XMRESP   last response read this time
"RTN","XMXUTIL",171,0)
 ; XMIM     "SUBJ", "FROM"
"RTN","XMXUTIL",172,0)
 ; XMINSTR  "FLAGS"
"RTN","XMXUTIL",173,0)
 ; XMIU     "IEN", "RESP"
"RTN","XMXUTIL",174,0)
 ; out:
"RTN","XMXUTIL",175,0)
 ; XMCONFRM Confirmation message was sent to message sender (0=no; 1=yes)
"RTN","XMXUTIL",176,0)
 N XMNOW,XMREC,XMFDA,XMIENS
"RTN","XMXUTIL",177,0)
 I XMRESP D
"RTN","XMXUTIL",178,0)
 . N XMRESPS ; User can't read more responses than there are.
"RTN","XMXUTIL",179,0)
 . S XMRESPS=+$P($G(^XMB(3.9,XMZ,3,0)),U,4)
"RTN","XMXUTIL",180,0)
 . I XMRESP>XMRESPS S XMRESP=XMRESPS
"RTN","XMXUTIL",181,0)
 S XMCONFRM=0
"RTN","XMXUTIL",182,0)
 I 'XMIU("IEN") D  Q
"RTN","XMXUTIL",183,0)
 . I XMRESP>XMIU("RESP")!(XMIU("RESP")="") S XMIU("RESP")=XMRESP
"RTN","XMXUTIL",184,0)
 S XMNOW=$$NOW^XLFDT
"RTN","XMXUTIL",185,0)
 S XMREC=^XMB(3.9,XMZ,1,XMIU("IEN"),0)
"RTN","XMXUTIL",186,0)
 I $P(XMREC,U,10)="" D
"RTN","XMXUTIL",187,0)
 . S $P(XMREC,U,10)=XMNOW ; first access 
"RTN","XMXUTIL",188,0)
 . ; If confirmation requested, and user is not sender, send confirmation
"RTN","XMXUTIL",189,0)
 . I XMINSTR("FLAGS")["R",XMDUZ'=XMIM("FROM") D CONFIRM^XMXUTIL1(XMDUZ,XMZ,.XMIM) S XMCONFRM=1
"RTN","XMXUTIL",190,0)
 S $P(XMREC,U,3)=XMNOW  ; last access
"RTN","XMXUTIL",191,0)
 I $S(XMRESP>$P(XMREC,U,2):1,1:$P(XMREC,U,2)="") S XMIU("RESP")=XMRESP,$P(XMREC,U,2)=XMRESP ; last response read
"RTN","XMXUTIL",192,0)
 S ^XMB(3.9,XMZ,1,XMIU("IEN"),0)=XMREC
"RTN","XMXUTIL",193,0)
 I XMDUZ'=DUZ,XMDUZ'=.6 S ^XMB(3.9,XMZ,1,XMIU("IEN"),"S")=XMV("DUZ NAME")
"RTN","XMXUTIL",194,0)
 Q:'XMK
"RTN","XMXUTIL",195,0)
 S XMREC=$G(^XMB(3.7,XMDUZ,2,XMK,1,XMZ,0))
"RTN","XMXUTIL",196,0)
 Q:XMREC=""  ; Message is not in the user's basket
"RTN","XMXUTIL",197,0)
 I '$P(XMREC,U,7) D  Q
"RTN","XMXUTIL",198,0)
 . S $P(^XMB(3.7,XMDUZ,2,XMK,1,XMZ,0),U,4)=XMNOW ; last access (for MailMan's auto-vaporize)
"RTN","XMXUTIL",199,0)
 ; MailMan has set an automatic delete date.  Since this message was
"RTN","XMXUTIL",200,0)
 ; just accessed, we must delete that date.
"RTN","XMXUTIL",201,0)
 S XMIENS=XMZ_","_XMK_","_XMDUZ_","
"RTN","XMXUTIL",202,0)
 S XMFDA(3.702,XMIENS,4)=XMNOW ; last access (for MailMan's auto-vaporize)
"RTN","XMXUTIL",203,0)
 S XMFDA(3.702,XMIENS,5)="@" ; automatic delete date
"RTN","XMXUTIL",204,0)
 S XMFDA(3.702,XMIENS,7)="@" ; delete date set by MailMan?
"RTN","XMXUTIL",205,0)
 D FILE^DIE("","XMFDA")
"RTN","XMXUTIL",206,0)
 Q
"RTN","XMXUTIL",207,0)
ERRSET(XMID,XMPARM,XMZ) ; For internal MailMan use only.
"RTN","XMXUTIL",208,0)
 S XMERR=$G(XMERR)+1
"RTN","XMXUTIL",209,0)
 S ^TMP("XMERR",$J,XMERR)=XMID
"RTN","XMXUTIL",210,0)
 I $D(XMZ) S ^TMP("XMERR",$J,XMERR,"XMZ")=XMZ
"RTN","XMXUTIL",211,0)
 I $D(XMPARM("PARAM")) M ^TMP("XMERR",$J,XMERR,"PARAM")=XMPARM("PARAM")
"RTN","XMXUTIL",212,0)
 D BLD^DIALOG(XMID,.XMPARM,"","^TMP(""XMERR"",$J,"_XMERR_",""TEXT"")")
"RTN","XMXUTIL",213,0)
 S ^TMP("XMERR",$J,"E",XMID,XMERR)=""
"RTN","XMXUTIL",214,0)
 Q
"RTN","XMXUTIL1")
0^98^B30118375
"RTN","XMXUTIL1",1,0)
XMXUTIL1 ;ISC-SF/GMB-Date & String Utilities ;04/17/2002  14:14
"RTN","XMXUTIL1",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMXUTIL1",3,0)
 ; All entry points covered by DBIA 2735.
"RTN","XMXUTIL1",4,0)
ENCODEUP(XMSUBJ) ; Change ^ to ~U~
"RTN","XMXUTIL1",5,0)
 F  Q:XMSUBJ'[U  S XMSUBJ=$P(XMSUBJ,U)_"~U~"_$P(XMSUBJ,U,2,999)
"RTN","XMXUTIL1",6,0)
 Q XMSUBJ
"RTN","XMXUTIL1",7,0)
DECODEUP(XMSUBJ) ; Change ~U~ to ^
"RTN","XMXUTIL1",8,0)
 F  Q:XMSUBJ'["~U~"  S XMSUBJ=$P(XMSUBJ,"~U~")_U_$P(XMSUBJ,"~U~",2,999)
"RTN","XMXUTIL1",9,0)
 Q XMSUBJ
"RTN","XMXUTIL1",10,0)
SCRUB(XMSTRING) ; Strip ctrl chars and leading/trailing blanks
"RTN","XMXUTIL1",11,0)
 S:$E(XMSTRING,1)=" "!($E(XMSTRING,$L(XMSTRING))=" ") XMSTRING=$$STRIP(XMSTRING)
"RTN","XMXUTIL1",12,0)
 S:XMSTRING?.E1C.E XMSTRING=$$CTRL(XMSTRING)
"RTN","XMXUTIL1",13,0)
 Q XMSTRING
"RTN","XMXUTIL1",14,0)
STRIP(XMSTRING) ; Strip leading and trailing blanks from a string
"RTN","XMXUTIL1",15,0)
 N I
"RTN","XMXUTIL1",16,0)
 I $E(XMSTRING,1)=" " D
"RTN","XMXUTIL1",17,0)
 . F I=2:1 Q:$E(XMSTRING,I)'=" "
"RTN","XMXUTIL1",18,0)
 . S XMSTRING=$E(XMSTRING,I,999)
"RTN","XMXUTIL1",19,0)
 I $E(XMSTRING,$L(XMSTRING))=" " D
"RTN","XMXUTIL1",20,0)
 . F I=$L(XMSTRING):-1 Q:$E(XMSTRING,I)'=" "
"RTN","XMXUTIL1",21,0)
 . S XMSTRING=$E(XMSTRING,1,I)
"RTN","XMXUTIL1",22,0)
 Q XMSTRING
"RTN","XMXUTIL1",23,0)
MAXBLANK(XMSTRING) ; Reduce 3 or more consecutive blanks in a string to 2
"RTN","XMXUTIL1",24,0)
 F  Q:XMSTRING'["   "  D
"RTN","XMXUTIL1",25,0)
 . S XMSTRING=$P(XMSTRING,"   ",1)_"  "_$P(XMSTRING,"   ",2,999)
"RTN","XMXUTIL1",26,0)
 Q XMSTRING
"RTN","XMXUTIL1",27,0)
CTRL(XMSTRING) ; Strip control characters from a string
"RTN","XMXUTIL1",28,0)
 N I
"RTN","XMXUTIL1",29,0)
 S I=1
"RTN","XMXUTIL1",30,0)
 F  Q:XMSTRING'?.E1C.E  D
"RTN","XMXUTIL1",31,0)
 . F I=I:1 Q:$E(XMSTRING,I)?1C
"RTN","XMXUTIL1",32,0)
 . S XMSTRING=$E(XMSTRING,1,I-1)_$E(XMSTRING,I+1,999)
"RTN","XMXUTIL1",33,0)
 Q XMSTRING
"RTN","XMXUTIL1",34,0)
MELD(XMSTRING,XMNUMBER,XMLEN) ; Function right-justifies a string and
"RTN","XMXUTIL1",35,0)
 ; left-justifies a number in a combined string of a given length.
"RTN","XMXUTIL1",36,0)
 ; The string will be truncated, if necessary.
"RTN","XMXUTIL1",37,0)
 ; e.g. $$MELD("I just love Lotus, don't you?",123,22) returns:
"RTN","XMXUTIL1",38,0)
 ;             "I just love Lotus  123"
"RTN","XMXUTIL1",39,0)
 Q:$G(XMNUMBER)="" $E($$LJ^XLFSTR(XMSTRING,XMLEN),1,XMLEN)
"RTN","XMXUTIL1",40,0)
 S XMLEN=XMLEN-$L(XMNUMBER)-2
"RTN","XMXUTIL1",41,0)
 Q $E($$LJ^XLFSTR(XMSTRING,XMLEN),1,XMLEN)_"  "_XMNUMBER
"RTN","XMXUTIL1",42,0)
TSTAMP() ; Timestamp
"RTN","XMXUTIL1",43,0)
 N X
"RTN","XMXUTIL1",44,0)
 S X=$H
"RTN","XMXUTIL1",45,0)
 Q X*86400+$P(X,",",2)
"RTN","XMXUTIL1",46,0)
MMDT(XMDT) ; (MailMan Date/Time) Given FM date/time, return external.
"RTN","XMXUTIL1",47,0)
 ; time is optional
"RTN","XMXUTIL1",48,0)
 Q:XMDT'=+XMDT XMDT
"RTN","XMXUTIL1",49,0)
 Q $$FMTE^XLFDT($E(XMDT,1,12),"2Z")  ; return mm/dd/yy@hh:mm
"RTN","XMXUTIL1",50,0)
 N MMDT ; return dd mmm yy hh:mm
"RTN","XMXUTIL1",51,0)
 I $E(XMDT,4,5)="00" S $E(XMDT,4,5)="01"
"RTN","XMXUTIL1",52,0)
 I $E(XMDT,6,7)="00" S $E(XMDT,6,7)="01"
"RTN","XMXUTIL1",53,0)
 S MMDT=$E(XMDT,6,7)_" "_$P("Jan^Feb^Mar^Apr^May^Jun^Jul^Aug^Sep^Oct^Nov^Dec",U,$E(XMDT,4,5))_" "_$E(XMDT,2,3)
"RTN","XMXUTIL1",54,0)
 S XMDT=$P(XMDT,".",2)_"0000"
"RTN","XMXUTIL1",55,0)
 Q:'XMDT MMDT
"RTN","XMXUTIL1",56,0)
 Q MMDT_" "_$E(XMDT,1,2)_":"_$E(XMDT,3,4)
"RTN","XMXUTIL1",57,0)
INDT(XMDT) ; (InterNet Date/Time) Given FM date/time, return dd mmm yyyy hh:mm:ss +-hhmm (zone)
"RTN","XMXUTIL1",58,0)
 I $E(XMDT,4,5)="00" S $E(XMDT,4,5)="01"
"RTN","XMXUTIL1",59,0)
 I $E(XMDT,6,7)="00" S $E(XMDT,6,7)="01"
"RTN","XMXUTIL1",60,0)
 S XMDT=$$FMTE^XLFDT(XMDT,"1S")
"RTN","XMXUTIL1",61,0)
 ; Convert "Jun 28, 1955@10:10:00" to "28 Jun 1955 10:10:00"
"RTN","XMXUTIL1",62,0)
 S XMDT=+$P(XMDT," ",2)_" "_$P(XMDT," ",1)_" "_+$P(XMDT," ",3)_" "_$S(XMDT["@":$P(XMDT,"@",2),1:"00:00:00")
"RTN","XMXUTIL1",63,0)
 Q XMDT_" "_^XMB("TIMEDIFF")_" ("_^XMB("TIMEZONE")_")"
"RTN","XMXUTIL1",64,0)
CONVERT(X,XMTIME) ; Function to convert Internet dates to FM (returns -1 if error)
"RTN","XMXUTIL1",65,0)
 ; X         Internet date
"RTN","XMXUTIL1",66,0)
 ; XMTIME    =1 Convert time, too; =0 convert date only
"RTN","XMXUTIL1",67,0)
 ; Formats:  Tuesday, 28 June 1955 17:30:45 PDT
"RTN","XMXUTIL1",68,0)
 ;           Tue, 28 Jun 1955 17:30:45 PDT
"RTN","XMXUTIL1",69,0)
 ;           Tue 28 Jun 1955 17:30:45 PDT
"RTN","XMXUTIL1",70,0)
 ;           28 Jun 1955 17:30:45 -0900 (PST)  <== MailMan standard
"RTN","XMXUTIL1",71,0)
 ;           28 Jun 55 17:30 PST            <== Previous MailMan standard
"RTN","XMXUTIL1",72,0)
 ;           Tue Jun 28 17:30:45 PDT 1955
"RTN","XMXUTIL1",73,0)
 ;           28-JUN-1955 17:30:45 -0400
"RTN","XMXUTIL1",74,0)
 ;           6/28/55 17:30
"RTN","XMXUTIL1",75,0)
 ;           JUN 28 17:30 1955
"RTN","XMXUTIL1",76,0)
 N %DT,Y,XMD,XMT
"RTN","XMXUTIL1",77,0)
 I $E(X)=" "!($E(X)=$C(9)) F  S X=$E(X,2,99) Q:$E(X)'=$C(9)&($E(X)'=" ")  ; remove leading blanks or tabs
"RTN","XMXUTIL1",78,0)
 I X?.E2" ".E D  ; reduce all consecutive blanks to 1 blank
"RTN","XMXUTIL1",79,0)
 . N I S I=1
"RTN","XMXUTIL1",80,0)
 . F  S I=$F(X,"  ",I) Q:I=0  S X=$E(X,1,I-2)_$E(X,I,99),I=I-1
"RTN","XMXUTIL1",81,0)
 I X?3.A.E D
"RTN","XMXUTIL1",82,0)
 . I X?3.A1", ".E!(X?3.A1" "3.A.E)!(X?3.A1" "1.2N1" "3.A.E) S X=$P(X," ",2,99) ; remove leading day of week
"RTN","XMXUTIL1",83,0)
 I $P(X," ",3)[":" D
"RTN","XMXUTIL1",84,0)
 . S XMD=$P(X," ",1,2)_" "_$P(X," ",$L(X," ")) ; time is before year
"RTN","XMXUTIL1",85,0)
 . S XMT=$P(X," ",3,$L(X," ")-1)
"RTN","XMXUTIL1",86,0)
 E  D
"RTN","XMXUTIL1",87,0)
 . S XMD=$P(X," ",1,3) ; year is before time
"RTN","XMXUTIL1",88,0)
 . I XMD[":" D
"RTN","XMXUTIL1",89,0)
 . . S XMD=$P(X," ",1) ; "28-JUN-1955 17:30:45 -0400" or "6/28/55 17:30"
"RTN","XMXUTIL1",90,0)
 . . S XMT=$P(X," ",2,99)
"RTN","XMXUTIL1",91,0)
 . E  S XMT=$P(X," ",4,99)
"RTN","XMXUTIL1",92,0)
 I $G(XMTIME) Q $$TIMETOO(XMD,XMT)
"RTN","XMXUTIL1",93,0)
 S X=XMD
"RTN","XMXUTIL1",94,0)
 D ^%DT
"RTN","XMXUTIL1",95,0)
 Q Y
"RTN","XMXUTIL1",96,0)
TIMETOO(XMD,XMT) ; For internal MailMan use only.  Combine date and time, adjusting for difference from GMT.
"RTN","XMXUTIL1",97,0)
 N XMHH,XMMM,X,Y
"RTN","XMXUTIL1",98,0)
 I $L(XMT," ")>1 D  Q:XMMM=-1 -1
"RTN","XMXUTIL1",99,0)
 . N XMYT           ; 17:30:45 -0800 (PST)
"RTN","XMXUTIL1",100,0)
 . S XMYT=$TR($P(XMT," ",2),"()")
"RTN","XMXUTIL1",101,0)
 . D ZONEDIFF(XMYT,.XMHH,.XMMM)
"RTN","XMXUTIL1",102,0)
 E  D
"RTN","XMXUTIL1",103,0)
 . S (XMHH,XMMM)=0  ; 17:30:45
"RTN","XMXUTIL1",104,0)
 S XMT=$P(XMT," ",1)
"RTN","XMXUTIL1",105,0)
 S:$L($P(XMT,":"))=1 XMT="0"_XMT
"RTN","XMXUTIL1",106,0)
 S XMT=$E(XMT,1,5)  ; FM will only handle hh:mm, not :ss
"RTN","XMXUTIL1",107,0)
 S:XMT="00:00" XMT="00:01" ; if midnight, add a minute
"RTN","XMXUTIL1",108,0)
 S X=XMD_"@"_XMT
"RTN","XMXUTIL1",109,0)
 S %DT="T" D ^%DT Q:Y=-1 -1
"RTN","XMXUTIL1",110,0)
 I 'XMHH,'XMMM Q Y
"RTN","XMXUTIL1",111,0)
 Q $$FMADD^XLFDT(Y,"",XMHH,XMMM)
"RTN","XMXUTIL1",112,0)
ZONEDIFF(XMYT,XMHH,XMMM) ; Given a time zone or time difference from GMT,
"RTN","XMXUTIL1",113,0)
 ; calculates the hours and minutes difference between that zone and ours
"RTN","XMXUTIL1",114,0)
 ; XMYT    IN:  Your Time zone or Time difference from GMT
"RTN","XMXUTIL1",115,0)
 ; XMHH    OUT: The time difference between us in hours
"RTN","XMXUTIL1",116,0)
 ; XMMM    OUT: The time difference between us in minutes
"RTN","XMXUTIL1",117,0)
 ; XMYTHH  Your Time difference from GMT in hours
"RTN","XMXUTIL1",118,0)
 ; XMYTMM  Your Time difference from GMT in minutes
"RTN","XMXUTIL1",119,0)
 ; XMMT    My Time difference from GMT
"RTN","XMXUTIL1",120,0)
 ; XMMTHH  My Time difference from GMT in hours
"RTN","XMXUTIL1",121,0)
 ; XMMTMM  My Time difference from GMT in minutes
"RTN","XMXUTIL1",122,0)
 N XMMT,XMYTHH,XMYTMM,XMMTHH,XMMTMM
"RTN","XMXUTIL1",123,0)
 S XMMT=^XMB("TIMEDIFF")
"RTN","XMXUTIL1",124,0)
 I XMYT=^XMB("TIMEZONE")!(XMYT=XMMT) S (XMHH,XMMM)=0 Q
"RTN","XMXUTIL1",125,0)
 I XMYT?3A S XMYT=$$GMTDIFF(XMYT) I XMYT="" S XMMM=-1 Q
"RTN","XMXUTIL1",126,0)
 S XMYTHH=XMYT\100
"RTN","XMXUTIL1",127,0)
 S XMYTMM=XMYT-(XMYTHH*100)
"RTN","XMXUTIL1",128,0)
 S XMMTHH=XMMT\100
"RTN","XMXUTIL1",129,0)
 S XMMTMM=XMMT-(XMMTHH*100)
"RTN","XMXUTIL1",130,0)
 S XMHH=XMMTHH-XMYTHH
"RTN","XMXUTIL1",131,0)
 S XMMM=XMMTMM-XMYTMM
"RTN","XMXUTIL1",132,0)
 Q
"RTN","XMXUTIL1",133,0)
 ; Also, remember, FM will not handle a 1-digit year
"RTN","XMXUTIL1",134,0)
 ; If this becomes a problem:
"RTN","XMXUTIL1",135,0)
 I $L($P(X," ",3))=1 S $P(X," ",3)="0"_$P(X," ",3)
"RTN","XMXUTIL1",136,0)
 ; *****************************************************
"RTN","XMXUTIL1",137,0)
GMTDIFF(XMZONE) ; Given time zone, returns standard internet time difference from GMT
"RTN","XMXUTIL1",138,0)
 ; XMZONE   3-char time zone name (PST, EDT, etc.)
"RTN","XMXUTIL1",139,0)
 ; returns difference in hours and minutes (+-hhmm) from GMT
"RTN","XMXUTIL1",140,0)
 ;          e.g. -0230, +1600
"RTN","XMXUTIL1",141,0)
 ; If time zone can't be found, returns null string
"RTN","XMXUTIL1",142,0)
 N XMIEN
"RTN","XMXUTIL1",143,0)
 S XMIEN=$O(^XMB(4.4,"B",XMZONE,0)) Q:'XMIEN ""
"RTN","XMXUTIL1",144,0)
 S XMDIFF=$P($G(^XMB(4.4,XMIEN,0)),U,3) Q:XMIEN="" ""
"RTN","XMXUTIL1",145,0)
 Q $$TIMEDIFF(XMDIFF)
"RTN","XMXUTIL1",146,0)
TIMEDIFF(XMDIFF) ; Given time difference, returns standard internet time difference.
"RTN","XMXUTIL1",147,0)
 ; XMDIFF   Difference (in hours) from GMT
"RTN","XMXUTIL1",148,0)
 ;          e.g. -2.5 => -0230
"RTN","XMXUTIL1",149,0)
 ;                16  => +1600
"RTN","XMXUTIL1",150,0)
 N XMSIGN
"RTN","XMXUTIL1",151,0)
 I XMDIFF<0 S XMSIGN="-",XMDIFF=-XMDIFF
"RTN","XMXUTIL1",152,0)
 E  S XMSIGN="+"
"RTN","XMXUTIL1",153,0)
 S XMDIFF=XMDIFF\1*100+(XMDIFF#1*60\1)
"RTN","XMXUTIL1",154,0)
 Q XMSIGN_$$RJ^XLFSTR(XMDIFF,4,"0")
"RTN","XMXUTIL1",155,0)
CONFIRM(XMDUZ,XMZ,XMIM) ; For internal MailMan use only.  Send confirmation message to sender.
"RTN","XMXUTIL1",156,0)
 N XMPARM,XMTO
"RTN","XMXUTIL1",157,0)
 S XMPARM(1)=XMIM("SUBJ")
"RTN","XMXUTIL1",158,0)
 S XMPARM(2)=XMV("NAME") S:XMDUZ'=DUZ XMPARM(2)=XMPARM(2)_$$EZBLD^DIALOG(38008,XMV("DUZ NAME")) ; (Surrogate: |1|)
"RTN","XMXUTIL1",159,0)
 ;S XMPARM(3)=$S($D(^XMB(3.9,XMZ,5)):$P(^(5),U),1:XMZ)
"RTN","XMXUTIL1",160,0)
 S XMTO=XMIM("FROM")
"RTN","XMXUTIL1",161,0)
 S XMTO=$S(+XMTO=XMTO:XMTO,1:$$RCPTTO(XMZ))
"RTN","XMXUTIL1",162,0)
 D TASKBULL^XMXBULL(XMDUZ,"XMRDACK",.XMPARM,"",XMTO)
"RTN","XMXUTIL1",163,0)
 Q
"RTN","XMXUTIL1",164,0)
RCPTTO(XMZ) ; For internal MailMan use only.  Return-receipt-to a remote address.
"RTN","XMXUTIL1",165,0)
 N XMI,XMREC,XMHDR,XMTO
"RTN","XMXUTIL1",166,0)
 S XMI=0,XMHDR=""
"RTN","XMXUTIL1",167,0)
 F  S XMI=$O(^XMB(3.9,XMZ,2,XMI)) Q:XMI'<1!'XMI  S XMREC=^(XMI,0) D  Q:$D(XMTO)
"RTN","XMXUTIL1",168,0)
 . Q:XMREC=""
"RTN","XMXUTIL1",169,0)
 . S XMHDR=$P(XMREC,":") Q:XMHDR=""
"RTN","XMXUTIL1",170,0)
 . S XMHDR=$$UP^XLFSTR(XMHDR)
"RTN","XMXUTIL1",171,0)
 . I XMHDR="RETURN-RECEIPT-TO" S XMTO=$$SCRUB($P(XMREC,":",2,99)) Q
"RTN","XMXUTIL1",172,0)
 S:'$D(XMTO) XMTO=$P(^XMB(3.9,XMZ,0),U,2)
"RTN","XMXUTIL1",173,0)
 Q $$REMADDR^XMXADDR3(XMTO)
"RTN","XMXUTIL2")
0^382^B43408568
"RTN","XMXUTIL2",1,0)
XMXUTIL2 ;ISC-SF/GMB-Message info ;04/19/2002  13:34
"RTN","XMXUTIL2",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMXUTIL2",3,0)
 ; All entry points covered by DBIA 2736.
"RTN","XMXUTIL2",4,0)
QRESP(XMZ,XMZREC,XMWHICH) ; Function returns 0 if message XMZ is a message.
"RTN","XMXUTIL2",5,0)
 ; If message XMZ is a response, returns XMZ of original message
"RTN","XMXUTIL2",6,0)
 ; and, optionally, the response number as the second piece.
"RTN","XMXUTIL2",7,0)
 ; in:
"RTN","XMXUTIL2",8,0)
 ; XMZ     XMZ of the message to be checked
"RTN","XMXUTIL2",9,0)
 ; XMZREC  (optional) 0-node of the message
"RTN","XMXUTIL2",10,0)
 ; XMWHICH (optional) If the message is a response, should MailMan also
"RTN","XMXUTIL2",11,0)
 ;         return the response number as the second piece?
"RTN","XMXUTIL2",12,0)
 ;         (0=no (default); 1=yes)
"RTN","XMXUTIL2",13,0)
 N XMZO
"RTN","XMXUTIL2",14,0)
 I $G(XMZREC)="" S XMZREC=$G(^XMB(3.9,XMZ,0))
"RTN","XMXUTIL2",15,0)
 S XMZO=$S($P(XMZREC,U,8):$P(XMZREC,U,8),$P(XMZREC,U)?1"R"1.N:+$E(XMZREC,2,99),1:"")
"RTN","XMXUTIL2",16,0)
 ; The following test (XMZO'=XMZ) is necessary,
"RTN","XMXUTIL2",17,0)
 ; because some old messages point to themselves as responses.
"RTN","XMXUTIL2",18,0)
 I XMZO,XMZO'=XMZ Q:'$G(XMWHICH) XMZO  D  Q XMZO_U_XMWHICH
"RTN","XMXUTIL2",19,0)
 . S XMWHICH=0 ; This is a response to message XMZO.
"RTN","XMXUTIL2",20,0)
 . F  S XMWHICH=$O(^XMB(3.9,XMZO,3,XMWHICH)) Q:'XMWHICH  Q:^(XMWHICH,0)=XMZ
"RTN","XMXUTIL2",21,0)
 Q 0  ; This is a message.
"RTN","XMXUTIL2",22,0)
INMSG(XMDUZ,XMK,XMZ,XMZREC,XMFLAGS,XMIM,XMINSTR,XMIU) ;
"RTN","XMXUTIL2",23,0)
 ; Should NOT be called for responses!
"RTN","XMXUTIL2",24,0)
 ; XMFLAGS        If XMFLAGS["I" return internal only
"RTN","XMXUTIL2",25,0)
 ;                          ["F" return FM date
"RTN","XMXUTIL2",26,0)
 ; XMIU("KVAPOR") If applicable, user-specified vaporize date for message in basket
"RTN","XMXUTIL2",27,0)
 ; XMIU("NEW")    Is message new? (0=no; 1=yes; 2=yes, and priority, too)
"RTN","XMXUTIL2",28,0)
 D INMSG1(XMDUZ,XMZ,.XMZREC,.XMFLAGS,.XMIM,.XMIU)
"RTN","XMXUTIL2",29,0)
 D INMSG2(XMDUZ,XMZ,XMZREC,.XMIM,.XMINSTR,.XMIU)
"RTN","XMXUTIL2",30,0)
 Q:'XMK
"RTN","XMXUTIL2",31,0)
 N XMKREC
"RTN","XMXUTIL2",32,0)
 S XMKREC=$G(^XMB(3.7,XMDUZ,2,XMK,1,XMZ,0))
"RTN","XMXUTIL2",33,0)
 I $P(XMKREC,U,5) S XMIU("KVAPOR")=$P(XMKREC,U,5)
"RTN","XMXUTIL2",34,0)
 S XMIU("NEW")=$$NEW(XMDUZ,XMK,XMZ)
"RTN","XMXUTIL2",35,0)
 Q
"RTN","XMXUTIL2",36,0)
INMSG1(XMDUZ,XMZ,XMZREC,XMFLAGS,XMIM,XMIU) ; (Should NOT be called for responses!)
"RTN","XMXUTIL2",37,0)
 ; XMIM("RESPS")
"RTN","XMXUTIL2",38,0)
 ; XMIU("IEN")
"RTN","XMXUTIL2",39,0)
 ; XMIU("RESP")
"RTN","XMXUTIL2",40,0)
 I $G(XMZREC)="" S XMZREC=$G(^XMB(3.9,XMZ,0))
"RTN","XMXUTIL2",41,0)
 S XMFLAGS=$G(XMFLAGS)
"RTN","XMXUTIL2",42,0)
 D INM(XMZ,XMZREC,XMFLAGS,.XMIM)
"RTN","XMXUTIL2",43,0)
 I $D(XMIU) K XMIU
"RTN","XMXUTIL2",44,0)
 S XMIU("IEN")=+$O(^XMB(3.9,XMZ,1,"C",XMDUZ,0))
"RTN","XMXUTIL2",45,0)
 D INRESPS(XMZ,.XMIM,.XMIU)
"RTN","XMXUTIL2",46,0)
 Q
"RTN","XMXUTIL2",47,0)
INM(XMZ,XMZREC,XMFLAGS,XMIM) ; For internal MailMan use only.
"RTN","XMXUTIL2",48,0)
 ; XMIM and XMIU are killed first
"RTN","XMXUTIL2",49,0)
 ; out:
"RTN","XMXUTIL2",50,0)
 ; Always returned:
"RTN","XMXUTIL2",51,0)
 ; XMIM("XMZ")
"RTN","XMXUTIL2",52,0)
 ; XMIM("SUBJ")
"RTN","XMXUTIL2",53,0)
 ; XMIM("FROM")
"RTN","XMXUTIL2",54,0)
 ; XMIM("DATE")
"RTN","XMXUTIL2",55,0)
 ; XMIM("CRE8")
"RTN","XMXUTIL2",56,0)
 ; XMIM("SENDR")
"RTN","XMXUTIL2",57,0)
 ; XMIM("LINES")
"RTN","XMXUTIL2",58,0)
 ; XMIM("ENV FROM") 'Envelope From' returned only if it exists
"RTN","XMXUTIL2",59,0)
 ; Returned if XMFLAGS'["I":
"RTN","XMXUTIL2",60,0)
 ; XMIM("FROM DUZ")
"RTN","XMXUTIL2",61,0)
 ; XMIM("FROM NAME")
"RTN","XMXUTIL2",62,0)
 ; XMIM("DATE FM")     Returned if XMFLAGS["F"
"RTN","XMXUTIL2",63,0)
 ; XMIM("DATE MM")     Returned if XMFLAGS'["F"
"RTN","XMXUTIL2",64,0)
 ; XMIM("CRE8 MM")     Returned if XMFLAGS'["F"
"RTN","XMXUTIL2",65,0)
 ; XMIM("SENDR DUZ")
"RTN","XMXUTIL2",66,0)
 ; XMIM("SENDR NAME")
"RTN","XMXUTIL2",67,0)
 I $D(XMIM) K XMIM
"RTN","XMXUTIL2",68,0)
 S XMIM("XMZ")=XMZ
"RTN","XMXUTIL2",69,0)
 I $G(XMZREC)="" S XMZREC=$G(^XMB(3.9,XMZ,0))
"RTN","XMXUTIL2",70,0)
 S XMIM("SUBJ")=$$SUBJ^XMXUTIL2(XMZREC)
"RTN","XMXUTIL2",71,0)
 S XMIM("FROM")=$P(XMZREC,U,2)
"RTN","XMXUTIL2",72,0)
 S XMIM("DATE")=$P(XMZREC,U,3)
"RTN","XMXUTIL2",73,0)
 S XMIM("SENDR")=$P(XMZREC,U,4)
"RTN","XMXUTIL2",74,0)
 S XMIM("CRE8")=$P($G(^XMB(3.9,XMZ,.6)),U)
"RTN","XMXUTIL2",75,0)
 S XMIM("LINES")=+$P($G(^XMB(3.9,XMZ,2,0)),U,4)
"RTN","XMXUTIL2",76,0)
 I $D(^XMB(3.9,XMZ,.7)) D
"RTN","XMXUTIL2",77,0)
 . N XMNVFROM
"RTN","XMXUTIL2",78,0)
 . S XMNVFROM=$P($G(^XMB(3.9,XMZ,.7)),U,1)
"RTN","XMXUTIL2",79,0)
 . I XMNVFROM'="" S XMIM("ENV FROM")=XMNVFROM
"RTN","XMXUTIL2",80,0)
 Q:XMFLAGS["I"
"RTN","XMXUTIL2",81,0)
 I +XMIM("FROM")'=XMIM("FROM") S XMIM("FROM NAME")=XMIM("FROM")
"RTN","XMXUTIL2",82,0)
 E  S XMIM("FROM DUZ")=XMIM("FROM"),XMIM("FROM NAME")=$$NAME^XMXUTIL(XMIM("FROM"))
"RTN","XMXUTIL2",83,0)
 I XMIM("SENDR")'="" D
"RTN","XMXUTIL2",84,0)
 . I +XMIM("SENDR")'=XMIM("SENDR") S XMIM("SENDR NAME")=XMIM("SENDR")
"RTN","XMXUTIL2",85,0)
 . E  S XMIM("SENDR DUZ")=XMIM("SENDR"),XMIM("SENDR NAME")=$$NAME^XMXUTIL(XMIM("SENDR"))
"RTN","XMXUTIL2",86,0)
 I XMFLAGS["F" D  Q
"RTN","XMXUTIL2",87,0)
 . I XMIM("DATE")?7N.E S XMIM("DATE FM")=XMIM("DATE") Q
"RTN","XMXUTIL2",88,0)
 . S XMIM("DATE FM")=$$CONVERT^XMXUTIL1(XMIM("DATE"),1)
"RTN","XMXUTIL2",89,0)
 S XMIM("DATE MM")=$$DATE(XMZREC,1) ; MailMan date
"RTN","XMXUTIL2",90,0)
 S XMIM("CRE8 MM")=$$MMDT^XMXUTIL1(XMIM("CRE8")) ; MailMan date
"RTN","XMXUTIL2",91,0)
 Q
"RTN","XMXUTIL2",92,0)
INRESPS(XMZ,XMIM,XMIU) ; How many responses?  What's the user read?
"RTN","XMXUTIL2",93,0)
 ; In:
"RTN","XMXUTIL2",94,0)
 ; XMZ
"RTN","XMXUTIL2",95,0)
 ; XMIU("IEN")   ien of user's record in recipient multiple
"RTN","XMXUTIL2",96,0)
 ; Out:
"RTN","XMXUTIL2",97,0)
 ; XMIM("RESPS") message has this many responses
"RTN","XMXUTIL2",98,0)
 ; XMIU("RESP")  last response read by the user
"RTN","XMXUTIL2",99,0)
 ;               (null=not read at all; 0=original msg only; number=resp)
"RTN","XMXUTIL2",100,0)
 S XMIM("RESPS")=+$P($G(^XMB(3.9,XMZ,3,0)),U,4)
"RTN","XMXUTIL2",101,0)
 S XMIU("RESP")=$P($G(^XMB(3.9,XMZ,1,XMIU("IEN"),0)),U,2)
"RTN","XMXUTIL2",102,0)
 Q
"RTN","XMXUTIL2",103,0)
INRESP(XMZ,XMIEN,XMFLAGS,XMIR) ; Get info on a response to a message.
"RTN","XMXUTIL2",104,0)
 ; In:
"RTN","XMXUTIL2",105,0)
 ; XMZ     XMZ of original message
"RTN","XMXUTIL2",106,0)
 ; XMIEN   Which response (1 thru # of responses)
"RTN","XMXUTIL2",107,0)
 ; XMFLAGS If XMFLAGS["I" return internal only
"RTN","XMXUTIL2",108,0)
 ;                   ["F" return FM date
"RTN","XMXUTIL2",109,0)
 ; Out:
"RTN","XMXUTIL2",110,0)
 ; XMIR   
"RTN","XMXUTIL2",111,0)
 N XMZREC,XMZR
"RTN","XMXUTIL2",112,0)
 K XMIR
"RTN","XMXUTIL2",113,0)
 I '$D(^XMB(3.9,XMZ,3,XMIEN)) Q
"RTN","XMXUTIL2",114,0)
 S XMZR=$G(^XMB(3.9,XMZ,3,XMIEN,0)) Q:'XMZR
"RTN","XMXUTIL2",115,0)
 S XMZREC=$G(^XMB(3.9,XMZR,0))
"RTN","XMXUTIL2",116,0)
 D INM(XMZR,XMZREC,XMFLAGS,.XMIR)
"RTN","XMXUTIL2",117,0)
 ;Q:XMIR("SUBJ")'?1"R".N
"RTN","XMXUTIL2",118,0)
 ;Q:XMFLAGS["I"
"RTN","XMXUTIL2",119,0)
 ;S XMZREC=$G(^XMB(3.9,XMZ,0)) Q:XMZREC=""
"RTN","XMXUTIL2",120,0)
 ;S XMIR("SUBJ X")="Re: "_$P(XMZREC,U,1)
"RTN","XMXUTIL2",121,0)
 ;I XMIR("SUBJ X")["~U~" S XMIR("SUBJ")=$$DECODEUP^XMXUTIL1(XMIR("SUBJ X"))
"RTN","XMXUTIL2",122,0)
 Q
"RTN","XMXUTIL2",123,0)
INMSG2(XMDUZ,XMZ,XMZREC,XMIM,XMINSTR,XMIU) ;
"RTN","XMXUTIL2",124,0)
 ; Should NOT be called for responses!
"RTN","XMXUTIL2",125,0)
 ; Does not kill XMIM, XMINSTR, or XMIU first
"RTN","XMXUTIL2",126,0)
 ; XMIM("RECIPS")   number of recipients of the message
"RTN","XMXUTIL2",127,0)
 ; XMIU("ORIGN8")   user sent message (0=no; 1=yes)
"RTN","XMXUTIL2",128,0)
 ; The following are set only if applicable:
"RTN","XMXUTIL2",129,0)
 ; XMINSTR("FLAGS")
"RTN","XMXUTIL2",130,0)
 ; XMINSTR("RCPT BSKT")
"RTN","XMXUTIL2",131,0)
 ; XMINSTR("TYPE")
"RTN","XMXUTIL2",132,0)
 ; XMINSTR("VAPOR")
"RTN","XMXUTIL2",133,0)
 ; XMINSTR("SCR HINT")
"RTN","XMXUTIL2",134,0)
 S XMIM("RECIPS")=$P($G(^XMB(3.9,XMZ,1,0)),U,4)
"RTN","XMXUTIL2",135,0)
 I $G(XMZREC)="" S XMZREC=$G(^XMB(3.9,XMZ,0))
"RTN","XMXUTIL2",136,0)
 S XMIU("ORIGN8")=$$ORIGIN8R^XMXSEC(XMDUZ,XMZREC)
"RTN","XMXUTIL2",137,0)
 S:$P(XMZREC,U,6)'="" XMINSTR("VAPOR")=$P(XMZREC,U,6)
"RTN","XMXUTIL2",138,0)
 S XMINSTR("TYPE")=$P(XMZREC,U,7)  ; Msg type (regular, KIDS, etc.)
"RTN","XMXUTIL2",139,0)
 I $$PAKMAN^XMXSEC1(XMZ,XMZREC) D
"RTN","XMXUTIL2",140,0)
 . Q:XMINSTR("TYPE")["K"  ; KIDS
"RTN","XMXUTIL2",141,0)
 . S:XMINSTR("TYPE")'["X" XMINSTR("TYPE")=XMINSTR("TYPE")_"X" ; PackMan
"RTN","XMXUTIL2",142,0)
 S XMINSTR("FLAGS")=""
"RTN","XMXUTIL2",143,0)
 S:"^Y^y^"[(U_$P(XMZREC,U,5)_U) XMINSTR("FLAGS")=XMINSTR("FLAGS")_"R" ; confirmation requested
"RTN","XMXUTIL2",144,0)
 S:"^Y^y^"[(U_$P(XMZREC,U,9)_U) XMINSTR("FLAGS")=XMINSTR("FLAGS")_"X" ; closed
"RTN","XMXUTIL2",145,0)
 S:"^Y^y^"[(U_$P(XMZREC,U,11)_U) XMINSTR("FLAGS")=XMINSTR("FLAGS")_"C" ; confidential
"RTN","XMXUTIL2",146,0)
 S:"^Y^y^"[(U_$P(XMZREC,U,12)_U) XMINSTR("FLAGS")=XMINSTR("FLAGS")_"I" ; information only
"RTN","XMXUTIL2",147,0)
 I $P(XMZREC,U,10)'="" S XMINSTR("SCR HINT")=$P(XMZREC,U,10)
"RTN","XMXUTIL2",148,0)
 I $D(^XMB(3.9,XMZ,.5)) D
"RTN","XMXUTIL2",149,0)
 . N XMZBSKT
"RTN","XMXUTIL2",150,0)
 . S XMZBSKT=$P(^XMB(3.9,XMZ,.5),U,1)
"RTN","XMXUTIL2",151,0)
 . S:XMZBSKT'="" XMINSTR("RCPT BSKT")=XMZBSKT
"RTN","XMXUTIL2",152,0)
 Q:XMINSTR("TYPE")'["P"
"RTN","XMXUTIL2",153,0)
 S XMINSTR("FLAGS")=XMINSTR("FLAGS")_"P" ; priority
"RTN","XMXUTIL2",154,0)
 S XMINSTR("TYPE")=$TR(XMINSTR("TYPE"),"P")
"RTN","XMXUTIL2",155,0)
 S:'$P($G(^XMB(3.9,XMZ,1,XMIU("IEN"),0)),U,9) XMINSTR("FLAGS")=XMINSTR("FLAGS")_"K" ; priority responses
"RTN","XMXUTIL2",156,0)
 Q
"RTN","XMXUTIL2",157,0)
ZNODE(XMZ) ; Returns the zero node of the message.
"RTN","XMXUTIL2",158,0)
 Q $G(^XMB(3.9,XMZ,0))
"RTN","XMXUTIL2",159,0)
ZDATE(XMZ,XMTIME) ; What is the message date? (Formatted by $$MMDT^XMXUTIL1)
"RTN","XMXUTIL2",160,0)
 ; XMTIME =0 Date only
"RTN","XMXUTIL2",161,0)
 ;        =1 Date and time (default)
"RTN","XMXUTIL2",162,0)
 Q $$DATE($G(^XMB(3.9,XMZ,0)),.XMTIME)
"RTN","XMXUTIL2",163,0)
DATE(XMZREC,XMTIME) ; What is the message date? (Formatted by $$MMDT^XMXUTIL1)
"RTN","XMXUTIL2",164,0)
 ; XMTIME =0 Date only
"RTN","XMXUTIL2",165,0)
 ;        =1 Date and time (default)
"RTN","XMXUTIL2",166,0)
 N XMDATE
"RTN","XMXUTIL2",167,0)
 S XMDATE=$P(XMZREC,U,3)
"RTN","XMXUTIL2",168,0)
 S XMTIME=+$G(XMTIME,1)
"RTN","XMXUTIL2",169,0)
 I XMDATE?7N.E Q $$MMDT^XMXUTIL1($S(XMTIME:XMDATE,1:$E(XMDATE,1,7)))
"RTN","XMXUTIL2",170,0)
 N XMFM
"RTN","XMXUTIL2",171,0)
 S XMFM=$$CONVERT^XMXUTIL1(XMDATE,XMTIME)
"RTN","XMXUTIL2",172,0)
 I XMFM=-1 Q XMDATE
"RTN","XMXUTIL2",173,0)
 Q $$MMDT^XMXUTIL1(XMFM)
"RTN","XMXUTIL2",174,0)
ZSUBJ(XMZ) ; What is the message subject?
"RTN","XMXUTIL2",175,0)
 Q $$SUBJ($G(^XMB(3.9,XMZ,0)))
"RTN","XMXUTIL2",176,0)
SUBJ(XMZREC) ; What is the message subject?
"RTN","XMXUTIL2",177,0)
 N XMSUBJ
"RTN","XMXUTIL2",178,0)
 S XMSUBJ=$P(XMZREC,U,1)
"RTN","XMXUTIL2",179,0)
 I XMSUBJ="" Q $$EZBLD^DIALOG(34012) ;* No Subject *
"RTN","XMXUTIL2",180,0)
 I XMSUBJ["~U~" Q $$DECODEUP^XMXUTIL1(XMSUBJ)
"RTN","XMXUTIL2",181,0)
 Q XMSUBJ
"RTN","XMXUTIL2",182,0)
ZFROM(XMZ) ; Who sent the message?
"RTN","XMXUTIL2",183,0)
 Q $$FROM($G(^XMB(3.9,XMZ,0)))
"RTN","XMXUTIL2",184,0)
FROM(XMZREC) ; Who sent the message?
"RTN","XMXUTIL2",185,0)
 Q $$NAME^XMXUTIL($P(XMZREC,U,2))
"RTN","XMXUTIL2",186,0)
ZPRI(XMZ) ; Is the message priority?
"RTN","XMXUTIL2",187,0)
 Q $$PRI($G(^XMB(3.9,XMZ,0)))
"RTN","XMXUTIL2",188,0)
PRI(XMZREC) ; Is the message priority?
"RTN","XMXUTIL2",189,0)
 Q $P(XMZREC,U,7)["P"
"RTN","XMXUTIL2",190,0)
LINE(XMZ) ; How many lines does the message have?
"RTN","XMXUTIL2",191,0)
 Q +$P($G(^XMB(3.9,XMZ,2,0)),U,4)
"RTN","XMXUTIL2",192,0)
RESP(XMZ) ; How many responses does this message have?
"RTN","XMXUTIL2",193,0)
 Q +$P($G(^XMB(3.9,XMZ,3,0)),U,4)
"RTN","XMXUTIL2",194,0)
ZREAD(XMDUZ,XMZ) ; How many responses has the user read?
"RTN","XMXUTIL2",195,0)
 ; null   = the user has not read the message
"RTN","XMXUTIL2",196,0)
 ; 0      = the user has read the original message only
"RTN","XMXUTIL2",197,0)
 ; number = the user has read through this response
"RTN","XMXUTIL2",198,0)
 N XMUPTR
"RTN","XMXUTIL2",199,0)
 ;S XMUPTR=$O(^XMB(3.9,XMZ,1,"C",$S(XMDUZ=.6:DUZ,1:XMDUZ),0))
"RTN","XMXUTIL2",200,0)
 S XMUPTR=+$O(^XMB(3.9,XMZ,1,"C",XMDUZ,0))
"RTN","XMXUTIL2",201,0)
 ;Q:'XMUPTR ""
"RTN","XMXUTIL2",202,0)
 Q $$READ($G(^XMB(3.9,XMZ,1,XMUPTR,0)))
"RTN","XMXUTIL2",203,0)
READ(XMZUREC) ; How many responses has the user read?
"RTN","XMXUTIL2",204,0)
 ; null   = the user has not read the message
"RTN","XMXUTIL2",205,0)
 ; 0      = the user has read the original message only
"RTN","XMXUTIL2",206,0)
 ; number = the user has read through this response
"RTN","XMXUTIL2",207,0)
 Q $P(XMZUREC,U,2)
"RTN","XMXUTIL2",208,0)
BSKT(XMDUZ,XMZ,XMNAME) ; Which basket is the message in for this user?
"RTN","XMXUTIL2",209,0)
 ; in:
"RTN","XMXUTIL2",210,0)
 ; XMDUZ,XMZ
"RTN","XMXUTIL2",211,0)
 ; XMNAME Return basket name as second piece? 0=no (default); 1=yes
"RTN","XMXUTIL2",212,0)
 ; returns:
"RTN","XMXUTIL2",213,0)
 ; 0           = it's not in any basket
"RTN","XMXUTIL2",214,0)
 ; number      = it's in this basket ien      ($G(XMNAME)=0)
"RTN","XMXUTIL2",215,0)
 ; number^name = it's in this basket ien^name (XMNAME=1)
"RTN","XMXUTIL2",216,0)
 N XMK
"RTN","XMXUTIL2",217,0)
 S XMK=+$O(^XMB(3.7,"M",XMZ,XMDUZ,""))
"RTN","XMXUTIL2",218,0)
 I 'XMK Q XMK
"RTN","XMXUTIL2",219,0)
 I '$G(XMNAME) Q XMK
"RTN","XMXUTIL2",220,0)
 Q XMK_U_$P($G(^XMB(3.7,XMDUZ,2,XMK,0)),U,1)
"RTN","XMXUTIL2",221,0)
NEW(XMDUZ,XMK,XMZ) ; Is the message new for this user?
"RTN","XMXUTIL2",222,0)
 ; 0 = no; 1 = yes; 2 = yes, and it's priority, too.
"RTN","XMXUTIL2",223,0)
 Q:$D(^XMB(3.7,XMDUZ,"N",XMK,XMZ)) 2
"RTN","XMXUTIL2",224,0)
 Q:$D(^XMB(3.7,XMDUZ,"N0",XMK,XMZ)) 1
"RTN","XMXUTIL2",225,0)
 Q 0
"RTN","XMXUTIL2",226,0)
KSEQN(XMDUZ,XMK,XMZ) ; What's the seqence number for this message in this user's basket?
"RTN","XMXUTIL2",227,0)
 Q $$SEQN($G(^XMB(3.7,XMDUZ,2,XMK,1,XMZ,0)))
"RTN","XMXUTIL2",228,0)
SEQN(XMKZREC) ; What's the seqence number for this message in this user's basket?
"RTN","XMXUTIL2",229,0)
 Q $P(XMKZREC,U,2)
"RTN","XMXUTIL3")
0^383^B23095450
"RTN","XMXUTIL3",1,0)
XMXUTIL3 ;ISC-SF/GMB-List addressees, recipients, message network header ;03/05/2001  15:23
"RTN","XMXUTIL3",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMXUTIL3",3,0)
 ; All entry points covered by DBIA 2737.
"RTN","XMXUTIL3",4,0)
 ; Common Parameters for Q, QD, QL, QN, QX:
"RTN","XMXUTIL3",5,0)
 ; XMZ     message number in message file
"RTN","XMXUTIL3",6,0)
 ; XMAMT   How many?
"RTN","XMXUTIL3",7,0)
 ;         =number - Get this many
"RTN","XMXUTIL3",8,0)
 ;         =*      - Get all (default)
"RTN","XMXUTIL3",9,0)
 ; XMSTART("IEN") is used to start the lister going.  The lister will
"RTN","XMXUTIL3",10,0)
 ;         keep it updated from call to call.
"RTN","XMXUTIL3",11,0)
 ;         It is the IEN to start AFTER.
"RTN","XMXUTIL3",12,0)
 ;         (Default is to start at the beginning: after 0.)
"RTN","XMXUTIL3",13,0)
 ; XMTROOT is the target root to receive the message list.
"RTN","XMXUTIL3",14,0)
 ;         (default is ^TMP("XMLIST",$J))
"RTN","XMXUTIL3",15,0)
 ; XMFLAGS are used to control processing (currently not used, except QX)
"RTN","XMXUTIL3",16,0)
 ; XMFIND  Search for recipients/addressees matching this string.
"RTN","XMXUTIL3",17,0)
 ;         Same rules as for FileMan lookups.
"RTN","XMXUTIL3",18,0)
 ;         (If XMFIND is supplied, XMSTART and XMAMT are ignored, and
"RTN","XMXUTIL3",19,0)
 ;          a complete list is returned.)
"RTN","XMXUTIL3",20,0)
 ;
"RTN","XMXUTIL3",21,0)
Q(XMZ,XMFLAGS,XMAMT,XMSTART,XMFIND,XMTROOT) ; Addressee listing
"RTN","XMXUTIL3",22,0)
 N XMCNT,XMIEN,XMREC
"RTN","XMXUTIL3",23,0)
 D QINIT(.XMFLAGS,.XMAMT,.XMFIND,.XMTROOT)
"RTN","XMXUTIL3",24,0)
 I $D(XMFIND) D
"RTN","XMXUTIL3",25,0)
 . D FIND^DIC(3.911,","_XMZ_",","","",XMFIND,"","B")
"RTN","XMXUTIL3",26,0)
 E  D
"RTN","XMXUTIL3",27,0)
 . D LIST^DIC(3.911,","_XMZ_",","","",XMAMT,.XMSTART,"","B")
"RTN","XMXUTIL3",28,0)
 S XMCNT=0
"RTN","XMXUTIL3",29,0)
 F  S XMCNT=$O(^TMP("DILIST",$J,2,XMCNT)) Q:XMCNT=""  S XMIEN=^(XMCNT) D
"RTN","XMXUTIL3",30,0)
 . S XMREC=$G(^XMB(3.9,XMZ,6,XMIEN,0))
"RTN","XMXUTIL3",31,0)
 . S @(XMTROOT_XMCNT_",""TO NAME"")")=$P(XMREC,U,1)
"RTN","XMXUTIL3",32,0)
 . I $P(XMREC,U,2)'="" S @(XMTROOT_XMCNT_",""TYPE"")")=$P(XMREC,U,2)
"RTN","XMXUTIL3",33,0)
 S @(XMTROOT_"0)")=^TMP("DILIST",$J,0)
"RTN","XMXUTIL3",34,0)
 K ^TMP("DILIST",$J)
"RTN","XMXUTIL3",35,0)
 Q
"RTN","XMXUTIL3",36,0)
QD(XMZ,XMFLAGS,XMAMT,XMSTART,XMFIND,XMTROOT) ; Recipient listing
"RTN","XMXUTIL3",37,0)
 D QINIT(.XMFLAGS,.XMAMT,.XMFIND,.XMTROOT)
"RTN","XMXUTIL3",38,0)
 I $D(XMFIND) D
"RTN","XMXUTIL3",39,0)
 . N XMCNT
"RTN","XMXUTIL3",40,0)
 . D QFIND^XMXUTIL4(XMZ,XMFLAGS,XMFIND,XMTROOT,.XMCNT)
"RTN","XMXUTIL3",41,0)
 . S @(XMTROOT_"0)")=XMCNT_U_"*^0"
"RTN","XMXUTIL3",42,0)
 . K ^TMP("DILIST",$J)
"RTN","XMXUTIL3",43,0)
 E  D
"RTN","XMXUTIL3",44,0)
 . D QLIST^XMXUTIL4(XMZ,XMFLAGS,XMAMT,.XMSTART,XMTROOT)
"RTN","XMXUTIL3",45,0)
 Q
"RTN","XMXUTIL3",46,0)
QL(XMZ,XMFLAGS,XMAMT,XMSTART,XMFIND,XMTROOT) ; Later'd Addressee listing
"RTN","XMXUTIL3",47,0)
 N XMCNT,XMIEN,XMREC
"RTN","XMXUTIL3",48,0)
 D QINIT(.XMFLAGS,.XMAMT,.XMFIND,.XMTROOT)
"RTN","XMXUTIL3",49,0)
 I $D(XMFIND) D
"RTN","XMXUTIL3",50,0)
 . D FIND^DIC(3.914,","_XMZ_",","","",XMFIND,"","B")
"RTN","XMXUTIL3",51,0)
 E  D
"RTN","XMXUTIL3",52,0)
 . D LIST^DIC(3.914,","_XMZ_",","","",XMAMT,.XMSTART,"","B")
"RTN","XMXUTIL3",53,0)
 S XMCNT=0
"RTN","XMXUTIL3",54,0)
 F  S XMCNT=$O(^TMP("DILIST",$J,2,XMCNT)) Q:XMCNT=""  S XMIEN=^(XMCNT) D
"RTN","XMXUTIL3",55,0)
 . S XMREC=$G(^XMB(3.9,XMZ,7,XMIEN,0))
"RTN","XMXUTIL3",56,0)
 . S @(XMTROOT_XMCNT_",""TO NAME"")")=$P(XMREC,U,1)
"RTN","XMXUTIL3",57,0)
 . I $P(XMREC,U,2)'="" S @(XMTROOT_XMCNT_",""TYPE"")")=$P(XMREC,U,2)
"RTN","XMXUTIL3",58,0)
 . S @(XMTROOT_XMCNT_",""BY DUZ"")")=$P(XMREC,U,3)
"RTN","XMXUTIL3",59,0)
 . S @(XMTROOT_XMCNT_",""BY NAME"")")=$P(XMREC,U,4)
"RTN","XMXUTIL3",60,0)
 . S @(XMTROOT_XMCNT_",""WHEN"")")=$P(XMREC,U,5)
"RTN","XMXUTIL3",61,0)
 . S @(XMTROOT_XMCNT_",""WHEN MM"")")=$$MMDT^XMXUTIL1($P(XMREC,U,5))
"RTN","XMXUTIL3",62,0)
 S @(XMTROOT_"0)")=^TMP("DILIST",$J,0)
"RTN","XMXUTIL3",63,0)
 K ^TMP("DILIST",$J)
"RTN","XMXUTIL3",64,0)
 Q
"RTN","XMXUTIL3",65,0)
QINIT(XMFLAGS,XMAMT,XMFIND,XMTROOT) ; For internal MailMan use only.
"RTN","XMXUTIL3",66,0)
 S XMFLAGS=$G(XMFLAGS)
"RTN","XMXUTIL3",67,0)
 I $G(XMAMT)="" S XMAMT="*"
"RTN","XMXUTIL3",68,0)
 I $D(XMFIND),XMFIND="" K XMFIND
"RTN","XMXUTIL3",69,0)
 I $D(XMTROOT),XMTROOT'="" D
"RTN","XMXUTIL3",70,0)
 . K @$$CREF^DILF(XMTROOT)
"RTN","XMXUTIL3",71,0)
 . S XMTROOT=$$OREF^DILF(XMTROOT)_"""XMLIST"","
"RTN","XMXUTIL3",72,0)
 E  D
"RTN","XMXUTIL3",73,0)
 . K ^TMP("XMLIST",$J)
"RTN","XMXUTIL3",74,0)
 . S XMTROOT="^TMP(""XMLIST"",$J,"
"RTN","XMXUTIL3",75,0)
 Q
"RTN","XMXUTIL3",76,0)
QN(XMZ,XMFLAGS,XMAMT,XMSTART,XMTROOT) ; Get network header lines
"RTN","XMXUTIL3",77,0)
 N XMCNT,XMIEN
"RTN","XMXUTIL3",78,0)
 D QNINIT(.XMAMT,.XMTROOT)
"RTN","XMXUTIL3",79,0)
 S XMCNT=0
"RTN","XMXUTIL3",80,0)
 S XMIEN=+$G(XMSTART("IEN"))
"RTN","XMXUTIL3",81,0)
 F  S XMIEN=$O(^XMB(3.9,XMZ,2,XMIEN)) Q:XMIEN'<1  D  Q:XMCNT=XMAMT
"RTN","XMXUTIL3",82,0)
 . S XMCNT=XMCNT+1
"RTN","XMXUTIL3",83,0)
 . S @(XMTROOT_XMCNT_")")=^XMB(3.9,XMZ,2,XMIEN,0)
"RTN","XMXUTIL3",84,0)
 S XMSTART("IEN")=XMIEN
"RTN","XMXUTIL3",85,0)
 S @(XMTROOT_"0)")=XMCNT_U_XMAMT_U_$S(XMIEN'<1:0,$O(^XMB(3.9,XMZ,2,XMIEN))<1:1,1:0) ; Any more?
"RTN","XMXUTIL3",86,0)
 Q
"RTN","XMXUTIL3",87,0)
QNINIT(XMAMT,XMTROOT) ; For internal MailMan use only.
"RTN","XMXUTIL3",88,0)
 I $G(XMAMT)="" S XMAMT="*"
"RTN","XMXUTIL3",89,0)
 I $D(XMTROOT),XMTROOT'="" D
"RTN","XMXUTIL3",90,0)
 . K @$$CREF^DILF(XMTROOT)
"RTN","XMXUTIL3",91,0)
 . S XMTROOT=$$OREF^DILF(XMTROOT)_"""XMLIST"","
"RTN","XMXUTIL3",92,0)
 E  D
"RTN","XMXUTIL3",93,0)
 . K ^TMP("XMLIST",$J)
"RTN","XMXUTIL3",94,0)
 . S XMTROOT="^TMP(""XMLIST"",$J,"
"RTN","XMXUTIL3",95,0)
 Q
"RTN","XMXUTIL3",96,0)
QX(XMZ,XMFLAGS,XMAMT,XMSTART,XMTROOT) ; Local Recipient Xtract
"RTN","XMXUTIL3",97,0)
 ; XMFLAGS = "C" list users who are current in reading the message
"RTN","XMXUTIL3",98,0)
 ;           "N" list users who are NOT current in reading the message
"RTN","XMXUTIL3",99,0)
 ;           "T" list users who have terminated the message
"RTN","XMXUTIL3",100,0)
 N XMFIND,XMCNT,XMIEN,XMREC,XMTO,XMNAME,XMRESPS,XMMORE
"RTN","XMXUTIL3",101,0)
 I $L($G(XMFLAGS))'=1,"CNT"'[XMFLAGS Q
"RTN","XMXUTIL3",102,0)
 D QINIT(.XMFLAGS,.XMAMT,.XMFIND,.XMTROOT)
"RTN","XMXUTIL3",103,0)
 S XMRESPS=+$P($G(^XMB(3.9,XMZ,3,0)),U,4)
"RTN","XMXUTIL3",104,0)
 S XMCNT=0,XMTO=+$G(XMSTART("IEN"))
"RTN","XMXUTIL3",105,0)
 F  S XMTO=$O(^XMB(3.9,XMZ,1,"C",XMTO)) Q:+XMTO'='XMTO  D  Q:XMCNT=XMAMT
"RTN","XMXUTIL3",106,0)
 . S XMIEN=$O(^XMB(3.9,XMZ,1,"C",XMTO)) Q:'XMIEN
"RTN","XMXUTIL3",107,0)
 . S XMREC=$G(^XMB(3.9,XMZ,1,XMIEN,0))
"RTN","XMXUTIL3",108,0)
 . I XMFLAGS="C",$P(XMREC,U,2)'=XMRESPS Q  ; not current
"RTN","XMXUTIL3",109,0)
 . I XMFLAGS="N",$P(XMREC,U,2)=XMRESPS Q  ; current
"RTN","XMXUTIL3",110,0)
 . I XMFLAGS="T",'$G(^XMB(3.9,XMZ,1,XMIEN,"D")) Q  ; not terminated
"RTN","XMXUTIL3",111,0)
 . S XMCNT=XMCNT+1
"RTN","XMXUTIL3",112,0)
 . S XMNAME=$$NAME^XMXUTIL(XMTO)
"RTN","XMXUTIL3",113,0)
 . D QDFLDS^XMXUTIL4(XMZ,XMFLAGS,XMIEN,XMREC,XMNAME,XMTROOT,XMCNT)
"RTN","XMXUTIL3",114,0)
 S XMSTART("IEN")=XMTO
"RTN","XMXUTIL3",115,0)
 I XMAMT'="*" D
"RTN","XMXUTIL3",116,0)
 . S XMMORE=0 ; any more?
"RTN","XMXUTIL3",117,0)
 . F  S XMTO=$O(^XMB(3.9,XMZ,1,"C",XMTO)) Q:+XMTO'='XMTO  D  Q:XMMORE
"RTN","XMXUTIL3",118,0)
 . . S XMIEN=$O(^XMB(3.9,XMZ,1,"C",XMTO)) Q:'XMIEN
"RTN","XMXUTIL3",119,0)
 . . S XMREC=$G(^XMB(3.9,XMZ,1,XMIEN,0))
"RTN","XMXUTIL3",120,0)
 . . I XMFLAGS="C",$P(XMREC,U,2)'=XMRESPS Q  ; not current
"RTN","XMXUTIL3",121,0)
 . . I XMFLAGS="N",$P(XMREC,U,2)=XMRESPS Q  ; current
"RTN","XMXUTIL3",122,0)
 . . I XMFLAGS="T",'$G(^XMB(3.9,XMZ,1,XMIEN,"D")) Q  ; not terminated
"RTN","XMXUTIL3",123,0)
 . . S XMMORE=1
"RTN","XMXUTIL3",124,0)
 S @(XMTROOT_"0)")=XMCNT_U_XMAMT_U_$S(XMAMT="*":0,1:XMMORE)
"RTN","XMXUTIL3",125,0)
 Q
"RTN","XMXUTIL4")
0^229^B32435147
"RTN","XMXUTIL4",1,0)
XMXUTIL4 ;ISC-SF/GMB-List message recipients (cont.) ;04/11/2002  10:44
"RTN","XMXUTIL4",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMXUTIL4",3,0)
 ; All entry points are for internal MailMan use only.
"RTN","XMXUTIL4",4,0)
QLIST(XMZ,XMFLAGS,XMAMT,XMSTART,XMTROOT) ; list them
"RTN","XMXUTIL4",5,0)
 N XMCNT,XMIEN,XMREC,XMTO,XMNAME
"RTN","XMXUTIL4",6,0)
 S XMCNT=0,XMIEN=+$G(XMSTART("IEN"))
"RTN","XMXUTIL4",7,0)
 F  S XMIEN=$O(^XMB(3.9,XMZ,1,XMIEN)) Q:'XMIEN  D  Q:XMCNT=XMAMT
"RTN","XMXUTIL4",8,0)
 . S XMCNT=XMCNT+1
"RTN","XMXUTIL4",9,0)
 . S XMREC=$G(^XMB(3.9,XMZ,1,XMIEN,0))
"RTN","XMXUTIL4",10,0)
 . S XMTO=$P(XMREC,U,1)
"RTN","XMXUTIL4",11,0)
 . S XMNAME=$$NAME^XMXUTIL(XMTO)
"RTN","XMXUTIL4",12,0)
 . D QDFLDS(XMZ,XMFLAGS,XMIEN,XMREC,XMNAME,XMTROOT,XMCNT)
"RTN","XMXUTIL4",13,0)
 S XMSTART("IEN")=XMIEN
"RTN","XMXUTIL4",14,0)
 S @(XMTROOT_"0)")=XMCNT_U_XMAMT_U_$S(XMAMT="*":0,1:$O(^XMB(3.9,XMZ,1,XMIEN))>0)
"RTN","XMXUTIL4",15,0)
 Q
"RTN","XMXUTIL4",16,0)
QDFLDS(XMZ,XMFLAGS,XMIEN,XMREC,XMNAME,XMTROOT,XMCNT) ;
"RTN","XMXUTIL4",17,0)
 S @(XMTROOT_XMCNT_",""TO"")")=$P(XMREC,U,1)
"RTN","XMXUTIL4",18,0)
 S @(XMTROOT_XMCNT_",""TO NAME"")")=XMNAME
"RTN","XMXUTIL4",19,0)
 I $D(^XMB(3.9,XMZ,1,XMIEN,"T")) S @(XMTROOT_XMCNT_",""TYPE"")")=$P(^("T"),U,1)
"RTN","XMXUTIL4",20,0)
 I $D(^XMB(3.9,XMZ,1,XMIEN,"F")) D FWD(XMZ,XMIEN)
"RTN","XMXUTIL4",21,0)
 I $P(XMREC,U,1)?.N D  Q
"RTN","XMXUTIL4",22,0)
 . S @(XMTROOT_XMCNT_",""TO ID"")")="L" ; local user
"RTN","XMXUTIL4",23,0)
 . S @(XMTROOT_XMCNT_",""TO DUZ"")")=$P(XMREC,U,1)
"RTN","XMXUTIL4",24,0)
 . I $P(XMREC,U,2)'="" D
"RTN","XMXUTIL4",25,0)
 . . S @(XMTROOT_XMCNT_",""RESP"")")=$P(XMREC,U,2)
"RTN","XMXUTIL4",26,0)
 . I $P(XMREC,U,3)'="" D
"RTN","XMXUTIL4",27,0)
 . . S @(XMTROOT_XMCNT_",""LREAD"")")=$P(XMREC,U,3)
"RTN","XMXUTIL4",28,0)
 . . S @(XMTROOT_XMCNT_",""LREAD MM"")")=$$MMDT^XMXUTIL1($P(XMREC,U,3))
"RTN","XMXUTIL4",29,0)
 . I $P(XMREC,U,10)'="" D
"RTN","XMXUTIL4",30,0)
 . . S @(XMTROOT_XMCNT_",""FREAD"")")=$P(XMREC,U,10)
"RTN","XMXUTIL4",31,0)
 . . S @(XMTROOT_XMCNT_",""FREAD MM"")")=$$MMDT^XMXUTIL1($P(XMREC,U,10))
"RTN","XMXUTIL4",32,0)
 . I $D(^XMB(3.9,XMZ,1,XMIEN,"C")) D
"RTN","XMXUTIL4",33,0)
 . . N XMD
"RTN","XMXUTIL4",34,0)
 . . S XMD=^XMB(3.9,XMZ,1,XMIEN,"C")
"RTN","XMXUTIL4",35,0)
 . . S @(XMTROOT_XMCNT_",""COPY"")")=XMD
"RTN","XMXUTIL4",36,0)
 . . S @(XMTROOT_XMCNT_",""COPY MM"")")=$$MMDT^XMXUTIL1(XMD)
"RTN","XMXUTIL4",37,0)
 . I $D(^XMB(3.9,XMZ,1,XMIEN,"D")),$G(^("D")) D
"RTN","XMXUTIL4",38,0)
 . . N XMD
"RTN","XMXUTIL4",39,0)
 . . S XMD=^XMB(3.9,XMZ,1,XMIEN,"D")
"RTN","XMXUTIL4",40,0)
 . . S @(XMTROOT_XMCNT_",""TERM"")")=XMD
"RTN","XMXUTIL4",41,0)
 . . S @(XMTROOT_XMCNT_",""TERM MM"")")=$$MMDT^XMXUTIL1(XMD)
"RTN","XMXUTIL4",42,0)
 . I $D(^XMB(3.9,XMZ,1,XMIEN,"S")) D
"RTN","XMXUTIL4",43,0)
 . . S @(XMTROOT_XMCNT_",""SURR"")")=^XMB(3.9,XMZ,1,XMIEN,"S")
"RTN","XMXUTIL4",44,0)
 I $E(XMNAME,1,2)="F.",$P(XMREC,U,12)'=""!$P(XMREC,U,11) D  Q
"RTN","XMXUTIL4",45,0)
 . S @(XMTROOT_XMCNT_",""TO ID"")")="F" ; fax
"RTN","XMXUTIL4",46,0)
 . I $P(XMREC,U,5)'="" D
"RTN","XMXUTIL4",47,0)
 . . S @(XMTROOT_XMCNT_",""FDATE"")")=$P(XMREC,U,5)
"RTN","XMXUTIL4",48,0)
 . . S @(XMTROOT_XMCNT_",""FDATE MM"")")=$$MMDT^XMXUTIL1($P(XMREC,U,5))
"RTN","XMXUTIL4",49,0)
 . I $P(XMREC,U,6)'="" D
"RTN","XMXUTIL4",50,0)
 . . S @(XMTROOT_XMCNT_",""STATUS"")")=$P(XMREC,U,6)
"RTN","XMXUTIL4",51,0)
 . I $P(XMREC,U,11)'="" D
"RTN","XMXUTIL4",52,0)
 . . S @(XMTROOT_XMCNT_",""FAX IEN"")")=$P(XMREC,U,11)
"RTN","XMXUTIL4",53,0)
 . I $P(XMREC,U,12)'="" D
"RTN","XMXUTIL4",54,0)
 . . S @(XMTROOT_XMCNT_",""ID"")")=$P(XMREC,U,12)
"RTN","XMXUTIL4",55,0)
 I XMNAME["@" D  Q
"RTN","XMXUTIL4",56,0)
 . S @(XMTROOT_XMCNT_",""TO ID"")")="R" ; remote
"RTN","XMXUTIL4",57,0)
 . I $P(XMREC,U,4)'="" D
"RTN","XMXUTIL4",58,0)
 . . S @(XMTROOT_XMCNT_",""ID"")")=$P(XMREC,U,4)
"RTN","XMXUTIL4",59,0)
 . I $P(XMREC,U,5)'="" D
"RTN","XMXUTIL4",60,0)
 . . S @(XMTROOT_XMCNT_",""XDATE"")")=$P(XMREC,U,5)
"RTN","XMXUTIL4",61,0)
 . . S @(XMTROOT_XMCNT_",""XDATE MM"")")=$$MMDT^XMXUTIL1($P(XMREC,U,5))
"RTN","XMXUTIL4",62,0)
 . I $P(XMREC,U,6)'="" D
"RTN","XMXUTIL4",63,0)
 . . S @(XMTROOT_XMCNT_",""STATUS"")")=$P(XMREC,U,6)
"RTN","XMXUTIL4",64,0)
 . I $P(XMREC,U,7)'="",$D(^DIC(4.2,$P(XMREC,U,7),0)) D
"RTN","XMXUTIL4",65,0)
 . . S @(XMTROOT_XMCNT_",""PATH"")")=$P(XMREC,U,7)
"RTN","XMXUTIL4",66,0)
 . . S @(XMTROOT_XMCNT_",""PATH NAME"")")=$P(^DIC(4.2,$P(XMREC,U,7),0),U)
"RTN","XMXUTIL4",67,0)
 . I $P(XMREC,U,8)'="" D
"RTN","XMXUTIL4",68,0)
 . . S @(XMTROOT_XMCNT_",""SECS"")")=$P(XMREC,U,8)
"RTN","XMXUTIL4",69,0)
 I $E(XMNAME,1,3)="* (" D  Q
"RTN","XMXUTIL4",70,0)
 . S @(XMTROOT_XMCNT_",""TO ID"")")=$E(XMNAME) ; broadcast
"RTN","XMXUTIL4",71,0)
 ; I ".D.H.S."[("."_$E(XMNAME,1,2))
"RTN","XMXUTIL4",72,0)
 S @(XMTROOT_XMCNT_",""TO ID"")")=$E(XMNAME) ; device or server
"RTN","XMXUTIL4",73,0)
 I $P(XMREC,U,3)'="" D
"RTN","XMXUTIL4",74,0)
 . S @(XMTROOT_XMCNT_",""SDATE"")")=$P(XMREC,U,3)
"RTN","XMXUTIL4",75,0)
 . S @(XMTROOT_XMCNT_",""SDATE MM"")")=$$MMDT^XMXUTIL1($P(XMREC,U,3))
"RTN","XMXUTIL4",76,0)
 I $P(XMREC,U,6)'="" D
"RTN","XMXUTIL4",77,0)
 . S @(XMTROOT_XMCNT_",""STATUS"")")=$P(XMREC,U,6)
"RTN","XMXUTIL4",78,0)
 Q
"RTN","XMXUTIL4",79,0)
FWD(XMZ,XMIEN) ;
"RTN","XMXUTIL4",80,0)
 Q:'$D(^XMB(3.9,XMZ,1,XMIEN,"F"))
"RTN","XMXUTIL4",81,0)
 N XMFWDREC,XMFWDBY
"RTN","XMXUTIL4",82,0)
 S XMFWDREC=^XMB(3.9,XMZ,1,XMIEN,"F")
"RTN","XMXUTIL4",83,0)
 S XMFWDBY=$P(XMFWDREC,U)
"RTN","XMXUTIL4",84,0)
 I $E(XMFWDBY)?1A!($E(XMFWDBY)="<") D
"RTN","XMXUTIL4",85,0)
 . N XMLEN
"RTN","XMXUTIL4",86,0)
 . S XMLEN=$L(XMFWDBY," ")
"RTN","XMXUTIL4",87,0)
 . S @(XMTROOT_XMCNT_",""FWD BY"")")=$P(XMFWDBY," ",1,XMLEN-4)
"RTN","XMXUTIL4",88,0)
 . S @(XMTROOT_XMCNT_",""FWD ON"")")=$P(XMFWDBY," ",XMLEN-3,XMLEN)
"RTN","XMXUTIL4",89,0)
 E  I $E(XMFWDBY)?1N!($E(XMFWDBY)=".") D
"RTN","XMXUTIL4",90,0)
 . N XMLEN
"RTN","XMXUTIL4",91,0)
 . S XMFWDBY=$$NAME^XMXUTIL(+XMFWDBY)_" "_$P(XMFWDBY," ",2,99)
"RTN","XMXUTIL4",92,0)
 . S XMLEN=$L(XMFWDBY," ")
"RTN","XMXUTIL4",93,0)
 . S @(XMTROOT_XMCNT_",""FWD BY"")")=$P(XMFWDBY," ",1,XMLEN-4)
"RTN","XMXUTIL4",94,0)
 . S @(XMTROOT_XMCNT_",""FWD ON"")")=$P(XMFWDBY," ",XMLEN-3,XMLEN)
"RTN","XMXUTIL4",95,0)
 E  S @(XMTROOT_XMCNT_",""FWD ON"")")=$E(XMFWDBY,2,99)
"RTN","XMXUTIL4",96,0)
 I $P(XMFWDREC,U,2) S @(XMTROOT_XMCNT_",""FWD BY DUZ"")")=$P(XMFWDREC,U,2)
"RTN","XMXUTIL4",97,0)
 I "R"'[$P(XMFWDREC,U,3) S @(XMTROOT_XMCNT_",""FWD TYPE"")")=$P(XMFWDREC,U,3)
"RTN","XMXUTIL4",98,0)
 Q:$P(XMFWDREC,U,4)=""  ; or quit if FWD TYPE="A"
"RTN","XMXUTIL4",99,0)
 S @(XMTROOT_XMCNT_",""FWD BY ORIG"")")=$P(XMFWDREC,U,4)
"RTN","XMXUTIL4",100,0)
 I "R"'[$P(XMFWDREC,U,5) S @(XMTROOT_XMCNT_",""FWD TYPE ORIG"")")=$P(XMFWDREC,U,5)
"RTN","XMXUTIL4",101,0)
 Q
"RTN","XMXUTIL4",102,0)
QFIND(XMZ,XMFLAGS,XMFIND,XMTROOT,XMCNT) ; find them
"RTN","XMXUTIL4",103,0)
 S XMCNT=0
"RTN","XMXUTIL4",104,0)
 D FIND^DIC(200,"","","A",XMFIND,"","B^BB^C^D","I $D(^XMB(3.9,XMZ,1,""C"",+Y))")
"RTN","XMXUTIL4",105,0)
 I '$D(DIERR) D MOVE(200,XMZ,XMFLAGS,XMTROOT,.XMCNT)
"RTN","XMXUTIL4",106,0)
 Q:$O(^XMB(3.9,XMZ,1,"C",":"))=""  ; Quit if there aren't any non-local addressees
"RTN","XMXUTIL4",107,0)
 N XMSCREEN
"RTN","XMXUTIL4",108,0)
 S XMSCREEN=$S(+XMFIND=XMFIND:"I '$D(^XMB(3.9,XMZ,1,""C"",XMFIND))",1:"")
"RTN","XMXUTIL4",109,0)
 D FIND^DIC(3.91,","_XMZ_",","","C",XMFIND,"","C",XMSCREEN)
"RTN","XMXUTIL4",110,0)
 I '$D(DIERR) D MOVE(3.91,XMZ,XMFLAGS,XMTROOT,.XMCNT)
"RTN","XMXUTIL4",111,0)
 Q:$E(XMFIND)'?1U  ; Quit if the search string does not begin with an upper case letter
"RTN","XMXUTIL4",112,0)
 Q:$O(^XMB(3.9,XMZ,1,"C","`"))=""  ; Quit if there aren't any lower case addressees
"RTN","XMXUTIL4",113,0)
 ; FM will translate lower case to upper case in its search, but won't
"RTN","XMXUTIL4",114,0)
 ; translate upper to lower, so we do it here.
"RTN","XMXUTIL4",115,0)
 S XMSCREEN="I ^(0)]""`""" ; Limit search to lower case addresses
"RTN","XMXUTIL4",116,0)
 D FIND^DIC(3.91,","_XMZ_",","","C",$$LOW^XLFSTR(XMFIND),"","C",XMSCREEN)
"RTN","XMXUTIL4",117,0)
 I '$D(DIERR) D MOVE(3.91,XMZ,XMFLAGS,XMTROOT,.XMCNT)
"RTN","XMXUTIL4",118,0)
 Q
"RTN","XMXUTIL4",119,0)
MOVE(XMFILE,XMZ,XMFLAGS,XMTROOT,XMCNT) ; move search results
"RTN","XMXUTIL4",120,0)
 N I,XMIEN,XMREC,XMNAME
"RTN","XMXUTIL4",121,0)
 S I=0
"RTN","XMXUTIL4",122,0)
 F  S I=$O(^TMP("DILIST",$J,1,I)) Q:I=""  D
"RTN","XMXUTIL4",123,0)
 . S XMIEN=^TMP("DILIST",$J,2,I)
"RTN","XMXUTIL4",124,0)
 . I XMFILE=200 D
"RTN","XMXUTIL4",125,0)
 . . S XMIEN=$O(^XMB(3.9,XMZ,1,"C",XMIEN,0))
"RTN","XMXUTIL4",126,0)
 . . S XMREC=$G(^XMB(3.9,XMZ,1,XMIEN,0))
"RTN","XMXUTIL4",127,0)
 . . S XMNAME=^TMP("DILIST",$J,1,I)
"RTN","XMXUTIL4",128,0)
 . E  D
"RTN","XMXUTIL4",129,0)
 . . S XMREC=$G(^XMB(3.9,XMZ,1,XMIEN,0))
"RTN","XMXUTIL4",130,0)
 . . S XMNAME=$P(XMREC,U,1)
"RTN","XMXUTIL4",131,0)
 . S XMCNT=XMCNT+1
"RTN","XMXUTIL4",132,0)
 . D QDFLDS(XMZ,XMFLAGS,XMIEN,XMREC,XMNAME,XMTROOT,XMCNT)
"RTN","XMXUTIL4",133,0)
 Q
"RTN","XMYMNEM")
1^210
"RTN","XMYMNEM0")
1^211
"RTN","XMYMNEM1")
1^212
"RTN","XMYMNEM2")
1^213
"RTN","XMYPDOM")
1^214
"RTN","XMYPDOM1")
1^215
"RTN","XMYPOSD")
1^180
"RTN","XMYPOST")
1^181
"RTN","XMYPOST0")
1^182
"RTN","XMYPOST1")
1^183
"RTN","XMYPOST2")
1^184
"RTN","XMYPOST3")
1^185
"RTN","XMYPOST4")
1^186
"RTN","XMYPOST5")
1^187
"RTN","XMYPOST6")
1^188
"RTN","XMYPOST7")
1^189
"RTN","XMYPOST8")
1^190
"RTN","XMYPOST9")
1^191
"RTN","XMYPOSTA")
1^192
"RTN","XMYPOSTB")
1^193
"RTN","XMYPOSTC")
1^194
"RTN","XMYPOSTD")
1^195
"RTN","XMYPRE")
0^99^B6113778
"RTN","XMYPRE",1,0)
XMYPRE ;ISC-SF/GMB-Pre- & Post- Init ;08/29/2002  09:03
"RTN","XMYPRE",2,0)
 ;;8.0;MailMan;;Jun 28, 2002
"RTN","XMYPRE",3,0)
PRE ; Pre-init
"RTN","XMYPRE",4,0)
 K ^DD(4.21,2,3) ; Kill errant help node.
"RTN","XMYPRE",5,0)
 K ^DD(3.7,2,1,1,1.2) ; Kill obsolete node.
"RTN","XMYPRE",6,0)
 K ^DD(3.811,0,"NM","MEMBER GROUP") ; Kill errant name.
"RTN","XMYPRE",7,0)
 Q:'$D(^DD(3.702,6,1,1,1))  ; Quit if the pre-init has run already
"RTN","XMYPRE",8,0)
 D OPTION
"RTN","XMYPRE",9,0)
 D DELFLDS
"RTN","XMYPRE",10,0)
 D ACXREF
"RTN","XMYPRE",11,0)
 Q
"RTN","XMYPRE",12,0)
OPTION ; Clean up some MailMan options
"RTN","XMYPRE",13,0)
 N XMOPT,XMIEN,XMFDA,XMIENS
"RTN","XMYPRE",14,0)
 F XMOPT="XMQSHOW","XMSUBEDIT","XMDXPROT" D
"RTN","XMYPRE",15,0)
 . S XMIEN=$O(^DIC(19,"B",XMOPT,0)) Q:'XMIEN
"RTN","XMYPRE",16,0)
 . S XMIENS=XMIEN_","
"RTN","XMYPRE",17,0)
 . S XMFDA(19,XMIENS,15)="@" ; EXIT ACTION
"RTN","XMYPRE",18,0)
 . ;S XMFDA(19,XMIENS,20)="@" ; ENTRY ACTION
"RTN","XMYPRE",19,0)
 . D FILE^DIE("","XMFDA")
"RTN","XMYPRE",20,0)
 F XMOPT="XMMGR-IN-BASKET-PURGE" D
"RTN","XMYPRE",21,0)
 . S XMIEN=$O(^DIC(19,"B",XMOPT,0)) Q:'XMIEN
"RTN","XMYPRE",22,0)
 . S XMIENS=XMIEN_","
"RTN","XMYPRE",23,0)
 . S XMFDA(19,XMIENS,3.7)="@" ; HELP FRAME
"RTN","XMYPRE",24,0)
 . D FILE^DIE("","XMFDA")
"RTN","XMYPRE",25,0)
 Q
"RTN","XMYPRE",26,0)
DELFLDS ; Delete fields no longer used.
"RTN","XMYPRE",27,0)
 S DIK="^DD(4.2999,",DA=7,DA(1)=4.2999 D ^DIK ; OUTGOING MESSAGE COUNT
"RTN","XMYPRE",28,0)
 S DIK="^DD(4.2999,",DA=8,DA(1)=4.2999 D ^DIK ; CHARACTERS REC'D
"RTN","XMYPRE",29,0)
 S DIK="^DD(4.2999,",DA=9,DA(1)=4.2999 D ^DIK ; INCOMING MESSAGE COUNT
"RTN","XMYPRE",30,0)
 S DIK="^DD(4.2999,",DA=10,DA(1)=4.2999 D ^DIK ; CHARACTERS SENT
"RTN","XMYPRE",31,0)
 N I
"RTN","XMYPRE",32,0)
 S I=0
"RTN","XMYPRE",33,0)
 F  S I=$O(^XMBS(4.2999,I)) Q:'I  S ^XMBS(4.2999,I,0)=I
"RTN","XMYPRE",34,0)
 Q
"RTN","XMYPRE",35,0)
ACXREF ; Delete old AC xref for NETWORK PRIORITY TRANSMISSION field.
"RTN","XMYPRE",36,0)
 D DELIX^DDMOD(3.702,6,1)  ; delete the DD, leave the data
"RTN","XMYPRE",37,0)
 N XMK,XMZ ; Reposition the xref to match the new definition.
"RTN","XMYPRE",38,0)
 S XMK=0
"RTN","XMYPRE",39,0)
 F  S XMK=$O(^XMB(3.7,.5,2,"AC",1,XMK)) Q:'XMK  D
"RTN","XMYPRE",40,0)
 . S XMZ=0
"RTN","XMYPRE",41,0)
 . F  S XMZ=$O(^XMB(3.7,.5,2,"AC",1,XMK,XMZ)) Q:'XMZ  D
"RTN","XMYPRE",42,0)
 . . K ^XMB(3.7,.5,2,"AC",1,XMK,XMZ)
"RTN","XMYPRE",43,0)
 . . S ^XMB(3.7,.5,2,XMK,1,"AC",1,XMZ)=""
"RTN","XMYPRE",44,0)
 Q
"RTN","XMYPRE",45,0)
POST ; Post-init
"RTN","XMYPRE",46,0)
 D INIT^XMC
"RTN","XMYPRE",47,0)
 D KEYS
"RTN","XMYPRE",48,0)
 D DIALOG
"RTN","XMYPRE",49,0)
 Q
"RTN","XMYPRE",50,0)
KEYS ; Security Keys
"RTN","XMYPRE",51,0)
 ; KIDS does not correctly transport the 'mutually exclusive' field,
"RTN","XMYPRE",52,0)
 ; so we have to correct it.
"RTN","XMYPRE",53,0)
 N XMSTAR,XMSTARL,XMFDA,I
"RTN","XMYPRE",54,0)
 S XMSTAR=$$FIND1^DIC(19.1,"","QX","XMSTAR")
"RTN","XMYPRE",55,0)
 S XMSTARL=$$FIND1^DIC(19.1,"","QX","XMSTAR LIMITED")
"RTN","XMYPRE",56,0)
 S I=$O(^DIC(19.1,XMSTAR,5,0))
"RTN","XMYPRE",57,0)
 S XMFDA(19.15,I_","_XMSTAR_",",.01)=XMSTARL
"RTN","XMYPRE",58,0)
 D FILE^DIE("","XMFDA")
"RTN","XMYPRE",59,0)
 S I=$O(^DIC(19.1,XMSTARL,5,0))
"RTN","XMYPRE",60,0)
 S XMFDA(19.15,I_","_XMSTARL_",",.01)=XMSTAR
"RTN","XMYPRE",61,0)
 D FILE^DIE("","XMFDA")
"RTN","XMYPRE",62,0)
 Q
"RTN","XMYPRE",63,0)
DIALOG ; Delete DIALOG file entries.  KIDS fails to do this.
"RTN","XMYPRE",64,0)
 N DIK,DA
"RTN","XMYPRE",65,0)
 S DIK="^DI(.84,"
"RTN","XMYPRE",66,0)
 F DA=34425,34443,34443.1 D ^DIK
"RTN","XMYPRE",67,0)
 Q
"RTN","XMYPRE1")
1^196
"RTN","XMYPRE10")
1^197
"RTN","XMYPRE11")
1^198
"RTN","XMYPRE2")
1^199
"RTN","XMYPRE2A")
1^200
"RTN","XMYPRE2B")
1^201
"RTN","XMYPRE3")
1^202
"RTN","XMYPRE4")
1^203
"RTN","XMYPRE5")
1^204
"RTN","XMYPRE6")
1^205
"RTN","XMYPRE6A")
1^206
"RTN","XMYPRE7")
1^207
"RTN","XMYPRE8")
1^208
"RTN","XMYPRE9")
1^209
"SEC","^DD",4.2,4.2,1.6,8)
^
"SEC","^DIC",3.4,3.4,0,"AUDIT")

"SEC","^DIC",3.4,3.4,0,"DD")

"SEC","^DIC",3.4,3.4,0,"DEL")

"SEC","^DIC",3.4,3.4,0,"LAYGO")

"SEC","^DIC",3.4,3.4,0,"RD")

"SEC","^DIC",3.4,3.4,0,"WR")

"SEC","^DIC",3.6,3.6,0,"AUDIT")

"SEC","^DIC",3.6,3.6,0,"DD")
#
"SEC","^DIC",3.6,3.6,0,"DEL")
#
"SEC","^DIC",3.6,3.6,0,"LAYGO")

"SEC","^DIC",3.6,3.6,0,"RD")

"SEC","^DIC",3.6,3.6,0,"WR")
#
"SEC","^DIC",3.7,3.7,0,"AUDIT")

"SEC","^DIC",3.7,3.7,0,"DD")

"SEC","^DIC",3.7,3.7,0,"DEL")

"SEC","^DIC",3.7,3.7,0,"LAYGO")

"SEC","^DIC",3.7,3.7,0,"RD")

"SEC","^DIC",3.7,3.7,0,"WR")

"SEC","^DIC",3.73,3.73,0,"AUDIT")

"SEC","^DIC",3.73,3.73,0,"DD")

"SEC","^DIC",3.73,3.73,0,"DEL")

"SEC","^DIC",3.73,3.73,0,"LAYGO")

"SEC","^DIC",3.73,3.73,0,"RD")

"SEC","^DIC",3.73,3.73,0,"WR")

"SEC","^DIC",3.8,3.8,0,"AUDIT")

"SEC","^DIC",3.8,3.8,0,"DD")
#
"SEC","^DIC",3.8,3.8,0,"DEL")
#
"SEC","^DIC",3.8,3.8,0,"LAYGO")

"SEC","^DIC",3.8,3.8,0,"RD")

"SEC","^DIC",3.8,3.8,0,"WR")
#
"SEC","^DIC",3.9,3.9,0,"AUDIT")

"SEC","^DIC",3.9,3.9,0,"DD")

"SEC","^DIC",3.9,3.9,0,"DEL")

"SEC","^DIC",3.9,3.9,0,"LAYGO")

"SEC","^DIC",3.9,3.9,0,"RD")

"SEC","^DIC",3.9,3.9,0,"WR")

"SEC","^DIC",4.2,4.2,0,0)
^S
"SEC","^DIC",4.2,4.2,0,"AUDIT")
@
"SEC","^DIC",4.2,4.2,0,"DD")
@
"SEC","^DIC",4.2,4.2,0,"DEL")
@
"SEC","^DIC",4.2,4.2,0,"LAYGO")
@
"SEC","^DIC",4.2,4.2,0,"RD")
@
"SEC","^DIC",4.2,4.2,0,"WR")
@
"SEC","^DIC",4.281,4.281,0,"AUDIT")

"SEC","^DIC",4.281,4.281,0,"DD")

"SEC","^DIC",4.281,4.281,0,"DEL")

"SEC","^DIC",4.281,4.281,0,"LAYGO")

"SEC","^DIC",4.281,4.281,0,"RD")

"SEC","^DIC",4.281,4.281,0,"WR")

"SEC","^DIC",4.2996,4.2996,0,"AUDIT")

"SEC","^DIC",4.2996,4.2996,0,"DD")
@
"SEC","^DIC",4.2996,4.2996,0,"DEL")
#
"SEC","^DIC",4.2996,4.2996,0,"LAYGO")
#
"SEC","^DIC",4.2996,4.2996,0,"RD")

"SEC","^DIC",4.2996,4.2996,0,"WR")
#
"SEC","^DIC",4.2997,4.2997,0,"AUDIT")

"SEC","^DIC",4.2997,4.2997,0,"DD")

"SEC","^DIC",4.2997,4.2997,0,"DEL")

"SEC","^DIC",4.2997,4.2997,0,"LAYGO")

"SEC","^DIC",4.2997,4.2997,0,"RD")

"SEC","^DIC",4.2997,4.2997,0,"WR")

"SEC","^DIC",4.2998,4.2998,0,"AUDIT")

"SEC","^DIC",4.2998,4.2998,0,"DD")

"SEC","^DIC",4.2998,4.2998,0,"DEL")

"SEC","^DIC",4.2998,4.2998,0,"LAYGO")

"SEC","^DIC",4.2998,4.2998,0,"RD")

"SEC","^DIC",4.2998,4.2998,0,"WR")

"SEC","^DIC",4.2999,4.2999,0,"AUDIT")

"SEC","^DIC",4.2999,4.2999,0,"DD")

"SEC","^DIC",4.2999,4.2999,0,"DEL")

"SEC","^DIC",4.2999,4.2999,0,"LAYGO")

"SEC","^DIC",4.2999,4.2999,0,"RD")

"SEC","^DIC",4.2999,4.2999,0,"WR")

"SEC","^DIC",4.3,4.3,0,"AUDIT")

"SEC","^DIC",4.3,4.3,0,"DD")
@
"SEC","^DIC",4.3,4.3,0,"DEL")
#
"SEC","^DIC",4.3,4.3,0,"LAYGO")
#
"SEC","^DIC",4.3,4.3,0,"RD")
#
"SEC","^DIC",4.3,4.3,0,"WR")
#
"SEC","^DIC",4.4,4.4,0,"AUDIT")

"SEC","^DIC",4.4,4.4,0,"DD")

"SEC","^DIC",4.4,4.4,0,"DEL")

"SEC","^DIC",4.4,4.4,0,"LAYGO")

"SEC","^DIC",4.4,4.4,0,"RD")

"SEC","^DIC",4.4,4.4,0,"WR")

"SEC","^DIC",4.501,4.501,0,"AUDIT")

"SEC","^DIC",4.501,4.501,0,"DD")

"SEC","^DIC",4.501,4.501,0,"DEL")

"SEC","^DIC",4.501,4.501,0,"LAYGO")

"SEC","^DIC",4.501,4.501,0,"RD")

"SEC","^DIC",4.501,4.501,0,"WR")

"SEC","^DIC",4.6,4.6,0,"AUDIT")

"SEC","^DIC",4.6,4.6,0,"DD")

"SEC","^DIC",4.6,4.6,0,"DEL")

"SEC","^DIC",4.6,4.6,0,"LAYGO")

"SEC","^DIC",4.6,4.6,0,"RD")

"SEC","^DIC",4.6,4.6,0,"WR")

"VER")
8.0^22.0
"^DD",3.4,3.4,0)
FIELD^^5^6
"^DD",3.4,3.4,0,"DDA")
N
"^DD",3.4,3.4,0,"DT")
2910720
"^DD",3.4,3.4,0,"IX","B",3.4,.01)

"^DD",3.4,3.4,0,"NM","COMMUNICATIONS PROTOCOL")

"^DD",3.4,3.4,0,"PT",4.3,8.23)

"^DD",3.4,3.4,.01,0)
NAME^RF^^0;1^K:$L(X)>30!($L(X)<3)!'(X'?1P.E)!(X'?.ANP) X
"^DD",3.4,3.4,.01,.1)
Name of the channel
"^DD",3.4,3.4,.01,1,0)
^.1
"^DD",3.4,3.4,.01,1,1,0)
3.4^B
"^DD",3.4,3.4,.01,1,1,1)
S ^DIC(3.4,"B",$E(X,1,30),DA)=""
"^DD",3.4,3.4,.01,1,1,2)
K ^DIC(3.4,"B",$E(X,1,30),DA)
"^DD",3.4,3.4,.01,3)
ANSWER MUST BE 3-30 CHARACTERS IN LENGTH
"^DD",3.4,3.4,.01,21,0)
^^1^1^2931213^^
"^DD",3.4,3.4,.01,21,1,0)
The name assigned to this particular communications protocol.
"^DD",3.4,3.4,.01,"DT")
2851009
"^DD",3.4,3.4,1,0)
SEND^K^^1;E1,200^K:$L(X)>200!($L(X)<1) X
"^DD",3.4,3.4,1,.1)
The executable code to send a line of data in <XMSG>
"^DD",3.4,3.4,1,3)
ANSWER MUST BE 1-200 CHARACTERS IN LENGTH
"^DD",3.4,3.4,1,9)
@
"^DD",3.4,3.4,1,21,0)
^^2^2^2900315^^
"^DD",3.4,3.4,1,21,1,0)
The executable MUMPS code that will send the data in the
"^DD",3.4,3.4,1,21,2,0)
variable XMSG.
"^DD",3.4,3.4,2,0)
RECEIVE^K^^2;E1,200^K:$L(X)>200!($L(X)<1) X
"^DD",3.4,3.4,2,.1)
The executable code to receive a line of data in <XMRG>
"^DD",3.4,3.4,2,3)
ANSWER MUST BE 1-200 CHARACTERS IN LENGTH
"^DD",3.4,3.4,2,9)
@
"^DD",3.4,3.4,2,21,0)
^^2^2^2851015^^
"^DD",3.4,3.4,2,21,1,0)
The executable MUMPS code which will receive data and store it
"^DD",3.4,3.4,2,21,2,0)
in the variable XMRG.
"^DD",3.4,3.4,3,0)
OPEN^K^^3;E1,200^K:$L(X)>245 X D:$D(X) ^DIM
"^DD",3.4,3.4,3,.1)
The executable code to open the channel, setting <IO> to proper values
"^DD",3.4,3.4,3,3)
ANSWER MUST BE 1-200 CHARACTERS IN LENGTH
"^DD",3.4,3.4,3,9)
@
"^DD",3.4,3.4,3,21,0)
^^13^13^3020424^^^^
"^DD",3.4,3.4,3,21,1,0)
The executable MUMPS code which will open the communication channel,
"^DD",3.4,3.4,3,21,2,0)
setting the variable IO to the proper value.
"^DD",3.4,3.4,3,21,3,0)
 
"^DD",3.4,3.4,3,21,4,0)
There are a couple of variables that can be set in this area to control 
"^DD",3.4,3.4,3,21,5,0)
the connection:
"^DD",3.4,3.4,3,21,6,0)
 
"^DD",3.4,3.4,3,21,7,0)
XMNO220=1 will stop MailMan from issuing its second (and mandatory
"^DD",3.4,3.4,3,21,8,0)
when talking to another MailMan system, but fatal when talking
"^DD",3.4,3.4,3,21,9,0)
to non-MailMan SMTP messaging systems) 220 'ready' when the
"^DD",3.4,3.4,3,21,10,0)
receiver is indicating it is on the line and ready to receive.
"^DD",3.4,3.4,3,21,11,0)
 
"^DD",3.4,3.4,3,21,12,0)
XMD="D" causes MailMan to echo on the principle device the entire
"^DD",3.4,3.4,3,21,13,0)
transmission script.
"^DD",3.4,3.4,3,"DT")
3020424
"^DD",3.4,3.4,4,0)
CLOSE^K^^4;E1,200^K:$L(X)>200!($L(X)<1) X
"^DD",3.4,3.4,4,.1)
The executable code to close the channel
"^DD",3.4,3.4,4,3)
ANSWER MUST BE 1-200 CHARACTERS IN LENGTH
"^DD",3.4,3.4,4,9)
@
"^DD",3.4,3.4,4,21,0)
^^2^2^2851009^
"^DD",3.4,3.4,4,21,1,0)
The executable MUMPS code which will close the communication
"^DD",3.4,3.4,4,21,2,0)
channel.
"^DD",3.4,3.4,5,0)
DESCRIPTION^3.41^^5;0
"^DD",3.4,3.41,0)
DESCRIPTION SUB-FIELD^NL^.01^1
"^DD",3.4,3.41,0,"NM","DESCRIPTION")

"^DD",3.4,3.41,0,"UP")
3.4
"^DD",3.4,3.41,.01,0)
DESCRIPTION^W^^0;1^Q
"^DD",3.4,3.41,.01,21,0)
^^1^1^2931213^
"^DD",3.4,3.41,.01,21,1,0)
This is the description of the communications protocol file.
"^DD",3.6,3.6,0)
FIELD^NL^12^8
"^DD",3.6,3.6,0,"DDA")
N
"^DD",3.6,3.6,0,"DT")
2970611
"^DD",3.6,3.6,0,"IX","B",3.6,.01)

"^DD",3.6,3.6,0,"NM","BULLETIN")

"^DD",3.6,3.6,0,"PT",19,220)

"^DD",3.6,3.6,0,"VRPK")
KERNEL
"^DD",3.6,3.6,.01,0)
NAME^RXF^^0;1^D CHKNAME^XQ5 K:$L(X)>30!(X["""")!(+X=X)!($L(X)<3)!'(X'?1P.E)!(X'?.ANP) X
"^DD",3.6,3.6,.01,.1)
A Unique name of bulletin, beginning with the package prefix
"^DD",3.6,3.6,.01,1,0)
^.1^^-1
"^DD",3.6,3.6,.01,1,1,0)
3.6^B
"^DD",3.6,3.6,.01,1,1,1)
S ^XMB(3.6,"B",$E(X,1,30),DA)=""
"^DD",3.6,3.6,.01,1,1,2)
K ^XMB(3.6,"B",$E(X,1,30),DA)
"^DD",3.6,3.6,.01,3)
NAME MUST BE 3-30 CHARACTERS, NOT NUMERIC OR STARTING WITH PUNCTUATION
"^DD",3.6,3.6,.01,21,0)
^^2^2^2880707^^
"^DD",3.6,3.6,.01,21,1,0)
This field is the name of the bulletin, in the standard format of a 
"^DD",3.6,3.6,.01,21,2,0)
two character package prefix, followed by a descriptive name.
"^DD",3.6,3.6,.01,"AUDIT")
n
"^DD",3.6,3.6,.01,"DT")
2880707
"^DD",3.6,3.6,2,0)
SUBJECT^RF^^0;2^K:$L(X)>65!($L(X)<3) X
"^DD",3.6,3.6,2,.1)
The subject of the message generated, as it will appear on the message
"^DD",3.6,3.6,2,3)
ANSWER MUST BE 3-65 CHARACTERS IN LENGTH
"^DD",3.6,3.6,2,21,0)
^^2^2^2840524^
"^DD",3.6,3.6,2,21,1,0)
This is the subject of the bulletin, as it will appear to the recipient.
"^DD",3.6,3.6,2,21,2,0)
Note that it may contain windows, just as in the "MESSAGE" field.
"^DD",3.6,3.6,2,"AUDIT")
n
"^DD",3.6,3.6,2,"DT")
2830922
"^DD",3.6,3.6,4,0)
MAIL GROUP^3.62P^^2;0
"^DD",3.6,3.6,4,21,0)
^^3^3^2860224^^^
"^DD",3.6,3.6,4,21,1,0)
This is a list of the mail groups to which this bulletin will be directed
"^DD",3.6,3.6,4,21,2,0)
when triggered.  If no mail groups are defined, or they point to no users,
"^DD",3.6,3.6,4,21,3,0)
then the bulletin is ignored.
"^DD",3.6,3.6,5,0)
RETENTION DAYS^NJ3,0^^0;3^K:+X'=X!(X>365)!(X<0)!(X?.E1"."1N.N) X
"^DD",3.6,3.6,5,3)
Type a Number between 0 and 365, 0 Decimal Digits
"^DD",3.6,3.6,5,21,0)
^^3^3^3020325^^^
"^DD",3.6,3.6,5,21,1,0)
After this number of days, if the bulletin hasn't already been purged,
"^DD",3.6,3.6,5,21,2,0)
it will be purged by the XMAUTOPURGE option.  If zero or null, the
"^DD",3.6,3.6,5,21,3,0)
bulletin will not have a purge date, and will not be purged by XMAUTOPURGE.
"^DD",3.6,3.6,5,"DT")
3020325
"^DD",3.6,3.6,6,0)
DESCRIPTION^3.63^^3;0
"^DD",3.6,3.6,6,21,0)
^.001^2^2^3020422^^^^
"^DD",3.6,3.6,6,21,1,0)
This field is a description of the bulletin, for documentation purposes.
"^DD",3.6,3.6,6,21,2,0)
It is not used by MailMan for any automatic processing.
"^DD",3.6,3.6,10,0)
MESSAGE^3.61A^^1;0
"^DD",3.6,3.6,10,21,0)
^.001^12^12^3020422^^^
"^DD",3.6,3.6,10,21,1,0)
This holds the "canned" text of the bulletin which will be sent when
"^DD",3.6,3.6,10,21,2,0)
the bulletin is fired.  
"^DD",3.6,3.6,10,21,3,0)
 
"^DD",3.6,3.6,10,21,4,0)
Variable text may be stored in parameters at the time of firing, then
"^DD",3.6,3.6,10,21,5,0)
inserted in the message text.  Parameter windows are defined by putting
"^DD",3.6,3.6,10,21,6,0)
them within vertical bars, with the parameter number inside.  For
"^DD",3.6,3.6,10,21,7,0)
example,  "Appointment for |1| on |2| has been cancelled."  with parameter
"^DD",3.6,3.6,10,21,8,0)
1 set to "Jones", and parameter 2 set to "Monday" would generate a
"^DD",3.6,3.6,10,21,9,0)
bulletin of "Appointment for Jones on Monday has been cancelled."
"^DD",3.6,3.6,10,21,10,0)
 
"^DD",3.6,3.6,10,21,11,0)
Parameters may be set with fileman (in the Bulletin cross reference)
"^DD",3.6,3.6,10,21,12,0)
or by programmers from within programs.
"^DD",3.6,3.6,11,0)
PARAMETER^3.64A^^4;0
"^DD",3.6,3.6,11,21,0)
^^2^2^2931213^^^^
"^DD",3.6,3.6,11,21,1,0)
This defines the parameters, which will be used to set information
"^DD",3.6,3.6,11,21,2,0)
into the bulletin.
"^DD",3.6,3.6,12,0)
PRIORITY?^S^0:NO;1:YES;^0;4^Q
"^DD",3.6,3.6,12,3)
Should this bulletin be a priority message?
"^DD",3.6,3.6,12,21,0)
^^2^2^2970611^
"^DD",3.6,3.6,12,21,1,0)
If you want this bulletin to appear to the recipients as a priority message,
"^DD",3.6,3.6,12,21,2,0)
enter 'yes'; if not, enter 'no'.
"^DD",3.6,3.6,12,"DT")
2970611
"^DD",3.6,3.61,0)
MESSAGE SUB-FIELD^NL^.01^1
"^DD",3.6,3.61,0,"NM","MESSAGE")

"^DD",3.6,3.61,0,"UP")
3.6
"^DD",3.6,3.61,.01,0)
MESSAGE^W^^0;1^Q
"^DD",3.6,3.61,.01,.1)
The text of the bulletin, with windows enclosed in  "|" characters
"^DD",3.6,3.61,.01,3)

"^DD",3.6,3.61,.01,21,0)
^^1^1^2931213^
"^DD",3.6,3.61,.01,21,1,0)
This field has text in it that will become the text of a message.
"^DD",3.6,3.61,.01,"DT")
2831003
"^DD",3.6,3.62,0)
MAIL GROUP SUB-FIELD^NL^.01^1
"^DD",3.6,3.62,0,"IX","B",3.62,.01)

"^DD",3.6,3.62,0,"NM","MAIL GROUP")

"^DD",3.6,3.62,0,"UP")
3.6
"^DD",3.6,3.62,.01,0)
MAIL GROUP^MP3.8^XMB(3.8,^0;1^Q
"^DD",3.6,3.62,.01,.1)
The list of Mail Group(s) to which this bulletin will be sent
"^DD",3.6,3.62,.01,1,0)
^.1
"^DD",3.6,3.62,.01,1,1,0)
3.62^B
"^DD",3.6,3.62,.01,1,1,1)
S ^XMB(3.6,DA(1),2,"B",$E(X,1,30),DA)=""
"^DD",3.6,3.62,.01,1,1,2)
K ^XMB(3.6,DA(1),2,"B",$E(X,1,30),DA)
"^DD",3.6,3.62,.01,1,1,"DT")
2901002
"^DD",3.6,3.62,.01,3)
To which mail group should this bulletin be sent?
"^DD",3.6,3.62,.01,21,0)
^.001^2^2^3020422^^
"^DD",3.6,3.62,.01,21,1,0)
This is the name of a mail group to which this bulletin will be directed
"^DD",3.6,3.62,.01,21,2,0)
when triggered.
"^DD",3.6,3.62,.01,"AUDIT")
n
"^DD",3.6,3.62,.01,"DT")
2901002
"^DD",3.6,3.63,0)
DESCRIPTION SUB-FIELD^NL^.01^1
"^DD",3.6,3.63,0,"NM","DESCRIPTION")

"^DD",3.6,3.63,0,"UP")
3.6
"^DD",3.6,3.63,.01,0)
DESCRIPTION^W^^0;1^Q
"^DD",3.6,3.63,.01,.1)
A short description of the purpose of this bulletin, for documentation purposes
"^DD",3.6,3.63,.01,3)
What's the purpose of this bulletin?
"^DD",3.6,3.63,.01,21,0)
^.001^1^1^3020422^^
"^DD",3.6,3.63,.01,21,1,0)
This field describes the bulletin.
"^DD",3.6,3.63,.01,"DT")
2831006
"^DD",3.6,3.64,0)
PARAMETER SUB-FIELD^NL^1^2
"^DD",3.6,3.64,0,"ID","X")
W:$D(^(1,1))#2 "   ",^(1),"..."
"^DD",3.6,3.64,0,"NM","PARAMETER")

"^DD",3.6,3.64,0,"UP")
3.6
"^DD",3.6,3.64,.01,0)
PARAMETER^MNJ3,0X^^0;1^S DINUM=X K:+X'=X!(X>100)!(X<0)!(X?.E1"."1N.N) X,DINUM
"^DD",3.6,3.64,.01,3)
TYPE A WHOLE NUMBER BETWEEN 0 AND 100
"^DD",3.6,3.64,.01,21,0)
^^2^2^2931213^^
"^DD",3.6,3.64,.01,21,1,0)
This defines a parameter which will be used to set information
"^DD",3.6,3.64,.01,21,2,0)
into the bulletin.
"^DD",3.6,3.64,.01,"AUDIT")
n
"^DD",3.6,3.64,.01,"DT")
2831012
"^DD",3.6,3.64,1,0)
DESCRIPTION^3.65^^1;0
"^DD",3.6,3.64,1,21,0)
^^2^2^2931213^^^^
"^DD",3.6,3.64,1,21,1,0)
This is a description of the parameter, to be inserted into the
"^DD",3.6,3.64,1,21,2,0)
bulletin.  It is purely for documentation purposes.
"^DD",3.6,3.65,0)
DESCRIPTION SUB-FIELD^NL^.01^1
"^DD",3.6,3.65,0,"NM","DESCRIPTION")

"^DD",3.6,3.65,0,"UP")
3.64
"^DD",3.6,3.65,.01,0)
DESCRIPTION^W^^0;1^Q
"^DD",3.6,3.65,.01,21,0)
^^2^2^2931213^
"^DD",3.6,3.65,.01,21,1,0)
This is a description of the parameter to be inserted into the
"^DD",3.6,3.65,.01,21,2,0)
bulletin.  It is purely for documentation purposes.
"^DD",3.6,3.65,.01,"DT")
2831012
"^DD",3.7,3.7,0)
FIELD^^21^39
"^DD",3.7,3.7,0,"DDA")
Y
"^DD",3.7,3.7,0,"DT")
3020222
"^DD",3.7,3.7,0,"IX","AB",3.703,.01)

"^DD",3.7,3.7,0,"IX","AC",3.702,5)

"^DD",3.7,3.7,0,"IX","AD",3.7,5)

"^DD",3.7,3.7,0,"IX","B",3.7,.01)

"^DD",3.7,3.7,0,"IX","C",3.7,.3)

"^DD",3.7,3.7,0,"IX","F",3.7,2)

"^DD",3.7,3.7,0,"IX","M",3.702,.01)

"^DD",3.7,3.7,0,"NM","MAILBOX")

"^DD",3.7,3.7,0,"VRPK")
XM
"^DD",3.7,3.7,.001,0)
NUMBER^NJ7,0I^^ ^K:+X'=X!(X>1000000)!(X<1)!(X?.E1"."1N.N) X
"^DD",3.7,3.7,.001,.1)
The number of the mailbasket
"^DD",3.7,3.7,.001,3)
TYPE A WHOLE NUMBER BETWEEN 1 AND 1000000
"^DD",3.7,3.7,.001,21,0)
^^3^3^3020422^^^^
"^DD",3.7,3.7,.001,21,1,0)
This number is used internally to match mailboxes to users in the
"^DD",3.7,3.7,.001,21,2,0)
NEW PERSON file.  It is not seen by users.  Postmaster has been given the
"^DD",3.7,3.7,.001,21,3,0)
special number of .5.
"^DD",3.7,3.7,.001,"DT")
3020422
"^DD",3.7,3.7,.01,0)
NAME^RP200'XI^VA(200,^0;1^S DINUM=+X
"^DD",3.7,3.7,.01,.1)
The user who owns this mail box.
"^DD",3.7,3.7,.01,1,0)
^.1
"^DD",3.7,3.7,.01,1,1,0)
3.7^B
"^DD",3.7,3.7,.01,1,1,1)
S ^XMB(3.7,"B",$E(X,1,30),DA)=""
"^DD",3.7,3.7,.01,1,1,2)
K ^XMB(3.7,"B",$E(X,1,30),DA)
"^DD",3.7,3.7,.01,3)

"^DD",3.7,3.7,.01,21,0)
^^1^1^2931223^^^
"^DD",3.7,3.7,.01,21,1,0)
This is the name of the user who has this mail box.
"^DD",3.7,3.7,.01,"DT")
2851003
"^DD",3.7,3.7,.3,0)
MAIL NAME^FX^^.3;1^K:X[""""!($A(X)=45) X I $D(X) K:$L(X)>30!($L(X)<3) X I $D(X) D MNAME^XMA21C
"^DD",3.7,3.7,.3,1,0)
^.1
"^DD",3.7,3.7,.3,1,1,0)
3.7^C
"^DD",3.7,3.7,.3,1,1,1)
S ^XMB(3.7,"C",$E(X,1,30),DA)=""
"^DD",3.7,3.7,.3,1,1,2)
K ^XMB(3.7,"C",$E(X,1,30),DA)
"^DD",3.7,3.7,.3,1,1,"%D",0)
^^3^3^2921127^
"^DD",3.7,3.7,.3,1,1,"%D",1,0)
This cross reference is used to ensure that names for this field will
"^DD",3.7,3.7,.3,1,1,"%D",2,0)
be unique.  It is also used for look-up by the name-server for incoming
"^DD",3.7,3.7,.3,1,1,"%D",3,0)
network mail and local mail.
"^DD",3.7,3.7,.3,1,1,"DT")
2921127
"^DD",3.7,3.7,.3,3)
Answer with a name that will be used for your return address on messages sent to other sites.
"^DD",3.7,3.7,.3,4)
D HELP^XMA21C
"^DD",3.7,3.7,.3,21,0)
^^2^2^2931223^^^^
"^DD",3.7,3.7,.3,21,1,0)
This is a name that the user assigns to his mail-box on this system.
"^DD",3.7,3.7,.3,21,2,0)
It is guaranteed to be unique for each user.
"^DD",3.7,3.7,.3,"DT")
2921127
"^DD",3.7,3.7,1,0)
BASKET^3.701^^2;0
"^DD",3.7,3.7,1,21,0)
^^10^10^2970811^^^^
"^DD",3.7,3.7,1,21,1,0)
This is where users store their messages.  Each user is automatically given an
"^DD",3.7,3.7,1,21,2,0)
IN basket (#1), and a WASTE basket (#.5) when they first use MailMan.  These
"^DD",3.7,3.7,1,21,3,0)
are permanent, and may not be deleted by the user.  Other baskets may be
"^DD",3.7,3.7,1,21,4,0)
created by the user, and also deleted. 
"^DD",3.7,3.7,1,21,5,0)
 
"^DD",3.7,3.7,1,21,6,0)
Deleted messages are placed in the WASTE basket temporarily.  Every evening
"^DD",3.7,3.7,1,21,7,0)
the WASTE basket is emptied.
"^DD",3.7,3.7,1,21,8,0)
 
"^DD",3.7,3.7,1,21,9,0)
USERS SHOULD MANIPULATE BASKETS ONLY WITH MAILMAN; NOT TRY TO DO IT MANUALLY
"^DD",3.7,3.7,1,21,10,0)
WITH FILEMAN. 
"^DD",3.7,3.7,1,"DT")
2950226
"^DD",3.7,3.7,1.1,0)
# NEW MESSAGES FOR USER^NJ5,0^^0;6^K:+X'=X!(X>99999)!(X<0)!(X?.E1"."1N.N) X
"^DD",3.7,3.7,1.1,.1)
Total number of NEW messages for this user.
"^DD",3.7,3.7,1.1,3)
TYPE A WHOLE NUMBER BETWEEN 0 AND 99999
"^DD",3.7,3.7,1.1,21,0)
^^1^1^2881121^^^^
"^DD",3.7,3.7,1.1,21,1,0)
A counter for the number of new messages in this MailBox
"^DD",3.7,3.7,1.1,"DT")
2870519
"^DD",3.7,3.7,1.11,0)
LAST MSG RECEIVED DATE/TIME^D^^0;14^S %DT="ESTXR" D ^%DT S X=Y K:Y<1 X
"^DD",3.7,3.7,1.11,3)
This is the date/time that the latest message was received.
"^DD",3.7,3.7,1.11,21,0)
^^2^2^2970409^^
"^DD",3.7,3.7,1.11,21,1,0)
This field is displayed when the user has new messages, and the user is
"^DD",3.7,3.7,1.11,21,2,0)
told how many, and when the last one was received.
"^DD",3.7,3.7,1.11,"DT")
2960403
"^DD",3.7,3.7,1.12,0)
LAST NEW MSG NOTIFY DATE/TIME^D^^0;15^S %DT="ESTXR" D ^%DT S X=Y K:Y<1 X
"^DD",3.7,3.7,1.12,3)
This is the last new message arrival date of which the user was notified.
"^DD",3.7,3.7,1.12,21,0)
^^7^7^3020422^^^
"^DD",3.7,3.7,1.12,21,1,0)
This field is used during logon to determine whether or not to display
"^DD",3.7,3.7,1.12,21,2,0)
to the user the time that the last new message arrived. 
"^DD",3.7,3.7,1.12,21,3,0)

"^DD",3.7,3.7,1.12,21,4,0)
When the user logs on and has new messages, he is told how many, and when
"^DD",3.7,3.7,1.12,21,5,0)
the last one arrived.  If he logs off without reading those messages and
"^DD",3.7,3.7,1.12,21,6,0)
logs on again, and hasn't received any further new messages, he is told
"^DD",3.7,3.7,1.12,21,7,0)
how many new messages he has, but is not told when the last one arrived. 
"^DD",3.7,3.7,1.12,"DT")
3020422
"^DD",3.7,3.7,1.2,0)
DATE @ REINSTATEMENT^D^^0;7^S %DT="EX" D ^%DT S X=Y K:Y<1 X
"^DD",3.7,3.7,1.2,.1)
Date for the user at the time of reinstatement.
"^DD",3.7,3.7,1.2,3)
If you want to restrict the user's access regarding messages originating before a certain date, enter that date.
"^DD",3.7,3.7,1.2,21,0)
^.001^5^5^3020422^^^^
"^DD",3.7,3.7,1.2,21,1,0)
When a user is reinstated, the current date may be stored here if IRM
"^DD",3.7,3.7,1.2,21,2,0)
wants to make sure that the reinstated user may not read any messages
"^DD",3.7,3.7,1.2,21,3,0)
whose local create date is before the reinstatement date.
"^DD",3.7,3.7,1.2,21,4,0)
The user may not access such messages unless the messages are in one of
"^DD",3.7,3.7,1.2,21,5,0)
his mail baskets or the message is forwarded to him. 
"^DD",3.7,3.7,1.2,"DT")
2980917
"^DD",3.7,3.7,2,0)
FORWARDING ADDRESS^FX^^0;2^D XMFWD^XMVVITA(.X,$G(XMIA)) I $D(X) K:$L(X)>50!($L(X)<1) X
"^DD",3.7,3.7,2,.1)
Remote address to which mail is routed
"^DD",3.7,3.7,2,1,0)
^.1
"^DD",3.7,3.7,2,1,1,0)
^^BULLETIN MESSAGE
"^DD",3.7,3.7,2,1,1,1)
S Y(0)=X,D0=DA X "N DIIND F DIIND=1.001:.001 Q:$D(^DD(3.7,2,1,1,DIIND))[0  X ^(DIIND)" K XMY S XMB="XM FWD ADDRESS CHANGE" D ^XMB:$D(^XMB(3.7,"B",XMB)),ENT^XMUT7(DA) K Y,XMB
"^DD",3.7,3.7,2,1,1,1.001)
S X=Y(0) S Y(1)=$S($D(^XMB(3.7,D0,0)):^(0),1:"") S X=$S('$D(^VA(200,+$P(Y(1),U,1),0)):"",1:$P(^(0),U,1)) S XMB(1)=X
"^DD",3.7,3.7,2,1,1,1.002)
S X=Y(0) S Y(1)=$S($D(^XMB(3.7,D0,0)):^(0),1:"") S X=$P(Y(1),U,2) S XMB(2)=X
"^DD",3.7,3.7,2,1,1,2)
Q
"^DD",3.7,3.7,2,1,1,"%D",0)
^.101^12^12^3020423^^^^
"^DD",3.7,3.7,2,1,1,"%D",1,0)
This cross reference sends two bulletins.
"^DD",3.7,3.7,2,1,1,"%D",2,0)

"^DD",3.7,3.7,2,1,1,"%D",3,0)
The first, XM FWD ADDRESS CHANGE, notifies responsible individuals
"^DD",3.7,3.7,2,1,1,"%D",4,0)
(belonging to the mail group associated with the bulletin) that a user
"^DD",3.7,3.7,2,1,1,"%D",5,0)
has changed his forwarding address.  This is the "official" bulletin
"^DD",3.7,3.7,2,1,1,"%D",6,0)
of this cross reference.
"^DD",3.7,3.7,2,1,1,"%D",7,0)

"^DD",3.7,3.7,2,1,1,"%D",8,0)
The second, XM FWD ADDRESS CHECK, is sent to the user's new forwarding
"^DD",3.7,3.7,2,1,1,"%D",9,0)
address as test to see if the address is valid.  If it's not valid, the
"^DD",3.7,3.7,2,1,1,"%D",10,0)
sender (the Postmaster) will receive an error message.  This bulletin
"^DD",3.7,3.7,2,1,1,"%D",11,0)
has been piggy-backed onto the "official" bulletin.  FileMan is not
"^DD",3.7,3.7,2,1,1,"%D",12,0)
aware of this.
"^DD",3.7,3.7,2,1,1,"CREATE PARAMETER #1")
NAME
"^DD",3.7,3.7,2,1,1,"CREATE PARAMETER #2")
FORWARDING ADDRESS
"^DD",3.7,3.7,2,1,1,"CREATE VALUE")
XM FWD ADDRESS CHANGE
"^DD",3.7,3.7,2,1,1,"DELETE VALUE")
NO EFFECT
"^DD",3.7,3.7,2,1,1,"DT")
3020423
"^DD",3.7,3.7,2,1,2,0)
3.7^F
"^DD",3.7,3.7,2,1,2,1)
S ^XMB(3.7,"F",$E(X,1,30),DA)=""
"^DD",3.7,3.7,2,1,2,2)
K ^XMB(3.7,"F",$E(X,1,30),DA)
"^DD",3.7,3.7,2,1,2,"%D",0)
^^2^2^3020423^
"^DD",3.7,3.7,2,1,2,"%D",1,0)
This cross reference enables the site manager to easily find a user
"^DD",3.7,3.7,2,1,2,"%D",2,0)
who enters a bad forwarding address.
"^DD",3.7,3.7,2,1,2,"DT")
3020423
"^DD",3.7,3.7,2,3)
Enter a forwarding address (name@domain) of up to 50 characters.
"^DD",3.7,3.7,2,21,0)
^^8^8^2990512^^^^
"^DD",3.7,3.7,2,21,1,0)
This field names an additional address to which any messages addressed to
"^DD",3.7,3.7,2,21,2,0)
you are routed.  This address must be a remote address or a local device.
"^DD",3.7,3.7,2,21,3,0)

"^DD",3.7,3.7,2,21,4,0)
If you want a local user to see your messages, make that user a surrogate.
"^DD",3.7,3.7,2,21,5,0)
 
"^DD",3.7,3.7,2,21,6,0)
See the LOCAL DELIVERY FLAG.  If you do not edit this field to 'ON', then
"^DD",3.7,3.7,2,21,7,0)
mail will only be delivered to your FORWARDING ADDRESS and not to your
"^DD",3.7,3.7,2,21,8,0)
Mailbox.
"^DD",3.7,3.7,2,"DT")
3020423
"^DD",3.7,3.7,2.1,0)
LOCAL DELIVERY FLAG^S^0:NO LOCAL DELIVERY;1:LOCAL DELIVERY ON;^0;8^Q
"^DD",3.7,3.7,2.1,.1)
LOCAL DELIVERY
"^DD",3.7,3.7,2.1,3)
If this field is not set to 'ON' and the FORWARDING ADDRESS field is filled in, then messages will only be forwarded, not delivered locally.
"^DD",3.7,3.7,2.1,21,0)
^^9^9^2970725^^^^
"^DD",3.7,3.7,2.1,21,1,0)
This field only applies if you have a FORWARDING ADDRESS.
"^DD",3.7,3.7,2.1,21,2,0)

"^DD",3.7,3.7,2.1,21,3,0)
If you have a FORWARDING ADDRESS and you want your messages
"^DD",3.7,3.7,2.1,21,4,0)
delivered locally, too, select 1 or LOCAL DELIVERY ON.
"^DD",3.7,3.7,2.1,21,5,0)
Your messages will be delivered to both your local and remote addresses.
"^DD",3.7,3.7,2.1,21,6,0)

"^DD",3.7,3.7,2.1,21,7,0)
If you have a FORWARDING ADDRESS and you do not want your messages
"^DD",3.7,3.7,2.1,21,8,0)
delivered locally, too, select 0 or NO LOCAL DELIVERY.
"^DD",3.7,3.7,2.1,21,9,0)
Your messages will be delivered only to your remote addresses.
"^DD",3.7,3.7,2.1,"DT")
2970725
"^DD",3.7,3.7,2.21,0)
NETWORK SIGNATURE LINE 1 OF 3^F^^NS1;1^K:$L(X)>70!($L(X)<3) X
"^DD",3.7,3.7,2.21,3)
Answer must be 3-70 characters in length.
"^DD",3.7,3.7,2.21,21,0)
^.001^20^20^3000509^^^^
"^DD",3.7,3.7,2.21,21,1,0)
This field is used when a user chooses to 'Answer' a message
"^DD",3.7,3.7,2.21,21,2,0)
rather than 'Reply' to a message.  While a 'reply' chains the new
"^DD",3.7,3.7,2.21,21,3,0)
message to the original one, an 'answer' creates a new message to
"^DD",3.7,3.7,2.21,21,4,0)
send to the sender of the original message, a new message which will not
"^DD",3.7,3.7,2.21,21,5,0)
be chained to the original message.  The new message is created with a
"^DD",3.7,3.7,2.21,21,6,0)
copy of the message being answered, along with the text of the answer,
"^DD",3.7,3.7,2.21,21,7,0)
followed by this field and the next two NETWORK SIGNATURE LINE fields.
"^DD",3.7,3.7,2.21,21,8,0)

"^DD",3.7,3.7,2.21,21,9,0)
Your network signature might contain your name, who you are, where you
"^DD",3.7,3.7,2.21,21,10,0)
work, how you can be contacted, a favorite quote, or whatever you like.
"^DD",3.7,3.7,2.21,21,11,0)
 
"^DD",3.7,3.7,2.21,21,12,0)
So the final message, sent only to the sender will look like this:
"^DD",3.7,3.7,2.21,21,13,0)
 
"^DD",3.7,3.7,2.21,21,14,0)
    Original text
"^DD",3.7,3.7,2.21,21,15,0)
    .
"^DD",3.7,3.7,2.21,21,16,0)
    .
"^DD",3.7,3.7,2.21,21,17,0)
    Answer
"^DD",3.7,3.7,2.21,21,18,0)
    .
"^DD",3.7,3.7,2.21,21,19,0)
    .
"^DD",3.7,3.7,2.21,21,20,0)
    Network signature (preceeded by a line of "-"s)
"^DD",3.7,3.7,2.21,"DT")
2930326
"^DD",3.7,3.7,2.22,0)
NETWORK SIGNATURE LINE 2 OF 3^F^^NS1;2^K:$L(X)>70!($L(X)<3) X
"^DD",3.7,3.7,2.22,3)
Answer must be 3-70 characters in length.
"^DD",3.7,3.7,2.22,21,0)
^^1^1^2960228^^
"^DD",3.7,3.7,2.22,21,1,0)
See field 2.21 'NETWORK SIGNATURE LINE 1 OF 3'.
"^DD",3.7,3.7,2.22,"DT")
2930326
"^DD",3.7,3.7,2.23,0)
NETWORK SIGNATURE LINE 3 OF 3^F^^NS1;3^K:$L(X)>70!($L(X)<3) X
"^DD",3.7,3.7,2.23,3)
Answer must be 3-70 characters in length.
"^DD",3.7,3.7,2.23,21,0)
^^1^1^2930326^^
"^DD",3.7,3.7,2.23,21,1,0)
See field 2.21 'NETWORK SIGNATURE LINE 1 OF 3'.
"^DD",3.7,3.7,2.23,"DT")
2930326
"^DD",3.7,3.7,3,0)
LATEST MAILMAN ACCESS^F^^L;1^K:$L(X)>64!($L(X)<2) X
"^DD",3.7,3.7,3,3)
Answer must be 2-64 characters in length.
"^DD",3.7,3.7,3,21,0)
^.001^6^6^3020422^^^^
"^DD",3.7,3.7,3,21,1,0)
This field holds the time of last use of MailMan by this user.
"^DD",3.7,3.7,3,21,2,0)
It is in an external date/time format and may include a parenthesized
"^DD",3.7,3.7,3,21,3,0)
surrogate's name (if it was the surrogate that last accessed MailMan).
"^DD",3.7,3.7,3,21,4,0)

"^DD",3.7,3.7,3,21,5,0)
It is displayed when you address a message to a local user so that you
"^DD",3.7,3.7,3,21,6,0)
know when the user "last used MailMan".
"^DD",3.7,3.7,3,"DT")
2970725
"^DD",3.7,3.7,3.1,0)
LATEST MAILMAN ACCESS DATE^D^^L;2^S %DT="E" D ^%DT S X=Y K:Y<1 X
"^DD",3.7,3.7,3.1,21,0)
^^6^6^2960228^^^
"^DD",3.7,3.7,3.1,21,1,0)
The Latest Date Accessed (7N) is in FileMan format and is the same as
"^DD",3.7,3.7,3.1,21,2,0)
the portion of the LATEST ACCESS field that excludes time and text.
"^DD",3.7,3.7,3.1,21,3,0)
 
"^DD",3.7,3.7,3.1,21,4,0)
CAUTION:
"^DD",3.7,3.7,3.1,21,5,0)
 
"^DD",3.7,3.7,3.1,21,6,0)
This field does not exist for a NEW USER until he signs into MailMan.
"^DD",3.7,3.7,3.1,22)

"^DD",3.7,3.7,3.1,"DT")
2900619
"^DD",3.7,3.7,3.2,0)
LAST MAILMAN ACCESS USER ID^P200'^VA(200,^L;3^Q
"^DD",3.7,3.7,3.2,3)
Enter the DUZ of the user.
"^DD",3.7,3.7,3.2,21,0)
^^2^2^2900619^
"^DD",3.7,3.7,3.2,21,1,0)
This field is used to record the DUZ of the last user to sign onto the 
"^DD",3.7,3.7,3.2,21,2,0)
system and use a particular Mail Box.
"^DD",3.7,3.7,3.2,"DT")
2910523
"^DD",3.7,3.7,4,0)
BANNER^F^^B;1^K:$L(X)>200!($L(X)<2) X
"^DD",3.7,3.7,4,1,0)
^.1
"^DD",3.7,3.7,4,1,1,0)
^^BULLETIN MESSAGE
"^DD",3.7,3.7,4,1,1,1)
S Y(0)=X,D0=DA S X=Y(0) S Y(1)=$S($D(^XMB(3.7,D0,"B")):^("B"),1:"") S X=$P(Y(1),U,1) S XMB(1)=X X ^DD(3.7,4,1,1,1.2) K XMY S XMB="XM BANNER MESSAGE" D ^XMB:$D(^XMB(3.6,"B",XMB)) K Y,XMB
"^DD",3.7,3.7,4,1,1,1.2)
S X=Y(0) S Y(1)=$S($D(^XMB(3.7,D0,0)):^(0),1:"") S X=$S('$D(^VA(200,+$P(Y(1),U,1),0)):"",1:$P(^(0),U,1)) S XMB(2)=X
"^DD",3.7,3.7,4,1,1,2)
Q
"^DD",3.7,3.7,4,1,1,"%D",0)
^^1^1^2980430^^^
"^DD",3.7,3.7,4,1,1,"%D",1,0)
Sends a bulletin whenever a banner is created or changed.
"^DD",3.7,3.7,4,1,1,"CREATE PARAMETER #1")
BANNER
"^DD",3.7,3.7,4,1,1,"CREATE PARAMETER #2")
NAME
"^DD",3.7,3.7,4,1,1,"CREATE VALUE")
XM BANNER MESSAGE
"^DD",3.7,3.7,4,1,1,"DELETE VALUE")
NO EFFECT
"^DD",3.7,3.7,4,1,1,"DT")
2970804
"^DD",3.7,3.7,4,3)
ANSWER MUST BE 2-200 CHARACTERS IN LENGTH
"^DD",3.7,3.7,4,21,0)
^^1^1^2851003^^
"^DD",3.7,3.7,4,21,1,0)
The banner is displayed to others whenever they address mail to you.
"^DD",3.7,3.7,4,"DT")
2970804
"^DD",3.7,3.7,4.5,0)
INTRODUCTION^3.704^^1;0
"^DD",3.7,3.7,4.5,21,0)
^^2^2^2881107^
"^DD",3.7,3.7,4.5,21,1,0)
This field will be displayed upon fetching the data of a user during
"^DD",3.7,3.7,4.5,21,2,0)
the help functions.
"^DD",3.7,3.7,5,0)
MESSAGE BEING EDITED^P3.9I^XMB(3.9,^T;1^Q
"^DD",3.7,3.7,5,1,0)
^.1
"^DD",3.7,3.7,5,1,1,0)
3.7^AD^MUMPS
"^DD",3.7,3.7,5,1,1,1)
S ^XMB(3.7,"AD",DA,X)=""
"^DD",3.7,3.7,5,1,1,2)
K ^XMB(3.7,"AD",DA,X)
"^DD",3.7,3.7,5,1,1,"%D",0)
^^2^2^2931212^
"^DD",3.7,3.7,5,1,1,"%D",1,0)
This cross reference is used to keep track of the message currently 
"^DD",3.7,3.7,5,1,1,"%D",2,0)
being editted.
"^DD",3.7,3.7,5,1,1,"DT")
2901002
"^DD",3.7,3.7,5,21,0)
^^2^2^2881123^^^
"^DD",3.7,3.7,5,21,1,0)
When the user is interupted while entering a message, this field holds the
"^DD",3.7,3.7,5,21,2,0)
message number of the message being edited.
"^DD",3.7,3.7,5,"DT")
2901002
"^DD",3.7,3.7,6,0)
SHOW MESSAGE PREVIEW^S^Y:YES, SHOW MESSAGE PREVIEW;N:NO, DO NOT SHOW IT;^0;4^Q
"^DD",3.7,3.7,6,3)
Do you want to see a preview of the message subject and sender?
"^DD",3.7,3.7,6,21,0)
^^44^44^2990223^^^^
"^DD",3.7,3.7,6,21,1,0)
This applies to the Classic reader only.
"^DD",3.7,3.7,6,21,2,0)

"^DD",3.7,3.7,6,21,3,0)
When you are scrolling through the messages in a basket, you can choose
"^DD",3.7,3.7,6,21,4,0)
whether or not MailMan should display (preview) the message subject
"^DD",3.7,3.7,6,21,5,0)
and sender before you read the message.
"^DD",3.7,3.7,6,21,6,0)

"^DD",3.7,3.7,6,21,7,0)
Enter Y to see the preview; N not to.  If you don't enter anything, you
"^DD",3.7,3.7,6,21,8,0)
will not see a preview.
"^DD",3.7,3.7,6,21,9,0)

"^DD",3.7,3.7,6,21,10,0)
Seeing the message subject and sender may help you decide whether or not
"^DD",3.7,3.7,6,21,11,0)
you wish to read the message.  If you decide not to read the message,
"^DD",3.7,3.7,6,21,12,0)
you can "Ignore" it and move on to the next message.
"^DD",3.7,3.7,6,21,13,0)

"^DD",3.7,3.7,6,21,14,0)
The following is a sample dialogue showing message preview:
"^DD",3.7,3.7,6,21,15,0)

"^DD",3.7,3.7,6,21,16,0)
Select MailMan Menu Option: R  Read/Manage Messages
"^DD",3.7,3.7,6,21,17,0)
Select message reader:  Detailed Full Screen// Classic
"^DD",3.7,3.7,6,21,18,0)
Read mail in MAIL BASKET: IN//       (199 messages, 1 new)
"^DD",3.7,3.7,6,21,19,0)
Last message number: 248    Messages in basket: 199 (1 new)
"^DD",3.7,3.7,6,21,20,0)
Enter ??? for help.
"^DD",3.7,3.7,6,21,21,0)

"^DD",3.7,3.7,6,21,22,0)
Subj: MESSAGE A   From: USER,ONE
"^DD",3.7,3.7,6,21,23,0)
IN Basket Message: 248// I
"^DD",3.7,3.7,6,21,24,0)

"^DD",3.7,3.7,6,21,25,0)
Subj: MESSAGE B   From: USER,TWO
"^DD",3.7,3.7,6,21,26,0)
IN Basket Message: 247// I
"^DD",3.7,3.7,6,21,27,0)

"^DD",3.7,3.7,6,21,28,0)
Subj: MESSAGE C   From: USER,THREE
"^DD",3.7,3.7,6,21,29,0)
IN Basket Message: 246//
"^DD",3.7,3.7,6,21,30,0)

"^DD",3.7,3.7,6,21,31,0)
The following is a sample dialogue without message preview.  It is more
"^DD",3.7,3.7,6,21,32,0)
difficult to decide whether to read the message or to ignore it.
"^DD",3.7,3.7,6,21,33,0)

"^DD",3.7,3.7,6,21,34,0)
Select MailMan Menu Option: R  Read/Manage Messages
"^DD",3.7,3.7,6,21,35,0)
Select message reader:  Detailed Full Screen// Classic
"^DD",3.7,3.7,6,21,36,0)
Read mail in MAIL BASKET: IN//       (199 messages, 1 new)
"^DD",3.7,3.7,6,21,37,0)
Last message number: 248    Messages in basket: 199 (1 new)
"^DD",3.7,3.7,6,21,38,0)
Enter ??? for help.
"^DD",3.7,3.7,6,21,39,0)

"^DD",3.7,3.7,6,21,40,0)
IN Basket Message: 248// I
"^DD",3.7,3.7,6,21,41,0)

"^DD",3.7,3.7,6,21,42,0)
IN Basket Message: 247// I
"^DD",3.7,3.7,6,21,43,0)

"^DD",3.7,3.7,6,21,44,0)
IN Basket Message: 246//
"^DD",3.7,3.7,6,"DT")
2990223
"^DD",3.7,3.7,7,0)
MESSAGE BEING RESPONDED TO^P3.9I^XMB(3.9,^T;3^Q
"^DD",3.7,3.7,7,21,0)
^^2^2^3020422^^
"^DD",3.7,3.7,7,21,1,0)
When the user is interrupted while responding to a message, this field 
"^DD",3.7,3.7,7,21,2,0)
holds the message number of the original message being responded to.
"^DD",3.7,3.7,7,"DT")
3020422
"^DD",3.7,3.7,7.5,0)
BLOB MESSAGE^S^0:NO;1:YES;^T;4^Q
"^DD",3.7,3.7,7.5,3)
Are attachments (BLOBs) being added to this message?
"^DD",3.7,3.7,7.5,21,0)
^^3^3^2970221^
"^DD",3.7,3.7,7.5,21,1,0)
When the user is interrupted while creating a message, this field serves to
"^DD",3.7,3.7,7.5,21,2,0)
remind us whether or not the message was being created with attachments
"^DD",3.7,3.7,7.5,21,3,0)
(through the Imaging Package).
"^DD",3.7,3.7,7.5,"DT")
2970221
"^DD",3.7,3.7,8,0)
SURROGATE^3.703P^^9;0
"^DD",3.7,3.7,8,21,0)
^^4^4^2960228^^^^
"^DD",3.7,3.7,8,21,1,0)
This field lists all of the users who have the ability to act as a surrogate
"^DD",3.7,3.7,8,21,2,0)
for this user.  A surrogate may read or send mail for someone else, and is
"^DD",3.7,3.7,8,21,3,0)
listed as the "sender" of the message, while the message is "from" the
"^DD",3.7,3.7,8,21,4,0)
original user.
"^DD",3.7,3.7,9,0)
MAILMAN INSTITUTION^F^^6000;1^K:$L(X)>30!($L(X)<3) X
"^DD",3.7,3.7,9,3)
Answer must be 3-30 characters in length.
"^DD",3.7,3.7,9,21,0)
^^9^9^2980729^^^^
"^DD",3.7,3.7,9,21,1,0)
The MailMan Institution is shown in MailMan when the 'Show Institution in
"^DD",3.7,3.7,9,21,2,0)
MailMan?' field in the MailMan Site Parameters file indicates so.
"^DD",3.7,3.7,9,21,3,0)

"^DD",3.7,3.7,9,21,4,0)
It is shown in parentheses following your name and title in the heading of
"^DD",3.7,3.7,9,21,5,0)
every local message or response which you send.
"^DD",3.7,3.7,9,21,6,0)

"^DD",3.7,3.7,9,21,7,0)
It helps to further identify you.  It is usually the office or site where
"^DD",3.7,3.7,9,21,8,0)
you are located, and is most useful in systems such as FORUM, where people
"^DD",3.7,3.7,9,21,9,0)
from many different sites interact.
"^DD",3.7,3.7,9,"DT")
2891024
"^DD",3.7,3.7,11,0)
MESSAGE ACTION DEFAULT^S^I:IGNORE;D:DELETE;^0;9^Q
"^DD",3.7,3.7,11,3)
Enter an 'I' for 'Ignore' or a 'D' for 'Delete'.
"^DD",3.7,3.7,11,21,0)
0^^5^5^2980729^2900801^2900801^^
"^DD",3.7,3.7,11,21,1,0)
This field overrides the field of the same name in the MailMan Site
"^DD",3.7,3.7,11,21,2,0)
Parameters file.  Whatever you fill into this field will control the
"^DD",3.7,3.7,11,21,3,0)
default for the "Message Action" prompt that you answer after reading
"^DD",3.7,3.7,11,21,4,0)
each message in your IN basket.  For all other baskets, your message
"^DD",3.7,3.7,11,21,5,0)
action default will be "Ignore".
"^DD",3.7,3.7,11,"DT")
2901002
"^DD",3.7,3.7,12,0)
ASK BASKET?^S^y:YES;n:NO;^0;5^Q
"^DD",3.7,3.7,12,3)
If no, MailMan will not ask basket name when user sends message to himself.
"^DD",3.7,3.7,12,21,0)
^^8^8^2980427^^^
"^DD",3.7,3.7,12,21,1,0)
When you send a message to yourself, MailMan will ask you to which basket
"^DD",3.7,3.7,12,21,2,0)
to deliver the message.
"^DD",3.7,3.7,12,21,3,0)

"^DD",3.7,3.7,12,21,4,0)
Answer YES (this is the default) if this is what you want.
"^DD",3.7,3.7,12,21,5,0)

"^DD",3.7,3.7,12,21,6,0)
Answer NO if you do not want MailMan to ask you.  In this case, your
"^DD",3.7,3.7,12,21,7,0)
message will be filtered to the correct basket, with the IN basket being
"^DD",3.7,3.7,12,21,8,0)
the default delivery basket.
"^DD",3.7,3.7,12,"DT")
2850423
"^DD",3.7,3.7,13,0)
SHOW TITLES^S^1:YES;0:NO;^0;10^Q
"^DD",3.7,3.7,13,3)
Enter 'Yes' if you want to see senders' and recipients' titles.
"^DD",3.7,3.7,13,21,0)
^^3^3^2980729^^^^
"^DD",3.7,3.7,13,21,1,0)
This field controls whether or not senders of messages and responses,
"^DD",3.7,3.7,13,21,2,0)
and members of groups will be seen with their 'title' as recorded
"^DD",3.7,3.7,13,21,3,0)
in the NEW PERSON file (200).
"^DD",3.7,3.7,13,"DT")
2910326
"^DD",3.7,3.7,14,0)
PRIORITY RESPONSES FLAG^S^0:Responses are PRIORITY;1:Responses are ORDINARY;^0;11^Q
"^DD",3.7,3.7,14,21,0)
^^3^3^2920818^^
"^DD",3.7,3.7,14,21,1,0)
This field allows users to decide whether or not they want to receive
"^DD",3.7,3.7,14,21,2,0)
responses to their priority mail as priority.  It may be overridden by
"^DD",3.7,3.7,14,21,3,0)
setting a flag in a message that they are the sender or recipient of.
"^DD",3.7,3.7,14,"DT")
2921009
"^DD",3.7,3.7,14.1,0)
PRIORITY RESPONSES PROMPT^S^0:ASK EACH TIME MESSAGE IS READ;1:DO NOT ASK EACH TIME MESSAGE IS READ;^0;12^Q
"^DD",3.7,3.7,14.1,3)
Enter 'Ask' or 'Do not ask'.
"^DD",3.7,3.7,14.1,4)

"^DD",3.7,3.7,14.1,21,0)
^^12^12^2980729^^^^
"^DD",3.7,3.7,14.1,21,1,0)
Answer 'Ask', and MailMan will prompt you each time you read a PRIORITY
"^DD",3.7,3.7,14.1,21,2,0)
mail message, to find out if you want the future responses to that message
"^DD",3.7,3.7,14.1,21,3,0)
to be delivered as PRIORITY mail.  The default answer will be whatever
"^DD",3.7,3.7,14.1,21,4,0)
you answered before for that message, or if it's a new message, whatever
"^DD",3.7,3.7,14.1,21,5,0)
you have entered in PRIORITY RESPONSES FLAG.
"^DD",3.7,3.7,14.1,21,6,0)

"^DD",3.7,3.7,14.1,21,7,0)
Answer 'Do not ask', and MailMan will not bother you with such requests
"^DD",3.7,3.7,14.1,21,8,0)
for information, but will use whatever you have entered in
"^DD",3.7,3.7,14.1,21,9,0)
PRIORITY RESPONSES FLAG.
"^DD",3.7,3.7,14.1,21,10,0)

"^DD",3.7,3.7,14.1,21,11,0)
In either case you may toggle the value of this field by typing KPRIORITY
"^DD",3.7,3.7,14.1,21,12,0)
at the message action prompt.
"^DD",3.7,3.7,14.1,"DT")
2920930
"^DD",3.7,3.7,15,0)
FILTER^3.715^^15;0
"^DD",3.7,3.7,16,0)
FILTER MESSAGES?^S^N:NO;Y:YES;^16;1^Q
"^DD",3.7,3.7,16,3)
If you have mail filters set up, do you want to use them?
"^DD",3.7,3.7,16,21,0)
^.001^8^8^3020422^^^^
"^DD",3.7,3.7,16,21,1,0)
If you don't answer, or if you delete the answer, the default is 'no'.
"^DD",3.7,3.7,16,21,2,0)

"^DD",3.7,3.7,16,21,3,0)
Answer 'yes' if you want MailMan to deliver your messages to your
"^DD",3.7,3.7,16,21,4,0)
baskets based on the filtering criteria (if any) you've set up.
"^DD",3.7,3.7,16,21,5,0)

"^DD",3.7,3.7,16,21,6,0)
Answer 'no' if you have no filtering criteria set up, or if you want
"^DD",3.7,3.7,16,21,7,0)
MailMan to ignore your filtering criteria and deposit all your
"^DD",3.7,3.7,16,21,8,0)
messages in your IN basket.
"^DD",3.7,3.7,16,"DT")
2980515
"^DD",3.7,3.7,16.2,0)
ACCEPT DELIVERY BASKET?^S^Y:YES, ACCEPT IT;N:NO, DON'T ACCEPT IT;E:EXISTING BASKETS ONLY;S:SELECTED BASKETS ONLY;^16;2^Q
"^DD",3.7,3.7,16.2,3)
Accept message delivery into sender-specified baskets?
"^DD",3.7,3.7,16.2,21,0)
^^18^18^2980518^^^^
"^DD",3.7,3.7,16.2,21,1,0)
The sender of a message may specify the *basket* into which the message
"^DD",3.7,3.7,16.2,21,2,0)
should be delivered for all recipients.
"^DD",3.7,3.7,16.2,21,3,0)
You may decide whether to accept delivery to the target basket.
"^DD",3.7,3.7,16.2,21,4,0)

"^DD",3.7,3.7,16.2,21,5,0)
Answer 'NO' if you don't accept it.  This is the default.
"^DD",3.7,3.7,16.2,21,6,0)
 - The message will be delivered as usual.
"^DD",3.7,3.7,16.2,21,7,0)
Answer 'YES' if you accept it.
"^DD",3.7,3.7,16.2,21,8,0)
 - If the basket does not exist, it will be created.
"^DD",3.7,3.7,16.2,21,9,0)
 - The message will be delivered to the specified basket.
"^DD",3.7,3.7,16.2,21,10,0)
Answer 'EXIST' if you accept it only if that basket already exists.
"^DD",3.7,3.7,16.2,21,11,0)
 - If the basket exists, the message will be delivered to it.
"^DD",3.7,3.7,16.2,21,12,0)
 - If the basket doesn't exist, it will not be created, and the message
"^DD",3.7,3.7,16.2,21,13,0)
   will be delivered as usual.
"^DD",3.7,3.7,16.2,21,14,0)
Answer 'SELECT' if you accept it only if that basket already exists
"^DD",3.7,3.7,16.2,21,15,0)
and you have specified that the basket will accept such messages.
"^DD",3.7,3.7,16.2,21,16,0)
 - If the basket exists and accepts, the message will be delivered to it.
"^DD",3.7,3.7,16.2,21,17,0)
 - If the basket doesn't exist or doesn't accept,
"^DD",3.7,3.7,16.2,21,18,0)
   the message will be delivered as usual.
"^DD",3.7,3.7,16.2,"DT")
2980518
"^DD",3.7,3.7,16.3,0)
P-MESSAGE FROM^S^M:ME;P:POSTMASTER;^16;3^Q
"^DD",3.7,3.7,16.3,3)
From whom should your P-MESSAGEs be?
"^DD",3.7,3.7,16.3,21,0)
^^14^14^2990228^^^^
"^DD",3.7,3.7,16.3,21,1,0)
This pertains to anything you may print to the P-MESSAGE device.
"^DD",3.7,3.7,16.3,21,2,0)
The result is a message sent to you.  The question is, "From whom
"^DD",3.7,3.7,16.3,21,3,0)
should the message be?"
"^DD",3.7,3.7,16.3,21,4,0)

"^DD",3.7,3.7,16.3,21,5,0)
Answer ME if the message should be from you.
"^DD",3.7,3.7,16.3,21,6,0)
It will not be delivered new to you, but you will be able to edit it.
"^DD",3.7,3.7,16.3,21,7,0)
(If this field has nothing in it, the default is ME.)
"^DD",3.7,3.7,16.3,21,8,0)

"^DD",3.7,3.7,16.3,21,9,0)
Answer POSTMASTER if the message should be from the Postmaster.
"^DD",3.7,3.7,16.3,21,10,0)
It will be delivered new to you, but you will not be able to edit it.
"^DD",3.7,3.7,16.3,21,11,0)

"^DD",3.7,3.7,16.3,21,12,0)
If you queue the print, this is from whom the message will be.
"^DD",3.7,3.7,16.3,21,13,0)
If you don't queue the print, this is the default which will appear
"^DD",3.7,3.7,16.3,21,14,0)
in a dialog with MailMan to determine from whom the message will be.
"^DD",3.7,3.7,16.3,"DT")
2990227
"^DD",3.7,3.7,17,0)
MESSAGE ORDER^S^N:Newest First;O:Oldest First;^0;13^Q
"^DD",3.7,3.7,17,3)
In which order do you want your messages to appear?
"^DD",3.7,3.7,17,21,0)
^^2^2^2980511^^^
"^DD",3.7,3.7,17,21,1,0)
'Newest First' means messages are displayed in reverse message number order.
"^DD",3.7,3.7,17,21,2,0)
'Oldest First' means messages are displayed in message number order.
"^DD",3.7,3.7,17,"DT")
2980511
"^DD",3.7,3.7,18,0)
MESSAGE READER^S^C:Classic;D:Detailed Full Screen;S:Summary Full Screen;^0;16^Q
"^DD",3.7,3.7,18,3)
What should your default message reader be?
"^DD",3.7,3.7,18,21,0)
^^11^11^3020422^^^^
"^DD",3.7,3.7,18,21,1,0)
There are several ways to read and manage your messages:
"^DD",3.7,3.7,18,21,2,0)

"^DD",3.7,3.7,18,21,3,0)
 Classic              - the one that has been around for years.
"^DD",3.7,3.7,18,21,4,0)
 Detailed Full Screen - full screen, with a detailed message list.
"^DD",3.7,3.7,18,21,5,0)
 Summary Full Screen  - full screen, with a summary message list.
"^DD",3.7,3.7,18,21,6,0)

"^DD",3.7,3.7,18,21,7,0)
'Classic' is the default, if you don't choose any.
"^DD",3.7,3.7,18,21,8,0)

"^DD",3.7,3.7,18,21,9,0)
In the next prompt, 'message reader prompt', you will be able to
"^DD",3.7,3.7,18,21,10,0)
specify whether the reader you choose should be used all the time
"^DD",3.7,3.7,18,21,11,0)
or whether you want to be asked each time.
"^DD",3.7,3.7,18,"DT")
3020422
"^DD",3.7,3.7,19,0)
MESSAGE READER PROMPT^S^Y:Yes, ask me;N:No, don't ask me, just use the default;^0;17^Q
"^DD",3.7,3.7,19,3)
Should MailMan ask you which message reader to use every time you go to read messages?
"^DD",3.7,3.7,19,21,0)
^^15^15^2980518^^^^
"^DD",3.7,3.7,19,21,1,0)
You have chosen a default 'message reader' in the previous selection.
"^DD",3.7,3.7,19,21,2,0)
You chose either the 'classic' reader or one of the 'full-screen' readers.
"^DD",3.7,3.7,19,21,3,0)
(If you didn't choose, then your default is the 'classic' reader.)
"^DD",3.7,3.7,19,21,4,0)

"^DD",3.7,3.7,19,21,5,0)
In this selection, you must decide whether you want MailMan to ask you
"^DD",3.7,3.7,19,21,6,0)
every time you use the message reader which reader to use, or not to ask
"^DD",3.7,3.7,19,21,7,0)
you and just go ahead and use your default message reader.
"^DD",3.7,3.7,19,21,8,0)

"^DD",3.7,3.7,19,21,9,0)
Answer 'Yes' if you want to be prompted for your reader choice every time
"^DD",3.7,3.7,19,21,10,0)
you go to read messages in a basket.  This is the default answer, and is
"^DD",3.7,3.7,19,21,11,0)
recommended until you have tried all the readers and decided that you want
"^DD",3.7,3.7,19,21,12,0)
to settle on using just one.
"^DD",3.7,3.7,19,21,13,0)

"^DD",3.7,3.7,19,21,14,0)
Answer 'No' if you don't want to be prompted, and you just want to use
"^DD",3.7,3.7,19,21,15,0)
your default reader every time.
"^DD",3.7,3.7,19,"DT")
2971204
"^DD",3.7,3.7,20,0)
NEW MESSAGES DEFAULT OPTION^S^LB:LIST BASKETS WITH NEW MAIL;LN:LIST ALL NEW MESSAGES;P:PRINT ALL NEW MESSAGES;R:READ NEW MAIL BY BASKET;^0;18^Q
"^DD",3.7,3.7,20,3)
Select default new messages option
"^DD",3.7,3.7,20,21,0)
^.001^5^5^3000717^^
"^DD",3.7,3.7,20,21,1,0)
This is the default choice which will appear when you select the
"^DD",3.7,3.7,20,21,2,0)
'New Messages and Responses' option.
"^DD",3.7,3.7,20,21,3,0)

"^DD",3.7,3.7,20,21,4,0)
If you don't choose a default, the default will be
"^DD",3.7,3.7,20,21,5,0)
'Read new mail by basket'.
"^DD",3.7,3.7,20,"DT")
3000717
"^DD",3.7,3.7,21,0)
NEW MESSAGES READ ORDER^S^N:Newest First;O:Oldest First;^0;19^Q
"^DD",3.7,3.7,21,3)
In which order do you want to read your new messages?
"^DD",3.7,3.7,21,21,0)
^.001^8^8^3000719^^
"^DD",3.7,3.7,21,21,1,0)
'Newest First' means new messages are read in reverse order.
"^DD",3.7,3.7,21,21,2,0)
'Oldest First' means new messages are read in the order in which
"^DD",3.7,3.7,21,21,3,0)
they were sent.
"^DD",3.7,3.7,21,21,4,0)

"^DD",3.7,3.7,21,21,5,0)
If you don't choose, your new messages will be read 'Oldest First'.
"^DD",3.7,3.7,21,21,6,0)

"^DD",3.7,3.7,21,21,7,0)
Note: When you display a list of new messages, they will be displayed
"^DD",3.7,3.7,21,21,8,0)
in the order you selected in the previous field 'MESSAGE ORDER'.
"^DD",3.7,3.7,21,"DT")
3000719
"^DD",3.7,3.7,99,0)
RETENTION DAYS^NJ3,0^^0;3^K:+X'=X!(X>999)!(X<30)!(X?.E1"."1N.N) X
"^DD",3.7,3.7,99,3)
TYPE A WHOLE NUMBER BETWEEN 30 AND 999
"^DD",3.7,3.7,99,21,0)
^^5^5^2870716^
"^DD",3.7,3.7,99,21,1,0)
This field is not in service currently, but has been reserved here to
"^DD",3.7,3.7,99,21,2,0)
facilitate differing retention dates by user.  Currently the retention
"^DD",3.7,3.7,99,21,3,0)
date (number of days to retain messages in the IN basket) is in the
"^DD",3.7,3.7,99,21,4,0)
Kernel Site Parameters file.  This would continue to be the default
"^DD",3.7,3.7,99,21,5,0)
for all users that do not have this field filled in.
"^DD",3.7,3.7,99,"DT")
2870701
"^DD",3.7,3.701,0)
BASKET SUB-FIELD^^4^5
"^DD",3.7,3.701,0,"DT")
3020222
"^DD",3.7,3.701,0,"IX","AP",3.701,4)

"^DD",3.7,3.701,0,"IX","B",3.701,.01)

"^DD",3.7,3.701,0,"IX","N",3.702,3)

"^DD",3.7,3.701,0,"IX","N0",3.702,3)

"^DD",3.7,3.701,0,"NM","BASKET")

"^DD",3.7,3.701,0,"UP")
3.7
"^DD",3.7,3.701,.01,0)
BASKET^MRF^^0;1^K:X[""""!($A(X)=45) X I $D(X) K:$L(X)>30!($L(X)<2) X
"^DD",3.7,3.701,.01,.1)
User's Mail Basket
"^DD",3.7,3.701,.01,1,0)
^.1
"^DD",3.7,3.701,.01,1,1,0)
3.701^B
"^DD",3.7,3.701,.01,1,1,1)
S ^XMB(3.7,DA(1),2,"B",$E(X,1,30),DA)=""
"^DD",3.7,3.701,.01,1,1,2)
K ^XMB(3.7,DA(1),2,"B",$E(X,1,30),DA)
"^DD",3.7,3.701,.01,1,1,"DT")
2931207
"^DD",3.7,3.701,.01,3)
Answer must be 2-30 characters in length.
"^DD",3.7,3.701,.01,21,0)
^^1^1^2970811^^^^
"^DD",3.7,3.701,.01,21,1,0)
The basket is the place where messages are delivered and/or stored.
"^DD",3.7,3.701,.01,22)
L
"^DD",3.7,3.701,.01,"DT")
2970811
"^DD",3.7,3.701,1,0)
MESSAGE^3.702P^^1;0
"^DD",3.7,3.701,1,21,0)
^^3^3^2970811^^^^
"^DD",3.7,3.701,1,21,1,0)
This is a list of pointers to messages which are in this basket.
"^DD",3.7,3.701,1,21,2,0)
Note that the basket contains only pointers.  The text of the message
"^DD",3.7,3.701,1,21,3,0)
is held only once in the Message file.
"^DD",3.7,3.701,2,0)
# NEW MESSAGES IN BASKET^NJ5,0^^0;2^K:+X'=X!(X>99999)!(X<0)!(X?.E1"."1N.N) X
"^DD",3.7,3.701,2,.1)
Number of NEW messages in mail basket
"^DD",3.7,3.701,2,3)
Type a Number between 0 and 99999, 0 Decimal Digits
"^DD",3.7,3.701,2,21,0)
^^3^3^2970725^^^^
"^DD",3.7,3.701,2,21,1,0)
This is the field that is displayed during look-ups and lists of baskets.
"^DD",3.7,3.701,2,21,2,0)
Holds a count of the number of messages which are flagged as NEW for
"^DD",3.7,3.701,2,21,3,0)
this basket.
"^DD",3.7,3.701,2,"DT")
2970725
"^DD",3.7,3.701,3,0)
DELIVERY BASKET?^S^Y:YES;N:NO;^0;3^Q
"^DD",3.7,3.701,3,3)
Accept delivery to this basket?
"^DD",3.7,3.701,3,21,0)
^^8^8^2980518^
"^DD",3.7,3.701,3,21,1,0)
The sender of a message may specify the *basket* into which the message
"^DD",3.7,3.701,3,21,2,0)
should be delivered for all recipients.
"^DD",3.7,3.701,3,21,3,0)

"^DD",3.7,3.701,3,21,4,0)
This field is relevant only if you have set ACCEPT DELIVERY BASKET? to
"^DD",3.7,3.701,3,21,5,0)
'SELECTED baskets only'.
"^DD",3.7,3.701,3,21,6,0)

"^DD",3.7,3.701,3,21,7,0)
Is this basket one of those baskets which will accept messages from
"^DD",3.7,3.701,3,21,8,0)
senders who have specified target delivery baskets?
"^DD",3.7,3.701,3,"DT")
2980518
"^DD",3.7,3.701,4,0)
READ NEW MSGS BASKET PRIORITY^NJ2,0^^0;4^K:+X'=X!(X>99)!(X<1)!(X?.E1"."1N.N) X
"^DD",3.7,3.701,4,.1)
Read new messages basket priority
"^DD",3.7,3.701,4,1,0)
^.1
"^DD",3.7,3.701,4,1,1,0)
3.701^AP
"^DD",3.7,3.701,4,1,1,1)
S ^XMB(3.7,DA(1),2,"AP",$E(X,1,30),DA)=""
"^DD",3.7,3.701,4,1,1,2)
K ^XMB(3.7,DA(1),2,"AP",$E(X,1,30),DA)
"^DD",3.7,3.701,4,1,1,"DT")
3000718
"^DD",3.7,3.701,4,3)
Type a Number between 1 and 99, 0 Decimal Digits
"^DD",3.7,3.701,4,21,0)
^.001^7^7^3000719^^^
"^DD",3.7,3.701,4,21,1,0)
When you read new messages by basket, MailMan suggests the IN basket
"^DD",3.7,3.701,4,21,2,0)
to read first.  If you want MailMan to suggest other basket(s) before
"^DD",3.7,3.701,4,21,3,0)
suggesting the IN basket, then fill in this field with a priority
"^DD",3.7,3.701,4,21,4,0)
order number.  MailMan will suggest the basket(s) in the priority order
"^DD",3.7,3.701,4,21,5,0)
set by you.  The IN basket will be suggested last.  (You will not be
"^DD",3.7,3.701,4,21,6,0)
able to choose the IN basket.)  Once all the priority baskets have been
"^DD",3.7,3.701,4,21,7,0)
read, MailMan will suggest baskets in alphabetical order. 
"^DD",3.7,3.701,4,"DT")
3000719
"^DD",3.7,3.702,0)
MESSAGE SUB-FIELD^^7^7
"^DD",3.7,3.702,0,"DT")
3020222
"^DD",3.7,3.702,0,"IX","C",3.702,2)

"^DD",3.7,3.702,0,"NM","MESSAGE")

"^DD",3.7,3.702,0,"UP")
3.701
"^DD",3.7,3.702,.01,0)
MESSAGE^P3.9'X^XMB(3.9,^0;1^S DINUM=+X
"^DD",3.7,3.702,.01,.1)
A pointer to each message in this basket
"^DD",3.7,3.702,.01,1,0)
^.1
"^DD",3.7,3.702,.01,1,2,0)
3.7^M
"^DD",3.7,3.702,.01,1,2,1)
S ^XMB(3.7,"M",$E(X,1,30),DA(2),DA(1),DA)=""
"^DD",3.7,3.702,.01,1,2,2)
K ^XMB(3.7,"M",$E(X,1,30),DA(2),DA(1),DA)
"^DD",3.7,3.702,.01,1,3,0)
^^TRIGGER^3.702^2
"^DD",3.7,3.702,.01,1,3,1)
K DIV S DIV=X,D0=DA(2),DIV(0)=D0,D1=DA(1),DIV(1)=D1,D2=DA,DIV(2)=D2 S Y(1)=$S($D(^XMB(3.7,D0,2,D1,1,D2,0)):^(0),1:"") S X=$P(Y(1),U,2),X=X S DIU=X K Y X ^DD(3.702,.01,1,3,1.1) X ^DD(3.702,.01,1,3,1.4)
"^DD",3.7,3.702,.01,1,3,1.1)
S X=DIV S X=$O(^XMB(3.7,DA(2),2,DA(1),1,"C",""),-1)+1
"^DD",3.7,3.702,.01,1,3,1.4)
S DIH=$S($D(^XMB(3.7,DIV(0),2,DIV(1),1,DIV(2),0)):^(0),1:""),DIV=X S $P(^(0),U,2)=DIV,DIH=3.702,DIG=2 D ^DICR:$O(^DD(DIH,DIG,1,0))>0
"^DD",3.7,3.702,.01,1,3,2)
Q
"^DD",3.7,3.702,.01,1,3,"%D",0)
^^1^1^2960229^
"^DD",3.7,3.702,.01,1,3,"%D",1,0)
This trigger gives a new message the next sequence number in the mail basket.
"^DD",3.7,3.702,.01,1,3,"CREATE VALUE")
XM NEXT SEQUENCE NUMBER
"^DD",3.7,3.702,.01,1,3,"DELETE VALUE")
NO EFFECT
"^DD",3.7,3.702,.01,1,3,"DT")
2960229
"^DD",3.7,3.702,.01,1,3,"FIELD")
MAILBOX INDEX
"^DD",3.7,3.702,.01,3)
Users may not enter messages except through the SEND A MESSAGE option.
"^DD",3.7,3.702,.01,21,0)
^^1^1^2881121^^^
"^DD",3.7,3.702,.01,21,1,0)
Messages exist in the MESSAGE file and are pointed to by multiple RECIPIENTS.
"^DD",3.7,3.702,.01,21,2,0)
File.
"^DD",3.7,3.702,.01,"DT")
2970730
"^DD",3.7,3.702,2,0)
MAILBOX INDEX^RNJ5,0^^0;2^K:+X'=X!(X>99999)!(X<1)!(X?.E1"."1N.N) X
"^DD",3.7,3.702,2,.1)
Index number of message in mail basket
"^DD",3.7,3.702,2,1,0)
^.1
"^DD",3.7,3.702,2,1,1,0)
3.702^C
"^DD",3.7,3.702,2,1,1,1)
S ^XMB(3.7,DA(2),2,DA(1),1,"C",$E(X,1,30),DA)=""
"^DD",3.7,3.702,2,1,1,2)
K ^XMB(3.7,DA(2),2,DA(1),1,"C",$E(X,1,30),DA)
"^DD",3.7,3.702,2,3)
Type a Number between 1 and 99999, 0 Decimal Digits
"^DD",3.7,3.702,2,5,1,0)
3.702^.01^3
"^DD",3.7,3.702,2,21,0)
^^2^2^2970725^^^^
"^DD",3.7,3.702,2,21,1,0)
This field is used to help the user choose a message.  It is assigned
"^DD",3.7,3.702,2,21,2,0)
when a message is delivered into a MailBox.
"^DD",3.7,3.702,2,"DT")
2970725
"^DD",3.7,3.702,3,0)
NEW FLAG^S^0:NOT NEW;1:NEW;^0;3^Q
"^DD",3.7,3.702,3,.1)
A flag which indicates NEW status for message
"^DD",3.7,3.702,3,1,0)
^.1
"^DD",3.7,3.702,3,1,1,0)
3.701^N0^MUMPS
"^DD",3.7,3.702,3,1,1,1)
S:X=1 ^XMB(3.7,DA(2),"N0",DA(1),DA)=""
"^DD",3.7,3.702,3,1,1,2)
K ^XMB(3.7,DA(2),"N0",DA(1),DA)
"^DD",3.7,3.702,3,1,1,"%D",0)
^^1^1^2970728^^
"^DD",3.7,3.702,3,1,1,"%D",1,0)
This x-ref is for new messages.
"^DD",3.7,3.702,3,1,1,"DT")
2970728
"^DD",3.7,3.702,3,1,2,0)
3.701^N^MUMPS
"^DD",3.7,3.702,3,1,2,1)
I X=1,$$PRIORITY^XMXSEC($G(^XMB(3.9,DA,0))) N % S %=$G(^XMB(3.9,DA,1,+$O(^XMB(3.9,DA,1,"C",DA(2),0)),0)) I '($P(%,U,9)&$P(%,U,10)) S ^XMB(3.7,DA(2),"N",DA(1),DA)=""
"^DD",3.7,3.702,3,1,2,2)
K ^XMB(3.7,DA(2),"N",DA(1),DA)
"^DD",3.7,3.702,3,1,2,"%D",0)
^^3^3^2990611^^^^
"^DD",3.7,3.702,3,1,2,"%D",1,0)
This x-ref is for priority messages.  If the message is priority, this x-ref is
"^DD",3.7,3.702,3,1,2,"%D",2,0)
set if the message is a new message or if the message has a new reply, and the
"^DD",3.7,3.702,3,1,2,"%D",3,0)
user has chosen to have replies priority, too. 
"^DD",3.7,3.702,3,1,2,"DT")
2990611
"^DD",3.7,3.702,3,3)
If this message is new, set it to 1, otherwise delete it.
"^DD",3.7,3.702,3,21,0)
^^2^2^2980518^^^^
"^DD",3.7,3.702,3,21,1,0)
This field indicates to the user and to MailMan whether or not a message is
"^DD",3.7,3.702,3,21,2,0)
new. 
"^DD",3.7,3.702,3,23,0)
^^8^8^2980518^^^^
"^DD",3.7,3.702,3,23,1,0)
While it is proper to set this field to 0 when the message is no longer new,
"^DD",3.7,3.702,3,23,2,0)
the preferred method is to delete the field (=@).
"^DD",3.7,3.702,3,23,3,0)

"^DD",3.7,3.702,3,23,4,0)
Please note that the cross references on this field, N and N0, are not
"^DD",3.7,3.702,3,23,5,0)
standard FileMan.
"^DD",3.7,3.702,3,23,6,0)

"^DD",3.7,3.702,3,23,7,0)
They should be:  ^XMB(3.7,duz,2,"N",X,xmk,xmz)=""
"^DD",3.7,3.702,3,23,8,0)
But they are:    ^XMB(3.7,duz,"N",xmk,xmz)=""
"^DD",3.7,3.702,3,"DT")
2990611
"^DD",3.7,3.702,4,0)
LAST READ DATE/TIME^D^^0;4^S %DT="ETR" D ^%DT S X=Y K:Y<1 X
"^DD",3.7,3.702,4,.1)
Date/time the message was last referenced
"^DD",3.7,3.702,4,3)
Enter the date & time.
"^DD",3.7,3.702,4,21,0)
^^1^1^2970725^^^
"^DD",3.7,3.702,4,21,1,0)
This is the last date/time the message was read, printed.
"^DD",3.7,3.702,4,23,0)
^^2^2^2970725^
"^DD",3.7,3.702,4,23,1,0)
This field is used during the 'in basket purge' to identify messages which
"^DD",3.7,3.702,4,23,2,0)
haven't been read in a while.
"^DD",3.7,3.702,4,"DT")
2970725
"^DD",3.7,3.702,5,0)
AUTOMATIC DELETE DATE^DX^^0;5^S %DT="FEST" D ^%DT S X=Y K:Y<1 X
"^DD",3.7,3.702,5,1,0)
^.1
"^DD",3.7,3.702,5,1,1,0)
3.7^AC
"^DD",3.7,3.702,5,1,1,1)
S ^XMB(3.7,"AC",$E(X,1,30),DA(2),DA(1),DA)=""
"^DD",3.7,3.702,5,1,1,2)
K ^XMB(3.7,"AC",$E(X,1,30),DA(2),DA(1),DA)
"^DD",3.7,3.702,5,3)
Enter the date (in the future) when this message should be deleted from your basket.
"^DD",3.7,3.702,5,9)
^
"^DD",3.7,3.702,5,21,0)
^^2^2^2990106^^^^
"^DD",3.7,3.702,5,21,1,0)
This is the date at which this message will be 'vaporized',
"^DD",3.7,3.702,5,21,2,0)
deleted from this mail basket for this user.
"^DD",3.7,3.702,5,21,3,0)
the message will be taken out of the users mail basket at the first
"^DD",3.7,3.702,5,21,4,0)
time that the IN-BASKET-PURGE runs.
"^DD",3.7,3.702,5,"DT")
3001025
"^DD",3.7,3.702,6,0)
NETWORK PRIORITY TRANSMISSION?^S^1:HIGH PRIORITY;0:REGULAR PRIORITY;2:LOW PRIORITY;^0;6^Q
"^DD",3.7,3.702,6,1,0)
^.1^^0
"^DD",3.7,3.702,6,3)
How should this message be handled during transmission?
"^DD",3.7,3.702,6,21,0)
^^23^23^3020222^^^^
"^DD",3.7,3.702,6,21,1,0)
This field is used to flag messages that need to be transmitted before or
"^DD",3.7,3.702,6,21,2,0)
after all other messages in a queue.
"^DD",3.7,3.702,6,21,3,0)

"^DD",3.7,3.702,6,21,4,0)
Messages in the queue which are flagged as HIGH priority are transmitted
"^DD",3.7,3.702,6,21,5,0)
before all other messages.
"^DD",3.7,3.702,6,21,6,0)

"^DD",3.7,3.702,6,21,7,0)
Messages in the queue which are flagged as REGULAR priority (default) are
"^DD",3.7,3.702,6,21,8,0)
transmitted next.
"^DD",3.7,3.702,6,21,9,0)

"^DD",3.7,3.702,6,21,10,0)
Messages in the queue which are flagged as LOW priority are transmitted
"^DD",3.7,3.702,6,21,11,0)
after all other messages.
"^DD",3.7,3.702,6,21,12,0)

"^DD",3.7,3.702,6,21,13,0)
Messages with the same priority are transmitted in IEN order, which is
"^DD",3.7,3.702,6,21,14,0)
not necessarily the order in which they appear in the transmit queue.
"^DD",3.7,3.702,6,21,15,0)

"^DD",3.7,3.702,6,21,16,0)
Only the POSTMASTER (or surrogate) may change the priority of a message
"^DD",3.7,3.702,6,21,17,0)
in a transmit queue.  If, during a transmission, MailMan has problems
"^DD",3.7,3.702,6,21,18,0)
with a particular message, MailMan may flag that message as LOW priority,
"^DD",3.7,3.702,6,21,19,0)
so that other messages in the queue will transmit, before the problem
"^DD",3.7,3.702,6,21,20,0)
message is attempted again.
"^DD",3.7,3.702,6,21,21,0)

"^DD",3.7,3.702,6,21,22,0)
Changes to message priorities can be made even while a queue is being
"^DD",3.7,3.702,6,21,23,0)
transmitted.
"^DD",3.7,3.702,6,"DT")
3020222
"^DD",3.7,3.702,7,0)
DELETE DATE SET BY MAILMAN?^S^0:NO;1:YES;^0;7^Q
"^DD",3.7,3.702,7,3)
Did MailMan set the automatic delete date for this message?
"^DD",3.7,3.702,7,21,0)
^^4^4^2970613^
"^DD",3.7,3.702,7,21,1,0)
When the IN BASKET PURGE sets a delete date for a message, it sets this field
"^DD",3.7,3.702,7,21,2,0)
to 1.
"^DD",3.7,3.702,7,21,3,0)

"^DD",3.7,3.702,7,21,4,0)
If a user sets a delete date for a message, this field is set to 0.
"^DD",3.7,3.702,7,"DT")
2970613
"^DD",3.7,3.703,0)
SURROGATE SUB-FIELD^NL^2^3
"^DD",3.7,3.703,0,"DT")
2891025
"^DD",3.7,3.703,0,"NM","SURROGATE")

"^DD",3.7,3.703,0,"UP")
3.7
"^DD",3.7,3.703,.01,0)
SURROGATE^MP200'^VA(200,^0;1^Q
"^DD",3.7,3.703,.01,1,0)
^.1
"^DD",3.7,3.703,.01,1,1,0)
3.7^AB
"^DD",3.7,3.703,.01,1,1,1)
S ^XMB(3.7,"AB",$E(X,1,30),DA(1),DA)=""
"^DD",3.7,3.703,.01,1,1,2)
K ^XMB(3.7,"AB",$E(X,1,30),DA(1),DA)
"^DD",3.7,3.703,.01,21,0)
^^4^4^2851009^
"^DD",3.7,3.703,.01,21,1,0)
A user who has the ability to act as a surrogate for this user. A
"^DD",3.7,3.703,.01,21,2,0)
surrogate may read or send mail for someone else, and is listed as
"^DD",3.7,3.703,.01,21,3,0)
the "sender" of the message, while the message is "from" the original
"^DD",3.7,3.703,.01,21,4,0)
user.
"^DD",3.7,3.703,.01,"DT")
2841202
"^DD",3.7,3.703,1,0)
READ PRIVILEGE^S^y:YES;n:NO;^0;2^Q
"^DD",3.7,3.703,1,21,0)
^^1^1^2850729^^
"^DD",3.7,3.703,1,21,1,0)
This flag controls whether the surrogate may read the mail of this user.
"^DD",3.7,3.703,1,"DT")
2841202
"^DD",3.7,3.703,2,0)
SEND PRIVILEGE^S^y:YES;n:NO;^0;3^Q
"^DD",3.7,3.703,2,21,0)
^^2^2^2960228^^^
"^DD",3.7,3.703,2,21,1,0)
This flag controls whether the surrogate may send messages while acting
"^DD",3.7,3.703,2,21,2,0)
as a surrogate of this user.  If so, the surrogate is named as "sender".
"^DD",3.7,3.703,2,"DT")
2841202
"^DD",3.7,3.704,0)
INTRODUCTION SUB-FIELD^NL^.01^1
"^DD",3.7,3.704,0,"NM","INTRODUCTION")

"^DD",3.7,3.704,0,"UP")
3.7
"^DD",3.7,3.704,.01,0)
INTRODUCTION^W^^0;1^Q
"^DD",3.7,3.704,.01,3)
Enter a short introductory text, describing the user to the group.
"^DD",3.7,3.704,.01,21,0)
^^1^1^2851009^
"^DD",3.7,3.704,.01,21,1,0)
A brief description, introducing the user to the group.
"^DD",3.7,3.704,.01,"DT")
2850423
"^DD",3.7,3.715,0)
FILTER SUB-FIELD^^9^10
"^DD",3.7,3.715,0,"DT")
3001016
"^DD",3.7,3.715,0,"IX","AC",3.715,3)

"^DD",3.7,3.715,0,"IX","AF",3.715,1)

"^DD",3.7,3.715,0,"IX","B",3.715,.01)

"^DD",3.7,3.715,0,"IX","C",3.715,2)

"^DD",3.7,3.715,0,"NM","FILTER")

"^DD",3.7,3.715,0,"UP")
3.7
"^DD",3.7,3.715,.01,0)
FILTER^MF^^0;1^K:$L(X)>30!($L(X)<3) X
"^DD",3.7,3.715,.01,1,0)
^.1
"^DD",3.7,3.715,.01,1,1,0)
3.715^B
"^DD",3.7,3.715,.01,1,1,1)
S ^XMB(3.7,DA(1),15,"B",$E(X,1,30),DA)=""
"^DD",3.7,3.715,.01,1,1,2)
K ^XMB(3.7,DA(1),15,"B",$E(X,1,30),DA)
"^DD",3.7,3.715,.01,3)
Answer must be 3-30 characters in length.
"^DD",3.7,3.715,.01,21,0)
^^22^22^3020422^^^^
"^DD",3.7,3.715,.01,21,1,0)
This is the name of your filter.  The filter is used by MailMan
"^DD",3.7,3.715,.01,21,2,0)
to determine into which basket to place a message.  Messages can be
"^DD",3.7,3.715,.01,21,3,0)
filtered based on up to three criteria which must all be true:
"^DD",3.7,3.715,.01,21,4,0)
 - Subject contains
"^DD",3.7,3.715,.01,21,5,0)
 - Message is from
"^DD",3.7,3.715,.01,21,6,0)
 - Message is to
"^DD",3.7,3.715,.01,21,7,0)

"^DD",3.7,3.715,.01,21,8,0)
For example, if you specify 'subject contains' and 'message is from', the
"^DD",3.7,3.715,.01,21,9,0)
filter takes effect only if the subject contains the string you specify AND
"^DD",3.7,3.715,.01,21,10,0)
the message is from the person you specify. 
"^DD",3.7,3.715,.01,21,11,0)

"^DD",3.7,3.715,.01,21,12,0)
If you wish the filter to take effect upon 'subject contains' OR 'message
"^DD",3.7,3.715,.01,21,13,0)
is from' you must create two filters, one with 'subject contains', and the
"^DD",3.7,3.715,.01,21,14,0)
other with 'message is from'.
"^DD",3.7,3.715,.01,21,15,0)

"^DD",3.7,3.715,.01,21,16,0)
Filtering takes place during message delivery and can also be selected as a
"^DD",3.7,3.715,.01,21,17,0)
basket action.  The filter is ignored during delivery under the following
"^DD",3.7,3.715,.01,21,18,0)
conditions:
"^DD",3.7,3.715,.01,21,19,0)
 - The message already exists in one of your baskets.
"^DD",3.7,3.715,.01,21,20,0)
 - The message is from you, and you specified a basket (other than the IN
"^DD",3.7,3.715,.01,21,21,0)
basket) at the transmit prompt.
"^DD",3.7,3.715,.01,21,22,0)
 - The sender has specified a delivery basket and you have allowed it.
"^DD",3.7,3.715,.01,"DT")
3020422
"^DD",3.7,3.715,1,0)
ORDER^RNJ3,0^^0;2^K:+X'=X!(X>999)!(X<1)!(X?.E1"."1N.N) X
"^DD",3.7,3.715,1,1,0)
^.1
"^DD",3.7,3.715,1,1,1,0)
3.715^AF^MUMPS
"^DD",3.7,3.715,1,1,1,1)
N XMSTAT S XMSTAT=$P($G(^XMB(3.7,DA(1),15,DA,0)),U,4) I XMSTAT S ^XMB(3.7,DA(1),15,"AF",X,DA)=""
"^DD",3.7,3.715,1,1,1,2)
N XMSTAT S XMSTAT=$P($G(^XMB(3.7,DA(1),15,DA,0)),U,4) I XMSTAT K ^XMB(3.7,DA(1),15,"AF",X,DA)
"^DD",3.7,3.715,1,1,1,"DT")
2970520
"^DD",3.7,3.715,1,3)
Type a Number between 1 and 999, 0 Decimal Digits
"^DD",3.7,3.715,1,21,0)
^^8^8^2980908^^^^
"^DD",3.7,3.715,1,21,1,0)
This is the order in which you wish to have your filters checked.
"^DD",3.7,3.715,1,21,2,0)

"^DD",3.7,3.715,1,21,3,0)
A message may match several filters, depending on the conditions you have
"^DD",3.7,3.715,1,21,4,0)
set.  It is here that you specify relative filter priority.  If several
"^DD",3.7,3.715,1,21,5,0)
filters have the same order, then the first one you entered receives
"^DD",3.7,3.715,1,21,6,0)
priority.
"^DD",3.7,3.715,1,21,7,0)

"^DD",3.7,3.715,1,21,8,0)
If you aren't sure, enter 100.  You can always change it later.
"^DD",3.7,3.715,1,"DT")
2970520
"^DD",3.7,3.715,2,0)
BASKET^RFX^^0;3^D BASKET^XMTDF(.X)
"^DD",3.7,3.715,2,1,0)
^.1
"^DD",3.7,3.715,2,1,1,0)
3.715^C
"^DD",3.7,3.715,2,1,1,1)
S ^XMB(3.7,DA(1),15,"C",$E(X,1,30),DA)=""
"^DD",3.7,3.715,2,1,1,2)
K ^XMB(3.7,DA(1),15,"C",$E(X,1,30),DA)
"^DD",3.7,3.715,2,1,1,"DT")
2970520
"^DD",3.7,3.715,2,3)
Answer must be a valid basket name (not the IN basket).
"^DD",3.7,3.715,2,4)
D BSKTHELP^XMTDF
"^DD",3.7,3.715,2,21,0)
^^8^8^2980908^^^^
"^DD",3.7,3.715,2,21,1,0)
This is the basket you want any messages to go into if they match all of
"^DD",3.7,3.715,2,21,2,0)
the conditions you specify for this filter.
"^DD",3.7,3.715,2,21,3,0)

"^DD",3.7,3.715,2,21,4,0)
The basket may not be the "IN" basket, because that is the default basket.
"^DD",3.7,3.715,2,21,5,0)

"^DD",3.7,3.715,2,21,6,0)
The basket must exist (or be created) at the time you specify it.  You may
"^DD",3.7,3.715,2,21,7,0)
delete this basket later.  If a message filters to this basket, and the
"^DD",3.7,3.715,2,21,8,0)
basket does not exist, the basket will be created.
"^DD",3.7,3.715,2,"DT")
2970521
"^DD",3.7,3.715,3,0)
STATUS^RS^0:OFF;1:ON;^0;4^Q
"^DD",3.7,3.715,3,1,0)
^.1
"^DD",3.7,3.715,3,1,1,0)
3.715^AC^MUMPS
"^DD",3.7,3.715,3,1,1,1)
Q:'X  N XMORDER S XMORDER=$P($G(^XMB(3.7,DA(1),15,DA,0)),U,2) I XMORDER S ^XMB(3.7,DA(1),15,"AF",XMORDER,DA)=""
"^DD",3.7,3.715,3,1,1,2)
Q:'X  N XMORDER S XMORDER=$P($G(^XMB(3.7,DA(1),15,DA,0)),U,2) I XMORDER K ^XMB(3.7,DA(1),15,"AF",XMORDER,DA)
"^DD",3.7,3.715,3,1,1,"DT")
2970520
"^DD",3.7,3.715,3,21,0)
^^2^2^2980908^^
"^DD",3.7,3.715,3,21,1,0)
If the filter is active, it will be used.
"^DD",3.7,3.715,3,21,2,0)
If the filter is not active, it will be ignored.
"^DD",3.7,3.715,3,"DT")
2970520
"^DD",3.7,3.715,4,0)
SUBJECT CONTAINS^FX^^0;5^K:$L(X)>25!($L(X)<3) X S:$D(X) X=$$UP^XLFSTR(X)
"^DD",3.7,3.715,4,3)
Answer must be 3-25 characters in length.
"^DD",3.7,3.715,4,21,0)
^^4^4^2980908^^^^
"^DD",3.7,3.715,4,21,1,0)
If the subject contains the string you specify AND if the message matches
"^DD",3.7,3.715,4,21,2,0)
the other conditions (if any), then the message matches this filter.
"^DD",3.7,3.715,4,21,3,0)

"^DD",3.7,3.715,4,21,4,0)
The subject is capitalized automatically to facilitate filtering.
"^DD",3.7,3.715,4,"DT")
2970806
"^DD",3.7,3.715,5,0)
FROM^FXO^^0;6^D FROM^XMTDF(.X)
"^DD",3.7,3.715,5,2)
S Y(0)=Y S:+Y=Y Y=$$NAME^XMXUTIL(Y)
"^DD",3.7,3.715,5,2.1)
S:+Y=Y Y=$$NAME^XMXUTIL(Y)
"^DD",3.7,3.715,5,3)
Who is the sender of the message?
"^DD",3.7,3.715,5,21,0)
^.001^20^20^3010301^^^^
"^DD",3.7,3.715,5,21,1,0)
This is the person who sent the message.
"^DD",3.7,3.715,5,21,2,0)
 
"^DD",3.7,3.715,5,21,3,0)
If it's a local person, just enter the name.
"^DD",3.7,3.715,5,21,4,0)
 
"^DD",3.7,3.715,5,21,5,0)
If it's a remote person, enter name@site.  MailMan will match any sender
"^DD",3.7,3.715,5,21,6,0)
whose name contains 'name' and whose site contains 'site'.  'Name' may
"^DD",3.7,3.715,5,21,7,0)
be null, in which case, MailMan will match any sender whose site
"^DD",3.7,3.715,5,21,8,0)
contains 'site'.  'Site' may be null, in which case, MailMan will match
"^DD",3.7,3.715,5,21,9,0)
any sender whose name contains 'name'.  In any event, the string must be
"^DD",3.7,3.715,5,21,10,0)
from 2 to 45 characters and must contain '@'.
"^DD",3.7,3.715,5,21,11,0)
 
"^DD",3.7,3.715,5,21,12,0)
If it's a local message from a VISTA package/fake sender,
"^DD",3.7,3.715,5,21,13,0)
put '@' at the end, like ACCOUNTS RECEIVABLE@
"^DD",3.7,3.715,5,21,14,0)
 
"^DD",3.7,3.715,5,21,15,0)
The sender's name is capitalized automatically to facilitate filtering.
"^DD",3.7,3.715,5,21,16,0)
 
"^DD",3.7,3.715,5,21,17,0)
For this filter to activate, its STATUS must be on, this condition and
"^DD",3.7,3.715,5,21,18,0)
the other conditions (if any) must match the message, and it must be the
"^DD",3.7,3.715,5,21,19,0)
first filter (as controlled by its ORDER) to match the message.
"^DD",3.7,3.715,5,21,20,0)
Finally, filtering must be turned on.
"^DD",3.7,3.715,5,"DT")
3020422
"^DD",3.7,3.715,6,0)
ADDRESSED TO^FX^^0;7^D TO^XMTDF(.X)
"^DD",3.7,3.715,6,3)
Answer must be 1-55 characters in length.
"^DD",3.7,3.715,6,21,0)
^.001^16^16^3010301^^^^
"^DD",3.7,3.715,6,21,1,0)
Enter the person or group to whom the message is addressed.
"^DD",3.7,3.715,6,21,2,0)
If the person is remote, enter name@site.  MailMan will match any
"^DD",3.7,3.715,6,21,3,0)
sender whose name contains 'name' and whose site contains 'site'.
"^DD",3.7,3.715,6,21,4,0)
'name' or 'site' may be null.
"^DD",3.7,3.715,6,21,5,0)

"^DD",3.7,3.715,6,21,6,0)
The addressee's name may be automatically capitalized to facilitate
"^DD",3.7,3.715,6,21,7,0)
filtering.
"^DD",3.7,3.715,6,21,8,0)

"^DD",3.7,3.715,6,21,9,0)
MailMan will check the addressees that you see when you Query (Q) the
"^DD",3.7,3.715,6,21,10,0)
message.  MailMan will NOT check the expanded list of addresses that
"^DD",3.7,3.715,6,21,11,0)
you see when you Query Detailed (QD) the message.
"^DD",3.7,3.715,6,21,12,0)

"^DD",3.7,3.715,6,21,13,0)
For this filter to activate, its STATUS must be on, this condition and the
"^DD",3.7,3.715,6,21,14,0)
other conditions (if any) must match the message, and it must be the first
"^DD",3.7,3.715,6,21,15,0)
filter (as controlled by its ORDER) to match the message.  Finally,
"^DD",3.7,3.715,6,21,16,0)
filtering must be turned on. 
"^DD",3.7,3.715,6,"DT")
2970521
"^DD",3.7,3.715,7,0)
VAPORIZE DAYS^NJ3,0^^0;8^K:+X'=X!(X>365)!(X<7)!(X?.E1"."1N.N) X
"^DD",3.7,3.715,7,3)
Type a Number between 7 and 365, 0 Decimal Digits
"^DD",3.7,3.715,7,21,0)
^.001^13^13^3020422^^^^
"^DD",3.7,3.715,7,21,1,0)
The message will be set to vaporize (be deleted from your mailbox) this
"^DD",3.7,3.715,7,21,2,0)
many days after it is delivered to you.  This date will override any
"^DD",3.7,3.715,7,21,3,0)
vaporize date set by the sender. You will be able to change or delete
"^DD",3.7,3.715,7,21,4,0)
the vaporize date at the message action prompt whenever you read the
"^DD",3.7,3.715,7,21,5,0)
message. 
"^DD",3.7,3.715,7,21,6,0)
 
"^DD",3.7,3.715,7,21,7,0)
If this field is null, the filter will not set any vaporize date.
"^DD",3.7,3.715,7,21,8,0)
 
"^DD",3.7,3.715,7,21,9,0)
This will only apply to new messages and responses which are put into
"^DD",3.7,3.715,7,21,10,0)
your mailbox (includes moving from the WASTE basket) as a result of
"^DD",3.7,3.715,7,21,11,0)
delivery or latering.  It won't apply to messages which are already in
"^DD",3.7,3.715,7,21,12,0)
your mailbox.  It won't apply when you filter messages which are already
"^DD",3.7,3.715,7,21,13,0)
in your mailbox. 
"^DD",3.7,3.715,7,"DT")
3020422
"^DD",3.7,3.715,8,0)
DELIVER NEW?^S^Y:YES;N:NO;^0;9^Q
"^DD",3.7,3.715,8,3)
Answer YES or NO.
"^DD",3.7,3.715,8,21,0)
^.001^11^11^3000515^^^^
"^DD",3.7,3.715,8,21,1,0)
If you don't answer, or delete the answer, the default is YES.
"^DD",3.7,3.715,8,21,2,0)
 
"^DD",3.7,3.715,8,21,3,0)
YES means that the message will be delivered as usual, and made new as
"^DD",3.7,3.715,8,21,4,0)
usual.
"^DD",3.7,3.715,8,21,5,0)
 
"^DD",3.7,3.715,8,21,6,0)
NO means that the message will be delivered as usual, but it won't be
"^DD",3.7,3.715,8,21,7,0)
made new, so you won't know it's arrived unless you check. 
"^DD",3.7,3.715,8,21,8,0)
 
"^DD",3.7,3.715,8,21,9,0)
This will only apply to new messages which you have not seen before.
"^DD",3.7,3.715,8,21,10,0)
It won't apply to responses or forwarded messages with responses.  It
"^DD",3.7,3.715,8,21,11,0)
won't apply when you filter messages which are already in your mailbox. 
"^DD",3.7,3.715,8,"DT")
3000505
"^DD",3.7,3.715,9,0)
FORWARD TO^3.7159^^1;0
"^DD",3.7,3.7159,0)
FORWARD TO SUB-FIELD^^.01^1
"^DD",3.7,3.7159,0,"DT")
3001016
"^DD",3.7,3.7159,0,"IX","B",3.7159,.01)

"^DD",3.7,3.7159,0,"NM","FORWARD TO")

"^DD",3.7,3.7159,0,"UP")
3.715
"^DD",3.7,3.7159,.01,0)
FORWARD TO^MFX^^0;1^D FWDTO^XMTDF(.X,$G(XMIA)) I $D(X) K:$L(X)>50!($L(X)<1) X
"^DD",3.7,3.7159,.01,1,0)
^.1
"^DD",3.7,3.7159,.01,1,1,0)
3.7159^B
"^DD",3.7,3.7159,.01,1,1,1)
S ^XMB(3.7,DA(2),15,DA(1),1,"B",$E(X,1,30),DA)=""
"^DD",3.7,3.7159,.01,1,1,2)
K ^XMB(3.7,DA(2),15,DA(1),1,"B",$E(X,1,30),DA)
"^DD",3.7,3.7159,.01,3)
Answer must be 1-50 characters in length.
"^DD",3.7,3.7159,.01,21,0)
^.001^12^12^3001017^^^^
"^DD",3.7,3.7159,.01,21,1,0)
Enter the person, group, device, or server to whom or to which the
"^DD",3.7,3.7159,.01,21,2,0)
message is to be forwarded.  The message will be forwarded under
"^DD",3.7,3.7159,.01,21,3,0)
the following conditions, and you will be listed as the forwarder.
"^DD",3.7,3.7159,.01,21,4,0)

"^DD",3.7,3.7159,.01,21,5,0)
This will only apply when:
"^DD",3.7,3.7159,.01,21,6,0)
 - delivering a message to you for the first time.
"^DD",3.7,3.7159,.01,21,7,0)

"^DD",3.7,3.7159,.01,21,8,0)
This will not apply when:
"^DD",3.7,3.7159,.01,21,9,0)
 - you sent the message.
"^DD",3.7,3.7159,.01,21,10,0)
 - the message is already in your mailbox.
"^DD",3.7,3.7159,.01,21,11,0)
 - delivering replies.
"^DD",3.7,3.7159,.01,21,12,0)
 - the message is closed, confidential, or otherwise sensitive.
"^DD",3.7,3.7159,.01,"DT")
3001017
"^DD",3.73,3.73,0)
FIELD^^2^3
"^DD",3.73,3.73,0,"DDA")
Y
"^DD",3.73,3.73,0,"DT")
2970515
"^DD",3.73,3.73,0,"ID",2)
S %I=Y,Y=$S('$D(^(0)):"",$D(^XMB(3.9,+$P(^(0),U,3),0))#2:$P(^(0),U,1),1:""),C=$P(^DD(3.9,.01,0),U,2) D Y^DIQ:Y]"" W "   ",Y,@("$E("_DIC_"%I,0),0)") S Y=%I K %I
"^DD",3.73,3.73,0,"IX","AB",3.73,2)

"^DD",3.73,3.73,0,"IX","AB1",3.73,.01)

"^DD",3.73,3.73,0,"IX","AC",3.73,2)

"^DD",3.73,3.73,0,"IX","C",3.73,1)

"^DD",3.73,3.73,0,"NM","MESSAGES TO BE NEW AT A LATER DATE")

"^DD",3.73,3.73,0,"VRPK")
XM
"^DD",3.73,3.73,.01,0)
DATE MESSAGE WILL BE NEW^RDX^^0;1^S %DT(0)="NOW",%DT="ETF" D ^%DT K %DT(0) S X=Y K:Y<1 X
"^DD",3.73,3.73,.01,.1)
Date Message Will Be New
"^DD",3.73,3.73,.01,1,0)
^.1
"^DD",3.73,3.73,.01,1,1,0)
^^TRIGGER^3.73^1
"^DD",3.73,3.73,.01,1,1,1)
X ^DD(3.73,.01,1,1,1.3) I X S X=DIV S Y(1)=$S($D(^XMB(3.73,D0,0)):^(0),1:"") S X=$P(Y(1),U,2),X=X S DIU=X K Y S X=DIV S X=$S($D(XMDUZ):XMDUZ,1:DUZ) X ^DD(3.73,.01,1,1,1.4)
"^DD",3.73,3.73,.01,1,1,1.3)
K DIV S DIV=X,D0=DA,DIV(0)=D0 S Y(0)=X S Y(1)=$S($D(^XMB(3.73,D0,0)):^(0),1:"") S X=$S('$D(^VA(200,+$P(Y(1),U,2),0)):"",1:$P(^(0),U,1))=""
"^DD",3.73,3.73,.01,1,1,1.4)
S DIH=$S($D(^XMB(3.73,DIV(0),0)):^(0),1:""),DIV=X S $P(^(0),U,2)=DIV,DIH=3.73,DIG=1 D ^DICR:$O(^DD(DIH,DIG,1,0))>0
"^DD",3.73,3.73,.01,1,1,2)
Q
"^DD",3.73,3.73,.01,1,1,"%D",0)
^.101^2^2^3020422^^
"^DD",3.73,3.73,.01,1,1,"%D",1,0)
This trigger fills in field 1, USER, with the DUZ of the user
"^DD",3.73,3.73,.01,1,1,"%D",2,0)
whose message is to be latered.
"^DD",3.73,3.73,.01,1,1,"CREATE CONDITION")
USER=""
"^DD",3.73,3.73,.01,1,1,"CREATE VALUE")
S X=$S($D(XMDUZ):XMDUZ,1:DUZ)
"^DD",3.73,3.73,.01,1,1,"DELETE VALUE")
NO EFFECT
"^DD",3.73,3.73,.01,1,1,"DT")
2970124
"^DD",3.73,3.73,.01,1,1,"FIELD")
USER
"^DD",3.73,3.73,.01,1,2,0)
3.73^AB1^MUMPS
"^DD",3.73,3.73,.01,1,2,1)
N XMDUZ,XMZ,XMREC S XMREC=$G(^XMB(3.73,DA,0)),XMDUZ=$P(XMREC,U,2),XMZ=$P(XMREC,U,3) I XMZ]"" S ^XMB(3.73,"AB",X,XMDUZ,XMZ,DA)=""
"^DD",3.73,3.73,.01,1,2,2)
N XMDUZ,XMZ,XMREC S XMREC=$G(^XMB(3.73,DA,0)),XMDUZ=$P(XMREC,U,2),XMZ=$P(XMREC,U,3) I XMZ]"" K ^XMB(3.73,"AB",X,XMDUZ,XMZ,DA)
"^DD",3.73,3.73,.01,1,2,"%D",0)
^^2^2^2970127^
"^DD",3.73,3.73,.01,1,2,"%D",1,0)
This xref activates when a user changes the date/time that a message is
"^DD",3.73,3.73,.01,1,2,"%D",2,0)
latered. 
"^DD",3.73,3.73,.01,1,2,"DT")
2970127
"^DD",3.73,3.73,.01,3)
Enter a date or date @ time on which you wish this message to be new.
"^DD",3.73,3.73,.01,21,0)
^^2^2^2970127^^^^
"^DD",3.73,3.73,.01,21,1,0)
This field should be in FileMan format.  The file will be X-referenced by it
"^DD",3.73,3.73,.01,21,2,0)
and the background filer will process it on that date.
"^DD",3.73,3.73,.01,"DT")
3001116
"^DD",3.73,3.73,1,0)
USER^RP200'^VA(200,^0;2^Q
"^DD",3.73,3.73,1,1,0)
^.1
"^DD",3.73,3.73,1,1,1,0)
3.73^C
"^DD",3.73,3.73,1,1,1,1)
S ^XMB(3.73,"C",$E(X,1,30),DA)=""
"^DD",3.73,3.73,1,1,1,2)
K ^XMB(3.73,"C",$E(X,1,30),DA)
"^DD",3.73,3.73,1,1,1,3)
This cross reference is used to drive the Later'd Messages Report.  Do not delete.
"^DD",3.73,3.73,1,1,1,"%D",0)
^^1^1^2900117^
"^DD",3.73,3.73,1,1,1,"%D",1,0)
SEE NO-DELETION MESSAGE.
"^DD",3.73,3.73,1,1,1,"DT")
2900117
"^DD",3.73,3.73,1,3)

"^DD",3.73,3.73,1,5,1,0)
3.73^.01^1
"^DD",3.73,3.73,1,9)
^
"^DD",3.73,3.73,1,12)
The user must have a mailbox and may only choose himself.
"^DD",3.73,3.73,1,12.1)
S DIC("S")="I $S($D(XMDUZ):XMDUZ,$D(DUZ):DUZ,1:"""")=Y,$D(^XMB(3.7,Y))"
"^DD",3.73,3.73,1,21,0)
^^2^2^2970731^^
"^DD",3.73,3.73,1,21,1,0)
This field indicates the user for whom the message will
"^DD",3.73,3.73,1,21,2,0)
be later'd.
"^DD",3.73,3.73,1,"DT")
2910618
"^DD",3.73,3.73,2,0)
MESSAGE^R*P3.9'^XMB(3.9,^0;3^S DIC("S")="I $D(^XMB(3.9,X,0)),$P(^(0),U,2)=$S($D(XMDUZ):XMDUZ,1:DUZ)!$D(^XMB(3.9,X,1,""C"",$S($D(XMDUZ):XMDUZ,1:DUZ)))" D ^DIC K DIC S DIC=DIE,X=+Y K:Y<0 X
"^DD",3.73,3.73,2,1,0)
^.1
"^DD",3.73,3.73,2,1,1,0)
3.73^AB^MUMPS
"^DD",3.73,3.73,2,1,1,1)
S %=^XMB(3.73,DA,0),^XMB(3.73,"AB",+%,$P(%,U,2),X,DA)="" K %
"^DD",3.73,3.73,2,1,1,2)
S %=^XMB(3.73,DA,0) K ^XMB(3.73,"AB",+%,$P(%,U,2),X,DA),%
"^DD",3.73,3.73,2,1,1,"%D",0)
^^3^3^2971229^^
"^DD",3.73,3.73,2,1,1,"%D",1,0)
This cross reference keeps track of the dates on which messages
"^DD",3.73,3.73,2,1,1,"%D",2,0)
are scheduled to become new.
"^DD",3.73,3.73,2,1,1,"%D",3,0)
Each message may have many such dates.
"^DD",3.73,3.73,2,1,2,0)
3.73^AC^MUMPS
"^DD",3.73,3.73,2,1,2,1)
S %=^XMB(3.73,DA,0) S ^XMB(3.73,"AC",$P(%,U,3),$P(%,U,2),DA)="" K %
"^DD",3.73,3.73,2,1,2,2)
S %=^XMB(3.73,DA,0) K ^XMB(3.73,"AC",$P(%,U,3),$P(%,U,2),DA),%
"^DD",3.73,3.73,2,1,2,"%D",0)
^^2^2^2971229^^
"^DD",3.73,3.73,2,1,2,"%D",1,0)
This cross reference keeps track of messages which are scheduled to
"^DD",3.73,3.73,2,1,2,"%D",2,0)
become new for a particular mail box (user).
"^DD",3.73,3.73,2,1,2,"DT")
2900118
"^DD",3.73,3.73,2,12)
The user must be either the sender or the recipient of the message.
"^DD",3.73,3.73,2,12.1)
S DIC("S")="I $D(^XMB(3.9,X,0)),$P(^(0),U,2)=$S($D(XMDUZ):XMDUZ,1:DUZ)!$D(^XMB(3.9,X,1,""C"",$S($D(XMDUZ):XMDUZ,1:DUZ)))"
"^DD",3.73,3.73,2,21,0)
^^2^2^2881121^
"^DD",3.73,3.73,2,21,1,0)
This field indicates which message is to appear NEW at
"^DD",3.73,3.73,2,21,2,0)
a later date.
"^DD",3.73,3.73,2,"DT")
2900118
"^DD",3.8,3.8,0)
FIELD^NL^15^16
"^DD",3.8,3.8,0,"DDA")
Y
"^DD",3.8,3.8,0,"DT")
3020422
"^DD",3.8,3.8,0,"IX","AB",3.81,.01)

"^DD",3.8,3.8,0,"IX","AC",3.8,5.1)

"^DD",3.8,3.8,0,"IX","AD",3.811,.01)

"^DD",3.8,3.8,0,"IX","B",3.8,.01)

"^DD",3.8,3.8,0,"NM","MAIL GROUP")

"^DD",3.8,3.8,0,"PT",3.62,.01)

"^DD",3.8,3.8,0,"PT",3.811,.01)

"^DD",3.8,3.8,0,"PT",9.4,1938)

"^DD",3.8,3.8,0,"PT",19,222)

"^DD",3.8,3.8,0,"PT",8986.095,.5)

"^DD",3.8,3.8,0,"PT",8986.095,.51)

"^DD",3.8,3.8,.01,0)
NAME^RFX^^0;1^S:X?1"G.".E!(X?1"g.".E) X=$E(X,3,99) K:$L(X)>30!($L(X)<3)!'(X'?1P.E)!(X'?.ANP) X
"^DD",3.8,3.8,.01,.1)
MAIL GROUP NAME
"^DD",3.8,3.8,.01,1,0)
^.1
"^DD",3.8,3.8,.01,1,1,0)
3.8^B
"^DD",3.8,3.8,.01,1,1,1)
S ^XMB(3.8,"B",$E(X,1,30),DA)=""
"^DD",3.8,3.8,.01,1,1,2)
K ^XMB(3.8,"B",$E(X,1,30),DA)
"^DD",3.8,3.8,.01,1,2,0)
^^TRIGGER^3.8^5
"^DD",3.8,3.8,.01,1,2,1)
X ^DD(3.8,.01,1,2,1.3) I X S X=DIV S Y(1)=$S($D(^XMB(3.8,D0,3)):^(3),1:"") S X=$P(Y(1),U,1),X=X S DIU=X K Y S X=DIV S X=$G(XMDUZ,DUZ) S DIH=$G(^XMB(3.8,DIV(0),3)),DIV=X S $P(^(3),U,1)=DIV,DIH=3.8,DIG=5 D ^DICR
"^DD",3.8,3.8,.01,1,2,1.3)
K DIV S DIV=X,D0=DA,DIV(0)=D0 S Y(0)=X S Y(1)=$S($D(^XMB(3.8,D0,3)):^(3),1:"") S X=$S('$D(^VA(200,+$P(Y(1),U,1),0)):"",1:$P(^(0),U,1))=""
"^DD",3.8,3.8,.01,1,2,2)
Q
"^DD",3.8,3.8,.01,1,2,"%D",0)
^^2^2^3020425^
"^DD",3.8,3.8,.01,1,2,"%D",1,0)
When a user creates a mail group, this trigger makes that user
"^DD",3.8,3.8,.01,1,2,"%D",2,0)
the organizer of the group.  The user is free to change that field.  
"^DD",3.8,3.8,.01,1,2,"CREATE CONDITION")
ORGANIZER=""
"^DD",3.8,3.8,.01,1,2,"CREATE VALUE")
S X=$G(XMDUZ,DUZ)
"^DD",3.8,3.8,.01,1,2,"DELETE VALUE")
NO EFFECT
"^DD",3.8,3.8,.01,1,2,"DT")
3020425
"^DD",3.8,3.8,.01,1,2,"FIELD")
ORGANIZER
"^DD",3.8,3.8,.01,3)
ANSWER MUST BE 3-30 CHARACTERS IN LENGTH
"^DD",3.8,3.8,.01,21,0)
^^2^2^2921125^^^^
"^DD",3.8,3.8,.01,21,1,0)
The name of a mail group, i.e. a list of recipients who can
"^DD",3.8,3.8,.01,21,2,0)
all be addressed at once by reference to this name.
"^DD",3.8,3.8,.01,"DT")
3020425
"^DD",3.8,3.8,.01,"LAYGO",1,0)
I $$LAYGO^XMVGROUP(X)
"^DD",3.8,3.8,2,0)
MEMBER^3.81P^^1;0
"^DD",3.8,3.8,2,21,0)
^^2^2^2971007^^^^
"^DD",3.8,3.8,2,21,1,0)
A member of a Mail Group is a user to whom messages will be sent when the
"^DD",3.8,3.8,2,21,2,0)
message is addressed to this mail group.
"^DD",3.8,3.8,2,"DT")
2911126
"^DD",3.8,3.8,3,0)
DESCRIPTION^3.801^^2;0
"^DD",3.8,3.8,3,21,0)
^^1^1^2921125^^^
"^DD",3.8,3.8,3,21,1,0)
The definition and/or purpose of this mail group.
"^DD",3.8,3.8,4,0)
TYPE^RS^PU:public;PR:private;^0;2^Q
"^DD",3.8,3.8,4,.1)

"^DD",3.8,3.8,4,1,0)
^.1
"^DD",3.8,3.8,4,1,1,0)
^^TRIGGER^3.8^10
"^DD",3.8,3.8,4,1,1,1)
Q
"^DD",3.8,3.8,4,1,1,2)
K DIV S DIV=X,D0=DA,DIV(0)=D0 S Y(0)=X S Y(1)=$C(59)_$P($G(^DD(3.8,4,0)),U,3) S X=$P($P(Y(1),$C(59)_X_":",2),$C(59),1)="private" I X S X=DIV S Y(1)=$S($D(^XMB(3.8,D0,0)):^(0),1:"") S X=$P(Y(1),U,6),X=X S DIU=X K Y S X="" X ^DD(3.8,4,1,1,2.4)
"^DD",3.8,3.8,4,1,1,2.4)
S DIH=$G(^XMB(3.8,DIV(0),0)),DIV=X S $P(^(0),U,6)=DIV,DIH=3.8,DIG=10 D ^DICR
"^DD",3.8,3.8,4,1,1,"%D",0)
^^2^2^3010207^
"^DD",3.8,3.8,4,1,1,"%D",1,0)
When changing the TYPE from 'private' to 'public',
"^DD",3.8,3.8,4,1,1,"%D",2,0)
delete the RESTRICTIONS field, because it no longer applies.
"^DD",3.8,3.8,4,1,1,"CREATE VALUE")
NO EFFECT
"^DD",3.8,3.8,4,1,1,"DELETE CONDITION")
OLD TYPE="private"
"^DD",3.8,3.8,4,1,1,"DELETE VALUE")
@
"^DD",3.8,3.8,4,1,1,"DT")
3010207
"^DD",3.8,3.8,4,1,1,"FIELD")
RESTRICTIONS
"^DD",3.8,3.8,4,1,2,0)
^^TRIGGER^3.8^7
"^DD",3.8,3.8,4,1,2,1)
Q
"^DD",3.8,3.8,4,1,2,2)
K DIV S DIV=X,D0=DA,DIV(0)=D0 S Y(0)=X S Y(1)=$C(59)_$P($G(^DD(3.8,4,0)),U,3) S X=$P($P(Y(1),$C(59)_X_":",2),$C(59),1)="public" I X S X=DIV S Y(1)=$S($D(^XMB(3.8,D0,0)):^(0),1:"") S X=$P(Y(1),U,3),X=X S DIU=X K Y S X="" X ^DD(3.8,4,1,2,2.4)
"^DD",3.8,3.8,4,1,2,2.4)
S DIH=$G(^XMB(3.8,DIV(0),0)),DIV=X S $P(^(0),U,3)=DIV,DIH=3.8,DIG=7 D ^DICR
"^DD",3.8,3.8,4,1,2,"%D",0)
^^2^2^3010207^
"^DD",3.8,3.8,4,1,2,"%D",1,0)
When changing the TYPE from 'public' to 'private', delete the
"^DD",3.8,3.8,4,1,2,"%D",2,0)
ALLOW SELF ENROLLMENT? field, because it no longer applies.
"^DD",3.8,3.8,4,1,2,"CREATE VALUE")
NO EFFECT
"^DD",3.8,3.8,4,1,2,"DELETE CONDITION")
OLD TYPE="public"
"^DD",3.8,3.8,4,1,2,"DELETE VALUE")
@
"^DD",3.8,3.8,4,1,2,"DT")
3010207
"^DD",3.8,3.8,4,1,2,"FIELD")
ALLOW SELF ENROLLMENT?
"^DD",3.8,3.8,4,21,0)
^^5^5^2921125^^^^
"^DD",3.8,3.8,4,21,1,0)
The type of mail group determines who can send mail to it.
"^DD",3.8,3.8,4,21,2,0)
Provided there are no AUTHORIZED SENDERS specified, anyone can send mail
"^DD",3.8,3.8,4,21,3,0)
to a public group and only its members can send mail to a private group.
"^DD",3.8,3.8,4,21,4,0)
If there are AUTHORIZED SENDERS specified, only those users can address
"^DD",3.8,3.8,4,21,5,0)
the group.
"^DD",3.8,3.8,4,"DT")
3010207
"^DD",3.8,3.8,5,0)
ORGANIZER^P200'^VA(200,^3;1^Q
"^DD",3.8,3.8,5,.1)
The user who has organizer's privileges for the group.
"^DD",3.8,3.8,5,5,1,0)
3.8^.01^2
"^DD",3.8,3.8,5,21,0)
^^3^3^2921125^^^^
"^DD",3.8,3.8,5,21,1,0)
The user who has the privileges of an "Organizer" for
"^DD",3.8,3.8,5,21,2,0)
the mail group. For example, an organizer can add new members to a
"^DD",3.8,3.8,5,21,3,0)
"Private" mail group.
"^DD",3.8,3.8,5,"DT")
2910618
"^DD",3.8,3.8,5.1,0)
COORDINATOR^P200'^VA(200,^0;7^Q
"^DD",3.8,3.8,5.1,1,0)
^.1
"^DD",3.8,3.8,5.1,1,1,0)
3.8^AC
"^DD",3.8,3.8,5.1,1,1,1)
S ^XMB(3.8,"AC",$E(X,1,30),DA)=""
"^DD",3.8,3.8,5.1,1,1,2)
K ^XMB(3.8,"AC",$E(X,1,30),DA)
"^DD",3.8,3.8,5.1,1,1,"%D",0)
^^1^1^2940202^
"^DD",3.8,3.8,5.1,1,1,"%D",1,0)
This cross reference is to be used for listing mail groups for coordinators.
"^DD",3.8,3.8,5.1,1,1,"DT")
2940202
"^DD",3.8,3.8,5.1,3)
The person responsible for maintaining the membership of the mail group.
"^DD",3.8,3.8,5.1,21,0)
^^7^7^3020425^^
"^DD",3.8,3.8,5.1,21,1,0)
This field is used as a screen when a user tries to edit a mail group
"^DD",3.8,3.8,5.1,21,2,0)
that he is a coordinator of.  If the screen fails and the user does not
"^DD",3.8,3.8,5.1,21,3,0)
hold the XMMGR key, he cannot edit the mail group.
"^DD",3.8,3.8,5.1,21,4,0)
 
"^DD",3.8,3.8,5.1,21,5,0)
Even if the coordinator is REMOVED from the Mail System, this field will
"^DD",3.8,3.8,5.1,21,6,0)
remain to indicate who created the Mail Group if others can use it.  If it
"^DD",3.8,3.8,5.1,21,7,0)
is a Personal Group, it will be deleted.
"^DD",3.8,3.8,5.1,"DT")
3020425
"^DD",3.8,3.8,6,0)
AUTHORIZED SENDER^3.802P^^4;0
"^DD",3.8,3.8,6,21,0)
^^12^12^2981231^^^^
"^DD",3.8,3.8,6,21,1,0)
If you wish to restrict this mail group to only a limited set of senders,
"^DD",3.8,3.8,6,21,2,0)
name them in this field.  If no names are entered here, then it is assumed
"^DD",3.8,3.8,6,21,3,0)
that anyone may send mail to this group (if public), or only members
"^DD",3.8,3.8,6,21,4,0)
may send to it (if private).  
"^DD",3.8,3.8,6,21,5,0)
 
"^DD",3.8,3.8,6,21,6,0)
If a user attempts to send mail to a group which has one or more authorized
"^DD",3.8,3.8,6,21,7,0)
senders, but is not an authorized sender, then he is shown a list of
"^DD",3.8,3.8,6,21,8,0)
authorized senders.  He may send the message to them, and they may forward
"^DD",3.8,3.8,6,21,9,0)
it, if desired.
"^DD",3.8,3.8,6,21,10,0)

"^DD",3.8,3.8,6,21,11,0)
NOTE:  Remote users may not send mail to any local group which has
"^DD",3.8,3.8,6,21,12,0)
authorized senders
"^DD",3.8,3.8,7,0)
ALLOW SELF ENROLLMENT?^S^y:YES;n:NO;^0;3^Q
"^DD",3.8,3.8,7,3)
If users may join this group by themselves, say "YES"
"^DD",3.8,3.8,7,5,1,0)
3.8^4^2
"^DD",3.8,3.8,7,21,0)
^^3^3^2921125^^
"^DD",3.8,3.8,7,21,1,0)
If this field is set to "YES", then users may use the JOIN option to 
"^DD",3.8,3.8,7,21,2,0)
make themselves members of the group, or to drop their names from the
"^DD",3.8,3.8,7,21,3,0)
group.  This option is only operative with public groups.
"^DD",3.8,3.8,7,"DT")
2851028
"^DD",3.8,3.8,8,0)
REFERENCE COUNT^NJ6,0^^0;4^K:+X'=X!(X>999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",3.8,3.8,8,3)
TYPE A WHOLE NUMBER BETWEEN 0 AND 999999
"^DD",3.8,3.8,8,21,0)
^^3^3^2921125^^^
"^DD",3.8,3.8,8,21,1,0)
This is a count of the number of times this mailgroup has been
"^DD",3.8,3.8,8,21,2,0)
used as a recipient of a message.  This will help site managers
"^DD",3.8,3.8,8,21,3,0)
monitor the activity of mail groups.
"^DD",3.8,3.8,8,"DT")
2860212
"^DD",3.8,3.8,9,0)
LAST REFERENCED^D^^0;5^S %DT="E" D ^%DT S X=Y K:Y<1 X
"^DD",3.8,3.8,9,21,0)
^^1^1^3020422^^
"^DD",3.8,3.8,9,21,1,0)
This is the date on which this mail group was last referenced.
"^DD",3.8,3.8,9,"DT")
3020422
"^DD",3.8,3.8,10,0)
RESTRICTIONS^S^0:UNRESTRICTED;1:ORGANIZER ONLY;^0;6^Q
"^DD",3.8,3.8,10,3)
Enter restriction code for private group.
"^DD",3.8,3.8,10,5,1,0)
3.8^4^1
"^DD",3.8,3.8,10,21,0)
^.001^13^13^3010208^^^^
"^DD",3.8,3.8,10,21,1,0)
This field is only applicable for PRIVATE mail groups.
"^DD",3.8,3.8,10,21,2,0)
It is ignored for PUBLIC mail groups.
"^DD",3.8,3.8,10,21,3,0)
 
"^DD",3.8,3.8,10,21,4,0)
This field controls who may address (send messages to) this
"^DD",3.8,3.8,10,21,5,0)
PRIVATE mail group.
"^DD",3.8,3.8,10,21,6,0)
 
"^DD",3.8,3.8,10,21,7,0)
If 0 (zero) or null, then the group is unrestricted, and all
"^DD",3.8,3.8,10,21,8,0)
members may address the group.
"^DD",3.8,3.8,10,21,9,0)
 
"^DD",3.8,3.8,10,21,10,0)
If 1, then only the organizer may address the group.
"^DD",3.8,3.8,10,21,11,0)
The group is a personal group.
"^DD",3.8,3.8,10,21,12,0)

"^DD",3.8,3.8,10,21,13,0)
Note that non-members cannot address private mail groups.
"^DD",3.8,3.8,10,"DT")
3010206
"^DD",3.8,3.8,11,0)
MEMBER GROUPS^3.811P^^5;0
"^DD",3.8,3.8,11,21,0)
^^6^6^2911219^^^
"^DD",3.8,3.8,11,21,1,0)
Member Groups are mail groups that are members of this mail group.  When
"^DD",3.8,3.8,11,21,2,0)
a Mail Group is made a member of another in this fashion, the individuals
"^DD",3.8,3.8,11,21,3,0)
of it are added to the mailing list at delivery time.
"^DD",3.8,3.8,11,21,4,0)
 
"^DD",3.8,3.8,11,21,5,0)
Member groups will not be processed by MailMan if the 'Restrictions' field
"^DD",3.8,3.8,11,21,6,0)
is set to '3' or '7'.  The entries in the multiple will be ignored.
"^DD",3.8,3.8,11,"DT")
2920716
"^DD",3.8,3.8,12,0)
MEMBERS - REMOTE^3.812^^6;0
"^DD",3.8,3.8,12,21,0)
^^4^4^2990219^^^^
"^DD",3.8,3.8,12,21,1,0)
This multiple contains remote addresses or local devices or local servers.
"^DD",3.8,3.8,12,21,2,0)
The input to the field is checked for validity at the time it is entered.
"^DD",3.8,3.8,12,21,3,0)
If the address BECOMES INCORRECT MailMan will try to inform
"^DD",3.8,3.8,12,21,4,0)
a responsible person of the non-delivery of a message.
"^DD",3.8,3.8,12,"DT")
2940811
"^DD",3.8,3.8,13,0)
DISTRIBUTION LIST^3.813P^^7;0
"^DD",3.8,3.8,13,21,0)
^^3^3^2901026^
"^DD",3.8,3.8,13,21,1,0)
This field will allow distribution lists to be included in Mail Groups.
"^DD",3.8,3.8,13,21,2,0)
In this way a message that must be sent to the same name at many domains
"^DD",3.8,3.8,13,21,3,0)
may easily be included in the recipient chain of a message.
"^DD",3.8,3.8,14,0)
FAX RECIPIENT^3.814P^^8;0
"^DD",3.8,3.8,14,"DT")
2970211
"^DD",3.8,3.8,15,0)
FAX GROUP^3.815P^^9;0
"^DD",3.8,3.8,15,"DT")
2970211
"^DD",3.8,3.801,0)
DESCRIPTION SUB-FIELD^NL^.01^1
"^DD",3.8,3.801,0,"NM","DESCRIPTION")

"^DD",3.8,3.801,0,"UP")
3.8
"^DD",3.8,3.801,.01,0)
DESCRIPTION^W^^0;1^Q
"^DD",3.8,3.801,.01,.1)
A short description of the purpose of the mail group
"^DD",3.8,3.801,.01,21,0)
^^1^1^2921125^^^
"^DD",3.8,3.801,.01,21,1,0)
The definition and/or purpose of this mail group.
"^DD",3.8,3.801,.01,"DT")
2831004
"^DD",3.8,3.802,0)
AUTHORIZED SENDER SUB-FIELD^NL^.01^1
"^DD",3.8,3.802,0,"DT")
2910618
"^DD",3.8,3.802,0,"IX","B",3.802,.01)

"^DD",3.8,3.802,0,"NM","AUTHORIZED SENDER")

"^DD",3.8,3.802,0,"UP")
3.8
"^DD",3.8,3.802,.01,0)
AUTHORIZED SENDER^MP200'^VA(200,^0;1^Q
"^DD",3.8,3.802,.01,1,0)
^.1
"^DD",3.8,3.802,.01,1,1,0)
3.802^B
"^DD",3.8,3.802,.01,1,1,1)
S ^XMB(3.8,DA(1),4,"B",$E(X,1,30),DA)=""
"^DD",3.8,3.802,.01,1,1,2)
K ^XMB(3.8,DA(1),4,"B",$E(X,1,30),DA)
"^DD",3.8,3.802,.01,3)
Enter name of user who may address this group, if it is to be limited
"^DD",3.8,3.802,.01,21,0)
^^9^9^2981231^^
"^DD",3.8,3.802,.01,21,1,0)
This subfile records user numbers of those users who have the
"^DD",3.8,3.802,.01,21,2,0)
exclusive privilege of addressing the mail group.  Messages sent
"^DD",3.8,3.802,.01,21,3,0)
by other users will reach the group only if forwarded by an authorized 
"^DD",3.8,3.802,.01,21,4,0)
sender.  The authorized senders receive all mail addressed to the
"^DD",3.8,3.802,.01,21,5,0)
group.
"^DD",3.8,3.802,.01,21,6,0)

"^DD",3.8,3.802,.01,21,7,0)
WARNING:  If a group has authorized senders, then remote users will not
"^DD",3.8,3.802,.01,21,8,0)
be able to send messages to it.  Any messages sent by a remote user to
"^DD",3.8,3.802,.01,21,9,0)
a group with authorized senders will be rejected.
"^DD",3.8,3.802,.01,"DT")
2910618
"^DD",3.8,3.81,0)
MEMBER SUB-FIELD^NL^1^2
"^DD",3.8,3.81,0,"DT")
2990308
"^DD",3.8,3.81,0,"NM","MEMBER")

"^DD",3.8,3.81,0,"UP")
3.8
"^DD",3.8,3.81,.01,0)
MEMBER^M*P200'^VA(200,^0;1^S DIC("S")="I $L($P(^(0),U,3)),$D(^XMB(3.7,+Y,0))" D ^DIC K DIC S DIC=DIE,X=+Y K:Y<0 X
"^DD",3.8,3.81,.01,.1)
Local Member
"^DD",3.8,3.81,.01,1,0)
^.1^^-1
"^DD",3.8,3.81,.01,1,2,0)
3.8^AB
"^DD",3.8,3.81,.01,1,2,1)
S ^XMB(3.8,"AB",$E(X,1,30),DA(1),DA)=""
"^DD",3.8,3.81,.01,1,2,2)
K ^XMB(3.8,"AB",$E(X,1,30),DA(1),DA)
"^DD",3.8,3.81,.01,1,2,"DT")
2990727
"^DD",3.8,3.81,.01,3)
Enter a local user who should receive mail addressed to this group.
"^DD",3.8,3.81,.01,12)
User must have an access code and a mailbox.
"^DD",3.8,3.81,.01,12.1)
S DIC("S")="I $L($P(^(0),U,3)),$D(^XMB(3.7,+Y,0))"
"^DD",3.8,3.81,.01,21,0)
^^2^2^2990308^^^^
"^DD",3.8,3.81,.01,21,1,0)
The local user who is a member of this mail group.
"^DD",3.8,3.81,.01,21,2,0)
The user must have an access code and a mailbox.
"^DD",3.8,3.81,.01,"DT")
3010212
"^DD",3.8,3.81,1,0)
TYPE^S^C:CC;I:INFO;^0;2^Q
"^DD",3.8,3.81,1,21,0)
^^11^11^2990227^^^
"^DD",3.8,3.81,1,21,1,0)
This field indicates what type of recipient this is.
"^DD",3.8,3.81,1,21,2,0)

"^DD",3.8,3.81,1,21,3,0)
If this field has nothing in it, it indicates that this recipient is
"^DD",3.8,3.81,1,21,4,0)
a primary recipient, and may reply.
"^DD",3.8,3.81,1,21,5,0)

"^DD",3.8,3.81,1,21,6,0)
CC:  indicates that the recipient is being sent a copy, but is not the
"^DD",3.8,3.81,1,21,7,0)
primary recipient.  The recipient may reply.
"^DD",3.8,3.81,1,21,8,0)
 
"^DD",3.8,3.81,1,21,9,0)
INFO: indicates that the recipient may not reply to the message; the
"^DD",3.8,3.81,1,21,10,0)
message is being transmitted to the recipient for information purposes
"^DD",3.8,3.81,1,21,11,0)
only.
"^DD",3.8,3.81,1,"DT")
2990225
"^DD",3.8,3.811,0)
MEMBER GROUPS SUB-FIELD^^1^2
"^DD",3.8,3.811,0,"DT")
3020422
"^DD",3.8,3.811,0,"IX","B",3.811,.01)

"^DD",3.8,3.811,0,"NM","MEMBER GROUPS")

"^DD",3.8,3.811,0,"UP")
3.8
"^DD",3.8,3.811,.01,0)
MEMBER GROUP NAME^M*P3.8'^XMB(3.8,^0;1^S DIC("S")="I Y'=DA" D ^DIC K DIC S DIC=DIE,X=+Y K:Y<0 X
"^DD",3.8,3.811,.01,1,0)
^.1
"^DD",3.8,3.811,.01,1,1,0)
3.811^B
"^DD",3.8,3.811,.01,1,1,1)
S ^XMB(3.8,DA(1),5,"B",$E(X,1,30),DA)=""
"^DD",3.8,3.811,.01,1,1,2)
K ^XMB(3.8,DA(1),5,"B",$E(X,1,30),DA)
"^DD",3.8,3.811,.01,1,2,0)
3.8^AD
"^DD",3.8,3.811,.01,1,2,1)
S ^XMB(3.8,"AD",$E(X,1,30),DA(1),DA)=""
"^DD",3.8,3.811,.01,1,2,2)
K ^XMB(3.8,"AD",$E(X,1,30),DA(1),DA)
"^DD",3.8,3.811,.01,1,2,"%D",0)
^^1^1^3000503^
"^DD",3.8,3.811,.01,1,2,"%D",1,0)
Shows groups to which a group belongs.
"^DD",3.8,3.811,.01,1,2,"DT")
3000503
"^DD",3.8,3.811,.01,3)
If you would like another mail group to be a member of this one enter a partial match to its name.
"^DD",3.8,3.811,.01,12)
A mail group may not be a member of itself.
"^DD",3.8,3.811,.01,12.1)
S DIC("S")="I Y'=DA"
"^DD",3.8,3.811,.01,21,0)
^.001^2^2^3020422^^^^
"^DD",3.8,3.811,.01,21,1,0)
This is a pointer to another entry in this Mail Group file.
"^DD",3.8,3.811,.01,21,2,0)
See the description of the multiple for more information.
"^DD",3.8,3.811,.01,"DT")
3020422
"^DD",3.8,3.811,1,0)
TYPE^S^C:CC;I:INFO;^0;2^Q
"^DD",3.8,3.811,1,21,0)
^^11^11^2990225^
"^DD",3.8,3.811,1,21,1,0)
This field indicates what type of recipient this is.
"^DD",3.8,3.811,1,21,2,0)

"^DD",3.8,3.811,1,21,3,0)
If this field has nothing in it, it indicates that this recipient is
"^DD",3.8,3.811,1,21,4,0)
a primary recipient, and may reply.
"^DD",3.8,3.811,1,21,5,0)

"^DD",3.8,3.811,1,21,6,0)
CC:  indicates that the recipient is being sent a copy, but is not the
"^DD",3.8,3.811,1,21,7,0)
primary recipient.  The recipient may reply.
"^DD",3.8,3.811,1,21,8,0)

"^DD",3.8,3.811,1,21,9,0)
INFO: indicates that the recipient may not reply to the message; the
"^DD",3.8,3.811,1,21,10,0)
message is being transmitted to the recipient for information purposes
"^DD",3.8,3.811,1,21,11,0)
only.
"^DD",3.8,3.811,1,"DT")
2990225
"^DD",3.8,3.812,0)
MEMBERS - REMOTE SUB-FIELD^^.01^1
"^DD",3.8,3.812,0,"IX","B",3.812,.01)

"^DD",3.8,3.812,0,"NM","MEMBERS - REMOTE")

"^DD",3.8,3.812,0,"UP")
3.8
"^DD",3.8,3.812,.01,0)
REMOTE MEMBER^MFX^^0;1^D REMOTE^XMVGROUP(.X,$G(XMIA)) I $D(X) K:$L(X)>99 X
"^DD",3.8,3.812,.01,1,0)
^.1
"^DD",3.8,3.812,.01,1,1,0)
3.812^B
"^DD",3.8,3.812,.01,1,1,1)
S ^XMB(3.8,DA(1),6,"B",$E(X,1,30),DA)=""
"^DD",3.8,3.812,.01,1,1,2)
K ^XMB(3.8,DA(1),6,"B",$E(X,1,30),DA)
"^DD",3.8,3.812,.01,3)
Enter a remote address (name@domain) or local device (D.device or H.device) or local server (S.server).
"^DD",3.8,3.812,.01,21,0)
^^2^2^2990308^^^^
"^DD",3.8,3.812,.01,21,1,0)
This is a free text, validated (at the time you enter it) remote address
"^DD",3.8,3.812,.01,21,2,0)
or local device or local server.
"^DD",3.8,3.812,.01,"DT")
3020422
"^DD",3.8,3.813,0)
DISTRIBUTION LIST SUB-FIELD^^.01^1
"^DD",3.8,3.813,0,"IX","B",3.813,.01)

"^DD",3.8,3.813,0,"NM","DISTRIBUTION LIST")

"^DD",3.8,3.813,0,"UP")
3.8
"^DD",3.8,3.813,.01,0)
DISTRIBUTION LIST^MP3.816^XMB(3.816,^0;1^Q
"^DD",3.8,3.813,.01,1,0)
^.1
"^DD",3.8,3.813,.01,1,1,0)
3.813^B
"^DD",3.8,3.813,.01,1,1,1)
S ^XMB(3.8,DA(1),7,"B",$E(X,1,30),DA)=""
"^DD",3.8,3.813,.01,1,1,2)
K ^XMB(3.8,DA(1),7,"B",$E(X,1,30),DA)
"^DD",3.8,3.813,.01,"DT")
2901026
"^DD",3.8,3.814,0)
FAX RECIPIENT SUB-FIELD^^.01^1
"^DD",3.8,3.814,0,"DT")
2970113
"^DD",3.8,3.814,0,"IX","B",3.814,.01)

"^DD",3.8,3.814,0,"NM","FAX RECIPIENT")

"^DD",3.8,3.814,0,"UP")
3.8
"^DD",3.8,3.814,.01,0)
FAX RECIPIENT^MP589499'^AKF("FAXR",^0;1^Q
"^DD",3.8,3.814,.01,1,0)
^.1
"^DD",3.8,3.814,.01,1,1,0)
3.814^B
"^DD",3.8,3.814,.01,1,1,1)
S ^XMB(3.8,DA(1),8,"B",$E(X,1,30),DA)=""
"^DD",3.8,3.814,.01,1,1,2)
K ^XMB(3.8,DA(1),8,"B",$E(X,1,30),DA)
"^DD",3.8,3.814,.01,3)
Enter the fax recipient who should receive faxes sent to this mail group.
"^DD",3.8,3.814,.01,21,0)
^^3^3^2970211^^^^
"^DD",3.8,3.814,.01,21,1,0)
This is a list of individual recipients who will receive by fax any mail sent
"^DD",3.8,3.814,.01,21,2,0)
to this mail group.  They receive the original message only.  They do not
"^DD",3.8,3.814,.01,21,3,0)
receive responses. 
"^DD",3.8,3.814,.01,"DT")
2970211
"^DD",3.8,3.815,0)
FAX GROUP SUB-FIELD^^.01^1
"^DD",3.8,3.815,0,"DT")
2970114
"^DD",3.8,3.815,0,"IX","B",3.815,.01)

"^DD",3.8,3.815,0,"NM","FAX GROUP")

"^DD",3.8,3.815,0,"UP")
3.8
"^DD",3.8,3.815,.01,0)
FAX GROUP^M*P589498'^AKF("FAXG",^0;1^S DIC("S")="N XM S XM=$G(^(3)) I $P(XM,U,2)!($G(XMDUZ,DUZ)=+XM)" D ^DIC K DIC S DIC=DIE,X=+Y K:Y<0 X
"^DD",3.8,3.815,.01,1,0)
^.1
"^DD",3.8,3.815,.01,1,1,0)
3.815^B
"^DD",3.8,3.815,.01,1,1,1)
S ^XMB(3.8,DA(1),9,"B",$E(X,1,30),DA)=""
"^DD",3.8,3.815,.01,1,1,2)
K ^XMB(3.8,DA(1),9,"B",$E(X,1,30),DA)
"^DD",3.8,3.815,.01,3)
Enter the fax group which should receive faxes sent to this mail group.
"^DD",3.8,3.815,.01,12)
Group must be public or user must be (surrogate of) creator of group.
"^DD",3.8,3.815,.01,12.1)
S DIC("S")="N XM S XM=$G(^(3)) I $P(XM,U,2)!($G(XMDUZ,DUZ)=+XM)"
"^DD",3.8,3.815,.01,21,0)
^^2^2^2970114^^^^
"^DD",3.8,3.815,.01,21,1,0)
Each member of the fax group will receive by fax any message sent to this mail
"^DD",3.8,3.815,.01,21,2,0)
group.  Only the original message will be faxed.  Responses will not be faxed.
"^DD",3.8,3.815,.01,"DT")
2970211
"^DD",3.816,3.816,0)
FIELD^^1^2
"^DD",3.816,3.816,0,"DDA")
N
"^DD",3.816,3.816,0,"DT")
2901026
"^DD",3.816,3.816,0,"IX","B",3.816,.01)

"^DD",3.816,3.816,0,"NM","DISTRIBUTION LIST")

"^DD",3.816,3.816,0,"PT",3.813,.01)

"^DD",3.816,3.816,.01,0)
NAME^RF^^0;1^K:$L(X)>30!(X?.N)!($L(X)<3)!'(X'?1P.E) X
"^DD",3.816,3.816,.01,1,0)
^.1
"^DD",3.816,3.816,.01,1,1,0)
3.816^B
"^DD",3.816,3.816,.01,1,1,1)
S ^XMB(3.816,"B",$E(X,1,30),DA)=""
"^DD",3.816,3.816,.01,1,1,2)
K ^XMB(3.816,"B",$E(X,1,30),DA)
"^DD",3.816,3.816,.01,3)
NAME MUST BE 3-30 CHARACTERS, NOT NUMERIC OR STARTING WITH PUNCTUATION
"^DD",3.816,3.816,.01,21,0)
^^1^1^2931213^
"^DD",3.816,3.816,.01,21,1,0)
This is the name of the distribution list.
"^DD",3.816,3.816,.01,23,0)
^^2^2^2931213^
"^DD",3.816,3.816,.01,23,1,0)
If it does not start with D. or S. or P., it is assumed to begin
"^DD",3.816,3.816,.01,23,2,0)
with G.
"^DD",3.816,3.816,1,0)
DOMAIN^3.8161P^^1;0
"^DD",3.816,3.8161,0)
DOMAIN SUB-FIELD^^.01^1
"^DD",3.816,3.8161,0,"DT")
2901026
"^DD",3.816,3.8161,0,"IX","B",3.8161,.01)

"^DD",3.816,3.8161,0,"NM","DOMAIN")

"^DD",3.816,3.8161,0,"UP")
3.816
"^DD",3.816,3.8161,.01,0)
DOMAIN^MP4.2'^DIC(4.2,^0;1^Q
"^DD",3.816,3.8161,.01,1,0)
^.1
"^DD",3.816,3.8161,.01,1,1,0)
3.8161^B
"^DD",3.816,3.8161,.01,1,1,1)
S ^XMB(3.816,DA(1),1,"B",$E(X,1,30),DA)=""
"^DD",3.816,3.8161,.01,1,1,2)
K ^XMB(3.816,DA(1),1,"B",$E(X,1,30),DA)
"^DD",3.816,3.8161,.01,3)
Each domain is concatenated to the NAME field to create recipients for a mail group that points to this distribution list.
"^DD",3.816,3.8161,.01,21,0)
^^2^2^2931214^
"^DD",3.816,3.8161,.01,21,1,0)
This is a list of domains that will be contenated to the name of the
"^DD",3.816,3.8161,.01,21,2,0)
distribution list to form remote addresses.
"^DD",3.816,3.8161,.01,"DT")
2901026
"^DD",3.9,3.9,0)
FIELD^NL^2005^25
"^DD",3.9,3.9,0,"DDA")
Y
"^DD",3.9,3.9,0,"DT")
3011128
"^DD",3.9,3.9,0,"IX","AI",3.9,9)

"^DD",3.9,3.9,0,"IX","AL",3.914,4)

"^DD",3.9,3.9,0,"IX","AW",3.914,2)

"^DD",3.9,3.9,0,"IX","B",3.9,.01)

"^DD",3.9,3.9,0,"IX","C",3.9,31)

"^DD",3.9,3.9,0,"NM","MESSAGE")

"^DD",3.9,3.9,0,"PT",1.12,.06)

"^DD",3.9,3.9,0,"PT",3.7,5)

"^DD",3.9,3.9,0,"PT",3.7,7)

"^DD",3.9,3.9,0,"PT",3.702,.01)

"^DD",3.9,3.9,0,"PT",3.73,2)

"^DD",3.9,3.9,0,"PT",3.9,1.35)

"^DD",3.9,3.9,0,"PT",3.9001,.01)

"^DD",3.9,3.9,0,"PT",4.2999,2)

"^DD",3.9,3.9,0,"SCR")
I $S('$D(DUZ):0,'$D(^XMB(3.9,+Y,0)):0,$P(^(0),U,2)=DUZ:1,$D(^(1,"C",DUZ)):1,$D(^("* (Broadcast to all local user")):1,1:0)
"^DD",3.9,3.9,0,"VRPK")
XM
"^DD",3.9,3.9,.001,0)
NUMBER^NJ15,0I^^ ^K:+X'=X!(X>999999999999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",3.9,3.9,.001,.1)
A unique number assigned to each message, never reused
"^DD",3.9,3.9,.001,3)
Type a Number between 0 and 999999999999999, 0 Decimal Digits
"^DD",3.9,3.9,.001,21,0)
^^13^13^3020325^^^
"^DD",3.9,3.9,.001,21,1,0)
This is the unique number which is assigned to a message at the time
"^DD",3.9,3.9,.001,21,2,0)
it is entered into the system.  Messages are numbered sequentially.
"^DD",3.9,3.9,.001,21,3,0)
Numbers may be re-used if numbers get too big.  See field 17.1, MAX
"^DD",3.9,3.9,.001,21,4,0)
DIGITS FOR MESSAGE NUMBER in file 4.3, MailMan Site Parameters, for
"^DD",3.9,3.9,.001,21,5,0)
more information.
"^DD",3.9,3.9,.001,21,6,0)

"^DD",3.9,3.9,.001,21,7,0)
Numbers appear in the "Query" listing for the message, as
"^DD",3.9,3.9,.001,21,8,0)
<number>@<domain name>, where <number> is the message number for this
"^DD",3.9,3.9,.001,21,9,0)
message, and <domain name> is the name of the domain, as defined in
"^DD",3.9,3.9,.001,21,10,0)
the file 4.3.  This combination of number and domain name uniquely
"^DD",3.9,3.9,.001,21,11,0)
identifies ALL messages in the mailman network, and editing control
"^DD",3.9,3.9,.001,21,12,0)
is such that no two copies of the message at different domains are
"^DD",3.9,3.9,.001,21,13,0)
different; the message is either identical or missing.
"^DD",3.9,3.9,.001,"DT")
3020325
"^DD",3.9,3.9,.01,0)
SUBJECT^RFOX^^0;1^K:X[""""!($A(X)=45) X I $D(X) S X=$$STRIP^XMXUTIL1(X),X=$$MAXBLANK^XMXUTIL1(X) K:$L(X)>65!($L(X)<3) X I $D(X),X["^" S X=$$ENCODEUP^XMXUTIL1(X)
"^DD",3.9,3.9,.01,.1)
A short, descriptive title to the message.
"^DD",3.9,3.9,.01,1,0)
^.1
"^DD",3.9,3.9,.01,1,1,0)
3.9^B
"^DD",3.9,3.9,.01,1,1,1)
S ^XMB(3.9,"B",$E(X,1,30),DA)=""
"^DD",3.9,3.9,.01,1,1,2)
K ^XMB(3.9,"B",$E(X,1,30),DA)
"^DD",3.9,3.9,.01,2)
S Y(0)=Y S:Y["~U~" Y=$$DECODEUP^XMXUTIL1(Y)
"^DD",3.9,3.9,.01,2.1)
S:Y["~U~" Y=$$DECODEUP^XMXUTIL1(Y)
"^DD",3.9,3.9,.01,3)
Answer must be 3-65 characters in length.
"^DD",3.9,3.9,.01,21,0)
^^4^4^2970811^^^^
"^DD",3.9,3.9,.01,21,1,0)
This is the subject of the message, and is shown whenever the message is
"^DD",3.9,3.9,.01,21,2,0)
displayed.
"^DD",3.9,3.9,.01,21,3,0)
Leading and trailing blanks are deleted.
"^DD",3.9,3.9,.01,21,4,0)
Any sequence of 3 or more blanks is reduced to 2 blanks.
"^DD",3.9,3.9,.01,23,0)
^^3^3^2970811^
"^DD",3.9,3.9,.01,23,1,0)
If the message happens to be a local reply, the message subject will be "R"
"^DD",3.9,3.9,.01,23,2,0)
followed by the message number of the original message for which this is a
"^DD",3.9,3.9,.01,23,3,0)
response.  This text contains ~U~ if the subject contains an up-arrow. 
"^DD",3.9,3.9,.01,"DEL",1,0)
I 1 W *7,"   DELETION ONLY ALLOWED THROUGH MANAGER 'PURGE'"
"^DD",3.9,3.9,.01,"DT")
2980526
"^DD",3.9,3.9,1,0)
FROM^RFI^^0;2^K:$L(X)>70!($L(X)<0) X
"^DD",3.9,3.9,1,.1)
The User number of who the message is from, or his network name if remote
"^DD",3.9,3.9,1,1,0)
^.1^^0
"^DD",3.9,3.9,1,3)
Answer must be 0-70 characters in length.
"^DD",3.9,3.9,1,21,0)
^^4^4^2970813^^^^
"^DD",3.9,3.9,1,21,1,0)
This is who the message is from.  In the case of
"^DD",3.9,3.9,1,21,2,0)
a local message, this is the internal entry number of the user in the
"^DD",3.9,3.9,1,21,3,0)
NEW PERSON file.  In the case of a networked message, it is the user's full
"^DD",3.9,3.9,1,21,4,0)
network address, in the format <user@domain>.
"^DD",3.9,3.9,1,23,0)
^^1^1^2970813^^
"^DD",3.9,3.9,1,23,1,0)
In a future patch, the field should be made longer, perhaps to 99.
"^DD",3.9,3.9,1,"DT")
2970813
"^DD",3.9,3.9,1.1,0)
SENDER^FI^^0;4^K:$L(X)>30!($L(X)<0) X
"^DD",3.9,3.9,1.1,.1)
The person who entered the message, if not the same as FROM
"^DD",3.9,3.9,1.1,3)
ANSWER MUST BE 0-30 CHARACTERS IN LENGTH
"^DD",3.9,3.9,1.1,21,0)
^^5^5^2990106^^^^
"^DD",3.9,3.9,1.1,21,1,0)
If the message is sent by a surrogate, this field holds the surrogate's
"^DD",3.9,3.9,1.1,21,2,0)
identity.
"^DD",3.9,3.9,1.1,21,3,0)

"^DD",3.9,3.9,1.1,21,4,0)
It is displayed on the message header in parentheses, with the text
"^DD",3.9,3.9,1.1,21,5,0)
SENDER: preceding the sender's name.
"^DD",3.9,3.9,1.1,"DT")
2851004
"^DD",3.9,3.9,1.3,0)
CONFIRMATION REQUESTED?^S^y:YES;n:NO;^0;5^Q
"^DD",3.9,3.9,1.3,.1)

"^DD",3.9,3.9,1.3,21,0)
^^2^2^2860211^^
"^DD",3.9,3.9,1.3,21,1,0)
This specifies whether or not the sender of a message will get an
"^DD",3.9,3.9,1.3,21,2,0)
acknowledgement when the message is read by the recipient.
"^DD",3.9,3.9,1.3,"DT")
2970728
"^DD",3.9,3.9,1.35,0)
ORIGINAL MESSAGE^P3.9'^XMB(3.9,^0;8^Q
"^DD",3.9,3.9,1.35,.1)
Original Message Number response points to
"^DD",3.9,3.9,1.35,3)

"^DD",3.9,3.9,1.35,21,0)
^^2^2^2970811^^^^
"^DD",3.9,3.9,1.35,21,1,0)
This field is used for responses only.
"^DD",3.9,3.9,1.35,21,2,0)
If this message is a response, this field points to the original message.
"^DD",3.9,3.9,1.35,"DT")
2880722
"^DD",3.9,3.9,1.4,0)
SENT DATE/TIME^D^^0;3^S %DT="ETXR" D ^%DT S X=Y K:Y<1 X
"^DD",3.9,3.9,1.4,.1)
The date and time the message was sent.
"^DD",3.9,3.9,1.4,1,0)
^.1^^0
"^DD",3.9,3.9,1.4,21,0)
^^6^6^2970730^^^^
"^DD",3.9,3.9,1.4,21,1,0)
This is the date and time at which this message was sent.  It relates
"^DD",3.9,3.9,1.4,21,2,0)
to the completion of the sending process, not the beginning, as previous
"^DD",3.9,3.9,1.4,21,3,0)
versions did.
"^DD",3.9,3.9,1.4,21,4,0)
Initiation and initial sending can be separated by days, e.g. due to
"^DD",3.9,3.9,1.4,21,5,0)
equipment failure or illness of the sender, the time of the first send,
"^DD",3.9,3.9,1.4,21,6,0)
rather than the time message editing began, is retained.
"^DD",3.9,3.9,1.4,23,0)
^^5^5^2970811^
"^DD",3.9,3.9,1.4,23,1,0)
In a future patch, as remote messages arrive, their date should be
"^DD",3.9,3.9,1.4,23,2,0)
converted from clear text to FM, using CONVERT^XMA32A.
"^DD",3.9,3.9,1.4,23,3,0)
If conversion is not possible, the current date/time should be used.
"^DD",3.9,3.9,1.4,23,4,0)
Currently, the DD to the contrary, the clear text version of the date
"^DD",3.9,3.9,1.4,23,5,0)
of the remote message is placed in this field.
"^DD",3.9,3.9,1.4,"DT")
2970730
"^DD",3.9,3.9,1.6,0)
PURGE DATE^DX^^0;6^S %DT="FEST" D ^%DT S X=Y K:Y<1 X
"^DD",3.9,3.9,1.6,3)
Enter a date in the future when this message should be purged.
"^DD",3.9,3.9,1.6,21,0)
^.001^2^2^3001024^^^^
"^DD",3.9,3.9,1.6,21,1,0)
This message will be set for all recipients to automatically delete on
"^DD",3.9,3.9,1.6,21,2,0)
this date.
"^DD",3.9,3.9,1.6,23,0)
^.001^3^3^3001024^^^^
"^DD",3.9,3.9,1.6,23,1,0)
As the message is delivered to each recipient, the AUTOMATIC DELETE DATE
"^DD",3.9,3.9,1.6,23,2,0)
for the message in the recipient's basket is set to this purge date.
"^DD",3.9,3.9,1.6,23,3,0)
The recipient is free, of course, to change the AUTOMATIC DELETE DATE.
"^DD",3.9,3.9,1.6,"DT")
3001025
"^DD",3.9,3.9,1.7,0)
MESSAGE TYPE^F^^0;7^K:$L(X)>3!($L(X)<1) X
"^DD",3.9,3.9,1.7,.1)

"^DD",3.9,3.9,1.7,3)
Answer must be 1-3 characters in length.
"^DD",3.9,3.9,1.7,21,0)
^^17^17^3020422^^^^
"^DD",3.9,3.9,1.7,21,1,0)
This field enables MailMan to differentiate among types of messages.
"^DD",3.9,3.9,1.7,21,2,0)
Spooled documents must be handled partially through an interface to the
"^DD",3.9,3.9,1.7,21,3,0)
'spooler'.  Word processing documents are handled differently from
"^DD",3.9,3.9,1.7,21,4,0)
ordinary messages.
"^DD",3.9,3.9,1.7,21,5,0)
 
"^DD",3.9,3.9,1.7,21,6,0)
This field is set within MailMan to any combination of the valid codes,
"^DD",3.9,3.9,1.7,21,7,0)
e.g. "XPB" would indicate a PackMan message which includes a BLOB,
"^DD",3.9,3.9,1.7,21,8,0)
and marked by the user for priority delivery.
"^DD",3.9,3.9,1.7,21,9,0)

"^DD",3.9,3.9,1.7,21,10,0)
 TYPE   MEANING
"^DD",3.9,3.9,1.7,21,11,0)
 D      Document
"^DD",3.9,3.9,1.7,21,12,0)
 S      Spooled Document
"^DD",3.9,3.9,1.7,21,13,0)
 X      DIFROM (PackMan) Installable Message
"^DD",3.9,3.9,1.7,21,14,0)
 O      ODIF Format
"^DD",3.9,3.9,1.7,21,15,0)
 B      BLOB (eg. MIME) contained within
"^DD",3.9,3.9,1.7,21,16,0)
 K      KIDS Distribution
"^DD",3.9,3.9,1.7,21,17,0)
 P      Priority
"^DD",3.9,3.9,1.7,"DT")
3020422
"^DD",3.9,3.9,1.8,0)
SCRAMBLE HINT^F^^0;10^K:$L(X)>40!($L(X)<1) X
"^DD",3.9,3.9,1.8,.1)

"^DD",3.9,3.9,1.8,3)
Answer must be 1-40 characters in length.
"^DD",3.9,3.9,1.8,21,0)
^^7^7^2970225^^^^
"^DD",3.9,3.9,1.8,21,1,0)
A scramble hint is used to suggest to the reader what the scramble password is.
"^DD",3.9,3.9,1.8,21,2,0)
Since the password is not recoverable after it is entered, and since the reader
"^DD",3.9,3.9,1.8,21,3,0)
must supply the password in order to read the message, the hint can be a
"^DD",3.9,3.9,1.8,21,4,0)
helpful reminder to the reader of the message. 
"^DD",3.9,3.9,1.8,21,5,0)

"^DD",3.9,3.9,1.8,21,6,0)
The hint will be shown to the reader just before the reader is asked to enter
"^DD",3.9,3.9,1.8,21,7,0)
the password.
"^DD",3.9,3.9,1.8,"DT")
2970225
"^DD",3.9,3.9,1.85,0)
SCRAMBLE KEY^FI^^K;E1,200^K:$L(X)>200!($L(X)<3) X
"^DD",3.9,3.9,1.85,3)
Answer must be 3-20 characters in length.
"^DD",3.9,3.9,1.85,21,0)
^^3^3^2970225^^^^
"^DD",3.9,3.9,1.85,21,1,0)
The scramble password is a secret code which must be entered by the reader in
"^DD",3.9,3.9,1.85,21,2,0)
order to see the message.  Upper and lower case characters are treated the
"^DD",3.9,3.9,1.85,21,3,0)
same.  (The password is not case sensitive.) 
"^DD",3.9,3.9,1.85,23,0)
^^3^3^2970225^^^
"^DD",3.9,3.9,1.85,23,1,0)
The key is stored in scrambled form.  First character=1 indicates that
"^DD",3.9,3.9,1.85,23,2,0)
scrambling is done in standard bazaries cylinder form.  Other first
"^DD",3.9,3.9,1.85,23,3,0)
characters are reserved.
"^DD",3.9,3.9,1.85,"DT")
2970225
"^DD",3.9,3.9,1.95,0)
CLOSED MESSAGE?^S^y:YES;n:NO;^0;9^Q
"^DD",3.9,3.9,1.95,.1)
 
"^DD",3.9,3.9,1.95,3)
If closed, message may not be forwarded or copied by recipients.
"^DD",3.9,3.9,1.95,21,0)
^^2^2^2881121^^^^
"^DD",3.9,3.9,1.95,21,1,0)
This field, if set to 'yes', means that recipients may not forward or
"^DD",3.9,3.9,1.95,21,2,0)
copy the message.  
"^DD",3.9,3.9,1.95,"DT")
2850419
"^DD",3.9,3.9,1.96,0)
CONFIDENTIAL?^S^y:YES;n:NO;^0;11^Q
"^DD",3.9,3.9,1.96,3)
If confidential, surrogates may not read message.
"^DD",3.9,3.9,1.96,21,0)
^^2^2^2851004^
"^DD",3.9,3.9,1.96,21,1,0)
This field, if set to "yes", means that surrogates of the recipients
"^DD",3.9,3.9,1.96,21,2,0)
may not read this message.
"^DD",3.9,3.9,1.96,"DT")
2850419
"^DD",3.9,3.9,1.97,0)
INFORMATION ONLY?^S^y:YES;n:NO;^0;12^Q
"^DD",3.9,3.9,1.97,3)
If "YES", the message will be considered "INFORMATION ONLY" for all recipients.
"^DD",3.9,3.9,1.97,21,0)
^^8^8^2860210^
"^DD",3.9,3.9,1.97,21,1,0)
This field, if set to "YES", will cause all recipients to be considered
"^DD",3.9,3.9,1.97,21,2,0)
"INFORMATION ONLY", which disables responses to the message. 
"^DD",3.9,3.9,1.97,21,3,0)
 
"^DD",3.9,3.9,1.97,21,4,0)
If a sender wishes to individually restrict responses, "INFO:" before
"^DD",3.9,3.9,1.97,21,5,0)
the recipient's names will restrict their responses.
"^DD",3.9,3.9,1.97,21,6,0)
 
"^DD",3.9,3.9,1.97,21,7,0)
Messages which are broadcast (by naming a recipient "*"), are automatically
"^DD",3.9,3.9,1.97,21,8,0)
set to INFORMATION ONLY.
"^DD",3.9,3.9,1.97,"DT")
2860210
"^DD",3.9,3.9,2,0)
RECIPIENT^3.91A^^1;0
"^DD",3.9,3.9,2,21,0)
^^4^4^2970902^^^^
"^DD",3.9,3.9,2,21,1,0)
This is a list of all recipients of this message.  MailMan automatically
"^DD",3.9,3.9,2,21,2,0)
tracks each recipient's progress through the response chain, when
"^DD",3.9,3.9,2,21,3,0)
they last read it, who forwarded or copied the message, etc.  This 
"^DD",3.9,3.9,2,21,4,0)
information is displayed with the Query option after reading the message.
"^DD",3.9,3.9,3,0)
TEXT^3.92A^^2;0
"^DD",3.9,3.9,3,21,0)
^^2^2^2931214^^^^
"^DD",3.9,3.9,3,21,1,0)
This is the actual text of the message.  It is stored without the
"^DD",3.9,3.9,3,21,2,0)
wrap-around logic, in a line-by-line format.
"^DD",3.9,3.9,8,0)
RESPONSE^3.9001PA^^3;0
"^DD",3.9,3.9,8,.1)
LIST OF RESPONSES TO THIS MESSAGE
"^DD",3.9,3.9,8,21,0)
^^3^3^2881121^^^
"^DD",3.9,3.9,8,21,1,0)
This is a list of the responses to the message.  Each response is
"^DD",3.9,3.9,8,21,2,0)
a separate message, with a subject of "R" followed by this response
"^DD",3.9,3.9,8,21,3,0)
number.
"^DD",3.9,3.9,9,0)
INCOMING MESSAGE ID^FI^^5;1^K:X[""""!($A(X)=45) X I $D(X) K:$L(X)>110!($L(X)<2) X
"^DD",3.9,3.9,9,1,0)
^.1
"^DD",3.9,3.9,9,1,1,0)
3.9^AI^MUMPS
"^DD",3.9,3.9,9,1,1,1)
I X["@",$L($P(X,"@",1)),$L($P(X,"@",2)) S ^XMBX(3.9,"AI",$E($P(X,"@",2),1,64),$E($P(X,"@",1),1,64),DA)=DT
"^DD",3.9,3.9,9,1,1,2)
Q
"^DD",3.9,3.9,9,1,1,"%D",0)
^^12^12^2990218^^^^
"^DD",3.9,3.9,9,1,1,"%D",1,0)
This cross reference keeps track of messages that have already been
"^DD",3.9,3.9,9,1,1,"%D",2,0)
received from other sites.
"^DD",3.9,3.9,9,1,1,"%D",3,0)

"^DD",3.9,3.9,9,1,1,"%D",4,0)
This index is used to retrieve remote messages which have been transmitted
"^DD",3.9,3.9,9,1,1,"%D",5,0)
from other domains.  For example, if message 123 from loma-linda has
"^DD",3.9,3.9,9,1,1,"%D",6,0)
been sent to another site, that other site could inquire against 
"^DD",3.9,3.9,9,1,1,"%D",7,0)
message ID "loma-linda@123", to find out if the message had been 
"^DD",3.9,3.9,9,1,1,"%D",8,0)
received yet.
"^DD",3.9,3.9,9,1,1,"%D",9,0)
 
"^DD",3.9,3.9,9,1,1,"%D",10,0)
This index is also used to prevent messages from looping around the
"^DD",3.9,3.9,9,1,1,"%D",11,0)
network.  The MailMan receiver will not allow the same message to be
"^DD",3.9,3.9,9,1,1,"%D",12,0)
received twice at the same site.
"^DD",3.9,3.9,9,1,1,"DT")
2990218
"^DD",3.9,3.9,9,3)
Answer must be 2-110 characters in length.
"^DD",3.9,3.9,9,21,0)
^^4^4^2990122^^^^
"^DD",3.9,3.9,9,21,1,0)
If this is a message which has been received from a remote site,
"^DD",3.9,3.9,9,21,2,0)
its Message ID, as contained in the message header, is stored here.
"^DD",3.9,3.9,9,21,3,0)

"^DD",3.9,3.9,9,21,4,0)
Its format is usually <message ID@domain name>.
"^DD",3.9,3.9,9,"DT")
2990218
"^DD",3.9,3.9,9.5,0)
IN REPLY TO REMOTE MESSAGE ID^F^^IN;1^K:$L(X)>110!($L(X)<2) X
"^DD",3.9,3.9,9.5,3)
Answer must be 2-110 characters in length.
"^DD",3.9,3.9,9.5,21,0)
^^4^4^2990122^^^^
"^DD",3.9,3.9,9.5,21,1,0)
When a user responds to a message from a remote user,
"^DD",3.9,3.9,9.5,21,2,0)
the INCOMING MESSAGE ID (field 9) of the original message
"^DD",3.9,3.9,9.5,21,3,0)
is copied and placed here.
"^DD",3.9,3.9,9.5,21,4,0)
Its format is <domain@message id>.
"^DD",3.9,3.9,9.5,"DT")
2970728
"^DD",3.9,3.9,10,0)
ADDRESSED TO^3.911A^^6;0
"^DD",3.9,3.9,10,21,0)
^^6^6^2970516^^^^
"^DD",3.9,3.9,10,21,1,0)
There are two parts to addressing a message.  The first part occurs when
"^DD",3.9,3.9,10,21,2,0)
the user enters the 'names' (addresses) to which the message will be sent.
"^DD",3.9,3.9,10,21,3,0)
The second part occurs when Mail Groups are 'Expanded'.  The 'names' the
"^DD",3.9,3.9,10,21,4,0)
user enters will be recorded here.  The expanded list is in a multiple
"^DD",3.9,3.9,10,21,5,0)
titled 'Recipients'.  Old messages may not have 'ADDRESSED TO' data if they
"^DD",3.9,3.9,10,21,6,0)
were originated before MailMan recorded these two pieces of data separately.
"^DD",3.9,3.9,14,0)
LATER DELIVERY TO^3.914^^7;0
"^DD",3.9,3.9,21,0)
DELIVERY BASKET^F^^.5;1^K:$L(X)>30!($L(X)<2) X
"^DD",3.9,3.9,21,3)
Answer must be 2-30 characters in length.
"^DD",3.9,3.9,21,21,0)
^^2^2^2980515^^^
"^DD",3.9,3.9,21,21,1,0)
The Delivery Basket is the basket into which the message will be delivered
"^DD",3.9,3.9,21,21,2,0)
for each recipient.  It overrides any filters.
"^DD",3.9,3.9,21,"DT")
2980513
"^DD",3.9,3.9,31,0)
LOCAL CREATE DATE^D^^.6;1^S %DT="EX" D ^%DT S X=Y K:Y<1 X
"^DD",3.9,3.9,31,1,0)
^.1
"^DD",3.9,3.9,31,1,1,0)
3.9^C
"^DD",3.9,3.9,31,1,1,1)
S ^XMB(3.9,"C",$E(X,1,30),DA)=""
"^DD",3.9,3.9,31,1,1,2)
K ^XMB(3.9,"C",$E(X,1,30),DA)
"^DD",3.9,3.9,31,1,1,"%D",0)
^^2^2^2980917^
"^DD",3.9,3.9,31,1,1,"%D",1,0)
This xref is used by the date purge and by the unreferenced messages
"^DD",3.9,3.9,31,1,1,"%D",2,0)
purge.
"^DD",3.9,3.9,31,1,1,"DT")
2980917
"^DD",3.9,3.9,31,3)
Enter the date this message was created.
"^DD",3.9,3.9,31,21,0)
^^2^2^2980918^^
"^DD",3.9,3.9,31,21,1,0)
This is the date this message was created and added to the message file.
"^DD",3.9,3.9,31,21,2,0)
It is used, via the "C" xref, to select messages for purging.
"^DD",3.9,3.9,31,"DT")
2980917
"^DD",3.9,3.9,41,0)
ENVELOPE FROM^F^^.7;1^K:$L(X)>99!($L(X)<1) X
"^DD",3.9,3.9,41,3)
Answer must be 1-99 characters in length.
"^DD",3.9,3.9,41,21,0)
^^5^5^2981015^
"^DD",3.9,3.9,41,21,1,0)
This is the 'from' as stated in the message envelope on an incoming
"^DD",3.9,3.9,41,21,2,0)
network message.
"^DD",3.9,3.9,41,21,3,0)
HELO ...
"^DD",3.9,3.9,41,21,4,0)
MAIL FROM:<envelope from>
"^DD",3.9,3.9,41,21,5,0)
RCPT TO: ...
"^DD",3.9,3.9,41,"DT")
2981015
"^DD",3.9,3.9,2005,0)
OBJECTS - OTHER BODY PARTS^3.92005P^^2005;0
"^DD",3.9,3.9,2005,21,0)
^^2^2^2931214^
"^DD",3.9,3.9,2005,21,1,0)
Pointers to the Object file are stored here as attachments
"^DD",3.9,3.9,2005,21,2,0)
to multimedia messages.
"^DD",3.9,3.9,2005,23,0)
^^1^1^2931214^
"^DD",3.9,3.9,2005,23,1,0)
The pointers in this field point at the OBJECT file (2005).
"^DD",3.9,3.9001,0)
RESPONSE SUB-FIELD^NL^.01^1
"^DD",3.9,3.9001,0,"DT")
2940705
"^DD",3.9,3.9001,0,"NM","RESPONSE")

"^DD",3.9,3.9001,0,"UP")
3.9
"^DD",3.9,3.9001,.01,0)
RESPONSE^MP3.9'I^XMB(3.9,^0;1^Q
"^DD",3.9,3.9001,.01,.1)
This is a list of the responses to this message.
"^DD",3.9,3.9001,.01,3)

"^DD",3.9,3.9001,.01,21,0)
^^1^1^2851009^
"^DD",3.9,3.9001,.01,21,1,0)
This is a response to this message.
"^DD",3.9,3.9001,.01,"DT")
2851004
"^DD",3.9,3.91,0)
RECIPIENT SUB-FIELD^NL^8.04^23
"^DD",3.9,3.91,0,"DT")
3011128
"^DD",3.9,3.91,0,"IX","AFAX",3.91,13)

"^DD",3.9,3.91,0,"IX","AQUEUE",3.91,6)

"^DD",3.9,3.91,0,"IX","C",3.91,.01)

"^DD",3.9,3.91,0,"NM","RECIPIENT")

"^DD",3.9,3.91,0,"UP")
3.9
"^DD",3.9,3.91,.01,0)
RECIPIENT^MFI^^0;1^K:$L(X)>85!($L(X)<1) X
"^DD",3.9,3.91,.01,.1)
The recipient user number or network address
"^DD",3.9,3.91,.01,1,0)
^.1
"^DD",3.9,3.91,.01,1,1,0)
3.91^C
"^DD",3.9,3.91,.01,1,1,1)
S ^XMB(3.9,DA(1),1,"C",$E(X,1,30),DA)=""
"^DD",3.9,3.91,.01,1,1,2)
K ^XMB(3.9,DA(1),1,"C",$E(X,1,30),DA)
"^DD",3.9,3.91,.01,1,1,"DT")
2960305
"^DD",3.9,3.91,.01,3)
Answer must be 1-85 characters in length.
"^DD",3.9,3.91,.01,21,0)
^.001^1^1^3020415^^^^
"^DD",3.9,3.91,.01,21,1,0)
The name of a recipient of this message.
"^DD",3.9,3.91,.01,23,0)
^.001^1^1^3020415^^
"^DD",3.9,3.91,.01,23,1,0)
In a future patch, the field should be lengthened, perhaps to 99.
"^DD",3.9,3.91,.01,"DT")
2970730
"^DD",3.9,3.91,1,0)
LAST RESPONSE READ^NJ5,0^^0;2^K:+X'=X!(X>99999)!(X<0)!(X?.E1"."1N.N) X
"^DD",3.9,3.91,1,.1)
Last response read, if this is a shared response message.
"^DD",3.9,3.91,1,1,0)
^.1^^0
"^DD",3.9,3.91,1,3)
Type a Number between 0 and 99999, 0 Decimal Digits
"^DD",3.9,3.91,1,21,0)
^^3^3^2970728^^^^
"^DD",3.9,3.91,1,21,1,0)
The last response which this recipient read.
"^DD",3.9,3.91,1,21,2,0)

"^DD",3.9,3.91,1,21,3,0)
It actually points into 3.9001, the Response multiple for this message.
"^DD",3.9,3.91,1,"DT")
2970728
"^DD",3.9,3.91,2,0)
LAST READ DATE/TIME^D^^0;3^S %DT="ETXR" D ^%DT S X=Y K:Y<1 X
"^DD",3.9,3.91,2,.1)
Date/Time message was last read by recipient
"^DD",3.9,3.91,2,3)

"^DD",3.9,3.91,2,21,0)
^^1^1^2970730^^^^
"^DD",3.9,3.91,2,21,1,0)
The date and time this recipient last read this message.
"^DD",3.9,3.91,2,"DT")
2970730
"^DD",3.9,3.91,3,0)
REMOTE MESSAGE ID^F^^0;4^K:$L(X)>45!($L(X)<3) X
"^DD",3.9,3.91,3,.1)
The identifier of the message as accepted by the remote site
"^DD",3.9,3.91,3,1,0)
^.1^^0
"^DD",3.9,3.91,3,3)
Answer must be 3-45 characters in length.
"^DD",3.9,3.91,3,21,0)
^^2^2^2970730^^^
"^DD",3.9,3.91,3,21,1,0)
The identifier of the message at the remote location.
"^DD",3.9,3.91,3,21,2,0)
Format: message ID@site
"^DD",3.9,3.91,3,23,0)
^^1^1^2970811^
"^DD",3.9,3.91,3,23,1,0)
In a future patch, this field should be lengthened, perhaps to 110 chars.
"^DD",3.9,3.91,3,"DT")
2970728
"^DD",3.9,3.91,4,0)
TRANSMISSION DATE/TIME^D^^0;5^S %DT="ETXR" D ^%DT S X=Y K:Y<1 X
"^DD",3.9,3.91,4,.1)
THE DATE/TIME A REMOTE MESSAGE WAS SENT 
"^DD",3.9,3.91,4,21,0)
^^1^1^2970730^^
"^DD",3.9,3.91,4,21,1,0)
The date and time the remote message was transmitted.
"^DD",3.9,3.91,4,"DT")
2970730
"^DD",3.9,3.91,5,0)
STATUS^F^^0;6^K:$L(X)>30!($L(X)<1) X
"^DD",3.9,3.91,5,.1)
Any error messages or comments by the receiver, if not delivered
"^DD",3.9,3.91,5,3)
ANSWER MUST BE 1-30 CHARACTERS IN LENGTH
"^DD",3.9,3.91,5,21,0)
^^12^12^2970902^^
"^DD",3.9,3.91,5,21,1,0)
This field holds the status of the recipient, if the recipient is other
"^DD",3.9,3.91,5,21,2,0)
than a local user.  If this is a device, the status is "Awaiting Device"
"^DD",3.9,3.91,5,21,3,0)
until the device has printed the message.  If this is a server, the
"^DD",3.9,3.91,5,21,4,0)
status will be "Awaiting Server" until the server has read the message.
"^DD",3.9,3.91,5,21,5,0)
In either of the above cases, the status becomes "done" when the process
"^DD",3.9,3.91,5,21,6,0)
is complete, and "Last read" field describes when the process was complete.
"^DD",3.9,3.91,5,21,7,0)
 
"^DD",3.9,3.91,5,21,8,0)
If the recipient is a remote user, the status is "awaiting transmission"
"^DD",3.9,3.91,5,21,9,0)
and the Path field names the queue in which the message is waiting.  When
"^DD",3.9,3.91,5,21,10,0)
the message has been sent, the Transmission date is set, the remote message
"^DD",3.9,3.91,5,21,11,0)
ID is set to the other domain's message number (providing bi-directional
"^DD",3.9,3.91,5,21,12,0)
linkage of messages), and the Path field is cleared.
"^DD",3.9,3.91,5,"DT")
2840120
"^DD",3.9,3.91,6,0)
PATH^P4.2'^DIC(4.2,^0;7^Q
"^DD",3.9,3.91,6,1,0)
^.1
"^DD",3.9,3.91,6,1,1,0)
3.91^AQUEUE
"^DD",3.9,3.91,6,1,1,1)
S ^XMB(3.9,DA(1),1,"AQUEUE",$E(X,1,30),DA)=""
"^DD",3.9,3.91,6,1,1,2)
K ^XMB(3.9,DA(1),1,"AQUEUE",$E(X,1,30),DA)
"^DD",3.9,3.91,6,1,1,"%D",0)
^^2^2^2920920^
"^DD",3.9,3.91,6,1,1,"%D",1,0)
This cross reference makes it possible for network mail transmissions to
"^DD",3.9,3.91,6,1,1,"%D",2,0)
immediately find the recipients to transmit a message to.
"^DD",3.9,3.91,6,1,1,"DT")
2920920
"^DD",3.9,3.91,6,21,0)
^^4^4^2840410^
"^DD",3.9,3.91,6,21,1,0)
This field points to the queue in which this message resides.  After
"^DD",3.9,3.91,6,21,2,0)
transmission, the REMOTE MESSAGE ID field holds the message number and
"^DD",3.9,3.91,6,21,3,0)
site to which the message was transmitted (which may be only a relay
"^DD",3.9,3.91,6,21,4,0)
point).
"^DD",3.9,3.91,6,"DT")
2920920
"^DD",3.9,3.91,6.5,0)
TYPE OF RECIPIENT^S^C:cc;I:Info;^T;1^Q
"^DD",3.9,3.91,6.5,21,0)
^^10^10^2990225^^^^
"^DD",3.9,3.91,6.5,21,1,0)
This field indicates what type of recipient this is.
"^DD",3.9,3.91,6.5,21,2,0)
 
"^DD",3.9,3.91,6.5,21,3,0)
CC:  indicates that the recipient is being sent a copy, but is not the
"^DD",3.9,3.91,6.5,21,4,0)
primary recipient.  He may reply.
"^DD",3.9,3.91,6.5,21,5,0)
 
"^DD",3.9,3.91,6.5,21,6,0)
INFO: indicates that the recipient may not reply to the message; the
"^DD",3.9,3.91,6.5,21,7,0)
message is being transmitted to him for information purposes only.
"^DD",3.9,3.91,6.5,21,8,0)
 
"^DD",3.9,3.91,6.5,21,9,0)
These flags are set by the "Send to:" prompt by including them before a
"^DD",3.9,3.91,6.5,21,10,0)
recipient name.  "CC:JONES" would put JONES on the CC: list.
"^DD",3.9,3.91,6.5,21,11,0)
 
"^DD",3.9,3.91,6.5,21,12,0)
These flags are set by the "Send to:" prompt by including them before a
"^DD",3.9,3.91,6.5,21,13,0)
message: "CC:JONES" would put JONES on the CC: list.
"^DD",3.9,3.91,6.5,"DT")
2970811
"^DD",3.9,3.91,6.6,0)
APPROVAL^F^^T;2^K:$L(X)>65!($L(X)<1) X
"^DD",3.9,3.91,6.6,3)
ANSWER MUST BE 1-65 CHARACTERS IN LENGTH
"^DD",3.9,3.91,6.6,21,0)
^^2^2^2841130^
"^DD",3.9,3.91,6.6,21,1,0)
This field is set whenever the  the recipient is named as a THRU: type, and issues the
"^DD",3.9,3.91,6.6,21,2,0)
approval command after reading it.
"^DD",3.9,3.91,6.6,"DT")
2841130
"^DD",3.9,3.91,7,0)
TERMINATION DATE^D^^D;1^S %DT="ET" D ^%DT S X=Y K:Y<1 X
"^DD",3.9,3.91,7,21,0)
^^7^7^2900319^^^
"^DD",3.9,3.91,7,21,1,0)
This field, if set, inhibits MailMan from sending future replies to this
"^DD",3.9,3.91,7,21,2,0)
message, allowing him to "drop out" of a conversation.  This is accomplished
"^DD",3.9,3.91,7,21,3,0)
with the "Terminate" option.
"^DD",3.9,3.91,7,21,4,0)
 
"^DD",3.9,3.91,7,21,5,0)
This field is displayed whenever a recipient queries the message.  The
"^DD",3.9,3.91,7,21,6,0)
drop-outs will have the notation "Terminated: mm/dd/yy" in their status
"^DD",3.9,3.91,7,21,7,0)
line.
"^DD",3.9,3.91,7,"DT")
2840424
"^DD",3.9,3.91,8,0)
FORWARDED BY^FI^^F;1^K:$L(X)>110!($L(X)<1) X
"^DD",3.9,3.91,8,3)
Answer must be 1-110 characters in length.
"^DD",3.9,3.91,8,21,0)
^^3^3^2970728^^^
"^DD",3.9,3.91,8,21,1,0)
When a message is forwarded to another user, this field names the
"^DD",3.9,3.91,8,21,2,0)
person who did the forwarding, along with the date and time that this
"^DD",3.9,3.91,8,21,3,0)
was done.  It is displayed in the query option after reading.
"^DD",3.9,3.91,8,"DT")
2970728
"^DD",3.9,3.91,8.01,0)
FORWARDED BY (XMDUZ)^P200'^VA(200,^F;2^Q
"^DD",3.9,3.91,8.01,3)
Who forwarded the message to this recipient?
"^DD",3.9,3.91,8.01,21,0)
^^2^2^2970728^^
"^DD",3.9,3.91,8.01,21,1,0)
This field uses the XMDUZ variable to identify the user who
"^DD",3.9,3.91,8.01,21,2,0)
forwarded the message.
"^DD",3.9,3.91,8.01,"DT")
2970728
"^DD",3.9,3.91,8.02,0)
FWD TYPE^S^F:Filter-Forward;A:Auto-Forward;R:Regular-Forward;^F;3^Q
"^DD",3.9,3.91,8.02,3)
What kind of forwarding?
"^DD",3.9,3.91,8.02,21,0)
^.001^11^11^3011128^^
"^DD",3.9,3.91,8.02,21,1,0)
Regular-Forward - A user simply forwarded this message to the recipient
"^DD",3.9,3.91,8.02,21,2,0)
in the .01 field.  This is the default, if this field is null.
"^DD",3.9,3.91,8.02,21,3,0)

"^DD",3.9,3.91,8.02,21,4,0)
Auto-Forward - A user has a forwarding address listing the recipient
"^DD",3.9,3.91,8.02,21,5,0)
in the .01 field.  This message was sent to the user and then
"^DD",3.9,3.91,8.02,21,6,0)
automatically forwarded to the recipient.
"^DD",3.9,3.91,8.02,21,7,0)

"^DD",3.9,3.91,8.02,21,8,0)
Filter-Forward - A user has an active message filter listing the
"^DD",3.9,3.91,8.02,21,9,0)
recipient in the .01 field as a "forward to" person.  This message was
"^DD",3.9,3.91,8.02,21,10,0)
sent to the user and then automatically forwarded to the recipient
"^DD",3.9,3.91,8.02,21,11,0)
during message delivery.
"^DD",3.9,3.91,8.02,"DT")
3011128
"^DD",3.9,3.91,8.03,0)
FWD BY ORIGINAL^F^^F;4^K:$L(X)>110!($L(X)<1) X
"^DD",3.9,3.91,8.03,3)
Answer must be 1-110 characters in length.
"^DD",3.9,3.91,8.03,21,0)
^^3^3^3011128^
"^DD",3.9,3.91,8.03,21,1,0)
This field is only used if FWD TYPE is Auto-Forward.
"^DD",3.9,3.91,8.03,21,2,0)
This field lists the original user (and possibly the user's surrogate)
"^DD",3.9,3.91,8.03,21,3,0)
who forwarded the message to the user with the forwarding address.
"^DD",3.9,3.91,8.03,"DT")
3011128
"^DD",3.9,3.91,8.04,0)
FWD TYPE ORIGINAL^S^F:Filter-Forward;R:Regular-Forward;^F;5^Q
"^DD",3.9,3.91,8.04,3)
What kind of forwarding, originally?
"^DD",3.9,3.91,8.04,21,0)
^^14^14^3011128^
"^DD",3.9,3.91,8.04,21,1,0)
This field is only used if FWD TYPE is Auto-Forward.  This field reveals
"^DD",3.9,3.91,8.04,21,2,0)
how the message was forwarded to the user who had the forwarding address
"^DD",3.9,3.91,8.04,21,3,0)
listing the recipient in the .01 field.
"^DD",3.9,3.91,8.04,21,4,0)

"^DD",3.9,3.91,8.04,21,5,0)
Regular-Forward - A user simply forwarded this message to the user with
"^DD",3.9,3.91,8.04,21,6,0)
the forwarding address.  This is the default, if this field is null.
"^DD",3.9,3.91,8.04,21,7,0)

"^DD",3.9,3.91,8.04,21,8,0)
Filter-Forward - A user has an active message filter listing the user
"^DD",3.9,3.91,8.04,21,9,0)
with the forwarding address as a "forward to" person.  This message was
"^DD",3.9,3.91,8.04,21,10,0)
sent to the user and then automatically forwarded to the user during
"^DD",3.9,3.91,8.04,21,11,0)
message delivery.
"^DD",3.9,3.91,8.04,21,12,0)

"^DD",3.9,3.91,8.04,21,13,0)
Note that Auto-Forward is not a possibility, because Auto-Forward is
"^DD",3.9,3.91,8.04,21,14,0)
allowed only to remote recipients or to devices or servers.
"^DD",3.9,3.91,8.04,"DT")
3011128
"^DD",3.9,3.91,8.5,0)
COPIED DATE/TIME^F^^C;1^K:$L(X)>15!($L(X)<1) X
"^DD",3.9,3.91,8.5,3)
Answer must be 1-15 characters in length.
"^DD",3.9,3.91,8.5,21,0)
^^3^3^3020422^^^^
"^DD",3.9,3.91,8.5,21,1,0)
When a message is copied by a user, this field indicates the date and
"^DD",3.9,3.91,8.5,21,2,0)
time at which this was done.
"^DD",3.9,3.91,8.5,21,3,0)
It is displayed in the query option after reading the message.
"^DD",3.9,3.91,8.5,23,0)
^^4^4^3020422^
"^DD",3.9,3.91,8.5,23,1,0)
Before patch XM*7.1*110, this field was in external format.
"^DD",3.9,3.91,8.5,23,2,0)
After that patch, this field is in internal FileMan format.
"^DD",3.9,3.91,8.5,23,3,0)
The data have not been changed, so you may see either format,
"^DD",3.9,3.91,8.5,23,4,0)
depending on when the message was copied.
"^DD",3.9,3.91,8.5,"DT")
3020422
"^DD",3.9,3.91,9,0)
NETWORK TRANSMISSION TIME^NJ6,0I^^0;8^K:+X'=X!(X>999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",3.9,3.91,9,3)
Type a Number between 0 and 999999, 0 Decimal Digits
"^DD",3.9,3.91,9,21,0)
^^2^2^2970730^^
"^DD",3.9,3.91,9,21,1,0)
This field records the elapsed time (in seconds) during a network
"^DD",3.9,3.91,9,21,2,0)
transmission.
"^DD",3.9,3.91,9,"DT")
2880222
"^DD",3.9,3.91,10,0)
PRIORITY RESPONSES?^S^0:YES;1:NO;^0;9^Q
"^DD",3.9,3.91,10,21,0)
^^5^5^2980729^^^^
"^DD",3.9,3.91,10,21,1,0)
This field overrides the MESSAGE TYPE field in the zero node of the 
"^DD",3.9,3.91,10,21,2,0)
message, but only if it contains a "P".  In this way, some recipients can 
"^DD",3.9,3.91,10,21,3,0)
keep receiving responses to a 'Priority Message' as priority mail, while
"^DD",3.9,3.91,10,21,4,0)
others may choose not to.  One cannot, however, force the responses of an
"^DD",3.9,3.91,10,21,5,0)
ordinary message to be delivered as 'Priority Mail'.
"^DD",3.9,3.91,10,"DT")
2970728
"^DD",3.9,3.91,11,0)
FIRST READ DATE/TIME^D^^0;10^S %DT="ETXR" D ^%DT S X=Y K:Y<1 X
"^DD",3.9,3.91,11,21,0)
^^2^2^2970730^^^
"^DD",3.9,3.91,11,21,1,0)
Into this field is set the date and time that a message was first seen
"^DD",3.9,3.91,11,21,2,0)
by the recipient.
"^DD",3.9,3.91,11,"DT")
2970730
"^DD",3.9,3.91,12,0)
SURROGATE READER^F^^S;1^K:$L(X)>35!($L(X)<3) X
"^DD",3.9,3.91,12,3)
Answer must be 3-35 characters in length.
"^DD",3.9,3.91,12,21,0)
^^1^1^2960403^^
"^DD",3.9,3.91,12,21,1,0)
This is the name of the surrogate who last read this message.
"^DD",3.9,3.91,12,"DT")
2960403
"^DD",3.9,3.91,13,0)
FAX RECIPIENT^P589499'^AKF("FAXR",^0;11^Q
"^DD",3.9,3.91,13,1,0)
^.1
"^DD",3.9,3.91,13,1,1,0)
3.91^AFAX
"^DD",3.9,3.91,13,1,1,1)
S ^XMB(3.9,DA(1),1,"AFAX",$E(X,1,30),DA)=""
"^DD",3.9,3.91,13,1,1,2)
K ^XMB(3.9,DA(1),1,"AFAX",$E(X,1,30),DA)
"^DD",3.9,3.91,13,1,1,"%D",0)
^^2^2^2970114^^
"^DD",3.9,3.91,13,1,1,"%D",1,0)
This cross reference makes it possible for MailMan to immediately find the
"^DD",3.9,3.91,13,1,1,"%D",2,0)
recipients to fax a message to. 
"^DD",3.9,3.91,13,1,1,"DT")
2970110
"^DD",3.9,3.91,13,3)
Enter the fax recipient
"^DD",3.9,3.91,13,21,0)
^^4^4^2970211^^^^
"^DD",3.9,3.91,13,21,1,0)
When the message is addressed to a fax recipient, this field points to the fax
"^DD",3.9,3.91,13,21,2,0)
rolodex file.  After the message is handed off to the fax software,
"^DD",3.9,3.91,13,21,3,0)
the pointer in this field is deleted and the Fax ID field is set to the fax ID
"^DD",3.9,3.91,13,21,4,0)
number assigned to it by the fax software.
"^DD",3.9,3.91,13,"DT")
2970211
"^DD",3.9,3.91,14,0)
FAX ID^F^^0;12^K:$L(X)>14!($L(X)<1) X
"^DD",3.9,3.91,14,3)
Answer must be 1-14 characters in length.
"^DD",3.9,3.91,14,21,0)
^^1^1^2970211^
"^DD",3.9,3.91,14,21,1,0)
This is the fax ID as assigned by the fax software (AKF*).
"^DD",3.9,3.91,14,"DT")
2970211
"^DD",3.9,3.91,15,0)
FILTER FORWARD^NJ3,0^^0;13^K:+X'=X!(X>999)!(X<0)!(X?.E1"."1N.N) X
"^DD",3.9,3.91,15,1,0)
^.1^^0
"^DD",3.9,3.91,15,3)
Type a Number between 0 and 999, 0 Decimal Digits
"^DD",3.9,3.91,15,21,0)
^.001^6^6^3001017^^^
"^DD",3.9,3.91,15,21,1,0)
This is the IEN of the user's filter which was activated during message
"^DD",3.9,3.91,15,21,2,0)
delivery.  The filter indicates that this message should be forwarded
"^DD",3.9,3.91,15,21,3,0)
to the addressees listed in the FORWARD TO multiple of the activated
"^DD",3.9,3.91,15,21,4,0)
filter.
"^DD",3.9,3.91,15,21,5,0)

"^DD",3.9,3.91,15,21,6,0)
If this field is set to zero, the message has been forwarded.
"^DD",3.9,3.91,15,23,0)
^.001^14^14^3001017^^
"^DD",3.9,3.91,15,23,1,0)
When this field is set to a positive number (the IEN of the user's
"^DD",3.9,3.91,15,23,2,0)
activated filter), it causes the whole-file "AF" xref to be set.
"^DD",3.9,3.91,15,23,3,0)

"^DD",3.9,3.91,15,23,4,0)
Routine ^XMTDT checks for the existence of the "AF" xref.  It will do
"^DD",3.9,3.91,15,23,5,0)
the actual forwarding of the message.  Once it finishes forwarding,
"^DD",3.9,3.91,15,23,6,0)
it will set this field to zero, which will kill the xref and won't
"^DD",3.9,3.91,15,23,7,0)
reset it.
"^DD",3.9,3.91,15,23,8,0)

"^DD",3.9,3.91,15,23,9,0)
If the field is null, filter forwarding has not yet occurred for this
"^DD",3.9,3.91,15,23,10,0)
message for this user.
"^DD",3.9,3.91,15,23,11,0)

"^DD",3.9,3.91,15,23,12,0)
If the field is not null, it means that the message has already been
"^DD",3.9,3.91,15,23,13,0)
(or is scheduled to be) filter forwarded once for this user, and
"^DD",3.9,3.91,15,23,14,0)
should not be filter forwarded again for this user.
"^DD",3.9,3.91,15,"DT")
3001017
"^DD",3.9,3.911,0)
ADDRESSED TO SUB-FIELD^^1^2
"^DD",3.9,3.911,0,"DT")
2970516
"^DD",3.9,3.911,0,"IX","B",3.911,.01)

"^DD",3.9,3.911,0,"NM","ADDRESSED TO")

"^DD",3.9,3.911,0,"UP")
3.9
"^DD",3.9,3.911,.01,0)
ADDRESSED TO^MF^^0;1^K:$L(X)>99!($L(X)<1) X
"^DD",3.9,3.911,.01,1,0)
^.1
"^DD",3.9,3.911,.01,1,1,0)
3.911^B
"^DD",3.9,3.911,.01,1,1,1)
S ^XMB(3.9,DA(1),6,"B",$E(X,1,30),DA)=""
"^DD",3.9,3.911,.01,1,1,2)
K ^XMB(3.9,DA(1),6,"B",$E(X,1,30),DA)
"^DD",3.9,3.911,.01,3)
Enter the address of a local or remote person, group, device, or server.
"^DD",3.9,3.911,.01,21,0)
^^1^1^2931214^
"^DD",3.9,3.911,.01,21,1,0)
Into this field is recorded the way that a message was addressed.
"^DD",3.9,3.911,.01,"DT")
2911203
"^DD",3.9,3.911,1,0)
TYPE OF RECIPIENT^S^C:cc;I:Info;^0;2^Q
"^DD",3.9,3.911,1,21,0)
^^1^1^2970516^^
"^DD",3.9,3.911,1,21,1,0)
Indicates the type of recipient.
"^DD",3.9,3.911,1,"DT")
2970516
"^DD",3.9,3.914,0)
LATER DELIVERY TO SUB-FIELD^^4^5
"^DD",3.9,3.914,0,"DT")
2970516
"^DD",3.9,3.914,0,"IX","B",3.914,.01)

"^DD",3.9,3.914,0,"NM","LATER DELIVERY TO")

"^DD",3.9,3.914,0,"UP")
3.9
"^DD",3.9,3.914,.01,0)
LATER DELIVERY TO^MF^^0;1^K:$L(X)>99!($L(X)<1) X
"^DD",3.9,3.914,.01,1,0)
^.1
"^DD",3.9,3.914,.01,1,1,0)
3.914^B
"^DD",3.9,3.914,.01,1,1,1)
S ^XMB(3.9,DA(1),7,"B",$E(X,1,30),DA)=""
"^DD",3.9,3.914,.01,1,1,2)
K ^XMB(3.9,DA(1),7,"B",$E(X,1,30),DA)
"^DD",3.9,3.914,.01,1,1,"DT")
2970516
"^DD",3.9,3.914,.01,3)
Answer must be 1-99 characters in length.
"^DD",3.9,3.914,.01,21,0)
^^2^2^2970515^^
"^DD",3.9,3.914,.01,21,1,0)
This is the local or network address of the person to whom to deliver the
"^DD",3.9,3.914,.01,21,2,0)
message at a later date. 
"^DD",3.9,3.914,.01,"DT")
2970516
"^DD",3.9,3.914,1,0)
TYPE OF RECIPIENT^S^C:cc;I:Info;^0;2^Q
"^DD",3.9,3.914,1,21,0)
^^1^1^2970516^^
"^DD",3.9,3.914,1,21,1,0)
Indicates the type of recipient when the message is delivered later.
"^DD",3.9,3.914,1,"DT")
2970516
"^DD",3.9,3.914,2,0)
BY WHOM DUZ^RP200'^VA(200,^0;3^Q
"^DD",3.9,3.914,2,1,0)
^.1
"^DD",3.9,3.914,2,1,1,0)
3.9^AW
"^DD",3.9,3.914,2,1,1,1)
S ^XMB(3.9,"AW",$E(X,1,30),DA(1),DA)=""
"^DD",3.9,3.914,2,1,1,2)
K ^XMB(3.9,"AW",$E(X,1,30),DA(1),DA)
"^DD",3.9,3.914,2,1,1,"%D",0)
^^2^2^2970515^
"^DD",3.9,3.914,2,1,1,"%D",1,0)
This xref will help us find messages which have been scheduled for later
"^DD",3.9,3.914,2,1,1,"%D",2,0)
delivery by certain users.
"^DD",3.9,3.914,2,1,1,"DT")
2970515
"^DD",3.9,3.914,2,3)

"^DD",3.9,3.914,2,21,0)
^^1^1^2970515^^
"^DD",3.9,3.914,2,21,1,0)
This is the DUZ of the person who scheduled the delivery.
"^DD",3.9,3.914,2,"DT")
2970515
"^DD",3.9,3.914,3,0)
BY WHOM TEXT^RF^^0;4^K:$L(X)>99!($L(X)<1) X
"^DD",3.9,3.914,3,3)
Answer must be 1-99 characters in length.
"^DD",3.9,3.914,3,21,0)
^^1^1^2970515^
"^DD",3.9,3.914,3,21,1,0)
This is the name or remote address of the person who scheduled the delivery.
"^DD",3.9,3.914,3,"DT")
2970515
"^DD",3.9,3.914,4,0)
DELIVERY DATE/TIME^RD^^0;5^S %DT="EST" D ^%DT S X=Y K:Y<1 X
"^DD",3.9,3.914,4,1,0)
^.1
"^DD",3.9,3.914,4,1,1,0)
3.9^AL
"^DD",3.9,3.914,4,1,1,1)
S ^XMB(3.9,"AL",$E(X,1,30),DA(1),DA)=""
"^DD",3.9,3.914,4,1,1,2)
K ^XMB(3.9,"AL",$E(X,1,30),DA(1),DA)
"^DD",3.9,3.914,4,1,1,"%D",0)
^^2^2^2970515^
"^DD",3.9,3.914,4,1,1,"%D",1,0)
Helps the 'later' delivery task to find messages which should be delivered
"^DD",3.9,3.914,4,1,1,"%D",2,0)
later to certain recipients.
"^DD",3.9,3.914,4,1,1,"DT")
2970515
"^DD",3.9,3.914,4,3)
When do you want the message delivered to this recipient?
"^DD",3.9,3.914,4,21,0)
^^1^1^2970731^^
"^DD",3.9,3.914,4,21,1,0)
Indicates when the message is to be delivered.
"^DD",3.9,3.914,4,"DT")
2970515
"^DD",3.9,3.92,0)
TEXT SUB-FIELD^NL^.01^1
"^DD",3.9,3.92,0,"DT")
2900501
"^DD",3.9,3.92,0,"NM","TEXT")

"^DD",3.9,3.92,0,"UP")
3.9
"^DD",3.9,3.92,.01,0)
TEXT^W^^0;1^Q
"^DD",3.9,3.92,.01,.1)
This is the text of the message, in the format as it is displayed on the screen.
"^DD",3.9,3.92,.01,3)

"^DD",3.9,3.92,.01,21,0)
^^2^2^2931214^
"^DD",3.9,3.92,.01,21,1,0)
This is the actual text of the message.  It is stored without the
"^DD",3.9,3.92,.01,21,2,0)
wrap-around logic, in a line-by-line format.
"^DD",3.9,3.92,.01,"DT")
2900501
"^DD",3.9,3.92005,0)
OBJECTS - OTHER BODY PARTS SUB-FIELD^^.01^1
"^DD",3.9,3.92005,0,"DT")
2920206
"^DD",3.9,3.92005,0,"IX","B",3.92005,.01)

"^DD",3.9,3.92005,0,"NM","OBJECTS - OTHER BODY PARTS")

"^DD",3.9,3.92005,0,"UP")
3.9
"^DD",3.9,3.92005,.01,0)
OBJECTS - OTHER BODY PARTS^MP2005^MAG(2005,^0;1^Q
"^DD",3.9,3.92005,.01,1,0)
^.1
"^DD",3.9,3.92005,.01,1,1,0)
3.92005^B
"^DD",3.9,3.92005,.01,1,1,1)
S ^XMB(3.9,DA(1),2005,"B",$E(X,1,30),DA)=""
"^DD",3.9,3.92005,.01,1,1,2)
K ^XMB(3.9,DA(1),2005,"B",$E(X,1,30),DA)
"^DD",3.9,3.92005,.01,1,1,"DT")
2920319
"^DD",3.9,3.92005,.01,21,0)
^^2^2^2931214^
"^DD",3.9,3.92005,.01,21,1,0)
Pointers to the Object file are stored here as attachments
"^DD",3.9,3.92005,.01,21,2,0)
to multimedia messages.
"^DD",3.9,3.92005,.01,"DT")
2920319
"^DD",4.2,4.2,0)
FIELD^^50^25
"^DD",4.2,4.2,0,"DDA")
Y
"^DD",4.2,4.2,0,"DT")
2990518
"^DD",4.2,4.2,0,"IX","AB",4.24,.01)

"^DD",4.2,4.2,0,"IX","AC",4.2,1)

"^DD",4.2,4.2,0,"IX","AD",4.2,6.2)

"^DD",4.2,4.2,0,"IX","AE",4.2,50)

"^DD",4.2,4.2,0,"IX","ATCP",4.2,6.61)

"^DD",4.2,4.2,0,"IX","B",4.2,.01)

"^DD",4.2,4.2,0,"IX","C",4.23,.01)

"^DD",4.2,4.2,0,"IX","D",4.2,6.61)

"^DD",4.2,4.2,0,"NM","DOMAIN")

"^DD",4.2,4.2,0,"PT",3.8161,.01)

"^DD",4.2,4.2,0,"PT",3.91,6)

"^DD",4.2,4.2,0,"PT",4,60)

"^DD",4.2,4.2,0,"PT",4.2,2)

"^DD",4.2,4.2,0,"PT",4.2999,.01)

"^DD",4.2,4.2,0,"PT",4.3,.01)

"^DD",4.2,4.2,0,"PT",4.3,3)

"^DD",4.2,4.2,0,"PT",4.31,.01)

"^DD",4.2,4.2,0,"PT",8989.3,.01)

"^DD",4.2,4.2,0,"PT",8989.5,.01)

"^DD",4.2,4.2,0,"PT",8994.1,.01)

"^DD",4.2,4.2,.01,0)
NAME^RFX^^0;1^K:$L(X)>64!($L(X)<1) X I $D(X) D CHKNAME^XMXADDRD
"^DD",4.2,4.2,.01,.1)
The exact name of the domain, as used in network addressing
"^DD",4.2,4.2,.01,1,0)
^.1
"^DD",4.2,4.2,.01,1,1,0)
4.2^B
"^DD",4.2,4.2,.01,1,1,1)
S ^DIC(4.2,"B",$E(X,1,30),DA)=""
"^DD",4.2,4.2,.01,1,1,2)
K ^DIC(4.2,"B",$E(X,1,30),DA)
"^DD",4.2,4.2,.01,3)
Answer must be 1-64 characters in length.
"^DD",4.2,4.2,.01,4)

"^DD",4.2,4.2,.01,21,0)
^^10^10^2990518^^^^
"^DD",4.2,4.2,.01,21,1,0)
This name is the exact name of the domain, as used in network addressing.
"^DD",4.2,4.2,.01,21,2,0)
It consists of "." (dot) pieces that are formed hierarchically starting at
"^DD",4.2,4.2,.01,21,3,0)
the right.  Domains with dot pieces to the left are administered by the
"^DD",4.2,4.2,.01,21,4,0)
domain whose domain name consists of its name less the 1st dot piece.
"^DD",4.2,4.2,.01,21,5,0)
For example:  A.DOMAIN.COM is administered by DOMAIN.COM.
"^DD",4.2,4.2,.01,21,6,0)
 
"^DD",4.2,4.2,.01,21,7,0)
The domain name may be from 1 to 64 characters.
"^DD",4.2,4.2,.01,21,8,0)

"^DD",4.2,4.2,.01,21,9,0)
Each dot piece may be up to 20 characters, and must begin with an alpha
"^DD",4.2,4.2,.01,21,10,0)
or numeric, and be composed of only alpha, numeric, or "-" characters.
"^DD",4.2,4.2,.01,23,0)
^^5^5^2990518^^^
"^DD",4.2,4.2,.01,23,1,0)
Although the standard says that domain names may be 255 characters,
"^DD",4.2,4.2,.01,23,2,0)
and each dot piece may be 63 characters, MailMan must limit these,
"^DD",4.2,4.2,.01,23,3,0)
because of operating system restrictions.  MailMan places addresses
"^DD",4.2,4.2,.01,23,4,0)
in globals such as ^TMP("XMY0",$J,<name@site>)="".  If the address
"^DD",4.2,4.2,.01,23,5,0)
is too long, it can cause an invalid subscript error.
"^DD",4.2,4.2,.01,"DT")
2990518
"^DD",4.2,4.2,1,0)
FLAGS^FX^^0;2^K:X[""""!($A(X)=45) X I $D(X) K:$L(X)>5!($L(X)<1) X S:$D(X) X=$$UP^XLFSTR(X)
"^DD",4.2,4.2,1,1,0)
^.1
"^DD",4.2,4.2,1,1,1,0)
4.2^AC^MUMPS
"^DD",4.2,4.2,1,1,1,1)
I X["P" S ^DIC(4.2,"AC","P",DA)=""
"^DD",4.2,4.2,1,1,1,2)
K ^DIC(4.2,"AC","P",DA)
"^DD",4.2,4.2,1,1,1,"%D",0)
^^2^2^2931212^
"^DD",4.2,4.2,1,1,1,"%D",1,0)
This cross reference keeps track of domains that have the polling
"^DD",4.2,4.2,1,1,1,"%D",2,0)
flag on.
"^DD",4.2,4.2,1,3)
C=CLOSED, S=SEND, Q=QUEUE, N=NO-FORWARD, P=POLL, T=TALKMAN ENABLED
"^DD",4.2,4.2,1,4)

"^DD",4.2,4.2,1,21,0)
19^^19^19^3020422^^^^
"^DD",4.2,4.2,1,21,1,0)
The flags field controls the flow of messages to this domain from the
"^DD",4.2,4.2,1,21,2,0)
local node.  Flags are:
"^DD",4.2,4.2,1,21,3,0)
 
"^DD",4.2,4.2,1,21,4,0)
S = Send.  MailMan should start a TaskMan task to transmit the message
"^DD",4.2,4.2,1,21,5,0)
as soon as the message is received.
"^DD",4.2,4.2,1,21,6,0)
 
"^DD",4.2,4.2,1,21,7,0)
C = Close.  MailMan will not allow users to address mail to this domain.
"^DD",4.2,4.2,1,21,8,0)
 
"^DD",4.2,4.2,1,21,9,0)
Q or "" (the null string) = Queue.  MailMan will not deliver until a
"^DD",4.2,4.2,1,21,10,0)
task is explicitly created to deliver the mail.
"^DD",4.2,4.2,1,21,11,0)
 
"^DD",4.2,4.2,1,21,12,0)
P = Poll.  A TaskMan task will poll all domains with this flag.
"^DD",4.2,4.2,1,21,13,0)
 
"^DD",4.2,4.2,1,21,14,0)
N = NO-forward.  MailMan will not allow messages to be forwarded to this
"^DD",4.2,4.2,1,21,15,0)
domain.
"^DD",4.2,4.2,1,21,16,0)
 
"^DD",4.2,4.2,1,21,17,0)
T = Talkman enabled.  The presence of this flag allows Talkman to be 
"^DD",4.2,4.2,1,21,18,0)
used at your site.  It is also necessary to put a 'T' command into
"^DD",4.2,4.2,1,21,19,0)
the script so that TalkMan will be invoked properly.
"^DD",4.2,4.2,1,"DT")
3020422
"^DD",4.2,4.2,1.5,0)
SECURITY KEY^FX^^0;11^K:$L(X)>30!($L(X)<1) X I $D(X) I '$D(^DIC(19.1,"B",X)) W !,*7,"Security key must exactly match an existing security key name" K X
"^DD",4.2,4.2,1.5,3)
Enter the exact name of a security required of the user to address this domain.
"^DD",4.2,4.2,1.5,21,0)
^^3^3^2860225^
"^DD",4.2,4.2,1.5,21,1,0)
This field, if defined, names a security key which must be held by the 
"^DD",4.2,4.2,1.5,21,2,0)
sender.  If the sender does not have this key, then he may not address this
"^DD",4.2,4.2,1.5,21,3,0)
domain.
"^DD",4.2,4.2,1.5,"DT")
2860225
"^DD",4.2,4.2,1.6,0)
VALIDATION NUMBER^NJ8,0^^0;15^K:+X'=X!(X>99999999)!(X<1000000)!(X?.E1"."1N.N) X
"^DD",4.2,4.2,1.6,3)
TYPE A WHOLE NUMBER BETWEEN 1000000 AND 99999999
"^DD",4.2,4.2,1.6,21,0)
^^3^3^2900306^^
"^DD",4.2,4.2,1.6,21,1,0)
This field is used for security.  If filled in any messaging services
"^DD",4.2,4.2,1.6,21,2,0)
that contact you will need to know the value of this field, or their
"^DD",4.2,4.2,1.6,21,3,0)
requests will be ignored.  Messaging services = other MailMan domains.
"^DD",4.2,4.2,1.6,"DT")
2861009
"^DD",4.2,4.2,1.61,0)
NEW VALIDATION NUMBER^NJ8,0^^0;18^K:+X'=X!(X>99999999)!(X<1000000)!(X?.E1"."1N.N) X
"^DD",4.2,4.2,1.61,3)
Type a Number between 1000000 and 99999999, 0 Decimal Digits
"^DD",4.2,4.2,1.61,21,0)
^^3^3^2961112^
"^DD",4.2,4.2,1.61,21,1,0)
This field is used for security.  It is a temporary value, it is set when
"^DD",4.2,4.2,1.61,21,2,0)
a new validation number is negotiated with another Domain. It is moved to
"^DD",4.2,4.2,1.61,21,3,0)
the Validation Number, field 1.6, after it is confirmed by the other Domain.
"^DD",4.2,4.2,1.61,"DT")
2961112
"^DD",4.2,4.2,1.7,0)
DISABLE TURN COMMAND^S^y:YES;n:NO;^0;16^Q
"^DD",4.2,4.2,1.7,21,0)
^^5^5^2861027^^
"^DD",4.2,4.2,1.7,21,1,0)
This field, if set to "YES", means that a remote domain calling this
"^DD",4.2,4.2,1.7,21,2,0)
domain will not be able to execute the SMTP TURN command.  This means
"^DD",4.2,4.2,1.7,21,3,0)
that the sending domain must open the link.  This allows an extra 
"^DD",4.2,4.2,1.7,21,4,0)
measure of security, to insure that the sending domain establishes the
"^DD",4.2,4.2,1.7,21,5,0)
link.
"^DD",4.2,4.2,1.7,"DT")
2861007
"^DD",4.2,4.2,2,0)
RELAY DOMAIN^P4.2^DIC(4.2,^0;3^Q
"^DD",4.2,4.2,2,3)
NAME OF DOMAIN TO SEND MESSAGES TO IF NO DIRECT PATH
"^DD",4.2,4.2,2,21,0)
^^7^7^2840330^
"^DD",4.2,4.2,2,21,1,0)
This is the name of the domain, if any, to which messages are to be
"^DD",4.2,4.2,2,21,2,0)
always routed.  For example, if traffic from Los Angeles to Washington
"^DD",4.2,4.2,2,21,3,0)
is always to be routed through San Francisco, then the RELAY DOMAIN for
"^DD",4.2,4.2,2,21,4,0)
Los Angeles is defined to be San Francisco.  
"^DD",4.2,4.2,2,21,5,0)
 
"^DD",4.2,4.2,2,21,6,0)
The relay domain overides any other path determination processes, such
"^DD",4.2,4.2,2,21,7,0)
as scripts and parent domains.
"^DD",4.2,4.2,2,"DT")
2840330
"^DD",4.2,4.2,4,0)
TRANSMISSION SCRIPT^4.21^^1;0
"^DD",4.2,4.2,4,21,0)
^^14^14^2960716^^^^
"^DD",4.2,4.2,4,21,1,0)
See the Technical Description for how this field is used in implicit
"^DD",4.2,4.2,4,21,2,0)
routing by the name server.  This field should always have at least one
"^DD",4.2,4.2,4,21,3,0)
Script command in it unless implicit routing is desirable.
"^DD",4.2,4.2,4,21,4,0)
Each line of this text field is interpreted by the MailMan script processor.
"^DD",4.2,4.2,4,21,5,0)
 
"^DD",4.2,4.2,4,21,6,0)
There are commands to be used:
"^DD",4.2,4.2,4,21,7,0)
 
"^DD",4.2,4.2,4,21,8,0)
  Open
"^DD",4.2,4.2,4,21,9,0)
  Device
"^DD",4.2,4.2,4,21,10,0)
  Wait
"^DD",4.2,4.2,4,21,11,0)
  Xecute
"^DD",4.2,4.2,4,21,12,0)
  Call
"^DD",4.2,4.2,4,21,13,0)
 
"^DD",4.2,4.2,4,21,14,0)
These commands are described in other documentation.
"^DD",4.2,4.2,4,23,0)
17^^17^17^2960716^
"^DD",4.2,4.2,4,23,1,0)
MailMan looks at this field at two different points.  The most obvious is
"^DD",4.2,4.2,4,23,2,0)
that this field contains a script that is interpreted by the script
"^DD",4.2,4.2,4,23,3,0)
processor.  This gives results that are explicitely defined.
"^DD",4.2,4.2,4,23,4,0)
 
"^DD",4.2,4.2,4,23,5,0)
However, this field is also looked at by the name server to determine
"^DD",4.2,4.2,4,23,6,0)
implicit routing.  The implication to the system, if this field is not
"^DD",4.2,4.2,4,23,7,0)
defined is that the local system does not know how to deliver mail to
"^DD",4.2,4.2,4,23,8,0)
this domain.  (There are no directions in the form of a Transmission Script
"^DD",4.2,4.2,4,23,9,0)
to tell MailMan what to do.)  Since, this system doesn't know how to deliver
"^DD",4.2,4.2,4,23,10,0)
the message, it is assumed that the parent of this system does know.
"^DD",4.2,4.2,4,23,11,0)
Therefore, if a domain has no data at all in the Transmission Script field,
"^DD",4.2,4.2,4,23,12,0)
MailMan routes messages sent to it to the local domain's parent.
"^DD",4.2,4.2,4,23,13,0)
This often occurs with subdomains.    No protection exists to
"^DD",4.2,4.2,4,23,14,0)
prevent infinite loops of transmissions that can occur when the
"^DD",4.2,4.2,4,23,15,0)
parent has no entry for the subdomain and therefore implicitely assumes
"^DD",4.2,4.2,4,23,16,0)
that it should route the message to the subdomain's creator.  Other problems
"^DD",4.2,4.2,4,23,17,0)
that do not cause systems to be misued have can still occur, also.
"^DD",4.2,4.2,4.2,0)
NOTES^4.25^^5;0
"^DD",4.2,4.2,4.2,21,0)
^^2^2^2990123^^^
"^DD",4.2,4.2,4.2,21,1,0)
NETWORK NOTES should be used to document idiosyncracies
"^DD",4.2,4.2,4.2,21,2,0)
which occur when communicating with the domain in question.
"^DD",4.2,4.2,5,0)
SYNONYM^4.23^^2;0
"^DD",4.2,4.2,5,21,0)
^^1^1^2851009^^
"^DD",4.2,4.2,5,21,1,0)
Other names by which this domain is known.
"^DD",4.2,4.2,5.5,0)
STATION^F^^0;13^K:$L(X)>7!($L(X)<3)!'(X?3N.E) X
"^DD",4.2,4.2,5.5,.1)
STATION
"^DD",4.2,4.2,5.5,3)
ANSWER MUST BE 3-7 CHARACTERS IN LENGTH
"^DD",4.2,4.2,5.5,21,0)
^^1^1^2881107^
"^DD",4.2,4.2,5.5,21,1,0)
This is the domain's station.
"^DD",4.2,4.2,5.5,"DT")
2860423
"^DD",4.2,4.2,6,0)
MCTS ROUTING INDICATOR^F^^0;4^K:$L(X)>3!($L(X)<3)!'(X?3U) X
"^DD",4.2,4.2,6,3)
Must be three upper case letters
"^DD",4.2,4.2,6,21,0)
^^2^2^2860619^^^
"^DD",4.2,4.2,6,21,1,0)
This is a three character routing indicator for the VADATS network's
"^DD",4.2,4.2,6,21,2,0)
MCTS terminal system.
"^DD",4.2,4.2,6,21,3,0)
statistics reflect the messages as they are actually transmitted, not
"^DD",4.2,4.2,6,21,4,0)
as they are addressed.
"^DD",4.2,4.2,6,"DT")
2850320
"^DD",4.2,4.2,6.2,0)
DHCP ROUTING INDICATOR^F^^0;14^K:X[""""!($A(X)=45) X I $D(X) K:$L(X)>3!($L(X)<3) X
"^DD",4.2,4.2,6.2,1,0)
^.1
"^DD",4.2,4.2,6.2,1,1,0)
4.2^AD
"^DD",4.2,4.2,6.2,1,1,1)
S ^DIC(4.2,"AD",$E(X,1,30),DA)=""
"^DD",4.2,4.2,6.2,1,1,2)
K ^DIC(4.2,"AD",$E(X,1,30),DA)
"^DD",4.2,4.2,6.2,3)
ANSWER MUST BE 3 CHARACTERS IN LENGTH
"^DD",4.2,4.2,6.2,21,0)
^^2^2^2931214^
"^DD",4.2,4.2,6.2,21,1,0)
This field is used to route messages when they arrive at the
"^DD",4.2,4.2,6.2,21,2,0)
central data collection point at the domain FOC-AUSTIN.VA.GOV.
"^DD",4.2,4.2,6.2,"DT")
2900710
"^DD",4.2,4.2,6.5,0)
MAILMAN HOST^F^^0;12^K:$L(X)>20!($L(X)<2) X
"^DD",4.2,4.2,6.5,3)
Answer must be 2-20 characters in length.
"^DD",4.2,4.2,6.5,21,0)
^^2^2^2931214^
"^DD",4.2,4.2,6.5,21,1,0)
This field contains a logical or physical address of a remote domain
"^DD",4.2,4.2,6.5,21,2,0)
so that a connection can occur.
"^DD",4.2,4.2,6.5,"DT")
2940602
"^DD",4.2,4.2,6.6,0)
FTP BLOB IP ADDRESS^F^^IP;1^K:X[""""!($A(X)=45) X I $D(X) K:$L(X)>15!($L(X)<7)!'(X?1.N1"."1.N1"."1.N1"."1.N) X
"^DD",4.2,4.2,6.6,1,0)
^.1^^0
"^DD",4.2,4.2,6.6,3)
Enter a valid IP address in the form:  nn.nn.nn.nn
"^DD",4.2,4.2,6.6,21,0)
^^2^2^2931214^
"^DD",4.2,4.2,6.6,21,1,0)
This field contains the IP address of this host so that it can be
"^DD",4.2,4.2,6.6,21,2,0)
used as the to address for files that will be sent to this domain.
"^DD",4.2,4.2,6.6,"DT")
2930219
"^DD",4.2,4.2,6.61,0)
TCP/IP POLL FLAG^S^0:DO NOT POLL;1:POLL;^P;1^Q
"^DD",4.2,4.2,6.61,1,0)
^.1
"^DD",4.2,4.2,6.61,1,1,0)
4.2^D
"^DD",4.2,4.2,6.61,1,1,1)
S ^DIC(4.2,"D",$E(X,1,30),DA)=""
"^DD",4.2,4.2,6.61,1,1,2)
K ^DIC(4.2,"D",$E(X,1,30),DA)
"^DD",4.2,4.2,6.61,1,1,3)
If this cross reference is deleted, netmail may not be transmitted.
"^DD",4.2,4.2,6.61,1,1,"DT")
2920611
"^DD",4.2,4.2,6.61,1,2,0)
4.2^ATCP
"^DD",4.2,4.2,6.61,1,2,1)
S ^DIC(4.2,"ATCP",$E(X,1,30),DA)=""
"^DD",4.2,4.2,6.61,1,2,2)
K ^DIC(4.2,"ATCP",$E(X,1,30),DA)
"^DD",4.2,4.2,6.61,1,2,"%D",0)
^^3^3^2920706^
"^DD",4.2,4.2,6.61,1,2,"%D",1,0)
This cross reference is used by XMRTCP to poll domains that have messages
"^DD",4.2,4.2,6.61,1,2,"%D",2,0)
to be sent out.  TaskMan does not run on the node that has the TCP/IP
"^DD",4.2,4.2,6.61,1,2,"%D",3,0)
device sometimes.
"^DD",4.2,4.2,6.61,1,2,"DT")
2920706
"^DD",4.2,4.2,6.61,21,0)
^.001^3^3^3020128^^
"^DD",4.2,4.2,6.61,21,1,0)
This is the information needed to log in the FTP service of this site
"^DD",4.2,4.2,6.61,21,2,0)
if the standard route needs to be overridden.
"^DD",4.2,4.2,6.61,21,3,0)
.
"^DD",4.2,4.2,6.61,21,4,0)
This field is required.  Set the value of it to zero ("0" Do Not Poll)
"^DD",4.2,4.2,6.61,21,5,0)
unless you know that you are using the XMRTCP TCP/IP poller.
"^DD",4.2,4.2,6.61,"DT")
2920706
"^DD",4.2,4.2,6.62,0)
FTP^FX^^3;1^K:$L(X)>61!($L(X)<7) X I X'?2.E1";"2.E K X
"^DD",4.2,4.2,6.62,3)
Answer must be 7-61 characters in length.
"^DD",4.2,4.2,6.62,21,0)
^^6^6^2930426^^^
"^DD",4.2,4.2,6.62,21,1,0)
This is the information needed by to log into an FTP service to send
"^DD",4.2,4.2,6.62,21,2,0)
files.  It is overridden by the site if they wish in their Kernel Site
"^DD",4.2,4.2,6.62,21,3,0)
Parameters and sent to the sender in real time.
"^DD",4.2,4.2,6.62,21,4,0)
 
"^DD",4.2,4.2,6.62,21,5,0)
There are really two pieces of data in this field separated by a ";".
"^DD",4.2,4.2,6.62,21,6,0)
Piece number 1 is the username.  Piece number 2 is the password.
"^DD",4.2,4.2,6.62,"DT")
2930426
"^DD",4.2,4.2,6.7,0)
FTP BLOB DIRECTORY^F^^FTP-DIR;1^K:$L(X)>40!($L(X)<2) X
"^DD",4.2,4.2,6.7,3)
Answer must be 2-40 characters in length.
"^DD",4.2,4.2,6.7,21,0)
^^2^2^2931214^^
"^DD",4.2,4.2,6.7,21,1,0)
This field contains the directory into which a file should be put
"^DD",4.2,4.2,6.7,21,2,0)
by a domain sending it files to attach to multimedia messages.
"^DD",4.2,4.2,6.7,"DT")
2930301
"^DD",4.2,4.2,16,0)
POLL LIST^4.24^^4;0
"^DD",4.2,4.2,16,3)
ANSWER MUST BE 1-15 CHARACTERS IN LENGTH
"^DD",4.2,4.2,16,21,0)
^^2^2^2931214^^
"^DD",4.2,4.2,16,21,1,0)
If this domain belongs to a poll list, then it will be activated when
"^DD",4.2,4.2,16,21,2,0)
a background poller is activated to send mail to this list.
"^DD",4.2,4.2,16,"DT")
2860228
"^DD",4.2,4.2,17,0)
PHYSICAL LINK DEVICE^FX^^0;17^K:$L(X)>30!($L(X)<1) X I $D(X) S %ZIS="NQRS",IOP=X D ^%ZIS K:POP X S:$D(X) X=ION W:$D(X) " Stored internally as ",X D ^%ZISC S IOP="HOME" D ^%ZIS K IOP,%ZIS
"^DD",4.2,4.2,17,3)
MUST MATCH THE NAME FIELD IN THE DEVICE FILE.
"^DD",4.2,4.2,17,21,0)
^^18^18^2881121^^^^
"^DD",4.2,4.2,17,21,1,0)
This field is used for network mail ONLY.
"^DD",4.2,4.2,17,21,2,0)
If there is an entry in this field, it will override any device that is
"^DD",4.2,4.2,17,21,3,0)
named in the TRANSMISSION SCRIPT field.  If there is no entry in this field,
"^DD",4.2,4.2,17,21,4,0)
the device named in the transmission script will be used.
"^DD",4.2,4.2,17,21,5,0)
If this domain has a physical link such as a miniengine port,
"^DD",4.2,4.2,17,21,6,0)
a direct line to another cpu, a modem, etc., this port should be named
"^DD",4.2,4.2,17,21,7,0)
in this field to direct network mail to the proper output device.
"^DD",4.2,4.2,17,21,8,0)
There must be an entry in the DEVICE file for this cpu port.  The name
"^DD",4.2,4.2,17,21,9,0)
field of the DEVICE file can be a literal (such as MINIENGINE-OUT or
"^DD",4.2,4.2,17,21,10,0)
CPU B LINK) but the $I field must match with the correct cpu $I.
"^DD",4.2,4.2,17,21,11,0)
If the link is physically located on a cpu other than the one the network
"^DD",4.2,4.2,17,21,12,0)
mail is being sent from, the local DEVICE file MUST reflect that in the
"^DD",4.2,4.2,17,21,13,0)
OTHER CPU field of the device file if the transmission is to take place
"^DD",4.2,4.2,17,21,14,0)
immediately.  If it is not identified properly, the message will go into
"^DD",4.2,4.2,17,21,15,0)
a queue to be processed the next time a network message is sent from or
"^DD",4.2,4.2,17,21,16,0)
recieved on the processor with the physical link.
"^DD",4.2,4.2,17,21,17,0)
NOTE:  The DEVICE files on all cpu's must have matching device names
"^DD",4.2,4.2,17,21,18,0)
       to correctly route the message to the proper cpu for sending.
"^DD",4.2,4.2,17,"DT")
2911217
"^DD",4.2,4.2,20,0)
LEVEL 1 NAME^CJ8^^ ; ^X ^DD(4.2,20,9.2) S Y(4.2,20,5)=X S X=".",X=$L(Y(4.2,20,5),X),X=$P(Y(4.2,20,2),Y(4.2,20,3),X)
"^DD",4.2,4.2,20,9)
^
"^DD",4.2,4.2,20,9.01)
4.2^.01
"^DD",4.2,4.2,20,9.1)
$P(NAME,".",$L(NAME,"."))
"^DD",4.2,4.2,20,9.2)
S Y(4.2,20,1)=$S($D(^DIC(4.2,D0,0)):^(0),1:"") S X=$P(Y(4.2,20,1),U,1),Y(4.2,20,2)=X S X=".",Y(4.2,20,3)=X,Y(4.2,20,4)=X S X=$P(Y(4.2,20,1),U,1)
"^DD",4.2,4.2,20,21,0)
^^2^2^2881107^
"^DD",4.2,4.2,20,21,1,0)
The most right "." piece of a domain name 
"^DD",4.2,4.2,20,21,2,0)
($P(domain-name,".",$L(domain-name,"."))
"^DD",4.2,4.2,21,0)
LEVEL 2 NAME^CJ8^^ ; ^X ^DD(4.2,21,9.2) S Y(4.2,21,5)=X S X=".",X=$L(Y(4.2,21,5),X)-1,Y(4.2,21,6)=X S X=9,X=$P(Y(4.2,21,2),Y(4.2,21,3),Y(4.2,21,6),X)
"^DD",4.2,4.2,21,9)
^
"^DD",4.2,4.2,21,9.01)
4.2^.01
"^DD",4.2,4.2,21,9.1)
$P(NAME,".",$L(NAME,".")-1)
"^DD",4.2,4.2,21,9.2)
S Y(4.2,21,1)=$S($D(^DIC(4.2,D0,0)):^(0),1:"") S X=$P(Y(4.2,21,1),U,1),Y(4.2,21,2)=X S X=".",Y(4.2,21,3)=X,Y(4.2,21,4)=X S X=$P(Y(4.2,21,1),U,1)
"^DD",4.2,4.2,21,21,0)
^^1^1^2881107^^
"^DD",4.2,4.2,21,21,1,0)
$P(domain-name,".",$L(domain-name,".")-1)
"^DD",4.2,4.2,22,0)
LEVEL 3 NAME^CJ8^^ ; ^X ^DD(4.2,22,9.2) S Y(4.2,22,5)=X S X=".",X=$L(Y(4.2,22,5),X)-2,Y(4.2,22,6)=X S X=9,X=$P(Y(4.2,22,2),Y(4.2,22,3),Y(4.2,22,6),X)
"^DD",4.2,4.2,22,9)
^
"^DD",4.2,4.2,22,9.01)
4.2^.01
"^DD",4.2,4.2,22,9.1)
$P(NAME,".",$L(NAME,".")-2)
"^DD",4.2,4.2,22,9.2)
S Y(4.2,22,1)=$S($D(^DIC(4.2,D0,0)):^(0),1:"") S X=$P(Y(4.2,22,1),U,1),Y(4.2,22,2)=X S X=".",Y(4.2,22,3)=X,Y(4.2,22,4)=X S X=$P(Y(4.2,22,1),U,1)
"^DD",4.2,4.2,22,21,0)
^^1^1^2881107^
"^DD",4.2,4.2,22,21,1,0)
$P(domain-name,".",$L(domain-name,".")-2)
"^DD",4.2,4.2,23,0)
LEVEL 4 NAME^CJ8^^ ; ^X ^DD(4.2,23,9.2) S Y(4.2,23,5)=X S X=".",X=$L(Y(4.2,23,5),X)-3,Y(4.2,23,6)=X S X=9,X=$P(Y(4.2,23,2),Y(4.2,23,3),Y(4.2,23,6),X)
"^DD",4.2,4.2,23,9)
^
"^DD",4.2,4.2,23,9.01)
4.2^.01
"^DD",4.2,4.2,23,9.1)
$P(NAME,".",$L(NAME,".")-3)
"^DD",4.2,4.2,23,9.2)
S Y(4.2,23,1)=$S($D(^DIC(4.2,D0,0)):^(0),1:"") S X=$P(Y(4.2,23,1),U,1),Y(4.2,23,2)=X S X=".",Y(4.2,23,3)=X,Y(4.2,23,4)=X S X=$P(Y(4.2,23,1),U,1)
"^DD",4.2,4.2,23,9.3)
X ^DD(4.2,23,9.2) S Y(4.2,23,5)=X,X=".",Y(4.2,23,6)=X,X=$L(Y(4.2,23,5),X),Y(4.2,23,6)=X,Y(4.2,23,7)=X S X=9
"^DD",4.2,4.2,23,21,0)
^^1^1^2881107^
"^DD",4.2,4.2,23,21,1,0)
$P(domain-name,".",$L(domain-name,".")-3)
"^DD",4.2,4.2,23,"DT")
2870406
"^DD",4.2,4.2,50,0)
DIRECTORY REQUESTS FLAG^NJ2,0X^^50;1^I $S(X="":0,X\1'=X:1,X>99:1,1:0) K X
"^DD",4.2,4.2,50,1,0)
^.1
"^DD",4.2,4.2,50,1,1,0)
4.2^AE
"^DD",4.2,4.2,50,1,1,1)
S ^DIC(4.2,"AE",$E(X,1,30),DA)=""
"^DD",4.2,4.2,50,1,1,2)
K ^DIC(4.2,"AE",$E(X,1,30),DA)
"^DD",4.2,4.2,50,1,1,"DT")
2930323
"^DD",4.2,4.2,50,3)
Type a Number between 0 and 99, 0 Decimal Digits
"^DD",4.2,4.2,50,21,0)
10
"^DD",4.2,4.2,50,21,1,0)
This field controls whether or not the XMMGR-DIRECTORY-ALL option
"^DD",4.2,4.2,50,21,2,0)
will send a message requesting the user directory for the domain.
"^DD",4.2,4.2,50,21,3,0)
 
"^DD",4.2,4.2,50,21,4,0)
If the value is null or zero, no request will be made.
"^DD",4.2,4.2,50,21,5,0)
If the value is a positive integer, a request will be made
"^DD",4.2,4.2,50,21,6,0)
at the same time as other domains with the same number in this
"^DD",4.2,4.2,50,21,7,0)
field are made.  A task must be set up and scheduled for each
"^DD",4.2,4.2,50,21,8,0)
number assigned using the XMDIR-REQUEST-ALL option, which is then
"^DD",4.2,4.2,50,21,9,0)
run every 90 days (or according to what you change the reschedule
"^DD",4.2,4.2,50,21,10,0)
value to).
"^DD",4.2,4.2,50,"DT")
2930902
"^DD",4.2,4.21,0)
TRANSMISSION SCRIPT SUB-FIELD^NL^99^9
"^DD",4.2,4.21,0,"DT")
2960716
"^DD",4.2,4.21,0,"IX","AC",4.21,1)

"^DD",4.2,4.21,0,"IX","B",4.21,.01)

"^DD",4.2,4.21,0,"NM","TRANSMISSION SCRIPT")

"^DD",4.2,4.21,0,"UP")
4.2
"^DD",4.2,4.21,.01,0)
TRANSMISSION SCRIPT^MF^^0;1^K:$L(X)>10!($L(X)<1) X
"^DD",4.2,4.21,.01,.1)
A free text string of 1 to 10 characters identifying the script.
"^DD",4.2,4.21,.01,1,0)
^.1
"^DD",4.2,4.21,.01,1,1,0)
4.21^B
"^DD",4.2,4.21,.01,1,1,1)
S ^DIC(4.2,DA(1),1,"B",$E(X,1,30),DA)=""
"^DD",4.2,4.21,.01,1,1,2)
K ^DIC(4.2,DA(1),1,"B",$E(X,1,30),DA)
"^DD",4.2,4.21,.01,1,1,"DT")
3010102
"^DD",4.2,4.21,.01,3)
ANSWER MUST BE 1-10 CHARACTERS IN LENGTH
"^DD",4.2,4.21,.01,21,0)
^^1^1^3020422^^^
"^DD",4.2,4.21,.01,21,1,0)
This is the name of the transmission script.
"^DD",4.2,4.21,.01,"DT")
3020422
"^DD",4.2,4.21,1,0)
PRIORITY^NJ4,0^^0;2^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1N.N) X
"^DD",4.2,4.21,1,1,0)
^.1
"^DD",4.2,4.21,1,1,1,0)
4.21^AC
"^DD",4.2,4.21,1,1,1,1)
S ^DIC(4.2,DA(1),1,"AC",$E(X,1,30),DA)=""
"^DD",4.2,4.21,1,1,1,2)
K ^DIC(4.2,DA(1),1,"AC",$E(X,1,30),DA)
"^DD",4.2,4.21,1,1,1,"%D",0)
^^3^3^2930317^
"^DD",4.2,4.21,1,1,1,"%D",1,0)
This cross reference controls which transmission script will be used to
"^DD",4.2,4.21,1,1,1,"%D",2,0)
trnsmit messages.  The highest priority script wil be used first.  Low
"^DD",4.2,4.21,1,1,1,"%D",3,0)
numbers mean high priority.
"^DD",4.2,4.21,1,1,1,"DT")
2930317
"^DD",4.2,4.21,1,3)
Type a Number between 0 and 9999, 0 Decimal Digits
"^DD",4.2,4.21,1,21,0)
^^3^3^2930312^
"^DD",4.2,4.21,1,21,1,0)
This field is used by MailMan to decide which script to play when trying
"^DD",4.2,4.21,1,21,2,0)
to transmit messages in background.  The higher the number the lower the
"^DD",4.2,4.21,1,21,3,0)
priority for being chosen.  See also the Number of Attempts field.
"^DD",4.2,4.21,1,21,4,0)
When MailMan is transmitting using the TCP/IP Poller (XMRTCP), it
"^DD",4.2,4.21,1,21,5,0)
assumes that there is only one  possible TCP/IP connection per domain and
"^DD",4.2,4.21,1,21,6,0)
does not look for multiple scripts to roll over to.  This field is only
"^DD",4.2,4.21,1,21,7,0)
operable for SMTP type scripts (using standard asynchronous WAN connections).
"^DD",4.2,4.21,1,21,8,0)
PRIORITIES can go from 0 to 9999 where 0 is the highest and 9999 is the
"^DD",4.2,4.21,1,21,9,0)
lowest.  If the field has no value, 9999 is assumed.
"^DD",4.2,4.21,1,"DT")
2930317
"^DD",4.2,4.21,1.1,0)
NUMBER OF ATTEMPTS^NJ4,0^^0;3^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1N.N) X
"^DD",4.2,4.21,1.1,3)
Type a Number between 0 and 9999, 0 Decimal Digits
"^DD",4.2,4.21,1.1,21,0)
^^5^5^2930312^^
"^DD",4.2,4.21,1.1,21,1,0)
MailMan tests against this field to determine how many times it should
"^DD",4.2,4.21,1.1,21,2,0)
try a particular protocol before giving up and trying the next one.
"^DD",4.2,4.21,1.1,21,3,0)
This field is used in conjunction with the Priority field.  When the
"^DD",4.2,4.21,1.1,21,4,0)
the Number of tries to transmit the messages in the queue exceeds the value
"^DD",4.2,4.21,1.1,21,5,0)
of this field, a Transmission Failure bulletin is sent to the Postmaster.
"^DD",4.2,4.21,1.1,21,6,0)
This field is only active with the SMTP type of transmission script.
"^DD",4.2,4.21,1.1,23,0)
^^2^2^2930312^
"^DD",4.2,4.21,1.1,23,1,0)
 
"^DD",4.2,4.21,1.1,23,2,0)
 
"^DD",4.2,4.21,1.1,"DT")
2930312
"^DD",4.2,4.21,1.2,0)
TYPE^S^FTP:File Transfer Protocol;SMTP:Simple Mail Transfer Protocol;TELNET:Interactive / TalkMan;TCPCHAN:TCP/IP Channel;OTHER:OTHER;^0;4^Q
"^DD",4.2,4.21,1.2,21,0)
^^2^2^2931214^
"^DD",4.2,4.21,1.2,21,1,0)
Each transmission script must be given a type so that it
"^DD",4.2,4.21,1.2,21,2,0)
can be handled properly.
"^DD",4.2,4.21,1.2,21,3,0)
asynchronous connections on the WAN are of the type IDCU.  These scripts
"^DD",4.2,4.21,1.2,21,4,0)
may compete with each other according to their priorities (See the
"^DD",4.2,4.21,1.2,21,5,0)
PRIORITY field).  Scripts that use TCP/IP channels should be marked
"^DD",4.2,4.21,1.2,21,6,0)
with the type TCPCHAN so that they are ignored during prioritization
"^DD",4.2,4.21,1.2,21,7,0)
unless the TCP/IP enabled CPUs have Task Manager running on them, in
"^DD",4.2,4.21,1.2,21,8,0)
which case they should be made SMTP type.
"^DD",4.2,4.21,1.2,21,9,0)
 
"^DD",4.2,4.21,1.2,21,10,0)
In other words, if the physical link is on a CPU that Task Manager runs
"^DD",4.2,4.21,1.2,21,11,0)
on the transmission script can be of the type SMTP.  If it is not on such
"^DD",4.2,4.21,1.2,21,12,0)
a CPU another type must be chosen.
"^DD",4.2,4.21,1.2,21,13,0)
 
"^DD",4.2,4.21,1.2,21,14,0)
Other types are TELNET (used for TalkMan or other interactive scripts),
"^DD",4.2,4.21,1.2,21,15,0)
FTP (for File Transfers) and Other.
"^DD",4.2,4.21,1.2,"DT")
2931218
"^DD",4.2,4.21,1.3,0)
PHYSICAL LINK / DEVICE^FX^^0;5^K:$L(X)>30!($L(X)<1) X I $D(X) S %ZIS="NQRS",IOP=X D ^%ZIS K:POP X S:$D(X) X=ION W:$D(X) " Stored internally as ",X D ^%ZISC S IOP="HOME" D ^%ZIS K IOP,%ZIS
"^DD",4.2,4.21,1.3,3)
Answer must be 3-30 characters in length.
"^DD",4.2,4.21,1.3,21,0)
^^4^4^2930312^
"^DD",4.2,4.21,1.3,21,1,0)
The physical link is the channel that the transmission will take place
"^DD",4.2,4.21,1.3,21,2,0)
on.  This field is always a free text pointer to the device file.
"^DD",4.2,4.21,1.3,21,3,0)
See field 17 / Physical Link Device for more information.
"^DD",4.2,4.21,1.3,21,4,0)
 
"^DD",4.2,4.21,1.3,23,0)
^^1^1^2930312^
"^DD",4.2,4.21,1.3,23,1,0)
 
"^DD",4.2,4.21,1.3,"DT")
2930312
"^DD",4.2,4.21,1.4,0)
NETWORK ADDRESS (MAILMAN HOST)^F^^0;6^K:$L(X)>50!($L(X)<3) X
"^DD",4.2,4.21,1.4,3)
Answer must be 3-50 characters in length.
"^DD",4.2,4.21,1.4,21,0)
^^2^2^2930312^
"^DD",4.2,4.21,1.4,21,1,0)
The network address is that identifier that, used appropriately on the
"^DD",4.2,4.21,1.4,21,2,0)
physical link, allows specification of the system to be contacted.
"^DD",4.2,4.21,1.4,"DT")
2930312
"^DD",4.2,4.21,1.5,0)
OUT OF SERVICE^S^0:in service;1:out of service;^0;7^Q
"^DD",4.2,4.21,1.5,3)
If you don't want this script to be used, set this field to 1 otherwise leave it blank or set it to zero.
"^DD",4.2,4.21,1.5,21,0)
^^2^2^2960716^
"^DD",4.2,4.21,1.5,21,1,0)
This is the preferred field to set to take a script out of service,
"^DD",4.2,4.21,1.5,21,2,0)
to prevent it from being used.
"^DD",4.2,4.21,1.5,"DT")
3020422
"^DD",4.2,4.21,2,0)
TEXT^4.22^^1;0
"^DD",4.2,4.21,2,21,0)
^.001^1^1^3020422^^^
"^DD",4.2,4.21,2,21,1,0)
This is the text of the script.  See description above.
"^DD",4.2,4.21,99,0)
TRANSMISSION SCRIPT NOTES^4.299^^NOTES;0
"^DD",4.2,4.21,99,21,0)
^^1^1^2931214^
"^DD",4.2,4.21,99,21,1,0)
Keep notes that are important for systems management here.
"^DD",4.2,4.21,99,"DT")
2930405
"^DD",4.2,4.22,0)
TEXT SUB-FIELD^NL^.01^1
"^DD",4.2,4.22,0,"NM","TEXT")

"^DD",4.2,4.22,0,"UP")
4.21
"^DD",4.2,4.22,.01,0)
TEXT^WL^^0;1^Q
"^DD",4.2,4.22,.01,3)
Enter the text to be used to connect to the site.
"^DD",4.2,4.22,.01,21,0)
^.001^1^1^3020422^^^^
"^DD",4.2,4.22,.01,21,1,0)
This is the text of the script.  See description above.
"^DD",4.2,4.22,.01,"DT")
3020422
"^DD",4.2,4.23,0)
SYNONYM SUB-FIELD^NL^.01^1
"^DD",4.2,4.23,0,"DT")
2990518
"^DD",4.2,4.23,0,"NM","SYNONYM")

"^DD",4.2,4.23,0,"UP")
4.2
"^DD",4.2,4.23,.01,0)
SYNONYM^MF^^0;1^K:X[""""!($A(X)=45) X I $D(X) K:$L(X)>64!($L(X)<1) X
"^DD",4.2,4.23,.01,1,0)
^.1
"^DD",4.2,4.23,.01,1,1,0)
4.2^C^MUMPS
"^DD",4.2,4.23,.01,1,1,1)
S ^DIC(4.2,"C",$E(X,1,64),DA(1),DA)=""
"^DD",4.2,4.23,.01,1,1,2)
K ^DIC(4.2,"C",$E(X,1,64),DA(1),DA)
"^DD",4.2,4.23,.01,1,1,"DT")
2990503
"^DD",4.2,4.23,.01,3)
Answer must be 1-64 characters in length.
"^DD",4.2,4.23,.01,21,0)
^^3^3^3020422^^^^
"^DD",4.2,4.23,.01,21,1,0)
Another name by which this Domain is known. For example,
"^DD",4.2,4.23,.01,21,2,0)
"San Francisco, CA" can be a synonym of the domain
"^DD",4.2,4.23,.01,21,3,0)
"SANFRANCISCO.MED.VA.GOV".
"^DD",4.2,4.23,.01,"DT")
3020422
"^DD",4.2,4.24,0)
POLL LIST SUB-FIELD^^.01^1
"^DD",4.2,4.24,0,"NM","POLL LIST")

"^DD",4.2,4.24,0,"UP")
4.2
"^DD",4.2,4.24,.01,0)
POLL LIST^MNJ7,2^^0;1^K:+X'=X!(X>1000)!(X<0)!(X?.E1"."3N.N) X
"^DD",4.2,4.24,.01,1,0)
^.1
"^DD",4.2,4.24,.01,1,1,0)
4.2^AB
"^DD",4.2,4.24,.01,1,1,1)
S ^DIC(4.2,"AB",$E(X,1,30),DA(1),DA)=""
"^DD",4.2,4.24,.01,1,1,2)
K ^DIC(4.2,"AB",$E(X,1,30),DA(1),DA)
"^DD",4.2,4.24,.01,3)
Enter a poll list number between 0 and 1000
"^DD",4.2,4.24,.01,21,0)
^^2^2^2931214^
"^DD",4.2,4.24,.01,21,1,0)
If this domain belongs to a poll list, then it will be activated when
"^DD",4.2,4.24,.01,21,2,0)
a background poller is activated to send mail to this list.
"^DD",4.2,4.24,.01,"DT")
2860625
"^DD",4.2,4.25,0)
NOTES SUB-FIELD^^.01^1
"^DD",4.2,4.25,0,"DT")
2920312
"^DD",4.2,4.25,0,"NM","NOTES")

"^DD",4.2,4.25,0,"UP")
4.2
"^DD",4.2,4.25,.01,0)
NETWORK NOTES^WL^^0;1^Q
"^DD",4.2,4.25,.01,21,0)
^^2^2^2990123^^
"^DD",4.2,4.25,.01,21,1,0)
NETWORK NOTES should be used to document idiosyncracies
"^DD",4.2,4.25,.01,21,2,0)
which occur when communicating with the domain in question.
"^DD",4.2,4.25,.01,"DT")
2920312
"^DD",4.2,4.299,0)
TRANSMISSION SCRIPT NOTES SUB-FIELD^^.01^1
"^DD",4.2,4.299,0,"DT")
2930312
"^DD",4.2,4.299,0,"NM","TRANSMISSION SCRIPT NOTES")

"^DD",4.2,4.299,0,"UP")
4.21
"^DD",4.2,4.299,.01,0)
NOTES^WL^^0;1^Q
"^DD",4.2,4.299,.01,21,0)
^^1^1^2931214^
"^DD",4.2,4.299,.01,21,1,0)
Keep notes that are important for systems management here.
"^DD",4.2,4.299,.01,"DT")
2930312
"^DD",4.281,4.281,0)
FIELD^^2^3
"^DD",4.281,4.281,0,"DDA")
N
"^DD",4.281,4.281,0,"DT")
3020219
"^DD",4.281,4.281,0,"IX","B",4.281,.01)

"^DD",4.281,4.281,0,"IX","C",4.281,1)

"^DD",4.281,4.281,0,"NM","INTER-UCI TRANSFER")

"^DD",4.281,4.281,.01,0)
FROM DOMAIN^RF^^0;1^K:$L(X)>64!($L(X)<3)!'(X'?1P.E) X
"^DD",4.281,4.281,.01,1,0)
^.1
"^DD",4.281,4.281,.01,1,1,0)
4.281^B
"^DD",4.281,4.281,.01,1,1,1)
S ^%ZISL(4.281,"B",$E(X,1,64),DA)=""
"^DD",4.281,4.281,.01,1,1,2)
K ^%ZISL(4.281,"B",$E(X,1,64),DA)
"^DD",4.281,4.281,.01,3)
Answer must be 3-64 characters in length
"^DD",4.281,4.281,.01,"DT")
3020219
"^DD",4.281,4.281,1,0)
TO DOMAIN^F^^0;2^K:$L(X)>64!($L(X)<3) X
"^DD",4.281,4.281,1,1,0)
^.1
"^DD",4.281,4.281,1,1,1,0)
4.281^C
"^DD",4.281,4.281,1,1,1,1)
S ^%ZISL(4.281,"C",$E(X,1,64),DA)=""
"^DD",4.281,4.281,1,1,1,2)
K ^%ZISL(4.281,"C",$E(X,1,64),DA)
"^DD",4.281,4.281,1,1,1,3)
XXXX - Do not delete
"^DD",4.281,4.281,1,1,1,"%D",0)
^.101^2^2^3020219^^
"^DD",4.281,4.281,1,1,1,"%D",1,0)
This cross-reference is used by the receiving UCI to find entries
"^DD",4.281,4.281,1,1,1,"%D",2,0)
which have been 'transmitted' to it from other UCIs.
"^DD",4.281,4.281,1,1,1,"DT")
2920608
"^DD",4.281,4.281,1,3)
Answer must be 3-64 characters in length
"^DD",4.281,4.281,1,"DT")
3020219
"^DD",4.281,4.281,2,0)
TEXT^4.2812^^T;0
"^DD",4.281,4.281,2,21,0)
^.001^5^5^3020422^^
"^DD",4.281,4.281,2,21,1,0)
The data being transferred and control logic are written into this
"^DD",4.281,4.281,2,21,2,0)
field and read out of this field when using the MailMan options:
"^DD",4.281,4.281,2,21,3,0)
 
"^DD",4.281,4.281,2,21,4,0)
 XMR-UCI-RCV    RECEIVE MESSAGES FROM OTHER UCI
"^DD",4.281,4.281,2,21,5,0)
 XMR-UCI-SEND   SEND MESSAGES TO ANOTHER UCI
"^DD",4.281,4.2812,0)
TEXT SUB-FIELD^^.01^1
"^DD",4.281,4.2812,0,"DT")
2910725
"^DD",4.281,4.2812,0,"NM","TEXT")

"^DD",4.281,4.2812,0,"UP")
4.281
"^DD",4.281,4.2812,.01,0)
TEXT^WL^^0;1^Q
"^DD",4.281,4.2812,.01,"DT")
2910725
"^DD",4.2995,4.2995,0)
FIELD^^13^12
"^DD",4.2995,4.2995,0,"DT")
2940222
"^DD",4.2995,4.2995,0,"IX","B",4.2995,.01)

"^DD",4.2995,4.2995,0,"NM","MAILMAN OUTSTANDING FTP TRANSACTIONS")

"^DD",4.2995,4.2995,.01,0)
NAME^RF^^0;1^K:$L(X)>30!(X?.N)!($L(X)<3)!'(X'?1P.E) X
"^DD",4.2995,4.2995,.01,1,0)
^.1
"^DD",4.2995,4.2995,.01,1,1,0)
4.2995^B
"^DD",4.2995,4.2995,.01,1,1,1)
S ^XMBX(4.2995,"B",$E(X,1,30),DA)=""
"^DD",4.2995,4.2995,.01,1,1,2)
K ^XMBX(4.2995,"B",$E(X,1,30),DA)
"^DD",4.2995,4.2995,.01,3)
NAME MUST BE 3-30 CHARACTERS, NOT NUMERIC OR STARTING WITH PUNCTUATION
"^DD",4.2995,4.2995,.01,21,0)
^^2^2^2930421^
"^DD",4.2995,4.2995,.01,21,1,0)
The name of the entry is the same as the name of the executable file
"^DD",4.2995,4.2995,.01,21,2,0)
that actually sends a BLOB across the network using FTP.
"^DD",4.2995,4.2995,.01,21,3,0)
for the file that actually sends a BLOB 
"^DD",4.2995,4.2995,.01,21,4,0)
across the network using FTP.
"^DD",4.2995,4.2995,.01,23,0)
1
"^DD",4.2995,4.2995,.01,23,1,0)
The entries
"^DD",4.2995,4.2995,.01,"DT")
2940114
"^DD",4.2995,4.2995,1,0)
CREATION TIME^NJ10,0^^0;2^K:+X'=X!(X>9999999999)!(X<1)!(X?.E1"."1N.N) X
"^DD",4.2995,4.2995,1,3)
Type a Number between 1 and 9999999999, 0 Decimal Digits
"^DD",4.2995,4.2995,1,21,0)
^^2^2^2930421^^^
"^DD",4.2995,4.2995,1,21,1,0)
This is the  time the entry was made [$H*86400+$P($H,",",2)]
"^DD",4.2995,4.2995,1,21,2,0)
in seconds since the beginning of system time.
"^DD",4.2995,4.2995,1,"DT")
2930421
"^DD",4.2995,4.2995,2,0)
USER^P200'^VA(200,^0;3^Q
"^DD",4.2995,4.2995,2,21,0)
^^2^2^2931214^
"^DD",4.2995,4.2995,2,21,1,0)
This is the DUZ (internal ID) of the user whose message initiated the
"^DD",4.2995,4.2995,2,21,2,0)
transfer.
"^DD",4.2995,4.2995,2,"DT")
2930421
"^DD",4.2995,4.2995,3,0)
IMAGE^P2005'^MAG(2005,^0;4^Q
"^DD",4.2995,4.2995,3,21,0)
^^2^2^2930616^
"^DD",4.2995,4.2995,3,21,1,0)
This field is a pointer to the image file and is necessary to facilitate
"^DD",4.2995,4.2995,3,21,2,0)
interjob communications.
"^DD",4.2995,4.2995,3,"DT")
2930616
"^DD",4.2995,4.2995,4,0)
GET/PUT A FILE^RS^1:GET A FILE;2:PUT A FILE;^1;1^Q
"^DD",4.2995,4.2995,4,3)

"^DD",4.2995,4.2995,4,21,0)
^^4^4^2940222^^
"^DD",4.2995,4.2995,4,21,1,0)
Enter a GET command if you want to receive a file from a
"^DD",4.2995,4.2995,4,21,2,0)
      Remote Host and place the file into a Local Host.
"^DD",4.2995,4.2995,4,21,3,0)
Enter a PUT command if you want to transfer a file from a
"^DD",4.2995,4.2995,4,21,4,0)
      Local Host and place the file into a Remote Host.
"^DD",4.2995,4.2995,4,21,5,0)
      the Origination node and place the file into the
"^DD",4.2995,4.2995,4,21,6,0)
      Destination node.
"^DD",4.2995,4.2995,4,"DT")
2940222
"^DD",4.2995,4.2995,7,0)
LOGON USERNAME^RF^^1;4^K:$L(X)>15!($L(X)<3) X
"^DD",4.2995,4.2995,7,3)
Answer must be 3-15 characters in length.
"^DD",4.2995,4.2995,7,21,0)
^^3^3^2940222^^^
"^DD",4.2995,4.2995,7,21,1,0)
Enter the logon name at the Remote Host where
"^DD",4.2995,4.2995,7,21,2,0)
the file will be placed or from where the file
"^DD",4.2995,4.2995,7,21,3,0)
will be retrieved.
"^DD",4.2995,4.2995,7,21,4,0)
Username must be 3-15 characters in length.
"^DD",4.2995,4.2995,7,"DT")
2940222
"^DD",4.2995,4.2995,8,0)
LOGON PASSWORD^RF^^1;5^K:$L(X)>15!($L(X)<3) X
"^DD",4.2995,4.2995,8,3)
Answer must be 3-15 characters in length.
"^DD",4.2995,4.2995,8,21,0)
^^2^2^2940222^^
"^DD",4.2995,4.2995,8,21,1,0)
Enter the password that are appropriate for the 
"^DD",4.2995,4.2995,8,21,2,0)
logon name at the Remote Host.
"^DD",4.2995,4.2995,8,21,3,0)
the file will be retrieved.
"^DD",4.2995,4.2995,8,21,4,0)
Password must be 3-15 characters in length.
"^DD",4.2995,4.2995,8,"DT")
2940222
"^DD",4.2995,4.2995,9,0)
IP ADDRESS^RF^^1;6^K:$L(X)>20!($L(X)<3) X
"^DD",4.2995,4.2995,9,3)
Answer must be 3-20 characters in length.
"^DD",4.2995,4.2995,9,21,0)
^^2^2^2940222^^
"^DD",4.2995,4.2995,9,21,1,0)
Enter an IP address in the format of 4 numerals
"^DD",4.2995,4.2995,9,21,2,0)
separated by periods, e.g., 128.149.32.1
"^DD",4.2995,4.2995,9,"DT")
2940222
"^DD",4.2995,4.2995,10,0)
FILENAME AT LOCAL HOST^RF^^1;7^K:$L(X)>30!($L(X)<3) X
"^DD",4.2995,4.2995,10,3)
Answer must be 3-30 characters in length.
"^DD",4.2995,4.2995,10,21,0)
^^4^4^2940222^^
"^DD",4.2995,4.2995,10,21,1,0)
For PUT command, enter the file name that you want to
"^DD",4.2995,4.2995,10,21,2,0)
        transfer from the Local Host.
"^DD",4.2995,4.2995,10,21,3,0)
For GET command, enter the file name that you wnat to
"^DD",4.2995,4.2995,10,21,4,0)
        place at the Local Host.
"^DD",4.2995,4.2995,10,"DT")
2940222
"^DD",4.2995,4.2995,11,0)
DIRECTORY AT LOCAL HOST^F^^1;8^K:$L(X)>30!($L(X)<3) X
"^DD",4.2995,4.2995,11,3)
Answer must be 3-30 characters in length.
"^DD",4.2995,4.2995,11,21,0)
^^4^4^2940222^^
"^DD",4.2995,4.2995,11,21,1,0)
For PUT command, enter the Directory Name in which the file
"^DD",4.2995,4.2995,11,21,2,0)
        name you want to transfer from the Local Host.
"^DD",4.2995,4.2995,11,21,3,0)
For GET command, enter the Directory Name in which the file
"^DD",4.2995,4.2995,11,21,4,0)
        name you wnat to place at the Local Host.
"^DD",4.2995,4.2995,11,"DT")
2940222
"^DD",4.2995,4.2995,12,0)
FILENAME AT REMOTE HOST^RF^^1;9^K:$L(X)>30!($L(X)<3) X
"^DD",4.2995,4.2995,12,3)
Answer must be 3-30 characters in length.
"^DD",4.2995,4.2995,12,21,0)
^^4^4^2940222^^
"^DD",4.2995,4.2995,12,21,1,0)
For Get command, enter the file name that you want to
"^DD",4.2995,4.2995,12,21,2,0)
        receive from the Remote Host.
"^DD",4.2995,4.2995,12,21,3,0)
For PUT command, enter the file name that you want to
"^DD",4.2995,4.2995,12,21,4,0)
        place at the Remote Host.
"^DD",4.2995,4.2995,12,"DT")
2940222
"^DD",4.2995,4.2995,13,0)
DIRECTORY AT REMOTE HOST^F^^1;10^K:$L(X)>30!($L(X)<3) X
"^DD",4.2995,4.2995,13,3)
Answer must be 3-30 characters in length.
"^DD",4.2995,4.2995,13,21,0)
^^4^4^2940222^^
"^DD",4.2995,4.2995,13,21,1,0)
For GET command, enter the Directory Name in which the file
"^DD",4.2995,4.2995,13,21,2,0)
        name you want to receive from the Remote Host.
"^DD",4.2995,4.2995,13,21,3,0)
For PUT command, enter the Directory Name in which the file
"^DD",4.2995,4.2995,13,21,4,0)
        name you want to place at the Remote Host.
"^DD",4.2995,4.2995,13,"DT")
2940222
"^DD",4.2996,4.2996,0)
FIELD^^100^3
"^DD",4.2996,4.2996,0,"DDA")
N
"^DD",4.2996,4.2996,0,"DT")
3001130
"^DD",4.2996,4.2996,0,"ID",1)
W "   ",$P(^(0),U,2)
"^DD",4.2996,4.2996,0,"IX","B",4.2996,.01)

"^DD",4.2996,4.2996,0,"NM","INTERNET SUFFIX")

"^DD",4.2996,4.2996,.01,0)
NAME^RF^^0;1^K:$L(X)>10!($L(X)<2)!'(X?.U) X
"^DD",4.2996,4.2996,.01,1,0)
^.1
"^DD",4.2996,4.2996,.01,1,1,0)
4.2996^B
"^DD",4.2996,4.2996,.01,1,1,1)
S ^DIC(4.2996,"B",$E(X,1,30),DA)=""
"^DD",4.2996,4.2996,.01,1,1,2)
K ^DIC(4.2996,"B",$E(X,1,30),DA)
"^DD",4.2996,4.2996,.01,3)
Answer must be 2-10 characters in length.
"^DD",4.2996,4.2996,.01,8.5)
^
"^DD",4.2996,4.2996,.01,9)
^
"^DD",4.2996,4.2996,.01,21,0)
^.001^3^3^3001130^^^
"^DD",4.2996,4.2996,.01,21,1,0)
This is an approved (by ICANN or IANA) top-level domain (the last dot
"^DD",4.2996,4.2996,.01,21,2,0)
piece of a domain name), which is used to control the routing of
"^DD",4.2996,4.2996,.01,21,3,0)
messages on the Internet.
"^DD",4.2996,4.2996,.01,"DT")
3001130
"^DD",4.2996,4.2996,.01,"LAYGO",1,0)
I 0
"^DD",4.2996,4.2996,1,0)
SHORT DESCRIPTION^F^^0;2^K:$L(X)>50!($L(X)<1) X
"^DD",4.2996,4.2996,1,3)
Answer must be 1-50 characters in length.
"^DD",4.2996,4.2996,1,8.5)
^
"^DD",4.2996,4.2996,1,9)
^
"^DD",4.2996,4.2996,1,21,0)
^.001^1^1^3001130^^^^
"^DD",4.2996,4.2996,1,21,1,0)
This is a short description of the top-level domain.
"^DD",4.2996,4.2996,1,"DT")
3001130
"^DD",4.2996,4.2996,100,0)
NOTES^4.29961^^1;0
"^DD",4.2996,4.2996,100,21,0)
^.001^2^2^3001130^^^
"^DD",4.2996,4.2996,100,21,1,0)
This field may be used for notes or more information about the top-level
"^DD",4.2996,4.2996,100,21,2,0)
domain, if needed.
"^DD",4.2996,4.2996,100,"DT")
3001130
"^DD",4.2996,4.29961,0)
NOTES SUB-FIELD^^.01^1
"^DD",4.2996,4.29961,0,"DT")
3001130
"^DD",4.2996,4.29961,0,"NM","NOTES")

"^DD",4.2996,4.29961,0,"UP")
4.2996
"^DD",4.2996,4.29961,.01,0)
NOTES^W^^0;1^Q
"^DD",4.2996,4.29961,.01,3)
Enter any notes about this top-level domain.
"^DD",4.2996,4.29961,.01,21,0)
^.001^2^2^3001130^^^
"^DD",4.2996,4.29961,.01,21,1,0)
This field may be used for a more complete description of the top-level
"^DD",4.2996,4.29961,.01,21,2,0)
domain, if needed.
"^DD",4.2996,4.29961,.01,"DT")
3001130
"^DD",4.2997,4.2997,0)
FIELD^^99^12
"^DD",4.2997,4.2997,0,"DDA")
N
"^DD",4.2997,4.2997,0,"DT")
2930120
"^DD",4.2997,4.2997,0,"ID",1)
W "   ",$P(^(0),U,2)
"^DD",4.2997,4.2997,0,"ID",2)
W "   ",$P(^(0),U,3)
"^DD",4.2997,4.2997,0,"ID",5)
W "   ",$P(^(0),U,6)
"^DD",4.2997,4.2997,0,"ID",99)
W "   ",$P(^(0),U,7)
"^DD",4.2997,4.2997,0,"IX","AC",4.2997,6)

"^DD",4.2997,4.2997,0,"IX","B",4.2997,.01)

"^DD",4.2997,4.2997,0,"IX","C",4.2997,3)

"^DD",4.2997,4.2997,0,"IX","D",4.2997,5)

"^DD",4.2997,4.2997,0,"IX","E",4.2997,98)

"^DD",4.2997,4.2997,0,"IX","F",4.2997,99)

"^DD",4.2997,4.2997,0,"NM","REMOTE USER DIRECTORY")

"^DD",4.2997,4.2997,.01,0)
LAST NAME^RF^^0;1^K:$L(X)>30!($L(X)<3)!'(X?1.AN) X
"^DD",4.2997,4.2997,.01,1,0)
^.1
"^DD",4.2997,4.2997,.01,1,1,0)
4.2997^B
"^DD",4.2997,4.2997,.01,1,1,1)
S ^XMD(4.2997,"B",$E(X,1,30),DA)=""
"^DD",4.2997,4.2997,.01,1,1,2)
K ^XMD(4.2997,"B",$E(X,1,30),DA)
"^DD",4.2997,4.2997,.01,3)
Answer must be 3-30 characters in length.
"^DD",4.2997,4.2997,.01,21,0)
^^1^1^2931214^
"^DD",4.2997,4.2997,.01,21,1,0)
This is the last name of the remote user.
"^DD",4.2997,4.2997,1,0)
FIRST NAME^F^^0;2^K:$L(X)>30!($L(X)<3) X
"^DD",4.2997,4.2997,1,3)
Answer must be 3-30 characters in length.
"^DD",4.2997,4.2997,1,21,0)
^^1^1^2931214^
"^DD",4.2997,4.2997,1,21,1,0)
This is the first name of the remote user.
"^DD",4.2997,4.2997,2,0)
REST OF NAME^F^^0;3^K:$L(X)>30!($L(X)<1) X
"^DD",4.2997,4.2997,2,3)
Answer must be 1-30 characters in length.
"^DD",4.2997,4.2997,2,21,0)
^^1^1^2931214^
"^DD",4.2997,4.2997,2,21,1,0)
This is the rest of the remote user's name.
"^DD",4.2997,4.2997,3,0)
MAIL CODE^F^^0;4^K:X[""""!($A(X)=45) X I $D(X) K:$L(X)>30!($L(X)<3) X
"^DD",4.2997,4.2997,3,1,0)
^.1
"^DD",4.2997,4.2997,3,1,1,0)
4.2997^C
"^DD",4.2997,4.2997,3,1,1,1)
S ^XMD(4.2997,"C",$E(X,1,30),DA)=""
"^DD",4.2997,4.2997,3,1,1,2)
K ^XMD(4.2997,"C",$E(X,1,30),DA)
"^DD",4.2997,4.2997,3,3)
Answer must be 3-30 characters in length.
"^DD",4.2997,4.2997,3,21,0)
^^1^1^2931214^
"^DD",4.2997,4.2997,3,21,1,0)
This is the mail code name of the remote user.
"^DD",4.2997,4.2997,3,"DT")
2901030
"^DD",4.2997,4.2997,4,0)
EXTENDED MAIL CODE^F^^0;5^K:$L(X)>30!($L(X)<3) X
"^DD",4.2997,4.2997,4,3)
Answer must be 3-30 characters in length.
"^DD",4.2997,4.2997,4,21,0)
^^2^2^2931214^
"^DD",4.2997,4.2997,4,21,1,0)
This is the mail code name of the remote user with a greater amount of detail
"^DD",4.2997,4.2997,4,21,2,0)
than the regular mail code.
"^DD",4.2997,4.2997,5,0)
LOCATION^F^^0;6^K:X[""""!($A(X)=45) X I $D(X) K:$L(X)>30!($L(X)<3) X
"^DD",4.2997,4.2997,5,1,0)
^.1
"^DD",4.2997,4.2997,5,1,1,0)
4.2997^D^KWIC
"^DD",4.2997,4.2997,5,1,1,1)
S %1=1 F %=1:1:$L(X)+1 S I=$E(X,%) I "(,.?! '-/&:;)"[I S I=$E($E(X,%1,%-1),1,30),%1=%+1 I $L(I)>2,^DD("KWIC")'[I S ^XMD(4.2997,"D",I,DA)=""
"^DD",4.2997,4.2997,5,1,1,2)
S %1=1 F %=1:1:$L(X)+1 S I=$E(X,%) I "(,.?! '-/&:;)"[I S I=$E($E(X,%1,%-1),1,30),%1=%+1 I $L(I)>2 K ^XMD(4.2997,"D",I,DA)
"^DD",4.2997,4.2997,5,3)
Answer must be 3-30 characters in length.
"^DD",4.2997,4.2997,5,21,0)
^^1^1^2931214^
"^DD",4.2997,4.2997,5,21,1,0)
This is where the remote user is located.
"^DD",4.2997,4.2997,5,"DT")
2901030
"^DD",4.2997,4.2997,6,0)
DATE LAST USED^D^^0;9^S %DT="ET" D ^%DT S X=Y K:Y<1 X
"^DD",4.2997,4.2997,6,1,0)
^.1
"^DD",4.2997,4.2997,6,1,1,0)
4.2997^AC
"^DD",4.2997,4.2997,6,1,1,1)
S ^XMD(4.2997,"AC",$E(X,1,30),DA)=""
"^DD",4.2997,4.2997,6,1,1,2)
K ^XMD(4.2997,"AC",$E(X,1,30),DA)
"^DD",4.2997,4.2997,6,1,1,"%D",0)
^^2^2^2930120^
"^DD",4.2997,4.2997,6,1,1,"%D",1,0)
This cross reference is used by the XMDIR1 to automatically maintain out
"^DD",4.2997,4.2997,6,1,1,"%D",2,0)
old entries that have not been used for at least 2 years.
"^DD",4.2997,4.2997,6,1,1,"DT")
2930120
"^DD",4.2997,4.2997,6,21,0)
^^1^1^2931214^
"^DD",4.2997,4.2997,6,21,1,0)
This is when the entry was last chosen and used for addressing a message.
"^DD",4.2997,4.2997,6,"DT")
2930120
"^DD",4.2997,4.2997,7,0)
PHONE^F^^1;1^K:$L(X)>30!($L(X)<3) X
"^DD",4.2997,4.2997,7,3)
Answer must be 3-30 characters in length.
"^DD",4.2997,4.2997,7,21,0)
^^1^1^2931214^
"^DD",4.2997,4.2997,7,21,1,0)
This is the phone number of the remote user.
"^DD",4.2997,4.2997,7,"DT")
2930120
"^DD",4.2997,4.2997,8,0)
PHONE EXTENSION^F^^1;2^K:$L(X)>30!($L(X)<3) X
"^DD",4.2997,4.2997,8,3)
Answer must be 3-30 characters in length.
"^DD",4.2997,4.2997,8,21,0)
^^1^1^2931214^^
"^DD",4.2997,4.2997,8,21,1,0)
This is the extension of the phone number of the remote user.
"^DD",4.2997,4.2997,8,"DT")
2930120
"^DD",4.2997,4.2997,50,0)
DATE ENTERED^NJ1,0XO^^0;8^K:+X'=X!($H-X>9) X
"^DD",4.2997,4.2997,50,2)
S Y(0)=Y N %H,%,X S %H=Y D YX^%DTC
"^DD",4.2997,4.2997,50,2.1)
N %H,%,X S %H=Y D YX^%DTC
"^DD",4.2997,4.2997,50,3)
Enter a $H day.
"^DD",4.2997,4.2997,50,21,0)
^^4^4^2930115^^
"^DD",4.2997,4.2997,50,21,1,0)
This is the date that a user was entered into the directory.
"^DD",4.2997,4.2997,50,21,2,0)
It is is $H format (just the day portion, eg.  55445).
"^DD",4.2997,4.2997,50,21,3,0)
It is data to be entered only when users are being entered
"^DD",4.2997,4.2997,50,21,4,0)
into the database automatically.
"^DD",4.2997,4.2997,50,23,0)
^^1^1^2930115^^
"^DD",4.2997,4.2997,50,23,1,0)
 
"^DD",4.2997,4.2997,50,"DT")
2930827
"^DD",4.2997,4.2997,98,0)
AUTOMATICALLY ENTERED BY^F^^AUTO;1^K:X[""""!($A(X)=45) X I $D(X) K:$L(X)>30!($L(X)<3) X
"^DD",4.2997,4.2997,98,1,0)
^.1
"^DD",4.2997,4.2997,98,1,1,0)
4.2997^E
"^DD",4.2997,4.2997,98,1,1,1)
S ^XMD(4.2997,"E",$E(X,1,30),DA)=""
"^DD",4.2997,4.2997,98,1,1,2)
K ^XMD(4.2997,"E",$E(X,1,30),DA)
"^DD",4.2997,4.2997,98,1,1,"%D",0)
^^1^1^2930115^
"^DD",4.2997,4.2997,98,1,1,"%D",1,0)
This cross reference is used to maintain out old directory entries.
"^DD",4.2997,4.2997,98,1,1,"DT")
2930115
"^DD",4.2997,4.2997,98,3)
Answer must be 3-30 characters in length.
"^DD",4.2997,4.2997,98,21,0)
^^5^5^2930115^
"^DD",4.2997,4.2997,98,21,1,0)
This field is used by a routine (or server) that automatically enters names
"^DD",4.2997,4.2997,98,21,2,0)
into this file to mark it with a prechosen name.  This name must be coordinated
"^DD",4.2997,4.2997,98,21,3,0)
by the MailMan Development team.  Local sites may use names that begin with
"^DD",4.2997,4.2997,98,21,4,0)
the three character sequence "XMZ" without coordinating.
"^DD",4.2997,4.2997,98,21,5,0)
 
"^DD",4.2997,4.2997,98,23,0)
^^1^1^2930115^
"^DD",4.2997,4.2997,98,23,1,0)
 
"^DD",4.2997,4.2997,98,"DT")
2930115
"^DD",4.2997,4.2997,99,0)
NETWORK ADDRESS^F^^0;7^K:X[""""!($A(X)=45) X I $D(X) K:$L(X)>30!($L(X)<3) X
"^DD",4.2997,4.2997,99,1,0)
^.1
"^DD",4.2997,4.2997,99,1,1,0)
4.2997^F
"^DD",4.2997,4.2997,99,1,1,1)
S ^XMD(4.2997,"F",X,DA)=""
"^DD",4.2997,4.2997,99,1,1,2)
K ^XMD(4.2997,"F",X,DA)
"^DD",4.2997,4.2997,99,1,1,"%D",0)
^^4^4^2930120^
"^DD",4.2997,4.2997,99,1,1,"%D",1,0)
This cross reference is used for look-up and also to determine if an
"^DD",4.2997,4.2997,99,1,1,"%D",2,0)
entry already exists.  Theory is that the old and new addresses can exist
"^DD",4.2997,4.2997,99,1,1,"%D",3,0)
in the file and that is okay.  The bad entry will be removed when the user
"^DD",4.2997,4.2997,99,1,1,"%D",4,0)
notifies the support staff.
"^DD",4.2997,4.2997,99,1,1,"DT")
2930120
"^DD",4.2997,4.2997,99,3)
Answer must be 3-30 characters in length.
"^DD",4.2997,4.2997,99,21,0)
^^4^4^2931214^
"^DD",4.2997,4.2997,99,21,1,0)
This field is used to address mail automatically.  When a look-up
"^DD",4.2997,4.2997,99,21,2,0)
is done on the local user file and fails, a secondary look-up tries
"^DD",4.2997,4.2997,99,21,3,0)
to find the user in the Remote User file.  If it is found, the message
"^DD",4.2997,4.2997,99,21,4,0)
is automatically addressed using this field.
"^DD",4.2997,4.2997,99,"DT")
2930120
"^DD",4.2998,4.2998,0)
FIELD^^710^80
"^DD",4.2998,4.2998,0,"DDA")
N
"^DD",4.2998,4.2998,0,"DT")
2921006
"^DD",4.2998,4.2998,0,"IX","B",4.2998,.01)

"^DD",4.2998,4.2998,0,"NM","MESSAGE DELIVERY STATS")

"^DD",4.2998,4.2998,.01,0)
DATE/TIME^RDX^^0;1^S %DT="ETXR" D ^%DT S X=Y K:X<2911100 X
"^DD",4.2998,4.2998,.01,1,0)
^.1
"^DD",4.2998,4.2998,.01,1,1,0)
4.2998^B
"^DD",4.2998,4.2998,.01,1,1,1)
S ^XMBX(4.2998,"B",$E(X,1,30),DA)=""
"^DD",4.2998,4.2998,.01,1,1,2)
K ^XMBX(4.2998,"B",$E(X,1,30),DA)
"^DD",4.2998,4.2998,.01,3)
This is the date & time the stats were recorded.
"^DD",4.2998,4.2998,.01,21,0)
^^2^2^2911104^
"^DD",4.2998,4.2998,.01,21,1,0)
This is the date and time in FileMan format that this batch of stats were
"^DD",4.2998,4.2998,.01,21,2,0)
created.
"^DD",4.2998,4.2998,.01,"DT")
2911104
"^DD",4.2998,4.2998,1,0)
TOTAL QUEUE LENGTH^NJ7,0^^0;2^K:+X'=X!(X>9999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",4.2998,4.2998,1,3)
Type a Number between 0 and 9999999, 0 Decimal Digits
"^DD",4.2998,4.2998,1,21,0)
^^2^2^2931214^
"^DD",4.2998,4.2998,1,21,1,0)
This is the total number of messages and responses in the queue
"^DD",4.2998,4.2998,1,21,2,0)
waiting to be delivered by the background filer.
"^DD",4.2998,4.2998,1,"DT")
2911104
"^DD",4.2998,4.2998,11,0)
MESSAGES^NJ6,0^^0;3^K:+X'=X!(X>999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",4.2998,4.2998,11,3)
Type a Number between 0 and 999999, 0 Decimal Digits
"^DD",4.2998,4.2998,11,21,0)
^^1^1^2911104^
"^DD",4.2998,4.2998,11,21,1,0)
This field is for original messages as opposed to responses to deliver.
"^DD",4.2998,4.2998,11,"DT")
2911104
"^DD",4.2998,4.2998,12,0)
RESPONSES^NJ7,0^^0;4^K:+X'=X!(X>9999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",4.2998,4.2998,12,3)
Type a Number between 0 and 9999999, 0 Decimal Digits
"^DD",4.2998,4.2998,12,21,0)
^^2^2^2931214^
"^DD",4.2998,4.2998,12,21,1,0)
This is the total number of responses in the queue
"^DD",4.2998,4.2998,12,21,2,0)
waiting to be delivered by the background filer.
"^DD",4.2998,4.2998,12,"DT")
2911104
"^DD",4.2998,4.2998,15,0)
LINES OUTPUT^NJ10,0^^0;5^K:+X'=X!(X>9999999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",4.2998,4.2998,15,3)
Type a Number between 0 and 9999999999, 0 Decimal Digits
"^DD",4.2998,4.2998,15,21,0)
^^2^2^2931214^
"^DD",4.2998,4.2998,15,21,1,0)
This is the number of lines output (displayed and printed) during the
"^DD",4.2998,4.2998,15,21,2,0)
interval in question.
"^DD",4.2998,4.2998,15,"DT")
2920107
"^DD",4.2998,4.2998,22,0)
RESPONSE TIME - AVERAGE^NJ9,1^^0;8^K:+X'=X!(X>9999999)!(X<0)!(X?.E1"."2N.N) X
"^DD",4.2998,4.2998,22,3)
Type a Number between 0 and 9999999, 1 Decimal Digit
"^DD",4.2998,4.2998,22,21,0)
^^2^2^2931214^
"^DD",4.2998,4.2998,22,21,1,0)
This is the average response time that it took during the interval
"^DD",4.2998,4.2998,22,21,2,0)
in question while messages were being deleted and/or terminated.
"^DD",4.2998,4.2998,38,0)
ACTIVE USERS^NJ7,0^^0;21^K:+X'=X!(X>9999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",4.2998,4.2998,38,3)
Type a Number between 0 and 9999999, 0 Decimal Digits
"^DD",4.2998,4.2998,38,21,0)
^^2^2^2931214^^
"^DD",4.2998,4.2998,38,21,1,0)
This is the total number of users that were on the system
"^DD",4.2998,4.2998,38,21,2,0)
when the statistics for the period were gathered.
"^DD",4.2998,4.2998,38,"DT")
2911202
"^DD",4.2998,4.2998,39,0)
ACTIVE ZSLOT USERS^NJ7,0^^0;22^K:+X'=X!(X>9999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",4.2998,4.2998,39,3)
Type a Number between 0 and 9999999, 0 Decimal Digits
"^DD",4.2998,4.2998,39,21,0)
^^2^2^2931214^
"^DD",4.2998,4.2998,39,21,1,0)
This is the total number if ZSLOT users that were on the system
"^DD",4.2998,4.2998,39,21,2,0)
when the statistics for the period were gathered.
"^DD",4.2998,4.2998,40,0)
ACTIVE NON-ZSLOT USERS^NJ7,0^^0;23^K:+X'=X!(X>9999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",4.2998,4.2998,40,3)
Type a Number between 0 and 9999999, 0 Decimal Digits
"^DD",4.2998,4.2998,40,21,0)
^^2^2^2931214^
"^DD",4.2998,4.2998,40,21,1,0)
This is the total number of non-ZSLOT users that were on the system
"^DD",4.2998,4.2998,40,21,2,0)
when the statistics for the period were gathered.
"^DD",4.2998,4.2998,41,0)
LOGINS - LAST 24 HOURS^NJ7,0^^0;10^K:+X'=X!(X>9999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",4.2998,4.2998,41,3)
Type a Number between 0 and 9999999, 0 Decimal Digits
"^DD",4.2998,4.2998,41,21,0)
^^1^1^2931214^
"^DD",4.2998,4.2998,41,21,1,0)
This is the number of Logins that occured during the last 24 hours.
"^DD",4.2998,4.2998,41,"DT")
2911127
"^DD",4.2998,4.2998,42,0)
LOGIN MINUTES - LAST 24 HOURS^NJ7,0^^0;9^K:+X'=X!(X>9999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",4.2998,4.2998,42,3)
Type a Number between 0 and 9999999, 0 Decimal Digits
"^DD",4.2998,4.2998,42,21,0)
^^2^2^2931214^
"^DD",4.2998,4.2998,42,21,1,0)
This is the number of minutes that users were logged onto the system
"^DD",4.2998,4.2998,42,21,2,0)
during the last 24 hours.
"^DD",4.2998,4.2998,42,"DT")
2911127
"^DD",4.2998,4.2998,43,0)
MESSAGE NUMBER LAST ASSIGNED^NJ10,0^^0;11^K:+X'=X!(X>9999999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",4.2998,4.2998,43,3)
Type a Number between 0 and 9999999999, 0 Decimal Digits
"^DD",4.2998,4.2998,43,21,0)
^^1^1^2931214^
"^DD",4.2998,4.2998,43,21,1,0)
This is the last message number assigned for the date.
"^DD",4.2998,4.2998,43,"DT")
2911113
"^DD",4.2998,4.2998,44,0)
MESSAGE DELIVERIES MADE^NJ9,0^^0;12^K:+X'=X!(X>999999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",4.2998,4.2998,44,3)
Type a Number between 0 and 999999999, 0 Decimal Digits
"^DD",4.2998,4.2998,44,21,0)
^^2^2^2931214^
"^DD",4.2998,4.2998,44,21,1,0)
This is the number of message deliveries made during the interval
"^DD",4.2998,4.2998,44,21,2,0)
in question.
"^DD",4.2998,4.2998,44,"DT")
2911124
"^DD",4.2998,4.2998,45,0)
RESPONSE DELIVERIES MADE^NJ9,0^^0;13^K:+X'=X!(X>999999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",4.2998,4.2998,45,3)
Type a Number between 0 and 999999999, 0 Decimal Digits
"^DD",4.2998,4.2998,45,21,0)
^^2^2^2931214^
"^DD",4.2998,4.2998,45,21,1,0)
This is the number of response deliveries made during the interval
"^DD",4.2998,4.2998,45,21,2,0)
in question.
"^DD",4.2998,4.2998,45,"DT")
2911124
"^DD",4.2998,4.2998,46,0)
MESSAGE DELIVERIES IN QUEUE^NJ8,0^^0;14^K:+X'=X!(X>99999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",4.2998,4.2998,46,3)
Type a Number between 0 and 99999999, 0 Decimal Digits
"^DD",4.2998,4.2998,46,21,0)
^^2^2^2931214^
"^DD",4.2998,4.2998,46,21,1,0)
This is the total number of message deliveries that remained undelivered
"^DD",4.2998,4.2998,46,21,2,0)
at the time that the queues were checked.
"^DD",4.2998,4.2998,46,"DT")
2911123
"^DD",4.2998,4.2998,47,0)
RESPONSE DELIVERIES IN QUEUE^NJ8,0^^0;15^K:+X'=X!(X>99999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",4.2998,4.2998,47,3)
Type a Number between 0 and 99999999, 0 Decimal Digits
"^DD",4.2998,4.2998,47,21,0)
^^2^2^2931214^
"^DD",4.2998,4.2998,47,21,1,0)
This is the total number of response deliveries that remained undelivered
"^DD",4.2998,4.2998,47,21,2,0)
at the time that the queues were checked.
"^DD",4.2998,4.2998,47,"DT")
2911123
"^DD",4.2998,4.2998,101,0)
AGE OF OLDEST MESSAGE^NJ7,0^^1;1^K:+X'=X!(X>9999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",4.2998,4.2998,101,3)
Type a Number between 0 and 9999999, 0 Decimal Digits
"^DD",4.2998,4.2998,101,21,0)
^^2^2^2931214^
"^DD",4.2998,4.2998,101,21,1,0)
This is the longest amount of time in seconds that any message has been
"^DD",4.2998,4.2998,101,21,2,0)
in the queue at the time the queue was checked.
"^DD",4.2998,4.2998,101,"DT")
2911104
"^DD",4.2998,4.2998,102,0)
AGE OF OLDEST RESPONSE^NJ7,0^^1;2^K:+X'=X!(X>9999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",4.2998,4.2998,102,3)
Type a Number between 0 and 9999999, 0 Decimal Digits
"^DD",4.2998,4.2998,102,21,0)
^^2^2^2931214^
"^DD",4.2998,4.2998,102,21,1,0)
This is the longest amount of time in seconds that any message has been
"^DD",4.2998,4.2998,102,21,2,0)
in the queue at the time the queue was checked.    
"^DD",4.2998,4.2998,102,"DT")
2911106
"^DD",4.2998,4.2998,103,0)
RESPONSE ANALYSIS PARAMETERS^F^^1;3^K:$L(X)>50!($L(X)<1) X
"^DD",4.2998,4.2998,103,3)
Enter integer recipient frequencies separated by commas that will define groupings for analysis.
"^DD",4.2998,4.2998,103,21,0)
^^8^8^2920908^^
"^DD",4.2998,4.2998,103,21,1,0)
This field is a series of integers separated by commas.  The numbers define
"^DD",4.2998,4.2998,103,21,2,0)
groupings of messages to analyze.  For instance the string "10,50,300" will
"^DD",4.2998,4.2998,103,21,3,0)
cause messages to be grouped into the following groups:
"^DD",4.2998,4.2998,103,21,4,0)
 
"^DD",4.2998,4.2998,103,21,5,0)
   10 or fewer recipients on the message
"^DD",4.2998,4.2998,103,21,6,0)
   from 11 to 50 recipients on the message
"^DD",4.2998,4.2998,103,21,7,0)
   from 51 to 300 recipients on the message
"^DD",4.2998,4.2998,103,21,8,0)
   greater than 300 recipients on the message
"^DD",4.2998,4.2998,103,"DT")
2911115
"^DD",4.2998,4.2998,104,0)
MESSAGE ANALYSIS PARAMETERS^FX^^1;4^K:$L(X)>50!($L(X)<1) X
"^DD",4.2998,4.2998,104,3)
Answer with a string like the one you entered for the RESPONSE GROUPING STRING.
"^DD",4.2998,4.2998,104,21,0)
^^1^1^2911106^
"^DD",4.2998,4.2998,104,21,1,0)
See field 103.
"^DD",4.2998,4.2998,104,"DT")
2921006
"^DD",4.2998,4.2998,201,0)
RESPONSE AGE GROUP1^NJ7,0^^2;1^K:+X'=X!(X>9999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",4.2998,4.2998,201,3)
Type a Number between 0 and 9999999, 0 Decimal Digits
"^DD",4.2998,4.2998,201,21,0)
^^2^2^2931214^
"^DD",4.2998,4.2998,201,21,1,0)
This is the amount of seconds that the response that has been in
"^DD",4.2998,4.2998,201,21,2,0)
the queue for Response Group 1 the longest has been there.
"^DD",4.2998,4.2998,201,"DT")
2911106
"^DD",4.2998,4.2998,202,0)
RESPONSE AGE GROUP2^NJ7,0^^2;2^K:+X'=X!(X>9999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",4.2998,4.2998,202,3)
Type a Number between 0 and 9999999, 0 Decimal Digits
"^DD",4.2998,4.2998,202,21,0)
^^2^2^2931214^^^
"^DD",4.2998,4.2998,202,21,1,0)
This is the amount of seconds that the response that has been in
"^DD",4.2998,4.2998,202,21,2,0)
the queue for Response Group 2 the longest has been there.
"^DD",4.2998,4.2998,202,"DT")
2911106
"^DD",4.2998,4.2998,203,0)
RESPONSE AGE GROUP3^NJ7,0^^2;3^K:+X'=X!(X>9999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",4.2998,4.2998,203,3)
Type a Number between 0 and 9999999, 0 Decimal Digits
"^DD",4.2998,4.2998,203,21,0)
^^2^2^2931214^
"^DD",4.2998,4.2998,203,21,1,0)
This is the amount of seconds that the response that has been in
"^DD",4.2998,4.2998,203,21,2,0)
the queue for Response Group 3 the longest has been there.
"^DD",4.2998,4.2998,203,"DT")
2911106
"^DD",4.2998,4.2998,204,0)
RESPONSE AGE GROUP4^RNJ7,0^^2;4^K:+X'=X!(X>9999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",4.2998,4.2998,204,3)
Type a Number between 0 and 9999999, 0 Decimal Digits
"^DD",4.2998,4.2998,204,21,0)
^^2^2^2931214^
"^DD",4.2998,4.2998,204,21,1,0)
This is the amount of seconds that the response that has been in
"^DD",4.2998,4.2998,204,21,2,0)
the queue for Response Group 4 the longest has been there.
"^DD",4.2998,4.2998,204,"DT")
2911106
"^DD",4.2998,4.2998,205,0)
RESPONSE AGE GROUP5^NJ7,0^^2;5^K:+X'=X!(X>9999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",4.2998,4.2998,205,3)
Type a Number between 0 and 9999999, 0 Decimal Digits
"^DD",4.2998,4.2998,205,21,0)
^^2^2^2931214^^
"^DD",4.2998,4.2998,205,21,1,0)
This is the amount of seconds that the response that has been in
"^DD",4.2998,4.2998,205,21,2,0)
the queue for Response Group 5 the longest has been there.
"^DD",4.2998,4.2998,205,"DT")
2911106
"^DD",4.2998,4.2998,206,0)
RESPONSE AGE GROUP6^NJ7,0^^2;6^K:+X'=X!(X>9999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",4.2998,4.2998,206,3)
Type a Number between 0 and 9999999, 0 Decimal Digits
"^DD",4.2998,4.2998,206,21,0)
^^2^2^2931214^^
"^DD",4.2998,4.2998,206,21,1,0)
This is the amount of seconds that the response that has been in
"^DD",4.2998,4.2998,206,21,2,0)
the queue for Response Group 6 the longest has been there.
"^DD",4.2998,4.2998,206,"DT")
2911106
"^DD",4.2998,4.2998,207,0)
RESPONSE AGE GROUP7^NJ7,0^^2;7^K:+X'=X!(X>9999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",4.2998,4.2998,207,3)
Type a Number between 0 and 9999999, 0 Decimal Digits
"^DD",4.2998,4.2998,207,21,0)
^^2^2^2931214^
"^DD",4.2998,4.2998,207,21,1,0)
This is the amount of seconds that the response that has been in
"^DD",4.2998,4.2998,207,21,2,0)
the queue for Response Group 7 the longest has been there.
"^DD",4.2998,4.2998,207,"DT")
2911106
"^DD",4.2998,4.2998,208,0)
RESPONSE AGE GROUP8^NJ7,0^^2;8^K:+X'=X!(X>9999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",4.2998,4.2998,208,3)
Type a Number between 0 and 9999999, 0 Decimal Digits
"^DD",4.2998,4.2998,208,21,0)
^^2^2^2931214^
"^DD",4.2998,4.2998,208,21,1,0)
This is the amount of seconds that the response that has been in
"^DD",4.2998,4.2998,208,21,2,0)
the queue for Response Group 8 the longest has been there.
"^DD",4.2998,4.2998,208,"DT")
2911106
"^DD",4.2998,4.2998,209,0)
RESPONSE AGE GROUP9^NJ7,0^^2;9^K:+X'=X!(X>9999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",4.2998,4.2998,209,3)
Type a Number between 0 and 9999999, 0 Decimal Digits
"^DD",4.2998,4.2998,209,21,0)
^^2^2^2931214^^
"^DD",4.2998,4.2998,209,21,1,0)
This is the amount of seconds that the response that has been in
"^DD",4.2998,4.2998,209,21,2,0)
the queue for Response Group 9 the longest has been there.
"^DD",4.2998,4.2998,209,"DT")
2911106
"^DD",4.2998,4.2998,210,0)
RESPONSE AGE GROUP 10^NJ7,0^^2;10^K:+X'=X!(X>9999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",4.2998,4.2998,210,3)
Type a Number between 0 and 9999999, 0 Decimal Digits
"^DD",4.2998,4.2998,210,21,0)
^^2^2^2931214^^
"^DD",4.2998,4.2998,210,21,1,0)
This is the amount of seconds that the response that has been in
"^DD",4.2998,4.2998,210,21,2,0)
the queue for Response Group 10 the longest has been there.
"^DD",4.2998,4.2998,210,"DT")
2911126
"^DD",4.2998,4.2998,301,0)
RESPONSE NUMBER GROUP1^NJ7,0^^3;1^K:+X'=X!(X>9999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",4.2998,4.2998,301,3)
Type a Number between 0 and 9999999, 0 Decimal Digits
"^DD",4.2998,4.2998,301,21,0)
^^2^2^2931214^^
"^DD",4.2998,4.2998,301,21,1,0)
This is the number of responses that were delivered for Response Group 1
"^DD",4.2998,4.2998,301,21,2,0)
during the last time interval.
"^DD",4.2998,4.2998,301,"DT")
2911106
"^DD",4.2998,4.2998,302,0)
RESPONSE NUMBER GROUP2^NJ7,0^^3;2^K:+X'=X!(X>9999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",4.2998,4.2998,302,3)
Type a Number between 0 and 9999999, 0 Decimal Digits
"^DD",4.2998,4.2998,302,21,0)
^^2^2^2931214^^
"^DD",4.2998,4.2998,302,21,1,0)
This is the number of responses that were delivered for Response Group 2
"^DD",4.2998,4.2998,302,21,2,0)
during the last time interval.
"^DD",4.2998,4.2998,302,"DT")
2911106
"^DD",4.2998,4.2998,303,0)
RESPONSE NUMBER GROUP3^NJ7,0^^3;3^K:+X'=X!(X>9999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",4.2998,4.2998,303,3)
Type a Number between 0 and 9999999, 0 Decimal Digits
"^DD",4.2998,4.2998,303,21,0)
^^2^2^2931214^^^
"^DD",4.2998,4.2998,303,21,1,0)
This is the number of responses that were delivered for Response Group 3
"^DD",4.2998,4.2998,303,21,2,0)
during the last time interval.
"^DD",4.2998,4.2998,303,"DT")
2911106
"^DD",4.2998,4.2998,304,0)
RESPONSE NUMBER GROUP4^NJ7,0^^3;4^K:+X'=X!(X>9999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",4.2998,4.2998,304,3)
Type a Number between 0 and 9999999, 0 Decimal Digits
"^DD",4.2998,4.2998,304,21,0)
^^2^2^2931214^^
"^DD",4.2998,4.2998,304,21,1,0)
This is the number of responses that were delivered for Response Group 4
"^DD",4.2998,4.2998,304,21,2,0)
during the last time interval.
"^DD",4.2998,4.2998,304,"DT")
2911106
"^DD",4.2998,4.2998,305,0)
RESPONSE NUMBER GROUP5^NJ7,0^^3;5^K:+X'=X!(X>9999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",4.2998,4.2998,305,3)
Type a Number between 0 and 9999999, 0 Decimal Digits
"^DD",4.2998,4.2998,305,21,0)
^^2^2^2931214^^^
"^DD",4.2998,4.2998,305,21,1,0)
This is the number of responses that were delivered for Response Group 5
"^DD",4.2998,4.2998,305,21,2,0)
during the last time interval.
"^DD",4.2998,4.2998,305,"DT")
2911106
"^DD",4.2998,4.2998,306,0)
RESPONSE NUMBER GROUP6^NJ7,0^^3;6^K:+X'=X!(X>9999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",4.2998,4.2998,306,3)
Type a Number between 0 and 9999999, 0 Decimal Digits
"^DD",4.2998,4.2998,306,21,0)
^^2^2^2931214^^
"^DD",4.2998,4.2998,306,21,1,0)
This is the number of responses that were delivered for Response Group 6
"^DD",4.2998,4.2998,306,21,2,0)
during the last time interval.
"^DD",4.2998,4.2998,306,"DT")
2911106
"^DD",4.2998,4.2998,307,0)
RESPONSE NUMBER GROUP7^NJ7,0^^3;7^K:+X'=X!(X>9999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",4.2998,4.2998,307,3)
Type a Number between 0 and 9999999, 0 Decimal Digits
"^DD",4.2998,4.2998,307,21,0)
^^2^2^2931214^^
"^DD",4.2998,4.2998,307,21,1,0)
This is the number of responses that were delivered for Response Group 7
"^DD",4.2998,4.2998,307,21,2,0)
during the last time interval.
"^DD",4.2998,4.2998,307,"DT")
2911106
"^DD",4.2998,4.2998,308,0)
RESPONSE NUMBER GROUP8^NJ7,0^^3;8^K:+X'=X!(X>9999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",4.2998,4.2998,308,3)
Type a Number between 0 and 9999999, 0 Decimal Digits
"^DD",4.2998,4.2998,308,21,0)
^^2^2^2931214^^
"^DD",4.2998,4.2998,308,21,1,0)
This is the number of responses that were delivered for Response Group 8
"^DD",4.2998,4.2998,308,21,2,0)
during the last time interval.
"^DD",4.2998,4.2998,308,"DT")
2911106
"^DD",4.2998,4.2998,309,0)
RESPONSE NUMBER GROUP9^NJ7,0^^3;9^K:+X'=X!(X>9999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",4.2998,4.2998,309,3)
Type a Number between 0 and 9999999, 0 Decimal Digits
"^DD",4.2998,4.2998,309,21,0)
^^2^2^2931214^^
"^DD",4.2998,4.2998,309,21,1,0)
This is the number of responses that were delivered for Response Group 9
"^DD",4.2998,4.2998,309,21,2,0)
during the last time interval.
"^DD",4.2998,4.2998,309,"DT")
2911106
"^DD",4.2998,4.2998,310,0)
RESPONSE NUMBER GROUP 10^NJ7,0^^3;10^K:+X'=X!(X>9999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",4.2998,4.2998,310,3)
Type a Number between 0 and 9999999, 0 Decimal Digits
"^DD",4.2998,4.2998,310,21,0)
^^2^2^2931214^^
"^DD",4.2998,4.2998,310,21,1,0)
This is the number of responses that were delivered for Response Group 10
"^DD",4.2998,4.2998,310,21,2,0)
during the last time interval.
"^DD",4.2998,4.2998,310,"DT")
2911126
"^DD",4.2998,4.2998,401,0)
MESSAGE AGE GROUP1^NJ7,0^^4;1^K:+X'=X!(X>9999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",4.2998,4.2998,401,3)
Type a Number between 0 and 9999999, 0 Decimal Digits
"^DD",4.2998,4.2998,401,21,0)
^^2^2^2931214^
"^DD",4.2998,4.2998,401,21,1,0)
This is the amount of seconds that the message that has been in
"^DD",4.2998,4.2998,401,21,2,0)
the queue for Message Group 1 the longest has been there.
"^DD",4.2998,4.2998,401,"DT")
2911106
"^DD",4.2998,4.2998,402,0)
MESSAGE AGE GROUP2^NJ7,0^^4;2^K:+X'=X!(X>9999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",4.2998,4.2998,402,3)
Type a Number between 0 and 9999999, 0 Decimal Digits
"^DD",4.2998,4.2998,402,21,0)
^^2^2^2931214^
"^DD",4.2998,4.2998,402,21,1,0)
This is the amount of seconds that the message that has been in
"^DD",4.2998,4.2998,402,21,2,0)
the queue for Message Group 2 the longest has been there.
"^DD",4.2998,4.2998,402,"DT")
2911106
"^DD",4.2998,4.2998,403,0)
MESSAGE AGE GROUP3^NJ7,0^^4;3^K:+X'=X!(X>9999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",4.2998,4.2998,403,3)
Type a Number between 0 and 9999999, 0 Decimal Digits
"^DD",4.2998,4.2998,403,21,0)
^^2^2^2931214^
"^DD",4.2998,4.2998,403,21,1,0)
This is the amount of seconds that the message that has been in
"^DD",4.2998,4.2998,403,21,2,0)
the queue for Message Group 3 the longest has been there.
"^DD",4.2998,4.2998,403,"DT")
2911106
"^DD",4.2998,4.2998,404,0)
MESSAGE AGE GROUP4^NJ7,0^^4;4^K:+X'=X!(X>9999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",4.2998,4.2998,404,3)
Type a Number between 0 and 9999999, 0 Decimal Digits
"^DD",4.2998,4.2998,404,21,0)
^^2^2^2931214^
"^DD",4.2998,4.2998,404,21,1,0)
This is the amount of seconds that the message that has been in
"^DD",4.2998,4.2998,404,21,2,0)
the queue for Message Group 4 the longest has been there.
"^DD",4.2998,4.2998,404,"DT")
2911106
"^DD",4.2998,4.2998,405,0)
MESSAGE AGE GROUP5^NJ7,0^^4;5^K:+X'=X!(X>9999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",4.2998,4.2998,405,3)
Type a Number between 0 and 9999999, 0 Decimal Digits
"^DD",4.2998,4.2998,405,21,0)
^^2^2^2931214^
"^DD",4.2998,4.2998,405,21,1,0)
This is the amount of seconds that the message that has been in
"^DD",4.2998,4.2998,405,21,2,0)
the queue for Message Group 5 the longest has been there.
"^DD",4.2998,4.2998,406,0)
MESSAGE AGE GROUP6^NJ7,0^^4;6^K:+X'=X!(X>9999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",4.2998,4.2998,406,3)
Type a Number between 0 and 9999999, 0 Decimal Digits
"^DD",4.2998,4.2998,406,21,0)
^^2^2^2931214^
"^DD",4.2998,4.2998,406,21,1,0)
This is the amount of seconds that the message that has been in
"^DD",4.2998,4.2998,406,21,2,0)
the queue for Message Group 6 the longest has been there.
"^DD",4.2998,4.2998,407,0)
MESSAGE AGE GROUP7^NJ7,0^^4;7^K:+X'=X!(X>9999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",4.2998,4.2998,407,3)
Type a Number between 0 and 9999999, 0 Decimal Digits
"^DD",4.2998,4.2998,407,21,0)
^^2^2^2931214^
"^DD",4.2998,4.2998,407,21,1,0)
This is the amount of seconds that the message that has been in
"^DD",4.2998,4.2998,407,21,2,0)
the queue for Message Group 7 the longest has been there.
"^DD",4.2998,4.2998,407,"DT")
2911106
"^DD",4.2998,4.2998,408,0)
MESSAGE AGE GROUP8^NJ7,0^^4;8^K:+X'=X!(X>9999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",4.2998,4.2998,408,3)
Type a Number between 0 and 9999999, 0 Decimal Digits
"^DD",4.2998,4.2998,408,21,0)
^^2^2^2931214^
"^DD",4.2998,4.2998,408,21,1,0)
This is the amount of seconds that the message that has been in
"^DD",4.2998,4.2998,408,21,2,0)
the queue for Message Group 8 the longest has been there.
"^DD",4.2998,4.2998,409,0)
MESSAGE AGE GROUP9^NJ7,0^^4;9^K:+X'=X!(X>9999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",4.2998,4.2998,409,3)
Type a Number between 0 and 9999999, 0 Decimal Digits
"^DD",4.2998,4.2998,409,21,0)
^^2^2^2931214^
"^DD",4.2998,4.2998,409,21,1,0)
This is the amount of seconds that the message that has been in
"^DD",4.2998,4.2998,409,21,2,0)
the queue for Message Group 9 the longest has been there.
"^DD",4.2998,4.2998,410,0)
MESSAGE AGE GROUP 10^NJ7,0^^4;10^K:+X'=X!(X>9999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",4.2998,4.2998,410,3)
Type a Number between 0 and 9999999, 0 Decimal Digits
"^DD",4.2998,4.2998,410,21,0)
^^2^2^2931214^
"^DD",4.2998,4.2998,410,21,1,0)
This is the amount of seconds that the message that has been in
"^DD",4.2998,4.2998,410,21,2,0)
the queue for Message Group 10 the longest has been there.
"^DD",4.2998,4.2998,410,"DT")
2911126
"^DD",4.2998,4.2998,501,0)
MESSAGE NUMBER GROUP1^NJ7,0^^5;1^K:+X'=X!(X>9999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",4.2998,4.2998,501,3)
Type a Number between 0 and 9999999, 0 Decimal Digits
"^DD",4.2998,4.2998,501,21,0)
^^2^2^2931214^^
"^DD",4.2998,4.2998,501,21,1,0)
This is the number of messages that were delivered for Message Group 1
"^DD",4.2998,4.2998,501,21,2,0)
during the last time interval.
"^DD",4.2998,4.2998,502,0)
MESSAGE NUMBER GROUP2^NJ7,0^^5;2^K:+X'=X!(X>9999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",4.2998,4.2998,502,3)
Type a Number between 0 and 9999999, 0 Decimal Digits
"^DD",4.2998,4.2998,502,21,0)
^^2^2^2931214^^^
"^DD",4.2998,4.2998,502,21,1,0)
This is the number of messages that were delivered for Message Group 2
"^DD",4.2998,4.2998,502,21,2,0)
during the last time interval.
"^DD",4.2998,4.2998,503,0)
MESSAGE NUMBER GROUP3^NJ7,0^^5;3^K:+X'=X!(X>9999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",4.2998,4.2998,503,3)
Type a Number between 0 and 9999999, 0 Decimal Digits
"^DD",4.2998,4.2998,503,21,0)
^^2^2^2931214^^
"^DD",4.2998,4.2998,503,21,1,0)
This is the number of messages that were delivered for Message Group 3
"^DD",4.2998,4.2998,503,21,2,0)
during the last time interval.
"^DD",4.2998,4.2998,504,0)
MESSAGE NUMBER GROUP4^NJ7,0^^5;4^K:+X'=X!(X>9999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",4.2998,4.2998,504,3)
Type a Number between 0 and 9999999, 0 Decimal Digits
"^DD",4.2998,4.2998,504,21,0)
^^2^2^2931214^^
"^DD",4.2998,4.2998,504,21,1,0)
This is the number of messages that were delivered for Message Group 4
"^DD",4.2998,4.2998,504,21,2,0)
during the last time interval.
"^DD",4.2998,4.2998,505,0)
MESSAGE NUMBER GROUP5^NJ7,0^^5;5^K:+X'=X!(X>9999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",4.2998,4.2998,505,3)
Type a Number between 0 and 9999999, 0 Decimal Digits
"^DD",4.2998,4.2998,505,21,0)
^^2^2^2931214^^
"^DD",4.2998,4.2998,505,21,1,0)
This is the number of messages that were delivered for Message Group 5
"^DD",4.2998,4.2998,505,21,2,0)
during the last time interval.
"^DD",4.2998,4.2998,506,0)
MESSAGE NUMBER GROUP6^NJ7,0^^5;6^K:+X'=X!(X>9999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",4.2998,4.2998,506,3)
Type a Number between 0 and 9999999, 0 Decimal Digits
"^DD",4.2998,4.2998,506,21,0)
^^2^2^2931214^^
"^DD",4.2998,4.2998,506,21,1,0)
This is the number of messages that were delivered for Message Group 6
"^DD",4.2998,4.2998,506,21,2,0)
during the last time interval.
"^DD",4.2998,4.2998,507,0)
MESSAGE NUMBER GROUP7^NJ7,0^^5;7^K:+X'=X!(X>9999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",4.2998,4.2998,507,3)
Type a Number between 0 and 9999999, 0 Decimal Digits
"^DD",4.2998,4.2998,507,21,0)
^^2^2^2931214^^
"^DD",4.2998,4.2998,507,21,1,0)
This is the number of messages that were delivered for Message Group 7
"^DD",4.2998,4.2998,507,21,2,0)
during the last time interval.
"^DD",4.2998,4.2998,508,0)
MESSAGE NUMBER GROUP8^NJ7,0^^5;8^K:+X'=X!(X>9999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",4.2998,4.2998,508,3)
Type a Number between 0 and 9999999, 0 Decimal Digits
"^DD",4.2998,4.2998,508,21,0)
^^2^2^2931214^^
"^DD",4.2998,4.2998,508,21,1,0)
This is the number of messages that were delivered for Message Group 8
"^DD",4.2998,4.2998,508,21,2,0)
during the last time interval.
"^DD",4.2998,4.2998,509,0)
MESSAGE NUMBER GROUP9^NJ7,0^^5;9^K:+X'=X!(X>9999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",4.2998,4.2998,509,3)
Type a Number between 0 and 9999999, 0 Decimal Digits
"^DD",4.2998,4.2998,509,21,0)
^^2^2^2931214^^
"^DD",4.2998,4.2998,509,21,1,0)
This is the number of messages that were delivered for Message Group 9
"^DD",4.2998,4.2998,509,21,2,0)
during the last time interval.
"^DD",4.2998,4.2998,510,0)
MESSAGE NUMBER GROUP 10^NJ7,0^^5;10^K:+X'=X!(X>9999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",4.2998,4.2998,510,3)
Type a Number between 0 and 9999999, 0 Decimal Digits
"^DD",4.2998,4.2998,510,21,0)
^^2^2^2931214^^
"^DD",4.2998,4.2998,510,21,1,0)
This is the number of messages that were delivered for Message Group 10
"^DD",4.2998,4.2998,510,21,2,0)
during the last time interval.
"^DD",4.2998,4.2998,510,"DT")
2911126
"^DD",4.2998,4.2998,601,0)
QUEUED DELIVERIES RESPONSE G1^NJ7,0^^6;1^K:+X'=X!(X>9999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",4.2998,4.2998,601,3)
Type a Number between 0 and 9999999, 0 Decimal Digits
"^DD",4.2998,4.2998,601,21,0)
^^2^2^2931214^
"^DD",4.2998,4.2998,601,21,1,0)
This is the number of response deliveries that were in the queue
"^DD",4.2998,4.2998,601,21,2,0)
for Response Group 1 when the queue was checked.
"^DD",4.2998,4.2998,601,"DT")
2911210
"^DD",4.2998,4.2998,602,0)
QUEUED DELIVERIES RESPONSE G2^NJ7,0^^6;2^K:+X'=X!(X>9999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",4.2998,4.2998,602,3)
Type a Number between 0 and 9999999, 0 Decimal Digits
"^DD",4.2998,4.2998,602,21,0)
^^2^2^2931214^
"^DD",4.2998,4.2998,602,21,1,0)
This is the number of response deliveries that were in the queue
"^DD",4.2998,4.2998,602,21,2,0)
for Response Group 2 when the queue was checked.
"^DD",4.2998,4.2998,602,"DT")
2911210
"^DD",4.2998,4.2998,603,0)
QUEUED DELIVERIES RESPONSE G3^NJ7,0^^6;3^K:+X'=X!(X>9999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",4.2998,4.2998,603,3)
Type a Number between 0 and 9999999, 0 Decimal Digits
"^DD",4.2998,4.2998,603,21,0)
^^2^2^2931214^
"^DD",4.2998,4.2998,603,21,1,0)
This is the number of response deliveries that were in the queue
"^DD",4.2998,4.2998,603,21,2,0)
for Response Group 3 when the queue was checked.
"^DD",4.2998,4.2998,603,"DT")
2911210
"^DD",4.2998,4.2998,604,0)
QUEUED DELIVERIES RESPONSE G4^NJ7,0^^6;4^K:+X'=X!(X>9999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",4.2998,4.2998,604,3)
Type a Number between 0 and 9999999, 0 Decimal Digits
"^DD",4.2998,4.2998,604,21,0)
^^2^2^2931214^
"^DD",4.2998,4.2998,604,21,1,0)
This is the number of response deliveries that were in the queue
"^DD",4.2998,4.2998,604,21,2,0)
for Response Group 4 when the queue was checked.
"^DD",4.2998,4.2998,604,"DT")
2911210
"^DD",4.2998,4.2998,605,0)
QUEUED DELIVERIES RESPONSE G5^NJ7,0^^6;5^K:+X'=X!(X>9999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",4.2998,4.2998,605,3)
Type a Number between 0 and 9999999, 0 Decimal Digits
"^DD",4.2998,4.2998,605,21,0)
^^2^2^2931214^
"^DD",4.2998,4.2998,605,21,1,0)
This is the number of response deliveries that were in the queue
"^DD",4.2998,4.2998,605,21,2,0)
for Response Group 5 when the queue was checked.
"^DD",4.2998,4.2998,605,"DT")
2911210
"^DD",4.2998,4.2998,606,0)
QUEUED DELIVERIES RESPONSE G6^NJ7,0^^6;6^K:+X'=X!(X>9999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",4.2998,4.2998,606,3)
Type a Number between 0 and 9999999, 0 Decimal Digits
"^DD",4.2998,4.2998,606,21,0)
^^2^2^2931214^
"^DD",4.2998,4.2998,606,21,1,0)
This is the number of response deliveries that were in the queue
"^DD",4.2998,4.2998,606,21,2,0)
for Response Group 6 when the queue was checked.
"^DD",4.2998,4.2998,606,"DT")
2911210
"^DD",4.2998,4.2998,607,0)
QUEUED DELIVERIES RESPONSE G7^NJ7,0^^6;7^K:+X'=X!(X>9999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",4.2998,4.2998,607,3)
Type a Number between 0 and 9999999, 0 Decimal Digits
"^DD",4.2998,4.2998,607,21,0)
^^2^2^2931214^
"^DD",4.2998,4.2998,607,21,1,0)
This is the number of response deliveries that were in the queue
"^DD",4.2998,4.2998,607,21,2,0)
for Response Group 7 when the queue was checked.
"^DD",4.2998,4.2998,607,"DT")
2911210
"^DD",4.2998,4.2998,608,0)
QUEUED DELIVERIES RESPONSE G8^NJ7,0^^6;8^K:+X'=X!(X>9999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",4.2998,4.2998,608,3)
Type a Number between 0 and 9999999, 0 Decimal Digits
"^DD",4.2998,4.2998,608,21,0)
^^2^2^2931214^
"^DD",4.2998,4.2998,608,21,1,0)
This is the number of response deliveries that were in the queue
"^DD",4.2998,4.2998,608,21,2,0)
for Response Group 8 when the queue was checked.
"^DD",4.2998,4.2998,608,"DT")
2911210
"^DD",4.2998,4.2998,609,0)
QUEUED DELIVERIES RESPONSE G9^NJ7,0^^6;9^K:+X'=X!(X>9999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",4.2998,4.2998,609,3)
Type a Number between 0 and 9999999, 0 Decimal Digits
"^DD",4.2998,4.2998,609,21,0)
^^2^2^2931214^
"^DD",4.2998,4.2998,609,21,1,0)
This is the number of response deliveries that were in the queue
"^DD",4.2998,4.2998,609,21,2,0)
for Response Group 9 when the queue was checked.
"^DD",4.2998,4.2998,609,"DT")
2911210
"^DD",4.2998,4.2998,610,0)
QUEUED DELIVERIES RESP G 10^NJ7,0^^6;10^K:+X'=X!(X>9999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",4.2998,4.2998,610,3)
Type a Number between 0 and 9999999, 0 Decimal Digits
"^DD",4.2998,4.2998,610,21,0)
^^2^2^2931214^
"^DD",4.2998,4.2998,610,21,1,0)
This is the number of response deliveries that were in the queue
"^DD",4.2998,4.2998,610,21,2,0)
for Response Group 10 when the queue was checked.
"^DD",4.2998,4.2998,610,"DT")
2911210
"^DD",4.2998,4.2998,701,0)
QUEUED DELIVERIES MESSAGE G1^NJ7,0^^7;1^K:+X'=X!(X>9999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",4.2998,4.2998,701,3)
Type a Number between 0 and 9999999, 0 Decimal Digits
"^DD",4.2998,4.2998,701,21,0)
^^2^2^2931214^
"^DD",4.2998,4.2998,701,21,1,0)
This is the number of message deliveries that were in the queue
"^DD",4.2998,4.2998,701,21,2,0)
for Message Group 1 when the queue was checked.
"^DD",4.2998,4.2998,701,"DT")
2911210
"^DD",4.2998,4.2998,702,0)
QUEUED DELIVERIES MESSAGE G2^NJ7,0^^7;2^K:+X'=X!(X>9999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",4.2998,4.2998,702,3)
Type a Number between 0 and 9999999, 0 Decimal Digits
"^DD",4.2998,4.2998,702,21,0)
^^2^2^2931214^
"^DD",4.2998,4.2998,702,21,1,0)
This is the number of message deliveries that were in the queue
"^DD",4.2998,4.2998,702,21,2,0)
for Message Group 2 when the queue was checked.
"^DD",4.2998,4.2998,702,"DT")
2911210
"^DD",4.2998,4.2998,703,0)
QUEUED DELIVERIES MESSAGE G3^NJ7,0^^7;3^K:+X'=X!(X>9999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",4.2998,4.2998,703,3)
Type a Number between 0 and 9999999, 0 Decimal Digits
"^DD",4.2998,4.2998,703,21,0)
^^2^2^2931214^
"^DD",4.2998,4.2998,703,21,1,0)
This is the number of message deliveries that were in the queue
"^DD",4.2998,4.2998,703,21,2,0)
for Message Group 3 when the queue was checked.
"^DD",4.2998,4.2998,703,"DT")
2911210
"^DD",4.2998,4.2998,704,0)
QUEUED DELIVERIES MESSAGE G4^NJ7,0^^7;4^K:+X'=X!(X>9999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",4.2998,4.2998,704,3)
Type a Number between 0 and 9999999, 0 Decimal Digits
"^DD",4.2998,4.2998,704,21,0)
^^2^2^2931214^
"^DD",4.2998,4.2998,704,21,1,0)
This is the number of message deliveries that were in the queue
"^DD",4.2998,4.2998,704,21,2,0)
for Message Group 4 when the queue was checked.
"^DD",4.2998,4.2998,704,"DT")
2911210
"^DD",4.2998,4.2998,705,0)
QUEUED DELIVERIES MESSAGE G5^NJ7,0^^7;5^K:+X'=X!(X>9999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",4.2998,4.2998,705,3)
Type a Number between 0 and 9999999, 0 Decimal Digits
"^DD",4.2998,4.2998,705,21,0)
^^2^2^2931214^
"^DD",4.2998,4.2998,705,21,1,0)
This is the number of message deliveries that were in the queue
"^DD",4.2998,4.2998,705,21,2,0)
for Message Group 5 when the queue was checked.
"^DD",4.2998,4.2998,705,"DT")
2911210
"^DD",4.2998,4.2998,706,0)
QUEUED DELIVERIES MESSAGE G6^NJ7,0^^7;6^K:+X'=X!(X>9999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",4.2998,4.2998,706,3)
Type a Number between 0 and 9999999, 0 Decimal Digits
"^DD",4.2998,4.2998,706,21,0)
^^2^2^2931214^
"^DD",4.2998,4.2998,706,21,1,0)
This is the number of message deliveries that were in the queue
"^DD",4.2998,4.2998,706,21,2,0)
for Message Group 6 when the queue was checked.
"^DD",4.2998,4.2998,706,"DT")
2911210
"^DD",4.2998,4.2998,707,0)
QUEUED DELIVERIES MESSAGE G7^NJ7,0^^7;7^K:+X'=X!(X>9999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",4.2998,4.2998,707,3)
Type a Number between 0 and 9999999, 0 Decimal Digits
"^DD",4.2998,4.2998,707,21,0)
^^2^2^2931214^
"^DD",4.2998,4.2998,707,21,1,0)
This is the number of message deliveries that were in the queue
"^DD",4.2998,4.2998,707,21,2,0)
for Message Group 7 when the queue was checked.
"^DD",4.2998,4.2998,707,"DT")
2911210
"^DD",4.2998,4.2998,708,0)
QUEUED DELIVERIES MESSAGE G8^NJ7,0^^7;8^K:+X'=X!(X>9999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",4.2998,4.2998,708,3)
Type a Number between 0 and 9999999, 0 Decimal Digits
"^DD",4.2998,4.2998,708,21,0)
^^2^2^2931214^
"^DD",4.2998,4.2998,708,21,1,0)
This is the number of message deliveries that were in the queue
"^DD",4.2998,4.2998,708,21,2,0)
for Message Group 8 when the queue was checked.
"^DD",4.2998,4.2998,708,"DT")
2911210
"^DD",4.2998,4.2998,709,0)
QUEUED DELIVERIES MESSAGE G9^NJ7,0^^7;9^K:+X'=X!(X>9999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",4.2998,4.2998,709,3)
Type a Number between 0 and 9999999, 0 Decimal Digits
"^DD",4.2998,4.2998,709,21,0)
^^2^2^2931214^
"^DD",4.2998,4.2998,709,21,1,0)
This is the number of message deliveries that were in the queue
"^DD",4.2998,4.2998,709,21,2,0)
for Message Group 9 when the queue was checked.
"^DD",4.2998,4.2998,709,"DT")
2911210
"^DD",4.2998,4.2998,710,0)
QUEUED DELIVERIES MESSAGE G 10^NJ7,0^^7;10^K:+X'=X!(X>9999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",4.2998,4.2998,710,3)
Type a Number between 0 and 9999999, 0 Decimal Digits
"^DD",4.2998,4.2998,710,21,0)
^^2^2^2931214^
"^DD",4.2998,4.2998,710,21,1,0)
This is the number of message deliveries that were in the queue
"^DD",4.2998,4.2998,710,21,2,0)
for Message Group 10 when the queue was checked.
"^DD",4.2998,4.2998,710,"DT")
2911210
"^DD",4.2999,4.2999,0)
FIELD^^8^20
"^DD",4.2999,4.2999,0,"DDA")
N
"^DD",4.2999,4.2999,0,"DT")
3020416
"^DD",4.2999,4.2999,0,"IX","B",4.2999,.01)

"^DD",4.2999,4.2999,0,"NM","MESSAGE STATISTICS")

"^DD",4.2999,4.2999,0,"VRPK")
XM
"^DD",4.2999,4.2999,.01,0)
NAME^RP4.2'X^DIC(4.2,^0;1^S:$D(X) DINUM=X
"^DD",4.2999,4.2999,.01,.1)
Domain name
"^DD",4.2999,4.2999,.01,1,0)
^.1
"^DD",4.2999,4.2999,.01,1,1,0)
4.2999^B
"^DD",4.2999,4.2999,.01,1,1,1)
S ^XMBS(4.2999,"B",$E(X,1,30),DA)=""
"^DD",4.2999,4.2999,.01,1,1,2)
K ^XMBS(4.2999,"B",$E(X,1,30),DA)
"^DD",4.2999,4.2999,.01,3)

"^DD",4.2999,4.2999,.01,21,0)
^^1^1^3020403^^^^
"^DD",4.2999,4.2999,.01,21,1,0)
Domain for which network mail transmission information is collected.
"^DD",4.2999,4.2999,.01,"DT")
3020403
"^DD",4.2999,4.2999,1,0)
PROGRESS REPORT^F^^3;1^K:$L(X)>20!($L(X)<6) X
"^DD",4.2999,4.2999,1,3)
Answer must be 6-20 characters in length.
"^DD",4.2999,4.2999,1,21,0)
^^4^4^2900530^
"^DD",4.2999,4.2999,1,21,1,0)
This field contains the time in $H format of the last time a queue dump 
"^DD",4.2999,4.2999,1,21,2,0)
routine reported its progress.  If this field is undefined, or 'old', then 
"^DD",4.2999,4.2999,1,21,3,0)
the queue is assumed to be inactive.  If not, the rest of the fields on this
"^DD",4.2999,4.2999,1,21,4,0)
node indicate the status of the transmission.
"^DD",4.2999,4.2999,2,0)
MESSAGE IN TRANSIT^P3.9'^XMB(3.9,^3;2^Q
"^DD",4.2999,4.2999,2,3)
Enter the IEN of the message being transmitted.
"^DD",4.2999,4.2999,2,21,0)
^^1^1^3020403^^
"^DD",4.2999,4.2999,2,21,1,0)
This points to the 3.9 (Message) file entry of the message being transmitted.
"^DD",4.2999,4.2999,2,"DT")
3020403
"^DD",4.2999,4.2999,3,0)
LINE LAST TRANSMITTED^NJ9,0^^3;3^K:+X'=X!(X>999999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",4.2999,4.2999,3,3)
Type a Number between 0 and 999999999, 0 Decimal Digits
"^DD",4.2999,4.2999,3,21,0)
^.001^1^1^3010320^^
"^DD",4.2999,4.2999,3,21,1,0)
This is the line number of the message in transit.
"^DD",4.2999,4.2999,4,0)
ERRORS THIS TRANSMISSION^NJ3,0^^3;4^K:+X'=X!(X>999)!(X<0)!(X?.E1"."1N.N) X
"^DD",4.2999,4.2999,4,3)
Type a Number between 0 and 999, 0 Decimal Digits
"^DD",4.2999,4.2999,4,21,0)
^^2^2^2900530^
"^DD",4.2999,4.2999,4,21,1,0)
This is the number of "soft" errors (non-fatal) that have been encountered 
"^DD",4.2999,4.2999,4,21,2,0)
during the course of the entire current transmission.
"^DD",4.2999,4.2999,5,0)
RATE OF TRANSMISSION^NJ9,0^^3;5^K:+X'=X!(X>999999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",4.2999,4.2999,5,3)
Type a Number between 0 and 999999999, 0 Decimal Digits
"^DD",4.2999,4.2999,5,21,0)
^.001^4^4^3010326^^^
"^DD",4.2999,4.2999,5,21,1,0)
This is the transmission rate in characters per second for the
"^DD",4.2999,4.2999,5,21,2,0)
current transmission.  It may be for a single line or for a block
"^DD",4.2999,4.2999,5,21,3,0)
or for the entire message.  It is updated regularly during the
"^DD",4.2999,4.2999,5,21,4,0)
transmission.
"^DD",4.2999,4.2999,5,"DT")
3010326
"^DD",4.2999,4.2999,6,0)
NETWORK DEVICE^F^^3;6^K:$L(X)>19!($L(X)<1) X
"^DD",4.2999,4.2999,6,3)
Answer must be 1-19 characters in length.
"^DD",4.2999,4.2999,6,21,0)
^^2^2^2900530^
"^DD",4.2999,4.2999,6,21,1,0)
This is the name of the device (system name) that the transmission is 
"^DD",4.2999,4.2999,6,21,2,0)
running on.  It may be incoming or outgoing.
"^DD",4.2999,4.2999,8,0)
DIRECTION^S^S:SENDING;R:RECEIVING;^3;8^Q
"^DD",4.2999,4.2999,8,3)
Are we sending or receiving?
"^DD",4.2999,4.2999,8,21,0)
^^2^2^3020416^
"^DD",4.2999,4.2999,8,21,1,0)
This field is used to report whether, at any given time,
"^DD",4.2999,4.2999,8,21,2,0)
we are sending messages to, or receiving messages from, the site.  
"^DD",4.2999,4.2999,8,"DT")
3020416
"^DD",4.2999,4.2999,25,0)
TRANSMISSION TASK#^NJ8,0^^3;7^K:+X'=X!(X>99999999)!(X<1)!(X?.E1"."1N.N) X
"^DD",4.2999,4.2999,25,3)
Type a Number between 1 and 99999999, 0 Decimal Digits
"^DD",4.2999,4.2999,25,21,0)
^^2^2^2890922^^
"^DD",4.2999,4.2999,25,21,1,0)
The transmission task# points to the TaskMan task that has been generated
"^DD",4.2999,4.2999,25,21,2,0)
to handle delivery of messages to the domain in background.
"^DD",4.2999,4.2999,25,"DT")
2890922
"^DD",4.2999,4.2999,41,0)
XMIT START DATE/TIME^D^^4;1^S %DT="ESTXR" D ^%DT S X=Y K:Y<1 X
"^DD",4.2999,4.2999,41,3)
This is the date/time that the transmission process started.
"^DD",4.2999,4.2999,41,21,0)
^^2^2^2960529^^
"^DD",4.2999,4.2999,41,21,1,0)
This field helps MailMan determine, after a fatal error, whether to start the
"^DD",4.2999,4.2999,41,21,2,0)
transmission process at script 1, try 1, or to start it elsewhere.
"^DD",4.2999,4.2999,41,"DT")
2960529
"^DD",4.2999,4.2999,42,0)
XMIT FINISH DATE/TIME^D^^4;2^S %DT="ESTXR" D ^%DT S X=Y K:Y<1 X
"^DD",4.2999,4.2999,42,3)
Date/time transmission process started/ended
"^DD",4.2999,4.2999,42,21,0)
^^1^1^2960529^
"^DD",4.2999,4.2999,42,21,1,0)
This may be useful information for debugging purposes.
"^DD",4.2999,4.2999,42,"DT")
2960529
"^DD",4.2999,4.2999,43,0)
XMIT SCRIPT^NJ3,0^^4;3^K:+X'=X!(X>100)!(X<0)!(X?.E1"."1N.N) X
"^DD",4.2999,4.2999,43,3)
IEN (0-100) of TRANSMISSION SCRIPT (4.21) record within DOMAIN file (4.2)
"^DD",4.2999,4.2999,43,21,0)
^^1^1^2960529^
"^DD",4.2999,4.2999,43,21,1,0)
This tells MailMan which script is/was being used.
"^DD",4.2999,4.2999,43,"DT")
2960529
"^DD",4.2999,4.2999,44,0)
XMIT TRIES^NJ3,0^^4;4^K:+X'=X!(X>100)!(X<0)!(X?.E1"."1N.N) X
"^DD",4.2999,4.2999,44,3)
Type a Number between 0 and 100, 0 Decimal Digits
"^DD",4.2999,4.2999,44,21,0)
^^1^1^2960529^
"^DD",4.2999,4.2999,44,21,1,0)
This tells MailMan how many tries have been made with the current script.
"^DD",4.2999,4.2999,44,"DT")
2960529
"^DD",4.2999,4.2999,45,0)
XMIT LATEST TRY DATE/TIME^D^^4;5^S %DT="ESTXR" D ^%DT S X=Y K:Y<1 X
"^DD",4.2999,4.2999,45,3)
Enter date/time of latest transmission attempt
"^DD",4.2999,4.2999,45,21,0)
^^1^1^2960529^
"^DD",4.2999,4.2999,45,21,1,0)
This may be useful information for debugging purposes.
"^DD",4.2999,4.2999,45,"DT")
2960529
"^DD",4.2999,4.2999,46,0)
XMIT SCRIPT CYCLE ITERATIONS^NJ3,0^^4;6^K:+X'=X!(X>999)!(X<0)!(X?.E1"."1N.N) X
"^DD",4.2999,4.2999,46,3)
Type a Number between 0 and 999, 0 Decimal Digits
"^DD",4.2999,4.2999,46,21,0)
^^2^2^2960809^^
"^DD",4.2999,4.2999,46,21,1,0)
This is the number of script cycles we have tried.  This field starts off at 0.
"^DD",4.2999,4.2999,46,21,2,0)
After we have tried all the scripts available, we bump up this field by 1.
"^DD",4.2999,4.2999,46,"DT")
2960809
"^DD",4.2999,4.2999,47,0)
XMIT FIRST SCRIPT^NJ3,0^^4;7^K:+X'=X!(X>100)!(X<1)!(X?.E1"."1N.N) X
"^DD",4.2999,4.2999,47,3)
Type a Number between 1 and 100, 0 Decimal Digits
"^DD",4.2999,4.2999,47,21,0)
^^2^2^2960809^
"^DD",4.2999,4.2999,47,21,1,0)
This field notes which script has the highest priority, that is, which script
"^DD",4.2999,4.2999,47,21,2,0)
was tried first.
"^DD",4.2999,4.2999,47,"DT")
2960809
"^DD",4.2999,4.2999,48,0)
XMIT IP ADDRESSES TRIED^F^^4;8^K:$L(X)>100!($L(X)<3) X
"^DD",4.2999,4.2999,48,3)
Answer must be 3-100 characters in length.
"^DD",4.2999,4.2999,48,21,0)
^^6^6^3020321^
"^DD",4.2999,4.2999,48,21,1,0)
This is a list of IP addresses, separated by commas, which have already
"^DD",4.2999,4.2999,48,21,2,0)
been used in attempting to connect with the site.
"^DD",4.2999,4.2999,48,21,3,0)

"^DD",4.2999,4.2999,48,21,4,0)
We use this list in conjunction with the DNS server, which returns a list
"^DD",4.2999,4.2999,48,21,5,0)
of valid addresses to try.  Using both lists, we can come up with the
"^DD",4.2999,4.2999,48,21,6,0)
next IP address to try.
"^DD",4.2999,4.2999,48,"DT")
3020321
"^DD",4.2999,4.2999,51,0)
XMIT SCRIPT RECORD^F^^5;E1,245^K:$L(X)>245!($L(X)<10) X
"^DD",4.2999,4.2999,51,3)
Answer must be 10-245 characters in length.
"^DD",4.2999,4.2999,51,21,0)
^^1^1^2960529^
"^DD",4.2999,4.2999,51,21,1,0)
This is a copy of the zeronode of the latest script used.
"^DD",4.2999,4.2999,51,"DT")
2960529
"^DD",4.2999,4.2999,60,0)
XMIT AUDIT^4.29992D^^6;0
"^DD",4.2999,4.2999,60,21,0)
^^2^2^2981001^^^
"^DD",4.2999,4.2999,60,21,1,0)
This multiple contains an audit of the attempts that have been made during
"^DD",4.2999,4.2999,60,21,2,0)
this transmission.
"^DD",4.2999,4.2999,101,0)
MESSAGE STATISTICS MONTH^4.29991D^^100;0
"^DD",4.2999,4.2999,101,21,0)
^^3^3^2931214^^
"^DD",4.2999,4.2999,101,21,1,0)
Message statistics are summed into this area at the end of each successful
"^DD",4.2999,4.2999,101,21,2,0)
message received or sent into the appropriate month according to the time
"^DD",4.2999,4.2999,101,21,3,0)
the message is received.
"^DD",4.2999,4.29991,0)
MESSAGE STATISTICS MONTH SUB-FIELD^^107^7
"^DD",4.2999,4.29991,0,"DT")
3020403
"^DD",4.2999,4.29991,0,"IX","B",4.29991,.01)

"^DD",4.2999,4.29991,0,"NM","MESSAGE STATISTICS MONTH")

"^DD",4.2999,4.29991,0,"UP")
4.2999
"^DD",4.2999,4.29991,.01,0)
MESSAGE STATISTICS MONTH^D^^0;1^S %DT="E" D ^%DT S X=Y K:Y<1 X
"^DD",4.2999,4.29991,.01,1,0)
^.1
"^DD",4.2999,4.29991,.01,1,1,0)
4.29991^B
"^DD",4.2999,4.29991,.01,1,1,1)
S ^XMBS(4.2999,DA(1),100,"B",$E(X,1,30),DA)=""
"^DD",4.2999,4.29991,.01,1,1,2)
K ^XMBS(4.2999,DA(1),100,"B",$E(X,1,30),DA)
"^DD",4.2999,4.29991,.01,21,0)
^^3^3^2931214^
"^DD",4.2999,4.29991,.01,21,1,0)
Message statistics are summed into this area at the end of each successful
"^DD",4.2999,4.29991,.01,21,2,0)
message received or sent into the appropriate month according to the time
"^DD",4.2999,4.29991,.01,21,3,0)
the message is received.
"^DD",4.2999,4.29991,102,0)
MESSAGES SENT^NJ7,0^^0;2^K:+X'=X!(X>9999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",4.2999,4.29991,102,3)
Type a Number between 0 and 9999999, 0 Decimal Digits
"^DD",4.2999,4.29991,102,21,0)
^^3^3^2900530^
"^DD",4.2999,4.29991,102,21,1,0)
This is the number of messagaes that were transmitted to this domain.
"^DD",4.2999,4.29991,102,21,2,0)
Previously transmitted (but forwarded to new recipients) message and
"^DD",4.2999,4.29991,102,21,3,0)
responses are included as though they were separate messages.
"^DD",4.2999,4.29991,103,0)
MESSAGES RECEIVED^NJ7,0^^0;3^K:+X'=X!(X>9999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",4.2999,4.29991,103,3)
Type a Number between 0 and 9999999, 0 Decimal Digits
"^DD",4.2999,4.29991,103,21,0)
^^3^3^3020403^^
"^DD",4.2999,4.29991,103,21,1,0)
Messages received are included here even if they are received only to be
"^DD",4.2999,4.29991,103,21,2,0)
forwarded on to another site.  Also included are responses and messages
"^DD",4.2999,4.29991,103,21,3,0)
received previously (as long as they have additional recipients).
"^DD",4.2999,4.29991,103,"DT")
3020403
"^DD",4.2999,4.29991,104,0)
CHARACTERS SENT^NJ9,0^^0;4^K:+X'=X!(X>999999999)!(X<0)!(X?.E1"."1.N) X
"^DD",4.2999,4.29991,104,3)
Type a number between 0 and 999999999, 0 Decimal Digits
"^DD",4.2999,4.29991,104,21,0)
^^1^1^2900530^^
"^DD",4.2999,4.29991,104,21,1,0)
This is a count of the number of characters in the messages sent.
"^DD",4.2999,4.29991,104,"DT")
3020403
"^DD",4.2999,4.29991,105,0)
CHARACTERS RECEIVED^NJ9,0^^0;5^K:+X'=X!(X>999999999)!(X<0)!(X?.E1"."1.N) X
"^DD",4.2999,4.29991,105,3)
Type a number between 0 and 999999999, 0 Decimal Digits
"^DD",4.2999,4.29991,105,21,0)
^^1^1^2900530^
"^DD",4.2999,4.29991,105,21,1,0)
This is a count of the number of characters in the messages received.
"^DD",4.2999,4.29991,105,"DT")
3020403
"^DD",4.2999,4.29991,106,0)
LINES SENT^NJ8,0^^0;6^K:+X'=X!(X>99999999)!(X<0)!(X?.E1"."1.N) X
"^DD",4.2999,4.29991,106,3)
Type a number between 0 and 99999999, 0 Decimal Digits
"^DD",4.2999,4.29991,106,21,0)
^^1^1^2900530^
"^DD",4.2999,4.29991,106,21,1,0)
This is a count of the number of lines in the message sent.
"^DD",4.2999,4.29991,106,"DT")
3020403
"^DD",4.2999,4.29991,107,0)
LINES RECEIVED^NJ8,0^^0;7^K:+X'=X!(X>99999999)!(X<0)!(X?.E1"."1.N) X
"^DD",4.2999,4.29991,107,3)
Type a number between 0 and 99999999, 0 Decimal Digits
"^DD",4.2999,4.29991,107,21,0)
^^1^1^2900605^^^
"^DD",4.2999,4.29991,107,21,1,0)
This is a count of the number of lines in the messages received.
"^DD",4.2999,4.29991,107,"DT")
3020403
"^DD",4.2999,4.29992,0)
XMIT AUDIT SUB-FIELD^^3^4
"^DD",4.2999,4.29992,0,"DT")
3020321
"^DD",4.2999,4.29992,0,"NM","XMIT AUDIT")

"^DD",4.2999,4.29992,0,"UP")
4.2999
"^DD",4.2999,4.29992,.01,0)
XMIT AUDIT DATE/TIME^MD^^0;1^S %DT="ESTXR" D ^%DT S X=Y K:Y<1 X
"^DD",4.2999,4.29992,.01,1,0)
^.1^^0
"^DD",4.2999,4.29992,.01,21,0)
^^1^1^2960614^^
"^DD",4.2999,4.29992,.01,21,1,0)
This is the date/time of the start of this attempt.
"^DD",4.2999,4.29992,.01,"DT")
2960614
"^DD",4.2999,4.29992,1,0)
XMIT AUDIT SCRIPT NAME^F^^0;2^K:$L(X)>10!($L(X)<1) X
"^DD",4.2999,4.29992,1,3)
Answer must be 1-10 characters in length.
"^DD",4.2999,4.29992,1,21,0)
^^1^1^2981001^^
"^DD",4.2999,4.29992,1,21,1,0)
This is the name of the script being used for this attempt.
"^DD",4.2999,4.29992,1,"DT")
2960614
"^DD",4.2999,4.29992,2,0)
XMIT AUDIT ERROR^F^^0;3^K:$L(X)>200!($L(X)<1) X
"^DD",4.2999,4.29992,2,3)
Answer must be 1-200 characters in length.
"^DD",4.2999,4.29992,2,21,0)
^.001^2^2^3020321^^
"^DD",4.2999,4.29992,2,21,1,0)
If the transmission fails or is interrupted for some reason, the reason
"^DD",4.2999,4.29992,2,21,2,0)
will be placed here.
"^DD",4.2999,4.29992,2,"DT")
3020321
"^DD",4.2999,4.29992,3,0)
XMIT AUDIT IP ADDRESS^F^^0;4^K:$L(X)>20!($L(X)<1) X
"^DD",4.2999,4.29992,3,3)
Answer must be 1-20 characters in length.
"^DD",4.2999,4.29992,3,21,0)
^^1^1^3020321^
"^DD",4.2999,4.29992,3,21,1,0)
This is the IP address used for this attempt.
"^DD",4.2999,4.29992,3,"DT")
3020321
"^DD",4.3,4.3,0)
FIELD^^8.24^62
"^DD",4.3,4.3,0,"DDA")
Y
"^DD",4.3,4.3,0,"DT")
3020828
"^DD",4.3,4.3,0,"IX","AC",4.3,1)

"^DD",4.3,4.3,0,"IX","AD",4.3,.01)

"^DD",4.3,4.3,0,"IX","AE",4.3,3)

"^DD",4.3,4.3,0,"IX","AF",4.3,.01)

"^DD",4.3,4.3,0,"IX","AG",4.3,1)

"^DD",4.3,4.3,0,"IX","B",4.3,.01)

"^DD",4.3,4.3,0,"NM","MAILMAN SITE PARAMETERS")

"^DD",4.3,4.3,0,"VRPK")
XM
"^DD",4.3,4.3,.001,0)
NUMBER^NJ1,0^^ ^K:+X'=X!(X>1)!(X<1)!(X?.E1"."1N.N) X
"^DD",4.3,4.3,.001,3)
TYPE A WHOLE NUMBER BETWEEN 1 AND 1
"^DD",4.3,4.3,.001,21,0)
1^^1^1^2920505^^
"^DD",4.3,4.3,.001,21,1,0)
Used to have VA fileman only have one entry in the file.
"^DD",4.3,4.3,.001,"DT")
2851217
"^DD",4.3,4.3,.01,0)
DOMAIN NAME^RP4.2'X^DIC(4.2,^0;1^S DINUM=1
"^DD",4.3,4.3,.01,1,0)
^.1
"^DD",4.3,4.3,.01,1,1,0)
4.3^B
"^DD",4.3,4.3,.01,1,1,1)
S ^XMB(1,"B",$E(X,1,30),DA)=""
"^DD",4.3,4.3,.01,1,1,2)
K ^XMB(1,"B",$E(X,1,30),DA)
"^DD",4.3,4.3,.01,1,2,0)
4.3^AD^MUMPS
"^DD",4.3,4.3,.01,1,2,1)
S ^XMB("NUM")=X
"^DD",4.3,4.3,.01,1,2,2)
K ^XMB("NUM")
"^DD",4.3,4.3,.01,1,2,"%D",0)
^^2^2^2931213^^
"^DD",4.3,4.3,.01,1,2,"%D",1,0)
This cross reference is used to record the pointer to the domain
"^DD",4.3,4.3,.01,1,2,"%D",2,0)
that is the name of the local site.
"^DD",4.3,4.3,.01,1,3,0)
4.3^AF^MUMPS
"^DD",4.3,4.3,.01,1,3,1)
I $D(^DIC(4.2,+X,0)) S (^XMB("NAME"),^XMB("NETNAME"))=$P(^DIC(4.2,+X,0),"^")
"^DD",4.3,4.3,.01,1,3,2)
K ^XMB("NAME"),^XMB("NETNAME")
"^DD",4.3,4.3,.01,1,3,"%D",0)
^^2^2^2931212^
"^DD",4.3,4.3,.01,1,3,"%D",1,0)
This cross reference is used to record the human readable name of the
"^DD",4.3,4.3,.01,1,3,"%D",2,0)
local site's identity.
"^DD",4.3,4.3,.01,1,3,"DT")
2900319
"^DD",4.3,4.3,.01,3)

"^DD",4.3,4.3,.01,21,0)
^^4^4^2980427^^
"^DD",4.3,4.3,.01,21,1,0)
This is the name of this installation of MailMan, as it is known
"^DD",4.3,4.3,.01,21,2,0)
to the rest of the network. It must appear in the DOMAIN file.
"^DD",4.3,4.3,.01,21,3,0)
This name applies to all CPUs or Volume sets which access this ^XMB
"^DD",4.3,4.3,.01,21,4,0)
global.
"^DD",4.3,4.3,.01,"DEL",.01,0)
I 1
"^DD",4.3,4.3,.01,"DT")
2900319
"^DD",4.3,4.3,1,0)
TIME ZONE^RP4.4'^XMB(4.4,^0;2^Q
"^DD",4.3,4.3,1,1,0)
^.1
"^DD",4.3,4.3,1,1,1,0)
4.3^AC^MUMPS
"^DD",4.3,4.3,1,1,1,1)
S ^XMB("TIMEZONE")=$P(^XMB(4.4,X,0),U)
"^DD",4.3,4.3,1,1,1,2)
K ^XMB("TIMEZONE")
"^DD",4.3,4.3,1,1,1,"%D",0)
^^2^2^2980511^^
"^DD",4.3,4.3,1,1,1,"%D",1,0)
This cross reference is used to record the name of the timezone
"^DD",4.3,4.3,1,1,1,"%D",2,0)
that is the correct time zone for the local site.
"^DD",4.3,4.3,1,1,2,0)
4.3^AG^MUMPS
"^DD",4.3,4.3,1,1,2,1)
S ^XMB("TIMEDIFF")=$$TIMEDIFF^XMXUTIL1($P(^XMB(4.4,X,0),U,3))
"^DD",4.3,4.3,1,1,2,2)
K ^XMB("TIMEDIFF")
"^DD",4.3,4.3,1,1,2,"%D",0)
^^5^5^2980511^^^^
"^DD",4.3,4.3,1,1,2,"%D",1,0)
This cross reference records the time difference, in standard internet format,
"^DD",4.3,4.3,1,1,2,"%D",2,0)
between this time zone and GMT.
"^DD",4.3,4.3,1,1,2,"%D",3,0)

"^DD",4.3,4.3,1,1,2,"%D",4,0)
For example, +0800 means 8 hours ahead of GMT.
"^DD",4.3,4.3,1,1,2,"%D",5,0)
             -0130 means 1 1/2 hours behind GMT.
"^DD",4.3,4.3,1,1,2,"DT")
2980511
"^DD",4.3,4.3,1,3)
Enter the time zone of this domain.
"^DD",4.3,4.3,1,21,0)
^^6^6^2980219^^^^
"^DD",4.3,4.3,1,21,1,0)
This field defines the timezone in which this domain is located.
"^DD",4.3,4.3,1,21,2,0)
Note that Standard and Daylight savings times are considered two
"^DD",4.3,4.3,1,21,3,0)
different timezones, requiring that the timezone be changed with
"^DD",4.3,4.3,1,21,4,0)
the changing of daylight savings.  The timezones are located in the
"^DD",4.3,4.3,1,21,5,0)
MailMan timezone file.  The values of the cross references on this
"^DD",4.3,4.3,1,21,6,0)
field are appended to message dates as they are sent over the network.
"^DD",4.3,4.3,1,"DT")
2980511
"^DD",4.3,4.3,2,0)
SUBORDINATE DOMAIN^4.31P^^1;0
"^DD",4.3,4.3,2,21,0)
^^3^3^2980122^^^
"^DD",4.3,4.3,2,21,1,0)
This field is not currently used.
"^DD",4.3,4.3,2,21,2,0)
This field describes the domains which are subordinate to this one;
"^DD",4.3,4.3,2,21,3,0)
that is, those domains which consider this domain a parent.
"^DD",4.3,4.3,3,0)
PARENT^*P4.2'^DIC(4.2,^0;3^S DIC("S")="I +Y'=^XMB(""NUM"")" D ^DIC K DIC S DIC=DIE,X=+Y K:Y<0 X
"^DD",4.3,4.3,3,1,0)
^.1
"^DD",4.3,4.3,3,1,1,0)
4.3^AE^MUMPS
"^DD",4.3,4.3,3,1,1,1)
S ^XMB("PARENT")=X
"^DD",4.3,4.3,3,1,1,2)
K ^XMB("PARENT")
"^DD",4.3,4.3,3,1,1,"%D",0)
^.101^2^2^3010124^^
"^DD",4.3,4.3,3,1,1,"%D",1,0)
This cross reference is used to record the IEN of the domain that
"^DD",4.3,4.3,3,1,1,"%D",2,0)
is the Parent of the local site.
"^DD",4.3,4.3,3,12)
Parent may not be the site itself.
"^DD",4.3,4.3,3,12.1)
S DIC("S")="I +Y'=^XMB(""NUM"")"
"^DD",4.3,4.3,3,21,0)
^.001^15^15^3010124^^^^
"^DD",4.3,4.3,3,21,1,0)
This field holds the name of the domain which is considered the
"^DD",4.3,4.3,3,21,2,0)
parent of this domain.  The parent domain's subordinate domain
"^DD",4.3,4.3,3,21,3,0)
list will contain this domain, also.
"^DD",4.3,4.3,3,21,4,0)
 
"^DD",4.3,4.3,3,21,5,0)
Parent domains are used for routing messages when a subordinate
"^DD",4.3,4.3,3,21,6,0)
domain does not know a direct path to the selected domain.
"^DD",4.3,4.3,3,21,7,0)
 
"^DD",4.3,4.3,3,21,8,0)
Domains are connected to their parents as follows:
"^DD",4.3,4.3,3,21,9,0)
 
"^DD",4.3,4.3,3,21,10,0)
1.  The local domain is named.
"^DD",4.3,4.3,3,21,11,0)
2.  The parent is named at the local site.
"^DD",4.3,4.3,3,21,12,0)
3.  A script from the parent to the subordinate domain is created.
"^DD",4.3,4.3,3,21,13,0)
4.  A christening operation is performed by the parent domain.
"^DD",4.3,4.3,3,21,14,0)
    When the subordinate domain is christened, the domain is connected
"^DD",4.3,4.3,3,21,15,0)
    to the network.  (Mail may be addressed to remote domains)
"^DD",4.3,4.3,3,"DT")
3010124
"^DD",4.3,4.3,4,0)
DATE CHRISTENED^D^^0;4^S %DT="ET" D ^%DT S X=Y K:Y<1 X
"^DD",4.3,4.3,4,3)
Date on which this domain was christened by its parent.
"^DD",4.3,4.3,4,21,0)
^^2^2^2851003^
"^DD",4.3,4.3,4,21,1,0)
This holds the date on which this local domain was christened by its
"^DD",4.3,4.3,4,21,2,0)
parent domain.
"^DD",4.3,4.3,4.301,0)
NO-PURGE DAYS BUFFER^NJ1,0^^.14;1^K:+X'=X!(X>5)!(X<2)!(X?.E1"."1N.N) X
"^DD",4.3,4.3,4.301,3)
Type a Number between 2 and 5, 0 Decimal Digits
"^DD",4.3,4.3,4.301,21,0)
^^9^9^2980918^^^^
"^DD",4.3,4.3,4.301,21,1,0)
This field is used by the unreferenced messages purge to avoid purging
"^DD",4.3,4.3,4.301,21,2,0)
the last few days worth of messages in the message file.  It should be
"^DD",4.3,4.3,4.301,21,3,0)
a number sufficiently high so as to avoid purging messages which are
"^DD",4.3,4.3,4.301,21,4,0)
in danger of being purged before they can be delivered.  This includes
"^DD",4.3,4.3,4.301,21,5,0)
incoming network mail messages.  
"^DD",4.3,4.3,4.301,21,6,0)
The minimum (and default if this field is null) is two days.
"^DD",4.3,4.3,4.301,21,7,0)

"^DD",4.3,4.3,4.301,21,8,0)
For example, if this field is 2, then messages up to and including those
"^DD",4.3,4.3,4.301,21,9,0)
whose local create date is 2 days ago are subject to possible purge.
"^DD",4.3,4.3,4.301,"DT")
2980918
"^DD",4.3,4.3,4.302,0)
PURGE AUDIT^4.302D^^.1;0
"^DD",4.3,4.3,4.302,21,0)
^^17^17^2980122^^^^
"^DD",4.3,4.3,4.302,21,1,0)
This multiple contains a history of Message file purges.  Generally,
"^DD",4.3,4.3,4.302,21,2,0)
a record of the last 20 purges is kept.
"^DD",4.3,4.3,4.302,21,3,0)

"^DD",4.3,4.3,4.302,21,4,0)
MailMan has two ways to purge messages.  The option XMAUTOPURGE is generally
"^DD",4.3,4.3,4.302,21,5,0)
run after XMCLEAN (the waste basket cleaner) and will purge any messages
"^DD",4.3,4.3,4.302,21,6,0)
that are not pointed at by any recipients nor the sender.  The option
"^DD",4.3,4.3,4.302,21,7,0)
XMPURGE-BY-DATE can also be run to purge messages that have an origination
"^DD",4.3,4.3,4.302,21,8,0)
date older than one used to initiate the process.  It is recommended that 
"^DD",4.3,4.3,4.302,21,9,0)
before XMPURGE-BY-DATE is used, users be notified of the proposed purge 
"^DD",4.3,4.3,4.302,21,10,0)
date so they have a chance to preserve important texts.  These are the only 
"^DD",4.3,4.3,4.302,21,11,0)
options that actually kill off entries in the message file.  The XMPURGE 
"^DD",4.3,4.3,4.302,21,12,0)
option does the same thing as XMAUTOPURGE, but is meant to be run in 
"^DD",4.3,4.3,4.302,21,13,0)
foreground and displays data as it proceeds.
"^DD",4.3,4.3,4.302,21,14,0)
 
"^DD",4.3,4.3,4.302,21,15,0)
Unlike XMPURGE and XMAUTOPURGE, which only remove messages that no one holds 
"^DD",4.3,4.3,4.302,21,16,0)
in their mail baskets any more, XMPURGE-BY-DATE will remove messages from
"^DD",4.3,4.3,4.302,21,17,0)
users' mail baskets and then delete them from the message file (3.9).
"^DD",4.3,4.3,4.302,"DT")
2980123
"^DD",4.3,4.3,4.303,0)
AUTOMATIC INTEGRITY CHECK^S^0:YES;1:NO;^.12;1^Q
"^DD",4.3,4.3,4.303,3)
Enter 'Y' if you wish to run the integrity checker, 'N' if you do not wish to run the Integrity Checker (before the XMAUTOPURGE).
"^DD",4.3,4.3,4.303,21,0)
^^9^9^2910521^
"^DD",4.3,4.3,4.303,21,1,0)
XMAUTOPURGE is generally run at least once a week at most sites.  It is
"^DD",4.3,4.3,4.303,21,2,0)
the process that purges messages that are no longer referenced.  Before it
"^DD",4.3,4.3,4.303,21,3,0)
is run, XMCLEAN is generally run.  XMCLEAN removes messages from WASTE
"^DD",4.3,4.3,4.303,21,4,0)
baskets so that they will be unreferenced when XMAUTOPURGE comes along.
"^DD",4.3,4.3,4.303,21,5,0)
XMAUTOPURGE kicks off the part of XMUTCHECKFILE that checks the Mail Box
"^DD",4.3,4.3,4.303,21,6,0)
file.  XMUTCHECKFILE also resets and cleans up the  x-refs of this file.
"^DD",4.3,4.3,4.303,21,7,0)
If your system has had fairly clean runs of XMUTCHECKFILE or if the entire
"^DD",4.3,4.3,4.303,21,8,0)
XMUTCHECKFILE process is run regularly as a separate process, it is not
"^DD",4.3,4.3,4.303,21,9,0)
necessary for XMAUTOPURGE to run any part of it again.
"^DD",4.3,4.3,4.303,23,0)
^^5^5^2910521^
"^DD",4.3,4.3,4.303,23,1,0)
If this field is set to nill or other value that can be evaluated to zero
"^DD",4.3,4.3,4.303,23,2,0)
(+field=zero), then XMUTCHECKFIL is called to check MailBoxes and recreate
"^DD",4.3,4.3,4.303,23,3,0)
the X-ref that the XMAUTOPURGE uses to verify that a message is no longer
"^DD",4.3,4.3,4.303,23,4,0)
referenced by anyone.  If it is set to 1, then this call to XMUTCHECKFIL
"^DD",4.3,4.3,4.303,23,5,0)
is skipped.
"^DD",4.3,4.3,4.303,"DT")
2910520
"^DD",4.3,4.3,4.304,0)
WEEKDAY DAYS TO PURGE^NJ3,0^^NOTOPURGE;1^K:+X'=X!(X>999)!(X<30)!(X?.E1"."1N.N) X
"^DD",4.3,4.3,4.304,3)
Type a Number between 30 and 999, 0 Decimal Digits
"^DD",4.3,4.3,4.304,21,0)
^^13^13^2980922^^^^
"^DD",4.3,4.3,4.304,21,1,0)
When the unreferenced messages purge runs, it purges messages from
"^DD",4.3,4.3,4.304,21,2,0)
the message file, ^XMB(3.9, which are no longer referenced, meaning
"^DD",4.3,4.3,4.304,21,3,0)
they aren't in anyone's mailbox.
"^DD",4.3,4.3,4.304,21,4,0)

"^DD",4.3,4.3,4.304,21,5,0)
If this field is null, OR if the purge is run on Saturday, the purge
"^DD",4.3,4.3,4.304,21,6,0)
starts at the beginning of the message file. 
"^DD",4.3,4.3,4.304,21,7,0)

"^DD",4.3,4.3,4.304,21,8,0)
If this field has a value, AND the purge is run on Sunday through
"^DD",4.3,4.3,4.304,21,9,0)
Friday, the purge starts at the message create date calculated by
"^DD",4.3,4.3,4.304,21,10,0)
subtracting the number of days from today's date.
"^DD",4.3,4.3,4.304,21,11,0)

"^DD",4.3,4.3,4.304,21,12,0)
So, if this number is 45, the unreferenced message purge would start
"^DD",4.3,4.3,4.304,21,13,0)
with messages created 45 days ago, and work from there forward.
"^DD",4.3,4.3,4.304,"DT")
2980917
"^DD",4.3,4.3,5,0)
SHOW INSTITUTION IN MAILMAN?^S^y:YES;n:NO;^0;5^Q
"^DD",4.3,4.3,5,3)
If yes, then the user's institution code will be displayed.
"^DD",4.3,4.3,5,21,0)
^^3^3^2851003^
"^DD",4.3,4.3,5,21,1,0)
This field controls whether mailman will show the user's organization
"^DD",4.3,4.3,5,21,2,0)
after his name.  This is useful when MailMan has many remote users,
"^DD",4.3,4.3,5,21,3,0)
who may not know each other's location or affiliation.
"^DD",4.3,4.3,5.1,0)
MESSAGE ACTION DEFAULT^S^I:IGNORE;D:DELETE;^0;15^Q
"^DD",4.3,4.3,5.1,21,0)
0^^2^2^2980122^2900801^2900801^
"^DD",4.3,4.3,5.1,21,1,0)
This is the default for the user prompt, "Message Action".  The user may
"^DD",4.3,4.3,5.1,21,2,0)
over-ride this default by selecting his own under "Edit User Options".
"^DD",4.3,4.3,5.1,"DT")
2901206
"^DD",4.3,4.3,5.11,0)
COPY LIMIT - RECIPIENTS^NJ5,0^^.11;1^K:+X'=X!(X>99999)!(X<1)!(X?.E1"."1N.N) X
"^DD",4.3,4.3,5.11,3)
Type a Number between 1 and 99999, 0 Decimal Digits
"^DD",4.3,4.3,5.11,21,0)
^^4^4^2980122^^^^
"^DD",4.3,4.3,5.11,21,1,0)
This field enables site management to control whether a message with more
"^DD",4.3,4.3,5.11,21,2,0)
than a certain number of recipients may be copied.  A user may not copy a
"^DD",4.3,4.3,5.11,21,3,0)
message which has more than this number of recipients.  If this field is
"^DD",4.3,4.3,5.11,21,4,0)
null, then the limit is 2999.
"^DD",4.3,4.3,5.11,"DT")
2980123
"^DD",4.3,4.3,5.12,0)
COPY LIMIT - RESPONSES^NJ4,0^^.11;2^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1N.N) X
"^DD",4.3,4.3,5.12,3)
Type a Number between 0 and 9999, 0 Decimal Digits
"^DD",4.3,4.3,5.12,21,0)
^^3^3^2980122^^^^
"^DD",4.3,4.3,5.12,21,1,0)
This field enables site management to limit the number of responses to
"^DD",4.3,4.3,5.12,21,2,0)
a message that may be copied.  A user may not copy more than this number
"^DD",4.3,4.3,5.12,21,3,0)
of responses to a message.  If this field is null, then the limit is 99.
"^DD",4.3,4.3,5.12,"DT")
2980123
"^DD",4.3,4.3,5.13,0)
COPY LIMIT - LINES^NJ7,0^^.11;3^K:+X'=X!(X>9999999)!(X<99)!(X?.E1"."1N.N) X
"^DD",4.3,4.3,5.13,3)
Type a Number between 99 and 9999999, 0 Decimal Digits
"^DD",4.3,4.3,5.13,21,0)
^^3^3^2980122^^
"^DD",4.3,4.3,5.13,21,1,0)
This field enables site management to limit the number of lines that may be
"^DD",4.3,4.3,5.13,21,2,0)
copied from a message and its responses.  A user may not copy more than this
"^DD",4.3,4.3,5.13,21,3,0)
number of message lines.  If this field is null, then the limit is 3999.
"^DD",4.3,4.3,5.13,"DT")
2980123
"^DD",4.3,4.3,7,0)
REQUIRE INTRODUCTIONS?^S^y:YES;n:NO;^0;6^Q
"^DD",4.3,4.3,7,3)
Are users required to enter introductory text about themselves to the MailMan system?
"^DD",4.3,4.3,7,21,0)
^^4^4^2980730^^
"^DD",4.3,4.3,7,21,1,0)
If this is turned on, then users must introduce themselves when they
"^DD",4.3,4.3,7,21,2,0)
first log in to MailMan.  This forces users to describe themselves,
"^DD",4.3,4.3,7,21,3,0)
and enter their phone numbers and addresses for others to query with
"^DD",4.3,4.3,7,21,4,0)
the HELP options in MailMan.
"^DD",4.3,4.3,7,"DT")
2980123
"^DD",4.3,4.3,7.01,0)
FWD TEST MESSAGE TO POSTMASTER^S^1:NO;0:YES;^FORWARD;1^Q
"^DD",4.3,4.3,7.01,3)
Enter NO (or 1) to not send test messages about forwarding addresses to the Postmaster.
"^DD",4.3,4.3,7.01,21,0)
^^4^4^2931214^
"^DD",4.3,4.3,7.01,21,1,0)
Messages are sent automatically to a user's forwarding address if he
"^DD",4.3,4.3,7.01,21,2,0)
changes it.  If you want these messages to be sent to the Postmaster,
"^DD",4.3,4.3,7.01,21,3,0)
also, so that he is aware that the forwarding addresses are proper
"^DD",4.3,4.3,7.01,21,4,0)
mark this field with "YES".
"^DD",4.3,4.3,7.01,"DT")
2921228
"^DD",4.3,4.3,7.2,0)
BIG GROUP SIZE^NJ5,0^^0;7^K:+X'=X!(X>10000)!(X<50)!(X?.E1"."1N.N) X
"^DD",4.3,4.3,7.2,3)
Type a Number between 50 and 10000, 0 Decimal Digits
"^DD",4.3,4.3,7.2,21,0)
^^25^25^3020424^^^^
"^DD",4.3,4.3,7.2,21,1,0)
During message addressing, when a user addresses a message to a mail group
"^DD",4.3,4.3,7.2,21,2,0)
with a lot of members, it can seem to take forever to process the group.
"^DD",4.3,4.3,7.2,21,3,0)
(Dots of death!)  This field, BIG GROUP SIZE, can help.
"^DD",4.3,4.3,7.2,21,4,0)

"^DD",4.3,4.3,7.2,21,5,0)
IF you enter a number in this field, AND
"^DD",4.3,4.3,7.2,21,6,0)
    - If the group contains member groups
"^DD",4.3,4.3,7.2,21,7,0)
 or - If the group contains distribution lists
"^DD",4.3,4.3,7.2,21,8,0)
 or - If the number of local members plus the number of remote members
"^DD",4.3,4.3,7.2,21,9,0)
exceeds or equals the BIG GROUP SIZE boundary
"^DD",4.3,4.3,7.2,21,10,0)

"^DD",4.3,4.3,7.2,21,11,0)
THEN the user is asked whether s/he wants to queue the group for later
"^DD",4.3,4.3,7.2,21,12,0)
delivery, and avoid waiting while the group is processed.
"^DD",4.3,4.3,7.2,21,13,0)

"^DD",4.3,4.3,7.2,21,14,0)
The user is also warned that if s/he chooses to queue delivery, then
"^DD",4.3,4.3,7.2,21,15,0)
recipients may not be 'minus'ed from the group.
"^DD",4.3,4.3,7.2,21,16,0)

"^DD",4.3,4.3,7.2,21,17,0)
If the user chooses not to queue delivery, then processing proceeds in the
"^DD",4.3,4.3,7.2,21,18,0)
foreground, as usual.
"^DD",4.3,4.3,7.2,21,19,0)

"^DD",4.3,4.3,7.2,21,20,0)
If the user chooses to queue delivery, then s/he is asked when the delivery
"^DD",4.3,4.3,7.2,21,21,0)
should take place.  The group is then queued for processing and delivery
"^DD",4.3,4.3,7.2,21,22,0)
at the specified time (by the same background job which 'news' messages).
"^DD",4.3,4.3,7.2,21,23,0)

"^DD",4.3,4.3,7.2,21,24,0)
There is no default.  (If BIG GROUP SIZE equates to zero, then groups are
"^DD",4.3,4.3,7.2,21,25,0)
processed in the foreground as usual.)
"^DD",4.3,4.3,7.2,"DT")
3020424
"^DD",4.3,4.3,7.3,0)
SHOW DUZ WHEN ADDRESS MESSAGE^S^0:NO;1:YES;^0;8^Q
"^DD",4.3,4.3,7.3,21,0)
^^13^13^3020424^^
"^DD",4.3,4.3,7.3,21,1,0)
When someone addresses a message to a local user, should the DUZ of the
"^DD",4.3,4.3,7.3,21,2,0)
local user be displayed?
"^DD",4.3,4.3,7.3,21,3,0)

"^DD",4.3,4.3,7.3,21,4,0)
(If this field is null, the default answer is "no".)
"^DD",4.3,4.3,7.3,21,5,0)

"^DD",4.3,4.3,7.3,21,6,0)
Disadvantages:
"^DD",4.3,4.3,7.3,21,7,0)
 - Your site's DUZs may be SSNs.  They should not be displayed.
"^DD",4.3,4.3,7.3,21,8,0)
 - Users may be confused by the display.
"^DD",4.3,4.3,7.3,21,9,0)

"^DD",4.3,4.3,7.3,21,10,0)
Advantages:
"^DD",4.3,4.3,7.3,21,11,0)
 - A DUZ is unique, whereas some users may share the same or very similar
"^DD",4.3,4.3,7.3,21,12,0)
name.  If a user knows the addressee's DUZ, the DUZ may be used to
"^DD",4.3,4.3,7.3,21,13,0)
address a message, instead of the name.
"^DD",4.3,4.3,7.3,"DT")
3020424
"^DD",4.3,4.3,7.4,0)
SHOW ADDRESS ON USER LOOKUP^S^0:NO;1:YES;^0;10^Q
"^DD",4.3,4.3,7.4,3)
Should the user's address be displayed in a MailMan lookup?
"^DD",4.3,4.3,7.4,21,0)
^^8^8^2990511^
"^DD",4.3,4.3,7.4,21,1,0)
Option XMHELPUSER displays user information.  Among the items displayed
"^DD",4.3,4.3,7.4,21,2,0)
are the address fields (.111 through .116) from the NEW PERSON file.
"^DD",4.3,4.3,7.4,21,3,0)

"^DD",4.3,4.3,7.4,21,4,0)
Some sites have home address information in these fields, which should not
"^DD",4.3,4.3,7.4,21,5,0)
be displayed.
"^DD",4.3,4.3,7.4,21,6,0)

"^DD",4.3,4.3,7.4,21,7,0)
If the address fields should be displayed, answer YES; otherwise, answer
"^DD",4.3,4.3,7.4,21,8,0)
NO.  If this field is null, the default answer is NO.
"^DD",4.3,4.3,7.4,"DT")
2990511
"^DD",4.3,4.3,7.5,0)
CPU (UCI,VOL) FOR FILER TO RUN^F^^0;12^K:$L(X)>30!($L(X)<3) X
"^DD",4.3,4.3,7.5,3)
Answer must be 3-30 characters in length.
"^DD",4.3,4.3,7.5,10)

"^DD",4.3,4.3,7.5,21,0)
^^3^3^2980122^^^^
"^DD",4.3,4.3,7.5,21,1,0)
Enter the UCI,VOL of where you want the background filer routines to run.
"^DD",4.3,4.3,7.5,21,2,0)
It is recommended that the XMB global also reside in this location.
"^DD",4.3,4.3,7.5,21,3,0)
If you are unsure what to enter, leave this field blank.
"^DD",4.3,4.3,7.5,"DT")
2980122
"^DD",4.3,4.3,7.6,0)
FTP ADDRESS FOR BLOB <GET>^F^^FTP-GET;1^K:$L(X)>15!($L(X)<7)!'(X?1.N1"."1.N1"."1.N1"."1.N) X
"^DD",4.3,4.3,7.6,3)
Answer must be 7-15 characters in length.
"^DD",4.3,4.3,7.6,21,0)
^^5^5^2931214^
"^DD",4.3,4.3,7.6,21,1,0)
If your images are on a network that is available via FTP from your
"^DD",4.3,4.3,7.6,21,2,0)
main node and you have no other way of accessing those message to get
"^DD",4.3,4.3,7.6,21,3,0)
them onto you main node so that you can FTP them to other sites, put
"^DD",4.3,4.3,7.6,21,4,0)
the IP address of the machine that you will GET your images from
"^DD",4.3,4.3,7.6,21,5,0)
into this field.
"^DD",4.3,4.3,7.6,"DT")
2920331
"^DD",4.3,4.3,7.7,0)
FTP RECEIVE DIRECTORY^F^^DISK/VOL;1^K:$L(X)>90!($L(X)<3) X
"^DD",4.3,4.3,7.7,3)
Answer must be 3-90 characters in length.
"^DD",4.3,4.3,7.7,21,0)
^^7^7^2930521^^^^
"^DD",4.3,4.3,7.7,21,1,0)
This field is used to store the path for BLOBs to be received in.
"^DD",4.3,4.3,7.7,21,2,0)
It is communicated to the transmitter of messages containing BLOBS so
"^DD",4.3,4.3,7.7,21,3,0)
that they can be FTP'd to the correct directory once the disk has
"^DD",4.3,4.3,7.7,21,4,0)
been designated with field 7.711.
"^DD",4.3,4.3,7.7,21,5,0)
 
"^DD",4.3,4.3,7.7,21,6,0)
If the receiving system is a DOS system the disk portion of the path 
"^DD",4.3,4.3,7.7,21,7,0)
is in the field 'FTP RECEIVE DISK'.
"^DD",4.3,4.3,7.7,23,0)
^^1^1^2930521^^^^
"^DD",4.3,4.3,7.7,23,1,0)
 
"^DD",4.3,4.3,7.7,"DT")
2940225
"^DD",4.3,4.3,7.71,0)
FTP RECEIVE NETWORK LOCATION^F^^FTPNETLOC;1^K:$L(X)>30!($L(X)<3) X
"^DD",4.3,4.3,7.71,3)
Answer must be 3-30 characters in length.
"^DD",4.3,4.3,7.71,21,0)
^^4^4^2931017^^
"^DD",4.3,4.3,7.71,21,1,0)
This field should be the name of an entry in your 2005.2 file (Network
"^DD",4.3,4.3,7.71,21,2,0)
Location).  It maps where incoming BLOBs will be placed and is the
"^DD",4.3,4.3,7.71,21,3,0)
logical equivalent of field 7.7.
"^DD",4.3,4.3,7.71,21,4,0)
 
"^DD",4.3,4.3,7.71,23,0)
^^2^2^2931017^^
"^DD",4.3,4.3,7.71,23,1,0)
 
"^DD",4.3,4.3,7.71,23,2,0)
 
"^DD",4.3,4.3,7.71,"DT")
2930426
"^DD",4.3,4.3,7.711,0)
FTP RECEIVE DISK^F^^FTPRCVDISK;1^K:$L(X)>30!($L(X)<2) X
"^DD",4.3,4.3,7.711,3)
Answer must be 2-30 characters in length.
"^DD",4.3,4.3,7.711,21,0)
^^2^2^2930521^^
"^DD",4.3,4.3,7.711,21,1,0)
This field contains the name of the physical disk that the FTP Receive
"^DD",4.3,4.3,7.711,21,2,0)
Network Location is on if the receiving system is a DOS system.
"^DD",4.3,4.3,7.711,"DT")
2930426
"^DD",4.3,4.3,7.72,0)
FTP ADDRESS FOR BLOB RECEIVE^F^^FTP-RCV;1^K:$L(X)>30!($L(X)<7)!'(X?1.N1"."1.N1"."1.N1"."1.N) X
"^DD",4.3,4.3,7.72,3)
Answer must be 7-30 characters in length.
"^DD",4.3,4.3,7.72,21,0)
^^2^2^2931214^
"^DD",4.3,4.3,7.72,21,1,0)
This is the IP address that you will advertise to other sites that wish
"^DD",4.3,4.3,7.72,21,2,0)
to send you images that attach to multimedia messages.
"^DD",4.3,4.3,7.72,"DT")
2930308
"^DD",4.3,4.3,7.73,0)
FTP USERNAME^F^^FTPUSER;1^K:$L(X)>30!($L(X)<3) X
"^DD",4.3,4.3,7.73,3)
Answer must be 3-30 characters in length.
"^DD",4.3,4.3,7.73,21,0)
^^2^2^2930423^
"^DD",4.3,4.3,7.73,21,1,0)
This is the VMS username that the sender will be told to use when he
"^DD",4.3,4.3,7.73,21,2,0)
FTP's BLOBs to this domain.
"^DD",4.3,4.3,7.73,"DT")
2930423
"^DD",4.3,4.3,7.731,0)
FTP PASSWORD^F^^FTPPWD;1^K:$L(X)>30!($L(X)<3) X
"^DD",4.3,4.3,7.731,3)
Answer must be 3-30 characters in length.
"^DD",4.3,4.3,7.731,21,0)
^^2^2^2930423^
"^DD",4.3,4.3,7.731,21,1,0)
This is the password if any that a BLOB sender needs to have when he FTPs
"^DD",4.3,4.3,7.731,21,2,0)
into the system.
"^DD",4.3,4.3,7.731,"DT")
2930423
"^DD",4.3,4.3,7.7999,0)
FTP NOTES^4.37^^FTP-NOTES;0
"^DD",4.3,4.3,7.7999,21,0)
^^2^2^2980122^^^
"^DD",4.3,4.3,7.7999,21,1,0)
This field holds site specific notes for this site on FTP operations.
"^DD",4.3,4.3,7.7999,21,2,0)
It is not used by MailMan.
"^DD",4.3,4.3,8.11,0)
LPC CHECKSUM^K^^LPC;E1,245^K:$L(X)>245 X D:$D(X) ^DIM
"^DD",4.3,4.3,8.11,3)
This is Standard MUMPS code used by network mail to calculate checksums.
"^DD",4.3,4.3,8.11,9)
@
"^DD",4.3,4.3,8.11,21,0)
^^8^8^2890310^
"^DD",4.3,4.3,8.11,21,1,0)
The code in this field will be obsolete after installation of KERNEL 6,
"^DD",4.3,4.3,8.11,21,2,0)
if the "LPC" node in ^%ZOSF [^%ZOSF("LPC")] is defined.  This field is
"^DD",4.3,4.3,8.11,21,3,0)
inserted by the MailMan POST-init if the ^%ZOSF("OS") is defined, contains
"^DD",4.3,4.3,8.11,21,4,0)
"DSM" and does not contain "VAX".  This is because of a situation that 
"^DD",4.3,4.3,8.11,21,5,0)
exists where DSM for PDP-aa series used to use on $ZCALL anbd in the updated
"^DD",4.3,4.3,8.11,21,6,0)
version uses a slightly different one.  Both do not exist in one system.
"^DD",4.3,4.3,8.11,21,7,0)
The way it is inserted is by setting an error trap and then trying one.
"^DD",4.3,4.3,8.11,21,8,0)
If it doesn't work, it must be the onther.
"^DD",4.3,4.3,8.11,"DT")
2890310
"^DD",4.3,4.3,8.12,0)
TCP CHANNEL - MAXIMUM TO USE^NJ3,0^^0;17^K:+X'=X!(X>999)!(X<0)!(X?.E1"."1N.N) X
"^DD",4.3,4.3,8.12,3)
Type a Number between 0 and 999, 0 Decimal Digits
"^DD",4.3,4.3,8.12,21,0)
^^3^3^2930223^
"^DD",4.3,4.3,8.12,21,1,0)
This field contains a value that is checked before starting a process
"^DD",4.3,4.3,8.12,21,2,0)
to transmit mail via a TCP/IP channel.  If there are already as many
"^DD",4.3,4.3,8.12,21,3,0)
processes running as is in this field, no process is started.
"^DD",4.3,4.3,8.12,"DT")
2920926
"^DD",4.3,4.3,8.13,0)
STATS NORMALIZATION^F^^7;1^K:$L(X)>99!($L(X)<1) X
"^DD",4.3,4.3,8.13,3)
Answer must be 1-99 characters in length.
"^DD",4.3,4.3,8.13,21,0)
^^1^1^2920926^
"^DD",4.3,4.3,8.13,21,1,0)
This option allows the user to customize the normalized report.
"^DD",4.3,4.3,8.13,"DT")
2980123
"^DD",4.3,4.3,8.14,0)
LARGE MESSAGE REPORT LINES^NJ6,0^^XMUT2-LINES;1^K:+X'=X!(X>999999)!(X<1)!(X?.E1"."1N.N) X
"^DD",4.3,4.3,8.14,3)
Type a Number between 1 and 999999, 0 Decimal Digits
"^DD",4.3,4.3,8.14,21,0)
^^3^3^2980123^^^^
"^DD",4.3,4.3,8.14,21,1,0)
This field is used by the large message report.
"^DD",4.3,4.3,8.14,21,2,0)
Any message with more than this many lines is included in the report.
"^DD",4.3,4.3,8.14,21,3,0)
If this field is null, the default is 100.
"^DD",4.3,4.3,8.14,"DT")
2980123
"^DD",4.3,4.3,8.15,0)
TCP/IP POLLER RUN FLAG^S^1:STOP RUNNING;0:OKAY TO RUN;^0;18^Q
"^DD",4.3,4.3,8.15,21,0)
^^6^6^2950626^^
"^DD",4.3,4.3,8.15,21,1,0)
This field is checked every time the background tcp poller, XMRTCP,
"^DD",4.3,4.3,8.15,21,2,0)
starts to process poller request.  If it is set to 1, XMRTCP stops
"^DD",4.3,4.3,8.15,21,3,0)
running. If it is null or zero, XMRTCP processes the next entry.  If
"^DD",4.3,4.3,8.15,21,4,0)
XMRTCP is not running it will not be restarted if the field is set to 1.
"^DD",4.3,4.3,8.15,21,5,0)
If it is null or 0, and XMRTCP is not running, a background task will be
"^DD",4.3,4.3,8.15,21,6,0)
created to restart it.
"^DD",4.3,4.3,8.15,"DT")
2950626
"^DD",4.3,4.3,8.2,0)
RECORD NETMAIL TRANSCRIPT?^S^1:YES;0:NO;^0;14^Q
"^DD",4.3,4.3,8.2,21,0)
^^3^3^2930211^^^^
"^DD",4.3,4.3,8.2,21,1,0)
This field allows the site manager to turn on and off (toggle) whether or
"^DD",4.3,4.3,8.2,21,2,0)
not MailMan records all script transcripts in background.  The send portion
"^DD",4.3,4.3,8.2,21,3,0)
of scripts played (using the 'Play Script' option) will not be recorded.
"^DD",4.3,4.3,8.2,"DT")
2900627
"^DD",4.3,4.3,8.21,0)
XMITS TILL ERROR MESSAGE^NJ3,0^^NETWORK;1^K:+X'=X!(X>999)!(X<5)!(X?.E1"."1N.N) X
"^DD",4.3,4.3,8.21,3)
Type a Number between 5 and 999, 0 Decimal Digits
"^DD",4.3,4.3,8.21,21,0)
^^3^3^2931214^
"^DD",4.3,4.3,8.21,21,1,0)
How many times will a transmission be attempted before a message is
"^DD",4.3,4.3,8.21,21,2,0)
sent to the Postmaster indicating that there have been multiple,
"^DD",4.3,4.3,8.21,21,3,0)
unsuccessful transmissions to a domain.
"^DD",4.3,4.3,8.21,"DT")
2930211
"^DD",4.3,4.3,8.22,0)
DNS AWARE^S^0:NO;1:YES;^NETWORK;2^Q
"^DD",4.3,4.3,8.22,3)
Should MailMan use DNS to look up IP addresses?
"^DD",4.3,4.3,8.22,21,0)
^^12^12^3020422^^^
"^DD",4.3,4.3,8.22,21,1,0)
In order for MailMan to be DNS aware, the site must have installed the
"^DD",4.3,4.3,8.22,21,2,0)
requisite Kernel patches for DNS.
"^DD",4.3,4.3,8.22,21,3,0)
 - DNS IP (field 51 in file 8989.3) must contain an IP address
"^DD",4.3,4.3,8.22,21,4,0)
for a DNS server.
"^DD",4.3,4.3,8.22,21,5,0)
 - Routine ^XLFNSLK must exist.
"^DD",4.3,4.3,8.22,21,6,0)

"^DD",4.3,4.3,8.22,21,7,0)
If you answer 'no', MailMan will use the IP addresses in the domain scripts.
"^DD",4.3,4.3,8.22,21,8,0)

"^DD",4.3,4.3,8.22,21,9,0)
If you answer 'yes', MailMan will use the IP addresses in the domain
"^DD",4.3,4.3,8.22,21,10,0)
scripts, but if they fail, or don't exist, MailMan will use DNS to ascertain
"^DD",4.3,4.3,8.22,21,11,0)
other IP addresses to try.  MailMan will replace failed script IP address
"^DD",4.3,4.3,8.22,21,12,0)
with the successful DNS IP address.
"^DD",4.3,4.3,8.22,"DT")
3020422
"^DD",4.3,4.3,8.23,0)
TCP/IP COMMUNICATIONS PROTOCOL^P3.4'^DIC(3.4,^NETWORK;3^Q
"^DD",4.3,4.3,8.23,3)
Which protocol shall be used for TCP/IP?
"^DD",4.3,4.3,8.23,21,0)
^.001^18^18^3020612^^^^
"^DD",4.3,4.3,8.23,21,1,0)
For TCP/IP connections, the scripts (the TEXT field, 2, in the TRANSMISSION
"^DD",4.3,4.3,8.23,21,2,0)
SCRIPT multiple, 4, of the DOMAIN file, 4.2) can be built on-the-fly, if
"^DD",4.3,4.3,8.23,21,3,0)
they don't exist, and if both this field and field 8.24 are filled in.
"^DD",4.3,4.3,8.23,21,4,0)

"^DD",4.3,4.3,8.23,21,5,0)
We identify the TCP/IP transmission scripts in file 4.2 by the TYPE field,
"^DD",4.3,4.3,8.23,21,6,0)
1.2, within the TRANSMISSION SCRIPT multiple.  Those whose TYPE is 'SMTP',
"^DD",4.3,4.3,8.23,21,7,0)
'TCPCHAN', or null are considered TCP/IP transmission scripts.
"^DD",4.3,4.3,8.23,21,8,0)

"^DD",4.3,4.3,8.23,21,9,0)
We can build the scripts, because they are standard.
"^DD",4.3,4.3,8.23,21,10,0)

"^DD",4.3,4.3,8.23,21,11,0)
Here's an example of one for FORUM:
"^DD",4.3,4.3,8.23,21,12,0)

"^DD",4.3,4.3,8.23,21,13,0)
O H=FORUM.VA.GOV,P=TCP/IP-MAILMAN
"^DD",4.3,4.3,8.23,21,14,0)
C TCPCHAN-SOCKET25
"^DD",4.3,4.3,8.23,21,15,0)

"^DD",4.3,4.3,8.23,21,16,0)
In this script, the TCP/IP-MAILMAN refers to the communications protocol
"^DD",4.3,4.3,8.23,21,17,0)
to use.  This field should point to the communications protocol in file 3.4
"^DD",4.3,4.3,8.23,21,18,0)
that should be used for TCP/IP connections.
"^DD",4.3,4.3,8.23,"DT")
3020612
"^DD",4.3,4.3,8.24,0)
TCP/IP TRANSMISSION SCRIPT^P4.6'^XMB(4.6,^NETWORK;4^Q
"^DD",4.3,4.3,8.24,3)
Which script shall be used for TCP/IP?
"^DD",4.3,4.3,8.24,21,0)
^^18^18^3020612^^^^
"^DD",4.3,4.3,8.24,21,1,0)
For TCP/IP connections, the scripts (the TEXT field, 2, in the TRANSMISSION
"^DD",4.3,4.3,8.24,21,2,0)
SCRIPT multiple, 4, of the DOMAIN file, 4.2) can be built on-the-fly, if
"^DD",4.3,4.3,8.24,21,3,0)
they don't exist, and if both this field and field 8.23 are filled in.
"^DD",4.3,4.3,8.24,21,4,0)

"^DD",4.3,4.3,8.24,21,5,0)
We identify the TCP/IP transmission scripts in file 4.2 by the TYPE field,
"^DD",4.3,4.3,8.24,21,6,0)
1.2, within the TRANSMISSION SCRIPT multiple.  Those whose TYPE is 'SMTP',
"^DD",4.3,4.3,8.24,21,7,0)
'TCPCHAN', or null are considered TCP/IP transmission scripts.
"^DD",4.3,4.3,8.24,21,8,0)

"^DD",4.3,4.3,8.24,21,9,0)
We can build the scripts, because they are standard.
"^DD",4.3,4.3,8.24,21,10,0)

"^DD",4.3,4.3,8.24,21,11,0)
Here's an example of one for FORUM:
"^DD",4.3,4.3,8.24,21,12,0)

"^DD",4.3,4.3,8.24,21,13,0)
 O H=FORUM.VA.GOV,P=TCP/IP-MAILMAN
"^DD",4.3,4.3,8.24,21,14,0)
 C TCPCHAN-SOCKET25
"^DD",4.3,4.3,8.24,21,15,0)

"^DD",4.3,4.3,8.24,21,16,0)
In this script, the TCPCHAN-SOCKET25 refers to the transmission script
"^DD",4.3,4.3,8.24,21,17,0)
to use.  This field should point to the transmission script in file 4.6
"^DD",4.3,4.3,8.24,21,18,0)
that should be used for TCP/IP connections.
"^DD",4.3,4.3,8.24,"DT")
3020612
"^DD",4.3,4.3,8.3,0)
NETWORK - MAX LINES SEND^NJ5,0^^NETWORK-LIMIT;1^K:+X'=X!(X>15000)!(X<2000)!(X?.E1"."1N.N) X
"^DD",4.3,4.3,8.3,3)
Type a Number between 2000 and 15000, 0 Decimal Digits
"^DD",4.3,4.3,8.3,21,0)
^^4^4^2980122^^
"^DD",4.3,4.3,8.3,21,1,0)
This field enables site management to limit the number of lines which
"^DD",4.3,4.3,8.3,21,2,0)
a message may have when it is addressed to a remote recipient.  A user
"^DD",4.3,4.3,8.3,21,3,0)
may not send a message across the network with more than this number of
"^DD",4.3,4.3,8.3,21,4,0)
lines.  If this field is null, there is no limit.
"^DD",4.3,4.3,8.3,"DT")
2980122
"^DD",4.3,4.3,8.31,0)
NETWORK - MAX LINES RECEIVE^NJ8,0^^NETWORK-LIMIT;2^K:+X'=X!(X>99999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",4.3,4.3,8.31,3)
Type a Number between 0 and 99999999, 0 Decimal Digits
"^DD",4.3,4.3,8.31,21,0)
^^6^6^3020422^^^
"^DD",4.3,4.3,8.31,21,1,0)
This field enables site management to limit the number of lines which
"^DD",4.3,4.3,8.31,21,2,0)
a message may have when it is received from a remote site.  Any message
"^DD",4.3,4.3,8.31,21,3,0)
received from a remote site which has more lines than this number is
"^DD",4.3,4.3,8.31,21,4,0)
automatically rejected.  If this field is null, there is no limit.
"^DD",4.3,4.3,8.31,21,5,0)

"^DD",4.3,4.3,8.31,21,6,0)
KIDS and PackMan messages are not affected by this limit.
"^DD",4.3,4.3,8.31,"DT")
3020422
"^DD",4.3,4.3,8.32,0)
NETWORK - BLOCK SIZE RECEIVE^S^A:255;B:512;^NETWORK-LIMIT;3^Q
"^DD",4.3,4.3,8.32,3)
Select the block size for incoming transmissions.
"^DD",4.3,4.3,8.32,21,0)
^.001^14^14^3020422^^^^
"^DD",4.3,4.3,8.32,21,1,0)
*** This field is reserved for future use.  Not currently used. ***
"^DD",4.3,4.3,8.32,21,2,0)

"^DD",4.3,4.3,8.32,21,3,0)
This is the maximum number of characters to read at a time when
"^DD",4.3,4.3,8.32,21,4,0)
receiving incoming transmissions.  Default is 255.
"^DD",4.3,4.3,8.32,21,5,0)
 
"^DD",4.3,4.3,8.32,21,6,0)
Limiting factors are:
"^DD",4.3,4.3,8.32,21,7,0)
 - Maximum string length on the system.
"^DD",4.3,4.3,8.32,21,8,0)
 - Maximum global length on the system.  In particular, maximum
"^DD",4.3,4.3,8.32,21,9,0)
(desirable) length of a line of message text in the MESSAGE file:
"^DD",4.3,4.3,8.32,21,10,0)
   S ^XMB(3.9,xmz,2,x,0)=<line of message text>
"^DD",4.3,4.3,8.32,21,11,0)

"^DD",4.3,4.3,8.32,21,12,0)
You may also wish to consider the maximum string length that the
"^DD",4.3,4.3,8.32,21,13,0)
system's various editors can handle.  See the Technical Description
"^DD",4.3,4.3,8.32,21,14,0)
for more information.
"^DD",4.3,4.3,8.32,23,0)
^.001^26^26^3010315^^^
"^DD",4.3,4.3,8.32,23,1,0)
Why would you want to set the block size higher than 255, which has
"^DD",4.3,4.3,8.32,23,2,0)
been the historical setting?  Just how long a line do you need for the
"^DD",4.3,4.3,8.32,23,3,0)
text in a message?  Well, for user-to-user communication, 255 is more
"^DD",4.3,4.3,8.32,23,4,0)
than enough.  But for application-to-application communication, 255
"^DD",4.3,4.3,8.32,23,5,0)
may not be enough.  512 may be.  So, if your system can handle globals
"^DD",4.3,4.3,8.32,23,6,0)
with 512 characters, setting this field to 512 is recommended.
"^DD",4.3,4.3,8.32,23,7,0)
  
"^DD",4.3,4.3,8.32,23,8,0)
How can you tell how long a string a global can be set to?  Do this at
"^DD",4.3,4.3,8.32,23,9,0)
the programmer prompt:
"^DD",4.3,4.3,8.32,23,10,0)
 
"^DD",4.3,4.3,8.32,23,11,0)
 > S ^TMP("XM",$J)="" F I=1:1 S ^TMP("XM",$J)=^TMP("XM",$J)_"X"
"^DD",4.3,4.3,8.32,23,12,0)
 > W $L(^TMP("XM",$J)) <--- This is your answer
"^DD",4.3,4.3,8.32,23,13,0)
 > K ^TMP("XM",$J)
"^DD",4.3,4.3,8.32,23,14,0)
 
"^DD",4.3,4.3,8.32,23,15,0)
Yes, some systems can handle way more than 512, but we need to limit
"^DD",4.3,4.3,8.32,23,16,0)
the maximum, so that if we need to port data from one system to
"^DD",4.3,4.3,8.32,23,17,0)
another, any system can handle data from any other system.
"^DD",4.3,4.3,8.32,23,18,0)
 
"^DD",4.3,4.3,8.32,23,19,0)
There is one caution.  It's a small one, but you should be aware of
"^DD",4.3,4.3,8.32,23,20,0)
it.  Your system's text editors, which are used to edit message text
"^DD",4.3,4.3,8.32,23,21,0)
in MailMan messages, may not be able to handle line lengths of more
"^DD",4.3,4.3,8.32,23,22,0)
than 245 or 255.  When does this become a problem?  Only if you attempt
"^DD",4.3,4.3,8.32,23,23,0)
to copy and edit messages which have such lengthy lines.  Such lines
"^DD",4.3,4.3,8.32,23,24,0)
may be truncated by the editors.  This is not really much of a problem,
"^DD",4.3,4.3,8.32,23,25,0)
because you probably won't be copying and editing such messages, since
"^DD",4.3,4.3,8.32,23,26,0)
they would most likely contain application-to-application communication.
"^DD",4.3,4.3,8.32,"DT")
3020422
"^DD",4.3,4.3,8.4,0)
DIRECTORY REQUEST FLAG^S^0:Requests will NOT be granted.;1:Requests will be granted.;^8.4;1^Q
"^DD",4.3,4.3,8.4,3)
Enter 0 to stop all requests for the local directory from being granted.
"^DD",4.3,4.3,8.4,21,0)
^^6^6^2940417^^^
"^DD",4.3,4.3,8.4,21,1,0)
This field controls whether or not the XMMGR-DIRECTORY-RECV option will
"^DD",4.3,4.3,8.4,21,2,0)
grant request from remote site to send domain user directory information.
"^DD",4.3,4.3,8.4,21,3,0)
 
"^DD",4.3,4.3,8.4,21,4,0)
If the value is null or zero, request is rejected.  If the value is
"^DD",4.3,4.3,8.4,21,5,0)
one, a request is granted and domain user directory will
"^DD",4.3,4.3,8.4,21,6,0)
be made available to the remote site.
"^DD",4.3,4.3,8.4,"DT")
2940417
"^DD",4.3,4.3,10,0)
IN-BASKET-PURGE DAYS^NJ3,0^^0;9^K:+X'=X!(X>999)!(X<30)!(X?.E1"."1N.N) X
"^DD",4.3,4.3,10,3)
Type a Number between 30 and 999, 0 Decimal Digits
"^DD",4.3,4.3,10,21,0)
^^10^10^2970723^^^^
"^DD",4.3,4.3,10,21,1,0)
This field is used by the IN BASKET PURGE to identify inactive messages and
"^DD",4.3,4.3,10,21,2,0)
mark them for purging.
"^DD",4.3,4.3,10,21,3,0)

"^DD",4.3,4.3,10,21,4,0)
A message is considered inactive if it has not been accessed in the past
"^DD",4.3,4.3,10,21,5,0)
number of days specified here.  The default is 30 days.
"^DD",4.3,4.3,10,21,6,0)

"^DD",4.3,4.3,10,21,7,0)
The IN BASKET PURGE sends a message to each user listing all messages which
"^DD",4.3,4.3,10,21,8,0)
it has marked for purging and stating that they will be purged in an
"^DD",4.3,4.3,10,21,9,0)
additional 30 days if they remain in the 'IN' basket and are not accessed
"^DD",4.3,4.3,10,21,10,0)
again.
"^DD",4.3,4.3,10,"DT")
2980123
"^DD",4.3,4.3,10.01,0)
IN-BASKET-PURGE TYPE^S^0:IN BASKET ONLY;1:ALL BASKETS;^.15;1^Q
"^DD",4.3,4.3,10.01,3)
Enter 0 for IN Basket, 1 for **All** baskets or ? for more information.
"^DD",4.3,4.3,10.01,4)

"^DD",4.3,4.3,10.01,21,0)
^^16^16^3020422^^^^
"^DD",4.3,4.3,10.01,21,1,0)
This field controls the extent of the IN-BASKET-PURGE.
"^DD",4.3,4.3,10.01,21,2,0)
If is is not filled in the effect on the IN-BASKET-PURGE
"^DD",4.3,4.3,10.01,21,3,0)
is the same as it would be if the value of the field is zero.
"^DD",4.3,4.3,10.01,21,4,0)
 
"^DD",4.3,4.3,10.01,21,5,0)
The field can have the following values:
"^DD",4.3,4.3,10.01,21,6,0)
 
"^DD",4.3,4.3,10.01,21,7,0)
 0 or null = The IN-BASKET-PURGE will affect user IN baskets only.
"^DD",4.3,4.3,10.01,21,8,0)
 1 = The IN-BASKET-PURGE will affect all user baskets.  (This is not
"^DD",4.3,4.3,10.01,21,9,0)
the normal way for this process to be run.  It is recommended that you
"^DD",4.3,4.3,10.01,21,10,0)
discuss this with site management and get user input before doing this.)
"^DD",4.3,4.3,10.01,21,11,0)
 
"^DD",4.3,4.3,10.01,21,12,0)
In either case the users will be sent the now familiar message listing
"^DD",4.3,4.3,10.01,21,13,0)
the messages that will be deleted from their baskets in 30 days.  In
"^DD",4.3,4.3,10.01,21,14,0)
either case the field 'IN-BASKET-PURGE DAYS' will control how long a
"^DD",4.3,4.3,10.01,21,15,0)
message can remain inactive in a basket before it is considered okay
"^DD",4.3,4.3,10.01,21,16,0)
to put on the list of messages to be considered for deletion.
"^DD",4.3,4.3,10.01,"DT")
3020422
"^DD",4.3,4.3,10.03,0)
DATE PURGE CUTOFF DAYS^NJ4,0^^.18;1^K:+X'=X!(X>9999)!(X<365)!(X?.E1"."1N.N) X
"^DD",4.3,4.3,10.03,3)
Type a Number between 365 and 9999, 0 Decimal Digits
"^DD",4.3,4.3,10.03,21,0)
^.001^5^5^3001120^^
"^DD",4.3,4.3,10.03,21,1,0)
This field is used by the option XMPURGE-BY-DATE.  When this option
"^DD",4.3,4.3,10.03,21,2,0)
is run, the date purge will be set to purge all messages originating
"^DD",4.3,4.3,10.03,21,3,0)
this many days ago and before.
"^DD",4.3,4.3,10.03,21,4,0)
 
"^DD",4.3,4.3,10.03,21,5,0)
If this field is null, the default will be 730 days (2 years).
"^DD",4.3,4.3,10.03,"DT")
3001117
"^DD",4.3,4.3,10.04,0)
DATE PURGE GRACE PERIOD^NJ2,0^^.18;2^K:+X'=X!(X>31)!(X<3)!(X?.E1"."1N.N) X
"^DD",4.3,4.3,10.04,3)
Type a Number between 3 and 31, 0 Decimal Digits
"^DD",4.3,4.3,10.04,21,0)
^.001^13^13^3001120^^^
"^DD",4.3,4.3,10.04,21,1,0)
This is the number of days' warning the users get before the date
"^DD",4.3,4.3,10.04,21,2,0)
purge, XMPURGE-BY-DATE, is run.
"^DD",4.3,4.3,10.04,21,3,0)
 
"^DD",4.3,4.3,10.04,21,4,0)
This field is used by the option XMPURGE-BY-DATE only if that
"^DD",4.3,4.3,10.04,21,5,0)
option is scheduled, not if it is run interactively.
"^DD",4.3,4.3,10.04,21,6,0)
 
"^DD",4.3,4.3,10.04,21,7,0)
At the scheduled date/time, the bulletin, XM DATE PURGE WARNING,
"^DD",4.3,4.3,10.04,21,8,0)
is broadcast to all users to warn them of the coming date purge,
"^DD",4.3,4.3,10.04,21,9,0)
and the actual date purge is then queued to run this many days
"^DD",4.3,4.3,10.04,21,10,0)
later.
"^DD",4.3,4.3,10.04,21,11,0)
 
"^DD",4.3,4.3,10.04,21,12,0)
If this field is null, the date purge will run at the scheduled
"^DD",4.3,4.3,10.04,21,13,0)
date/time, and no bulletin will be sent.
"^DD",4.3,4.3,10.04,"DT")
3001117
"^DD",4.3,4.3,10.1,0)
BACKGROUND FILER HANG TIME^NJ2,0^^0;13^K:+X'=X!(X>99)!(X<0)!(X?.E1"."1N.N) X
"^DD",4.3,4.3,10.1,3)
Background filer hangs up to 99 seconds between mail deliveries (default=5).
"^DD",4.3,4.3,10.1,21,0)
^^6^6^2980427^^
"^DD",4.3,4.3,10.1,21,1,0)
This field is used by the background filer when it is started up to determine
"^DD",4.3,4.3,10.1,21,2,0)
the amount of time it will hang between deliveries of messages.  Since mail
"^DD",4.3,4.3,10.1,21,3,0)
is not delivered, even to the sender, unless the backgournd filer delivers
"^DD",4.3,4.3,10.1,21,4,0)
it, it should not be too long a period so that your users are inconvenienced.
"^DD",4.3,4.3,10.1,21,5,0)
If this field is not filled in the background filer will hang for 5 seconds
"^DD",4.3,4.3,10.1,21,6,0)
between deliveries.  5 to 15 seconds is the recommended range.
"^DD",4.3,4.3,10.1,"DT")
2881115
"^DD",4.3,4.3,10.2,0)
BACKGROUND FILER RUN FLAG^S^1:STOP RUNNING;0:OKAY TO RUN;^0;16^Q
"^DD",4.3,4.3,10.2,9)
@
"^DD",4.3,4.3,10.2,21,0)
^^5^5^2980122^^^^
"^DD",4.3,4.3,10.2,21,1,0)
The background filer checks this field every time it is about to
"^DD",4.3,4.3,10.2,21,2,0)
deliver a message or response.  If it is set to 1, it stops running, and
"^DD",4.3,4.3,10.2,21,3,0)
will not restart until it is set to null or zero.  If it is null or zero,
"^DD",4.3,4.3,10.2,21,4,0)
and is already running, it continues.  If it is null or zero, and is not
"^DD",4.3,4.3,10.2,21,5,0)
running, a background task will be created to restart it.
"^DD",4.3,4.3,10.2,22)
P
"^DD",4.3,4.3,10.2,"DT")
2920123
"^DD",4.3,4.3,10.3,0)
BACKGROUND FILER RUN PRIORITY^NJ2,0^^.13;1^K:+X'=X!(X>10)!(X<0)!(X?.E1"."1N.N) X
"^DD",4.3,4.3,10.3,3)
Type a Number between 0 and 10, 0 Decimal Digits
"^DD",4.3,4.3,10.3,21,0)
^^1^1^2980122^^
"^DD",4.3,4.3,10.3,21,1,0)
This field is used by the background filer to set its priority at runtime.
"^DD",4.3,4.3,10.3,"DT")
2921112
"^DD",4.3,4.3,16.1,0)
P-MESSAGE LINE LIMIT^NJ7,0^^.16;1^K:+X'=X!(X>9999999)!(X<2000)!(X?.E1"."1N.N) X
"^DD",4.3,4.3,16.1,3)
Type a Number between 2000 and 9999999, 0 Decimal Digits
"^DD",4.3,4.3,16.1,21,0)
^^2^2^2980408^
"^DD",4.3,4.3,16.1,21,1,0)
This field enables site management to limit the number of lines which may
"^DD",4.3,4.3,16.1,21,2,0)
be printed to P-MESSAGE.  If this field is null, there is no limit.
"^DD",4.3,4.3,16.1,"DT")
2980408
"^DD",4.3,4.3,17.1,0)
MAX DIGITS FOR MESSAGE NUMBER^NJ2,0^^.17;1^K:+X'=X!(X>14)!(X<7)!(X?.E1"."1N.N) X
"^DD",4.3,4.3,17.1,3)
Type a Number between 7 and 14, 0 Decimal Digits
"^DD",4.3,4.3,17.1,21,0)
^^17^17^2980917^^^
"^DD",4.3,4.3,17.1,21,1,0)
This field is used to control the size of the message number in
"^DD",4.3,4.3,17.1,21,2,0)
^XMB(3.9, the MESSAGE file.  If this field is null, its default 
"^DD",4.3,4.3,17.1,21,3,0)
will be 8 digits.  If the message number becomes greater
"^DD",4.3,4.3,17.1,21,4,0)
than this many digits, the message numbers will recycle back to
"^DD",4.3,4.3,17.1,21,5,0)
the next vacant message number after 999999.  In this way, message
"^DD",4.3,4.3,17.1,21,6,0)
numbers will cease being too ungainly in size.
"^DD",4.3,4.3,17.1,21,7,0)

"^DD",4.3,4.3,17.1,21,8,0)
So message numbers will be re-used.
"^DD",4.3,4.3,17.1,21,9,0)

"^DD",4.3,4.3,17.1,21,10,0)
If MailMan is not able to find a vacant message number less than
"^DD",4.3,4.3,17.1,21,11,0)
this number of digits, then MailMan will take the next available
"^DD",4.3,4.3,17.1,21,12,0)
message number, no matter how many digits it has, AND MailMan will
"^DD",4.3,4.3,17.1,21,13,0)
change this field to reflect the new maximum.
"^DD",4.3,4.3,17.1,21,14,0)

"^DD",4.3,4.3,17.1,21,15,0)
It is very important that the unreferenced messages purge and/or
"^DD",4.3,4.3,17.1,21,16,0)
the date purge be run on a regular basis to free up message numbers
"^DD",4.3,4.3,17.1,21,17,0)
for re-use.
"^DD",4.3,4.3,17.1,"DT")
2980917
"^DD",4.3,4.3,21,0)
FORWARD PRIORITY MAIL TO GROUP^S^0:NO;1:YES;^2;1^Q
"^DD",4.3,4.3,21,3)
Let users forward priority messages to mail groups?
"^DD",4.3,4.3,21,21,0)
^.001^6^6^3000606^^^
"^DD",4.3,4.3,21,21,1,0)
Enter YES if you wish to allow users to forward priority messages
"^DD",4.3,4.3,21,21,2,0)
to mail groups.
"^DD",4.3,4.3,21,21,3,0)
 
"^DD",4.3,4.3,21,21,4,0)
Enter NO if you don't.  (This is the default, if this field is null.)
"^DD",4.3,4.3,21,21,5,0)
Then only the message originator or anyone with the XM GROUP PRIORITY
"^DD",4.3,4.3,21,21,6,0)
key may forward priority messages to mail groups.
"^DD",4.3,4.3,21,23,0)
^.001^9^9^3000606^^
"^DD",4.3,4.3,21,23,1,0)
The issue here is one of annoyance.  Priority messages can be annoying.
"^DD",4.3,4.3,21,23,2,0)
When priority messages are inappropriately forwarded to mail groups,
"^DD",4.3,4.3,21,23,3,0)
the annoyance quotient rises dramatically.  If you wish to have MailMan
"^DD",4.3,4.3,21,23,4,0)
be the enforcer, then set this field to NO.  (Then only a select few
"^DD",4.3,4.3,21,23,5,0)
users will be able to forward priority messages to mail groups.)
"^DD",4.3,4.3,21,23,6,0)
If you wish to have the user's peers be the enforcers, then set this
"^DD",4.3,4.3,21,23,7,0)
field to YES.  (Then anyone can forward priority messages to mail groups,
"^DD",4.3,4.3,21,23,8,0)
and users who inappropriately do so, risk the wrath and flames of the
"^DD",4.3,4.3,21,23,9,0)
annoyed recipients.)
"^DD",4.3,4.3,21,"DT")
3000525
"^DD",4.3,4.3,22,0)
DROP OUT OF RESTRICTED GROUP^S^0:NO;1:YES;^2;2^Q
"^DD",4.3,4.3,22,3)
Let users drop out of non-self-enrolling mail groups?
"^DD",4.3,4.3,22,21,0)
^.001^8^8^3000606^^^^
"^DD",4.3,4.3,22,21,1,0)
Enter YES if you wish to allow users to drop out of non-self-enrolling
"^DD",4.3,4.3,22,21,2,0)
mail groups.  The user will be warned that this is a non-self-enrolling
"^DD",4.3,4.3,22,21,3,0)
group, and that they won't be allowed to rejoin later, and then they
"^DD",4.3,4.3,22,21,4,0)
will be asked to re-confirm the decision to drop out.
"^DD",4.3,4.3,22,21,5,0)
 
"^DD",4.3,4.3,22,21,6,0)
Enter NO if you don't.  (This is the default if this field is null.)
"^DD",4.3,4.3,22,21,7,0)
Then users will have to contact IRM or the mail group coordinator to
"^DD",4.3,4.3,22,21,8,0)
ask to be dropped.
"^DD",4.3,4.3,22,23,0)
^.001^16^16^3000606^^^
"^DD",4.3,4.3,22,23,1,0)
If a mail group is not a self-enrolling mail group, then users can't just
"^DD",4.3,4.3,22,23,2,0)
join.  They must be added by the mail group coordinator.
"^DD",4.3,4.3,22,23,3,0)
 
"^DD",4.3,4.3,22,23,4,0)
If a user no longer wishes to be a member of such a group, he must ask the
"^DD",4.3,4.3,22,23,5,0)
group coordinator to drop him.  But what if the group coordinator has left
"^DD",4.3,4.3,22,23,6,0)
the organization or is unresponsive?  Then what?  Then the user will have
"^DD",4.3,4.3,22,23,7,0)
to ask IRM to help.  This problem can be avoided by setting this field to
"^DD",4.3,4.3,22,23,8,0)
YES.
"^DD",4.3,4.3,22,23,9,0)
 
"^DD",4.3,4.3,22,23,10,0)
Some would argue that the coordinator added the user to the group for a
"^DD",4.3,4.3,22,23,11,0)
reason, and the user should not be allowed to drop out.  (Perhaps the
"^DD",4.3,4.3,22,23,12,0)
coordinator is the user's boss.)  They would argue that it is MailMan's
"^DD",4.3,4.3,22,23,13,0)
job to prevent the user from dropping out.  (Set the field to NO.)
"^DD",4.3,4.3,22,23,14,0)
Others would argue that it is not MailMan's job at all, but the boss's
"^DD",4.3,4.3,22,23,15,0)
job to prevent the user from dropping out, and to discipline the user
"^DD",4.3,4.3,22,23,16,0)
if he does.  (Set the field to YES.)
"^DD",4.3,4.3,22,"DT")
3000606
"^DD",4.3,4.3,23,0)
TITLE SOURCE^S^S:SIGNATURE BLOCK TITLE;T:TITLE;^0;11^Q
"^DD",4.3,4.3,23,3)
Where should the user's title come from?
"^DD",4.3,4.3,23,21,0)
^.001^10^10^3000718^^
"^DD",4.3,4.3,23,21,1,0)
Where in the NEW PERSON file should the user's title come from?
"^DD",4.3,4.3,23,21,2,0)
 
"^DD",4.3,4.3,23,21,3,0)
Enter 'S' if the user's title should come from field 20.3,
"^DD",4.3,4.3,23,21,4,0)
SIGNATURE BLOCK TITLE.  If that field is empty, then we'll try
"^DD",4.3,4.3,23,21,5,0)
field 8, TITLE.
"^DD",4.3,4.3,23,21,6,0)
 
"^DD",4.3,4.3,23,21,7,0)
Enter 'T' if the user's title should come from field 8, TITLE.
"^DD",4.3,4.3,23,21,8,0)
If that field is empty, we won't show any title.
"^DD",4.3,4.3,23,21,9,0)
 
"^DD",4.3,4.3,23,21,10,0)
The default is 'T', if this field is not filled in.
"^DD",4.3,4.3,23,"DT")
3000718
"^DD",4.3,4.3,50,0)
LIMITED BROADCAST^4.32^^5;0
"^DD",4.3,4.3,51,0)
LIMITED BROADCAST DEFAULT^NJ3,0XO^^0;20^D INXFORM^XMXADDR2(.X)
"^DD",4.3,4.3,51,2)
S Y(0)=Y S:Y Y=$P($G(^XMB(1,1,5,Y,0)),U,1)
"^DD",4.3,4.3,51,2.1)
S:Y Y=$P($G(^XMB(1,1,5,Y,0)),U,1)
"^DD",4.3,4.3,51,3)
Select a limited broadcast default
"^DD",4.3,4.3,51,4)
D EXHELP^XMXADDR2
"^DD",4.3,4.3,51,21,0)
^^4^4^2991129^
"^DD",4.3,4.3,51,21,1,0)
When sending a limited broadcast message, this is the default which will
"^DD",4.3,4.3,51,21,2,0)
appear when the user is presented with limited broadcast choices. 
"^DD",4.3,4.3,51,21,3,0)

"^DD",4.3,4.3,51,21,4,0)
If you don't want a default to appear, delete this entry.
"^DD",4.3,4.3,51,23,0)
^^5^5^2991129^
"^DD",4.3,4.3,51,23,1,0)
For this field, we are simulating a pointer to a record in the
"^DD",4.3,4.3,51,23,2,0)
LIMITED BROADCAST multiple.  The executable help displays the choices
"^DD",4.3,4.3,51,23,3,0)
in the multiple.  The input transform makes sure you choose one of the
"^DD",4.3,4.3,51,23,4,0)
choices.  The output transform converts the "pointer" to the limited
"^DD",4.3,4.3,51,23,5,0)
broadcast name.
"^DD",4.3,4.3,51,"DT")
2991129
"^DD",4.3,4.3,142,0)
NO-PURGE DAYS BUFFER (LOCAL)^NJ2,0^^.14;2^K:+X'=X!(X>10)!(X<2)!(X?.E1"."1N.N) X
"^DD",4.3,4.3,142,3)
Type a Number between 2 and 10, 0 Decimal Digits
"^DD",4.3,4.3,142,21,0)
16^^22^22^2980918^^^^
"^DD",4.3,4.3,142,21,1,0)
This field is used during the un-referenced-messages purge to avoid
"^DD",4.3,4.3,142,21,2,0)
purging the last few messages in the message file, according to
"^DD",4.3,4.3,142,21,3,0)
their local create date. 
"^DD",4.3,4.3,142,21,4,0)

"^DD",4.3,4.3,142,21,5,0)
We subtract the NO-PURGE DAYS BUFFER (LOCAL) from today's date, giving
"^DD",4.3,4.3,142,21,6,0)
a 'no-purge date'.  Local messages which were created on or after that
"^DD",4.3,4.3,142,21,7,0)
date and which were sent to remote sites are not subject to purge.
"^DD",4.3,4.3,142,21,8,0)
Other messages are not affected by this buffer.
"^DD",4.3,4.3,142,21,9,0)

"^DD",4.3,4.3,142,21,10,0)
If this field is not filled in, it defaults to 7 days.  This is the
"^DD",4.3,4.3,142,21,11,0)
recommended value.
"^DD",4.3,4.3,142,21,12,0)

"^DD",4.3,4.3,142,21,13,0)
It should not be less than the NO-PURGE DAYS BUFFER (field 4.301)
"^DD",4.3,4.3,142,21,14,0)
or it will have no effect.
"^DD",4.3,4.3,142,21,15,0)

"^DD",4.3,4.3,142,21,16,0)
One situation in which this buffer may be useful is in the case of a
"^DD",4.3,4.3,142,21,17,0)
message sent only to a remote site.  Such a message is unreferenced
"^DD",4.3,4.3,142,21,18,0)
and would otherwise be subject to purge.  If a reply came from the
"^DD",4.3,4.3,142,21,19,0)
remote site after the original message had been purged, the sender
"^DD",4.3,4.3,142,21,20,0)
would have access only to the reply and not to the original message.
"^DD",4.3,4.3,142,21,21,0)
The NO-PURGE DAYS BUFFER (LOCAL) could be set to a reasonable number
"^DD",4.3,4.3,142,21,22,0)
of days to allow for a reply.
"^DD",4.3,4.3,142,"DT")
2980918
"^DD",4.3,4.3,143,0)
FAX ENABLED^S^0:no;1:yes;^0;19^Q
"^DD",4.3,4.3,143,3)
Is your site fax enabled?
"^DD",4.3,4.3,143,21,0)
^^7^7^2970109^
"^DD",4.3,4.3,143,21,1,0)
Your site is fax enabled if you have the suite of fax software and files
"^DD",4.3,4.3,143,21,2,0)
(^AKF) and fax capability and you choose to allow faxes to be sent via MailMan.
"^DD",4.3,4.3,143,21,3,0)

"^DD",4.3,4.3,143,21,4,0)
To send faxes via MailMan, Mail groups (file 3.8) must first be populated in the
"^DD",4.3,4.3,143,21,5,0)
fax recipient and fax group multiples.  Then, when a user sends a message to a
"^DD",4.3,4.3,143,21,6,0)
mail group, the message is also faxed to any fax recipients in that mail group.
"^DD",4.3,4.3,143,21,7,0)
Responses to the message are not faxed.
"^DD",4.3,4.3,143,"DT")
2970211
"^DD",4.3,4.3,217,0)
DEFAULT INSTITUTION^RP4^DIC(4,^XUS;17^Q
"^DD",4.3,4.3,217,3)
Enter the instutition to use as a default for users without one.
"^DD",4.3,4.3,217,9)
^
"^DD",4.3,4.3,217,21,0)
^^2^2^2980427^^^^
"^DD",4.3,4.3,217,21,1,0)
This field is the default institution that is shown for any user who
"^DD",4.3,4.3,217,21,2,0)
hasn't chosen one under "edit user options"
"^DD",4.3,4.3,217,23,0)
^^2^2^2980427^^
"^DD",4.3,4.3,217,23,1,0)
This field is set by a Mumps xref on file 8989.3, field 217, making it a
"^DD",4.3,4.3,217,23,2,0)
duplicate of that field.
"^DD",4.3,4.3,217,"DT")
2900213
"^DD",4.3,4.3,241,0)
BACKGROUND MESSAGE DELIVERERS^FX^^6;1^D CHKQ^XMKPLQ
"^DD",4.3,4.3,241,3)
Enter a set of increasing numbers separated by commas.
"^DD",4.3,4.3,241,4)
D HELPQ^XMKPLQ
"^DD",4.3,4.3,241,21,0)
^^2^2^2980121^^^^
"^DD",4.3,4.3,241,21,1,0)
This field is used by the background filer to determine how many message
"^DD",4.3,4.3,241,21,2,0)
delivery queues (and tasks) there should be and how to separate them.
"^DD",4.3,4.3,241,"DT")
2980121
"^DD",4.3,4.3,242,0)
BACKGROUND RESPONSE DELIVERERS^FX^^6;2^D CHKQ^XMKPLQ
"^DD",4.3,4.3,242,3)
Enter a set of increasing numbers separated by commas.
"^DD",4.3,4.3,242,4)
D HELPQ^XMKPLQ
"^DD",4.3,4.3,242,21,0)
^^2^2^2980121^^^^
"^DD",4.3,4.3,242,21,1,0)
This field is used by the background filer to determine how many response
"^DD",4.3,4.3,242,21,2,0)
delivery queues (and tasks) there will be and how to separate them.
"^DD",4.3,4.3,242,"DT")
2980121
"^DD",4.3,4.302,0)
PURGE AUDIT SUB-FIELD^^8^9
"^DD",4.3,4.302,0,"DT")
2980916
"^DD",4.3,4.302,0,"IX","B",4.302,.01)

"^DD",4.3,4.302,0,"NM","PURGE AUDIT")

"^DD",4.3,4.302,0,"UP")
4.3
"^DD",4.3,4.302,.01,0)
PURGE DATE^D^^0;1^S %DT="ESTX" D ^%DT S X=Y K:Y<1 X
"^DD",4.3,4.302,.01,1,0)
^.1
"^DD",4.3,4.302,.01,1,1,0)
4.302^B
"^DD",4.3,4.302,.01,1,1,1)
S ^XMB(1,DA(1),.1,"B",$E(X,1,30),DA)=""
"^DD",4.3,4.302,.01,1,1,2)
K ^XMB(1,DA(1),.1,"B",$E(X,1,30),DA)
"^DD",4.3,4.302,.01,3)
Enter the purge date you are interested in.
"^DD",4.3,4.302,.01,21,0)
^^1^1^2980122^^
"^DD",4.3,4.302,.01,21,1,0)
This is a date on which one of the purges ran.
"^DD",4.3,4.302,.01,"DT")
2980123
"^DD",4.3,4.302,1,0)
REMAINING MESSAGES^NJ8,0^^0;2^K:+X'=X!(X>99999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",4.3,4.302,1,3)
Type a Number between 0 and 99999999, 0 Decimal Digits
"^DD",4.3,4.302,1,21,0)
^^1^1^2980122^^^^
"^DD",4.3,4.302,1,21,1,0)
This is the number of messages that remained on file after the purge ran.
"^DD",4.3,4.302,1,"DT")
2980123
"^DD",4.3,4.302,2,0)
PURGED MESSAGES^NJ8,0^^0;3^K:+X'=X!(X>99999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",4.3,4.302,2,3)
Type a Number between 0 and 99999999, 0 Decimal Digits
"^DD",4.3,4.302,2,21,0)
^^1^1^2980122^^^
"^DD",4.3,4.302,2,21,1,0)
This is the number of messages that were purged.
"^DD",4.3,4.302,2,"DT")
2890726
"^DD",4.3,4.302,3,0)
START PURGE DATE^D^^0;4^S %DT="EX" D ^%DT S X=Y K:Y<1 X
"^DD",4.3,4.302,3,3)
Enter the date at which you wish processing to start.
"^DD",4.3,4.302,3,21,0)
^^4^4^2980916^^^^
"^DD",4.3,4.302,3,21,1,0)
This is the date entered by the user.  It refers to the starting date
"^DD",4.3,4.302,3,21,2,0)
of the purge process for unreferenced messages.  All unreferenced
"^DD",4.3,4.302,3,21,3,0)
messages sent on or after this date (and on or before the ending date)
"^DD",4.3,4.302,3,21,4,0)
are subject to purge.
"^DD",4.3,4.302,3,"DT")
2980916
"^DD",4.3,4.302,4,0)
STOP PURGE DATE^D^^0;5^S %DT="EX" D ^%DT S X=Y K:Y<1 X
"^DD",4.3,4.302,4,3)
Enter the date after which you wish processing to stop.
"^DD",4.3,4.302,4,21,0)
^^4^4^2980916^^^^
"^DD",4.3,4.302,4,21,1,0)
This is the date entered by the user.  It refers to the ending date
"^DD",4.3,4.302,4,21,2,0)
of the purge process for unreferenced messages.  All unreferenced
"^DD",4.3,4.302,4,21,3,0)
messages sent on or before this date (and on or after the starting date)
"^DD",4.3,4.302,4,21,4,0)
are subject to purge.
"^DD",4.3,4.302,4,"DT")
2980916
"^DD",4.3,4.302,5,0)
PURGE TYPE^S^1:DATE PURGE;0:UNREFERENCED MESSAGES PURGE;^0;6^Q
"^DD",4.3,4.302,5,3)
Which type of purge is this?
"^DD",4.3,4.302,5,21,0)
^^1^1^2980123^^
"^DD",4.3,4.302,5,21,1,0)
There are purges of unreferenced messages and there are date purges.
"^DD",4.3,4.302,5,"DT")
2980123
"^DD",4.3,4.302,6,0)
PURGE MESSAGES OLDER THAN DATE^D^^0;7^S %DT="EX" D ^%DT S X=Y K:Y<1 X
"^DD",4.3,4.302,6,21,0)
^^10^10^2980916^^^^
"^DD",4.3,4.302,6,21,1,0)
This field is used during date purges and unreferenced message purges.
"^DD",4.3,4.302,6,21,2,0)

"^DD",4.3,4.302,6,21,3,0)
During date purges, messages older than this date are purged from the
"^DD",4.3,4.302,6,21,4,0)
Message file.
"^DD",4.3,4.302,6,21,5,0)

"^DD",4.3,4.302,6,21,6,0)
During unreferenced message purges, unreferenced messages are purged
"^DD",4.3,4.302,6,21,7,0)
if they were created on or before the purge end date.
"^DD",4.3,4.302,6,21,8,0)
However, messages which originated locally and were sent to remote sites
"^DD",4.3,4.302,6,21,9,0)
are not purged if they were created on or after this date.  This is to
"^DD",4.3,4.302,6,21,10,0)
give the remote sites some time to reply to the unreferenced message.
"^DD",4.3,4.302,6,"DT")
2980916
"^DD",4.3,4.302,7,0)
LAST UPDATE^D^^0;8^S %DT="ESTX" D ^%DT S X=Y K:Y<1 X
"^DD",4.3,4.302,7,21,0)
^^4^4^2980918^^
"^DD",4.3,4.302,7,21,1,0)
This is the date & time of the last update by the process.
"^DD",4.3,4.302,7,21,2,0)
It, along with the LAST DATE PROCESSED field,
"^DD",4.3,4.302,7,21,3,0)
should indicate to the user that the task is progressing
"^DD",4.3,4.302,7,21,4,0)
as it is checked and changes during the process.
"^DD",4.3,4.302,7,"DT")
2900125
"^DD",4.3,4.302,8,0)
LAST DATE PROCESSED^D^^0;9^S %DT="EX" D ^%DT S X=Y K:Y<1 X
"^DD",4.3,4.302,8,3)

"^DD",4.3,4.302,8,21,0)
^^4^4^2980916^^^
"^DD",4.3,4.302,8,21,1,0)
This field is updated during the date purge.
"^DD",4.3,4.302,8,21,2,0)
It is the local create date of the last message actually processed
"^DD",4.3,4.302,8,21,3,0)
when the update was made to the progress data which also includes
"^DD",4.3,4.302,8,21,4,0)
the date/time of the update.
"^DD",4.3,4.302,8,"DT")
2980916
"^DD",4.3,4.31,0)
SUBORDINATE DOMAIN SUB-FIELD^NL^2^3
"^DD",4.3,4.31,0,"DT")
2910618
"^DD",4.3,4.31,0,"NM","SUBORDINATE DOMAIN")

"^DD",4.3,4.31,0,"UP")
4.3
"^DD",4.3,4.31,.01,0)
SUBORDINATE DOMAIN^MP4.2'^DIC(4.2,^0;1^Q
"^DD",4.3,4.31,.01,3)
This is a list of all domains which consider this domain a parent
"^DD",4.3,4.31,.01,21,0)
^^4^4^2980122^^
"^DD",4.3,4.31,.01,21,1,0)
This field is not currently used.
"^DD",4.3,4.31,.01,21,2,0)
This is a domain which is subordinate to this local MailMan
"^DD",4.3,4.31,.01,21,3,0)
domain, i.e. a domain which considers this local domain a
"^DD",4.3,4.31,.01,21,4,0)
"parent".
"^DD",4.3,4.31,1,0)
DATE CHRISTENED^D^^0;2^S %DT="ET" D ^%DT S X=Y K:Y<1 X
"^DD",4.3,4.31,1,3)
Date on which this subordinate domain was christened..
"^DD",4.3,4.31,1,21,0)
^^4^4^2980122^^
"^DD",4.3,4.31,1,21,1,0)
This field is not currently used.
"^DD",4.3,4.31,1,21,2,0)
This field holds the date and time on which this subordinate domain
"^DD",4.3,4.31,1,21,3,0)
was accepted by this domain.  It is controlled automatically by the
"^DD",4.3,4.31,1,21,4,0)
MailMan christening operation.
"^DD",4.3,4.31,2,0)
CHRISTENED BY^P200'^VA(200,^0;3^Q
"^DD",4.3,4.31,2,21,0)
^^3^3^2980122^^
"^DD",4.3,4.31,2,21,1,0)
This field is not currently used.
"^DD",4.3,4.31,2,21,2,0)
This field holds the name of the user who performed the christening
"^DD",4.3,4.31,2,21,3,0)
operation on this subordinate domain.
"^DD",4.3,4.31,2,"DT")
2910618
"^DD",4.3,4.32,0)
LIMITED BROADCAST SUB-FIELD^^2^3
"^DD",4.3,4.32,0,"DT")
2991116
"^DD",4.3,4.32,0,"IX","B",4.32,.01)

"^DD",4.3,4.32,0,"NM","LIMITED BROADCAST")

"^DD",4.3,4.32,0,"UP")
4.3
"^DD",4.3,4.32,.01,0)
LIMITED BROADCAST^MF^^0;1^K:$L(X)>30!($L(X)<3) X
"^DD",4.3,4.32,.01,1,0)
^.1
"^DD",4.3,4.32,.01,1,1,0)
4.32^B
"^DD",4.3,4.32,.01,1,1,1)
S ^XMB(1,DA(1),5,"B",$E(X,1,30),DA)=""
"^DD",4.3,4.32,.01,1,1,2)
K ^XMB(1,DA(1),5,"B",$E(X,1,30),DA)
"^DD",4.3,4.32,.01,3)
Answer must be 3-30 characters in length
"^DD",4.3,4.32,.01,21,0)
^^1^1^2991028^^
"^DD",4.3,4.32,.01,21,1,0)
This is the name of the associated field in the NEW PERSON file.
"^DD",4.3,4.32,.01,"DT")
2991025
"^DD",4.3,4.32,1,0)
POINTED TO FILE^RP1'^DIC(^0;2^Q
"^DD",4.3,4.32,1,3)
Answer with FILE NUMBER, or NAME
"^DD",4.3,4.32,1,21,0)
^^1^1^2991116^^^^
"^DD",4.3,4.32,1,21,1,0)
This is the file pointed to by the associated field in the NEW PERSON file.
"^DD",4.3,4.32,1,"DT")
2991116
"^DD",4.3,4.32,2,0)
NEW PERSON FILE XREF^RF^^0;3^K:$L(X)>4!($L(X)<1) X
"^DD",4.3,4.32,2,3)
Answer must be 1-4 characters in length.
"^DD",4.3,4.32,2,21,0)
^^2^2^2991116^^^
"^DD",4.3,4.32,2,21,1,0)
This is the name of the (whole file) cross reference on the associated
"^DD",4.3,4.32,2,21,2,0)
field in the NEW PERSON file.
"^DD",4.3,4.32,2,"DT")
2991116
"^DD",4.3,4.37,0)
FTP NOTES SUB-FIELD^^.01^1
"^DD",4.3,4.37,0,"DT")
2930616
"^DD",4.3,4.37,0,"NM","FTP NOTES")

"^DD",4.3,4.37,0,"UP")
4.3
"^DD",4.3,4.37,.01,0)
FTP NOTES^WL^^0;1^Q
"^DD",4.3,4.37,.01,3)
Put special notes revelant to the FTP operations of this site.
"^DD",4.3,4.37,.01,21,0)
^^1^1^2931214^
"^DD",4.3,4.37,.01,21,1,0)
See above.
"^DD",4.3,4.37,.01,"DT")
2930616
"^DD",4.4,4.4,0)
FIELD^^2^3
"^DD",4.4,4.4,0,"DDA")
Y
"^DD",4.4,4.4,0,"ID",1)
W:$D(^(0)) "   ",$P(^(0),U,2)
"^DD",4.4,4.4,0,"IX","B",4.4,.01)

"^DD",4.4,4.4,0,"IX","C",4.4,1)

"^DD",4.4,4.4,0,"NM","MAILMAN TIME ZONE")

"^DD",4.4,4.4,0,"PT",4.3,1)

"^DD",4.4,4.4,.01,0)
CODE^RF^^0;1^K:$L(X)>3!($L(X)<3)!'(X?3U) X
"^DD",4.4,4.4,.01,.1)
Three character code, naming the zone.
"^DD",4.4,4.4,.01,1,0)
^.1
"^DD",4.4,4.4,.01,1,1,0)
4.4^B
"^DD",4.4,4.4,.01,1,1,1)
S ^XMB(4.4,"B",$E(X,1,30),DA)=""
"^DD",4.4,4.4,.01,1,1,2)
K ^XMB(4.4,"B",$E(X,1,30),DA)
"^DD",4.4,4.4,.01,3)
Must be three upper case letters
"^DD",4.4,4.4,.01,21,0)
^^1^1^2851009^
"^DD",4.4,4.4,.01,21,1,0)
The 3 character code for the Time Zone, i.e. EST, CST, MST, PST, etc.
"^DD",4.4,4.4,1,0)
TIME ZONE NAME^F^^0;2^K:$L(X)>25!($L(X)<5) X
"^DD",4.4,4.4,1,1,0)
^.1
"^DD",4.4,4.4,1,1,1,0)
4.4^C
"^DD",4.4,4.4,1,1,1,1)
S ^XMB(4.4,"C",$E(X,1,30),DA)=""
"^DD",4.4,4.4,1,1,1,2)
K ^XMB(4.4,"C",$E(X,1,30),DA)
"^DD",4.4,4.4,1,3)
ANSWER MUST BE 5-25 CHARACTERS IN LENGTH
"^DD",4.4,4.4,1,21,0)
^^1^1^2851009^
"^DD",4.4,4.4,1,21,1,0)
The formal name of the Time Zone, i.e. Eastern Standard Time, etc.
"^DD",4.4,4.4,2,0)
DIFFERENTIAL^NJ4,1^^0;3^K:+X'=X!(X>12)!(X<-12)!(X?.E1"."2N.N) X
"^DD",4.4,4.4,2,3)
Enter the number of hours before or after GMT
"^DD",4.4,4.4,2,21,0)
^^1^1^2851009^
"^DD",4.4,4.4,2,21,1,0)
The number of hours before or after GMT.
"^DD",4.501,4.501,0)
FIELD^^1^2
"^DD",4.501,4.501,0,"DDA")
N
"^DD",4.501,4.501,0,"DT")
2930501
"^DD",4.501,4.501,0,"IX","B",4.501,.01)

"^DD",4.501,4.501,0,"NM","NETWORK SENDERS REJECTED")

"^DD",4.501,4.501,.01,0)
NAME^RF^^0;1^K:$L(X)>99!($L(X)<3)!'(X'?1P.E) X
"^DD",4.501,4.501,.01,1,0)
^.1
"^DD",4.501,4.501,.01,1,1,0)
4.501^B
"^DD",4.501,4.501,.01,1,1,1)
S ^XMBX(4.501,"B",$E(X,1,30),DA)=""
"^DD",4.501,4.501,.01,1,1,2)
K ^XMBX(4.501,"B",$E(X,1,30),DA)
"^DD",4.501,4.501,.01,3)
Answer must be 3-99 characters in length.
"^DD",4.501,4.501,.01,21,0)
^^9^9^3020422^^
"^DD",4.501,4.501,.01,21,1,0)
This field contains a list of senders from whom messages will be rejected.
"^DD",4.501,4.501,.01,21,2,0)
The test is that the sender's name contains the string in one of these
"^DD",4.501,4.501,.01,21,3,0)
fields.  A site could therefore choose to reject all messages that come
"^DD",4.501,4.501,.01,21,4,0)
from a particular domain, from a person at a domain or from any domain
"^DD",4.501,4.501,.01,21,5,0)
that is a subdomain of a domain.  This is not a complete list, but is a set
"^DD",4.501,4.501,.01,21,6,0)
of examples of what could be done.
"^DD",4.501,4.501,.01,21,7,0)

"^DD",4.501,4.501,.01,21,8,0)
Rejection is done during the processing of the MAIL FROM: message protocol
"^DD",4.501,4.501,.01,21,9,0)
data unit.
"^DD",4.501,4.501,.01,"DT")
3020422
"^DD",4.501,4.501,1,0)
USE FLAG^S^1:DO NOT USE;0:USE;^0;2^Q
"^DD",4.501,4.501,1,"DT")
2930501
"^DD",4.6,4.6,0)
FIELD^^2^3
"^DD",4.6,4.6,0,"DDA")
Y
"^DD",4.6,4.6,0,"IX","B",4.6,.01)

"^DD",4.6,4.6,0,"NM","TRANSMISSION SCRIPT")

"^DD",4.6,4.6,0,"PT",4.3,8.24)

"^DD",4.6,4.6,.01,0)
NAME^RF^^0;1^K:$L(X)>30!(X?.N)!($L(X)<3)!'(X'?1P.E)!(X'?.ANP) X
"^DD",4.6,4.6,.01,1,0)
^.1
"^DD",4.6,4.6,.01,1,1,0)
4.6^B
"^DD",4.6,4.6,.01,1,1,1)
S ^XMB(4.6,"B",$E(X,1,30),DA)=""
"^DD",4.6,4.6,.01,1,1,2)
K ^XMB(4.6,"B",$E(X,1,30),DA)
"^DD",4.6,4.6,.01,3)
NAME MUST BE 3-30 CHARACTERS, NOT NUMERIC OR STARTING WITH PUNCTUATION
"^DD",4.6,4.6,.01,21,0)
^^3^3^2881107^
"^DD",4.6,4.6,.01,21,1,0)
Transmission scripts are used by the MailMan script processor to link
"^DD",4.6,4.6,.01,21,2,0)
up systems.  The entries in this file are 'Called' as a kind of 'macro'
"^DD",4.6,4.6,.01,21,3,0)
by any of the scripts in the DOMAIN file.
"^DD",4.6,4.6,1,0)
TEXT^4.61^^1;0
"^DD",4.6,4.6,1,21,0)
^^2^2^2931214^^
"^DD",4.6,4.6,1,21,1,0)
This is the actual script.  It consists of a command per line that is
"^DD",4.6,4.6,1,21,2,0)
interpreted by the MailMan script processor.
"^DD",4.6,4.6,2,0)
DESCRIPTION^4.62^^2;0
"^DD",4.6,4.6,2,21,0)
^^1^1^2931214^^
"^DD",4.6,4.6,2,21,1,0)
A brief description of the purpose of the script.
"^DD",4.6,4.61,0)
TEXT SUB-FIELD^NL^.01^1
"^DD",4.6,4.61,0,"NM","TEXT")

"^DD",4.6,4.61,0,"UP")
4.6
"^DD",4.6,4.61,.01,0)
TEXT^WL^^0;1^Q
"^DD",4.6,4.61,.01,3)
Enter the text of the script.
"^DD",4.6,4.61,.01,21,0)
^^1^1^2931214^
"^DD",4.6,4.61,.01,21,1,0)
See above.
"^DD",4.6,4.61,.01,"DT")
2860508
"^DD",4.6,4.62,0)
DESCRIPTION SUB-FIELD^NL^.01^1
"^DD",4.6,4.62,0,"NM","DESCRIPTION")

"^DD",4.6,4.62,0,"UP")
4.6
"^DD",4.6,4.62,.01,0)
DESCRIPTION^W^^0;1^Q
"^DD",4.6,4.62,.01,3)
Description of the script for documentation purposes
"^DD",4.6,4.62,.01,21,0)
^^1^1^2931214^
"^DD",4.6,4.62,.01,21,1,0)
See above.
"^DIC",3.4,3.4,0)
COMMUNICATIONS PROTOCOL^3.4
"^DIC",3.4,3.4,0,"GL")
^DIC(3.4,
"^DIC",3.4,3.4,"%",0)
^1.005^1^1
"^DIC",3.4,3.4,"%",1,0)
XM
"^DIC",3.4,3.4,"%","B","XM",1)

"^DIC",3.4,3.4,"%D",0)
^^5^5^3020422^^^^
"^DIC",3.4,3.4,"%D",1,0)
This file holds the definitions of all the communications protocols
"^DIC",3.4,3.4,"%D",2,0)
known to the kernel.  A protocol has executable MUMPS code for sending,
"^DIC",3.4,3.4,"%D",3,0)
receiving, opening, and closing a link.  This file is not to be touched
"^DIC",3.4,3.4,"%D",4,0)
by anyone not intimately knowledgeable with the workings of the networked
"^DIC",3.4,3.4,"%D",5,0)
MailMan.
"^DIC",3.4,"B","COMMUNICATIONS PROTOCOL",3.4)

"^DIC",3.6,3.6,0)
BULLETIN^3.6
"^DIC",3.6,3.6,0,"GL")
^XMB(3.6,
"^DIC",3.6,3.6,"%",0)
^1.005^2^2
"^DIC",3.6,3.6,"%",1,0)
XU
"^DIC",3.6,3.6,"%",2,0)
XM
"^DIC",3.6,3.6,"%","B","XM",2)

"^DIC",3.6,3.6,"%","B","XU",1)

"^DIC",3.6,3.6,"%D",0)
^^13^13^2940109^^^^
"^DIC",3.6,3.6,"%D",1,0)
Bulletins are 'Super' messages.  Each Bulletin has a text and a subject
"^DIC",3.6,3.6,"%D",2,0)
just like a normal message.  But embedded within either the subject or
"^DIC",3.6,3.6,"%D",3,0)
the text can be variable fields that can be filled in with parameters.
"^DIC",3.6,3.6,"%D",4,0)
There is also a standard set of recipients in the form of a Mail Group
"^DIC",3.6,3.6,"%D",5,0)
that is associated with the bulletin.
"^DIC",3.6,3.6,"%D",6,0)
 
"^DIC",3.6,3.6,"%D",7,0)
Bulletins are processed by MailMan either because of a special cross
"^DIC",3.6,3.6,"%D",8,0)
reference type of FileMan or because of a direct call in a routine.
"^DIC",3.6,3.6,"%D",9,0)
The interface for the direct call is described in the documentation
"^DIC",3.6,3.6,"%D",10,0)
on programmer entry points.  FileMan sets up code that will issue
"^DIC",3.6,3.6,"%D",11,0)
a bulletin automatically when the special cross reference type is
"^DIC",3.6,3.6,"%D",12,0)
created.  In either case the parameters that go into the text and/or
"^DIC",3.6,3.6,"%D",13,0)
the subject make each bulletin unique.
"^DIC",3.6,"B","BULLETIN",3.6)

"^DIC",3.7,3.7,0)
MAILBOX^3.7P
"^DIC",3.7,3.7,0,"GL")
^XMB(3.7,
"^DIC",3.7,3.7,"%",0)
^1.005^1^1
"^DIC",3.7,3.7,"%",1,0)
XM
"^DIC",3.7,3.7,"%","B","XM",1)

"^DIC",3.7,3.7,"%D",0)
^^7^7^2990320^^^^
"^DIC",3.7,3.7,"%D",1,0)
This file holds pointers to the message file, according to users.
"^DIC",3.7,3.7,"%D",2,0)
Each mailbox entry corresponds to a user.  POSTMASTER is a special
"^DIC",3.7,3.7,"%D",3,0)
user who controls the network communications queues.  Each user
"^DIC",3.7,3.7,"%D",4,0)
is automatically given two baskets: IN and  WASTE.  All incoming messages
"^DIC",3.7,3.7,"%D",5,0)
go into the users IN basket.  When the user deletes them, they are
"^DIC",3.7,3.7,"%D",6,0)
temporarily stored in the WASTE basket.   Users may create new baskets
"^DIC",3.7,3.7,"%D",7,0)
as they wish.
"^DIC",3.7,"B","MAILBOX",3.7)

"^DIC",3.73,3.73,0)
MESSAGES TO BE NEW AT A LATER DATE^3.73ID
"^DIC",3.73,3.73,0,"GL")
^XMB(3.73,
"^DIC",3.73,3.73,"%",0)
^1.005^1^1
"^DIC",3.73,3.73,"%",1,0)
XM
"^DIC",3.73,3.73,"%","B","XM",1)

"^DIC",3.73,3.73,"%D",0)
^^2^2^2931204^^
"^DIC",3.73,3.73,"%D",1,0)
This file holds entries that are processed by a special MailMan job that
"^DIC",3.73,3.73,"%D",2,0)
makes messages new for people at scheduled dates and times.
"^DIC",3.73,"B","MESSAGES TO BE NEW AT A LATER DATE",3.73)

"^DIC",3.8,3.8,0)
MAIL GROUP^3.8I
"^DIC",3.8,3.8,0,"GL")
^XMB(3.8,
"^DIC",3.8,3.8,"%",0)
^1.005^1^1
"^DIC",3.8,3.8,"%",1,0)
XM
"^DIC",3.8,3.8,"%","B","XM",1)

"^DIC",3.8,3.8,"%D",0)
^^2^2^2881108^^^^
"^DIC",3.8,3.8,"%D",1,0)
This file holds the names of all groups known to MailMan, and their
"^DIC",3.8,3.8,"%D",2,0)
members.
"^DIC",3.8,"B","MAIL GROUP",3.8)

"^DIC",3.816,3.816,0)
DISTRIBUTION LIST^3.816
"^DIC",3.816,3.816,0,"GL")
^XMB(3.816,
"^DIC",3.816,3.816,"%D",0)
^^12^12^2931204^^^
"^DIC",3.816,3.816,"%D",0,"LE")
1
"^DIC",3.816,3.816,"%D",1,0)
The Distribution List file has entries that consist of names.  Each name is
"^DIC",3.816,3.816,"%D",2,0)
associated with one or more domain.  When a Distribution List is entered
"^DIC",3.816,3.816,"%D",3,0)
into a Mail Group, MailMan will deliver the message to all the entities
"^DIC",3.816,3.816,"%D",4,0)
it has linked to it.  A Distribution List is interpreted as a name at which
"^DIC",3.816,3.816,"%D",5,0)
the message will be delivered to at each of the associated domains in the
"^DIC",3.816,3.816,"%D",6,0)
list.  Therefore a Distribution List whose NAME is G.SUPPORT and whose
"^DIC",3.816,3.816,"%D",7,0)
associated domains are FORUM.VA.GOV, ALTOONA,VA,GOV and ISC-SF.VA.GOV will
"^DIC",3.816,3.816,"%D",8,0)
be sent (in addition to all other entities attached to the Mail Group) to:
"^DIC",3.816,3.816,"%D",9,0)
 
"^DIC",3.816,3.816,"%D",10,0)
    G.SUPPORT@FORUM.VA.GOV
"^DIC",3.816,3.816,"%D",11,0)
    G.SUPPORT@ALTOONA.VA.GOV
"^DIC",3.816,3.816,"%D",12,0)
 &  G.SUPPORT@ISC-SF.VA.GOV
"^DIC",3.816,"B","DISTRIBUTION LIST",3.816)

"^DIC",3.9,3.9,0)
MESSAGE^3.9s
"^DIC",3.9,3.9,0,"GL")
^XMB(3.9,
"^DIC",3.9,3.9,"%",0)
^1.005^1^1
"^DIC",3.9,3.9,"%",1,0)
XM
"^DIC",3.9,3.9,"%","B","XM",1)

"^DIC",3.9,3.9,"%D",0)
^^1^1^2940407^^^^
"^DIC",3.9,3.9,"%D",0,"LE")
1
"^DIC",3.9,3.9,"%D",1,0)
These messages are the heart of the MailMan system.
"^DIC",3.9,"B","MESSAGE",3.9)

"^DIC",4.2,4.2,0)
DOMAIN^4.2I
"^DIC",4.2,4.2,0,"GL")
^DIC(4.2,
"^DIC",4.2,4.2,"%",0)
^1.005^1^1
"^DIC",4.2,4.2,"%",1,0)
XM
"^DIC",4.2,4.2,"%","B","XM",1)

"^DIC",4.2,4.2,"%D",0)
^^19^19^3020422^^^^
"^DIC",4.2,4.2,"%D",1,0)
This file is used to name all of the domains to which MailMan messages
"^DIC",4.2,4.2,"%D",2,0)
may be routed.  Each name in this file corresponds to the right side
"^DIC",4.2,4.2,"%D",3,0)
of a MailMan address-the part following the "@".
"^DIC",4.2,4.2,"%D",4,0)
 
"^DIC",4.2,4.2,"%D",5,0)
Domains may have synonyms, allowing users to name sites with one name,
"^DIC",4.2,4.2,"%D",6,0)
while MailMan uses the more formal Domain Naming conventions.
"^DIC",4.2,4.2,"%D",7,0)
 
"^DIC",4.2,4.2,"%D",8,0)
This file also controls whether messages are queued for immediate transmission
"^DIC",4.2,4.2,"%D",9,0)
and into what queue they are dropped.  Any domain may have a relay domain,
"^DIC",4.2,4.2,"%D",10,0)
which controls the routing as follows:
"^DIC",4.2,4.2,"%D",11,0)
 
"^DIC",4.2,4.2,"%D",12,0)
If a domain has a named relay domain, the message is put in the queue for
"^DIC",4.2,4.2,"%D",13,0)
the relay domain.
"^DIC",4.2,4.2,"%D",14,0)
 
"^DIC",4.2,4.2,"%D",15,0)
If not, and the domain has a TRANSMISSION SCRIPT, then the message is put
"^DIC",4.2,4.2,"%D",16,0)
in the queue for that domain.
"^DIC",4.2,4.2,"%D",17,0)
 
"^DIC",4.2,4.2,"%D",18,0)
Otherwise, the message is put in the queue for the Parent domain, as defined
"^DIC",4.2,4.2,"%D",19,0)
at MailMan initialization time.
"^DIC",4.2,"B","DOMAIN",4.2)

"^DIC",4.281,4.281,0)
INTER-UCI TRANSFER^4.281
"^DIC",4.281,4.281,0,"GL")
^%ZISL(4.281,
"^DIC",4.281,4.281,"%",0)
^1.005^1^1
"^DIC",4.281,4.281,"%",1,0)
XM
"^DIC",4.281,4.281,"%","B","XM",1)

"^DIC",4.281,4.281,"%D",0)
^^5^5^3020422^^
"^DIC",4.281,4.281,"%D",1,0)
The Inter-UCI Transfer file is used by MailMan to do non-interactive
"^DIC",4.281,4.281,"%D",2,0)
transmissions and receptions of messages to and from UCIs that share
"^DIC",4.281,4.281,"%D",3,0)
the %ZISL file either because they are on the same machine or because
"^DIC",4.281,4.281,"%D",4,0)
they are on the same local area network and use DDP translation techniques
"^DIC",4.281,4.281,"%D",5,0)
for the %ZISL global.
"^DIC",4.281,"B","INTER-UCI TRANSFER",4.281)

"^DIC",4.2995,4.2995,0)
MAILMAN OUTSTANDING FTP TRANSACTIONS^4.2995
"^DIC",4.2995,4.2995,0,"GL")
^XMBX(4.2995,
"^DIC",4.2995,4.2995,"%D",0)
^^5^5^2931204^
"^DIC",4.2995,4.2995,"%D",1,0)
When multimedia messages are transmitted, procedure files are created to
"^DIC",4.2995,4.2995,"%D",2,0)
send the 'non-textual message body parts' using the File Transfer Protocol
"^DIC",4.2995,4.2995,"%D",3,0)
(FTP).  Entries are made into this file for each such instance and then
"^DIC",4.2995,4.2995,"%D",4,0)
the TCP/IP Poller will execute the procedure file and delete the entry for
"^DIC",4.2995,4.2995,"%D",5,0)
it.
"^DIC",4.2995,"B","MAILMAN OUTSTANDING FTP TRANSACTIONS",4.2995)

"^DIC",4.2996,4.2996,0)
INTERNET SUFFIX^4.2996I
"^DIC",4.2996,4.2996,0,"GL")
^DIC(4.2996,
"^DIC",4.2996,4.2996,"%",0)
^1.005^1^1
"^DIC",4.2996,4.2996,"%",1,0)
XM
"^DIC",4.2996,4.2996,"%","B","XM",1)

"^DIC",4.2996,4.2996,"%D",0)
^^22^22^3020422^^^^
"^DIC",4.2996,4.2996,"%D",1,0)
This file contains a complete list of the approved generic top-level
"^DIC",4.2996,4.2996,"%D",2,0)
domains (gTLDs) and country-code top-level domains (ccTLDs).
"^DIC",4.2996,4.2996,"%D",3,0)
The top-level domain is the last dot piece of the domain name.
"^DIC",4.2996,4.2996,"%D",4,0)

"^DIC",4.2996,4.2996,"%D",5,0)
This file is used during domain name lookup, when a message is addressed
"^DIC",4.2996,4.2996,"%D",6,0)
to a remote site.  If the domain name cannot be found in the DOMAIN file
"^DIC",4.2996,4.2996,"%D",7,0)
4.2, MailMan looks in this file to try to find the top-level of the
"^DIC",4.2996,4.2996,"%D",8,0)
domain.  If it is not found, the domain is not valid.
"^DIC",4.2996,4.2996,"%D",9,0)

"^DIC",4.2996,4.2996,"%D",10,0)
Authorities:
"^DIC",4.2996,4.2996,"%D",11,0)

"^DIC",4.2996,4.2996,"%D",12,0)
gTLD  - ICANN, the Internet Corporation for Assigned Names and Numbers,
"^DIC",4.2996,4.2996,"%D",13,0)
        www.icann.org, administers the Domain Name System and
"^DIC",4.2996,4.2996,"%D",14,0)
        is the approval authority for gTLDs.
"^DIC",4.2996,4.2996,"%D",15,0)

"^DIC",4.2996,4.2996,"%D",16,0)
ccTLD - IANA, the Internet Assigned Numbers Authority, www.iana.org,
"^DIC",4.2996,4.2996,"%D",17,0)
        administers the ccTLDs.  It employs a two-letter country code
"^DIC",4.2996,4.2996,"%D",18,0)
        list (ISO 3166-1) maintained by the ISO 3166 Maintenance Agency.
"^DIC",4.2996,4.2996,"%D",19,0)

"^DIC",4.2996,4.2996,"%D",20,0)
The data in this file may not be edited or altered in any way, except
"^DIC",4.2996,4.2996,"%D",21,0)
for the NOTES text field, which you may edit if you wish.
"^DIC",4.2996,4.2996,"%D",22,0)
If you think any entries need to be changed or added, please enter a NOIS.
"^DIC",4.2996,"B","INTERNET SUFFIX",4.2996)

"^DIC",4.2997,4.2997,0)
REMOTE USER DIRECTORY^4.2997I
"^DIC",4.2997,4.2997,0,"GL")
^XMD(4.2997,
"^DIC",4.2997,4.2997,"%",0)
^1.005^1^1
"^DIC",4.2997,4.2997,"%",1,0)
XM
"^DIC",4.2997,4.2997,"%","B","XM",1)

"^DIC",4.2997,4.2997,"%D",0)
^^3^3^3020422^^^
"^DIC",4.2997,4.2997,"%D",1,0)
People who have mailboxes on remote systems may be entered into this
"^DIC",4.2997,4.2997,"%D",2,0)
file so that local users can look up their names and have their mail
"^DIC",4.2997,4.2997,"%D",3,0)
automatically addressed.
"^DIC",4.2997,"B","REMOTE USER DIRECTORY",4.2997)

"^DIC",4.2998,4.2998,0)
MESSAGE DELIVERY STATS^4.2998D
"^DIC",4.2998,4.2998,0,"GL")
^XMBX(4.2998,
"^DIC",4.2998,4.2998,"%",0)
^1.005^1^1
"^DIC",4.2998,4.2998,"%",1,0)
XM
"^DIC",4.2998,4.2998,"%","B","XM",1)

"^DIC",4.2998,4.2998,"%D",0)
^^2^2^3020422^^^^
"^DIC",4.2998,4.2998,"%D",1,0)
This file is used to store statistics about local message deliveries,
"^DIC",4.2998,4.2998,"%D",2,0)
response time and numbers of active user processes.
"^DIC",4.2998,"B","MESSAGE DELIVERY STATS",4.2998)

"^DIC",4.2999,4.2999,0)
MESSAGE STATISTICS^4.2999IP
"^DIC",4.2999,4.2999,0,"GL")
^XMBS(4.2999,
"^DIC",4.2999,4.2999,"%",0)
^1.005^1^1
"^DIC",4.2999,4.2999,"%",1,0)
XM
"^DIC",4.2999,4.2999,"%","B","XM",1)

"^DIC",4.2999,4.2999,"%D",0)
^^1^1^2900530
"^DIC",4.2999,4.2999,"%D",1,0)
This file is used to collect non-static information about network mail transmissions
"^DIC",4.2999,"B","MESSAGE STATISTICS",4.2999)

"^DIC",4.3,4.3,0)
MAILMAN SITE PARAMETERS^4.3P
"^DIC",4.3,4.3,0,"GL")
^XMB(1,
"^DIC",4.3,4.3,"%",0)
^1.005^1^1
"^DIC",4.3,4.3,"%",1,0)
XM
"^DIC",4.3,4.3,"%","B","XM",1)

"^DIC",4.3,4.3,"%D",0)
1^^6^6^2990320^^^^
"^DIC",4.3,4.3,"%D",1,0)
This file holds the site parameters for MailMan.
"^DIC",4.3,4.3,"%D",2,0)
It may have only one entry - the domain name of the installation site.
"^DIC",4.3,4.3,"%D",3,0)
Some parameters are defined by the systems manager during installation.
"^DIC",4.3,4.3,"%D",4,0)
Others may be edited subsequent to installation.  The parent domain,
"^DIC",4.3,4.3,"%D",5,0)
set to FORUM during initialization, may be changed.  Audit parameters may
"^DIC",4.3,4.3,"%D",6,0)
be established.
"^DIC",4.3,"B","MAILMAN SITE PARAMETERS",4.3)

"^DIC",4.4,4.4,0)
MAILMAN TIME ZONE^4.4I
"^DIC",4.4,4.4,0,"GL")
^XMB(4.4,
"^DIC",4.4,4.4,"%",0)
^1.005^1^1
"^DIC",4.4,4.4,"%",1,0)
XM
"^DIC",4.4,4.4,"%","B","XM",1)

"^DIC",4.4,4.4,"%D",0)
^^4^4^3020422^^^
"^DIC",4.4,4.4,"%D",1,0)
MailMan Time Zones are used to calculate the time in the time zone a
"^DIC",4.4,4.4,"%D",2,0)
receiving domain is in for a message coming in from a different time zone.
"^DIC",4.4,4.4,"%D",3,0)
Therefore times can be expressed in EST (Eastern Standard Time) even
"^DIC",4.4,4.4,"%D",4,0)
if they were originally formed in PST (Pacific Standard Time).
"^DIC",4.4,"B","MAILMAN TIME ZONE",4.4)

"^DIC",4.501,4.501,0)
NETWORK SENDERS REJECTED^4.501
"^DIC",4.501,4.501,0,"GL")
^XMBX(4.501,
"^DIC",4.501,4.501,"%",0)
^1.005^1^1
"^DIC",4.501,4.501,"%",1,0)
XM
"^DIC",4.501,4.501,"%","B","XM",1)

"^DIC",4.501,4.501,"%D",0)
^^5^5^3020422^^
"^DIC",4.501,4.501,"%D",1,0)
The system manager can input partial or full matches to network addresses
"^DIC",4.501,4.501,"%D",2,0)
into this file.  When Network mail receives a message from a sender that
"^DIC",4.501,4.501,"%D",3,0)
contains the string input, that message will be rejected.  This file can
"^DIC",4.501,4.501,"%D",4,0)
be used to prevent spam or nuisance messages from being received from a
"^DIC",4.501,4.501,"%D",5,0)
remote site.
"^DIC",4.501,"B","NETWORK SENDERS REJECTED",4.501)

"^DIC",4.6,4.6,0)
TRANSMISSION SCRIPT^4.6
"^DIC",4.6,4.6,0,"GL")
^XMB(4.6,
"^DIC",4.6,4.6,"%",0)
^1.005^1^1
"^DIC",4.6,4.6,"%",1,0)
XM
"^DIC",4.6,4.6,"%","B","XM",1)

"^DIC",4.6,4.6,"%D",0)
^^8^8^2890803^^^
"^DIC",4.6,4.6,"%D",1,0)
Transmission scripts are lists of script commands that are executed by
"^DIC",4.6,4.6,"%D",2,0)
the script processor for Network Mail transmissions in order when they
"^DIC",4.6,4.6,"%D",3,0)
are invoked.  The command in a Script that invokes a transmission
"^DIC",4.6,4.6,"%D",4,0)
script is the CALL.  Therefore 'C KERNEL' invokes a script that
"^DIC",4.6,4.6,"%D",5,0)
interfaces with the SMTP (Simple Mail Transfer Protocol) process using
"^DIC",4.6,4.6,"%D",6,0)
the SCP (Simple Communications Protocol).  Transmission scripts are
"^DIC",4.6,4.6,"%D",7,0)
used most often to invoke a portion of a longer script that is used in many 
"^DIC",4.6,4.6,"%D",8,0)
different domains.  It can then be used in many different domains.
"^DIC",4.6,"B","TRANSMISSION SCRIPT",4.6)

**END**
**END**
