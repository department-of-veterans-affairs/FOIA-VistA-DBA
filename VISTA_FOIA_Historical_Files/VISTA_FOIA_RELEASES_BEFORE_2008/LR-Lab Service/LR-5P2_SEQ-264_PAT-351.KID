Released LR*5.2*351 SEQ #264
Extracted from mail message
**KIDS**:LR*5.2*351^

**INSTALL NAME**
LR*5.2*351
"BLD",6597,0)
LR*5.2*351^LAB SERVICE^0^3060110^y
"BLD",6597,1,0)
^^3^3^3060110^^^
"BLD",6597,1,1,0)
This patch corrects 3 reporting problems:  one with the Critical
"BLD",6597,1,2,0)
Value Report, one with Workload Code List Report, and one with
"BLD",6597,1,3,0)
the Print List of Non-Draw Orders.
"BLD",6597,4,0)
^9.64PA^^
"BLD",6597,"ABPKG")
n
"BLD",6597,"KRN",0)
^9.67PA^8989.52^19
"BLD",6597,"KRN",.4,0)
.4
"BLD",6597,"KRN",.401,0)
.401
"BLD",6597,"KRN",.402,0)
.402
"BLD",6597,"KRN",.403,0)
.403
"BLD",6597,"KRN",.5,0)
.5
"BLD",6597,"KRN",.84,0)
.84
"BLD",6597,"KRN",3.6,0)
3.6
"BLD",6597,"KRN",3.8,0)
3.8
"BLD",6597,"KRN",9.2,0)
9.2
"BLD",6597,"KRN",9.8,0)
9.8
"BLD",6597,"KRN",9.8,"NM",0)
^9.68A^3^3
"BLD",6597,"KRN",9.8,"NM",1,0)
LRSORC1A^^0^22179224
"BLD",6597,"KRN",9.8,"NM",2,0)
LRCAPD2^^0^15223324
"BLD",6597,"KRN",9.8,"NM",3,0)
LRNDLST^^0^10625593
"BLD",6597,"KRN",9.8,"NM","B","LRCAPD2",2)

"BLD",6597,"KRN",9.8,"NM","B","LRNDLST",3)

"BLD",6597,"KRN",9.8,"NM","B","LRSORC1A",1)

"BLD",6597,"KRN",19,0)
19
"BLD",6597,"KRN",19.1,0)
19.1
"BLD",6597,"KRN",101,0)
101
"BLD",6597,"KRN",409.61,0)
409.61
"BLD",6597,"KRN",771,0)
771
"BLD",6597,"KRN",870,0)
870
"BLD",6597,"KRN",8989.51,0)
8989.51
"BLD",6597,"KRN",8989.52,0)
8989.52
"BLD",6597,"KRN",8994,0)
8994
"BLD",6597,"KRN","B",.4,.4)

"BLD",6597,"KRN","B",.401,.401)

"BLD",6597,"KRN","B",.402,.402)

"BLD",6597,"KRN","B",.403,.403)

"BLD",6597,"KRN","B",.5,.5)

"BLD",6597,"KRN","B",.84,.84)

"BLD",6597,"KRN","B",3.6,3.6)

"BLD",6597,"KRN","B",3.8,3.8)

"BLD",6597,"KRN","B",9.2,9.2)

"BLD",6597,"KRN","B",9.8,9.8)

"BLD",6597,"KRN","B",19,19)

"BLD",6597,"KRN","B",19.1,19.1)

"BLD",6597,"KRN","B",101,101)

"BLD",6597,"KRN","B",409.61,409.61)

"BLD",6597,"KRN","B",771,771)

"BLD",6597,"KRN","B",870,870)

"BLD",6597,"KRN","B",8989.51,8989.51)

"BLD",6597,"KRN","B",8989.52,8989.52)

"BLD",6597,"KRN","B",8994,8994)

"BLD",6597,"QUES",0)
^9.62^^
"BLD",6597,"REQB",0)
^9.611^2^2
"BLD",6597,"REQB",1,0)
LR*5.2*344^2
"BLD",6597,"REQB",2,0)
LR*5.2*201^2
"BLD",6597,"REQB","B","LR*5.2*201",2)

"BLD",6597,"REQB","B","LR*5.2*344",1)

"MBREQ")
0
"PKG",26,-1)
1^1
"PKG",26,0)
LAB SERVICE^LR^CORE LAB SYSTEM
"PKG",26,20,0)
^9.402P^1^1
"PKG",26,20,1,0)
2^^LRXDRPT
"PKG",26,20,1,1)

"PKG",26,20,"B",2,1)

"PKG",26,22,0)
^9.49I^1^1
"PKG",26,22,1,0)
5.2^2940927^2950304
"PKG",26,22,1,"PAH",1,0)
351^3060110
"PKG",26,22,1,"PAH",1,1,0)
^^3^3^3060110
"PKG",26,22,1,"PAH",1,1,1,0)
This patch corrects 3 reporting problems:  one with the Critical
"PKG",26,22,1,"PAH",1,1,2,0)
Value Report, one with Workload Code List Report, and one with
"PKG",26,22,1,"PAH",1,1,3,0)
the Print List of Non-Draw Orders.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
3
"RTN","LRCAPD2")
0^2^B15223324
"RTN","LRCAPD2",1,0)
LRCAPD2 ;DALISC/FHS - WORKLOAD CODE LIST REPORT ; 12/3/1997
"RTN","LRCAPD2",2,0)
 ;;5.2;LAB SERVICE;**153,201,351**;Sep 27, 1994
"RTN","LRCAPD2",3,0)
EN ;
"RTN","LRCAPD2",4,0)
 W !!?5,"Produce a list of WKLD Code by Lab Section"
"RTN","LRCAPD2",5,0)
 K DIR,ZTSAVE,DX
"RTN","LRCAPD2",6,0)
 S DIR(0)="S^0:All;1:Billable Only",DIR("A")="Select WKLD CODE type to Print ",DIR("B")="Billable" D RDIR G:$G(LREND) CLEAN
"RTN","LRCAPD2",7,0)
 S LRBIL=Y,ZTSAVE("LRBIL")=""
"RTN","LRCAPD2",8,0)
 S DIR(0)="S^1:WORKLOAD LAB SECTION;2:LOCAL ACC AREA"
"RTN","LRCAPD2",9,0)
 S DIR("A")="Sort WKLD CODES By " D RDIR G:$G(LREND) CLEAN
"RTN","LRCAPD2",10,0)
 S LRSEC=Y,ZTSAVE("LRSEC")="" D
"RTN","LRCAPD2",11,0)
 . I Y=2 D  Q:$G(LREND)  S LRAA=Y,ZTSAVE("LRAA")="" Q
"RTN","LRCAPD2",12,0)
 . . S DIR(0)="P^68:QEZM",DIR("A")="Select Local Accession Area"
"RTN","LRCAPD2",13,0)
 . . D RDIR
"RTN","LRCAPD2",14,0)
 . I Y=1 D  Q:$G(LREND)  S LRSECT=Y,ZTSAVE("LRSECT")=""
"RTN","LRCAPD2",15,0)
 . . S DIR(0)="P^64.21:QEZM",DIR("A")="Select WKLD CODE LAB SECTION "
"RTN","LRCAPD2",16,0)
 . . D RDIR
"RTN","LRCAPD2",17,0)
 G:$G(LREND) CLEAN
"RTN","LRCAPD2",18,0)
 S DIR(0)="S^1:Actived Codes Only;0:All WKLD Codes"
"RTN","LRCAPD2",19,0)
 S DIR("A")="Print Activated(reported) or All Codes" D RDIR
"RTN","LRCAPD2",20,0)
 G:$G(LREND) CLEAN
"RTN","LRCAPD2",21,0)
 S LRACT=Y,ZTSAVE("LRACT")=""
"RTN","LRCAPD2",22,0)
 S DIR(0)="S^1:WKLD Name;2:NLT Code Number"
"RTN","LRCAPD2",23,0)
 S DIR("A")="Print report sorted by "
"RTN","LRCAPD2",24,0)
 D RDIR G:$G(LREND) CLEAN
"RTN","LRCAPD2",25,0)
 S LRSORT=Y,ZTSAVE("LRSORT")=""
"RTN","LRCAPD2",26,0)
 ;Q
"RTN","LRCAPD2",27,0)
 K %ZIS S %ZIS="QN",%ZIS("A")="Printer Name " D ^%ZIS G:POP CLEAN
"RTN","LRCAPD2",28,0)
 I IO'=IO(0)!($D(IO("Q"))) D   D ^%ZTLOAD,^%ZISC G CLEAN
"RTN","LRCAPD2",29,0)
 . 
"RTN","LRCAPD2",30,0)
 . S ZTRTN="DQ^LRCAPD2",ZTIO=ION,ZTDESC="PRINT WKLD CODES FROM ^LAB(60 " W !!?10,"Report Queued to "_ION,!
"RTN","LRCAPD2",31,0)
 G DQ
"RTN","LRCAPD2",32,0)
RDIR ;
"RTN","LRCAPD2",33,0)
 S LREND=0 D ^DIR
"RTN","LRCAPD2",34,0)
 S LREND=$S($D(DIRUT):1,$D(DUOUT):1,$D(DIRUT):1,$E(Y)="^":1,1:0)
"RTN","LRCAPD2",35,0)
 K DIR
"RTN","LRCAPD2",36,0)
 Q
"RTN","LRCAPD2",37,0)
DQ ;
"RTN","LRCAPD2",38,0)
 I $D(ZTQUEUED) S ZTREQ="@" K LRDBUG
"RTN","LRCAPD2",39,0)
 K ^TMP("LR",$J)
"RTN","LRCAPD2",40,0)
 S (LRTS,LREND,LRPAG)=0,$P(LRLINE,"_",(IOM+1))=""
"RTN","LRCAPD2",41,0)
 S LRPDT=$TR($$FMTE^XLFDT($$NOW^XLFDT,"1M"),"@"," ")
"RTN","LRCAPD2",42,0)
 ;test list
"RTN","LRCAPD2",43,0)
 W:$E(IOST,1,2)="C-" @IOF
"RTN","LRCAPD2",44,0)
 S LRTSN=0
"RTN","LRCAPD2",45,0)
SCR F  S LRTSN=$O(^LAM(LRTSN)) Q:LRTSN<1  I $D(^(LRTSN,0))#2 S LRX=^(0) D
"RTN","LRCAPD2",46,0)
 . I $G(LRBIL),'$P(LRX,U,5) Q
"RTN","LRCAPD2",47,0)
 . I $G(LRSECT),$P(LRX,U,15)'=+LRSECT Q
"RTN","LRCAPD2",48,0)
 . I $G(LRACT),'$P(LRX,U,17) Q
"RTN","LRCAPD2",49,0)
 . I $G(LRAA),+$G(^(6))'=LRAA Q
"RTN","LRCAPD2",50,0)
 . I LRSORT=1 S ^TMP("LR",$J,$P(LRX,U),$P(LRX,U,2))=LRTSN
"RTN","LRCAPD2",51,0)
 . I LRSORT=2 S ^TMP("LR",$J,$P(LRX,U,2),$P(LRX,U))=LRTSN
"RTN","LRCAPD2",52,0)
PRT K DIR,DR,DA,DX,LREND,ZTSAVE
"RTN","LRCAPD2",53,0)
 S LRGLB="",LRGLB=$O(^TMP("LR",$J,LRGLB)) I LRGLB="" D  G CLEAN
"RTN","LRCAPD2",54,0)
 . W !?10,"No WKLD CODES matched your Screening Criteria",!!
"RTN","LRCAPD2",55,0)
 S LRHEAD0=LRPDT_"   NLT Codes Listed by "_$S(LRSORT=1:"Name ",1:"Code Numbers ")_"     Page "
"RTN","LRCAPD2",56,0)
 S LRHEAD=" Sorted by " D
"RTN","LRCAPD2",57,0)
 . I $G(LRBIL) S LRHEAD=LRHEAD_"Billable Codes "
"RTN","LRCAPD2",58,0)
 . I $G(LRSECT) S LRHEAD=LRHEAD_"By { "_$P(^LAB(64.21,+LRSECT,0),U)_" } WKLD SECTION "
"RTN","LRCAPD2",59,0)
 . I $G(LRACT) S LRHEAD2="Active NLT Codes Only "
"RTN","LRCAPD2",60,0)
 . I '$G(LRACT) S LRHEAD2="Not sorted by Active Codes"
"RTN","LRCAPD2",61,0)
 . I $G(LRAA) S LRHEAD3=$G(LRHEAD2)_"Accession Area "_$P(^LRO(68,+$G(LRAA),0),U)_" "
"RTN","LRCAPD2",62,0)
 D HEAD S LRGLB="^TMP(""LR"","_$J_")",DIC="^LAM(",DR="0:99",S=1
"RTN","LRCAPD2",63,0)
 F  S LRGLB=$Q(@LRGLB) Q:$QS(LRGLB,1)'="LR"!($QS(LRGLB,2)'=$J)!($G(LREND))  D
"RTN","LRCAPD2",64,0)
 . K DA S DA=@LRGLB
"RTN","LRCAPD2",65,0)
 . I $Y>(IOSL-7) D PAUSE Q:$G(LREND)
"RTN","LRCAPD2",66,0)
 . S S=$Y D EN^LRDIQ S:$D(DIRUT) LREND=1
"RTN","LRCAPD2",67,0)
 G CLEAN
"RTN","LRCAPD2",68,0)
 Q
"RTN","LRCAPD2",69,0)
HEAD ;
"RTN","LRCAPD2",70,0)
 S LRPAG=$G(LRPAG)+1
"RTN","LRCAPD2",71,0)
 W $$CJ^XLFSTR(LRHEAD0_LRPAG,IOM)
"RTN","LRCAPD2",72,0)
 W $$CJ^XLFSTR(LRHEAD,IOM)
"RTN","LRCAPD2",73,0)
 I $D(LRHEAD2) W $$CJ^XLFSTR(LRHEAD2,IOM)
"RTN","LRCAPD2",74,0)
 I $D(LRHEAD3) W $$CJ^XLFSTR(LRHEAD3,IOM)
"RTN","LRCAPD2",75,0)
 Q
"RTN","LRCAPD2",76,0)
PAUSE ;
"RTN","LRCAPD2",77,0)
 I $E(IOST)="P" W @IOF D HEAD Q
"RTN","LRCAPD2",78,0)
 Q:$E(IOST,1,2)'="C-"
"RTN","LRCAPD2",79,0)
 K DIR,X,Y S DIR(0)="E" D RDIR Q:$G(LREND)
"RTN","LRCAPD2",80,0)
 W @IOF D HEAD
"RTN","LRCAPD2",81,0)
 Q
"RTN","LRCAPD2",82,0)
CLEAN I $D(ZTQUEUED) S ZTREQ="@"
"RTN","LRCAPD2",83,0)
 Q:$G(LRDBUG)
"RTN","LRCAPD2",84,0)
 W !! W:$E(IOST,1,2)="P-" @IOF
"RTN","LRCAPD2",85,0)
 D ^%ZISC
"RTN","LRCAPD2",86,0)
 K LRHEAD,LRHEAD2,LRHEAD3,LRPDT,LRSEC,LRSECT,LRSORT,LRAA,LRACT,LRBIL
"RTN","LRCAPD2",87,0)
 K %ZIS,DA,DIC,DR,LRI,LRLINE,LRHED,LRI,LRJ,LRK,LRTS,LRTSN,LRX,NAME,NAME1
"RTN","LRCAPD2",88,0)
 K %,LRCC,LREND,X,Y,ZTSK,DTOUT,DUOUT,DIRUT,LRPAG,DIR
"RTN","LRCAPD2",89,0)
 K ^TMP("LR",$J),ZTSAVE,LRGLB,S,DX
"RTN","LRCAPD2",90,0)
 Q
"RTN","LRNDLST")
0^3^B10625593
"RTN","LRNDLST",1,0)
LRNDLST ;SLC/CJS - PRINT LIST OF NON-DRAW ORDERS ;2/19/91  11:03 ;
"RTN","LRNDLST",2,0)
 ;;5.2;LAB SERVICE;**7,13,351**;Sep 27, 1994
"RTN","LRNDLST",3,0)
 S %DT="AE" D ^%DT Q:Y<1  S U="^",LRODT=+Y,LRLLOC="",%ZIS="Q" W !!?10," You may enter 'ALL' as a response",! D FNDLOC^LRDRAW G END:LRLLOC["^"
"RTN","LRNDLST",4,0)
 S LRBEG=1
"RTN","LRNDLST",5,0)
 S %ZIS="QN" D ^%ZIS G:POP END I IO=IO(0) G GO
"RTN","LRNDLST",6,0)
 K IO("Q") S ZTDESC="LONG FORM NO DRAW LIST",ZTIO=ION,ZTRTN="EN^LRNDLST",ZTSAVE("LRODT")="",ZTSAVE("LRLLOC")="",ZTSAVE("LRBEG")="" D ^%ZTLOAD W !!?10,"Report Queued to device "_ION,!
"RTN","LRNDLST",7,0)
END K LROUT,DX(0),S,ZTSK
"RTN","LRNDLST",8,0)
 K DIRUT,J,%DT,%,A,I,K,LRDC,LRSN,X,Y,Z,DIC,%ZIS,LRBECAUS,LRCOMB,LRODT,LRLLOC,LRPGM,LRIO,LRTIME,%H,%X,%Y,DFN,LRDFN,LRDPF,LRIOZERO,LRLWC,PNM,POP,SSN D ^%ZISC
"RTN","LRNDLST",9,0)
 Q
"RTN","LRNDLST",10,0)
% R %:DTIME S:'$T LROUT=1 Q:%=""!(%["N")!(%["Y")  W !,"Answer 'Y' or 'N': " G %
"RTN","LRNDLST",11,0)
GO K X,DX,DR,DIC S DR="0:99",U="^",Y=LRODT,PG=1 D DD^LRX S (LROUT,LRDC)=0
"RTN","LRNDLST",12,0)
 S DX(0)="I $E(IOST)=""C"" S S=$G(S)+1 I S>20 R ""'^' TO HALT: "",W:DTIME S:W=""^"" LROUT=1 S S=W'?1P W @IOF,!! I '$T S S=0,LROUT=1"
"RTN","LRNDLST",13,0)
 I LRLLOC="" F  S LRLLOC=$O(^LRO(69,LRODT,1,"AC",LRLLOC)) Q:LRLLOC=""!(LROUT=1)  S LRTOP=0,LRSN=0 F  S LRSN=$O(^LRO(69,LRODT,1,"AC",LRLLOC,LRSN)) Q:LRSN<1!(LROUT=1)  S LRDC=1 D ORD,PRNT
"RTN","LRNDLST",14,0)
 I LRLLOC'=""&(LROUT=0) S LRTOP=0,LRSN=0 F  S LRSN=$O(^LRO(69,LRODT,1,"AC",LRLLOC,LRSN)) Q:LRSN<1!(LROUT=1)  S LRDC=1 D ORD,PRNT
"RTN","LRNDLST",15,0)
 I 'LRDC W !,"REPORT EMPTY"
"RTN","LRNDLST",16,0)
 W !,"Finished",! W:$E(IOST,1,2)="P-" @IOF
"RTN","LRNDLST",17,0)
 S W="" R:'$G(LRBEG)&($E(IOST)="C") "Hit Enter to return to menu: ",W:DTIME
"RTN","LRNDLST",18,0)
 D ^%ZISC,END Q
"RTN","LRNDLST",19,0)
ORD Q:$G(LROUT)
"RTN","LRNDLST",20,0)
 I $D(^LRO(69,LRODT,1,LRSN,1)),$P(^(1),U,4)="C" Q
"RTN","LRNDLST",21,0)
 I 'LRTOP S PG=1,W="" D
"RTN","LRNDLST",22,0)
 .R:'$G(LRBEG)&($E(IOST)="C") "Enter to CONTINUE or '^' TO HALT: ",W:DTIME
"RTN","LRNDLST",23,0)
 .S:W="^" LROUT=1 Q:$G(LROUT)  W @IOF,!,"LIST OF PATIENT LAB ORDERS NOT DRAWN  "_Y,!!!?10,"LISTING FOR ( ",LRLLOC," ) ",?50,"PG: ",PG,! S LRTOP=1 K LRBEG Q
"RTN","LRNDLST",24,0)
 Q
"RTN","LRNDLST",25,0)
PRNT ;
"RTN","LRNDLST",26,0)
 Q:$G(LROUT)  N S
"RTN","LRNDLST",27,0)
 I $D(^LRO(69,LRODT,1,LRSN,1)),$P(^(1),U,4)="C" Q
"RTN","LRNDLST",28,0)
 I '$L($P(^LRO(69,LRODT,1,LRSN,0),U,4)) Q
"RTN","LRNDLST",29,0)
 I $Y>$S($E(IOST)="C":18,1:60) S PG=PG+1 S W="" R:'$G(LRBEG)&($E(IOST)="C") "Enter to CONTINUE or '^' TO HALT: ",W:DTIME S:W="^" LROUT=1 Q:$G(LROUT)  W @IOF,!!?10,"LISTING FOR ( ",LRLLOC," ) ",?50,"PG: ",PG,!
"RTN","LRNDLST",30,0)
 S DIC="^LRO(69,"_LRODT_",1,",(DA,D0)=LRSN,S=$Y S:'$D(DTOUT) DTOUT=0 D EN^LRDIQ Q:$G(LROUT)  S LROUT=$G(DIRUT) Q
"RTN","LRNDLST",31,0)
EN D GO W:$E(IOST,1,2)="P-" @IOF S:$D(ZTQUEUED) ZTREQ="@" Q
"RTN","LRNDLST",32,0)
 Q
"RTN","LRSORC1A")
0^1^B22179224
"RTN","LRSORC1A",1,0)
LRSORC1A ;DALISC/DRH - LRSORC Continued ;07-22-93
"RTN","LRSORC1A",2,0)
 ;;5.2;LAB SERVICE;**201,344,351**;Sep 27, 1994
"RTN","LRSORC1A",3,0)
INIT ;
"RTN","LRSORC1A",4,0)
 S U="^"
"RTN","LRSORC1A",5,0)
 D CONTROL
"RTN","LRSORC1A",6,0)
 Q
"RTN","LRSORC1A",7,0)
CONTROL ;
"RTN","LRSORC1A",8,0)
 D SORT
"RTN","LRSORC1A",9,0)
 Q
"RTN","LRSORC1A",10,0)
SORT ;
"RTN","LRSORC1A",11,0)
 W:$E(IOST,1,2)="C-" @IOF
"RTN","LRSORC1A",12,0)
 W:$E(IOST,1,2)="P-" !
"RTN","LRSORC1A",13,0)
 D HDR
"RTN","LRSORC1A",14,0)
 D PRINT
"RTN","LRSORC1A",15,0)
 D:'LREND SUMMARY
"RTN","LRSORC1A",16,0)
 D END
"RTN","LRSORC1A",17,0)
 Q
"RTN","LRSORC1A",18,0)
SUMMARY ;
"RTN","LRSORC1A",19,0)
 I ($Y>(IOSL-7)) D:$E(IOST,1,2)="C-" WAIT Q:LREND  W @IOF D HDR
"RTN","LRSORC1A",20,0)
 F I=$Y:1:(IOSL-6) W !
"RTN","LRSORC1A",21,0)
 W ?20,"END OF SPECIAL REPORT"
"RTN","LRSORC1A",22,0)
 Q
"RTN","LRSORC1A",23,0)
END ;
"RTN","LRSORC1A",24,0)
 D:($E(IOST,1,2)="C-")&('LREND) WAIT
"RTN","LRSORC1A",25,0)
 W @IOF D:'$D(ZTQUEUED) ^%ZISC
"RTN","LRSORC1A",26,0)
 K ^TMP("LR",$J)
"RTN","LRSORC1A",27,0)
 K ZTRTN,ZTIO,ZTDESC,ZTSAVE,ZTSK,ZTQUEUED,%ZIS,POP,%H,%DT,DTOUT,DUOUT
"RTN","LRSORC1A",28,0)
 K DIR,DIC,I,T,C,X,Y,L0,SEX,AGE,DFN,DOB,PNM,SSN,VA("BID"),VA("PID"),VAERR
"RTN","LRSORC1A",29,0)
 K LRAA,LRAD,LRDFN,LRDPF,LREND,LRFAN,LRIDT,LRLAN,LRLCS,LRSUB1,LRSUB2
"RTN","LRSORC1A",30,0)
 K LRLLOC,LRTX,LRTST,LRTVAL,LRCRTFLG,LRAN,LRSRT,LRPAG,LRDATE,LRDASH,LRDAT
"RTN","LRSORC1A",31,0)
 K LRLOC,LRPTS,LREDT,LRPDT,LRSDT,LRTREC,LRPREC,LREDAT,LRSDAT,LRSPDAT
"RTN","LRSORC1A",32,0)
 K LRWRD,LRHDR2,LRSUB3,LRAAA
"RTN","LRSORC1A",33,0)
 Q
"RTN","LRSORC1A",34,0)
PRINT ;
"RTN","LRSORC1A",35,0)
 S LRSUB1=""
"RTN","LRSORC1A",36,0)
 I $O(^TMP("LR",$J,LRSUB1))="" W !!?30,"NO MATCHING DATA FOUND",!! Q
"RTN","LRSORC1A",37,0)
 F  S LRSUB1=$O(^TMP("LR",$J,LRSUB1)) Q:(LRSUB1="")!(LREND)  D
"RTN","LRSORC1A",38,0)
 .S LRSUB2=""
"RTN","LRSORC1A",39,0)
 .F  S LRSUB2=$O(^TMP("LR",$J,LRSUB1,LRSUB2)) Q:(LRSUB2="")!(LREND)  D
"RTN","LRSORC1A",40,0)
 ..S LRSUB3=""
"RTN","LRSORC1A",41,0)
 ..F  S LRSUB3=$O(^TMP("LR",$J,LRSUB1,LRSUB2,LRSUB3)) Q:(LRSUB3="")!(LREND)  D
"RTN","LRSORC1A",42,0)
 ...S LRAN=""
"RTN","LRSORC1A",43,0)
 ...F  S LRAN=$O(^TMP("LR",$J,LRSUB1,LRSUB2,LRSUB3,LRAN)) Q:(LRAN="")!(LREND)  D
"RTN","LRSORC1A",44,0)
 ....S LRPREC=^TMP("LR",$J,LRSUB1,LRSUB2,LRSUB3,LRAN)
"RTN","LRSORC1A",45,0)
 ....S LRDPF=$P(LRPREC,U,4)
"RTN","LRSORC1A",46,0)
 ....S PNM=$P(LRPREC,U),SSN=$P(LRPREC,U,2),LRLOC=$P(LRPREC,U,3)
"RTN","LRSORC1A",47,0)
 ....S LRSPEC=$P(^LAB(61,$P(LRPREC,U,6),0),U)
"RTN","LRSORC1A",48,0)
 ....S LRSPNUM=$P(LRPREC,U,6)
"RTN","LRSORC1A",49,0)
 ....S LRSPDAT=$P(LRPREC,U,5)
"RTN","LRSORC1A",50,0)
 ....I ($Y>(IOSL-8)) D:$E(IOST,1,2)="C-" WAIT Q:LREND  W @IOF D HDR
"RTN","LRSORC1A",51,0)
 ....;S PNM1=$P(PNM,","),PNM2=$P(PNM,",",2)
"RTN","LRSORC1A",52,0)
 ....;S LRCHNG=PNM1 D CHNCASE^LRSORA2 S PNM1=LRCHNG
"RTN","LRSORC1A",53,0)
 ....;S LRCHNG=PNM2 D CHNCASE^LRSORA2 S PNM2=LRCHNG
"RTN","LRSORC1A",54,0)
 ....;S PNM=PNM1_","_PNM2
"RTN","LRSORC1A",55,0)
 ....;S LRCHNG=LRSPEC D CHNCASE^LRSORA2 S LRSPEC=LRCHNG
"RTN","LRSORC1A",56,0)
 ....W !,$E(PNM,1,23),?25,SSN W:LRDPF=2 " ",LRLOC,?50,$E(LRAN,1,14)
"RTN","LRSORC1A",57,0)
 ....W ?62,LRSPDAT
"RTN","LRSORC1A",58,0)
 ....W !," ",LRSPEC
"RTN","LRSORC1A",59,0)
 ....D PRNTST
"RTN","LRSORC1A",60,0)
 Q
"RTN","LRSORC1A",61,0)
PRNTST ;
"RTN","LRSORC1A",62,0)
 N LRRLO,LRRHI,LRCLO,LRCHI,LRTLO,LRTHI,LRFLAG,VAR
"RTN","LRSORC1A",63,0)
 S I=""
"RTN","LRSORC1A",64,0)
 F  S I=$O(^TMP("LR",$J,LRSUB1,LRSUB2,LRSUB3,LRAN,"TST",I)) Q:(I="")!(LREND)  D
"RTN","LRSORC1A",65,0)
 .S LRTREC=^TMP("LR",$J,LRSUB1,LRSUB2,LRSUB3,LRAN,"TST",I)
"RTN","LRSORC1A",66,0)
 .S LRTST=$P(LRTREC,U),LRTVAL=$P(LRTREC,U,2),LRCRTFLG=$P(LRTREC,U,3)
"RTN","LRSORC1A",67,0)
 .I ($Y>(IOSL-7)) D
"RTN","LRSORC1A",68,0)
 ..D CONT D:$E(IOST,1,2)="C-" WAIT Q:LREND
"RTN","LRSORC1A",69,0)
 ..W @IOF D HDR
"RTN","LRSORC1A",70,0)
 ..W !,$E(PNM,1,23),?25,SSN W:LRDPF=2 " ",LRLOC,?50,$E(LRAN,1,14)
"RTN","LRSORC1A",71,0)
 ..W ?62,LRSPDAT
"RTN","LRSORC1A",72,0)
 .Q:LREND
"RTN","LRSORC1A",73,0)
 .S LRTX=$P(LRTREC,U,5)
"RTN","LRSORC1A",74,0)
 .S LRFLAG=$P(LRTREC,U,6)
"RTN","LRSORC1A",75,0)
 .S LRREF=$G(^LAB(60,LRTX,1,LRSPNUM,0))
"RTN","LRSORC1A",76,0)
 .; set ranges  LRFLAG on - from file 63     LRFLAG off - from file 60
"RTN","LRSORC1A",77,0)
 .S LRRLO=$S(LRFLAG:$P(LRTREC,U,7),1:$P(LRREF,U,2))
"RTN","LRSORC1A",78,0)
 .S LRRHI=$S(LRFLAG:$P(LRTREC,U,8),1:$P(LRREF,U,3))
"RTN","LRSORC1A",79,0)
 .S LRCLO=$S(LRFLAG:$P(LRTREC,U,9),1:$P(LRREF,U,4))
"RTN","LRSORC1A",80,0)
 .S LRCHI=$S(LRFLAG:$P(LRTREC,U,10),1:$P(LRREF,U,5))
"RTN","LRSORC1A",81,0)
 .S LRTLO=$S(LRFLAG:$P(LRTREC,U,11),1:$P(LRREF,U,11))
"RTN","LRSORC1A",82,0)
 .S LRTHI=$S(LRFLAG:$P(LRTREC,U,12),1:$P(LRREF,U,12))
"RTN","LRSORC1A",83,0)
 .F VAR="LRRLO","LRRHI","LRCLO","LRCHI" I @VAR="" S @VAR="none"
"RTN","LRSORC1A",84,0)
 .;
"RTN","LRSORC1A",85,0)
 .S LRTST=$P($G(^LAB(60,LRTX,.1)),U)
"RTN","LRSORC1A",86,0)
 .I LRTST="" S LRTST=$E($P(^LAB(60,LRTX,0),U),1,10)
"RTN","LRSORC1A",87,0)
 .;I 'LRTST S LRTST=$E($P(^LAB(60,LRTX,0),U),1,10)
"RTN","LRSORC1A",88,0)
 .;S LRCHNG=LRTST D CHNCASE^LRSORA2 S LRTST=LRCHNG
"RTN","LRSORC1A",89,0)
 .W !,?2,$E(LRTST,1,9),?12,$J(LRTVAL,6)
"RTN","LRSORC1A",90,0)
 .W ?19,$E($P(LRREF,U,7),1,10),?28,LRCRTFLG
"RTN","LRSORC1A",91,0)
 . I 'LRTLO,('LRTHI) D RANGE
"RTN","LRSORC1A",92,0)
 . I LRTLO W ?32,"Ther: ",LRTLO,"-"
"RTN","LRSORC1A",93,0)
 . I LRTHI W LRTHI D CRITICL
"RTN","LRSORC1A",94,0)
 I '$O(^TMP("LR",$J,LRSUB1,LRSUB2,LRSUB3,LRAN,"COM",0)) W !
"RTN","LRSORC1A",95,0)
 E  D COM
"RTN","LRSORC1A",96,0)
 Q
"RTN","LRSORC1A",97,0)
COM ;Print comments on specimen
"RTN","LRSORC1A",98,0)
 W !,"COMMENT(S): "
"RTN","LRSORC1A",99,0)
 S C=""
"RTN","LRSORC1A",100,0)
 F  S C=$O(^TMP("LR",$J,LRSUB1,LRSUB2,LRSUB3,LRAN,"COM",C)) Q:(C="")!(LREND)  D
"RTN","LRSORC1A",101,0)
 .I ($Y>(IOSL-7)) D
"RTN","LRSORC1A",102,0)
 ..D CONT D:$E(IOST,1,2)="C-" WAIT Q:LREND
"RTN","LRSORC1A",103,0)
 ..W @IOF D HDR
"RTN","LRSORC1A",104,0)
 ..W !,$E(PNM,1,23),?25,SSN W:LRDPF=2 " ",LRLOC,?50,$E(LRAN,1,14)
"RTN","LRSORC1A",105,0)
 ..W ?62,LRSPDAT
"RTN","LRSORC1A",106,0)
 ..;W !,PNM,?35,SSN W:LRDPF=2 " ",LRLOC,?60,LRAN
"RTN","LRSORC1A",107,0)
 ..;D HDR
"RTN","LRSORC1A",108,0)
 ..W !,"COMMENT(S): "
"RTN","LRSORC1A",109,0)
 .Q:LREND
"RTN","LRSORC1A",110,0)
 .W ?12,^TMP("LR",$J,LRSUB1,LRSUB2,LRSUB3,LRAN,"COM",C),!
"RTN","LRSORC1A",111,0)
 Q
"RTN","LRSORC1A",112,0)
HDR ;
"RTN","LRSORC1A",113,0)
 S LRPAG=LRPAG+1
"RTN","LRSORC1A",114,0)
 W "SPECIAL REPORT: SEARCHING FOR CRITICAL FLAGS  "
"RTN","LRSORC1A",115,0)
 W LRDATE,?65,"Pg ",LRPAG,!,LRHDR2,!
"RTN","LRSORC1A",116,0)
 D LRGLIN^LRX
"RTN","LRSORC1A",117,0)
 Q
"RTN","LRSORC1A",118,0)
RANGE ;
"RTN","LRSORC1A",119,0)
 W ?31,"Ref. Range: ",LRRLO,"-",LRRHI
"RTN","LRSORC1A",120,0)
 D CRITICL
"RTN","LRSORC1A",121,0)
 Q
"RTN","LRSORC1A",122,0)
CRITICL ;
"RTN","LRSORC1A",123,0)
 W ?57,"Critical: ",LRCLO,"-",LRCHI
"RTN","LRSORC1A",124,0)
 Q
"RTN","LRSORC1A",125,0)
WAIT ;
"RTN","LRSORC1A",126,0)
 K DIR S DIR(0)="E" D ^DIR
"RTN","LRSORC1A",127,0)
 S:($D(DTOUT))!($D(DUOUT)) LREND=1
"RTN","LRSORC1A",128,0)
 Q
"RTN","LRSORC1A",129,0)
CONT W !?10,"CONTINUED NEXT PAGE",! Q
"VER")
8.0^22.0
"BLD",6597,6)
^264
**END**
**END**
