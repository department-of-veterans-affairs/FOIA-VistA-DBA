Released IB*2*190 SEQ #186
Extracted from mail message
**KIDS**:IB*2.0*190^

**INSTALL NAME**
IB*2.0*190
"BLD",4227,0)
IB*2.0*190^INTEGRATED BILLING^0^3030109^y
"BLD",4227,1,0)
^9.61A^1^1^3020820^^^
"BLD",4227,1,1,0)
REMOVE SSN FROM COPAY EXEMPT LETTERS
"BLD",4227,4,0)
^9.64PA^^
"BLD",4227,"ABPKG")
n
"BLD",4227,"KRN",0)
^9.67PA^8989.52^19
"BLD",4227,"KRN",.4,0)
.4
"BLD",4227,"KRN",.4,"NM",0)
^9.68A^^
"BLD",4227,"KRN",.401,0)
.401
"BLD",4227,"KRN",.402,0)
.402
"BLD",4227,"KRN",.403,0)
.403
"BLD",4227,"KRN",.5,0)
.5
"BLD",4227,"KRN",.84,0)
.84
"BLD",4227,"KRN",3.6,0)
3.6
"BLD",4227,"KRN",3.8,0)
3.8
"BLD",4227,"KRN",9.2,0)
9.2
"BLD",4227,"KRN",9.8,0)
9.8
"BLD",4227,"KRN",9.8,"NM",0)
^9.68A^1^1
"BLD",4227,"KRN",9.8,"NM",1,0)
IBARXEPL^^0^B25112783
"BLD",4227,"KRN",9.8,"NM","B","IBARXEPL",1)

"BLD",4227,"KRN",19,0)
19
"BLD",4227,"KRN",19.1,0)
19.1
"BLD",4227,"KRN",101,0)
101
"BLD",4227,"KRN",409.61,0)
409.61
"BLD",4227,"KRN",771,0)
771
"BLD",4227,"KRN",870,0)
870
"BLD",4227,"KRN",8989.51,0)
8989.51
"BLD",4227,"KRN",8989.52,0)
8989.52
"BLD",4227,"KRN",8994,0)
8994
"BLD",4227,"KRN","B",.4,.4)

"BLD",4227,"KRN","B",.401,.401)

"BLD",4227,"KRN","B",.402,.402)

"BLD",4227,"KRN","B",.403,.403)

"BLD",4227,"KRN","B",.5,.5)

"BLD",4227,"KRN","B",.84,.84)

"BLD",4227,"KRN","B",3.6,3.6)

"BLD",4227,"KRN","B",3.8,3.8)

"BLD",4227,"KRN","B",9.2,9.2)

"BLD",4227,"KRN","B",9.8,9.8)

"BLD",4227,"KRN","B",19,19)

"BLD",4227,"KRN","B",19.1,19.1)

"BLD",4227,"KRN","B",101,101)

"BLD",4227,"KRN","B",409.61,409.61)

"BLD",4227,"KRN","B",771,771)

"BLD",4227,"KRN","B",870,870)

"BLD",4227,"KRN","B",8989.51,8989.51)

"BLD",4227,"KRN","B",8989.52,8989.52)

"BLD",4227,"KRN","B",8994,8994)

"BLD",4227,"QUES",0)
^9.62^^
"BLD",4227,"REQB",0)
^9.611^^
"MBREQ")
0
"PKG",200,-1)
1^1
"PKG",200,0)
INTEGRATED BILLING^IB^INTEGRATED BILLING
"PKG",200,20,0)
^9.402P^1^1
"PKG",200,20,1,0)
2^^IBAXDR
"PKG",200,20,1,1)

"PKG",200,20,"B",2,1)

"PKG",200,22,0)
^9.49I^1^1
"PKG",200,22,1,0)
2.0^2940321^2990406^2447
"PKG",200,22,1,"PAH",1,0)
190^3030109
"PKG",200,22,1,"PAH",1,1,0)
^^1^1^3030109
"PKG",200,22,1,"PAH",1,1,1,0)
REMOVE SSN FROM COPAY EXEMPT LETTERS
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
1
"RTN","IBARXEPL")
0^1^B25112783
"RTN","IBARXEPL",1,0)
IBARXEPL ;ALB/AAS - PRINT EXEMPTION LETTER - 28-APR-93
"RTN","IBARXEPL",2,0)
 ;;2.0;INTEGRATED BILLING;**34,54,190**;21-MAR-94
"RTN","IBARXEPL",3,0)
 ;;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","IBARXEPL",4,0)
 ;
"RTN","IBARXEPL",5,0)
% I '$D(DT) D DT^DICRW
"RTN","IBARXEPL",6,0)
 I '$D(IOF) D HOME^%ZIS
"RTN","IBARXEPL",7,0)
 W @IOF,"Print Exemption letters to patients"
"RTN","IBARXEPL",8,0)
 K ^TMP("IBEX LIST",$J)
"RTN","IBARXEPL",9,0)
 S (IBTEMP,IBADDT,IBOK,IBQUIT)=""
"RTN","IBARXEPL",10,0)
 ;
"RTN","IBARXEPL",11,0)
 ; -- find template
"RTN","IBARXEPL",12,0)
 S IBTEMP=$O(^DIBT("B","IB EXEMPTION LETTER",0))
"RTN","IBARXEPL",13,0)
 ;
"RTN","IBARXEPL",14,0)
 ; -- use old template or build new one
"RTN","IBARXEPL",15,0)
 W !!!
"RTN","IBARXEPL",16,0)
 ;
"RTN","IBARXEPL",17,0)
 I IBTEMP D  G:IBQUIT END
"RTN","IBARXEPL",18,0)
 .S DIR(0)="Y",DIR("A")="Delete Results of Previous Search",DIR("B")="NO"
"RTN","IBARXEPL",19,0)
 .S DIR("?")="Enter 'Yes' if you would like to delete the results of a previous search, Enter 'No' if you want to keep the results (i.e. you may be reprinting letters from the same list)."
"RTN","IBARXEPL",20,0)
 .D ^DIR K DIR I $D(DIRUT) S IBQUIT=1
"RTN","IBARXEPL",21,0)
 .I Y=1 D DELT S IBTEMP=0
"RTN","IBARXEPL",22,0)
 .Q
"RTN","IBARXEPL",23,0)
 ;
"RTN","IBARXEPL",24,0)
 I 'IBTEMP D  G:IBQUIT END D:IBADD ADDT
"RTN","IBARXEPL",25,0)
 .S DIR(0)="Y",DIR("A")="Store results of Search in Template",DIR("B")="YES"
"RTN","IBARXEPL",26,0)
 .S DIR("?")="Enter 'Yes' if you would like the results of the search stored in a Sort Template named IB EXEMPTION LETTER.  Enter 'No' if you do not want the template created."
"RTN","IBARXEPL",27,0)
 .S DIR("?",1)="Creating the search template will allow you to",DIR("?",2)="print other lists from the patients you sent the letters to."
"RTN","IBARXEPL",28,0)
 .S DIR("?",3)=" "
"RTN","IBARXEPL",29,0)
 .D ^DIR K DIR I $D(DIRUT) S IBQUIT=1 Q
"RTN","IBARXEPL",30,0)
 .S IBADD=Y
"RTN","IBARXEPL",31,0)
 .Q
"RTN","IBARXEPL",32,0)
 ;
"RTN","IBARXEPL",33,0)
 D PRINT
"RTN","IBARXEPL",34,0)
 ;
"RTN","IBARXEPL",35,0)
END I $D(ZTQUEUED) Q
"RTN","IBARXEPL",36,0)
 D ^%ZISC,KVAR^VADPT
"RTN","IBARXEPL",37,0)
 K C,J,X,Y,D0,DIC,DA,DR,DIE,DFN,DLAYGO,DIR,DIRUT,IB,IBADD,IBADDT,IBTEMP
"RTN","IBARXEPL",38,0)
 K IBOK,IBLET,IBCNT,IBCNTL,IBQUIT,IBNAM,IBDATA,IBJ,IBX,TAB,POP,IBALIN
"RTN","IBARXEPL",39,0)
 K BY,DHD,DIOEND,FLDS,FR,I,L,TO,VAPA,^TMP("IBEX LIST",$J)
"RTN","IBARXEPL",40,0)
 Q
"RTN","IBARXEPL",41,0)
 ;
"RTN","IBARXEPL",42,0)
ADDT ; -- create new template in ^dibt
"RTN","IBARXEPL",43,0)
 K DD,DO
"RTN","IBARXEPL",44,0)
 S DIC="^DIBT(",DIC(0)="L",X="IB EXEMPTION LETTER",DIC("DR")="2///NOW;4///354;7///NOW"
"RTN","IBARXEPL",45,0)
 D FILE^DICN S IBTEMP=+Y I +Y S IBADDT=1 W !!,"<<< Search Template IB EXEMPTION LETTER created!",!
"RTN","IBARXEPL",46,0)
 Q
"RTN","IBARXEPL",47,0)
 ;
"RTN","IBARXEPL",48,0)
DELT ; -- delete search template
"RTN","IBARXEPL",49,0)
 Q:$P($G(^DIBT(+IBTEMP,0)),"^",1)'="IB EXEMPTION LETTER"
"RTN","IBARXEPL",50,0)
 S DIK="^DIBT(",DA=IBTEMP D ^DIK K DIK,DA
"RTN","IBARXEPL",51,0)
 W !!,"<<< Search Template IB EXEMPTION LETTER deleted!",!
"RTN","IBARXEPL",52,0)
 S IBTEMP=""
"RTN","IBARXEPL",53,0)
 Q
"RTN","IBARXEPL",54,0)
 ;
"RTN","IBARXEPL",55,0)
SCR ; -- don't send letters to deceased patients, non-vets
"RTN","IBARXEPL",56,0)
 ;    called by print template IB DO NOT USE
"RTN","IBARXEPL",57,0)
 S IBOK=0 N IBX
"RTN","IBARXEPL",58,0)
 I +$G(^DPT(D0,.35)) G SCRQ ; deceased
"RTN","IBARXEPL",59,0)
 I $P($G(^DPT(D0,"VET")),"^")="N" G SCRQ ; patient non-vet
"RTN","IBARXEPL",60,0)
 S IBX=$P($G(^IBE(354.2,+$P($G(^IBA(354,D0,0)),"^",5),0)),"^",5)
"RTN","IBARXEPL",61,0)
 I IBX=60 G SCRQ ;exemption is non-vet
"RTN","IBARXEPL",62,0)
 I IBX=10 G SCRQ ;sc>50
"RTN","IBARXEPL",63,0)
 S IBOK=1
"RTN","IBARXEPL",64,0)
SCRQ Q
"RTN","IBARXEPL",65,0)
 ;
"RTN","IBARXEPL",66,0)
PRINT ; -- run through list of letters to PRINT
"RTN","IBARXEPL",67,0)
 S X="IB NOW EXEMPT",DIC(0)="XZ",DIC="^IBE(354.6," D ^DIC S IBLET=+Y
"RTN","IBARXEPL",68,0)
 Q:IBLET<1
"RTN","IBARXEPL",69,0)
 ;
"RTN","IBARXEPL",70,0)
 S DIC="^IBA(354,",L=0,FLDS="[IB DO NOT USE]",BY="[IB EXEMPT PATIENTS]",(FR,TO)="?,?,?",DHD="@@"
"RTN","IBARXEPL",71,0)
 S DIOEND="D LET^IBARXEPL"
"RTN","IBARXEPL",72,0)
 D EN1^DIP
"RTN","IBARXEPL",73,0)
 Q
"RTN","IBARXEPL",74,0)
 ;
"RTN","IBARXEPL",75,0)
LET ; -- called by dioend, prints list from tmp array
"RTN","IBARXEPL",76,0)
 S IBALIN=$P($G(^IBE(354.6,IBLET,0)),"^",4)
"RTN","IBARXEPL",77,0)
 I IBALIN<10!(IBALIN>25) S IBALIN=15
"RTN","IBARXEPL",78,0)
 S IBNAM="" F  S IBNAM=$O(^TMP("IBEX LIST",$J,IBNAM)) Q:IBNAM=""!(IBQUIT)  S DFN=0 F  S DFN=$O(^TMP("IBEX LIST",$J,IBNAM,DFN)) Q:'DFN!(IBQUIT)  S IBDATA=^(DFN) D ONE
"RTN","IBARXEPL",79,0)
 D FINAL,END
"RTN","IBARXEPL",80,0)
 Q
"RTN","IBARXEPL",81,0)
 ;
"RTN","IBARXEPL",82,0)
ONE ; -- print one letter
"RTN","IBARXEPL",83,0)
 S TAB=5
"RTN","IBARXEPL",84,0)
 I '$D(IOF) D HOME^%ZIS
"RTN","IBARXEPL",85,0)
 S IBCNTL=$G(IBCNTL)+1 I $E(IOST,1,2)="C-" W @IOF
"RTN","IBARXEPL",86,0)
 S IB=0
"RTN","IBARXEPL",87,0)
 ;
"RTN","IBARXEPL",88,0)
 ; -- print header
"RTN","IBARXEPL",89,0)
 S IBCNT=0
"RTN","IBARXEPL",90,0)
 F I=1:1:6 S IB=$O(^IBE(354.6,IBLET,2,IB)) Q:'IB  S X=$G(^(IB,0)) W !?(IOM-$L(X)+1/2),X S IBCNT=IBCNT+1
"RTN","IBARXEPL",91,0)
 W !?TAB S Y=DT D DT^DIQ S IBCNT=IBCNT+1
"RTN","IBARXEPL",92,0)
 F IBCNT=IBCNT:1:6 W ! S IBCNT=IBCNT+1
"RTN","IBARXEPL",93,0)
 W !?(IOM-28),"In Reply Refer To:" S IBCNT=IBCNT+1
"RTN","IBARXEPL",94,0)
 W !?(IOM-28),$E($P(IBDATA,"^")),$P($P(IBDATA,"^",2),"-",3),!
"RTN","IBARXEPL",95,0)
 S IBCNT=IBCNT+2
"RTN","IBARXEPL",96,0)
 S IBX=$$RXST^IBARXEU(DFN,DT) I $P($G(^IBE(354.6,IBLET,0)),"^",3)'=2,$P(IBX,"^",3)=120 S Y=$$PLUS^IBARXEU0($P(IBX,"^",5)) W ?(IOM-28),"Renewal Date: " D DT^DIQ
"RTN","IBARXEPL",97,0)
 ;
"RTN","IBARXEPL",98,0)
 ; -- print pt. name and address
"RTN","IBARXEPL",99,0)
 F IBCNT=IBCNT:1:(IBALIN-1) W !
"RTN","IBARXEPL",100,0)
 W !?TAB,$P(IBNAM,",",2)," ",$P(IBNAM,",") D ADD^VADPT S IBCNT=IBCNT+1
"RTN","IBARXEPL",101,0)
 W !?TAB,VAPA(1) S IBCNT=IBCNT+1
"RTN","IBARXEPL",102,0)
 I VAPA(2)'="" W !?TAB,VAPA(2) I VAPA(3)'="" W ", ",VAPA(3) S IBCNT=IBCNT+1
"RTN","IBARXEPL",103,0)
 W !?TAB,VAPA(4),", ",$P($G(^DIC(5,+VAPA(5),0)),"^",2),"  ",VAPA(6) S IBCNT=IBCNT+1
"RTN","IBARXEPL",104,0)
 I $E(IOST,1,2)="C-" D PAUSE^IBOUTL Q:IBQUIT
"RTN","IBARXEPL",105,0)
 ;
"RTN","IBARXEPL",106,0)
 ; -- print main body
"RTN","IBARXEPL",107,0)
 W !! S IBCNT=IBCNT+2
"RTN","IBARXEPL",108,0)
 K ^UTILITY($J,"W"),DIWR,DIWL,DIWF,DN S DIWL=1,DIWF="C80WN"
"RTN","IBARXEPL",109,0)
 S IB=0 F  S IB=$O(^IBE(354.6,IBLET,1,IB)) Q:IB=""  S X=$G(^(IB,0)) D ^DIWP S IBCNT=IBCNT+1 ; W !,X
"RTN","IBARXEPL",110,0)
 D ^DIWW K ^UTILITY($J,"W")
"RTN","IBARXEPL",111,0)
 I $E(IOST,1,2)="C-" D PAUSE^IBOUTL Q:IBQUIT
"RTN","IBARXEPL",112,0)
 W:$E(IOST,1,2)'="C-" @IOF
"RTN","IBARXEPL",113,0)
 Q
"RTN","IBARXEPL",114,0)
 ;
"RTN","IBARXEPL",115,0)
FINAL ; -- Print last page
"RTN","IBARXEPL",116,0)
 W @IOF,!!!,?20,"EXEMPTION LETTERS PRINTING COMPLETED"
"RTN","IBARXEPL",117,0)
 W !!,?20,$G(IBCNTL)," LETTERS PRINTED"
"RTN","IBARXEPL",118,0)
 Q
"VER")
8.0^22
**END**
**END**
