$TXT Created by HOLLOWAY,THOMAS at MNTVBB.FO-WASH.MED.VA.GOV  (KIDS) on Monday, 05/21/07 at 12:44
=============================================================================
Run Date: JUL 12, 2007                     Designation: PRC*5.1*108
Package : PRC - IFCAP                         Priority: Mandatory
Version : 5.1        SEQ #94                    Status: Released
                  Compliance Date: AUG 12, 2007
=============================================================================

Associated patches: (v)PRC*5.1*1   <<= must be installed BEFORE `PRC*5.1*108'
                    (v)PRC*5.1*79  <<= must be installed BEFORE `PRC*5.1*108'
                    (v)PRC*5.1*100 <<= must be installed BEFORE `PRC*5.1*108'

Subject: IFCAP MAINTENANCE PATCH Q4-FY07

Category: 
  - Routine
  - Data Dictionary
  - Input Template

Description:
============

 This patch will address seven unrelated maintenance items.
  
 The first issue is a problem with the input transform for the Appropriation
 field in the FUND DISTRIBUTION file [#421].
  
 The second issue involves allowing all users of the New Detailed Purchase Card
 Order option to enter an Item Discount.
   
 The third item corrects a program crash when using ? to get help text.
   
 The fourth issue covers a problem with the CONTRACT/BOA # field when making
 a Change Vendor type amendment.
   
 The fifth issue relates to that same CONTRACT/BOA # field but this time when
 trying an ^ jump when editing an incomplete order.
   
 The sixth fix adjusts the Purchase Card limit to $3,000.
   
 The seventh fix corrects some spelling errors in the 'Non-SS Order Builder'
 option.
   
 ASSOCIATED REMEDY TICKETS: 
 =========================
 1.  HD55644  -  PUG-1004-52205 Input Transform limiting characters on Report
 2.  HD181864 -  Track for patch 108
 3.  HD139884 -  <UNDEFINDED>HELP+1^PRCPUYN
 4.  HD152247 -  Amendment Error <UNDEFINED>V^DIED
 5.  HD178733 -  <UNDEFINED>EN10+7^PRCHNPO7 - Jumping in template causing X
                 to be defined incorrectly
 6.  HD186714 -  Purchase Card Issue - CONVERT 2237 to PC REQUEST > $2500
 7.  HD183722 -  PRCP NON-SS ORDER BULIDER -- Misspelled
  
 PARTICIPATING TEST SITES:
 =========================
 N. FLA/GA.
 N. Texas
 NorthPort, NY    
  
 REMEDY OVERVIEW:
 ================
  
 1.  HD55644 - PUG-1004-52205  Input Transform limiting characters on Report
  
 Problem:
 -----------
 User noticed that the report generated with the Appropriation Summary Totals
 option [PRCB APPROP SUMMARY (TOTALS)] cuts off the last 2-3 digits of the
 Appropriation field.  The option calls routine EN6^PRCBP which runs a print
 template for the FUND DISTRIBUTION file [#421].  The Input Transform on the
 Appropriation field [#13.5] in file #421 allows 4-25 characters. This field
 is printed as a header wherever the Appropriation changes.
  
 Resolution:
 ------------
 A change was made to the Input Transform of the Appropriation field [#13.5] in
 the FUND DISTRIBUTION file [#421] to allow for 4 - 30 characters in length.
   
 Item affected:
 Data Dictionary entry for the Input Transform for the APPROPRIATION field
 [#13.5] of the FUND DISTRIBUTION file [#421].
  
  
 2.  HD181864  -  Track for patch 108
  
 Problem:
 -----------
 Currently only a user set up as a Purchasing Agent is prompted to enter an
 Item Discount when creating a purchase card order using the option New
 Detailed Purchase Card Order [PRCH ENTER DETAILED ORDER].  This functionality
 is being changed so that non-Purchasing Agent users will be prompted to add
 an Item Discount.
  
 Resolution:
 -----------
 Made a minor change to the code to allow users of this option to enter the
 Item Discount input template when running the option.
   
 Items affected:  routine PRCHNPO1
  
  
 3. HD139884  -  <UNDEFINDED>HELP+1^PRCPUYN
   
 Problem:
 -----------
 When running the Supply Station Quantity Discrepancy report [PRCP SS QTY
 DISCREPANCIES], if you enter a question mark at the "Do you want to request
 a refresh of the supply station QOH?" prompt, you will cause the program to
 crash.  While examining this problem a couple of grammatical mistakes were
 noted in some related help text.  Those items were included in this fix.
   
 Resolution:
 -----------
 The code which handles the printing of the help text needed a slight
 modification to accept a wider variety of text formats.  The help text will
 now print properly without causing the program crash.  The spelling and
 formatting problems which were discovered while working this ticket were
 corrected.
   
 Items affected:  routines PRCPUYN, PRCPURS3 and PRCPAGP0
   
   
 4.  HD152247  -  Amendment Error <UNDEFINED>V^DIED
   
 Problem:
 -----------
 When running the Amendment to Purchase Order [PRCHPC AMEND] option and
 selecting 11 - Change VENDOR at the TYPE OF AMENDMENT NUMBER prompt, you will
 get the "<UNDEFINED>V^DIED" error if you try to edit the CONTRACT/BOA # field.
 Testing uncovered an additional error which will happen if you try to get
 help text at that same field by entering a question mark.
   
 Resolution:
 -----------
 The input transform and the executable help code each used the D0 variable.
 This variable is not always available when these pieces of code are executed.
 Both pieces of code have been rewritten to use the DA(1) variable which is
 available with the appropriate value at the time it is needed.
   
 Items affected:
   PRCHNPT routine.
   Data Dictionary change to the Input Transform and to the Executable Help
   for the CONTRACT/BOA # field [#4] of the ITEM subfile [#443.61], of the
   AMENDMENTS file [#443.6].
   
   
 5.  HD178733 -  <UNDEFINED>EN10+7^PRCHNPO7 - Jumping in template causing X
                 to be defined incorrectly
 Problem:
 -----------
 An error occurs when using the Edit an Incomplete Purchase Order option
 [PRCHPC PO EDIT], if:
 (1) after reaching the CONTRACT/BOA # field, the user starts to jump to a
     different field,
 (2) selects a partial field name which results in multiple choices,
 (3) decides not to jump after all and just presses <Enter> rather than
     selecting a field to jump to.
 The error then occurs when moving on to the field following CONTRACT/BOA #.
   
 Resolution:
 -----------
 The PRCHPC PO EDIT option uses an Input Template, [PRCH2138], for data entry.
 The attempt to jump and then not jumping runs the code through some FileMan
 functions that modify X and then re-enters the template at a point which
 expects X to be a previous value.  The fix that I have chosen is to disallow
 jumping from the CONTRACT/BOA # field.  Jumping is still allowed from most
 of the other fields in this data entry sequence.
   
 Items affected:
 Input Template PRCH2138 for PROCUREMENT & ACCOUNTING TRANSACTIONS file [#442]
   
   
 6.  HD186714 -  Purchase Card Issue - CONVERT 2237 to PC REQUEST > $2500
   
 Problem:
 -----------
 An administrative bulletin (07GC1.01 November 15, 2006) was issued which
 increases the authorized amount for Purchase Cards from $2,500 to $3,000.
 When sites tried to use the new amount with the Convert Temporary 2237 to
 PC Request [PRCH CONV TEMP] option they received a warning message about
 exceeding the $2,500 limit and were unable to process the orders.
   
 Resolution:
 -----------
 The limit amount is hard coded into the PRCHCON1 routine.  This patch will
 change the limit to 3000 so that it will match the new administrative order.
 In addition, the advisory message that is displayed when using the options
 New Simplified Purchase Card Order [PRCH ENTER SIMPLIFIED ORDER] and
 Edit Simplified Purchase Card Order [PRCH EDIT SIMPLIFIED ORDER] has been
 updated to show 3000 instead of 2500.
   
 Items affected:  routines PRCHCON1, PRCHNPO.
   
   
 7.  HD183722  -  PRCP NON-SS ORDER BULIDER -- Misspelled
   
 Problem:
 -----------
    
 The Name field [#.01] for the 'Non-SS Order Builder' option has the word
 BUILDER misspelled as BULIDER.  While examining the option, a second
 misspelling was noticed in the DESCRIPTION field where the word 'order' was
 entered as 'ordder'.  Neither issue affects the functionality of this option.
 The corrections are cosmetic in nature.
   
 Resolution:
 -----------
 Both misspellings are corrected in the Option file [#19] with this patch.
   
 Items affected:
 Option file [#19], Non-SS Order Builder option, internal name and description.
   
   
 Data Dictionary Changes:
 ------------------------
   
 FUND DISTRIBUTION file [#421]
 421,13.5      APPROPRIATION          0;16 FREE TEXT
   
  old:  INPUT TRANSFORM:  K:$L(X)>25!($L(X)<4) X
  new:  INPUT TRANSFORM:  K:$L(X)>30!($L(X)<4) X
   
  old:  HELP-PROMPT:      ANSWER MUST BE 4-25 CHARACTERS IN LENGTH
  new:  HELP-PROMPT:      ANSWER MUST BE 4-30 CHARACTERS IN LENGTH
   
   
 AMENDMENTS file [#443.6] : ITEM subfile [#443.61]
   
  old:  INPUT TRANSFORM:  K:X[""""!($A(X)=45) X I $D(X) S Z0=+$P(^PRC(443
                          .6,D0,1),U),ZA=DA,ZA(1)=DA(1),DA(1)=Z0,DIC="^PR
                          C(440,Z0,4,",DIC(0)="QELM" D ^DIC S DA=ZA,DA(1)
                          =ZA(1) K DIC,ZA S X=$P(Y,U,2) K:Y'>0 X
  new:  INPUT TRANSFORM:  K:X[""""!($A(X)=45) X I $D(X) S Y=$$CONTRACT^PR
                          CHNPT(DA(1),X) S X=$P(Y,U,2) K:Y'>0 X
   
   
  old:  EXECUTABLE HELP:  S ZD=D,X="?",Z0=+$P(^PRC(443.6,D0,1),U),Z1=$P(^
                          (1),U,7) Q:'$D(^PRC(440,Z0,4,0))  S DIC("S")=$S
                          (Z1=2:"I $P(^PRC(440,Z0,4,+Y,0),U,6)'=""B""",1:
                          "I 1") S DIC="^PRC(440,Z0,4,",DIC(0)="QEM" D ^D
                          IC S DIC=DIE,D=ZD K ZD,Z0
  new:  EXECUTABLE HELP:  D HLPCON^PRCHNPT(DA(1),X)
   
 ================INSTALLATION INSTRUCTIONS =================
    
   This patch can be installed with users on the system, however several
   options will need to be disabled (see step 4).
  
   Install Time - less than 2 minutes.
      
      
   1.   LOAD TRANSPORT GLOBAL
        ---------------------
        Choose the PackMan message containing this patch and invoke the
        INSTALL/CHECK MESSAGE PackMan option.
      
   2.   START UP KIDS
        -------------
        Start up the Kernel Installation and Distribution System Menu
        [XPD MAIN]:
      
           Edits and Distribution ...
           Utilities ...
           Installation ...
   
    
   3.   Select Installation Option: 
        ---------------------------
   
        Select Kernel Installation & Distribution System Option: INstallation
   
   
           1      Load a Distribution
           2      Verify Checksums in Transport Global
           3      Print Transport Global
           4      Compare Transport Global to Current System
           5      Backup a Transport Global
           6      Install Package(s)
                  Restart Install of Package(s)
                  Unload a Distribution
   
        NOTE:  The following are OPTIONAL - (When prompted for the INSTALL
               NAME, enter PRC*5.1*108):
      
        a.  Backup a Transport Global - This option will create a backup
            message of any routines exported with this patch. It will not
            backup any other changes such as DD's or templates.
        b.  Compare Transport Global to Current System - This option will
            allow you to view all changes that will be made when this patch
            is installed.  It compares all components of this patch
            (routines, DD's, templates, etc.).
        c.  Verify Checksums in Transport Global - This option will allow
            you to ensure the integrity of the routines that are in the
            transport global.
      
   4.   Select Installation Option: Install Package(s)
                                    ------------------
        **This is the step to start the installation of this KIDS patch:
      
        a. Choose the Install Package(s) option to start the patch install.
    
        b. When prompted 'Want KIDS to INHIBIT LOGONs during the install?
           YES//' answer NO
    
        c. When prompted 'Want to DISABLE Scheduled Options, Menu Options,
           and Protocols? YES//' answer YES
       
        d. When prompted 'Enter options you wish to mark as 'Out Of
           Order':'  Enter the following options:
      
         New Detailed Purchase Card Order     [PRCH ENTER DETAILED ORDER]
         Reconciliation                       [PRCH P.C.O. RECONCILIATION]
         Amendment to Purchase Order          [PRCHPC AMEND]
         Edit an Incomplete Purchase Order    [PRCHPC PO EDIT]
         Convert Temporary 2237 to PC Request [PRCH CONV TEMP]
         New Simplified Purchase Card Order   [PRCH ENTER SIMPLIFIED ORDER]
         Edit Simplified Purchase Card Order  [PRCH EDIT SIMPLIFIED ORDER]
              
        e. When prompted 'Enter protocols you wish to mark as 'Out Of
           Order':' press <return>.
  
 ROUTINE SUMMARY
 ===============
    
   The following is a list of the routines included in this patch.
   The second line of each of these routines now looks like:
    
              <tab>;;5.1;IFCAP;**[patch list]**;Oct 20, 2000
  
   CHECK^XTSUMBLD results
    
   Routine    Before Patch     After Patch     Patch List
   ---------  ------------     -----------     ----------
   PRC51108        N/A             2444882*    108
   PRCHCON1       14004399        14003901     108
   PRCHNPO        22192565        22192370     7,11,79,108
   PRCHNPO1       21121563        21160086     16,79,100,108
   PRCHNPT          812447         1267716     108
   PRCPAGP0       11164232        11176392     108
   PRCPURS3       10097440        10063891     1,108
   PRCPUYN          795214          821765     108
  
   Number of routines = 8
   Number of routines modified = 7
   Routines deleted by patch = 1 ; PRC51108

Routine Information:
====================
The checksums below are new checksums, and
 can be checked with CHECK1^XTSUMBLD.

Routine Name: PRC51108
    Before:       n/a   After:  B3359244  **108**
Routine Name: PRCHCON1
    Before: B22951328   After: B22950686  **108**
Routine Name: PRCHNPO
    Before: B57667755   After: B57666980  **7,11,79,108**
Routine Name: PRCHNPO1
    Before: B54452339   After: B54494630  **16,79,100,108**
Routine Name: PRCHNPT
    Before:   B893681   After:  B1872539  **108**
Routine Name: PRCPAGP0
    Before: B18043052   After: B18058628  **108**
Routine Name: PRCPURS3
    Before: B16751764   After: B16696444  **1,108**
Routine Name: PRCPUYN
    Before:  B1334291   After:  B1375817  **108**
 
Routine list of preceding patches: 1, 100

=============================================================================
User Information:
Entered By  : SCHMITZ,STEVEN                Date Entered  : SEP 08, 2006
Completed By: REA,WILLIAM M                 Date Completed: JUL 11, 2007
Released By : NELSON,VICKI M                Date Released : JUL 12, 2007
=============================================================================


Packman Mail Message:
=====================

$END TXT
