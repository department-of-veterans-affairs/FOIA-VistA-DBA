Released LBR*2.5*13 SEQ #12
Extracted from mail message
**KIDS**:LBR*2.5*13^

**INSTALL NAME**
LBR*2.5*13
"BLD",5739,0)
LBR*2.5*13^LIBRARY - 2.5^0^3041216^y
"BLD",5739,1,0)
^^1^1^3040914^
"BLD",5739,1,1,0)
Cannot print from LBRY SERIALS CHECK-IN
"BLD",5739,4,0)
^9.64PA^^
"BLD",5739,"KRN",0)
^9.67PA^8989.52^19
"BLD",5739,"KRN",.4,0)
.4
"BLD",5739,"KRN",.401,0)
.401
"BLD",5739,"KRN",.402,0)
.402
"BLD",5739,"KRN",.403,0)
.403
"BLD",5739,"KRN",.5,0)
.5
"BLD",5739,"KRN",.84,0)
.84
"BLD",5739,"KRN",3.6,0)
3.6
"BLD",5739,"KRN",3.8,0)
3.8
"BLD",5739,"KRN",9.2,0)
9.2
"BLD",5739,"KRN",9.8,0)
9.8
"BLD",5739,"KRN",9.8,"NM",0)
^9.68A^3^3
"BLD",5739,"KRN",9.8,"NM",1,0)
LBRYCK1^^0^B14879784
"BLD",5739,"KRN",9.8,"NM",2,0)
LBRYCK4^^0^B8921675
"BLD",5739,"KRN",9.8,"NM",3,0)
LBRYCK0^^0^B13395161
"BLD",5739,"KRN",9.8,"NM","B","LBRYCK0",3)

"BLD",5739,"KRN",9.8,"NM","B","LBRYCK1",1)

"BLD",5739,"KRN",9.8,"NM","B","LBRYCK4",2)

"BLD",5739,"KRN",19,0)
19
"BLD",5739,"KRN",19,"NM",0)
^9.68A^^
"BLD",5739,"KRN",19.1,0)
19.1
"BLD",5739,"KRN",101,0)
101
"BLD",5739,"KRN",409.61,0)
409.61
"BLD",5739,"KRN",771,0)
771
"BLD",5739,"KRN",870,0)
870
"BLD",5739,"KRN",8989.51,0)
8989.51
"BLD",5739,"KRN",8989.52,0)
8989.52
"BLD",5739,"KRN",8994,0)
8994
"BLD",5739,"KRN","B",.4,.4)

"BLD",5739,"KRN","B",.401,.401)

"BLD",5739,"KRN","B",.402,.402)

"BLD",5739,"KRN","B",.403,.403)

"BLD",5739,"KRN","B",.5,.5)

"BLD",5739,"KRN","B",.84,.84)

"BLD",5739,"KRN","B",3.6,3.6)

"BLD",5739,"KRN","B",3.8,3.8)

"BLD",5739,"KRN","B",9.2,9.2)

"BLD",5739,"KRN","B",9.8,9.8)

"BLD",5739,"KRN","B",19,19)

"BLD",5739,"KRN","B",19.1,19.1)

"BLD",5739,"KRN","B",101,101)

"BLD",5739,"KRN","B",409.61,409.61)

"BLD",5739,"KRN","B",771,771)

"BLD",5739,"KRN","B",870,870)

"BLD",5739,"KRN","B",8989.51,8989.51)

"BLD",5739,"KRN","B",8989.52,8989.52)

"BLD",5739,"KRN","B",8994,8994)

"BLD",5739,"QUES",0)
^9.62^^
"BLD",5739,"REQB",0)
^9.611^1^1
"BLD",5739,"REQB",1,0)
LBR*2.5*2^2
"BLD",5739,"REQB","B","LBR*2.5*2",1)

"MBREQ")
0
"PKG",515,-1)
1^1
"PKG",515,0)
LIBRARY - 2.5^LBR^LIBRARY SERIALS PACKAGE^
"PKG",515,20,0)
^9.402P^^
"PKG",515,22,0)
^9.49I^1^1
"PKG",515,22,1,0)
2.5^2960227^
"PKG",515,22,1,"PAH",1,0)
13^3041216
"PKG",515,22,1,"PAH",1,1,0)
^^1^1^3041216
"PKG",515,22,1,"PAH",1,1,1,0)
Cannot print from LBRY SERIALS CHECK-IN
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
3
"RTN","LBRYCK0")
0^3^B13395161
"RTN","LBRYCK0",1,0)
LBRYCK0 ;ISC2/DJM-LIBRARY SERIALS CHECK-IN ;[ 07/09/97  6:37 PM ]
"RTN","LBRYCK0",2,0)
 ;;2.5;Library;**2,13**;Mar 11, 1996
"RTN","LBRYCK0",3,0)
CHECK ;
"RTN","LBRYCK0",4,0)
FORWARD S E=0 G:$L(X)>1 FWD S:$D(A(E1+1)) (E0,E1)=E1+1 G FWD1
"RTN","LBRYCK0",5,0)
FWD S X1=+$E(X,2,99) Q:X1'>0!'($D(A(X1)))  Q:$E(X,1)="B"&(X1'<E0)  Q:$E(X,1)="F"&(X1'>E0)  S E0=$S($D(A(X1)):X1,$D(A(E1+1)):E1+1,1:E0) S:X1>0&($D(A(X1))) E1=X1
"RTN","LBRYCK0",6,0)
FWD1 F I=1:1:4 Q:'$D(A(E1+1))  S E1=E1+1
"RTN","LBRYCK0",7,0)
 Q
"RTN","LBRYCK0",8,0)
BACKUP S E=0 G:$L(X)>1 FWD I $D(A(E0-5)) S (E0,E1)=E0-5 G FWD1
"RTN","LBRYCK0",9,0)
BACKUP1 F I=1:1:5 Q:'$D(A(E0-1))  S E0=E0-1
"RTN","LBRYCK0",10,0)
 S E1=E0 G FWD1
"RTN","LBRYCK0",11,0)
EDIT S E=0 G:$L(X)>1 EDITCK W !!,"Choose ",*34,"ID NUM",*34," to edit: "
"RTN","LBRYCK0",12,0)
 S DTOUT=0 R XX:DTIME E  W $C(7) S DTOUT=1 G DISPLAY^LBRYCK
"RTN","LBRYCK0",13,0)
 I XX=" " S:$D(^TMP("LBRY",DUZ,2)) XX=^(2)
"RTN","LBRYCK0",14,0)
 I XX="^" G ^LBRYCK
"RTN","LBRYCK0",15,0)
 I XX="" G DISPLAY^LBRYCK
"RTN","LBRYCK0",16,0)
 I $D(A(XX)) D UTIL G EDIT1
"RTN","LBRYCK0",17,0)
EDIT0 W !!,"Enter a number under heading ",*34,"ID NUM",*34,"." G EDIT
"RTN","LBRYCK0",18,0)
EDITCK S XX=+$E(X,2,99) S:'$D(A(XX)) X=0 K:'$D(A(XX)) XX G:'$D(XX) EDIT0 G:'$D(A(XX)) EDIT0 D UTIL G EDIT1
"RTN","LBRYCK0",19,0)
EDIT1 W ! S LBRYDA=DA,DA=+A(XX),(LBRYE,LBDA)=DA,(DIC,DIE)="^LBRY(682,"
"RTN","LBRYCK0",20,0)
 S DR="[LBRY JOURNAL DATE EDIT]" D LOCK^LBRYEDR G:LBRYL=0 EDIT2
"RTN","LBRYCK0",21,0)
 D ^DIE L  I $D(Y)!($D(DTOUT)) G DISPLAY^LBRYCK
"RTN","LBRYCK0",22,0)
 D:$P(^LBRY(682,DA,1),U,1)="" RMV S DA=LBRYDA K LBRYDA
"RTN","LBRYCK0",23,0)
ROUT ;CHECK TO SEE IF ANY ROUTING SLIPS NEED PRINTING
"RTN","LBRYCK0",24,0)
 I $G(LBRYPTR)="" D ^LBRYASK I $G(LBRYPTR)="" G EDIT2
"RTN","LBRYCK0",25,0)
 S NUM=0 F  S NUM=$O(^LBRY(682,LBRYE,4,NUM)) Q:NUM'>0  D
"RTN","LBRYCK0",26,0)
 . S LBXX=^LBRY(682,LBRYE,4,NUM,0)
"RTN","LBRYCK0",27,0)
 . Q:$P(LBXX,U,6)'=""
"RTN","LBRYCK0",28,0)
 . Q:"12"'[$P(LBXX,U,2)
"RTN","LBRYCK0",29,0)
 . W !,"c",$P(LBXX,U)," RECEIVED."
"RTN","LBRYCK0",30,0)
 . S ^LBRY(682,"A2",LBRYE,NUM)="" D QUE
"RTN","LBRYCK0",31,0)
EDIT2 D MORE^LBRYCK S E=II G DISPLAY^LBRYCK
"RTN","LBRYCK0",32,0)
ENEDT S CO682="" L ^LBRY(682,0) S LBRYNUM=$P(^LBRY(682,0),U,3)
"RTN","LBRYCK0",33,0)
 F  S LBRYNUM=LBRYNUM+1 Q:'$D(^LBRY(682,LBRYNUM,0))
"RTN","LBRYCK0",34,0)
 S LBRYIF=$S('$D(A(1)):"P",1:"I"),X=LBRYNUM,DIC="^LBRY(682,"
"RTN","LBRYCK0",35,0)
 S DIC(0)="LNZ",DLAYGO=682 K DO D FILE^DICN L  K DLAYGO
"RTN","LBRYCK0",36,0)
 S DIE=DIC,(DA,LBDA)=+Y,DR="[LBRY INSERT]" D LOCK^LBRYEDR G:LBRYL=0 ENEDT1 D ^DIE L
"RTN","LBRYCK0",37,0)
 I $D(Y)!($D(DTOUT)) D KILL G ENEDT0
"RTN","LBRYCK0",38,0)
 S DA=LBDA I '$D(^LBRY(682,DA,1))#2 D KILL G ENEDT0
"RTN","LBRYCK0",39,0)
 I $P(^LBRY(682,DA,1),U,1)="" D KILL G ENEDT0
"RTN","LBRYCK0",40,0)
 I CO682="" D KILL,KTXT
"RTN","LBRYCK0",41,0)
ENEDT0 D MORE^LBRYCK F E=1:1 G:'$D(A(E)) DISPLAY^LBRYCK G:A(E)=DA ENEDT1
"RTN","LBRYCK0",42,0)
ENEDT1 S KL1=1 G INIT^LBRYCK
"RTN","LBRYCK0",43,0)
 G CONT1^LBRYCK
"RTN","LBRYCK0",44,0)
KILL S DA=LBDA,DIK="^LBRY(682," D ^DIK Q
"RTN","LBRYCK0",45,0)
KTXT W !!,"This issue is not being inserted because no copies are available for check-in."
"RTN","LBRYCK0",46,0)
 W !,"To insert this Journal Date first go to CSE and set up copies to check-in."
"RTN","LBRYCK0",47,0)
 S XZ="Continue// " D PAUSE
"RTN","LBRYCK0",48,0)
 Q
"RTN","LBRYCK0",49,0)
UTIL K ^TMP("LBRY",DUZ,2) S ^(2)=XX Q
"RTN","LBRYCK0",50,0)
RMV S DIK=DIE D ^DIK Q
"RTN","LBRYCK0",51,0)
ALL K ALL S CNT=+$P($G(^LBRY(680,LBRYLOC,7)),U),(QTY,IT)=0
"RTN","LBRYCK0",52,0)
 F  S IT=$O(^LBRY(681,"AC",LBRYLOC,IT)) Q:IT=""  S QTY=QTY+1
"RTN","LBRYCK0",53,0)
 I QTY<CNT S ALL=1
"RTN","LBRYCK0",54,0)
 I CNT=0 S ALL=1
"RTN","LBRYCK0",55,0)
 Q
"RTN","LBRYCK0",56,0)
PAUSE W !,XZ S DTOUT=0 R X:DTIME E  W $C(7) S DTOUT=1 Q
"RTN","LBRYCK0",57,0)
 Q:X=""  Q:X="^"  W !,"Enter carriage return to ",XZ G PAUSE
"RTN","LBRYCK0",58,0)
EXIT K A,%,%DT,%X,%Y,LA0,LA1,LA2,LA3,LA4,LA5,LA6,LA7,A,I,II,IA,I1,J,AA,AA1
"RTN","LBRYCK0",59,0)
 K AA2,AA3,AA4,AA5,AA6,AA7,AA8,AB,AB1,AB2,CA,CA1,DIC,DIC(0),DIW,DIWF
"RTN","LBRYCK0",60,0)
 K DIWI,DIWL,DIWR,DIWT,DIWTC,DIWX,XT1,XT2,XT3,XT4,CLR,LL(2),LL(1),LL,DN
"RTN","LBRYCK0",61,0)
 K DR,DX,DY,N,O,X1,X2,XX,Z,LB,LB1,LB2,MM
"RTN","LBRYCK0",62,0)
 Q
"RTN","LBRYCK0",63,0)
QUE S LTST=$O(^LBRY(682,"A2",0)) Q:LTST=""
"RTN","LBRYCK0",64,0)
 S QUEUE=^LBRY(680.6,LBRYPTR,0),TERM=$P(QUEUE,U,3),QUEUE=$P(QUEUE,U,5)
"RTN","LBRYCK0",65,0)
 I QUEUE="Y",TERM]"" S ZTIO=TERM,ZTDTH=$H G QUEUE1
"RTN","LBRYCK0",66,0)
 S %ZIS="MQ",%IS("B")=$S(TERM]"":TERM,1:"") K IO("Q")
"RTN","LBRYCK0",67,0)
 D ^%ZIS Q:POP  I '$D(IO("Q")) U IO D ^LBRYCK2 D ^%ZISC Q
"RTN","LBRYCK0",68,0)
QUEUE1 S ZTRTN="^LBRYCK2",ZTSAVE("LBRYPTR")="",ZTDESC="LBRY CHECK-IN REPORT"
"RTN","LBRYCK0",69,0)
 D ^%ZTLOAD D ^%ZISC K ZTSK
"RTN","LBRYCK0",70,0)
 Q
"RTN","LBRYCK1")
0^1^B14879784
"RTN","LBRYCK1",1,0)
LBRYCK1 ;ISC2/DJM-SERIALS CHECK-IN OUTPUT MESSAGE ;[ 05/23/97  12:13 PM ]
"RTN","LBRYCK1",2,0)
 ;;2.5;Library;**2,13**;Mar 11, 1996
"RTN","LBRYCK1",3,0)
START F I=1:1:7 S LS(I)=""
"RTN","LBRYCK1",4,0)
 S XT1=$S($D(^LBRY(680,LBRYLOC,16,0)):1,1:0),XT2=$S($D(A(E0-1)):1,1:0)
"RTN","LBRYCK1",5,0)
 S XT3=$S($D(A(E1+1)):1,1:0),XT4=$S($D(A(1)):1,1:0),LS(1)="Choose: "
"RTN","LBRYCK1",6,0)
 I XT4 S LS(2)=$C(34)_"ID NUM"_$C(34)_" to check-in",LS(4)="(E)dit"
"RTN","LBRYCK1",7,0)
 S LS(3)="(I)nsert" S:XT1 LS(5)="see check-in (N)otes" S:XT2 LS(6)="(B)ackup" S:XT3 LS(7)="(F)orward"
"RTN","LBRYCK1",8,0)
 S (LINE1,LINE2)="" F I=1:1:7 Q:$L(LINE1)+$L(LS(I))'<78  S:LS(I)]"" LINE1=LINE1_LS(I) D LS2 K LS(I) I I>2&($D(LS(I+1))) S:LS(I+1)]"" LINE1=LINE1_", "
"RTN","LBRYCK1",9,0)
 I '$D(LS(7)) S LINE1=LINE1_"." G PRINT
"RTN","LBRYCK1",10,0)
 F J=I:1:7 S:LS(J)]"" LINE2=LINE2_LS(J) K LS(J) I J<7&($D(LS(J+1))) S:LS(J+1)]"" LINE2=LINE2_", "
"RTN","LBRYCK1",11,0)
 S LINE2=LINE2_"."
"RTN","LBRYCK1",12,0)
PRINT W !!,LINE1,! W:$D(LINE2) LINE2,! W "Exit// "
"RTN","LBRYCK1",13,0)
EXIT K LINE1,LINE2,I,J
"RTN","LBRYCK1",14,0)
 Q
"RTN","LBRYCK1",15,0)
LS2 I I=2,$D(LS(2)) I LS(2)]"" S LINE1=LINE1_", "
"RTN","LBRYCK1",16,0)
 Q
"RTN","LBRYCK1",17,0)
START1 ;LIBRARY ROUTING QUEUEING FOR "ALL" COPIES
"RTN","LBRYCK1",18,0)
 S LBRYC=0 D NOW^%DTC S LBRYD=%\1
"RTN","LBRYCK1",19,0)
ST S LBRYC=$O(^LBRY(682,A(E),4,LBRYC)) G:LBRYC'>0 QUEUE
"RTN","LBRYCK1",20,0)
 S LBXX=^LBRY(682,A(E),4,LBRYC,0) I $P(LBXX,U,2)>3 D LOCK G:LBRYL=0 FINI
"RTN","LBRYCK1",21,0)
 D:$P(LBXX,U,1)'="ToC" NUMB D:$P(LBXX,U,1)="ToC" TOC
"RTN","LBRYCK1",22,0)
 G ST
"RTN","LBRYCK1",23,0)
NUMB S LBC=$P(LBXX,U,3),LBC=$P(^LBRY(681,LBC,1),U,6)
"RTN","LBRYCK1",24,0)
 S $P(^LBRY(682,A(E),4,LBRYC,0),U,2)=LBC,$P(^LBRY(682,A(E),1),U,7)=LBRYD
"RTN","LBRYCK1",25,0)
 W !,"c",$P(LBXX,U,1)," RECEIVED." D COMP
"RTN","LBRYCK1",26,0)
 I $G(LBRYPTR)="" D ^LBRYASK I $G(LBRYPTR)="" G FINI
"RTN","LBRYCK1",27,0)
 I "12"[LBC,$P(^LBRY(680.6,LBRYPTR,0),U,5)="Y" W "  Queued to printer ",$P(^(0),U,3),"."
"RTN","LBRYCK1",28,0)
 L  Q
"RTN","LBRYCK1",29,0)
TOC S $P(^LBRY(682,A(E),4,LBRYC,0),U,2)=1,LBC=1
"RTN","LBRYCK1",30,0)
 W !,"ToC ROUTING LIST" W:$P(^LBRY(680.6,LBRYPTR,0),U,5)="Y" " queued to printer ",$P(^(0),U,3),"."
"RTN","LBRYCK1",31,0)
 D COMP
"RTN","LBRYCK1",32,0)
 L  Q
"RTN","LBRYCK1",33,0)
COMP I "12"[LBC,$P(LBXX,U,6)="" D
"RTN","LBRYCK1",34,0)
 . S ^LBRY(682,"A2",A(E),LBRYC)="",^LBRY(682,"A4",LBRYD,LBRYCLS,A(E),LBRYC)=""
"RTN","LBRYCK1",35,0)
 I LBC<4 S $P(^LBRY(682,A(E),4,LBRYC,0),U,7)=LBRYD,$P(^(0),U,8)=DUZ,$P(^LBRY(682,A(E),1),U,7)=LBRYD
"RTN","LBRYCK1",36,0)
 I $P(LBXX,U,1)'="ToC",$P(LBXX,U,2)=4 S $P(^LBRY(682,A(E),1),U,4)=$P(^LBRY(682,A(E),1),U,4)+1
"RTN","LBRYCK1",37,0)
 Q
"RTN","LBRYCK1",38,0)
LOCK S DIC="^LBRY(682,A(E),4,",DA=LBRYC D LOCK^LBRYEDR Q
"RTN","LBRYCK1",39,0)
QUEUE W !!,"Check-in completed." S LTST=$O(^LBRY(682,"A2",0)) G:LTST="" FINI
"RTN","LBRYCK1",40,0)
 S QUEUE=^LBRY(680.6,LBRYPTR,0),TERM=$P(QUEUE,U,3),QUEUE=$P(QUEUE,U,5)
"RTN","LBRYCK1",41,0)
 I QUEUE="Y",TERM]"" S ZTIO=TERM,ZTDTH=$H G QUEUE1
"RTN","LBRYCK1",42,0)
 S %ZIS="MQ",%IS("B")=$S(TERM]"":TERM,1:"") K IO("Q")
"RTN","LBRYCK1",43,0)
 D ^%ZIS G:POP FINI I '$D(IO("Q")) U IO D ^LBRYCK2 D ^%ZISC G FINI
"RTN","LBRYCK1",44,0)
QUEUE1 S ZTRTN="^LBRYCK2",ZTSAVE("LBRYPTR")="",ZTDESC="LBRY CHECK-IN REPORT"
"RTN","LBRYCK1",45,0)
 D ^%ZTLOAD D ^%ZISC K ZTSK
"RTN","LBRYCK1",46,0)
FINI S XZ="EXIT//" D PAUSE^LBRYCK0
"RTN","LBRYCK1",47,0)
 K CKIN,LBRYC,LBXX,LBC,%IS("B")
"RTN","LBRYCK1",48,0)
 G ^LBRYCK
"RTN","LBRYCK1",49,0)
ASK3 ;LIBRARY SERIALS WHAT-TO-DO PROMPT (FROM LBRYCK)
"RTN","LBRYCK1",50,0)
 S DTOUT=0 R X:DTIME E  W $C(7) S DTOUT=1 G ^LBRYCK
"RTN","LBRYCK1",51,0)
 I X="" G ^LBRYCK
"RTN","LBRYCK1",52,0)
 I X=" " S:$D(^TMP("LBRY",DUZ,1)) X=^(1)
"RTN","LBRYCK1",53,0)
 I X="??" S XQH="LBRY CHECK-IN EDIT ??" D EN^XQH G DISPLAY^LBRYCK
"RTN","LBRYCK1",54,0)
 I X="^" G ^LBRYCK
"RTN","LBRYCK1",55,0)
 I $D(A(E0-1)),"Bb"[$E(X,1) D BACKUP^LBRYCK0 G DISPLAY^LBRYCK
"RTN","LBRYCK1",56,0)
 I $D(A(E1+1)),"Ff"[$E(X,1) D FORWARD^LBRYCK0 G DISPLAY^LBRYCK
"RTN","LBRYCK1",57,0)
 I $D(^LBRY(680,DA,16,0)),"Nn"[X D UTIL,^LBRYCK5 G DISPLAY^LBRYCK
"RTN","LBRYCK1",58,0)
 I $D(A(1)),"Ee"[$E(X,1) D UTIL G EDIT^LBRYCK0
"RTN","LBRYCK1",59,0)
 I "Ii"[X D UTIL G ENEDT^LBRYCK0
"RTN","LBRYCK1",60,0)
ASK2 I $D(A(X)) D UTIL G ^LBRYCK3
"RTN","LBRYCK1",61,0)
WRONG S E=0,XTA="",XTB="",XTC="",XTD="",XTE=""
"RTN","LBRYCK1",62,0)
 S:$D(A(1)) XTA="a number under heading "_$C(34)_"ID NUM"_$C(34)_", E"
"RTN","LBRYCK1",63,0)
 S XTB=$S(XT4&('XT1)&('XT2)&'(XT3):" or I.",'XT4&('XT1)&('XT2)&('XT3):"I.",1:", I") G:XTB["." WRONG1 S XTC=$S(XT1:", N",1:""),XTD=$S(XT2&(XT3):", B or F.",XT2!(XT3):" or ",1:".") G:XTD["." WRONG1
"RTN","LBRYCK1",64,0)
 S XTE=$S(XT2:"B.",XT3:"F.",1:"")
"RTN","LBRYCK1",65,0)
WRONG1 W !!,"Enter "_XTA_XTB_XTC_XTD_XTE,!,"Enter '??' for more help."
"RTN","LBRYCK1",66,0)
 W !!,"Choose: Exit// " D MORE^LBRYCK G ASK3
"RTN","LBRYCK1",67,0)
UTIL K ^TMP("LBRY",DUZ,1) S ^(1)=X Q
"RTN","LBRYCK4")
0^2^B8921675
"RTN","LBRYCK4",1,0)
LBRYCK4 ;ISC2/DJM-CHECK-IN QUEUEING & PRINTING ;[ 05/23/97  12:13 PM ]
"RTN","LBRYCK4",2,0)
 ;;2.5;Library;**2,13**;Mar 11, 1996
"RTN","LBRYCK4",3,0)
PARSE S LBRYL="" F I=1:1 S G=$P(X,",",I) G:G="" TOC D:G=+G ROUT Q:LBRYL=0  D:G["-" PARSE1
"RTN","LBRYCK4",4,0)
 Q
"RTN","LBRYCK4",5,0)
PARSE1 S G1=$P(G,"-",1),G2=$P(G,"-",2) I G2'<G1 F G=G1:1:G2 D ROUT Q:LBRYL=0
"RTN","LBRYCK4",6,0)
 Q
"RTN","LBRYCK4",7,0)
ROUT S NUM=$O(^LBRY(682,A(LBX),4,"B",G,0)) Q:NUM=""
"RTN","LBRYCK4",8,0)
 S LBXX=^LBRY(682,A(LBX),4,NUM,0) Q:"45"'[$P(LBXX,U,2)
"RTN","LBRYCK4",9,0)
 S DIC="^LBRY(682,A(LBX),4,",DA=NUM D LOCK^LBRYEDR Q:LBRYL=0
"RTN","LBRYCK4",10,0)
 S LBC=$P(LBXX,U,3),LBC=$P(^LBRY(681,LBC,1),U,6)
"RTN","LBRYCK4",11,0)
 S $P(^LBRY(682,A(LBX),4,NUM,0),U,2)=LBC,$P(^(0),U,7)=LDATE
"RTN","LBRYCK4",12,0)
 W !,"c",$P(LBXX,U)," RECEIVED." D COMP
"RTN","LBRYCK4",13,0)
 I $P(^LBRY(682,A(LBX),1),U,7)="" S $P(^(1),U,7)=LDATE
"RTN","LBRYCK4",14,0)
 I $G(LBRYPTR)="" D ^LBRYASK I $G(LBRYPTR)="" S LBRYL=0 Q
"RTN","LBRYCK4",15,0)
 I "12"[LBC,$P(^LBRY(680.6,LBRYPTR,0),U,5)="Y" W "  Queued to printer ",$P(^(0),U,3),"."
"RTN","LBRYCK4",16,0)
 L  Q
"RTN","LBRYCK4",17,0)
COMP I "12"[LBC,$P(LBXX,U,6)="" D
"RTN","LBRYCK4",18,0)
 . S ^LBRY(682,"A2",A(LBX),NUM)=""
"RTN","LBRYCK4",19,0)
 . S ^LBRY(682,"A4",LDATE,LBRYLOC,A(LBX),NUM)=""
"RTN","LBRYCK4",20,0)
 I LBC<4 S $P(^LBRY(682,A(LBX),4,NUM,0),U,7)=LDATE,$P(^(0),U,8)=DUZ,$P(^LBRY(682,A(LBX),1),U,7)=LDATE
"RTN","LBRYCK4",21,0)
 I $P(LBXX,U)'="ToC",$P(LBXX,U,2)=4 S $P(^LBRY(682,A(LBX),1),U,4)=$P(^LBRY(682,A(LBX),1),U,4)+1
"RTN","LBRYCK4",22,0)
 Q
"RTN","LBRYCK4",23,0)
TOC S NUM=$O(^LBRY(682,A(LBX),4,"B","ToC",0)) G:NUM="" QUEUE
"RTN","LBRYCK4",24,0)
 S LBXX=^LBRY(682,A(LBX),4,NUM,0),DIC="^LBRY(682,A(LBX),4,",DA=NUM
"RTN","LBRYCK4",25,0)
 D LOCK^LBRYEDR Q:LBRYL=0
"RTN","LBRYCK4",26,0)
 I $P(^LBRY(682,A(LBX),4,NUM,0),U,2)=5 D
"RTN","LBRYCK4",27,0)
 . S $P(^LBRY(682,A(LBX),4,NUM,0),U,2)=1,$P(^(0),U,7)=LDATE,LBC=1
"RTN","LBRYCK4",28,0)
 . W !,"ToC ROUTING LIST" W:$P(^LBRY(680.6,LBRYPTR,0),U,5)="Y" " queued to printer ",$P(^(0),U,3),"." D COMP
"RTN","LBRYCK4",29,0)
 L
"RTN","LBRYCK4",30,0)
QUEUE W !!,"Check-in completed." S LTST=$O(^LBRY(682,"A2",0)) G:LTST="" FINI
"RTN","LBRYCK4",31,0)
 S QUEUE=^LBRY(680.6,LBRYPTR,0),TERM=$P(QUEUE,U,3),QUEUE=$P(QUEUE,U,5)
"RTN","LBRYCK4",32,0)
 I QUEUE="Y",TERM]"" S ZTIO=TERM,ZTDTH=$H G QUEUE1
"RTN","LBRYCK4",33,0)
 S %ZIS="MQ",%IS("B")=$S(TERM]"":TERM,1:"") K IO("Q")
"RTN","LBRYCK4",34,0)
 D ^%ZIS G:POP FINI I '$D(IO("Q")) U IO D ^LBRYCK2 D ^%ZISC G FINI
"RTN","LBRYCK4",35,0)
QUEUE1 S ZTRTN="^LBRYCK2",ZTSAVE("LBRYPTR")="",ZTDESC="LBRY CHECK-IN REPORT"
"RTN","LBRYCK4",36,0)
 D ^%ZTLOAD D ^%ZISC K ZTSK
"RTN","LBRYCK4",37,0)
FINI S XZ="EXIT//" D PAUSE^LBRYCK0 G ^LBRYCK
"RTN","LBRYCK4",38,0)
ASK W !!,"Enter copy number/s separated by commas or a hyphen."
"RTN","LBRYCK4",39,0)
 W !,"Copy number/s: EXIT// " S Q=1
"RTN","LBRYCK4",40,0)
ASK0 S DTOUT=0,X="" R X:DTIME E  W $C(7) S DTOUT=1 G ^LBRYCK
"RTN","LBRYCK4",41,0)
 I X="^" G ^LBRYCK
"RTN","LBRYCK4",42,0)
 I X="" G DISPLAY^LBRYCK
"RTN","LBRYCK4",43,0)
 I X?.N G PARSE
"RTN","LBRYCK4",44,0)
ASK3 S G=$P(X,",",Q) G:G="" ASK1 G:G["-" ASK4 G:G'?.N ASK2 S Q=Q+1 G ASK3
"RTN","LBRYCK4",45,0)
ASK1 G PARSE
"RTN","LBRYCK4",46,0)
ASK2 W !!,"Please enter a copy number or a range of numbers separated by a hyphen '1-2'"
"RTN","LBRYCK4",47,0)
 W !,"or a combination of the two separated by a comma '1,2-4' or <CR> to EXIT."
"RTN","LBRYCK4",48,0)
 G ASK
"RTN","LBRYCK4",49,0)
ASK4 G:G'?1N.N1"-"1N.N ASK2 S Q=Q+1 G ASK3
"VER")
8.0^22
**END**
**END**
