Released SD*5.3*377 SEQ #349
Extracted from mail message
**KIDS**:SD*5.3*377^

**INSTALL NAME**
SD*5.3*377
"BLD",5591,0)
SD*5.3*377^SCHEDULING^0^3050616^y
"BLD",5591,1,0)
^^2^2^3040607^
"BLD",5591,1,1,0)
This patch will provide the ability to sort routing slips by physical 
"BLD",5591,1,2,0)
location.
"BLD",5591,4,0)
^9.64PA^^
"BLD",5591,"ABPKG")
n
"BLD",5591,"INID")
^n
"BLD",5591,"INIT")

"BLD",5591,"KRN",0)
^9.67PA^8989.52^19
"BLD",5591,"KRN",.4,0)
.4
"BLD",5591,"KRN",.401,0)
.401
"BLD",5591,"KRN",.402,0)
.402
"BLD",5591,"KRN",.403,0)
.403
"BLD",5591,"KRN",.5,0)
.5
"BLD",5591,"KRN",.84,0)
.84
"BLD",5591,"KRN",3.6,0)
3.6
"BLD",5591,"KRN",3.8,0)
3.8
"BLD",5591,"KRN",9.2,0)
9.2
"BLD",5591,"KRN",9.8,0)
9.8
"BLD",5591,"KRN",9.8,"NM",0)
^9.68A^5^5
"BLD",5591,"KRN",9.8,"NM",1,0)
SDROUT^^0^B19382618
"BLD",5591,"KRN",9.8,"NM",2,0)
SDROUT1^^0^B19815535
"BLD",5591,"KRN",9.8,"NM",3,0)
SDROUT2^^0^B14224078
"BLD",5591,"KRN",9.8,"NM",4,0)
SDROUT0^^0^B20877493
"BLD",5591,"KRN",9.8,"NM",5,0)
SD53P377^^0^B2969746
"BLD",5591,"KRN",9.8,"NM","B","SD53P377",5)

"BLD",5591,"KRN",9.8,"NM","B","SDROUT",1)

"BLD",5591,"KRN",9.8,"NM","B","SDROUT0",4)

"BLD",5591,"KRN",9.8,"NM","B","SDROUT1",2)

"BLD",5591,"KRN",9.8,"NM","B","SDROUT2",3)

"BLD",5591,"KRN",19,0)
19
"BLD",5591,"KRN",19.1,0)
19.1
"BLD",5591,"KRN",101,0)
101
"BLD",5591,"KRN",409.61,0)
409.61
"BLD",5591,"KRN",771,0)
771
"BLD",5591,"KRN",870,0)
870
"BLD",5591,"KRN",8989.51,0)
8989.51
"BLD",5591,"KRN",8989.52,0)
8989.52
"BLD",5591,"KRN",8994,0)
8994
"BLD",5591,"KRN","B",.4,.4)

"BLD",5591,"KRN","B",.401,.401)

"BLD",5591,"KRN","B",.402,.402)

"BLD",5591,"KRN","B",.403,.403)

"BLD",5591,"KRN","B",.5,.5)

"BLD",5591,"KRN","B",.84,.84)

"BLD",5591,"KRN","B",3.6,3.6)

"BLD",5591,"KRN","B",3.8,3.8)

"BLD",5591,"KRN","B",9.2,9.2)

"BLD",5591,"KRN","B",9.8,9.8)

"BLD",5591,"KRN","B",19,19)

"BLD",5591,"KRN","B",19.1,19.1)

"BLD",5591,"KRN","B",101,101)

"BLD",5591,"KRN","B",409.61,409.61)

"BLD",5591,"KRN","B",771,771)

"BLD",5591,"KRN","B",870,870)

"BLD",5591,"KRN","B",8989.51,8989.51)

"BLD",5591,"KRN","B",8989.52,8989.52)

"BLD",5591,"KRN","B",8994,8994)

"BLD",5591,"QUES",0)
^9.62^^
"BLD",5591,"REQB",0)
^9.611^2^2
"BLD",5591,"REQB",1,0)
SD*5.3*39^1
"BLD",5591,"REQB",2,0)
SD*5.3*343^1
"BLD",5591,"REQB","B","SD*5.3*343",2)

"BLD",5591,"REQB","B","SD*5.3*39",1)

"MBREQ")
0
"PKG",16,-1)
1^1
"PKG",16,0)
SCHEDULING^SD^APPOINTMENTS,PROFILES,LETTERS,AMIS REPORTS
"PKG",16,20,0)
^9.402P^^
"PKG",16,22,0)
^9.49I^1^1
"PKG",16,22,1,0)
5.3^2930813
"PKG",16,22,1,"PAH",1,0)
377^3050616
"PKG",16,22,1,"PAH",1,1,0)
^^2^2^3050616
"PKG",16,22,1,"PAH",1,1,1,0)
This patch will provide the ability to sort routing slips by physical 
"PKG",16,22,1,"PAH",1,1,2,0)
location.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
5
"RTN","SD53P377")
0^5^B2969746
"RTN","SD53P377",1,0)
SD53P377 ;BP OIFO/TEH - POST INIT FOR PHY LOC SORT ; 4/24/01 3:10pm
"RTN","SD53P377",2,0)
 ;;5.3;Scheduling;**377**;Aug 13, 1993
"RTN","SD53P377",3,0)
 ;
"RTN","SD53P377",4,0)
 ;This routine creates a report of clinics without physical
"RTN","SD53P377",5,0)
 ;locations.
"RTN","SD53P377",6,0)
 ;
"RTN","SD53P377",7,0)
 ;
"RTN","SD53P377",8,0)
EN N SC,SCPL,SDI,SDR K ^TMP("SD53P377")
"RTN","SD53P377",9,0)
 S SC=0 F  S SC=$O(^SC(SC)) Q:SC<1  D
"RTN","SD53P377",10,0)
 .I $P(^SC(SC,0),"^",3)'="C" Q
"RTN","SD53P377",11,0)
 .I $D(^SC(SC,"I")) S SDI=$P($G(^SC(SC,"I")),"^",1),SDR=$P($G(^("I")),"^",2)
"RTN","SD53P377",12,0)
 .I $D(^SC(SC,"I")),SDI'="",SDR="" Q
"RTN","SD53P377",13,0)
 .S SCPL=$P($G(^SC(SC,0)),"^",11) I SCPL="" D
"RTN","SD53P377",14,0)
 ..S ^TMP("SD53P377",SC)=$P(^SC(SC,0),"^")
"RTN","SD53P377",15,0)
PRINT ;
"RTN","SD53P377",16,0)
 N SDCLIN,SDPAGE,SDEND
"RTN","SD53P377",17,0)
 W !,"Clinics W/O Physical Location Report",!
"RTN","SD53P377",18,0)
 S SDPAGE=0,SDEND="",%ZIS="Q" D ^%ZIS
"RTN","SD53P377",19,0)
 I POP Q
"RTN","SD53P377",20,0)
 I $G(IO("Q"))=1 D  Q
"RTN","SD53P377",21,0)
 .N ZTRTN,ZTDESC,ZTSAVE
"RTN","SD53P377",22,0)
 .S ZTRTN="PRINT1^SD53P377",ZTDESC="Clinics W/O Physical Location"
"RTN","SD53P377",23,0)
 .S ZTSAVE("SD*")=""
"RTN","SD53P377",24,0)
 .D ^%ZTLOAD K IO("Q")
"RTN","SD53P377",25,0)
 ;
"RTN","SD53P377",26,0)
PRINT1 ;
"RTN","SD53P377",27,0)
 U IO
"RTN","SD53P377",28,0)
 D HDR
"RTN","SD53P377",29,0)
 S SDCLIN=0
"RTN","SD53P377",30,0)
 F  S SDCLIN=$O(^TMP("SD53P377",SDCLIN)) Q:SDCLIN=""!(SDEND)  D
"RTN","SD53P377",31,0)
 .W !,?15,$G(^TMP("SD53P377",SDCLIN))
"RTN","SD53P377",32,0)
 .D HDR:$Y+3>IOSL Q:SDEND
"RTN","SD53P377",33,0)
 W @IOF
"RTN","SD53P377",34,0)
 D ^%ZISC
"RTN","SD53P377",35,0)
 Q
"RTN","SD53P377",36,0)
HDR ;
"RTN","SD53P377",37,0)
 I SDPAGE>0,$E(IOST,1,2)="C-" S SDEND=$$EOP() Q:SDEND
"RTN","SD53P377",38,0)
 S SDPAGE=SDPAGE+1
"RTN","SD53P377",39,0)
 W:SDPAGE'=1 @IOF
"RTN","SD53P377",40,0)
 W !,?10,"Clinics W/O Physical Location"
"RTN","SD53P377",41,0)
 W !,?10,"-----------------------------",!
"RTN","SD53P377",42,0)
 Q
"RTN","SD53P377",43,0)
EOP() ;End of page check
"RTN","SD53P377",44,0)
 N DIR,DIROUT,DIRUT,DTOUT,DUOUT,X,Y
"RTN","SD53P377",45,0)
 I $E(IOST,1,2)'="C-" Q 0  ;not a terminal
"RTN","SD53P377",46,0)
 S DIR(0)="E"
"RTN","SD53P377",47,0)
 D ^DIR
"RTN","SD53P377",48,0)
 Q 'Y
"RTN","SD53P377",49,0)
 ;
"RTN","SD53P377",50,0)
 ;MAIL MESSAGE
"RTN","SD53P377",51,0)
 ;
"RTN","SD53P377",52,0)
 ;N XMSUB,XMY,XMTEXT,XMDUZ
"RTN","SD53P377",53,0)
 ;S XMSUB="Scheduling 5.3 - Clinic Without Phyiscal Locations for Routing Slip Sort."
"RTN","SD53P377",54,0)
 ;S XMY("G.APPOINTMENT MANAGEMENT")=""
"RTN","SD53P377",55,0)
 ;K ^TMP("SD53P377",$J)
"RTN","SD53P377",56,0)
 ;I '$D(^TMP("SD53P377",$J)) D
"RTN","SD53P377",57,0)
 ;.S ^TMP("SD53P377",$J,999999)="All Phys Locations are populated."
"RTN","SD53P377",58,0)
 ;S XMTEXT="^TMP(""SD53P377"",$J,"
"RTN","SD53P377",59,0)
 ;S XMDUZ="POSTMASTER"
"RTN","SD53P377",60,0)
 ;D ^XMD
"RTN","SD53P377",61,0)
 Q
"RTN","SDROUT")
0^1^B19382618
"RTN","SDROUT",1,0)
SDROUT ;BSN/GRR - ROUTING SLIPS ; 26 APR 84  11:26 am
"RTN","SDROUT",2,0)
 ;;5.3;Scheduling;**3,39,377**;Aug 13, 1993
"RTN","SDROUT",3,0)
 N VAUTC,SDPLSRT,SDMATCH
"RTN","SDROUT",4,0)
 S (SDIQ,SDX,DIV,SDREP,SDSTART)="" D DIV^SDUTL I $T D ROUT^SDDIV G:Y<0 END
"RTN","SDROUT",5,0)
R1 S %=2 W !,"DO YOU WANT ROUTING SHEET FOR A SINGLE PATIENT" D YN^DICN I '% D QQ G R1
"RTN","SDROUT",6,0)
 G:%<0 END S SDSP=$S(%=2:"N",1:"Y") G:SDSP["Y" SIN1^SDROUT1
"RTN","SDROUT",7,0)
R2 R !,"WANT (A)LL ROUTING SHEETS OR (O)NLY ADD-ONS: ONLY ADD-ONS// ",X:DTIME G:X["^"!('$T) END I X="" S X="O" W X
"RTN","SDROUT",8,0)
 S Z="^ALL ROUTING SHEETS^ONLY ADD-ONS" D IN^DGHELP I %=-1 W !?12,"CHOOSE FROM:",!?12,"O - To only see add-ons",!?9,"or A - To see all routing sheets" G R2
"RTN","SDROUT",9,0)
 S SDX=$S(X="O":"ADD-ONS",1:"ALL")
"RTN","SDROUT",10,0)
R22 S ORDER=0,DIR(0)="S^T:TERMINAL DIGIT;N:NAME;C:CLINIC;P:PHYSICAL LOCATION",DIR("B")="T",DIR("A")="PRINT IN",DIR("?")="^D HELP^SDROUT" D ^DIR
"RTN","SDROUT",11,0)
 G:Y<0!$D(DTOUT)!$D(DIROUT)!$D(DIRUT) R2
"RTN","SDROUT",12,0)
 S X=Y K DIR,DTOUT,DIROUT,DIRUT
"RTN","SDROUT",13,0)
R4 S ORDER=$S(X="T":1,X="N":"",X="P":3,1:2)
"RTN","SDROUT",14,0)
 ;
"RTN","SDROUT",15,0)
RPL I ORDER=3 D
"RTN","SDROUT",16,0)
 .S DIR("?")="Enter Physical Location to sort by. Must be an exact match"
"RTN","SDROUT",17,0)
 .S DIR("??")="Enter Physical Location to sort by. Must be an exact matchas this is a Free Text field."
"RTN","SDROUT",18,0)
 .S DIR(0)="F^1:25",DIR("A")="ENTER PHYSICAL LOCATION TO SORT BY"
"RTN","SDROUT",19,0)
 .S DIR("B")="ALL" D ^DIR
"RTN","SDROUT",20,0)
 I ORDER=3,Y<0!$D(DTOUT)!$D(DIROUT)!$D(DIRUT) Q
"RTN","SDROUT",21,0)
 I ORDER=3 S SDPLSRT=X
"RTN","SDROUT",22,0)
 I ORDER=3,$$PLVAL'=1 W !,"Not an exact match!" G RPL
"RTN","SDROUT",23,0)
 I ORDER=3 K DIR,DTOUT,DIROUT,DIRUT
"RTN","SDROUT",24,0)
 ;
"RTN","SDROUT",25,0)
 D:'$D(DT) DT^SDUTL S %DT="AEXF",%DT("A")="PRINT ROUTING SLIPS FOR WHAT DATE: " D ^%DT K %DT("A") G:Y<1 END S SDATE=Y
"RTN","SDROUT",26,0)
A5 S %=2 W !,"IS THIS A REPRINT OF A PREVIOUS RUN" D YN^DICN I '% D QQ G A5
"RTN","SDROUT",27,0)
 Q:%<0  I '(%-1) S POP=0 D REP^SDROUT1 Q:POP
"RTN","SDROUT",28,0)
 I ORDER=2,SDREP="" G END:'$$CLINIC(DIV,.VAUTC)
"RTN","SDROUT",29,0)
 I ORDER=3,SDREP="" G END:'$$CLINIC(DIV,.VAUTC)
"RTN","SDROUT",30,0)
 S VAR="DIV^VAUTC^VAUTC(^SDX^ORDER^SDATE^SDIQ^SDREP^SDSTART^SDLOC^SDPLSRT"
"RTN","SDROUT",31,0)
 S DGPGM="START^SDROUT"
"RTN","SDROUT",32,0)
 D ZIS^DGUTQ G:POP END^SDROUT1
"RTN","SDROUT",33,0)
 G START
"RTN","SDROUT",34,0)
START K ^UTILITY($J) U IO
"RTN","SDROUT",35,0)
 S Y=SDATE D DTS^SDUTL S APDATE=Y,Y=DT D DTS^SDUTL S PRDATE=Y
"RTN","SDROUT",36,0)
 F SC=0:0 S SC=$O(^SC(SC)) Q:SC<1  D CHECK I $T S GDATE=SDATE F K=0:0 S GDATE=$O(^SC(SC,"S",GDATE)) Q:GDATE<1!(GDATE>(SDATE+1))  I $D(^SC(SC,"S",GDATE,1)) F L=0:0 S L=$O(^SC(SC,"S",GDATE,1,L)) Q:L<1  I $D(^(L,0)),$P(^(0),U,9)'="C" D GOT^SDROUT0
"RTN","SDROUT",37,0)
 G GO^SDROUT0
"RTN","SDROUT",38,0)
CHECK I $P(^SC(SC,0),"^",3)="C",$S(DIV="":1,$P(^SC(SC,0),"^",15)=DIV:1,1:0),$S('$D(^SC(SC,"I")):1,+^("I")=0:1,+^("I")>SDATE:1,+$P(^("I"),"^",2)'>SDATE&(+$P(^("I"),"^",2)):1,1:0)
"RTN","SDROUT",39,0)
 I $T,$S(ORDER'=2:1,SDREP:1,VAUTC=1:1,1:$D(VAUTC(SC)))
"RTN","SDROUT",40,0)
 Q
"RTN","SDROUT",41,0)
QQ W !,"RESPOND YES OR NO" Q
"RTN","SDROUT",42,0)
END K VAUTC,ALL,DIV,ORD,ORDER,RMSEL,SDIQ,SDREP,SDSP,SDSTART,SDX,X,Y,C,V,I,SDEF,%I Q
"RTN","SDROUT",43,0)
 ;
"RTN","SDROUT",44,0)
CLINIC(SDIV,VAUTC) ;
"RTN","SDROUT",45,0)
 N DIV,SDX,ORDER,SDATE,SDIQ,SDREP,SDSTART,VAUTD
"RTN","SDROUT",46,0)
 I 'SDIV S VAUTD=1
"RTN","SDROUT",47,0)
 I SDIV S VAUTD=0,VAUTD(SDIV)=$P($G(^DG(40.8,SDIV,0)),U)
"RTN","SDROUT",48,0)
 Q $$CLINIC1()
"RTN","SDROUT",49,0)
 ;
"RTN","SDROUT",50,0)
CLINIC1() ; -- get clinic data
"RTN","SDROUT",51,0)
 ;  input: VAUTD  := divisions selected
"RTN","SDROUT",52,0)
 ; output: VAUTC := clinic selected (VAUTC=1 for all)
"RTN","SDROUT",53,0)
 ; return: was selection made [ 1|yes   0|no]
"RTN","SDROUT",54,0)
 ;
"RTN","SDROUT",55,0)
 W !!,$$LINE^SDAMO("Clinic Selection")
"RTN","SDROUT",56,0)
 ;
"RTN","SDROUT",57,0)
 ; -- select clinics
"RTN","SDROUT",58,0)
 ; -- call generic clinic screen, correct division
"RTN","SDROUT",59,0)
 ;
"RTN","SDROUT",60,0)
 S DIC("S")="I $$CLINIC2^SDROUT(Y),$S(VAUTD:1,$D(VAUTD(+$P(^SC(Y,0),U,15))):1,'+$P(^(0),U,15)&$D(VAUTD(+$O(^DG(40.8,0)))):1,1:0)"
"RTN","SDROUT",61,0)
 S DIC="^SC(",VAUTSTR="clinic",VAUTVB="VAUTC",VAUTNI=2
"RTN","SDROUT",62,0)
 D FIRST^VAUTOMA
"RTN","SDROUT",63,0)
 ;
"RTN","SDROUT",64,0)
 I Y<0 K VAUTC
"RTN","SDROUT",65,0)
CLINICQ Q $D(VAUTC)>0
"RTN","SDROUT",66,0)
 ;
"RTN","SDROUT",67,0)
CLINIC2(SDCL) ; -- generic screen for hos. loc. entries
"RTN","SDROUT",68,0)
 ; input:   SDCL := ifn of HOSPITAL LOCATION file
"RTN","SDROUT",69,0)
 ;      returned := [ 0 | do not use entry ; 1 | use entry ]
"RTN","SDROUT",70,0)
 ;
"RTN","SDROUT",71,0)
 ; -- must be a clinic
"RTN","SDROUT",72,0)
 N X S X=$G(^SC(SDCL,0))
"RTN","SDROUT",73,0)
 Q $P(X,"^",3)="C"
"RTN","SDROUT",74,0)
 ;
"RTN","SDROUT",75,0)
PLVAL() ; Physical Location Validation.
"RTN","SDROUT",76,0)
 N SDCLIN,SDPLOC
"RTN","SDROUT",77,0)
 S SDMATCH=0
"RTN","SDROUT",78,0)
 I SDPLSRT="ALL" S SDMATCH=1 Q SDMATCH
"RTN","SDROUT",79,0)
 S SDCLIN="" F  S SDCLIN=$O(^SC(SDCLIN)) Q:SDCLIN=""!(SDMATCH=1)  D
"RTN","SDROUT",80,0)
 .S SDPLOC=$P($G(^SC(SDCLIN,0)),"^",11)
"RTN","SDROUT",81,0)
 .I SDPLOC=SDPLSRT S SDMATCH=1
"RTN","SDROUT",82,0)
 Q SDMATCH
"RTN","SDROUT",83,0)
HELP W !?12,"CHOOSE FROM:",!?12,"T - To see routing slips sorted in terminal digit order",!?12,"N - To see routing slips sorted in alphabetical order by name",!?12,"C - To see routing slips printed by clinic " D
"RTN","SDROUT",84,0)
 .W !,?12,"or P - To see routing slip printed by physical location"
"RTN","SDROUT0")
0^4^B20877493
"RTN","SDROUT0",1,0)
SDROUT0 ;BSN/GRR - ROUTING SLIPS BY CLINIC ;11/12/91  16:07
"RTN","SDROUT0",2,0)
 ;;5.3;Scheduling;**343,377**;Aug 13, 1993
"RTN","SDROUT0",3,0)
GO S SDCNT=0 D GO1 G:ORDER=2!(ORDER=3) CLIN
"RTN","SDROUT0",4,0)
 F G=0:0 S I=$O(^UTILITY($J,I)) Q:I=""  F J=0:0 S J=$O(^UTILITY($J,I,J)) Q:J=""  S P=0 D HED^SDROUT2,HD^SDROUT2,CNT F K=0:0 S K=$O(^UTILITY($J,I,J,K)) D:K="" FUT Q:K=""  S L=0 F LL=0:0 S L=$O(^UTILITY($J,I,J,K,L)) Q:L=""  D LIN,X
"RTN","SDROUT0",5,0)
 W:IOF]"" !,@IOF G END^SDROUT1
"RTN","SDROUT0",6,0)
CNT S SDCNT=SDCNT+1 Q
"RTN","SDROUT0",7,0)
X I $P(^UTILITY($J,I,J,K,L),"^")]"" W !,?4,$P(^(L),"^") Q
"RTN","SDROUT0",8,0)
 I $D(^DPT(+J,.36)),$D(^DIC(8,+^DPT(+J,.36),0)),$P(^(0),"^",9)=13 W !,?4,"** COLLATERAL **"
"RTN","SDROUT0",9,0)
 Q
"RTN","SDROUT0",10,0)
GO1 S I=0 Q:'SDREP!(SDX'["ALL")!(SDSTART="0000")  I SDSTART?4N S SDZ=(SDSTART-1)/10000,SDZ=$P(SDZ,".",2),SDZ=SDZ_$E("0000",1,4-$L(SDZ)),I=" "_SDZ K SDZ Q
"RTN","SDROUT0",11,0)
 I '$D(^UTILITY($J,SDSTART)) S I=SDSTART Q
"RTN","SDROUT0",12,0)
 S SDZ=$A($E(SDSTART,$L(SDSTART))),I=$E(SDSTART,1,$L(SDSTART)-1)_$C(SDZ-1) K SDZ Q
"RTN","SDROUT0",13,0)
GOT S DFN=$P(^SC(SC,"S",GDATE,1,L,0),"^") S POP=1 D CKP Q:POP
"RTN","SDROUT0",14,0)
 S NAME=$P(^DPT(DFN,0),"^"),TDO=$P(^(0),"^",9),TDO=$E(TDO,8,9)_$E(TDO,6,7)
"RTN","SDROUT0",15,0)
 D ^SDROUT1 G TDO:ORDER=1,CLO:ORDER=2,PLOC:ORDER=3 D COL S ^UTILITY($J,NAME,DFN,GDATE,SC)=$S(V:"** COLLATERAL **",1:"") K V
"RTN","SDROUT0",16,0)
 Q
"RTN","SDROUT0",17,0)
TDO D COL S ^UTILITY($J," "_TDO,DFN,GDATE,SC)=$S(V:"** COLLATERAL **",1:"") Q
"RTN","SDROUT0",18,0)
CLO D COL S SCN=$S($D(^SC(SC,0)):$P(^(0),"^"),1:SC),^UTILITY($J,"A",SCN," "_TDO,DFN)=SC_$S(V:"^** COLLATERAL **",1:""),^UTILITY($J,"B",DFN,GDATE)=SC K V Q
"RTN","SDROUT0",19,0)
PLOC I VAUTC=0,'$D(VAUTC(SC)) Q
"RTN","SDROUT0",20,0)
 D COL
"RTN","SDROUT0",21,0)
 S SDLOC=$P($G(^SC(SC,0)),"^",11) I SDLOC="" S SDLOC="NOT DEFINED"
"RTN","SDROUT0",22,0)
 I SDLOC'=SDPLSRT,SDPLSRT'="ALL" Q
"RTN","SDROUT0",23,0)
 S ^UTILITY($J,"A",SDLOC," "_TDO,DFN)=SC_$S(V:"** COLLATERAL **",1:"")
"RTN","SDROUT0",24,0)
 S ^UTILITY($J,"B",DFN,GDATE)=SC
"RTN","SDROUT0",25,0)
 K V
"RTN","SDROUT0",26,0)
 Q
"RTN","SDROUT0",27,0)
COL S V=0 I $P(^SC(SC,"S",GDATE,1,L,0),"^",10)]"" S V=$P(^(0),"^",10),V=$S($D(^DIC(8,+V,0)):$P(^(0),"^",9)=13,1:0)
"RTN","SDROUT0",28,0)
 Q
"RTN","SDROUT0",29,0)
CKP I SDREP D CKP1 Q
"RTN","SDROUT0",30,0)
 I $D(^DPT(DFN,"S",GDATE,0)),$P(^(0),"^",2)'["C",$S($D(SDI1):1,SDX["ALL":1,SDIQ=1:1,$P(^(0),"^",6)'["Y":1,1:0) S POP=0
"RTN","SDROUT0",31,0)
 Q
"RTN","SDROUT0",32,0)
CKP1 I $S('$D(^DPT(DFN,"S",GDATE,0)):1,$P(^(0),"^",2)["C":1,1:0) S POP=1 Q
"RTN","SDROUT0",33,0)
 I SDX["ALL" S POP=0 Q
"RTN","SDROUT0",34,0)
 I $P(^DPT(DFN,"S",GDATE,0),"^",13)']""!($P(^(0),"^",13)=SDSTART) S POP=0,$P(^(0),"^",13)=SDSTART Q
"RTN","SDROUT0",35,0)
 S POP=1 Q
"RTN","SDROUT0",36,0)
LIN S X=K D TM W !,$J(X,8) I $D(^SC(L,0)) W ?11,$P(^(0),"^",1) D LOC W ?42,SDLOC K SDLOC D:$D(^DPT(J,"S",K,0)) SETP W:'$D(^DPT(J,"S",K,0)) ?70,"*DELETED*" D SCCOND^SDROUT2
"RTN","SDROUT0",37,0)
 W:'$D(^SC(L,0)) ?11,L
"RTN","SDROUT0",38,0)
 D:$Y>(IOSL-5) HED^SDROUT2 Q
"RTN","SDROUT0",39,0)
LOC S SDLOC=$P(^SC(L,0),"^",11) I SDLOC']"",$D(^DIC(4,+$$SITE^VASITE,"DIV")),^("DIV")="Y" S SDLOC=$S($P(^SC(L,0),"^",15)=DIV:"",$D(^DG(40.8,+$P(^SC(L,0),"^",15),0)):$P(^(0),"^",1),1:"")
"RTN","SDROUT0",40,0)
 Q
"RTN","SDROUT0",41,0)
FUT I $O(^DPT(J,"S",SDATE_".9"))>0 D HED2 F M=SDATE_".9":0 S M=$O(^DPT(J,"S",M)) Q:M=""  D:$Y>(IOSL-5) HED^SDROUT2 I $S($P(^DPT(J,"S",M,0),"^",2)']"":1,$P(^(0),"^",2)="I":1,1:0) D LIN2
"RTN","SDROUT0",42,0)
 I SDREP,SDX'["ALL" W !!,"DATE PRINTED  : " S Y=SDSTART D DTS^SDUTL W Y,!,"DATE REPRINTED: ",PRDATE Q
"RTN","SDROUT0",43,0)
 W !!,"DATE PRINTED: ",PRDATE Q
"RTN","SDROUT0",44,0)
LIN2 D LIN2^SDROUT1
"RTN","SDROUT0",45,0)
 S L=+^DPT(J,"S",M,0),X=M D TM S Y=M D DTS^SDUTL W !,Y,?11,$J(X,8),?20,$P(^SC(L,0),"^",1) D LOC W ?52,SDLOC K SDLOC
"RTN","SDROUT0",46,0)
 Q
"RTN","SDROUT0",47,0)
HED2 W !!,?9,"**FUTURE APPOINTMENTS**"
"RTN","SDROUT0",48,0)
 W !!,"  DATE",?11,"TIME",?21,"CLINIC",?55,"LOCATION",! Q
"RTN","SDROUT0",49,0)
TM I $P(X,".",2)']"" S X1=""
"RTN","SDROUT0",50,0)
 S X=$E($P(X,".",2)_"0000",1,4),%=X>1159 S:X>1259 X=X-1200 S X=X\100_":"_$E(X#100+100,2,3)_" "_$E("AP",%+1)_"M" Q
"RTN","SDROUT0",51,0)
SETP S $P(^DPT(J,"S",K,0),"^",6)="Y" I $P(^(0),"^",13)']"" S $P(^(0),"^",13)=DT
"RTN","SDROUT0",52,0)
 Q
"RTN","SDROUT0",53,0)
CLIN F G=0:0 S I=$O(^UTILITY($J,"A",I)) Q:I=""  S SDTD=0 F H=0:0 S SDTD=$O(^UTILITY($J,"A",I,SDTD)) Q:SDTD=""  F J=0:0 S J=$O(^UTILITY($J,"A",I,SDTD,J)) Q:J=""  I ^(J) S SC=+^(J),POP=1 D FIRST I 'POP S P=0 D HED^SDROUT2,HD^SDROUT2,CNT,TIME
"RTN","SDROUT0",54,0)
 W:IOF]"" !,@IOF G END^SDROUT1
"RTN","SDROUT0",55,0)
FIRST I ORDER=3 S POP=0 Q
"RTN","SDROUT0",56,0)
 F A=SDATE:0 S A=$O(^DPT(J,"S",A)) Q:(A'>0)!($P(A,".")'=SDATE)  I $P(^(A,0),"^",2)'["C" S SD=+^(0) I $D(^SC(SD,0)),$S(DIV="":1,$P(^SC(SD,0),"^",15)=DIV:1,1:0) S:SD=+SC POP=0 Q
"RTN","SDROUT0",57,0)
 Q
"RTN","SDROUT0",58,0)
TIME F K=0:0 S K=$O(^UTILITY($J,"B",J,K)) D:K="" FUT Q:K=""  S L=^(K) D LIN,X1
"RTN","SDROUT0",59,0)
 Q
"RTN","SDROUT0",60,0)
X1 I $P(^UTILITY($J,"A",I,SDTD,J),"^",2)]"" W !,?4,$P(^(J),"^",2) Q
"RTN","SDROUT0",61,0)
 I $D(^DPT(+J,.36)),$D(^DIC(8,+^DPT(+J,.36),0)),$P(^(0),"^",9)=13 W !,?4,"** COLLATERAL **"
"RTN","SDROUT0",62,0)
 Q
"RTN","SDROUT1")
0^2^B19815535
"RTN","SDROUT1",1,0)
SDROUT1 ;MAN/GRR - ROUTING SLIPS ;3/5/92  13:21
"RTN","SDROUT1",2,0)
 ;;5.3;Scheduling;**3,377**;Aug 13, 1993
"RTN","SDROUT1",3,0)
AO S HGDT=GDATE,SDHSC=SC F SDI=3,4,5 I $P(^DPT(DFN,"S",HGDT,0),"^",SDI)]"" S GDATE=$P(^(0),"^",SDI),SC=$S(SDI=3:"LAB",SDI=4:"XRAY",1:"EKG") D OSET
"RTN","SDROUT1",4,0)
 S GDATE=HGDT,SC=SDHSC K HGDT,SDHSC Q
"RTN","SDROUT1",5,0)
OSET ;
"RTN","SDROUT1",6,0)
 I ORDER="" S ^UTILITY($J,NAME,DFN,GDATE,SC)="" Q
"RTN","SDROUT1",7,0)
 I ORDER=1 S ^UTILITY($J," "_TDO,DFN,GDATE,SC)="" Q
"RTN","SDROUT1",8,0)
 S ^UTILITY($J,"B",DFN,GDATE)=SC Q
"RTN","SDROUT1",9,0)
LIN2 S SDM=M F SDI=3,4,5 I $P(^DPT(J,"S",SDM,0),"^",SDI)]"" S (X,M)=$P(^(0),"^",SDI) D TM^SDROUT0 S Y=M D DTS^SDUTL W !,Y,?11,$J(X,8),?20,$S(SDI=3:"LAB",SDI=4:"XRAY",1:"EKG") Q:($Y>(IOSL-1))
"RTN","SDROUT1",10,0)
 S M=SDM K SDM,SDI Q
"RTN","SDROUT1",11,0)
SIN1 S ORDER="",SDCNT=0
"RTN","SDROUT1",12,0)
SIN Q:SDIQ=1  S DIC="^DPT(",DIC(0)="AEQM" D ^DIC G:X="^"!(X="") END I Y<0 W !,"PATIENT NOT FOUND" G SIN
"RTN","SDROUT1",13,0)
 S DFN=+Y D:'$D(DT) DT^SDUTL
"RTN","SDROUT1",14,0)
EN S VAR="DIV^ORDER^SDX^DFN^SDREP^SDSTART^SDLOC^SDPLSRT",DGPGM="EN1^SDROUT1"
"RTN","SDROUT1",15,0)
 D ZIS^DGUTQ G:POP END
"RTN","SDROUT1",16,0)
EN1 ; -- main entry point
"RTN","SDROUT1",17,0)
 ; required input: as defined in VAR above
"RTN","SDROUT1",18,0)
 ; optional input:
"RTN","SDROUT1",19,0)
 ;   SDPARMS("START")        := start date for appts
"RTN","SDROUT1",20,0)
 ;          ("DO NOT CLOSE") := [1 or 0] if 1 then device will stay open
"RTN","SDROUT1",21,0)
 ;
"RTN","SDROUT1",22,0)
 U IO K ^UTILITY($J) S Y=DT D DTS^SDUTL S PRDATE=Y,P=0,GDATE=DT,SDIQ=1,NAME=$P(^DPT(DFN,0),"^",1),J=DFN,ORDER="",APDATE="",SDREP=$S($D(SDREP):SDREP,1:""),SDX=$S($D(SDX):SDX,1:""),SDSTART=$S($D(SDSTART):SDSTART,1:"")
"RTN","SDROUT1",23,0)
 S SDATE=+$G(SDPARMS("START")) S:'SDATE SDATE=DT
"RTN","SDROUT1",24,0)
 I '$D(^DPT(DFN,"S")) G NOAP
"RTN","SDROUT1",25,0)
 S NDATE=$O(^DPT(DFN,"S",SDATE)) I NDATE\1'=SDATE G NOCA
"RTN","SDROUT1",26,0)
 S Y=DT D DTS^SDUTL S APDATE=Y
"RTN","SDROUT1",27,0)
 K SDA F GDATE=SDATE:0 S GDATE=$O(^DPT(DFN,"S",GDATE)) Q:GDATE=""!(GDATE\1-SDATE)  I $P(^(GDATE,0),"^",2)="I"!($P(^(0),"^",2)="") D GOT
"RTN","SDROUT1",28,0)
 G:'$D(SDA) NOCA G GO^SDROUT0
"RTN","SDROUT1",29,0)
NOCA D HED^SDROUT2,HD^SDROUT2 D:'$D(SDSCCOND) SCCOND^SDROUT2 W !!! D FUT^SDROUT0 W !,@IOF G END
"RTN","SDROUT1",30,0)
NOAP D HED^SDROUT2,HD^SDROUT2 D:'$D(SDSCCOND) SCCOND^SDROUT2 W !!! D HED2^SDROUT0
"RTN","SDROUT1",31,0)
 I $D(SDREP),SDREP,SDX'["ALL" S Y=SDSTART D DTS^SDUTL W !!,"DATE PRINTED  : ",Y,!,"DATE REPRINTED: ",PRDATE
"RTN","SDROUT1",32,0)
 I '$T W !!,"DATE PRINTED: ",PRDATE
"RTN","SDROUT1",33,0)
 W !,@IOF G END
"RTN","SDROUT1",34,0)
GOT S SDA="",NAME=$P(^DPT(DFN,0),"^",1),SC=$P(^DPT(DFN,"S",GDATE,0),"^",1),Y=SDATE D DTS^SDUTL S APDATE=Y D AO,SC S ^UTILITY($J,NAME,DFN,GDATE,SC)=$S(V:"** COLLATERAL **",1:"")
"RTN","SDROUT1",35,0)
 Q
"RTN","SDROUT1",36,0)
SC I $D(^DPT(DFN,.36)),$D(^DIC(8,+^DPT(DFN,.36),0)),$P(^(0),"^",9)=13 S V=1 Q
"RTN","SDROUT1",37,0)
 S V=0 F M=0:0 S M=$O(^SC(SC,"S",GDATE,1,M)) Q:M'>0  I $D(^(M,0)),+^(0)=DFN,$P(^(0),"^",9)'["C" S V=$P(^(0),"^",10) Q:V']""  S V=$S($D(^DIC(8,+V,0)):$P(^(0),"^",9)=13,1:0) Q
"RTN","SDROUT1",38,0)
 Q
"RTN","SDROUT1",39,0)
END I $D(SDCNT) D:SDCNT>1 END1
"RTN","SDROUT1",40,0)
 W:'$G(SDPARMS("DO NOT CLOSE")) !
"RTN","SDROUT1",41,0)
 K %,%DT,%I,ADDR,ALL,APDATE,DFN,DGMT,DIC,DIV,G,GDATE,H,I,J,K,L,LL,M,NAME,NDATE,ORD,ORDER,P,POP,PRDATE
"RTN","SDROUT1",42,0)
 K SC,SDA,SDATE,SDCNT,SDI,SDI1,SDIQ,SDM,SDREP,SDSP,SDSTART,SDVA,SDX,SDX1,SSN,SZ,TDO,X,X1,Y,ZIP,ZX,VAR,C,V,SDEF,A,SD,SCN,SDTD,SDSCCOND
"RTN","SDROUT1",43,0)
 D:'$G(SDPARMS("DO NOT CLOSE")) CLOSE^DGUTQ
"RTN","SDROUT1",44,0)
 Q
"RTN","SDROUT1",45,0)
 ;
"RTN","SDROUT1",46,0)
END1 W !!?2,"***FACILITY: ",$S($D(^DG(40.8,+DIV,0)):$P(^(0),"^",1),1:$P($$SITE^VASITE,U,2)),?48," PRINTED: " D NOW^%DTC S Y=$E(%,1,12) X ^DD("DD") W Y
"RTN","SDROUT1",47,0)
 W !!!?25,"ROUTING SLIPS PRINTED FOR ",!?32 S Y=SDATE X ^DD("DD") W Y,!!!!?20,"TOTAL NUMBER OF ROUTING SLIPS PRINTED: ",SDCNT Q
"RTN","SDROUT1",48,0)
 ;Parameters For Reprint
"RTN","SDROUT1",49,0)
REP S SDREP=1 G:SDX["ALL" ALL S %DT("A")="REPRINT ADD-ONS THAT WERE RUN ON WHAT DATE: ",%DT="AEX" D ^%DT K %DT("A") I Y<1 S POP=1 Q
"RTN","SDROUT1",50,0)
 S SDSTART=Y Q
"RTN","SDROUT1",51,0)
ALL W !,"ENTER ",$S(ORDER=1:"TERMINAL DIGIT",ORDER=2:"CLINIC NAME",ORDER=3:"PHYSICAL LOCATION",1:"PATIENT NAME")," TO BEGIN REPRINT FROM: " R X:DTIME I X["?" D HELP G ALL
"RTN","SDROUT1",52,0)
 I "^"[X S POP=1 Q
"RTN","SDROUT1",53,0)
 I ORDER=1,X'?4N W !,*7,"MUST BE 4 NUMERICS" G ALL
"RTN","SDROUT1",54,0)
 S SDSTART=X Q
"RTN","SDROUT1",55,0)
DQ S ZTREQ="@" G EN1
"RTN","SDROUT1",56,0)
HELP W !!,"THE REPRINT WILL BEGIN PRINTING AT THE ",$S(ORDER=1:"TERMINAL DIGIT",ORDER=2:"CLINIC NAME",ORDER=3:"PHYSICAL LOCATION",1:"PATIENT NAME")," YOU SPECIFY",!
"RTN","SDROUT1",57,0)
 W "TERMINAL DIGITS MUST BE ENTERED IN TERMINAL DIGIT ORDER",!,"I.E., LAST TWO DIGITS OF SSN PRECEDING THE SIXTH AND SEVENTH DIGITS",! Q
"RTN","SDROUT2")
0^3^B14224078
"RTN","SDROUT2",1,0)
SDROUT2 ;BSN/GRR - PRINT ROUTING SLIPS HEADING ; 4/24/01 3:10pm
"RTN","SDROUT2",2,0)
 ;;5.3;Scheduling;**28,377**;Aug 13, 1993
"RTN","SDROUT2",3,0)
HED W !,@IOF,"*** FACILITY: ",$S($D(^DG(40.8,+DIV,0)):$P(^(0),"^"),1:$P($$SITE^VASITE,U,2)) S P=P+1
"RTN","SDROUT2",4,0)
 I ORDER=2 W !,"*** CLINIC: ",$P(^SC(+SC,0),"^")
"RTN","SDROUT2",5,0)
 I ORDER=3 W !,"*** PHYSICAL LOCATION: "_I
"RTN","SDROUT2",6,0)
 I $D(^DPT(J,.321)) F SDX1=1,2,3 I $P(^(.321),"^",SDX1)["Y" Q
"RTN","SDROUT2",7,0)
 ;I  W ?45,"*** EXPOSURE SURVEY ***",!
"RTN","SDROUT2",8,0)
 ;I $D(^DPT(J,.321)) F SDX1=1,2,3 I $P(^(.321),"^",SDX1)=""!($P(^(.321),"^",SDX1)["U") W ?45,"*** UPDATE SURVEY DATA ***" Q
"RTN","SDROUT2",9,0)
 ;I '$D(^DPT(J,.321)) W ?45,"*** UPDATE SURVEY DATA ***"
"RTN","SDROUT2",10,0)
 I P'>1 S SDZ="",$P(SDZ,"* ",13)="" D WCAT K SDZ
"RTN","SDROUT2",11,0)
 W !,"PAGE ",P,?10,"OUTPATIENT ROUTING SLIP"
"RTN","SDROUT2",12,0)
 I $D(^DPT(J,.36)),$P(^DPT(J,.36),"^",1)]""
"RTN","SDROUT2",13,0)
 W ?45,"*** ",$S($T:$P(^DIC(8,+^DPT(J,.36),0),"^",1),1:"ELIG NOT SPECIFIED")," ***"
"RTN","SDROUT2",14,0)
 S Y=^DPT(J,0),NAME=$P(Y,"^",1),SSN=$P(Y,"^",9)
"RTN","SDROUT2",15,0)
 W !!,NAME,?54,"APPOINTMENT DATE"
"RTN","SDROUT2",16,0)
 W !,$E(SSN,1,3),"-",$E(SSN,4,5),"-",$E(SSN,6,10),?58,APDATE
"RTN","SDROUT2",17,0)
 I $D(^DPT(J,.1)) W !!,"*** INPATIENT ***",!,"LOCATED ON WARD: ",$P(^DPT(J,.1),"^",1),! G OVR
"RTN","SDROUT2",18,0)
 S ADDR=$S($D(^DPT(J,.11)):^DPT(J,.11),1:"")
"RTN","SDROUT2",19,0)
 F LL=1:1:3 W:$P(ADDR,"^",LL)]"" !,$P(ADDR,"^",LL)
"RTN","SDROUT2",20,0)
 W !,$S($P(ADDR,"^",4)]"":$P(ADDR,"^",4),1:"")," ",$S($P(ADDR,"^",5)]"":$P(^DIC(5,+$P(ADDR,"^",5),0),"^",1),1:"")," ",$S($P(ADDR,"^",6)]"":$P(ADDR,"^",6),1:"")
"RTN","SDROUT2",21,0)
 W !!,"PSA: UNKNOWN"
"RTN","SDROUT2",22,0)
OVR W !
"RTN","SDROUT2",23,0)
 N I S DFN=J D DIS
"RTN","SDROUT2",24,0)
 N DGINSDT S DGINSDT=SDATE
"RTN","SDROUT2",25,0)
 D INS^DGRPDB,KVAR^VADPT S J=DFN
"RTN","SDROUT2",26,0)
 W ! Q
"RTN","SDROUT2",27,0)
WCAT S DGMT=$$LST^DGMTCOU1(J,"",3) Q:DGMT']""  S SDVA=$P(DGMT,U,3) I SDVA']"" Q  ;Q:$S('$D(^DG(41.3,+J,0)):1,$P(^(0),"^",2)']"":1,1:0)
"RTN","SDROUT2",28,0)
 S SDVA=$S($P(DGMT,U,4)="R":"REQUIRES MEANS TEST",$P(DGMT,U,4)="N":"MEANS TEST NOT REQUIRED",1:SDVA)
"RTN","SDROUT2",29,0)
 D KVAR^VADATE I $P(DGMT,U,2)]"",$P(DGMT,U,4)'="R",$P(DGMT,U,4)'="N" S VADAT("W")=$P(DGMT,U,2) D ^VADATE ;$N(^DG(41.3,+J,2,0))>0 S VADAT("W")=9999999-$N(^DG(41.3,J,2,0)) D ^VADATE
"RTN","SDROUT2",30,0)
 W !?27,SDZ,!?27,$S($P(DGMT,U,5)=1:SDVA,1:"PHARMACY CO-PAY: "_SDVA) I $D(VADATE("E")) W !?27,"LAST TEST: ",VADATE("E")
"RTN","SDROUT2",31,0)
 W !?27,SDZ K VADAT,VADATE,SDVA Q
"RTN","SDROUT2",32,0)
HD W !,?11,"**CURRENT APPOINTMENTS**",!!,?3,"TIME",?11,"CLINIC",?45,"LOCATION",!
"RTN","SDROUT2",33,0)
 Q
"RTN","SDROUT2",34,0)
SCCOND ;  - text on routing sheet for determining if care for sc condition.
"RTN","SDROUT2",35,0)
 S SDSCCOND=""
"RTN","SDROUT2",36,0)
 W !!?11,"List diagnosis ________________________________________________"
"RTN","SDROUT2",37,0)
 W !!?11,"List any procedures performed during this clinic visit ________",!!?11,"_______________________________________________________________"
"RTN","SDROUT2",38,0)
 D CL(J)
"RTN","SDROUT2",39,0)
 W ! Q
"RTN","SDROUT2",40,0)
 ;
"RTN","SDROUT2",41,0)
CL(DFN) ;Classification
"RTN","SDROUT2",42,0)
 N SDCLY,SDCTI,SDCTIS,SDCTS
"RTN","SDROUT2",43,0)
 D CL^SDCO21(DFN,DT,"",.SDCLY) G CLQ:'$D(SDCLY)
"RTN","SDROUT2",44,0)
 S SDCTIS=$$SEQ^SDCO21
"RTN","SDROUT2",45,0)
 W !
"RTN","SDROUT2",46,0)
 F SDCTS=1:1 S SDCTI=+$P(SDCTIS,",",SDCTS) Q:'SDCTI  I $D(SDCLY(SDCTI)) D
"RTN","SDROUT2",47,0)
 .W !,$P($G(^SD(409.41,SDCTI,0)),"^",2),"? "
"RTN","SDROUT2",48,0)
 .W "__Yes __No"
"RTN","SDROUT2",49,0)
CLQ Q
"RTN","SDROUT2",50,0)
 ;
"RTN","SDROUT2",51,0)
DIS ;rated disabilities
"RTN","SDROUT2",52,0)
 ; -- Pharmacy is allowed to call this tag via a special agreement
"RTN","SDROUT2",53,0)
 ;    with MAS.  MAS should notify pharmacy developers of any
"RTN","SDROUT2",54,0)
 ;    changes that may impact PS* code.  (5/91 - MJK/BOK)
"RTN","SDROUT2",55,0)
 ;
"RTN","SDROUT2",56,0)
 I '$D(VAEL) D ELIG^VADPT S DGKVAR=1
"RTN","SDROUT2",57,0)
 W:'+VAEL(3) !!,"Service Connected: NO" W:+VAEL(3) !!,"       SC Percent: ",$P(VAEL(3),"^",2)_"%"
"RTN","SDROUT2",58,0)
 W !,"     Disabilities: " I 'VAEL(4),$S('$D(^DG(391,+VAEL(6),0)):1,$P(^(0),"^",2):0,1:1) W "NOT A VETERAN" G DISQ
"RTN","SDROUT2",59,0)
 S I3=0 F I=0:0 S I=$O(^DPT(DFN,.372,I)) Q:'I  D DIS1
"RTN","SDROUT2",60,0)
 I 'I3 W $S('$O(^DPT(DFN,.372,0)):"NONE STATED",1:"NO SC DISABILITIES LISTED")
"RTN","SDROUT2",61,0)
DISQ I $D(DGKVAR) D KVAR^VADPT K DGKVAR,I1,I2,I3
"RTN","SDROUT2",62,0)
 Q
"RTN","SDROUT2",63,0)
DIS1 S I1=^DPT(DFN,.372,I,0) I $P(I1,"^",3) S I2=$S($D(^DIC(31,+I1,0)):^(0),1:""),I2=$S($P(I2,"^",4)]"":$P(I2,"^",4),1:$P(I2,"^")) W !,I2,?48,$J($P(I1,"^",2),4),"% - ",$S($P(I1,"^",3):"SERVICE CONNECTED",1:"") S I3=I3+1
"RTN","SDROUT2",64,0)
 Q
"VER")
8.0^22.0
"BLD",5591,6)
^SEQ #349
**END**
**END**
