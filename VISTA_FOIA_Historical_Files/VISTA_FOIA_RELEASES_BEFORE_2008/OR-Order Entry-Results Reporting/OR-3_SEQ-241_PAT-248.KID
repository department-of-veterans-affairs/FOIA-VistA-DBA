Released OR*3*248 SEQ #241
Extracted from mail message
**KIDS**:OR*3.0*248^

**INSTALL NAME**
OR*3.0*248
"BLD",6024,0)
OR*3.0*248^ORDER ENTRY/RESULTS REPORTING^0^3060612^y
"BLD",6024,4,0)
^9.64PA^^
"BLD",6024,6.3)
1
"BLD",6024,"KRN",0)
^9.67PA^8989.52^19
"BLD",6024,"KRN",.4,0)
.4
"BLD",6024,"KRN",.401,0)
.401
"BLD",6024,"KRN",.402,0)
.402
"BLD",6024,"KRN",.403,0)
.403
"BLD",6024,"KRN",.5,0)
.5
"BLD",6024,"KRN",.84,0)
.84
"BLD",6024,"KRN",3.6,0)
3.6
"BLD",6024,"KRN",3.8,0)
3.8
"BLD",6024,"KRN",9.2,0)
9.2
"BLD",6024,"KRN",9.8,0)
9.8
"BLD",6024,"KRN",9.8,"NM",0)
^9.68A^1^1
"BLD",6024,"KRN",9.8,"NM",1,0)
ORRHCQ1^^0^B12549818
"BLD",6024,"KRN",9.8,"NM","B","ORRHCQ1",1)

"BLD",6024,"KRN",19,0)
19
"BLD",6024,"KRN",19,"NM",0)
^9.68A^^
"BLD",6024,"KRN",19.1,0)
19.1
"BLD",6024,"KRN",101,0)
101
"BLD",6024,"KRN",409.61,0)
409.61
"BLD",6024,"KRN",771,0)
771
"BLD",6024,"KRN",870,0)
870
"BLD",6024,"KRN",8989.51,0)
8989.51
"BLD",6024,"KRN",8989.52,0)
8989.52
"BLD",6024,"KRN",8994,0)
8994
"BLD",6024,"KRN","B",.4,.4)

"BLD",6024,"KRN","B",.401,.401)

"BLD",6024,"KRN","B",.402,.402)

"BLD",6024,"KRN","B",.403,.403)

"BLD",6024,"KRN","B",.5,.5)

"BLD",6024,"KRN","B",.84,.84)

"BLD",6024,"KRN","B",3.6,3.6)

"BLD",6024,"KRN","B",3.8,3.8)

"BLD",6024,"KRN","B",9.2,9.2)

"BLD",6024,"KRN","B",9.8,9.8)

"BLD",6024,"KRN","B",19,19)

"BLD",6024,"KRN","B",19.1,19.1)

"BLD",6024,"KRN","B",101,101)

"BLD",6024,"KRN","B",409.61,409.61)

"BLD",6024,"KRN","B",771,771)

"BLD",6024,"KRN","B",870,870)

"BLD",6024,"KRN","B",8989.51,8989.51)

"BLD",6024,"KRN","B",8989.52,8989.52)

"BLD",6024,"KRN","B",8994,8994)

"MBREQ")
0
"PKG",110,-1)
1^1
"PKG",110,0)
ORDER ENTRY/RESULTS REPORTING^OR^Order Entry/Results Reporting
"PKG",110,20,0)
^9.402P^^
"PKG",110,22,0)
^9.49I^1^1
"PKG",110,22,1,0)
3.0^2971217
"PKG",110,22,1,"PAH",1,0)
248^3060612
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
1
"RTN","ORRHCQ1")
0^1^B12549818^B12564917
"RTN","ORRHCQ1",1,0)
ORRHCQ1 ; SLC/SRM - CPRS Query Tools - Utilities ;6/10/03  15:11
"RTN","ORRHCQ1",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**174,248**;Dec 17, 1997;Build 1
"RTN","ORRHCQ1",3,0)
 ;
"RTN","ORRHCQ1",4,0)
QRYSITR(VAL,ORRITR)       ; Do query for the standard Iterator, saving off the sensitive patients
"RTN","ORRHCQ1",5,0)
 ; VAL=PtSearched^RecordsFound^Iterator
"RTN","ORRHCQ1",6,0)
 S VAL=$$SSCREEN($P(ORRITR,";",2))
"RTN","ORRHCQ1",7,0)
 I VAL S VAL=$$PTSCRN^ORRHCQ($P(ORRITR,";",2))
"RTN","ORRHCQ1",8,0)
 I VAL S $P(VAL,U,2)=$$QRYPT^ORRHCQ($P(ORRITR,";",2))
"RTN","ORRHCQ1",9,0)
 S $P(VAL,U,3)=$$NXTITER^ORRHCQ(ORRITR)
"RTN","ORRHCQ1",10,0)
 Q
"RTN","ORRHCQ1",11,0)
 ;
"RTN","ORRHCQ1",12,0)
QSITR(VAL,SITR) ;       Do query for the current sensitive patient iterator
"RTN","ORRHCQ1",13,0)
 ; VAL=PtSearched^RecordsFound^Iterator
"RTN","ORRHCQ1",14,0)
 N LEVEL,RET
"RTN","ORRHCQ1",15,0)
 I $G(SITR)="" S SITR=0
"RTN","ORRHCQ1",16,0)
 S SITR=$O(^TMP("ORRHCQ",$J,"DFN","S",SITR))
"RTN","ORRHCQ1",17,0)
 I +SITR<1 S VAL=0_U_0_U Q
"RTN","ORRHCQ1",18,0)
 ;
"RTN","ORRHCQ1",19,0)
 ; Sensitive notifications, exclusions
"RTN","ORRHCQ1",20,0)
 ;
"RTN","ORRHCQ1",21,0)
 S LEVEL=+$G(^TMP("ORRHCQ",$J,"DFN","S",SITR))
"RTN","ORRHCQ1",22,0)
 I LEVEL=2 D 
"RTN","ORRHCQ1",23,0)
 .D NOTICE^DGSEC4(.RET,SITR,"ORRCMP QUERY TOOL^ORRCM CLIENT",1)
"RTN","ORRHCQ1",24,0)
 .I +$G(RET)=0 D ERROR("Error logging sensitive patient use.") S VAL=0_U_0_U Q
"RTN","ORRHCQ1",25,0)
 S VAL=0
"RTN","ORRHCQ1",26,0)
 I LEVEL<3 D
"RTN","ORRHCQ1",27,0)
 .S VAL=$$PTSCRN^ORRHCQ(SITR)
"RTN","ORRHCQ1",28,0)
 ;
"RTN","ORRHCQ1",29,0)
 I +VAL S $P(VAL,U,2)=$$QRYPT^ORRHCQ(SITR)
"RTN","ORRHCQ1",30,0)
 S $P(VAL,U,3)=SITR
"RTN","ORRHCQ1",31,0)
 Q
"RTN","ORRHCQ1",32,0)
 ;
"RTN","ORRHCQ1",33,0)
GETSPT(RES,START,LEN)   ;Returns a list of DFN^Patient Name^Level given a start position and a length.  The START 
"RTN","ORRHCQ1",34,0)
                 ;parameter should be in the form "NAME!DFN" (a 'bang' between name and DFN.)
"RTN","ORRHCQ1",35,0)
 N I,X S I=START,X=1
"RTN","ORRHCQ1",36,0)
 I +$G(LEN)<1 Q
"RTN","ORRHCQ1",37,0)
 F  S I=$O(^TMP("ORRHCQ",$J,"DFN","S","B",I)) Q:X>+$G(LEN)!(I="")  D
"RTN","ORRHCQ1",38,0)
 .S RES(X)=$P(I,"!",2)_U_$P(I,"!",1)_U_$G(^TMP("ORRHCQ",$J,"DFN","S","B",I)),X=X+1
"RTN","ORRHCQ1",39,0)
 Q
"RTN","ORRHCQ1",40,0)
 ;
"RTN","ORRHCQ1",41,0)
GETSLN(RES,DFN) ;Returns the sensitive patient message text lines for the given patient.
"RTN","ORRHCQ1",42,0)
 N I,CODE S RES="",I=0
"RTN","ORRHCQ1",43,0)
 I $D(^TMP("ORRHCQ",$J,"DFN","S",DFN)) D
"RTN","ORRHCQ1",44,0)
 .S CODE=^TMP("ORRHCQ",$J,"DFN","S",DFN)
"RTN","ORRHCQ1",45,0)
 .M RES=^TMP("ORRHCQ",$J,"DFN","S","MESSAGE",CODE)
"RTN","ORRHCQ1",46,0)
 Q
"RTN","ORRHCQ1",47,0)
 ;
"RTN","ORRHCQ1",48,0)
DELSEN(RES,DFN) ;Removes Sensitive Patient from list
"RTN","ORRHCQ1",49,0)
 S RES=0
"RTN","ORRHCQ1",50,0)
 I $D(^TMP("ORRHCQ",$J,"DFN","S",DFN)) D
"RTN","ORRHCQ1",51,0)
 .S RES=1 K ^TMP("ORRHCQ",$J,"DFN","S",DFN),^TMP("ORRHCQ",$J,"DFN","S","B",$$PTNAME(DFN)_"!"_DFN)
"RTN","ORRHCQ1",52,0)
 Q
"RTN","ORRHCQ1",53,0)
 ;
"RTN","ORRHCQ1",54,0)
GETCNT(LEN)     ; Returns the count of sensitive patients
"RTN","ORRHCQ1",55,0)
 S LEN=0
"RTN","ORRHCQ1",56,0)
 I $D(^TMP("ORRHCQ",$J,"DFN","S")) D
"RTN","ORRHCQ1",57,0)
 .N I S I=0
"RTN","ORRHCQ1",58,0)
 .F  S I=$O(^TMP("ORRHCQ",$J,"DFN","S",I)) Q:I'>0  S LEN=LEN+1
"RTN","ORRHCQ1",59,0)
 Q
"RTN","ORRHCQ1",60,0)
 ;
"RTN","ORRHCQ1",61,0)
SSCREEN(PATID)  ; Screen sensitive patients - returns 1 if not a sensitive patient; returns 0 if is a sensitive patient or has error
"RTN","ORRHCQ1",62,0)
 ; check for sensitive pt level here and store in "DFN","S",DFN)=LEVEL??
"RTN","ORRHCQ1",63,0)
 N RESULT,CODE
"RTN","ORRHCQ1",64,0)
 D PTSEC^DGSEC4(.RESULT,PATID,0,"ORRCMP QUERY TOOL^ORRCM CLIENT")
"RTN","ORRHCQ1",65,0)
 I $D(RESULT)<1 D ERROR("PTSEC^DGSEC4 did not return expected values.") Q 0
"RTN","ORRHCQ1",66,0)
 I $G(RESULT(1))<0 D ERROR("PTSEC^DGSEC4 returned an error code of:"_RESULT(1)) Q 0
"RTN","ORRHCQ1",67,0)
 I $G(RESULT(1))>0 D  Q 0
"RTN","ORRHCQ1",68,0)
 .S ^TMP("ORRHCQ",$J,"DFN","S",PATID)=RESULT(1),^TMP("ORRHCQ",$J,"DFN","S","B",$$PTNAME(PATID)_"!"_PATID)=RESULT(1)
"RTN","ORRHCQ1",69,0)
 .S CODE=RESULT(1) K RESULT(1)
"RTN","ORRHCQ1",70,0)
 .M ^TMP("ORRHCQ",$J,"DFN","S","MESSAGE",CODE)=RESULT
"RTN","ORRHCQ1",71,0)
 Q 1
"RTN","ORRHCQ1",72,0)
 ;
"RTN","ORRHCQ1",73,0)
ERROR(MESSAGE)  ;Log an error searching for sensitive patient information
"RTN","ORRHCQ1",74,0)
 Q
"RTN","ORRHCQ1",75,0)
 ;
"RTN","ORRHCQ1",76,0)
PTNAME(DFN) ; Returns patient name
"RTN","ORRHCQ1",77,0)
 N VADM,VA,VAERR
"RTN","ORRHCQ1",78,0)
 D DEM^VADPT
"RTN","ORRHCQ1",79,0)
 Q VADM(1)
"RTN","ORRHCQ1",80,0)
 ;
"VER")
8.0^22.0
"BLD",6024,6)
^241
**END**
**END**
