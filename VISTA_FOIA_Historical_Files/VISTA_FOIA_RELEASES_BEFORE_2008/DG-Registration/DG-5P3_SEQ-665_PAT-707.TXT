$TXT Created by DAVIS,PAULETTE T at DEVCRN.FO-ALBANY.MED.VA.GOV  (KIDS) on Tuesday, 06/05/07 at 08:51
=============================================================================
Run Date: JUN 26, 2007                     Designation: DG*5.3*707
Package : DG - REGISTRATION                   Priority: EMERGENCY
Version : 5.3       SEQ #665                    Status: Released
                  Compliance Date: JUN 28, 2007
=============================================================================

Associated patches: (v)DG*5.3*505  <<= must be installed BEFORE `DG*5.3*707'
                    (v)DG*5.3*526  <<= must be installed BEFORE `DG*5.3*707'
                    (v)DG*5.3*639  <<= must be installed BEFORE `DG*5.3*707'
                    (v)DG*5.3*711  <<= must be installed BEFORE `DG*5.3*707'

Subject: ENHANCEMENT TO VISTA PATIENT UPDATE MESSAGING

Category: 
  - Routine
  - Enhancement ()

Description:
============

  PLEASE NOTE:
  ============
  The schedules for a number of projects (e.g., Enrollment System Redesign
  (ESR), Person Service Identity Management (PSIM), Administrative Data
  Repository (ADR), etc.) are awaiting the release of patch DG*5.3*707. 
  Therefore, we are requesting, upon release of patch DG*5.3*707, that
  installation take place within forty-eight hours.
   
  This patch includes changes to the Health Level Seven version 2.4 
  generic PID segment builder used by a number of applications, including 
  the Master Patient Index, as described in DBIA 3630.  It also addresses 
  several errors and problems not necessarily related to the PID segment 
  building process.
   
  DG*5.3*505, DG*5.3*526, DG*5.3*639, and DG*5.3*711 are required builds
  for patch DG*5.3*707.
  
  Issue #1 - Update HL7 PID-3 to include the following:
  - Add ALIAS SSN. An expiration date will be added to ALIAS SSN to
  make a determination as to which SSN is the primary one in the HL7
  PID segment. The ALIAS SSN value will be in an ordered pair-wise
  relationship with the ALIAS NAME value in sequence PID-5.
  - Change the builder to send '200M' as the Assigning Authority for
  all nationally assigned ICN values (i.e., ones that start with 10.).
  '200M' is the station number for the Master Patient Index, which
  assigned the ICN value.
   
  Issue #2 - HL7 PID-11 was enhanced to include CONFIDENTIAL ADDRESSes
  and BAD ADDRESS INDICATORs.  Also, a modification to the initial
  CONFIDENTIAL ADDRESS code ensures that the address is included,
  even if it is inactive.
   
  Issue #3 - HL7 PID-13 was updated to include PAGER NUMBER, CELL
  PHONE NUMBER, and E-MAIL ADDRESS.
   
  Issue #4 - Corrected a code problem that was preventing EMAIL ADDRESS
  from being included in the PID segment.
  
  Issue #5 - Code was updated to include city with the foreign address. 
  
  Issue #6 - Routine VAFCPDAT, which is called by the Patient MPI/PD Data
  Inquiry [RG EXCEPTION TF INQUIRY] option, was modified to:
  - Display SSN Verification and Pseudo SSN Reason.
  - Remove the call to calculate CMOR score and remove the display of
    CMOR Score and Subscription Control Number.
  - Modify format of display.
  - Display the Multiple Birth Indicator label and data regardless of the
    value (e.g., YES, NO, or NULL.)  Previously, the label and data was
    only being presented if the value was YES.
  
  Issue #7 - Code was corrected to send the BAD ADDRESS INDICATOR flag
  instead of the permanent flag for bad addresses.
  
  Issue #8 - Code was changed to add an HL7 repeat delimiter between
  the legal name and alias name. 
  
  Issue #9 - During ESR testing, an undefined error occurred in routine
  VAFCQRY1 at ALIAS+6.  This was related to the use of the variable
  array VAFCA1(ALIEN) where ALIEN is 1 but it is actually located on
  node ^DPT(DFN,.01,2 and there is no ^DPT(DFN,.01,1 node.  Corrected.
  
  Issue #10 - In routine VAFCTFIN, line RECONCIL+5 was removed.  That code
  was comparing the incoming CMOR value to the site's CMOR value, and if
  they were not the same, it was setting an error message.  As the project
  moves away from the CMOR concept, and begins using Primary View, that
  code is no longer valid.
  
  Issue #11 - Added code to capture the Primary View edit criteria from 
  the triggering VistA system.  Routines VAFCSB and VAFCQRY were modified
  to include the criteria capture.
  
  Issue #12 - Added code to send only the date, instead of date/time,
  for any of the data transmitted in the HL7 PID-4 field.  Routine VAFCQRY1
  was modified to support this.
  
  Issue #13 - During testing, PSIM identified that the PAGER NUMBER could
  be passed with no value if the PAGER NUMBER stored was not in the proper
  format.  Routine VAFCQRY3 was modified to ensure that PHONE NUMBER
  [RESIDENCE], PHONE NUMBER [WORK], PHONE NUMBER [CELLULAR], and PAGER
  NUMBER are only included if the Health Level Seven format is not null,
  in addition to the VistA value not being null. 
  
  Issue #14 - Added code to VAFCPDAT to address an undefined error that
  occurred at START+19^VAFCPDAT due to the absence of fields PSEUDO SSN
  REASON (#.0906) and SSN VERIFICATION STATUS (#.0907).
  
  Issue #15 - If the ALIAS name caused the HL7 PID segment to go over 245 
  characters, it was not being handled correctly; some values would be 
  present and some would be missing.  This has been corrected in VAFCQRY1.
  
  Issue #16 - Removed the Push CMOR Request [VAFC EXCPT PUSH CMOR]
  protocol from the PIMS EXCEPTION MERGE MENU [VAFC EXCPT MERGE MENU]
  protocol.  This removes the Push CMOR Request action from within the
  Patient Data Review (PDR) [VAFC EXCEPTION HANDLER] Demographic Merge
  screen.  (Because this change takes place within a List Manager
  application, all of the protocols within the VAFC EXCPT MERGE MENU option
  are included in the build to ensure that the menu structure is exported
  properly.)
  
  Issue #17 - It was discovered that the cross-references that utilize
  the DG FIELD MONITOR process do not save off the VAFCA08 or VAFHCA08
  variables as expected.  These variable are used to stop an entry from
  being placed into the ADT/HL7 PIVOT (#391.91) file to trigger messaging
  for the field that was updated.  Routine DGFCPROT has been modified to
  support this change.
  
  Protocols:
  ==========
  VAFC EXCPT DISPLAY ONLY QUERY
  VAFC EXCPT HINQ INQUIRY
  VAFC EXCPT MERGE ALL
  VAFC EXCPT MERGE COMPLETE
  VAFC EXCPT MERGE MENU
  VAFC EXCPT MERGE REJECT
  VAFC EXCPT MERGE SELECTED
  VAFC EXCPT MERGE UNDO
  VAFC EXCPT MPI/PD DATA
  VAFC EXCPT PATIENT AUDIT
  VAFC EXCPT PATIENT INQUIRY
   
  Documentation Update:
  =====================
  The following PIMS documentation is available, updated for
  patch DG*5.3*707.  Facilities should download the revised
  documentation listed as follows:
   
    PIMS Technical Manual          DG_5_3_P707_PIMS_TM.PDF
    MPI HL7 Specification          DG_5_3_P707_MPI_HL7_Specification.PDF
   
  The preferred retrieval method is to FTP from the ANONYMOUS.SOFTWARE
  directory at: DOWNLOAD.VISTA.MED.VA.GOV
  This transmits the file from the first available FTP server.
  Sites may also elect to retrieve software directly from one
  of the following servers.
  
  OI Field Office         FTP Address                  Directory
  ------------------------------------------------------------------
  Albany             ftp.fo-albany.med.va.gov     ANONYMOUS.SOFTWARE
  Hines              ftp.fo-hines.med.va.gov      ANONYMOUS.SOFTWARE
  Salt Lake City     ftp.fo-slc.med.va.gov        ANONYMOUS.SOFTWARE
  
  Note:  These files must be transferred in binary or IMAGE,
         not ASCII, mode.
   
  The documents can also be downloaded from the VistA Documentation
  Library (VDL) Web page in both Acrobat PDF and MS-Word DOC formats:
   
      http://www.va.gov/vdl/
   
  Associated Remedy Tickets:
  ==========================
  There are no associated Remedy Tickets.
   
  Associated New Service Request (NSR):
  =====================================
  There is no associated NSR with the patch.
   
  Test Sites:
  ===========
  Augusta, GA
  Charleston, SC
  Puget Sound HCS
  San Francisco, CA
   
  Routine Summary:
  ================
  The following is a list of the routine(s) included in this patch.  The
  second line of each of these routine(s) will look like:
   
  <TAB>;;5.3;Registration;**[Patch List]**;Aug 13, 1993
   
  Using old logic: CHECK^XTSUMBLD results
  Routine       Before Patch       After Patch       Patch List
  --------      ------------       ------------      ----------
  DGFCPROT         2196632            2348037        273,526,707
  VAFCPDAT        11080622           11189647        333,414,474,505,707
  VAFCQRY          5085237            6356813        428,575,627,707
  VAFCQRY1        28523792           30315638        428,474,477,575,627,
                                                     648,698,711,707
  VAFCQRY3         7251538           26153087        575,707
  VAFCQRY4           N/A              6889506        707
  VAFCSB             N/A              3514067        707
  VAFCTFIN         8511005            7752358        428,474,520,639,707
    
  PLEASE NOTE:
  ============
  Routine VAFCSB, distributed in this patch, references routines
  LRPXAPI, PSO52API, and RAO7UTL1.  In the event that DG*5.3*707
  is installed in an account where those routines are not present,
  XINDEX may display either of these messages:
  "Reference to routine (one of the above). That isn't in this UCI."
  "Call to this MISSING LABEL (one of the above)"
   
  VAFCSB contains conditional $$PATCH^XPDUTL checks for the existence
  of the routine and quits if it is not there.  So, the code will work
  with or without the routine being present.
     
  Installation Instructions:
  ==========================
  This patch takes less than 2 minutes to install.  This patch should
  be loaded during non-peak hours to minimize disruption to the users.
   
  1. Users are allowed on the system during patch installation.
     
  2. Use the INSTALL/CHECK MESSAGE option on the Packman menu.
     Note:  TEXT PRINT/DISPLAY option in the PackMan menu will display
     the patch text only.
   
  3. In order to eliminate the failure of VistA Data Extraction Framework
     (VDEF) messaging during the patch installation it is required that you
     suspend VDEF messaging.  (Follow the example below.)
    
     Select OPTION NAME: VDEF CONFIGURATION MENU
                         VDEF Configuration and Status
   
       Site   Site-Wide Parameters
       Req    Request Queue Parameters
       ActR   Activate/Inactivate Requestor
   --> SusR   Suspend/Run Request Queue <--
       Cust   VDEF Custodial Package Activate/Inactivate
       API    VDEF Event API Activate/Inactivate
       Stat   Status of VDEF components
       Sch    Request Processor Schedule
   
     Select VDEF Configuration and Status Option: Suspend/Run Request Queue
   
     Select Request Queue: ?
     Answer with VDEF REQUEST QUEUE REQUEST QUEUE NAME:
       MAINTENANCE
       PFSS OUTBOUND QUEUE (only if you are a PFSS test site)
   
     Select Request Queue: MAINTENANCE
     SUSPENDED FLAG: RUNNING// S  SUSPENDED
   
     NOTE: If you are a Patient Financial Services System (PFSS) test site
           you will need to REPEAT STEP 3 to suspend the PFSS OUTBOUND QUEUE.
   
  4. From the Kernel Installation and Distribution System Menu, select
     the Installation menu.
   
  5. From this menu, you may elect to use the following options:
     (a)  Backup a Transport Global.
     (b)  Compare Transport Global to Current System.
     (c)  Verify Checksums in Transport Global.
     (d)  Print Transport Global.
   
  6. Use the Install Package(s) option and select the package DG*5.3*707.
       
  7. When prompted 'Want to DISABLE Scheduled Options, Menu Options, and
     Protocols? YES//', respond Yes and enter the following options:
       UPDATE BATCH JOB FOR HL7 v2.3  [VAFC BATCH UPDATE]
       Patient MPI/PD Data Inquiry    [RG EXCEPTION TF INQUIRY]
       Patient Data Review            [VAFC EXCEPTION HANDLER]
   
  8. When installation has completed, restart the VDEF queues.
     (Follow the example below.)
   
     Select OPTION NAME: VDEF CONFIGURATION MENU
                         VDEF Configuration and Status
   
       Site   Site-Wide Parameters
       Req    Request Queue Parameters
       ActR   Activate/Inactivate Requestor
   --> SusR   Suspend/Run Request Queue <--
       Cust   VDEF Custodial Package Activate/Inactivate
       API    VDEF Event API Activate/Inactivate
       Stat   Status of VDEF components
       Sch    Request Processor Schedule
    
     Select VDEF Configuration and Status Option: Suspend/Run Request Queue
    
     Select Request Queue: MAINTENANCE
     SUSPENDED FLAG: SUSPENDED // R  RUNNING
    
     NOTE: If you are a PFSS test site you will need to REPEAT STEP 8
           to run the PFSS OUTBOUND QUEUE.

Routine Information:
====================
The checksums below are new checksums, and
 can be checked with CHECK1^XTSUMBLD.

Routine Name: DGFCPROT
    Before:  B4428496   After:  B4864093  **273,526,707**
Routine Name: VAFCPDAT
    Before: B37000539   After: B37914186  **333,414,474,505,707**
Routine Name: VAFCQRY
    Before: B10987185   After: B12975534  **428,575,627,707**
Routine Name: VAFCQRY1
    Before: B64681125   After: B65006931  **428,474,477,575,627,648,698,
                                           711,707**
Routine Name: VAFCQRY3
    Before: B13092523   After: B54545905  **575,707**
Routine Name: VAFCQRY4
    Before:       n/a   After: B12814510  **707**
Routine Name: VAFCSB
    Before:       n/a   After:  B7574512  **707**
Routine Name: VAFCTFIN
    Before: B24477699   After: B22721949  **428,474,520,639,707**
 
Routine list of preceding patches: 505, 526, 639, 711

=============================================================================
User Information:
Entered By  : CHESNEY,CHRISTINE M           Date Entered  : MAR 10, 2006
Completed By: ALDERMAN,MATT S               Date Completed: JUN 22, 2007
Released By : HEUER,CINDY                   Date Released : JUN 26, 2007
=============================================================================


Packman Mail Message:
=====================

$END TXT
