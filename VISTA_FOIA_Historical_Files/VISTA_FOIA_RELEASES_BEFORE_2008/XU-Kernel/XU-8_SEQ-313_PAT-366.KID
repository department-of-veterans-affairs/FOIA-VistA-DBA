Released XU*8*366 SEQ #313
Extracted from mail message
**KIDS**:XU*8.0*366^

**INSTALL NAME**
XU*8.0*366
"BLD",531,0)
XU*8.0*366^KERNEL^0^3050907^y
"BLD",531,1,0)
^^279^279^3050906^
"BLD",531,1,1,0)
 Patch XU*8*366 (RETURN ALERTS FROM SURROGATE) resolves a patient safety
"BLD",531,1,2,0)
 issue (PSI-04-036) by modifying the handling of alerts sent to surrogates
"BLD",531,1,3,0)
 to return unprocessed alerts to the originally intended recipient of the
"BLD",531,1,4,0)
 alert after a surrogacy period ends.  As a byproduct of the changes made,
"BLD",531,1,5,0)
 it is now possible to schedule multiple different (temporal) surrogate
"BLD",531,1,6,0)
 periods in advance.
"BLD",531,1,7,0)
 
"BLD",531,1,8,0)
 Alerts are sent to the specified surrogate, or surrogates if there is a
"BLD",531,1,9,0)
 sequence of consecutive periods of surrogacy.  When a user requests a
"BLD",531,1,10,0)
 listing of alerts AND THERE ARE NO CURRENT SURROGATES (either due to the
"BLD",531,1,11,0)
 end of the surrogacy period or removal of the last surrogate) alerts which
"BLD",531,1,12,0)
 were sent to the surrogate(s) and have not been processed by the surrogate
"BLD",531,1,13,0)
 are returned to the user as new alerts with a comment indicating they were
"BLD",531,1,14,0)
 returned from the surrogate.  If the surrogate was not an intended
"BLD",531,1,15,0)
 recipient of the alert(s), either as an initially specified recipient or
"BLD",531,1,16,0)
 by receiving the alert by forwarding from another recipient, the alert will
"BLD",531,1,17,0)
 be deleted from the surrogate.  If the surrogate was an intended recipient
"BLD",531,1,18,0)
 of the alert it will also remain with the surrogate.
"BLD",531,1,19,0)
 
"BLD",531,1,20,0)
 A consequence of the modifications made to track the periods of surrogacy
"BLD",531,1,21,0)
 is the ability to add multiple surrogate periods with different start times.
"BLD",531,1,22,0)
 The  most recent active start time determines which of the surrogate periods
"BLD",531,1,23,0)
 is active.  Therefore, the termination date/time for a given period of
"BLD",531,1,24,0)
 surrogacy, if specified, only determines the end of the surrogacy if no
"BLD",531,1,25,0)
 other surrogacy period starts prior to that time.  It does not determine
"BLD",531,1,26,0)
 the actual end time if another period of surrogacy starts before the
"BLD",531,1,27,0)
 specified end time (or there was no end time specified).  A pair of
"BLD",531,1,28,0)
 users can be specified in advance as mutual surrogates with opposite rolls,
"BLD",531,1,29,0)
 as long as the periods of surrogacy do not overlap resulting in a circular
"BLD",531,1,30,0)
 relationship.
"BLD",531,1,31,0)
 
"BLD",531,1,32,0)
 In the Roll and Scroll environment, selection of Surrogate processing will
"BLD",531,1,33,0)
 list current surrogate(s) and give the option to remove one or more of the
"BLD",531,1,34,0)
 surrogates, and the option to add a surrogate, which if it is a later start
"BLD",531,1,35,0)
 date/time than a currently active or scheduled surrogate, will become active
"BLD",531,1,36,0)
 at the date/time specified.
"BLD",531,1,37,0)
 
"BLD",531,1,38,0)
 A new supported reference (SUROLIST^XQALSURO) has been added to provide a
"BLD",531,1,39,0)
 list of current and scheduled surrogates for a user.
"BLD",531,1,40,0)
 
"BLD",531,1,41,0)
 D SUROLIST^XQALSURO(XQAUSER,.XQALIST)
"BLD",531,1,42,0)
 
"BLD",531,1,43,0)
 where XQALIST is passed by reference.  On return XQALIST contains the
"BLD",531,1,44,0)
 number of entries returned, and an array containing the current and
"BLD",531,1,45,0)
 scheduled surrogates with '^'-separated values for internal entry number in
"BLD",531,1,46,0)
 the NEW PERSON file (#200), the value for the NAME field (#.01) from the
"BLD",531,1,47,0)
 NEW PERSON file (#200), the start date/time for the surrogacy period and the
"BLD",531,1,48,0)
 end date/time for the surrogacy period.  If a surrogate has no end date/time
"BLD",531,1,49,0)
 value and is followed by another surrogate, the first surrogate will show an
"BLD",531,1,50,0)
 end date/time value equal to the start date/time of the following surrogate.
"BLD",531,1,51,0)
 
"BLD",531,1,52,0)
 returns  XQALIST=count
"BLD",531,1,53,0)
          XQALIST(1)=IEN2^NEWPERSON,USER2^STARTDATETIME^ENDDATETIME
"BLD",531,1,54,0)
          XQALIST(2)=3^NAME,USER3^3050407.1227^3050409
"BLD",531,1,55,0)
 
"BLD",531,1,56,0)
 The supported reference to remove surrogates (REMVSURO^XQALSURO) has been
"BLD",531,1,57,0)
 modified to add two additional OPTIONAL arguments which specify the IEN of
"BLD",531,1,58,0)
 a surrogate and the start date/time for that surrogate session to be removed
"BLD",531,1,59,0)
 (these values can be obtained with the SUROLIST^XQALSURO call described
"BLD",531,1,60,0)
 above).  If these two optional arguments are not specified, the call to
"BLD",531,1,61,0)
 REMVSURO^XQALSURO will remove the current or next scheduled surrogate entry
"BLD",531,1,62,0)
 (as it has in the past).
"BLD",531,1,63,0)
 
"BLD",531,1,64,0)
 These features will become active in windowed applications, such as CPRS,
"BLD",531,1,65,0)
 only after the applications implement code changes to take advantage of the
"BLD",531,1,66,0)
 new functionality included in this patch.
"BLD",531,1,67,0)
 
"BLD",531,1,68,0)
 The following field (and sub-file) was added to the ALERT file (#8992):
"BLD",531,1,69,0)
 
"BLD",531,1,70,0)
 8992,2        SURROGATE              2;0 DATE Multiple #8992.02
"BLD",531,1,71,0)
 
"BLD",531,1,72,0)
               DESCRIPTION:      This field is a multiple based on the start
"BLD",531,1,73,0)
                                 date/time for a surrogate relationship.  This
"BLD",531,1,74,0)
                                 will permit multiple surrogate relationships
"BLD",531,1,75,0)
                                 to be scheduled.
"BLD",531,1,76,0)
 
"BLD",531,1,77,0)
                                 Since a start date/time for the surrogate
"BLD",531,1,78,0)
                                 relationship is required, if the user does not
"BLD",531,1,79,0)
                                 enter one, then the NOW as the current
"BLD",531,1,80,0)
                                 date/time will be used.
"BLD",531,1,81,0)
 
"BLD",531,1,82,0)
 
"BLD",531,1,83,0)
 8992.02,.01     SURROGATE START DATE/TIME 0;1 DATE (Required) (Multiply asked)
"BLD",531,1,84,0)
 
"BLD",531,1,85,0)
                 INPUT TRANSFORM:  S %DT="ESTX" D ^%DT S X=Y K:Y<1 X
"BLD",531,1,86,0)
                 LAST EDITED:      NOV 12, 2004
"BLD",531,1,87,0)
                 HELP-PROMPT:     This is the START DATE/TIME for the surrogate
"BLD",531,1,88,0)
                 DESCRIPTION:      This is the starting date and time for a
"BLD",531,1,89,0)
                                   surrogate relationship.
"BLD",531,1,90,0)
 
"BLD",531,1,91,0)
                 CROSS-REFERENCE:  8992.02^B
"BLD",531,1,92,0)
                                   1)= S ^XTV(8992,DA(1),2,"B",$E(X,1,30),DA)=
"BLD",531,1,93,0)
                                   ""
"BLD",531,1,94,0)
                                   2)= K ^XTV(8992,DA(1),2,"B",$E(X,1,30),DA)
"BLD",531,1,95,0)
 
"BLD",531,1,96,0)
 
"BLD",531,1,97,0)
 8992.02,.02     SURROGATE USER         0;2 POINTER TO NEW PERSON FILE (#200)
"BLD",531,1,98,0)
                                    (Required)
"BLD",531,1,99,0)
 
"BLD",531,1,100,0)
                 LAST EDITED:      NOV 12, 2004
"BLD",531,1,101,0)
                 HELP-PROMPT:      This is the user who will be the surrogate
"BLD",531,1,102,0)
                                   during the time period specified
"BLD",531,1,103,0)
                 DESCRIPTION:      This is a pointer to the user in the NEW
"BLD",531,1,104,0)
                                   PERSON file who will be acting as the
"BLD",531,1,105,0)
                                   surrogate for the time period specified.
"BLD",531,1,106,0)
 
"BLD",531,1,107,0)
 
"BLD",531,1,108,0)
 8992.02,.03     END DATE TIME          0;3 DATE
"BLD",531,1,109,0)
 
"BLD",531,1,110,0)
                 INPUT TRANSFORM:  S %DT="ESTX" D ^%DT S X=Y K:Y<1 X
"BLD",531,1,111,0)
                 LAST EDITED:      NOV 12, 2004
"BLD",531,1,112,0)
                 HELP-PROMPT:      This is an optional date/time for when the
"BLD",531,1,113,0)
                                   surrogate relationship will be terminated.
"BLD",531,1,114,0)
                 DESCRIPTION:      This is an optional date/time for when the
"BLD",531,1,115,0)
                                   surrogate relationship will be terminated.
"BLD",531,1,116,0)
                                   If there is no value entered, then the
"BLD",531,1,117,0)
                                   relationship will continue until it is
"BLD",531,1,118,0)
                                   specifically terminated.
"BLD",531,1,119,0)
 
"BLD",531,1,120,0)
 
"BLD",531,1,121,0)
 8992.02,.04     NEEDS RETURN           0;4 SET
"BLD",531,1,122,0)
 
"BLD",531,1,123,0)
                                   '1' FOR YES;
"BLD",531,1,124,0)
                                   '0' FOR NO;
"BLD",531,1,125,0)
                 LAST EDITED:      MAR 16, 2005
"BLD",531,1,126,0)
                 HELP-PROMPT:      This is a flag which is used to determine
"BLD",531,1,127,0)
                                   whether alerts have been returned to the
"BLD",531,1,128,0)
                                   intended recipient or not
"BLD",531,1,129,0)
                 DESCRIPTION:      This field is used as a flag to indicate
"BLD",531,1,130,0)
                                   whether the alerts have been returned to the
"BLD",531,1,131,0)
                                   intended recipient or not.
"BLD",531,1,132,0)
 
"BLD",531,1,133,0)
                 CROSS-REFERENCE:  8992.02^AC
"BLD",531,1,134,0)
                                   1)= S ^XTV(8992,DA(1),2,"AC",$E(X,1,30),DA)=
"BLD",531,1,135,0)
                                   ""
"BLD",531,1,136,0)
 
"BLD",531,1,137,0)
                                   2)= K ^XTV(8992,DA(1),2,"AC",$E(X,1,30),DA)
"BLD",531,1,138,0)
                                 3)= This x-ref is used to track alerts needing
"BLD",531,1,139,0)
                                 return from surrogates
"BLD",531,1,140,0)
                                 This cross reference is used to identify
"BLD",531,1,141,0)
                                 periods for which any alerts forwarded to a
"BLD",531,1,142,0)
                                 surrogate have not been returned to the
"BLD",531,1,143,0)
                                 intended recipient.
"BLD",531,1,144,0)
 
"BLD",531,1,145,0)
 
"BLD",531,1,146,0)
 The following field was added to the sub-file for the SURROGATE FOR field (#3)
"BLD",531,1,147,0)
 of the ALERT TRACKING file (#8992.1):
"BLD",531,1,148,0)
 
"BLD",531,1,149,0)
 
"BLD",531,1,150,0)
 
"BLD",531,1,151,0)
 8992.113,.03      DATE-TIME RETURNED 0;3 DATE
"BLD",531,1,152,0)
 
"BLD",531,1,153,0)
                       INPUT TRANSFORM:S %DT="ESTXR" D ^%DT S X=Y K:Y<1 X
"BLD",531,1,154,0)
                       LAST EDITED: MAR 16, 2005
"BLD",531,1,155,0)
                       HELP-PROMPT:This is the date-time that the alert was
"BLD",531,1,156,0)
                                 returned to the originally intended recipient
"BLD",531,1,157,0)
                       DESCRIPTION:
"BLD",531,1,158,0)
                                This field is a record for the date-time that
"BLD",531,1,159,0)
                                an alert for which this recipient was acting as
"BLD",531,1,160,0)
                                a surrogate was returned to the originally
"BLD",531,1,161,0)
                                intended recipient of the alert.
"BLD",531,1,162,0)
 
"BLD",531,1,163,0)
 
"BLD",531,1,164,0)
 In addition the AUD cross-reference was added to the ALERT DATE/TIME field
"BLD",531,1,165,0)
 (#.04) the sub-file associated with the RECIPIENT TYPE field (#1) of the
"BLD",531,1,166,0)
 ALERT TRACKING file (#8992.1).
"BLD",531,1,167,0)
 
"BLD",531,1,168,0)
 
"BLD",531,1,169,0)
 NOISs
"BLD",531,1,170,0)
 MIW-0704-40544       TIU ALERTS FOR ADDITIONAL SIGNER NOT REGENERATED
"BLD",531,1,171,0)
 ALT-0104-20049       Surrogate Setting
"BLD",531,1,172,0)
 
"BLD",531,1,173,0)
 E3Rs
"BLD",531,1,174,0)
   #19537, MULTIPLE SURROGATES
"BLD",531,1,175,0)
   #19178, DATE CHECK FOR SURROGATE ASSIGNMENT
"BLD",531,1,176,0)
   #17330, ALLOW MULTIPLE SURROGATES
"BLD",531,1,177,0)
   #16711, MULTIPLE SURROGATES FOR ALERT
"BLD",531,1,178,0)
   #16237, SELECTIVE SURROGATE DESIGNATION BY END-USER
"BLD",531,1,179,0)
 
"BLD",531,1,180,0)
 
"BLD",531,1,181,0)
 List of Test Sites
"BLD",531,1,182,0)
 ==================
"BLD",531,1,183,0)
CLARKSBURG, WV
"BLD",531,1,184,0)
PORTLAND, OR (C)
"BLD",531,1,185,0)
PUGET SOUND HCS
"BLD",531,1,186,0)
SALISBURY, NC
"BLD",531,1,187,0)
WEST PALM BEACH, FL
"BLD",531,1,188,0)
 
"BLD",531,1,189,0)
 
"BLD",531,1,190,0)
 Routine Summary:
"BLD",531,1,191,0)
 The following routines are included in this patch.  The second
"BLD",531,1,192,0)
 line of each of these routines now looks like:
"BLD",531,1,193,0)
 
"BLD",531,1,194,0)
      <tab>;;8.0;KERNEL;**[patch list]**;Jul 10, 1995
"BLD",531,1,195,0)
 
"BLD",531,1,196,0)
 Checksums:
"BLD",531,1,197,0)
 ==========
"BLD",531,1,198,0)
 Checksums obtained using CHECK^XTSUMBLD
"BLD",531,1,199,0)
 
"BLD",531,1,200,0)
  Rtn Nm    Chksum Before   Chksum After    Patch List
"BLD",531,1,201,0)
  ------    -------------   ------------    ----------
"BLD",531,1,202,0)
  XQA366PO            N/A        1270650    **366**
"BLD",531,1,203,0)
  XQALERT         8063898        8345286    **1,65,125,173,285,366**
"BLD",531,1,204,0)
  XQALERT1       32870507       32133568    **20,65,114,123,125,164,173,285,
"BLD",531,1,205,0)
  366**
"BLD",531,1,206,0)
  XQALSUR1            N/A       24977392    **366**
"BLD",531,1,207,0)
  XQALSUR2            N/A        4795616    **366**
"BLD",531,1,208,0)
  XQALSURO       14207055       21906288    **114,125,173,285,366**
"BLD",531,1,209,0)
 
"BLD",531,1,210,0)
 Checksums obtained using CHECK1^XTSUMBLD from XT*7.3*94 (new style)
"BLD",531,1,211,0)
 
"BLD",531,1,212,0)
  Rtn Nm    Chksum Before   Chksum After    Patch List
"BLD",531,1,213,0)
  ------    -------------   ------------    ----------
"BLD",531,1,214,0)
  XQA366PO            N/A        1749690    **366**
"BLD",531,1,215,0)
  XQALERT        15349948       16208814    **1,65,125,173,285,366**
"BLD",531,1,216,0)
  XQALERT1       79355953       77322571    **20,65,114,123,125,164,173,285,
"BLD",531,1,217,0)
  366**
"BLD",531,1,218,0)
  XQALSUR1            N/A       65103748    **366**
"BLD",531,1,219,0)
  XQALSUR2            N/A        6279756    **366**
"BLD",531,1,220,0)
  XQALSURO       42941175       62950995    **114,125,173,285,366**
"BLD",531,1,221,0)
 
"BLD",531,1,222,0)
 List of preceding patches: 285
"BLD",531,1,223,0)
 
"BLD",531,1,224,0)
 Blood Bank Clearance:
"BLD",531,1,225,0)
 =============================
"BLD",531,1,226,0)
 Clearance - Apr. 21, 2005
"BLD",531,1,227,0)
 
"BLD",531,1,228,0)
 EFFECT ON BLOOD BANK FUNCTIONAL REQUIREMENTS: Patch XU*8*366 contains
"BLD",531,1,229,0)
 changes to a package referenced in VHA OI SEPG SOP 192-023 Review of VISTA
"BLD",531,1,230,0)
 Patches for Effects on VISTA Blood Bank Software. This patch does not
"BLD",531,1,231,0)
 alter or modify any VistA Blood Bank software design safeguards or safety
"BLD",531,1,232,0)
 critical elements functions.
"BLD",531,1,233,0)
 
"BLD",531,1,234,0)
 RISK ANALYSIS: Changes made by patch XU*8*366 have no effect on Blood Bank
"BLD",531,1,235,0)
 software functionality, therefore RISK is none.
"BLD",531,1,236,0)
 
"BLD",531,1,237,0)
 
"BLD",531,1,238,0)
 Installation Instructions:
"BLD",531,1,239,0)
 
"BLD",531,1,240,0)
      1.   Users ARE allowed to be on the system during the
"BLD",531,1,241,0)
      installation.
"BLD",531,1,242,0)
 
"BLD",531,1,243,0)
      2.   DSM sites - Some of these routines are usually mapped,
"BLD",531,1,244,0)
      so you will need to disable mapping for the affected routines.
"BLD",531,1,245,0)
 
"BLD",531,1,246,0)
      3.   Use the 'INSTALL/CHECK MESSAGE' option on the PackMan menu.
"BLD",531,1,247,0)
      This option will load the KIDS (Kernel Installation and Distribution
"BLD",531,1,248,0)
      System) package onto your system.
"BLD",531,1,249,0)
 
"BLD",531,1,250,0)
      4.   You DO NOT need to stop TaskMan or the background filers.
"BLD",531,1,251,0)
 
"BLD",531,1,252,0)
      5.   The patch has now been loaded into a transport global on your
"BLD",531,1,253,0)
      system.  On the KIDS menu, select the 'Installation' menu and use
"BLD",531,1,254,0)
      the following options:
"BLD",531,1,255,0)
            Verify Checksums in Transport Global
"BLD",531,1,256,0)
            Print Transport Global
"BLD",531,1,257,0)
            Compare Transport Global to Current System
"BLD",531,1,258,0)
            Backup a Transport Global
"BLD",531,1,259,0)
 
"BLD",531,1,260,0)
            Return to Programmers Prompt and use "D ^XPDKRN":
"BLD",531,1,261,0)
            Select KIDS OPTION: Install
"BLD",531,1,262,0)
                                =======
"BLD",531,1,263,0)
             Install Package(s)
"BLD",531,1,264,0)
             Select INSTALL NAME: XU*8.0*366
"BLD",531,1,265,0)
                                  ==========
"BLD",531,1,266,0)
 
"BLD",531,1,267,0)
         Want KIDS to INHIBIT LOGONs during the install? YES// NO
"BLD",531,1,268,0)
                                                               ==
"BLD",531,1,269,0)
         Want to DISABLE Scheduled Options, Menu Options, and Protocols?
"BLD",531,1,270,0)
         YES// NO
"BLD",531,1,271,0)
               ==
"BLD",531,1,272,0)
 
"BLD",531,1,273,0)
      6.  AXP Sites - Answer 'NO' to the question 'Want to MOVE
"BLD",531,1,274,0)
      routines to other CPUs?'.
"BLD",531,1,275,0)
 
"BLD",531,1,276,0)
 
"BLD",531,1,277,0)
      7.  If the routines were unmapped as part of step 2, they should be
"BLD",531,1,278,0)
      returned to the mapped set once the installation has run to
"BLD",531,1,279,0)
      completion.
"BLD",531,4,0)
^9.64PA^8992.1^2
"BLD",531,4,8992,0)
8992
"BLD",531,4,8992,222)
y^y^f^^^^n
"BLD",531,4,8992.1,0)
8992.1
"BLD",531,4,8992.1,222)
y^y^f^^^^n
"BLD",531,4,"B",8992,8992)

"BLD",531,4,"B",8992.1,8992.1)

"BLD",531,"INID")
^n
"BLD",531,"INIT")
XQA366PO
"BLD",531,"KRN",0)
^9.67PA^8989.52^19
"BLD",531,"KRN",.4,0)
.4
"BLD",531,"KRN",.401,0)
.401
"BLD",531,"KRN",.402,0)
.402
"BLD",531,"KRN",.403,0)
.403
"BLD",531,"KRN",.5,0)
.5
"BLD",531,"KRN",.84,0)
.84
"BLD",531,"KRN",3.6,0)
3.6
"BLD",531,"KRN",3.8,0)
3.8
"BLD",531,"KRN",9.2,0)
9.2
"BLD",531,"KRN",9.8,0)
9.8
"BLD",531,"KRN",9.8,"NM",0)
^9.68A^6^6
"BLD",531,"KRN",9.8,"NM",1,0)
XQA366PO^^0^B1749690
"BLD",531,"KRN",9.8,"NM",2,0)
XQALERT^^0^B16208814
"BLD",531,"KRN",9.8,"NM",3,0)
XQALERT1^^0^B77322571
"BLD",531,"KRN",9.8,"NM",4,0)
XQALSURO^^0^B62950995
"BLD",531,"KRN",9.8,"NM",5,0)
XQALSUR1^^0^B65103748
"BLD",531,"KRN",9.8,"NM",6,0)
XQALSUR2^^0^B6279756
"BLD",531,"KRN",9.8,"NM","B","XQA366PO",1)

"BLD",531,"KRN",9.8,"NM","B","XQALERT",2)

"BLD",531,"KRN",9.8,"NM","B","XQALERT1",3)

"BLD",531,"KRN",9.8,"NM","B","XQALSUR1",5)

"BLD",531,"KRN",9.8,"NM","B","XQALSUR2",6)

"BLD",531,"KRN",9.8,"NM","B","XQALSURO",4)

"BLD",531,"KRN",19,0)
19
"BLD",531,"KRN",19.1,0)
19.1
"BLD",531,"KRN",101,0)
101
"BLD",531,"KRN",409.61,0)
409.61
"BLD",531,"KRN",771,0)
771
"BLD",531,"KRN",870,0)
870
"BLD",531,"KRN",8989.51,0)
8989.51
"BLD",531,"KRN",8989.52,0)
8989.52
"BLD",531,"KRN",8994,0)
8994
"BLD",531,"KRN","B",.4,.4)

"BLD",531,"KRN","B",.401,.401)

"BLD",531,"KRN","B",.402,.402)

"BLD",531,"KRN","B",.403,.403)

"BLD",531,"KRN","B",.5,.5)

"BLD",531,"KRN","B",.84,.84)

"BLD",531,"KRN","B",3.6,3.6)

"BLD",531,"KRN","B",3.8,3.8)

"BLD",531,"KRN","B",9.2,9.2)

"BLD",531,"KRN","B",9.8,9.8)

"BLD",531,"KRN","B",19,19)

"BLD",531,"KRN","B",19.1,19.1)

"BLD",531,"KRN","B",101,101)

"BLD",531,"KRN","B",409.61,409.61)

"BLD",531,"KRN","B",771,771)

"BLD",531,"KRN","B",870,870)

"BLD",531,"KRN","B",8989.51,8989.51)

"BLD",531,"KRN","B",8989.52,8989.52)

"BLD",531,"KRN","B",8994,8994)

"BLD",531,"QUES",0)
^9.62^^
"FIA",8992)
ALERT
"FIA",8992,0)
^XTV(8992,
"FIA",8992,0,0)
8992PA
"FIA",8992,0,1)
y^y^f^^^^n
"FIA",8992,0,10)

"FIA",8992,0,11)

"FIA",8992,0,"RLRO")

"FIA",8992,0,"VR")
8.0^XU
"FIA",8992,8992)
0
"FIA",8992,8992.01)
0
"FIA",8992,8992.02)
0
"FIA",8992,8992.04)
0
"FIA",8992.1)
ALERT TRACKING
"FIA",8992.1,0)
^XTV(8992.1,
"FIA",8992.1,0,0)
8992.1A
"FIA",8992.1,0,1)
y^y^f^^^^n
"FIA",8992.1,0,10)

"FIA",8992.1,0,11)

"FIA",8992.1,0,"RLRO")

"FIA",8992.1,0,"VR")
8.0^XU
"FIA",8992.1,8992.1)
0
"FIA",8992.1,8992.11)
0
"FIA",8992.1,8992.111)
0
"FIA",8992.1,8992.112)
0
"FIA",8992.1,8992.113)
0
"FIA",8992.1,8992.14)
0
"INIT")
XQA366PO
"MBREQ")
0
"PKG",3,-1)
1^1
"PKG",3,0)
KERNEL^XU^SIGN-ON, SECURITY, MENU DRIVER, DEVICES, TASKMAN^
"PKG",3,20,0)
^9.402P^^
"PKG",3,22,0)
^9.49I^1^1
"PKG",3,22,1,0)
8.0^2950703^2990606^1
"PKG",3,22,1,"PAH",1,0)
366^3050907^5
"PKG",3,22,1,"PAH",1,1,0)
^^279^279^3050907
"PKG",3,22,1,"PAH",1,1,1,0)
 Patch XU*8*366 (RETURN ALERTS FROM SURROGATE) resolves a patient safety
"PKG",3,22,1,"PAH",1,1,2,0)
 issue (PSI-04-036) by modifying the handling of alerts sent to surrogates
"PKG",3,22,1,"PAH",1,1,3,0)
 to return unprocessed alerts to the originally intended recipient of the
"PKG",3,22,1,"PAH",1,1,4,0)
 alert after a surrogacy period ends.  As a byproduct of the changes made,
"PKG",3,22,1,"PAH",1,1,5,0)
 it is now possible to schedule multiple different (temporal) surrogate
"PKG",3,22,1,"PAH",1,1,6,0)
 periods in advance.
"PKG",3,22,1,"PAH",1,1,7,0)
 
"PKG",3,22,1,"PAH",1,1,8,0)
 Alerts are sent to the specified surrogate, or surrogates if there is a
"PKG",3,22,1,"PAH",1,1,9,0)
 sequence of consecutive periods of surrogacy.  When a user requests a
"PKG",3,22,1,"PAH",1,1,10,0)
 listing of alerts AND THERE ARE NO CURRENT SURROGATES (either due to the
"PKG",3,22,1,"PAH",1,1,11,0)
 end of the surrogacy period or removal of the last surrogate) alerts which
"PKG",3,22,1,"PAH",1,1,12,0)
 were sent to the surrogate(s) and have not been processed by the surrogate
"PKG",3,22,1,"PAH",1,1,13,0)
 are returned to the user as new alerts with a comment indicating they were
"PKG",3,22,1,"PAH",1,1,14,0)
 returned from the surrogate.  If the surrogate was not an intended
"PKG",3,22,1,"PAH",1,1,15,0)
 recipient of the alert(s), either as an initially specified recipient or
"PKG",3,22,1,"PAH",1,1,16,0)
 by receiving the alert by forwarding from another recipient, the alert will
"PKG",3,22,1,"PAH",1,1,17,0)
 be deleted from the surrogate.  If the surrogate was an intended recipient
"PKG",3,22,1,"PAH",1,1,18,0)
 of the alert it will also remain with the surrogate.
"PKG",3,22,1,"PAH",1,1,19,0)
 
"PKG",3,22,1,"PAH",1,1,20,0)
 A consequence of the modifications made to track the periods of surrogacy
"PKG",3,22,1,"PAH",1,1,21,0)
 is the ability to add multiple surrogate periods with different start times.
"PKG",3,22,1,"PAH",1,1,22,0)
 The  most recent active start time determines which of the surrogate periods
"PKG",3,22,1,"PAH",1,1,23,0)
 is active.  Therefore, the termination date/time for a given period of
"PKG",3,22,1,"PAH",1,1,24,0)
 surrogacy, if specified, only determines the end of the surrogacy if no
"PKG",3,22,1,"PAH",1,1,25,0)
 other surrogacy period starts prior to that time.  It does not determine
"PKG",3,22,1,"PAH",1,1,26,0)
 the actual end time if another period of surrogacy starts before the
"PKG",3,22,1,"PAH",1,1,27,0)
 specified end time (or there was no end time specified).  A pair of
"PKG",3,22,1,"PAH",1,1,28,0)
 users can be specified in advance as mutual surrogates with opposite rolls,
"PKG",3,22,1,"PAH",1,1,29,0)
 as long as the periods of surrogacy do not overlap resulting in a circular
"PKG",3,22,1,"PAH",1,1,30,0)
 relationship.
"PKG",3,22,1,"PAH",1,1,31,0)
 
"PKG",3,22,1,"PAH",1,1,32,0)
 In the Roll and Scroll environment, selection of Surrogate processing will
"PKG",3,22,1,"PAH",1,1,33,0)
 list current surrogate(s) and give the option to remove one or more of the
"PKG",3,22,1,"PAH",1,1,34,0)
 surrogates, and the option to add a surrogate, which if it is a later start
"PKG",3,22,1,"PAH",1,1,35,0)
 date/time than a currently active or scheduled surrogate, will become active
"PKG",3,22,1,"PAH",1,1,36,0)
 at the date/time specified.
"PKG",3,22,1,"PAH",1,1,37,0)
 
"PKG",3,22,1,"PAH",1,1,38,0)
 A new supported reference (SUROLIST^XQALSURO) has been added to provide a
"PKG",3,22,1,"PAH",1,1,39,0)
 list of current and scheduled surrogates for a user.
"PKG",3,22,1,"PAH",1,1,40,0)
 
"PKG",3,22,1,"PAH",1,1,41,0)
 D SUROLIST^XQALSURO(XQAUSER,.XQALIST)
"PKG",3,22,1,"PAH",1,1,42,0)
 
"PKG",3,22,1,"PAH",1,1,43,0)
 where XQALIST is passed by reference.  On return XQALIST contains the
"PKG",3,22,1,"PAH",1,1,44,0)
 number of entries returned, and an array containing the current and
"PKG",3,22,1,"PAH",1,1,45,0)
 scheduled surrogates with '^'-separated values for internal entry number in
"PKG",3,22,1,"PAH",1,1,46,0)
 the NEW PERSON file (#200), the value for the NAME field (#.01) from the
"PKG",3,22,1,"PAH",1,1,47,0)
 NEW PERSON file (#200), the start date/time for the surrogacy period and the
"PKG",3,22,1,"PAH",1,1,48,0)
 end date/time for the surrogacy period.  If a surrogate has no end date/time
"PKG",3,22,1,"PAH",1,1,49,0)
 value and is followed by another surrogate, the first surrogate will show an
"PKG",3,22,1,"PAH",1,1,50,0)
 end date/time value equal to the start date/time of the following surrogate.
"PKG",3,22,1,"PAH",1,1,51,0)
 
"PKG",3,22,1,"PAH",1,1,52,0)
 returns  XQALIST=count
"PKG",3,22,1,"PAH",1,1,53,0)
          XQALIST(1)=IEN2^NEWPERSON,USER2^STARTDATETIME^ENDDATETIME
"PKG",3,22,1,"PAH",1,1,54,0)
          XQALIST(2)=3^NAME,USER3^3050407.1227^3050409
"PKG",3,22,1,"PAH",1,1,55,0)
 
"PKG",3,22,1,"PAH",1,1,56,0)
 The supported reference to remove surrogates (REMVSURO^XQALSURO) has been
"PKG",3,22,1,"PAH",1,1,57,0)
 modified to add two additional OPTIONAL arguments which specify the IEN of
"PKG",3,22,1,"PAH",1,1,58,0)
 a surrogate and the start date/time for that surrogate session to be removed
"PKG",3,22,1,"PAH",1,1,59,0)
 (these values can be obtained with the SUROLIST^XQALSURO call described
"PKG",3,22,1,"PAH",1,1,60,0)
 above).  If these two optional arguments are not specified, the call to
"PKG",3,22,1,"PAH",1,1,61,0)
 REMVSURO^XQALSURO will remove the current or next scheduled surrogate entry
"PKG",3,22,1,"PAH",1,1,62,0)
 (as it has in the past).
"PKG",3,22,1,"PAH",1,1,63,0)
 
"PKG",3,22,1,"PAH",1,1,64,0)
 These features will become active in windowed applications, such as CPRS,
"PKG",3,22,1,"PAH",1,1,65,0)
 only after the applications implement code changes to take advantage of the
"PKG",3,22,1,"PAH",1,1,66,0)
 new functionality included in this patch.
"PKG",3,22,1,"PAH",1,1,67,0)
 
"PKG",3,22,1,"PAH",1,1,68,0)
 The following field (and sub-file) was added to the ALERT file (#8992):
"PKG",3,22,1,"PAH",1,1,69,0)
 
"PKG",3,22,1,"PAH",1,1,70,0)
 8992,2        SURROGATE              2;0 DATE Multiple #8992.02
"PKG",3,22,1,"PAH",1,1,71,0)
 
"PKG",3,22,1,"PAH",1,1,72,0)
               DESCRIPTION:      This field is a multiple based on the start
"PKG",3,22,1,"PAH",1,1,73,0)
                                 date/time for a surrogate relationship.  This
"PKG",3,22,1,"PAH",1,1,74,0)
                                 will permit multiple surrogate relationships
"PKG",3,22,1,"PAH",1,1,75,0)
                                 to be scheduled.
"PKG",3,22,1,"PAH",1,1,76,0)
 
"PKG",3,22,1,"PAH",1,1,77,0)
                                 Since a start date/time for the surrogate
"PKG",3,22,1,"PAH",1,1,78,0)
                                 relationship is required, if the user does not
"PKG",3,22,1,"PAH",1,1,79,0)
                                 enter one, then the NOW as the current
"PKG",3,22,1,"PAH",1,1,80,0)
                                 date/time will be used.
"PKG",3,22,1,"PAH",1,1,81,0)
 
"PKG",3,22,1,"PAH",1,1,82,0)
 
"PKG",3,22,1,"PAH",1,1,83,0)
 8992.02,.01     SURROGATE START DATE/TIME 0;1 DATE (Required) (Multiply asked)
"PKG",3,22,1,"PAH",1,1,84,0)
 
"PKG",3,22,1,"PAH",1,1,85,0)
                 INPUT TRANSFORM:  S %DT="ESTX" D ^%DT S X=Y K:Y<1 X
"PKG",3,22,1,"PAH",1,1,86,0)
                 LAST EDITED:      NOV 12, 2004
"PKG",3,22,1,"PAH",1,1,87,0)
                 HELP-PROMPT:     This is the START DATE/TIME for the surrogate
"PKG",3,22,1,"PAH",1,1,88,0)
                 DESCRIPTION:      This is the starting date and time for a
"PKG",3,22,1,"PAH",1,1,89,0)
                                   surrogate relationship.
"PKG",3,22,1,"PAH",1,1,90,0)
 
"PKG",3,22,1,"PAH",1,1,91,0)
                 CROSS-REFERENCE:  8992.02^B
"PKG",3,22,1,"PAH",1,1,92,0)
                                   1)= S ^XTV(8992,DA(1),2,"B",$E(X,1,30),DA)=
"PKG",3,22,1,"PAH",1,1,93,0)
                                   ""
"PKG",3,22,1,"PAH",1,1,94,0)
                                   2)= K ^XTV(8992,DA(1),2,"B",$E(X,1,30),DA)
"PKG",3,22,1,"PAH",1,1,95,0)
 
"PKG",3,22,1,"PAH",1,1,96,0)
 
"PKG",3,22,1,"PAH",1,1,97,0)
 8992.02,.02     SURROGATE USER         0;2 POINTER TO NEW PERSON FILE (#200)
"PKG",3,22,1,"PAH",1,1,98,0)
                                    (Required)
"PKG",3,22,1,"PAH",1,1,99,0)
 
"PKG",3,22,1,"PAH",1,1,100,0)
                 LAST EDITED:      NOV 12, 2004
"PKG",3,22,1,"PAH",1,1,101,0)
                 HELP-PROMPT:      This is the user who will be the surrogate
"PKG",3,22,1,"PAH",1,1,102,0)
                                   during the time period specified
"PKG",3,22,1,"PAH",1,1,103,0)
                 DESCRIPTION:      This is a pointer to the user in the NEW
"PKG",3,22,1,"PAH",1,1,104,0)
                                   PERSON file who will be acting as the
"PKG",3,22,1,"PAH",1,1,105,0)
                                   surrogate for the time period specified.
"PKG",3,22,1,"PAH",1,1,106,0)
 
"PKG",3,22,1,"PAH",1,1,107,0)
 
"PKG",3,22,1,"PAH",1,1,108,0)
 8992.02,.03     END DATE TIME          0;3 DATE
"PKG",3,22,1,"PAH",1,1,109,0)
 
"PKG",3,22,1,"PAH",1,1,110,0)
                 INPUT TRANSFORM:  S %DT="ESTX" D ^%DT S X=Y K:Y<1 X
"PKG",3,22,1,"PAH",1,1,111,0)
                 LAST EDITED:      NOV 12, 2004
"PKG",3,22,1,"PAH",1,1,112,0)
                 HELP-PROMPT:      This is an optional date/time for when the
"PKG",3,22,1,"PAH",1,1,113,0)
                                   surrogate relationship will be terminated.
"PKG",3,22,1,"PAH",1,1,114,0)
                 DESCRIPTION:      This is an optional date/time for when the
"PKG",3,22,1,"PAH",1,1,115,0)
                                   surrogate relationship will be terminated.
"PKG",3,22,1,"PAH",1,1,116,0)
                                   If there is no value entered, then the
"PKG",3,22,1,"PAH",1,1,117,0)
                                   relationship will continue until it is
"PKG",3,22,1,"PAH",1,1,118,0)
                                   specifically terminated.
"PKG",3,22,1,"PAH",1,1,119,0)
 
"PKG",3,22,1,"PAH",1,1,120,0)
 
"PKG",3,22,1,"PAH",1,1,121,0)
 8992.02,.04     NEEDS RETURN           0;4 SET
"PKG",3,22,1,"PAH",1,1,122,0)
 
"PKG",3,22,1,"PAH",1,1,123,0)
                                   '1' FOR YES;
"PKG",3,22,1,"PAH",1,1,124,0)
                                   '0' FOR NO;
"PKG",3,22,1,"PAH",1,1,125,0)
                 LAST EDITED:      MAR 16, 2005
"PKG",3,22,1,"PAH",1,1,126,0)
                 HELP-PROMPT:      This is a flag which is used to determine
"PKG",3,22,1,"PAH",1,1,127,0)
                                   whether alerts have been returned to the
"PKG",3,22,1,"PAH",1,1,128,0)
                                   intended recipient or not
"PKG",3,22,1,"PAH",1,1,129,0)
                 DESCRIPTION:      This field is used as a flag to indicate
"PKG",3,22,1,"PAH",1,1,130,0)
                                   whether the alerts have been returned to the
"PKG",3,22,1,"PAH",1,1,131,0)
                                   intended recipient or not.
"PKG",3,22,1,"PAH",1,1,132,0)
 
"PKG",3,22,1,"PAH",1,1,133,0)
                 CROSS-REFERENCE:  8992.02^AC
"PKG",3,22,1,"PAH",1,1,134,0)
                                   1)= S ^XTV(8992,DA(1),2,"AC",$E(X,1,30),DA)=
"PKG",3,22,1,"PAH",1,1,135,0)
                                   ""
"PKG",3,22,1,"PAH",1,1,136,0)
 
"PKG",3,22,1,"PAH",1,1,137,0)
                                   2)= K ^XTV(8992,DA(1),2,"AC",$E(X,1,30),DA)
"PKG",3,22,1,"PAH",1,1,138,0)
                                 3)= This x-ref is used to track alerts needing
"PKG",3,22,1,"PAH",1,1,139,0)
                                 return from surrogates
"PKG",3,22,1,"PAH",1,1,140,0)
                                 This cross reference is used to identify
"PKG",3,22,1,"PAH",1,1,141,0)
                                 periods for which any alerts forwarded to a
"PKG",3,22,1,"PAH",1,1,142,0)
                                 surrogate have not been returned to the
"PKG",3,22,1,"PAH",1,1,143,0)
                                 intended recipient.
"PKG",3,22,1,"PAH",1,1,144,0)
 
"PKG",3,22,1,"PAH",1,1,145,0)
 
"PKG",3,22,1,"PAH",1,1,146,0)
 The following field was added to the sub-file for the SURROGATE FOR field (#3)
"PKG",3,22,1,"PAH",1,1,147,0)
 of the ALERT TRACKING file (#8992.1):
"PKG",3,22,1,"PAH",1,1,148,0)
 
"PKG",3,22,1,"PAH",1,1,149,0)
 
"PKG",3,22,1,"PAH",1,1,150,0)
 
"PKG",3,22,1,"PAH",1,1,151,0)
 8992.113,.03      DATE-TIME RETURNED 0;3 DATE
"PKG",3,22,1,"PAH",1,1,152,0)
 
"PKG",3,22,1,"PAH",1,1,153,0)
                       INPUT TRANSFORM:S %DT="ESTXR" D ^%DT S X=Y K:Y<1 X
"PKG",3,22,1,"PAH",1,1,154,0)
                       LAST EDITED: MAR 16, 2005
"PKG",3,22,1,"PAH",1,1,155,0)
                       HELP-PROMPT:This is the date-time that the alert was
"PKG",3,22,1,"PAH",1,1,156,0)
                                 returned to the originally intended recipient
"PKG",3,22,1,"PAH",1,1,157,0)
                       DESCRIPTION:
"PKG",3,22,1,"PAH",1,1,158,0)
                                This field is a record for the date-time that
"PKG",3,22,1,"PAH",1,1,159,0)
                                an alert for which this recipient was acting as
"PKG",3,22,1,"PAH",1,1,160,0)
                                a surrogate was returned to the originally
"PKG",3,22,1,"PAH",1,1,161,0)
                                intended recipient of the alert.
"PKG",3,22,1,"PAH",1,1,162,0)
 
"PKG",3,22,1,"PAH",1,1,163,0)
 
"PKG",3,22,1,"PAH",1,1,164,0)
 In addition the AUD cross-reference was added to the ALERT DATE/TIME field
"PKG",3,22,1,"PAH",1,1,165,0)
 (#.04) the sub-file associated with the RECIPIENT TYPE field (#1) of the
"PKG",3,22,1,"PAH",1,1,166,0)
 ALERT TRACKING file (#8992.1).
"PKG",3,22,1,"PAH",1,1,167,0)
 
"PKG",3,22,1,"PAH",1,1,168,0)
 
"PKG",3,22,1,"PAH",1,1,169,0)
 NOISs
"PKG",3,22,1,"PAH",1,1,170,0)
 MIW-0704-40544       TIU ALERTS FOR ADDITIONAL SIGNER NOT REGENERATED
"PKG",3,22,1,"PAH",1,1,171,0)
 ALT-0104-20049       Surrogate Setting
"PKG",3,22,1,"PAH",1,1,172,0)
 
"PKG",3,22,1,"PAH",1,1,173,0)
 E3Rs
"PKG",3,22,1,"PAH",1,1,174,0)
   #19537, MULTIPLE SURROGATES
"PKG",3,22,1,"PAH",1,1,175,0)
   #19178, DATE CHECK FOR SURROGATE ASSIGNMENT
"PKG",3,22,1,"PAH",1,1,176,0)
   #17330, ALLOW MULTIPLE SURROGATES
"PKG",3,22,1,"PAH",1,1,177,0)
   #16711, MULTIPLE SURROGATES FOR ALERT
"PKG",3,22,1,"PAH",1,1,178,0)
   #16237, SELECTIVE SURROGATE DESIGNATION BY END-USER
"PKG",3,22,1,"PAH",1,1,179,0)
 
"PKG",3,22,1,"PAH",1,1,180,0)
 
"PKG",3,22,1,"PAH",1,1,181,0)
 List of Test Sites
"PKG",3,22,1,"PAH",1,1,182,0)
 ==================
"PKG",3,22,1,"PAH",1,1,183,0)
CLARKSBURG, WV
"PKG",3,22,1,"PAH",1,1,184,0)
PORTLAND, OR (C)
"PKG",3,22,1,"PAH",1,1,185,0)
PUGET SOUND HCS
"PKG",3,22,1,"PAH",1,1,186,0)
SALISBURY, NC
"PKG",3,22,1,"PAH",1,1,187,0)
WEST PALM BEACH, FL
"PKG",3,22,1,"PAH",1,1,188,0)
 
"PKG",3,22,1,"PAH",1,1,189,0)
 
"PKG",3,22,1,"PAH",1,1,190,0)
 Routine Summary:
"PKG",3,22,1,"PAH",1,1,191,0)
 The following routines are included in this patch.  The second
"PKG",3,22,1,"PAH",1,1,192,0)
 line of each of these routines now looks like:
"PKG",3,22,1,"PAH",1,1,193,0)
 
"PKG",3,22,1,"PAH",1,1,194,0)
      <tab>;;8.0;KERNEL;**[patch list]**;Jul 10, 1995
"PKG",3,22,1,"PAH",1,1,195,0)
 
"PKG",3,22,1,"PAH",1,1,196,0)
 Checksums:
"PKG",3,22,1,"PAH",1,1,197,0)
 ==========
"PKG",3,22,1,"PAH",1,1,198,0)
 Checksums obtained using CHECK^XTSUMBLD
"PKG",3,22,1,"PAH",1,1,199,0)
 
"PKG",3,22,1,"PAH",1,1,200,0)
  Rtn Nm    Chksum Before   Chksum After    Patch List
"PKG",3,22,1,"PAH",1,1,201,0)
  ------    -------------   ------------    ----------
"PKG",3,22,1,"PAH",1,1,202,0)
  XQA366PO            N/A        1270650    **366**
"PKG",3,22,1,"PAH",1,1,203,0)
  XQALERT         8063898        8345286    **1,65,125,173,285,366**
"PKG",3,22,1,"PAH",1,1,204,0)
  XQALERT1       32870507       32133568    **20,65,114,123,125,164,173,285,
"PKG",3,22,1,"PAH",1,1,205,0)
  366**
"PKG",3,22,1,"PAH",1,1,206,0)
  XQALSUR1            N/A       24977392    **366**
"PKG",3,22,1,"PAH",1,1,207,0)
  XQALSUR2            N/A        4795616    **366**
"PKG",3,22,1,"PAH",1,1,208,0)
  XQALSURO       14207055       21906288    **114,125,173,285,366**
"PKG",3,22,1,"PAH",1,1,209,0)
 
"PKG",3,22,1,"PAH",1,1,210,0)
 Checksums obtained using CHECK1^XTSUMBLD from XT*7.3*94 (new style)
"PKG",3,22,1,"PAH",1,1,211,0)
 
"PKG",3,22,1,"PAH",1,1,212,0)
  Rtn Nm    Chksum Before   Chksum After    Patch List
"PKG",3,22,1,"PAH",1,1,213,0)
  ------    -------------   ------------    ----------
"PKG",3,22,1,"PAH",1,1,214,0)
  XQA366PO            N/A        1749690    **366**
"PKG",3,22,1,"PAH",1,1,215,0)
  XQALERT        15349948       16208814    **1,65,125,173,285,366**
"PKG",3,22,1,"PAH",1,1,216,0)
  XQALERT1       79355953       77322571    **20,65,114,123,125,164,173,285,
"PKG",3,22,1,"PAH",1,1,217,0)
  366**
"PKG",3,22,1,"PAH",1,1,218,0)
  XQALSUR1            N/A       65103748    **366**
"PKG",3,22,1,"PAH",1,1,219,0)
  XQALSUR2            N/A        6279756    **366**
"PKG",3,22,1,"PAH",1,1,220,0)
  XQALSURO       42941175       62950995    **114,125,173,285,366**
"PKG",3,22,1,"PAH",1,1,221,0)
 
"PKG",3,22,1,"PAH",1,1,222,0)
 List of preceding patches: 285
"PKG",3,22,1,"PAH",1,1,223,0)
 
"PKG",3,22,1,"PAH",1,1,224,0)
 Blood Bank Clearance:
"PKG",3,22,1,"PAH",1,1,225,0)
 =============================
"PKG",3,22,1,"PAH",1,1,226,0)
 Clearance - Apr. 21, 2005
"PKG",3,22,1,"PAH",1,1,227,0)
 
"PKG",3,22,1,"PAH",1,1,228,0)
 EFFECT ON BLOOD BANK FUNCTIONAL REQUIREMENTS: Patch XU*8*366 contains
"PKG",3,22,1,"PAH",1,1,229,0)
 changes to a package referenced in VHA OI SEPG SOP 192-023 Review of VISTA
"PKG",3,22,1,"PAH",1,1,230,0)
 Patches for Effects on VISTA Blood Bank Software. This patch does not
"PKG",3,22,1,"PAH",1,1,231,0)
 alter or modify any VistA Blood Bank software design safeguards or safety
"PKG",3,22,1,"PAH",1,1,232,0)
 critical elements functions.
"PKG",3,22,1,"PAH",1,1,233,0)
 
"PKG",3,22,1,"PAH",1,1,234,0)
 RISK ANALYSIS: Changes made by patch XU*8*366 have no effect on Blood Bank
"PKG",3,22,1,"PAH",1,1,235,0)
 software functionality, therefore RISK is none.
"PKG",3,22,1,"PAH",1,1,236,0)
 
"PKG",3,22,1,"PAH",1,1,237,0)
 
"PKG",3,22,1,"PAH",1,1,238,0)
 Installation Instructions:
"PKG",3,22,1,"PAH",1,1,239,0)
 
"PKG",3,22,1,"PAH",1,1,240,0)
      1.   Users ARE allowed to be on the system during the
"PKG",3,22,1,"PAH",1,1,241,0)
      installation.
"PKG",3,22,1,"PAH",1,1,242,0)
 
"PKG",3,22,1,"PAH",1,1,243,0)
      2.   DSM sites - Some of these routines are usually mapped,
"PKG",3,22,1,"PAH",1,1,244,0)
      so you will need to disable mapping for the affected routines.
"PKG",3,22,1,"PAH",1,1,245,0)
 
"PKG",3,22,1,"PAH",1,1,246,0)
      3.   Use the 'INSTALL/CHECK MESSAGE' option on the PackMan menu.
"PKG",3,22,1,"PAH",1,1,247,0)
      This option will load the KIDS (Kernel Installation and Distribution
"PKG",3,22,1,"PAH",1,1,248,0)
      System) package onto your system.
"PKG",3,22,1,"PAH",1,1,249,0)
 
"PKG",3,22,1,"PAH",1,1,250,0)
      4.   You DO NOT need to stop TaskMan or the background filers.
"PKG",3,22,1,"PAH",1,1,251,0)
 
"PKG",3,22,1,"PAH",1,1,252,0)
      5.   The patch has now been loaded into a transport global on your
"PKG",3,22,1,"PAH",1,1,253,0)
      system.  On the KIDS menu, select the 'Installation' menu and use
"PKG",3,22,1,"PAH",1,1,254,0)
      the following options:
"PKG",3,22,1,"PAH",1,1,255,0)
            Verify Checksums in Transport Global
"PKG",3,22,1,"PAH",1,1,256,0)
            Print Transport Global
"PKG",3,22,1,"PAH",1,1,257,0)
            Compare Transport Global to Current System
"PKG",3,22,1,"PAH",1,1,258,0)
            Backup a Transport Global
"PKG",3,22,1,"PAH",1,1,259,0)
 
"PKG",3,22,1,"PAH",1,1,260,0)
            Return to Programmers Prompt and use "D ^XPDKRN":
"PKG",3,22,1,"PAH",1,1,261,0)
            Select KIDS OPTION: Install
"PKG",3,22,1,"PAH",1,1,262,0)
                                =======
"PKG",3,22,1,"PAH",1,1,263,0)
             Install Package(s)
"PKG",3,22,1,"PAH",1,1,264,0)
             Select INSTALL NAME: XU*8.0*366
"PKG",3,22,1,"PAH",1,1,265,0)
                                  ==========
"PKG",3,22,1,"PAH",1,1,266,0)
 
"PKG",3,22,1,"PAH",1,1,267,0)
         Want KIDS to INHIBIT LOGONs during the install? YES// NO
"PKG",3,22,1,"PAH",1,1,268,0)
                                                               ==
"PKG",3,22,1,"PAH",1,1,269,0)
         Want to DISABLE Scheduled Options, Menu Options, and Protocols?
"PKG",3,22,1,"PAH",1,1,270,0)
         YES// NO
"PKG",3,22,1,"PAH",1,1,271,0)
               ==
"PKG",3,22,1,"PAH",1,1,272,0)
 
"PKG",3,22,1,"PAH",1,1,273,0)
      6.  AXP Sites - Answer 'NO' to the question 'Want to MOVE
"PKG",3,22,1,"PAH",1,1,274,0)
      routines to other CPUs?'.
"PKG",3,22,1,"PAH",1,1,275,0)
 
"PKG",3,22,1,"PAH",1,1,276,0)
 
"PKG",3,22,1,"PAH",1,1,277,0)
      7.  If the routines were unmapped as part of step 2, they should be
"PKG",3,22,1,"PAH",1,1,278,0)
      returned to the mapped set once the installation has run to
"PKG",3,22,1,"PAH",1,1,279,0)
      completion.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
6
"RTN","XQA366PO")
0^1^B1749690
"RTN","XQA366PO",1,0)
XQA366PO ;ISC-SF.SEA/JLI - POST INSTALL FOR SURROGATES FOR ALERTS ;9/6/05  14:35
"RTN","XQA366PO",2,0)
 ;;8.0;KERNEL;**366**;Jul 10, 1995
"RTN","XQA366PO",3,0)
 ;;
"RTN","XQA366PO",4,0)
 ; go through alert file and convert any current surrogates to active entries in surrogate multiple
"RTN","XQA366PO",5,0)
 N XQAI,XQANOW,X0
"RTN","XQA366PO",6,0)
 S XQANOW=$$NOW^XLFDT()
"RTN","XQA366PO",7,0)
 F XQAI=0:0 S XQAI=$O(^XTV(8992,XQAI)) Q:XQAI'>0  S X0=$G(^(XQAI,0)) S:X0="" ^XTV(8992,XQAI,0)=XQAI D
"RTN","XQA366PO",8,0)
 . N XQALSURO,XQALSTRT,XQALEND
"RTN","XQA366PO",9,0)
 . S XQALSURO=$P(X0,U,2),XQALSTRT=$P(X0,U,3),XQALEND=$P(X0,U,4)
"RTN","XQA366PO",10,0)
 . I XQALSURO="" Q
"RTN","XQA366PO",11,0)
 . I $D(^XTV(8992,XQAI,2)) Q
"RTN","XQA366PO",12,0)
 . N XQAIENS,XQAFDA
"RTN","XQA366PO",13,0)
 . I XQALSTRT="" S XQALSTRT=XQANOW,XQAFDA(8992,XQAI_",",.03)=XQANOW D FILE^DIE("","XQAFDA") K XQAFDA
"RTN","XQA366PO",14,0)
 . S XQAIENS="+1,"_XQAI_",",XQAFDA(8992.02,XQAIENS,.01)=XQALSTRT
"RTN","XQA366PO",15,0)
 . S XQAFDA(8992.02,XQAIENS,.02)=XQALSURO
"RTN","XQA366PO",16,0)
 . I XQALEND'="" S XQAFDA(8992.02,XQAIENS,.03)=XQALEND
"RTN","XQA366PO",17,0)
 . I XQALSTRT'>XQANOW S XQAFDA(8992.02,XQAIENS,.04)=1
"RTN","XQA366PO",18,0)
 . D UPDATE^DIE("","XQAFDA")
"RTN","XQA366PO",19,0)
 . Q
"RTN","XQA366PO",20,0)
 Q
"RTN","XQALERT")
0^2^B16208814
"RTN","XQALERT",1,0)
XQALERT ;ISC-SF.SEA/JLI - ALERT HANDLER ;5/4/05  10:25
"RTN","XQALERT",2,0)
 ;;8.0;KERNEL;**1,65,125,173,285,366**;Jul 10, 1995
"RTN","XQALERT",3,0)
 ;;
"RTN","XQALERT",4,0)
 Q
"RTN","XQALERT",5,0)
 ;
"RTN","XQALERT",6,0)
SETUP ;SR.
"RTN","XQALERT",7,0)
 D SETUP^XQALSET
"RTN","XQALERT",8,0)
 Q
"RTN","XQALERT",9,0)
 ;
"RTN","XQALERT",10,0)
SETUP1() ;SR.
"RTN","XQALERT",11,0)
 N I S I=$$SETUP1^XQALSET()
"RTN","XQALERT",12,0)
 Q I
"RTN","XQALERT",13,0)
 ;
"RTN","XQALERT",14,0)
DISPLAY ;SR. Display any new alerts
"RTN","XQALERT",15,0)
 Q:$O(^XTV(8992,DUZ,"XQA",0))'>0
"RTN","XQALERT",16,0)
 N X,XQI,XQX,XQX1,DIR,XQA,Y,XQON,XQOFF,XQ1ON,XQ1OFF,XQXDAT S XQX=0,XQX1=0,Y=1,DIR(0)="E" ; P285
"RTN","XQALERT",17,0)
 I $$ACTVSURO^XQALSURO(DUZ)'>0 D RETURN^XQALSUR1(DUZ) ; P366
"RTN","XQALERT",18,0)
 F XQI=0:0 D:XQX1&'(XQX1#20) ^DIR Q:'Y  S XQI=$O(^XTV(8992,DUZ,"XQA",XQI)) Q:XQI'>0  S XQX=XQX+1,X=$G(^XTV(8992,DUZ,"XQA",XQI,0)) I $P(X,U,4) D
"RTN","XQALERT",19,0)
 . N XQXXX,XQXX,XQXY
"RTN","XQALERT",20,0)
 . S XQXXX=X,(XQXX,XQXY)=0,XQXX=$P(X,U,2) I XQXX'="" S XQXX=$O(^XTV(8992.1,"B",$E(XQXX,1,50),0)) I XQXX>0 S XQXY=$O(^XTV(8992.1,XQXX,20,"B",DUZ,0)) I XQXY>0 S XQXDAT=$$NOW^XLFDT(),$P(^XTV(8992.1,XQXX,20,XQXY,0),U,2)=XQXDAT ; P173
"RTN","XQALERT",21,0)
 . S XQON="$C(0)",XQOFF="$C(0)"
"RTN","XQALERT",22,0)
 . S XQOUT=$P(XQXXX,U,3) I ($$UP^XLFSTR(XQOUT)["CRITICAL")!($$UP^XLFSTR(XQOUT)["ABNORMAL IMA") D:'$D(XQ1ON) SETREV S XQON=XQ1ON,XQOFF=XQ1OFF ; P285 modified to highlight critical and abnormal imaging alerts
"RTN","XQALERT",23,0)
 . S X=XQXXX W:XQX1=0 $C(7) W !,@XQON,$P(X,U,3),@XQOFF S XQX1=XQX1+1,$P(^XTV(8992,DUZ,"XQA",XQI,0),U,4)="" I $D(^(2)) S X1=^(2) D  ; P285
"RTN","XQALERT",24,0)
 . . S X2=$P(X1,U,3)
"RTN","XQALERT",25,0)
 . . W !?5,"*** FORWARDED BY: ",$P(^VA(200,+X1,0),U),"   Generated: " S X1=$P($P(X,U,2),";",3) W $$DAT8(X1,1)
"RTN","XQALERT",26,0)
 . . I X2'="" W !?5,X2
"RTN","XQALERT",27,0)
 . I $P(X,U,5)="D" S XQA=$P(X,U,2) K ^XTV(8992,DUZ,"XQA",XQI) D  S XQX=XQX-1 D:XQA'="" D
"RTN","XQALERT",28,0)
 . . I $G(XQXX)>0,$G(XQXY)>0 S $P(^XTV(8992.1,XQXX,20,XQXY,0),U,5)=XQXDAT
"RTN","XQALERT",29,0)
 . K XQXX,XQXY
"RTN","XQALERT",30,0)
 I XQX>0 W:XQX1=0 !!,"You have PENDING ALERTS" W !?10,"Enter  ""VA to jump to VIEW ALERTS option",! ; ISL-0898-51279
"RTN","XQALERT",31,0)
 W:XQX1>0 !
"RTN","XQALERT",32,0)
 K XQI,XQX,XQX1,DIR,XQA,Y
"RTN","XQALERT",33,0)
 Q
"RTN","XQALERT",34,0)
D K ^XTV(8992,"AXQA",XQA,DUZ),^XTV(8992,"AXQAN",$P(XQA,";"),DUZ)
"RTN","XQALERT",35,0)
 Q
"RTN","XQALERT",36,0)
 ;
"RTN","XQALERT",37,0)
 ;
"RTN","XQALERT",38,0)
DAT8(FMDAT,TFLG) ;
"RTN","XQALERT",39,0)
 N X
"RTN","XQALERT",40,0)
 S X=$E(FMDAT,4,5)_"/"_$E(FMDAT,6,7)_"/"_$E(FMDAT,2,3)
"RTN","XQALERT",41,0)
 I $G(TFLG)>0 S FMDAT=FMDAT_"0000000",X=X_" "_$E(FMDAT,9,10)_":"_$E(FMDAT,11,12)_":"_$E(FMDAT,13,14)
"RTN","XQALERT",42,0)
 Q X
"RTN","XQALERT",43,0)
DOIT ;OPT. Process Alerts
"RTN","XQALERT",44,0)
 N XQALAST,XQALFWD,XQAUSER K DTOUT,DIRUT,DUOUT,DIROUT
"RTN","XQALERT",45,0)
 S XQAUSER=DUZ D DOIT^XQALERT1,COUNT^XQALDEL(0,XQAUSER)
"RTN","XQALERT",46,0)
 Q
"RTN","XQALERT",47,0)
 ;
"RTN","XQALERT",48,0)
DELETE ;
"RTN","XQALERT",49,0)
 D DELETE^XQALDEL
"RTN","XQALERT",50,0)
 Q
"RTN","XQALERT",51,0)
 ;
"RTN","XQALERT",52,0)
DELETEA ;
"RTN","XQALERT",53,0)
 D DELETEA^XQALDEL
"RTN","XQALERT",54,0)
 Q
"RTN","XQALERT",55,0)
 ;
"RTN","XQALERT",56,0)
OLDDEL ;OPT.
"RTN","XQALERT",57,0)
 D OLDDEL^XQALDEL
"RTN","XQALERT",58,0)
 Q
"RTN","XQALERT",59,0)
 ;
"RTN","XQALERT",60,0)
USERDEL ;OPT.
"RTN","XQALERT",61,0)
 D USERDEL^XQALDEL
"RTN","XQALERT",62,0)
 Q
"RTN","XQALERT",63,0)
 ;
"RTN","XQALERT",64,0)
USER(ROOT,XQAUSER,FRSTDATE,LASTDATE) ; Returns current alerts for the user in an array located under root
"RTN","XQALERT",65,0)
 I '$D(XQAUSER) S XQAUSER=DUZ
"RTN","XQALERT",66,0)
 I $$ACTVSURO^XQALSURO(XQAUSER)'>0 D RETURN^XQALSUR1(XQAUSER) ; P366
"RTN","XQALERT",67,0)
 D GETUSER^XQALDATA(ROOT,XQAUSER,$G(FRSTDATE),$G(LASTDATE))
"RTN","XQALERT",68,0)
 Q
"RTN","XQALERT",69,0)
 ;
"RTN","XQALERT",70,0)
PATIENT(ROOT,PATIENT,FRSTDATE,LASTDATE) ;
"RTN","XQALERT",71,0)
 I $G(PATIENT)'>0 Q
"RTN","XQALERT",72,0)
 D GETPAT^XQALDATA(ROOT,PATIENT,$G(FRSTDATE),$G(LASTDATE))
"RTN","XQALERT",73,0)
 Q
"RTN","XQALERT",74,0)
ACTION(ALERTID) ;
"RTN","XQALERT",75,0)
 D ACTION^XQALDOIT(ALERTID)
"RTN","XQALERT",76,0)
 Q
"RTN","XQALERT",77,0)
GETACT(ALERTID) ; Return to calling routine the information needed to act on
"RTN","XQALERT",78,0)
 ; the specified alert.
"RTN","XQALERT",79,0)
 ; On return the following variables are defined:
"RTN","XQALERT",80,0)
 ;  XQAID = the full alert id
"RTN","XQALERT",81,0)
 ;  XQADATA = Any data passed as XQADATA at the time the alert was generated
"RTN","XQALERT",82,0)
 ;  XQAROU  = Indicates routine to be run (includes tag if necessary)
"RTN","XQALERT",83,0)
 ;    This value may have three meanings
"RTN","XQALERT",84,0)
 ;      1.  A null value indicates no routine to be used (XQAOPT contains
"RTN","XQALERT",85,0)
 ;          option name to be run)
"RTN","XQALERT",86,0)
 ;      2.  A value of ^<space>  indicates that the alert is information
"RTN","XQALERT",87,0)
 ;          only (no routine or option action involved).
"RTN","XQALERT",88,0)
 ;      3.  The name of the routine as ^ROUTINE  or TAG^ROUTINE
"RTN","XQALERT",89,0)
 ;  XQAOPT  = Indicates the name of the option to be run if not null.
"RTN","XQALERT",90,0)
 ;
"RTN","XQALERT",91,0)
 N XQX,XQZ,XQAGETAC
"RTN","XQALERT",92,0)
 S XQAGETAC=1,XQX="",XQZ=""
"RTN","XQALERT",93,0)
 D ACTION^XQALDOIT(ALERTID)
"RTN","XQALERT",94,0)
 S XQAID=$P(XQX,U,2)
"RTN","XQALERT",95,0)
 S XQADATA=$S(XQZ'="":XQZ,1:$P(XQX,U,9,99))
"RTN","XQALERT",96,0)
 S XQAROU=$S($P(XQX,U,8)="":"",1:$P(XQX,U,7,8))
"RTN","XQALERT",97,0)
 S XQAOPT=$S($P(XQX,U,8)="":$P(XQX,U,7),1:"")
"RTN","XQALERT",98,0)
 Q
"RTN","XQALERT",99,0)
 ;
"RTN","XQALERT",100,0)
SETREV ; Set on (XQ1ON) and off (XQ1OFF) variables for Reverse video ; P285
"RTN","XQALERT",101,0)
 N XQ1ON1,XQ1OFF1
"RTN","XQALERT",102,0)
 S XQ1ON="$C(0)",XQ1OFF="$C(0)" I IOST(0)>0 D
"RTN","XQALERT",103,0)
 . S XQ1ON1=$$GET1^DIQ(3.2,IOST(0)_",",14) I XQ1ON1'="" S XQ1ON=XQ1ON1
"RTN","XQALERT",104,0)
 . S XQ1OFF1=$$GET1^DIQ(3.2,IOST(0)_",",15) I XQ1OFF1'="" S XQ1OFF=XQ1OFF1
"RTN","XQALERT",105,0)
 . Q
"RTN","XQALERT",106,0)
 Q
"RTN","XQALERT1")
0^3^B77322571
"RTN","XQALERT1",1,0)
XQALERT1 ;ISC-SF.SEA/JLI - ALERT HANDLER ;9/6/05  15:13
"RTN","XQALERT1",2,0)
 ;;8.0;KERNEL;**20,65,114,123,125,164,173,285,366**;Jul 10, 1995
"RTN","XQALERT1",3,0)
 ;;
"RTN","XQALERT1",4,0)
 Q
"RTN","XQALERT1",5,0)
 ;
"RTN","XQALERT1",6,0)
DOIT I $D(XQX1),XQX1'>0 K XQX1
"RTN","XQALERT1",7,0)
 I $D(XQAID) D  I '$D(XQAID) G EXIT
"RTN","XQALERT1",8,0)
 . N XQACHOIC,REASK S REASK=0
"RTN","XQALERT1",9,0)
 . I '$D(XQX1),$O(^XTV(8992,XQAUSER,"XQA",+$O(^XTV(8992,XQAUSER,"XQA",0))))'>0,$G(XQAROUX)="^ " S XQAROU=""
"RTN","XQALERT1",10,0)
AGAIN . S XQACHOIC="Y:YES;N:NO;C:CONTINUE;",XQAQ("?")="Enter Y (or C) to continue, N to exit alert processing"
"RTN","XQALERT1",11,0)
 . S XQACHOIC=$G(XQACHOIC)_"F:FORWARD ALERT;R:RENEW(MAKE NEW AGAIN);" S XQAQ("?",1)="Enter F to forward this alert to someone else",XQAQ("?",2)="Enter R to Renew (Make New) this alert"
"RTN","XQALERT1",12,0)
 . D  I REASK=1 G AGAIN
"RTN","XQALERT1",13,0)
 . . S REASK=0 W !! K DIR S DIR(0)="SA^"_XQACHOIC,DIR("A")=$S(XQACHOIC["F:":"Continue (Y/N) or F(orward) or R(enew) ",1:"Continue Processing (Y/N) "),DIR("B")="YES" M DIR("?")=XQAQ("?") D ^DIR K DIR
"RTN","XQALERT1",14,0)
 . . I $D(DUOUT)!$D(DIRUT) S Y="N" K DUOUT,DIRUT
"RTN","XQALERT1",15,0)
 . . I Y="N" D:$D(XQAKILL) DELETEA^XQALERT K XQAID
"RTN","XQALERT1",16,0)
 . . I Y="R" S REASK=REASK+1 K XQAKILL I '$D(^XTV(8992,"AXQA",XQAID,DUZ)) D RESTORE
"RTN","XQALERT1",17,0)
 . . I Y="F" D:'$D(^XTV(8992,"AXQA",XQAID,DUZ)) RESTORE D FRWRDONE S REASK=REASK+1
"RTN","XQALERT1",18,0)
 . . Q
"RTN","XQALERT1",19,0)
 . Q
"RTN","XQALERT1",20,0)
 I $D(XQAKILL) D DELETEA^XQALERT
"RTN","XQALERT1",21,0)
 S XQAREV=1,XQXOUT=0,XQK=0,XQACNT=0 K XQADATA,XQAID,XQAROU,XQAKILL,XQAROUX
"RTN","XQALERT1",22,0)
 I '$D(XQX1) S XQX1=0 K ^TMP("XQ",$J,"XQA"),^("XQA1"),^("XQA2") I $O(^XTV(8992,XQAUSER,"XQA",0))'>0 K XQX1 D:'$G(^TMP("XQALERT1",$J,"NOTFIRST")) CHKSURO G:$O(^XTV(8992,XQAUSER,"XQA",0))'>0 EXIT S XQX1=0 ; P366
"RTN","XQALERT1",23,0)
 I $$ACTVSURO^XQALSURO(XQAUSER)'>0 D RETURN^XQALSUR1(XQAUSER) ; P366
"RTN","XQALERT1",24,0)
 S ^TMP("XQALERT1",$J,"NOTFIRST")=1 ; Added 2/2/99 jli to clear flag for initial entry
"RTN","XQALERT1",25,0)
 ;Sort and remove display only
"RTN","XQALERT1",26,0)
 I 'XQX1 W !!! D
"RTN","XQALERT1",27,0)
 . D SORT
"RTN","XQALERT1",28,0)
 ; Now display them.
"RTN","XQALERT1",29,0)
SUBLOOP W @IOF
"RTN","XQALERT1",30,0)
 N XQZ1,XQZ
"RTN","XQALERT1",31,0)
 S XQK=0 F XQI=0:0 Q:XQX1!XQXOUT  S XQI=$O(^TMP("XQ",$J,"XQA",XQI)) Q:XQI'>0  S XQX=^(XQI),XQII=^(XQI,1),XQZ=^(2),XQZ1=^(3) D  I XQX'="" D DOIT1
"RTN","XQALERT1",32,0)
 . I '$D(^XTV(8992,XQAUSER,"XQA",XQII)) S XQX="" K ^TMP("XQ",$J,"XQA",XQI),^TMP("XQ",$J,"XQA1",(999999-XQI))
"RTN","XQALERT1",33,0)
 . Q
"RTN","XQALERT1",34,0)
 S:'$D(XQXOUT) XQXOUT=0 G:XQXOUT EXIT G:XQK'>0&'XQX1 EXIT I 'XQX1 D ASK G:XQXOUT EXIT
"RTN","XQALERT1",35,0)
 G:+XQX1=0 EXIT I XQX1<0 S XQX1=0 G DOIT
"RTN","XQALERT1",36,0)
 I $D(XQALDELE)!$D(XQALFWD) Q
"RTN","XQALERT1",37,0)
 ;D WAIT(+XQX1) G:XQXOUT EXIT
"RTN","XQALERT1",38,0)
 G:XQXOUT EXIT
"RTN","XQALERT1",39,0)
 G EN^XQALDOIT
"RTN","XQALERT1",40,0)
 ;
"RTN","XQALERT1",41,0)
RESTORE ; Restore a deleted message for use
"RTN","XQALERT1",42,0)
 N ALERTREF,XTVGLOB,ADUZ,X,X0,X1,X2,TIME,MESG,OPT,TAG,ROU
"RTN","XQALERT1",43,0)
 S XTVGLOB=$NA(^XTV(8992,DUZ,"XQA"))
"RTN","XQALERT1",44,0)
 S ADUZ=$O(^XTV(8992,"AXQA",XQAID,0)) I ADUZ>0 S TIME=$O(^(ADUZ,0)) D  I 1
"RTN","XQALERT1",45,0)
 . M @XTVGLOB@(TIME)=^XTV(8992,ADUZ,"XQA",TIME) K @XTVGLOB@(TIME,2) ; copy alert, kill comment if any
"RTN","XQALERT1",46,0)
 E  S ALERTREF=$O(^XTV(8992.1,"B",XQAID,0)) Q:ALERTREF'>0  D  ; otherwise rebuild from alert tracking file if possible
"RTN","XQALERT1",47,0)
 . S X0=^XTV(8992.1,ALERTREF,0),X1=$G(^(1)),X2=$G(^(2))
"RTN","XQALERT1",48,0)
 . S TIME=$P($P(X0,U),";",3),MESG=$P(X1,U),OPT=$P(X1,U,2),TAG=$P(X1,U,3),ROU=$P(X1,U,4)
"RTN","XQALERT1",49,0)
 . S X=TIME_U_XQAID_U_MESG_U_U_$S(OPT'=""!(ROU'=""):"R",1:"I")_U_U_$S(OPT'="":OPT,TAG'="":TAG,1:"")_U_$S(OPT'="":"",ROU'="":ROU,1:" ")
"RTN","XQALERT1",50,0)
 . S @XTVGLOB@(TIME,0)=X I $G(X2)'="" S ^(1)=X2
"RTN","XQALERT1",51,0)
 S ^XTV(8992,"AXQA",XQAID,DUZ,TIME)="",^XTV(8992,"AXQAN",$E($P(XQAID,";"),1,30),DUZ,TIME)=""
"RTN","XQALERT1",52,0)
 Q
"RTN","XQALERT1",53,0)
 ;
"RTN","XQALERT1",54,0)
EXIT ;
"RTN","XQALERT1",55,0)
 I $G(XQALAST)="I",$G(DUZ("AUTO")) D WAIT2
"RTN","XQALERT1",56,0)
 I $D(XQALDELE)!$D(XQALFWD) Q
"RTN","XQALERT1",57,0)
 K ^TMP("XQ",$J,"XQA"),^("XQA1"),^("XQA2"),XQI,XQX,XQJ,XQK,XQX1,XQX2,XQXOUT,XQ1,XQII,XQACNT,XQA1,XQAREV,%ZIS,XQAROU,XQALAST,XQAROUX,XQON,XQOFF,XQ1ON,XQ1OFF,XQOUT,XQAQ
"RTN","XQALERT1",58,0)
 K ^TMP("XQALERT1",$J)
"RTN","XQALERT1",59,0)
 Q
"RTN","XQALERT1",60,0)
 ;
"RTN","XQALERT1",61,0)
 ; CHKSURO added 2/2/99 to give user opportunity to add/remove surrogate if no alerts present
"RTN","XQALERT1",62,0)
CHKSURO ; If user selects process alerts with no alerts present, give him/her the opportunity to add or delete a surrogate
"RTN","XQALERT1",63,0)
 ; P366 - list currently established surrogates if any
"RTN","XQALERT1",64,0)
 I '$G(^TMP("XQALERT1",$J,"NOTFIRST")) W !!,"You have no alerts for processing.",!
"RTN","XQALERT1",65,0)
 D SURROGAT^XQALSURO ; XU*8*17
"RTN","XQALERT1",66,0)
 Q
"RTN","XQALERT1",67,0)
 ;
"RTN","XQALERT1",68,0)
DOIT1 ;
"RTN","XQALERT1",69,0)
 I XQK=0 S XQALINFO=0 I '$D(XQALFWD) W @IOF
"RTN","XQALERT1",70,0)
 S XQON="$C(0)",XQOFF="$C(0)" S XQOUT=$P(XQX,U,3) I ($$UP^XLFSTR(XQOUT)["CRITICAL")!($$UP^XLFSTR(XQOUT)["ABNORMAL IMA") D:'$D(XQ1ON) SETREV^XQALERT S XQON=XQ1ON,XQOFF=XQ1OFF ; P285
"RTN","XQALERT1",71,0)
 S XQK=XQK+1 W !,$J(XQK,2),".",$S($P(XQX,U,8)=" ":"I",1:" "),"  ",@XQON,$E($P(XQX,U,3),1,70),@XQOFF S:$P(XQX,U,8)=" " XQALINFO=XQALINFO+1 D:XQZ1'=""  ; P285
"RTN","XQALERT1",72,0)
 . W !?8,"Forwarded by: ",$P(^VA(200,+XQZ1,0),U),"  Generated: ",$$DAT8^XQALERT(+$P($P(XQX,U,2),";",3),1)
"RTN","XQALERT1",73,0)
 . I $P(XQZ1,U,3)'="" W !?8,$P(XQZ1,U,3)
"RTN","XQALERT1",74,0)
 S ^TMP("XQ",$J,"XQA1",XQK)=XQX,^(XQK,1)=XQII,^(2)=XQZ,^(3)=XQZ1
"RTN","XQALERT1",75,0)
 I ($Y+6)>IOSL N XQKVALUE S XQKVALUE=XQK D ASK0(XQI) S:'$D(XQK) XQK=XQKVALUE Q:XQX1!(XQXOUT)  W @IOF
"RTN","XQALERT1",76,0)
 Q
"RTN","XQALERT1",77,0)
 ;
"RTN","XQALERT1",78,0)
ASK0(XQI) ;Stack XQI
"RTN","XQALERT1",79,0)
ASK ;
"RTN","XQALERT1",80,0)
 N XQALNEWF K XQALAST
"RTN","XQALERT1",81,0)
 ;I '$D(XQALDELE)&'$D(XQALFWD) S XQALNEWF=$P(^XTV(8992,XQAUSER,0),U,5) I XQALNEWF<20 D
"RTN","XQALERT1",82,0)
 ;. N XQALFDA
"RTN","XQALERT1",83,0)
 ;. S XQALNEWF=XQALNEWF+1,XQALFDA=(8992,(XQAUSER_","),.05)=XQALNEWF D FILE^DIE("","XQALFDA")
"RTN","XQALERT1",84,0)
 ;. W !,"NEW OPTIONS: S-to add/remove SURROGATE and D-to selectively Delete SOME alerts"
"RTN","XQALERT1",85,0)
 S XQ1=0,XQXOUT=0 W !?10,"Select from 1 to ",XQK W:$D(XQALDELE) " to DELETE" W:$D(XQALFWD) " to FORWARD"
"RTN","XQALERT1",86,0)
 W !?10,"or enter ?, A, " W:'$D(XQALDELE)&'$D(XQALFWD)&(XQALINFO>0) "I, D, " W:'$D(XQALDELE)&'$D(XQALFWD) "F, S, P, M, R, " W "or ^ to exit" I XQI>0,$O(^XTV(8992,XQAUSER,"XQA",XQI))>0 W !?10,"or RETURN to continue" S XQ1=1
"RTN","XQALERT1",87,0)
 R ": ",XQII:DTIME S:'$T!(XQII[U)!(XQII=""&'XQ1) XQXOUT=1 Q:XQXOUT
"RTN","XQALERT1",88,0)
 I '$D(XQALDELE)&'$D(XQALFWD),"PpMm"[$E(XQII_".") D MORP^XQALDOIT D:"Pp"[$E(XQII_".") PRINT^XQALDOIT D:"Mm"[$E(XQII_".") MAIL^XQALDOIT K ^TMP("XQ",$J,"XQA2") G ASK
"RTN","XQALERT1",89,0)
 I XQII'="",XQII["?" D HELP G ASK
"RTN","XQALERT1",90,0)
 I XQII=""&XQ1 Q
"RTN","XQALERT1",91,0)
 I "IiAaFfRrSsDd"'[$E(XQII_"."),$L(XQII)>31,$E(XQII,1,32)?1N.N W !,$C(7),"  ??  Invalid number entered",! G ASK
"RTN","XQALERT1",92,0)
 I "IiAaFfRrSsDd"'[$E(XQII_"."),(XQII<1)!(XQII>XQK) W $C(7),"  ??",! G ASK
"RTN","XQALERT1",93,0)
 I '$D(XQALDELE)&'$D(XQALFWD),"Ff"[$E(XQII) D FWRD^XQALFWD S XQX1=-2 Q  ; MODIFIED 7-6
"RTN","XQALERT1",94,0)
 I '$D(XQALDELE)&'$D(XQALFWD),"Ss"[$E(XQII) D CHKSURO S XQX1=-1 Q
"RTN","XQALERT1",95,0)
 I '$D(XQALDELE)&'$D(XQALFWD),"Dd"[$E(XQII) D ASKDEL S XQX1=-2 Q  ; MODIFIED 7-6
"RTN","XQALERT1",96,0)
 I '$D(XQALDELE),"Rr"[$E(XQII) S XQX1=-2 Q
"RTN","XQALERT1",97,0)
 I "Aa"[$E(XQII) S X="1-"_XQACNT,DIR(0)="LV^1:"_XQACNT D ^DIR K DIR,XQX1 M XQX1=Y S XQII="" K Y ;Merge list from Y
"RTN","XQALERT1",98,0)
 I XQII'="","Ii"[$E(XQII) S XQX1(0)="",XQX2=0,XQII="" F XQK=0:0 S XQK=$O(^TMP("XQ",$J,"XQA1",XQK)) S:XQK'>0 XQX1=XQX1(0) Q:XQK'>0  I $P(^(XQK),U,7,8)="^ " S XQX1(XQX2)=XQX1(XQX2)_XQK_"," S:$L(XQX1(XQX2))>240 XQX2=XQX2+1,XQX1(XQX2)=""
"RTN","XQALERT1",99,0)
 I XQII="" Q
"RTN","XQALERT1",100,0)
 S X=XQII,DIR(0)="LV^1:"_XQK D ^DIR I '$D(Y) W $C(7),"  ??" D HELP G ASK ;Use of 'LV' is special
"RTN","XQALERT1",101,0)
 K XQX1 M XQX1=Y K Y S Y=XQX1 ;Merge list from Y
"RTN","XQALERT1",102,0)
 Q
"RTN","XQALERT1",103,0)
WAIT(IFN) ;Wait for user input if last alert is INFO and next isn't.
"RTN","XQALERT1",104,0)
 N X,YY Q:$G(XQXOUT)
"RTN","XQALERT1",105,0)
 S X=$G(^TMP("XQ",$J,"XQA1",IFN)),YY=$P(X,U,7,8),YY=$S(YY="^ ":"I",YY="^":"O",1:"R")
"RTN","XQALERT1",106,0)
 I $G(XQALAST)="I","OR"[YY D WAIT2
"RTN","XQALERT1",107,0)
 I YY="I",$Y+4>IOSL D WAIT2 W @IOF
"RTN","XQALERT1",108,0)
 S XQALAST=YY
"RTN","XQALERT1",109,0)
 Q
"RTN","XQALERT1",110,0)
WAIT2 ;Wait for user input before continuing
"RTN","XQALERT1",111,0)
 N DIR,Y,DIROUT,DIRUT S DIR(0)="E",DIR("?")="The next ALERT may cause the loss of info on the screen."
"RTN","XQALERT1",112,0)
 D ^DIR S:$D(DIRUT) XQXOUT=1
"RTN","XQALERT1",113,0)
 Q
"RTN","XQALERT1",114,0)
 ;
"RTN","XQALERT1",115,0)
HELP W !!,"YOU MAY ENTER:",!?3,$S(XQK>1:"One or more numbers",1:"A number")," in the range 1 to ",XQK," to select specific alert(s)"
"RTN","XQALERT1",116,0)
 W !?6,"for "_$S($D(XQALDELE):"DELETION.",$D(XQALFWD):"FORWARDING",1:"processing.") W:XQK>1 "  This may be a series of numbers, e.g., 2,3,6-9"
"RTN","XQALERT1",117,0)
 W !?3,"A to "_$S($D(XQALDELE):"DELETE",$D(XQALFWD):"FORWARD",1:"process")," all of the pending alerts in the order shown."
"RTN","XQALERT1",118,0)
 W:'$D(XQALDELE)&'$D(XQALFWD) !?3,"I to process all of the INFORMATION ONLY alerts, if any, without further ado."
"RTN","XQALERT1",119,0)
 W:'$D(XQALDELE)&'$D(XQALFWD) !?3,"S to add or remove a surrogate to receive alerts for you"
"RTN","XQALERT1",120,0)
 W:'$D(XQALDELE)&'$D(XQALFWD) !?3,"F to forward one or more specific alerts.  Forwarding may be as an ALERT",!,"to specific user(s) and/or mail group(s), or as a MAIL MESSAGE, or to a",!,"specific PRINTER."
"RTN","XQALERT1",121,0)
 W:'$D(XQALDELE)&'$D(XQALFWD) !?3,"D to delete specific alerts (some alerts may not be deleted)"
"RTN","XQALERT1",122,0)
 W:'$D(XQALDELE)&'$D(XQALFWD) !?3,"P to print a copy of the pending alerts on a printer"
"RTN","XQALERT1",123,0)
 W:'$D(XQALDELE)&'$D(XQALFWD) !?3,"M to receive a MailMan message containing a copy of these pending alerts"
"RTN","XQALERT1",124,0)
 W:'$D(XQALDELE) !?3,"R to Redisplay the available alerts"
"RTN","XQALERT1",125,0)
 W !?3,"^ to exit"
"RTN","XQALERT1",126,0)
 I XQI W !?5,"or RETURN to see additional pending ALERTS"
"RTN","XQALERT1",127,0)
 W !!
"RTN","XQALERT1",128,0)
 Q
"RTN","XQALERT1",129,0)
 ;
"RTN","XQALERT1",130,0)
SORT ;Sort and remove display only
"RTN","XQALERT1",131,0)
 F XQI=0:0 S XQI=$O(^XTV(8992,XQAUSER,"XQA",XQI)) Q:XQI'>0  S XQX=^(XQI,0),XQZ=$G(^(1)),XQZ1=$G(^(2)) S XQJ=$P(XQX,U,7,8) K:XQJ=U ^XTV(8992,XQAUSER,"XQA",XQI) I XQJ'=U D
"RTN","XQALERT1",132,0)
 . S XQACNT=XQACNT+1,XQJ=$S(XQAREV:999999-XQACNT,1:XQACNT),^TMP("XQ",$J,"XQA",XQJ)=XQX,^(XQJ,1)=XQI,^(2)=XQZ,^(3)=XQZ1
"RTN","XQALERT1",133,0)
 S XQK=0 F XQI=0:0 S XQI=$O(^TMP("XQ",$J,"XQA",XQI)) Q:XQI'>0  S XQK=XQK+1 M ^TMP("XQ",$J,"XQA1",XQK)=^TMP("XQ",$J,"XQA",XQI)
"RTN","XQALERT1",134,0)
 Q
"RTN","XQALERT1",135,0)
 ;
"RTN","XQALERT1",136,0)
ASKDEL ;
"RTN","XQALERT1",137,0)
 N XQALDELE,XQX1COPY,XQAID,DA,XQAKILL,XQXOUT,XQAUSERD,XQALVALU
"RTN","XQALERT1",138,0)
 S XQALDELE=1
"RTN","XQALERT1",139,0)
 K XQX1
"RTN","XQALERT1",140,0)
 D DOIT^XQALERT1
"RTN","XQALERT1",141,0)
 K XQALDELE S XQAUSERD=1
"RTN","XQALERT1",142,0)
 I $D(XQX1),XQX1>0 D
"RTN","XQALERT1",143,0)
 . M XQX1COPY=XQX1
"RTN","XQALERT1",144,0)
 . F  Q:XQX1=""  S DA=+XQX1,XQX1=$P(XQX1,",",2,99) D  I XQX1="" S Y=$O(XQX1(0)) I Y>0 S XQX1=XQX1(Y) K XQX1(Y)
"RTN","XQALERT1",145,0)
 . . S XQAID=$P(^TMP("XQ",$J,"XQA1",DA),U,2),XQALVALU=^(DA),XQAKILL=1
"RTN","XQALERT1",146,0)
 . . I $P(XQALVALU,U,8)=" "!$P(XQALVALU,U,10) D
"RTN","XQALERT1",147,0)
 . . . I XQAID="" K ^XTV(8992,XQAUSER,"XQA",+^TMP("XQ",$J,"XQA1",DA,1))
"RTN","XQALERT1",148,0)
 . . . I XQAID'="" D DELETE^XQALDEL
"RTN","XQALERT1",149,0)
 . . . K ^TMP("XQ",$J,"XQA1",DA),^TMP("XQ",$J,"XQA",(999999-DA))
"RTN","XQALERT1",150,0)
 . K XQX1 M XQX1=XQX1COPY S XQAID=0
"RTN","XQALERT1",151,0)
 . F  Q:XQX1=""  S DA=+XQX1,XQX1=$P(XQX1,",",2,99) D  I XQX1="" S Y=$O(XQX1(0)) I Y>0 S XQX1=XQX1(Y) K XQX1(Y)
"RTN","XQALERT1",152,0)
 . . I $D(^TMP("XQ",$J,"XQA1",DA)) W:'XQAID !!,"Unable to delete alerts which require action: ",DA W:XQAID ",",DA S XQAID=1
"RTN","XQALERT1",153,0)
 . I XQAID=1 K DIR S DIR(0)="E" D ^DIR K DIR
"RTN","XQALERT1",154,0)
 K XQX1,XQAKILL
"RTN","XQALERT1",155,0)
 Q
"RTN","XQALERT1",156,0)
 ;
"RTN","XQALERT1",157,0)
FRWRDONE ;
"RTN","XQALERT1",158,0)
 N XQX1,XQALFWDL S XQALFWDL(1)=XQAID
"RTN","XQALERT1",159,0)
 N XQAID
"RTN","XQALERT1",160,0)
 D FWDONE^XQALFWD
"RTN","XQALERT1",161,0)
 Q
"RTN","XQALSUR1")
0^5^B65103748
"RTN","XQALSUR1",1,0)
XQALSUR1 ;ISC-SF.SEA/JLI - SURROGATES FOR ALERTS ;9/6/05  14:26
"RTN","XQALSUR1",2,0)
 ;;8.0;KERNEL;**366**;Jul 10, 1995
"RTN","XQALSUR1",3,0)
 Q
"RTN","XQALSUR1",4,0)
 ;
"RTN","XQALSUR1",5,0)
RETURN(XQAUSER) ; P366 - return alerts to the user
"RTN","XQALSUR1",6,0)
 N XQAI,X0,XQASTRT,XQASURO,XQAEND
"RTN","XQALSUR1",7,0)
 ; identify periods in the surrogate multiple that haven't been returned
"RTN","XQALSUR1",8,0)
 F XQAI=0:0 S XQAI=$O(^XTV(8992,XQAUSER,2,"AC",1,XQAI)) Q:XQAI'>0  S X0=^XTV(8992,XQAUSER,2,XQAI,0) I $P(X0,U,4)=1 D
"RTN","XQALSUR1",9,0)
 . S XQASTRT=$P(X0,U) S XQAEND=$P(X0,U,3)
"RTN","XQALSUR1",10,0)
 . ; and clear the flag indicating we need to restore these alerts
"RTN","XQALSUR1",11,0)
 . N XQAFDA S XQAFDA(8992.02,XQAI_","_XQAUSER_",",.04)="@" D FILE^DIE("","XQAFDA")
"RTN","XQALSUR1",12,0)
 . ; restore alerts to intended user, remove from surrogate if completed (i.e., no other surrogates and not intended recipient)
"RTN","XQALSUR1",13,0)
 . D PUSHBACK(XQAUSER,XQASTRT,XQAEND)
"RTN","XQALSUR1",14,0)
 . Q
"RTN","XQALSUR1",15,0)
 Q
"RTN","XQALSUR1",16,0)
 ;
"RTN","XQALSUR1",17,0)
PUSHBACK(XQAUSER,XQASTRT,XQAEND) ; P366 - identify alerts in alert tracking file for return and return them
"RTN","XQALSUR1",18,0)
 N XQAINIT,XQAI,X0,X30,XNOSURO,XQADT,XQAJ,XQAK,XQAL,XQAOTH,XQASUROP
"RTN","XQALSUR1",19,0)
 S XQAINIT=$$FIND1^DIC(8992.2,,"X","INITIAL RECIPIENT")
"RTN","XQALSUR1",20,0)
 F XQADT=XQASTRT-.0000001:0 S XQADT=$O(^XTV(8992.1,"AUD",XQAUSER,XQADT)) Q:XQADT'>0  Q:XQADT>XQAEND  F XQAI=0:0 S XQAI=$O(^XTV(8992.1,"AUD",XQAUSER,XQADT,XQAI)) Q:XQAI'>0  D
"RTN","XQALSUR1",21,0)
 . S XQAJ=$O(^XTV(8992.1,XQAI,20,"B",XQAUSER,0)) Q:XQAJ'>0
"RTN","XQALSUR1",22,0)
 . N XSURO,XNOSURO,XQAID S XNOSURO=0,XQAID=$P(^XTV(8992.1,XQAI,0),U)
"RTN","XQALSUR1",23,0)
 . F XQAK=0:0 S XQAK=$O(^XTV(8992.1,XQAI,20,XQAJ,1,"B",XQAK)) Q:XQAK'>0  F XQAL=0:0 S XQAL=$O(^XTV(8992.1,XQAI,20,XQAJ,1,"B",XQAK,XQAL)) Q:XQAL'>0  D
"RTN","XQALSUR1",24,0)
 . . S X0=^XTV(8992.1,XQAI,20,XQAJ,1,XQAL,0) S:$P(X0,U,2)>0 XSURO($P(X0,U,2))="" S:$P(X0,U,2)'>0 XNOSURO=1 ; sent to XSURO as surrogate
"RTN","XQALSUR1",25,0)
 . . Q
"RTN","XQALSUR1",26,0)
 . I 'XNOSURO D
"RTN","XQALSUR1",27,0)
 . . N XQA,XQACMNT,XQALTYPE
"RTN","XQALSUR1",28,0)
 . . S XQA(XQAUSER)="",XQACMNT="RESTORED FROM SURROGATE",XQALTYPE="RESTORE FROM SURROGATE"
"RTN","XQALSUR1",29,0)
 . . N XQAUSER,XQAI S XQAUSER=$O(^XTV(8992,"AXQA",XQAID,0)) Q:XQAUSER'>0  D RESETUP^XQALFWD(XQAID,.XQA,XQACMNT)
"RTN","XQALSUR1",30,0)
 . . Q
"RTN","XQALSUR1",31,0)
 . ; walk through each of those it was sent to as a surrogate for XQAUSER
"RTN","XQALSUR1",32,0)
 . F XQASUROP=0:0 S XQASUROP=$O(XSURO(XQASUROP)) Q:XQASUROP'>0  S XQAJ=$O(^XTV(8992.1,XQAI,20,"B",XQASUROP,0)) D
"RTN","XQALSUR1",33,0)
 . . ; and identify each time they were considered a recipient of the alert
"RTN","XQALSUR1",34,0)
 . . S XNOSURO=0 F XQAK=0:0 Q:XNOSURO  S XQAK=$O(^XTV(8992.1,XQAI,20,XQAJ,1,"B",XQAK)) Q:XQAK'>0  F XQAL=0:0 S XQAL=$O(^XTV(8992.1,XQAI,20,XQAJ,1,"B",XQAK,XQAL)) Q:XQAL'>0  S X0=^XTV(8992.1,XQAI,20,XQAJ,1,XQAL,0) D  Q:XNOSURO
"RTN","XQALSUR1",35,0)
 . . . I $P(X0,U,3)'="Y" S XNOSURO=1 Q  ; this one got it directly as a recipient as well
"RTN","XQALSUR1",36,0)
 . . . ; walk through the SURROGATE FOR entries for this user
"RTN","XQALSUR1",37,0)
 . . . F XQAOTH=0:0 S XQAOTH=$O(^XTV(8992.1,XQAI,20,XQAJ,3,XQAOTH)) Q:XQAOTH'>0  S X30=^(XQAOTH,0) D  Q:XNOSURO
"RTN","XQALSUR1",38,0)
 . . . . I +X30=XQAUSER S $P(^XTV(8992.1,XQAI,20,XQAJ,3,XQAOTH,0),U,3)=$$NOW^XLFDT() Q  ; mark this user as returned
"RTN","XQALSUR1",39,0)
 . . . . I $P(X30,U,3)'>0 S XNOSURO=1 Q  ; another surrogate hasn't been returned yet, so leave the alert
"RTN","XQALSUR1",40,0)
 . . . . Q
"RTN","XQALSUR1",41,0)
 . . . Q
"RTN","XQALSUR1",42,0)
 . . I 'XNOSURO D
"RTN","XQALSUR1",43,0)
 . . . N XQAKILL,XQAUSER,XQAI S XQAKILL=1,XQAUSER=XQASUROP D DELETE^XQALDEL
"RTN","XQALSUR1",44,0)
 . . . Q
"RTN","XQALSUR1",45,0)
 . . Q
"RTN","XQALSUR1",46,0)
 . Q
"RTN","XQALSUR1",47,0)
 Q
"RTN","XQALSUR1",48,0)
 ;
"RTN","XQALSUR1",49,0)
SUROLIST(XQAUSER,XQALIST) ; returns for XQAUSER a list of current and/or future surrogates in XQALIST
"RTN","XQALSUR1",50,0)
 ;  usage  D SUROLIST^XQALSUR1(DUZ,.XQALIST)
"RTN","XQALSUR1",51,0)
 ;
"RTN","XQALSUR1",52,0)
 ;  returns  XQALIST=count
"RTN","XQALSUR1",53,0)
 ;           XQALIST(1)=IEN2^NEWPERSON,USER2^STARTDATETIME^ENDDATETIME
"RTN","XQALSUR1",54,0)
 ;           XQALIST(2)=3^NAME,USER3^3050407.1227^3050406
"RTN","XQALSUR1",55,0)
 ;
"RTN","XQALSUR1",56,0)
 N XQA0,XQADATE,XQAIEN,XQAL,XQALCNT,XQALEND,XQANOW,XQASTART,XQASURO,XQAVALU
"RTN","XQALSUR1",57,0)
 D CHEKSUBS^XQALSUR2(XQAUSER)
"RTN","XQALSUR1",58,0)
 S XQALCNT=$$CURRSURO^XQALSURO(XQAUSER)
"RTN","XQALSUR1",59,0)
 S XQANOW=$$NOW^XLFDT(),XQALCNT=0
"RTN","XQALSUR1",60,0)
 S XQADATE="" F  S XQADATE=$O(^XTV(8992,XQAUSER,2,"B",XQADATE)) Q:XQADATE'>0  S XQAIEN="" F  S XQAIEN=$O(^XTV(8992,XQAUSER,2,"B",XQADATE,XQAIEN)) Q:XQAIEN'>0  D
"RTN","XQALSUR1",61,0)
 . S XQA0=^XTV(8992,XQAUSER,2,XQAIEN,0),XQASTART=$P(XQA0,U),XQASURO=$P(XQA0,U,2),XQALEND=$P(XQA0,U,3) I XQALEND>0,XQALEND'>XQANOW Q
"RTN","XQALSUR1",62,0)
 . S XQALCNT=XQALCNT+1,XQAVALU=$$GET1^DIQ(200,XQASURO_",",.01),XQAL(XQALCNT)=XQASURO_U_XQAVALU_U_XQASTART_U_XQALEND
"RTN","XQALSUR1",63,0)
 . Q
"RTN","XQALSUR1",64,0)
 ; now rearrange by earliest to last
"RTN","XQALSUR1",65,0)
 K XQALIST S XQALIST=0
"RTN","XQALSUR1",66,0)
 S XQALCNT="" F  S XQALCNT=$O(XQAL(XQALCNT)) Q:XQALCNT'>0  D
"RTN","XQALSUR1",67,0)
 . ; if end date not specified, and start date follows, set end date to next start date
"RTN","XQALSUR1",68,0)
 . I $D(XQAL(XQALCNT+1)),($P(XQAL(XQALCNT),U,4)>$P(XQAL(XQALCNT+1),U,3))!($P(XQAL(XQALCNT),U,4)'>0) S $P(XQAL(XQALCNT),U,4)=$P(XQAL(XQALCNT+1),U,3)
"RTN","XQALSUR1",69,0)
 . S XQALIST=XQALIST+1,XQALIST(XQALIST)=XQAL(XQALCNT)
"RTN","XQALSUR1",70,0)
 . Q
"RTN","XQALSUR1",71,0)
 Q
"RTN","XQALSUR1",72,0)
 ;
"RTN","XQALSUR1",73,0)
DCYCLIC(XQALSURO,XQAUSER,XQALSTRT,XQALEND) ; code added to prevent cyclical surrogates - use dates for surrogacy
"RTN","XQALSUR1",74,0)
 N XQALNEXT,XQALIST,I,XQALAST
"RTN","XQALSUR1",75,0)
 I XQALSURO=XQAUSER Q "This forms a circle which leads back to this user during this period - can't do it!"
"RTN","XQALSUR1",76,0)
 S XQALNEXT=$$CURRSURO^XQALSURO(XQALSURO,XQALSTRT,XQALEND) I XQALNEXT>0 D
"RTN","XQALSUR1",77,0)
 . F I=1:1 Q:$P(XQALNEXT,U,I)=""  S XQALAST=$$DCYCLIC($P(XQALNEXT,U,I),XQAUSER,XQALSTRT,XQALEND) I XQALAST'>0 S XQALSURO=XQALAST Q
"RTN","XQALSUR1",78,0)
 . Q
"RTN","XQALSUR1",79,0)
 Q XQALSURO
"RTN","XQALSUR1",80,0)
 ;
"RTN","XQALSUR1",81,0)
DATESURO(XQAUSER,XQALSTRT,XQALEND) ; returns surrogate(s) for XQAUSER in date range XQALSTRT to XQALEND, may be multiple values ^-separated
"RTN","XQALSUR1",82,0)
 N XQALY,XQA0,XQALIEN,XQALS
"RTN","XQALSUR1",83,0)
 S XQALY="" I XQALEND'>0 S XQALEND=4000101
"RTN","XQALSUR1",84,0)
 F XQALS=0:0 S XQALS=$O(^XTV(8992,XQAUSER,2,"B",XQALS)) Q:XQALS'>0  Q:XQALS'<XQALEND  D
"RTN","XQALSUR1",85,0)
 . F XQALIEN=0:0 S XQALIEN=$O(^XTV(8992,XQAUSER,2,"B",XQALS,XQALIEN)) Q:XQALIEN'>0  S XQA0=^XTV(8992,XQAUSER,2,XQALIEN,0) Q:$P(XQA0,U,3)'>XQALSTRT  S XQALY=XQALY_$S(XQALY="":"",1:U)_$P(XQA0,U,2)
"RTN","XQALSUR1",86,0)
 . Q
"RTN","XQALSUR1",87,0)
 Q XQALY
"RTN","XQALSUR1",88,0)
 ;
"RTN","XQALSUR1",89,0)
SURRO1(XQAUSER) ;
"RTN","XQALSUR1",90,0)
 N XQALSURO,XQALSTRT,XQALEND
"RTN","XQALSUR1",91,0)
 D CHKREMV^XQALSURO
"RTN","XQALSUR1",92,0)
SURRO11 ;
"RTN","XQALSUR1",93,0)
 S XQALSURO=$$NEWDLG() I XQALSURO'>0 Q
"RTN","XQALSUR1",94,0)
 I $$CYCLIC^XQALSURO(XQALSURO,XQAUSER)'>0 W $C(7),!,$$CYCLIC^XQALSURO(XQALSURO,XQAUSER),! G SURRO1
"RTN","XQALSUR1",95,0)
 S XQALSTRT=+$$STRTDLG() I XQALSTRT<0 Q
"RTN","XQALSUR1",96,0)
 S XQALEND=+$$ENDDLG() I XQALEND<0 Q
"RTN","XQALSUR1",97,0)
 D SETSURO^XQALSURO(XQAUSER,XQALSURO,XQALSTRT,XQALEND)
"RTN","XQALSUR1",98,0)
 G SURRO11 ;
"RTN","XQALSUR1",99,0)
 Q
"RTN","XQALSUR1",100,0)
 ;
"RTN","XQALSUR1",101,0)
 ; P366 - added OPTIONAL second and third arguments to permit deletion of a specific pending surrogate and start date
"RTN","XQALSUR1",102,0)
REMVSURO(XQAUSER,XQALSURO,XQALSTRT) ; SR - ends the currently active surrogate relationship
"RTN","XQALSUR1",103,0)
 I $G(XQAUSER)'>0 Q
"RTN","XQALSUR1",104,0)
 S XQALSURO=$G(XQALSURO),XQALSTRT=$G(XQALSTRT)
"RTN","XQALSUR1",105,0)
 N XQALFM,XQALXREF,XQALSTR1,XQALSUR1,XQALNOW,XQALEND,XQA0
"RTN","XQALSUR1",106,0)
 ; ZEXCEPT: XQATEST   (EXTERNAL VALUE - INDICATING TEST BEING RUN)
"RTN","XQALSUR1",107,0)
 D CHEKSUBS^XQALSUR2(XQAUSER)
"RTN","XQALSUR1",108,0)
 S XQALSUR1=+$P($G(^XTV(8992,XQAUSER,0)),U,2) S:XQALSURO'>0 XQALSURO=XQALSUR1
"RTN","XQALSUR1",109,0)
 S XQALSTR1=$P($G(^XTV(8992,XQAUSER,0)),U,3) S:XQALSTRT'>0 XQALSTRT=XQALSTR1
"RTN","XQALSUR1",110,0)
 S XQALEND=$P($G(^XTV(8992,XQAUSER,0)),U,4)
"RTN","XQALSUR1",111,0)
 S XQALXREF=0 I XQALSTRT>0 F  S XQALXREF=$O(^XTV(8992,XQAUSER,2,"B",XQALSTRT,XQALXREF)) Q:XQALXREF'>0  I $P(^XTV(8992,XQAUSER,2,XQALXREF,0),U,2)=XQALSURO D
"RTN","XQALSUR1",112,0)
 . S XQALEND=$P(^XTV(8992,XQAUSER,2,XQALXREF,0),U,3) D DELETENT(XQAUSER,XQALXREF,XQALSURO,XQALSTRT,XQALSUR1,XQALSTR1,XQALEND)
"RTN","XQALSUR1",113,0)
 . Q
"RTN","XQALSUR1",114,0)
 S XQALSURO=$$CURRSURO^XQALSURO(XQAUSER) ; make sure current surrogate is updated if necessary.
"RTN","XQALSUR1",115,0)
 Q
"RTN","XQALSUR1",116,0)
 ;
"RTN","XQALSUR1",117,0)
DELETENT(XQAUSER,XQALXREF,XQALSURO,XQALSTRT,XQALSUR1,XQALSTR1,XQALEND) ;
"RTN","XQALSUR1",118,0)
 N XQALNOW,XQALFM
"RTN","XQALSUR1",119,0)
 ; ZEXCEPT: XQATEST   (EXTERNAL VALUE - INDICATING TEST BEING RUN)
"RTN","XQALSUR1",120,0)
 S XQAUSER=XQAUSER_",",XQALXREF=XQALXREF_","_XQAUSER
"RTN","XQALSUR1",121,0)
 I XQALXREF>0 D
"RTN","XQALSUR1",122,0)
 . S XQALNOW=$$NOW^XLFDT()
"RTN","XQALSUR1",123,0)
 . I XQALSTRT>XQALNOW S XQALFM(8992.02,XQALXREF,.01)=XQALNOW ; if scheduled for later, mark start as now
"RTN","XQALSUR1",124,0)
 . I (XQALEND>XQALNOW)!(XQALEND'>0) S XQALFM(8992.02,XQALXREF,.03)=XQALNOW ; update end time for surrogate to now
"RTN","XQALSUR1",125,0)
 . I XQALSTRT'>XQALNOW S XQALFM(8992.02,XQALXREF,.04)=1
"RTN","XQALSUR1",126,0)
 . Q
"RTN","XQALSUR1",127,0)
 I XQALSUR1=XQALSURO,XQALSTRT=XQALSTR1 D
"RTN","XQALSUR1",128,0)
 . S XQALFM(8992,XQAUSER,.02)="@"
"RTN","XQALSUR1",129,0)
 . S XQALFM(8992,XQAUSER,.03)="@"
"RTN","XQALSUR1",130,0)
 . S XQALFM(8992,XQAUSER,.04)="@"
"RTN","XQALSUR1",131,0)
 . Q
"RTN","XQALSUR1",132,0)
 I $D(XQALFM) D FILE^DIE("","XQALFM")
"RTN","XQALSUR1",133,0)
 I XQALSURO>0,'$D(XQATEST) D
"RTN","XQALSUR1",134,0)
 . N XQAMESG,XMSUB,XMTEXT
"RTN","XQALSUR1",135,0)
 . S XQAMESG(1,0)="You have been REMOVED as a surrogate recipient for alerts for"
"RTN","XQALSUR1",136,0)
 . S XQAMESG(2,0)=$$GET1^DIQ(200,XQAUSER,.01,"E")_" (IEN="_$P(XQAUSER,",")_")."
"RTN","XQALSUR1",137,0)
 . S XMTEXT="XQAMESG(",XMSUB="Removal as surrogate recipient"
"RTN","XQALSUR1",138,0)
 . D SENDMESG^XQALSURO
"RTN","XQALSUR1",139,0)
 . Q
"RTN","XQALSUR1",140,0)
 Q
"RTN","XQALSUR1",141,0)
 ;
"RTN","XQALSUR1",142,0)
NEWDLG() ; new surrogate dialog
"RTN","XQALSUR1",143,0)
 N DIR,Y S DIR(0)="Y",DIR("A")="Do you want to SET a new surrogate recipient",DIR("?")="A surrogate will receive your alerts until they are removed as surrogate.",DIR("B")="NO"
"RTN","XQALSUR1",144,0)
 S Y=$$ASKDIR(.DIR) I 'Y Q 0
"RTN","XQALSUR1",145,0)
 ;
"RTN","XQALSUR1",146,0)
 S DIR(0)="P^200:AEMQ",DIR("A")="Select USER to be SURROGATE" S Y=$$ASKDIR(.DIR)  ; COS-0401-41366
"RTN","XQALSUR1",147,0)
 I Y>0 W "  ",$P(Y,U,2)
"RTN","XQALSUR1",148,0)
 Q +Y
"RTN","XQALSUR1",149,0)
 ;
"RTN","XQALSUR1",150,0)
STRTDLG() ; new surrogate start date/time dialog
"RTN","XQALSUR1",151,0)
 N DIR
"RTN","XQALSUR1",152,0)
 S DIR(0)="DO^::ATEX",DIR("A")="Specify Date/Time SURROGATE becomes active" ; BRX-1000-10427
"RTN","XQALSUR1",153,0)
 S DIR("A",1)="",DIR("A",2)=""
"RTN","XQALSUR1",154,0)
 S DIR("A",3)="if no date/time is entered, alerts will start going to"
"RTN","XQALSUR1",155,0)
 S DIR("A",4)="the SURROGATE immediately."
"RTN","XQALSUR1",156,0)
 Q +$$ASKDIR(.DIR)
"RTN","XQALSUR1",157,0)
 ;
"RTN","XQALSUR1",158,0)
ENDDLG() ; new surrogate end date/time dialog
"RTN","XQALSUR1",159,0)
 N DIR
"RTN","XQALSUR1",160,0)
 S DIR(0)="DO^::AETX",DIR("A")="Specify Date/Time SURROGATE should be removed" ; BRX-1000-10427
"RTN","XQALSUR1",161,0)
 S DIR("A",1)="",DIR("A",2)=""
"RTN","XQALSUR1",162,0)
 S DIR("A",3)="if no date/time is entered, YOU must remove the SURROGATE"
"RTN","XQALSUR1",163,0)
 S DIR("A",4)="to terminate alerts going to the SURROGATE"
"RTN","XQALSUR1",164,0)
 Q +$$ASKDIR(.DIR)
"RTN","XQALSUR1",165,0)
 ;
"RTN","XQALSUR1",166,0)
ASKDIR(DIR) ;
"RTN","XQALSUR1",167,0)
 N Y,DTOUT,DUOUT
"RTN","XQALSUR1",168,0)
 D ^DIR K DIR I $D(DTOUT)!$D(DUOUT) S Y=-1
"RTN","XQALSUR1",169,0)
 Q Y
"RTN","XQALSUR2")
0^6^B6279756
"RTN","XQALSUR2",1,0)
XQALSUR2 ;FO-OAK.SEA/JLI-Continuation of alert surrogate processing ;9/6/05  14:23
"RTN","XQALSUR2",2,0)
 ;;8.0;KERNEL;**366**;Jul 10, 1995
"RTN","XQALSUR2",3,0)
 Q
"RTN","XQALSUR2",4,0)
 ; added to handle adjustment for manual or Fileman editing of surrogate on top zero node
"RTN","XQALSUR2",5,0)
CHEKSUBS(XQAUSER) ;
"RTN","XQALSUR2",6,0)
 N XQA0,XQASTR1,XQANOW,XQB0,XQB1
"RTN","XQALSUR2",7,0)
 S XQANOW=$$NOW^XLFDT()
"RTN","XQALSUR2",8,0)
 S XQA0=$G(^XTV(8992,XQAUSER,0)) I $P(XQA0,U,2)>0 D
"RTN","XQALSUR2",9,0)
 . N XQAFDA,XQAIEN
"RTN","XQALSUR2",10,0)
 . S XQASTR1=$P(XQA0,U,3) S:XQASTR1'>0 XQASTR1=XQANOW,XQAFDA(8992,XQAUSER_",",.03)=XQASTR1 I '$D(^XTV(8992,XQAUSER,2,"B",XQASTR1)) D  Q
"RTN","XQALSUR2",11,0)
 . . S XQAIEN="+1,"_XQAUSER_"," S XQAFDA(8992.02,XQAIEN,.01)=XQASTR1
"RTN","XQALSUR2",12,0)
 . . S XQAFDA(8992.02,XQAIEN,.02)=$P(XQA0,U,2) S:$P(XQA0,U,4)>0 XQAFDA(8992.02,XQAIEN,.03)=$P(XQA0,U,4)
"RTN","XQALSUR2",13,0)
 . . D UPDATE^DIE("","XQAFDA")
"RTN","XQALSUR2",14,0)
 . . Q
"RTN","XQALSUR2",15,0)
 . K XQAFDA S XQB0=$O(^XTV(8992,XQAUSER,2,"B",XQASTR1,0))
"RTN","XQALSUR2",16,0)
 . I XQB0>0 S XQB1=^XTV(8992,XQAUSER,2,XQB0,0) I $P(XQB1,U,3)>0,$P(XQA0,U,4)="" D
"RTN","XQALSUR2",17,0)
 . . ; have an entry appearing to have ended, but still data on zero node.
"RTN","XQALSUR2",18,0)
 . . I $P(XQB1,U,3)<XQANOW D  Q
"RTN","XQALSUR2",19,0)
 . . . ; add a matching subfile with startdate two seconds before, and end to now less one second - next time it is looked at it will be removed.
"RTN","XQALSUR2",20,0)
 . . . S XQAFDA(8992,XQAUSER_",",.03)=XQASTR1-.000002,XQAFDA(8992,XQAUSER_",",.04)=XQANOW-.000001 D FILE^DIE("","XQAFDA") K XQAFDA
"RTN","XQALSUR2",21,0)
 . . . S XQAIEN="+1,"_XQAUSER_",",XQAFDA(8992.02,XQAIEN,.01)=XQASTR1-.000002,XQAFDA(8992.02,XQAIEN,.02)=$P(XQA0,U,2),XQAFDA(8992.02,XQAIEN,.03)=XQANOW-.000001 D UPDATE^DIE("","XQAFDA")
"RTN","XQALSUR2",22,0)
 . . . Q
"RTN","XQALSUR2",23,0)
 . . ; add end date/time in future to zero node
"RTN","XQALSUR2",24,0)
 . . S $P(^XTV(8992,XQAUSER,0),U,4)=$P(XQB1,U,3) ; set 0 node end date/time to that of the subfile
"RTN","XQALSUR2",25,0)
 . . Q
"RTN","XQALSUR2",26,0)
 . Q
"RTN","XQALSUR2",27,0)
 Q
"RTN","XQALSURO")
0^4^B62950995
"RTN","XQALSURO",1,0)
XQALSURO ;ISC-SF.SEA/JLI - SURROGATES FOR ALERTS ;9/6/05  15:13
"RTN","XQALSURO",2,0)
 ;;8.0;KERNEL;**114,125,173,285,366**;Jul 10, 1995
"RTN","XQALSURO",3,0)
 ;;
"RTN","XQALSURO",4,0)
 Q
"RTN","XQALSURO",5,0)
OTHRSURO ; OPT:- XQALERT SURROGATE SET/REMOVE -- OTHERS SPECIFY SURROGATE FOR SELECTED USER
"RTN","XQALSURO",6,0)
 N XQAUSER,DIR,Y
"RTN","XQALSURO",7,0)
 S DIR(0)="PD^200:AEMQ",DIR("A",1)="SURROGATE related to which"
"RTN","XQALSURO",8,0)
 S DIR("A")="NEW PERSON entry"
"RTN","XQALSURO",9,0)
 D ^DIR K DIR Q:Y'>0  W "  ",$P(Y,U,2)
"RTN","XQALSURO",10,0)
 S XQAUSER=+Y
"RTN","XQALSURO",11,0)
 G SURROGAT
"RTN","XQALSURO",12,0)
 Q
"RTN","XQALSURO",13,0)
 ;
"RTN","XQALSURO",14,0)
SURROGAT ; USER SPECIFICATION OF SURROGATE
"RTN","XQALSURO",15,0)
 I '$D(XQAUSER) N XQAUSER S XQAUSER=DUZ
"RTN","XQALSURO",16,0)
 D SURRO1^XQALSUR1(XQAUSER)
"RTN","XQALSURO",17,0)
 Q
"RTN","XQALSURO",18,0)
 ; P366 - optional start and end dates added to permit identification of cyclical surrogates in specific times
"RTN","XQALSURO",19,0)
CYCLIC(XQALSURO,XQAUSER,XQASTRT,XQAEND) ; code added to prevent cyclical surrogates
"RTN","XQALSURO",20,0)
 I $G(XQASTRT)>0 Q $$DCYCLIC^XQALSUR1(XQALSURO,XQAUSER,XQASTRT,$G(XQAEND))
"RTN","XQALSURO",21,0)
 N XQALSTRT
"RTN","XQALSURO",22,0)
 I XQALSURO=XQAUSER Q "You cannot specify yourself as your own surrogate!"
"RTN","XQALSURO",23,0)
 S XQALSTRT=$$CURRSURO(XQALSURO) I XQALSTRT>0 D
"RTN","XQALSURO",24,0)
 . I XQALSTRT=XQAUSER S XQALSURO="YOU are designated as the surrogate for this user - can't do it!" Q
"RTN","XQALSURO",25,0)
 . F  S XQALSTRT=$$CURRSURO(XQALSTRT) Q:XQALSTRT'>0  I XQALSTRT=XQAUSER S XQALSURO="This forms a circle which leads back to you - can't do it!" Q
"RTN","XQALSURO",26,0)
 . Q
"RTN","XQALSURO",27,0)
 Q XQALSURO
"RTN","XQALSURO",28,0)
 ;
"RTN","XQALSURO",29,0)
SETSURO(XQAUSER,XQALSURO,XQALSTRT,XQALEND) ; SR
"RTN","XQALSURO",30,0)
 N XQALFM,XQALIEN,XQAIENS
"RTN","XQALSURO",31,0)
 I $G(XQAUSER)'>0 Q
"RTN","XQALSURO",32,0)
 I $G(XQALSURO)'>0 Q
"RTN","XQALSURO",33,0)
 I '$D(^XTV(8992,XQAUSER,0)) D
"RTN","XQALSURO",34,0)
 . N XQALFM,XQALFM1
"RTN","XQALSURO",35,0)
 . S XQALFM1(1)=XQAUSER
"RTN","XQALSURO",36,0)
 . S XQALFM(8992,"+1,",.01)=XQAUSER
"RTN","XQALSURO",37,0)
 . D UPDATE^DIE("","XQALFM","XQALFM1")
"RTN","XQALSURO",38,0)
 . Q
"RTN","XQALSURO",39,0)
 S XQAIENS=XQAUSER_","
"RTN","XQALSURO",40,0)
 ; P366 - force no start date/time to NOW
"RTN","XQALSURO",41,0)
 ; P366 - change to force anything less than NOW to NOW - 8/22/05
"RTN","XQALSURO",42,0)
 I $G(XQALSTRT)<$$NOW^XLFDT() S XQALSTRT=$$NOW^XLFDT()
"RTN","XQALSURO",43,0)
 ; P366 - add values to new multiple
"RTN","XQALSURO",44,0)
 S XQALFM(8992.02,"+1,"_XQAIENS,.01)=XQALSTRT
"RTN","XQALSURO",45,0)
 S XQALFM(8992.02,"+1,"_XQAIENS,.02)=XQALSURO
"RTN","XQALSURO",46,0)
 I XQALEND>0 S XQALFM(8992.02,"+1,"_XQAIENS,.03)=XQALEND
"RTN","XQALSURO",47,0)
 K XQALIEN D UPDATE^DIE("","XQALFM","XQALIEN")
"RTN","XQALSURO",48,0)
 ; P366 - if start date time is already in effect - place in old locations to make active
"RTN","XQALSURO",49,0)
 I XQALSTRT'>$$NOW^XLFDT() D ACTIVATE(XQAUSER,XQALIEN(1))
"RTN","XQALSURO",50,0)
 N XQAMESG,XMSUB,XMTEXT
"RTN","XQALSURO",51,0)
 S XQAMESG(1,0)="You have been specified as a surrogate recipient for alerts for"
"RTN","XQALSURO",52,0)
 S XQAMESG(2,0)=$$GET1^DIQ(200,XQAIENS,.01,"E")_" (IEN="_XQAUSER_") effective "_$$FMTE^XLFDT(XQALSTRT)
"RTN","XQALSURO",53,0)
 I $G(XQALEND)'>0 S XQAMESG(2,0)=XQAMESG(2,0)_"."
"RTN","XQALSURO",54,0)
 E  S XQAMESG(3,0)="until "_$$FMTE^XLFDT(XQALEND)
"RTN","XQALSURO",55,0)
 S XMSUB="Surrogate Recipient for "_$$GET1^DIQ(200,XQAIENS,.01,"E")
"RTN","XQALSURO",56,0)
 S XMTEXT="XQAMESG("
"RTN","XQALSURO",57,0)
 D:'$D(XQATEST) SENDMESG
"RTN","XQALSURO",58,0)
 Q
"RTN","XQALSURO",59,0)
 ;
"RTN","XQALSURO",60,0)
ACTIVATE(XQAUSER,XQALIEN) ; activates a surrogate
"RTN","XQALSURO",61,0)
 N X0,XQALFM,XQALSURO,XQALSTRT,XQALEND
"RTN","XQALSURO",62,0)
 S X0=$G(^XTV(8992,XQAUSER,2,XQALIEN,0)) Q:X0=""  S XQALSTRT=$P(X0,U),XQALSURO=$P(X0,U,2),XQALEND=$P(X0,U,3)
"RTN","XQALSURO",63,0)
 S X0=^XTV(8992,XQAUSER,0)
"RTN","XQALSURO",64,0)
 I $P(X0,U,2)>0,$P(X0,U,3)'>$$NOW^XLFDT() D REMVSURO(XQAUSER) ; If we are activaing a new surrogate, if one exists simply remove.
"RTN","XQALSURO",65,0)
 K XQALFM S XQALFM(8992,XQAUSER_",",.03)=XQALSTRT
"RTN","XQALSURO",66,0)
 S XQALFM(8992,XQAUSER_",",.02)=XQALSURO
"RTN","XQALSURO",67,0)
 S XQALFM(8992,XQAUSER_",",.04)=$S($G(XQALEND)>0:XQALEND,1:"@")
"RTN","XQALSURO",68,0)
 D FILE^DIE("","XQALFM")
"RTN","XQALSURO",69,0)
 Q
"RTN","XQALSURO",70,0)
 ;
"RTN","XQALSURO",71,0)
 ; usage $$SETSURO1(XQAUSER,XQALSURO,XQALSTRT,XQALEND)  returns 0 if invalid, otherwise > 0
"RTN","XQALSURO",72,0)
SETSURO1(XQAUSER,XQALSURO,XQALSTRT,XQALEND) ; SR. This should be used instead of SETSURO
"RTN","XQALSURO",73,0)
 I $G(XQALSTRT)'>0 S XQALSTRT=$$NOW^XLFDT()
"RTN","XQALSURO",74,0)
 N XQAVAL
"RTN","XQALSURO",75,0)
 S XQAVAL=$$CYCLIC(XQALSURO,XQAUSER,XQALSTRT,$G(XQALEND)) I XQAVAL'>0 Q XQAVAL ; Can't use as surrogate
"RTN","XQALSURO",76,0)
 D SETSURO(XQAUSER,XQALSURO,XQALSTRT,$G(XQALEND))
"RTN","XQALSURO",77,0)
 Q XQALSURO
"RTN","XQALSURO",78,0)
 ;
"RTN","XQALSURO",79,0)
CHKREMV ;
"RTN","XQALSURO",80,0)
 N DIR,XQAI,XQASLIST,XQAVAL,YVAL,Y
"RTN","XQALSURO",81,0)
 ; ZEXCEPT: XQAUSER    (EXTERNAL VALUE)
"RTN","XQALSURO",82,0)
 D SUROLIST^XQALSUR1(XQAUSER,.XQASLIST)
"RTN","XQALSURO",83,0)
 W !,"Current Surrogate(s):",?35,"START DATE",?60,"END DATE"
"RTN","XQALSURO",84,0)
 F XQAI=0:0 S XQAI=$O(XQASLIST(XQAI)) Q:XQAI'>0  W !,XQAI,"  ",$P(XQASLIST(XQAI),U,2),?35,$$FMTE^XLFDT($P(XQASLIST(XQAI),U,3)),?60,$$FMTE^XLFDT($P(XQASLIST(XQAI),U,4))
"RTN","XQALSURO",85,0)
 W ! I XQASLIST'>0 W !,"  No current surrogates",! Q
"RTN","XQALSURO",86,0)
 S DIR(0)="Y",DIR("A")="Do you want to REMOVE "_$S(XQASLIST>1:"a",1:"THIS")_" surrogate recipient",DIR("?")="A surrogate will receive your alerts until they are removed as surrogate." D ^DIR K DIR Q:Y'>0
"RTN","XQALSURO",87,0)
 S Y=1 I XQASLIST>1 S DIR(0)="L^1:"_XQASLIST,DIR("A")="Enter a list (comma separated, e.g., 1,2) of the surrogate(s) to remove" D ^DIR K DIR
"RTN","XQALSURO",88,0)
 I Y>0 S YVAL=Y F XQAI=1:1 S XQAVAL=+$P(YVAL,",",XQAI) Q:XQAVAL'>0  D REMVSURO(XQAUSER,$P(XQASLIST(XQAVAL),U),$P(XQASLIST(XQAVAL),U,3))
"RTN","XQALSURO",89,0)
 Q
"RTN","XQALSURO",90,0)
 ;
"RTN","XQALSURO",91,0)
 ; P366 - added OPTIONAL second and third arguments to permit deletion of a specific pending surrogate and start date
"RTN","XQALSURO",92,0)
REMVSURO(XQAUSER,XQALSURO,XQALSTRT) ; SR - ends the currently active surrogate relationship
"RTN","XQALSURO",93,0)
 I $G(XQAUSER)'>0 Q
"RTN","XQALSURO",94,0)
 D REMVSURO^XQALSUR1(XQAUSER,$G(XQALSURO),$G(XQALSTRT))
"RTN","XQALSURO",95,0)
 Q
"RTN","XQALSURO",96,0)
 ;
"RTN","XQALSURO",97,0)
 ; P366 - added OPTIONAL second and third arguments to determine surrogate for specified time range
"RTN","XQALSURO",98,0)
CURRSURO(XQAUSER,XQASTRT,XQAEND) ;SR. - returns current surrogate for user or -1  usage $$CURRSURO^XQALSURO(DUZ)
"RTN","XQALSURO",99,0)
 N X,ACTIVE,XQANOW,XQASTR1,XQAIVAL,XQA0,XQAI
"RTN","XQALSURO",100,0)
 D CHEKSUBS^XQALSUR2(XQAUSER)
"RTN","XQALSURO",101,0)
 I $G(XQASTRT)>0 Q $$DATESURO^XQALSUR1(XQAUSER,XQASTRT,$G(XQAEND)) ; P366 - check for current in specified date/times
"RTN","XQALSURO",102,0)
 ;
"RTN","XQALSURO",103,0)
 ; P366 - find the latest start time which is now or past or the first one in the future
"RTN","XQALSURO",104,0)
 S XQANOW=$$NOW^XLFDT()
"RTN","XQALSURO",105,0)
 ;I $P($G(^XTV(8992,XQAUSER,0)),U,2)'>0 D
"RTN","XQALSURO",106,0)
 D
"RTN","XQALSURO",107,0)
 . S XQAIVAL=0,XQASTR1=0
"RTN","XQALSURO",108,0)
 . F XQASTRT=0:0 S XQASTRT=$O(^XTV(8992,XQAUSER,2,"B",XQASTRT)) Q:XQASTRT'>0  Q:XQASTRT'<XQANOW  S XQASTR1=XQASTRT F XQAI=0:0 S XQAI=$O(^XTV(8992,XQAUSER,2,"B",XQASTRT,XQAI)) Q:XQAI'>0  D
"RTN","XQALSURO",109,0)
 . . S XQAEND=$P(^XTV(8992,XQAUSER,2,XQAI,0),U,3) I (XQAEND="")!(XQAEND>XQANOW) S XQAIVAL=XQAI
"RTN","XQALSURO",110,0)
 . . Q
"RTN","XQALSURO",111,0)
 . ; to be compatible with the past, if there is not a current surrogate, show the next scheduled on the zero node if there is one
"RTN","XQALSURO",112,0)
 . I XQAIVAL=0 S XQASTRT=$O(^XTV(8992,XQAUSER,2,"B",XQASTR1)) Q:XQASTRT=""  F XQAI=0:0 S XQAI=$O(^XTV(8992,XQAUSER,2,"B",XQASTRT,XQAI)) Q:XQAI'>0  D  Q:XQAIVAL>0
"RTN","XQALSURO",113,0)
 . . S XQAEND=$P(^XTV(8992,XQAUSER,2,XQAI,0),U,3) I (XQAEND="")!(XQAEND>XQANOW) S XQAIVAL=XQAI
"RTN","XQALSURO",114,0)
 . . Q
"RTN","XQALSURO",115,0)
 . I XQAIVAL>0 S XQA0=^XTV(8992,XQAUSER,2,XQAIVAL,0),XQASTRT=^XTV(8992,XQAUSER,0) I ($P(XQA0,U,2)'=$P(XQASTRT,U,2))!($P(XQA0,U)'=$P(XQASTRT,U,3))!(+$P(XQA0,U,3)'=+$P(XQASTRT,U,4)) D ACTIVATE(XQAUSER,XQAIVAL)
"RTN","XQALSURO",116,0)
 . Q
"RTN","XQALSURO",117,0)
 ; P366 - end
"RTN","XQALSURO",118,0)
 S X=$G(^XTV(8992,XQAUSER,0))
"RTN","XQALSURO",119,0)
 ; now check for a CURRENT surrogate, already started and not expired or cyclic
"RTN","XQALSURO",120,0)
 I $P(X,U,2)>0,+$P(X,U,3)'>XQANOW D  I $P($G(^XTV(8992,XQAUSER,0)),U,2)>0 Q +$P(^XTV(8992,XQAUSER,0),U,2)
"RTN","XQALSURO",121,0)
 . N DATE ;   Get Current date/time to check date/times if present
"RTN","XQALSURO",122,0)
 . ;  Current Date/time past End date for surrogate or cyclic relationship remove checks for new surrogate
"RTN","XQALSURO",123,0)
 . S DATE=$P(X,U,4) I (DATE>0&(DATE<XQANOW))!('$$CYCLIC($P(X,U,2),XQAUSER)) D REMVSURO(XQAUSER)
"RTN","XQALSURO",124,0)
 . Q
"RTN","XQALSURO",125,0)
 Q -1
"RTN","XQALSURO",126,0)
 ;
"RTN","XQALSURO",127,0)
ACTVSURO(XQAUSER) ;SR. - returns the actual surrogate at this time
"RTN","XQALSURO",128,0)
 N CURRSURO,NEXTSURO,SURODATA,NOW
"RTN","XQALSURO",129,0)
 S NOW=$$NOW^XLFDT()
"RTN","XQALSURO",130,0)
 S CURRSURO=$$CURRSURO(XQAUSER),SURODATA=$$GETSURO(XQAUSER) I (CURRSURO'>0)!(+$P(SURODATA,U,3)>NOW)!('(+$$ACTIVE^XUSER(CURRSURO))) Q -1
"RTN","XQALSURO",131,0)
 F  S NEXTSURO=$$CURRSURO(CURRSURO),SURODATA=$$GETSURO(CURRSURO) Q:NEXTSURO'>0  Q:+$P(SURODATA,U,3)>NOW  Q:'(+$$ACTIVE^XUSER(NEXTSURO))  S CURRSURO=NEXTSURO
"RTN","XQALSURO",132,0)
 Q CURRSURO
"RTN","XQALSURO",133,0)
 ;
"RTN","XQALSURO",134,0)
GETSURO(XQAUSER) ;SR. - returns data for surrogate for user including times
"RTN","XQALSURO",135,0)
 I $$CURRSURO(XQAUSER)'>0 Q ""
"RTN","XQALSURO",136,0)
 N GLOBREF,IENS,X
"RTN","XQALSURO",137,0)
 S IENS=XQAUSER_",",GLOBREF=$NA(^TMP($J,"XQALSURO")) K @GLOBREF
"RTN","XQALSURO",138,0)
 D GETS^DIQ(8992,IENS,".02;.03;.04","IE",GLOBREF)
"RTN","XQALSURO",139,0)
 S GLOBREF=$NA(@GLOBREF@(8992,IENS))
"RTN","XQALSURO",140,0)
 S X=$G(@GLOBREF@(.02,"I"))_U_$G(@GLOBREF@(.02,"E"))_U_$G(@GLOBREF@(.03,"I"))_U_$G(@GLOBREF@(.04,"I"))
"RTN","XQALSURO",141,0)
 K @GLOBREF
"RTN","XQALSURO",142,0)
 Q X
"RTN","XQALSURO",143,0)
 ;
"RTN","XQALSURO",144,0)
GETFOR ;OPT.
"RTN","XQALSURO",145,0)
 N XQAUSER,VALUES,XQACNT,DIR,DIRUT,I,Y
"RTN","XQALSURO",146,0)
 S DIR(0)="PD^200:AEMQ",DIR("A",1)="View Users who have selected a specified User as their Surrogate."
"RTN","XQALSURO",147,0)
 S DIR("A")="Select User (NEW PERSON entry)"
"RTN","XQALSURO",148,0)
 D ^DIR K DIR Q:Y'>0  W "  ",$P(Y,U,2)
"RTN","XQALSURO",149,0)
 S XQAUSER=+Y
"RTN","XQALSURO",150,0)
 D SUROFOR(.VALUES,XQAUSER) I VALUES'>0 W !,"No entries found.",!! Q
"RTN","XQALSURO",151,0)
 S XQACNT=0 K DIRUT F I=0:0 S I=$O(VALUES(I)) Q:I'>0  D:(XQACNT>(IOSL-4))  Q:$D(DIRUT)  W !,?5,$P(VALUES(I),U,2) S XQACNT=XQACNT+1
"RTN","XQALSURO",152,0)
 . S DIR(0)="E" D ^DIR K DIR
"RTN","XQALSURO",153,0)
 . Q
"RTN","XQALSURO",154,0)
 K DIRUT
"RTN","XQALSURO",155,0)
 Q
"RTN","XQALSURO",156,0)
 ;
"RTN","XQALSURO",157,0)
SUROLIST(XQAUSER,XQALIST) ; SR. returns list of current and scheduled surrogates for XQAUSER
"RTN","XQALSURO",158,0)
 D SUROLIST^XQALSUR1(XQAUSER,.XQALIST)
"RTN","XQALSURO",159,0)
 Q
"RTN","XQALSURO",160,0)
 ;
"RTN","XQALSURO",161,0)
SUROFOR(LIST,XQAUSER) ;SR. - returns list of users XQAUSER is acting as a surrogate for
"RTN","XQALSURO",162,0)
 I $G(XQAUSER)="" Q
"RTN","XQALSURO",163,0)
 N I,COUNT S I=0,COUNT=0 F  S I=$O(^XTV(8992,"AC",XQAUSER,I)) Q:I'>0  I $$CURRSURO(I)>0 D
"RTN","XQALSURO",164,0)
 . S COUNT=COUNT+1,LIST(COUNT)=I_U_$$GET1^DIQ(200,(I_","),".01","E")_U_$$GET1^DIQ(8992,(I_","),".03","E")_U_$$GET1^DIQ(8992,(I_","),".04","E")
"RTN","XQALSURO",165,0)
 S LIST=COUNT
"RTN","XQALSURO",166,0)
 Q
"RTN","XQALSURO",167,0)
 ;
"RTN","XQALSURO",168,0)
SENDMESG ;
"RTN","XQALSURO",169,0)
 N XMY,XMDUZ,XMCHAN
"RTN","XQALSURO",170,0)
 ; ZEXCEPT: XQALSURO   (EXTERNAL VALUE)
"RTN","XQALSURO",171,0)
 S XMY(XQALSURO)="",XMDUZ=.5
"RTN","XQALSURO",172,0)
 D ^XMD
"RTN","XQALSURO",173,0)
 Q
"SEC","^DIC",8992,8992,0,"AUDIT")
@
"SEC","^DIC",8992,8992,0,"DD")
@
"SEC","^DIC",8992,8992,0,"DEL")
@
"SEC","^DIC",8992,8992,0,"LAYGO")
@
"SEC","^DIC",8992,8992,0,"RD")
@
"SEC","^DIC",8992,8992,0,"WR")
@
"SEC","^DIC",8992.1,8992.1,0,"AUDIT")
@
"SEC","^DIC",8992.1,8992.1,0,"DD")
@
"SEC","^DIC",8992.1,8992.1,0,"DEL")
@
"SEC","^DIC",8992.1,8992.1,0,"LAYGO")
@
"SEC","^DIC",8992.1,8992.1,0,"RD")
@
"SEC","^DIC",8992.1,8992.1,0,"WR")
@
"VER")
8.0^22.0
"^DD",8992,8992,0)
FIELD^^2^6
"^DD",8992,8992,0,"DT")
3050316
"^DD",8992,8992,0,"IX","AC",8992,.02)

"^DD",8992,8992,0,"IX","AXQA",8992.01,.02)

"^DD",8992,8992,0,"IX","AXQAN",8992.01,.02)

"^DD",8992,8992,0,"IX","B",8992,.01)

"^DD",8992,8992,0,"NM","ALERT")

"^DD",8992,8992,0,"VRPK")
XU
"^DD",8992,8992,.01,0)
RECIPIENT^RP200'XI^VA(200,^0;1^S DINUM=X
"^DD",8992,8992,.01,1,0)
^.1
"^DD",8992,8992,.01,1,1,0)
8992^B
"^DD",8992,8992,.01,1,1,1)
S ^XTV(8992,"B",$E(X,1,30),DA)=""
"^DD",8992,8992,.01,1,1,2)
K ^XTV(8992,"B",$E(X,1,30),DA)
"^DD",8992,8992,.01,3)
This is the individual who is to receive the alert
"^DD",8992,8992,.01,"DT")
2941215
"^DD",8992,8992,.02,0)
SURROGATE FOR ALERTS^P200'^VA(200,^0;2^Q
"^DD",8992,8992,.02,1,0)
^.1
"^DD",8992,8992,.02,1,1,0)
8992^AC
"^DD",8992,8992,.02,1,1,1)
S ^XTV(8992,"AC",$E(X,1,30),DA)=""
"^DD",8992,8992,.02,1,1,2)
K ^XTV(8992,"AC",$E(X,1,30),DA)
"^DD",8992,8992,.02,1,1,3)
TRACKS WHO A USER IS ACTING AS SURROGATES FOR
"^DD",8992,8992,.02,1,1,"%D",0)
^^2^2^3010702^
"^DD",8992,8992,.02,1,1,"%D",1,0)
This cross-reference is used to be able to rapidly determine which users
"^DD",8992,8992,.02,1,1,"%D",2,0)
a specified user is acting as surrogate for.
"^DD",8992,8992,.02,1,1,"DT")
3010702
"^DD",8992,8992,.02,3)
Enter an individual name who will be designated to receive alerts for this user until the specified end date/time or until this surrogate is removed.
"^DD",8992,8992,.02,21,0)
^.001^9^9^3020409^^
"^DD",8992,8992,.02,21,1,0)
This field may contain a pointer to the NEW PERSON file who has been
"^DD",8992,8992,.02,21,2,0)
designated as a SURROGATE recipient.  That individual will receive alerts
"^DD",8992,8992,.02,21,3,0)
designated for the current user during the period of time specified by the
"^DD",8992,8992,.02,21,4,0)
entries in SURROGATE START DATE/TIME field [#.03] and the SURROGATE END
"^DD",8992,8992,.02,21,5,0)
DATE/TIME field [#.04] or, if one or both of those fields is not
"^DD",8992,8992,.02,21,6,0)
specified, until the SURROGATE entry is removed.  If the SURROGATE END
"^DD",8992,8992,.02,21,7,0)
DATE/TIME field [#.04] is populated, the SURROGATE data will be removed
"^DD",8992,8992,.02,21,8,0)
automatically the first time an alert is sent to the current USER after
"^DD",8992,8992,.02,21,9,0)
the specified date and time.
"^DD",8992,8992,.02,"DT")
3010702
"^DD",8992,8992,.03,0)
SURROGATE START DATE/TIME^D^^0;3^S %DT="ETX" D ^%DT S X=Y K:Y<1 X
"^DD",8992,8992,.03,3)
Enter the earliest date and time that the SURROGATE should start receiving alerts.  If no date/time is entered, the sending of alerts to the SURROGATE will begin immediately.
"^DD",8992,8992,.03,21,0)
^^4^4^2990127^
"^DD",8992,8992,.03,21,1,0)
This field may contain a date and time which will specify when forwarding
"^DD",8992,8992,.03,21,2,0)
of alerts to the SURROGATE specified in field #.02 will begin.  If there
"^DD",8992,8992,.03,21,3,0)
is no entry in this field, and field #.02 is populated, alerts will be
"^DD",8992,8992,.03,21,4,0)
sent to the surrogate immediately.
"^DD",8992,8992,.03,"DT")
2990127
"^DD",8992,8992,.04,0)
SURROGATE END DATE/TIME^D^^0;4^S %DT="ETX" D ^%DT S X=Y K:Y<1 X
"^DD",8992,8992,.04,3)
Enter the date and time when alerts should no longer be sent to the SURROGATE.  If no date and time is entered, then the alerts will be sent to the SURROGATE until the SURROGATE entry is removed.
"^DD",8992,8992,.04,21,0)
^^5^5^2990127^
"^DD",8992,8992,.04,21,1,0)
This field may contain a date and time.  If data is present, it indicates
"^DD",8992,8992,.04,21,2,0)
the time at which sending of alerts to the individual specified in the
"^DD",8992,8992,.04,21,3,0)
SURROGATE field (#.02) should be terminated.  If no data is present, and
"^DD",8992,8992,.04,21,4,0)
the SURROGATE field is populated, then alerts will be sent to the
"^DD",8992,8992,.04,21,5,0)
SURROGATE until that entry is removed.
"^DD",8992,8992,.04,"DT")
2990127
"^DD",8992,8992,1,0)
ALERT DATE/TIME^8992.01DA^^XQA;0
"^DD",8992,8992,2,0)
SURROGATE^8992.02D^^2;0
"^DD",8992,8992,2,21,0)
^^7^7^3041112^
"^DD",8992,8992,2,21,1,0)
This field is a multiple based on the start date/time for a surrogate
"^DD",8992,8992,2,21,2,0)
relationship.  This will permit multiple surrogate relationships to be 
"^DD",8992,8992,2,21,3,0)
scheduled.
"^DD",8992,8992,2,21,4,0)
 
"^DD",8992,8992,2,21,5,0)
Since a start date/time for the surrogate relationship is required, if 
"^DD",8992,8992,2,21,6,0)
the user does not enter one, then the NOW as the current date/time will 
"^DD",8992,8992,2,21,7,0)
be used.
"^DD",8992,8992.01,0)
ALERT DATE/TIME SUB-FIELD^^4^18
"^DD",8992,8992.01,0,"DT")
3011012
"^DD",8992,8992.01,0,"IX","B",8992.01,.01)

"^DD",8992,8992.01,0,"NM","ALERT DATE/TIME")

"^DD",8992,8992.01,0,"UP")
8992
"^DD",8992,8992.01,.01,0)
ALERT DATE/TIME^MDI^^0;1^S %DT="ESTXR" D ^%DT S X=Y K:Y<1 X
"^DD",8992,8992.01,.01,1,0)
^.1
"^DD",8992,8992.01,.01,1,1,0)
8992.01^B^MUMPS
"^DD",8992,8992.01,.01,1,1,1)
Q
"^DD",8992,8992.01,.01,1,1,2)
Q
"^DD",8992,8992.01,.01,1,1,3)
This cross-reference will prevent a 'B' cross-reference from being built.
"^DD",8992,8992.01,.01,1,1,"DT")
2941214
"^DD",8992,8992.01,.01,3)
This is the date and time that the alert was generated.
"^DD",8992,8992.01,.01,21,0)
^^1^1^2930402^
"^DD",8992,8992.01,.01,21,1,0)
This is the date and time when the alert was generated.
"^DD",8992,8992.01,.01,"DT")
2941215
"^DD",8992,8992.01,.02,0)
ALERT ID^FI^^0;2^K:$L(X)>50!($L(X)<2) X
"^DD",8992,8992.01,.02,1,0)
^.1
"^DD",8992,8992.01,.02,1,1,0)
8992^AXQA^MUMPS
"^DD",8992,8992.01,.02,1,1,1)
S ^XTV(8992,"AXQA",X,DA(1),DA)=""
"^DD",8992,8992.01,.02,1,1,2)
K ^XTV(8992,"AXQA",X,DA(1),DA)
"^DD",8992,8992.01,.02,1,1,"%D",0)
^^5^5^2991001^^^^
"^DD",8992,8992.01,.02,1,1,"%D",1,0)
 
"^DD",8992,8992.01,.02,1,1,"%D",2,0)
This is a cross-reference on the complete XQAID value for this alert,
"^DD",8992,8992.01,.02,1,1,"%D",3,0)
which can be used to identify those individuals who received this particular
"^DD",8992,8992.01,.02,1,1,"%D",4,0)
instance of the alert, and could be used to delete other entries which
"^DD",8992,8992.01,.02,1,1,"%D",5,0)
had received the alert.
"^DD",8992,8992.01,.02,1,1,"DT")
2991001
"^DD",8992,8992.01,.02,1,2,0)
8992^AXQAN^MUMPS
"^DD",8992,8992.01,.02,1,2,1)
S ^XTV(8992,"AXQAN",$P(X,";"),DA(1),DA)=""
"^DD",8992,8992.01,.02,1,2,2)
K ^XTV(8992,"AXQAN",$P(X,";"),DA(1),DA)
"^DD",8992,8992.01,.02,1,2,"%D",0)
^^6^6^2991001^^^^
"^DD",8992,8992.01,.02,1,2,"%D",1,0)
 
"^DD",8992,8992.01,.02,1,2,"%D",2,0)
This cross-reference may be used to identify those users who received the
"^DD",8992,8992.01,.02,1,2,"%D",3,0)
alert with the application package specified XQAID (the first ";"-piece
"^DD",8992,8992.01,.02,1,2,"%D",4,0)
of the complete XQAID value) for those cases in which the full XQAID value
"^DD",8992,8992.01,.02,1,2,"%D",5,0)
may not be known, e.g., an application which was selected by the user
"^DD",8992,8992.01,.02,1,2,"%D",6,0)
without selecting the ALERT ACTION option to process the alert.
"^DD",8992,8992.01,.02,1,2,"DT")
2991001
"^DD",8992,8992.01,.02,3)
This is the package identification used to identify this particular alert.  Answer must be 2-50 characters in length.
"^DD",8992,8992.01,.02,21,0)
^^4^4^2930402^
"^DD",8992,8992.01,.02,21,1,0)
This is a field in which the package id passed during alert filing.  This
"^DD",8992,8992.01,.02,21,2,0)
id may simply be a package namespace, or it may be a namespace followed by
"^DD",8992,8992.01,.02,21,3,0)
additional data to more accurately identify the type or purpose of the
"^DD",8992,8992.01,.02,21,4,0)
alert.
"^DD",8992,8992.01,.02,"DT")
2991110
"^DD",8992,8992.01,.03,0)
MESSAGE TEXT^FI^^0;3^K:$L(X)>60!($L(X)<3) X
"^DD",8992,8992.01,.03,3)
This is the text which will be displayed to the user at the time the alert is first shown and when the user selects the alert.nswer must be 3-60 characters in length.
"^DD",8992,8992.01,.03,21,0)
^^4^4^2930402^
"^DD",8992,8992.01,.03,21,1,0)
This field contains the text of the message to be presented to the user at
"^DD",8992,8992.01,.03,21,2,0)
the time when he cycles through the menu system the first time after the
"^DD",8992,8992.01,.03,21,3,0)
alert has been filed for the user, and when the user selects the VIEW
"^DD",8992,8992.01,.03,21,4,0)
ALERTS option.
"^DD",8992,8992.01,.03,"DT")
2941215
"^DD",8992,8992.01,.04,0)
NEW ALERT FLAG^SI^1:NEW;^0;4^Q
"^DD",8992,8992.01,.04,3)
This flag is set when the alert has not been displayed to the user previously.
"^DD",8992,8992.01,.04,21,0)
^^4^4^2930402^
"^DD",8992,8992.01,.04,21,1,0)
This flag is used by the alert processing to indicate a new alert which
"^DD",8992,8992.01,.04,21,2,0)
has not previously been presented to the user.  After the alert message
"^DD",8992,8992.01,.04,21,3,0)
text has been shown to the user, this flag is cleared and the user must
"^DD",8992,8992.01,.04,21,4,0)
then select the VIEW ALERTS option to process the alert.
"^DD",8992,8992.01,.04,"DT")
2941215
"^DD",8992,8992.01,.05,0)
ACTION FLAG^SI^D:DELETE;R:RUN ROUTINE;I:IMMEDIATE RUN;^0;5^Q
"^DD",8992,8992.01,.05,3)
This flag indicates how the alert should be processed.
"^DD",8992,8992.01,.05,21,0)
^^3^3^2930402^
"^DD",8992,8992.01,.05,21,1,0)
This flag is optional at the present time, since the need for action
"^DD",8992,8992.01,.05,21,2,0)
processing can be determined by the presence of an option name or a
"^DD",8992,8992.01,.05,21,3,0)
routine name for use during alert processing.
"^DD",8992,8992.01,.05,"DT")
2941215
"^DD",8992,8992.01,.06,0)
RESERVED1^FI^^0;6^K:$L(X)>60!($L(X)<1) X
"^DD",8992,8992.01,.06,3)
This is a reserved field for future use.
"^DD",8992,8992.01,.06,21,0)
^^1^1^2930402^
"^DD",8992,8992.01,.06,21,1,0)
This field is reserved for future use by the alert system.
"^DD",8992,8992.01,.06,"DT")
2941215
"^DD",8992,8992.01,.07,0)
ENTRY POINT^FI^^0;7^K:$L(X)>8!($L(X)<1)!'(X?.UN) X
"^DD",8992,8992.01,.07,3)
This is the tag or entry point into the routine if one is used (it may also hold the name of an option).  Answer must be 1-8 characters in length.
"^DD",8992,8992.01,.07,21,0)
^^6^6^2930402^
"^DD",8992,8992.01,.07,21,1,0)
While named ENTRY POINT, this is a dual function field.  If the next field
"^DD",8992,8992.01,.07,21,2,0)
(#.08, AROUTINE NAME) contains a routine name, this field contains the
"^DD",8992,8992.01,.07,21,3,0)
desired entry point within that routine (this field may also be null,
"^DD",8992,8992.01,.07,21,4,0)
indicating that the entry point should be at the top of the routine).  If
"^DD",8992,8992.01,.07,21,5,0)
field #.08 is null, then the contents of this field is interpreted as the
"^DD",8992,8992.01,.07,21,6,0)
name of an option which is to be entered when the alert is processed.
"^DD",8992,8992.01,.07,"DT")
2941215
"^DD",8992,8992.01,.08,0)
AROUTINE NAME^FI^^0;8^K:$L(X)>8!($L(X)<2)!'(X?1U.UN) X
"^DD",8992,8992.01,.08,3)
This is the routine name to be called when the alert is selected for processing.  Answer must be 2-8 characters in length.
"^DD",8992,8992.01,.08,21,0)
^^10^10^2930402^
"^DD",8992,8992.01,.08,21,1,0)
If this field is not null, it contains the name of a routine which is to
"^DD",8992,8992.01,.08,21,2,0)
be used when the alert is processed.  If there is also a value in field
"^DD",8992,8992.01,.08,21,3,0)
#.07, that value is used as an entry point into the routine specified in
"^DD",8992,8992.01,.08,21,4,0)
this field.
"^DD",8992,8992.01,.08,21,5,0)
 
"^DD",8992,8992.01,.08,21,6,0)
If this field is null, field #.07 is interpreted as an option name which
"^DD",8992,8992.01,.08,21,7,0)
is to be used when the alert is processed.
"^DD",8992,8992.01,.08,21,8,0)
 
"^DD",8992,8992.01,.08,21,9,0)
If both this field and field #.07 are null, the alert is processed as an
"^DD",8992,8992.01,.08,21,10,0)
information only alert.
"^DD",8992,8992.01,.08,"DT")
2941215
"^DD",8992,8992.01,.09,0)
RESERVED^FI^^0;9^K:$L(X)>30!($L(X)<2) X
"^DD",8992,8992.01,.09,3)
Answer must be 2-30 characters in length.
"^DD",8992,8992.01,.09,21,0)
^^1^1^2930402^
"^DD",8992,8992.01,.09,21,1,0)
This field is reserved for future use in the alert processing system.
"^DD",8992,8992.01,.09,"DT")
2941215
"^DD",8992,8992.01,.1,0)
CAN DELETE WITHOUT PROCESSING^S^1:YES;^0;10^Q
"^DD",8992,8992.01,.1,3)
A value in this field indicates that the alert may be deleted by the user without having processed it.
"^DD",8992,8992.01,.1,21,0)
^^7^7^2990202^
"^DD",8992,8992.01,.1,21,1,0)
This field was added as a flag to identify alerts which the packages
"^DD",8992,8992.01,.1,21,2,0)
indicate may be deleted by the user without processing the alert.  The
"^DD",8992,8992.01,.1,21,3,0)
value is optional and is passed by the package which generates the alert
"^DD",8992,8992.01,.1,21,4,0)
if they want to give permission for users to be able to delete the alert.
"^DD",8992,8992.01,.1,21,5,0)
The flag is checked in the code handling user deletion of alerts.  If an
"^DD",8992,8992.01,.1,21,6,0)
alert involves an action (via an option or routine) it may not be deleted
"^DD",8992,8992.01,.1,21,7,0)
by the user unless this flag is set.
"^DD",8992,8992.01,.1,"DT")
2990202
"^DD",8992,8992.01,.13,0)
DAYS FOR SURROGATE^NJ2,0I^^0;13^K:+X'=X!(X>30)!(X<1)!(X?.E1"."1N.N) X
"^DD",8992,8992.01,.13,3)
This is the number of days before the alert is forwarded to the recipient's surrogate(s).
"^DD",8992,8992.01,.13,"DT")
2941215
"^DD",8992,8992.01,.14,0)
DAYS FOR SUPERVISOR^NJ2,0I^^0;14^K:+X'=X!(X>30)!(X<1)!(X?.E1"."1N.N) X
"^DD",8992,8992.01,.14,3)
This is the number of days (1 to 30) to pass before the alert is forwarded to the recipient's supervisor.
"^DD",8992,8992.01,.14,"DT")
2941215
"^DD",8992,8992.01,.15,0)
DAYS FOR BACKUP REVIEWER^NJ2,0^^0;15^K:+X'=X!(X>15)!(X<1)!(X?.E1"."1.N) X
"^DD",8992,8992.01,.15,3)
Enter a number of days (1 to 15) if the alert has not been processed it will be forwarded to the designated BACKUP REVIEWER in the KERNEL SYSTEM PARAMETERS file.
"^DD",8992,8992.01,.15,21,0)
^^11^11^3010703^
"^DD",8992,8992.01,.15,21,1,0)
The 'DAYS FOR BACKUP REVIEWER' field contains a number of days, which if
"^DD",8992,8992.01,.15,21,2,0)
exceeded without the alert being processed will cause the alert to be
"^DD",8992,8992.01,.15,21,3,0)
forwarded to the designated 'XQAL BACKUP REVIEWER' in the PARAMETER file
"^DD",8992,8992.01,.15,21,4,0)
with a comment indicating that the alert had not been reviewed by the
"^DD",8992,8992.01,.15,21,5,0)
original recipient.
"^DD",8992,8992.01,.15,21,6,0)
 
"^DD",8992,8992.01,.15,21,7,0)
This forwarding option is in addition to the SUPERVISOR (based on entries
"^DD",8992,8992.01,.15,21,8,0)
for CHIEF in the SECTION/SERVICE file) or e-mail surrogates, and was
"^DD",8992,8992.01,.15,21,9,0)
requested by sites to be able to forward unprocessed alerts to a known,
"^DD",8992,8992.01,.15,21,10,0)
interested individual.  This could be someone in Quality Assurance or a
"^DD",8992,8992.01,.15,21,11,0)
specific nurse responsible for handling overdue unprocessed alerts.
"^DD",8992,8992.01,.15,"DT")
3010703
"^DD",8992,8992.01,1,0)
DATA FOR ALERT^FI^^1;E1,245^K:$L(X)>245!($L(X)<2) X
"^DD",8992,8992.01,1,3)
This character sequence will be returned to the application when the alert is selected.  Answer must be 2-245 characters in length.
"^DD",8992,8992.01,1,21,0)
^^9^9^2930402^
"^DD",8992,8992.01,1,21,1,0)
This field and all following ^-separated fields are processed as a single
"^DD",8992,8992.01,1,21,2,0)
entity and are returned in the variable XQADATA for use by the application
"^DD",8992,8992.01,1,21,3,0)
which generated the alert.  The package may pass a series of variables
"^DD",8992,8992.01,1,21,4,0)
using any desired separator in the variable XQADATA at the time the alert
"^DD",8992,8992.01,1,21,5,0)
is setup.  When the alert is processed the value of XQADATA is returned to
"^DD",8992,8992.01,1,21,6,0)
the application and may be used to establish parameters related to the
"^DD",8992,8992.01,1,21,7,0)
alert without requiring interaction or provision of information by the
"^DD",8992,8992.01,1,21,8,0)
user.  In this way information related to patient entry number, specific
"^DD",8992,8992.01,1,21,9,0)
internal numbers for the desired data, etc may be stored and returned.
"^DD",8992,8992.01,1,"DT")
2941215
"^DD",8992,8992.01,2.01,0)
COMMENT FOR DISPLAY^FI^^2;1^K:$L(X)>245!($L(X)<2) X
"^DD",8992,8992.01,2.01,3)
This field is entered during forwarding of an alert to a new recipient.
"^DD",8992,8992.01,2.01,"DT")
2941215
"^DD",8992,8992.01,3.01,0)
GUID FOR GUI^F^^3;1^K:$L(X)>38!($L(X)<38) X
"^DD",8992,8992.01,3.01,3)
Answer must be a GUID - 38 characters in length
"^DD",8992,8992.01,3.01,21,0)
^^8^8^3000126^
"^DD",8992,8992.01,3.01,21,1,0)
This field contains a Globally Unique IDentifier (GUID) which is used to
"^DD",8992,8992.01,3.01,21,2,0)
identify the application which should be used in a graphical user
"^DD",8992,8992.01,3.01,21,3,0)
interface environment (windows) to process the alert.  This application
"^DD",8992,8992.01,3.01,21,4,0)
must implement the IVAlert interface.  The GUID should be of the form
"^DD",8992,8992.01,3.01,21,5,0)
 
"^DD",8992,8992.01,3.01,21,6,0)
  {xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx}
"^DD",8992,8992.01,3.01,21,7,0)
 
"^DD",8992,8992.01,3.01,21,8,0)
where each x is a hexadecimal digit (0 through 9 or A through F).
"^DD",8992,8992.01,3.01,"DT")
3000126
"^DD",8992,8992.01,3.02,0)
PATIENT^P2'^DPT(^3;2^Q
"^DD",8992,8992.01,3.02,3)
If this is a PATIENT-related alert, this field identifies the PATIENT associated with the alert.
"^DD",8992,8992.01,3.02,21,0)
^^2^2^3011012^
"^DD",8992,8992.01,3.02,21,1,0)
This field is a pointer value to the PATIENT file, if the alert is
"^DD",8992,8992.01,3.02,21,2,0)
patient related.  It is not a required field for non-patient related alerts.
"^DD",8992,8992.01,3.02,"DT")
3011012
"^DD",8992,8992.01,4,0)
LONG INFO TEXT^8992.04^^4;0
"^DD",8992,8992.02,0)
SURROGATE SUB-FIELD^^.04^4
"^DD",8992,8992.02,0,"DT")
3050316
"^DD",8992,8992.02,0,"IX","AC",8992.02,.04)

"^DD",8992,8992.02,0,"IX","B",8992.02,.01)

"^DD",8992,8992.02,0,"NM","SURROGATE")

"^DD",8992,8992.02,0,"UP")
8992
"^DD",8992,8992.02,.01,0)
SURROGATE START DATE/TIME^MRD^^0;1^S %DT="ESTX" D ^%DT S X=Y K:Y<1 X
"^DD",8992,8992.02,.01,1,0)
^.1
"^DD",8992,8992.02,.01,1,1,0)
8992.02^B
"^DD",8992,8992.02,.01,1,1,1)
S ^XTV(8992,DA(1),2,"B",$E(X,1,30),DA)=""
"^DD",8992,8992.02,.01,1,1,2)
K ^XTV(8992,DA(1),2,"B",$E(X,1,30),DA)
"^DD",8992,8992.02,.01,3)
This is the START DATE/TIME for the surrogate
"^DD",8992,8992.02,.01,21,0)
^^1^1^3041112^
"^DD",8992,8992.02,.01,21,1,0)
This is the starting date and time for a surrogate relationship.
"^DD",8992,8992.02,.01,"DT")
3041112
"^DD",8992,8992.02,.02,0)
SURROGATE USER^RP200'^VA(200,^0;2^Q
"^DD",8992,8992.02,.02,3)
This is the user who will be the surrogate during the time period specified
"^DD",8992,8992.02,.02,21,0)
^^2^2^3041112^
"^DD",8992,8992.02,.02,21,1,0)
This is a pointer to the user in the NEW PERSON file who will be acting 
"^DD",8992,8992.02,.02,21,2,0)
as the surrogate for the time period specified.
"^DD",8992,8992.02,.02,"DT")
3041112
"^DD",8992,8992.02,.03,0)
END DATE TIME^D^^0;3^S %DT="ESTX" D ^%DT S X=Y K:Y<1 X
"^DD",8992,8992.02,.03,3)
This is an optional date/time for when the surrogate relationship will be terminated.
"^DD",8992,8992.02,.03,21,0)
^^3^3^3041112^
"^DD",8992,8992.02,.03,21,1,0)
This is an optional date/time for when the surrogate relationship will be 
"^DD",8992,8992.02,.03,21,2,0)
terminated.  If there is no value entered, then the relationship will 
"^DD",8992,8992.02,.03,21,3,0)
continue until it is specifically terminated.
"^DD",8992,8992.02,.03,"DT")
3041112
"^DD",8992,8992.02,.04,0)
NEEDS RETURN^S^1:YES;0:NO;^0;4^Q
"^DD",8992,8992.02,.04,1,0)
^.1
"^DD",8992,8992.02,.04,1,1,0)
8992.02^AC
"^DD",8992,8992.02,.04,1,1,1)
S ^XTV(8992,DA(1),2,"AC",$E(X,1,30),DA)=""
"^DD",8992,8992.02,.04,1,1,2)
K ^XTV(8992,DA(1),2,"AC",$E(X,1,30),DA)
"^DD",8992,8992.02,.04,1,1,3)
This x-ref is used to track alerts needing return from surrogates
"^DD",8992,8992.02,.04,1,1,"%D",0)
^^2^2^3050316^
"^DD",8992,8992.02,.04,1,1,"%D",1,0)
This cross reference is used to identify periods for which any alerts 
"^DD",8992,8992.02,.04,1,1,"%D",2,0)
forwarded to a surrogate have not been returned to the intended recipient.
"^DD",8992,8992.02,.04,1,1,"DT")
3050316
"^DD",8992,8992.02,.04,3)
This is a flag which is used to determine whether alerts have been returned to the intended recipient or not
"^DD",8992,8992.02,.04,21,0)
^^2^2^3050316^
"^DD",8992,8992.02,.04,21,1,0)
This field is used as a flag to indicate whether the alerts have been 
"^DD",8992,8992.02,.04,21,2,0)
returned to the intended recipient or not.
"^DD",8992,8992.02,.04,"DT")
3050316
"^DD",8992,8992.04,0)
LONG INFO TEXT SUB-FIELD^^.01^1
"^DD",8992,8992.04,0,"DT")
3000126
"^DD",8992,8992.04,0,"NM","LONG INFO TEXT")

"^DD",8992,8992.04,0,"UP")
8992.01
"^DD",8992,8992.04,.01,0)
LONG INFO TEXT^W^^0;1
"^DD",8992,8992.04,.01,3)
This field is used to enter multiple lines of text for a longer INFO only alert
"^DD",8992,8992.04,.01,"DT")
3000126
"^DD",8992.1,8992.1,0)
FIELD^^20^16
"^DD",8992.1,8992.1,0,"DT")
3050316
"^DD",8992.1,8992.1,0,"IX","AUD",8992.111,.04)

"^DD",8992.1,8992.1,0,"IX","B",8992.1,.01)

"^DD",8992.1,8992.1,0,"IX","C",8992.1,.04)

"^DD",8992.1,8992.1,0,"IX","D",8992.1,.02)

"^DD",8992.1,8992.1,0,"IX","PKGID",8992.1,.03)

"^DD",8992.1,8992.1,0,"IX","R",8992.11,.01)

"^DD",8992.1,8992.1,0,"NM","ALERT TRACKING")

"^DD",8992.1,8992.1,0,"VRPK")
XU
"^DD",8992.1,8992.1,.01,0)
NAME^RFI^^0;1^K:$L(X)>50!($L(X)<3)!'(X'?1P.E) X
"^DD",8992.1,8992.1,.01,1,0)
^.1
"^DD",8992.1,8992.1,.01,1,1,0)
8992.1^B
"^DD",8992.1,8992.1,.01,1,1,1)
S ^XTV(8992.1,"B",$E(X,1,50),DA)=""
"^DD",8992.1,8992.1,.01,1,1,2)
K ^XTV(8992.1,"B",$E(X,1,50),DA)
"^DD",8992.1,8992.1,.01,3)
Answer must be 3-50 characters in length.
"^DD",8992.1,8992.1,.01,"DT")
2941215
"^DD",8992.1,8992.1,.02,0)
DATE CREATED^DI^^0;2^S %DT="ESTXR" D ^%DT S X=Y K:Y<1 X
"^DD",8992.1,8992.1,.02,1,0)
^.1
"^DD",8992.1,8992.1,.02,1,1,0)
8992.1^D
"^DD",8992.1,8992.1,.02,1,1,1)
S ^XTV(8992.1,"D",$E(X,1,30),DA)=""
"^DD",8992.1,8992.1,.02,1,1,2)
K ^XTV(8992.1,"D",$E(X,1,30),DA)
"^DD",8992.1,8992.1,.02,1,1,"DT")
2940707
"^DD",8992.1,8992.1,.02,3)
This is the date and time that the alert was created.
"^DD",8992.1,8992.1,.02,"DT")
2941215
"^DD",8992.1,8992.1,.03,0)
PKG ID^FI^^0;3^K:$L(X)>30!($L(X)<1) X
"^DD",8992.1,8992.1,.03,1,0)
^.1
"^DD",8992.1,8992.1,.03,1,1,0)
8992.1^PKGID
"^DD",8992.1,8992.1,.03,1,1,1)
S ^XTV(8992.1,"PKGID",$E(X,1,30),DA)=""
"^DD",8992.1,8992.1,.03,1,1,2)
K ^XTV(8992.1,"PKGID",$E(X,1,30),DA)
"^DD",8992.1,8992.1,.03,1,1,"DT")
2940707
"^DD",8992.1,8992.1,.03,3)
Answer must be 1-30 characters in length
"^DD",8992.1,8992.1,.03,"DT")
2991110
"^DD",8992.1,8992.1,.04,0)
PATIENT^P2'I^DPT(^0;4^Q
"^DD",8992.1,8992.1,.04,1,0)
^.1
"^DD",8992.1,8992.1,.04,1,1,0)
8992.1^C
"^DD",8992.1,8992.1,.04,1,1,1)
S ^XTV(8992.1,"C",$E(X,1,30),DA)=""
"^DD",8992.1,8992.1,.04,1,1,2)
K ^XTV(8992.1,"C",$E(X,1,30),DA)
"^DD",8992.1,8992.1,.04,1,1,"DT")
2940707
"^DD",8992.1,8992.1,.04,3)
This is the patient which is indicated by the alert.
"^DD",8992.1,8992.1,.04,"DT")
2941215
"^DD",8992.1,8992.1,.05,0)
GENERATED BY^P200'I^VA(200,^0;5^Q
"^DD",8992.1,8992.1,.05,3)
This is the individual who generated the alert
"^DD",8992.1,8992.1,.05,"DT")
2941215
"^DD",8992.1,8992.1,.06,0)
GENERATED WHILE QUEUED^SI^1:YES;^0;6^Q
"^DD",8992.1,8992.1,.06,3)
This field is used to indicate alerts which were generated by queued jobs.
"^DD",8992.1,8992.1,.06,"DT")
2941215
"^DD",8992.1,8992.1,.07,0)
STATUS^SI^U:UNREAD-REMOVED BY DATE;C:COMPLETELY READ;P:PARTIALLY READ - REMOVED;^0;7^Q
"^DD",8992.1,8992.1,.07,3)
This field is used to indicate the status of the alert
"^DD",8992.1,8992.1,.07,"DT")
2941215
"^DD",8992.1,8992.1,.08,0)
RETENTION DATE^D^^0;8^S %DT="EX" D ^%DT S X=Y K:Y<1 X
"^DD",8992.1,8992.1,.08,21,0)
^^3^3^2980209^
"^DD",8992.1,8992.1,.08,21,1,0)
This field is used to set a retention date that will prevent the 
"^DD",8992.1,8992.1,.08,21,2,0)
deletion of the alert by the "Delete old (>14 day) Alerts" option
"^DD",8992.1,8992.1,.08,21,3,0)
until this date.
"^DD",8992.1,8992.1,.08,"DT")
2980209
"^DD",8992.1,8992.1,1.01,0)
DISPLAY TEXT^FI^^1;1^K:$L(X)>70!($L(X)<2) X
"^DD",8992.1,8992.1,1.01,3)
This is the text displayed for the alert
"^DD",8992.1,8992.1,1.01,"DT")
2941215
"^DD",8992.1,8992.1,1.02,0)
OPTION FOR PROCESSING^FI^^1;2^K:$L(X)>60!($L(X)<1) X
"^DD",8992.1,8992.1,1.02,3)
This is the option which the alert jumps to when the alert is selected for processing
"^DD",8992.1,8992.1,1.02,"DT")
2941215
"^DD",8992.1,8992.1,1.03,0)
ROUTINE TAG^FI^^1;3^K:$L(X)>8!($L(X)<1) X
"^DD",8992.1,8992.1,1.03,3)
This is the tag indicated for the routine specified for use when the alert is selected.
"^DD",8992.1,8992.1,1.03,"DT")
2941215
"^DD",8992.1,8992.1,1.04,0)
ROUTINE FOR PROCESSING^FI^^1;4^K:$L(X)>30!($L(X)<2) X
"^DD",8992.1,8992.1,1.04,3)
This is the routine to be invoked when the alert is selected (if a value exists for TAG, then entry will be at the indicated TAG within the routine).
"^DD",8992.1,8992.1,1.04,"DT")
2941215
"^DD",8992.1,8992.1,2,0)
DATA FOR PROCESSING^FI^^2;E1,245^K:$L(X)>245!($L(X)<1) X
"^DD",8992.1,8992.1,2,3)
This is a string of data elements, which may be separated by any desired character, which will be returned to the application when the alert is selected for processing.
"^DD",8992.1,8992.1,2,"DT")
2941215
"^DD",8992.1,8992.1,3.01,0)
GUID FOR GUI^F^^3;1^K:$L(X)>38!($L(X)<38) X
"^DD",8992.1,8992.1,3.01,3)
Answer must be a 38 character GUID {.......}
"^DD",8992.1,8992.1,3.01,21,0)
^^8^8^3010703^
"^DD",8992.1,8992.1,3.01,21,1,0)
This field contains a Globally Unique IDentifier (GUID) which is used to
"^DD",8992.1,8992.1,3.01,21,2,0)
identify the application which should be used in a graphical user
"^DD",8992.1,8992.1,3.01,21,3,0)
interface environment (windows) to process the alert.  This application
"^DD",8992.1,8992.1,3.01,21,4,0)
must implement the IVAlert interface.  The GUID should be of the form
"^DD",8992.1,8992.1,3.01,21,5,0)
 
"^DD",8992.1,8992.1,3.01,21,6,0)
  {xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx}
"^DD",8992.1,8992.1,3.01,21,7,0)
 
"^DD",8992.1,8992.1,3.01,21,8,0)
where each x is a hexadecimal digit (0 through 9 or A through F).
"^DD",8992.1,8992.1,3.01,"DT")
3010703
"^DD",8992.1,8992.1,4,0)
LONG INFO TEXT^8992.14^^4;0
"^DD",8992.1,8992.1,20,0)
RECIPIENT^8992.11PA^^20;0
"^DD",8992.1,8992.1,20,"DT")
2980526
"^DD",8992.1,8992.11,0)
RECIPIENT SUB-FIELD^^3^12
"^DD",8992.1,8992.11,0,"DT")
3050316
"^DD",8992.1,8992.11,0,"IX","B",8992.11,.01)

"^DD",8992.1,8992.11,0,"NM","RECIPIENT")

"^DD",8992.1,8992.11,0,"UP")
8992.1
"^DD",8992.1,8992.11,.01,0)
RECIPIENT^MP200'I^VA(200,^0;1^Q
"^DD",8992.1,8992.11,.01,1,0)
^.1
"^DD",8992.1,8992.11,.01,1,1,0)
8992.11^B
"^DD",8992.1,8992.11,.01,1,1,1)
S ^XTV(8992.1,DA(1),20,"B",$E(X,1,30),DA)=""
"^DD",8992.1,8992.11,.01,1,1,2)
K ^XTV(8992.1,DA(1),20,"B",$E(X,1,30),DA)
"^DD",8992.1,8992.11,.01,1,2,0)
8992.1^R
"^DD",8992.1,8992.11,.01,1,2,1)
S ^XTV(8992.1,"R",$E(X,1,30),DA(1),DA)=""
"^DD",8992.1,8992.11,.01,1,2,2)
K ^XTV(8992.1,"R",$E(X,1,30),DA(1),DA)
"^DD",8992.1,8992.11,.01,1,2,"DT")
2940707
"^DD",8992.1,8992.11,.01,3)
The entry was specified as a receipient of the alert.
"^DD",8992.1,8992.11,.01,"DT")
2980526
"^DD",8992.1,8992.11,.02,0)
ALERT FIRST DISPLAYED^DI^^0;2^S %DT="ESTXR" D ^%DT S X=Y K:Y<1 X
"^DD",8992.1,8992.11,.02,3)
This is the date and time that the alert was first displayed to the user (during a menu cycle).
"^DD",8992.1,8992.11,.02,"DT")
2941215
"^DD",8992.1,8992.11,.03,0)
FIRST SELECTED ALERT^D^^0;3^S %DT="ESTXR" D ^%DT S X=Y K:Y<1 X
"^DD",8992.1,8992.11,.03,3)
This field indicates when the alert was first selected for processing within the VIEW ALERTS option.
"^DD",8992.1,8992.11,.03,"DT")
2940707
"^DD",8992.1,8992.11,.04,0)
PROCESSED ALERT^DI^^0;4^S %DT="ESTXR" D ^%DT S X=Y K:Y<1 X
"^DD",8992.1,8992.11,.04,3)
This indicates when the processing of the alert was completed, as indicated by the kill flag not being cleared on return.
"^DD",8992.1,8992.11,.04,"DT")
2941215
"^DD",8992.1,8992.11,.05,0)
DELETED ON^DI^^0;5^S %DT="ESTXR" D ^%DT S X=Y K:Y<1 X
"^DD",8992.1,8992.11,.05,3)
This is the date and time that the alert was deleted for this user.
"^DD",8992.1,8992.11,.05,"DT")
2941215
"^DD",8992.1,8992.11,.06,0)
AUTO DELETED^DI^^0;6^S %DT="ESTXR" D ^%DT S X=Y K:Y<1 X
"^DD",8992.1,8992.11,.06,3)
This is the date and time that the alert was deleted automatically due to the age of the alert.
"^DD",8992.1,8992.11,.06,"DT")
2941215
"^DD",8992.1,8992.11,.07,0)
FORWARDED BY^P200'I^VA(200,^0;7^Q
"^DD",8992.1,8992.11,.07,3)
This is the user who forwarded the alert to the recipient
"^DD",8992.1,8992.11,.07,"DT")
2941215
"^DD",8992.1,8992.11,.08,0)
DATE/TIME FORWARDED^DI^^0;8^S %DT="ESTXR" D ^%DT S X=Y K:Y<1 X
"^DD",8992.1,8992.11,.08,3)
This is the date and time that the alert was forwarded to the recipient.
"^DD",8992.1,8992.11,.08,"DT")
2941215
"^DD",8992.1,8992.11,.09,0)
DELETED BY USER^P200'^VA(200,^0;9^Q
"^DD",8992.1,8992.11,.09,3)
This field is filled in automatically when an alert is deleted for the user, if it was deleted by a user as opposed to deleted during processing.
"^DD",8992.1,8992.11,.09,21,0)
^^5^5^2990203^
"^DD",8992.1,8992.11,.09,21,1,0)
The 'USER DELETED BY' field is poplulated if the alert is deleted for the
"^DD",8992.1,8992.11,.09,21,2,0)
current user by someone (either the user or another person from IRM or an
"^DD",8992.1,8992.11,.09,21,3,0)
ADPAC, etc.) with a delete option as opposed to deletion as a part of the
"^DD",8992.1,8992.11,.09,21,4,0)
processing of the alert.  The field points to the user who selected the
"^DD",8992.1,8992.11,.09,21,5,0)
delete option resulting in deletion of the alert prior to its processing.
"^DD",8992.1,8992.11,.09,"DT")
2990219
"^DD",8992.1,8992.11,1,0)
RECIPIENT TYPE^8992.111PA^^1;0
"^DD",8992.1,8992.11,2,0)
FORWARDED DATE/TIME^8992.112D^^2;0
"^DD",8992.1,8992.11,2,"DT")
3030221
"^DD",8992.1,8992.11,3,0)
SURROGATE FOR^8992.113P^^3;0
"^DD",8992.1,8992.111,0)
RECIPIENT TYPE SUB-FIELD^^.04^4
"^DD",8992.1,8992.111,0,"DT")
3031020
"^DD",8992.1,8992.111,0,"IX","B",8992.111,.01)

"^DD",8992.1,8992.111,0,"NM","RECIPIENT TYPE")

"^DD",8992.1,8992.111,0,"UP")
8992.11
"^DD",8992.1,8992.111,.01,0)
RECIPIENT TYPE^RP8992.2^XTV(8992.2,^0;1^Q
"^DD",8992.1,8992.111,.01,1,0)
^.1
"^DD",8992.1,8992.111,.01,1,1,0)
8992.111^B
"^DD",8992.1,8992.111,.01,1,1,1)
S ^XTV(8992.1,DA(2),20,DA(1),1,"B",$E(X,1,30),DA)=""
"^DD",8992.1,8992.111,.01,1,1,2)
K ^XTV(8992.1,DA(2),20,DA(1),1,"B",$E(X,1,30),DA)
"^DD",8992.1,8992.111,.01,3)
This is a pointer to a file of different recipient types (i.e., the reason someone was sent the alert)
"^DD",8992.1,8992.111,.01,21,0)
^^24^24^3031020^
"^DD",8992.1,8992.111,.01,21,1,0)
This field is used to track how a specific recipient was selected for 
"^DD",8992.1,8992.111,.01,21,2,0)
receiving the alert. The initial recipients are those to whom the alert
"^DD",8992.1,8992.111,.01,21,3,0)
was initially directed (INITIAL RECIPIENT).  Other recipients may be the
"^DD",8992.1,8992.111,.01,21,4,0)
result of forwarding.  Recipients of the alert from forwarding are noted
"^DD",8992.1,8992.111,.01,21,5,0)
by the type of forwarding involved (FWD BY USER, EMAIL SURROGATE,
"^DD",8992.1,8992.111,.01,21,6,0)
CHIEF/SUPERVISOR, BACKUP REVIEWER, or LAST HOPE).
"^DD",8992.1,8992.111,.01,21,7,0)
 
"^DD",8992.1,8992.111,.01,21,8,0)
Marked as a specific category are those to whom the alert was directed,
"^DD",8992.1,8992.111,.01,21,9,0)
but who were not available to receive an alert due to lack of access
"^DD",8992.1,8992.111,.01,21,10,0)
(marked with the suffix "-UNDELIVERABLE" added to the basis for the 
"^DD",8992.1,8992.111,.01,21,11,0)
alert being sent to the user).
"^DD",8992.1,8992.111,.01,21,12,0)
 
"^DD",8992.1,8992.111,.01,21,13,0)
Those who have alerts forwarded to their surrogate or receive the alert 
"^DD",8992.1,8992.111,.01,21,14,0)
while acting as a surrogate for another user are indicated by entries in 
"^DD",8992.1,8992.111,.01,21,15,0)
fields #.02 (SENT TO SURROGATE) and #.03 (ACTING AS SURROGATE), 
"^DD",8992.1,8992.111,.01,21,16,0)
respectively.  In addition, those who are acting as surrogates are 
"^DD",8992.1,8992.111,.01,21,17,0)
identified in the current field by the suffix "-SURROGATE" added to the 
"^DD",8992.1,8992.111,.01,21,18,0)
basis for the alert being received.  Since the recipient may be acting as 
"^DD",8992.1,8992.111,.01,21,19,0)
surrogate for more than one user, the actual users for which the message 
"^DD",8992.1,8992.111,.01,21,20,0)
was sent on a surrogate basis are indicated in the SURROGATE FOR sub-file 
"^DD",8992.1,8992.111,.01,21,21,0)
(#8992.113) under the RECIPIENT sub-file.
"^DD",8992.1,8992.111,.01,21,22,0)
 
"^DD",8992.1,8992.111,.01,21,23,0)
The values stored for this field are pointers to entries in the ALERT 
"^DD",8992.1,8992.111,.01,21,24,0)
RECIPIENT TYPE file (#8992.2).
"^DD",8992.1,8992.111,.01,"DT")
3031020
"^DD",8992.1,8992.111,.02,0)
SENT TO SURROGATE^P200'^VA(200,^0;2^Q
"^DD",8992.1,8992.111,.02,3)
This is the individual that was sent the alert in a surrogate capacity instead of the originally specified recipient.
"^DD",8992.1,8992.111,.02,21,0)
^^2^2^3030221^
"^DD",8992.1,8992.111,.02,21,1,0)
This field is used to identify the surrogate to whom the alert
"^DD",8992.1,8992.111,.02,21,2,0)
was sent instead of this originally specified recipient.
"^DD",8992.1,8992.111,.02,"DT")
3030221
"^DD",8992.1,8992.111,.03,0)
ACTING AS SURROGATE^S^Y:YES;N:NO;^0;3^Q
"^DD",8992.1,8992.111,.03,3)
Enter Y (YES) if this recipient received the alert acting as surrogate for another user.
"^DD",8992.1,8992.111,.03,21,0)
^^3^3^3030220^
"^DD",8992.1,8992.111,.03,21,1,0)
This field is used to identify those recipients who were sent the alert 
"^DD",8992.1,8992.111,.03,21,2,0)
because they were selected as an active surrogate for the originally 
"^DD",8992.1,8992.111,.03,21,3,0)
intended user.  In most cases only the Y (YES) entries will be entered.
"^DD",8992.1,8992.111,.03,"DT")
3030220
"^DD",8992.1,8992.111,.04,0)
ALERT DATE/TIME^D^^0;4^S %DT="ESTXR" D ^%DT S X=Y K:Y<1 X
"^DD",8992.1,8992.111,.04,1,0)
^.1
"^DD",8992.1,8992.111,.04,1,1,0)
8992.1^AUD^MUMPS
"^DD",8992.1,8992.111,.04,1,1,1)
N XQALDA1 S XQALDA1=+^XTV(8992.1,DA(2),20,DA(1),0),^XTV(8992.1,"AUD",XQALDA1,X,DA(2))=""
"^DD",8992.1,8992.111,.04,1,1,2)
N XQALDA1 S XQALDA1=+^XTV(8992.1,DA(2),20,DA(1),0) K ^XTV(8992.1,"AUD",XQALDA1,X,DA(2))
"^DD",8992.1,8992.111,.04,1,1,"DT")
3041028
"^DD",8992.1,8992.111,.04,3)
This is the date and time the alert was sent/forwarded to the current recipient with this recipient type
"^DD",8992.1,8992.111,.04,21,0)
^^2^2^3030221^
"^DD",8992.1,8992.111,.04,21,1,0)
This is the date and time the alert was sent/forwarded to the 
"^DD",8992.1,8992.111,.04,21,2,0)
current recipient with this recipient type
"^DD",8992.1,8992.111,.04,"DT")
3041028
"^DD",8992.1,8992.112,0)
FORWARDED DATE/TIME SUB-FIELD^^1.01^4
"^DD",8992.1,8992.112,0,"DT")
3031020
"^DD",8992.1,8992.112,0,"IX","B",8992.112,.01)

"^DD",8992.1,8992.112,0,"NM","FORWARDED DATE/TIME")

"^DD",8992.1,8992.112,0,"UP")
8992.11
"^DD",8992.1,8992.112,.01,0)
FORWARDED DATE/TIME^MD^^0;1^S %DT="ESTXR" D ^%DT S X=Y K:Y<1 X
"^DD",8992.1,8992.112,.01,1,0)
^.1
"^DD",8992.1,8992.112,.01,1,1,0)
8992.112^B
"^DD",8992.1,8992.112,.01,1,1,1)
S ^XTV(8992.1,DA(2),20,DA(1),2,"B",$E(X,1,30),DA)=""
"^DD",8992.1,8992.112,.01,1,1,2)
K ^XTV(8992.1,DA(2),20,DA(1),2,"B",$E(X,1,30),DA)
"^DD",8992.1,8992.112,.01,3)
This is the date/time that the alert was forwarded to the current recipient
"^DD",8992.1,8992.112,.01,21,0)
^^5^5^3030221^
"^DD",8992.1,8992.112,.01,21,1,0)
This field is used to track the date/time of forwarding of the alert to 
"^DD",8992.1,8992.112,.01,21,2,0)
this recipient.  This is a multiple field to track instances in which 
"^DD",8992.1,8992.112,.01,21,3,0)
multiple copies of the alert may be forwarded to a single recipient for
"^DD",8992.1,8992.112,.01,21,4,0)
various reasons.  This multiple field will indicate when it was forwarded
"^DD",8992.1,8992.112,.01,21,5,0)
and the basis for forwarding of the alert.
"^DD",8992.1,8992.112,.01,"DT")
3030221
"^DD",8992.1,8992.112,.02,0)
FORWARDING CATEGORY^P8992.2^XTV(8992.2,^0;2^Q
"^DD",8992.1,8992.112,.02,3)
This field points to a file containing the different reasons for forwarding.
"^DD",8992.1,8992.112,.02,21,0)
^^8^8^3031020^
"^DD",8992.1,8992.112,.02,21,1,0)
This field is used to track the basis on which the alert is forwarded to 
"^DD",8992.1,8992.112,.02,21,2,0)
the current recipient.  The alert might be forwarded to the recipient by 
"^DD",8992.1,8992.112,.02,21,3,0)
a user directly, or by programmed forwarding related to alerts not being 
"^DD",8992.1,8992.112,.02,21,4,0)
processed within a specified time to EMAIL SURROGATE, CHIEF/SUPERVISOR; 
"^DD",8992.1,8992.112,.02,21,5,0)
BACKUP REVIEWER, or LAST RESORT.
"^DD",8992.1,8992.112,.02,21,6,0)
 
"^DD",8992.1,8992.112,.02,21,7,0)
Entries for this field are pointers to the values in the ALERT RECIPIENT 
"^DD",8992.1,8992.112,.02,21,8,0)
TYPE file (#8992.2).
"^DD",8992.1,8992.112,.02,"DT")
3031020
"^DD",8992.1,8992.112,.03,0)
FORWARDED BY OR FOR^P200'^VA(200,^0;3^Q
"^DD",8992.1,8992.112,.03,3)
This is the individual that forwarded the alert, or the alert was forwarded for.
"^DD",8992.1,8992.112,.03,21,0)
^^2^2^3030404^
"^DD",8992.1,8992.112,.03,21,1,0)
This is a record of the individual who forwarded the alert, or on whose 
"^DD",8992.1,8992.112,.03,21,2,0)
behalf the alert was forwarded if it was forwarded automatically.
"^DD",8992.1,8992.112,.03,"DT")
3030404
"^DD",8992.1,8992.112,1.01,0)
FORWARDING COMMENT^F^^1;1^K:$L(X)>240!($L(X)<1) X
"^DD",8992.1,8992.112,1.01,3)
Answer must be 1-240 characters in length.
"^DD",8992.1,8992.112,1.01,21,0)
^^2^2^3030220^
"^DD",8992.1,8992.112,1.01,21,1,0)
This is the comment which was sent to the recipient along with the 
"^DD",8992.1,8992.112,1.01,21,2,0)
forwarded alert.
"^DD",8992.1,8992.112,1.01,"DT")
3030220
"^DD",8992.1,8992.113,0)
SURROGATE FOR SUB-FIELD^^.03^3
"^DD",8992.1,8992.113,0,"DT")
3050316
"^DD",8992.1,8992.113,0,"IX","B",8992.113,.01)

"^DD",8992.1,8992.113,0,"NM","SURROGATE FOR")

"^DD",8992.1,8992.113,0,"UP")
8992.11
"^DD",8992.1,8992.113,.01,0)
SURROGATE FOR^MP200'^VA(200,^0;1^Q
"^DD",8992.1,8992.113,.01,1,0)
^.1
"^DD",8992.1,8992.113,.01,1,1,0)
8992.113^B
"^DD",8992.1,8992.113,.01,1,1,1)
S ^XTV(8992.1,DA(2),20,DA(1),3,"B",$E(X,1,30),DA)=""
"^DD",8992.1,8992.113,.01,1,1,2)
K ^XTV(8992.1,DA(2),20,DA(1),3,"B",$E(X,1,30),DA)
"^DD",8992.1,8992.113,.01,3)
Enter the NEW PERSON entry for which the current recipient is acting as surrogate on this alert.
"^DD",8992.1,8992.113,.01,21,0)
^^2^2^3030220^
"^DD",8992.1,8992.113,.01,21,1,0)
This field is used to track which user or users the current recipient is 
"^DD",8992.1,8992.113,.01,21,2,0)
receiving the current alert while acting as surrogate.
"^DD",8992.1,8992.113,.01,"DT")
3030220
"^DD",8992.1,8992.113,.02,0)
DATE/TIME - SURROGATE FOR^D^^0;2^S %DT="ESTXR" D ^%DT S X=Y K:Y<1 X
"^DD",8992.1,8992.113,.02,3)
Enter the date/time that this alert was received while acting as a surrogate for the intended recipient.
"^DD",8992.1,8992.113,.02,21,0)
^^3^3^3030220^
"^DD",8992.1,8992.113,.02,21,1,0)
This field has the date/time when the alert was sent to the current 
"^DD",8992.1,8992.113,.02,21,2,0)
recipient while acting as a surrogate for the originally intended 
"^DD",8992.1,8992.113,.02,21,3,0)
recipient.
"^DD",8992.1,8992.113,.02,"DT")
3030220
"^DD",8992.1,8992.113,.03,0)
DATE-TIME RETURNED^D^^0;3^S %DT="ESTXR" D ^%DT S X=Y K:Y<1 X
"^DD",8992.1,8992.113,.03,3)
This is the date-time that the alert was returned to the originally intended recipient
"^DD",8992.1,8992.113,.03,21,0)
^^3^3^3050316^
"^DD",8992.1,8992.113,.03,21,1,0)
This field is a record for the date-time that an alert for which this 
"^DD",8992.1,8992.113,.03,21,2,0)
recipient was acting as a surrogate was returned to the originally 
"^DD",8992.1,8992.113,.03,21,3,0)
intended recipient of the alert.
"^DD",8992.1,8992.113,.03,"DT")
3050316
"^DD",8992.1,8992.14,0)
LONG INFO TEXT SUB-FIELD^^.01^1
"^DD",8992.1,8992.14,0,"DT")
3000329
"^DD",8992.1,8992.14,0,"NM","LONG INFO TEXT")

"^DD",8992.1,8992.14,0,"UP")
8992.1
"^DD",8992.1,8992.14,.01,0)
LONG INFO TEXT^W^^0;1^Q
"^DD",8992.1,8992.14,.01,3)
Enter text for an information only alert that should be displayed as word-processing text instead of a single line.
"^DD",8992.1,8992.14,.01,21,0)
^^4^4^3000329^
"^DD",8992.1,8992.14,.01,21,1,0)
This field is used to present a long information only alert.  It can be
"^DD",8992.1,8992.14,.01,21,2,0)
any length since it is stored as word processing text.  It is to be
"^DD",8992.1,8992.14,.01,21,3,0)
displayed in a screen-man window on dumb terminals and in a memo box on
"^DD",8992.1,8992.14,.01,21,4,0)
windowed systems.
"^DD",8992.1,8992.14,.01,"DT")
3000329
"^DIC",8992,8992,0)
ALERT^8992
"^DIC",8992,8992,0,"GL")
^XTV(8992,
"^DIC",8992,8992,"%D",0)
^^7^7^2941128^
"^DIC",8992,8992,"%D",1,0)
This file is used to keep track of alerts pending processing for each
"^DIC",8992,8992,"%D",2,0)
user.  The main entry for each record is a pointer to the NEW PERSON file.
"^DIC",8992,8992,"%D",3,0)
 A multiple under each user is used to record the date and time an alert
"^DIC",8992,8992,"%D",4,0)
was generated, the unique ID associated with the alert, the text for
"^DIC",8992,8992,"%D",5,0)
display, and an optional routine entry point or option for use in
"^DIC",8992,8992,"%D",6,0)
processing the alert, and an optional data string associated with the
"^DIC",8992,8992,"%D",7,0)
alert.
"^DIC",8992,"B","ALERT",8992)

"^DIC",8992.1,8992.1,0)
ALERT TRACKING^8992.1
"^DIC",8992.1,8992.1,0,"GL")
^XTV(8992.1,
"^DIC",8992.1,8992.1,"%D",0)
^^15^15^2941128^
"^DIC",8992.1,8992.1,"%D",1,0)
This file is used to track the content and interactions with an alert.
"^DIC",8992.1,8992.1,"%D",2,0)
Every alert which is generated is initially filed within this file.  Each
"^DIC",8992.1,8992.1,"%D",3,0)
entry has the date and time the alert was generated, which user generated
"^DIC",8992.1,8992.1,"%D",4,0)
the alert, whether the alert was generated in a background task, what
"^DIC",8992.1,8992.1,"%D",5,0)
action was to be taken if any (the entry point or option name to be used)
"^DIC",8992.1,8992.1,"%D",6,0)
and the data string, if any, for use with the alert.  There is a multiple
"^DIC",8992.1,8992.1,"%D",7,0)
field which also identifies each user that the alert was sent to, and when
"^DIC",8992.1,8992.1,"%D",8,0)
the user initially saw the displayed text, when the alert was selected for
"^DIC",8992.1,8992.1,"%D",9,0)
processing, when the processing was completed, and when the alert was
"^DIC",8992.1,8992.1,"%D",10,0)
deleted after processing or associated with another user's processing, or
"^DIC",8992.1,8992.1,"%D",11,0)
when the alert was deleted by a clean-up operation.
"^DIC",8992.1,8992.1,"%D",12,0)
 
"^DIC",8992.1,8992.1,"%D",13,0)
Unless a longer lifetime is specified for the specific alert, it will be
"^DIC",8992.1,8992.1,"%D",14,0)
deleted from the file after 30 days.  If a longer lifetime is specified,
"^DIC",8992.1,8992.1,"%D",15,0)
it will not be deleted until after that period passes.
"^DIC",8992.1,"B","ALERT TRACKING",8992.1)

"BLD",531,6)
^SEQ #313
**END**
**END**
