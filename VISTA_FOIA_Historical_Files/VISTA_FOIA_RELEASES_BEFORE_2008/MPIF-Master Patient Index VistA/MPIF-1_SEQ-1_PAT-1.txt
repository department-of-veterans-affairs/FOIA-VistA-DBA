$TXT Created by CHESNEY,CHRISTINE M at VAB-RAD.ISC-SF.VA.GOV  (KIDS) on THURSDAY, 03/23/00 at 07:15
=============================================================================
Run Date: MAR 29, 2000                     Designation: MPIF*1*1
Package : MPIF - MASTER PATIENT INDEX VISTA Priority: Mandatory
Version : 1         SEQ #1                     Status: Released
=============================================================================

Associated patches: (v)RG*1*1     <<= must be installed BEFORE `MPIF*1*1'

Subject: Miscellaneous Fixes

Category: 
  - Routine

Description: 
============

  Required Builds:  Master Patient Index Vista 1.0
   
  This patch resolves a number of reported problems regarding the CIRN
  Exception Handling, Local ICNs, and changes the real-time connection with
  the MPI to no longer give a list of potential matches during the three
  PIMS options.  It also includes some enhancements to the CIRN Exception 
  Handling and developer APIs.
   
  Issue #1:  The West Palm Beach and Indianapolis VAMCs reported
  receiving a large number of Exception Messages indicating Potential
  Matches were found on the MPI, but when these patients were looked at,
  they had already been assigned an ICN and didn't need follow-up.  The
  [MPIF LOC/MIS ICN RES] Local/Missing ICN Resolution Background Job was
  not cleaning up the ^DPT("AMPIMIS",dfn) cross reference for those patient
  that had been missing an ICN (integration control number), but had
  received one as a result of the background job.  The job would run again
  and find the patient still needing an ICN because the cross reference
  still existed. NOIS # WPB-0699-30045
   
  Issue  #2:  The West Palm Beach VAMC reported that they were getting
  Exception Messages stating that 2 patients were attempting to have the
  same ICN, but the patients were both the same DFN.  This instance should
  not generate the exception message.  NOIS # WPB-0699-30045
   
  Issue #3:  The Indianapolis VAMC reported that one of their patients
  had been added to the MPI but the ICN and CMOR fields had not gotten
  updated at the local site due to SSNs not matching.  The site did receive
  an Exception message letting them know about the SSN issue. In this case,
  the MPI had no SSN and the site had a pseudo SSN, so the ICN and CMOR
  should have been updated.  Only when this situation exists will the ICN
  and CMOR be updated at the local site.
   
  Issue #4:  The Indianapolis VAMC reported that a LOCAL ICN was sent to
  the MPI and was now on the MPI as a national ICN.  This was how the
  original functionality was going to work and there was one place that the
  code had not been corrected.  The MPI and the site have been cleaned up.
  Local ICNs should not go to the MPI and will no longer.
   
  Issue #5:  The sites have requested that during the real-time
  connection with the MPI from the Load/Edit Patient Data, 10-10T
  Registration or Register a Patient options we stop displaying a list of
  potential matches found on the MPI. This will take the pressure off the
  clerk to determine which if any of the list patients is the patient they
  are working with, while in the middle of data entry.  Instead a Local ICN
  will be assigned and the process continue as normal.  The Local ICN will
  be resolved during the nightly Local/Missing ICN Resolution job, if
  possible. The patient will show up on the potential match report, a new
  option provided by CIRN.  See the RG*1.0*1 patch description for more
  information on this new option.
   
  Issue #6:  If a site should have the Facility Name field in the HL
  Logical Link file (#870), populated for links other than CIRN links
  (starting with VA and the next three letters designating a site), it may
  result in CIRN or MPI messages being sent to another link other than
  CIRN. A check has been put in place to stop the sending of CIRN or MPI
  specific messages to non-CIRN links.  "Change ICN" messages not included
  in this check as other links may need to subscriber to this message in
  the near future.
   
  Issue #7:  Single Patient Initialization could potentially match up
  patients where their Name, SSN or DOB was not exactly the same without
  asking the user first.  This has been changed so that even if there is
  only one possible match found, and the Name, SSN or DOB is different, it
  asks the user first if this is really the right person.  Also if the ICNs
  didn't match (local to national), the matching of these two patients was
  stopped.  This will no longer be a problem.
   
  Issue #8:  CIRN has made some changes to the CIRN Exception handling
  functionality, which required MPI VistA to pass DFN (Patient file (#2)
  IEN) when known.  This change is to support the enhancements being made
  to the CIRN Exception handling functionality.  
   
  Issue #9:  Murfreesboro reported an error in MPIFBT3 when CMOR is not
  returned from the MPI.  This should not happen, since CMOR is a required
  field on the MPI.  The problem is being addressed on the MPI, and to stop
  future errors on the VISTA side, CMOR is being checked if returned as
  NULL. NOIS # MUR-1099-32887
  
  Issue #10:  When Inactivating a Patient from the MPI, the Treating
  Facility list was not being cleaned up for this patient.  The Treating
  Facility list will only have the CMOR in it and will now be deleted.
  
  Issue #11:  In an effort to assist the sites this CIRN Exception
  messages, any messages that go to the MPIF EXCEPTIONS mail group will be
  forwarded to FORUM to mail group CIRN EXCEPTION MGT.  These exception
  messages are to result in NOISes being logged which will be handled by
  members of the mail group on FORUM.  The MPIF EXCEPTIONS mail group is
  being exported here to include this remote members mail group.
  
  Issue #12:  It was reported by Denver that the Locally Assigned ICN
  (#991.04) isn't always being set when a local ICN is assigned.  Also the
  cross reference associated with that field is sometimes killed before it
  should be [^DPT("AICNL",1,<dfn>)].  The post-int MPIFPST1 will
  clean up any existing issues with the Locally Assigned ICN field and the
  cross reference for this field.
  
  Issue #13:  A new API is being provided for the PIMS group to use to get
  an ICN for a patient or to create a Local ICN for a patient that didn't
  already have one.  The current API that is being used can result in a 
  Local ICN overwriting a National ICN, if the timing is correct.  This
  new API will stop that from happening.  This will be a private API.
  
  Issue #14:  A new bulletin (MPIF CMOR COMPARE COMPLETE) will be created
  to tell the install team that a CMOR Compare message has been processed
  at a site and how many CMORs have changed as a result.  This bulletin 
  will be sent to the MPIF EXCEPTIONS mail group.
  
  Issue #15:  With the changes that were made by PIMS with regards to 
  sensitive patients in the Patient file in patch DG*5.3*249, if the
  HL7 Inbound filer was started with a DUZ=0, the MPIF processing routine
  can not process sensitive patients.  The PIMS package will be issuing 
  patch DG*5.3*223 to allow the lookup to proceed with DIC(0) containing
  a I and DUZ=0.  The DIC(0) changes have been made in the appropriate MPIF
  routines.  Until the DG patch is issued, the sites have been asked to
  start their HL7 Inbound filer as a valid user. 
  
  Issue #16:  While addressing one of the Local ICN issues, during testing
    of this patch a error was introduced with a typo in a variable name.  
  This has been corrected.  NOIS # MAC-0200-66564, DAY-0200-42394
  
  
  TEST SITES:  Include all CIRN/MPI sites that implemented prior to 
  ===========            3/17/00.
  
  
  ROUTINE SUMMARY:
  ================
  
  The following is a list of the routine(s) included in this patch.  The
  second line of each of these routine(s) will look like:
  
        <tab>;;1.0; MASTER PATIENT INDEX VISTA ;**1**;30 Apr 99
  
  
                              CHECK^XTSUMBLD results
   Routine name      Before Patch          After Patch         Patch List
   ============      ============          ===========         ==========
    MPIF001             6305289             7469920                 1
    MPIFA31I            5903603             5381482                 1
    MPIFAPI             3097578             3215332                 1
    MPIFBT2            28344894            19899819                 1
    MPIFBT3             NEW                12716122                 1
    MPIFCMOR            2504895             3788990                 1
    MPIFDEL             3590376             4514446                 1
    MPIFHL7             1225729             2049750                 1
    MPIFPST1            NEW                  679868                 1
    MPIFQ0             12178999            13972321                 1
    MPIFQ1             10106997             8694088                 1
    MPIFQUE3           13612271            14526420                 1
    MPIFQUE4           11431534            13609081                 1
    MPIFQUE5            3670751             4350903                 1
    MPIFREQ             5738910             8227719                 1
    MPIFRES             3019455             3150163                 1
    MPIFRESS            3835024             6289888                 1
    MPIFRTC             1616175             1700444                 1
    MPIFSAQ            16409695            16446978                 1
    MPIFVTQ            14614148            15218414                 1     
  
  INSTALLATION INSTRUCTIONS:
  ==========================
  
  This patch should be loaded during non-peak hours to minimize disruption
  to users.  Installation will take less than 15 minutes.  The Post-Init
  will be updating the AICNL cross reference in the Patient file, so
  depending upon the number of local ICNs and ICNs you have will depend on
  how long it takes to run.
   
   1.  Users are allowed on the system during patch installation.
     
   2.   DSM sites: These routines are not usually mapped, so you 
        will probably not have to disable routine mapping. 
  
   3.  Use the INSTALL/CHECK MESSAGE option on the PackMan menu. [Note:
       TEXT PRINT/DISPLAY option in the PackMan menu will display the patch
       text only.
   
   4.  TaskMan does not need to be stopped or placed in a wait state. 
  
   5.  From the Kernel Installation and Distribution System Menu, select
       the Installation menu.  
   
   6.  From this menu, you may elect to use the following options:
  
       a.  Backup a Transport Global - this option will create a backup
           message of any routines exported with the patch.  It will NOT
           backup any other changes such as DDs or templates.
       b.  Compare Transport Global to Current System  - this option will
           allow you to view all changes that will be made when the patch
           is installed.  It compares all components of the patch
           (routines, DDs, templates, etc.).
       c.  Verify Checksums in Transport Global - this option will allow
           you to ensure the integrity of the routines that are in the
           transport global.
       d.  Print Transport Global - this option will allow you to view the
           components of the KIDS build.
   
   7.  Use the Install Package(s) option and select the package MPIF*1*1.
   
   8.  When prompted 'Want to DISABLE Scheduled Options, Menu Options, and
       Protocols? YES//', respond No.  
  
   9.  Now that the install is completed, you may want to go and remove any
       local members in the MPIF EXCEPTIONS mail group.  The messages that
       go to this mail group are now going to FORUM so that they can be 
       addressed by NVS and the CIRN/MPI team.  These are messages that
       originally the sites were asked to log a NOIS if received.
  
   10.  Routine MPIFPST1 can be deleted once the post init has successfully
        completed.

Routine Information:
====================

Routine Name:
  - MPIFAPI


Routine Checksum:

Routine Name:
  - MPIFQ0


Routine Checksum:

Routine Name:
  - MPIF001


Routine Checksum:

Routine Name:
  - MPIFRES


Routine Checksum:

Routine Name:
  - MPIFBT2


Routine Checksum:

Routine Name:
  - MPIFRTC


Routine Checksum:

Routine Name:
  - MPIFBT3


Routine Checksum:

Routine Name:
  - MPIFQUE4


Routine Checksum:

Routine Name:
  - MPIFQUE3


Routine Checksum:

Routine Name:
  - MPIFCMOR


Routine Checksum:

Routine Name:
  - MPIFREQ


Routine Checksum:

Routine Name:
  - MPIFRESS


Routine Checksum:

Routine Name:
  - MPIFSAQ


Routine Checksum:

Routine Name:
  - MPIFQ1


Routine Checksum:

Routine Name:
  - MPIFQUE5


Routine Checksum:

Routine Name:
  - MPIFA31I


Routine Checksum:

Routine Name:
  - MPIFDEL


Routine Checksum:

Routine Name:
  - MPIFPST1


Routine Checksum:

Routine Name:
  - MPIFVTQ


Routine Checksum:

Routine Name:
  - MPIFHL7


Routine Checksum:

=============================================================================
User Information:                               
Entered By  : CHESNEY,CHRISTINE M           Date Entered : JUN 03, 1999
Completed By: MURPHY,MINAO J.              Date Completed: MAR 23, 2000
Released By : MCKIM,MARY ANN               Date Released : MAR 29, 2000
=============================================================================


Packman Mail Message:
=====================

$END TXT
