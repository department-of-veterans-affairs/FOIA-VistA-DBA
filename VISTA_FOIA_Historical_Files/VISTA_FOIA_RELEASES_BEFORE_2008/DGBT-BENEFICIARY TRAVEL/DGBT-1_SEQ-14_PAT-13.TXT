=============================================================================
Run Date: FEB 22, 2007                     Designation: DGBT*1*13
Package : DGBT - BENEFICIARY TRAVEL           Priority: Mandatory
Version : 1        SEQ #14                      Status: Released
                  Compliance Date: MAR 24, 2007
=============================================================================

Associated patches: (v)DGBT*1*8    <<= must be installed BEFORE `DGBT*1*13'
                    (v)DGBT*1*12   <<= must be installed BEFORE `DGBT*1*13'

Subject: SD ENCAPSULATION CHANGES

Category: 
  - Routine
  - Enhancement (Mandatory)

Description:
============

 This patch will allow the implementation of the Scheduling Encapsulation
 Update project in order to meet the needs of the Scheduling Replacement
 Team.  
  
                          I M P O R T A N T
  ************************************************************************
  This Beneficiary Travel patch, DGBT*1.0*13, along with Registration patch
  DG*5.3*725 and and Enrollment Application System patch EAS*1.0*77 is
  being released in a single KIDS software distribution, host file 
  DG_53_P725.KID. This patch description includes only the informational
  portion of DGBT*1.0*13.
  
  Please refer to the "Software Retrieval" and "Installation Instructions"
  sections of the DG*5.3*725 patch description for instructions on how 
  to acquire, install, and implement the patch software. Before you do, 
  however, please note the DGBT option to disable. It is listed below, 
  in the Installation Instructions section of this patch description.
  *************************************************************************
  
 In the Fall of 2004, the Scheduling Replacement Team released the 
 Scheduling API to retrieve appointment data. In December, 2004, the
 Enrollment Maintenance Team released software implementing the API into
 the Registration, Beneficiary Travel, Enrollment Application System, and
 Income Verification Match software packages. Recent modifications to the
 Scheduling API have necessitated further modifications to the software.
  
 The Scheduling Encapsulation Update project will require modifications
 in the VistA environment only, with the scope of these modifications
 encompassing the following activities:
  
 - Deleting data that may not have been cleared from temporary global
    workspace
 - Minor changes to Appointment Status filter to return wanted values only
 - Minor changes to Appointment Type parameter passing to return wanted 
    values only
 - Database error not displaying when Replacement Scheduling Application
   (RSA) database is down
 - Implement RSA database performance suggestions in several routines
 - Enhance Error message handling to include all three Error Messages 101, 
    115 and 117 (see #3 below)
  
  
 This patch includes the following changes to the stated routines:
  
 1. Correct Database Error Display/Handling Issues When RSA Database Is
    Down:
 -------------------------------------------------------------------------
 When the Appointment API returned an error message, routines DGBT2 and
 DGBTE1 ignored the error message and continue their processing as if there
 were no appointments for the veterans. These routines have been modified
 to check for error handling and stop processing if an error has been
 encountered. 
  
 2. Implement RSA Database Performance Enhancements:
 --------------------------------------------------- 
 In the routine DGBTE1, the code has been modified to pass a date range to 
 return only the appointment information required instead of all the 
 appointments for a veteran.
  
 3. Enhance Error Message Handling to Include All Three Messages:
 ---------------------------------------------------------------- 
 The Scheduling API has been enhanced to include two additional error
 messages, Error 115 and Error 117, to help the users diagnose issues with
 the Appointment (RSA) Database. Routines DGBT2 and DGBTE1 have been
 modified to check for the following errors:
  
 Error 101: 
 The Appointment Database is not currently available.  
 Please try again later.
  
 Error 115: 
 Appointment request contains invalid values.  
 Please contact National Help Desk. 
  
 Error 117: 
 An error has occurred, check the RSA Error Log.
  
  
 This patch addresses the following New Service Request (NSR):
 -------------------------------------------------------------
 There is no NSR associated with this patch.
  
  
 This patch addresses the following NOIS/Remedy Tickets:
 ---------------------------------------------------------
 There are no NOIS/Remedy tickets for this patch.
  
  
 TEST SITES
  
 Please refer to patch DG*5.3*725 for the test sites that participated in 
 the testing of this software.
  
  
 SOFTWARE RETRIEVAL
  
 Please refer to patch DG*5.3*725 for software retrieval instructions.
  
 *This Beneficiary Travel patch, DGBT*1.0*13, along with Registration
  patch DG*5.3*725 and and Enrollment Application System patch EAS*1.0*77
  is being released in a single KIDS software distribution (host file).
  This patch includes only the informational portion of DGBT*1.0*13.
  
  
 Components Sent With Patch
 --------------------------
 ROUTINES: DGBT2
           DGBTE1
  
  ROUTINE SUMMARY:
  ================
  The following is a list of the routine(s) included in this patch.  The
  second line of each of these routine(s) will look like:
  
      <tab>;;1.0;Beneficiary Travel;**[patch list]**;September 25, 2001
  
                              CHECK^XTSUMBLD results
  Routine       Before Patch   After Patch              Patch List
  =======       ============   ===========              ==========
  DGBT2             11793086      11622972                7,8,13
  DGBTE1            11744334      10405701                8,12,13
  
 Number of routines in patch:           2
  Number of routines changed:           2
  
  
  
                       CHECK1^XTSUMBLD (new method) results
  Routine       Before Patch   After Patch              Patch List
  =======       ============   ===========              ==========
  DGBT2             17240934      17424501                7,8,13
  DGBTE1            22539383      21074208                8,12,13
  
 Number of routines in patch:           2
  Number of routines changed:           2
  
  
  
  
        ================INSTALLATION INSTRUCTIONS =================
  
 The following option needs to be disabled before patch installation:
  
 Claim Enter/Edit      [DGBT BENE TRAVEL SCREEN]
  
  
 Please refer to patch DG*5.3*725 for installation instructions.

Routine Information:
====================
The checksums below are new checksums, and
 can be checked with CHECK1^XTSUMBLD.

Routine Name: DGBT2
    Before: B17240934  After: B17424501  **7,8,13**
Routine Name: DGBTE1
    Before: B22539383  After: B21074208  **8,12,13**

=============================================================================
User Information:
Entered By  : FERRARESE,MARY ANN            Date Entered  : OCT 20, 2006
Completed By: RUDINGER,NANCY L.             Date Completed: FEB 20, 2007
Released By : FITCH,DONNA                   Date Released : FEB 22, 2007
=============================================================================
