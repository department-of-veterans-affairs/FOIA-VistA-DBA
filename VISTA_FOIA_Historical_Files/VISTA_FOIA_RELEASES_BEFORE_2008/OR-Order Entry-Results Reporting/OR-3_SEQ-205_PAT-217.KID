Released OR*3*217 SEQ #205
Extracted from mail message
**KIDS**:OR*3.0*217^

**INSTALL NAME**
OR*3.0*217
"BLD",5013,0)
OR*3.0*217^ORDER ENTRY/RESULTS REPORTING^0^3041029^y
"BLD",5013,1,0)
^^126^126^3041029^
"BLD",5013,1,1,0)
Patch Description:
"BLD",5013,1,2,0)
==================
"BLD",5013,1,3,0)
This patch provides a utility, consisting of a set of three routines, to 
"BLD",5013,1,4,0)
find records in the ORDERABLE ITEM FILE # 101.43 which do not have 
"BLD",5013,1,5,0)
matching records in their source files. It will flag any active Orderable 
"BLD",5013,1,6,0)
Item record without a matching source record as inactive and print a 
"BLD",5013,1,7,0)
detailed report of its findings.
"BLD",5013,1,8,0)
 
"BLD",5013,1,9,0)
The issue is an active orderable item record that does not have a 
"BLD",5013,1,10,0)
matching source record. To address this issue a utility has been written 
"BLD",5013,1,11,0)
that will perform an analysis of the ORDERABLE ITEM FILE, file # 101.43, 
"BLD",5013,1,12,0)
and produce a detailed report of its findings. This utility will scan the 
"BLD",5013,1,13,0)
the ORDERABLE ITEM FILE record by record. This utility  determines the 
"BLD",5013,1,14,0)
following about the current ORDBERABLE ITEM FILE record being processed:
"BLD",5013,1,15,0)
 
"BLD",5013,1,16,0)
1. Is the ID field null?
"BLD",5013,1,17,0)
 
"BLD",5013,1,18,0)
2. Is the source record IEN stored in the ID field null?
"BLD",5013,1,19,0)
 
"BLD",5013,1,20,0)
3. Is the source record package code stored in the ID field null?
"BLD",5013,1,21,0)
 
"BLD",5013,1,22,0)
4. Is the data stored in the ID field properly formatted?
"BLD",5013,1,23,0)
 
"BLD",5013,1,24,0)
5. Is the source record package code part of the current interface 
"BLD",5013,1,25,0)
specification?
"BLD",5013,1,26,0)
 
"BLD",5013,1,27,0)
6. Is there a matching source record?
"BLD",5013,1,28,0)
 
"BLD",5013,1,29,0)
7. Is it currently flagged as active?
"BLD",5013,1,30,0)
 
"BLD",5013,1,31,0)
A temporary global is build tracking all of the above for a detailed 
"BLD",5013,1,32,0)
report. Only an ORDERABLE ITEM FILE record passing all tests is modified.
"BLD",5013,1,33,0)
At this point it will be flagged as inactive effective immediately. After
"BLD",5013,1,34,0)
the utility has printed its report the temporary global created by this
"BLD",5013,1,35,0)
utility is deleted. The utility is to be run at any time the null
"BLD",5013,1,36,0)
subscript error is encountered during the ordering process.
"BLD",5013,1,37,0)
 
"BLD",5013,1,38,0)
It is these invalid orderable items with no matching source records that 
"BLD",5013,1,39,0)
are generating the NULLSUBSCR errors described in the associated NOIS 
"BLD",5013,1,40,0)
cases. The flagging of records in the ORDERABLE ITEM FILE # 101.43 
"BLD",5013,1,41,0)
without matching source records as inactive will prevent CPRS GUI from 
"BLD",5013,1,42,0)
presenting them to the user as valid orderable items. The routines in 
"BLD",5013,1,43,0)
this patch can be run anytime a selected orderable item generates the 
"BLD",5013,1,44,0)
NULLSUBSCR error.
"BLD",5013,1,45,0)
 
"BLD",5013,1,46,0)
Associated NOIS:
"BLD",5013,1,47,0)
================
"BLD",5013,1,48,0)
1. ALB-1001-51034 - UNDEF VAR LOAD+6~ORWDLR32
"BLD",5013,1,49,0)
2. DAN-0204-42157 - Error on Order of Lab Test
"BLD",5013,1,50,0)
3. NJH-0402-20607 - Receiving error message in CPRS
"BLD",5013,1,51,0)
4. SBY-0803-30443 - LOAD+4~ORWDLR32:1,%DSM-E-NULLSUBSCR
"BLD",5013,1,52,0)
 
"BLD",5013,1,53,0)
OPTIONS
"BLD",5013,1,54,0)
=======
"BLD",5013,1,55,0)
 
"BLD",5013,1,56,0)
CPRS Clean-up Utilities menu (ORE MGR, a menu option) was modified. A new 
"BLD",5013,1,57,0)
option was added to it.
"BLD",5013,1,58,0)
 
"BLD",5013,1,59,0)
Orderable Items Records Validation (ORE ORDERABLE ITEMS VALIDATION, a run 
"BLD",5013,1,60,0)
routine option) was created. It has been added to the CPRS Clean-up 
"BLD",5013,1,61,0)
Utilities menu.
"BLD",5013,1,62,0)
 
"BLD",5013,1,63,0)
The menu path to the new option is:
"BLD",5013,1,64,0)
        CPRS Manger Menu
"BLD",5013,1,65,0)
        CPRS Configuration (IRM) - IR
"BLD",5013,1,66,0)
        CPRS Clean-up Utilities - UT
"BLD",5013,1,67,0)
        Orderable Items Records Validation - OI
"BLD",5013,1,68,0)
 
"BLD",5013,1,69,0)
HOW TO RUN THE UTILITY:
"BLD",5013,1,70,0)
=======================
"BLD",5013,1,71,0)
 
"BLD",5013,1,72,0)
1. Enter the "CPRS Manager Menu".
"BLD",5013,1,73,0)
 
"BLD",5013,1,74,0)
2. Select the "CPRS Configuration (IRM)" option.
"BLD",5013,1,75,0)
 
"BLD",5013,1,76,0)
3. Select the "CPRS Clean-up Utilities" option.
"BLD",5013,1,77,0)
 
"BLD",5013,1,78,0)
4. Select the "Orderable Items Records Validation" option.
"BLD",5013,1,79,0)
 
"BLD",5013,1,80,0)
5. The user will be presented with a screen with a brief description of 
"BLD",5013,1,81,0)
the option's functionality. At the "Do you wish to run this program? 
"BLD",5013,1,82,0)
Enter Yes or No?" prompt enter Y for yes. Entering N for No will return 
"BLD",5013,1,83,0)
the user to the menu.
"BLD",5013,1,84,0)
 
"BLD",5013,1,85,0)
6. The user will be prompted for a device for the utilities output. The 
"BLD",5013,1,86,0)
output can be sent to the terminal screen. A printer for hard copy can be 
"BLD",5013,1,87,0)
selected. This is recommended. It can be queued to the Kernel Spool and 
"BLD",5013,1,88,0)
set to run at a preferred later time. 
"BLD",5013,1,89,0)
 
"BLD",5013,1,90,0)
ROUTINE SUMMARY:
"BLD",5013,1,91,0)
================
"BLD",5013,1,92,0)
The following routines are included in this patch.  The second line of 
"BLD",5013,1,93,0)
each of these routines now looks like:
"BLD",5013,1,94,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**[Patch List]**;Dec 17, 1997
"BLD",5013,1,95,0)
 
"BLD",5013,1,96,0)
Routine name    Before Patch    After Patch        Patch List
"BLD",5013,1,97,0)
============    ============    ===========        ==========
"BLD",5013,1,98,0)
OREORV                   N/A       4346077             217
"BLD",5013,1,99,0)
OREORV1                  N/A       3985270             217
"BLD",5013,1,100,0)
OREORV2                  N/A       8511634             217
"BLD",5013,1,101,0)
 
"BLD",5013,1,102,0)
Installation Instructions:
"BLD",5013,1,103,0)
==========================
"BLD",5013,1,104,0)
This patch should be loaded during non-peak hours to minimize disruption 
"BLD",5013,1,105,0)
to users. Installation should take less than 2 minutes. Users are allowed 
"BLD",5013,1,106,0)
to be on the system during the installation. TaskMan does not need to be 
"BLD",5013,1,107,0)
stopped.
"BLD",5013,1,108,0)
 
"BLD",5013,1,109,0)
1. Use the INSTALL/CHECK MESSAGE option on the PackMan menu.
"BLD",5013,1,110,0)
 
"BLD",5013,1,111,0)
2. From the Kernel Installation and Distribution System Menu, select the 
"BLD",5013,1,112,0)
Installation menu.
"BLD",5013,1,113,0)
 
"BLD",5013,1,114,0)
3. From this menu, you may elect to use the following options (when 
"BLD",5013,1,115,0)
prompted for INSTALL NAME, enter OR*3.0*217):
"BLD",5013,1,116,0)
    a. Backup a Transport Global
"BLD",5013,1,117,0)
    b. Compare Transport Global to Current System
"BLD",5013,1,118,0)
    c. Verify Checksums in Transport Global
"BLD",5013,1,119,0)
 
"BLD",5013,1,120,0)
4. Use the Install Package(s) options and select the package OR*3.0*217.
"BLD",5013,1,121,0)
 
"BLD",5013,1,122,0)
5. When prompted 'Want KIDS to INHIBIT LOGONS during install? YES//', 
"BLD",5013,1,123,0)
respond "NO".
"BLD",5013,1,124,0)
 
"BLD",5013,1,125,0)
6. When prompted 'Want to DISABLE Scheduled Options, Menu Options and 
"BLD",5013,1,126,0)
Protocols? YES//', respond "NO".
"BLD",5013,4,0)
^9.64PA^^
"BLD",5013,"ABPKG")
n
"BLD",5013,"KRN",0)
^9.67PA^8989.52^19
"BLD",5013,"KRN",.4,0)
.4
"BLD",5013,"KRN",.401,0)
.401
"BLD",5013,"KRN",.402,0)
.402
"BLD",5013,"KRN",.403,0)
.403
"BLD",5013,"KRN",.5,0)
.5
"BLD",5013,"KRN",.84,0)
.84
"BLD",5013,"KRN",3.6,0)
3.6
"BLD",5013,"KRN",3.8,0)
3.8
"BLD",5013,"KRN",9.2,0)
9.2
"BLD",5013,"KRN",9.8,0)
9.8
"BLD",5013,"KRN",9.8,"NM",0)
^9.68A^3^3
"BLD",5013,"KRN",9.8,"NM",1,0)
OREORV^^0^B16733622
"BLD",5013,"KRN",9.8,"NM",2,0)
OREORV1^^0^B23092409
"BLD",5013,"KRN",9.8,"NM",3,0)
OREORV2^^0^B58604205
"BLD",5013,"KRN",9.8,"NM","B","OREORV",1)

"BLD",5013,"KRN",9.8,"NM","B","OREORV1",2)

"BLD",5013,"KRN",9.8,"NM","B","OREORV2",3)

"BLD",5013,"KRN",19,0)
19
"BLD",5013,"KRN",19,"NM",0)
^9.68A^2^2
"BLD",5013,"KRN",19,"NM",1,0)
ORE ORDERABLE ITEMS VALIDATION^^0
"BLD",5013,"KRN",19,"NM",2,0)
ORE MGR^^2
"BLD",5013,"KRN",19,"NM","B","ORE MGR",2)

"BLD",5013,"KRN",19,"NM","B","ORE ORDERABLE ITEMS VALIDATION",1)

"BLD",5013,"KRN",19.1,0)
19.1
"BLD",5013,"KRN",19.1,"NM",0)
^9.68A^^
"BLD",5013,"KRN",101,0)
101
"BLD",5013,"KRN",409.61,0)
409.61
"BLD",5013,"KRN",771,0)
771
"BLD",5013,"KRN",870,0)
870
"BLD",5013,"KRN",8989.51,0)
8989.51
"BLD",5013,"KRN",8989.52,0)
8989.52
"BLD",5013,"KRN",8994,0)
8994
"BLD",5013,"KRN","B",.4,.4)

"BLD",5013,"KRN","B",.401,.401)

"BLD",5013,"KRN","B",.402,.402)

"BLD",5013,"KRN","B",.403,.403)

"BLD",5013,"KRN","B",.5,.5)

"BLD",5013,"KRN","B",.84,.84)

"BLD",5013,"KRN","B",3.6,3.6)

"BLD",5013,"KRN","B",3.8,3.8)

"BLD",5013,"KRN","B",9.2,9.2)

"BLD",5013,"KRN","B",9.8,9.8)

"BLD",5013,"KRN","B",19,19)

"BLD",5013,"KRN","B",19.1,19.1)

"BLD",5013,"KRN","B",101,101)

"BLD",5013,"KRN","B",409.61,409.61)

"BLD",5013,"KRN","B",771,771)

"BLD",5013,"KRN","B",870,870)

"BLD",5013,"KRN","B",8989.51,8989.51)

"BLD",5013,"KRN","B",8989.52,8989.52)

"BLD",5013,"KRN","B",8994,8994)

"BLD",5013,"QUES",0)
^9.62^^
"BLD",5013,"REQB",0)
^9.611^^0
"KRN",19,5346,-1)
2^2
"KRN",19,5346,0)
ORE MGR^CPRS Clean-up Utilities^^M^5^XUPROG^^^^^^
"KRN",19,5346,10,0)
^19.01IP^5^2
"KRN",19,5346,10,5,0)
9455^OI^40
"KRN",19,5346,10,5,"^")
ORE ORDERABLE ITEMS VALIDATION
"KRN",19,5346,"U")
CPRS CLEAN-UP UTILITIES
"KRN",19,9455,-1)
0^1
"KRN",19,9455,0)
ORE ORDERABLE ITEMS VALIDATION^Orderable Items Records Validation^^R^^^^^^^^ORDER ENTRY/RESULTS REPORTING
"KRN",19,9455,1,0)
^^21^21^3040413^
"KRN",19,9455,1,1,0)
A utility to scan the Orderable Items file and confirm the records in 
"KRN",19,9455,1,2,0)
this file have matching source file records. The source files checked for 
"KRN",19,9455,1,3,0)
are documented in the OE/RR Version 3 Package Interface Specifications 
"KRN",19,9455,1,4,0)
July, 2001 document. This utility creates a report documenting the 
"KRN",19,9455,1,5,0)
following:
"KRN",19,9455,1,6,0)
        1. Orderable Item records without a source IEN stored in the ID 
"KRN",19,9455,1,7,0)
           field.
"KRN",19,9455,1,8,0)
        2. Orderable Item records without a source Package code stored 
"KRN",19,9455,1,9,0)
           in the ID field.
"KRN",19,9455,1,10,0)
        3. Orderable Item records with an improperly formatted source
"KRN",19,9455,1,11,0)
           Package code in the ID field.
"KRN",19,9455,1,12,0)
        4. Gives a summary of valid records by package.
"KRN",19,9455,1,13,0)
        5. Gives a detail of records without matching source records 
"KRN",19,9455,1,14,0)
           sorted by:
"KRN",19,9455,1,15,0)
                5.1 Currently active records, will be flagged as 
"KRN",19,9455,1,16,0)
                    inactive, and subsorted by package.
"KRN",19,9455,1,17,0)
                5.2 Currently inactive records and subsorted by package.
"KRN",19,9455,1,18,0)
        6. A list of records with properly created ID field, but the 
"KRN",19,9455,1,19,0)
           package code is not on the package list in the Package 
"KRN",19,9455,1,20,0)
           Interface Specifications of July 2001. These will be listed as 
"KRN",19,9455,1,21,0)
           needing manual confirmation.
"KRN",19,9455,25)
OREORV
"KRN",19,9455,"U")
ORDERABLE ITEMS RECORDS VALIDA
"MBREQ")
0
"ORD",18,19)
19;18;;;OPT^XPDTA;OPTF1^XPDIA;OPTE1^XPDIA;OPTF2^XPDIA;;OPTDEL^XPDIA
"ORD",18,19,0)
OPTION
"PKG",110,-1)
1^1
"PKG",110,0)
ORDER ENTRY/RESULTS REPORTING^OR^Order Entry/Results Reporting
"PKG",110,20,0)
^9.402P^^
"PKG",110,22,0)
^9.49I^1^1
"PKG",110,22,1,0)
3.0^2971217
"PKG",110,22,1,"PAH",1,0)
217^3041029
"PKG",110,22,1,"PAH",1,1,0)
^^126^126^3041029
"PKG",110,22,1,"PAH",1,1,1,0)
Patch Description:
"PKG",110,22,1,"PAH",1,1,2,0)
==================
"PKG",110,22,1,"PAH",1,1,3,0)
This patch provides a utility, consisting of a set of three routines, to 
"PKG",110,22,1,"PAH",1,1,4,0)
find records in the ORDERABLE ITEM FILE # 101.43 which do not have 
"PKG",110,22,1,"PAH",1,1,5,0)
matching records in their source files. It will flag any active Orderable 
"PKG",110,22,1,"PAH",1,1,6,0)
Item record without a matching source record as inactive and print a 
"PKG",110,22,1,"PAH",1,1,7,0)
detailed report of its findings.
"PKG",110,22,1,"PAH",1,1,8,0)
 
"PKG",110,22,1,"PAH",1,1,9,0)
The issue is an active orderable item record that does not have a 
"PKG",110,22,1,"PAH",1,1,10,0)
matching source record. To address this issue a utility has been written 
"PKG",110,22,1,"PAH",1,1,11,0)
that will perform an analysis of the ORDERABLE ITEM FILE, file # 101.43, 
"PKG",110,22,1,"PAH",1,1,12,0)
and produce a detailed report of its findings. This utility will scan the 
"PKG",110,22,1,"PAH",1,1,13,0)
the ORDERABLE ITEM FILE record by record. This utility  determines the 
"PKG",110,22,1,"PAH",1,1,14,0)
following about the current ORDBERABLE ITEM FILE record being processed:
"PKG",110,22,1,"PAH",1,1,15,0)
 
"PKG",110,22,1,"PAH",1,1,16,0)
1. Is the ID field null?
"PKG",110,22,1,"PAH",1,1,17,0)
 
"PKG",110,22,1,"PAH",1,1,18,0)
2. Is the source record IEN stored in the ID field null?
"PKG",110,22,1,"PAH",1,1,19,0)
 
"PKG",110,22,1,"PAH",1,1,20,0)
3. Is the source record package code stored in the ID field null?
"PKG",110,22,1,"PAH",1,1,21,0)
 
"PKG",110,22,1,"PAH",1,1,22,0)
4. Is the data stored in the ID field properly formatted?
"PKG",110,22,1,"PAH",1,1,23,0)
 
"PKG",110,22,1,"PAH",1,1,24,0)
5. Is the source record package code part of the current interface 
"PKG",110,22,1,"PAH",1,1,25,0)
specification?
"PKG",110,22,1,"PAH",1,1,26,0)
 
"PKG",110,22,1,"PAH",1,1,27,0)
6. Is there a matching source record?
"PKG",110,22,1,"PAH",1,1,28,0)
 
"PKG",110,22,1,"PAH",1,1,29,0)
7. Is it currently flagged as active?
"PKG",110,22,1,"PAH",1,1,30,0)
 
"PKG",110,22,1,"PAH",1,1,31,0)
A temporary global is build tracking all of the above for a detailed 
"PKG",110,22,1,"PAH",1,1,32,0)
report. Only an ORDERABLE ITEM FILE record passing all tests is modified.
"PKG",110,22,1,"PAH",1,1,33,0)
At this point it will be flagged as inactive effective immediately. After
"PKG",110,22,1,"PAH",1,1,34,0)
the utility has printed its report the temporary global created by this
"PKG",110,22,1,"PAH",1,1,35,0)
utility is deleted. The utility is to be run at any time the null
"PKG",110,22,1,"PAH",1,1,36,0)
subscript error is encountered during the ordering process.
"PKG",110,22,1,"PAH",1,1,37,0)
 
"PKG",110,22,1,"PAH",1,1,38,0)
It is these invalid orderable items with no matching source records that 
"PKG",110,22,1,"PAH",1,1,39,0)
are generating the NULLSUBSCR errors described in the associated NOIS 
"PKG",110,22,1,"PAH",1,1,40,0)
cases. The flagging of records in the ORDERABLE ITEM FILE # 101.43 
"PKG",110,22,1,"PAH",1,1,41,0)
without matching source records as inactive will prevent CPRS GUI from 
"PKG",110,22,1,"PAH",1,1,42,0)
presenting them to the user as valid orderable items. The routines in 
"PKG",110,22,1,"PAH",1,1,43,0)
this patch can be run anytime a selected orderable item generates the 
"PKG",110,22,1,"PAH",1,1,44,0)
NULLSUBSCR error.
"PKG",110,22,1,"PAH",1,1,45,0)
 
"PKG",110,22,1,"PAH",1,1,46,0)
Associated NOIS:
"PKG",110,22,1,"PAH",1,1,47,0)
================
"PKG",110,22,1,"PAH",1,1,48,0)
1. ALB-1001-51034 - UNDEF VAR LOAD+6~ORWDLR32
"PKG",110,22,1,"PAH",1,1,49,0)
2. DAN-0204-42157 - Error on Order of Lab Test
"PKG",110,22,1,"PAH",1,1,50,0)
3. NJH-0402-20607 - Receiving error message in CPRS
"PKG",110,22,1,"PAH",1,1,51,0)
4. SBY-0803-30443 - LOAD+4~ORWDLR32:1,%DSM-E-NULLSUBSCR
"PKG",110,22,1,"PAH",1,1,52,0)
 
"PKG",110,22,1,"PAH",1,1,53,0)
OPTIONS
"PKG",110,22,1,"PAH",1,1,54,0)
=======
"PKG",110,22,1,"PAH",1,1,55,0)
 
"PKG",110,22,1,"PAH",1,1,56,0)
CPRS Clean-up Utilities menu (ORE MGR, a menu option) was modified. A new 
"PKG",110,22,1,"PAH",1,1,57,0)
option was added to it.
"PKG",110,22,1,"PAH",1,1,58,0)
 
"PKG",110,22,1,"PAH",1,1,59,0)
Orderable Items Records Validation (ORE ORDERABLE ITEMS VALIDATION, a run 
"PKG",110,22,1,"PAH",1,1,60,0)
routine option) was created. It has been added to the CPRS Clean-up 
"PKG",110,22,1,"PAH",1,1,61,0)
Utilities menu.
"PKG",110,22,1,"PAH",1,1,62,0)
 
"PKG",110,22,1,"PAH",1,1,63,0)
The menu path to the new option is:
"PKG",110,22,1,"PAH",1,1,64,0)
        CPRS Manger Menu
"PKG",110,22,1,"PAH",1,1,65,0)
        CPRS Configuration (IRM) - IR
"PKG",110,22,1,"PAH",1,1,66,0)
        CPRS Clean-up Utilities - UT
"PKG",110,22,1,"PAH",1,1,67,0)
        Orderable Items Records Validation - OI
"PKG",110,22,1,"PAH",1,1,68,0)
 
"PKG",110,22,1,"PAH",1,1,69,0)
HOW TO RUN THE UTILITY:
"PKG",110,22,1,"PAH",1,1,70,0)
=======================
"PKG",110,22,1,"PAH",1,1,71,0)
 
"PKG",110,22,1,"PAH",1,1,72,0)
1. Enter the "CPRS Manager Menu".
"PKG",110,22,1,"PAH",1,1,73,0)
 
"PKG",110,22,1,"PAH",1,1,74,0)
2. Select the "CPRS Configuration (IRM)" option.
"PKG",110,22,1,"PAH",1,1,75,0)
 
"PKG",110,22,1,"PAH",1,1,76,0)
3. Select the "CPRS Clean-up Utilities" option.
"PKG",110,22,1,"PAH",1,1,77,0)
 
"PKG",110,22,1,"PAH",1,1,78,0)
4. Select the "Orderable Items Records Validation" option.
"PKG",110,22,1,"PAH",1,1,79,0)
 
"PKG",110,22,1,"PAH",1,1,80,0)
5. The user will be presented with a screen with a brief description of 
"PKG",110,22,1,"PAH",1,1,81,0)
the option's functionality. At the "Do you wish to run this program? 
"PKG",110,22,1,"PAH",1,1,82,0)
Enter Yes or No?" prompt enter Y for yes. Entering N for No will return 
"PKG",110,22,1,"PAH",1,1,83,0)
the user to the menu.
"PKG",110,22,1,"PAH",1,1,84,0)
 
"PKG",110,22,1,"PAH",1,1,85,0)
6. The user will be prompted for a device for the utilities output. The 
"PKG",110,22,1,"PAH",1,1,86,0)
output can be sent to the terminal screen. A printer for hard copy can be 
"PKG",110,22,1,"PAH",1,1,87,0)
selected. This is recommended. It can be queued to the Kernel Spool and 
"PKG",110,22,1,"PAH",1,1,88,0)
set to run at a preferred later time. 
"PKG",110,22,1,"PAH",1,1,89,0)
 
"PKG",110,22,1,"PAH",1,1,90,0)
ROUTINE SUMMARY:
"PKG",110,22,1,"PAH",1,1,91,0)
================
"PKG",110,22,1,"PAH",1,1,92,0)
The following routines are included in this patch.  The second line of 
"PKG",110,22,1,"PAH",1,1,93,0)
each of these routines now looks like:
"PKG",110,22,1,"PAH",1,1,94,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**[Patch List]**;Dec 17, 1997
"PKG",110,22,1,"PAH",1,1,95,0)
 
"PKG",110,22,1,"PAH",1,1,96,0)
Routine name    Before Patch    After Patch        Patch List
"PKG",110,22,1,"PAH",1,1,97,0)
============    ============    ===========        ==========
"PKG",110,22,1,"PAH",1,1,98,0)
OREORV                   N/A       4346077             217
"PKG",110,22,1,"PAH",1,1,99,0)
OREORV1                  N/A       3985270             217
"PKG",110,22,1,"PAH",1,1,100,0)
OREORV2                  N/A       8511634             217
"PKG",110,22,1,"PAH",1,1,101,0)
 
"PKG",110,22,1,"PAH",1,1,102,0)
Installation Instructions:
"PKG",110,22,1,"PAH",1,1,103,0)
==========================
"PKG",110,22,1,"PAH",1,1,104,0)
This patch should be loaded during non-peak hours to minimize disruption 
"PKG",110,22,1,"PAH",1,1,105,0)
to users. Installation should take less than 2 minutes. Users are allowed 
"PKG",110,22,1,"PAH",1,1,106,0)
to be on the system during the installation. TaskMan does not need to be 
"PKG",110,22,1,"PAH",1,1,107,0)
stopped.
"PKG",110,22,1,"PAH",1,1,108,0)
 
"PKG",110,22,1,"PAH",1,1,109,0)
1. Use the INSTALL/CHECK MESSAGE option on the PackMan menu.
"PKG",110,22,1,"PAH",1,1,110,0)
 
"PKG",110,22,1,"PAH",1,1,111,0)
2. From the Kernel Installation and Distribution System Menu, select the 
"PKG",110,22,1,"PAH",1,1,112,0)
Installation menu.
"PKG",110,22,1,"PAH",1,1,113,0)
 
"PKG",110,22,1,"PAH",1,1,114,0)
3. From this menu, you may elect to use the following options (when 
"PKG",110,22,1,"PAH",1,1,115,0)
prompted for INSTALL NAME, enter OR*3.0*217):
"PKG",110,22,1,"PAH",1,1,116,0)
    a. Backup a Transport Global
"PKG",110,22,1,"PAH",1,1,117,0)
    b. Compare Transport Global to Current System
"PKG",110,22,1,"PAH",1,1,118,0)
    c. Verify Checksums in Transport Global
"PKG",110,22,1,"PAH",1,1,119,0)
 
"PKG",110,22,1,"PAH",1,1,120,0)
4. Use the Install Package(s) options and select the package OR*3.0*217.
"PKG",110,22,1,"PAH",1,1,121,0)
 
"PKG",110,22,1,"PAH",1,1,122,0)
5. When prompted 'Want KIDS to INHIBIT LOGONS during install? YES//', 
"PKG",110,22,1,"PAH",1,1,123,0)
respond "NO".
"PKG",110,22,1,"PAH",1,1,124,0)
 
"PKG",110,22,1,"PAH",1,1,125,0)
6. When prompted 'Want to DISABLE Scheduled Options, Menu Options and 
"PKG",110,22,1,"PAH",1,1,126,0)
Protocols? YES//', respond "NO".
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
3
"RTN","OREORV")
0^1^B16733622
"RTN","OREORV",1,0)
OREORV ; SLC/GDU - Orderable Items File Record Validation [10/15/04 09:16]
"RTN","OREORV",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**217**;Dec 17, 1997
"RTN","OREORV",3,0)
 ;OREORV - Orderable Item Record Validation
"RTN","OREORV",4,0)
 ;
"RTN","OREORV",5,0)
 ;FIX FOR NOIS CASES:
"RTN","OREORV",6,0)
 ;DAN-0204-42157, ALB-1001-51034, SBY-0803-30443, NJH-0402-20607
"RTN","OREORV",7,0)
 ;
"RTN","OREORV",8,0)
 ;Presents the user with an explanation of the purpose of this program.
"RTN","OREORV",9,0)
 ;It will ask the user if they wish to run the OI record validation.
"RTN","OREORV",10,0)
 ;Allows the user to select where the output of the report is sent to.
"RTN","OREORV",11,0)
 ;Also allows the user to queue the program run to TASKMAN.
"RTN","OREORV",12,0)
 ;
"RTN","OREORV",13,0)
 ;External Variables
"RTN","OREORV",14,0)
 ;  IO  - Selected IO device
"RTN","OREORV",15,0)
 ;  IOF - IO device Form Feed
"RTN","OREORV",16,0)
 ;  ION - IO device logical name
"RTN","OREORV",17,0)
 ;
"RTN","OREORV",18,0)
 ;External References
"RTN","OREORV",19,0)
 ;  ^%ZIS    - DBIA 10086
"RTN","OREORV",20,0)
 ;  ^%ZISC   - DBIA 10089
"RTN","OREORV",21,0)
 ;  ^%ZTLOAD - DBIA 10063
"RTN","OREORV",22,0)
 ;  ^DIR     - DBIA 10026
"RTN","OREORV",23,0)
 ;  ^OREORV1 - Second routine of this utility
"RTN","OREORV",24,0)
 ;  ^OREORV2 - Third routine of this utility
"RTN","OREORV",25,0)
 ;
"RTN","OREORV",26,0)
MAIN ;Main entry point for this program
"RTN","OREORV",27,0)
 ;Local Variables
"RTN","OREORV",28,0)
 ;  %ZIS   - Input specification variable, ^%ZIS
"RTN","OREORV",29,0)
 ;  DIR    - Input array variable for ^DIR
"RTN","OREORV",30,0)
 ;  DLI    - Description Line Index
"RTN","OREORV",31,0)
 ;  DL     - Description Line, indirect variable
"RTN","OREORV",32,0)
 ;  DTOUT  - Time out indicator, output variable ^DIR
"RTN","OREORV",33,0)
 ;  DUOUT  - Up arrow out indicator, output variable ^DIR
"RTN","OREORV",34,0)
 ;  PLI    - Prompt Line Index
"RTN","OREORV",35,0)
 ;  PL     - Prompt Line, indirect variable
"RTN","OREORV",36,0)
 ;  POP    - Exit Status, output variable ^%ZIS
"RTN","OREORV",37,0)
 ;  ZTDESC - Task Description, input variable ^%ZTLOAD
"RTN","OREORV",38,0)
 ;  ZTIO   - Task IO device, input variable ^%ZTLOAD
"RTN","OREORV",39,0)
 ;  ZTRTN  - Task routine entry point, input variable ^%ZTLOAD
"RTN","OREORV",40,0)
 ;  ZTSK   - Task number assigned, output variable ^%ZTLOAD
"RTN","OREORV",41,0)
 ;  Y      - Processed user input, output variable ^DIR
"RTN","OREORV",42,0)
 N %ZIS,DIR,DLI,DL,DTOUT,DUOUT,PLI,PL,POP,ZTDESC,ZTIO,ZTRTN,ZTSK,Y
"RTN","OREORV",43,0)
 ;Clears screen and presents explanation, asks if user wants to continue
"RTN","OREORV",44,0)
 W:$D(IOF) @IOF
"RTN","OREORV",45,0)
 W $P($T(SH),";",3),!
"RTN","OREORV",46,0)
 F DLI=1:1:19 S DL="DL"_DLI W !,$P($T(@DL),";",3)
"RTN","OREORV",47,0)
 S DIR(0)="Y",DIR("A")=$P($T(PMT1),";",3)
"RTN","OREORV",48,0)
 W ! D ^DIR
"RTN","OREORV",49,0)
 ;If user selects No, up-arrows out, or times out program is stopped
"RTN","OREORV",50,0)
 I Y=0!($D(DTOUT))!($D(DUOUT)) G EXIT
"RTN","OREORV",51,0)
 ;If user selects Yes, programs presents user with device selection.
"RTN","OREORV",52,0)
 W:$D(IOF) @IOF
"RTN","OREORV",53,0)
 W $P($T(SH),";",3),!
"RTN","OREORV",54,0)
 F PLI=1:1:6 S PL="PL"_PLI W !,$P($T(@PL),";",3)
"RTN","OREORV",55,0)
 W !
"RTN","OREORV",56,0)
 S %ZIS="Q" D ^%ZIS
"RTN","OREORV",57,0)
 ;Processing user device selection
"RTN","OREORV",58,0)
 I POP G EXIT
"RTN","OREORV",59,0)
 I $D(IO("Q")) D  K IO("Q") G EXIT
"RTN","OREORV",60,0)
 . S ZTDESC="Orderable Item Validation Report"
"RTN","OREORV",61,0)
 . S ZTRTN="EN^OREORV"
"RTN","OREORV",62,0)
 . S ZTIO=ION
"RTN","OREORV",63,0)
 . D ^%ZTLOAD I $D(ZTSK) W !?32,"REQUEST QUEUED"
"RTN","OREORV",64,0)
 U IO D EN
"RTN","OREORV",65,0)
EXIT ;Exit point for this program
"RTN","OREORV",66,0)
 D ^%ZISC
"RTN","OREORV",67,0)
 Q
"RTN","OREORV",68,0)
EN ;Process the File 101.43
"RTN","OREORV",69,0)
 ;TASKMAN entry point
"RTN","OREORV",70,0)
 ;^TMP($J,"OIC" is fully documented in OREORV1
"RTN","OREORV",71,0)
 K ^TMP($J,"OIC")
"RTN","OREORV",72,0)
 ;Builds temp global ^TMP($J,"OIC", flags active OI records w/o matching
"RTN","OREORV",73,0)
 ;source records.
"RTN","OREORV",74,0)
 D ^OREORV1
"RTN","OREORV",75,0)
 ;Print report from contents of ^TMP($J,"OIC"
"RTN","OREORV",76,0)
 D ^OREORV2
"RTN","OREORV",77,0)
 K ^TMP($J,"OIC")
"RTN","OREORV",78,0)
 Q
"RTN","OREORV",79,0)
 ;User interface text
"RTN","OREORV",80,0)
SH ;;Orderable Items File Record Validation
"RTN","OREORV",81,0)
DL1 ;;Brief Description:
"RTN","OREORV",82,0)
DL2 ;;This program scans the Orderable Items file, file # 101.43.
"RTN","OREORV",83,0)
DL3 ;;It take the value stored in the ID field and performs a set of tests.
"RTN","OREORV",84,0)
DL4 ;;
"RTN","OREORV",85,0)
DL5 ;;   1. It determines if the ID field is null.
"RTN","OREORV",86,0)
DL6 ;;   2. It determines if it has a source record IEN
"RTN","OREORV",87,0)
DL7 ;;   3. It determines if it has a source record package code
"RTN","OREORV",88,0)
DL8 ;;   4. It determines if the package code is formatted properly
"RTN","OREORV",89,0)
DL9 ;;   5. It determines if the package code is in the current spec*
"RTN","OREORV",90,0)
DL10 ;;      If package code is not in current spec*, it is included in the
"RTN","OREORV",91,0)
DL11 ;;      report for manual confirmation. It is not modified by this
"RTN","OREORV",92,0)
DL12 ;;      utility.
"RTN","OREORV",93,0)
DL13 ;;   6. It Validates records by matching to a source file record
"RTN","OREORV",94,0)
DL14 ;;      If no match found and record is active it is flagged inactive.
"RTN","OREORV",95,0)
DL15 ;;   7. It creates a report detailing its findings.
"RTN","OREORV",96,0)
DL16 ;;
"RTN","OREORV",97,0)
DL17 ;;* The source files the orderable item record is tested against are
"RTN","OREORV",98,0)
DL18 ;;defined in the OE/RR Version 3 Package Interface Specification July
"RTN","OREORV",99,0)
DL19 ;;2001
"RTN","OREORV",100,0)
PMT1 ;;Do you wish to run this program? Enter Yes or No
"RTN","OREORV",101,0)
PL1 ;;Select where you want the report to print to.
"RTN","OREORV",102,0)
PL2 ;;
"RTN","OREORV",103,0)
PL3 ;;Just hit enter to send the report to the screen.
"RTN","OREORV",104,0)
PL4 ;;Enter the name of the printer.
"RTN","OREORV",105,0)
PL5 ;;Queue the program to run at a later time.
"RTN","OREORV",106,0)
PL6 ;;Enter "^" to quit
"RTN","OREORV1")
0^2^B23092409
"RTN","OREORV1",1,0)
OREORV1 ; SLC/GDU - Orderable Items Records Validation [10/15/04 09:16]
"RTN","OREORV1",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**217**;Dec 17,1997
"RTN","OREORV1",3,0)
 ;OREORV1 - Orderable Items Record Validation
"RTN","OREORV1",4,0)
 ;
"RTN","OREORV1",5,0)
 ;BUG FIX FOR NOIS CASES:
"RTN","OREORV1",6,0)
 ;DAN-0204-42157, ALB-1001-51034, SBY-0803-30443, NJH-0402-20607
"RTN","OREORV1",7,0)
 ;
"RTN","OREORV1",8,0)
 ;Scans the ^ORD(101.43, file and does the following:
"RTN","OREORV1",9,0)
 ;  1. Counts the total number of entries in ^ORD(101.43,
"RTN","OREORV1",10,0)
 ;  2. Determines if a source record ien is stored in the ID field of
"RTN","OREORV1",11,0)
 ;     file 101.43.
"RTN","OREORV1",12,0)
 ;  3. Determines if a package code is stored in the ID field of file
"RTN","OREORV1",13,0)
 ;     101.43.
"RTN","OREORV1",14,0)
 ;  4. Determines if the package code matches the expected pattern of 
"RTN","OREORV1",15,0)
 ;     99XXX (XXX are 3 upper case letters).
"RTN","OREORV1",16,0)
 ;  5. Using the interface standard (documented in OE/RR V3 Package
"RTN","OREORV1",17,0)
 ;     Interface Specifications, July 2001) it determines if the
"RTN","OREORV1",18,0)
 ;     package code is one that it can test for. If it can not be tested
"RTN","OREORV1",19,0)
 ;     for it is considered requiring manual confirmation. It counts the
"RTN","OREORV1",20,0)
 ;     number of OI records needing manual confirmation, subtotaled by
"RTN","OREORV1",21,0)
 ;     package.
"RTN","OREORV1",22,0)
 ;  6. If the OI record can be tested for a source record and one is
"RTN","OREORV1",23,0)
 ;     found it is considered validated. It counts the number of
"RTN","OREORV1",24,0)
 ;      validated OI records and gives subtotals by package. 
"RTN","OREORV1",25,0)
 ;  7. If the OI record can be tested for a source record and one is not
"RTN","OREORV1",26,0)
 ;     found it is considered invalid. It counts the number of OI records
"RTN","OREORV1",27,0)
 ;     considered invalid. It subtotals by the active flag. It subtotals
"RTN","OREORV1",28,0)
 ;     by package. It will flag active records as inactive effective
"RTN","OREORV1",29,0)
 ;     immediately.
"RTN","OREORV1",30,0)
 ;
"RTN","OREORV1",31,0)
 ;This routine builds the temp global ^TMP($J,"OIC"
"RTN","OREORV1",32,0)
 ;All of this information is written to a temporary global.
"RTN","OREORV1",33,0)
 ;This is its structure:
"RTN","OREORV1",34,0)
 ;$J    - The M system variable for job number
"RTN","OREORV1",35,0)
 ;OIC   - Orderable Item Check
"RTN","OREORV1",36,0)
 ;OIIEN - Orderable Item Internal Entry Number
"RTN","OREORV1",37,0)
 ;OIIF  - Orderable Item Inactive Flag
"RTN","OREORV1",38,0)
 ;OIN   - Orderable Item Name
"RTN","OREORV1",39,0)
 ;OIPC  - Orderable Item OIPC
"RTN","OREORV1",40,0)
 ;Note all totals are calculated at run time.
"RTN","OREORV1",41,0)
 ;^TMP($J,"OIC",0)=Total records processed
"RTN","OREORV1",42,0)
 ;^TMP($J,"OIC",1)=Total records with null ID field
"RTN","OREORV1",43,0)
 ;^TMP($J,"OIC",1,OIIEN)=Null
"RTN","OREORV1",44,0)
 ;^TMP($J,"OIC",1,"B",OIN)=OIIEN^OIIF
"RTN","OREORV1",45,0)
 ;^TMP($J,"OIC",2)=Total records with null source IENs
"RTN","OREORV1",46,0)
 ;^TMP($J,"OIC",2,OIIEN)=Null
"RTN","OREORV1",47,0)
 ;^TMP($J,"OIC",2,"B",OIN)=OIIEN^OIIF
"RTN","OREORV1",48,0)
 ;^TMP($J,"OIC",3)=Total records with null source package codes
"RTN","OREORV1",49,0)
 ;^TMP($J,"OIC",3,OIIEN)=Null
"RTN","OREORV1",50,0)
 ;^TMP($J,"OIC",3,"B",OIN)=OIIEN^OIIF
"RTN","OREORV1",51,0)
 ;^TMP($J,"OIC",4)=Total records with bad source package codes
"RTN","OREORV1",52,0)
 ;^TMP($J,"OIC",4,OIPC)=Total by package
"RTN","OREORV1",53,0)
 ;^TMP($J,"OIC",4,OIPC,OIIEN)=Null
"RTN","OREORV1",54,0)
 ;^TMP($J,"OIC",4,OIPC,"B",OIN)=OIIEN^OIIF
"RTN","OREORV1",55,0)
 ;^TMP($J,"OIC",5)=Total records not part of current specification
"RTN","OREORV1",56,0)
 ;^TMP($J,"OIC",5,OIPC)=Total by package code
"RTN","OREORV1",57,0)
 ;^TMP($J,"OIC",5,OIPC,OIIEN)=Null
"RTN","OREORV1",58,0)
 ;^TMP($J,"OIC",5,OIPC,"B",OIN)= OIIEN^OIIF
"RTN","OREORV1",59,0)
 ;^TMP($J,"OIC",6)=Total validated records
"RTN","OREORV1",60,0)
 ;^TMP($J,"OIC",6,OIPC)=Total by package code
"RTN","OREORV1",61,0)
 ;^TMP($J,"OIC",7)=Total records with no matching source records
"RTN","OREORV1",62,0)
 ;^TMP($J,"OIC",7,"A")=Total active records
"RTN","OREORV1",63,0)
 ;^TMP($J,"OIC",7,"A",OIPC)=Total by package code
"RTN","OREORV1",64,0)
 ;^TMP($J,"OIC",7,"A",OIPC,OIIEN)=Null
"RTN","OREORV1",65,0)
 ;^TMP($J,"OIC",7,"A",OIPC,"B",OIN)= OIIEN^OIIF
"RTN","OREORV1",66,0)
 ;^TMP($J,"OIC",7,"I")=Total inactive records
"RTN","OREORV1",67,0)
 ;^TMP($J,"OIC",7,"I",OIPC)=Total by package code
"RTN","OREORV1",68,0)
 ;^TMP($J,"OIC",7,"I",OIPC,OIIEN)=Null
"RTN","OREORV1",69,0)
 ;^TMP($J,"OIC",7,"I",OIPC,"B",OIN)= OIIEN^OIIF
"RTN","OREORV1",70,0)
 ;
"RTN","OREORV1",71,0)
 ;External References
"RTN","OREORV1",72,0)
 ;  $$FIND1^DIC    DBIA 2051
"RTN","OREORV1",73,0)
 ;  UPDATE^DIE     DBIA 2053
"RTN","OREORV1",74,0)
 ;  FDA^DILF       DBIA 2054
"RTN","OREORV1",75,0)
 ;  $$GET1^DIQ     DBIA 2056
"RTN","OREORV1",76,0)
 ;
"RTN","OREORV1",77,0)
OIIDIS ;Orderable Item ID Index Scan
"RTN","OREORV1",78,0)
 ;Scan the ^ORD(101.43 and builds a list of orderable items with no
"RTN","OREORV1",79,0)
 ;match in the source files.
"RTN","OREORV1",80,0)
 ;  ID    - ID, field # 2, from file 101.43
"RTN","OREORV1",81,0)
 ;  IA    - INACTIVATED, field # .1, from file 101.43.
"RTN","OREORV1",82,0)
 ;  IF    - Inactive flag
"RTN","OREORV1",83,0)
 ;          If IA is null then it is set to A for active.
"RTN","OREORV1",84,0)
 ;          If IA is not null then it is set to I for inactive.
"RTN","OREORV1",85,0)
 ;  IEN   - Internal Entry Number of record from file 101.43
"RTN","OREORV1",86,0)
 ;  NAME  - NAME, field # .01, from file 101.43
"RTN","OREORV1",87,0)
 ;  SRIEN - Source Record Internal Entry Number, 1st piece ID
"RTN","OREORV1",88,0)
 ;  SRP   - Source Record Package, 2nd piece ID
"RTN","OREORV1",89,0)
 ;  SRC   - Source Record Check
"RTN","OREORV1",90,0)
 ;          0 - source record does not exist
"RTN","OREORV1",91,0)
 ;          1 - source record exist
"RTN","OREORV1",92,0)
 ;  U     - Fileman, Kernel default delimiter variable, value of "^".
"RTN","OREORV1",93,0)
 ;          U is not newed or deleted.
"RTN","OREORV1",94,0)
 N AF,IA,ID,IF,IEN,NAME,SRIEN,SRP,SRC,X
"RTN","OREORV1",95,0)
 S U="^"
"RTN","OREORV1",96,0)
 K ^TMP($J,"OIC")
"RTN","OREORV1",97,0)
 F X=0:1:7 S ^TMP($J,"OIC",X)=0
"RTN","OREORV1",98,0)
 S IEN=0 F  S IEN=$O(^ORD(101.43,IEN)) Q:'IEN  D
"RTN","OREORV1",99,0)
 . S (ID,IF,NAME,SRIEN,SRP)="",SRC=0
"RTN","OREORV1",100,0)
 . S ^TMP($J,"OIC",0)=$$CI(^TMP($J,"OIC",0))
"RTN","OREORV1",101,0)
 . S NAME=$$GET1^DIQ(101.43,IEN,.01)
"RTN","OREORV1",102,0)
 . S ID=$$GET1^DIQ(101.43,IEN,2)
"RTN","OREORV1",103,0)
 . S IA=$$GET1^DIQ(101.43,IEN,.1)
"RTN","OREORV1",104,0)
 . S IF=$S(IA="":"A",1:"I")
"RTN","OREORV1",105,0)
 . I ID="" D BUILD(1,IEN,ID,IA,IF,NAME,SRP) Q
"RTN","OREORV1",106,0)
 . S SRIEN=$P(ID,";")
"RTN","OREORV1",107,0)
 . S SRP=$P(ID,";",2)
"RTN","OREORV1",108,0)
 . I SRIEN="" D BUILD(2,IEN,ID,IA,IF,NAME,SRP) Q
"RTN","OREORV1",109,0)
 . I SRP="" D BUILD(3,IEN,ID,IA,IF,NAME,SRP) Q
"RTN","OREORV1",110,0)
 . I SRP'?1."99"3U D BUILD(4,IEN,ID,IA,IF,NAME,SRP) Q
"RTN","OREORV1",111,0)
 . I $$PC(SRP)=0 D BUILD(5,IEN,ID,IA,IF,NAME,SRP) Q
"RTN","OREORV1",112,0)
 . S SRC=$$SRC(SRP,SRIEN)
"RTN","OREORV1",113,0)
 . I SRC>0 D BUILD(6,IEN,ID,IA,IF,NAME,SRP) Q
"RTN","OREORV1",114,0)
 . D BUILD(7,IEN,ID,IA,IF,NAME,SRP)
"RTN","OREORV1",115,0)
 Q
"RTN","OREORV1",116,0)
BUILD(NODE,OIIEN,OIID,OIIA,OIIF,OIN,OISRP) ;
"RTN","OREORV1",117,0)
 ;Build the temp OIC global
"RTN","OREORV1",118,0)
 ;Variables passed to BUILD
"RTN","OREORV1",119,0)
 ;  NODE  - Node to be written to
"RTN","OREORV1",120,0)
 ;          1 = ID field is null
"RTN","OREORV1",121,0)
 ;          2 = 1st piece of ID field is null
"RTN","OREORV1",122,0)
 ;          3 = 2nd piece of ID field is null
"RTN","OREORV1",123,0)
 ;          4 = 2nd piece of ID field is not properly formatted
"RTN","OREORV1",124,0)
 ;          5 = 2nd piece of ID field is a package code not
"RTN","OREORV1",125,0)
 ;              part of current interface specification and
"RTN","OREORV1",126,0)
 ;              must be manually validated
"RTN","OREORV1",127,0)
 ;          6 = OI record is considered valid
"RTN","OREORV1",128,0)
 ;          7 = OI record has no matching source record
"RTN","OREORV1",129,0)
 ;  OIIEN - Orderable Item IEN
"RTN","OREORV1",130,0)
 ;  OIID  - Orderable Item ID field
"RTN","OREORV1",131,0)
 ;  OIIA  - Orderable Item INACTIVE field
"RTN","OREORV1",132,0)
 ;  OIIF  - Orderable Item Inactive Flag
"RTN","OREORV1",133,0)
 ;  OIN   - Orderable Item Name
"RTN","OREORV1",134,0)
 ;  OISRP - Orderable Item Source Record Package
"RTN","OREORV1",135,0)
 ;Local variable
"RTN","OREORV1",136,0)
 ;  EM    - Error message returned by FDA^DILF
"RTN","OREORV1",137,0)
 ;  FDA   - FileMan Data Array, output of FDA^DILF, an input
"RTN","OREORV1",138,0)
 ;          array variable for UPDATE^DIE
"RTN","OREORV1",139,0)
 N EM,FDA
"RTN","OREORV1",140,0)
 S ^TMP($J,"OIC",NODE)=$$CI(^TMP($J,"OIC",NODE))
"RTN","OREORV1",141,0)
 I NODE=1!(NODE=2)!(NODE=3) D  Q
"RTN","OREORV1",142,0)
 . S ^TMP($J,"OIC",NODE,OIIEN)=""
"RTN","OREORV1",143,0)
 . S ^TMP($J,"OIC",NODE,"B",OIN)=OIIEN_U_$P(OIIA,"@")
"RTN","OREORV1",144,0)
 I NODE=4!(NODE=5) D  Q
"RTN","OREORV1",145,0)
 . S:$D(^TMP($J,"OIC",NODE,OISRP))=0 ^TMP($J,"OIC",NODE,OISRP)=0
"RTN","OREORV1",146,0)
 . S ^TMP($J,"OIC",NODE,OISRP)=$$CI(^TMP($J,"OIC",NODE,OISRP))
"RTN","OREORV1",147,0)
 . S ^TMP($J,"OIC",NODE,OISRP,OIIEN)=""
"RTN","OREORV1",148,0)
 . S ^TMP($J,"OIC",NODE,OISRP,"B",OIN)=OIIEN_U_$P(OIIA,"@")
"RTN","OREORV1",149,0)
 I NODE=6 D  Q
"RTN","OREORV1",150,0)
 . S:$D(^TMP($J,"OIC",NODE,OISRP))=0 ^TMP($J,"OIC",NODE,OISRP)=0
"RTN","OREORV1",151,0)
 . S ^TMP($J,"OIC",NODE,OISRP)=$$CI(^TMP($J,"OIC",NODE,OISRP)) Q
"RTN","OREORV1",152,0)
 S:$D(^TMP($J,"OIC",NODE,OIIF))=0 ^TMP($J,"OIC",NODE,OIIF)=0
"RTN","OREORV1",153,0)
 S ^TMP($J,"OIC",NODE,OIIF)=$$CI(^TMP($J,"OIC",NODE,OIIF))
"RTN","OREORV1",154,0)
 S:$D(^TMP($J,"OIC",NODE,OIIF,OISRP))=0 ^TMP($J,"OIC",NODE,OIIF,OISRP)=0
"RTN","OREORV1",155,0)
 S ^TMP($J,"OIC",NODE,OIIF,OISRP)=$$CI(^TMP($J,"OIC",NODE,OIIF,OISRP))
"RTN","OREORV1",156,0)
 S ^TMP($J,"OIC",NODE,OIIF,OISRP,OIIEN)=""
"RTN","OREORV1",157,0)
 I OIIF="A" D
"RTN","OREORV1",158,0)
 . D FDA^DILF(101.43,OIIEN_",",.1,"R","T","FDA")
"RTN","OREORV1",159,0)
 . D UPDATE^DIE("E","FDA",OIIEN_",","EM")
"RTN","OREORV1",160,0)
 I OIIA="" S OIIA=$$GET1^DIQ(101.43,OIIEN,.1)
"RTN","OREORV1",161,0)
 S ^TMP($J,"OIC",NODE,OIIF,OISRP,"B",OIN)=OIIEN_U_$P(OIIA,"@")
"RTN","OREORV1",162,0)
 Q
"RTN","OREORV1",163,0)
PC(PK) ;Package Check
"RTN","OREORV1",164,0)
 ;Returns 1 if it is one of the source packages in July 2001 specs doc
"RTN","OREORV1",165,0)
 ;Returns 0 if not one of the source packages in July 2001 specs doc
"RTN","OREORV1",166,0)
 ;Variable passed to PC
"RTN","OREORV1",167,0)
 ;  PK   - Package of the source record
"RTN","OREORV1",168,0)
 S PK=$S(PK="99CON":1,PK="99FHD":1,PK="99FHT":1,PK="99LRT":1,PK="99ORD":1,PK="99PRC":1,PK="99PRO":1,PK="99PSP":1,PK="99RAP":1,1:0)
"RTN","OREORV1",169,0)
 Q PK
"RTN","OREORV1",170,0)
SRC(PK,SRI) ;Source Record Check
"RTN","OREORV1",171,0)
 ;Returns 1 if source record is found, 0 if not
"RTN","OREORV1",172,0)
 ;Variables passed to SRC
"RTN","OREORV1",173,0)
 ;  PK   - Package of the source record
"RTN","OREORV1",174,0)
 ;  SRI  - Source Record IEN
"RTN","OREORV1",175,0)
 ;Local Variables
"RTN","OREORV1",176,0)
 ;  FN   - File Number of source record. Determined by package code.
"RTN","OREORV1",177,0)
 ;  FR   - Found Record, it is the return value.
"RTN","OREORV1",178,0)
 ;         It is equal to 1 if source record found, 0 if not
"RTN","OREORV1",179,0)
 ;  ORLV - Lookup Value, input variable for $$FIND1^DIC 
"RTN","OREORV1",180,0)
 N ERR,FN,FR,ORLV
"RTN","OREORV1",181,0)
 S FN=$S(PK="99CON":123.5,PK="99FHD":111,PK="99FHT":118.2,PK="99LRT":60,PK="99ORD":101.43,PK="99PRC":123.3,PK="99PRO":101,PK="99PSP":50.7,1:71)
"RTN","OREORV1",182,0)
 S ORLV="`"_SRI
"RTN","OREORV1",183,0)
 S FR=$$FIND1^DIC(FN,"","",.ORLV,"","","ERR")
"RTN","OREORV1",184,0)
 Q FR
"RTN","OREORV1",185,0)
CI(CNT) ;Counter
"RTN","OREORV1",186,0)
 ;  CNT - Counter
"RTN","OREORV1",187,0)
 S CNT=CNT+1
"RTN","OREORV1",188,0)
 Q CNT
"RTN","OREORV2")
0^3^B58604205
"RTN","OREORV2",1,0)
OREORV2 ; SLC/GDU - Orderable Item Records Validation [10/15/04 09:16]
"RTN","OREORV2",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**217**;Dec 17, 1997
"RTN","OREORV2",3,0)
 ;OREORV2 - Orderable Item Record Validation
"RTN","OREORV2",4,0)
 ;
"RTN","OREORV2",5,0)
 ;FIX FOR NOIS CASES:
"RTN","OREORV2",6,0)
 ;DAN-0204-42157, ALB-1001-51034, SBY-0803-30443, NJH-0402-20607
"RTN","OREORV2",7,0)
 ;
"RTN","OREORV2",8,0)
 ;This prints a report of the results from OREORV1.
"RTN","OREORV2",9,0)
 ;The results are stored in ^TMP($J,"OIC".
"RTN","OREORV2",10,0)
 ;^TMP($J,"OIC" is fully documented in OREORV1.
"RTN","OREORV2",11,0)
 ;The output is sorted and printed in the following manner:
"RTN","OREORV2",12,0)
 ;
"RTN","OREORV2",13,0)
 ;A report summary of the overall findings
"RTN","OREORV2",14,0)
 ;Section 1, details of OI records with null ID field
"RTN","OREORV2",15,0)
 ;Section 2, details of OI records without source IENs
"RTN","OREORV2",16,0)
 ;Section 3, details of OI records without source package codes
"RTN","OREORV2",17,0)
 ;Section 4, details of OI records with bad source package codes
"RTN","OREORV2",18,0)
 ;Section 5, details of OI records with packages with package
"RTN","OREORV2",19,0)
 ;           codes not listed in the OE/RR Interface Specifications
"RTN","OREORV2",20,0)
 ;           of July 2001. These records have properly formatted
"RTN","OREORV2",21,0)
 ;           package codes but can not be validated with this
"RTN","OREORV2",22,0)
 ;           utility.
"RTN","OREORV2",23,0)
 ;Section 6, summary of OI records validated with source records
"RTN","OREORV2",24,0)
 ;Section 7, details of OI records not validated with source records
"RTN","OREORV2",25,0)
 ;
"RTN","OREORV2",26,0)
 ;External Variables
"RTN","OREORV2",27,0)
 ;  IOF  - Standard FileMan/Kernel IO variable, Form Feed
"RTN","OREORV2",28,0)
 ;  IOM  - Standard FileMan/Kernel IO variable, Margin width
"RTN","OREORV2",29,0)
 ;  IOSL - Standard FileMan/Kernel IO variable, Page Length
"RTN","OREORV2",30,0)
 ;  IOST - Standard FileMan/Kernel IO variable, Terminal type
"RTN","OREORV2",31,0)
 ;  U    - Standard FileMan/Kernel delimiter variable
"RTN","OREORV2",32,0)
 ;
"RTN","OREORV2",33,0)
 ;External References
"RTN","OREORV2",34,0)
 ;  ^DIR               DBIA 10026
"RTN","OREORV2",35,0)
 ;  $$REPEAT^XLFSTR    DBIA 10104
"RTN","OREORV2",36,0)
 ;
"RTN","OREORV2",37,0)
MAIN ;Main entry point for this program
"RTN","OREORV2",38,0)
 ;Local Variables
"RTN","OREORV2",39,0)
 ;  PAGE - Page number counter
"RTN","OREORV2",40,0)
 ;  STOP - Stop report execution
"RTN","OREORV2",41,0)
 ;
"RTN","OREORV2",42,0)
 N PAGE,STOP
"RTN","OREORV2",43,0)
 S PAGE=1,STOP=0
"RTN","OREORV2",44,0)
 D RPTSUM I STOP=1 G EXIT  ;Report Summary
"RTN","OREORV2",45,0)
 D PS(1) I STOP=1 G EXIT
"RTN","OREORV2",46,0)
 D PS(2) I STOP=1 G EXIT
"RTN","OREORV2",47,0)
 D PS(3) I STOP=1 G EXIT
"RTN","OREORV2",48,0)
 D PS(4) I STOP=1 G EXIT
"RTN","OREORV2",49,0)
 D PS(5) I STOP=1 G EXIT
"RTN","OREORV2",50,0)
 D PS(6) I STOP=1 G EXIT
"RTN","OREORV2",51,0)
 D PS(7)
"RTN","OREORV2",52,0)
EXIT ;Exit point for this program
"RTN","OREORV2",53,0)
 Q
"RTN","OREORV2",54,0)
RPTSUM ;Report Summary - Summary of ZGOIRV1 findings
"RTN","OREORV2",55,0)
 ;Local Variables
"RTN","OREORV2",56,0)
 ;  RSL - Report Summary Line, indirect variable to print summary type
"RTN","OREORV2",57,0)
 ;  X   - Standard FileMan work variable
"RTN","OREORV2",58,0)
 ;
"RTN","OREORV2",59,0)
 N RSL,X
"RTN","OREORV2",60,0)
 D RPH
"RTN","OREORV2",61,0)
 W !,$P($T(RS),";",3),!
"RTN","OREORV2",62,0)
 F X=0:1:7 D
"RTN","OREORV2",63,0)
 . S RSL="RS"_X
"RTN","OREORV2",64,0)
 . W !,$P($T(@RSL),";",3),?65,$J(^TMP($J,"OIC",X),10)
"RTN","OREORV2",65,0)
 D @$S($E(IOST,1,2)="C-":"NS",1:"RPF")
"RTN","OREORV2",66,0)
 Q
"RTN","OREORV2",67,0)
PS(SN) ;Print Sections
"RTN","OREORV2",68,0)
 ;Variable Passed to PS
"RTN","OREORV2",69,0)
 ;  SN   - Section Number
"RTN","OREORV2",70,0)
 ;Local Variables
"RTN","OREORV2",71,0)
 ;  SH   - Section Header
"RTN","OREORV2",72,0)
 ;  SF   - Section Footer
"RTN","OREORV2",73,0)
 ;  PACK - Package Code
"RTN","OREORV2",74,0)
 ;  PH   - Package Subsection Header
"RTN","OREORV2",75,0)
 ;  PF   - Package Subsection Footer
"RTN","OREORV2",76,0)
 ;  NAME - Orderable Item Name
"RTN","OREORV2",77,0)
 ;
"RTN","OREORV2",78,0)
 N SH,SF,PACK,PH,PF,NAME
"RTN","OREORV2",79,0)
 S SH="SH"_SN,SF="SF"_SN
"RTN","OREORV2",80,0)
 W !,$P($T(@SH),";",3)
"RTN","OREORV2",81,0)
 W ! D LCC Q:STOP=1
"RTN","OREORV2",82,0)
 I SN=1!(SN=2)!(SN=3) D
"RTN","OREORV2",83,0)
 . I ^TMP($J,"OIC",SN)>0 D
"RTN","OREORV2",84,0)
 .. W !,$P($T(@SH),";",3) D LCC Q:STOP=1
"RTN","OREORV2",85,0)
 .. W !,$$REPEAT^XLFSTR("-",IOM) D LCC Q:STOP=1
"RTN","OREORV2",86,0)
 ..  S NAME="" F  S NAME=$O(^TMP($J,"OIC",SN,"B",NAME)) Q:NAME=""!(STOP=1)  D
"RTN","OREORV2",87,0)
 ... W !,NAME,?65,$P(^TMP($J,"OIC",SN,"B",NAME),U,2)
"RTN","OREORV2",88,0)
 I SN=4!(SN=5) D
"RTN","OREORV2",89,0)
 . I ^TMP($J,"OIC",SN)>0 D
"RTN","OREORV2",90,0)
 .. S PACK="" F  S PACK=$O(^TMP($J,"OIC",SN,PACK)) Q:PACK=""!(STOP=1)  D
"RTN","OREORV2",91,0)
 ... S PH=$P($T(PHT),";",3)_" : "_PACK_" - "_$P($T(@$E(PACK,3,5)),";",3)
"RTN","OREORV2",92,0)
 ... S PF=$P($T(PFT),";",3)_" : "_PACK_" - "_$P($T(@$E(PACK,3,5)),";",3)
"RTN","OREORV2",93,0)
 ... W !,PH D LCC Q:STOP=1
"RTN","OREORV2",94,0)
 ... W !,$P($T(CH1),";",3),?65,$P($T(CH2),";",3) D LCC Q:STOP=1
"RTN","OREORV2",95,0)
 ... W !,$$REPEAT^XLFSTR("-",IOM) D LCC Q:STOP=1
"RTN","OREORV2",96,0)
 ... S NAME="" F  S NAME=$O(^TMP($J,"OIC",SN,PACK,"B",NAME)) Q:NAME=""!(STOP=1)  D
"RTN","OREORV2",97,0)
 .... W !,NAME,?65,$P(^TMP($J,"OIC",SN,PACK,"B",NAME),U,2) D LCC Q:STOP=1
"RTN","OREORV2",98,0)
 ... W !,PF,?65,$J(^TMP($J,"OIC",SN,PACK),10) D LCC Q:STOP=1
"RTN","OREORV2",99,0)
 ... W ! D LCC Q:STOP=1
"RTN","OREORV2",100,0)
 I SN=6 D
"RTN","OREORV2",101,0)
 . I ^TMP($J,"OIC",SN)>0 D
"RTN","OREORV2",102,0)
 . S PACK="" F  S PACK=$O(^TMP($J,"OIC",SN,PACK)) Q:PACK=""!(STOP=1)  D
"RTN","OREORV2",103,0)
 .. S PH=PACK_" - "_$P($T(@$E(PACK,3,5)),";",3)
"RTN","OREORV2",104,0)
 .. W !,PH,?65,$J(^TMP($J,"OIC",SN,PACK),10) D LCC Q:STOP=1
"RTN","OREORV2",105,0)
 I SN=7 D PS7
"RTN","OREORV2",106,0)
 W ! D LCC Q:STOP=1
"RTN","OREORV2",107,0)
 W !,$P($T(@SF),";",3),?65,$J(^TMP($J,"OIC",SN),10) D LCC Q:STOP=1
"RTN","OREORV2",108,0)
 I SN=7 S STOP=1
"RTN","OREORV2",109,0)
 D @$S($E(IOST,1,2)="C-":"NS",1:"RPF")
"RTN","OREORV2",110,0)
 Q
"RTN","OREORV2",111,0)
PS7 ;Print Section 7
"RTN","OREORV2",112,0)
 ;Local Variables
"RTN","OREORV2",113,0)
 ;  AH - Activity Type Subsection Header
"RTN","OREORV2",114,0)
 ;  AF - Activity Type Subsection Footer
"RTN","OREORV2",115,0)
 ;  AI - Active / Inactive Indicator
"RTN","OREORV2",116,0)
 ;
"RTN","OREORV2",117,0)
 N AH,AF,AI
"RTN","OREORV2",118,0)
 I ^TMP($J,"OIC",SN)=0 Q
"RTN","OREORV2",119,0)
 S AI="" F  S AI=$O(^TMP($J,"OIC",SN,AI)) Q:AI=""!(STOP=1)  D
"RTN","OREORV2",120,0)
 . S AH=AI_"HT",AF=AI_"FT"
"RTN","OREORV2",121,0)
 . W !,$P($T(@AH),";",3) D LCC Q:STOP=1
"RTN","OREORV2",122,0)
 . S PACK="" F  S PACK=$O(^TMP($J,"OIC",SN,AI,PACK)) Q:PACK=""!(STOP=1)  D
"RTN","OREORV2",123,0)
 .. S PH=$P($T(PHT),";",3)_" : "_PACK_" - "_$P($T(@$E(PACK,3,5)),";",3)
"RTN","OREORV2",124,0)
 .. S PF=PACK_" - "_$P($T(@$E(PACK,3,5)),";",3)
"RTN","OREORV2",125,0)
 .. W !,PH D LCC Q:STOP=1
"RTN","OREORV2",126,0)
 .. W !,$P($T(CH1),";",3),?65,$P($T(CH2),";",3) D LCC Q:STOP=1
"RTN","OREORV2",127,0)
 .. W !,$$REPEAT^XLFSTR("-",IOM) D LCC Q:STOP=1
"RTN","OREORV2",128,0)
 .. S NAME="" F  S NAME=$O(^TMP($J,"OIC",SN,AI,PACK,"B",NAME)) Q:NAME=""!(STOP=1)  D
"RTN","OREORV2",129,0)
 ... W !,NAME,?65,$P(^TMP($J,"OIC",SN,AI,PACK,"B",NAME),U,2) D LCC Q:STOP=1
"RTN","OREORV2",130,0)
 .. W !,PF,?65,$J(^TMP($J,"OIC",SN,AI,PACK),10) D LCC Q:STOP=1
"RTN","OREORV2",131,0)
 .. W ! D LCC Q:STOP=1
"RTN","OREORV2",132,0)
 . W ! D LCC Q:STOP=1
"RTN","OREORV2",133,0)
 . W !,$P($T(@AF),";",3),?65,$J(^TMP($J,"OIC",SN,AI),10) D LCC Q:STOP=1
"RTN","OREORV2",134,0)
 Q
"RTN","OREORV2",135,0)
RPH ;Report Page Header
"RTN","OREORV2",136,0)
 W:$E(IOST,1,2)="C-"!(PAGE>1) @IOF
"RTN","OREORV2",137,0)
 W $P($T(RH),";",3),?65,"PAGE: ",PAGE
"RTN","OREORV2",138,0)
 Q
"RTN","OREORV2",139,0)
NS ;Next Screen - Advances user to next screen if output directed to
"RTN","OREORV2",140,0)
 ;video console
"RTN","OREORV2",141,0)
 ;Local Variables
"RTN","OREORV2",142,0)
 ;  DIR   - Input array variable for ^DIR
"RTN","OREORV2",143,0)
 ;  DTOUT - Time out indicator, output variable for ^DIR
"RTN","OREORV2",144,0)
 ;  DUOUT - Up arrow out indicator, "^", output variable for ^DIR
"RTN","OREORV2",145,0)
 ;  Y     - Processed User response, output variable for ^DIR
"RTN","OREORV2",146,0)
 ;
"RTN","OREORV2",147,0)
 N DIR,DTOUT,DUOUT,Y
"RTN","OREORV2",148,0)
 S DIR(0)="E"
"RTN","OREORV2",149,0)
 W ! D ^DIR I $D(DTOUT)!($D(DUOUT)) S Y=0
"RTN","OREORV2",150,0)
 I Y=0 S STOP=1 Q
"RTN","OREORV2",151,0)
 S PAGE=$$PCI(PAGE)
"RTN","OREORV2",152,0)
 D:STOP=0 RPH
"RTN","OREORV2",153,0)
 Q 
"RTN","OREORV2",154,0)
RPF ;Report Page Footer - Prints page footer if output directed to printer
"RTN","OREORV2",155,0)
 ;Local Variables
"RTN","OREORV2",156,0)
 ; LF  - Line Feed, Advances 1 line down the page
"RTN","OREORV2",157,0)
 ; LFC - Line Feed Count, number of lines to advance to end of page
"RTN","OREORV2",158,0)
 N LF,LFC
"RTN","OREORV2",159,0)
 S LFC=(IOSL-4)-$Y
"RTN","OREORV2",160,0)
 F LF=1:1:LFC W !
"RTN","OREORV2",161,0)
 W $P($T(RF),";",3),?65,"PAGE: ",PAGE
"RTN","OREORV2",162,0)
 S PAGE=$$PCI(PAGE)
"RTN","OREORV2",163,0)
 D:STOP=0 RPH
"RTN","OREORV2",164,0)
 Q
"RTN","OREORV2",165,0)
LCC ;Line Count Check - Determine if it is time for end of page/screen logic
"RTN","OREORV2",166,0)
 I $Y>(IOSL-4) D @$S($E(IOST,1,2)="C-":"NS",1:"RPF") I STOP=1 G EXIT
"RTN","OREORV2",167,0)
 Q
"RTN","OREORV2",168,0)
PCI(PN) ;Page Counter
"RTN","OREORV2",169,0)
 ;Variable Passed to PCI
"RTN","OREORV2",170,0)
 ;  PN - Page Number
"RTN","OREORV2",171,0)
 S PN=PN+1 Q PN
"RTN","OREORV2",172,0)
 ;Text used by the program to print the report
"RTN","OREORV2",173,0)
 ;Text for the report page/screen headers
"RTN","OREORV2",174,0)
RH ;;Orderable Items File Record Validation Report
"RTN","OREORV2",175,0)
 ;Text for the report page footers
"RTN","OREORV2",176,0)
RF ;;Orderable Items File Record Validation Report
"RTN","OREORV2",177,0)
 ;Text for report summary
"RTN","OREORV2",178,0)
RS ;;Summary of Orderable Items Validation:
"RTN","OREORV2",179,0)
RS0 ;;Total number of records processed:
"RTN","OREORV2",180,0)
RS1 ;;Total number of records with null ID fields:
"RTN","OREORV2",181,0)
RS2 ;;Total number of records without source IENs:
"RTN","OREORV2",182,0)
RS3 ;;Total number of records without source package codes:
"RTN","OREORV2",183,0)
RS4 ;;Total number of records with bad source package codes:
"RTN","OREORV2",184,0)
RS5 ;;Total number of records requiring manual confirmation:
"RTN","OREORV2",185,0)
RS6 ;;Total number of records with source record matches (validated):
"RTN","OREORV2",186,0)
RS7 ;;Total number of records without source record matches:
"RTN","OREORV2",187,0)
 ;
"RTN","OREORV2",188,0)
 ;Section header/footer text
"RTN","OREORV2",189,0)
SH1 ;;Section 1, Records with null ID field
"RTN","OREORV2",190,0)
SH2 ;;Section 2, Records without source IENs
"RTN","OREORV2",191,0)
SH3 ;;Section 3, Records without source package codes
"RTN","OREORV2",192,0)
SH4 ;;Section 4, Records with incorrect source package code formats
"RTN","OREORV2",193,0)
SH5 ;;Section 5, Records with package codes not in current spec
"RTN","OREORV2",194,0)
SH6 ;;Section 6, Records with source record matches (Validated)
"RTN","OREORV2",195,0)
SH7 ;;section 7, Records without source record matches
"RTN","OREORV2",196,0)
SF1 ;;Total with null ID field
"RTN","OREORV2",197,0)
SF2 ;;Total without source IENs:
"RTN","OREORV2",198,0)
SF3 ;;Total without source package codes:
"RTN","OREORV2",199,0)
SF4 ;;Total with bad source package codes:
"RTN","OREORV2",200,0)
SF5 ;;Total with package codes not in spec:
"RTN","OREORV2",201,0)
SF6 ;;Total validated:
"RTN","OREORV2",202,0)
SF7 ;;Total without source record matches:
"RTN","OREORV2",203,0)
 ;
"RTN","OREORV2",204,0)
 ;Package title text
"RTN","OREORV2",205,0)
CON ;;Consult Request Services file
"RTN","OREORV2",206,0)
FHD ;;Diets file
"RTN","OREORV2",207,0)
FHT ;;Tubefeeding file
"RTN","OREORV2",208,0)
LRT ;;Laboratory Test file
"RTN","OREORV2",209,0)
ORD ;;Orderable Items file
"RTN","OREORV2",210,0)
PRC ;;Consult Procedure file
"RTN","OREORV2",211,0)
PRO ;;Protocol file
"RTN","OREORV2",212,0)
PSP ;;Pharmacy Orderable Item file
"RTN","OREORV2",213,0)
RAP ;;Radiology/Nuclear Medicine Procedures file
"RTN","OREORV2",214,0)
 ;
"RTN","OREORV2",215,0)
 ;Column Header text
"RTN","OREORV2",216,0)
CH1 ;;OI Name
"RTN","OREORV2",217,0)
CH2 ;;Inactive Date
"RTN","OREORV2",218,0)
 ;
"RTN","OREORV2",219,0)
 ;Package Header/Footer Text
"RTN","OREORV2",220,0)
PHT ;;Records for package
"RTN","OREORV2",221,0)
PFT ;;Sub-total for package
"RTN","OREORV2",222,0)
 ;
"RTN","OREORV2",223,0)
 ;Active OI records Header/Footer Text
"RTN","OREORV2",224,0)
AHT ;;Active OI records w/o matching source record
"RTN","OREORV2",225,0)
AFT ;;Sub-total active OI records w/o matching source record
"RTN","OREORV2",226,0)
 ;
"RTN","OREORV2",227,0)
 ;Inactive OI records Header/Footer Text
"RTN","OREORV2",228,0)
IHT ;;Inactive OI records w/o matching source record
"RTN","OREORV2",229,0)
IFT ;;Sub-total inactive OI records w/o matching source record
"VER")
8.0^22.0
**END**
**END**
