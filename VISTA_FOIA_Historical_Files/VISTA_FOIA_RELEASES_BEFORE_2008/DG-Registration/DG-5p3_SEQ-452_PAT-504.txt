$TXT Created by NAPOLIELLO,GREG at MNTVBB.FO-ALBANY.MED.VA.GOV  (KIDS) on Friday, 06/27/03 at 13:49
=============================================================================
Run Date: JUN 27, 2003                     Designation: DG*5.3*504
Package : DG - REGISTRATION                    Priority: Mandatory
Version : 5.3       SEQ #452                     Status: Released
                  Compliance Date: JUL 28, 2003
=============================================================================

Associated patches: (v)DG*5.3*222  <<= must be installed BEFORE `DG*5.3*504'

Subject: MODIFY HOW PATIENT SENSITIVITY IS CHANGED

Category: 
  - Routine

Description: 
============

 This patch will modify how the DG SECURITY LOG file #38.1 is modified by
 a Z11 transmission from the HEC.  The fields DATE/TIME SECURITY ASSIGNED
 [#4] and SECURITY SOURCE [#5], will only be updated when the field
 SECURITY LEVEL [#2] is being changed from Non-sensitive to Sensitive.
  
  
 This patch addresses the following E3R(s):
 ------------------------------------------
 There are no E3Rs associated with this patch.
  
  
 This patch addresses the following NOIS message(s):
 ---------------------------------------------------
 V06-0402-N2436 - PATIENT SENSITIVITY - CHANGED
  
  
 Overview of NOIS Message(s):
 ----------------------------
 V06-0402-N2436 - PATIENT SENSITIVITY - CHANGED
  
 Problem:
 --------
 Patient Sensitivity Date Assigned is being changed every time the
 Sensitive record is being accessed instead of only when originally
 assigned.
  
 Resolution:
 -----------
 Routine DGENUPL7 calls DGENUPL5 to check and upload Patient security 
 information.  DGENUPL5, prior to this fix, always updated the entire zero
 node of file #38.1, which included the DATE/TIME SECURITY ASSIGNED &
 SECURITY SOURCE fields.  
  
 The modification to this routine is to conditionally update the zero 
 node when the patient sensitivity is being changed from a Non-sensitive 
 value of 0 or null to a Sensitive value of 1.
  
 For the condition when there should not be an update, then the array
 DGSEC, which contains the current values from the HL7 message, will be
 set to the array OLDSEC, which is the old values currently on file. This
 is to allow later calls, to the Audit API's, to still function and to
 show that there was no change in the security data.
  
  
 Test Sites:
 -----------
 Beckley VAMC
 Salisbury VAMC
 Manchester VAMC
  
  
        ================INSTALLATION INSTRUCTIONS =================
  
    This patch can be loaded with users on the system.  Installation will
    take less than 1 minute.
  
  
   1.   LOAD TRANSPORT GLOBAL 
        ---------------------
        Choose the PackMan message containing this patch and invoke the 
        INSTALL/CHECK MESSAGE PackMan option.  
              
   2.   DISABLE ROUTINE MAPPING   (DSM for Open VMS sites only) 
        -----------------------
        Disable routine mapping on all systems for the routines listed in 
        step 3 below.  
       
        NOTE:  If the routines included in this patch are not currently in 
               your mapped routine set, please skip this step.
   
   3.   COMPONENTS SENT WITH PATCH 
        ------------------------
        The following is a list of the routine(s) included in this patch.  
        The second line of each of these routine(s) will look like:
  
        ;;5.3;Registration;**[patch list]**;08/13/93
  
                             CHECK^XTSUMBLD results
  
        Routine       Before Patch        After Patch       Patch List
        -------       ------------        -----------       ----------
        DGENUPL5      623198              1173236           222,504
  
        Total number of routines - 1 
  
   4.   START UP KIDS 
        -------------
        Start up the Kernel Installation and Distribution System Menu 
        [XPD MAIN]: 
    
             Edits and Distribution ...  
             Utilities ...  
             Installation ...  
    
   Select Kernel Installation & Distribution System Option: INStallation 
                                                            ---
             Load a Distribution 
             Print Transport Global 
             Compare Transport Global to Current System 
             Verify Checksums in Transport Global 
             Install Package(s) 
             Restart Install of Package(s) 
             Unload a Distribution 
             Backup a Transport Global 
    
   Select Installation Option: 
    
   5.   Select Installation Option: 
        --------------------------
        NOTE:  The following are OPTIONAL - (When prompted for the INSTALL
               NAME, enter DG*5.3*504):
       
        a.  Backup a Transport Global - This option will create a backup
            message of any routines exported with this patch. It will not
            backup any other changes such as DD's or templates.
        b.  Compare Transport Global to Current System - This option will
            allow you to view all changes that will be made when this patch
            is installed.  It compares all components of this patch
            (routines, DD's, templates, etc.).
        c.  Verify Checksums in Transport Global - This option will allow
            you to ensure the integrity of the routines that are in the
            transport global.
      
   6.   Select Installation Option: Install Package(s) 
                                    ----------------
        **This is the step to start the installation of this KIDS patch: 
    
        a. Choose the Install Package(s) option to start the patch install.
        b. When prompted 'Want KIDS to INHIBIT LOGONs during the install?
           YES//' answer NO (unless otherwise indicated)
        c. When prompted 'Want to DISABLE Scheduled Options, Menu Options,
           and Protocols? YES//' answer NO (unless otherwise indicated)
  
   7.   REBUILD MAPPED ROUTINE(S)  (DSM for Open VMS sites only)
        -------------------------
        Optional - Include the routines distributed with this patch
        in the mapped routine set.
      
        NOTE: This step is only necessary if you performed step 2 or 
              if you wish to include the routines in your mapped set.

Routine Information:
====================

Routine Name:
  - DGENUPL5

 Changes below:
  
 **** new ********************
 64   .; if new level = Yes and old level Not = Yes (DG*5.3*504)
 65   .I $G(DGSEC("LEVEL"))=1,$G(OLDSEC("LEVEL"))'=1 D
 66   ..I $$UPDATE^DGENSEC(DFN,.DGSEC)
 67   .E  D
 68   ..; since no update occurring, then set arrays the same to prevent an
 69   ..; Audit record from being created later.
 70   ..M DGSEC=OLDSEC
 71   ;
  
 **** old ********************
 62   .I $$UPDATE^DGENSEC(DFN,.DGSEC)
 63   ;

Routine Checksum:

=============================================================================
User Information:                               
Entered By  : NAPOLIELLO,GREG                Date Entered : MAR 03, 2003
Completed By: LANDRY,DANNA                  Date Completed: JUN 27, 2003
Released By : GROOMS,ANTHONY E             Date Released : JUN 27, 2003
=============================================================================


Packman Mail Message:
=====================

$END TXT
