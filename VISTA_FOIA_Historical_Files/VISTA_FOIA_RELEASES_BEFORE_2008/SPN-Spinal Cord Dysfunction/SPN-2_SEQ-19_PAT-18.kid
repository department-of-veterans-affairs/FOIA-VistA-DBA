Released SPN*2*18 SEQ #19
Extracted from mail message
**KIDS**:SPN*2.0*18^

**INSTALL NAME**
SPN*2.0*18
"BLD",4327,0)
SPN*2.0*18^SPINAL CORD DYSFUNCTION^0^3030206^y
"BLD",4327,4,0)
^9.64PA^^0
"BLD",4327,"INI")
SPNPRI18
"BLD",4327,"KRN",0)
^9.67PA^8989.52^19
"BLD",4327,"KRN",.4,0)
.4
"BLD",4327,"KRN",.4,"NM",0)
^9.68A^^0
"BLD",4327,"KRN",.401,0)
.401
"BLD",4327,"KRN",.402,0)
.402
"BLD",4327,"KRN",.402,"NM",0)
^9.68A^^0
"BLD",4327,"KRN",.403,0)
.403
"BLD",4327,"KRN",.403,"NM",0)
^9.68A^^0
"BLD",4327,"KRN",.5,0)
.5
"BLD",4327,"KRN",.84,0)
.84
"BLD",4327,"KRN",3.6,0)
3.6
"BLD",4327,"KRN",3.6,"NM",0)
^9.68A^^0
"BLD",4327,"KRN",3.8,0)
3.8
"BLD",4327,"KRN",3.8,"NM",0)
^9.68A^^0
"BLD",4327,"KRN",9.2,0)
9.2
"BLD",4327,"KRN",9.8,0)
9.8
"BLD",4327,"KRN",9.8,"NM",0)
^9.68A^8^5
"BLD",4327,"KRN",9.8,"NM",1,0)
SPNLGRPS^^0^B6813030
"BLD",4327,"KRN",9.8,"NM",3,0)
SPNPSR03^^0^B1913171
"BLD",4327,"KRN",9.8,"NM",4,0)
SPN18E^^0^B2732440
"BLD",4327,"KRN",9.8,"NM",5,0)
SPNPRI18^^0^B525467
"BLD",4327,"KRN",9.8,"NM",8,0)
SPNDDFM^^0^B4434599
"BLD",4327,"KRN",9.8,"NM","B","SPN18E",4)

"BLD",4327,"KRN",9.8,"NM","B","SPNDDFM",8)

"BLD",4327,"KRN",9.8,"NM","B","SPNLGRPS",1)

"BLD",4327,"KRN",9.8,"NM","B","SPNPRI18",5)

"BLD",4327,"KRN",9.8,"NM","B","SPNPSR03",3)

"BLD",4327,"KRN",19,0)
19
"BLD",4327,"KRN",19,"NM",0)
^9.68A^^0
"BLD",4327,"KRN",19.1,0)
19.1
"BLD",4327,"KRN",19.1,"NM",0)
^9.68A^^0
"BLD",4327,"KRN",101,0)
101
"BLD",4327,"KRN",101,"NM",0)
^9.68A^3^3
"BLD",4327,"KRN",101,"NM",1,0)
DG FIELD MONITOR^^2
"BLD",4327,"KRN",101,"NM",2,0)
SPN REG STATUS DELETE^^0
"BLD",4327,"KRN",101,"NM",3,0)
SPN REG STATUS UPDATE^^0
"BLD",4327,"KRN",101,"NM","B","DG FIELD MONITOR",1)

"BLD",4327,"KRN",101,"NM","B","SPN REG STATUS DELETE",2)

"BLD",4327,"KRN",101,"NM","B","SPN REG STATUS UPDATE",3)

"BLD",4327,"KRN",409.61,0)
409.61
"BLD",4327,"KRN",771,0)
771
"BLD",4327,"KRN",771,"NM",0)
^9.68A^^0
"BLD",4327,"KRN",870,0)
870
"BLD",4327,"KRN",870,"NM",0)
^9.68A^^0
"BLD",4327,"KRN",8989.51,0)
8989.51
"BLD",4327,"KRN",8989.52,0)
8989.52
"BLD",4327,"KRN",8994,0)
8994
"BLD",4327,"KRN","B",.4,.4)

"BLD",4327,"KRN","B",.401,.401)

"BLD",4327,"KRN","B",.402,.402)

"BLD",4327,"KRN","B",.403,.403)

"BLD",4327,"KRN","B",.5,.5)

"BLD",4327,"KRN","B",.84,.84)

"BLD",4327,"KRN","B",3.6,3.6)

"BLD",4327,"KRN","B",3.8,3.8)

"BLD",4327,"KRN","B",9.2,9.2)

"BLD",4327,"KRN","B",9.8,9.8)

"BLD",4327,"KRN","B",19,19)

"BLD",4327,"KRN","B",19.1,19.1)

"BLD",4327,"KRN","B",101,101)

"BLD",4327,"KRN","B",409.61,409.61)

"BLD",4327,"KRN","B",771,771)

"BLD",4327,"KRN","B",870,870)

"BLD",4327,"KRN","B",8989.51,8989.51)

"BLD",4327,"KRN","B",8989.52,8989.52)

"BLD",4327,"KRN","B",8994,8994)

"BLD",4327,"PRE")
SPN18E
"BLD",4327,"QUES",0)
^9.62^^
"BLD",4327,"REQB",0)
^9.611^^
"INI")
SPNPRI18
"KRN",101,5232,-1)
2^1
"KRN",101,5232,0)
DG FIELD MONITOR^DG Field Monitor^^X^20897^^^^^^^5
"KRN",101,5232,10,0)
^101.01PA^4^3
"KRN",101,5232,10,3,0)
5233^^^
"KRN",101,5232,10,3,"^")
SPN REG STATUS UPDATE
"KRN",101,5232,10,4,0)
5500^^^
"KRN",101,5232,10,4,"^")
SPN REG STATUS DELETE
"KRN",101,5233,-1)
0^3
"KRN",101,5233,0)
SPN REG STATUS UPDATE^Update Registration Status to Expired^^A^^^^^^^^SPINAL CORD DYSFUNCTION
"KRN",101,5233,.1)
RS
"KRN",101,5233,1,0)
^101.06^4^4^3020909^^^^
"KRN",101,5233,1,1,0)
This protocol is an 'action' type which automatically updates 
"KRN",101,5233,1,2,0)
Registration Status in the SCD (SPINAL CORD) REGISTRY file (#154) to 
"KRN",101,5233,1,3,0)
Expired if the Date of Death field (#.351) in the PATIENT file (#2) is 
"KRN",101,5233,1,4,0)
edited and made not null (i.e., a date is inserted).
"KRN",101,5233,20)
I DGFILE=2,DGFIELD=.351,DGTYPE="ADD" D EDIT^SPNDDFM
"KRN",101,5233,99)
58729,59123
"KRN",101,5500,-1)
0^2
"KRN",101,5500,0)
SPN REG STATUS DELETE^Notice of Date of Death Deletion^^A^^^^^^^^
"KRN",101,5500,.1)
RSD
"KRN",101,5500,1,0)
^^6^6^3020910^
"KRN",101,5500,1,1,0)
This protocol is an 'action' type which automatically sends a Mailman
"KRN",101,5500,1,2,0)
message if pt's Date of Death value has been deleted from his PATIENT file
"KRN",101,5500,1,3,0)
(#2) record.  The message is sent to the SPNL SCD COORDINATOR mail group,
"KRN",101,5500,1,4,0)
notifying its members to verify the death rescindment, and enter a correct
"KRN",101,5500,1,5,0)
value in the Registration Status field in the SCD (SPINAL CORD) REGISTRY
"KRN",101,5500,1,6,0)
file (#154).
"KRN",101,5500,20)
I DGFILE=2,DGFIELD=.351,DGTYPE="DELETE" D DEL^SPNDDFM
"KRN",101,5500,99)
59057,54829
"MBREQ")
0
"ORD",15,101)
101;15;;;PRO^XPDTA;PROF1^XPDIA;PROE1^XPDIA;PROF2^XPDIA;;PRODEL^XPDIA
"ORD",15,101,0)
PROTOCOL
"PKG",418,-1)
1^1
"PKG",418,0)
SPINAL CORD DYSFUNCTION^SPN^SPINAL CORD DYSFUNCTION, FIELD COMPONENT
"PKG",418,20,0)
^9.402P^^
"PKG",418,22,0)
^9.49I^1^1
"PKG",418,22,1,0)
2.0^2961206^2970131^13722
"PKG",418,22,1,"PAH",1,0)
18^3030206
"PRE")
SPN18E
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
5
"RTN","SPN18E")
0^4^B2732440
"RTN","SPN18E",1,0)
SPN18E ;SAN/WDE ENVIRONMENT CHECK FOR SPN*2.0*18;12/2/2002
"RTN","SPN18E",2,0)
 ;;2.0;Spinal Cord Dysfunction;**18**;01/02/97
"RTN","SPN18E",3,0)
 ;
"RTN","SPN18E",4,0)
EN ;ENTRY
"RTN","SPN18E",5,0)
 N ROU,TEST,VER,X,ZAP,P18
"RTN","SPN18E",6,0)
 S ROU="SPNCTINA"
"RTN","SPN18E",7,0)
 D CHK
"RTN","SPN18E",8,0)
 I $G(ZAP)=1 S XPDABORT=2 W !,"***SPN*2.0*18 ABORTED***",! D EXIT Q
"RTN","SPN18E",9,0)
 S ROU="DGUTL4"
"RTN","SPN18E",10,0)
 D CHK2
"RTN","SPN18E",11,0)
 I $G(ZAP)=1 S XPDABORT=2 W !,"***SPN*2.0*18 ABORTED***",! D EXIT Q
"RTN","SPN18E",12,0)
 W !,"***Environment is fine***",!
"RTN","SPN18E",13,0)
 K ROU,TEST,VER,ZAP,P18
"RTN","SPN18E",14,0)
 Q
"RTN","SPN18E",15,0)
CHK ;CHECK FOR PATCHED ROUTINE SPNCTINA
"RTN","SPN18E",16,0)
 S X="S TEST=$T(+2^"_ROU_")" X X
"RTN","SPN18E",17,0)
 S VER=$P(TEST,";",3),P18=$P(TEST,";",5)
"RTN","SPN18E",18,0)
 I VER="" W !,"This account is missing some SPN routines!" S ZAP=1 Q
"RTN","SPN18E",19,0)
 I VER'[2 W !,"This is not the current version of Spinal Cord!" S ZAP=1 Q
"RTN","SPN18E",20,0)
 I P18'[19 W !,"Routine: ",ROU," is missing patch SPN*2*19" S ZAP=1
"RTN","SPN18E",21,0)
 Q
"RTN","SPN18E",22,0)
CHK2 ;CHECK FOR PATCHED ROUTINE DGUTL4
"RTN","SPN18E",23,0)
 S X="S TEST=$T(+2^"_ROU_")" X X
"RTN","SPN18E",24,0)
 S VER=$P(TEST,";",3),P18=$P(TEST,";",5)
"RTN","SPN18E",25,0)
 I VER="" W !,"This account is missing some DG routines!" S ZAP=1 Q
"RTN","SPN18E",26,0)
 I VER'[5.3 W !,"This is not the current version of DG!" S ZAP=1 Q
"RTN","SPN18E",27,0)
 I P18'[415 W !,"Routine: ",ROU," is missing patch DG*5.3*415" S ZAP=1
"RTN","SPN18E",28,0)
 Q
"RTN","SPN18E",29,0)
EXIT ;
"RTN","SPN18E",30,0)
 K ROU,TEST,VER,ZAP,P18
"RTN","SPN18E",31,0)
 Q
"RTN","SPNDDFM")
0^8^B4434599
"RTN","SPNDDFM",1,0)
SPNDDFM ;SD/CM- UPDATES REG STATUS USING FIELD MONITOR; 7-9-01
"RTN","SPNDDFM",2,0)
 ;;2.0;Spinal Cord Dysfunction;**18**;01/02/97
"RTN","SPNDDFM",3,0)
 ;
"RTN","SPNDDFM",4,0)
EDIT ;
"RTN","SPNDDFM",5,0)
 Q:'$D(^SPNL(154,DGDA))
"RTN","SPNDDFM",6,0)
 Q:$P(^SPNL(154,DGDA,0),U,3)=""
"RTN","SPNDDFM",7,0)
 S SPNOLD=$P(^SPNL(154,DGDA,0),U,3)
"RTN","SPNDDFM",8,0)
 I $P($G(^DPT(DGDA,.35)),U,1)'="" K ^SPNL(154,"AD",SPNOLD,DGDA) S DIE="^SPNL(154,",DA=DGDA,DR=".03///EXPIRED" D ^DIE
"RTN","SPNDDFM",9,0)
 D CHK^SPNHL7(DGDA)
"RTN","SPNDDFM",10,0)
 K DA,DIE,DR,SPNOLD
"RTN","SPNDDFM",11,0)
 Q
"RTN","SPNDDFM",12,0)
DEL ;
"RTN","SPNDDFM",13,0)
 Q:'$D(^SPNL(154,DGDA))
"RTN","SPNDDFM",14,0)
 Q:$P(^SPNL(154,DGDA,0),U,3)=""
"RTN","SPNDDFM",15,0)
 Q:$P(^SPNL(154,DGDA,0),U,3)'="X"
"RTN","SPNDDFM",16,0)
 I $P($G(^DPT(DGDA,.35)),U,1)="" D DEL2
"RTN","SPNDDFM",17,0)
 K SPNARR,XMDUZ,XMSUB,XMTEXT,XMY
"RTN","SPNDDFM",18,0)
 Q
"RTN","SPNDDFM",19,0)
DEL2 ;
"RTN","SPNDDFM",20,0)
 S SPNARR(1)="     ******** Patient NOT Expired ********"
"RTN","SPNDDFM",21,0)
 S SPNARR(2)=" "
"RTN","SPNDDFM",22,0)
 S SPNARR(3)="This is to alert you that a patient marked as 'Expired'"
"RTN","SPNDDFM",23,0)
 S SPNARR(4)="in the SCD Registry is alive according to MAS records."
"RTN","SPNDDFM",24,0)
 S SPNARR(4.2)="Notify your hospital's MAS personnel -- it is possible"
"RTN","SPNDDFM",25,0)
 S SPNARR(4.4)="that the patient is indeed deceased, but Date of Death"
"RTN","SPNDDFM",26,0)
 S SPNARR(4.6)="was not entered into pt's VA record."
"RTN","SPNDDFM",27,0)
 S SPNARR(5)="However, if this patient is truely alive, please update"
"RTN","SPNDDFM",28,0)
 S SPNARR(6)="his Registration Status field in the SCD Registry."
"RTN","SPNDDFM",29,0)
 S SPNARR(7)=" "
"RTN","SPNDDFM",30,0)
 S SPNARR(8)="Patient ----> "_$E($P($G(^DPT(DGDA,0)),U,1),1)_$E($P($G(^DPT(DGDA,0)),U,9),6,9)
"RTN","SPNDDFM",31,0)
 S XMSUB="PT DEATH: MAS RECORD vs. SCD RECORD"
"RTN","SPNDDFM",32,0)
 S XMDUZ="SCD REGISTRY"
"RTN","SPNDDFM",33,0)
MSG ;
"RTN","SPNDDFM",34,0)
 S XMTEXT="SPNARR("
"RTN","SPNDDFM",35,0)
 S XMY("G.SPNL SCD COORDINATOR")=""
"RTN","SPNDDFM",36,0)
SEND ;
"RTN","SPNDDFM",37,0)
 D ^XMD
"RTN","SPNDDFM",38,0)
 Q
"RTN","SPNLGRPS")
0^1^B6813030
"RTN","SPNLGRPS",1,0)
SPNLGRPS ; ISC-SF/GMB - SCD GATHER PATIENT STATISTICS DATA; 3 JUL 94 [ 08/08/94  2:19 PM ] ;6/23/95  11:39
"RTN","SPNLGRPS",2,0)
 ;;2.0;Spinal Cord Dysfunction;**18**;01/02/1997
"RTN","SPNLGRPS",3,0)
GATHER(DFN,FDATE,TDATE,QLIST) ;
"RTN","SPNLGRPS",4,0)
 ; DFN       Patient's internal entry number in the Patient file
"RTN","SPNLGRPS",5,0)
 ; FDATE     "From" date
"RTN","SPNLGRPS",6,0)
 ; TDATE     "Thru" date, default=today
"RTN","SPNLGRPS",7,0)
 ; Data will be rolled up into the following global:
"RTN","SPNLGRPS",8,0)
 ; ^TMP("SPN",$J,"PS",
"RTN","SPNLGRPS",9,0)
 ; with the following nodes for each sex:
"RTN","SPNLGRPS",10,0)
 ; "SEX",sex)            # patients of this sex
"RTN","SPNLGRPS",11,0)
 ; "STAT","DEAD",sex)    # patients who are dead
"RTN","SPNLGRPS",12,0)
 ; "STAT","ALIVE",sex)   # patients who are alive
"RTN","SPNLGRPS",13,0)
 ; "AGE",agerange,sex)   # patients who are in this age range
"RTN","SPNLGRPS",14,0)
 ; "RACE",race,sex)      # patients who are this race
"RTN","SPNLGRPS",15,0)
 ; "MEANS",means,sex)    # patients who are in this means test category
"RTN","SPNLGRPS",16,0)
 ; "POS",pos,sex)        # patients who are from this period of service
"RTN","SPNLGRPS",17,0)
 ; "ELIG",elig,sex)      # patients with this eligibility
"RTN","SPNLGRPS",18,0)
 ; Additionally, if the user specified a time period:
"RTN","SPNLGRPS",19,0)
 ; "SEEN","IP",sex)      # patients seen as an inpatient
"RTN","SPNLGRPS",20,0)
 ; "SEEN","OP",sex)      # patients seen as an outpatient
"RTN","SPNLGRPS",21,0)
 ; "SEEN","CH",sex)      # patients who had lab tests
"RTN","SPNLGRPS",22,0)
 ; "SEEN","RX",sex)      # patients seen in pharmacy
"RTN","SPNLGRPS",23,0)
 ; "SEEN","RA",sex)      # patients seen in radiology
"RTN","SPNLGRPS",24,0)
 N VADM,VAEL,AGE,SEX,AGERANGE,ISDEAD,MEANS,ELIG,POS,RACE
"RTN","SPNLGRPS",25,0)
 N SEEN,SEENIP,SEENOP,SEENCH,SEENRX,SEENRA,LASTSEEN
"RTN","SPNLGRPS",26,0)
 D DEM^VADPT ; Get patient demographics
"RTN","SPNLGRPS",27,0)
 ; If we are not including dead patients, and if the patient has a date of death recorded, then quit
"RTN","SPNLGRPS",28,0)
 S ISDEAD=+$P($G(VADM(6)),U,1)
"RTN","SPNLGRPS",29,0)
 I 'QLIST("INCLUDE DEAD"),ISDEAD Q
"RTN","SPNLGRPS",30,0)
 ; If we are only interested in patients who were seen during a certain
"RTN","SPNLGRPS",31,0)
 ; time period, but this patient was not seen during that period, then quit
"RTN","SPNLGRPS",32,0)
 I QLIST("WINDOW") D  Q:'SEEN
"RTN","SPNLGRPS",33,0)
 . D SEEN^SPNLGUSN(DFN,FDATE,TDATE,.SEEN,.LASTSEEN,.SEENIP,.SEENOP,.SEENCH,.SEENRX,.SEENRA)
"RTN","SPNLGRPS",34,0)
 S SEX=$P(VADM(5),U,1)
"RTN","SPNLGRPS",35,0)
 I $F("MF",SEX)<2 S SEX="U"
"RTN","SPNLGRPS",36,0)
 ; Capture all the sexes
"RTN","SPNLGRPS",37,0)
 S ^TMP("SPN",$J,"PS","SEX",SEX)=""
"RTN","SPNLGRPS",38,0)
 ; Capture Dead/Alive
"RTN","SPNLGRPS",39,0)
 I ISDEAD S ^(SEX)=$G(^TMP("SPN",$J,"PS","STAT","DEAD",SEX))+1
"RTN","SPNLGRPS",40,0)
 E        S ^(SEX)=$G(^TMP("SPN",$J,"PS","STAT","LIVE",SEX))+1
"RTN","SPNLGRPS",41,0)
 ; Capture age range
"RTN","SPNLGRPS",42,0)
 S AGE=VADM(4)
"RTN","SPNLGRPS",43,0)
 S AGERANGE=AGE\5*5
"RTN","SPNLGRPS",44,0)
 S ^(SEX)=$G(^TMP("SPN",$J,"PS","AGE",AGERANGE,SEX))+1
"RTN","SPNLGRPS",45,0)
 ; Capture Race
"RTN","SPNLGRPS",46,0)
 S RACE=$P($G(VADM(12,1)),U,2)
"RTN","SPNLGRPS",47,0)
 I RACE="" S RACE="UNSPECIFIED RACE"
"RTN","SPNLGRPS",48,0)
 S ^(SEX)=$G(^TMP("SPN",$J,"PS","RACE",RACE,SEX))+1
"RTN","SPNLGRPS",49,0)
 D ELIG^VADPT ; Get patient eligibility information
"RTN","SPNLGRPS",50,0)
 ; Capture Means Test Info
"RTN","SPNLGRPS",51,0)
 S MEANS=$P($G(VAEL(9)),U,2)
"RTN","SPNLGRPS",52,0)
 I MEANS="" SET MEANS="NOT REQUIRED"
"RTN","SPNLGRPS",53,0)
 S ^(SEX)=$G(^TMP("SPN",$J,"PS","MEANS",MEANS,SEX))+1
"RTN","SPNLGRPS",54,0)
 ; Capture Eligibility
"RTN","SPNLGRPS",55,0)
 S ELIG=$P($G(VAEL(1)),U,2)
"RTN","SPNLGRPS",56,0)
 I ELIG="" S ELIG="UNSPECIFIED ELIGIBILITY"
"RTN","SPNLGRPS",57,0)
 S ^(SEX)=$G(^TMP("SPN",$J,"PS","ELIG",ELIG,SEX))+1
"RTN","SPNLGRPS",58,0)
 ; Capture Period of Service Info
"RTN","SPNLGRPS",59,0)
 S POS=$P($G(VAEL(2)),U,2)
"RTN","SPNLGRPS",60,0)
 I POS="" S POS="UNSPECIFIED PERIOD OF SERVICE"
"RTN","SPNLGRPS",61,0)
 S ^(SEX)=$G(^TMP("SPN",$J,"PS","POS",POS,SEX))+1
"RTN","SPNLGRPS",62,0)
 ; Capture where seen, but only if report is for a specified period
"RTN","SPNLGRPS",63,0)
 I QLIST("WINDOW") D
"RTN","SPNLGRPS",64,0)
 . S:SEENIP ^(SEX)=$G(^TMP("SPN",$J,"PS","SEEN","IP",SEX))+1
"RTN","SPNLGRPS",65,0)
 . S:SEENOP ^(SEX)=$G(^TMP("SPN",$J,"PS","SEEN","OP",SEX))+1
"RTN","SPNLGRPS",66,0)
 . S:SEENCH ^(SEX)=$G(^TMP("SPN",$J,"PS","SEEN","CH",SEX))+1
"RTN","SPNLGRPS",67,0)
 . S:SEENRX ^(SEX)=$G(^TMP("SPN",$J,"PS","SEEN","RX",SEX))+1
"RTN","SPNLGRPS",68,0)
 . S:SEENRA ^(SEX)=$G(^TMP("SPN",$J,"PS","SEEN","RA",SEX))+1
"RTN","SPNLGRPS",69,0)
 Q
"RTN","SPNPRI18")
0^5^B525467
"RTN","SPNPRI18",1,0)
SPNPRI18 ;SD/WDE/Post action for patch 18 12/2/2002 14:23
"RTN","SPNPRI18",2,0)
 ;;2.0;Spinal Cord Dysfunction;**18**;01/02/1997
"RTN","SPNPRI18",3,0)
 ;
"RTN","SPNPRI18",4,0)
EN ;
"RTN","SPNPRI18",5,0)
 S SPNDFN=0 F  S SPNDFN=$O(^SPNL(154,SPNDFN)) Q:'+SPNDFN  D DOD
"RTN","SPNPRI18",6,0)
ZAP ;
"RTN","SPNPRI18",7,0)
 K SPNDFN
"RTN","SPNPRI18",8,0)
 Q
"RTN","SPNPRI18",9,0)
DOD ;
"RTN","SPNPRI18",10,0)
 ;date of death update
"RTN","SPNPRI18",11,0)
 D LOOP^SPNDODCK(SPNDFN) ; Update Reg Status based on DOD file 2
"RTN","SPNPRI18",12,0)
 D LOOP2^SPNDODCK(SPNDFN) ; Updating Reg Status
"RTN","SPNPRI18",13,0)
 Q
"RTN","SPNPSR03")
0^3^B1913171
"RTN","SPNPSR03",1,0)
SPNPSR03 ;HIRMFO/DAD,WAA-HUNT: RACE ;8/7/95  15:29
"RTN","SPNPSR03",2,0)
 ;;2.0;Spinal Cord Dysfunction;**18**;01/02/1997
"RTN","SPNPSR03",3,0)
 ;
"RTN","SPNPSR03",4,0)
EN1(D0,SPNRACE) ; *** Search entry point
"RTN","SPNPSR03",5,0)
 ; Input:
"RTN","SPNPSR03",6,0)
 ;  ACTION,SEQUENCE = Search ACTION,SEQUENCE number
"RTN","SPNPSR03",7,0)
 ;  D0       = SCD (SPINAL CORD) REGISTRY file (#154) IEN
"RTN","SPNPSR03",8,0)
 ;  ^TMP($J,"SPNPRT",ACTION,SEQUENCE,"RACE") = Internal ^ External
"RTN","SPNPSR03",9,0)
 ;  SPNRACE = Internal race
"RTN","SPNPSR03",10,0)
 ; Output:
"RTN","SPNPSR03",11,0)
 ;  $S( D0_Meets_Search_Criteria : 1 , 1 : 0 )
"RTN","SPNPSR03",12,0)
 ;
"RTN","SPNPSR03",13,0)
 N DFN,MEETSRCH,RACE,VA,VADM,VAERR
"RTN","SPNPSR03",14,0)
 S MEETSRCH=0
"RTN","SPNPSR03",15,0)
 S DFN=+$P($G(^SPNL(154,+D0,0)),U)
"RTN","SPNPSR03",16,0)
 D DEM^VADPT
"RTN","SPNPSR03",17,0)
 I 'VAERR D
"RTN","SPNPSR03",18,0)
 . S RACE=$P($G(VADM(12,1)),U)
"RTN","SPNPSR03",19,0)
 . I RACE]"",RACE=SPNRACE S MEETSRCH=1
"RTN","SPNPSR03",20,0)
 . Q
"RTN","SPNPSR03",21,0)
 Q MEETSRCH
"RTN","SPNPSR03",22,0)
 ;
"RTN","SPNPSR03",23,0)
EN2(ACTION,SEQUENCE) ; *** Prompt entry point
"RTN","SPNPSR03",24,0)
 ; Input:
"RTN","SPNPSR03",25,0)
 ;  ACTION,SEQUENCE = Search ACTION,SEQUENCE number
"RTN","SPNPSR03",26,0)
 ; Output:
"RTN","SPNPSR03",27,0)
 ;  SPNLEXIT = $S( User_Abort/Timeout : 1 , 1 : 0 )
"RTN","SPNPSR03",28,0)
 ;  ^TMP($J,"SPNPRT",ACTION,SEQUENCE,"RACE") = Internal ^ External
"RTN","SPNPSR03",29,0)
 ;  ^TMP($J,"SPNPRT",ACTION,SEQUENCE,0) = $$EN1^SPNPSR(D0,RACE)
"RTN","SPNPSR03",30,0)
 ;
"RTN","SPNPSR03",31,0)
 N DIR,DIRUT,DTOUT,DUOUT,RACE
"RTN","SPNPSR03",32,0)
 K ^TMP($J,"SPNPRT",ACTION,SEQUENCE),DIR
"RTN","SPNPSR03",33,0)
 S DIR(0)="POA^10:AEMNQZ"
"RTN","SPNPSR03",34,0)
 S DIR("A")="Patient race: "
"RTN","SPNPSR03",35,0)
 S DIR("?")="Enter a race from the list shown"
"RTN","SPNPSR03",36,0)
 D ^DIR S RACE=Y
"RTN","SPNPSR03",37,0)
 S SPNLEXIT=$S($D(DTOUT):1,$D(DUOUT):1,1:0)
"RTN","SPNPSR03",38,0)
 I 'SPNLEXIT,Y'="" D
"RTN","SPNPSR03",39,0)
 . S ^TMP($J,"SPNPRT",ACTION,SEQUENCE,"RACE")=RACE
"RTN","SPNPSR03",40,0)
 . S ^TMP($J,"SPNPRT",ACTION,SEQUENCE,0)="$$EN1^SPNPSR03(D0,"""_$P(RACE,U)_""")"
"RTN","SPNPSR03",41,0)
 Q
"VER")
8.0^22.0
**END**
**END**
