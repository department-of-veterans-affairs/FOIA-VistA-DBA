$TXT Created by ROWLANDS,ELMER at MNTVBB.FO-ALBANY.MED.VA.GOV  (KIDS) on Monday, 03/12/07 at 12:43
=============================================================================
Run Date: JUL 09, 2007                     Designation: TIU*1*205
Package : TIU - TEXT INTEGRATION UTILITIES    Priority: Mandatory
Version : 1       SEQ #212                      Status: Released
                  Compliance Date: AUG 09, 2007
=============================================================================

Associated patches: (v)TIU*1*179   <<= must be installed BEFORE `TIU*1*205'

Subject: FIX PROVIDER UPLOAD LOGIC

Category: 
  - Routine

Description:
============

 This patch addresses a problem in the TIU UPLOAD DOCUMENT function.  If a
 note is being uploaded for a visit/encounter that already exists, the
 current logic can, in some instances, change the primary and secondary
 providers on the encounter as well as add the default primary provider
 as a secondary provider when a primary provider already exists.
  
  
 ASSOCIATED REMEDY:
 ==================
 HD109953 - Primary provider changes when note uploaded
  
  
 PARTICIPATING TEST SITES:
 =========================
 Memphis VAMC
 Northern Indiana HCS
 Palo Alto HCS
  
  
 REMEDY OVERVIEW:
 ================
   Problem:
   --------
   If a site has the DEFAULT PRIMARY PROVIDER field (.08) in the TIU
   PARAMETER file (8925.99) set to 1 (DEFAULT, BY LOCATION), then 
   uploading a document can switch the existing primary and secondary
   providers. This will happen in the following circumstance:
      1) There is already an encounter for this date/time.
      2) The encounter has a secondary provider assigned (such as a nurse) 
         whose last name sorts alphabetically before the assigned primary
         provider.
      3) A user uploads a document where the author of the document is the
         current primary provider for the encounter.
  
   In this situation, the the current code will add the default provider
   as a secondary provider and switch the primary/secondary designations of
   the current providers. 
  
   Resolution:
   -----------
   In setting up the call to the DATA2PCE API, use the following business 
   rules:
      1) If the encounter already has a provider assigned then do not 
         add the default primary provider. Someone has already made that
         choice and it should not be overwritten by this process.
      2) Add the the author as a provider on the encounter, except for the
         case where the author is already on the encounter as the primary
         provider.
      3) These rules only apply when this API is called from a non GUI
         application. There is no change to the business logic when called
         from a GUI.
  
 NOTE:   This may cause changes that people need to be aware of. 
         Previously, the default primary provider was added to the 
         encounter as a secondary provider if the encounter already had
         a primary provider. This was actually an error. The default
         primary provider will be added to the encounter ONLY as a
         primary provider and ONLY if there is no current primary
         provider.
  
  
 INSTALLATION INSTRUCTIONS:
 ==========================
 This patch can be installed during business hours, but because some 
 options will be out of service during the installation process, it is
 suggested that it be queued for non-peak hours. Installation will take
 less than 5 minutes. Users do not have to be off the system
  
  
 1. Use the INSTALL/CHECK MESSAGE option on the PackMan menu. [Note: TEXT 
    PRINT/DISPLAY option in the PackMan menu still display the patch text
    only].
  
 2. From the Kernel Installation and Distribution System (KIDS) menu,
    select the Installation menu.
  
 3. From this menu, you may elect to use the following options:
    (when prompted for INSTALL NAME enter TIU*1.0*205)
    
    a. Backup a Transport Global - this option will create a backup message
       of any routines exported with the patch. It will NOT backup any 
       other changes such as DDs or templates.
    b. Compare Transport Global to Current System - this option will allow
       you to view all changes that will be made when the patch is 
       installed. It compares all components of the patch (routines, DDs, 
       templates, etc.).
    c. Verify Checksums in Transport Global - this option will allow you
       to ensure the integrity of the routines that are in the Transport
       Global.
    d. Print Transport Global - this option will allow you to view the
       components of the KIDS build.
  
 4. Use the Install Package(s) option and select the package TIU*1.0*205.
  
 5. If prompted: ' Want KIDS to Rebuild Menu Trees Upon Completion of
    Install? YES//' choose NO. 
  
 6. When prompted 'Want KIDS to INHIBIT LOGONs during the install? YES//', 
    respond NO
  
 7. When prompted 'Want to DISABLE Scheduled Options, Menu Options, and
    Protocols? YES//', respond YES.
  
 8. When prompted to select the options you would like to place out of
    of order, enter the following:
  
         TIU UPLOAD DOCUMENT
  
 9. When prompted to select the protocols you would like to place out of 
     order press <Enter>.
  
  
 ROUTINE SUMMARY:
 ================
 The following is a list of the routine(s) included in this patch.  The
 second line of each of these routine(s) will look like:
  
      ;;1.0;Text Integration Utilities;**[patch list]**;Jun 20, 1997
  
  
                         CHECK^XTSUMBLD results
  
  Routine name      Before Patch        After Patch        Patch List
  ============      ============        ===========        ===============
  TIUPXAP1           9884730               11413351        15,29,20,89,82,
                                                           107,117,126,124,
                                                           149,179,205

Routine Information:
====================
The checksums below are new checksums, and
 can be checked with CHECK1^XTSUMBLD.

Routine Name: TIUPXAP1
    Before: B26483700   After: B32890821  **15,29,20,89,82,107,117,126,
                                           124,149,179,205**
 
Routine list of preceding patches: 179

=============================================================================
User Information:
Entered By  : LUNDEN,JOHN                   Date Entered  : OCT 05, 2005
Completed By: WERNER,GARY                   Date Completed: JUN 28, 2007
Released By : GIVENS,DALE S                 Date Released : JUL 09, 2007
=============================================================================


Packman Mail Message:
=====================

$END TXT
