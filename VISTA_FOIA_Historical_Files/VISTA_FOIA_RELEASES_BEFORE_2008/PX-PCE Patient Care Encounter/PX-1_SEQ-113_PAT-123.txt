$TXT Created by PULEO,ANTHONY at DEVCUR.FO-SLC.MED.VA.GOV  (KIDS) on Tuesday, 09/14/04 at 09:44
=============================================================================
Run Date: SEP 27, 2004                     Designation: PX*1*123
Package : PX - PCE PATIENT CARE ENCOUNTER     Priority: Mandatory
Version : 1       SEQ #113                      Status: Released
                  Compliance Date: OCT 28, 2004
=============================================================================


Subject: ALLOW INDIVIDUAL HEALTH FACTOR IN HEALTH SUMMARY

Category: 
  - Routine
  - Enhancement (Mandatory)

Description:
============

 Description:
 ============
 Currently when running a Health Summary Report that returns Health Factor 
 data, the report may return more occurrences of the Health Factor than 
 what was specified in the report. This was caused by a design issue that
 counted all Health Factors done on the same day as one occurrence. This 
 patch will now count each individual Health Factor as a single occurrence.
 When running a Health summary report the user will now also be able to 
 retrieve data for individual Health Factors instead of just data for Health
 Factor categories. Once GMTS*2.7*63 is installed, sites will be able to run 
 Health Summary Reports for individual Health Factors.
   
 
 New Service Request (NSR):
 ==========================
 There is no NSR associated with this patch.
 
 NOIS message(s):
 ================
 PUG-0702-52485  H.S. type pulling in more than last occurrence
 
 Overview of NOIS Message(s):
 ============================
 Currently when running a Health Summary Report that returns Health Factor 
 data, the report may return more occurrences of the Health Factor than 
 what was specified in the report. This was caused by a design issue that
 counted all Health Factors done on the same day as one occurrence. This 
 patch will now count each individual Health Factor as a single occurrence.
 When running a Health summary report the user will now also be able to 
 retrieve data for individual Health Factors instead of just data for Health 
 Factor categories.
  
 
 Test Sites:
 ===========
 Tampa
 Washington D.C.
 Bronx
 Puget Sound
 Northern California
 
 
 ROUTINES:
 =========
 The following routines are included in this patch. The second line looks like:
 
   <tab>;;1.0;PCE PATIENT CARE ENCOUNTER;**13,123**;Aug 12, 1996
   Routine:        Old Checksum       New Checksum    Patch List
   ========        ============       ============    ==========
   PXRHS07           3570272             3899784        13,123
   
 Total number of routines - 1
 
  
 INSTALLATION INSTRUCTIONS
 =========================
 This patch should be loaded during non-peak hours to minimize disruption to 
 users, who can remain on the system during installation.  Installation will 
 take less then 2 minutes.
  
  1. Choose the PackMan message containing this patch and invoke the 
      INSTALL/CHECK MESSAGE PackMan option.  
              
  2. Review your mapped set. If any of the routines are mapped, they should
     be removed from the mapped set at this time.
 
  3. On the KIDS menu under the 'INSTALLATION' menu, use the following
     options as desired:
        Print Transport Global
        Compare Transport Global to Current System
        Verify checksums in Transport Global
        Backup a Transport Global
   
  4. On the KIDS menu under the 'INSTALLATION' menu, use the following 
     options to install the patch:
        Install Packages(s)  (PX*1.0*123)
   
  5. When prompted "Want KIDS to INHIBIT LOGON's during the install? YES//",
     respond "NO".
 
  6. When prompted "Want to DISABLE Scheduled Options, Menu Options, and 
     Protocols? YES//" respond "NO".
   
  7. If any routines were unmapped as part of step 2, they should be
     returned to the mapped set once the installation has run to completion.

Routine Information:
====================

Routine Name:
  - PXRHS07

 Replace
 
 I $D(ITEMS)'>0 D  Q
         . S PXHFC=0
         . F  S PXHFC=$O(^AUTTHF("AD","C",PXHFC)) Q:PXHFC'>0  D
 GETVHF(PXHFC,OCCL
 IM)
         I $D(ITEMS)>0 D
         . S PXHFC=0
         . F  S PXHFC=$O(ITEMS(PXHFC)) Q:PXHFC'>0  D GETVHF(PXHFC,OCCLIM)
 
 with
 
 I $D(ITEMS)'>0 D  Q
        .S PXHFC=0
        .F  S PXHFC=$O(^AUTTHF("AD","C",PXHFC)) Q:PXHFC'>0  D
 GETVHF(PXHFC,OCCLIN)
 ;Loop through the items array to find hf associate with category and
 'individual health factor placed finding into temp array & sort by alpha
 S ITEM=""
 F  S ITEM=$O(ITEMS(ITEM)) Q:ITEM=::  D
        .;If a category get all health factors in category.
        .I $P(^AUTTHS(ITEM,0),U,10)="C" D  Q
        ..;S CATNAME=$P(^AUTTHF(ITEM,0,U)
        ..;S HFIEN=""
        ..;F  S HFIEN=$O(^AUTTHF("AC",ITEM,HFIEN)) Q:HFIEN=""
        ..D GETVHF(ITEM,OCCLIM)
        .;If a factor just process it.
        .I $P(^AUTTHS(ITEM,0),U,10)="F" D
        ..S CATIEN=$P(^AUTTHS(ITEM,0),U,3)
        ..S CATNAME=$P(^AUTTHS(CATIE,0),U,1)
        ..D PHF(ITEM,OCCLIM)
 

Routine Checksum:
                           CHECK^XTSUMBLD results

       Routine          Before Patch     After Patch    Patch List 
       -------          ------------     -----------    ----------
       PXRHS07           3570272          3899784        13,123


=============================================================================
User Information:
Entered By  : ERIKSON,REX                   Date Entered  : APR 24, 2003
Completed By: RUDINGER,NANCY L.             Date Completed: SEP 24, 2004
Released By : FIELDS-BARNES,JANETTE         Date Released : SEP 27, 2004
=============================================================================


Packman Mail Message:
=====================

$END TXT
