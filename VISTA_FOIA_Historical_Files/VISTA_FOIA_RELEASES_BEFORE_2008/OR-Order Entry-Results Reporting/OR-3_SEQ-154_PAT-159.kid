Released OR*3*159 SEQ #154
Extracted from mail message
**KIDS**:OR*3.0*159^

**INSTALL NAME**
OR*3.0*159
"BLD",4007,0)
OR*3.0*159^ORDER ENTRY/RESULTS REPORTING^0^3030109^y
"BLD",4007,1,0)
^^2^2^3021031^
"BLD",4007,1,1,0)
The description of this build is found in the National Patch Module under 
"BLD",4007,1,2,0)
patch OR*3.0*159.
"BLD",4007,4,0)
^9.64PA^^
"BLD",4007,"INID")
^y
"BLD",4007,"INIT")
POST^ORP159
"BLD",4007,"KRN",0)
^9.67PA^8989.52^19
"BLD",4007,"KRN",.4,0)
.4
"BLD",4007,"KRN",.401,0)
.401
"BLD",4007,"KRN",.402,0)
.402
"BLD",4007,"KRN",.403,0)
.403
"BLD",4007,"KRN",.5,0)
.5
"BLD",4007,"KRN",.84,0)
.84
"BLD",4007,"KRN",3.6,0)
3.6
"BLD",4007,"KRN",3.8,0)
3.8
"BLD",4007,"KRN",9.2,0)
9.2
"BLD",4007,"KRN",9.8,0)
9.8
"BLD",4007,"KRN",9.8,"NM",0)
^9.68A^6^6
"BLD",4007,"KRN",9.8,"NM",1,0)
ORCXPINQ^^0^B40354893
"BLD",4007,"KRN",9.8,"NM",2,0)
ORCXPIN2^^0^B44511591
"BLD",4007,"KRN",9.8,"NM",3,0)
ORCXPND1^^0^B50191947
"BLD",4007,"KRN",9.8,"NM",4,0)
ORDV07^^0^B58266167
"BLD",4007,"KRN",9.8,"NM",5,0)
ORQPTQ3^^0^B6165751
"BLD",4007,"KRN",9.8,"NM",6,0)
ORCXPIN3^^0^B26284274
"BLD",4007,"KRN",9.8,"NM","B","ORCXPIN2",2)

"BLD",4007,"KRN",9.8,"NM","B","ORCXPIN3",6)

"BLD",4007,"KRN",9.8,"NM","B","ORCXPINQ",1)

"BLD",4007,"KRN",9.8,"NM","B","ORCXPND1",3)

"BLD",4007,"KRN",9.8,"NM","B","ORDV07",4)

"BLD",4007,"KRN",9.8,"NM","B","ORQPTQ3",5)

"BLD",4007,"KRN",19,0)
19
"BLD",4007,"KRN",19.1,0)
19.1
"BLD",4007,"KRN",101,0)
101
"BLD",4007,"KRN",409.61,0)
409.61
"BLD",4007,"KRN",771,0)
771
"BLD",4007,"KRN",870,0)
870
"BLD",4007,"KRN",8989.51,0)
8989.51
"BLD",4007,"KRN",8989.52,0)
8989.52
"BLD",4007,"KRN",8994,0)
8994
"BLD",4007,"KRN","B",.4,.4)

"BLD",4007,"KRN","B",.401,.401)

"BLD",4007,"KRN","B",.402,.402)

"BLD",4007,"KRN","B",.403,.403)

"BLD",4007,"KRN","B",.5,.5)

"BLD",4007,"KRN","B",.84,.84)

"BLD",4007,"KRN","B",3.6,3.6)

"BLD",4007,"KRN","B",3.8,3.8)

"BLD",4007,"KRN","B",9.2,9.2)

"BLD",4007,"KRN","B",9.8,9.8)

"BLD",4007,"KRN","B",19,19)

"BLD",4007,"KRN","B",19.1,19.1)

"BLD",4007,"KRN","B",101,101)

"BLD",4007,"KRN","B",409.61,409.61)

"BLD",4007,"KRN","B",771,771)

"BLD",4007,"KRN","B",870,870)

"BLD",4007,"KRN","B",8989.51,8989.51)

"BLD",4007,"KRN","B",8989.52,8989.52)

"BLD",4007,"KRN","B",8994,8994)

"BLD",4007,"QUES",0)
^9.62^^
"BLD",4007,"REQB",0)
^9.611^2^2
"BLD",4007,"REQB",1,0)
OR*3.0*148^2
"BLD",4007,"REQB",2,0)
OR*3.0*120^2
"BLD",4007,"REQB","B","OR*3.0*120",2)

"BLD",4007,"REQB","B","OR*3.0*148",1)

"INIT")
POST^ORP159
"MBREQ")
0
"PKG",110,-1)
1^1
"PKG",110,0)
ORDER ENTRY/RESULTS REPORTING^OR^Order Entry/Results Reporting
"PKG",110,20,0)
^9.402P^^
"PKG",110,22,0)
^9.49I^1^1
"PKG",110,22,1,0)
3.0^2971217
"PKG",110,22,1,"PAH",1,0)
159^3030109^1118
"PKG",110,22,1,"PAH",1,1,0)
^^2^2^3030109
"PKG",110,22,1,"PAH",1,1,1,0)
The description of this build is found in the National Patch Module under 
"PKG",110,22,1,"PAH",1,1,2,0)
patch OR*3.0*159.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
7
"RTN","ORCXPIN2")
0^2^B44511591
"RTN","ORCXPIN2",1,0)
ORCXPIN2 ; SLC/KER Patient Inquiry (cont)         ; 01/09/2003
"RTN","ORCXPIN2",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**159**;Dec 17,1997
"RTN","ORCXPIN2",3,0)
 ;
"RTN","ORCXPIN2",4,0)
 ; External References
"RTN","ORCXPIN2",5,0)
 ;                   
"RTN","ORCXPIN2",6,0)
 ;   DBIA  3796  ^DGS(41.1
"RTN","ORCXPIN2",7,0)
 ;   DBIA 10039  ^DIC(42,
"RTN","ORCXPIN2",8,0)
 ;   DBIA   723  ^DIC(42,
"RTN","ORCXPIN2",9,0)
 ;   DBIA   519  ^DIC(45.7
"RTN","ORCXPIN2",10,0)
 ;   DBIA  3797  ^DPT(  file #2
"RTN","ORCXPIN2",11,0)
 ;   DBIA 10035  ^DPT(  file #2
"RTN","ORCXPIN2",12,0)
 ;   DBIA 10040  ^SC(  file #44
"RTN","ORCXPIN2",13,0)
 ;   DBIA  3789  DIS^DGMTU
"RTN","ORCXPIN2",14,0)
 ;   DBIA 10036  ^DGPMLOS
"RTN","ORCXPIN2",15,0)
 ;   DBIA  2056  $$GET1^DIQ  (file #2, 200, 405 and 404.51)
"RTN","ORCXPIN2",16,0)
 ;   DBIA 10147  DISP^IBARXEU
"RTN","ORCXPIN2",17,0)
 ;   DBIA  2848  $$GETALL^SCAPMCA
"RTN","ORCXPIN2",18,0)
 ;   DBIA 10061  IN5^VADPT
"RTN","ORCXPIN2",19,0)
 ;   DBIA 10061  INP^VADPT
"RTN","ORCXPIN2",20,0)
 ;   DBIA 10103  $$FMTE^XLFDT
"RTN","ORCXPIN2",21,0)
 ;   DBIA 10104  $$UP^XLFSTR
"RTN","ORCXPIN2",22,0)
 Q
"RTN","ORCXPIN2",23,0)
OE ; Other Eligibilities
"RTN","ORCXPIN2",24,0)
 N OR1,OR2,ORI,ORC S ORC=0,OR1=$G(VAEL(1)) Q:+OR1'>0
"RTN","ORCXPIN2",25,0)
 W !,"Other Eligibilities: " I +($O(VAEL(1,0)))=0 W ?21,ORU Q
"RTN","ORCXPIN2",26,0)
 S ORI=0 F  S ORI=$O(VAEL(1,ORI)) Q:+ORI=0  D
"RTN","ORCXPIN2",27,0)
 . S OR2=$G(VAEL(1,ORI)) Q:+OR2=+OR1
"RTN","ORCXPIN2",28,0)
 . S ORC=ORC+1 W:ORC>1 ! W ?21,$P(OR2,"^",2)
"RTN","ORCXPIN2",29,0)
 I ORC=0 W ?21,ORU
"RTN","ORCXPIN2",30,0)
 Q
"RTN","ORCXPIN2",31,0)
CD ; Catastrophic Disabity Review Date
"RTN","ORCXPIN2",32,0)
 N ORD S ORD=$$GET1^DIQ(2,(+DFN_","),.394,"I")
"RTN","ORCXPIN2",33,0)
 I +ORD S ORD=$$ED^ORCXPINQ(ORD) W !!,"Catastrophically Disabled Review Date: ",ORD
"RTN","ORCXPIN2",34,0)
 Q
"RTN","ORCXPIN2",35,0)
MT ; Means Test
"RTN","ORCXPIN2",36,0)
 Q:+($$DOM^ORCXPINQ)>0  D DIS^DGMTU(DFN)
"RTN","ORCXPIN2",37,0)
 Q
"RTN","ORCXPIN2",38,0)
CP ; Copayment Exemptions
"RTN","ORCXPIN2",39,0)
 Q:+($$DOM^ORCXPINQ)>0  N VAIN,VAIP,VAERR D IN5^VADPT Q:$G(VAIP(1))'=""  D DISP^IBARXEU(DFN,DT,3,1)
"RTN","ORCXPIN2",40,0)
 Q
"RTN","ORCXPIN2",41,0)
PCMM ; Primary Care
"RTN","ORCXPIN2",42,0)
 K ^TMP("ORPLIST",$J)
"RTN","ORCXPIN2",43,0)
 N OROK,ORI,ORN,ORP,ORG,ORS,ORDATE,ORLIST,SDLN S ORDATE="ORDATE",ORLIST="^TMP(""ORPLIST"",$J)",SDLN=2
"RTN","ORCXPIN2",44,0)
 S OROK=0,ORI=$$GETALL^SCAPMCA(DFN,.ORDATE,ORLIST)
"RTN","ORCXPIN2",45,0)
 S ORI=0 F  S ORI=$O(^TMP("ORPLIST",$J,DFN,"PCTM",ORI)) Q:'ORI  D  Q:+($G(OROK))>0
"RTN","ORCXPIN2",46,0)
 . S ORN=$G(^TMP("ORPLIST",$J,DFN,"PCTM",ORI)) Q:'$L(ORN)
"RTN","ORCXPIN2",47,0)
 . S ORP=$$GET1^DIQ(404.51,(+ORN_","),.02),ORN=$P(ORN,"^",2)
"RTN","ORCXPIN2",48,0)
 . W:$L(ORN)!($L(ORP)) !!,?1,"Primary Care Team: ",$G(ORN),?52,"Phone: ",$G(ORP)
"RTN","ORCXPIN2",49,0)
 . S:$L(ORN)!($L(ORP)) OROK=1
"RTN","ORCXPIN2",50,0)
 Q:+($G(OROK))'>0
"RTN","ORCXPIN2",51,0)
 S ORI=0 F  S ORI=$O(^TMP("ORPLIST",$J,DFN,"PCPR",ORI)) Q:'ORI  D
"RTN","ORCXPIN2",52,0)
 . S PROV=$G(^TMP("ORPLIST",$J,DFN,"PCPR",ORI)) Q:'$L(PROV)
"RTN","ORCXPIN2",53,0)
 . S ORP=$$PH^ORCXPINQ(+PROV),ORG=$$PG^ORCXPINQ(+PROV),ORS=$P(PROV,U,4),PROV=$P(PROV,U,2)
"RTN","ORCXPIN2",54,0)
 . W !,?7,"PC Provider: ",$E(PROV,1,28),?49,"Position: ",$E(ORS,1,18)
"RTN","ORCXPIN2",55,0)
 . W !,?13,"Pager: ",ORG,?52,"Phone: ",$G(ORP)
"RTN","ORCXPIN2",56,0)
 S ORI=0 F  S ORI=$O(^TMP("ORPLIST",$J,DFN,"PCAP",ORI)) Q:'ORI  D
"RTN","ORCXPIN2",57,0)
 . S PROV=$G(^TMP("ORPLIST",$J,DFN,"PCAP",ORI)) Q:'$L(PROV)
"RTN","ORCXPIN2",58,0)
 . S ORP=$$PH^ORCXPINQ(+PROV),ORG=$$PG^ORCXPINQ(+PROV),ORS=$P(PROV,U,4),PROV=$P(PROV,U,2)
"RTN","ORCXPIN2",59,0)
 . W !,"Associate Provider: ",$E(PROV,1,28),?49,"Position: ",$E(ORS,1,18)
"RTN","ORCXPIN2",60,0)
 . W !,?13,"Pager: ",ORG,?52,"Phone: ",$G(ORP)
"RTN","ORCXPIN2",61,0)
 K ^TMP("ORPLIST",$J)
"RTN","ORCXPIN2",62,0)
 Q
"RTN","ORCXPIN2",63,0)
CSTAT ;Current Status
"RTN","ORCXPIN2",64,0)
 N DGPMDCD,DGPMIFN,DGPMT,ORACT,ORMV,ORM,ORTYPE,VAERR,VAIP,VAIN,VAHOW,VAROOT,VAINDT,X
"RTN","ORCXPIN2",65,0)
 D INP^VADPT S VAIP("D")="LAST" D IN5^VADPT
"RTN","ORCXPIN2",66,0)
 S ORMV=$S($L($G(VAIP(1))):1,1:0)
"RTN","ORCXPIN2",67,0)
 S ORM(1)=$G(VAIP(1)),ORM(2)=$P($G(VAIP(2)),"^",1)
"RTN","ORCXPIN2",68,0)
 S ORM(3)=$G(VAIP(3)),ORM(3,"I")=(9999999.999999-(+($G(VAIP(3)))))_"9"
"RTN","ORCXPIN2",69,0)
 S ORM(4)=$P($G(VAIP(4)),"^",1),ORM(5)=$G(VAIP(5))
"RTN","ORCXPIN2",70,0)
 S ORM(6)=$P($G(VAIP(6)),"^",1)_"^"_$P($G(VAIP(6)),"^",2)
"RTN","ORCXPIN2",71,0)
 S ORM(7)=$G(VAIP(7)),ORM(8)=$G(VAIP(8)),ORM(13)=$G(VAIP(13))
"RTN","ORCXPIN2",72,0)
 S ORM(13,1)=$G(VAIP(13,1)),ORM(17)=$G(VAIP(17)),ORM(18)=$G(VAIP(18))
"RTN","ORCXPIN2",73,0)
 S DGPMT=0,X=1
"RTN","ORCXPIN2",74,0)
 I 'ORMV D  Q
"RTN","ORCXPIN2",75,0)
 . W !!,"Status      : PATIENT HAS NO INPATIENT OR LODGER ACTIVITY IN THE COMPUTER",*7
"RTN","ORCXPIN2",76,0)
 S ORACT=$S("^3^5^"[("^"_+ORM(2)_"^"):0,1:+ORM(2))
"RTN","ORCXPIN2",77,0)
 W !!,"Status      : ",$S('ORACT:"IN",1:""),"ACTIVE ",$S("^4^5^"[("^"_+ORM(2)_"^"):"LODGER",1:"INPATIENT")
"RTN","ORCXPIN2",78,0)
 I 'ORACT D MOV Q
"RTN","ORCXPIN2",79,0)
 W "-" S ORTYPE=+ORM(4) I ORTYPE=1 W "on PASS" D MOV Q
"RTN","ORCXPIN2",80,0)
 I "^2^3^25^26^"[("^"_ORTYPE_"^") D  D MOV Q
"RTN","ORCXPIN2",81,0)
 . W "on ",$S("^2^26^"[ORTYPE:"A",1:"U"),"A"
"RTN","ORCXPIN2",82,0)
 I "^13^43^44^45^"[("^"_ORTYPE_"^") W "ASIH" D MOV Q
"RTN","ORCXPIN2",83,0)
 I ORTYPE=6 W "OTHER FAC" D MOV Q
"RTN","ORCXPIN2",84,0)
 W "on WARD" D MOV
"RTN","ORCXPIN2",85,0)
 Q
"RTN","ORCXPIN2",86,0)
MOV ; Movement
"RTN","ORCXPIN2",87,0)
 I +ORM(2)=3,+ORM(17)>0 D
"RTN","ORCXPIN2",88,0)
 . N ORMTN S ORMTN=$$GET1^DIQ(405,(+ORM(17)_","),.04) S:'$L(ORMTN) ORMTN="UNKNOWN"
"RTN","ORCXPIN2",89,0)
 . W ?39,"Discharge Type : ",ORMTN
"RTN","ORCXPIN2",90,0)
 I "^3^4^5^"'[("^"_+ORM(2)_"^"),$D(^DPT(DFN,"DAC")) D
"RTN","ORCXPIN2",91,0)
 . W:$$GET1^DIQ(2,(DFN_","),401.3,"I")="S" "  (Seriously ill)"
"RTN","ORCXPIN2",92,0)
 W !!,$S("^4^5^"'[("^"_+ORM(2)_"^"):"Admitted    ",1:"Checked-in  ")
"RTN","ORCXPIN2",93,0)
 W ": "_$P(ORM(13,1),"^",2)
"RTN","ORCXPIN2",94,0)
 W ?39,$S("^4^5^"[("^"_+ORM(2)_"^"):"Checked-out",+ORM(2)=3:"Discharged ",1:"Transferred")
"RTN","ORCXPIN2",95,0)
 W "    : ",$S("^1^4^"'[("^"_+ORM(2)_"^"):$P(ORM(3),"^",2),$P(ORM(3),"^",2)'=$P(ORM(13,1),"^",2):$P(ORM(3),"^",2),1:"")
"RTN","ORCXPIN2",96,0)
 W !,"Ward        : ",$E($P(ORM(5),"^",2),1,24)
"RTN","ORCXPIN2",97,0)
 W ?39,"Room-Bed       : ",$E($P(ORM(6),"^",2),1,21) I "^4^5^"'[("^"_+ORM(2)_"^") W !,"Provider    : ",$E($P(ORM(7),"^",2),1,26),?39,"Specialty      : ",$E($P(ORM(8),"^",2),1,21)
"RTN","ORCXPIN2",98,0)
 W !,"Attending   : ",$E($P(ORM(18),"^",2),1,26)
"RTN","ORCXPIN2",99,0)
 I +ORM(2)'=4&(+ORM(2)'=5) D
"RTN","ORCXPIN2",100,0)
 . N DGPMIFN S DGPMIFN=ORM(13) D ^DGPMLOS
"RTN","ORCXPIN2",101,0)
 . W !!,"Admission LOS: ",+$P(X,"^8",5),"  Absence days: ",+$P(X,"^",2)
"RTN","ORCXPIN2",102,0)
 . W "  Pass Days: ",+$P(X,"^",3),"  ASIH days: ",+$P(X,"^",4)
"RTN","ORCXPIN2",103,0)
 Q
"RTN","ORCXPIN2",104,0)
SA ; Scheduled/Admit
"RTN","ORCXPIN2",105,0)
 N ORI S ORI=0 F  S ORI=$O(^DGS(41.1,"B",DFN,ORI)) Q:+ORI=0  D
"RTN","ORCXPIN2",106,0)
 . N ORND S ORND=^DGS(41.1,ORI,0)
"RTN","ORCXPIN2",107,0)
 . I $P(ORND,"^",2)>(DT-1),$P(ORND,"^",13)']"",'$P(ORND,"^",17) D
"RTN","ORCXPIN2",108,0)
 . . N ORDT,ORWARD,ORTSPC S ORDT=$P(ORND,"^",2),ORWARD=$P($G(^DIC(42,+$P(ORND,U,8),0)),U,1),ORTSPC=$P($G(^DIC(45.7,+$P(ORND,U,9),0)),U,1)
"RTN","ORCXPIN2",109,0)
 . . W !!,?14,"Scheduled Admit" W:$L(ORWARD) " on ward "_ORWARD
"RTN","ORCXPIN2",110,0)
 . . W:$L(ORTSPC) " for treating specialty "_ORTSPC W " on "_$$FMTE^XLFDT(ORDT,"5DZ")
"RTN","ORCXPIN2",111,0)
 I +($O(^DPT(DFN,"DE",0)))>0 D
"RTN","ORCXPIN2",112,0)
 . N ORFIST,ORLAST,ORCT S ORFIST=+($O(^DPT(DFN,"DE",0))),ORLAST=+($O(^DPT(DFN,"DE"," "),-1))
"RTN","ORCXPIN2",113,0)
 . S ORCT=0,ORI=0 F  S ORI=$O(^DPT(DFN,"DE",ORI)) Q:+ORI=0  D
"RTN","ORCXPIN2",114,0)
 . . N ORSTAT,ORCLIN,ORADMT,ORNAME Q:'$D(^DPT(DFN,"DE",ORI,0))
"RTN","ORCXPIN2",115,0)
 . . S ORSTAT=$P(^DPT(DFN,"DE",ORI,0),"^",2),ORCLIN=+($P(^DPT(DFN,"DE",ORI,0),"^",1)),ORADMT=$P(^DPT(DFN,"DE",ORI,0),"^",17)
"RTN","ORCXPIN2",116,0)
 . . I ORSTAT'="I",+ORFIST>0 D
"RTN","ORCXPIN2",117,0)
 . . . S ORCT=ORCT+1 W:ORCT=1 !!,"Currently enrolled in " S ORNAME=$$UP^XLFSTR($P($G(^SC(+ORCLIN,0)),"^",1))
"RTN","ORCXPIN2",118,0)
 . . . W:$X>50 !,?22 W $S($L(ORNAME)&(+ORLAST'=ORI):ORNAME_",",$L(ORNAME)&(+ORLAST=ORI):ORNAME,1:"")
"RTN","ORCXPIN2",119,0)
 Q
"RTN","ORCXPIN2",120,0)
FA ; Future Appointments
"RTN","ORCXPIN2",121,0)
 N ORAPPT,ORDT,ORD,ORT,ORC,ORI,ORFA,ORND,ORCLIN,ORSTAT,ORMK
"RTN","ORCXPIN2",122,0)
 S ORC=0,ORMK=$P(^DPT(DFN,0),"^",10) S:ORMK["[" ORMK=$P(ORMK,"[",1)_" ["_$P(ORMK,"[",2,299) S:$E(ORMK,1)=" " ORMK=$E(ORMK,2,$L(ORMK))
"RTN","ORCXPIN2",123,0)
 W !!,"Future Appointments: " I $O(^DPT(DFN,"S",DT))'>0 W ?22,"NONE",!!,"Remarks: ",ORMK Q
"RTN","ORCXPIN2",124,0)
 W ?22,"Date",?33,"Time",?39,"Clinic",!,?22 F ORI=22:1:75 W "="
"RTN","ORCXPIN2",125,0)
 S ORFA=+($G(DT)) F  S ORFA=$O(^DPT(DFN,"S",ORFA)) Q:+ORFA=0  D  Q:ORC>4
"RTN","ORCXPIN2",126,0)
 . N ORA S ORA=ORFA,ORND=^DPT(DFN,"S",ORFA,0),ORCLIN=+ORND
"RTN","ORCXPIN2",127,0)
 . I $P(ORND,"^",2)'["C" D
"RTN","ORCXPIN2",128,0)
 . . S ORSTAT=$S($P(ORND,"^",7)=7:" (Collateral) ",1:"")
"RTN","ORCXPIN2",129,0)
 . . S ORSTAT=ORSTAT_$S($P(ORND,"^",2)["NT":" * NO ACTION TAKEN *",$P(ORND,"^",2)["N":" * NO-SHOW *",1:"")
"RTN","ORCXPIN2",130,0)
 . . S ORDT=$E(ORFA,1,12) Q:+ORDT<DT  S ORC=ORC+1,ORAPPT=$$FMTE^XLFDT(ORDT,"5Z")
"RTN","ORCXPIN2",131,0)
 . . W !,?22,$P(ORAPPT,"@"),?33,$P(ORAPPT,"@",2)
"RTN","ORCXPIN2",132,0)
 . . W ?39,$P($S($D(^SC(ORCLIN,0)):^SC(ORCLIN,0),1:""),"^")," ",ORSTAT
"RTN","ORCXPIN2",133,0)
 I $O(^DPT(DFN,"S",ORFA))>0 W !,?22,"See Scheduling options for additional appointments."
"RTN","ORCXPIN2",134,0)
 W !!,"Remarks: ",ORMK
"RTN","ORCXPIN2",135,0)
 Q
"RTN","ORCXPIN3")
0^6^B26284274
"RTN","ORCXPIN3",1,0)
ORCXPIN3 ; SLC/KER Patient Inquiry (cont)      ; 01/09/2003
"RTN","ORCXPIN3",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**159**;Dec 17, 1997
"RTN","ORCXPIN3",3,0)
 ;
"RTN","ORCXPIN3",4,0)
 ; External References
"RTN","ORCXPIN3",5,0)
 ;   DBIA 10035  ^DPT(  file #2
"RTN","ORCXPIN3",6,0)
 ;   DBIA   700  DIS^DGRPDB
"RTN","ORCXPIN3",7,0)
 ;   DBIA  2051  LIST^DIC
"RTN","ORCXPIN3",8,0)
 ;   DBIA  2056  $$GET1^DIQ  (file #2)
"RTN","ORCXPIN3",9,0)
 ;   DBIA 10146  DISP^IBCNS
"RTN","ORCXPIN3",10,0)
 ;   DBIA  1254  $$OUTPTPR^SDUTL3
"RTN","ORCXPIN3",11,0)
 ;   DBIA  1254  $$OUTPTTM^SDUTL3
"RTN","ORCXPIN3",12,0)
 ;   DBIA 10061  OAD^VADPT
"RTN","ORCXPIN3",13,0)
 ;   DBIA 10104  $$UP^XLFSTR
"RTN","ORCXPIN3",14,0)
 ;                  
"RTN","ORCXPIN3",15,0)
 Q
"RTN","ORCXPIN3",16,0)
PC ; Primary Care
"RTN","ORCXPIN3",17,0)
 N DIERR,DISYS,ORDOC,ORTEAM S ORDOC=$$OUTPTPR^SDUTL3(DFN),ORTEAM=$$OUTPTTM^SDUTL3(DFN)
"RTN","ORCXPIN3",18,0)
 I ORDOC!ORTEAM  D
"RTN","ORCXPIN3",19,0)
 . W !!,"Primary Care Information:"
"RTN","ORCXPIN3",20,0)
 . W:ORDOC !,"Primary Practitioner:  ",$P(ORDOC,"^",2)
"RTN","ORCXPIN3",21,0)
 . W:ORTEAM !,"Primary Care Team:     ",$P(ORTEAM,"^",2)
"RTN","ORCXPIN3",22,0)
 Q
"RTN","ORCXPIN3",23,0)
INS ; Insurance
"RTN","ORCXPIN3",24,0)
 W !!,"Health Insurance Information:"
"RTN","ORCXPIN3",25,0)
 D DISP^IBCNS
"RTN","ORCXPIN3",26,0)
 Q
"RTN","ORCXPIN3",27,0)
SVCD ; Service Connection/Disabilities
"RTN","ORCXPIN3",28,0)
 W !!,"Service Connection/Rated Disabilities:"
"RTN","ORCXPIN3",29,0)
 D DIS^DGRPDB
"RTN","ORCXPIN3",30,0)
 Q
"RTN","ORCXPIN3",31,0)
NOK ; Next of Kin
"RTN","ORCXPIN3",32,0)
 N %,%H,STR,STR1,STR2,LBL1,LBL2,NOKTYPE,NOKWP,ADR,VAERR,VAOA K VAOA("A") D OAD^VADPT I $L($G(VAOA(9))) D
"RTN","ORCXPIN3",33,0)
 . W !!,"Next of Kin Information:"
"RTN","ORCXPIN3",34,0)
 . S NOKTYPE="Primary",NOKWP=$$GET1^DIQ(2,(+($G(DFN))_","),.21011) D DNOK
"RTN","ORCXPIN3",35,0)
 . S VAOA("A")=3 D OAD^VADPT I $L($G(VAOA(9))) S NOKTYPE="Secondary",NOKWP=$$GET1^DIQ(2,(+($G(DFN))_","),.211011) D DNOK
"RTN","ORCXPIN3",36,0)
 Q
"RTN","ORCXPIN3",37,0)
DNOK ;   Display Next of Kin
"RTN","ORCXPIN3",38,0)
 W ! N I,COL1,COL2,C1,C2,STR1,STR2,BL,LBL1,LBL2 S I=1 S COL1(I)=NOKTYPE_" NOK"_"^"_$$UP^XLFSTR(VAOA(9))
"RTN","ORCXPIN3",39,0)
 S COL2(I)="Relation"_"^"_$S('$L(VAOA(10)):"<not given>",1:$$REL($$UP^XLFSTR(VAOA(10)))),I=I+1
"RTN","ORCXPIN3",40,0)
 S ADR=$G(VAOA(1)) K VAOA(1) I '$L(ADR) S ADR=$G(VAOA(2)) K VAOA(2) I '$L(ADR) S ADR=$G(VAOA(3)) K VAOA(3)
"RTN","ORCXPIN3",41,0)
 S STR=$S('$L(ADR):"<street address not available>",1:$$UP^XLFSTR(ADR))
"RTN","ORCXPIN3",42,0)
 K:STR="<street address not available>" VAOA(1),VAOA(2),VAOA(3)
"RTN","ORCXPIN3",43,0)
 S COL1(I)="^"_STR S:$L(STR) COL2(I)="Phone"_"^"_VAOA(8),I=I+1 S:$L($G(NOKWP)) COL2(I)="Wk Phone"_"^"_$G(NOKWP)
"RTN","ORCXPIN3",44,0)
 S ADR=$G(VAOA(2)) K VAOA(2) I '$L(ADR) S ADR=$G(VAOA(3)) K VAOA(3)
"RTN","ORCXPIN3",45,0)
 S STR=$$UP^XLFSTR(ADR) S:$L(STR) COL1(I)="^"_STR,I=I+1 S ADR=$G(VAOA(3))
"RTN","ORCXPIN3",46,0)
 S STR=$$UP^XLFSTR(ADR) S:$L(STR) COL1(I)="^"_STR,I=I+1 I VAOA(4)'="" D
"RTN","ORCXPIN3",47,0)
 . S STR=$$UP^XLFSTR(VAOA(4)) S:VAOA(5) STR=STR_", "_$$UP^XLFSTR($P(VAOA(5),U,2))
"RTN","ORCXPIN3",48,0)
 . S:VAOA(6) STR=STR_"  "_$$UP^XLFSTR(VAOA(6)) S:$L(STR) COL1(I)="^"_STR
"RTN","ORCXPIN3",49,0)
 F I=1:1 Q:'$D(COL1(I))&('$D(COL2(I)))  D
"RTN","ORCXPIN3",50,0)
 . S BL="",LBL1=$P($G(COL1(I)),"^",1),STR1=$P($G(COL1(I)),"^",2),LBL2=$P($G(COL2(I)),"^",1),STR2=$P($G(COL2(I)),"^",2)
"RTN","ORCXPIN3",51,0)
 . S BL=$J("",(14-$L(LBL1))),LBL1=BL_LBL1_$S($L(LBL1)>0:": ",1:"  ")
"RTN","ORCXPIN3",52,0)
 . S BL=$J("",(((54-$L(LBL1))-$L(LBL2))-2)),STR1=$E(STR1,1,$L(BL)),C1=LBL1_STR1
"RTN","ORCXPIN3",53,0)
 . S BL=$J("",((54-$L(C1))-$L(LBL2))),LBL2=BL_LBL2_$S($L(LBL2)>0:":",1:"  ")
"RTN","ORCXPIN3",54,0)
 . S C2=LBL2_$E(STR2,1,17),STR=C1_C2 W $G(STR),!
"RTN","ORCXPIN3",55,0)
 Q
"RTN","ORCXPIN3",56,0)
REL(X) ; Relation
"RTN","ORCXPIN3",57,0)
 S X=$$UP^XLFSTR($G(X)) Q:'$L(X)  S:X="W" X="SPOUSE" S:X="H" X="SPOUSE" S:X="B" X="BROTHER" S:X="S" X="SISTER" S:X="A" X="AUNT" S:X="U" X="UNCLE" S:X="C" X="COUSIN"
"RTN","ORCXPIN3",58,0)
 S:"WIFE"[X X="SPOUSE" S:"HUSBAND"[X X="SPOUSE" S:"NONE"[X X="NONE" S:"UNKNOWN"[X X="UNKNOWN"
"RTN","ORCXPIN3",59,0)
 S:"BROTHER"[X X="BROTHER" S:"BROTHER"'[X&("BROTHER-IN-LAW"[X) X="BROTHER-IN-LAW" S:"BROTHER"'[X&("BROTHER IN LAW"[X) X="BROTHER-IN-LAW" S:$E(X,1,3)="BRO"&("BROTHER"'[X) X="BROTHER-IN-LAW"
"RTN","ORCXPIN3",60,0)
 S:"SISTER"[X X="SISTER" S:"SISTER"'[X&("SISTER-IN-LAW"[X) X="SISTER-IN-LAW" S:"SISTER"'[X&("SISTER IN LAW"[X) X="SISTER-IN-LAW" S:$E(X,1,3)="SIS"&("SISTER"'[X) X="SISTER-IN-LAW"
"RTN","ORCXPIN3",61,0)
 S:"AUNT"[X X="AUNT" S:"UNCLE"[X X="UNCLE" S:"COUSIN"[X X="COUSIN" S:"FATHER"[X X="FATHER" S:"MOTHER"[X X="MOTHER"
"RTN","ORCXPIN3",62,0)
 S:"FATHER"'[X&("GRANDFATHER"[X) X="GRANDFATHER" S:"FATHER"'[X&("GRAND FATHER"[X) X="GRANDFATHER" S:"MOTHER"'[X&("GRANDMOTHER"[X) X="GRANDMOTHER" S:"MOTHER"'[X&("GRAND MOTHER"[X) X="GRANDMOTHER"
"RTN","ORCXPIN3",63,0)
 S:"SON"[X X="SON" S:"SON"'[X&("SON-IN-LAW"[X) X="SON-IN-LAW" S:"SON"'[X&("SON IN LAW"[X) X="SON-IN-LAW" S:$E(X,1,3)="SON"&("SON"'[X) X="SON-IN-LAW"
"RTN","ORCXPIN3",64,0)
 S:"DAUGHTER"[X X="DAUGHTER" S:"DAUGHTER"'[X&("DAUGHTER-IN-LAW"[X) X="DAUGHTER-IN-LAW" S:"DAUGHTER"'[X&("DAUGHTER IN LAW"[X) X="DAUGHTER-IN-LAW" S:$E(X,1,3)="DAU"&("DAUGHTER"'[X) X="DAUGHTER-IN-LAW"
"RTN","ORCXPIN3",65,0)
 S:"NIECE"'[X&("NIECE IN LAW"[X) X="NIECE" S:"NEPHEW"'[X&("NEPHEW IN LAW"[X) X="NEPHEW"
"RTN","ORCXPIN3",66,0)
 Q X
"RTN","ORCXPIN3",67,0)
 Q
"RTN","ORCXPIN3",68,0)
ALIAS ;
"RTN","ORCXPIN3",69,0)
 N ORC,ORI,ORN,ORS,ORA,ORM S (ORA,ORM)="" K ^TMP("DILIST",$J)
"RTN","ORCXPIN3",70,0)
 D LIST^DIC(2.01,(","_DFN_","),".01E;1E",,"*",,,,,.ORA,.ORM)
"RTN","ORCXPIN3",71,0)
 I +($G(^TMP("DILIST",$J,0)))'>0 K ^TMP("DILIST",$J) Q
"RTN","ORCXPIN3",72,0)
 S (ORC,ORI)=0 F  S ORI=$O(^TMP("DILIST",$J,ORI)) Q:+ORI=0  D
"RTN","ORCXPIN3",73,0)
 . S ORN=$G(^TMP("DILIST",$J,"ID",ORI,.01)) Q:'$L(ORN)
"RTN","ORCXPIN3",74,0)
 . S ORS=$G(^TMP("DILIST",$J,"ID",ORI,1)) S:$L(ORS)=9 ORS=$E(ORS,1,3)_"-"_$E(ORS,4,5)_"-"_$E(ORS,6,9) S:$L(ORS)'=11 ORS=""
"RTN","ORCXPIN3",75,0)
 . S ORC=ORC+1 W:+ORC=1 !,"Patient also known as:"
"RTN","ORCXPIN3",76,0)
 . W !,?9,ORN,?46,$S($L(ORS):"SSN:  ",1:""),ORS
"RTN","ORCXPIN3",77,0)
 W:+ORC>0 ! K ^TMP("DILIST",$J)
"RTN","ORCXPIN3",78,0)
 Q
"RTN","ORCXPINQ")
0^1^B40354893
"RTN","ORCXPINQ",1,0)
ORCXPINQ ; SLC/KER Patient Inquiry                ; 01/09/2003
"RTN","ORCXPINQ",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**159**;Dec 17,1997
"RTN","ORCXPINQ",3,0)
 ;
"RTN","ORCXPINQ",4,0)
 ; External References
"RTN","ORCXPINQ",5,0)
 ;   DBIA  3797  ^DPT(  file #2
"RTN","ORCXPINQ",6,0)
 ;   DBIA 10035  ^DPT(  file #2
"RTN","ORCXPINQ",7,0)
 ;   DBIA 10056  ^DIC(5, 
"RTN","ORCXPINQ",8,0)
 ;   DBIA   483  ^DG(43,
"RTN","ORCXPINQ",9,0)
 ;   DBIA 10039  ^DIC(42,
"RTN","ORCXPINQ",10,0)
 ;   DBIA   723  ^DIC(42,
"RTN","ORCXPINQ",11,0)
 ;   DBIA  2051  $$FIND1^DIC  (file #4)
"RTN","ORCXPINQ",12,0)
 ;   DBIA  2056  $$GET1^DIQ  (file #2, 5, and 43)
"RTN","ORCXPINQ",13,0)
 ;   DBIA 10061  ADD^VADPT
"RTN","ORCXPINQ",14,0)
 ;   DBIA 10061  DEM^VADPT
"RTN","ORCXPINQ",15,0)
 ;   DBIA 10061  ELIG^VADPT
"RTN","ORCXPINQ",16,0)
 ;   DBIA 10061  INP^VADPT
"RTN","ORCXPINQ",17,0)
 ;   DBIA  2171  $$NS^XUAF4
"RTN","ORCXPINQ",18,0)
 ;   DBIA 10086  ^%ZIS
"RTN","ORCXPINQ",19,0)
 ;   DBIA 10103  $$DT^XLFDT
"RTN","ORCXPINQ",20,0)
 ;   DBIA 10022  %XY^%RCR
"RTN","ORCXPINQ",21,0)
 ;   DBIA 10017  ^DD("DD")
"RTN","ORCXPINQ",22,0)
 ;                   
"RTN","ORCXPINQ",23,0)
EN ; Display Patient Inquiry - input DFN
"RTN","ORCXPINQ",24,0)
 N %I,%T,%X,%Y,ORABBR,ORCMOR,DGPMDCD,DGPMIFN,DGPMT,DGPMV1,DGPMVI
"RTN","ORCXPINQ",25,0)
 N DGSWITCH,ORLOC,ORMPI,OR1,OR2,ORA,ORAMT,ORAPPT,ORC,ORCC,ORCLIN
"RTN","ORCXPINQ",26,0)
 N ORCT,ORD,ORDATE,ORDT,ORE,ORFA,ORFIST,ORFM,ORFT,ORG,ORI,ORLAST
"RTN","ORCXPINQ",27,0)
 N ORLIST,ORMK,ORN,ORNAME,ORND,ORO,OROK,ORON,ORP,ORPA,ORPH,ORR
"RTN","ORCXPINQ",28,0)
 N ORRT,ORS,ORST,ORT,ORTA,ORTO,ORTP,ORTSPC,ORU,ORWARD,ORX,ORX1
"RTN","ORCXPINQ",29,0)
 N ORX2,ORX3,PGR,SDLN,VA,VADM,VAEL,VAERR,VAIN,VAIP,VAPA,X,Y
"RTN","ORCXPINQ",30,0)
 W:'$D(DFN) !,"Patient not defined." Q:'$D(DFN)
"RTN","ORCXPINQ",31,0)
 W:$D(DFN)&(+($G(DFN))'>0) !,"Invalid Patient." Q:+($G(DFN))'>0
"RTN","ORCXPINQ",32,0)
 W:$D(DFN)&(+($G(DFN))>0)&('$L($$GET1^DIQ(2,(+DFN_","),.01))) !,"Patient not found" Q:'$L($$GET1^DIQ(2,(+DFN_","),.01))
"RTN","ORCXPINQ",33,0)
 N X,VAEL,VADM,VA,VAERR,ORTA,ORPA,ORU S ORU="UNSPECIFIED"
"RTN","ORCXPINQ",34,0)
 S ORABBR=+($$GET1^DIQ(43,(1_","),38,"I"))
"RTN","ORCXPINQ",35,0)
 D DEM^VADPT,ELIG^VADPT
"RTN","ORCXPINQ",36,0)
 D HDR,ALIAS^ORCXPIN3,ADR,CTFMTO,PHN,OFF,PMD,RS,RE,POS,PE
"RTN","ORCXPINQ",37,0)
 D OE^ORCXPIN2,CD^ORCXPIN2,MT^ORCXPIN2,CP^ORCXPIN2,PCMM^ORCXPIN2
"RTN","ORCXPINQ",38,0)
 D CSTAT^ORCXPIN2,SA^ORCXPIN2,FA^ORCXPIN2,PC^ORCXPIN3
"RTN","ORCXPINQ",39,0)
 D INS^ORCXPIN3,SVCD^ORCXPIN3,NOK^ORCXPIN3
"RTN","ORCXPINQ",40,0)
 Q
"RTN","ORCXPINQ",41,0)
HDR ; Header - Name, SSN, Date, Coordinating Master of Record
"RTN","ORCXPINQ",42,0)
 N ORCMOR,ORMPI,ORLOC S ORCMOR="UNSPECIFIED",ORMPI=$G(^DPT(+DFN,"MPI")),ORLOC=$$FIND1^DIC(4,"","MX","`"_+$P(ORMPI,U,3))
"RTN","ORCXPINQ",43,0)
 S ORLOC=$S(+ORLOC>0:$P($$NS^XUAF4(ORLOC),U),1:"NOT LISTED") I $D(ORMPI),$D(ORLOC) S ORCMOR=$P(ORLOC,"^")
"RTN","ORCXPINQ",44,0)
 I '$D(IOF) S IOP="HOME" D ^%ZIS K IOP
"RTN","ORCXPINQ",45,0)
 W @IOF,!,$P(VADM(1),"^",1),?40,$P(VADM(2),"^",2)
"RTN","ORCXPINQ",46,0)
 W ?65,$P(VADM(3),"^",2) S X="",$P(X,"=",78)=""
"RTN","ORCXPINQ",47,0)
 W !,X,!?15,"COORDINATING MASTER OF RECORD: ",ORCMOR,!
"RTN","ORCXPINQ",48,0)
 Q
"RTN","ORCXPINQ",49,0)
ADR ; Addresses
"RTN","ORCXPINQ",50,0)
 D:'$D(ORTA)!('$D(ORPA)) ADD
"RTN","ORCXPINQ",51,0)
 N ORP,ORT,ORDT,ORI
"RTN","ORCXPINQ",52,0)
 S ORDT=$$DT^XLFDT S ORDT=$G(DT)
"RTN","ORCXPINQ",53,0)
 D FADR(.ORP,1) D:+($G(ORTA(10)))>0 FADR(.ORT,2)
"RTN","ORCXPINQ",54,0)
 S:+($G(ORTA(10)))'>0 ORT(1)="NO TEMPORARY ADDRESS"
"RTN","ORCXPINQ",55,0)
 F ORI=1:1 Q:'$D(ORT(ORI))&('$D(ORP(ORI)))  D
"RTN","ORCXPINQ",56,0)
 . W ! W:ORI=1 "Address: " W ?9,$G(ORP(ORI)) W:ORI=1 ?40,"Temporary: " W ?51,$G(ORT(ORI))
"RTN","ORCXPINQ",57,0)
 Q
"RTN","ORCXPINQ",58,0)
FADR(ORA,ORT) ; Format Addresses
"RTN","ORCXPINQ",59,0)
 N ORI,ORC,ORX,ORX1,ORX2,ORX3,ORON,ORRT
"RTN","ORCXPINQ",60,0)
 S ORRT=$S(+($G(ORT))=1:"ORPA(",+($G(ORT))=2:"ORTA(",1:"ORPA(")
"RTN","ORCXPINQ",61,0)
 S (ORON,ORI,ORC)=0 F ORI=1:1:3 D
"RTN","ORCXPINQ",62,0)
 . S ORX=$$TRIM($G(@(ORRT_ORI_")")))
"RTN","ORCXPINQ",63,0)
 . S:$L(ORX) ORC=ORC+1,ORA(ORC)=ORX
"RTN","ORCXPINQ",64,0)
 I $G(ORT)=1,'$D(ORA(1)) S ORON=ORON+1,ORC=ORC+1,ORA(ORC)="STREET ADDRESS UNKNOWN"
"RTN","ORCXPINQ",65,0)
 S ORX1=$$TRIM($G(@(ORRT_"4)")))
"RTN","ORCXPINQ",66,0)
 S ORX2=+($P($G(@(ORRT_"5)")),"^",1)),ORX2=$$GET1^DIQ(5,(+ORX2_","),1)
"RTN","ORCXPINQ",67,0)
 S ORX3=$P($$TRIM($P($G(@(ORRT_"11)")),"^",2)),"-",1) S:$L(ORX1) ORX=ORX1
"RTN","ORCXPINQ",68,0)
 S:$L(ORX)&($L(ORX2)) ORX=ORX_", "_ORX2 S:'$L(ORX)&($L(ORX2)) ORX=ORX2
"RTN","ORCXPINQ",69,0)
 S:$L(ORX)&($L(ORX3)) ORX=ORX_"  "_ORX3 S:'$L(ORX)&($L(ORX3)) ORX=ORX3 K ORX1,ORX2,ORX3
"RTN","ORCXPINQ",70,0)
 S ORX1=ORX I $L(ORX1)>26 D
"RTN","ORCXPINQ",71,0)
 . S ORX3=$$TRIM($P($E(ORX1,1,26)," ",1,($L($E(ORX1,1,26)," ")-1)))
"RTN","ORCXPINQ",72,0)
 . S ORX2=$$TRIM($P(ORX1,ORX3,2)),ORX1=ORX3 K ORX3
"RTN","ORCXPINQ",73,0)
 S:$L($G(ORX1)) ORC=ORC+1,ORA(ORC)=ORX1 S:$L($G(ORX2)) ORC=ORC+1,ORA(ORC)=ORX2
"RTN","ORCXPINQ",74,0)
 S:$G(ORT)=1&('$L($G(ORX1))) ORON=ORON+1,ORC=ORC+1,ORA(ORC)="UNK. CITY/STATE"
"RTN","ORCXPINQ",75,0)
 I $G(ORT)=1&(ORON=2) K ORA S ORA(1)="NONE ON FILE"
"RTN","ORCXPINQ",76,0)
 Q
"RTN","ORCXPINQ",77,0)
ADD ; Address/Temporary Address Info
"RTN","ORCXPINQ",78,0)
 N %X,%Y,VAPA,VAERR
"RTN","ORCXPINQ",79,0)
 K ORPA S VAPA("P")="" D ADD^VADPT K VAPA("P") S %X="VAPA(",%Y="ORPA(" D %XY^%RCR
"RTN","ORCXPINQ",80,0)
 K ORTA,VAPA D ADD^VADPT S %X="VAPA(",%Y="ORTA(" D %XY^%RCR
"RTN","ORCXPINQ",81,0)
 Q
"RTN","ORCXPINQ",82,0)
CTFMTO ; County - From/To
"RTN","ORCXPINQ",83,0)
 D:'$D(ORTA)!('$D(ORPA)) ADD
"RTN","ORCXPINQ",84,0)
 N X,Y,ORFM,ORTO,ORFT,ORST,ORCT,ORCC S ORFM=$$ED(+($G(ORTA(9)))),ORTO=$$ED(+($G(ORTA(10))))
"RTN","ORCXPINQ",85,0)
 S ORFT=ORFM_" - "_ORTO S:ORFT=" - " ORFT="NOT APPLICABLE"
"RTN","ORCXPINQ",86,0)
 S ORST=$G(ORPA(5)),ORCT=$P($G(ORPA(7)),"^",2),ORCC=+($G(ORPA(7)))
"RTN","ORCXPINQ",87,0)
 S:$L(ORCT)&(+ORCC>0)&(+ORST>0) ORCC=$$GET1^DIQ(5.01,(+ORCC_","_+ORST_","),2),ORCT=ORCT_" ("_+ORCC_")"
"RTN","ORCXPINQ",88,0)
 S:'$L(ORCT)!(+ORCC'>0)!(+ORST'>0) ORCT="UNKNOWN"
"RTN","ORCXPINQ",89,0)
 W !," County: ",ORCT,?42,"From/To:",?51,ORFT
"RTN","ORCXPINQ",90,0)
 Q
"RTN","ORCXPINQ",91,0)
PHN ; Phone
"RTN","ORCXPINQ",92,0)
 D:'$D(ORTA)!('$D(ORPA)) ADD N ORPH,ORTP S ORPH=$G(ORPA(8)) S:'$L(ORPH) ORPH=$G(ORU)
"RTN","ORCXPINQ",93,0)
 S ORTP=$G(ORTA(8)) S:'$L(ORTP) ORTP=$G(ORU) S:+($G(ORTA(10)))'>0 ORTP="NOT APPLICAGLE"
"RTN","ORCXPINQ",94,0)
 W !?2,"Phone: ",ORPH,?44,"Phone: ",ORTP
"RTN","ORCXPINQ",95,0)
 Q
"RTN","ORCXPINQ",96,0)
OFF ; Office
"RTN","ORCXPINQ",97,0)
 N ORO S ORO=$$GET1^DIQ(2,(+($G(DFN))_","),.132)
"RTN","ORCXPINQ",98,0)
 W !,?1,"Office: ",$S($L(ORO):ORO,1:$G(ORU))
"RTN","ORCXPINQ",99,0)
 Q
"RTN","ORCXPINQ",100,0)
RS ; Religion and Sex
"RTN","ORCXPINQ",101,0)
 N ORR S ORR=$P($G(VADM(9)),"^",2),ORS=$P($G(VADM(5)),"^",2)
"RTN","ORCXPINQ",102,0)
 W !,?2,"Relig: ",$S($L(ORR):ORR,1:$G(ORU))
"RTN","ORCXPINQ",103,0)
 W ?46,"Sex: ",$S($L(ORS):ORS,1:$G(ORU))
"RTN","ORCXPINQ",104,0)
 Q
"RTN","ORCXPINQ",105,0)
RE ; Race an Ethnicity
"RTN","ORCXPINQ",106,0)
 N OR1,OR2,ORO,ORR,ORE,ORI,ORC,ORT S ORT=0,ORO=$P($G(VADM(8)),"^",2) S (ORR,ORE)=""
"RTN","ORCXPINQ",107,0)
 S (ORI,ORC)=0 F  S ORI=$O(VADM(11,ORI)) Q:+ORI=0  S ORD=$P($G(VADM(11,ORI)),"^",2) S:$L(ORD) ORE=$G(ORE)_"; "_ORD,ORT=ORT+1
"RTN","ORCXPINQ",108,0)
 S (ORI,ORC)=0 F  S ORI=$O(VADM(12,ORI)) Q:+ORI=0  S ORD=$P($G(VADM(12,ORI)),"^",2) S:$L(ORD) ORR=$G(ORR)_"; "_ORD,ORT=ORT+1
"RTN","ORCXPINQ",109,0)
 F ORC="ORE","ORR" D
"RTN","ORCXPINQ",110,0)
 . Q:'$D(@ORC)  F  Q:$E(@ORC,1,2)'="; "  S @ORC=$E(@ORC,3,$L(@ORC))
"RTN","ORCXPINQ",111,0)
 . F  Q:$E(@ORC,($L(@ORC)-1),$L(@ORC))'="; "  S @ORC=$E(@ORC,1,($L(@ORC)-2))
"RTN","ORCXPINQ",112,0)
 . S:'$L(@ORC) @ORC=ORU
"RTN","ORCXPINQ",113,0)
 I 'ORT W !,?3,"Race: ",$S($L(ORO):ORO,1:ORU) Q
"RTN","ORCXPINQ",114,0)
 F ORI=1:1 Q:$L((ORR_ORE))=0  D
"RTN","ORCXPINQ",115,0)
 . W:ORI=1 !,?3,"Race: " W:ORI>1 ! I $L(ORR)'>26 W ?9,ORR S ORR=""
"RTN","ORCXPINQ",116,0)
 . I $L(ORR)>26 D
"RTN","ORCXPINQ",117,0)
 . . N OR1,OR2 S OR1=$$TRIM($P($E(ORR,1,26)," ",1,($L($E(ORR,1,26)," ")-1)))
"RTN","ORCXPINQ",118,0)
 . . S OR2=$$TRIM($P(ORR,OR1,2,299)) W ?9,OR1 S ORR=OR2
"RTN","ORCXPINQ",119,0)
 . W:ORI=1 ?40,"Ethnicity: " I $L(ORE)'>26 W ?51,ORE S ORE=""
"RTN","ORCXPINQ",120,0)
 . I $L(ORE)>26 D
"RTN","ORCXPINQ",121,0)
 . . N OR1,OR2 S OR1=$$TRIM($P($E(ORE,1,26)," ",1,($L($E(ORE,1,26)," ")-1)))
"RTN","ORCXPINQ",122,0)
 . . S OR2=$$TRIM($P(ORE,OR1,2,299)) W ?51,OR1 S ORE=OR2
"RTN","ORCXPINQ",123,0)
 Q
"RTN","ORCXPINQ",124,0)
POS ; Period of Service
"RTN","ORCXPINQ",125,0)
 N ORP,ORC S ORP=$P($G(VAEL(2)),"^",2),ORC=$G(VAEL(7))
"RTN","ORCXPINQ",126,0)
 W !,?4,"POS: ",$S($L(ORP):ORP,1:$G(ORU)) W ?42,"Claim #: ",$S($L(ORC):ORC,1:$G(ORU))
"RTN","ORCXPINQ",127,0)
 Q
"RTN","ORCXPINQ",128,0)
PMD ; Pharmacy Mail Delivery
"RTN","ORCXPINQ",129,0)
 Q:+($G(DFN))'>0  N PMDS S PMDS=$$GET1^DIQ(55,(+DFN_","),.03) Q:'$L(PMDS)
"RTN","ORCXPINQ",130,0)
 W ?33,"Rx Mail Delivery: ",PMDS
"RTN","ORCXPINQ",131,0)
 Q
"RTN","ORCXPINQ",132,0)
PE ; Primary Eligibility
"RTN","ORCXPINQ",133,0)
 S OR1=$P($G(VAEL(1)),"^",2),OR2=$P($G(VAEL(8)),"^",2) S:'$L(OR2) OR2="NOT VERIFIED" S:$L(OR1) OR1=OR1_$S($L(OR2):(" ("_OR2_")"),1:"") S:'$L(OR1) OR1=ORU
"RTN","ORCXPINQ",134,0)
 W !!,"Primary Eligibility: ",OR1
"RTN","ORCXPINQ",135,0)
 Q
"RTN","ORCXPINQ",136,0)
 ;               
"RTN","ORCXPINQ",137,0)
 ; Miscellaneous
"RTN","ORCXPINQ",138,0)
TRIM(X) ;   Trim Spaces
"RTN","ORCXPINQ",139,0)
 S X=$G(X) F  Q:$E(X,1)'=" "  S X=$E(X,2,$L(X))
"RTN","ORCXPINQ",140,0)
 F  Q:$E(X,$L(X))'=" "  S X=$E(X,1,($L(X)-1))
"RTN","ORCXPINQ",141,0)
 Q X
"RTN","ORCXPINQ",142,0)
ED(X) ;   External Date
"RTN","ORCXPINQ",143,0)
 N Y S Y=+($G(X)) I +Y>0 X ^DD("DD") S X=Y Q X
"RTN","ORCXPINQ",144,0)
 Q ""
"RTN","ORCXPINQ",145,0)
DOM(X) ;   Domicilary Service
"RTN","ORCXPINQ",146,0)
 N DFN,VAIN,VAERR S DFN=+($G(X)) D INP^VADPT S X=0
"RTN","ORCXPINQ",147,0)
 I +($G(VAIN(1)))>0,$P($G(^DG(43,1,0)),"^",21),+($G(VAIN(4)))>0,$P($G(^DIC(42,+($G(VAIN(4))),0)),"^",3)="D" S X=1
"RTN","ORCXPINQ",148,0)
 Q X
"RTN","ORCXPINQ",149,0)
PH(X) ;   Phone
"RTN","ORCXPINQ",150,0)
 S X=$$GET1^DIQ(200,(+($G(X))_","),.132) Q X
"RTN","ORCXPINQ",151,0)
PG(X) ;   Pager
"RTN","ORCXPINQ",152,0)
 N PGR S PGR=$$GET1^DIQ(200,(+($G(X))_","),.138)
"RTN","ORCXPINQ",153,0)
 S:'$L(X) PGR=$$GET1^DIQ(200,(+($G(X))_","),.137)
"RTN","ORCXPINQ",154,0)
 S X=PGR Q X
"RTN","ORCXPND1")
0^3^B50191947
"RTN","ORCXPND1",1,0)
ORCXPND1 ; SLC/MKB/KER - Expanded Display cont ; 01/09/2003
"RTN","ORCXPND1",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**26,67,75,89,92,94,148,159**;Dec 17, 1997
"RTN","ORCXPND1",3,0)
 ;
"RTN","ORCXPND1",4,0)
 ; External References
"RTN","ORCXPND1",5,0)
 ;   DBIA  2832  RPC^TIUSRV
"RTN","ORCXPND1",6,0)
 ;   DBIA  2400  OEL^PSOORRL
"RTN","ORCXPND1",7,0)
 ;   DBIA  2503  RR^LR7OR1
"RTN","ORCXPND1",8,0)
 ;   DBIA  2951  EN1^LR7OSBR
"RTN","ORCXPND1",9,0)
 ;   DBIA  2952  EN^LR7OSMZ0
"RTN","ORCXPND1",10,0)
 ;   DBIA 10103  $$FMTE^XLFDT
"RTN","ORCXPND1",11,0)
 ;   DBIA  2387  ^LAB(60
"RTN","ORCXPND1",12,0)
 ;   DBIA  2925  DT^GMRCSLM2
"RTN","ORCXPND1",13,0)
 ;   DBIA  2926  RT^GMRCGUIA
"RTN","ORCXPND1",14,0)
 ;   DBIA  2877  EN3^RAO7PC3
"RTN","ORCXPND1",15,0)
 ;   DBIA  2877  EN30^RAO7PC3
"RTN","ORCXPND1",16,0)
 ;   DBIA 10061  KVAR^VADPT
"RTN","ORCXPND1",17,0)
 ;   DBIA 10061  OAD^VADPT
"RTN","ORCXPND1",18,0)
 ;   DBIA  3420  ^DPT(  file #2
"RTN","ORCXPND1",19,0)
 ;   DBIA 10035  ^DPT(  file #2
"RTN","ORCXPND1",20,0)
 ;   DBIA  2056  $$GET1^DIQ  (file #2)
"RTN","ORCXPND1",21,0)
 ;   DBIA 10104  $$UP^XLFSTR
"RTN","ORCXPND1",22,0)
 ;                  
"RTN","ORCXPND1",23,0)
COVER ; -- cover sheet
"RTN","ORCXPND1",24,0)
 N PKG S PKG=$P($G(^TMP("OR",$J,ORTAB,"IDX",NUM)),U,4)
"RTN","ORCXPND1",25,0)
 D ALLERGY^ORCXPND2:PKG="GMRA",NOTES:PKG="TIU"
"RTN","ORCXPND1",26,0)
 Q
"RTN","ORCXPND1",27,0)
 ;
"RTN","ORCXPND1",28,0)
NOTES ; -- progress notes
"RTN","ORCXPND1",29,0)
 N I,ORY,DATE,AUTHOR,PTLOC,SUBJ D RPC^TIUSRV(.ORY,ID)
"RTN","ORCXPND1",30,0)
 S I=0 F  S I=$O(@ORY@(I)) Q:I'>0  S LCNT=LCNT+1,^TMP("ORXPND",$J,LCNT,0)=$G(@ORY@(I,0))
"RTN","ORCXPND1",31,0)
 K @ORY
"RTN","ORCXPND1",32,0)
 Q
"RTN","ORCXPND1",33,0)
 ;
"RTN","ORCXPND1",34,0)
PROBLEMS ; -- problem list
"RTN","ORCXPND1",35,0)
 D PL^ORCXPND4
"RTN","ORCXPND1",36,0)
 Q
"RTN","ORCXPND1",37,0)
 ;
"RTN","ORCXPND1",38,0)
MEDS ; -- pharmacy
"RTN","ORCXPND1",39,0)
 ;N NODE,ORIFN
"RTN","ORCXPND1",40,0)
 D OEL^PSOORRL(+ORVP,ID) ;S NODE=$G(^TMP("PS",$J,0)),ORIFN=+$P(NODE,U,11)
"RTN","ORCXPND1",41,0)
 S ID=+$P($G(^TMP("PS",$J,0)),U,11) D ORDERS
"RTN","ORCXPND1",42,0)
 ;D @($S($P($G(^OR(100,ORIFN,0)),U,11)=$O(^ORD(100.98,"B","IV RX",0)):"IV",1:"DRUG")_"^ORCXPND2")
"RTN","ORCXPND1",43,0)
 K ^TMP("PS",$J)
"RTN","ORCXPND1",44,0)
 Q
"RTN","ORCXPND1",45,0)
 ;
"RTN","ORCXPND1",46,0)
LABS ; -- laboratory [RESULTS ONLY for ID=OE order #]
"RTN","ORCXPND1",47,0)
 N ORIFN,X,Y,SUB,TEST,NAME,SS,IDE,IVDT,TST,CCNT,ORCY,IG,TCNT
"RTN","ORCXPND1",48,0)
 K ^TMP("LRRR",$J)
"RTN","ORCXPND1",49,0)
 S ORIFN=+ID,IDE=$G(^OR(100,+ID,4)) Q:'$L(IDE)  ; OE# -> Lab#
"RTN","ORCXPND1",50,0)
 I +IDE  D RR^LR7OR1(+ORVP,IDE) I '$D(^TMP("LRRR",$J,+ORVP)) S $P(IDE,";",1,3)=";;" ;Order possibly purged, reset to lookup on file 63
"RTN","ORCXPND1",51,0)
 I '+IDE,$P(IDE,";",5)  D RR^LR7OR1(+ORVP,,9999999-$P(IDE,";",5),9999999-$P(IDE,";",5),$P(IDE,";",4))
"RTN","ORCXPND1",52,0)
 K ORCY D TEXT^ORQ12(.ORCY,ORIFN,80)
"RTN","ORCXPND1",53,0)
 S IG=0 F  S IG=$O(ORCY(IG)) Q:IG<1  S X=ORCY(IG) D ITEM^ORCXPND(X)
"RTN","ORCXPND1",54,0)
 D BLANK^ORCXPND I '$D(^TMP("LRRR",$J,+ORVP)) S LCNT=LCNT+1,^TMP("ORXPND",$J,LCNT,0)="No data available." Q
"RTN","ORCXPND1",55,0)
 M TEST=^TMP("LRRR",$J,+ORVP) S CCNT=0,SS=""
"RTN","ORCXPND1",56,0)
 F  S SS=$O(TEST(SS)) Q:SS=""  S IVDT=0 F  S IVDT=$O(TEST(SS,IVDT)) Q:'IVDT  D
"RTN","ORCXPND1",57,0)
 . I SS="BB" K ^TMP("LRC",$J) D EN1^LR7OSBR(+ORVP) Q:'$D(^TMP("LRC",$J))  D  Q
"RTN","ORCXPND1",58,0)
 .. N I S I=0 F  S I=$O(^TMP("LRC",$J,I)) Q:I<1  S X=^(I,0),LCNT=LCNT+1,^TMP("ORXPND",$J,LCNT,0)=X
"RTN","ORCXPND1",59,0)
 .. K ^TMP("LRC",$J)
"RTN","ORCXPND1",60,0)
 . I SS="MI" K ^TMP("LRC",$J) D EN^LR7OSMZ0(+ORVP) Q:'$D(^TMP("LRC",$J))  D  Q
"RTN","ORCXPND1",61,0)
 .. N I S I=0 F  S I=$O(^TMP("LRC",$J,I)) Q:I<1  S X=^(I,0),LCNT=LCNT+1,^TMP("ORXPND",$J,LCNT,0)=X
"RTN","ORCXPND1",62,0)
 .. K ^TMP("LRC",$J)
"RTN","ORCXPND1",63,0)
 . I SS="CH" D  Q
"RTN","ORCXPND1",64,0)
 .. S (TCNT,TST)=0 F  S TST=$O(TEST(SS,IVDT,TST)) Q:TST=""  S CCNT=0,Y="",TCNT=TCNT+1 D
"RTN","ORCXPND1",65,0)
 ... I TCNT=1 D
"RTN","ORCXPND1",66,0)
 .... S LCNT=LCNT+1,^TMP("ORXPND",$J,LCNT,0)="   Collection time:          "_$$FMTE^XLFDT(9999999-IVDT,1)
"RTN","ORCXPND1",67,0)
 .... S CCNT=0,LCNT=LCNT+1,^TMP("ORXPND",$J,LCNT,0)=$$S(1,CCNT," ")_$$S(3,CCNT,"Test Name")_$$S(29,CCNT,"Result")_$$S(39,CCNT,"Units")_$$S(55,CCNT,"Range") D:$D(IOUON) SETVIDEO^ORCXPND(LCNT,1,70,IOUON,IOUOFF)
"RTN","ORCXPND1",68,0)
 .... S CCNT=0,LCNT=LCNT+1,^TMP("ORXPND",$J,LCNT,0)=$$S(1,CCNT,"-------------------")_$$S(29,CCNT,"------")_$$S(39,CCNT,"-----")_$$S(55,CCNT,"-----")
"RTN","ORCXPND1",69,0)
 ... I TST S X=TEST(SS,IVDT,TST),CCNT=0 I +X D
"RTN","ORCXPND1",70,0)
 .... S LCNT=LCNT+1,^TMP("ORXPND",$J,LCNT,0)=$$S(1,CCNT,$P(^LAB(60,+X,0),U))_$$S(26,CCNT,$J($P(X,U,2),7))
"RTN","ORCXPND1",71,0)
 .... I $L($P(X,U,2))<8 S ^TMP("ORXPND",$J,LCNT,0)=^TMP("ORXPND",$J,LCNT,0)_$$S(34,CCNT,$S($L($P(X,U,3)):$P(X,U,3),1:""))_$$S(39,CCNT,$P(X,U,4))_$$S(45,CCNT,$J($P(X,U,5),15))
"RTN","ORCXPND1",72,0)
 .... E  S CCNT=0,LCNT=LCNT+1,$P(Y," ",35)="",^TMP("ORXPND",$J,LCNT,0)=$$S(1,CCNT,Y)_$$S(34,CCNT,$S($L($P(X,U,3)):$P(X,U,3),1:""))_$$S(39,CCNT,$P(X,U,4))_$$S(55,CCNT,$J($P(X,U,5),15))
"RTN","ORCXPND1",73,0)
 .... I $L($P(X,U,3)),$D(IOINHI) D SETVIDEO^ORCXPND(LCNT,26,8,IOINHI,IOINORM)
"RTN","ORCXPND1",74,0)
 .... I $P(X,U,3)["*",$D(IOBON),$D(IOINHI) D SETVIDEO^ORCXPND(LCNT,26,8,IOBON_IOINHI,IOBOFF_IOINORM)
"RTN","ORCXPND1",75,0)
 ... I TST="N" S LCNT=LCNT+1,^TMP("ORXPND",$J,LCNT,0)=" Comments: " D
"RTN","ORCXPND1",76,0)
 .... N CMT S CMT=0 F  S CMT=$O(TEST(SS,IVDT,"N",CMT)) Q:'CMT  S LCNT=LCNT+1,^TMP("ORXPND",$J,LCNT,0)=" "_TEST(SS,IVDT,"N",CMT)
"RTN","ORCXPND1",77,0)
 K ^TMP("LRRR",$J)
"RTN","ORCXPND1",78,0)
 Q
"RTN","ORCXPND1",79,0)
 ;
"RTN","ORCXPND1",80,0)
DELAY ; -- Delayed orders
"RTN","ORCXPND1",81,0)
NEW ; -- New orders
"RTN","ORCXPND1",82,0)
ORDERS ; -- orders
"RTN","ORCXPND1",83,0)
 I '$G(ORESULTS) D ORDERS^ORCXPND2 Q
"RTN","ORCXPND1",84,0)
 ; -- Results Display (Add more packages as available)
"RTN","ORCXPND1",85,0)
 N PKG,TAB,ORIFN
"RTN","ORCXPND1",86,0)
 S PKG=+$P($G(^OR(100,+ID,0)),"^",14),PKG=$$NMSP^ORCD(PKG)
"RTN","ORCXPND1",87,0)
 S TAB=$S(PKG="LR":"LABS",PKG="GMRC":"CONSULTS",PKG="RA":"XRAYS",1:"")
"RTN","ORCXPND1",88,0)
 I '$L(TAB)!(ID'>0) D  Q  ; no display available
"RTN","ORCXPND1",89,0)
 . N ORY,I D TEXT^ORQ12(.ORY,+ID,80)
"RTN","ORCXPND1",90,0)
 . S I=0 F  S I=$O(ORY(I)) Q:I'>0  D ITEM^ORCXPND(ORY(I))
"RTN","ORCXPND1",91,0)
 . D BLANK^ORCXPND
"RTN","ORCXPND1",92,0)
 . S LCNT=LCNT+1,^TMP("ORXPND",$J,LCNT,0)="There are no results to report."
"RTN","ORCXPND1",93,0)
 I $O(^OR(100,+ID,2,0)) S ORIFN=+ID,ID=0 F  S ID=$O(^OR(100,ORIFN,2,ID)) Q:ID<1  I $D(^OR(100,ID,0)) D @TAB
"RTN","ORCXPND1",94,0)
 I '$O(^OR(100,+ID,2,0)) D @TAB
"RTN","ORCXPND1",95,0)
 Q
"RTN","ORCXPND1",96,0)
 ;
"RTN","ORCXPND1",97,0)
REPORTS ; -- patient profiles
"RTN","ORCXPND1",98,0)
 D EN^ORCXPNDR ; Reports
"RTN","ORCXPND1",99,0)
 Q
"RTN","ORCXPND1",100,0)
 ;
"RTN","ORCXPND1",101,0)
CONSULTS ; -- consults
"RTN","ORCXPND1",102,0)
 N I,X,SUB,ORTX ;,VALMAR
"RTN","ORCXPND1",103,0)
 I $G(ORTAB)="CONSULTS" S X=$P($G(^TMP("OR",$J,ORTAB,"IDX",NUM)),U,4)
"RTN","ORCXPND1",104,0)
 E  D TEXT^ORQ12(.ORTX,+ID) S X=ORTX(1),ID=+$G(^OR(100,+ID,4)) ; OE->GMRC order#
"RTN","ORCXPND1",105,0)
 D ITEM^ORCXPND(X),BLANK^ORCXPND
"RTN","ORCXPND1",106,0)
 I ID'>0 S LCNT=LCNT+1,^TMP("ORXPND",$J,LCNT,0)="No data available." Q
"RTN","ORCXPND1",107,0)
 I '$G(ORESULTS) D  ;DT action
"RTN","ORCXPND1",108,0)
 . S LCNT=LCNT+1,^TMP("ORXPND",$J,LCNT,0)="Consult No.:           "_ID
"RTN","ORCXPND1",109,0)
 . N GMRCOER S GMRCOER=2 D DT^GMRCSLM2(ID) S SUB="DT"
"RTN","ORCXPND1",110,0)
 I $G(ORESULTS) D RT^GMRCGUIA(ID,"^TMP(""GMRCR"",$J,""RT"")") S SUB="RT"
"RTN","ORCXPND1",111,0)
 ;
"RTN","ORCXPND1",112,0)
 ; Call to RT^GMRCGUIA() returns the following 
"RTN","ORCXPND1",113,0)
 ; GMRC namespaced Temporary Global Array:
"RTN","ORCXPND1",114,0)
 ;                 
"RTN","ORCXPND1",115,0)
 ;    ^TMP("GMRCR",$J,"RT",#) = Formated Medicine Results
"RTN","ORCXPND1",116,0)
 ;
"RTN","ORCXPND1",117,0)
 S I=0 F  S I=$O(^TMP("GMRCR",$J,SUB,I)) Q:I'>0  S X=$G(^(I,0)),LCNT=LCNT+1,^TMP("ORXPND",$J,LCNT,0)=X
"RTN","ORCXPND1",118,0)
 K ^TMP("GMRCR",$J)
"RTN","ORCXPND1",119,0)
 Q
"RTN","ORCXPND1",120,0)
 ;
"RTN","ORCXPND1",121,0)
XRAYS ; -- Radiology
"RTN","ORCXPND1",122,0)
 I '$G(ORESULTS) S ID=+ORVP_U_$TR(ID,"-","^") D EN3^RAO7PC3(ID)
"RTN","ORCXPND1",123,0)
 I $G(ORESULTS) S ID=+$G(^OR(100,+ID,4)) D EN30^RAO7PC3(ID)
"RTN","ORCXPND1",124,0)
 N CASE,PROC,PSET S PSET=$D(^TMP($J,"RAE3",+ORVP,"PRINT_SET"))
"RTN","ORCXPND1",125,0)
 S CASE=0 F  S CASE=$O(^TMP($J,"RAE3",+ORVP,CASE)) Q:CASE'>0  D
"RTN","ORCXPND1",126,0)
 . I PSET S PROC=$O(^TMP($J,"RAE3",+ORVP,CASE,"")) D ITEM^ORCXPND(PROC) Q
"RTN","ORCXPND1",127,0)
 . S PROC="" F  S PROC=$O(^TMP($J,"RAE3",+ORVP,CASE,PROC)) Q:PROC=""  D ITEM^ORCXPND(PROC),BLANK^ORCXPND,XRPT,BLANK^ORCXPND
"RTN","ORCXPND1",128,0)
 I PSET S CASE=$O(^TMP($J,"RAE3",+ORVP,0)),PROC=$O(^(CASE,"")) D BLANK^ORCXPND,XRPT,BLANK^ORCXPND ;printset=list all procs, then one report
"RTN","ORCXPND1",129,0)
 K ^TMP($J,"RAE3",+ORVP) S VALM("RM")=81
"RTN","ORCXPND1",130,0)
 Q
"RTN","ORCXPND1",131,0)
 ;
"RTN","ORCXPND1",132,0)
XRPT ; -- body of report for CASE, PROC
"RTN","ORCXPND1",133,0)
 N ORD,X,I
"RTN","ORCXPND1",134,0)
 S ORD=$S($L($G(^TMP($J,"RAE3",+ORVP,"ORD"))):^("ORD"),$L($G(^("ORD",CASE))):^(CASE),1:"") I $L(ORD),ORD'=PROC S LCNT=LCNT+1,^TMP("ORXPND",$J,LCNT,0)="Proc Ord: "_ORD
"RTN","ORCXPND1",135,0)
 S I=1 F  S I=$O(^TMP($J,"RAE3",+ORVP,CASE,PROC,I)) Q:I'>0  S X=^(I),LCNT=LCNT+1,^TMP("ORXPND",$J,LCNT,0)=X ;Skip pt ID on line 1
"RTN","ORCXPND1",136,0)
 Q
"RTN","ORCXPND1",137,0)
 ;
"RTN","ORCXPND1",138,0)
SUMMRIES ; -- discharge summaries
"RTN","ORCXPND1",139,0)
 N I,ORY,DATE,AUTHOR,PTLOC,SUBJ D RPC^TIUSRV(.ORY,ID)
"RTN","ORCXPND1",140,0)
 S I=0 F  S I=$O(@ORY@(I)) Q:I'>0  S LCNT=LCNT+1,^TMP("ORXPND",$J,LCNT,0)=$G(@ORY@(I,0))
"RTN","ORCXPND1",141,0)
 K @ORY
"RTN","ORCXPND1",142,0)
 Q
"RTN","ORCXPND1",143,0)
 ;
"RTN","ORCXPND1",144,0)
PTINQ ; print patient inquiry in list manager
"RTN","ORCXPND1",145,0)
 N DFN,ORI,X
"RTN","ORCXPND1",146,0)
 S DFN=+ORVP
"RTN","ORCXPND1",147,0)
 D DGINQ(DFN)
"RTN","ORCXPND1",148,0)
 S ORI=4,LCNT=0
"RTN","ORCXPND1",149,0)
 F  S ORI=$O(^TMP("ORDATA",$J,1,ORI)) Q:'ORI  S X=^(ORI) D
"RTN","ORCXPND1",150,0)
 . S LCNT=LCNT+1
"RTN","ORCXPND1",151,0)
 . S ^TMP("ORXPND",$J,LCNT,0)=X
"RTN","ORCXPND1",152,0)
 K ^TMP("ORDATA",$J,1)
"RTN","ORCXPND1",153,0)
 Q
"RTN","ORCXPND1",154,0)
 ;
"RTN","ORCXPND1",155,0)
DGINQ(DFN) ;Patient Inquiry
"RTN","ORCXPND1",156,0)
 D START^ORWRP(80,"DGINQB^ORCXPND1(DFN)")
"RTN","ORCXPND1",157,0)
 Q
"RTN","ORCXPND1",158,0)
 ;
"RTN","ORCXPND1",159,0)
DGINQB(DFN) ; Build Patient Inquiry
"RTN","ORCXPND1",160,0)
 N ORDOC,ORTEAM,ORVP,XQORNOD,ORSSTRT,ORSSTOP,X,VAOA
"RTN","ORCXPND1",161,0)
 S ORVP=DFN_";DPT(",XQORNOD=1
"RTN","ORCXPND1",162,0)
 D EN^ORCXPINQ,KVAR^VADPT
"RTN","ORCXPND1",163,0)
 Q
"RTN","ORCXPND1",164,0)
S(X,Y,Z) ;Pad over
"RTN","ORCXPND1",165,0)
 ; X=Column #
"RTN","ORCXPND1",166,0)
 ; Y=Current length
"RTN","ORCXPND1",167,0)
 ; Z=Text
"RTN","ORCXPND1",168,0)
 ; SP=TEXT SENT
"RTN","ORCXPND1",169,0)
 ; CCNT=Line position after input text
"RTN","ORCXPND1",170,0)
 I '$D(Z) Q ""
"RTN","ORCXPND1",171,0)
 N SP S SP=Z I X,Y,X>Y S SP=$E("                                                                             ",1,X-Y)_Z
"RTN","ORCXPND1",172,0)
 S CCNT=$$INC(CCNT,SP)
"RTN","ORCXPND1",173,0)
 Q SP
"RTN","ORCXPND1",174,0)
INC(X,Y) ;Character position count
"RTN","ORCXPND1",175,0)
 ;X=Current count
"RTN","ORCXPND1",176,0)
 ;Y=Text
"RTN","ORCXPND1",177,0)
 N INC S INC=X+$L(Y)
"RTN","ORCXPND1",178,0)
 Q INC
"RTN","ORDV07")
0^4^B58266167
"RTN","ORDV07",1,0)
ORDV07 ;SLC/DAN/KER - OE/RR Report extracts ; 01/09/2003
"RTN","ORDV07",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**109,120,159**;Dec 17,1997
"RTN","ORDV07",3,0)
 ; 
"RTN","ORDV07",4,0)
 ; External References
"RTN","ORDV07",5,0)
 ;   DBIA  10112  $$SITE^VASITE
"RTN","ORDV07",6,0)
 ;   DBIA  10061  4^VADPT
"RTN","ORDV07",7,0)
 ;   DBIA  10061  OAD^VADPT
"RTN","ORDV07",8,0)
 ;   DBIA  10145  ALL^IBCNS1
"RTN","ORDV07",9,0)
 ;   DBIA    767  ^DGSL(38.1,
"RTN","ORDV07",10,0)
 ;   DBIA   1407  ^FHWHEA
"RTN","ORDV07",11,0)
 ;   DBIA   3818  ICDS^GMTSDGP
"RTN","ORDV07",12,0)
 ;   DBIA   3818  ICDP^GMTSDGP
"RTN","ORDV07",13,0)
 ;   DBIA    418  ^DGPT("B"
"RTN","ORDV07",14,0)
 ;   DBIA    794  ^DIC(36,
"RTN","ORDV07",15,0)
 ;   DBIA    951  ^IBE(355.1,
"RTN","ORDV07",16,0)
 ;                    
"RTN","ORDV07",17,0)
 ;Dietetics components
"RTN","ORDV07",18,0)
DIETA(ROOT,ORALPHA,OROMEGA,ORMAX,ORDBEG,ORDEND,OREXT) ;All diet
"RTN","ORDV07",19,0)
 N ORTYPE S ORTYPE="DI" D DIET Q
"RTN","ORDV07",20,0)
DIETN(ROOT,ORALPHA,OROMEGA,ORMAX,ORDBEG,ORDEND,OREXT) ;Nutritional Status
"RTN","ORDV07",21,0)
 N ORTYPE S ORTYPE="NS" D DIET Q
"RTN","ORDV07",22,0)
DIETS(ROOT,ORALPHA,OROMEGA,ORMAX,ORDBEG,ORDEND,OREXT) ;Supplemental Feedings
"RTN","ORDV07",23,0)
 N ORTYPE S ORTYPE="SF" D DIET Q
"RTN","ORDV07",24,0)
DIETT(ROOT,ORALPHA,OROMEGA,ORMAX,ORDBEG,ORDEND,OREXT) ;Tube feedings
"RTN","ORDV07",25,0)
 N ORTYPE S ORTYPE="TF" D DIET Q
"RTN","ORDV07",26,0)
 ;
"RTN","ORDV07",27,0)
DIET ;Main diet entry point
"RTN","ORDV07",28,0)
 ;External calls to FHWHEA and SITE^VASITE
"RTN","ORDV07",29,0)
 ;Data returned in ^TMP("ORDATA",$J) by type:
"RTN","ORDV07",30,0)
 ;  ALL=Facility^Start Date^End Date^Diet^Comment^Service(tray,dining room, etc)
"RTN","ORDV07",31,0)
 ;  Nutritional Status=Facility^Status Date^Status
"RTN","ORDV07",32,0)
 ;  Supplemental Feeding=Facility^Date Ordered^Date Canceled^10am feeding^2pm feeding^8pm feeding
"RTN","ORDV07",33,0)
 ;  Tubefeeding=Facility^Date Ordered^Date Canceled^Product^Strength^Quantity^Daily CCs^Daily KCal^Comment
"RTN","ORDV07",34,0)
 ;
"RTN","ORDV07",35,0)
 N GMTS1,GMTS2,GMTSNDM,ORSITE,SITE,ORDT
"RTN","ORDV07",36,0)
 S GMTS1=OROMEGA-.24,GMTS2=ORALPHA,GMTSNDM=ORMAX
"RTN","ORDV07",37,0)
 K ^TMP("ORDATA",$J)
"RTN","ORDV07",38,0)
 D ^FHWHEA ;get all diet information.  Returned in ^UTILITY($J)
"RTN","ORDV07",39,0)
 Q:'$D(^UTILITY($J,ORTYPE))  ;no data to report for type selected
"RTN","ORDV07",40,0)
 S ORSITE=$$SITE^VASITE,ORSITE=$P(ORSITE,"^",2)_";"_$P(ORSITE,"^",3)
"RTN","ORDV07",41,0)
 S ORDT=0
"RTN","ORDV07",42,0)
 F  S ORDT=$O(^UTILITY($J,ORTYPE,ORDT)) Q:ORDT=""  D
"RTN","ORDV07",43,0)
 . S SITE=$S($L($G(^UTILITY($J,ORTYPE,ORDT,"facility"))):^("facility"),1:ORSITE)
"RTN","ORDV07",44,0)
 . S ^TMP("ORDATA",$J,ORDT,"WP",1)="1^"_SITE ;Station ID
"RTN","ORDV07",45,0)
 . S ^TMP("ORDATA",$J,ORDT,"WP",2)="2^"_$$DATE^ORDVU($P(^UTILITY($J,ORTYPE,ORDT,0),"^")) ;date
"RTN","ORDV07",46,0)
 . S ^TMP("ORDATA",$J,ORDT,"WP",3)="3^"_$S(ORTYPE="NS":$P(^UTILITY($J,ORTYPE,ORDT,0),"^",2),1:$$DATE^ORDVU($P(^UTILITY($J,ORTYPE,ORDT,0),"^",2)))
"RTN","ORDV07",47,0)
 . Q:ORTYPE="NS"  ;no more data required for NS
"RTN","ORDV07",48,0)
 . S ^TMP("ORDATA",$J,ORDT,"WP",4)="4^"_$P(^UTILITY($J,ORTYPE,ORDT,0),"^",3)
"RTN","ORDV07",49,0)
 . S ^TMP("ORDATA",$J,ORDT,"WP",5)="5^"_$P(^UTILITY($J,ORTYPE,ORDT,0),"^",4)
"RTN","ORDV07",50,0)
 . S ^TMP("ORDATA",$J,ORDT,"WP",6)="6^"_$P(^UTILITY($J,ORTYPE,ORDT,0),"^",5)
"RTN","ORDV07",51,0)
 . Q:ORTYPE'="TF"
"RTN","ORDV07",52,0)
 . ;Get remaining data for tube feedings
"RTN","ORDV07",53,0)
 . S ^TMP("ORDATA",$J,ORDT,"WP",7)="7^"_$P(^UTILITY($J,ORTYPE,ORDT,0),"^",6)
"RTN","ORDV07",54,0)
 . S ^TMP("ORDATA",$J,ORDT,"WP",8)="8^"_$P(^UTILITY($J,ORTYPE,ORDT,0),"^",7)
"RTN","ORDV07",55,0)
 . S ^TMP("ORDATA",$J,ORDT,"WP",9)="9^"_$P(^UTILITY($J,ORTYPE,ORDT,0),"^",8)
"RTN","ORDV07",56,0)
 K ^UTILITY($J)
"RTN","ORDV07",57,0)
 S ROOT=$NA(^TMP("ORDATA",$J))
"RTN","ORDV07",58,0)
 Q
"RTN","ORDV07",59,0)
 ;
"RTN","ORDV07",60,0)
DEM(ROOT,ORALPHA,OROMEGA,ORMAX,ORDBEG,ORDEND,OREXT) ; ADT Demographics
"RTN","ORDV07",61,0)
 ; External calls to VASITE, VADPT, and ^DGSL(38.1
"RTN","ORDV07",62,0)
 N VADM,VAPA,VAOA,ORSITE,SITE,I,ORDAT,ORETHN,ORRACE S (ORETHN,ORRACE)=""
"RTN","ORDV07",63,0)
 K ^TMP("ORDATA",$J)
"RTN","ORDV07",64,0)
 D 4^VADPT,OAD^VADPT
"RTN","ORDV07",65,0)
 ; Quit if error in data gathering, otherwise get 
"RTN","ORDV07",66,0)
 ; demographic/address information as well as next
"RTN","ORDV07",67,0)
 ; of kin addres
"RTN","ORDV07",68,0)
 Q:VAERR
"RTN","ORDV07",69,0)
 S ORSITE=$$SITE^VASITE,ORSITE=$P(ORSITE,"^",2)_";"_$P(ORSITE,"^",3)
"RTN","ORDV07",70,0)
 S SITE=ORSITE
"RTN","ORDV07",71,0)
 ;  1  Site
"RTN","ORDV07",72,0)
 S ^TMP("ORDATA",$J,1,"WP",1)="1^"_SITE
"RTN","ORDV07",73,0)
 ;  2  Patient Name
"RTN","ORDV07",74,0)
 S ^TMP("ORDATA",$J,1,"WP",2)="2^"_VADM(1)
"RTN","ORDV07",75,0)
 ;  3  SSN
"RTN","ORDV07",76,0)
 S ^TMP("ORDATA",$J,1,"WP",3)="3^"_$P(VADM(2),"^")
"RTN","ORDV07",77,0)
 ;  4  Sex
"RTN","ORDV07",78,0)
 S ^TMP("ORDATA",$J,1,"WP",4)="4^"_$P(VADM(5),"^",2)
"RTN","ORDV07",79,0)
 ;  5  Date of Birth
"RTN","ORDV07",80,0)
 S ^TMP("ORDATA",$J,1,"WP",5)="5^"_$$DATE^ORDVU($P(VADM(3),"^"))
"RTN","ORDV07",81,0)
 ;  6  Religion
"RTN","ORDV07",82,0)
 S ^TMP("ORDATA",$J,1,"WP",6)="6^"_$P(VADM(9),"^",2)
"RTN","ORDV07",83,0)
 ;  7  Marital Status
"RTN","ORDV07",84,0)
 S ^TMP("ORDATA",$J,1,"WP",7)="7^"_$P(VADM(10),"^",2)
"RTN","ORDV07",85,0)
 ;  8  Phone Number
"RTN","ORDV07",86,0)
 S ^TMP("ORDATA",$J,1,"WP",8)="8^"_VAPA(8)
"RTN","ORDV07",87,0)
 ;  9  Street Address (1-3), City, State, and ZIP
"RTN","ORDV07",88,0)
 S ^TMP("ORDATA",$J,1,"WP",9,1)="9^"_VAPA(1) I $P(^(1),"^",2)="" K ^(1)
"RTN","ORDV07",89,0)
 S ^TMP("ORDATA",$J,1,"WP",9,2)="9^"_VAPA(2) I $P(^(2),"^",2)="" K ^(2)
"RTN","ORDV07",90,0)
 S ^TMP("ORDATA",$J,1,"WP",9,3)="9^"_VAPA(3) I $P(^(3),"^",2)="" K ^(3)
"RTN","ORDV07",91,0)
 S ^TMP("ORDATA",$J,1,"WP",9,4)="9^"_VAPA(4)_$S($G(VAPA(4))'="":", ",1:"")_$P(VAPA(5),"^",2)_" "_VAPA(6)
"RTN","ORDV07",92,0)
 ; 11  Ethnicity
"RTN","ORDV07",93,0)
 S I=0 F  S I=$O(VADM(11,I)) Q:+I=0  D
"RTN","ORDV07",94,0)
 . S ORDAT=$P(VADM(11,I),"^",2) Q:'$L(ORDAT)
"RTN","ORDV07",95,0)
 . S ORETHN=$G(ORETHN)_", "_ORDAT
"RTN","ORDV07",96,0)
 . S ^TMP("ORDATA",$J,1,"WP",11,I)="11^"_ORDAT
"RTN","ORDV07",97,0)
 ; 10  Race
"RTN","ORDV07",98,0)
 S:$L(ORETHN) ^TMP("ORDATA",$J,1,"WP",10,1)="10^"
"RTN","ORDV07",99,0)
 S I=0 F  S I=$O(VADM(12,I)) Q:+I=0  D
"RTN","ORDV07",100,0)
 . S ORDAT=$P($G(VADM(12,I)),"^",2) Q:'$L(ORDAT)
"RTN","ORDV07",101,0)
 . S ORRACE=$G(ORRACE)_", "_ORDAT
"RTN","ORDV07",102,0)
 . S ^TMP("ORDATA",$J,1,"WP",10,I)="10^"_ORDAT
"RTN","ORDV07",103,0)
 S ORRACE=$P(ORRACE,", ",2,$L(ORRACE,", "))
"RTN","ORDV07",104,0)
 I '$L($P($G(^TMP("ORDATA",$J,1,"WP",11,1)),"^",2)) D
"RTN","ORDV07",105,0)
 . I '$L($P($G(^TMP("ORDATA",$J,1,"WP",10,1)),"^",2)) D
"RTN","ORDV07",106,0)
 . . S ^TMP("ORDATA",$J,1,"WP",11,1)="11^"
"RTN","ORDV07",107,0)
 . . S ^TMP("ORDATA",$J,1,"WP",10,1)="10^"_$P($G(VADM(8)),"^",2)
"RTN","ORDV07",108,0)
 S ORETHN=$P(ORETHN,", ",2,$L(ORETHN,", "))
"RTN","ORDV07",109,0)
 ; 12  Next of Kin
"RTN","ORDV07",110,0)
 S ^TMP("ORDATA",$J,1,"WP",12)="12^"_VAOA(9)
"RTN","ORDV07",111,0)
 ; 13  Next of Kin Relationship
"RTN","ORDV07",112,0)
 S ^TMP("ORDATA",$J,1,"WP",13)="13^"_VAOA(10)
"RTN","ORDV07",113,0)
 ; 14  NOK Street Address (1-3), City, State, and ZIP
"RTN","ORDV07",114,0)
 S ^TMP("ORDATA",$J,1,"WP",14,1)="14^"_VAOA(1) I $P(^(1),"^",2)="" K ^(1)
"RTN","ORDV07",115,0)
 S ^TMP("ORDATA",$J,1,"WP",14,2)="14^"_VAOA(2) I $P(^(2),"^",2)="" K ^(2)
"RTN","ORDV07",116,0)
 S ^TMP("ORDATA",$J,1,"WP",14,3)="14^"_VAOA(3) I $P(^(3),"^",2)=""
"RTN","ORDV07",117,0)
 S ^TMP("ORDATA",$J,1,"WP",14,4)="14^"_VAOA(4)_$S($G(VAOA(4))'="":", ",1:"")_$P(VAOA(5),"^",2)_" "_VAOA(6)
"RTN","ORDV07",118,0)
 ; 15  Security Log
"RTN","ORDV07",119,0)
 S ^TMP("ORDATA",$J,1,"WP",15)="15^"_$S($P($G(^DGSL(38.1,DFN,0)),"^",2):"YES",1:"NO")
"RTN","ORDV07",120,0)
 S ROOT=$NA(^TMP("ORDATA",$J))
"RTN","ORDV07",121,0)
 Q
"RTN","ORDV07",122,0)
ICDSUR(ROOT,ORALPHA,OROMEGA,ORMAX,ORDBEG,ORDEND,OREXT) ;Return ICD Surgery Information
"RTN","ORDV07",123,0)
 ;External calls to VASITE, GMTSDGP
"RTN","ORDV07",124,0)
 N ORSITE,SITE,T1,T2,I,J,GMS,PTF,ORDATE
"RTN","ORDV07",125,0)
 K ^TMP("ORDATA",$J)
"RTN","ORDV07",126,0)
 S T1=ORDEND,T2=ORDBEG,ORSITE=$$SITE^VASITE,ORSITE=$P(ORSITE,"^",2)_";"_$P(ORSITE,"^",3)
"RTN","ORDV07",127,0)
 F PTF=0:0 S PTF=$O(^DGPT("B",DFN,PTF)) Q:PTF=""  D ICDS^GMTSDGP
"RTN","ORDV07",128,0)
 S (I,ORDATE)=0
"RTN","ORDV07",129,0)
 F  S ORDATE=$O(GMS(ORDATE)) Q:ORDATE=""!(I'<ORMAX)  S J=0 D
"RTN","ORDV07",130,0)
 . F  S J=$O(GMS(ORDATE,J))  Q:'J!(I'<ORMAX)  S I=I+1 D  ;Check for multiple procedures on same date
"RTN","ORDV07",131,0)
 .. S SITE=$S($L($G(GMS(ORDATE,J,"facility"))):^("facility"),1:ORSITE)
"RTN","ORDV07",132,0)
 .. S ^TMP("ORDATA",$J,"WP",ORDATE,J,1)="1^"_SITE
"RTN","ORDV07",133,0)
 .. S ^TMP("ORDATA",$J,"WP",ORDATE,J,2)="2^"_$$DATEMMM^ORDVU($P(GMS(ORDATE),"  ",3)) ;Date of procedure
"RTN","ORDV07",134,0)
 .. S ^TMP("ORDATA",$J,"WP",ORDATE,J,3)="3^"_$P($G(GMS(ORDATE,J)),"^") ;Surgery and code
"RTN","ORDV07",135,0)
 .. S ^TMP("ORDATA",$J,"WP",ORDATE,J,4)="4^"_$P(GMS(ORDATE,J),"^",2) ;ICD code
"RTN","ORDV07",136,0)
 S ROOT=$NA(^TMP("ORDATA",$J))
"RTN","ORDV07",137,0)
 Q
"RTN","ORDV07",138,0)
PRC(ROOT,ORALPHA,OROMEGA,ORMAX,ORDBEG,ORDEND,OREXT) ;Return Procedure Information
"RTN","ORDV07",139,0)
 ;External calls to VASITE, GMTSDGP
"RTN","ORDV07",140,0)
 N ORSITE,SITE,T1,T2,I,J,GMP,PTF,ORDATE
"RTN","ORDV07",141,0)
 K ^TMP("ORDATA",$J)
"RTN","ORDV07",142,0)
 S T1=ORDEND,T2=ORDBEG,PTF=0,ORSITE=$$SITE^VASITE,ORSITE=$P(ORSITE,"^",2)_";"_$P(ORSITE,"^",3)
"RTN","ORDV07",143,0)
 F  S PTF=$O(^DGPT("B",DFN,PTF)) Q:PTF=""  D ICDP^GMTSDGP
"RTN","ORDV07",144,0)
 S (I,ORDATE)=0
"RTN","ORDV07",145,0)
 F  S ORDATE=$O(GMP(ORDATE)) Q:ORDATE=""!(I'<ORMAX)  S J=0 D
"RTN","ORDV07",146,0)
 . F  S J=$O(GMP(ORDATE,J))  Q:'J!(I'<ORMAX)  S I=I+1 D  ;Check for multiple procedures on same date
"RTN","ORDV07",147,0)
 .. S SITE=$S($L($G(GMP(ORDATE,J,"facility"))):^("facility"),1:ORSITE)
"RTN","ORDV07",148,0)
 .. S ^TMP("ORDATA",$J,"WP",ORDATE,J,1)="1^"_SITE
"RTN","ORDV07",149,0)
 .. S ^TMP("ORDATA",$J,"WP",ORDATE,J,2)="2^"_$$DATEMMM^ORDVU($P(GMP(ORDATE),"  ",2)) ;Date of procedure
"RTN","ORDV07",150,0)
 .. S ^TMP("ORDATA",$J,"WP",ORDATE,J,3)="3^"_$P($G(GMP(ORDATE,J)),"^") ;Procedure and code
"RTN","ORDV07",151,0)
 .. S ^TMP("ORDATA",$J,"WP",ORDATE,J,4)="4^"_$P(GMP(ORDATE,J),"^",2) ;ICD code
"RTN","ORDV07",152,0)
 S ROOT=$NA(^TMP("ORDATA",$J))
"RTN","ORDV07",153,0)
 Q
"RTN","ORDV07",154,0)
INS(ROOT,ORALPHA,OROMEGA,ORMAX,ORDBEG,ORDEND,OREXT) ;Return Insurance Information
"RTN","ORDV07",155,0)
 ;External calls to VASITE and IBCNS1 and ^DIC(36, and ^IBE(355.1
"RTN","ORDV07",156,0)
 N ORSITE,SITE,ORARRAY,I
"RTN","ORDV07",157,0)
 K ^TMP("ORDATA",$J)
"RTN","ORDV07",158,0)
 D ALL^IBCNS1(DFN,"ORARRAY")
"RTN","ORDV07",159,0)
 Q:'$D(ORARRAY)  ;quit if no insurance data returned
"RTN","ORDV07",160,0)
 S ORSITE=$$SITE^VASITE,ORSITE=$P(ORSITE,"^",2)_";"_$P(ORSITE,"^",3),I=0
"RTN","ORDV07",161,0)
 F  S I=$O(ORARRAY(I)) Q:'I  D
"RTN","ORDV07",162,0)
 . S SITE=$S($L($G(ORARRAY(I,"facility"))):^("facility"),1:ORSITE)
"RTN","ORDV07",163,0)
 . S ^TMP("ORDATA",$J,"WP",I,1)="1^"_SITE
"RTN","ORDV07",164,0)
 . S ^TMP("ORDATA",$J,"WP",I,2)="2^"_$P($G(^DIC(36,+$P(ORARRAY(I,0),"^"),0)),"^") ;Insurance company
"RTN","ORDV07",165,0)
 . S ^TMP("ORDATA",$J,"WP",I,3)="3^"_$P($G(^IBE(355.1,+$P(ORARRAY(I,355.3),"^",9),0)),"^") ;Policy type
"RTN","ORDV07",166,0)
 . S ^TMP("ORDATA",$J,"WP",I,4)="4^"_$P(ORARRAY(I,355.3),"^",4) ;Group number
"RTN","ORDV07",167,0)
 . S ^TMP("ORDATA",$J,"WP",I,5)="5^"_$S($P(ORARRAY(I,0),"^",6)="s":"SPOUSE",$P(ORARRAY(I,0),"^",6)="v":"SELF",1:"OTHER") ;Policy holder
"RTN","ORDV07",168,0)
 . S ^TMP("ORDATA",$J,"WP",I,6)="6^"_$$DATE^ORDVU($P(ORARRAY(I,0),"^",8)) ;Effective date of policy
"RTN","ORDV07",169,0)
 . S ^TMP("ORDATA",$J,"WP",I,7)="7^"_$$DATE^ORDVU($P(ORARRAY(I,0),"^",4)) ;Expiration date of policy
"RTN","ORDV07",170,0)
 S ROOT=$NA(^TMP("ORDATA",$J))
"RTN","ORDV07",171,0)
 Q
"RTN","ORP159")
0^^B6223403
"RTN","ORP159",1,0)
ORP159 ; SLC/KER - Post-Install for OR*3.0*159    ; 01/09/2003
"RTN","ORP159",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**159**;Dec 17,1997
"RTN","ORP159",3,0)
 Q
"RTN","ORP159",4,0)
POST ; Post Install
"RTN","ORP159",5,0)
 N DA,DIK,ORPC,ORPT,X S ORPT=+($O(^ORD(101.24,"B","ORRPW ADT DEMOG",0))) Q:+ORPT'>0
"RTN","ORP159",6,0)
 S DA=+ORPT,DIK="^ORD(101.24,",U="^",ORPC=$O(^XWB(8994,"B","ORWRP REPORT TEXT",0)) Q:+ORPC'>0 
"RTN","ORP159",7,0)
 D MB(" Adding Race and Ethnicity to ORRPW ADT DEMOG Report") D ^DIK
"RTN","ORP159",8,0)
 S ^ORD(101.24,ORPT,0)="ORRPW ADT DEMOG^OR_DEMG^1^6^ORDV01^HSQUERY^0^R^^^^V^"_ORPC_"^^^^^^DEM^ORDV07^6"
"RTN","ORP159",9,0)
 S ^ORD(101.24,ORPT,2)="^^Demographics^Demographics^^HSTYPEB^ORWRPP1"
"RTN","ORP159",10,0)
 S ^ORD(101.24,ORPT,3,0)="^101.243^26^16",^ORD(101.24,ORPT,3,1,0)="Facility^^1^^^10^1",^ORD(101.24,ORPT,3,2,0)="Patient Name     ^^3^^^20^1^Name"
"RTN","ORP159",11,0)
 S ^ORD(101.24,ORPT,3,3,0)="Social Security #^^4^^^11^1^SSN",^ORD(101.24,ORPT,3,4,0)="Gender^^5^^^4^1^SEX",^ORD(101.24,ORPT,3,5,0)="Date of Birth^^6^^^12^1^DOB"
"RTN","ORP159",12,0)
 S ^ORD(101.24,ORPT,3,6,0)="Religion^^7",^ORD(101.24,ORPT,3,9,0)="Marital status^^8",^ORD(101.24,ORPT,3,10,0)="Home phone^^9"
"RTN","ORP159",13,0)
 S ^ORD(101.24,ORPT,3,11,0)="Home Address^^10^1^1^^1",^ORD(101.24,ORPT,3,12,0)="Race^^11^1^1",^ORD(101.24,ORPT,3,13,0)="Ethnicity^^12^1^1"
"RTN","ORP159",14,0)
 S ^ORD(101.24,ORPT,3,17,0)="Next of kin^^13",^ORD(101.24,ORPT,3,18,0)="Relationship^^14",^ORD(101.24,ORPT,3,19,0)="NOK Address^^15^1^1"
"RTN","ORP159",15,0)
 S ^ORD(101.24,ORPT,3,25,0)="Sensitive^^16",^ORD(101.24,ORPT,3,26,0)="ID^1^2"
"RTN","ORP159",16,0)
 D IX1^DIK H 1 D M("  <done>")
"RTN","ORP159",17,0)
 Q
"RTN","ORP159",18,0)
MB(X) D:$D(XPDNM) BMES^XPDUTL($G(X)) W:'$D(XPDNM) !!,$G(X) Q
"RTN","ORP159",19,0)
M(X) D:$D(XPDNM) MES^XPDUTL($G(X)) W:'$D(XPDNM) !,$G(X) Q
"RTN","ORQPTQ3")
0^5^B6165751
"RTN","ORQPTQ3",1,0)
ORQPTQ3 ; SLC/CLA/KER - Demographic Functions             ; 01/09/2003
"RTN","ORQPTQ3",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**159**;Dec 17, 1997
"RTN","ORQPTQ3",3,0)
 ;
"RTN","ORQPTQ3",4,0)
DEMOG(Y,DFN) ; RETURN PATIENT'S DEMOGRAPHIC INFO
"RTN","ORQPTQ3",5,0)
 ;DEM: SSN^DOB^AGE^SEX^RACE^ETHNICITY^RELIGION^MARITAL STATUS
"RTN","ORQPTQ3",6,0)
 ;INP: PRIMARY DUZ;NAME^ATTENDING DUZ;NAME^LOCATION^WARD^RMBED
"RTN","ORQPTQ3",7,0)
 N ORPTDEMO,ATTDUZ,PRIMDUZ,ORI,ORR,ORE,ORD,ORO D DEM^VADPT
"RTN","ORQPTQ3",8,0)
 S ORI=0 F  S ORI=$O(VADM(11,ORI)) Q:+ORI=0  S ORD=$P(VADM(11,ORI),"^",2) S:$L(ORD) ORE=$G(ORE)_", "_ORD
"RTN","ORQPTQ3",9,0)
 F  Q:$E(ORE,1,2)'=", "  S ORE=$E(ORE,3,$L(ORE))
"RTN","ORQPTQ3",10,0)
 S ORI=0 F  S ORI=$O(VADM(12,ORI)) Q:+ORI=0  S ORD=$P($G(VADM(12,ORI)),"^",2) S:$L(ORD) ORR=$G(ORR)_", "_ORD
"RTN","ORQPTQ3",11,0)
 F  Q:$E(ORR,1,2)'=", "  S ORR=$E(ORR,3,$L(ORR))
"RTN","ORQPTQ3",12,0)
 S ORO=$P(VADM(8),U,2) S:'$L(ORE)&('$L(ORR))&('$D(VADM(11)))&('$D(VADM(12))) ORE=ORO
"RTN","ORQPTQ3",13,0)
 S ORPTDEMO=$P(VADM(2),U)_U_$P(VADM(3),U,2)_U_VADM(4)_U_$P(VADM(5),U,2)_U_ORR_U_ORE_U_$P(VADM(9),U,2)_U_$P(VADM(10),U,2)
"RTN","ORQPTQ3",14,0)
 K VAINDT,VADM,VAERR S VA200=1
"RTN","ORQPTQ3",15,0)
 D INP^VADPT
"RTN","ORQPTQ3",16,0)
 S Y=ORPTDEMO_U_$P(VAIN(2),U)_";"_$P(VAIN(2),U,2)_U_$P(VAIN(11),U)_";"_$P(VAIN(11),U,2)_U_U_$P(VAIN(4),U,2)_U_VAIN(5)
"RTN","ORQPTQ3",17,0)
 K VA200,VAIN,VAERR
"RTN","ORQPTQ3",18,0)
 Q
"RTN","ORQPTQ3",19,0)
WRB(Y,DFN) ;return patient's ward, room-bed: ward ien^ward name room-bed
"RTN","ORQPTQ3",20,0)
 N WNAME,WIEN S WIEN="",Y=""
"RTN","ORQPTQ3",21,0)
 S WNAME=$G(^DPT(DFN,.1)) I $L(WNAME) S WIEN=$O(^DIC(42,"B",WNAME,WIEN))
"RTN","ORQPTQ3",22,0)
 I $L($G(WNAME)),$L($G(WIEN)) S Y=WIEN_U_WNAME_" "_$G(^DPT(DFN,.101))
"RTN","ORQPTQ3",23,0)
 Q
"RTN","ORQPTQ3",24,0)
NAME(ORY,DFN) ; return patient's name in mixed case
"RTN","ORQPTQ3",25,0)
 I '$L($G(^DPT(DFN,0))) S ORY="Not found" Q
"RTN","ORQPTQ3",26,0)
 S ORY=$$LOWER^VALM1($P(^DPT(DFN,0),U))
"RTN","ORQPTQ3",27,0)
 Q
"RTN","ORQPTQ3",28,0)
ADDR(Y,DFN) ; RETURN PATIENT'S ADDRESS & PHONE NUMBER
"RTN","ORQPTQ3",29,0)
 D ADD^VADPT
"RTN","ORQPTQ3",30,0)
 S Y=VAPA(1)_"^"_VAPA(2)_"^"_VAPA(3)_"^"_VAPA(4)_"^"_$P(VAPA(5),"^",2)_"^"_VAPA(6)_"^"_VAPA(8)
"RTN","ORQPTQ3",31,0)
 K VAPA
"RTN","ORQPTQ3",32,0)
 Q
"RTN","ORQPTQ3",33,0)
ATTPRIM(ORY,DFN) ; return patient's attending physician and primary provider
"RTN","ORQPTQ3",34,0)
 ;          format: ATTEND DUZ^ATTEND NAME;PRIMARY DUZ^PRIMARY NAME
"RTN","ORQPTQ3",35,0)
 K VAINDT S VA200=1
"RTN","ORQPTQ3",36,0)
 D INP^VADPT
"RTN","ORQPTQ3",37,0)
 S ORY=$S($L($G(VAIN(11))):VAIN(11),1:"^not found") ;attending physician
"RTN","ORQPTQ3",38,0)
 S ORY=ORY_";"_$S($L($G(VAIN(2))):VAIN(2),1:"^not found") ;primary provider
"RTN","ORQPTQ3",39,0)
 K VA200,VAIN
"RTN","ORQPTQ3",40,0)
 Q
"RTN","ORQPTQ3",41,0)
WARD(Y,DFN) ; RETURN PATIENT'S WARD
"RTN","ORQPTQ3",42,0)
 D INP^VADPT
"RTN","ORQPTQ3",43,0)
 S Y=VAIN(4)
"RTN","ORQPTQ3",44,0)
 K VAIN
"RTN","ORQPTQ3",45,0)
 Q
"RTN","ORQPTQ3",46,0)
RMBED(Y,DFN) ; RETURN PATIENT'S ROOM-BED
"RTN","ORQPTQ3",47,0)
 D INP^VADPT
"RTN","ORQPTQ3",48,0)
 S Y=VAIN(5)
"RTN","ORQPTQ3",49,0)
 K VAIN
"RTN","ORQPTQ3",50,0)
 Q
"RTN","ORQPTQ3",51,0)
ATTEND(Y,DFN) ; RETURN PATIENT'S ATTENDING PHYSICIAN
"RTN","ORQPTQ3",52,0)
 ;NOT YET IMPLEMENTED
"RTN","ORQPTQ3",53,0)
 ;D INP^VADPT
"RTN","ORQPTQ3",54,0)
 Q
"RTN","ORQPTQ3",55,0)
SSN(Y,DFN) ; RETURN PATIENT'S SSN
"RTN","ORQPTQ3",56,0)
 D DEM^VADPT
"RTN","ORQPTQ3",57,0)
 S Y=VADM(2)
"RTN","ORQPTQ3",58,0)
 K VADM
"RTN","ORQPTQ3",59,0)
 Q
"RTN","ORQPTQ3",60,0)
DOB(Y,DFN) ; RETURN PATIENT'S DATE OF BIRTH
"RTN","ORQPTQ3",61,0)
 D DEM^VADPT
"RTN","ORQPTQ3",62,0)
 S Y=VADM(3)
"RTN","ORQPTQ3",63,0)
 K VADM
"RTN","ORQPTQ3",64,0)
 Q
"RTN","ORQPTQ3",65,0)
AGE(Y,DFN) ; RETURN PATIENT'S AGE
"RTN","ORQPTQ3",66,0)
 D DEM^VADPT
"RTN","ORQPTQ3",67,0)
 S Y=VADM(4)
"RTN","ORQPTQ3",68,0)
 K VADM
"RTN","ORQPTQ3",69,0)
 Q
"RTN","ORQPTQ3",70,0)
SEX(Y,DFN) ; RETURN PATIENT'S SEX
"RTN","ORQPTQ3",71,0)
 D DEM^VADPT
"RTN","ORQPTQ3",72,0)
 S Y=VADM(5)
"RTN","ORQPTQ3",73,0)
 K VADM
"RTN","ORQPTQ3",74,0)
 Q
"VER")
8.0^22.0
**END**
**END**
