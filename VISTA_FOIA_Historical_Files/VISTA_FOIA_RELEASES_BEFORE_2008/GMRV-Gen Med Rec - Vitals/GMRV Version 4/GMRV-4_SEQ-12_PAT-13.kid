Released GMRV*4*13 SEQ #12
Extracted from mail message
**KIDS**:GMRV*4.0*13^

**INSTALL NAME**
GMRV*4.0*13
"BLD",3052,0)
GMRV*4.0*13^GEN. MED. REC. - VITALS^0^3010717^y
"BLD",3052,1,0)
^^2^2^3010702^^
"BLD",3052,1,1,0)
Please read the GMRV*4*13 patch description on FORUM for an explanation of
"BLD",3052,1,2,0)
what this patch does.
"BLD",3052,4,0)
^9.64PA^^
"BLD",3052,"ABNS",0)
^9.66A^^
"BLD",3052,"ABPKG")
^n
"BLD",3052,"KRN",0)
^9.67PA^19^17
"BLD",3052,"KRN",.4,0)
.4
"BLD",3052,"KRN",.401,0)
.401
"BLD",3052,"KRN",.402,0)
.402
"BLD",3052,"KRN",.403,0)
.403
"BLD",3052,"KRN",.5,0)
.5
"BLD",3052,"KRN",.84,0)
.84
"BLD",3052,"KRN",3.6,0)
3.6
"BLD",3052,"KRN",3.8,0)
3.8
"BLD",3052,"KRN",9.2,0)
9.2
"BLD",3052,"KRN",9.8,0)
9.8
"BLD",3052,"KRN",9.8,"NM",0)
^9.68A^12^10
"BLD",3052,"KRN",9.8,"NM",1,0)
GMRVDS0^^0^B21505774
"BLD",3052,"KRN",9.8,"NM",2,0)
GMRVED0^^0^B25746398
"BLD",3052,"KRN",9.8,"NM",4,0)
GMRVLWT1^^0^B12358242
"BLD",3052,"KRN",9.8,"NM",5,0)
GMRVPCE3^^0^B10718450
"BLD",3052,"KRN",9.8,"NM",6,0)
GMRVSC2^^0^B15866640
"BLD",3052,"KRN",9.8,"NM",7,0)
GMRVUT2^^0^B18552169
"BLD",3052,"KRN",9.8,"NM",8,0)
GMRVUT3^^0^B14717743
"BLD",3052,"KRN",9.8,"NM",9,0)
GMRVED3^^0^B40309323
"BLD",3052,"KRN",9.8,"NM",10,0)
GMRVUTL1^^0^B5432870
"BLD",3052,"KRN",9.8,"NM",12,0)
GMRVUT0^^0^B12655515
"BLD",3052,"KRN",9.8,"NM","B","GMRVDS0",1)

"BLD",3052,"KRN",9.8,"NM","B","GMRVED0",2)

"BLD",3052,"KRN",9.8,"NM","B","GMRVED3",9)

"BLD",3052,"KRN",9.8,"NM","B","GMRVLWT1",4)

"BLD",3052,"KRN",9.8,"NM","B","GMRVPCE3",5)

"BLD",3052,"KRN",9.8,"NM","B","GMRVSC2",6)

"BLD",3052,"KRN",9.8,"NM","B","GMRVUT0",12)

"BLD",3052,"KRN",9.8,"NM","B","GMRVUT2",7)

"BLD",3052,"KRN",9.8,"NM","B","GMRVUT3",8)

"BLD",3052,"KRN",9.8,"NM","B","GMRVUTL1",10)

"BLD",3052,"KRN",19,0)
19
"BLD",3052,"KRN",19.1,0)
19.1
"BLD",3052,"KRN",101,0)
101
"BLD",3052,"KRN",409.61,0)
409.61
"BLD",3052,"KRN",771,0)
771
"BLD",3052,"KRN",870,0)
870
"BLD",3052,"KRN",8994,0)
8994
"BLD",3052,"KRN","B",.4,.4)

"BLD",3052,"KRN","B",.401,.401)

"BLD",3052,"KRN","B",.402,.402)

"BLD",3052,"KRN","B",.403,.403)

"BLD",3052,"KRN","B",.5,.5)

"BLD",3052,"KRN","B",.84,.84)

"BLD",3052,"KRN","B",3.6,3.6)

"BLD",3052,"KRN","B",3.8,3.8)

"BLD",3052,"KRN","B",9.2,9.2)

"BLD",3052,"KRN","B",9.8,9.8)

"BLD",3052,"KRN","B",19,19)

"BLD",3052,"KRN","B",19.1,19.1)

"BLD",3052,"KRN","B",101,101)

"BLD",3052,"KRN","B",409.61,409.61)

"BLD",3052,"KRN","B",771,771)

"BLD",3052,"KRN","B",870,870)

"BLD",3052,"KRN","B",8994,8994)

"BLD",3052,"QUES",0)
^9.62^^
"BLD",3052,"REQB",0)
^9.611^6^6
"BLD",3052,"REQB",1,0)
GMRV*4.0*1^2
"BLD",3052,"REQB",2,0)
GMRV*4.0*8^2
"BLD",3052,"REQB",3,0)
GMRV*4.0*9^2
"BLD",3052,"REQB",4,0)
GMRV*4.0*10^2
"BLD",3052,"REQB",5,0)
GMRV*4.0*11^2
"BLD",3052,"REQB",6,0)
GMRV*4.0*7^2
"BLD",3052,"REQB","B","GMRV*4.0*1",1)

"BLD",3052,"REQB","B","GMRV*4.0*10",4)

"BLD",3052,"REQB","B","GMRV*4.0*11",5)

"BLD",3052,"REQB","B","GMRV*4.0*7",6)

"BLD",3052,"REQB","B","GMRV*4.0*8",2)

"BLD",3052,"REQB","B","GMRV*4.0*9",3)

"MBREQ")
0
"PKG",44,-1)
1^1
"PKG",44,0)
GEN. MED. REC. - VITALS^GMRV^Vitals/Measurements Module of General Medical Record.
"PKG",44,20,0)
^9.402P^^
"PKG",44,22,0)
^9.49I^1^1
"PKG",44,22,1,0)
4.0^2970425^2970702^64
"PKG",44,22,1,"PAH",1,0)
13^3010717
"PKG",44,22,1,"PAH",1,1,0)
^^2^2^3010717
"PKG",44,22,1,"PAH",1,1,1,0)
Please read the GMRV*4*13 patch description on FORUM for an explanation of
"PKG",44,22,1,"PAH",1,1,2,0)
what this patch does.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
10
"RTN","GMRVDS0")
0^1^B21505774
"RTN","GMRVDS0",1,0)
GMRVDS0 ;HIRMFO/YH,FT-DISPLAY LATEST VITALS/MEASUREMENTS ;6/13/01  15:03
"RTN","GMRVDS0",2,0)
 ;;4.0;Vitals/Measurements;**1,7,11,13**;Apr 25, 1997
"RTN","GMRVDS0",3,0)
 ;
"RTN","GMRVDS0",4,0)
 ; This routine uses the following IAs:
"RTN","GMRVDS0",5,0)
 ; #10061  ^VADPT calls     (supported)
"RTN","GMRVDS0",6,0)
 ;
"RTN","GMRVDS0",7,0)
EN2 ;ENTRY TO DISPLAY THE LATEST VITALS/MEASUREMENTS IF DFN IS UNKNOWN
"RTN","GMRVDS0",8,0)
 S DIC(0)="AEM",DIC="^DPT(" D ^DIC K DIC Q:+Y'>0  S DFN=+Y
"RTN","GMRVDS0",9,0)
EN3 ; ENTRY TO DISPLAY THE LATEST VITALS/MEASUREMENTS IF DFN IS KNOWN
"RTN","GMRVDS0",10,0)
 Q:'$D(DFN)
"RTN","GMRVDS0",11,0)
 S GMREDB="P" D PAT^GMRVDS1 D Q
"RTN","GMRVDS0",12,0)
 Q
"RTN","GMRVDS0",13,0)
EN1 ; ENTRY TO DISPLAY VITALS
"RTN","GMRVDS0",14,0)
 N GAPICAL,GRADIAL,GBRACHI,OK
"RTN","GMRVDS0",15,0)
 S GAPICAL=$O(^GMRD(120.52,"B","APICAL",0)),GRADIAL=$O(^GMRD(120.52,"B","RADIAL",0)),GBRACHI=$O(^GMRD(120.52,"B","BRACHIAL",0))
"RTN","GMRVDS0",16,0)
 F GMRX=1:1:$L(GMRSTR,";") S X=$P(GMRSTR,";",GMRX) Q:'$D(^GMRD(120.51,"C",X))  S GMR(X)=$O(^GMRD(120.51,"C",X,"")),Y=$P($G(^GMRD(120.51,GMR(X),0)),"^") Q:Y=""
"RTN","GMRVDS0",17,0)
 K GMRDT,GMRVWT,GMRVHT S X="" F  S X=$O(GMR(X)) Q:X=""  S GMRDATS="" I GMR(X)'="" F GMRDAT=0:0 S GMRDAT=$O(^GMR(120.5,"AA",DFN,+GMR(X),GMRDAT)) Q:$S(GMRDAT'>0:1,GMRDATS>0:1,1:0)  D SETDATAR
"RTN","GMRVDS0",18,0)
 I '($D(GMRDATA)\10) W !,"There are no results to report " G Q
"RTN","GMRVDS0",19,0)
 F X="T","P","R","PO2","BP","HT","WT","CVP","CG","PN" I $D(GMRDATA(X)) S GMRVDT="",(GMRVDT(1),GMVD)=0 F  S GMVD=$O(GMRDATA(X,GMVD)) Q:GMVD'>0  D WRTDT S GMVD(1)=0 F  S GMVD(1)=$O(GMRDATA(X,GMVD,GMVD(1))) Q:GMVD(1)'>0  D
"RTN","GMRVDS0",20,0)
 . S GMRVX(0)=GMRDATA(X,GMVD,GMVD(1)) S GMRVX=X D EN1^GMRVSAS0
"RTN","GMRVDS0",21,0)
  . W ! W:GMRVDT(1)=0 $S(X="BP":"B/P",X="P":"Pulse",X="R":"Resp.",X="T":"Temp.",X="HT":"Ht.",X="CG":"Circ/Girth",X="WT":"Wt.",X="PO2":"Pulse Ox",X="PN":"Pain",1:X)_": "
"RTN","GMRVDS0",22,0)
 . I GMRVDT(1)=0 W ?12,"("_GMRVDT_") " S GMRVDT(1)=1
"RTN","GMRVDS0",23,0)
 . I X="T" W ?29,GMRVX(0)_" F  ("_$J(+GMRVX(0)-32*5/9,0,1)_" C)"
"RTN","GMRVDS0",24,0)
 . I X="WT" W ?29,GMRVX(0)_" lb  ("_$J(GMRVX(0)/2.2,0,2)_" kg)" S GMRVWT=GMRVX(0)/2.2
"RTN","GMRVDS0",25,0)
 . I X="HT" W ?29,$S(GMRVX(0)\12:GMRVX(0)\12_" ft ",1:"")_$S(GMRVX(0)#12:GMRVX(0)#12_" in",1:"")_" ("_$J(GMRVX(0)*2.54,0,2)_" cm)" S GMRVHT=(GMRVX(0)*2.54)/100
"RTN","GMRVDS0",26,0)
 . I X="CG" W ?29,GMRVX(0)_" in ("_$J(+GMRVX(0)/.3937,0,2)_" cm)"
"RTN","GMRVDS0",27,0)
 . I X="CVP" W ?29,GMRVX(0)_" cmH2O ("_$J(GMRVX(0)/1.36,0,1)_" mmHg)"
"RTN","GMRVDS0",28,0)
 . I X="PO2" W ?29,GMRVX(0)_"% "
"RTN","GMRVDS0",29,0)
 . I X="P"!(X="R")!(X="BP") W ?29,GMRVX(0)
"RTN","GMRVDS0",30,0)
 . I X="PN" D
"RTN","GMRVDS0",31,0)
 . . I "UNAVAILABLEPASSREFUSED"[$$UP^XLFSTR(GMRVX(0)) W ?9,GMRVX(0) Q
"RTN","GMRVDS0",32,0)
 . . I GMRVX(0)=0 W ?29,GMRVX(0)_" - No pain " Q
"RTN","GMRVDS0",33,0)
 . . I GMRVX(0)=99 W ?29,GMRVX(0)_" - Unable to respond " Q
"RTN","GMRVDS0",34,0)
 . . I GMRVX(0)=10 W ?29,GMRVX(0)_" - Worst imaginable pain " Q
"RTN","GMRVDS0",35,0)
 . . W ?29,GMRVX(0) Q
"RTN","GMRVDS0",36,0)
 . W $S('$D(GMRVX(1)):"",'GMRVX(1):"",1:"*") K GMRVX
"RTN","GMRVDS0",37,0)
 . D CHAR
"RTN","GMRVDS0",38,0)
 . I X="WT",$G(GMRVWT)>0,$G(GMRVHT)>0 W !,"BMI: " S GMRVHT(1)=$J(GMRVWT/(GMRVHT*GMRVHT),0,0) W ?29,GMRVHT(1)_$S(GMRVHT(1)>27:"*",1:"")
"RTN","GMRVDS0",39,0)
 . Q
"RTN","GMRVDS0",40,0)
Q W ! K GMRVWT,GMRVHT,GMR,GMVD,GBP,GMRVARY,GMRVDA,GMRDATA,GMVDM,GLIN,GMRZZ Q:$D(GLOC)
"RTN","GMRVDS0",41,0)
 K GMRVDT,GMROUT,DFN,%Y,GMRL,GMRDT,DIC,GMRDAT,GMRDATS,GMRSTR,GMRX,GMRVX,POP D KVAR^VADPT K VA
"RTN","GMRVDS0",42,0)
 Q
"RTN","GMRVDS0",43,0)
SETDATAR ;
"RTN","GMRVDS0",44,0)
 S Y=0 F  S Y=$O(^GMR(120.5,"AA",DFN,GMR(X),GMRDAT,Y)) Q:Y'>0!GMRDATS  I '$D(^GMR(120.5,Y,2)),$P(^GMR(120.5,Y,0),"^",8)'="" D SETNODE
"RTN","GMRVDS0",45,0)
 D:X="BP"!(X="P") SETBP^GMRVDS2 Q
"RTN","GMRVDS0",46,0)
SETNODE ;
"RTN","GMRVDS0",47,0)
 N G S GMRL=$S($D(^GMR(120.5,Y,0)):^(0),1:"")
"RTN","GMRVDS0",48,0)
 ;N G S G=$P(GMRL,"^",8) Q:'(G>0!(G<0)!($E(G)="0"))
"RTN","GMRVDS0",49,0)
 I X'="P" S G=$P(GMRL,"^",8) Q:"REFUSEDPASSUNAVAILABLE"[$$UP^XLFSTR(G)
"RTN","GMRVDS0",50,0)
 I X="P" S OK=0,G=$P(GMRL,"^",8) D  Q:'OK
"RTN","GMRVDS0",51,0)
 . I "REFUSEDPASSUNAVAILABLE"[$$UP^XLFSTR(G) Q
"RTN","GMRVDS0",52,0)
 . I '$D(^GMR(120.5,Y,5,"B")) S OK=1 Q
"RTN","GMRVDS0",53,0)
 . I $D(^GMR(120.5,Y,5,"B",GAPICAL)) S OK=1 Q
"RTN","GMRVDS0",54,0)
 . I $D(^GMR(120.5,Y,5,"B",GBRACHI)) S OK=1 Q
"RTN","GMRVDS0",55,0)
 . I $D(^GMR(120.5,Y,5,"B",GRADIAL)) S OK=1
"RTN","GMRVDS0",56,0)
 S GMRL1=$P(GMRL,"^") ;adding trailing zeros to time if necessary
"RTN","GMRVDS0",57,0)
 S $P(GMRL1,".",2)=$P(GMRL1,".",2)_"0000"
"RTN","GMRVDS0",58,0)
 S $P(GMRL1,".",2)=$E($P(GMRL1,".",2),1,4)
"RTN","GMRVDS0",59,0)
 S $P(GMRL,"^")=GMRL1
"RTN","GMRVDS0",60,0)
 K GMRL1
"RTN","GMRVDS0",61,0)
 I GMRL'="" S GMRDATA(X,$P(GMRL,"^"),Y)=$P(GMRL,"^",8),GMRDATS=1 I $P($G(^GMR(120.5,Y,5,0)),"^",4)>0 D CHAR^GMRVCHAR(Y,.GMRVARY,GMR(X))
"RTN","GMRVDS0",62,0)
 Q
"RTN","GMRVDS0",63,0)
WRTDT ;
"RTN","GMRVDS0",64,0)
 S GMRVDT=$E(GMVD,4,5)_"/"_$E(GMVD,6,7)_"/"_$E(GMVD,2,3)_"@"_$E($P(GMVD,".",2),1,2)_$S($E($P(GMVD,".",2),3,4)'="":":"_$E($P(GMVD,".",2),3,4),1:"")
"RTN","GMRVDS0",65,0)
 Q
"RTN","GMRVDS0",66,0)
CHAR ;
"RTN","GMRVDS0",67,0)
 S GMRZZ=$$WRITECH^GMRVCHAR(GMVD(1),.GMRVARY,5) S:GMRZZ'=""&(X'="PO2") GMRZZ="("_GMRZZ_")"
"RTN","GMRVDS0",68,0)
 I X="PO2",$P(^GMR(120.5,GMVD(1),0),"^",10)'="" S GMRVPO=$P(^(0),"^",10) W "with supplemental O2 "_$S(GMRVPO["l/min":$P(GMRVPO," l/min")_"L/min",1:"")_$S(GMRVPO["l/min":$P(GMRVPO," l/min",2),1:GMRVPO)_" " W:GMRZZ'="" !,?29,"- ",GMRZZ K GMRZZ Q
"RTN","GMRVDS0",69,0)
 W:GMRZZ'="" GMRZZ K GMRZZ
"RTN","GMRVDS0",70,0)
 Q
"RTN","GMRVED0")
0^2^B25746398
"RTN","GMRVED0",1,0)
GMRVED0 ;HIRMFO/RM,YH,FT-VITAL SIGNS EDIT SHORT FORM ;6/13/01  15:44
"RTN","GMRVED0",2,0)
 ;;4.0;Vitals/Measurements;**7,9,13**;Apr 25, 1997
"RTN","GMRVED0",3,0)
 ;
"RTN","GMRVED0",4,0)
 ; This routine uses the following IAs:
"RTN","GMRVED0",5,0)
 ; #1380   ^DG(405.4        (controlled)
"RTN","GMRVED0",6,0)
 ; #10035  ^DPT("CN"        (supported)
"RTN","GMRVED0",7,0)
 ; #10039  ^DIC(42          (supported)
"RTN","GMRVED0",8,0)
 ; #10040  ^SC(             (supported)
"RTN","GMRVED0",9,0)
 ; #10061  ^VADPT APIs      (supported)
"RTN","GMRVED0",10,0)
 ;
"RTN","GMRVED0",11,0)
EN2 ; DETERMINE VITALS SITE
"RTN","GMRVED0",12,0)
 Q:GMRENTY<1!(GMRENTY>21)  K GMRTMP S GMROUT=0,GMRVIDT(0)=0 I $D(GMRVDBA) S GMRVIDT=$P(GMRVDBA,U,2),GMROUT=$P(GMRVDBA,U)
"RTN","GMRVED0",13,0)
 I '($D(GMRVIDT)#2) S GMRVIDT(0)=1 D DATE^GMRVED0 I GMROUT K GMROUT Q
"RTN","GMRVED0",14,0)
 S GMROUT=0,GMRVWLOC=1,GDT(1)=GMRVIDT D WARDPAT G:GMROUT Q
"RTN","GMRVED0",15,0)
A2 ;
"RTN","GMRVED0",16,0)
 I $G(GMRSTR)="" D
"RTN","GMRVED0",17,0)
 . S GMRSTR=$S(GMRENTY=1:"T;P;R;PN;",GMRENTY=2:"T;P;R;BP;PN;",GMRENTY=3:"T;P;R;BP;HT;WT;PN;",1:"")
"RTN","GMRVED0",18,0)
 . I GMRSTR="" S GMRSTR=$S(GMRENTY=4:"T;P;R;BP;WT;PN;",GMRENTY=5:"T;P;R;BP;",GMRENTY=6:"BP;P;",GMRENTY=7:"P;",GMRENTY=8:"WT;",GMRENTY=19:"CG;",GMRENTY=20:"PO2;",GMRENTY=21:"CVP;",1:"")
"RTN","GMRVED0",19,0)
 I GMRENTY=18 S GMRSTR="PN"
"RTN","GMRVED0",20,0)
 Q:GMRSTR=""
"RTN","GMRVED0",21,0)
A3 ;
"RTN","GMRVED0",22,0)
 I "P1p"[GMREDB S GDT=GMRVIDT D EN1^GMRVADM G:GMROUT Q S GMRDT0=GMRVIDT D EN2^GMRVED3 G:GMROUT!(GMREDB="P1") Q D MULTIVM W !! S GMRVIDT=GDT(1) D PATDAT G Q:GMROUT,A3
"RTN","GMRVED0",23,0)
 I "Aa"[GMREDB D EN1^GMRVED2,EN2^GMRVED2 G Q
"RTN","GMRVED0",24,0)
 I "Ss"[GMREDB D EN3^GMRVED6,EN1^GMRVED2,EN2^GMRVED2 G Q
"RTN","GMRVED0",25,0)
 Q
"RTN","GMRVED0",26,0)
EN3 ; CALL IF DFN TO EDIT SINGLE PATIENT VITALS WHERE
"RTN","GMRVED0",27,0)
 ; INPUT : DFN= PT FILE PTR.
"RTN","GMRVED0",28,0)
 ;                  GMRSTR=STRING OF VITALS TO EDIT
"RTN","GMRVED0",29,0)
 ;                  where T=Temp, P=Pulse, R=Resp, B=BP,H=Ht., W=Wt.
"RTN","GMRVED0",30,0)
 ;                  GMRVHLOC=HOSP. LOCATION (PTR TO FILE 44)
"RTN","GMRVED0",31,0)
 ;                  GMRVIDT=DATE/TIME VITALS TAKEN
"RTN","GMRVED0",32,0)
 ; OUPTUT : GMRVIEN(GMRVTY)=120.5 ENTRY^GMRVREAD^GMRVSITE
"RTN","GMRVED0",33,0)
 ;                   where GMRVTY is the vital type see codes above
"RTN","GMRVED0",34,0)
 ;                   GMRVREAD = READING FOR THIS VITAL TYPE
"RTN","GMRVED0",35,0)
 ;                   GMRVSITE = PTR TO GMR VITALS SITE FILE
"RTN","GMRVED0",36,0)
 ;                   GMROUT WILL BE 1 IF ABNORMAL EXIT, ELSE 0
"RTN","GMRVED0",37,0)
 Q:'$D(DFN)!'$D(GMRSTR)!'$D(GMRVIDT)
"RTN","GMRVED0",38,0)
 S GMROUT=0,GMRTMP=1 I GMROUT S GMROUT=$S(GMROUT=2:0,1:1) G Q3
"RTN","GMRVED0",39,0)
 S GMREDB="P1" D A3
"RTN","GMRVED0",40,0)
 Q:$D(GNUROP)
"RTN","GMRVED0",41,0)
Q3 D Q1 K GMREDB,GMRENTY,GMRTMP Q
"RTN","GMRVED0",42,0)
DATE ; CALL TO SET GMRVIDT (WHEN THE VITALS WERE TAKEN)
"RTN","GMRVED0",43,0)
 ; ALSO RETURNS GMROUT=1 IF TIMEOUT OR UPARROW OUT.
"RTN","GMRVED0",44,0)
 S X=U,%DT("A")="ENTER DATE (TIME Required) VITALS WERE TAKEN: ",%DT="XAPETR" D ^%DT K %DT
"RTN","GMRVED0",45,0)
 I Y<0!(X=U) S GMROUT=$S(X=U:1,1:2) Q
"RTN","GMRVED0",46,0)
 D NOW^%DTC I Y>% W !,?3,$C(7),"Cannot enter future dates" G DATE
"RTN","GMRVED0",47,0)
 I Y<$$FMADD^XLFDT(DT,-365) W !,?3,$C(7),"Sorry, you cannot enter a date more than 1 year old." G DATE
"RTN","GMRVED0",48,0)
 S GMRVIDT=Y K POP
"RTN","GMRVED0",49,0)
 Q
"RTN","GMRVED0",50,0)
Q ;
"RTN","GMRVED0",51,0)
 G:$D(GMRTMP) Q1
"RTN","GMRVED0",52,0)
 K GMRVIDT
"RTN","GMRVED0",53,0)
 K ^TMP($J),DFN,GMREDB,GMRENTY,GMROUT,GMRSTR,GMRVHLOC
"RTN","GMRVED0",54,0)
Q1 ;
"RTN","GMRVED0",55,0)
 K %,%T,%DT,%H,DA,DIE,DIC,DQ,DR,GMRDAT,GMRDATE,GMRHELP,GMRI,GMRINPTR,GMRLEN,GMRMSL,GMRNAM,GMRPRMT,GMRRET,GMRRMBD,GMRRMST,GMRROOM,GMRS,GMRSCR,GMRSITE,GMRTO,GMRTY,GMRVIT,GMRVITY,GMRVWLOC,GMRWARD,GMRX,GMRVX,GMRY,POP,GDT,GENTR,GMROK,GMRTMP
"RTN","GMRVED0",56,0)
 D KVAR^VADPT K VA,DIPGM,GMROV,GMRP,GMRTYPE,GMRQUAL,GCT,GDA,GDATA,GLAST,GTYPE,GMRDT0
"RTN","GMRVED0",57,0)
 Q
"RTN","GMRVED0",58,0)
WARDPAT ; SELECT EDIT BY 1. UNIT, 2. SELECTED ROOMS ON UNIT, 3. PATIENT
"RTN","GMRVED0",59,0)
 W !,"Vitals by (A)ll patients on a unit, (S)elected Rooms on unit, or (P)atient? " R GMREDB:DTIME S:'$T GMREDB=U I U[GMREDB S GMROUT=1 Q
"RTN","GMRVED0",60,0)
 I "Aa"[GMREDB!("Ss"[GMREDB)!("P1p"[GMREDB) G WP1
"RTN","GMRVED0",61,0)
 I GMREDB?1"?".E S XQH="GMRV WARD/PAT SEL" D EN^XQH K XQH G WARDPAT
"RTN","GMRVED0",62,0)
 W !,$C(7),?5,"INVALID ENTRY ??" G WARDPAT
"RTN","GMRVED0",63,0)
WP1 ;
"RTN","GMRVED0",64,0)
 I "Aa"[GMREDB!("Ss"[GMREDB) D WARDSEL Q:GMROUT  Q:"Ss"'[GMREDB!("Ss"[GMREDB&$D(^DG(405.4,"W",GMRWARD)))  S XQH="GMRV NO ROOM" D EN^XQH K XQH G WARDPAT
"RTN","GMRVED0",65,0)
 D PATDAT
"RTN","GMRVED0",66,0)
 Q
"RTN","GMRVED0",67,0)
WARDSEL ; SELECT SEARCH WARD
"RTN","GMRVED0",68,0)
 S DIC="^DIC(42,",DIC(0)="AEQMZ",DIC("S")="I '$$INACT42^GMRVUT2(+Y)"
"RTN","GMRVED0",69,0)
 D ^DIC K DIC I X=U!(+Y'>0) S GMROUT=1 Q
"RTN","GMRVED0",70,0)
 S GMRWARD=+Y,GMRWARD(1)=$P(Y(0),U),DFN=$O(^DPT("CN",GMRWARD(1),0))
"RTN","GMRVED0",71,0)
 I DFN="" W !,*7,"**** NO PATIENTS REGISTERED ON UNIT ",$P(^DIC(42,GMRWARD,0),U)," ****" S GMROUT=1 Q
"RTN","GMRVED0",72,0)
 S GMRVHLOC=$S($D(^DIC(42,GMRWARD,44)):$P(^(44),U),1:"")
"RTN","GMRVED0",73,0)
 Q
"RTN","GMRVED0",74,0)
PATDAT ;
"RTN","GMRVED0",75,0)
 S DIC(0)="AEQMZ",DIC="^DPT(" D ^DIC K DIC S DFN=+Y
"RTN","GMRVED0",76,0)
 I DFN'>0 S GMROUT=1 Q
"RTN","GMRVED0",77,0)
 D INP^VADPT S GMRWARD(1)=$P(VAIN(4),U,2),GMRWARD=$P(VAIN(4),U) D KVAR^VADPT K VA
"RTN","GMRVED0",78,0)
 I ('$D(GMRWARD)!(GMRWARD'>0)),"P1p"[GMREDB,$D(GMRVIDT) S GENTR=2,GDT=GMRVIDT D ADM^GMRVADM Q:GMROUT  S:GMRWARD=0 GMROUT=1 Q:GMROUT
"RTN","GMRVED0",79,0)
 Q:'GMRVWLOC
"RTN","GMRVED0",80,0)
 S DIC("A")="Select Hospital Location: ",DIC("B")=$S('$D(^DIC(42,+GMRWARD,44)):"",$D(^SC(+$P(^DIC(42,+GMRWARD,44),U),0)):$P(^(0),U),1:""),DIC=44,DIC(0)="AEMQ",DIC("S")="I $P(^(0),U,3)'=""Z""" D ^DIC K DIC
"RTN","GMRVED0",81,0)
 I +Y'>0 W !,"Hospital location is required",! S GMROUT=1 Q
"RTN","GMRVED0",82,0)
 S GMRVHLOC=+Y Q
"RTN","GMRVED0",83,0)
MULTIVM Q:GMROUT  W !!,"Do you want to enter other V/M data for this patient" S %=2 D YN^DICN W:%=0 !!,"Select YES if you want to enter another V/M record at a different",!,"date/time for the same patient.",! G:%=0 MULTIVM Q:%'=1
"RTN","GMRVED0",84,0)
 D DATE I 'GMROUT S GMRDT0=GMRVIDT D EN2^GMRVED3 G MULTIVM
"RTN","GMRVED0",85,0)
 S GMROUT=0 Q
"RTN","GMRVED3")
0^9^B40309323
"RTN","GMRVED3",1,0)
GMRVED3 ;HIRMFO/YH,FT-VITAL SIGNS EDIT SHORT FORM (cont.) ;6/28/01  14:42
"RTN","GMRVED3",2,0)
 ;;4.0;Vitals/Measurements;**1,5,6,7,11,13**;Apr 25, 1997
"RTN","GMRVED3",3,0)
EN2 ;VITAL ENTRY FOR A PATIENT
"RTN","GMRVED3",4,0)
 D EN2^GMRVED1 G:GMROUT NEXT D EN4^GMRVED2 S GMROK=0
"RTN","GMRVED3",5,0)
NEXT I '(GMRENTY=5!(GMRENTY=6)!(GMRENTY=9))!GMROUT S GMRVIDT=GMRDT0 Q
"RTN","GMRVED3",6,0)
 I $G(GMROUT(1))=1 S GMROUT(1)=0 S GMRVIDT=GMRDT0 Q
"RTN","GMRVED3",7,0)
 I GMRSTR'["BP" S GMRVIDT=GMRDT0 Q
"RTN","GMRVED3",8,0)
 S:'$D(GPRMT)&($D(GMRPRMT)) GPRMT="("_$P(GMRPRMT,":")_" continued )" S GPRMT(1)=GMRSTR
"RTN","GMRVED3",9,0)
 I '$D(^GMR(120.5,"AA",DFN,1,9999999-GMRVIDT)) S:GMRENTY=5 GMRSTR="T;P;R;BP;" S:GMRENTY=6 GMRSTR="BP;P;" S:GMRENTY=10 GMRSTR="T;P;R;BP;HT;WT;" S GMRVIDT=GMRDT0 S:GMRENTY=9 GMRSTR=GPRMT(1) K GPRMT,GBP Q
"RTN","GMRVED3",10,0)
ASK I '$D(GMRSITE("BP"))&'$D(GMRINF("BP")) S:GMRENTY=9 GMRSTR=GPRMT(1) K GPRMT Q
"RTN","GMRVED3",11,0)
  W !,"Enter another B/P? NO// " R GMRX:DTIME S:'$T GMRTO=1 I '$T!(GMRX="^") S GMROUT=1,GMRVIDT=GMRDT0 S:GMRENTY=9 GMRSTR=GPRMT(1) K GBP,GPRMT Q
"RTN","GMRVED3",12,0)
 I GMRX=""!("Nn"[GMRX) S GMRVIDT=GDT S:GMRENTY=5 GMRSTR="T;P;R;BP;" S:GMRENTY=10 GMRSTR="T;P;R;BP;HT;WT;" S GMRVIDT=GMRDT0 S:GMRENTY=9 GMRSTR=GPRMT(1) K GPRMT Q
"RTN","GMRVED3",13,0)
 I GMRX["Y"!(GMRX["y") S GMRSTR=$S(GMRENTY=5!(GMRENTY=6):"BP;P;",1:"BP;"),GMRVIDT=GMRDT0 W @IOF,GPRMT D DSPOV^GMRVED4 D SETBP S GLAST=GLAST+.00000001,GMRVIDT=GLAST G EN2
"RTN","GMRVED3",14,0)
 W !,"ANSWER YES OR NO, maximum 6 B/Ps ",*7 G ASK
"RTN","GMRVED3",15,0)
SETBP ;
"RTN","GMRVED3",16,0)
 N I S I=0 F  S I=$O(GMROV("BP",I)) Q:I'>0  I $P(GMROV("BP",I),"^",2)'="" S GBP($P(GMROV("BP",I),"^",2))=""
"RTN","GMRVED3",17,0)
 Q
"RTN","GMRVED3",18,0)
CHKDAT ;CHECK V/M ENTRY DATA
"RTN","GMRVED3",19,0)
 S GMRVITY=$P(GMRSTR(0),";",GMRX),GMRVIT=+$O(^GMRD(120.51,"C",GMRVITY,"")),GMRVIT(1)=$S($D(^GMRD(120.51,GMRVIT,0)):$P(^(0),"^"),1:""),GMRO2(GMRVITY)=""
"RTN","GMRVED3",20,0)
 F GMRY=0:0 S GMRY=$O(^GMR(120.5,"AA",DFN,GMRVIT,9999999-GMRVIDT,GMRY)) Q:GMRY'>0  I $S('$D(^GMR(120.5,GMRY,2)):1,$P(^(2),"^"):0,1:1) D
"RTN","GMRVED3",21,0)
 . I GMRENTY=21,"Nn"'[GMRDAT D WDUP S GMRDAT="" Q
"RTN","GMRVED3",22,0)
 . D:"Nn"'[$P(GMRDAT,"-",GMRX-1) WDUP S $P(GMRDAT,"-",GMRX-1)="" Q
"RTN","GMRVED3",23,0)
 S GMRINPTR=$S($D(^GMRD(120.51,GMRVIT,1)):^(1),1:"K:X'?.NP X")
"RTN","GMRVED3",24,0)
INPTR ;
"RTN","GMRVED3",25,0)
 Q:GMROUT  S X=$S(GMRENTY=21:GMRDAT,1:$P(GMRDAT,"-",GMRX-1))
"RTN","GMRVED3",26,0)
 I X="n"!(X="N")!(X="") S (GMRDAT(GMRVITY),GMRSITE(GMRVITY),GMRINF(GMRVITY))="" Q
"RTN","GMRVED3",27,0)
 I "UNAVAILABLEPASSREFUSED"[$$UP^XLFSTR(X) S GMRSITE(GMRVITY)="",GMRINF(GMRVITY)="",GMRDAT(GMRVITY)=X Q
"RTN","GMRVED3",28,0)
INPTR1 ;
"RTN","GMRVED3",29,0)
 I GMRVITY="PO2" G:$L(X)>10 A G:+X>100 A D O2^GMRVUT3
"RTN","GMRVED3",30,0)
 I GMRVITY="HT" G:'$$HTCHK(X) A S X=$$UP^XLFSTR(X),GMRSITE=$P(X,",",2),X=$P(X,",") D
"RTN","GMRVED3",31,0)
 .I GMRSITE="" S:X["E" GMRSITE=$E(X,$F(X,"E")-1),X=$P(X,"E") S:X["A" GMRSITE=$E(X,$F(X,"A")-1),X=$P(X,"A")
"RTN","GMRVED3",32,0)
 .S:GMRSITE="" GMRSITE="A"
"RTN","GMRVED3",33,0)
 .D TPSITE^GMRVUT1
"RTN","GMRVED3",34,0)
 .Q
"RTN","GMRVED3",35,0)
 I GMRVITY="PN" S GMRDAT("PN")=+X,GMRSITE("PN")=""
"RTN","GMRVED3",36,0)
 I GMRVITY="WT" G:$L(X)>10 A G:+X>1500 A S GMRSITE=$P(X,+X,2) G:GMRSITE=""!("LlKk"'[$E(GMRSITE)) A K GMRSITE(GMRVITY),GMRINF(GMRVITY) D WTYPE^GMRVUT1
"RTN","GMRVED3",37,0)
 I GMRVITY="CG" K GMRSITE(GMRVITY),GMRINF(GMRVITY) S GLVL=8 D LISTQ^GMRVQUAL,OTHERQ^GMRVQUAL,CLEAR^GMRVQUAL
"RTN","GMRVED3",38,0)
 I GMRVITY="BP",GMRENTY<5,$L(X,"/")=1 G A
"RTN","GMRVED3",39,0)
 I GMRVITY="BP" N GMRDP D
"RTN","GMRVED3",40,0)
 .S X=$$UP^XLFSTR(X)
"RTN","GMRVED3",41,0)
 .Q:X'["/"
"RTN","GMRVED3",42,0)
 .S:$P(X,"/",2)="" GMRSITE="PA",GMRDP=1
"RTN","GMRVED3",43,0)
 .S:$P(X,"/",2)="D" GMRSITE="D",X=$P(X,"/")_"/",GMRDP=1
"RTN","GMRVED3",44,0)
 .S:$P(X,"/",2)="P" GMRSITE="PA",X=$P(X,"/")_"/",GMRDP=1
"RTN","GMRVED3",45,0)
 .D:$D(GMRDP)&(GMRENTY<5) TPSITE^GMRVUT1
"RTN","GMRVED3",46,0)
 .Q
"RTN","GMRVED3",47,0)
 I GMRVITY="T"!(GMRVITY="P")!(GMRVITY="BP"&(GMRENTY>4))!(GMRVITY="R")!(GMRVITY="PO2") D SITE I '$D(X) G A
"RTN","GMRVED3",48,0)
 X GMRINPTR I $D(X)#2 S GMRDAT(GMRVITY)=X Q
"RTN","GMRVED3",49,0)
A W !,?5,$C(7),"Invalid ",GMRVIT(1)," entry"
"RTN","GMRVED3",50,0)
A1 W !,GMRVIT(1)_": " R GMRRET:DTIME
"RTN","GMRVED3",51,0)
 S:'$T GMRTO=1 I GMRRET="^"!'$T S GMROUT=1 G INPTR
"RTN","GMRVED3",52,0)
 I GMRRET="N"!(GMRRET="n") S (X,GMRRET)="" Q
"RTN","GMRVED3",53,0)
 I GMRRET'["?" S X=GMRRET G INPTR1
"RTN","GMRVED3",54,0)
 I GMRRET?1"?".E S XQH="GMRV-"_$S(GMRVITY="CG":"CIRCUM/GIRTH",GMRVITY="PO2":"PO2",GMRVITY="CVP":"CVP",1:GMRVIT(1))_" RATE HELP" D EN^XQH K XQH
"RTN","GMRVED3",55,0)
 G A1
"RTN","GMRVED3",56,0)
WDUP ;
"RTN","GMRVED3",57,0)
 W $C(7),!,?4,GMRVIT(1)_" data already exists for this patient on this date/time.",!,?4,"To change this data use the enter a vital/measurement in error option.",!
"RTN","GMRVED3",58,0)
 Q
"RTN","GMRVED3",59,0)
SITE ;
"RTN","GMRVED3",60,0)
 I GMRVITY'="BP" S GMRSITE=$P(X,+X,2),X=+X S GMRSITE=$$UP^XLFSTR(GMRSITE) I GMRVITY="T"!(GMRVITY="P")!(GMRVITY="R") D TPSITE^GMRVUT1 Q
"RTN","GMRVED3",61,0)
 Q:GMRVITY'="BP"
"RTN","GMRVED3",62,0)
 I GMRVITY="BP" S GLVL=8 D LISTQ^GMRVQUAL N GMRIN D:$D(GMRDP) CHKBP D OTHERQ^GMRVQUAL,CLEAR^GMRVQUAL
"RTN","GMRVED3",63,0)
 I $L(X,"/")=1!($L(X,"/")=2&($P(X,"/",2)="")) D
"RTN","GMRVED3",64,0)
 . I '$D(GMRINF("BP")) W !,"Missing diastolic data!",! K X D BP^GMRVUT1 W ! Q
"RTN","GMRVED3",65,0)
 . N II S (II,II(0))=0 F  S II=$O(GMRINF("BP",II)) Q:II'>0  D
"RTN","GMRVED3",66,0)
 . . I $D(GMRINF("BP",II,"PALPATED")) S II(0)=1 Q
"RTN","GMRVED3",67,0)
 . . I $D(GMRINF("BP",II,"DOPPLER")) S II(0)=1
"RTN","GMRVED3",68,0)
 . I II(0)=0 W !,"Missing diastolic data!",! K X D BP^GMRVUT1 W !
"RTN","GMRVED3",69,0)
 Q
"RTN","GMRVED3",70,0)
CHKBP ; Check for Method of BP for Systolic Value only
"RTN","GMRVED3",71,0)
 N GMRVOK S (GMRVODR,GMRVOK)=0 F  S GMRVODR=$O(GCOUNT(GMRVODR)) Q:GMRVODR<1  D  Q:GMRVOK
"RTN","GMRVED3",72,0)
 .S GCAT="" F  S GCAT=$O(GCOUNT(GMRVODR,GCAT)) Q:GCAT=""  D  Q:GMRVOK
"RTN","GMRVED3",73,0)
 ..I GCAT["METHOD" S GMRVOK=1 Q
"RTN","GMRVED3",74,0)
 ..Q
"RTN","GMRVED3",75,0)
 .Q
"RTN","GMRVED3",76,0)
 Q:'GMRVOK
"RTN","GMRVED3",77,0)
 Q:'GMRVODR
"RTN","GMRVED3",78,0)
 K GCOUNT(GMRVODR),GQUAL(GMRVODR),GMRLAST(GMRVODR),GORDER(GMRVODR)
"RTN","GMRVED3",79,0)
 N GMRCI,GMRCJ,GMRCX
"RTN","GMRVED3",80,0)
 S GMRCX=$S(GMRSITE="D":"DOPPLER",1:"PALPATED")
"RTN","GMRVED3",81,0)
 F GMRCI=0:0 S GMRCI=$O(GCHART(GMRCI)) Q:GMRCI<1  I $P(GCHART(GMRCI),"^")=GMRCX S GMRCJ=$P(GCHART(GMRCI),"^",2,3) Q
"RTN","GMRVED3",82,0)
 S:$G(GMRCJ)'="" GMRIN(GMRVODR,GMRCX)=GMRCJ
"RTN","GMRVED3",83,0)
 D RESET(GMRVODR,0,.GCOUNT)
"RTN","GMRVED3",84,0)
 D RESET(GMRVODR,0,.GQUAL)
"RTN","GMRVED3",85,0)
 D RESET(GMRVODR,0,.GMRLAST)
"RTN","GMRVED3",86,0)
 D RESET(GMRVODR,0,.GORDER)
"RTN","GMRVED3",87,0)
 D RESET(GMRVODR,1,.GCHART)
"RTN","GMRVED3",88,0)
 D RESET(GMRVODR,1,.GCHART1)
"RTN","GMRVED3",89,0)
 S (GMRCI,GMRCJ,GMRCX)=0 F  S GMRCI=$O(GCHART(GMRCI)) Q:GMRCI<1  D
"RTN","GMRVED3",90,0)
 .S:GMRCX=0 GMRCX=$P(GCHART(GMRCI),"^",3)
"RTN","GMRVED3",91,0)
 .I GMRCX=$P(GCHART(GMRCI),"^",3) S GMRCJ=GMRCJ+1 Q
"RTN","GMRVED3",92,0)
 .I GMRCX'=$P(GCHART(GMRCI),"^",3) D
"RTN","GMRVED3",93,0)
 ..S GCAT=$O(GMRLAST(GMRCX,"")),GMRLAST(GMRCX,GCAT)=GMRCJ
"RTN","GMRVED3",94,0)
 ..S GMRCX=$P(GCHART(GMRCI),"^",3),GMRCJ=GMRCJ+1 Q
"RTN","GMRVED3",95,0)
 .Q
"RTN","GMRVED3",96,0)
 I GMRCX S GCAT=$O(GMRLAST(GMRCX,"")),GMRLAST(GMRCX,GCAT)=GMRCJ
"RTN","GMRVED3",97,0)
 Q
"RTN","GMRVED3",98,0)
RESET(GMRVOD,GMRVFLG,GMY) ; Reset GMY after removal of METHOD
"RTN","GMRVED3",99,0)
 N GMRCI,GMRCJ,GMY1,GMRCX
"RTN","GMRVED3",100,0)
 I GMRVFLG D  Q
"RTN","GMRVED3",101,0)
 .S GMRCJ=0
"RTN","GMRVED3",102,0)
 .F GMRCI=0:0 S GMRCI=$O(GMY(GMRCI)) Q:GMRCI<1  S GMRCX=$G(GMY(GMRCI)) I $P(GMRCX,"^",3)'=GMRVOD S GMRCJ=GMRCJ+1,GMY1(GMRCJ)=GMRCX S:$P(GMRCX,"^",3)>GMRVOD $P(GMY1(GMRCJ),"^",3)=$P(GMY1(GMRCJ),"^",3)-1
"RTN","GMRVED3",103,0)
 .K GMY F GMRCI=0:0 S GMRCI=$O(GMY1(GMRCI)) Q:GMRCI<1  S GMRCX=$G(GMY1(GMRCI)),GMY(GMRCI)=GMRCX
"RTN","GMRVED3",104,0)
 .Q
"RTN","GMRVED3",105,0)
 F GMRVOD=GMRVOD:0 S GMRVOD=$O(GMY(GMRVOD)) Q:GMRVOD<1  D
"RTN","GMRVED3",106,0)
 .S GMRCI=$O(GMY(GMRVOD,"")) I GMRCI="" S GMY(GMRVOD-1)=$G(GMY(GMRVOD)) K GMY(GMRVOD) Q
"RTN","GMRVED3",107,0)
 .S GCAT="" F  S GCAT=$O(GMY(GMRVOD,GCAT)) Q:GCAT=""  D
"RTN","GMRVED3",108,0)
 ..S GMY(GMRVOD-1,GCAT)=$G(GMY(GMRVOD,GCAT))
"RTN","GMRVED3",109,0)
 ..K GMY(GMRVOD,GCAT)
"RTN","GMRVED3",110,0)
 ..Q
"RTN","GMRVED3",111,0)
 .Q
"RTN","GMRVED3",112,0)
 Q
"RTN","GMRVED3",113,0)
HTCHK(X) ; Check ' and " symbols in height entry
"RTN","GMRVED3",114,0)
 ;  input - X (the height entry)
"RTN","GMRVED3",115,0)
 ; output - 0 means there is a problem with the single or double quotes
"RTN","GMRVED3",116,0)
 ;          1 means the single and double quotes are fine 
"RTN","GMRVED3",117,0)
 I X'["""",X'["'" Q 1  ;quit if ' and " are not in X
"RTN","GMRVED3",118,0)
 I $L(X,"'")>2!($L(X,"""")>2) Q 0  ;quit if more than 1 ' or "
"RTN","GMRVED3",119,0)
 N GMRVSQ,GMRVDQ
"RTN","GMRVED3",120,0)
 S GMRVSQ=$F(X,"'") ;find location of single quote in X
"RTN","GMRVED3",121,0)
 S GMRVDQ=$F(X,"""") ;find location of double quote in X
"RTN","GMRVED3",122,0)
 I GMRVDQ>0,GMRVDQ<GMRVSQ Q 0  ;quit if " is before '
"RTN","GMRVED3",123,0)
 I GMRVSQ>0,GMRVDQ>0,$E(X,GMRVSQ)="""" Q 0  ;quit if '" combination
"RTN","GMRVED3",124,0)
 Q 1
"RTN","GMRVED3",125,0)
 ;
"RTN","GMRVLWT1")
0^4^B12358242
"RTN","GMRVLWT1",1,0)
GMRVLWT1 ;HIRMFO/YH,FT-DOT MATRIX PATIENT WEIGHT GRAPH - 2 ;6/13/01  15:00
"RTN","GMRVLWT1",2,0)
 ;;4.0;Vitals/Measurements;**1,13**;Apr 25, 1997
"RTN","GMRVLWT1",3,0)
 ;
"RTN","GMRVLWT1",4,0)
 ; This routine uses the following IAs:
"RTN","GMRVLWT1",5,0)
 ; #10061  ^VADPT calls     (supported)
"RTN","GMRVLWT1",6,0)
 ;
"RTN","GMRVLWT1",7,0)
VAF ;WEIGHT GRAPH
"RTN","GMRVLWT1",8,0)
 D DEM^VADPT,INP^VADPT S GMRBTH=$P(VADM(3),"^",2),GMRNAM=VADM(1)
"RTN","GMRVLWT1",9,0)
 F GMRK="W","H" D GMRDT
"RTN","GMRVLWT1",10,0)
 S (GMRTNM,GMRI)=0 I $D(^TMP($J,"GMRDT")) F  S GMRI=$O(^TMP($J,"GMRDT",GMRI)) Q:GMRI'>0  S GMRTNM=GMRTNM+1
"RTN","GMRVLWT1",11,0)
 D GRAPH K GMR3,GMRDAT,GMREN,GMRHDR1,GMRHDR11,GMRHDR10,GMRHDR2,GMRHT,GMRI,GMRJ,GMRK,GMRLINE,GDATA,GMROLD,GMRW,GMRWDIF,GMRPG,GMRPGC,GMRPGS,GMRWHI,GMRWLO,GMRWOFF,GMRSITE,GMRTNM
"RTN","GMRVLWT1",12,0)
 K GMRWT,GLPRNTR,GMRTY,GMRNM,GMRVX,GMRVX1,GMRVX2,^TMP($J,"GMRDT"),^TMP($J,"GMRG"),^TMP($J,"GMRVG")
"RTN","GMRVLWT1",13,0)
 Q
"RTN","GMRVLWT1",14,0)
GRAPH ;
"RTN","GMRVLWT1",15,0)
 S:'$D(GFLAG) GFLAG=0 S GMRPGC=0,GMRX1="" F X=1:1:10 S GMRX1=GMRX1_"          "_"|"
"RTN","GMRVLWT1",16,0)
 S (GMRX,GMRX2)=GMRX1 F X=1:1:10 S $P(GMRX,"|",X)="__________",$P(GMRX2,"|",X)="----------"
"RTN","GMRVLWT1",17,0)
 S GMRPG=$S(GMRTNM=0:1,1:GMRTNM\10+$S(GMRTNM#10>0:1,1:0)) F GMRPGS=1:1:GMRPG S GMRWT=$G(GWT(1))+14.165,GMRWT(1)=9,GMRWT(2)=1 D PAGE Q:GMROUT  ;GMRWT = WEIGHT VALUE WHEN $Y=1
"RTN","GMRVLWT1",18,0)
 Q
"RTN","GMRVLWT1",19,0)
PAGE ;
"RTN","GMRVLWT1",20,0)
 K GMRQUAL W:'($E(IOST)'="C"&'GFLAG) @IOF S GFLAG=1,GMRPGC=GMRPGC+1 W !
"RTN","GMRVLWT1",21,0)
 I '$D(^TMP($J,"GMRVG")) W !!!!!!!!,?5,"THERE  IS  NO  DATA  FOR  THIS  PERIOD" X "F Y=$Y:1:(IOSL-6) W !" D FOOTER^GMRVLWT3 Q
"RTN","GMRVLWT1",22,0)
 W ! D DATES^GMRVVS2 W !,?6,"Pounds/Kgs",?17,"|",?18,GMRX
"RTN","GMRVLWT1",23,0)
 F GMRI=0:0 Q:$Y>55  W ! D SETHD^GMRVLWT2 W ?5,GMRHDR10,?16,$S(GMR3:"-",1:""),?17,"|" D DATAPRT^GMRVLWT2
"RTN","GMRVLWT1",24,0)
 W !,?17,"|",GMRX2 F GMRI="W","W1","WQUAL","H","H1","HQUAL","BMI" S GMRLINE(GMRI)=GMRX1
"RTN","GMRVLWT1",25,0)
 S GMRNM=0 F GMRDT=0:0 S GMRDT=$O(^TMP($J,"GMRDT",GMRDT)) Q:GMRDT'>0  S GMRNM=GMRNM+1 Q:GMRNM>10  F GMRI="W","H" D:$D(^TMP($J,"GMRVG",GMRI,GMRDT)) STLNP^GMRVLWT3
"RTN","GMRVLWT1",26,0)
 F GMRI="W","W1","WQUAL","BMI","H","H1","HQUAL" D
"RTN","GMRVLWT1",27,0)
 .S G=$S(GMRI="W":"Weight (lb)",GMRI="W1":"       (kg)",GMRI="WQUAL":"Qualifier",GMRI="H":"Height (in)",GMRI="H1":"       (cm)",GMRI="HQUAL":"Qualifier",GMRI="BMI":"Body Mass Index",1:"")
"RTN","GMRVLWT1",28,0)
 . W !,G,?17,"|",GMRLINE(GMRI)
"RTN","GMRVLWT1",29,0)
 I 'GMROUT W !,?17,$$REPEAT^XLFSTR("-",111)
"RTN","GMRVLWT1",30,0)
 W !,"W: Weight     ** - Abnormal value off of graph"
"RTN","GMRVLWT1",31,0)
 W ! I $D(GMRQUAL) S GLPRNTR=1 D LEGEND^GMRVLGQU F I=1:1:5 W !,GLINE(I)
"RTN","GMRVLWT1",32,0)
 I IOSL'<($Y+10) F X=1:1 W ! Q:IOSL<($Y+10)
"RTN","GMRVLWT1",33,0)
 D FOOTER^GMRVLWT3 S GMRDT="" F GMRNM=1:1:10 S GMRDT=$O(^TMP($J,"GMRDT",GMRDT)) Q:GMRDT'>0  K ^TMP($J,"GMRDT",GMRDT)
"RTN","GMRVLWT1",34,0)
 K GG,GI,GMRVJ,GSYNO Q
"RTN","GMRVLWT1",35,0)
GMRDT S GMRTNM(GMRK)=0 F GMRI=0:0 S GMRI=$O(^TMP($J,"GMRVG",GMRK,GMRI)) Q:GMRI'>0  S GMRJ="" F X=0:0 S GMRJ=$O(^TMP($J,"GMRVG",GMRK,GMRI,GMRJ)) Q:GMRJ=""  S GMRTNM(GMRK)=GMRTNM(GMRK)+1 S:GMRK'="XI1" ^TMP($J,"GMRDT",GMRI)=""
"RTN","GMRVLWT1",36,0)
 Q
"RTN","GMRVPCE3")
0^5^B10718450
"RTN","GMRVPCE3",1,0)
GMRVPCE3 ;HIRMFO/RM,FT-V/M Data Validation for AICS ;6/13/01  11:24
"RTN","GMRVPCE3",2,0)
 ;;4.0;Vitals/Measurements;**8,13**;Apr 25, 1997
"RTN","GMRVPCE3",3,0)
VALID(TYPE,X) ; This function returns 1 if rate (X) is valid for
"RTN","GMRVPCE3",4,0)
 ; measurement type (TYPE).
"RTN","GMRVPCE3",5,0)
 N FXN S FXN=0
"RTN","GMRVPCE3",6,0)
 I TYPE="VU" S TYPE="VC"
"RTN","GMRVPCE3",7,0)
 D @TYPE I $D(X) S FXN=1
"RTN","GMRVPCE3",8,0)
 Q FXN
"RTN","GMRVPCE3",9,0)
AG ; INPUT TRANSFORM FOR ABDOMINAL GIRTH
"RTN","GMRVPCE3",10,0)
 N UNIT S UNIT=$$UP^XLFSTR($P(X,+X,2,10)) I UNIT="" K X Q
"RTN","GMRVPCE3",11,0)
 S X=+X
"RTN","GMRVPCE3",12,0)
 I $E(UNIT)="C"&("CM"[UNIT) S X=$$CMTOIN(+X,0),UNIT="IN"
"RTN","GMRVPCE3",13,0)
 I $E(UNIT)="I"&("IN"[UNIT) K:+X'=X!(X>150)!(X<0)!(X?.E1"."1N.N) X
"RTN","GMRVPCE3",14,0)
 E  K X
"RTN","GMRVPCE3",15,0)
 Q
"RTN","GMRVPCE3",16,0)
AUD ; INPUT TRANSFORM FOR AUDIOMETRY.
"RTN","GMRVPCE3",17,0)
 N I,R,L
"RTN","GMRVPCE3",18,0)
 K:X'?.N1"/".N1"/".N1"/".N1"/".N1"/".N1"/".N1"/".N1"/".N1"/".N1"/".N1"/".N1"/".N1"/".N1"/".N1"/".N1"/" X
"RTN","GMRVPCE3",19,0)
 I $D(X) F I=1:1:8 S R=$P(X,"/",I) I R]"" K:+R'=R!(R>110)!(R<0) X
"RTN","GMRVPCE3",20,0)
 I $D(X) F I=9:1:16 S L=$P(X,"/",I) I L]"" K:+L'=L!(L>110)!(L<0) X
"RTN","GMRVPCE3",21,0)
 Q
"RTN","GMRVPCE3",22,0)
BP ; INPUT TRANSFORM FOR BLOOD PRESSURE
"RTN","GMRVPCE3",23,0)
 K:X'?2.3N1"/"2.3N1"/"2.3N&(X'?2.3N1"/"2.3N) X I $D(X) K:$P(X,"/",1)>300!($P(X,"/",2)>300)!(+$P(X,"/",3)>300) X
"RTN","GMRVPCE3",24,0)
 I $D(X),$P(X,"/")'>$P(X,"/",$L(X,"/")) K X
"RTN","GMRVPCE3",25,0)
 Q
"RTN","GMRVPCE3",26,0)
FH ; INPUT TRANSFORM FOR FUNDAL HEIGHT
"RTN","GMRVPCE3",27,0)
 N UNIT S UNIT=$$UP^XLFSTR($P(X,+X,2,10)) I UNIT="" K X Q
"RTN","GMRVPCE3",28,0)
 S X=+X
"RTN","GMRVPCE3",29,0)
 I $E(UNIT)="C"&("CM"[UNIT) S X=$$CMTOIN(+X,0),UNIT="IN"
"RTN","GMRVPCE3",30,0)
 I $E(UNIT)="I"&("IN"[UNIT) K:+X'=X!(X>50)!(X<10)!(X?.E1"."1N.N) X
"RTN","GMRVPCE3",31,0)
 E  K X
"RTN","GMRVPCE3",32,0)
 Q
"RTN","GMRVPCE3",33,0)
FT ; INPUT TRANSFORM FOR FETAL HEART TONES
"RTN","GMRVPCE3",34,0)
 K:+X'=X!(X>250)!(X<50)!(X?.E1"."1N.N) X
"RTN","GMRVPCE3",35,0)
 Q
"RTN","GMRVPCE3",36,0)
HC ; INPUT TRANSFORM FOR HEAD CIRCUMFERENCE
"RTN","GMRVPCE3",37,0)
 N UNIT S UNIT=$$UP^XLFSTR($P(X,+X,2,10)) I UNIT="" K X Q
"RTN","GMRVPCE3",38,0)
 I $E(UNIT)="C"&("CM"[UNIT) D  Q
"RTN","GMRVPCE3",39,0)
 .  K:+X>76!(+X<26)!(+X?.E1"."3N.N) X
"RTN","GMRVPCE3",40,0)
 .  I $D(X) S X=$J(.3937*(+X),0,2)
"RTN","GMRVPCE3",41,0)
 .  Q
"RTN","GMRVPCE3",42,0)
 I $E(UNIT)="I" D  Q
"RTN","GMRVPCE3",43,0)
 .  K:+X>30!(+X<10)!(+X?.E1"."4N.N) X
"RTN","GMRVPCE3",44,0)
 .  I $D(X),+X?.E1"."1N.N D
"RTN","GMRVPCE3",45,0)
 .  .  N F S F=$P(+X,".",2)
"RTN","GMRVPCE3",46,0)
 .  .  K:"^125^25^375^5^625^75^875^"'[("^"_F_"^") X
"RTN","GMRVPCE3",47,0)
 .  .  Q
"RTN","GMRVPCE3",48,0)
 .  I $D(X) S X=+X
"RTN","GMRVPCE3",49,0)
 .  Q
"RTN","GMRVPCE3",50,0)
 K X
"RTN","GMRVPCE3",51,0)
 Q
"RTN","GMRVPCE3",52,0)
HE ; INPUT TRANSFORM FOR HEARING
"RTN","GMRVPCE3",53,0)
 K:"^N^A^"'[("^"_$$UP^XLFSTR(X)_"^") X
"RTN","GMRVPCE3",54,0)
 Q
"RTN","GMRVPCE3",55,0)
HT ; INPUT TRANSFORM FOR HEIGHT
"RTN","GMRVPCE3",56,0)
 D EN3^GMRVUT0 K:X=0!(X>100)!(X<1) X
"RTN","GMRVPCE3",57,0)
 Q
"RTN","GMRVPCE3",58,0)
PU ; INPUT TRANSFORM FOR PULSE
"RTN","GMRVPCE3",59,0)
 K:+X'=X!(X>300)!(X<0)!(X?.E1"."1N.N) X
"RTN","GMRVPCE3",60,0)
 Q
"RTN","GMRVPCE3",61,0)
RS ; INPUT TRANSFORM FOR RESPIRATION
"RTN","GMRVPCE3",62,0)
 K:+X'=X!(X>100)!(X<0)!(X?.E1"."1N.N) X
"RTN","GMRVPCE3",63,0)
 Q
"RTN","GMRVPCE3",64,0)
TON ; INPUT TRANSFORM FOR TONOMETRY
"RTN","GMRVPCE3",65,0)
 N R,L
"RTN","GMRVPCE3",66,0)
 K:X'?.N1"/"1N.N&(X'?1N.N1"/".N) X
"RTN","GMRVPCE3",67,0)
 I $D(X) S R=$P(X,"/") I R]"" K:R'=+R!(R>80)!(R<0) X
"RTN","GMRVPCE3",68,0)
 I $D(X) S L=$P(X,"/",2) I L]"" K:L'=+L!(L>80)!(L<0) X
"RTN","GMRVPCE3",69,0)
 Q
"RTN","GMRVPCE3",70,0)
TMP ; INPUT TRANSFORM FOR TEMPERATURE
"RTN","GMRVPCE3",71,0)
 K:+X'=X!(X>120)!(X<0)!(X?.E1"."3N.N) X I $D(X) S:X<45 X=$J(+X*(9/5)+32,0,1)
"RTN","GMRVPCE3",72,0)
 Q
"RTN","GMRVPCE3",73,0)
VC ; INPUT TRANSFORM FOR VISION CORRECTED (AND VISION UNCORRECTED)
"RTN","GMRVPCE3",74,0)
 N R,L
"RTN","GMRVPCE3",75,0)
 K:X'=+X&(X'?.N1"/"1N.N) X
"RTN","GMRVPCE3",76,0)
 I $D(X) S R=$P(X,"/") I R]"" K:R'=+R!(R>999)!(R<10) X
"RTN","GMRVPCE3",77,0)
 I $D(X) S L=$P(X,"/",2) I L]"" K:L'=+L!(L>999)!(L<10) X
"RTN","GMRVPCE3",78,0)
 Q
"RTN","GMRVPCE3",79,0)
WT ; INPUT TRANSFORM FOR WEIGHT
"RTN","GMRVPCE3",80,0)
 I $L(X)>10 K X Q
"RTN","GMRVPCE3",81,0)
 S GMR=$E($P(X,+X,2)) S X=$S(GMR="":0,"Kk"[GMR:+$J(2.2*(+X),0,2),"Ll"[GMR:+X,1:0) K:X>1500!(X=0)!(X<0) X K GMR
"RTN","GMRVPCE3",82,0)
 Q
"RTN","GMRVPCE3",83,0)
PN ; INPUT TRANSFORM FOR PAIN
"RTN","GMRVPCE3",84,0)
 K:"^0^1^2^3^4^5^6^7^8^9^10^99^"'[(U_X_U) X
"RTN","GMRVPCE3",85,0)
 Q
"RTN","GMRVPCE3",86,0)
UNITRATE(TYPE,RATE,UNIT) ; This function will add the unit of
"RTN","GMRVPCE3",87,0)
 ; measurement to the rate so the input transforms will work properly.
"RTN","GMRVPCE3",88,0)
 ;   Input variables:  TYPE = Measurement type
"RTN","GMRVPCE3",89,0)
 ;                     RATE = Actual measurement (passed in by ref.)
"RTN","GMRVPCE3",90,0)
 ;                     UNIT = Unit of measurement
"RTN","GMRVPCE3",91,0)
 ;   Function value: Transormed rate with units on the end.
"RTN","GMRVPCE3",92,0)
 N FXN S FXN=RATE,UNIT=$G(UNIT)
"RTN","GMRVPCE3",93,0)
 I TYPE="AG"!(TYPE="FH")!(TYPE="HC")!(TYPE="HT") D
"RTN","GMRVPCE3",94,0)
 .  I "^CM^IN^"'[("^"_UNIT_"^") S FXN=""
"RTN","GMRVPCE3",95,0)
 .  E  S FXN=RATE_$E(UNIT)
"RTN","GMRVPCE3",96,0)
 .  Q
"RTN","GMRVPCE3",97,0)
 I TYPE="TMP" D
"RTN","GMRVPCE3",98,0)
 .  I "^C^F^"'[("^"_UNIT_"^") S FXN=""
"RTN","GMRVPCE3",99,0)
 .  I UNIT="C" S FXN=+$J(+RATE*(9/5)+32,0,1)
"RTN","GMRVPCE3",100,0)
 .  Q
"RTN","GMRVPCE3",101,0)
 I TYPE="WT" D
"RTN","GMRVPCE3",102,0)
 .  I "^LB^KG^"'[("^"_UNIT_"^") S FXN=""
"RTN","GMRVPCE3",103,0)
 .  E  S FXN=RATE_$E(UNIT)
"RTN","GMRVPCE3",104,0)
 .  Q
"RTN","GMRVPCE3",105,0)
 Q FXN
"RTN","GMRVPCE3",106,0)
CMTOIN(X,PREC) ; Convert CM to IN, given CM value (X) this function will
"RTN","GMRVPCE3",107,0)
 ; return IN value.  Optional input value of PREC for precision,
"RTN","GMRVPCE3",108,0)
 ; if not set, 2 decimals will be returned.
"RTN","GMRVPCE3",109,0)
 Q +$J(.3937*(+X),0,+$G(PREC,2))
"RTN","GMRVSC2")
0^6^B15866640
"RTN","GMRVSC2",1,0)
GMRVSC2 ;HIRMFO/YH,FT-CUMULATIVE V/M - CONTINUED ;6/13/01  10:12
"RTN","GMRVSC2",2,0)
 ;;4.0;Vitals/Measurements;**1,7,11,13**;Apr 25, 1997
"RTN","GMRVSC2",3,0)
SETLN ;
"RTN","GMRVSC2",4,0)
 S GMRVER=^TMP($J,"GMRV",GMRDATE,GMRVTY,GMRVDA) N GMRVPO
"RTN","GMRVSC2",5,0)
 D:IOSL<($Y+9) HDR Q:GMROUT  W ! W:GMRVER "(E)"
"RTN","GMRVSC2",6,0)
 I GPRT(GMRVTY)=0 D
"RTN","GMRVSC2",7,0)
 . W ?4,$S(GMRVTY="T":"T: ",GMRVTY="P":"P: ",GMRVTY="R":"R: ",GMRVTY="BP":"B/P: ",GMRVTY="WT":"Wt: ",GMRVTY="HT":"Ht: ",GMRVTY="CG":"Circumference/Girth: ",GMRVTY="CVP":"Central Venous Pressure: ",GMRVTY="PO2":"Pulse Oximetry: ",1:"")
"RTN","GMRVSC2",8,0)
 . I GMRVTY="PN" W ?4,"Pain: "
"RTN","GMRVSC2",9,0)
 S GPRT(GMRVTY)=1
"RTN","GMRVSC2",10,0)
 S GMRDAT=$G(^GMR(120.5,GMRVDA,0))
"RTN","GMRVSC2",11,0)
 I "PRBPCVPCGPO2PN"[GMRVTY S GMRVX=GMRVTY,GMRVX(0)=$P(GMRDAT,"^",8) D
"RTN","GMRVSC2",12,0)
 .  I "UNAVAILABLEPASSREFUSED"[$$UP^XLFSTR(GMRVX(0)) W ?9,GMRVX(0) Q
"RTN","GMRVSC2",13,0)
 . I GMRVTY="PN" D
"RTN","GMRVSC2",14,0)
 . . I GMRVX(0)=0 W ?9,GMRVX(0)_" - No pain" Q
"RTN","GMRVSC2",15,0)
 . . I GMRVX(0)=99 W ?9,GMRVX(0)_" - Unable to respond" Q
"RTN","GMRVSC2",16,0)
 . . I GMRVX(0)=10 W ?9,GMRVX(0)_" - Worst imaginable pain" Q
"RTN","GMRVSC2",17,0)
 . . W ?9,GMRVX(0) Q
"RTN","GMRVSC2",18,0)
 . ;I GMRVTY'="PN" W ?9,GMRVX(0)
"RTN","GMRVSC2",19,0)
 . D EN1^GMRVSAS0
"RTN","GMRVSC2",20,0)
 . I GMRVTY="P",$D(^GMR(120.5,GMRVDA,5,"B",GPEDIS)),$P(GMRDAT,"^",8)=1 S GMRVX(1)=""
"RTN","GMRVSC2",21,0)
 . S Z=$S(GMRVTY="CG":$J($P(GMRDAT,"^",8),0,2),GMRVTY="CVP":$J($P(GMRDAT,"^",8),0,1),GMRVTY'="BP":$J($P(GMRDAT,"^",8),3,0),1:$P(GMRDAT,"^",8)) D:GMRVTY'="BP" BLNK W:GMRVTY'="PN" ?9,Z_$S('$D(GMRVX(1)):" ",'GMRVX(1):"",1:"*")
"RTN","GMRVSC2",22,0)
 . I GMRVTY="CG" W " in ("_$J(Z/.3937,0,2)_" cm)"
"RTN","GMRVSC2",23,0)
 . I GMRVTY="CVP" W " cmH2O ("_$J(Z/1.36,0,1)_" mmHg)"
"RTN","GMRVSC2",24,0)
 . I GMRVTY="PO2" S GMRVPO=$P(GMRDAT,"^",10) W "%"_$S(GMRVPO'="":" with supplemental O2 "_$S(GMRVPO["l/min":$P(GMRVPO," l/min")_"L/min",1:"")_$S(GMRVPO["l/min":$P(GMRVPO," l/min",2),1:GMRVPO),1:"")
"RTN","GMRVSC2",25,0)
 I GMRVTY="T" S X=$P(GMRDAT,"^",8) D
"RTN","GMRVSC2",26,0)
 . I X'>0 W ?9,X Q
"RTN","GMRVSC2",27,0)
 . S GMRVX=GMRVTY,GMRVX(0)=X D EN1^GMRVSAS0
"RTN","GMRVSC2",28,0)
 . D EN1^GMRVUTL S:'Y Y="" S Z=$J(X,5,1) D BLNK W ?9,Z_" F " S Z=$J(Y,4,1) D BLNK W "("_Z_" C)"_$S('$D(GMRVX(1)):" ",'GMRVX(1):"",1:"*")
"RTN","GMRVSC2",29,0)
 I GMRVTY="HT" S X=$P(GMRDAT,"^",8) D
"RTN","GMRVSC2",30,0)
 . I X'>0 W ?9,X Q
"RTN","GMRVSC2",31,0)
 . D EN2^GMRVUTL S:'Y Y="" S Z=$J(X,5,2) D BLNK W ?9,Z_" in " S Z=$J(Y,5,2) D BLNK W "("_Z_" cm)" I 'GMRVER S GMRVHT=Z/100
"RTN","GMRVSC2",32,0)
 I GMRVTY="WT" S X=$P(GMRDAT,"^",8) D
"RTN","GMRVSC2",33,0)
 . I X'>0 W ?9,X Q
"RTN","GMRVSC2",34,0)
 . D EN3^GMRVUTL S:'Y Y="" S Z=$J(X,7,2) D BLNK W ?9,Z_" lb " S Z=$J(Y,6,2) D BLNK W "("_Z_" kg)"
"RTN","GMRVSC2",35,0)
 Q:+$P(GMRDAT,"^",8)'>0&(+$P($G(^GMR(120.5,GMRVDA,5,0)),"^",4)'>0)  S GMRVITY=+$P(GMRDAT,"^",3)
"RTN","GMRVSC2",36,0)
 K GMRVARY S (GMRZZ,GMRVARY)="" I $P($G(^GMR(120.5,GMRVDA,5,0)),"^",4)>0 D
"RTN","GMRVSC2",37,0)
 . D CHAR^GMRVCHAR(GMRVDA,.GMRVARY,GMRVITY) S GMRZZ=$$WRITECH^GMRVCHAR(GMRVDA,.GMRVARY,9) S:GMRZZ'=""&(GMRVTY'="PO2") GMRZZ=" ("_GMRZZ_")"
"RTN","GMRVSC2",38,0)
 . W:GMRVTY="PO2" !,?8," via " W GMRZZ
"RTN","GMRVSC2",39,0)
 I GMRVTY="WT",'GMRVER S GMRBMI="",GMRBMI(1)=$P(GMRDAT,"^"),GMRBMI(2)=+$P(GMRDAT,"^",8) D CALBMI^GMRVBMI(.GMRBMI) W:GMRBMI>0 !,?4,"Body Mass Index: "_GMRBMI
"RTN","GMRVSC2",40,0)
 K Z Q
"RTN","GMRVSC2",41,0)
HDR ;
"RTN","GMRVSC2",42,0)
 I 'GMR1ST D FOOTER^GMRVSC0
"RTN","GMRVSC2",43,0)
 I $E(IOST)'="P",'GMR1ST W "Press return to continue ""^"" to escape " R X:DTIME I X="^"!'$T S GMROUT=1 Q
"RTN","GMRVSC2",44,0)
 W:'($E(IOST)'="C"&'$D(GFLAG)) @IOF S GMRPG=GMRPG+1,GFLAG=1
"RTN","GMRVSC2",45,0)
 W !,GMRPDT,?25,"Cumulative Vitals/Measurements Report",?70,"Page ",GMRPG,!!,$E(GMRDSH,1,78)
"RTN","GMRVSC2",46,0)
 I 'GMR1ST,$P(GMRDATE,".")=GMRDATE(0) W !,$E(GMRDATE(0),4,5)_"/"_$E(GMRDATE(0),6,7)_"/"_$E(GMRDATE,2,3)_" (continued)",!
"RTN","GMRVSC2",47,0)
 S GMR1ST=0
"RTN","GMRVSC2",48,0)
 Q
"RTN","GMRVSC2",49,0)
BLNK ;
"RTN","GMRVSC2",50,0)
 F I=1:1:$L(Z) Q:$E(Z,I)'=" "
"RTN","GMRVSC2",51,0)
 S Z=$E(Z,I,$L(Z))
"RTN","GMRVSC2",52,0)
 Q
"RTN","GMRVUT0")
0^12^B12655515
"RTN","GMRVUT0",1,0)
GMRVUT0 ;HIRMFO/RM,YH,FT-INPUT TRANSFORMS FOR VITAL TYPES ;7/5/01  16:17
"RTN","GMRVUT0",2,0)
 ;;4.0;Vitals/Measurements;**1,13**;Apr 25, 1997
"RTN","GMRVUT0",3,0)
EN2 ; CALLED FROM INPUT TRANSFORM OF RATE AND QUALITY SUBFIELDS OF SITE
"RTN","GMRVUT0",4,0)
 ; FIELD OF THE VITAL MEASUREMENT (#120.5) FILE - GMRFLD IS SET BEFORE
"RTN","GMRVUT0",5,0)
 ; ENTRY, BUT KILLED WITHIN THE ROUTINE
"RTN","GMRVUT0",6,0)
 S GMRTYP=$S($D(^GMR(120.5,DA,0)):$P(^(0),U,3),1:"") G K:GMRTYP'>0
"RTN","GMRVUT0",7,0)
 G K:GMRTYP'>0,Q2:$P(^GMRD(120.51,GMRTYP,0),U,$S(GMRFLD=1:4,GMRFLD=2:5,1:3))
"RTN","GMRVUT0",8,0)
K D EN^DDIOL($C(7)_"CANNOT EDIT THIS FIELD FOR THIS TYPE OF MEASUREMENT","","!?5") K X
"RTN","GMRVUT0",9,0)
Q2 K GMRTYP,GMRFLD Q
"RTN","GMRVUT0",10,0)
EN3 ; INPUT TRANSFORM FOR HEIGHT RATES
"RTN","GMRVUT0",11,0)
 N GMR
"RTN","GMRVUT0",12,0)
 S GMR=$P(X,+X,2,10) I GMR="" S X=0 Q
"RTN","GMRVUT0",13,0)
 I $E(GMR)="C"!($E(GMR)="c")&("CMCmcMcm"[GMR) S X=$J(.3937*(+X),0,2) Q
"RTN","GMRVUT0",14,0)
 I $E(GMR)="I"!($E(GMR)="i")!($E(GMR)="""") S X=+X Q
"RTN","GMRVUT0",15,0)
 I $E(GMR)="F"!($E(GMR)="f")!($E(GMR)="'") D FTIN Q
"RTN","GMRVUT0",16,0)
 S X=0
"RTN","GMRVUT0",17,0)
 Q
"RTN","GMRVUT0",18,0)
FTIN ;
"RTN","GMRVUT0",19,0)
 N GMRF,GMRIN,GMRXX,GMRYY
"RTN","GMRVUT0",20,0)
 S GMRF=$E(GMR),GMR=$E(GMR,2,$L(GMR)) F GMRXX=1:0 S GMRYY=$E(GMR) Q:GMRYY?1N!(GMRYY="")  S GMRF=GMRF_GMRYY,GMR=$E(GMR,2,$L(GMR))
"RTN","GMRVUT0",21,0)
 I "FTFtfTft'"'[GMRF Q
"RTN","GMRVUT0",22,0)
 S GMRIN=$P(GMR,+GMR,2) I "INIniNin""''"'[GMRIN!(GMRIN="'") Q
"RTN","GMRVUT0",23,0)
 S X=+X*12+(+GMR)
"RTN","GMRVUT0",24,0)
 Q
"RTN","GMRVUT0",25,0)
EN1 ; ENTRY TO GATHER PATIENTS VITAL/MEASURMENT DATA
"RTN","GMRVUT0",26,0)
 ; INPUT VARIABLES:
"RTN","GMRVUT0",27,0)
 ;
"RTN","GMRVUT0",28,0)
 ; DFN = Entry number of patient in Patient file.
"RTN","GMRVUT0",29,0)
 ; GMRVSTR = types of vital/measurments desired.  Use the abbreviations
"RTN","GMRVUT0",30,0)
 ;           found in the Vital Type (120.51) file.  For multiple
"RTN","GMRVUT0",31,0)
 ;           vitals, use the ; as a delimiter.
"RTN","GMRVUT0",32,0)
 ; GMRVSTR(0) = GMRVSTDT^GMRVENDT^GMRVOCC^GMRVSORD
"RTN","GMRVUT0",33,0)
 ;         where GMRVSTDT = The start date/time that the utility will
"RTN","GMRVUT0",34,0)
 ;                          use in obtaining patient data.  (OPTIONAL)
"RTN","GMRVUT0",35,0)
 ;               GMRVENDT = The end date/time that the utility will use
"RTN","GMRVUT0",36,0)
 ;                          to stop the search.  (OPTIONAL)
"RTN","GMRVUT0",37,0)
 ;               GMRVOCC  = The number of occurrences of the data that
"RTN","GMRVUT0",38,0)
 ;                          is desired by the search.  (OPTIONAL)
"RTN","GMRVUT0",39,0)
 ;               GMRVSORD = The sort order desired in output, see OUTPUT
"RTN","GMRVUT0",40,0)
 ;                          VARIABLES section.  (REQUIRED)
"RTN","GMRVUT0",41,0)
 ; GMRVSTR("LT") = ^TYP1^[TYP2^...]  (OPTIONAL)
"RTN","GMRVUT0",42,0)
 ;         THIS VARIABLE IS AN ^ DELIMITED LIST OF HOSPITAL LOCATION
"RTN","GMRVUT0",43,0)
 ;         TYPES TO EXTRACT MEASUREMENT DATA FOR.  E.G., ^C^M^, WILL
"RTN","GMRVUT0",44,0)
 ;         EXTRACT DATA FOR ONLY THOSE MEASUREMENTS TAKEN ON CLINICS
"RTN","GMRVUT0",45,0)
 ;         OR MODULES.
"RTN","GMRVUT0",46,0)
 ;
"RTN","GMRVUT0",47,0)
 ; OUTPUT VARIABLES:
"RTN","GMRVUT0",48,0)
 ;
"RTN","GMRVUT0",49,0)
 ; The utility will create an array with the desired information.  The
"RTN","GMRVUT0",50,0)
 ; array structure will be as follows if '$P(GMRVSTR,"^",4):
"RTN","GMRVUT0",51,0)
 ;      ^UTILITY($J,"GMRVD",GMRVTYP,GMRVRDT,GMRVIEN)=GMRVDATA
"RTN","GMRVUT0",52,0)
 ; or if $P(GMRVSTR,"^",4) then the following will be returned:
"RTN","GMRVUT0",53,0)
 ;      ^UTILITY($J,"GMRVD",GMRVRDT,GMRVTYP,GMRVIEN)=GMRVDATA
"RTN","GMRVUT0",54,0)
 ; where GMRVRDT  = Reverse FileMan date/time.
"RTN","GMRVUT0",55,0)
 ;                  9999999-Date/time vital/measurement was taken.
"RTN","GMRVUT0",56,0)
 ;       GMRVTYP  = The abbreviation used in the GMRVSTR string for the
"RTN","GMRVUT0",57,0)
 ;                  type of vital/measurment taken.
"RTN","GMRVUT0",58,0)
 ;       GMRVIEN  = Entry number in file Vital/Measurement (120.5) file.
"RTN","GMRVUT0",59,0)
 ;       GMRVDATA = $P(^GMR(120.5,GMRVIEN,0),"^",1,9) will be the patient data as
"RTN","GMRVUT0",60,0)
 ;                  currently defined in the DD for file 120.5.
"RTN","GMRVUT0",61,0)
 ;       $P(GMRVDATA,"^",10) = the first qualifier
"RTN","GMRVUT0",62,0)
 ;       $P(GMRVDATA,"^",11) = the second qualifier
"RTN","GMRVUT0",63,0)
 ;       $P(GMRVDATA,"^",12)= "*" for abnormal measurement, otherwise = ""
"RTN","GMRVUT0",64,0)
 ;       $P(GMRVDATA,"^",13)= values in centigrade for T; KG for WT; 
"RTN","GMRVUT0",65,0)
 ;                            in centimeter for HT and Circumference/Girth;
"RTN","GMRVUT0",66,0)
 ;                            in mmHg for CVP.
"RTN","GMRVUT0",67,0)
 ;       $P(GMRVDATA,"^",14)= Body Mass Index.
"RTN","GMRVUT0",68,0)
 ;       $P(GMRVDATA,"^",15)= L/Min of supplemental O2.
"RTN","GMRVUT0",69,0)
 ;       $P(GMRVDATA,"^",16)= % of supplemental O2.
"RTN","GMRVUT0",70,0)
 ;       $P(GMRVDATA,"^",17)= all qualifiers.
"RTN","GMRVUT0",71,0)
 ; The variable GMRVSTR will be killed.
"RTN","GMRVUT0",72,0)
 Q:'$D(GMRVSTR(0))!'($D(GMRVSTR)#2)!'($D(DFN)#2)  Q:DFN'>0
"RTN","GMRVUT0",73,0)
 S GMRSAVE=GMRVSTR,GMRSAVE(0)=GMRVSTR(0) S GMRVSTR="HT" D EN6^GMRVUTL S GMRVSTR=GMRSAVE,GMRVSTR(0)=GMRSAVE(0) S GMRHT=(+$P(X,"^",8)*2.54)/100
"RTN","GMRVUT0",74,0)
 I $G(GMRVSTR("LT"))="" S GMRVSTR("LT")=""
"RTN","GMRVUT0",75,0)
 F GMRVSTR(1)=1:1:$L(GMRVSTR,";") S GMRVSTR("T")=$P(GMRVSTR,";",GMRVSTR(1)) I $L(GMRVSTR("T")) S GMRVSTR("B")=$S($P(GMRVSTR(0),"^",2):9999999-$P(GMRVSTR(0),"^",2)-.0000001,1:0),GMRVSTR("E")=9999999-$P(GMRVSTR(0),"^"),GMRVSTR("O")=0 D GETD
"RTN","GMRVUT0",76,0)
 K GMRINF,GG,GMRSAVE,GMRHT,GMRVARY,GMRVSTR,GMRSITE,GMRQUAL,GMRVX,GMRZTY,GDATA Q
"RTN","GMRVUT0",77,0)
GETD ; LOOP THRU AA XREF AND GET PT DATA.
"RTN","GMRVUT0",78,0)
 S GMRVSTR("TDA")=$O(^GMRD(120.51,"C",GMRVSTR("T"),0)) Q:'GMRVSTR("TDA")
"RTN","GMRVUT0",79,0)
 I GMRVSTR("T")="BP"!(GMRVSTR("T")="P") D BP^GMRVUT2 Q
"RTN","GMRVUT0",80,0)
 F GMRVSTR("R")=GMRVSTR("B"):0 S GMRVSTR("R")=$O(^GMR(120.5,"AA",DFN,GMRVSTR("TDA"),GMRVSTR("R"))) Q:GMRVSTR("R")>GMRVSTR("E")!(GMRVSTR("R")'>0)  D GETD1 Q:GMRVSTR("TMO")
"RTN","GMRVUT0",81,0)
 Q
"RTN","GMRVUT0",82,0)
GETD1 ;
"RTN","GMRVUT0",83,0)
 S GMRVSTR("TMO")=0
"RTN","GMRVUT0",84,0)
 F GMRVSTR("IEN")=0:0 S GMRVSTR("IEN")=$O(^GMR(120.5,"AA",DFN,GMRVSTR("TDA"),GMRVSTR("R"),GMRVSTR("IEN"))) Q:GMRVSTR("IEN")'>0  I '$P($G(^GMR(120.5,+GMRVSTR("IEN"),2)),"^") D SETU2^GMRVUT2 Q:GMRVSTR("TMO")
"RTN","GMRVUT0",85,0)
 Q
"RTN","GMRVUT2")
0^7^B18552169
"RTN","GMRVUT2",1,0)
GMRVUT2 ;HIRMFO/YH,RM,FT-ENTRY TO GATHER PATIENT VITAL/MEASURMENT DATA ;6/26/01  11:14
"RTN","GMRVUT2",2,0)
 ;;4.0;Vitals/Measurements;**1,10,13**;Apr 25, 1997
"RTN","GMRVUT2",3,0)
 ;
"RTN","GMRVUT2",4,0)
 ; This routine uses the following IAs:
"RTN","GMRVUT2",5,0)
 ; #1246 - WIN^DGPMDDCF      (supported)
"RTN","GMRVUT2",6,0)
 ;
"RTN","GMRVUT2",7,0)
BP ;ENTRY TO GATHER PATIENT BLOOD PRESSURE/PULSE DATA
"RTN","GMRVUT2",8,0)
 K ^UTILITY($J,GMRVSTR("T")) S (GDT,GMRVSTR("TMO"))=0,GMRVSTR("R")=GMRVSTR("B") F  S GMRVSTR("R")=$O(^GMR(120.5,"AA",DFN,GMRVSTR("TDA"),GMRVSTR("R"))) Q:GMRVSTR("R")>GMRVSTR("E")!(GMRVSTR("R")'>0)  D  Q:GMRVSTR("TMO")
"RTN","GMRVUT2",9,0)
 . S GMRVSTR("IEN")=0 F  S GMRVSTR("IEN")=$O(^GMR(120.5,"AA",DFN,GMRVSTR("TDA"),GMRVSTR("R"),GMRVSTR("IEN"))) Q:GMRVSTR("IEN")'>0  I '$P($G(^GMR(120.5,+GMRVSTR("IEN"),2)),"^"),$P($G(^GMR(120.5,+GMRVSTR("IEN"),0)),"^",8)>0 D
"RTN","GMRVUT2",10,0)
 . . S GDT(1)=9999999-$$STRIP100(9999999-GMRVSTR("R")) I GDT'=GDT(1) S GDT=GDT(1),GMRVSTR("O")=$G(GMRVSTR("O"))+1
"RTN","GMRVUT2",11,0)
 . . I GMRVSTR("O")>$P(GMRVSTR(0),"^",3) S GMRVSTR("TMO")=1 Q
"RTN","GMRVUT2",12,0)
 . . S ^UTILITY($J,GMRVSTR("T"),GDT,GMRVSTR("IEN"))=""
"RTN","GMRVUT2",13,0)
 S GMRVSTR("R")=0 F  S GMRVSTR("R")=$O(^UTILITY($J,GMRVSTR("T"),GMRVSTR("R"))) Q:GMRVSTR("R")'>0  F GMRVSTR("IEN")=0:0 S GMRVSTR("IEN")=$O(^UTILITY($J,GMRVSTR("T"),GMRVSTR("R"),GMRVSTR("IEN"))) Q:GMRVSTR("IEN")'>0  D SETU2
"RTN","GMRVUT2",14,0)
 K ^UTILITY($J,GMRVSTR("T")),GDT
"RTN","GMRVUT2",15,0)
 Q
"RTN","GMRVUT2",16,0)
STRIP100(DATE) ; This procedure takes DATE and returns that date with
"RTN","GMRVUT2",17,0)
 ; any fractional seconds stripped off.
"RTN","GMRVUT2",18,0)
 Q +($P(DATE,".")_+$E("."_$P(DATE,".",2),1,7))
"RTN","GMRVUT2",19,0)
SETU2 ; Given the IEN of entry GMRVSTR("IEN") this procedure will set the
"RTN","GMRVUT2",20,0)
 ; extract global.
"RTN","GMRVUT2",21,0)
 S GDATA=$P($G(^GMR(120.5,+GMRVSTR("IEN"),0))_"^^^^^^^^^^^^^","^",1,17)
"RTN","GMRVUT2",22,0)
 I GMRVSTR("T")'="CVP",$P(GDATA,"^",8)="" Q
"RTN","GMRVUT2",23,0)
 I GMRVSTR("T")="CVP",+$P(GDATA,"^",8)=0,$E($P(GDATA,"^",8))'="0" Q
"RTN","GMRVUT2",24,0)
  S (GMRINF(1),GMRINF(2))="",GMRINF=$P(GDATA,"^",10)
"RTN","GMRVUT2",25,0)
 I GMRINF'="" D PO2^GMRVLGQU(.GMRINF) S $P(GDATA,"^",15)=GMRINF(1),$P(GDATA,"^",16)=GMRINF(2)
"RTN","GMRVUT2",26,0)
 I $L($G(GMRVSTR("LT"))) Q:$P(GDATA,"^",5)'>0  Q:GMRVSTR("LT")'[("^"_$$GET1^DIQ(44,$P(GDATA,"^",5)_",",2,"I")_"^")
"RTN","GMRVUT2",27,0)
 I GMRVSTR("T")'="BP",GMRVSTR("T")'="P" S GMRVSTR("O")=$G(GMRVSTR("O"))+1,GMRVSTR("TMO")=$S('$P(GMRVSTR(0),"^",3):0,GMRVSTR("O")<$P(GMRVSTR(0),"^",3):0,1:1)
"RTN","GMRVUT2",28,0)
 S GMRVX=GMRVSTR("T"),GMRVX(0)=$P(GDATA,"^",8) D:GMRVX(0)>0 EN1^GMRVSAS0 S $P(GDATA,"^",12)=$S($G(GMRVX(1))>0:"*",1:"")
"RTN","GMRVUT2",29,0)
 S X=GMRVX(0) I X>0 D EN1^GMRVUTL:GMRVSTR("T")="T",EN2^GMRVUTL:GMRVSTR("T")="HT",EN3^GMRVUTL:GMRVSTR("T")="WT" S:GMRVSTR("T")="T"!(GMRVSTR("T")="HT")!(GMRVSTR("T")="WT") $P(GDATA,"^",13)=$S($D(Y):Y,1:"")
"RTN","GMRVUT2",30,0)
 I GMRVSTR("T")="CG" S $P(GDATA,"^",13)=$J(GMRVX(0)/.3937,0,2)
"RTN","GMRVUT2",31,0)
 I GMRVSTR("T")="CVP" S $P(GDATA,"^",13)=$J(GMRVX(0)/1.36,0,1)
"RTN","GMRVUT2",32,0)
 I GMRVSTR("T")="WT",$G(Y)>0 S GMRBMI="",GMRBMI(1)=$P(GDATA,"^"),GMRBMI(2)=+$P(GDATA,"^",8) D CALBMI^GMRVBMI(.GMRBMI) S $P(GDATA,"^",14)=GMRBMI K GMRBMI
"RTN","GMRVUT2",33,0)
 S (GMRSITE,GMRQUAL)="" D QUALIFY
"RTN","GMRVUT2",34,0)
 S $P(GDATA,"^",10)=GMRSITE,$P(GDATA,"^",11)=GMRQUAL,$P(GDATA,"^",17)=$G(GG)
"RTN","GMRVUT2",35,0)
 S ^UTILITY($J,"GMRVD",$S('$P(GMRVSTR(0),"^",4):GMRVSTR("T"),1:GMRVSTR("R")),$S('$P(GMRVSTR(0),"^",4):GMRVSTR("R"),1:GMRVSTR("T")),GMRVSTR("IEN"))=$$STRIP100($P(GDATA,"^"))_"^"_$P(GDATA,"^",2,99)
"RTN","GMRVUT2",36,0)
 Q
"RTN","GMRVUT2",37,0)
INACT42(GMWLOC) ; THIS PROCEDURE WILL CALL SUPPORTED ENTRY POINT WIN^DGPMDDCF
"RTN","GMRVUT2",38,0)
 ; TO DETERMINE IF WARD LOCATION (GMWLOC) IS INACTIVE.
"RTN","GMRVUT2",39,0)
 N X,D0,DGPMOS
"RTN","GMRVUT2",40,0)
 S D0=GMWLOC D WIN^DGPMDDCF
"RTN","GMRVUT2",41,0)
 Q X
"RTN","GMRVUT2",42,0)
QUALIFY ;OBTAIN QUALIFIERS FOR VITAL MEASUREMENT
"RTN","GMRVUT2",43,0)
 K GMRVARY S GMRVARY=""
"RTN","GMRVUT2",44,0)
 I $P($G(^GMR(120.5,+GMRVSTR("IEN"),5,0)),"^",4)>0 D CHAR^GMRVCHAR(+GMRVSTR("IEN"),.GMRVARY,GMRVSTR("TDA")) S GMRSITE=$O(GMRVARY(+GMRVSTR("IEN"),1,"")),GMRQUAL=$O(GMRVARY(+GMRVSTR("IEN"),2,""))
"RTN","GMRVUT2",45,0)
 K GG S GG="" I $O(GMRVARY(0)) D
"RTN","GMRVUT2",46,0)
 . S GG(1)=0 F  S GG(1)=$O(GMRVARY(GG(1))) Q:GG(1)'>0  S GG(2)=0 F  S GG(2)=$O(GMRVARY(GG(1),GG(2))) Q:GG(2)'>0  S GG(3)="" F  S GG(3)=$O(GMRVARY(GG(1),GG(2),GG(3))) Q:GG(3)=""  S GG=GG_$S(GG="":"",1:";")_GG(3)
"RTN","GMRVUT2",47,0)
 I GMRVSTR("T")'="P" Q
"RTN","GMRVUT2",48,0)
 I GMRSITE="" S GMRSITE=GMRQUAL,GMRQUAL="" Q
"RTN","GMRVUT2",49,0)
 I GMRQUAL="" Q
"RTN","GMRVUT2",50,0)
 S GMRSITE=GMRSITE_" "_GMRQUAL,GMRQUAL=""
"RTN","GMRVUT2",51,0)
 Q
"RTN","GMRVUT3")
0^8^B14717743
"RTN","GMRVUT3",1,0)
GMRVUT3 ;HIRMFO/YH,FT-VITAL MEASUREMENT SITE/QUALIFIER SELECTIO ;6/13/01  10:12
"RTN","GMRVUT3",2,0)
 ;;4.0;Vitals/Measurements;**1,11,13**;Apr 25, 1997
"RTN","GMRVUT3",3,0)
SETSITE ;SET THE V/M SITE FOR THE VARIAVLE GMRSITE
"RTN","GMRVUT3",4,0)
 ;GMRV WAS SET BY THE CALLING ROUTINE
"RTN","GMRVUT3",5,0)
 N G S G="" F  S G=$O(GMRW(G)) Q:G=""  I $E(G,1,$L(GMRSITE))=GMRSITE S GMRV=GMRV+1,GMRV(GMRV)=G
"RTN","GMRVUT3",6,0)
 Q:GMRV=0  I GMRV=1 S (GMRSITE(GMRVITY),GMRSITE)=GMRV(GMRV)_"^"_$G(GMRW(GMRV(GMRV))) Q
"RTN","GMRVUT3",7,0)
ASK W !!,GMRVIT(1)_":",! S G=0 F  S G=$O(GMRV(G)) Q:G'>0  W !,?5,G_".  "_GMRV(+G)
"RTN","GMRVUT3",8,0)
 W !!,"Select a number between 1 and "_GMRV_":  " S G(1)=0 R G(1):DTIME I '$T!(G(1)["^") S GMROUT=1 Q
"RTN","GMRVUT3",9,0)
 I $L(G(1))>3 G ASK
"RTN","GMRVUT3",10,0)
 I '$D(GMRV(+G(1))) G ASK
"RTN","GMRVUT3",11,0)
 S (GMRSITE,GMRSITE(GMRVITY))=GMRV(+G(1))_"^"_$G(GMRW(GMRV(+G(1))))
"RTN","GMRVUT3",12,0)
 Q
"RTN","GMRVUT3",13,0)
ROOMSEL ;
"RTN","GMRVUT3",14,0)
 W ! W:$G(GMRMSL($G(I(1))))'="" I(1),". ",?6,$G(GMRMSL(I(1))) W:$G(GMRMSL($G(I(2))))'="" ?16,I(2),".  ",$G(GMRMSL(I(2))) W:$G(GMRMSL($G(I(3))))'="" ?33,I(3),".  ",$G(GMRMSL(I(3)))
"RTN","GMRVUT3",15,0)
 W:$G(GMRMSL($G(I(4))))'="" ?49,I(4),".  ",$G(GMRMSL(I(4))) W:$G(GMRMSL($G(I(5))))'="" ?65,I(5),".  ",$G(GMRMSL(I(5)))
"RTN","GMRVUT3",16,0)
 S I(1)=(I(1)+1),I(2)=(I(2)+1),I(3)=(I(3)+1),I(4)=(I(4)+1),I(5)=(I(5)+1)
"RTN","GMRVUT3",17,0)
 Q
"RTN","GMRVUT3",18,0)
GIRTH ;INPUT TRANSFORM FOR CIRCUMFERENCE/GIRTH
"RTN","GMRVUT3",19,0)
 Q:"UNAVAILABLEPASSREFUSED"[$$UP^XLFSTR(X)  N UNIT S UNIT=$$UP^XLFSTR($P(X,+X,2)),X=+X I UNIT="" S UNIT="I" Q
"RTN","GMRVUT3",20,0)
 I UNIT="C" S X=$J(.3937*X,0,2),UNIT="I"
"RTN","GMRVUT3",21,0)
 I UNIT'="I" K X Q
"RTN","GMRVUT3",22,0)
 K:+X'=X!(X>200)!(X<0) X
"RTN","GMRVUT3",23,0)
 Q
"RTN","GMRVUT3",24,0)
CVP ;INPUT TRANSFORM FOR CVP
"RTN","GMRVUT3",25,0)
 Q:"UNAVAILABLEPASSREFUSED"[$$UP^XLFSTR(X)  N UNIT S UNIT=$$UP^XLFSTR($P(X,+X,2)) I $L(UNIT)>1!($L(UNIT)=1&($E(UNIT)'="G")) K X Q
"RTN","GMRVUT3",26,0)
 I UNIT'="" S X=X*1.36
"RTN","GMRVUT3",27,0)
 K:X<-13.6!(X>136) X
"RTN","GMRVUT3",28,0)
 Q
"RTN","GMRVUT3",29,0)
O2 ;SUPPLEMENTAL O2 FOR PULSE OXIMETRY
"RTN","GMRVUT3",30,0)
 N %,GMRV,GMRZ,GMRX,GMRY S (GMRSITE(GMRVITY),GMRINF(GMRVITY),GMRO2(GMRVITY))=""
"RTN","GMRVUT3",31,0)
ASKO2 S %=1 W !,"Is the patient on supplemental oxygen" D YN^DICN I %<0 S GMROUT=1 Q
"RTN","GMRVUT3",32,0)
 I %=0 G ASKO2
"RTN","GMRVUT3",33,0)
 Q:%=2
"RTN","GMRVUT3",34,0)
ASKINF W !!,"Enter the numeric value(s) for amount of supplemental oxygen provided",!,"(Separate values with a ',') : "
"RTN","GMRVUT3",35,0)
 S GMRV="" R GMRV:DTIME I '$T!(GMRV["^") S GMROUT=1 Q
"RTN","GMRVUT3",36,0)
 I $L(GMRV)>15 G ASKINF
"RTN","GMRVUT3",37,0)
 I GMRV["?" W !!,"Enter a number between 0.5-20 for liters/minute,   and/or ",!,?23,"21-100 for percent of oxygen concentration.",!,"If you wish to enter both rates, separate the values with a ','.",! G ASKINF
"RTN","GMRVUT3",38,0)
 Q:GMRV=""
"RTN","GMRVUT3",39,0)
 S GMRZ=0 D CHECK I GMRZ W !!,"ERROR ENTRY!",! G ASKINF
"RTN","GMRVUT3",40,0)
 I (GMRX["l/min"&(GMRY["l/min"))!(GMRX["%"&(GMRY["%")) W !!,"ERROR ENTRY!" G ASKINF
"RTN","GMRVUT3",41,0)
 I GMRY'="" D
"RTN","GMRVUT3",42,0)
 .N GMRVPO
"RTN","GMRVUT3",43,0)
 .I GMRX'["l/min",(GMRY["l/min") S:GMRX["%" GMRVPO=GMRY,GMRY=GMRX,GMRX=GMRVPO
"RTN","GMRVUT3",44,0)
 .Q
"RTN","GMRVUT3",45,0)
 S GMRO2(GMRVITY)=GMRX S:GMRY'="" GMRO2(GMRVITY)=GMRO2(GMRVITY)_$S(GMRO2(GMRVITY)="":"",1:" ")_GMRY S:GMRO2(GMRVITY)'="" GMRO2(GMRVITY)=GMRO2(GMRVITY)
"RTN","GMRVUT3",46,0)
 S GLVL=8 D LISTQ^GMRVQUAL
"RTN","GMRVUT3",47,0)
 Q:'$D(GCHART1)
"RTN","GMRVUT3",48,0)
ASKM S GMRV=$O(GCOUNT(1,GMRV))
"RTN","GMRVUT3",49,0)
 N GMRVSAVE
"RTN","GMRVUT3",50,0)
 S GMRVSAVE=GMRV
"RTN","GMRVUT3",51,0)
ASKM1 S GMRV=GMRVSAVE
"RTN","GMRVUT3",52,0)
 W !,"Oxygen is supplied by",!
"RTN","GMRVUT3",53,0)
 F I=1:1:GCOUNT(1,GMRV) W !,?5,I_" "_$P(GCHART1(I),"^")
"RTN","GMRVUT3",54,0)
 W !,"Enter a number: " S GMRV="" R GMRV:DTIME I '$T!(GMRV["^") S GMROUT=1 Q
"RTN","GMRVUT3",55,0)
 I $L(GMRV)>3 G ASKM1
"RTN","GMRVUT3",56,0)
 I $D(GCHART1(+GMRV)) S GMRSITE(GMRVITY)=GCHART1(+GMRV) Q
"RTN","GMRVUT3",57,0)
 I '$D(GCHART1(+GMRV)) G ASKM1
"RTN","GMRVUT3",58,0)
 I GMRV["?" G ASKM1
"RTN","GMRVUT3",59,0)
 Q
"RTN","GMRVUT3",60,0)
CHECK ;
"RTN","GMRVUT3",61,0)
 S GMRY=$P($G(GMRV),","),GMRX=$P($G(GMRV),",",2)
"RTN","GMRVUT3",62,0)
 I GMRX'="" D O2DATA(.GMRX,.GMRZ) Q:GMRZ
"RTN","GMRVUT3",63,0)
 I GMRY'="" D O2DATA(.GMRY,.GMRZ)
"RTN","GMRVUT3",64,0)
 Q
"RTN","GMRVUT3",65,0)
O2DATA(I,J) ;
"RTN","GMRVUT3",66,0)
 I '(I>0&(I<100.001)) S J=1 Q
"RTN","GMRVUT3",67,0)
 I I<20.01,I?0.3N0.1"."0.1N S I=I_" l/min" Q
"RTN","GMRVUT3",68,0)
 I I>20&(I<100.001),I?1.3N S I=I_"%" Q
"RTN","GMRVUT3",69,0)
 S J=1
"RTN","GMRVUT3",70,0)
 Q
"RTN","GMRVUTL1")
0^10^B5432870
"RTN","GMRVUTL1",1,0)
GMRVUTL1 ;HIRMFO/YH-VITALS/MEASUREMENTS UTILITY ;2/4/99
"RTN","GMRVUTL1",2,0)
 ;;4.0;Vitals/Measurements;**7,13**;Apr 25, 1997
"RTN","GMRVUTL1",3,0)
CG ;HELP INFORMATION FOR CIRCUMFERENCE/GIRTH
"RTN","GMRVUTL1",4,0)
 W !,"** Circumference:  a number + 'I' or 'C' (2 decimals allowed)",!,?3,"For example:  72.25I (inches)   147C (centimeters)",!,?3,"Default: INCHES"
"RTN","GMRVUTL1",5,0)
 Q
"RTN","GMRVUTL1",6,0)
CVP ;HELP INFORMATION FOR CVP
"RTN","GMRVUTL1",7,0)
 W !,"** Central venous pressure:  a number for cmH2O measurement",!,?3,"or a number + 'G' for mmHg measurement (1 decimal allowed).",!,?3,"A negative number can be entered up to & including -13 cmH2O or -9.6 mmHg.",! Q
"RTN","GMRVUTL1",8,0)
PO2 ;HELP INFORMATION FOR PULSE OXIMETRY
"RTN","GMRVUTL1",9,0)
 W !,"** Pulse Oximetry:  Enter the numeric value of the patients Pulse Oximetry.",!,?3,"The value will be interpreted as a percentage (not greater than 100)."
"RTN","GMRVUTL1",10,0)
 Q
"RTN","GMRVUTL1",11,0)
PAIN ;HELP INFORMATION FOR PAIN
"RTN","GMRVUTL1",12,0)
 W !,"** Pain:  Enter a numeric value. 0 for no pain. 1-10 for pain scale",!,?3,"10 is worst imaginable pain or enter 99 if the patient is unable to respond"
"RTN","GMRVUTL1",13,0)
 W !,?3,"For example: 99 or 5"
"RTN","GMRVUTL1",14,0)
 Q
"VER")
8.0^22.0
**END**
**END**
