Released EN*7*74 SEQ #72
Extracted from mail message
**KIDS**:EN*7.0*74^

**INSTALL NAME**
EN*7.0*74
"BLD",4523,0)
EN*7.0*74^ENGINEERING^0^3030924^y
"BLD",4523,1,0)
^^3^3^3030616^
"BLD",4523,1,1,0)
This patch will install menu option 16 for CoreFLS Data Cleansing Reports.  It
"BLD",4523,1,2,0)
will then install a sub-menu for 6911 reports.  Please see patch documentation 
"BLD",4523,1,3,0)
for description of data cleansing reports for 6911 file.
"BLD",4523,4,0)
^9.64PA^^
"BLD",4523,"ABPKG")
n
"BLD",4523,"KRN",0)
^9.67PA^8989.52^19
"BLD",4523,"KRN",.4,0)
.4
"BLD",4523,"KRN",.4,"NM",0)
^9.68A^^
"BLD",4523,"KRN",.401,0)
.401
"BLD",4523,"KRN",.401,"NM",0)
^9.68A^^
"BLD",4523,"KRN",.402,0)
.402
"BLD",4523,"KRN",.403,0)
.403
"BLD",4523,"KRN",.5,0)
.5
"BLD",4523,"KRN",.84,0)
.84
"BLD",4523,"KRN",3.6,0)
3.6
"BLD",4523,"KRN",3.8,0)
3.8
"BLD",4523,"KRN",9.2,0)
9.2
"BLD",4523,"KRN",9.8,0)
9.8
"BLD",4523,"KRN",9.8,"NM",0)
^9.68A^6^6
"BLD",4523,"KRN",9.8,"NM",1,0)
ENH6911^^0^B56736778
"BLD",4523,"KRN",9.8,"NM",2,0)
ENH6911C^^0^B37141859
"BLD",4523,"KRN",9.8,"NM",3,0)
ENH6911D^^0^B64467499
"BLD",4523,"KRN",9.8,"NM",4,0)
ENH6911F^^0^B65299206
"BLD",4523,"KRN",9.8,"NM",5,0)
ENH6911I^^0^B38029952
"BLD",4523,"KRN",9.8,"NM",6,0)
ENH6911M^^0^B27755865
"BLD",4523,"KRN",9.8,"NM","B","ENH6911",1)

"BLD",4523,"KRN",9.8,"NM","B","ENH6911C",2)

"BLD",4523,"KRN",9.8,"NM","B","ENH6911D",3)

"BLD",4523,"KRN",9.8,"NM","B","ENH6911F",4)

"BLD",4523,"KRN",9.8,"NM","B","ENH6911I",5)

"BLD",4523,"KRN",9.8,"NM","B","ENH6911M",6)

"BLD",4523,"KRN",19,0)
19
"BLD",4523,"KRN",19,"NM",0)
^9.68A^8^7
"BLD",4523,"KRN",19,"NM",1,0)
ENH DATA CLEANSING^^3
"BLD",4523,"KRN",19,"NM",2,0)
ENH EQUIPMENT CATEGORY^^0
"BLD",4523,"KRN",19,"NM",3,0)
ENMAN^^2
"BLD",4523,"KRN",19,"NM",5,0)
ENH 6911 SUMMARY REPORT^^0
"BLD",4523,"KRN",19,"NM",6,0)
ENH 6911 REQUIRED RPT^^0
"BLD",4523,"KRN",19,"NM",7,0)
ENH 6911 LOOKUP RPT^^0
"BLD",4523,"KRN",19,"NM",8,0)
ENH 6911 NON-REQUIRED RPT^^0
"BLD",4523,"KRN",19,"NM","B","ENH 6911 LOOKUP RPT",7)

"BLD",4523,"KRN",19,"NM","B","ENH 6911 NON-REQUIRED RPT",8)

"BLD",4523,"KRN",19,"NM","B","ENH 6911 REQUIRED RPT",6)

"BLD",4523,"KRN",19,"NM","B","ENH 6911 SUMMARY REPORT",5)

"BLD",4523,"KRN",19,"NM","B","ENH DATA CLEANSING",1)

"BLD",4523,"KRN",19,"NM","B","ENH EQUIPMENT CATEGORY",2)

"BLD",4523,"KRN",19,"NM","B","ENMAN",3)

"BLD",4523,"KRN",19.1,0)
19.1
"BLD",4523,"KRN",19.1,"NM",0)
^9.68A^1^1
"BLD",4523,"KRN",19.1,"NM",1,0)
ENH DATA CLEANSING^^0
"BLD",4523,"KRN",19.1,"NM","B","ENH DATA CLEANSING",1)

"BLD",4523,"KRN",101,0)
101
"BLD",4523,"KRN",409.61,0)
409.61
"BLD",4523,"KRN",771,0)
771
"BLD",4523,"KRN",870,0)
870
"BLD",4523,"KRN",8989.51,0)
8989.51
"BLD",4523,"KRN",8989.52,0)
8989.52
"BLD",4523,"KRN",8994,0)
8994
"BLD",4523,"KRN","B",.4,.4)

"BLD",4523,"KRN","B",.401,.401)

"BLD",4523,"KRN","B",.402,.402)

"BLD",4523,"KRN","B",.403,.403)

"BLD",4523,"KRN","B",.5,.5)

"BLD",4523,"KRN","B",.84,.84)

"BLD",4523,"KRN","B",3.6,3.6)

"BLD",4523,"KRN","B",3.8,3.8)

"BLD",4523,"KRN","B",9.2,9.2)

"BLD",4523,"KRN","B",9.8,9.8)

"BLD",4523,"KRN","B",19,19)

"BLD",4523,"KRN","B",19.1,19.1)

"BLD",4523,"KRN","B",101,101)

"BLD",4523,"KRN","B",409.61,409.61)

"BLD",4523,"KRN","B",771,771)

"BLD",4523,"KRN","B",870,870)

"BLD",4523,"KRN","B",8989.51,8989.51)

"BLD",4523,"KRN","B",8989.52,8989.52)

"BLD",4523,"KRN","B",8994,8994)

"BLD",4523,"QUES",0)
^9.62^^
"BLD",4523,"REQB",0)
^9.611^^
"KRN",19,5633,-1)
2^3
"KRN",19,5633,0)
ENMAN^Program Management^^M^12222^ENMGR^^^^^^^^1^1
"KRN",19,5633,10,0)
^19.01IP^25^16
"KRN",19,5633,10,25,0)
11578^16^
"KRN",19,5633,10,25,"^")
ENH DATA CLEANSING
"KRN",19,5633,"U")
PROGRAM MANAGEMENT
"KRN",19,11578,-1)
3^1
"KRN",19,11578,0)
ENH DATA CLEANSING^CoreFLS AEMS/MERS Data Cleansing Reports^^M^^ENH DATA CLEANSING^^^^^^ENGINEERING
"KRN",19,11578,1,0)
^19.06^3^3^3030625^^^^
"KRN",19,11578,1,1,0)
This option contains menu options for data cleansing reports for the
"KRN",19,11578,1,2,0)
AEMS/MERS files.  Each file has its own menu option and sub-menus
"KRN",19,11578,1,3,0)
for each data cleansing report for that file.
"KRN",19,11578,10,0)
^19.01IP^7^7
"KRN",19,11578,10,1,0)
11579^1^1
"KRN",19,11578,10,1,"^")
ENH EQUIPMENT CATEGORY
"KRN",19,11578,99)
59345,61543
"KRN",19,11578,"U")
COREFLS AEMS/MERS DATA CLEANSI
"KRN",19,11579,-1)
0^2
"KRN",19,11579,0)
ENH EQUIPMENT CATEGORY^Equipment Category - 6911^^M^^ENH DATA CLEANSING^^^^^^ENGINEERING^^^^^
"KRN",19,11579,1,0)
^19.06^2^2^3030916^^
"KRN",19,11579,1,1,0)
This menu displays all of the CoreFLS Data Cleansing report options for
"KRN",19,11579,1,2,0)
AEMS/MERS EQUIPMENT CATEGORY (#6911) file.
"KRN",19,11579,10,0)
^19.01IP^4^4
"KRN",19,11579,10,1,0)
11713^1^1
"KRN",19,11579,10,1,"^")
ENH 6911 SUMMARY REPORT
"KRN",19,11579,10,2,0)
11714^2^2
"KRN",19,11579,10,2,"^")
ENH 6911 REQUIRED RPT
"KRN",19,11579,10,3,0)
11710^3^3
"KRN",19,11579,10,3,"^")
ENH 6911 LOOKUP RPT
"KRN",19,11579,10,4,0)
11711^4^4
"KRN",19,11579,10,4,"^")
ENH 6911 NON-REQUIRED RPT
"KRN",19,11579,20)

"KRN",19,11579,26)

"KRN",19,11579,99)
59375,43846
"KRN",19,11579,"U")
EQUIPMENT CATEGORY - 6911
"KRN",19,11710,-1)
0^7
"KRN",19,11710,0)
ENH 6911 LOOKUP RPT^Lookup Fields w/ Invalid Data Report^^R^^^^^^^^^^1^
"KRN",19,11710,1,0)
^^4^4^3030915^
"KRN",19,11710,1,1,0)
This option prints or displays the CoreFLS Data Cleansing Lookup Fields w/
"KRN",19,11710,1,2,0)
Invalid Data Report for the EQUIPMENT CATEGORY (#6911) file. The report
"KRN",19,11710,1,3,0)
lists the lookup fields that contain an invalid value in a pointer field
"KRN",19,11710,1,4,0)
that you must correct.
"KRN",19,11710,15)

"KRN",19,11710,20)
S ENHRPT=3
"KRN",19,11710,25)
REPTYP^ENH6911
"KRN",19,11710,99)
59332,60829
"KRN",19,11710,"U")
LOOKUP FIELDS W/ INVALID DATA 
"KRN",19,11711,-1)
0^8
"KRN",19,11711,0)
ENH 6911 NON-REQUIRED RPT^Non-Required Fields Missing Data Report^^R^^^^^^^^^^1^
"KRN",19,11711,1,0)
^^4^4^3030915^
"KRN",19,11711,1,1,0)
This option prints or displays the CoreFLS Data Cleansing Non-Required
"KRN",19,11711,1,2,0)
Fields Missing Data Report for the EQUIPMENT CATEGORY (#6911) file. The
"KRN",19,11711,1,3,0)
report lists the non-required fields that are empty and that you should 
"KRN",19,11711,1,4,0)
correct.
"KRN",19,11711,15)

"KRN",19,11711,20)
S ENHRPT=4
"KRN",19,11711,25)
REPTYP^ENH6911
"KRN",19,11711,99)
59332,60831
"KRN",19,11711,"U")
NON-REQUIRED FIELDS MISSING DA
"KRN",19,11713,-1)
0^5
"KRN",19,11713,0)
ENH 6911 SUMMARY REPORT^Summary Report^^R^^^^^^^^ENGINEERING^^1^^^
"KRN",19,11713,1,0)
^^4^4^3030915^
"KRN",19,11713,1,1,0)
This option prints or displays the CoreFLS Data Cleansing Summary Report
"KRN",19,11713,1,2,0)
for the EQUIPMENT CATEGORY (#6911) file. The report shows the fields being
"KRN",19,11713,1,3,0)
checked and the total number of times that required fields and
"KRN",19,11713,1,4,0)
non-required fields are missing data and lookup fields have invalid data.
"KRN",19,11713,15)

"KRN",19,11713,20)
S ENHRPT=1
"KRN",19,11713,25)
REPTYP^ENH6911
"KRN",19,11713,26)

"KRN",19,11713,"U")
SUMMARY REPORT
"KRN",19,11714,-1)
0^6
"KRN",19,11714,0)
ENH 6911 REQUIRED RPT^Required Fields Missing Data Report^^R^^^^^^^^^^1^
"KRN",19,11714,1,0)
^^3^3^3030915^
"KRN",19,11714,1,1,0)
This option prints or displays the CoreFLS Data Cleansing Required Fields
"KRN",19,11714,1,2,0)
Missing Data Report for the EQUIPMENT CATEGORY (#6911) file. The report
"KRN",19,11714,1,3,0)
lists the required fields that are empty and that you must correct.
"KRN",19,11714,15)

"KRN",19,11714,20)
S ENHRPT=2
"KRN",19,11714,25)
REPTYP^ENH6911
"KRN",19,11714,"U")
REQUIRED FIELDS MISSING DATA R
"KRN",19.1,445,-1)
0^1
"KRN",19.1,445,0)
ENH DATA CLEANSING^CoreFLS Data Cleansing (ENG)
"KRN",19.1,445,1,0)
^19.11^1^1^3030501^^^
"KRN",19.1,445,1,1,0)
This key is for the CoreFLS Data Cleansing of AEMS/MERS files
"MBREQ")
0
"ORD",3,19.1)
19.1;3;1;;KEY^XPDTA1;;;;;KEYDEL^XPDIA1
"ORD",3,19.1,0)
SECURITY KEY
"ORD",18,19)
19;18;;;OPT^XPDTA;OPTF1^XPDIA;OPTE1^XPDIA;OPTF2^XPDIA;;OPTDEL^XPDIA
"ORD",18,19,0)
OPTION
"PKG",33,-1)
1^1
"PKG",33,0)
ENGINEERING^EN^AUTOMATED ENGINEERING MANAGEMENT SYSTEM
"PKG",33,20,0)
^9.402P^^
"PKG",33,22,0)
^9.49I^1^1
"PKG",33,22,1,0)
7.0^2930817^2960130
"PKG",33,22,1,"PAH",1,0)
74^3030924
"PKG",33,22,1,"PAH",1,1,0)
^^3^3^3030924
"PKG",33,22,1,"PAH",1,1,1,0)
This patch will install menu option 16 for CoreFLS Data Cleansing Reports.  It
"PKG",33,22,1,"PAH",1,1,2,0)
will then install a sub-menu for 6911 reports.  Please see patch documentation 
"PKG",33,22,1,"PAH",1,1,3,0)
for description of data cleansing reports for 6911 file.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
6
"RTN","ENH6911")
0^1^B56736778
"RTN","ENH6911",1,0)
ENH6911 ;WOIFO/TAW/EEN - Equipment Category Summary Report ;09/24/03 13:44
"RTN","ENH6911",2,0)
 ;;7.0;ENGINEERING;**74**;Aug 17, 1993
"RTN","ENH6911",3,0)
 ;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","ENH6911",4,0)
 ;
"RTN","ENH6911",5,0)
 Q  ;this routine is not callable from the top
"RTN","ENH6911",6,0)
 ;
"RTN","ENH6911",7,0)
 ;This routine will sort and print the report.  
"RTN","ENH6911",8,0)
 ;
"RTN","ENH6911",9,0)
REPTYP ;Get which report to run
"RTN","ENH6911",10,0)
 I '$D(DT)!'$D(U) D DT^DICRW
"RTN","ENH6911",11,0)
 S ABORT=0,ENHDICT=6911
"RTN","ENH6911",12,0)
 I ENHRPT=1 D
"RTN","ENH6911",13,0)
 . S ENHSUM=1,PRTRTN="SUMMARY^ENH6911",ENHRTN="ENH6911"
"RTN","ENH6911",14,0)
 I ENHRPT=2 D
"RTN","ENH6911",15,0)
 . S ENHDET=1,PRTRTN="FLDSORT^ENH6911C"
"RTN","ENH6911",16,0)
 I ENHRPT=3 D
"RTN","ENH6911",17,0)
 . S ENHDET=2,PRTRTN="ESORT^ENH6911C"
"RTN","ENH6911",18,0)
 I ENHRPT=4 D
"RTN","ENH6911",19,0)
 . S ENHDET=3,PRTRTN="ALLSORT^ENH6911C"
"RTN","ENH6911",20,0)
 I $D(ENHDET) D  I ABORT G EXIT Q
"RTN","ENH6911",21,0)
 . S ENHRTN="ENH6911C"
"RTN","ENH6911",22,0)
 . D LOCSEL^ENH6911C
"RTN","ENH6911",23,0)
 K ^TMP($J,ENHRTN)
"RTN","ENH6911",24,0)
 D INST I ABORT G EXIT Q
"RTN","ENH6911",25,0)
 D DEVICE^ENH6911 I ABORT G EXIT Q
"RTN","ENH6911",26,0)
 G EXIT
"RTN","ENH6911",27,0)
 Q
"RTN","ENH6911",28,0)
 ;
"RTN","ENH6911",29,0)
INST ; Print Instructions for Summary Report
"RTN","ENH6911",30,0)
 ;
"RTN","ENH6911",31,0)
 ;  Variables:
"RTN","ENH6911",32,0)
 ;    ENHRPT = Type of report
"RTN","ENH6911",33,0)
 ;           1 - Summary Report
"RTN","ENH6911",34,0)
 ;           2 - Required Fields Missing Data Report
"RTN","ENH6911",35,0)
 ;           3 - Lookup Fields w/ Invalid Data Report
"RTN","ENH6911",36,0)
 ;           4 - Non-Required Fields Missing Data Report
"RTN","ENH6911",37,0)
 ;
"RTN","ENH6911",38,0)
 D HOME^%ZIS
"RTN","ENH6911",39,0)
 K DIR
"RTN","ENH6911",40,0)
 S DIR(0)="Y"
"RTN","ENH6911",41,0)
 S DIR("A")="Do you wish to print the instructions for this report"
"RTN","ENH6911",42,0)
 S DIR("A",1)=" "
"RTN","ENH6911",43,0)
 S DIR("B")="NO"
"RTN","ENH6911",44,0)
 S DIR("?")="Please enter Y to print the instructions or N to skip the instructions"
"RTN","ENH6911",45,0)
 D ^DIR K DIR
"RTN","ENH6911",46,0)
 I Y[U!(Y="")!$D(DTOUT)!$D(DUOUT) S ABORT=1 Q
"RTN","ENH6911",47,0)
 S ENHINST=Y
"RTN","ENH6911",48,0)
 Q
"RTN","ENH6911",49,0)
 ;
"RTN","ENH6911",50,0)
SUMMARY ;Compile only summary data
"RTN","ENH6911",51,0)
 S (PROC,TECH,RESSHOP,FREQ,ENHCTR,NULLCTR,NAME)=""
"RTN","ENH6911",52,0)
 S (SHOPNULL,TECHNULL,PROCNULL,FREQNULL,INT,INTCNT,NAMENULL)=0
"RTN","ENH6911",53,0)
 S (PROCCT,TECHCT,SHOPCT,CRITCTR,CRITCT)=0
"RTN","ENH6911",54,0)
 I $E(IOST,1,2)="C-" D WAIT^DICD
"RTN","ENH6911",55,0)
 F  S INT=$O(^ENG(6911,INT)) Q:'INT  D
"RTN","ENH6911",56,0)
 . S INTCNT=INTCNT+1
"RTN","ENH6911",57,0)
 . ;Reset placeholders each time we get a new category
"RTN","ENH6911",58,0)
 . S (NULLFLG,FLAG,CRITFLG,MULT)=0
"RTN","ENH6911",59,0)
 . S NAME=$P(^ENG(6911,INT,0),U)
"RTN","ENH6911",60,0)
 . I NAME="" D
"RTN","ENH6911",61,0)
 .. S NAMENULL=NAMENULL+1 S CRITFLG=1
"RTN","ENH6911",62,0)
 . I $D(^ENG(6911,INT,4)) D
"RTN","ENH6911",63,0)
 .. S MULT=0
"RTN","ENH6911",64,0)
 .. F  S MULT=$O(^ENG(6911,INT,4,MULT)) Q:'MULT  D
"RTN","ENH6911",65,0)
 ... S DATA1=$G(^ENG(6911,INT,4,MULT,0))
"RTN","ENH6911",66,0)
 ... S RESSHOP=$P(DATA1,U)
"RTN","ENH6911",67,0)
 ... I RESSHOP="" Q      ;DO NOT WANT ANY INFO UNDER NULL SHOPS
"RTN","ENH6911",68,0)
 ... S TECH=$P(DATA1,U,2)
"RTN","ENH6911",69,0)
 ... I RESSHOP'="" D
"RTN","ENH6911",70,0)
 .... I '$D(^DIC(6922,RESSHOP))!($P($G(^DIC(6922,RESSHOP,0)),U,1)="") D  Q
"RTN","ENH6911",71,0)
 ..... S SHOPCT=SHOPCT+1 S FLAG=1
"RTN","ENH6911",72,0)
 ... I TECH="" D
"RTN","ENH6911",73,0)
 .... S TECHNULL=TECHNULL+1 S NULLFLG=1
"RTN","ENH6911",74,0)
 ... I TECH'="" D
"RTN","ENH6911",75,0)
 .... I '$D(^ENG("EMP",TECH))!($P($G(^ENG("EMP",TECH,0)),U,1)="") D  Q
"RTN","ENH6911",76,0)
 ..... S TECHCT=TECHCT+1 S FLAG=1
"RTN","ENH6911",77,0)
 ... S DATA2=$G(^ENG(6911,INT,4,MULT,2,0)),MULT2=0
"RTN","ENH6911",78,0)
 ... I '$D(DATA2)!($P(DATA2,U,4)=0)!($P(DATA2,U,4)="") D  Q
"RTN","ENH6911",79,0)
 .... S FREQNULL=FREQNULL+1,PROCNULL=PROCNULL+1,NULLFLG=1
"RTN","ENH6911",80,0)
 ... S MULT2=0
"RTN","ENH6911",81,0)
 ... F  S MULT2=$O(^ENG(6911,INT,4,MULT,2,MULT2)) Q:'MULT2  D
"RTN","ENH6911",82,0)
 .... S DATA2=$G(^ENG(6911,INT,4,MULT,2,MULT2,0))
"RTN","ENH6911",83,0)
 .... S FREQ=$P(DATA2,U,1)
"RTN","ENH6911",84,0)
 .... I FREQ="" D
"RTN","ENH6911",85,0)
 ..... S FREQNULL=FREQNULL+1 S NULLFLG=1
"RTN","ENH6911",86,0)
 .... S PROC=$P(DATA2,U,5)
"RTN","ENH6911",87,0)
 .... I PROC="" D
"RTN","ENH6911",88,0)
 ..... S PROCNULL=PROCNULL+1 S NULLFLG=1
"RTN","ENH6911",89,0)
 .... I PROC'="" D
"RTN","ENH6911",90,0)
 ..... I '$D(^ENG(6914.2,PROC))!($P($G(^ENG(6914.2,PROC,0)),U)="") D  Q
"RTN","ENH6911",91,0)
 ...... S PROCCT=PROCCT+1 S FLAG=1
"RTN","ENH6911",92,0)
 . ;Add to the entry counter
"RTN","ENH6911",93,0)
 . I FLAG'=0 D
"RTN","ENH6911",94,0)
 .. S BADCNT=$G(^TMP($J,ENHRTN,"DICT",ENHDICT,"ENTRY","BRPTR"))
"RTN","ENH6911",95,0)
 .. S ^TMP($J,ENHRTN,"DICT",ENHDICT,"ENTRY","BRPTR")=(BADCNT+1)
"RTN","ENH6911",96,0)
 . I NULLFLG'=0 D
"RTN","ENH6911",97,0)
 .. S NULLCTR=$G(^TMP($J,ENHRTN,"DICT",ENHDICT,"ENTRY","NULLCT"))
"RTN","ENH6911",98,0)
 .. S ^TMP($J,ENHRTN,"DICT",ENHDICT,"ENTRY","NULLCT")=(NULLCTR+1)
"RTN","ENH6911",99,0)
 . I CRITFLG'=0 D
"RTN","ENH6911",100,0)
 .. S CRITCTR=$G(^TMP($J,ENHRTN,"DICT",ENHDICT,"ENTRY","CRITCT"))
"RTN","ENH6911",101,0)
 .. S ^TMP($J,ENHRTN,"DICT",ENHDICT,"ENTRY","CRITCT")=(CRITCTR+1)
"RTN","ENH6911",102,0)
 S ^TMP($J,ENHRTN,"DICT",ENHDICT,"ENTRY")=INTCNT
"RTN","ENH6911",103,0)
 I TECHCT'="" S ^TMP($J,ENHRTN,"DICT",ENHDICT,"TECH")=TECHCT
"RTN","ENH6911",104,0)
 I SHOPCT'="" S ^TMP($J,ENHRTN,"DICT",ENHDICT,"RESSHOP")=SHOPCT
"RTN","ENH6911",105,0)
 I PROCCT'="" S ^TMP($J,ENHRTN,"DICT",ENHDICT,"PROC")=PROCCT
"RTN","ENH6911",106,0)
 I NAMENULL'="" S ^TMP($J,ENHRTN,"DICT",ENHDICT,"NAMENULL")=NAMENULL
"RTN","ENH6911",107,0)
 I TECHNULL'="" S ^TMP($J,ENHRTN,"DICT",ENHDICT,"TECHNULL")=TECHNULL
"RTN","ENH6911",108,0)
 ;I SHOPNULL'="" S ^TMP($J,ENHRTN,"DICT",ENHDICT,"SHOPNULL")=SHOPNULL
"RTN","ENH6911",109,0)
 I FREQNULL'="" S ^TMP($J,ENHRTN,"DICT",ENHDICT,"FREQNULL")=FREQNULL
"RTN","ENH6911",110,0)
 I PROCNULL'="" S ^TMP($J,ENHRTN,"DICT",ENHDICT,"PROCNULL")=PROCNULL
"RTN","ENH6911",111,0)
 D PRTSUM
"RTN","ENH6911",112,0)
 Q
"RTN","ENH6911",113,0)
 ;
"RTN","ENH6911",114,0)
PRTSUM ;Print Summary Report
"RTN","ENH6911",115,0)
 U IO
"RTN","ENH6911",116,0)
 I ENHINST D SUMINST^ENH6911M Q:ABORT
"RTN","ENH6911",117,0)
 S (P,L,ABORT)=0
"RTN","ENH6911",118,0)
 S INTCNT=$G(^TMP($J,ENHRTN,"DICT",ENHDICT,"ENTRY"))
"RTN","ENH6911",119,0)
 S ENTRYCT=$G(^TMP($J,ENHRTN,"DICT",ENHDICT,"ENTRY","BRPTR"))
"RTN","ENH6911",120,0)
 S NULLCNT=$G(^TMP($J,ENHRTN,"DICT",ENHDICT,"ENTRY","NULLCT"))
"RTN","ENH6911",121,0)
 S CRITCNT=$G(^TMP($J,ENHRTN,"DICT",ENHDICT,"ENTRY","CRITCT"))
"RTN","ENH6911",122,0)
 S PROCCT=$G(^TMP($J,ENHRTN,"DICT",ENHDICT,"PROC"))
"RTN","ENH6911",123,0)
 S TECHCT=$G(^TMP($J,ENHRTN,"DICT",ENHDICT,"TECH"))
"RTN","ENH6911",124,0)
 S SHOPCT=$G(^TMP($J,ENHRTN,"DICT",ENHDICT,"RESSHOP"))
"RTN","ENH6911",125,0)
 S PROCNULL=$G(^TMP($J,ENHRTN,"DICT",ENHDICT,"PROCNULL"))
"RTN","ENH6911",126,0)
 S TECHNULL=$G(^TMP($J,ENHRTN,"DICT",ENHDICT,"TECHNULL"))
"RTN","ENH6911",127,0)
 S SHOPNULL=$G(^TMP($J,ENHRTN,"DICT",ENHDICT,"SHOPNULL"))
"RTN","ENH6911",128,0)
 S FREQNULL=$G(^TMP($J,ENHRTN,"DICT",ENHDICT,"FREQNULL"))
"RTN","ENH6911",129,0)
 S NAMENULL=$G(^TMP($J,ENHRTN,"DICT",ENHDICT,"NAMENULL"))
"RTN","ENH6911",130,0)
 D HDR Q:ABORT
"RTN","ENH6911",131,0)
 W !!,"Totals for entire file",!
"RTN","ENH6911",132,0)
 F I=1:1:65 W "-"
"RTN","ENH6911",133,0)
 W !,"Total records analyzed"
"RTN","ENH6911",134,0)
 W ?55,$J(INTCNT,7,0)
"RTN","ENH6911",135,0)
 W !,"Total records with Required Fields Missing Data"
"RTN","ENH6911",136,0)
 W ?55,$J(CRITCNT,7,0)
"RTN","ENH6911",137,0)
 W !,"Total records with Lookup Fields w/ Invalid Data"
"RTN","ENH6911",138,0)
 W ?55,$J(ENTRYCT,7,0)
"RTN","ENH6911",139,0)
 W !,"Total records with Non-required Fields Missing Data"
"RTN","ENH6911",140,0)
 W ?55,$J(NULLCNT,7,0)
"RTN","ENH6911",141,0)
 W !!,"DATA QUALITY",?15,"FIELD",?31,"REQUIRED FIELDS",?48,"LOOKUP FIELDS",?65,"NON-REQ. FIELDS"
"RTN","ENH6911",142,0)
 W !,"CHECK TYPE",?15,"NAME",?31,"MISSING DATA",?48,"W/ INVALID DATA",?65,"MISSING DATA"
"RTN","ENH6911",143,0)
 W !
"RTN","ENH6911",144,0)
 F I=1:1:80 D
"RTN","ENH6911",145,0)
 . W "="
"RTN","ENH6911",146,0)
 W !,"NREQ",?15,"Frequency",?36,"N/A",?52,"N/A",?70,$J(FREQNULL,3,0)
"RTN","ENH6911",147,0)
 W !,"REQ",?15,"Name",?36,$J(NAMENULL,3,0),?52,"N/A",?70,"N/A"
"RTN","ENH6911",148,0)
 W !,"INV,NREQ",?15,"Procedure",?36,"N/A",?52,$J(PROCCT,3,0),?70,$J(PROCNULL,3,0)
"RTN","ENH6911",149,0)
 W !,"INV",?15,"Responsible Shop",?36,"N/A",?52,$J(SHOPCT,3,0),?70,"N/A"
"RTN","ENH6911",150,0)
 W !,"INV, NREQ",?15,"Technician",?36,"N/A",?52,$J(TECHCT,3,0),?70,$J(TECHNULL,3,0)
"RTN","ENH6911",151,0)
 W !
"RTN","ENH6911",152,0)
 D PRT1
"RTN","ENH6911",153,0)
 Q
"RTN","ENH6911",154,0)
 ;
"RTN","ENH6911",155,0)
PRT1 ; Report completed
"RTN","ENH6911",156,0)
 I 'ABORT W !!,"<End of Report>" I $E(IOST,1,2)="C-" W " Enter RETURN to continue" R Y:DTIME
"RTN","ENH6911",157,0)
 I ABORT W !,"<Report Aborted>"
"RTN","ENH6911",158,0)
 D ^%ZISC
"RTN","ENH6911",159,0)
 K L,P,X,Y
"RTN","ENH6911",160,0)
 I $D(ZTQUEUED) S ZTREQ="@"
"RTN","ENH6911",161,0)
 Q
"RTN","ENH6911",162,0)
HDR ; Print the standard report header.
"RTN","ENH6911",163,0)
 ; Do not ask 'RETURN' before first page on CRT.
"RTN","ENH6911",164,0)
 I $E(IOST,1,2)="C-",P R !!,"Enter RETURN to continue or '^' to exit:  ",Y:DTIME I '$T!(Y[U) S ABORT=1 Q
"RTN","ENH6911",165,0)
 ; Do not print a form feed before first page on printer. Top of form is set at end of previous report.
"RTN","ENH6911",166,0)
 I $E(IOST,1,2)="C-"!P W @IOF
"RTN","ENH6911",167,0)
 S P=P+1,L=3
"RTN","ENH6911",168,0)
 W !,"EQUIPMENT CATEGORY (#6911) - SUMMARY",?67,"Page: ",$J(P,5,0)
"RTN","ENH6911",169,0)
 W !,"CoreFLS Data Cleansing Report",?58,"Printed: ",$$FMTE^XLFDT(DT)
"RTN","ENH6911",170,0)
 W !
"RTN","ENH6911",171,0)
 Q
"RTN","ENH6911",172,0)
 ;
"RTN","ENH6911",173,0)
DEVICE ; Ask the user for a device to print to (queuing is allowed).
"RTN","ENH6911",174,0)
 S %ZIS="Q"
"RTN","ENH6911",175,0)
 W !
"RTN","ENH6911",176,0)
 D ^%ZIS I POP S ABORT=1 Q
"RTN","ENH6911",177,0)
 ;User has decided to Queue report
"RTN","ENH6911",178,0)
 I $D(IO("Q")) D  Q
"RTN","ENH6911",179,0)
 . S ZTSAVE("ENHDET")="",ZTSAVE("ENHSUM")="",ZTSAVE("ENHRTN")=""
"RTN","ENH6911",180,0)
 . S ZTSAVE("ENHDICT")="",ZTSAVE("ENHFIRST")="",ZTSAVE("ENHLAST")=""
"RTN","ENH6911",181,0)
 . S ZTSAVE("ENHINST")="",ZTSAVE("ENHRPT")=""
"RTN","ENH6911",182,0)
 . S ZTRTN=PRTRTN,ZTDESC="CoreFLS Data Cleansing Report (File# 6911 - EQUIPMENT CATEGORY)"
"RTN","ENH6911",183,0)
 . D ^%ZTLOAD,HOME^%ZIS
"RTN","ENH6911",184,0)
 . K ZTSK,ZTSAVE,ZTRTN,ZTDESC
"RTN","ENH6911",185,0)
 D @PRTRTN
"RTN","ENH6911",186,0)
 Q
"RTN","ENH6911",187,0)
 ;
"RTN","ENH6911",188,0)
EXIT ; Make sure all the variables get killed.
"RTN","ENH6911",189,0)
 K ^TMP($J,ENHRTN),NAME,NAMENULL,FIRST,LAST,ENHRPT
"RTN","ENH6911",190,0)
 K SHOPNULL,TECHNULL,PROCNULL,PROCCT,TECHCT,SHOPCT,TECH,PROC,RESSHOP
"RTN","ENH6911",191,0)
 K NULLCNT,LOCNAME,DFILE,SHOP,TOTENT,BADCNT,FLAG,NULLFLG,POP,INT,INTCNT
"RTN","ENH6911",192,0)
 K ENTRY,ENTRYCT,ENHMNU2,ENHHELP2,ENHSUM,ENHDET,ENHRTN,ENHDICT,ENHHDR
"RTN","ENH6911",193,0)
 K HEAD1,HEAD2,HEAD3,DATA1,DATA2,MULT,MULT2,FIELD,ENHFIRST,ENHLAST,X,I
"RTN","ENH6911",194,0)
 K DTOUT,DUOUT,HEAD,INSHDR,NULLCTR,PRTRTN,PTR,P,L,ABORT,%ZIS,%Y,%
"RTN","ENH6911",195,0)
 K FLDNAME,RECIEN,FREQ,FREQNULL,CRITCNT,CRITCT,CRITCTR,CRITFLG,ENHINST
"RTN","ENH6911",196,0)
 Q
"RTN","ENH6911C")
0^2^B37141859
"RTN","ENH6911C",1,0)
ENH6911C ;WOIFO/TAW/EEN - Compile Data for Equipment Category Field Detail Reports ;09/24/03 13:44
"RTN","ENH6911C",2,0)
 ;;7.0;ENGINEERING;**74**;Aug 17, 1993
"RTN","ENH6911C",3,0)
 ;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","ENH6911C",4,0)
 ;
"RTN","ENH6911C",5,0)
 Q  ;this routine is not callable from the top
"RTN","ENH6911C",6,0)
 ;
"RTN","ENH6911C",7,0)
 ; This routine allows a selection of Equipment Category range
"RTN","ENH6911C",8,0)
 ; and compiles the error list for any of the detailed reports
"RTN","ENH6911C",9,0)
 ;
"RTN","ENH6911C",10,0)
LOCSEL ;Select a range to analyze
"RTN","ENH6911C",11,0)
 I ENHRPT=2 D  Q
"RTN","ENH6911C",12,0)
 . S ENHFIRST=" ",ENHLAST="zzzzzzzzzzzzzzzzzzzz"
"RTN","ENH6911C",13,0)
 W !!,"Select the range of Equipment Category names to Report",!
"RTN","ENH6911C",14,0)
 S DIR(0)="F^1:50"
"RTN","ENH6911C",15,0)
 S DIR("?")=" "
"RTN","ENH6911C",16,0)
 S DIR("?",1)="To limit the list of category names, press <Enter> to default to the beginning"
"RTN","ENH6911C",17,0)
 S DIR("?",2)="category name in the file, or type in the first few letters of the beginning"
"RTN","ENH6911C",18,0)
 S DIR("?",3)="name with which you want to start the filter. (Type ""ZZ no name"" to display"
"RTN","ENH6911C",19,0)
 S DIR("?",4)="equipment category items with empty name fields.)"
"RTN","ENH6911C",20,0)
 S DIR("?",5)=" "
"RTN","ENH6911C",21,0)
 S DIR("?",6)="     ENTRY MUST BE 1-50 CHARACTERS IN LENGTH AND CONTAIN NO COMMAS (,)"
"RTN","ENH6911C",22,0)
 S DIR("A")="START WITH NAME"
"RTN","ENH6911C",23,0)
 S DIR("B")="FIRST"
"RTN","ENH6911C",24,0)
 D ^DIR K DIR
"RTN","ENH6911C",25,0)
 I Y[U!$D(DTOUT)!$D(DUOUT) S ABORT=1 Q
"RTN","ENH6911C",26,0)
 S ENHFIRST=Y
"RTN","ENH6911C",27,0)
 I Y="FIRST" S ENHFIRST=" "
"RTN","ENH6911C",28,0)
LAST S DIR(0)="F^1:50"
"RTN","ENH6911C",29,0)
 S DIR("?")=" "
"RTN","ENH6911C",30,0)
 S DIR("?",1)="To limit the list of category names, press <Enter> to default to the ending"
"RTN","ENH6911C",31,0)
 S DIR("?",2)="category name in the file, or type in the first few letters of the ending name"
"RTN","ENH6911C",32,0)
 S DIR("?",3)="with which you want to end the filter. (Type ""ZZ no name"" to display equipment"
"RTN","ENH6911C",33,0)
 S DIR("?",4)="category items with empty name fields.)"
"RTN","ENH6911C",34,0)
 S DIR("?",5)=" "
"RTN","ENH6911C",35,0)
 S DIR("?",6)="     ENTRY MUST BE 1-50 CHARACTERS IN LENGTH AND CONTAIN NO COMMAS(,)"
"RTN","ENH6911C",36,0)
 S DIR("A")="GO TO NAME"
"RTN","ENH6911C",37,0)
 S DIR("B")="LAST"
"RTN","ENH6911C",38,0)
 D ^DIR K DIR
"RTN","ENH6911C",39,0)
 I Y[U!$D(DTOUT)!$D(DUOUT) S ABORT=1 Q
"RTN","ENH6911C",40,0)
 S ENHLAST=Y
"RTN","ENH6911C",41,0)
 I Y="LAST" S ENHLAST="zzzzzzzzzzzzzzzzzzzz"
"RTN","ENH6911C",42,0)
 I ENHFIRST]ENHLAST W !,"  LAST ENTRY MUST BE GREATER THAN FIRST ENTRY" G LAST
"RTN","ENH6911C",43,0)
 Q
"RTN","ENH6911C",44,0)
 ;
"RTN","ENH6911C",45,0)
FLDSORT ;Critical Fields Null Report
"RTN","ENH6911C",46,0)
 S (INTCNT,NULLCNT,NULLREC,NULLFLG,INT)=0
"RTN","ENH6911C",47,0)
 I $E(IOST,1,2)="C-" D WAIT^DICD
"RTN","ENH6911C",48,0)
 F  S INT=$O(^ENG(6911,INT)) Q:'INT  D
"RTN","ENH6911C",49,0)
 . S (NULLFLG,MULT,MULT2)=0
"RTN","ENH6911C",50,0)
 . S LOCNAME=$P($G(^ENG(6911,INT,0)),U,1)
"RTN","ENH6911C",51,0)
 . I LOCNAME="" S LOCNAME="ZZ no name"
"RTN","ENH6911C",52,0)
 . I (LOCNAME=ENHFIRST)!(LOCNAME]ENHFIRST) D
"RTN","ENH6911C",53,0)
 .. I (LOCNAME]ENHLAST) Q
"RTN","ENH6911C",54,0)
 .. S INTCNT=INTCNT+1
"RTN","ENH6911C",55,0)
 .. I LOCNAME="ZZ no name" D
"RTN","ENH6911C",56,0)
 ... S ^TMP($J,ENHRTN,"FLD",LOCNAME,INT,"NAME",MULT)=INT_U_"Name"
"RTN","ENH6911C",57,0)
 ... S NULLFLG=1,NULLCNT=NULLCNT+1
"RTN","ENH6911C",58,0)
 . I NULLFLG=1 S NULLREC=NULLREC+1
"RTN","ENH6911C",59,0)
 S ^TMP($J,ENHRTN,ENHDICT,"TOT CRIT FIELDS")=NULLCNT
"RTN","ENH6911C",60,0)
 S ^TMP($J,ENHRTN,ENHDICT,"TOT CRIT REC")=NULLREC
"RTN","ENH6911C",61,0)
 S ^TMP($J,ENHRTN,ENHDICT,"TOTAL COUNT")=INTCNT
"RTN","ENH6911C",62,0)
 D PRTFLD^ENH6911D
"RTN","ENH6911C",63,0)
 Q
"RTN","ENH6911C",64,0)
 ;
"RTN","ENH6911C",65,0)
ESORT ;Sort for Broken Pointers Only report
"RTN","ENH6911C",66,0)
 S (BADCNT,TOTBAD,INTCNT,PROC,TECH,SHOP,MULT,INT)=0
"RTN","ENH6911C",67,0)
 I $E(IOST,1,2)="C-" D WAIT^DICD
"RTN","ENH6911C",68,0)
 F  S INT=$O(^ENG(6911,INT)) Q:'INT  D
"RTN","ENH6911C",69,0)
 . S FLAG=""
"RTN","ENH6911C",70,0)
 . S LOCNAME=$P($G(^ENG(6911,INT,0)),U,1)
"RTN","ENH6911C",71,0)
 . I LOCNAME="" S LOCNAME="ZZ no name"
"RTN","ENH6911C",72,0)
 . I (LOCNAME=ENHFIRST)!(LOCNAME]ENHFIRST) D
"RTN","ENH6911C",73,0)
 .. I (LOCNAME]ENHLAST) Q
"RTN","ENH6911C",74,0)
 .. S INTCNT=INTCNT+1
"RTN","ENH6911C",75,0)
 .. D SORT
"RTN","ENH6911C",76,0)
 .. I FLAG=1 S TOTBAD=TOTBAD+1
"RTN","ENH6911C",77,0)
 S ^TMP($J,ENHRTN,ENHDICT,"TOTAL COUNT")=INTCNT
"RTN","ENH6911C",78,0)
 S ^TMP($J,ENHRTN,ENHDICT,"BAD PTR COUNT")=BADCNT
"RTN","ENH6911C",79,0)
 S ^TMP($J,ENHRTN,ENHDICT,"TOT BAD REC")=TOTBAD
"RTN","ENH6911C",80,0)
 D EQUIPRT^ENH6911D
"RTN","ENH6911C",81,0)
 Q
"RTN","ENH6911C",82,0)
 ;
"RTN","ENH6911C",83,0)
SORT ;Find all records with broken pointers for report
"RTN","ENH6911C",84,0)
 I '$D(^ENG(6911,INT,4)) Q
"RTN","ENH6911C",85,0)
 S MULT=0
"RTN","ENH6911C",86,0)
 F  S MULT=$O(^ENG(6911,INT,4,MULT)) Q:'MULT  D
"RTN","ENH6911C",87,0)
 . S DATA1=$G(^ENG(6911,INT,4,MULT,0))
"RTN","ENH6911C",88,0)
 . S SHOP=$P(DATA1,U,1)
"RTN","ENH6911C",89,0)
 . S TECH=$P(DATA1,U,2)
"RTN","ENH6911C",90,0)
 . I SHOP'="" D
"RTN","ENH6911C",91,0)
 .. I '$D(^DIC(6922,SHOP))!($P($G(^DIC(6922,SHOP,0)),U,1)="") D  Q
"RTN","ENH6911C",92,0)
 ... S BADCNT=BADCNT+1 S FLAG=1
"RTN","ENH6911C",93,0)
 ... S ^TMP($J,ENHRTN,"FLD",LOCNAME,INT,"SHOP",MULT)=INT_U_"Responsible Shop"_U_MULT
"RTN","ENH6911C",94,0)
 . I TECH'="" D
"RTN","ENH6911C",95,0)
 .. I '$D(^ENG("EMP",TECH))!($P($G(^ENG("EMP",TECH,0)),U,1)="") D  Q
"RTN","ENH6911C",96,0)
 ... S BADCNT=BADCNT+1 S FLAG=1
"RTN","ENH6911C",97,0)
 ... S ^TMP($J,ENHRTN,"FLD",LOCNAME,INT,"TECH",MULT)=INT_U_"Technician"_U_MULT
"RTN","ENH6911C",98,0)
 . S MULT2=0
"RTN","ENH6911C",99,0)
 . F  S MULT2=$O(^ENG(6911,INT,4,MULT,2,MULT2)) Q:'MULT2  D
"RTN","ENH6911C",100,0)
 .. S DATA2=$G(^ENG(6911,INT,4,MULT,2,MULT2,0))
"RTN","ENH6911C",101,0)
 .. S PROC=$P(DATA2,U,5)
"RTN","ENH6911C",102,0)
 .. I PROC'="" D
"RTN","ENH6911C",103,0)
 ... I '$D(^ENG(6914.2,PROC))!($P($G(^ENG(6914.2,PROC,0)),U,1)="") D  Q
"RTN","ENH6911C",104,0)
 .... S BADCNT=BADCNT+1 S FLAG=1
"RTN","ENH6911C",105,0)
 .... S ^TMP($J,ENHRTN,"FLD",LOCNAME,INT,"PROC",MULT,MULT2)=INT_U_"Procedure"_U_MULT_","_MULT2
"RTN","ENH6911C",106,0)
 Q
"RTN","ENH6911C",107,0)
 ;
"RTN","ENH6911C",108,0)
ALLSORT ;Sort for desirable Null Detail Report
"RTN","ENH6911C",109,0)
 S (PROC,TECH,SHOP,NULLCNT,NULLREC,INTCNT,INT)=0
"RTN","ENH6911C",110,0)
 I $E(IOST,1,2)="C-" D WAIT^DICD
"RTN","ENH6911C",111,0)
 F  S INT=$O(^ENG(6911,INT)) Q:'INT  D
"RTN","ENH6911C",112,0)
 . S (MULT,MULT2,NULLFLG)=0
"RTN","ENH6911C",113,0)
 . S LOCNAME=$P($G(^ENG(6911,INT,0)),U,1)
"RTN","ENH6911C",114,0)
 . I LOCNAME="" S LOCNAME="ZZ no name"
"RTN","ENH6911C",115,0)
 . I (LOCNAME=ENHFIRST)!(LOCNAME]ENHFIRST) D
"RTN","ENH6911C",116,0)
 .. I (LOCNAME]ENHLAST) Q
"RTN","ENH6911C",117,0)
 .. S INTCNT=INTCNT+1
"RTN","ENH6911C",118,0)
 .. S DATA1=$G(^ENG(6911,INT,4,0))
"RTN","ENH6911C",119,0)
 .. I '$D(DATA1)!($P(DATA1,U,4)=0)!($P(DATA1,U,4)="") Q  ;DO NOT LOOK AT NULL RESPONSIBLE SHOPS
"RTN","ENH6911C",120,0)
 .. S MULT=0
"RTN","ENH6911C",121,0)
 .. F  S MULT=$O(^ENG(6911,INT,4,MULT)) Q:'MULT  D
"RTN","ENH6911C",122,0)
 ... S DATA1=$G(^ENG(6911,INT,4,MULT,0))
"RTN","ENH6911C",123,0)
 ... S TECH=$P(DATA1,U,2)
"RTN","ENH6911C",124,0)
 ... I TECH="" D
"RTN","ENH6911C",125,0)
 .... S NULLFLG=1 S NULLCNT=NULLCNT+1
"RTN","ENH6911C",126,0)
 .... S ^TMP($J,ENHRTN,"FLD",LOCNAME,INT,"TECH",MULT)=INT_U_"Technician"_U_MULT
"RTN","ENH6911C",127,0)
 ... S DATA2=$G(^ENG(6911,INT,4,MULT,2,0))
"RTN","ENH6911C",128,0)
 ... I '$D(DATA2)!($P(DATA2,U,4)=0)!($P(DATA2,U,4)="") D  Q
"RTN","ENH6911C",129,0)
 .... S ^TMP($J,ENHRTN,"FLD",LOCNAME,INT,"FREQ",MULT,0)=INT_U_"Frequency"_U_MULT
"RTN","ENH6911C",130,0)
 .... S ^TMP($J,ENHRTN,"FLD",LOCNAME,INT,"PROC",MULT,0)=INT_U_"Procedure"_U_MULT
"RTN","ENH6911C",131,0)
 .... S NULLFLG=1,NULLCNT=NULLCNT+2
"RTN","ENH6911C",132,0)
 ... S MULT2=0
"RTN","ENH6911C",133,0)
 ... F  S MULT2=$O(^ENG(6911,INT,4,MULT,2,MULT2)) Q:'MULT2  D
"RTN","ENH6911C",134,0)
 .... S DATA2=$G(^ENG(6911,INT,4,MULT,2,MULT2,0))
"RTN","ENH6911C",135,0)
 .... S FREQ=$P(DATA2,U,1)
"RTN","ENH6911C",136,0)
 .... I FREQ="" D
"RTN","ENH6911C",137,0)
 ..... S ^TMP($J,ENHRTN,"FLD",LOCNAME,INT,"FREQ",MULT,MULT2)=INT_U_"Frequency"_U_MULT_","_MULT2
"RTN","ENH6911C",138,0)
 ..... S NULLFLG=1,NULLCNT=NULLCNT+1
"RTN","ENH6911C",139,0)
 .... S PROC=$P(DATA2,U,5)
"RTN","ENH6911C",140,0)
 .... I PROC="" D
"RTN","ENH6911C",141,0)
 ..... S ^TMP($J,ENHRTN,"FLD",LOCNAME,INT,"PROC",MULT,MULT2)=INT_U_"Procedure"_U_MULT_","_MULT2
"RTN","ENH6911C",142,0)
 ..... S NULLFLG=1,NULLCNT=NULLCNT+1
"RTN","ENH6911C",143,0)
 . I NULLFLG=1 S NULLREC=NULLREC+1
"RTN","ENH6911C",144,0)
 S ^TMP($J,ENHRTN,ENHDICT,"TOT NULL FIELDS")=NULLCNT
"RTN","ENH6911C",145,0)
 S ^TMP($J,ENHRTN,ENHDICT,"TOT NULL REC")=NULLREC
"RTN","ENH6911C",146,0)
 S ^TMP($J,ENHRTN,ENHDICT,"TOTAL COUNT")=INTCNT
"RTN","ENH6911C",147,0)
 D BOTH^ENH6911D
"RTN","ENH6911C",148,0)
 Q
"RTN","ENH6911D")
0^3^B64467499
"RTN","ENH6911D",1,0)
ENH6911D ;WOIFO/TAW/EEN - Select and Print Equipment Category Detail Reports ;09/24/03 13:44
"RTN","ENH6911D",2,0)
 ;;7.0;ENGINEERING;**74**;Aug 17, 1993
"RTN","ENH6911D",3,0)
 ;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","ENH6911D",4,0)
 ;
"RTN","ENH6911D",5,0)
 Q  ;this routine is not callable from the top
"RTN","ENH6911D",6,0)
 ;
"RTN","ENH6911D",7,0)
 ;This routine prints any of the detailed reports
"RTN","ENH6911D",8,0)
 ;
"RTN","ENH6911D",9,0)
 ;
"RTN","ENH6911D",10,0)
PRTFLD ;Print the Critical NULLS report
"RTN","ENH6911D",11,0)
 U IO
"RTN","ENH6911D",12,0)
 I ENHINST D FLDINST^ENH6911F Q:ABORT
"RTN","ENH6911D",13,0)
 S (P,L,ABORT,TOTREC,NULLREC,NULLFLD,HEADFLG)=0
"RTN","ENH6911D",14,0)
 S FIRST=ENHFIRST,LAST=ENHLAST
"RTN","ENH6911D",15,0)
 I FIRST=" " S FIRST="FIRST"
"RTN","ENH6911D",16,0)
 I LAST="zzzzzzzzzzzzzzzzzzzz" S LAST="LAST"
"RTN","ENH6911D",17,0)
 D HDR Q:ABORT
"RTN","ENH6911D",18,0)
 I $G(^TMP($J,ENHRTN,ENHDICT,"TOT CRIT REC"))=0 D  Q
"RTN","ENH6911D",19,0)
 . S TOTREC=$G(^TMP($J,ENHRTN,ENHDICT,"TOTAL COUNT"))
"RTN","ENH6911D",20,0)
 . W !!,"Totals for the entire file" ;,FIRST," to ",LAST,!
"RTN","ENH6911D",21,0)
 . W ! F I=1:1:65 W "-"
"RTN","ENH6911D",22,0)
 . W !,"Total records analyzed",?55,$J(TOTREC,5,0)
"RTN","ENH6911D",23,0)
 . W !,"Total records with Required Fields Missing Data",?55,$J(NULLREC,5,0)
"RTN","ENH6911D",24,0)
 . W !,"Total fields with Required Fields Missing Data",?55,$J(NULLFLD,5,0)
"RTN","ENH6911D",25,0)
 . D HEAD1 W !!,"** NO DATA TO PRINT **"
"RTN","ENH6911D",26,0)
 . D PRT1
"RTN","ENH6911D",27,0)
 S TOTREC=$G(^TMP($J,ENHRTN,ENHDICT,"TOTAL COUNT"))
"RTN","ENH6911D",28,0)
 S NULLFLD=$G(^TMP($J,ENHRTN,ENHDICT,"TOT CRIT FIELDS"))
"RTN","ENH6911D",29,0)
 S NULLREC=$G(^TMP($J,ENHRTN,ENHDICT,"TOT CRIT REC"))
"RTN","ENH6911D",30,0)
 W !!,"Totals for the entire file" ;,FIRST," to ",LAST,!
"RTN","ENH6911D",31,0)
 W ! F I=1:1:65 W "-"
"RTN","ENH6911D",32,0)
 W !,"Total records analyzed",?55,$J(TOTREC,5,0)
"RTN","ENH6911D",33,0)
 W !,"Total records with Required Fields Missing Data",?55,$J(NULLREC,5,0)
"RTN","ENH6911D",34,0)
 W !,"Total fields with Required Fields Missing Data",?55,$J(NULLFLD,5,0)
"RTN","ENH6911D",35,0)
 S L=L+6
"RTN","ENH6911D",36,0)
 S HEADFLG=1
"RTN","ENH6911D",37,0)
 D HEAD1
"RTN","ENH6911D",38,0)
 S LOCNAME=""
"RTN","ENH6911D",39,0)
 F  S LOCNAME=$O(^TMP($J,ENHRTN,"FLD",LOCNAME)) Q:LOCNAME=""  D  Q:ABORT
"RTN","ENH6911D",40,0)
 . I LOCNAME]ENHLAST!(ENHFIRST]LOCNAME) Q  ; DO NOT PRINT IF NOT PICKED
"RTN","ENH6911D",41,0)
 . S INT=0
"RTN","ENH6911D",42,0)
 . F  S INT=$O(^TMP($J,ENHRTN,"FLD",LOCNAME,INT)) Q:'INT  D  Q:ABORT
"RTN","ENH6911D",43,0)
 .. I L+4>IOSL D HDR Q:ABORT
"RTN","ENH6911D",44,0)
 .. S FIELD=""
"RTN","ENH6911D",45,0)
 .. F  S FIELD=$O(^TMP($J,ENHRTN,"FLD",LOCNAME,INT,FIELD)) Q:FIELD=""  D
"RTN","ENH6911D",46,0)
 ... I L+4>IOSL D HDR Q:ABORT
"RTN","ENH6911D",47,0)
 ... S MULT=""
"RTN","ENH6911D",48,0)
 ... F  S MULT=$O(^TMP($J,ENHRTN,"FLD",LOCNAME,INT,FIELD,MULT)) Q:MULT=""  D  Q:ABORT
"RTN","ENH6911D",49,0)
 .... I L+4>IOSL D HDR Q:ABORT
"RTN","ENH6911D",50,0)
 .... I FIELD="FREQ"!(FIELD="PROC") D MULT2 Q
"RTN","ENH6911D",51,0)
 .... S DATA=$G(^TMP($J,ENHRTN,"FLD",LOCNAME,INT,FIELD,MULT))
"RTN","ENH6911D",52,0)
 .... S RECIEN=$P(DATA,U,1),FLDNAME=$P(DATA,U,2),SUB=$P(DATA,U,3)
"RTN","ENH6911D",53,0)
 .... W !,$J(RECIEN,8,0),?10,$E(LOCNAME,1,29),?40,FLDNAME
"RTN","ENH6911D",54,0)
 .... S L=L+1
"RTN","ENH6911D",55,0)
 D PRT1
"RTN","ENH6911D",56,0)
 Q
"RTN","ENH6911D",57,0)
 ;
"RTN","ENH6911D",58,0)
EQUIPRT ;Print the Broken Pointers report
"RTN","ENH6911D",59,0)
 U IO
"RTN","ENH6911D",60,0)
 I ENHINST D ENTINST^ENH6911F Q:ABORT
"RTN","ENH6911D",61,0)
 S (P,L,ABORT,HEADFLG)=0
"RTN","ENH6911D",62,0)
 S (PROC,TECH,SHOP,TOTREC,BADREC,BADFLD)="",FIRST=ENHFIRST,LAST=ENHLAST
"RTN","ENH6911D",63,0)
 I FIRST=" " S FIRST="FIRST"
"RTN","ENH6911D",64,0)
 I LAST="zzzzzzzzzzzzzzzzzzzz" S LAST="LAST"
"RTN","ENH6911D",65,0)
 D HDR Q:ABORT
"RTN","ENH6911D",66,0)
 I $G(^TMP($J,ENHRTN,ENHDICT,"TOT BAD REC"))=0 D  Q
"RTN","ENH6911D",67,0)
 . S TOTREC=$G(^TMP($J,ENHRTN,ENHDICT,"TOTAL COUNT"))
"RTN","ENH6911D",68,0)
 . W !!,"Totals for records ",FIRST," to ",LAST,!
"RTN","ENH6911D",69,0)
 . F I=1:1:65 W "-"
"RTN","ENH6911D",70,0)
 . W !,"Total records analyzed",?55,$J(TOTREC,5,0)
"RTN","ENH6911D",71,0)
 . W !,"Total records with Lookup Fields w/ Invalid Data",?55,$J(BADREC,5,0)
"RTN","ENH6911D",72,0)
 . W !,"Total fields with Lookup Fields w/ Invalid Data",?55,$J(BADFLD,5,0)
"RTN","ENH6911D",73,0)
 . D HEAD1 W !!,"** NO DATA TO PRINT **"
"RTN","ENH6911D",74,0)
 . D PRT1
"RTN","ENH6911D",75,0)
 S TOTREC=$G(^TMP($J,ENHRTN,ENHDICT,"TOTAL COUNT"))
"RTN","ENH6911D",76,0)
 S BADFLD=$G(^TMP($J,ENHRTN,ENHDICT,"BAD PTR COUNT"))
"RTN","ENH6911D",77,0)
 S BADREC=$G(^TMP($J,ENHRTN,ENHDICT,"TOT BAD REC"))
"RTN","ENH6911D",78,0)
 W !!,"Totals for records ",FIRST," to ",LAST,!
"RTN","ENH6911D",79,0)
 F I=1:1:65 W "-"
"RTN","ENH6911D",80,0)
 W !,"Total records analyzed",?55,$J(TOTREC,5,0)
"RTN","ENH6911D",81,0)
 W !,"Total records with Lookup Fields w/ Invalid Data",?55,$J(BADREC,5,0)
"RTN","ENH6911D",82,0)
 W !,"Total fields with Lookup Fields w/ Invalid Data",?55,$J(BADFLD,5,0)
"RTN","ENH6911D",83,0)
 S L=L+6
"RTN","ENH6911D",84,0)
 S HEADFLG=1
"RTN","ENH6911D",85,0)
 D HEAD1
"RTN","ENH6911D",86,0)
 S LOCNAME=""
"RTN","ENH6911D",87,0)
 F  S LOCNAME=$O(^TMP($J,ENHRTN,"FLD",LOCNAME)) Q:LOCNAME=""  D  Q:ABORT
"RTN","ENH6911D",88,0)
 . I LOCNAME]ENHLAST!(ENHFIRST]LOCNAME) Q
"RTN","ENH6911D",89,0)
 . I L+3>IOSL D HDR Q:ABORT
"RTN","ENH6911D",90,0)
 . S INT=0
"RTN","ENH6911D",91,0)
 . F  S INT=$O(^TMP($J,ENHRTN,"FLD",LOCNAME,INT)) Q:'INT  D  Q:ABORT
"RTN","ENH6911D",92,0)
 .. I L+3>IOSL D HDR Q:ABORT
"RTN","ENH6911D",93,0)
 .. S FIELD=""
"RTN","ENH6911D",94,0)
 .. F  S FIELD=$O(^TMP($J,ENHRTN,"FLD",LOCNAME,INT,FIELD)) Q:FIELD=""  D
"RTN","ENH6911D",95,0)
 ... I L+3>IOSL D HDR Q:ABORT
"RTN","ENH6911D",96,0)
 ... S MULT=""
"RTN","ENH6911D",97,0)
 ... F  S MULT=$O(^TMP($J,ENHRTN,"FLD",LOCNAME,INT,FIELD,MULT)) Q:MULT=""  D  Q:ABORT
"RTN","ENH6911D",98,0)
 .... I L+3>IOSL D HDR Q:ABORT
"RTN","ENH6911D",99,0)
 .... I FIELD="PROC"!(FIELD="FREQ") D MULT2 Q
"RTN","ENH6911D",100,0)
 .... S DATA=^TMP($J,ENHRTN,"FLD",LOCNAME,INT,FIELD,MULT)
"RTN","ENH6911D",101,0)
 .... S RECIEN=$P(DATA,U,1),FLDNAME=$P(DATA,U,2),SUB=$P(DATA,U,3)
"RTN","ENH6911D",102,0)
 .... W !,$J(RECIEN,8,0),?10,$E(LOCNAME,1,29),?40,FLDNAME,?72,$J(SUB,3)
"RTN","ENH6911D",103,0)
 .... S L=L+1
"RTN","ENH6911D",104,0)
 D PRT1
"RTN","ENH6911D",105,0)
 Q
"RTN","ENH6911D",106,0)
 ;
"RTN","ENH6911D",107,0)
BOTH ;Print the desirable NULL report
"RTN","ENH6911D",108,0)
 U IO
"RTN","ENH6911D",109,0)
 I ENHINST D BOTHINS^ENH6911I Q:ABORT
"RTN","ENH6911D",110,0)
 S (P,L,ABORT,HEADFLG)=0,FIRST=ENHFIRST,LAST=ENHLAST
"RTN","ENH6911D",111,0)
 S (TOTREC,NULLREC,NULLFLD)=""
"RTN","ENH6911D",112,0)
 I FIRST=" " S FIRST="FIRST"
"RTN","ENH6911D",113,0)
 I LAST="zzzzzzzzzzzzzzzzzzzz" S LAST="LAST"
"RTN","ENH6911D",114,0)
 D HDR Q:ABORT
"RTN","ENH6911D",115,0)
 I $G(^TMP($J,ENHRTN,ENHDICT,"TOT NULL REC"))=0 D  Q
"RTN","ENH6911D",116,0)
 . S TOTREC=$G(^TMP($J,ENHRTN,ENHDICT,"TOTAL COUNT"))
"RTN","ENH6911D",117,0)
 . W !!,"Totals for records ",FIRST," to ",LAST,!
"RTN","ENH6911D",118,0)
 . F I=1:1:65 W "-"
"RTN","ENH6911D",119,0)
 . W !,"Total records analyzed",?55,$J(TOTREC,5,0)
"RTN","ENH6911D",120,0)
 . W !,"Total records with Non-Required Fields Missing Data",?55,$J(NULLREC,5,0)
"RTN","ENH6911D",121,0)
 . W !,"Total fields with Non-Required Fields Missing Data",?55,$J(NULLFLD,5,0)
"RTN","ENH6911D",122,0)
 . D HEAD1 W !!,"** NO DATA TO PRINT **"
"RTN","ENH6911D",123,0)
 . D PRT1
"RTN","ENH6911D",124,0)
 S TOTREC=$G(^TMP($J,ENHRTN,ENHDICT,"TOTAL COUNT"))
"RTN","ENH6911D",125,0)
 S NULLFLD=$G(^TMP($J,ENHRTN,ENHDICT,"TOT NULL FIELDS"))
"RTN","ENH6911D",126,0)
 S NULLREC=$G(^TMP($J,ENHRTN,ENHDICT,"TOT NULL REC"))
"RTN","ENH6911D",127,0)
 W !!,"Totals for records ",FIRST," to ",LAST,!
"RTN","ENH6911D",128,0)
 F I=1:1:65 W "-"
"RTN","ENH6911D",129,0)
 W !,"Total records analyzed",?55,$J(TOTREC,5,0)
"RTN","ENH6911D",130,0)
 W !,"Total records with Non-Required Fields Missing Data",?55,$J(NULLREC,5,0)
"RTN","ENH6911D",131,0)
 W !,"Total fields with Non-Required Fields Missing Data",?55,$J(NULLFLD,5,0)
"RTN","ENH6911D",132,0)
 S L=L+6
"RTN","ENH6911D",133,0)
 S HEADFLG=1
"RTN","ENH6911D",134,0)
 D HEAD1
"RTN","ENH6911D",135,0)
 S LOCNAME=""
"RTN","ENH6911D",136,0)
 F  S LOCNAME=$O(^TMP($J,ENHRTN,"FLD",LOCNAME)) Q:LOCNAME=""  D  Q:ABORT
"RTN","ENH6911D",137,0)
 . I LOCNAME]ENHLAST!(ENHFIRST]LOCNAME) Q
"RTN","ENH6911D",138,0)
 . S INT=0
"RTN","ENH6911D",139,0)
 . F  S INT=$O(^TMP($J,ENHRTN,"FLD",LOCNAME,INT)) Q:'INT  D  Q:ABORT
"RTN","ENH6911D",140,0)
 .. I L+3>IOSL D HDR Q:ABORT
"RTN","ENH6911D",141,0)
 .. S FIELD=""
"RTN","ENH6911D",142,0)
 .. F  S FIELD=$O(^TMP($J,ENHRTN,"FLD",LOCNAME,INT,FIELD)) Q:FIELD=""  D
"RTN","ENH6911D",143,0)
 ... I L+3>IOSL D HDR Q:ABORT
"RTN","ENH6911D",144,0)
 ... S MULT=""
"RTN","ENH6911D",145,0)
 ... F  S MULT=$O(^TMP($J,ENHRTN,"FLD",LOCNAME,INT,FIELD,MULT)) Q:MULT=""  D  Q:ABORT
"RTN","ENH6911D",146,0)
 .... I L+3>IOSL D HDR Q:ABORT
"RTN","ENH6911D",147,0)
 .... I FIELD="PROC"!(FIELD="FREQ") D MULT2 Q
"RTN","ENH6911D",148,0)
 .... S DATA=^TMP($J,ENHRTN,"FLD",LOCNAME,INT,FIELD,MULT)
"RTN","ENH6911D",149,0)
 .... S RECIEN=$P(DATA,U,1),FLDNAME=$P(DATA,U,2),SUB=$P(DATA,U,3)
"RTN","ENH6911D",150,0)
 .... W !,$J(RECIEN,8,0),?10,$E(LOCNAME,1,29),?40,FLDNAME,?72,$J(SUB,3)
"RTN","ENH6911D",151,0)
 .... S L=L+1
"RTN","ENH6911D",152,0)
 D PRT1
"RTN","ENH6911D",153,0)
 Q
"RTN","ENH6911D",154,0)
 ;
"RTN","ENH6911D",155,0)
MULT2 ; Print 2nd level multiples (Responsible Shop/Frequency Multiple)
"RTN","ENH6911D",156,0)
 S MULT2=""
"RTN","ENH6911D",157,0)
 F  S MULT2=$O(^TMP($J,ENHRTN,"FLD",LOCNAME,INT,FIELD,MULT,MULT2)) Q:MULT2=""  D
"RTN","ENH6911D",158,0)
 . S DATA=^TMP($J,ENHRTN,"FLD",LOCNAME,INT,FIELD,MULT,MULT2)
"RTN","ENH6911D",159,0)
 . S RECIEN=$P(DATA,U,1),FLDNAME=$P(DATA,U,2),SUB=$P(DATA,U,3)
"RTN","ENH6911D",160,0)
 . W !,$J(RECIEN,8,0),?10,$E(LOCNAME,1,29),?40,FLDNAME,?72,$J(SUB,3)
"RTN","ENH6911D",161,0)
 . S L=L+1
"RTN","ENH6911D",162,0)
 Q
"RTN","ENH6911D",163,0)
 ;
"RTN","ENH6911D",164,0)
PRT1 ; Report completed
"RTN","ENH6911D",165,0)
 I 'ABORT W !!,"<End of Report>" I $E(IOST,1,2)="C-" W " Enter RETURN to continue" R Y:DTIME
"RTN","ENH6911D",166,0)
 I ABORT W !!,"<Report Aborted>"
"RTN","ENH6911D",167,0)
 D ^%ZISC
"RTN","ENH6911D",168,0)
 K L,P,X,Y
"RTN","ENH6911D",169,0)
 I $D(ZTQUEUED) S ZTREQ="@"
"RTN","ENH6911D",170,0)
 Q
"RTN","ENH6911D",171,0)
HDR ; Print the standard report header for the Detail Report
"RTN","ENH6911D",172,0)
 ; Do not ask 'RETURN' before first page on CRT.
"RTN","ENH6911D",173,0)
 I $E(IOST,1,2)="C-",P R !!,"Enter RETURN to continue or '^' to exit: ",Y:DTIME I '$T!(Y[U) S ABORT=1 Q
"RTN","ENH6911D",174,0)
 ; Do not print a form feed before first page on printer. Top of form is set at end of previous report.
"RTN","ENH6911D",175,0)
 I $E(IOST,1,2)="C-"!P W @IOF
"RTN","ENH6911D",176,0)
 S P=P+1,L=3
"RTN","ENH6911D",177,0)
 I ENHDET=1 S ENHHDR="REQUIRED FIELDS MISSING DATA"
"RTN","ENH6911D",178,0)
 I ENHDET=2 S ENHHDR="LOOKUP FIELDS W/ INVALID DATA"
"RTN","ENH6911D",179,0)
 I ENHDET=3 S ENHHDR="NON-REQUIRED FIELDS MISSING DATA"
"RTN","ENH6911D",180,0)
 W !,"EQUIPMENT CATEGORY (#6911) - ",ENHHDR,?67,"Page: ",$J(P,5,0)
"RTN","ENH6911D",181,0)
 W !,"CoreFLS Data Cleansing Report",?58,"Printed: ",$$FMTE^XLFDT(DT)
"RTN","ENH6911D",182,0)
 I $G(HEADFLG)=1&(ENHRPT'=2) D HEAD2,HEAD1
"RTN","ENH6911D",183,0)
 I $G(HEADFLG)=1&(ENHRPT=2) D HEAD3,HEAD1
"RTN","ENH6911D",184,0)
 Q
"RTN","ENH6911D",185,0)
 ;
"RTN","ENH6911D",186,0)
HEAD1 ;Sub-header for CRITICAL NULLS REPORT (#1)
"RTN","ENH6911D",187,0)
 W !!,"  REC",?10,"EQUIPMENT",?40,"FIELD"
"RTN","ENH6911D",188,0)
 I ENHRPT'=2 W ?70,"MULTIPLE"
"RTN","ENH6911D",189,0)
 W !,"  IEN",?10,"CATEGORY",?40,"NAME"
"RTN","ENH6911D",190,0)
 I ENHRPT'=2 W ?70,"NUMBER"
"RTN","ENH6911D",191,0)
 W ! F I=1:1:80 W "="
"RTN","ENH6911D",192,0)
 S L=L+4
"RTN","ENH6911D",193,0)
 Q
"RTN","ENH6911D",194,0)
 ;
"RTN","ENH6911D",195,0)
HEAD2 ;Sub-header for subsequent pages
"RTN","ENH6911D",196,0)
 W !!,"For records ",FIRST," to ",LAST,!
"RTN","ENH6911D",197,0)
 F I=1:1:65 W "-"
"RTN","ENH6911D",198,0)
 S L=L+3
"RTN","ENH6911D",199,0)
 Q
"RTN","ENH6911D",200,0)
 ;
"RTN","ENH6911D",201,0)
HEAD3 ;Sub-header for subsequent pages for Required Fields report only
"RTN","ENH6911D",202,0)
 W !!,"For the entire file",!
"RTN","ENH6911D",203,0)
 F I=1:1:65 W "-"
"RTN","ENH6911D",204,0)
 S L=L+3
"RTN","ENH6911D",205,0)
 Q
"RTN","ENH6911D",206,0)
 ;
"RTN","ENH6911D",207,0)
EXIT ;Kill all variables before next use
"RTN","ENH6911D",208,0)
 K ^TMP($J,ENHRTN)
"RTN","ENH6911D",209,0)
 K FLDNAME,RECIEN,PROCCT,TECHCT,SHOPCT,TECH,PROC,RESSHOP
"RTN","ENH6911D",210,0)
 K SHOP,TOTENT,TOTBAD,TOTREC,BADCNT,BADFLD,BADREC,BRPTCT,CNULLCT,NULLCNT
"RTN","ENH6911D",211,0)
 K NULLFLD,NULLREC,FLAG,NULLFLG,POP,INT,INTCNT,ENTRYCT,PTRFLD,PTRNUM
"RTN","ENH6911D",212,0)
 K ENHMNU2,ENHMNU4,ENHHELP4,ENHHELP2,ENHSUM,ENHDET,ENHRTN,ENHDICT
"RTN","ENH6911D",213,0)
 K ENHFLD,ENHTAG,ENHHDR,ENHHDR1,ENHCTR,HEADFLG,HEAD1,PTR,X,SUB
"RTN","ENH6911D",214,0)
 K DATA,DATA1,DATA2,MULT,MULT2,ENTRY,LOCNAME,INS,HDR,P,L
"RTN","ENH6911D",215,0)
 K DTOUT,DUOUT,INSHDR,NULLCTR,PRTRTN,%ZIS
"RTN","ENH6911D",216,0)
 Q
"RTN","ENH6911F")
0^4^B65299206
"RTN","ENH6911F",1,0)
ENH6911F ;WOIFO/TAW/EEN - Instructions Pages for Equipment Category by Field Reports ;09/24/03 13:44
"RTN","ENH6911F",2,0)
 ;;7.0;ENGINEERING;**74**;Aug 17, 1993
"RTN","ENH6911F",3,0)
 ;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","ENH6911F",4,0)
 ;
"RTN","ENH6911F",5,0)
 Q  ;this routine is not callable from the top
"RTN","ENH6911F",6,0)
 ;
"RTN","ENH6911F",7,0)
 ;This routine contains instructions for Required Fields Missing Data
"RTN","ENH6911F",8,0)
 ;and Lookup Fields w/ Invalid Data reports.
"RTN","ENH6911F",9,0)
 ;
"RTN","ENH6911F",10,0)
FLDINST ;These are the instructions for the Required Fields Missing Data report
"RTN","ENH6911F",11,0)
 U IO
"RTN","ENH6911F",12,0)
 S (P,L,ABORT)=0
"RTN","ENH6911F",13,0)
 D HDR
"RTN","ENH6911F",14,0)
 W !!,"The purpose of this report is to display a list of all EQUIPMENT CATEGORY"
"RTN","ENH6911F",15,0)
 W !,"(#6911) items with missing (empty) data for the fields that are required in the"
"RTN","ENH6911F",16,0)
 W !,"CoreFLS system.  CoreFLS is unable to function when a required field is empty;"
"RTN","ENH6911F",17,0)
 W !,"therefore, you must enter valid data in these fields prior to conversion."
"RTN","ENH6911F",18,0)
 S L=L+5
"RTN","ENH6911F",19,0)
 I L+5>IOSL D HDR Q:ABORT
"RTN","ENH6911F",20,0)
 W !!,"This report examines the following required field:"
"RTN","ENH6911F",21,0)
 W !,"     NAME (#.01)"
"RTN","ENH6911F",22,0)
 S L=L+3
"RTN","ENH6911F",23,0)
 I L+5>IOSL D HDR Q:ABORT
"RTN","ENH6911F",24,0)
 W !!,"The NAME (#.01) field of each Equipment Category record is examined. If the"
"RTN","ENH6911F",25,0)
 W !,"field is empty, the record is placed on this report."
"RTN","ENH6911F",26,0)
 S L=L+3
"RTN","ENH6911F",27,0)
 I L+4>IOSL D HDR Q:ABORT
"RTN","ENH6911F",28,0)
 W !!,"The totals for the report are as follows:"
"RTN","ENH6911F",29,0)
 S L=L+2
"RTN","ENH6911F",30,0)
 I L+5>IOSL D HDR Q:ABORT
"RTN","ENH6911F",31,0)
 W !!,"Total records analyzed - number of records in the EQUIPMENT CATEGORY"
"RTN","ENH6911F",32,0)
 W !,"     (#6911) file"
"RTN","ENH6911F",33,0)
 S L=L+3
"RTN","ENH6911F",34,0)
 I L+5>IOSL D HDR Q:ABORT
"RTN","ENH6911F",35,0)
 W !!,"Total records with Required Fields Missing Data - number of records that have"
"RTN","ENH6911F",36,0)
 W !,"     an empty required field"
"RTN","ENH6911F",37,0)
 S L=L+3
"RTN","ENH6911F",38,0)
 I L+5>IOSL D HDR Q:ABORT
"RTN","ENH6911F",39,0)
 W !!,"Total fields with Required Fields Missing Data - number of required fields"
"RTN","ENH6911F",40,0)
 W !,"     that are empty"
"RTN","ENH6911F",41,0)
 S L=L+3
"RTN","ENH6911F",42,0)
 I L+5>IOSL D HDR Q:ABORT
"RTN","ENH6911F",43,0)
 W !!,"The report lists each record in order by its internal entry number (IEN)."
"RTN","ENH6911F",44,0)
 W !,"Each row on the report contains the following columns:"
"RTN","ENH6911F",45,0)
 S L=L+3
"RTN","ENH6911F",46,0)
 I L+4>IOSL D HDR Q:ABORT
"RTN","ENH6911F",47,0)
 W !!,"REC IEN - lists the EQUIPMENT CATEGORY (#6911) file internal record number"
"RTN","ENH6911F",48,0)
 S L=L+2
"RTN","ENH6911F",49,0)
 I L+5>IOSL D HDR Q:ABORT
"RTN","ENH6911F",50,0)
 W !!,"EQUIPMENT CATEGORY - listed as ""ZZ no name"" since there is no entry in the"
"RTN","ENH6911F",51,0)
 W !,"     NAME (#.01) field"
"RTN","ENH6911F",52,0)
 S L=L+3
"RTN","ENH6911F",53,0)
 I L+4>IOSL D HDR Q:ABORT
"RTN","ENH6911F",54,0)
 W !!,"FIELD NAME - name of the required field"
"RTN","ENH6911F",55,0)
 S L=L+2
"RTN","ENH6911F",56,0)
 I L+11>IOSL D HDR Q:ABORT
"RTN","ENH6911F",57,0)
 W !!,"You cannot correct the records that appear on this report using AEMS/MERS"
"RTN","ENH6911F",58,0)
 W !,"options. Contact the IRM or ADPAC for assistance."
"RTN","ENH6911F",59,0)
 W !!,"*** Conversion Note *********************************************"
"RTN","ENH6911F",60,0)
 W !,"If any NAME (#.01) field remains empty at the time of conversion,"
"RTN","ENH6911F",61,0)
 W !,"the record will not be converted into CoreFLS."
"RTN","ENH6911F",62,0)
 W !,"******************************************************************"
"RTN","ENH6911F",63,0)
 W !!,"<End of Instructions>" I $E(IOST,1,2)="C-" W "  Enter RETURN to continue or '^' to exit: " R Y:DTIME I '$T!(Y[U) S ABORT=1 Q
"RTN","ENH6911F",64,0)
 W @IOF
"RTN","ENH6911F",65,0)
 Q
"RTN","ENH6911F",66,0)
 ;
"RTN","ENH6911F",67,0)
ENTINST ;These are the instructions for the Broken Pointers Report
"RTN","ENH6911F",68,0)
 U IO
"RTN","ENH6911F",69,0)
 S (P,L,ABORT)=0
"RTN","ENH6911F",70,0)
 D HDR
"RTN","ENH6911F",71,0)
 W !!,"The purpose of this report is to display a list of all fields in the EQUIPMENT"
"RTN","ENH6911F",72,0)
 W !,"CATEGORY (#6911) file that contain an invalid value in a lookup-type or pointer"
"RTN","ENH6911F",73,0)
 W !,"field.  An invalid value is defined as a value that either does not have an"
"RTN","ENH6911F",74,0)
 W !,"entry in the file to which it points, or the entry in the file pointed to has"
"RTN","ENH6911F",75,0)
 W !,"an empty NAME (#.01) field.  An entry and a name must be present in the file to"
"RTN","ENH6911F",76,0)
 W !,"which a field points."
"RTN","ENH6911F",77,0)
 S L=L+7
"RTN","ENH6911F",78,0)
 I L+7>IOSL D HDR Q:ABORT
"RTN","ENH6911F",79,0)
 W !!,"This report examines the following lookup fields:"
"RTN","ENH6911F",80,0)
 W !,"     RESPONSIBLE SHOP (Multiple) (#6911.01,.01)"
"RTN","ENH6911F",81,0)
 W !,"     TECHNICIAN (RESPONSIBLE SHOP Multiple) (#6911.01,1)"
"RTN","ENH6911F",82,0)
 W !,"     PROCEDURE (RESPONSIBLE SHOP/FREQUENCY Multiple) (#6911.13,4)"
"RTN","ENH6911F",83,0)
 S L=L+5
"RTN","ENH6911F",84,0)
 I L+8>IOSL D HDR Q:ABORT
"RTN","ENH6911F",85,0)
 W !!,"You may print or view this report by selecting a range of Equipment Category"
"RTN","ENH6911F",86,0)
 W !,"name values. You may enter values at the ""START WITH NAME"" or ""GO TO NAME"""
"RTN","ENH6911F",87,0)
 W !,"prompts or press <Enter> to default to all names (""FIRST"" to ""LAST""). The"
"RTN","ENH6911F",88,0)
 W !,"report prints only the names that fall within the range you entered. The names"
"RTN","ENH6911F",89,0)
 W !,"you enter are case-sensitive."
"RTN","ENH6911F",90,0)
 S L=L+6
"RTN","ENH6911F",91,0)
 I L+7>IOSL D HDR Q:ABORT
"RTN","ENH6911F",92,0)
 W !!,"The report lists the totals for the records based on the beginning and ending"
"RTN","ENH6911F",93,0)
 W !,"values you choose."
"RTN","ENH6911F",94,0)
 W !!,"The totals for the report are as follows:"
"RTN","ENH6911F",95,0)
 S L=L+5
"RTN","ENH6911F",96,0)
 I L+5>IOSL D HDR Q:ABORT
"RTN","ENH6911F",97,0)
 W !!,"Total records analyzed - number of records in the EQUIPMENT CATEGORY"
"RTN","ENH6911F",98,0)
 W !,"     (#6911) file that fall between the beginning and ending names entered"
"RTN","ENH6911F",99,0)
 S L=L+3
"RTN","ENH6911F",100,0)
 I L+5>IOSL D HDR Q:ABORT
"RTN","ENH6911F",101,0)
 W !!,"Total records with Lookup Fields w/ Invalid Data - number of records that"
"RTN","ENH6911F",102,0)
 W !,"     have an invalid value in any of the lookup fields"
"RTN","ENH6911F",103,0)
 S L=L+3
"RTN","ENH6911F",104,0)
 I L+5>IOSL D HDR Q:ABORT
"RTN","ENH6911F",105,0)
 W !!,"Total fields with Lookup Fields w/ Invalid Data - number of lookup fields"
"RTN","ENH6911F",106,0)
 W !,"     with invalid data"
"RTN","ENH6911F",107,0)
 S L=L+3
"RTN","ENH6911F",108,0)
 I L+5>IOSL D HDR Q:ABORT
"RTN","ENH6911F",109,0)
 W !!,"The report lists each record in alphabetical order by Equipment Category name."
"RTN","ENH6911F",110,0)
 W !,"Each row on the report contains the following columns:"
"RTN","ENH6911F",111,0)
 S L=L+3
"RTN","ENH6911F",112,0)
 I L+4>IOSL D HDR Q:ABORT
"RTN","ENH6911F",113,0)
 W !!,"REC IEN - lists the EQUIPMENT CATEGORY (#6911) file internal record number"
"RTN","ENH6911F",114,0)
 S L=L+2
"RTN","ENH6911F",115,0)
 I L+4>IOSL D HDR Q:ABORT
"RTN","ENH6911F",116,0)
 W !!,"EQUIPMENT CATEGORY - name of the Equipment Category item"
"RTN","ENH6911F",117,0)
 S L=L+2
"RTN","ENH6911F",118,0)
 I L+4>IOSL D HDR Q:ABORT
"RTN","ENH6911F",119,0)
 W !!,"FIELD NAME - name of the lookup field"
"RTN","ENH6911F",120,0)
 S L=L+2
"RTN","ENH6911F",121,0)
 I L+8>IOSL D HDR Q:ABORT
"RTN","ENH6911F",122,0)
 W !!,"MULTIPLE NUMBER - index number of the multiple"
"RTN","ENH6911F",123,0)
 W !,"     (Note: The Procedure field may display a set of two multiple numbers"
"RTN","ENH6911F",124,0)
 W !,"     separated by a comma. The first number represents the Responsible Shop"
"RTN","ENH6911F",125,0)
 W !,"     multiple number. The second number represents the Frequency multiple"
"RTN","ENH6911F",126,0)
 W !,"     number.)"
"RTN","ENH6911F",127,0)
 S L=L+6
"RTN","ENH6911F",128,0)
 I L+6>IOSL D HDR Q:ABORT
"RTN","ENH6911F",129,0)
 W !!,"You must correct every field that appears on this report prior to conversion."
"RTN","ENH6911F",130,0)
 W !,"Use AEMS/MERS to enter a valid value in each lookup field listed."
"RTN","ENH6911F",131,0)
 S L=L+4
"RTN","ENH6911F",132,0)
 I L+6>IOSL D HDR Q:ABORT
"RTN","ENH6911F",133,0)
 W !!,"The only field that you cannot correct in this manner is the RESPONSIBLE SHOP"
"RTN","ENH6911F",134,0)
 W !,"(#6911.01,.01) field. To correct this field, contact the IRM or ADPAC for"
"RTN","ENH6911F",135,0)
 W !,"assistance."
"RTN","ENH6911F",136,0)
 S L=L+4
"RTN","ENH6911F",137,0)
 I L+14>IOSL D HDR Q:ABORT
"RTN","ENH6911F",138,0)
 W !!,"**** Special Note ***********************************************"
"RTN","ENH6911F",139,0)
 W !,"The following are multiple-type fields:"
"RTN","ENH6911F",140,0)
 W !,"     RESPONSIBLE SHOP (#6911.01,.01)"
"RTN","ENH6911F",141,0)
 W !,"     TECHNICIAN (#6911.01,1)"
"RTN","ENH6911F",142,0)
 W !,"     PROCEDURE (#6911.13,4)"
"RTN","ENH6911F",143,0)
 W !,"Multiple fields can occur many times within one EQUIPMENT CATEGORY"
"RTN","ENH6911F",144,0)
 W !,"(#6911) file record.  All occurrences of these fields are examined."
"RTN","ENH6911F",145,0)
 W !,"The index number of the multiple with invalid data is displayed on"
"RTN","ENH6911F",146,0)
 W !,"this report."
"RTN","ENH6911F",147,0)
 W !,"******************************************************************"
"RTN","ENH6911F",148,0)
 S L=L+12
"RTN","ENH6911F",149,0)
 I L+8>IOSL D HDR Q:ABORT
"RTN","ENH6911F",150,0)
 W !!,"*** Conversion Note *********************************************"
"RTN","ENH6911F",151,0)
 W !,"If any lookup field on this report is left with invalid data, it"
"RTN","ENH6911F",152,0)
 W !,"will be converted as empty into CoreFLS."
"RTN","ENH6911F",153,0)
 W !,"******************************************************************"
"RTN","ENH6911F",154,0)
 W !!,"<End of Instructions>" I $E(IOST,1,2)="C-" W "  Enter RETURN to continue or '^' to exit: " R Y:DTIME I '$T!(Y[U) S ABORT=1 Q
"RTN","ENH6911F",155,0)
 W @IOF
"RTN","ENH6911F",156,0)
 Q
"RTN","ENH6911F",157,0)
 ;
"RTN","ENH6911F",158,0)
HDR ;Page break for multi page instructions
"RTN","ENH6911F",159,0)
 I $E(IOST,1,2)="C-",P R !!,"Enter RETURN to continue or '^' to exit:  ",Y:DTIME I '$T!(Y[U) S ABORT=1 Q
"RTN","ENH6911F",160,0)
 ; Do not print a form feed before first page on printer. Top of form is set at end of previous report.
"RTN","ENH6911F",161,0)
 I $E(IOST,1,2)="C-"!P W @IOF
"RTN","ENH6911F",162,0)
 S P=P+1,L=2
"RTN","ENH6911F",163,0)
 I $G(ENHDET)=1 S INSHDR="REQUIRED FIELDS MISSING DATA"
"RTN","ENH6911F",164,0)
 I $G(ENHDET)=2 S INSHDR="LOOKUP FIELDS W/ INVALID DATA"
"RTN","ENH6911F",165,0)
 I $G(ENHSUM)=1 S INSHDR="SUMMARY"
"RTN","ENH6911F",166,0)
 I $G(ENHDET)=3 S INSHDR="NON-REQUIRED FIELDS MISSING DATA"
"RTN","ENH6911F",167,0)
 W !,"EQUIPMENT CATEGORY (#6911) - ",INSHDR,?67,"Page: ",$J(P,5,0)
"RTN","ENH6911F",168,0)
 W !,"CoreFLS Data Cleansing Report Instructions",?58,"Printed: ",$$FMTE^XLFDT(DT)
"RTN","ENH6911F",169,0)
 Q
"RTN","ENH6911I")
0^5^B38029952
"RTN","ENH6911I",1,0)
ENH6911I ;WOIFO/TAW/EEN - Instructions Pages for Equipment Category Reports ;09/24/03 13:44
"RTN","ENH6911I",2,0)
 ;;7.0;ENGINEERING;**74**;Aug 17, 1993
"RTN","ENH6911I",3,0)
 ;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","ENH6911I",4,0)
 ;
"RTN","ENH6911I",5,0)
 Q  ;this routine is not callable from the top
"RTN","ENH6911I",6,0)
 ;
"RTN","ENH6911I",7,0)
 ;This routine will prompt the user to see if they want the Instructions
"RTN","ENH6911I",8,0)
 ;printed out or not.  This routine will also print the instructions
"RTN","ENH6911I",9,0)
 ;for the Non-Required Fields Missing Data reports
"RTN","ENH6911I",10,0)
 ;
"RTN","ENH6911I",11,0)
BOTHINS ;These are the instructions for the NON-CRITICAL Nulls report
"RTN","ENH6911I",12,0)
 U IO
"RTN","ENH6911I",13,0)
 S (P,L,ABORT)=0
"RTN","ENH6911I",14,0)
 D HDR
"RTN","ENH6911I",15,0)
 W !!,"The purpose of this report is to display a list of all EQUIPMENT CATEGORY"
"RTN","ENH6911I",16,0)
 W !,"(#6911) items with missing (empty) data for the fields that are not required"
"RTN","ENH6911I",17,0)
 W !,"in the CoreFLS system. If fields appearing on this report are left empty, the"
"RTN","ENH6911I",18,0)
 W !,"conversion will either default to a value or convert the field as empty into"
"RTN","ENH6911I",19,0)
 W !,"the CoreFLS system."
"RTN","ENH6911I",20,0)
 S L=L+6
"RTN","ENH6911I",21,0)
 I L+7>IOSL D HDR Q:ABORT
"RTN","ENH6911I",22,0)
 W !!,"This report examines the following non-required fields:"
"RTN","ENH6911I",23,0)
 W !,"   TECHNICIAN (RESPONSIBLE SHOP Multiple) (#6911.01,1)"
"RTN","ENH6911I",24,0)
 W !,"   FREQUENCY (RESPONSIBLE SHOP/FREQUENCY Multiple) (#6911.13,.01)"
"RTN","ENH6911I",25,0)
 W !,"   PROCEDURE (RESPONSIBLE SHOP/FREQUENCY Multiple) (#6911.13,4)"
"RTN","ENH6911I",26,0)
 S L=L+5
"RTN","ENH6911I",27,0)
 I L+8>IOSL D HDR Q:ABORT
"RTN","ENH6911I",28,0)
 W !!,"You may print or view this report by selecting a range of Equipment Category"
"RTN","ENH6911I",29,0)
 W !,"name values. You may enter values at the ""START WITH NAME"" or ""GO TO NAME"""
"RTN","ENH6911I",30,0)
 W !,"prompts or press <Enter> to default to all names (""FIRST"" to ""LAST""). The"
"RTN","ENH6911I",31,0)
 W !,"report prints only the names that fall within the range you entered. The names"
"RTN","ENH6911I",32,0)
 W !,"you enter are case-sensitive."
"RTN","ENH6911I",33,0)
 S L=L+6
"RTN","ENH6911I",34,0)
 I L+5>IOSL D HDR Q:ABORT
"RTN","ENH6911I",35,0)
 W !!,"The report lists the totals for the records based on the beginning and ending"
"RTN","ENH6911I",36,0)
 W !,"values you choose."
"RTN","ENH6911I",37,0)
 S L=L+3
"RTN","ENH6911I",38,0)
 I L+4>IOSL D HDR Q:ABORT
"RTN","ENH6911I",39,0)
 W !!,"The totals for the report are as follows:"
"RTN","ENH6911I",40,0)
 S L=L+2
"RTN","ENH6911I",41,0)
 I L+5>IOSL D HDR Q:ABORT
"RTN","ENH6911I",42,0)
 W !!,"Total records analyzed - number of records in the EQUIPMENT CATEGORY (#6911)"
"RTN","ENH6911I",43,0)
 W !,"     file that fall between the beginning and ending names entered"
"RTN","ENH6911I",44,0)
 S L=L+3
"RTN","ENH6911I",45,0)
 I L+5>IOSL D HDR Q:ABORT
"RTN","ENH6911I",46,0)
 W !!,"Total records with Non-Required Fields Missing Data - number of records that"
"RTN","ENH6911I",47,0)
 W !,"     have one or more empty non-required fields"
"RTN","ENH6911I",48,0)
 S L=L+3
"RTN","ENH6911I",49,0)
 I L+5>IOSL D HDR Q:ABORT
"RTN","ENH6911I",50,0)
 W !!,"Total fields with Non-Required Fields Missing Data - number of non-required"
"RTN","ENH6911I",51,0)
 W !,"     fields that are empty"
"RTN","ENH6911I",52,0)
 S L=L+3
"RTN","ENH6911I",53,0)
 I L+5>IOSL D HDR Q:ABORT
"RTN","ENH6911I",54,0)
 W !!,"The report lists records in alphabetical order by Equipment Category name."
"RTN","ENH6911I",55,0)
 W !,"Each row on the report contains the following columns:"
"RTN","ENH6911I",56,0)
 S L=L+3
"RTN","ENH6911I",57,0)
 I L+4>IOSL D HDR Q:ABORT
"RTN","ENH6911I",58,0)
 W !!,"REC IEN - lists the EQUIPMENT CATEGORY (#6911) file internal record number"
"RTN","ENH6911I",59,0)
 S L=L+2
"RTN","ENH6911I",60,0)
 I L+4>IOSL D HDR Q:ABORT
"RTN","ENH6911I",61,0)
 W !!,"EQUIPMENT CATEGORY - name of the Equipment Category item"
"RTN","ENH6911I",62,0)
 S L=L+2
"RTN","ENH6911I",63,0)
 I L+4>IOSL D HDR Q:ABORT
"RTN","ENH6911I",64,0)
 W !!,"FIELD NAME - name of the non-required field"
"RTN","ENH6911I",65,0)
 S L=L+2
"RTN","ENH6911I",66,0)
 I L+12>IOSL D HDR Q:ABORT
"RTN","ENH6911I",67,0)
 W !!,"MULTIPLE NUMBER - index number of the multiple"
"RTN","ENH6911I",68,0)
 W !,"     (Note: Frequency and Procedure fields may display a set of two multiple"
"RTN","ENH6911I",69,0)
 W !,"     numbers separated by a comma. The first number represents the Responsible"
"RTN","ENH6911I",70,0)
 W !,"     Shop multiple number. The second number represents the Frequency multiple"
"RTN","ENH6911I",71,0)
 W !,"     number. If the second multiple number (Frequency multiple number) for"
"RTN","ENH6911I",72,0)
 W !,"     these two fields is missing, there are no occurrences of the field's"
"RTN","ENH6911I",73,0)
 W !,"     Frequency or Procedure for the Responsible Shop. There must be a"
"RTN","ENH6911I",74,0)
 W !,"     Frequency and Procedure for each Responsible Shop in order for a PM to"
"RTN","ENH6911I",75,0)
 W !,"     be generated for the Equipment Category.)"
"RTN","ENH6911I",76,0)
 S L=L+10
"RTN","ENH6911I",77,0)
 I L+6>IOSL D HDR Q:ABORT
"RTN","ENH6911I",78,0)
 W !!,"You should correct every field that appears on this report prior to conversion."
"RTN","ENH6911I",79,0)
 W !,"Use AEMS/MERS to enter a valid value in each empty field listed."
"RTN","ENH6911I",80,0)
 S L=L+4
"RTN","ENH6911I",81,0)
 I L+13>IOSL D HDR Q:ABORT
"RTN","ENH6911I",82,0)
 W !!,"** Special Note *************************************************"
"RTN","ENH6911I",83,0)
 W !,"The following are multiple-type fields:"
"RTN","ENH6911I",84,0)
 W !,"     TECHNICIAN (#6911.01,1)"
"RTN","ENH6911I",85,0)
 W !,"     FREQUENCY (#6911.13,.01)"
"RTN","ENH6911I",86,0)
 W !,"     PROCEDURE (#6911.13,4)"
"RTN","ENH6911I",87,0)
 W !,"Multiple fields can occur many times within one EQUIPMENT CATEGORY"
"RTN","ENH6911I",88,0)
 W !,"(#6911) file record.  All occurrences of these fields are examined."
"RTN","ENH6911I",89,0)
 W !,"The index number of the multiple with missing data is displayed on"
"RTN","ENH6911I",90,0)
 W !,"this report."
"RTN","ENH6911I",91,0)
 W !,"******************************************************************"
"RTN","ENH6911I",92,0)
 S L=L+11
"RTN","ENH6911I",93,0)
 I L+18>IOSL D HDR Q:ABORT
"RTN","ENH6911I",94,0)
 W !!,"*** Conversion Note ********************************************"
"RTN","ENH6911I",95,0)
 W !,"If these non-required fields remain empty, the following will"
"RTN","ENH6911I",96,0)
 W !,"occur during CoreFLS conversion:"
"RTN","ENH6911I",97,0)
 W !!,"TECHNICIAN (#6911.01,1) - will be converted into CoreFLS as empty"
"RTN","ENH6911I",98,0)
 W !!,"FREQUENCY (#6911.13,.01) - a PM will not be created for the"
"RTN","ENH6911I",99,0)
 W !,"                            Equipment Category"
"RTN","ENH6911I",100,0)
 W !!,"PROCEDURE (#6911.13,4) - the PM description will be defaulted to"
"RTN","ENH6911I",101,0)
 W !,"                          the FREQUENCY (#6911.13,.01) followed by"
"RTN","ENH6911I",102,0)
 W !,"                          a hyphen (dash) and Equipment Category"
"RTN","ENH6911I",103,0)
 W !,"                          NAME (#.01) (ex. Quarterly-Pump)"
"RTN","ENH6911I",104,0)
 W !,"******************************************************************"
"RTN","ENH6911I",105,0)
 W !!,"<End of Instructions>" I $E(IOST,1,2)="C-" W "  Enter RETURN to continue or '^' to exit: " R Y:DTIME I '$T!(Y[U) S ABORT=1 Q
"RTN","ENH6911I",106,0)
 W @IOF
"RTN","ENH6911I",107,0)
 Q
"RTN","ENH6911I",108,0)
 ;
"RTN","ENH6911I",109,0)
HDR ;Page break for multi page instructions
"RTN","ENH6911I",110,0)
 I $E(IOST,1,2)="C-",P R !!,"Enter RETURN to continue or '^' to exit:  ",Y:DTIME I '$T!(Y[U) S ABORT=1 Q
"RTN","ENH6911I",111,0)
 ; Do not print a form feed before first page on printer. 
"RTN","ENH6911I",112,0)
 ; Top of form set at end of previous report.
"RTN","ENH6911I",113,0)
 I $E(IOST,1,2)="C-"!P W @IOF
"RTN","ENH6911I",114,0)
 S P=P+1,L=2
"RTN","ENH6911I",115,0)
 I $G(ENHDET)=3 S INSHDR="NON-REQUIRED FIELDS MISSING DATA"
"RTN","ENH6911I",116,0)
 W !,"EQUIPMENT CATEGORY (#6911) - ",INSHDR,?67,"Page: ",$J(P,5,0)
"RTN","ENH6911I",117,0)
 W !,"CoreFLS Data Cleansing Report Instructions",?58,"Printed: ",$$FMTE^XLFDT(DT)
"RTN","ENH6911I",118,0)
 Q
"RTN","ENH6911M")
0^6^B27755865
"RTN","ENH6911M",1,0)
ENH6911M ;WOIFO/TAW/EEN - Instructions Pages for Equipment Category Reports ;09/24/03 13:44
"RTN","ENH6911M",2,0)
 ;;7.0;ENGINEERING;**74**;Aug 17, 1993
"RTN","ENH6911M",3,0)
 ;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","ENH6911M",4,0)
 ;
"RTN","ENH6911M",5,0)
 Q  ;this routine is not callable from the top
"RTN","ENH6911M",6,0)
 ;
"RTN","ENH6911M",7,0)
 ; This routine will print the instructions for the Summary Report
"RTN","ENH6911M",8,0)
 ;
"RTN","ENH6911M",9,0)
SUMINST ;Instructions for the Summary Report for the 6911 file
"RTN","ENH6911M",10,0)
 U IO
"RTN","ENH6911M",11,0)
 S (P,L,ABORT)=0
"RTN","ENH6911M",12,0)
 D HDR
"RTN","ENH6911M",13,0)
 W !!,"The purpose of this report is to display the total number of records in the"
"RTN","ENH6911M",14,0)
 W !,"EQUIPMENT CATEGORY (#6911) file that have invalid or missing (empty) values in"
"RTN","ENH6911M",15,0)
 W !,"the fields that are being converted into the CoreFLS system.  The report"
"RTN","ENH6911M",16,0)
 W !,"examines five fields to determine if there is a valid value in each.  If there"
"RTN","ENH6911M",17,0)
 W !,"is no value in the field, it is considered to be empty. If there is a value in"
"RTN","ENH6911M",18,0)
 W !,"a lookup-type (a.k.a. pointer) field, the report examines the value to ensure"
"RTN","ENH6911M",19,0)
 W !,"that it is valid."
"RTN","ENH6911M",20,0)
 S L=L+8
"RTN","ENH6911M",21,0)
 I L+9>IOSL D HDR Q:ABORT
"RTN","ENH6911M",22,0)
 W !!,"This report examines the following fields:"
"RTN","ENH6911M",23,0)
 W !,"     NAME (#.01)"
"RTN","ENH6911M",24,0)
 W !,"     RESPONSIBLE SHOP (Multiple) (#6911.01,.01)"
"RTN","ENH6911M",25,0)
 W !,"     TECHNICIAN (RESPONSIBLE SHOP Multiple) (#6911.01,1)"
"RTN","ENH6911M",26,0)
 W !,"     FREQUENCY (RESPONSIBLE SHOP/FREQUENCY Multiple) (#6911.13,.01)"
"RTN","ENH6911M",27,0)
 W !,"     PROCEDURE (RESPONSIBLE SHOP/FREQUENCY Multiple) (#6911.13,4)"
"RTN","ENH6911M",28,0)
 S L=L+7
"RTN","ENH6911M",29,0)
 I L+5>IOSL D HDR Q:ABORT
"RTN","ENH6911M",30,0)
 W !!,"This report lists the overall count of the number of problem records and"
"RTN","ENH6911M",31,0)
 W !,"fields detected."
"RTN","ENH6911M",32,0)
 S L=L+3
"RTN","ENH6911M",33,0)
 I L+4>IOSL D HDR Q:ABORT
"RTN","ENH6911M",34,0)
 W !!,"The totals for the report are as follows:"
"RTN","ENH6911M",35,0)
 S L=L+2
"RTN","ENH6911M",36,0)
 I L+5>IOSL D HDR Q:ABORT
"RTN","ENH6911M",37,0)
 W !!,"Total records analyzed - number of records in the EQUIPMENT CATEGORY"
"RTN","ENH6911M",38,0)
 W !,"     (#6911) file"
"RTN","ENH6911M",39,0)
 S L=L+3
"RTN","ENH6911M",40,0)
 I L+5>IOSL D HDR Q:ABORT
"RTN","ENH6911M",41,0)
 W !!,"Total records with Required Fields Missing Data - number of records that"
"RTN","ENH6911M",42,0)
 W !,"     have at least one empty required field"
"RTN","ENH6911M",43,0)
 S L=L+3
"RTN","ENH6911M",44,0)
 I L+5>IOSL D HDR Q:ABORT
"RTN","ENH6911M",45,0)
 W !!,"Total records with Lookup Fields w/ Invalid Data - number of records that"
"RTN","ENH6911M",46,0)
 W !,"     have invalid data in any of the lookup fields"
"RTN","ENH6911M",47,0)
 S L=L+3
"RTN","ENH6911M",48,0)
 I L+5>IOSL D HDR Q:ABORT
"RTN","ENH6911M",49,0)
 W !!,"Total records with Non-Required Fields Missing Data - number of records"
"RTN","ENH6911M",50,0)
 W !,"     that have nothing in at least one non-required field"
"RTN","ENH6911M",51,0)
 S L=L+3
"RTN","ENH6911M",52,0)
 I L+5>IOSL D HDR Q:ABORT
"RTN","ENH6911M",53,0)
 W !!,"Next, the report lists the counts for each individual field. The fields are"
"RTN","ENH6911M",54,0)
 W !,"listed in alphabetical order. Each row consists of the following columns:"
"RTN","ENH6911M",55,0)
 S L=L+3
"RTN","ENH6911M",56,0)
 I L+7>IOSL D HDR Q:ABORT
"RTN","ENH6911M",57,0)
 W !!,"DATA QUALITY CHECK TYPE - tells whether the field was examined for:"
"RTN","ENH6911M",58,0)
 W !,"     REQ: required fields missing data"
"RTN","ENH6911M",59,0)
 W !,"     INV: invalid data"
"RTN","ENH6911M",60,0)
 W !,"     NREQ: non-required fields missing data"
"RTN","ENH6911M",61,0)
 S L=L+5
"RTN","ENH6911M",62,0)
 I L+4>IOSL D HDR Q:ABORT
"RTN","ENH6911M",63,0)
 W !!,"FIELD NAME - name of the field from the EQUIPMENT CATEGORY (#6911) file"
"RTN","ENH6911M",64,0)
 S L=L+2
"RTN","ENH6911M",65,0)
 I L+5>IOSL D HDR Q:ABORT
"RTN","ENH6911M",66,0)
 W !!,"REQUIRED FIELDS MISSING DATA - count of the number of empty required fields"
"RTN","ENH6911M",67,0)
 W !,"     (""N/A"" appears in this column if the field is not required by CoreFLS.)"
"RTN","ENH6911M",68,0)
 S L=L+3
"RTN","ENH6911M",69,0)
 I L+6>IOSL D HDR Q:ABORT
"RTN","ENH6911M",70,0)
 W !!,"LOOKUP FIELDS W/ INVALID DATA - count of the number of lookup fields that"
"RTN","ENH6911M",71,0)
 W !,"     contain an invalid value  (""N/A"" appears in this column if the field is"
"RTN","ENH6911M",72,0)
 W !,"     not a lookup field.)"
"RTN","ENH6911M",73,0)
 S L=L+4
"RTN","ENH6911M",74,0)
 I L+6>IOSL D HDR Q:ABORT
"RTN","ENH6911M",75,0)
 W !!,"NON-REQ. FIELDS WITH MISSING DATA - count of the number of empty non-required"
"RTN","ENH6911M",76,0)
 W !,"     fields (""N/A"" appears in this column if non-required does not apply to"
"RTN","ENH6911M",77,0)
 W !,"     this field.)"
"RTN","ENH6911M",78,0)
 S L=L+4
"RTN","ENH6911M",79,0)
 I L+13>IOSL D HDR Q:ABORT
"RTN","ENH6911M",80,0)
 W !!,"**** Special Note ***********************************************"
"RTN","ENH6911M",81,0)
 W !,"The following are multiple-type fields:"
"RTN","ENH6911M",82,0)
 W !,"     RESPONSIBLE SHOP (#6911.01,.01)"
"RTN","ENH6911M",83,0)
 W !,"     TECHNICIAN (#6911.01,1)"
"RTN","ENH6911M",84,0)
 W !,"     FREQUENCY (#6911.13,.01)"
"RTN","ENH6911M",85,0)
 W !,"     PROCEDURE (#6911.13,4)"
"RTN","ENH6911M",86,0)
 W !,"Multiple fields can occur many times within one EQUIPMENT CATEGORY"
"RTN","ENH6911M",87,0)
 W !,"(#6911) file record.  All occurrences of these fields are examined"
"RTN","ENH6911M",88,0)
 W !,"The index number of the multiple with missing or invalid data is"
"RTN","ENH6911M",89,0)
 W !,"displayed on the detail reports."
"RTN","ENH6911M",90,0)
 W !,"******************************************************************"
"RTN","ENH6911M",91,0)
 W !!,"<End of Instructions>" I $E(IOST,1,2)="C-" W "  Enter RETURN to continue or '^' to exit: " R Y:DTIME I '$T!(Y[U) S ABORT=1 Q
"RTN","ENH6911M",92,0)
 W @IOF
"RTN","ENH6911M",93,0)
 Q
"RTN","ENH6911M",94,0)
 ;
"RTN","ENH6911M",95,0)
HDR ;Page break for multi page instructions
"RTN","ENH6911M",96,0)
 I $E(IOST,1,2)="C-",P R !!,"Enter RETURN to continue or '^' to exit:  ",Y:DTIME I '$T!(Y[U) S ABORT=1 Q
"RTN","ENH6911M",97,0)
 ; Do not print a form feed before first page on printer. Top of form is set at end of previous report.
"RTN","ENH6911M",98,0)
 I $E(IOST,1,2)="C-"!P W @IOF
"RTN","ENH6911M",99,0)
 S P=P+1,L=2
"RTN","ENH6911M",100,0)
 I $G(ENHSUM)=1 S INSHDR="SUMMARY"
"RTN","ENH6911M",101,0)
 W !,"EQUIPMENT CATEGORY (#6911) - ",INSHDR,?67,"Page: ",$J(P,5,0)
"RTN","ENH6911M",102,0)
 W !,"CoreFLS Data Cleansing Report Instructions",?58,"Printed: ",$$FMTE^XLFDT(DT)
"RTN","ENH6911M",103,0)
 Q
"VER")
8.0^22
**END**
**END**
