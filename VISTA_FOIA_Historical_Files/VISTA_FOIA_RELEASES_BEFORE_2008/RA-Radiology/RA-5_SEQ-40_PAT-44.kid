Released RA*5*44 SEQ #40
Extracted from mail message
**KIDS**:RA*5.0*44^

**INSTALL NAME**
RA*5.0*44
"BLD",4841,0)
RA*5.0*44^RADIOLOGY/NUCLEAR MEDICINE^0^3040226^y
"BLD",4841,1,0)
^^1^1^3031223^
"BLD",4841,1,1,0)
Please see patch description for details.
"BLD",4841,4,0)
^9.64PA^^
"BLD",4841,"INIT")
RA44PST
"BLD",4841,"KRN",0)
^9.67PA^8989.52^19
"BLD",4841,"KRN",.4,0)
.4
"BLD",4841,"KRN",.401,0)
.401
"BLD",4841,"KRN",.402,0)
.402
"BLD",4841,"KRN",.403,0)
.403
"BLD",4841,"KRN",.5,0)
.5
"BLD",4841,"KRN",.84,0)
.84
"BLD",4841,"KRN",3.6,0)
3.6
"BLD",4841,"KRN",3.8,0)
3.8
"BLD",4841,"KRN",9.2,0)
9.2
"BLD",4841,"KRN",9.8,0)
9.8
"BLD",4841,"KRN",9.8,"NM",0)
^9.68A^4^4
"BLD",4841,"KRN",9.8,"NM",1,0)
RAPM^^0^B63439555
"BLD",4841,"KRN",9.8,"NM",2,0)
RAPM1^^0^B44195170
"BLD",4841,"KRN",9.8,"NM",3,0)
RAPM2^^0^B77984038
"BLD",4841,"KRN",9.8,"NM",4,0)
RAPM3^^0^B77781515
"BLD",4841,"KRN",9.8,"NM","B","RAPM",1)

"BLD",4841,"KRN",9.8,"NM","B","RAPM1",2)

"BLD",4841,"KRN",9.8,"NM","B","RAPM2",3)

"BLD",4841,"KRN",9.8,"NM","B","RAPM3",4)

"BLD",4841,"KRN",19,0)
19
"BLD",4841,"KRN",19,"NM",0)
^9.68A^4^4
"BLD",4841,"KRN",19,"NM",1,0)
RA PERFORMIN TASKLM^^0
"BLD",4841,"KRN",19,"NM",2,0)
RA PERFORMIN MENU^^2
"BLD",4841,"KRN",19,"NM",3,0)
RA PERFORMIN SCHEDULE^^0
"BLD",4841,"KRN",19,"NM",4,0)
RA SITEMANAGER^^2
"BLD",4841,"KRN",19,"NM","B","RA PERFORMIN MENU",2)

"BLD",4841,"KRN",19,"NM","B","RA PERFORMIN SCHEDULE",3)

"BLD",4841,"KRN",19,"NM","B","RA PERFORMIN TASKLM",1)

"BLD",4841,"KRN",19,"NM","B","RA SITEMANAGER",4)

"BLD",4841,"KRN",19.1,0)
19.1
"BLD",4841,"KRN",101,0)
101
"BLD",4841,"KRN",409.61,0)
409.61
"BLD",4841,"KRN",771,0)
771
"BLD",4841,"KRN",870,0)
870
"BLD",4841,"KRN",8989.51,0)
8989.51
"BLD",4841,"KRN",8989.52,0)
8989.52
"BLD",4841,"KRN",8994,0)
8994
"BLD",4841,"KRN","B",.4,.4)

"BLD",4841,"KRN","B",.401,.401)

"BLD",4841,"KRN","B",.402,.402)

"BLD",4841,"KRN","B",.403,.403)

"BLD",4841,"KRN","B",.5,.5)

"BLD",4841,"KRN","B",.84,.84)

"BLD",4841,"KRN","B",3.6,3.6)

"BLD",4841,"KRN","B",3.8,3.8)

"BLD",4841,"KRN","B",9.2,9.2)

"BLD",4841,"KRN","B",9.8,9.8)

"BLD",4841,"KRN","B",19,19)

"BLD",4841,"KRN","B",19.1,19.1)

"BLD",4841,"KRN","B",101,101)

"BLD",4841,"KRN","B",409.61,409.61)

"BLD",4841,"KRN","B",771,771)

"BLD",4841,"KRN","B",870,870)

"BLD",4841,"KRN","B",8989.51,8989.51)

"BLD",4841,"KRN","B",8989.52,8989.52)

"BLD",4841,"KRN","B",8994,8994)

"BLD",4841,"QUES",0)
^9.62^^
"BLD",4841,"REQB",0)
^9.611^1^1
"BLD",4841,"REQB",1,0)
RA*5.0*37^2
"BLD",4841,"REQB","B","RA*5.0*37",1)

"INIT")
RA44PST
"KRN",19,1710,-1)
2^4
"KRN",19,1710,0)
RA SITEMANAGER^IRM Menu^^M^50^^^^^^^
"KRN",19,1710,10,0)
^19.01IP^13^11
"KRN",19,1710,10,13,0)
11948
"KRN",19,1710,10,13,"^")
RA PERFORMIN SCHEDULE
"KRN",19,1710,"U")
IRM MENU
"KRN",19,11742,-1)
2^2
"KRN",19,11742,0)
RA PERFORMIN MENU^Performance Indicator^^M^4569^^^^^^^18
"KRN",19,11742,10,0)
^19.01IP^3^3
"KRN",19,11742,10,3,0)
11947
"KRN",19,11742,10,3,"^")
RA PERFORMIN TASKLM
"KRN",19,11742,"U")
PERFORMANCE INDICATOR
"KRN",19,11947,-1)
0^1
"KRN",19,11947,0)
RA PERFORMIN TASKLM^Run Previous Month's Summary Report^^R^^^^^^^^RADIOLOGY/NUCLEAR MEDICINE
"KRN",19,11947,1,0)
^^5^5^3040105^
"KRN",19,11947,1,1,0)
This option is used to run the 'Summary Performance Indicator Report' for
"KRN",19,11947,1,2,0)
the previous month as a background task.  It will send the output to
"KRN",19,11947,1,3,0)
Outlook mail groups defined in File 79's PERF INDC SMTP E-MAIL ADDRESS
"KRN",19,11947,1,4,0)
multiple field.  There is only one user prompt:
"KRN",19,11947,1,5,0)
    Requested Start Time: NOW//
"KRN",19,11947,25)
TASKLM^RAPM3
"KRN",19,11947,"U")
RUN PREVIOUS MONTH'S SUMMARY R
"KRN",19,11948,-1)
0^3
"KRN",19,11948,0)
RA PERFORMIN SCHEDULE^Schedule Perf. Indic. Summary for 15th of month^^R^^^^^^^^RADIOLOGY/NUCLEAR MEDICINE
"KRN",19,11948,1,0)
^^3^3^3040112^
"KRN",19,11948,1,1,0)
This option should be used to put the option, RA PERFORMIN TASKLM, back
"KRN",19,11948,1,2,0)
on the Taskman queue to run on the 15th of the current month or the next 
"KRN",19,11948,1,3,0)
month, whichever is the closest date in the future.
"KRN",19,11948,25)
RESCH^RAPM3
"KRN",19,11948,"U")
SCHEDULE PERF. INDIC. SUMMARY 
"MBREQ")
0
"ORD",18,19)
19;18;;;OPT^XPDTA;OPTF1^XPDIA;OPTE1^XPDIA;OPTF2^XPDIA;;OPTDEL^XPDIA
"ORD",18,19,0)
OPTION
"PKG",18,-1)
1^1
"PKG",18,0)
RADIOLOGY/NUCLEAR MEDICINE^RA^REGISTERS PATIENTS,RECORDS EXAMS,PROFILES,AMIS REPORTS
"PKG",18,20,0)
^9.402P^^
"PKG",18,22,0)
^9.49I^1^1
"PKG",18,22,1,0)
5.0^3011017^2980407^50
"PKG",18,22,1,"PAH",1,0)
44^3040226
"PKG",18,22,1,"PAH",1,1,0)
^^1^1^3040226
"PKG",18,22,1,"PAH",1,1,1,0)
Please see patch description for details.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
5
"RTN","RA44PST")
0^^B8088081
"RTN","RA44PST",1,0)
RA44PST ;HOIFO/SWM-Post install ;1/20/04  11:52
"RTN","RA44PST",2,0)
 ;;5.0;Radiology/Nuclear Medicine;**44**;Mar 16, 1998
"RTN","RA44PST",3,0)
 ; This is the post-install routine for patch RA*5.0*44
"RTN","RA44PST",4,0)
 ;
"RTN","RA44PST",5,0)
 ; This routine may be deleted after the patch is installed.
"RTN","RA44PST",6,0)
 ;
"RTN","RA44PST",7,0)
 ; supported IA 1472 allows adding record to file 19.2
"RTN","RA44PST",8,0)
 ;
"RTN","RA44PST",9,0)
 I '$D(XPDNM)#2 D EN^DDIOL("This entry point must be called from the KIDS installation -- Nothing Done.",,"!!,$C(7)") Q
"RTN","RA44PST",10,0)
 N RABY,RADT,RAIEN19,RAWHEN,RAFLAG,RAERR,RAR,RATXT
"RTN","RA44PST",11,0)
 N D1,M1,Y1,M2,Y2
"RTN","RA44PST",12,0)
 S RATXT(1)=""
"RTN","RA44PST",13,0)
 S RAIEN19=$O(^DIC(19,"B","RA PERFORMIN TASKLM",0))
"RTN","RA44PST",14,0)
 I 'RAIEN19 D  Q
"RTN","RA44PST",15,0)
 . S RATXT(2)="** Option RA PERFORMIN TASKLM isn't installed into file 19, so nothing done. **"
"RTN","RA44PST",16,0)
 . D MES^XPDUTL(.RATXT)
"RTN","RA44PST",17,0)
 . Q
"RTN","RA44PST",18,0)
 ;
"RTN","RA44PST",19,0)
 D OPTSTAT^XUTMOPT("RA PERFORMIN TASKLM",.RAR)
"RTN","RA44PST",20,0)
 I $P($G(RAR(1)),U) D  Q
"RTN","RA44PST",21,0)
 . S RATXT(2)="** Option RA PERFORMIN TASKLM is already scheduled, so nothing done. **"
"RTN","RA44PST",22,0)
 . D MES^XPDUTL(.RATXT)
"RTN","RA44PST",23,0)
 . Q
"RTN","RA44PST",24,0)
 ;
"RTN","RA44PST",25,0)
 ; add option to file 19.2 for automatic rescheduling
"RTN","RA44PST",26,0)
 I '$O(^DIC(19.2,"B",RAIEN19,0)) D
"RTN","RA44PST",27,0)
 . S RAFLAG="L"
"RTN","RA44PST",28,0)
 . S RATXT(2)="** Installing RA PERFORMIN TASKLM into file 19.2. **"
"RTN","RA44PST",29,0)
 . D MES^XPDUTL(.RATXT)
"RTN","RA44PST",30,0)
 . D SET15
"RTN","RA44PST",31,0)
 . D RESCH^XUTMOPT("RA PERFORMIN TASKLM",RAWHEN,,RABY,RAFLAG,.RAERR)
"RTN","RA44PST",32,0)
 . Q
"RTN","RA44PST",33,0)
 ;
"RTN","RA44PST",34,0)
 N RATXT,ZTDESC,ZTDTH,ZTIO,ZTRTN S ZTIO=""
"RTN","RA44PST",35,0)
 S ZTRTN="SCHED^RA44PST"
"RTN","RA44PST",36,0)
 S ZTDESC="RA*5.0*44 Schedule RA PERFORMIN TASKLM on 15th"
"RTN","RA44PST",37,0)
 S ZTDTH=$$FMADD^XLFDT($$NOW^XLFDT(),0,0,2,0) ;add 2 minutes to 'now'
"RTN","RA44PST",38,0)
 D ^%ZTLOAD S RATXT(1)=" "
"RTN","RA44PST",39,0)
 S RATXT(2)="RA*5.0*44 Scheduling RA PERFORMIN TASKLM in background."
"RTN","RA44PST",40,0)
 S:$G(ZTSK)>0 RATXT(3)="Task: "_ZTSK_"."
"RTN","RA44PST",41,0)
 S RATXT(4)=" "
"RTN","RA44PST",42,0)
 D MES^XPDUTL(.RATXT)
"RTN","RA44PST",43,0)
 Q
"RTN","RA44PST",44,0)
SCHED ; schedule RA PERFORMIN TASKLM to run on 15th
"RTN","RA44PST",45,0)
 N RABY,RADT,RAIEN19,RAWHEN,RAFLAG,RAERR,RAR
"RTN","RA44PST",46,0)
 N D1,M1,Y1,M2,Y2
"RTN","RA44PST",47,0)
 S ZTREQ="@"
"RTN","RA44PST",48,0)
 D OPTSTAT^XUTMOPT("RA PERFORMIN TASKLM",.RAR)
"RTN","RA44PST",49,0)
 I $P($G(RAR(1)),U) Q  ; option already tasked
"RTN","RA44PST",50,0)
 I '$D(RAR(1)) Q  ; option not in file 19.2
"RTN","RA44PST",51,0)
 D SET15
"RTN","RA44PST",52,0)
 D RESCH^XUTMOPT("RA PERFORMIN TASKLM",RAWHEN,,RABY,,.RAERR)
"RTN","RA44PST",53,0)
 Q
"RTN","RA44PST",54,0)
SET15 ; set some variables for scheduling task
"RTN","RA44PST",55,0)
 S Y1=$E(DT,1,3),M1=$E(DT,4,5),D1=$E(DT,6,7)
"RTN","RA44PST",56,0)
 S Y2=$S(M1="12":Y1+1,1:Y1),M2=$S(M1="12":"01",1:M1+1)
"RTN","RA44PST",57,0)
 S:$L(M2)=1 M2="0"_M2
"RTN","RA44PST",58,0)
 D:D1=15 TODAY D:D1<15 THISM D:D1>15 NEXTM
"RTN","RA44PST",59,0)
 S RAWHEN=$$FMADD^XLFDT(RADT,,,5) ; add 5 mins to scheduled date
"RTN","RA44PST",60,0)
 S RABY="1M(15)" ; every month on the 15th day
"RTN","RA44PST",61,0)
 Q
"RTN","RA44PST",62,0)
TODAY ; today is the 15th
"RTN","RA44PST",63,0)
 S RADT=$$NOW^XLFDT
"RTN","RA44PST",64,0)
 Q
"RTN","RA44PST",65,0)
THISM ; this month on the 15th
"RTN","RA44PST",66,0)
 S RADT=Y1_M1_"15."_$P(($$NOW^XLFDT),".",2)
"RTN","RA44PST",67,0)
 Q
"RTN","RA44PST",68,0)
NEXTM ; next month on the 15th
"RTN","RA44PST",69,0)
 S RADT=Y2_M2_"15."_$P(($$NOW^XLFDT),".",2)
"RTN","RA44PST",70,0)
 Q
"RTN","RAPM")
0^1^B63439555
"RTN","RAPM",1,0)
RAPM ;HOIFO/TH-Radiology Performance Monitors/Indicator; ;2/4/04  10:17
"RTN","RAPM",2,0)
 ;;5.0;Radiology/Nuclear Medicine;**37,44**;Mar 16, 1998
"RTN","RAPM",3,0)
 ;
"RTN","RAPM",4,0)
 ; *** Application variables: ***
"RTN","RAPM",5,0)
 ;
"RTN","RAPM",6,0)
 ; Exam Date - RADTE (Regular Fileman format)
"RTN","RAPM",7,0)
 ;             RADTI (Inverse Fileman format)
"RTN","RAPM",8,0)
 ; Case Number - RACN               Exam Status - RAEXST
"RTN","RAPM",9,0)
 ; Category of Exam - RACAT         Primary Interpreting Staff - RAPRIM
"RTN","RAPM",10,0)
 ; Date Report Entered - RARPTDT    Verified Date - RAVERDT
"RTN","RAPM",11,0)
 ; Report Status - RARPTST          Page Number - RAPG
"RTN","RAPM",12,0)
 ; Type of Report - RARPT
"RTN","RAPM",13,0)
 ; Internal number of an entry in the Patient file (#2) - RADFN
"RTN","RAPM",14,0)
 ;
"RTN","RAPM",15,0)
INIT ; Check for the existence of RACESS. Pass in user's DUZ!
"RTN","RAPM",16,0)
 I $D(DUZ),($O(RACCESS(DUZ,""))']"") D CHECK^RADLQ3(DUZ)
"RTN","RAPM",17,0)
 ;
"RTN","RAPM",18,0)
 N DIR,DIRUT,RABDATE,RAEDATE,RARPT,DTDIFF,RABEGDT,RAENDDT,RA1
"RTN","RAPM",19,0)
 N RAM,RARAD,RAR,RAMSG,X,Y
"RTN","RAPM",20,0)
 S (RABDATE,RAEDATE,RAANS,RAANS2,RANODIV,RASINCE,RARAD)=""
"RTN","RAPM",21,0)
 ; RANODIV=1 if one or more exams are missing DIVISION
"RTN","RAPM",22,0)
PROMPT ; 
"RTN","RAPM",23,0)
 W @IOF
"RTN","RAPM",24,0)
 W !!,"Radiology Performance Indicator Report",!!
"RTN","RAPM",25,0)
 ; Prompt for Report Type. Quit if no report type selected
"RTN","RAPM",26,0)
 D GETRPT K DIR Q:$D(DIRUT)
"RTN","RAPM",27,0)
 ; Prompt for Date Range - Quit if no dates selected
"RTN","RAPM",28,0)
 W !! D GETDATE K DIR Q:$D(DIRUT)
"RTN","RAPM",29,0)
 ; Prompt for Radiologist if Short or Both
"RTN","RAPM",30,0)
 D RADIOL^RAPM3
"RTN","RAPM",31,0)
 ; Prompt for Division and Imaging Types
"RTN","RAPM",32,0)
 S X=$$DIVLOC^RAUTL7() I X G EXIT
"RTN","RAPM",33,0)
 I $D(^TMP($J,"RA I-TYPE","VASCULAR LAB")) D
"RTN","RAPM",34,0)
 . K ^TMP($J,"RA I-TYPE","VASCULAR LAB")
"RTN","RAPM",35,0)
 . W !!?5,"*** Imaging type 'Vascular Lab' will not be included in this report ***"
"RTN","RAPM",36,0)
 ; Prompt for sort option if Detail
"RTN","RAPM",37,0)
 D:RARPT'="S" SORT K DIR Q:$D(DIRUT)
"RTN","RAPM",38,0)
 ; Prompt for mail delivery if Short or Both
"RTN","RAPM",39,0)
 I RARPT'="D" D EMAIL^RAPM2 K DIR Q:$D(DIRUT)
"RTN","RAPM",40,0)
 ; Warning for Detail or Both
"RTN","RAPM",41,0)
 I RARPT="D"!(RARPT="B") D
"RTN","RAPM",42,0)
 . S RATXT="*** The detail report requires a 132 column output device ***"
"RTN","RAPM",43,0)
 . S RALINE="",$P(RALINE,"*",$L(RATXT))=""
"RTN","RAPM",44,0)
 . W !!?(80-$L(RATXT)\2),RALINE,!?(80-$L(RATXT)\2),RATXT,!?(80-$L(RATXT)\2),RALINE,!
"RTN","RAPM",45,0)
 .Q
"RTN","RAPM",46,0)
 D DEV
"RTN","RAPM",47,0)
 I RAPOP D  G EXIT
"RTN","RAPM",48,0)
 . I RAANS!(RAANS2) W !?5,"** No mail will be sent **",$C(7)
"RTN","RAPM",49,0)
 . Q
"RTN","RAPM",50,0)
START ; Get data and print the report
"RTN","RAPM",51,0)
 S:$D(ZTQUEUED) ZTREQ="@" S RAIO=$S(IO="":0,1:1)
"RTN","RAPM",52,0)
 D GETDATA
"RTN","RAPM",53,0)
 I RARPT="S"!(RARPT="B") S RAPG=0 D ^RAPM1
"RTN","RAPM",54,0)
 I RARPT="D"!(RARPT="B") S RAPG=0 D ^RAPM2
"RTN","RAPM",55,0)
 ; see if need send email
"RTN","RAPM",56,0)
 D SEND^RAPM2
"RTN","RAPM",57,0)
 D EXIT
"RTN","RAPM",58,0)
 Q
"RTN","RAPM",59,0)
 ;
"RTN","RAPM",60,0)
GETRPT ; Prompt for Summary or Detail or Both reports; Default = Summary Report
"RTN","RAPM",61,0)
 W !,"Enter Report Type"
"RTN","RAPM",62,0)
 S DIR(0)="S^S:Summary;D:Detail;B:Both"
"RTN","RAPM",63,0)
 S DIR("A")="Select Report Type",DIR("B")="S"
"RTN","RAPM",64,0)
 S DIR("?")="Enter Summary report OR Detail report OR Both reports"
"RTN","RAPM",65,0)
 D ^DIR
"RTN","RAPM",66,0)
 Q:$D(DIRUT) 
"RTN","RAPM",67,0)
 S RARPT=Y
"RTN","RAPM",68,0)
 Q
"RTN","RAPM",69,0)
GETDATE ; Prompt for start and end dates
"RTN","RAPM",70,0)
 S DIR(0)="D^:"_DT_":AE"
"RTN","RAPM",71,0)
 I RARPT'="D" D
"RTN","RAPM",72,0)
 . W !!?4,"The begin date for Summary and Both must be at least 10 days before today.",!
"RTN","RAPM",73,0)
 . S X1=DT,X2=-10 D C^%DTC S RA1=X
"RTN","RAPM",74,0)
 . S DIR(0)="D^:"_RA1_":AE"
"RTN","RAPM",75,0)
 . Q
"RTN","RAPM",76,0)
 S DIR("A")="Enter starting date"
"RTN","RAPM",77,0)
 S DIR("?")="Enter date to begin searching from"
"RTN","RAPM",78,0)
 D ^DIR
"RTN","RAPM",79,0)
 Q:$D(DIRUT)
"RTN","RAPM",80,0)
 S RABDATE=Y
"RTN","RAPM",81,0)
 ;
"RTN","RAPM",82,0)
 S RADD=$S(RARPT="S":91,1:31),X1=RABDATE,X2=RADD D C^%DTC S RAMAXDT=X
"RTN","RAPM",83,0)
 ; put 10 day block for summary report or Both
"RTN","RAPM",84,0)
 I RARPT'="D" D
"RTN","RAPM",85,0)
 . W !!?4,"The ending date for Summary and Both must be at least 10 days before today.",!
"RTN","RAPM",86,0)
 . S X1=DT,X2=-10 D C^%DTC S:X<RAMAXDT RAMAXDT=X
"RTN","RAPM",87,0)
 S:RAMAXDT>DT RAMAXDT=DT
"RTN","RAPM",88,0)
 S DIR(0)="D^"_RABDATE_":"_RAMAXDT_":AE"
"RTN","RAPM",89,0)
 S DIR("A")="Enter ending date:  "
"RTN","RAPM",90,0)
 S DIR("?",1)="     +91 days max. for Summary, +31 days max. for Detail."
"RTN","RAPM",91,0)
 S DIR("?",2)="     And the ending date for the Summary and Both"
"RTN","RAPM",92,0)
 S DIR("?")="     must be at least 10 days before today."
"RTN","RAPM",93,0)
 D ^DIR
"RTN","RAPM",94,0)
 Q:$D(DIRUT)
"RTN","RAPM",95,0)
 ;
"RTN","RAPM",96,0)
 ; Set end date to end of day
"RTN","RAPM",97,0)
 ; RABDATE and RAEDATE are original values
"RTN","RAPM",98,0)
 ; RABEGDT and RAENDDT are used in GETDATA 
"RTN","RAPM",99,0)
 S RAEDATE=Y,RAENDDT=RAEDATE_.9999
"RTN","RAPM",100,0)
 ; Set start date back to include current day
"RTN","RAPM",101,0)
 S RABEGDT=(RABDATE-1)_.9999
"RTN","RAPM",102,0)
 Q
"RTN","RAPM",103,0)
SORT ; Prompt for Sorted by
"RTN","RAPM",104,0)
 W !!,"Sort report by"
"RTN","RAPM",105,0)
 S DIR(0)="S^C:Case Number;E:Cateory of Exam;I:Imaging Type;P:Patient Name;R:Radiologist;T:Hrs to Transcrip.;V:Hrs to Verif."
"RTN","RAPM",106,0)
 S DIR("A")="Select Sorted by",DIR("B")="C"
"RTN","RAPM",107,0)
 D ^DIR
"RTN","RAPM",108,0)
 Q:$D(DIRUT)
"RTN","RAPM",109,0)
 S RASORT=Y
"RTN","RAPM",110,0)
 S DIR(0)="N^0:240"
"RTN","RAPM",111,0)
 S DIR("A")="Print PENDING and "_$S(RASORT="V":"Verif.",1:"Transrip.")_" hours greater than or equal to"
"RTN","RAPM",112,0)
 S DIR("B")="72"
"RTN","RAPM",113,0)
 S DIR("?")="Enter minimum number of hours elapsed since registration."
"RTN","RAPM",114,0)
 D ^DIR Q:$D(DIRUT)  S RASINCE=Y
"RTN","RAPM",115,0)
 Q
"RTN","RAPM",116,0)
DEV ; Device
"RTN","RAPM",117,0)
 I $D(DIRUT) D EXIT Q
"RTN","RAPM",118,0)
 W:RARPT="B" !!,"Specify device for both summary and detail reports."
"RTN","RAPM",119,0)
 D TASK
"RTN","RAPM",120,0)
 D ZIS^RAUTL
"RTN","RAPM",121,0)
 Q
"RTN","RAPM",122,0)
TASK ; set vars for taskman
"RTN","RAPM",123,0)
 S ZTRTN="START^RAPM"
"RTN","RAPM",124,0)
 S ZTSAVE("RA*")=""
"RTN","RAPM",125,0)
 S ZTSAVE("^TMP($J,""RA D-TYPE"",")=""
"RTN","RAPM",126,0)
 S ZTSAVE("^TMP($J,""RA I-TYPE"",")=""
"RTN","RAPM",127,0)
 S ZTDESC="Radiology Performance Indicator Report"
"RTN","RAPM",128,0)
 Q
"RTN","RAPM",129,0)
 ;
"RTN","RAPM",130,0)
GETDATA ; Get all the data
"RTN","RAPM",131,0)
 ; Order thru Exam Date (RADTE)
"RTN","RAPM",132,0)
 S RADTE=RABEGDT F  S RADTE=$O(^RADPT("AR",RADTE)) Q:'RADTE  Q:(RADTE>RAENDDT)  D
"RTN","RAPM",133,0)
 . S RADFN="" F  S RADFN=$O(^RADPT("AR",RADTE,RADFN)) Q:'RADFN  D
"RTN","RAPM",134,0)
 . . ; Get patient name
"RTN","RAPM",135,0)
 . . S RAPATNM=$$GET1^DIQ(2,RADFN,.01) S:RAPATNM="" RAPATNM=" "
"RTN","RAPM",136,0)
 . . ; Order thru inverse Exam Date (RADTI)
"RTN","RAPM",137,0)
 . . S RADTI="" F  S RADTI=$O(^RADPT("AR",RADTE,RADFN,RADTI)) Q:'RADTI  D CHECK
"RTN","RAPM",138,0)
 . . Q
"RTN","RAPM",139,0)
 . Q
"RTN","RAPM",140,0)
 Q
"RTN","RAPM",141,0)
CHECK ; Check type of image
"RTN","RAPM",142,0)
 Q:'$D(^RADPT(RADFN,"DT",RADTI))  ;no exam data at all
"RTN","RAPM",143,0)
 S RAITYP=$P($G(^RADPT(RADFN,"DT",RADTI,0)),U,2)
"RTN","RAPM",144,0)
 S RAIMGTYP=$P($G(^RA(79.2,+RAITYP,0)),U,1)
"RTN","RAPM",145,0)
 ; quit if img typ is known AND does not match selection
"RTN","RAPM",146,0)
 I RAIMGTYP'="",'$D(^TMP($J,"RA I-TYPE",RAIMGTYP)) Q
"RTN","RAPM",147,0)
 I RAIMGTYP="" S RAIMGTYP="(unknown)"
"RTN","RAPM",148,0)
 ;
"RTN","RAPM",149,0)
 ; Check division - Quit if no division selected
"RTN","RAPM",150,0)
 S RASELDIV=$P($G(^RADPT(RADFN,"DT",RADTI,0)),U,3)
"RTN","RAPM",151,0)
 S RACHKDIV=$P($G(^DIC(4,+RASELDIV,0)),U,1)
"RTN","RAPM",152,0)
 ; quit if div is known AND does not match selection 
"RTN","RAPM",153,0)
 I RACHKDIV'="",'$D(^TMP($J,"RA D-TYPE",RACHKDIV)) Q
"RTN","RAPM",154,0)
 S:RACHKDIV="" RANODIV=1
"RTN","RAPM",155,0)
 ;
"RTN","RAPM",156,0)
 ; Get exam related data
"RTN","RAPM",157,0)
 S RACNI=0 F  S RACNI=$O(^RADPT(RADFN,"DT",RADTI,"P",RACNI)) Q:'RACNI  D
"RTN","RAPM",158,0)
 . S (RACN0,RAEXST,RANUM,RACN,RAPRIM,RAPRIMNM,RACAT,RARPTTXT)=""
"RTN","RAPM",159,0)
 . S (RARPTDT,RAVERDT,RARPTST,RADHT,RADHV,RATDFHR,RAVDFHR)=""
"RTN","RAPM",160,0)
 . ; Get 0 node (RACN0) of ^RADPT(RADFN,"DT",RADTI,"P",RACNI,0)
"RTN","RAPM",161,0)
 . S RACN0=$G(^RADPT(RADFN,"DT",RADTI,"P",RACNI,0))
"RTN","RAPM",162,0)
 . Q:RACN0=""  ; no exam data
"RTN","RAPM",163,0)
 . ; Get Case number: Exam Date - Case Number
"RTN","RAPM",164,0)
 . S RACN=$E(RADTE,4,7)_$E(RADTE,2,3)_"-"_$P(RACN0,U,1)
"RTN","RAPM",165,0)
 . ; Get exam status
"RTN","RAPM",166,0)
 . S RAEXST=$P(RACN0,U,3)
"RTN","RAPM",167,0)
 . Q:RAEXST=""  ; no exam status
"RTN","RAPM",168,0)
 . ; Quit if exam status is "Cancelled"
"RTN","RAPM",169,0)
 . I $P(^RA(72,RAEXST,0),U,3)=0 Q
"RTN","RAPM",170,0)
 . ; Get number of set - '1' separate; '2' for combined report.
"RTN","RAPM",171,0)
 . S RANUM=$P(RACN0,U,25)
"RTN","RAPM",172,0)
 . ; if member of set > 1 then set RACNI to 99999 to skip remaining cases
"RTN","RAPM",173,0)
 . I RANUM>1 S RACNI=99999
"RTN","RAPM",174,0)
 . ; Get Radiologist (Primary Interpreting Staff) internal # and name. 
"RTN","RAPM",175,0)
 . S RAPRIM=$P(RACN0,U,15)
"RTN","RAPM",176,0)
 . ; if specific radiologist requested, quit if not his/her case
"RTN","RAPM",177,0)
 . I RARAD,RAPRIM'=RARAD Q
"RTN","RAPM",178,0)
 . S RAPRIMNM=$$GET1^DIQ(200,RAPRIM,.01) S:RAPRIMNM="" RAPRIMNM=" "
"RTN","RAPM",179,0)
 . ; Get Category of Exam
"RTN","RAPM",180,0)
 . S RACAT=$P(RACN0,U,4)
"RTN","RAPM",181,0)
 . ; Get Procedure Name
"RTN","RAPM",182,0)
 . S RAPRCN=$P($G(^RAMIS(71,+$P(RACN0,U,2),0)),U)
"RTN","RAPM",183,0)
 . ; Get IEN of imaging report
"RTN","RAPM",184,0)
 . S RARPTTXT=$P(RACN0,U,17)
"RTN","RAPM",185,0)
 . ; Pending if no imaging report OR report doesn't exist in the Report
"RTN","RAPM",186,0)
 . ; file (#74) OR Stub report
"RTN","RAPM",187,0)
 . S RAHASR=0 ;=1 has real report
"RTN","RAPM",188,0)
 . I $D(^RARPT(+RARPTTXT,0)),'$$STUB^RAEDCN1(+RARPTTXT) S RAHASR=1
"RTN","RAPM",189,0)
 . I 'RAHASR D
"RTN","RAPM",190,0)
 . . S ^TMP($J,"RAPM","TR",0)=$G(^TMP($J,"RAPM","TR",0))+1
"RTN","RAPM",191,0)
 . . S ^TMP($J,"RAPM","VR",0)=$G(^TMP($J,"RAPM","VR",0))+1
"RTN","RAPM",192,0)
 . ; Get report info. if real report exists.
"RTN","RAPM",193,0)
 . I RAHASR D RPTINFO^RAPM1
"RTN","RAPM",194,0)
 . D STORE^RAPM2
"RTN","RAPM",195,0)
 . ; Calculate the total number of reports
"RTN","RAPM",196,0)
 . S ^TMP($J,"RAPM","TOTAL")=$G(^TMP($J,"RAPM","TOTAL"))+1
"RTN","RAPM",197,0)
 Q
"RTN","RAPM",198,0)
EXIT ; Exit
"RTN","RAPM",199,0)
 ; Close device
"RTN","RAPM",200,0)
 D CLOSE^RAUTL
"RTN","RAPM",201,0)
 K RACN0,RAEXST,RANUM,RACN,RAPRIM,RAPRIMNM,RACAT,RARPTTXT,RAANS,RATXT
"RTN","RAPM",202,0)
 K DIR,DIRUT,RABDATE,RAEDATE,RARPT,DTDIFF,RABEGDT,RAENDDT,RAITYP,RAIMGTYP,RATYP
"RTN","RAPM",203,0)
 K ZTRTN,ZTSAVE,ZTDESC,RAPG,RASELDIV,RACHKDIV,RACNO,RAVHRS
"RTN","RAPM",204,0)
 K RADIV,RAN,RAIMG,RAREC1,RATOTCNT,RACNI,RADFN,RADTE,RADTI,RAHD,RAPATNM
"RTN","RAPM",205,0)
 K RAPOP,RAPSTX,RAQUIT,RAREC,RARPTDT,RARPTST,RASORT,RASRT,RATDFHR,RAHASR
"RTN","RAPM",206,0)
 K RATDFSEC,RATHRS,RAVDFHR,RAVDFSEC,RAVERDT,RAMES,RALINE,RAMAXDT,RADD
"RTN","RAPM",207,0)
 K RAANS2,RAIOM,RAHDR,RANODIV,RASINCE,RADHT,RADHV,RAVAL,RAPRCN
"RTN","RAPM",208,0)
 K ^TMP($J)
"RTN","RAPM",209,0)
 Q
"RTN","RAPM1")
0^2^B44195170
"RTN","RAPM1",1,0)
RAPM1 ;HOIFO/TH-Radiology Performance Monitors/Indicator; ;2/18/04  09:42
"RTN","RAPM1",2,0)
 ;;5.0;Radiology/Nuclear Medicine;**37,44**;Mar 16, 1998
"RTN","RAPM1",3,0)
 ; Summary Report
"RTN","RAPM1",4,0)
 D HDR^RAPM2("S")
"RTN","RAPM1",5,0)
 ; Print total reports
"RTN","RAPM1",6,0)
 W !,"Total number of reports expected for procedures performed during "
"RTN","RAPM1",7,0)
 W "specified",!,"date range: "
"RTN","RAPM1",8,0)
 S RATOTCNT=+$G(^TMP($J,"RAPM","TOTAL"))
"RTN","RAPM1",9,0)
 W $J(+RATOTCNT,$L(+RATOTCNT))
"RTN","RAPM1",10,0)
 S RAN=RAN+1,^TMP($J,"RAPM",RAN)="",RAN=RAN+1
"RTN","RAPM1",11,0)
 S ^TMP($J,"RAPM",RAN)="Total number of reports expected for procedures performed during specified",RAN=RAN+1
"RTN","RAPM1",12,0)
 S ^TMP($J,"RAPM",RAN)="date range: "_$J(+RATOTCNT,$L(+RATOTCNT)),RAN=RAN+1,^TMP($J,"RAPM",RAN)="",RAN=RAN+1
"RTN","RAPM1",13,0)
 D SHDR,SRPT,SFOOT^RAPM3
"RTN","RAPM1",14,0)
 Q
"RTN","RAPM1",15,0)
SHDR ; Print header of summary report
"RTN","RAPM1",16,0)
 G:'RAIO SHDR2 ; skip writes if original IO is null
"RTN","RAPM1",17,0)
 I ($Y+5)>IOSL,IO=IO(0) D
"RTN","RAPM1",18,0)
 . I $E(IOST,1,2)="C-" R !,"Press RETURN to continue.",X:DTIME
"RTN","RAPM1",19,0)
 . S RAPG=RAPG+1,RAHDR="Summary Performance Indicator Report"
"RTN","RAPM1",20,0)
 . W @IOF,!?(RAIOM-$L(RAHDR)\2),RAHDR,?(RAIOM-10),"Page: ",$G(RAPG)
"RTN","RAPM1",21,0)
 W !!,"Hrs ",?8,">0",?14,">24",?21,">48",?27,">72",?33,">96"
"RTN","RAPM1",22,0)
 W ?38,">120",?44,">144",?50,">168",?56,">192",?62,">216",?68,">240"
"RTN","RAPM1",23,0)
 W ?73,"PENDING"
"RTN","RAPM1",24,0)
 W !,"From",?7,"-24",?14,"-48",?21,"-72",?27,"-96",?32,"-120",?38,"-144"
"RTN","RAPM1",25,0)
 W ?44,"-168",?50,"-192",?56,"-216",?62,"-240",?68,"Hrs"
"RTN","RAPM1",26,0)
 W !,"Ex Dt",?7,"Hrs",?14,"Hrs",?21,"Hrs",?27,"Hrs",?33,"Hrs",?39,"Hrs",?45,"Hrs",?51,"Hrs",?57,"Hrs",?63,"Hrs",!
"RTN","RAPM1",27,0)
SHDR2 ;save to tmp
"RTN","RAPM1",28,0)
 S ^TMP($J,"RAPM",RAN)="Hrs    >0    >24    >48   >72   >96  >120  >144  >168  >192  >216  >240 PENDING",RAN=RAN+1
"RTN","RAPM1",29,0)
 S ^TMP($J,"RAPM",RAN)="From  -24    -48    -72   -96  -120  -144  -168  -192  -216  -240  Hrs",RAN=RAN+1
"RTN","RAPM1",30,0)
 S ^TMP($J,"RAPM",RAN)="Ex Dt Hrs    Hrs    Hrs   Hrs   Hrs   Hrs   Hrs   Hrs   Hrs   Hrs",RAN=RAN+1
"RTN","RAPM1",31,0)
 S ^TMP($J,"RAPM",RAN)="",RAN=RAN+1
"RTN","RAPM1",32,0)
 Q
"RTN","RAPM1",33,0)
SRPT ; Print summary report
"RTN","RAPM1",34,0)
 G:'RAIO SRPT2
"RTN","RAPM1",35,0)
 I ($Y+5)>IOSL,IO=IO(0) D SHDR
"RTN","RAPM1",36,0)
 I RATOTCNT=0 W:RAIO !,?4,"No data to print..." Q
"RTN","RAPM1",37,0)
 ;
"RTN","RAPM1",38,0)
 W !,"#Tr",?4,$J(+$G(^TMP($J,"RAPM","TR",1)),6),?11,$J(+$G(^(2)),6),?18,$J(+$G(^(3)),6),?25,$J(+$G(^(4)),5)
"RTN","RAPM1",39,0)
 W ?31,$J(+$G(^TMP($J,"RAPM","TR",5)),5),?37,$J(+$G(^(6)),5),?43,$J(+$G(^(7)),5),?49,$J(+$G(^(8)),5),?55,$J(+$G(^(9)),5)
"RTN","RAPM1",40,0)
 W ?61,$J(+$G(^TMP($J,"RAPM","TR",10)),5),?67,$J(+$G(^(11)),5),?73,$J(+$G(^(0)),7)
"RTN","RAPM1",41,0)
 ;
"RTN","RAPM1",42,0)
 W !,"%Tr",?4,$J((+$G(^TMP($J,"RAPM","TR",1))/RATOTCNT)*100,6,1)
"RTN","RAPM1",43,0)
 W ?11,$J((+$G(^TMP($J,"RAPM","TR",2))/RATOTCNT)*100,6,1),?18,$J((+$G(^(3))/RATOTCNT)*100,6,1),?25,$J((+$G(^(4))/RATOTCNT)*100,5,1)
"RTN","RAPM1",44,0)
 W ?31,$J((+$G(^TMP($J,"RAPM","TR",5))/RATOTCNT)*100,5,1),?37,$J((+$G(^(6))/RATOTCNT)*100,5,1),?43,$J((+$G(^(7))/RATOTCNT)*100,5,1),?49,$J((+$G(^(8))/RATOTCNT)*100,5,1)
"RTN","RAPM1",45,0)
 W ?55,$J((+$G(^TMP($J,"RAPM","TR",9))/RATOTCNT)*100,5,1),?61,$J((+$G(^(10))/RATOTCNT)*100,5,1),?67,$J((+$G(^(11))/RATOTCNT)*100,5,1),?73,$J((+$G(^(0))/RATOTCNT)*100,7,1),!
"RTN","RAPM1",46,0)
 ;
"RTN","RAPM1",47,0)
 W !,"#Vr",?4,$J(+$G(^TMP($J,"RAPM","VR",1)),6),?11,$J(+$G(^(2)),6),?18,$J(+$G(^(3)),6),?25,$J(+$G(^(4)),5),?31,$J(+$G(^(5)),5)
"RTN","RAPM1",48,0)
 W ?37,$J(+$G(^TMP($J,"RAPM","VR",6)),5),?43,$J(+$G(^(7)),5),?49,$J(+$G(^(8)),5),?55,$J(+$G(^(9)),5),?61,$J(+$G(^(10)),5)
"RTN","RAPM1",49,0)
 W ?67,$J(+$G(^TMP($J,"RAPM","VR",11)),5),?73,$J(+$G(^(0)),7)
"RTN","RAPM1",50,0)
 ;
"RTN","RAPM1",51,0)
 W !,"%Vr",?4,$J((+$G(^TMP($J,"RAPM","VR",1))/RATOTCNT)*100,6,1),?11,$J((+$G(^(2))/RATOTCNT)*100,6,1),?18,$J((+$G(^(3))/RATOTCNT)*100,6,1)
"RTN","RAPM1",52,0)
 W ?25,$J((+$G(^TMP($J,"RAPM","VR",4))/RATOTCNT)*100,5,1),?31,$J((+$G(^(5))/RATOTCNT)*100,5,1),?37,$J((+$G(^(6))/RATOTCNT)*100,5,1),?43,$J((+$G(^(7))/RATOTCNT)*100,5,1)
"RTN","RAPM1",53,0)
 W ?49,$J((+$G(^TMP($J,"RAPM","VR",8))/RATOTCNT)*100,5,1),?55,$J((+$G(^(9))/RATOTCNT)*100,5,1),?61,$J((+$G(^(10))/RATOTCNT)*100,5,1),?67,$J((+$G(^(11))/RATOTCNT)*100,5,1)
"RTN","RAPM1",54,0)
 W ?73,$J((+$G(^TMP($J,"RAPM","VR",0))/RATOTCNT)*100,7,1),!
"RTN","RAPM1",55,0)
 ;
"RTN","RAPM1",56,0)
SRPT2 ; store in tmp
"RTN","RAPM1",57,0)
 S ^TMP($J,"RAPM",RAN)="#Tr"_$J(+$G(^TMP($J,"RAPM","TR",1)),6)_" "_$J(+$G(^(2)),6)_" "_$J(+$G(^(3)),6)_" "_$J(+$G(^(4)),5)_" "_$J(+$G(^(5)),5)
"RTN","RAPM1",58,0)
 S ^TMP($J,"RAPM",RAN)=^TMP($J,"RAPM",RAN)_" "_$J(+$G(^TMP($J,"RAPM","TR",6)),5)_" "_$J(+$G(^(7)),5)_" "_$J(+$G(^(8)),5)_" "_$J(+$G(^(9)),5)_" "_$J(+$G(^(10)),5)
"RTN","RAPM1",59,0)
 S ^TMP($J,"RAPM",RAN)=^TMP($J,"RAPM",RAN)_" "_$J(+$G(^TMP($J,"RAPM","TR",11)),5)_" "_$J(+$G(^(0)),7) S RAN=RAN+1
"RTN","RAPM1",60,0)
 ;
"RTN","RAPM1",61,0)
 S ^TMP($J,"RAPM",RAN)="%Tr"_$J((+$G(^TMP($J,"RAPM","TR",1))/RATOTCNT)*100,6,1)_" "_$J((+$G(^(2))/RATOTCNT)*100,6,1)_" "_$J((+$G(^(3))/RATOTCNT)*100,6,1)_" "_$J((+$G(^(4))/RATOTCNT)*100,5,1)
"RTN","RAPM1",62,0)
 S ^TMP($J,"RAPM",RAN)=$G(^TMP($J,"RAPM",RAN))_" "_$J((+$G(^TMP($J,"RAPM","TR",5))/RATOTCNT)*100,5,1)_" "_$J((+$G(^(6))/RATOTCNT)*100,5,1)_" "_$J((+$G(^(7))/RATOTCNT)*100,5,1)
"RTN","RAPM1",63,0)
 S ^TMP($J,"RAPM",RAN)=$G(^TMP($J,"RAPM",RAN))_" "_$J((+$G(^TMP($J,"RAPM","TR",8))/RATOTCNT)*100,5,1)_" "_$J((+$G(^(9))/RATOTCNT)*100,5,1)_" "_$J((+$G(^(10))/RATOTCNT)*100,5,1)
"RTN","RAPM1",64,0)
 S ^TMP($J,"RAPM",RAN)=$G(^TMP($J,"RAPM",RAN))_" "_$J((+$G(^TMP($J,"RAPM","TR",11))/RATOTCNT)*100,5,1)_" "_$J((+$G(^(0))/RATOTCNT)*100,7,1)
"RTN","RAPM1",65,0)
 S RAN=RAN+1,^TMP($J,"RAPM",RAN)="",RAN=RAN+1
"RTN","RAPM1",66,0)
 ;
"RTN","RAPM1",67,0)
 S ^TMP($J,"RAPM",RAN)="#Vr"_$J(+$G(^TMP($J,"RAPM","VR",1)),6)_" "_$J(+$G(^(2)),6)_" "_$J(+$G(^(3)),6)_" "_$J(+$G(^(4)),5)_" "_$J(+$G(^(5)),5)
"RTN","RAPM1",68,0)
 S ^TMP($J,"RAPM",RAN)=$G(^TMP($J,"RAPM",RAN))_" "_$J(+$G(^TMP($J,"RAPM","VR",6)),5)_" "_$J(+$G(^(7)),5)_" "_$J(+$G(^(8)),5)_" "_$J(+$G(^(9)),5)_" "_$J(+$G(^(10)),5)
"RTN","RAPM1",69,0)
 S ^TMP($J,"RAPM",RAN)=$G(^TMP($J,"RAPM",RAN))_" "_$J(+$G(^TMP($J,"RAPM","VR",11)),5)_" "_$J(+$G(^(0)),7) S RAN=RAN+1
"RTN","RAPM1",70,0)
 ;
"RTN","RAPM1",71,0)
 S ^TMP($J,"RAPM",RAN)="%Vr"_$J((+$G(^TMP($J,"RAPM","VR",1))/RATOTCNT)*100,6,1)_" "_$J((+$G(^(2))/RATOTCNT)*100,6,1)_" "_$J((+$G(^(3))/RATOTCNT)*100,6,1)_" "_$J((+$G(^(4))/RATOTCNT)*100,5,1)
"RTN","RAPM1",72,0)
 S ^TMP($J,"RAPM",RAN)=$G(^TMP($J,"RAPM",RAN))_" "_$J((+$G(^TMP($J,"RAPM","VR",5))/RATOTCNT)*100,5,1)_" "_$J((+$G(^(6))/RATOTCNT)*100,5,1)_" "_$J((+$G(^(7))/RATOTCNT)*100,5,1)
"RTN","RAPM1",73,0)
 S ^TMP($J,"RAPM",RAN)=$G(^TMP($J,"RAPM",RAN))_" "_$J((+$G(^TMP($J,"RAPM","VR",8))/RATOTCNT)*100,5,1)_" "_$J((+$G(^(9))/RATOTCNT)*100,5,1)_" "_$J((+$G(^(10))/RATOTCNT)*100,5,1)
"RTN","RAPM1",74,0)
 S ^TMP($J,"RAPM",RAN)=$G(^TMP($J,"RAPM",RAN))_" "_$J((+$G(^TMP($J,"RAPM","VR",11))/RATOTCNT)*100,5,1)_" "_$J((+$G(^(0))/RATOTCNT)*100,7,1) S RAN=RAN+1
"RTN","RAPM1",75,0)
 Q
"RTN","RAPM1",76,0)
RPTINFO ; Other report info.
"RTN","RAPM1",77,0)
 ; Get Date/Time Report Entered, replace prev RACN with data from Report
"RTN","RAPM1",78,0)
 S RARPTDT=$P(^RARPT(RARPTTXT,0),U,6),RACN=$P(^(0),U)
"RTN","RAPM1",79,0)
 ; Get Verified Date/Time
"RTN","RAPM1",80,0)
 S RAVERDT=$P(^RARPT(RARPTTXT,0),U,7)
"RTN","RAPM1",81,0)
 ; Use 1st Verified Date/Time for amended reports
"RTN","RAPM1",82,0)
 I RAVERDT,$O(^RARPT(RARPTTXT,"ERR",0)) D
"RTN","RAPM1",83,0)
 . S RA1=0
"RTN","RAPM1",84,0)
 . F  S RA1=$O(^RARPT(RARPTTXT,"L",RA1)) Q:'RA1  I $D(^(RA1,0)),$P(^(0),U,2)="V" S RAVERDT=$P(^(0),U)
"RTN","RAPM1",85,0)
 . Q
"RTN","RAPM1",86,0)
 I RARPTDT="" S ^TMP($J,"RAPM","TR",0)=$G(^TMP($J,"RAPM","TR",0))+1
"RTN","RAPM1",87,0)
 I RAVERDT="" S ^TMP($J,"RAPM","VR",0)=$G(^TMP($J,"RAPM","VR",0))+1
"RTN","RAPM1",88,0)
 ; Get Report Status
"RTN","RAPM1",89,0)
 S RARPTST=$P(^RARPT(RARPTTXT,0),U,5)
"RTN","RAPM1",90,0)
 ;
"RTN","RAPM1",91,0)
CAL ; Calculation: Null report pointer, no report, no report date, no 
"RTN","RAPM1",92,0)
 ; verfied date are counted as diff=0
"RTN","RAPM1",93,0)
 ; # of Transcribed = Total # of transcribed exams not cancelled.
"RTN","RAPM1",94,0)
 ; # of hrs from exam registration = Date/Time transcribed 
"RTN","RAPM1",95,0)
 ;      (Date Report Entered) - Exam Date/time
"RTN","RAPM1",96,0)
 I RARPTDT D
"RTN","RAPM1",97,0)
 . S RATDFSEC=$$FMDIFF^XLFDT(RARPTDT,RADTE,2)
"RTN","RAPM1",98,0)
 . S RATDFHR=RATDFSEC/3600
"RTN","RAPM1",99,0)
 . S RATHRS=$S(RATDFHR=0:0,RATDFHR'>24:1,RATDFHR'>48:2,RATDFHR'>72:3,RATDFHR'>96:4,RATDFHR'>120:5,RATDFHR'>144:6,RATDFHR'>168:7,RATDFHR'>192:8,RATDFHR'>216:9,RATDFHR'>240:10,1:11)
"RTN","RAPM1",100,0)
 . S ^(RATHRS)=$G(^TMP($J,"RAPM","TR",RATHRS))+1
"RTN","RAPM1",101,0)
 ;
"RTN","RAPM1",102,0)
 I RAVERDT D
"RTN","RAPM1",103,0)
 . S RAVDFSEC=$$FMDIFF^XLFDT(RAVERDT,RADTE,2)
"RTN","RAPM1",104,0)
 . S RAVDFHR=RAVDFSEC/3600
"RTN","RAPM1",105,0)
 . S RAVHRS=$S(RAVDFHR=0:0,RAVDFHR'>24:1,RAVDFHR'>48:2,RAVDFHR'>72:3,RAVDFHR'>96:4,RAVDFHR'>120:5,RAVDFHR'>144:6,RAVDFHR'>168:7,RAVDFHR'>192:8,RAVDFHR'>216:9,RAVDFHR'>240:10,1:11)
"RTN","RAPM1",106,0)
 . S ^(RAVHRS)=$G(^TMP($J,"RAPM","VR",RAVHRS))+1
"RTN","RAPM1",107,0)
 Q
"RTN","RAPM2")
0^3^B77984038
"RTN","RAPM2",1,0)
RAPM2 ;HOIFO/TH-Radiology Performance Monitors/Indicator; ;2/26/04  12:41
"RTN","RAPM2",2,0)
 ;;5.0;Radiology/Nuclear Medicine;**37,44**;Mar 16, 1998
"RTN","RAPM2",3,0)
 ; IA 10090 allows Read w/Fileman for entire file 4
"RTN","RAPM2",4,0)
 ; Print Detail report
"RTN","RAPM2",5,0)
DETAIL ; Print Detail report
"RTN","RAPM2",6,0)
 I ($Y+5)>IOSL!(RARPT="B") D
"RTN","RAPM2",7,0)
 . I IO=IO(0),($E(IOST,1,2)="C-") D
"RTN","RAPM2",8,0)
 . . R !,"Press RETURN to continue. ",X:DTIME
"RTN","RAPM2",9,0)
 D HDR("D")
"RTN","RAPM2",10,0)
 D PRTTOT
"RTN","RAPM2",11,0)
 D DHDR
"RTN","RAPM2",12,0)
 D DRPT
"RTN","RAPM2",13,0)
 D DFOOT
"RTN","RAPM2",14,0)
 Q
"RTN","RAPM2",15,0)
 ;
"RTN","RAPM2",16,0)
PRTTOT ; Print total number of reports
"RTN","RAPM2",17,0)
 S RATOTCNT=+$G(^TMP($J,"RAPM","TOTAL"))
"RTN","RAPM2",18,0)
 W !,"Total number of reports expected for procedures performed during specified date range: ",$J(RATOTCNT,$L(RATOTCNT))
"RTN","RAPM2",19,0)
 Q
"RTN","RAPM2",20,0)
 ;
"RTN","RAPM2",21,0)
DHDR ; Header
"RTN","RAPM2",22,0)
 I ($Y+5)>IOSL D
"RTN","RAPM2",23,0)
 . S RAPG=RAPG+1,RAHD(0)="Detail Performance Indicator Report"
"RTN","RAPM2",24,0)
 . W @IOF,!?(RAIOM-$L(RAHD(0))\2),RAHD(0),?(RAIOM-10),"Page: ",$G(RAPG)
"RTN","RAPM2",25,0)
 W !!,?32,"Date/Time",?48,"Date/Time",?68,"Date/Time",?102,"Cat"
"RTN","RAPM2",26,0)
 W ?106,"Rpt",?110,"Img",?116,"Procedure"
"RTN","RAPM2",27,0)
 W !,"Patient Name",?18,"Case #",?32,"Registered",?48,"Transcribed",?62,"Hrs"
"RTN","RAPM2",28,0)
 W ?68,"Verified",?82,"Hrs",?87,"Radiologist",?102,"Exm",?106,"Sts"
"RTN","RAPM2",29,0)
 W ?110,"Typ",?119,"Name",!
"RTN","RAPM2",30,0)
 Q
"RTN","RAPM2",31,0)
 ;
"RTN","RAPM2",32,0)
DRPT ; Read records
"RTN","RAPM2",33,0)
 I '$D(^TMP($J,"RAPM2")) W !!?30,"No data to print...",!!!!! Q
"RTN","RAPM2",34,0)
 S D1="" F  S D1=$O(^TMP($J,"RAPM2",D1)) Q:D1=""  D
"RTN","RAPM2",35,0)
 . S D2="" F  S D2=$O(^TMP($J,"RAPM2",D1,D2)) Q:D2=""  D
"RTN","RAPM2",36,0)
 . . S D3="" F  S D3=$O(^TMP($J,"RAPM2",D1,D2,D3)) Q:D3=""  D
"RTN","RAPM2",37,0)
 . . . D SRT
"RTN","RAPM2",38,0)
 Q
"RTN","RAPM2",39,0)
 ;
"RTN","RAPM2",40,0)
SRT ; Read records
"RTN","RAPM2",41,0)
 I RASORT="C"!(RASORT="P") S RAREC=$G(^TMP($J,"RAPM2",D1,D2,D3)) D DET Q
"RTN","RAPM2",42,0)
 S D4="" F  S D4=$O(^TMP($J,"RAPM2",D1,D2,D3,D4)) Q:D4=""  D
"RTN","RAPM2",43,0)
 . S RAREC=$G(^TMP($J,"RAPM2",D1,D2,D3,D4)) D DET
"RTN","RAPM2",44,0)
 Q
"RTN","RAPM2",45,0)
 ;
"RTN","RAPM2",46,0)
DET ; Print detail records
"RTN","RAPM2",47,0)
 ; use Transcription elasped hr for all sorts, except if sort by Verif.
"RTN","RAPM2",48,0)
 S RAVAL=$S(RASORT="V":$P(RAREC,U,13),1:$P(RAREC,U,12))
"RTN","RAPM2",49,0)
 ; remove symbols before comparison
"RTN","RAPM2",50,0)
 S:$E(RAVAL)="<" RAVAL=.5 S:$E(RAVAL)=">" RAVAL=999
"RTN","RAPM2",51,0)
 ; include PENDING and those with hours > RASINCE
"RTN","RAPM2",52,0)
 I RAVAL'="",RAVAL<RASINCE Q
"RTN","RAPM2",53,0)
 I ($Y+5)>IOSL D
"RTN","RAPM2",54,0)
 . I IO=IO(0) D
"RTN","RAPM2",55,0)
 . . I $E(IOST,1,2)="C-" R !,"Press RETURN to continue. ",X:DTIME
"RTN","RAPM2",56,0)
 . D DHDR
"RTN","RAPM2",57,0)
 W !,$E($P(RAREC,U,2),1,15)
"RTN","RAPM2",58,0)
 W ?17,$P(RAREC,U,1)
"RTN","RAPM2",59,0)
 W ?31,$P($$FMTE^XLFDT($P(RAREC,U,3),"2FS"),":",1,2)
"RTN","RAPM2",60,0)
 W ?46,$P($$FMTE^XLFDT($P(RAREC,U,4),"2FS"),":",1,2),?61,$J($P(RAREC,U,12),4)
"RTN","RAPM2",61,0)
 W ?66,$P($$FMTE^XLFDT($P(RAREC,U,5),"2FS"),":",1,2),?81,$J($P(RAREC,U,13),4)
"RTN","RAPM2",62,0)
 I $P(RAREC,U,6)'="" W ?86,$E($P(RAREC,U,6),1,16)
"RTN","RAPM2",63,0)
 W ?104,$P(RAREC,U,7),?107,$P(RAREC,U,8)
"RTN","RAPM2",64,0)
 W ?110,$E($P(RAREC,U,9),1,3),?114,$E($P(RAREC,U,14),1,15)
"RTN","RAPM2",65,0)
 W:$P(RAREC,U,11)="" ?130,"*D"
"RTN","RAPM2",66,0)
 Q
"RTN","RAPM2",67,0)
 ;
"RTN","RAPM2",68,0)
DFOOT ; Footer for Detail report
"RTN","RAPM2",69,0)
 I ($Y+5)>IOSL D
"RTN","RAPM2",70,0)
 . I IO=IO(0) D
"RTN","RAPM2",71,0)
 . . I $E(IOST,1,2)="C-" R !,"Press RETURN to continue. ",X:DTIME
"RTN","RAPM2",72,0)
 . D DHDR
"RTN","RAPM2",73,0)
 W !!,"Note: Category of Exam: 'I' for Inpatient; 'O' for Outpatient; "
"RTN","RAPM2",74,0)
 W "'C' for Contract; 'S' for Sharing; 'E' for Employee; 'R' for Research"
"RTN","RAPM2",75,0)
 W !,"      Report Status:    'V' for Verififed; 'R' for Released/Not "
"RTN","RAPM2",76,0)
 W "Verified; 'PD' for Problem Draft; 'D' for Draft"
"RTN","RAPM2",77,0)
 W:RANODIV !," *D = Division is missing"
"RTN","RAPM2",78,0)
 W !!?5,"* A printset, i.e., a set of multiple exams that share the same report, will be expected to have 1 report."
"RTN","RAPM2",79,0)
 Q
"RTN","RAPM2",80,0)
 ;
"RTN","RAPM2",81,0)
STORE ; Store detail information
"RTN","RAPM2",82,0)
 Q:RARPT="S"
"RTN","RAPM2",83,0)
 ; for storage subscript: if no rpt dt, set to neg
"RTN","RAPM2",84,0)
 S RADHT=$S(RARPTDT="":-1,1:RATDFHR)
"RTN","RAPM2",85,0)
 S RADHV=$S(RAVERDT="":-1,1:RAVDFHR)
"RTN","RAPM2",86,0)
 ; for display: round off and remove decimal portion of hours
"RTN","RAPM2",87,0)
 S:RATDFHR'="" RATDFHR=(RATDFHR+.5)\1
"RTN","RAPM2",88,0)
 S:RAVDFHR'="" RAVDFHR=(RAVDFHR+.5)\1
"RTN","RAPM2",89,0)
 S RATDFHR=$S(RATDFHR="":"",RATDFHR<1:"<1",RATDFHR>999:">999",1:RATDFHR)
"RTN","RAPM2",90,0)
 S RAVDFHR=$S(RAVDFHR="":"",RAVDFHR<1:"<1",RAVDFHR>999:">999",1:RAVDFHR)
"RTN","RAPM2",91,0)
 ;
"RTN","RAPM2",92,0)
 S RAREC1=RACN_U_RAPATNM_U_RADTE_U_RARPTDT_U
"RTN","RAPM2",93,0)
 S RAREC1=RAREC1_RAVERDT_U_RAPRIMNM_U_RACAT_U_RARPTST_U_RAIMGTYP_U
"RTN","RAPM2",94,0)
 S RAREC1=RAREC1_RADFN_U_RACHKDIV_U_RATDFHR_U_RAVDFHR_U_RAPRCN
"RTN","RAPM2",95,0)
 ;
"RTN","RAPM2",96,0)
 I RASORT="C" S ^TMP($J,"RAPM2",$P(RADTE,"."),RACN,RAPATNM)=RAREC1
"RTN","RAPM2",97,0)
 I RASORT="P" S ^TMP($J,"RAPM2",RAPATNM,$P(RADTE,"."),RACN)=RAREC1
"RTN","RAPM2",98,0)
 I RASORT="I" S ^TMP($J,"RAPM2",RAIMGTYP,$P(RADTE,"."),RACN,RAPATNM)=RAREC1
"RTN","RAPM2",99,0)
 I RASORT="E" S ^TMP($J,"RAPM2",RACAT,$P(RADTE,"."),RACN,RAPATNM)=RAREC1
"RTN","RAPM2",100,0)
 I RASORT="R" S ^TMP($J,"RAPM2",RAPRIMNM,$P(RADTE,"."),RACN,RAPATNM)=RAREC1
"RTN","RAPM2",101,0)
 I RASORT="T" S ^TMP($J,"RAPM2",RADHT,RADTE,RACN,RAPATNM)=RAREC1
"RTN","RAPM2",102,0)
 I RASORT="V" S ^TMP($J,"RAPM2",RADHV,RADTE,RACN,RAPATNM)=RAREC1
"RTN","RAPM2",103,0)
 Q
"RTN","RAPM2",104,0)
EMAIL ; Ask if ready to email the summary report
"RTN","RAPM2",105,0)
 N RA1
"RTN","RAPM2",106,0)
 W ! S DIR(0)="Y"
"RTN","RAPM2",107,0)
 S DIR("A")="Send summary report to local mail group ""G.RAD PERFORMANCE INDICATOR"""
"RTN","RAPM2",108,0)
 S DIR("B")="Yes"
"RTN","RAPM2",109,0)
 D ^DIR
"RTN","RAPM2",110,0)
 Q:$D(DIRUT)
"RTN","RAPM2",111,0)
 S RAANS=Y
"RTN","RAPM2",112,0)
 S RA1=$O(^RA(79,0)) Q:'RA1
"RTN","RAPM2",113,0)
 I '$O(^RA(79,RA1,1,0)) D  Q
"RTN","RAPM2",114,0)
 . W !!,?5,"No OUTLOOK mail group(s) have been entered yet."
"RTN","RAPM2",115,0)
 . Q
"RTN","RAPM2",116,0)
 W ! S DIR(0)="Y"
"RTN","RAPM2",117,0)
 S DIR("A")="Send summary report to OUTLOOK mail group(s)"
"RTN","RAPM2",118,0)
 S DIR("B")="Yes"
"RTN","RAPM2",119,0)
 D ^DIR
"RTN","RAPM2",120,0)
 S RAANS2=Y
"RTN","RAPM2",121,0)
 Q
"RTN","RAPM2",122,0)
SEND ; Send summary report to mail group
"RTN","RAPM2",123,0)
 I RAANS=0,RAANS2=0 Q
"RTN","RAPM2",124,0)
 N RA1,RA2,RASVSUB,RASVTEXT
"RTN","RAPM2",125,0)
 S XMSUB="Radiology Summary Performance Indicator"
"RTN","RAPM2",126,0)
 S XMDUZ=DUZ
"RTN","RAPM2",127,0)
 S XMTEXT="^TMP($J,""RAPM"","
"RTN","RAPM2",128,0)
 S RASVSUB=XMSUB,RASVTEXT=XMTEXT
"RTN","RAPM2",129,0)
 I RAANS=1 D
"RTN","RAPM2",130,0)
 . S XMY("G.RAD PERFORMANCE INDICATOR")=""
"RTN","RAPM2",131,0)
 . D ^XMD
"RTN","RAPM2",132,0)
 . K XMY
"RTN","RAPM2",133,0)
 . Q
"RTN","RAPM2",134,0)
 I RAANS2=1 D
"RTN","RAPM2",135,0)
 . S RA1=$O(^RA(79,0)) Q:'RA1
"RTN","RAPM2",136,0)
 . S XMSUB=RASVSUB,XMTEXT=RASVTEXT
"RTN","RAPM2",137,0)
 . S RA2=0
"RTN","RAPM2",138,0)
 . F  S RA2=$O(^RA(79,RA1,1,RA2)) Q:'RA2  S XMY($P(^(RA2,0),U))=""
"RTN","RAPM2",139,0)
 . Q:'$D(XMY)
"RTN","RAPM2",140,0)
 . D ^XMD
"RTN","RAPM2",141,0)
 . K XMY
"RTN","RAPM2",142,0)
 . Q
"RTN","RAPM2",143,0)
 K XMDUZ
"RTN","RAPM2",144,0)
 Q
"RTN","RAPM2",145,0)
HDR(RATYP) ; Print appropriate header
"RTN","RAPM2",146,0)
 U:RAIO IO S RAPG=$G(RAPG)+1
"RTN","RAPM2",147,0)
 I $G(RAPG)!($E(IOST,1,2)="C-") W:RAIO @IOF
"RTN","RAPM2",148,0)
 I $E(IOST,1,2)="P-",(RAPG>1) W:RAIO @IOF
"RTN","RAPM2",149,0)
 S RAHD(0)=$S(RATYP="S":"Summary",RATYP="D":"Detail",1:"")
"RTN","RAPM2",150,0)
 S RAHD(0)=RAHD(0)_" Performance Indicator Report"
"RTN","RAPM2",151,0)
 S RAIOM=$S(RATYP="S":80,1:IOM)
"RTN","RAPM2",152,0)
 W:RAIO !?(RAIOM-$L(RAHD(0))\2),RAHD(0),?(RAIOM-10),"Page: ",$G(RAPG),!
"RTN","RAPM2",153,0)
 I RATYP="S" S RAN=1 D
"RTN","RAPM2",154,0)
 . S ^TMP($J,"RAPM",RAN)="                     Summary Performance Indicator Report          Page: "_$G(RAPG) S RAN=RAN+1
"RTN","RAPM2",155,0)
 . S ^TMP($J,"RAPM",RAN)="",RAN=RAN+1
"RTN","RAPM2",156,0)
 ;
"RTN","RAPM2",157,0)
 D GETS^DIQ(4,DUZ(2),"**","E","RAR","RAMSG")
"RTN","RAPM2",158,0)
 K X
"RTN","RAPM2",159,0)
 S X(1)=RAR(4,DUZ(2)_",",.01,"E") ; Name of facility
"RTN","RAPM2",160,0)
 S X(2)=RAR(4,DUZ(2)_",",99,"E") ;  Station Number
"RTN","RAPM2",161,0)
 I $D(RAR(4.014)) D
"RTN","RAPM2",162,0)
 . S X(3)=RAR(4.014,"1,"_DUZ(2)_",",.01,"E") ; Association
"RTN","RAPM2",163,0)
 . S X(4)=RAR(4.014,"1,"_DUZ(2)_",",1,"E") ; Parent of Association
"RTN","RAPM2",164,0)
 . S X(5)=$S(X(3)="VISN":X(4),1:"") ; should be VISN number
"RTN","RAPM2",165,0)
 E  S X(5)=""
"RTN","RAPM2",166,0)
 ;
"RTN","RAPM2",167,0)
 W:RAIO !,"Facility: ",X(1),?41,"Station: ",X(2),?60,"VISN: ",X(5)
"RTN","RAPM2",168,0)
 I RATYP="S" D
"RTN","RAPM2",169,0)
 . S $P(X(6)," ",79)=""
"RTN","RAPM2",170,0)
 . S $E(X(6),1,(10+$L(X(1))))="Facility: "_X(1)
"RTN","RAPM2",171,0)
 . S $E(X(6),41,(50+$L(X(2))))="Station: "_X(2)
"RTN","RAPM2",172,0)
 . S $E(X(6),60,(66+$L(X(5))))="VISN: "_X(5)
"RTN","RAPM2",173,0)
 . S ^TMP($J,"RAPM",RAN)=X(6)
"RTN","RAPM2",174,0)
 . S RAN=RAN+1
"RTN","RAPM2",175,0)
 . Q
"RTN","RAPM2",176,0)
 W !,"Division: "
"RTN","RAPM2",177,0)
 I RATYP="S" S ^TMP($J,"RAPM",RAN)="Division: "
"RTN","RAPM2",178,0)
 D DIV
"RTN","RAPM2",179,0)
 S:(RATYP="S") RAN=RAN+1
"RTN","RAPM2",180,0)
 ;
"RTN","RAPM2",181,0)
 W:RAIO !,"Exam Date Range: "
"RTN","RAPM2",182,0)
 W:RAIO $$FMTE^XLFDT(RABDATE,"2D")," - ",$$FMTE^XLFDT(RAEDATE,"2D")
"RTN","RAPM2",183,0)
 I RATYP="S" S ^TMP($J,"RAPM",RAN)="Exam Date Range: "_$$FMTE^XLFDT(RABDATE,"2D")_" - "_$$FMTE^XLFDT(RAEDATE,"2D") S RAN=RAN+1
"RTN","RAPM2",184,0)
 ;
"RTN","RAPM2",185,0)
 W:RAIO !,"Imaging Type(s): "
"RTN","RAPM2",186,0)
 I RATYP="S" S ^TMP($J,"RAPM",RAN)="Imaging Type(s): "
"RTN","RAPM2",187,0)
 D IMG
"RTN","RAPM2",188,0)
 S:RATYP="S" RAN=RAN+1
"RTN","RAPM2",189,0)
 ;
"RTN","RAPM2",190,0)
 ; Run date and time
"RTN","RAPM2",191,0)
 S NOW=$$NOW^XLFDT,NOW=$P(NOW,".",1)_"."_$E($P(NOW,".",2),1,4)
"RTN","RAPM2",192,0)
 W:RAIO !,"Run Date/Time: ",$$FMTE^XLFDT(NOW,"2P"),!
"RTN","RAPM2",193,0)
 I RATYP="S" S ^TMP($J,"RAPM",RAN)="Run Date/Time: "_$$FMTE^XLFDT(NOW,"2P"),RAN=RAN+1
"RTN","RAPM2",194,0)
 I RARAD D
"RTN","RAPM2",195,0)
 . W:RAIO !,"Primary Interpreting Staff Physician: ",$$GET1^DIQ(200,RARAD,.01),!
"RTN","RAPM2",196,0)
 . I RATYP="S" D
"RTN","RAPM2",197,0)
 .. S ^TMP($J,"RAPM",RAN)="",RAN=RAN+1
"RTN","RAPM2",198,0)
 .. S ^TMP($J,"RAPM",RAN)="Primary Interpreting Staff Physician: "_$$GET1^DIQ(200,RARAD,.01),RAN=RAN+1
"RTN","RAPM2",199,0)
 .. Q
"RTN","RAPM2",200,0)
 . Q
"RTN","RAPM2",201,0)
 I (RARPT="D"!(RARPT="B")),(RATYP'="S") D
"RTN","RAPM2",202,0)
 . S RASRT=$S(RASORT="C":"Case Number",RASORT="E":"Cateory of Exam",RASORT="I":"Imaging Type",RASORT="P":"Patient Name",RASORT="R":"Radiologist",RASORT="T":"Hrs to Transcription",RASORT="V":"Hrs to Verification",1:"")
"RTN","RAPM2",203,0)
 . W:RAIO !,"Sorted by: ",RASRT,?45,"Min. hours elasped to "_$S(RASORT="V":"Verification",1:"Transcription")_": "_RASINCE
"RTN","RAPM2",204,0)
 Q
"RTN","RAPM2",205,0)
DIV ; List selected Division
"RTN","RAPM2",206,0)
 Q:'$D(^TMP($J,"RA D-TYPE"))
"RTN","RAPM2",207,0)
 S RADIV="" F I=1:1 S RADIV=$O(^TMP($J,"RA D-TYPE",RADIV)) Q:RADIV=""  D
"RTN","RAPM2",208,0)
 . I $X'>(RAIOM-$L("Division(s): ")) D
"RTN","RAPM2",209,0)
 . . W:RAIO RADIV_$S($O(^TMP($J,"RA D-TYPE",RADIV))]"":", ",1:"")
"RTN","RAPM2",210,0)
 . . I RATYP="S" S ^TMP($J,"RAPM",RAN)=^TMP($J,"RAPM",RAN)_RADIV_$S($O(^TMP($J,"RA D-TYPE",RADIV))]"":", ",1:"")
"RTN","RAPM2",211,0)
 . I $X>(RAIOM-$L("Division(s): ")) D
"RTN","RAPM2",212,0)
 . . W:RAIO !?($X+$L("Division(s): "))
"RTN","RAPM2",213,0)
 . . I RATYP="S" S RAN=RAN+1,^TMP($J,"RAPM",RAN)="         "
"RTN","RAPM2",214,0)
 Q
"RTN","RAPM2",215,0)
IMG ; List selected Imaging Type(s)
"RTN","RAPM2",216,0)
 Q:'$D(^TMP($J,"RA I-TYPE"))
"RTN","RAPM2",217,0)
 ;N RALMAX,RALUSED,RATAIL,RALDENT
"RTN","RAPM2",218,0)
 S RALDENT=$L("Imaging Type(s): ")
"RTN","RAPM2",219,0)
 S RALMAX=RAIOM-RALDENT
"RTN","RAPM2",220,0)
 S RALUSED=0
"RTN","RAPM2",221,0)
 S RAIMG="" F J=1:1 S RAIMG=$O(^TMP($J,"RA I-TYPE",RAIMG)) Q:RAIMG=""  D
"RTN","RAPM2",222,0)
 . S RATAIL=$S($O(^TMP($J,"RA I-TYPE",RAIMG))]"":", ",1:"")
"RTN","RAPM2",223,0)
 . I (RALUSED+$L(RAIMG)+$L(RATAIL))>RALMAX D
"RTN","RAPM2",224,0)
 .. W:RAIO !?RALDENT
"RTN","RAPM2",225,0)
 .. I RATYP="S" S RAN=RAN+1,^TMP($J,"RAPM",RAN)="                 "
"RTN","RAPM2",226,0)
 .. S RALUSED=0
"RTN","RAPM2",227,0)
 .. Q
"RTN","RAPM2",228,0)
 . W:RAIO RAIMG_RATAIL
"RTN","RAPM2",229,0)
 . I RATYP="S" S ^TMP($J,"RAPM",RAN)=^TMP($J,"RAPM",RAN)_RAIMG_RATAIL
"RTN","RAPM2",230,0)
 . S RALUSED=RALUSED+$L(RAIMG)+$L(RATAIL)
"RTN","RAPM2",231,0)
 Q
"RTN","RAPM3")
0^4^B77781515
"RTN","RAPM3",1,0)
RAPM3 ;HOIFO/SM-Radiology Performance Monitors/Indicator ;1/5/04  11:11
"RTN","RAPM3",2,0)
 ;;5.0;Radiology/Nuclear Medicine;**37,44**;Mar 16, 1998
"RTN","RAPM3",3,0)
 ;; IA #11090 allows Fileman read of Entire file 4
"RTN","RAPM3",4,0)
 Q
"RTN","RAPM3",5,0)
EN1 ;entry/edit OUTLOOK mail groups
"RTN","RAPM3",6,0)
 N RA1,RA2
"RTN","RAPM3",7,0)
 S RA1=$O(^RA(79,0)) Q:'RA1
"RTN","RAPM3",8,0)
 I $O(^RA(79,RA1,1,0)) D
"RTN","RAPM3",9,0)
 . W !?5,"OUTLOOK mail groups previously entered:",!
"RTN","RAPM3",10,0)
 . S RA2=0
"RTN","RAPM3",11,0)
 . F  S RA2=$O(^RA(79,RA1,1,RA2)) Q:'RA2  W !?8,^(RA2,0)
"RTN","RAPM3",12,0)
 . Q
"RTN","RAPM3",13,0)
 W !!?5,"You may add another mail group."
"RTN","RAPM3",14,0)
 W !,?5,"To edit or replace a mail group, you must delete the old one first.",!
"RTN","RAPM3",15,0)
 L +^RA(79,RA1,1):1 I '$T W !,$C(7),"Can't lock ^RA,",RA1,",1) now, try again later." Q
"RTN","RAPM3",16,0)
 S DIE="^RA(79,",DA=RA1,DR="175"
"RTN","RAPM3",17,0)
 D ^DIE
"RTN","RAPM3",18,0)
 L -^RA(79,RA1,1)
"RTN","RAPM3",19,0)
 Q
"RTN","RAPM3",20,0)
TASKLM ; task off last month's Perf. Indic. Summary Report
"RTN","RAPM3",21,0)
 ; define report type as summary
"RTN","RAPM3",22,0)
 N RA1,RA2,RA3,RABDATE,RAEDATE,RADAYS,RAENDDT,RABEGDT
"RTN","RAPM3",23,0)
 N M1,M2,X1,X2,Y1,Y2
"RTN","RAPM3",24,0)
 ; if interactive, display Outlook mail groups and ask if continue
"RTN","RAPM3",25,0)
 I '$D(ZTQUEUED) D  I 'RA3 W !!?5,"** Nothing Done **" Q
"RTN","RAPM3",26,0)
 . W !!?5,"The Summary Report of Last Month's data will be sent to the following"
"RTN","RAPM3",27,0)
 . W !?5,"Outlook mail group(s) defined in File 79's PERF INDC SMPT E-MAIL ADDRESS:",!
"RTN","RAPM3",28,0)
 . S RA1=$O(^RA(79,0))
"RTN","RAPM3",29,0)
 . I '$O(^RA(79,RA1,1,0)) S RA3=0 W !?5,"** There is no Outlook mail group defined in File 79's",!?8,"PERF INDC SMTP E-MAIL ADDRESS. **",! Q
"RTN","RAPM3",30,0)
 . S RA2=0
"RTN","RAPM3",31,0)
 . F  S RA2=$O(^RA(79,RA1,1,RA2)) Q:'RA2  W !?8,^(RA2,0)
"RTN","RAPM3",32,0)
 . W !
"RTN","RAPM3",33,0)
 . S DIR(0)="Y"
"RTN","RAPM3",34,0)
 . S DIR("A")="Do you want to continue"
"RTN","RAPM3",35,0)
 . D ^DIR S RA3=Y
"RTN","RAPM3",36,0)
 . Q:'RA3
"RTN","RAPM3",37,0)
 . ; ask Task Start Time
"RTN","RAPM3",38,0)
 . W !!?5,"The requested start time must be within day 10 through the last",!?5,"day of the current month.",!
"RTN","RAPM3",39,0)
 . ; find end day of current month
"RTN","RAPM3",40,0)
 . S Y1=$E(DT,1,3),M1=$E(DT,4,5)
"RTN","RAPM3",41,0)
 . S Y2=$S(M1="12":Y1+1,1:Y1),M2=$S(M1="12":"01",1:M1+1)
"RTN","RAPM3",42,0)
 . S:$L(M2)=1 M2="0"_M2
"RTN","RAPM3",43,0)
 . S RA1=Y1_M1_"10"
"RTN","RAPM3",44,0)
 . S RA2=Y2_M2_"01"
"RTN","RAPM3",45,0)
 . S X2=RA1,X1=RA2 D ^%DTC
"RTN","RAPM3",46,0)
 . S X2=X-1,X1=RA1 D C^%DTC S RA2=X
"RTN","RAPM3",47,0)
 . S DIR(0)="D^"_RA1_":"_RA2_":AE"
"RTN","RAPM3",48,0)
 . S DIR("A")="Enter date/time to start this Task"
"RTN","RAPM3",49,0)
 . S DIR("?",1)="   The Task date/time must be at least 10 days from the"
"RTN","RAPM3",50,0)
 . S DIR("?")="   beginning of this month through the end of this month."
"RTN","RAPM3",51,0)
 . D ^DIR
"RTN","RAPM3",52,0)
 . S:$D(DIRUT) RA3=0
"RTN","RAPM3",53,0)
 . S ZTDTH=Y_"."_$P(($$NOW^XLFDT),".",2)
"RTN","RAPM3",54,0)
 . Q
"RTN","RAPM3",55,0)
 K ^TMP($J)
"RTN","RAPM3",56,0)
 S RARAD="" ; all radiologists
"RTN","RAPM3",57,0)
 S RARPT="S",RAANS=0,RAANS2=1 ; summary, no local mail, send Outlook mail
"RTN","RAPM3",58,0)
 ; define LAST MONTH'S begin and end dates
"RTN","RAPM3",59,0)
 S Y1=$E(DT,1,3),M1=$E(DT,4,5) ; current month
"RTN","RAPM3",60,0)
 S Y2=$S(M1="01":Y1-1,1:Y1),M2=$S(M1="01":12,1:M1-1) ; last month
"RTN","RAPM3",61,0)
 S:$L(M2)=1 M2="0"_M2
"RTN","RAPM3",62,0)
 S RA1=Y1_M1_"01" ; Current year and month, 1st day of month
"RTN","RAPM3",63,0)
 S RABDATE=Y2_M2_"01" ; Begin date for last month
"RTN","RAPM3",64,0)
 S X1=RA1,X2=RABDATE D ^%DTC S RADAYS=X ; No. days in last month
"RTN","RAPM3",65,0)
 S X2=(RADAYS-1),X1=RABDATE D C^%DTC S RAEDATE=X ; End date last month
"RTN","RAPM3",66,0)
 S RAENDDT=RAEDATE_.9999 ; convert for search loop
"RTN","RAPM3",67,0)
 S RABEGDT=(RABDATE-1)_.9999 ; convert for search loop
"RTN","RAPM3",68,0)
 ; define divisions that have at least 1 active img loc
"RTN","RAPM3",69,0)
 S RA1=0
"RTN","RAPM3",70,0)
 F  S RA1=$O(^RA(79,RA1)) Q:'RA1  D
"RTN","RAPM3",71,0)
 . S RA2=0
"RTN","RAPM3",72,0)
 . ;if div has at least 1 active img loc, then store div in ^tmp
"RTN","RAPM3",73,0)
 . F  S RA2=$O(^RA(79,RA1,"L",RA2)) Q:'RA2  I $D(^(RA2,0)),$P($G(^RA(79.1,+^(0),0)),U,19)="" S RA3=$$GET1^DIQ(4,RA1,.01),^TMP($J,"RA D-TYPE",RA3,RA1)="" Q
"RTN","RAPM3",74,0)
 ; define imaging types if not vascular lab but has file 79.1 BIMG xref
"RTN","RAPM3",75,0)
 S RA1=0
"RTN","RAPM3",76,0)
 F  S RA1=$O(^RA(79.2,RA1)) Q:'RA1  D
"RTN","RAPM3",77,0)
 . I $D(^RA(79.2,RA1,0)) S RA2=$P(^(0),U) I RA2'["VASCULAR LAB",$D(^RA(79.1,"BIMG",RA1)) S ^TMP($J,"RA I-TYPE",RA2,RA1)=""
"RTN","RAPM3",78,0)
 ; task job
"RTN","RAPM3",79,0)
 S ZTIO=""
"RTN","RAPM3",80,0)
 D TASK^RAPM
"RTN","RAPM3",81,0)
 S X1=ZTDESC,X2=ZTDTH ; save taskman vars
"RTN","RAPM3",82,0)
 D ^%ZTLOAD
"RTN","RAPM3",83,0)
 I +$G(ZTSK("D"))>0,$D(ZTSK) D
"RTN","RAPM3",84,0)
 . W !?5,*7,"Request queued: ",X1
"RTN","RAPM3",85,0)
 . W !?5,"to start on: ",$$FMTE^XLFDT(X2)
"RTN","RAPM3",86,0)
 . W !?5,"Task #: "_$G(ZTSK)
"RTN","RAPM3",87,0)
 K ^TMP($J)
"RTN","RAPM3",88,0)
 Q
"RTN","RAPM3",89,0)
RESCH ; reschedule option that is in file 19.2
"RTN","RAPM3",90,0)
 N RABY,RADT,RAERR,RAWHEN,RAFLAG
"RTN","RAPM3",91,0)
 N D1,M1,Y1,M2,Y2,X
"RTN","RAPM3",92,0)
 ; RAFLAG="" determines if allow LAYGO to file 19.2, if the option "RA 
"RTN","RAPM3",93,0)
 ; PERFORMIN TASKLM" was installed in file 19.2, RAFLAG = "",
"RTN","RAPM3",94,0)
 ; if not installed, then RAFLAG = "L"
"RTN","RAPM3",95,0)
 S RAFLAG=""
"RTN","RAPM3",96,0)
 ; get task status of option
"RTN","RAPM3",97,0)
 D OPTSTAT^XUTMOPT("RA PERFORMIN TASKLM",.RAR)
"RTN","RAPM3",98,0)
 I $P($G(RAR(1)),U) D EN^DDIOL("** Option RA PERFORMIN TASKLM is already scheduled, so nothing done. **",,"!!?5") D PRESS Q
"RTN","RAPM3",99,0)
 I '$D(RAR(1)) D
"RTN","RAPM3",100,0)
 . D EN^DDIOL("** Option RA PERFORMIN TASKLM has not been installed into file 19.2 **",,"!!?5")
"RTN","RAPM3",101,0)
 . D EN^DDIOL("** will install it into file 19.2 now. **",,"!!?5")
"RTN","RAPM3",102,0)
 . S RAFLAG="L"
"RTN","RAPM3",103,0)
 . Q
"RTN","RAPM3",104,0)
 ; task the option that seems to be lost from the task queue
"RTN","RAPM3",105,0)
 D SET15
"RTN","RAPM3",106,0)
 D EN^DDIOL("Now scheduling RA PERFORMIN TASKLM to run on: ",,"!!?5")
"RTN","RAPM3",107,0)
 D RESCH^XUTMOPT("RA PERFORMIN TASKLM",RAWHEN,,RABY,RAFLAG,.RAERR)
"RTN","RAPM3",108,0)
 D OPTSTAT^XUTMOPT("RA PERFORMIN TASKLM",.RAR)
"RTN","RAPM3",109,0)
 I $D(RAR(1))#2 D EN^DDIOL("Task number :   "_+RAR(1),,"!!?37")
"RTN","RAPM3",110,0)
 D PRESS
"RTN","RAPM3",111,0)
 Q
"RTN","RAPM3",112,0)
PRESS R !!?5,"Press RETURN to continue. ",X:DTIME
"RTN","RAPM3",113,0)
 Q
"RTN","RAPM3",114,0)
SET15 ; set some variables for scheduling task
"RTN","RAPM3",115,0)
 S Y1=$E(DT,1,3),M1=$E(DT,4,5),D1=$E(DT,6,7)
"RTN","RAPM3",116,0)
 S Y2=$S(M1="12":Y1+1,1:1),M2=$S(M1="12":"01",1:M1+1)
"RTN","RAPM3",117,0)
 S:$L(M2)=1 M2="0"_M2
"RTN","RAPM3",118,0)
 D:D1=15 TODAY D:D1<15 THISM D:D1>15 NEXTM
"RTN","RAPM3",119,0)
 S RAWHEN=$$FMADD^XLFDT(RADT,,,5) ; add 5 mins to scheduled date
"RTN","RAPM3",120,0)
 S RABY="1M(15)" ; every month on the 15th day
"RTN","RAPM3",121,0)
 Q
"RTN","RAPM3",122,0)
TODAY ; today is the 15th
"RTN","RAPM3",123,0)
 S RADT=$$NOW^XLFDT
"RTN","RAPM3",124,0)
 Q
"RTN","RAPM3",125,0)
THISM ; this month on the 15th
"RTN","RAPM3",126,0)
 S RADT=Y1_M1_"15."_$P(($$NOW^XLFDT),".",2)
"RTN","RAPM3",127,0)
 Q
"RTN","RAPM3",128,0)
NEXTM ; next month on the 15th
"RTN","RAPM3",129,0)
 S RADT=Y2_M2_"15."_$P(($$NOW^XLFDT),".",2)
"RTN","RAPM3",130,0)
 Q
"RTN","RAPM3",131,0)
SFOOT ; Footer for Summary Report
"RTN","RAPM3",132,0)
 G:'RAIO SFOOT2
"RTN","RAPM3",133,0)
 I ($Y+5)>IOSL,IO=IO(0) D
"RTN","RAPM3",134,0)
 . I $E(IOST,1,2)="C-" R !,"Press RETURN to continue.",X:DTIME
"RTN","RAPM3",135,0)
 . S RAPG=RAPG+1,RAHDR="Summary Performance Indicator Report"
"RTN","RAPM3",136,0)
 . W @IOF,!?(RAIOM-$L(RAHDR)\2),RAHDR,?(RAIOM-10),"Page: ",$G(RAPG)
"RTN","RAPM3",137,0)
 W !!?5,"* Columns represent # of hours elapsed from exam date/time through",!?7,"date/time report entered or date/time report was verified."
"RTN","RAPM3",138,0)
 W !?7,"e.g. "">0-24 Hrs"" column represents those exams that had a report"
"RTN","RAPM3",139,0)
 W !?7,"transcribed and/or verified within 0-24 hours from the exam date/time."
"RTN","RAPM3",140,0)
 W !!?5,"* Columns following the initial elapsed time column "">0-24 Hrs"" begin"
"RTN","RAPM3",141,0)
 W !?7,"at .0001 after the starting hour (e.g. "">24-48 Hrs"" = starts at 24.001",!?7,"through the 48th hour.)",!
"RTN","RAPM3",142,0)
 W !?5,"* PENDING means there's no data for DATE REPORT ENTERED or VERIFIED DATE."
"RTN","RAPM3",143,0)
 W !?7,"So, if the expected report is missing one of these fields, or is missing"
"RTN","RAPM3",144,0)
 W !?7,"data for fields .01 through 17 from file #74, RAD/NUC MED REPORTS, or"
"RTN","RAPM3",145,0)
 W !?7,"is a Stub Report that was entered by the Imaging package when images"
"RTN","RAPM3",146,0)
 W !?7,"were captured before a report was entered, then the expected report"
"RTN","RAPM3",147,0)
 W !?7,"would be counted in the PENDING column."
"RTN","RAPM3",148,0)
 ;
"RTN","RAPM3",149,0)
SFOOT2 ; store in tmp
"RTN","RAPM3",150,0)
 S (^TMP($J,"RAPM",RAN),^TMP($J,"RAPM",RAN+1))="",RAN=RAN+1
"RTN","RAPM3",151,0)
 ;
"RTN","RAPM3",152,0)
 S ^TMP($J,"RAPM",RAN)="    * Columns represent # of hours elapsed from exam date/time through",RAN=RAN+1
"RTN","RAPM3",153,0)
 S ^TMP($J,"RAPM",RAN)="      date/time report entered or date/time report was verified.",RAN=RAN+1
"RTN","RAPM3",154,0)
 S ^TMP($J,"RAPM",RAN)="      e.g. "">0-24 Hrs"" column represents those exams that had a report",RAN=RAN+1
"RTN","RAPM3",155,0)
 S ^TMP($J,"RAPM",RAN)="      transcribed and/or verified within 0-24 hours from the exam date/time.",RAN=RAN+1
"RTN","RAPM3",156,0)
 S ^TMP($J,"RAPM",RAN)="",RAN=RAN+1
"RTN","RAPM3",157,0)
 S ^TMP($J,"RAPM",RAN)="    * Columns following the initial elapsed time column (0-24 Hrs) begin",RAN=RAN+1
"RTN","RAPM3",158,0)
 S ^TMP($J,"RAPM",RAN)="      at .0001 after the starting hour (e.g. "">24-48 Hrs"" = starts at 24.001",RAN=RAN+1
"RTN","RAPM3",159,0)
 S ^TMP($J,"RAPM",RAN)="      through the 48th hour.)",RAN=RAN+1
"RTN","RAPM3",160,0)
 S ^TMP($J,"RAPM",RAN)="",RAN=RAN+1
"RTN","RAPM3",161,0)
 S ^TMP($J,"RAPM",RAN)="    * PENDING means there's no data for DATE REPORT ENTERED or VERIFIED DATE.",RAN=RAN+1
"RTN","RAPM3",162,0)
 S ^TMP($J,"RAPM",RAN)="      So, if the expected report is missing one of these fields, or is missing",RAN=RAN+1
"RTN","RAPM3",163,0)
 S ^TMP($J,"RAPM",RAN)="      data for fields .01 through 17 from file #74, RAD/NUC MED REPORTS, or",RAN=RAN+1
"RTN","RAPM3",164,0)
 S ^TMP($J,"RAPM",RAN)="      is a Stub Report that was entered by the Imaging package when images",RAN=RAN+1
"RTN","RAPM3",165,0)
 S ^TMP($J,"RAPM",RAN)="      were captured before a report was entered, then the expected report",RAN=RAN+1
"RTN","RAPM3",166,0)
 S ^TMP($J,"RAPM",RAN)="      would be counted in the PENDING column."
"RTN","RAPM3",167,0)
 D BFOOT
"RTN","RAPM3",168,0)
 Q
"RTN","RAPM3",169,0)
BFOOT ;footer for both
"RTN","RAPM3",170,0)
 G:'RAIO BFOOT2
"RTN","RAPM3",171,0)
 W !!?5,"* A printset, i.e., a set of multiple exams that share the same report,",!?7,"will be expected to have 1 report."
"RTN","RAPM3",172,0)
BFOOT2 ; used in summary
"RTN","RAPM3",173,0)
 Q:'$G(RAN)
"RTN","RAPM3",174,0)
 S RAN=RAN+1
"RTN","RAPM3",175,0)
 S ^TMP($J,"RAPM",RAN)="",RAN=RAN+1
"RTN","RAPM3",176,0)
 S ^TMP($J,"RAPM",RAN)="    * A printset, i.e., a set of multiple exams that share the same report,",RAN=RAN+1
"RTN","RAPM3",177,0)
 S ^TMP($J,"RAPM",RAN)="      will be expected to have 1 report."
"RTN","RAPM3",178,0)
 Q
"RTN","RAPM3",179,0)
RADIOL ; select Radiologist for Summary Report
"RTN","RAPM3",180,0)
 W !
"RTN","RAPM3",181,0)
 S DIC("S")="I $D(^VA(200,""ARC"",""R"",Y))!($D(^VA(200,""ARC"",""S"",Y)))",DIC("A")="Select Primary Interpreting Staff Physician (Optional): ",DIC="^VA(200,",DIC(0)="AEMQ" D ^DIC K DIC Q:Y<0  S RARAD=+Y
"RTN","RAPM3",182,0)
 Q
"VER")
8.0^22
**END**
**END**
