Released RMPR*3*121 SEQ #99
Extracted from mail message
**KIDS**:RMPR*3.0*121^

**INSTALL NAME**
RMPR*3.0*121
"BLD",6033,0)
RMPR*3.0*121^PROSTHETICS^0^3060518^y
"BLD",6033,1,0)
^^3^3^3060411^
"BLD",6033,1,1,0)
1. Delete issue from stock error <SUBSCRIPT>DEL68^RMPRPCED
"BLD",6033,1,2,0)
 
"BLD",6033,1,3,0)
2. Problem with option, Edit/Delte Issue from Stock 
"BLD",6033,4,0)
^9.64PA^^
"BLD",6033,6.3)
3
"BLD",6033,"ABPKG")
n
"BLD",6033,"KRN",0)
^9.67PA^8989.52^19
"BLD",6033,"KRN",.4,0)
.4
"BLD",6033,"KRN",.401,0)
.401
"BLD",6033,"KRN",.402,0)
.402
"BLD",6033,"KRN",.403,0)
.403
"BLD",6033,"KRN",.5,0)
.5
"BLD",6033,"KRN",.84,0)
.84
"BLD",6033,"KRN",3.6,0)
3.6
"BLD",6033,"KRN",3.8,0)
3.8
"BLD",6033,"KRN",9.2,0)
9.2
"BLD",6033,"KRN",9.8,0)
9.8
"BLD",6033,"KRN",9.8,"NM",0)
^9.68A^1^1
"BLD",6033,"KRN",9.8,"NM",1,0)
RMPRPCED^^0^B10727703
"BLD",6033,"KRN",9.8,"NM","B","RMPRPCED",1)

"BLD",6033,"KRN",19,0)
19
"BLD",6033,"KRN",19.1,0)
19.1
"BLD",6033,"KRN",101,0)
101
"BLD",6033,"KRN",409.61,0)
409.61
"BLD",6033,"KRN",771,0)
771
"BLD",6033,"KRN",870,0)
870
"BLD",6033,"KRN",8989.51,0)
8989.51
"BLD",6033,"KRN",8989.52,0)
8989.52
"BLD",6033,"KRN",8994,0)
8994
"BLD",6033,"KRN","B",.4,.4)

"BLD",6033,"KRN","B",.401,.401)

"BLD",6033,"KRN","B",.402,.402)

"BLD",6033,"KRN","B",.403,.403)

"BLD",6033,"KRN","B",.5,.5)

"BLD",6033,"KRN","B",.84,.84)

"BLD",6033,"KRN","B",3.6,3.6)

"BLD",6033,"KRN","B",3.8,3.8)

"BLD",6033,"KRN","B",9.2,9.2)

"BLD",6033,"KRN","B",9.8,9.8)

"BLD",6033,"KRN","B",19,19)

"BLD",6033,"KRN","B",19.1,19.1)

"BLD",6033,"KRN","B",101,101)

"BLD",6033,"KRN","B",409.61,409.61)

"BLD",6033,"KRN","B",771,771)

"BLD",6033,"KRN","B",870,870)

"BLD",6033,"KRN","B",8989.51,8989.51)

"BLD",6033,"KRN","B",8989.52,8989.52)

"BLD",6033,"KRN","B",8994,8994)

"BLD",6033,"QUES",0)
^9.62^^
"BLD",6033,"REQB",0)
^9.611^1^1
"BLD",6033,"REQB",1,0)
RMPR*3.0*70^2
"BLD",6033,"REQB","B","RMPR*3.0*70",1)

"MBREQ")
0
"PKG",101,-1)
1^1
"PKG",101,0)
PROSTHETICS^RMPR^PROSTHETICS VERSION 3.0 ALPHA
"PKG",101,20,0)
^9.402P^^0
"PKG",101,22,0)
^9.49I^1^1
"PKG",101,22,1,0)
3.0^2960209^2960214
"PKG",101,22,1,"PAH",1,0)
121^3060518
"PKG",101,22,1,"PAH",1,1,0)
^^3^3^3060518
"PKG",101,22,1,"PAH",1,1,1,0)
1. Delete issue from stock error <SUBSCRIPT>DEL68^RMPRPCED
"PKG",101,22,1,"PAH",1,1,2,0)
 
"PKG",101,22,1,"PAH",1,1,3,0)
2. Problem with option, Edit/Delte Issue from Stock 
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
1
"RTN","RMPRPCED")
0^1^B10727703^B8672883
"RTN","RMPRPCED",1,0)
RMPRPCED ;Hines OIFO/RVD - Prosthetics/660/668/PCE DELETE ;7/30/02  09:39
"RTN","RMPRPCED",2,0)
 ;;3.0;PROSTHETICS;**62,70,121**;Feb 09, 1996;Build 3
"RTN","RMPRPCED",3,0)
 ;RVD 7/1/02 - patch #70 - new RMPR variables before calling PCE.
"RTN","RMPRPCED",4,0)
 ;
"RTN","RMPRPCED",5,0)
 ; This routine contains the code for deleting a Prosthetic visit in PCE.
"RTN","RMPRPCED",6,0)
 ;
"RTN","RMPRPCED",7,0)
 ;DBIA #1890  - this API is used to delete data from the VISIT file
"RTN","RMPRPCED",8,0)
 ;              (9000010) and V files from PCE module.
"RTN","RMPRPCED",9,0)
 ;DBIA #10048 - fileman read on file 9.4.
"RTN","RMPRPCED",10,0)
 ;
"RTN","RMPRPCED",11,0)
DEL(RMIE60) ;delete PCE visit.
"RTN","RMPRPCED",12,0)
 D NEWVAR
"RTN","RMPRPCED",13,0)
 S (RMLOCK,RMERR)=0
"RTN","RMPRPCED",14,0)
 I '$P($G(^RMPR(660,RMIE60,10)),U,12) G DEL68
"RTN","RMPRPCED",15,0)
 S RMSRC="PROSTHETICS DATA"
"RTN","RMPRPCED",16,0)
 S X="PROSTHETICS",DIC="^DIC(9.4," D ^DIC
"RTN","RMPRPCED",17,0)
 I '$D(Y)!(Y<0) S RMERR=-1 G DELX
"RTN","RMPRPCED",18,0)
 S RMPKG=+Y
"RTN","RMPRPCED",19,0)
 I 'RMPKG S RMERR=-1 G DELX
"RTN","RMPRPCED",20,0)
 ;
"RTN","RMPRPCED",21,0)
 ; get PCE IEn from file #660.
"RTN","RMPRPCED",22,0)
 S RMPCE=$P($G(^RMPR(660,RMIE60,10)),U,12)
"RTN","RMPRPCED",23,0)
 I 'RMPCE S RMERR=-1 G DELX
"RTN","RMPRPCED",24,0)
 I '$D(^AUPNVSIT(RMPCE,0)) G DEL68
"RTN","RMPRPCED",25,0)
 ;
"RTN","RMPRPCED",26,0)
DELVF ; Remove all workload data from the PCE visit file & related V files.
"RTN","RMPRPCED",27,0)
 ; check if the visit is already in PCE and remove workload,
"RTN","RMPRPCED",28,0)
 ; (sending RMPKG and RMSRC to ensure that only data that originally
"RTN","RMPRPCED",29,0)
 ; came from PROSTHETICS will be removed).
"RTN","RMPRPCED",30,0)
 ;
"RTN","RMPRPCED",31,0)
 N RMPR,REDO,VEJD
"RTN","RMPRPCED",32,0)
 S REDO=0
"RTN","RMPRPCED",33,0)
DELVF1 S RMCHK=$$DELVFILE^PXAPI("ALL",.RMPCE,RMPKG,RMSRC,0,0,"")
"RTN","RMPRPCED",34,0)
 I RMCHK'=1 D  I REDO=1 G DELVF1
"RTN","RMPRPCED",35,0)
 . Q:$P($G(^AUPNVSIT(RMPCE,0)),U,9)'=1!REDO
"RTN","RMPRPCED",36,0)
 . S VEJD=$O(^VEJD(19610.5,"B",RMPCE,0)) Q:VEJD=""
"RTN","RMPRPCED",37,0)
 . ;kill remaining dependent (DSS) to visit
"RTN","RMPRPCED",38,0)
 . S DA=VEJD,DIK="^VEJD(19610.5," D ^DIK
"RTN","RMPRPCED",39,0)
 . K DA,DIK
"RTN","RMPRPCED",40,0)
 . I $P(^AUPNVSIT(RMPCE,0),U,9)=0 S REDO=1
"RTN","RMPRPCED",41,0)
 I RMCHK'=1 W !!,"*** Error in deleting PCE visit !!",! S RMERR=-1 G DELX
"RTN","RMPRPCED",42,0)
 ;
"RTN","RMPRPCED",43,0)
DEL68 ; delete PCE info in file #668.
"RTN","RMPRPCED",44,0)
 S RMAMIS=$G(^RMPR(660,RMIE60,"AMS"))
"RTN","RMPRPCED",45,0)
 S RMIE68=$O(^RMPR(668,"F",RMIE60,0)) G:RMIE68="" DEL60
"RTN","RMPRPCED",46,0)
 L +^RMPR(668,RMIE68):3 I $T=0 D ERR68 G DELX
"RTN","RMPRPCED",47,0)
 S DA=$O(^RMPR(668,RMIE68,10,"B",RMIE60,0))
"RTN","RMPRPCED",48,0)
 S DA(1)=RMIE68,DIK="^RMPR(668,"_DA(1)_",10," D ^DIK
"RTN","RMPRPCED",49,0)
 S RMAMIEN=$O(^RMPR(668,RMIE68,11,"B",RMAMIS,0))
"RTN","RMPRPCED",50,0)
 S RMCNT=0
"RTN","RMPRPCED",51,0)
 F I=0:0 S I=$O(^RMPR(668,RMIE68,10,"B",I)) Q:I'>0  D
"RTN","RMPRPCED",52,0)
 .S RMAMIS68=$G(^RMPR(660,I,"AMS")) S:RMAMIS68=RMAMIS RMCNT=RMCNT+1
"RTN","RMPRPCED",53,0)
 ;if no other line item of the same GROUPER #, then delete.
"RTN","RMPRPCED",54,0)
 I RMCNT=1 D
"RTN","RMPRPCED",55,0)
 .S DA=RMAMIEN
"RTN","RMPRPCED",56,0)
 .S DA(1)=RMIE68,DIK="^RMPR(668,"_DA(1)_",11,"
"RTN","RMPRPCED",57,0)
 .D ^DIK
"RTN","RMPRPCED",58,0)
 L -^RMPR(668,RMIE68)
"RTN","RMPRPCED",59,0)
 ;
"RTN","RMPRPCED",60,0)
DEL60 ; delete PCE info in file #660.
"RTN","RMPRPCED",61,0)
 ; lock file #660
"RTN","RMPRPCED",62,0)
 L +^RMPR(660,RMIE60,10):3 I $T=0 D ERR60 G DELX
"RTN","RMPRPCED",63,0)
 S RMARR(660,RMIE60_",",8.12)="@"
"RTN","RMPRPCED",64,0)
 S RMARR(660,RMIE60_",",8.13)="@"
"RTN","RMPRPCED",65,0)
 D FILE^DIE("","RMARR","")
"RTN","RMPRPCED",66,0)
 L -^RMPR(660,RMIE60,10)
"RTN","RMPRPCED",67,0)
 ;
"RTN","RMPRPCED",68,0)
 ; exit delete
"RTN","RMPRPCED",69,0)
DELX Q RMERR
"RTN","RMPRPCED",70,0)
 ;
"RTN","RMPRPCED",71,0)
ERR68 ; print error if unable to delete/update file #668.
"RTN","RMPRPCED",72,0)
 W !!,"*** File #668 is locked, IEN = ",RMIE68,", PLEASE contact your IRM!!",!!
"RTN","RMPRPCED",73,0)
 L -^RMPR(668,RMIE68)
"RTN","RMPRPCED",74,0)
 S RMERR=-1
"RTN","RMPRPCED",75,0)
 Q
"RTN","RMPRPCED",76,0)
ERR60 ; print error if unable to delete/update file #660.
"RTN","RMPRPCED",77,0)
 W !!,"*** File #660 is locked, IEN = ",RMIE60,", PLEASE contact your IRM!!",!!
"RTN","RMPRPCED",78,0)
 S RMERR=-1
"RTN","RMPRPCED",79,0)
 Q
"RTN","RMPRPCED",80,0)
 ;
"RTN","RMPRPCED",81,0)
CHECK ;check for return error from PCE
"RTN","RMPRPCED",82,0)
 ;input variable RMPROB
"RTN","RMPRPCED",83,0)
 I $D(RMPROB($J,1))!$D(RMPROB($J,2)) D
"RTN","RMPRPCED",84,0)
 .S (R2,R3,RMMESS)=""
"RTN","RMPRPCED",85,0)
 .F R1=0:0 S R1=$O(RMPROB($J,R1)) Q:R1'>0  F  S R2=$O(RMPROB($J,R1,"ERROR1",R2)) Q:R2=""  F  S R3=$O(RMPROB($J,R1,"ERROR1",R2,R3)) Q:R3=""  D
"RTN","RMPRPCED",86,0)
 ..F R4=0:0 S R4=$O(RMPROB($J,R1,"ERROR1",R2,R3,R4)) Q:R4'>0  D
"RTN","RMPRPCED",87,0)
 ...S RMMESS=RMPROB($J,R1,"ERROR1",R2,R3,R4)
"RTN","RMPRPCED",88,0)
 ...W:RMMESS'="" !,"???? ",RMMESS
"RTN","RMPRPCED",89,0)
 ...I (RMMESS["CPT")!(RMMESS["Provider") S RMPRCPER=1
"RTN","RMPRPCED",90,0)
 Q
"RTN","RMPRPCED",91,0)
 ;
"RTN","RMPRPCED",92,0)
NEWVAR ; new variables
"RTN","RMPRPCED",93,0)
 N Y
"RTN","RMPRPCED",94,0)
 N I,RMCHK,RMKI,RMSUB,RMARR,DIE,DA,DIC,RMAMIS,RMAMIS68,DIK,RMCNT,RMAMIEN
"RTN","RMPRPCED",95,0)
 Q
"VER")
8.0^22.0
"BLD",6033,6)
^99
**END**
**END**
