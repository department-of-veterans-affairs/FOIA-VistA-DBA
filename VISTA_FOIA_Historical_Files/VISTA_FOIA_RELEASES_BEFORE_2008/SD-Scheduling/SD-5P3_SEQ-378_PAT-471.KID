Released SD*5.3*471 SEQ #378
Extracted from mail message
**KIDS**:SD*5.3*471^

**INSTALL NAME**
SD*5.3*471
"BLD",6522,0)
SD*5.3*471^SCHEDULING^0^3051212^y
"BLD",6522,1,0)
^^1^1^3051209^
"BLD",6522,1,1,0)
Institution missing in file 409.3
"BLD",6522,4,0)
^9.64PA^^
"BLD",6522,"ABPKG")
n
"BLD",6522,"KRN",0)
^9.67PA^8989.52^19
"BLD",6522,"KRN",.4,0)
.4
"BLD",6522,"KRN",.401,0)
.401
"BLD",6522,"KRN",.402,0)
.402
"BLD",6522,"KRN",.403,0)
.403
"BLD",6522,"KRN",.5,0)
.5
"BLD",6522,"KRN",.84,0)
.84
"BLD",6522,"KRN",3.6,0)
3.6
"BLD",6522,"KRN",3.8,0)
3.8
"BLD",6522,"KRN",9.2,0)
9.2
"BLD",6522,"KRN",9.8,0)
9.8
"BLD",6522,"KRN",9.8,"NM",0)
^9.68A^1^1
"BLD",6522,"KRN",9.8,"NM",1,0)
SDWLEVAL^^0^B83399202
"BLD",6522,"KRN",9.8,"NM","B","SDWLEVAL",1)

"BLD",6522,"KRN",19,0)
19
"BLD",6522,"KRN",19.1,0)
19.1
"BLD",6522,"KRN",101,0)
101
"BLD",6522,"KRN",409.61,0)
409.61
"BLD",6522,"KRN",771,0)
771
"BLD",6522,"KRN",870,0)
870
"BLD",6522,"KRN",8989.51,0)
8989.51
"BLD",6522,"KRN",8989.52,0)
8989.52
"BLD",6522,"KRN",8994,0)
8994
"BLD",6522,"KRN","B",.4,.4)

"BLD",6522,"KRN","B",.401,.401)

"BLD",6522,"KRN","B",.402,.402)

"BLD",6522,"KRN","B",.403,.403)

"BLD",6522,"KRN","B",.5,.5)

"BLD",6522,"KRN","B",.84,.84)

"BLD",6522,"KRN","B",3.6,3.6)

"BLD",6522,"KRN","B",3.8,3.8)

"BLD",6522,"KRN","B",9.2,9.2)

"BLD",6522,"KRN","B",9.8,9.8)

"BLD",6522,"KRN","B",19,19)

"BLD",6522,"KRN","B",19.1,19.1)

"BLD",6522,"KRN","B",101,101)

"BLD",6522,"KRN","B",409.61,409.61)

"BLD",6522,"KRN","B",771,771)

"BLD",6522,"KRN","B",870,870)

"BLD",6522,"KRN","B",8989.51,8989.51)

"BLD",6522,"KRN","B",8989.52,8989.52)

"BLD",6522,"KRN","B",8994,8994)

"BLD",6522,"QUES",0)
^9.62^^
"BLD",6522,"REQB",0)
^9.611^1^1
"BLD",6522,"REQB",1,0)
SD*5.3*327^2
"BLD",6522,"REQB","B","SD*5.3*327",1)

"MBREQ")
0
"PKG",16,-1)
1^1
"PKG",16,0)
SCHEDULING^SD^APPOINTMENTS,PROFILES,LETTERS,AMIS REPORTS
"PKG",16,20,0)
^9.402P^^
"PKG",16,22,0)
^9.49I^1^1
"PKG",16,22,1,0)
5.3^2930813
"PKG",16,22,1,"PAH",1,0)
471^3051212
"PKG",16,22,1,"PAH",1,1,0)
^^1^1^3051212
"PKG",16,22,1,"PAH",1,1,1,0)
Institution missing in file 409.3
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
1
"RTN","SDWLEVAL")
0^1^B83399202^B82936763
"RTN","SDWLEVAL",1,0)
SDWLEVAL ;;IOFO BAY PINES/ESW - WAIT LIST - DISPOSITION AFTER APPOINTMENT(S) ENTRY;06/12/2002 ; 5/23/05 4:47pm
"RTN","SDWLEVAL",2,0)
 ;;5.3;Scheduling;**327,471**;AUG 13 1993
"RTN","SDWLEVAL",3,0)
 ;Evaluate appt for optional disposition
"RTN","SDWLEVAL",4,0)
 ;called from SDMM, SDMM1, SDM1A, SDAM2
"RTN","SDWLEVAL",5,0)
 ;replaces SDWLR
"RTN","SDWLEVAL",6,0)
 ;
"RTN","SDWLEVAL",7,0)
EN(DFN,SDYN) ;evaluation if patient is on EWL
"RTN","SDWLEVAL",8,0)
 ; SDYN has to be passed by reference
"RTN","SDWLEVAL",9,0)
 ;output: SDYN=0 -  no open entries in EWL
"RTN","SDWLEVAL",10,0)
 ;        SDYN=1 -  at least one open entry in EWL
"RTN","SDWLEVAL",11,0)
 ;        SDYN(1)  - related message
"RTN","SDWLEVAL",12,0)
 S SDYN=0,SDYN(1)=""
"RTN","SDWLEVAL",13,0)
 I '$D(DFN)!(DFN'?1.N) S SDYN(1)="Patient's DFN not passed." Q
"RTN","SDWLEVAL",14,0)
 I $D(DFN),'$D(^SDWL(409.3,"B",DFN)) S SDYN(1)="This patient is not on EWL." Q
"RTN","SDWLEVAL",15,0)
 S SDWLDA="" F  S SDWLDA=$O(^SDWL(409.3,"B",DFN,SDWLDA)) Q:SDWLDA=""  D  Q:SDYN=1
"RTN","SDWLEVAL",16,0)
 .I $P($G(^SDWL(409.3,SDWLDA,0)),"^",17)="O" S SDYN=1,SDYN(1)="Patient has open Wait List entries."
"RTN","SDWLEVAL",17,0)
 I SDYN=0 S SDYN(1)="Patient has no open Wait List entries."
"RTN","SDWLEVAL",18,0)
 Q
"RTN","SDWLEVAL",19,0)
EWLANS(SDCONT) ;display EWL OPEN entries
"RTN","SDWLEVAL",20,0)
 ;check if to continue with EWL open entries
"RTN","SDWLEVAL",21,0)
 S SDCONT=0
"RTN","SDWLEVAL",22,0)
 N X,DIR
"RTN","SDWLEVAL",23,0)
 S DIR("B")="YES"
"RTN","SDWLEVAL",24,0)
 S DIR("A")="Do you want to display open Wait list entries (Yes/No)?",DIR(0)="Y"
"RTN","SDWLEVAL",25,0)
 S DIR("?")="Do you want to review open EWL entries for Dispositioning?"
"RTN","SDWLEVAL",26,0)
 D ^DIR
"RTN","SDWLEVAL",27,0)
 I Y S SDCONT=1
"RTN","SDWLEVAL",28,0)
 Q
"RTN","SDWLEVAL",29,0)
ASKREM ;prompt user for record for dispositioning
"RTN","SDWLEVAL",30,0)
 S SDDIS=0 ; flag indicating disposition
"RTN","SDWLEVAL",31,0)
 W ! N X,DIR
"RTN","SDWLEVAL",32,0)
 S DIR("B")="NO"
"RTN","SDWLEVAL",33,0)
 S DIR("A")="DO YOU WISH TO REMOVE ANY ENTRY FROM LIST (Yes/No)? ",DIR(0)="Y"
"RTN","SDWLEVAL",34,0)
 S DIR("?")="To disposition any entry based on scheduled appointments."
"RTN","SDWLEVAL",35,0)
 D ^DIR
"RTN","SDWLEVAL",36,0)
 I Y S SDDIS=1
"RTN","SDWLEVAL",37,0)
 D ANSW(SDDIS)
"RTN","SDWLEVAL",38,0)
 D END
"RTN","SDWLEVAL",39,0)
 Q
"RTN","SDWLEVAL",40,0)
ANSW(SDDIS) ;
"RTN","SDWLEVAL",41,0)
 ;SDDIS=0 - select entries not to disposition
"RTN","SDWLEVAL",42,0)
 ;SDDIS=1 - select entries to disposition
"RTN","SDWLEVAL",43,0)
 K DIR,X
"RTN","SDWLEVAL",44,0)
 W !
"RTN","SDWLEVAL",45,0)
 N STR,SS S SDC=$O(^TMP($J,"SDWLPL",""),-1) I SDC=1 S DIR("B")=1
"RTN","SDWLEVAL",46,0)
 S DIR(0)="L^1:"_SDC S DIR("A")="Select entries for entering Non-Removal Reason or '^' to Quit>",DIR("?")="Enter number(s) or range of displayed Wait List entries."
"RTN","SDWLEVAL",47,0)
 I SDDIS S DIR("A")="Select entries for dispositioning or '^' to Quit>"
"RTN","SDWLEVAL",48,0)
 D ^DIR
"RTN","SDWLEVAL",49,0)
 I X="^" Q
"RTN","SDWLEVAL",50,0)
 I X["-" D
"RTN","SDWLEVAL",51,0)
 .N SXB,SXE
"RTN","SDWLEVAL",52,0)
 .S SXB=$P(X,"-"),SXE=$P(X,"-",2) N SDC F SDC=SXB:1:SXE S SDWLDA=+^TMP($J,"SDWLPL",SDC) D
"RTN","SDWLEVAL",53,0)
 ..;LOCK
"RTN","SDWLEVAL",54,0)
 ..L +^SDWL(409.3,SDWLDA):5 I '$T W !,"Another User is Editing this Entry. Try Later." Q
"RTN","SDWLEVAL",55,0)
 ..I 'SDDIS D DISPO(SDWLDA,SDC)
"RTN","SDWLEVAL",56,0)
 ..I SDDIS D GETDATA(SDWLDA) D DISEND(SDWLDA,SDC)
"RTN","SDWLEVAL",57,0)
 I X[","!(X?1N) D
"RTN","SDWLEVAL",58,0)
 .N FF S FF=X N GG,SDC F GG=1:1 S SDC=$P(FF,",",GG) Q:SDC=""  S SDWLDA=+^TMP($J,"SDWLPL",SDC) D
"RTN","SDWLEVAL",59,0)
 ..;LOCK
"RTN","SDWLEVAL",60,0)
 ..L +^SDWL(409.3,SDWLDA):5 I '$T W !,"Another User is Editing this Entry. Try Later." Q
"RTN","SDWLEVAL",61,0)
 ..I 'SDDIS D DISPO(SDWLDA,SDC)
"RTN","SDWLEVAL",62,0)
 ..I SDDIS D GETDATA(SDWLDA) D DISEND(SDWLDA,SDC)
"RTN","SDWLEVAL",63,0)
 ..L
"RTN","SDWLEVAL",64,0)
 Q
"RTN","SDWLEVAL",65,0)
DISEND(SDWLAD,SDC) ;enter disposition
"RTN","SDWLEVAL",66,0)
 ;SDWLDA - IEN of 409.3  
"RTN","SDWLEVAL",67,0)
 ;are you sure you want to disposition this entry:
"RTN","SDWLEVAL",68,0)
 ;display an entry
"RTN","SDWLEVAL",69,0)
 ;quit if NO
"RTN","SDWLEVAL",70,0)
 ;proceed if YES
"RTN","SDWLEVAL",71,0)
 D EDIT(SDWLDA,SDC,.SDWLERR) Q:$D(DUOUT)  I SDWLERR Q
"RTN","SDWLEVAL",72,0)
 W !!,"*** Patient has been removed from Wait List ***",!
"RTN","SDWLEVAL",73,0)
 K DIR,DIE,DR,DIC
"RTN","SDWLEVAL",74,0)
 S DIR(0)="E" D ^DIR I $D(DUOUT) Q
"RTN","SDWLEVAL",75,0)
 Q
"RTN","SDWLEVAL",76,0)
GETDATA(SDWLDA) ;PATIENT DATA RETRIEVAL
"RTN","SDWLEVAL",77,0)
 S SDWLDATA=$G(^SDWL(409.3,SDWLDA,0))
"RTN","SDWLEVAL",78,0)
 S SDWLIN=$P(SDWLDATA,U,3),SDWLCL=+$P(SDWLDATA,U,4),SDWLTY=$P(SDWLDATA,U,5),SDWLST=$P(SDWLDATA,U,6)
"RTN","SDWLEVAL",79,0)
 S SDWLSP=$P(SDWLDATA,U,7),SDWLSS=$P(SDWLDATA,U,8),SDWLSC=$P(SDWLDATA,U,9),SDWLPRI=$P(SDWLDATA,U,10),SDWLRB=$P(SDWLDATA,U,11)
"RTN","SDWLEVAL",80,0)
 S SDWLPROV=$P(SDWLDATA,U,12),SDWLDAPT=$P(SDWLDATA,U,16),SDWLST=$P(SDWLDATA,U,17),SDWLDUZ=DUZ,SDWLEDT=DT
"RTN","SDWLEVAL",81,0)
 S SDWLSCL="" I SDWLSC S SDWLSCL=+$P(^SDWL(409.32,SDWLSC,0),U,1)
"RTN","SDWLEVAL",82,0)
 I $D(^SDWL(409.3,SDWLDA,"DIS")) S SDWLDISP=$P(^SDWL(409.3,SDWLDA,"DIS"),U,3)
"RTN","SDWLEVAL",83,0)
 Q
"RTN","SDWLEVAL",84,0)
EDIT(SDWLDA,SDC,SDWLERR) ;ENTER/EDIT DISPOSITION
"RTN","SDWLEVAL",85,0)
 ;SDWLDA -IEN of selected 409.3 entry to disposition
"RTN","SDWLEVAL",86,0)
 ;SDWLERR - called by a reference
"RTN","SDWLEVAL",87,0)
 ;SDC - sequential number in ^TMP($J,"SDWLPL",SDC
"RTN","SDWLEVAL",88,0)
 S SDWLDUZ=DUZ,SDWLERR=0 K DIR,DR,DIE,DIC
"RTN","SDWLEVAL",89,0)
 I $D(SDWLDISP) S DIR("B")=$$EXTERNAL^DILFD(409.3,21,,SDWLDISP)
"RTN","SDWLEVAL",90,0)
 S DIR(0)="SO^D:DEATH;NC:REMOVED/NON-VA CARE;SA:REMOVED/SCHEDULED-ASSIGNED;CC:REMOVED/VA CONTRACT CARE;NN:REMOVED/NO LONGER NECESSARY;ER:ENTERED IN ERROR;Q:QUIT/DO NOT DISPOSITION^"
"RTN","SDWLEVAL",91,0)
 S DIR("L",1)="Disposition Reason for # "_SDC_":",DIR("L",2)="",DIR("L",3)="D DEATH",DIR("L",4)="NC REMOVED/NON-VA CARE",DIR("L",5)="SA REMOVED/SCHEDULED-ASSIGNED"
"RTN","SDWLEVAL",92,0)
 S DIR("L",6)="CC REMOVED/VA CONTRACT CARE",DIR("L",7)="NN REMOVED/NO LONGER NECESSARY",DIR("L",8)="ER ENTERED IN ERROR",DIR("L")="Q QUIT/DO NOT DISPOSITION"
"RTN","SDWLEVAL",93,0)
 ;MAKE DEFAULT 'SA'
"RTN","SDWLEVAL",94,0)
 S DIR("A")="Enter selection or <cr> to accept 'SA REMOVED/SCHEDULED-ASSIGNED'> "
"RTN","SDWLEVAL",95,0)
 S DIR("?")="SA selection will require appointment selection to disposition this entry."
"RTN","SDWLEVAL",96,0)
 S DIR("B")="SA"
"RTN","SDWLEVAL",97,0)
 D ^DIR
"RTN","SDWLEVAL",98,0)
 S SDWLDISP=$S(X["D":"D",X["d":"D",X["NC":"NC",X["nc":"NC",X["SA":"SA",X["sa":"SA",X["CC":"CC",X["cc":"CC",X["NN":"NN",X["nn":"NN",X["ER":"ER",X["er":"ER",X["Q":"^",X="":"SA",1:0)
"RTN","SDWLEVAL",99,0)
 I X="^" S DUOUT=1 Q
"RTN","SDWLEVAL",100,0)
 I SDWLDISP="^" S DUOUT=1 Q
"RTN","SDWLEVAL",101,0)
 I SDWLDISP=0 S SDWLERR=1
"RTN","SDWLEVAL",102,0)
 I SDWLERR W *7,"Invalid Entry" Q
"RTN","SDWLEVAL",103,0)
 S DIE("NO^")="NO EDITING"
"RTN","SDWLEVAL",104,0)
 N SDAP I SDWLDISP="SA" D APPTD D  I SDAP="^" W !,"Disposition canceled by user",! Q
"RTN","SDWLEVAL",105,0)
 .W ! K DIR,X
"RTN","SDWLEVAL",106,0)
 .N STR,SS,SDA S SDA=$O(^TMP($J,"APPT",""),-1) I SDA=1 S DIR("B")=1
"RTN","SDWLEVAL",107,0)
 .S DIR(0)="N^1:"_SDA S DIR("A")="Select appointment entry for Removal Reason or '^' to Quit>",DIR("?")="Select Appointment for updating the selected EWL with."
"RTN","SDWLEVAL",108,0)
 .D ^DIR
"RTN","SDWLEVAL",109,0)
 .S SDAP=X
"RTN","SDWLEVAL",110,0)
 S DIE="^SDWL(409.3,",DA=SDWLDA,DR="21////^S X=SDWLDISP" D ^DIE
"RTN","SDWLEVAL",111,0)
 S DR="19////^S X=DT" D ^DIE
"RTN","SDWLEVAL",112,0)
 S DR="20////^S X=SDWLDUZ" D ^DIE
"RTN","SDWLEVAL",113,0)
 S DR="23////^S X=""C""" D ^DIE
"RTN","SDWLEVAL",114,0)
 ;I SDWLDISP="SA" update with appointment data
"RTN","SDWLEVAL",115,0)
 ;get appointment data to file (for a particular appt #)
"RTN","SDWLEVAL",116,0)
 I SDWLDISP="SA" N SDA D DATP(SDAP,.SDA) D
"RTN","SDWLEVAL",117,0)
 .I $D(SDA) S DIE="^SDWL(409.3,",DA=SDWLDA D
"RTN","SDWLEVAL",118,0)
 ..S DR="13////"_SDA(1)_";13.1////"_DT_";13.2////"_SDA(2)_";13.3////"_SDA(15)_";13.4////"_SDA(13)_";13.5////"_SDA(14)_";13.6////"_SDA(16)_";13.8////"_SDA(3)_";13.7////"_DUZ
"RTN","SDWLEVAL",119,0)
 ..D ^DIE
"RTN","SDWLEVAL",120,0)
 N SDWLSCL,SDWLSS
"RTN","SDWLEVAL",121,0)
 S SDWLSCL=$P($G(^TMP($J,"SDWLPL",SDC)),U,9)
"RTN","SDWLEVAL",122,0)
 S SDWLSS=$P($G(^TMP($J,"SDWLPL",SDC)),U,10)
"RTN","SDWLEVAL",123,0)
 I SDWLSCL K:$D(^SDWL(409.3,"SC",SDWLSCL,SDWLDA)) ^SDWL(409.3,"SC",SDWLSCL,SDWLDA)
"RTN","SDWLEVAL",124,0)
 S SDWLDFN=$P($G(^TMP($J,"APPT",1)),U,4)
"RTN","SDWLEVAL",125,0)
 I SDWLSS,SDWLDFN K:$D(^SDWL(409.3,"SS",SDWLDFN,SDWLSS,SDWLDA)) ^SDWL(409.3,"SS",SDWLDFN,SDWLSS,SDWLDA)
"RTN","SDWLEVAL",126,0)
 Q
"RTN","SDWLEVAL",127,0)
DISPO(SDWLDA,SDC) ;
"RTN","SDWLEVAL",128,0)
 ;SDWLDA - IEN of 409.3
"RTN","SDWLEVAL",129,0)
 ;select NON-REMOVAL reason
"RTN","SDWLEVAL",130,0)
 K DIR,X
"RTN","SDWLEVAL",131,0)
 S DIR(0)="SO^1:APPOINTMENT CRITERIA NOT MET;2:PATIENT WANTS ANOTHER APPOINTMENT;3:PROVIDER WANTS ANOTHER APPOINTMENT;4:OTHER;5:QUIT"
"RTN","SDWLEVAL",132,0)
 S DIR("L",1)="SELECT ONE OF THE FOLLOWING REASONS FOR # "_SDC_":",DIR("L",2)=""
"RTN","SDWLEVAL",133,0)
 S DIR("L",3)="1. APPOINTMENT CRITERIA NOT MET",DIR("L",4)="2. PATIENT WANTS ANOTHER APPOINTMENT"
"RTN","SDWLEVAL",134,0)
 S DIR("L",5)="3. PROVIDER WANTS ANOTHER APPOINTMENT",DIR("L,6")="4. OTHER",DIR("L,7")="5. QUIT"
"RTN","SDWLEVAL",135,0)
 S DIR("A")="Select one of the following reasons for #: "_SDC
"RTN","SDWLEVAL",136,0)
 D ^DIR
"RTN","SDWLEVAL",137,0)
 S X=$E(X,1,2) S:$E(X,2)'="R" X=$E(X)
"RTN","SDWLEVAL",138,0)
 S SDWLX=$S(X="a":"A",X="p":"P",X="pr":"PR",X="o":"O",X="A":"A",X="P":"P",X="PR":"PR",X="O":"O",X=1:"A",X=2:"P",X=3:"PR",X=4:"O",X="^":"^",X="Q":"^",X=5:"^",1:"")
"RTN","SDWLEVAL",139,0)
 I SDWLX="^" Q
"RTN","SDWLEVAL",140,0)
 I SDWLX="O" D
"RTN","SDWLEVAL",141,0)
 .S DIR(0)="FAO^^",DIR("A")="Comments: " D ^DIR Q:X["^"
"RTN","SDWLEVAL",142,0)
 .S SDWLCOM=X,DA=SDWLDA,DIE="^SDWL(409.3,",DR="18.1////^S X=SDWLCOM" D ^DIE
"RTN","SDWLEVAL",143,0)
 N DA S DA=SDWLDA
"RTN","SDWLEVAL",144,0)
 S DIE="^SDWL(409.3,",DR="18////^S X=SDWLX" D ^DIE
"RTN","SDWLEVAL",145,0)
 S DR="17////^S X=DUZ" D ^DIE
"RTN","SDWLEVAL",146,0)
 S DR="16////^S X=DT" D ^DIE
"RTN","SDWLEVAL",147,0)
 K SDWLERR,DIR,DR,DIE,X,SDWLX,SDWLDSS,SDWLASK,SDWLDA,SDWLCOM
"RTN","SDWLEVAL",148,0)
 Q
"RTN","SDWLEVAL",149,0)
HD ;HEADER
"RTN","SDWLEVAL",150,0)
 W:$D(IOF) @IOF W !!,?80-$L("Wait List - Disposition Patient")\2,"Wait List - Disposition Patient",!!
"RTN","SDWLEVAL",151,0)
 Q
"RTN","SDWLEVAL",152,0)
APPT(DFN,SD,SC) ;create appt TMP
"RTN","SDWLEVAL",153,0)
 ;SD - appt date/time
"RTN","SDWLEVAL",154,0)
 ;SC - Hospital Location IEN
"RTN","SDWLEVAL",155,0)
 N SDARR,SCNT
"RTN","SDWLEVAL",156,0)
 S SDDIV=""
"RTN","SDWLEVAL",157,0)
 S SDARR(1)=SD_";"_SD
"RTN","SDWLEVAL",158,0)
 S SDARR(2)=SC
"RTN","SDWLEVAL",159,0)
 S SDARR(4)=DFN
"RTN","SDWLEVAL",160,0)
 S SDARR("FLDS")="1;2;3;4;10;13;14"
"RTN","SDWLEVAL",161,0)
 N SAPP S SAPP=$$SDAPI^SDAMA301(.SDARR) D
"RTN","SDWLEVAL",162,0)
 .N SDINST,SDFAC,SDINSTE
"RTN","SDWLEVAL",163,0)
 .Q:'$D(^TMP($J,"SDAMA301",DFN))
"RTN","SDWLEVAL",164,0)
 .S SCNT=$O(^TMP($J,"APPT",""),-1)+1
"RTN","SDWLEVAL",165,0)
 .S ^TMP($J,"APPT",SCNT)=^TMP($J,"SDAMA301",DFN,SC,SD)
"RTN","SDWLEVAL",166,0)
 .S SDINST=$$GET1^DIQ(44,SC_",",3,"I")  ; get Institution
"RTN","SDWLEVAL",167,0)
 .S SDINSTE=$$GET1^DIQ(44,SC_",",3,"E")
"RTN","SDWLEVAL",168,0)
 .S SDFAC=$S(SDINST="":"",1:$$GET1^DIQ(4,SDINST_",",99,"I"))  ; Station
"RTN","SDWLEVAL",169,0)
 .I SDFAC="" N SDDIV S SDDIV="" S SDDIV=$$GET1^DIQ(44,SC_",",3.5,"I") D
"RTN","SDWLEVAL",170,0)
 ..I SDDIV'="" S SDINST=$$GET1^DIQ(40.8,SDDIV_",",.07,"I") I SDINST'="" D
"RTN","SDWLEVAL",171,0)
 ...S SDFAC=$S(SDINST="":"",1:$$GET1^DIQ(4,SDINST_",",99,"I"))  ; Station
"RTN","SDWLEVAL",172,0)
 ..I SDDIV="" S SDFAC=$P($$SITE^VASITE(,),"^",3)
"RTN","SDWLEVAL",173,0)
 .S $P(^TMP($J,"APPT",SCNT),"^",15)=SDINST_";"_SDINSTE
"RTN","SDWLEVAL",174,0)
 .S $P(^TMP($J,"APPT",SCNT),"^",16)=SDFAC
"RTN","SDWLEVAL",175,0)
 .K ^TMP($J,"SDAMA301",DFN,SC,SD)
"RTN","SDWLEVAL",176,0)
 Q
"RTN","SDWLEVAL",177,0)
APPTD ;display appointment
"RTN","SDWLEVAL",178,0)
 ;from appointment list created in ^TMP if open EWL entries
"RTN","SDWLEVAL",179,0)
 N STR,SCNT
"RTN","SDWLEVAL",180,0)
 Q:'$D(^TMP($J,"APPT"))
"RTN","SDWLEVAL",181,0)
 S SCNT="" F  S SCNT=$O(^TMP($J,"APPT",SCNT)) Q:SCNT=""  D
"RTN","SDWLEVAL",182,0)
 .S STR=^TMP($J,"APPT",SCNT)
"RTN","SDWLEVAL",183,0)
 .N ZZ F ZZ=2,3,4,10,15 S SDD(ZZ)=$P($P(STR,"^",ZZ),";",2)
"RTN","SDWLEVAL",184,0)
 .N SD S SD=$P(STR,U) D  S Y=SD D D^DIQ S SDD(1)=Y ; date conversion
"RTN","SDWLEVAL",185,0)
 ..I SDD(3)="SCHEDULED/KEPT" S SDD(3)=$S(SD<DT:"KEPT",1:"SCHEDULED")
"RTN","SDWLEVAL",186,0)
 .S SDD(16)=$P(STR,U,16)
"RTN","SDWLEVAL",187,0)
 .N CP,ZZ F ZZ=13,14 S CP(ZZ)=$P($P(STR,U,ZZ),";") D
"RTN","SDWLEVAL",188,0)
 ..S SDD(ZZ)=""
"RTN","SDWLEVAL",189,0)
 ..I CP(ZZ)>0 S SDD(ZZ)=$$GET1^DIQ(40.7,CP(ZZ)_",",.01,"I") ; stop code desc
"RTN","SDWLEVAL",190,0)
 .;DISPLAY
"RTN","SDWLEVAL",191,0)
 .I SCNT=1 D DPH(SCNT,.SDD)
"RTN","SDWLEVAL",192,0)
 .D DPHD(SCNT,.SDD)
"RTN","SDWLEVAL",193,0)
 W !
"RTN","SDWLEVAL",194,0)
 Q
"RTN","SDWLEVAL",195,0)
DATP(SCNT,SDA) ;create data from appt # SCNT to be filed in 409.3 entry
"RTN","SDWLEVAL",196,0)
 ;SDA - called by a reference to be returned to EDIT
"RTN","SDWLEVAL",197,0)
 S STR=^TMP($J,"APPT",SCNT)
"RTN","SDWLEVAL",198,0)
 S SDA(1)=$P(STR,U)
"RTN","SDWLEVAL",199,0)
 N ZZ F ZZ=2,3,10,13,14,15 S SDA(ZZ)=$P($P(STR,"^",ZZ),";",1)
"RTN","SDWLEVAL",200,0)
 S SDA(16)=$P(STR,"^",16) ;station
"RTN","SDWLEVAL",201,0)
 Q
"RTN","SDWLEVAL",202,0)
DPH(SCNT,SDD) ;display appt header
"RTN","SDWLEVAL",203,0)
 W !!,?80-$L("Appointment(s) for: "_SDD(4)_" in Clinic: "_SDD(2)_"on "_SDD(1))\2,"Appointment(s) for: "_SDD(4)_" in Clinic: "_SDD(2) W !!?4,"Specialty: "_SDD(13),?60,"Station: ",SDD(16),!
"RTN","SDWLEVAL",204,0)
 W !?3,"Appt Date/Time",?25,"Status",?42,"Appt Type",?60,"Institution",! N SDL S $P(SDL,"-",79)="" W SDL,!
"RTN","SDWLEVAL",205,0)
 Q
"RTN","SDWLEVAL",206,0)
DPHD(SCNT,SDD) ;
"RTN","SDWLEVAL",207,0)
 W !,SCNT,?3,SDD(1),?25,SDD(3),?42,SDD(10),?60,SDD(15)
"RTN","SDWLEVAL",208,0)
 Q
"RTN","SDWLEVAL",209,0)
END ;QUIT OPTION
"RTN","SDWLEVAL",210,0)
 K DIC,DIR,DR,DIE,SDWLDFN,DUOUT
"RTN","SDWLEVAL",211,0)
 K SDWLCL,SDWSLCN,SDWLDA,SDWLDAPT,SDWLDATA,SDWLDFN,SDWLDISP,SDWLDUZ,SDWLEDT,SDWLERR,SDWLIN,SDWLNAM,SDWLOP,SDWLPRI
"RTN","SDWLEVAL",212,0)
 K SDWLPROV,SDWLPS,SDWLRB,SDWLSC,SDWLSP,SDWLSS,SDWLST,SDWLTY,SDWLY,X,Y,SDWLHDR
"RTN","SDWLEVAL",213,0)
 Q
"VER")
8.0^22.0
"BLD",6522,6)
^378
**END**
**END**
