Released PSJ*5*139 SEQ #129
Extracted from mail message
**KIDS**:PSJ*5.0*139^

**INSTALL NAME**
PSJ*5.0*139
"BLD",5286,0)
PSJ*5.0*139^INPATIENT MEDICATIONS^0^3050823^y
"BLD",5286,1,0)
^^25^25^3050823^
"BLD",5286,1,1,0)
 HUN-1003-22262 - Med Order Button
"BLD",5286,1,2,0)
 ---------------------------------
"BLD",5286,1,3,0)
 If a nurse enters an order via the Med Order Button on the BCMA
"BLD",5286,1,4,0)
 application, and this is the only order for that patient, the order
"BLD",5286,1,5,0)
 will not show up on the Non-Verified/Pending Order (PSJU VBW) option if
"BLD",5286,1,6,0)
 selected by Group, Ward or Clinic. This patch will resolve this issue.
"BLD",5286,1,7,0)
 
"BLD",5286,1,8,0)
 
"BLD",5286,1,9,0)
 ERI-0205-20902 - Allergy Checking
"BLD",5286,1,10,0)
 ---------------------------------
"BLD",5286,1,11,0)
 While testing CPRS V25, it was discovered that not all Allergy checks
"BLD",5286,1,12,0)
 were being displayed.  This could occur if there were multiple VA DRUG
"BLD",5286,1,13,0)
 CLASS entries entered for a patient.  A change will be made to loop all
"BLD",5286,1,14,0)
 VA DRUG CLASS entries for the patient to correctly identify potential
"BLD",5286,1,15,0)
 drug allergies.
"BLD",5286,1,16,0)
 
"BLD",5286,1,17,0)
 
"BLD",5286,1,18,0)
 PUG-0205-50079 - Report printer length
"BLD",5286,1,19,0)
 --------------------------------------
"BLD",5286,1,20,0)
 There is an inconsistency between the length of the IV ROOM (59.5) file
"BLD",5286,1,21,0)
 fields LABEL DEVICE (13) and REPORT DEVICE (14) and the corresponding
"BLD",5286,1,22,0)
 entry in the DEVICE (3.5) file.  The IV ROOM fields only allows 20
"BLD",5286,1,23,0)
 characters and the DEVICE file allows 30 characters.  The IV ROOM file
"BLD",5286,1,24,0)
 fields LABEL DEVICE and REPORT DEVICE will be changed to allow 30
"BLD",5286,1,25,0)
 characters.
"BLD",5286,4,0)
^9.64PA^59.5^1
"BLD",5286,4,59.5,0)
59.5
"BLD",5286,4,59.5,2,0)
^9.641^59.5^1
"BLD",5286,4,59.5,2,59.5,0)
IV ROOM  (File-top level)
"BLD",5286,4,59.5,2,59.5,1,0)
^9.6411^14^2
"BLD",5286,4,59.5,2,59.5,1,13,0)
LABEL DEVICE
"BLD",5286,4,59.5,2,59.5,1,14,0)
REPORT DEVICE
"BLD",5286,4,59.5,222)
y^n^p^^^^n^^n
"BLD",5286,4,59.5,224)

"BLD",5286,4,"APDD",59.5,59.5)

"BLD",5286,4,"APDD",59.5,59.5,13)

"BLD",5286,4,"APDD",59.5,59.5,14)

"BLD",5286,4,"B",59.5,59.5)

"BLD",5286,"ABPKG")
n
"BLD",5286,"KRN",0)
^9.67PA^8989.52^19
"BLD",5286,"KRN",.4,0)
.4
"BLD",5286,"KRN",.401,0)
.401
"BLD",5286,"KRN",.402,0)
.402
"BLD",5286,"KRN",.403,0)
.403
"BLD",5286,"KRN",.5,0)
.5
"BLD",5286,"KRN",.84,0)
.84
"BLD",5286,"KRN",3.6,0)
3.6
"BLD",5286,"KRN",3.8,0)
3.8
"BLD",5286,"KRN",9.2,0)
9.2
"BLD",5286,"KRN",9.8,0)
9.8
"BLD",5286,"KRN",9.8,"NM",0)
^9.68A^2^2
"BLD",5286,"KRN",9.8,"NM",1,0)
PSGVBW^^0^B59408602
"BLD",5286,"KRN",9.8,"NM",2,0)
PSGSICHK^^0^B46256083
"BLD",5286,"KRN",9.8,"NM","B","PSGSICHK",2)

"BLD",5286,"KRN",9.8,"NM","B","PSGVBW",1)

"BLD",5286,"KRN",19,0)
19
"BLD",5286,"KRN",19.1,0)
19.1
"BLD",5286,"KRN",101,0)
101
"BLD",5286,"KRN",409.61,0)
409.61
"BLD",5286,"KRN",771,0)
771
"BLD",5286,"KRN",870,0)
870
"BLD",5286,"KRN",8989.51,0)
8989.51
"BLD",5286,"KRN",8989.52,0)
8989.52
"BLD",5286,"KRN",8994,0)
8994
"BLD",5286,"KRN","B",.4,.4)

"BLD",5286,"KRN","B",.401,.401)

"BLD",5286,"KRN","B",.402,.402)

"BLD",5286,"KRN","B",.403,.403)

"BLD",5286,"KRN","B",.5,.5)

"BLD",5286,"KRN","B",.84,.84)

"BLD",5286,"KRN","B",3.6,3.6)

"BLD",5286,"KRN","B",3.8,3.8)

"BLD",5286,"KRN","B",9.2,9.2)

"BLD",5286,"KRN","B",9.8,9.8)

"BLD",5286,"KRN","B",19,19)

"BLD",5286,"KRN","B",19.1,19.1)

"BLD",5286,"KRN","B",101,101)

"BLD",5286,"KRN","B",409.61,409.61)

"BLD",5286,"KRN","B",771,771)

"BLD",5286,"KRN","B",870,870)

"BLD",5286,"KRN","B",8989.51,8989.51)

"BLD",5286,"KRN","B",8989.52,8989.52)

"BLD",5286,"KRN","B",8994,8994)

"BLD",5286,"QUES",0)
^9.62^^
"BLD",5286,"REQB",0)
^9.611^2^2
"BLD",5286,"REQB",1,0)
PSJ*5.0*110^2
"BLD",5286,"REQB",2,0)
PSJ*5.0*133^2
"BLD",5286,"REQB","B","PSJ*5.0*110",1)

"BLD",5286,"REQB","B","PSJ*5.0*133",2)

"FIA",59.5)
IV ROOM
"FIA",59.5,0)
^PS(59.5,
"FIA",59.5,0,0)
59.5
"FIA",59.5,0,1)
y^n^p^^^^n^^n
"FIA",59.5,0,10)

"FIA",59.5,0,11)

"FIA",59.5,0,"RLRO")

"FIA",59.5,0,"VR")
5.0^PSJ
"FIA",59.5,59.5)
1
"FIA",59.5,59.5,13)

"FIA",59.5,59.5,14)

"MBREQ")
0
"PKG",197,-1)
1^1
"PKG",197,0)
INPATIENT MEDICATIONS^PSJ^UNIT DOSE AND IVS
"PKG",197,20,0)
^9.402P^^
"PKG",197,22,0)
^9.49I^1^1
"PKG",197,22,1,0)
5.0^2971215^2980917^11712
"PKG",197,22,1,"PAH",1,0)
139^3050823^10000000009
"PKG",197,22,1,"PAH",1,1,0)
^^25^25^3050823
"PKG",197,22,1,"PAH",1,1,1,0)
 HUN-1003-22262 - Med Order Button
"PKG",197,22,1,"PAH",1,1,2,0)
 ---------------------------------
"PKG",197,22,1,"PAH",1,1,3,0)
 If a nurse enters an order via the Med Order Button on the BCMA
"PKG",197,22,1,"PAH",1,1,4,0)
 application, and this is the only order for that patient, the order
"PKG",197,22,1,"PAH",1,1,5,0)
 will not show up on the Non-Verified/Pending Order (PSJU VBW) option if
"PKG",197,22,1,"PAH",1,1,6,0)
 selected by Group, Ward or Clinic. This patch will resolve this issue.
"PKG",197,22,1,"PAH",1,1,7,0)
 
"PKG",197,22,1,"PAH",1,1,8,0)
 
"PKG",197,22,1,"PAH",1,1,9,0)
 ERI-0205-20902 - Allergy Checking
"PKG",197,22,1,"PAH",1,1,10,0)
 ---------------------------------
"PKG",197,22,1,"PAH",1,1,11,0)
 While testing CPRS V25, it was discovered that not all Allergy checks
"PKG",197,22,1,"PAH",1,1,12,0)
 were being displayed.  This could occur if there were multiple VA DRUG
"PKG",197,22,1,"PAH",1,1,13,0)
 CLASS entries entered for a patient.  A change will be made to loop all
"PKG",197,22,1,"PAH",1,1,14,0)
 VA DRUG CLASS entries for the patient to correctly identify potential
"PKG",197,22,1,"PAH",1,1,15,0)
 drug allergies.
"PKG",197,22,1,"PAH",1,1,16,0)
 
"PKG",197,22,1,"PAH",1,1,17,0)
 
"PKG",197,22,1,"PAH",1,1,18,0)
 PUG-0205-50079 - Report printer length
"PKG",197,22,1,"PAH",1,1,19,0)
 --------------------------------------
"PKG",197,22,1,"PAH",1,1,20,0)
 There is an inconsistency between the length of the IV ROOM (59.5) file
"PKG",197,22,1,"PAH",1,1,21,0)
 fields LABEL DEVICE (13) and REPORT DEVICE (14) and the corresponding
"PKG",197,22,1,"PAH",1,1,22,0)
 entry in the DEVICE (3.5) file.  The IV ROOM fields only allows 20
"PKG",197,22,1,"PAH",1,1,23,0)
 characters and the DEVICE file allows 30 characters.  The IV ROOM file
"PKG",197,22,1,"PAH",1,1,24,0)
 fields LABEL DEVICE and REPORT DEVICE will be changed to allow 30
"PKG",197,22,1,"PAH",1,1,25,0)
 characters.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
2
"RTN","PSGSICHK")
0^2^B46256083
"RTN","PSGSICHK",1,0)
PSGSICHK ;BIR/CML3-CHECKS SPECIAL INSTRUCTIONS ;17 Aug 98 / 8:33 AM
"RTN","PSGSICHK",2,0)
 ;;5.0; INPATIENT MEDICATIONS ;**3,9,26,29,44,49,59,110,139**;16 DEC 97
"RTN","PSGSICHK",3,0)
 ;
"RTN","PSGSICHK",4,0)
 ; Reference to EN^PSOORDRG is supported by DBIA 2190.
"RTN","PSGSICHK",5,0)
 ; Reference to ^PSI(58.1 is supported by DBIA 2284.
"RTN","PSGSICHK",6,0)
 ; Reference to ^PSDRUG( is supported by DBIA 2192.
"RTN","PSGSICHK",7,0)
 ; Reference to ^PSD(58.8 is supported by DBIA 2283.
"RTN","PSGSICHK",8,0)
 ; Reference to ^PS(55 is supported by DBIA 2191.
"RTN","PSGSICHK",9,0)
 ; Reference to ^PS(51.2 is supported by DBIA 2178.
"RTN","PSGSICHK",10,0)
 ; Reference to ^PS(51 is supported by DBIA 2176.
"RTN","PSGSICHK",11,0)
 ;
"RTN","PSGSICHK",12,0)
START ;
"RTN","PSGSICHK",13,0)
 I $S(X'?.ANP:1,X["^":1,1:$L(X)>180) K X Q
"RTN","PSGSICHK",14,0)
 S Y="" F Y(1)=1:1:$L(X," ") S Y(2)=$P(X," ",Y(1)) I Y(2)]"" D CHK Q:'$D(X)
"RTN","PSGSICHK",15,0)
 ;I $D(X),Y]"",X'=$E(Y,1,$L(Y)-1) W !?3,"EXPANDS TO:",! F Y(1)=1:1 S Y(2)=$P(Y," ",Y(1)) Q:Y(2)=""  W:$L(Y(2))+$X>78 ! W Y(2)," "
"RTN","PSGSICHK",16,0)
 I $D(X),Y]"",X'=$E(Y,1,$L(Y)-1) D EN^DDIOL("EXPANDS TO: ") W Y F Y(1)=1:1 S Y(2)=$P(Y," ",Y(1)) Q:Y(2)=""  D:$L(Y(2))+$X>78 EN^DDIOL(Y(2)_" ")
"RTN","PSGSICHK",17,0)
 Q
"RTN","PSGSICHK",18,0)
 ;
"RTN","PSGSICHK",19,0)
CHK ;
"RTN","PSGSICHK",20,0)
 I $L(Y(2))<31,$D(^PS(51,+$O(^PS(51,"B",Y(2),0)),0)),$P(^(0),"^",2)]"",$P(^(0),"^",4) S Y(2)=$P(^(0),"^",2)
"RTN","PSGSICHK",21,0)
 I $L(Y)+$L(Y(2))>180 K X Q
"RTN","PSGSICHK",22,0)
 S Y=Y_Y(2)_" " Q
"RTN","PSGSICHK",23,0)
 ;
"RTN","PSGSICHK",24,0)
ENSET(X) ; expands the SPECIAL INSTRUCTIONS field contained in X into Y
"RTN","PSGSICHK",25,0)
 N X1,X2,Y S Y=""
"RTN","PSGSICHK",26,0)
 F X1=1:1:$L(X," ") S X2=$P(X," ",X1) I X2]"" S Y=Y_$S($L(X2)>30:X2,'$D(^PS(51,+$O(^PS(51,"B",X2,0)),0)):X2,$P(^(0),"^",2)]""&$P(^(0),"^",4):$P(^(0),"^",2),1:X2)_" "
"RTN","PSGSICHK",27,0)
 S Y=$E(Y,1,$L(Y)-1) Q Y
"RTN","PSGSICHK",28,0)
 ;
"RTN","PSGSICHK",29,0)
END ; used by DRUG (55.06,101 & 53.1,101) x-refs to warn user if patient is receiving or about to receive the drug just ordered
"RTN","PSGSICHK",30,0)
 Q:$D(PSJHLSKP)
"RTN","PSGSICHK",31,0)
 N Z,ZZ,STATUSNP I $G(PSJPWD)&($P($G(PSJSYSU),";")=3)&($G(PSGDRG)) I ($D(^PSI(58.1,"D",PSGDRG,PSJPWD)))!($D(^PSD(58.8,"D",PSGDRG,PSJPWD))) D EN^DDIOL("                         *** A WARD STOCK ITEM ***")
"RTN","PSGSICHK",32,0)
 D NOW^%DTC
"RTN","PSGSICHK",33,0)
 N PSJDCHK F Z=%:0 S Z=$O(^PS(55,+PSGP,5,"AUS",Z)) Q:'Z!$D(DUOUT)  F ZZ=0:0 S ZZ=$O(^PS(55,+PSGP,5,"AUS",Z,ZZ)) Q:'ZZ!$D(DUOUT)  I +$G(^PS(55,+PSGP,5,ZZ,.2))=PSGX D PDWCHK(+PSGP,ZZ_"U") S PSJDCHK=1
"RTN","PSGSICHK",34,0)
 F STATUSNP="N","P" F Z=0:0 S Z=$O(^PS(53.1,"AS",STATUSNP,+PSGP,Z)) Q:'Z!$D(DUOUT)  I +$G(^PS(53.1,+Z,.2))=PSGX D PDWCHK(+PSGP,Z_"P") S PSJDCHK=1
"RTN","PSGSICHK",35,0)
 I $D(PSJDCHK) N DIR D
"RTN","PSGSICHK",36,0)
 .S DIR(0)="Y",DIR("A")="Do you wish to continue entering this order",DIR("?",1)="Enter ""N"" if you wish to exit without creating a new order,"
"RTN","PSGSICHK",37,0)
 .S DIR("?")="or ""Y"" to continue with the order entry process." D ^DIR S:'Y Y=-1,X="^"
"RTN","PSGSICHK",38,0)
 K Z,ZZ
"RTN","PSGSICHK",39,0)
 Q
"RTN","PSGSICHK",40,0)
 ;
"RTN","PSGSICHK",41,0)
ENDDC(PSGP,PSJDD) ; Perform Duplicate Drug, Duplicate Class,
"RTN","PSGSICHK",42,0)
 ; Drug-Drug interaction check, Drug-Allergy interaction check.
"RTN","PSGSICHK",43,0)
 N PSJLINE,Z,ZZ,PSJFST
"RTN","PSGSICHK",44,0)
 S (PSJLINE,PSJFST)=0
"RTN","PSGSICHK",45,0)
 I $G(PSJPWD)&($P($G(PSJSYSU),";")=3)&($G(PSJDD)) I ($D(^PSI(58.1,"D",PSJDD,PSJPWD)))!($D(^PSD(58.8,"D",PSJDD,PSJPWD))) W !?25,"*** A WARD STOCK ITEM ***"
"RTN","PSGSICHK",46,0)
 D EN^PSOORDRG(PSGP,PSJDD) K PSJPDRG N INTERVEN,PSJIREQ,PSJRXREQ S Y=1,(PSJIREQ,PSJRXREQ,INTERVEN,X)="" S DFN=PSGP
"RTN","PSGSICHK",47,0)
 I $D(^TMP($J,"DD")) D ORDCHK^PSJLMUT1(PSGP,"DD",4)
"RTN","PSGSICHK",48,0)
 I $D(^TMP($J,"DC")) D ORDCHK^PSJLMUT1(PSGP,"DC",6)
"RTN","PSGSICHK",49,0)
IVSOL ;*** Start order check for IV solution at this point.
"RTN","PSGSICHK",50,0)
 I '$D(PSJFST) N PSJFST S PSJFST=0
"RTN","PSGSICHK",51,0)
 I $D(^TMP($J,"DI")) S INTERVEN=1 D ORDCHK^PSJLMUT1(PSGP,"DI",8)
"RTN","PSGSICHK",52,0)
 ;*** Allergy/adverse reaction check.
"RTN","PSGSICHK",53,0)
 N PTR,X
"RTN","PSGSICHK",54,0)
 S PTR=$P($G(^PSDRUG(PSJDD,"ND")),U)_"."_$P($G(^PSDRUG(PSJDD,"ND")),U,3)
"RTN","PSGSICHK",55,0)
 K ^TMP("PSJDAI",$J) S PSJACK=$$ORCHK^GMRAOR(DFN,"DR",PTR) D:$G(PSJACK)=1
"RTN","PSGSICHK",56,0)
 .S ^TMP("PSJDAI",$J,0)=1
"RTN","PSGSICHK",57,0)
 .S I=0 F  S I=$O(GMRAING(I)) Q:'I  S ^TMP("PSJDAI",$J,I,0)=GMRAING(I)
"RTN","PSGSICHK",58,0)
 I $D(^TMP("PSJDAI",$J)) S PSJPDRG=1 D
"RTN","PSGSICHK",59,0)
 .W $C(7),!!,"A Drug-Allergy Reaction exists for this medication!",!!
"RTN","PSGSICHK",60,0)
 .W !?7,"Drug: "_$P($G(^PSDRUG(PSJDD,0)),"^") I $O(^TMP("PSJDAI",$J)) W !,"Ingredients: " D
"RTN","PSGSICHK",61,0)
 ..S I=0 F  S I=$O(^TMP("PSJDAI",$J,I)) Q:'I  W:$X+$L($G(^(I,0)))+2>IOM !?19 W:I=1 $G(^TMP("PSJDAI",$J,I,0)) W:I>1 ", ",$G(^TMP("PSJDAI",$J,I,0))
"RTN","PSGSICHK",62,0)
 .W !!
"RTN","PSGSICHK",63,0)
 K PSJACK,GMRAING,I,^TMP($J)
"RTN","PSGSICHK",64,0)
 D ALGCLASS
"RTN","PSGSICHK",65,0)
CONT ; Ask user if they wish to continue in spite of an order check.
"RTN","PSGSICHK",66,0)
 Q:'$D(PSJPDRG)  N DIR S DIR(0)="Y",DIR("A")="Do you wish to continue entering this order",DIR("?",1)="Enter ""N"" if you wish to exit without creating a new order,"
"RTN","PSGSICHK",67,0)
 S DIR("?")="or ""Y"" to continue with the order entry process.",DIR("B")="NO" D ^DIR I 'Y S PSGORQF=1,X="^",COMQUIT=1 Q
"RTN","PSGSICHK",68,0)
 I 'INTERVEN!($P(PSJSYSU,";")'=3) Q
"RTN","PSGSICHK",69,0)
 ;I PSJIREQ D ^PSJRXI S:$G(PSJRXI("QFLG")) PSGORQF=1,X=U Q
"RTN","PSGSICHK",70,0)
 NEW PSJY
"RTN","PSGSICHK",71,0)
 W:PSJIREQ !!,"This is a CRITICAL interaction, you must enter an intervention log to continue"
"RTN","PSGSICHK",72,0)
 S DIR(0)="Y",DIR("A")="Do you wish to log an intervention",DIR("?",1)="Enter ""N"" if you do not wish to log an intervention,",DIR("?")="or ""Y"" to log an intervention." D ^DIR S PSJY=Y D:Y ^PSJRXI
"RTN","PSGSICHK",73,0)
 I 'PSJY,PSJIREQ S PSGORQF=1,COMQUIT=1
"RTN","PSGSICHK",74,0)
 ;I 'Y,$P(ND,U,4)="CRITICAL" S PSGORQF=1,X="^"
"RTN","PSGSICHK",75,0)
 Q
"RTN","PSGSICHK",76,0)
 ;
"RTN","PSGSICHK",77,0)
ENDL ; used by PSGTRAIN DRUG LOOK-UP option
"RTN","PSGSICHK",78,0)
 D ENCV^PSGSETU Q:$D(XQUIT)
"RTN","PSGSICHK",79,0)
 F  S DIC="^PSDRUG(",DIC(0)="AEIMOQZ",DIC("A")="Select DRUG: " W ! D ^DIC K DIC Q:+Y'>0  D SF
"RTN","PSGSICHK",80,0)
 D ENKV^PSGSETU K N5,ND,Q,Y Q
"RTN","PSGSICHK",81,0)
 ;
"RTN","PSGSICHK",82,0)
SF ;
"RTN","PSGSICHK",83,0)
 S Y=+Y,ND=$G(^PSDRUG(Y,0)),PSGID=+$G(^("I")) I PSGID W !!,"THIS DRUG IS INACTIVE AS OF ",$E($$ENDTC^PSGMI(PSGID),1,8)
"RTN","PSGSICHK",84,0)
 W !!,$S($P(ND,"^",9):"NON-",1:""),"FORMULARY ITEM" W:$P(ND,"^",10)]"" !,$P(ND,"^",10)
"RTN","PSGSICHK",85,0)
 S ND=$P($G(^PSDRUG(Y,2)),"^",3)["U" W !,$P("NOT^","^",ND+1)," A UNIT DOSE DRUG" W ! S ND=$G(^(8)),N5=$G(^(8.5)) W !?2,"DAY (nD) or DOSE (nL) LIMIT: " I ND W $P(ND,"^")
"RTN","PSGSICHK",86,0)
 W !?10,"UNIT DOSE MED ROUTE: " I $P(ND,"^",2) W $S($D(^PS(51.2,$P(ND,"^",2),0)):$P(^(0),"^"),1:$P(ND,"^",2))
"RTN","PSGSICHK",87,0)
 ; NAKED REF below refers to ^PS(51.2, on line above.
"RTN","PSGSICHK",88,0)
 W !?6,"UNIT DOSE SCHEDULE TYPE: " I $P(ND,"^",3)]"" W $P($P(";"_$P(^(0),"^",3),";"_$P(ND,"^",3)_":",2),";")
"RTN","PSGSICHK",89,0)
 W !?11,"UNIT DOSE SCHEDULE: " I $P(ND,"^",4)]"" W $P(ND,"^",4)
"RTN","PSGSICHK",90,0)
 W !,"CORRESPONDING OUTPATIENT DRUG: " I $P(ND,"^",5) W $S('$D(^PSDRUG(+$P(ND,"^",5),0)):$P(ND,"^",5),$P(^(0),"^")]"":$P(^(0),"^"),1:$P(ND,"^",5))
"RTN","PSGSICHK",91,0)
 W !?17,"ATC MNEMONIC: " I $P(N5,"^",2)]"" W $P(N5,"^",2)
"RTN","PSGSICHK",92,0)
 ;Q:'$D(^DD(50,212,0))  W !?17,$P(^(0),"^"),": " F Q=0:0 S Q=$O(^PSDRUG(Y,212,Q)) Q:'Q  S ND=$G(^(Q,0)) I ND,$P(ND,"^",2) W ?31,$S('$D(^PS(57.5,+ND,0)):+ND_";PS(57.5,",$P(^(0),"^")]"":$P(^(0),"^"),1:+ND_";PS(57.5,"),?56,$P(ND,"^",2),!
"RTN","PSGSICHK",93,0)
 W !?17,"ATC CANISTER: " F Q=0:0 S Q=$O(^PSDRUG(Y,212,Q)) Q:'Q  S ND=$G(^(Q,0)) I ND,$P(ND,"^",2) W ?31,$S('$D(^PS(57.5,+ND,0)):+ND_";PS(57.5,",$P(^(0),"^")]"":$P(^(0),"^"),1:+ND_";PS(57.5,"),?56,$P(ND,"^",2),!
"RTN","PSGSICHK",94,0)
 Q
"RTN","PSGSICHK",95,0)
 ;
"RTN","PSGSICHK",96,0)
OCHK ; Add drugs in current order to ^TMP("ORDERS" and call order checker.
"RTN","PSGSICHK",97,0)
 ; Set PSJOCHK=1 so OP order check doesn't Kill array.
"RTN","PSGSICHK",98,0)
 ;
"RTN","PSGSICHK",99,0)
 K ^TMP($J,"ORDERS")
"RTN","PSGSICHK",100,0)
 N PSJOCHK S PSJOCHK=1
"RTN","PSGSICHK",101,0)
PDWCHK(DFN,ON) ; Print Dup Drug order.
"RTN","PSGSICHK",102,0)
 N ND,ND0,ND2,X
"RTN","PSGSICHK",103,0)
 W:'$D(PSJDCHK) $C(7),$C(7),!!,"WARNING! THIS PATIENT HAS THE FOLLOWING ORDER(S) FOR THIS MEDICATION:",!!
"RTN","PSGSICHK",104,0)
 S ND=$$DRUGNAME^PSJLMUTL(DFN,ON)
"RTN","PSGSICHK",105,0)
 S F=$S(ON["P":"^PS(53.1,",1:"^PS(55,"_DFN_",5,"),ND0=$G(@(F_+ON_",0)")),ND2=$G(^(2)),X=$P(ND,U,2),X=$S(X=.2:$P($G(^(.2)),U,2),1:$G(^(.3)))
"RTN","PSGSICHK",106,0)
 W ?10,$P(ND,U),!,?13,"Give: ",X," ",$$ENMRN^PSGMI(+$P(ND0,U,3))," ",$P(ND2,U),!!
"RTN","PSGSICHK",107,0)
 Q
"RTN","PSGSICHK",108,0)
ALGCLASS ; checks any Drug allergies or reactions to see if
"RTN","PSGSICHK",109,0)
 ;         the new drug is the same class
"RTN","PSGSICHK",110,0)
 ; this call can be removed by commenting out the call on IVSOL+16
"RTN","PSGSICHK",111,0)
 N PSJLIST,CT,CLS,CLCHK,CNT,PSJL,LIST,DCCNT
"RTN","PSGSICHK",112,0)
 S GMRA="0^0^111" D EN1^GMRADPT
"RTN","PSGSICHK",113,0)
 F PSJLIST=0:0 S PSJLIST=$O(GMRAL(PSJLIST)) Q:'PSJLIST  D
"RTN","PSGSICHK",114,0)
 .K PSJAGL D EN1^GMRAOR2(PSJLIST,"PSJAGL")
"RTN","PSGSICHK",115,0)
 .; is the allergy/reaction drug class first four digits the same as the
"RTN","PSGSICHK",116,0)
 .; the class for the drug being entered?
"RTN","PSGSICHK",117,0)
 .S (CT,CLS)="",DCCNT=0
"RTN","PSGSICHK",118,0)
 .I $D(PSJAGL("V")) D
"RTN","PSGSICHK",119,0)
 ..F  S DCCNT=$O(PSJAGL("V",DCCNT)) Q:'DCCNT  S:$E($P($G(PSJAGL("V",DCCNT)),"^"),1,4)=$E($P($G(^PSDRUG(PSJDD,0)),"^",2),1,4) (PSJPDRG,CLCHK)=1,CNT=$S('$D(CNT):1,1:CNT+1),LIST(CNT)=$P($G(PSJAGL),"^")_"^"_$P($G(PSJAGL("V",DCCNT)),"^",2)
"RTN","PSGSICHK",120,0)
 D:$G(CLCHK)
"RTN","PSGSICHK",121,0)
 .W !!,$C(7),"A Drug-Allergy Reaction exists for this medication and/or class!"
"RTN","PSGSICHK",122,0)
 .F PSJL=0:0 S PSJL=$O(LIST(PSJL)) Q:'PSJL  D
"RTN","PSGSICHK",123,0)
 ..W !?6,"Drug: "_$P(LIST(PSJL),"^"),!,"Drug Class: "_$P(LIST(PSJL),"^",2),!
"RTN","PSGSICHK",124,0)
 Q
"RTN","PSGVBW")
0^1^B59408602
"RTN","PSGVBW",1,0)
PSGVBW ;BIR/CML3,MV-VERIFY ORDERS BY WARD, WARD GROUP, OR PATIENT ;22 Oct 98 / 3:14 PM
"RTN","PSGVBW",2,0)
 ;;5.0; INPATIENT MEDICATIONS ;**5,16,39,59,62,67,58,81,80,110,111,133,139**;16 DEC 97
"RTN","PSGVBW",3,0)
 ;
"RTN","PSGVBW",4,0)
 ; Reference to ^PS(55 is supported by DBIA #2191
"RTN","PSGVBW",5,0)
 ;
"RTN","PSGVBW",6,0)
 N PSJNEW,PSGPTMP,PPAGE,CL,CG S PSJNEW=1
"RTN","PSGVBW",7,0)
START ;
"RTN","PSGVBW",8,0)
 D ENCV^PSGSETU I $D(XQUIT) K XQUIT Q
"RTN","PSGVBW",9,0)
 ;I ($P(PSJSYSU,";")=3)!($P(PSJSYSU,";",3)=2) 
"RTN","PSGVBW",10,0)
 D ^PSIVXU I $D(XQUIT) K XQUIT Q
"RTN","PSGVBW",11,0)
 D NOW^%DTC S PSGDT=%
"RTN","PSGVBW",12,0)
 I '$D(^XTMP("PSJPVNV")) D
"RTN","PSGVBW",13,0)
 .K DIR S DIR(0)="Y",DIR("A")="Display an Order Summary",DIR("B")="NO"
"RTN","PSGVBW",14,0)
 .S DIR("?",1)="Enter 'YES' to see a summary of orders by type and ward group",DIR("?")="or 'NO' to go directly to patient selection."
"RTN","PSGVBW",15,0)
 .D ^DIR K DIR Q:$D(DIRUT)!$D(DUOUT)  I Y D CNTORDRS^PSGVBWU
"RTN","PSGVBW",16,0)
 K ^TMP("PSJ",$J) S PSGPXN=0 D GTOOP G:$D(DIRUT) DONE L +^PS(53.45,PSJSYSP):1 E  D LOCKERR^PSJOE G DONE
"RTN","PSGVBW",17,0)
 S PSGSSH="VBW",PSGPXN=0,PSJPROT=$S($P(PSJSYSU,";",3)=3:3,$G(PSJRNF):3,$G(PSJIRNF):3,1:1)
"RTN","PSGVBW",18,0)
 S PSGVBWW=$S(PSJTOO=1:"NON-VERIFIED",PSJTOO=2:"PENDING",1:"NON-VERIFIED AND/OR PENDING")
"RTN","PSGVBW",19,0)
 F  K ^TMP("PSJSELECT",$J) D ^PSGSEL Q:"^"[PSGSS  F  S (PSGP,WD,WG)=0 S PSGPTMP=0,PPAGE=1 D @PSGSS Q:+Y'>0  D GO
"RTN","PSGVBW",20,0)
 ;
"RTN","PSGVBW",21,0)
DONE ;
"RTN","PSGVBW",22,0)
 K ^TMP("PSGVBW",$J),^TMP("PSJSELECT",$J),^TMP("PSJLIST",$J),^TMP("PSJON",$J)
"RTN","PSGVBW",23,0)
 K CHK,D0,DRGI,FQC,J,ND,ON,PN,PSGODT,PSGOEA,PSGOP,PSGSS,PSGSSH,RB,SD,ST,TM,WD,WDN,WG,PRI,PSJPNV,PSJCT
"RTN","PSGVBW",24,0)
 K PSGODDD,PSGOEORF,PSJORL,PSJORPCL,PSJORTOU,PSJORVP,PSGTOL,PSJTOO,PSGUOW,PSGONV,PX,PSGOEAV,PSGPX,PSGVBWTO,PSGVBWW,PSJOPC,PSGOENOF,PSJPROT,PSJLM,PSJASK
"RTN","PSGVBW",25,0)
 L -^PS(53.45,PSJSYSP) G:$G(PSGPXN) ^PSGPER1 D ENKV^PSGSETU K ND Q
"RTN","PSGVBW",26,0)
 ;
"RTN","PSGVBW",27,0)
GO ;
"RTN","PSGVBW",28,0)
 I PSGSS'="P" W !,"...a few moments, please..." K ^TMP("PSGVBW",$J) D ARRAY K CHK,ON,PN,RB,SD,TM,WD,WDN,WG,X,Y
"RTN","PSGVBW",29,0)
 I PSGSS'="P",'$D(^TMP("PSGVBW",$J)) W !,$C(7),"NO ",PSGVBWW," ORDERS FOR ",$S(PSGSS="P":"PATIENT",PSGSS="L":"CLINIC GROUP",PSGSS="C":"CLINIC",1:"WARD"),$S(PSGSS="G":" GROUP",1:"")," SELECTED." Q
"RTN","PSGVBW",30,0)
 D ^PSGVBW0 Q
"RTN","PSGVBW",31,0)
 ;
"RTN","PSGVBW",32,0)
 ; look-ups on ward group, ward, or patient; depending on value of SS
"RTN","PSGVBW",33,0)
G ;
"RTN","PSGVBW",34,0)
 K DIR S DIR(0)="FAO",DIR("A")="Select WARD GROUP: "
"RTN","PSGVBW",35,0)
 S DIR("?")="^D GDIC^PSGVBW" W ! D ^DIR
"RTN","PSGVBW",36,0)
 I Y="^OTHER" D OUTPT^PSGVBW1 Q
"RTN","PSGVBW",37,0)
 ;S DIC="^PS(57.5,",DIC(0)="QEAMI",DIC("A")="Select WARD GROUP: "
"RTN","PSGVBW",38,0)
GDIC ;
"RTN","PSGVBW",39,0)
 K DIC S DIC="^PS(57.5,",DIC(0)="QEMI" D ^DIC K DIC S:+Y>0 WG=+Y
"RTN","PSGVBW",40,0)
 W:X["?" !!,"Enter ""^OTHER"" to include all Outpatient IV orders and orders from the",!,"wards that do not belong to a ward group",!
"RTN","PSGVBW",41,0)
 Q
"RTN","PSGVBW",42,0)
C ;
"RTN","PSGVBW",43,0)
 K DIR S DIR(0)="FAO",DIR("A")="Select CLINIC: "
"RTN","PSGVBW",44,0)
 S DIR("?")="^D CDIC^PSGVBW" W ! D ^DIR
"RTN","PSGVBW",45,0)
CDIC ;
"RTN","PSGVBW",46,0)
 K DIC S DIC="^SC(",DIC(0)="QEMIZ" D ^DIC K DIC S:+Y>0 CL=+Y
"RTN","PSGVBW",47,0)
 W:X["?" !!,"Enter the clinic you want to use to select patients for processing.",!
"RTN","PSGVBW",48,0)
 Q
"RTN","PSGVBW",49,0)
L ;
"RTN","PSGVBW",50,0)
 K DIR S DIR(0)="FAO",DIR("A")="Select CLINIC GROUP: "
"RTN","PSGVBW",51,0)
 S DIR("?")="^D LDIC^PSGVBW" W ! D ^DIR
"RTN","PSGVBW",52,0)
LDIC ;
"RTN","PSGVBW",53,0)
 K DIC S DIC="^PS(57.8,",DIC(0)="QEMI" D ^DIC K DIC S:+Y>0 CG=+Y
"RTN","PSGVBW",54,0)
 W:X["?" !!,"Enter the name of the clinic group you want to use to select patients for processing."
"RTN","PSGVBW",55,0)
 Q
"RTN","PSGVBW",56,0)
W ;
"RTN","PSGVBW",57,0)
 K DIR S DIR(0)="FAO",DIR("A")="Select WARD: "
"RTN","PSGVBW",58,0)
 S DIR("?")="^D WDIC^PSGVBW" W ! D ^DIR
"RTN","PSGVBW",59,0)
 I Y="^OTHER" D OUTPT^PSGVBW1 Q
"RTN","PSGVBW",60,0)
WDIC ;
"RTN","PSGVBW",61,0)
 ;S DIC="^DIC(42,",DIC(0)="QEAMI",DIC("A")="Select WARD: "
"RTN","PSGVBW",62,0)
 K DIC S DIC="^DIC(42,",DIC(0)="QEMIZ" D ^DIC K DIC S:+Y>0 WD=+Y
"RTN","PSGVBW",63,0)
 W:X["?" !!,"Enter ""^OTHER"" for Outpatient IV orders",!
"RTN","PSGVBW",64,0)
 Q
"RTN","PSGVBW",65,0)
P ;
"RTN","PSGVBW",66,0)
 K ^TMP("PSJSELECT",$J) S PSJCNT=1 F  D ^PSJP Q:PSGP<0  D
"RTN","PSGVBW",67,0)
 .S PSJNV=0
"RTN","PSGVBW",68,0)
 .NEW ON,XX F ON=0:0 S ON=$O(^PS(53.1,"AS","N",PSGP,ON)) Q:'ON  S ND=$P($G(^PS(53.1,ON,0)),U,4) S XX=$S(ND="U"&(PSJPAC'=2):1,ND'="U"&(PSJPAC'=1):1,1:0) I XX S PSJNV=1 Q
"RTN","PSGVBW",69,0)
 .;S PSJNV=$O(^PS(53.1,"AS","N",+PSGP,0)),PSJPEN=$O(^PS(53.1,"AS","P",+PSGP,0))
"RTN","PSGVBW",70,0)
 .S PSJPEN=$O(^PS(53.1,"AS","P",+PSGP,0))
"RTN","PSGVBW",71,0)
 .I 'PSJNV D ^PSJAC D
"RTN","PSGVBW",72,0)
 ..I '$D(PSGDT) D NOW^%DTC S PSGDT=$E(%,1,12)
"RTN","PSGVBW",73,0)
 ..S X1=$P(PSGDT,"."),X2=-2 D C^%DTC S PSGODT=X_(PSGDT#1)
"RTN","PSGVBW",74,0)
 ..I PSJPAC'=2 F ST="C","O","OC","P","R" F SD=$S(ST="O":PSJPAD,1:PSGODT):0 S SD=$O(^PS(55,PSGP,5,"AU",ST,SD)) Q:'SD!PSJNV  F ON=0:0 S ON=$O(^PS(55,PSGP,5,"AU",ST,SD,ON)) Q:'ON  I $D(^PS(55,PSGP,5,ON,0)),$P(^(0),"^",9)'["D" D IFT I  S PSJNV=1 Q
"RTN","PSGVBW",75,0)
 ..I PSJPAC'=1 F SD=+PSJPAD:0 S SD=$O(^PS(55,PSGP,"IV","AIS",SD)) Q:'SD  F ON=0:0 S ON=$O(^PS(55,PSGP,"IV","AIS",SD,ON)) Q:'ON  I $D(^PS(55,PSGP,"IV",ON,0)),$P(^(0),"^",17)'["D" D IFT2 I  S PSJNV=1 Q
"RTN","PSGVBW",76,0)
 .S X=$S(PSJTOO=1:PSJNV,PSJTOO=2:PSJPEN,1:(PSJNV+PSJPEN))
"RTN","PSGVBW",77,0)
 .I X D SETPN S ^TMP("PSJSELECT",$J,PSJCNT)=PN,^TMP("PSJSELECT",$J,"B",$P(PN,U),PSJCNT)="",PSJCNT=PSJCNT+1 Q
"RTN","PSGVBW",78,0)
 .W !,"No ",PSGVBWW," orders found for this patient."
"RTN","PSGVBW",79,0)
 S:$D(^TMP("PSJSELECT",$J)) Y=1
"RTN","PSGVBW",80,0)
 Q
"RTN","PSGVBW",81,0)
 ;
"RTN","PSGVBW",82,0)
ARRAY ; put patient(s) with non-verified orders into array
"RTN","PSGVBW",83,0)
 I '$D(PSGDT) D NOW^%DTC S PSGDT=$E(%,1,12)
"RTN","PSGVBW",84,0)
 S X1=$P(PSGDT,"."),X2=-2 D C^%DTC S PSGODT=X_(PSGDT#1),PSGVBWW=$S(PSJTOO=1:"NON-VERIFIED",PSJTOO=2:"PENDING",1:"NON-VERIFIED AND/OR PENDING") I PSGSS="P" D IF S:$T ^TMP("PSGVBW",$J)=$P(PSGP(0),"^")_"^"_PSGP Q
"RTN","PSGVBW",85,0)
 G CG:PSGSS="L",CL:PSGSS="C",WD:PSGSS="W" F WD=0:0 S WD=$O(^PS(57.5,"AC",WG,WD)) Q:'WD  D WD
"RTN","PSGVBW",86,0)
 Q
"RTN","PSGVBW",87,0)
 ;
"RTN","PSGVBW",88,0)
CG S CL="" F  S CL=$O(^PS(57.8,"AD",CG,CL)) Q:CL=""  D CL
"RTN","PSGVBW",89,0)
 Q
"RTN","PSGVBW",90,0)
CL S WDN=$S($D(^SC(CL,0)):$P(^(0),"^"),1:"")
"RTN","PSGVBW",91,0)
 S PSGP="" F  S PSGP=$O(^PS(53.1,"AD",CL,PSGP)) Q:PSGP=""  D ^PSJAC,IF
"RTN","PSGVBW",92,0)
 Q
"RTN","PSGVBW",93,0)
WD S WDN=$S($D(^DIC(42,WD,0)):$P(^(0),"^"),1:"") I WDN]"" F PSGP=0:0 S PSGP=$O(^DPT("CN",WDN,PSGP)) Q:'PSGP  I $S($D(^PS(55,"APV",PSGP)):1,$D(^PS(55,"APIV",PSGP)):1,$O(^PS(55,PSGP,5,"AUS",PSGDT)):1,1:$D(^PS(53.1,"AC",PSGP))) D ^PSJAC,IF
"RTN","PSGVBW",94,0)
 Q
"RTN","PSGVBW",95,0)
IF ;
"RTN","PSGVBW",96,0)
 W "." I PSJTOO'=1 F ON=0:0 S ON=$O(^PS(53.1,"AS","P",PSGP,ON)) Q:'ON  S X=$P($G(^PS(53.1,ON,0)),U,4),Y=0 I "FIU"[X D  G:Y SET
"RTN","PSGVBW",97,0)
 .I PSJPAC=3 S Y=1 Q
"RTN","PSGVBW",98,0)
 .I PSJPAC=2 S Y=X'="U" Q 
"RTN","PSGVBW",99,0)
 .I PSJPAC=1 S Y=X="U"
"RTN","PSGVBW",100,0)
 Q:PSJTOO=2
"RTN","PSGVBW",101,0)
 F X="N","I" I $D(^PS(53.1,"AS",X,PSGP)) NEW XX S XX=0 D  G:XX SET
"RTN","PSGVBW",102,0)
 . NEW ON F ON=0:0 S ON=$O(^PS(53.1,"AS",X,PSGP,ON)) Q:'ON  S ND=$P($G(^PS(53.1,ON,0)),U,4) S XX=$S(ND="U"&(PSJPAC'=2):1,ND'="U"&(PSJPAC'=1):1,1:0) Q:XX
"RTN","PSGVBW",103,0)
 S X1=$P(PSGDT,"."),X2=-2 D C^%DTC S PSGODT=X_(PSGDT#1)
"RTN","PSGVBW",104,0)
 I PSJPAC'=2 F ST="C","O","OC","P","R" F SD=$S(ST="O":PSJPAD,1:PSGODT):0 S SD=$O(^PS(55,PSGP,5,"AU",ST,SD)) Q:'SD  F ON=0:0 S ON=$O(^PS(55,PSGP,5,"AU",ST,SD,ON)) Q:'ON  I $D(^PS(55,PSGP,5,ON,0)),$P(^(0),"^",9)'["D" D IFT I  G SET
"RTN","PSGVBW",105,0)
 I PSJPAC'=1 F SD=+PSJPAD:0 S SD=$O(^PS(55,PSGP,"IV","AIS",SD)) Q:'SD  F ON=0:0 S ON=$O(^PS(55,PSGP,"IV","AIS",SD,ON)) Q:'ON  I $D(^PS(55,PSGP,"IV",ON,0)),$P(^(0),"^",17)'["D" D IFT2 I  G SET
"RTN","PSGVBW",106,0)
 Q
"RTN","PSGVBW",107,0)
 ;
"RTN","PSGVBW",108,0)
IFT ;
"RTN","PSGVBW",109,0)
 S ND=$G(^PS(55,PSGP,5,ON,4)) I $S(SD>PSGDT:$S(ND="":1,'$P(ND,"^",$S(PSJSYSU:PSJSYSU,1:1)):1,$P(ND,"^",13):1,$P(ND,"^",19):1,$P(ND,"^",23):1,1:$P(ND,"^",16)),ST="O":$S(ND="":1,1:'$P(ND,"^",$S(PSJSYSU:PSJSYSU,1:1))),1:$P(ND,"^",16))
"RTN","PSGVBW",110,0)
 Q
"RTN","PSGVBW",111,0)
 ;
"RTN","PSGVBW",112,0)
IFT2 ;
"RTN","PSGVBW",113,0)
 ;S ND=$G(^PS(55,PSGP,"IV",ON,4)) I $S((SD>PSGDT)&(ND=""):1,'$P(ND,"^",$S(+PSJSYSU=1:1,1:4)):1,1:0)
"RTN","PSGVBW",114,0)
 S ND=$G(^PS(55,PSGP,"IV",ON,4))
"RTN","PSGVBW",115,0)
 I ($P($G(^PS(55,PSGP,"IV",ON,.2)),"^",4)="D")&('$P(ND,"^",$S(+PSJSYSU=1:1,1:4)))  Q
"RTN","PSGVBW",116,0)
 I $S((SD>PSGDT)&('$P(ND,"^",$S(+PSJSYSU=1:1,1:4))):1,1:0)
"RTN","PSGVBW",117,0)
 Q
"RTN","PSGVBW",118,0)
SET ;
"RTN","PSGVBW",119,0)
 S TM=$S(PSJPRB="":"",1:$P($G(^PS(57.7,WD,1,+$O(^PS(57.7,"AWRT",WD,PSJPRB,0)),0)),"^")) S:TM="" TM="zz"
"RTN","PSGVBW",120,0)
 ;
"RTN","PSGVBW",121,0)
SETPN ;
"RTN","PSGVBW",122,0)
 S PN=$P(PSGP(0),"^")_U_PSGP_U_PSJPBID S:PSGSS'="P" ^TMP("PSGVBW",$J,WDN,TM,PN)=""
"RTN","PSGVBW",123,0)
 Q
"RTN","PSGVBW",124,0)
 ;
"RTN","PSGVBW",125,0)
GTOOP ; Get 'Type Of Order' and Package
"RTN","PSGVBW",126,0)
 I $P(PSJSYSU,";",3)<2,'$G(PSJRNF),'$G(PSJIRNF) S PSJPAC=0,PSJTOO=1 D GTPAC Q
"RTN","PSGVBW",127,0)
 S (PSJPAC,PSJTOO)=0 W !!,"1) Non-Verified Orders",!,"2) Pending Orders",!!
"RTN","PSGVBW",128,0)
 N DIR S DIR(0)="LAO^1:2",DIR("A")="Select Order Type(s) (1-2): ",DIR("?")="^D TOH^PSGVBW" D ^DIR
"RTN","PSGVBW",129,0)
 I 'Y D EXIT("TYPE OF ORDER") Q
"RTN","PSGVBW",130,0)
 S PSJTOO=$S($L(Y)>2:3,1:$P(Y,","))
"RTN","PSGVBW",131,0)
 D GTPAC
"RTN","PSGVBW",132,0)
 I 'PSJPAC D EXIT("PACKAGE") Q
"RTN","PSGVBW",133,0)
 Q
"RTN","PSGVBW",134,0)
GTPAC ;
"RTN","PSGVBW",135,0)
 ;S PSJTOO=$S($L(Y)>2:3,1:$P(Y,",")) Q:PSJTOO=1
"RTN","PSGVBW",136,0)
 ;I $G(PSJRNF) S PSJPAC=1 Q
"RTN","PSGVBW",137,0)
 I ($G(PSJRNF))&('$G(PSJIRNF))&(PSJTOO=2) S PSJPAC=1 Q
"RTN","PSGVBW",138,0)
 I ($G(PSJIRNF))&('$G(PSJRNF))&(PSJTOO=2) S PSJPAC=2 Q
"RTN","PSGVBW",139,0)
 W !!,"1) Unit Dose Orders",!,"2) IV Orders",!
"RTN","PSGVBW",140,0)
 K DIR S DIR(0)="LAO^1:2",DIR("A")="Select Package(s) (1-2): ",DIR("?")="^D TOH^PSGVBW" W ! D ^DIR
"RTN","PSGVBW",141,0)
 S PSJPAC=$S($L(Y)>2:3,1:$P(Y,","))
"RTN","PSGVBW",142,0)
 Q
"RTN","PSGVBW",143,0)
EXIT(X) ;
"RTN","PSGVBW",144,0)
 W !!,X," not selected, option terminated."
"RTN","PSGVBW",145,0)
 Q
"RTN","PSGVBW",146,0)
 ;
"RTN","PSGVBW",147,0)
TOH ;
"RTN","PSGVBW",148,0)
 W !!,"SELECT FROM:",!?5,"1 - NON-VERIFIED ORDERS",!?5,"2 - PENDING ORDERS"
"RTN","PSGVBW",149,0)
 W !!?2,"Enter '1' if you want to verify non-verified orders.  Enter '2' if you",!,"want to complete pending orders.  Enter '1,2' or '1-2' if you want to do both." Q
"VER")
8.0^22.0
"^DD",59.5,59.5,13,0)
LABEL DEVICE^FX^^0;2^K:$L(X)>30!($L(X)<1) X I $D(X),X]"" D ENDLP^PSJDDUT2 K:X="" X
"^DD",59.5,59.5,13,3)
Enter a device on which labels may be printed.
"^DD",59.5,59.5,13,20,0)
^.3LA^1^1
"^DD",59.5,59.5,13,20,1,0)
PSJI
"^DD",59.5,59.5,13,21,0)
^^3^3^2970219^
"^DD",59.5,59.5,13,21,1,0)
  Enter the name of the device that will be used most frequently as the LABEL
"^DD",59.5,59.5,13,21,2,0)
device for this IV ROOM.  This field will be shown as the default for the
"^DD",59.5,59.5,13,21,3,0)
'Printer label device: ' prompt when signing into the IV PACKAGE.
"^DD",59.5,59.5,13,"DT")
3050310
"^DD",59.5,59.5,14,0)
REPORT DEVICE^FX^^0;3^K:$L(X)>30!($L(X)<1) X I $D(X),X]"" D ENDLP^PSJDDUT2 K:X="" X
"^DD",59.5,59.5,14,3)
Enter a device on which reports may be printed.
"^DD",59.5,59.5,14,20,0)
^.3LA^1^1
"^DD",59.5,59.5,14,20,1,0)
PSJI
"^DD",59.5,59.5,14,21,0)
^^4^4^2940714^^^^
"^DD",59.5,59.5,14,21,1,0)
 Enter the PROFILE device number or name that will be used most frequently
"^DD",59.5,59.5,14,21,2,0)
by this IV ROOM.  This field will be shown as the default for the 'Printer
"^DD",59.5,59.5,14,21,3,0)
profile device: ' prompt when signing into the IV PACKAGE.
"^DD",59.5,59.5,14,21,4,0)
 
"^DD",59.5,59.5,14,"DT")
3050310
"BLD",5286,6)
^SEQ #129
**END**
**END**
