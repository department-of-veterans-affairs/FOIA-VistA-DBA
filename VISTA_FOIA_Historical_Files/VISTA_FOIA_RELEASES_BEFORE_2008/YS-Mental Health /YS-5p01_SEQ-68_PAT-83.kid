EMERGENCY Released YS*5.01*83 SEQ #68
Extracted from mail message
**KIDS**:YS*5.01*83^

**INSTALL NAME**
YS*5.01*83
"BLD",5363,0)
YS*5.01*83^MENTAL HEALTH^0^3040206^y
"BLD",5363,1,0)
^^1^1^3040203^
"BLD",5363,1,1,0)
This patch fixes problems with scoring of the MBMD instrument.
"BLD",5363,4,0)
^9.64PA^^0
"BLD",5363,"INIT")
POST^YS501P83
"BLD",5363,"KRN",0)
^9.67PA^8989.52^19
"BLD",5363,"KRN",.4,0)
.4
"BLD",5363,"KRN",.401,0)
.401
"BLD",5363,"KRN",.402,0)
.402
"BLD",5363,"KRN",.403,0)
.403
"BLD",5363,"KRN",.5,0)
.5
"BLD",5363,"KRN",.84,0)
.84
"BLD",5363,"KRN",3.6,0)
3.6
"BLD",5363,"KRN",3.8,0)
3.8
"BLD",5363,"KRN",9.2,0)
9.2
"BLD",5363,"KRN",9.8,0)
9.8
"BLD",5363,"KRN",9.8,"NM",0)
^9.68A^1^1
"BLD",5363,"KRN",9.8,"NM",1,0)
YTMBMD^^0^B20606864
"BLD",5363,"KRN",9.8,"NM","B","YTMBMD",1)

"BLD",5363,"KRN",19,0)
19
"BLD",5363,"KRN",19.1,0)
19.1
"BLD",5363,"KRN",101,0)
101
"BLD",5363,"KRN",409.61,0)
409.61
"BLD",5363,"KRN",771,0)
771
"BLD",5363,"KRN",870,0)
870
"BLD",5363,"KRN",8989.51,0)
8989.51
"BLD",5363,"KRN",8989.52,0)
8989.52
"BLD",5363,"KRN",8994,0)
8994
"BLD",5363,"KRN","B",.4,.4)

"BLD",5363,"KRN","B",.401,.401)

"BLD",5363,"KRN","B",.402,.402)

"BLD",5363,"KRN","B",.403,.403)

"BLD",5363,"KRN","B",.5,.5)

"BLD",5363,"KRN","B",.84,.84)

"BLD",5363,"KRN","B",3.6,3.6)

"BLD",5363,"KRN","B",3.8,3.8)

"BLD",5363,"KRN","B",9.2,9.2)

"BLD",5363,"KRN","B",9.8,9.8)

"BLD",5363,"KRN","B",19,19)

"BLD",5363,"KRN","B",19.1,19.1)

"BLD",5363,"KRN","B",101,101)

"BLD",5363,"KRN","B",409.61,409.61)

"BLD",5363,"KRN","B",771,771)

"BLD",5363,"KRN","B",870,870)

"BLD",5363,"KRN","B",8989.51,8989.51)

"BLD",5363,"KRN","B",8989.52,8989.52)

"BLD",5363,"KRN","B",8994,8994)

"BLD",5363,"PRE")
YS501P83
"BLD",5363,"QUES",0)
^9.62^^
"BLD",5363,"REQB",0)
^9.611^1^1
"BLD",5363,"REQB",1,0)
YS*5.01*76^2
"BLD",5363,"REQB","B","YS*5.01*76",1)

"INIT")
POST^YS501P83
"MBREQ")
0
"PKG",7,-1)
1^1
"PKG",7,0)
MENTAL HEALTH^YS^Version 5.01 of Mental Health
"PKG",7,20,0)
^9.402P^^
"PKG",7,22,0)
^9.49I^1^1
"PKG",7,22,1,0)
5.01^2941230^2990120
"PKG",7,22,1,"PAH",1,0)
83^3040206
"PKG",7,22,1,"PAH",1,1,0)
^^1^1^3040206
"PKG",7,22,1,"PAH",1,1,1,0)
This patch fixes problems with scoring of the MBMD instrument.
"PRE")
YS501P83
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
2
"RTN","YS501P83")
0^^B5532147
"RTN","YS501P83",1,0)
YS501P83 ;BP/TMD,Pre-init Routine for YS*5.01*83 ; 2/5/04 9:06am
"RTN","YS501P83",2,0)
 ;;5.01;MENTAL HEALTH;**83**;Dec 30, 1994
"RTN","YS501P83",3,0)
 ;
"RTN","YS501P83",4,0)
ENV ;Main entry point for Environment check point.
"RTN","YS501P83",5,0)
 ;
"RTN","YS501P83",6,0)
 S XPDABORT=""
"RTN","YS501P83",7,0)
 D PROGCHK(.XPDABORT) ;checks programmer variables
"RTN","YS501P83",8,0)
 I XPDABORT="" K XPDABORT
"RTN","YS501P83",9,0)
 Q
"RTN","YS501P83",10,0)
 ;
"RTN","YS501P83",11,0)
POST ;Main entry point for Post-init items.
"RTN","YS501P83",12,0)
 ;
"RTN","YS501P83",13,0)
 N YTTNAME,YTTIEN
"RTN","YS501P83",14,0)
 D 20,21
"RTN","YS501P83",15,0)
 Q
"RTN","YS501P83",16,0)
 ;
"RTN","YS501P83",17,0)
20 S YTTNAME="4 Sociable",YTTIEN=""
"RTN","YS501P83",18,0)
 S YTTIEN=$O(^YTT(601,244,"S","C",YTTNAME,YTTIEN))
"RTN","YS501P83",19,0)
 I +$G(YTTIEN) I $D(^YTT(601,244,"S",YTTIEN,"K",1,0)) D  Q
"RTN","YS501P83",20,0)
 .S ^YTT(601,244,"S",YTTIEN,"K",1,0)="4^T;3^17^T;3^87^T;3^100^T;3^163^T;3^52^T;2^114^T;2^73^T;1^162^T;1"
"RTN","YS501P83",21,0)
 .D BMES^XPDUTL("**The key for Test Scale '"_YTTNAME_"' was successfully updated.")
"RTN","YS501P83",22,0)
 D BMES^XPDUTL("**The key for Test Scale '"_YTTNAME_"' could not be updated.")
"RTN","YS501P83",23,0)
 D BMES^XPDUTL("Please contact IRM staff.")
"RTN","YS501P83",24,0)
 Q
"RTN","YS501P83",25,0)
 ;
"RTN","YS501P83",26,0)
21 S YTTNAME="5 Confident",YTTIEN=""
"RTN","YS501P83",27,0)
 S YTTIEN=$O(^YTT(601,244,"S","C",YTTNAME,YTTIEN))
"RTN","YS501P83",28,0)
 I +$G(YTTIEN) I $D(^YTT(601,244,"S",YTTIEN,"K",1,0)) D  Q
"RTN","YS501P83",29,0)
 .S ^YTT(601,244,"S",YTTIEN,"K",1,0)="34^T;3^52^T;3^73^T;3^90^T;3^114^T;3^87^T;2^17^T;1^79^T;1^121^T;1^129^T;1^138^T;1^163^T;1"
"RTN","YS501P83",30,0)
 .D BMES^XPDUTL("**The key for Test Scale '"_YTTNAME_"' was successfully updated.")
"RTN","YS501P83",31,0)
 D BMES^XPDUTL("**The key for Test Scale '"_YTTNAME_"' could not be updated.")
"RTN","YS501P83",32,0)
 D BMES^XPDUTL("Please contact IRM staff.")
"RTN","YS501P83",33,0)
 Q
"RTN","YS501P83",34,0)
 ;
"RTN","YS501P83",35,0)
PROGCHK(XPDABORT) ;checks for necessary programmer variables
"RTN","YS501P83",36,0)
 ;
"RTN","YS501P83",37,0)
 I '$G(DUZ)!($G(DUZ(0))'="@")!('$G(DT))!($G(U)'="^") D
"RTN","YS501P83",38,0)
 .D BMES^XPDUTL("*****")
"RTN","YS501P83",39,0)
 .D MES^XPDUTL("Your programming variables are not set up properly.")
"RTN","YS501P83",40,0)
 .D MES^XPDUTL("Installation aborted.")
"RTN","YS501P83",41,0)
 .D MES^XPDUTL("*****")
"RTN","YS501P83",42,0)
 .S XPDABORT=2
"RTN","YS501P83",43,0)
 Q
"RTN","YTMBMD")
0^1^B20606864
"RTN","YTMBMD",1,0)
YTMBMD ;ALB/ASF-MBMD ; 2/6/04 9:09am
"RTN","YTMBMD",2,0)
 ;;5.01;MENTAL HEALTH;**76,83**;Dec 30, 1994
"RTN","YTMBMD",3,0)
MAIN ;
"RTN","YTMBMD",4,0)
 N A,B,G,I,L1,L2,N,X,YSANS,YSDAS,YSDAS1,YSIN,YSSID,YSTOUT,YSUOUT,YSVFLAG
"RTN","YTMBMD",5,0)
 D PTVAR^YSLRP
"RTN","YTMBMD",6,0)
 D RD
"RTN","YTMBMD",7,0)
 D VALIDITY ;Q:YSVFLAG
"RTN","YTMBMD",8,0)
 D RAW
"RTN","YTMBMD",9,0)
 D PS1
"RTN","YTMBMD",10,0)
 D RPA
"RTN","YTMBMD",11,0)
 D HPA
"RTN","YTMBMD",12,0)
 D HPA1
"RTN","YTMBMD",13,0)
 D:YSTY["*" REPT
"RTN","YTMBMD",14,0)
 Q
"RTN","YTMBMD",15,0)
RD S X=^YTD(601.2,YSDFN,1,YSTEST,1,YSED,1)
"RTN","YTMBMD",16,0)
 Q
"RTN","YTMBMD",17,0)
VALIDITY ;check if ok to score
"RTN","YTMBMD",18,0)
 S YSVFLAG=0
"RTN","YTMBMD",19,0)
 I $L(X,"X")>11 S YSVFLAG=1 Q
"RTN","YTMBMD",20,0)
 I ($E(X,106)="T")&($E(X,124)="T") S YSVFLAG=1 Q
"RTN","YTMBMD",21,0)
 I (YSAGE<18)!(YSAGE>85) S YSVFLAG=1 Q
"RTN","YTMBMD",22,0)
 Q
"RTN","YTMBMD",23,0)
RAW ; raw scores
"RTN","YTMBMD",24,0)
 S R="0^0^0^0^0^0^0^0^0^0^0^0^0^0^0^0^0^0^0^0^0^0^0^0^0^0^0^0^0^0^0^0^0^0^0^0^0^0^0"
"RTN","YTMBMD",25,0)
 S N=0 F  S N=$O(^YTT(601,YSTEST,"S",N)) Q:N'>0  D
"RTN","YTMBMD",26,0)
 . S G=^YTT(601,YSTEST,"S",N,"K",1,0),I=1
"RTN","YTMBMD",27,0)
 . F  S YSIN=$P(G,U,I),YSANS=$E($P(G,U,I+1),1),YSWT=$P($P(G,U,I+1),";",2),I=I+2 Q:YSIN=""  S:$E(X,YSIN)=YSANS $P(R,U,N)=$P(R,U,N)+YSWT
"RTN","YTMBMD",28,0)
 Q
"RTN","YTMBMD",29,0)
PS1 ; untransformed prevelence scores
"RTN","YTMBMD",30,0)
 S S="0^0^0^0^0^0^0^0^0^0^0^0^0^0^0^0^0^0^0^0^0^0^0^0^0^0^0^0^0^0^0^0^0^0^0^0^0^0^0"
"RTN","YTMBMD",31,0)
 F I=11:1:39 S $P(S,U,I)=$P(^YTT(601,YSTEST,"S",I,YSSEX),U,$P(R,U,I)+1)
"RTN","YTMBMD",32,0)
 S X=$P(R,U,2) S $P(S,U,2)=$S(X<9:"L",X=9:"M",X=10:"H",1:0) ;scale X ASF 1/30/04
"RTN","YTMBMD",33,0)
 S X=$P(R,U,3) S $P(S,U,3)=$S(X<10:"L",X<13:"M",X>12:"H",1:0) ;scale Y ASF 1/30/04
"RTN","YTMBMD",34,0)
 S X=$P(R,U,4) S $P(S,U,4)=$S(X<5:"L",X=5:"M",X>5:"H",1:0) ;scale Z ASF 1/30/04
"RTN","YTMBMD",35,0)
 F I=5:1:10 S X=$P(R,U,I) S $P(S,U,I)=$S(X=0:"L",X=1:"M",X>1:"H",1:0) ;indicators ASF 1/30/04
"RTN","YTMBMD",36,0)
 Q
"RTN","YTMBMD",37,0)
RPA ;Response Pattern Adjustment
"RTN","YTMBMD",38,0)
 S YSDAS=0
"RTN","YTMBMD",39,0)
 I ($P(S,U,2)="H")&($P(S,U,3)="H")&($P(S,U,4)'="H") S YSDAS=10
"RTN","YTMBMD",40,0)
 I ($P(S,U,2)'="H")&($P(S,U,3)="H")&($P(S,U,4)'="H") S YSDAS=10
"RTN","YTMBMD",41,0)
 I ($P(S,U,2)="H")&($P(S,U,3)'="H")&($P(S,U,4)'="H") S YSDAS=-5
"RTN","YTMBMD",42,0)
 I ($P(S,U,2)="H")&($P(S,U,3)'="H")&($P(S,U,4)="H") S YSDAS=-10
"RTN","YTMBMD",43,0)
 I ($P(S,U,2)'="H")&($P(S,U,3)'="H")&($P(S,U,4)="H") S YSDAS=-10
"RTN","YTMBMD",44,0)
 F I=11,12,13,14,15,27,28,29,30,31,32,33,34,35,36,37,38,39 S $P(S,U,I)=$P(S,U,I)+YSDAS
"RTN","YTMBMD",45,0)
 Q
"RTN","YTMBMD",46,0)
HPA ;High Point Adjustment COPING
"RTN","YTMBMD",47,0)
 S N=0 F I=16:1:26 S:$P(S,U,I)>59 N=N+1
"RTN","YTMBMD",48,0)
 S YSDAS=$S(N>9:-10,N>7:-5,N>4:0,N>2:5,N>0:10,1:15)
"RTN","YTMBMD",49,0)
 F I=16:1:26 S $P(S,U,I)=$P(S,U,I)+YSDAS
"RTN","YTMBMD",50,0)
 Q
"RTN","YTMBMD",51,0)
HPA1 ;high point AA-EE, a-m
"RTN","YTMBMD",52,0)
 S N=0
"RTN","YTMBMD",53,0)
 F I=11,12,13,14,15,27,28,29,30,31,32,33,34,35,36,37,38,39 S:$P(S,U,I)>59 N=N+1
"RTN","YTMBMD",54,0)
 S YSDAS=$S(N>16:-15,N>14:-10,N>12:-5,N>7:0,N>5:5,N>2:10,1:15)
"RTN","YTMBMD",55,0)
 S YSDAS1=$S(N>12:0,N>7:5,N>5:10,N>2:15,1:20)
"RTN","YTMBMD",56,0)
 F I=11,12,13,14,15,27,28,29,30,31,32,33,34,35,36,37 S $P(S,U,I)=$P(S,U,I)+YSDAS
"RTN","YTMBMD",57,0)
 F I=38,39 S $P(S,U,I)=$P(S,U,I)+YSDAS1
"RTN","YTMBMD",58,0)
 Q
"RTN","YTMBMD",59,0)
REPT ;reports
"RTN","YTMBMD",60,0)
 S (YSTOUT,YSUOUT)=""
"RTN","YTMBMD",61,0)
 S X=$P(^YTT(601,YSTEST,"P"),U),A=$P(^("P"),U,2),B=$P(^("P"),U,3),L1=58-A\2,L2=L1+A+4 S:A<9 A=9
"RTN","YTMBMD",62,0)
 D DTA^YTREPT
"RTN","YTMBMD",63,0)
 W !,?(72-$L(X)\2),X,!
"RTN","YTMBMD",64,0)
 W !?50,$S(YSVFLAG:"*** Invalid Profile ***",1:"Valid Profile")
"RTN","YTMBMD",65,0)
 F I=2:1:10 D  D:IOST?1"C-".E&($Y>21) SCR^YTREPT Q:YSTOUT!YSUOUT
"RTN","YTMBMD",66,0)
 . W:I=2 !,"Response Patterns" ;ASF 1/30/04 ABOVE LINE ALSO
"RTN","YTMBMD",67,0)
 . W:I=5 !,"Negative Health Habits"
"RTN","YTMBMD",68,0)
 . W !,?4,$P(^YTT(601,YSTEST,"S",I,0),U,2),?25 D LIKELY
"RTN","YTMBMD",69,0)
 D:IOST?1"C-".E&($Y>21) SCR^YTREPT Q:YSTOUT!YSUOUT
"RTN","YTMBMD",70,0)
 F I=11:1:39 D  D:IOST?1"C-".E&($Y>21) SCR^YTREPT Q:YSTOUT!YSUOUT
"RTN","YTMBMD",71,0)
 . W:I=11 !,"Psychiatric Indications"
"RTN","YTMBMD",72,0)
 . W:I=16 !,"Coping Styles"
"RTN","YTMBMD",73,0)
 . W:I=27 !,"Stress Moderators"
"RTN","YTMBMD",74,0)
 . W:I=33 !,"Treatment Prognostics"
"RTN","YTMBMD",75,0)
 . W:I=38 !,"Management Guides"
"RTN","YTMBMD",76,0)
 . S YSSID=$P(^YTT(601,YSTEST,"S",I,0),U,2)
"RTN","YTMBMD",77,0)
 . W !,$P(YSSID," ")
"RTN","YTMBMD",78,0)
 . W ?5,$J($P(R,U,I),2),"  ",$S($P(S,U,I)'<0:$J($P(S,U,I),3),1:"  0")," "
"RTN","YTMBMD",79,0)
 . D CHART
"RTN","YTMBMD",80,0)
 . W ?52,$P(YSSID," ",2,99)
"RTN","YTMBMD",81,0)
 D NOTEWOR
"RTN","YTMBMD",82,0)
 Q
"RTN","YTMBMD",83,0)
LIKELY ;
"RTN","YTMBMD",84,0)
 N X
"RTN","YTMBMD",85,0)
 S X=$P(S,U,I)
"RTN","YTMBMD",86,0)
 W $S(X="L":"unlikely problem",X="M":"possible problem",X="H":"likely problem",1:"????")
"RTN","YTMBMD",87,0)
 Q
"RTN","YTMBMD",88,0)
CHART ;
"RTN","YTMBMD",89,0)
 N X
"RTN","YTMBMD",90,0)
 S X=$P(S,U,I)
"RTN","YTMBMD",91,0)
 W $E("***************************************************************",1,$J(X/3,0,0))
"RTN","YTMBMD",92,0)
 Q
"RTN","YTMBMD",93,0)
NOTEWOR ;note worthy responses
"RTN","YTMBMD",94,0)
 D RD
"RTN","YTMBMD",95,0)
 W !!?10,"*** Noteworthy Responses ***"
"RTN","YTMBMD",96,0)
 F I=1,14,28,66,6,117,131,157,3,20,41,62,5,10,103,116,143,49 D  D:IOST?1"C-".E&($Y>21) SCR^YTREPT Q:YSTOUT!YSUOUT
"RTN","YTMBMD",97,0)
 .W:I=1 !!?4,"Panic Susceptibility"
"RTN","YTMBMD",98,0)
 .W:I=6 !!?4,"Disorientation"
"RTN","YTMBMD",99,0)
 .W:I=3 !!?4,"Medical Anxiety"
"RTN","YTMBMD",100,0)
 .W:I=5 !!?4,"Adherence Problems"
"RTN","YTMBMD",101,0)
 .W:I=49 !!?4,"Suicidal Tendencies"
"RTN","YTMBMD",102,0)
 . W:$E(X,I)="T" !,$J(I,3,0),". ",^YTT(601,YSTEST,"Q",I,"T",1,0)
"RTN","YTMBMD",103,0)
 I (($E(X,49)="T")&($E(X,58)="T"))!(($E(X,161)="T")&($E(X,58)="T")) W !," 58. ",^YTT(601,YSTEST,"Q",58,"T",1,0)
"RTN","YTMBMD",104,0)
 I (($E(X,49)="T")&($E(X,161)="T"))!(($E(X,161)="T")&($E(X,58)="T")) W !,"161. ",^YTT(601,YSTEST,"Q",161,"T",1,0)
"VER")
8.0^22
**END**
**END**
