Released FH*5*41 SEQ #40
Extracted from mail message
**KIDS**:FH*5.0*41^

**INSTALL NAME**
FH*5.0*41
"BLD",4819,0)
FH*5.0*41^DIETETICS^0^3040419^y
"BLD",4819,4,0)
^9.64PA^^
"BLD",4819,"KRN",0)
^9.67PA^8989.52^19
"BLD",4819,"KRN",.4,0)
.4
"BLD",4819,"KRN",.401,0)
.401
"BLD",4819,"KRN",.402,0)
.402
"BLD",4819,"KRN",.403,0)
.403
"BLD",4819,"KRN",.5,0)
.5
"BLD",4819,"KRN",.84,0)
.84
"BLD",4819,"KRN",3.6,0)
3.6
"BLD",4819,"KRN",3.8,0)
3.8
"BLD",4819,"KRN",9.2,0)
9.2
"BLD",4819,"KRN",9.8,0)
9.8
"BLD",4819,"KRN",9.8,"NM",0)
^9.68A^5^5
"BLD",4819,"KRN",9.8,"NM",1,0)
FHASN^^0^B4746437
"BLD",4819,"KRN",9.8,"NM",2,0)
FHASM1^^0^B18667333
"BLD",4819,"KRN",9.8,"NM",3,0)
FHASP1^^0^B16828529
"BLD",4819,"KRN",9.8,"NM",4,0)
FHMASE^^0^B21014606
"BLD",4819,"KRN",9.8,"NM",5,0)
FHASE^^0^B19984975
"BLD",4819,"KRN",9.8,"NM","B","FHASE",5)

"BLD",4819,"KRN",9.8,"NM","B","FHASM1",2)

"BLD",4819,"KRN",9.8,"NM","B","FHASN",1)

"BLD",4819,"KRN",9.8,"NM","B","FHASP1",3)

"BLD",4819,"KRN",9.8,"NM","B","FHMASE",4)

"BLD",4819,"KRN",19,0)
19
"BLD",4819,"KRN",19.1,0)
19.1
"BLD",4819,"KRN",101,0)
101
"BLD",4819,"KRN",409.61,0)
409.61
"BLD",4819,"KRN",771,0)
771
"BLD",4819,"KRN",870,0)
870
"BLD",4819,"KRN",8989.51,0)
8989.51
"BLD",4819,"KRN",8989.52,0)
8989.52
"BLD",4819,"KRN",8994,0)
8994
"BLD",4819,"KRN","B",.4,.4)

"BLD",4819,"KRN","B",.401,.401)

"BLD",4819,"KRN","B",.402,.402)

"BLD",4819,"KRN","B",.403,.403)

"BLD",4819,"KRN","B",.5,.5)

"BLD",4819,"KRN","B",.84,.84)

"BLD",4819,"KRN","B",3.6,3.6)

"BLD",4819,"KRN","B",3.8,3.8)

"BLD",4819,"KRN","B",9.2,9.2)

"BLD",4819,"KRN","B",9.8,9.8)

"BLD",4819,"KRN","B",19,19)

"BLD",4819,"KRN","B",19.1,19.1)

"BLD",4819,"KRN","B",101,101)

"BLD",4819,"KRN","B",409.61,409.61)

"BLD",4819,"KRN","B",771,771)

"BLD",4819,"KRN","B",870,870)

"BLD",4819,"KRN","B",8989.51,8989.51)

"BLD",4819,"KRN","B",8989.52,8989.52)

"BLD",4819,"KRN","B",8994,8994)

"BLD",4819,"QUES",0)
^9.62^^
"BLD",4819,"REQB",0)
^9.611^2^2
"BLD",4819,"REQB",1,0)
FH*5.0*37^1
"BLD",4819,"REQB",2,0)
FH*5.0*40^1
"BLD",4819,"REQB","B","FH*5.0*37",1)

"BLD",4819,"REQB","B","FH*5.0*40",2)

"MBREQ")
0
"PKG",29,-1)
1^1
"PKG",29,0)
DIETETICS^FH^Dietetics System
"PKG",29,20,0)
^9.402P^^
"PKG",29,22,0)
^9.49I^1^1
"PKG",29,22,1,0)
5.0^2951011^2951130
"PKG",29,22,1,"PAH",1,0)
41^3040419
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
5
"RTN","FHASE")
0^5^B19984975
"RTN","FHASE",1,0)
FHASE ; HISC/REL/NCA - Dietetic Encounters ;7/22/96  13:17
"RTN","FHASE",2,0)
 ;;5.0;Dietetics;**5,7,39,40,41**;Jun 07, 1995
"RTN","FHASE",3,0)
EN1 ; Enter/Edit Encounter Types
"RTN","FHASE",4,0)
 S (DIC,DIE)="^FH(115.6,",DIC(0)="AEQLM",DIC("DR")=".01",DLAYGO=115.6 W ! D ^DIC K DIC,DLAYGO G KIL:"^"[X!$D(DTOUT),EN1:Y<1
"RTN","FHASE",5,0)
 S DA=+Y,DR=$S(DA=1:2,DA=2:"2;3",1:".01;1:4;10;5:6;I X'=""Y"" S Y=99;7;8;99") S:$D(^XUSEC("FHMGR",DUZ)) DIDEL=115.6 D ^DIE,KIL G EN1
"RTN","FHASE",6,0)
EN2 ; List Encounter Types
"RTN","FHASE",7,0)
 W ! S L=0,DIC="^FH(115.6,",FLDS=".01,2,3,4,10,5,6,7,8,99",BY=".01"
"RTN","FHASE",8,0)
 S (FR,TO)="",DHD="ENCOUNTER TYPES" D EN1^DIP,RSET Q
"RTN","FHASE",9,0)
EN3 ; Enter Dietetic Encounter
"RTN","FHASE",10,0)
 ; Check for multidivisional site
"RTN","FHASE",11,0)
 I $P($G(^FH(119.9,1,0)),U,20)'="N" D EN3^FHMASE Q
"RTN","FHASE",12,0)
 W ! K DIR S FHN=0,DIR(0)="YAO",DIR("A")="Enter a NEW Encounter (Y/N)? " D ^DIR G:$D(DIROUT)!($D(DIRUT)) KIL K DIR,DIROUT,DIRUT
"RTN","FHASE",13,0)
 I 'Y S FHN=1 G EN4
"RTN","FHASE",14,0)
EN30 ; Enter/Edit a Encounter
"RTN","FHASE",15,0)
 D EN31 G:Y<1 KIL G EN3
"RTN","FHASE",16,0)
EN31 ; Enter a Encounter
"RTN","FHASE",17,0)
 K %DT S FHN=0,%DT="AETPX",%DT("A")="DATE/TIME OF ENCOUNTER: ",%DT("B")="TODAY",%DT(0)="-NOW" W ! D ^%DT K %DT S:$D(DTOUT) Y=0 Q:Y<1  S DTE=Y
"RTN","FHASE",18,0)
 K DIC,DD,DO S DIC="^FHEN(",DIC(0)="L",DIC("DR")="1////^S X=DTE",DLAYGO=115.7
"RTN","FHASE",19,0)
A L +^FHEN(0) S DA=$P(^FHEN(0),"^",3)+1 I $D(^FHEN(DA)) S $P(^FHEN(0),"^",3)=DA L -^FHEN(0) G A
"RTN","FHASE",20,0)
 S (X,DINUM)=DA D FILE^DICN L -^FHEN(0) S ASE=+Y,FHX4="" K DIC,DLAYGO,DINUM
"RTN","FHASE",21,0)
 D EDIT Q
"RTN","FHASE",22,0)
EN4 ; Process Edit Encounter
"RTN","FHASE",23,0)
 W ! K ^TMP($J,"ECTR"),%DT S %DT="AEPX",%DT("A")="Enter Date of Encounter you want to edit: " D ^%DT K %DT S:$D(DTOUT) Y=0 G:Y<1 KIL S X1=Y,(TIM,X1)=X1-.0001,(EDT,X2)=Y\1+.3,CTR=0
"RTN","FHASE",24,0)
A0 W !! K DIR S DIR(0)="SO^C:CLINICIAN;P:PATIENT",DIR("A")="CHOOSE CLINICIAN or PATIENT" D ^DIR K DIR G:$D(DIROUT)!($D(DIRUT)) KIL I Y?1"P" D PAT G:'DFN KIL D PR G:Y<1 KIL D ASK G KIL:Y<1,EN4
"RTN","FHASE",25,0)
A1 K DIC S DIC="^VA(200,",DIC(0)="AEQM",DIC("A")="Select CLINICIAN: " W ! D ^DIC K DIC G KIL:"^"[X!$D(DTOUT),A1:Y<1 S NAM=+Y D CLIN,PR G:Y<1 KIL D ASK G KIL:Y<1,EN4
"RTN","FHASE",26,0)
PR W ! S K1="" F CTR=0:0 S CTR=$O(^TMP($J,"ECTR",CTR)) Q:CTR<1  S X=$G(^(CTR,0)),K1=CTR W !,CTR,"  " S Y=$P(X,"^",2) X ^DD("DD") W Y,"  ",$P(X,"^",3) K Y
"RTN","FHASE",27,0)
 I 'K1 W !?5,"No encounter on file on this date" S Y=0 Q
"RTN","FHASE",28,0)
 W !!,"Select number you want: " R X:DTIME I '$T!("^"[X) S Y=0 Q
"RTN","FHASE",29,0)
 I X'?1.N!(X<1)!(X>K1) W *7,!!,"Select only a number no greater than ",K1," or press ""^"" or a return to exit." G PR
"RTN","FHASE",30,0)
 S ASE=$P($G(^TMP($J,"ECTR",+X,0)),"^",1),FHX4=$G(^FHEN(ASE,0))
"RTN","FHASE",31,0)
 S FHCLK=$P($G(^TMP($J,"ECTR",+X,0)),"^",4) W !
"RTN","FHASE",32,0)
EDIT N FHX1 S DA=ASE K DIC,DIE S DIE="^FHEN(",DR="[FHASE]" D ^DIE K DIC,DIE,DR
"RTN","FHASE",33,0)
 S DA=ASE,X=^FHEN(DA,0)
"RTN","FHASE",34,0)
 I '$P(X,"^",3)!('$P(X,"^",4)) S DIK="^FHEN(" D ^DIK W *7,!,"<encounter deleted>" K DIK,DA
"RTN","FHASE",35,0)
 S Y=1 Q
"RTN","FHASE",36,0)
PAT ; Get Patient
"RTN","FHASE",37,0)
 S ALL=1 D ^FHDPA Q:'DFN
"RTN","FHASE",38,0)
 I $P($G(^DPT(DFN,.35)),"^",1) W *7,!!?5,"Patient has expired." G PAT
"RTN","FHASE",39,0)
 I '$D(^FHEN("AP",DFN)) W !!,"No Encounter on file for this patient." G PAT
"RTN","FHASE",40,0)
 F DTE=TIM:0 S DTE=$O(^FHEN("AP",DFN,DTE)) Q:DTE<1!(DTE>EDT)  F ASE=0:0 S ASE=$O(^FHEN("AP",DFN,DTE,ASE)) Q:ASE<1  S Y=$P($G(^FHEN(ASE,0)),"^",4) I Y>2 D
"RTN","FHASE",41,0)
 .S CTR=CTR+1,^TMP($J,"ECTR",CTR,0)=ASE_"^"_DTE_"^"_$P($G(^FH(115.6,+Y,0)),"^",1)_"^"_$P($G(^FHEN(ASE,0)),"^",13) Q
"RTN","FHASE",42,0)
 Q
"RTN","FHASE",43,0)
CLIN ; Get Clinician
"RTN","FHASE",44,0)
 S X1=$O(^FHEN("AT",X1)) Q:X1<1!(X1>X2)
"RTN","FHASE",45,0)
 S ASE=0
"RTN","FHASE",46,0)
R1 S ASE=$O(^FHEN("AT",X1,ASE)) G:ASE="" CLIN
"RTN","FHASE",47,0)
 S Y=$G(^FHEN(ASE,0)),E1=$P(Y,"^",3) I $P(Y,"^",4)>2,E1,E1=NAM S CTR=CTR+1,^TMP($J,"ECTR",CTR,0)=ASE_"^"_$P(Y,"^",2)_"^"_$P($G(^FH(115.6,+$P(Y,"^",4),0)),"^",1)_"^"_$P(Y,"^",13),DTE=$P(Y,"^",2)
"RTN","FHASE",48,0)
 G R1
"RTN","FHASE",49,0)
ASK R !!,"Is this correct? Y// ",YN:DTIME I '$T!(YN["^") S Y=0 Q
"RTN","FHASE",50,0)
 S:YN="" YN="Y" S X=YN D TR^FH S YN=X
"RTN","FHASE",51,0)
 I $P("YES",YN,1)'="",$P("NO",YN,1)'="" W *7," Answer YES or NO" G ASK
"RTN","FHASE",52,0)
 Q:YN?1"Y".E
"RTN","FHASE",53,0)
 I FHCLK'=DUZ W !!,"You can ONLY DELETE an encounter that is entered by you.",! G EDIT
"RTN","FHASE",54,0)
E5 R !,"Want to delete encounter? N// ",YN:DTIME I '$T!(YN["^") S Y=0 Q
"RTN","FHASE",55,0)
 S:YN="" YN="N" S X=YN D TR^FH S YN=X
"RTN","FHASE",56,0)
 I $P("YES",YN,1)'="",$P("NO",YN,1)'="" W *7," Answer YES or NO" G E5
"RTN","FHASE",57,0)
 Q:YN?1"N".E
"RTN","FHASE",58,0)
 S DIK="^FHEN(",DA=ASE D ^DIK W *7,!,"<encounter deleted>" K DA,DIK S Y=1 Q
"RTN","FHASE",59,0)
CNT S FHX3=FHX3+$P($G(^FHEN(ASE,"P",0)),"^",4)
"RTN","FHASE",60,0)
 S ST="" F LP=0:0 S LP=$O(^FHEN(ASE,"P",LP)) Q:LP<1  S ST=$G(^(LP,0)) I $P(ST,"^",3)'<1 S FHX3=FHX3+$P(ST,"^",3)
"RTN","FHASE",61,0)
 Q
"RTN","FHASE",62,0)
RSET K %ZIS S IOP="" D ^%ZIS
"RTN","FHASE",63,0)
KIL K ^TMP($J,"ECTR") G KILL^XUSCLEAN
"RTN","FHASM1")
0^2^B18667333
"RTN","FHASM1",1,0)
FHASM1 ; HISC/REL - Nutrition Assessment ;1/25/00  12:08
"RTN","FHASM1",2,0)
 ;;5.0;Dietetics;**2,4,22,24,40,41**;Oct 11, 1995
"RTN","FHASM1",3,0)
 W @IOF,!!?20,"N U T R I T I O N   A S S E S S M E N T",!! S X="T",%DT="X" D ^%DT S DT=+Y
"RTN","FHASM1",4,0)
F1 ; Select Patient
"RTN","FHASM1",5,0)
 S ALL=1 D ^FHDPA G PAT:X="*",KIL:'DFN S Y(0)=^DPT(DFN,0),NAM=$P(Y(0),U,1),SEX=$P(Y(0),U,2),AGE=$P(Y(0),U,3)
"RTN","FHASM1",6,0)
 I $P($G(^DPT(DFN,.35)),"^",1) W *7,!!?5,"  [ Patient has expired. ]" G KIL
"RTN","FHASM1",7,0)
 I AGE'="" S AGE=$E(DT,1,3)-$E(AGE,1,3)-($E(DT,4,7)<$E(AGE,4,7))
"RTN","FHASM1",8,0)
 I SEX=""!(AGE="") G P1
"RTN","FHASM1",9,0)
F2 S X="NOW",%DT="XT" D ^%DT S ADT=Y
"RTN","FHASM1",10,0)
F3 I DFN,$D(^FHPT(DFN,"N",9999999-ADT)) S ADT=$$FMADD^XLFDT(ADT,,,1) G F3
"RTN","FHASM1",11,0)
 S FHAP=$G(^FH(119.9,1,3)),FHU=$P(FHAP,"^",1)
"RTN","FHASM1",12,0)
 S (TSF,TSFP,SCA,SCAP,ACIR,ACIRP,CCIR,CCIRP,BFAMA,BFAMAP,BMI,BMIP,X1,X2)=""
"RTN","FHASM1",13,0)
 G:'DFN F4 S XX=$O(^FHPT(DFN,"N",0)) G:XX="" F4 S XX=$G(^(XX,0)),HGT=$P(XX,"^",4),HGP=$P(XX,"^",5)
"RTN","FHASM1",14,0)
 I HGP'="S" S X1=$S(HGT\12:HGT\12_"'",1:"")_$S(HGT#12:" "_(HGT#12)_"""",1:""),X2=+$J(HGT*2.54,0,0)_"CM",X1=$S(FHU'="M":X1,1:X2)
"RTN","FHASM1",15,0)
F4 ; If Multidivisional site Select Communications Office
"RTN","FHASM1",16,0)
 S FHCOMM="" I $P($G(^FH(119.9,1,0)),U,20)'="N" D  I FHCOMM="" Q
"RTN","FHASM1",17,0)
 .K DIC S DIC="^FH(119.73," S DIC(0)="AEMQ" D ^DIC
"RTN","FHASM1",18,0)
 .I Y=-1 Q
"RTN","FHASM1",19,0)
 .S FHCOMM=+Y
"RTN","FHASM1",20,0)
 ;
"RTN","FHASM1",21,0)
F4A S (KNEE,EXT)="" W !!,"Height: " W:X1'="" X1,"// " R X:DTIME G:'$T!(X["^") KIL I X="",X1'="" S Y0=$J(HGT,0,0),H1=Y0 G F5
"RTN","FHASM1",22,0)
 D TR,HGT I Y<1 D HGP G F4A
"RTN","FHASM1",23,0)
 S HGT=Y,H1=Y0,HGP=Y1
"RTN","FHASM1",24,0)
F5 R !!,"Weight: ",X:DTIME S:X="" X="?" G:'$T!(X["^") KIL
"RTN","FHASM1",25,0)
 S:X="a" X="A"
"RTN","FHASM1",26,0)
 I X="A",AGE>39 D A^FHASM2D G:Y<1 F5 S WGT=Y,WGP="A" G F6
"RTN","FHASM1",27,0)
 D WGT I Y<1 D WGP W:AGE>39 !,"You may enter an A to calculate weight anthropometrically." G F5
"RTN","FHASM1",28,0)
 S WGT=Y,WGP=Y1
"RTN","FHASM1",29,0)
F6 S %DT="AEP",%DT("A")="Date Weight Taken: ",%DT("B")="TODAY",%DT(0)="-T" W ! D ^%DT K %DT G KIL:X["^"!$D(DTOUT),F6:Y<1
"RTN","FHASM1",30,0)
 S DWGT=Y
"RTN","FHASM1",31,0)
F7 R !!,"Usual Weight: ",X:DTIME G:'$T!(X["^") KIL I X="" S UWGT="" G F8
"RTN","FHASM1",32,0)
 D WGT S UWGT=Y I Y<1 D WGP G F7
"RTN","FHASM1",33,0)
F8 K %DT,A1,K,X,Y G ^FHASM2
"RTN","FHASM1",34,0)
HGT ; Convert Height to inches
"RTN","FHASM1",35,0)
 S A1=+X I 'A1 S Y=-1 Q
"RTN","FHASM1",36,0)
 S X=$P(X,A1,2,99) S:$E(X,1)=" " X=$E(X,2,99) I "SMK"[$E(X,1) S Y=A1 S:FHU="M" Y=Y/2.54 G H1
"RTN","FHASM1",37,0)
 I """I"[$E(X,1) S Y=A1 G H1
"RTN","FHASM1",38,0)
 I $E(X,1)="C" S Y=A1/2.54 G H1
"RTN","FHASM1",39,0)
 I "'F"'[$E(X,1) S Y=-1 G H2
"RTN","FHASM1",40,0)
 S Y=A1*12 F K=1:1 Q:$E(X,K)?.N
"RTN","FHASM1",41,0)
 I $E(X,K,99)="" G H1
"RTN","FHASM1",42,0)
 S A1=+$E(X,K,99),X=$P(X,A1,2,99) S:$E(X,1)=" " X=$E(X,2,99)
"RTN","FHASM1",43,0)
 I """I"'[$E(X,1) S Y=-1 G H2
"RTN","FHASM1",44,0)
 S Y=Y+A1
"RTN","FHASM1",45,0)
H1 I X["K" D K^FHASM2D
"RTN","FHASM1",46,0)
H2 I Y<12!(Y>96) S Y=-1
"RTN","FHASM1",47,0)
 S:Y>0 Y0=+$J(Y,0,0),Y=+$J(Y,0,1) S Y1=$S(X["K":"K",X["S":"S",1:"") Q
"RTN","FHASM1",48,0)
HGP ; Height Help
"RTN","FHASM1",49,0)
 W !!,"Enter height as: 6' 2"" or 74"" or 74IN or 6FT 2 IN or 30CM"
"RTN","FHASM1",50,0)
 W !,"Add an S if height is stated rather than measured."
"RTN","FHASM1",51,0)
 W !,"Add a K if value is a Knee Height measurement."
"RTN","FHASM1",52,0)
 W !,"Height should be between 12"" and 96"" (8')." Q
"RTN","FHASM1",53,0)
WGT ; Convert Weight to lbs.
"RTN","FHASM1",54,0)
 D TR S A1=+X I 'A1 S Y=-1 Q
"RTN","FHASM1",55,0)
 S X=$P(X,A1,2,99) S:$E(X,1)=" " X=$E(X,2,99) I "SM"[$E(X,1) S Y=A1 S:FHU="M" Y=Y*2.2 G W1
"RTN","FHASM1",56,0)
 I $E(X,1)="O" S Y=A1/16 G W1
"RTN","FHASM1",57,0)
 I $E(X,1)="G" S Y=A1/1000*2.2 G W1
"RTN","FHASM1",58,0)
 I $E(X,1)="K" S Y=A1*2.2 G W1
"RTN","FHASM1",59,0)
 I "L#"'[$E(X,1) S Y=-1 G W1
"RTN","FHASM1",60,0)
 S Y=A1 F K=1:1 Q:$E(X,K)?.N
"RTN","FHASM1",61,0)
 I $E(X,K,99)="" G W1
"RTN","FHASM1",62,0)
 S A1=+$E(X,K,99),X=$P(X,A1,2,99) S:$E(X,1)=" " X=$E(X,2,99)
"RTN","FHASM1",63,0)
 I $E(X,1)'="O" S Y=-1 G W1
"RTN","FHASM1",64,0)
 S Y=A1/16+Y
"RTN","FHASM1",65,0)
W1 I Y<0!(Y>750) S Y=-1
"RTN","FHASM1",66,0)
 S:Y>0 Y0=+$J(Y,0,0),Y=+$J(Y,0,1) S Y1="" S:X["S" Y1="S" Q
"RTN","FHASM1",67,0)
WGP ; Weight help
"RTN","FHASM1",68,0)
 W !!,"Enter Weight as 150# or 150# 6OZ or 800G or 70KG"
"RTN","FHASM1",69,0)
 W !,"Add an S if weight is stated rather than measured."
"RTN","FHASM1",70,0)
 W !,"Enter an A to determine weight anthropometrically."
"RTN","FHASM1",71,0)
 W !,"Weight should be between 0 Lbs and 750 Lbs." Q
"RTN","FHASM1",72,0)
TR ; Translate Lower to Upper Case
"RTN","FHASM1",73,0)
 D TR^FH
"RTN","FHASM1",74,0)
 Q
"RTN","FHASM1",75,0)
KIL ; Final variable kill
"RTN","FHASM1",76,0)
 G KILL^XUSCLEAN
"RTN","FHASM1",77,0)
PAT S (DFN,SEX,AGE,PID)="" R !!,"Enter Patient's Name: ",NAM:DTIME G:'$T!(NAM["^") KIL
"RTN","FHASM1",78,0)
 I NAM["?"!(NAM'?.ANP)!(NAM="") W *7,!?5,"Enter Patient's Name to be printed on the report." G PAT
"RTN","FHASM1",79,0)
P1 I SEX="" R !,"Sex: ",SEX:DTIME S:SEX="" SEX="?" G:'$T!(SEX["^") KIL S X=SEX D TR S SEX=X I $P("FEMALE",SEX,1)'="",$P("MALE",SEX,1)'="" W *7,"  Enter M or F" S SEX="" G P1
"RTN","FHASM1",80,0)
 S SEX=$E(SEX,1)
"RTN","FHASM1",81,0)
P2 I AGE="" R !,"Age: ",AGE:DTIME S:AGE="" AGE="?" G:'$T!(AGE["^") KIL S X=AGE D TR S AGE=X
"RTN","FHASM1",82,0)
 S:AGE["M" AGE=+$J($P(AGE,"M",1)/12,0,2) I AGE'>0!(AGE>124) W !?5,"Enter Age Less Than 124 in Years or Months (followed by M) but Not Both" S AGE="" G P2
"RTN","FHASM1",83,0)
 G F2
"RTN","FHASN")
0^1^B4746437
"RTN","FHASN",1,0)
FHASN ; HISC/REL - Nutrition Status ;10/29/93  08:55
"RTN","FHASN",2,0)
 ;;5.0;Dietetics;**40,41**;Oct 11, 1995
"RTN","FHASN",3,0)
EN4 ; List Nutrition Statuses
"RTN","FHASN",4,0)
 W ! S L=0,DIC="^FH(115.4,",FLDS=".01,1",BY=".01"
"RTN","FHASN",5,0)
 S (FR,TO)="",DHD="NUTRITION STATUS" D EN1^DIP,RSET Q
"RTN","FHASN",6,0)
EN5 ; Enter Nutrition Status for Patient
"RTN","FHASN",7,0)
 S ALL=1 D ^FHDPA G:'DFN KIL
"RTN","FHASN",8,0)
 I $P($G(^DPT(DFN,.35)),"^",1) W *7,!!?5,"  [ Patient has expired. ]" G EN5
"RTN","FHASN",9,0)
 ; If Multidivisional site Select Communications Office
"RTN","FHASN",10,0)
 S FHCOMM="" I $P($G(^FH(119.9,1,0)),U,20)'="N" D  I FHCOMM="" Q
"RTN","FHASN",11,0)
 .W ! K DIC S DIC="^FH(119.73," S DIC(0)="AEMQ" D ^DIC
"RTN","FHASN",12,0)
 .I Y=-1 Q
"RTN","FHASN",13,0)
 .S FHCOMM=+Y
"RTN","FHASN",14,0)
 D DID^FHDPA,GET
"RTN","FHASN",15,0)
 K DIC S DIC="^FH(115.4,",DIC(0)="AEQM",DIC("S")="I $P(^(0),U,2)'=""""" S:Y'="" DIC("B")=Y W ! D ^DIC K DIC G KIL:"^"[X!$D(DTOUT),EN5:Y<1 I +Y'=OLD S S2="I" G C2
"RTN","FHASN",16,0)
C1 R !!,"Is this a re-screen (Y/N)? ",X:DTIME G KIL:'$T,EN5:X["^" S:X="" X="^" D TR^FH I $P("YES",X,1)'="",$P("NO",X,1)'="" W *7,!,"  Answer YES or NO" G C1
"RTN","FHASN",17,0)
 S S2=$S(X?1"Y".E:"F",1:"I")
"RTN","FHASN",18,0)
C2 S S1=+Y D NOW^%DTC S NOW=%
"RTN","FHASN",19,0)
 I '$D(^FHPT(DFN,0)) S ^(0)=DFN
"RTN","FHASN",20,0)
 I '$D(^FHPT(DFN,"S",0)) S ^(0)="^115.012D^^"
"RTN","FHASN",21,0)
 K DIC,DD,DO S DIC="^FHPT(DFN,""S"",",DIC(0)="L",DLAYGO=115,DA(1)=DFN,X=NOW,DINUM=9999999-NOW D FILE^DICN S ASE=+Y
"RTN","FHASN",22,0)
 S $P(^FHPT(DFN,"S",ASE,0),"^",2,3)=S1_"^"_DUZ S:FHWRD $P(^(0),"^",6)=FHWRD
"RTN","FHASN",23,0)
 S DTE=+$E(NOW,1,12),S3="Nutrition Status: "_$P(^FH(115.4,S1,0),"^",2),S1=2
"RTN","FHASN",24,0)
 D FIL^FHASE3 G EN5
"RTN","FHASN",25,0)
GET ; Get Nutrition Status for current admission
"RTN","FHASN",26,0)
 S Y="",OLD="",X5=$O(^FHPT(DFN,"S",0)) Q:X5=""  S X5=^(X5,0)
"RTN","FHASN",27,0)
 I WARD'="" Q:$P(X5,"^",1)<$P($G(^FHPT(DFN,"A",ADM,0)),"^",1)
"RTN","FHASN",28,0)
 S OLD=+$P(X5,"^",2),Y=$P($G(^FH(115.4,OLD,0)),"^",2) K X5 Q
"RTN","FHASN",29,0)
RSET K %ZIS S IOP="" D ^%ZIS K %ZIS,IOP
"RTN","FHASN",30,0)
KIL G KILL^XUSCLEAN
"RTN","FHASP1")
0^3^B16828529
"RTN","FHASP1",1,0)
FHASP1 ; HISC/REL/JH - Nutrition Profile (cont) ;5/2/01  10:14
"RTN","FHASP1",2,0)
 ;;5.0;Dietetics;**9,18,29,37,41**;Jun 07, 1995
"RTN","FHASP1",3,0)
 ;
"RTN","FHASP1",4,0)
 ;RVD, patch #41, 1/6/04 - Use Scheduling API #3859.  Returns (future)
"RTN","FHASP1",5,0)
 ;                         appointment information for a patient.
"RTN","FHASP1",6,0)
 ;                         D GETAPPT^SDAMA201(,,,,,,)
"RTN","FHASP1",7,0)
 ;
"RTN","FHASP1",8,0)
 S X1=DT,X2=-1095 D C^%DTC S DTE=X,N1=0 W !!?22,"Dietetic Encounters Last Three Years"
"RTN","FHASP1",9,0)
 F DTE=DTE:0 S DTE=$O(^FHEN("AP",DFN,DTE)) Q:DTE<1!(ANS="^")  F ASN=0:0 S ASN=$O(^FHEN("AP",DFN,DTE,ASN)) Q:ASN<1  D:$Y'<S1 HF^FHASP Q:ANS="^"  D LST
"RTN","FHASP1",10,0)
 Q:ANS="^"
"RTN","FHASP1",11,0)
 I 'N1 W !!?5,"No Encounters recorded last three years."
"RTN","FHASP1",12,0)
 S FADM=$O(^FHPT(DFN,"A",""),-1) S FADM=$S($G(ADM):$G(ADM),FADM:FADM,1:"") G:FADM="" F1
"RTN","FHASP1",13,0)
 D:$Y'<(S1-6) HF^FHASP Q:ANS="^"  W !!?28,$S($G(ADM):"Current",1:"Last")," Admission Monitors" S N1=0
"RTN","FHASP1",14,0)
 ; F NDT=0:0 S NDT=$O(^FHPT(DFN,"A",FADM,"MO","AC",NDT)) Q:NDT<1  F K=0:0 S K=$O(^FHPT(DFN,"A",FADM,"MO","AC",NDT,K)) Q:K<1  D MO
"RTN","FHASP1",15,0)
 S FHTTLM="",FHTTLM=$P($G(^FHPT(DFN,"A",FADM,"MO",0)),U,3)
"RTN","FHASP1",16,0)
 I FHTTLM="" W !,"No Monitors on file." G F1
"RTN","FHASP1",17,0)
 S FHMONS=$S(FHTTLM-FHNUM<0:0,1:FHTTLM-FHNUM)
"RTN","FHASP1",18,0)
 F NDT=FHMONS:0 S NDT=$O(^FHPT(DFN,"A",FADM,"MO",NDT)) Q:NDT<1!(ANS="^")  S K=NDT D MO
"RTN","FHASP1",19,0)
 Q:ANS="^"  I 'N1 W !,"No Monitors on file."
"RTN","FHASP1",20,0)
F1 D:$Y'<(S1-6) HF^FHASP Q:ANS="^"  W !!?32,"Food Preferences" D DISP
"RTN","FHASP1",21,0)
 W !!?27,"Future Clinic Appointments" S N1=0
"RTN","FHASP1",22,0)
 ;
"RTN","FHASP1",23,0)
 ;patch #41
"RTN","FHASP1",24,0)
 ;F NDT=NOW:0 S NDT=$O(^DPT(DFN,"S",NDT)) Q:NDT'>0  S Z=^(NDT,0) I "I"[$P(Z,"^",2) D CLIN Q:ANS="^"
"RTN","FHASP1",25,0)
 K ^TMP($J)
"RTN","FHASP1",26,0)
 S FHCNT=""
"RTN","FHASP1",27,0)
 D GETAPPT^SDAMA201(DFN,"1;2;12","R",DT,,.FHCNT,"")
"RTN","FHASP1",28,0)
 G:'$D(^TMP($J,"SDAMA201","GETAPPT")) NOAPP
"RTN","FHASP1",29,0)
 I $D(^TMP($J,"SDAMA201","GETAPPT")) S FHTMP=$NA(^TMP($J,"SDAMA201","GETAPPT"))
"RTN","FHASP1",30,0)
 I $D(@FHTMP@("ERROR")) D PRERR
"RTN","FHASP1",31,0)
 I $G(FHCNT) F FHI=0:0 S FHI=$O(@FHTMP@(FHI)) Q:FHI'>0  D CLIN I ANS="^" K ^TMP($J) Q
"RTN","FHASP1",32,0)
 K ^TMP($J)
"RTN","FHASP1",33,0)
 ;end changes in patch #41
"RTN","FHASP1",34,0)
 Q:ANS="^"
"RTN","FHASP1",35,0)
NOAPP I 'N1 W !!?5,"No scheduled appointments."
"RTN","FHASP1",36,0)
 D FOOT^FHASP Q
"RTN","FHASP1",37,0)
LST S X0=$G(^FHEN(ASN,0)) Q:$P(X0,"^",4)<3
"RTN","FHASP1",38,0)
 S X1=$G(^FHEN(ASN,"P",DFN,0))
"RTN","FHASP1",39,0)
 W:'N1 ! S N1=N1+1,DTP=$P(X0,"^",2) D DTP^FH W !?5,$E(DTP,1,9),"  " S Y=$P(X0,"^",4),Y=$P($G(^FH(115.6,+Y,0)),"^",1) W Y I $P(X0,"^",7)="F" W " (FU)"
"RTN","FHASP1",40,0)
 S Y=$P(X0,"^",9) W ", ",$S(Y="G":"Group",1:"Individual")
"RTN","FHASP1",41,0)
 S Y=$P(X0,"^",11) W:Y'="" !?10,Y S Y=$P(X1,"^",4) W:Y'="" !?10,Y Q
"RTN","FHASP1",42,0)
 ;patch #41
"RTN","FHASP1",43,0)
CLIN ;S SC=+$P(Z,"^",1),Y=$P($G(^SC(SC,0)),"^",1) Q:Y=""
"RTN","FHASP1",44,0)
 S NDT=@FHTMP@(FHI,1)
"RTN","FHASP1",45,0)
 S SC=$P(@FHTMP@(FHI,2),U,1)
"RTN","FHASP1",46,0)
 S Y=$P(@FHTMP@(FHI,2),U,2) Q:Y=""
"RTN","FHASP1",47,0)
 D:$Y'<S1 HF^FHASP Q:ANS="^"  W:'N1 ! S N1=N1+1,DTP=NDT D DTP^FH W !?5,DTP,?25,Y Q
"RTN","FHASP1",48,0)
 ;D:$Y'<S1 HF^FHASP Q:ANS="^"  W:'N1 ! S N1=N1+1,DTP=NDT D DTP^FH W !?5,DTP,?25,Y W:$P(Z,"^",11) " (Collateral)" Q
"RTN","FHASP1",49,0)
 ;end changes in patch #41
"RTN","FHASP1",50,0)
DISP ; Display Food Preferences
"RTN","FHASP1",51,0)
 W !?26,"Likes",?58,"DisLikes",!
"RTN","FHASP1",52,0)
 K P S P1=1 F K=0:0 S K=$O(^FHPT(DFN,"P",K)) Q:K<1  S X=^(K,0) D SP
"RTN","FHASP1",53,0)
 W ! S (M,MM)="" F  S M=$O(P(M)) Q:M=""  I $D(P(M)) W $P(M,"~",2) D  S MM=M
"RTN","FHASP1",54,0)
 .  S (P1,P2)=0 F  S:P1'="" P1=$O(P(M,"L",P1)) S X1=$S(P1>0:P(M,"L",P1),1:"") S:P2'="" P2=$O(P(M,"D",P2)) S X2=$S(P2>0:P(M,"D",P2),1:"") Q:P1=""&(P2="")  D P0 Q:ANS="^"  W:MM'=M !
"RTN","FHASP1",55,0)
 .  Q
"RTN","FHASP1",56,0)
 Q:ANS="^"
"RTN","FHASP1",57,0)
 I $O(P(""))="" W !,"No Food Preferences on file",!
"RTN","FHASP1",58,0)
 Q
"RTN","FHASP1",59,0)
P0 I X1'="" W ?12 S X=X1 D P1 S X1=X
"RTN","FHASP1",60,0)
 I X2'="" W ?46 S X=X2 D P1 S X2=X
"RTN","FHASP1",61,0)
 Q:X1=""&(X2="")  D:$Y'<S1 HF^FHASP Q:ANS="^"  W ! G P0
"RTN","FHASP1",62,0)
P1 I $L(X)<34 W X S X="" Q
"RTN","FHASP1",63,0)
 F KK=35:-1:1 Q:$E(X,KK-1,KK)=", "
"RTN","FHASP1",64,0)
 W $E(X,1,KK-2) S X=$E(X,KK+1,999) Q
"RTN","FHASP1",65,0)
SP Q:'$P(X,U)  S M1=$P(X,"^",2) S:M1="A" M1="BNE" S Z=$G(^FH(115.2,+X,0)) Q:$P(Z,U)=""!($P(Z,U,2)="")  S L1=$P(Z,"^",1),KK=$P(Z,"^",2),M="",DAS=$P(X,"^",4)
"RTN","FHASP1",66,0)
 I KK="L" S Q=$P(X,"^",3),L1=$S(Q:Q,1:1)_" "_L1
"RTN","FHASP1",67,0)
 I M1="BNE" S M="1~All Meals" G SP1
"RTN","FHASP1",68,0)
 S Z1=$E(M1,1) I Z1'="" S M=$S(Z1="B":"2~Break",Z1="N":"3~Noon",1:"4~Even")
"RTN","FHASP1",69,0)
 S Z1=$E(M1,2) I Z1'="" S M=M_","_$S(Z1="B":"Break",Z1="N":"Noon",1:"Even")
"RTN","FHASP1",70,0)
SP1 S:'$D(P(M,KK,P1)) P(M,KK,P1)="" I $L(P(M,KK,P1))+$L(L1)<255 S P(M,KK,P1)=P(M,KK,P1)_$S(P(M,KK,P1)="":"",1:", ")_L1_$S(DAS="Y":" (D)",1:"")
"RTN","FHASP1",71,0)
 E  S:'$D(P(M,KK,K)) P(M,KK,K)="" S P(M,KK,K)=L1_$S(DAS="Y":" (D)",1:"") S P1=K
"RTN","FHASP1",72,0)
 Q
"RTN","FHASP1",73,0)
MO ; Display Monitors
"RTN","FHASP1",74,0)
 S Y=$G(^FHPT(DFN,"A",FADM,"MO",K,0)) Q:Y=""  S N1=N1+1
"RTN","FHASP1",75,0)
 D:$Y'<S1 HF^FHASP Q:ANS="^"
"RTN","FHASP1",76,0)
 W !,$P(Y,"^",1) S DTP=$P(Y,"^",2) D DTP^FH W ", ",DTP
"RTN","FHASP1",77,0)
 S COM=$P(Y,"^",3) W:COM'="" !?5,"Action: ",COM Q
"RTN","FHASP1",78,0)
PRERR ;if Scheduling API returns an error, print error in the report.
"RTN","FHASP1",79,0)
 S FHER=$O(@FHTMP@("ERROR",0))
"RTN","FHASP1",80,0)
 W !!,"*** ERROR in Scheduling API ***"
"RTN","FHASP1",81,0)
 W !,"***",@FHTMP@("ERROR",FHER)," !!!",!
"RTN","FHASP1",82,0)
 Q
"RTN","FHMASE")
0^4^B21014606
"RTN","FHMASE",1,0)
FHMASE ; HISC/AAC - Multidivisional Dietetic Encounters ;10/14/03  13:17
"RTN","FHMASE",2,0)
 ;;5.0;Dietetics;**40,41**;Jun 07, 1995
"RTN","FHMASE",3,0)
EN1 ; Enter/Edit Encounter Types
"RTN","FHMASE",4,0)
 S (DIC,DIE)="^FH(115.6,",DIC(0)="AEQLM",DIC("DR")=".01",DLAYGO=115.6 W ! D ^DIC K DIC,DLAYGO G KIL:"^"[X!$D(DTOUT),EN1:Y<1
"RTN","FHMASE",5,0)
 S DA=+Y,DR=$S(DA=1:2,DA=2:"2;3",1:".01;1:4;10;5:6;I X'=""Y"" S Y=99;7;8;99") S:$D(^XUSEC("FHMGR",DUZ)) DIDEL=115.6 D ^DIE,KIL G EN1
"RTN","FHMASE",6,0)
 ;
"RTN","FHMASE",7,0)
EN2 ; List Encounter Types
"RTN","FHMASE",8,0)
 W ! S L=0,DIC="^FH(115.6,",FLDS=".01,2,3,4,10,5,6,7,8,99",BY=".01"
"RTN","FHMASE",9,0)
 S (FR,TO)="",DHD="ENCOUNTER TYPES" D EN1^DIP,RSET Q
"RTN","FHMASE",10,0)
 ;
"RTN","FHMASE",11,0)
EN3 ; Enter Dietetic Encounter
"RTN","FHMASE",12,0)
 W ! K DIR S FHN=0,DIR(0)="YAO",DIR("A")="Enter a NEW Encounter (Y/N)? " D ^DIR G:$D(DIROUT)!($D(DIRUT)) KIL K DIR,DIROUT,DIRUT
"RTN","FHMASE",13,0)
 I 'Y S FHN=1 G EN4
"RTN","FHMASE",14,0)
 ;
"RTN","FHMASE",15,0)
EN30 ; Enter/Edit a Encounter
"RTN","FHMASE",16,0)
 D EN31 G:Y<1 KIL G EN3
"RTN","FHMASE",17,0)
 ;
"RTN","FHMASE",18,0)
EN31 ; Enter a Encounter
"RTN","FHMASE",19,0)
 S FHN=0 K %DT S %DT="AETPX",%DT("A")="DATE/TIME OF ENCOUNTER: ",%DT("B")="TODAY",%DT(0)="-NOW" W ! D ^%DT K %DT S:$D(DTOUT) Y=0 Q:Y<1  S DTE=Y
"RTN","FHMASE",20,0)
 K DIC,DD,DO S DIC="^FHEN(",DIC(0)="L",DIC("DR")="1////^S X=DTE",DLAYGO=115.7
"RTN","FHMASE",21,0)
A L +^FHEN(0) S DA=$P(^FHEN(0),"^",3)+1 I $D(^FHEN(DA)) S $P(^FHEN(0),"^",3)=DA L -^FHEN(0) G A
"RTN","FHMASE",22,0)
 S (X,DINUM)=DA D FILE^DICN L -^FHEN(0) S ASE=+Y,FHX4="" K DIC,DLAYGO,DINUM
"RTN","FHMASE",23,0)
 D EDIT Q
"RTN","FHMASE",24,0)
 ;
"RTN","FHMASE",25,0)
EN4 ; Process Edit Encounter
"RTN","FHMASE",26,0)
 ;
"RTN","FHMASE",27,0)
 W ! K ^TMP($J,"ECTR"),%DT S %DT="AEPX",%DT("A")="Enter Date of Encounter you want to edit: " D ^%DT K %DT S:$D(DTOUT) Y=0 G:Y<1 KIL S X1=Y,(TIM,X1)=X1-.0001,(EDT,X2)=Y\1+.3,CTR=0
"RTN","FHMASE",28,0)
A0 W !! K DIR S DIR(0)="SO^C:CLINICIAN;P:PATIENT",DIR("A")="CHOOSE CLINICIAN or PATIENT" D ^DIR K DIR G:$D(DIROUT)!($D(DIRUT)) KIL I Y?1"P" D PAT G:'DFN KIL D PR G:Y<1 KIL D ASK G KIL:Y<1,EN4
"RTN","FHMASE",29,0)
A1 K DIC S DIC="^VA(200,",DIC(0)="AEQM",DIC("A")="Select CLINICIAN: " W ! D ^DIC K DIC G KIL:"^"[X!$D(DTOUT),A1:Y<1 S NAM=+Y D CLIN,PR G:Y<1 KIL D ASK G KIL:Y<1,EN4
"RTN","FHMASE",30,0)
PR W ! S K1="" F CTR=0:0 S CTR=$O(^TMP($J,"ECTR",CTR)) Q:CTR<1  S X=$G(^(CTR,0)),K1=CTR W !,CTR,"  " S Y=$P(X,"^",2) X ^DD("DD") W Y,"  ",$P(X,"^",3) K Y
"RTN","FHMASE",31,0)
 I 'K1 W !?5,"No encounter on file on this date" S Y=0 Q
"RTN","FHMASE",32,0)
 W !!,"Select number you want: " R X:DTIME I '$T!("^"[X) S Y=0 Q
"RTN","FHMASE",33,0)
 I X'?1.N!(X<1)!(X>K1) W *7,!!,"Select only a number no greater than ",K1," or press ""^"" or a return to exit." G PR
"RTN","FHMASE",34,0)
 S ASE=$P($G(^TMP($J,"ECTR",+X,0)),"^",1),FHX4=$G(^FHEN(ASE,0))
"RTN","FHMASE",35,0)
 S FHCLK=$P($G(^TMP($J,"ECTR",+X,0)),"^",4) W !
"RTN","FHMASE",36,0)
 ;
"RTN","FHMASE",37,0)
EDIT N FHX1 S DA=ASE K DIC,DIE S DIE="^FHEN(",DR="[FHMASE]" D ^DIE K DIC,DIE,DR
"RTN","FHMASE",38,0)
 S DA=ASE,X=^FHEN(DA,0)
"RTN","FHMASE",39,0)
 I '$P(X,"^",3)!('$P(X,"^",4)) S DIK="^FHEN(" D ^DIK W *7,!,"<encounter deleted>" K DIK,DA
"RTN","FHMASE",40,0)
 S Y=1 Q
"RTN","FHMASE",41,0)
 ;
"RTN","FHMASE",42,0)
PAT ; Get Patient
"RTN","FHMASE",43,0)
 S ALL=1 D ^FHDPA Q:'DFN
"RTN","FHMASE",44,0)
 I $P($G(^DPT(DFN,.35)),"^",1) W *7,!!?5,"Patient has expired." G PAT
"RTN","FHMASE",45,0)
 I '$D(^FHEN("AP",DFN)) W !!,"No Encounter on file for this patient." G PAT
"RTN","FHMASE",46,0)
 F DTE=TIM:0 S DTE=$O(^FHEN("AP",DFN,DTE)) Q:DTE<1!(DTE>EDT)  F ASE=0:0 S ASE=$O(^FHEN("AP",DFN,DTE,ASE)) Q:ASE<1  S Y=$P($G(^FHEN(ASE,0)),"^",4) I Y>2 D
"RTN","FHMASE",47,0)
 .S CTR=CTR+1,^TMP($J,"ECTR",CTR,0)=ASE_"^"_DTE_"^"_$P($G(^FH(115.6,+Y,0)),"^",1)_"^"_$P($G(^FHEN(ASE,0)),"^",13) Q
"RTN","FHMASE",48,0)
 Q
"RTN","FHMASE",49,0)
CLIN ; Get Clinician
"RTN","FHMASE",50,0)
 S X1=$O(^FHEN("AT",X1)) Q:X1<1!(X1>X2)
"RTN","FHMASE",51,0)
 S ASE=0
"RTN","FHMASE",52,0)
 ;
"RTN","FHMASE",53,0)
R1 S ASE=$O(^FHEN("AT",X1,ASE)) G:ASE="" CLIN
"RTN","FHMASE",54,0)
 S Y=$G(^FHEN(ASE,0)),E1=$P(Y,"^",3) I $P(Y,"^",4)>2,E1,E1=NAM S CTR=CTR+1,^TMP($J,"ECTR",CTR,0)=ASE_"^"_$P(Y,"^",2)_"^"_$P($G(^FH(115.6,+$P(Y,"^",4),0)),"^",1)_"^"_$P(Y,"^",13),DTE=$P(Y,"^",2)
"RTN","FHMASE",55,0)
 G R1
"RTN","FHMASE",56,0)
 ;
"RTN","FHMASE",57,0)
ASK R !!,"Is this correct? Y// ",YN:DTIME I '$T!(YN["^") S Y=0 Q
"RTN","FHMASE",58,0)
 S:YN="" YN="Y" S X=YN D TR^FH S YN=X
"RTN","FHMASE",59,0)
 I $P("YES",YN,1)'="",$P("NO",YN,1)'="" W *7," Answer YES or NO" G ASK
"RTN","FHMASE",60,0)
 Q:YN?1"Y".E
"RTN","FHMASE",61,0)
 I FHCLK'=DUZ W !!,"You can ONLY DELETE an encounter that is entered by you.",! G EDIT
"RTN","FHMASE",62,0)
 ;
"RTN","FHMASE",63,0)
E5 R !,"Want to delete encounter? N// ",YN:DTIME I '$T!(YN["^") S Y=0 Q
"RTN","FHMASE",64,0)
 S:YN="" YN="N" S X=YN D TR^FH S YN=X
"RTN","FHMASE",65,0)
 I $P("YES",YN,1)'="",$P("NO",YN,1)'="" W *7," Answer YES or NO" G E5
"RTN","FHMASE",66,0)
 Q:YN?1"N".E
"RTN","FHMASE",67,0)
 S DIK="^FHEN(",DA=ASE D ^DIK W *7,!,"<encounter deleted>" K DA,DIK S Y=1 Q
"RTN","FHMASE",68,0)
 ;
"RTN","FHMASE",69,0)
CNT S FHX3=FHX3+$P($G(^FHEN(ASE,"P",0)),"^",4)
"RTN","FHMASE",70,0)
 S ST="" F LP=0:0 S LP=$O(^FHEN(ASE,"P",LP)) Q:LP<1  S ST=$G(^(LP,0)) I $P(ST,"^",3)'<1 S FHX3=FHX3+$P(ST,"^",3)
"RTN","FHMASE",71,0)
 Q
"RTN","FHMASE",72,0)
 ;
"RTN","FHMASE",73,0)
RSET K %ZIS S IOP="" D ^%ZIS
"RTN","FHMASE",74,0)
 ;
"RTN","FHMASE",75,0)
KIL K ^TMP($J,"ECTR") G KILL^XUSCLEAN
"RTN","FHMASE",76,0)
 ;
"VER")
8.0^22
**END**
**END**
