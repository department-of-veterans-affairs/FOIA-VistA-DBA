Released PRC*5.1*72 SEQ #61
Extracted from mail message
**KIDS**:PRC*5.1*72^

**INSTALL NAME**
PRC*5.1*72
"BLD",3578,0)
PRC*5.1*72^IFCAP^0^3031031^y
"BLD",3578,1,0)
^^1^1^3031031^
"BLD",3578,1,1,0)
CHANGING OVERLAP DAYS AT END OF ACCOUNTING MONTH TO ZERO.
"BLD",3578,4,0)
^9.64PA^^
"BLD",3578,"ABPKG")
n
"BLD",3578,"KRN",0)
^9.67PA^8989.52^19
"BLD",3578,"KRN",.4,0)
.4
"BLD",3578,"KRN",.401,0)
.401
"BLD",3578,"KRN",.402,0)
.402
"BLD",3578,"KRN",.403,0)
.403
"BLD",3578,"KRN",.5,0)
.5
"BLD",3578,"KRN",.84,0)
.84
"BLD",3578,"KRN",3.6,0)
3.6
"BLD",3578,"KRN",3.8,0)
3.8
"BLD",3578,"KRN",9.2,0)
9.2
"BLD",3578,"KRN",9.8,0)
9.8
"BLD",3578,"KRN",9.8,"NM",0)
^9.68A^3^3
"BLD",3578,"KRN",9.8,"NM",1,0)
PRCB1B^^0^B9322316
"BLD",3578,"KRN",9.8,"NM",2,0)
PRCB1E^^0^B15607063
"BLD",3578,"KRN",9.8,"NM",3,0)
PRCB1F^^0^B35008607
"BLD",3578,"KRN",9.8,"NM","B","PRCB1B",1)

"BLD",3578,"KRN",9.8,"NM","B","PRCB1E",2)

"BLD",3578,"KRN",9.8,"NM","B","PRCB1F",3)

"BLD",3578,"KRN",19,0)
19
"BLD",3578,"KRN",19.1,0)
19.1
"BLD",3578,"KRN",101,0)
101
"BLD",3578,"KRN",409.61,0)
409.61
"BLD",3578,"KRN",771,0)
771
"BLD",3578,"KRN",870,0)
870
"BLD",3578,"KRN",8989.51,0)
8989.51
"BLD",3578,"KRN",8989.52,0)
8989.52
"BLD",3578,"KRN",8994,0)
8994
"BLD",3578,"KRN","B",.4,.4)

"BLD",3578,"KRN","B",.401,.401)

"BLD",3578,"KRN","B",.402,.402)

"BLD",3578,"KRN","B",.403,.403)

"BLD",3578,"KRN","B",.5,.5)

"BLD",3578,"KRN","B",.84,.84)

"BLD",3578,"KRN","B",3.6,3.6)

"BLD",3578,"KRN","B",3.8,3.8)

"BLD",3578,"KRN","B",9.2,9.2)

"BLD",3578,"KRN","B",9.8,9.8)

"BLD",3578,"KRN","B",19,19)

"BLD",3578,"KRN","B",19.1,19.1)

"BLD",3578,"KRN","B",101,101)

"BLD",3578,"KRN","B",409.61,409.61)

"BLD",3578,"KRN","B",771,771)

"BLD",3578,"KRN","B",870,870)

"BLD",3578,"KRN","B",8989.51,8989.51)

"BLD",3578,"KRN","B",8989.52,8989.52)

"BLD",3578,"KRN","B",8994,8994)

"BLD",3578,"QUES",0)
^9.62^^
"BLD",3578,"REQB",0)
^9.611^1^1
"BLD",3578,"REQB",1,0)
PRC*5.1*64^1
"BLD",3578,"REQB","B","PRC*5.1*64",1)

"MBREQ")
0
"PKG",455,-1)
1^1
"PKG",455,0)
IFCAP^PRC^IFCAP System Files
"PKG",455,20,0)
^9.402P^^
"PKG",455,22,0)
^9.49I^1^1
"PKG",455,22,1,0)
5.1^3001012^3001019^68
"PKG",455,22,1,"PAH",1,0)
72^3031031
"PKG",455,22,1,"PAH",1,1,0)
^^1^1^3031031
"PKG",455,22,1,"PAH",1,1,1,0)
CHANGING OVERLAP DAYS AT END OF ACCOUNTING MONTH TO ZERO.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
3
"RTN","PRCB1B")
0^1^B9322316
"RTN","PRCB1B",1,0)
PRCB1B ;WISC/PLT-Rollover fund control point balance ; 7/6/98 1000
"RTN","PRCB1B",2,0)
V ;;5.1;IFCAP;**64,72**;Oct 20, 2000
"RTN","PRCB1B",3,0)
 ;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","PRCB1B",4,0)
 QUIT  ;invalid entry
"RTN","PRCB1B",5,0)
 ;
"RTN","PRCB1B",6,0)
EN ;rollover fcp balance
"RTN","PRCB1B",7,0)
 N PRCA,PRCB,PRCQCD,PRCOPT,PRCRI,PRCDI,A,B,PRCDES
"RTN","PRCB1B",8,0)
 S PRCQCD=1
"RTN","PRCB1B",9,0)
 S PRCA=$$DATE^PRC0C("T","E")
"RTN","PRCB1B",10,0)
 S PRCA=$$QTRDATE^PRC0D(PRCA-($P(PRCA,"^",2)=1),$E(4123,$P(PRCA,"^",2)))
"RTN","PRCB1B",11,0)
Q1 S PRC("FY")=$E(PRCA,3,4),PRC("QTR")=$P(PRCA,"^",2)
"RTN","PRCB1B",12,0)
 S PRCF("X")="ABSFQ" D ^PRCFSITE G:'% EXIT
"RTN","PRCB1B",13,0)
 ;check station rollover
"RTN","PRCB1B",14,0)
 I $$NP^PRC0B("^PRC(420,"_+PRC("SITE")_",",0,8)=2 D  G EXIT
"RTN","PRCB1B",15,0)
 . D EN^DDIOL("The rollover 'Transfer Funds to Another FCP' is not allowed for this station.")
"RTN","PRCB1B",16,0)
 . QUIT
"RTN","PRCB1B",17,0)
 S PRCC=$$QTRDATE^PRC0D(PRC("FY"),PRC("QTR"))
"RTN","PRCB1B",18,0)
 S C=$P(PRCC,"^",8),C=$$DATE^PRC0C(C+100,"H"),C=$$QTRDATE^PRC0D(+C,$P(C,"^",2))
"RTN","PRCB1B",19,0)
 S B="" F A=$P(C,"^",8):1 S:A-3#7'=6&(A-3#7) B=B+1 Q:B=PRCQCD
"RTN","PRCB1B",20,0)
 S PRCB=$$DATE^PRC0C(A-1,"H") ;qtr closed date
"RTN","PRCB1B",21,0)
 I $H'>$P(PRCB,"^",8) D EN^DDIOL("Please run this entered year/quarter after "_$P(PRCB,"^",4)_"/"_$P(PRCB,"^",5)_"/"_$P(PRCB,"^",3)) G Q1
"RTN","PRCB1B",22,0)
Q2 S B="O^1:Single Year Appropriation Fund Control Points;2:Multiple Year Appropriation Fund Control Points"
"RTN","PRCB1B",23,0)
 K X,Y S Y(1)="^W ""Enter an option number 1 to 2."""
"RTN","PRCB1B",24,0)
 D SC^PRC0A(.X,.Y,"Select Number",B,"")
"RTN","PRCB1B",25,0)
 S A=Y K X,Y
"RTN","PRCB1B",26,0)
 G Q1:A=""!(A["^")
"RTN","PRCB1B",27,0)
 S PRCOPT=+A
"RTN","PRCB1B",28,0)
Q3 D FT^PRC0A(.X,.Y,"Description","O^1:60","")
"RTN","PRCB1B",29,0)
 G:X["^"!(X="") Q2
"RTN","PRCB1B",30,0)
 S PRCDES=X
"RTN","PRCB1B",31,0)
 I PRCOPT=1 D SYFCP G Q1
"RTN","PRCB1B",32,0)
Q4 F  D EN^DDIOL(" ") D  Q:PRCQT=1
"RTN","PRCB1B",33,0)
 . S PRCDD=420.01,PRCQT=""
"RTN","PRCB1B",34,0)
 . S X("S")="I $P(^(0),""^"",20)=1,'$P(^(0),""^"",19),$P(^(0),""^"",21),$$APP^PRC0C(PRC(""SITE""),PRC(""FY""),+Y)[""_/_"",Y-9999"
"RTN","PRCB1B",35,0)
 . S PRCRI(420)=+PRC("SITE")
"RTN","PRCB1B",36,0)
 . D LKUP^PRCB1B QUIT:PRCQT
"RTN","PRCB1B",37,0)
 . I '$$BBFY^PRCSUT(PRC("SITE"),PRC("FY"),PRCRI(420.01)) D EN^DDIOL("  Beginning budget year required") QUIT
"RTN","PRCB1B",38,0)
 . D MYFCP
"RTN","PRCB1B",39,0)
 . QUIT
"RTN","PRCB1B",40,0)
EXIT QUIT
"RTN","PRCB1B",41,0)
 ;
"RTN","PRCB1B",42,0)
LKUP ;lookup fcp
"RTN","PRCB1B",43,0)
 N DA
"RTN","PRCB1B",44,0)
 S DA=""
"RTN","PRCB1B",45,0)
 S PRCDI="420;^PRC(420,;"_PRCRI(420)_"~420.01;^PRC(420,"_PRCRI(420)_",1,"
"RTN","PRCB1B",46,0)
 D LOOKUP^PRC0B(.X,.Y,PRCDI,"AEMOQS","Select Multiple Year Fund Control Point: ")
"RTN","PRCB1B",47,0)
 I Y<0!(X="") S PRCQT=1 K X QUIT
"RTN","PRCB1B",48,0)
 K X S PRCRI(PRCDD)=+Y
"RTN","PRCB1B",49,0)
 S PRCDI="420;^PRC(420,;"_PRCRI(420)_"~420.01;^PRC(420,"_PRCRI(420)_",1,;$"_PRCRI(420.01)
"RTN","PRCB1B",50,0)
 QUIT
"RTN","PRCB1B",51,0)
 ;
"RTN","PRCB1B",52,0)
SYFCP ;single year fund control point
"RTN","PRCB1B",53,0)
 S ZTDES="ROLLOVER FOR SINGLE YEAR FUND CONTROL POINT"
"RTN","PRCB1B",54,0)
 S ZTRTN="TMEN^PRCB1B1" F A="PRC*","PRCC","DUZ*" S ZTSAVE(A)=""
"RTN","PRCB1B",55,0)
 D ^PRCFQ
"RTN","PRCB1B",56,0)
 QUIT
"RTN","PRCB1B",57,0)
 ;
"RTN","PRCB1B",58,0)
 ;
"RTN","PRCB1B",59,0)
MYFCP ;
"RTN","PRCB1B",60,0)
 S PRC("CP")=PRCRI(420.01)
"RTN","PRCB1B",61,0)
 S PRCD=$G(^PRC(420,+PRC("SITE"),1,+PRC("CP"),0)) I PRCD]"",$P($G(^(5)),"^",7)<$P(PRCC,"^",7) D 
"RTN","PRCB1B",62,0)
 . D FCPTRF^PRCB1B1
"RTN","PRCB1B",63,0)
 . QUIT
"RTN","PRCB1B",64,0)
 QUIT
"RTN","PRCB1B",65,0)
 ;
"RTN","PRCB1E")
0^2^B15607063
"RTN","PRCB1E",1,0)
PRCB1E ;WISC/PLT-QUARTERLY CARRY FORWARD ; 03/01/96  1:27 PM
"RTN","PRCB1E",2,0)
V ;;5.1;IFCAP;**64,72**;Oct 20, 2000
"RTN","PRCB1E",3,0)
 ;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","PRCB1E",4,0)
 QUIT  ;invalid entry
"RTN","PRCB1E",5,0)
 ;
"RTN","PRCB1E",6,0)
EN ;quarterly carry forward
"RTN","PRCB1E",7,0)
 N PRCA,PRCB,PRCQCD,PRCOPT,PRCRI,PRCDI,PRCDUZ,PRC,PRCDES
"RTN","PRCB1E",8,0)
 N A,B,C
"RTN","PRCB1E",9,0)
 S PRCQCD=1 ;over lapping days
"RTN","PRCB1E",10,0)
Q1 ;station
"RTN","PRCB1E",11,0)
 S PRCF("X")="AS" D ^PRCFSITE G:'% EXIT
"RTN","PRCB1E",12,0)
 S PRCRI(420)=+PRC("SITE")
"RTN","PRCB1E",13,0)
Q2 S B="O^1:Carry forward Outstanding Requests;2:Carry forward balances for all control points;3:Carry forward balances for a single control point"
"RTN","PRCB1E",14,0)
 K X,Y S Y(1)="^W ""Enter an option number 1 to 3."""
"RTN","PRCB1E",15,0)
 D SC^PRC0A(.X,.Y,"Select Number",B,"")
"RTN","PRCB1E",16,0)
 S A=Y K X,Y
"RTN","PRCB1E",17,0)
 G EXIT:A=""!(A["^")
"RTN","PRCB1E",18,0)
 S PRCOPT=+A
"RTN","PRCB1E",19,0)
 I PRCOPT=1 G Q4
"RTN","PRCB1E",20,0)
 I "12"[PRCOPT G Q4
"RTN","PRCB1E",21,0)
Q3 ;select control point
"RTN","PRCB1E",22,0)
 S PRCDI="420;^PRC(420,;"_PRC("SITE")
"RTN","PRCB1E",23,0)
 S $P(PRCDI,"~",2)="420.01;"_$P($P(PRCDI,"~"),";",2)_PRCRI(420)_",1,;"
"RTN","PRCB1E",24,0)
 S X("S")="I ^(0)-9999"
"RTN","PRCB1E",25,0)
 D LOOKUP^PRC0B(.X,.Y,PRCDI,"AEOQS","Select Fund Control Point: ")
"RTN","PRCB1E",26,0)
 I Y<0!(X="") S PRCQT="^" G Q2
"RTN","PRCB1E",27,0)
 K X S PRCRI(420.01)=+Y,PRC("CP")=$P($P(Y,"^")," ")
"RTN","PRCB1E",28,0)
Q4 ;fiscal year - quarter
"RTN","PRCB1E",29,0)
 S A=$P($G(^PRC(420,PRC("SITE"),0)),"^",9),A=$$DATE^PRC0C(A,"I")
"RTN","PRCB1E",30,0)
 S PRCA=$P(A,"^")_"-"_$P(A,"^",2)_"^"_$P(A,"^",7)_"^"_$P(A,"^",8)
"RTN","PRCB1E",31,0)
 S A=$$DATE^PRC0C($P(PRCA,"^",3)+100,"H"),A=$$QTRDATE^PRC0D(+A,$P(A,"^",2))
"RTN","PRCB1E",32,0)
 S B="" F C=$P(A,"^",8):1 S:C-3#7'=6&(C-3#7) B=B+1 Q:B=PRCQCD
"RTN","PRCB1E",33,0)
 S $P(PRCA,"^",4,5)=$P($$DATE^PRC0C(C-1,"H"),"^",7,8)
"RTN","PRCB1E",34,0)
 D EN^DDIOL(" "),EN^DDIOL("The oldest OPEN quarter in file is "_$P(PRCA,"^",1)_".")
"RTN","PRCB1E",35,0)
 S E="O^4:6^K:X'?2N.1""-"".1N&(X'?4N.1""-"".1N)!($P(X,""-"",2)<1)!($P(X,""-"",2)>4) X",Y(1)="Enter a 2 or 4 digit year followed by a '-' and quarter #, like 88-3 or 1988-3"
"RTN","PRCB1E",36,0)
 D FT^PRC0A(.X,.Y,"For Budget Fiscal Year - Quarter (YY-Q)",E,"")
"RTN","PRCB1E",37,0)
 G:X["^"!(X="")!(Y'?2.4N.1"-".1N) Q2
"RTN","PRCB1E",38,0)
 S $P(Y,"-")=+$$YEAR^PRC0C($P(Y,"-"))
"RTN","PRCB1E",39,0)
 I "1"[PRCOPT,Y]$P(PRCA,"^")!(Y=$P(PRCA,"^")&($H-1<$P(PRCA,"^",5))) S A="You must close quarter "_$P(PRCA,"^")_" first after "_$E($P(PRCA,"^",4),4,5)_"/"_$E($P(PRCA,"^",4),6,7)_"/"_$E($P(PRCA,"^",4),2,3) D EN^DDIOL(A) G Q4
"RTN","PRCB1E",40,0)
 I "23"[PRCOPT,Y]$P(PRCA,"^")!(Y=$P(PRCA,"^")) D EN^DDIOL("You may only rerun closed quarters. That is any quarter before "_$P(PRCA,"^")) G Q4
"RTN","PRCB1E",41,0)
 I "1996-1"]Y D EN^DDIOL("Carry forward can not be run for any quarters before '96-1'.") G Q4
"RTN","PRCB1E",42,0)
 S $P(PRCOPT,"^",2)=Y,$P(PRCOPT,"^",3)=PRCRI(420),$P(PRCOPT,"^",4)=$G(PRCRI(420.01))
"RTN","PRCB1E",43,0)
 I $P(PRCOPT,"^",2)["-4",$P(^PRC(411,PRC("SITE"),0),"^",25)'="Y" D EN^DDIOL("The outstanding requests are not carried forward to the new fiscal year.")
"RTN","PRCB1E",44,0)
Q5 D YN^PRC0A(.X,.Y,"Ready to Run","O","NO")
"RTN","PRCB1E",45,0)
 I X["^"!(X="")!'Y S PRCOPT=$P(PRCOPT,"^") G Q4
"RTN","PRCB1E",46,0)
 D CF
"RTN","PRCB1E",47,0)
EXIT QUIT
"RTN","PRCB1E",48,0)
 ;
"RTN","PRCB1E",49,0)
 ;
"RTN","PRCB1E",50,0)
CF ;start carry forward
"RTN","PRCB1E",51,0)
 N PRCDUZ
"RTN","PRCB1E",52,0)
 S PRCDUZ=DUZ
"RTN","PRCB1E",53,0)
 I +PRCOPT=1 S ZTDESC="IFCAP Carry Forward Outstanding Requests from Qtr "_$E($P(PRCOPT,"^",2),3,999)
"RTN","PRCB1E",54,0)
 I +PRCOPT=2 S ZTDESC="IFCAP Carry Forward Balances for All CP'S from Qtr "_$E($P(PRCOPT,"^",2),3,999)
"RTN","PRCB1E",55,0)
 I +PRCOPT=3 S ZTDESC="IFCAP Carry Forward Balances for a Single CP from Qtr "_$E($P(PRCOPT,"^",2),3,999)
"RTN","PRCB1E",56,0)
 S PRCDES=ZTDESC
"RTN","PRCB1E",57,0)
 S ZTRTN="TMEN^PRCB1E1" F A="PRCOPT","PRCDUZ","PRCDES","DUZ*" S ZTSAVE(A)=""
"RTN","PRCB1E",58,0)
 D ^PRCFQ
"RTN","PRCB1E",59,0)
 QUIT
"RTN","PRCB1F")
0^3^B35008607
"RTN","PRCB1F",1,0)
PRCB1F ;WISC/PLT-IFCAP MONTHLY ACCRUAL ;9/13/96  16:21
"RTN","PRCB1F",2,0)
V ;;5.1;IFCAP;**64,72**;Oct 20, 2000
"RTN","PRCB1F",3,0)
 ;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","PRCB1F",4,0)
 QUIT  ;invalid entry
"RTN","PRCB1F",5,0)
 ;
"RTN","PRCB1F",6,0)
 ;ZTQPARAM=999 if from schedule option
"RTN","PRCB1F",7,0)
EN ;monthly accrual
"RTN","PRCB1F",8,0)
 N PRCA,PRCB,PRCQCD,PRCOPT,PRCRI,PRCDI,PRCDUZ,PRC,PRCDES,PTCTD
"RTN","PRCB1F",9,0)
 N A,B,C
"RTN","PRCB1F",10,0)
 ; S PRCQCD=1 ;over lapping days
"RTN","PRCB1F",11,0)
 G Q4:$G(ZTQPARAM)=999!$G(ZTQUEUED)
"RTN","PRCB1F",12,0)
Q1 ;station
"RTN","PRCB1F",13,0)
 S PRCF("X")="AS" D ^PRCFSITE G:'% EXIT
"RTN","PRCB1F",14,0)
 S PRCRI(420)=+PRC("SITE"),PRCOPT=1
"RTN","PRCB1F",15,0)
Q4 ;accrual for month/year
"RTN","PRCB1F",16,0)
 S A=$$DATE^PRC0C("T","E")
"RTN","PRCB1F",17,0)
 S PRCTD=$P(A,"^",4)_"/"_$E($P(A,"^",3),3,4)_"^"_$P(A,"^",7)_"^"_$P(A,"^",8)
"RTN","PRCB1F",18,0)
 S A=$$DATE^PRC0C($P(A,"^",4)_"/1/"_$P(A,"^",3),"E"),$P(PRCTD,"^",4,6)=$P(A,"^",4)_"/"_$E($P(A,"^",3),3,4)_"^"_$P(A,"^",7)_"^"_$P(A,"^",8)
"RTN","PRCB1F",19,0)
 S A=$$DATE^PRC0C($P(A,"^",8)-15,"H")
"RTN","PRCB1F",20,0)
 S A=$$DATE^PRC0C($P(A,"^",4)_"/1/"_$P(A,"^",3),"E"),$P(PRCTD,"^",7,9)=$P(A,"^",4)_"/"_$E($P(A,"^",3),3,4)_"^"_$P(A,"^",7)_"^"_$P(A,"^",8)
"RTN","PRCB1F",21,0)
 G SCHED:$G(ZTQPARAM)=999!$G(ZTQUEUED)
"RTN","PRCB1F",22,0)
 S E="O^4:7^K:X'?1.2N1""/""2N&(X'?1.2N1""/""4N)!(X<1!(X>12)) X",Y(1)="Enter an accrual month/year in format: MM/YY or MM/YYYY. For example: 9/96 or 9/1996"
"RTN","PRCB1F",23,0)
 D FT^PRC0A(.X,.Y,"For Accrual Month/Year",E,$P(PRCTD,"^"))
"RTN","PRCB1F",24,0)
 G:X["^"!(X="")!(Y'?1.2N1"/"2.4N) EXIT
"RTN","PRCB1F",25,0)
 S $P(Y,"/",2)=+$$YEAR^PRC0C($P(Y,"/",2)),$P(Y,"/")=$E(100+Y,2,3)
"RTN","PRCB1F",26,0)
 S PRCA=Y,A=$$DATE^PRC0C(PRCA,"E"),$P(PRCA,"^",2,999)=A W "     Fiscal Month/Year: ",$P(PRCA,"^",10),"/",$P(PRCA,"^",2)
"RTN","PRCB1F",27,0)
 S $P(PRCA,"^",11)=$P(PRCA,"^",8)_"-"_PRC("SITE")
"RTN","PRCB1F",28,0)
 I $P(PRCA,"^",9)<$P(PRCTD,"^",9),$O(^PRCH(440.7,"B",$P(PRCA,"^",11),0))<1 D EN^DDIOL("Accrual report for "_$P(PRCA,"^")_" is NOT in file.") G Q4
"RTN","PRCB1F",29,0)
 I $P(PRCTD,"^",6)<$P(PRCA,"^",9) D EN^DDIOL("Too early to accrue for "_$P(PRCA,"^")) G Q4
"RTN","PRCB1F",30,0)
 S $P(PRCA,"^",12)=0
"RTN","PRCB1F",31,0)
Q40 S B="O^1:Compile/Print Monthly Accrual;2:Edit Monthly Accrual;3:Generate/Rebuild FMS SV-Document"
"RTN","PRCB1F",32,0)
 K X,Y S Y(1)="^W ""Enter an option number 1 to 3."""
"RTN","PRCB1F",33,0)
 D SC^PRC0A(.X,.Y,"Select Number",B,"")
"RTN","PRCB1F",34,0)
 S A=Y K X,Y
"RTN","PRCB1F",35,0)
 G Q4:A=""!(A["^")
"RTN","PRCB1F",36,0)
 S PRCOPT=+A
"RTN","PRCB1F",37,0)
 G Q45:PRCOPT=2,Q47:PRCOPT=3
"RTN","PRCB1F",38,0)
 I $O(^PRCH(440.6,"ST","N~",0)) D EN^DDIOL("Warning: An unregistered card exists in your file. Contact the P.C. Coordinator.")
"RTN","PRCB1F",39,0)
 I $P(PRCA,"^",9)'=$P(PRCTD,"^",6),$P(PRCA,"^",9)'=$P(PRCTD,"^",9) G Q5
"RTN","PRCB1F",40,0)
 S PRCRI(440.7)=$O(^PRCH(440.7,"B",$P(PRCA,"^",11),0)) G Q5:'PRCRI(440.7)
"RTN","PRCB1F",41,0)
 S A=^PRCH(440.7,PRCRI(440.7),0),B=$P(A,"^",2),B=$E(B,4,5)_"/"_$E(B,6,7)_"/"_$E(B,2,3)_"@"_$E(B,9,10)_":"_($E(B,11)\1)_($E(B,12)\1)
"RTN","PRCB1F",42,0)
 D EN^DDIOL("The last compiling date is "_B)
"RTN","PRCB1F",43,0)
 D:$P(A,"^",6) EN^DDIOL("Warning: Recompiling will overwrite all edited accrual amounts")
"RTN","PRCB1F",44,0)
Q41 D YN^PRC0A(.X,.Y,"Recompile Accrual Report:","O","NO")
"RTN","PRCB1F",45,0)
 I X["^" G Q4
"RTN","PRCB1F",46,0)
 S $P(PRCA,"^",12)=Y G Q5
"RTN","PRCB1F",47,0)
Q45 ;eidt accrual amount
"RTN","PRCB1F",48,0)
 I $P(PRCA,"^",9)'=$P(PRCTD,"^",6),$P(PRCA,"^",9)'=$P(PRCTD,"^",9) D EN^DDIOL("It is too late to edit accrual amounts") G Q4
"RTN","PRCB1F",49,0)
 S PRCRI(440.7)=$O(^PRCH(440.7,"B",$P(PRCA,"^",11),0))
"RTN","PRCB1F",50,0)
 I 'PRCRI(440.7) D EN^DDIOL("You need to select Compile/Print option first") G Q40
"RTN","PRCB1F",51,0)
 G Q5
"RTN","PRCB1F",52,0)
 ;
"RTN","PRCB1F",53,0)
Q47 ;generate sv-document
"RTN","PRCB1F",54,0)
 I $P(PRCA,"^",9)'=$P(PRCTD,"^",6),$P(PRCA,"^",9)'=$P(PRCTD,"^",9) D EN^DDIOL("It is too late to generate SV-documents") G Q4
"RTN","PRCB1F",55,0)
 S PRCRI(440.7)=$O(^PRCH(440.7,"B",$P(PRCA,"^",11),0))
"RTN","PRCB1F",56,0)
 I 'PRCRI(440.7) D EN^DDIOL("You need to select Compile/Print option first") G Q40
"RTN","PRCB1F",57,0)
 S A=^PRCH(440.7,PRCRI(440.7),0) D:$P(A,"^",7)]""
"RTN","PRCB1F",58,0)
 . N GECSDATA
"RTN","PRCB1F",59,0)
 . S A=$P($P(A,"^",7),"/",2),X="SV-"_A D DATA^GECSSGET(X,0)
"RTN","PRCB1F",60,0)
 . I '$G(GECSDATA) D EN^DDIOL(PRCPT_" NOT found!") QUIT
"RTN","PRCB1F",61,0)
 . S PRCRI(2100.1)=GECSDATA,PRCID=GECSDATA(2100.1,PRCRI(2100.1),.01,"E")
"RTN","PRCB1F",62,0)
 . D EN^DDIOL(" "),EN^DDIOL($J("FMS Document: ",15)_PRCID)
"RTN","PRCB1F",63,0)
 . D EN^DDIOL($J("Description: ",15)_GECSDATA(2100.1,PRCRI(2100.1),4,"E"))
"RTN","PRCB1F",64,0)
 . D EN^DDIOL($J("Status: ",15)_GECSDATA(2100.1,PRCRI(2100.1),3,"E"))
"RTN","PRCB1F",65,0)
 . D EN^DDIOL($J("Created: ",15)_GECSDATA(2100.1,PRCRI(2100.1),2,"E"))
"RTN","PRCB1F",66,0)
 . QUIT
"RTN","PRCB1F",67,0)
 G Q5
"RTN","PRCB1F",68,0)
Q5 D YN^PRC0A(.X,.Y,"Ready to "_$P("Compile/Print,Edit,Generate/Rebuild Document",",",PRCOPT),"O","NO")
"RTN","PRCB1F",69,0)
 I X["^"!(X="")!'Y G Q4
"RTN","PRCB1F",70,0)
 I PRCOPT=1 D ACCR
"RTN","PRCB1F",71,0)
 I PRCOPT=2 D EDIT
"RTN","PRCB1F",72,0)
 I PRCOPT=3 D
"RTN","PRCB1F",73,0)
 . D EN^DDIOL("Generating the monthly accrual FMS SV-Document")
"RTN","PRCB1F",74,0)
 . S PRCB=$P(^PRCH(440.7,PRCRI(440.7),0),"^",7)
"RTN","PRCB1F",75,0)
 . D SV^PRCB8B(.X,PRCRI(440.7)_"^"_PRCA,$TR(PRCB,"/","^"))
"RTN","PRCB1F",76,0)
 . I X>0 D EDIT^PRC0B(.X,"440.7;^PRCH(440.7,;"_PRCRI(440.7),"2///^S X=""N"";6////"_X)
"RTN","PRCB1F",77,0)
 . QUIT
"RTN","PRCB1F",78,0)
 D EN^DDIOL(" "),EN^DDIOL(" ") G Q4
"RTN","PRCB1F",79,0)
 ;
"RTN","PRCB1F",80,0)
EXIT QUIT
"RTN","PRCB1F",81,0)
 ;
"RTN","PRCB1F",82,0)
 ;
"RTN","PRCB1F",83,0)
ACCR ;start accrual
"RTN","PRCB1F",84,0)
 N PRCDUZ
"RTN","PRCB1F",85,0)
 S PRCDUZ=DUZ
"RTN","PRCB1F",86,0)
 S ZTDESC="IFCAP Monthly Accrual for Month/Year: "_$P(PRCA,"^")
"RTN","PRCB1F",87,0)
 S PRCDES=ZTDESC
"RTN","PRCB1F",88,0)
 S ZTRTN="TMEN^PRCB1F1" F A="PRCOPT","PRCA","PRCTD","PRCDUZ","PRCDES","DUZ*" S ZTSAVE(A)=""
"RTN","PRCB1F",89,0)
 D ^PRCFQ
"RTN","PRCB1F",90,0)
 QUIT
"RTN","PRCB1F",91,0)
 ;
"RTN","PRCB1F",92,0)
EDIT ;edit accrual amount
"RTN","PRCB1F",93,0)
 N PRCDI
"RTN","PRCB1F",94,0)
 N A,B,X,Y
"RTN","PRCB1F",95,0)
 D EDIT^PRC0B(.X,"440.7;^PRCH(440.7,;"_PRCRI(440.7),"5///T")
"RTN","PRCB1F",96,0)
Q21 D EN^DDIOL(" "),EN^DDIOL($TR($J("",78)," ","-")) S PRCDI="440.7;^PRCH(440.7,;"_PRCRI(440.7)_";1~440.701;^PRCH(440.7,"_PRCRI(440.7)_",50,"
"RTN","PRCB1F",97,0)
 D LOOKUP^PRC0B(.X,.Y,PRCDI,"AEMOQ","Select Fund or FCP/PRJ (ACC) Code: ")
"RTN","PRCB1F",98,0)
 I Y<0!(X="") K X QUIT
"RTN","PRCB1F",99,0)
 K X S PRCRI(440.701)=+Y,PRCAED=$P(Y,"^",3)
"RTN","PRCB1F",100,0)
 S PRCDI=";^PRCH(440.7,;"_PRCRI(440.7)_"~440.701;^PRCH(440.7,"_PRCRI(440.7)_",50,;"_PRCRI(440.701)
"RTN","PRCB1F",101,0)
 S A=^PRCH(440.7,PRCRI(440.7),50,PRCRI(440.701),0),B=$P(A,"^",2)-$P(A,"^",3)
"RTN","PRCB1F",102,0)
 D EN^DDIOL("Accrual Account: "_$P(A,"^",1))
"RTN","PRCB1F",103,0)
 D EN^DDIOL("Unpaid P.C.O Amount: "_$J($P(A,"^",2),0,2)_"         Unreconciled Amount: "_$J($P(A,"^",3),0,2))
"RTN","PRCB1F",104,0)
 D EN^DDIOL("Calculated Accrual Amount: "_$J(B,0,2))
"RTN","PRCB1F",105,0)
 D EDIT^PRC0B(.X,PRCDI,"4;5;6")
"RTN","PRCB1F",106,0)
 G Q21
"RTN","PRCB1F",107,0)
 ;
"RTN","PRCB1F",108,0)
SCHED ;compiling for all stations
"RTN","PRCB1F",109,0)
 S Y=$P(PRCTD,"^",7),$P(Y,"/",2)=+$$YEAR^PRC0C($P(Y,"/",2)),$P(Y,"/")=$E(100+Y,2,3)
"RTN","PRCB1F",110,0)
 S PRCA=Y,A=$$DATE^PRC0C(PRCA,"E"),$P(PRCA,"^",2,999)=A
"RTN","PRCB1F",111,0)
 S PRCRI(420)=0
"RTN","PRCB1F",112,0)
 F  S PRCRI(420)=$O(^PRC(420,PRCRI(420))) QUIT:'PRCRI(420)  S PRC("SITE")=$P($G(^PRC(420,PRCRI(420),0)),"^") I PRC("SITE") S $P(PRCA,"^",11)=$P(PRCA,"^",8)_"-"_PRC("SITE") D
"RTN","PRCB1F",113,0)
 . N PRCB,PRCD,PRCE,PRCG,PRCDI,PRCRICB,PRCLOCK,PRCRI,PRCID,PRCAMT,PRCBOC,PRAMTP,PRCAMTR,PRCSUBT,PRCAMTA
"RTN","PRCB1F",114,0)
 . N A,B,C
"RTN","PRCB1F",115,0)
 . S PRCID=$P(PRCA,"^",11),PRC("SITE")=$P(PRCID,"-",2)
"RTN","PRCB1F",116,0)
 . D ACCR^PRCB1F1(PRCA,PRCTD)
"RTN","PRCB1F",117,0)
 . QUIT
"RTN","PRCB1F",118,0)
 QUIT
"VER")
8.0^22.0
**END**
**END**
