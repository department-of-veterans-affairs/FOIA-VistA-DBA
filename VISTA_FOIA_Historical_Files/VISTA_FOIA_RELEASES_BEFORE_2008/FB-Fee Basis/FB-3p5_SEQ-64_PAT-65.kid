Released FB*3.5*65 SEQ #64
Extracted from mail message
**KIDS**:FB*3.5*65^

**INSTALL NAME**
FB*3.5*65
"BLD",5112,0)
FB*3.5*65^FEE BASIS^0^3031210^y
"BLD",5112,1,0)
^^4^4^3030930^
"BLD",5112,1,1,0)
If a "?" is entered at the Enter Nursing Home Rate: prompt while using 
"BLD",5112,1,2,0)
the Update Vendor Contract/Rates - CNH [FBCNH UPDATE VENDOR CONTRACT]
"BLD",5112,1,3,0)
option, an undefined error for variable DIR(0) may occur or DIR gets lost
"BLD",5112,1,4,0)
and displays number select display of rates.
"BLD",5112,4,0)
^9.64PA^^
"BLD",5112,"INID")
y
"BLD",5112,"KRN",0)
^9.67PA^8989.52^19
"BLD",5112,"KRN",.4,0)
.4
"BLD",5112,"KRN",.401,0)
.401
"BLD",5112,"KRN",.402,0)
.402
"BLD",5112,"KRN",.403,0)
.403
"BLD",5112,"KRN",.5,0)
.5
"BLD",5112,"KRN",.84,0)
.84
"BLD",5112,"KRN",3.6,0)
3.6
"BLD",5112,"KRN",3.8,0)
3.8
"BLD",5112,"KRN",9.2,0)
9.2
"BLD",5112,"KRN",9.8,0)
9.8
"BLD",5112,"KRN",9.8,"NM",0)
^9.68A^1^1
"BLD",5112,"KRN",9.8,"NM",1,0)
FBAAVD2^^0^B30603987
"BLD",5112,"KRN",9.8,"NM","B","FBAAVD2",1)

"BLD",5112,"KRN",19,0)
19
"BLD",5112,"KRN",19.1,0)
19.1
"BLD",5112,"KRN",101,0)
101
"BLD",5112,"KRN",409.61,0)
409.61
"BLD",5112,"KRN",771,0)
771
"BLD",5112,"KRN",870,0)
870
"BLD",5112,"KRN",8989.51,0)
8989.51
"BLD",5112,"KRN",8989.52,0)
8989.52
"BLD",5112,"KRN",8994,0)
8994
"BLD",5112,"KRN","B",.4,.4)

"BLD",5112,"KRN","B",.401,.401)

"BLD",5112,"KRN","B",.402,.402)

"BLD",5112,"KRN","B",.403,.403)

"BLD",5112,"KRN","B",.5,.5)

"BLD",5112,"KRN","B",.84,.84)

"BLD",5112,"KRN","B",3.6,3.6)

"BLD",5112,"KRN","B",3.8,3.8)

"BLD",5112,"KRN","B",9.2,9.2)

"BLD",5112,"KRN","B",9.8,9.8)

"BLD",5112,"KRN","B",19,19)

"BLD",5112,"KRN","B",19.1,19.1)

"BLD",5112,"KRN","B",101,101)

"BLD",5112,"KRN","B",409.61,409.61)

"BLD",5112,"KRN","B",771,771)

"BLD",5112,"KRN","B",870,870)

"BLD",5112,"KRN","B",8989.51,8989.51)

"BLD",5112,"KRN","B",8989.52,8989.52)

"BLD",5112,"KRN","B",8994,8994)

"BLD",5112,"PRE")
FBXIP65E
"BLD",5112,"QUES",0)
^9.62^^
"BLD",5112,"REQB",0)
^9.611^1^1
"BLD",5112,"REQB",1,0)
FB*3.5*47^2
"BLD",5112,"REQB","B","FB*3.5*47",1)

"MBREQ")
0
"PKG",60,-1)
1^1
"PKG",60,0)
FEE BASIS^FB^Used to pay private vendors
"PKG",60,20,0)
^9.402P^1^1
"PKG",60,20,1,0)
2^^FBPMRG
"PKG",60,20,1,1)

"PKG",60,20,"B",2,1)

"PKG",60,22,0)
^9.49I^1^1
"PKG",60,22,1,0)
3.5^2950130^2950313
"PKG",60,22,1,"PAH",1,0)
65^3031210
"PKG",60,22,1,"PAH",1,1,0)
^^4^4^3031210
"PKG",60,22,1,"PAH",1,1,1,0)
If a "?" is entered at the Enter Nursing Home Rate: prompt while using 
"PKG",60,22,1,"PAH",1,1,2,0)
the Update Vendor Contract/Rates - CNH [FBCNH UPDATE VENDOR CONTRACT]
"PKG",60,22,1,"PAH",1,1,3,0)
option, an undefined error for variable DIR(0) may occur or DIR gets lost
"PKG",60,22,1,"PAH",1,1,4,0)
and displays number select display of rates.
"PRE")
FBXIP65E
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
2
"RTN","FBAAVD2")
0^1^B30603987
"RTN","FBAAVD2",1,0)
FBAAVD2 ;AISC/DMK-EDIT VENDOR DEMOGRAPHICS ;10/20/02
"RTN","FBAAVD2",2,0)
 ;;3.5;FEE BASIS;**9,10,47,65**;JAN 30, 1995
"RTN","FBAAVD2",3,0)
 ;;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","FBAAVD2",4,0)
EDITV ;entry to edit vendor demographic data
"RTN","FBAAVD2",5,0)
 ;DA defined to IEN of vendor file (161.2)
"RTN","FBAAVD2",6,0)
 Q:'$G(DA)  N FBADT,FBDA S FBDA=DA L +^FBAAV(DA):1 I '$T W !,"Unable to access vendor record. Trying again.",! G EDITV
"RTN","FBAAVD2",7,0)
 S FBT=$S($D(FBT):FBT,1:""),FBT=$S(FBT="N":FBT,1:"C")
"RTN","FBAAVD2",8,0)
 S FEEO="",DIE="^FBAAV(",DR="[FBAA EDIT VENDOR]",DIE("NO^")="BACKOUTOK"
"RTN","FBAAVD2",9,0)
 S Z1=$G(^FBAAV(DA,0)),Z3=$G(^(1)),Z4=$G(^("AMS")),Z5=$G(^("ADEL"))
"RTN","FBAAVD2",10,0)
 D GETGRP^FBAAUTL6(DA)
"RTN","FBAAVD2",11,0)
 D ^DIE
"RTN","FBAAVD2",12,0)
 I $P($G(^FBAAV(DA,0)),"^",13)']"" S DR="3;4;5;5.5",DIE("NO^")="" D ^DIE
"RTN","FBAAVD2",13,0)
 K DIE
"RTN","FBAAVD2",14,0)
 L -^FBAAV(DA)
"RTN","FBAAVD2",15,0)
 ;check if data was changed
"RTN","FBAAVD2",16,0)
 I $D(^FBAAV(DA,0)),(($P(Z1,U,2,6)'=$P(^FBAAV(DA,0),U,2,6))!($P(Z1,U,8,16)'=$P(^FBAAV(DA,0),U,8,16))!($P(Z3,U,10)'=$P($G(^FBAAV(DA,1)),U,10))!$$GRPDIF^FBAAUTL6(DA)) D
"RTN","FBAAVD2",17,0)
 .S FBVNAME=$P(^FBAAV(DA,0),U),FBIEN1=DA,FBADT=$P(Z5,U,4)
"RTN","FBAAVD2",18,0)
 .;check if date last received from austin, version 3.  If so, then did not receive in upload - send update instead of change
"RTN","FBAAVD2",19,0)
 .;fbadt = date received from austin.
"RTN","FBAAVD2",20,0)
 .I '$$CKVEN^FBAADV(DA),FBADT']"" D UPDT^FBAAAV(FBDA) Q  ;,FBADT<FBINSTAL D UPDT^FBAAAV(DA) Q
"RTN","FBAAVD2",21,0)
 .;if austin deleted is yes, send update instead of change
"RTN","FBAAVD2",22,0)
 .I $P($G(^FBAAV(FBDA,"ADEL")),"^")="Y" D UPDT^FBAAAV(FBDA) Q
"RTN","FBAAVD2",23,0)
 .;if editing a newly added vendor, send update instead of change
"RTN","FBAAVD2",24,0)
 .I FBT="N" D UPDT^FBAAAV(FBDA) Q
"RTN","FBAAVD2",25,0)
 .;if only FPDS data was changed
"RTN","FBAAVD2",26,0)
 .I $P(Z1,U,2,6)=$P(^FBAAV(DA,0),U,2,6),$P(Z1,U,8,16)=$P(^FBAAV(DA,0),U,8,16) D  Q:FBT=""
"RTN","FBAAVD2",27,0)
 ..I '$D(^FBAA(161.25,"AF",DA)),'$D(^FBAA(161.25,DA,0)) S FBT="F" Q  ; no pending actions - add "F"
"RTN","FBAAVD2",28,0)
 ..I '$D(^FBAA(161.25,"AF",DA)),$D(^FBAA(161.25,DA,0)),$P(^(0),U,5)="" S FBT="" Q  ; action pending, but not yet transmitted - will incl. FPDS data
"RTN","FBAAVD2",29,0)
 .I FBT="F" S FBIEN1=DA,FEEO="" D SETGL^FBAAVD Q  ; send FEE-ONLY
"RTN","FBAAVD2",30,0)
 .;If date from austin not null then add vendor entry for a change
"RTN","FBAAVD2",31,0)
 .K DD,DO S DIC="^FBAAV(",DIC(0)="L",DLAYGO=161.2,X=FBVNAME D FILE^DICN Q:Y<0  S FBIEN=+Y
"RTN","FBAAVD2",32,0)
 .L +^FBAAV(FBIEN)
"RTN","FBAAVD2",33,0)
 .S ^FBAAV(FBIEN,0)=$G(^FBAAV(FBIEN1,0))
"RTN","FBAAVD2",34,0)
 .S ^FBAAV(FBIEN,1)=$G(^FBAAV(FBIEN1,1))
"RTN","FBAAVD2",35,0)
 .S ^FBAAV(FBIEN,"AMS")=$G(^FBAAV(FBIEN1,"AMS")),$P(^FBAAV(FBIEN,"AMS"),"^")=""
"RTN","FBAAVD2",36,0)
 .K FBFDA
"RTN","FBAAVD2",37,0)
 .S I=0 F  S I=$O(^FBAAV(FBIEN1,2,I)) Q:'I  D
"RTN","FBAAVD2",38,0)
 ..S X=$P($G(^(I,0)),U) I X]"" S FBFDA(161.225,"+"_I_","_FBIEN_",",.01)=X
"RTN","FBAAVD2",39,0)
 .I $D(FBFDA) D UPDATE^DIE("","FBFDA")
"RTN","FBAAVD2",40,0)
 .S DIK="^FBAAV(",DA=FBIEN D IX1^DIK
"RTN","FBAAVD2",41,0)
 .L -^FBAAV(FBIEN)
"RTN","FBAAVD2",42,0)
 .;restore original vendor data
"RTN","FBAAVD2",43,0)
 .L +^FBAAV(FBIEN1)
"RTN","FBAAVD2",44,0)
 .S DIE="^FBAAV(",DA=FBIEN1,DR="[FB VENDOR UPDATE]" D ^DIE K DIE
"RTN","FBAAVD2",45,0)
 .D UPDGRP^FBAAUTL6(FBIEN1)
"RTN","FBAAVD2",46,0)
 .L -^FBAAV(FBIEN1)
"RTN","FBAAVD2",47,0)
 .S DA=FBIEN D SETGL^FBAAVD
"RTN","FBAAVD2",48,0)
 K FBSG,FBVNAME,FBIEN,FBIEN1,Z3,Z4,Z5
"RTN","FBAAVD2",49,0)
 ;
"RTN","FBAAVD2",50,0)
CONTR ;enter contract information for a CNH vendor
"RTN","FBAAVD2",51,0)
 Q:$S('$D(FBPARCD):1,FBPARCD'=5:1,1:0)
"RTN","FBAAVD2",52,0)
 Q:'$G(DA)  S FBVIEN=DA
"RTN","FBAAVD2",53,0)
 S FBLIEN=$P($G(^FBAA(161.25,FBVIEN,0)),"^",6) I FBLIEN]"",FBLIEN'=FBVIEN W !!,*7,"Cannot add contract information to this vendor until change has been",!,"approved by Austin." Q
"RTN","FBAAVD2",54,0)
 W ! S DIC="^FBAA(161.21,",DIC(0)="AEQLM",DLAYGO=161.21,DIC("S")="I $P(^(0),U,4)="_FBVIEN
"RTN","FBAAVD2",55,0)
 D ^DIC K DIC,DLAYGO Q:X=""!(X="^")  G CONTR:Y<0
"RTN","FBAAVD2",56,0)
 S DA=+Y,FBCNUM=$P(Y,"^",2),DIE="^FBAA(161.21," L +^FBAA(161.21,DA)
"RTN","FBAAVD2",57,0)
 S ZO1=^FBAA(161.21,DA,0),DR="[FBNH ENTER CONTRACT]",DIE("NO^")="" D ^DIE K DIE,DR
"RTN","FBAAVD2",58,0)
 I '$G(DA) K ZO1 Q
"RTN","FBAAVD2",59,0)
 I $D(^FBAA(161.22,"AC",DA)) D
"RTN","FBAAVD2",60,0)
 .Q:$P(ZO1,"^",1,2)=$P(^FBAA(161.21,DA,0),"^",1,2)  W !!,*7,"You cannot change contract numbers or effective dates on",!,"a contract that has rates associated with it."
"RTN","FBAAVD2",61,0)
 .S DIE="^FBAA(161.21,",DR=".01////^S X=$P(ZO1,U);.02////^S X=$P(ZO1,U,2);.03////^S X=$P(ZO1,U,3);.04////^S X=$P(ZO1,U,4)" D ^DIE K DIE,DR W !!,"Contract information reset"
"RTN","FBAAVD2",62,0)
 L -^FBAA(161.21,DA) K ZO1
"RTN","FBAAVD2",63,0)
 Q:$D(DTOUT)
"RTN","FBAAVD2",64,0)
 I $G(FBEXNDT)<$G(FBEXDT) D URATE K FBCIEN,FBEXDT,FBEXNDT,FBURT
"RTN","FBAAVD2",65,0)
 ;create rates for a contract. Rates cannot be changed, but the
"RTN","FBAAVD2",66,0)
 ;user can enter multiple rates for a contract.
"RTN","FBAAVD2",67,0)
 ;FBCIEN=internal entry number for contract in 161.21
"RTN","FBAAVD2",68,0)
 S FBCIEN=DA K FBX
"RTN","FBAAVD2",69,0)
RATE K DA W ! S DIR(0)="161.22,.02",DIR("A")="Enter Nursing Home Rate",DIR("?")="^K FBX,FBRATE D DISPLAY^FBAAVD1 W !,""Enter an amount between .01 and 9999999.99""" D ^DIR
"RTN","FBAAVD2",70,0)
 K DIR Q:$D(DIRUT)  Q:'Y  S FBR=+Y
"RTN","FBAAVD2",71,0)
 I $L($$RATE^FBAAVD1($P(^FBAA(161.21,FBCIEN,0),"^",1)))+$L("^"_FBR)>510 W !,*7,"There are too many rates loaded for that contract! Please remove obsolete rates.",! Q
"RTN","FBAAVD2",72,0)
 I $D(^FBAA(161.22,"AD",FBCIEN,FBR)) K FBR W !,*7,"Rate already exists for that contract!",! G RATE
"RTN","FBAAVD2",73,0)
 S X=$P(^FBAA(161.22,0),U,3)
"RTN","FBAAVD2",74,0)
RETRY S X=X+1 G:$D(^FBAA(161.22,X)) RETRY
"RTN","FBAAVD2",75,0)
 L +^FBAA(161.22,X)
"RTN","FBAAVD2",76,0)
 K DD,DO S DIC="^FBAA(161.22,",DIC(0)="L",DLAYGO=161.22,DIC("DR")=".02////^S X="_FBR_";.03////^S X="_FBCIEN D FILE^DICN K DIC,DLAYGO
"RTN","FBAAVD2",77,0)
 L -^FBAA(161.22,+Y)
"RTN","FBAAVD2",78,0)
 G RATE
"RTN","FBAAVD2",79,0)
 ;
"RTN","FBAAVD2",80,0)
GETVEN K FBRATE D GETVEN^FBAAUTL1 G END:'IFN
"RTN","FBAAVD2",81,0)
 S DA=IFN K DIC,IFN
"RTN","FBAAVD2",82,0)
 S FBPARCD=$P($G(^FBAAV(DA,0)),U,9)
"RTN","FBAAVD2",83,0)
 I FBPARCD'=5 W !?5,*7,"Vendor selected is not a Community Nursing Home.",! G GETVEN
"RTN","FBAAVD2",84,0)
 D CONTR G GETVEN
"RTN","FBAAVD2",85,0)
END K DIC,DA,FBVIEN,IFN,FBPARCD,X,Y,FBLIEN
"RTN","FBAAVD2",86,0)
 Q
"RTN","FBAAVD2",87,0)
URATE ;Update rate when user backs up contract dates.
"RTN","FBAAVD2",88,0)
 N DA S (FBCIEN,FBURT)=0
"RTN","FBAAVD2",89,0)
 F  S FBURT=$O(^FBAA(161.23,"AE",FBCNUM,FBURT)) Q:'FBURT  F  S FBCIEN=$O(^FBAA(161.23,"AE",FBCNUM,FBURT,FBCIEN)) Q:'FBCIEN  I $P($G(^FBAA(161.23,FBCIEN,0)),"^",2)>FBEXNDT D
"RTN","FBAAVD2",90,0)
 .I +$G(^FBAA(161.23,FBCIEN,0))>FBEXNDT S DIK="^FBAA(161.23,",DA=FBCIEN D ^DIK K DIK Q
"RTN","FBAAVD2",91,0)
 .S DIE="^FBAA(161.23,",DA=FBCIEN,DR=".02////^S X=FBEXNDT" D ^DIE K DIE
"RTN","FBAAVD2",92,0)
 Q
"RTN","FBXIP65E")
0^^B3841111
"RTN","FBXIP65E",1,0)
FBXIP65E ;AISC/JEH - PATCH FB*3.5*65 ENVIRONMENT CHECK
"RTN","FBXIP65E",2,0)
 ;;3.5;Fee Basis;**65**;JAN 30, 1995
"RTN","FBXIP65E",3,0)
 ;;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","FBXIP65E",4,0)
ENV ;
"RTN","FBXIP65E",5,0)
 ;this is the environment check pre-init routine
"RTN","FBXIP65E",6,0)
 I $$PATCH^XPDUTL("FB*3.5*42") D
"RTN","FBXIP65E",7,0)
 .W !,"You are a test site for a CoreFLS version (patch FB*3.5*42) of Fee Basis"
"RTN","FBXIP65E",8,0)
 .W !,"This patch has a conflict with the FB-CoreFLS test software."
"RTN","FBXIP65E",9,0)
 .W !,"It must NOT be installed unless an accompanying update is made to the"
"RTN","FBXIP65E",10,0)
 .W !,"FB-CoreFLS software immediately after installation of this patch."
"RTN","FBXIP65E",11,0)
 .W !
"RTN","FBXIP65E",12,0)
 .K DIR S DIR(0)="YA"
"RTN","FBXIP65E",13,0)
 .S DIR("A")="Do you have the corresponding update to the FB-CoreFLS software that is associated with this patch? (Note: Entering ""No"" here will stop the installation of this patch) Y/N//"
"RTN","FBXIP65E",14,0)
 .D ^DIR K DIR
"RTN","FBXIP65E",15,0)
 .I $D(DTOUT)!$D(DUOUT)!(Y'=1) W !,"Installation of this patch has been stopped!" S XPDQUIT=2 Q
"RTN","FBXIP65E",16,0)
 .W !,"OK to install!"
"RTN","FBXIP65E",17,0)
 Q
"VER")
8.0^22
**END**
**END**
