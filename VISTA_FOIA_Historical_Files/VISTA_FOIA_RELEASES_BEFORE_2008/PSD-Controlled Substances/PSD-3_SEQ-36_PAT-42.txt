$TXT Created by CRAIG,PAMELA S at MNTVBB.FO-ALBANY.MED.VA.GOV  (KIDS) on Thursday, 11/20/03 at 11:42
=============================================================================
Run Date: FEB 02, 2004                     Designation: PSD*3*42
Package : PSD - CONTROLLED SUBSTANCES         Priority: Mandatory
Version : 3        SEQ #36                      Status: Released
                  Compliance Date: MAR 04, 2004
=============================================================================

Associated patches: (v)PSD*3*40    <<= must be installed BEFORE `PSD*3*42'
                    (v)PSD*3*41    <<= must be installed BEFORE `PSD*3*42'

Subject: Patients Without VA Visit Report

Category: 
  - Routine

Description:
============

 This is a patch to correct 2 problems in the Controlled Substances package.
 The first problem is in the option 'PATIENTS WITHOUT VA VISIT REPORT',
 CS Monitoring menu option. At the prompt 'Screen for controlled
 substance RXs? Yes//', if answered 'NO', all of the data, including controlled
 substance RXs, appear on the report. However when 'Screen for controlled
 substance RXs? Yes//' is answered 'YES', and the prompt
 'Include RXs with CS schedule(s):  (2-5): 2//' is answered 2-5 for
 the same divisions and the same time period, the report prints 'NO DATA
 FOUND." To correct this a modification was made to the check of variable PSDP,
 which is used to determine what to print when prompts are answered as noted 
 above.
 This correction allows the report to print as expected, based on the user
 documentation.
 
 Second, this patch will change/correct the reference of IA 221 to IA 2621
 in routines PSDDSOR and PSDDSOR2. There will be no change in the logic
 flow of this code. (Note: additional changes for the IA will be addressed in
 patch PSD*3.0*45.) 
 
 ASSOCIATED E3R(S):
 ==================
 N/A
  
 This patch addresses the following NOIS message(s):
 ---------------------------------------------------
 1. POR-0503-51185  'PATIENTS WITHOUT VA VISIT REPORT' NOT WORKING AS EXPECTED
                    FOR CONTROLLED SUBSTANCES      
 
 2. ISB-0903-31237  IA 221 NEEDS TO BE REPLACED WITH IA 2621 IN ROUTINES
                    PSDDSOR AND PSDDSOR2 
 		   NOTE: additional changes for the IA will be addressed in
 		      patch PSD*3.0*45. 
 
 Overview of NOIS Message(s):
 ----------------------------
 1. POR-0503-51185  'PATIENTS WITHOUT VA VISIT REPORT' NOT WORKING AS EXPECTED
                    FOR CONTROLLED SUBSTANCES
  
 Problem:
 --------
 Problem reported for the option 'PATIENTS WITHOUT VA VISIT REPORT',
 found on the CS Monitoring menu option.
 At the prompt 'Screen for controlled substance RXs? YES//', if answered 'NO',
 all of the data, including controlled substance RXs, appear on the report.
 However when 'Screen for controlled substance RXs? YES//' is answered 'YES',
 and prompt 'Include RXs with CS schedule(s):  (2-5): 2//' is answered 2-5 for
 the same divisions and the same time period, the report prints 'NO DATA
 FOUND".
  
 Resolution:
 -----------
 Modification made to the check of variable PSDP, which is used to determine 
 what to print when prompts are answered as noted in the problem section.
 
 For the option 'PATIENTS WITHOUT VA VISIT REPORT', CS Monitoring menu option. 
 At the prompt 'Screen for controlled substance RXs? Yes//', if answered 'NO',
 all of the data, including controlled substance RXs, appear on the report.
 However when 'Screen for controlled substance RXs? Yes//' is answered 'YES',
 and the prompt 'Include RXs with CS schedule(s):  (2-5): 2//' is answered 2-5
 for the same divisions and the same time period, only controlled substances 
 will appear on the report.
 
 2. ISB-0903-31237  IA 221 NEEDS TO BE REPLACED WITH IA 2621 IN ROUTINES
                    PSDDSOR AND PSDDSOR2 
 
 Problem:
 --------
 In order to complete the DEA/PKI Project, a waiver was granted for the patch
 PSD*3*40, where IA 221 is referenced instead of 2621 to access the global
 ^PS(59 in routines PSDDSOR and PSDDSOR2. Any future patches having these
 routines will need to replace IA 221 with IA 2621.
 NOTE: Additional changes for the IA will be addressed in patch PSD*3.0*45.
 
 
 Resolution:
 -----------
 Change references for IA 221 to IA 2621 in routines PSDDSOR and PSDDSOR2.
  
 TECHNICAL:
 ==========
 NOIS: POR-0503-51185
  
 In the routine PSDNMWE a modification of the test for variable PSDP required
 modification.
  
        Before:
        -------
        PSDNMWE+2^PSDNMWE
        ;;3.0; CONTROLLED SUBSTANCES ;*41,42*;13 Feb 97
                 
        PSDNMWE+4^PSDNMWE
        Reference to ^PSDRUG( supported by IA #221
 
        PSDNMWE+72^PSDNMWE
        . . I +$G(PSDCII) S PSDP=0 D  I PSDP Q
 
        After:
        ------
        PSDNMWE+2^PSDNMWE
        ;;3.0; CONTROLLED SUBSTANCES ;**41,42**;13 Feb 97
 
        PSDNMWE+4^PSDNMWE
        ;Reference to ^PSDRUG( supported by IA #2621
 
        PSDNMWE+72^PSDNMWE          
        . . I +$G(PSDCII) S PSDP=0 D  I 'PSDP Q
 
 NOIS: ISB-0903-31237
 
 Routines PSDDSOR and PSDDSOR2 required modification for IA 221 to be changed 
 to IA 2621.
 
         Before:
         -------
         PSDDSOR+2^PSDDSOR
         ;;3.0; CONTROLLED SUBSTANCES ;**40**;13 Feb 97
 
         PSDDSOR+6^PSDDSOR
         ;Ref. ^PSDRUG( supp. by IA 221
 
         PSDDSOR2+2^PSDDSOR2
         ;;3.0; CONTROLLED SUBSTANCES ;**40**;13 Feb 97
 
         PSDDSOR2+7^PSDDSOR2
         ;Ref. ^PSDRUG( supp. by IA 221
 
         After:
         ------
         PSDDSOR+2^PSDDSOR
         ;;3.0; CONTROLLED SUBSTANCES ;**40,42**;13 Feb 97
 
         PSDDSOR+6^PSDDSOR             
         ;Ref. ^PSDRUG( supp. by IA 2621
 
         PSDDSOR2+2^PSDDSOR2
         ;;3.0; CONTROLLED SUBSTANCES ;**40,42**;13 Feb 97
 
         PSDDSOR2+7^PSDDSOR2
         ;Ref. ^PSDRUG( supp. by IA 2621
  
 PARTICIPATING TEST SITES:
 =========================
 Puget Sound HCS  
 Honolulu
 Biloxi
 
 DATA DICTIONARY CHANGES:
 ========================
 N/A
  
 TEMPLATES:
 ==========
 N/A
  
 ROUTINE SUMMARY:
 ================
  The following is a list of the routine(s) included in this patch.  The
  second line of each of these routine(s) will look like:
      <tab>;;3.0; CONTROLLED SUBSTANCES ;**[patch list]**;13 Feb 97
 
                             CHECK^XTSUMBLD results
 
  Routine name      Before Patch          After Patch         Patch List
  ============      ============          ===========         ==========
  PSDDSOR               21567333             21567333            40,42
  PSDDSOR2               9634818              9634818            40,42
  PSDNMWE               12170332             12172082            41,42
  
  Total routines: 3
  
 DISTRIBUTION:
 =============
 This patch is exported using KIDS.
  
 INSTALLATION INSTRUCTIONS:
 ==========================
 This patch may be run with users on the system, but it is recommended 
 that it be queued to run after normal business hours to minimize the 
 impact on users of the CONTROLLED SUBSTANCES package.
  
 Installation will take less than 2 minutes.
  
 1. Use the INSTALL/CHECK MESSAGE option on the PackMan menu to unload the 
    KIDS distribution included with the message.
  
 2. Review your mapped set. If any of the routines listed in the ROUTINE
    SUMMARY section are mapped, they should be removed from the mapped set.
  
 3. From the Kernel Installation and Distribution System Menu, select
    the Installation menu.
  
 4. From this menu, you may elect to use the following options
    (when  prompted for INSTALL NAME, enter PSD*3.0*42):
  	a. Backup a Transport Global - This option will create a backup
            message of any routines exported with this patch. It will
            not backup any other changes such as DD's or templates.
         b. Compare Transport Global to Current System - this option will 
            allow you to view all changes that will be made when the patch 
            is installed. It compares all components of the patch 
            (routines, DDs, templates, etc.).
         c. Verify Checksums in Transport Global - this option will allow
            you to ensure the integrity of the routines that are in the 
            Transport Global.
         d. Print Transport Global - this option will allow you to view 
            the components of the KIDS build.
  
 5. Use the Install Package(s) option and select the package PSD*3.0*42.
  
 6. When prompted with, 'Want KIDS to INHIBIT LOGONs during the install? 
    YES//', respond NO.
  
 7. When prompted with, 'Want to DISABLE CONTROLLED SUBSTANCES Options, 
    Menu Options, and Protocols? YES//', respond NO.
  
 8. If routines were unmapped as part of step 2, they should be returned 
    to the mapped set once the installation has run to completion.
  
 NOTE: This step is only necessary if you performed step 2 or if
       you wish to include the routines in your mapped set.
 
 POST INSTALLATION INSTRUCTIONS:
 ===============================
  
 N/A
 

Routine Information:
====================

Routine Name:
  - PSDNMWE


Routine Checksum:

Routine Name:
  - PSDDSOR


Routine Checksum:

Routine Name:
  - PSDDSOR2


Routine Checksum:

=============================================================================
User Information:
Entered By  : BLOCKER,DAVE                  Date Entered  : MAY 22, 2003
Completed By: ANDERSON,MAXINE               Date Completed: FEB 02, 2004
Released By : LYTTLE,KIM M                  Date Released : FEB 02, 2004
=============================================================================


Packman Mail Message:
=====================

$END TXT
