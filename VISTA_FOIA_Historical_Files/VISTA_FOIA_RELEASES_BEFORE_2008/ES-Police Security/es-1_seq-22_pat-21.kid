Released ES*1*21 SEQ #22
Extracted from mail message
**KIDS**:ES*1.0*21^

**INSTALL NAME**
ES*1.0*21
"BLD",801,0)
ES*1.0*21^POLICE & SECURITY^0^2980528^y
"BLD",801,1,0)
^^1^1^2980528^^^
"BLD",801,1,1,0)
Clean up NOIS issues.
"BLD",801,4,0)
^9.64PA^910^1
"BLD",801,4,910,0)
910
"BLD",801,4,910,2,0)
^9.641^910^1
"BLD",801,4,910,2,910,0)
ESP MASTER NAME INDEX  (File-top level)
"BLD",801,4,910,2,910,1,0)
^9.6411^.04^1
"BLD",801,4,910,2,910,1,.04,0)
CATEGORY
"BLD",801,4,910,222)
y^n^p^^^^n
"BLD",801,4,"APDD",910,910)

"BLD",801,4,"APDD",910,910,.04)

"BLD",801,4,"B",910,910)

"BLD",801,"KRN",0)
^9.67PA^19^18
"BLD",801,"KRN",.4,0)
.4
"BLD",801,"KRN",.401,0)
.401
"BLD",801,"KRN",.402,0)
.402
"BLD",801,"KRN",.403,0)
.403
"BLD",801,"KRN",.5,0)
.5
"BLD",801,"KRN",.84,0)
.84
"BLD",801,"KRN",3.6,0)
3.6
"BLD",801,"KRN",3.8,0)
3.8
"BLD",801,"KRN",9.2,0)
9.2
"BLD",801,"KRN",9.8,0)
9.8
"BLD",801,"KRN",9.8,"NM",0)
^9.68A^3^3
"BLD",801,"KRN",9.8,"NM",1,0)
ESPOFFE^^0^B18788692
"BLD",801,"KRN",9.8,"NM",2,0)
ESPORP5^^0^B12264549
"BLD",801,"KRN",9.8,"NM",3,0)
ESPQNC^^0^B29226187
"BLD",801,"KRN",9.8,"NM","B","ESPOFFE",1)

"BLD",801,"KRN",9.8,"NM","B","ESPORP5",2)

"BLD",801,"KRN",9.8,"NM","B","ESPQNC",3)

"BLD",801,"KRN",19,0)
19
"BLD",801,"KRN",19.1,0)
19.1
"BLD",801,"KRN",101,0)
101
"BLD",801,"KRN",409.61,0)
409.61
"BLD",801,"KRN",771,0)
771
"BLD",801,"KRN",869.2,0)
869.2
"BLD",801,"KRN",870,0)
870
"BLD",801,"KRN",8994,0)
8994
"BLD",801,"KRN","B",.4,.4)

"BLD",801,"KRN","B",.401,.401)

"BLD",801,"KRN","B",.402,.402)

"BLD",801,"KRN","B",.403,.403)

"BLD",801,"KRN","B",.5,.5)

"BLD",801,"KRN","B",.84,.84)

"BLD",801,"KRN","B",3.6,3.6)

"BLD",801,"KRN","B",3.8,3.8)

"BLD",801,"KRN","B",9.2,9.2)

"BLD",801,"KRN","B",9.8,9.8)

"BLD",801,"KRN","B",19,19)

"BLD",801,"KRN","B",19.1,19.1)

"BLD",801,"KRN","B",101,101)

"BLD",801,"KRN","B",409.61,409.61)

"BLD",801,"KRN","B",771,771)

"BLD",801,"KRN","B",869.2,869.2)

"BLD",801,"KRN","B",870,870)

"BLD",801,"KRN","B",8994,8994)

"BLD",801,"QUES",0)
^9.62^^
"BLD",801,"REQB",0)
^9.611^3^3
"BLD",801,"REQB",1,0)
ES*1.0*15^2
"BLD",801,"REQB",2,0)
ES*1.0*17^2
"BLD",801,"REQB",3,0)
ES*1.0*18^2
"BLD",801,"REQB","B","ES*1.0*15",1)

"BLD",801,"REQB","B","ES*1.0*17",2)

"BLD",801,"REQB","B","ES*1.0*18",3)

"FIA",910)
ESP MASTER NAME INDEX
"FIA",910,0)
^ESP(910,
"FIA",910,0,0)
910I
"FIA",910,0,1)
y^n^p^^^^n
"FIA",910,0,10)

"FIA",910,0,11)

"FIA",910,0,"RLRO")

"FIA",910,0,"VR")
1.0^ES
"FIA",910,910)
1
"FIA",910,910,.04)

"PKG",368,-1)
1^1
"PKG",368,0)
POLICE & SECURITY^ES^POLICE & SECURITY PACKAGE
"PKG",368,20,0)
^9.402P^^
"PKG",368,22,0)
^9.49I^1^1
"PKG",368,22,1,0)
1.0^2930300^2960130
"PKG",368,22,1,"PAH",1,0)
21^2980528^66471
"PKG",368,22,1,"PAH",1,1,0)
^^1^1^2980528
"PKG",368,22,1,"PAH",1,1,1,0)
Clean up NOIS issues.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
3
"RTN","ESPOFFE")
0^1^B18788692
"RTN","ESPOFFE",1,0)
ESPOFFE ;DALISC/CKA- OFFENSE REPORT EDIT;8/92
"RTN","ESPOFFE",2,0)
 ;;1.0;POLICE & SECURITY;**3,12,15,21**;Mar 31, 1994
"RTN","ESPOFFE",3,0)
EN ;The program will check for CHIEF key.
"RTN","ESPOFFE",4,0)
 ;If don't have key-Must be completed and unconfidential-OR
"RTN","ESPOFFE",5,0)
 ;If have key- can edit any OPEN report ORC
"RTN","ESPOFFE",6,0)
 D DT^DICRW S ESPVAR=1
"RTN","ESPOFFE",7,0)
 I $D(^XUSEC("ESP CHIEF",DUZ)) G ORC
"RTN","ESPOFFE",8,0)
OR S DIC(0)="QAEMZ",DIC("A")="UOR#: ",DIC("S")="I $D(^(5)),$P(^(5),U,2),'$P(^(5),U,4),$P(^(5),U,5),$P(^(0),U,8)=""O""",DIC="^ESP(912,"
"RTN","ESPOFFE",9,0)
 D ^DIC
"RTN","ESPOFFE",10,0)
 G:$D(DTOUT)!($D(DUOUT))!(X="") EXIT
"RTN","ESPOFFE",11,0)
 G:Y<0 OR S ESPDTR=$P(^ESP(912,+Y,0),U,2),(ESPID,ESPOFN)=+Y
"RTN","ESPOFFE",12,0)
 G PRT
"RTN","ESPOFFE",13,0)
ORC S DIC(0)="QAEMZ",DIC("A")="UOR#: ",DIC("S")="I $D(^(5)),$P(^(5),U,5),$P(^(0),U,8)=""O""",DIC="^ESP(912,"
"RTN","ESPOFFE",14,0)
 D ^DIC G:$D(DTOUT)!($D(DUOUT))!(X="") EXIT G:Y<0 ORC S ESPDTR=$P(^ESP(912,+Y,0),U,2),(ESPID,ESPOFN)=+Y
"RTN","ESPOFFE",15,0)
PRT ;CALLS ESPORP,ESPORP1,ESPORP2- PRINTS THE REPORT
"RTN","ESPOFFE",16,0)
Q S %ZIS="Q" D ^%ZIS G:POP EXIT I '$D(IO("Q")) U IO D START^ESPORP G OK
"RTN","ESPOFFE",17,0)
 S ZTRTN="START^ESPORP",ZTSAVE("ESP*")="",ZTDESC="OFFENSE REPORT" D ^%ZTLOAD,HOME^%ZIS
"RTN","ESPOFFE",18,0)
 W !!!!
"RTN","ESPOFFE",19,0)
OK G:ESPVAR=4 CLO
"RTN","ESPOFFE",20,0)
 S DIR(0)="Y",DIR("A")="Do you want to edit",DIR("B")="YES" D ^DIR K DIR W !!
"RTN","ESPOFFE",21,0)
 I $D(DTOUT) W $C(7) G EXIT
"RTN","ESPOFFE",22,0)
 I Y G EDIT
"RTN","ESPOFFE",23,0)
 ;if ESPVAR=0, report is incomplete, resume editing own
"RTN","ESPOFFE",24,0)
 ;if ESPVAR=1, report could be incomplete or complete, editing own or any if chief
"RTN","ESPOFFE",25,0)
 ;if ESPVAR=2, opened a closed report
"RTN","ESPOFFE",26,0)
 ;if ESPVAR=3, created a report
"RTN","ESPOFFE",27,0)
 ;if ESPVAR=4, reviewing a completed report
"RTN","ESPOFFE",28,0)
 I (ESPVAR=0)!(ESPVAR=3) G COMP
"RTN","ESPOFFE",29,0)
 I ESPVAR=1,$P($G(^ESP(912,ESPOFN,5)),U,2),$D(^XUSEC("ESP CHIEF",DUZ)) G CLO
"RTN","ESPOFFE",30,0)
 I ESPVAR=1,$D(^XUSEC("ESP CHIEF",DUZ)) G COMP
"RTN","ESPOFFE",31,0)
 G EXIT
"RTN","ESPOFFE",32,0)
EDIT ;CALL DIE TO EDIT OFFENSE REPORT
"RTN","ESPOFFE",33,0)
 S DIE="^ESP(912,",DA=ESPOFN,DR="[ESP OFFENSE REPORT EDIT 1"
"RTN","ESPOFFE",34,0)
 L +^ESP(912,DA):1 I '$T W !,"Another user is editing this record!!" G EXIT
"RTN","ESPOFFE",35,0)
 D ^DIE
"RTN","ESPOFFE",36,0)
 S DIE="^ESP(912,",DA=ESPOFN,DR="[ESP OFFENSE REPORT EDIT 2"
"RTN","ESPOFFE",37,0)
 D ^DIE
"RTN","ESPOFFE",38,0)
 S DIE="^ESP(912,",DA=ESPOFN,DR="[ESP OFFENSE REPORT EDIT 3"
"RTN","ESPOFFE",39,0)
 D ^DIE
"RTN","ESPOFFE",40,0)
 S DIE="^ESP(912,",DA=ESPOFN,DR="[ESP OFFENSE REPORT 4"
"RTN","ESPOFFE",41,0)
 D ^DIE
"RTN","ESPOFFE",42,0)
 S DIE="^ESP(912,",DA=ESPOFN,DR="[ESP OFFENSE REPORT 5"
"RTN","ESPOFFE",43,0)
 D ^DIE
"RTN","ESPOFFE",44,0)
 I ESPVAR=0!(ESPVAR=3) G COMP
"RTN","ESPOFFE",45,0)
 I ESPVAR=1,$P($G(^ESP(912,ESPOFN,5)),U,2),$D(^XUSEC("ESP CHIEF",DUZ)) G CLO
"RTN","ESPOFFE",46,0)
 I ESPVAR=2 G CLO
"RTN","ESPOFFE",47,0)
 G EXIT
"RTN","ESPOFFE",48,0)
COMP ;ASK IF WANT TO COMPLETE REPORT OR NOT
"RTN","ESPOFFE",49,0)
 W !! S DIR(0)="Y",DIR("A")="Is the report completed",DIR("?")="Answer YES or NO.",DIR("??")="^W !,""Answer NO if you don't wish to complete the report at this time.  Answer YES if you do."""
"RTN","ESPOFFE",50,0)
 D ^DIR K DIR
"RTN","ESPOFFE",51,0)
 I 'Y!($D(DIRUT)) G EXIT
"RTN","ESPOFFE",52,0)
 D ^ESPVAL
"RTN","ESPOFFE",53,0)
 I $P(^ESP(912,ESPOFN,5),U,2) D SEND
"RTN","ESPOFFE",54,0)
 G EXIT
"RTN","ESPOFFE",55,0)
CLO ;ASK IF WANT TO CLOSE THE REPORT
"RTN","ESPOFFE",56,0)
 I ('$D(^XUSEC("ESP CHIEF",DUZ))&'$D(^XUSEC("ESP SUPERVISOR",DUZ))) G EXIT
"RTN","ESPOFFE",57,0)
 I ESPVAR=4 D SAT I UNSAT G EXIT
"RTN","ESPOFFE",58,0)
 G:$D(DTOUT) EXIT
"RTN","ESPOFFE",59,0)
 I '$P(^ESP(912,ESPOFN,5),U,2) W !!,$C(7),"The report must be completed before closing!" G EXIT
"RTN","ESPOFFE",60,0)
CLO1 ;entry point from 'close an offense report' option
"RTN","ESPOFFE",61,0)
 S DIR(0)="Y",DIR("A")="Do you want to close the report",DIR("?")="Answer YES or NO.",DIR("??")="^W !,""Answer NO if you don't want to close the report.  Answer YES if you do."""
"RTN","ESPOFFE",62,0)
 D ^DIR K DIR
"RTN","ESPOFFE",63,0)
 I 'Y!($D(DIRUT)) G EXIT
"RTN","ESPOFFE",64,0)
 I Y S $P(^ESP(912,ESPOFN,0),U,8)="C" W !!,"The report is now closed."
"RTN","ESPOFFE",65,0)
 L -^ESP(912,ESPOFN)
"RTN","ESPOFFE",66,0)
EXIT K %ZIS,DA,DIC,DIE,DIR,DIRUT,DR,DTOUT,DUOUT,ESPDTR,ESPID,ESPN,ESPNO,ESPOFN,ESPVAR,ESPY,POP,UNSAT,Y,ZTDESC,ZTRTN,ZTSAVE Q
"RTN","ESPOFFE",67,0)
SEND S ESPDTR=$P(^ESP(912,ESPOFN,0),U,2),XMB(1)=$$CONV^ESPUOR(ESPDTR),XMB(2)=$P($G(^VA(200,+$P(^ESP(912,ESPOFN,0),U,6),0)),U),XMB(3)=$P($G(^VA(200,+$P($G(^ESP(912,ESPOFN,5)),U,3),0)),U)
"RTN","ESPOFFE",68,0)
 S XMB="ESP UOR COMPLETED" D EN^XMB
"RTN","ESPOFFE",69,0)
 QUIT
"RTN","ESPOFFE",70,0)
ASK2 ;CALLED FROM ESPOFFC- COMPLETE A REPORT
"RTN","ESPOFFE",71,0)
 S DIR(0)="Y",DIR("A")="Do you want to print the report first",DIR("B")="NO" D ^DIR K DIR
"RTN","ESPOFFE",72,0)
 I $D(DTOUT) W $C(7) G EXIT
"RTN","ESPOFFE",73,0)
 I 'Y G OK
"RTN","ESPOFFE",74,0)
 G PRT
"RTN","ESPOFFE",75,0)
SAT ;ASK IF REPORT IS COMPLETED FULLY AND SEND BULLETIN TO OFFICER 
"RTN","ESPOFFE",76,0)
 ;IF ADDITIONAL INFO NEEDED
"RTN","ESPOFFE",77,0)
 S UNSAT=0
"RTN","ESPOFFE",78,0)
 S DIR(0)="Y",DIR("A")="Is the report completed fully",DIR("B")="YES" D ^DIR K DIR
"RTN","ESPOFFE",79,0)
 Q:Y!($D(DIRUT))
"RTN","ESPOFFE",80,0)
 S ESPDTR=$P(^ESP(912,ESPOFN,0),U,2),XMB(1)=$$CONV^ESPUOR(ESPDTR),XMB="ESP SUPERVISOR REVIEW",XMY($P(^ESP(912,ESPOFN,0),U,6))="" D EN^XMB
"RTN","ESPOFFE",81,0)
 S UNSAT=1
"RTN","ESPOFFE",82,0)
 Q
"RTN","ESPORP5")
0^2^B12264549
"RTN","ESPORP5",1,0)
ESPORP5 ;DALISC/CKA - PRINT OFFENSE REPORT CONT. ;10/92
"RTN","ESPORP5",2,0)
 ;;1.0;POLICE & SECURITY;**11,14,17,21**;Mar 31, 1994
"RTN","ESPORP5",3,0)
EN ;CONTINUED FROM ESPORP4
"RTN","ESPORP5",4,0)
NARR ;PRINT NARRATIVE
"RTN","ESPORP5",5,0)
 D MIN^ESPORP(10) G:END EXIT
"RTN","ESPORP5",6,0)
 K ^UTILITY($J,"W") S DIWL=3,DIWR=78,DIWF="W",IEN=0 D LINES^ESPORP(2) G:END EXIT
"RTN","ESPORP5",7,0)
 F I=1:1:18 W "* "
"RTN","ESPORP5",8,0)
 W "NARRATIVE" F I=1:1:17 W " *"
"RTN","ESPORP5",9,0)
 D LINES^ESPORP(2) Q:END  W ?10,"ORIGIN:" D LINES^ESPORP(2) Q:END
"RTN","ESPORP5",10,0)
 F ESPN=1:1 S IEN=$O(^ESP(912,ESPID,70,IEN)) Q:IEN'>0  S X=^(IEN,0) D  Q:END
"RTN","ESPORP5",11,0)
 .  D:($Y+2>IOSL) HDR^ESPORP Q:END
"RTN","ESPORP5",12,0)
 .  D ^DIWP
"RTN","ESPORP5",13,0)
 G:END EXIT
"RTN","ESPORP5",14,0)
 D ^DIWW
"RTN","ESPORP5",15,0)
 K ^UTILITY($J,"W") S DIWL=3,DIWR=78,DIWF="W",IEN=0
"RTN","ESPORP5",16,0)
 D MIN^ESPORP(2) G:END EXIT
"RTN","ESPORP5",17,0)
 D LINES^ESPORP(2) G:END EXIT W ?10,"INITIAL OBSERVATION:" D LINES^ESPORP(2) G:END EXIT
"RTN","ESPORP5",18,0)
 F ESPN=1:1 S IEN=$O(^ESP(912,ESPID,72,IEN)) Q:IEN'>0  S X=^(IEN,0) D  Q:END
"RTN","ESPORP5",19,0)
 .  D:($Y+2>IOSL) HDR^ESPORP Q:END
"RTN","ESPORP5",20,0)
 .  D ^DIWP
"RTN","ESPORP5",21,0)
 G:END EXIT
"RTN","ESPORP5",22,0)
 D ^DIWW
"RTN","ESPORP5",23,0)
 ;
"RTN","ESPORP5",24,0)
 K ^UTILITY($J,"W") S DIWL=3,DIWR=78,DIWF="W",IEN=0
"RTN","ESPORP5",25,0)
 D MIN^ESPORP(8) G:END EXIT
"RTN","ESPORP5",26,0)
 D LINES^ESPORP(2) G:END EXIT W ?10,"INVESTIGATION:" D LINES^ESPORP(2) G:END EXIT
"RTN","ESPORP5",27,0)
 F ESON=1:1 S IEN=$O(^ESP(912,ESPID,73,IEN)) Q:IEN'>0  S X=^(IEN,0) D  Q:END
"RTN","ESPORP5",28,0)
 .  D:($Y+2>IOSL) HDR^ESPORP Q:END
"RTN","ESPORP5",29,0)
 .  D ^DIWP
"RTN","ESPORP5",30,0)
 G:END EXIT
"RTN","ESPORP5",31,0)
 D ^DIWW
"RTN","ESPORP5",32,0)
 ;
"RTN","ESPORP5",33,0)
 K ^UTILITY($J,"W") S DIWL=3,DIWR=78,DIWF="W",IEN=0
"RTN","ESPORP5",34,0)
 D MIN^ESPORP(10) G:END EXIT
"RTN","ESPORP5",35,0)
 D LINES^ESPORP(2) G:END EXIT W ?10,"DISPOSITION:" D LINES^ESPORP(2) G:END EXIT
"RTN","ESPORP5",36,0)
 F ESPN=1:1 S IEN=$O(^ESP(912,ESPID,74,IEN)) Q:IEN'>0  S X=^(IEN,0) D  Q:END
"RTN","ESPORP5",37,0)
 .  D:($Y+2>IOSL) HDR^ESPORP Q:END
"RTN","ESPORP5",38,0)
 .  D ^DIWP
"RTN","ESPORP5",39,0)
 G:END EXIT
"RTN","ESPORP5",40,0)
 D ^DIWW
"RTN","ESPORP5",41,0)
SIG D MIN^ESPORP(5) G:END EXIT
"RTN","ESPORP5",42,0)
 D LINES^ESPORP(5) G:END EXIT
"RTN","ESPORP5",43,0)
 S DIC="^ESP(912,",DA=ESPID,DR=".06",DIQ(0)="I" D EN^DIQ1
"RTN","ESPORP5",44,0)
 S ESPOFF=$G(^UTILITY("DIQ1",$J,912,DA,.06,"I"))
"RTN","ESPORP5",45,0)
 G:ESPOFF']"" FOL
"RTN","ESPORP5",46,0)
 S DIC="^VA(200,",DA=ESPOFF,DR="20.2;910.1",DIQ(0)="E" D EN^DIQ1
"RTN","ESPORP5",47,0)
 D LINES^ESPORP() G:END EXIT
"RTN","ESPORP5",48,0)
 W $G(^UTILITY("DIQ1",$J,200,DA,20.2,"E")),"   # ",$G(^UTILITY("DIQ1",$J,200,DA,910.1,"E"))
"RTN","ESPORP5",49,0)
 D LINES^ESPORP() G:END EXIT  W "INVESTIGATING OFFICER"
"RTN","ESPORP5",50,0)
FOL ;PRINT FOLLOW-UP NOTES
"RTN","ESPORP5",51,0)
 G:'$D(^ESP(912,ESPID,130)) EXIT
"RTN","ESPORP5",52,0)
 D HDR^ESPORP G:END EXIT
"RTN","ESPORP5",53,0)
 F ESPN=0:0 S ESPN=$O(^ESP(912,ESPID,130,ESPN)) Q:ESPN'>0!(END)  D
"RTN","ESPORP5",54,0)
 .  D HDR^ESPORP:$Y+10>IOSL&(ESPN'=1) Q:END
"RTN","ESPORP5",55,0)
 .  D LINES^ESPORP(1) Q:END  W "FOLLOW-UP NOTES:" D LINES^ESPORP(2) Q:END
"RTN","ESPORP5",56,0)
 .  K ^UTILITY($J,"W") S DIWL=3,DIWR=78,DIWF="W",IEN=0
"RTN","ESPORP5",57,0)
 .  F ESPN1=1:1 S IEN=$O(^ESP(912,ESPID,130,ESPN,10,IEN)) Q:IEN'>0  S X=^(IEN,0) D  Q:END
"RTN","ESPORP5",58,0)
 .  .  D:($Y+2>IOSL) HDR^ESPORP Q:END
"RTN","ESPORP5",59,0)
 .  .  D ^DIWP
"RTN","ESPORP5",60,0)
 .  Q:END
"RTN","ESPORP5",61,0)
 .  D ^DIWW
"RTN","ESPORP5",62,0)
 .  S DIC="^ESP(912,"_ESPID_",130,",DA=ESPN,DR=".01",DIQ(0)="I" D EN^DIQ1
"RTN","ESPORP5",63,0)
 .  S ESPOFF=$G(^UTILITY("DIQ1",$J,912.17,DA,.01,"I"))
"RTN","ESPORP5",64,0)
 .  Q:ESPOFF']""
"RTN","ESPORP5",65,0)
 .  S DIC="^VA(200,",DA=ESPOFF,DR="20.2;910.1",DIQ(0)="E" D EN^DIQ1
"RTN","ESPORP5",66,0)
 .  D LINES^ESPORP(5) Q:END
"RTN","ESPORP5",67,0)
 .  W $G(^UTILITY("DIQ1",$J,200,DA,20.2,"E")),"   # ",$G(^UTILITY("DIQ1",$J,200,DA,910.1,"E"))
"RTN","ESPORP5",68,0)
 .  D LINES^ESPORP(1) Q:END
"RTN","ESPORP5",69,0)
 .  W "FOLLOW-UP INVESTIGATOR"
"RTN","ESPORP5",70,0)
 .  D LINES^ESPORP(5) Q:END
"RTN","ESPORP5",71,0)
EXIT I IO'=IO(0) D ^%ZISC
"RTN","ESPORP5",72,0)
 D HOME^%ZIS
"RTN","ESPORP5",73,0)
 K CL,DA,DIC,DIQ,DIR,DIRUT,DIWF,DIWL,DIWR,ESPDOB,ESPDOBP,DR,DTOUT,DUOUT,END,ESPDTR,ESPID,ESPFN,ESON,ESPN,ESPN1,ESPOFF,IEN,PAGE,SSN,X,Y,Z,POP
"RTN","ESPORP5",74,0)
 K ^UTILITY("DIQ1",$J)
"RTN","ESPORP5",75,0)
 Q
"RTN","ESPQNC")
0^3^B29226187
"RTN","ESPQNC",1,0)
ESPQNC ;DALISC/CKA - QUICK NAME CHECK ;2/93
"RTN","ESPQNC",2,0)
 ;;1.0;POLICE & SECURITY;**2,18,21**;Mar 31, 1994
"RTN","ESPQNC",3,0)
START W !! S DIC("A")="Select Name: ",DIC="^ESP(910,",DIC(0)="AEMQZ" D ^DIC I Y<0 G EXIT
"RTN","ESPQNC",4,0)
 S ESPNAM=+Y W !?5,"SEX: ",$P(^ESP(910,ESPNAM,0),"^",8),?20,"RACE: ",$S($D(^DIC(10,+$P(^(0),"^",9),0)):$P(^DIC(10,+$P(^ESP(910,ESPNAM,0),"^",9),0),"^",1),1:""),!!
"RTN","ESPQNC",5,0)
 S ESPN=0,ESPCNT=0,ESPSTP=0,ESPLAST=0
"RTN","ESPQNC",6,0)
 S ESPL=9
"RTN","ESPQNC",7,0)
REG ;
"RTN","ESPQNC",8,0)
 S ESPI=0 F ESPI1=1:1 S ESPI=$O(^ESP(910.2,"D",ESPNAM,ESPI)) Q:ESPI=""!ESPSTP  D
"RTN","ESPQNC",9,0)
 .  S ESPN=ESPN+1,ESPCNT=ESPCNT+1 W !?5,ESPN,". " S REG0=^ESP(910.2,ESPI,0),ESPREG(ESPN)=ESPI W $P("VEHICLE^BICYCLE^WEAPON^PET^GOLF","^",$P(REG0,"^",4))," REGISTRATION ",$P(REG0,"^",1)," ",$P($G(^ESP(910.7,+$P(REG0,"^",2),0)),U)
"RTN","ESPQNC",10,0)
 .  I ESPCNT>ESPL S ESPR=ESPN D SELX
"RTN","ESPQNC",11,0)
 S ESPR=$G(ESPN)
"RTN","ESPQNC",12,0)
 G:ESPSTP START
"RTN","ESPQNC",13,0)
VIO ;
"RTN","ESPQNC",14,0)
 S ESPJ=0 F ESPJ1=1:1 S ESPJ=$O(^ESP(914,"E",ESPNAM,ESPJ)) Q:ESPJ=""!ESPSTP  D
"RTN","ESPQNC",15,0)
 .  S ESPN=ESPN+1,ESPCNT=ESPCNT+1 W !?5,ESPN,". VIOLATION-" S VIO0=^ESP(914,ESPJ,0),ESPVIO(ESPN)=ESPJ S Y=$P(^(0),U,2) X ^DD("DD") W "  ",Y W " ",$P($G(^ESP(915,$P(^ESP(914,ESPJ,0),U,4),0)),U)
"RTN","ESPQNC",16,0)
 .  I ESPCNT>ESPL S ESPV=ESPN D SELX
"RTN","ESPQNC",17,0)
 S ESPV=$G(ESPN)
"RTN","ESPQNC",18,0)
 G:ESPSTP START
"RTN","ESPQNC",19,0)
OFF ;
"RTN","ESPQNC",20,0)
 S ESPI=0 F ESPI1=1:1 S ESPI=$O(^ESP(912,"D",ESPNAM,ESPI)) Q:ESPI=""!ESPSTP  D
"RTN","ESPQNC",21,0)
 .  S OFF0=^ESP(912,ESPI,0) I $P(^(5),U,2),$P(^(5),U,5),'$P(^(5),U,4) S ESPN=ESPN+1,ESPCNT=ESPCNT+1 W !?5,ESPN,". OFFENSE COMPLAINANT- " S (ESPDTR,X)=$P(^ESP(912,ESPI,0),U,2) W $$CONV^ESPUOR(X) D CL S ESPOFF(ESPN)=ESPI
"RTN","ESPQNC",22,0)
 .  I ESPCNT>ESPL S ESPO=ESPN D SELX
"RTN","ESPQNC",23,0)
 G:ESPSTP START
"RTN","ESPQNC",24,0)
 S ESPI=0 F ESPI1=1:1 S ESPI=$O(^ESP(912,"E",ESPNAM,ESPI)) Q:ESPI=""!ESPSTP  D
"RTN","ESPQNC",25,0)
 .  I $P(^ESP(912,ESPI,5),U,2),$P(^(5),U,5),'$P(^(5),U,4) S ESPN=ESPN+1,ESPCNT=ESPCNT+1 W !?5,ESPN,". OFFENSE VICTIM- " S (ESPDTR,X)=$P(^ESP(912,ESPI,0),U,2) W $$CONV^ESPUOR(X) D CL S ESPOFF(ESPN)=ESPI
"RTN","ESPQNC",26,0)
 .  I ESPCNT>ESPL S ESPO=ESPN D SELX
"RTN","ESPQNC",27,0)
 G:ESPSTP START
"RTN","ESPQNC",28,0)
 S ESPI=0 F ESPI1=1:1 S ESPI=$O(^ESP(912,"G",ESPNAM,ESPI)) Q:ESPI=""!ESPSTP  D
"RTN","ESPQNC",29,0)
 .  I $P(^ESP(912,ESPI,5),U,2),$P(^(5),U,5),'$P(^(5),U,4) S ESPN=ESPN+1,ESPCNT=ESPCNT+1 W !?5,ESPN,". OFFENSE OFFENDER- " S (ESPDTR,X)=$P(^ESP(912,ESPI,0),U,2) W $$CONV^ESPUOR(X) D CL S ESPOFF(ESPN)=ESPI
"RTN","ESPQNC",30,0)
 .  I ESPCNT>ESPL S ESPO=ESPN D SELX
"RTN","ESPQNC",31,0)
 G:ESPSTP START
"RTN","ESPQNC",32,0)
 S ESPI=0 F ESPI1=1:1 S ESPI=$O(^ESP(912,"I",ESPNAM,ESPI)) Q:ESPI=""!ESPSTP  D
"RTN","ESPQNC",33,0)
 .  I $P(^ESP(912,ESPI,5),U,2),$P(^(5),U,5),'$P(^(5),U,4) S ESPN=ESPN+1,ESPCNT=ESPCNT+1 W !?5,ESPN,". OFFENSE WITNESS- " S (ESPDTR,X)=$P(^ESP(912,ESPI,0),U,2) W $$CONV^ESPUOR(X) D CL S ESPOFF(ESPN)=ESPI
"RTN","ESPQNC",34,0)
 .  I ESPCNT>ESPL S ESPO=ESPN D SELX
"RTN","ESPQNC",35,0)
 S ESPO=$G(ESPN)
"RTN","ESPQNC",36,0)
 G:ESPSTP START
"RTN","ESPQNC",37,0)
WAR ;
"RTN","ESPQNC",38,0)
 S ESPI=0 F ESPI1=1:1 S ESPI=$O(^ESP(913,"B",ESPNAM,ESPI)) Q:ESPI=""!ESPSTP  D
"RTN","ESPQNC",39,0)
 .  S ESPN=ESPN+1,ESPCNT=ESPCNT+1 W !?5,ESPN,". " S WAR0=^ESP(913,ESPI,0),ESPWAR(ESPN)=ESPI W "WANT OR WARRANT " S Y=$P(WAR0,U) X ^DD("DD") W Y," ",$P(WAR0,U,6)
"RTN","ESPQNC",40,0)
 .  I ESPCNT>ESPL S ESPW=ESPN D SELX
"RTN","ESPQNC",41,0)
 S ESPW=$G(ESPN)
"RTN","ESPQNC",42,0)
 G:ESPSTP START
"RTN","ESPQNC",43,0)
EVID ;
"RTN","ESPQNC",44,0)
 S ESPI=0 F ESPI1=1:1 S ESPI=$O(^ESP(910.8,"C",ESPNAM,ESPI)) Q:ESPI=""!ESPSTP  D
"RTN","ESPQNC",45,0)
 . S EVI0=^ESP(910.8,ESPI,0) I '$P(^(0),U,4) S ESPN=ESPN+1,ESPEVI(ESPN)=ESPI,ESPCNT=ESPCNT+1 W !?5,ESPN,". EVIDENCE RECORD NUMBER ",$P(^(0),U)," ",$P($G(^ESP(910.8,ESPI,10)),U)
"RTN","ESPQNC",46,0)
 . I ESPCNT>ESPL S ESPE=ESPN D SELX
"RTN","ESPQNC",47,0)
 S ESPE=$G(ESPN)
"RTN","ESPQNC",48,0)
 G:ESPSTP START
"RTN","ESPQNC",49,0)
 S ESPN=$G(ESPN)+1,ESPCNT=ESPCNT+1 W !?5,ESPN,". " W "MASTER NAME INDEX RECORD" S ESPLAST=1
"RTN","ESPQNC",50,0)
 D SELX
"RTN","ESPQNC",51,0)
 G START
"RTN","ESPQNC",52,0)
 ;
"RTN","ESPQNC",53,0)
SELX ;
"RTN","ESPQNC",54,0)
 Q:ESPSTP  W ! S DIR(0)="NO^1:"_ESPN,DIR("A")="Select a number for viewing, ^ to exit"
"RTN","ESPQNC",55,0)
 I 'ESPLAST S DIR("A")=DIR("A")_", <RETURN> for more"
"RTN","ESPQNC",56,0)
 D ^DIR S ESPX=X W !
"RTN","ESPQNC",57,0)
 I $D(DTOUT) S ESPSTP=1 Q
"RTN","ESPQNC",58,0)
 I X="^" S ESPSTP=1 Q
"RTN","ESPQNC",59,0)
 I X=""&'ESPLAST S ESPSTP=0,ESPCNT=0 Q
"RTN","ESPQNC",60,0)
 I X=""&ESPLAST S ESPSTP=1 Q
"RTN","ESPQNC",61,0)
 S ESPSTP=1
"RTN","ESPQNC",62,0)
 S %ZIS="Q" D ^%ZIS I POP S ESPSTP=1 Q
"RTN","ESPQNC",63,0)
 I '$D(IO("Q")) U IO D DISP D:IO'=IO(0) ^%ZISC Q
"RTN","ESPQNC",64,0)
 S ZTRTN="DISP^ESPQNC",ZTSAVE("ESP*")="",ZTDESC="QUICK NAME CHECK" D ^%ZTLOAD,HOME^%ZIS
"RTN","ESPQNC",65,0)
 Q
"RTN","ESPQNC",66,0)
 ;
"RTN","ESPQNC",67,0)
DISP ;
"RTN","ESPQNC",68,0)
 I ESPX<ESPR!(ESPX=ESPR) S DA=ESPREG(ESPX),DIC="^ESP(910.2," D EN^DIQ Q
"RTN","ESPQNC",69,0)
 I ESPX>ESPR,ESPX<ESPV!(ESPX=ESPV) S ESPID=ESPVIO(ESPX) D START^ESPVNP Q
"RTN","ESPQNC",70,0)
 I ESPX>ESPV,ESPX<ESPO!(ESPX=ESPO) S ESPID=ESPOFF(ESPX),ESPDTR=$P(^ESP(912,ESPID,0),U,2) D START^ESPORP Q
"RTN","ESPQNC",71,0)
 I ESPX>ESPO,ESPX<ESPW!(ESPX=ESPW) S DA=ESPWAR(ESPX),DIC="^ESP(913," D EN^DIQ Q
"RTN","ESPQNC",72,0)
 I ESPX>ESPW,ESPX<ESPE!(ESPX=ESPE) S DA=ESPEVI(ESPX),DIC="^ESP(910.8," D EN^DIQ Q
"RTN","ESPQNC",73,0)
 I ESPX=ESPN S DA=ESPNAM,DIC="^ESP(910," D EN^DIQ Q
"RTN","ESPQNC",74,0)
 ;
"RTN","ESPQNC",75,0)
EXIT ;
"RTN","ESPQNC",76,0)
 K %ZIS,DA,DIC,DIQ,DIR,DR,DTOUT,ESPDTR,ESPE,ESPEVI,ESPFN,ESPI,ESPI1,ESPID,ESPJ,ESPJ1,ESPN,ESPNAM,ESPO,ESPOFF,ESPR,ESPREG,ESPV,ESPVIO,ESPW,ESPWAR,ESPX,ESPZ,EVI0,OFF0,REG0,VIO0,WAR0,X,Y,ESPCNT,ESPSTP,ESPL,ESPLAST
"RTN","ESPQNC",77,0)
 Q
"RTN","ESPQNC",78,0)
 ;
"RTN","ESPQNC",79,0)
CL ;PRINT CLASSIFICATION CODES, TYPES, AND SUBTYPES
"RTN","ESPQNC",80,0)
 F ESPZ=0:0 S ESPZ=$O(^ESP(912,ESPI,10,ESPZ)) Q:ESPZ'>0  D
"RTN","ESPQNC",81,0)
 .  S DIC="^ESP(912,"_ESPI_",10,",DA=ESPZ,DR=".01;.02;.03",DIQ(0)="E" D EN^DIQ1 Q:'$D(^UTILITY("DIQ1",$J,912.01,DA,.01,"E"))
"RTN","ESPQNC",82,0)
 .  W "  ",$G(^UTILITY("DIQ1",$J,912.01,DA,.01,"E"))
"RTN","ESPQNC",83,0)
 .  I $G(^UTILITY("DIQ1",$J,912.01,DA,.02,"E"))]"" W "/",^("E")
"RTN","ESPQNC",84,0)
 .  I $G(^UTILITY("DIQ1",$J,912.01,DA,.03,"E"))]"" W "/",^("E")
"RTN","ESPQNC",85,0)
 .  K DIC,DR
"RTN","ESPQNC",86,0)
 QUIT
"VER")
8.0^21.0
"^DD",910,910,.04,0)
CATEGORY^RS^P:PATIENT;V:VISITOR;E:EMPLOYEE;O:OTHER;PO:POLICE OFFICER;^0;4^Q
"^DD",910,910,.04,3)
Enter 'P' for Patient, 'V' for Visitor, 'E' for Employee, or 'O' for Other or 'PO' for Police Officer.
"^DD",910,910,.04,21,0)
^^2^2^2980226^^^^
"^DD",910,910,.04,21,1,0)
Enter 'P' for Patient, 'V' for Visitor, 'E' for Employee, 
"^DD",910,910,.04,21,2,0)
'PO' for Police Officer, or 'O' for Other.
"^DD",910,910,.04,"DT")
2980226
**END**
**END**
