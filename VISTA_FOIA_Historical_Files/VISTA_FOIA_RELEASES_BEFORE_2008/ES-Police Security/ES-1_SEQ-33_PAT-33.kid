Released ES*1*33 SEQ #33
Extracted from mail message
**KIDS**:ES*1.0*33^

**INSTALL NAME**
ES*1.0*33
"BLD",4307,0)
ES*1.0*33^POLICE & SECURITY^0^3030724^y
"BLD",4307,1,0)
^^1^1^3030722^^^^
"BLD",4307,1,1,0)
Problem with external to internal date conversion.
"BLD",4307,4,0)
^9.64PA^910.2^3
"BLD",4307,4,910.2,0)
910.2
"BLD",4307,4,910.2,2,0)
^9.641^910.2^1
"BLD",4307,4,910.2,2,910.2,0)
ESP POLICE REGISTRATION LOG  (File-top level)
"BLD",4307,4,910.2,2,910.2,1,0)
^9.6411^.05^1
"BLD",4307,4,910.2,2,910.2,1,.05,0)
DATE ASSIGNED
"BLD",4307,4,910.2,222)
y^n^p^^^^n^^n
"BLD",4307,4,910.2,224)

"BLD",4307,4,913,0)
913
"BLD",4307,4,913,2,0)
^9.641^913^1
"BLD",4307,4,913,2,913,0)
ESP WANTS & WARRANTS  (File-top level)
"BLD",4307,4,913,2,913,1,0)
^9.6411^1.04^1
"BLD",4307,4,913,2,913,1,1.04,0)
WARRANT DATE
"BLD",4307,4,913,222)
y^n^p^^^^n^^n
"BLD",4307,4,913,224)

"BLD",4307,4,914,0)
914
"BLD",4307,4,914,2,0)
^9.641^914^1
"BLD",4307,4,914,2,914,0)
ESP VIOLATIONS  (File-top level)
"BLD",4307,4,914,2,914,1,0)
^9.6411^.02^1
"BLD",4307,4,914,2,914,1,.02,0)
DATE/TIME OF OFFENSE
"BLD",4307,4,914,222)
y^n^p^^^^n^^n
"BLD",4307,4,914,224)

"BLD",4307,4,"APDD",910.2,910.2)

"BLD",4307,4,"APDD",910.2,910.2,.05)

"BLD",4307,4,"APDD",913,913)

"BLD",4307,4,"APDD",913,913,1.04)

"BLD",4307,4,"APDD",914,914)

"BLD",4307,4,"APDD",914,914,.02)

"BLD",4307,4,"B",910.2,910.2)

"BLD",4307,4,"B",913,913)

"BLD",4307,4,"B",914,914)

"BLD",4307,"ABPKG")
n
"BLD",4307,"KRN",0)
^9.67PA^8989.52^19
"BLD",4307,"KRN",.4,0)
.4
"BLD",4307,"KRN",.401,0)
.401
"BLD",4307,"KRN",.402,0)
.402
"BLD",4307,"KRN",.403,0)
.403
"BLD",4307,"KRN",.5,0)
.5
"BLD",4307,"KRN",.84,0)
.84
"BLD",4307,"KRN",3.6,0)
3.6
"BLD",4307,"KRN",3.8,0)
3.8
"BLD",4307,"KRN",9.2,0)
9.2
"BLD",4307,"KRN",9.8,0)
9.8
"BLD",4307,"KRN",9.8,"NM",0)
^9.68A^3^3
"BLD",4307,"KRN",9.8,"NM",1,0)
ESPUCF^^0^B14074478
"BLD",4307,"KRN",9.8,"NM",2,0)
ESPUCR^^0^B14324046
"BLD",4307,"KRN",9.8,"NM",3,0)
ESPWR^^0^B10625695
"BLD",4307,"KRN",9.8,"NM","B","ESPUCF",1)

"BLD",4307,"KRN",9.8,"NM","B","ESPUCR",2)

"BLD",4307,"KRN",9.8,"NM","B","ESPWR",3)

"BLD",4307,"KRN",19,0)
19
"BLD",4307,"KRN",19,"NM",0)
^9.68A^1^1
"BLD",4307,"KRN",19,"NM",1,0)
ESP EVIDENCE/PROPERTY ADD/EDIT^^0
"BLD",4307,"KRN",19,"NM","B","ESP EVIDENCE/PROPERTY ADD/EDIT",1)

"BLD",4307,"KRN",19.1,0)
19.1
"BLD",4307,"KRN",19.1,"NM",0)
^9.68A^^
"BLD",4307,"KRN",101,0)
101
"BLD",4307,"KRN",409.61,0)
409.61
"BLD",4307,"KRN",771,0)
771
"BLD",4307,"KRN",870,0)
870
"BLD",4307,"KRN",8989.51,0)
8989.51
"BLD",4307,"KRN",8989.52,0)
8989.52
"BLD",4307,"KRN",8994,0)
8994
"BLD",4307,"KRN","B",.4,.4)

"BLD",4307,"KRN","B",.401,.401)

"BLD",4307,"KRN","B",.402,.402)

"BLD",4307,"KRN","B",.403,.403)

"BLD",4307,"KRN","B",.5,.5)

"BLD",4307,"KRN","B",.84,.84)

"BLD",4307,"KRN","B",3.6,3.6)

"BLD",4307,"KRN","B",3.8,3.8)

"BLD",4307,"KRN","B",9.2,9.2)

"BLD",4307,"KRN","B",9.8,9.8)

"BLD",4307,"KRN","B",19,19)

"BLD",4307,"KRN","B",19.1,19.1)

"BLD",4307,"KRN","B",101,101)

"BLD",4307,"KRN","B",409.61,409.61)

"BLD",4307,"KRN","B",771,771)

"BLD",4307,"KRN","B",870,870)

"BLD",4307,"KRN","B",8989.51,8989.51)

"BLD",4307,"KRN","B",8989.52,8989.52)

"BLD",4307,"KRN","B",8994,8994)

"BLD",4307,"QUES",0)
^9.62^^
"BLD",4307,"REQB",0)
^9.611^2^2
"BLD",4307,"REQB",1,0)
ES*1.0*22^1
"BLD",4307,"REQB",2,0)
ES*1.0*27^1
"BLD",4307,"REQB","B","ES*1.0*22",1)

"BLD",4307,"REQB","B","ES*1.0*27",2)

"FIA",910.2)
ESP POLICE REGISTRATION LOG
"FIA",910.2,0)
^ESP(910.2,
"FIA",910.2,0,0)
910.2I
"FIA",910.2,0,1)
y^n^p^^^^n^^n
"FIA",910.2,0,10)

"FIA",910.2,0,11)

"FIA",910.2,0,"RLRO")

"FIA",910.2,0,"VR")
1.0^ES
"FIA",910.2,910.2)
1
"FIA",910.2,910.2,.05)

"FIA",913)
ESP WANTS & WARRANTS
"FIA",913,0)
^ESP(913,
"FIA",913,0,0)
913P
"FIA",913,0,1)
y^n^p^^^^n^^n
"FIA",913,0,10)

"FIA",913,0,11)

"FIA",913,0,"RLRO")

"FIA",913,0,"VR")
1.0^ES
"FIA",913,913)
1
"FIA",913,913,1.04)

"FIA",914)
ESP VIOLATIONS
"FIA",914,0)
^ESP(914,
"FIA",914,0,0)
914I
"FIA",914,0,1)
y^n^p^^^^n^^n
"FIA",914,0,10)

"FIA",914,0,11)

"FIA",914,0,"RLRO")

"FIA",914,0,"VR")
1.0^ES
"FIA",914,914)
1
"FIA",914,914,.02)

"KRN",19,2922393,-1)
0^1
"KRN",19,2922393,0)
ESP EVIDENCE/PROPERTY ADD/EDIT^Create/Edit Evidence/Property Record^^E^^ESP EVIDENCE^^^^^^POLICE & SECURITY^^1^1
"KRN",19,2922393,1,0)
2^19.06^3^3^3030630^^^^
"KRN",19,2922393,1,1,0)
This submenu option allows for the adding or editing of an Evidence
"KRN",19,2922393,1,2,0)
or Property Custody Record.  This option is accessible only to those
"KRN",19,2922393,1,3,0)
members who have been assigned the ESP EVIDENCE key.
"KRN",19,2922393,15)
D ^ESPCLEAN
"KRN",19,2922393,20)
S DLAYGO=910.8
"KRN",19,2922393,30)
ESP(910.8,
"KRN",19,2922393,31)
AEMQLU
"KRN",19,2922393,50)
ESP(910.8,
"KRN",19,2922393,51)
[ESP EVIDENCE ADD/EDIT]
"KRN",19,2922393,99.1)
59164,46662
"KRN",19,2922393,"U")
CREATE/EDIT EVIDENCE/PROPERTY 
"MBREQ")
0
"ORD",18,19)
19;18;;;OPT^XPDTA;OPTF1^XPDIA;OPTE1^XPDIA;OPTF2^XPDIA;;OPTDEL^XPDIA
"ORD",18,19,0)
OPTION
"PKG",358,-1)
1^1
"PKG",358,0)
POLICE & SECURITY^ES^POLICE & SECURITY PACKAGE
"PKG",358,20,0)
^9.402P^^
"PKG",358,22,0)
^9.49I^1^1
"PKG",358,22,1,0)
1.0^2940331
"PKG",358,22,1,"PAH",1,0)
33^3030724
"PKG",358,22,1,"PAH",1,1,0)
^^1^1^3030724
"PKG",358,22,1,"PAH",1,1,1,0)
Problem with external to internal date conversion.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
3
"RTN","ESPUCF")
0^1^B14074478
"RTN","ESPUCF",1,0)
ESPUCF ;DALISC/CKA - UNIFORM CRIME REPORT BY FACILITY- 3/99
"RTN","ESPUCF",2,0)
 ;;1.0;POLICE & SECURITY;**27,33**; Mar 31, 1994
"RTN","ESPUCF",3,0)
START ;
"RTN","ESPUCF",4,0)
 I '$D(DUZ(2)) W !,"Site # is not defined!" G EX
"RTN","ESPUCF",5,0)
DATE ;ASK BEGINNING & ENDING DATE
"RTN","ESPUCF",6,0)
 D DT^DICRW K BEGDATE,ENDDATE W !!,"****  Date Range Selection  ****",!
"RTN","ESPUCF",7,0)
 S %DT="AE",%DT(0)="-NOW",%DT("A")="  Beginning DATE : " D ^%DT K %DT
"RTN","ESPUCF",8,0)
 G:Y<0 EX
"RTN","ESPUCF",9,0)
 S (BEGDATE,ESPBD)=Y
"RTN","ESPUCF",10,0)
 W ! S %DT="AE",%DT("A")="   Ending DATE: " D ^%DT
"RTN","ESPUCF",11,0)
 G:$D(DTOUT) EX
"RTN","ESPUCF",12,0)
 G:Y<ESPBD HELP W ! S ENDDATE=Y,ESPED=Y+.9
"RTN","ESPUCF",13,0)
CREATE ;CREATE A NEW ENTRY IN CRIME DATA FILE
"RTN","ESPUCF",14,0)
 K DD,DO S DIC="^ESP(912.3,",DIC(0)="L",DLAYGO=912.3,X=ESPBD D FILE^DICN G:Y<0 EX S ESPIEN=+Y
"RTN","ESPUCF",15,0)
 L +^ESP(912.3,ESPIEN):1 I '$T W !,"This record is being edited by someone else."
"RTN","ESPUCF",16,0)
 S $P(^ESP(912.3,ESPIEN,0),U,2)=ENDDATE
"RTN","ESPUCF",17,0)
 S:'$D(^ESP(912.3,ESPIEN,1,0)) ^(0)="^912.31^"
"RTN","ESPUCF",18,0)
COUNT ;GO THROUGH "C" X-REF TO COUNT AND GET TOTALS
"RTN","ESPUCF",19,0)
 S ESPDT=ESPBD-.0005
"RTN","ESPUCF",20,0)
 F ESPI=1:1 S ESPDT=$O(^ESP(912,"C",ESPDT)) Q:ESPDT>ESPED!(ESPDT'>0)  D
"RTN","ESPUCF",21,0)
 .S ESPOFN=0
"RTN","ESPUCF",22,0)
 .F ESPJ=1:1 S ESPOFN=$O(^ESP(912,"C",ESPDT,ESPOFN)) Q:ESPOFN'>0  D
"RTN","ESPUCF",23,0)
 ..I $D(^ESP(912,ESPOFN,5)) Q:'$P(^ESP(912,ESPOFN,5),U,5)
"RTN","ESPUCF",24,0)
 ..S ESPINS=$P(^ESP(912,ESPOFN,0),U,7) Q:+ESPINS'>0
"RTN","ESPUCF",25,0)
 ..I '$D(^ESP(912.3,ESPIEN,1,ESPINS)) D
"RTN","ESPUCF",26,0)
 ...S ^ESP(912.3,ESPIEN,1,ESPINS,0)=ESPINS
"RTN","ESPUCF",27,0)
 ...F ESPX=1:1:188 S ^ESP(912.3,ESPIEN,1,ESPINS,ESPX)=0
"RTN","ESPUCF",28,0)
 ...F ESPX=133.1,134.1,138.1,139.1 S ^ESP(912.3,ESPIEN,1,ESPINS,ESPX)=0
"RTN","ESPUCF",29,0)
 ..S ESPCN=0
"RTN","ESPUCF",30,0)
 ..F ESPZ=1:1 S ESPCN=$O(^ESP(912,ESPOFN,10,ESPCN)) Q:ESPCN'>0  D SET^ESPUCF1
"RTN","ESPUCF",31,0)
VIO ;GO THROUGH "C" X-REF VIOLATION FILE TO COUNT AND GET TOTALS
"RTN","ESPUCF",32,0)
 S ESPDT=ESPBD-.0005
"RTN","ESPUCF",33,0)
 F ESPI=1:1 S ESPDT=$O(^ESP(914,"C",ESPDT)) Q:ESPDT>ESPED!(ESPDT'>0)  D
"RTN","ESPUCF",34,0)
 .  S ESPOFN=0
"RTN","ESPUCF",35,0)
 .  F ESPJ=1:1 S ESPOFN=$O(^ESP(914,"C",ESPDT,ESPOFN)) Q:ESPOFN'>0  D
"RTN","ESPUCF",36,0)
 ..  S ESPINS=$P(^ESP(914,ESPOFN,0),U,7) Q:+ESPINS'>0
"RTN","ESPUCF",37,0)
 ..  S ESPTYPE=$P(^ESP(914,ESPOFN,0),U,3),ESPOFF=$P(^(0),U,4),ESPCL=$P($G(^ESP(915,+ESPOFF,0)),U,4),ESPFN=$P(^ESP(914,ESPOFN,0),U,9),ESPCAT=$P($G(^ESP(910,+ESPFN,0)),U,4)
"RTN","ESPUCF",38,0)
 ..  S ^(171)=^ESP(912.3,ESPIEN,1,ESPINS,171)+1
"RTN","ESPUCF",39,0)
 ..  I ESPTYPE="C" S ^(172)=^ESP(912.3,ESPIEN,1,ESPINS,172)+1 D
"RTN","ESPUCF",40,0)
 ...  I ESPCL'="M",ESPCL'="P" S ^(173)=^ESP(912.3,ESPIEN,1,ESPINS,173)+1
"RTN","ESPUCF",41,0)
 ...  I ESPCL="M" S ^(174)=^ESP(912.3,ESPIEN,1,ESPINS,174)+1
"RTN","ESPUCF",42,0)
 ...  I ESPCL="P" S ^(175)=^ESP(912.3,ESPIEN,1,ESPINS,175)+1
"RTN","ESPUCF",43,0)
 ...  I ESPCAT="E"!(ESPCAT="PO") S ^(176)=^ESP(912.3,ESPIEN,1,ESPINS,176)+1
"RTN","ESPUCF",44,0)
 ...  I ESPCAT="O"!(ESPCAT="") S ^(177)=^ESP(912.3,ESPIEN,1,ESPINS,177)+1
"RTN","ESPUCF",45,0)
 ...  I ESPCAT="P" S ^(178)=^ESP(912.3,ESPIEN,1,ESPINS,178)+1
"RTN","ESPUCF",46,0)
 ...  I ESPCAT="V" S ^(179)=^ESP(912.3,ESPIEN,1,ESPINS,179)+1
"RTN","ESPUCF",47,0)
 ..  I ESPTYPE="V" S ^(180)=^ESP(912.3,ESPIEN,1,ESPINS,180)+1 D
"RTN","ESPUCF",48,0)
 ...  I ESPCL'="M",ESPCL'="P" S ^(181)=^ESP(912.3,ESPIEN,1,ESPINS,181)+1
"RTN","ESPUCF",49,0)
 ...  I ESPCL="M" S ^(182)=^ESP(912.3,ESPIEN,1,ESPINS,182)+1
"RTN","ESPUCF",50,0)
 ...  I ESPCL="P" S ^(183)=^ESP(912.3,ESPIEN,1,ESPINS,183)+1
"RTN","ESPUCF",51,0)
 ...  I ESPCAT="E"!(ESPCAT="PO") S ^(184)=^ESP(912.3,ESPIEN,1,ESPINS,184)+1
"RTN","ESPUCF",52,0)
 ...  I ESPCAT="O"!(ESPCAT="") S ^(185)=^ESP(912.3,ESPIEN,1,ESPINS,185)+1
"RTN","ESPUCF",53,0)
 ...  I ESPCAT="P" S ^(186)=^ESP(912.3,ESPIEN,1,ESPINS,186)+1
"RTN","ESPUCF",54,0)
 ...  I ESPCAT="V" S ^(187)=^ESP(912.3,ESPIEN,1,ESPINS,187)+1
"RTN","ESPUCF",55,0)
 L -^ESP(912.3,ESPIEN)
"RTN","ESPUCF",56,0)
 W !!,"Done."
"RTN","ESPUCF",57,0)
XREF ;
"RTN","ESPUCF",58,0)
 N DIK,DIR,X,Y,DA,DIE,DIC
"RTN","ESPUCF",59,0)
 S DIK="^ESP(912.3,",DA=ESPIEN
"RTN","ESPUCF",60,0)
 D IX1^DIK
"RTN","ESPUCF",61,0)
EX W:$D(DTOUT) $C(7)
"RTN","ESPUCF",62,0)
 K %DT,BEGDATE,DA,DD,DIC,DO,DTOUT,ENDDATE,ESPBD,ESPCAT,ESPCC,ESPCL,ESPCN,ESPDOL,ESPDT,ESPED,ESPFN,ESPI,ESPIEN,ESPINS,ESPJ,ESPOF,ESPOFF,ESPOFN,ESPSUB,ESPTYPE,ESPVIC,ESPVICT,ESPX,ESPZ,X,Y
"RTN","ESPUCF",63,0)
 QUIT
"RTN","ESPUCF",64,0)
 ;
"RTN","ESPUCF",65,0)
HELP W "??",!?5,"Ending date must not be before beginning date" G DATE
"RTN","ESPUCR")
0^2^B14324046
"RTN","ESPUCR",1,0)
ESPUCR ;DALISC/CKA - UNIFORM CRIME REPORT- 12/92
"RTN","ESPUCR",2,0)
 ;;1.0;POLICE & SECURITY;**17,22,33**;Mar 31, 1994
"RTN","ESPUCR",3,0)
START ;
"RTN","ESPUCR",4,0)
 I '$D(DUZ(2)) W !,"Site # is not defined!" G EX
"RTN","ESPUCR",5,0)
DATE ;ASK BEGINNING & ENDING DATE
"RTN","ESPUCR",6,0)
 D DT^DICRW K BEGDATE,ENDDATE W !!,"****  Date Range Selection  ****",!
"RTN","ESPUCR",7,0)
 S %DT="AE",%DT(0)="-NOW",%DT("A")="  Beginning DATE : " D ^%DT K %DT
"RTN","ESPUCR",8,0)
 G:Y<0 EX
"RTN","ESPUCR",9,0)
 S (BEGDATE,ESPBD)=Y
"RTN","ESPUCR",10,0)
 W ! S %DT="AE",%DT("A")="   Ending DATE: " D ^%DT
"RTN","ESPUCR",11,0)
 G:$D(DTOUT) EX
"RTN","ESPUCR",12,0)
 G:Y<ESPBD HELP W ! S ENDDATE=Y,ESPED=Y+.9
"RTN","ESPUCR",13,0)
CREATE ;CREATE A NEW ENTRY IN CRIME DATA FILE
"RTN","ESPUCR",14,0)
 K DD,DO S DIC="^ESP(912.4,",DIC(0)="L",DLAYGO=912.4,X=ESPBD D FILE^DICN G:Y<0 EX S ESPIEN=+Y
"RTN","ESPUCR",15,0)
 L +^ESP(912.4,ESPIEN):1 I '$T W !,"This record is being edited by someone else."
"RTN","ESPUCR",16,0)
 S $P(^ESP(912.4,ESPIEN,0),U,2)=ENDDATE
"RTN","ESPUCR",17,0)
INST S:'$D(^ESP(912.4,ESPIEN,1,0)) ^(0)="^912.41^"
"RTN","ESPUCR",18,0)
 K DD,DO S DIC="^ESP(912.4,"_ESPIEN_",1,",DIC(0)="L",DLAYGO=912.4,X=$S($D(^DIC(4,DUZ(2),0)):$P(^(0),U),1:"UNIDENTIFIED"),DA(1)=ESPIEN D FILE^DICN G:Y<0 EX S ESPINS=+Y
"RTN","ESPUCR",19,0)
 S $P(^ESP(912.4,ESPIEN,1,ESPINS,0),U,2)=$S($D(^DIC(4,DUZ(2),99)):$P(^DIC(4,DUZ(2),99),U),1:"")
"RTN","ESPUCR",20,0)
ZERO F ESPX=1:1:188 S ^ESP(912.4,ESPIEN,1,ESPINS,ESPX)=0
"RTN","ESPUCR",21,0)
 F ESPX=133.1,134.1,138.1,139.1 S ^ESP(912.4,ESPIEN,1,ESPINS,ESPX)=0
"RTN","ESPUCR",22,0)
COUNT ;GO THROUGH "C" X-REF TO COUNT AND GET TOTALS
"RTN","ESPUCR",23,0)
 S ESPDT=ESPBD-.0005
"RTN","ESPUCR",24,0)
 F ESPI=1:1 S ESPDT=$O(^ESP(912,"C",ESPDT)) Q:ESPDT>ESPED!(ESPDT'>0)  D
"RTN","ESPUCR",25,0)
 .  S ESPOFN=0
"RTN","ESPUCR",26,0)
 .  F ESPJ=1:1 S ESPOFN=$O(^ESP(912,"C",ESPDT,ESPOFN)) Q:ESPOFN'>0  D
"RTN","ESPUCR",27,0)
 ..  I $D(^ESP(912,ESPOFN,5)) Q:'$P(^ESP(912,ESPOFN,5),U,5)
"RTN","ESPUCR",28,0)
 ..  S ESPCN=0
"RTN","ESPUCR",29,0)
 ..  F ESPZ=1:1 S ESPCN=$O(^ESP(912,ESPOFN,10,ESPCN)) Q:ESPCN'>0  D SET^ESPUCR1
"RTN","ESPUCR",30,0)
VIO ;GO THROUGH "C" X-REF VIOLATION FILE TO COUNT AND GET TOTALS
"RTN","ESPUCR",31,0)
 S ESPDT=ESPBD-.0005
"RTN","ESPUCR",32,0)
 F ESPI=1:1 S ESPDT=$O(^ESP(914,"C",ESPDT)) Q:ESPDT>ESPED!(ESPDT'>0)  D
"RTN","ESPUCR",33,0)
 .  S ESPOFN=0
"RTN","ESPUCR",34,0)
 .  F ESPJ=1:1 S ESPOFN=$O(^ESP(914,"C",ESPDT,ESPOFN)) Q:ESPOFN'>0  D
"RTN","ESPUCR",35,0)
 ..  S ESPTYPE=$P(^ESP(914,ESPOFN,0),U,3),ESPOFF=$P(^(0),U,4),ESPCL=$P($G(^ESP(915,+ESPOFF,0)),U,4),ESPFN=$P(^ESP(914,ESPOFN,0),U,9),ESPCAT=$P($G(^ESP(910,+ESPFN,0)),U,4)
"RTN","ESPUCR",36,0)
 ..  S ^(171)=^ESP(912.4,ESPIEN,1,ESPINS,171)+1
"RTN","ESPUCR",37,0)
 ..  I ESPTYPE="C" S ^(172)=^ESP(912.4,ESPIEN,1,ESPINS,172)+1 D
"RTN","ESPUCR",38,0)
 ...  I ESPCL'="M",ESPCL'="P" S ^(173)=^ESP(912.4,ESPIEN,1,ESPINS,173)+1
"RTN","ESPUCR",39,0)
 ...  I ESPCL="M" S ^(174)=^ESP(912.4,ESPIEN,1,ESPINS,174)+1
"RTN","ESPUCR",40,0)
 ...  I ESPCL="P" S ^(175)=^ESP(912.4,ESPIEN,1,ESPINS,175)+1
"RTN","ESPUCR",41,0)
 ...  I ESPCAT="E"!(ESPCAT="PO") S ^(176)=^ESP(912.4,ESPIEN,1,ESPINS,176)+1
"RTN","ESPUCR",42,0)
 ...  I ESPCAT="O"!(ESPCAT="") S ^(177)=^ESP(912.4,ESPIEN,1,ESPINS,177)+1
"RTN","ESPUCR",43,0)
 ...  I ESPCAT="P" S ^(178)=^ESP(912.4,ESPIEN,1,ESPINS,178)+1
"RTN","ESPUCR",44,0)
 ...  I ESPCAT="V" S ^(179)=^ESP(912.4,ESPIEN,1,ESPINS,179)+1
"RTN","ESPUCR",45,0)
 ..  I ESPTYPE="V" S ^(180)=^ESP(912.4,ESPIEN,1,ESPINS,180)+1 D
"RTN","ESPUCR",46,0)
 ...  I ESPCL'="M",ESPCL'="P" S ^(181)=^ESP(912.4,ESPIEN,1,ESPINS,181)+1
"RTN","ESPUCR",47,0)
 ...  I ESPCL="M" S ^(182)=^ESP(912.4,ESPIEN,1,ESPINS,182)+1
"RTN","ESPUCR",48,0)
 ...  I ESPCL="P" S ^(183)=^ESP(912.4,ESPIEN,1,ESPINS,183)+1
"RTN","ESPUCR",49,0)
 ...  I ESPCAT="E"!(ESPCAT="PO") S ^(184)=^ESP(912.4,ESPIEN,1,ESPINS,184)+1
"RTN","ESPUCR",50,0)
 ...  I ESPCAT="O"!(ESPCAT="") S ^(185)=^ESP(912.4,ESPIEN,1,ESPINS,185)+1
"RTN","ESPUCR",51,0)
 ...  I ESPCAT="P" S ^(186)=^ESP(912.4,ESPIEN,1,ESPINS,186)+1
"RTN","ESPUCR",52,0)
 ...  I ESPCAT="V" S ^(187)=^ESP(912.4,ESPIEN,1,ESPINS,187)+1
"RTN","ESPUCR",53,0)
 L -^ESP(912.4,ESPIEN)
"RTN","ESPUCR",54,0)
 W !!,"Done."
"RTN","ESPUCR",55,0)
EX W:$D(DTOUT) $C(7)
"RTN","ESPUCR",56,0)
 K %DT,BEGDATE,DA,DD,DIC,DO,DTOUT,ENDDATE,ESPBD,ESPCAT,ESPCC,ESPCL,ESPCN,ESPDOL,ESPDT,ESPED,ESPFN,ESPI,ESPIEN,ESPINS,ESPJ,ESPOF,ESPOFF,ESPOFN,ESPSUB,ESPTYPE,ESPVIC,ESPVICT,ESPX,ESPZ,X,Y
"RTN","ESPUCR",57,0)
 QUIT
"RTN","ESPUCR",58,0)
 ;
"RTN","ESPUCR",59,0)
HELP W "??",!?5,"Ending date must not be before beginning date" G DATE
"RTN","ESPWR")
0^3^B10625695
"RTN","ESPWR",1,0)
ESPWR ;DALISC/CKA - WORKLOAD REPORT- 3/93
"RTN","ESPWR",2,0)
 ;;1.0;POLICE & SECURITY;**17,33**;Mar 31, 1994
"RTN","ESPWR",3,0)
START ;
"RTN","ESPWR",4,0)
 S ESPALL=0
"RTN","ESPWR",5,0)
SELOFF S DIR(0)="FO^3:30",DIR("A")="Select OFFICER",DIR("B")="ALL" D ^DIR
"RTN","ESPWR",6,0)
 I X="^" G EX
"RTN","ESPWR",7,0)
 I Y="ALL" S ESPALL=1 G DATE
"RTN","ESPWR",8,0)
 I $D(DTOUT) W $C(7) G EX
"RTN","ESPWR",9,0)
 S DIC="^VA(200,",DIC(0)="EMQZ",D="AK.ESP POLICE"
"RTN","ESPWR",10,0)
 D IX^DIC
"RTN","ESPWR",11,0)
 I Y=-1 W !,$C(7),"This officer is not a current police officer." G SELOFF
"RTN","ESPWR",12,0)
 S ESPPO=Y
"RTN","ESPWR",13,0)
DATE ;ASK BEGINNING & ENDING DATE
"RTN","ESPWR",14,0)
 D DT^DICRW K BEGDATE,ENDDATE W !!,"****  Date Range Selection  ****",!
"RTN","ESPWR",15,0)
 S %DT="AE",%DT(0)="-NOW",%DT("A")="  Beginning DATE : " D ^%DT K %DT
"RTN","ESPWR",16,0)
 G:Y<0 EX
"RTN","ESPWR",17,0)
 S (BEGDATE,ESPBD)=Y
"RTN","ESPWR",18,0)
 W ! S %DT="AE",%DT("A")="   Ending DATE: " D ^%DT
"RTN","ESPWR",19,0)
 G:$D(DTOUT) EX
"RTN","ESPWR",20,0)
 G:Y<ESPBD HELP W ! S ENDDATE=Y,ESPED=Y+.9
"RTN","ESPWR",21,0)
ZERO S ESPI=0 F ESPX=1:1 S ESPI=$O(^ESP(911,ESPI)) Q:ESPI'>0  S ESPC(ESPI)=0,ESPMIN(ESPI)=0
"RTN","ESPWR",22,0)
COUNT ;GO THROUGH "B" X-REF TO COUNT AND GET TOTALS
"RTN","ESPWR",23,0)
 I 'ESPALL G ONE
"RTN","ESPWR",24,0)
 S ESPDT=ESPBD-.0005
"RTN","ESPWR",25,0)
 F ESPI=1:1 S ESPDT=$O(^ESP(910.1,"B",ESPDT)) Q:ESPDT>ESPED!(ESPDT'>0)  D
"RTN","ESPWR",26,0)
 .  S ESPIEN=0
"RTN","ESPWR",27,0)
 .  F ESPJ=1:1 S ESPIEN=$O(^ESP(910.1,"B",ESPDT,ESPIEN)) Q:ESPIEN'>0  D
"RTN","ESPWR",28,0)
 ..  S ESPOFF=0
"RTN","ESPWR",29,0)
 ..  F ESPZ=1:1 S ESPOFF=$O(^ESP(910.1,ESPIEN,10,ESPOFF)) Q:ESPOFF'>0  D
"RTN","ESPWR",30,0)
 ...  ;COUNT AND GET TOTALS
"RTN","ESPWR",31,0)
 ...  S ESPACT=0
"RTN","ESPWR",32,0)
 ...  F ESPY=1:1 S ESPACT=$O(^ESP(910.1,ESPIEN,10,ESPOFF,10,ESPACT)) Q:ESPACT'>0  D
"RTN","ESPWR",33,0)
 ....  S ESPI=$P(^ESP(910.1,ESPIEN,10,ESPOFF,10,ESPACT,0),U) I $D(ESPC(ESPI)) S ESPC(ESPI)=ESPC(ESPI)+$P(^(0),U,2),ESPMIN(ESPI)=ESPMIN(ESPI)+$P(^(0),U,3)
"RTN","ESPWR",34,0)
 G PRT
"RTN","ESPWR",35,0)
ONE ;ONLY ONE OFFICER
"RTN","ESPWR",36,0)
 S ESPDT=ESPBD-.0005
"RTN","ESPWR",37,0)
 F ESPI=1:1 S ESPDT=$O(^ESP(910.1,"B",ESPDT)) Q:ESPDT>ESPED!(ESPDT'>0)  D
"RTN","ESPWR",38,0)
 .  S ESPIEN=0
"RTN","ESPWR",39,0)
 .  F ESPJ=1:1 S ESPIEN=$O(^ESP(910.1,"B",ESPDT,ESPIEN)) Q:ESPIEN'>0  D
"RTN","ESPWR",40,0)
 ..  S ESPOFF=0
"RTN","ESPWR",41,0)
 ..  F ESPZ=1:1 S ESPOFF=$O(^ESP(910.1,ESPIEN,10,ESPOFF)) Q:ESPOFF'>0  D:+ESPPO=$P(^ESP(910.1,ESPIEN,10,ESPOFF,0),U)
"RTN","ESPWR",42,0)
 ...  ;COUNT AND GET TOTALS
"RTN","ESPWR",43,0)
 ...  S ESPACT=0
"RTN","ESPWR",44,0)
 ...  F ESPY=1:1 S ESPACT=$O(^ESP(910.1,ESPIEN,10,ESPOFF,10,ESPACT)) Q:ESPACT'>0  D
"RTN","ESPWR",45,0)
 ....  S ESPI=$P(^ESP(910.1,ESPIEN,10,ESPOFF,10,ESPACT,0),U) I $D(ESPC(ESPI)) S ESPC(ESPI)=ESPC(ESPI)+$P(^(0),U,2),ESPMIN(ESPI)=ESPMIN(ESPI)+$P(^(0),U,3)
"RTN","ESPWR",46,0)
PRT ;PRINT REPORT
"RTN","ESPWR",47,0)
Q S %ZIS="Q" D ^%ZIS G:POP EX I '$D(IO("Q")) U IO D PRT^ESPWR1 G EX
"RTN","ESPWR",48,0)
 S ZTRTN="PRT^ESPWR1",ZTSAVE("ESP*")="",ZTDESC="WORKLOAD REPORT" D ^%ZTLOAD,HOME^%ZIS G EX
"RTN","ESPWR",49,0)
 W !!,"Done."
"RTN","ESPWR",50,0)
EX D ^%ZISC
"RTN","ESPWR",51,0)
 W:$D(DTOUT) $C(7)
"RTN","ESPWR",52,0)
 K %ZIS,%DT,BEGDATE,CODE,DIC,DIR,END,ENDDATE,ESPACT,ESPALL,ESPBD,ESPC,ESPDT,ESPED,ESPI,ESPIEN,ESPJ,ESPMIN,ESPN,ESPPO,ESPOFF,ESPX,ESPY,ESPZ,NAM,OFNAM,PAGE,X,Y
"RTN","ESPWR",53,0)
 QUIT
"RTN","ESPWR",54,0)
 ;
"RTN","ESPWR",55,0)
HELP W "??",!?5,"Ending date must not be before beginning date" G DATE
"VER")
8.0^22.0
"^DD",910.2,910.2,.05,0)
DATE ASSIGNED^DX^^0;5^S %DT="E",%DT(0)="-NOW" D ^%DT K %DT S X=Y K:Y<1 X
"^DD",910.2,910.2,.05,1,0)
^.1
"^DD",910.2,910.2,.05,1,1,0)
910.2^C
"^DD",910.2,910.2,.05,1,1,1)
S ^ESP(910.2,"C",$E(X,1,30),DA)=""
"^DD",910.2,910.2,.05,1,1,2)
K ^ESP(910.2,"C",$E(X,1,30),DA)
"^DD",910.2,910.2,.05,1,1,"DT")
2911204
"^DD",910.2,910.2,.05,3)
Enter the date of the registration.
"^DD",910.2,910.2,.05,21,0)
^.001^2^2^3030102^^
"^DD",910.2,910.2,.05,21,1,0)
This is the date of the registration.  Future
"^DD",910.2,910.2,.05,21,2,0)
dates are not allowed.
"^DD",910.2,910.2,.05,"DT")
3030425
"^DD",913,913,1.04,0)
WARRANT DATE^DX^^1;4^S %DT="E",%DT(0)="-NOW" D ^%DT K %DT S X=Y K:Y<1 X
"^DD",913,913,1.04,3)
Enter the date of the warrant or detainer.  Future dates not allowed!
"^DD",913,913,1.04,21,0)
^^1^1^2940331^^^^
"^DD",913,913,1.04,21,1,0)
Enter the date that the legal documentation was issued.
"^DD",913,913,1.04,"DT")
3030722
"^DD",914,914,.02,0)
DATE/TIME OF OFFENSE^RDX^^0;2^S %DT="ETXR",%DT(0)="-NOW" D ^%DT K %DT S X=Y K:Y<1 X
"^DD",914,914,.02,1,0)
^.1
"^DD",914,914,.02,1,1,0)
914^C
"^DD",914,914,.02,1,1,1)
S ^ESP(914,"C",$E(X,1,30),DA)=""
"^DD",914,914,.02,1,1,2)
K ^ESP(914,"C",$E(X,1,30),DA)
"^DD",914,914,.02,1,1,"DT")
2920103
"^DD",914,914,.02,3)
Enter the date/time of the offense.
"^DD",914,914,.02,21,0)
^^3^3^2931027^^^^
"^DD",914,914,.02,21,1,0)
The date/time of the commission of the offense charged.  Future dates 
"^DD",914,914,.02,21,2,0)
are not allowed.  Enter the date/time of the commission of the offense
"^DD",914,914,.02,21,3,0)
charged.  BOTH date and time must be entered.
"^DD",914,914,.02,22)

"^DD",914,914,.02,"DT")
3030410
**END**
**END**
