Released ECX*3*58 SEQ #56
Extracted from mail message
**KIDS**:ECX*3.0*58^

**INSTALL NAME**
ECX*3.0*58
"BLD",5114,0)
ECX*3.0*58^DSS EXTRACTS^0^3031014^y
"BLD",5114,4,0)
^9.64PA^^
"BLD",5114,"KRN",0)
^9.67PA^8989.52^19
"BLD",5114,"KRN",.4,0)
.4
"BLD",5114,"KRN",.401,0)
.401
"BLD",5114,"KRN",.402,0)
.402
"BLD",5114,"KRN",.403,0)
.403
"BLD",5114,"KRN",.5,0)
.5
"BLD",5114,"KRN",.84,0)
.84
"BLD",5114,"KRN",3.6,0)
3.6
"BLD",5114,"KRN",3.8,0)
3.8
"BLD",5114,"KRN",9.2,0)
9.2
"BLD",5114,"KRN",9.8,0)
9.8
"BLD",5114,"KRN",9.8,"NM",0)
^9.68A^1^1
"BLD",5114,"KRN",9.8,"NM",1,0)
ECXSCRP^^0^B20108565
"BLD",5114,"KRN",9.8,"NM","B","ECXSCRP",1)

"BLD",5114,"KRN",19,0)
19
"BLD",5114,"KRN",19.1,0)
19.1
"BLD",5114,"KRN",101,0)
101
"BLD",5114,"KRN",409.61,0)
409.61
"BLD",5114,"KRN",771,0)
771
"BLD",5114,"KRN",870,0)
870
"BLD",5114,"KRN",8989.51,0)
8989.51
"BLD",5114,"KRN",8989.52,0)
8989.52
"BLD",5114,"KRN",8994,0)
8994
"BLD",5114,"KRN","B",.4,.4)

"BLD",5114,"KRN","B",.401,.401)

"BLD",5114,"KRN","B",.402,.402)

"BLD",5114,"KRN","B",.403,.403)

"BLD",5114,"KRN","B",.5,.5)

"BLD",5114,"KRN","B",.84,.84)

"BLD",5114,"KRN","B",3.6,3.6)

"BLD",5114,"KRN","B",3.8,3.8)

"BLD",5114,"KRN","B",9.2,9.2)

"BLD",5114,"KRN","B",9.8,9.8)

"BLD",5114,"KRN","B",19,19)

"BLD",5114,"KRN","B",19.1,19.1)

"BLD",5114,"KRN","B",101,101)

"BLD",5114,"KRN","B",409.61,409.61)

"BLD",5114,"KRN","B",771,771)

"BLD",5114,"KRN","B",870,870)

"BLD",5114,"KRN","B",8989.51,8989.51)

"BLD",5114,"KRN","B",8989.52,8989.52)

"BLD",5114,"KRN","B",8994,8994)

"BLD",5114,"QUES",0)
^9.62^^
"BLD",5114,"REQB",0)
^9.611^1^1
"BLD",5114,"REQB",1,0)
ECX*3.0*57^2
"BLD",5114,"REQB","B","ECX*3.0*57",1)

"MBREQ")
0
"PKG",535,-1)
1^1
"PKG",535,0)
DSS EXTRACTS^ECX
"PKG",535,20,0)
^9.402P^^
"PKG",535,22,0)
^9.49I^1^1
"PKG",535,22,1,0)
3.0^2971222^3000224^66481
"PKG",535,22,1,"PAH",1,0)
58^3031014
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
1
"RTN","ECXSCRP")
0^1^B20108565
"RTN","ECXSCRP",1,0)
ECXSCRP ;ALB/JAM - Restricted Stop Code Nonconforming Clinic Report; 07/24/03
"RTN","ECXSCRP",2,0)
 ;;3.0;DSS EXTRACTS;**57,58**;Dec 22, 1997
"RTN","ECXSCRP",3,0)
 ;
"RTN","ECXSCRP",4,0)
EN ;foreground entry point
"RTN","ECXSCRP",5,0)
 N ZTRTN,ZTDESC,ZTIO,ZTQUEUED,DIR,DIRUT,X,Y,ECX,ECXSD,PSC,SSC,ECXPCF
"RTN","ECXSCRP",6,0)
 W @IOF
"RTN","ECXSCRP",7,0)
 W "This option synchronizes the Primary and Secondary Stop Codes in the Clinics"
"RTN","ECXSCRP",8,0)
 W !,"and Stop Codes File #728.44 with those in the Hospital Location File #44."
"RTN","ECXSCRP",9,0)
 W !,"It produces a report highlighting any non conformance reasons that pertain"
"RTN","ECXSCRP",10,0)
 W !,"to the Primary and Secondary Codes. Please contact the responsible party "
"RTN","ECXSCRP",11,0)
 W !,"for corrective action."
"RTN","ECXSCRP",12,0)
 S DIR(0)="SO^A:Active Clinics;I:Inactive Clinics;B:Both"
"RTN","ECXSCRP",13,0)
 S DIR("A")="Select Report"
"RTN","ECXSCRP",14,0)
 S DIR("?",1)="Enter an A for Active Clinics, I for Inactive Clinics,"
"RTN","ECXSCRP",15,0)
 S DIR("?")="B for Both Active and Inactive Clinics"
"RTN","ECXSCRP",16,0)
 D ^DIR K DIR I $D(DIRUT) G END
"RTN","ECXSCRP",17,0)
 S ECXPCF=Y
"RTN","ECXSCRP",18,0)
 W ".  Please be patient, this may take a few moments..."
"RTN","ECXSCRP",19,0)
 ;Synch primary & secondary stop codes from file #44 with #728.44
"RTN","ECXSCRP",20,0)
 S ECX=0 F  S ECX=$O(^ECX(728.44,ECX)) Q:'ECX  D
"RTN","ECXSCRP",21,0)
 .I '$D(^SC(ECX,0)) Q
"RTN","ECXSCRP",22,0)
 .S ECXSD=$G(^SC(ECX,0)) I ECXSD="" Q
"RTN","ECXSCRP",23,0)
 .S PSC=$S($P(ECXSD,U,7):$P($G(^DIC(40.7,$P(ECXSD,U,7),0)),U,2),1:"")
"RTN","ECXSCRP",24,0)
 .S SSC=$S($P(ECXSD,U,18):$P($G(^DIC(40.7,$P(ECXSD,U,18),0)),U,2),1:"")
"RTN","ECXSCRP",25,0)
 .I PSC S $P(^ECX(728.44,ECX,0),U,2)=PSC
"RTN","ECXSCRP",26,0)
 .I SSC S $P(^ECX(728.44,ECX,0),U,3)=SSC
"RTN","ECXSCRP",27,0)
 ;device selection
"RTN","ECXSCRP",28,0)
 K IOP,%ZIS,POP,IO("Q")
"RTN","ECXSCRP",29,0)
 S %ZIS("A")="Select Device: ",%ZIS="QM" D ^%ZIS I POP G END
"RTN","ECXSCRP",30,0)
 I $D(IO("Q")) K IO("Q") D  G END
"RTN","ECXSCRP",31,0)
 .S ZTDESC="Restricted Stop Code/DSS Identifier Report",ZTSAVE("ECXPCF")=""
"RTN","ECXSCRP",32,0)
 .S ZTRTN="PROCESS^ECXSCRP",ZTIO=ION D ^%ZTLOAD,HOME^%ZIS K ZTSK
"RTN","ECXSCRP",33,0)
 U IO
"RTN","ECXSCRP",34,0)
 D PROCESS
"RTN","ECXSCRP",35,0)
END D ^%ZISC S:$D(ZTQUEUED) ZTREQ="@"
"RTN","ECXSCRP",36,0)
 Q
"RTN","ECXSCRP",37,0)
 ;
"RTN","ECXSCRP",38,0)
PROCESS ;background entry point
"RTN","ECXSCRP",39,0)
 ;locate invalid Stop Code in HOSPITAL LOCATION file #44 & CLINICS
"RTN","ECXSCRP",40,0)
 ;AND STOP CODES file #728.44
"RTN","ECXSCRP",41,0)
 N ECX,NAM,STR,IEN,PSC,SSC,CNTX,ECXPG,ECXOUT,LNS,DPC,DSC,SCIEN,ECXF
"RTN","ECXSCRP",42,0)
 N INDT,TYP,ACF,HTYP,CLNF,ECXRDT
"RTN","ECXSCRP",43,0)
 S %H=$H D YX^%DTC S ECXRDT=Y
"RTN","ECXSCRP",44,0)
 S $P(LNS,"-",80)="",(CNTX,IEN,ECXOUT,ECXF)=0,ECXPG=1,CLNF=0
"RTN","ECXSCRP",45,0)
 ;search file #728.44 for invalid stop code entries
"RTN","ECXSCRP",46,0)
 D HDR S IEN=0
"RTN","ECXSCRP",47,0)
 F  S IEN=$O(^ECX(728.44,IEN)) Q:'IEN  D  Q:ECXOUT  S:ECXF CNTX=CNTX+1
"RTN","ECXSCRP",48,0)
 .S ECX=$G(^ECX(728.44,IEN,0)),PSC=$P(ECX,U,2),SSC=$P(ECX,U,3),CLNF=0
"RTN","ECXSCRP",49,0)
 .S DPC=$P(ECX,U,4),DSC=$P(ECX,U,5),NAM=$$GET1^DIQ(44,$P(ECX,U),.01)
"RTN","ECXSCRP",50,0)
 .S INDT=$P(ECX,U,10),ECXF=0 I INDT'="" S NAM="*"_NAM
"RTN","ECXSCRP",51,0)
 .S ACF=$S($E(NAM)="*":0,1:1),HTYP=$$GET1^DIQ(44,$P(ECX,U),2,"I")
"RTN","ECXSCRP",52,0)
 .I $S((ECXPCF="A")&('ACF):1,(ECXPCF="I")&(ACF):1,1:0) Q
"RTN","ECXSCRP",53,0)
 .D  I ECXOUT Q
"RTN","ECXSCRP",54,0)
 ..I PSC="" S STR="Missing primary code" D PRN Q
"RTN","ECXSCRP",55,0)
 ..D SCCHK(PSC,"P") I $D(STR) D PRN
"RTN","ECXSCRP",56,0)
 .I SSC'="" D SCCHK(SSC,"S") I $D(STR) D PRN
"RTN","ECXSCRP",57,0)
 .D  I ECXOUT Q 
"RTN","ECXSCRP",58,0)
 ..I DPC="" S STR="No DSS primary code" D PRN Q
"RTN","ECXSCRP",59,0)
 ..I DPC'=PSC D SCCHK(DPC,"P") I $D(STR) D PRN
"RTN","ECXSCRP",60,0)
 .I DSC'="",DSC'=SSC D SCCHK(DSC,"S") I $D(STR) D PRN
"RTN","ECXSCRP",61,0)
 W !!,?25,$S(CNTX:CNTX,1:"NO")_" PROBLEM CLINICS FOUND."
"RTN","ECXSCRP",62,0)
 Q
"RTN","ECXSCRP",63,0)
PRN ;print line
"RTN","ECXSCRP",64,0)
 Q:CLNF  I HTYP'="C" S STR="Not a Clinic" S CLNF=1
"RTN","ECXSCRP",65,0)
 I ($Y+3)>IOSL D PAGE,HDR I ECXOUT Q
"RTN","ECXSCRP",66,0)
 W !,IEN,?8,$E(NAM,1,24),?33,PSC,?38,SSC,?45,DPC,?50,DSC,?57,STR
"RTN","ECXSCRP",67,0)
 S ECXF=1
"RTN","ECXSCRP",68,0)
 Q
"RTN","ECXSCRP",69,0)
 ;
"RTN","ECXSCRP",70,0)
SCCHK(SCIEN,TYP) ;check stop code against file 40.7
"RTN","ECXSCRP",71,0)
 N SCN,RTY,CTY,SCI
"RTN","ECXSCRP",72,0)
 K STR
"RTN","ECXSCRP",73,0)
 S CTY=$S(TYP="P":"^P^E^",1:"^S^E^")
"RTN","ECXSCRP",74,0)
 S SCI=$$SCIEN(SCIEN) I SCI="" D  Q
"RTN","ECXSCRP",75,0)
 .I TYP="S" Q:SSC=PSC  Q:DSC=DPC
"RTN","ECXSCRP",76,0)
 .S STR=SCIEN_" Invalid Stop Code"
"RTN","ECXSCRP",77,0)
 S SCN=$G(^DIC(40.7,SCI,0)),RTY=$P(SCN,U,6)
"RTN","ECXSCRP",78,0)
 I $P(SCN,U,2)="" S STR="No pointer in file #40.7" Q
"RTN","ECXSCRP",79,0)
 I RTY="" S STR=SCIEN_" No restriction type" Q
"RTN","ECXSCRP",80,0)
 I CTY'[("^"_RTY_"^") D
"RTN","ECXSCRP",81,0)
 .S STR=SCIEN_" cannot be "_$S(TYP="P":"prim",1:"second")_"ary"
"RTN","ECXSCRP",82,0)
 Q
"RTN","ECXSCRP",83,0)
PAGE ;
"RTN","ECXSCRP",84,0)
 N SS,JJ,DIR,X,Y
"RTN","ECXSCRP",85,0)
 I $E(IOST,1,2)="C-" D
"RTN","ECXSCRP",86,0)
 . S SS=22-$Y F JJ=1:1:SS W !
"RTN","ECXSCRP",87,0)
 . S DIR(0)="E" W ! D ^DIR K DIR I 'Y S ECXOUT=1
"RTN","ECXSCRP",88,0)
 Q
"RTN","ECXSCRP",89,0)
 ;
"RTN","ECXSCRP",90,0)
SCIEN(SCIEN) ;Get stop code IEN
"RTN","ECXSCRP",91,0)
 I SCIEN="" Q ""
"RTN","ECXSCRP",92,0)
 S SCIEN=$O(^DIC(40.7,"C",SCIEN,0))
"RTN","ECXSCRP",93,0)
 Q SCIEN
"RTN","ECXSCRP",94,0)
 ;
"RTN","ECXSCRP",95,0)
HDR ;header for data from file #728.44
"RTN","ECXSCRP",96,0)
 W @IOF
"RTN","ECXSCRP",97,0)
 W ECXRDT,?73,"Page: ",ECXPG,!
"RTN","ECXSCRP",98,0)
 W !,?18,"DSS IDENTIFIER NON-CONFORMING CLINICS REPORT",!,?32
"RTN","ECXSCRP",99,0)
 W $S(ECXPCF="A":"Active",ECXPCF="I":"Inactive",1:"All")_" Clinics",!
"RTN","ECXSCRP",100,0)
 W !,"CLINICS AND STOP CODES File (#728.44) - (Use 'Enter/Edit DSS "
"RTN","ECXSCRP",101,0)
 W "Stop Codes for",!,?25,"Clinics' [ECXSCEDIT] menu option to "
"RTN","ECXSCRP",102,0)
 W "make corrections)",!!,?45,"DSS",?50,"DSS"
"RTN","ECXSCRP",103,0)
 W !,?33,"PRIM",?38,"2NDARY",?45,"PRIM",?50,"2NDARY"
"RTN","ECXSCRP",104,0)
 W !,?8,$S(ECXPCF="B":"CLINIC NAME",1:""),?33,"STOP",?38,"CREDIT"
"RTN","ECXSCRP",105,0)
 W ?45,"STOP",?50,"CREDIT",?57,"REASON FOR NON-",!
"RTN","ECXSCRP",106,0)
 W "IEN #",?8,$S(ECXPCF="B":"(*currently inactive)",1:"CLINIC NAME")
"RTN","ECXSCRP",107,0)
 W ?33,"CODE",?38,"CODE",?45,"CODE",?50,"CODE",?57,"CONFORMANCE"
"RTN","ECXSCRP",108,0)
 W !,$E(LNS,1,80)
"RTN","ECXSCRP",109,0)
 S ECXPG=ECXPG+1
"RTN","ECXSCRP",110,0)
 Q
"VER")
8.0^22
**END**
**END**
