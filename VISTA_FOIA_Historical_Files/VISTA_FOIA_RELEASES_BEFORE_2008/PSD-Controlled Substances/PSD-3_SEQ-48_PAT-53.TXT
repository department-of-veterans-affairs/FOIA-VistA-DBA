$TXT Created by FRANCE,VENESSA at DEV.DEV.FO-HINES.MED.VA.GOV  (KIDS) on Friday, 04/01/05 at 09:56
=============================================================================
Run Date: JUL 14, 2005                     Designation: PSD*3*53
Package : PSD - CONTROLLED SUBSTANCES         Priority: Mandatory
Version : 3        SEQ #48                      Status: Released
                  Compliance Date: AUG 14, 2005
=============================================================================

Associated patches: (v)PSD*3*25    <<= must be installed BEFORE `PSD*3*53'

Subject: VERIFY COUNT OPTION ERRORS IF 0 BALANCE

Category: 
  - Routine

Description:
============

 This patch will modify the Controlled Substance Balances Report created with
 menu option Verify Count [PSD NURSE ONLINE COUNT].  This report errors out if
 all the drugs in the NAOU (Narcotic Area of Use) have a balance of zero.
 This patch will also modify menu options Record Delayed Wastage [PSD NURSE
 WASTE] and Not Given, Return to Stock [PSD NURSE NOT GIVEN].  These two
 options are calling code in each other's routines which is creating an
 infinite loop.
 In the Not Given, Return to Stock option the ending balance displayed to the 
 user is not correct.
   
 ASSOCIATED NOIS:
 ================
 HD68334 - RIC-1004-20796    Verify Count Option Errors if 0 Balance
 HD68327 - RIC-1004-20590    Error in ~Not Given, Return to Stock~ option
 HD68784 - RIC-0205-20503    Return to stock function not working correctly
  
 ASSOCIATED E3R:
 ===============
 N/A
  
 PARTICIPATING TEST SITES:
 =========================
 MARTINSBURG, WV
 RICHMOND, VA
 PITTSBURGH HCS
 
 NOIS OVERVIEW:
 ==============
 HD68334 - RIC-1004-20796   Verify Count Option Errors if 0 Balance
 HD68327 - RIC-1004-20590   Error in ~Not Given, Return to Stock~ option
 HD68784 - RIC-0205-20503   Return to stock function not working correctly
  
 Problem:
 --------
 The Controlled Substance Balances report errors out if all the drugs have a
 zero balance for the NAOU selected in menu option Verify Count [PSD NURSE 
 ONLINE COUNT].
  
 Resolution:
 ----------- 
 Need to modify the code so if all the drugs for the NAOU selected have a zero
 balance the Controlled Substance Balances report will not error.
  
 Technical:
 ==========
 HD68334 - RIC-1004-20796    Verify Count Option Errors if 0 Balance
  
 Problem:
 -------- 
 Routine PSDADJC sets variable NAOU only if there is at least one drug with a
 balance greater than zero.  If all the drugs for the NAOU have a zero balance 
 this variable is never set.
 
 
 HD68327 - RIC-1004-20590    Error in ~Not Given, Return to Stock~ option
 
 Problem:
 -------- 
 In routine ^PSDRFW, tag WASTE calls WASTE^PSDRFR if variable PSDQ(2) is
 defined.  Tag WASTE^PSDRFR calls WASTE^PSDRFW if variable PSDQ(1) is defined. 
 This is creating an infinite loop.
 
 
 HD68784 - RIC-0205-20503    Return to stock function not working correctly
 
 Problem:
 --------
 The ending balance displayed to the user is not correct if the default
 quantity for the 'Amount returned at (date time): (default quantity)//' prompt 
 is not selected.
 
 
 DATA DICTIONARY CHANGES:
 ========================
 N/A
  
 TEMPLATES:
 ==========
 N/A
  
 ROUTINE SUMMARY:
 ================
 The following is a list of the routine(s) included in this patch.  The
 second line of each of these routine(s) will look like:
  
      <tab>;;3.0; DRUG ACCOUNTABILITY/INVENTORY INTERFACE;**[patch list]**;
 10/24/97
  
                             CHECK^XTSUMBLD results
  Routine name      Before Patch          After Patch         Patch List
  ============      ============          ===========         ==========
  PSDADJC               12709010           12736142               53
  PSDRFR                11706553           11766962            5,7,25,53
  PSDRFW                11756794           11650052              25,53
 
 Total number of routines - 3
  
 DISTRIBUTION:
 =============
 This patch is exported using KIDS.
  
 INSTALLATION INSTRUCTIONS:
 ==========================
 This patch can be installed during business hours, but because the option 
 will be out of service during the installation process it is suggested 
 that it be queued for non-peak hours.
 Installation will take less than 5 minutes.
  
   
 1. Use the INSTALL/CHECK MESSAGE option on the PackMan menu. [Note:
    TEXT PRINT/DISPLAY option in the PackMan menu will display the
    patch text only].
      
 2. (DSM for Open VMS sites only) Disable routine mapping on all systems
       for the routines listed in the Routine Summary.  
  
       NOTE:  If the routines included in this patch are not currently in 
       your mapped routine set, please skip this step.
  
 3. From the Kernel Installation and Distribution System (KIDS)
    menu, select the Installation menu.
  
 4. From this menu, you may elect to use the following options:
    (when prompted for INSTALL NAME, enter PSD*3.0*53)
     
    a.  Backup a Transport Global - this option will create a backup
        message of any routines exported with the patch.  It will
        NOT backup any other changes such as DDs or templates.
    b.  Compare Transport Global to Current System  - this option
        will allow you to view all changes that will be made when
        the patch is installed.  It compares all components of the
        patch (routines, DDs, templates, etc.).
    c.  Verify Checksums in Transport Global - this option will
        allow you to ensure the integrity of the routines that are
        in the transport global.
    d.  Print Transport Global - this option will allow you to view
        the components of the KIDS build.
     
 5. Use the Install Package(s) option and select the package
    PSD*3.0*53
     
 6. When prompted 'Want KIDS to INHIBIT LOGONs during the install?
    YES//', respond NO
     
 7. When prompted 'Want to DISABLE Scheduled Options, Menu Options, and
    Protocols? YES//', respond YES.  When prompted to select the options
    you would like to place out of order, enter the following:
  
  PSD NURSE ONLINE COUNT		Verify Count
  PSD NURSE NOT GIVEN       Not Given, Return to Stock
  PSD NURSE WASTE       Record Delayed Wastage
  
 8. If routines were unmapped as part of step 2 (DSM for Open VMS sites
    only), they should be returned to the mapped set once the installation 
    has run to completion.
 

Routine Information:
====================

Routine Name:
  - PSDADJC


Routine Checksum:

Routine Name:
  - PSDRFR


Routine Checksum:

Routine Name:
  - PSDRFW


Routine Checksum:

=============================================================================
User Information:
Entered By  : FRANCE,VENESSA                Date Entered  : NOV 18, 2004
Completed By: ANDERSON,MAXINE               Date Completed: JUL 12, 2005
Released By : WASHINGTON,JANET P            Date Released : JUL 14, 2005
=============================================================================


Packman Mail Message:
=====================

$END TXT
