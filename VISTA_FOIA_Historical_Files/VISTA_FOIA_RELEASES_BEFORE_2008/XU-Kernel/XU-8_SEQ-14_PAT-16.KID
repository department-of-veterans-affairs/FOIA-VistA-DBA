Released XU*8*16 SEQ #14
Extracted from mail message
**KIDS**:XU*8.0*16^

**INSTALL NAME**
XU*8.0*16
"BLD",18,0)
XU*8.0*16^KERNEL^0^2951214^n
"BLD",18,1,0)
^^43^43^2960123^
"BLD",18,1,1,0)
A problem was reported with the use of DEVICE PASSWORD and uparrowing out
"BLD",18,1,2,0)
causing a error at +38^XUS3.  Also the device password was echoed
"BLD",18,1,3,0)
to the screen and both issues have been fixed.
"BLD",18,1,4,0)
NOIS: ALX-1295-70827
"BLD",18,1,5,0)

"BLD",18,1,6,0)
When "reactivating a user" it wasn't consistent if the allocate security 
"BLD",18,1,7,0)
keys question would be asked.  Now the question will be asked unless the
"BLD",18,1,8,0)
user times-out.  The XUREACT USER form has also been modified.
"BLD",18,1,9,0)
NOIS: WAS-1195-21062
"BLD",18,1,10,0)

"BLD",18,1,11,0)
Fix to a problem on MSM systems with the Kernel Broker.
"BLD",18,1,12,0)

"BLD",18,1,13,0)
Updates to the forms XUREACT USER and XUEDIT CHARACTERISTICS
"BLD",18,1,14,0)

"BLD",18,1,15,0)
routine              new checksum
"BLD",18,1,16,0)
XUS                   7377133
"BLD",18,1,17,0)
XUSERNEW              6789632
"BLD",18,1,18,0)
XUSG                  3379203
"BLD",18,1,19,0)
XUSRB                10223365
"BLD",18,1,20,0)

"BLD",18,1,21,0)
========================================================================= 
"BLD",18,1,22,0)
Installation:
"BLD",18,1,23,0)

"BLD",18,1,24,0)
 1. These routines are usually mapped on systems that allow mapping, 
"BLD",18,1,25,0)
    so you will need to disable mapping for the effected routines.  
"BLD",18,1,26,0)
 2. Use the 'INSTALL/CHECK MESSAGE' option on the PackMan menu. This
"BLD",18,1,27,0)
    option will load the KIDS package in this message onto your system.
"BLD",18,1,28,0)
 3. Answer NO to the question:
"BLD",18,1,29,0)
    'Shall I preserve what is on disk in a separate back-up message ?'
"BLD",18,1,30,0)
 4. From the 'Installation Menu' of the KIDS menu, run the option
"BLD",18,1,31,0)
    'Verify Checksums in Transport Global' and verify that all routines
"BLD",18,1,32,0)
    have the correct checksum.
"BLD",18,1,33,0)
 5. Inhibit users from login into the system.  Then wait 60 seconds, any 
"BLD",18,1,34,0)
    users should be thru the logon by this time. Users can be on the 
"BLD",18,1,35,0)
    system they just can't be login-on.
"BLD",18,1,36,0)
 6. From the 'Installation Menu' of the KIDS menu, run the option
"BLD",18,1,37,0)
    'Install Package(s)' Select the package 'XU*8.0*16' and proceed with
"BLD",18,1,38,0)
    install.
"BLD",18,1,39,0)
 9. If you are a MSM site move the routines to the other servers.  
"BLD",18,1,40,0)
    On a mapped system, rebuild your map set.  
"BLD",18,1,41,0)
10. Enable user's login.
"BLD",18,1,42,0)
=========================================================================
"BLD",18,1,43,0)

"BLD",18,4,0)
^9.64PA^^
"BLD",18,"KRN",0)
^9.67PA^8994^15
"BLD",18,"KRN",.4,0)
.4
"BLD",18,"KRN",.401,0)
.401
"BLD",18,"KRN",.402,0)
.402
"BLD",18,"KRN",.403,0)
.403
"BLD",18,"KRN",.403,"NM",0)
^9.68A^2^2
"BLD",18,"KRN",.403,"NM",1,0)
XUREACT USER    FILE #200^200^0
"BLD",18,"KRN",.403,"NM",2,0)
XUEDIT CHARACTERISTICS    FILE #200^200^0
"BLD",18,"KRN",.403,"NM","B","XUEDIT CHARACTERISTICS    FILE #200",2)

"BLD",18,"KRN",.403,"NM","B","XUREACT USER    FILE #200",1)

"BLD",18,"KRN",.5,0)
.5
"BLD",18,"KRN",.84,0)
.84
"BLD",18,"KRN",3.6,0)
3.6
"BLD",18,"KRN",9.2,0)
9.2
"BLD",18,"KRN",9.8,0)
9.8
"BLD",18,"KRN",9.8,"NM",0)
^9.68A^4^4
"BLD",18,"KRN",9.8,"NM",1,0)
XUS^^0^B16833447
"BLD",18,"KRN",9.8,"NM",2,0)
XUSERNEW^^0^B11458619
"BLD",18,"KRN",9.8,"NM",3,0)
XUSG^^0^B7391539
"BLD",18,"KRN",9.8,"NM",4,0)
XUSRB^^0^B29903747
"BLD",18,"KRN",9.8,"NM","B","XUS",1)

"BLD",18,"KRN",9.8,"NM","B","XUSERNEW",2)

"BLD",18,"KRN",9.8,"NM","B","XUSG",3)

"BLD",18,"KRN",9.8,"NM","B","XUSRB",4)

"BLD",18,"KRN",19,0)
19
"BLD",18,"KRN",19.1,0)
19.1
"BLD",18,"KRN",101,0)
101
"BLD",18,"KRN",409.61,0)
409.61
"BLD",18,"KRN",8994,0)
8994
"BLD",18,"KRN",8995,0)
8995
"BLD",18,"KRN","B",.4,.4)

"BLD",18,"KRN","B",.401,.401)

"BLD",18,"KRN","B",.402,.402)

"BLD",18,"KRN","B",.403,.403)

"BLD",18,"KRN","B",.5,.5)

"BLD",18,"KRN","B",.84,.84)

"BLD",18,"KRN","B",3.6,3.6)

"BLD",18,"KRN","B",9.2,9.2)

"BLD",18,"KRN","B",9.8,9.8)

"BLD",18,"KRN","B",19,19)

"BLD",18,"KRN","B",19.1,19.1)

"BLD",18,"KRN","B",101,101)

"BLD",18,"KRN","B",409.61,409.61)

"BLD",18,"KRN","B",8994,8994)

"BLD",18,"KRN","B",8995,8995)

"BLD",18,"QUES",0)
^9.62^^
"KRN",.403,1,-1)
0^2
"KRN",.403,1,0)
XUEDIT CHARACTERISTICS^^^^2901206^^^200^0^0^1
"KRN",.403,1,40,0)
^.4031I^1^1
"KRN",.403,1,40,1,0)
1^XUEDIT CHARACTERISTICS HDR^1,1^^^^^^
"KRN",.403,1,40,1,1)
Page 1 of 1
"KRN",.403,1,40,1,40,0)
^.4032PI^2^1
"KRN",.403,1,40,1,40,2,0)
XUEDIT CHARACTERISTICS^1^5,1^e
"KRN",.403,16,-1)
0^1
"KRN",.403,16,0)
XUREACT USER^^@^^2950327.1641^^^200^0^0^1
"KRN",.403,16,40,0)
^.4031I^5^5
"KRN",.403,16,40,1,0)
1^^1,1^2
"KRN",.403,16,40,1,1)
Page 1
"KRN",.403,16,40,1,11)
N % S %=$$GET^DDSVAL(200,XUN,2) D:$P(%,U,3)="" HLP^DDSUTL("USER has no ACCESS CODE")
"KRN",.403,16,40,1,40,0)
^.4032IP^57^2
"KRN",.403,16,40,1,40,4,0)
XUEXISTING USER 1^2^2,1^e
"KRN",.403,16,40,1,40,4,11)
D PUT^DDSVAL(DIE,.DA,9.2,"@"),PUT^DDSVAL(DIE,.DA,7,"@")
"KRN",.403,16,40,1,40,57,0)
XUEXISTING USER 0^1^1,1^e
"KRN",.403,16,40,2,0)
2^^1,1^5^1
"KRN",.403,16,40,2,1)
Page 2
"KRN",.403,16,40,2,40,0)
^.4032IP^57^2
"KRN",.403,16,40,2,40,5,0)
XUEXISTING USER 2^2^2,1^e
"KRN",.403,16,40,2,40,57,0)
XUEXISTING USER 0^1^1,1^e
"KRN",.403,16,40,3,0)
5^^1,1^1^2
"KRN",.403,16,40,3,1)
Page 5
"KRN",.403,16,40,3,40,0)
^.4032IP^60^2
"KRN",.403,16,40,3,40,57,0)
XUEXISTING USER 0^1^1,1^e
"KRN",.403,16,40,3,40,60,0)
XUEXISTING USER 5^2^2,1^e
"KRN",.403,16,40,4,0)
3^^11,9^^^1^17,66
"KRN",.403,16,40,4,1)
Page 3
"KRN",.403,16,40,4,40,0)
^.4032IP^6^1
"KRN",.403,16,40,4,40,6,0)
XUEXISTING USER 3^1^2,3^e
"KRN",.403,16,40,5,0)
4^^8,16^^^1^13,59
"KRN",.403,16,40,5,1)
Page 4
"KRN",.403,16,40,5,40,0)
^.4032IP^7^1
"KRN",.403,16,40,5,40,7,0)
XUEXISTING USER 4^1^2,2^e
"KRN",.404,1,0)
XUEDIT CHARACTERISTICS HDR^200^0^^
"KRN",.404,1,40,0)
^.4044I^4^4
"KRN",.404,1,40,1,0)
1^EDIT USER CHARACTERISTICS^1^
"KRN",.404,1,40,1,2)
^^1,28^
"KRN",.404,1,40,2,0)
2^NAME^3^
"KRN",.404,1,40,2,1)
.01
"KRN",.404,1,40,2,2)
2,7^30^2,1
"KRN",.404,1,40,2,11)

"KRN",.404,1,40,3,0)
3^PAGE 1 OF 1^1^
"KRN",.404,1,40,3,2)
^^2,69^
"KRN",.404,1,40,4,0)
4^_______________________________________________________________________________^1^
"KRN",.404,1,40,4,2)
^^3,1^
"KRN",.404,2,0)
XUEDIT CHARACTERISTICS^200^^^
"KRN",.404,2,15,0)
1^^1^1^2930813^^^^
"KRN",.404,2,15,1,0)
Part of KERNEL.
"KRN",.404,2,40,0)
^.4044I^12^12
"KRN",.404,2,40,1,0)
1^INITIAL^3
"KRN",.404,2,40,1,1)
1
"KRN",.404,2,40,1,2)
1,29^5^1,20
"KRN",.404,2,40,1,11)
N T S T(1)="To Exit form and save changes, enter: <PF1>E",T(2)="To Quit form without saving changes, enter: <PF1>Q" D HLP^DDSUTL(.T)
"KRN",.404,2,40,2,0)
2^NICK NAME^3
"KRN",.404,2,40,2,1)
13
"KRN",.404,2,40,2,2)
2,29^10^2,18
"KRN",.404,2,40,3,0)
3^PHONE^3
"KRN",.404,2,40,3,1)
.131
"KRN",.404,2,40,3,2)
1,62^15^1,55
"KRN",.404,2,40,4,0)
4^OFFICE PHONE^3
"KRN",.404,2,40,4,1)
.132
"KRN",.404,2,40,4,2)
2,62^15^2,48
"KRN",.404,2,40,5,0)
5^ASK DEVICE TYPE AT SIGN-ON^3
"KRN",.404,2,40,5,1)
200.05
"KRN",.404,2,40,5,2)
7,33^9^7,5
"KRN",.404,2,40,6,0)
6^AUTO MENU^3
"KRN",.404,2,40,6,1)
200.06
"KRN",.404,2,40,6,2)
8,33^20^8,22
"KRN",.404,2,40,7,0)
7^TYPE-AHEAD^3
"KRN",.404,2,40,7,1)
200.09
"KRN",.404,2,40,7,2)
9,33^11^9,21
"KRN",.404,2,40,8,0)
8^TEXT TERMINATOR^3
"KRN",.404,2,40,8,1)
31.2
"KRN",.404,2,40,8,2)
10,33^5^10,16
"KRN",.404,2,40,9,0)
9^PREFERRED EDITOR^3
"KRN",.404,2,40,9,1)
31.3
"KRN",.404,2,40,9,2)
11,33^30^11,15
"KRN",.404,2,40,10,0)
10^Want to edit VERIFY CODE (Y/N)^3
"KRN",.404,2,40,10,1)
11.1
"KRN",.404,2,40,10,2)
13,33^3^13,1
"KRN",.404,2,40,11,0)
11^VOICE PAGER^3
"KRN",.404,2,40,11,1)
.137
"KRN",.404,2,40,11,2)
3,62^15^3,49
"KRN",.404,2,40,12,0)
12^DIGITAL PAGER^3
"KRN",.404,2,40,12,1)
.138
"KRN",.404,2,40,12,2)
4,62^15^4,47
"KRN",.404,4,0)
XUEXISTING USER 1^200^^^
"KRN",.404,4,40,0)
^.4044I^16^15
"KRN",.404,4,40,1,0)
1^NAME^3
"KRN",.404,4,40,1,1)
.01
"KRN",.404,4,40,1,2)
3,12^30^3,6
"KRN",.404,4,40,2,0)
2^TITLE^3
"KRN",.404,4,40,2,1)
8
"KRN",.404,4,40,2,2)
4,12^30^4,5
"KRN",.404,4,40,3,0)
3^INITIAL^3
"KRN",.404,4,40,3,1)
1
"KRN",.404,4,40,3,2)
3,65^5^3,56
"KRN",.404,4,40,4,0)
4^NICK NAME^3
"KRN",.404,4,40,4,1)
13
"KRN",.404,4,40,4,2)
4,65^10^4,54
"KRN",.404,4,40,4,4)

"KRN",.404,4,40,5,0)
5^PRIMARY MENU OPTION^3^
"KRN",.404,4,40,5,1)
201
"KRN",.404,4,40,5,2)
7,33^30^7,12
"KRN",.404,4,40,5,10)

"KRN",.404,4,40,6,0)
6^Select SECONDARY MENU OPTIONS^3
"KRN",.404,4,40,6,1)
203
"KRN",.404,4,40,6,2)
8,33^30^8,2
"KRN",.404,4,40,6,7)
^3
"KRN",.404,4,40,7,0)
7^Want to edit ACCESS CODE (Y/N)^3
"KRN",.404,4,40,7,1)
2.1
"KRN",.404,4,40,7,2)
10,33^3^10,1
"KRN",.404,4,40,8,0)
8^Want to edit VERIFY CODE (Y/N)^3
"KRN",.404,4,40,8,1)
11.1
"KRN",.404,4,40,8,2)
11,33^3^11,1
"KRN",.404,4,40,9,0)
9^FILE MANAGER ACCESS CODE^3
"KRN",.404,4,40,9,1)
3
"KRN",.404,4,40,9,2)
10,65^15^10,39
"KRN",.404,4,40,11,0)
11^PREFERRED EDITOR^3
"KRN",.404,4,40,11,1)
31.3
"KRN",.404,4,40,11,2)
13,33^30^13,15
"KRN",.404,4,40,12,0)
12^Select DIVISION^3
"KRN",.404,4,40,12,1)
16
"KRN",.404,4,40,12,2)
14,33^30^14,16
"KRN",.404,4,40,12,7)
^4
"KRN",.404,4,40,13,0)
13^SERVICE/SECTION^3
"KRN",.404,4,40,13,1)
29
"KRN",.404,4,40,13,2)
15,33^30^15,16
"KRN",.404,4,40,14,0)
4.5^MAIL CODE^3
"KRN",.404,4,40,14,1)
28
"KRN",.404,4,40,14,2)
5,65^10^5,54
"KRN",.404,4,40,15,0)
15^1^1^
"KRN",.404,4,40,15,2)
^^1,74^1
"KRN",.404,4,40,16,0)
2.5^SSN^3
"KRN",.404,4,40,16,1)
9
"KRN",.404,4,40,16,2)
5,12^9^5,7
"KRN",.404,5,0)
XUEXISTING USER 2^200^^^
"KRN",.404,5,40,0)
^.4044I^15^14
"KRN",.404,5,40,1,0)
1^TIMED READ (# OF SECONDS)^3
"KRN",.404,5,40,1,1)
200.1
"KRN",.404,5,40,1,2)
4,31^5^4,4
"KRN",.404,5,40,2,0)
2^MULTIPLE SIGN-ON^3
"KRN",.404,5,40,2,1)
200.04
"KRN",.404,5,40,2,2)
6,31^11^6,13
"KRN",.404,5,40,2,7)
^
"KRN",.404,5,40,3,0)
3^AUTO MENU^3
"KRN",.404,5,40,3,1)
200.06
"KRN",.404,5,40,3,2)
6,60^20^6,49
"KRN",.404,5,40,4,0)
4^ASK DEVICE TYPE AT SIGN-ON^3
"KRN",.404,5,40,4,1)
200.05
"KRN",.404,5,40,4,2)
7,31^9^7,3
"KRN",.404,5,40,5,0)
5^TYPE-AHEAD^3
"KRN",.404,5,40,5,1)
200.09
"KRN",.404,5,40,5,2)
7,60^11^7,48
"KRN",.404,5,40,6,0)
6^PROHIBITED TIMES FOR SIGN-ON^3
"KRN",.404,5,40,6,1)
15
"KRN",.404,5,40,6,2)
8,31^9^8,1
"KRN",.404,5,40,6,7)
^
"KRN",.404,5,40,7,0)
7^ALLOWED TO USE SPOOLER^3
"KRN",.404,5,40,7,1)
41
"KRN",.404,5,40,7,2)
10,31^3^10,7
"KRN",.404,5,40,8,0)
8^CAN MAKE INTO A MAIL MESSAGE^3
"KRN",.404,5,40,8,1)
41.2
"KRN",.404,5,40,8,2)
11,31^3^11,1
"KRN",.404,5,40,10,0)
10^FILE RANGE^3
"KRN",.404,5,40,10,1)
31.1
"KRN",.404,5,40,10,2)
13,31^30^13,19
"KRN",.404,5,40,11,0)
11^TERMINATION DATE^3
"KRN",.404,5,40,11,1)
9.2
"KRN",.404,5,40,11,2)
14,31^11^14,13
"KRN",.404,5,40,12,0)
12^ALWAYS SHOW SECONDARIES^3
"KRN",.404,5,40,12,1)
200.11
"KRN",.404,5,40,12,2)
15,31^3^15,6
"KRN",.404,5,40,13,0)
13^2^1^
"KRN",.404,5,40,13,2)
^^1,74^1
"KRN",.404,5,40,14,0)
14^PAC^3
"KRN",.404,5,40,14,1)
14
"KRN",.404,5,40,14,2)
10,63^8^10,58
"KRN",.404,5,40,15,0)
15^DISUSER^3
"KRN",.404,5,40,15,1)
7
"KRN",.404,5,40,15,2)
11,63^3^11,54
"KRN",.404,6,0)
XUEXISTING USER 3^200.03
"KRN",.404,6,40,0)
^.4044I^3^3
"KRN",.404,6,40,1,0)
1^SECONDARY MENU OPTIONS^1^
"KRN",.404,6,40,1,2)
^^1,33^
"KRN",.404,6,40,2,0)
2^SECONDARY MENU OPTIONS^3
"KRN",.404,6,40,2,1)
.01
"KRN",.404,6,40,2,2)
3,25^30^3,1
"KRN",.404,6,40,3,0)
3^SYNONYM^3
"KRN",.404,6,40,3,1)
2
"KRN",.404,6,40,3,2)
4,25^4^4,16
"KRN",.404,7,0)
XUEXISTING USER 4^200.02
"KRN",.404,7,40,0)
^.4044I^2^2
"KRN",.404,7,40,1,0)
1^DIVISION^1^
"KRN",.404,7,40,1,2)
^^1,33^
"KRN",.404,7,40,2,0)
2^DIVISION^3
"KRN",.404,7,40,2,1)
.01
"KRN",.404,7,40,2,2)
3,11^30^3,1
"KRN",.404,57,0)
XUEXISTING USER 0^200^
"KRN",.404,57,40,0)
^.4044I^5^5
"KRN",.404,57,40,1,0)
1^NAME^3
"KRN",.404,57,40,1,1)
.01
"KRN",.404,57,40,1,2)
2,7^30^2,1
"KRN",.404,57,40,1,4)
^^^1
"KRN",.404,57,40,2,0)
3^Edit an Existing User^1^
"KRN",.404,57,40,2,2)
^^1,30^1
"KRN",.404,57,40,3,0)
2^Page^1^
"KRN",.404,57,40,3,2)
^^2,69^1
"KRN",.404,57,40,4,0)
4^_______________________________________________________________________________^1^
"KRN",.404,57,40,4,2)
^^3,1^1
"KRN",.404,57,40,5,0)
5^of 3^1^
"KRN",.404,57,40,5,2)
^^2,76^1
"KRN",.404,60,0)
XUEXISTING USER 5^200
"KRN",.404,60,40,0)
^.4044I^9^9
"KRN",.404,60,40,1,0)
1^3^1^
"KRN",.404,60,40,1,2)
^^1,74^
"KRN",.404,60,40,2,0)
2^PROHIBITED TIMES FOR SIGN-ON^3
"KRN",.404,60,40,2,1)
15
"KRN",.404,60,40,2,2)
3,31^21^3,1
"KRN",.404,60,40,3,0)
3^PHONE^3
"KRN",.404,60,40,3,1)
.131
"KRN",.404,60,40,3,2)
5,19^20^5,12
"KRN",.404,60,40,4,0)
4^OFFICE PHONE^3
"KRN",.404,60,40,4,1)
.132
"KRN",.404,60,40,4,2)
5,56^20^5,42
"KRN",.404,60,40,5,0)
5^VOICE PAGER^3
"KRN",.404,60,40,5,1)
.137
"KRN",.404,60,40,5,2)
7,19^20^7,6
"KRN",.404,60,40,6,0)
6^FAX NUMBER^3
"KRN",.404,60,40,6,1)
.136
"KRN",.404,60,40,6,2)
6,56^15^6,44
"KRN",.404,60,40,7,0)
7^COMMERCIAL PHONE^3
"KRN",.404,60,40,7,1)
.135
"KRN",.404,60,40,7,2)
6,19^20^6,1
"KRN",.404,60,40,8,0)
8^DIGITAL PAGER^3
"KRN",.404,60,40,8,1)
.138
"KRN",.404,60,40,8,2)
7,56^20^7,41
"KRN",.404,60,40,9,0)
9^LANGUAGE^3
"KRN",.404,60,40,9,1)
200.07
"KRN",.404,60,40,9,2)
9,19^10^9,9
"ORD",8,.403)
.403;8;;;EDEOUT^DIFROMSO(.403,DA,"",XPDA);FPRE^DIFROMSI(.403,"",XPDA);EPRE^DIFROMSI(.403,DA,$E("N",$G(XPDNEW)),XPDA,"",OLDA);;EPOST^DIFROMSI(.403,DA,"",XPDA);DEL^DIFROMSK(.403,"",%)
"ORD",8,.403,0)
FORM
"PKG",3,-1)
1^1
"PKG",3,0)
KERNEL^XU^SIGN-ON, SECURITY, MENU DRIVER, DEVICES, TASKMAN^XUDOCV7 NEW FEATURES
"PKG",3,22,0)
^9.49I^1^1
"PKG",3,22,1,0)
8.0^2950703^2951018^4
"PKG",3,22,1,"PAH",1,0)
16^2951214
"PKG",3,22,1,"PAH",1,1,0)
^^43^43^2960123
"PKG",3,22,1,"PAH",1,1,1,0)
A problem was reported with the use of DEVICE PASSWORD and uparrowing out
"PKG",3,22,1,"PAH",1,1,2,0)
causing a error at +38^XUS3.  Also the device password was echoed
"PKG",3,22,1,"PAH",1,1,3,0)
to the screen and both issues have been fixed.
"PKG",3,22,1,"PAH",1,1,4,0)
NOIS: ALX-1295-70827
"PKG",3,22,1,"PAH",1,1,5,0)

"PKG",3,22,1,"PAH",1,1,6,0)
When "reactivating a user" it wasn't consistent if the allocate security 
"PKG",3,22,1,"PAH",1,1,7,0)
keys question would be asked.  Now the question will be asked unless the
"PKG",3,22,1,"PAH",1,1,8,0)
user times-out.  The XUREACT USER form has also been modified.
"PKG",3,22,1,"PAH",1,1,9,0)
NOIS: WAS-1195-21062
"PKG",3,22,1,"PAH",1,1,10,0)

"PKG",3,22,1,"PAH",1,1,11,0)
Fix to a problem on MSM systems with the Kernel Broker.
"PKG",3,22,1,"PAH",1,1,12,0)

"PKG",3,22,1,"PAH",1,1,13,0)
Updates to the forms XUREACT USER and XUEDIT CHARACTERISTICS
"PKG",3,22,1,"PAH",1,1,14,0)

"PKG",3,22,1,"PAH",1,1,15,0)
routine              new checksum
"PKG",3,22,1,"PAH",1,1,16,0)
XUS                   7377133
"PKG",3,22,1,"PAH",1,1,17,0)
XUSERNEW              6789632
"PKG",3,22,1,"PAH",1,1,18,0)
XUSG                  3379203
"PKG",3,22,1,"PAH",1,1,19,0)
XUSRB                10223365
"PKG",3,22,1,"PAH",1,1,20,0)

"PKG",3,22,1,"PAH",1,1,21,0)
========================================================================= 
"PKG",3,22,1,"PAH",1,1,22,0)
Installation:
"PKG",3,22,1,"PAH",1,1,23,0)

"PKG",3,22,1,"PAH",1,1,24,0)
 1. These routines are usually mapped on systems that allow mapping, 
"PKG",3,22,1,"PAH",1,1,25,0)
    so you will need to disable mapping for the effected routines.  
"PKG",3,22,1,"PAH",1,1,26,0)
 2. Use the 'INSTALL/CHECK MESSAGE' option on the PackMan menu. This
"PKG",3,22,1,"PAH",1,1,27,0)
    option will load the KIDS package in this message onto your system.
"PKG",3,22,1,"PAH",1,1,28,0)
 3. Answer NO to the question:
"PKG",3,22,1,"PAH",1,1,29,0)
    'Shall I preserve what is on disk in a separate back-up message ?'
"PKG",3,22,1,"PAH",1,1,30,0)
 4. From the 'Installation Menu' of the KIDS menu, run the option
"PKG",3,22,1,"PAH",1,1,31,0)
    'Verify Checksums in Transport Global' and verify that all routines
"PKG",3,22,1,"PAH",1,1,32,0)
    have the correct checksum.
"PKG",3,22,1,"PAH",1,1,33,0)
 5. Inhibit users from login into the system.  Then wait 60 seconds, any 
"PKG",3,22,1,"PAH",1,1,34,0)
    users should be thru the logon by this time. Users can be on the 
"PKG",3,22,1,"PAH",1,1,35,0)
    system they just can't be login-on.
"PKG",3,22,1,"PAH",1,1,36,0)
 6. From the 'Installation Menu' of the KIDS menu, run the option
"PKG",3,22,1,"PAH",1,1,37,0)
    'Install Package(s)' Select the package 'XU*8.0*16' and proceed with
"PKG",3,22,1,"PAH",1,1,38,0)
    install.
"PKG",3,22,1,"PAH",1,1,39,0)
 9. If you are a MSM site move the routines to the other servers.  
"PKG",3,22,1,"PAH",1,1,40,0)
    On a mapped system, rebuild your map set.  
"PKG",3,22,1,"PAH",1,1,41,0)
10. Enable user's login.
"PKG",3,22,1,"PAH",1,1,42,0)
=========================================================================
"PKG",3,22,1,"PAH",1,1,43,0)

"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options and Options
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
4
"RTN","XUS")
0^1^B16833447
"RTN","XUS",1,0)
XUS ;SFISC/STAFF - SIGNON ;01/23/96  12:40
"RTN","XUS",2,0)
 ;;8.0;KERNEL;**16**;Jul 10, 1995
"RTN","XUS",3,0)
 D INTRO^XUS1A()
"RTN","XUS",4,0)
 K (ZUGUI1,ZUGUI2) K ^XUTL("ZISPARAM",$I)
"RTN","XUS",5,0)
 S XQXFLG("GUI")=$G(ZUGUI1)_"^"_$G(ZUGUI2)
"RTN","XUS",6,0)
 W ! D SET1(1) I POP S XUM=3 G NO
"RTN","XUS",7,0)
 W !!,"Volume set: ",XQVOL,"    UCI: ",XUCI,"    Device: ",$I W:$D(IO("ZIO")) " (",IO("ZIO"),")" W !
"RTN","XUS",8,0)
RS S XUM=$$SET2 G:XUM NO
"RTN","XUS",9,0)
 I $P(XU1,U,2)]"" S XUM=$$DEVPAS() I XUM G H:XUM<0,NO
"RTN","XUS",10,0)
 S PGM=$P(XOPT,U,8),XUA=$P(PGM,"[",1) I XUA]"" X XUEON G P
"RTN","XUS",11,0)
A S (XUSER(0),XUSER(1),XQUR)=""
"RTN","XUS",12,0)
 X XUEOFF S AV=$$ASKAV() X XUEON I AV="^;^" G H ;Get out
"RTN","XUS",13,0)
 I AV["MAIL-BOX",AV[";XMR" S (XUA,PGM)="XMR",XMCHAN=$P($P(AV,";")," ",2),DUZ=.5 G XMR^XUSCLEAN
"RTN","XUS",14,0)
 S XQUR=$P(AV,";",3)
"RTN","XUS",15,0)
 S DUZ=$$CHECKAV(AV,.XUSER) K AV
"RTN","XUS",16,0)
 S XUM=$$UVALID() G:XUM NO
"RTN","XUS",17,0)
 K XUF,%1 S XUF=0 X XUEON
"RTN","XUS",18,0)
 I DUZ D USER^XUS1,SEC^XUS3:($D(^%ZIS(1,XUDEV,"TIME"))!$D(^(95))) G:XUM NO
"RTN","XUS",19,0)
 G NO:'DUZ S DTIME=$P(XOPT,U,10),X=$S(DUZ("BUF"):"",1:"NO-")_"TYPE-AHEAD" X:$D(^%ZOSF(X)) ^(X)
"RTN","XUS",20,0)
 D TT^XUS3:$G(XUTT) ;G ^XUS3:$O(^VA(200,DUZ,.2,0))>0
"RTN","XUS",21,0)
PGM ;
"RTN","XUS",22,0)
 S Y=+$G(^%ZIS(1,XUDEV,201)) I Y>0 D CHK S XQY=Y G:Y O
"RTN","XUS",23,0)
 S Y=+$G(^VA(200,DUZ,201)) I Y>0 D CHK S XQY=Y G:Y O
"RTN","XUS",24,0)
 S XUM=5 G NO
"RTN","XUS",25,0)
O D CHEK^XQ83
"RTN","XUS",26,0)
 S (XUA,PGM)="XQ" S:$G(XQXFLG("GUI"))="1^" KWAPI=1
"RTN","XUS",27,0)
P G NEXT^XUS1
"RTN","XUS",28,0)
 ;
"RTN","XUS",29,0)
CHK I $D(^DIC(19,Y,0)),$S($P(^(0),U,6)="":1,1:$D(^XUSEC($P(^(0),U,6),DUZ))) Q
"RTN","XUS",30,0)
 S Y=0 Q
"RTN","XUS",31,0)
LC S X=$TR(X,"abcdefghijklmnopqrstuvwxyz","ABCDEFGHIJKLMNOPQRSTUVWXYZ")
"RTN","XUS",32,0)
 Q
"RTN","XUS",33,0)
E S:'DUZ XUF(.1)=$E(%1)
"RTN","XUS",34,0)
 S:XUF=2 XUF(.2)=XUF(.2)+1,XUF(XUF(.2))=%1 S %1="" Q
"RTN","XUS",35,0)
 Q
"RTN","XUS",36,0)
NO ;
"RTN","XUS",37,0)
 S X=$$NO^XUS3() G RS:'X,^XUSCLEAN
"RTN","XUS",38,0)
ON X ^%ZOSF("EON") Q
"RTN","XUS",39,0)
H ;;Exit point for all applications
"RTN","XUS",40,0)
C ;CLOSE
"RTN","XUS",41,0)
 G ^XUSCLEAN
"RTN","XUS",42,0)
ASKAV() ;Ask and return Access;Verify code, Turn off echo before calling
"RTN","XUS",43,0)
 N X,Y
"RTN","XUS",44,0)
 F  R !,"ACCESS CODE: ",X#100:60 S:('$T)!(X="^") X="^;^" Q:$L(X)
"RTN","XUS",45,0)
 I $P(X," ")="MAIL-BOX" S X=X_";XMR"
"RTN","XUS",46,0)
 I '$L($P(X,";",2)) R !,"VERIFY CODE: ",Y#60:60 S:'$T X="^;" S $P(X,";",2)=Y
"RTN","XUS",47,0)
 Q X
"RTN","XUS",48,0)
CHECKAV(X1,USER) ;Check A/V code return DUZ
"RTN","XUS",49,0)
 N %,X,Y
"RTN","XUS",50,0)
 S:X1[":" XUTT=1,X1=$P(X1,":",1)_$P(X1,":",2)
"RTN","XUS",51,0)
 S X=$P(X1,";") Q:X="^" -1
"RTN","XUS",52,0)
 S:XUF %1="Access: "_X G CHX:X'?1.20ANP D LC,^XUSHSH I '$D(^VA(200,"A",X)) D:XUF E G CHX
"RTN","XUS",53,0)
 S %1="",DUZ=$O(^VA(200,"A",X,0)),USER(0)=^VA(200,DUZ,0),USER(1)=$G(^(.1)),XUF(.3)=DUZ
"RTN","XUS",54,0)
 S X=$P(X1,";",2) S:XUF %1="Verify: "_X D LC,^XUSHSH I $P(USER(1),"^",2)'=X D:XUF E G CHX
"RTN","XUS",55,0)
 Q DUZ
"RTN","XUS",56,0)
CHX I DUZ S X=$P($G(^VA(200,DUZ,1.1)),U,2)+1,$P(^(1.1),"^",2)=X
"RTN","XUS",57,0)
 Q 0
"RTN","XUS",58,0)
SET1(FLAG) ;Setup parameters
"RTN","XUS",59,0)
 D GETENV^%ZOSV S U="^",XUENV=Y,XUCI=$P(Y,U,1),XQVOL=$P(Y,U,2),XUEON=^%ZOSF("EON"),XUEOFF=^("EOFF")
"RTN","XUS",60,0)
 S X=$O(^XTV(8989.3,1,4,"B",XQVOL,0)),XUVOL=$S(X>0:^XTV(8989.3,1,4,X,0),1:XQVOL_"^y^1") S:$P(XUVOL,U,6)="y" XRTL=XUCI_","_XQVOL
"RTN","XUS",61,0)
 S XOPT=$S($D(^XTV(8989.3,1,"XUS")):^("XUS"),1:"") F I=2:1:15 I $P(XOPT,U,I)="" S $P(XOPT,U,I)=$P("^5^900^1^1^^^^1^300^^^^N^90",U,I)
"RTN","XUS",62,0)
 K ^XUTL("XQ",$J) S XUT=0,XUF=0,XUDEV=0,DUZ=0,DUZ(0)="@",IOS=0,ION=""
"RTN","XUS",63,0)
 I FLAG S %ZIS="L",IOP="HOME" D ^%ZIS Q:POP
"RTN","XUS",64,0)
 S XUDEV=IOS,XUIOP=ION D:$D(XRTL) T0^%ZOSV
"RTN","XUS",65,0)
 Q
"RTN","XUS",66,0)
SET2() ;EF. Return error code
"RTN","XUS",67,0)
 S XUNOW=$$HTFM^XLFDT($H),DT=$E(XUNOW,1,7)
"RTN","XUS",68,0)
 S X=$P(XOPT,U,14) I "N"'[X S XUF=(X["R")+1,XUF(.1)="",XUF(.2)=0,XUF(.3)=0 I X["D" S:$D(^XTV(8989.3,1,4.33,"B",XUDEV))[0 XUF=0
"RTN","XUS",69,0)
 K DUZ,XUSER S (DUZ,DUZ(2))=0,(DUZ(0),DUZ("AG"),XUSER(0),XUSER(1),XUTT,%UCI)=""
"RTN","XUS",70,0)
 I $G(^%ZIS(14.5,"LOGON",XQVOL)) Q 1
"RTN","XUS",71,0)
 I $D(^%ZOSF("ACTJ")) X ^("ACTJ") I $P(XUVOL,U,3),($P(XUVOL,U,3)'>Y) Q 2
"RTN","XUS",72,0)
 S X=$G(^%ZIS(1,XUDEV,"XUS")),XU1=$G(^(1)) F I=1:1:15 I $P(X,U,I)]"" S $P(XOPT,U,I)=$P(X,U,I)
"RTN","XUS",73,0)
 S DTIME=600
"RTN","XUS",74,0)
 I '$P(XOPT,U,11),$D(^%ZIS(1,XUDEV,90)),^(90)>2800000,^(90)'>DT Q 8
"RTN","XUS",75,0)
 I $D(XRT0) S XRTN="XUS" D T1^%ZOSV
"RTN","XUS",76,0)
 Q 0
"RTN","XUS",77,0)
UVALID() ;EF. Is it valid for this user to sign on?
"RTN","XUS",78,0)
 I DUZ'>0 Q 4
"RTN","XUS",79,0)
 I $P(XUSER(0),U,11),$P(XUSER(0),U,11)'>DT Q 11 ;Access Terminated
"RTN","XUS",80,0)
 I $P(XUSER(0),U,7) Q 5 ;Disuser flag set
"RTN","XUS",81,0)
 Q 0
"RTN","XUS",82,0)
DEVPAS() ;EF. Ask device password
"RTN","XUS",83,0)
 X XUEOFF W !,"DEVICE PASSWORD: " R X:60 X XUEON
"RTN","XUS",84,0)
 S X=$E(X,1,30) S:'$T X="^" D LC Q:X["^" -1 I $P(XU1,U,2)'=X S:XUF %1="Device: "_X D:XUF E Q 6
"RTN","XUS",85,0)
 Q 0
"RTN","XUSERNEW")
0^2^B11458619
"RTN","XUSERNEW",1,0)
XUSERNEW ;SF/RWF - ADD NEW USER ;12/14/95  11:46
"RTN","XUSERNEW",2,0)
 ;;8.0;KERNEL;**16**;Jul 10, 1995
"RTN","XUSERNEW",3,0)
 ;In the call to NEW^XM for new users the variable XMZ must be undef.
"RTN","XUSERNEW",4,0)
 ;on a reactivation XMZ should be set to the current max message number.
"RTN","XUSERNEW",5,0)
EN ;Add
"RTN","XUSERNEW",6,0)
 S Y=$$ADD G EXIT:Y'>0,RE:$P(Y,U,3)'=1
"RTN","XUSERNEW",7,0)
 S DR="["_$$GET^XUPARAM("XUNEW USER","N")_"]"
"RTN","XUSERNEW",8,0)
 S XUN=+Y,DIE=200,DA=XUN D XUDIE^XUS5 G:$D(DTOUT) EXIT
"RTN","XUSERNEW",9,0)
 S Y=XUN K XMZ D NEW^XM K XMDT,XMM,XMZ
"RTN","XUSERNEW",10,0)
 ;ACCESS LETTER, Also see XUSERBLK
"RTN","XUSERNEW",11,0)
 W ! D LETTER(XUN,1)
"RTN","XUSERNEW",12,0)
 K DIR,DIWF,XUTEXT
"RTN","XUSERNEW",13,0)
 ;Fall in from above, called from REACT
"RTN","XUSERNEW",14,0)
KEYS S DIR(0)="Y",DIR("B")="NO",DIR("A")="Do you wish to allocate security keys" D ^DIR G:$D(DIRUT) EXIT
"RTN","XUSERNEW",15,0)
 I Y=1 S XQHOLD(XUN)="",XQKEY(0)=0,XQDA=0,XQAL=1,XQ6="",XQFL="" D KEY^XQ6
"RTN","XUSERNEW",16,0)
EXIT K D0,DA,DIE,DIC,DIR,DI,DICR,DIG,DIH,DIU,DIV,DLAYGO,DR,K,I,X,XQHOLD,XQKEY,XUN,XUSOLD,XMB,XMZ,Y,Z,XQ6,XQFL,DTOUT
"RTN","XUSERNEW",17,0)
 Q
"RTN","XUSERNEW",18,0)
RE ;Jump from new user to reactivate
"RTN","XUSERNEW",19,0)
 S XUN=+Y,DIR("A")="This isn't a new user, Want to reactivate?",DIR(0)="Y",DIR("B")="NO" D ^DIR G EXIT:$D(DIRUT)!(Y'=1),RE2
"RTN","XUSERNEW",20,0)
REACT ;SEA/WDE-REACTIVATE A USER
"RTN","XUSERNEW",21,0)
 S XUN=+$$LOOKUP^XUSER G EXIT:XUN<0
"RTN","XUSERNEW",22,0)
RE2 S XUSOLD=^VA(200,XUN,0),$P(^VA(200,XUN,0),U,11)=""
"RTN","XUSERNEW",23,0)
 S DIE=200,DR="["_$$GET^XUPARAM("XUREACT USER","N")_"]",DA=XUN D XUDIE^XUS5 G:$D(DTOUT) EXIT
"RTN","XUSERNEW",24,0)
 I $P(^VA(200,XUN,0),U,3)="" W !!,"No ACCESS CODE has been entered.",$C(7),!
"RTN","XUSERNEW",25,0)
 I $P(^VA(200,XUN,0),U,11)>0,$P(^(0),U,11)'>DT W !!,"User is still TERMINATED.",$C(7),!
"RTN","XUSERNEW",26,0)
 S DIR(0)="Y",DIR("A")="Deny access to old mail messages",DIR("B")="NO",DIR("?")="Enter a 'YES' to restrict access to old mail messages." D ^DIR G:$D(DIRUT) EXIT
"RTN","XUSERNEW",27,0)
 K XMZ S:Y=1 XMZ=+$P(^XMB(3.9,0),"^",3) S Y=XUN D NEW^XM K XMDT,XMM,XMZ
"RTN","XUSERNEW",28,0)
 G KEYS
"RTN","XUSERNEW",29,0)
 Q
"RTN","XUSERNEW",30,0)
ADD(NP1,KEYS) ;Common point to do DIC call for adding a new person.
"RTN","XUSERNEW",31,0)
 ;NP1 will be added to the default or what comes from the NPI field of the KSP.
"RTN","XUSERNEW",32,0)
 ;KEYS is a list of Keys to give the new person
"RTN","XUSERNEW",33,0)
 N DA,DR,DLAYGO,XUS1,XUS2,DIC,DIK,NP2,Y I $G(^XTV(8989.3,1,"NPI"))]"" X ^("NPI") S NP2=DR
"RTN","XUSERNEW",34,0)
 S:'$D(NP2) NP2="1;"_$S($D(^XUSEC("XUSPF200",DUZ)):9,1:"9R~")_";4"
"RTN","XUSERNEW",35,0)
 S DIC="^VA(200,",DIC(0)="AELMQ",DLAYGO=200,DIC("A")="Enter NEW PERSON's name (LAST,FIRST MI): ",DIC("DR")=""
"RTN","XUSERNEW",36,0)
 D ^DIC S XUS1=Y G AX:(Y'>0)!($P(Y,U,3)'>0)
"RTN","XUSERNEW",37,0)
 W !,"Now for the Identifiers."
"RTN","XUSERNEW",38,0)
 S DA=+XUS1,DIE=DIC,DR=NP2_$S($D(NP1):";"_NP1,1:""),DIE("NO^")="OUTOK"
"RTN","XUSERNEW",39,0)
 L +^VA(200,DA,0) D ^DIE L -^VA(200,DA,0)
"RTN","XUSERNEW",40,0)
 I $D(Y)!$D(DTOUT) W !?5,"<'",$P(^VA(200,DA,0),U),"' DELETED>" D
"RTN","XUSERNEW",41,0)
 . S DIK="^VA(200," D ^DIK S DIK="^DIC(3,",XUS1=$P($G(^DIC(3,DA,0)),U,16) D ^DIK S DIK="^DIC(16,",DA=XUS1 D:DA ^DIK S XUS1=-1
"RTN","XUSERNEW",42,0)
 . Q
"RTN","XUSERNEW",43,0)
 I $D(KEYS) F XUS2=1:1 S Y=$P(KEYS,",",XUS2) Q:'$L(Y)  S %=$$ADD^XQKEY(XUS1,Y) I '% W !,"Key '",Y,"' not allocated"
"RTN","XUSERNEW",44,0)
AX Q XUS1
"RTN","XUSERNEW",45,0)
REPRINT S DA=+$$LOOKUP^XUSER G EXIT:DA'>0
"RTN","XUSERNEW",46,0)
 D LETTER(DA) G EXIT
"RTN","XUSERNEW",47,0)
LETTER(XUN,ASK) ;Print access letter
"RTN","XUSERNEW",48,0)
 Q:'$G(XUN)  N DIWF,FR,TO,BY,DIR
"RTN","XUSERNEW",49,0)
 S XUTEXT=$$GET^XUPARAM("XUSER COMPUTER ACCOUNT","N"),XUTEXT=$O(^DIC(9.2,"B",XUTEXT,0))
"RTN","XUSERNEW",50,0)
 S DIR(0)="Y",DIR("A")="Print User Account Access Letter"
"RTN","XUSERNEW",51,0)
 I XUTEXT>0 S Y=1 D:$G(ASK) ^DIR I Y=1 D
"RTN","XUSERNEW",52,0)
 . S XUU="________",DIWF="^DIC(9.2,XUTEXT,1,",DIWF(1)=200,FR=XUN,TO=XUN,BY="NUMBER" D EN2^DIWF
"RTN","XUSERNEW",53,0)
 . Q
"RTN","XUSERNEW",54,0)
 K XUTEXT
"RTN","XUSERNEW",55,0)
 Q
"RTN","XUSG")
0^3^B7391539
"RTN","XUSG",1,0)
XUSG ;SFISC/RWF - SIGNON from GUI screen ;01/23/96  12:41
"RTN","XUSG",2,0)
 ;;8.0;KERNEL;**16**;Jul 10, 1995
"RTN","XUSG",3,0)
A K (ZUGUI1,ZUGUI2)
"RTN","XUSG",4,0)
 S XQXFLG("GUI")=$G(ZUGUI1)_"^"_$G(ZUGUI2) S:'$L(ZUGUI2) KWAPI=1
"RTN","XUSG",5,0)
 D SET1^XUS(1)
"RTN","XUSG",6,0)
 D PREP^XG,K^XG() K TMP
"RTN","XUSG",7,0)
 D GET^XGCLOAD("XU XUS W1",$NA(TMP("XUS")))
"RTN","XUSG",8,0)
 ;move INTRO text in to window.
"RTN","XUSG",9,0)
 D INTRO^XUS1A($NA(TMP("XUS","G","INTRO","CHOICE")))
"RTN","XUSG",10,0)
 S TMP("XUS","G","UCIVOL","TITLE")="UCI: "_XUCI_"   Volume set: "_XQVOL,TMP("XUS","G","DEV","TITLE")="Device: "_$S($D(IO("ZIO")):IO("ZIO"),1:$I)
"RTN","XUSG",11,0)
 D M^XG("XUS",$NA(TMP("XUS"))) K TMP("XUS")
"RTN","XUSG",12,0)
 D CLEAR S XUM=$$SET2^XUS() G:XUM NO
"RTN","XUSG",13,0)
 D SET^XGLTIMER("XUS","TIMER",2,60,"TO^XUSG")
"RTN","XUSG",14,0)
 D ESTA^XG() I $D(DTOUT)!(DUZ=0)!(XUM>0) G QUIT
"RTN","XUSG",15,0)
PGM ;
"RTN","XUSG",16,0)
 S Y=+$G(^%ZIS(1,XUDEV,201)) I Y>0 D CHK S XQY=Y G:Y O
"RTN","XUSG",17,0)
 S Y=+$G(^VA(200,DUZ,201)) I Y>0 D CHK S XQY=Y G:Y O
"RTN","XUSG",18,0)
 S XUM=5 G NO
"RTN","XUSG",19,0)
O D CHEK^XQ83
"RTN","XUSG",20,0)
 ;S:$P($G(XQXFLG("GUI")),U,2)="" KWAPI=1
"RTN","XUSG",21,0)
 S (XUA,PGM)="XQ" ;$S($D(KWAPI):"XQ",1:"XQSUITE")
"RTN","XUSG",22,0)
 D K^XG("XUS"),CLEAN^XG
"RTN","XUSG",23,0)
P G NEXT^XUS1
"RTN","XUSG",24,0)
 ;
"RTN","XUSG",25,0)
QUIT D K^XG("XUS")
"RTN","XUSG",26,0)
 Q  ;G HALT^ZU?
"RTN","XUSG",27,0)
CANCEL ;
"RTN","XUSG",28,0)
 S DUZ=0
"RTN","XUSG",29,0)
 D ESTO^XG
"RTN","XUSG",30,0)
 Q
"RTN","XUSG",31,0)
OK ;See if code is good.
"RTN","XUSG",32,0)
 S AV=$G(TMP("ACODE")) S:'$L($P(AV,";",2)) $P(AV,";",2)=$G(TMP("VCODE"))
"RTN","XUSG",33,0)
 G:AV="^;^" CANCEL
"RTN","XUSG",34,0)
 D CLEAR Q:AV=";"  S DUZ=$$CHECKAV^XUS(AV,.XUSER) K AV
"RTN","XUSG",35,0)
 S XUM=$$UVALID^XUS() G:XUM NO
"RTN","XUSG",36,0)
 D USERG^XUSG1 ;if needed call SEC^XUS3:($D(^%ZIS(1,XUDEV,"TIME"))!$D(^(95)))
"RTN","XUSG",37,0)
 D ESTO^XG
"RTN","XUSG",38,0)
 Q
"RTN","XUSG",39,0)
KEYDOWN ;Keydown to convert key to *
"RTN","XUSG",40,0)
 I $D(%DEBUG) D  W !
"RTN","XUSG",41,0)
 . W ! S X="^$E" F  S X=$Q(@X) Q:X=""  W !,X," = ",@X
"RTN","XUSG",42,0)
 . Q
"RTN","XUSG",43,0)
 N GNM,WNM,KEY
"RTN","XUSG",44,0)
 S WNM=@XGEVENT@("WINDOW"),X=@XGEVENT@("ELEMENT"),GTYPE=$P(X,","),GNM=$P(X,",",2)
"RTN","XUSG",45,0)
 S KEY=$$UCASE(@XGEVENT@("KEY")),VALUE=$G(TMP(GNM))
"RTN","XUSG",46,0)
 ;I (KEY="DELETE")!(KEY="BACKSPACE") S VALUE=$E(VALUE,1,$L(VALUE)-1)
"RTN","XUSG",47,0)
 I "^DELETE^BACKSPACE^BS^"[(U_KEY_U) S VALUE=$E(VALUE,1,$L(VALUE)-1)
"RTN","XUSG",48,0)
 I $L(KEY)>1 S KEY=$$KEYCNV^XGLKEY(KEY)
"RTN","XUSG",49,0)
 I $L(KEY)=1 S VALUE=VALUE_KEY
"RTN","XUSG",50,0)
 S X=$TR($J("",$L(VALUE))," ","*"),TMP(GNM)=VALUE
"RTN","XUSG",51,0)
 D S^XG(WNM,"G",GNM,"VALUE",X),S^XG(WNM,"G",GNM,"INSELECT",$L(X)_",0")
"RTN","XUSG",52,0)
 Q
"RTN","XUSG",53,0)
NO S XUM=$$NO^XUS3()
"RTN","XUSG",54,0)
 D CLEAR Q:'XUM
"RTN","XUSG",55,0)
 D ESTO^XG
"RTN","XUSG",56,0)
 Q
"RTN","XUSG",57,0)
CLEAR ;
"RTN","XUSG",58,0)
 F X="ACODE","VCODE" D S^XG("XUS","G",X,"VALUE","") K TMP(X)
"RTN","XUSG",59,0)
 D SD^XG($PD,"FOCUS","XUS,ACODE")
"RTN","XUSG",60,0)
 Q
"RTN","XUSG",61,0)
UCASE(%) ;
"RTN","XUSG",62,0)
 Q $TR(%,"abcdefghijklmnopqrstuvwxyz","ABCDEFGHIJKLMNOPQRSTUVWXYZ")
"RTN","XUSG",63,0)
CHK ;Check if valid option
"RTN","XUSG",64,0)
 I $D(^DIC(19,Y,0)),$S($P(^(0),U,6)="":1,1:$D(^XUSEC($P(^(0),U,6),DUZ))) Q
"RTN","XUSG",65,0)
 S Y=0 Q
"RTN","XUSG",66,0)
TO ;CALL ON A TIME OUT
"RTN","XUSG",67,0)
 D ^XGLMSG("E","TIME OUT",5)
"RTN","XUSG",68,0)
 D ESTO^XG
"RTN","XUSG",69,0)
 Q
"RTN","XUSRB")
0^4^B29903747
"RTN","XUSRB",1,0)
XUSRB ;ISCSF/RWF - Request Broker ;01/23/96  12:42
"RTN","XUSRB",2,0)
 ;;8.0;KERNEL;**11,16**;Jul 05, 1995
"RTN","XUSRB",3,0)
 Q  ;No entry from top
"RTN","XUSRB",4,0)
 ;
"RTN","XUSRB",5,0)
 ;DATA BROKER calls, First parameter is always call-by-reference
"RTN","XUSRB",6,0)
VALIDAV(RESULT,AVCODE) ;Check a users access
"RTN","XUSRB",7,0)
 ;Return DUZ^session ok^verify needs changing
"RTN","XUSRB",8,0)
 S AVCODE=$$DECRYP(AVCODE)
"RTN","XUSRB",9,0)
 D A1
"RTN","XUSRB",10,0)
 N X,XUSER,XUF,%1 S U="^",XUF=0,DUZ=$$CHECKAV^XUS(AVCODE,.XUSER)
"RTN","XUSRB",11,0)
 S RESULT=DUZ_"^1^"_$$VCVALID
"RTN","XUSRB",12,0)
 Q
"RTN","XUSRB",13,0)
 ;
"RTN","XUSRB",14,0)
 ;
"RTN","XUSRB",15,0)
INTRO(RESULT) ;Return INTRO TEXT.
"RTN","XUSRB",16,0)
 D INTRO^XUS1A("RESULT")
"RTN","XUSRB",17,0)
 Q
"RTN","XUSRB",18,0)
 ;
"RTN","XUSRB",19,0)
 ;
"RTN","XUSRB",20,0)
VCVALID() ;Check if the Verify code needs changing.
"RTN","XUSRB",21,0)
 Q:'$G(DUZ) 1
"RTN","XUSRB",22,0)
 Q $G(^VA(200,DUZ,.1))+$P(^XTV(8989.3,1,"XUS"),"^",15)'>(+$H)
"RTN","XUSRB",23,0)
 ;
"RTN","XUSRB",24,0)
 ;
"RTN","XUSRB",25,0)
CVC(RESULT,XU1) ;change VC
"RTN","XUSRB",26,0)
 S RESULT=0 Q:$G(DUZ)'>0  N XU2 S U="^",XU2=$P(XU1,U,2),XU1=$P(XU1,U)
"RTN","XUSRB",27,0)
 ;S XU1=$$DECRYP(XU1),XU2=$$DECRYP(XU2)
"RTN","XUSRB",28,0)
 Q $$XXCVC^XUS2(XU1,XU2)
"RTN","XUSRB",29,0)
 ;
"RTN","XUSRB",30,0)
 ;
"RTN","XUSRB",31,0)
POST(RESULT) ;Finish setup partition
"RTN","XUSRB",32,0)
 S RESULT=0 Q:$G(DUZ)'>0  D DUZ^XUS1A,USER^XUS1A
"RTN","XUSRB",33,0)
 S RESULT=1 M RESULT(1)=XUTXT
"RTN","XUSRB",34,0)
 K ^UTILITY($J),^TMP($J),^XUTL("XQ",$J)
"RTN","XUSRB",35,0)
 Q
"RTN","XUSRB",36,0)
 ;
"RTN","XUSRB",37,0)
 ;
"RTN","XUSRB",38,0)
SETUP(RESULT) ;sets up environment for GUI signon
"RTN","XUSRB",39,0)
 D SET1^XUS(0)
"RTN","XUSRB",40,0)
 S RESULT(0)=$P(XUENV,U,3)   ;server name
"RTN","XUSRB",41,0)
 S RESULT(1)=$P(XUVOL,U)     ;volume
"RTN","XUSRB",42,0)
 S RESULT(2)=XUCI            ;uci
"RTN","XUSRB",43,0)
 S RESULT(3)=$I              ;device
"RTN","XUSRB",44,0)
 Q
"RTN","XUSRB",45,0)
 ;
"RTN","XUSRB",46,0)
 ;
"RTN","XUSRB",47,0)
DECRYP(S) ;decrypt passed string
"RTN","XUSRB",48,0)
 ;VYD 5/19/95
"RTN","XUSRB",49,0)
 N ASSOCIX,IDIX,ASSOCSTR,IDSTR
"RTN","XUSRB",50,0)
 S ASSOCIX=$A($E(S,$L(S)))-31           ;get associator string index
"RTN","XUSRB",51,0)
 S IDIX=$A($E(S))-31                    ;get identifier string index
"RTN","XUSRB",52,0)
 S ASSOCSTR=$P($T(Z+ASSOCIX),";",3,9)   ;get associator string
"RTN","XUSRB",53,0)
 S IDSTR=$P($T(Z+IDIX),";",3,9)         ;get identifier string
"RTN","XUSRB",54,0)
 Q $TR($E(S,2,$L(S)-1),ASSOCSTR,IDSTR)  ;translated result
"RTN","XUSRB",55,0)
 ;
"RTN","XUSRB",56,0)
 ;
"RTN","XUSRB",57,0)
SENDKEYS(RESULT) ;send encryption keys to the client
"RTN","XUSRB",58,0)
 ;VYD 5/19/95
"RTN","XUSRB",59,0)
 N %,X
"RTN","XUSRB",60,0)
 S %=1
"RTN","XUSRB",61,0)
 F  S X=$P($T(Z+%),";",3,9) Q:X=""  S RESULT(%)=X,%=%+1
"RTN","XUSRB",62,0)
 Q
"RTN","XUSRB",63,0)
 ;
"RTN","XUSRB",64,0)
 ;
"RTN","XUSRB",65,0)
A1 ;Set some basics.
"RTN","XUSRB",66,0)
 S U="^",DT=$$DT^XLFDT()
"RTN","XUSRB",67,0)
 Q
"RTN","XUSRB",68,0)
 ;
"RTN","XUSRB",69,0)
 ;
"RTN","XUSRB",70,0)
BLDDRUM Q  ;don't run this tag
"RTN","XUSRB",71,0)
 N I,%,ALLCHARS,RNDMSTR,CHAR
"RTN","XUSRB",72,0)
 X "ZP Z"                      ;position insertion point
"RTN","XUSRB",73,0)
 F I=1:1:20 D
"RTN","XUSRB",74,0)
 . S ALLCHARS="" F %=32:1:126 S:$C(%)'="^" ALLCHARS=ALLCHARS_$C(%)
"RTN","XUSRB",75,0)
 . S RNDMSTR=""
"RTN","XUSRB",76,0)
 . F %=1:1:94 D
"RTN","XUSRB",77,0)
 . . S POS=$R($L(ALLCHARS))+1,CHAR=$E(ALLCHARS,POS)
"RTN","XUSRB",78,0)
 . . S RNDMSTR=RNDMSTR_CHAR
"RTN","XUSRB",79,0)
 . . S ALLCHARS=$P(ALLCHARS,CHAR,1)_$P(ALLCHARS,CHAR,2) ;compress by 1
"RTN","XUSRB",80,0)
 . X "ZI "" ;;""_RNDMSTR"      ;save random string in routine
"RTN","XUSRB",81,0)
 X "ZS"                        ;save routine
"RTN","XUSRB",82,0)
 Q
"RTN","XUSRB",83,0)
 ;
"RTN","XUSRB",84,0)
 ;
"RTN","XUSRB",85,0)
Z ;;
"RTN","XUSRB",86,0)
 ;;wkEo-ZJt!dG)49K{nX1BS$vH<&:Myf*>Ae0jQW=;|#PsO`'%+rmb[gpqN,l6/hFC@DcUa ]z~R}"V\iIxu?872.(TYL5_3
"RTN","XUSRB",87,0)
 ;;rKv`R;M/9BqAF%&tSs#Vh)dO1DZP> *fX'u[.4lY=-mg_ci802N7LTG<]!CWo:3?{+,5Q}(@jaExn$~p\IyHwzU"|k6Jeb
"RTN","XUSRB",88,0)
 ;;\pV(ZJk"WQmCn!Y,y@1d+~8s?[lNMxgHEt=uw|X:qSLjAI*}6zoF{T3#;ca)/h5%`P4$r]G'9e2if_>UDKb7<v0&- RBO.
"RTN","XUSRB",89,0)
 ;;depjt3g4W)qD0V~NJar\B "?OYhcu[<Ms%Z`RIL_6:]AX-zG.#}$@vk7/5x&*m;(yb2Fn+l'PwUof1K{9,|EQi>H=CT8S!
"RTN","XUSRB",90,0)
 ;;NZW:1}K$byP;jk)7'`x90B|cq@iSsEnu,(l-hf.&Y_?J#R]+voQXU8mrV[!p4tg~OMez CAaGFD6H53%L/dT2<*>"{\wI=
"RTN","XUSRB",91,0)
 ;;vCiJ<oZ9|phXVNn)m K`t/SI%]A5qOWe\&?;jT~M!fz1l>[D_0xR32c*4.P"G{r7}E8wUgyudF+6-:B=$(sY,LkbHa#'@Q
"RTN","XUSRB",92,0)
 ;;hvMX,'4Ty;[a8/{6l~F_V"}qLI\!@x(D7bRmUH]W15J%N0BYPkrs&9:$)Zj>u|zwQ=ieC-oGA.#?tfdcO3gp`S+En K2*<
"RTN","XUSRB",93,0)
 ;;jd!W5[];4'<C$/&x|rZ(k{>?ghBzIFN}fAK"#`p_TqtD*1E37XGVs@0nmSe+Y6Qyo-aUu%i8c=H2vJ\) R:MLb.9,wlO~P
"RTN","XUSRB",94,0)
 ;;2ThtjEM+!=xXb)7,ZV{*ci3"8@_l-HS69L>]\AUF/Q%:qD?1~m(yvO0e'<#o$p4dnIzKP|`NrkaGg.ufCRB[; sJYwW}5&
"RTN","XUSRB",95,0)
 ;;vB\5/zl-9y:Pj|=(R'7QJI *&CTX"p0]_3.idcuOefVU#omwNZ`$Fs?L+1Sk<,b)hM4A6[Y%aDrg@~KqEW8t>H};n!2xG{
"RTN","XUSRB",96,0)
 ;;sFz0Bo@_HfnK>LR}qWXV+D6`Y28=4Cm~G/7-5A\b9!a#rP.l&M$hc3ijQk;),TvUd<[:I"u1'NZSOw]*gxtE{eJp|y (?%
"RTN","XUSRB",97,0)
 ;;M@,D}|LJyGO8`$*ZqH .j>c~h<d=fimszv[#-53F!+a;NC'6T91IV?(0x&/{B)w"]Q\YUWprk4:ol%g2nE7teRKbAPuS_X
"RTN","XUSRB",98,0)
 ;;.mjY#_0*H<B=Q+FML6]s;r2:e8R}[ic&KA 1w{)vV5d,$u"~xD/Pg?IyfthO@CzWp%!`N4Z'3-(o|J9XUE7k\TlqSb>anG
"RTN","XUSRB",99,0)
 ;;xVa1']_GU<X`|\NgM?LS9{"jT%s$}y[nvtlefB2RKJW~(/cIDCPow4,>#zm+:5b@06O3Ap8=*7ZFY!H-uEQk; .q)i&rhd
"RTN","XUSRB",100,0)
 ;;I]Jz7AG@QX."%3Lq>METUo{Pp_ |a6<0dYVSv8:b)~W9NK`(r'4fs&wim\kReC2hg=HOj$1B*/nxt,;c#y+![?lFuZ-5D}
"RTN","XUSRB",101,0)
 ;;Rr(Ge6F Hx>q$m&C%M~Tn,:"o'tX/*yP.{lZ!YkiVhuw_<KE5a[;}W0gjsz3]@7cI2\QN?f#4p|vb1OUBD9)=-LJA+d`S8
"RTN","XUSRB",102,0)
 ;;I~k>y|m};d)-7DZ"Fe/Y<B:xwojR,Vh]O0Sc[`$sg8GXE!1&Qrzp._W%TNK(=J 3i*2abuHA4C'?Mv\Pq{n#56LftUl@9+
"RTN","XUSRB",103,0)
 ;;~A*>9 WidFN,1KsmwQ)GJM{I4:C%}#Ep(?HB/r;t.&U8o|l['Lg"2hRDyZ5`nbf]qjc0!zS-TkYO<_=76a\X@$Pe3+xVvu
"RTN","XUSRB",104,0)
 ;;yYgjf"5VdHc#uA,W1i+v'6|@pr{n;DJ!8(btPGaQM.LT3oe?NB/&9>Z`-}02*%x<7lsqz4OS ~E$\R]KI[:UwC_=h)kXmF
"RTN","XUSRB",105,0)
 ;;5:iar.{YU7mBZR@-K|2 "+~`M%8sq4JhPo<_X\Sg3WC;Tuxz,fvEQ1p9=w}FAI&j/keD0c?)LN6OHV]lGy'$*>nd[(tb!#
"VER")
8.0^21.0
**END**
**END**
