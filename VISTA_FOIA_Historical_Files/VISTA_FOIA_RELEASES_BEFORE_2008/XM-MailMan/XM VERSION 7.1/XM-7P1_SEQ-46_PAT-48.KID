Released XM*7.1*48 SEQ #46
Extracted from mail message
**KIDS**:XM*7.1*48^

**INSTALL NAME**
XM*7.1*48
"BLD",31,0)
XM*7.1*48^MAILMAN^0^2970722^n
"BLD",31,1,0)
^^42^42^2970722^^^^
"BLD",31,1,1,0)
MailMan patch XM*7.1*48 contains the following bug fix:
"BLD",31,1,2,0)

"BLD",31,1,3,0)
NOIS:       BRK-0197-10525
"BLD",31,1,4,0)
Rtn:        ^XMS
"BLD",31,1,5,0)
Test Site:  Brockton, MA
"BLD",31,1,6,0)
Code $S($D(...):^(),1:"") replaced with $G(...).
"BLD",31,1,7,0)
Code is functionally equivalent, but former code was causing problems at
"BLD",31,1,8,0)
the site.
"BLD",31,1,9,0)

"BLD",31,1,10,0)
===========================================================================
"BLD",31,1,11,0)
This patch should be installed during off-peak hours when network mail
"BLD",31,1,12,0)
activity is low.  This patch can be installed with users on the system.
"BLD",31,1,13,0)
===========================================================================
"BLD",31,1,14,0)
 
"BLD",31,1,15,0)
INSTALLATION:
"BLD",31,1,16,0)
1.  If any of these routines is mapped (on systems which allow mapping),
"BLD",31,1,17,0)
    disable mapping for the affected routine(s).
"BLD",31,1,18,0)
2.  On the PackMan menu, use the 'INSTALL/CHECK MESSAGE' option.  This loads
"BLD",31,1,19,0)
    the patch into a Transport Global on your system.
"BLD",31,1,20,0)
3.  On the KIDS:Installation menu, use the following options to install the
"BLD",31,1,21,0)
    Transport Global:
"BLD",31,1,22,0)
       Verify Checksums in Transport Global
"BLD",31,1,23,0)
       Print Transport Global
"BLD",31,1,24,0)
       Compare Transport Global to Current System
"BLD",31,1,25,0)
       Backup a Transport Global
"BLD",31,1,26,0)
       Install Package(s)
"BLD",31,1,27,0)
4.  MSM Sites - Answer YES to the question 'Want to MOVE routines to
"BLD",31,1,28,0)
    other CPUs?'. Enter the names of your Compute and Print server(s).
"BLD",31,1,29,0)
5.  AXP Sites, after patch has installed, rebuild your map set.
"BLD",31,1,30,0)
============================================================================ 
"BLD",31,1,31,0)
  
"BLD",31,1,32,0)
ROUTINES:
"BLD",31,1,33,0)
The second line of the routine now looks like:
"BLD",31,1,34,0)
       ;;7.1;MailMan;**[patch list]**;Jun 02, 1994
"BLD",31,1,35,0)
 
"BLD",31,1,36,0)
              Before          After
"BLD",31,1,37,0)
Name          Checksum        Checksum        Patch List
"BLD",31,1,38,0)
----------------------------------------------------------
"BLD",31,1,39,0)
XMS           5910151         5835931         8,20,34,48
"BLD",31,1,40,0)

"BLD",31,1,41,0)
* Checksums produced by CHECK^XTSUMBLD
"BLD",31,1,42,0)
============================================================================
"BLD",31,4,0)
^9.64PA^^0
"BLD",31,"INI")

"BLD",31,"INIT")

"BLD",31,"KRN",0)
^9.67PA^19^12
"BLD",31,"KRN",.4,0)
.4
"BLD",31,"KRN",.401,0)
.401
"BLD",31,"KRN",.402,0)
.402
"BLD",31,"KRN",.403,0)
.403
"BLD",31,"KRN",.5,0)
.5
"BLD",31,"KRN",.84,0)
.84
"BLD",31,"KRN",3.6,0)
3.6
"BLD",31,"KRN",3.8,0)
3.8
"BLD",31,"KRN",9.2,0)
9.2
"BLD",31,"KRN",9.8,0)
9.8
"BLD",31,"KRN",9.8,"NM",0)
^9.68A^1^1
"BLD",31,"KRN",9.8,"NM",1,0)
XMS^^0^B11949586
"BLD",31,"KRN",9.8,"NM","B","XMS",1)

"BLD",31,"KRN",19,0)
19
"BLD",31,"KRN",19,"NM",0)
^9.68A^^0
"BLD",31,"KRN",19.1,0)
19.1
"BLD",31,"KRN",19.1,"NM",0)
^9.68A^^
"BLD",31,"KRN","B",.4,.4)

"BLD",31,"KRN","B",.401,.401)

"BLD",31,"KRN","B",.402,.402)

"BLD",31,"KRN","B",.403,.403)

"BLD",31,"KRN","B",.5,.5)

"BLD",31,"KRN","B",.84,.84)

"BLD",31,"KRN","B",3.6,3.6)

"BLD",31,"KRN","B",3.8,3.8)

"BLD",31,"KRN","B",9.2,9.2)

"BLD",31,"KRN","B",9.8,9.8)

"BLD",31,"KRN","B",19,19)

"BLD",31,"KRN","B",19.1,19.1)

"BLD",31,"QUES",0)
^9.62^^
"BLD",31,"REQB",0)
^9.611^^
"PKG",6,-1)
1^1
"PKG",6,0)
MAILMAN^XM^Electronic Mail, both local and networked
"PKG",6,22,0)
^9.49I^1^1
"PKG",6,22,1,0)
7.1^2940602^2950925
"PKG",6,22,1,"PAH",1,0)
48^2970722
"PKG",6,22,1,"PAH",1,1,0)
^^42^42^2970722
"PKG",6,22,1,"PAH",1,1,1,0)
MailMan patch XM*7.1*48 contains the following bug fix:
"PKG",6,22,1,"PAH",1,1,2,0)

"PKG",6,22,1,"PAH",1,1,3,0)
NOIS:       BRK-0197-10525
"PKG",6,22,1,"PAH",1,1,4,0)
Rtn:        ^XMS
"PKG",6,22,1,"PAH",1,1,5,0)
Test Site:  Brockton, MA
"PKG",6,22,1,"PAH",1,1,6,0)
Code $S($D(...):^(),1:"") replaced with $G(...).
"PKG",6,22,1,"PAH",1,1,7,0)
Code is functionally equivalent, but former code was causing problems at
"PKG",6,22,1,"PAH",1,1,8,0)
the site.
"PKG",6,22,1,"PAH",1,1,9,0)

"PKG",6,22,1,"PAH",1,1,10,0)
===========================================================================
"PKG",6,22,1,"PAH",1,1,11,0)
This patch should be installed during off-peak hours when network mail
"PKG",6,22,1,"PAH",1,1,12,0)
activity is low.  This patch can be installed with users on the system.
"PKG",6,22,1,"PAH",1,1,13,0)
===========================================================================
"PKG",6,22,1,"PAH",1,1,14,0)
 
"PKG",6,22,1,"PAH",1,1,15,0)
INSTALLATION:
"PKG",6,22,1,"PAH",1,1,16,0)
1.  If any of these routines is mapped (on systems which allow mapping),
"PKG",6,22,1,"PAH",1,1,17,0)
    disable mapping for the affected routine(s).
"PKG",6,22,1,"PAH",1,1,18,0)
2.  On the PackMan menu, use the 'INSTALL/CHECK MESSAGE' option.  This loads
"PKG",6,22,1,"PAH",1,1,19,0)
    the patch into a Transport Global on your system.
"PKG",6,22,1,"PAH",1,1,20,0)
3.  On the KIDS:Installation menu, use the following options to install the
"PKG",6,22,1,"PAH",1,1,21,0)
    Transport Global:
"PKG",6,22,1,"PAH",1,1,22,0)
       Verify Checksums in Transport Global
"PKG",6,22,1,"PAH",1,1,23,0)
       Print Transport Global
"PKG",6,22,1,"PAH",1,1,24,0)
       Compare Transport Global to Current System
"PKG",6,22,1,"PAH",1,1,25,0)
       Backup a Transport Global
"PKG",6,22,1,"PAH",1,1,26,0)
       Install Package(s)
"PKG",6,22,1,"PAH",1,1,27,0)
4.  MSM Sites - Answer YES to the question 'Want to MOVE routines to
"PKG",6,22,1,"PAH",1,1,28,0)
    other CPUs?'. Enter the names of your Compute and Print server(s).
"PKG",6,22,1,"PAH",1,1,29,0)
5.  AXP Sites, after patch has installed, rebuild your map set.
"PKG",6,22,1,"PAH",1,1,30,0)
============================================================================ 
"PKG",6,22,1,"PAH",1,1,31,0)
  
"PKG",6,22,1,"PAH",1,1,32,0)
ROUTINES:
"PKG",6,22,1,"PAH",1,1,33,0)
The second line of the routine now looks like:
"PKG",6,22,1,"PAH",1,1,34,0)
       ;;7.1;MailMan;**[patch list]**;Jun 02, 1994
"PKG",6,22,1,"PAH",1,1,35,0)
 
"PKG",6,22,1,"PAH",1,1,36,0)
              Before          After
"PKG",6,22,1,"PAH",1,1,37,0)
Name          Checksum        Checksum        Patch List
"PKG",6,22,1,"PAH",1,1,38,0)
----------------------------------------------------------
"PKG",6,22,1,"PAH",1,1,39,0)
XMS           5910151         5835931         8,20,34,48
"PKG",6,22,1,"PAH",1,1,40,0)

"PKG",6,22,1,"PAH",1,1,41,0)
* Checksums produced by CHECK^XTSUMBLD
"PKG",6,22,1,"PAH",1,1,42,0)
============================================================================
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
1
"RTN","XMS")
0^1^B11949586
"RTN","XMS",1,0)
XMS ;(WASH ISC)/THM/CAP-SMTP TRANSMITTER ;07/22/97  10:46
"RTN","XMS",2,0)
V ;;7.1;MailMan;**8,20,34,48**;Jun 02, 1994
"RTN","XMS",3,0)
 ; XMVA=1 communicating to MailMan
"RTN","XMS",4,0)
 ; $D(XMSLOCAL)=version# for MailMan AFTER 3.09
"RTN","XMS",5,0)
 S:'$D(XMTURN) XMTURN=0 S XMDUZ=.5,ER=0 S:'$D(XMBT) XMBT=0 S $P(^XMBS(4.2999,XMINST,3),U,6)=IO_" "_XMPROT
"RTN","XMS",6,0)
 S XMLST=$H*86400+$P($H,",",2)-.001 I '$D(DT) D DT^DICRW
"RTN","XMS",7,0)
EN D XX G:'XMTURN QUIT Q
"RTN","XMS",8,0)
XX S A=0 K XMBLOCK,XMTSUM,XMY D:'XMBT SYNCH Q:ER
"RTN","XMS",9,0)
 S XMTLER=0 I $D(XMCHRS) G CHRS
"RTN","XMS",10,0)
 I $D(XMST) G TST
"RTN","XMS",11,0)
 D HELO L -^DIC(4.2,XMINST,0) Q:ER
"RTN","XMS",12,0)
 S XMZ=0 D SEND Q:ER
"RTN","XMS",13,0)
 Q:XMTURN  S XMTURN=1,$P(^XMBS(4.2999,XMINST,3),U,7)=$S($D(ZTQUEUED):ZTSK,1:"") Q:XMBT  G TURN^XMS0
"RTN","XMS",14,0)
SYNCH X XMREC I '$D(XMRG) N XMRG S XMRG=""
"RTN","XMS",15,0)
 S:'$D(XMVA) XMVA=0 S %=$P(XMRG," MailMan ",2) I %[" ready"!XMBT S XMVA=1+$S(+%>4:+%,1:0)
"RTN","XMS",16,0)
 I ER!($E(XMRG)=2)!(A>5) Q
"RTN","XMS",17,0)
 S A=A+1 S XMSG="NOOP" X XMSEN Q:ER
"RTN","XMS",18,0)
 G SYNCH
"RTN","XMS",19,0)
SEND D NEXT^XMS0 Q:XMZ'>0
"RTN","XMS",20,0)
 L +^XMNET(XMINST,XMZ):0 E  S ER=1,XMER=1 G LOCKER^XMS0A
"RTN","XMS",21,0)
 K XMER,XMTLER,XMJ,XMBLOCK,XMLIN
"RTN","XMS",22,0)
 S %=$G(^XMBS(4.2999,XMINST,3)),$P(%,U,1,2)=$H_U_XMZ,$P(%,U,6)=IO,^(3)=%
"RTN","XMS",23,0)
 D MAIL L -^XMNET(XMINST,XMZ) I ER S XMER=1 Q
"RTN","XMS",24,0)
 D POST^XMS0 G SEND
"RTN","XMS",25,0)
HELO ;ESTABLISH LINK
"RTN","XMS",26,0)
 L +^DIC(4.2,XMINST,0):0 E  S ER=1 S XMTRAN="Domain file locked (HELO^XMS)." D TRAN^XMC1 Q
"RTN","XMS",27,0)
 S Y3=^DIC(4.2,XMINST,0) K XMSLOCAL
"RTN","XMS",28,0)
H1 S XMSG="HELO "_^XMB("NETNAME")
"RTN","XMS",29,0)
 I $P(Y3,U,15)'="" S XMSG=XMSG_"<"_$P(Y3,U,15)_">"
"RTN","XMS",30,0)
 X XMSEN S:XMBT XMSLOCAL=+$P($T(V),";",3)
"RTN","XMS",31,0)
 I ER S Y="HELO SEND failed ("_XMSG_")"
"RTN","XMS",32,0)
 Q:ER!XMBT
"RTN","XMS",33,0)
 X XMREC I ER S Y="HELO RECEIVE failed." Q
"RTN","XMS",34,0)
 S Y=XMRG
"RTN","XMS",35,0)
 I $E(Y)'=2 G HELONO^XMSERR
"RTN","XMS",36,0)
 S:Y[">" Y=$P(Y,">",2) S Y=$P(Y,"[",2) I Y'="" S XMSLOCAL=Y
"RTN","XMS",37,0)
 S J=$P($P(XMRG,"<",2),">") I $P(Y3,U,15)'="",+J<1000000 G VALBAD^XMSERR
"RTN","XMS",38,0)
 ;Double set below prevents replicated ^DIC from
"RTN","XMS",39,0)
 ;going out of synch when link is down.
"RTN","XMS",40,0)
 S ^DIC(4.2,XMINST,0)=Y3,$P(Y3,U,15)=J,^(0)=Y3
"RTN","XMS",41,0)
 K Y3 Q
"RTN","XMS",42,0)
MAIL ;SEND MAIL
"RTN","XMS",43,0)
 G ^XMSMAIL
"RTN","XMS",44,0)
QUIT I $D(XMBLOCK) D KILL^XML4CRC
"RTN","XMS",45,0)
 S XMSTIME=180,XMSG="QUIT" X XMSEN K XMSTIME H 3 Q:ER  X XMREC Q
"RTN","XMS",46,0)
RESET ;
"RTN","XMS",47,0)
 S XMSG="RSET" X XMSEN Q:ER!XMBT  X XMREC Q:ER  I $E(XMRG)'=2 S ER=1 Q
"RTN","XMS",48,0)
TRASH ;CLEAN UP FOR SENT MESSAGE
"RTN","XMS",49,0)
 Q:$D(^XMB(3.9,XMZ,1,"AQUEUE",XMINST))
"RTN","XMS",50,0)
 S (XMKD,XMK)=1000+XMINST K XMDI
"RTN","XMS",51,0)
 D KL^XMA1B H 1 K XMKD
"RTN","XMS",52,0)
 Q
"RTN","XMS",53,0)
CHRS ;Christen command
"RTN","XMS",54,0)
 S XMSG="CHRS "_XMCHRS X XMSEN Q:ER  X XMREC Q:ER
"RTN","XMS",55,0)
TST ;TEST LINK
"RTN","XMS",56,0)
 S XMSG="ECHO" X XMSEN G:ER TP X XMREC G:ER TP D T U IO(0) G SHOW
"RTN","XMS",57,0)
T S A=$H,(I,XMTLER,C,D,J)=0
"RTN","XMS",58,0)
T1 S I=$O(^TMP("XMS",$J,"S",I)) G:+I<1 TE S XMSG=^(I) S J=J+1 X XMSEN G:ER TP
"RTN","XMS",59,0)
 S C=C+(2*$L(XMSG)) X XMREC G:ER TP I XMRG'=XMSG U IO(0) S XMSG="*****Sent:  "_XMSG D TRAN^XMC1 S XMSG="*****Rec'd: "_XMRG S D=D+1 U IO
"RTN","XMS",60,0)
 G T1
"RTN","XMS",61,0)
TE S XMSG="." X XMSEN G:ER TP X XMREC Q
"RTN","XMS",62,0)
TP S XMSG="****Physical link protocol error.  Unable to proceed" D TRAN^XMC1 Q
"RTN","XMS",63,0)
SHOW S B=$H S XMSG=J_" Lines,"_C_" bytes transmitted. " D TRAN^XMC1 S XMSG=D_" unrecoverable, "_XMTLER_" recoverable error"_$S(XMTLER:"",1:"s")_" detected."
"RTN","XMS",64,0)
 S XMSG=$J(C/($P(B,",",2)-$P(A,",",2)),0,1)_" Bytes/sec effective transmission rate." D TRAN^XMC1
"RTN","XMS",65,0)
BAT ;BATCH DUMP
"RTN","XMS",66,0)
 S:'$D(XMCHAN) XMCHAN="TAPE" G BGO^XMS3
"RTN","XMS",67,0)
TASKER ;TASKMANAGER DUMP TO ANOTHER UCI
"RTN","XMS",68,0)
 D SEND^XMS3 L  Q
"VER")
8.0^21.0
**END**
**END**
