Released GMTS*2.7*58 SEQ #56
Extracted from mail message
**KIDS**:GMTS*2.7*58^

**INSTALL NAME**
GMTS*2.7*58
"BLD",3798,0)
GMTS*2.7*58^HEALTH SUMMARY^0^3030106^y
"BLD",3798,1,0)
^^2^2^3020823^^
"BLD",3798,1,1,0)
The description of this build is found in the National Patch Module under 
"BLD",3798,1,2,0)
patch GMTS*2.7*58.
"BLD",3798,4,0)
^9.64PA^142.5^1
"BLD",3798,4,142.5,0)
142.5
"BLD",3798,4,142.5,222)
y^y^f^^^^n
"BLD",3798,4,"B",142.5,142.5)

"BLD",3798,"INID")
^y
"BLD",3798,"INIT")
POST^GMTSP58
"BLD",3798,"KRN",0)
^9.67PA^8989.52^19
"BLD",3798,"KRN",.4,0)
.4
"BLD",3798,"KRN",.401,0)
.401
"BLD",3798,"KRN",.402,0)
.402
"BLD",3798,"KRN",.402,"NM",0)
^9.68A^3^3
"BLD",3798,"KRN",.402,"NM",1,0)
GMTS DELETE HLTH SUM TYPE    FILE #142^142^0
"BLD",3798,"KRN",.402,"NM",2,0)
GMTS EDIT EXIST HS TYPE    FILE #142^142^0
"BLD",3798,"KRN",.402,"NM",3,0)
GMTS EDIT HLTH SUM TYPE    FILE #142^142^0
"BLD",3798,"KRN",.402,"NM","B","GMTS DELETE HLTH SUM TYPE    FILE #142",1)

"BLD",3798,"KRN",.402,"NM","B","GMTS EDIT EXIST HS TYPE    FILE #142",2)

"BLD",3798,"KRN",.402,"NM","B","GMTS EDIT HLTH SUM TYPE    FILE #142",3)

"BLD",3798,"KRN",.403,0)
.403
"BLD",3798,"KRN",.5,0)
.5
"BLD",3798,"KRN",.84,0)
.84
"BLD",3798,"KRN",3.6,0)
3.6
"BLD",3798,"KRN",3.8,0)
3.8
"BLD",3798,"KRN",9.2,0)
9.2
"BLD",3798,"KRN",9.8,0)
9.8
"BLD",3798,"KRN",9.8,"NM",0)
^9.68A^34^33
"BLD",3798,"KRN",9.8,"NM",1,0)
GMTSOBA^^0^B37765942
"BLD",3798,"KRN",9.8,"NM",2,0)
GMTSOBH^^0^B57661517
"BLD",3798,"KRN",9.8,"NM",3,0)
GMTSOBJ^^0^B46826782
"BLD",3798,"KRN",9.8,"NM",4,0)
GMTSOBT^^0^B57073693
"BLD",3798,"KRN",9.8,"NM",5,0)
GMTS1^^0^B23058126
"BLD",3798,"KRN",9.8,"NM",6,0)
GMTSOBS^^0^B64484788
"BLD",3798,"KRN",9.8,"NM",7,0)
GMTSUP^^0^B46571135
"BLD",3798,"KRN",9.8,"NM",8,0)
GMTSOBL^^0^B64743466
"BLD",3798,"KRN",9.8,"NM",9,0)
GMTS2^^0^B4233437
"BLD",3798,"KRN",9.8,"NM",10,0)
GMTSCNB^^0^B46561093
"BLD",3798,"KRN",9.8,"NM",11,0)
GMTSLRC^^0^B5417657
"BLD",3798,"KRN",9.8,"NM",12,0)
GMTSLROB^^0^B2371971
"BLD",3798,"KRN",9.8,"NM",13,0)
GMTSLRS^^0^B7319960
"BLD",3798,"KRN",9.8,"NM",14,0)
GMTSLRS7^^0^B12140512
"BLD",3798,"KRN",9.8,"NM",15,0)
GMTSLRSC^^0^B12199123
"BLD",3798,"KRN",9.8,"NM",16,0)
GMTSVSD^^0^B57231397
"BLD",3798,"KRN",9.8,"NM",17,0)
GMTSXAB^^0^B12082142
"BLD",3798,"KRN",9.8,"NM",18,0)
GMTSULT^^0^B72747736
"BLD",3798,"KRN",9.8,"NM",19,0)
GMTSOBE^^0^B41162969
"BLD",3798,"KRN",9.8,"NM",20,0)
GMTSOBI^^0^B40976861
"BLD",3798,"KRN",9.8,"NM",21,0)
GMTSOBU^^0^B46165744
"BLD",3798,"KRN",9.8,"NM",22,0)
GMTSALG^^0^B29309635
"BLD",3798,"KRN",9.8,"NM",23,0)
GMTSRASP^^0^B13016689
"BLD",3798,"KRN",9.8,"NM",24,0)
GMTSDEM2^^0^B37019357
"BLD",3798,"KRN",9.8,"NM",25,0)
GMTSLRTE^^0^B2162840
"BLD",3798,"KRN",9.8,"NM",26,0)
GMTSOBL2^^0^B17949177
"BLD",3798,"KRN",9.8,"NM",27,0)
GMTSOBV^^0^B56308658
"BLD",3798,"KRN",9.8,"NM",29,0)
GMTSOBA2^^0^B45947512
"BLD",3798,"KRN",9.8,"NM",30,0)
GMTSOBS2^^0^B31776283
"BLD",3798,"KRN",9.8,"NM",31,0)
GMTSRM^^0^B18446794
"BLD",3798,"KRN",9.8,"NM",32,0)
GMTSOBD^^0^B38582350
"BLD",3798,"KRN",9.8,"NM",33,0)
GMTSULT5^^0^B19695812
"BLD",3798,"KRN",9.8,"NM",34,0)
GMTSPXFP^^0^B7514219
"BLD",3798,"KRN",9.8,"NM","B","GMTS1",5)

"BLD",3798,"KRN",9.8,"NM","B","GMTS2",9)

"BLD",3798,"KRN",9.8,"NM","B","GMTSALG",22)

"BLD",3798,"KRN",9.8,"NM","B","GMTSCNB",10)

"BLD",3798,"KRN",9.8,"NM","B","GMTSDEM2",24)

"BLD",3798,"KRN",9.8,"NM","B","GMTSLRC",11)

"BLD",3798,"KRN",9.8,"NM","B","GMTSLROB",12)

"BLD",3798,"KRN",9.8,"NM","B","GMTSLRS",13)

"BLD",3798,"KRN",9.8,"NM","B","GMTSLRS7",14)

"BLD",3798,"KRN",9.8,"NM","B","GMTSLRSC",15)

"BLD",3798,"KRN",9.8,"NM","B","GMTSLRTE",25)

"BLD",3798,"KRN",9.8,"NM","B","GMTSOBA",1)

"BLD",3798,"KRN",9.8,"NM","B","GMTSOBA2",29)

"BLD",3798,"KRN",9.8,"NM","B","GMTSOBD",32)

"BLD",3798,"KRN",9.8,"NM","B","GMTSOBE",19)

"BLD",3798,"KRN",9.8,"NM","B","GMTSOBH",2)

"BLD",3798,"KRN",9.8,"NM","B","GMTSOBI",20)

"BLD",3798,"KRN",9.8,"NM","B","GMTSOBJ",3)

"BLD",3798,"KRN",9.8,"NM","B","GMTSOBL",8)

"BLD",3798,"KRN",9.8,"NM","B","GMTSOBL2",26)

"BLD",3798,"KRN",9.8,"NM","B","GMTSOBS",6)

"BLD",3798,"KRN",9.8,"NM","B","GMTSOBS2",30)

"BLD",3798,"KRN",9.8,"NM","B","GMTSOBT",4)

"BLD",3798,"KRN",9.8,"NM","B","GMTSOBU",21)

"BLD",3798,"KRN",9.8,"NM","B","GMTSOBV",27)

"BLD",3798,"KRN",9.8,"NM","B","GMTSPXFP",34)

"BLD",3798,"KRN",9.8,"NM","B","GMTSRASP",23)

"BLD",3798,"KRN",9.8,"NM","B","GMTSRM",31)

"BLD",3798,"KRN",9.8,"NM","B","GMTSULT",18)

"BLD",3798,"KRN",9.8,"NM","B","GMTSULT5",33)

"BLD",3798,"KRN",9.8,"NM","B","GMTSUP",7)

"BLD",3798,"KRN",9.8,"NM","B","GMTSVSD",16)

"BLD",3798,"KRN",9.8,"NM","B","GMTSXAB",17)

"BLD",3798,"KRN",19,0)
19
"BLD",3798,"KRN",19,"NM",0)
^9.68A^23^22
"BLD",3798,"KRN",19,"NM",1,0)
GMTS OBJ ENTER/EDIT^^0
"BLD",3798,"KRN",19,"NM",2,0)
GMTS OBJ TEST^^0
"BLD",3798,"KRN",19,"NM",3,0)
GMTS OBJ MENU^^0
"BLD",3798,"KRN",19,"NM",4,0)
GMTS OBJ INQ^^0
"BLD",3798,"KRN",19,"NM",5,0)
GMTS GUI HS LIST DEFAULTS^^0
"BLD",3798,"KRN",19,"NM",6,0)
GMTS GUI HS LIST METHOD^^0
"BLD",3798,"KRN",19,"NM",7,0)
GMTS GUI HS LIST PARAMETERS^^0
"BLD",3798,"KRN",19,"NM",8,0)
GMTS GUI HS LIST PRECEDENCE^^0
"BLD",3798,"KRN",19,"NM",9,0)
GMTS GUI REPORTS LIST MENU^^0
"BLD",3798,"KRN",19,"NM",10,0)
GMTS GUI SITE ADD/EDIT LIST^^0
"BLD",3798,"KRN",19,"NM",11,0)
GMTS GUI SITE COMPILE METHOD^^0
"BLD",3798,"KRN",19,"NM",12,0)
GMTS GUI SITE DEFAULTS^^0
"BLD",3798,"KRN",19,"NM",13,0)
GMTS GUI SITE DISPLAY DEFAULTS^^0
"BLD",3798,"KRN",19,"NM",14,0)
GMTS GUI SITE PRECEDENCE^^0
"BLD",3798,"KRN",19,"NM",15,0)
GMTS GUI SITE RESEQUENCE^^0
"BLD",3798,"KRN",19,"NM",16,0)
GMTS BUILD MENU^^2
"BLD",3798,"KRN",19,"NM",18,0)
GMTS IRM/ADPAC MAINT MENU^^2
"BLD",3798,"KRN",19,"NM",19,0)
GMTS OBJ DELETE^^0
"BLD",3798,"KRN",19,"NM",20,0)
GMTS OBJ EXPORT/IMPORT^^0
"BLD",3798,"KRN",19,"NM",21,0)
GMTS OBJ EXPORT^^0
"BLD",3798,"KRN",19,"NM",22,0)
GMTS OBJ IMPORT/INSTALL^^0
"BLD",3798,"KRN",19,"NM",23,0)
GMTS TYPE DELETE^^0
"BLD",3798,"KRN",19,"NM","B","GMTS BUILD MENU",16)

"BLD",3798,"KRN",19,"NM","B","GMTS GUI HS LIST DEFAULTS",5)

"BLD",3798,"KRN",19,"NM","B","GMTS GUI HS LIST METHOD",6)

"BLD",3798,"KRN",19,"NM","B","GMTS GUI HS LIST PARAMETERS",7)

"BLD",3798,"KRN",19,"NM","B","GMTS GUI HS LIST PRECEDENCE",8)

"BLD",3798,"KRN",19,"NM","B","GMTS GUI REPORTS LIST MENU",9)

"BLD",3798,"KRN",19,"NM","B","GMTS GUI SITE ADD/EDIT LIST",10)

"BLD",3798,"KRN",19,"NM","B","GMTS GUI SITE COMPILE METHOD",11)

"BLD",3798,"KRN",19,"NM","B","GMTS GUI SITE DEFAULTS",12)

"BLD",3798,"KRN",19,"NM","B","GMTS GUI SITE DISPLAY DEFAULTS",13)

"BLD",3798,"KRN",19,"NM","B","GMTS GUI SITE PRECEDENCE",14)

"BLD",3798,"KRN",19,"NM","B","GMTS GUI SITE RESEQUENCE",15)

"BLD",3798,"KRN",19,"NM","B","GMTS IRM/ADPAC MAINT MENU",18)

"BLD",3798,"KRN",19,"NM","B","GMTS OBJ DELETE",19)

"BLD",3798,"KRN",19,"NM","B","GMTS OBJ ENTER/EDIT",1)

"BLD",3798,"KRN",19,"NM","B","GMTS OBJ EXPORT",21)

"BLD",3798,"KRN",19,"NM","B","GMTS OBJ EXPORT/IMPORT",20)

"BLD",3798,"KRN",19,"NM","B","GMTS OBJ IMPORT/INSTALL",22)

"BLD",3798,"KRN",19,"NM","B","GMTS OBJ INQ",4)

"BLD",3798,"KRN",19,"NM","B","GMTS OBJ MENU",3)

"BLD",3798,"KRN",19,"NM","B","GMTS OBJ TEST",2)

"BLD",3798,"KRN",19,"NM","B","GMTS TYPE DELETE",23)

"BLD",3798,"KRN",19.1,0)
19.1
"BLD",3798,"KRN",101,0)
101
"BLD",3798,"KRN",409.61,0)
409.61
"BLD",3798,"KRN",771,0)
771
"BLD",3798,"KRN",870,0)
870
"BLD",3798,"KRN",8989.51,0)
8989.51
"BLD",3798,"KRN",8989.52,0)
8989.52
"BLD",3798,"KRN",8994,0)
8994
"BLD",3798,"KRN","B",.4,.4)

"BLD",3798,"KRN","B",.401,.401)

"BLD",3798,"KRN","B",.402,.402)

"BLD",3798,"KRN","B",.403,.403)

"BLD",3798,"KRN","B",.5,.5)

"BLD",3798,"KRN","B",.84,.84)

"BLD",3798,"KRN","B",3.6,3.6)

"BLD",3798,"KRN","B",3.8,3.8)

"BLD",3798,"KRN","B",9.2,9.2)

"BLD",3798,"KRN","B",9.8,9.8)

"BLD",3798,"KRN","B",19,19)

"BLD",3798,"KRN","B",19.1,19.1)

"BLD",3798,"KRN","B",101,101)

"BLD",3798,"KRN","B",409.61,409.61)

"BLD",3798,"KRN","B",771,771)

"BLD",3798,"KRN","B",870,870)

"BLD",3798,"KRN","B",8989.51,8989.51)

"BLD",3798,"KRN","B",8989.52,8989.52)

"BLD",3798,"KRN","B",8994,8994)

"BLD",3798,"QUES",0)
^9.62^^
"BLD",3798,"REQB",0)
^9.611^2^2
"BLD",3798,"REQB",1,0)
GMTS*2.7*49^2
"BLD",3798,"REQB",2,0)
GMTS*2.7*56^2
"BLD",3798,"REQB","B","GMTS*2.7*49",1)

"BLD",3798,"REQB","B","GMTS*2.7*56",2)

"FIA",142.5)
HEALTH SUMMARY OBJECTS
"FIA",142.5,0)
^GMT(142.5,
"FIA",142.5,0,0)
142.5
"FIA",142.5,0,1)
y^y^f^^^^n
"FIA",142.5,0,10)

"FIA",142.5,0,11)

"FIA",142.5,0,"RLRO")

"FIA",142.5,0,"VR")
2.7^GMTS
"FIA",142.5,142.5)
0
"FIA",142.5,142.51)
0
"INIT")
POST^GMTSP58
"KRN",.402,250,-1)
0^3
"KRN",.402,250,0)
GMTS EDIT HLTH SUM TYPE^2950815.1725^^142^^^3021231
"KRN",.402,250,"DIAB",5,0,142,0)
.08;T
"KRN",.402,250,"DR",1,142)
I '$D(GMTSNEW) S GMTSNEW=0;I GMTSNEW,'GMTSMGR S Y="@1";.01;.02;.08T~;I 'GMTSMGR S Y=0;.05;.06;S Y=0;@1;.06////^S X=DUZ;S Y=.01;
"KRN",.402,251,-1)
0^1
"KRN",.402,251,0)
GMTS DELETE HLTH SUM TYPE^2951004.0749^^142^^^3021106
"KRN",.402,251,"DR",1,142)
S GMTSMGR=$S($D(^XUSEC("GMTSMGR",DUZ)):1,1:0);I 'GMTSMGR S %=$P(^GMT(142,DA,0),U,2) I %]"",$D(^XUSEC(%,DUZ))[0 W !,$C(7),"The "_$P(^GMT(142,DA,0),U)_" summary type is currently locked to prevent deletion.",! S Y=0;
"KRN",.402,251,"DR",1,142,1)
S %=+$P(^GMT(142,DA,0),U,3) I 'GMTSMGR,%'=DUZ W !,$C(7),"You may only delete summary types for which you are the owner.",! S Y=0;
"KRN",.402,251,"DR",1,142,2)
I $P(^GMT(142,DA,0),U)="GMTS HS ADHOC OPTION" W !,$C(7),"GMTS HS ADHOC OPTION Summary may NOT be deleted.",! S Y=0;W !,"Are you sure you want to delete the "_$P(^GMT(142,DA,0),U)_" Health Summary Type";S %=2;D YN^DICN;
"KRN",.402,251,"DR",1,142,3)
I %'=1 W !,"Nothing Deleted!" S Y=0;W !,"Health Summary Type "_$P(^GMT(142,DA,0),U)_" Deleted!";.01///@;
"KRN",.402,1436,-1)
0^2
"KRN",.402,1436,0)
GMTS EDIT EXIST HS TYPE^3021025.1725^^142^^^3021120
"KRN",.402,1436,"DIAB",5,0,142,0)
.08;T
"KRN",.402,1436,"DR",1,142)
I '$D(GMTSNEW) S GMTSNEW=0;I GMTSNEW,'GMTSMGR S Y="@1";.01;.02;.08T~;I 'GMTSMGR S Y=0;.05;.06;S Y=0;@1;.06////^S X=DUZ;S Y=.01;
"KRN",19,1989,-1)
2^16
"KRN",19,1989,0)
GMTS BUILD MENU^Build Health Summary Type Menu^^M^.5^^^^^^^126
"KRN",19,1989,10,0)
^19.01IP^5^5
"KRN",19,1989,10,2,0)
1995^2^2
"KRN",19,1989,10,2,"^")
GMTS TYPE DELETE
"KRN",19,1989,10,3,0)
9014^3^3
"KRN",19,1989,10,3,"^")
GMTS OBJ MENU
"KRN",19,1989,"U")
BUILD HEALTH SUMMARY TYPE MENU
"KRN",19,1995,-1)
0^23
"KRN",19,1995,0)
GMTS TYPE DELETE^Delete Health Summary Type^^E^^^^^^^^HEALTH SUMMARY^^1^1
"KRN",19,1995,1,0)
^19.06^8^8^3020911^^^^
"KRN",19,1995,1,1,0)
This option allows the owner of a Health Summary Type to delete
"KRN",19,1995,1,2,0)
it. In addition anyone who holds the GMTSMGR key may use this 
"KRN",19,1995,1,3,0)
option. Also, if a Health Summary Type has a lock, anyone who 
"KRN",19,1995,1,4,0)
holds a key with that lock value may delete that Health Summary
"KRN",19,1995,1,5,0)
Type.  This Option will not allow the deletion of a Health Summary
"KRN",19,1995,1,6,0)
Type in use by a Health Summary Object.  It will not allow the 
"KRN",19,1995,1,7,0)
deletion of special case Health Summary Types such as GMTS HS 
"KRN",19,1995,1,8,0)
ADHOC OPTION, or REMOTE Health Summary Types.
"KRN",19,1995,15)
K %,GMTSMGR
"KRN",19,1995,20)
K DA,DIC,DIE,DIK,DR
"KRN",19,1995,30)
GMT(142,
"KRN",19,1995,31)
AEMQ
"KRN",19,1995,32)
Select Health Summary Type:
"KRN",19,1995,34)
I +($$DHST^GMTSULT(+($G(Y))))
"KRN",19,1995,50)
GMT(142,
"KRN",19,1995,51)
[GMTS DELETE HLTH SUM TYPE]
"KRN",19,1995,"U")
DELETE HEALTH SUMMARY TYPE
"KRN",19,4157,-1)
2^18
"KRN",19,4157,0)
GMTS IRM/ADPAC MAINT MENU^Health Summary Maintenance Menu^^M^.5^^^^^^y^126
"KRN",19,4157,10,0)
^19.01IP^10^10
"KRN",19,4157,10,8,0)
9014^8^8
"KRN",19,4157,10,8,"^")
GMTS OBJ MENU
"KRN",19,4157,10,9,0)
8529^9^9
"KRN",19,4157,10,9,"^")
GMTS GUI REPORTS LIST MENU
"KRN",19,4157,10,10,0)
8843^10^10
"KRN",19,4157,10,10,"^")
GMTS GUI SITE DEFAULTS
"KRN",19,4157,"U")
HEALTH SUMMARY MAINTENANCE MEN
"KRN",19,8529,-1)
0^9
"KRN",19,8529,0)
GMTS GUI REPORTS LIST MENU^CPRS Reports Tab 'Health Summary Types List' Menu^^M^^^^^^^^
"KRN",19,8529,1,0)
^^4^4^3020718^
"KRN",19,8529,1,1,0)
Use the options in the CPRS Reports Tab Health Summary Types List
"KRN",19,8529,1,2,0)
Menu to select the Health Summary Types to list on the Reports Tab,
"KRN",19,8529,1,3,0)
arrange the order of these Health Summaries on the list, and to 
"KRN",19,8529,1,4,0)
view the user s preferences.
"KRN",19,8529,10,0)
^19.01IP^4^4
"KRN",19,8529,10,1,0)
8530^1^1
"KRN",19,8529,10,1,"^")
GMTS GUI HS LIST DEFAULTS
"KRN",19,8529,10,2,0)
8531^2^2
"KRN",19,8529,10,2,"^")
GMTS GUI HS LIST PRECEDENCE
"KRN",19,8529,10,3,0)
8532^3^3
"KRN",19,8529,10,3,"^")
GMTS GUI HS LIST METHOD
"KRN",19,8529,10,4,0)
8533^4^4
"KRN",19,8529,10,4,"^")
GMTS GUI HS LIST PARAMETERS
"KRN",19,8529,99)
58819,39045
"KRN",19,8529,99.1)
59171,34704
"KRN",19,8529,"U")
CPRS REPORTS TAB 'HEALTH SUMMA
"KRN",19,8530,-1)
0^5
"KRN",19,8530,0)
GMTS GUI HS LIST DEFAULTS^Display 'Health Summary Types List' Defaults^^R^^^^^^^^
"KRN",19,8530,1,0)
^19.06^5^5^3020725^^^^
"KRN",19,8530,1,1,0)
Use this option to display the list of Health Summary Types that 
"KRN",19,8530,1,2,0)
will be contained in the 'Health Summary Types' section on the 
"KRN",19,8530,1,3,0)
Reports Tab in CPRS.  The display includes the precedence of 
"KRN",19,8530,1,4,0)
parameters, the method for building the list, and finally the list
"KRN",19,8530,1,5,0)
that will actually appear on the Reports Tab in CPRS.
"KRN",19,8530,25)
DISP^GMTSXA
"KRN",19,8530,"U")
DISPLAY 'HEALTH SUMMARY TYPES 
"KRN",19,8531,-1)
0^8
"KRN",19,8531,0)
GMTS GUI HS LIST PRECEDENCE^Precedence of 'Health Summary Types List'^^R^^^^^^^^
"KRN",19,8531,1,0)
^^17^17^3020718^
"KRN",19,8531,1,1,0)
Use this option to select the defined Health Summary Types to include
"KRN",19,8531,1,2,0)
on the list and arrange them in the order (precedence) that they 
"KRN",19,8531,1,3,0)
should appear on the list.  The three most common groups of Health 
"KRN",19,8531,1,4,0)
Summary Types are:
"KRN",19,8531,1,5,0)

"KRN",19,8531,1,6,0)
 SYS  Health Summary Types may be defined for all users on the system.
"KRN",19,8531,1,7,0)

"KRN",19,8531,1,8,0)
 USR  Health Summary Types may be defined for a single user on the
"KRN",19,8531,1,9,0)
      system.
"KRN",19,8531,1,10,0)

"KRN",19,8531,1,11,0)
 NAT  Nationally exported Health Summary Types (NAT) defined for 
"KRN",19,8531,1,12,0)
      system users or a single user are treated independently to
"KRN",19,8531,1,13,0)
      keep them together in the list box.
"KRN",19,8531,1,14,0)

"KRN",19,8531,1,15,0)
In this option, you must first select those Health Summary Type groups
"KRN",19,8531,1,16,0)
(SYS, USR, NAT, etc.) to include on the Reports Tab, then specify the
"KRN",19,8531,1,17,0)
order in which they will appear on the Reports Tab.
"KRN",19,8531,25)
PREC^GMTSXA
"KRN",19,8531,"U")
PRECEDENCE OF 'HEALTH SUMMARY 
"KRN",19,8532,-1)
0^6
"KRN",19,8532,0)
GMTS GUI HS LIST METHOD^Method of compiling 'Health Summary Types List'^^R^^^^^^^^
"KRN",19,8532,1,0)
^19.06^13^13^3020718^^^
"KRN",19,8532,1,1,0)
Use this option to edit the method used to build the list of Health
"KRN",19,8532,1,2,0)
Summary Types displayed on the Reports Tab in CPRS.  There are 2 
"KRN",19,8532,1,3,0)
methods:
"KRN",19,8532,1,4,0)

"KRN",19,8532,1,5,0)
   Overwrite   System-defined Health Summary Types are added 
"KRN",19,8532,1,6,0)
               to the list.  If there are User-defined Health
"KRN",19,8532,1,7,0)
               Summary Types, then they will replace the System
"KRN",19,8532,1,8,0)
               defined Health Summary Types already on the list.
"KRN",19,8532,1,9,0)

"KRN",19,8532,1,10,0)
   Append      System-defined Health Summary Types are added to
"KRN",19,8532,1,11,0)
               the list.  If there are User-defined Health Summary
"KRN",19,8532,1,12,0)
               Types, then they will added to the list along with 
"KRN",19,8532,1,13,0)
               the System-defined types.
"KRN",19,8532,25)
METH^GMTSXA
"KRN",19,8532,"U")
METHOD OF COMPILING 'HEALTH SU
"KRN",19,8533,-1)
0^7
"KRN",19,8533,0)
GMTS GUI HS LIST PARAMETERS^Edit 'Health Summary Types List' Parameters^^R^^^^^^^^
"KRN",19,8533,1,0)
^^4^4^3020718^
"KRN",19,8533,1,1,0)
Use this option to add, edit or delete a Health Summary Type from
"KRN",19,8533,1,2,0)
the list of Health Summary Types defined by the user.  If you are 
"KRN",19,8533,1,3,0)
a holder of the GMTSMGR Key, you can also use this option to edit
"KRN",19,8533,1,4,0)
the Health Summary Types defined for the System.
"KRN",19,8533,25)
EDIT^GMTSXA
"KRN",19,8533,"U")
EDIT 'HEALTH SUMMARY TYPES LIS
"KRN",19,8842,-1)
0^13
"KRN",19,8842,0)
GMTS GUI SITE DISPLAY DEFAULTS^Display Site Health Summary List Defaults^^R^^^^^^^^
"KRN",19,8842,1,0)
^^5^5^3020718^
"KRN",19,8842,1,1,0)
Use this option to display the site defaults for building the list
"KRN",19,8842,1,2,0)
of Health Summary Types on the Reports Tab in CPRS. The display 
"KRN",19,8842,1,3,0)
includes the method for building the list and the precedence of 
"KRN",19,8842,1,4,0)
parameters. These default values will be used in the event that the
"KRN",19,8842,1,5,0)
user has not established user preferences.
"KRN",19,8842,25)
DS^GMTSXA
"KRN",19,8842,"U")
DISPLAY SITE HEALTH SUMMARY LI
"KRN",19,8843,-1)
0^12
"KRN",19,8843,0)
GMTS GUI SITE DEFAULTS^CPRS Health Summary Display/Edit Site Defaults^^M^^^^^^^^
"KRN",19,8843,1,0)
^^8^8^3020718^
"KRN",19,8843,1,1,0)
Use the options in the CPRS Health Summary Display/Edit Site 
"KRN",19,8843,1,2,0)
Defaults Menu to display the site defaults, select the Health 
"KRN",19,8843,1,3,0)
Summary Types to list on the Reports Tab, edit the method of 
"KRN",19,8843,1,4,0)
building the list (append/overwrite), edit allowable entities
"KRN",19,8843,1,5,0)
for the list (i.e., User, System, Division, etc.), or resequence
"KRN",19,8843,1,6,0)
the allowable entities in the order they should be appear on 
"KRN",19,8843,1,7,0)
the list.
"KRN",19,8843,1,8,0)

"KRN",19,8843,10,0)
^19.01IP^5^5
"KRN",19,8843,10,1,0)
8842^1^1
"KRN",19,8843,10,1,"^")
GMTS GUI SITE DISPLAY DEFAULTS
"KRN",19,8843,10,2,0)
8844^3^3
"KRN",19,8843,10,2,"^")
GMTS GUI SITE COMPILE METHOD
"KRN",19,8843,10,3,0)
8845^4^4
"KRN",19,8843,10,3,"^")
GMTS GUI SITE PRECEDENCE
"KRN",19,8843,10,4,0)
8846^5^5
"KRN",19,8843,10,4,"^")
GMTS GUI SITE RESEQUENCE
"KRN",19,8843,10,5,0)
8847^2^2
"KRN",19,8843,10,5,"^")
GMTS GUI SITE ADD/EDIT LIST
"KRN",19,8843,99)
58869,26022
"KRN",19,8843,"U")
CPRS HEALTH SUMMARY DISPLAY/ED
"KRN",19,8844,-1)
0^11
"KRN",19,8844,0)
GMTS GUI SITE COMPILE METHOD^Edit Default HS Type List Compile Method^^R^^^^^^^^HEALTH SUMMARY
"KRN",19,8844,1,0)
^^13^13^3020718^
"KRN",19,8844,1,1,0)
Use this option to modifiy how the list of Health Summary Types 
"KRN",19,8844,1,2,0)
is to be built for the site.  This method will be used for all 
"KRN",19,8844,1,3,0)
users who do not have user preferences set. 
"KRN",19,8844,1,4,0)
  
"KRN",19,8844,1,5,0)
  Overwrite  System-defined Health Summary Types are added to 
"KRN",19,8844,1,6,0)
             the list. If there are User-defined Health Summary
"KRN",19,8844,1,7,0)
             Types, then they will replace the System defined 
"KRN",19,8844,1,8,0)
             Health Summary Types already on the list.
"KRN",19,8844,1,9,0)
  
"KRN",19,8844,1,10,0)
  Append     System-defined Health Summary Types are added to 
"KRN",19,8844,1,11,0)
             the list. If there are User-defined Health Summary
"KRN",19,8844,1,12,0)
             Types, then they will added to the list along
"KRN",19,8844,1,13,0)
             with the System defined types.
"KRN",19,8844,25)
MS^GMTSXA
"KRN",19,8844,"U")
EDIT DEFAULT HS TYPE LIST COMP
"KRN",19,8845,-1)
0^14
"KRN",19,8845,0)
GMTS GUI SITE PRECEDENCE^Add/Edit Allowable Entities for HS List^^R^^^^^^^^
"KRN",19,8845,1,0)
^19.06^4^4^3020718^^^
"KRN",19,8845,1,1,0)
Use this option to add or delete an entity (System, Division, User,
"KRN",19,8845,1,2,0)
etc) from the list of allowable entites for the parameter 'ORWRP 
"KRN",19,8845,1,3,0)
HEALTH SUMMARY TYPE LIST' used on the CPRS Reports Tab to display
"KRN",19,8845,1,4,0)
the Health Summary Types List.
"KRN",19,8845,25)
PS^GMTSXA
"KRN",19,8845,"U")
ADD/EDIT ALLOWABLE ENTITIES FO
"KRN",19,8846,-1)
0^15
"KRN",19,8846,0)
GMTS GUI SITE RESEQUENCE^Resequence Allowable Entities for HS List^^R^^^^^^^^
"KRN",19,8846,1,0)
^^5^5^3020718^
"KRN",19,8846,1,1,0)
Use this option to resequence the order in which the allowable 
"KRN",19,8846,1,2,0)
entites for parameter 'ORWRP HEALTH SUMMARY TYPE LIST' are used 
"KRN",19,8846,1,3,0)
in building the list of Health Summary Types for the CPRS Reports
"KRN",19,8846,1,4,0)
Tab.  This order is used for any user who does not have user 
"KRN",19,8846,1,5,0)
preferences set.
"KRN",19,8846,25)
RS^GMTSXA
"KRN",19,8846,"U")
RESEQUENCE ALLOWABLE ENTITIES 
"KRN",19,8847,-1)
0^10
"KRN",19,8847,0)
GMTS GUI SITE ADD/EDIT LIST^Edit 'Health Summary Types List' Parameters^^R^^^^^^^^
"KRN",19,8847,1,0)
^^3^3^3020718^
"KRN",19,8847,1,1,0)
Use this option to add, edit or delete a Health Summary Type from
"KRN",19,8847,1,2,0)
the list of Health Summary Types defined for a given entity (System,
"KRN",19,8847,1,3,0)
Division, User, etc.).
"KRN",19,8847,25)
EM^GMTSXA
"KRN",19,8847,"U")
EDIT 'HEALTH SUMMARY TYPES LIS
"KRN",19,9011,-1)
0^1
"KRN",19,9011,0)
GMTS OBJ ENTER/EDIT^Create/Modify Health Summary Object^^R^^^^^^^^
"KRN",19,9011,1,0)
^19.06^4^4^3021023^^^^
"KRN",19,9011,1,1,0)
This option allows the user to create or modify a Health 
"KRN",19,9011,1,2,0)
Summary Object.  Objects are Health Summaries that may have 
"KRN",19,9011,1,3,0)
their headers suppressed so they may be inserted into another
"KRN",19,9011,1,4,0)
document.
"KRN",19,9011,25)
OBJ^GMTSOBJ
"KRN",19,9011,"U")
CREATE/MODIFY HEALTH SUMMARY O
"KRN",19,9012,-1)
0^2
"KRN",19,9012,0)
GMTS OBJ TEST^Test a Health Summary Object^^R^^^^^^^^
"KRN",19,9012,1,0)
^19.06^3^3^3020910^^^
"KRN",19,9012,1,1,0)
This option allows the user test a Health Summary Object by 
"KRN",19,9012,1,2,0)
displaying the Object to the screen exactly as it would appear 
"KRN",19,9012,1,3,0)
inserted in another document.
"KRN",19,9012,25)
TEST^GMTSOBJ
"KRN",19,9012,"U")
TEST A HEALTH SUMMARY OBJECT
"KRN",19,9014,-1)
0^3
"KRN",19,9014,0)
GMTS OBJ MENU^Health Summary Objects Menu^^M^^^^^^^^
"KRN",19,9014,1,0)
^19.06^4^4^3020910^^^^
"KRN",19,9014,1,1,0)
Use this option to access utilities to add/edit a Health Summary 
"KRN",19,9014,1,2,0)
Object, display the characteristics of a Health Summary Object, 
"KRN",19,9014,1,3,0)
to test a Health Summary Object or to export/import a Health
"KRN",19,9014,1,4,0)
Summary Object.
"KRN",19,9014,10,0)
^19.01IP^6^5
"KRN",19,9014,10,1,0)
9011^1^1
"KRN",19,9014,10,1,"^")
GMTS OBJ ENTER/EDIT
"KRN",19,9014,10,2,0)
9012^3^3
"KRN",19,9014,10,2,"^")
GMTS OBJ TEST
"KRN",19,9014,10,4,0)
9016^4^4
"KRN",19,9014,10,4,"^")
GMTS OBJ DELETE
"KRN",19,9014,10,5,0)
9015^2^2
"KRN",19,9014,10,5,"^")
GMTS OBJ INQ
"KRN",19,9014,10,6,0)
9043^5^5
"KRN",19,9014,10,6,"^")
GMTS OBJ EXPORT/IMPORT
"KRN",19,9014,99)
59057,51137
"KRN",19,9014,"U")
HEALTH SUMMARY OBJECTS MENU
"KRN",19,9015,-1)
0^4
"KRN",19,9015,0)
GMTS OBJ INQ^Inquire about a Health Summary Object^^R^^^^^^^^
"KRN",19,9015,1,0)
^19.06^2^2^3020910^^^^
"KRN",19,9015,1,1,0)
Display a Health Summary Object from file 142.5, to include 
"KRN",19,9015,1,2,0)
an example of the object.
"KRN",19,9015,25)
INQ^GMTSOBJ
"KRN",19,9015,"U")
INQUIRE ABOUT A HEALTH SUMMARY
"KRN",19,9016,-1)
0^19
"KRN",19,9016,0)
GMTS OBJ DELETE^Delete Health Summary Object^^R^^^^^^^^
"KRN",19,9016,1,0)
^19.06^3^3^3020910^^
"KRN",19,9016,1,1,0)
This option is used to delete a Health Summary Object that
"KRN",19,9016,1,2,0)
you created.  You may not delete Health Summary Objects 
"KRN",19,9016,1,3,0)
created by other people.
"KRN",19,9016,25)
DEL^GMTSOBJ
"KRN",19,9016,"U")
DELETE HEALTH SUMMARY OBJECT
"KRN",19,9033,-1)
0^21
"KRN",19,9033,0)
GMTS OBJ EXPORT^Export a Health Summary Object^^R^^^^^^^^
"KRN",19,9033,1,0)
^19.06^4^4^3020910^^^
"KRN",19,9033,1,1,0)
This option will allow a user to export a Health Summary 
"KRN",19,9033,1,2,0)
Object, and its corresponding Health Summary Type to a 
"KRN",19,9033,1,3,0)
Mailman message which can be sent to other accounts/sites
"KRN",19,9033,1,4,0)
for import.
"KRN",19,9033,25)
EXP^GMTSOBJ
"KRN",19,9033,"U")
EXPORT A HEALTH SUMMARY OBJECT
"KRN",19,9035,-1)
0^22
"KRN",19,9035,0)
GMTS OBJ IMPORT/INSTALL^Import/Install a Health Summary Object^^R^^^^^^^^
"KRN",19,9035,1,0)
^19.06^10^10^3020910^^^
"KRN",19,9035,1,1,0)
This option is used to install a Health Summary Object 
"KRN",19,9035,1,2,0)
exported using the GMTS OBJ EXPORT option.  The incoming 
"KRN",19,9035,1,3,0)
Object must first be unpacked from the incoming Mailman 
"KRN",19,9035,1,4,0)
message using Packman utilities.  Then this option is used 
"KRN",19,9035,1,5,0)
to install the object into the Health Summary files.  
"KRN",19,9035,1,6,0)
If there is a Health Summary Type with the same name as 
"KRN",19,9035,1,7,0)
the Health Summary being imported, then you will be prompted
"KRN",19,9035,1,8,0)
to either use the existing Health Summary Type, or to 
"KRN",19,9035,1,9,0)
rename the incoming Health Summary Type.  At no time will 
"KRN",19,9035,1,10,0)
an existing Health Summary Type be over written.
"KRN",19,9035,25)
INS^GMTSOBJ
"KRN",19,9035,"U")
IMPORT/INSTALL A HEALTH SUMMAR
"KRN",19,9043,-1)
0^20
"KRN",19,9043,0)
GMTS OBJ EXPORT/IMPORT^Export/Import a Health Summary Object^^M^^^^^^^^
"KRN",19,9043,1,0)
^19.06^4^4^3020910^^
"KRN",19,9043,1,1,0)
This menu contains options used to either export a Health
"KRN",19,9043,1,2,0)
Summary Object to a Mailman message, or import an Health 
"KRN",19,9043,1,3,0)
Summary Object by reading the data unpacked from a Mainman
"KRN",19,9043,1,4,0)
message using the Packman Utilities.
"KRN",19,9043,10,0)
^19.01IP^2^2
"KRN",19,9043,10,1,0)
9033^1^1
"KRN",19,9043,10,1,"^")
GMTS OBJ EXPORT
"KRN",19,9043,10,2,0)
9035^2^2
"KRN",19,9043,10,2,"^")
GMTS OBJ IMPORT/INSTALL
"KRN",19,9043,99)
59057,50355
"KRN",19,9043,"U")
EXPORT/IMPORT A HEALTH SUMMARY
"MBREQ")
0
"ORD",7,.402)
.402;7;;;EDEOUT^DIFROMSO(.402,DA,"",XPDA);FPRE^DIFROMSI(.402,"",XPDA);EPRE^DIFROMSI(.402,DA,$E("N",$G(XPDNEW)),XPDA,"",OLDA);;EPOST^DIFROMSI(.402,DA,"",XPDA);DEL^DIFROMSK(.402,"",%)
"ORD",7,.402,0)
INPUT TEMPLATE
"ORD",18,19)
19;18;;;OPT^XPDTA;OPTF1^XPDIA;OPTE1^XPDIA;OPTF2^XPDIA;;OPTDEL^XPDIA
"ORD",18,19,0)
OPTION
"PKG",126,-1)
1^1
"PKG",126,0)
HEALTH SUMMARY^GMTS^Integrated Health Summary Tools^^^3010208
"PKG",126,20,0)
^9.402P^^
"PKG",126,22,0)
^9.49I^1^1
"PKG",126,22,1,0)
2.7^2951020^2951020^11
"PKG",126,22,1,"PAH",1,0)
58^3030106
"PKG",126,22,1,"PAH",1,1,0)
^^2^2^3030106
"PKG",126,22,1,"PAH",1,1,1,0)
The description of this build is found in the National Patch Module under 
"PKG",126,22,1,"PAH",1,1,2,0)
patch GMTS*2.7*58.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
34
"RTN","GMTS1")
0^5^B23058126
"RTN","GMTS1",1,0)
GMTS1 ; SLC/JER,KER - Health Summary Driver ; 01/06/2003
"RTN","GMTS1",2,0)
 ;;2.7;Health Summary;**7,16,24,28,37,49,58**;Oct 20, 1995
"RTN","GMTS1",3,0)
 ;                    
"RTN","GMTS1",4,0)
 ; External References
"RTN","GMTS1",5,0)
 ;   DBIA 10076  ^XUSEC(
"RTN","GMTS1",6,0)
 ;   DBIA 10000  C^%DTC
"RTN","GMTS1",7,0)
 ;   DBIA 10000  NOW^%DTC
"RTN","GMTS1",8,0)
 ;               
"RTN","GMTS1",9,0)
EN ; Entry Point to Generate a Summary
"RTN","GMTS1",10,0)
 ;               
"RTN","GMTS1",11,0)
 ;   Requires:  DFN, GMTSTITL, GMTSEG()
"RTN","GMTS1",12,0)
 ;              GMTSEGI(), GMTSEGC, DUZ(2)
"RTN","GMTS1",13,0)
 ;               
"RTN","GMTS1",14,0)
 ;   $I & IO MUST BE VALID, CALLER MUST CLOSE OUTPUT DEVICE
"RTN","GMTS1",15,0)
 ;               
"RTN","GMTS1",16,0)
START ; Health Summary
"RTN","GMTS1",17,0)
 N GMSUPRES,GMTSICF,GMTSPXD1,GMTSPXD2,GMTSBEG,GMTSEND
"RTN","GMTS1",18,0)
 S GMSUPRES=$P($G(^GMT(142,+$G(GMTSTYP),0)),U,5)
"RTN","GMTS1",19,0)
 I $D(GMSUPRES),$D(GMTSOBJ),'$D(GMTSOBJ("SUPPRESS COMPONENTS")) S GMSUPRES="N"
"RTN","GMTS1",20,0)
 S:$D(GMTSOBJ("SUPPRESS COMPONENTS")) GMSUPRES="Y"
"RTN","GMTS1",21,0)
 U IO S GMTSLO=3,GMTSLPG=0
"RTN","GMTS1",22,0)
 D DEM^GMTSU
"RTN","GMTS1",23,0)
 W:$E(IOST)="C"&('$D(GMTSOBJ)) @IOF D OUTPUT
"RTN","GMTS1",24,0)
 K GMTSCVD,GMTSCKP,GMTSNPG,GMTSPG,GMTSQIT,GMTSHDR,GMTSHD2,GMTSBRK,GMTSLCMP,GMTSDTC
"RTN","GMTS1",25,0)
 K GMTSEGN,GMTSE,GMTSEGR,GMTSEQ,GMTSEGH,GMTSEGL,GMTSDLM,GMTSDLS,GMTSNDM,GMTSN,GMTSQ
"RTN","GMTS1",26,0)
 Q
"RTN","GMTS1",27,0)
 ;
"RTN","GMTS1",28,0)
OUTPUT ; Loop through GMTSEG()
"RTN","GMTS1",29,0)
 D NOW^%DTC S X=% D REGDTM4^GMTSU S GMTSDTM=X
"RTN","GMTS1",30,0)
 I +$G(GMTSPX1)&+$G(GMTSPX2) D  ;   Allows date range for data
"RTN","GMTS1",31,0)
 . S GMTS2=9999999-$P(GMTSPX2,"."),GMTS1=9999999-$P(GMTSPX1,".")-.24
"RTN","GMTS1",32,0)
 . ;   For GMTS1 want to get everything till Midnight
"RTN","GMTS1",33,0)
 . S X=GMTSPX1 D REGDT4^GMTSU S GMTSPXD1=X
"RTN","GMTS1",34,0)
 . S X=GMTSPX2 D REGDT4^GMTSU S GMTSPXD2=X
"RTN","GMTS1",35,0)
 D HEADER^GMTSUP
"RTN","GMTS1",36,0)
 K GMTSQIT S GMTSEGN=""
"RTN","GMTS1",37,0)
 F  S GMTSEGN=$O(GMTSEG(GMTSEGN)) Q:GMTSEGN=""  D  I $D(GMTSQIT),(GMTSQIT="") Q
"RTN","GMTS1",38,0)
 . K GMTSQIT S GMTSEQ=$P(GMTSEG(GMTSEGN),U,1)
"RTN","GMTS1",39,0)
 . S GMTSE=$P(GMTSEG(GMTSEGN),U,2) D SEGMNT D:GMTSEGN=GMTSEGC LASTPG
"RTN","GMTS1",40,0)
 I $D(GMTSOBJ),+($O(GMTSEG(0)))=0 W !,"  No data available"
"RTN","GMTS1",41,0)
 S GMTSHDR=$E(GMTSHDR,1,3)_" END "_$E(GMTSHDR,9,79)
"RTN","GMTS1",42,0)
 S:$D(GMTSOBJ) GMTSHDR=$E(GMTSHDR,1,74)
"RTN","GMTS1",43,0)
 S:$D(GMTSOBJE) GMTSHDR="",$P(GMTSHDR,"*",74)="*"
"RTN","GMTS1",44,0)
 I '$D(GMTSOBJ)!($D(GMTSOBJ("CONFIDENTIAL"))) W:$E(IOST)'="C" !,GMTSHDR,!
"RTN","GMTS1",45,0)
 I '$D(GMTSOBJ) H:$E(IOST)="C" 1
"RTN","GMTS1",46,0)
 W:'+$G(GMPSAP)&('$D(GMTSOBJ))&('$D(GMTSOBJE)) @IOF
"RTN","GMTS1",47,0)
 I $D(GMTSQIT) D EXIT
"RTN","GMTS1",48,0)
 Q
"RTN","GMTS1",49,0)
 ;
"RTN","GMTS1",50,0)
LASTPG ; Allows User to branch to an earlier component (last page)
"RTN","GMTS1",51,0)
 Q:$E(IOST)'="C"!(IOT="HFS")!$D(GMTSQIT)
"RTN","GMTS1",52,0)
 I +$G(GMPSAP),IOSL>998,$G(GMPAT(+$O(GMPAT(0),-1)))'=DFN Q
"RTN","GMTS1",53,0)
 ;   No footer when IOSL > 998 and action profile is printed.
"RTN","GMTS1",54,0)
 I IOSL>998,+$G(GMPSAP) Q
"RTN","GMTS1",55,0)
 ;   No footer when IOSL > 998 and this isn't the last patient.
"RTN","GMTS1",56,0)
 I IOSL>998,$G(GMPAT(+$O(GMPAT(""),-1)))'=$G(DFN) Q
"RTN","GMTS1",57,0)
 I '$D(GMTSOBJ) F I=$Y:1:$S((IOSL-GMTSLO)'>64:(IOSL-GMTSLO),1:(24-GMTSLO)) W !
"RTN","GMTS1",58,0)
 I $D(GMTSQIT),(GMTSQIT>0) K GMTSQIT
"RTN","GMTS1",59,0)
 S GMTSLPG=1 D CKP^GMTSUP
"RTN","GMTS1",60,0)
 Q
"RTN","GMTS1",61,0)
EXIT ; Clean up and quit
"RTN","GMTS1",62,0)
 K ZTSK
"RTN","GMTS1",63,0)
 Q
"RTN","GMTS1",64,0)
SEGMNT ; Output a Component Type
"RTN","GMTS1",65,0)
 N GMTSLOCK,GMTSDBL,GMOOTXT,GMPXICDF,GMPXHLOC,GMPXNARR,GMPXCMOD,GMPXCM,GMTSWRIT,GMSEL
"RTN","GMTS1",66,0)
 I $D(GMTSQIT),(GMTSQIT]"") K GMTSQIT
"RTN","GMTS1",67,0)
 S X=^GMT(142.1,GMTSE,0)
"RTN","GMTS1",68,0)
 S GMTSEGH=$S($P(X,U,4)]"":$P(X,U,4)_" - ",1:"")_$S($P(GMTSEG(GMTSEGN),U,5)]"":$P(GMTSEG(GMTSEGN),U,5),$P(X,U,9)]"":$P(X,U,9),1:" "_$P(X,U,1)),GMTSEGR=$P(X,"^",2)
"RTN","GMTS1",69,0)
 Q:GMTSEGR=""
"RTN","GMTS1",70,0)
 S GMTSLOCK=$P(X,U,7),GMTSDBL=$P(X,U,6),GMOOTXT=$P(X,U,8),GMPXCM=$P(X,U,14)
"RTN","GMTS1",71,0)
 S GMPXHLOC=$P(GMTSEG(GMTSEGN),U,6),GMPXNARR=$P(GMTSEG(GMTSEGN),U,8)
"RTN","GMTS1",72,0)
 S GMPXCMOD=$P(GMTSEG(GMTSEGN),U,9) S:GMPXCM'="Y" GMPXCMOD="N"
"RTN","GMTS1",73,0)
 S GMPXICDF=$P(GMTSEG(GMTSEGN),U,7)
"RTN","GMTS1",74,0)
 S GMTSNDM=$P(GMTSEG(GMTSEGN),U,3),GMTSDLM=$P(GMTSEG(GMTSEGN),U,4) S:GMTSNDM="" GMTSNDM=-1
"RTN","GMTS1",75,0)
 ;   Allow for date range for data
"RTN","GMTS1",76,0)
 S:+$G(GMTSPX1)&+$G(GMTSPX2) GMTSDLM=""
"RTN","GMTS1",77,0)
 S GMTSDLS=""
"RTN","GMTS1",78,0)
 I GMTSDLM?1N.N!(GMTSDLM?1N.N1"D") S GMTSDLS=+GMTSDLM_" day"
"RTN","GMTS1",79,0)
 S:GMTSDLM?1N.N1"W" GMTSDLS=+GMTSDLM_" week",GMTSDLM=+GMTSDLM*7
"RTN","GMTS1",80,0)
 S:GMTSDLM?1N.N1"M" GMTSDLS=+GMTSDLM_" month",GMTSDLM=+GMTSDLM*30.4
"RTN","GMTS1",81,0)
 S:GMTSDLM?1N.N1"Y" GMTSDLS=+GMTSDLM_" year",GMTSDLM=+GMTSDLM*365.25
"RTN","GMTS1",82,0)
 S GMTSDLM=+GMTSDLM
"RTN","GMTS1",83,0)
 S:+GMTSDLS>1 GMTSDLS=GMTSDLS_"s"
"RTN","GMTS1",84,0)
 S GMTSEGL="" I GMTSNDM>0!(GMTSDLM>0) S GMTSEGL=" (max "_$S(GMTSNDM>0:GMTSNDM_$S(GMTSNDM=1:" occurrence",1:" occurrences")_$S(GMTSDLM>0:" or ",1:""),1:"")_$S(GMTSDLM>0:GMTSDLS,1:"")_")"
"RTN","GMTS1",85,0)
 K GMTSDLS,GMTSN
"RTN","GMTS1",86,0)
 D NOW^%DTC S GMTSDTC=%,DT=$P(%,".") K %,%H,%I
"RTN","GMTS1",87,0)
 ;   Use date range unless variables empty
"RTN","GMTS1",88,0)
 ;     GMTS1=Most recent inverted date
"RTN","GMTS1",89,0)
 ;     GMTS2=To date in the past in an inverted date format
"RTN","GMTS1",90,0)
 I +$G(GMTSPX1)'>0!(+$G(GMTSPX2)'>0) D
"RTN","GMTS1",91,0)
 . I GMTSDLM'>0 S (GMTS2,GMTSDLM)=9999999,GMTS1=6666666
"RTN","GMTS1",92,0)
 . E  S X1=GMTSDTC,X2=-GMTSDLM D C^%DTC S GMTSDLM=9999999-X,GMTS2=GMTSDLM,GMTS1=9999999-(GMTSDTC+.0001) K X1,X2
"RTN","GMTS1",93,0)
 ;   Set GMTSBEG to be GMTS2 uninverted
"RTN","GMTS1",94,0)
 S GMTSBEG=$S(GMTS2=9999999:1,1:9999999-GMTS2)
"RTN","GMTS1",95,0)
 ;   Set GMTSEND to be GMTS1 uninverted
"RTN","GMTS1",96,0)
 S GMTSEND=$S(GMTS1=6666666:9999999,1:$P(9999999-GMTS1,".")_".235959")
"RTN","GMTS1",97,0)
 ; GMTSWRIT is used to print component heading on 1st write
"RTN","GMTS1",98,0)
 S GMTSWRIT=1
"RTN","GMTS1",99,0)
 I GMTSDBL]"",("PT"[GMTSDBL) D  Q
"RTN","GMTS1",100,0)
 . D:GMTSDBL="T" TDISBLD^GMTS2
"RTN","GMTS1",101,0)
 . D:GMTSDBL="P"&$D(GMTSPRM) PDISBLD^GMTS2
"RTN","GMTS1",102,0)
 I GMTSLOCK]"",('$D(^XUSEC(GMTSLOCK,DUZ))) D NOMATCH^GMTS2 Q
"RTN","GMTS1",103,0)
 S GMSEL=$P($G(^GMT(142.1,GMTSE,1,1,0)),U)
"RTN","GMTS1",104,0)
 I GMSEL]"",$O(GMTSEG(GMTSEGN,GMSEL,0))'>0 D NOSELECT^GMTS2 Q
"RTN","GMTS1",105,0)
 S GMTSNPG=0,GMTSWRIT=1
"RTN","GMTS1",106,0)
 D @($P(GMTSEGR,";",1)_U_$P(GMTSEGR,";",2))
"RTN","GMTS1",107,0)
 D NODATA^GMTS2 S GMTSWRIT=1
"RTN","GMTS1",108,0)
 K GMTSDLM
"RTN","GMTS1",109,0)
 Q
"RTN","GMTS2")
0^9^B4233437
"RTN","GMTS2",1,0)
GMTS2 ;SLC/SBW - Health Summary Driver Cont. ; 01/06/2003
"RTN","GMTS2",2,0)
 ;;2.7;Health Summary;**2,58**;Oct 20, 1995
"RTN","GMTS2",3,0)
 ;
"RTN","GMTS2",4,0)
TDISBLD ; Temporarily Disabled Components
"RTN","GMTS2",5,0)
 D CKP^GMTSUP Q:$D(GMTSQIT)  W "Temporarily disabled",!
"RTN","GMTS2",6,0)
 I GMOOTXT]"" D CKP^GMTSUP Q:$D(GMTSQIT)  W GMOOTXT,!
"RTN","GMTS2",7,0)
 Q
"RTN","GMTS2",8,0)
PDISBLD ; Permanently Disabled Components
"RTN","GMTS2",9,0)
 D CKP^GMTSUP Q:$D(GMTSQIT)  W "Permanently disabled",!
"RTN","GMTS2",10,0)
 I GMOOTXT]"" D CKP^GMTSUP Q:$D(GMTSQIT)  W GMOOTXT,!
"RTN","GMTS2",11,0)
 Q
"RTN","GMTS2",12,0)
NOMATCH ; User doesn't hold Security Key
"RTN","GMTS2",13,0)
 D CKP^GMTSUP Q:$D(GMTSQIT)
"RTN","GMTS2",14,0)
 W "This component is locked with security key "_GMTSLOCK_".",!
"RTN","GMTS2",15,0)
 Q
"RTN","GMTS2",16,0)
NOSELECT ; No Selection Items
"RTN","GMTS2",17,0)
 ;   Handles cases where components that require
"RTN","GMTS2",18,0)
 ;   selection items have no selection items defined.
"RTN","GMTS2",19,0)
 D CKP^GMTSUP Q:$D(GMTSQIT)
"RTN","GMTS2",20,0)
 W "No selection items chosen for this component.",!
"RTN","GMTS2",21,0)
 Q
"RTN","GMTS2",22,0)
NODATA ; No Data
"RTN","GMTS2",23,0)
 ;  This will display "No Data Available" for commponents
"RTN","GMTS2",24,0)
 ;  components that retrieve no data.
"RTN","GMTS2",25,0)
 N SELNAME I $D(GMTSQIT),(GMTSQIT="") Q
"RTN","GMTS2",26,0)
 Q:GMTSWRIT=0  I $G(GMSUPRES)="Y" K:$D(GMTSOBJ) GMTSEG(+($G(GMTSEGN)))
"RTN","GMTS2",27,0)
 I $E(IOST,1)'="C" Q:$G(GMSUPRES)="Y"
"RTN","GMTS2",28,0)
 I GMSEL]"" D GETSEL,DISPSEL Q
"RTN","GMTS2",29,0)
 D CKP^GMTSUP Q:$D(GMTSQIT)  W !
"RTN","GMTS2",30,0)
 D CKP^GMTSUP Q:$D(GMTSQIT)  W "  No data available",!
"RTN","GMTS2",31,0)
 Q
"RTN","GMTS2",32,0)
GETSEL ; Get Selection Items
"RTN","GMTS2",33,0)
 N GMX,GMI,GMDA,GMFROOT,GMROOT,GMNODE
"RTN","GMTS2",34,0)
 S GMFROOT=$G(GMTSEG(GMTSEGN,GMSEL,0))
"RTN","GMTS2",35,0)
 Q:GMFROOT=""
"RTN","GMTS2",36,0)
 S (GMX,GMI)=0
"RTN","GMTS2",37,0)
 F  S GMI=$O(GMTSEG(GMTSEGN,GMSEL,GMI)) Q:GMI'>0  D
"RTN","GMTS2",38,0)
 . S GMDA=$G(GMTSEG(GMTSEGN,GMSEL,GMI))
"RTN","GMTS2",39,0)
 . S GMROOT=GMFROOT_GMDA_",0)"
"RTN","GMTS2",40,0)
 . S GMNODE=$G(@GMROOT)
"RTN","GMTS2",41,0)
 . I GMDA]"",GMROOT]"" S GMX=GMX+1,SELNAME(GMX)=$P(GMNODE,U)
"RTN","GMTS2",42,0)
 Q
"RTN","GMTS2",43,0)
DISPSEL ; Display selection items
"RTN","GMTS2",44,0)
 N GMI,GMX
"RTN","GMTS2",45,0)
 D CKP^GMTSUP Q:$D(GMTSQIT)  W "No data available for "
"RTN","GMTS2",46,0)
 S (GMI,GMX)=0
"RTN","GMTS2",47,0)
 F  S GMI=$O(SELNAME(GMI)) Q:GMI'>0  D
"RTN","GMTS2",48,0)
 . S GMX=GMX+1
"RTN","GMTS2",49,0)
 . W:GMX>1 "; "
"RTN","GMTS2",50,0)
 . W:(77)'>($X+$L(SELNAME(GMI))) !
"RTN","GMTS2",51,0)
 . D CKP^GMTSUP Q:$D(GMTSQIT)  W SELNAME(GMI)
"RTN","GMTS2",52,0)
 W !
"RTN","GMTS2",53,0)
 Q
"RTN","GMTSALG")
0^22^B29309635
"RTN","GMTSALG",1,0)
GMTSALG ; SLC/DLT,KER - Allergies ; 01/06/2003
"RTN","GMTSALG",2,0)
 ;;2.7;Health Summary;**9,28,49,58**;Oct 20, 1995
"RTN","GMTSALG",3,0)
 ;                 
"RTN","GMTSALG",4,0)
 ; External References
"RTN","GMTSALG",5,0)
 ;   DBIA 10096  ^%ZOSF("TEST"
"RTN","GMTSALG",6,0)
 ;   DBIA 10035  ^DPT(
"RTN","GMTSALG",7,0)
 ;   DBIA   905  ^GMR(120.8
"RTN","GMTSALG",8,0)
 ;   DBIA  2056  $$GET1^DIQ (file #120.86 and #200)
"RTN","GMTSALG",9,0)
 ;   DBIA 10011  ^DIWP
"RTN","GMTSALG",10,0)
 ;   DBIA 10099  EN1^GMRADPT 
"RTN","GMTSALG",11,0)
 ;   DBIA 10060  ^VA(200,
"RTN","GMTSALG",12,0)
 ;   DBIA  3449  ^GMR(120.86,
"RTN","GMTSALG",13,0)
 ;                   
"RTN","GMTSALG",14,0)
ALLRG ; Allergies
"RTN","GMTSALG",15,0)
 N X,GMTSALAS,GMTSALAD,GMTSALAW,GMTSALAT,GMTSAV,GMTSAFN,GMRAL,GMTSAL
"RTN","GMTSALG",16,0)
 N GMTSALNM,GMTSCNT,GMTSEACT,GMTSLN,GMTSMECH,GMTSPRT,GMTSTY,CC,C,KK
"RTN","GMTSALG",17,0)
 N ALLRG,TITLE,JJ K GMTSA S (SEQ,ALLRG)=0,TITLE="ALLERGY/ADVERSE REACTION (AR)"
"RTN","GMTSALG",18,0)
 S X="GMRADPT" X ^%ZOSF("TEST")
"RTN","GMTSALG",19,0)
 I $T D  Q:$D(GMTSQIT)
"RTN","GMTSALG",20,0)
 . D GETALLRG D:ALLRG TITLE,ALLRGP D:'ALLRG&($L($G(GMTSALAS))) TITLE,NKA
"RTN","GMTSALG",21,0)
 I 'ALLRG,'$L($G(GMTSALAS)) D
"RTN","GMTSALG",22,0)
 . I $D(GMTSPNF)&('ALLRG) D CKP^GMTSUP Q:$D(GMTSQIT)  W "Unknown, please evaluate",!
"RTN","GMTSALG",23,0)
 K ALL,CC,CCC,CD,DIWF,DIWL,DIWR,GMTSALF,GMTSALNM,GMTSNODE,GMTSPRT,I,II,JJ,KK,L,M,MX,N,Z,X,SEQ,GMTSA,ALLRG,TITLE,GMRA,GMRAL,GMTSEACT,GMTSMECH,GMTSTY,GMTSPFN,GMTSAL,GMTSCNT,GMTSLN,ODT
"RTN","GMTSALG",24,0)
 Q
"RTN","GMTSALG",25,0)
ALLRGP ; Allergy Print
"RTN","GMTSALG",26,0)
 S II="" F  S II=$O(GMTSAL(II)) Q:II']""  I $O(GMTSAL(II,""))]"" D
"RTN","GMTSALG",27,0)
 . D CKP^GMTSUP Q:$D(GMTSQIT)  W !?2,$S(II="D":"Drug:",II="DF":"Drug/Food:",II="DFO":"Drug/Food/Other:",II="DO":"Drug/Other:",II="F":"Food:",II="FO":"Food/Other:",II="O":"Other:",1:II_":")
"RTN","GMTSALG",28,0)
 . S JJ="" F  S JJ=$O(GMTSAL(II,JJ)) Q:JJ=""  D
"RTN","GMTSALG",29,0)
 .. N WKK S KK=""  F  S KK=$O(GMTSAL(II,JJ,KK)) Q:KK=""  D
"RTN","GMTSALG",30,0)
 ... S L=0 F  S L=$O(GMTSAL(II,JJ,KK,L)) Q:'L  D CKP^GMTSUP Q:$D(GMTSQIT)  D AUTOV W !?5,JJ_": " S:$L(KK)>30 WKK=KK,WKK=$$WRAP^GMTSORC(WKK,30) W ?24,$S($L(KK)>30:$P(WKK,"|"),1:KK) D
"RTN","GMTSALG",31,0)
 .... I GMTSAV=1 W " (AV"
"RTN","GMTSALG",32,0)
 .... E  W $S($P(GMTSAL(II,JJ,KK,L),U,5)=1:" (V",$P(GMTSAL(II,JJ,KK,L),U,5)=0:" (NV",1:"")
"RTN","GMTSALG",33,0)
 .... W $S($P($G(^GMR(120.8,GMTSALNM,0)),U,6)="h":"/Historical)",$P($G(^(0)),U,6)="o":"/Observed)",1:")")
"RTN","GMTSALG",34,0)
 .... I $L($P($G(WKK),"|",2)) D CKP^GMTSUP Q:$D(GMTSQIT)  W !,?24,$P(WKK,"|",2)
"RTN","GMTSALG",35,0)
 .... S (M,MX,ALL)=0 F  S M=$O(GMTSAL(II,JJ,KK,L,"S",M)) Q:M=""  D  Q:$D(GMTSQIT)
"RTN","GMTSALG",36,0)
 ..... I ALL=0 D CKP^GMTSUP Q:$D(GMTSQIT)  W !?27
"RTN","GMTSALG",37,0)
 ..... S MX=MX+1
"RTN","GMTSALG",38,0)
 ..... W:MX>1 ", "
"RTN","GMTSALG",39,0)
 ..... S N=$P(GMTSAL(II,JJ,KK,L,"S",M),";")
"RTN","GMTSALG",40,0)
 ..... S ALL=1 I (74)'>($X+$L(N)) D CKP^GMTSUP Q:$D(GMTSQIT)  W !,?27,N Q
"RTN","GMTSALG",41,0)
 ..... S ALL=1 W N
"RTN","GMTSALG",42,0)
 .... D SIGBLK($P(GMTSAFN,U,5))
"RTN","GMTSALG",43,0)
 .... D CKP^GMTSUP Q:$D(GMTSQIT)  W !,?24,"Date/Time:  " S ODT=$P(GMTSAFN,U,4) S X=ODT D REGDTM4^GMTSU W X,!
"RTN","GMTSALG",44,0)
 ....S CC="" F  S CC=$O(^GMR(120.8,GMTSALNM,26,"B",CC)) Q:CC=""  D CKP^GMTSUP Q:$D(GMTSQIT)  W !,?24,"Comments at: " S X=CC D REGDTM4^GMTSU S CD=X S CCC=0 F  S CCC=$O(^GMR(120.8,GMTSALNM,26,"B",CC,CCC)) Q:'CCC  D TEXT
"RTN","GMTSALG",45,0)
 Q
"RTN","GMTSALG",46,0)
NKA ; No known allergies
"RTN","GMTSALG",47,0)
 D CKP^GMTSUP Q:$D(GMTSQIT)  W:$L($G(GMTSALAS))!($L($G(GMTSALAD))) !
"RTN","GMTSALG",48,0)
 D CKP^GMTSUP Q:$D(GMTSQIT)  W:$L($G(GMTSALAS)) ?22,$G(GMTSALAS),!
"RTN","GMTSALG",49,0)
 D CKP^GMTSUP Q:$D(GMTSQIT)  W:$L($G(GMTSALAS))!($L($G(GMTSALAD)))!($L($G(GMTSALAW))) ?24,"Assessment date:   ",$G(GMTSALAD),!
"RTN","GMTSALG",50,0)
 D CKP^GMTSUP Q:$D(GMTSQIT)  W:$L($G(GMTSALAW)) ?28,"Assessed by:   ",GMTSALAW,!
"RTN","GMTSALG",51,0)
 D CKP^GMTSUP Q:$D(GMTSQIT)  W:$L($G(GMTSALAW))&($L($G(GMTSALAT))) ?34,"Title:   ",GMTSALAT,!
"RTN","GMTSALG",52,0)
 Q
"RTN","GMTSALG",53,0)
GETALLRG ; Get Allergies
"RTN","GMTSALG",54,0)
 S GMRA="0^0^111" D EN1^GMRADPT I GMRAL="" S ALLRG=0 Q
"RTN","GMTSALG",55,0)
 I +($G(DFN))>0,+($G(GMRAL))=0 D ALLAS S ALLRG=0 Q
"RTN","GMTSALG",56,0)
 I $D(GMRAL)>9 D
"RTN","GMTSALG",57,0)
 . S I=0 F GMTSCNT=1:1 S I=$O(GMRAL(I)) Q:'I  D
"RTN","GMTSALG",58,0)
 .. S GMTSTY=$P(GMRAL(I),U,7) Q:GMTSTY']""
"RTN","GMTSALG",59,0)
 .. S GMTSEACT=$P(GMRAL(I),U,2) Q:GMTSEACT']""
"RTN","GMTSALG",60,0)
 .. S GMTSMECH=$P($P(GMRAL(I),U,8),";")
"RTN","GMTSALG",61,0)
 .. S:GMTSMECH']"" GMTSMECH="UNKNOWN"
"RTN","GMTSALG",62,0)
 .. S GMTSAL(GMTSTY,GMTSMECH,GMTSEACT,GMTSCNT)=I_"^"_GMRAL(I)
"RTN","GMTSALG",63,0)
 .. S JJ=0 F  S JJ=$O(GMRAL(I,"S",JJ)) Q:'JJ  S GMTSAL(GMTSTY,GMTSMECH,GMTSEACT,GMTSCNT,"S",JJ)=GMRAL(I,"S",JJ)
"RTN","GMTSALG",64,0)
 .. S ALLRG=1
"RTN","GMTSALG",65,0)
 Q
"RTN","GMTSALG",66,0)
ALLAS ; Allergy Assessment
"RTN","GMTSALG",67,0)
 N X,GMTSALG1,GMTSALG2,GMTSALG3,GMTSAU S (GMTSALAS,GMTSALAD,GMTSALAW)="" S GMTSALAS="No known allergies"
"RTN","GMTSALG",68,0)
 S GMTSALAD=$$GET1^DIQ(120.86,+($G(DFN)),3,"I",,"GMTSALG2") S:$D(GMTSALG2) GMTSALAD="" S:+GMTSALAD=0 GMTSALAD=""
"RTN","GMTSALG",69,0)
 I +GMTSALAD>0 S X=GMTSALAD D REGDT4^GMTSU S GMTSALAD=X
"RTN","GMTSALG",70,0)
 S GMTSAU=$$GET1^DIQ(120.86,+($G(DFN)),2,"I")
"RTN","GMTSALG",71,0)
 S GMTSALAW=$$GET1^DIQ(200,(+GMTSAU_","),.01,"E",,"GMTSALG3")
"RTN","GMTSALG",72,0)
 S GMTSALAT=$$GET1^DIQ(200,(+GMTSAU_","),20.3)
"RTN","GMTSALG",73,0)
 S:$D(GMTSALG3) (GMTSALAW,GMTSALAT)=""
"RTN","GMTSALG",74,0)
 Q
"RTN","GMTSALG",75,0)
AUTOV ; Autoverify
"RTN","GMTSALG",76,0)
 S GMTSAV=0,GMTSALNM=$P(GMTSAL(II,JJ,KK,L),U),GMTSAFN=$G(^GMR(120.8,GMTSALNM,0))
"RTN","GMTSALG",77,0)
 I $P(GMTSAFN,U,18)="",$P(GMTSAFN,U,16)=1 S GMTSAV=1
"RTN","GMTSALG",78,0)
 Q
"RTN","GMTSALG",79,0)
TITLE ; Print title
"RTN","GMTSALG",80,0)
 D CKP^GMTSUP Q:$D(GMTSQIT)
"RTN","GMTSALG",81,0)
 I $D(GMTSPNF) W ?21,TITLE,!
"RTN","GMTSALG",82,0)
 E  W ?21,"Title: ",TITLE,!
"RTN","GMTSALG",83,0)
 Q
"RTN","GMTSALG",84,0)
TEXT ; Setup for print of allergy comments
"RTN","GMTSALG",85,0)
 W ?31,CD D CKP^GMTSUP Q:$D(GMTSQIT)
"RTN","GMTSALG",86,0)
 K ^UTILITY($J,"W") S GMTSLN=0 F  S GMTSLN=$O(^GMR(120.8,GMTSALNM,26,CCC,2,GMTSLN)) Q:'GMTSLN  S GMTSPRT=^GMR(120.8,GMTSALNM,26,CCC,2,GMTSLN,0) D FORMAT
"RTN","GMTSALG",87,0)
 I $D(^UTILITY($J,"W")) F GMTSLN=1:1:^UTILITY($J,"W",DIWL) D LINE Q:$D(GMTSQIT)
"RTN","GMTSALG",88,0)
 K ^UTILITY($J,"W")
"RTN","GMTSALG",89,0)
 Q:'GMTSLN
"RTN","GMTSALG",90,0)
 W ! Q
"RTN","GMTSALG",91,0)
FORMAT ; Formats each line
"RTN","GMTSALG",92,0)
 S DIWL=3,DIWR=80,DIWF="C58",X=GMTSPRT D ^DIWP
"RTN","GMTSALG",93,0)
 Q
"RTN","GMTSALG",94,0)
LINE ; Writes formatted lines of text
"RTN","GMTSALG",95,0)
 D CKP^GMTSUP Q:$D(GMTSQIT)  W !,?24,^UTILITY($J,"W",DIWL,GMTSLN,0)
"RTN","GMTSALG",96,0)
 Q
"RTN","GMTSALG",97,0)
SIGBLK(GMTSALF) ; Signature block
"RTN","GMTSALG",98,0)
 Q:+GMTSALF'>0  N GMTSSB,GMTSST,GMTSSN S GMTSSB=$$GET1^DIQ(200,(+GMTSALF_","),20.2),GMTSST=$$GET1^DIQ(200,(+GMTSALF_","),20.3),GMTSSN=$$GET1^DIQ(200,(+GMTSALF_","),.01)
"RTN","GMTSALG",99,0)
 D CKP^GMTSUP Q:$D(GMTSQIT)  W !!,?24,"Originator: ",$S(GMTSSB'="":GMTSSB,1:GMTSSN)
"RTN","GMTSALG",100,0)
 D CKP^GMTSUP Q:$D(GMTSQIT)  W:$L(GMTSST) !,?24,"Title:      ",GMTSST
"RTN","GMTSALG",101,0)
 Q
"RTN","GMTSCNB")
0^10^B46561093
"RTN","GMTSCNB",1,0)
GMTSCNB ; SLC/KER - Consults Components Brief          ; 01/06/2003
"RTN","GMTSCNB",2,0)
 ;;2.7;Health Summary;**46,47,58**;Oct 20, 1995
"RTN","GMTSCNB",3,0)
 ; 
"RTN","GMTSCNB",4,0)
 ; External References
"RTN","GMTSCNB",5,0)
 ;   DBIA  3358  ^GMR(123,
"RTN","GMTSCNB",6,0)
 ;   DBIA 10040  ^SC(
"RTN","GMTSCNB",7,0)
 ;   DBIA 10104  $$UP^XLFSTR
"RTN","GMTSCNB",8,0)
 ;   DBIA  2056  $$GET1^DIQ     (file 123.1, 44)
"RTN","GMTSCNB",9,0)
 ;   DBIA  2056  GETS^DIQ       (file 123)
"RTN","GMTSCNB",10,0)
 ;   DBIA  2051  LIST^DIC       (file 123.02)
"RTN","GMTSCNB",11,0)
 ;                     
"RTN","GMTSCNB",12,0)
 Q
"RTN","GMTSCNB",13,0)
MAIN ; Consults - Brief
"RTN","GMTSCNB",14,0)
 K ^TMP("GMTSCN")
"RTN","GMTSCNB",15,0)
 N GMTSMAX,GMTSNMC,GMTSI,GMTSDFN S GMTSDFN=+($G(DFN))
"RTN","GMTSCNB",16,0)
 S:'$L($G(GMTS1)) GMTS1=6666666 S:'$L($G(GMTS2)) GMTS2=9999999
"RTN","GMTSCNB",17,0)
 S GMTS1=+($G(GMTS1)),GMTS2=+($G(GMTS2)),GMTSMAX=+($G(GMTSNDM)) S:GMTSMAX'>0 GMTSMAX=999999999
"RTN","GMTSCNB",18,0)
 S GMTSDFN=+($G(GMTSDFN)) Q:GMTSDFN=0  Q:'$D(^GMR(123,"AD",GMTSDFN))
"RTN","GMTSCNB",19,0)
 S:GMTS2>GMTS1 GMTSI=GMTS1,GMTS1=GMTS2,GMTS2=GMTSI S GMTSI=GMTS2-.00000001
"RTN","GMTSCNB",20,0)
 F  S GMTSI=$O(^GMR(123,"AD",GMTSDFN,GMTSI)) Q:+GMTSI=0!(GMTSI>GMTS1)  D  Q:$D(GMTSQIT)
"RTN","GMTSCNB",21,0)
 . S GMTSIEN=0 F  S GMTSIEN=$O(^GMR(123,"AD",GMTSDFN,GMTSI,GMTSIEN)) Q:+GMTSIEN=0  D  Q:$D(GMTSQIT)
"RTN","GMTSCNB",22,0)
 . . Q:+($G(GMTSNMC))>+($G(GMTSMAX))  K ^TMP("GMTSCN",$J)
"RTN","GMTSCNB",23,0)
 . . D EXT(GMTSIEN,GMTSI) Q:$D(GMTSQIT)  D BCD Q:$D(GMTSQIT)
"RTN","GMTSCNB",24,0)
 Q
"RTN","GMTSCNB",25,0)
BCD ;   Brief Consults Display
"RTN","GMTSCNB",26,0)
 Q:'$D(^TMP("GMTSCN",$J))  S GMTSNMC=+($G(GMTSNMC))+1
"RTN","GMTSCNB",27,0)
 D:GMTSNMC=1 BHDR Q:$D(GMTSQIT)
"RTN","GMTSCNB",28,0)
 N GMTSID,GMTSFI,GMTSIE S GMTSID=0
"RTN","GMTSCNB",29,0)
 F  S GMTSID=$O(^TMP("GMTSCN",$J,GMTSID)) Q:+GMTSID=0  D  Q:$D(GMTSQIT)
"RTN","GMTSCNB",30,0)
 . S GMTSFI=123,GMTSIE="" F  S GMTSIE=$O(^TMP("GMTSCN",$J,GMTSID,GMTSFI,GMTSIE)) Q:GMTSIE=""  D  Q:$D(GMTSQIT)
"RTN","GMTSCNB",31,0)
 . . N GMTSNB,GMTSRD,GMTSTO,GMTSVC,GMTSFM,GMTSLA,GMTSAD
"RTN","GMTSCNB",32,0)
 . . S GMTSNB=+($G(GMTSIE)) S:+GMTSNB=0 GMTSNB="?"
"RTN","GMTSCNB",33,0)
 . . S GMTSRD=$G(^TMP("GMTSCN",$J,GMTSID,GMTSFI,GMTSIE,3,"I"))
"RTN","GMTSCNB",34,0)
 . . S GMTSRD=$$UP^XLFSTR($S(+GMTSRD>0:$$ED^GMTSU(+GMTSRD),1:"UNKNOWN"))
"RTN","GMTSCNB",35,0)
 . . S GMTSFM=$$UP^XLFSTR($G(^TMP("GMTSCN",$J,GMTSID,GMTSFI,GMTSIE,2,"E")))
"RTN","GMTSCNB",36,0)
 . . S GMTSTO=$$UP^XLFSTR($G(^TMP("GMTSCN",$J,GMTSID,GMTSFI,GMTSIE,1,"E")))
"RTN","GMTSCNB",37,0)
 . . S GMTSLA=$$UP^XLFSTR($G(^TMP("GMTSCN",$J,GMTSID,GMTSFI,GMTSIE,40,1,1,"E")))
"RTN","GMTSCNB",38,0)
 . . S GMTSLD=$G(^TMP("GMTSCN",$J,GMTSID,GMTSFI,GMTSIE,40,1,2,"I"))
"RTN","GMTSCNB",39,0)
 . . S GMTSLD=$$UP^XLFSTR($S(+GMTSLD>0:$$ED^GMTSU(+GMTSLD),1:"UNKNOWN"))
"RTN","GMTSCNB",40,0)
 . . D WRT
"RTN","GMTSCNB",41,0)
 Q
"RTN","GMTSCNB",42,0)
BHDR ;   Brief Header
"RTN","GMTSCNB",43,0)
 N GMTSL S $P(GMTSL,"-",79)=""
"RTN","GMTSCNB",44,0)
 D CKP^GMTSUP Q:$D(GMTSQIT)  W !,"Request Date/",?15,"Request From"
"RTN","GMTSCNB",45,0)
 D CKP^GMTSUP Q:$D(GMTSQIT)  W !,"Number",?15,"Request To",?52,"Last Action",?67,"Action Date"
"RTN","GMTSCNB",46,0)
 D CKP^GMTSUP Q:$D(GMTSQIT)  W !,GMTSL
"RTN","GMTSCNB",47,0)
 Q
"RTN","GMTSCNB",48,0)
WRT ;   Write Brief Consult
"RTN","GMTSCNB",49,0)
 D CKP^GMTSUP Q:$D(GMTSQIT)  W !,$E(GMTSRD,1,10),?15,GMTSFM,?52,GMTSLA,?67,GMTSLD
"RTN","GMTSCNB",50,0)
 D CKP^GMTSUP Q:$D(GMTSQIT)  W !,GMTSNB,?15,GMTSTO
"RTN","GMTSCNB",51,0)
 D CKP^GMTSUP Q:$D(GMTSQIT)  W !
"RTN","GMTSCNB",52,0)
 Q
"RTN","GMTSCNB",53,0)
EXT(X,Y) ; Extract Consults
"RTN","GMTSCNB",54,0)
 K ^TMP("GMTSCN",$J),^UTILITY("DIQ1",$J) N DIC,DIQ,DR,GMTSFM,GMTSI
"RTN","GMTSCNB",55,0)
 N GMTSIEN,GMTSIENS,GMTSLA,GMTSRT,GMTSTY,GMTSVC
"RTN","GMTSCNB",56,0)
 S GMTSIEN=+($G(X)) Q:GMTSIEN=0  S GMTSI=+($G(Y))
"RTN","GMTSCNB",57,0)
 S DIC=123,GMTSIENS=+($G(GMTSIEN))_","
"RTN","GMTSCNB",58,0)
 S GMTSRT="^TMP(""GMTSCN"","_$J_","_GMTSI_")"
"RTN","GMTSCNB",59,0)
 S DIQ(0)="IE",DR=".01;1;2;3;9" D GETS^DIQ(123,GMTSIENS,DR,"EI",GMTSRT,"MSG")
"RTN","GMTSCNB",60,0)
 S GMTSFM=+($G(^TMP("GMTSCN",$J,GMTSI,123,GMTSIENS,2,"I"))) S:+GMTSFM=0 GMTSFM=""
"RTN","GMTSCNB",61,0)
 S GMTSVC="" S:+GMTSFM>0 GMTSVC=$$GET1^DIQ(44,GMTSFM,9,"E") S:$G(GMTSVC)="NONE" GMTSVC=""
"RTN","GMTSCNB",62,0)
 S:$L(GMTSVC) ^TMP("GMTSCN",$J,GMTSI,123,GMTSIENS,2,"SVC")=GMTSVC
"RTN","GMTSCNB",63,0)
 S GMTSTY="" S:+GMTSFM>0 GMTSTY=$$GET1^DIQ(44,GMTSFM,2,"E")
"RTN","GMTSCNB",64,0)
 S GMTSFM=$$FM(($G(^TMP("GMTSCN",$J,GMTSI,123,GMTSIENS,2,"E"))_"^"_GMTSTY_"^"_GMTSVC))
"RTN","GMTSCNB",65,0)
 S ^TMP("GMTSCN",$J,GMTSI,123,GMTSIENS,2,"E")=GMTSFM
"RTN","GMTSCNB",66,0)
 S GMTSLA=+($G(^TMP("GMTSCN",$J,GMTSI,DIC,GMTSIENS,9,"I")))
"RTN","GMTSCNB",67,0)
 S:+GMTSLA'>9 ^TMP("GMTSCN",$J,GMTSI,DIC,GMTSIENS,9,"E")=""
"RTN","GMTSCNB",68,0)
 I +GMTSLA>0 D
"RTN","GMTSCNB",69,0)
 . S GMTSLA=$$GET1^DIQ(123.1,GMTSLA,7,"E")
"RTN","GMTSCNB",70,0)
 . S ^TMP("GMTSCN",$J,GMTSI,DIC,GMTSIENS,9,"E")=GMTSLA
"RTN","GMTSCNB",71,0)
 S ^TMP("GMTSCN",$J,GMTSI,DIC,GMTSIENS,0)=(9999999-GMTSI)_"^"_$S(GMTSI>0:$$EDT^GMTSU((9999999-GMTSI)),1:"")
"RTN","GMTSCNB",72,0)
 D ACT
"RTN","GMTSCNB",73,0)
 Q
"RTN","GMTSCNB",74,0)
FM(X) ; From Service/Ward
"RTN","GMTSCNB",75,0)
 S X=$G(X) N GMTSTY,GMTSV S GMTSTY=$P(X,"^",2),GMTSV=$P(X,"^",3),X=$P(X,"^",1)
"RTN","GMTSCNB",76,0)
 I $L(X) S:+X>0&(GMTSTY="WARD")&(X'["WARD") X="WARD "_X S:+X'>0&(GMTSTY="WARD")&(X'["WARD") X=X_" WARD"
"RTN","GMTSCNB",77,0)
 S:($L(X)+$L(GMTSV)+3)'>30&($L(GMTSV))&(X'[GMTSV) X=X_" ("_GMTSV_")"
"RTN","GMTSCNB",78,0)
 S X=$$UP^XLFSTR(X)
"RTN","GMTSCNB",79,0)
 Q X
"RTN","GMTSCNB",80,0)
ACT ; Activity
"RTN","GMTSCNB",81,0)
 N GMTSL,GMTSFL,GMTSFLA,GMTSFLD,GMTSLA,GMTSLD,GMTSLR,GMTSAM,GMTSLM,GMTSC,GMTSDI,Y,DR,GMTSIENL,GMTSIENS,GMTSMSG K ^TMP("DILIST",$J)
"RTN","GMTSCNB",82,0)
 S GMTSIENS=+GMTSIEN_",",GMTSIENL=","_GMTSIENS,DR="1I;2I;9;10"
"RTN","GMTSCNB",83,0)
 D LIST^DIC(123.02,GMTSIENL,DR,,"*",,,,,,.GMTSDI,"GMTSMSG")
"RTN","GMTSCNB",84,0)
 K:+($G(^TMP("DILIST",$J,0)))=0 ^TMP("DILIST",$J) Q:+($G(^TMP("DILIST",$J,0)))=0
"RTN","GMTSCNB",85,0)
 S GMTSLA="",GMTSLD=0,GMTSLR="",GMTSAM="",GMTSC=0
"RTN","GMTSCNB",86,0)
 S GMTSL=0
"RTN","GMTSCNB",87,0)
 F  S GMTSL=$O(^TMP("DILIST",$J,"ID",GMTSL)) Q:+GMTSL=0  D
"RTN","GMTSCNB",88,0)
 . I +($G(^TMP("DILIST",$J,"ID",GMTSL,2)))'<GMTSLD,+($G(^TMP("DILIST",$J,"ID",GMTSL,2)))>0 D
"RTN","GMTSCNB",89,0)
 . . S GMTSLA=+($G(^TMP("DILIST",$J,"ID",GMTSL,1)))
"RTN","GMTSCNB",90,0)
 . . S GMTSLD=+($G(^TMP("DILIST",$J,"ID",GMTSL,2)))
"RTN","GMTSCNB",91,0)
 . . S GMTSLR=$G(^TMP("DILIST",$J,"ID",GMTSL,9))
"RTN","GMTSCNB",92,0)
 . . S GMTSLM=$G(^TMP("DILIST",$J,"ID",GMTSL,10))
"RTN","GMTSCNB",93,0)
 I +($G(GMTSFLA))>0,+($G(GMTSFLD))>0,+($G(GMTSFL))>0,+($G(GMTSR))'>0 S GMTSC=0,GMTSLA=GMTSFLA,GMTSLD=GMTSFLA D AAC
"RTN","GMTSCNB",94,0)
 I GMTSLA>0,GMTSLD>0 S GMTSC=1 D AAC
"RTN","GMTSCNB",95,0)
 K ^TMP("DILIST",$J)
"RTN","GMTSCNB",96,0)
 Q
"RTN","GMTSCNB",97,0)
AAC ;   Add Activity
"RTN","GMTSCNB",98,0)
 N GMTSEA,GMTSEP,GMTSEL,GMTSOR,GMTSW,I S GMTSC=+($G(GMTSC))
"RTN","GMTSCNB",99,0)
 S GMTSOR=$$UP^XLFSTR($$GET1^DIQ(123.1,GMTSLA,1,"I"))
"RTN","GMTSCNB",100,0)
 S GMTSEP=$$UP^XLFSTR($$GET1^DIQ(123.1,GMTSLA,7,"E"))
"RTN","GMTSCNB",101,0)
 S GMTSEA=$$UP^XLFSTR($$GET1^DIQ(123.1,GMTSLA,.01,"E"))
"RTN","GMTSCNB",102,0)
 S GMTSEL=$$AL(GMTSEA,GMTSEP) Q:'$L(GMTSEL)
"RTN","GMTSCNB",103,0)
 S GMTSEA=$$AN(GMTSEA,GMTSEP) Q:'$L(GMTSEA)
"RTN","GMTSCNB",104,0)
 I GMTSC>0 D
"RTN","GMTSCNB",105,0)
 . S ^TMP("GMTSCN",$J,GMTSI,123,GMTSIENS,40,GMTSC,1,"I")=GMTSLA,^TMP("GMTSCN",$J,GMTSI,123,GMTSIENS,40,GMTSC,1,"E")=GMTSEA,^TMP("GMTSCN",$J,GMTSI,123,GMTSIENS,40,GMTSC,1,"L")=GMTSEL
"RTN","GMTSCNB",106,0)
 . S ^TMP("GMTSCN",$J,GMTSI,123,GMTSIENS,40,GMTSC,2,"I")=GMTSLD,^TMP("GMTSCN",$J,GMTSI,123,GMTSIENS,40,GMTSC,2,"E")=$$EDT^GMTSU(GMTSLD)
"RTN","GMTSCNB",107,0)
 I GMTSC'>0 D
"RTN","GMTSCNB",108,0)
 . S ^TMP("GMTSCN",$J,GMTSI,123,GMTSIENS,40,"LA","I")=GMTSLA,^TMP("GMTSCN",$J,GMTSI,123,GMTSIENS,40,"LA","E")=GMTSEA,^TMP("GMTSCN",$J,GMTSI,123,GMTSIENS,40,"LA","L")=GMTSEL
"RTN","GMTSCNB",109,0)
 . S ^TMP("GMTSCN",$J,GMTSI,123,GMTSIENS,40,"LD","I")=GMTSLD,^TMP("GMTSCN",$J,GMTSI,123,GMTSIENS,40,"LD","E")=$$EDT^GMTSU(GMTSLD)
"RTN","GMTSCNB",110,0)
 . S ^TMP("GMTSCN",$J,GMTSI,123,GMTSIENS,40,"WR","E")=$G(^TMP("DILIST",$J,"ID",GMTSFL,3))
"RTN","GMTSCNB",111,0)
 Q
"RTN","GMTSCNB",112,0)
AN(X,Y) ;   Activity Name
"RTN","GMTSCNB",113,0)
 N GMTSW,GMTSP,GMTSA S GMTSA=$G(X),GMTSP=$G(Y) S X=$$SN((GMTSA_" "_GMTSP)) S X=$E(X,1,11) Q X
"RTN","GMTSCNB",114,0)
AL(X,Y) ;   Activity Name
"RTN","GMTSCNB",115,0)
 N GMTSP,GMTSA S GMTSA=$G(X),GMTSP=$G(Y) S:GMTSA["RECEIVE" (GMTSA,GMTSP)="RECEIVED"
"RTN","GMTSCNB",116,0)
 S:GMTSA="ENTERED IN CPRS"!(GMTSA["CPRS RELEASED") (GMTSA,GMTSP)="DATA ENTRY" S:GMTSA="EDIT BEFORE RELEASE" (GMTSA,GMTSP)="EDITED"
"RTN","GMTSCNB",117,0)
 S X="" S:$L(GMTSA)&($L(GMTSP)) X=$S($L(GMTSP)>$L(GMTSA):GMTSP,1:GMTSA) S:'$L(GMTSA)!('$L(GMTSP)) X=$S('$L(GMTSP)&($L(GMTSA)):GMTSA,$L(GMTSP)&('$L(GMTSA)):GMTSP,1:"")
"RTN","GMTSCNB",118,0)
 Q X
"RTN","GMTSCNB",119,0)
SN(X) ;
"RTN","GMTSCNB",120,0)
 S X=$G(X) Q:X="" "UNKNOWN" Q:X["ENTERED"!(X["RELEASED") "ENTERED" Q:X["STATUS" "STAT CHG"
"RTN","GMTSCNB",121,0)
 Q:X["SIGNIF" "SIG FIND" Q:X["DISCONT" "DISCONT'D" Q:X["SCHEDUL" "SCHEDULED" Q:X["INCOMPL" "INCOMPLETE" Q:X["COMPLET" "COMPLETE"
"RTN","GMTSCNB",122,0)
 Q:X["EDIT" "EDITED" Q:X["DISASSO" "DISASSOC'D" Q:X["ADDENDUM" "ADDENDUM" Q:X["NEW NOTE" "NEW NOTE"
"RTN","GMTSCNB",123,0)
 Q:X["SERVICE" "SVC ENTER" Q:X["FORWARD" "FORWARDED" Q:X["CANCELLED" "CANCELLED" Q:X["COMMENT" "COMMENT" Q:X["RECEIVED" "RECEIVED" Q:X["PRINTED" "PRINTED"
"RTN","GMTSCNB",124,0)
 Q "UNKNOWN"
"RTN","GMTSDEM2")
0^24^B37019357
"RTN","GMTSDEM2",1,0)
GMTSDEM2 ; SLC/DLT,KER - Demographics (cont) ; 01/06/2003
"RTN","GMTSDEM2",2,0)
 ;;2.7;Health Summary;**56,58**;Oct 20, 1995
"RTN","GMTSDEM2",3,0)
 ;                 
"RTN","GMTSDEM2",4,0)
 ; External References
"RTN","GMTSDEM2",5,0)
 ;   DBIA 10061  OAD^VADPT
"RTN","GMTSDEM2",6,0)
 ;   DBIA   951  ^IBE(355.1
"RTN","GMTSDEM2",7,0)
 ;   DBIA   794  ^DIC(36
"RTN","GMTSDEM2",8,0)
 ;   DBIA  2056  $$GET1^DIQ (file #36, and #355.1)
"RTN","GMTSDEM2",9,0)
 ;   DBIA 10145  ALL^IBCNS1  
"RTN","GMTSDEM2",10,0)
 ;   DBIA 10104  $$UP^XLFSTR
"RTN","GMTSDEM2",11,0)
 ;                     
"RTN","GMTSDEM2",12,0)
NOKC ; Next of Kin Component
"RTN","GMTSDEM2",13,0)
 N GMTSNOK S GMTSNOK="" D NOK Q
"RTN","GMTSDEM2",14,0)
NOK ; Next of Kin
"RTN","GMTSDEM2",15,0)
 Q:$D(GMTSQIT)  N %,%H,STR,STR1,STR2,NOKTYPE,ADR,VAERR,VAOA K VAOA("A") D OAD^VADPT
"RTN","GMTSDEM2",16,0)
 I $L($G(VAOA(9))) D
"RTN","GMTSDEM2",17,0)
 . ;   Primary Next of Kin
"RTN","GMTSDEM2",18,0)
 . S NOKTYPE="Primary" D DNOK
"RTN","GMTSDEM2",19,0)
 . S VAOA("A")=3 D OAD^VADPT
"RTN","GMTSDEM2",20,0)
 . I $L($G(VAOA(9))) D
"RTN","GMTSDEM2",21,0)
 . . ;   Secondary Next of Kin
"RTN","GMTSDEM2",22,0)
 . . K GMTSNOK S NOKTYPE="Secondary" D DNOK
"RTN","GMTSDEM2",23,0)
 Q
"RTN","GMTSDEM2",24,0)
DNOK ;   Display Next of Kin
"RTN","GMTSDEM2",25,0)
 D:'$D(GMTSNOK) WRT^GMTSDEM("",,,,0) Q:$D(GMTSQIT)
"RTN","GMTSDEM2",26,0)
 S STR1=$$UP^XLFSTR(VAOA(9)),STR2=$S('$L(VAOA(10)):"<not given>",1:$$REL($$UP^XLFSTR(VAOA(10))))
"RTN","GMTSDEM2",27,0)
 D WRT^GMTSDEM(($G(NOKTYPE)_" NOK"),STR1,"Relation",STR2,1) Q:$D(GMTSQIT)
"RTN","GMTSDEM2",28,0)
 S ADR=$G(VAOA(1)) K VAOA(1) I '$L(ADR) S ADR=$G(VAOA(2)) K VAOA(2) I '$L(ADR) S ADR=$G(VAOA(3)) K VAOA(3)
"RTN","GMTSDEM2",29,0)
 S STR=$S('$L(ADR):"<street address not available>",1:$$UP^XLFSTR(ADR))
"RTN","GMTSDEM2",30,0)
 K:STR="<street address not available>" VAOA(1),VAOA(2),VAOA(3)
"RTN","GMTSDEM2",31,0)
 D WRT^GMTSDEM("",STR,"Phone",VAOA(8),1) Q:$D(GMTSQIT)
"RTN","GMTSDEM2",32,0)
 S ADR=$G(VAOA(2)) K VAOA(2) I '$L(ADR) S ADR=$G(VAOA(3)) K VAOA(3)
"RTN","GMTSDEM2",33,0)
 S STR=$$UP^XLFSTR(ADR) D:$L(STR) WRT^GMTSDEM("",STR,,,1) Q:$D(GMTSQIT)
"RTN","GMTSDEM2",34,0)
 S ADR=$G(VAOA(3))
"RTN","GMTSDEM2",35,0)
 S STR=$$UP^XLFSTR(ADR) D:$L(STR) WRT^GMTSDEM("",STR,,,1) Q:$D(GMTSQIT)
"RTN","GMTSDEM2",36,0)
 I VAOA(4)'="" D
"RTN","GMTSDEM2",37,0)
 . S STR=$$UP^XLFSTR(VAOA(4)) S:VAOA(5) STR=STR_", "_$$UP^XLFSTR($P(VAOA(5),U,2)) S:VAOA(6) STR=STR_"  "_$$UP^XLFSTR(VAOA(6))
"RTN","GMTSDEM2",38,0)
 . D WRT^GMTSDEM("",STR,,,1) Q:$D(GMTSQIT)
"RTN","GMTSDEM2",39,0)
 Q
"RTN","GMTSDEM2",40,0)
REL(X) ; Relation
"RTN","GMTSDEM2",41,0)
 S X=$$UP^XLFSTR($G(X)) Q:'$L(X)  S:X="W" X="SPOUSE" S:X="H" X="SPOUSE" S:X="B" X="BROTHER" S:X="S" X="SISTER" S:X="A" X="AUNT" S:X="U" X="UNCLE" S:X="C" X="COUSIN"
"RTN","GMTSDEM2",42,0)
 S:"WIFE"[X X="SPOUSE" S:"HUSBAND"[X X="SPOUSE" S:"NONE"[X X="NONE" S:"UNKNOWN"[X X="UNKNOWN"
"RTN","GMTSDEM2",43,0)
 S:"BROTHER"[X X="BROTHER" S:"BROTHER"'[X&("BROTHER-IN-LAW"[X) X="BROTHER-IN-LAW" S:"BROTHER"'[X&("BROTHER IN LAW"[X) X="BROTHER-IN-LAW" S:$E(X,1,3)="BRO"&("BROTHER"'[X) X="BROTHER-IN-LAW"
"RTN","GMTSDEM2",44,0)
 S:"SISTER"[X X="SISTER" S:"SISTER"'[X&("SISTER-IN-LAW"[X) X="SISTER-IN-LAW" S:"SISTER"'[X&("SISTER IN LAW"[X) X="SISTER-IN-LAW" S:$E(X,1,3)="SIS"&("SISTER"'[X) X="SISTER-IN-LAW"
"RTN","GMTSDEM2",45,0)
 S:"AUNT"[X X="AUNT" S:"UNCLE"[X X="UNCLE" S:"COUSIN"[X X="COUSIN" S:"FATHER"[X X="FATHER" S:"MOTHER"[X X="MOTHER"
"RTN","GMTSDEM2",46,0)
 S:"FATHER"'[X&("GRANDFATHER"[X) X="GRANDFATHER" S:"FATHER"'[X&("GRAND FATHER"[X) X="GRANDFATHER" S:"MOTHER"'[X&("GRANDMOTHER"[X) X="GRANDMOTHER" S:"MOTHER"'[X&("GRAND MOTHER"[X) X="GRANDMOTHER"
"RTN","GMTSDEM2",47,0)
 S:"SON"[X X="SON" S:"SON"'[X&("SON-IN-LAW"[X) X="SON-IN-LAW" S:"SON"'[X&("SON IN LAW"[X) X="SON-IN-LAW" S:$E(X,1,3)="SON"&("SON"'[X) X="SON-IN-LAW"
"RTN","GMTSDEM2",48,0)
 S:"DAUGHTER"[X X="DAUGHTER" S:"DAUGHTER"'[X&("DAUGHTER-IN-LAW"[X) X="DAUGHTER-IN-LAW" S:"DAUGHTER"'[X&("DAUGHTER IN LAW"[X) X="DAUGHTER-IN-LAW" S:$E(X,1,3)="DAU"&("DAUGHTER"'[X) X="DAUGHTER-IN-LAW"
"RTN","GMTSDEM2",49,0)
 S:"NIECE"'[X&("NIECE IN LAW"[X) X="NIECE" S:"NEPHEW"'[X&("NEPHEW IN LAW"[X) X="NEPHEW"
"RTN","GMTSDEM2",50,0)
 Q X
"RTN","GMTSDEM2",51,0)
 ;                
"RTN","GMTSDEM2",52,0)
INS ; Insurance Info
"RTN","GMTSDEM2",53,0)
 N I,INSURE,GMTSX,IEN,VAL,CLAIM,COMPANY,TYPE,COB,SUBSCRIB,GROUP,HOLDER,EFFECT,EXPIRE
"RTN","GMTSDEM2",54,0)
 D ALL^IBCNS1(DFN,"INSURE") Q:$O(INSURE(0))=""
"RTN","GMTSDEM2",55,0)
 S I=0 F  S I=$O(INSURE(I)) Q:'I  D   Q:$D(GMTSQIT)
"RTN","GMTSDEM2",56,0)
 . S (COMPANY,TYPE,GROUP,HOLDER,EFFECT,EXPIRE)=""
"RTN","GMTSDEM2",57,0)
 . S GMTSX=INSURE(I,0),IEN=+GMTSX
"RTN","GMTSDEM2",58,0)
 . ;   Insurance Company
"RTN","GMTSDEM2",59,0)
 . S COMPANY=$$GET1^DIQ(36,(+IEN_","),.01) Q:'$L(COMPANY)
"RTN","GMTSDEM2",60,0)
 . S CLAIM=INSURE(I,355.3)
"RTN","GMTSDEM2",61,0)
 . ;   Policy Type
"RTN","GMTSDEM2",62,0)
 . S IEN=$P(CLAIM,"^",9)
"RTN","GMTSDEM2",63,0)
 . S TYPE="" I IEN]"" D
"RTN","GMTSDEM2",64,0)
 . . S TYPE=$$GET1^DIQ(355.1,(+IEN_","),.01) S TYPE=$$ABR(TYPE)
"RTN","GMTSDEM2",65,0)
 . ;   Group Number
"RTN","GMTSDEM2",66,0)
 . S GROUP=$P(CLAIM,"^",4)
"RTN","GMTSDEM2",67,0)
 . S GMTSX=INSURE(I,0),VAL=$P(GMTSX,"^",6)
"RTN","GMTSDEM2",68,0)
 . ;   Insurance Policy Holder
"RTN","GMTSDEM2",69,0)
 . S HOLDER=$S(VAL="v":"SELF",VAL="s":"SPOUSE",1:"OTHER")
"RTN","GMTSDEM2",70,0)
 . ;   Insurace Effect Date
"RTN","GMTSDEM2",71,0)
 . S EFFECT=$P(GMTSX,"^",8)
"RTN","GMTSDEM2",72,0)
 . ;   Insurance Expiration Date
"RTN","GMTSDEM2",73,0)
 . S EXPIRE=$P(GMTSX,"^",4)
"RTN","GMTSDEM2",74,0)
 . ;   Subscriber ID
"RTN","GMTSDEM2",75,0)
 . S SUBSCRIB=$P($G(INSURE(I,0)),"^",2)
"RTN","GMTSDEM2",76,0)
 . ;   Coordination of Benefits
"RTN","GMTSDEM2",77,0)
 . S COB=+($P($G(INSURE(I,0)),"^",20))
"RTN","GMTSDEM2",78,0)
 . S COB=$S(COB=1:"PRIMARY",COB=2:"SECONDARY",COB=3:"TERTIARY",1:"UNKNOWN")
"RTN","GMTSDEM2",79,0)
 . Q:$D(GMTSQIT)  D WRT^GMTSDEM("",,,,0) Q:$D(GMTSQIT)
"RTN","GMTSDEM2",80,0)
 . D WRT^GMTSDEM("Insurance Company",$E(COMPANY,1,27),"Holder",HOLDER,1) Q:$D(GMTSQIT)
"RTN","GMTSDEM2",81,0)
 . I $L(TYPE)!($L(EFFECT)) D WRT^GMTSDEM("Policy Type",$E(TYPE,1,28),"Effective",$$EDT^GMTSU(EFFECT),1) Q:$D(GMTSQIT)
"RTN","GMTSDEM2",82,0)
 . I $L(GROUP)!($L(EXPIRE)) D WRT^GMTSDEM("Group #",$E(GROUP,1,28),"Expires",$$EDT^GMTSU(EXPIRE),1) Q:$D(GMTSQIT)
"RTN","GMTSDEM2",83,0)
 . I $L(SUBSCRIB)!($L(COB)) D WRT^GMTSDEM("Subscriber ID",$E(SUBSCRIB,1,28),"Coord. of Benefits",COB,1) Q:$D(GMTSQIT)
"RTN","GMTSDEM2",84,0)
 Q
"RTN","GMTSDEM2",85,0)
 ;          
"RTN","GMTSDEM2",86,0)
ABR(X) ; Abbreviations
"RTN","GMTSDEM2",87,0)
 S X=$$UP^XLFSTR($G(X)) N TM,AB,SID S TM="PROCEDURES",AB="PROC" S:X[TM X=$$SW(X,TM,AB)
"RTN","GMTSDEM2",88,0)
 S TM="SUPPLEMENTAL",AB="SUP" S:X[TM X=$$SW(X,TM,AB) S TM="ORGANIZATION",AB="ORG" S:X[TM X=$$SW(X,TM,AB) S TM="ORIGIZ",AB="ORG" S:X[TM X=$$SW(X,TM,AB)
"RTN","GMTSDEM2",89,0)
 S TM="ORGANIZ",AB="ORG" S:X[TM X=$$SW(X,TM,AB) S TM="MAINTENANCE",AB="MAINT" S:X[TM X=$$SW(X,TM,AB) S TM="PROVIDER",AB="PROV" S:X[TM X=$$SW(X,TM,AB)
"RTN","GMTSDEM2",90,0)
 S TM="INDIVIDUAL",AB="INDIVID" S:X[TM X=$$SW(X,TM,AB) S TM="ASSOCATION",AB="ASSOC" S:X[TM X=$$SW(X,TM,AB) S TM="ASSOCIATION",AB="ASSOC" S:X[TM X=$$SW(X,TM,AB)
"RTN","GMTSDEM2",91,0)
 S TM="PRACT",AB="PRACT" S:X[TM X=$$SW(X,TM,AB) S TM="INSURANCE",AB="INS" S:X[TM X=$$SW(X,TM,AB) S TM="ETC.",AB="ETC" S:X[TM X=$$SW(X,TM,AB)
"RTN","GMTSDEM2",92,0)
 S TM="(ONLY)",AB="" S:X[TM X=$$SW(X,TM,AB) S TM="PROTECTION",AB="PROT" S:X[TM X=$$SW(X,TM,AB) S TM="PRACTICE",AB="PRACT" S:X[TM X=$$SW(X,TM,AB)
"RTN","GMTSDEM2",93,0)
 Q X
"RTN","GMTSDEM2",94,0)
SW(X,Y,Z) ; Swap Abbreviation with Term
"RTN","GMTSDEM2",95,0)
 N TM,AB
"RTN","GMTSDEM2",96,0)
 S X=$G(X),TM=$$TRIM($G(Y)),AB=$$TRIM($G(Z)) Q:X="" ""  Q:TM="" X  Q:TM=AB X
"RTN","GMTSDEM2",97,0)
 F  Q:X'[TM  S X=$P(X,TM,1)_AB_$P(X,TM,2)
"RTN","GMTSDEM2",98,0)
 Q X
"RTN","GMTSDEM2",99,0)
TRIM(X) ; Trim Spaces
"RTN","GMTSDEM2",100,0)
 S X=$G(X) Q:X="" X F  Q:$E(X,1)'=" "  S X=$E(X,2,$L(X))
"RTN","GMTSDEM2",101,0)
 F  Q:$E(X,$L(X))'=" "  S X=$E(X,1,($L(X)-1))
"RTN","GMTSDEM2",102,0)
 F  Q:X'["  "  S X=$P(X,"  ",1)_" "_$P(X,"  ",2,229)
"RTN","GMTSDEM2",103,0)
 Q X
"RTN","GMTSLRC")
0^11^B5417657
"RTN","GMTSLRC",1,0)
GMTSLRC ; SLC/JER,KER - Chemistry & Hematology Comp Dvr ; 01/06/2003
"RTN","GMTSLRC",2,0)
 ;;2.7;Health Summary;**28,47,58**;Oct 20, 1995
"RTN","GMTSLRC",3,0)
 ;
"RTN","GMTSLRC",4,0)
 ; External References
"RTN","GMTSLRC",5,0)
 ;    DBIA   525  ^LR( all fields
"RTN","GMTSLRC",6,0)
 ;    DBIA 10035  ^DPT( field 63 Read w/Fileman
"RTN","GMTSLRC",7,0)
 ;    DBIA  2056  $$GET1^DIQ (file 2)
"RTN","GMTSLRC",8,0)
 ;                       
"RTN","GMTSLRC",9,0)
MAIN ; Chemisty and Hematology
"RTN","GMTSLRC",10,0)
 N GMCFLAG,GMCMNT,IX0,IX,LRDFN,MAX,CNT,PTR,RWIDTH
"RTN","GMTSLRC",11,0)
 S LRDFN=+($$GET1^DIQ(2,(+($G(DFN))_","),63,"I")) Q:+LRDFN=0  Q:'$D(^LR(LRDFN))
"RTN","GMTSLRC",12,0)
 I $D(GMTSNDM),(GMTSNDM>0) S MAX=GMTSNDM
"RTN","GMTSLRC",13,0)
 E  S MAX=999
"RTN","GMTSLRC",14,0)
 S RWIDTH=8 ;Optional variable used in ^GMTSLRCE
"RTN","GMTSLRC",15,0)
 D ^GMTSLRCE
"RTN","GMTSLRC",16,0)
 I '$D(^TMP("LRC",$J)) Q
"RTN","GMTSLRC",17,0)
 D WRTHDR S GMCMNT=$S($P($G(^GMT(142.99,1,0)),U,3)="Y":1,1:0)
"RTN","GMTSLRC",18,0)
 S IX=GMTS1 F IX0=1:1:MAX S IX=$O(^TMP("LRC",$J,IX)) Q:IX=""!(IX>GMTS2)  S (PTR,CNT)=0 F  S PTR=$O(^TMP("LRC",$J,IX,PTR)) Q:PTR=""  S CNT=CNT+1 D WRT
"RTN","GMTSLRC",19,0)
 I +$G(GMCFLAG) D
"RTN","GMTSLRC",20,0)
 . D CKP^GMTSUP Q:$D(GMTSQIT)  W !
"RTN","GMTSLRC",21,0)
 . D CKP^GMTSUP Q:$D(GMTSQIT)  W "!!  Indicates COMMENTS AVAILABLE...Refer to Interim Lab Report.",!
"RTN","GMTSLRC",22,0)
 K ^TMP("LRC",$J)
"RTN","GMTSLRC",23,0)
 Q
"RTN","GMTSLRC",24,0)
WRTHDR ; Prints columnar header
"RTN","GMTSLRC",25,0)
 D CKP^GMTSUP Q:$D(GMTSQIT)  W "Collection DT",?18,"Specimen",?29
"RTN","GMTSLRC",26,0)
 W "Test Name",?48,"Result",?58,"Units",?68,"Ref Range",!
"RTN","GMTSLRC",27,0)
 W:'$D(GMTSOBJ) !
"RTN","GMTSLRC",28,0)
 S GMTSNPG=1
"RTN","GMTSLRC",29,0)
 Q
"RTN","GMTSLRC",30,0)
WRT ; Writes Chemistry & Hematology Component
"RTN","GMTSLRC",31,0)
 N GMI,GMX,GMTSI
"RTN","GMTSLRC",32,0)
 I PTR="C",'+$G(GMCMNT) Q
"RTN","GMTSLRC",33,0)
 I PTR="C",($D(^TMP("LRC",$J,IX,"C"))>9),+$G(GMCMNT) D  Q
"RTN","GMTSLRC",34,0)
 . S GMI=0 F  S GMI=$O(^TMP("LRC",$J,IX,"C",GMI)) Q:GMI'>0  D
"RTN","GMTSLRC",35,0)
 . . D CKP^GMTSUP Q:$D(GMTSQIT)  W "Comment: ",^TMP("LRC",$J,IX,"C",GMI),!
"RTN","GMTSLRC",36,0)
 S GMX=^TMP("LRC",$J,IX,PTR)
"RTN","GMTSLRC",37,0)
 D CKP^GMTSUP Q:$D(GMTSQIT)  D:GMTSNPG WRTHDR
"RTN","GMTSLRC",38,0)
 W:CNT=1!(GMTSNPG) $P(GMX,U),?18,$E($P(GMX,U,2),1,10)
"RTN","GMTSLRC",39,0)
 W:CNT>1&'(GMTSNPG) ?3,"""",?12,"""",?20,""""
"RTN","GMTSLRC",40,0)
 I $D(^TMP("LRC",$J,IX,"C"))>9,'+$G(GMCMNT) W ?24,"!! " S GMCFLAG=1
"RTN","GMTSLRC",41,0)
 W ?29,$E($P(GMX,U,3),1,17),?46,$P(GMX,U,4)," ",$P(GMX,U,5)
"RTN","GMTSLRC",42,0)
 W ?58,$P(GMX,U,6)
"RTN","GMTSLRC",43,0)
 S GMTSI=$P(GMX,U,8) S:GMTSI="NEGATIVE" GMTSI="NEG"
"RTN","GMTSLRC",44,0)
 W ?68,$J($P(GMX,U,7),4),?73,"-",?74,$J(GMTSI,4),!
"RTN","GMTSLRC",45,0)
 Q
"RTN","GMTSLROB")
0^12^B2371971
"RTN","GMTSLROB",1,0)
GMTSLROB ; SLC/JER - Brief Lab Order ; 01/06/2003
"RTN","GMTSLROB",2,0)
 ;;2.7;Health Summary;**28,58**;Oct 20, 1995
"RTN","GMTSLROB",3,0)
MAIN ; Driver
"RTN","GMTSLROB",4,0)
 N GMW,GMX,ICD,MAX,OC,SN
"RTN","GMTSLROB",5,0)
 I $D(GMTSNDM),(GMTSNDM>0) S MAX=GMTSNDM
"RTN","GMTSLROB",6,0)
 E  S MAX=999
"RTN","GMTSLROB",7,0)
 D ^GMTSLROE
"RTN","GMTSLROB",8,0)
 I '$D(^TMP("LRO",$J)) Q
"RTN","GMTSLROB",9,0)
 D WRTHDR
"RTN","GMTSLROB",10,0)
 S (ICD,OC)=0 F  S ICD=$O(^TMP("LRO",$J,ICD)) Q:'ICD!(OC'<MAX)  S SN=0 F  S SN=$O(^TMP("LRO",$J,ICD,SN)) Q:'SN!(OC'<MAX)  D GET
"RTN","GMTSLROB",11,0)
 K ^TMP("LRO",$J)
"RTN","GMTSLROB",12,0)
 Q
"RTN","GMTSLROB",13,0)
GET ; Get Data
"RTN","GMTSLROB",14,0)
 S GMX=^TMP("LRO",$J,ICD,SN),OC=OC+1 I ICD>GMTS1,(ICD'>GMTS2) D WRT
"RTN","GMTSLROB",15,0)
 Q
"RTN","GMTSLROB",16,0)
WRTHDR ; Prints Header
"RTN","GMTSLROB",17,0)
 D CKP^GMTSUP Q:$D(GMTSQIT)  W "Collection DT",?18,"Test Name",?39,"Specimen",?51,"Urgency",?68,"Status",!
"RTN","GMTSLROB",18,0)
 W:'$D(GMTSOBJ) !
"RTN","GMTSLROB",19,0)
 Q
"RTN","GMTSLROB",20,0)
WRT ; Writes Component
"RTN","GMTSLROB",21,0)
 D CKP^GMTSUP Q:$D(GMTSQIT)  D:GMTSNPG WRTHDR W $P(GMX,U),?18,$P($P(GMX,U,2),";",2),?39,$E($P($P(GMX,U,3),";",2),1,10),?51,$P(GMX,U,4),?68,$P(GMX,U,5),!
"RTN","GMTSLROB",22,0)
 Q
"RTN","GMTSLRS")
0^13^B7319960
"RTN","GMTSLRS",1,0)
GMTSLRS ; SLC/JER,KER - Sel Lab Component w/Selection Items ; 01/06/2003
"RTN","GMTSLRS",2,0)
 ;;2.7;Health Summary;**16,28,47,58**;Oct 20, 1995
"RTN","GMTSLRS",3,0)
 ;
"RTN","GMTSLRS",4,0)
 ; External References
"RTN","GMTSLRS",5,0)
 ;    DBIA    67  ^LAB(60
"RTN","GMTSLRS",6,0)
 ;    DBIA   525  ^LR( all fields
"RTN","GMTSLRS",7,0)
 ;    DBIA 10035  ^DPT( field 63 Read w/Fileman
"RTN","GMTSLRS",8,0)
 ;    DBIA  2056  $$GET1^DIQ (file 2)
"RTN","GMTSLRS",9,0)
 ;                       
"RTN","GMTSLRS",10,0)
MAIN ; Selected Lab w/Selection Items
"RTN","GMTSLRS",11,0)
 N GMTSI,GMW,GMX,LRDFN,MAX,IT,IX,PTEST,TEST,BEGIN,END,CNT,RWIDTH,GMLINE,GMCMNT,GMCFLAG
"RTN","GMTSLRS",12,0)
 S RWIDTH=8,LRDFN=+($$GET1^DIQ(2,(+($G(DFN))_","),63,"I")) Q:+LRDFN=0  Q:'$D(^LR(LRDFN))
"RTN","GMTSLRS",13,0)
 S MAX=$S(+($G(GMTSNDM))>0:+($G(GMTSNDM)),1:999) Q:'$O(GMTSEG(GMTSEGN,60,0))
"RTN","GMTSLRS",14,0)
 S GMCMNT=$S($P($G(^GMT(142.99,1,0)),U,3)="Y":1,1:0)
"RTN","GMTSLRS",15,0)
 S GMTSI=0 F  S GMTSI=$O(GMTSEG(GMTSEGN,60,GMTSI)) Q:GMTSI'>0  D  Q:$D(GMTSQIT)
"RTN","GMTSLRS",16,0)
 . S (PTEST,TEST)=GMTSEG(GMTSEGN,60,GMTSI)
"RTN","GMTSLRS",17,0)
 . D @$S($L($P(^LAB(60,TEST,0),U,5)):"^GMTSLRSE",1:"PANEL")
"RTN","GMTSLRS",18,0)
 Q:'$D(^TMP("LRS",$J))  D WRTHDR Q:$D(GMTSQIT)
"RTN","GMTSLRS",19,0)
 S IT=0 F  S IT=$O(^TMP("LRS",$J,IT)) Q:+IT'>0  D  Q:$D(GMTSQIT)
"RTN","GMTSLRS",20,0)
 . S IX="" F  S IX=$O(^TMP("LRS",$J,IT,IX)) Q:'IX!(IX>GMTS2)  D  Q:$D(GMTSQIT)
"RTN","GMTSLRS",21,0)
 . . S GMX=^TMP("LRS",$J,IT,IX) D WRT
"RTN","GMTSLRS",22,0)
 I +$G(GMCFLAG) D
"RTN","GMTSLRS",23,0)
 . D CKP^GMTSUP Q:$D(GMTSQIT)  W !
"RTN","GMTSLRS",24,0)
 . D CKP^GMTSUP Q:$D(GMTSQIT)
"RTN","GMTSLRS",25,0)
 . W "!!  Indicates COMMENTS AVAILABLE...Refer to Interim Lab Report.",!
"RTN","GMTSLRS",26,0)
 K ^TMP("LRS",$J)
"RTN","GMTSLRS",27,0)
 Q
"RTN","GMTSLRS",28,0)
PANEL ; Visits "PANEL" multiple to get pointers to atomic tests
"RTN","GMTSLRS",29,0)
 N TEST,GMW,INDX
"RTN","GMTSLRS",30,0)
 S INDX=0 F  S INDX=$O(^LAB(60,PTEST,2,INDX)) Q:'INDX  S TEST=^(INDX,0) S:'$L($P(^LAB(60,TEST,0),U,5)) PTEST=TEST D @$S($L($P(^LAB(60,TEST,0),U,5)):"^GMTSLRSE",1:"PANEL")
"RTN","GMTSLRS",31,0)
 Q
"RTN","GMTSLRS",32,0)
WRTHDR ; Prints columnar header
"RTN","GMTSLRS",33,0)
 D CKP^GMTSUP Q:$D(GMTSQIT)  W "Collection DT",?18,"Specimen"
"RTN","GMTSLRS",34,0)
 W ?29,"Test Name",?48,"Result",?58,"Units",?68,"Ref Range",!
"RTN","GMTSLRS",35,0)
 W:'$D(GMTSOBJ) !
"RTN","GMTSLRS",36,0)
 Q
"RTN","GMTSLRS",37,0)
WRT ; Writes the Lab Record
"RTN","GMTSLRS",38,0)
 D CKP^GMTSUP Q:$D(GMTSQIT)  D
"RTN","GMTSLRS",39,0)
 . D:GMTSNPG WRTHDR N GMTSI
"RTN","GMTSLRS",40,0)
 . W $P(GMX,U),?18,$P($P(GMX,U,2),";",2)
"RTN","GMTSLRS",41,0)
 . I $D(^TMP("LRS",$J,"C",IX))>9,'+$G(GMCMNT) W ?24,"!! " S GMCFLAG=1
"RTN","GMTSLRS",42,0)
 . S GMTSI=$P(GMX,U,8) S:GMTSI="NEGATIVE" GMTSI="NEG"
"RTN","GMTSLRS",43,0)
 . W ?29,$E($P($P(GMX,U,3),";",2),1,17),?46,$P(GMX,U,4)," ",$P(GMX,U,5)
"RTN","GMTSLRS",44,0)
 . W ?58,$P(GMX,U,6),?68,$J($P(GMX,U,7),4),?73,"-",?74,$J(GMTSI,4),!
"RTN","GMTSLRS",45,0)
 I +$G(GMCMNT),$D(^TMP("LRS",$J,"C",IX))>9,'$D(^TMP("LRS",$J,+$O(^TMP("LRS",$J,IT)),IX)) D  Q
"RTN","GMTSLRS",46,0)
 . S GMLINE=0
"RTN","GMTSLRS",47,0)
 . F  S GMLINE=$O(^TMP("LRS",$J,"C",IX,GMLINE)) Q:GMLINE'>0  D
"RTN","GMTSLRS",48,0)
 . . D CKP^GMTSUP Q:$D(GMTSQIT)
"RTN","GMTSLRS",49,0)
 . . W "Comment: ",^TMP("LRS",$J,"C",IX,GMLINE),!
"RTN","GMTSLRS",50,0)
 Q
"RTN","GMTSLRS7")
0^14^B12140512
"RTN","GMTSLRS7",1,0)
GMTSLRS7 ; SLC/JER,KER - Sel Cum Lab Comp w/Sel Items ; 01/06/2003
"RTN","GMTSLRS7",2,0)
 ;;2.7;Health Summary;**28,47,58**;Oct 20, 1995
"RTN","GMTSLRS7",3,0)
 ;
"RTN","GMTSLRS7",4,0)
 ; External References
"RTN","GMTSLRS7",5,0)
 ;    DBIA    67  ^LAB(60
"RTN","GMTSLRS7",6,0)
 ;    DBIA   525  ^LR( all fields
"RTN","GMTSLRS7",7,0)
 ;    DBIA 10035  ^DPT( field 63 Read w/Fileman
"RTN","GMTSLRS7",8,0)
 ;    DBIA  2056  $$GET1^DIQ (file 2)
"RTN","GMTSLRS7",9,0)
 ;                        
"RTN","GMTSLRS7",10,0)
MAIN ; Selected Cumulative Lab w/Selection Items
"RTN","GMTSLRS7",11,0)
 N GMTSI,GMW,HDR,LRDFN,MAX,TEST,RWIDTH,GMCMNT,COMMNBR,GMCOM,TAB
"RTN","GMTSLRS7",12,0)
 S LRDFN=+($$GET1^DIQ(2,(+($G(DFN))_","),63,"I")) Q:+LRDFN=0  Q:'$D(^LR(LRDFN))
"RTN","GMTSLRS7",13,0)
 S MAX=$S(+($G(GMTSNDM))>0:+($G(GMTSNDM)),1:999) Q:'$O(GMTSEG(GMTSEGN,60,0))
"RTN","GMTSLRS7",14,0)
 S RWIDTH=4,GMTSI=0 F  S GMTSI=$O(GMTSEG(GMTSEGN,60,GMTSI)) Q:GMTSI'>0  D  Q:$D(GMTSQIT)
"RTN","GMTSLRS7",15,0)
 . S TEST=GMTSEG(GMTSEGN,60,GMTSI) D ^GMTSLRSE
"RTN","GMTSLRS7",16,0)
 Q:'$D(^TMP("LRS",$J))  S GMCMNT=$S($P($G(^GMT(142.99,1,0)),U,3)="Y":1,1:0),COMMNBR=0
"RTN","GMTSLRS7",17,0)
 D DISPLAY I GMCMNT,'$D(GMTSQIT) D WRTCOMM
"RTN","GMTSLRS7",18,0)
 K ^TMP("LRS",$J),^TMP("LRSR",$J)
"RTN","GMTSLRS7",19,0)
 Q
"RTN","GMTSLRS7",20,0)
DISPLAY ; Displays up to 7 tests across page
"RTN","GMTSLRS7",21,0)
 N HDR,TST,GMI,GMX,GMW,IT,IX D INVRT S IT=""
"RTN","GMTSLRS7",22,0)
 F GMI=0:1:6 S IT=$O(^TMP("LRS",$J,IT)) Q:'IT  D  Q:$D(GMTSQIT)
"RTN","GMTSLRS7",23,0)
 . S IX="" F  S IX=$O(^(IT,IX)) Q:IX'>0  D  Q:$D(GMTSQIT)
"RTN","GMTSLRS7",24,0)
 . . S TST=+$P(^(IX),U,3)
"RTN","GMTSLRS7",25,0)
 . . S HDR(GMI)=$S(TST'="":$E($P($G(^LAB(60,TST,.1)),U),1,7),1:"")
"RTN","GMTSLRS7",26,0)
 . . K ^TMP("LRS",$J,IT)
"RTN","GMTSLRS7",27,0)
 Q:$D(GMTSQIT)  D WRTHDR S IX=""
"RTN","GMTSLRS7",28,0)
 F GMW=1:1:MAX S IX=$O(^TMP("LRSR",$J,IX)) Q:+IX'>0  D  Q:$D(GMTSQIT)
"RTN","GMTSLRS7",29,0)
 . D CKP^GMTSUP Q:$D(GMTSQIT)  D:GMTSNPG WRTHDR
"RTN","GMTSLRS7",30,0)
 . S IT="" F GMI=0:1:6 S IT=$O(^TMP("LRSR",$J,IX,IT)) Q:IT=""  D  Q:$D(GMTSQIT)
"RTN","GMTSLRS7",31,0)
 . . D WRT I '$O(^TMP("LRSR",$J,IX,IT)) W !
"RTN","GMTSLRS7",32,0)
 Q:$D(GMTSQIT)
"RTN","GMTSLRS7",33,0)
 I '$D(GMTSOBJ),(+$G(GMW)=+$G(MAX)),(+IX>0),$O(^TMP("LRSR",$J,IX)) D  Q:$D(GMTSQIT)
"RTN","GMTSLRS7",34,0)
 . D CKP^GMTSUP Q:$D(GMTSQIT)
"RTN","GMTSLRS7",35,0)
 . W $C(7),!?10,"** Additional Results available outside occurrence limit **",!
"RTN","GMTSLRS7",36,0)
 Q
"RTN","GMTSLRS7",37,0)
WRTHDR ; Writes Column Header
"RTN","GMTSLRS7",38,0)
 N GMI D CKP^GMTSUP Q:$D(GMTSQIT)  W "Collection DT"
"RTN","GMTSLRS7",39,0)
 W ?19,$S(+$G(GMCMNT):" ",1:""),"Spec"
"RTN","GMTSLRS7",40,0)
 F GMI=0:1:6 D  Q:$D(GMTSQIT)
"RTN","GMTSLRS7",41,0)
 . D CKP^GMTSUP Q:'$D(HDR(GMI))!($D(GMTSQIT))
"RTN","GMTSLRS7",42,0)
 . W ?(((8*GMI+25)+(7-$L(HDR(GMI))\2))),$E(HDR(GMI),1,7)
"RTN","GMTSLRS7",43,0)
 Q:$D(GMTSQIT)  D CKP^GMTSUP Q:$D(GMTSQIT)  W !
"RTN","GMTSLRS7",44,0)
 I '$D(GMTSOBJ) D CKP^GMTSUP Q:$D(GMTSQIT)  W !
"RTN","GMTSLRS7",45,0)
 Q
"RTN","GMTSLRS7",46,0)
WRT ; Writes the Lab Record
"RTN","GMTSLRS7",47,0)
 S GMX=^TMP("LRSR",$J,IX,IT),TAB=$P(GMX,U)
"RTN","GMTSLRS7",48,0)
 I GMI=0!(GMTSNPG) D
"RTN","GMTSLRS7",49,0)
 . I +$G(GMCMNT),$D(^TMP("LRS",$J,"C",IX))>0,$D(GMCOM("DT",IX))'>0,COMMNBR<26 D
"RTN","GMTSLRS7",50,0)
 . . S GMLTR=$C(97+COMMNBR) S COMMNBR=COMMNBR+1
"RTN","GMTSLRS7",51,0)
 . . S GMCOM("DT",IX)=GMLTR,GMCOM("LTR",GMLTR)=IX
"RTN","GMTSLRS7",52,0)
 . I +$G(GMCMNT) W $E($G(GMCOM("DT",IX)),1),?2,$P(GMX,U,2),?19,$E($P($P(GMX,U,3),";",2),1,5) Q
"RTN","GMTSLRS7",53,0)
 . W $P(GMX,U,2),?19,$E($P($P(GMX,U,3),";",2),1,5)
"RTN","GMTSLRS7",54,0)
 W ?(8*TAB+25),$P(GMX,U,4)," ",$P(GMX,U,5)
"RTN","GMTSLRS7",55,0)
 Q
"RTN","GMTSLRS7",56,0)
WRTCOMM ; Writes the lab Comments
"RTN","GMTSLRS7",57,0)
 N GMLTR,GMLINE
"RTN","GMTSLRS7",58,0)
 Q:$D(GMCOM)'>0
"RTN","GMTSLRS7",59,0)
 D CKP^GMTSUP Q:$D(GMTSQIT)  W "COMMENTS:",!
"RTN","GMTSLRS7",60,0)
 S GMLTR=""
"RTN","GMTSLRS7",61,0)
 F  S GMLTR=$O(GMCOM("LTR",GMLTR)) Q:GMLTR']""  D  Q:$D(GMTSQIT)
"RTN","GMTSLRS7",62,0)
 . S IX=$G(GMCOM("LTR",GMLTR)),GMLINE=0
"RTN","GMTSLRS7",63,0)
 . F  S GMLINE=$O(^TMP("LRS",$J,"C",+IX,GMLINE)) Q:GMLINE'>0  D  Q:$D(GMTSQIT)
"RTN","GMTSLRS7",64,0)
 . . D CKP^GMTSUP Q:$D(GMTSQIT)  I GMTSNPG W "COMMENTS:",!
"RTN","GMTSLRS7",65,0)
 . . W:GMLINE=1!GMTSNPG GMLTR_"."
"RTN","GMTSLRS7",66,0)
 . . W ?3,$G(^TMP("LRS",$J,"C",+IX,GMLINE)),!
"RTN","GMTSLRS7",67,0)
 Q
"RTN","GMTSLRS7",68,0)
 ;                   
"RTN","GMTSLRS7",69,0)
INVRT ; Inverts Global Array
"RTN","GMTSLRS7",70,0)
 ;                     
"RTN","GMTSLRS7",71,0)
 ; From: ^TMP("LRS",$J,IT,IX)=CDT^SPC^TNM^RSLT^FLAG^UNIT^LO^HI
"RTN","GMTSLRS7",72,0)
 ; To:   ^TMP("LRSR",$J,IX,IT)=GMI,CDT,SPC,RSLT,FLAG
"RTN","GMTSLRS7",73,0)
 ;
"RTN","GMTSLRS7",74,0)
 N GMI,GMW,IT,IX S IT=""
"RTN","GMTSLRS7",75,0)
 F GMI=0:1:6 S IT=$O(^TMP("LRS",$J,IT)) Q:IT'>0  S IX="" F  S IX=$O(^TMP("LRS",$J,IT,IX)) Q:IX=""  S ^TMP("LRSR",$J,IX,IT)=GMI_U_$P(^TMP("LRS",$J,IT,IX),U,1,2)_U_$P(^TMP("LRS",$J,IT,IX),U,4,5)
"RTN","GMTSLRS7",76,0)
 Q
"RTN","GMTSLRSC")
0^15^B12199123
"RTN","GMTSLRSC",1,0)
GMTSLRSC ; SLC/JER,KER - Sel Cum Lab Comp w/Sel Items ; 01/06/2003
"RTN","GMTSLRSC",2,0)
 ;;2.7;Health Summary;**28,47,58**;Oct 20, 1995
"RTN","GMTSLRSC",3,0)
 ;
"RTN","GMTSLRSC",4,0)
 ; External References
"RTN","GMTSLRSC",5,0)
 ;    DBIA 10035  ^DPT(
"RTN","GMTSLRSC",6,0)
 ;    DBIA    67  ^LAB(60
"RTN","GMTSLRSC",7,0)
 ;    DBIA   525  ^LR(
"RTN","GMTSLRSC",8,0)
 ;                           
"RTN","GMTSLRSC",9,0)
MAIN ; Selected Cumulative Lab w/Selection Items
"RTN","GMTSLRSC",10,0)
 N GMTSI,LRDFN,MAX,TEST,RWIDTH,GMCMNT,COMMNBR,GMCOM,TAB
"RTN","GMTSLRSC",11,0)
 S MAX=$S(+($G(GMTSNDM))>0:+($G(GMTSNDM)),1:999) Q:'$D(^DPT(DFN,"LR"))
"RTN","GMTSLRSC",12,0)
 Q:'$D(^DPT(DFN,"LR"))  S LRDFN=+^DPT(DFN,"LR") Q:'$D(^LR(LRDFN))  Q:'$O(GMTSEG(GMTSEGN,60,0))
"RTN","GMTSLRSC",13,0)
 S RWIDTH=4,GMTSI=0 F  S GMTSI=$O(GMTSEG(GMTSEGN,60,GMTSI)) Q:GMTSI'>0  D  Q:$D(GMTSQIT)
"RTN","GMTSLRSC",14,0)
 . S TEST=GMTSEG(GMTSEGN,60,GMTSI) D ^GMTSLRSE
"RTN","GMTSLRSC",15,0)
 Q:'$D(^TMP("LRS",$J))  S GMCMNT=$S($P($G(^GMT(142.99,1,0)),U,3)="Y":1,1:0),COMMNBR=0
"RTN","GMTSLRSC",16,0)
 F  D DISPLAY Q:$O(^TMP("LRS",$J,0))'>0  Q:$D(GMTSQIT)
"RTN","GMTSLRSC",17,0)
 I GMCMNT,'$D(GMTSQIT) D WRTCOMM
"RTN","GMTSLRSC",18,0)
 K ^TMP("LRS",$J),^TMP("LRSR",$J)
"RTN","GMTSLRSC",19,0)
 Q
"RTN","GMTSLRSC",20,0)
DISPLAY ; Displays up to 7 tests across page
"RTN","GMTSLRSC",21,0)
 N GMC,GMN,GMI,GMW,GMX,HDR,TST,IT,IX,MORE,RES
"RTN","GMTSLRSC",22,0)
 D INVRT Q:$D(GMTSQIT)  S IT="" F GMI=0:1:6 S IT=$O(^TMP("LRS",$J,IT)) Q:'IT  D
"RTN","GMTSLRSC",23,0)
 . S IX="" F  S IX=$O(^(IT,IX)) Q:IX'>0  D
"RTN","GMTSLRSC",24,0)
 . . S TST=+$P(^(IX),U,3),HDR(GMI)=$S(TST'="":$E($P($G(^LAB(60,TST,.1)),U),1,7),1:"")
"RTN","GMTSLRSC",25,0)
 . . K ^TMP("LRS",$J,IT)
"RTN","GMTSLRSC",26,0)
 D WRTHDR S RES=$$RES,MORE=$S(+($G(RES))>+($G(MAX)):1,1:0)
"RTN","GMTSLRSC",27,0)
 S IX="" F GMW=1:1:MAX S IX=$O(^TMP("LRSR",$J,IX)) Q:+IX'>0  D  Q:$D(GMTSQIT)
"RTN","GMTSLRSC",28,0)
 . D CKP^GMTSUP Q:$D(GMTSQIT)  D:GMTSNPG WRTHDR
"RTN","GMTSLRSC",29,0)
 . S IT="" F GMI=0:1 S IT=$O(^TMP("LRSR",$J,IX,IT)) Q:IT=""  D  Q:$D(GMTSQIT)
"RTN","GMTSLRSC",30,0)
 . . D WRT I '$O(^TMP("LRSR",$J,IX,IT)) W !
"RTN","GMTSLRSC",31,0)
 I '$D(GMTSOBJ),+($G(MORE)) D
"RTN","GMTSLRSC",32,0)
 . D CKP^GMTSUP Q:$D(GMTSQIT) 
"RTN","GMTSLRSC",33,0)
 . W $C(7),!?10,"** Additional Results available outside occurrence limit **",!
"RTN","GMTSLRSC",34,0)
 K ^TMP("LRSR",$J) W:$D(^TMP("LRS",$J)) !
"RTN","GMTSLRSC",35,0)
 Q
"RTN","GMTSLRSC",36,0)
WRTHDR ; Writes Column Header
"RTN","GMTSLRSC",37,0)
 N GMI
"RTN","GMTSLRSC",38,0)
 D CKP^GMTSUP Q:$D(GMTSQIT)  W "Collection DT"
"RTN","GMTSLRSC",39,0)
 W ?19,$S(+$G(GMCMNT):" ",1:""),"Spec"
"RTN","GMTSLRSC",40,0)
 F GMI=0:1:6 D CKP^GMTSUP Q:'$D(HDR(GMI))!($D(GMTSQIT))  W ?(((8*GMI+25)+(7-$L(HDR(GMI))\2))),$E(HDR(GMI),1,7)
"RTN","GMTSLRSC",41,0)
 D CKP^GMTSUP Q:$D(GMTSQIT)  W !
"RTN","GMTSLRSC",42,0)
 I '$D(GMTSOBJ) D CKP^GMTSUP Q:$D(GMTSQIT)  W !
"RTN","GMTSLRSC",43,0)
 Q
"RTN","GMTSLRSC",44,0)
WRT ; Writes the Lab Record
"RTN","GMTSLRSC",45,0)
 S GMX=^TMP("LRSR",$J,IX,IT),TAB=$P(GMX,U)
"RTN","GMTSLRSC",46,0)
 I GMI=0!(GMTSNPG) D
"RTN","GMTSLRSC",47,0)
 . I +$G(GMCMNT),$D(^TMP("LRS",$J,"C",IX))>0,$D(GMCOM("DT",IX))'>0,COMMNBR<26 D
"RTN","GMTSLRSC",48,0)
 . . S GMLTR=$C(97+COMMNBR) S COMMNBR=COMMNBR+1
"RTN","GMTSLRSC",49,0)
 . . S GMCOM("DT",IX)=GMLTR,GMCOM("LTR",GMLTR)=IX
"RTN","GMTSLRSC",50,0)
 . I +$G(GMCMNT) D  Q
"RTN","GMTSLRSC",51,0)
 . . W $E($G(GMCOM("DT",IX)),1),?2,$P(GMX,U,2),?19,$E($P($P(GMX,U,3),";",2),1,5)
"RTN","GMTSLRSC",52,0)
 . W $P(GMX,U,2),?19,$E($P($P(GMX,U,3),";",2),1,5)
"RTN","GMTSLRSC",53,0)
 W ?(8*TAB+25),$P(GMX,U,4)," ",$P(GMX,U,5)
"RTN","GMTSLRSC",54,0)
 Q
"RTN","GMTSLRSC",55,0)
WRTCOMM ; Writes the lab Comments
"RTN","GMTSLRSC",56,0)
 N GMLTR,GMLINE
"RTN","GMTSLRSC",57,0)
 Q:$D(GMCOM)'>0
"RTN","GMTSLRSC",58,0)
 D CKP^GMTSUP Q:$D(GMTSQIT)  W "COMMENTS:",!
"RTN","GMTSLRSC",59,0)
 S GMLTR=""
"RTN","GMTSLRSC",60,0)
 F  S GMLTR=$O(GMCOM("LTR",GMLTR)) Q:GMLTR']""  D  Q:$D(GMTSQIT)
"RTN","GMTSLRSC",61,0)
 . S IX=$G(GMCOM("LTR",GMLTR)),GMLINE=0
"RTN","GMTSLRSC",62,0)
 . F  S GMLINE=$O(^TMP("LRS",$J,"C",+IX,GMLINE)) Q:GMLINE'>0  D  Q:$D(GMTSQIT)
"RTN","GMTSLRSC",63,0)
 . . D CKP^GMTSUP Q:$D(GMTSQIT)  I GMTSNPG W "COMMENTS:",!
"RTN","GMTSLRSC",64,0)
 . . W:GMLINE=1!GMTSNPG GMLTR_"."
"RTN","GMTSLRSC",65,0)
 . . W ?3,$G(^TMP("LRS",$J,"C",+IX,GMLINE)),!
"RTN","GMTSLRSC",66,0)
 Q
"RTN","GMTSLRSC",67,0)
 ;                     
"RTN","GMTSLRSC",68,0)
RES(X) ; Results
"RTN","GMTSLRSC",69,0)
 N NN,NC S X=0,NN="^TMP(""LRSR"","_$J_")",NC="^TMP(""LRSR"","_$J_","
"RTN","GMTSLRSC",70,0)
 F  S NN=$Q(@NN) Q:NN=""!(NN'[NC)  S X=X+1
"RTN","GMTSLRSC",71,0)
 Q X
"RTN","GMTSLRSC",72,0)
INVRT ; Inverts Global Array
"RTN","GMTSLRSC",73,0)
 ;                     
"RTN","GMTSLRSC",74,0)
 ;  From: ^TMP("LRS",$J,IT,IX)=CDT^SPC^TNM^RSLT^FLAG^UNIT^LO^HI
"RTN","GMTSLRSC",75,0)
 ;  To:   ^TMP("LRSR",$J,IX,IT)=GMI,CDT,SPC,RSLT,FLAG
"RTN","GMTSLRSC",76,0)
 ;
"RTN","GMTSLRSC",77,0)
 N GMI,IT,IX
"RTN","GMTSLRSC",78,0)
 S IT=""
"RTN","GMTSLRSC",79,0)
 F GMI=0:1:6 S IT=$O(^TMP("LRS",$J,IT)) Q:IT'>0  D
"RTN","GMTSLRSC",80,0)
 . S IX="" F  S IX=$O(^TMP("LRS",$J,IT,IX)) Q:IX=""  D
"RTN","GMTSLRSC",81,0)
 . . S ^TMP("LRSR",$J,IX,IT)=GMI_U_$P(^TMP("LRS",$J,IT,IX),U,1,2)_U_$P(^TMP("LRS",$J,IT,IX),U,4,5)
"RTN","GMTSLRSC",82,0)
 Q
"RTN","GMTSLRTE")
0^25^B2162840
"RTN","GMTSLRTE",1,0)
GMTSLRTE ; SLC/JER,KER - Transfusion Record Extract Routine ; 01/06/2003
"RTN","GMTSLRTE",2,0)
 ;;2.7;Health Summary;**56,58**;Oct 20, 1995
"RTN","GMTSLRTE",3,0)
 ;                     
"RTN","GMTSLRTE",4,0)
 ; External References
"RTN","GMTSLRTE",5,0)
 ;   DBIA 10035  ^DPT(
"RTN","GMTSLRTE",6,0)
 ;   DBIA   528  ^LAB(66
"RTN","GMTSLRTE",7,0)
 ;   DBIA   525  ^LR(
"RTN","GMTSLRTE",8,0)
 ;                     
"RTN","GMTSLRTE",9,0)
XTRCT ; Extract Transfusion Records
"RTN","GMTSLRTE",10,0)
 N LRDFN,IDT,CNTR,TR,PN,PRODUCT
"RTN","GMTSLRTE",11,0)
 S:'$D(GMTS1) GMTS1=6666666 S:'$D(GMTS2) GMTS2=9999999
"RTN","GMTSLRTE",12,0)
 K ^TMP("LRT",$J)
"RTN","GMTSLRTE",13,0)
 Q:'$D(^DPT(DFN,"LR"))  S LRDFN=+^DPT(DFN,"LR"),IDT=GMTS1-1
"RTN","GMTSLRTE",14,0)
 I '$D(^LR(LRDFN)) Q
"RTN","GMTSLRTE",15,0)
 S IDT=GMTS1-1 F  S IDT=$O(^LR(LRDFN,1.6,IDT)) Q:+IDT'>0!(IDT>GMTS2)  D
"RTN","GMTSLRTE",16,0)
 . S TR=$G(^LR(LRDFN,1.6,IDT,0)) D SET
"RTN","GMTSLRTE",17,0)
 S IDT=0 F  S IDT=$O(CNTR(IDT)) Q:+IDT'>0  D
"RTN","GMTSLRTE",18,0)
 . S ^TMP("LRT",$J,IDT)=9999999-IDT_U
"RTN","GMTSLRTE",19,0)
 . S PN=0 F  S PN=$O(CNTR(IDT,PN)) Q:PN'>0  D
"RTN","GMTSLRTE",20,0)
 . . S PRODUCT=$G(^LAB(66,+PN,0)),^TMP("LRT",$J,$P(PRODUCT,U,2))=$P(PRODUCT,U)
"RTN","GMTSLRTE",21,0)
 . . S ^TMP("LRT",$J,IDT)=^TMP("LRT",$J,IDT)_CNTR(IDT,PN)_"\"_$P(PRODUCT,U,2)_";"
"RTN","GMTSLRTE",22,0)
 Q
"RTN","GMTSLRTE",23,0)
SET ; Save Appropriate Data
"RTN","GMTSLRTE",24,0)
 N COMP,UNITS,TDT,ITDT S TDT=9999999-IDT,ITDT=9999999-$P(TDT,".")
"RTN","GMTSLRTE",25,0)
 S UNITS=+$P(TR,U,7) S:UNITS'>0 UNITS=1
"RTN","GMTSLRTE",26,0)
 S CNTR(ITDT,+$P(TR,U,2))=+$G(CNTR(ITDT,+$P(TR,U,2)))+UNITS
"RTN","GMTSLRTE",27,0)
 Q
"RTN","GMTSOBA")
0^1^B37765942
"RTN","GMTSOBA",1,0)
GMTSOBA ; SLC/KER - HS Object - Ask               ; 01/06/2003
"RTN","GMTSOBA",2,0)
 ;;2.7;Health Summary;**58**;Oct 20, 1995
"RTN","GMTSOBA",3,0)
 ;
"RTN","GMTSOBA",4,0)
 ; External References
"RTN","GMTSOBA",5,0)
 ;   DBIA  10018  ^DIE  (file #142.5)
"RTN","GMTSOBA",6,0)
 ;   DBIA  10026  ^DIR        
"RTN","GMTSOBA",7,0)
 ;   DBIA  10103  $$FMTE^XLFDT
"RTN","GMTSOBA",8,0)
 ;   DBIA  10103  $$NOW^XLFDT 
"RTN","GMTSOBA",9,0)
 ;             
"RTN","GMTSOBA",10,0)
OBJ ; Create/Edit Object
"RTN","GMTSOBA",11,0)
 N DA,X,Y,DIE,DR,GMTSED,GMTSCON,GMTSLBL,GMTSLBB,GMTSULB,GMTSHDR
"RTN","GMTSOBA",12,0)
 N GMTSRDT,GMTSCON,GMTSRHD,GMTSNEW,GMTSNEWO,GMTSDES,GMTSCHD,GMTSLIM
"RTN","GMTSOBA",13,0)
 N GMTSBLK,GMTSQ,GMTSDEC,GMTSNOD,GMTSOWN,GMTSDT,GMTSI,GMTSDA,GMTSUND
"RTN","GMTSOBA",14,0)
 N GMTSTIM,GMTSTI,GMTSOI
"RTN","GMTSOBA",15,0)
 S (GMTSHDR,GMTSRDT,GMTSCON,GMTSRHD,GMTSCHD,GMTSUND,GMTSLIM,GMTSULB,GMTSLBB,GMTSBLK,GMTSDEC,GMTSNOD)=0,GMTSOWN="",GMTSDES=1
"RTN","GMTSOBA",16,0)
 S:'$L($G(GMTSNAM)) DA=$$LK^GMTSOBL Q:+($G(GMTSQ))>0
"RTN","GMTSOBA",17,0)
 S:$L($G(GMTSNAM)) DA=$$HSO^GMTSOBL($G(GMTSNAM)) Q:+($G(GMTSQ))>0  Q:+($G(DA))'>0
"RTN","GMTSOBA",18,0)
 S:$L($G(GMTSNAM)) GMTSNEW=+($P($G(DA),"^",3)),DA=+($P($G(DA),"^",1))
"RTN","GMTSOBA",19,0)
 Q:+($G(DA))'>0  S (GMTSDA,GMTSOI)=+($G(DA)),GMTSTI=$P($G(^GMT(142.5,+GMTSOI,0)),"^",3) Q:+GMTSTI'>0
"RTN","GMTSOBA",20,0)
 S GMTSLBL="" K GMTSOBJ  S GMTSCON=1
"RTN","GMTSOBA",21,0)
 I $L($G(GMTSNAM)),+GMTSNEW'>0,+DA>0 D  Q:+($G(GMTSCON))'>0  Q:+($G(GMTSQ))>0
"RTN","GMTSOBA",22,0)
 . N GMTSOWN S GMTSOWN=$P($G(^GMT(142.5,+DA,0)),"^",17)
"RTN","GMTSOBA",23,0)
 . I +GMTSOWN>0,+($G(DUZ))>0,+GMTSOWN'=+($G(DUZ)) S GMTSCON=0 Q
"RTN","GMTSOBA",24,0)
 . W !," Object '",GMTSNAM,"' already exist" S GMTSCON=$$CONT Q:+($G(GMTSCON))'>0
"RTN","GMTSOBA",25,0)
 . N X,Y,DIR,DIE,DR,GMTSDEF,GMTSDICA,GMTSNAM,GMTSTYPE
"RTN","GMTSOBA",26,0)
 . W ! S GMTSDEF=+($P($G(^GMT(142.5,+($G(DA)),0)),"^",3))
"RTN","GMTSOBA",27,0)
 . S GMTSDEF=$S(+GMTSDEF>0:+GMTSDEF,1:"")
"RTN","GMTSOBA",28,0)
 . S GMTSDICA=" Enter/Edit HEALTH SUMMARY TYPE:  "
"RTN","GMTSOBA",29,0)
 . K DTOUT,DUOUT,DIRUT,DIROUT
"RTN","GMTSOBA",30,0)
 . S GMTSTYPE=$$TY^GMTSOBL(GMTSDEF)
"RTN","GMTSOBA",31,0)
 . I $D(DTOUT)!($D(DUOUT))!($D(DIRUT))!($D(DIROUT)) S GMTSQ=1 Q
"RTN","GMTSOBA",32,0)
 . S DR=".03////^S X=$G(GMTSTYPE)"
"RTN","GMTSOBA",33,0)
 . S DIE="^GMT(142.5,",DA=+($G(DA)) S GMTSED=0
"RTN","GMTSOBA",34,0)
 . F GMTSI=1:1:3 Q:GMTSI>3  L +^GMT(142.5,+($G(DA))):0 H:'$T 1 I $T D
"RTN","GMTSOBA",35,0)
 . . D ^DIE S GMTSED=1 S $P(^GMT(142.5,+DA,0),U,19)=$$NOW^XLFDT,GMTSI=4
"RTN","GMTSOBA",36,0)
 . . S:+($G(DUZ))>0 $P(^GMT(142.5,+DA,0),"^",17)=+($G(DUZ))
"RTN","GMTSOBA",37,0)
 . I 'GMTSED S GMTSQ=1 K GMTSOBJ W !,"  Record Locked by another user" Q
"RTN","GMTSOBA",38,0)
 . L -^GMT(142.5,+($G(DA))) S GMTST=+($P($G(^GMT(142.5,+DA,0)),U,3))
"RTN","GMTSOBA",39,0)
 K:+($G(GMTSQ))>0 GMTSOBJ Q:+($G(GMTSQ))>0
"RTN","GMTSOBA",40,0)
 D ALL K:+($G(GMTSQ))>0 GMTSOBJ S:+($G(GMTSQ))>0 GMTSDES=0 Q:+($G(GMTSQ))>0  N DIE,DR
"RTN","GMTSOBA",41,0)
 S GMTSHDR=+($G(GMTSOBJ("HEADER")))
"RTN","GMTSOBA",42,0)
 S GMTSLBL=$G(GMTSLBL) I GMTSHDR>0 D
"RTN","GMTSOBA",43,0)
 . S GMTSRDT=$S($D(GMTSOBJ("DATE LINE")):1,1:0)
"RTN","GMTSOBA",44,0)
 . S GMTSCON=$S($D(GMTSOBJ("CONFIDENTIAL")):1,1:0)
"RTN","GMTSOBA",45,0)
 . S GMTSRHD=$S($D(GMTSOBJ("REPORT HEADER")):1,1:0)
"RTN","GMTSOBA",46,0)
 . S GMTSCHD=$S($D(GMTSOBJ("COMPONENT HEADER")):1,1:0)
"RTN","GMTSOBA",47,0)
 . S GMTSUND=$S($D(GMTSOBJ("UNDERLINE")):1,1:0)
"RTN","GMTSOBA",48,0)
 . S GMTSLIM=$S($D(GMTSOBJ("LIMITS")):1,1:0)
"RTN","GMTSOBA",49,0)
 . S GMTSBLK=$S($D(GMTSOBJ("BLANK LINE")):1,1:0)
"RTN","GMTSOBA",50,0)
 . S GMTSDEC=$S($D(GMTSOBJ("DECEASED")):1,1:0)
"RTN","GMTSOBA",51,0)
 . S GMTSULB=$S($D(GMTSOBJ("USE LABEL")):1,1:0)
"RTN","GMTSOBA",52,0)
 . S GMTSLBB=$S($D(GMTSOBJ("LABEL BLANK LINE")):1,1:0)
"RTN","GMTSOBA",53,0)
 I GMTSHDR'>0 S (GMTSRDT,GMTSCON,GMTSRHD,GMTSCHD,GMTSUND,GMTSLIM,GMTSBLK,GMTSDEC,GMTSULB,GMTSLBB)=0,GMTSLBL=""
"RTN","GMTSOBA",54,0)
 S GMTSNOD=$S($D(GMTSOBJ("SUPPRESS COMPONENTS")):1,1:0)
"RTN","GMTSOBA",55,0)
 S:+GMTSCHD'>0 (GMTSLIM,GMTSBLK)=0
"RTN","GMTSOBA",56,0)
 S:'$L($G(GMTSLBL)) GMTSLBL="@",(GMTSULB,GMTSLBB)=0
"RTN","GMTSOBA",57,0)
 N DR S DR=".02////^S X=$G(GMTSLBL);"
"RTN","GMTSOBA",58,0)
 S:$L($G(GMTSTIM))&($G(GMTSTIM)'="@") DR=DR_".04////^S X=$G(GMTSTIM);"
"RTN","GMTSOBA",59,0)
 S DR=DR_".05////^S X=$G(GMTSNOD);",DR=DR_".06////^S X=$G(GMTSHDR);"
"RTN","GMTSOBA",60,0)
 S DR=DR_".07////^S X=$G(GMTSULB);",DR=DR_".08////^S X=$G(GMTSLBB);"
"RTN","GMTSOBA",61,0)
 S DR=DR_".09////^S X=$G(GMTSRDT);",DR=DR_".1////^S X=$G(GMTSCON);"
"RTN","GMTSOBA",62,0)
 S DR=DR_".11////^S X=$G(GMTSRHD);",DR=DR_".12////^S X=$G(GMTSCHD);"
"RTN","GMTSOBA",63,0)
 S DR=DR_".13////^S X=$G(GMTSUND);",DR=DR_".14////^S X=$G(GMTSLIM);"
"RTN","GMTSOBA",64,0)
 S DR=DR_".15////^S X=$G(GMTSBLK);",DR=DR_".16////^S X=$G(GMTSDEC);"
"RTN","GMTSOBA",65,0)
 S:+($G(GMTSDES))>0 DR=DR_"1" S:$E(DR,1)=";" DR=$E(DR,2,$L(DR)) S:$E(DR,$L(DR))=";" DR=$E(DR,1,($L(DR)-1))
"RTN","GMTSOBA",66,0)
 S DIE="^GMT(142.5,",DA=+($G(DA)) S GMTSED=0 W:+($G(GMTSDES))>0 !
"RTN","GMTSOBA",67,0)
 F GMTSI=1:1:3 Q:GMTSI>3  L +^GMT(142.5,+($G(DA))):0 H:'$T 1 I $T D
"RTN","GMTSOBA",68,0)
 . D ^DIE S GMTSED=1 S $P(^GMT(142.5,+DA,0),U,19)=$$NOW^XLFDT,GMTSI=4
"RTN","GMTSOBA",69,0)
 . S:$G(GMTSTIM)="@" $P(^GMT(142.5,+DA,0),U,4)=""
"RTN","GMTSOBA",70,0)
 I 'GMTSED S GMTSQ=1 K GMTSOBJ W !,"  Record Locked by another user" Q
"RTN","GMTSOBA",71,0)
 L -^GMT(142.5,+($G(DA))) S GMTST=+($P($G(^GMT(142.5,+DA,0)),U,3))
"RTN","GMTSOBA",72,0)
 K GMTSOBJ Q
"RTN","GMTSOBA",73,0)
 ;          
"RTN","GMTSOBA",74,0)
ALL ; Print HS Header
"RTN","GMTSOBA",75,0)
 N X,Y,DIR,DIROUT,DUOUT,DTOUT S GMTSOBJ="",GMTSQ=0 D RP Q:+($G(GMTSQ))>0
"RTN","GMTSOBA",76,0)
 S DIR("A")=" Print standard Health Summary Header with the Object?  "
"RTN","GMTSOBA",77,0)
 S DIR("B")="N",DIR(0)="YAO",(DIR("?"),DIR("??"))="^D ALL^GMTSOBH"
"RTN","GMTSOBA",78,0)
 W ! D ^DIR S:$D(DIROUT)!($D(DTOUT)) GMTSQ=1
"RTN","GMTSOBA",79,0)
 S:Y["^"!(X["^") GMTSE=1,GMTSQ=1,GMTSDES=0
"RTN","GMTSOBA",80,0)
 K:+($G(GMTSQ))>0!($D(DUOUT)) GMTSOBJ Q:+($G(GMTSQ))>0!($D(DUOUT))
"RTN","GMTSOBA",81,0)
 S X=+($G(Y)) K:+X>0 GMTSOBJ S:+X'>0 GMTSOBJ=""
"RTN","GMTSOBA",82,0)
 S GMTSOBJ("HEADER")=$S(+X'>0:1,1:0)
"RTN","GMTSOBA",83,0)
 I +X'>0 D
"RTN","GMTSOBA",84,0)
 . W ! D PART Q:+($G(GMTSQ))>1  W ! S GMTSLBL="" D LBL^GMTSOBA2
"RTN","GMTSOBA",85,0)
 . S GMTSLBL=$S($L($G(GMTSOBJ("LABEL"))):$G(GMTSOBJ("LABEL")),1:"@")
"RTN","GMTSOBA",86,0)
 . K:'$L($G(GMTSOBJ("LABEL"))) GMTSLBL,GMTSOBJ("LABEL BLANK LINE"),GMTSOBJ("USE LABEL")
"RTN","GMTSOBA",87,0)
 W ! D SC^GMTSOBA2 K:+($G(GMTSQ))>0 GMTSOBJ
"RTN","GMTSOBA",88,0)
 Q
"RTN","GMTSOBA",89,0)
 ;          
"RTN","GMTSOBA",90,0)
RP ; Report Period
"RTN","GMTSOBA",91,0)
 Q:+($G(GMTSQ))>0  N X,Y,DIR,DIROUT,DUOUT,DTOUT,GMTSDEF
"RTN","GMTSOBA",92,0)
 S GMTSTIM=$$RP^GMTSOBT($G(GMTSTI),$G(GMTSOI)) S:+GMTSTIM<0 GMTSQ=1
"RTN","GMTSOBA",93,0)
 Q
"RTN","GMTSOBA",94,0)
 ;                  
"RTN","GMTSOBA",95,0)
PART ; Print Partial Header
"RTN","GMTSOBA",96,0)
 K:+($G(GMTSQ))>0 GMTSOBJ Q:+($G(GMTSQ))>0  W !," Partial Header:"
"RTN","GMTSOBA",97,0)
 D:$D(GMTSOBJ) RD,RC,RH,CH^GMTSOBA2,DE^GMTSOBA2 Q
"RTN","GMTSOBA",98,0)
RD ;   Report Date
"RTN","GMTSOBA",99,0)
 Q:+($G(GMTSQ))>0  N X,Y,DIR,DIROUT,DUOUT,DTOUT,GMTSDEF
"RTN","GMTSOBA",100,0)
 S GMTSDEF=$P($G(^GMT(142.5,+($G(GMTSDA)),0)),U,9)
"RTN","GMTSOBA",101,0)
 S GMTSDEF=$S(+GMTSDEF>0:"Y",1:"N")
"RTN","GMTSOBA",102,0)
 S GMTSOBJ("DATE LINE")="",DIR("A")="   Print Report Date?  "
"RTN","GMTSOBA",103,0)
 S DIR("B")=GMTSDEF,DIR(0)="YAO",(DIR("?"),DIR("??"))="^D RD^GMTSOBH"
"RTN","GMTSOBA",104,0)
 D ^DIR S:$D(DIROUT)!($D(DTOUT)) GMTSQ=1
"RTN","GMTSOBA",105,0)
 S:Y["^"!(X["^") GMTSE=1,GMTSQ=1,GMTSDES=0
"RTN","GMTSOBA",106,0)
 K:+($G(GMTSQ))>0 GMTSOBJ("DATE LINE") Q:+($G(GMTSQ))>0
"RTN","GMTSOBA",107,0)
 S X=+($G(Y)) K:+X'>0 GMTSOBJ("DATE LINE") Q
"RTN","GMTSOBA",108,0)
RC ;   Confidentiality Banner
"RTN","GMTSOBA",109,0)
 Q:+($G(GMTSQ))>0  N X,Y,DIR,DIROUT,DUOUT,DTOUT,GMTSDEF
"RTN","GMTSOBA",110,0)
 S GMTSOBJ("CONFIDENTIAL")="",DIR("A")="   Print Confidentiality Banner?  "
"RTN","GMTSOBA",111,0)
 S GMTSDEF=$P($G(^GMT(142.5,+($G(GMTSDA)),0)),U,10)
"RTN","GMTSOBA",112,0)
 S GMTSDEF=$S(+GMTSDEF>0:"Y",1:"N")
"RTN","GMTSOBA",113,0)
 S DIR("B")=GMTSDEF,DIR(0)="YAO",(DIR("?"),DIR("??"))="^D RC^GMTSOBH"
"RTN","GMTSOBA",114,0)
 D ^DIR S:$D(DIROUT)!($D(DTOUT)) GMTSQ=1
"RTN","GMTSOBA",115,0)
 S:Y["^"!(X["^") GMTSE=1,GMTSQ=1,GMTSDES=0
"RTN","GMTSOBA",116,0)
 K:+($G(GMTSQ))>0 GMTSOBJ("CONFIDENNTIAL") Q:+($G(GMTSQ))>0
"RTN","GMTSOBA",117,0)
 S X=+($G(Y)) K:+X'>0 GMTSOBJ("CONFIDENTIAL") Q
"RTN","GMTSOBA",118,0)
RH ;   Report Header
"RTN","GMTSOBA",119,0)
 Q:+($G(GMTSQ))>0  N X,Y,DIR,DIROUT,DUOUT,DTOUT,GMTSDEF
"RTN","GMTSOBA",120,0)
 S GMTSOBJ("REPORT HEADER")="",DIR("A")="   Print Report Header?  "
"RTN","GMTSOBA",121,0)
 S GMTSDEF=$P($G(^GMT(142.5,+($G(GMTSDA)),0)),U,11)
"RTN","GMTSOBA",122,0)
 S GMTSDEF=$S(+GMTSDEF>0:"Y",1:"N")
"RTN","GMTSOBA",123,0)
 S DIR("B")=GMTSDEF,DIR(0)="YAO",(DIR("?"),DIR("??"))="^D RH^GMTSOBH"
"RTN","GMTSOBA",124,0)
 D ^DIR S:$D(DIROUT)!($D(DTOUT)) GMTSQ=1
"RTN","GMTSOBA",125,0)
 S:Y["^"!(X["^") GMTSE=1,GMTSQ=1,GMTSDES=0
"RTN","GMTSOBA",126,0)
 K:+($G(GMTSQ))>0 GMTSOBJ("REPORT HEADER") Q:+($G(GMTSQ))>0
"RTN","GMTSOBA",127,0)
 S X=+($G(Y)) K:+X'>0 GMTSOBJ("REPORT HEADER") Q
"RTN","GMTSOBA",128,0)
 ;          
"RTN","GMTSOBA",129,0)
CONT(X) ; Continue with Edit
"RTN","GMTSOBA",130,0)
 N DIR,DIROUT,DTOUT
"RTN","GMTSOBA",131,0)
 S DIR(0)="YAO",DIR("B")="NO",DIR("A")=" Do you want to edit the object?  Y/N  "
"RTN","GMTSOBA",132,0)
 D ^DIR S X=+($G(Y)) Q X
"RTN","GMTSOBA2")
0^29^B45947512
"RTN","GMTSOBA2",1,0)
GMTSOBA2 ; SLC/KER - HS Object - Ask               ; 01/06/2003
"RTN","GMTSOBA2",2,0)
 ;;2.7;Health Summary;**58**;Oct 20, 1995
"RTN","GMTSOBA2",3,0)
 ;
"RTN","GMTSOBA2",4,0)
 ; External References
"RTN","GMTSOBA2",5,0)
 ;   DBIA  10018  ^DIE  (file #142)
"RTN","GMTSOBA2",6,0)
 ;   DBIA  10026  ^DIR        
"RTN","GMTSOBA2",7,0)
 ;   DBIA  10006  ^DIC  (file #142)
"RTN","GMTSOBA2",8,0)
 ;   DBIA  10010  EN1^DIP
"RTN","GMTSOBA2",9,0)
 ;   DBIA  10076  ^XUSEC(
"RTN","GMTSOBA2",10,0)
 ;   DBIA  10076  ^XUSEC("GMTSMGR")
"RTN","GMTSOBA2",11,0)
 ;             
"RTN","GMTSOBA2",12,0)
CH ;   Component Header
"RTN","GMTSOBA2",13,0)
 Q:+($G(GMTSQ))>0  N X,Y,DIR,DIROUT,DUOUT,DTOUT,GMTSDEF,GMTSE
"RTN","GMTSOBA2",14,0)
 S GMTSOBJ("COMPONENT HEADER")="",DIR("A")="   Print the standard Component Header?  "
"RTN","GMTSOBA2",15,0)
 S GMTSDEF=$P($G(^GMT(142.5,+($G(GMTSDA)),0)),U,12),GMTSE=0
"RTN","GMTSOBA2",16,0)
 S GMTSDEF=$S(+GMTSDEF>0:"Y",GMTSDEF="":"Y",1:"N")
"RTN","GMTSOBA2",17,0)
 S DIR("B")=GMTSDEF,DIR(0)="YAO",(DIR("?"),DIR("??"))="^D CH^GMTSOBH"
"RTN","GMTSOBA2",18,0)
 D ^DIR S:$D(DIROUT)!($D(DTOUT)) GMTSQ=1
"RTN","GMTSOBA2",19,0)
 S:Y["^"!(X["^") GMTSE=1,GMTSQ=1,GMTSDES=0
"RTN","GMTSOBA2",20,0)
 K:+($G(GMTSQ))>0 GMTSOBJ("COMPONENT HEADER") Q:+($G(GMTSQ))>0
"RTN","GMTSOBA2",21,0)
 S X=+($G(Y)) K:+X'>0 GMTSOBJ("COMPONENT HEADER")
"RTN","GMTSOBA2",22,0)
 D:$D(GMTSOBJ("COMPONENT HEADER"))&(GMTSE'>0) LM Q:+($G(GMTSQ))>0  Q:+($G(GMTSE))>0
"RTN","GMTSOBA2",23,0)
 D:$D(GMTSOBJ("COMPONENT HEADER"))&(GMTSE'>0) UD Q:+($G(GMTSQ))>0  Q:+($G(GMTSE))>0
"RTN","GMTSOBA2",24,0)
 D:$D(GMTSOBJ("COMPONENT HEADER"))&(GMTSE'>0) BL Q:+($G(GMTSQ))>0  Q:+($G(GMTSE))>0
"RTN","GMTSOBA2",25,0)
 Q
"RTN","GMTSOBA2",26,0)
LM ;     Time/Occurence Limits
"RTN","GMTSOBA2",27,0)
 Q:+($G(GMTSQ))>0  Q:+($G(GMTSE))>0  N X,Y,DIR,DIROUT,DUOUT,DTOUT,GMTSDEF
"RTN","GMTSOBA2",28,0)
 S GMTSOBJ("LIMITS")="",DIR("A")="     Use report time/occurence limits?  "
"RTN","GMTSOBA2",29,0)
 S GMTSDEF=$P($G(^GMT(142.5,+($G(GMTSDA)),0)),U,14)
"RTN","GMTSOBA2",30,0)
 S GMTSDEF=$S(+GMTSDEF>0:"Y",1:"N")
"RTN","GMTSOBA2",31,0)
 S (DIR("?"),DIR("??"))="^D LM^GMTSOBH",DIR("B")=GMTSDEF,DIR(0)="YAO"
"RTN","GMTSOBA2",32,0)
 D ^DIR S:$D(DIROUT)!($D(DTOUT)) GMTSE=1
"RTN","GMTSOBA2",33,0)
 S:Y["^"!(X["^") GMTSE=1,GMTSQ=1,GMTSDES=0
"RTN","GMTSOBA2",34,0)
 K:+($G(GMTSE))>0 GMTSOBJ("LIMITS") Q:+($G(GMTSE))>0
"RTN","GMTSOBA2",35,0)
 S X=+($G(Y)) K:+X'>0 GMTSOBJ("LIMITS") Q
"RTN","GMTSOBA2",36,0)
UD ;     Underline Header
"RTN","GMTSOBA2",37,0)
 Q:+($G(GMTSQ))>0  Q:+($G(GMTSE))>0
"RTN","GMTSOBA2",38,0)
 N X,Y,DIR,DIROUT,DUOUT,DTOUT,GMTSDEF
"RTN","GMTSOBA2",39,0)
 S GMTSOBJ("UNDERLINE")="",DIR("A")="     Underline Component Header?  "
"RTN","GMTSOBA2",40,0)
 S GMTSDEF=$P($G(^GMT(142.5,+($G(GMTSDA)),0)),U,13)
"RTN","GMTSOBA2",41,0)
 S GMTSDEF=$S(+GMTSDEF>0:"Y",1:"N")
"RTN","GMTSOBA2",42,0)
 S (DIR("?"),DIR("??"))="^D CHU^GMTSOBH",DIR("B")=GMTSDEF,DIR(0)="YAO"
"RTN","GMTSOBA2",43,0)
 D ^DIR S:$D(DIROUT)!($D(DTOUT)) GMTSE=1
"RTN","GMTSOBA2",44,0)
 S:Y["^"!(X["^") GMTSE=1,GMTSQ=1,GMTSDES=0
"RTN","GMTSOBA2",45,0)
 K:+($G(GMTSE))>0 GMTSOBJ("UNDERLINE") Q:+($G(GMTSE))>0
"RTN","GMTSOBA2",46,0)
 S X=+($G(Y)) K:+X'>0 GMTSOBJ("UNDERLINE") Q
"RTN","GMTSOBA2",47,0)
BL ;     Blank Line after Header
"RTN","GMTSOBA2",48,0)
 Q:+($G(GMTSQ))>0  N X,Y,DIR,DIROUT,DUOUT,DTOUT,GMTSDEF
"RTN","GMTSOBA2",49,0)
 S GMTSOBJ("BLANK LINE")="",DIR("A")="     Add a Blank Line after the Component Header?  "
"RTN","GMTSOBA2",50,0)
 S GMTSDEF=$P($G(^GMT(142.5,+($G(GMTSDA)),0)),U,15)
"RTN","GMTSOBA2",51,0)
 S GMTSDEF=$S(+GMTSDEF>0:"Y",1:"N")
"RTN","GMTSOBA2",52,0)
 S (DIR("?"),DIR("??"))="^D BL^GMTSOBH",DIR("B")=GMTSDEF,DIR(0)="YAO"
"RTN","GMTSOBA2",53,0)
 D ^DIR S:$D(DIROUT)!($D(DTOUT)) GMTSQ=1
"RTN","GMTSOBA2",54,0)
 K:+($G(GMTSQ))>0 GMTSOBJ("BLANK LINE") Q:+($G(GMTSQ))>0
"RTN","GMTSOBA2",55,0)
 S X=+($G(Y)) K:+X'>0 GMTSOBJ("BLANK LINE") Q
"RTN","GMTSOBA2",56,0)
DE ;   Deceased
"RTN","GMTSOBA2",57,0)
 Q:+($G(GMTSQ))>0  N X,Y,DIR,DIROUT,DUOUT,DTOUT,GMTSDEF
"RTN","GMTSOBA2",58,0)
 S GMTSOBJ("DECEASED")="",DIR("A")="   Print the date a patient was deceased?  "
"RTN","GMTSOBA2",59,0)
 S GMTSDEF=$P($G(^GMT(142.5,+($G(GMTSDA)),0)),U,16)
"RTN","GMTSOBA2",60,0)
 S GMTSDEF=$S(+GMTSDEF>0:"Y",1:"N")
"RTN","GMTSOBA2",61,0)
 S (DIR("?"),DIR("??"))="^D DE^GMTSOBH",DIR("B")=GMTSDEF,DIR(0)="YAO"
"RTN","GMTSOBA2",62,0)
 D ^DIR S:$D(DIROUT)!($D(DTOUT)) GMTSQ=1
"RTN","GMTSOBA2",63,0)
 K:+($G(GMTSQ))>0 GMTSOBJ("DECEASED") Q:+($G(GMTSQ))>0
"RTN","GMTSOBA2",64,0)
 S X=+($G(Y)) K:+X'>0 GMTSOBJ("DECEASED") Q
"RTN","GMTSOBA2",65,0)
LBL ; Label
"RTN","GMTSOBA2",66,0)
 Q:+($G(GMTSQ))>0  N X,Y,DIR,DIROUT,DUOUT,DTOUT,GMTSDLD,GMTSDEF
"RTN","GMTSOBA2",67,0)
 K GMTSOBJ("USE LABEL"),GMTSOBJ("LABEL"),GMTSOBJ("LABEL BLANK LINE")
"RTN","GMTSOBA2",68,0)
 S DIR("A")=" Print a LABEL before the Health Summary Object?  "
"RTN","GMTSOBA2",69,0)
 S GMTSDEF=$S(+($G(GMTSDA))>0:$P($G(^GMT(142.5,+($G(GMTSDA)),0)),"^",7),1:0)
"RTN","GMTSOBA2",70,0)
 S GMTSDEF=$S(+GMTSDEF>0:"Y",1:"N"),(DIR("?"),DIR("??"))="^D PLB^GMTSOBH",DIR("B")=GMTSDEF,DIR(0)="YAO"
"RTN","GMTSOBA2",71,0)
 D ^DIR S:$D(DIROUT)!($D(DTOUT)) GMTSQ=1 S:Y["^"!(X["^") GMTSQ=1
"RTN","GMTSOBA2",72,0)
 K:+($G(GMTSQ))>0 GMTSOBJ("USE LABEL") Q:+($G(GMTSQ))>0
"RTN","GMTSOBA2",73,0)
 S GMTSOBJ("USE LABEL")=$S(+Y>0:1,1:0)
"RTN","GMTSOBA2",74,0)
 S X=+($G(Y)) D:+X LB Q
"RTN","GMTSOBA2",75,0)
LB ;   Object Label
"RTN","GMTSOBA2",76,0)
 Q:+($G(GMTSQ))>0  N X,Y,DIR,DIROUT,DUOUT,DTOUT,GMTSDEF,GMTSE
"RTN","GMTSOBA2",77,0)
 S GMTSOBJ("LABEL")="",DIR("A")="   Enter LABEL:  "
"RTN","GMTSOBA2",78,0)
 S GMTSDEF=$P($G(^GMT(142.5,+($G(DA)),0)),"^",2) S:$L(GMTSDEF) DIR("B")=GMTSDEF
"RTN","GMTSOBA2",79,0)
 S (DIR("?"),DIR("??"))="^D LBH^GMTSOBH",DIR(0)="FAO^3:60"
"RTN","GMTSOBA2",80,0)
 D ^DIR S:$D(DIROUT)!($D(DTOUT)) GMTSE=1 S:Y["^"!(X["^") GMTSE=1
"RTN","GMTSOBA2",81,0)
 K:+($G(GMTSE))>0 GMTSOBJ("USE LABEL"),GMTSOBJ("LABEL"),GMTSOBJ("LABEL BLANK LINE")
"RTN","GMTSOBA2",82,0)
 Q:+($G(GMTSE))>0  S X=$G(Y) K:'$L(X) GMTSOBJ("USE LABEL"),GMTSOBJ("LABEL"),GMTSOBJ("LABEL BLANK LINE")
"RTN","GMTSOBA2",83,0)
 S:$L(X) GMTSOBJ("LABEL")=X_" " D:$L($G(GMTSOBJ("LABEL"))) LBB Q
"RTN","GMTSOBA2",84,0)
LBB ;   Label Blank Line
"RTN","GMTSOBA2",85,0)
 Q:+($G(GMTSE))>0  Q:+($G(GMTSQ))>0  N X,Y,DIR,DIROUT,DUOUT,DTOUT,GMTSDEF,GMTSE
"RTN","GMTSOBA2",86,0)
 S GMTSOBJ("LABEL BLANK LINE")="",DIR("A")="   Print a blank line after the Object Label?  "
"RTN","GMTSOBA2",87,0)
 S GMTSDEF=$P($G(^GMT(142.5,+($G(DA)),0)),"^",8)
"RTN","GMTSOBA2",88,0)
 S GMTSDEF=$S(+GMTSDEF>0:"Y",1:"N") S DIR("B")=GMTSDEF
"RTN","GMTSOBA2",89,0)
 S (DIR("?"),DIR("??"))="^D LBLH^GMTSOBH",DIR(0)="YAO"
"RTN","GMTSOBA2",90,0)
 D ^DIR S:$D(DIROUT)!($D(DTOUT)) GMTSE=1 S:Y["^"!(X["^") GMTSE=1
"RTN","GMTSOBA2",91,0)
 K:+($G(GMTSE))>0 GMTSOBJ("LABEL BLANK LINE") Q:+($G(GMTSE))>0
"RTN","GMTSOBA2",92,0)
 S X=+($G(Y)) K:+X'>0 GMTSOBJ("LABEL BLANK LINE") Q
"RTN","GMTSOBA2",93,0)
SC ; Suppress Components w/o Data
"RTN","GMTSOBA2",94,0)
 Q:+($G(GMTSQ))>0  N X,Y,DIR,DIROUT,DUOUT,DTOUT,GMTSDLD,GMTSDEF
"RTN","GMTSOBA2",95,0)
 S GMTSOBJ("SUPPRESS COMPONENTS")="",DIR("A")=" Suppress Components without Data?  "
"RTN","GMTSOBA2",96,0)
 S GMTSDEF=$P($G(^GMT(142.5,+($G(GMTSDA)),0)),U,5)
"RTN","GMTSOBA2",97,0)
 S GMTSDEF=$S(+GMTSDEF>0:"Y",1:"N")
"RTN","GMTSOBA2",98,0)
 S (DIR("?"),DIR("??"))="^D SC^GMTSOBH",DIR("B")=GMTSDEF,DIR(0)="YAO"
"RTN","GMTSOBA2",99,0)
 D ^DIR S:$D(DIROUT)!($D(DTOUT)) GMTSQ=1
"RTN","GMTSOBA2",100,0)
 K:+($G(GMTSQ))>0 GMTSOBJ("SUPPRESS COMPONENTS") Q:+($G(GMTSQ))>0
"RTN","GMTSOBA2",101,0)
 S X=+($G(Y)) K:+X'>0 GMTSOBJ("SUPPRESS COMPONENTS")
"RTN","GMTSOBA2",102,0)
 Q
"RTN","GMTSOBA2",103,0)
ET(X) ; Edit Type X
"RTN","GMTSOBA2",104,0)
 Q:+($G(DUZ))'>0  N ADEL,B,BY,CHANGE,CNT,DA,DHD,DIC,DIE,DIK,DIR,DIROUT,DLAYGO,DR,DTOUT
"RTN","GMTSOBA2",105,0)
 N DUOUT,EXISTS,FLDS,FR,GMTSEG,GMTSIEN,GMTSDEF,GMTSIFN,GMTSMGR,GNTSN
"RTN","GMTSOBA2",106,0)
 N GMTSNEW,GMTSQIT,GMTSUM,GMTSV,GMTSAL,D,D0,D1,DQ,Y,L,LCNT,LI
"RTN","GMTSOBA2",107,0)
 N NXTCMP,SELCNT,SOACTION,TO,TWEENER S EXISTS=0,U="^",GMTSAL=1,GMTSQIT=0,X=$G(X) Q:'$L(X)  Q:$L(X)>30
"RTN","GMTSOBA2",108,0)
 S DIC="^GMT(142,",DIC(0)="XMZ" K DLAYGO D ^DIC
"RTN","GMTSOBA2",109,0)
 S GMTSN=$P($G(^GMT(142,+Y,0)),"^",1) Q:'$L(GMTSN)
"RTN","GMTSOBA2",110,0)
 S GMTSUM=$P(Y,U,2) Q:'$L(GMTSUM)  S:$D(DIROUT)!($D(DTOUT)) Y=-1 Q:+Y'>0
"RTN","GMTSOBA2",111,0)
 S GMTSNEW=+($P(Y,"^",3)),GMTSV=$$VTE^GMTSOBV(+Y) Q:+GMTSV'>0
"RTN","GMTSOBA2",112,0)
 S GMTSMGR=$S($D(^XUSEC("GMTSMGR",DUZ)):1,1:0)
"RTN","GMTSOBA2",113,0)
 S DIE="^GMT(142,",(GMTSIFN,DA)=+Y
"RTN","GMTSOBA2",114,0)
 S DR="[GMTS EDIT EXIST HS TYPE]"
"RTN","GMTSOBA2",115,0)
 W !!,"Editing Health Summary Type '",GMTSN,"'",!
"RTN","GMTSOBA2",116,0)
 D ^DIE
"RTN","GMTSOBA2",117,0)
 S EXISTS=0 S:($O(^GMT(142,+GMTSIFN,1,0))) EXISTS=1
"RTN","GMTSOBA2",118,0)
 D LIST:EXISTS,EXISTS
"RTN","GMTSOBA2",119,0)
 Q
"RTN","GMTSOBA2",120,0)
EXISTS ;   Edit an existing health summary type
"RTN","GMTSOBA2",121,0)
 N GMTSAL,CNT,NXTCMP Q:$D(DUOUT)  S NXTCMP=0,NXTCMP(0)=0,GMTSAL=0
"RTN","GMTSOBA2",122,0)
 F CNT=$$GETCNT(GMTSIFN):0 D NXTCMP^GMTSRM1,LIST:GMTSQIT Q:GMTSQIT!($D(DUOUT))  K GMTSQIT,GMTSNEW,TWEENER,SOACTION
"RTN","GMTSOBA2",123,0)
 I NXTCMP>0 W !,"Please hold on while I resequence the summary order" D COPY^GMTSRN,RNMBR^GMTSRN:CHANGE
"RTN","GMTSOBA2",124,0)
 Q
"RTN","GMTSOBA2",125,0)
LIST ;   Lists existing summary parameters
"RTN","GMTSOBA2",126,0)
 N B,DIC,DIR,IOP,Y,FR,TO,BY,DHD,FLDS,L I GMTSQIT'=2 Q:($D(DUOUT)!(GMTSQIT=1))
"RTN","GMTSOBA2",127,0)
 I GMTSQIT=2,(NXTCMP=0) S GMTSQIT=0 Q
"RTN","GMTSOBA2",128,0)
 I 'GMTSNEW,'GMTSAL W ! S DIC=142,DIR(0)="Y",DIR("A")="Do you wish to review the Summary Type structure before continuing",DIR("B")="NO" D ^DIR K DIR I 'Y S:GMTSQIT=2 DUOUT="" S:GMTSQIT=2 GMTSQIT="D" S:$D(DUOUT) GMTSQIT=1 Q
"RTN","GMTSOBA2",129,0)
 I $D(GMTSQIT),GMTSQIT=2 S GMTSQIT=0
"RTN","GMTSOBA2",130,0)
 S IOP="HOME",DIC=142,(FR,TO)=GMTSUM,BY=".01",DHD="[GMTS TYPE INQ HEADER]-[GMTS TYPE INQ FOOTER]",FLDS="[GMTS TYPE INQ]",L=0 D EN1^DIP
"RTN","GMTSOBA2",131,0)
 Q
"RTN","GMTSOBA2",132,0)
GETCNT(GMTSIFN) ;   Determine default summary order for new component
"RTN","GMTSOBA2",133,0)
 N LI,LCNT S LI=0,LCNT=5 F  S LI=$O(^GMT(142,+GMTSIFN,1,LI)) Q:+LI'>0  S LCNT=$P(LI,".")+5
"RTN","GMTSOBA2",134,0)
 Q LCNT
"RTN","GMTSOBD")
0^32^B38582350
"RTN","GMTSOBD",1,0)
GMTSOBD ; SLC/KER - HS Object - Display Type            ; 01/06/2003
"RTN","GMTSOBD",2,0)
 ;;2.7;Health Summary;**58**;Oct 20, 1995
"RTN","GMTSOBD",3,0)
 ;                
"RTN","GMTSOBD",4,0)
 ; External References
"RTN","GMTSOBD",5,0)
 ;   DBIA  10104  $$UP^XLFSTR
"RTN","GMTSOBD",6,0)
 ;   DBIA  10088  ENDR^%ZISS
"RTN","GMTSOBD",7,0)
 ;   DBIA   2056  $$GET1^DIQ  (file #200)
"RTN","GMTSOBD",8,0)
 ;   DBIA  10086  ^%ZIS
"RTN","GMTSOBD",9,0)
 ;   DBIA  10063  ^%ZTLOAD
"RTN","GMTSOBD",10,0)
 ;   DBIA  10089  ^%ZISC
"RTN","GMTSOBD",11,0)
 ;            
"RTN","GMTSOBD",12,0)
 Q
"RTN","GMTSOBD",13,0)
DDT(X) ; Detailed Display HS Type
"RTN","GMTSOBD",14,0)
 N GMTSDTD S GMTSDTD="" D DT(+($G(X))) Q
"RTN","GMTSOBD",15,0)
DT(X) ; Display HS Type
"RTN","GMTSOBD",16,0)
 K ^TMP("GMTSOBT",$J)
"RTN","GMTSOBD",17,0)
 N GMTSCCT,GMTSCNT,GMTSCMP,GMTSCPN,GMTSCPT,GMTSHD1,GMTSHD2,GMTSHOS
"RTN","GMTSOBD",18,0)
 N GMTSI,GMTSICD,GMTSIT,GMTSITC,GMTSITM,GMTSITS,GMTSLEN,GMTSLI,GMTSNAM
"RTN","GMTSOBD",19,0)
 N GMTSNAR,GMTSND0,GMTSOCC,GMTSOWN,GMTSPAR,GMTSPRT,GMTSS,GMTSTIM,GMTSTR
"RTN","GMTSOBD",20,0)
 N GMTSTTL,GMTSTXT,GMTST1,GMTST2,GMTSUNT,GMTSX,I
"RTN","GMTSOBD",21,0)
 S GMTSX=+($G(X)),(GMTSCCT,GMTSCNT)=0,GMTSND0=$G(^GMT(142,+($G(X)),0)),U="^"
"RTN","GMTSOBD",22,0)
 S GMTSNAM=$P(GMTSND0,U,1) Q:'$L(GMTSNAM)
"RTN","GMTSOBD",23,0)
 S GMTSOWN=$P(GMTSND0,U,3),GMTSOWN=$S(+GMTSOWN>0:$$GET1^DIQ(200,(+GMTSOWN_","),.01),1:"")
"RTN","GMTSOBD",24,0)
 S GMTSTTL=$G(^GMT(142,+($G(X)),"T"))
"RTN","GMTSOBD",25,0)
 S GMTST1=GMTSNAM,GMTSS=$J("",(35-$L(GMTST1)))
"RTN","GMTSOBD",26,0)
 S GMTSTXT=GMTSNAM S GMTSTXT=$G(BOLD)_GMTSTXT_$G(NORM)
"RTN","GMTSOBD",27,0)
 S:$L(GMTSTTL) GMTSTXT=GMTSTXT_GMTSS_GMTSTTL
"RTN","GMTSOBD",28,0)
 S GMTSCNT=GMTSCNT+1 S ^TMP("GMTSOBT",$J,GMTSCNT)=" "_GMTSTXT,^TMP("GMTSOBT",$J,0)=GMTSCNT
"RTN","GMTSOBD",29,0)
 S GMTSI=0 F  S GMTSI=$O(^GMT(142,+X,1,GMTSI)) Q:+GMTSI=0  D
"RTN","GMTSOBD",30,0)
 . N GMTSTR,GMTSCMP,GMTSCPN,GMTSHD1,GMTSHD2,GMTSITS S GMTSTR=$G(^GMT(142,+X,1,+GMTSI,0))
"RTN","GMTSOBD",31,0)
 . S GMTSCMP=$P(GMTSTR,U,2)
"RTN","GMTSOBD",32,0)
 . S GMTSPAR=$$PAR(+X,+GMTSI)
"RTN","GMTSOBD",33,0)
 . S GMTSCPN=$P($G(^GMT(142.1,+GMTSCMP,0)),U,1) Q:'$L(GMTSCPN)
"RTN","GMTSOBD",34,0)
 . S GMTSHD2=$P(GMTSTR,U,5),GMTSHD1=$P($G(^GMT(142.1,+GMTSCMP,0)),U,9)
"RTN","GMTSOBD",35,0)
 . S:$L(GMTSHD1) GMTSHD2=GMTSHD1
"RTN","GMTSOBD",36,0)
 . S GMTSITS=$S($D(^GMT(142,+X,1,+GMTSI,1,"B")):1,1:0),GMTSCCT=GMTSCCT+1
"RTN","GMTSOBD",37,0)
 . S GMTST1=" "_$J(GMTSCCT,3)_"  "_GMTSCPN,GMTSS=$J("",(40-$L(GMTST1)))
"RTN","GMTSOBD",38,0)
 . S GMTSTXT=" "_$G(BOLD)_$J(GMTSCCT,3)_"  "_GMTSCPN_$G(NORM)
"RTN","GMTSOBD",39,0)
 . S:$L(GMTSHD2) GMTSTXT=GMTSTXT_GMTSS_GMTSHD2_" "
"RTN","GMTSOBD",40,0)
 . S GMTST2=$S($L(GMTSHD2):(GMTST1_GMTSS_GMTSHD2),1:GMTST1)
"RTN","GMTSOBD",41,0)
 . S:+GMTSITS GMTSTXT=GMTSTXT_$S($L(GMTSTXT)<40:$J("",(40-$L(GMTST2))),1:"")_"(w/Selected Items)"
"RTN","GMTSOBD",42,0)
 . S GMTSCNT=GMTSCNT+1 S ^TMP("GMTSOBT",$J,GMTSCNT)=GMTSTXT,^TMP("GMTSOBT",$J,0)=GMTSCNT
"RTN","GMTSOBD",43,0)
 . I $L(GMTSPAR),$D(GMTSDTD) D
"RTN","GMTSOBD",44,0)
 . . S GMTSTXT="        "_GMTSPAR
"RTN","GMTSOBD",45,0)
 . . S GMTSCNT=GMTSCNT+1 S ^TMP("GMTSOBT",$J,GMTSCNT)=GMTSTXT,^TMP("GMTSOBT",$J,0)=GMTSCNT
"RTN","GMTSOBD",46,0)
 . N GMTSIT,GMTSITC S (GMTSIT,GMTSITC)=0
"RTN","GMTSOBD",47,0)
 . F  S GMTSIT=$O(^GMT(142,+X,1,+GMTSI,1,GMTSIT)) Q:+GMTSIT=0  D
"RTN","GMTSOBD",48,0)
 . . N GMTSLI,GMTSITM,GMTSNAM
"RTN","GMTSOBD",49,0)
 . . S GMTSLI=$G(^GMT(142,+X,1,+GMTSI,1,GMTSIT,0)),GMTSITM=$P(GMTSLI,U,1) Q:'$L(GMTSITM)
"RTN","GMTSOBD",50,0)
 . . Q:'$L($P(GMTSITM,";",2))  Q:+($P(GMTSITM,";",1))'>0  Q:'$D(@(U_$P(GMTSITM,";",2)_"0)"))
"RTN","GMTSOBD",51,0)
 . . S GMTSITM=U_$P(GMTSITM,";",2)_$P(GMTSITM,";",1)_",0)" S GMTSITM=@GMTSITM
"RTN","GMTSOBD",52,0)
 . . S GMTSNAM=$P(GMTSITM,U,1) Q:'$L(GMTSNAM)
"RTN","GMTSOBD",53,0)
 . . S GMTSITC=GMTSITC+1
"RTN","GMTSOBD",54,0)
 . . S GMTST1="       "_$J(GMTSITC,5)_"  "_GMTSNAM
"RTN","GMTSOBD",55,0)
 . . S GMTSTXT="       "_$G(BOLD)_$J(GMTSITC,5)_"  "_GMTSNAM_$G(NORM)
"RTN","GMTSOBD",56,0)
 . . S GMTSCNT=GMTSCNT+1 S ^TMP("GMTSOBT",$J,GMTSCNT)=GMTSTXT,^TMP("GMTSOBT",$J,0)=GMTSCNT
"RTN","GMTSOBD",57,0)
 I '$D(GMTSNOQ) D:+($G(^TMP("GMTSOBT",$J,0)))>0 DEV K ^TMP("GMTSOBT",$J)
"RTN","GMTSOBD",58,0)
 Q
"RTN","GMTSOBD",59,0)
PAR(X,I) ; Component Parameters
"RTN","GMTSOBD",60,0)
 N GMTSCPT,GMTSHOS,GMTSICD,GMTSLEN,GMTSNAR,GMTSOCC,GMTSPRT,GMTSTR
"RTN","GMTSOBD",61,0)
 N GMTSTIM,GMTSTXT,GMTSUNT
"RTN","GMTSOBD",62,0)
 S (GMTSTXT,GMTSPRT)="",GMTSTR=$G(^GMT(142,+X,1,+I,0))
"RTN","GMTSOBD",63,0)
 S GMTSOCC=$P(GMTSTR,U,3),GMTSOCC=$S(+GMTSOCC>0:(+GMTSOCC_" occ"),1:"")
"RTN","GMTSOBD",64,0)
 S GMTSTIM=$P(GMTSTR,U,4),GMTSUNT=$E(GMTSTIM,$L(GMTSTIM)),GMTSLEN=+GMTSTIM
"RTN","GMTSOBD",65,0)
 S GMTSUNT=$S(+GMTSUNT>0:"day",GMTSUNT="D":"day",GMTSUNT="W":"week",GMTSUNT="M":"month",GMTSUNT="Y":"year",1:"") S:$L(GMTSUNT)&(+GMTSLEN>1) GMTSUNT=GMTSUNT_"s"
"RTN","GMTSOBD",66,0)
 S GMTSTIM=$S(+GMTSTIM>0&($L(GMTSUNT)):(+GMTSTIM_" "_GMTSUNT),1:"")
"RTN","GMTSOBD",67,0)
 S GMTSHOS=$P(GMTSTR,U,6),GMTSHOS=$S($$UP^XLFSTR(GMTSHOS)="Y":"Hosp Loc",1:"")
"RTN","GMTSOBD",68,0)
 S GMTSICD=$$UP^XLFSTR($P(GMTSTR,U,7)),GMTSICD=$S(GMTSICD="L":"GMTSICD (long)",GMTSICD="S":"GMTSICD (short)",GMTSICD="C":"GMTSICD code",GMTSICD="T":"GMTSICD text",GMTSICD="N":"",1:"")
"RTN","GMTSOBD",69,0)
 S GMTSNAR=$$UP^XLFSTR($P(GMTSTR,U,8)),GMTSNAR=$S(GMTSNAR="Y":"Prov Narr",1:"")
"RTN","GMTSOBD",70,0)
 S GMTSCPT=$$UP^XLFSTR($P(GMTSTR,U,9)),GMTSCPT=$S(GMTSCPT="Y":"GMTSCPT Mod",1:"")
"RTN","GMTSOBD",71,0)
 S:$L(GMTSOCC) GMTSTXT=GMTSOCC
"RTN","GMTSOBD",72,0)
 S:$L(GMTSTIM)&($L(GMTSTXT)) GMTSTXT=GMTSTXT_" or "_GMTSTIM S:$L(GMTSTIM)&('$L(GMTSTXT)) GMTSTXT=GMTSTIM
"RTN","GMTSOBD",73,0)
 S:$L(GMTSHOS) GMTSPRT=GMTSHOS S:$L(GMTSICD)&($L(GMTSPRT)) GMTSPRT=GMTSPRT_", "_GMTSICD S:$L(GMTSICD)&('$L(GMTSPRT)) GMTSPRT=GMTSICD
"RTN","GMTSOBD",74,0)
 S:$L(GMTSNAR)&($L(GMTSPRT)) GMTSPRT=GMTSPRT_", "_GMTSNAR S:$L(GMTSNAR)&('$L(GMTSPRT)) GMTSPRT=GMTSNAR
"RTN","GMTSOBD",75,0)
 S:$L(GMTSCPT)&($L(GMTSPRT)) GMTSPRT=GMTSPRT_", "_GMTSCPT S:$L(GMTSCPT)&('$L(GMTSPRT)) GMTSPRT=GMTSCPT
"RTN","GMTSOBD",76,0)
 S:GMTSPRT[", " GMTSPRT=$P(GMTSPRT,", ",($L(GMTSPRT,", ")-1))_" and "_$P(GMTSPRT,", ",$L(GMTSPRT,", "))
"RTN","GMTSOBD",77,0)
 S:$L(GMTSPRT)&($L(GMTSTXT)) GMTSTXT=GMTSTXT_", and print "_GMTSPRT
"RTN","GMTSOBD",78,0)
 S:$L(GMTSPRT)&('$L(GMTSTXT)) GMTSTXT="Print "_GMTSPRT S X=GMTSTXT
"RTN","GMTSOBD",79,0)
 Q X
"RTN","GMTSOBD",80,0)
DEV ; Device
"RTN","GMTSOBD",81,0)
 I $D(CAP) D NODEV Q
"RTN","GMTSOBD",82,0)
 N ZTRTN,%ZIS,IOP,POP S %ZIS="PQ" D ^%ZIS Q:POP  I $D(IO("Q")) D QUE Q
"RTN","GMTSOBD",83,0)
NOQUE ; Print without Queuing
"RTN","GMTSOBD",84,0)
 N ZTRTN S ZTRTN="DSP^GMTSOBD"
"RTN","GMTSOBD",85,0)
 I $D(IOST),$D(IOF) W:IOST["C-"&('$D(GMTSNOI)) @IOF
"RTN","GMTSOBD",86,0)
 D @ZTRTN,^%ZISC Q
"RTN","GMTSOBD",87,0)
QUE ; Queued Print
"RTN","GMTSOBD",88,0)
 N %,ZTDESC,ZTDTH,ZTIO,ZTSAVE,ZTSK,ZTRTN S ZTRTN="DSP^GMTSOBD" K IO("Q"),ZTSAVE
"RTN","GMTSOBD",89,0)
 S ZTSAVE("^TMP(""GMTSOBJ"","_$J_",")=""
"RTN","GMTSOBD",90,0)
 S:$L($G(GMTSHDR)) ZTSAVE("GMTSHDR")=""
"RTN","GMTSOBD",91,0)
 S ZTDESC="Display Health Summary Type" S ZTIO=ION,ZTDTH=$H
"RTN","GMTSOBD",92,0)
 D ^%ZTLOAD I '$D(ZTSK) W !!,"Request Cancelled",! H 3 W:$D(IOF) @IOF
"RTN","GMTSOBD",93,0)
 I $D(ZTSK) W !!,"Request Queued",! H 3 W:$D(IOF) @IOF
"RTN","GMTSOBD",94,0)
 K ZTSK,ZTDESC,ZTDTH,ZTIO,ZTRTN,ZTSAVE D ^%ZISC Q
"RTN","GMTSOBD",95,0)
 Q
"RTN","GMTSOBD",96,0)
NODEV ; Print without Device Selection
"RTN","GMTSOBD",97,0)
 W !! N ZTRTN,POP,IOP,%ZIS,IOSL S IOSL=99999999999
"RTN","GMTSOBD",98,0)
 S ZTRTN="DSP^GMTSOBD" D @ZTRTN,^%ZISC
"RTN","GMTSOBD",99,0)
 Q
"RTN","GMTSOBD",100,0)
DSP ; Print Health Summary Type
"RTN","GMTSOBD",101,0)
 N GMTST,GMTSI,GMTSC,GMTSP,GMTSL,GMTSE,GMTSCR,GMTSPL
"RTN","GMTSOBD",102,0)
 S GMTSPL=3,GMTSE=0,GMTSP=$G(IOST),GMTSL=+($G(IOSL)) S:+GMTSL=0 GMTSL=24
"RTN","GMTSOBD",103,0)
 I $D(GMTSHDR) S (GMTSI,GMTSC)=0 D
"RTN","GMTSOBD",104,0)
 . F  S GMTSI=$O(GMTSHDR(GMTSI)) Q:+GMTSI=0  D  Q:GMTSE>0
"RTN","GMTSOBD",105,0)
 . . S GMTST=$G(GMTSHDR(GMTSI)) Q:'$L(GMTST)
"RTN","GMTSOBD",106,0)
 . . S GMTSC=GMTSC+1 I GMTSC=1 W ! S GMTSPL=GMTSPL+1
"RTN","GMTSOBD",107,0)
 . . W !,GMTST S GMTSPL=GMTSPL+1
"RTN","GMTSOBD",108,0)
 S GMTSI=0 F  S GMTSI=$O(^TMP("GMTSOBT",$J,GMTSI)) Q:+GMTSI=0  D
"RTN","GMTSOBD",109,0)
 . W !,$G(^TMP("GMTSOBT",$J,GMTSI)) S GMTSPL=GMTSPL+1 D CONT Q:GMTSE
"RTN","GMTSOBD",110,0)
 D CONT I '$D(CAP) W:GMTSP["P-"&($D(IOF)) @IOF
"RTN","GMTSOBD",111,0)
 Q
"RTN","GMTSOBD",112,0)
CONT ; Press <Return> to Continue
"RTN","GMTSOBD",113,0)
 I GMTSP["P-" W:$L($G(IOF))&($D(IOF)) @IOF Q
"RTN","GMTSOBD",114,0)
 Q:(GMTSP["C-"!(GMTSP=""))&(GMTSPL'>(GMTSL-4))  S GMTSPL=0 Q:GMTSE
"RTN","GMTSOBD",115,0)
 N GMTSCR S GMTSPL=0 W !!,"  Press <Return> to Continue  "
"RTN","GMTSOBD",116,0)
 R GMTSCR:660 I '$T!(GMTSCR["^") S GMTSCR="^",GMTSE=1
"RTN","GMTSOBD",117,0)
 W:GMTSP'["P-"&($D(IOF)) @IOF Q
"RTN","GMTSOBD",118,0)
 Q
"RTN","GMTSOBD",119,0)
ATTR ; Set Screen Attributes
"RTN","GMTSOBD",120,0)
 N X,IOINHI,IOINORM S X="IOINHI;IOINORM" D ENDR^%ZISS S BOLD=$G(IOINHI),NORM=$G(IOINORM) Q
"RTN","GMTSOBD",121,0)
KATTR ; Kill Screen Attributes
"RTN","GMTSOBD",122,0)
 K NORM,BOLD Q
"RTN","GMTSOBE")
0^19^B41162969
"RTN","GMTSOBE",1,0)
GMTSOBE ; SLC/KER - HS Object - Export            ; 01/06/2003
"RTN","GMTSOBE",2,0)
 ;;2.7;Health Summary;**58**;Oct 20, 1995
"RTN","GMTSOBE",3,0)
 ;                    
"RTN","GMTSOBE",4,0)
 ; External References
"RTN","GMTSOBE",5,0)
 ;
"RTN","GMTSOBE",6,0)
 ;   DBIA 10096  ^%ZOSF("DEL" 
"RTN","GMTSOBE",7,0)
 ;   DBIA  2056  $$GET1^DIQ (file #200 and 4.3)
"RTN","GMTSOBE",8,0)
 ;   DBIA 10112  $$SITE^VASITE
"RTN","GMTSOBE",9,0)
 ;   DBIA 10103  $$DOW^XLFDT
"RTN","GMTSOBE",10,0)
 ;   DBIA 10103  $$DT^XLFDT
"RTN","GMTSOBE",11,0)
 ;   DBIA 10103  $$FMTE^XLFDT
"RTN","GMTSOBE",12,0)
 ;   DBIA 10103  $$NOW^XLFDT
"RTN","GMTSOBE",13,0)
 ;   DBIA 10104  $$UP^XLFSTR
"RTN","GMTSOBE",14,0)
 ;   DBIA 10070  ^XMD
"RTN","GMTSOBE",15,0)
 ;                        
"RTN","GMTSOBE",16,0)
EN ; Main Entry Point to Export a HS Object
"RTN","GMTSOBE",17,0)
 N %Z,GMTS,GMTSCP,GMTSD,GMTSDM,GMTSDT,GMTSDW,GMTSEX,GMTSFRM,GMTSHD
"RTN","GMTSOBE",18,0)
 N GMTSI,GMTSN,GMTSNC,GMTSND,GMTSNN,GMTSNX,GMTSO,GMTSON,GMTSOND
"RTN","GMTSOBE",19,0)
 N GMTSQIT,GMTSRT,GMTSRTN,GMTSSX,GMTST,GMTSTMP,GMTSTN,GMTSTN0
"RTN","GMTSOBE",20,0)
 N GMTSTNAT,GMTSTNT,GMTSTNV,GMTSTR,GMTSTT,GMTSTXT,GMTSUSR,GMTSX
"RTN","GMTSOBE",21,0)
 N X,XCNP,XMDUZ,XMSCR,XMSUB,XMTEXT,XMY,XMZ,Y I +($G(DUZ))=0 W !!," User not defined" Q
"RTN","GMTSOBE",22,0)
 S GMTSUSR=$$GET1^DIQ(200,(+($G(DUZ))_","),.01) I '$L(GMTSUSR) W !!," Invalid User" Q
"RTN","GMTSOBE",23,0)
 S X=$$OBJ^GMTSOBL Q:+X'>0  S GMTSFRM=$P($$SITE^VASITE,"^",2),GMTSO=+X,GMTSOND=$G(^GMT(142.5,+GMTSO,0))
"RTN","GMTSOBE",24,0)
 S GMTSON=$P(GMTSOND,"^",1),GMTST=+($P(GMTSOND,"^",3)) Q:GMTST=0
"RTN","GMTSOBE",25,0)
 S GMTSTN0=$G(^GMT(142,+GMTST,0)),GMTSTNT=$G(^GMT(142,+GMTST,"T"))
"RTN","GMTSOBE",26,0)
 S GMTSTNV=$G(^GMT(142,+GMTST,"VA")),GMTSTN=$P(GMTSTN0,"^",1) Q:'$L(GMTSTN)
"RTN","GMTSOBE",27,0)
 S GMTSTT=$P(GMTSTNT,"^",1) S:'$L(GMTSTT)&($L(GMTSTN)) GMTSTT=$$EN2^GMTSUMX(GMTSTN)
"RTN","GMTSOBE",28,0)
 I GMTSTN="GMTS HS ADHOC OPTION" D  Q
"RTN","GMTSOBE",29,0)
 . W !," Can not export a Health Summary Object using GMTS HS ADHOC OPTION",!," (Adhoc) Health Summary Type."
"RTN","GMTSOBE",30,0)
 S GMTSTNAT=+GMTSTNV I GMTSTNAT>0 D  Q
"RTN","GMTSOBE",31,0)
 . W !," Can not export a Health Summary Object using a nationally released",!," Remote Data View Health Summary Type."
"RTN","GMTSOBE",32,0)
 S GMTSRTN="GMTSOBX" D INIT,TYPE,OBJ,MAIL
"RTN","GMTSOBE",33,0)
 K ^TMP($J,"GMTSOBXM")
"RTN","GMTSOBE",34,0)
 Q
"RTN","GMTSOBE",35,0)
INIT ; Initialize Export Routine
"RTN","GMTSOBE",36,0)
 Q:'$L(GMTSON)  Q:'$L(GMTSFRM)  Q:'$L(GMTSUSR)
"RTN","GMTSOBE",37,0)
 W !!," Exporting Object Routine - ",GMTSRTN D CRTN(GMTSRTN)
"RTN","GMTSOBE",38,0)
 N GMTST,GMTSI
"RTN","GMTSOBE",39,0)
 K ^TMP($J,"GMTSOBXM")
"RTN","GMTSOBE",40,0)
 S GMTST=$$CREATED D TL(GMTST)
"RTN","GMTSOBE",41,0)
 D BL D:$L($G(GMTSON)) TL((" Object:  "_GMTSON))
"RTN","GMTSOBE",42,0)
 D:$L($G(GMTSFRM)) TL((" From:    "_GMTSFRM))
"RTN","GMTSOBE",43,0)
 D:$L($G(GMTSUSR)) TL((" Sender:  "_GMTSUSR))
"RTN","GMTSOBE",44,0)
 D:$L($G(GMTSON))!($L($G(GMTSFRM)))!($L($G(GMTSUSR))) BL
"RTN","GMTSOBE",45,0)
 D TL(" 1) Use Packman to unpack the routine GMTSOBX contained in this message."),BL
"RTN","GMTSOBE",46,0)
 D TL(" 2) Use the following Option to install the Health Summary Object")
"RTN","GMTSOBE",47,0)
 D TL("    contained in this message."),BL
"RTN","GMTSOBE",48,0)
 D TL("      GMTS OBJ IMPORT/INSTALL")
"RTN","GMTSOBE",49,0)
 D TL("        Import/Install a Health Summary Object"),BL
"RTN","GMTSOBE",50,0)
 D TL("    or run the routine INS^GMTSOBJ"),BL
"RTN","GMTSOBE",51,0)
 D TL("$END TXT")
"RTN","GMTSOBE",52,0)
 D TL(("$ROU "_GMTSRTN))
"RTN","GMTSOBE",53,0)
 D TL((GMTSRTN_" ; CIO/SLC - HS Exported Object          ; "_$P($$FMTE^XLFDT($$NOW^XLFDT,"5Z"),"@",1)))
"RTN","GMTSOBE",54,0)
 D TL((" ;;"_$$VER_";Health Summary;;Oct 20, 1995")),S
"RTN","GMTSOBE",55,0)
 D:$L($G(GMTSON)) TL((" ; Object:  "_GMTSON))
"RTN","GMTSOBE",56,0)
 D:$L($G(GMTSFRM)) TL((" ; From:    "_GMTSFRM))
"RTN","GMTSOBE",57,0)
 D:$L($G(GMTSUSR)) TL((" ; Sender:  "_GMTSUSR)) D S,Q
"RTN","GMTSOBE",58,0)
 Q
"RTN","GMTSOBE",59,0)
 ;                         
"RTN","GMTSOBE",60,0)
TYPE ; Export Health Summary Type
"RTN","GMTSOBE",61,0)
 ;   This will not export:
"RTN","GMTSOBE",62,0)
 ;     National Health Summary Types
"RTN","GMTSOBE",63,0)
 ;     Local Components
"RTN","GMTSOBE",64,0)
 ;     Components with Selected Items
"RTN","GMTSOBE",65,0)
 N GMTSCP,GMTSHD,GMTSNC,GMTSND,GMTSNN,GMTSRT,GMTSTMP,GMTSTR
"RTN","GMTSOBE",66,0)
 N GMTSNX,GMTSSX,GMTSD
"RTN","GMTSOBE",67,0)
 D TL(("TYPE ; Health Summary Type"))
"RTN","GMTSOBE",68,0)
 I +($G(^GMT(142,+GMTST,"VA")))>0 D Q Q
"RTN","GMTSOBE",69,0)
 D TL((" ;"_GMTSTN)),TL((" ;"_GMTSTT))
"RTN","GMTSOBE",70,0)
 S GMTSTMP=$G(^GMT(142,+($G(GMTST)),0)),GMTSTMP=GMTSTN,$P(GMTSTMP,"^",2)="",$P(GMTSTMP,"^",5)=""
"RTN","GMTSOBE",71,0)
 D TL((" ;0;"_GMTSTMP))
"RTN","GMTSOBE",72,0)
 S GMTSRT="^GMT(142,"_+($G(GMTST))_","
"RTN","GMTSOBE",73,0)
 S GMTSNN="^GMT(142,"_+($G(GMTST))_",1)"
"RTN","GMTSOBE",74,0)
 S GMTSNC="^GMT(142,"_+($G(GMTST))_",1," S GMTSTR=1
"RTN","GMTSOBE",75,0)
 F  S GMTSNN=$Q(@GMTSNN) Q:GMTSNN=""!(GMTSNN'[GMTSNC)  D
"RTN","GMTSOBE",76,0)
 . S GMTSTR=$P($P(GMTSNN,GMTSRT,2),")",1)
"RTN","GMTSOBE",77,0)
 . S:$P(GMTSTR,",",3)="1" GMTSD(+($P(GMTSTR,",",2)))="" Q:$P(GMTSTR,",",3)="1"
"RTN","GMTSOBE",78,0)
 . S GMTSNX=$Q(@GMTSNN),GMTSSX=$P($P(GMTSNX,GMTSRT,2),")",1)
"RTN","GMTSOBE",79,0)
 . S:$P(GMTSSX,",",3)="1" GMTSD(+($P(GMTSSX,",",2)))="" Q:$P(GMTSSX,",",3)="1"
"RTN","GMTSOBE",80,0)
 . S GMTSND=@GMTSNN I GMTSTR="1,0" D TL((" ;"_GMTSTR_";"_GMTSND)) Q
"RTN","GMTSOBE",81,0)
 . S GMTSCP=+($P(GMTSND,"^",2)) Q:+GMTSCP>1000
"RTN","GMTSOBE",82,0)
 . S GMTSHD=$P($G(^GMT(142.1,+GMTSCP,0)),"^",9)
"RTN","GMTSOBE",83,0)
 . S:$P(GMTSND,"^",5)="" $P(GMTSND,"^",5)=GMTSHD
"RTN","GMTSOBE",84,0)
 . S:+($P(GMTSTR,",",2))=0 GMTSND=""
"RTN","GMTSOBE",85,0)
 . I +($P(GMTSTR,",",2))=0,+($P(GMTSTR,",",4))>0,$D(GMTSD(+($P(GMTSTR,",",4)))) Q
"RTN","GMTSOBE",86,0)
 . D TL((" ;"_GMTSTR_";"_GMTSND))
"RTN","GMTSOBE",87,0)
 D TL((" ;99;"_$H)) D:$L(GMTSTT) TL((" ;""T"";"_GMTSTT)) D Q
"RTN","GMTSOBE",88,0)
 Q
"RTN","GMTSOBE",89,0)
 ;                         
"RTN","GMTSOBE",90,0)
OBJ ; Export an Object
"RTN","GMTSOBE",91,0)
 N GMTSNC,GMTSND,GMTSNN,GMTSRT,GMTSTMP,GMTSTR
"RTN","GMTSOBE",92,0)
 D TL(("OBJ ; Health Summary Object")),TL((" ;"_GMTSON))
"RTN","GMTSOBE",93,0)
 S GMTSTMP=$G(^GMT(142.5,+GMTSO,0)),$P(GMTSTMP,"^",3)="",$P(GMTSTMP,"^",17)="",$P(GMTSTMP,"^",18)="",$P(GMTSTMP,"^",19)=""
"RTN","GMTSOBE",94,0)
 D TL((" ;0;"_GMTSTMP)) S GMTSRT="^GMT(142.5,"_+($G(GMTSO))_","
"RTN","GMTSOBE",95,0)
 S GMTSNN="^GMT(142.5,"_+($G(GMTSO))_",1)",GMTSNC="^GMT(142.5,"_+($G(GMTSO))_",1,"
"RTN","GMTSOBE",96,0)
 F  S GMTSNN=$Q(@GMTSNN) Q:GMTSNN=""!(GMTSNN'[GMTSNC)  D
"RTN","GMTSOBE",97,0)
 . S GMTSTR=$P($P(GMTSNN,GMTSRT,2),")",1),GMTSND=@GMTSNN D TL((" ;"_GMTSTR_";"_GMTSND))
"RTN","GMTSOBE",98,0)
 D Q,TL(("$END ROU "_GMTSRTN))
"RTN","GMTSOBE",99,0)
 Q
"RTN","GMTSOBE",100,0)
 ;                   
"RTN","GMTSOBE",101,0)
 ; Message
"RTN","GMTSOBE",102,0)
Q ;   Quit Line
"RTN","GMTSOBE",103,0)
 D TL(" Q") Q
"RTN","GMTSOBE",104,0)
S ;   Spacer/Comment Line
"RTN","GMTSOBE",105,0)
 D TL(" ;                   ") Q
"RTN","GMTSOBE",106,0)
BL ;   Blank Line
"RTN","GMTSOBE",107,0)
 D TL(" ") Q
"RTN","GMTSOBE",108,0)
TL(X) ;   Text Line
"RTN","GMTSOBE",109,0)
 N GMTS S GMTS=+($G(^TMP($J,"GMTSOBXM",0))),GMTS=GMTS+1
"RTN","GMTSOBE",110,0)
 S ^TMP($J,"GMTSOBXM",GMTS,0)=$G(X),^TMP($J,"GMTSOBXM",0)=GMTS
"RTN","GMTSOBE",111,0)
 Q
"RTN","GMTSOBE",112,0)
 ;                   
"RTN","GMTSOBE",113,0)
 ; Mailman Support
"RTN","GMTSOBE",114,0)
MAIL ;   Send Object via Mailman
"RTN","GMTSOBE",115,0)
 N %Z,XCNP,XMSCR,XMDUZ,XMY,XMZ,XMSUB,XMY,XMTEXT,XMDUZ,GMTSN,GMTSQIT Q:'$D(^TMP($J,"GMTSOBXM"))
"RTN","GMTSOBE",116,0)
 S XMDUZ=+($G(DUZ)) S:+XMDUZ=0 GMTSQIT=1 S GMTSN=$$XMY S:'$L(GMTSN) GMTSQIT=1 S:$L(GMTSN) XMY(GMTSN)=""
"RTN","GMTSOBE",117,0)
 S XMSUB=$$XMSUB S:'$L(XMSUB) GMTSQIT=1 S XMTEXT="^TMP("_$J_",""GMTSOBXM""," Q:+($G(GMTSQIT))>0
"RTN","GMTSOBE",118,0)
 D:+($G(GMTSQIT))'>0 ^XMD I +($G(XMZ))>0 H 1 W !,"   Message [",+($G(XMZ)),"] sent"
"RTN","GMTSOBE",119,0)
 K %Z,XCNP,XMSCR,XMDUZ,XMY,XMZ,XMSUB,XMY,XMTEXT,XMDUZ,^TMP($J,"GMTSOBXM")
"RTN","GMTSOBE",120,0)
 Q
"RTN","GMTSOBE",121,0)
XMY(X) ;   Get Addressee
"RTN","GMTSOBE",122,0)
 S X=$$GET1^DIQ(200,(+($G(DUZ))_","),.01) Q X
"RTN","GMTSOBE",123,0)
XMSUB(X) ;   Get Subject
"RTN","GMTSOBE",124,0)
 N GMTSON S GMTSON=$P($G(^GMT(142.5,+($G(GMTSO)),0)),"^",1)
"RTN","GMTSOBE",125,0)
 S X="Exported Health Summary Object" S:$L(GMTSON) X=$E(("Export HS Obj: "_GMTSON),1,65)
"RTN","GMTSOBE",126,0)
 Q X
"RTN","GMTSOBE",127,0)
DOM(X) ;   Domain
"RTN","GMTSOBE",128,0)
 S X=$$GET1^DIQ(4.3,"1,",.01) Q X
"RTN","GMTSOBE",129,0)
DOW(X) ;   Day of Week
"RTN","GMTSOBE",130,0)
 S X=$$DT^XLFDT,X=$$DOW^XLFDT(X),X=$$UP^XLFSTR(X) Q X
"RTN","GMTSOBE",131,0)
NOW(X) ;   Now
"RTN","GMTSOBE",132,0)
 N GMTSD,GMTST S X=$$NOW^XLFDT,X=$$FMTE^XLFDT(X,"5Z"),GMTSD=$P(X,"@",1)
"RTN","GMTSOBE",133,0)
 S GMTST=$P($P(X,"@",2),":",1,2),X=GMTSD S:$L(GMTST) X=GMTSD_" at "_GMTST
"RTN","GMTSOBE",134,0)
 Q X
"RTN","GMTSOBE",135,0)
 ;                     
"RTN","GMTSOBE",136,0)
 ; Miscellaneous
"RTN","GMTSOBE",137,0)
CRTN(X) ;   Clear Routine
"RTN","GMTSOBE",138,0)
 S X=$G(X) Q:'$L(X)  Q:$L(X)>8  Q:$$ROK(X)=0  X ^%ZOSF("DEL") Q
"RTN","GMTSOBE",139,0)
VER(X) ;   Health Summary Version
"RTN","GMTSOBE",140,0)
 N GMTSEX,GMTSTXT S X="GMTS",GMTSEX="S GMTSTXT=$T(+2^"_X_")" X GMTSEX S X=$P(GMTSTXT,";",3) Q X
"RTN","GMTSOBE",141,0)
ROK(X) ;   Routine is OK
"RTN","GMTSOBE",142,0)
 S X=$G(X) Q:'$L(X) 0
"RTN","GMTSOBE",143,0)
 N GMTSEX,GMTSTXT S GMTSEX="S GMTSTXT=$T(+1^"_X_")" X GMTSEX Q:'$L(GMTSTXT) 0 Q 1
"RTN","GMTSOBE",144,0)
CREATED(X) ;   Created Text
"RTN","GMTSOBE",145,0)
 N GMTST,GMTSN,GMTSDM,GMTSDW,GMTSDT S GMTST="$TXT",GMTSN=$$XMY S:$L(GMTSN) GMTST=GMTST_" Created by "_GMTSN
"RTN","GMTSOBE",146,0)
 S GMTSDM=$$DOM S:$L(GMTSDM) GMTST=GMTST_" at "_GMTSDM S GMTSDW=$$DOW S:$L(GMTSDW) GMTST=GMTST_" on "_GMTSDW
"RTN","GMTSOBE",147,0)
 S GMTSDT=$$NOW S:$L(GMTSDT) GMTST=GMTST_", "_GMTSDT S X=GMTST
"RTN","GMTSOBE",148,0)
 Q X
"RTN","GMTSOBH")
0^2^B57661517
"RTN","GMTSOBH",1,0)
GMTSOBH ; SLC/KER - HS Object - Help                 ; 01/06/2003
"RTN","GMTSOBH",2,0)
 ;;2.7;Health Summary;**58**;Oct 20, 1995
"RTN","GMTSOBH",3,0)
 ;
"RTN","GMTSOBH",4,0)
 ; External References
"RTN","GMTSOBH",5,0)
 ;   DBIA  10103  $$FMTE^XLFDT
"RTN","GMTSOBH",6,0)
 ;   DBIA  10103  $$NOW^XLFDT
"RTN","GMTSOBH",7,0)
 ;   DBIA  10088  ENDR^%ZISS
"RTN","GMTSOBH",8,0)
 ;                       
"RTN","GMTSOBH",9,0)
 Q
"RTN","GMTSOBH",10,0)
PLB ; Print Object Label
"RTN","GMTSOBH",11,0)
 D ATTR
"RTN","GMTSOBH",12,0)
 W !,"     Do you want to print a label before printing a Health Summary Object?"
"RTN","GMTSOBH",13,0)
 W !,"     Both the label and object will be embedded in another document.",!
"RTN","GMTSOBH",14,0)
 W !,"            <document text>",$G(BOLD)
"RTN","GMTSOBH",15,0)
 W !,"              <object label>",$G(NORM)
"RTN","GMTSOBH",16,0)
 W !,"                <Health Summary object>"
"RTN","GMTSOBH",17,0)
 W !,"            <document text continued>"
"RTN","GMTSOBH",18,0)
 D KATTR
"RTN","GMTSOBH",19,0)
 Q
"RTN","GMTSOBH",20,0)
LBH ; Object Label
"RTN","GMTSOBH",21,0)
 D ATTR
"RTN","GMTSOBH",22,0)
 W !,"     Enter a label for this object, 3 to 60 characters in length (optional)."
"RTN","GMTSOBH",23,0)
 W !,"     This label will be embedded in another document along with the Health"
"RTN","GMTSOBH",24,0)
 W !,"     Summary Type and will be printed as the first line of the object, before"
"RTN","GMTSOBH",25,0)
 W !,"     the Health Summary Prints.",!
"RTN","GMTSOBH",26,0)
 W !,"       <document>",$G(BOLD)
"RTN","GMTSOBH",27,0)
 W !,"         <object label>",$G(NORM)
"RTN","GMTSOBH",28,0)
 W !,"           <Health Summary object>"
"RTN","GMTSOBH",29,0)
 W !,"       <document>",!
"RTN","GMTSOBH",30,0)
 D KATTR
"RTN","GMTSOBH",31,0)
 Q
"RTN","GMTSOBH",32,0)
LBLH ; Label Blank Line
"RTN","GMTSOBH",33,0)
 D ATTR
"RTN","GMTSOBH",34,0)
 W !,"     If there is a Label for the object and the Label is to be printed,"
"RTN","GMTSOBH",35,0)
 W !,"     then a blank line may be printed after the object label.",!
"RTN","GMTSOBH",36,0)
 W !,"            <document text>"
"RTN","GMTSOBH",37,0)
 W !,"              <object label>",$G(BOLD)
"RTN","GMTSOBH",38,0)
 W !,"              <blank line>  ",$G(NORM)
"RTN","GMTSOBH",39,0)
 W !,"                <Health Summary object>"
"RTN","GMTSOBH",40,0)
 W !,"            <document text continued>"
"RTN","GMTSOBH",41,0)
 D KATTR
"RTN","GMTSOBH",42,0)
 Q
"RTN","GMTSOBH",43,0)
HSTH ; Health Summary Type
"RTN","GMTSOBH",44,0)
 W !,"     Enter the name of an existing Health Summary Type (file 142)"
"RTN","GMTSOBH",45,0)
 W !,"     that you wish to embedded in another document as an object.",!
"RTN","GMTSOBH",46,0)
 Q
"RTN","GMTSOBH",47,0)
ALL ; Suppress all of hte Health Summary Header
"RTN","GMTSOBH",48,0)
 N GMTSDLD S GMTSDLD=$$EDT^GMTSU($$NOW^XLFDT)
"RTN","GMTSOBH",49,0)
 W !,"     Print the following lines from the standard Health Summary"
"RTN","GMTSOBH",50,0)
 W !,"     Header with the Object?"
"RTN","GMTSOBH",51,0)
 W !,"     "
"RTN","GMTSOBH",52,0)
 W !,"     1                                                  "_GMTSDLD
"RTN","GMTSOBH",53,0)
 W !,"     2 *****************  CONFIDENTIAL HEALTH SUMMARY ******************"
"RTN","GMTSOBH",54,0)
 W !,"     3 PATIENT NAME    SSN-SSN-SSAN     WARD/LOCATTION     DATE OF BIRTH"
"RTN","GMTSOBH",55,0)
 W !,"     4 <blank>"
"RTN","GMTSOBH",56,0)
 W !,"     5 PN - Progress Notes (max 10 occurrences or 1 year)"
"RTN","GMTSOBH",57,0)
 W !,"     6 <blank>"
"RTN","GMTSOBH",58,0)
 W !,"     "
"RTN","GMTSOBH",59,0)
 Q
"RTN","GMTSOBH",60,0)
RD ; Report Date and Time
"RTN","GMTSOBH",61,0)
 N GMTSDLD S GMTSDLD=$TR($$FMTE^XLFDT($$NOW^XLFDT,"5ZM"),"@"," ") D ATTR
"RTN","GMTSOBH",62,0)
 W !,"     Print the report date/time with Health Summary Objects?"
"RTN","GMTSOBH",63,0)
 W !,"     "
"RTN","GMTSOBH",64,0)
 W !,"     "_$G(BOLD)_">>>>>  1                                             DATE/TIME  <<<<<"_$G(NORM)
"RTN","GMTSOBH",65,0)
 W !,"            2 ***********  CONFIDENTIAL HEALTH SUMMARY ************"
"RTN","GMTSOBH",66,0)
 W !,"            3 PATIENT NAME    SSN-SS-SSAN   WARD/LOCATION       DOB"
"RTN","GMTSOBH",67,0)
 W !,"            4 <blank>"
"RTN","GMTSOBH",68,0)
 W !,"            5 PN - Progress Notes (max 10 occ or 1 yr)"
"RTN","GMTSOBH",69,0)
 W !,"            6 <blank>"
"RTN","GMTSOBH",70,0)
 W !,"     "
"RTN","GMTSOBH",71,0)
 D KATTR
"RTN","GMTSOBH",72,0)
 Q
"RTN","GMTSOBH",73,0)
RH ; Report Header
"RTN","GMTSOBH",74,0)
 D ATTR
"RTN","GMTSOBH",75,0)
 W !,"     Print the report header with Health Summary Objects?"
"RTN","GMTSOBH",76,0)
 W !,"     "
"RTN","GMTSOBH",77,0)
 W !,"            1                                             DATE/TIME"
"RTN","GMTSOBH",78,0)
 W !,"            2 ***********  CONFIDENTIAL HEALTH SUMMARY ************"
"RTN","GMTSOBH",79,0)
 W !,$G(BOLD)_"     >>>>>  3 PATIENT NAME    SSN-SS-SSAN   WARD/LOCATION       DOB  <<<<<"_$G(NORM)
"RTN","GMTSOBH",80,0)
 W !,$G(BOLD)_"     >>>>>  4 <blank>                                                <<<<<"_$G(NORM)
"RTN","GMTSOBH",81,0)
 W !,"            5 PN - Progress Notes (max 10 occ or 1 yr)"
"RTN","GMTSOBH",82,0)
 W !,"            6 <blank>"
"RTN","GMTSOBH",83,0)
 W !,"     "
"RTN","GMTSOBH",84,0)
 D KATTR
"RTN","GMTSOBH",85,0)
 Q
"RTN","GMTSOBH",86,0)
RC ; Confidentiality Banner
"RTN","GMTSOBH",87,0)
 D ATTR
"RTN","GMTSOBH",88,0)
 W !,"     Print the confidentiality banner with Health Summary Objects?"
"RTN","GMTSOBH",89,0)
 W !,"     "
"RTN","GMTSOBH",90,0)
 W !,"            1                                             DATE/TIME"
"RTN","GMTSOBH",91,0)
 W !,$G(BOLD)_"     >>>>>  2 ***********  CONFIDENTIAL HEALTH SUMMARY ************  <<<<<"_$G(NORM)
"RTN","GMTSOBH",92,0)
 W !,"            3 PATIENT NAME    SSN-SS-SSAN   WARD/LOCATION       DOB"
"RTN","GMTSOBH",93,0)
 W !,"            4 <blank>"
"RTN","GMTSOBH",94,0)
 W !,"            5 PN - Progress Notes (max 10 occ or 1 yr)"
"RTN","GMTSOBH",95,0)
 W !,"            6 <blank>"
"RTN","GMTSOBH",96,0)
 W !,"     "
"RTN","GMTSOBH",97,0)
 D KATTR
"RTN","GMTSOBH",98,0)
 Q
"RTN","GMTSOBH",99,0)
CHU ; Component Header Underlined
"RTN","GMTSOBH",100,0)
 N GMTSCHU S GMTSCHU=""
"RTN","GMTSOBH",101,0)
CH ; Component Header
"RTN","GMTSOBH",102,0)
 D ATTR
"RTN","GMTSOBH",103,0)
 W:'$D(GMTSCHU) !,"     Print the standard component header with Health Summary Objects?"
"RTN","GMTSOBH",104,0)
 W:$D(GMTSCHU) !,"     Underline the standard component header with a single line of dashes?"
"RTN","GMTSOBH",105,0)
 W !,"     "
"RTN","GMTSOBH",106,0)
 W !,"            1                                             DATE/TIME"
"RTN","GMTSOBH",107,0)
 W !,"            2 ***********  CONFIDENTIAL HEALTH SUMMARY ************"
"RTN","GMTSOBH",108,0)
 W !,"            3 PATIENT NAME    SSN-SS-SSAN   WARD/LOCATION       DOB"
"RTN","GMTSOBH",109,0)
 W !,"            4 <blank>"
"RTN","GMTSOBH",110,0)
 W:'$D(GMTSCHU) !,$G(BOLD)_"     >>>>> "_$G(NORM)_" 5 "_$G(BOLD)_"PN - Progress Notes "_$G(NORM)_"(max 10 occ or 1 yr)               "_$G(BOLD)_"<<<<<"_$G(NORM)
"RTN","GMTSOBH",111,0)
 W:'$D(GMTSCHU) !,$G(BOLD)_"           "_$G(NORM)_"  "_$G(BOLD)_"|-------------------| "_$G(NORM)
"RTN","GMTSOBH",112,0)
 W:$D(GMTSCHU) !,"            5 PN - Progress Notes"
"RTN","GMTSOBH",113,0)
 W:$D(GMTSCHU) !,$G(BOLD),"     >>>>>    -------------------                                    <<<<<"_$G(NORM)
"RTN","GMTSOBH",114,0)
 W !,"     "
"RTN","GMTSOBH",115,0)
 D KATTR
"RTN","GMTSOBH",116,0)
 Q
"RTN","GMTSOBH",117,0)
LM ; Time and Occurence Limits
"RTN","GMTSOBH",118,0)
 D ATTR
"RTN","GMTSOBH",119,0)
 W !,"     Print report time and occurence limits with the component header?"
"RTN","GMTSOBH",120,0)
 W !,"     "
"RTN","GMTSOBH",121,0)
 W !,"            1                                             DATE/TIME"
"RTN","GMTSOBH",122,0)
 W !,"            2 ***********  CONFIDENTIAL HEALTH SUMMARY ************"
"RTN","GMTSOBH",123,0)
 W !,"            3 PATIENT NAME    SSN-SS-SSAN   WARD/LOCATION       DOB"
"RTN","GMTSOBH",124,0)
 W !,"            4 <blank>"
"RTN","GMTSOBH",125,0)
 W !,"  "_$G(BOLD)_"   >>>>> "_$G(NORM)_" 5 PN - Progress Notes "_$G(BOLD)_"(max 10 occ or 1 yr) "_$G(NORM)_"              "_$G(BOLD)_"<<<<<"_$G(NORM)
"RTN","GMTSOBH",126,0)
 W !,"                                 "_$G(BOLD)_"|--------------------| "_$G(NORM)
"RTN","GMTSOBH",127,0)
 W !,"     "
"RTN","GMTSOBH",128,0)
 D KATTR
"RTN","GMTSOBH",129,0)
 Q
"RTN","GMTSOBH",130,0)
BL ; Blank Line
"RTN","GMTSOBH",131,0)
 D ATTR
"RTN","GMTSOBH",132,0)
 W !,"     Print a Blank Line after the Component Header?"
"RTN","GMTSOBH",133,0)
 W !,"     "
"RTN","GMTSOBH",134,0)
 W !,"            1                                             DATE/TIME"
"RTN","GMTSOBH",135,0)
 W !,"            2 ***********  CONFIDENTIAL HEALTH SUMMARY ************"
"RTN","GMTSOBH",136,0)
 W !,"            3 PATIENT NAME    SSN-SS-SSAN   WARD/LOCATION       DOB"
"RTN","GMTSOBH",137,0)
 W !,"            4 <blank>"
"RTN","GMTSOBH",138,0)
 W:$D(GMTSOBJ("LIMITS")) !,"            5 PN - Progress Notes (max 10 occurrences or 1 year)"
"RTN","GMTSOBH",139,0)
 W:'$D(GMTSOBJ("LIMITS")) !,"            5 PN - Progress Notes"
"RTN","GMTSOBH",140,0)
 W !,"  "_$G(BOLD)_"   >>>>>  6 <blank>                                                <<<<<"_$G(NORM)
"RTN","GMTSOBH",141,0)
 W !,"     "
"RTN","GMTSOBH",142,0)
 D KATTR
"RTN","GMTSOBH",143,0)
 Q
"RTN","GMTSOBH",144,0)
DE ; Deceased
"RTN","GMTSOBH",145,0)
 D ATTR
"RTN","GMTSOBH",146,0)
 W !,"     Print the date deceased with Health Summary Objects?"
"RTN","GMTSOBH",147,0)
 W !,"     "
"RTN","GMTSOBH",148,0)
 W !,"            1                                             DATE/TIME"
"RTN","GMTSOBH",149,0)
 W !,"            2 ***********  CONFIDENTIAL HEALTH SUMMARY ************"
"RTN","GMTSOBH",150,0)
 W !,"            3 PATIENT NAME    SSN-SS-SSAN   WARD/LOCATION       DOB"
"RTN","GMTSOBH",151,0)
 W !,"            4 <blank>"
"RTN","GMTSOBH",152,0)
 W !,"            5 PN - Progress Notes (max 10 occ or 1 yr)"
"RTN","GMTSOBH",153,0)
 W !,"            6 <blank>"
"RTN","GMTSOBH",154,0)
 W !,$G(BOLD)_" *   >>>>>  7              **  DECEASED  DATE/TIME  **               <<<<<"_$G(NORM)
"RTN","GMTSOBH",155,0)
 W !,"     "
"RTN","GMTSOBH",156,0)
 W !,"          "_$G(BOLD)_"*"_$G(NORM)_" This is a conditional line of the Health Summary report "
"RTN","GMTSOBH",157,0)
 W !,"            header which is only printed for deceased patients"
"RTN","GMTSOBH",158,0)
 W !,"     "
"RTN","GMTSOBH",159,0)
 D KATTR
"RTN","GMTSOBH",160,0)
 Q
"RTN","GMTSOBH",161,0)
SC ; Suppress Components Without Data
"RTN","GMTSOBH",162,0)
 D ATTR
"RTN","GMTSOBH",163,0)
 W !,"     If this field is set to 1 (YES) and a Health Summary component does "
"RTN","GMTSOBH",164,0)
 W !,"     not have any data, the component will be suppressed.",!
"RTN","GMTSOBH",165,0)
 W !,"     If this field is NOT set to 1 (Null or 0 = NO) and the component does"
"RTN","GMTSOBH",166,0)
 W !,"     not have any data, then the component will print with the statement"
"RTN","GMTSOBH",167,0)
 W !,"     ""No data available""",!
"RTN","GMTSOBH",168,0)
 W !,"          Example:",!
"RTN","GMTSOBH",169,0)
 W !,$G(BOLD),"               PN - Progress Notes",$G(NORM)
"RTN","GMTSOBH",170,0)
 W !,$G(BOLD),"               No data available",$G(NORM)
"RTN","GMTSOBH",171,0)
 D KATTR
"RTN","GMTSOBH",172,0)
 Q
"RTN","GMTSOBH",173,0)
TRIM(X) ; Trim Spaces
"RTN","GMTSOBH",174,0)
 S X=$G(X) F  Q:$E(X,1)'=" "  S X=$E(X,2,$L(X))
"RTN","GMTSOBH",175,0)
 F  Q:$E(X,$L(X))'=" "  S X=$E(X,1,($L(X)-1))
"RTN","GMTSOBH",176,0)
 Q X
"RTN","GMTSOBH",177,0)
ATTR ; Set Screen Attributes
"RTN","GMTSOBH",178,0)
 N X,IOINHI,IOINORM S X="IOINHI;IOINORM" D ENDR^%ZISS S BOLD=$G(IOINHI),NORM=$G(IOINORM) D ENDR^%ZISS
"RTN","GMTSOBH",179,0)
 Q
"RTN","GMTSOBH",180,0)
KATTR ; Kill Screen Attributes
"RTN","GMTSOBH",181,0)
 K NORM,BOLD
"RTN","GMTSOBH",182,0)
 Q
"RTN","GMTSOBI")
0^20^B40976861
"RTN","GMTSOBI",1,0)
GMTSOBI ; SLC/KER - HS Object - Import/Install    ; 01/06/2003
"RTN","GMTSOBI",2,0)
 ;;2.7;Health Summary;**58**;Oct 20, 1995
"RTN","GMTSOBI",3,0)
 ;                      
"RTN","GMTSOBI",4,0)
 ; External References
"RTN","GMTSOBI",5,0)
 ;   DBIA 10096  ^%ZOSF("DEL"
"RTN","GMTSOBI",6,0)
 ;   DBIA 10013  IX1^DIK
"RTN","GMTSOBI",7,0)
 ;   DBIA 10112  $$SITE^VASITE
"RTN","GMTSOBI",8,0)
 ;   DBIA  2055  $$FLDNUM^DILFD (file 142.5)
"RTN","GMTSOBI",9,0)
 ;   DBIA 10103  $$NOW^XLFDT
"RTN","GMTSOBI",10,0)
 ;   DBIA 10013  ^DIK
"RTN","GMTSOBI",11,0)
 ;                        
"RTN","GMTSOBI",12,0)
EN ; Install Object from Routine GMTSOBX
"RTN","GMTSOBI",13,0)
 N DA,DIK,GMTS3,GMTS4,GMTSC,GMTSEDAT,GMTSETYP,GMTSETTL,GMTSDAO
"RTN","GMTSOBI",14,0)
 N GMTSDAT,GMTSDR,GMTSEX,GMTSFAC,GMTSFRM,GMTSI,GMTSIEN,GMTSIT
"RTN","GMTSOBI",15,0)
 N GMTSL,GMTSLN,GMTSNDD,GMTSOBJ,GMTSOBX,GMTSON,GMTSQIT,GMTSR
"RTN","GMTSOBI",16,0)
 N GMTSROK,GMTSRT,GMTSRTN,GMTST,GMTSTE,GMTSTN,GMTSTMP,GMTSTR
"RTN","GMTSOBI",17,0)
 N GMTSTTL,GMTSTXT,GMTSTYP,GMTSUSR,X
"RTN","GMTSOBI",18,0)
 I +($$FLDNUM^DILFD(142.5,"NAME"))'>0!('$D(^GMT(142.5))) D  Q
"RTN","GMTSOBI",19,0)
 . W !," Unable to find HEALTH SUMMARY OBJECTS file #142.5"
"RTN","GMTSOBI",20,0)
 S GMTSEDAT=0,GMTSRTN="GMTSOBX",GMTSQIT=0,GMTSUSR=+($G(DUZ)) I +GMTSUSR=0 W !!," User not defined" Q
"RTN","GMTSOBI",21,0)
 I +($$ROK^GMTSOBU(GMTSRTN))'>0 W !," Error:",!,"    Object not Found (routine GMTSOBX)" Q
"RTN","GMTSOBI",22,0)
 F GMTSI=1:1:7 D
"RTN","GMTSOBI",23,0)
 . S GMTST=$$TX^GMTSOBU(GMTSRTN,GMTSRTN,(GMTSI-1)) S:GMTST["Object:  " GMTSOBJ=$P(GMTST,"Object:  ",2)
"RTN","GMTSOBI",24,0)
 . S:GMTST["From:    " GMTSFRM=$P(GMTST,"From:    ",2) S:GMTST["Sender:  " GMTSDR=$P(GMTST,"Sender:  ",2)
"RTN","GMTSOBI",25,0)
 S (GMTSON,GMTSOBJ)=$P($$TX^GMTSOBU(GMTSRTN,"OBJ",1),";",2)
"RTN","GMTSOBI",26,0)
 S (GMTSTN,GMTSTYP)=$P($$TX^GMTSOBU(GMTSRTN,"TYPE",1),";",2)
"RTN","GMTSOBI",27,0)
 I GMTSOBJ=""!(GMTSFRM="")!(GMTSDR="") W !," Error:",!,"    Can not install object from ",GMTSRTN Q
"RTN","GMTSOBI",28,0)
 W !," Installing Health Summary Object:  ",GMTSOBJ
"RTN","GMTSOBI",29,0)
 I $L(GMTSTYP) D
"RTN","GMTSOBI",30,0)
 . W !,"        Using Health Summary Type:  ",GMTSTYP
"RTN","GMTSOBI",31,0)
 W !,"                             From:  ",GMTSFRM
"RTN","GMTSOBI",32,0)
 W !,"                           Sender:  ",GMTSDR
"RTN","GMTSOBI",33,0)
 S GMTSTTL=$P($$TX^GMTSOBU(GMTSRTN,"TYPE",2),";",2)
"RTN","GMTSOBI",34,0)
 ;   Check Facility
"RTN","GMTSOBI",35,0)
 S GMTSFAC=+($P($$SITE^VASITE,"^",3)) I +GMTSFAC=0 W !," Error:",!,"    Facility not defined" Q
"RTN","GMTSOBI",36,0)
 ;   Check Object
"RTN","GMTSOBI",37,0)
 W !!," Checking Health Summary Object file #142.5"
"RTN","GMTSOBI",38,0)
 I $L(GMTSOBJ) D  Q:GMTSQIT
"RTN","GMTSOBI",39,0)
 . N GMTSTMP S GMTSTMP=$$BOX^GMTSOBU(GMTSOBJ) I +($G(GMTSTMP))>0 W ! D ER1^GMTSOBU S GMTSQIT=1
"RTN","GMTSOBI",40,0)
 ;   Check Type
"RTN","GMTSOBI",41,0)
 W !," Check Health Summary Type file #142"
"RTN","GMTSOBI",42,0)
 I $L(GMTSTYP) D  Q:GMTSQIT
"RTN","GMTSOBI",43,0)
 . S GMTSQIT=1 N GMTSTMP S GMTSTMP=$$NWX^GMTSOBU(GMTSTYP)
"RTN","GMTSOBI",44,0)
 . S:+($G(GMTSTMP))'>0 GMTSQIT=0 I +($G(GMTSTMP))>0 D
"RTN","GMTSOBI",45,0)
 . . S GMTSEDAT=$$EHST^GMTSOBU I GMTSEDAT>0 D  Q
"RTN","GMTSOBI",46,0)
 . . . S GMTSDAT=GMTSEDAT,GMTSQIT=0 I $L($G(GMTSETYP)),$L($G(GMTSETTL)) D
"RTN","GMTSOBI",47,0)
 . . . . S GMTSTYP=GMTSETYP,GMTSTTL=GMTSETTL
"RTN","GMTSOBI",48,0)
 ;   Check Title
"RTN","GMTSOBI",49,0)
 W !," Checking for Duplicate Title"
"RTN","GMTSOBI",50,0)
 I $L(GMTSTTL) D  Q:GMTSQIT
"RTN","GMTSOBI",51,0)
 . N GMTSTMP S GMTSTMP=$$TWX^GMTSOBU(GMTSTTL) I +GMTSTMP>0 W ! D ER3^GMTSOBU S GMTSQIT=1
"RTN","GMTSOBI",52,0)
 S GMTSDAT=$$TIEN^GMTSOBU S:+($G(GMTSEDAT))>0 GMTSDAT=+($G(GMTSEDAT))
"RTN","GMTSOBI",53,0)
 S:GMTSDAT'>0 GMTSQIT=1
"RTN","GMTSOBI",54,0)
 I GMTSQIT W !," Unable to add Health Summary Type" Q
"RTN","GMTSOBI",55,0)
 S GMTSDAO=$$OIEN^GMTSOBU(GMTSFAC) S:GMTSDAO'>0 GMTSQIT=1
"RTN","GMTSOBI",56,0)
 I GMTSQIT W !," Unable to add Health Summary Object" Q
"RTN","GMTSOBI",57,0)
 L +^GMT(142,+GMTSDAT):0 S:'$T GMTSQIT=1
"RTN","GMTSOBI",58,0)
 L +^GMT(142.5,+GMTSDAO):0 S:'$T GMTSQIT=1
"RTN","GMTSOBI",59,0)
 I +($G(GMTSQIT))>0 L -^GMT(142,+GMTSDAT) L -^GMT(142,+GMTSDAO) D  Q
"RTN","GMTSOBI",60,0)
 . W !," Unable to add Health Summary Type and Object"
"RTN","GMTSOBI",61,0)
 I GMTSDAT>0,GMTSDAO>0,GMTSQIT'>0 D HST,HSO
"RTN","GMTSOBI",62,0)
 D DELERR L -^GMT(142,+GMTSDAT) L -^GMT(142,+GMTSDAO)
"RTN","GMTSOBI",63,0)
 D DONE W !
"RTN","GMTSOBI",64,0)
 Q
"RTN","GMTSOBI",65,0)
HST ; Install Health Summary Type
"RTN","GMTSOBI",66,0)
 ;   Needs GMTSRTN, GMTSDAT, GMTSUSR, GMTSTYP, GMTSTTL
"RTN","GMTSOBI",67,0)
 Q:+($G(GMTSTE))>0  N GMTSROK,GMTSI,GMTSTXT,GMTSTR,GMTSNDD,GMTSR,GMTSC,GMTSRT,GMTS3,GMTS4,DA,DIK
"RTN","GMTSOBI",68,0)
 Q:+($G(GMTSQIT))>0  S GMTSQIT=0,GMTSROK=$$ROK^GMTSOBU(GMTSRTN) Q:GMTSROK'>0
"RTN","GMTSOBI",69,0)
 ;   Save Type
"RTN","GMTSOBI",70,0)
 I '$L(GMTSTYP)!('$L(GMTSTTL)) S GMTSQIT=1 Q
"RTN","GMTSOBI",71,0)
 F GMTSI=3:1 Q:GMTSQIT  D  Q:GMTSQIT
"RTN","GMTSOBI",72,0)
 . S GMTSTXT=$$TX^GMTSOBU(GMTSRTN,"TYPE",GMTSI),GMTSTXT=$P(GMTSTXT," ;",2,299)
"RTN","GMTSOBI",73,0)
 . I '$L(GMTSTXT) S GMTSQIT=1 Q
"RTN","GMTSOBI",74,0)
 . S GMTSTR=$P(GMTSTXT,";",1),GMTSNDD=$P(GMTSTXT,";",2)
"RTN","GMTSOBI",75,0)
 . S GMTSR=$P(GMTSTR,",",2),GMTSC=$P(GMTSNDD,"^",2)
"RTN","GMTSOBI",76,0)
 . Q:GMTSR>0&(GMTSC>0)&('$D(^GMT(142.1,+GMTSC)))  Q:(GMTSR>0)&(GMTSC>0)&(GMTSC>999)
"RTN","GMTSOBI",77,0)
 . S:GMTSTR="0" $P(GMTSNDD,"^",3)=GMTSUSR
"RTN","GMTSOBI",78,0)
 . S:GMTSTR="0"&($L(GMTSTYP)) $P(GMTSNDD,"^",1)=GMTSTYP
"RTN","GMTSOBI",79,0)
 . S:GMTSTR="""T"""&($L(GMTSTTL)) $P(GMTSNDD,"^",1)=GMTSTTL
"RTN","GMTSOBI",80,0)
 . S GMTSNDD=$TR(GMTSNDD,"""","") S:'$L(GMTSNDD) GMTSNDD=""""""
"RTN","GMTSOBI",81,0)
 . S GMTSRT="^GMT(142,DA,"_GMTSTR_")"
"RTN","GMTSOBI",82,0)
 . S DA=GMTSDAT S @GMTSRT=GMTSNDD
"RTN","GMTSOBI",83,0)
 ;   Check Indexes
"RTN","GMTSOBI",84,0)
 S GMTSQIT=0 F GMTSI="B","C" S GMTSR=0 F  S GMTSR=$O(^GMT(142,GMTSDAT,1,GMTSI,GMTSR)) Q:+GMTSR=0  D
"RTN","GMTSOBI",85,0)
 . S GMTSC=0 F  S GMTSC=$O(^GMT(142,GMTSDAT,1,GMTSI,GMTSR,GMTSC)) Q:+GMTSC=0  D
"RTN","GMTSOBI",86,0)
 . . I '$D(^GMT(142,GMTSDAT,1,GMTSC)) K ^GMT(142,GMTSDAT,1,GMTSI,GMTSR,GMTSC)
"RTN","GMTSOBI",87,0)
 ;   Re-Index
"RTN","GMTSOBI",88,0)
 S DA=GMTSDAT,DIK="^GMT(142," D IX1^DIK
"RTN","GMTSOBI",89,0)
 ;   Check Structure (sub-file 142.01)
"RTN","GMTSOBI",90,0)
 S (GMTSI,GMTS3,GMTS4)=0 F  S GMTSI=$O(^GMT(142,GMTSDAT,1,GMTSI)) Q:+GMTSI=0  D
"RTN","GMTSOBI",91,0)
 . S GMTS3=GMTSI,GMTS4=GMTS4+1
"RTN","GMTSOBI",92,0)
 S:GMTS3>0&(GMTS4>0)&($D(^GMT(142,GMTSDAT,1,0))) ^GMT(142,+GMTSDAT,1,0)="^142.01IA^"_GMTS3_"^"_GMTS4
"RTN","GMTSOBI",93,0)
 Q
"RTN","GMTSOBI",94,0)
HSO ; Install Health Summary Object
"RTN","GMTSOBI",95,0)
 ;   Needs GMTSRTN, GMTSDAO,GMTSUSR
"RTN","GMTSOBI",96,0)
 Q:+($G(GMTSQIT))>0  N GMTSQIT,GMTSROK,GMTSTXT,GMTSOBJ,GMTSNDD,GMTSTR,GMTSRT,DA,DIK
"RTN","GMTSOBI",97,0)
 S GMTSQIT=0,GMTSROK=$$ROK^GMTSOBU(GMTSRTN) Q:GMTSROK'>0
"RTN","GMTSOBI",98,0)
 S GMTSTXT=$$TX^GMTSOBU(GMTSRTN,"OBJ",1),GMTSOBJ=$P(GMTSTXT,";",2,299)
"RTN","GMTSOBI",99,0)
 S GMTSTXT=$$TX^GMTSOBU(GMTSRTN,"OBJ",2),$P(GMTSTXT,"^",17)=GMTSUSR,GMTSNDD=GMTSTXT
"RTN","GMTSOBI",100,0)
 S GMTSTR=$P(GMTSNDD,";",2),GMTSNDD=$P(GMTSNDD,";",3,299)
"RTN","GMTSOBI",101,0)
 S GMTSRT="^GMT(142.5,DA,"_GMTSTR_")",DA=GMTSDAO,DIK="^GMT(142.5,"
"RTN","GMTSOBI",102,0)
 S $P(GMTSNDD,"^",3)=+($G(GMTSDAT)),$P(GMTSNDD,"^",17)=+($G(GMTSUSR))
"RTN","GMTSOBI",103,0)
 S $P(GMTSNDD,"^",18)=$$NOW^XLFDT H 1 S $P(GMTSNDD,"^",19)=$$NOW^XLFDT
"RTN","GMTSOBI",104,0)
 S $P(GMTSNDD,"^",20)=0,@GMTSRT=GMTSNDD D IX1^DIK
"RTN","GMTSOBI",105,0)
 Q
"RTN","GMTSOBI",106,0)
DELERR ; Delete on Error
"RTN","GMTSOBI",107,0)
 I +($G(GMTSDAT))>0,+($G(GMTSDAO))'>0 D
"RTN","GMTSOBI",108,0)
 . D DI(+($G(GMTSDAT)),"^GMT(142,")
"RTN","GMTSOBI",109,0)
 . W !," An error has occurred while installing Health Summary Object"
"RTN","GMTSOBI",110,0)
 . W !," Deleting the associated Health Summary Type"
"RTN","GMTSOBI",111,0)
 I +($G(GMTSDAT))'>0,+($G(GMTSDAO))>0 D
"RTN","GMTSOBI",112,0)
 . D DI(+($G(GMTSDAO)),"^GMT(142.5,")
"RTN","GMTSOBI",113,0)
 . W !," An error has occurred while installing Health Summary Type"
"RTN","GMTSOBI",114,0)
 . W !," Deleting the associated Health Summary Object"
"RTN","GMTSOBI",115,0)
 I +($G(GMTSDAT))>0&('$D(^GMT(142,+GMTSDAT))) D
"RTN","GMTSOBI",116,0)
 . D DI(+($G(GMTSDAT)),"^GMT(142,"),DEL(+($G(GMTSDAO)),"^GMT(142.5,")
"RTN","GMTSOBI",117,0)
 . W !," An error has occurred while installing Health Summary Type"
"RTN","GMTSOBI",118,0)
 . W !," Deleting the associated Health Summary Object"
"RTN","GMTSOBI",119,0)
 I +($G(GMTSDAO))>0&('$D(^GMT(142.5,+GMTSDAO))) D
"RTN","GMTSOBI",120,0)
 . D DI(+($G(GMTSDAT)),"^GMT(142,"),DEL(+($G(GMTSDAO)),"^GMT(142.5,")
"RTN","GMTSOBI",121,0)
 . W !," An error has occurred while installing Health Summary Object"
"RTN","GMTSOBI",122,0)
 . W !," Deleting the associated Health Summary Type"
"RTN","GMTSOBI",123,0)
 Q
"RTN","GMTSOBI",124,0)
DI(X,Y) ; Delete Item
"RTN","GMTSOBI",125,0)
 N DA,DIK S DA=+($G(X)),DIK=$G(Y) D:$L(DIK) ^DIK
"RTN","GMTSOBI",126,0)
 Q
"RTN","GMTSOBI",127,0)
DONE ; Completed
"RTN","GMTSOBI",128,0)
 I +($G(GMTSDAT))>0,+($G(GMTSDAO))>0 D
"RTN","GMTSOBI",129,0)
 . I $D(^GMT(142,+GMTSDAT,0)),$D(^GMT(142.5,+GMTSDAO,0)) D
"RTN","GMTSOBI",130,0)
 . . H 1 I $L(GMTSTN),$L(GMTSON) D  Q
"RTN","GMTSOBI",131,0)
 . . . W !!," Object '",GMTSON,"' installed using Health Summary Type '",GMTSTN,"'"
"RTN","GMTSOBI",132,0)
 . . W !," Object Installed"
"RTN","GMTSOBI",133,0)
 Q
"RTN","GMTSOBI",134,0)
DEL(X) ;   Delete Routine X
"RTN","GMTSOBI",135,0)
 S X=$G(X) Q:'$L(X)  Q:$L(X)>8  Q:$$ROK^GMTSOBU(X)=0  X ^%ZOSF("DEL") Q
"RTN","GMTSOBJ")
0^3^B46826782
"RTN","GMTSOBJ",1,0)
GMTSOBJ ; SLC/KER - HS Object - Create/Test/Display   ; 01/06/2003
"RTN","GMTSOBJ",2,0)
 ;;2.7;Health Summary;**58**;Oct 20, 1995
"RTN","GMTSOBJ",3,0)
 ;
"RTN","GMTSOBJ",4,0)
 ; External References
"RTN","GMTSOBJ",5,0)
 ;   DBIA  2320  $$DEL^%ZISH
"RTN","GMTSOBJ",6,0)
 ;   DBIA  2320  $$FTG^%ZISH
"RTN","GMTSOBJ",7,0)
 ;   DBIA  2320  $$PWD^%ZISH
"RTN","GMTSOBJ",8,0)
 ;   DBIA  2320  CLOSE^%ZISH
"RTN","GMTSOBJ",9,0)
 ;   DBIA  2320  OPEN^%ZISH
"RTN","GMTSOBJ",10,0)
 ;   DBIA 10006  ^DIC (file #142.5 and #2)
"RTN","GMTSOBJ",11,0)
 ;   DBIA 10013  ^DIK
"RTN","GMTSOBJ",12,0)
 ;   DBIA  2054  $$CREF^DILF
"RTN","GMTSOBJ",13,0)
 ;   DBIA  2054  $$OREF^DILF
"RTN","GMTSOBJ",14,0)
 ;   DBIA 10026  ^DIR
"RTN","GMTSOBJ",15,0)
 ;   DBIA 10103  $$NOW^XLFDT
"RTN","GMTSOBJ",16,0)
 ;                      
"RTN","GMTSOBJ",17,0)
 Q
"RTN","GMTSOBJ",18,0)
MGR ; Create/Modify Health Summary Object (Manager)
"RTN","GMTSOBJ",19,0)
 N GMTSMGR S GMTSMGR="" G OBJ
"RTN","GMTSOBJ",20,0)
 ;             
"RTN","GMTSOBJ",21,0)
DEVOBJ ; Create/Modify Health Summary Object (Developer)
"RTN","GMTSOBJ",22,0)
 N GMTSDEV S GMTSDEV=5000
"RTN","GMTSOBJ",23,0)
 ;             
"RTN","GMTSOBJ",24,0)
OBJ ; Create/Modify Health Summary Object
"RTN","GMTSOBJ",25,0)
 ;   Option:  GMTS OBJ ENTER/EDIT
"RTN","GMTSOBJ",26,0)
 ;            Create/Modify Health Summary Object
"RTN","GMTSOBJ",27,0)
 N BOLD,DA,DFN,DIC,DIE,DIR,DIROUT,DLAYGO,DR,DTOUT,DUOUT,GMP,GMTS
"RTN","GMTSOBJ",28,0)
 N GMTSBLK,GMTSCHD,GMTSCON,GMTSDEC,GMTSDEF,GMTSDIF,GMTSDLD,GMTSDT
"RTN","GMTSOBJ",29,0)
 N GMTSHDR,GMTSI,GMTSL,GMTSLBL,GMTSLEN,GMTSLIM,GMTSNEW,GMTSO,GMTSOBJ
"RTN","GMTSOBJ",30,0)
 N GMTSOBN,GMTSPER,GMTSPRO,GMTSPX1,GMTSPX2,GMTSQ,GMTSR,GMTSRDT,GMTSRHD
"RTN","GMTSOBJ",31,0)
 N GMTST,GMTSTD,GMTSTIM,GMTSTYP,GMTSUNIT,GMTSUNT,GMTSV,GMTSVER,GMTSX
"RTN","GMTSOBJ",32,0)
 N IOINHI,IOINORM,NORM,OBJ,D,D0,D1,DI,DILN,U,X,Y
"RTN","GMTSOBJ",33,0)
 S DIC("S")="I +Y<50000000!(+Y>59999999)" K:+($G(GMTSDEV))=5000 DIC("S")
"RTN","GMTSOBJ",34,0)
 D OBJ^GMTSOBA
"RTN","GMTSOBJ",35,0)
 Q
"RTN","GMTSOBJ",36,0)
 ;             
"RTN","GMTSOBJ",37,0)
CRE(NAME) ; Create/Modify Health Summary Object named 'NAME'
"RTN","GMTSOBJ",38,0)
 ;
"RTN","GMTSOBJ",39,0)
 ;   Input    NAME    Name of Object to Create or Edit
"RTN","GMTSOBJ",40,0)
 ;   Output   Internal Entry Number of Object file if 
"RTN","GMTSOBJ",41,0)
 ;            found or created
"RTN","GMTSOBJ",42,0)
 ;
"RTN","GMTSOBJ",43,0)
 N X,BOLD,DA,DFN,DIC,DIE,DIR,DIROUT,DLAYGO,DR,DTOUT,DUOUT,GMP,GMTS
"RTN","GMTSOBJ",44,0)
 N GMTSBLK,GMTSCHD,GMTSCON,GMTSDEC,GMTSDEF,GMTSDIF,GMTSDLD,GMTSDT
"RTN","GMTSOBJ",45,0)
 N GMTSHDR,GMTSI,GMTSL,GMTSLBL,GMTSLEN,GMTSLIM,GMTSNAM,GMTSNEW,GMTSO
"RTN","GMTSOBJ",46,0)
 N GMTSOBJ,GMTSOBN,GMTSPER,GMTSPRO,GMTSPX1,GMTSPX2,GMTSQ,GMTSR,GMTSRDT
"RTN","GMTSOBJ",47,0)
 N GMTSRHD,GMTST,GMTSTD,GMTSTIM,GMTSTYP,GMTSUNIT,GMTSUNT,GMTSV,GMTSVER
"RTN","GMTSOBJ",48,0)
 N GMTSX,IOINHI,IOINORM,NORM,OBJ,D,D0,D1,DI,DILN,U,Y S GMTSNAM=$G(NAME)
"RTN","GMTSOBJ",49,0)
 S:'$L(GMTSNAM) GMTSNAM=$$NAME^GMTSOBV("") Q:'$L(GMTSNAM) -1
"RTN","GMTSOBJ",50,0)
 S DIC("S")="I +Y<50000000!(+Y>59999999)" K:+($G(GMTSDEV))=5000 DIC("S")
"RTN","GMTSOBJ",51,0)
 D OBJ^GMTSOBA K DIC S DIC="^GMT(142.5,",DIC(0)="XM",X=GMTSNAM
"RTN","GMTSOBJ",52,0)
 D ^DIC,CRD^GMTSOBV(+Y),^DIC S X=+Y S:X'>0 X=-1
"RTN","GMTSOBJ",53,0)
 Q X
"RTN","GMTSOBJ",54,0)
 ;             
"RTN","GMTSOBJ",55,0)
TYPE(NAME) ; Edit Health Summary Type named NAME
"RTN","GMTSOBJ",56,0)
 ;
"RTN","GMTSOBJ",57,0)
 ;   Input    NAME    Name of Health Summary Type to Edit
"RTN","GMTSOBJ",58,0)
 ;   Output   None
"RTN","GMTSOBJ",59,0)
 D ET^GMTSOBA2($G(NAME))
"RTN","GMTSOBJ",60,0)
 Q
"RTN","GMTSOBJ",61,0)
 ;                    
"RTN","GMTSOBJ",62,0)
INQ ; Inquire to Health Summary Object
"RTN","GMTSOBJ",63,0)
 ;   Option:  GMTS OBJ INQ
"RTN","GMTSOBJ",64,0)
 ;            Health Summary Object Inquiry
"RTN","GMTSOBJ",65,0)
 N DIC,D,D0,D1,DI,DILN,GMTSP,GMTSPL,GMTSL,GMTSEXIT
"RTN","GMTSOBJ",66,0)
 S U="^",DIC="^GMT(142.5,",DIC(0)="AEMQF",GMTSP=$G(IOST),GMTSPL=0,GMTSL=0,GMTSEXIT=0
"RTN","GMTSOBJ",67,0)
 S DIC("A")=" Select Health Summary Object:  " D ^DIC K DIC("A")
"RTN","GMTSOBJ",68,0)
 W:$L($G(IOF)) @IOF W:+($G(Y))>0 ! D:+($G(Y))>0 SO^GMTSOBS(+Y),CONT^GMTSOBS
"RTN","GMTSOBJ",69,0)
 Q
"RTN","GMTSOBJ",70,0)
 ;             
"RTN","GMTSOBJ",71,0)
DEVDEL ; Delete Health Summary Object (Developer)
"RTN","GMTSOBJ",72,0)
 N GMTSDEV S GMTSDEV=5000
"RTN","GMTSOBJ",73,0)
 ;             
"RTN","GMTSOBJ",74,0)
DEL ; Delete Health Summary Object
"RTN","GMTSOBJ",75,0)
 ;   Option:  GMTS OBJ DELETE
"RTN","GMTSOBJ",76,0)
 ;            Delete Health Summary Object
"RTN","GMTSOBJ",77,0)
 N D,D0,D1,DI,DILN,DIC,DIR,DIK,DA,X,Y,GMTSP,GMTSPL,GMTSL,GMTSEXIT S U="^",(DIK,DIC)="^GMT(142.5,",DIC(0)="AEMQF"
"RTN","GMTSOBJ",78,0)
 I $$UACT^GMTSU2(+($G(DUZ)))'>0 W !!," >> You are not authorized to delete a Health Summary Object." Q
"RTN","GMTSOBJ",79,0)
 S DIC("A")=" Select Health Summary Object to Delete:  "
"RTN","GMTSOBJ",80,0)
 S DIC("S")="I (+($P($G(^GMT(142.5,+Y,0)),""^"",17))=0!(+($P($G(^GMT(142.5,+Y,0)),""^"",17))=+($G(DUZ))))&(+($P($G(^GMT(142.5,+Y,0)),""^"",20))'>0)"
"RTN","GMTSOBJ",81,0)
 S:'$D(GMTSDEV) DIC("S")="I +($$DEL^GMTSOBV(+Y))>0"
"RTN","GMTSOBJ",82,0)
 K:$D(GMTSDEV) DIC("S") I +($G(Y))>50000000,+($G(Y))<59999999,'$D(GMTSDEV) W !,"     Can not delete a nationally exported object." Q
"RTN","GMTSOBJ",83,0)
 D ^DIC I +($G(Y))>0 D
"RTN","GMTSOBJ",84,0)
 . N GMTSDEL,GMTSO S GMTSDEL="" W ! D SO^GMTSOBS(+Y)
"RTN","GMTSOBJ",85,0)
 . S DA=+Y,GMTSO=$P($G(^GMT(142.5,+Y,0)),"^",1)
"RTN","GMTSOBJ",86,0)
 . S:$L(GMTSO) GMTSO=" """_GMTSO_""""
"RTN","GMTSOBJ",87,0)
 . S DIR("B")="NO",DIR(0)="YAO",DIR("A")=" Delete Health Summary Object"_GMTSO_"?  "
"RTN","GMTSOBJ",88,0)
 . S (DIR("?"),DIR("??"))="     Enter either 'Y' or 'N'."
"RTN","GMTSOBJ",89,0)
 . W ! D ^DIR I +Y>0 D ^DIK
"RTN","GMTSOBJ",90,0)
 . I '$D(^GMT(142.5,+DA,0)) W !,"     <deleted>",!
"RTN","GMTSOBJ",91,0)
 Q
"RTN","GMTSOBJ",92,0)
 ;             
"RTN","GMTSOBJ",93,0)
TEST ; Test Health Summary Object
"RTN","GMTSOBJ",94,0)
 ;   Option:  GMTS OBJ TEST
"RTN","GMTSOBJ",95,0)
 ;            Test a Health Summary Object
"RTN","GMTSOBJ",96,0)
 N BOLD,D,D0,D1,DI,DILN,DA,DFN,DIC,DIE,DIR,DIROUT,DLAYGO,DR,DTOUT
"RTN","GMTSOBJ",97,0)
 N DUOUT,GMP,GMTS,GMTSBLK,GMTSCHD,GMTSCON,GMTSDEC,GMTSDEF,GMTSDIF
"RTN","GMTSOBJ",98,0)
 N GMTSDLD,GMTSDT,GMTSHDR,GMTSI,GMTSL,GMTSLBL,GMTSLEN,GMTSLIM,GMTSNEW
"RTN","GMTSOBJ",99,0)
 N GMTSO,GMTSOBJ,GMTSOBN,GMTSPER,GMTSPRO,GMTSPX1,GMTSPX2,GMTSQ,GMTSR
"RTN","GMTSOBJ",100,0)
 N GMTSRDT,GMTSRHD,GMTST,GMTSTD,GMTSTIM,GMTSTYP,GMTSUNIT,GMTSUNT
"RTN","GMTSOBJ",101,0)
 N GMTSV,GMTSVER,GMTSX,IOINHI,IOINORM,NORM,OBJ,X,Y
"RTN","GMTSOBJ",102,0)
 D PAT^GMTSOBV I +($G(DFN))'>0 W !!,"    No Patient Selected" Q
"RTN","GMTSOBJ",103,0)
 S GMTSL=$G(IOSL) N IOSL S IOSL=99999999
"RTN","GMTSOBJ",104,0)
 S DIC="^GMT(142.5,",DIC("A")=" Select HEALTH SUMMARY OBJECT to test:  ",U="^"
"RTN","GMTSOBJ",105,0)
 S DIC(0)="AEMQ" K DLAYGO D ^DIC S GMTSOBJ=+($G(Y))
"RTN","GMTSOBJ",106,0)
 I +GMTSOBJ'>0 W !!,"    No Health Summary Object Selected" Q
"RTN","GMTSOBJ",107,0)
 K ^TMP("GMTSOBJ",$J,DFN) D GET(DFN,GMTSOBJ),DEV^GMTSOBS
"RTN","GMTSOBJ",108,0)
 Q
"RTN","GMTSOBJ",109,0)
 ;             
"RTN","GMTSOBJ",110,0)
EXP ; Export a Health Summary Object
"RTN","GMTSOBJ",111,0)
 D EN^GMTSOBE
"RTN","GMTSOBJ",112,0)
 Q
"RTN","GMTSOBJ",113,0)
 ;             
"RTN","GMTSOBJ",114,0)
INS ; Install Imported Health Summary Object
"RTN","GMTSOBJ",115,0)
 D EN^GMTSOBI
"RTN","GMTSOBJ",116,0)
 Q
"RTN","GMTSOBJ",117,0)
 ;             
"RTN","GMTSOBJ",118,0)
GET(DFN,OBJ) ; Get Health Summary Object
"RTN","GMTSOBJ",119,0)
 ;
"RTN","GMTSOBJ",120,0)
 ;   Input    DFN     IEN for Patient (#2)
"RTN","GMTSOBJ",121,0)
 ;            OBJ     IEN for Health Summary Object (#142.5)
"RTN","GMTSOBJ",122,0)
 ;
"RTN","GMTSOBJ",123,0)
 ;   Output   Global array of Health Summary data
"RTN","GMTSOBJ",124,0)
 ;
"RTN","GMTSOBJ",125,0)
 ;                    ^TMP("GMTSOBJ",$J,DFN,#,0)
"RTN","GMTSOBJ",126,0)
 ;
"RTN","GMTSOBJ",127,0)
 K ^TMP("GMTSOBJ",$J,DFN) D ARY(DFN,OBJ,$NA(^TMP("GMTSOBJ",$J,DFN)))
"RTN","GMTSOBJ",128,0)
 Q
"RTN","GMTSOBJ",129,0)
 ;             
"RTN","GMTSOBJ",130,0)
TIU(DFN,OBJ) ; Get Health Summary Object (TIU)
"RTN","GMTSOBJ",131,0)
 ;
"RTN","GMTSOBJ",132,0)
 ;   Input    DFN     IEN for Patient (#2)
"RTN","GMTSOBJ",133,0)
 ;            OBJ     IEN for Health Summary Object (#142.5)
"RTN","GMTSOBJ",134,0)
 ;
"RTN","GMTSOBJ",135,0)
 ;   Output   Global array of Health Summary data
"RTN","GMTSOBJ",136,0)
 ;
"RTN","GMTSOBJ",137,0)
 ;                    ^TMP("TIUHSOBJ",$J,"FGBL",0)
"RTN","GMTSOBJ",138,0)
 ;                    ^TMP("TIUHSOBJ",$J,"FGBL",#,0)
"RTN","GMTSOBJ",139,0)
 ;
"RTN","GMTSOBJ",140,0)
 K ^TMP("TIUHSOBJ",$J) D ARY(DFN,OBJ,$NA(^TMP("TIUHSOBJ",$J,"FGBL")))
"RTN","GMTSOBJ",141,0)
 Q:+($G(^TMP("TIUHSOBJ",$J,"FGBL",0)))>0 "~@"_$NA(^TMP("TIUHSOBJ",$J,"FGBL"))
"RTN","GMTSOBJ",142,0)
 Q "No Health Summary Report Found"
"RTN","GMTSOBJ",143,0)
 ;             
"RTN","GMTSOBJ",144,0)
ARY(DFN,OBJ,ROOT) ; Build Array ROOT
"RTN","GMTSOBJ",145,0)
 ;
"RTN","GMTSOBJ",146,0)
 ;   Input    DFN     IEN for Patient (#2)
"RTN","GMTSOBJ",147,0)
 ;            OBJ     IEN for Health Summary Object (#142.5)
"RTN","GMTSOBJ",148,0)
 ;            ROOT    Closed root (global or local array)
"RTN","GMTSOBJ",149,0)
 ;
"RTN","GMTSOBJ",150,0)
 ;   Output   Array of Health Summary data in ROOT
"RTN","GMTSOBJ",151,0)
 ;
"RTN","GMTSOBJ",152,0)
 N GMTSBLK,GMTSFILE,GMTSHFN,GMTSNC,GMTSNCT,GMTSND,GMTSNDT,GMTSNN,GMTSIOM
"RTN","GMTSOBJ",153,0)
 N GMTSPATH,GMTSPRE,GMTSRT,GMTSRTO,GMTSRTC,GMTSRNN,GMTSRNC,GMTS0,POP,X,Y
"RTN","GMTSOBJ",154,0)
 Q:$G(^GMT(142.5,+($G(OBJ)),0))=""  S GMTSRT=$G(ROOT)
"RTN","GMTSOBJ",155,0)
 Q:'$L(GMTSRT)  Q:$E(GMTSRT,1)'="^"&($E(GMTSRT,1)'?1U)
"RTN","GMTSOBJ",156,0)
 S GMTSRTO=$$OREF^DILF(GMTSRT),GMTSRTC=$$CREF^DILF(GMTSRT)
"RTN","GMTSOBJ",157,0)
 Q:'$L(GMTSRTO)  Q:'$L(GMTSRTC)  Q:'$L($TR(GMTSRTC,")",""))
"RTN","GMTSOBJ",158,0)
 Q:$E(GMTSRTO,$L(GMTSRTO))'=","&($E(GMTSRTO,$L(GMTSRTO))'="(")
"RTN","GMTSOBJ",159,0)
 Q:GMTSRTO'[$TR(GMTSRTC,")","")  S GMTS0=GMTSRTO_"0)"
"RTN","GMTSOBJ",160,0)
 S GMTSPATH=$$PWD^%ZISH,GMTSFILE=$J_$TR($$NOW^XLFDT,".","")_".DAT"
"RTN","GMTSOBJ",161,0)
 D OPEN^%ZISH("WRITEFILE",GMTSPATH,GMTSFILE,"W"),DIS(+($G(DFN)),+($G(OBJ)))
"RTN","GMTSOBJ",162,0)
 D CLOSE^%ZISH("WRITEFILE") K ^TMP("GMTSOBJ",$J,"OGBL")
"RTN","GMTSOBJ",163,0)
 S Y=$$FTG^%ZISH(GMTSPATH,GMTSFILE,$NA(^TMP("GMTSOBJ",$J,"OGBL",1)),4)
"RTN","GMTSOBJ",164,0)
 S GMTSHFN(GMTSFILE)="",Y=$$DEL^%ZISH(GMTSPATH,$NA(GMTSHFN))
"RTN","GMTSOBJ",165,0)
 S (GMTSBLK,GMTSNCT,GMTSPRE)=0 S GMTSNN="^TMP(""GMTSOBJ"","_$J_",""OGBL"")"
"RTN","GMTSOBJ",166,0)
 S GMTSNC="^TMP(""GMTSOBJ"","_$J_",""OGBL"","
"RTN","GMTSOBJ",167,0)
 F  S GMTSNN=$Q(@GMTSNN) Q:GMTSNN=""!(GMTSNN'[GMTSNC)  D
"RTN","GMTSOBJ",168,0)
 . S GMTSND=@GMTSNN,GMTSNDT=$$TRIM^GMTSOBV(GMTSND)
"RTN","GMTSOBJ",169,0)
 . I 'GMTSBLK S:GMTSNDT="" GMTSBLK=1 Q:GMTSBLK
"RTN","GMTSOBJ",170,0)
 . Q:GMTSPRE&(GMTSNDT="")  S GMTSNCT=GMTSNCT+1
"RTN","GMTSOBJ",171,0)
 . S @(GMTSRTO_GMTSNCT_",0)")=GMTSND
"RTN","GMTSOBJ",172,0)
 . S @GMTS0=$G(@GMTS0)+1
"RTN","GMTSOBJ",173,0)
 . S GMTSPRE=$S(GMTSNDT="":1,1:0)
"RTN","GMTSOBJ",174,0)
 K ^TMP("GMTSOBJ",$J,"OGBL")
"RTN","GMTSOBJ",175,0)
 Q
"RTN","GMTSOBJ",176,0)
 ;             
"RTN","GMTSOBJ",177,0)
SHOW(X) ; Show a Health Summary Object Definition
"RTN","GMTSOBJ",178,0)
 ;
"RTN","GMTSOBJ",179,0)
 ;   Input    X       IEN for Health Summary Object (#142.5)
"RTN","GMTSOBJ",180,0)
 ;                          
"RTN","GMTSOBJ",181,0)
 D SO^GMTSOBS(+($G(X)))
"RTN","GMTSOBJ",182,0)
 Q
"RTN","GMTSOBJ",183,0)
EXTRACT(X,ARY) ; Show a Health Summary Object Definition
"RTN","GMTSOBJ",184,0)
 ;
"RTN","GMTSOBJ",185,0)
 ;   Input    X       IEN for Health Summary Object (#142.5)
"RTN","GMTSOBJ",186,0)
 ;   Output   ARY()   Array of fields and values
"RTN","GMTSOBJ",187,0)
 ;                    (passed by reference)
"RTN","GMTSOBJ",188,0)
 ;                           
"RTN","GMTSOBJ",189,0)
 ;      ARY(IEN,<field #>,"I") = Internal Value
"RTN","GMTSOBJ",190,0)
 ;      ARY(IEN,<field #>,"E") = External Value
"RTN","GMTSOBJ",191,0)
 ;      ARY(IEN,<field #>,"NAME") = Field Name
"RTN","GMTSOBJ",192,0)
 ;      ARY(IEN,<field #>,"PROMT") = Mixed Case of Field Name
"RTN","GMTSOBJ",193,0)
 ;                
"RTN","GMTSOBJ",194,0)
 D GET^GMTSOBS2(+($G(X)),.ARY)
"RTN","GMTSOBJ",195,0)
 Q
"RTN","GMTSOBJ",196,0)
DEF(X,ARY) ; Extract a Health Summary Object Definition
"RTN","GMTSOBJ",197,0)
 ;
"RTN","GMTSOBJ",198,0)
 ;   Input    X       IEN for Health Summary Object (#142.5)
"RTN","GMTSOBJ",199,0)
 ;   Output   ARY()   Array of fields and values
"RTN","GMTSOBJ",200,0)
 ;                    (passed by reference)
"RTN","GMTSOBJ",201,0)
 ;                           
"RTN","GMTSOBJ",202,0)
 ;      ARY("D",0) = # of lines in Definition
"RTN","GMTSOBJ",203,0)
 ;      ARY("D",#) = Definition Text
"RTN","GMTSOBJ",204,0)
 ;      ARY("E",0) = # of lines in Example
"RTN","GMTSOBJ",205,0)
 ;      ARY("E",#) = Example Text
"RTN","GMTSOBJ",206,0)
 ;                
"RTN","GMTSOBJ",207,0)
 D DEF^GMTSOBS(+($G(X)),.ARY)
"RTN","GMTSOBJ",208,0)
 Q
"RTN","GMTSOBJ",209,0)
DIS(DFN,OBJ) ; Display Object
"RTN","GMTSOBJ",210,0)
 ;
"RTN","GMTSOBJ",211,0)
 ;   Input    DFN     IEN for Patient (#2)
"RTN","GMTSOBJ",212,0)
 ;            OBJ     IEN for Health Summary Object (#142.5)
"RTN","GMTSOBJ",213,0)
 ;
"RTN","GMTSOBJ",214,0)
 ;   Output   Display of Health Summary data
"RTN","GMTSOBJ",215,0)
 ;
"RTN","GMTSOBJ",216,0)
 D DIS^GMTSOBS2(+($G(DFN)),$G(OBJ))
"RTN","GMTSOBJ",217,0)
 Q
"RTN","GMTSOBJ",218,0)
STMP ; Show TMP
"RTN","GMTSOBJ",219,0)
 N GMTSNN,GMTSNC S GMTSNN="^TMP(""GMTSOBJ"","_$J_",""OGBL"")",GMTSNC="^TMP(""GMTSOBJ"","_$J_",""OGBL"","
"RTN","GMTSOBJ",220,0)
 F  S GMTSNN=$Q(@GMTSNN) Q:GMTSNN=""!(GMTSNN'[GMTSNC)  W !,GMTSNN,"=",@GMTSNN
"RTN","GMTSOBJ",221,0)
 Q
"RTN","GMTSOBL")
0^8^B64743466
"RTN","GMTSOBL",1,0)
GMTSOBL ; SLC/KER - HS Object - Lookup                 ; 01/06/2003
"RTN","GMTSOBL",2,0)
 ;;2.7;Health Summary;**58**;Oct 20, 1995
"RTN","GMTSOBL",3,0)
 ;                
"RTN","GMTSOBL",4,0)
 ; External References
"RTN","GMTSOBL",5,0)
 ;   DBIA 10006  ^DIC  (file #142.5)
"RTN","GMTSOBL",6,0)
 ;   DBIA 10018  ^DIE  (file #142 and 142.5)
"RTN","GMTSOBL",7,0)
 ;   DBIA 10013  ^DIK  (file #142 and 142.5)
"RTN","GMTSOBL",8,0)
 ;   DBIA 10026  ^DIR        
"RTN","GMTSOBL",9,0)
 ;   DBIA 10010  EN1^DIP
"RTN","GMTSOBL",10,0)
 ;   DBIA 10076  ^XUSEC(
"RTN","GMTSOBL",11,0)
 ;   DBIA 10076  ^XUSEC("GMTSMGR")
"RTN","GMTSOBL",12,0)
 ;   DBIA 10112  $$SITE^VASITE
"RTN","GMTSOBL",13,0)
 ;   DBIA 10103  $$NOW^XLFDT 
"RTN","GMTSOBL",14,0)
 ;                       
"RTN","GMTSOBL",15,0)
 Q
"RTN","GMTSOBL",16,0)
OBJ(X) ; Lookup HS Object
"RTN","GMTSOBL",17,0)
 Q:+($G(DUZ))'>0 -1  N DIR,DIC,DTOUT,DUOUT,DIROUT,DLAYGO,DA,D,D0,D1,DI,DQ,Y S U="^"
"RTN","GMTSOBL",18,0)
 S DIC="^GMT(142.5,",DIC(0)="AEMQ",DIC("A")=" Select HEALTH SUMMARY OBJECT:  " K DLAYGO D ^DIC
"RTN","GMTSOBL",19,0)
 S:+($$ABT)>0 Y=-1 S X=+($G(Y))
"RTN","GMTSOBL",20,0)
 Q X
"RTN","GMTSOBL",21,0)
HSO(X) ; Lookup HS Object (by Known Name)
"RTN","GMTSOBL",22,0)
 I +($G(DUZ))'>0 S GMTSQ=1 Q -1
"RTN","GMTSOBL",23,0)
 N GMTSOWN,GMTSDICS,GMTSNAM,GMTSIEN,GMTSNEW
"RTN","GMTSOBL",24,0)
 N DIR,DIC,DTOUT,DUOUT,DIROUT,DLAYGO,DINUM,DA,D,D0,D1,DI,DQ,Y,GMTSL,GMTSH,GMTSS,GMTSTA S U="^"
"RTN","GMTSOBL",25,0)
 S GMTSNAM=$G(X),GMTSNEW=0,GMTSOWN="",GMTSQ=0 I '$L(GMTSNAM) S GMTSQ=1 Q -1
"RTN","GMTSOBL",26,0)
 S X=GMTSNAM I '$L(X) S X=-1,GMTSQ=1 Q X
"RTN","GMTSOBL",27,0)
 S DIC="^GMT(142.5,",DIC(0)="XML",DLAYGO=142.5 S:$L($G(GMTSDICS)) DIC("S")=$G(GMTSDICS)
"RTN","GMTSOBL",28,0)
 S GMTSTA=+($P($$SITE^VASITE,"^",3)) I +GMTSTA'>0 S X=-1,GMTSQ=1 Q X
"RTN","GMTSOBL",29,0)
 S GMTSS=+($G(GMTSTA)) S:$D(GMTSDEV) GMTSS=5000 S GMTSL=GMTSS_"0000"
"RTN","GMTSOBL",30,0)
 S GMTSH=GMTSS_"9999" S GMTSH=($O(^GMT(142.5,+GMTSH),-1)+1)
"RTN","GMTSOBL",31,0)
 S:+GMTSH<+GMTSL GMTSH=+GMTSS_"0001" S:+GMTSH>0 DINUM=+GMTSH
"RTN","GMTSOBL",32,0)
 D ^DIC I +($$ABT)>0 S GMTSQ=1,X=-1 Q X
"RTN","GMTSOBL",33,0)
 S GMTSNEW=+($P(Y,"^",3))
"RTN","GMTSOBL",34,0)
 I +Y'>0 S X=-1 Q X
"RTN","GMTSOBL",35,0)
 S X=+($G(Y))_"^"_$P($G(^GMT(142.5,+($G(Y)),0)),"^",1) S:+GMTSNEW>0 $P(X,"^",3)=+GMTSNEW
"RTN","GMTSOBL",36,0)
 W:GMTSNEW>0 !,"Creating Health Summary Object '",GMTSNAM,"'"
"RTN","GMTSOBL",37,0)
 S:+GMTSNEW>0 X=$$EE(Y) I +($G(GMTSQ))>1 S X=-1 Q
"RTN","GMTSOBL",38,0)
 S:+X'>0 X=-1 I +($G(GMTSQ))=0 D
"RTN","GMTSOBL",39,0)
 . D:+GMTSNEW>0&(+X>0) NEW^GMTSOBL2(+X)
"RTN","GMTSOBL",40,0)
 . D:+GMTSNEW'>0&(+X>0) MOD^GMTSOBL2(+X)
"RTN","GMTSOBL",41,0)
 Q X
"RTN","GMTSOBL",42,0)
LK(X) ; Lookup HS Object (Learn as you go)
"RTN","GMTSOBL",43,0)
 Q:+($G(DUZ))'>0 -1  N GMTSDICS,GMTSB S GMTSDICS=$G(DIC("S")) K DIC("S") S GMTSDICS=$$DIM^GMTSOBL2(GMTSDICS),GMTSB=$P($$B^GMTSOBL2,"^",2)
"RTN","GMTSOBL",44,0)
 N DIR,DIC,DTOUT,DUOUT,DIROUT,DLAYGO,DA,D,D0,D1,DI,DQ,GMTSNAM,GMTSTA
"RTN","GMTSOBL",45,0)
 N GMTS,GMTSTD,GMTSOBJ,GMTSOBN,GMTSDT,GMTSNEW,GMTSDEF,GMTSDA,Y,X1 S U="^"
"RTN","GMTSOBL",46,0)
 S GMTSNEW=0,GMTSTA=+($P($$SITE^VASITE,"^",3)) Q:+GMTSTA=0 -1
"RTN","GMTSOBL",47,0)
 S DIR(0)="FAO^1:30^S:X="" "" (X,X1)=$G(GMTSB) K:$L(X)<3&(X'="" "") X"
"RTN","GMTSOBL",48,0)
 S DIR("A")=" Select HEALTH SUMMARY OBJECT:  ",(DIR("?"),DIR("??"))="^D NAH^GMTSOBL2"
"RTN","GMTSOBL",49,0)
 D ^DIR Q:'$L(Y)!(Y["^") -1  S GMTSNAM=Y
"RTN","GMTSOBL",50,0)
 S DIC="^GMT(142.5,",DIC(0)="EM" S:$L($G(GMTSDICS)) DIC("S")=$G(GMTSDICS)
"RTN","GMTSOBL",51,0)
 W ! D ^DIC
"RTN","GMTSOBL",52,0)
 I +($$ABT)>0 S GMTSQ=1,Y=-1,X=-1 Q X
"RTN","GMTSOBL",53,0)
 I +Y'>0 D  Q:+Y'>0 -1
"RTN","GMTSOBL",54,0)
 . N X,DIC,DINUM,GMTSL,GMTSH,GMTSS S GMTSS=+($G(GMTSTA)) S:$D(GMTSDEV) GMTSS=5000
"RTN","GMTSOBL",55,0)
 . S X=$G(GMTSNAM) Q:'$L(X)  S GMTSL=GMTSS_"0000"
"RTN","GMTSOBL",56,0)
 . S GMTSH=GMTSS_"9999",GMTSH=($O(^GMT(142.5,+GMTSH),-1)+1)
"RTN","GMTSOBL",57,0)
 . S:+GMTSH<+GMTSL GMTSH=+GMTSS_"0001" S:+GMTSH>0 DINUM=+GMTSH
"RTN","GMTSOBL",58,0)
 . S DIC="^GMT(142.5,",DIC(0)="EML",DLAYGO=142.5
"RTN","GMTSOBL",59,0)
 . S:$L($G(GMTSDICS)) DIC("S")=$G(GMTSDICS) D ^DIC
"RTN","GMTSOBL",60,0)
 . S GMTSNEW=+($P(Y,"^",3))
"RTN","GMTSOBL",61,0)
 . I +($$ABT)>0 S GMTSQ=1
"RTN","GMTSOBL",62,0)
 I +($G(GMTSQ))>0 S Y=-1,X=-1 Q X
"RTN","GMTSOBL",63,0)
 S X=+($G(Y))_"^"_$P($G(^GMT(142.5,+($G(Y)),0)),"^",1)
"RTN","GMTSOBL",64,0)
 S:+GMTSNEW>0 $P(X,"^",3)=+GMTSNEW S X=$$EE(Y) S:+X'>0 X=-1 I +X'>0 S GMTSQ=1,Y=-1,X=-1 Q X
"RTN","GMTSOBL",65,0)
 I +($G(GMTSQ))=0 D:+GMTSNEW>0&(+X>0) NEW^GMTSOBL2(+X) D:+GMTSNEW'>0&(+X>0) MOD^GMTSOBL2(+X)
"RTN","GMTSOBL",66,0)
 Q X
"RTN","GMTSOBL",67,0)
EE(X) ; Enter/Edit
"RTN","GMTSOBL",68,0)
 N GMTSOBJ,DA,GMTSY,GMTSNAM,GMTSTYP,GMTSDICS,GMTSDICA,GMTSDICB,Y S Y=$G(X) S (GMTSOBJ,DA,X)=+($G(Y)),GMTSY=$G(Y)
"RTN","GMTSOBL",69,0)
 S GMTSTYP=$P($G(^GMT(142.5,+DA,0)),"^",3),GMTSTYP=$P($G(^GMT(142,+GMTSTYP,0)),"^",1)
"RTN","GMTSOBL",70,0)
 S GMTSNEW=$S(+($P($G(Y),U,3))>0:1,1:0) I GMTSNEW>0 D
"RTN","GMTSOBL",71,0)
 . S $P(^GMT(142.5,+DA,0),"^",20)=$S($D(GMTSDEV):1,1:0)
"RTN","GMTSOBL",72,0)
 S GMTSDT=$$NOW^XLFDT,GMTSOBN=$P($G(^GMT(142.5,+X,0)),U,1)
"RTN","GMTSOBL",73,0)
 I $D(GMTSOWN) D  I X'>0 S GMTSQ=1 Q X
"RTN","GMTSOBL",74,0)
 . N GMTSCRE S GMTSCRE=$P($G(^GMT(142.5,+X,0)),"^",17) Q:+GMTSCRE'>0
"RTN","GMTSOBL",75,0)
 . I GMTSNEW'>0,GMTSCRE'=DUZ W !!,"    Sorry, you can not edit someone else's object." S X=-1
"RTN","GMTSOBL",76,0)
 I GMTSNEW>0,+DA>0,$D(^GMT(142.5,+DA,0)) D
"RTN","GMTSOBL",77,0)
 . S $P(^GMT(142.5,+DA,0),U,17)=+($G(DUZ)),$P(^GMT(142.5,+DA,0),U,18)=+GMTSDT
"RTN","GMTSOBL",78,0)
 I +X>0 D  Q:$G(X)=-1!($G(DA)=-1)!($G(Y)=-1) -1
"RTN","GMTSOBL",79,0)
 . N DIR,DIC,DTOUT,DUOUT,DIROUT,DLAYGO,X,Y,GMTSDEF,GMTSD,GMTSDA
"RTN","GMTSOBL",80,0)
 . S GMTSDA=+DA,GMTSD=""
"RTN","GMTSOBL",81,0)
 . ; Type
"RTN","GMTSOBL",82,0)
 . S GMTSDEF=$P($G(^GMT(142.5,+DA,0)),U,3),GMTSD=$P($G(^GMT(142,+GMTSDEF,0)),"^",1)
"RTN","GMTSOBL",83,0)
 . S:$L(GMTSD) DIC("B")=GMTSDEF S DIC("A")=" Select HEALTH SUMMARY TYPE:  "
"RTN","GMTSOBL",84,0)
 . S:$D(GMTSDEV) DIC("S")="I +($G(^GMT(142,+Y,""VA"")))>0"
"RTN","GMTSOBL",85,0)
 . D K S GMTS=$$TY(GMTSDEF)
"RTN","GMTSOBL",86,0)
 . I +($$ABT)>0 D  Q
"RTN","GMTSOBL",87,0)
 . . W !,"<<<<<< ABORT >>>>>>"
"RTN","GMTSOBL",88,0)
 . . S GMTSQ=1,X=-1 I +($G(GMTSNEW))>0 S DIK="^GMT(142.5,",DA=GMTSDA D ^DIK
"RTN","GMTSOBL",89,0)
 . I $G(X)="@" S GMTSQ=1 S:$L(GMTSDEF) GMTS=GMTSD_"^"_GMTSDEF D NT^GMTSOBL2(GMTSY) Q
"RTN","GMTSOBL",90,0)
 . I +GMTS'>0,+DA>0,GMTSNEW>0 S GMTSQ=1 D NT^GMTSOBL2(GMTSY) Q
"RTN","GMTSOBL",91,0)
 . I +GMTS>0,+DA>0 D  Q:$G(X)=-1!($G(DA)=-1)!($G(Y)=-1)  Q:+($G(GMTSQ))>0
"RTN","GMTSOBL",92,0)
 . . N GMTSED,DIE,DR,GMTSI,GMTST,GMTSV,GMTSDT S GMTSDT=$$NOW^XLFDT
"RTN","GMTSOBL",93,0)
 . . S GMTSV=+($G(GMTS)),DIE="^GMT(142.5,",DR=".03////^S X=$G(GMTSV)"
"RTN","GMTSOBL",94,0)
 . . S GMTSED=0 F GMTSI=1:1:3 Q:GMTSI>3  L +^GMT(142.5):0 H:'$T 1 I $T D
"RTN","GMTSOBL",95,0)
 . . . D ^DIE S GMTSED=1 S $P(^GMT(142.5,+DA,0),U,19)=$$NOW^XLFDT,GMTSI=4
"RTN","GMTSOBL",96,0)
 . . I 'GMTSED S GMTSQ=1 K GMTSOBJ W !,"  Record Locked by another user" Q
"RTN","GMTSOBL",97,0)
 . . L -^GMT(142.5) S GMTST=+($P($G(^GMT(142.5,+DA,0)),U,3))
"RTN","GMTSOBL",98,0)
 . . I +GMTST'>0,+DA>0 D NT^GMTSOBL2(GMTSY) Q
"RTN","GMTSOBL",99,0)
 S X=+($G(DA))_"^"_$P($G(^GMT(142.5,+($G(DA)),0)),"^",1)
"RTN","GMTSOBL",100,0)
 S:+GMTSNEW>0 X=X_"^"_+GMTSNEW
"RTN","GMTSOBL",101,0)
 S X=$$VER^GMTSOBL2(X)
"RTN","GMTSOBL",102,0)
 Q X
"RTN","GMTSOBL",103,0)
TYPE(GMTS) ; Lookup HS Type
"RTN","GMTSOBL",104,0)
 F  S GMTS=$$TYPE^GMTSOBT Q:+GMTS>0!(X="@")!(X["^")!(X="")
"RTN","GMTSOBL",105,0)
 S:X["^" X="^" S:X["^"!(X="@")!(X="") GMTS=-1
"RTN","GMTSOBL",106,0)
 Q GMTS
"RTN","GMTSOBL",107,0)
TY(GMTS) ; Lookup HS Type   (Learn as you go)
"RTN","GMTSOBL",108,0)
 N ADEL,B,BY,CHANGE,CNT,DA,DHD,DIC,DIE,DIK,DIR,DLAYGO,DR
"RTN","GMTSOBL",109,0)
 N EXISTS,FLDS,FR,GMTSEG,GMTSIEN,GMTSDEF,GMTSIFN,GMTSMGR,GNTSN
"RTN","GMTSOBL",110,0)
 N GMTSNEW,GMTSQIT,GMTSUM,L,LCNT,LI,NXTCMP,SELCNT,SOACTION,TO,TWEENER
"RTN","GMTSOBL",111,0)
 N TYPE,Y S EXISTS=0,(GMTSDEF,X)=$G(GMTS),GMTSQIT=0
"RTN","GMTSOBL",112,0)
 W:'$D(GMTSDICA) ! S U="^",DIC="^GMT(142,",DIC(0)="AEMQL"
"RTN","GMTSOBL",113,0)
 S DIC("A")=" Select Health Summary Type: "
"RTN","GMTSOBL",114,0)
 S:$L($G(GMTSDICA)) DIC("A")=$G(GMTSDICA)
"RTN","GMTSOBL",115,0)
 S GMTSDEF=$S(+GMTSDEF>0:$P($G(^GMT(142,+GMTSDEF,0)),"^",1),1:"")
"RTN","GMTSOBL",116,0)
 S:$L($G(GMTSDEF)) DIC("B")=$G(GMTSDEF)
"RTN","GMTSOBL",117,0)
 S DIC("S")="I +($$AHST^GMTSULT(+($G(Y))))"
"RTN","GMTSOBL",118,0)
 S DLAYGO=142,Y=$$TYPE^GMTSULT K DIC I +Y'>0 S X="@" Q -1
"RTN","GMTSOBL",119,0)
 S (GMTSIFN,DA)=+Y,GMTSUM=$P(Y,U,2),GMTSNEW=+$P(Y,U,3)
"RTN","GMTSOBL",120,0)
 S GMTSMGR=$S($D(^XUSEC("GMTSMGR",DUZ)):1,1:0)
"RTN","GMTSOBL",121,0)
 I 'GMTSNEW S X=$S(+Y>0:+Y,1:"@"),GMTS=+Y Q GMTS
"RTN","GMTSOBL",122,0)
 S DIE="^GMT(142,",(GMTSIFN,DA)=+Y,DR="[GMTS EDIT HLTH SUM TYPE]" D ^DIE
"RTN","GMTSOBL",123,0)
 I '$D(^GMT(142,+GMTSIFN,0))!($D(Y))!$D(DUOUT)!$D(DIROUT)!$D(DTOUT) D  Q -1
"RTN","GMTSOBL",124,0)
 . S GMTSQIT=1 D CD S:'$D(^GMT(142,+GMTSIFN,0)) X="@"
"RTN","GMTSOBL",125,0)
 D SELCMP^GMTSRM5 I GMTSQIT D DEL(GMTSIFN) Q -1
"RTN","GMTSOBL",126,0)
 D LIST:EXISTS,EXISTS,CD S X=$S($D(^GMT(142,+($G(GMTSIFN)),0)):+GMTSIFN,1:-1)
"RTN","GMTSOBL",127,0)
 K:+X>0 DTOUT,DUOUT,DIRUT,DIROUT S:+X>0 GMTSQ=0
"RTN","GMTSOBL",128,0)
 Q X
"RTN","GMTSOBL",129,0)
CD ;   Check for Possible Deletion (New Type without Component)
"RTN","GMTSOBL",130,0)
 Q:+($G(GMTSIFN))'>0  Q:'$D(^GMT(142,+($G(GMTSIFN)),0))
"RTN","GMTSOBL",131,0)
 D:GMTSMGR!(GMTSNEW)!($P(^GMT(142,+GMTSIFN,0),U,3)'=$G(DUZ)) ADEL(+($G(GMTSIFN)))
"RTN","GMTSOBL",132,0)
 Q
"RTN","GMTSOBL",133,0)
EXISTS ;   Edit an existing health summary type
"RTN","GMTSOBL",134,0)
 N CNT,NXTCMP,GMTSQIT S GMTSQIT=0 Q:$D(DUOUT)  S NXTCMP=0,NXTCMP(0)=0
"RTN","GMTSOBL",135,0)
 F CNT=$$GETCNT(GMTSIFN):0 D NXTCMP^GMTSRM1 D LIST:GMTSQIT Q:GMTSQIT!($D(DUOUT))  K GMTSQIT,GMTSNEW,TWEENER,SOACTION
"RTN","GMTSOBL",136,0)
 I NXTCMP>0 W !,"Please hold on while I resequence the summary order" D COPY^GMTSRN,RNMBR^GMTSRN:CHANGE
"RTN","GMTSOBL",137,0)
 Q
"RTN","GMTSOBL",138,0)
LIST ;   Lists existing summary parameters
"RTN","GMTSOBL",139,0)
 N B,DIC,DIR,IOP,Y,FR,TO,BY,DHD,FLDS,L I GMTSQIT'=2 Q:($D(DUOUT)!(GMTSQIT=1))
"RTN","GMTSOBL",140,0)
 I GMTSQIT=2,(NXTCMP=0) S GMTSQIT=0 Q
"RTN","GMTSOBL",141,0)
 I 'GMTSNEW W ! S DIC=142,DIR(0)="Y",DIR("A")="Do you wish to review the Summary Type structure before continuing",DIR("B")="NO" D ^DIR K DIR I 'Y S:GMTSQIT=2 DUOUT="" S:GMTSQIT=2 GMTSQIT="D" S:$D(DUOUT) GMTSQIT=1 Q
"RTN","GMTSOBL",142,0)
 I $D(GMTSQIT),GMTSQIT=2 S GMTSQIT=0
"RTN","GMTSOBL",143,0)
 S IOP="HOME",DIC=142,(FR,TO)=GMTSUM,BY=".01",DHD="[GMTS TYPE INQ HEADER]-[GMTS TYPE INQ FOOTER]",FLDS="[GMTS TYPE INQ]",L=0 D EN1^DIP
"RTN","GMTSOBL",144,0)
 Q
"RTN","GMTSOBL",145,0)
GETCNT(GMTSIFN) ;   Determine default summary order for new component
"RTN","GMTSOBL",146,0)
 N LI,LCNT S LI=0,LCNT=5 F  S LI=$O(^GMT(142,+GMTSIFN,1,LI)) Q:+LI'>0  S LCNT=$P(LI,".")+5
"RTN","GMTSOBL",147,0)
 Q LCNT
"RTN","GMTSOBL",148,0)
ADEL(X) ;   Ask to Delete Type
"RTN","GMTSOBL",149,0)
 N GMTSIEN,GMTSN,ADEL,DIR S GMTSIEN=+($G(X)),ADEL=""  Q:GMTSIEN=0  Q:'$D(^GMT(142,GMTSIEN,0))  Q:$D(^GMT(142,GMTSIEN,1,"B"))
"RTN","GMTSOBL",150,0)
 S GMTSN=$P($G(^GMT(142,GMTSIEN,0)),"^",1) Q:'$L(GMTSN)  S DIR("A",1)=" Health Summary Type '"_GMTSN_"' has no Components",DIR("A")=" Do you want to delete this type?  (Y/N)  ",DIR("B")="Yes",DIR(0)="YAO",DIR("?")="     Enter either 'Y' or 'N'."
"RTN","GMTSOBL",151,0)
 W ! D ^DIR D:Y>0 DEL(+($G(GMTSIEN)))
"RTN","GMTSOBL",152,0)
 Q
"RTN","GMTSOBL",153,0)
DEL(X) ;   Delete Type
"RTN","GMTSOBL",154,0)
 N DIK,DA,GMTSN S DA=+($G(X)) Q:DA=0  Q:'$D(^GMT(142,DA,0))
"RTN","GMTSOBL",155,0)
 S DIK="^GMT(142,",GMTSN=$P($G(^GMT(142,DA,0)),"^",1) Q:'$L(GMTSN)  D ^DIK
"RTN","GMTSOBL",156,0)
 I '$D(^GMT(142,DA,0)) W:$D(ADEL) "  < Health Summary Type deleted >" W:'$D(ADEL) !,?2,GMTSN,"  < deleted >"
"RTN","GMTSOBL",157,0)
 Q
"RTN","GMTSOBL",158,0)
K ; Kill Common Variables
"RTN","GMTSOBL",159,0)
 K DTOUT,DUOUT,DIRUT,DIROUT
"RTN","GMTSOBL",160,0)
 Q
"RTN","GMTSOBL",161,0)
ABT(X) ; Abort
"RTN","GMTSOBL",162,0)
 Q:$D(DTOUT)!($D(DUOUT))!($D(DIRUT))!($D(DIROUT)) 1
"RTN","GMTSOBL",163,0)
 Q 0
"RTN","GMTSOBL",164,0)
ST ; Show Type
"RTN","GMTSOBL",165,0)
 N GMTSN,GMTSC S GMTSN="^GMT(142,"_+($G(GMTSIFN))_")",GMTSC="^GMT(142,"_+($G(GMTSIFN))_","
"RTN","GMTSOBL",166,0)
 W ! F  S GMTSN=$Q(@GMTSN) Q:GMTSN=""!(GMTSN'[GMTSC)  W !,GMTSN,"=",@GMTSN
"RTN","GMTSOBL",167,0)
 Q
"RTN","GMTSOBL2")
0^26^B17949177
"RTN","GMTSOBL2",1,0)
GMTSOBL2 ; SLC/KER - HS Object - Lookup                 ; 01/06/2003
"RTN","GMTSOBL2",2,0)
 ;;2.7;Health Summary;**58**;Oct 20, 1995
"RTN","GMTSOBL2",3,0)
 ;                
"RTN","GMTSOBL2",4,0)
 ; External References
"RTN","GMTSOBL2",5,0)
 ;   DBIA  10006  ^DIC  (file #142.5)
"RTN","GMTSOBL2",6,0)
 ;   DBIA  10013  ^DIK  (file #142 and 142.5)
"RTN","GMTSOBL2",7,0)
 ;   DBIA  10016  ^DIM
"RTN","GMTSOBL2",8,0)
 ;   DBIA  10103  $$NOW^XLFDT  
"RTN","GMTSOBL2",9,0)
 ;   DBIA  10103  $$FMADD^XLFDT
"RTN","GMTSOBL2",10,0)
 ;                       
"RTN","GMTSOBL2",11,0)
 Q
"RTN","GMTSOBL2",12,0)
N(X) ; Verify Name
"RTN","GMTSOBL2",13,0)
 N DA,DIK,GMTSIEN,GMTSNEW S GMTSIEN=+($G(X)),GMTSNEW=+($P($G(X),"^",3))
"RTN","GMTSOBL2",14,0)
 I GMTSIEN'>0!('$L($P($G(^GMT(142.5,+($G(X)),0)),"^",1))) D
"RTN","GMTSOBL2",15,0)
 . S DA=GMTSIEN,DIK="^GMT(142.5,"
"RTN","GMTSOBL2",16,0)
 . W !," 'NAME' is a required field" Q:'GMTSNEW
"RTN","GMTSOBL2",17,0)
 . D:DA>0 ^DIK S X=-1
"RTN","GMTSOBL2",18,0)
 . W:'$D(^GMT(142.5,+DA,0)) !,"  < Health Summary Object deleted >"
"RTN","GMTSOBL2",19,0)
 Q X
"RTN","GMTSOBL2",20,0)
NN(GMTS) ; No Name Entered
"RTN","GMTSOBL2",21,0)
 N DA,DIK,GMTSIEN,GMTSNEW S GMTSIEN=+($G(GMTS)),GMTSNEW=+($P($G(GMTS),"^",3))
"RTN","GMTSOBL2",22,0)
 I +GMTSIEN>0 D
"RTN","GMTSOBL2",23,0)
 . Q:$L($P($G(^GMT(142.5,+GMTSIEN,0)),"^",1))
"RTN","GMTSOBL2",24,0)
 . S DA=+GMTSIEN,DIK="^GMT(142.5,"
"RTN","GMTSOBL2",25,0)
 . W !," 'NAME' is a required field" Q:'GMTSNEW  D:DA>0 ^DIK
"RTN","GMTSOBL2",26,0)
 . W:'$D(^GMT(142.5,+DA,0)) !,"  < Health Summary Object deleted >"
"RTN","GMTSOBL2",27,0)
 . S:'$D(^GMT(142.5,+DA,0)) (DA,X,Y)=-1,GMTSQ=1
"RTN","GMTSOBL2",28,0)
 Q
"RTN","GMTSOBL2",29,0)
T(X) ; Type
"RTN","GMTSOBL2",30,0)
 N GMTST,GMTSB,GMTSC,GMTSIEN,GMTSNEW S GMTSIEN=+($G(X)),GMTST=+($P($G(^GMT(142.5,GMTSIEN,0)),"^",3)),GMTSNEW=+($P($G(X),"^",3))
"RTN","GMTSOBL2",31,0)
 I GMTST=0 D  Q X
"RTN","GMTSOBL2",32,0)
 . S DA=GMTSIEN,DIK="^GMT(142.5,"
"RTN","GMTSOBL2",33,0)
 . W !,"  'Health Summary Type' is a required field" Q:'GMTSNEW
"RTN","GMTSOBL2",34,0)
 . D:DA>0 ^DIK S X=-1
"RTN","GMTSOBL2",35,0)
 . W !,"  < Health Summary Object deleted >"
"RTN","GMTSOBL2",36,0)
 S GMTSB=+($D(^GMT(142,GMTST,1,"B"))),GMTSB=$S(GMTSB>0:1,1:0)
"RTN","GMTSOBL2",37,0)
 I GMTSB=0 D  Q X
"RTN","GMTSOBL2",38,0)
 . S DA=GMTSIEN,DIK="^GMT(142.5,"
"RTN","GMTSOBL2",39,0)
 . W !,"  Selected Health Summary Type has no Components" Q:'GMTSNEW
"RTN","GMTSOBL2",40,0)
 . D:DA>0 ^DIK S X=-1
"RTN","GMTSOBL2",41,0)
 . W !,"  < Health Summary Object deleted >"
"RTN","GMTSOBL2",42,0)
 S GMTSC=$O(^GMT(142,GMTST,1,"C",0)),GMTSC=$S(GMTSC<9999&(GMTSC>0):1,1:0)
"RTN","GMTSOBL2",43,0)
 Q X
"RTN","GMTSOBL2",44,0)
NT(GMTS) ; No Type Entered
"RTN","GMTSOBL2",45,0)
 N DA,DIK,GMTSIEN,GMTSNEW S GMTSIEN=+($G(GMTS)),GMTSNEW=+($P($G(GMTS),"^",3))
"RTN","GMTSOBL2",46,0)
 I +GMTSIEN>0 D
"RTN","GMTSOBL2",47,0)
 . Q:+($P($G(^GMT(142.5,+GMTSIEN,0)),"^",3))>0
"RTN","GMTSOBL2",48,0)
 . S DA=+GMTSIEN,DIK="^GMT(142.5,"
"RTN","GMTSOBL2",49,0)
 . W !," 'HEALTH SUMMARY TYPE' is a required field" Q:'GMTSNEW
"RTN","GMTSOBL2",50,0)
 . D:DA>0 ^DIK
"RTN","GMTSOBL2",51,0)
 . W:'$D(^GMT(142.5,+DA,0)) !,"  < Health Summary Object deleted >"
"RTN","GMTSOBL2",52,0)
 . S:'$D(^GMT(142.5,+DA,0)) (DA,X,Y)=-1,GMTSQ=1
"RTN","GMTSOBL2",53,0)
 Q
"RTN","GMTSOBL2",54,0)
NEW(GMTS) ; New
"RTN","GMTSOBL2",55,0)
 S GMTS=+($G(GMTS))
"RTN","GMTSOBL2",56,0)
 I +GMTS>0,$D(^GMT(142.5,GMTS,0)) D
"RTN","GMTSOBL2",57,0)
 . N GMTSDT S GMTSDT=$$NOW^XLFDT
"RTN","GMTSOBL2",58,0)
 . S $P(^GMT(142.5,+GMTS,0),"^",18)=GMTSDT
"RTN","GMTSOBL2",59,0)
 . S GMTSDT=$$FMADD^XLFDT(GMTSDT,,,1,)
"RTN","GMTSOBL2",60,0)
 . S $P(^GMT(142.5,+GMTS,0),"^",19)=GMTSDT
"RTN","GMTSOBL2",61,0)
 . Q:+($G(DUZ))'>0  S $P(^GMT(142.5,+GMTS,0),"^",17)=+($G(DUZ))
"RTN","GMTSOBL2",62,0)
 Q
"RTN","GMTSOBL2",63,0)
VER(X) ; Verify Object
"RTN","GMTSOBL2",64,0)
 N GMTSIEN,GMTSNAM,GMTSNEW S GMTSIEN=+($G(X)) Q:+GMTSIEN'>0 -1
"RTN","GMTSOBL2",65,0)
 S GMTSNAM=$P($G(X),"^",2),GMTSNEW=+($P($G(X),"^",3))
"RTN","GMTSOBL2",66,0)
 Q:'$D(^GMT(142.5,+GMTSIEN,0)) -1
"RTN","GMTSOBL2",67,0)
 I '$L($P($G(^GMT(142.5,+GMTSIEN,0)),"^",1)) D  Q -1
"RTN","GMTSOBL2",68,0)
 . S DA=+GMTSIEN,DIK="^GMT(142.5," W !," 'NAME' is a required field" D:DA>0 ^DIK
"RTN","GMTSOBL2",69,0)
 . W:'$D(^GMT(142.5,+DA,0)) !,"  < Health Summary Object deleted >" S:'$D(^GMT(142.5,+DA,0)) (DA,X,Y)=-1,GMTSQ=1
"RTN","GMTSOBL2",70,0)
 Q:'$D(^GMT(142.5,+GMTSIEN,0)) -1
"RTN","GMTSOBL2",71,0)
 I +($P($G(^GMT(142.5,+GMTSIEN,0)),"^",3))'>0 D  Q -1
"RTN","GMTSOBL2",72,0)
 . S DA=+GMTSIEN,DIK="^GMT(142.5," W !," 'HEALTH SUMMARY TYPE' is a required field" D:DA>0 ^DIK
"RTN","GMTSOBL2",73,0)
 . W:'$D(^GMT(142.5,+DA,0)) !,"  < Health Summary Object deleted >" S:'$D(^GMT(142.5,+DA,0)) (DA,X,Y)=-1,GMTSQ=1
"RTN","GMTSOBL2",74,0)
 Q:'$D(^GMT(142.5,+GMTSIEN,0)) -1
"RTN","GMTSOBL2",75,0)
 Q X
"RTN","GMTSOBL2",76,0)
MOD(GMTS) ; Modified
"RTN","GMTSOBL2",77,0)
 S GMTS=+($G(GMTS))
"RTN","GMTSOBL2",78,0)
 I +GMTS>0,$D(^GMT(142.5,GMTS,0)) D
"RTN","GMTSOBL2",79,0)
 . N GMTSDT S GMTSDT=$$NOW^XLFDT
"RTN","GMTSOBL2",80,0)
 . S GMTSDT=$$FMADD^XLFDT(GMTSDT,,,1,)
"RTN","GMTSOBL2",81,0)
 . S $P(^GMT(142.5,+GMTS,0),"^",19)=GMTSDT
"RTN","GMTSOBL2",82,0)
 Q
"RTN","GMTSOBL2",83,0)
TRIM(X) ; Trim Spaces
"RTN","GMTSOBL2",84,0)
 S X=$G(X) F  Q:$E(X,1)'=" "  S X=$E(X,2,$L(X))
"RTN","GMTSOBL2",85,0)
 F  Q:$E(X,$L(X))'=" "  S X=$E(X,1,($L(X)-1))
"RTN","GMTSOBL2",86,0)
 Q X
"RTN","GMTSOBL2",87,0)
B(X) ; Default "B"
"RTN","GMTSOBL2",88,0)
 Q:+($G(DUZ))=0 ""  N Y,DIR,DIC,DTOUT,DUOUT,DIROUT,DLAYGO,DA,D,D0,D1,DI,DQ S U="^"
"RTN","GMTSOBL2",89,0)
 S DIC=142.5,DIC(0)="Z",X=" " D ^DIC S X=$S(+Y>0:Y,1:"") Q X
"RTN","GMTSOBL2",90,0)
 Q
"RTN","GMTSOBL2",91,0)
NAH ; Name Help
"RTN","GMTSOBL2",92,0)
 W !,"     Enter the name of the Health Summary Object, 3 to 30 characters"
"RTN","GMTSOBL2",93,0)
 W !,"     in length.  This Object is stored and then embedded in another"
"RTN","GMTSOBL2",94,0)
 W !,"     document as needed."
"RTN","GMTSOBL2",95,0)
 Q
"RTN","GMTSOBL2",96,0)
DIM(X) ; Test DIC("S")
"RTN","GMTSOBL2",97,0)
 S X=$G(X) D ^DIM Q:'$D(X) ""
"RTN","GMTSOBL2",98,0)
 Q X
"RTN","GMTSOBS")
0^6^B64484788
"RTN","GMTSOBS",1,0)
GMTSOBS ; SLC/KER - HS Object - Show                     ; 01/06/2003
"RTN","GMTSOBS",2,0)
 ;;2.7;Health Summary;**58**;Oct 20, 1995
"RTN","GMTSOBS",3,0)
 ;
"RTN","GMTSOBS",4,0)
 ; External References
"RTN","GMTSOBS",5,0)
 ;    DBIA 10103  $$FMADD^XLFDT
"RTN","GMTSOBS",6,0)
 ;    DBIA 10103  $$NOW^XLFDT
"RTN","GMTSOBS",7,0)
 ;    DBIA 10103  $$FMTE^XLFDT
"RTN","GMTSOBS",8,0)
 ;    DBIA 10104  $$UP^XLFSTR
"RTN","GMTSOBS",9,0)
 ;    DBIA  2056  $$GET1^DIQ  (file #200)
"RTN","GMTSOBS",10,0)
 ;    DBIA 10060  ^VA(200, (read w/fileman)
"RTN","GMTSOBS",11,0)
 ;    DBIA 10086  ^%ZIS
"RTN","GMTSOBS",12,0)
 ;    DBIA 10086  HOME^%ZIS
"RTN","GMTSOBS",13,0)
 ;    DBIA 10089  ^%ZISC
"RTN","GMTSOBS",14,0)
 ;    DBIA 10088  ENDR^%ZISS
"RTN","GMTSOBS",15,0)
 ;    DBIA 10063  ^%ZTLOAD
"RTN","GMTSOBS",16,0)
 ;                  
"RTN","GMTSOBS",17,0)
 Q
"RTN","GMTSOBS",18,0)
DEF(X,GMTSARY) ; Extract Object Definition/Example
"RTN","GMTSOBS",19,0)
 N GMTSEXT S GMTSEXT="" D SO($G(X)) Q
"RTN","GMTSOBS",20,0)
SO(X) ; Show Object
"RTN","GMTSOBS",21,0)
 N GMTSNAM,GMTSLBL,GMTSTYP,GMTSHST,GMTSPER,GMTSNOD,GMTSPLB
"RTN","GMTSOBS",22,0)
 N GMTSLBB,GMTSRDT,GMTSCON,GMTSRHD,GMTSCHD,GMTSUND,GMTSLIM,GMTSBLK
"RTN","GMTSOBS",23,0)
 N GMTSDEC,GMTSOWN,GMTSCRE,GMTSMOD,GMTSUNT,GMTSLEN,GMTSTIM,GMTSI
"RTN","GMTSOBS",24,0)
 N GMTSO,GMTSL,GMTSDTM,GMTSDED,GMTSDCH,GMTSDCN,GMTSTIM,GMTSWIN,TXT S U="^"
"RTN","GMTSOBS",25,0)
 S GMTSO=$G(^GMT(142.5,+($G(X)),0))
"RTN","GMTSOBS",26,0)
 S GMTSNAM=$P(GMTSO,U,1) Q:'$L(GMTSNAM)
"RTN","GMTSOBS",27,0)
 S GMTSLBL=$P(GMTSO,U,2) S:'$L(GMTSLBL) GMTSLBL="UNSPECIFIED"
"RTN","GMTSOBS",28,0)
 S (GMTSHST,GMTSTYP)=+($P(GMTSO,U,3)) Q:+GMTSTYP=0
"RTN","GMTSOBS",29,0)
 S GMTSTYP=$P($G(^GMT(142,+GMTSTYP,0)),"^",1) Q:'$L(GMTSTYP)
"RTN","GMTSOBS",30,0)
 S GMTSPER=$P(GMTSO,U,4)
"RTN","GMTSOBS",31,0)
 S GMTSLEN=+GMTSPER
"RTN","GMTSOBS",32,0)
 S GMTSUNT=$E(GMTSPER,$L(GMTSPER))
"RTN","GMTSOBS",33,0)
 S:+GMTSUNT>0 GMTSUNT="D"
"RTN","GMTSOBS",34,0)
 ;
"RTN","GMTSOBS",35,0)
 S GMTSNOD=+($P(GMTSO,U,5))
"RTN","GMTSOBS",36,0)
 S GMTSHDR=+($P(GMTSO,U,6))
"RTN","GMTSOBS",37,0)
 S GMTSPLB=+($P(GMTSO,U,7))
"RTN","GMTSOBS",38,0)
 S GMTSLBB=+($P(GMTSO,U,8))
"RTN","GMTSOBS",39,0)
 S GMTSRDT=+($P(GMTSO,U,9))
"RTN","GMTSOBS",40,0)
 S GMTSCON=+($P(GMTSO,U,10))
"RTN","GMTSOBS",41,0)
 S GMTSRHD=+($P(GMTSO,U,11))
"RTN","GMTSOBS",42,0)
 S GMTSCHD=+($P(GMTSO,U,12))
"RTN","GMTSOBS",43,0)
 S GMTSUND=+($P(GMTSO,U,13))
"RTN","GMTSOBS",44,0)
 S GMTSLIM=+($P(GMTSO,U,14))
"RTN","GMTSOBS",45,0)
 S GMTSBLK=+($P(GMTSO,U,15))
"RTN","GMTSOBS",46,0)
 S GMTSDEC=+($P(GMTSO,U,16))
"RTN","GMTSOBS",47,0)
 S GMTSOWN=+($P(GMTSO,U,17)),GMTSOWN=$$GET1^DIQ(200,(+GMTSOWN_","),.01)
"RTN","GMTSOBS",48,0)
 S GMTSCRE=+($P(GMTSO,U,18)),GMTSCRE=$TR($$FMTE^XLFDT(GMTSCRE,"5ZM"),"@"," ")
"RTN","GMTSOBS",49,0)
 S GMTSMOD=+($P(GMTSO,U,19)),GMTSMOD=$TR($$FMTE^XLFDT(GMTSMOD,"5ZM"),"@"," ")
"RTN","GMTSOBS",50,0)
 S (GMTSTIM,GMTSPER)=$P(GMTSO,"^",4),GMTSTIM=$S($E(GMTSTIM,$L(GMTSTIM))="Y":" year",$E(GMTSTIM,$L(GMTSTIM))="M":" month",$E(GMTSTIM,$L(GMTSTIM))="W":" week",1:" day")
"RTN","GMTSOBS",51,0)
 S:+GMTSPER>1 GMTSTIM=GMTSTIM_"s" S GMTSTIM=+GMTSPER_GMTSTIM
"RTN","GMTSOBS",52,0)
 I $L(GMTSPER) D
"RTN","GMTSOBS",53,0)
 . N GMTSPX1,GMTSPX2,GMTSLEN,GMTSUNT,GMTSDIF
"RTN","GMTSOBS",54,0)
 . S GMTSPX1=$$NOW^XLFDT,GMTSUNT=$E(GMTSPER,$L(GMTSPER)),GMTSLEN=+GMTSPER
"RTN","GMTSOBS",55,0)
 . I +GMTSLEN=0!($L(GMTSUNT)'=1)!("DWMY"'[GMTSUNT) S GMTSPER="" Q
"RTN","GMTSOBS",56,0)
 . S:GMTSUNT="D" GMTSDIF=GMTSLEN S:GMTSUNT="W" GMTSDIF=GMTSLEN*7
"RTN","GMTSOBS",57,0)
 . S:GMTSUNT="M" GMTSDIF=GMTSLEN*30.4 S:GMTSUNT="Y" GMTSDIF=GMTSLEN*365.25
"RTN","GMTSOBS",58,0)
 . S GMTSDIF=$P(GMTSDIF,".",1),GMTSPX2=$$FMADD^XLFDT(GMTSPX1,-(GMTSDIF))
"RTN","GMTSOBS",59,0)
 . S GMTSPX1=$$UP^XLFSTR($$FMTE^XLFDT(GMTSPX1,"ZD"))
"RTN","GMTSOBS",60,0)
 . S GMTSPX2=$$UP^XLFSTR($$FMTE^XLFDT(GMTSPX2,"ZD"))
"RTN","GMTSOBS",61,0)
 . S GMTSWIN=GMTSPER_"   ("_GMTSPX2_" - "_GMTSPX1_")"
"RTN","GMTSOBS",62,0)
 S:'$L(GMTSPER) GMTSPER="UNSPECIFIED"
"RTN","GMTSOBS",63,0)
 S:$L($G(GMTSTIM))&('$L($G(GMTSWIN))) GMTSWIN=$G(GMTSTIM)
"RTN","GMTSOBS",64,0)
 W:$L($G(GMTSHDR(1))) !,GMTSHDR(1)
"RTN","GMTSOBS",65,0)
 W:$L($G(GMTSHDR(2))) !,GMTSHDR(2)
"RTN","GMTSOBS",66,0)
 ;
"RTN","GMTSOBS",67,0)
 S TXT="  OBJECT NAME: "_$G(GMTSNAM)
"RTN","GMTSOBS",68,0)
 D D(TXT)
"RTN","GMTSOBS",69,0)
 S TXT="  HEALTH SUMMARY TYPE:   "_$G(GMTSTYP)
"RTN","GMTSOBS",70,0)
 D D(TXT)
"RTN","GMTSOBS",71,0)
 ;
"RTN","GMTSOBS",72,0)
 S TXT="    REPORT PERIOD: "_$G(GMTSPER),TXT=TXT_$J(" ",(41-$L(TXT)))_"PRINT REPORT DATE/TIME: "_$S(+GMTSHDR>0&(+GMTSRDT>0):"YES",+GMTSHDR'>0:"YES",1:"NO")
"RTN","GMTSOBS",73,0)
 D D(TXT)
"RTN","GMTSOBS",74,0)
 ;
"RTN","GMTSOBS",75,0)
 S TXT="    LABEL: "_$G(GMTSLBL),TXT=TXT_$J(" ",(41-$L(TXT)))_"PRINT CONFIDENTIALITY BANNER: "_$S(+GMTSHDR>0&(+GMTSCON>0):"YES",+GMTSHDR'>0:"YES",1:"NO")
"RTN","GMTSOBS",76,0)
 D D(TXT)
"RTN","GMTSOBS",77,0)
 ;
"RTN","GMTSOBS",78,0)
 S TXT="      PRINT LABEL: "_$S(+GMTSPLB>0:"YES",1:"NO"),TXT=TXT_$J(" ",(41-$L(TXT)))_"PRINT REPORT HEADER: "_$S(+GMTSHDR>0&(+GMTSRHD>0):"YES",+GMTSHDR'>0:"YES",1:"NO")
"RTN","GMTSOBS",79,0)
 D D(TXT)
"RTN","GMTSOBS",80,0)
 ;
"RTN","GMTSOBS",81,0)
 S TXT="      BLANK LINE AFTER LABEL: "_$S(+GMTSLBB>0:"YES",1:"NO"),TXT=TXT_$J(" ",(41-$L(TXT)))_"PRINT COMPONENT HEADER: "_$S(+GMTSHDR>0&(+GMTSCHD>0):"YES",+GMTSHDR'>0:"YES",1:"NO")
"RTN","GMTSOBS",82,0)
 D D(TXT)
"RTN","GMTSOBS",83,0)
 ;
"RTN","GMTSOBS",84,0)
 S TXT="    SUPPRESS COMPONENTS W/O DATA: "_$S(+GMTSNOD>0:"YES",1:"NO")
"RTN","GMTSOBS",85,0)
 S TXT=TXT_$J(" ",(41-$L(TXT)))_"  PRINT TIME-OCCURRENCE LIMITS: "_$S(+GMTSHDR>0&(+GMTSLIM>0):"YES",+GMTSHDR'>0:"YES",1:"NO")
"RTN","GMTSOBS",86,0)
 D D(TXT)
"RTN","GMTSOBS",87,0)
 ;
"RTN","GMTSOBS",88,0)
 S TXT="    SUPPRESS HEADER: "_$S(+GMTSHDR>0:"YES",1:"NO")
"RTN","GMTSOBS",89,0)
 S TXT=TXT_$J(" ",(41-$L(TXT)))_"  UNDERLINE COMPONENT HEADER: "_$S(+GMTSHDR>0&(+GMTSUND>0):"YES",1:"NO")
"RTN","GMTSOBS",90,0)
 D D(TXT)
"RTN","GMTSOBS",91,0)
 ;
"RTN","GMTSOBS",92,0)
 S TXT="    SUPPRESS DECEASED INFORMATION: "_$S(+GMTSHDR>0&(+GMTSDEC>0):"NO",1:"YES")
"RTN","GMTSOBS",93,0)
 S TXT=TXT_$J(" ",(41-$L(TXT)))_"  BLANK LINE AFTER HEADER: "_$S(+GMTSHDR>0&(+GMTSBLK>0):"YES",+GMTSHDR'>0:"YES",1:"NO")
"RTN","GMTSOBS",94,0)
 D D(TXT)
"RTN","GMTSOBS",95,0)
 ;
"RTN","GMTSOBS",96,0)
 S TXT="    CREATOR: "_GMTSOWN
"RTN","GMTSOBS",97,0)
 S TXT=TXT_$J(" ",(41-$L(TXT)))_"CREATED: "_GMTSCRE
"RTN","GMTSOBS",98,0)
 D D(TXT)
"RTN","GMTSOBS",99,0)
 ;
"RTN","GMTSOBS",100,0)
 S TXT="",TXT=TXT_$J(" ",(41-$L(TXT)))_"LAST MODIFIED: "_GMTSMOD
"RTN","GMTSOBS",101,0)
 D D(TXT)
"RTN","GMTSOBS",102,0)
 ;
"RTN","GMTSOBS",103,0)
 Q:$D(GMTSABRR)
"RTN","GMTSOBS",104,0)
 ;
"RTN","GMTSOBS",105,0)
 S TXT="    EXAMPLE:" D E(TXT)
"RTN","GMTSOBS",106,0)
 S GMTSDTM=$$NOW^XLFDT,GMTSDED=$$FMADD^XLFDT(GMTSDTM,-2000)
"RTN","GMTSOBS",107,0)
 S GMTSDED=$TR($$FMTE^XLFDT($P(GMTSDED,".",1),"2ZM"),"@"," ")
"RTN","GMTSOBS",108,0)
 S GMTSDTM=$TR($$FMTE^XLFDT(GMTSDTM,"2ZM"),"@"," ")
"RTN","GMTSOBS",109,0)
 S GMTSDCH=$$DCH(+($G(GMTSHST))),GMTSDCN=$P(GMTSDCH,"^",2),GMTSDCH=$P(GMTSDCH,"^",1)
"RTN","GMTSOBS",110,0)
 S:'$L(GMTSDCH) GMTSDCH="PN - Progress Notes" S GMTSTIM=$$TIM($G(GMTSPER))
"RTN","GMTSOBS",111,0)
 D:+GMTSHDR>0 SP^GMTSOBS2
"RTN","GMTSOBS",112,0)
 D:+GMTSHDR'>0 HS^GMTSOBS2
"RTN","GMTSOBS",113,0)
 Q
"RTN","GMTSOBS",114,0)
DCH(X) ; Default Component Header
"RTN","GMTSOBS",115,0)
 N GMTSABR,GMTSDHD,GMTSDCH,GMTSDCN,GMTSTYP S GMTSTYP=+($G(X)),GMTSABR=$O(^GMT(142,+GMTSTYP,1,0))
"RTN","GMTSOBS",116,0)
 S GMTSABR=$G(^GMT(142,+GMTSTYP,1,+GMTSABR,0)),GMTSABR=+($P(GMTSABR,"^",2))
"RTN","GMTSOBS",117,0)
 S GMTSDCN=$P($G(^GMT(142.1,+GMTSABR,0)),"^",1),GMTSDHD=$P($G(^GMT(142.1,+GMTSABR,0)),"^",9),GMTSABR=$P($G(^GMT(142.1,+GMTSABR,0)),"^",4)
"RTN","GMTSOBS",118,0)
 S GMTSDCH=$S($L(GMTSABR)&($L(GMTSDHD)):(GMTSABR_" - "_GMTSDHD),1:"PN - Progress Notes")
"RTN","GMTSOBS",119,0)
 S X=GMTSDCH_"^"_GMTSDCN Q X
"RTN","GMTSOBS",120,0)
TIM(X) ; Time
"RTN","GMTSOBS",121,0)
 N GMTSTIM,GMTSPER S (GMTSTIM,GMTSPER)=$G(X) S:'$L(GMTSTIM) (GMTSTIM,GMTSPER)="3M"
"RTN","GMTSOBS",122,0)
 S GMTSTIM=$S($E(GMTSTIM,$L(GMTSTIM))="Y":" year",$E(GMTSTIM,$L(GMTSTIM))="M":" month",$E(GMTSTIM,$L(GMTSTIM))="W":" week",1:" day")
"RTN","GMTSOBS",123,0)
 S:+GMTSPER>1 GMTSTIM=GMTSTIM_"s" S GMTSTIM=+GMTSPER_GMTSTIM
"RTN","GMTSOBS",124,0)
 S X=GMTSTIM Q X
"RTN","GMTSOBS",125,0)
 Q
"RTN","GMTSOBS",126,0)
DEV ; Device
"RTN","GMTSOBS",127,0)
 I +($G(DFN))=0!('$D(^TMP("GMTSOBJ",$J,DFN))) K ^TMP("GMTSOBJ",$J,DFN) Q
"RTN","GMTSOBS",128,0)
 I $D(CAP) D NODEV K ^TMP("GMTSOBJ",$J,DFN) Q
"RTN","GMTSOBS",129,0)
 N ZTRTN,%ZIS,IOP,POP S %ZIS="PQ" D ^%ZIS Q:POP  I $D(IO("Q")) D QUE Q
"RTN","GMTSOBS",130,0)
NOQUE ; Print without Queuing
"RTN","GMTSOBS",131,0)
 N ZTRTN S ZTRTN="DSP^GMTSOBS"
"RTN","GMTSOBS",132,0)
 I $D(IOST),$D(IOF) W:IOST["C-"&('$D(GMTSNOI)) @IOF
"RTN","GMTSOBS",133,0)
 D @ZTRTN,^%ZISC K ^TMP("GMTSOBJ",$J,DFN) Q
"RTN","GMTSOBS",134,0)
QUE ; Queued Print
"RTN","GMTSOBS",135,0)
 N %,ZTDESC,ZTDTH,ZTIO,ZTSAVE,ZTSK,ZTRTN S ZTRTN="DSP^GMTSOBS" K IO("Q"),ZTSAVE
"RTN","GMTSOBS",136,0)
 S ZTSAVE("^TMP(""GMTSOBJ"","_$J_","_DFN_",")="" S ZTSAVE("DFN")=""
"RTN","GMTSOBS",137,0)
 S:$D(GMTSHDR) ZTSAVE("GMTSHDR")=""
"RTN","GMTSOBS",138,0)
 S ZTDESC="Display Health Summary Object" S ZTIO=ION,ZTDTH=$H
"RTN","GMTSOBS",139,0)
 D ^%ZTLOAD I '$D(ZTSK) W !!,"Request Cancelled",! H 3 W:$D(IOF) @IOF
"RTN","GMTSOBS",140,0)
 I $D(ZTSK) W !!,"Request Queued",! H 3 W:$D(IOF) @IOF
"RTN","GMTSOBS",141,0)
 K ZTSK,ZTDESC,ZTDTH,ZTIO,ZTRTN,ZTSAVE D ^%ZISC Q
"RTN","GMTSOBS",142,0)
 Q
"RTN","GMTSOBS",143,0)
NODEV ; Print without Device Selection
"RTN","GMTSOBS",144,0)
 W !! N ZTRTN,POP,IOP,%ZIS,IOSL S IOSL=99999999999
"RTN","GMTSOBS",145,0)
 S ZTRTN="DSP^GMTSOBS" D @ZTRTN,^%ZISC K ^TMP("GMTSOBJ",$J,DFN)
"RTN","GMTSOBS",146,0)
 Q
"RTN","GMTSOBS",147,0)
DSP ; Print Health Summary Type
"RTN","GMTSOBS",148,0)
 Q:+($G(DFN))=0  N GMTST,GMTSI,GMTSC,GMTSP,GMTSL,GMTSEXIT,GMTSCR,GMTSPL D HOME^%ZIS
"RTN","GMTSOBS",149,0)
 S GMTSPL=3,GMTSEXIT=0,GMTSP=$G(IOST),GMTSL=+($G(IOSL)) S:+GMTSL=0 GMTSL=24
"RTN","GMTSOBS",150,0)
 D ATTR W !!,$G(BOLD),"<----------------------------- Break in Document ---------------------------->",$G(NORM) S GMTSPL=GMTSPL+1
"RTN","GMTSOBS",151,0)
 W !,$G(BOLD),"<---------------------------- Beginning of Object --------------------------->",$G(NORM) S GMTSPL=GMTSPL+1 D KATTR
"RTN","GMTSOBS",152,0)
 S GMTSI=0 F  S GMTSI=$O(^TMP("GMTSOBJ",$J,DFN,GMTSI)) Q:+GMTSI=0  D
"RTN","GMTSOBS",153,0)
 . W !,$G(^TMP("GMTSOBJ",$J,DFN,GMTSI,0)) S GMTSPL=+GMTSPL+1 D CONT
"RTN","GMTSOBS",154,0)
 K ^TMP("GMTSOBJ",$J,DFN)
"RTN","GMTSOBS",155,0)
 D ATTR W !,$G(BOLD),"<------------------------------ End of Object ------------------------------->",$G(NORM) S GMTSPL=+GMTSPL+1
"RTN","GMTSOBS",156,0)
 W !,$G(BOLD),"<----------------------------- Document Resumes ----------------------------->",$G(NORM) D KATTR S GMTSPL=+GMTSPL+1 S:+GMTSL>0 IOSL=GMTSL
"RTN","GMTSOBS",157,0)
 S GMTSPL=GMTSL D CONT W:GMTSP["P-"&($D(IOF)) @IOF
"RTN","GMTSOBS",158,0)
 Q
"RTN","GMTSOBS",159,0)
D(X) ; Display
"RTN","GMTSOBS",160,0)
 I '$D(GMTSEXT) W !,$G(X) Q
"RTN","GMTSOBS",161,0)
 N GMTSC S GMTSC=$G(GMTSARY("D",0))+1,GMTSARY("D",+GMTSC)=$G(X),GMTSARY("D",0)=GMTSC
"RTN","GMTSOBS",162,0)
 Q
"RTN","GMTSOBS",163,0)
E(X) ; Example
"RTN","GMTSOBS",164,0)
 I '$D(GMTSEXT) W !,$G(X) Q
"RTN","GMTSOBS",165,0)
 N GMTSC S GMTSC=$G(GMTSARY("E",0))+1,GMTSARY("E",+GMTSC)=$G(X),GMTSARY("E",0)=GMTSC
"RTN","GMTSOBS",166,0)
 Q
"RTN","GMTSOBS",167,0)
CONT ; Press <Return> to Continue
"RTN","GMTSOBS",168,0)
 I GMTSP["P-" W:$L($G(IOF))&($D(IOF)) @IOF Q
"RTN","GMTSOBS",169,0)
 Q:(GMTSP["C-"!(GMTSP=""))&(GMTSPL'>(GMTSL-4))  S GMTSPL=0 Q:GMTSEXIT
"RTN","GMTSOBS",170,0)
 N GMTSCR S GMTSPL=0 W !!,"  Press <Return> to Continue  "
"RTN","GMTSOBS",171,0)
 R GMTSCR:660 I '$T!(GMTSCR["^") S GMTSCR="^",GMTSEXIT=1
"RTN","GMTSOBS",172,0)
 W:GMTSP'["P-"&($D(IOF)) @IOF Q
"RTN","GMTSOBS",173,0)
 Q
"RTN","GMTSOBS",174,0)
ATTR ; Set Screen Attributes
"RTN","GMTSOBS",175,0)
 N X,IOINHI,IOINORM S X="IOINHI;IOINORM" D ENDR^%ZISS S BOLD=$G(IOINHI),NORM=$G(IOINORM)
"RTN","GMTSOBS",176,0)
 Q
"RTN","GMTSOBS",177,0)
KATTR ; Kill Screen Attributes
"RTN","GMTSOBS",178,0)
 K NORM,BOLD Q
"RTN","GMTSOBS2")
0^30^B31776283
"RTN","GMTSOBS2",1,0)
GMTSOBS2 ; SLC/KER - HS Object - Show                     ; 01/06/2003
"RTN","GMTSOBS2",2,0)
 ;;2.7;Health Summary;**58**;Oct 20, 1995
"RTN","GMTSOBS2",3,0)
 ;
"RTN","GMTSOBS2",4,0)
 ; External References
"RTN","GMTSOBS2",5,0)
 ;     DBIA  2056  $$GET1^DIQ  (file 142.5)
"RTN","GMTSOBS2",6,0)
 ;     DBIA  2052  $$GET1^DID  (DD 142.5)
"RTN","GMTSOBS2",7,0)
 ;     DBIA 10103  $$NOW^XLFDT
"RTN","GMTSOBS2",8,0)
 ;     DBIA 10103  $$FMADD^XLFDT
"RTN","GMTSOBS2",9,0)
 Q
"RTN","GMTSOBS2",10,0)
GET(X,GMTSARY) ; Get Fields
"RTN","GMTSOBS2",11,0)
 ;
"RTN","GMTSOBS2",12,0)
 ; Input   X        IEN of HS Object File 142.5
"RTN","GMTSOBS2",13,0)
 ; Output  GMTSARY  Array of Fields and Values
"RTN","GMTSOBS2",14,0)
 ;                  (passed by reference)
"RTN","GMTSOBS2",15,0)
 K GMTSARY N GMTSN,GMTSIEN S GMTSIEN=+($G(X)),GMTSN=$G(^GMT(142.5,+GMTSIEN,0)) Q:'$L(GMTSN)
"RTN","GMTSOBS2",16,0)
 N GMTSI,GMTSF,GMTSFLD,GMTSFLDN,GMTSFLDM,GMTSDI,GMTSDE
"RTN","GMTSOBS2",17,0)
 F GMTSI=1:1 D  Q:$L(GMTSN,"^")=GMTSI
"RTN","GMTSOBS2",18,0)
 . S GMTSFLD=GMTSI S:GMTSFLD<10 GMTSFLD="0"_GMTSFLD S GMTSFLD=+("."_GMTSFLD)
"RTN","GMTSOBS2",19,0)
 . S GMTSFLDN=$$GET1^DID(142.5,+GMTSFLD,"","LABEL"),GMTSFLDM=$$EN2^GMTSUMX(GMTSFLDN)
"RTN","GMTSOBS2",20,0)
 . S GMTSDI=$$GET1^DIQ(142.5,(+GMTSIEN_","),GMTSFLD,"I"),GMTSDE=$$GET1^DIQ(142.5,(+GMTSIEN_","),GMTSFLD,"E")
"RTN","GMTSOBS2",21,0)
 . S GMTSARY(+GMTSIEN,+GMTSFLD,"I")=GMTSDI,GMTSARY(+GMTSIEN,+GMTSFLD,"E")=GMTSDE
"RTN","GMTSOBS2",22,0)
 . S GMTSARY(+GMTSIEN,+GMTSFLD,"NAME")=GMTSFLDN
"RTN","GMTSOBS2",23,0)
 . S:GMTSFLDM="Health Summary type" GMTSFLDM="Health Summary Type"
"RTN","GMTSOBS2",24,0)
 . S GMTSARY(+GMTSIEN,+GMTSFLD,"PROMPT")=GMTSFLDM
"RTN","GMTSOBS2",25,0)
 S GMTSARY(+GMTSIEN,1,"NAME")="OBJECT DESCRIPTION"
"RTN","GMTSOBS2",26,0)
 S GMTSARY(+GMTSIEN,1,"PROMPT")="Object Description"
"RTN","GMTSOBS2",27,0)
 S GMTSI=0 F  S GMTSI=$O(^GMT(142.5,+GMTSIEN,1,GMTSI)) Q:+GMTSI=0  D
"RTN","GMTSOBS2",28,0)
 . S GMTSARY(+GMTSIEN,1,"I",GMTSI,0)=$G(^GMT(142.5,GMTSIEN,1,GMTSI,0))
"RTN","GMTSOBS2",29,0)
 D DEF^GMTSOBS(+GMTSIEN,.GMTSARY)
"RTN","GMTSOBS2",30,0)
 Q
"RTN","GMTSOBS2",31,0)
DIS(DFN,OBJ) ; Display Object
"RTN","GMTSOBS2",32,0)
 Q:+($G(DFN))'>0  Q:+($G(OBJ))'>0
"RTN","GMTSOBS2",33,0)
 K GMTSOBJ N DIE,DR,GMTSR,GMTSLBL,GMTSTYP,GMTSPER,GMTSHDR,GMTSRDT
"RTN","GMTSOBS2",34,0)
 N GMTSCON,GMTSRHD,GMTSIOM,GMTSCHD,GMTSLIM,GMTSBLK,GMTSQ,GMTSDEC
"RTN","GMTSOBS2",35,0)
 N GMTSDT,GMTSI,GMTSPX1,GMTSPX2,GMTSNOD,GMTSLBB,GMTSUNT,GMTSLEN
"RTN","GMTSOBS2",36,0)
 N GMTSDIF,GMTSOBJ,GMTSOBJE,GMTSULB S GMTSOBJ=+($G(OBJ))
"RTN","GMTSOBS2",37,0)
 S GMTSR=$G(^GMT(142.5,+GMTSOBJ,0))
"RTN","GMTSOBS2",38,0)
 S GMTSLBL=$P(GMTSR,U,2) S:$L(GMTSLBL) GMTSOBJ("LABEL")=GMTSLBL
"RTN","GMTSOBS2",39,0)
 S GMTSTYP=$P(GMTSR,U,3) Q:+GMTSTYP'>0  S GMTSPER=$P(GMTSR,U,4)
"RTN","GMTSOBS2",40,0)
 S GMTSPX1="",GMTSPX2="",GMTSLEN=+GMTSPER,GMTSUNT=$E(GMTSPER,$L(GMTSPER))
"RTN","GMTSOBS2",41,0)
 I +GMTSLEN>0,GMTSUNT?1U,"DWMY"[GMTSUNT D
"RTN","GMTSOBS2",42,0)
 . S GMTSPX1=$$NOW^XLFDT
"RTN","GMTSOBS2",43,0)
 . S:GMTSUNT="D" GMTSDIF=GMTSLEN S:GMTSUNT="W" GMTSDIF=GMTSLEN*7
"RTN","GMTSOBS2",44,0)
 . S:GMTSUNT="M" GMTSDIF=GMTSLEN*30.4 S:GMTSUNT="Y" GMTSDIF=GMTSLEN*365.25
"RTN","GMTSOBS2",45,0)
 . S GMTSDIF=$P(GMTSDIF,".",1),GMTSPX2=$$FMADD^XLFDT(GMTSPX1,-(GMTSDIF))
"RTN","GMTSOBS2",46,0)
 S GMTSNOD=$P(GMTSR,U,5) S:+GMTSNOD>0 GMTSOBJ("SUPPRESS COMPONENTS")=""
"RTN","GMTSOBS2",47,0)
 S GMTSHDR=$P(GMTSR,U,6) S:+GMTSHDR>0 GMTSOBJ=""
"RTN","GMTSOBS2",48,0)
 S GMTSULB=$P(GMTSR,U,7) S:+GMTSULB>0 GMTSOBJ("USE LABEL")=""
"RTN","GMTSOBS2",49,0)
 S GMTSLBB=$P(GMTSR,U,8) S:+GMTSLBB>0 GMTSOBJ("LABEL BLANK LINE")=""
"RTN","GMTSOBS2",50,0)
 S GMTSRDT=$P(GMTSR,U,9) S:+GMTSRDT>0 GMTSOBJ("DATE LINE")=""
"RTN","GMTSOBS2",51,0)
 S GMTSCON=$P(GMTSR,U,10) S:+GMTSCON>0 GMTSOBJ("CONFIDENTIAL")=""
"RTN","GMTSOBS2",52,0)
 S GMTSRHD=$P(GMTSR,U,11) S:+GMTSRHD>0 GMTSOBJ("REPORT HEADER")=""
"RTN","GMTSOBS2",53,0)
 S GMTSCHD=$P(GMTSR,U,12) S:+GMTSCHD>0 GMTSOBJ("COMPONENT HEADER")=""
"RTN","GMTSOBS2",54,0)
 S GMTSUND=$P(GMTSR,U,13) S:+GMTSUND>0 GMTSOBJ("UNDERLINE")=""
"RTN","GMTSOBS2",55,0)
 S GMTSLIM=$P(GMTSR,U,14) S:+GMTSLIM>0 GMTSOBJ("LIMITS")=""
"RTN","GMTSOBS2",56,0)
 S GMTSBLK=$P(GMTSR,U,15) S:+GMTSBLK>0 GMTSOBJ("BLANK LINE")=""
"RTN","GMTSOBS2",57,0)
 S GMTSDEC=$P(GMTSR,U,16) S:+GMTSDEC>0 GMTSOBJ("DECEASED")=""
"RTN","GMTSOBS2",58,0)
 K:GMTSCHD'>0 GMTSOBJ("LIMITS"),GMTSOBJ("BLANK LINE")
"RTN","GMTSOBS2",59,0)
 K:+($G(GMTSHDR))'>0 GMTSOBJ  S GMTSIOM=$G(IOM),IOM=80,GMTSOBJE=""
"RTN","GMTSOBS2",60,0)
 D ENX^GMTSDVR(DFN,GMTSTYP,GMTSPX2,GMTSPX1) S:+GMTSIOM>0 IOM=+GMTSIOM
"RTN","GMTSOBS2",61,0)
 Q
"RTN","GMTSOBS2",62,0)
SP ; Suppress Headers
"RTN","GMTSOBS2",63,0)
 N GMTSL,GMTST,TXT S (GMTST,GMTSL)="" S:$L($G(GMTSLBL)) GMTSL=GMTSLBL
"RTN","GMTSOBS2",64,0)
 S:+($G(GMTSRDT))'>0 GMTSL=GMTSL_$J("",((72-$L(GMTSDTM))-$L(GMTSL)))_GMTSDTM
"RTN","GMTSOBS2",65,0)
 I $L(GMTSL)&(+($G(GMTSPLB))>0) D E("") S TXT="",TXT=$J(" ",7)_GMTSL D E(TXT)
"RTN","GMTSOBS2",66,0)
 I $L($G(GMTSLBL))&(+($G(GMTSPLB))>0)&(+($G(GMTSLBB))>0) D E("")
"RTN","GMTSOBS2",67,0)
 S GMTSL="" S:+($G(GMTSRDT))>0 GMTSL=$J("",(72-$L(GMTSDTM)))_GMTSDTM
"RTN","GMTSOBS2",68,0)
 S TXT="",TXT=TXT_$J(" ",7)_GMTSL D:$L(GMTSL) E(TXT)
"RTN","GMTSOBS2",69,0)
 S GMTSL="" S:GMTSCON>0 GMTSL="********************  CONFIDENTIAL HEALTH SUMMARY **********************"
"RTN","GMTSOBS2",70,0)
 S TXT="",TXT=TXT_$J(" ",7)_GMTSL D:$L(GMTSL) E(TXT)
"RTN","GMTSOBS2",71,0)
 S GMTSL="" S:GMTSRHD>0 GMTSL="PATIENT NAME      SSN-SSN-SSAN       WARD/LOCATTION        DATE OF BIRTH"
"RTN","GMTSOBS2",72,0)
 S TXT="",TXT=TXT_$J(" ",7)_GMTSL D:$L(GMTSL) E(TXT)
"RTN","GMTSOBS2",73,0)
 S GMTSL="" S:GMTSRHD>0 GMTSL=" "
"RTN","GMTSOBS2",74,0)
 S TXT="",TXT=TXT_$J(" ",7)_GMTSL D:$L(GMTSL) E(TXT)
"RTN","GMTSOBS2",75,0)
 S (GMTSL,GMTST)="" S:GMTSCHD'>0 GMTSL=GMTSDCN S:GMTSCHD>0 (GMTST,GMTSL)=GMTSDCH
"RTN","GMTSOBS2",76,0)
 S:GMTSCHD>0&(GMTSLIM)>0&($L(GMTSTIM)) (GMTST,GMTSL)=GMTSDCH_" (max 10 occurrences or "_GMTSTIM_")"
"RTN","GMTSOBS2",77,0)
 S TXT="",TXT=TXT_$J(" ",7)_GMTSL D:$L(GMTSL) E(TXT)
"RTN","GMTSOBS2",78,0)
 S GMTSL="" S:+($G(GMTSUND))>0&($L(GMTST)) $P(GMTSL,"-",$L(GMTST))="-"
"RTN","GMTSOBS2",79,0)
 S TXT="",TXT=TXT_$J(" ",7)_GMTSL D:$L(GMTSL) E(TXT)
"RTN","GMTSOBS2",80,0)
 S GMTSL="" S:GMTSDEC>0 GMTSL="                       **  DECEASED "_GMTSDED_"  **"
"RTN","GMTSOBS2",81,0)
 S TXT="",TXT=TXT_$J(" ",7)_GMTSL D:$L(GMTSL) E(TXT)
"RTN","GMTSOBS2",82,0)
 S GMTSL="" S:GMTSBLK>0 GMTSL=" " S TXT="",TXT=TXT_$J(" ",7)_GMTSL D:$L(GMTSL) E(TXT)
"RTN","GMTSOBS2",83,0)
 S GMTSL="<component data>" S TXT="",TXT=TXT_$J(" ",7)_GMTSL D:$L(GMTSL) E(TXT)
"RTN","GMTSOBS2",84,0)
 W:'$D(GMTSEXT) !
"RTN","GMTSOBS2",85,0)
 Q
"RTN","GMTSOBS2",86,0)
HS ; Health Summary Headers
"RTN","GMTSOBS2",87,0)
 N GMTSL,GMTST,TXT S GMTSL="" S:$L($G(GMTSLBL)) GMTSL=GMTSLBL
"RTN","GMTSOBS2",88,0)
 I $L(GMTSL)&(+($G(GMTSPLB))>0) D E(" ") S TXT="",TXT=TXT_$J(" ",7)_GMTSL D:$L(GMTSL) E(TXT)
"RTN","GMTSOBS2",89,0)
 D:$L(GMTSL)&(+($G(GMTSPLB))>0)&(+($G(GMTSLBB))>0) E(" ")
"RTN","GMTSOBS2",90,0)
 S GMTSL=$J("",(72-$L(GMTSDTM)))_GMTSDTM
"RTN","GMTSOBS2",91,0)
 S TXT="",TXT=TXT_$J(" ",7)_GMTSL D:$L(GMTSL) E(TXT)
"RTN","GMTSOBS2",92,0)
 S GMTSL="********************  CONFIDENTIAL HEALTH SUMMARY **********************"
"RTN","GMTSOBS2",93,0)
 S TXT="",TXT=TXT_$J(" ",7)_GMTSL D:$L(GMTSL) E(TXT)
"RTN","GMTSOBS2",94,0)
 S GMTSL="PATIENT NAME      SSN-SSN-SSAN       WARD/LOCATTION        DATE OF BIRTH"
"RTN","GMTSOBS2",95,0)
 S TXT="",TXT=TXT_$J(" ",7)_GMTSL D:$L(GMTSL) E(TXT)
"RTN","GMTSOBS2",96,0)
 S GMTSL="       "_GMTSDCH_" (max 10 occurrences or "_GMTSTIM_")"
"RTN","GMTSOBS2",97,0)
 S TXT="",TXT=TXT_$J(" ",7)_GMTSL D:$L(GMTSL) E(TXT)
"RTN","GMTSOBS2",98,0)
 S GMTSL="                         **  DECEASED "_GMTSDED_"  **"
"RTN","GMTSOBS2",99,0)
 S TXT="",TXT=TXT_$J(" ",7)_GMTSL D:$L(GMTSL) E(TXT)
"RTN","GMTSOBS2",100,0)
 S GMTSL="<component data>"
"RTN","GMTSOBS2",101,0)
 S TXT="",TXT=TXT_$J(" ",7)_GMTSL D:$L(GMTSL) E(TXT)
"RTN","GMTSOBS2",102,0)
 W:'$D(GMTSEXT) !
"RTN","GMTSOBS2",103,0)
 Q
"RTN","GMTSOBS2",104,0)
D(X) ; Display
"RTN","GMTSOBS2",105,0)
 I '$D(GMTSEXT) W !,$G(X) Q
"RTN","GMTSOBS2",106,0)
 N GMTSC S GMTSC=$G(GMTSARY("D",0))+1,GMTSARY("D",+GMTSC)=$G(X),GMTSARY("D",0)=GMTSC
"RTN","GMTSOBS2",107,0)
 Q
"RTN","GMTSOBS2",108,0)
E(X) ; Example
"RTN","GMTSOBS2",109,0)
 I '$D(GMTSEXT) W !,$G(X) Q
"RTN","GMTSOBS2",110,0)
 N GMTSC S GMTSC=$G(GMTSARY("E",0))+1,GMTSARY("E",+GMTSC)=$G(X),GMTSARY("E",0)=GMTSC
"RTN","GMTSOBS2",111,0)
 Q
"RTN","GMTSOBT")
0^4^B57073693
"RTN","GMTSOBT",1,0)
GMTSOBT ; SLC/KER - HS Object - Time and Type        ; 01/06/2003
"RTN","GMTSOBT",2,0)
 ;;2.7;Health Summary;**58**;Oct 20, 1995
"RTN","GMTSOBT",3,0)
 ;                
"RTN","GMTSOBT",4,0)
 ; External References
"RTN","GMTSOBT",5,0)
 ;   DBIA  10104  $$UP^XLFSTR
"RTN","GMTSOBT",6,0)
 ;   DBIA  10088  ENDR^%ZISS
"RTN","GMTSOBT",7,0)
 ;   DBIA  10026  ^DIR        
"RTN","GMTSOBT",8,0)
 ;            
"RTN","GMTSOBT",9,0)
 Q
"RTN","GMTSOBT",10,0)
TP ; Time Period
"RTN","GMTSOBT",11,0)
 Q:+($G(GMTSQ))>0  N X,Y,DIR,GMTSX,GMTSDEF K GMTSOBJ("TIME")
"RTN","GMTSOBT",12,0)
 S GMTSDEF=$$TIM($P($G(^GMT(142.5,+($G(GMTSDA)),0)),U,4))
"RTN","GMTSOBT",13,0)
 S DIR("A")=" Enter REPORT PERIOD:  ",DIR("B")="3M" S:$L(GMTSDEF) DIR("B")=GMTSDEF
"RTN","GMTSOBT",14,0)
 S DIR(0)="FAO^2;5^S X=$$TIM^GMTSOBT(X) S:$L(X) GMTSX=X K:'$L(X) X"
"RTN","GMTSOBT",15,0)
 S (DIR("?"),DIR("??"))="^D TH^GMTSOBT"
"RTN","GMTSOBT",16,0)
 D ^DIR S:$D(DIROUT)!($D(DTOUT)) GMTSQ=1
"RTN","GMTSOBT",17,0)
 Q:+($G(GMTSQ))>0  Q:'$L($G(GMTSX))  W "  ",GMTSX S GMTSOBJ("TIME")=$G(GMTSX)
"RTN","GMTSOBT",18,0)
 Q
"RTN","GMTSOBT",19,0)
TH ;   Time Help
"RTN","GMTSOBT",20,0)
 D ATTR
"RTN","GMTSOBT",21,0)
 W !,"     Enter a time limit for the Health Summary report/object.  It"
"RTN","GMTSOBT",22,0)
 W !,"     must be in the format of a numeric time length and an alpha"
"RTN","GMTSOBT",23,0)
 W !,"     time unit, and can not exceed 5 characters.  If no time unit"
"RTN","GMTSOBT",24,0)
 W !,"     is provided, then the time unit will be set to Days (D), i.e.,"
"RTN","GMTSOBT",25,0)
 W !,"     "
"RTN","GMTSOBT",26,0)
 W !,$G(BOLD),"                 11, 2D, 4D, 6W, 18W, 3M, 6M, 1Y",$G(NORM)
"RTN","GMTSOBT",27,0)
 D KATTR
"RTN","GMTSOBT",28,0)
 Q
"RTN","GMTSOBT",29,0)
TIM(X) ;   Input Transform for Time
"RTN","GMTSOBT",30,0)
 Q:$L(X)=1&(X="@") X  S X=$$UP^XLFSTR($G(X)) Q:$L($G(X))>5 ""  Q:$L((+($G(X))))>4 ""  S X=$G(X)
"RTN","GMTSOBT",31,0)
 N GMTSLEN,GMTSUNIT S GMTSLEN=+X,GMTSUNIT=$E(X,$L(X)) S:+GMTSUNIT>0 GMTSUNIT="D" S:$L(GMTSLEN)=$L(X) GMTSUNIT="D"
"RTN","GMTSOBT",32,0)
 Q:GMTSUNIT'="D"&(GMTSUNIT'="W")&(GMTSUNIT'="M")&(GMTSUNIT'="Y") ""
"RTN","GMTSOBT",33,0)
 I GMTSUNIT="D",GMTSLEN>5 D
"RTN","GMTSOBT",34,0)
 . N GMTSO S GMTSO=GMTSLEN I +GMTSLEN>89!(GMTSLEN#7=0)!(GMTSLEN#7=6) D
"RTN","GMTSOBT",35,0)
 . . S GMTSLEN=GMTSLEN\7,GMTSUNIT="W"
"RTN","GMTSOBT",36,0)
 . . S:GMTSO#7>3 GMTSLEN=GMTSLEN+1
"RTN","GMTSOBT",37,0)
 . I GMTSUNIT="D",GMTSLEN#32>28 D
"RTN","GMTSOBT",38,0)
 . . S GMTSLEN=GMTSLEN\32 S:GMTSO#32>28 GMTSLEN=GMTSLEN+1 S GMTSUNIT="M"
"RTN","GMTSOBT",39,0)
 I GMTSUNIT="W",GMTSLEN>3 D
"RTN","GMTSOBT",40,0)
 . N GMTSO S GMTSO=GMTSLEN I +GMTSLEN>23!(GMTSLEN#4=3)!(GMTSLEN#4=0) D
"RTN","GMTSOBT",41,0)
 . . S GMTSLEN=GMTSLEN\4.333333333,GMTSUNIT="M"
"RTN","GMTSOBT",42,0)
 . . S:GMTSO#4.333333333>3 GMTSLEN=GMTSLEN+1
"RTN","GMTSOBT",43,0)
 I GMTSUNIT="M",GMTSLEN>11 D
"RTN","GMTSOBT",44,0)
 . N GMTSO S GMTSO=GMTSLEN I GMTSLEN#12=11!(GMTSLEN#12=0) D
"RTN","GMTSOBT",45,0)
 . . S GMTSLEN=GMTSLEN\12,GMTSUNIT="Y" S:GMTSO#12=11 GMTSLEN=GMTSLEN+1
"RTN","GMTSOBT",46,0)
 S X=GMTSLEN_GMTSUNIT
"RTN","GMTSOBT",47,0)
 Q X
"RTN","GMTSOBT",48,0)
 ;                    
"RTN","GMTSOBT",49,0)
TYPE(I) ; Select Type
"RTN","GMTSOBT",50,0)
 ;   Uses Fileman's DIC variables for Lookup
"RTN","GMTSOBT",51,0)
 N GMTSHDR,GMTSNOQ,GMTSNOI,GMTSX,GMTSREDO
"RTN","GMTSOBT",52,0)
TY2 ;   Prompt for Type
"RTN","GMTSOBT",53,0)
 S GMTSX=$$TYPE^GMTSULT I X["@" S X="@",Y=-1 Q -1
"RTN","GMTSOBT",54,0)
 Q:+GMTSX'>0 -1
"RTN","GMTSOBT",55,0)
 S GMTSHDR(1)="You have selected the following Health Summary Type to use as an Object:"
"RTN","GMTSOBT",56,0)
 S GMTSHDR(2)=" ",GMTSNOQ="",GMTSNOI="",GMTSREDO=0
"RTN","GMTSOBT",57,0)
 D DT^GMTSOBD(+GMTSX) I $D(^TMP("GMTSOBT",$J)) D
"RTN","GMTSOBT",58,0)
 . D NOQUE^GMTSOBD W ! N DIR,DTOUT,DUOUT S DIR(0)="YAO",DIR("A")="Is this correct?  ",DIR("B")="Y"
"RTN","GMTSOBT",59,0)
 . D ^DIR S:$$UP^XLFSTR($E(X,1))="N" GMTSREDO=1 I +Y'>0 S GMTSX=-1
"RTN","GMTSOBT",60,0)
 W:+GMTSREDO>0 ! G:+GMTSREDO>0 TY2
"RTN","GMTSOBT",61,0)
 D XY(GMTSX) S I=GMTSX K ^TMP("GMTSOBT",$J)
"RTN","GMTSOBT",62,0)
 Q I
"RTN","GMTSOBT",63,0)
 ;                   
"RTN","GMTSOBT",64,0)
RP(TYPE,OBJ) ; Report Period
"RTN","GMTSOBT",65,0)
 ;   Input    TYPE   Required, Health Summary Type IEN
"RTN","GMTSOBT",66,0)
 ;            OBJ    Optional, Health Summary Object IEN
"RTN","GMTSOBT",67,0)
 ;
"RTN","GMTSOBT",68,0)
 ;   Output   X      Report Period, "" or "@"
"RTN","GMTSOBT",69,0)
 ;            GMTSQ  Up Arrow/Time Out
"RTN","GMTSOBT",70,0)
 ;
"RTN","GMTSOBT",71,0)
 Q:+($G(GMTSQ))>0 ""  N X,Y,DIR,GMTSX,GMTSDEF,GMTSS,GMTSTY,GMTSOB K GMTSOBJ("TIME") S GMTSOB=+($G(OBJ)),GMTSTY=+($G(TYPE)) Q:+GMTSTY=0 "@"
"RTN","GMTSOBT",72,0)
 S GMTSS=$$RT(GMTSTY) Q:+($G(GMTSQ))>0 -1  Q:GMTSS'>0 "@"
"RTN","GMTSOBT",73,0)
 S GMTSDEF=$$TIM($P($G(^GMT(142.5,+($G(GMTSDA)),0)),U,4))
"RTN","GMTSOBT",74,0)
 S DIR("A")=" Enter new TIME LIMIT:  " S:$L(GMTSDEF) DIR("B")=GMTSDEF
"RTN","GMTSOBT",75,0)
 S DIR(0)="FAO^1;5^S X=$$TIM^GMTSOBT(X) S:$L(X) GMTSX=X K:'$L(X) X"
"RTN","GMTSOBT",76,0)
 S (DIR("?"),DIR("??"))="^D TH^GMTSOBT" W ! D ^DIR I X="@",Y="" Q X
"RTN","GMTSOBT",77,0)
 S:$D(DIRUT)!($D(DIROUT))!($D(DTOUT))!($D(DUOUT)) GMTSQ=1 Q:+($G(GMTSQ))>0 -1
"RTN","GMTSOBT",78,0)
 Q:'$L($G(GMTSX)) ""  W "  ",GMTSX S GMTSOBJ("TIME")=$G(GMTSX)
"RTN","GMTSOBT",79,0)
 S X=GMTSX
"RTN","GMTSOBT",80,0)
 Q X
"RTN","GMTSOBT",81,0)
RT(X) ;   Report Period or Time Limits
"RTN","GMTSOBT",82,0)
 ;     Input  X   IEN or Health Summary Type
"RTN","GMTSOBT",83,0)
 Q:+($G(GMTSQ))>0 -1  N Y,DIR,GMTSX S GMTSX=+($G(X)) D RTA(+GMTSX)
"RTN","GMTSOBT",84,0)
 I '$D(DIR("A")) S DIR("A",1)=" Overwrite Health Summary Type Time Limits ",DIR("A")=" with Health Summary Object Report Period?  "
"RTN","GMTSOBT",85,0)
 S DIR(0)="YAO",DIR("B")="N",(DIR("?"),DIR("??"))="^D RTH^GMTSOBT(GMTSX)"
"RTN","GMTSOBT",86,0)
 W ! D ^DIR S:$D(DIRUT)!($D(DIROUT))!($D(DTOUT))!($D(DUOUT)) GMTSQ=1
"RTN","GMTSOBT",87,0)
 Q:+($G(GMTSQ))>0 -1 S X=+($G(Y))
"RTN","GMTSOBT",88,0)
 Q X
"RTN","GMTSOBT",89,0)
RTH(X) ;   Report Period or Time Limits Help
"RTN","GMTSOBT",90,0)
 ;     Input  X   IEN or Health Summary Type
"RTN","GMTSOBT",91,0)
 D LS(+($G(X))) W !
"RTN","GMTSOBT",92,0)
 D ATTR
"RTN","GMTSOBT",93,0)
 W !,"     Entering a new TIME LIMIT for the Health Summary Object will "
"RTN","GMTSOBT",94,0)
 W !,"     overwrite the TIME LIMITS set the for individual components. "
"RTN","GMTSOBT",95,0)
 W !,"     It must be alpha numeric and can not exceed 5 characters."
"RTN","GMTSOBT",96,0)
 W !,"     Examples:  ",$G(BOLD),"3D, 6W, 3M, 1Y",$G(NORM)
"RTN","GMTSOBT",97,0)
 D KATTR
"RTN","GMTSOBT",98,0)
 Q
"RTN","GMTSOBT",99,0)
RTA(X) ;   Report Period or Time Limit DIR(A)
"RTN","GMTSOBT",100,0)
 D ATTR K DIR("A") N GMTSC,GMTST,GMTSP,GMTSS,GMTSR,GMTSI,GMTSN S GMTSI=+($G(X)) Q:+X'>0
"RTN","GMTSOBT",101,0)
 S GMTSN=$P($G(^GMT(142,+GMTSI,0)),"^",1)
"RTN","GMTSOBT",102,0)
 Q:'$L(GMTSN)
"RTN","GMTSOBT",103,0)
 I $L(GMTSN) D
"RTN","GMTSOBT",104,0)
 . S GMTST="Do you want to overwrite the TIME LIMITS in the Health Summary Type '"
"RTN","GMTSOBT",105,0)
 . S GMTST=GMTST_$$UP^XLFSTR(GMTSN)_"'?"
"RTN","GMTSOBT",106,0)
 I '$L(GMTSN) D
"RTN","GMTSOBT",107,0)
 . S GMTST="Do you want to overwrite the TIME LIMITS in the Health Summary Type?"
"RTN","GMTSOBT",108,0)
 F  Q:'$L($$TRIM(GMTST))  D
"RTN","GMTSOBT",109,0)
 . I $L(GMTST)'>60 S GMTSC=+($G(GMTSC))+1,DIR("A",GMTSC)=" "_$$TRIM(GMTST)_"  ",GMTST="" Q
"RTN","GMTSOBT",110,0)
 . S GMTSS=$E($$TRIM(GMTST),1,60),GMTSS=$P(GMTSS," ",1,($L(GMTSS," ")-1)),GMTSR=$P($$TRIM(GMTST),GMTSS,2,299),GMTST=GMTSR,GMTSC=+($G(GMTSC))+1,DIR("A",GMTSC)=" "_$$TRIM(GMTSS)_"  "
"RTN","GMTSOBT",111,0)
 S:+($G(GMTSC))>0 DIR("A")=DIR("A",GMTSC) K:+($G(GMTSC))>0 DIR("A",GMTSC)
"RTN","GMTSOBT",112,0)
 S (GMTSC,GMTSI)=0 F GMTSC=1:1 D  Q:GMTSI>0
"RTN","GMTSOBT",113,0)
 . S:'$D(DIR("A",GMTSC)) GMTSS="DIR(""A"")",GMTSI=1
"RTN","GMTSOBT",114,0)
 . S:$D(DIR("A",GMTSC)) GMTSS="DIR(""A"","_GMTSC_")"
"RTN","GMTSOBT",115,0)
 . S GMTST=@GMTSS I GMTST["Time Limits" S GMTST=$P(GMTST,"Time Limits",1)_$G(BOLD)_"Time Limits"_$G(NORM)_$P(GMTST,"Time Limits",2),@GMTSS=GMTST Q
"RTN","GMTSOBT",116,0)
 . S GMTST=@GMTSS I GMTST["Report Period" S GMTST=$P(GMTST,"Report Period",1)_$G(BOLD)_"Report Period"_$G(NORM)_$P(GMTST,"Report Period",2),@GMTSS=GMTST Q
"RTN","GMTSOBT",117,0)
 . S GMTST=@GMTSS I GMTST["a Report" S GMTST=$P(GMTST,"a Report",1)_"a "_$G(BOLD)_"Report"_$G(NORM)_$P(GMTST,"a Report",2),@GMTSS=GMTST
"RTN","GMTSOBT",118,0)
 . S GMTST=@GMTSS I GMTST["Period which" S GMTST=$P(GMTST,"Period which",1)_$G(BOLD)_"Period"_$G(NORM)_" which"_$P(GMTST,"Period which",2,299),@GMTSS=GMTST
"RTN","GMTSOBT",119,0)
 D KATTR
"RTN","GMTSOBT",120,0)
 Q
"RTN","GMTSOBT",121,0)
LS(X) ; List Structure
"RTN","GMTSOBT",122,0)
 D ATTR
"RTN","GMTSOBT",123,0)
 N GMTST,GMTSS,GMTSC,GMTSTA,GMTSI,GMTSAB,GMTSOL,GMTSTL,GMTSNM,GMTSHD,GMTSCT
"RTN","GMTSOBT",124,0)
 S GMTST=+($G(X)) Q:'$D(^GMT(142,+GMTST,0))!('$D(^GMT(142,+GMTST,1))) 0
"RTN","GMTSOBT",125,0)
 S (GMTSCT,GMTSTA,GMTSI)=0
"RTN","GMTSOBT",126,0)
 F  S GMTSI=$O(^GMT(142,+GMTST,1,GMTSI)) Q:+GMTSI=0  D  Q:+($G(GMTSCT))>1
"RTN","GMTSOBT",127,0)
 . S GMTSS=$G(^GMT(142,+GMTST,1,GMTSI,0)),GMTSC=$G(^GMT(142.1,+($P(GMTSS,"^",2)),0)) Q:+($P(GMTSS,"^",4))'>0!($P(GMTSC,"^",3)'="Y")
"RTN","GMTSOBT",128,0)
 . S GMTSOL=$P(GMTSS,"^",3) S:'$L(GMTSOL) GMTSOL="--" S GMTSTL=$P(GMTSS,"^",4),GMTSNM=$$EN2^GMTSUMX($P(GMTSC,"^",1))
"RTN","GMTSOBT",129,0)
 . S GMTSHD=$P(GMTSC,"^",9) S:$L(GMTSHD) GMTSNM=GMTSNM S GMTSAB=$P(GMTSC,"^",4),GMTSCT=+($G(GMTSCT))+1
"RTN","GMTSOBT",130,0)
 . I GMTSCT=1 D
"RTN","GMTSOBT",131,0)
 . . W !,"     Example of Health Summary Type component ",$G(BOLD),"TIME LIMITS",$G(NORM),!
"RTN","GMTSOBT",132,0)
 . . W !,?9,"Abbr",?15,"Component Name",?45,"Max Occurrences",?62,$G(BOLD),"Time Limits",$G(NORM)
"RTN","GMTSOBT",133,0)
 . . W !,?9,"----------------------------------------------------------------"
"RTN","GMTSOBT",134,0)
 . W !,?9,GMTSAB,?15,GMTSNM,?49,$J(GMTSOL,4),?63,$G(BOLD),$J(GMTSTL,5),$G(NORM)
"RTN","GMTSOBT",135,0)
 D KATTR
"RTN","GMTSOBT",136,0)
 Q
"RTN","GMTSOBT",137,0)
TA(X) ; Time Limits Applicable
"RTN","GMTSOBT",138,0)
 N GMTST,GMTSS,GMTSC,GMTSTA,GMTSI
"RTN","GMTSOBT",139,0)
 S GMTST=+($G(X)) Q:'$D(^GMT(142,+GMTST,0))!('$D(^GMT(142,+GMTST,1))) 0
"RTN","GMTSOBT",140,0)
 S (GMTSTA,GMTSI)=0
"RTN","GMTSOBT",141,0)
 F  S GMTSI=$O(^GMT(142,+GMTST,1,GMTSI)) Q:+GMTSI=0  D  Q:+GMTSTA>0
"RTN","GMTSOBT",142,0)
 . S GMTSS=$G(^GMT(142,+GMTST,1,GMTSI,0))
"RTN","GMTSOBT",143,0)
 . S GMTSC=$G(^GMT(142.1,+($P(GMTSS,"^",2)),0))
"RTN","GMTSOBT",144,0)
 . S:+($P(GMTSS,"^",4))>0&($P(GMTSC,"^",3)="Y") GMTSTA=1
"RTN","GMTSOBT",145,0)
 S X=GMTSTA
"RTN","GMTSOBT",146,0)
 Q X
"RTN","GMTSOBT",147,0)
 ;                     
"RTN","GMTSOBT",148,0)
 ; Miscellaneous
"RTN","GMTSOBT",149,0)
TRIM(X) ;   Trim Spaces
"RTN","GMTSOBT",150,0)
 S X=$G(X) F  Q:$E(X,1)'=" "  S X=$E(X,2,$L(X))
"RTN","GMTSOBT",151,0)
 F  Q:$E(X,$L(X))'=" "  S X=$E(X,1,($L(X)-1))
"RTN","GMTSOBT",152,0)
 Q X
"RTN","GMTSOBT",153,0)
XY(I) ;   Set X and Y Variables
"RTN","GMTSOBT",154,0)
 K Y,X S X=+($G(I)) I X'>0!('$D(^GMT(142,+X,0))) S Y=-1 Q
"RTN","GMTSOBT",155,0)
 S Y=+X_"^"_$P($G(^GMT(142,+X,0)),"^",1),Y(0)=$G(^GMT(142,+X,0)),Y(0,0)=$P($G(^GMT(142,+X,0)),"^",1),Y(0,1)=$$EN^GMTSUMX(Y(0,0))
"RTN","GMTSOBT",156,0)
 Q
"RTN","GMTSOBT",157,0)
ATTR ;   Set Screen Attributes
"RTN","GMTSOBT",158,0)
 N X,IOINHI,IOINORM S X="IOINHI;IOINORM" D ENDR^%ZISS S BOLD=$G(IOINHI),NORM=$G(IOINORM) Q
"RTN","GMTSOBT",159,0)
KATTR ;   Kill Screen Attributes
"RTN","GMTSOBT",160,0)
 K NORM,BOLD Q
"RTN","GMTSOBU")
0^21^B46165744
"RTN","GMTSOBU",1,0)
GMTSOBU ; SLC/KER - HS Object - Utility           ; 01/06/2003
"RTN","GMTSOBU",2,0)
 ;;2.7;Health Summary;**58**;Oct 20, 1995
"RTN","GMTSOBU",3,0)
 ;                      
"RTN","GMTSOBU",4,0)
 ; External References
"RTN","GMTSOBU",5,0)
 ;   DBIA 10096  ^%ZOSF("DEL"
"RTN","GMTSOBU",6,0)
 ;   DBIA 10112  $$SITE^VASITE
"RTN","GMTSOBU",7,0)
 ;   DBIA 10104  $$UP^XLFSTR
"RTN","GMTSOBU",8,0)
 ;   DBIA 10026  ^DIR        
"RTN","GMTSOBU",9,0)
 ;
"RTN","GMTSOBU",10,0)
 ; Errors
"RTN","GMTSOBU",11,0)
ER1 ;   Health Summary Object Exist
"RTN","GMTSOBU",12,0)
 N GMTSTXT,GMTSLN S GMTSTXT="Can not install Health Summary Object '"_GMTSOBJ_"'.  A Health Summary Object with the same name already exist." D WER S GMTSQIT=1 Q
"RTN","GMTSOBU",13,0)
ER2 ;   Health Summary Type Exist
"RTN","GMTSOBU",14,0)
 N GMTSTXT,GMTSLN S GMTSTXT="Can not install Health Summary Type '"_GMTSTYP_"' for use by the Health Summary Object '"_GMTSOBJ_"'.  A Health Summary Type with the same name already exist." D WER S GMTSQIT=1 Q
"RTN","GMTSOBU",15,0)
ER3 ;   Health Summary Title Exist
"RTN","GMTSOBU",16,0)
 N GMTSTXT,GMTSLN S GMTSTXT="Can not install Health Summary Type '"_GMTSTYP_"' for use by the Health Summary Object '"_GMTSOBJ_"'.  A Health Summary Type with the same TITLE ("_GMTSTTL_") already exist." D WER S GMTSQIT=1 Q
"RTN","GMTSOBU",17,0)
WER ;   Write Error
"RTN","GMTSOBU",18,0)
 W !," Error:"
"RTN","GMTSOBU",19,0)
WER2 ;   Write Error Text
"RTN","GMTSOBU",20,0)
 S GMTSLN=$$TRIM($E(GMTSTXT,1,65)),GMTSLN=$$TRIM($P(GMTSLN," ",1,($L(GMTSLN," ")-1))) S:$L(GMTSTXT)<65 GMTSLN=$$TRIM(GMTSTXT) W:$L(GMTSLN) !,"    ",GMTSLN
"RTN","GMTSOBU",21,0)
 S GMTSTXT=$$TRIM($P(GMTSTXT,GMTSLN,2,299)),GMTSLN=$$TRIM($E(GMTSTXT,1,65)),GMTSLN=$$TRIM($P(GMTSLN," ",1,($L(GMTSLN," ")-1))) S:$L(GMTSTXT)<65 GMTSLN=$$TRIM(GMTSTXT) W:$L(GMTSLN) !,"    ",GMTSLN
"RTN","GMTSOBU",22,0)
 S GMTSTXT=$$TRIM($P(GMTSTXT,GMTSLN,2,299)),GMTSLN=$$TRIM($E(GMTSTXT,1,65)),GMTSLN=$$TRIM($P(GMTSLN," ",1,($L(GMTSLN," ")-1))) S:$L(GMTSTXT)<65 GMTSLN=$$TRIM(GMTSTXT) W:$L(GMTSLN) !,"    ",GMTSLN
"RTN","GMTSOBU",23,0)
 Q
"RTN","GMTSOBU",24,0)
 ;                     
"RTN","GMTSOBU",25,0)
EHST(X) ; Existing Health Summary Type
"RTN","GMTSOBU",26,0)
 N GMTSRTN,GMTSEDAT,GMTSOBJ,GMTSTYP,GMTSTXT,GMTSLN,GMTS
"RTN","GMTSOBU",27,0)
 N Y,DIR,DIROUT,DTOUT,DUOUT
"RTN","GMTSOBU",28,0)
 S GMTSRTN="GMTSOBX",GMTSOBJ=$P($$TX(GMTSRTN,"OBJ",1),";",2),GMTSTYP=$P($$TX(GMTSRTN,"TYPE",1),";",2)
"RTN","GMTSOBU",29,0)
 Q:'$L(GMTSOBJ)!('$L(GMTSTYP)) 0
"RTN","GMTSOBU",30,0)
 W ! S GMTSTXT="Can not install Health Summary Type '"_GMTSTYP_"' to be used"
"RTN","GMTSOBU",31,0)
 S GMTSTXT=GMTSTXT_" by the object.  A Health Summary Type with the same name already exist." D WER2
"RTN","GMTSOBU",32,0)
 S GMTSEDAT=$$NWX(GMTSTYP) Q:+($G(GMTSEDAT))'>0 0
"RTN","GMTSOBU",33,0)
 S GMTSTXT="Do you want to use the pre-existing Health Summary Type '"_GMTSTYP_"' for this Object?  (Y/N)"
"RTN","GMTSOBU",34,0)
 S GMTSLN=$$TRIM($E(GMTSTXT,1,65))
"RTN","GMTSOBU",35,0)
 S GMTSLN=$$TRIM($P(GMTSLN," ",1,($L(GMTSLN," ")-1)))
"RTN","GMTSOBU",36,0)
 S:$L(GMTSTXT)<65 GMTSLN=$$TRIM(GMTSTXT) S:$L(GMTSLN) DIR("A",1)="    "_GMTSLN_"  "
"RTN","GMTSOBU",37,0)
 S GMTSTXT=$$TRIM($P(GMTSTXT,GMTSLN,2,299))
"RTN","GMTSOBU",38,0)
 S GMTSLN=$$TRIM($E(GMTSTXT,1,65))
"RTN","GMTSOBU",39,0)
 S GMTSLN=$$TRIM($P(GMTSLN," ",1,($L(GMTSLN," ")-1)))
"RTN","GMTSOBU",40,0)
 S:$L(GMTSTXT)<65 GMTSLN=$$TRIM(GMTSTXT) S:$L(GMTSLN) DIR("A")="    "_GMTSLN_"  "
"RTN","GMTSOBU",41,0)
 S DIR("B")="N",DIR(0)="YAO",(DIR("?"),DIR("??"))="^D YNH^GMTSOBU" W ! D ^DIR
"RTN","GMTSOBU",42,0)
 S GMTS=+($G(Y)) S X=0,GMTSQIT=1
"RTN","GMTSOBU",43,0)
 ;   Don't use the pre-existing HS
"RTN","GMTSOBU",44,0)
 I +GMTS'>0 S GMTSQIT=1,GMTSEDAT=0 D  Q X
"RTN","GMTSOBU",45,0)
 . ;   Rename HS
"RTN","GMTSOBU",46,0)
 . D REN I $L($G(GMTSETYP)),$L($G(GMTSETTL)) S GMTSTYP=GMTSETYP,GMTSTTL=GMTSETTL,(GMTSEDAT,GMTSDAT)=$$TIEN
"RTN","GMTSOBU",47,0)
 . S X=+GMTSEDAT S:+X>0 GMTSQIT=0
"RTN","GMTSOBU",48,0)
 ;   Use the pre-existing HS
"RTN","GMTSOBU",49,0)
 I +GMTS>0,$L(GMTSTYP) S GMTSTE=1,(X,GMTSEDAT)=+($G(GMTSDAT)),GMTSQIT=0
"RTN","GMTSOBU",50,0)
 Q X
"RTN","GMTSOBU",51,0)
REN ; Rename Health Summary Type
"RTN","GMTSOBU",52,0)
 N DIR,DIROUT,DUOUT,DTOUT,X,Y,GMTSNN,GMTSNT,GMTSNA S (GMTSETYP,GMTSETTL)=""
"RTN","GMTSOBU",53,0)
 S DIR("A")="    Do you want to rename the imported Health Summary Type? (Y/N) "
"RTN","GMTSOBU",54,0)
 S DIR("B")="Y",DIR(0)="YAO"
"RTN","GMTSOBU",55,0)
 S (DIR("?"),DIR("??"))="^D YNH^GMTSOBU"
"RTN","GMTSOBU",56,0)
 W ! D ^DIR Q:+Y=0
"RTN","GMTSOBU",57,0)
 S GMTSETYP=$$EDN($G(GMTSTYP)) Q:'$L($G(GMTSETYP))
"RTN","GMTSOBU",58,0)
 S GMTSETTL=$$EDT($G(GMTSTTL),$G(GMTSETYP)) S:'$L($G(GMTSETTL)) GMTSETYP=""
"RTN","GMTSOBU",59,0)
 Q
"RTN","GMTSOBU",60,0)
EDN(X) ; Edit Health Summary Type Name
"RTN","GMTSOBU",61,0)
 N DIR,DIROUT,DUOUT,DTOUT,Y,GMTSNN,GMTSON,GMTSNA,GMTSETYP
"RTN","GMTSOBU",62,0)
 S GMTSON=$G(X),GMTSETYP="" Q:'$L(GMTSON) ""
"RTN","GMTSOBU",63,0)
 S DIR("A")="      Re-Name '"_GMTSON_"' to:  "
"RTN","GMTSOBU",64,0)
 S GMTSNN=GMTSON F  S GMTSNN=$$TRIM($$NN(GMTSNN)) Q:+($$NWX(GMTSNN))=0
"RTN","GMTSOBU",65,0)
 S:$L(GMTSNN) DIR("B")=GMTSNN
"RTN","GMTSOBU",66,0)
 S DIR(0)="FAO^3:30^N GMTS S GMTS=$$CKN^GMTSOBU($G(X)) W:+GMTS=0&($L(X)) !!,""          '""_$G(X)_""' already exist."" K:+GMTS=0&($L(X)) X"
"RTN","GMTSOBU",67,0)
 S (DIR("?"),DIR("??"))="^D LNH^GMTSOBU"
"RTN","GMTSOBU",68,0)
 D ^DIR S X="" S:$L(Y)>2&($L(Y)<31) X=Y
"RTN","GMTSOBU",69,0)
 Q X
"RTN","GMTSOBU",70,0)
EDT(X,Y) ;  Edit Health Summary Type Title
"RTN","GMTSOBU",71,0)
 N DIR,DIROUT,DUOUT,DTOUT,GMTSNT,GMTSOT,GMTSTT,GMTSTY,GMTSNA,GMTSETYP
"RTN","GMTSOBU",72,0)
 S GMTSOT=$G(X),GMTSTT=$$EN2^GMTSUMX($G(Y)),GMTSTY=$G(Y)
"RTN","GMTSOBU",73,0)
 S GMTSNT=GMTSOT S:'$L(GMTSNT) GMTSNT=GMTSTT S GMTSNT=$$EN2^GMTSUMX(GMTSNT)
"RTN","GMTSOBU",74,0)
 F  S GMTSNT=$$TRIM($$NN(GMTSNT)) Q:+($$TWX(GMTSNT))=0
"RTN","GMTSOBU",75,0)
 S DIR("A")="      Title:  " S:$L(GMTSNT)>2&($L(GMTSNT)<31) DIR("B")=GMTSNT
"RTN","GMTSOBU",76,0)
 S DIR(0)="FAO^3:30^N GMTS S GMTS=$$CKT^GMTSOBU($G(X)) W:+GMTS=0&($L(X)) !!,""          '""_$G(X)_""' already exist."" K:+GMTS=0&($L(X)) X"
"RTN","GMTSOBU",77,0)
 S (DIR("?"),DIR("??"))="^D LNH^GMTSOBU"
"RTN","GMTSOBU",78,0)
 D ^DIR S X="" S:$L(Y)>2&($L(Y)<31) X=Y
"RTN","GMTSOBU",79,0)
 Q X
"RTN","GMTSOBU",80,0)
YNH ; Yes No Help
"RTN","GMTSOBU",81,0)
 W !,"        Enter either 'Y' or 'N'." Q
"RTN","GMTSOBU",82,0)
LNH ; Length Help
"RTN","GMTSOBU",83,0)
 W !,"          This response must have at least 3 characters and no more than 30"
"RTN","GMTSOBU",84,0)
 W !,"          characters and must not contain embedded uparrow." Q
"RTN","GMTSOBU",85,0)
CKN(X) ; Check New Name is Unique
"RTN","GMTSOBU",86,0)
 S X=$$NWX($G(X)) S X=$S(+X>0:0,1:1) Q X
"RTN","GMTSOBU",87,0)
CKT(X) ; Check New Title is Unique
"RTN","GMTSOBU",88,0)
 S X=$$TWX($G(X)) S X=$S(+X>0:0,1:1) Q X
"RTN","GMTSOBU",89,0)
 ;                     
"RTN","GMTSOBU",90,0)
 ; Miscellaneous
"RTN","GMTSOBU",91,0)
TIEN(X) ;   Type IEN
"RTN","GMTSOBU",92,0)
 N GMTSI,GMTSIEN S GMTSIEN=0 F GMTSI=5:1  D  Q:+GMTSIEN>0
"RTN","GMTSOBU",93,0)
 . Q:$G(^GMT(142,GMTSI,0))["GMTS HS ADHOC OPTION"  I GMTSI>4999999 S GMTSI=5999999 Q
"RTN","GMTSOBU",94,0)
 . S:'$D(^GMT(142,GMTSI)) GMTSIEN=GMTSI
"RTN","GMTSOBU",95,0)
 S X=GMTSIEN Q X
"RTN","GMTSOBU",96,0)
OIEN(X) ;   Object IEN
"RTN","GMTSOBU",97,0)
 N GMTSIEN,GMTSIT S GMTSIT=+($P($$SITE^VASITE,"^",3)) Q:+GMTSIT=0 -1
"RTN","GMTSOBU",98,0)
 S GMTSIEN=+($O(^GMT(142.5,(GMTSIT_"9999")),-1))+1 Q:$D(^GMT(142.5,+GMTSIEN,0)) -1
"RTN","GMTSOBU",99,0)
 S X=GMTSIEN
"RTN","GMTSOBU",100,0)
 Q X
"RTN","GMTSOBU",101,0)
BOX(X) ;   Get HS Object IEN from B Index
"RTN","GMTSOBU",102,0)
 N GMTSI,GMTSX,GMTSO,GMTSN S GMTSN=$G(X) Q:'$L(GMTSN) 0
"RTN","GMTSOBU",103,0)
 S (GMTSI,GMTSO)=0 F  S GMTSI=$O(^GMT(142.5,"B",$E(GMTSN,1,30),GMTSI)) Q:+GMTSI=0  D  Q:GMTSO>0
"RTN","GMTSOBU",104,0)
 . S GMTSX=$P($G(^GMT(142.5,+GMTSI,0)),"^",1) S:$$UP^XLFSTR(GMTSN)=$$UP^XLFSTR(GMTSX) GMTSO=GMTSI
"RTN","GMTSOBU",105,0)
 S X=+($G(GMTSO))
"RTN","GMTSOBU",106,0)
 Q X
"RTN","GMTSOBU",107,0)
NWX(X) ;   Get HS Name IEN from Word Index
"RTN","GMTSOBU",108,0)
 N GMTSI,GMTSX,GMTST,GMTSN,GMTSW S GMTSN=$$UP^XLFSTR($G(X)) Q:'$L(GMTSN) 0
"RTN","GMTSOBU",109,0)
 S GMTSW=$P(GMTSN," ",1),(GMTSI,GMTST)=0 F  S GMTSI=$O(^GMT(142,"AW",GMTSW,GMTSI)) Q:+GMTSI=0  D  Q:GMTST>0
"RTN","GMTSOBU",110,0)
 . S GMTSX=$P($G(^GMT(142,+GMTSI,0)),"^",1) S:$$UP^XLFSTR(GMTSN)=$$UP^XLFSTR(GMTSX) GMTST=GMTSI
"RTN","GMTSOBU",111,0)
 S X=+($G(GMTST))
"RTN","GMTSOBU",112,0)
 Q X
"RTN","GMTSOBU",113,0)
TWX(X) ;   Get HS Title IEN from Word Index
"RTN","GMTSOBU",114,0)
 N GMTSI,GMTSX,GMTST,GMTSN,GMTSW S GMTSN=$$UP^XLFSTR($G(X)) Q:'$L(GMTSN) 0
"RTN","GMTSOBU",115,0)
 S GMTSW=$P(GMTSN," ",1),(GMTSI,GMTST)=0 F  S GMTSI=$O(^GMT(142,"AW",GMTSW,GMTSI)) Q:+GMTSI=0  D  Q:GMTST>0
"RTN","GMTSOBU",116,0)
 . S GMTSX=$P($G(^GMT(142,+GMTSI,"T")),"^",1) S:$$UP^XLFSTR(GMTSN)=$$UP^XLFSTR(GMTSX) GMTST=GMTSI
"RTN","GMTSOBU",117,0)
 S X=+($G(GMTST))
"RTN","GMTSOBU",118,0)
 Q X
"RTN","GMTSOBU",119,0)
NN(X) ;   New Name
"RTN","GMTSOBU",120,0)
 N GMTSNN,GMTSNI,GMTSNS
"RTN","GMTSOBU",121,0)
 S GMTSNN=$G(X),GMTSNI=$P(GMTSNN," ",$L(GMTSNN," "))
"RTN","GMTSOBU",122,0)
 S GMTSNS=$P(GMTSNN," ",1,($L(GMTSNN," ")-1))
"RTN","GMTSOBU",123,0)
 S:+GMTSNI=0 GMTSNS=GMTSNN S:+GMTSNI=0 GMTSNI=1 S GMTSNI=+GMTSNI+1
"RTN","GMTSOBU",124,0)
 S GMTSNS=$$TRIM(GMTSNS)
"RTN","GMTSOBU",125,0)
 S:($L(GMTSNS)+$L(GMTSNI))>29 GMTSNS=$E(GMTSNS,1,30-($L(GMTSNI)+2))
"RTN","GMTSOBU",126,0)
 S X=$$TRIM(GMTSNS)_" "_GMTSNI
"RTN","GMTSOBU",127,0)
 Q X
"RTN","GMTSOBU",128,0)
DEL(X) ;   Delete Routine X
"RTN","GMTSOBU",129,0)
 S X=$G(X) Q:'$L(X)  Q:$L(X)>8  Q:$$ROK(X)=0  X ^%ZOSF("DEL") Q
"RTN","GMTSOBU",130,0)
ROK(X) ;   Routine Ok
"RTN","GMTSOBU",131,0)
 S X=$G(X) Q:'$L(X) 0
"RTN","GMTSOBU",132,0)
 N GMTSEX,GMTSTXT S GMTSEX="S GMTSTXT=$T(+1^"_X_")" X GMTSEX Q:'$L(GMTSTXT) 0 Q 1
"RTN","GMTSOBU",133,0)
TX(R,T,L) ;   Get Text (Routine/Tag/Line)
"RTN","GMTSOBU",134,0)
 N GMTSEX,GMTSTXT S GMTSEX="S GMTSTXT=$T("_T_"+"_L_"^"_R_")" X GMTSEX S X=GMTSTXT
"RTN","GMTSOBU",135,0)
 Q X
"RTN","GMTSOBU",136,0)
TRIM(X) ;   Trim Spaces
"RTN","GMTSOBU",137,0)
 S X=$G(X) F  Q:$E(X,1)'=" "  S X=$E(X,2,$L(X))
"RTN","GMTSOBU",138,0)
 F  Q:$E(X,$L(X))'=" "  S X=$E(X,1,($L(X)-1))
"RTN","GMTSOBU",139,0)
 S X=$$UP^XLFSTR($E(X,1))_$E(X,2,$L(X))
"RTN","GMTSOBU",140,0)
 Q X
"RTN","GMTSOBV")
0^27^B56308658
"RTN","GMTSOBV",1,0)
GMTSOBV ; SLC/KER - HS Object - Verify                 ; 01/06/2003
"RTN","GMTSOBV",2,0)
 ;;2.7;Health Summary;**58**;Oct 20, 1995
"RTN","GMTSOBV",3,0)
 ;                
"RTN","GMTSOBV",4,0)
 ; External References
"RTN","GMTSOBV",5,0)
 ;   DBIA  10006  ^DIC  (file #2 and 142.5)
"RTN","GMTSOBV",6,0)
 ;   DBIA  10013  ^DIK  (file #142.5)
"RTN","GMTSOBV",7,0)
 ;   DBIA  10026  ^DIR        
"RTN","GMTSOBV",8,0)
 ;   DBIA  10104  $$UP^XLFSTR
"RTN","GMTSOBV",9,0)
 ;   DBIA  10076  ^XUSEC(
"RTN","GMTSOBV",10,0)
 ;   DBIA  10076  ^XUSEC("GMTSMGR"
"RTN","GMTSOBV",11,0)
 ;   DBIA   3798  $$EXIST^TIUHSOBJ
"RTN","GMTSOBV",12,0)
 ;   DBIA  10005  DT^DICRW
"RTN","GMTSOBV",13,0)
 ;   DBIA  10103  $$DT^XLFDT
"RTN","GMTSOBV",14,0)
 ;   DBIA  10061  DEM^VADPT
"RTN","GMTSOBV",15,0)
 ;                       
"RTN","GMTSOBV",16,0)
 Q
"RTN","GMTSOBV",17,0)
VT(X) ; Verify Type Selection
"RTN","GMTSOBV",18,0)
 N GMTSHDR,GMTSNOQ,GMTSNOI,GMTSX,GMTSREDO S GMTSX=+($G(X)) Q:+GMTSX'>0 -1
"RTN","GMTSOBV",19,0)
 S GMTSHDR(1)="You have selected the following Health Summary Type to use as an Object:"
"RTN","GMTSOBV",20,0)
 S GMTSHDR(2)=" ",GMTSNOQ="",GMTSNOI="",GMTSREDO=0
"RTN","GMTSOBV",21,0)
 D DT^GMTSOBD(+GMTSX) I $D(^TMP("GMTSOBT",$J)) D
"RTN","GMTSOBV",22,0)
 . D NOQUE^GMTSOBD W ! N DIR,DTOUT,DUOUT S DIR(0)="YAO",DIR("A")="Is this correct?  ",DIR("B")="Y"
"RTN","GMTSOBV",23,0)
 . D ^DIR S:$$UP^XLFSTR($E(X,1))="N" GMTSREDO=1 I +Y'>0 S GMTSX=-1
"RTN","GMTSOBV",24,0)
 I GMTSREDO>0!(GMTSX'>0) S X=-1
"RTN","GMTSOBV",25,0)
 Q X
"RTN","GMTSOBV",26,0)
VTE(X) ; Verify Type Edit
"RTN","GMTSOBV",27,0)
 N GMTSX,GMTSOWN,GMTSNAT,GMTSLOCK,GMTSKEY,GMTSMGR S GMTSX=+($G(X)) Q:$D(GMTSDEV) X
"RTN","GMTSOBV",28,0)
 I +GMTSX'>0 W:'$D(GMTSQT) !!,"   Health Summary Type not found.",! Q -1
"RTN","GMTSOBV",29,0)
 I +($G(DUZ))'>0 W:'$D(GMTSQT) !!,"   User not defined.",! Q -1
"RTN","GMTSOBV",30,0)
 I +($$UACT^GMTSU2(+($G(DUZ))))'>0 W:'$D(GMTSQT) !!,"   User is not an active user.",! Q -1
"RTN","GMTSOBV",31,0)
 I '$D(^GMT(142,+GMTSX,0)) W:'$D(GMTSQT) !!,"   Health Summary Type not found.",! Q -1
"RTN","GMTSOBV",32,0)
 I '$L($P($G(^GMT(142,+GMTSX,0)),"^",1)) W:'$D(GMTSQT) !!,"   Invalid Health Summary Type.",! Q -1
"RTN","GMTSOBV",33,0)
 S GMTSMGR=$S($D(^XUSEC("GMTSMGR",+($G(DUZ)))):1,1:0),GMTSLOCK=$P($G(^GMT(142,+GMTSX,0)),"^",2)
"RTN","GMTSOBV",34,0)
 S GMTSKEY=1 S:$L(GMTSLOCK) GMTSKEY=$D(^XUSEC(GMTSLOCK,+($G(DUZ))))
"RTN","GMTSOBV",35,0)
 S GMTSOWN=$P($G(^GMT(142,+GMTSX,0)),"^",3),GMTSNAT=+($P($G(^GMT(142,+GMTSX,"VA")),"^",1))
"RTN","GMTSOBV",36,0)
 I GMTSNAT>0 W:'$D(GMTSQT) !!,"   You can not edit a Nationally exported Health Summary Type.",! Q -1
"RTN","GMTSOBV",37,0)
 I 'GMTSMGR,'GMTSKEY W:'$D(GMTSQT) !!,"   This Health Summary Type is currently locked to prevent alteration.",! Q -1
"RTN","GMTSOBV",38,0)
 I GMTSOWN>0,GMTSOWN'=+($G(DUZ)) W:'$D(GMTSQT) !!,"   You can not edit a Health Summary Type you don't own.",! Q -1
"RTN","GMTSOBV",39,0)
 S X=GMTSX Q X
"RTN","GMTSOBV",40,0)
VOE(X) ; Verify Object Edit
"RTN","GMTSOBV",41,0)
 N GMTSX,GMTSOWN,GMTSNAT,GMTSMGR S GMTSX=+($G(X)) Q:$D(GMTSDEV) X
"RTN","GMTSOBV",42,0)
 I +GMTSX'>0 W:'$D(GMTSQT) !!,"   Health Summary Object not found.",! Q -1
"RTN","GMTSOBV",43,0)
 I +($G(DUZ))'>0 W:'$D(GMTSQT) !!,"   User not defined.",! Q -1
"RTN","GMTSOBV",44,0)
 I +($$UACT^GMTSU2(+($G(DUZ))))'>0 W:'$D(GMTSQT) !!,"   User is not an active user.",! Q -1
"RTN","GMTSOBV",45,0)
 I '$D(^GMT(142.5,+GMTSX,0)) W:'$D(GMTSQT) !!,"   Health Summary Object not found.",! Q -1
"RTN","GMTSOBV",46,0)
 I '$L($P($G(^GMT(142.5,+GMTSX,0)),"^",1)) W:'$D(GMTSQT) !!,"   Invalid Health Summary Object.",! Q -1
"RTN","GMTSOBV",47,0)
 S GMTSMGR=$S($D(^XUSEC("GMTSMGR",+($G(DUZ)))):1,1:0)
"RTN","GMTSOBV",48,0)
 S GMTSOWN=$P($G(^GMT(142.5,+GMTSX,0)),"^",17),GMTSNAT=+($P($G(^GMT(142,+GMTSX,"VA")),"^",1))
"RTN","GMTSOBV",49,0)
 I GMTSNAT>0 W:'$D(GMTSQT) !!,"   You can not edit a Nationally exported Health Summary Object.",! Q -1
"RTN","GMTSOBV",50,0)
 I GMTSOWN>0,GMTSOWN'=+($G(DUZ)) W:'$D(GMTSQT) !!,"   You can not edit a Health Summary Object you don't own.",! Q -1
"RTN","GMTSOBV",51,0)
 S X=GMTSX Q X
"RTN","GMTSOBV",52,0)
VO(X) ; Verify Object
"RTN","GMTSOBV",53,0)
 N GMTSHDR,GMTSNOQ,GMTSNOI,GMTSX,GMTSREDO S GMTSREDO=0,GMTSX=+($G(X)) Q:+GMTSX'>0 -1
"RTN","GMTSOBV",54,0)
 S GMTSHDR(1)="You have selected the following Health Summary Object:"
"RTN","GMTSOBV",55,0)
 S GMTSHDR(2)=" " D SO^GMTSOBS(+GMTSX) W ! N DIR,DTOUT,DUOUT S DIR(0)="YAO",DIR("A")="Is this correct?  ",DIR("B")="Y"
"RTN","GMTSOBV",56,0)
 D ^DIR S:$$UP^XLFSTR($E(X,1))="N" GMTSREDO=1
"RTN","GMTSOBV",57,0)
 S X=1 I GMTSREDO>0!(+Y'>0) S X=-1
"RTN","GMTSOBV",58,0)
 Q X
"RTN","GMTSOBV",59,0)
VOD(X) ; Verify Object Deletion
"RTN","GMTSOBV",60,0)
 N GMTS,GMTSIEN,GMTSOWN,GMTSOK,GMTSI,GMTSN,GMTST,GMTSS,GMTSNAT,DIR,DTOUT,DIROUT,DUOUT,Y
"RTN","GMTSOBV",61,0)
 S GMTSOK=0,GMTSIEN=+($G(X)) I +X'>0 D  Q 0
"RTN","GMTSOBV",62,0)
 . W !!,"   Sorry, you can not delete this Health Summary Object.",!
"RTN","GMTSOBV",63,0)
 S GMTSN=$P($G(^GMT(142.5,+($G(GMTSIEN)),0)),"^",1) I '$L(GMTSN) D  Q 0
"RTN","GMTSOBV",64,0)
 . W !!,"   Sorry, you can not delete this Health Summary Object."
"RTN","GMTSOBV",65,0)
 . W !,"   There is a problem with the object's NAME field (#.01).",!
"RTN","GMTSOBV",66,0)
 S GMTSNAT=$P($G(^GMT(142.5,+($G(GMTSIEN)),0)),"^",20),GMTSOWN=$P($G(^GMT(142.5,+($G(GMTSIEN)),0)),"^",17)
"RTN","GMTSOBV",67,0)
 I +GMTSOWN>0,+GMTSOWN'=+($G(DUZ)) D  Q 0
"RTN","GMTSOBV",68,0)
 . W !!,"   You can not delete a Health Summary Object you don't own.",!
"RTN","GMTSOBV",69,0)
 I +GMTSNAT>0,'$D(GMTSDEV) D  Q 0
"RTN","GMTSOBV",70,0)
 . W !!,"   You can not delete a Nationally Exported Health Summary Object.",!
"RTN","GMTSOBV",71,0)
 S GMTST=" Object:  "_GMTSN,GMTSS="",$P(GMTSS," ",(60-$L(GMTST))\2)=" ",GMTST=GMTSS_GMTST
"RTN","GMTSOBV",72,0)
 I '$L($T(EXIST^TIUHSOBJ)) D  Q 0
"RTN","GMTSOBV",73,0)
 . W !!,"   Unable to determine if this Health Summary Object is linked"
"RTN","GMTSOBV",74,0)
 . W !,"   to a TIU Object.  Nothing deleted.",!
"RTN","GMTSOBV",75,0)
 S X=$$EXIST^TIUHSOBJ(GMTSIEN) Q:+X'>0 1
"RTN","GMTSOBV",76,0)
 S DIR("A",1)="   WARNING -- You are about to delete a Health Summary Object "
"RTN","GMTSOBV",77,0)
 S DIR("A",2)="   currently in use by TIU.  If you continue, then the associated"
"RTN","GMTSOBV",78,0)
 S DIR("A",3)="   TIU Object will not display correctly."
"RTN","GMTSOBV",79,0)
 S DIR("A",4)="",DIR("A",5)=GMTST,DIR("A",6)=""
"RTN","GMTSOBV",80,0)
 S DIR("A")=" Are you sure you want to delete this Health Summary Object?  "
"RTN","GMTSOBV",81,0)
 S DIR(0)="YAO",DIR("B")="NO",(DIR("?"),DIR("??"))="^D VODH^GMTSOBV"
"RTN","GMTSOBV",82,0)
 D ^DIR S X=$S(+Y>0:+GMTSX,1:0) S:$D(DTOUT)!($D(DUOUT)) X=0
"RTN","GMTSOBV",83,0)
 Q X
"RTN","GMTSOBV",84,0)
VODH ; VOD Help
"RTN","GMTSOBV",85,0)
 W !,"     Enter either 'Y' or 'N'."
"RTN","GMTSOBV",86,0)
 Q
"RTN","GMTSOBV",87,0)
DEL(X) ; Verify Object Deletion
"RTN","GMTSOBV",88,0)
 N GMTSIEN S GMTSIEN=+($G(X)) Q:GMTSIEN'>0 0 Q:'$L($P($G(^GMT(142.5,+GMTSIEN,0)),"^",1)) 0
"RTN","GMTSOBV",89,0)
 Q:+($P($G(^GMT(142.5,+($G(GMTSIEN)),0)),"^",17))&(+($P($G(^GMT(142.5,+($G(GMTSIEN)),0)),"^",17))'=+($G(DUZ))) 0
"RTN","GMTSOBV",90,0)
 Q:+($P($G(^GMT(142.5,+($G(GMTSIEN)),0)),"^",20))&('$D(GMTSDEV)) 0
"RTN","GMTSOBV",91,0)
 I $L($T(EXIST^TIUHSOBJ)),+($$EXIST^TIUHSOBJ(GMTSIEN))>0,'$D(GMTSDEV) Q 0
"RTN","GMTSOBV",92,0)
 Q 1
"RTN","GMTSOBV",93,0)
CRD(X) ; Create Delete
"RTN","GMTSOBV",94,0)
 N GMTSIEN S GMTSIEN=+($G(X)) Q:GMTSIEN'>0  N DA,DIK,GMTSC,GMTSE,GMTSN,GMTST,GMTSR S GMTSN=$P($G(^GMT(142.5,+GMTSIEN,0)),"^",1)
"RTN","GMTSOBV",95,0)
 S GMTSC=+($P($G(^GMT(142.5,+($G(GMTSIEN)),0)),"^",17)) I +GMTSC>0,+GMTSC'=+($G(DUZ)) Q
"RTN","GMTSOBV",96,0)
 S GMTSE=+($P($G(^GMT(142.5,+($G(GMTSIEN)),0)),"^",20)) I GMTSE>0&('$D(GMTSDEV)) Q
"RTN","GMTSOBV",97,0)
 I $L($T(EXIST^TIUHSOBJ)),+($$EXIST^TIUHSOBJ(GMTSIEN))>0 Q
"RTN","GMTSOBV",98,0)
 S GMTSN=+($P($G(^GMT(142.5,+($G(GMTSIEN)),0)),"^",1)),GMTST=+($P($G(^GMT(142.5,+($G(GMTSIEN)),0)),"^",3))
"RTN","GMTSOBV",99,0)
 I $L(GMTSN),+($G(GMTST))>0,$D(^GMT(142,+($G(GMTST)),0)) Q
"RTN","GMTSOBV",100,0)
 S DA=GMTSIEN,DIK="^GMT(142.5," D ^DIK
"RTN","GMTSOBV",101,0)
 Q
"RTN","GMTSOBV",102,0)
NAME(X) ; Verify Name for $$CRE^GMTSOBJ
"RTN","GMTSOBV",103,0)
 N GMTSN,GMTSE S GMTSN=$G(X),GMTSE=$$EXIST(GMTSN) S:$L(GMTSN)<3!($L(GMTSN)>60) GMTSN=""
"RTN","GMTSOBV",104,0)
 I $L(GMTSN)>2,$L(GMTSN)'>60,GMTSE'>0 Q X
"RTN","GMTSOBV",105,0)
 N X,Y,DIR,DIROUT,DTOUT,DUOUT
"RTN","GMTSOBV",106,0)
 S DIR(0)="FAO^3:60^N GMTS S GMTS=$$NIT^GMTSOBV(X) K:+GMTS'>0 X",GMTSN=""
"RTN","GMTSOBV",107,0)
 S DIR("A")=" Health Summary Object Name:  "
"RTN","GMTSOBV",108,0)
 S (DIR("?"),DIR("??"))="^D NH^GMTSOBV"
"RTN","GMTSOBV",109,0)
 D ^DIR S:$L(Y)>2&($L(Y)'>60) GMTSN=Y S X=GMTSN W !
"RTN","GMTSOBV",110,0)
 Q X
"RTN","GMTSOBV",111,0)
NIT(X) ; Name Input Transform
"RTN","GMTSOBV",112,0)
 N GMTSN S GMTSN=$$EXIST($G(X)) Q:+GMTSN<0 0
"RTN","GMTSOBV",113,0)
 I +GMTSN>0 D  Q 0
"RTN","GMTSOBV",114,0)
 . W !!,"     A Health Summary Object of the same name exist"
"RTN","GMTSOBV",115,0)
 Q 1
"RTN","GMTSOBV",116,0)
NH ; Name Help
"RTN","GMTSOBV",117,0)
 W !,"     Enter a name of a new Health Summary Object, "
"RTN","GMTSOBV",118,0)
 W !,"     3 to 30 characters in length."
"RTN","GMTSOBV",119,0)
 Q
"RTN","GMTSOBV",120,0)
EXIST(X) ; Name Exist
"RTN","GMTSOBV",121,0)
 ; Returns   0  Does not Exist
"RTN","GMTSOBV",122,0)
 ;           1  Exist
"RTN","GMTSOBV",123,0)
 ;          -1  Error
"RTN","GMTSOBV",124,0)
 N GMTSN,GMTSO,GMTSC,GMTSI,GMTSE,GMTST S GMTSN=$$UP^XLFSTR($G(X))
"RTN","GMTSOBV",125,0)
 Q:$L(GMTSN)<3 -1  Q:$L(GMTSN)>60 -1
"RTN","GMTSOBV",126,0)
 S GMTSE=0,GMTSO=$E(GMTSN,1,28),GMTSO=$E(GMTSO,1,($L(GMTSO)-1))_$C($A($E(GMTSO,$L(GMTSO)))-1)_"~",GMTSC=$E(GMTSO,1,($L(GMTSO)-2))
"RTN","GMTSOBV",127,0)
 F  S GMTSO=$O(^GMT(142.5,"C",GMTSO)) Q:GMTSO=""!(+GMTSE>0)!(GMTSO'[GMTSC)  D
"RTN","GMTSOBV",128,0)
 . S GMTSI=0 F  S GMTSI=$O(^GMT(142.5,"C",GMTSO,GMTSI)) Q:+GMTSI=0  D
"RTN","GMTSOBV",129,0)
 . . S GMTST=$$UP^XLFSTR($P($G(^GMT(142.5,GMTSI,0)),"^",1)) S:GMTSN=GMTST GMTSE=1
"RTN","GMTSOBV",130,0)
 S X=GMTSE
"RTN","GMTSOBV",131,0)
 Q X
"RTN","GMTSOBV",132,0)
PAT ; Patient Lookup
"RTN","GMTSOBV",133,0)
 K DFN,GMP D DT^DICRW N DIC,DTOUT,DUOUT,DIROUT,GMTSNAM,GMTSLAS,VA,VADM
"RTN","GMTSOBV",134,0)
 S DIC=2,DIC("A")=" Select Patient:  ",DIC(0)="AEQMZ",DT=$$DT^XLFDT,DTIME=300 D ^DIC I +Y>0 D
"RTN","GMTSOBV",135,0)
 . S DFN=+Y N GMTSNAM,GMTSLAS,VA,VADM D DEM^VADPT S GMTSNAM=$G(VADM(1)),GMTSLAS=+($G(VA("BID")))
"RTN","GMTSOBV",136,0)
 . S GMP=1,GMP(0)=1,GMP(1)=DFN_"^"_GMTSNAM_"^ "_GMTSNAM_" "_$S(+GMTSLAS>0:"(",1:0)_+GMTSLAS_$S(+GMTSLAS>0:")",1:0)_"^1"
"RTN","GMTSOBV",137,0)
 Q
"RTN","GMTSOBV",138,0)
LKO(X) ; Lookup Object
"RTN","GMTSOBV",139,0)
 N DIC,DTOUT,DUOUT,DIROUT,DIR,GMTSX
"RTN","GMTSOBV",140,0)
 S DIC="^GMT(142.5,",DIC("A")=" Select HEALTH SUMMARY OBJECT:  ",U="^"
"RTN","GMTSOBV",141,0)
 S DIC(0)="AEMQ" K DLAYGO D ^DIC S (X,GMTSX)=+Y Q:+Y'>0 -1  Q:$D(DTOUT)!($D(DUOUT)) -1
"RTN","GMTSOBV",142,0)
 I +Y>0 D  Q X
"RTN","GMTSOBV",143,0)
 . N DIR,GMTSI,GMTSN S GMTSI=+Y,X=-1,GMTSN=$P($G(^GMT(142.5,+GMTSI,0)),"^",1) Q:'$L(GMTSN)
"RTN","GMTSOBV",144,0)
 . S DIR(0)="YAO",DIR("A")=" Is this correct?  ",DIR("B")="Y"
"RTN","GMTSOBV",145,0)
 . W !!,"You have selected ",GMTSN,! D SO^GMTSOBS(GMTSX) W !
"RTN","GMTSOBV",146,0)
 . D ^DIR S X=$S(+Y>0:+GMTSX,1:-1) S:$D(DTOUT)!($D(DUOUT)) X=-1
"RTN","GMTSOBV",147,0)
 Q X
"RTN","GMTSOBV",148,0)
TRIM(X) ; Trim Space Characters
"RTN","GMTSOBV",149,0)
 S X=$G(X) F  Q:$E(X,1)'=" "  S X=$E(X,2,$L(X))
"RTN","GMTSOBV",150,0)
 F  Q:$E(X,$L(X))'=" "  S X=$E(X,1,($L(X)-1))
"RTN","GMTSOBV",151,0)
 Q X
"RTN","GMTSP58")
0^^B24932440
"RTN","GMTSP58",1,0)
GMTSP58 ; CIO/SLC - Post Install GMTS*2.7*58    ; 01/06/2003
"RTN","GMTSP58",2,0)
 ;;2.7;Health Summary;**58**;Oct 20, 1995
"RTN","GMTSP58",3,0)
 ;
"RTN","GMTSP58",4,0)
 ; External References
"RTN","GMTSP58",5,0)
 ;   DBIA 10013  ^DIK
"RTN","GMTSP58",6,0)
 ;   DBIA 10013  IX1^DIK
"RTN","GMTSP58",7,0)
 ;   DBIA 10104  $$UP^XLFSTR
"RTN","GMTSP58",8,0)
 ;   DBIA 10141  BMES^XPDUTL
"RTN","GMTSP58",9,0)
 ;   DBIA 10141  MES^XPDUTL
"RTN","GMTSP58",10,0)
 ;                   
"RTN","GMTSP58",11,0)
 Q
"RTN","GMTSP58",12,0)
POST ; Post-Install
"RTN","GMTSP58",13,0)
 N DA,DIK,GMTS,GMTSC,GMTSI,GMTSID,GMTSIEN,GMTSIN,GMTSIO,GMTSIT,GMTSN
"RTN","GMTSP58",14,0)
 N GMTSO,GMTSOI,GMTSOIEN,GMTSON,GMTSOO,GMTSOPT,GMTST,GMTSW,GMTSX,I,X,Y
"RTN","GMTSP58",15,0)
 D MB(" Updating Menus"),M(" "),BM,IA,RP,NOK
"RTN","GMTSP58",16,0)
 Q
"RTN","GMTSP58",17,0)
BM ; GMTS BUILD MENU
"RTN","GMTSP58",18,0)
 D M("   GMTS BUILD MENU") N GMTSOI,GMTSI,GMTSIT,GMTSIO
"RTN","GMTSP58",19,0)
 S GMTSOI=$$OIEN("GMTS BUILD MENU")
"RTN","GMTSP58",20,0)
 D SA(1,GMTSOI,"GMTS TYPE ENTER/EDIT"),SA(2,GMTSOI,"GMTS TYPE DELETE")
"RTN","GMTSP58",21,0)
 D SA(3,GMTSOI,"GMTS OBJ MENU"),SA(4,GMTSOI,"GMTS INFO ONLY MENU")
"RTN","GMTSP58",22,0)
 D SA(5,GMTSOI,"GMTS HS MENU") D RES H 1
"RTN","GMTSP58",23,0)
 Q
"RTN","GMTSP58",24,0)
IA ; GMTS IRM/ADPAC MAINT MENU 
"RTN","GMTSP58",25,0)
 D M("   GMTS IRM/ADPAC MAINT MENU") N GMTSOI,GMTSI,GMTSIT,GMTSIO
"RTN","GMTSP58",26,0)
 S GMTSOI=$$OIEN("GMTS IRM/ADPAC MAINT MENU") D SA(1,GMTSOI,"GMTS IRM/ADPAC ENABLE/DISABLE")
"RTN","GMTSP58",27,0)
 D SA(2,GMTSOI,"GMTS IRM/ADPAC COMP EDIT"),SA(3,GMTSOI,"GMTS IRM/ADPAC ADHOC EDIT"),SA(4,GMTSOI,"GMTS IRM/ADPAC ADHOC LOAD")
"RTN","GMTSP58",28,0)
 D SA(5,GMTSOI,"GMTS IRM/ADPAC TYPE RESEQUENCE"),SA(6,GMTSOI,"GMTS TYPE ENTER/EDIT")
"RTN","GMTSP58",29,0)
 D SA(7,GMTSOI,"GMTS IRM/ADPAC PARAMETER EDIT"),SA(8,GMTSOI,"GMTS OBJ MENU")
"RTN","GMTSP58",30,0)
 D SA(9,GMTSOI,"GMTS GUI REPORTS LIST MENU"),SA(10,GMTSOI,"GMTS GUI SITE DEFAULTS") D RES
"RTN","GMTSP58",31,0)
 Q
"RTN","GMTSP58",32,0)
RES ; Resequence
"RTN","GMTSP58",33,0)
 N GMTSOIEN,GMTS,GMTSOPT,GMTSOO,GMTSON,GMTSIT,DA,DIK S GMTSOIEN=+($G(GMTSOI)) Q:+GMTSOIEN=0
"RTN","GMTSP58",34,0)
 S GMTS=0 F  S GMTS=$O(GMTSI(GMTS)) Q:+GMTS=0  D
"RTN","GMTSP58",35,0)
 . S DA(1)=GMTSOIEN,DA=$P($G(GMTSI(GMTS)),"^",3) Q:+DA=0  S DIK="^DIC(19,"_DA(1)_",10," D ^DIK
"RTN","GMTSP58",36,0)
 S GMTS=0 F  S GMTS=$O(GMTSI(GMTS)) Q:+GMTS=0  D
"RTN","GMTSP58",37,0)
 . S GMTSOPT=$P($G(GMTSI(GMTS)),"^",1) Q:+GMTSOPT=0  S GMTSIT=$$NIEN(GMTSOIEN) Q:+GMTSIT=0  S ^DIC(19,GMTSOIEN,10,GMTSIT,0)=GMTSOPT_"^"_GMTS_"^"_GMTS
"RTN","GMTSP58",38,0)
 S DA=GMTSOIEN,DIK="^DIC(19," D IX1^DIK
"RTN","GMTSP58",39,0)
 Q
"RTN","GMTSP58",40,0)
SA(I,X,Y) ; Set Array
"RTN","GMTSP58",41,0)
 N GMTSOPT,GMTSIN,GMTSIT,GMTSIO,GMTSID,GMTSC,GMTST S GMTSC=+($G(I)) Q:+GMTSC=0
"RTN","GMTSP58",42,0)
 S GMTSOPT=+($G(X)) Q:+GMTSOPT=0  S GMTSIN=$G(Y) Q:'$L(GMTSIN)  S GMTSIT=$$OIEN(GMTSIN) Q:+GMTSIT=0
"RTN","GMTSP58",43,0)
 S GMTST="     "_$J(GMTSC,2)_"  "_GMTSIN S:GMTSIN["GMTS OBJ MENU" GMTST=GMTST_"  <============="
"RTN","GMTSP58",44,0)
 S GMTSID=$$OE(GMTSOPT,GMTSIT),GMTSIO=$$OO(GMTSOPT,GMTSIT) Q:+GMTSIO=0  S GMTSI(GMTSC)=GMTSIT_"^"_GMTSIO_"^"_GMTSID_"^"_GMTSIN
"RTN","GMTSP58",45,0)
 Q
"RTN","GMTSP58",46,0)
OE(X,Y) ; Old Entry
"RTN","GMTSP58",47,0)
 N GMTS,GMTSI,GMTSO S GMTS=+($G(X)) Q:+GMTS=0 0  S GMTSI=+($G(Y)) Q:+GMTSI=0 0  S GMTSO=$O(^DIC(19,+GMTS,10,"B",+GMTSI,0)),X=+GMTSO
"RTN","GMTSP58",48,0)
 Q X
"RTN","GMTSP58",49,0)
OO(X,Y) ; Old Order
"RTN","GMTSP58",50,0)
 N GMTS,GMTSI,GMTSO S GMTS=+($G(X)) Q:+GMTS=0 0  S GMTSI=+($G(Y)) Q:+GMTSI=0 0
"RTN","GMTSP58",51,0)
 S GMTSO=$O(^DIC(19,+GMTS,10,"B",+GMTSI,0)) Q:+GMTSO=0 0  S GMTSO=+($P($G(^DIC(19,+GMTS,10,+GMTSO,0)),"^",3)) S X=GMTSO
"RTN","GMTSP58",52,0)
 Q X
"RTN","GMTSP58",53,0)
OIEN(X) ; Option IEN
"RTN","GMTSP58",54,0)
 N GMTSI,GMTSX,GMTST,GMTSN,GMTSW S GMTSW=$G(X) Q:'$L(GMTSW) 0  S (GMTSI,GMTST)=0
"RTN","GMTSP58",55,0)
 F  S GMTSI=$O(^DIC(19,"B",$E(GMTSW,1,30),GMTSI)) Q:+GMTSI=0  D  Q:+GMTST>0
"RTN","GMTSP58",56,0)
 . S GMTSX=$P($G(^DIC(19,+GMTSI,0)),"^",1) S:$$UP^XLFSTR(GMTSW)=$$UP^XLFSTR(GMTSX) GMTST=+GMTSI
"RTN","GMTSP58",57,0)
 S X=+($G(GMTST))
"RTN","GMTSP58",58,0)
 Q X
"RTN","GMTSP58",59,0)
NIEN(X) ; Next IEN
"RTN","GMTSP58",60,0)
 N GMTSIEN,GMTS S GMTSIEN=$G(X) Q:+GMTSIEN=0 0  F GMTS=1:1 S X=GMTS Q:'$D(^DIC(19,GMTSIEN,10,GMTS))
"RTN","GMTSP58",61,0)
 Q X
"RTN","GMTSP58",62,0)
NOK ; Install NOK Component
"RTN","GMTSP58",63,0)
 D MB(" Installing NOK (Next of Kin) Component in Health Summary")
"RTN","GMTSP58",64,0)
 D M(" Component file #142.1") H 2
"RTN","GMTSP58",65,0)
 N DIK,DA,IX,SUB,IEN,ACT S ACT=1 S DA=242,DIK="^GMT(142.1,"
"RTN","GMTSP58",66,0)
 K ^GMT(142.1,DA)
"RTN","GMTSP58",67,0)
 F IX="B","C","D" S SUB="" F  S SUB=$O(^GMT(142.1,IX,SUB)) Q:SUB=""  D
"RTN","GMTSP58",68,0)
 . S IEN=0 F  S IEN=$O(^GMT(142.1,IX,SUB,IEN)) Q:+IEN=0  D
"RTN","GMTSP58",69,0)
 . . K:IEN=DA ^GMT(142.1,IX,SUB,IEN)
"RTN","GMTSP58",70,0)
 S ^GMT(142.1,DA,0)="NEXT OF KIN^NOKC;GMTSDEM2^^NOK^^^^^Next of Kin^^^^DG"
"RTN","GMTSP58",71,0)
 S ^GMT(142.1,DA,.1,0)="^142.11^1^1"
"RTN","GMTSP58",72,0)
 S ^GMT(142.1,DA,.1,1,0)="NOKC;GMTSDEM2"
"RTN","GMTSP58",73,0)
 S ^GMT(142.1,DA,.1,"B","NOKC;GMTSDEM2",1)=""
"RTN","GMTSP58",74,0)
 S ^GMT(142.1,DA,3.5,0)="^142.35^2^2^3020723^^"
"RTN","GMTSP58",75,0)
 S ^GMT(142.1,DA,3.5,1,0)="Displays the name, relation, address, phone number of the Next of Kin.  If"
"RTN","GMTSP58",76,0)
 S ^GMT(142.1,DA,3.5,2,0)="a Secondary Next of Kin exist, then it will be printed too."
"RTN","GMTSP58",77,0)
 I '$L($T(NOKC^GMTSDEM2)) D
"RTN","GMTSP58",78,0)
 . S ACT=0,$P(^GMT(142.1,DA,0),"^",6)="T",$P(^GMT(142.1,DA,0),"^",8)="Can not find NOKC^GMTSDEM2"
"RTN","GMTSP58",79,0)
 S:$L($P($G(^GMT(142.1,DA,0)),"^",1)) ^GMT(142.1,"B",$E($P($G(^GMT(142.1,DA,0)),"^",1),1,30),DA)=""
"RTN","GMTSP58",80,0)
 S:$L($P($G(^GMT(142.1,DA,0)),"^",4)) ^GMT(142.1,"C",$E($P($G(^GMT(142.1,DA,0)),"^",4),1,30),DA)=""
"RTN","GMTSP58",81,0)
 S:$L($P($G(^GMT(142.1,DA,0)),"^",9)) ^GMT(142.1,"D",$$UP^XLFSTR($P($G(^GMT(142.1,DA,0)),"^",9)),DA)="" D IX1^DIK
"RTN","GMTSP58",82,0)
 I ACT D
"RTN","GMTSP58",83,0)
 . D MB(" Installing NOK (Next of Kin) Component in Ad Hoc Health Summary")
"RTN","GMTSP58",84,0)
 D:ACT BUILD^GMTSXPD3
"RTN","GMTSP58",85,0)
 Q
"RTN","GMTSP58",86,0)
RP ; Report Period
"RTN","GMTSP58",87,0)
 N GMTSNN S GMTSNN="^DD(142.5,.04,0)" S:$D(@GMTSNN) $P(@GMTSNN,"^",2)="FX"
"RTN","GMTSP58",88,0)
 Q
"RTN","GMTSP58",89,0)
MB(X) ;   Message with Blank Line
"RTN","GMTSP58",90,0)
 Q:$D(GMTSQT)  D:$D(XPDNM) BMES^XPDUTL($G(X)) W:'$D(XPDNM) !!,$G(X) Q
"RTN","GMTSP58",91,0)
M(X) ;   Message
"RTN","GMTSP58",92,0)
 Q:$D(GMTSQT)  D:$D(XPDNM) MES^XPDUTL($G(X)) W:'$D(XPDNM) !,$G(X) Q
"RTN","GMTSPXFP")
0^34^B7514219
"RTN","GMTSPXFP",1,0)
GMTSPXFP ; SLC/SBW,KER - PCE Health Factors Component ; 01/06/2003
"RTN","GMTSPXFP",2,0)
 ;;2.7;Health Summary;**8,10,28,56,58**;Oct 20, 1995
"RTN","GMTSPXFP",3,0)
 ;
"RTN","GMTSPXFP",4,0)
 ; External References
"RTN","GMTSPXFP",5,0)
 ;   DBIA  1243  HF^PXRHS07
"RTN","GMTSPXFP",6,0)
 ;   DBIA 10011  ^DIWP
"RTN","GMTSPXFP",7,0)
 ;                    
"RTN","GMTSPXFP",8,0)
HFSEL ; Health Factors Selected
"RTN","GMTSPXFP",9,0)
 N HFSEG,GMTSFC,GMW
"RTN","GMTSPXFP",10,0)
 Q:$O(GMTSEG(GMTSEGN,9999999.64,0))'>0
"RTN","GMTSPXFP",11,0)
 S GMTSFC=0,GMW=0
"RTN","GMTSPXFP",12,0)
 F  S GMTSFC=$O(GMTSEG(GMTSEGN,9999999.64,GMTSFC)) Q:'GMTSFC  D
"RTN","GMTSPXFP",13,0)
 . S HFSEG(GMTSEG(GMTSEGN,9999999.64,GMTSFC))=""
"RTN","GMTSPXFP",14,0)
 K ^TMP("PXF",$J) D HF^PXRHS07(DFN,GMTSEND,GMTSBEG,GMTSNDM,.HFSEG)
"RTN","GMTSPXFP",15,0)
 Q:'$D(^TMP("PXF",$J))  D CKP^GMTSUP Q:$D(GMTSQIT)  D HDR,HFMAIN
"RTN","GMTSPXFP",16,0)
 Q
"RTN","GMTSPXFP",17,0)
HFACT ; Control Health Factor retrieval and display
"RTN","GMTSPXFP",18,0)
 K ^TMP("PXF",$J)
"RTN","GMTSPXFP",19,0)
 D HF^PXRHS07(DFN,GMTSEND,GMTSBEG,GMTSNDM)
"RTN","GMTSPXFP",20,0)
 Q:'$D(^TMP("PXF",$J))
"RTN","GMTSPXFP",21,0)
 D CKP^GMTSUP Q:$D(GMTSQIT)  D HDR
"RTN","GMTSPXFP",22,0)
 D HFMAIN
"RTN","GMTSPXFP",23,0)
 Q
"RTN","GMTSPXFP",24,0)
HFMAIN ; Main Health Factor Display
"RTN","GMTSPXFP",25,0)
 N GMHFC,GMHF,GMDT,GMIFN,GMN0,GMW,X,GMTSDAT,HF,LEVEL,PHFC,COMMENT
"RTN","GMTSPXFP",26,0)
 N GMICL,GMTAB,GMTSLN
"RTN","GMTSPXFP",27,0)
 S GMHFC="",GMW=0
"RTN","GMTSPXFP",28,0)
 F  S GMHFC=$O(^TMP("PXF",$J,GMHFC)) Q:GMHFC=""  D  Q:$D(GMTSQIT)
"RTN","GMTSPXFP",29,0)
 . S GMHF=""
"RTN","GMTSPXFP",30,0)
 . F  S GMHF=$O(^TMP("PXF",$J,GMHFC,GMHF)) Q:GMHF=""  D  Q:$D(GMTSQIT)
"RTN","GMTSPXFP",31,0)
 . . S GMDT=0
"RTN","GMTSPXFP",32,0)
 . . F  S GMDT=$O(^TMP("PXF",$J,GMHFC,GMHF,GMDT)) Q:GMDT'>0  D  Q:$D(GMTSQIT)
"RTN","GMTSPXFP",33,0)
 . . . S GMIFN=0
"RTN","GMTSPXFP",34,0)
 . . . F  S GMIFN=$O(^TMP("PXF",$J,GMHFC,GMHF,GMDT,GMIFN)) Q:GMIFN'>0  D HFDSP Q:$D(GMTSQIT)
"RTN","GMTSPXFP",35,0)
 K ^TMP("PXF",$J)
"RTN","GMTSPXFP",36,0)
 Q
"RTN","GMTSPXFP",37,0)
HDR ; Display Header
"RTN","GMTSPXFP",38,0)
 Q:$D(GMTSOBJ)  Q:$D(GMTSQIT)
"RTN","GMTSPXFP",39,0)
 D CKP^GMTSUP Q:$D(GMTSQIT)  W "Category",!
"RTN","GMTSPXFP",40,0)
 D CKP^GMTSUP Q:$D(GMTSQIT)  W "  Health Factor ",?50,"Date",!
"RTN","GMTSPXFP",41,0)
 Q
"RTN","GMTSPXFP",42,0)
HFDSP ; Display Data
"RTN","GMTSPXFP",43,0)
 S GMN0=$G(^TMP("PXF",$J,GMHFC,GMHF,GMDT,GMIFN,0))
"RTN","GMTSPXFP",44,0)
 Q:GMN0']""
"RTN","GMTSPXFP",45,0)
 S X=$P(GMN0,U,2) D REGDT4^GMTSU S GMTSDAT=X
"RTN","GMTSPXFP",46,0)
 S HF=$P(GMN0,U),LEVEL=$P(GMN0,U,4)
"RTN","GMTSPXFP",47,0)
 D CKP^GMTSUP Q:$D(GMTSQIT)  D:GMTSNPG HDR D
"RTN","GMTSPXFP",48,0)
 . I GMHFC'=$G(PHFC)!GMTSNPG D
"RTN","GMTSPXFP",49,0)
 . . I '$D(GMTSOBJ),$G(PHFC)="",'GMTSNPG W ! D CKP^GMTSUP Q:$D(GMTSQIT)
"RTN","GMTSPXFP",50,0)
 . . W GMHFC,! S PHFC=GMHFC
"RTN","GMTSPXFP",51,0)
 . S GMW=1
"RTN","GMTSPXFP",52,0)
 D CKP^GMTSUP Q:$D(GMTSQIT)
"RTN","GMTSPXFP",53,0)
 W ?2,HF
"RTN","GMTSPXFP",54,0)
 W:LEVEL]"" " (",LEVEL,")"
"RTN","GMTSPXFP",55,0)
 W ?50,GMTSDAT,!
"RTN","GMTSPXFP",56,0)
 S COMMENT="",COMMENT=$P(^TMP("PXF",$J,GMHFC,GMHF,GMDT,GMIFN,"COM"),U)
"RTN","GMTSPXFP",57,0)
 I COMMENT]"" S GMICL=13,GMTAB=2 D FORMAT I $D(^UTILITY($J,"W")) D CKP^GMTSUP Q:$D(GMTSQIT)  D
"RTN","GMTSPXFP",58,0)
 . F GMTSLN=1:1:^UTILITY($J,"W",DIWL) D LINE Q:$D(GMTSQIT)
"RTN","GMTSPXFP",59,0)
 Q
"RTN","GMTSPXFP",60,0)
FORMAT ; Format Line
"RTN","GMTSPXFP",61,0)
 N DIWR,DIWF,X
"RTN","GMTSPXFP",62,0)
 S DIWL=3,DIWR=80-(GMICL+GMTAB)
"RTN","GMTSPXFP",63,0)
 K ^UTILITY($J,"W")
"RTN","GMTSPXFP",64,0)
 S X=COMMENT D ^DIWP
"RTN","GMTSPXFP",65,0)
 Q
"RTN","GMTSPXFP",66,0)
LINE ; Write Line
"RTN","GMTSPXFP",67,0)
 D CKP^GMTSUP Q:$D(GMTSQIT)  W ?13,^UTILITY($J,"W",DIWL,GMTSLN,0),!
"RTN","GMTSPXFP",68,0)
 Q
"RTN","GMTSRASP")
0^23^B13016689
"RTN","GMTSRASP",1,0)
GMTSRASP ; SLC/JER,KER - Selected Radiology ; 01/06/2003
"RTN","GMTSRASP",2,0)
 ;;2.7;Health Summary;**28,37,58**;Oct 20, 1995
"RTN","GMTSRASP",3,0)
 ;
"RTN","GMTSRASP",4,0)
MAIN ; Controls branching
"RTN","GMTSRASP",5,0)
 Q:+($G(DFN))=0  Q:+($G(DFN))'=+($$RP(+($G(DFN))))
"RTN","GMTSRASP",6,0)
 N GMTSI,GMW,MAX,GMTSTEST,GMDATA
"RTN","GMTSRASP",7,0)
 S MAX=$S(+$G(GMTSNDM)>0:GMTSNDM,1:999)
"RTN","GMTSRASP",8,0)
 I '$O(GMTSEG(GMTSEGN,71,0)) Q
"RTN","GMTSRASP",9,0)
 S GMTSI=0 F  S GMTSI=$O(GMTSEG(GMTSEGN,71,GMTSI)) Q:GMTSI'>0  D
"RTN","GMTSRASP",10,0)
 . S GMTSTEST=GMTSEG(GMTSEGN,71,GMTSI)
"RTN","GMTSRASP",11,0)
 . D MAINSEL^GMTSRAE(1,GMTSTEST),LOOP:$D(^TMP("RAE",$J))
"RTN","GMTSRASP",12,0)
 K ^TMP("RAE",$J)
"RTN","GMTSRASP",13,0)
 Q
"RTN","GMTSRASP",14,0)
LOOP ; Loops through ^TMP("RAE",$J,
"RTN","GMTSRASP",15,0)
 N GMW,GMTSIDT,GMTSPN,GMLN
"RTN","GMTSRASP",16,0)
 S GMTSIDT=0 F  S GMTSIDT=$O(^TMP("RAE",$J,GMTSIDT)) Q:GMTSIDT'>0  D  Q:$D(GMTSQIT)
"RTN","GMTSRASP",17,0)
 . S GMTSPN=0 F  S GMTSPN=$O(^(GMTSIDT,GMTSPN)) Q:GMTSPN'>0  D WRT Q:$D(GMTSQIT)
"RTN","GMTSRASP",18,0)
 Q
"RTN","GMTSRASP",19,0)
WRT ; Writes component data
"RTN","GMTSRASP",20,0)
 Q:$D(GMTSQIT)  N X,GMTSEDT S GMDATA=1,X=+^TMP("RAE",$J,GMTSIDT,GMTSPN,0) D REGDT4^GMTSU S GMTSEDT=X
"RTN","GMTSRASP",21,0)
 D HD S GMTSPC=+($G(GMTSCP))+1 Q:$D(GMTSQIT)  D HD Q:$D(GMTSQIT)
"RTN","GMTSRASP",22,0)
 D CKP^GMTSUP Q:$D(GMTSQIT)  W GMTSEDT D PRO,CMD,IMP Q
"RTN","GMTSRASP",23,0)
 Q
"RTN","GMTSRASP",24,0)
PRO ; Procedure
"RTN","GMTSRASP",25,0)
 N GMTSPRO,GMTSTA,GMTSEXS,GMTSCN,GMTSCPT,GMTSI
"RTN","GMTSRASP",26,0)
 S GMTSPRO=$P(^TMP("RAE",$J,GMTSIDT,GMTSPN,0),"^",2),GMTSTA=$P(^(0),"^",4)
"RTN","GMTSRASP",27,0)
 S GMTSTA=$S(GMTSTA="RELEASED/NOT VERIFIED":"REL/NOT VER",GMTSTA="PROBLEM DRAFT":"PROB DRAFT",1:GMTSTA)
"RTN","GMTSRASP",28,0)
 S GMTSCPT=$P(^(0),"^",7),GMTSEXS=$P(^(0),"^",3),GMTSCN=$P(^(0),"^",9)
"RTN","GMTSRASP",29,0)
 S:'$L(GMTSTA)&(GMTSEXS="CANCELLED") GMTSTA=GMTSEXS
"RTN","GMTSRASP",30,0)
 S:'$L(GMTSTA) GMTSTA="PENDING" S GMTSTA=$$EN2^GMTSUMX(GMTSTA)
"RTN","GMTSRASP",31,0)
 I $L(GMTSPRO)>35 S GMTSPRO=$$WRAP^GMTSORC(GMTSPRO,31)
"RTN","GMTSRASP",32,0)
 D CKP^GMTSUP Q:$D(GMTSQIT)  W ?12,$P(GMTSPRO,"|"),?46,GMTSCPT,?52,$E(GMTSTA,1,17),?64,GMTSCN,!
"RTN","GMTSRASP",33,0)
 F GMTSI=2:1:$L(GMTSPRO,"|") D CKP^GMTSUP Q:$D(GMTSQIT)  W:$P(GMTSPRO,"|",GMTSI)]"" ?23,$P(GMTSPRO,"|",GMTSI),!
"RTN","GMTSRASP",34,0)
 Q
"RTN","GMTSRASP",35,0)
CMD ; CPT Modifiers
"RTN","GMTSRASP",36,0)
 ;
"RTN","GMTSRASP",37,0)
 ; Quit - CPT Modifiers will not be used with 
"RTN","GMTSRASP",38,0)
 ;        Radiology Impression (RI) and Radiology
"RTN","GMTSRASP",39,0)
 ;        Impression Selected (SRI) at this time
"RTN","GMTSRASP",40,0)
 Q
"RTN","GMTSRASP",41,0)
 N GMTSCPTM
"RTN","GMTSRASP",42,0)
 S GMTSCPTM=+($$CPT^GMTSU(+($G(GMTSEGN)))) S:$G(GMPXCMOD)="N" GMTSCPTM=0
"RTN","GMTSRASP",43,0)
 Q:'GMTSCPTM
"RTN","GMTSRASP",44,0)
 N GMTSC,GMTSCM,GMTSCT,GMTSI S GMTSC=0 F  S GMTSC=$O(^TMP("RAE",$J,GMTSIDT,GMTSPN,"CM",GMTSC)) Q:+GMTSC=0  D
"RTN","GMTSRASP",45,0)
 . S GMTSCM=$P($G(^TMP("RAE",$J,GMTSIDT,GMTSPN,"CM",GMTSC)),"^",1)
"RTN","GMTSRASP",46,0)
 . Q:'$L(GMTSCM)  S GMTSCT=$P($G(^TMP("RAE",$J,GMTSIDT,GMTSPN,"CM",GMTSC)),"^",3) Q:'$L(GMTSCT)
"RTN","GMTSRASP",47,0)
 . S GMTSCT=GMTSCT_" (CPT Mod "_GMTSCM_")" S:$L(GMTSCT)>35 GMTSCT=$$WRAP^GMTSORC(GMTSCT,62) D CKP^GMTSUP Q:$D(GMTSQIT)  W ?14,$P(GMTSCT,"|"),!
"RTN","GMTSRASP",48,0)
 . F GMTSI=2:1:$L(GMTSCT,"|") D CKP^GMTSUP Q:$D(GMTSQIT)  W:$P(GMTSCT,"|",GMTSI)]"" ?16,$P(GMTSCT,"|",GMTSI),!
"RTN","GMTSRASP",49,0)
 Q
"RTN","GMTSRASP",50,0)
IMP ; Impression
"RTN","GMTSRASP",51,0)
 Q:$D(GMTSQIT)  N GMTSI,GMTST,DIWF,DIWL,DIWR
"RTN","GMTSRASP",52,0)
 S GMTST=12 Q:'$D(^TMP("RAE",$J,GMTSIDT,GMTSPN,"I"))  K ^UTILITY($J,"W")
"RTN","GMTSRASP",53,0)
 S DIWF="C"_(78-GMTST),DIWL=0,DIWR=0,GMTSI=0
"RTN","GMTSRASP",54,0)
 F  S GMTSI=$O(^TMP("RAE",$J,GMTSIDT,GMTSPN,"I",GMTSI)) Q:+GMTSI=0  D  Q:$D(GMTSQIT)
"RTN","GMTSRASP",55,0)
 . S X=$G(^TMP("RAE",$J,GMTSIDT,GMTSPN,"I",GMTSI))
"RTN","GMTSRASP",56,0)
 . ; DBIA 10011 call ^DIWP
"RTN","GMTSRASP",57,0)
 . D ^DIWP
"RTN","GMTSRASP",58,0)
 S GMTSI=0 F  S GMTSI=$O(^UTILITY($J,"W",0,GMTSI)) Q:+GMTSI=0  D  Q:$D(GMTSQIT)
"RTN","GMTSRASP",59,0)
 . D CKP^GMTSUP Q:$D(GMTSQIT)  W ?GMTST,$G(^UTILITY($J,"W",0,GMTSI,0)),!
"RTN","GMTSRASP",60,0)
 K ^UTILITY($J,"W")
"RTN","GMTSRASP",61,0)
 Q
"RTN","GMTSRASP",62,0)
HD ; Header/Page Check
"RTN","GMTSRASP",63,0)
 Q:$D(GMTSQIT)  D CKP^GMTSUP Q:$D(GMTSQIT)  Q:+($G(GMTSNPG))=0&(+($G(GMTSPC))>0)
"RTN","GMTSRASP",64,0)
 W "Date",?12,"Procedure",?46,"CPT",?52,"Status",?64,"Case #",!
"RTN","GMTSRASP",65,0)
 Q
"RTN","GMTSRASP",66,0)
RP(X) ; Radiology Patient
"RTN","GMTSRASP",67,0)
 N Y S X=+($G(X))
"RTN","GMTSRASP",68,0)
 ; DBIA 2056 call $$GET1^DIQ
"RTN","GMTSRASP",69,0)
 S Y=$$GET1^DIQ(70,X,.01,"I") S X=Y Q X
"RTN","GMTSRM")
0^31^B18446794
"RTN","GMTSRM",1,0)
GMTSRM ; SLC/KER - Edit HS Type                   ; 01/06/2003
"RTN","GMTSRM",2,0)
 ;;2.7;Health Summary;**30,35,29,47,56,58**;Oct 20, 1995
"RTN","GMTSRM",3,0)
 ;
"RTN","GMTSRM",4,0)
 ; External References
"RTN","GMTSRM",5,0)
 ;    DBIA 10076  ^XUSEC(
"RTN","GMTSRM",6,0)
 ;    DBIA 10076  ^XUSEC("GMTSMGR"
"RTN","GMTSRM",7,0)
 ;    DBIA 10018  ^DIE
"RTN","GMTSRM",8,0)
 ;    DBIA 10010  EN1^DIP
"RTN","GMTSRM",9,0)
 ;    DBIA 10026  ^DIR
"RTN","GMTSRM",10,0)
 ;                   
"RTN","GMTSRM",11,0)
MAIN ; Main loop to modify multiple health summary types
"RTN","GMTSRM",12,0)
 N %,DTOUT,DUOUT,DIRUT,EXISTS,GMTSFUNC,GMTSQIT,P
"RTN","GMTSRM",13,0)
 S GMTSQIT=0 F  S EXISTS=0 D SELTYP Q:GMTSQIT
"RTN","GMTSRM",14,0)
 Q
"RTN","GMTSRM",15,0)
SELTYP ; Select Health Summary Type to Edit
"RTN","GMTSRM",16,0)
 N CHANGE,DA,DIC,DIE,DLAYGO,DR,DUOUT,EXISTS,GMTSUM,GMTSNEW,GMTSMGR,GMTSEG,GMTSIFN,SELCNT,X,Y
"RTN","GMTSRM",17,0)
 W ! S U="^",DIC="^GMT(142,",DIC(0)="AEMQL"
"RTN","GMTSRM",18,0)
 S DIC("A")="Select Health Summary Type: "
"RTN","GMTSRM",19,0)
 S DIC("S")="I +($$AHST^GMTSULT(+($G(Y))))" S DLAYGO=142
"RTN","GMTSRM",20,0)
 S Y=$$TYPE^GMTSULT K DIC S:+Y'>0 GMTSQIT=1 Q:+Y'>0  S (GMTSIFN,DA)=+Y
"RTN","GMTSRM",21,0)
 S GMTSUM=$P(Y,U,2),GMTSNEW=+$P(Y,U,3),GMTSMGR=$S($D(^XUSEC("GMTSMGR",DUZ)):1,1:0)
"RTN","GMTSRM",22,0)
 I 'GMTSMGR,($P(^GMT(142,+DA,0),U,2)]"") D  Q:'GMTSMGR
"RTN","GMTSRM",23,0)
 . S GMTSMGR=$D(^XUSEC($P(^(0),U,2),DUZ))
"RTN","GMTSRM",24,0)
 . W:'GMTSMGR !,$C(7),"This summary report is currently locked to prevent alteration.",!
"RTN","GMTSRM",25,0)
 I 'GMTSMGR,'GMTSNEW,($P(^GMT(142,+DA,0),U,3)'=DUZ) W !,$C(7),"Alteration of this summary report is restricted to its owner.",!,"See the Clinical Coordinator if you need additional help." Q
"RTN","GMTSRM",26,0)
 I $D(^GMT(142.5,"AC",+DA)) D  Q:+DA'>0
"RTN","GMTSRM",27,0)
 . W !!,$C(7),"WARNING:  You are about to edit a Health Summary Type that is being used"
"RTN","GMTSRM",28,0)
 . W !,"by a Health Summary Object.  Changing the structure of this Health Summary"
"RTN","GMTSRM",29,0)
 . W !,"Type will alter how the Object will display.",! H 1
"RTN","GMTSRM",30,0)
 . N DIR,DTOUT,DUOUT,DIROUT,X,Y S DIR(0)="YAO",DIR("B")="NO"
"RTN","GMTSRM",31,0)
 . S DIR("A")="Do want to continue?  " D ^DIR S:+Y'>0 DA=0
"RTN","GMTSRM",32,0)
 . I $D(DTOUT)!($D(DUOUT))!($D(DIROUT)) S DA=0,GMTSQIT=1
"RTN","GMTSRM",33,0)
 S DIE="^GMT(142,",(GMTSIFN,DA)=+Y,DR="[GMTS EDIT HLTH SUM TYPE]" D ^DIE
"RTN","GMTSRM",34,0)
 I '$D(^GMT(142,+GMTSIFN,0))!$D(Y)!$D(DUOUT)!$D(DIROUT)!$D(DTOUT) D  Q
"RTN","GMTSRM",35,0)
 . S GMTSQIT=1 D CHKDEL Q
"RTN","GMTSRM",36,0)
 I 'GMTSNEW,($O(^GMT(142,+GMTSIFN,1,0))) S EXISTS=1 D LIST,EXISTS Q
"RTN","GMTSRM",37,0)
 D SELCMP^GMTSRM5 Q:GMTSQIT  D LIST:EXISTS,EXISTS D CHKDEL
"RTN","GMTSRM",38,0)
 Q
"RTN","GMTSRM",39,0)
CHKDEL ; Check for Possible Deletion (New Type without Component)
"RTN","GMTSRM",40,0)
 Q:+($G(GMTSIFN))'>0  Q:'$D(^GMT(142,+($G(GMTSIFN)),0))  D:GMTSMGR!(GMTSNEW)!($P(^GMT(142,+GMTSIFN,0),U,3)'=$G(DUZ)) ADEL^GMTSRM2(+($G(GMTSIFN)))
"RTN","GMTSRM",41,0)
 Q
"RTN","GMTSRM",42,0)
ENADHOC ; Entry point for AD HOC edit
"RTN","GMTSRM",43,0)
 N %,C,CHANGE,DA,DIC,DIE,DR,DUOUT,EXISTS,I,GMTSIFN,GMTSN,GMTSNCNT,GMTSNEW
"RTN","GMTSRM",44,0)
 N GMTSIFN,GMTSUM,P,SELCNT
"RTN","GMTSRM",45,0)
 N GMTSQIT,GMTSFUNC,X,Y
"RTN","GMTSRM",46,0)
 W !!,">>> EDITING the GMTS HS ADHOC OPTION Health Summary Type"
"RTN","GMTSRM",47,0)
 S (GMTSNEW,GMTSQIT)=0
"RTN","GMTSRM",48,0)
 S DIC=142,DIC(0)="XZF",X="GMTS HS ADHOC OPTION"
"RTN","GMTSRM",49,0)
 S Y=$$TYPE^GMTSULT I +Y'>0 D ^GMTSLOAD Q:$D(DIRUT)!$D(DIROUT)  G ENADHOC
"RTN","GMTSRM",50,0)
 S GMTSIFN=+Y,GMTSUM=$P(Y,U,2),EXISTS=1
"RTN","GMTSRM",51,0)
 S DIE="^GMT(142,",DA=GMTSIFN,DR=".08T" D ^DIE
"RTN","GMTSRM",52,0)
 Q:$D(Y)
"RTN","GMTSRM",53,0)
 D LIST,EXISTS
"RTN","GMTSRM",54,0)
 Q
"RTN","GMTSRM",55,0)
EXISTS ; Edit an existing health summary type
"RTN","GMTSRM",56,0)
 N CNT,NXTCMP Q:$D(DUOUT)  S NXTCMP=0,NXTCMP(0)=0
"RTN","GMTSRM",57,0)
 F CNT=$$GETCNT(GMTSIFN):0 D NXTCMP^GMTSRM1,LIST:GMTSQIT Q:GMTSQIT!($D(DUOUT))  K GMTSQIT,GMTSNEW,TWEENER,SOACTION
"RTN","GMTSRM",58,0)
 I NXTCMP>0 W !,"Please hold on while I resequence the summary order" D COPY^GMTSRN,RNMBR^GMTSRN:CHANGE
"RTN","GMTSRM",59,0)
 Q
"RTN","GMTSRM",60,0)
LIST ; Lists existing summary parameters
"RTN","GMTSRM",61,0)
 N B,DIC,DIR,IOP,Y,FR,TO,BY,DHD,FLDS,L
"RTN","GMTSRM",62,0)
 I GMTSQIT'=2 Q:($D(DUOUT)!(GMTSQIT=1))
"RTN","GMTSRM",63,0)
 I GMTSQIT=2,(NXTCMP=0) S GMTSQIT=0 Q
"RTN","GMTSRM",64,0)
 I 'GMTSNEW W ! S DIC=142,DIR(0)="Y",DIR("A")="Do you wish to review the Summary Type structure before continuing",DIR("B")="NO" D ^DIR K DIR I 'Y S:GMTSQIT=2 DUOUT="" S:GMTSQIT=2 GMTSQIT="D" S:$D(DUOUT) GMTSQIT=1 Q
"RTN","GMTSRM",65,0)
 I $D(GMTSQIT),GMTSQIT=2 S GMTSQIT=0
"RTN","GMTSRM",66,0)
 S IOP="HOME",DIC=142,(FR,TO)=GMTSUM,BY=".01",DHD="[GMTS TYPE INQ HEADER]-[GMTS TYPE INQ FOOTER]",FLDS="[GMTS TYPE INQ]",L=0 D EN1^DIP
"RTN","GMTSRM",67,0)
 Q
"RTN","GMTSRM",68,0)
GETCNT(GMTSIFN) ; Determine default summary order for new component
"RTN","GMTSRM",69,0)
 N LI,LCNT S LI=0,LCNT=5 F  S LI=$O(^GMT(142,+GMTSIFN,1,LI)) Q:+LI'>0  S LCNT=$P(LI,".")+5
"RTN","GMTSRM",70,0)
 Q LCNT
"RTN","GMTSULT")
0^18^B72747736
"RTN","GMTSULT",1,0)
GMTSULT ; SLC/KER - HS Type Lookup                      ; 01/06/2003
"RTN","GMTSULT",2,0)
 ;;2.7;Health Summary;**30,35,29,47,58**;Oct 20, 1995
"RTN","GMTSULT",3,0)
 ;
"RTN","GMTSULT",4,0)
 ; External References
"RTN","GMTSULT",5,0)
 ;   DBIA 10060  ^VA(200
"RTN","GMTSULT",6,0)
 ;   DBIA  2056  $$GET1^DIQ (file 200)
"RTN","GMTSULT",7,0)
 ;   DBIA  2055  RECALL^DILFD
"RTN","GMTSULT",8,0)
 ;   DBIA 10103  $$NOW^XLFDT
"RTN","GMTSULT",9,0)
 ;   DBIA 10011  ^DIWP
"RTN","GMTSULT",10,0)
 ;   DBIA 10029  ^DIWW
"RTN","GMTSULT",11,0)
 ;   DBIA 10026  ^DIR
"RTN","GMTSULT",12,0)
 ;   DBIA 10016  ^DIM
"RTN","GMTSULT",13,0)
 ;   DBIA 10076  ^XUSEC(
"RTN","GMTSULT",14,0)
 ;   DBIA  1131  ^XMB("NETNAME")
"RTN","GMTSULT",15,0)
 ;   DBIA  2198  $$BROKER^XWBLIB
"RTN","GMTSULT",16,0)
 ;   DBIA 10006  ^DIC (file #142)
"RTN","GMTSULT",17,0)
 ;   DBIA 10096  ^%ZOSF("TEST")
"RTN","GMTSULT",18,0)
 ;            
"RTN","GMTSULT",19,0)
 N DIC,DTOUT,DUOUT,DIRUT D DICHK S DIC(0)="AEMQZ" S Y=$$TYPE^GMTSULT Q
"RTN","GMTSULT",20,0)
EN ; Lookup (general)
"RTN","GMTSULT",21,0)
 Q:$G(DIC(0))["I"
"RTN","GMTSULT",22,0)
 K DTOUT,DUOUT N GMTSDICW,GMTSDICS,GMTSDIC,GMTSLGO,GMTSDIC0,GMTSDICB,GMTSDEF,GMTSWY,GMTSDISV,GMTSDICA,GMTSLERR,GMTSE,GMTSQ,GMTSX,DIR,DIRUT,DIROUT,GMTS
"RTN","GMTSULT",23,0)
 S GMTSE=$$ECHO D LD S U="^"
"RTN","GMTSULT",24,0)
 S (GMTSDEF,GMTSQ)=0,GMTSX=$G(X) S:$L(GMTSDIC0)&(GMTSDIC0'["A") GMTSQ=1 K Y
"RTN","GMTSULT",25,0)
 ;   Get X
"RTN","GMTSULT",26,0)
 ;     Ask the entry          DIC(0)["A" (INPUT^GMTSULT5)
"RTN","GMTSULT",27,0)
 S:GMTSDIC0'["A"&($L(GMTSX)) X=GMTSX
"RTN","GMTSULT",28,0)
 K GMTSLERR S:GMTSDIC0["A"!('$L(GMTSX)) X=$$INPUT^GMTSULT5
"RTN","GMTSULT",29,0)
 I $D(DTOUT)!($D(DUOUT)) S Y=-1 S:$D(DTOUT) DTOUT=1 S:$D(DUOUT) DUOUT=1 Q
"RTN","GMTSULT",30,0)
 ;     Is X an IEN            From Spacebar-Return
"RTN","GMTSULT",31,0)
 I +($$XIEN(X))>0 D  Q
"RTN","GMTSULT",32,0)
 . K Y S Y=+($$XIEN(X))
"RTN","GMTSULT",33,0)
 . D Y^GMTSULT6(+Y),RD,CLR
"RTN","GMTSULT",34,0)
 . I ($G(GMTSDIC0)["Q"!($G(DIC(0))["Q")),+($G(Y))<0 W " ??"
"RTN","GMTSULT",35,0)
 ;     No Input or Error      X="" or X["^" or '$D(X)
"RTN","GMTSULT",36,0)
 I $D(DTOUT)!($D(DUOUT))!($D(DIRUT))!($D(DIROUT))!($G(X)="")!($G(X)["^") D  Q
"RTN","GMTSULT",37,0)
 . K Y W !!,?5 W:'$L($G(GMTSLERR)) "No Health Summary Type selected"
"RTN","GMTSULT",38,0)
 . W:$L($G(GMTSLERR)) GMTSLERR W ! S Y=-1 D RD,CLR
"RTN","GMTSULT",39,0)
 ;     Exact Match Required   DIC(0)["X"
"RTN","GMTSULT",40,0)
 I GMTSDIC0["X",$L(X) D  Q
"RTN","GMTSULT",41,0)
 . K Y S Y=-1,GMTSX=$$EM^GMTSULT2(X) D:+GMTSX>0 Y^GMTSULT6(+GMTSX) D RD,CLR
"RTN","GMTSULT",42,0)
 ;   Select
"RTN","GMTSULT",43,0)
 ;     Get Selection List
"RTN","GMTSULT",44,0)
 D LIST^GMTSULT2(X)
"RTN","GMTSULT",45,0)
 ;     Select from multiple entries
"RTN","GMTSULT",46,0)
 D:+($G(^TMP("GMTSULT",$J,0)))>1 MULTI^GMTSULT6
"RTN","GMTSULT",47,0)
 ;     Select from one entry
"RTN","GMTSULT",48,0)
 D:+($G(^TMP("GMTSULT",$J,0)))=1 ONE^GMTSULT6
"RTN","GMTSULT",49,0)
 S:'$D(Y)!(+($G(Y))'>0) Y=-1
"RTN","GMTSULT",50,0)
 ;          
"RTN","GMTSULT",51,0)
 ; DLAYGO allowed
"RTN","GMTSULT",52,0)
 ;   Add entry
"RTN","GMTSULT",53,0)
 I $L(X),Y=-1,$G(GMTSDIC0)["L",+($G(GMTSLGO))=142 D
"RTN","GMTSULT",54,0)
 . Q:$L(X)<3!($L(X)>30)  K Y(0) N DLAYGO,GMTSOD0,GMTSOX S GMTSOD0=DIC(0),GMTSOX=X
"RTN","GMTSULT",55,0)
 . N X,DA,DIC,DIK S DIC(0)="LM",(DIK,DIC)="^GMT(142,",DLAYGO=142,X=GMTSOX
"RTN","GMTSULT",56,0)
 . L +^GMT(142):2 W:'$T !,"  Can not add Health Summary Type, the file is in ",!,"  use by another user.  Please try again later."
"RTN","GMTSULT",57,0)
 . D:$T ADD L -^GMT(142) S (GMTSDIC0,DIC(0))=GMTSOD0
"RTN","GMTSULT",58,0)
 D RD,CLR
"RTN","GMTSULT",59,0)
 Q
"RTN","GMTSULT",60,0)
ADD ;   Add Health Summary Type
"RTN","GMTSULT",61,0)
 N GMTSOK,GMTSU,GMTSD,GMTSM S GMTSM=$$MSG
"RTN","GMTSULT",62,0)
 S GMTSU=$$GET1^DIQ(200,+($G(DUZ)),.01) I '$L(GMTSU) D  S Y=-1 Q
"RTN","GMTSULT",63,0)
 . W !!,"  Undefined/Invalid User",!
"RTN","GMTSULT",64,0)
 S GMTSU=+($$GET1^DIQ(200,+($G(DUZ)),9.2,"I")),GMTSD=$$NOW^XLFDT
"RTN","GMTSULT",65,0)
 I GMTSU>0&(GMTSU<GMTSD) D  S Y=-1 Q
"RTN","GMTSULT",66,0)
 . W !!,"  Terminated Users may not add a Health Summary",!
"RTN","GMTSULT",67,0)
 S GMTSOK=+($$ASKA(X)) Q:'GMTSOK
"RTN","GMTSULT",68,0)
 S DA=$$DA I DA'>0!($D(^GMT(142,DA))) S Y=-1 Q
"RTN","GMTSULT",69,0)
 S $P(^GMT(142,DA,0),"^",1)=X,$P(^GMT(142,DA,0),"^",3)=+($G(DUZ))
"RTN","GMTSULT",70,0)
 D SI I '$D(^GMT(142,"B",$E(X,1,30),DA)) D KI K ^GMT(142,DA) S Y=-1 Q
"RTN","GMTSULT",71,0)
 S Y=DA_"^"_X_"^1"
"RTN","GMTSULT",72,0)
 Q
"RTN","GMTSULT",73,0)
 ;          
"RTN","GMTSULT",74,0)
DA(X) ; Get IEN
"RTN","GMTSULT",75,0)
 S X=$O(^GMT(142,"4999999"),-1) F  Q:'$D(^GMT(142,X))  S X=X+1
"RTN","GMTSULT",76,0)
 Q:X<5000000 X  Q:X>5000999 X
"RTN","GMTSULT",77,0)
 S X=$O(^GMT(142,"!"),-1) F  Q:'$D(^GMT(142,X))  S X=X+1
"RTN","GMTSULT",78,0)
 S:X>4999999&(X<6000000) X=6000000 Q X
"RTN","GMTSULT",79,0)
ET(T) ; Error Text
"RTN","GMTSULT",80,0)
 I $D(DIEV0) D  Q:+($G(DIQUIET))>0
"RTN","GMTSULT",81,0)
 . N I,E,A S I=+($G(DIERR)) S:I=0 I=1 S A=$G(GMTSM) S:A="" A="GMTSE" S E=$O(@(A_"(""GMTSERR"","_I_","" "")"),-1)+1,@(A_"(""GMTSERR"","_I_","_+E_")")=$G(T),@(A_"(""GMTSENV"")")=1
"RTN","GMTSULT",82,0)
 Q:$D(GMTSETQ)  N %,X,Y,Z,I,DIW,DIWF,DIWL,DIWR,DIWT,DN S X=T,DIWL=6,DIWR=78,DIWF="W" D ^DIWP D:$D(^UTILITY($J)) ^DIWW W ?5 Q
"RTN","GMTSULT",83,0)
BL ; Blank Line
"RTN","GMTSULT",84,0)
 Q:+($G(DIQUIET))>0  Q:$D(GMTSETQ)  W !,?5 Q
"RTN","GMTSULT",85,0)
MSG() ; Message
"RTN","GMTSULT",86,0)
 Q:$L($G(DIMSG)) $G(DIMSG) Q:$L($G(DIMSGA)) $G(DIMSGA) Q:$L($G(DIOUTAR)) $G(DIOUTAR) Q:$L($G(DIEFOUT)) $G(DIEFOUT) Q:$L($G(GMTSMS)) $G(GMTSMS)
"RTN","GMTSULT",87,0)
 Q "TMP"
"RTN","GMTSULT",88,0)
ASKA(X) ; Ask if adding
"RTN","GMTSULT",89,0)
 N GMTSN,GMTSN,GMTSX S GMTSN=$G(X) Q:'$L(X) 0  Q:+($$DUP^GMTSULT7(X))>0 0
"RTN","GMTSULT",90,0)
 N DIR,DTOUT,DIROUT,DIRUT,DUOUT S GMTSX=+($$N)+1,GMTSX=$S(GMTSX=0:"",GMTSX=1:(GMTSX_"st"),GMTSX=2:(GMTSX_"nd"),GMTSX=3:(GMTSX_"rd"),1:(GMTSX_"th"))
"RTN","GMTSULT",91,0)
 S DIR(0)="YAO",DIR("A",1)="Are you adding '"_GMTSN_"' as ",DIR("A")="    a new HEALTH SUMMARY TYPE"_$S($L(GMTSX):(" (the "_GMTSX_")"),1:"")_"?   ",DIR("B")="No"
"RTN","GMTSULT",92,0)
 W ! D ^DIR S:$D(DTOUT)!($D(DUOUT))!($D(DIRUT))!($D(DIROUT)) X="^" S:X["^" X="^" Q:X="^" 0
"RTN","GMTSULT",93,0)
 S X=+($G(Y)) S:+X'>0 X=0 Q X
"RTN","GMTSULT",94,0)
N(X) ; Number of Types
"RTN","GMTSULT",95,0)
 N I S (I,X)=0 F  S I=$O(^GMT(142,I)) Q:+I=0  S X=X+1
"RTN","GMTSULT",96,0)
 Q X
"RTN","GMTSULT",97,0)
SI ; Set Indexes
"RTN","GMTSULT",98,0)
 D MS N GMTS,GMTSX,GMTSO,GMTSC S GMTS=+($G(DA)),GMTSO=$G(X) Q:GMTS'>0  Q:'$D(^GMT(142,GMTS,0))  Q:'$L(X)  N X,DA
"RTN","GMTSULT",99,0)
 S DA=GMTS,GMTSX=0 F  S GMTSX=$O(^TMP($J,142,.01,1,GMTSX)) Q:+GMTSX=0  D
"RTN","GMTSULT",100,0)
 . S X=$G(^TMP($J,142,.01,1,GMTSX,1)) D ^DIM Q:'$D(X)  S GMTSC=X,X=GMTSO,DA=GMTS X GMTSC
"RTN","GMTSULT",101,0)
 D MK Q
"RTN","GMTSULT",102,0)
KI ; Kill Indexes
"RTN","GMTSULT",103,0)
 D MS N GMTS,GMTSX,GMTSO,GMTSC S GMTS=+($G(DA)),GMTSO=$G(X) N X,DA
"RTN","GMTSULT",104,0)
 S DA=GMTS,GMTSX=0 F  S GMTSX=$O(^TMP($J,142,.01,1,GMTSX)) Q:+GMTSX=0  D
"RTN","GMTSULT",105,0)
 . S X=$G(^TMP($J,142,.01,1,GMTSX,2)) D ^DIM Q:'$D(X)
"RTN","GMTSULT",106,0)
 . S GMTSC=X,X=GMTSO W !,GMTSC,?60,X,?70,DA
"RTN","GMTSULT",107,0)
 D MK Q
"RTN","GMTSULT",108,0)
MS ; Merge Set
"RTN","GMTSULT",109,0)
 M ^TMP($J,142,.01,1)=@("^DD("_142_",.01,1)") Q
"RTN","GMTSULT",110,0)
MK ; Merge Kill
"RTN","GMTSULT",111,0)
 K ^TMP($J,142,.01,1) Q
"RTN","GMTSULT",112,0)
TYPE(GMTSI) ; Get Health Summary Type
"RTN","GMTSULT",113,0)
 ;   Needs DIC(0)
"RTN","GMTSULT",114,0)
 K Y S:$L($G(X)) X=$G(X)
"RTN","GMTSULT",115,0)
 D EN^GMTSULT S GMTSI=-1 S:+($G(Y))>0&($D(^GMT(142,+($G(Y)),0))) GMTSI=$G(Y) Q GMTSI
"RTN","GMTSULT",116,0)
XIEN(X) ; Is X in a Y or `IEN format  Quit +IEN
"RTN","GMTSULT",117,0)
 N GMTSX,GMTSL,GMTSI,GMTSN,GMTSY,GMTSOK
"RTN","GMTSULT",118,0)
 S GMTSX=$G(X),GMTSL=$E(GMTSX,1),GMTSI=$E(GMTSX,2,$L(GMTSX))
"RTN","GMTSULT",119,0)
 S GMTSOK=$$DICS^GMTSULT2($G(GMTSDICS),$P($G(^GMT(142,+GMTSI,0)),"^",1),+GMTSI) Q:'GMTSOK -1
"RTN","GMTSULT",120,0)
 I GMTSL="`",+GMTSI>0,+GMTSI=GMTSI,$D(^GMT(142,+GMTSI,0)),$L($P($G(^GMT(142,+GMTSI,0)),"^",1)) S X=GMTSI Q X
"RTN","GMTSULT",121,0)
 S GMTSI=$S($D(^GMT(142,+GMTSX,0)):+X,1:-1)
"RTN","GMTSULT",122,0)
 S GMTSN=$P($G(^GMT(142,+GMTSX,0)),"^",1)
"RTN","GMTSULT",123,0)
 I GMTSI=+GMTSX&(GMTSN=$P(GMTSX,"^",2)) S X=GMTSI Q X
"RTN","GMTSULT",124,0)
 Q 0
"RTN","GMTSULT",125,0)
LD ; Load DIC Variables
"RTN","GMTSULT",126,0)
 D DICHK S (DIC,GMTSDIC)="^GMT(142,",GMTSDIC0="AEM" S:$L($G(DLAYGO)) GMTSLGO=$G(DLAYGO) S GMTSDICA="Select HEALTH SUMMARY TYPE:  " K Y
"RTN","GMTSULT",127,0)
 S:$L($G(DIC("W"))) GMTSDICW=DIC("W") S:$L($G(DIC("S"))) GMTSDICS=DIC("S") S:$L($G(DIC("A"))) GMTSDICA=DIC("A") S:$L($G(DIC("B"))) GMTSDICB=DIC("B") S:$L($G(DIC(0))) GMTSDIC0=DIC(0)
"RTN","GMTSULT",128,0)
 Q
"RTN","GMTSULT",129,0)
 ;          
"RTN","GMTSULT",130,0)
 ; Lookup Screens - DIC("S")="I +$$..
"RTN","GMTSULT",131,0)
EOK(X) ;   Edit OK
"RTN","GMTSULT",132,0)
 N OK,GMTS S X=+($G(X)),OK=1 S:'$D(^GMT(142,+X,0)) OK=0 S:$P($G(^GMT(142,+X,"VA")),U)=2 OK=0 S X=OK Q X
"RTN","GMTSULT",133,0)
EST(X) ;   Edit Health Summary Type (other than Adhoc)
"RTN","GMTSULT",134,0)
 N GMTSI,GMTSO,GMTS S X=+($G(X))
"RTN","GMTSULT",135,0)
 Q:'$L($P($G(^VA(200,+($G(DUZ)),0)),U)) 0 Q:+($G(DUZ(2)))=0 0
"RTN","GMTSULT",136,0)
 S GMTSI=$P($G(^GMT(142,+X,0)),U) Q:GMTSI="GMTS HS ADHOC OPTION"!(GMTSI="GMTS HS REMOTE ADHOC OPTION") 0
"RTN","GMTSULT",137,0)
 S GMTSI=+($P($G(^GMT(142,+X,"VA")),U)),GMTSO=$G(^XMB("NETNAME")) Q:GMTSI=2&'(GMTSO["ISC-SLC"&(+($G(DUZ(2)))=5000)) 0 Q:GMTSI=2&(GMTSO["ISC-SLC"&(+($G(DUZ(2)))=5000)) 1
"RTN","GMTSULT",138,0)
 S GMTSI=+($P($G(^GMT(142,+X,0)),U,3)) Q:GMTSI>0&(GMTSI=+($G(DUZ))) 1
"RTN","GMTSULT",139,0)
 S GMTSI=$P($G(^GMT(142,+X,0)),U,2),GMTSO=0 S:$L(GMTSI) GMTSO=$S(((+($G(DUZ))>0)&('$D(^XUSEC(GMTSI,+($G(DUZ)))))):1,1:0) Q:GMTSO=1 0
"RTN","GMTSULT",140,0)
 S GMTSI=+($P($G(^GMT(142,+X,0)),U,3)),GMTSO=$D(^GMT(142,+X,2,"B",+($G(DUZ)))) Q:GMTSI>0&(+($G(DUZ))>0)&(GMTSI'=+($G(DUZ)))&(+GMTSO>0) 1
"RTN","GMTSULT",141,0)
 S GMTSI=+($P($G(^GMT(142,+X,0)),U,3)) Q:GMTSI>0&(GMTSI'=+($G(DUZ))) 0
"RTN","GMTSULT",142,0)
 S GMTSI=$P($G(^GMT(142,+X,0)),U,2),GMTSO=0 S:$L(GMTSI) GMTSO=$S(((+($G(DUZ))>0)&($D(^XUSEC(GMTSI,+($G(DUZ)))))):1,1:0) Q:GMTSO=1 1
"RTN","GMTSULT",143,0)
 Q 1
"RTN","GMTSULT",144,0)
HST(X) ;   Health Summary Type
"RTN","GMTSULT",145,0)
 N GMTS S X=+($G(X)),GMTS=1 S:$P($G(^GMT(142,+X,0)),U)="GMTS HS ADHOC OPTION" GMTS=0 S:$P($G(^GMT(142,+X,0)),U)="GMTS HS REMOTE ADHOC OPTION" GMTS=0 S:+($G(^GMT(142,+X,"VA")))>0 GMTS=0
"RTN","GMTSULT",146,0)
 S X=GMTS Q X
"RTN","GMTSULT",147,0)
DHST(X) ;   Delete Health Summary Type
"RTN","GMTSULT",148,0)
 N GMTS S X=+($G(X)),GMTS=1
"RTN","GMTSULT",149,0)
 S:$P($G(^GMT(142,+X,0)),U)="GMTS HS ADHOC OPTION" GMTS=0 S:$P($G(^GMT(142,+X,0)),U)="GMTS HS REMOTE ADHOC OPTION" GMTS=0
"RTN","GMTSULT",150,0)
 S:+($G(^GMT(142,+X,"VA")))>0 GMTS=0 S:$D(^GMT(142.5,"AC",+X)) GMTS=0
"RTN","GMTSULT",151,0)
 S X=GMTS Q X
"RTN","GMTSULT",152,0)
AHST(X) ;   Add Health Summary Type
"RTN","GMTSULT",153,0)
 N GMTS S X=+($G(X)),GMTS=1 S:$P($G(^GMT(142,+X,0)),U)="GMTS HS ADHOC OPTION" GMTS=0 S:$P($G(^GMT(142,+X,0)),U)="GMTS HS REMOTE ADHOC OPTION" GMTS=0
"RTN","GMTSULT",154,0)
 S:((+X>4999999)&(+X<6000000)) GMTS=0 S:+($G(^GMT(142,+X,"VA")))>0 GMTS=0
"RTN","GMTSULT",155,0)
 S X=GMTS Q X
"RTN","GMTSULT",156,0)
ADH(X) ;   Adhoc
"RTN","GMTSULT",157,0)
 N GMTS S X=+($G(X)),GMTS=1 S:$P($G(^GMT(142,+X,0)),U)'="GMTS HS ADHOC OPTION" GMTS=0 S X=GMTS Q X
"RTN","GMTSULT",158,0)
REM(X) ;   Remote Adhoc
"RTN","GMTSULT",159,0)
 N GMTS S X=+($G(X)),GMTS=1 S:$P($G(^GMT(142,+X,0)),U)'="GMTS HS REMOTE ADHOC OPTION" GMTS=0 S X=GMTS Q X
"RTN","GMTSULT",160,0)
 Q
"RTN","GMTSULT",161,0)
 ;          
"RTN","GMTSULT",162,0)
DICHK ; Check DIC variables
"RTN","GMTSULT",163,0)
 K DIC("DR"),DIC("P"),DIC("V"),DINUM,DTOUT,DUOUT
"RTN","GMTSULT",164,0)
 S:'$L($G(DIC(0))) DIC(0)="AEMZB" S:'$L($G(DIC)) DIC="^GMT(142,"
"RTN","GMTSULT",165,0)
 I +($G(GMTSE))=0 F  Q:DIC(0)'["E"  S DIC(0)=$P(DIC(0),"E",1)_$P(DIC(0),"E",2)
"RTN","GMTSULT",166,0)
 S:'$L($G(DIC("A"))) DIC("A")="Select HEALTH SUMMARY TYPE:  "
"RTN","GMTSULT",167,0)
 Q
"RTN","GMTSULT",168,0)
RD ; Restore DIC Variables
"RTN","GMTSULT",169,0)
 S:$L($G(GMTSDIC)) DIC=GMTSDIC S:$L($G(GMTSDICS)) DIC("S")=GMTSDICS
"RTN","GMTSULT",170,0)
 S:$L($G(GMTSDICW)) DIC("W")=GMTSDICW S:$L($G(GMTSDICA)) DIC("A")=GMTSDICA
"RTN","GMTSULT",171,0)
 S:$L($G(GMTSDICB)) DIC("B")=GMTSDICB S:$L($G(GMTSDIC0)) DIC(0)=GMTSDIC0
"RTN","GMTSULT",172,0)
 I $L($G(X)),X["`" D
"RTN","GMTSULT",173,0)
 . N GMTSI,GMTSL S GMTSL=$E(X,1),GMTSI=$E(X,2,$L(X))
"RTN","GMTSULT",174,0)
 . I GMTSL="`",+GMTSI>0,$D(^GMT(142,+GMTSI,0)),$L($P($G(^GMT(142,+GMTSI,0)),"^",1)) S X=$P($G(^GMT(142,+GMTSI,0)),"^",1)
"RTN","GMTSULT",175,0)
 K GMTSDICS,GMTSDIC,GMTSDIC0,GMTSDICB,GMTS,GMTSDISV,GMTSDICA Q
"RTN","GMTSULT",176,0)
ECHO(X) ; Echo Results (writes/reads)
"RTN","GMTSULT",177,0)
 S X=$$ROK("XWBLIB") Q:'X 1 S X=$$BROKER^XWBLIB Q:X 0 Q 1
"RTN","GMTSULT",178,0)
SDISV(Y) ; Set DISV (IEN)
"RTN","GMTSULT",179,0)
 Q:+($G(DUZ))=0!(+($G(Y))=0)
"RTN","GMTSULT",180,0)
 D RECALL^DILFD(142,+($G(Y))_",",+($G(DUZ))) Q
"RTN","GMTSULT",181,0)
RDISV(X) ; Read DISV
"RTN","GMTSULT",182,0)
 Q:+($G(DUZ))=0 ""
"RTN","GMTSULT",183,0)
 N DIC,Y S DIC=142,DIC(0)="Z",X=" " D ^DIC S X=$S(+Y>0:Y,1:"") Q X
"RTN","GMTSULT",184,0)
ROK(X) ; Routine OK
"RTN","GMTSULT",185,0)
 S X=$G(X) Q:'$L(X) 0 Q:$L(X)>8 0 X ^%ZOSF("TEST") Q:$T 1 Q 0
"RTN","GMTSULT",186,0)
CLR ;   Kill ^TMP("GMTS*
"RTN","GMTSULT",187,0)
 K ^TMP("GMTSULT",$J),^TMP("GMTSULT2",$J) Q
"RTN","GMTSULT",188,0)
CLEAN ;   Kill ^TMP("GMTSULT2")
"RTN","GMTSULT",189,0)
 K ^TMP("GMTSULT2",$J) Q
"RTN","GMTSULT5")
0^33^B19695812
"RTN","GMTSULT5",1,0)
GMTSULT5 ; SLC/KER - HS Type Lookup (User Input)  ; 01/06/2003
"RTN","GMTSULT5",2,0)
 ;;2.7;Health Summary;**30,35,56,58**;Oct 20, 1995
"RTN","GMTSULT5",3,0)
 ;
"RTN","GMTSULT5",4,0)
 ; External References
"RTN","GMTSULT5",5,0)
 ;   DBIA 10026  ^DIR
"RTN","GMTSULT5",6,0)
 ;   DBIA 10006  ^DIC  (file #142)
"RTN","GMTSULT5",7,0)
 ;   DBIA 10060  ^VA(200,
"RTN","GMTSULT5",8,0)
 ;   DBIA  2056  $$GET1^DIQ  (file #200)
"RTN","GMTSULT5",9,0)
 ;                      
"RTN","GMTSULT5",10,0)
 Q
"RTN","GMTSULT5",11,0)
INPUT(X) ; Get User's Input
"RTN","GMTSULT5",12,0)
 N Y,GMTSDISV,GMTSB,GMTSD,DIR S GMTSDISV=0 D GDISV
"RTN","GMTSULT5",13,0)
 S DIR(0)="FAO^1:30^N GMTS S X=$$DEF^GMTSULT5(X),GMTS=$$INPT^GMTSULT5(X) K:'GMTS X"
"RTN","GMTSULT5",14,0)
 S DIR("?")="^D IN1^GMTSULT5",DIR("??")="^D IN2^GMTSULT5"
"RTN","GMTSULT5",15,0)
 S:'$L($G(GMTSDICA)) DIR("A")="Select HEALTH SUMMARY TYPE:  " S:$L($G(GMTSDICA)) DIR("A")=GMTSDICA
"RTN","GMTSULT5",16,0)
 S GMTSD=0 S:$L($G(GMTSDICB)) DIR("A")=DIR("A")_$G(GMTSDICB)_"//  "
"RTN","GMTSULT5",17,0)
 I $L($G(DIR("B"))) W !,DIR("A") S X=DIR("B") Q X
"RTN","GMTSULT5",18,0)
 D ^DIR K:X=""&($L($G(GMTSDICB)))&('$D(DTOUT)) DIRUT
"RTN","GMTSULT5",19,0)
 S:X=""&($L($G(GMTSDICB))) (X,Y)=GMTSDICB,GMTSDEF=1 Q:$D(DTOUT)!($D(DUOUT)) X
"RTN","GMTSULT5",20,0)
 S:X=" "&($L(Y))&($G(GMTSDIC0)'["F")&(+GMTSDISV>0)&($L($P($G(^GMT(142,+GMTSDISV,0)),"^",1))) X="`"_GMTSDISV
"RTN","GMTSULT5",21,0)
 Q X
"RTN","GMTSULT5",22,0)
 ;                        
"RTN","GMTSULT5",23,0)
 ; Help
"RTN","GMTSULT5",24,0)
IN1 ;   Single Question Mark Help ? for User Input
"RTN","GMTSULT5",25,0)
 N %,%A,%B,%B1,%B2,%B3,%BA,%C,%E,%G,%H,%I,%J,%N,%P,%S,%T,%W,%X,%Y,%BU,%J1,%A0,%W0,%D1,%D2,%DT,%K,%M
"RTN","GMTSULT5",26,0)
 I X=" "&($G(GMTSDIC0)'["F") D  Q
"RTN","GMTSULT5",27,0)
 . D GDISV
"RTN","GMTSULT5",28,0)
 . S:+($G(GMTSDISV))>0 X=$P($G(^GMT(142,+($G(GMTSDISV)),0)),U,1),(Y,GMTSD)=+GMTSDISV
"RTN","GMTSULT5",29,0)
 D GHT Q
"RTN","GMTSULT5",30,0)
IN2 ;   Double Question Mark Help ? with listing
"RTN","GMTSULT5",31,0)
 N %,%A,%B,%B1,%B2,%B3,%BA,%C,%E,%G,%H,%I,%J,%N,%P,%S,%T,%W,%X,%Y,%BU,%J1,%A0,%W0,%D1,%D2,%DT,%K,%M
"RTN","GMTSULT5",32,0)
 W !!,"Choose from:"
"RTN","GMTSULT5",33,0)
 N GMTSHS,GMTSC,GMTSCT,GMTSIEN,GMTSOK,GMTSTR,GMTSTL,GMTST,GMTSPL,GMTSTT,GMTSRR
"RTN","GMTSULT5",34,0)
 S (GMTSC,GMTST)=0,GMTSCT=1,GMTSHS="",GMTSPL=+($G(IOSL))-8 S:GMTSPL'>0 GMTSPL=18
"RTN","GMTSULT5",35,0)
 S GMTSTT=0,GMTSHS="" F  S GMTSHS=$O(^GMT(142,"B",GMTSHS)) Q:GMTSHS=""  S GMTSIEN=0 F  S GMTSIEN=$O(^GMT(142,"B",GMTSHS,GMTSIEN)) Q:+GMTSIEN=0  S GMTSTT=GMTSTT+1
"RTN","GMTSULT5",36,0)
 S GMTSRR=GMTSTT F  S GMTSHS=$O(^GMT(142,"B",GMTSHS)) Q:GMTSHS=""!('GMTSCT)  Q:GMTST>0  D  Q:'GMTSCT  Q:GMTST>0
"RTN","GMTSULT5",37,0)
 . S GMTSIEN=0 F  S GMTSIEN=$O(^GMT(142,"B",GMTSHS,GMTSIEN)) Q:+GMTSIEN=0!('GMTSCT)  Q:GMTST>0  D  Q:'GMTSCT  Q:+GMTST>0
"RTN","GMTSULT5",38,0)
 . . S GMTSTL="",GMTSOK=1,GMTSTR=$P($G(^GMT(142,GMTSIEN,0)),U,1) Q:'$L(GMTSTR)
"RTN","GMTSULT5",39,0)
 . . S GMTSOK=1 I $L($G(GMTSDICS)) S GMTSOK=$$DICS^GMTSULT2(GMTSDICS,X,GMTSIEN) Q:'GMTSOK
"RTN","GMTSULT5",40,0)
 . . F  Q:$L(GMTSTR)>33  S GMTSTR=GMTSTR_" "
"RTN","GMTSULT5",41,0)
 . . S GMTSTL=$P($G(^GMT(142,GMTSIEN,"T")),U,1)
"RTN","GMTSULT5",42,0)
 . . S:$L(GMTSTL) GMTSTR=GMTSTR_GMTSTL
"RTN","GMTSULT5",43,0)
 . . S GMTSC=GMTSC+1,GMTSRR=GMTSRR-1 W !,?3,GMTSTR I +GMTSC>GMTSPL D IN2C S GMTSC=0
"RTN","GMTSULT5",44,0)
 W ! D:GMTST'>1 GHT Q
"RTN","GMTSULT5",45,0)
IN2C ;   Ask to Continue Listing
"RTN","GMTSULT5",46,0)
 N X W !,?3,"""^"" TO STOP:" R X:300
"RTN","GMTSULT5",47,0)
 S:'$T!(X["^") GMTSC=0 S:X["^" GMTST=1
"RTN","GMTSULT5",48,0)
 S:X["^^" GMTST=2 Q
"RTN","GMTSULT5",49,0)
GHT ;   General Help Text
"RTN","GMTSULT5",50,0)
 W !,?5,"Answer with Health Summary Type name, title, owner or hospital"
"RTN","GMTSULT5",51,0)
 W !,?5,"location using the summary.  Your response must be at least 2"
"RTN","GMTSULT5",52,0)
 W !,?5,"characters and no more than 30 characters and must not contain"
"RTN","GMTSULT5",53,0)
 W !,?5,"an embedded uparrow" Q
"RTN","GMTSULT5",54,0)
 ;                        
"RTN","GMTSULT5",55,0)
 ; Defaults values
"RTN","GMTSULT5",56,0)
DEF(X) ;   Default
"RTN","GMTSULT5",57,0)
 S X=$G(X)
"RTN","GMTSULT5",58,0)
 I +X>0,$D(^GMT(142,+X,0)),($G(GMTSDIC0)["N"!($G(GMTSDIC0)["N")) D  Q X
"RTN","GMTSULT5",59,0)
 . S (Y,GMTSD)=+X,X=$P($G(^GMT(142,+Y,0)),U,1)
"RTN","GMTSULT5",60,0)
 I $E(X,1)="`",+($E(X,2,$L(X)))>0,$D(^GMT(142,+($E(X,2,$L(X))),0)) D  Q X
"RTN","GMTSULT5",61,0)
 . S (Y,GMTSD)=+($E(X,2,$L(X))),X=$P($G(^GMT(142,+Y,0)),U,1)
"RTN","GMTSULT5",62,0)
 I X=" "&($G(GMTSDIC0)'["F") D
"RTN","GMTSULT5",63,0)
 . D GDISV S:+($G(GMTSDISV))>0 X=$P($G(^GMT(142,+($G(GMTSDISV)),0)),U,1),(Y,GMTSD)=+GMTSDISV
"RTN","GMTSULT5",64,0)
 Q X
"RTN","GMTSULT5",65,0)
GDISV ;   Get Default Value (Spacebar-Return)
"RTN","GMTSULT5",66,0)
 S GMTSDISV=0 N DIC,Y,X,DLAYGO,DINUM,DTOUT,DUOUT,GMTSOK,%,%A,%B,%B1,%B2,%B3,%BA,%C,%E,%G,%H,%I,%J,%N,%P,%S,%T,%W,%X,%Y,%BU,%J1,%A0,%W0,%D1,%D2,%DT,%K,%M
"RTN","GMTSULT5",67,0)
 Q:+($G(DUZ))=0  Q:'$L($$GET1^DIQ(200,(+($G(DUZ))_","),.01))  S DIC=142,DIC(0)="Z",X=" ",GMTSOK=1 D ^DIC
"RTN","GMTSULT5",68,0)
 S:$L($G(GMTSDICS)) GMTSOK=$$DICS^GMTSULT2($G(GMTSDICS),$G(X),+($G(Y))) S:+GMTSOK'>0 Y=-1
"RTN","GMTSULT5",69,0)
 S GMTSDISV=$S(+Y>0:+Y,1:"")
"RTN","GMTSULT5",70,0)
 Q
"RTN","GMTSULT5",71,0)
 ;                        
"RTN","GMTSULT5",72,0)
 ; Miscellaneous
"RTN","GMTSULT5",73,0)
INPT(X) ;   Input Transform
"RTN","GMTSULT5",74,0)
 N %,%A,%B,%B1,%B2,%B3,%BA,%C,%E,%G,%H,%I,%J,%N,%P,%S,%T,%W,%X,%Y,%BU,%J1,%A0,%W0,%D1,%D2,%DT,%K,%M
"RTN","GMTSULT5",75,0)
 N GMTSINPT,GMTSI,GMTST S (GMTST,X)=$G(X) I $L(X)=1,X'=" " Q 0
"RTN","GMTSULT5",76,0)
 I X=" "&($G(GMTSDIC0)'["F") D
"RTN","GMTSULT5",77,0)
 . D GDISV S:+($G(GMTSDISV))>0 X=$P($G(^GMT(142,+($G(GMTSDISV)),0)),U,1),(Y,GMTSD)=+GMTSDISV
"RTN","GMTSULT5",78,0)
 K ^TMP("GMTSULT",$J),^TMP("GMTSULT2",$J) S GMTSINPT="" D LIST^GMTSULT2(X) S X=$S($D(^TMP("GMTSULT",$J,0)):1,1:0)
"RTN","GMTSULT5",79,0)
 I +X=0,$L($G(GMTST))>2,$L($G(GMTST))<31,+($G(GMTSLGO))=142,$G(GMTSDIC0)["L" S X=1 Q X
"RTN","GMTSULT5",80,0)
 K ^TMP("GMTSULT",$J),^TMP("GMTSULT2",$J) Q X
"RTN","GMTSUP")
0^7^B46571135
"RTN","GMTSUP",1,0)
GMTSUP ; SLC/KER - Utilities for Paging HS           ; 01/06/2003
"RTN","GMTSUP",2,0)
 ;;2.7;Health Summary;**2,7,21,27,28,30,35,47,56,58**;Oct 20, 1995
"RTN","GMTSUP",3,0)
 ;
"RTN","GMTSUP",4,0)
 ; External References
"RTN","GMTSUP",5,0)
 ;   DBIA 10026  ^DIR
"RTN","GMTSUP",6,0)
 ;   DBIA    82  EN^XQORM
"RTN","GMTSUP",7,0)
 ;                       
"RTN","GMTSUP",8,0)
CKP ; Check page position, pause and prompt
"RTN","GMTSUP",9,0)
 Q:$D(GMTSQIT)  S GMTSNPG=0
"RTN","GMTSUP",10,0)
 K:$L($G(GMTSOBJ("LABEL"))) GMTSOBJ("REPORT HEADER")
"RTN","GMTSUP",11,0)
 I $G(GMTSWRIT)=1 D BREAK S GMTSWRIT=0
"RTN","GMTSUP",12,0)
 I +($$HF^GMTSU) D BREAK:(GMTSEGN'=$G(GMTSLCMP)) Q
"RTN","GMTSUP",13,0)
 Q:+$G(GMTSLPG)'>0&($Y'>(IOSL-GMTSLO))
"RTN","GMTSUP",14,0)
 I $E(IOST,1)="C" S:'$D(GMTSTOF) GMTSTOF=1 D CKP1
"RTN","GMTSUP",15,0)
 I '$D(GMTSQIT) W @IOF D HEADER,BREAK S GMTSNPG=1,GMTSTOF=GMTSEGN
"RTN","GMTSUP",16,0)
 I $D(GMTSQIT),(GMTSQIT]""),($D(GMTSTYP)) W @IOF D HEADER S GMTSTOF=GMTSEGN
"RTN","GMTSUP",17,0)
 Q
"RTN","GMTSUP",18,0)
CKP1 ; Help Display of Optional Components for Navigation
"RTN","GMTSUP",19,0)
 N DA,I,J,K,L,X,XQORM,Y,GMTSY,TYP,DIC
"RTN","GMTSUP",20,0)
 I $S('$D(GMTSTYP):1,$D(GMTOPT):1,1:0) N DIR S DIR(0)="E" D ^DIR K DIR S:$D(DUOUT)!(GMTSLPG) GMTSQIT="" Q
"RTN","GMTSUP",21,0)
 S TYP=GMTSTYP
"RTN","GMTSUP",22,0)
 S DIC=142,DIC(0)="MZF",X="GMTS HS ADHOC OPTION" S Y=$$TYPE^GMTSULT
"RTN","GMTSUP",23,0)
 S GMTSTYP=+Y K DIC,X,Y
"RTN","GMTSUP",24,0)
 S XQORM=GMTSTYP_";GMT(142,",XQORM(0)="1AF\+",XQORM("A")="Press <RET> to continue, ^ to exit, or select component: "
"RTN","GMTSUP",25,0)
 S XQORM("??")="D HELP^GMTSUP1" I GMTSLPG,'$D(GMTSOBJ) W:'$D(GMTSOBJE) "* END * "
"RTN","GMTSUP",26,0)
 S XQORM("S")="I $D(^GMT(142,DA(1),1,DA,0)),($P(^GMT(142.1,$P(^GMT(142,DA(1),1,DA,0),U,2),0),U,6)'=""T"")"
"RTN","GMTSUP",27,0)
 D EN^XQORM W ! D @$S(Y=1:"BRNCH",1:"EVAL")
"RTN","GMTSUP",28,0)
 I $D(GMTSY),(GMTSY=0) K GMTSY G CKP1
"RTN","GMTSUP",29,0)
 S GMTSTYP=TYP
"RTN","GMTSUP",30,0)
 Q
"RTN","GMTSUP",31,0)
BREAK ; Writes the Component Header
"RTN","GMTSUP",32,0)
 ;           
"RTN","GMTSUP",33,0)
 ;   If the variable GMTSOBJ exist, then the 
"RTN","GMTSUP",34,0)
 ;   Component Headers are suppressed with the
"RTN","GMTSUP",35,0)
 ;   following exceptions:
"RTN","GMTSUP",36,0)
 ;           
"RTN","GMTSUP",37,0)
 ;       If GMTSOBJ("COMPONENT HEADER") exist,
"RTN","GMTSUP",38,0)
 ;       then the Component Header will NOT be
"RTN","GMTSUP",39,0)
 ;       suppressed
"RTN","GMTSUP",40,0)
 ;           
"RTN","GMTSUP",41,0)
 ;       If GMTSOBJ("BLANK LINE") exist, a blank
"RTN","GMTSUP",42,0)
 ;       line will be written after the Component
"RTN","GMTSUP",43,0)
 ;       Header
"RTN","GMTSUP",44,0)
 ;              
"RTN","GMTSUP",45,0)
 N GMTSM,GMTSF S GMTSM=$$MUL,GMTSF=$$FST
"RTN","GMTSUP",46,0)
 I +GMTSM=0,$D(GMTSOBJ),'$D(GMTSOBJ("COMPONENT HEADER")),'$D(GMTSOBJ("BLANK LINE")) Q
"RTN","GMTSUP",47,0)
 N GMTS,GMTSUL,GMTSL S:'$D(GMTSLCMP) GMTSLCMP=0
"RTN","GMTSUP",48,0)
 S GMTSUL="",GMTSNPG=1,GMTS=$$CHDR,GMTSL=+($L($G(GMTS))),$P(GMTSUL,"-",+GMTSL)="-"
"RTN","GMTSUP",49,0)
 I $Y'>(IOSL-GMTSLO)!(+($$HF^GMTSU)) D
"RTN","GMTSUP",50,0)
 . I $D(GMTSOBJ) D  Q
"RTN","GMTSUP",51,0)
 . . S GMTSLCMP=GMTSEGN
"RTN","GMTSUP",52,0)
 . . I +($G(GMTSM))>0!($D(GMTSOBJ("COMPONENT HEADER"))) D
"RTN","GMTSUP",53,0)
 . . . W:+GMTSF=0 ! W !,GMTS W:$D(GMTSOBJ("UNDERLINE")) !,GMTSUL
"RTN","GMTSUP",54,0)
 . . . W ! W:$D(GMTSOBJ("BLANK LINE")) !
"RTN","GMTSUP",55,0)
 . W !,GMTS,!
"RTN","GMTSUP",56,0)
 . W:$Y'>(IOSL-GMTSLO) ?34,$S(GMTSEGN=GMTSLCMP:"(continued)",1:""),!
"RTN","GMTSUP",57,0)
 . S GMTSLCMP=GMTSEGN
"RTN","GMTSUP",58,0)
 Q
"RTN","GMTSUP",59,0)
OLDB ;
"RTN","GMTSUP",60,0)
 S:'$D(GMTSLCMP) GMTSLCMP=0
"RTN","GMTSUP",61,0)
 S GMTS="",GMTSNPG=1
"RTN","GMTSUP",62,0)
 S $P(GMTS,"-",79-$L(GMTSEGH_GMTSEGL)/2)=""
"RTN","GMTSUP",63,0)
 S GMTS=GMTS_" "_GMTSEGH_GMTSEGL_" "_GMTS
"RTN","GMTSUP",64,0)
 I $Y'>(IOSL-GMTSLO)!(+($$HF^GMTSU)) D
"RTN","GMTSUP",65,0)
 . W !,GMTS,!
"RTN","GMTSUP",66,0)
 . W:$Y'>(IOSL-GMTSLO) ?34,$S(GMTSEGN=GMTSLCMP:"(continued)",1:""),!
"RTN","GMTSUP",67,0)
 . S GMTSLCMP=GMTSEGN
"RTN","GMTSUP",68,0)
        Q
"RTN","GMTSUP",69,0)
HEADER ; Print Running Header
"RTN","GMTSUP",70,0)
 ;           
"RTN","GMTSUP",71,0)
 ;   If the variable GMTSOBJ exist, then the 
"RTN","GMTSUP",72,0)
 ;   Report Headers are suppressed with the 
"RTN","GMTSUP",73,0)
 ;   following exceptions:
"RTN","GMTSUP",74,0)
 ;           
"RTN","GMTSUP",75,0)
 ;       If GMTSOBJ("DATE LINE") exist, then the
"RTN","GMTSUP",76,0)
 ;       Location/Report Date line will NOT be
"RTN","GMTSUP",77,0)
 ;       suppressed.
"RTN","GMTSUP",78,0)
 ;           
"RTN","GMTSUP",79,0)
 ;       If GMTSOBJ("CONFIDENTIAL") exist, then
"RTN","GMTSUP",80,0)
 ;       the Confidential Header Name line will
"RTN","GMTSUP",81,0)
 ;       NOT be suppressed.
"RTN","GMTSUP",82,0)
 ;           
"RTN","GMTSUP",83,0)
 ;       If GMTSOBJ("REPORT HEADER") exist, then
"RTN","GMTSUP",84,0)
 ;       the Report Header containing the patient's
"RTN","GMTSUP",85,0)
 ;       name, SSAN, ward and DOB will NOT be
"RTN","GMTSUP",86,0)
 ;       suppressed.
"RTN","GMTSUP",87,0)
 ;              
"RTN","GMTSUP",88,0)
 ;       If the variable GMTSOBJ("LABEL") contains
"RTN","GMTSUP",89,0)
 ;       text, and the variable GMTSOBJ("USE LABEL")
"RTN","GMTSUP",90,0)
 ;       exist, then this text will be printed before
"RTN","GMTSUP",91,0)
 ;       the object text.
"RTN","GMTSUP",92,0)
 ;                 
"RTN","GMTSUP",93,0)
 ;       If GMTSOBJ("REPORT DECEASED") exist, then
"RTN","GMTSUP",94,0)
 ;       the optional line that displays for Deceased
"RTN","GMTSUP",95,0)
 ;       patients will NOT be suppressed.
"RTN","GMTSUP",96,0)
 ;                 
"RTN","GMTSUP",97,0)
 ;   Header Lines:
"RTN","GMTSUP",98,0)
 N GMTSVDT,DATA S DATA="" I +$G(GMTSPXD1)&+$G(GMTSPXD2) D
"RTN","GMTSUP",99,0)
 . Q:$G(GMTSOBJ)  S:'$D(GMTSOBJE) DATA="Printed for data "  S:$D(GMTSOBJE) DATA="Include data "
"RTN","GMTSUP",100,0)
 . I GMTSPXD1=GMTSPXD2 S DATA=DATA_"on "_GMTSPXD1 Q
"RTN","GMTSUP",101,0)
 . S DATA=DATA_"from "_GMTSPXD2_" to "_GMTSPXD1
"RTN","GMTSUP",102,0)
 I $D(GMTSCDT(0)),'$D(GMTSOBJ) S GMTSVDT=GMTSCDT(0) S:GMTSDTM'["Printed:" GMTSDTM="Printed: "_GMTSDTM
"RTN","GMTSUP",103,0)
 ;     Location and Date of Report
"RTN","GMTSUP",104,0)
 I '$D(GMTSOBJ)!($D(GMTSOBJ("DATE LINE"))) D
"RTN","GMTSUP",105,0)
 . N GMTSLOC S GMTSLOC=$S('$D(GMTSOBJ("DATE LINE")):$P($G(GMTSSC),U,2),1:"")
"RTN","GMTSUP",106,0)
 . W !,$S($L(GMTSLOC):"Location: "_GMTSLOC_" ",1:"")
"RTN","GMTSUP",107,0)
 . W $S($D(GMTSVDT):GMTSVDT,1:"")
"RTN","GMTSUP",108,0)
 . W:'$D(GMTSOBJ("DATE LINE")) DATA,?(79-$L(GMTSDTM)),GMTSDTM
"RTN","GMTSUP",109,0)
 . W:$D(GMTSOBJ("DATE LINE")) DATA,?(74-$L(GMTSDTM)),GMTSDTM
"RTN","GMTSUP",110,0)
 ;     Confidential Header Name
"RTN","GMTSUP",111,0)
 S:'$D(GMTSPG) GMTSPG=0
"RTN","GMTSUP",112,0)
 S GMTSPG=GMTSPG+1,GMTSHDR=" CONFIDENTIAL "_GMTSTITL_" SUMMARY "
"RTN","GMTSUP",113,0)
 S GMTSHDR=GMTSHDR_$S($E(IOST,1)="C":"",1:"  pg. "_GMTSPG)
"RTN","GMTSUP",114,0)
 S GMTS="" S:'$D(GMTSOBJ) $P(GMTS,"*",(77-$L(GMTSHDR))\2)="*"
"RTN","GMTSUP",115,0)
 S:$D(GMTSOBJ) $P(GMTS,"*",(72-$L(GMTSHDR))\2)="*"
"RTN","GMTSUP",116,0)
 S GMTSHDR=GMTS_" "_GMTSHDR_" "_GMTS
"RTN","GMTSUP",117,0)
 I '$D(GMTSOBJ)!($D(GMTSOBJ("CONFIDENTIAL"))) W !,GMTSHDR,"*"
"RTN","GMTSUP",118,0)
 ;     Name, SSAN, Ward, DOB
"RTN","GMTSUP",119,0)
 I '$D(GMTSLFG) D
"RTN","GMTSUP",120,0)
 . I $G(GMTSPHDR("TWO")) D
"RTN","GMTSUP",121,0)
 . . I $D(GMTSOBJ),'$D(GMTSOBJ("REPORT HEADER")),$L($G(GMTSOBJ("LABEL"))) D LABEL
"RTN","GMTSUP",122,0)
 . . I $D(GMTSOBJ),'$D(GMTSOBJ("REPORT HEADER")) Q
"RTN","GMTSUP",123,0)
 . . W !,GMTSPHDR("NMSSN"),?GMTSPHDR("DOBS"),GMTSPHDR("DOB")
"RTN","GMTSUP",124,0)
 . . W !,?GMTSPHDR("WARDRBS"),GMTSPHDR("WARDRB")
"RTN","GMTSUP",125,0)
 . E  D
"RTN","GMTSUP",126,0)
 . . I $D(GMTSOBJ),'$D(GMTSOBJ("REPORT HEADER")),$L($G(GMTSOBJ("LABEL"))) D LABEL
"RTN","GMTSUP",127,0)
 . . I $D(GMTSOBJ),'$D(GMTSOBJ("REPORT HEADER")) Q
"RTN","GMTSUP",128,0)
 . . W !,GMTSPHDR("NMSSN"),?GMTSPHDR("WARDRBS")
"RTN","GMTSUP",129,0)
 . . W GMTSPHDR("WARDRB"),?GMTSPHDR("DOBS"),GMTSPHDR("DOB")
"RTN","GMTSUP",130,0)
 ;     Deceased
"RTN","GMTSUP",131,0)
 ;                    
"RTN","GMTSUP",132,0)
 I '$D(GMTSOBJ)!($D(GMTSOBJ("DECEASED"))) D
"RTN","GMTSUP",133,0)
 . W:+$G(VADM(6)) !,?26,"** DECEASED   "_$P(VADM(6),U,2)_" **"
"RTN","GMTSUP",134,0)
 W:'$D(GMTSOBJ) !
"RTN","GMTSUP",135,0)
 Q
"RTN","GMTSUP",136,0)
BRNCH ; Checks abbreviation to branch to a different component
"RTN","GMTSUP",137,0)
 N GMTINX,LIM,CREC,SBS
"RTN","GMTSUP",138,0)
 I Y,("+-"[X) S:X="-" GMTSEGN=GMTSTOF-1 S (GMTSY,GMTSQIT)=1,GMTSLPG=0 Q
"RTN","GMTSUP",139,0)
 I X="^^" S DIROUT=1,GMTSQIT="" Q
"RTN","GMTSUP",140,0)
 I Y,(X?1"^^".E) Q
"RTN","GMTSUP",141,0)
 S GMTINX=$S($D(^GMT(142,GMTSTYP,1,+Y(1),0)):$P(^(0),U,2),1:"")
"RTN","GMTSUP",142,0)
 I 'GMTINX S GMTSY=0 Q
"RTN","GMTSUP",143,0)
 I '$D(GMTSEGI(GMTINX)) N GMI,GMJ,GMTSDFLT S GMI=1,GMJ=GMTSEGC,GMTSDFLT=1 D LOAD^GMTSADH S GMTSEGC=GMTSEGC+1
"RTN","GMTSUP",144,0)
 I '$D(GMTSEGI(GMTINX)) S GMTINX="",GMTSY=0 Q
"RTN","GMTSUP",145,0)
 S LIM=$P(Y(1),U,4) I LIM'["=" G NOLIM
"RTN","GMTSUP",146,0)
 S CREC=^GMT(142.1,GMTINX,0),SBS=GMTSEGI(GMTINX) D CMPLIM^GMTSADH2
"RTN","GMTSUP",147,0)
 I $D(DIROUT) S GMTSQIT="" Q
"RTN","GMTSUP",148,0)
NOLIM ; No limits
"RTN","GMTSUP",149,0)
 S GMTSEGN=GMTSEGI(GMTINX)-1,(GMTSY,GMTSQIT)=1,GMTSLPG=0
"RTN","GMTSUP",150,0)
 Q
"RTN","GMTSUP",151,0)
 ;
"RTN","GMTSUP",152,0)
EVAL ; Evaluate input to determine quit or continue
"RTN","GMTSUP",153,0)
 Q:'$D(X)
"RTN","GMTSUP",154,0)
 S:$D(GMTSEXIT) GMTSEXIT=$G(X)
"RTN","GMTSUP",155,0)
 S:$D(DTOUT) DIROUT=1 I $S(X="^^":1,GMTSLPG:1,$D(DIROUT):1,X="^":1,1:0) S GMTSQIT=""
"RTN","GMTSUP",156,0)
 I +$G(GMPSAP),(X="^") S GMDUOUT=1
"RTN","GMTSUP",157,0)
 Q
"RTN","GMTSUP",158,0)
MUL(X) ; Multiple Components in Type
"RTN","GMTSUP",159,0)
 N GMTSF,GMTSL S GMTSF=$O(GMTSEG(0)),GMTSL=$O(GMTSEG(" "),-1)
"RTN","GMTSUP",160,0)
 Q:+GMTSF=+GMTSL 0  Q 1
"RTN","GMTSUP",161,0)
FST(X) ; First Component in Type
"RTN","GMTSUP",162,0)
 N GMTSF,GMTSL S GMTSF=$O(GMTSEG(0)),GMTSL=+($G(GMTSEGN))
"RTN","GMTSUP",163,0)
 Q:+GMTSF=+GMTSL 1  Q 0
"RTN","GMTSUP",164,0)
CHDR(X) ; Component Header
"RTN","GMTSUP",165,0)
 N GMTSN,GMTSH,GMTSL,GMTS S GMTSN=$$CNAM,GMTSH=$G(GMTSEGH)
"RTN","GMTSUP",166,0)
 S GMTSL=$G(GMTSEGL),GMTS="",$P(GMTS,"-",79-$L(GMTSH_GMTSL)/2)=""
"RTN","GMTSUP",167,0)
 S X=GMTS_" "_GMTSH_GMTSL_" "_GMTS Q:'$D(GMTSOBJ) X
"RTN","GMTSUP",168,0)
 S:$L(GMTSH)&($D(GMTSOBJ("COMPONENT HEADER"))) GMTSN=GMTSH
"RTN","GMTSUP",169,0)
 S:$L(GMTSL)&($L(GMTSN))&($D(GMTSOBJ("LIMITS"))) GMTSN=GMTSN_" "_GMTSL
"RTN","GMTSUP",170,0)
 S X=GMTSN Q X
"RTN","GMTSUP",171,0)
CNAM(X) ; Component Name
"RTN","GMTSUP",172,0)
 N GMTSH S GMTSH=+($P($G(GMTSEG(+($G(GMTSEGN)))),"^",2))
"RTN","GMTSUP",173,0)
 S X=$P($G(^GMT(142.1,+GMTSH,0)),"^",1) Q X
"RTN","GMTSUP",174,0)
LABEL ; Label
"RTN","GMTSUP",175,0)
 Q:'$D(GMTSOBJ("USE LABEL"))  N LABEL S LABEL=$G(GMTSOBJ("LABEL"))
"RTN","GMTSUP",176,0)
 W !,LABEL W:$L(LABEL) ! W:$D(GMTSOBJ("LABEL BLANK LINE")) !
"RTN","GMTSUP",177,0)
 Q
"RTN","GMTSUP",178,0)
LABDAT ; Label/Date
"RTN","GMTSUP",179,0)
 Q:'$D(GMTSOBJ("USE LABEL"))  N LABEL S LABEL=$G(GMTSOBJ("LABEL"))
"RTN","GMTSUP",180,0)
 I '$D(GMTSOBJ("DATE LINE")),$D(GMTSOBJ("LABEL")),$L(LABEL),$L($G(GMTSDTM)) S LABEL=LABEL_$J("",((79-$L(GMTSDTM))-$L(LABEL)))_GMTSDTM
"RTN","GMTSUP",181,0)
 I '$D(GMTSOBJ("DATE LINE")),$D(GMTSOBJ("LABEL")),'$L(LABEL),$L($G(GMTSDTM)) S LABEL="Information as of "_$G(GMTSDTM)
"RTN","GMTSUP",182,0)
 W !,LABEL W:$L(LABEL) ! W:$D(GMTSOBJ("LABEL BLANK LINE")) !
"RTN","GMTSUP",183,0)
 Q
"RTN","GMTSVSD")
0^16^B57231397
"RTN","GMTSVSD",1,0)
GMTSVSD ; SLC/KER - Vital Signs (Detailed)           ; 01/06/2003
"RTN","GMTSVSD",2,0)
 ;;2.7;Health Summary;**35,49,58**;Oct 20, 1995
"RTN","GMTSVSD",3,0)
 ;                          
"RTN","GMTSVSD",4,0)
 ; External References
"RTN","GMTSVSD",5,0)
 ;   DBIA  1446  EN1^GMRVUT0
"RTN","GMTSVSD",6,0)
 ;   DBIA 10141  $$VERSION^XPDUTL
"RTN","GMTSVSD",7,0)
 ;   DBIA 10103  $$NOW^XLFDT
"RTN","GMTSVSD",8,0)
 ;                    
"RTN","GMTSVSD",9,0)
 ; Health Summary patch GMTS*2.7*35 will require 
"RTN","GMTSVSD",10,0)
 ; Vitals version 4.0, patch GMRV*4.0*7
"RTN","GMTSVSD",11,0)
 ;                     
"RTN","GMTSVSD",12,0)
 Q
"RTN","GMTSVSD",13,0)
EN ; Detailed Vital Signs main control
"RTN","GMTSVSD",14,0)
 N GMRVSTR,GMTSC1,GMTSC2,GMTSC3,GMTSC4,GMTSCNT,GMTSCD,GMTSCHR,GMTSCI
"RTN","GMTSVSD",15,0)
 N GMTSCW1,GMTSCW2,GMTSCW3,GMTSCW4,GMTSCW5,GMTSLN,GMTSMEAS,GMTSMAX
"RTN","GMTSVSD",16,0)
 N GMTSN,GMTSOK,GMTSP,GMTSPSN,GMTSQ,GMTSREM,GMTSROV,GMTST,GMTSTO,GMTSV
"RTN","GMTSVSD",17,0)
 N GMTSVCT,GMTSVD,GMTSVI,GMTSVSD,GMTSVSDT,GMTSVT,X,Y,GMTSLM,GMTSLML
"RTN","GMTSVSD",18,0)
 S GMTSLM=0 S:$D(VALM("BM"))&($G(VALM("LINES"))>0) GMTSLM=1
"RTN","GMTSVSD",19,0)
 S GMTSLML=9999999009 S:GMTSLM GMTSLML=+($G(VALM("LINES")))
"RTN","GMTSVSD",20,0)
 S GMTSLO=+($G(GMTSLO)) S:GMTSLO=0 GMTSLO=3 S GMTSLPG=+($G(GMTSLPG)),GMTSDTM=$G(GMTSDTM) S:'$L(GMTSDTM) GMTSDTM=$$DTM
"RTN","GMTSVSD",21,0)
 S:'$D(GMTSTITL)!('$L($G(GMTSTITL))) GMTSTITL="VITALS DETAILED DISPLAY" K ^TMP("GMTSVSD",$J),^UTILITY($J,"GMRVD")
"RTN","GMTSVSD",22,0)
 S (GMTSVCT,GMTSMAX)=$S(+($G(GMTSNDM))>0:+($G(GMTSNDM)),1:1)
"RTN","GMTSVSD",23,0)
 S GMRVSTR("LT")="^C^"
"RTN","GMTSVSD",24,0)
 D GET D:$D(^UTILITY($J,"GMRVD")) ST K GMRVSTR("LT")
"RTN","GMTSVSD",25,0)
 D GET D:$D(^UTILITY($J,"GMRVD")) ST K ^UTILITY($J,"GMRVD")
"RTN","GMTSVSD",26,0)
 S GMTSCW1=0,GMTSCW2=18,GMTSCW3=36,GMTSCW4=53,GMTSCW5=+($G(IOM))-2
"RTN","GMTSVSD",27,0)
 S:GMTSCW5'>49 GMTSCW5=78
"RTN","GMTSVSD",28,0)
 I '$D(^TMP("GMTSVSD",$J)) Q
"RTN","GMTSVSD",29,0)
 D REM,OUT
"RTN","GMTSVSD",30,0)
 Q
"RTN","GMTSVSD",31,0)
 ;                
"RTN","GMTSVSD",32,0)
GET ; Get Data
"RTN","GMTSVSD",33,0)
 K ^UTILITY($J,"GMRVD") N GMTSMAX
"RTN","GMTSVSD",34,0)
 S GMTSMAX=$S(+($G(GMTSVCT))>0:+($G(GMTSVCT)),1:1) S GMTSMAX=GMTSMAX*100
"RTN","GMTSVSD",35,0)
 S GMRVSTR="T"_";"_"P"_";"_"R"_";"_"BP"_";"_"HT"_";"_"WT"_";"_"CVP"_";"_"PO2"_";"_"CG"_";"_"PN"
"RTN","GMTSVSD",36,0)
 S GMRVSTR(0)=$G(GMTSBEG)_"^"_$G(GMTSEND)_"^"_$G(GMTSMAX)_"^"_1
"RTN","GMTSVSD",37,0)
 D EN1^GMRVUT0 S GMTSMAX=+($G(GMTSVCT))
"RTN","GMTSVSD",38,0)
 Q
"RTN","GMTSVSD",39,0)
NOD ;   No Data Found
"RTN","GMTSVSD",40,0)
 D CKP^GMTSUP Q:$D(GMTSQIT)  D:GMTSNPG=1 HDR
"RTN","GMTSVSD",41,0)
 W "*** No vital measurements ***",! S GMTSMAX=1 Q
"RTN","GMTSVSD",42,0)
REM ;   Remove Excess Data
"RTN","GMTSVSD",43,0)
 N GMTSMAX S GMTSMAX=$S(+($G(GMTSNDM))>0:+($G(GMTSNDM)),1:1)
"RTN","GMTSVSD",44,0)
 N GMTSVD,GMTSVT,GMTSVI,GMTST
"RTN","GMTSVSD",45,0)
 S GMTSVD=0 F  S GMTSVD=$O(^TMP("GMTSVSD",$J,GMTSVD)) Q:+GMTSVD=0  D
"RTN","GMTSVSD",46,0)
 . S GMTSVT="" F  S GMTSVT=$O(^TMP("GMTSVSD",$J,GMTSVD,GMTSVT)) Q:GMTSVT=""  D
"RTN","GMTSVSD",47,0)
 . . S GMTSVI=0 F  S GMTSVI=$O(^TMP("GMTSVSD",$J,GMTSVD,GMTSVT,GMTSVI)) Q:+GMTSVI=0  D
"RTN","GMTSVSD",48,0)
 . . . I +($G(GMTST(GMTSVT)))>(GMTSMAX-1) K ^TMP("GMTSVSD",$J,GMTSVD,GMTSVT,GMTSVI) Q
"RTN","GMTSVSD",49,0)
 . . . S GMTST(GMTSVT)=+($G(GMTST(GMTSVT)))+1
"RTN","GMTSVSD",50,0)
 Q
"RTN","GMTSVSD",51,0)
 ;                
"RTN","GMTSVSD",52,0)
OUT ; Output Data
"RTN","GMTSVSD",53,0)
 D HDR Q:$D(GMTSQIT)  N GMTSVD,GMTSVT,GMTSVSDT,GMTSVSD,GMTSVI,GMTSCNT S GMTSCNT=0
"RTN","GMTSVSD",54,0)
 S GMTSVD=0 F  S GMTSVD=$O(^TMP("GMTSVSD",$J,GMTSVD)) Q:GMTSVD<1!(GMTSVD="")  D
"RTN","GMTSVSD",55,0)
 . S GMTSVT="" F  S GMTSVT=$O(^TMP("GMTSVSD",$J,GMTSVD,GMTSVT)) Q:GMTSVT=""  D
"RTN","GMTSVSD",56,0)
 . . S GMTSVI=0 F  S GMTSVI=$O(^TMP("GMTSVSD",$J,GMTSVD,GMTSVT,GMTSVI)) Q:+GMTSVI=0  D
"RTN","GMTSVSD",57,0)
 . . . S GMTSVSD=$G(^TMP("GMTSVSD",$J,GMTSVD,GMTSVT,GMTSVI)) Q:'$L(GMTSVSD)  S GMTSVSDT=$P(GMTSVSD,"^",1) Q:'$L(GMTSVSDT)  Q:+GMTSVSDT'>0  D ADD
"RTN","GMTSVSD",58,0)
 . I +($O(^TMP("GMTSVSD",$J,GMTSVD)))'=GMTSVD D WRL
"RTN","GMTSVSD",59,0)
 I GMTSCNT=0 D CKP^GMTSUP Q:$D(GMTSQIT)  D:GMTSNPG=1 HDR W "No data",!
"RTN","GMTSVSD",60,0)
 Q
"RTN","GMTSVSD",61,0)
ADD ;   Add to Output Array
"RTN","GMTSVSD",62,0)
 N GMTST,GMTSTO,GMTSV,GMTSQ S GMTST=$G(GMTSVT) Q:'$L(GMTST)
"RTN","GMTSVSD",63,0)
 S GMTSTO=$$VO(GMTST) Q:GMTSTO'>0  S GMTST=$$VT(GMTST) Q:'$L(GMTST)
"RTN","GMTSVSD",64,0)
 S GMTSV=$$VM(GMTSVT,GMTSVSD)
"RTN","GMTSVSD",65,0)
 S GMTSQ=$$VQ(GMTSVSD),GMTSROV(GMTSTO)=GMTST_"^"_GMTSV_"^"_GMTSQ,GMTSCNT=+($G(GMTSCNT))+1,GMTSROV("DT")=$$EDT^GMTSU(GMTSVSDT)
"RTN","GMTSVSD",66,0)
 Q
"RTN","GMTSVSD",67,0)
WRL ;   Write Line from Array
"RTN","GMTSVSD",68,0)
 N GMTSCI,GMTSCD,GMTSC1,GMTSC2,GMTSC3,GMTSC4
"RTN","GMTSVSD",69,0)
 S (GMTSCD,GMTSC1)=$G(GMTSROV("DT")) I '$L(GMTSC1) K GMTSROV Q
"RTN","GMTSVSD",70,0)
 S GMTSCI=0 F  S GMTSCI=$O(GMTSROV(GMTSCI)) Q:+GMTSCI=0  Q:$D(GMTSQIT)  D  Q:$D(GMTSQIT)
"RTN","GMTSVSD",71,0)
 . S GMTSC2=$G(GMTSROV(GMTSCI)),GMTSC3=$P(GMTSC2,"^",2),GMTSC4=$P(GMTSC2,"^",3),GMTSC2=$P(GMTSC2,"^",1)
"RTN","GMTSVSD",72,0)
 . D CKP^GMTSUP Q:$D(GMTSQIT)
"RTN","GMTSVSD",73,0)
 . I +($G(GMTSLM))>0 S:+($$LMP)>0 GMTSC1=GMTSCD
"RTN","GMTSVSD",74,0)
 . I GMTSNPG'=1 W GMTSC1,?GMTSCW2,GMTSC2,?GMTSCW3,GMTSC3 D QUAL
"RTN","GMTSVSD",75,0)
 . I GMTSNPG=1 S GMTSC1=GMTSCD D HDR W GMTSC1,?GMTSCW2,GMTSC2,?GMTSCW3,GMTSC3 D QUAL
"RTN","GMTSVSD",76,0)
 . S GMTSC1="   ""        ""  "
"RTN","GMTSVSD",77,0)
 . Q:$D(GMTSQIT)
"RTN","GMTSVSD",78,0)
 K GMTSROV
"RTN","GMTSVSD",79,0)
 Q
"RTN","GMTSVSD",80,0)
LMP(X) ;
"RTN","GMTSVSD",81,0)
 Q:+($G(GMTSLML))'>0 0
"RTN","GMTSVSD",82,0)
 N GMTSP,GMTSD S GMTSP=$Y,GMTSD=0 S:GMTSP#GMTSLML=0 GMTSD=1 S X=GMTSD Q X
"RTN","GMTSVSD",83,0)
QUAL ;   Write Vital Qualifiers
"RTN","GMTSVSD",84,0)
 N GMTSOK,GMTSLN,GMTSTO,GMTSREM,GMTSPSN,GMTSCHR S GMTSLN=GMTSCW5-GMTSCW4
"RTN","GMTSVSD",85,0)
 I $L(GMTSC4)'>(GMTSLN-1) D CKP^GMTSUP Q:$D(GMTSQIT)  D:GMTSNPG=1 HDR W ?GMTSCW4,GMTSC4,! Q
"RTN","GMTSVSD",86,0)
 S GMTSREM=GMTSC4 F  Q:$D(GMTSQIT)  D QPARSE Q:$D(GMTSQIT)  Q:'$L(GMTSREM)
"RTN","GMTSVSD",87,0)
 Q
"RTN","GMTSVSD",88,0)
QPARSE ;     Parse Qualifier (wrap)
"RTN","GMTSVSD",89,0)
 I $L(GMTSREM)'>(GMTSLN-1) D CKP^GMTSUP Q:$D(GMTSQIT)  D:GMTSNPG=1 HDR W ?GMTSCW4,GMTSREM,! S GMTSREM="" Q
"RTN","GMTSVSD",90,0)
 S GMTSOK=0 F GMTSPSN=GMTSLN:-1:0 Q:+GMTSOK=1  D  Q:+GMTSOK=1
"RTN","GMTSVSD",91,0)
 . I $E(GMTSREM,GMTSPSN)=" " S GMTSCHR=" ",GMTSOK=1 Q
"RTN","GMTSVSD",92,0)
 . I $E(GMTSREM,GMTSPSN)="," S GMTSCHR=",",GMTSOK=1 Q
"RTN","GMTSVSD",93,0)
 . I $E(GMTSREM,GMTSPSN)="/"!($E(GMTSREM,GMTSPSN)="-")!($E(GMTSREM,GMTSPSN)=")") S GMTSCHR=$E(GMTSREM,GMTSPSN),GMTSOK=1 Q
"RTN","GMTSVSD",94,0)
 I GMTSCHR=" " D  Q:$D(GMTSQIT)
"RTN","GMTSVSD",95,0)
 . S GMTSTO=$E(GMTSREM,1,(GMTSPSN-1)),GMTSREM=$E(GMTSREM,(GMTSPSN+1),$L(GMTSREM)),GMTSREM=$$TRIM(GMTSREM) D CKP^GMTSUP Q:$D(GMTSQIT)  D:GMTSNPG=1 HDR W ?GMTSCW4,$G(GMTSTO),!
"RTN","GMTSVSD",96,0)
 I GMTSCHR="/"!(GMTSCHR=",")!(GMTSCHR="-")!(GMTSCHR=")") D  Q:$D(GMTSQIT)
"RTN","GMTSVSD",97,0)
 . S GMTSTO=$E(GMTSREM,1,(GMTSPSN)),GMTSREM=$E(GMTSREM,(GMTSPSN+1),$L(GMTSREM)),GMTSREM=$$TRIM(GMTSREM) D CKP^GMTSUP Q:$D(GMTSQIT)  D:GMTSNPG=1 HDR W ?GMTSCW4,$G(GMTSTO),!
"RTN","GMTSVSD",98,0)
 Q
"RTN","GMTSVSD",99,0)
 ;                
"RTN","GMTSVSD",100,0)
 ; Miscellaneous
"RTN","GMTSVSD",101,0)
FM(X) ;   Format Vitals Measurement
"RTN","GMTSVSD",102,0)
 S X=$$TRIM($G(X)) Q:+X'=X X
"RTN","GMTSVSD",103,0)
 S:X["." X=$FN(X,"",2) Q X
"RTN","GMTSVSD",104,0)
TRIM(X) ;   Trim Blank Spaces
"RTN","GMTSVSD",105,0)
 F  Q:$E(X,1)'=" "  S X=$E(X,2,$L(X))
"RTN","GMTSVSD",106,0)
 F  Q:$E(X,$L(X))'=" "  S X=$E(X,1,($L(X)-1))
"RTN","GMTSVSD",107,0)
 Q X
"RTN","GMTSVSD",108,0)
VO(X) ;   Vital Array Order
"RTN","GMTSVSD",109,0)
 S X=$G(X) Q:X="T" 1 Q:X="P" 2 Q:X="R" 3 Q:X="BP" 4 Q:X="HT" 5 Q:X="WT" 6 Q:X="CG" 7 Q:X="PN" 8 Q:X="CVP" 9 Q:X="PO2" 10 Q ""
"RTN","GMTSVSD",110,0)
VT(X) ;   Vital Type
"RTN","GMTSVSD",111,0)
 S X=$G(X) Q:X="BP" "BP" Q:X="T" "Temp F (C)" Q:X="R" "Respir" Q:X="P" "Pulse" Q:X="HT" "Ht in (cm)"
"RTN","GMTSVSD",112,0)
 Q:X="WT" "Wt lbs (kg)[BMI]" Q:X="CVP" "CVP cm H2O(mm HG)" Q:X="PO2" "PO2 (L/Min)(%)" Q:X="CG" "C/G in (cm)" Q:X="PN" "Pain" Q ""
"RTN","GMTSVSD",113,0)
VM(X,Y) ;   Vital Type Measurement
"RTN","GMTSVSD",114,0)
 N GMTSMEAS,GMTSID S GMTSMEAS="",(GMTSID,X)=$G(X) Q:"^BP^T^R^P^HT^WT^CVP^PO2^CG^PN^"'[("^"_X_"^") ""
"RTN","GMTSVSD",115,0)
 S Y=$G(Y) Q:'$L(Y) ""
"RTN","GMTSVSD",116,0)
 ;     If data for T, Ht or Wt piece 8 and 13 else  piece 8
"RTN","GMTSVSD",117,0)
 I X="T"!(X="HT")!(X="WT") S GMTSMEAS=$P(Y,"^",8)_" ("_$P(Y,"^",13)_")"
"RTN","GMTSVSD",118,0)
 E  S GMTSMEAS=$P(Y,"^",8)
"RTN","GMTSVSD",119,0)
 ;     WT - Weight and BMI (piece 14)
"RTN","GMTSVSD",120,0)
 I X="WT",$L($P(Y,"^",14)) S GMTSMEAS=GMTSMEAS_"["_$P(Y,"^",14)_"]"
"RTN","GMTSVSD",121,0)
 ;     CVP - Central Venous Pressure/CG - Circum/Girth
"RTN","GMTSVSD",122,0)
 I X="CVP"!(X="CG") S GMTSMEAS=$P(Y,"^",8) S:$L($P(Y,"^",13)) GMTSMEAS=GMTSMEAS_" ("_$P(Y,"^",13)_")"
"RTN","GMTSVSD",123,0)
 ;     PO2 - Pulse Oximetry
"RTN","GMTSVSD",124,0)
 I X="PO2" S GMTSMEAS=$P(Y,"^",8) S:$L($P(Y,"^",15)) GMTSMEAS=GMTSMEAS_" ("_$P(Y,"^",15)_")"
"RTN","GMTSVSD",125,0)
 ;     PN - Pain
"RTN","GMTSVSD",126,0)
 S:X="PN" GMTSMEAS=$P(Y,"^",8) S:X="PN"&(GMTSMEAS=99) GMTSMEAS="No Response"
"RTN","GMTSVSD",127,0)
 S X=GMTSMEAS Q X
"RTN","GMTSVSD",128,0)
VQ(X) ;   Vital Qualifiers
"RTN","GMTSVSD",129,0)
 S X=$G(X),X=$P(X,"^",17) S:$L(X) X=$$AQ(X) Q X
"RTN","GMTSVSD",130,0)
HDR ;   Header
"RTN","GMTSVSD",131,0)
 N GMTSLN D CKP^GMTSUP Q:$D(GMTSQIT)  G:GMTSNPG=1 HDR
"RTN","GMTSVSD",132,0)
 W "Date",?GMTSCW2,"Vital",?GMTSCW3,"Measurement",?GMTSCW4,"Qualifiers"
"RTN","GMTSVSD",133,0)
 W:'$D(GMTSOBJ)!($D(GMTSOBJ)&($D(GMTSOBJ("UNDERLINE")))) !
"RTN","GMTSVSD",134,0)
 D CKP^GMTSUP Q:$D(GMTSQIT)  G:GMTSNPG=1 HDR
"RTN","GMTSVSD",135,0)
 W:'$D(GMTSOBJ)!($D(GMTSOBJ)&($D(GMTSOBJ("UNDERLINE")))) $$LN((GMTSCW2-2)) W ?GMTSCW2
"RTN","GMTSVSD",136,0)
 W:'$D(GMTSOBJ)!($D(GMTSOBJ)&($D(GMTSOBJ("UNDERLINE")))) $$LN((GMTSCW3-(GMTSCW2+2))) W ?GMTSCW3
"RTN","GMTSVSD",137,0)
 W:'$D(GMTSOBJ)!($D(GMTSOBJ)&($D(GMTSOBJ("UNDERLINE")))) $$LN((GMTSCW4-(GMTSCW3+2))) W ?GMTSCW4
"RTN","GMTSVSD",138,0)
 W:'$D(GMTSOBJ)!($D(GMTSOBJ)&($D(GMTSOBJ("UNDERLINE")))) $$LN((GMTSCW5-(GMTSCW4+2)))
"RTN","GMTSVSD",139,0)
 D CKP^GMTSUP Q:$D(GMTSQIT)  G:GMTSNPG=1 HDR W !
"RTN","GMTSVSD",140,0)
 ;
"RTN","GMTSVSD",141,0)
 S GMTSNPG=0 Q
"RTN","GMTSVSD",142,0)
ST ;   Save in ^TMP Global
"RTN","GMTSVSD",143,0)
 Q:'$D(^UTILITY($J,"GMRVD"))  M ^TMP("GMTSVSD",$J)=^UTILITY($J,"GMRVD") Q
"RTN","GMTSVSD",144,0)
AQ(X) ;   All Qualifiers Field
"RTN","GMTSVSD",145,0)
 S X=$G(X) F  Q:X'[";"  S X=$P(X,";",1)_", "_$P(X,";",2,299)
"RTN","GMTSVSD",146,0)
 S X=$$MC(X) Q X
"RTN","GMTSVSD",147,0)
MC(X) ;   Mix Case for Qualifiers
"RTN","GMTSVSD",148,0)
 N GMTSP S X=$TR($G(X),"ABCDEFGHIJKLMNOPQRSTUVWXYZ","abcdefghijklmnopqrstuvwxyz") F GMTSP=1:1:$L(X) D
"RTN","GMTSVSD",149,0)
 . S:GMTSP=1 X=$TR($E(X,GMTSP),"abcdefghijklmnopqrstuvwxyz","ABCDEFGHIJKLMNOPQRSTUVWXYZ")_$E(X,(GMTSP+1),$L(X)) Q:GMTSP=1
"RTN","GMTSVSD",150,0)
 . S:" /-,"[$E(X,(GMTSP-1)) X=$E(X,1,(GMTSP-1))_$TR($E(X,GMTSP),"abcdefghijklmnopqrstuvwxyz","ABCDEFGHIJKLMNOPQRSTUVWXYZ")_$E(X,(GMTSP+1),$L(X))
"RTN","GMTSVSD",151,0)
 Q X
"RTN","GMTSVSD",152,0)
DTM(X) ;   Current Date and Time
"RTN","GMTSVSD",153,0)
 S X=$$NOW^XLFDT D REGDTM4^GMTSU Q X
"RTN","GMTSVSD",154,0)
FN(X,Y) ;   Format Number 
"RTN","GMTSVSD",155,0)
 N GMTSV S X=$G(X),GMTSV=+($G(X)),Y=$G(Y) S:+Y=Y X=$FN(GMTSV,"",+Y) Q X
"RTN","GMTSVSD",156,0)
LN(X) ;   Dashed Line
"RTN","GMTSVSD",157,0)
 S X=+($G(X)) Q:X=0 "" N GMTSLN S GMTSLN="",$P(GMTSLN,"-",X)="-" S X=GMTSLN Q X
"RTN","GMTSVSD",158,0)
EDT(X) ; External Date and Time
"RTN","GMTSVSD",159,0)
 S X=$G(X) Q:'$L(X) ""
"RTN","GMTSVSD",160,0)
 D REGDTM4^GMTSU Q X
"RTN","GMTSXAB")
0^17^B12082142
"RTN","GMTSXAB",1,0)
GMTSXAB ; SLC/KER - List Parameters/Build List            ; 01/06/2003
"RTN","GMTSXAB",2,0)
 ;;2.7;Health Summary;**47,49,58**;Oct 20, 1995
"RTN","GMTSXAB",3,0)
 Q
"RTN","GMTSXAB",4,0)
 ;                                 
"RTN","GMTSXAB",5,0)
 ; External References
"RTN","GMTSXAB",6,0)
 ;                                 
"RTN","GMTSXAB",7,0)
 ;   None
"RTN","GMTSXAB",8,0)
 ;                                    
"RTN","GMTSXAB",9,0)
 ; This routine expects:
"RTN","GMTSXAB",10,0)
 ;                                 
"RTN","GMTSXAB",11,0)
 ;   GMTSCPL    Compile Method   1 = Append  0 = Overwrite
"RTN","GMTSXAB",12,0)
 ;   GMTSPRE    Precedence       i.e., USR;SYS;NAT
"RTN","GMTSXAB",13,0)
 ;   GMTSTYP(   List             Input Array
"RTN","GMTSXAB",14,0)
 ;   GMTSL(     List             Output Array
"RTN","GMTSXAB",15,0)
 ;                            
"RTN","GMTSXAB",16,0)
BUILD ; Build list of User/System Parameters and National Types
"RTN","GMTSXAB",17,0)
 N GMTSC,GMTSOK,GMTSI,GMTSID,GMTSE,GMTSEI,GMTSV,GMTSVI,GMTSVN,GMTSAT,GMTSOVR
"RTN","GMTSXAB",18,0)
 S GMTSOVR=$S(+($G(GMTSCPL))'>0:1,1:0),GMTSOK=0
"RTN","GMTSXAB",19,0)
 S GMTSC=+($O(GMTSL(" "),-1))
"RTN","GMTSXAB",20,0)
 F GMTSEI=1:1 Q:$P($G(GMTSPRE),";",GMTSEI)=""  S GMTSE=$P($G(GMTSPRE),";",GMTSEI) D
"RTN","GMTSXAB",21,0)
 . Q:'$L(GMTSE)  I GMTSE="NAT" D NAT Q
"RTN","GMTSXAB",22,0)
 . Q:+GMTSOK>0  S GMTSID="" D ADH,ENT
"RTN","GMTSXAB",23,0)
 Q
"RTN","GMTSXAB",24,0)
NAT ;   Add National Health Summary Types to the List
"RTN","GMTSXAB",25,0)
 Q:+($G(GMTSCPL))>1  N GMTSC,GMTSI,GMTSID,GMTSVI,GMTSVN,GMTSV
"RTN","GMTSXAB",26,0)
 S GMTSI=0,GMTSID=""
"RTN","GMTSXAB",27,0)
 S GMTSC=+($O(GMTSL(" "),-1))
"RTN","GMTSXAB",28,0)
 F  S GMTSID=$O(GMTSTYP("NAT","B",GMTSID)) Q:GMTSID=""  D
"RTN","GMTSXAB",29,0)
 . S GMTSI=0 F  S GMTSI=$O(GMTSTYP("NAT","B",GMTSID,GMTSI)) Q:+GMTSI=0  D
"RTN","GMTSXAB",30,0)
 . . S GMTSV=$$VAL($G(GMTSTYP("NAT",GMTSI)))
"RTN","GMTSXAB",31,0)
 . . Q:'$L(GMTSV)  Q:+GMTSV=0  Q:'$L($$TRIM^GMTSXA($P(GMTSV,"^",2)," "))
"RTN","GMTSXAB",32,0)
 . . Q:$D(GMTSL("B",GMTSV))
"RTN","GMTSXAB",33,0)
 . . S GMTSC=GMTSC+1
"RTN","GMTSXAB",34,0)
 . . S GMTSL(GMTSC)=GMTSV,GMTSL("B",GMTSV,GMTSC)=""
"RTN","GMTSXAB",35,0)
 . . S GMTSL("C",GMTSC)="NAT"
"RTN","GMTSXAB",36,0)
 K GMTSTYP("NAT")
"RTN","GMTSXAB",37,0)
 Q
"RTN","GMTSXAB",38,0)
ADH ;   Add Adhoc Health Summary Types to the List
"RTN","GMTSXAB",39,0)
 N GMTSC S GMTSC=+($O(GMTSL(" "),-1)) F GMTSAT="ADH","RAD" S GMTSI=0 D
"RTN","GMTSXAB",40,0)
 . F  S GMTSI=$O(GMTSTYP(GMTSE,GMTSAT,GMTSI)) Q:+GMTSI=0  D
"RTN","GMTSXAB",41,0)
 . . S GMTSV=$$VAL($G(GMTSTYP(GMTSE,GMTSAT,GMTSI))) Q:'$L(GMTSV)
"RTN","GMTSXAB",42,0)
 . . Q:+GMTSV=0  Q:'$L($$TRIM^GMTSXA($P(GMTSV,"^",2)," "))
"RTN","GMTSXAB",43,0)
 . . Q:$D(GMTSL("B",GMTSV))  S GMTSC=GMTSC+1,GMTSL(GMTSC)=GMTSV,GMTSL("B",GMTSV,GMTSC)="",GMTSL("C",GMTSC)=$G(GMTSE)
"RTN","GMTSXAB",44,0)
 Q
"RTN","GMTSXAB",45,0)
ENT ;   Add Entity Parameters (System/User) to the List
"RTN","GMTSXAB",46,0)
 N GMTSC S GMTSC=+($O(GMTSL(" "),-1)) F  S GMTSID=$O(GMTSTYP(GMTSE,"B",GMTSID)) Q:GMTSID=""  D
"RTN","GMTSXAB",47,0)
 . Q:'$L(GMTSID)  S GMTSI=0 F  S GMTSI=$O(GMTSTYP(GMTSE,"B",GMTSID,GMTSI)) Q:+GMTSI=0  D
"RTN","GMTSXAB",48,0)
 . . S GMTSV=$$VAL($G(GMTSTYP(GMTSE,GMTSI))) Q:'$L(GMTSV)  Q:+GMTSV=0
"RTN","GMTSXAB",49,0)
 . . Q:'$L($$TRIM^GMTSXA($P(GMTSV,"^",2)," "))  K:$D(GMTSL("B",GMTSV)) GMTSTYP(GMTSE,GMTSI)
"RTN","GMTSXAB",50,0)
 S GMTSI=0 F  S GMTSI=$O(GMTSTYP(GMTSE,GMTSI)) Q:+GMTSI=0  D
"RTN","GMTSXAB",51,0)
 . S GMTSV=$$VAL($G(GMTSTYP(GMTSE,GMTSI))) Q:'$L(GMTSV)
"RTN","GMTSXAB",52,0)
 . Q:+GMTSV=0  Q:'$L($$TRIM^GMTSXA($P(GMTSV,"^",2)," "))
"RTN","GMTSXAB",53,0)
 . Q:$D(GMTSL("B",GMTSV))
"RTN","GMTSXAB",54,0)
 . S GMTSC=GMTSC+1,GMTSL(GMTSC)=GMTSV,GMTSL("B",GMTSV,GMTSC)="",GMTSL("C",GMTSC)=$G(GMTSE)
"RTN","GMTSXAB",55,0)
 . S:+($G(GMTSOVR))>0 GMTSOK=1
"RTN","GMTSXAB",56,0)
 S:+($G(GMTSOVR))>0&($D(GMTSL("B"))) GMTSOK=1
"RTN","GMTSXAB",57,0)
 K GMTSTYP(GMTSE)
"RTN","GMTSXAB",58,0)
 Q
"RTN","GMTSXAB",59,0)
VAL(GMTSV) ; Value
"RTN","GMTSXAB",60,0)
 S GMTSV=$G(GMTSV) N GMTST,GMTSI,GMTSVA,GMTSN,GMTSAD,GMTSNM S GMTSI=+GMTSV Q:+GMTSI=0 GMTSV
"RTN","GMTSXAB",61,0)
 S GMTST=$G(^GMT(142,+GMTSI,"T")),GMTSNM=$P($G(^GMT(142,+GMTSI,0)),"^",1)
"RTN","GMTSXAB",62,0)
 S GMTSVA=+($G(^GMT(142,+GMTSI,"VA"))) I +GMTSVA>0,$L(GMTSNM) S GMTSV=+GMTSI_"^"_GMTSNM Q GMTSV
"RTN","GMTSXAB",63,0)
 S GMTSN=$P(GMTSV,"^",2) S:$L(GMTST) GMTSN=GMTST
"RTN","GMTSXAB",64,0)
 S GMTSV=+GMTSI_"^"_GMTSN,GMTSAD=$P($G(^GMT(142,+GMTSI,0)),"^",1)
"RTN","GMTSXAB",65,0)
 S:GMTSAD="GMTS HS ADHOC OPTION" GMTSV=+GMTSI_"^"_GMTSAD
"RTN","GMTSXAB",66,0)
 Q GMTSV
"RTN","GMTSXAB",67,0)
UP(X) Q $TR(X,"abcdefghijklmnopqrstuvwxyz","ABCDEFGHIJKLMNOPQRSTUVWXYZ")
"SEC","^DIC",142.5,142.5,0,"AUDIT")
@
"SEC","^DIC",142.5,142.5,0,"DD")
@
"SEC","^DIC",142.5,142.5,0,"DEL")
@
"SEC","^DIC",142.5,142.5,0,"LAYGO")
@
"SEC","^DIC",142.5,142.5,0,"RD")
@
"SEC","^DIC",142.5,142.5,0,"WR")
@
"VER")
8.0^22.0
"^DD",142.5,142.5,0)
FIELD^^1^21
"^DD",142.5,142.5,0,"DDA")
N
"^DD",142.5,142.5,0,"DT")
3021211
"^DD",142.5,142.5,0,"IX","AC",142.5,.03)

"^DD",142.5,142.5,0,"IX","B",142.5,.01)

"^DD",142.5,142.5,0,"IX","C",142.5,.01)

"^DD",142.5,142.5,0,"NM","HEALTH SUMMARY OBJECTS")

"^DD",142.5,142.5,.01,0)
NAME^RF^^0;1^K:$L(X)>60!($L(X)<3) X
"^DD",142.5,142.5,.01,1,0)
^.1
"^DD",142.5,142.5,.01,1,1,0)
142.5^B
"^DD",142.5,142.5,.01,1,1,1)
S ^GMT(142.5,"B",$E(X,1,30),DA)=""
"^DD",142.5,142.5,.01,1,1,2)
K ^GMT(142.5,"B",$E(X,1,30),DA)
"^DD",142.5,142.5,.01,1,1,"%D",0)
^^2^2^3021030^
"^DD",142.5,142.5,.01,1,1,"%D",1,0)
^GMT(142.5,"B",$E(NAM,1,30),DA)="" - Where NAM is a 30 character extract of 
"^DD",142.5,142.5,.01,1,1,"%D",2,0)
the Health Summary Object name.
"^DD",142.5,142.5,.01,1,2,0)
142.5^C^MUMPS
"^DD",142.5,142.5,.01,1,2,1)
S ^GMT(142.5,"C",$$UP^XLFSTR(X),DA)=""
"^DD",142.5,142.5,.01,1,2,2)
K ^GMT(142.5,"C",$$UP^XLFSTR(X),DA)
"^DD",142.5,142.5,.01,1,2,"%D",0)
^^2^2^3021030^
"^DD",142.5,142.5,.01,1,2,"%D",1,0)
^GMT(142.5,"C",UNM,DA)="" - Where UNM is the uppercase name of the Health 
"^DD",142.5,142.5,.01,1,2,"%D",2,0)
Summary Object.
"^DD",142.5,142.5,.01,1,2,"DT")
3021030
"^DD",142.5,142.5,.01,3)
Answer must be 3-60 characters in length.
"^DD",142.5,142.5,.01,10)

"^DD",142.5,142.5,.01,21,0)
^.001^2^2^3021211^^^^
"^DD",142.5,142.5,.01,21,1,0)
This is the name of the Health Summary Object to be embedded in another 
"^DD",142.5,142.5,.01,21,2,0)
document.
"^DD",142.5,142.5,.01,"DT")
3021211
"^DD",142.5,142.5,.02,0)
OBJECT LABEL^F^^0;2^K:$L(X)>60!($L(X)<3) X
"^DD",142.5,142.5,.02,3)
Answer must be 3-60 characters in length
"^DD",142.5,142.5,.02,4)
D LBH^GMTSOBH
"^DD",142.5,142.5,.02,21,0)
^^2^2^3020702^
"^DD",142.5,142.5,.02,21,1,0)
This is a string of text, 3 to 79 characters in length, that will precede 
"^DD",142.5,142.5,.02,21,2,0)
the object embedded in another document to identify the object that follows.
"^DD",142.5,142.5,.02,"DT")
3020710
"^DD",142.5,142.5,.03,0)
HEALTH SUMMARY TYPE^RP142'^GMT(142,^0;3^Q
"^DD",142.5,142.5,.03,1,0)
^.1
"^DD",142.5,142.5,.03,1,1,0)
142.5^AC
"^DD",142.5,142.5,.03,1,1,1)
S ^GMT(142.5,"AC",$E(X,1,30),DA)=""
"^DD",142.5,142.5,.03,1,1,2)
K ^GMT(142.5,"AC",$E(X,1,30),DA)
"^DD",142.5,142.5,.03,1,1,"%D",0)
^^3^3^3020911^
"^DD",142.5,142.5,.03,1,1,"%D",1,0)
This is a cross reference on Health Summary Type, used by the GMTS TYPE 
"^DD",142.5,142.5,.03,1,1,"%D",2,0)
DELETE option to ensure that a user does not delete a Health Summary Type 
"^DD",142.5,142.5,.03,1,1,"%D",3,0)
used by an Object.
"^DD",142.5,142.5,.03,1,1,"DT")
3020911
"^DD",142.5,142.5,.03,4)
D HSTH^GMTSOBH
"^DD",142.5,142.5,.03,21,0)
^^2^2^3020702^
"^DD",142.5,142.5,.03,21,1,0)
This is a pointer to the Health Summary Type that will be imbedded as an 
"^DD",142.5,142.5,.03,21,2,0)
object into another document.
"^DD",142.5,142.5,.03,"DT")
3020911
"^DD",142.5,142.5,.04,0)
REPORT PERIOD^RFX^^0;4^K:$L(X)>5!($L(X)<2) X S:$D(X) X=$$TIM^GMTSOBT(X) K:'$L($G(X)) X
"^DD",142.5,142.5,.04,3)
Answer with a 2-5 character time period
"^DD",142.5,142.5,.04,4)
D TH^GMTSOBT
"^DD",142.5,142.5,.04,21,0)
^^2^2^3020702^
"^DD",142.5,142.5,.04,21,1,0)
This is a pointer to the Health Summary Type that will be imbedded as an 
"^DD",142.5,142.5,.04,21,2,0)
object into another document.
"^DD",142.5,142.5,.04,21,3,0)
elements may be excluded depending on how exclusion fields in this file are 
"^DD",142.5,142.5,.04,21,4,0)
set.
"^DD",142.5,142.5,.04,"DT")
3020703
"^DD",142.5,142.5,.05,0)
SUPPRESS COMPONENTS W/O DATA^S^1:YES;0:NO;^0;5^Q
"^DD",142.5,142.5,.05,4)
D SC^GMTSOBH
"^DD",142.5,142.5,.05,21,0)
^^4^4^3020715^
"^DD",142.5,142.5,.05,21,1,0)
If this field is set to 1 (YES) and a Health Summary component does not have 
"^DD",142.5,142.5,.05,21,2,0)
any data, the component will be suppressed.  If this field is not set to 1 
"^DD",142.5,142.5,.05,21,3,0)
(YES) and the component does not have any data, then the component will 
"^DD",142.5,142.5,.05,21,4,0)
print with the statement "No data available".
"^DD",142.5,142.5,.05,"DT")
3020715
"^DD",142.5,142.5,.06,0)
SUPPRESS HEADER^S^1:YES;0:NO;^0;6^Q
"^DD",142.5,142.5,.06,4)
D RD^GMTSOBH
"^DD",142.5,142.5,.06,21,0)
^^4^4^3020702^
"^DD",142.5,142.5,.06,21,1,0)
When this field is set to 1 (YES), Health Summary headers will be suppressed
"^DD",142.5,142.5,.06,21,2,0)
when printing as an object embedded in another document.  Individual data 
"^DD",142.5,142.5,.06,21,3,0)
elements may be excluded depending on how exclusion fields in this file are 
"^DD",142.5,142.5,.06,21,4,0)
set.
"^DD",142.5,142.5,.06,"DT")
3020702
"^DD",142.5,142.5,.07,0)
PRINT LABEL^S^1:YES;0:NO;^0;7^Q
"^DD",142.5,142.5,.07,21,0)
^^3^3^3020711^
"^DD",142.5,142.5,.07,21,1,0)
When this field is set to 1 (YES), the Health Summary Object Label will be
"^DD",142.5,142.5,.07,21,2,0)
printed prior to printing the object.  When it is set to 0 (NO) the Health 
"^DD",142.5,142.5,.07,21,3,0)
Summary Object Label will be ignored.
"^DD",142.5,142.5,.07,"DT")
3020711
"^DD",142.5,142.5,.08,0)
PRINT BLANK LINE AFTER LABEL^S^1:YES;0:NO;^0;8^Q
"^DD",142.5,142.5,.08,4)
D LBLH^GMTSOBH
"^DD",142.5,142.5,.08,21,0)
^^3^3^3020716^
"^DD",142.5,142.5,.08,21,1,0)
If there is a Label for the object and the Label is to be printed, then a
"^DD",142.5,142.5,.08,21,2,0)
blank line may be printed after the object label if this field is set to
"^DD",142.5,142.5,.08,21,3,0)
1 (YES).
"^DD",142.5,142.5,.08,"DT")
3020716
"^DD",142.5,142.5,.09,0)
PRINT REPORT DATE AND TIME^S^1:YES;0:NO;^0;9^Q
"^DD",142.5,142.5,.09,4)
D RD^GMTSOBH
"^DD",142.5,142.5,.09,21,0)
^^3^3^3020702^
"^DD",142.5,142.5,.09,21,1,0)
When this field is set to 1 (YES), the Health Summary report date and time 
"^DD",142.5,142.5,.09,21,2,0)
will be printed as part of a Health Summary object embedded in another 
"^DD",142.5,142.5,.09,21,3,0)
document, even if the Health Summary headers are to be suppressed.
"^DD",142.5,142.5,.09,"DT")
3020702
"^DD",142.5,142.5,.1,0)
PRINT CONFIDENTIALITY BANNER^S^1:YES;0:NO;^0;10^Q
"^DD",142.5,142.5,.1,4)
D CH^GMTSOBH
"^DD",142.5,142.5,.1,21,0)
^^3^3^3020702^
"^DD",142.5,142.5,.1,21,1,0)
When this field is set to 1 (YES), the Health Summary confidentiality banner 
"^DD",142.5,142.5,.1,21,2,0)
will be printed as part of a Health Summary object embedded in another 
"^DD",142.5,142.5,.1,21,3,0)
document, even if the Health Summary headers are to be suppressed.
"^DD",142.5,142.5,.1,21,4,0)
suppressed.
"^DD",142.5,142.5,.1,"DT")
3020702
"^DD",142.5,142.5,.11,0)
PRINT REPORT HEADER^S^1:YES;0:NO;^0;11^Q
"^DD",142.5,142.5,.11,4)
D RH^GMTSOBH
"^DD",142.5,142.5,.11,21,0)
^^4^4^3020702^^
"^DD",142.5,142.5,.11,21,1,0)
When this field is set to 1 (YES), the Health Summary report header (and 
"^DD",142.5,142.5,.11,21,2,0)
accompanying blank line) will be printed as part of a Health Summary object
"^DD",142.5,142.5,.11,21,3,0)
embedded in another document, even if the Health Summary headers are to be 
"^DD",142.5,142.5,.11,21,4,0)
suppressed.
"^DD",142.5,142.5,.11,"DT")
3020702
"^DD",142.5,142.5,.12,0)
PRINT COMPONENT HEADER^S^1:YES;0:NO;^0;12^Q
"^DD",142.5,142.5,.12,4)
D CH^GMTSOBH
"^DD",142.5,142.5,.12,21,0)
^^3^3^3020702^
"^DD",142.5,142.5,.12,21,1,0)
When this field is set to 1 (YES), the Health Summary component headers will
"^DD",142.5,142.5,.12,21,2,0)
be printed as part of a Health Summary object embedded in another document, 
"^DD",142.5,142.5,.12,21,3,0)
even if the Health Summary headers are to be suppressed.
"^DD",142.5,142.5,.12,21,4,0)
Summary headers are to be suppressed.  For this field to have any effect on 
"^DD",142.5,142.5,.12,21,5,0)
the display, the field "PRINT COMPONENT HEADERS" must also be set to 1
"^DD",142.5,142.5,.12,21,6,0)
(YES).
"^DD",142.5,142.5,.12,"DT")
3020702
"^DD",142.5,142.5,.13,0)
UNDERLINE COMPONENT HEADER^S^1:YES;0:NO;^0;13^Q
"^DD",142.5,142.5,.13,4)
D CHU^GMTSOBH
"^DD",142.5,142.5,.13,21,0)
^^7^7^3020712^^
"^DD",142.5,142.5,.13,21,1,0)
When this field is set to 1 (YES), the a Component Header will be underlined 
"^DD",142.5,142.5,.13,21,2,0)
with a single dashed line.  For this field to have any effect on the display, 
"^DD",142.5,142.5,.13,21,3,0)
the field "PRINT COMPONENT HEADERS" must also be set to 1 (YES).  
"^DD",142.5,142.5,.13,21,4,0)

"^DD",142.5,142.5,.13,21,5,0)
PN - Progress Notes 
"^DD",142.5,142.5,.13,21,6,0)
-------------------
"^DD",142.5,142.5,.13,21,7,0)
<data> 
"^DD",142.5,142.5,.13,"DT")
3020712
"^DD",142.5,142.5,.14,0)
PRINT TIME-OCCURRENCE LIMITS^S^1:YES;0:NO;^0;14^Q
"^DD",142.5,142.5,.14,4)
D LM^GMTSOBH
"^DD",142.5,142.5,.14,21,0)
^^5^5^3020702^
"^DD",142.5,142.5,.14,21,1,0)
When this field is set to 1 (YES), the Health Summary report time and 
"^DD",142.5,142.5,.14,21,2,0)
occurrence limits will be printed with the Component Header as part of a 
"^DD",142.5,142.5,.14,21,3,0)
Health Summary object embedded in another document, even if the Health 
"^DD",142.5,142.5,.14,21,4,0)
Summary headers are to be suppressed.  For this field to have any effect on 
"^DD",142.5,142.5,.14,21,5,0)
the display, the field "PRINT COMPONENT HEADERS" must also be set to 1 (YES)
"^DD",142.5,142.5,.14,"DT")
3020702
"^DD",142.5,142.5,.15,0)
FORCE BLANK LINE^S^1:YES;0:NO;^0;15^Q
"^DD",142.5,142.5,.15,4)
D BL^GMTSOBH
"^DD",142.5,142.5,.15,21,0)
^^5^5^3020702^
"^DD",142.5,142.5,.15,21,1,0)
When this field is set to 1 (YES), a blank line will be printed after 
"^DD",142.5,142.5,.15,21,2,0)
each Component Header as part of a Health Summary object embedded in another 
"^DD",142.5,142.5,.15,21,3,0)
document, even if the Health Summary headers are to be suppressed.  For this 
"^DD",142.5,142.5,.15,21,4,0)
field to have any effect on the display, the field "PRINT COMPONENT HEADERS"
"^DD",142.5,142.5,.15,21,5,0)
must also be set to 1 (YES).
"^DD",142.5,142.5,.15,"DT")
3020702
"^DD",142.5,142.5,.16,0)
PRINT DECEASED INFORMATION^S^1:YES;0:NO;^0;16^Q
"^DD",142.5,142.5,.16,4)
D DE^GMTSOBH
"^DD",142.5,142.5,.16,21,0)
^^6^6^3020702^
"^DD",142.5,142.5,.16,21,1,0)
The Health Summary has a conditional line of text that prints with each 
"^DD",142.5,142.5,.16,21,2,0)
Health Summary Header for patients who are deceased.  This conditional line 
"^DD",142.5,142.5,.16,21,3,0)
contains the word "DECEASED" and the date and time the patient died.  When 
"^DD",142.5,142.5,.16,21,4,0)
this field is set to 1 (YES), the conditional "Deceased" line will be 
"^DD",142.5,142.5,.16,21,5,0)
printed as part of a Health Summary object embedded in another document, 
"^DD",142.5,142.5,.16,21,6,0)
even if the Health Summary headers are to be suppressed.
"^DD",142.5,142.5,.16,"DT")
3020702
"^DD",142.5,142.5,.17,0)
CREATOR^P200'^VA(200,^0;17^Q
"^DD",142.5,142.5,.17,3)
Enter the creator's name.
"^DD",142.5,142.5,.17,21,0)
^^1^1^3020702^
"^DD",142.5,142.5,.17,21,1,0)
The name of the individual who created the Health Summary object.
"^DD",142.5,142.5,.17,"DT")
3020712
"^DD",142.5,142.5,.18,0)
DATE CREATED^D^^0;18^S %DT="ESTXR" D ^%DT S X=Y K:3020101>X X
"^DD",142.5,142.5,.18,3)
TYPE A DATE NOT EARLIER THAN JAN 01, 2002
"^DD",142.5,142.5,.18,21,0)
^^1^1^3020711^
"^DD",142.5,142.5,.18,21,1,0)
This is the date the Object was created.
"^DD",142.5,142.5,.18,"DT")
3020711
"^DD",142.5,142.5,.19,0)
DATE LAST MODIFIED^D^^0;19^S %DT="ESTXR" D ^%DT S X=Y K:3020101>X X
"^DD",142.5,142.5,.19,3)
TYPE A DATE NOT EARLIER THAN JAN 01, 2002
"^DD",142.5,142.5,.19,21,0)
^^1^1^3020711^
"^DD",142.5,142.5,.19,21,1,0)
This is the date that this object was last modified.
"^DD",142.5,142.5,.19,"DT")
3020711
"^DD",142.5,142.5,.2,0)
NATIONAL OBJECT^S^1:YES;0:NO;^0;20^Q
"^DD",142.5,142.5,.2,21,0)
^^2^2^3020724^
"^DD",142.5,142.5,.2,21,1,0)
This field is a flag to indicate an object as being a nationally released 
"^DD",142.5,142.5,.2,21,2,0)
object.
"^DD",142.5,142.5,.2,"DT")
3020724
"^DD",142.5,142.5,1,0)
OBJECT DESCRIPTION^142.51^^1;0
"^DD",142.5,142.51,0)
OBJECT DESCRIPTION SUB-FIELD^^.01^1
"^DD",142.5,142.51,0,"DT")
3020702
"^DD",142.5,142.51,0,"NM","OBJECT DESCRIPTION")

"^DD",142.5,142.51,0,"UP")
142.5
"^DD",142.5,142.51,.01,0)
OBJECT DESCRIPTION^W^^0;1
"^DD",142.5,142.51,.01,21,0)
^^2^2^3020711^^^
"^DD",142.5,142.51,.01,21,1,0)
This is a description of the Health Summary Object, and how it is intended
"^DD",142.5,142.51,.01,21,2,0)
to be used.
"^DD",142.5,142.51,.01,"DT")
3020711
"^DIC",142.5,142.5,0)
HEALTH SUMMARY OBJECTS^142.5
"^DIC",142.5,142.5,0,"GL")
^GMT(142.5,
"^DIC",142.5,142.5,"%",0)
^1.005^^
"^DIC",142.5,142.5,"%D",0)
^1.001^3^3^3021210^^^
"^DIC",142.5,142.5,"%D",1,0)
This file contains Health Summary Types that are to be embedded into another 
"^DIC",142.5,142.5,"%D",2,0)
document as an object.  The bulk of this file is made up of display flags 
"^DIC",142.5,142.5,"%D",3,0)
which control how the object is to be embedded into the other document.
"^DIC",142.5,"B","HEALTH SUMMARY OBJECTS",142.5)

**END**
**END**
