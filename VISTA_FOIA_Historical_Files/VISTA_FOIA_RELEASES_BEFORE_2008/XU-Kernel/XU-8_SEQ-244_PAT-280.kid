Released XU*8*280 SEQ #244
Extracted from mail message
**KIDS**:XU*8.0*280^

**INSTALL NAME**
XU*8.0*280
"BLD",655,0)
XU*8.0*280^KERNEL^0^3030401^y
"BLD",655,1,0)
^^2^2^3030121^
"BLD",655,1,1,0)
Please refer to the Description in FORUM Patch Module for details.
"BLD",655,1,2,0)
See patch XU*8*280.
"BLD",655,4,0)
^9.64PA^^
"BLD",655,"KRN",0)
^9.67PA^8989.52^19
"BLD",655,"KRN",.4,0)
.4
"BLD",655,"KRN",.401,0)
.401
"BLD",655,"KRN",.402,0)
.402
"BLD",655,"KRN",.403,0)
.403
"BLD",655,"KRN",.5,0)
.5
"BLD",655,"KRN",.84,0)
.84
"BLD",655,"KRN",3.6,0)
3.6
"BLD",655,"KRN",3.8,0)
3.8
"BLD",655,"KRN",9.2,0)
9.2
"BLD",655,"KRN",9.8,0)
9.8
"BLD",655,"KRN",9.8,"NM",0)
^9.68A^2^2
"BLD",655,"KRN",9.8,"NM",1,0)
XLFDT^^0^B27168745
"BLD",655,"KRN",9.8,"NM",2,0)
XLFDT1^^0^B6255536
"BLD",655,"KRN",9.8,"NM","B","XLFDT",1)

"BLD",655,"KRN",9.8,"NM","B","XLFDT1",2)

"BLD",655,"KRN",19,0)
19
"BLD",655,"KRN",19.1,0)
19.1
"BLD",655,"KRN",101,0)
101
"BLD",655,"KRN",409.61,0)
409.61
"BLD",655,"KRN",771,0)
771
"BLD",655,"KRN",870,0)
870
"BLD",655,"KRN",8989.51,0)
8989.51
"BLD",655,"KRN",8989.52,0)
8989.52
"BLD",655,"KRN",8994,0)
8994
"BLD",655,"KRN","B",.4,.4)

"BLD",655,"KRN","B",.401,.401)

"BLD",655,"KRN","B",.402,.402)

"BLD",655,"KRN","B",.403,.403)

"BLD",655,"KRN","B",.5,.5)

"BLD",655,"KRN","B",.84,.84)

"BLD",655,"KRN","B",3.6,3.6)

"BLD",655,"KRN","B",3.8,3.8)

"BLD",655,"KRN","B",9.2,9.2)

"BLD",655,"KRN","B",9.8,9.8)

"BLD",655,"KRN","B",19,19)

"BLD",655,"KRN","B",19.1,19.1)

"BLD",655,"KRN","B",101,101)

"BLD",655,"KRN","B",409.61,409.61)

"BLD",655,"KRN","B",771,771)

"BLD",655,"KRN","B",870,870)

"BLD",655,"KRN","B",8989.51,8989.51)

"BLD",655,"KRN","B",8989.52,8989.52)

"BLD",655,"KRN","B",8994,8994)

"BLD",655,"QUES",0)
^9.62^^
"BLD",655,"REQB",0)
^9.611^1^1
"BLD",655,"REQB",1,0)
XU*8.0*179^2
"BLD",655,"REQB","B","XU*8.0*179",1)

"MBREQ")
0
"PKG",3,-1)
1^1
"PKG",3,0)
KERNEL^XU^SIGN-ON, SECURITY, MENU DRIVER, DEVICES, TASKMAN^
"PKG",3,20,0)
^9.402P^^0
"PKG",3,22,0)
^9.49I^1^1
"PKG",3,22,1,0)
8.0^2950703^2970507^.5
"PKG",3,22,1,"PAH",1,0)
280^3030401
"PKG",3,22,1,"PAH",1,1,0)
^^2^2^3030401
"PKG",3,22,1,"PAH",1,1,1,0)
Please refer to the Description in FORUM Patch Module for details.
"PKG",3,22,1,"PAH",1,1,2,0)
See patch XU*8*280.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
2
"RTN","XLFDT")
0^1^B27168745
"RTN","XLFDT",1,0)
XLFDT ;ISC-SF/STAFF - Date/Time Functions ;03/27/2003  14:09
"RTN","XLFDT",2,0)
 ;;8.0;KERNEL;**71,120,166,168,179,280**;Jul 10, 1995
"RTN","XLFDT",3,0)
 ;VA FileMan uses 2400 as midnight, many other system use 0000.
"RTN","XLFDT",4,0)
 ;This is true for $H and HL7, so a conversion has to adjust
"RTN","XLFDT",5,0)
 ;the day when converting Midnight.
"RTN","XLFDT",6,0)
 ;i.e. 3001225.24 is the same as HL7 '200012260000' and $H '58434,0'
"RTN","XLFDT",7,0)
 ;The range of accepted $H dates: "2,0" to "99999,85399".
"RTN","XLFDT",8,0)
 ;The range of accepted FM dates: 1410102 to 4141015 (any valid time).
"RTN","XLFDT",9,0)
 ;The range of accepted HL7 dates: 18410102 to 21141015 (any valid time).
"RTN","XLFDT",10,0)
 ;It is expected that input values are valid dates.
"RTN","XLFDT",11,0)
 ;
"RTN","XLFDT",12,0)
HTFM(%H,%F) ;$H to FM, %F=1 for date only
"RTN","XLFDT",13,0)
 N X,%,%T,%Y,%M,%D S:'$D(%F) %F=0
"RTN","XLFDT",14,0)
 I $$HR(%H) Q -1 ;Check Range
"RTN","XLFDT",15,0)
 I '%F,%H[",0" S %H=(%H-1)_",86400"
"RTN","XLFDT",16,0)
 D YMD S:%T&('%F) X=X_%T
"RTN","XLFDT",17,0)
 Q X
"RTN","XLFDT",18,0)
 ;
"RTN","XLFDT",19,0)
H2F(%H) ;Internal to this routine use
"RTN","XLFDT",20,0)
 N X,%,%T,%Y,%M,%D
"RTN","XLFDT",21,0)
 D YMD S:%T X=X_%T
"RTN","XLFDT",22,0)
 Q X
"RTN","XLFDT",23,0)
 ;
"RTN","XLFDT",24,0)
YMD ;21608 = 28 feb 1900, 94657 = 28 feb 2100, 141 $H base year
"RTN","XLFDT",25,0)
 S %=(%H>21608)+(%H>94657)+%H-.1,%Y=%\365.25+141,%=%#365.25\1
"RTN","XLFDT",26,0)
 S %D=%+306#(%Y#4=0+365)#153#61#31+1,%M=%-%D\29+1
"RTN","XLFDT",27,0)
 S X=%Y_"00"+%M_"00"+%D,%=$P(%H,",",2)
"RTN","XLFDT",28,0)
 S %T=%#60/100+(%#3600\60)/100+(%\3600)/100 S:'%T %T=".0"
"RTN","XLFDT",29,0)
 Q
"RTN","XLFDT",30,0)
 ;
"RTN","XLFDT",31,0)
FMTH(X,%F) ;FM to $H, %F=1 for date only
"RTN","XLFDT",32,0)
 N %Y,%H,%A S:'$D(%F) %F=0
"RTN","XLFDT",33,0)
 I $$FR(X) Q -1 ;$H range of 1 - 99999
"RTN","XLFDT",34,0)
 I '%F,X[".24" S %A=1
"RTN","XLFDT",35,0)
 D H S:%F %H=+%H I $D(%A) S %H=(%H+1)_",0"
"RTN","XLFDT",36,0)
 Q %H
"RTN","XLFDT",37,0)
 ;
"RTN","XLFDT",38,0)
F2H(X) ;Internal to this routine use
"RTN","XLFDT",39,0)
 N %Y,%H,%A
"RTN","XLFDT",40,0)
 D H
"RTN","XLFDT",41,0)
 Q %H
"RTN","XLFDT",42,0)
 ;
"RTN","XLFDT",43,0)
H ;Build %H from FM
"RTN","XLFDT",44,0)
 N %,%L,%M,%D,%T I X<1410101 S %H=0,%Y=-1 Q
"RTN","XLFDT",45,0)
 S %Y=$E(X,1,3),%M=$E(X,4,5),%D=$E(X,6,7)
"RTN","XLFDT",46,0)
 S %T=$E(X_0,9,10)*60+$E(X_"000",11,12)*60+$E(X_"00000",13,14)
"RTN","XLFDT",47,0)
 ;%L = (# leap years) - (# leap years before base)
"RTN","XLFDT",48,0)
 S %L=%Y+1700 S:%M<3 %L=%L-1 S %L=(%L\4)-(%L\100)+(%L\400)-446
"RTN","XLFDT",49,0)
 S %H=$P("^31^59^90^120^151^181^212^243^273^304^334","^",%M)+%D
"RTN","XLFDT",50,0)
 S %=('%M)!('%D),%Y=%Y-141,%H=(%H+(%Y*365)+%L+%)_","_%T,%Y=$S(%:-1,1:%H+4#7)
"RTN","XLFDT",51,0)
 Q
"RTN","XLFDT",52,0)
 ;
"RTN","XLFDT",53,0)
HTE(%H,%F) ;$H to external
"RTN","XLFDT",54,0)
 Q:$$HR(%H) %H ;Range Check
"RTN","XLFDT",55,0)
 N Y,%T,%R
"RTN","XLFDT",56,0)
 S %F=$G(%F,1) S Y=$$HTFM(%H,0) G T2
"RTN","XLFDT",57,0)
 ;
"RTN","XLFDT",58,0)
FMTE(Y,%F) ;FM to external
"RTN","XLFDT",59,0)
 Q:(Y<1000000)!(Y>9991231) Y ;Range Check
"RTN","XLFDT",60,0)
 N %T,%R S %F=$G(%F,1)
"RTN","XLFDT",61,0)
 ;Both HTE and FMTE come here.
"RTN","XLFDT",62,0)
T2 S %T="."_$E($P(Y,".",2)_"000000",1,7)
"RTN","XLFDT",63,0)
 D FMT^XLFDT1 Q %R
"RTN","XLFDT",64,0)
 ;
"RTN","XLFDT",65,0)
FR(%V) ;Check FM in valid range
"RTN","XLFDT",66,0)
 Q (%V<1410102)!(%V>4141015.235959)
"RTN","XLFDT",67,0)
HR(%V) ;Check $H in valid range
"RTN","XLFDT",68,0)
 Q (%V<2)!(%V>99999)
"RTN","XLFDT",69,0)
 ;
"RTN","XLFDT",70,0)
FMTHL7(%P1) ;Convert FM date/time to HL7 format
"RTN","XLFDT",71,0)
 N %T Q:'$L(%P1) "" S %P1=+%P1 ;Make sure a cononic number
"RTN","XLFDT",72,0)
 I $$FR(%P1) Q -1 ;Check range
"RTN","XLFDT",73,0)
 S %T=$P(%P1,".",2),%P1=$P(%P1,".")
"RTN","XLFDT",74,0)
 I %T=24 S %P1=$$FMADD($P(%P1,"."),1),%T="0000"
"RTN","XLFDT",75,0)
 S:%P1>1 %P1=%P1+17000000
"RTN","XLFDT",76,0)
 I $L(%T) S %T=$S($L(%T)>4:$E(%T_"00",1,6),1:$E(%T_"0000",1,4))
"RTN","XLFDT",77,0)
 I $L(%T) S %P1=%P1_%T_$$TZ()
"RTN","XLFDT",78,0)
 Q %P1
"RTN","XLFDT",79,0)
 ;
"RTN","XLFDT",80,0)
HL7TFM(%P1,%P2,%P3) ;Convert HL7 D/T to FM.
"RTN","XLFDT",81,0)
 ;%P1 is the value to convert
"RTN","XLFDT",82,0)
 ;%P2 is if output should be local or UCT time (L,U)
"RTN","XLFDT",83,0)
 ;%P3 is 1 if the input just a time value?
"RTN","XLFDT",84,0)
 N %TZ,%LTZ,%SN,%U,%H,%M,%T Q:'$L(%P1) ""
"RTN","XLFDT",85,0)
 S %T=$E(%P1_"0000",1,8)
"RTN","XLFDT",86,0)
 S %P2=$G(%P2),%P3=+$G(%P3),%TZ="",%LTZ=$$TZ()
"RTN","XLFDT",87,0)
 I '%P3 Q:(%T<18410102)!(%T>21141015) -1 ;Date Range Check
"RTN","XLFDT",88,0)
 F %SN="+","-" I %P1[%SN D  Q  ;Find the timezone
"RTN","XLFDT",89,0)
 . S %TZ=$P(%P1,%SN,2),%P1=$P(%P1,%SN) I %TZ'?4N S %TZ="" Q
"RTN","XLFDT",90,0)
 . S %TZ=%SN_%TZ
"RTN","XLFDT",91,0)
 . Q
"RTN","XLFDT",92,0)
 ;FM only supports time to seconds
"RTN","XLFDT",93,0)
 S %P1=$P(%P1,".")
"RTN","XLFDT",94,0)
 ;See it just a Time value
"RTN","XLFDT",95,0)
 I %P3 S %P1="20000104"_%P1 ;Add a date
"RTN","XLFDT",96,0)
 Q:($L(%P1)#2)!(%P1'?4.14N) -1 ;Length check
"RTN","XLFDT",97,0)
 I $L(%P1)<8 S %P1=$E(%P1_"00000000",1,8) ;Fill out to 8 digits
"RTN","XLFDT",98,0)
 I %TZ="" D
"RTN","XLFDT",99,0)
 . S:%P2["L" %P2="" ;If no TZ, assume local, don't need L.
"RTN","XLFDT",100,0)
 . S:%P2["U" %TZ=%LTZ ;give the local tz
"RTN","XLFDT",101,0)
 ;
"RTN","XLFDT",102,0)
 S %P1=$S($L(%P1)>8:$E(%P1,1,8)-17000000_"."_$E(%P1,9,14),1:%P1-17000000)
"RTN","XLFDT",103,0)
 ;%P1 is now in FM format
"RTN","XLFDT",104,0)
 I %P1[".",+$P(%P1,".",2)=0 S %P1=$$FMADD(+%P1,-1)_".24"
"RTN","XLFDT",105,0)
 ;If HL7 tz and local tz are the same
"RTN","XLFDT",106,0)
 I %P2["L",%TZ=%LTZ S %P2=""
"RTN","XLFDT",107,0)
 I (%P2["U")!(%P2["L"),%P1["." D  ;Build UCT from data
"RTN","XLFDT",108,0)
 . S %=$TR(%TZ,"+-","-+") ;Reverse the sign
"RTN","XLFDT",109,0)
 . S %H=$E(%,1,3),%M=$E(%,1)_$E(%,4,5)
"RTN","XLFDT",110,0)
 . S %P1=$$FMADD(%P1,,%H,%M) Q
"RTN","XLFDT",111,0)
 ;
"RTN","XLFDT",112,0)
 I %P2["L",%P1["." D  ;Build local from UCT
"RTN","XLFDT",113,0)
 . S %=$$TZ(),%H=$E(%,1,3),%M=$E(%,1)_$E(%,4,5)
"RTN","XLFDT",114,0)
 . S %P1=$$FMADD(%P1,,%H,%M) Q
"RTN","XLFDT",115,0)
 Q +$S(%P3:"."_$P(%P1,".",2),1:%P1)
"RTN","XLFDT",116,0)
 ;
"RTN","XLFDT",117,0)
DOW(X,Y) ;Day of Week
"RTN","XLFDT",118,0)
 N %Y,%M,%D,%H,%T D H I $G(Y) Q %Y
"RTN","XLFDT",119,0)
 Q $P("Sun^Mon^Tues^Wednes^Thurs^Fri^Satur","^",%Y+1)_"day"
"RTN","XLFDT",120,0)
 ;
"RTN","XLFDT",121,0)
FMDIFF(X1,X2,X3) ;FM diff in two dates. if X3=1 in days, if X3=2 in seconds.
"RTN","XLFDT",122,0)
 N %H,%Y,X
"RTN","XLFDT",123,0)
 S X1=$G(X1),X2=$G(X2),X3=$G(X3,1)
"RTN","XLFDT",124,0)
 S:$$FR(X1) X1=0 S:$$FR(X2) X2=0 ;Check range, Use 0 for bad values
"RTN","XLFDT",125,0)
 S X=X1 D H S X1=+%H,X1(1)=$P(%H,",",2),X=X2 D H
"RTN","XLFDT",126,0)
 ;Both FMDIFF and HDIFF come here.
"RTN","XLFDT",127,0)
D2 S X=(X1-%H) S:X3>1 X=X*86400+(X1(1)-$P(%H,",",2))
"RTN","XLFDT",128,0)
 I X3=3 S %=X,X="" S:%'<86400 X=(%\86400) S:%#86400 X=X_" "_(%#86400\3600)_":"_$E(%#3600\60+100,2,3)_":"_$E(%#60+100,2,3)
"RTN","XLFDT",129,0)
 Q X
"RTN","XLFDT",130,0)
 ;
"RTN","XLFDT",131,0)
HDIFF(X1,X2,X3) ;$H diff in two dates, X3 same as FMDIFF.
"RTN","XLFDT",132,0)
 N X,%H,%T
"RTN","XLFDT",133,0)
 S:$$HR(X1) X1="1,1" S:$$HR(X2) X2="1,1" ;Check range, use "1,1" for bad values
"RTN","XLFDT",134,0)
 S X3=$G(X3,1)
"RTN","XLFDT",135,0)
 S X1(1)=$P(X1,",",2),X1=+X1,%H=X2
"RTN","XLFDT",136,0)
 G D2
"RTN","XLFDT",137,0)
 ;
"RTN","XLFDT",138,0)
HADD(X,D,H,M,S) ;Add to $H date
"RTN","XLFDT",139,0)
 N %H,%T
"RTN","XLFDT",140,0)
 Q:$$HR(X) -1 ;Check Range
"RTN","XLFDT",141,0)
 S %H=+X,%T=$P(X,",",2) D A2 Q %H_","_%T
"RTN","XLFDT",142,0)
 ;
"RTN","XLFDT",143,0)
A2 S %H=%H+$G(D),%T=%T+($G(H)*3600)+($G(M)*60)+$G(S) ;add days and seconds
"RTN","XLFDT",144,0)
 ;S:%T'<86400 %H=%H+(%T\86400),%T=%T#86400 S:%T<0 %H=%H+(%T\86400)-1,%T=%T#86400
"RTN","XLFDT",145,0)
 S %H=%H+(%T\86400) I %T<0,(%T#86400'=0) S %H=%H-1 ;Adj for sec>day
"RTN","XLFDT",146,0)
 S %T=%T#86400
"RTN","XLFDT",147,0)
 Q
"RTN","XLFDT",148,0)
 ;
"RTN","XLFDT",149,0)
FMADD(X,D,H,M,S) ;Add to FM date
"RTN","XLFDT",150,0)
 N %H,%T,%P
"RTN","XLFDT",151,0)
 Q:$$FR(X) -1 ;Check Range
"RTN","XLFDT",152,0)
 S %P=X[".",%H=$$F2H(X),%T=$P(%H,",",2) D A2
"RTN","XLFDT",153,0)
 I %P,%T=0 S %H=%H-1,%T=86400
"RTN","XLFDT",154,0)
 Q $$H2F(%H_","_%T)
"RTN","XLFDT",155,0)
 ;
"RTN","XLFDT",156,0)
NOW() ;Current Date/time in FM.
"RTN","XLFDT",157,0)
 Q $$HTFM($H)
"RTN","XLFDT",158,0)
 ;
"RTN","XLFDT",159,0)
DT() ;Current Date in FM.
"RTN","XLFDT",160,0)
 Q $$HTFM($H,1)\1
"RTN","XLFDT",161,0)
 ;
"RTN","XLFDT",162,0)
SCH(SCH,LTM,FF) ;Find the next D/T given a schedule, start time.
"RTN","XLFDT",163,0)
 Q $$DECODE^XLFDT2
"RTN","XLFDT",164,0)
 ;
"RTN","XLFDT",165,0)
WITHIN(XLSCH,XLD) ;See if D/T is within schedule
"RTN","XLFDT",166,0)
 G WITHIN^XLFDT4
"RTN","XLFDT",167,0)
 ;
"RTN","XLFDT",168,0)
SEC(%) ;Convert $H to seconds.
"RTN","XLFDT",169,0)
 I %?7.N.".".N S %=$$FMTH(%) ;Check for FM date
"RTN","XLFDT",170,0)
 Q 86400*%+$P(%,",",2)
"RTN","XLFDT",171,0)
 ;
"RTN","XLFDT",172,0)
%H(%) ;Covert from seconds to $H
"RTN","XLFDT",173,0)
 Q (%\86400)_","_(%#86400)
"RTN","XLFDT",174,0)
 ;
"RTN","XLFDT",175,0)
TZ() ;Return current Time Zone from Mailman parameter file
"RTN","XLFDT",176,0)
 N %T,%S
"RTN","XLFDT",177,0)
 S %T=$P($G(^XMB(4.4,+$P($G(^XMB(1,1,0)),"^",2),0)),"^",3),%S=$S(%T["-":"-",1:"+"),%T=$TR(%T,"-+")
"RTN","XLFDT",178,0)
 Q %S_$E(100+%T,2,3)_$S(%T[".5":"30",1:"00")
"RTN","XLFDT1")
0^2^B6255536
"RTN","XLFDT1",1,0)
XLFDT1 ;ISC-SF/RWF - Date/Time Functions cont. from VA FileMan %DTC ;02/20/2003  10:05
"RTN","XLFDT1",2,0)
 ;;8.0;KERNEL;**71,280**;Jul 10, 1995
"RTN","XLFDT1",3,0)
 ;If y contains a "D" then Date only.
"RTN","XLFDT1",4,0)
 ;if y contains a "F" then output with leading blanks
"RTN","XLFDT1",5,0)
 ;If y contains a "P" then output ' HH:MM:SS am/pm'.
"RTN","XLFDT1",6,0)
 ;If y contains a "S" then force seconds in the output.
"RTN","XLFDT1",7,0)
 ;if y contains a "M" then stop at minutes i.e. no seconds.
"RTN","XLFDT1",8,0)
 ;
"RTN","XLFDT1",9,0)
FMT ;
"RTN","XLFDT1",10,0)
 N %G S %G=+%F
"RTN","XLFDT1",11,0)
 G F1:%G=1,F2:%G=2,F3:%G=3,F4:%G=4,F5:%G=5,F6:%G=6,F7:%G=7,F8:%G=8,F9:%G=9,F1
"RTN","XLFDT1",12,0)
 Q
"RTN","XLFDT1",13,0)
 ;
"RTN","XLFDT1",14,0)
F1 ;Apr 10, 2002
"RTN","XLFDT1",15,0)
 S %R=$P($$M()," ",$S($E(Y,4,5):$E(Y,4,5)+2,1:0))_$S($E(Y,4,5):" ",1:"")_$S($E(Y,6,7):$E(Y,6,7)_", ",1:"")_($E(Y,1,3)+1700)
"RTN","XLFDT1",16,0)
 ;
"RTN","XLFDT1",17,0)
TM ;All formats come here to format Time.
"RTN","XLFDT1",18,0)
 N %,%S Q:%T'>0!(%F["D")
"RTN","XLFDT1",19,0)
 I %F'["P" S %R=%R_"@"_$E(%T,2,3)_":"_$E(%T,4,5)_$S(%F["M":"",$E(%T,6,7)!(%F["S"):":"_$E(%T,6,7),1:"")
"RTN","XLFDT1",20,0)
 I %F["P" D
"RTN","XLFDT1",21,0)
 . S %R=%R_" "_$S($E(%T,2,3)>12:$E(%T,2,3)-12,+$E(%T,2,3)=0:"12",1:+$E(%T,2,3))_":"_$E(%T,4,5)_$S(%F["M":"",$E(%T,6,7)!(%F["S"):":"_$E(%T,6,7),1:"")
"RTN","XLFDT1",22,0)
 . S %R=%R_$S($E(%T,2,7)<120000:" am",$E(%T,2,3)=24:" am",1:" pm")
"RTN","XLFDT1",23,0)
 . Q
"RTN","XLFDT1",24,0)
 Q
"RTN","XLFDT1",25,0)
 ;Return Month names
"RTN","XLFDT1",26,0)
M() Q "  Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec"
"RTN","XLFDT1",27,0)
 ;
"RTN","XLFDT1",28,0)
F2 ;4/10/02
"RTN","XLFDT1",29,0)
 S %R=$J(+$E(Y,4,5),2)_"/"_$J(+$E(Y,6,7),2)_"/"_$E(Y,2,3)
"RTN","XLFDT1",30,0)
 S:%F["Z" %R=$TR(%R," ","0") S:%F'["F" %R=$TR(%R," ")
"RTN","XLFDT1",31,0)
 G TM
"RTN","XLFDT1",32,0)
F3 ;10/4/02
"RTN","XLFDT1",33,0)
 S %R=$J(+$E(Y,6,7),2)_"/"_$J(+$E(Y,4,5),2)_"/"_$E(Y,2,3)
"RTN","XLFDT1",34,0)
 S:%F["Z" %R=$TR(%R," ","0") S:%F'["F" %R=$TR(%R," ")
"RTN","XLFDT1",35,0)
 G TM
"RTN","XLFDT1",36,0)
F4 ;02/4/10
"RTN","XLFDT1",37,0)
 S %R=$E(Y,2,3)_"/"_$J(+$E(Y,4,5),2)_"/"_$J(+$E(Y,6,7),2)
"RTN","XLFDT1",38,0)
 S:%F["Z" %R=$TR(%R," ","0") S:%F'["F" %R=$TR(%R," ")
"RTN","XLFDT1",39,0)
 G TM
"RTN","XLFDT1",40,0)
F5 ;4/10/2002
"RTN","XLFDT1",41,0)
 S %R=$J(+$E(Y,4,5),2)_"/"_$J(+$E(Y,6,7),2)_"/"_($E(Y,1,3)+1700)
"RTN","XLFDT1",42,0)
 S:%F["Z" %R=$TR(%R," ","0") S:%F'["F" %R=$TR(%R," ")
"RTN","XLFDT1",43,0)
 G TM
"RTN","XLFDT1",44,0)
F6 ;10/4/2002
"RTN","XLFDT1",45,0)
 S %R=$J(+$E(Y,6,7),2)_"/"_$J(+$E(Y,4,5),2)_"/"_($E(Y,1,3)+1700)
"RTN","XLFDT1",46,0)
 S:%F["Z" %R=$TR(%R," ","0") S:%F'["F" %R=$TR(%R," ")
"RTN","XLFDT1",47,0)
 G TM
"RTN","XLFDT1",48,0)
F7 ;2002/4/10
"RTN","XLFDT1",49,0)
 S %R=($E(Y,1,3)+1700)_"/"_$J(+$E(Y,4,5),2)_"/"_$J(+$E(Y,6,7),2)
"RTN","XLFDT1",50,0)
 S:%F["Z" %R=$TR(%R," ","0") S:%F'["F" %R=$TR(%R," ")
"RTN","XLFDT1",51,0)
 G TM
"RTN","XLFDT1",52,0)
F8 ;10 Apr 02
"RTN","XLFDT1",53,0)
 S %R=$S($E(Y,6,7):$E(Y,6,7)_" ",1:"")_$P($$M()," ",$S($E(Y,4,5):$E(Y,4,5)+2,1:0))_$S($E(Y,4,5):" ",1:"")_$E(Y,2,3)
"RTN","XLFDT1",54,0)
 G TM
"RTN","XLFDT1",55,0)
F9 ;10 Apr 2002
"RTN","XLFDT1",56,0)
 S %R=$S($E(Y,6,7):$E(Y,6,7)_" ",1:"")_$P($$M()," ",$S($E(Y,4,5):$E(Y,4,5)+2,1:0))_$S($E(Y,4,5):" ",1:"")_($E(Y,1,3)+1700)
"RTN","XLFDT1",57,0)
 G TM
"VER")
8.0^22.0
**END**
**END**
