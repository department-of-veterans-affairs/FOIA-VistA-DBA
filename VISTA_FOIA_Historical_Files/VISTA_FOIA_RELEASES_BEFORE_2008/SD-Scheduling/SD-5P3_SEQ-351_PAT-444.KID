Released SD*5.3*444 SEQ #351
Extracted from mail message
**KIDS**:SD*5.3*444^

**INSTALL NAME**
SD*5.3*444
"BLD",6213,0)
SD*5.3*444^SCHEDULING^0^3050603^y
"BLD",6213,1,0)
^^1^1^3050602^
"BLD",6213,1,1,0)
UNDEFINED VARIABLE ERROR IN ROUTINE SDAMC
"BLD",6213,4,0)
^9.64PA^^
"BLD",6213,"ABPKG")
n
"BLD",6213,"KRN",0)
^9.67PA^8989.52^19
"BLD",6213,"KRN",.4,0)
.4
"BLD",6213,"KRN",.401,0)
.401
"BLD",6213,"KRN",.402,0)
.402
"BLD",6213,"KRN",.403,0)
.403
"BLD",6213,"KRN",.5,0)
.5
"BLD",6213,"KRN",.84,0)
.84
"BLD",6213,"KRN",3.6,0)
3.6
"BLD",6213,"KRN",3.8,0)
3.8
"BLD",6213,"KRN",9.2,0)
9.2
"BLD",6213,"KRN",9.8,0)
9.8
"BLD",6213,"KRN",9.8,"NM",0)
^9.68A^1^1
"BLD",6213,"KRN",9.8,"NM",1,0)
SDAMC^^0^B12437906
"BLD",6213,"KRN",9.8,"NM","B","SDAMC",1)

"BLD",6213,"KRN",19,0)
19
"BLD",6213,"KRN",19.1,0)
19.1
"BLD",6213,"KRN",101,0)
101
"BLD",6213,"KRN",409.61,0)
409.61
"BLD",6213,"KRN",771,0)
771
"BLD",6213,"KRN",870,0)
870
"BLD",6213,"KRN",8989.51,0)
8989.51
"BLD",6213,"KRN",8989.52,0)
8989.52
"BLD",6213,"KRN",8994,0)
8994
"BLD",6213,"KRN","B",.4,.4)

"BLD",6213,"KRN","B",.401,.401)

"BLD",6213,"KRN","B",.402,.402)

"BLD",6213,"KRN","B",.403,.403)

"BLD",6213,"KRN","B",.5,.5)

"BLD",6213,"KRN","B",.84,.84)

"BLD",6213,"KRN","B",3.6,3.6)

"BLD",6213,"KRN","B",3.8,3.8)

"BLD",6213,"KRN","B",9.2,9.2)

"BLD",6213,"KRN","B",9.8,9.8)

"BLD",6213,"KRN","B",19,19)

"BLD",6213,"KRN","B",19.1,19.1)

"BLD",6213,"KRN","B",101,101)

"BLD",6213,"KRN","B",409.61,409.61)

"BLD",6213,"KRN","B",771,771)

"BLD",6213,"KRN","B",870,870)

"BLD",6213,"KRN","B",8989.51,8989.51)

"BLD",6213,"KRN","B",8989.52,8989.52)

"BLD",6213,"KRN","B",8994,8994)

"BLD",6213,"QUES",0)
^9.62^^
"BLD",6213,"REQB",0)
^9.611^1^1
"BLD",6213,"REQB",1,0)
SD*5.3*414^1
"BLD",6213,"REQB","B","SD*5.3*414",1)

"MBREQ")
0
"PKG",16,-1)
1^1
"PKG",16,0)
SCHEDULING^SD^APPOINTMENTS,PROFILES,LETTERS,AMIS REPORTS
"PKG",16,20,0)
^9.402P^^
"PKG",16,22,0)
^9.49I^1^1
"PKG",16,22,1,0)
5.3^2930813
"PKG",16,22,1,"PAH",1,0)
444^3050603
"PKG",16,22,1,"PAH",1,1,0)
^^1^1^3050603
"PKG",16,22,1,"PAH",1,1,1,0)
UNDEFINED VARIABLE ERROR IN ROUTINE SDAMC
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
1
"RTN","SDAMC")
0^1^B12437906
"RTN","SDAMC",1,0)
SDAMC ;ALB/MJK - Cancel Appt Action ; 2/4/92
"RTN","SDAMC",2,0)
 ;;5.3;Scheduling;**20,28,32,46,263,414,444**;Aug 13, 1993
"RTN","SDAMC",3,0)
 ;
"RTN","SDAMC",4,0)
EN ; -- protocol SDAM APPT CANCEL entry pt
"RTN","SDAMC",5,0)
 ; input:  VALMY := array entries
"RTN","SDAMC",6,0)
 ;
"RTN","SDAMC",7,0)
 N SDI,SDAT,VALMY,SDAMCIDT,CNT,L,SDWH,SDCP,SDREM,SDSCR,SDMSG,SCLHOLD
"RTN","SDAMC",8,0)
 K ^UTILITY($J)
"RTN","SDAMC",9,0)
 ;
"RTN","SDAMC",10,0)
 ;
"RTN","SDAMC",11,0)
 I '$D(DFN),$G(SDFN),($G(SDAMTYP)="P") S DFN=SDFN
"RTN","SDAMC",12,0)
 ;
"RTN","SDAMC",13,0)
 S VALMBCK=""
"RTN","SDAMC",14,0)
 D SEL^VALM2,CHK G ENQ:'$O(VALMY(0))
"RTN","SDAMC",15,0)
 D FULL^VALM1 S VALMBCK="R"
"RTN","SDAMC",16,0)
 S SDWH=$$WHO,SDCP=$S(SDWH="C":0,1:1) G ENQ:SDWH=-1
"RTN","SDAMC",17,0)
 S SDSCR=$$RSN(SDWH) G ENQ:SDSCR=-1
"RTN","SDAMC",18,0)
 S SDREM=$$REM G ENQ:SDREM=-1
"RTN","SDAMC",19,0)
 S (SDI,CNT,L)=0
"RTN","SDAMC",20,0)
 F  S SDI=$O(VALMY(SDI)) Q:'SDI  I $D(^TMP("SDAMIDX",$J,SDI)) K SDAT S SDAT=^(SDI) W !,^TMP("SDAM",$J,+SDAT,0) D CAN($P(SDAT,U,2),$P(SDAT,U,3),.CNT,.L,SDWH,SDCP,SDSCR,SDREM)
"RTN","SDAMC",21,0)
 I SDAMTYP="P" D BLD^SDAM1
"RTN","SDAMC",22,0)
 I SDAMTYP="C" D BLD^SDAM3
"RTN","SDAMC",23,0)
ENQ Q
"RTN","SDAMC",24,0)
 ;
"RTN","SDAMC",25,0)
CAN(DFN,SDT,CNT,L,SDWH,SDCP,SDSCR,SDREM) ;
"RTN","SDAMC",26,0)
 N A1,NDT S NDT=SDT
"RTN","SDAMC",27,0)
 I $P($G(^DPT(DFN,"S",NDT,0)),U,2)["C" W !!,"Appointment already cancelled" H 2 G CANQ
"RTN","SDAMC",28,0)
 I $D(^DPT(DFN,"S",NDT,0)) S SD0=^(0) I $P(SD0,"^",2)'["C" S SC=+SD0,L=L\1+1,APL="" D FLEN^SDCNP1A S ^UTILITY($J,"SDCNP",L)=NDT_"^"_SC_"^"_COV_"^"_APL_"^^"_APL D CHKSO^SDCNP0
"RTN","SDAMC",29,0)
 ;SD*5.3*414 next line added to set hold variable SCLHOLD for clinic ptr
"RTN","SDAMC",30,0)
 S APP=1,A1=L\1 S SCLHOLD=$P(^UTILITY($J,"SDCNP",A1),U,2) D BEGD^SDCNP0
"RTN","SDAMC",31,0)
 D MES,NOPE W ! S (CNT,L)=0 K ^UTILITY($J,"SDCNP")
"RTN","SDAMC",32,0)
CANQ ;
"RTN","SDAMC",33,0)
 ;Wait List Message
"RTN","SDAMC",34,0)
 ;
"RTN","SDAMC",35,0)
 I $G(SCLHOLD)'="" S:'$D(SDCLN) SDCLN=SCLHOLD  ; SD*5.3*414
"RTN","SDAMC",36,0)
 I $G(SDCLN)'="",$D(^SDWL(409.3,"SC",SDCLN)) D
"RTN","SDAMC",37,0)
 .W !,?1,"There are Patients on the Wait List waiting for an Appointment in the",!?1,$P(^SC(SDCLN,0),U,1)," Clinic.",!
"RTN","SDAMC",38,0)
 S DIR(0)="E" D ^DIR W !
"RTN","SDAMC",39,0)
 K:SDAMTYP="P" SDCLN
"RTN","SDAMC",40,0)
 K SCLHOLD,SC,COV,APP
"RTN","SDAMC",41,0)
 Q
"RTN","SDAMC",42,0)
MES ; -- set error message
"RTN","SDAMC",43,0)
 S SDMSG="W !,""Enter appt. numbers separated by commas and/or a range separated"",!,""by dashes (ie 2,4,6-9)"" H 2"
"RTN","SDAMC",44,0)
 Q
"RTN","SDAMC",45,0)
 ;
"RTN","SDAMC",46,0)
WHO() ;
"RTN","SDAMC",47,0)
 W ! S DIR(0)="SOA^PC:PATIENT;C:CLINIC",DIR("A")="Appointments cancelled by (P)atient or (C)linic: ",DIR("B")="Patient"
"RTN","SDAMC",48,0)
 D ^DIR K DIR
"RTN","SDAMC",49,0)
 Q $S(Y=""!(Y="^"):-1,1:Y)
"RTN","SDAMC",50,0)
 ;
"RTN","SDAMC",51,0)
RSN(SDWH) ;
"RTN","SDAMC",52,0)
RSN1 W ! S DIC="^SD(409.2,",DIC(0)="AEMQ",DIC("S")="I '$P(^(0),U,4),"""_$E(SDWH)_"B""[$P(^(0),U,2)" D ^DIC K DIC
"RTN","SDAMC",53,0)
 I X["^" G RSNQ
"RTN","SDAMC",54,0)
 I Y<0 W *7 G RSN1
"RTN","SDAMC",55,0)
RSNQ Q +Y
"RTN","SDAMC",56,0)
 ;
"RTN","SDAMC",57,0)
REM() ;
"RTN","SDAMC",58,0)
 W ! S DIR(0)="2.98,17" D ^DIR K DIR
"RTN","SDAMC",59,0)
 I $E(X)="^" S Y=-1
"RTN","SDAMC",60,0)
 Q Y
"RTN","SDAMC",61,0)
 ;
"RTN","SDAMC",62,0)
NOPE ;
"RTN","SDAMC",63,0)
 N SDEND,SDPAUSE
"RTN","SDAMC",64,0)
 S:'CNT SDPAUSE=1
"RTN","SDAMC",65,0)
 D NOPE^SDCNP1
"RTN","SDAMC",66,0)
 D:$G(SDPAUSE) PAUSE^VALM1
"RTN","SDAMC",67,0)
 Q
"RTN","SDAMC",68,0)
 ;
"RTN","SDAMC",69,0)
CHK ; -- check if status of appt permits cancelling
"RTN","SDAMC",70,0)
 N SDI S SDI=0
"RTN","SDAMC",71,0)
 F  S SDI=$O(VALMY(SDI)) Q:'SDI  I $D(^TMP("SDAMIDX",$J,SDI)) K SDAT S SDAT=^(SDI) I '$D(^SD(409.63,"ACAN",1,+$$STATUS^SDAM1($P(SDAT,U,2),$P(SDAT,U,3),+$G(^DPT(+$P(SDAT,U,2),"S",+$P(SDAT,U,3),0)),$G(^(0))))) D
"RTN","SDAMC",72,0)
 .W !,^TMP("SDAM",$J,+SDAT,0),!!,*7,"You cannot cancel this appointment."
"RTN","SDAMC",73,0)
 .K VALMY(SDI) D PAUSE^VALM1
"RTN","SDAMC",74,0)
 Q
"VER")
8.0^22.0
"BLD",6213,6)
^SEQ #351
**END**
**END**
