Released SR*3*118 SEQ #117
Extracted from mail message
**KIDS**:SR*3.0*118^

**INSTALL NAME**
SR*3.0*118
"BLD",4929,0)
SR*3.0*118^SURGERY^0^3030818^y
"BLD",4929,1,0)
^^7^7^3030818^
"BLD",4929,1,1,0)
This patch corrects two problems. It corrects the problem in the 
"BLD",4929,1,2,0)
display when entering "Other Procedures" in the Operation [SROMEN-OP]
"BLD",4929,1,3,0)
Option. The display is limited to 15 entries, and sometimes more
"BLD",4929,1,4,0)
than 15 "Other Procedures" entries are needed. The patch also corrects
"BLD",4929,1,5,0)
a problem that occurs when printing the PCE Filing Status report. 
"BLD",4929,1,6,0)
Long names should list the initial for the patient's first name.  
"BLD",4929,1,7,0)
Currently, the report drops the first name completely.
"BLD",4929,4,0)
^9.64PA^^
"BLD",4929,"ABPKG")
n
"BLD",4929,"KRN",0)
^9.67PA^8989.52^19
"BLD",4929,"KRN",.4,0)
.4
"BLD",4929,"KRN",.401,0)
.401
"BLD",4929,"KRN",.402,0)
.402
"BLD",4929,"KRN",.403,0)
.403
"BLD",4929,"KRN",.5,0)
.5
"BLD",4929,"KRN",.84,0)
.84
"BLD",4929,"KRN",3.6,0)
3.6
"BLD",4929,"KRN",3.8,0)
3.8
"BLD",4929,"KRN",9.2,0)
9.2
"BLD",4929,"KRN",9.8,0)
9.8
"BLD",4929,"KRN",9.8,"NM",0)
^9.68A^2^2
"BLD",4929,"KRN",9.8,"NM",1,0)
SRCUSS0^^0^B17954074
"BLD",4929,"KRN",9.8,"NM",2,0)
SROPCE0B^^0^B21648800
"BLD",4929,"KRN",9.8,"NM","B","SRCUSS0",1)

"BLD",4929,"KRN",9.8,"NM","B","SROPCE0B",2)

"BLD",4929,"KRN",19,0)
19
"BLD",4929,"KRN",19.1,0)
19.1
"BLD",4929,"KRN",101,0)
101
"BLD",4929,"KRN",409.61,0)
409.61
"BLD",4929,"KRN",771,0)
771
"BLD",4929,"KRN",870,0)
870
"BLD",4929,"KRN",8989.51,0)
8989.51
"BLD",4929,"KRN",8989.52,0)
8989.52
"BLD",4929,"KRN",8994,0)
8994
"BLD",4929,"KRN",8994,"NM",0)
^9.68A^^
"BLD",4929,"KRN","B",.4,.4)

"BLD",4929,"KRN","B",.401,.401)

"BLD",4929,"KRN","B",.402,.402)

"BLD",4929,"KRN","B",.403,.403)

"BLD",4929,"KRN","B",.5,.5)

"BLD",4929,"KRN","B",.84,.84)

"BLD",4929,"KRN","B",3.6,3.6)

"BLD",4929,"KRN","B",3.8,3.8)

"BLD",4929,"KRN","B",9.2,9.2)

"BLD",4929,"KRN","B",9.8,9.8)

"BLD",4929,"KRN","B",19,19)

"BLD",4929,"KRN","B",19.1,19.1)

"BLD",4929,"KRN","B",101,101)

"BLD",4929,"KRN","B",409.61,409.61)

"BLD",4929,"KRN","B",771,771)

"BLD",4929,"KRN","B",870,870)

"BLD",4929,"KRN","B",8989.51,8989.51)

"BLD",4929,"KRN","B",8989.52,8989.52)

"BLD",4929,"KRN","B",8994,8994)

"BLD",4929,"QUES",0)
^9.62^^
"BLD",4929,"REQB",0)
^9.611^2^2
"BLD",4929,"REQB",1,0)
SR*3.0*86^2
"BLD",4929,"REQB",2,0)
SR*3.0*108^2
"BLD",4929,"REQB","B","SR*3.0*108",2)

"BLD",4929,"REQB","B","SR*3.0*86",1)

"MBREQ")
0
"PKG",308,-1)
1^1
"PKG",308,0)
SURGERY^SR^SURGICAL DATA COLLECTION AND OPERATIONS SCHEDULING
"PKG",308,20,0)
^9.402P^^
"PKG",308,22,0)
^9.49I^1^1
"PKG",308,22,1,0)
3.0^2930624^2940818
"PKG",308,22,1,"PAH",1,0)
118^3030818^100104
"PKG",308,22,1,"PAH",1,1,0)
^^7^7^3030818
"PKG",308,22,1,"PAH",1,1,1,0)
This patch corrects two problems. It corrects the problem in the 
"PKG",308,22,1,"PAH",1,1,2,0)
display when entering "Other Procedures" in the Operation [SROMEN-OP]
"PKG",308,22,1,"PAH",1,1,3,0)
Option. The display is limited to 15 entries, and sometimes more
"PKG",308,22,1,"PAH",1,1,4,0)
than 15 "Other Procedures" entries are needed. The patch also corrects
"PKG",308,22,1,"PAH",1,1,5,0)
a problem that occurs when printing the PCE Filing Status report. 
"PKG",308,22,1,"PAH",1,1,6,0)
Long names should list the initial for the patient's first name.  
"PKG",308,22,1,"PAH",1,1,7,0)
Currently, the report drops the first name completely.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
2
"RTN","SRCUSS0")
0^1^B17954074
"RTN","SRCUSS0",1,0)
SRCUSS0 ;TAMPA/CFB - SCREEN SERVER ; [ 03/11/02  13:37 PM ]
"RTN","SRCUSS0",2,0)
 ;;3.0; Surgery ;**66,108,118**;24 Jun 93
"RTN","SRCUSS0",3,0)
CO S Q(12,1)=$P(Q(2),":",1),Q(12,2)=$P(Q(2),":",2),Q(12,0)="",Q(12,8)=0 F Q(12,7)=+Q(12,1):0:+Q(12,2) D COM Q:Q(12,8)!(Q(12,7)>+Q(12,2))  I $L(Q(12,0))+$L(Q0(Q,0))>100 D COM1 Q
"RTN","SRCUSS0",4,0)
 S Q(2)=Q(12,1),Q0(Q,0)=Q(12,1)_";"_Q(12,0)_Q(12,2)_";"_Q0(Q,0) Q
"RTN","SRCUSS0",5,0)
COM S Q(12,7)=$O(@("^DD("_+Q(0,Q)_","_Q(12,7)_")")) S:Q(12,7)'?1NP.NP!(Q(12,7)="")!(Q(12,7)'<Q(12,2)) Q(12,8)=1 Q:Q(12,8)  S Q(12,0)=Q(12,0)_Q(12,7)_";" Q
"RTN","SRCUSS0",6,0)
COM1 S Q(12,0)=$E(Q(12,0),1,$L(Q(12,0))-1)_":" Q
"RTN","SRCUSS0",7,0)
M W:Q("ED") Q("NOR") S Q=Q+1,(Q(1,Q),Q(13),Q0(0,Q))=1,Q(0,Q)=$P(Q(3),U,2)
"RTN","SRCUSS0",8,0)
 I $D(^DD(+Q(0,Q),.01,12.1)) X ^(12.1) S Q("S",Q,"MUL")=DIC("S") K DIC("S")
"RTN","SRCUSS0",9,0)
 S Q(8,Q)=Q(8,Q-1)_Q(9,Q-1)_","_$C(34)_$P($P(Q(3),U,4),";",1)_$C(34)_",",Q3(Q)=$P(Q(3),U,1),Q0(Q,Q0(0,Q))=Q3(Q)_";.01;",Q(10,Q)=0
"RTN","SRCUSS0",10,0)
 K:$S('$D(Q(12,4)):0,+Q(12,4)=Q&(Q(12,4)["S"):1,1:0) Q(12,4) G:$D(Q(12,4)) MQ1
"RTN","SRCUSS0",11,0)
 I @("'($D("_Q(8,Q)_"0))#2)") S @(Q(8,Q)_"0)")=$P(Q(3),U,1,2)
"RTN","SRCUSS0",12,0)
 I $D(Q(14)),'$D(^DIE(Q(14),"DR",Q,+Q(0,Q))) G MQ1
"RTN","SRCUSS0",13,0)
M00 X Q(0)
"RTN","SRCUSS0",14,0)
 S Q("LIMIT")=$S(Q3("2")="OTHER PROCEDURES":75,1:19),Q("LINE")=0
"RTN","SRCUSS0",15,0)
 I Q("LIMIT")=19,$P(@(Q(8,Q)_"0)"),U,4)>14 W Q("HI") S DIC=Q(8,Q),DIC(0)="QAEM" K DIC("V") D ^DIC G MP
"RTN","SRCUSS0",16,0)
M0 I Q("LIMIT")>19,Q("1",Q)>16 D CONT G:+Q(1)>0 M11A I Q(1)="^" S Q(13)=1 K Q(11),Q(13,0) G M11
"RTN","SRCUSS0",17,0)
 K Q(13,0) G:Q(10,Q)'=+Q(10,Q) MQ1 S (DA(Q),Q(7,Q(1,Q)),Q(9,Q),Q(10,Q))=$O(@(Q(8,Q)_Q(10,Q)_")")) G:Q(10,Q)'=+Q(10,Q)!(Q(10,Q)<1) M1 D A^SRCUSS S Q4(-4,Q(1,Q)-1)=Q(7) I Q(13)#Q("LIMIT") G M0
"RTN","SRCUSS0",18,0)
 ;S Q(13,0)="" G M11
"RTN","SRCUSS0",19,0)
M1 W !,Q(1,Q),?5,"NEW ENTRY" S Q(7,Q(1,Q))=$S(Q(1,Q)=1:1,1:Q(7,Q(1,Q)-1)+1),Q(13)=1 K Q(11),Q(13,0)
"RTN","SRCUSS0",20,0)
 S:$P(Q(3),"^",5,99)["D IX^DIC" Q("S",Q,"IX")=$P(Q(3),"^",5,99)
"RTN","SRCUSS0",21,0)
M11 K QPQPQ W Q("HI") W !!,"Enter Screen Server Function:  " R Q(1):DTIME S:'$T Q(1)="" S:Q(1)=0 Q(1)="?" S:Q(1)="a" Q(1)="A" I Q("LIMIT")=19,Q(1)>15 S Q(1)="?"
"RTN","SRCUSS0",22,0)
M11A S:Q(1)?.E1C.E Q(1)="?" I Q(1)["?"!(Q(1)?2.99A) D QUES^SRCUSS5 G MQ
"RTN","SRCUSS0",23,0)
 S:$S(Q(1)="^^":1,$E(Q(1))'="L":0,+$E(Q(1),2,99)<Q:1,1:0) Q(12,4)=$E(Q(1),2,99) G:$D(Q(13,0))&(Q(1)="") M00 K Q(13,0)
"RTN","SRCUSS0",24,0)
 S Q8(2)=0 I Q(1,Q)=+Q(1),Q(1)["N" S Q8(2)=1 S:+Q(1)=1 Q(3)=^DD(+$P(Q(3),U,2),.01,0) G M110
"RTN","SRCUSS0",25,0)
 I +Q(1)>0,$E(Q(1),$L(Q(1)))="R",+Q(1)<Q(1,Q),$D(Q4(-4,+Q(1))) G M110
"RTN","SRCUSS0",26,0)
 I (Q(1)=""&(Q(13)=1))!(Q(1)[U) G MQ1
"RTN","SRCUSS0",27,0)
 G M11:Q(1)'=+Q(1)!(Q(1)<1)!(Q(1)>Q(1,Q)),M0:Q(1)="" S (DA(Q),Q(9,Q))=Q(7,Q(1)),Q(13)=1
"RTN","SRCUSS0",28,0)
M110 I '$D(Q3("VIEW")),(+Q(1)=Q(1,Q)!(Q(1)["R")) S:Q(1)=1 @("Q(3)=^DD("_+$P(Q(3),U,2)_",.01,0)") S DIC=Q(8,Q),DIC(0)="ZMEL"_$S(Q(1)'["R":"QA",1:""),DIC("DR")=.01
"RTN","SRCUSS0",29,0)
 S Q(1)=+Q(1)
"RTN","SRCUSS0",30,0)
 I $T S:$D(Q("S",Q,"MUL")) DIC("S")=Q("S",Q,"MUL")
"RTN","SRCUSS0",31,0)
 I $T S:$D(Q4(-4,Q(1))) X=$C(34)_Q4(-4,Q(1))_$C(34) K DIC("V") D SET,^DIC K DIC("S") G MQ:+Y<1 S @("Q(9,Q)=$P("_DIC_"0),U,3)"),Q4(-4,Q(1))=+Y(0),Q(7)=Q4(-4,Q(1)),Q("BP")="" D:$P(Q(3),U,2)["P" P^SRCUSS S Q4(-4,Q(1))=Q(7) K Q("BP") G M110:Q8(2)
"RTN","SRCUSS0",32,0)
M111 ;
"RTN","SRCUSS0",33,0)
 I $D(Q3("VIEW")),Q(1)=Q(1,Q) G MQ
"RTN","SRCUSS0",34,0)
 S Q3(Q)=$E(Q3(Q)_"  ("_Q4(-4,Q(1)),1,60)_")" K Q4
"RTN","SRCUSS0",35,0)
M12 I $D(Q(14)) K Q(10) S (Q(1,Q),Q(13),Q0(0,Q))=1 X Q(0) D TEMC^SRCUSS4,A^SRCUSS:'(+$P(Q0(Q,1),";",2)'=".01"&($P(Q0(Q,1),";",3)="")) G MQ
"RTN","SRCUSS0",36,0)
 I $E(Q(12,5),1,2)="DR",$D(DR(Q,+Q(0,Q)))#2 K Q(10) S Q7="DR("_Q_","_+Q(0,Q)_")",(Q(1,Q),Q(13),Q0(0,Q))=1 X Q(0) D PAGE^SRCUSS4,A^SRCUSS:'($P(Q0(Q,1),";",2)=".01"&($P(Q0(Q,1),";",3)="")) G MQ
"RTN","SRCUSS0",37,0)
 S (Q("P",Q),Q8,Q6)=1,Q0(Q,0)=".01:999999999" D PA1^SRCUSS4
"RTN","SRCUSS0",38,0)
M2 K Q(10,Q) S (Q(1,Q),Q(13))=1 X Q(0) D A^SRCUSS K Q(1,Q) S Q=Q-1,Q(1,Q)=1 S Q(1)="Q",Q(3)=Q(2,Q,Q2(Q,1)) G M
"RTN","SRCUSS0",39,0)
MQ W:Q("ED") Q("HI") K Q8(2),Q(10,Q),Q0(Q),Q("S",Q) S Q=Q-1,Q(1)="Q",Q(13)=1,Q(3)=Q(2,Q,Q2(Q,1)),Q(0,Q+1)=$P(Q(3),U,2) G M
"RTN","SRCUSS0",40,0)
MQ1 W:Q("ED") Q("HI") K Q8(2),Q(10,Q),Q0(Q),Q("S",Q) S Q=Q-1,Q(1)="Q",Q(13)=1,Q(12,12)="" Q
"RTN","SRCUSS0",41,0)
MP X Q(0) S Q(1,Q)=1 G M1:Y<1 S (DA(Q),Q(7,Q(1,Q)),Q(9,Q),Q(10,Q))=+Y D A^SRCUSS S Q4(-4,Q(1,Q)-1)=Q(7) G M1
"RTN","SRCUSS0",42,0)
SET S QQ=$S(Q>1:Q-1,1:1) F Q8=1:1:QQ S QQQ=$S(Q>1:Q-Q8,1:1),DA(Q8)=Q(9,QQQ)
"RTN","SRCUSS0",43,0)
 Q
"RTN","SRCUSS0",44,0)
CONT ;
"RTN","SRCUSS0",45,0)
 S:Q("LINE")>15 Q("LINE")=0
"RTN","SRCUSS0",46,0)
 I Q("LINE")=0 W !!,"Press <RETURN> to see more, '^' to exit this list, OR",!,"CHOOSE 1-",Q("1",Q)-1,": " R Q(1):DTIME S:'$T Q(1)="" S:+Q(1)'>0&(Q(1)'="^") Q(1)=""
"RTN","SRCUSS0",47,0)
 S Q("LINE")=Q("LINE")+1
"RTN","SRCUSS0",48,0)
 Q
"RTN","SROPCE0B")
0^2^B21648800
"RTN","SROPCE0B",1,0)
SROPCE0B ;BIR/ADM-PCE Filing Status Report, Short Form ; [ 12/16/98  2:10 PM ]
"RTN","SROPCE0B",2,0)
 ;;3.0; Surgery ;**58,62,69,77,50,86,118**;24 Jun 93
"RTN","SROPCE0B",3,0)
 ;
"RTN","SROPCE0B",4,0)
 ; Reference to ^ECC(723 supported by DBIA #205
"RTN","SROPCE0B",5,0)
 ; Reference to ^SCE("AVSIT" supported by DBIA #2045
"RTN","SROPCE0B",6,0)
 ; Reference to File #409.68 supported by DBIA #2045
"RTN","SROPCE0B",7,0)
 ;
"RTN","SROPCE0B",8,0)
 D HDR F  S SRSDT=$O(^SRF("AC",SRSDT)) Q:'SRSDT!(SRSDT>SRSEDT)!SRSOUT  S SRTN=0 F  S SRTN=$O(^SRF("AC",SRSDT,SRTN)) Q:'SRTN  I $D(^SRF(SRTN,0)),$$DIV^SROUTL0(SRTN),$P($G(^SRF(SRTN,30)),"^")="" D UTIL Q:SRSOUT
"RTN","SROPCE0B",9,0)
 D:'SRSOUT TOTAL
"RTN","SROPCE0B",10,0)
 Q
"RTN","SROPCE0B",11,0)
TOTAL D:$Y+9>IOSL PAGE Q:SRSOUT  W !!,?13,"FILED: ",$J(CNT(1),5),!,?4,"QUEUED TO FILE: ",$J(CNT(2),5),!,?5,"UPDATE QUEUED: "_$J(CNT(3),5),!,?8,"NOT QUEUED: "_$J(CNT(4),5)
"RTN","SROPCE0B",12,0)
 F I=1:1:5 S CNT(6)=CNT(6)+CNT(I)
"RTN","SROPCE0B",13,0)
 W:CNT(5) !,?9,"UNCERTAIN: "_$J(CNT(5),5) W !,?20,"-----",!,?7,"TOTAL CASES: ",$J(CNT(6),5)
"RTN","SROPCE0B",14,0)
 Q
"RTN","SROPCE0B",15,0)
UTIL ; process case
"RTN","SROPCE0B",16,0)
 S SRDIV=$P($G(^SRF(SRTN,8)),"^") I SRDIV S SRSPS=$O(^SRO(133,"B",SRDIV,0))
"RTN","SROPCE0B",17,0)
 I 'SRDIV S SRSPS=SRSITE
"RTN","SROPCE0B",18,0)
 S X=^SRO(133,SRSPS,0),SRPARAM=$P(X,"^",15),SRSR=$P(X,"^",19) I SRPARAM=""!(SRPARAM="N") Q
"RTN","SROPCE0B",19,0)
 S SRINOUT=$P(^SRF(SRTN,0),"^",12) I SRPARAM="O",SRINOUT'="",SRINOUT'="O" Q
"RTN","SROPCE0B",20,0)
 S SRNON=0 I $P($G(^SRF(SRTN,"NON")),"^")="Y" S SRNON=1
"RTN","SROPCE0B",21,0)
 I SRFLG=1!(SRFLG=3&('SRNON)),'$P($G(^SRF(SRTN,.2)),"^",12) Q
"RTN","SROPCE0B",22,0)
 I SRFLG=2!(SRFLG=3&SRNON),'$P($G(^SRF(SRTN,"NON")),"^",5) Q
"RTN","SROPCE0B",23,0)
 I (SRFLG=2&('SRNON))!(SRFLG=1&(SRNON)) Q
"RTN","SROPCE0B",24,0)
 S SRSS=$S('SRNON:$P(^SRF(SRTN,0),"^",4),1:$P(^SRF(SRTN,"NON"),"^",8)) I SRSPEC,SRSPEC'=SRSS Q
"RTN","SROPCE0B",25,0)
 S SRSSNM=$S('SRNON:$P(^SRO(137.45,SRSS,0),"^"),1:$P(^ECC(723,SRSS,0),"^"))
"RTN","SROPCE0B",26,0)
 I SRPARAM="O",SRINOUT="" S SRSTATUS=5,CNT(5)=CNT(5)+1 D CASE,CHK^SROPCE0,MISS Q
"RTN","SROPCE0B",27,0)
 I $P(^SRF(SRTN,0),"^",15) S X=$G(^SRF("APCE",SRTN)),Z=$S(X:3,1:1),SRSTATUS=Z,CNT(Z)=CNT(Z)+1 D CASE,LINE Q
"RTN","SROPCE0B",28,0)
 I $D(^SRF("APCE",SRTN)),^SRF("APCE",SRTN)="" S SRSTATUS=2,CNT(2)=CNT(2)+1 D CASE,LINE Q
"RTN","SROPCE0B",29,0)
 S SRSTATUS=4,CNT(4)=CNT(4)+1 D CASE,CHK^SROPCE0,MISS
"RTN","SROPCE0B",30,0)
 Q
"RTN","SROPCE0B",31,0)
MISS ; list fields missing data
"RTN","SROPCE0B",32,0)
 Q:SRSOUT  S SRFLD="" S SRFLD=$O(SRX(SRFLD)) I SRFLD="" W !,?15,"No Missing Information" D LINE Q
"RTN","SROPCE0B",33,0)
 S SRCT=1,SRFLD="" W !!,?15,"Missing Information:" F  S SRFLD=$O(SRX(SRFLD)) Q:SRFLD=""  D:$Y+5>IOSL PAGE Q:SRSOUT  W !,$J(SRCT_". ",20),SRX(SRFLD) S SRCT=SRCT+1
"RTN","SROPCE0B",34,0)
LINE I 'SRSOUT W ! F I=1:1:80 W "-"
"RTN","SROPCE0B",35,0)
 Q
"RTN","SROPCE0B",36,0)
SCHED ; get appointment status from Scheduling
"RTN","SROPCE0B",37,0)
 N SRENC,SRVSIT,SRX S SRSCHED="<NONE>",SRVSIT=$P(SR(0),"^",15) Q:'SRVSIT
"RTN","SROPCE0B",38,0)
 S SRENC=$O(^SCE("AVSIT",SRVSIT,0)) Q:'SRENC
"RTN","SROPCE0B",39,0)
 S DA=SRENC,DIC=409.68,DR=".12",DIQ="SRX",DIQ(0)="E" D EN^DIQ1 K DA,DIC,DIQ,DR
"RTN","SROPCE0B",40,0)
 I SRX(409.68,SRENC,.12,"E")="INPATIENT APPOINTMENT" S SRX(409.68,SRENC,.12,"E")="INPATIENT APPT"
"RTN","SROPCE0B",41,0)
 S X=SRX(409.68,SRENC,.12,"E") I X'="" S SRSCHED=X
"RTN","SROPCE0B",42,0)
 Q
"RTN","SROPCE0B",43,0)
CASE ; print case info
"RTN","SROPCE0B",44,0)
 D:$Y+9>IOSL PAGE Q:SRSOUT  D DEM,PROC,SCHED
"RTN","SROPCE0B",45,0)
 W !,SRSDATE,?22,SRSNM,?44,SRSSN_"  ("_SRAGE_")",?66,$S(SRSTATUS=1:"FILED",SRSTATUS=2:"QUEUED TO FILE",SRSTATUS=3:"UPDATE QUEUED",SRSTATUS=4:"NOT QUEUED",1:"UNCERTAIN")
"RTN","SROPCE0B",46,0)
 W !,SRTN,?22,$E(SRSSNM,1,20),?66,$E(SRSCHED,1,14),! W:(SRFLG=3)&SRNON "NON-O.R." W ?22,SRPROC(1) W:$D(SRPROC(2)) !,?22,SRPROC(2) W:$D(SRPROC(3)) !,?22,SRPROC(3)
"RTN","SROPCE0B",47,0)
 Q
"RTN","SROPCE0B",48,0)
DEM ; get patient demographic information
"RTN","SROPCE0B",49,0)
 S SR(0)=^SRF(SRTN,0),DFN=$P(SR(0),"^") D DEM^VADPT S SRSNM=VADM(1),SRSSN=VA("PID"),Y=SRSDT X ^DD("DD") S SRSDATE=Y,X1=$E(SRSDT,1,7),X2=$P(VADM(3),"^"),SRAGE=$E(X1,1,3)-$E(X2,1,3)-($E(X1,4,7)<$E(X2,4,7))
"RTN","SROPCE0B",50,0)
 I $L(SRSNM)>20 S SRSNM=$P(VADM(1),",")_","_$E($P(VADM(1),",",2))_"."
"RTN","SROPCE0B",51,0)
 Q
"RTN","SROPCE0B",52,0)
PROC ; get principal procedure
"RTN","SROPCE0B",53,0)
 K SRPROC S X=$P(^SRF(SRTN,"OP"),"^") I $L(X)<56 S SRPROC(1)=X
"RTN","SROPCE0B",54,0)
 I $L(X)>55 S K=1 F  D  I $L(X)<56 S SRPROC(K)=X Q
"RTN","SROPCE0B",55,0)
 .F I=0:1:54 S J=55-I,Y=$E(X,J) I Y=" " S SRPROC(K)=$E(X,1,J-1),X=$E(X,J+1,$L(X)) S K=K+1 Q
"RTN","SROPCE0B",56,0)
 Q
"RTN","SROPCE0B",57,0)
PAGE I $E(IOST)="P"!SRHDR G HDR
"RTN","SROPCE0B",58,0)
 W ! K DIR S DIR(0)="E" D ^DIR K DIR I $D(DTOUT)!$D(DUOUT) S SRSOUT=1 Q
"RTN","SROPCE0B",59,0)
HDR ; print heading
"RTN","SROPCE0B",60,0)
 I $D(ZTQUEUED) D ^SROSTOP I SRHALT S SRSOUT=1 Q
"RTN","SROPCE0B",61,0)
 W:$Y @IOF W:$E(IOST)="P" !,?(80-$L(SRINST)\2),SRINST W !,?(80-$L(SRRPT)\2),SRRPT,?70,$J("PAGE "_SRPAGE,9),!,?(80-$L(SRTITLE)\2),SRTITLE,!,?(80-$L(SRFRTO)\2),SRFRTO W:$E(IOST)="P" !,?(80-$L(SRPRINT)\2),SRPRINT
"RTN","SROPCE0B",62,0)
 W !!,"DATE OF "_$S(SRFLG=1:"OPERATION",SRFLG=2:"PROCEDURE",1:"OP/PROCEDURE"),?22,"PATIENT NAME",?44,"PATIENT ID  (AGE)",?66,"FILING STATUS",!,"CASE #",?22,"SPECIALTY",?66,"SCHED STATUS",!,?22,"PRINCIPAL PROCEDURE"
"RTN","SROPCE0B",63,0)
 S SRHDR=0,SRPAGE=SRPAGE+1 W ! F I=1:1:80 W "="
"RTN","SROPCE0B",64,0)
 Q
"VER")
8.0^22
**END**
**END**
