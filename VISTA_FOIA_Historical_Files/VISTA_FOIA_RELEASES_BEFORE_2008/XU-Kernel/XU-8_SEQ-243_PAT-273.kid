Released XU*8*273 SEQ #243
Extracted from mail message
**KIDS**:XU*8.0*273^

**INSTALL NAME**
XU*8.0*273
"BLD",635,0)
XU*8.0*273^KERNEL^0^3030221^y
"BLD",635,1,0)
^^2^2^3030220^^
"BLD",635,1,1,0)
PATCH XU*8*273 SWITCH IDENTITIES FIX.
"BLD",635,1,2,0)
Please refer to the Description in FORUM Patch Module for details.
"BLD",635,4,0)
^9.64PA^^
"BLD",635,"ABPKG")
n
"BLD",635,"KRN",0)
^9.67PA^8989.52^19
"BLD",635,"KRN",.4,0)
.4
"BLD",635,"KRN",.401,0)
.401
"BLD",635,"KRN",.402,0)
.402
"BLD",635,"KRN",.403,0)
.403
"BLD",635,"KRN",.5,0)
.5
"BLD",635,"KRN",.84,0)
.84
"BLD",635,"KRN",3.6,0)
3.6
"BLD",635,"KRN",3.8,0)
3.8
"BLD",635,"KRN",9.2,0)
9.2
"BLD",635,"KRN",9.8,0)
9.8
"BLD",635,"KRN",9.8,"NM",0)
^9.68A^2^2
"BLD",635,"KRN",9.8,"NM",1,0)
XQ2^^0^B19519205
"BLD",635,"KRN",9.8,"NM",2,0)
XUS91^^0^B15540681
"BLD",635,"KRN",9.8,"NM","B","XQ2",1)

"BLD",635,"KRN",9.8,"NM","B","XUS91",2)

"BLD",635,"KRN",19,0)
19
"BLD",635,"KRN",19.1,0)
19.1
"BLD",635,"KRN",101,0)
101
"BLD",635,"KRN",409.61,0)
409.61
"BLD",635,"KRN",771,0)
771
"BLD",635,"KRN",870,0)
870
"BLD",635,"KRN",8989.51,0)
8989.51
"BLD",635,"KRN",8989.52,0)
8989.52
"BLD",635,"KRN",8994,0)
8994
"BLD",635,"KRN","B",.4,.4)

"BLD",635,"KRN","B",.401,.401)

"BLD",635,"KRN","B",.402,.402)

"BLD",635,"KRN","B",.403,.403)

"BLD",635,"KRN","B",.5,.5)

"BLD",635,"KRN","B",.84,.84)

"BLD",635,"KRN","B",3.6,3.6)

"BLD",635,"KRN","B",3.8,3.8)

"BLD",635,"KRN","B",9.2,9.2)

"BLD",635,"KRN","B",9.8,9.8)

"BLD",635,"KRN","B",19,19)

"BLD",635,"KRN","B",19.1,19.1)

"BLD",635,"KRN","B",101,101)

"BLD",635,"KRN","B",409.61,409.61)

"BLD",635,"KRN","B",771,771)

"BLD",635,"KRN","B",870,870)

"BLD",635,"KRN","B",8989.51,8989.51)

"BLD",635,"KRN","B",8989.52,8989.52)

"BLD",635,"KRN","B",8994,8994)

"BLD",635,"QUES",0)
^9.62^^
"BLD",635,"REQB",0)
^9.611^^
"MBREQ")
0
"PKG",3,-1)
1^1
"PKG",3,0)
KERNEL^XU^SIGN-ON, SECURITY, MENU DRIVER, DEVICES, TASKMAN^
"PKG",3,20,0)
^9.402P^^0
"PKG",3,22,0)
^9.49I^1^1
"PKG",3,22,1,0)
8.0^2950703^2970507^.5
"PKG",3,22,1,"PAH",1,0)
273^3030221^82
"PKG",3,22,1,"PAH",1,1,0)
^^2^2^3030221
"PKG",3,22,1,"PAH",1,1,1,0)
PATCH XU*8*273 SWITCH IDENTITIES FIX.
"PKG",3,22,1,"PAH",1,1,2,0)
Please refer to the Description in FORUM Patch Module for details.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
2
"RTN","XQ2")
0^1^B19519205
"RTN","XQ2",1,0)
XQ2 ;SEA/MJM - Menu lister & Utilities ; [2/20/03 7:32am]
"RTN","XQ2",2,0)
 ;;8.0;KERNEL;**273**;Jul 10, 1995
"RTN","XQ2",3,0)
 ;
"RTN","XQ2",4,0)
WRITE ;Get data for this option
"RTN","XQ2",5,0)
 S XQSN=$P(X,U,(J*8+1)),XQNM=$P(X,U,(J*8+2)),XQTXT=$P(X,U,(J*8+3)),XQOO=$P(X,U,(J*8+4)),XQLK=$P(X,U,(J*8+5)),XQTM=$P(X,U,(J*8+6)),XQRD=$P(X,U,(J*8+7)),XQRL=$P(X,U,(J*8+8))
"RTN","XQ2",6,0)
 Q:'$S($L(XQLK):XQUR="??"&(DUZ(0)="@"!(DUZ(0)="#")!($D(DUZ("SAV"))))!$D(^XUSEC(XQLK,DUZ)),1:1)
"RTN","XQ2",7,0)
 Q:'$S($L(XQRL):XQUR="??"&(DUZ(0)="@"!(DUZ(0)="#")!($D(DUZ("SAV"))))!'$D(^XUSEC(XQRL,DUZ)),1:1)
"RTN","XQ2",8,0)
 W !?3,XQSN,?10,XQTXT D MR:XQUR["??" S XQL=XQL-1 I 'XQL D PAUSE Q:'XQL
"RTN","XQ2",9,0)
 I $L(XQOO) W !,?13,"**> Out of order:  ",XQOO S XQL=XQL-1 I 'XQL D PAUSE Q:'XQL
"RTN","XQ2",10,0)
 I $L(XQTM) W !,?13,"**> Not available on ",$P(X,U,(J*8+6)) S XQL=XQL-1 I 'XQL D PAUSE Q:'XQL
"RTN","XQ2",11,0)
 I XQRD="y" W !,?13,"**> Can't be run on all devices." S XQL=XQL-1 I 'XQL D PAUSE Q:'XQL
"RTN","XQ2",12,0)
 Q
"RTN","XQ2",13,0)
MR W " ["_XQNM_"]" I XQLK]"" W !,?13,"**> Locked with ",XQLK S XQL=XQL-1 I 'XQL D PAUSE Q:'XQL
"RTN","XQ2",14,0)
 I XQRL]"" W !,?13,"**> Reverse lock ",XQRL S XQL=XQL-1 I 'XQL D PAUSE Q:'XQL
"RTN","XQ2",15,0)
 Q
"RTN","XQ2",16,0)
 ;
"RTN","XQ2",17,0)
PAUSE R !!?15,"Press 'RETURN' to continue, '^' to stop: ",XQL:DTIME S XQL=$S(XQL[U:-1,1:XQLN) Q  ;W $C(13),$J("",15),$C(13) Q
"RTN","XQ2",18,0)
 ;
"RTN","XQ2",19,0)
 ;
"RTN","XQ2",20,0)
EN ;Entry point from XQ and XQT2 with +XQDIC
"RTN","XQ2",21,0)
 I XQUR["????" S XQUR="?"_$G(^DIC(19,XQY,"U")) D:$L(XQUR>4) OPT^XQHLP G M2^XQ
"RTN","XQ2",22,0)
 I XQUR["???" G EN^XQHLP
"RTN","XQ2",23,0)
EN1 S XQLN=$S($D(IOSL):IOSL-2,1:18),XQL=XQLN,XQMMF=""
"RTN","XQ2",24,0)
 L +^XUTL("XQO",XQDIC):5 D:$S('($D(^XUTL("XQO",XQDIC,0))#2):1,'$D(^DIC(19,XQDIC,99)):1,1:^DIC(19,XQDIC,99)'=$P(^XUTL("XQO",XQDIC,0),U,2)) ^XQSET L -^XUTL("XQO",XQDIC)
"RTN","XQ2",25,0)
 S XQK=+$G(^XUTL("XQO",XQDIC,0)) W ! F XQI=1:1:XQK Q:XQL<0  S X=^XUTL("XQO",XQDIC,0,XQI) F J=0:1 Q:XQL<0!'$L($P(X,U,(J*8+1))_$P(X,U,(J*8+2)))  D WRITE
"RTN","XQ2",26,0)
 G:XQL<0 BACK S XQJ=$S('$D(^VA(200,DUZ,200)):0,1:+$P(^(200),U,11)) G:(XQUR'="??")&'XQJ BACK
"RTN","XQ2",27,0)
 ;
"RTN","XQ2",28,0)
 I $S('$D(^VA(200,DUZ,203)):1,$P(^(203,0),U,4)'>0:1,1:0) G COM
"RTN","XQ2",29,0)
 S XQDIC="U"_DUZ,XQL=XQL-3 D:XQL<1 PAUSE G:'XQL BACK W !!,"You can also select a secondary option:",!
"RTN","XQ2",30,0)
 D:$S('($D(^XUTL("XQO",XQDIC,0))#2):1,'$D(^VA(200,DUZ,203.1)):1,1:^VA(200,DUZ,203.1)'=$P(^XUTL("XQO",XQDIC,0),U,2)) ^XQSET
"RTN","XQ2",31,0)
 S XQK=+^XUTL("XQO",XQDIC,0) F XQI=1:1:XQK Q:XQL<0  S X=^XUTL("XQO",XQDIC,0,XQI) F J=0:1 Q:XQL<0!'$L($P(X,U,(J*8+1))_$P(X,U,(J*8+2)))  D WRITE G:XQL<0 BACK
"RTN","XQ2",32,0)
 ;
"RTN","XQ2",33,0)
COM S XQL=XQL-3 D:XQL<1 PAUSE G:XQL<0 B2 W !!,"Or a Common Option:",! D:XQL<1 PAUSE G:XQL<0 B2 S XQDIC=$O(^DIC(19,"B","XUCOMMAND",0)) S:XQDIC="" XQDIC=-1
"RTN","XQ2",34,0)
 D:$S('($D(^XUTL("XQO",XQDIC,0)))#2:1,'$D(^DIC(19,XQDIC,99)):1,1:^DIC(19,XQDIC,99)'=$P(^XUTL("XQO",XQDIC,0),U,2)) ^XQSET
"RTN","XQ2",35,0)
 S XQK=+^XUTL("XQO",XQDIC,0) F XQI=1:1:XQK Q:XQL<0  S X=^XUTL("XQO",XQDIC,0,XQI) F J=0:1 Q:XQL<0!'$L($P(X,U,(J*8+1))_$P(X,U,(J*8+2)))  D WRITE
"RTN","XQ2",36,0)
 S XQUR=0
"RTN","XQ2",37,0)
BACK I XQUR["?" W !!,"Enter " W:XQUR="?" "?? for more options, " W "??? for brief descriptions, ?OPTION for help text."
"RTN","XQ2",38,0)
B2 W ! K XQSN,XQNM,XQTXT,XQOO,XQL,XQLK,XQLN,XQTM,XQRD,XQRL,D
"RTN","XQ2",39,0)
 S XQDIC=+^(^XUTL("XQ",$J,"T"))
"RTN","XQ2",40,0)
 G M2^XQ
"RTN","XQ2",41,0)
 ;
"RTN","XQ2",42,0)
M6 ;
"RTN","XQ2",43,0)
 I $E(XQDIC,1)="U" D:$S('($D(^XUTL("XQO",XQDIC,0))#2):1,'$D(^VA(200,DUZ,203.1)):1,1:^VA(200,DUZ,203.1)'=$P(^XUTL("XQO",XQDIC,0),U,2)) ^XQSET
"RTN","XQ2",44,0)
 I XQDIC=+XQDIC L +^XUTL("XQO",XQDIC):5 D:$S('($D(^XUTL("XQO",XQDIC,0))#2):1,'$D(^DIC(19,XQDIC,99)):1,1:^DIC(19,XQDIC,99)'=$P(^XUTL("XQO",XQDIC,0),U,2)) ^XQSET L -^XUTL("XQO",XQDIC)
"RTN","XQ2",45,0)
 Q
"RTN","XQ2",46,0)
LIST S XQK=+^XUTL("XQO",XQDIC,0),XQLN=$S($D(IOSL):IOSL-2,1:18),XQL=XQLN
"RTN","XQ2",47,0)
 F XQI=1:1:XQK Q:XQL<0  S X=^XUTL("XQO",XQDIC,0,XQI) F J=0:1 Q:XQL<0!'$L($P(X,U,(J*8+1))_$P(X,U,(J*8+2)))  D WRITE
"RTN","XQ2",48,0)
 Q
"RTN","XQ2",49,0)
 ;
"RTN","XQ2",50,0)
HS W " [Extended Help Available]" Q
"RTN","XQ2",51,0)
 Q
"RTN","XQ2",52,0)
DISP ;
"RTN","XQ2",53,0)
 S XQDIC=D0,XQUR="?." S X=^DIC(19,D0,0) I $P(X,U,4)="M" W !,"Menu: " S XQL=999 D M6,LIST W ! S X="" K D Q
"RTN","XQ2",54,0)
 I $P(X,U,4)="A" S X="Action: "_$S($D(^DIC(19,D0,20)):^(20),1:"") W !?3,X,! Q
"RTN","XQ2",55,0)
 I $P(X,U,4)="R" S X="Run routine: "_$S($D(^DIC(19,D0,25)):^(25),1:"") W !?3,X,! Q
"RTN","XQ2",56,0)
 I $P(X,U,4)="E" S X="Edit file: "_$S($D(^DIC(19,D0,50)):^(50),1:"") W !?3,X,! Q
"RTN","XQ2",57,0)
 I $P(X,U,4)="P" S X="Print file "_$S($D(^DIC(19,D0,60)):^(60),1:"") W !?3,X,! Q
"RTN","XQ2",58,0)
 Q
"RTN","XUS91")
0^2^B15540681
"RTN","XUS91",1,0)
XUS91 ;SF/STAFF -  REPORT OF USERS SIGNED ON ; [2/20/03 9:19am]
"RTN","XUS91",2,0)
 ;;8.0;KERNEL;**18,65,273**;Jul 10, 1995
"RTN","XUS91",3,0)
 S U="^",XUSUCI="" I $D(^%ZOSF("UCI")) X ^%ZOSF("UCI") S XUSUCI=Y
"RTN","XUS91",4,0)
 S XQHDR="    USER STATUS REPORT      "_XUSUCI
"RTN","XUS91",5,0)
 S %H=$H D YMD^%DTC S DT=X
"RTN","XUS91",6,0)
 W !,"Lookup pass " K ^TMP($J) S XQJN=0
"RTN","XUS91",7,0)
 F I=0:0 S XQJN=$O(^XUTL("XQ",XQJN)) Q:XQJN'>0  S X=XQJN X ^%ZOSF("JOBPARAM") S XQK=$P(Y,U,1) D:(XUSUCI=XQK)!(XQK="UNKNOWN") PASS1
"RTN","XUS91",8,0)
 S IOP="" D ^%ZIS K IOP S XQPG=0,XQUI=0 D NEWPG
"RTN","XUS91",9,0)
PRINT S XQUN=-1 F I=0:0 S XQUN=$O(^TMP($J,XQUN)) Q:(XQUN="")!XQUI  S XQJN=0 F J=0:0 S XQJN=$O(^TMP($J,XQUN,XQJN)) Q:(XQJN="")!XQUI  S XQV=^(XQJN) D LIST
"RTN","XUS91",10,0)
 G END
"RTN","XUS91",11,0)
PASS1 ;
"RTN","XUS91",12,0)
 W "." S XQUN="UNKNOWN" I $D(^XUTL("XQ",XQJN,"DUZ")) S XQUN=^("DUZ"),XQUN=$S($D(^VA(200,XQUN,0)):$P(^(0),U,1),1:"UNKNOWN")
"RTN","XUS91",13,0)
 S XQV="UNKNOWN" I $D(^XUTL("XQ",XQJN,0)) S XQV=$P(^(0),".",2)_"00",XQV=$E(XQV,1,2)_":"_$E(XQV,3,4)
"RTN","XUS91",14,0)
 S XQV=XQV_U_$S('$D(^XUTL("XQ",XQJN,"IO")):"UNKNOWN",1:^("IO"))
"RTN","XUS91",15,0)
 S XQK="UNKNOWN" I $D(^XUTL("XQ",XQJN,"T")),^("T") S XQK=^("T") I $D(^(XQK)) S XQK=$E($P(^(XQK),U,3),1,29)
"RTN","XUS91",16,0)
 I XQK="UNKNOWN",$D(^XUTL("XQ",XQJN,"ZTSK")) S XQJ=^("ZTSK") S:$D(^("XQM")) XQJ=$P(^DIC(19,^("XQM"),0),U,2) S XQK=$E(XQJ,1,18)_" *Tasked"
"RTN","XUS91",17,0)
 S ^TMP($J,XQUN,XQJN)=XQV_U_XQK
"RTN","XUS91",18,0)
 Q
"RTN","XUS91",19,0)
LIST ;
"RTN","XUS91",20,0)
 D:$Y>19 NEWPG Q:XQUI  S (X,Y)=XQJN,X1=16 S:X>32768 Y=$$CNV^XLFUTL(X,16)
"RTN","XUS91",21,0)
 W !,Y,?12,$E(XQUN,1,19),?33,$P(XQV,U,1),?42,$P(XQV,U,2) W:$X>49 ! W ?50,$P(XQV,U,3,99)
"RTN","XUS91",22,0)
 Q
"RTN","XUS91",23,0)
NEWPG ;
"RTN","XUS91",24,0)
 I XQPG,$E(IOST,1)="C" D CON S XQUI=(X="^") Q:XQUI
"RTN","XUS91",25,0)
 D HDR Q
"RTN","XUS91",26,0)
CON ;
"RTN","XUS91",27,0)
 W !!,"Press return to continue or '^' to escape " R X:DTIME S:'$T X=U
"RTN","XUS91",28,0)
 Q
"RTN","XUS91",29,0)
HDR ;
"RTN","XUS91",30,0)
 W @IOF S XQPG=XQPG+1
"RTN","XUS91",31,0)
 S Y=$P($H,",",2)\60,Y=(Y#60/100+(Y\60)/100+DT) D DT^DIO2
"RTN","XUS91",32,0)
 W ?22,XQHDR,?71,"PAGE ",XQPG
"RTN","XUS91",33,0)
 W !!,"JOB NUMBER  USER NAME            TIME ON  DEVICE  CURRENT MENU OPTION"
"RTN","XUS91",34,0)
 W !,"----------  -------------------  -------  ------  ------------------------------"
"RTN","XUS91",35,0)
 Q
"RTN","XUS91",36,0)
END ;
"RTN","XUS91",37,0)
 K XQI,XQJN,XQUN,XUSUCI,ZJ,XQJ,XQK,XQUI,XQPG,XQHDR,XQV,D,J,X,XQM,XQT,Y,Z,^TMP($J)
"RTN","XUS91",38,0)
 Q
"RTN","XUS91",39,0)
 Q
"RTN","XUS91",40,0)
TESTM ;
"RTN","XUS91",41,0)
 W !!,"This option will allow you to simulate signing on as another user to test their",!,"menus and keys.  You can step through menus, but cannot execute options.",!,"Return to your own identity by entering a '*'.",!
"RTN","XUS91",42,0)
 S DIC=200,DIC(0)="AEQMZ" D ^DIC Q:Y<0
"RTN","XUS91",43,0)
 I $S('$D(^VA(200,+Y,201)):1,($P(^VA(200,+Y,201),U,1)=""):1,1:0) W !!,$C(7),"This user has no primary menu.",!,"NOW..Returning to your own identity." Q
"RTN","XUS91",44,0)
 N XUSKFLG S XUSKFLG=$$CHK(+Y)
"RTN","XUS91",45,0)
 I XUSKFLG=-1 D  Q
"RTN","XUS91",46,0)
 .W !!,"   ==>Sorry, Primary Menu for this user is locked."
"RTN","XUS91",47,0)
 .W !,"   NOW..Returning to your own identity."
"RTN","XUS91",48,0)
 S XQY=+^VA(200,+Y,201),DUZ("SAV")=DUZ_U_DUZ(0),DUZ=+Y,DUZ(0)=$P(Y(0),U,4),%=$P(^VA(200,+Y,0),U,1),DUZ("SAV")=DUZ("SAV")_U_$P(%,",",2)_" "_$P(%,",",1) G ^XQ
"RTN","XUS91",49,0)
 Q
"RTN","XUS91",50,0)
TESTN ;
"RTN","XUS91",51,0)
 S DUZ=+DUZ("SAV"),DUZ(0)=$P(DUZ("SAV"),U,2),XQY=+^VA(200,DUZ,201) K DUZ("SAV"),XQUR,XMDUZ
"RTN","XUS91",52,0)
 W !!,"OK...  Returning to your own identity." L  ;Clear all locks
"RTN","XUS91",53,0)
 G ^XQ
"RTN","XUS91",54,0)
CHK(Y) ;
"RTN","XUS91",55,0)
 N XUSPM,XUSPM1,XUSPM2,I,XUSKFLG
"RTN","XUS91",56,0)
 S XUSKFLG=-1
"RTN","XUS91",57,0)
 S XUSPM=$P($G(^VA(200,+Y,201)),"^")
"RTN","XUS91",58,0)
 ;get Key of Primary Menu
"RTN","XUS91",59,0)
 S XUSPM1=$P($G(^DIC(19,XUSPM,0)),"^",6) Q:(XUSPM1="") 0
"RTN","XUS91",60,0)
 S XUSPM2=0 F I=0:0 S XUSPM2=$O(^VA(200,+Y,51,XUSPM2)) Q:XUSPM2'>0  D
"RTN","XUS91",61,0)
 .I $P($G(^DIC(19.1,XUSPM2,0)),"^")=XUSPM1 S XUSKFLG=0
"RTN","XUS91",62,0)
 Q XUSKFLG
"VER")
8.0^22.0
**END**
**END**
