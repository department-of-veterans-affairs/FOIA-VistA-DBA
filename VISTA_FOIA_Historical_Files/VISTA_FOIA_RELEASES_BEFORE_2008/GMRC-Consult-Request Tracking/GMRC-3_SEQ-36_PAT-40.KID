Released GMRC*3*40 SEQ #36
Extracted from mail message
**KIDS**:GMRC*3.0*40^

**INSTALL NAME**
GMRC*3.0*40
"BLD",5918,0)
GMRC*3.0*40^CONSULT/REQUEST TRACKING^0^3050228^y
"BLD",5918,1,0)
^^2^2^3050222^^
"BLD",5918,1,1,0)
This patch addresses the problem where a consult service can become a
"BLD",5918,1,2,0)
subservice within its own subservice hierarchy.
"BLD",5918,4,0)
^9.64PA^123.5^1
"BLD",5918,4,123.5,0)
123.5
"BLD",5918,4,123.5,2,0)
^9.641^123.51^1
"BLD",5918,4,123.5,2,123.51,0)
SUB-SERVICE  (sub-file)
"BLD",5918,4,123.5,2,123.51,1,0)
^9.6411^.01^1
"BLD",5918,4,123.5,2,123.51,1,.01,0)
SUB-SERVICE/SPECIALTY
"BLD",5918,4,123.5,222)
y^n^p^^^^n^^n
"BLD",5918,4,123.5,224)

"BLD",5918,4,"APDD",123.5,123.51)

"BLD",5918,4,"APDD",123.5,123.51,.01)

"BLD",5918,4,"B",123.5,123.5)

"BLD",5918,"KRN",0)
^9.67PA^8989.52^19
"BLD",5918,"KRN",.4,0)
.4
"BLD",5918,"KRN",.401,0)
.401
"BLD",5918,"KRN",.402,0)
.402
"BLD",5918,"KRN",.403,0)
.403
"BLD",5918,"KRN",.5,0)
.5
"BLD",5918,"KRN",.84,0)
.84
"BLD",5918,"KRN",3.6,0)
3.6
"BLD",5918,"KRN",3.8,0)
3.8
"BLD",5918,"KRN",9.2,0)
9.2
"BLD",5918,"KRN",9.8,0)
9.8
"BLD",5918,"KRN",9.8,"NM",0)
^9.68A^1^1
"BLD",5918,"KRN",9.8,"NM",1,0)
GMRCSRVS^^0^B43864564
"BLD",5918,"KRN",9.8,"NM","B","GMRCSRVS",1)

"BLD",5918,"KRN",19,0)
19
"BLD",5918,"KRN",19.1,0)
19.1
"BLD",5918,"KRN",101,0)
101
"BLD",5918,"KRN",409.61,0)
409.61
"BLD",5918,"KRN",771,0)
771
"BLD",5918,"KRN",870,0)
870
"BLD",5918,"KRN",8989.51,0)
8989.51
"BLD",5918,"KRN",8989.52,0)
8989.52
"BLD",5918,"KRN",8994,0)
8994
"BLD",5918,"KRN","B",.4,.4)

"BLD",5918,"KRN","B",.401,.401)

"BLD",5918,"KRN","B",.402,.402)

"BLD",5918,"KRN","B",.403,.403)

"BLD",5918,"KRN","B",.5,.5)

"BLD",5918,"KRN","B",.84,.84)

"BLD",5918,"KRN","B",3.6,3.6)

"BLD",5918,"KRN","B",3.8,3.8)

"BLD",5918,"KRN","B",9.2,9.2)

"BLD",5918,"KRN","B",9.8,9.8)

"BLD",5918,"KRN","B",19,19)

"BLD",5918,"KRN","B",19.1,19.1)

"BLD",5918,"KRN","B",101,101)

"BLD",5918,"KRN","B",409.61,409.61)

"BLD",5918,"KRN","B",771,771)

"BLD",5918,"KRN","B",870,870)

"BLD",5918,"KRN","B",8989.51,8989.51)

"BLD",5918,"KRN","B",8989.52,8989.52)

"BLD",5918,"KRN","B",8994,8994)

"BLD",5918,"QUES",0)
^9.62^^
"BLD",5918,"REQB",0)
^9.611^1^1
"BLD",5918,"REQB",1,0)
GMRC*3.0*16^1
"BLD",5918,"REQB","B","GMRC*3.0*16",1)

"FIA",123.5)
REQUEST SERVICES
"FIA",123.5,0)
^GMR(123.5,
"FIA",123.5,0,0)
123.5I
"FIA",123.5,0,1)
y^n^p^^^^n^^n
"FIA",123.5,0,10)

"FIA",123.5,0,11)

"FIA",123.5,0,"RLRO")

"FIA",123.5,0,"VR")
3.0^GMRC
"FIA",123.5,123.5)
1
"FIA",123.5,123.5,10)

"FIA",123.5,123.51)
1
"FIA",123.5,123.51,.01)

"MBREQ")
0
"PKG",222,-1)
1^1
"PKG",222,0)
CONSULT/REQUEST TRACKING^GMRC^CONSULTS/REQUESTS
"PKG",222,22,0)
^9.49I^1^1
"PKG",222,22,1,0)
3.0^2980101^2990325^66481
"PKG",222,22,1,"PAH",1,0)
40^3050228
"PKG",222,22,1,"PAH",1,1,0)
^^2^2^3050228
"PKG",222,22,1,"PAH",1,1,1,0)
This patch addresses the problem where a consult service can become a
"PKG",222,22,1,"PAH",1,1,2,0)
subservice within its own subservice hierarchy.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
1
"RTN","GMRCSRVS")
0^1^B43864564
"RTN","GMRCSRVS",1,0)
GMRCSRVS ;SLC/DCM,JFR - Add/Edit services in File 123.5. ;6/14/00 12:00
"RTN","GMRCSRVS",2,0)
 ;;3.0;CONSULT/REQUEST TRACKING;**1,16,40**;DEC 27, 1997
"RTN","GMRCSRVS",3,0)
 ;
"RTN","GMRCSRVS",4,0)
EN ;set up services entry point
"RTN","GMRCSRVS",5,0)
 ;GMRCOLDU=Service Usage field. If changed, GMRCOLDU shows the change (See ^DD(123.5,2,0) for field description).
"RTN","GMRCSRVS",6,0)
 N GMRCSAFE,GMRCOLDU,GMRCOLDS,GMRCOSNM,GMRCSRVC,GMRCACT,GMRCSSNM
"RTN","GMRCSRVS",7,0)
 N DIC,DLAYGO,DUOUT,DTOUT
"RTN","GMRCSRVS",8,0)
 S DIC="^GMR(123.5,",DLAYGO=123.5,DIC(0)="AELMQZ",DIC("A")="Select Service/Specialty:"
"RTN","GMRCSRVS",9,0)
 D ^DIC I $S(Y<0:1,$D(DTOUT):1,$D(DUOUT):1,1:0) D END K GMRCMSG,DTOUT,DUOUT Q
"RTN","GMRCSRVS",10,0)
 D
"RTN","GMRCSRVS",11,0)
 .S GMRCSAFE=+$G(^GMR(123.5,+Y,"INT"))
"RTN","GMRCSRVS",12,0)
 .S (DA,GMRCSRVC)=+Y,GMRCOSNM=$P(Y,"^",2),(GMRCOLDU,GMRCOLDS)=""
"RTN","GMRCSRVS",13,0)
 .S GMRCACT=$S('$O(^GMR(123.5,+Y,0)):"MAD",1:"MUP"),GMRCOLDU=$P(^(0),"^",2),GMRCOLDN=$P(^(0),"^",1) S ND=0,GMRCOLDS="" F  S ND=$O(^GMR(123.5,+Y,2,ND)) Q:ND?1A.E!(ND="")  S GMRCOLDS=GMRCOLDS_^GMR(123.5,+Y,2,ND,0)_"^"
"RTN","GMRCSRVS",14,0)
 .S DIE=DIC,DR="[GMRC SETUP REQUEST SERVICE]",DIE("NO^")="OUTOK"
"RTN","GMRCSRVS",15,0)
 .D ^DIE
"RTN","GMRCSRVS",16,0)
 .Q
"RTN","GMRCSRVS",17,0)
 S GMRCACT=$S($P(^GMR(123.5,GMRCSRVC,0),"^",2)=9:"MDC",$P(^(0),"^",2)=1:"MDC",1:GMRCACT) D
"RTN","GMRCSRVS",18,0)
 .S GMRCSSNM=$P(^GMR(123.5,GMRCSRVC,0),"^",1)
"RTN","GMRCSRVS",19,0)
 .I GMRCACT'="MAD",GMRCSSNM'=GMRCOSNM S GMRCACT="MUP"
"RTN","GMRCSRVS",20,0)
 .I $S(GMRCACT'="MAD":1,GMRCACT'="MUP":1,1:0),$L(GMRCOLDU),GMRCOLDU=$P(^GMR(123.5,GMRCSRVC,0),"^",2) S GMRCACT="NOACT"
"RTN","GMRCSRVS",21,0)
 .I $S(GMRCACT="MUP":1,GMRCACT="NOACT":1,1:0),GMRCOLDN'=$P(^GMR(123.5,GMRCSRVC,0),"^",1) S GMRCACT="MUP"
"RTN","GMRCSRVS",22,0)
 .S ND=0 F  S ND=$O(^GMR(123.5,GMRCSRVC,2,ND)) Q:ND?1A.E!(ND="")  I GMRCOLDS'=""&(^GMR(123.5,GMRCSRVC,2,ND,0)'=""),GMRCOLDS'[^GMR(123.5,GMRCSRVC,2,ND,0) S GMRCACT="MUP" Q
"RTN","GMRCSRVS",23,0)
 .I $S(GMRCACT="MAD":1,GMRCACT="MUP":1,GMRCACT="MDC":1,1:0) D SVC^GMRC101H(GMRCSRVC,GMRCSSNM,GMRCACT),MSG^XQOR("GMRC ORDERABLE ITEM UPDATE",.GMRCMSG)
"RTN","GMRCSRVS",24,0)
 .D PTRCLN^GMRCU
"RTN","GMRCSRVS",25,0)
 .Q
"RTN","GMRCSRVS",26,0)
 K GMRCMSG,GMRCSSNM,GMRCSRVS,GMRCOLDN,GMRCOLDS,GMRCOLDU,ND
"RTN","GMRCSRVS",27,0)
 ;Ask to continue...
"RTN","GMRCSRVS",28,0)
 ;
"RTN","GMRCSRVS",29,0)
 N GMRC0,GMRCA,GMRCB,GMRCH,GMRCL
"RTN","GMRCSRVS",30,0)
 S GMRC0="YA",GMRCA="Add/Edit Another Service? ",GMRCB="NO"
"RTN","GMRCSRVS",31,0)
 S GMRCH="Enter 'YES' to add/edit another service, or 'NO' to exit."
"RTN","GMRCSRVS",32,0)
 S GMRCL=2
"RTN","GMRCSRVS",33,0)
 I '+$$READ(GMRC0,GMRCA,GMRCB,GMRCH,GMRCL) D END Q
"RTN","GMRCSRVS",34,0)
 G EN
"RTN","GMRCSRVS",35,0)
 ;
"RTN","GMRCSRVS",36,0)
END K DIC,DIE,DTOUT,DUOUT,DA,DR,FL,GMRCACT,GMRCANS,GMRCMSG,GMRCREA,GMRCSRVC,GMRCSSNM,REVCODE,RLEVCODE,Y
"RTN","GMRCSRVS",37,0)
 Q
"RTN","GMRCSRVS",38,0)
 ;
"RTN","GMRCSRVS",39,0)
READ(GMRC0,GMRCA,GMRCB,GMRCH,GMRCL,GMRCS) ;
"RTN","GMRCSRVS",40,0)
 ;
"RTN","GMRCSRVS",41,0)
 ;  GMRC0 -> DIR(0) --- Type of read
"RTN","GMRCSRVS",42,0)
 ;  GMRCA -> DIR("A") - Prompt
"RTN","GMRCSRVS",43,0)
 ;  GMRCB -> DIR("B") - Default Answer
"RTN","GMRCSRVS",44,0)
 ;  GMRCH -> DIR("?") - Help text or ^Execute code
"RTN","GMRCSRVS",45,0)
 ;  GMRCS -> DIR("S") - Screen
"RTN","GMRCSRVS",46,0)
 ;  GMRCL -> Number of blank lines to put before Prompt
"RTN","GMRCSRVS",47,0)
 ;
"RTN","GMRCSRVS",48,0)
 ;  Returns "^" or answer
"RTN","GMRCSRVS",49,0)
 ;
"RTN","GMRCSRVS",50,0)
 N GMRCLINE,DIR,DTOUT,DUOUT,DIRUT,DIROUT,X,Y
"RTN","GMRCSRVS",51,0)
 Q:'$L($G(GMRC0)) U
"RTN","GMRCSRVS",52,0)
 S DIR(0)=GMRC0
"RTN","GMRCSRVS",53,0)
 S:$L($G(GMRCA)) DIR("A")=GMRCA
"RTN","GMRCSRVS",54,0)
 I $D(GMRCA("A")) M DIR("A")=GMRCA("A")
"RTN","GMRCSRVS",55,0)
 S:$L($G(GMRCB)) DIR("B")=GMRCB
"RTN","GMRCSRVS",56,0)
 I $D(GMRCH("?")) M DIR("?")=GMRCH("?")
"RTN","GMRCSRVS",57,0)
 S:$L($G(GMRCH)) DIR("?")=GMRCH
"RTN","GMRCSRVS",58,0)
 S:$L($G(GMRCS)) DIR("S")=GMRCS
"RTN","GMRCSRVS",59,0)
 F GMRCLINE=1:1:($G(GMRCL)-1) W !
"RTN","GMRCSRVS",60,0)
 D ^DIR
"RTN","GMRCSRVS",61,0)
 I $D(DTOUT)!$D(DUOUT)!$D(DIRUT)!$D(DIROUT) Q U
"RTN","GMRCSRVS",62,0)
 Q Y
"RTN","GMRCSRVS",63,0)
 ;
"RTN","GMRCSRVS",64,0)
NOED(SERV) ;
"RTN","GMRCSRVS",65,0)
 I '$D(^GMR(123.5,+SERV,0)) Q 0
"RTN","GMRCSRVS",66,0)
 N NAME
"RTN","GMRCSRVS",67,0)
 S NAME=$P(^GMR(123.5,+SERV,0),U)
"RTN","GMRCSRVS",68,0)
 I NAME="PROSTHETICS REQUEST" Q 1
"RTN","GMRCSRVS",69,0)
 I NAME="EYEGLASS REQUEST" Q 1
"RTN","GMRCSRVS",70,0)
 I NAME="CONTACT LENS REQUEST" Q 1
"RTN","GMRCSRVS",71,0)
 I NAME="HOME OXYGEN REQUEST" Q 1
"RTN","GMRCSRVS",72,0)
 Q 0
"RTN","GMRCSRVS",73,0)
 ;
"RTN","GMRCSRVS",74,0)
CLONPSAS ; clone a PROSTHETICS service
"RTN","GMRCSRVS",75,0)
 ; choose service and text to append
"RTN","GMRCSRVS",76,0)
 N GMRCSIEN,GMRCROOT,GMRCNWNM
"RTN","GMRCSRVS",77,0)
 N GMRCCPY,GMRCNEW,FDA,GMRCERR,GMRC
"RTN","GMRCSRVS",78,0)
 S GMRC(0)="PAO^GMR(123.5,:AEMQ"
"RTN","GMRCSRVS",79,0)
 S GMRC("A")="Select the Prosthetics Service to clone: "
"RTN","GMRCSRVS",80,0)
 S GMRC("S")="I $$NOED^GMRCSRVS(+Y)"
"RTN","GMRCSRVS",81,0)
 S GMRCCPY=+$$READ(GMRC(0),GMRC("A"),,,2,GMRC("S"))
"RTN","GMRCSRVS",82,0)
 I 'GMRCCPY Q
"RTN","GMRCSRVS",83,0)
 K GMRC
"RTN","GMRCSRVS",84,0)
 S GMRCNWNM=$$GETAPP(GMRCCPY)
"RTN","GMRCSRVS",85,0)
 I '$L(GMRCNWNM) Q
"RTN","GMRCSRVS",86,0)
 S FDA(1,123.5,"+1,",.01)=GMRCNWNM
"RTN","GMRCSRVS",87,0)
 S FDA(1,123.5,"+1,",2)="DISABLED"
"RTN","GMRCSRVS",88,0)
 S FDA(1,123.5,"+1,",1.01)="REQUIRE"
"RTN","GMRCSRVS",89,0)
 S FDA(1,123.5,"+1,",1.02)="LEXICON"
"RTN","GMRCSRVS",90,0)
 S FDA(1,123.5,"+1,",123.01)="CONSULTS"
"RTN","GMRCSRVS",91,0)
 S FDA(1,123.5,"+1,",123.03)="GMRCACTM SERVICE ACTION MENU"
"RTN","GMRCSRVS",92,0)
 S FDA(1,123.5,"+1,",131)="YES"
"RTN","GMRCSRVS",93,0)
 D UPDATE^DIE("E","FDA(1)","GMRCNEW","GMRCERR")
"RTN","GMRCSRVS",94,0)
 I '$D(GMRCNEW) W !,"Failed to create new entry. Please try again" Q
"RTN","GMRCSRVS",95,0)
 W !!,GMRCNWNM," created",!
"RTN","GMRCSRVS",96,0)
 S GMRCSIEN=GMRCNEW(1)_","
"RTN","GMRCSRVS",97,0)
 S GMRCROOT="^GMR(123.5,"_GMRCCPY_",124)"
"RTN","GMRCSRVS",98,0)
 D WP^DIE(123.5,GMRCSIEN,124,,GMRCROOT,"GMRCERR")
"RTN","GMRCSRVS",99,0)
 W !!,"The new Service is currently DISABLED. To activate this service for use in"
"RTN","GMRCSRVS",100,0)
 W !,"the Prosthetics interface, you MUST use the Setup Consult Services option"
"RTN","GMRCSRVS",101,0)
 W !,"and delete the DISABLED flag from the SERVICE USAGE field.",!
"RTN","GMRCSRVS",102,0)
 Q
"RTN","GMRCSRVS",103,0)
GETAPP(GMRIEN) ;get text to append
"RTN","GMRCSRVS",104,0)
 N GMRCNWNM,QTFLG,I,GMRC,GMRCHL,OK
"RTN","GMRCSRVS",105,0)
 S GMRCNWNM=""
"RTN","GMRCSRVS",106,0)
 F I=0:0 D  Q:$G(QTFLG)
"RTN","GMRCSRVS",107,0)
 . W !!
"RTN","GMRCSRVS",108,0)
 . S GMRC(0)="FA^3:40"
"RTN","GMRCSRVS",109,0)
 . S GMRC("A")="Enter text to append to national service name: "
"RTN","GMRCSRVS",110,0)
 . S GMRCHL("?",1)="The text entered will be appended to the name of the exported service"
"RTN","GMRCSRVS",111,0)
 . S GMRCHL("?")="(e.g. If HINES was entered it may appear as PROSTHETICS REQUEST - HINES"
"RTN","GMRCSRVS",112,0)
 . S GMRCNWNM=$$READ(GMRC(0),GMRC("A"),,.GMRCHL,2)
"RTN","GMRCSRVS",113,0)
 . I '$L(GMRCNWNM)!(GMRCNWNM["^") S GMRCNWNM="",QTFLG=1 Q
"RTN","GMRCSRVS",114,0)
 . K GMRC,GMRCHL
"RTN","GMRCSRVS",115,0)
 . S GMRCNWNM=$P(^GMR(123.5,GMRIEN,0),U)_" - "_GMRCNWNM
"RTN","GMRCSRVS",116,0)
 . I $$FIND1^DIC(123.5,,"X",GMRCNWNM) D  Q
"RTN","GMRCSRVS",117,0)
 .. W !!,$C(7),"This service already exists, you'll have to try again!",!
"RTN","GMRCSRVS",118,0)
 .. S GMRCNWNM=""
"RTN","GMRCSRVS",119,0)
 . W !,"The new service name will be:"
"RTN","GMRCSRVS",120,0)
 . W !,?5,GMRCNWNM,!
"RTN","GMRCSRVS",121,0)
 . S OK=+$$READ("Y","Is this OK",,,1)
"RTN","GMRCSRVS",122,0)
 . I OK=U S QTFLG=1 Q
"RTN","GMRCSRVS",123,0)
 . I 'OK S GMRCNWNM="" Q
"RTN","GMRCSRVS",124,0)
 . S QTFLG=1
"RTN","GMRCSRVS",125,0)
 Q GMRCNWNM
"RTN","GMRCSRVS",126,0)
INPUT(X,GMRCDA) ; INPUT TRANSFORM FOR THE SUB-SERVICE/SPECIALTY (#.01) FIELD
"RTN","GMRCSRVS",127,0)
 ; OF THE SUB-SERVICE (#123.51) FILE WHICH IS A SUB-FILE OF THE
"RTN","GMRCSRVS",128,0)
 ; SUB-SERVICE (#10) FIELD OF THE REQUEST SERVICES (#123.5) FILE.
"RTN","GMRCSRVS",129,0)
 ;
"RTN","GMRCSRVS",130,0)
 ; X = INTERNAL VALUE OF USER SELECTED SUB-SERVICE (IEN OF SERVICE
"RTN","GMRCSRVS",131,0)
 ;     IN FILE 123.5)
"RTN","GMRCSRVS",132,0)
 ; GMRCDA = IEN OF INITIAL PARENT SERVICE IN FILE 123.5
"RTN","GMRCSRVS",133,0)
 ;
"RTN","GMRCSRVS",134,0)
 I +$G(X)=0 K X Q
"RTN","GMRCSRVS",135,0)
 I GMRCDA<1 D  Q:'$D(X)
"RTN","GMRCSRVS",136,0)
 . S GMRCDA=+$G(D0)
"RTN","GMRCSRVS",137,0)
 . I GMRCDA<1 K X
"RTN","GMRCSRVS",138,0)
 N GMRPARNT,GMRCHILD,GMRQ,GMRCNT
"RTN","GMRCSRVS",139,0)
 K ^TMP("GMRC INPUT",$J) ;MAKE SURE INPUT PARENT LOG GLOBAL IS BLANK
"RTN","GMRCSRVS",140,0)
 I X=GMRCDA S GMRQ=1 G INPUTQ ;NOT ALLOW SERVICE AS A SUB-SERVICE TO ITSELF
"RTN","GMRCSRVS",141,0)
 S ^TMP("GMRC INPUT",$J,"B",GMRCDA)="" ;USED TO PREVENT DUPLICATE CHECKING OF PARENTS
"RTN","GMRCSRVS",142,0)
 S ^TMP("GMRC INPUT",$J,0)=1 ;USED TO FIND NEXT NUMBER FOR TMP GLOBAL ENTRY
"RTN","GMRCSRVS",143,0)
 S ^TMP("GMRC INPUT",$J,1)=GMRCDA ;PARENT IEN STORED TO BE USED AS CHILD
"RTN","GMRCSRVS",144,0)
 S (GMRCNT,GMRQ)=0
"RTN","GMRCSRVS",145,0)
 F  S GMRCNT=$O(^TMP("GMRC INPUT",$J,GMRCNT)) Q:'GMRCNT  D  Q:GMRQ=1
"RTN","GMRCSRVS",146,0)
 . S GMRCHILD=$G(^TMP("GMRC INPUT",$J,GMRCNT))
"RTN","GMRCSRVS",147,0)
 . S GMRPARNT=0
"RTN","GMRCSRVS",148,0)
 . F  S GMRPARNT=$O(^GMR(123.5,"APC",GMRCHILD,GMRPARNT)) Q:GMRPARNT=""  D  Q:GMRQ=1
"RTN","GMRCSRVS",149,0)
 .. I GMRPARNT=X S GMRQ=1 Q  ;NOT ALLOW SERVICE AS A SUB-SERVICE WITHIN IT'S SUB-SERVICE HIERARCHY
"RTN","GMRCSRVS",150,0)
 .. I '$D(^TMP("GMRC INPUT",$J,"B",GMRPARNT)) D  ;IF NOT IN LIST ADD
"RTN","GMRCSRVS",151,0)
 ... S ^TMP("GMRC INPUT",$J,"B",GMRPARNT)="" ;ADD TO "B" CROSS-REFERENCE
"RTN","GMRCSRVS",152,0)
 ... S ^TMP("GMRC INPUT",$J,0)=$G(^TMP("GMRC INPUT",$J,0))+1 ;INCREASE LAST NUMBER BY 1
"RTN","GMRCSRVS",153,0)
 ... S ^TMP("GMRC INPUT",$J,$G(^TMP("GMRC INPUT",$J,0)))=GMRPARNT ;ADD NEW PARENT SERVICE TO GLOBAL SO IT CAN BE CHECKED AS A CHILD ENTRY TO FIND IT'S PARENTS
"RTN","GMRCSRVS",154,0)
 K ^TMP("GMRC INPUT",$J)
"RTN","GMRCSRVS",155,0)
INPUTQ I GMRQ=1 D EN^DDIOL("A SERVICE CAN NOT BE A SUBSERVICE OF ITSELF","","!!?12") K X Q
"RTN","GMRCSRVS",156,0)
 Q
"UP",123.5,123.51,-1)
123.5^10
"UP",123.5,123.51,0)
123.51
"VER")
8.0^22.0
"^DD",123.5,123.5,10,0)
SUB-SERVICE^123.51P^^10;0
"^DD",123.5,123.5,10,20,0)
^.3LA^^0
"^DD",123.5,123.5,10,21,0)
^.001^4^4^3041213^^^^
"^DD",123.5,123.5,10,21,1,0)
This is the set of services or specialties that may be grouped under
"^DD",123.5,123.5,10,21,2,0)
the Service/Specialty.  A member of this sub-service may also be defined
"^DD",123.5,123.5,10,21,3,0)
to have its own sub-service/specialties. There is no limit to the
"^DD",123.5,123.5,10,21,4,0)
depth of the hierarchy beneath ALL SERVICES.
"^DD",123.5,123.5,10,"DT")
3010820
"^DD",123.5,123.51,0)
SUB-SERVICE SUB-FIELD^^2^2
"^DD",123.5,123.51,0,"NM","SUB-SERVICE")

"^DD",123.5,123.51,.01,0)
SUB-SERVICE/SPECIALTY^MP123.5'X^GMR(123.5,^0;1^S GMRCDA=+$G(DA(1)) D INPUT^GMRCSRVS(.X,GMRCDA)
"^DD",123.5,123.51,.01,1,0)
^.1
"^DD",123.5,123.51,.01,1,1,0)
123.51^B
"^DD",123.5,123.51,.01,1,1,1)
S ^GMR(123.5,DA(1),10,"B",$E(X,1,30),DA)=""
"^DD",123.5,123.51,.01,1,1,2)
K ^GMR(123.5,DA(1),10,"B",$E(X,1,30),DA)
"^DD",123.5,123.51,.01,1,2,0)
123.5^APC^MUMPS
"^DD",123.5,123.51,.01,1,2,1)
S ^GMR(123.5,"APC",$E(X,1,30),DA(1),DA)=""
"^DD",123.5,123.51,.01,1,2,2)
K ^GMR(123.5,"APC",$E(X,1,30),DA(1),DA)
"^DD",123.5,123.51,.01,1,2,"%D",0)
^.101^3^3^3000615^^^
"^DD",123.5,123.51,.01,1,2,"%D",1,0)
This cross-reference is used to find the parents of a given service. This
"^DD",123.5,123.51,.01,1,2,"%D",2,0)
helps identify AC cross-references that need to be updated when the .01
"^DD",123.5,123.51,.01,1,2,"%D",3,0)
name changes, and helps manage forwarding to services.
"^DD",123.5,123.51,.01,1,2,"DT")
2971103
"^DD",123.5,123.51,.01,1,3,0)
123.51^AC^MUMPS
"^DD",123.5,123.51,.01,1,3,1)
I $L($P($G(^GMR(123.5,X,0)),U)) S ^GMR(123.5,DA(1),10,"AC",$P($G(^GMR(123.5,X,0)),U),DA)=""
"^DD",123.5,123.51,.01,1,3,2)
I $L($P($G(^GMR(123.5,X,0)),U)) K ^GMR(123.5,DA(1),10,"AC",$P($G(^GMR(123.5,X,0)),U),DA)
"^DD",123.5,123.51,.01,1,3,"%D",0)
^^2^2^2971103^^
"^DD",123.5,123.51,.01,1,3,"%D",1,0)
This cross-reference is used to build a hierarchical listing of the
"^DD",123.5,123.51,.01,1,3,"%D",2,0)
services alphabetically.
"^DD",123.5,123.51,.01,1,3,"DT")
2971103
"^DD",123.5,123.51,.01,3)
Enter the name of the Service which is to be a SUB-service of the Parent service.
"^DD",123.5,123.51,.01,21,0)
^^9^9^3041213^
"^DD",123.5,123.51,.01,21,1,0)
This is the menu of sub-service/specialties that are grouped under this
"^DD",123.5,123.51,.01,21,2,0)
Service.  The sub-service/specialty entries must each be defined as 
"^DD",123.5,123.51,.01,21,3,0)
entries in this file.
"^DD",123.5,123.51,.01,21,4,0)
  
"^DD",123.5,123.51,.01,21,5,0)
There is no limit on how deep the hierarchy of services may be defined.
"^DD",123.5,123.51,.01,21,6,0)
The only requirements are the "ALL SERVICES" entry be at the top of the
"^DD",123.5,123.51,.01,21,7,0)
hierarchy and a service can not be a sub-service to itself or any other 
"^DD",123.5,123.51,.01,21,8,0)
sub-service hierarchy which can be traced back to itself as a parent 
"^DD",123.5,123.51,.01,21,9,0)
service.
"^DD",123.5,123.51,.01,23,0)
3^.001^3^3^3041213^^^^
"^DD",123.5,123.51,.01,23,1,0)
This file is similar to the Option File and Protocol File.  The same
"^DD",123.5,123.51,.01,23,2,0)
concepts for setting up options should be used to define the Service/
"^DD",123.5,123.51,.01,23,3,0)
Specialty entries.
"^DD",123.5,123.51,.01,"DT")
3050228
**END**
**END**
