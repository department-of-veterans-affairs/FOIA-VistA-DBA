Released EAS*1*2 SEQ #2
Extracted from mail message
**KIDS**:EAS*1.0*2^

**INSTALL NAME**
EAS*1.0*2
"BLD",3417,0)
EAS*1.0*2^ENROLLMENT APPLICATION SYSTEM^0^3010504^y
"BLD",3417,4,0)
^9.64PA^^
"BLD",3417,"KRN",0)
^9.67PA^19^17
"BLD",3417,"KRN",.4,0)
.4
"BLD",3417,"KRN",.401,0)
.401
"BLD",3417,"KRN",.402,0)
.402
"BLD",3417,"KRN",.403,0)
.403
"BLD",3417,"KRN",.5,0)
.5
"BLD",3417,"KRN",.84,0)
.84
"BLD",3417,"KRN",3.6,0)
3.6
"BLD",3417,"KRN",3.8,0)
3.8
"BLD",3417,"KRN",9.2,0)
9.2
"BLD",3417,"KRN",9.8,0)
9.8
"BLD",3417,"KRN",9.8,"NM",0)
^9.68A^1^1
"BLD",3417,"KRN",9.8,"NM",1,0)
EASEZW^^0^B71002012
"BLD",3417,"KRN",9.8,"NM","B","EASEZW",1)

"BLD",3417,"KRN",19,0)
19
"BLD",3417,"KRN",19,"NM",0)
^9.68A^1^1
"BLD",3417,"KRN",19,"NM",1,0)
EAS EZ SERVER^^0
"BLD",3417,"KRN",19,"NM","B","EAS EZ SERVER",1)

"BLD",3417,"KRN",19.1,0)
19.1
"BLD",3417,"KRN",101,0)
101
"BLD",3417,"KRN",409.61,0)
409.61
"BLD",3417,"KRN",771,0)
771
"BLD",3417,"KRN",870,0)
870
"BLD",3417,"KRN",8994,0)
8994
"BLD",3417,"KRN","B",.4,.4)

"BLD",3417,"KRN","B",.401,.401)

"BLD",3417,"KRN","B",.402,.402)

"BLD",3417,"KRN","B",.403,.403)

"BLD",3417,"KRN","B",.5,.5)

"BLD",3417,"KRN","B",.84,.84)

"BLD",3417,"KRN","B",3.6,3.6)

"BLD",3417,"KRN","B",3.8,3.8)

"BLD",3417,"KRN","B",9.2,9.2)

"BLD",3417,"KRN","B",9.8,9.8)

"BLD",3417,"KRN","B",19,19)

"BLD",3417,"KRN","B",19.1,19.1)

"BLD",3417,"KRN","B",101,101)

"BLD",3417,"KRN","B",409.61,409.61)

"BLD",3417,"KRN","B",771,771)

"BLD",3417,"KRN","B",870,870)

"BLD",3417,"KRN","B",8994,8994)

"BLD",3417,"QUES",0)
^9.62^^
"BLD",3417,"REQB",0)
^9.611^^
"KRN",19,10532,-1)
0^1
"KRN",19,10532,0)
EAS EZ SERVER^1010EZ SERVER FOR FIELD SITE^^S^^^^^^^^ENROLLMENT APPLICATION SYSTEM
"KRN",19,10532,1,0)
^19.06^2^2^3001012^^^^
"KRN",19,10532,1,1,0)
Main server for collecting and processing 1010EZ form data submitted from
"KRN",19,10532,1,2,0)
the VA 1010EZ web-based enrollement application
"KRN",19,10532,25)
EN^EASEZW
"KRN",19,10532,220)
^Q^^^Y^N^0
"KRN",19,10532,"U")
1010EZ SERVER FOR FIELD SITE
"MBREQ")
0
"ORD",18,19)
19;18;;;OPT^XPDTA;OPTF1^XPDIA;OPTE1^XPDIA;OPTF2^XPDIA;;OPTDEL^XPDIA
"ORD",18,19,0)
OPTION
"PKG",552,-1)
1^1
"PKG",552,0)
ENROLLMENT APPLICATION SYSTEM^EAS^ENROLLMENT
"PKG",552,20,0)
^9.402P^^
"PKG",552,22,0)
^9.49I^1^1
"PKG",552,22,1,0)
1.0^3010315^3010419^66481
"PKG",552,22,1,"PAH",1,0)
2^3010504
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
1
"RTN","EASEZW")
0^1^B71002012
"RTN","EASEZW",1,0)
EASEZW ;ALB/jap - Auto-process 1010EZ from Web-based Application ;10/12/00  13:08
"RTN","EASEZW",2,0)
 ;;1.0;ENROLLMENT APPLICATION SYSTEM;**2**;Mar 15, 2001
"RTN","EASEZW",3,0)
 ;
"RTN","EASEZW",4,0)
EN ;entry point from server option
"RTN","EASEZW",5,0)
 ;standard server variables XMZ,XMRG,XMER
"RTN","EASEZW",6,0)
 ;new incoming 1010EZ application data to be filed in #712
"RTN","EASEZW",7,0)
 ;
"RTN","EASEZW",8,0)
 Q:'$G(XMZ)
"RTN","EASEZW",9,0)
 S X=$P(^XMB(3.9,XMZ,0),U,1)
"RTN","EASEZW",10,0)
 ;won't always know the exact format of message subject
"RTN","EASEZW",11,0)
 S X=$P(X,"SID ",2),X=$P(X,U,1),X=$P(X,":",1)
"RTN","EASEZW",12,0)
 S EASWEBID=$TR(X," ","")
"RTN","EASEZW",13,0)
 Q:EASWEBID=""
"RTN","EASEZW",14,0)
 ;don't process if this web submission has been previously rec'd;
"RTN","EASEZW",15,0)
 I $D(^EAS(712,"W",EASWEBID)) D  Q
"RTN","EASEZW",16,0)
 .S EASAPP=$O(^EAS(712,"W",EASWEBID,0))
"RTN","EASEZW",17,0)
 .;make sure this is an automated 1010EZ data msg
"RTN","EASEZW",18,0)
 .S OK=0 F  X XMREC Q:XMER=-1  S LINE=XMRG D  Q:OK
"RTN","EASEZW",19,0)
 ..I (LINE["SECTION")!(LINE["Section") S LINE=$$UC^EASEZT1(LINE)
"RTN","EASEZW",20,0)
 ..I LINE["VISTA AUTOMATION" S OK=1
"RTN","EASEZW",21,0)
 .;send receipt confirmation to get Forum in sync and quit
"RTN","EASEZW",22,0)
 .I OK D CONFIRM(EASWEBID,EASAPP,XMZ)
"RTN","EASEZW",23,0)
 ;continue processing if this web submission is new
"RTN","EASEZW",24,0)
 ;get facility applying to (station #)
"RTN","EASEZW",25,0)
 S X=$P($P(^XMB(3.9,XMZ,0),U,1),":",1) I X'="" D
"RTN","EASEZW",26,0)
 .S EASFAC=X,X=$E(X,1,3)
"RTN","EASEZW",27,0)
 .I +X'=X S EASFAC=""
"RTN","EASEZW",28,0)
 ;get message receipt date
"RTN","EASEZW",29,0)
 S EASRECD=$P($P($G(^XMB(3.9,XMZ,.6)),U,1),".",1)
"RTN","EASEZW",30,0)
 ;set next ien for file #712 to match #.01 field, not less than 101
"RTN","EASEZW",31,0)
 S OUT=0,CYCLE=0 F  D  Q:OUT  Q:CYCLE>5
"RTN","EASEZW",32,0)
 .S CYCLE=CYCLE+1
"RTN","EASEZW",33,0)
 .S DINUM=$O(^EAS(712,"B",""),-1) S:'DINUM DINUM=$O(^EAS(712,999999999),-1)
"RTN","EASEZW",34,0)
 .S DINUM=DINUM+1 S:DINUM<100 DINUM=DINUM+100
"RTN","EASEZW",35,0)
 .S DIC="^EAS(712,",DIC(0)="L",DLAYGO="",(NEWIEN,X)=DINUM
"RTN","EASEZW",36,0)
 .K DD,DO D FILE^DICN
"RTN","EASEZW",37,0)
 .;repair faulty "B" index
"RTN","EASEZW",38,0)
 .I Y=-1,$D(^EAS(712,NEWIEN,0)) S ^EAS(712,"B",NEWIEN,NEWIEN)="" H 3
"RTN","EASEZW",39,0)
 .I Y>0 S OUT=1
"RTN","EASEZW",40,0)
 Q:+Y<0
"RTN","EASEZW",41,0)
 S (DA,EASAPP)=+Y
"RTN","EASEZW",42,0)
 S DIE="^EAS(712,"
"RTN","EASEZW",43,0)
 S DR=".2///^S X=XMZ;3////^S X=EASRECD;3.1///^S X=.5;3.2///^S X=""W"";4.5///^S X=EASFAC"
"RTN","EASEZW",44,0)
 D ^DIE
"RTN","EASEZW",45,0)
 S LINES=$$LINES()
"RTN","EASEZW",46,0)
 I 'LINES D
"RTN","EASEZW",47,0)
 .S DA=EASAPP,DIK="^EAS(712," D ^DIK
"RTN","EASEZW",48,0)
 I LINES D NMSSNDOB D DESIGNEE D CONFIRM(EASWEBID,EASAPP,XMZ)
"RTN","EASEZW",49,0)
 Q
"RTN","EASEZW",50,0)
 ;
"RTN","EASEZW",51,0)
LINES() ;parse data lines from message into #712 record
"RTN","EASEZW",52,0)
 N OUT,SECT,LINE,KEYIEN,DATANM,ADDCHILD,MULTIPLE,ZM,ZMM,OUT,DA,DR,DIC,DIE,DINUM,DLAYGO
"RTN","EASEZW",53,0)
 ;find beginning of data lines
"RTN","EASEZW",54,0)
 S OUT=0 F  X XMREC Q:XMER=-1  S LINE=XMRG D  Q:OUT
"RTN","EASEZW",55,0)
 .I (LINE["SECTION")!(LINE["Section") S LINE=$$UC^EASEZT1(LINE)
"RTN","EASEZW",56,0)
 .I LINE["VISTA AUTOMATION" S OUT=1
"RTN","EASEZW",57,0)
 .I LINE["SECTION" D  Q
"RTN","EASEZW",58,0)
 ..S SECT=$P(LINE," - ",1),SECT=$TR(SECT," ",""),SECT=$P(SECT,"SECTION",2)
"RTN","EASEZW",59,0)
 ..S EASSECT=$TR(SECT,".","")
"RTN","EASEZW",60,0)
 I 'OUT Q 0
"RTN","EASEZW",61,0)
 ;file data lines
"RTN","EASEZW",62,0)
 ;variable EASIEN is the subrecord ien for data filing in file #712
"RTN","EASEZW",63,0)
 S EASIEN=0,OUT=0,ADDCHILD=0
"RTN","EASEZW",64,0)
 F  X XMREC Q:XMER=-1  D  Q:OUT
"RTN","EASEZW",65,0)
 .S LINE=XMRG
"RTN","EASEZW",66,0)
 .I (LINE["SECTION")!(LINE["Section") S LINE=$$UC^EASEZT1(LINE)
"RTN","EASEZW",67,0)
 .I LINE["SECTION III" D SEC3 S OUT=1 Q
"RTN","EASEZW",68,0)
 .I $E(LINE,1,3)="EOF" Q
"RTN","EASEZW",69,0)
 .I LINE["ADDITIONAL CHILD" S ADDCHILD=ADDCHILD+1 Q
"RTN","EASEZW",70,0)
 .I LINE["SECTION" D  Q
"RTN","EASEZW",71,0)
 ..S SECT=$P(LINE," - ",1),SECT=$TR(SECT," ",""),SECT=$P(SECT,"SECTION",2)
"RTN","EASEZW",72,0)
 ..S EASSECT=$TR(SECT,".","")
"RTN","EASEZW",73,0)
 .S ZM=1,ZMM=2
"RTN","EASEZW",74,0)
 .F  D  Q:EASKEY=""  S ZM=ZM+2,ZMM=ZM+1
"RTN","EASEZW",75,0)
 ..S EASKEY=$P(LINE,U,ZM),EASKEY=$TR(EASKEY," ","")
"RTN","EASEZW",76,0)
 ..Q:EASKEY=""
"RTN","EASEZW",77,0)
 ..S EASDATA=$E($P(LINE,U,ZMM),1,240)
"RTN","EASEZW",78,0)
 ..;don't file null data
"RTN","EASEZW",79,0)
 ..Q:(EASDATA=" ")!(EASDATA="")
"RTN","EASEZW",80,0)
 ..;don't file 'empty' dates, phone numbers, ssns, etc.
"RTN","EASEZW",81,0)
 ..Q:(EASDATA="/")  Q:(EASDATA="//")  Q:(EASDATA="-")  Q:(EASDATA="--")  Q:(EASDATA["?")
"RTN","EASEZW",82,0)
 ..I EASKEY["." S EASKEY=EASSECT_";"_EASKEY
"RTN","EASEZW",83,0)
 ..;find this data element in the mapping file #711
"RTN","EASEZW",84,0)
 ..S X=$$KEY711^EASEZU1(EASKEY),KEYIEN=+X,DATANM=$P(X,U,2)
"RTN","EASEZW",85,0)
 ..S EASIEN=EASIEN+1
"RTN","EASEZW",86,0)
 ..;create subrecord
"RTN","EASEZW",87,0)
 ..S DIC="^EAS(712,EASAPP,10,",DIC(0)="L",DLAYGO="",X=KEYIEN,DINUM=EASIEN
"RTN","EASEZW",88,0)
 ..S DA(1)=EASAPP,DIC("P")=$P(^DD(712,10,0),U,2)
"RTN","EASEZW",89,0)
 ..K DD,DO D FILE^DICN
"RTN","EASEZW",90,0)
 ..;file data element
"RTN","EASEZW",91,0)
 ..S DIE="^EAS(712,EASAPP,10,",DA=EASIEN,DA(1)=EASAPP,DR(1)="10;"
"RTN","EASEZW",92,0)
 ..S MULTIPLE=1 I DATANM["CHILD(N)" S MULTIPLE=ADDCHILD
"RTN","EASEZW",93,0)
 ..I DATANM["C(N)" S MULTIPLE=ADDCHILD
"RTN","EASEZW",94,0)
 ..S DR=".1///^S X=MULTIPLE;1///^S X=EASDATA;"
"RTN","EASEZW",95,0)
 ..D ^DIE
"RTN","EASEZW",96,0)
 Q 1
"RTN","EASEZW",97,0)
 ;
"RTN","EASEZW",98,0)
SEC3 ;special parsing for Section III
"RTN","EASEZW",99,0)
 N OUT,DA,DIE,DR,X,C,LINE,EMAIL,EVERS,EXPECT,EDETL,ESERV,EAPREQ,ECOMM,ERR
"RTN","EASEZW",100,0)
 ;find the Submission ID
"RTN","EASEZW",101,0)
 S EASWEBID="",EMAIL="",EVERS="",EXPECT="",EDETL="",ESERV="",EAPREQ="" S OUT=0
"RTN","EASEZW",102,0)
 F  X XMREC Q:XMER=-1  D  Q:OUT
"RTN","EASEZW",103,0)
 .S LINE=XMRG
"RTN","EASEZW",104,0)
 .I LINE["EOF",LINE["III" S OUT=1 Q
"RTN","EASEZW",105,0)
 .I LINE["Comment" S NOCOMM=0,JJ=1 F  D  Q:NOCOMM  Q:OUT
"RTN","EASEZW",106,0)
 ..I JJ=1 S C=$P(LINE,U,2) S ECOMM(JJ)=C
"RTN","EASEZW",107,0)
 ..I JJ>1,$L(LINE)>1 S ECOMM(JJ)=LINE
"RTN","EASEZW",108,0)
 ..S JJ=JJ+1
"RTN","EASEZW",109,0)
 ..X XMREC
"RTN","EASEZW",110,0)
 ..I XMER=-1 S NOCOMM=1,OUT=1
"RTN","EASEZW",111,0)
 ..S LINE=XMRG
"RTN","EASEZW",112,0)
 ..I $E(LINE,1,30)["Services Request" S NOCOMM=1
"RTN","EASEZW",113,0)
 .I LINE["Submit ID" S EASWEBID=$P(LINE,U,2)
"RTN","EASEZW",114,0)
 .I LINE["Email Address" S EMAIL=$P(LINE,U,2)
"RTN","EASEZW",115,0)
 .I LINE["Version #" S EVERS=$P(LINE,U,2)
"RTN","EASEZW",116,0)
 .I LINE["Veteran To Mail" S X=$P(LINE,U,2),EXPECT=$S(X["Vet":1,1:"")
"RTN","EASEZW",117,0)
 .I LINE["Provide",LINE["Details" S EDETL=$P(LINE,U,2)
"RTN","EASEZW",118,0)
 .I LINE["Appointment Request" S X=$P(LINE,U,2),EAPREQ=$S(X="YES":1,1:0)
"RTN","EASEZW",119,0)
 .I LINE["Services Request" S ESERV=$P(LINE,U,2)
"RTN","EASEZW",120,0)
 ;file the Submission ID into #712 record
"RTN","EASEZW",121,0)
 S DA=EASAPP
"RTN","EASEZW",122,0)
 S DIE="^EAS(712,"
"RTN","EASEZW",123,0)
 S DR=".1///^S X=EASWEBID;3.6///^S X=EVERS;3.7///^S X=EXPECT;3.8///^S X=EDETL;4.3///^S X=EMAIL;"
"RTN","EASEZW",124,0)
 S DR=DR_"4.4///^S X=EAPREQ;12///^S X=ESERV"
"RTN","EASEZW",125,0)
 D ^DIE
"RTN","EASEZW",126,0)
 K DA,DIE,DR,X,Y
"RTN","EASEZW",127,0)
 I $D(ECOMM) D WP^DIE(712,EASAPP_",",13,,"ECOMM","ERR")
"RTN","EASEZW",128,0)
 Q
"RTN","EASEZW",129,0)
 ;
"RTN","EASEZW",130,0)
NMSSNDOB ;find applicant's name,ssn,dob in data subrecords & file in main record
"RTN","EASEZW",131,0)
 ;get applicant name
"RTN","EASEZW",132,0)
 N KEY,MDL,SUFF,N,X,Y,ZX,DA,DR,DIE
"RTN","EASEZW",133,0)
 S KEY=$$KEY711^EASEZU1("APPLICANT LAST NAME"),EASNAME=$P($$DATA712^EASEZU1(EASAPP,KEY),U,1)
"RTN","EASEZW",134,0)
 S KEY=$$KEY711^EASEZU1("APPLICANT FIRST NAME"),EASNAME=EASNAME_","_$P($$DATA712^EASEZU1(EASAPP,KEY),U,1)
"RTN","EASEZW",135,0)
 S KEY=$$KEY711^EASEZU1("APPLICANT MIDDLE NAME"),MDL=$P($$DATA712^EASEZU1(EASAPP,KEY),U,1)
"RTN","EASEZW",136,0)
 S KEY=$$KEY711^EASEZU1("APPLICANT SUFFIX NAME"),SUFF=$P($$DATA712^EASEZU1(EASAPP,KEY),U,1)
"RTN","EASEZW",137,0)
 I $L(EASNAME)+$L(MDL)>45 S MDL=$E(MDL,1)
"RTN","EASEZW",138,0)
 I MDL'="" S EASNAME=EASNAME_" "_MDL
"RTN","EASEZW",139,0)
 I SUFF'="" S EASNAME=EASNAME_" "_SUFF
"RTN","EASEZW",140,0)
 S EASNAME=$$UC^EASEZT1($E(EASNAME,1,45))
"RTN","EASEZW",141,0)
 ;get applicant ssn & dob
"RTN","EASEZW",142,0)
 S KEY=$$KEY711^EASEZU1("APPLICANT SOCIAL SECURITY NUMBER")
"RTN","EASEZW",143,0)
 S EASSSN=$P($$DATA712^EASEZU1(EASAPP,KEY),U,1),EASSSN=$$SSNOUT^EASEZT1(EASSSN)
"RTN","EASEZW",144,0)
 S KEY=$$KEY711^EASEZU1("APPLICANT DATE OF BIRTH")
"RTN","EASEZW",145,0)
 S EASDOB=$P($$DATA712^EASEZU1(EASAPP,KEY),U,1)
"RTN","EASEZW",146,0)
 S VETTYPE=$$VETTYPE(EASAPP)
"RTN","EASEZW",147,0)
 S N(1)=$O(^EAS(711,"AB","APPLICANT FIRST NAME",0)),KEY(1)=$P($G(^EAS(711,N(1),0)),U,2)
"RTN","EASEZW",148,0)
 K DA,DR S DA=EASAPP,DIE="^EAS(712,"
"RTN","EASEZW",149,0)
 S ZX=EASSSN_"&"_EASDOB
"RTN","EASEZW",150,0)
 S DR="1///^S X=EASNAME;2///^S X=ZX;3.3///^S X=VETTYPE"
"RTN","EASEZW",151,0)
 D ^DIE
"RTN","EASEZW",152,0)
 Q
"RTN","EASEZW",153,0)
 ;
"RTN","EASEZW",154,0)
VETTYPE(EASAPP) ;derive a veteran type categorization for this Applicant
"RTN","EASEZW",155,0)
 ;input  EASAPP = ien in file #712 for Application
"RTN","EASEZW",156,0)
 ;output TYPE   = veteran type
"RTN","EASEZW",157,0)
 ;
"RTN","EASEZW",158,0)
 N KEY,PH,POW,SC,SCPC,MRET,VETTYPE
"RTN","EASEZW",159,0)
 ;get application data needed to determine veteran type
"RTN","EASEZW",160,0)
 S KEY=$$KEY711^EASEZU1("PURPLE HEART"),PH=$P($$DATA712^EASEZU1(EASAPP,KEY),U,1)
"RTN","EASEZW",161,0)
 S KEY=$$KEY711^EASEZU1("PRISONER OF WAR"),POW=$P($$DATA712^EASEZU1(EASAPP,KEY),U,1)
"RTN","EASEZW",162,0)
 S KEY=$$KEY711^EASEZU1("SERVICE-CONNECTED"),SC=$P($$DATA712^EASEZU1(EASAPP,KEY),U,1)
"RTN","EASEZW",163,0)
 S KEY=$$KEY711^EASEZU1("RATED PERCENTAGE"),SCPC=$P($$DATA712^EASEZU1(EASAPP,KEY),U,1)
"RTN","EASEZW",164,0)
 S KEY=$$KEY711^EASEZU1("RETIRED FROM MILITARY"),MRET=$P($$DATA712^EASEZU1(EASAPP,KEY),U,1)
"RTN","EASEZW",165,0)
 ;set veteran type
"RTN","EASEZW",166,0)
 I PH="Y" Q 5
"RTN","EASEZW",167,0)
 I POW="Y" Q 4
"RTN","EASEZW",168,0)
 I SC="Y" S TYPE=$S(+SCPC>49:1,+SCPC=0:3,1:2) Q TYPE
"RTN","EASEZW",169,0)
 I MRET="Y" Q 6
"RTN","EASEZW",170,0)
 Q 7
"RTN","EASEZW",171,0)
 ;
"RTN","EASEZW",172,0)
DESIGNEE ;set either NOK or E-CONTACT data into DESIGNEE
"RTN","EASEZW",173,0)
 N DIC,DIE,DA,DR,X,Y,EASDATA,TYPE,MULTIPLE,XPART,KEY,EASIEN
"RTN","EASEZW",174,0)
 S KEY=$$KEY711^EASEZU1("DESIGNEE")
"RTN","EASEZW",175,0)
 S EZDATA=$P($$DATA712^EASEZU1(EASAPP,KEY,1),U,1)
"RTN","EASEZW",176,0)
 I (EZDATA["EMERGENCY")!(EZDATA["CONTACT") S TYPE="E-CONTACT"
"RTN","EASEZW",177,0)
 E  S TYPE="NEXT-OF-KIN"
"RTN","EASEZW",178,0)
 ;place all NOK or E-CONTACT data in DESIGNEE data lements
"RTN","EASEZW",179,0)
 F I=1:1 S X=$P($T(DSGDAT+I),";;",2) Q:X="QUIT"  D
"RTN","EASEZW",180,0)
 .S XPART=$P(X,";",1)
"RTN","EASEZW",181,0)
 .S KEY=$$KEY711^EASEZU1(TYPE_" "_XPART)
"RTN","EASEZW",182,0)
 .Q:KEY=.1
"RTN","EASEZW",183,0)
 .S KEYIEN=+$P(KEY,U,1),DATAKEY=$P(KEY,U,3)
"RTN","EASEZW",184,0)
 .;in file #2, multiple is always 1
"RTN","EASEZW",185,0)
 .S MULTIPLE=1
"RTN","EASEZW",186,0)
 .;get the data element for the NOK or E-CONT
"RTN","EASEZW",187,0)
 .S X=$$DATA712^EASEZU1(EASAPP,KEY,MULTIPLE),EASDATA=$P(X,U,1)
"RTN","EASEZW",188,0)
 .Q:EASDATA=""
"RTN","EASEZW",189,0)
 .;and file it as DESIGNEE
"RTN","EASEZW",190,0)
 .;create subrecord
"RTN","EASEZW",191,0)
 .S X=$$KEY711^EASEZU1("DESIGNEE"_" "_XPART),KEYIEN=+X
"RTN","EASEZW",192,0)
 .S EASIEN=$O(^EAS(712,EASAPP,10,999),-1)+1
"RTN","EASEZW",193,0)
 .S DIC="^EAS(712,EASAPP,10,",DIC(0)="L",DLAYGO="",X=KEYIEN,DINUM=EASIEN
"RTN","EASEZW",194,0)
 .S DA(1)=EASAPP,DIC("P")=$P(^DD(712,10,0),U,2)
"RTN","EASEZW",195,0)
 .K DD,DO D FILE^DICN
"RTN","EASEZW",196,0)
 .;file data element
"RTN","EASEZW",197,0)
 .S DIE="^EAS(712,EASAPP,10,",DA=EASIEN,DA(1)=EASAPP,DR(1)="10;"
"RTN","EASEZW",198,0)
 .S DR=".1///^S X=1;1///^S X=EASDATA;"
"RTN","EASEZW",199,0)
 .D ^DIE
"RTN","EASEZW",200,0)
 Q
"RTN","EASEZW",201,0)
 ;
"RTN","EASEZW",202,0)
DSGDAT ;
"RTN","EASEZW",203,0)
 ;;LAST NAME;
"RTN","EASEZW",204,0)
 ;;FIRST NAME;
"RTN","EASEZW",205,0)
 ;;STREET ADDRESS;
"RTN","EASEZW",206,0)
 ;;CITY;
"RTN","EASEZW",207,0)
 ;;STATE;
"RTN","EASEZW",208,0)
 ;;ZIP;;
"RTN","EASEZW",209,0)
 ;;HOME PHONE AREA CODE;
"RTN","EASEZW",210,0)
 ;;HOME PHONE NUMBER;
"RTN","EASEZW",211,0)
 ;;WORK PHONE AREA CODE;
"RTN","EASEZW",212,0)
 ;;WORK PHONE NUMBER;
"RTN","EASEZW",213,0)
 ;;WORK PHONE EXTENSION;
"RTN","EASEZW",214,0)
 ;;RELATIONSHIP;
"RTN","EASEZW",215,0)
 ;;QUIT
"RTN","EASEZW",216,0)
 ;
"RTN","EASEZW",217,0)
CONFIRM(EASWEBID,EASAPP,EASXMZ) ;confirm receipt of web submission message to Forum
"RTN","EASEZW",218,0)
 ;input EASAPP   = ien in file #712
"RTN","EASEZW",219,0)
 ;      EASWEBID = web submission id
"RTN","EASEZW",220,0)
 ;      EASXMZ   = ien in file #3.9 for msg being processed
"RTN","EASEZW",221,0)
 N ARRAY,DIC,DIQ,DA,DR,STN,XMSUB,XMDUZ,XMTEXT,XMY,XMZ
"RTN","EASEZW",222,0)
 Q:$G(EASAPP)=""  Q:$G(EASWEBID)=""
"RTN","EASEZW",223,0)
 S DA=EASAPP,DIC="^EAS(712,",DIQ="ARRAY",DIQ(0)="I",DR=".2;4.5"
"RTN","EASEZW",224,0)
 D EN^DIQ1
"RTN","EASEZW",225,0)
 S STN=$G(ARRAY(712,EASAPP,4.5,"I")),STN=$TR(STN," ",""),STN=STN_U_"G.VA1010EZ@"_^XMB("NETNAME")
"RTN","EASEZW",226,0)
 S ^TMP("1010EZRC",$J,1)="Receipt Confirmation for: "_EASWEBID
"RTN","EASEZW",227,0)
 S ^TMP("1010EZRC",$J,2)="Sent from: "_STN
"RTN","EASEZW",228,0)
 ;send msg # from holding file record just in case current msg is a duplicate
"RTN","EASEZW",229,0)
 S ^TMP("1010EZRC",$J,3)="Site msg #: "_$G(ARRAY(712,EASAPP,.2,"I"))
"RTN","EASEZW",230,0)
 S XMSUB="1010EZ CONFIRMATION for SID "_EASWEBID,XMDUZ=.5
"RTN","EASEZW",231,0)
 S XMY("1010EZ.1010EZ@FORUM.VA.GOV")=""
"RTN","EASEZW",232,0)
 S XMTEXT="^TMP(""1010EZRC"",$J,"
"RTN","EASEZW",233,0)
 D ^XMD
"RTN","EASEZW",234,0)
 K ^TMP("1010EZRC",$J)
"RTN","EASEZW",235,0)
 Q
"VER")
8.0^22
**END**
**END**
