Released XU*8*372 SEQ #378
Extracted from mail message
**KIDS**:XU*8.0*372^

**INSTALL NAME**
XU*8.0*372
"BLD",920,0)
XU*8.0*372^KERNEL^0^3060124^y
"BLD",920,1,0)
^^2^2^3060103^
"BLD",920,1,1,0)
Please refer to the Description in the FORUM Patch Module for details.
"BLD",920,1,2,0)
XU*8*372   Fix three slash stuff of DUZ.
"BLD",920,4,0)
^9.64PA^^
"BLD",920,6.3)
3
"BLD",920,"KRN",0)
^9.67PA^8989.52^19
"BLD",920,"KRN",.4,0)
.4
"BLD",920,"KRN",.401,0)
.401
"BLD",920,"KRN",.402,0)
.402
"BLD",920,"KRN",.403,0)
.403
"BLD",920,"KRN",.5,0)
.5
"BLD",920,"KRN",.84,0)
.84
"BLD",920,"KRN",3.6,0)
3.6
"BLD",920,"KRN",3.8,0)
3.8
"BLD",920,"KRN",9.2,0)
9.2
"BLD",920,"KRN",9.8,0)
9.8
"BLD",920,"KRN",9.8,"NM",0)
^9.68A^3^3
"BLD",920,"KRN",9.8,"NM",1,0)
XQSMD31^^0^12546798
"BLD",920,"KRN",9.8,"NM",2,0)
XQH0^^0^14695608
"BLD",920,"KRN",9.8,"NM",3,0)
XQ11^^0^14029847
"BLD",920,"KRN",9.8,"NM","B","XQ11",3)

"BLD",920,"KRN",9.8,"NM","B","XQH0",2)

"BLD",920,"KRN",9.8,"NM","B","XQSMD31",1)

"BLD",920,"KRN",19,0)
19
"BLD",920,"KRN",19.1,0)
19.1
"BLD",920,"KRN",101,0)
101
"BLD",920,"KRN",409.61,0)
409.61
"BLD",920,"KRN",771,0)
771
"BLD",920,"KRN",870,0)
870
"BLD",920,"KRN",8989.51,0)
8989.51
"BLD",920,"KRN",8989.52,0)
8989.52
"BLD",920,"KRN",8994,0)
8994
"BLD",920,"KRN","B",.4,.4)

"BLD",920,"KRN","B",.401,.401)

"BLD",920,"KRN","B",.402,.402)

"BLD",920,"KRN","B",.403,.403)

"BLD",920,"KRN","B",.5,.5)

"BLD",920,"KRN","B",.84,.84)

"BLD",920,"KRN","B",3.6,3.6)

"BLD",920,"KRN","B",3.8,3.8)

"BLD",920,"KRN","B",9.2,9.2)

"BLD",920,"KRN","B",9.8,9.8)

"BLD",920,"KRN","B",19,19)

"BLD",920,"KRN","B",19.1,19.1)

"BLD",920,"KRN","B",101,101)

"BLD",920,"KRN","B",409.61,409.61)

"BLD",920,"KRN","B",771,771)

"BLD",920,"KRN","B",870,870)

"BLD",920,"KRN","B",8989.51,8989.51)

"BLD",920,"KRN","B",8989.52,8989.52)

"BLD",920,"KRN","B",8994,8994)

"BLD",920,"QUES",0)
^9.62^^
"BLD",920,"REQB",0)
^9.611^2^1
"BLD",920,"REQB",2,0)
XU*8.0*155^2
"BLD",920,"REQB","B","XU*8.0*155",2)

"MBREQ")
0
"PKG",3,-1)
1^1
"PKG",3,0)
KERNEL^XU^SIGN-ON, SECURITY, MENU DRIVER, DEVICES, TASKMAN^
"PKG",3,20,0)
^9.402P^^0
"PKG",3,22,0)
^9.49I^1^1
"PKG",3,22,1,0)
8.0^3051215^2970507^.5
"PKG",3,22,1,"PAH",1,0)
372^3060124
"PKG",3,22,1,"PAH",1,1,0)
^^2^2^3060124
"PKG",3,22,1,"PAH",1,1,1,0)
Please refer to the Description in the FORUM Patch Module for details.
"PKG",3,22,1,"PAH",1,1,2,0)
XU*8*372   Fix three slash stuff of DUZ.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
3
"RTN","XQ11")
0^3^B14029847^B14186228
"RTN","XQ11",1,0)
XQ11 ;SEA/MJM - Menu Utilities ;1/08/2006
"RTN","XQ11",2,0)
 ;;8.0;KERNEL;**155,372**;Jul 10, 1995;Build 3
"RTN","XQ11",3,0)
 ;
"RTN","XQ11",4,0)
COPY ;Make a copy of a menu-type option
"RTN","XQ11",5,0)
 S XQA=$S(DUZ(0)["@":1,$D(^XUSEC("XUMGR",DUZ)):1,$D(^XUSEC("XUPROGMODE",DUZ)):1,1:0)
"RTN","XQ11",6,0)
 S XQD="",%=0 I $D(^VA(200,DUZ,19.6,0)),$L($P(^(0),U,3)),$P(^(0),U,3)>0 F XQI=0:0 S %=$O(^VA(200,DUZ,19.6,%)) Q:%=""!(%'?1N.N)  S XQD=XQD_^(%,0)_","
"RTN","XQ11",7,0)
 I 'XQA,'$L(XQD) W !!,"Sorry.  You need to be assigned a valid name space to proceed." H 6 S XQH="XQNAMSPAC" D EN^XQH Q
"RTN","XQ11",8,0)
 ;
"RTN","XQ11",9,0)
 S DIC="^DIC(19,",DIC(0)="AEMQZ",DIC("A")="Menu you would like to make a copy of: " D ^DIC
"RTN","XQ11",10,0)
 Q:Y=-1  S XQYO=+Y
"RTN","XQ11",11,0)
 W !!,"WARNING ** Option names must be carefully named to avoid system damage!!",!?5,"Do you want more information?  Yes// "
"RTN","XQ11",12,0)
 R XQUR:DTIME S:"Nn"'[$E(XQUR,1) XQUR="Y" I "Yy"[$E(XQUR,1) S XQH="XQNAMSPAC" D EN^XQH
"RTN","XQ11",13,0)
ASK W !!,"What is the new menu's name: " R XQUR:DTIME S:'$T XQUR=U G:XQUR[U OUT
"RTN","XQ11",14,0)
 S XQF=1 I 'XQA S XQF=0 F XQI=1:1 S %=$P(XQD,",",XQI) Q:%=""  I %=$E(XQUR,1,$L(%)) S XQF=1 Q
"RTN","XQ11",15,0)
 I 'XQF W !!?5,"Sorry.  Your new option must begin with: " F XQI=1:1 S %=$P(XQD,",",XQI) Q:%=""  W $S(XQI=1:"",1:" or "),%
"RTN","XQ11",16,0)
 I 'XQF G ASK
"RTN","XQ11",17,0)
 ;
"RTN","XQ11",18,0)
 S (XQF,XQF0,XQF1)=0 I $D(^DIC(19,"B",XQUR)) S XQYN=$O(^(XQUR,0)) W !!?5,"Sorry, this option name is already in use." S XQF=1
"RTN","XQ11",19,0)
 I XQF,$P(^DIC(19,XQYN,0),U,5)=DUZ S XQF0=1
"RTN","XQ11",20,0)
REP I XQF,XQF0 W !!?5,"Do you want to replace it?  No// " R %:DTIME S:'$T %=U G:%=U OUT S:%="" %="N" G:"Nn"[$E(%) ASK S:"Yy"[$E(%) XQF1=1 I %["?" W !!?5,"If you answer 'Y' the existing option will be replaced by the one you're creating." G REP
"RTN","XQ11",21,0)
 I XQF,'XQF1 G ASK
"RTN","XQ11",22,0)
 I $L(XQUR)>30!(+XQUR=XQUR)!($L(XQUR)<3)!'(XQUR'?1P.E)!(XQUR'?.UNP) W *7,!!?5,"3 to 30 uppercase characters, please." G ASK
"RTN","XQ11",23,0)
 ;
"RTN","XQ11",24,0)
TXT ;Get the new menu text
"RTN","XQ11",25,0)
 W !!,"The old menu text is ","""",$P(^DIC(19,+XQYO,0),U,2),"""",!
"RTN","XQ11",26,0)
 K DIR S DIR("?")="Please enter 10 to 50 characters describing what the new option does.",DIR(0)="19,1",DIR("A")="What will option say?"
"RTN","XQ11",27,0)
 D ^DIR S XQUR0=X G:$D(DIRUT) OUT
"RTN","XQ11",28,0)
 ;R XQUR0:DTIME S:'$T XQUR0=U G:XQUR0[U OUT G:'$L(XQUR0) TXT I $E(XQUR0,1)="?"!($L(XQUR0)<10)!($L(XQUR0)>50)!(XQUR0'?. W !!?5,"Please enter 10 to 50 characters describing what the new option does." G TXT
"RTN","XQ11",29,0)
 S XQUP=$$UP^XLFSTR(XQUR0) ;F XQI=1:1 Q:XQUP?.NUP  S %=$A(XQUP,XQI) I %<123,%>96 S XQUP=$E(XQUP,1,XQI-1)_$C(%-32)_$E(XQUP,XQI+1,255)
"RTN","XQ11",30,0)
 ;
"RTN","XQ11",31,0)
FIL ;Get FileMan to put this all in.
"RTN","XQ11",32,0)
 S DIR("?")="'Y' means create the new menu. 'N' means don't.",DIR(0)="YA",DIR("A")="Is everything OK? ",DIR("B")="No" D ^DIR G:$D(DIRUT) OUT I Y=0 D OUT G ^XQ11
"RTN","XQ11",33,0)
 I 'XQF S DIC(0)="LMXZ",X=XQUR,DLAYGO=19 D FILE^DICN S XQYN=Y
"RTN","XQ11",34,0)
 S %X="^DIC(19,"_+XQYO_",",%Y="^DIC(19,"_+XQYN_"," D %XY^%RCR
"RTN","XQ11",35,0)
 ;S $P(^DIC(19,+XQYN,0),U)=XQUR S DIK="^DIC(19,",DA=+XQYN D IX^DIC
"RTN","XQ11",36,0)
 S DIE="^DIC(19,",DR=".01///"_XQUR_";1///"_XQUR0_";3.6////"_DUZ_";",DA=+XQYN D ^DIE S ^DIC(19,+XQYN,"U")=$E(XQUP,1,30)
"RTN","XQ11",37,0)
 ;
"RTN","XQ11",38,0)
OUT K %,%1,%X,%Y,C,D,D0,DA,DDH,DI,DIC,DIE,DIG,DIH,DIK,DIR,DIU,DIV,DIW,DLAYGO,DQ,DR,X,XQA,XQD,XQF,XQF0,XQF1,XQH,XQI,XQUP,XQUR,XQUR0,XQYN,XQYO,Y
"RTN","XQ11",39,0)
 Q
"RTN","XQH0")
0^2^B14695608^B14686211
"RTN","XQH0",1,0)
XQH0 ;LL/THM,SEA/AMF,JLI - HELP PROCESSOR ;12/08/2004  11:57
"RTN","XQH0",2,0)
 ;;8.0;KERNEL;**372**;Jul 10, 1995;Build 3
"RTN","XQH0",3,0)
G4 ;
"RTN","XQH0",4,0)
 I XQHON W @IORV
"RTN","XQH0",5,0)
G4A I XQHON W:X1="" @IORVX Q:X1=""  S XQHTXT=$P(X1,"]"),X1=$P(X1,"]",2,99),XQHNXT=$E(X1) S:XQHNXT="]" XQHTXT=XQHTXT_"]",X1=$E(X1,2,200) W XQHTXT G:XQHNXT="]" G4A W @IORVX S XQHON=0 G G4A
"RTN","XQH0",6,0)
 Q:X1=""  S XQHTXT=$P(X1,"["),X1=$P(X1,"[",2,99),XQHNXT=$E(X1) S:XQHNXT="[" XQHTXT=XQHTXT_"[",X1=$E(X1,2,200) I XQHTXT["]" S XQHTXT=$P(XQHTXT,"]")_$P(XQHTXT,"]",2,99)
"RTN","XQH0",7,0)
 W XQHTXT G:XQHNXT="["!(XQHNXT="") G4A W @IORV S XQHON=1 G G4A
"RTN","XQH0",8,0)
 Q
"RTN","XQH0",9,0)
REL D HDR^XQH1
"RTN","XQH0",10,0)
REL1 W !!,?6,"RELATED HELP FRAME",?59,"KEYWORD",!?6,$E(XQDSH,1,18),?59,$E(XQDSH,1,7)
"RTN","XQH0",11,0)
 S (X,K)=0
"RTN","XQH0",12,0)
 F I=1:1 S X=$O(^DIC(9.2,XQHY,2,X)) Q:X'=+X  S X1=^(X,0) S:'$L(X1) I=I-1 I $L(X1) S XQKY=$P(X1,U,1),X1=$P(X1,U,2),XQHX(I)=X1 D REL1W S K=K+1
"RTN","XQH0",13,0)
 W !!,"* - Recently viewed help frame"
"RTN","XQH0",14,0)
BOT2 W !!,"Select HELP SYSTEM action or <return>: "
"RTN","XQH0",15,0)
 R X:DTIME X:$D(^DIC(9.2,+XQHY,10.2)) ^(10.2) I '$T!'$L(X) S:'XQHL XQDONE=1 Q:XQDONE  D POP G GL3^XQH
"RTN","XQH0",16,0)
 S:X="^" X="^Q" S %XQK=X,X="" F %XQJ=1:1:$L(%XQK) S X=X_$S(($E(%XQK,%XQJ)?1L):$C($A($E(%XQK,%XQJ))-32),1:$E(%XQK,%XQJ))
"RTN","XQH0",17,0)
 I $E(X,1)="^" G:"^R"[X REL S:"^Q"[X XQDONE=1 Q:XQDONE  G:"^T"[X GL3^XQH D:"^O"[X HILITE^XQH2 D:"^H"[X HOW^XQH2 G:"^H"[X!("^O"[X) BOT2 I "^E"[$E(X,1,2)&XQAU D EDIT^XQH2 G BOT2
"RTN","XQH0",18,0)
 I X["?" S %XQI=2 D HELP^XQH2 G BOT2
"RTN","XQH0",19,0)
 I +X=X,$D(XQHX(+X)) S X=XQHX(X) W:'$L(X) !,"No help frame exists" G:'$L(X) BOT2 S XQHN=0,XQHS(X)="" D PSH S XQHY=X D INT^XQH Q:XQDONE  D POP G GL3^XQH
"RTN","XQH0",20,0)
 S XQHX=X D CHK I Y<0 W " ??",*7 G BOT2
"RTN","XQH0",21,0)
 S X=$P(Y(0),U,2) W:'$L(X) !,"No help frame exists" G:'$L(X) BOT2 S XQHN=0,XQHS(X)="" D PSH S XQHY=X D INT^XQH Q:XQDONE  D POP G GL3^XQH
"RTN","XQH0",22,0)
 Q
"RTN","XQH0",23,0)
REL1W W !,$S('$L(X1):"",$D(XQHS(X1)):"*",1:""),?2,I,?6,$S('$L(X1):"[No help frame exists]",'$D(^DIC(9.2,X1,0)):"",1:$P(^DIC(9.2,X1,0),U,2)) W ?(54+(15-$L(XQKY)\2)),@IORV,XQKY,@IORVX Q
"RTN","XQH0",24,0)
PSH S XQHR(XQHL,1)=XQHF,XQHR(XQHL,2)=XQHY,XQHR(XQHL,3)=XQHN,XQHL=XQHL+1 Q
"RTN","XQH0",25,0)
POP S XQHL=XQHL-1,XQHF=XQHR(XQHL,1),XQHY=+XQHR(XQHL,2),XQHN=XQHR(XQHL,3) K XQHR(XQHL) Q
"RTN","XQH0",26,0)
 ;
"RTN","XQH0",27,0)
GET ;
"RTN","XQH0",28,0)
 S XQHSL=1 D INIT^XQH1 S DIC(0)="AEQMZL",DLAYGO=9.2,DIC="^DIC(9.2," D ^DIC S XQHY=Y K DLAYGO,DIC(0) I Y>0,$P(Y,U,3) S DA=+Y,DR="6////"_DUZ_";4///T",DIE=DIC D ^DIE
"RTN","XQH0",29,0)
 S:XQHY<0 XQH=-1 S Y=XQHY
"RTN","XQH0",30,0)
 Q
"RTN","XQH0",31,0)
 ;
"RTN","XQH0",32,0)
CHK S XQHX=$E(XQHX,1,30),XQHX2=$E(XQHX,1,$L(XQHX)-1)_$C($A($E(XQHX,$L(XQHX)))-1)_"z" F XQHJ=0:0 S XQHX2=$O(^DIC(9.2,XQHY,2,"B",XQHX2)) Q:$E(XQHX2,1,$L(XQHX))'=XQHX  S XQHJ=XQHJ+1,XQHJ(XQHJ)=$O(^(XQHX2,0))_U_XQHX2
"RTN","XQH0",33,0)
 S:XQHJ=1 XQHI=1 I XQHJ'>0 W $C(7),"  ??" S XQHI=0
"RTN","XQH0",34,0)
CHKASK ;
"RTN","XQH0",35,0)
 I XQHJ>1 W ! F XQHI=1:1:XQHJ W !?5,$J(XQHI,3),".  ",$P(XQHJ(XQHI),U,2)
"RTN","XQH0",36,0)
 I XQHJ>1 W !!?10,"Select from (1 to ",XQHJ,") : " R XQHI:DTIME S:'$T!(XQHI[U) XQDONE=1,XQHI=0 S:XQHI="" XQHI=0 I +XQHI'=XQHI!(XQHI<0)!(XQHI>XQHJ) W $C(7),"  ??",! G CHKASK
"RTN","XQH0",37,0)
 S Y=$S(XQHI=0:-1,1:XQHJ(XQHI)) S:Y>0 Y(0)=^DIC(9.2,XQHY,2,+Y,0)
"RTN","XQH0",38,0)
 K XQHI,XQHJ,XQHX2
"RTN","XQH0",39,0)
 Q
"RTN","XQSMD31")
0^1^B12546798^B12542015
"RTN","XQSMD31",1,0)
XQSMD31 ;SEA/MJM - Secure Menu Delegation (Cont.) ;01/19/2006
"RTN","XQSMD31",2,0)
 ;;8.0;KERNEL;**372**;Jul 10, 1995;Build 3
"RTN","XQSMD31",3,0)
 ;Continued from XQSMD3
"RTN","XQSMD31",4,0)
DOIT ;Set up the parameters for a calls to %XY^%RCR and XQSMD2
"RTN","XQSMD31",5,0)
 S %X=XQPERX
"RTN","XQSMD31",6,0)
 S %Y="^TMP($J,""OP""," D %XY^%RCR K ^TMP($J,"OP",0),^("B") S DIC=19,DIC(0)="MNF"
"RTN","XQSMD31",7,0)
 S XQN="" F XQI=0:0 S XQN=$O(^TMP($J,"OP",XQN)) Q:XQN=""  S X=+XQN D ^DIC I +Y>0 S ^TMP($J,"OP",+Y)="",^TMP($J,"ZN",$P(^DIC(19,+Y,0),U,1))=$P(^(0),U,2,99) K ^TMP($J,"OP",+XQN,0)
"RTN","XQSMD31",8,0)
 ;
"RTN","XQSMD31",9,0)
KILL ;Delete the delegated options of XQU1 and clean up.
"RTN","XQSMD31",10,0)
 I XQDEL S DA(1)=XQU1Y,DA="",ZTRTN="DEL^XQSMD31",ZTSAVE("DA(")="",ZTIO="",ZTDTH=$H,ZTDESC="Delete delegated option set for "_XQU1 D ^%ZTLOAD S XQDEL=0
"RTN","XQSMD31",11,0)
 K %X,%Y,DIC,XQPERX,XQU1,XQU1Y,XQU2,ZTSK
"RTN","XQSMD31",12,0)
 ;
"RTN","XQSMD31",13,0)
 G BUILD^XQSMD2
"RTN","XQSMD31",14,0)
 ;
"RTN","XQSMD31",15,0)
DEL ;Taskman entry for killing off delegated option sets
"RTN","XQSMD31",16,0)
 S DIK="^VA(200,"_DA(1)_",19.5,",DA=0
"RTN","XQSMD31",17,0)
 F XQI=0:0 S DA=$O(^VA(200,DA(1),19.5,DA)) Q:DA=""  D ^DIK
"RTN","XQSMD31",18,0)
 K DIK,DA
"RTN","XQSMD31",19,0)
 Q
"RTN","XQSMD31",20,0)
 ;
"RTN","XQSMD31",21,0)
DELM ;Taskman entry for deleting option sets from multiple users.
"RTN","XQSMD31",22,0)
 S DA(1)=0 F XQJ=0:0 S DA(1)=$O(XQHOLD(DA(1))) Q:DA(1)=""  S DIK="^VA(200,"_DA(1)_",19.5,",DA=0 F XQI=0:0 S DA=$O(^VA(200,DA(1),19.5,DA)) Q:DA=""  D ^DIK
"RTN","XQSMD31",23,0)
 Q
"RTN","XQSMD31",24,0)
 ;
"RTN","XQSMD31",25,0)
ZTSK ;Taskman entry for adding and deleting delegated options (XQSMD2)
"RTN","XQSMD31",26,0)
 S XQLEV=XQLEV+1,DR="19////"_DUZ_";19.2///"_XQLEV,DIE=200,XQM=0
"RTN","XQSMD31",27,0)
 F XQJ=1:1 S XQM=$O(XQHOLD(XQM)) Q:XQM=""  S DA=XQM D:$D(^VA(200,DA,19))[0!($O(^(19.5,0))="") ^DIE D @$S(XQDOP:"REM",1:"ADD")
"RTN","XQSMD31",28,0)
 D GIVOPT ; Give USER MENU OPTION as a secondary option if the user doesn't already have it.
"RTN","XQSMD31",29,0)
 K DIE,DR,DA,XQLEV,XQM,XQDOP,XQJ,XQK,XQN,XQPRO,XQUF,XQHOLD,ZTSK
"RTN","XQSMD31",30,0)
 Q
"RTN","XQSMD31",31,0)
 ;
"RTN","XQSMD31",32,0)
ADD ;Add options that have been delegated to this user.
"RTN","XQSMD31",33,0)
 S DA(1)=XQM,DIC="^VA(200,"_DA(1)_",19.5,",DIC(0)="NFL",DLAYGO=200,XQN="",XQUF=0 I '$D(^VA(200,XQM,19.5,0)) S ^(0)="^200.19P^^"
"RTN","XQSMD31",34,0)
 F XQK=0:0 S XQN=$O(^TMP($J,"OP",XQN)) Q:XQN=""  D:'XQPRO CHCK I 'XQUF S (X,DINUM)=XQN D:$D(^VA(200,DA(1),19.5,X,0))[0 FILE^DICN S XQUF=0
"RTN","XQSMD31",35,0)
 Q
"RTN","XQSMD31",36,0)
 ;
"RTN","XQSMD31",37,0)
REM ;Remove delegated options from this delegate.
"RTN","XQSMD31",38,0)
 S DA(1)=XQM,DIK="^VA(200,"_DA(1)_",19.5,",XQN="",XQUF=0 F XQL=0:0 S XQN=$O(^TMP($J,"OP",XQN)) Q:XQN=""  D:'XQPRO CHCK I 'XQUF S DA=XQN D:$D(^VA(200,DA(1),19.5,DA,0)) ^DIK S XQUF=0
"RTN","XQSMD31",39,0)
 Q
"RTN","XQSMD31",40,0)
 ;
"RTN","XQSMD31",41,0)
CHCK ;See if this person has this option before delegating it.
"RTN","XQSMD31",42,0)
 S:'$D(^VA(200,DUZ,19.5,XQN,0))#2 XQUF=1 I XQUF S XQON=^DIC(19,XQN,0)
"RTN","XQSMD31",43,0)
 Q
"RTN","XQSMD31",44,0)
 ;
"RTN","XQSMD31",45,0)
GIVOPT ; GIVE USER MENU SO HE CAN USE THE DELEGATED CAPABILITY
"RTN","XQSMD31",46,0)
 ;
"RTN","XQSMD31",47,0)
 S X="XQSMD USER MENU",DIC=19,DIC(0)="MX" D ^DIC Q:Y'>0
"RTN","XQSMD31",48,0)
 S XQSMDX=$P(Y,U,2),DA(1)=0 F I=1:1 S DA(1)=$O(XQHOLD(DA(1))) Q:DA(1)=""  S X=XQSMDX,DIC="^VA(200,"_DA(1)_",203,",P=3.03,DIC(0)="ML",DLAYGO=200 S:'$D(@(DIC_"0)")) @(DIC_"0)")="^200.03P" D ^DIC
"RTN","XQSMD31",49,0)
 K XQSMDX
"RTN","XQSMD31",50,0)
 Q
"RTN","XQSMD31",51,0)
 ;
"RTN","XQSMD31",52,0)
OUT K DIC,DIK,DA,DISYS,DINUM,POP,XQ,XQD,XQH,XQI,XQJ,XQK,XQL,XQM,XQN,XQT,XQON,XQON0,XQAL,XQDATE,XQDEL,XQDT,XQLEV,XQLK,XQMG,XQMGR,XQNAM,XQNGO,XQUF,XQPRO,XQSTART,XQEND,XQHOLD,XQKEY,X,Y,XY,%,^TMP($J),C,XQU1L
"RTN","XQSMD31",53,0)
 Q
"VER")
8.0^22.0
"BLD",920,6)
^378
**END**
**END**
