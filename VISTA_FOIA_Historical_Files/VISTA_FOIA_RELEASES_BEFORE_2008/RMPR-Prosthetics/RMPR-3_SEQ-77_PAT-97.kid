Released RMPR*3*97 SEQ #77
Extracted from mail message
**KIDS**:RMPR*3.0*97^

**INSTALL NAME**
RMPR*3.0*97
"BLD",5182,0)
RMPR*3.0*97^PROSTHETICS^0^3041020^y
"BLD",5182,1,0)
^^1^1^3040811^
"BLD",5182,1,1,0)
CANCELING A CLONED CONSULT ISSUE
"BLD",5182,4,0)
^9.64PA^^
"BLD",5182,"KRN",0)
^9.67PA^8989.52^19
"BLD",5182,"KRN",.4,0)
.4
"BLD",5182,"KRN",.401,0)
.401
"BLD",5182,"KRN",.402,0)
.402
"BLD",5182,"KRN",.403,0)
.403
"BLD",5182,"KRN",.5,0)
.5
"BLD",5182,"KRN",.84,0)
.84
"BLD",5182,"KRN",3.6,0)
3.6
"BLD",5182,"KRN",3.8,0)
3.8
"BLD",5182,"KRN",9.2,0)
9.2
"BLD",5182,"KRN",9.8,0)
9.8
"BLD",5182,"KRN",9.8,"NM",0)
^9.68A^1^1
"BLD",5182,"KRN",9.8,"NM",1,0)
RMPREOS^^0^B77406409
"BLD",5182,"KRN",9.8,"NM","B","RMPREOS",1)

"BLD",5182,"KRN",19,0)
19
"BLD",5182,"KRN",19.1,0)
19.1
"BLD",5182,"KRN",101,0)
101
"BLD",5182,"KRN",409.61,0)
409.61
"BLD",5182,"KRN",771,0)
771
"BLD",5182,"KRN",870,0)
870
"BLD",5182,"KRN",8989.51,0)
8989.51
"BLD",5182,"KRN",8989.52,0)
8989.52
"BLD",5182,"KRN",8994,0)
8994
"BLD",5182,"KRN","B",.4,.4)

"BLD",5182,"KRN","B",.401,.401)

"BLD",5182,"KRN","B",.402,.402)

"BLD",5182,"KRN","B",.403,.403)

"BLD",5182,"KRN","B",.5,.5)

"BLD",5182,"KRN","B",.84,.84)

"BLD",5182,"KRN","B",3.6,3.6)

"BLD",5182,"KRN","B",3.8,3.8)

"BLD",5182,"KRN","B",9.2,9.2)

"BLD",5182,"KRN","B",9.8,9.8)

"BLD",5182,"KRN","B",19,19)

"BLD",5182,"KRN","B",19.1,19.1)

"BLD",5182,"KRN","B",101,101)

"BLD",5182,"KRN","B",409.61,409.61)

"BLD",5182,"KRN","B",771,771)

"BLD",5182,"KRN","B",870,870)

"BLD",5182,"KRN","B",8989.51,8989.51)

"BLD",5182,"KRN","B",8989.52,8989.52)

"BLD",5182,"KRN","B",8994,8994)

"BLD",5182,"PRE")
RMPRP397
"BLD",5182,"QUES",0)
^9.62^^
"BLD",5182,"REQB",0)
^9.611^1^1
"BLD",5182,"REQB",1,0)
RMPR*3.0*85^1
"BLD",5182,"REQB","B","RMPR*3.0*85",1)

"MBREQ")
0
"PKG",101,-1)
1^1
"PKG",101,0)
PROSTHETICS^RMPR^PROSTHETICS VERSION 3.0 ALPHA
"PKG",101,20,0)
^9.402P^^
"PKG",101,22,0)
^9.49I^1^1
"PKG",101,22,1,0)
3.0^2960209^2960214
"PKG",101,22,1,"PAH",1,0)
97^3041020
"PKG",101,22,1,"PAH",1,1,0)
^^1^1^3041020
"PKG",101,22,1,"PAH",1,1,1,0)
CANCELING A CLONED CONSULT ISSUE
"PRE")
RMPRP397
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
2
"RTN","RMPREOS")
0^1^B77406409
"RTN","RMPREOS",1,0)
RMPREOS ;HINES-CIOFO/HNC -Suspense Processing ; 2/25/04 10:26am
"RTN","RMPREOS",2,0)
 ;;3.0;PROSTHETICS;**45,50,52,55,57,62,80,85,97**;Feb 09, 1996
"RTN","RMPREOS",3,0)
 ;
"RTN","RMPREOS",4,0)
 ;  HNC - patch 52 - 9/22/00 Modify EN2 not to check for RMPRFLAG
"RTN","RMPREOS",5,0)
 ;                           RMPRCLOS, or FLAG.
"RTN","RMPREOS",6,0)
 ;
"RTN","RMPREOS",7,0)
 ;  HNC - patch 55 - 3/12/01 allow other note without initial
"RTN","RMPREOS",8,0)
 ;
"RTN","RMPREOS",9,0)
 ;  HNC - patch 57 - 5/8/01  close out note message
"RTN","RMPREOS",10,0)
 ;
"RTN","RMPREOS",11,0)
 ;  RVD - patch 62 - 8/13/01 link suspense to 2319 records.
"RTN","RMPREOS",12,0)
 ;
"RTN","RMPREOS",13,0)
 ;  HNC - patch 80 - 8/28/03 Type to allow Editing, CLOSE SUSPENSE NOT 
"RTN","RMPREOS",14,0)
 ;                           CLOSED Screen Service for Consult Tracking 
"RTN","RMPREOS",15,0)
 ;                           (per Jerry)
"RTN","RMPREOS",16,0)
 ;
"RTN","RMPREOS",17,0)
 ;  TH  - patch 85 - 2/20/04 Fix bug-overwrite Initial Action Date, 
"RTN","RMPREOS",18,0)
 ;                           Note, and DUZ problem.
"RTN","RMPREOS",19,0)
 ;
"RTN","RMPREOS",20,0)
 ;  KAM - patch 85 - 3/16/04 Allow forwarding of a consult to a "Tracker
"RTN","RMPREOS",21,0)
 ;                           Only" service
"RTN","RMPREOS",22,0)
 ;  KAM - patch 97 - 8/19/04 Stop canceling the original consult when
"RTN","RMPREOS",23,0)
 ;                           canceling the clone (in file 123)
"RTN","RMPREOS",24,0)
 ;  
"RTN","RMPREOS",25,0)
 ;Patch 80 -Read File 123.5 DBIA 3861
"RTN","RMPREOS",26,0)
 ;
"RTN","RMPREOS",27,0)
EN ;Add Manual Suspense
"RTN","RMPREOS",28,0)
 ;
"RTN","RMPREOS",29,0)
 D NOW^%DTC S X=%
"RTN","RMPREOS",30,0)
 S DIC="^RMPR(668,",DIC(0)="AEQLM",DLAYGO=668
"RTN","RMPREOS",31,0)
 S DIC("DR")="1////^S X=RMPRDFN;22R;14////^S X=""O"";8////^S X=DUZ;9////^S X=5;3////^S X=9;2////^S X=RMPR(""STA"")"
"RTN","RMPREOS",32,0)
 K DINUM,D0,DD,DO D FILE^DICN K DLAYGO G:Y'>0 EX S (RDA,DA)=+Y
"RTN","RMPREOS",33,0)
 S DIE="^RMPR(668,",DR="13;4"
"RTN","RMPREOS",34,0)
 L +^RMPR(668,RDA,0):1 I $T=0 W $C(7),?5,!,"Someone else is editing this record" G EX
"RTN","RMPREOS",35,0)
 D ^DIE L -^RMPR(668,RDA,0)
"RTN","RMPREOS",36,0)
 I '$P(^RMPR(668,RDA,0),U,3) S DA=RDA,DIK="^RMPR(668," D ^DIK W !,$C(7),?5,"Deleted..."
"RTN","RMPREOS",37,0)
EX K X,DIC,DIE,DR,Y
"RTN","RMPREOS",38,0)
 Q
"RTN","RMPREOS",39,0)
 ;
"RTN","RMPREOS",40,0)
EN2 ;edit MANUAL suspense record
"RTN","RMPREOS",41,0)
 ;DA must be defined
"RTN","RMPREOS",42,0)
 ;
"RTN","RMPREOS",43,0)
 I $P(^RMPR(668,DA,0),U,8)'>4 W !!!,"Can Not Edit This Suspense Record!",!! H 2 Q
"RTN","RMPREOS",44,0)
PROC L +^RMPR(668,DA):1 I $T=0 W !,?5,$C(7),"Someone else is Editing this entry!" Q
"RTN","RMPREOS",45,0)
 S RO=$G(^RMPR(668,DA,0)),Y=$P(^(0),U,1) X ^DD("DD")
"RTN","RMPREOS",46,0)
 W "   ",Y,"  ",$E($P(^DPT($P(RO,U,2),0),U,1),1,20)
"RTN","RMPREOS",47,0)
 ;
"RTN","RMPREOS",48,0)
 S RZ="S RX=$P(RO,U,3),RR=$S(RX=1:""PSC"",RX=2:""2421"",RX=3:""2237"",RX=4:""2529-3"",RX=5:""2529-7"",RX=6:""2474"",RX=7:""2431"",RX=8:""2914"",RX=9:""OTHER"",RX=10:""2520"",RX=11:""STOCK ISSUE"",1:""NONE"")"
"RTN","RMPREOS",49,0)
 X RZ
"RTN","RMPREOS",50,0)
 W "  ",RR,"  ",$S($P(RO,U,5)?7N.N:"CLOSED",1:"OPEN")
"RTN","RMPREOS",51,0)
 S DIE="^RMPR(668,"
"RTN","RMPREOS",52,0)
 ;Q:$D(RMPRFLAG)!$D(RMPRCLOS)!$D(FLAG)
"RTN","RMPREOS",53,0)
 S DR="2R;22R;3;13;4"
"RTN","RMPREOS",54,0)
 D ^DIE
"RTN","RMPREOS",55,0)
 L -^RMPR(668,DA)
"RTN","RMPREOS",56,0)
 Q
"RTN","RMPREOS",57,0)
ENIA ;initial action note
"RTN","RMPREOS",58,0)
 ;
"RTN","RMPREOS",59,0)
 I $D(^RMPR(668,DA,3)) W !!!,"Initial Action Note Already Posted!",!! H 2 Q
"RTN","RMPREOS",60,0)
 L +^RMPR(668,DA):1 I $T=0 W !,?5,$C(7),"Someone else is Editing this entry!" Q
"RTN","RMPREOS",61,0)
 D NOW^%DTC S RMPREODT=%
"RTN","RMPREOS",62,0)
 ;link suspense to 2319 record, patch #62
"RTN","RMPREOS",63,0)
 I $D(^TMP($J,"RMPRPCE",660)) S ^TMP($J,"RMPRPCE",668,DA)="" D SEL60^RMPRPCEL
"RTN","RMPREOS",64,0)
 S DIE="^RMPR(668,"
"RTN","RMPREOS",65,0)
 S DR="7"
"RTN","RMPREOS",66,0)
 D ^DIE
"RTN","RMPREOS",67,0)
 I $D(^RMPR(668,DA,3)) S DR="10////^S X=RMPREODT;16////^S X=DUZ;14///^S X=""P""" D ^DIE
"RTN","RMPREOS",68,0)
 L -^RMPR(668,DA)
"RTN","RMPREOS",69,0)
 ;check for a note here
"RTN","RMPREOS",70,0)
 I '$D(^RMPR(668,DA,3)) Q
"RTN","RMPREOS",71,0)
 ;consult ien
"RTN","RMPREOS",72,0)
 S GMRCO=$P(^RMPR(668,DA,0),U,15) Q:GMRCO=""
"RTN","RMPREOS",73,0)
 ;note in array
"RTN","RMPREOS",74,0)
 S RMPRCMT=0
"RTN","RMPREOS",75,0)
 F  S RMPRCMT=$O(^RMPR(668,DA,3,RMPRCMT)) Q:RMPRCMT=""  D
"RTN","RMPREOS",76,0)
 .S GMRCMT(RMPRCMT)=^RMPR(668,DA,3,RMPRCMT,0)
"RTN","RMPREOS",77,0)
 I $G(GMRCMT)="" S GMRCMT="nothing noted"
"RTN","RMPREOS",78,0)
 ;call api
"RTN","RMPREOS",79,0)
 S RMGMRCO=$$RC^GMRCGUIA(.GMRCO,DUZ,RMPREODT,.GMRCMT,DUZ)
"RTN","RMPREOS",80,0)
 K RMPREODT,GMRCO,RMGMRCO,GMRCMT,RMPRCMT
"RTN","RMPREOS",81,0)
 Q
"RTN","RMPREOS",82,0)
FORW ;forward consult
"RTN","RMPREOS",83,0)
 I $P(^RMPR(668,DA,0),U,8)>4 W !!!,"Can Not Forward.",!! H 2 Q
"RTN","RMPREOS",84,0)
 I $D(^RMPR(668,DA,4,1,0)) W !!!,"Completion Note Already Posted!",!! H 2 Q
"RTN","RMPREOS",85,0)
 D NOW^%DTC S RMPREODT=%,GMRCAD=%
"RTN","RMPREOS",86,0)
 ;lookup service to forward consult
"RTN","RMPREOS",87,0)
 ;S DIC("S")="I '$P(^(0),U,2),'+$G(^GMR(123.5,+Y,""IFC""))" ;*85
"RTN","RMPREOS",88,0)
 S DIC("S")="I $$SCR^RMPREOS(+Y,DUZ)"                       ;*85
"RTN","RMPREOS",89,0)
 S DIC="^GMR(123.5,",DIC(0)="AEQ"
"RTN","RMPREOS",90,0)
 S DIC("A")="Select Service To Forward Consult: "
"RTN","RMPREOS",91,0)
 D ^DIC
"RTN","RMPREOS",92,0)
 I (+Y'>0)!($D(DTOUT))!$D(DUOUT) W !!,"Not Forwarded! No Service Selected ." H 2 K DIC Q
"RTN","RMPREOS",93,0)
 S GMRCSS=+Y
"RTN","RMPREOS",94,0)
 L +^RMPR(668,DA):1 I $T=0 W !,?5,$C(7),"Someone else is Editing this entry!"
"RTN","RMPREOS",95,0)
 S DIE="^RMPR(668,"
"RTN","RMPREOS",96,0)
 ;stuff Consult forward service
"RTN","RMPREOS",97,0)
 S DR="23////^S X=GMRCSS"
"RTN","RMPREOS",98,0)
 D ^DIE
"RTN","RMPREOS",99,0)
 Q:'$P($G(^RMPR(668,DA,8)),U,6)
"RTN","RMPREOS",100,0)
 S DR="12"
"RTN","RMPREOS",101,0)
 D ^DIE
"RTN","RMPREOS",102,0)
 I $D(^RMPR(668,DA,4,1,0)) S DR="5////^S X=RMPREODT;6////^S X=DUZ;14///^S X=""C""" D ^DIE
"RTN","RMPREOS",103,0)
 ;must have a note
"RTN","RMPREOS",104,0)
 I '$D(^RMPR(668,DA,4,1,0)) W !!,"Must Have Note to Forward. Consult Not Forwarded." S $P(^RMPR(668,DA,8),U,6)="" H 2 Q
"RTN","RMPREOS",105,0)
 ;
"RTN","RMPREOS",106,0)
 ; set initial action note if null
"RTN","RMPREOS",107,0)
 ;I '$P(^RMPR(668,DA,0),U,10) D
"RTN","RMPREOS",108,0)
 ;
"RTN","RMPREOS",109,0)
 ; Check if Initial Action Date is null
"RTN","RMPREOS",110,0)
 I $P(^RMPR(668,DA,0),U,9)="" D
"RTN","RMPREOS",111,0)
 .S DIE="^RMPR(668,"
"RTN","RMPREOS",112,0)
 .; Set Initial Action Note
"RTN","RMPREOS",113,0)
 .S DR="7///^S X=""See Completion Note, this was forwarded to another service."""
"RTN","RMPREOS",114,0)
 .D ^DIE
"RTN","RMPREOS",115,0)
 .; Set Initial Action Date and Initial Action By 
"RTN","RMPREOS",116,0)
 .;S DR="10////^S X=RMPREODT;16////^S X=DUZ;24////^S X=DUZ" D ^DIE
"RTN","RMPREOS",117,0)
 .S DR="10////^S X=RMPREODT;16////^S X=DUZ" D ^DIE
"RTN","RMPREOS",118,0)
 ;
"RTN","RMPREOS",119,0)
 ; Set Forwarded By
"RTN","RMPREOS",120,0)
 S DR="24////^S X=DUZ" D ^DIE
"RTN","RMPREOS",121,0)
 ;
"RTN","RMPREOS",122,0)
 L -^RMPR(668,DA)
"RTN","RMPREOS",123,0)
 K RMPREODT
"RTN","RMPREOS",124,0)
 S GMRCO=$P(^RMPR(668,DA,0),U,15)
"RTN","RMPREOS",125,0)
 Q:GMRCO=""
"RTN","RMPREOS",126,0)
 ;note in array
"RTN","RMPREOS",127,0)
 S RMPRCOM=0
"RTN","RMPREOS",128,0)
 F  S RMPRCOM=$O(^RMPR(668,DA,4,RMPRCOM)) Q:RMPRCOM=""  D
"RTN","RMPREOS",129,0)
 .S GMRCOM(RMPRCOM)=^RMPR(668,DA,4,RMPRCOM,0)
"RTN","RMPREOS",130,0)
 I $G(GMRCOM)="" S GMRCOM="not noted"
"RTN","RMPREOS",131,0)
 S GMRCORNP=DUZ
"RTN","RMPREOS",132,0)
 S GMRCURGI=""
"RTN","RMPREOS",133,0)
 S GMRCATTN=""
"RTN","RMPREOS",134,0)
 S BDC=$$FR^GMRCGUIA(.GMRCO,.GMRCSS,.GMRCORNP,.GMRCATTN,.GMRCURGI,.GMRCOM,.GMRCAD)
"RTN","RMPREOS",135,0)
 I +BDC=1 W !!,"ERROR, DID NOT FORWARD!" H 2
"RTN","RMPREOS",136,0)
 W !!,"Consult Forwarded." H 2
"RTN","RMPREOS",137,0)
 K GMRCO,GMRCSS,GMRCORNP,GMRCATTN,GMRCURGI,GMRCOM,GMRCAD
"RTN","RMPREOS",138,0)
 Q
"RTN","RMPREOS",139,0)
CLNT ;post closed note
"RTN","RMPREOS",140,0)
 ;
"RTN","RMPREOS",141,0)
 I $P(^RMPR(668,DA,0),U,10)="C" W !!!,"Completion Note Already Posted!",!! H 2 Q
"RTN","RMPREOS",142,0)
 L +^RMPR(668,DA):1 I $T=0 W !,?5,$C(7),"Someone else is Editing this entry!" Q
"RTN","RMPREOS",143,0)
 D NOW^%DTC S RMPREODT=%,GMRCAD=%
"RTN","RMPREOS",144,0)
 ;link suspense to 2319 record, patch #62
"RTN","RMPREOS",145,0)
 I $D(^TMP($J,"RMPRPCE",660)) S ^TMP($J,"RMPRPCE",668,DA)="" D SEL60^RMPRPCEL
"RTN","RMPREOS",146,0)
 S DIE="^RMPR(668,"
"RTN","RMPREOS",147,0)
 S DR="12"
"RTN","RMPREOS",148,0)
 D ^DIE
"RTN","RMPREOS",149,0)
 I '$D(^RMPR(668,DA,4)) Q
"RTN","RMPREOS",150,0)
 I $D(^RMPR(668,DA,4)) S DR="5////^S X=RMPREODT;6////^S X=DUZ;14///^S X=""C""" D ^DIE
"RTN","RMPREOS",151,0)
 ;set initial action note if null
"RTN","RMPREOS",152,0)
 I '$P(^RMPR(668,DA,0),U,9) D
"RTN","RMPREOS",153,0)
 .S DIE="^RMPR(668,"
"RTN","RMPREOS",154,0)
 .S DR="7///^S X=""See Completion Note for Initial Action Taken."""
"RTN","RMPREOS",155,0)
 .D ^DIE
"RTN","RMPREOS",156,0)
 .S DR="10////^S X=RMPREODT;16////^S X=DUZ" D ^DIE
"RTN","RMPREOS",157,0)
 ;added by #62.  Once closed, update all 2319 record for initial and
"RTN","RMPREOS",158,0)
 ;completion date
"RTN","RMPREOS",159,0)
 D ICDT^RMPRPCEL(DA)
"RTN","RMPREOS",160,0)
 ;
"RTN","RMPREOS",161,0)
 L -^RMPR(668,DA)
"RTN","RMPREOS",162,0)
 K RMPREODT
"RTN","RMPREOS",163,0)
 S GMRCO=$P(^RMPR(668,DA,0),U,15)
"RTN","RMPREOS",164,0)
 Q:GMRCO=""
"RTN","RMPREOS",165,0)
 ;note in array
"RTN","RMPREOS",166,0)
 S RMPRCOM=0
"RTN","RMPREOS",167,0)
 F  S RMPRCOM=$O(^RMPR(668,DA,4,RMPRCOM)) Q:RMPRCOM=""  D
"RTN","RMPREOS",168,0)
 .S GMRCOM(RMPRCOM)=^RMPR(668,DA,4,RMPRCOM,0)
"RTN","RMPREOS",169,0)
 I $G(GMRCOM)="" S GMRCOM="not noted"
"RTN","RMPREOS",170,0)
 S GMRCSF="U"
"RTN","RMPREOS",171,0)
 S GMRCA=10
"RTN","RMPREOS",172,0)
 S GMRCALF="N"
"RTN","RMPREOS",173,0)
 S GMRCATO=""
"RTN","RMPREOS",174,0)
 S (GMRCORNP,GMRCDUZ)=DUZ
"RTN","RMPREOS",175,0)
 S BDC=$$SFILE^GMRCGUIB(.GMRCO,.GMRCA,.GMRCSF,.GMRCORNP,.GMRCDUZ,.GMRCOM,.GMRCALF,.GMRCATO,.GMRCAD)
"RTN","RMPREOS",176,0)
 I +BDC=1 W !!,$P(BDC,U,2) H 2
"RTN","RMPREOS",177,0)
 K GMRCO,GMRCA,GMRCSF,GMRCORNP,GMRCDUZ,GMRCOM,GMRCALF,GMRCATO,GMRCAD
"RTN","RMPREOS",178,0)
 Q
"RTN","RMPREOS",179,0)
OACT ;other notes - no initial needed 3/12/01
"RTN","RMPREOS",180,0)
 ;stuff date/time in.01
"RTN","RMPREOS",181,0)
 ;delete if no note
"RTN","RMPREOS",182,0)
 ;I '$D(^RMPR(668,DA,3,1,0)) W !!!,"No Initial Action Taken... ",!! H 2 Q
"RTN","RMPREOS",183,0)
 ;
"RTN","RMPREOS",184,0)
 L +^RMPR(668,DA):1 I $T=0 W !,?5,$C(7),"Someone else is Editing this entry!" Q
"RTN","RMPREOS",185,0)
 ;link suspense to 2319 record, patch #62
"RTN","RMPREOS",186,0)
 I $D(^TMP($J,"RMPRPCE",660)) S ^TMP($J,"RMPRPCE",668,DA)="" D SEL60^RMPRPCEL
"RTN","RMPREOS",187,0)
 S DA(1)=DA,RMPRDA1=DA
"RTN","RMPREOS",188,0)
 S DIC="^RMPR(668,"_DA(1)_",1,"
"RTN","RMPREOS",189,0)
 S DIC(0)="CQL"
"RTN","RMPREOS",190,0)
 S DIC("P")=$P(^DD(668,11,0),U,2)
"RTN","RMPREOS",191,0)
 D NOW^%DTC S X=%,GMRCWHN=%
"RTN","RMPREOS",192,0)
 S DLAYGO=688
"RTN","RMPREOS",193,0)
 D ^DIC
"RTN","RMPREOS",194,0)
 I Y=-1 K DIC,DA Q
"RTN","RMPREOS",195,0)
 S DIE=DIC K DIC
"RTN","RMPREOS",196,0)
 S (DA,RMPRDA2)=+Y
"RTN","RMPREOS",197,0)
 S DR="1" D ^DIE
"RTN","RMPREOS",198,0)
 K DIE,DR,Y
"RTN","RMPREOS",199,0)
 I '$D(^RMPR(668,RMPRDA1,1,RMPRDA2,1,0)) D  Q
"RTN","RMPREOS",200,0)
 .;delete the record if no note
"RTN","RMPREOS",201,0)
 .S DIK="^RMPR(668,RMPRDA1,1,"
"RTN","RMPREOS",202,0)
 .S DA=RMPRDA2
"RTN","RMPREOS",203,0)
 .D ^DIK
"RTN","RMPREOS",204,0)
 .K DA,DIA,RMPRDA1,RMPRDA2,GMRCWHN
"RTN","RMPREOS",205,0)
 ;send data to consults if note
"RTN","RMPREOS",206,0)
 S GMRCO=$P(^RMPR(668,RMPRDA1,0),U,15)
"RTN","RMPREOS",207,0)
 I GMRCO="" Q
"RTN","RMPREOS",208,0)
 ;GMRCOM is comment array
"RTN","RMPREOS",209,0)
 S RMPRCOM=0
"RTN","RMPREOS",210,0)
 F  S RMPRCOM=$O(^RMPR(668,RMPRDA1,1,RMPRDA2,1,RMPRCOM)) Q:RMPRCOM=""  D
"RTN","RMPREOS",211,0)
 .S GMRCOM(RMPRCOM)=^RMPR(668,RMPRDA1,1,RMPRDA2,1,RMPRCOM,0)
"RTN","RMPREOS",212,0)
 ;
"RTN","RMPREOS",213,0)
 L -^RMPR(668,RMPRDA1)
"RTN","RMPREOS",214,0)
 ;GMRCWHN was set to date/time
"RTN","RMPREOS",215,0)
 D CMT^GMRCGUIB(.GMRCO,.GMRCOM,"",.GMRCWHN,DUZ)
"RTN","RMPREOS",216,0)
 ;check ok
"RTN","RMPREOS",217,0)
 K DA,DIK,RMPRDA1,RMPRDA2,RMPRCOM,GMRCOM,GMRCO,GMRCWHN
"RTN","RMPREOS",218,0)
 Q
"RTN","RMPREOS",219,0)
CANCEL ;cancel suspense
"RTN","RMPREOS",220,0)
 ;set status to X and cancelled by to duz, date/time.
"RTN","RMPREOS",221,0)
 ;start
"RTN","RMPREOS",222,0)
 ;
"RTN","RMPREOS",223,0)
 I $P(^RMPR(668,DA,0),U,5)'="" W !!!,"This has already been completed, cannot cancel!",!! H 2  Q
"RTN","RMPREOS",224,0)
 L +^RMPR(668,DA):1 I $T=0 W !,?5,$C(7),"Someone else is Editing this entry!" Q
"RTN","RMPREOS",225,0)
 K Y
"RTN","RMPREOS",226,0)
 S DIR(0)="Y",DIR("B")="N"
"RTN","RMPREOS",227,0)
 W !!!,"This will CANCEL/DELETE this Suspense Request."
"RTN","RMPREOS",228,0)
 S DIR("A")="Are you sure you want to CANCEL/DELETE this Suspense Request? (Y/N) "
"RTN","RMPREOS",229,0)
 D ^DIR I $D(DTOUT)!$D(DUOUT)!(Y="^")!(Y=0) W !!,"Suspense Not Cancelled!" H 2  Q
"RTN","RMPREOS",230,0)
 D NOW^%DTC S RMPREODT=%
"RTN","RMPREOS",231,0)
 S DIE="^RMPR(668,"
"RTN","RMPREOS",232,0)
 S DR="14///^S X=""X"";17////^S X=DUZ;18////^S X=RMPREODT;9"
"RTN","RMPREOS",233,0)
 D ^DIE
"RTN","RMPREOS",234,0)
 W !!,?5,"DELETED/CANCELLED!" H 2
"RTN","RMPREOS",235,0)
 L -^RMPR(668,DA)
"RTN","RMPREOS",236,0)
 ;consult ien
"RTN","RMPREOS",237,0)
 S GMRCO=$P(^RMPR(668,DA,0),U,15) Q:GMRCO=""
"RTN","RMPREOS",238,0)
 ;note in array
"RTN","RMPREOS",239,0)
 S RMPRCMT=0
"RTN","RMPREOS",240,0)
 F  S RMPRCMT=$O(^RMPR(668,DA,9,RMPRCMT)) Q:RMPRCMT=""  D
"RTN","RMPREOS",241,0)
 .S GMRCMT(RMPRCMT)=^RMPR(668,DA,9,RMPRCMT,0)
"RTN","RMPREOS",242,0)
 I $G(GMRCMT)="" S GMRCMT="nothing noted"
"RTN","RMPREOS",243,0)
 ;call api
"RTN","RMPREOS",244,0)
 ;DY for cancelled, deny
"RTN","RMPREOS",245,0)
 S GMRCACTM="DY"
"RTN","RMPREOS",246,0)
 ; PATCH RMPR*3*97 if canceling a clone do not update file 123 7=clone
"RTN","RMPREOS",247,0)
 I $P(^RMPR(668,DA,0),U,8)'=7 D
"RTN","RMPREOS",248,0)
 . S RMGMRCO=$$DC^GMRCGUIA(.GMRCO,DUZ,RMPREODT,.GMRCACTM,.GMRCMT)
"RTN","RMPREOS",249,0)
 K RMPREODT,GMRCMT,RMPRCMT,GMRCACTM
"RTN","RMPREOS",250,0)
 Q
"RTN","RMPREOS",251,0)
 ;
"RTN","RMPREOS",252,0)
LINK60 ;link suspense to 2319 records
"RTN","RMPREOS",253,0)
 S RMSERR=0
"RTN","RMPREOS",254,0)
 F RMSI=0:0 S RMSI=$O(^TMP($J,"RMPRPCE",660,RMSI)) Q:RMSI'>0  D
"RTN","RMPREOS",255,0)
 .S RMSAMIS=$G(^TMP($J,"RMPRPCE",660,RMSI))
"RTN","RMPREOS",256,0)
 .;call update 668
"RTN","RMPREOS",257,0)
 .S RMSERR=$$UP68^RMPRPCE1(RMSI,DA,+RMSAMIS)
"RTN","RMPREOS",258,0)
 Q:RMSERR=1
"RTN","RMPREOS",259,0)
 S ^TMP($J,"RMPRPCE",668,DA)=""
"RTN","RMPREOS",260,0)
 Q
"RTN","RMPREOS",261,0)
 ;end
"RTN","RMPREOS",262,0)
SCR(SERV,USR) ; SCREEN SERVICES THAT CAN BE FORWARDED TO ,RMPR*3*85
"RTN","RMPREOS",263,0)
 N USAGE
"RTN","RMPREOS",264,0)
 S USAGE=$P(^GMR(123.5,SERV,0),U,2)
"RTN","RMPREOS",265,0)
 I USAGE=9!(USAGE=1) Q 0  ;disabled or grouper service
"RTN","RMPREOS",266,0)
 I USAGE=2 Q $$VALIDU^GMRCAU(SERV,USR)  ;tracking and check update user
"RTN","RMPREOS",267,0)
 Q 1  ;service usage must be null = O
"RTN","RMPRP397")
0^^B841343
"RTN","RMPRP397",1,0)
RMPRP397 ;BAY/KAM-Patch RMPR*3*97 Install Utility Routine ;8/25/04 10:10am
"RTN","RMPRP397",2,0)
 ;;3.0;Prosthetics;**97**;AUG 13, 1993
"RTN","RMPRP397",3,0)
 ;
"RTN","RMPRP397",4,0)
ENV ;Main Entry point for Environment Check
"RTN","RMPRP397",5,0)
 S XPDABORT=""
"RTN","RMPRP397",6,0)
 D PROGCHK(.XPDABORT) ;checks programmer variables
"RTN","RMPRP397",7,0)
 I XPDABORT="" K XPDABORT
"RTN","RMPRP397",8,0)
 Q
"RTN","RMPRP397",9,0)
PROGCHK(XPDABORT) ; checks for necessary programmer variables
"RTN","RMPRP397",10,0)
 ;
"RTN","RMPRP397",11,0)
 I '$G(DUZ)!($G(DUZ(0))'="@")!('$G(DT))!($G(U)'="^")  D
"RTN","RMPRP397",12,0)
 . D BMES^XPDUTL("****")
"RTN","RMPRP397",13,0)
 . D MES^XPDUTL("Your programming variables are not set up properly.")
"RTN","RMPRP397",14,0)
 . D MES^XPDUTL("Installation aborted.")
"RTN","RMPRP397",15,0)
 . D MES^XPDUTL("*****")
"RTN","RMPRP397",16,0)
 . S XPDABORT=2
"RTN","RMPRP397",17,0)
 Q
"VER")
8.0^22
**END**
**END**
