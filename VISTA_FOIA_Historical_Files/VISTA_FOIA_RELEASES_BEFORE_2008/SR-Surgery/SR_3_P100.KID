KIDS Distribution saved on Mar 03, 2004@10:31:04
Surgery Patch SR*3*100
**KIDS**:SR*3.0*100^

**INSTALL NAME**
SR*3.0*100
"BLD",3077,0)
SR*3.0*100^SURGERY^0^3040303^y
"BLD",3077,1,0)
^^12^12^3030916^
"BLD",3077,1,1,0)
This patch provides the ability to electronically sign operative reports 
"BLD",3077,1,2,0)
contained within the VISTA Surgery V. 3.0 application. These reports
"BLD",3077,1,3,0)
include the Operation Report, the Nurse Intraoperative Report, the
"BLD",3077,1,4,0)
Anesthesia Report and the Procedure Report (Non-O.R.). This patch provides
"BLD",3077,1,5,0)
the ability to view these signed reports through the Computerized Patient
"BLD",3077,1,6,0)
Record System (CPRS) by storing them in the Text Integration Utilities
"BLD",3077,1,7,0)
(TIU) V. 1.0 application. Tools provided by the TIU software will be used
"BLD",3077,1,8,0)
to sign and manage the electronic documents.
"BLD",3077,1,9,0)
 
"BLD",3077,1,10,0)
Features provided by this patch are described in the Surgery Electronic 
"BLD",3077,1,11,0)
Signature for Operative Reports Release Notes and in the Surgery 
"BLD",3077,1,12,0)
Electronic Signature for Operative Reports Implementation Guide.
"BLD",3077,4,0)
^9.64PA^133^2
"BLD",3077,4,130,0)
130
"BLD",3077,4,130,2,0)
^9.641^130.02^6
"BLD",3077,4,130,2,130,0)
SURGERY  (File-top level)
"BLD",3077,4,130,2,130,1,0)
^9.6411^131^23
"BLD",3077,4,130,2,130,1,.09,0)
DATE OF OPERATION
"BLD",3077,4,130,2,130,1,.14,0)
SURGEON
"BLD",3077,4,130,2,130,1,.164,0)
ATTEND SURG
"BLD",3077,4,130,2,130,1,.21,0)
ANES CARE START TIME
"BLD",3077,4,130,2,130,1,.23,0)
TIME OPERATION ENDS
"BLD",3077,4,130,2,130,1,.232,0)
TIME PAT OUT OR
"BLD",3077,4,130,2,130,1,.24,0)
ANES CARE END TIME
"BLD",3077,4,130,2,130,1,.31,0)
PRINC ANESTHETIST
"BLD",3077,4,130,2,130,1,.34,0)
ANESTHESIOLOGIST SUPVR
"BLD",3077,4,130,2,130,1,1.19,0)
POSTOP ANES NOTE DATE
"BLD",3077,4,130,2,130,1,1.2,0)
POSTOP ANES NOTE
"BLD",3077,4,130,2,130,1,15,0)
DATE/TIME OF DICTATION
"BLD",3077,4,130,2,130,1,122,0)
TIME PROCEDURE ENDED
"BLD",3077,4,130,2,130,1,123,0)
PROVIDER
"BLD",3077,4,130,2,130,1,124,0)
ATTEND PROVIDER
"BLD",3077,4,130,2,130,1,131,0)
DEVICE(S)
"BLD",3077,4,130,2,130,1,1000,0)
TIU OPERATIVE SUMMARY
"BLD",3077,4,130,2,130,1,1001,0)
TIU NURSE INTRAOP REPORT
"BLD",3077,4,130,2,130,1,1002,0)
TIU PROCEDURE REPORT (NON-OR)
"BLD",3077,4,130,2,130,1,1003,0)
TIU ANESTHESIA REPORT
"BLD",3077,4,130,2,130,1,1004,0)
DICTATED SUMMARY EXPECTED
"BLD",3077,4,130,2,130,1,1005,0)
CPT ON NURSE REPORT
"BLD",3077,4,130,2,130,1,1006,0)
ICD-9 ON NURSE REPORT
"BLD",3077,4,130,2,130.0129,0)
LASER UNIT  (sub-file)
"BLD",3077,4,130,2,130.0129,1,0)
^9.6411^^0
"BLD",3077,4,130,2,130.013,0)
CELL SAVER  (sub-file)
"BLD",3077,4,130,2,130.013,1,0)
^9.6411^^0
"BLD",3077,4,130,2,130.0134,0)
DISPOSABLES USED  (sub-file)
"BLD",3077,4,130,2,130.0134,1,0)
^9.6411^^0
"BLD",3077,4,130,2,130.02,0)
TIME TOURNIQUET APPLIED  (sub-file)
"BLD",3077,4,130,2,130.02,1,0)
^9.6411^1^2
"BLD",3077,4,130,2,130.02,1,.01,0)
TIME TOURNIQUET APPLIED
"BLD",3077,4,130,2,130.02,1,1,0)
SITE APPLIED
"BLD",3077,4,130,2,130.28,0)
OR CIRC SUPPORT  (sub-file)
"BLD",3077,4,130,2,130.28,1,0)
^9.6411^.01^1
"BLD",3077,4,130,2,130.28,1,.01,0)
OR CIRC SUPPORT
"BLD",3077,4,130,222)
y^n^p^^^^n
"BLD",3077,4,133,0)
133
"BLD",3077,4,133,2,0)
^9.641^133^1
"BLD",3077,4,133,2,133,0)
SURGERY SITE PARAMETERS  (File-top level)
"BLD",3077,4,133,2,133,1,0)
^9.6411^42^5
"BLD",3077,4,133,2,133,1,6,0)
CANCEL IVS
"BLD",3077,4,133,2,133,1,38,0)
CPT ON NURSE INTRAOP
"BLD",3077,4,133,2,133,1,39,0)
ICD-9 ON NURSE INTRAOP
"BLD",3077,4,133,2,133,1,40,0)
ANESTHESIA REPORT IN USE
"BLD",3077,4,133,2,133,1,42,0)
DEFAULT CLINIC FOR DOCUMENTS
"BLD",3077,4,133,222)
y^n^p^^^^n
"BLD",3077,4,"APDD",130,130)

"BLD",3077,4,"APDD",130,130,.09)

"BLD",3077,4,"APDD",130,130,.14)

"BLD",3077,4,"APDD",130,130,.164)

"BLD",3077,4,"APDD",130,130,.21)

"BLD",3077,4,"APDD",130,130,.23)

"BLD",3077,4,"APDD",130,130,.232)

"BLD",3077,4,"APDD",130,130,.24)

"BLD",3077,4,"APDD",130,130,.31)

"BLD",3077,4,"APDD",130,130,.34)

"BLD",3077,4,"APDD",130,130,1.19)

"BLD",3077,4,"APDD",130,130,1.2)

"BLD",3077,4,"APDD",130,130,15)

"BLD",3077,4,"APDD",130,130,122)

"BLD",3077,4,"APDD",130,130,123)

"BLD",3077,4,"APDD",130,130,124)

"BLD",3077,4,"APDD",130,130,131)

"BLD",3077,4,"APDD",130,130,1000)

"BLD",3077,4,"APDD",130,130,1001)

"BLD",3077,4,"APDD",130,130,1002)

"BLD",3077,4,"APDD",130,130,1003)

"BLD",3077,4,"APDD",130,130,1004)

"BLD",3077,4,"APDD",130,130,1005)

"BLD",3077,4,"APDD",130,130,1006)

"BLD",3077,4,"APDD",130,130.0129)

"BLD",3077,4,"APDD",130,130.013)

"BLD",3077,4,"APDD",130,130.0134)

"BLD",3077,4,"APDD",130,130.02)

"BLD",3077,4,"APDD",130,130.02,.01)

"BLD",3077,4,"APDD",130,130.02,1)

"BLD",3077,4,"APDD",130,130.28)

"BLD",3077,4,"APDD",130,130.28,.01)

"BLD",3077,4,"APDD",133,133)

"BLD",3077,4,"APDD",133,133,6)

"BLD",3077,4,"APDD",133,133,38)

"BLD",3077,4,"APDD",133,133,39)

"BLD",3077,4,"APDD",133,133,40)

"BLD",3077,4,"APDD",133,133,42)

"BLD",3077,4,"B",130,130)

"BLD",3077,4,"B",133,133)

"BLD",3077,"ABPKG")
n
"BLD",3077,"INI")
PRE^SR100UTL
"BLD",3077,"INID")
y
"BLD",3077,"INIT")
POST^SR100UTL
"BLD",3077,"KRN",0)
^9.67PA^19^17
"BLD",3077,"KRN",.4,0)
.4
"BLD",3077,"KRN",.401,0)
.401
"BLD",3077,"KRN",.401,"NM",0)
^9.68A^^
"BLD",3077,"KRN",.402,0)
.402
"BLD",3077,"KRN",.402,"NM",0)
^9.68A^7^5
"BLD",3077,"KRN",.402,"NM",1,0)
SRNON-OR    FILE #130^130^0
"BLD",3077,"KRN",.402,"NM",3,0)
SROARPT    FILE #130^130^0
"BLD",3077,"KRN",.402,"NM",4,0)
SROMEN-OPER    FILE #130^130^0
"BLD",3077,"KRN",.402,"NM",5,0)
SRONRPT    FILE #130^130^0
"BLD",3077,"KRN",.402,"NM",7,0)
SRPARAM    FILE #133^133^0
"BLD",3077,"KRN",.402,"NM","B","SRNON-OR    FILE #130",1)

"BLD",3077,"KRN",.402,"NM","B","SROARPT    FILE #130",3)

"BLD",3077,"KRN",.402,"NM","B","SROMEN-OPER    FILE #130",4)

"BLD",3077,"KRN",.402,"NM","B","SRONRPT    FILE #130",5)

"BLD",3077,"KRN",.402,"NM","B","SRPARAM    FILE #133",7)

"BLD",3077,"KRN",.403,0)
.403
"BLD",3077,"KRN",.5,0)
.5
"BLD",3077,"KRN",.84,0)
.84
"BLD",3077,"KRN",3.6,0)
3.6
"BLD",3077,"KRN",3.8,0)
3.8
"BLD",3077,"KRN",9.2,0)
9.2
"BLD",3077,"KRN",9.8,0)
9.8
"BLD",3077,"KRN",9.8,"NM",0)
^9.68A^165^156
"BLD",3077,"KRN",9.8,"NM",1,0)
SRHLORU^^0^B12930727
"BLD",3077,"KRN",9.8,"NM",2,0)
SRHLUI^^0^B28751024
"BLD",3077,"KRN",9.8,"NM",3,0)
SRO1L1^^0^B14683246
"BLD",3077,"KRN",9.8,"NM",4,0)
SROACAR^^0^B12022127
"BLD",3077,"KRN",9.8,"NM",5,0)
SROACAT^^0^B8725623
"BLD",3077,"KRN",9.8,"NM",6,0)
SROACLN^^0^B8983747
"BLD",3077,"KRN",9.8,"NM",8,0)
SROACOP^^0^B22746926
"BLD",3077,"KRN",9.8,"NM",9,0)
SROACPM^^0^B39419828
"BLD",3077,"KRN",9.8,"NM",10,0)
SROADEL^^0^B8400705
"BLD",3077,"KRN",9.8,"NM",11,0)
SROAERR^^0^B5386275
"BLD",3077,"KRN",9.8,"NM",12,0)
SROAL1^^0^B21128005
"BLD",3077,"KRN",9.8,"NM",13,0)
SROAL2^^0^B18808436
"BLD",3077,"KRN",9.8,"NM",14,0)
SROALEN^^0^B11768211
"BLD",3077,"KRN",9.8,"NM",15,0)
SROALN2^^0^B9183649
"BLD",3077,"KRN",9.8,"NM",16,0)
SROALSS^^0^B18472594
"BLD",3077,"KRN",9.8,"NM",17,0)
SROALSSP^^0^B18279057
"BLD",3077,"KRN",9.8,"NM",18,0)
SROALST^^0^B14176066
"BLD",3077,"KRN",9.8,"NM",19,0)
SROALSTP^^0^B13266033
"BLD",3077,"KRN",9.8,"NM",20,0)
SROANEW^^0^B18219189
"BLD",3077,"KRN",9.8,"NM",21,0)
SROANIN^^0^B5016187
"BLD",3077,"KRN",9.8,"NM",22,0)
SROANR^^0^B14108247
"BLD",3077,"KRN",9.8,"NM",23,0)
SROANR0^^0^B26261663
"BLD",3077,"KRN",9.8,"NM",24,0)
SROANR1^^0^B11861888
"BLD",3077,"KRN",9.8,"NM",25,0)
SROANT^^0^B12088246
"BLD",3077,"KRN",9.8,"NM",26,0)
SROANTP^^0^B12272179
"BLD",3077,"KRN",9.8,"NM",27,0)
SROANTS^^0^B14690682
"BLD",3077,"KRN",9.8,"NM",28,0)
SROANTSP^^0^B13524175
"BLD",3077,"KRN",9.8,"NM",29,0)
SROAO^^0^B9259852
"BLD",3077,"KRN",9.8,"NM",30,0)
SROAOP^^0^B17646898
"BLD",3077,"KRN",9.8,"NM",31,0)
SROAOP2^^0^B11448606
"BLD",3077,"KRN",9.8,"NM",32,0)
SROAPM^^0^B40056466
"BLD",3077,"KRN",9.8,"NM",33,0)
SROAPR2^^0^B8412750
"BLD",3077,"KRN",9.8,"NM",34,0)
SROAPRE^^0^B13507284
"BLD",3077,"KRN",9.8,"NM",35,0)
SROARPT^^0^B46605300
"BLD",3077,"KRN",9.8,"NM",36,0)
SROASS^^0^B17264408
"BLD",3077,"KRN",9.8,"NM",37,0)
SROAUTL^^0^B30975490
"BLD",3077,"KRN",9.8,"NM",38,0)
SROCOM^^0^B6818082
"BLD",3077,"KRN",9.8,"NM",39,0)
SRODTH^^0^B14263110
"BLD",3077,"KRN",9.8,"NM",40,0)
SROES^^0^B26203884
"BLD",3077,"KRN",9.8,"NM",41,0)
SROESAD^^0^B31263685
"BLD",3077,"KRN",9.8,"NM",42,0)
SROESAD1^^0^B34550126
"BLD",3077,"KRN",9.8,"NM",43,0)
SROESAR^^0^B30442459
"BLD",3077,"KRN",9.8,"NM",44,0)
SROESAR0^^0^B11601591
"BLD",3077,"KRN",9.8,"NM",45,0)
SROESAR1^^0^B31464875
"BLD",3077,"KRN",9.8,"NM",46,0)
SROESAR2^^0^B30925923
"BLD",3077,"KRN",9.8,"NM",47,0)
SROESARA^^0^B22261959
"BLD",3077,"KRN",9.8,"NM",48,0)
SROESHL^^0^B7580303
"BLD",3077,"KRN",9.8,"NM",49,0)
SROESNR^^0^B31682934
"BLD",3077,"KRN",9.8,"NM",50,0)
SROESNR0^^0^B28553187
"BLD",3077,"KRN",9.8,"NM",51,0)
SROESNR1^^0^B36449721
"BLD",3077,"KRN",9.8,"NM",52,0)
SROESNR2^^0^B34419782
"BLD",3077,"KRN",9.8,"NM",53,0)
SROESNRA^^0^B23152586
"BLD",3077,"KRN",9.8,"NM",54,0)
SROESPR^^0^B26316431
"BLD",3077,"KRN",9.8,"NM",55,0)
SROESPR1^^0^B64342513
"BLD",3077,"KRN",9.8,"NM",56,0)
SROESPR2^^0^B10042548
"BLD",3077,"KRN",9.8,"NM",57,0)
SROESTV^^0^B12480052
"BLD",3077,"KRN",9.8,"NM",58,0)
SROESX^^0^B27478146
"BLD",3077,"KRN",9.8,"NM",59,0)
SROESXA^^0^B16202604
"BLD",3077,"KRN",9.8,"NM",60,0)
SROESXP^^0^B15293863
"BLD",3077,"KRN",9.8,"NM",61,0)
SROGMTS^^0^B48622963
"BLD",3077,"KRN",9.8,"NM",62,0)
SROHIS^^0^B65784676
"BLD",3077,"KRN",9.8,"NM",63,0)
SROIRR^^0^B8545925
"BLD",3077,"KRN",9.8,"NM",64,0)
SROMED^^0^B18994467
"BLD",3077,"KRN",9.8,"NM",65,0)
SROMENU^^0^B18725484
"BLD",3077,"KRN",9.8,"NM",66,0)
SROMOD^^0^B34361425
"BLD",3077,"KRN",9.8,"NM",67,0)
SRONASS^^0^B17514802
"BLD",3077,"KRN",9.8,"NM",68,0)
SRONEW^^0^B19521613
"BLD",3077,"KRN",9.8,"NM",69,0)
SRONIN^^0^B55479643
"BLD",3077,"KRN",9.8,"NM",70,0)
SRONON^^0^B11378996
"BLD",3077,"KRN",9.8,"NM",71,0)
SRONOP^^0^B25370271
"BLD",3077,"KRN",9.8,"NM",72,0)
SRONOP1^^0^B15550721
"BLD",3077,"KRN",9.8,"NM",76,0)
SRONRPT^^0^B27501274
"BLD",3077,"KRN",9.8,"NM",77,0)
SRONRPT0^^0^B46385929
"BLD",3077,"KRN",9.8,"NM",78,0)
SRONRPT1^^0^B17672119
"BLD",3077,"KRN",9.8,"NM",79,0)
SRONRPT2^^0^B19811275
"BLD",3077,"KRN",9.8,"NM",80,0)
SRONRPT3^^0^B22358940
"BLD",3077,"KRN",9.8,"NM",81,0)
SROPDEL^^0^B13352187
"BLD",3077,"KRN",9.8,"NM",82,0)
SROPER^^0^B12586025
"BLD",3077,"KRN",9.8,"NM",83,0)
SROPRPT^^0^B3517379
"BLD",3077,"KRN",9.8,"NM",84,0)
SROREST^^0^B12673663
"BLD",3077,"KRN",9.8,"NM",85,0)
SROSRPT^^0^B6149981
"BLD",3077,"KRN",9.8,"NM",86,0)
SROSRPT0^^1^
"BLD",3077,"KRN",9.8,"NM",88,0)
SROUTL^^0^B28029566
"BLD",3077,"KRN",9.8,"NM",89,0)
SROVER^^0^B22114615
"BLD",3077,"KRN",9.8,"NM",90,0)
SROVER2^^0^B23436827
"BLD",3077,"KRN",9.8,"NM",91,0)
SRSCAN^^0^B10909174
"BLD",3077,"KRN",9.8,"NM",92,0)
SRSCAN0^^0^B15413492
"BLD",3077,"KRN",9.8,"NM",93,0)
SRSCHCA^^0^B8640617
"BLD",3077,"KRN",9.8,"NM",94,0)
SRSCHD^^0^B8354843
"BLD",3077,"KRN",9.8,"NM",95,0)
SRSCHD1^^0^B8338471
"BLD",3077,"KRN",9.8,"NM",96,0)
SRSCHDA^^0^B15325707
"BLD",3077,"KRN",9.8,"NM",97,0)
SRSCHDC^^0^B20574310
"BLD",3077,"KRN",9.8,"NM",98,0)
SRSCHUN^^0^B18782437
"BLD",3077,"KRN",9.8,"NM",99,0)
SRSCONR^^0^B16632460
"BLD",3077,"KRN",9.8,"NM",100,0)
SRSDT^^0^B8368565
"BLD",3077,"KRN",9.8,"NM",101,0)
SRSRQST^^0^B18734684
"BLD",3077,"KRN",9.8,"NM",102,0)
SRSUP1^^0^B26000444
"BLD",3077,"KRN",9.8,"NM",103,0)
SRSUPC^^0^B7743262
"BLD",3077,"KRN",9.8,"NM",104,0)
SRSUPRQ^^0^B27812570
"BLD",3077,"KRN",9.8,"NM",105,0)
SROUTL0^^0^B20639462
"BLD",3077,"KRN",9.8,"NM",106,0)
SROCHDD^^1^
"BLD",3077,"KRN",9.8,"NM",107,0)
SROUTR1^^1^
"BLD",3077,"KRN",9.8,"NM",108,0)
SRODICT^^1^
"BLD",3077,"KRN",9.8,"NM",109,0)
SRODCT1^^1^
"BLD",3077,"KRN",9.8,"NM",110,0)
SRSEND^^1^
"BLD",3077,"KRN",9.8,"NM",111,0)
SRSBTCH^^1^
"BLD",3077,"KRN",9.8,"NM",112,0)
SRSTR^^1^
"BLD",3077,"KRN",9.8,"NM",113,0)
SRSTRAN^^1^
"BLD",3077,"KRN",9.8,"NM",114,0)
SROESUTL^^0^B4829743
"BLD",3077,"KRN",9.8,"NM",115,0)
SROGMTS0^^0^B26721960
"BLD",3077,"KRN",9.8,"NM",116,0)
SROGMTS1^^0^B73229807
"BLD",3077,"KRN",9.8,"NM",117,0)
SROGMTS2^^0^B29817223
"BLD",3077,"KRN",9.8,"NM",118,0)
SROPS1^^0^B14216513
"BLD",3077,"KRN",9.8,"NM",119,0)
SROSRPT1^^1^
"BLD",3077,"KRN",9.8,"NM",120,0)
SROESX0^^0^B12202497
"BLD",3077,"KRN",9.8,"NM",121,0)
SROESNR3^^0^B1183519
"BLD",3077,"KRN",9.8,"NM",122,0)
SROSRPT2^^1^
"BLD",3077,"KRN",9.8,"NM",123,0)
SROTIUD^^0^B4241608
"BLD",3077,"KRN",9.8,"NM",124,0)
SROAPAS^^0^B27269573
"BLD",3077,"KRN",9.8,"NM",127,0)
SROESL^^0^B2207605
"BLD",3077,"KRN",9.8,"NM",128,0)
SROARET^^0^B20117974
"BLD",3077,"KRN",9.8,"NM",129,0)
SROACOM^^0^B17302130
"BLD",3077,"KRN",9.8,"NM",130,0)
SROPR01^^1^
"BLD",3077,"KRN",9.8,"NM",131,0)
SROPR02^^1^
"BLD",3077,"KRN",9.8,"NM",132,0)
SROPR03^^1^
"BLD",3077,"KRN",9.8,"NM",133,0)
SROBTCH^^1^
"BLD",3077,"KRN",9.8,"NM",134,0)
SROPRPT1^^1^
"BLD",3077,"KRN",9.8,"NM",135,0)
SROPRPT2^^1^
"BLD",3077,"KRN",9.8,"NM",136,0)
SROPRPT3^^1^
"BLD",3077,"KRN",9.8,"NM",137,0)
SROPRPT4^^1^
"BLD",3077,"KRN",9.8,"NM",138,0)
SROARPT0^^1^
"BLD",3077,"KRN",9.8,"NM",139,0)
SROARPT1^^1^
"BLD",3077,"KRN",9.8,"NM",140,0)
SROARPT2^^1^
"BLD",3077,"KRN",9.8,"NM",141,0)
SRONIN1^^1^
"BLD",3077,"KRN",9.8,"NM",142,0)
SRONIN2^^1^
"BLD",3077,"KRN",9.8,"NM",143,0)
SRONIN3^^1^
"BLD",3077,"KRN",9.8,"NM",144,0)
SRONIN4^^1^
"BLD",3077,"KRN",9.8,"NM",145,0)
SRONIN5^^1^
"BLD",3077,"KRN",9.8,"NM",146,0)
SRONIN6^^1^
"BLD",3077,"KRN",9.8,"NM",147,0)
SRONRN1^^1^
"BLD",3077,"KRN",9.8,"NM",148,0)
SRONRN2^^1^
"BLD",3077,"KRN",9.8,"NM",149,0)
SRONRN3^^1^
"BLD",3077,"KRN",9.8,"NM",150,0)
SRONRN4^^1^
"BLD",3077,"KRN",9.8,"NM",151,0)
SRONRN5^^1^
"BLD",3077,"KRN",9.8,"NM",152,0)
SRONRNF^^1^
"BLD",3077,"KRN",9.8,"NM",153,0)
SROAPIMS^^0^B24379487
"BLD",3077,"KRN",9.8,"NM",154,0)
SRONON0^^1^
"BLD",3077,"KRN",9.8,"NM",155,0)
SRONON1^^1^
"BLD",3077,"KRN",9.8,"NM",156,0)
SRONP^^0^B5944291
"BLD",3077,"KRN",9.8,"NM",159,0)
SROVAR^^0^B28808178
"BLD",3077,"KRN",9.8,"NM",160,0)
SROKRET^^0^B1039924
"BLD",3077,"KRN",9.8,"NM",161,0)
SROUTRN^^1^
"BLD",3077,"KRN",9.8,"NM",162,0)
SROXR4^^0^B6069696
"BLD",3077,"KRN",9.8,"NM",163,0)
SROXR1^^0^B10317927
"BLD",3077,"KRN",9.8,"NM",164,0)
SRSDIS1^^0^B9696115
"BLD",3077,"KRN",9.8,"NM",165,0)
SROFILE^^0^B17713424
"BLD",3077,"KRN",9.8,"NM","B","SRHLORU",1)

"BLD",3077,"KRN",9.8,"NM","B","SRHLUI",2)

"BLD",3077,"KRN",9.8,"NM","B","SRO1L1",3)

"BLD",3077,"KRN",9.8,"NM","B","SROACAR",4)

"BLD",3077,"KRN",9.8,"NM","B","SROACAT",5)

"BLD",3077,"KRN",9.8,"NM","B","SROACLN",6)

"BLD",3077,"KRN",9.8,"NM","B","SROACOM",129)

"BLD",3077,"KRN",9.8,"NM","B","SROACOP",8)

"BLD",3077,"KRN",9.8,"NM","B","SROACPM",9)

"BLD",3077,"KRN",9.8,"NM","B","SROADEL",10)

"BLD",3077,"KRN",9.8,"NM","B","SROAERR",11)

"BLD",3077,"KRN",9.8,"NM","B","SROAL1",12)

"BLD",3077,"KRN",9.8,"NM","B","SROAL2",13)

"BLD",3077,"KRN",9.8,"NM","B","SROALEN",14)

"BLD",3077,"KRN",9.8,"NM","B","SROALN2",15)

"BLD",3077,"KRN",9.8,"NM","B","SROALSS",16)

"BLD",3077,"KRN",9.8,"NM","B","SROALSSP",17)

"BLD",3077,"KRN",9.8,"NM","B","SROALST",18)

"BLD",3077,"KRN",9.8,"NM","B","SROALSTP",19)

"BLD",3077,"KRN",9.8,"NM","B","SROANEW",20)

"BLD",3077,"KRN",9.8,"NM","B","SROANIN",21)

"BLD",3077,"KRN",9.8,"NM","B","SROANR",22)

"BLD",3077,"KRN",9.8,"NM","B","SROANR0",23)

"BLD",3077,"KRN",9.8,"NM","B","SROANR1",24)

"BLD",3077,"KRN",9.8,"NM","B","SROANT",25)

"BLD",3077,"KRN",9.8,"NM","B","SROANTP",26)

"BLD",3077,"KRN",9.8,"NM","B","SROANTS",27)

"BLD",3077,"KRN",9.8,"NM","B","SROANTSP",28)

"BLD",3077,"KRN",9.8,"NM","B","SROAO",29)

"BLD",3077,"KRN",9.8,"NM","B","SROAOP",30)

"BLD",3077,"KRN",9.8,"NM","B","SROAOP2",31)

"BLD",3077,"KRN",9.8,"NM","B","SROAPAS",124)

"BLD",3077,"KRN",9.8,"NM","B","SROAPIMS",153)

"BLD",3077,"KRN",9.8,"NM","B","SROAPM",32)

"BLD",3077,"KRN",9.8,"NM","B","SROAPR2",33)

"BLD",3077,"KRN",9.8,"NM","B","SROAPRE",34)

"BLD",3077,"KRN",9.8,"NM","B","SROARET",128)

"BLD",3077,"KRN",9.8,"NM","B","SROARPT",35)

"BLD",3077,"KRN",9.8,"NM","B","SROARPT0",138)

"BLD",3077,"KRN",9.8,"NM","B","SROARPT1",139)

"BLD",3077,"KRN",9.8,"NM","B","SROARPT2",140)

"BLD",3077,"KRN",9.8,"NM","B","SROASS",36)

"BLD",3077,"KRN",9.8,"NM","B","SROAUTL",37)

"BLD",3077,"KRN",9.8,"NM","B","SROBTCH",133)

"BLD",3077,"KRN",9.8,"NM","B","SROCHDD",106)

"BLD",3077,"KRN",9.8,"NM","B","SROCOM",38)

"BLD",3077,"KRN",9.8,"NM","B","SRODCT1",109)

"BLD",3077,"KRN",9.8,"NM","B","SRODICT",108)

"BLD",3077,"KRN",9.8,"NM","B","SRODTH",39)

"BLD",3077,"KRN",9.8,"NM","B","SROES",40)

"BLD",3077,"KRN",9.8,"NM","B","SROESAD",41)

"BLD",3077,"KRN",9.8,"NM","B","SROESAD1",42)

"BLD",3077,"KRN",9.8,"NM","B","SROESAR",43)

"BLD",3077,"KRN",9.8,"NM","B","SROESAR0",44)

"BLD",3077,"KRN",9.8,"NM","B","SROESAR1",45)

"BLD",3077,"KRN",9.8,"NM","B","SROESAR2",46)

"BLD",3077,"KRN",9.8,"NM","B","SROESARA",47)

"BLD",3077,"KRN",9.8,"NM","B","SROESHL",48)

"BLD",3077,"KRN",9.8,"NM","B","SROESL",127)

"BLD",3077,"KRN",9.8,"NM","B","SROESNR",49)

"BLD",3077,"KRN",9.8,"NM","B","SROESNR0",50)

"BLD",3077,"KRN",9.8,"NM","B","SROESNR1",51)

"BLD",3077,"KRN",9.8,"NM","B","SROESNR2",52)

"BLD",3077,"KRN",9.8,"NM","B","SROESNR3",121)

"BLD",3077,"KRN",9.8,"NM","B","SROESNRA",53)

"BLD",3077,"KRN",9.8,"NM","B","SROESPR",54)

"BLD",3077,"KRN",9.8,"NM","B","SROESPR1",55)

"BLD",3077,"KRN",9.8,"NM","B","SROESPR2",56)

"BLD",3077,"KRN",9.8,"NM","B","SROESTV",57)

"BLD",3077,"KRN",9.8,"NM","B","SROESUTL",114)

"BLD",3077,"KRN",9.8,"NM","B","SROESX",58)

"BLD",3077,"KRN",9.8,"NM","B","SROESX0",120)

"BLD",3077,"KRN",9.8,"NM","B","SROESXA",59)

"BLD",3077,"KRN",9.8,"NM","B","SROESXP",60)

"BLD",3077,"KRN",9.8,"NM","B","SROFILE",165)

"BLD",3077,"KRN",9.8,"NM","B","SROGMTS",61)

"BLD",3077,"KRN",9.8,"NM","B","SROGMTS0",115)

"BLD",3077,"KRN",9.8,"NM","B","SROGMTS1",116)

"BLD",3077,"KRN",9.8,"NM","B","SROGMTS2",117)

"BLD",3077,"KRN",9.8,"NM","B","SROHIS",62)

"BLD",3077,"KRN",9.8,"NM","B","SROIRR",63)

"BLD",3077,"KRN",9.8,"NM","B","SROKRET",160)

"BLD",3077,"KRN",9.8,"NM","B","SROMED",64)

"BLD",3077,"KRN",9.8,"NM","B","SROMENU",65)

"BLD",3077,"KRN",9.8,"NM","B","SROMOD",66)

"BLD",3077,"KRN",9.8,"NM","B","SRONASS",67)

"BLD",3077,"KRN",9.8,"NM","B","SRONEW",68)

"BLD",3077,"KRN",9.8,"NM","B","SRONIN",69)

"BLD",3077,"KRN",9.8,"NM","B","SRONIN1",141)

"BLD",3077,"KRN",9.8,"NM","B","SRONIN2",142)

"BLD",3077,"KRN",9.8,"NM","B","SRONIN3",143)

"BLD",3077,"KRN",9.8,"NM","B","SRONIN4",144)

"BLD",3077,"KRN",9.8,"NM","B","SRONIN5",145)

"BLD",3077,"KRN",9.8,"NM","B","SRONIN6",146)

"BLD",3077,"KRN",9.8,"NM","B","SRONON",70)

"BLD",3077,"KRN",9.8,"NM","B","SRONON0",154)

"BLD",3077,"KRN",9.8,"NM","B","SRONON1",155)

"BLD",3077,"KRN",9.8,"NM","B","SRONOP",71)

"BLD",3077,"KRN",9.8,"NM","B","SRONOP1",72)

"BLD",3077,"KRN",9.8,"NM","B","SRONP",156)

"BLD",3077,"KRN",9.8,"NM","B","SRONRN1",147)

"BLD",3077,"KRN",9.8,"NM","B","SRONRN2",148)

"BLD",3077,"KRN",9.8,"NM","B","SRONRN3",149)

"BLD",3077,"KRN",9.8,"NM","B","SRONRN4",150)

"BLD",3077,"KRN",9.8,"NM","B","SRONRN5",151)

"BLD",3077,"KRN",9.8,"NM","B","SRONRNF",152)

"BLD",3077,"KRN",9.8,"NM","B","SRONRPT",76)

"BLD",3077,"KRN",9.8,"NM","B","SRONRPT0",77)

"BLD",3077,"KRN",9.8,"NM","B","SRONRPT1",78)

"BLD",3077,"KRN",9.8,"NM","B","SRONRPT2",79)

"BLD",3077,"KRN",9.8,"NM","B","SRONRPT3",80)

"BLD",3077,"KRN",9.8,"NM","B","SROPDEL",81)

"BLD",3077,"KRN",9.8,"NM","B","SROPER",82)

"BLD",3077,"KRN",9.8,"NM","B","SROPR01",130)

"BLD",3077,"KRN",9.8,"NM","B","SROPR02",131)

"BLD",3077,"KRN",9.8,"NM","B","SROPR03",132)

"BLD",3077,"KRN",9.8,"NM","B","SROPRPT",83)

"BLD",3077,"KRN",9.8,"NM","B","SROPRPT1",134)

"BLD",3077,"KRN",9.8,"NM","B","SROPRPT2",135)

"BLD",3077,"KRN",9.8,"NM","B","SROPRPT3",136)

"BLD",3077,"KRN",9.8,"NM","B","SROPRPT4",137)

"BLD",3077,"KRN",9.8,"NM","B","SROPS1",118)

"BLD",3077,"KRN",9.8,"NM","B","SROREST",84)

"BLD",3077,"KRN",9.8,"NM","B","SROSRPT",85)

"BLD",3077,"KRN",9.8,"NM","B","SROSRPT0",86)

"BLD",3077,"KRN",9.8,"NM","B","SROSRPT1",119)

"BLD",3077,"KRN",9.8,"NM","B","SROSRPT2",122)

"BLD",3077,"KRN",9.8,"NM","B","SROTIUD",123)

"BLD",3077,"KRN",9.8,"NM","B","SROUTL",88)

"BLD",3077,"KRN",9.8,"NM","B","SROUTL0",105)

"BLD",3077,"KRN",9.8,"NM","B","SROUTR1",107)

"BLD",3077,"KRN",9.8,"NM","B","SROUTRN",161)

"BLD",3077,"KRN",9.8,"NM","B","SROVAR",159)

"BLD",3077,"KRN",9.8,"NM","B","SROVER",89)

"BLD",3077,"KRN",9.8,"NM","B","SROVER2",90)

"BLD",3077,"KRN",9.8,"NM","B","SROXR1",163)

"BLD",3077,"KRN",9.8,"NM","B","SROXR4",162)

"BLD",3077,"KRN",9.8,"NM","B","SRSBTCH",111)

"BLD",3077,"KRN",9.8,"NM","B","SRSCAN",91)

"BLD",3077,"KRN",9.8,"NM","B","SRSCAN0",92)

"BLD",3077,"KRN",9.8,"NM","B","SRSCHCA",93)

"BLD",3077,"KRN",9.8,"NM","B","SRSCHD",94)

"BLD",3077,"KRN",9.8,"NM","B","SRSCHD1",95)

"BLD",3077,"KRN",9.8,"NM","B","SRSCHDA",96)

"BLD",3077,"KRN",9.8,"NM","B","SRSCHDC",97)

"BLD",3077,"KRN",9.8,"NM","B","SRSCHUN",98)

"BLD",3077,"KRN",9.8,"NM","B","SRSCONR",99)

"BLD",3077,"KRN",9.8,"NM","B","SRSDIS1",164)

"BLD",3077,"KRN",9.8,"NM","B","SRSDT",100)

"BLD",3077,"KRN",9.8,"NM","B","SRSEND",110)

"BLD",3077,"KRN",9.8,"NM","B","SRSRQST",101)

"BLD",3077,"KRN",9.8,"NM","B","SRSTR",112)

"BLD",3077,"KRN",9.8,"NM","B","SRSTRAN",113)

"BLD",3077,"KRN",9.8,"NM","B","SRSUP1",102)

"BLD",3077,"KRN",9.8,"NM","B","SRSUPC",103)

"BLD",3077,"KRN",9.8,"NM","B","SRSUPRQ",104)

"BLD",3077,"KRN",19,0)
19
"BLD",3077,"KRN",19,"NM",0)
^9.68A^47^47
"BLD",3077,"KRN",19,"NM",1,0)
SRCODING EDIT^^0
"BLD",3077,"KRN",19,"NM",2,0)
SRCODING OP REPORT^^0
"BLD",3077,"KRN",19,"NM",3,0)
SRCODING NURSE REPORT^^0
"BLD",3077,"KRN",19,"NM",4,0)
SRCODING UPDATE/VERIFY MENU^^3
"BLD",3077,"KRN",19,"NM",5,0)
SR VIEW HISTORICAL REPORTS^^0
"BLD",3077,"KRN",19,"NM",6,0)
SRO PACKAGE MANAGEMENT^^3
"BLD",3077,"KRN",19,"NM",7,0)
SROCHDD^^1^
"BLD",3077,"KRN",19,"NM",8,0)
SRSDDEL^^1^
"BLD",3077,"KRN",19,"NM",9,0)
SRODICT^^1^
"BLD",3077,"KRN",19,"NM",10,0)
SR DICTATION^^1^
"BLD",3077,"KRN",19,"NM",11,0)
SRODCT1^^1^
"BLD",3077,"KRN",19,"NM",12,0)
SRSEND^^1^
"BLD",3077,"KRN",19,"NM",13,0)
SRSTRAN^^1^
"BLD",3077,"KRN",19,"NM",14,0)
SRSTRANS PRINT^^1^
"BLD",3077,"KRN",19,"NM",15,0)
SRSTRANS PQ^^1^
"BLD",3077,"KRN",19,"NM",16,0)
SRSTRANS ERROR^^1^
"BLD",3077,"KRN",19,"NM",17,0)
SRSTRANS MENU^^1^
"BLD",3077,"KRN",19,"NM",18,0)
SRO-CHIEF REPORTS^^3
"BLD",3077,"KRN",19,"NM",19,0)
SR NON-OR REPORT^^0
"BLD",3077,"KRN",19,"NM",20,0)
SROARPT^^0
"BLD",3077,"KRN",19,"NM",21,0)
SRONRPT^^0
"BLD",3077,"KRN",19,"NM",22,0)
SROSRPT^^0
"BLD",3077,"KRN",19,"NM",23,0)
SRO INTRAOP COMP^^0
"BLD",3077,"KRN",19,"NM",24,0)
SRO POSTOP COMP^^0
"BLD",3077,"KRN",19,"NM",25,0)
SROMEN-STAFF^^0
"BLD",3077,"KRN",19,"NM",26,0)
SROMEN-START^^0
"BLD",3077,"KRN",19,"NM",27,0)
SROMEN-OP^^0
"BLD",3077,"KRN",19,"NM",28,0)
SROMEN-POST^^0
"BLD",3077,"KRN",19,"NM",29,0)
SROMEN-PACU^^0
"BLD",3077,"KRN",19,"NM",30,0)
SROMEN-OUT^^0
"BLD",3077,"KRN",19,"NM",31,0)
SROVER^^0
"BLD",3077,"KRN",19,"NM",32,0)
SROMEN-REST^^0
"BLD",3077,"KRN",19,"NM",33,0)
SROANES MED^^0
"BLD",3077,"KRN",19,"NM",34,0)
SROMEN-ANES^^0
"BLD",3077,"KRN",19,"NM",35,0)
SROMEN-ANES TECH^^0
"BLD",3077,"KRN",19,"NM",36,0)
SROA CARDIAC OPERATIVE RISK^^0
"BLD",3077,"KRN",19,"NM",37,0)
SRO UPDATE RETURNS^^0
"BLD",3077,"KRN",19,"NM",38,0)
SROA CARDIAC PROCEDURES^^0
"BLD",3077,"KRN",19,"NM",39,0)
SROA CARDIAC RESOURCE^^0
"BLD",3077,"KRN",19,"NM",40,0)
SROA CATHETERIZATION^^0
"BLD",3077,"KRN",19,"NM",41,0)
SROA CLINICAL INFORMATION^^0
"BLD",3077,"KRN",19,"NM",42,0)
SROA COMPLETE ASSESSMENT^^0
"BLD",3077,"KRN",19,"NM",43,0)
SROA DEMOGRAPHICS^^0
"BLD",3077,"KRN",19,"NM",44,0)
SROA LAB^^0
"BLD",3077,"KRN",19,"NM",45,0)
SROA OPERATION DATA^^0
"BLD",3077,"KRN",19,"NM",46,0)
SROA PREOP DATA^^0
"BLD",3077,"KRN",19,"NM",47,0)
SRTASK-BATCH OP REPORTS^^1^
"BLD",3077,"KRN",19,"NM","B","SR DICTATION",10)

"BLD",3077,"KRN",19,"NM","B","SR NON-OR REPORT",19)

"BLD",3077,"KRN",19,"NM","B","SR VIEW HISTORICAL REPORTS",5)

"BLD",3077,"KRN",19,"NM","B","SRCODING EDIT",1)

"BLD",3077,"KRN",19,"NM","B","SRCODING NURSE REPORT",3)

"BLD",3077,"KRN",19,"NM","B","SRCODING OP REPORT",2)

"BLD",3077,"KRN",19,"NM","B","SRCODING UPDATE/VERIFY MENU",4)

"BLD",3077,"KRN",19,"NM","B","SRO INTRAOP COMP",23)

"BLD",3077,"KRN",19,"NM","B","SRO PACKAGE MANAGEMENT",6)

"BLD",3077,"KRN",19,"NM","B","SRO POSTOP COMP",24)

"BLD",3077,"KRN",19,"NM","B","SRO UPDATE RETURNS",37)

"BLD",3077,"KRN",19,"NM","B","SRO-CHIEF REPORTS",18)

"BLD",3077,"KRN",19,"NM","B","SROA CARDIAC OPERATIVE RISK",36)

"BLD",3077,"KRN",19,"NM","B","SROA CARDIAC PROCEDURES",38)

"BLD",3077,"KRN",19,"NM","B","SROA CARDIAC RESOURCE",39)

"BLD",3077,"KRN",19,"NM","B","SROA CATHETERIZATION",40)

"BLD",3077,"KRN",19,"NM","B","SROA CLINICAL INFORMATION",41)

"BLD",3077,"KRN",19,"NM","B","SROA COMPLETE ASSESSMENT",42)

"BLD",3077,"KRN",19,"NM","B","SROA DEMOGRAPHICS",43)

"BLD",3077,"KRN",19,"NM","B","SROA LAB",44)

"BLD",3077,"KRN",19,"NM","B","SROA OPERATION DATA",45)

"BLD",3077,"KRN",19,"NM","B","SROA PREOP DATA",46)

"BLD",3077,"KRN",19,"NM","B","SROANES MED",33)

"BLD",3077,"KRN",19,"NM","B","SROARPT",20)

"BLD",3077,"KRN",19,"NM","B","SROCHDD",7)

"BLD",3077,"KRN",19,"NM","B","SRODCT1",11)

"BLD",3077,"KRN",19,"NM","B","SRODICT",9)

"BLD",3077,"KRN",19,"NM","B","SROMEN-ANES",34)

"BLD",3077,"KRN",19,"NM","B","SROMEN-ANES TECH",35)

"BLD",3077,"KRN",19,"NM","B","SROMEN-OP",27)

"BLD",3077,"KRN",19,"NM","B","SROMEN-OUT",30)

"BLD",3077,"KRN",19,"NM","B","SROMEN-PACU",29)

"BLD",3077,"KRN",19,"NM","B","SROMEN-POST",28)

"BLD",3077,"KRN",19,"NM","B","SROMEN-REST",32)

"BLD",3077,"KRN",19,"NM","B","SROMEN-STAFF",25)

"BLD",3077,"KRN",19,"NM","B","SROMEN-START",26)

"BLD",3077,"KRN",19,"NM","B","SRONRPT",21)

"BLD",3077,"KRN",19,"NM","B","SROSRPT",22)

"BLD",3077,"KRN",19,"NM","B","SROVER",31)

"BLD",3077,"KRN",19,"NM","B","SRSDDEL",8)

"BLD",3077,"KRN",19,"NM","B","SRSEND",12)

"BLD",3077,"KRN",19,"NM","B","SRSTRAN",13)

"BLD",3077,"KRN",19,"NM","B","SRSTRANS ERROR",16)

"BLD",3077,"KRN",19,"NM","B","SRSTRANS MENU",17)

"BLD",3077,"KRN",19,"NM","B","SRSTRANS PQ",15)

"BLD",3077,"KRN",19,"NM","B","SRSTRANS PRINT",14)

"BLD",3077,"KRN",19,"NM","B","SRTASK-BATCH OP REPORTS",47)

"BLD",3077,"KRN",19.1,0)
19.1
"BLD",3077,"KRN",19.1,"NM",0)
^9.68A^^0
"BLD",3077,"KRN",101,0)
101
"BLD",3077,"KRN",409.61,0)
409.61
"BLD",3077,"KRN",771,0)
771
"BLD",3077,"KRN",870,0)
870
"BLD",3077,"KRN",8994,0)
8994
"BLD",3077,"KRN","B",.4,.4)

"BLD",3077,"KRN","B",.401,.401)

"BLD",3077,"KRN","B",.402,.402)

"BLD",3077,"KRN","B",.403,.403)

"BLD",3077,"KRN","B",.5,.5)

"BLD",3077,"KRN","B",.84,.84)

"BLD",3077,"KRN","B",3.6,3.6)

"BLD",3077,"KRN","B",3.8,3.8)

"BLD",3077,"KRN","B",9.2,9.2)

"BLD",3077,"KRN","B",9.8,9.8)

"BLD",3077,"KRN","B",19,19)

"BLD",3077,"KRN","B",19.1,19.1)

"BLD",3077,"KRN","B",101,101)

"BLD",3077,"KRN","B",409.61,409.61)

"BLD",3077,"KRN","B",771,771)

"BLD",3077,"KRN","B",870,870)

"BLD",3077,"KRN","B",8994,8994)

"BLD",3077,"PRE")
SR100ENV
"BLD",3077,"QUES",0)
^9.62^13^13
"BLD",3077,"QUES",1,0)
POS01
"BLD",3077,"QUES",1,1)
YA
"BLD",3077,"QUES",1,"A")
Do you have the completed pre-installation worksheet? 
"BLD",3077,"QUES",1,"B")
NO
"BLD",3077,"QUES",2,0)
POS02
"BLD",3077,"QUES",2,1)
YA
"BLD",3077,"QUES",2,"A")
Display CPT Codes on Nurse Intraoperative Report? 
"BLD",3077,"QUES",2,"A1",0)
^^10^10^3040218^^^^
"BLD",3077,"QUES",2,"A1",1,0)
 
"BLD",3077,"QUES",2,"A1",2,0)
 >>> New Site Parameters <<<
"BLD",3077,"QUES",2,"A1",3,0)
 Answer the following questions to define the default site parameters that
"BLD",3077,"QUES",2,"A1",4,0)
 will be used to control the display of information related to options
"BLD",3077,"QUES",2,"A1",5,0)
 created by the Surgery Electronic Signature for Operative Reports patch
"BLD",3077,"QUES",2,"A1",6,0)
 SR*3*100.  These responses will be stored for each division defined in
"BLD",3077,"QUES",2,"A1",7,0)
 the SURGERY SITE PARAMETERS file (#133) and may be updated after this
"BLD",3077,"QUES",2,"A1",8,0)
 patch is installed.
"BLD",3077,"QUES",2,"A1",9,0)
   
"BLD",3077,"QUES",2,"A1",10,0)
   
"BLD",3077,"QUES",2,"B")
NO
"BLD",3077,"QUES",2,"M")
S:XPDQUES("POS01")=0 XPDQUIT=2 K DIR
"BLD",3077,"QUES",2,"Q")
and to make it part of the report. 
"BLD",3077,"QUES",2,"Q1",0)
^^1^1^3020226^
"BLD",3077,"QUES",2,"Q1",1,0)
Enter YES to require the principal CPT code prior to electronic signature
"BLD",3077,"QUES",3,0)
POS03
"BLD",3077,"QUES",3,1)
YA
"BLD",3077,"QUES",3,"A")
Display ICD-9 Codes on Nurse Intraoperative Report? 
"BLD",3077,"QUES",3,"A1",0)
^^1^1^3020226^
"BLD",3077,"QUES",3,"A1",1,0)
   
"BLD",3077,"QUES",3,"B")
NO
"BLD",3077,"QUES",3,"M")
K DIR
"BLD",3077,"QUES",3,"Q")
signature and to make it part of the report. 
"BLD",3077,"QUES",3,"Q1",0)
^^1^1^3020226^
"BLD",3077,"QUES",3,"Q1",1,0)
Enter YES to require the principal diagnosis code prior to electronic
"BLD",3077,"QUES",4,0)
POS04
"BLD",3077,"QUES",4,1)
YA
"BLD",3077,"QUES",4,"A")
Does this facility use the Anesthesia Report? 
"BLD",3077,"QUES",4,"A1",0)
^^8^8^3040218^
"BLD",3077,"QUES",4,"A1",1,0)
 
"BLD",3077,"QUES",4,"A1",2,0)
 >>> New Site Parameter <<<
"BLD",3077,"QUES",4,"A1",3,0)
 Answer the following question to define the default site parameter 
"BLD",3077,"QUES",4,"A1",4,0)
 related to the use of the Anesthesia Report at your facility. This 
"BLD",3077,"QUES",4,"A1",5,0)
 response will be stored for each division defined in the SURGERY SITE
"BLD",3077,"QUES",4,"A1",6,0)
 PARAMETERS file (#133) and may be updated after this patch is 
"BLD",3077,"QUES",4,"A1",7,0)
 installed.
"BLD",3077,"QUES",4,"A1",8,0)
  
"BLD",3077,"QUES",4,"B")
NO
"BLD",3077,"QUES",4,"M")
I XPDQUES("POS01")=0 K DIR
"BLD",3077,"QUES",4,"Q")
Enter YES if the electronically signed Anesthesia Report is used.
"BLD",3077,"QUES",5,0)
POS05
"BLD",3077,"QUES",5,1)
DA^:DT:EX
"BLD",3077,"QUES",5,"A")
Enter starting date for reports to be signed electronically: 
"BLD",3077,"QUES",5,"A1",0)
^^6^6^3020226^
"BLD",3077,"QUES",5,"A1",1,0)
  
"BLD",3077,"QUES",5,"A1",2,0)
 >>> Starting Date for Reports to be Signed Electronically <<<
"BLD",3077,"QUES",5,"A1",3,0)
 During the post-installation process, all reports for completed cases
"BLD",3077,"QUES",5,"A1",4,0)
 with an operation date on or after the date selected will be identified
"BLD",3077,"QUES",5,"A1",5,0)
 to be signed electronically and stub entries will be created in TIU.
"BLD",3077,"QUES",5,"A1",6,0)
  
"BLD",3077,"QUES",5,"B")
TODAY
"BLD",3077,"QUES",5,"M")
I XPDQUES("POS01")=0 K DIR
"BLD",3077,"QUES",5,"Q")

"BLD",3077,"QUES",6,0)
POS06
"BLD",3077,"QUES",6,1)
YA
"BLD",3077,"QUES",6,"A")
Do you want to move reports during the patch installation? 
"BLD",3077,"QUES",6,"A1",0)
^^19^19^3030825^
"BLD",3077,"QUES",6,"A1",1,0)
 
"BLD",3077,"QUES",6,"A1",2,0)
>>> Making Reports for Historical Cases Viewable through CPRS <<<
"BLD",3077,"QUES",6,"A1",3,0)
This patch includes a post-installation process that will move designated
"BLD",3077,"QUES",6,"A1",4,0)
reports for historical Surgery cases into TIU. By doing so, these reports,
"BLD",3077,"QUES",6,"A1",5,0)
while unsigned electronically, will be viewable within the CPRS Surgery
"BLD",3077,"QUES",6,"A1",6,0)
tab. These "electronically unsigned" reports will contain a disclaimer
"BLD",3077,"QUES",6,"A1",7,0)
stating; "This information is provided from historical files and cannot
"BLD",3077,"QUES",6,"A1",8,0)
be verified that the author has authenticated/approved this information.
"BLD",3077,"QUES",6,"A1",9,0)
The authenticated source document in the patient's medical record should
"BLD",3077,"QUES",6,"A1",10,0)
be reviewed to ensure that all information concerning this event has been
"BLD",3077,"QUES",6,"A1",11,0)
reviewed or noted." 
"BLD",3077,"QUES",6,"A1",12,0)
 
"BLD",3077,"QUES",6,"A1",13,0)
NOTE: The site parameters entered above will be applied in this process.
"BLD",3077,"QUES",6,"A1",14,0)
For multi-divisional facilities, if different parameter settings should be
"BLD",3077,"QUES",6,"A1",15,0)
applied for each division, or if for any reason the process to make
"BLD",3077,"QUES",6,"A1",16,0)
reports for historical surgery cases viewable in CPRS should not be run
"BLD",3077,"QUES",6,"A1",17,0)
during this patch installation, answer NO to this question. A new option
"BLD",3077,"QUES",6,"A1",18,0)
is provided to run this process later.
"BLD",3077,"QUES",6,"A1",19,0)
  
"BLD",3077,"QUES",6,"B")
NO
"BLD",3077,"QUES",6,"M")
I XPDQUES("POS01")=0 K DIR
"BLD",3077,"QUES",7,0)
POS07
"BLD",3077,"QUES",7,1)
DA^:DT:EXP
"BLD",3077,"QUES",7,"A")
Enter the starting date for reports to be moved: 
"BLD",3077,"QUES",7,"A1",0)
^^1^1^3020226^
"BLD",3077,"QUES",7,"A1",1,0)
   
"BLD",3077,"QUES",7,"B")
TODAY
"BLD",3077,"QUES",7,"M")
S DIR("B")=$G(XPDQUES("POS05","B")) I $G(XPDQUES("POS06"))=0!($G(XPDQUES("POS01"))=0) K DIR
"BLD",3077,"QUES",8,0)
POS08
"BLD",3077,"QUES",8,1)
YA
"BLD",3077,"QUES",8,"A")
Do you want to move the Operation Reports? 
"BLD",3077,"QUES",8,"A1",0)
^^1^1^3020226^^
"BLD",3077,"QUES",8,"A1",1,0)
   
"BLD",3077,"QUES",8,"B")
NO
"BLD",3077,"QUES",8,"M")
I $G(XPDQUES("POS06"))=0!($G(XPDQUES("POS01"))=0) K DIR
"BLD",3077,"QUES",9,0)
POS09
"BLD",3077,"QUES",9,1)
YA
"BLD",3077,"QUES",9,"A")
Do you want to move the Nurse Intraoperative Reports? 
"BLD",3077,"QUES",9,"A1",0)
^^1^1^3020226^
"BLD",3077,"QUES",9,"A1",1,0)
   
"BLD",3077,"QUES",9,"B")
NO
"BLD",3077,"QUES",9,"M")
I $G(XPDQUES("POS06"))=0!($G(XPDQUES("POS01"))=0) K DIR
"BLD",3077,"QUES",10,0)
POS10
"BLD",3077,"QUES",10,1)
YA
"BLD",3077,"QUES",10,"A")
Do you want to move the Anesthesia Reports? 
"BLD",3077,"QUES",10,"A1",0)
^^1^1^3020226^
"BLD",3077,"QUES",10,"A1",1,0)
   
"BLD",3077,"QUES",10,"B")
NO
"BLD",3077,"QUES",10,"M")
I $G(XPDQUES("POS06"))=0!($G(XPDQUES("POS01"))=0)!($G(XPDQUES("POS04"))=0) K DIR
"BLD",3077,"QUES",11,0)
POS11
"BLD",3077,"QUES",11,1)
YA
"BLD",3077,"QUES",11,"A")
Do you want to move the Procedure Reports (Non-O.R.)? 
"BLD",3077,"QUES",11,"A1",0)
^^1^1^3020226^
"BLD",3077,"QUES",11,"A1",1,0)
   
"BLD",3077,"QUES",11,"B")
NO
"BLD",3077,"QUES",11,"M")
I $G(XPDQUES("POS06"))=0!($G(XPDQUES("POS01"))=0) K DIR
"BLD",3077,"QUES",12,0)
POS12
"BLD",3077,"QUES",12,1)
YA
"BLD",3077,"QUES",12,"A")
Is this correct? 
"BLD",3077,"QUES",12,"B")
NO
"BLD",3077,"QUES",12,"M")
D POS12^SR100ENV
"BLD",3077,"QUES",13,0)
POS13
"BLD",3077,"QUES",13,1)
FOA
"BLD",3077,"QUES",13,"A")
Press ENTER to continue 
"BLD",3077,"QUES",13,"A1",0)
^^15^15^3030821^
"BLD",3077,"QUES",13,"A1",1,0)
 
"BLD",3077,"QUES",13,"A1",2,0)
If you need to move additional reports for a different date range, the
"BLD",3077,"QUES",13,"A1",3,0)
Make Reports Viewable in CPRS option contained on the Surgery Package
"BLD",3077,"QUES",13,"A1",4,0)
Management Menu can be used after this patch is installed.
"BLD",3077,"QUES",13,"A1",5,0)
 
"BLD",3077,"QUES",13,"A1",6,0)
The post-installation process will be tasked to run immediately at the end
"BLD",3077,"QUES",13,"A1",7,0)
of patch installation.  The following actions will occur in the following
"BLD",3077,"QUES",13,"A1",8,0)
order:
"BLD",3077,"QUES",13,"A1",9,0)
 (1) Conversion of cases with documents in TIU filed by the Boston
"BLD",3077,"QUES",13,"A1",10,0)
     Prototype (Class III) software
"BLD",3077,"QUES",13,"A1",11,0)
 (2) Creation of stub entries in TIU for reports for cases completed on or
"BLD",3077,"QUES",13,"A1",12,0)
     after the date selected above as the starting date for reports to be
"BLD",3077,"QUES",13,"A1",13,0)
     signed electronically
"BLD",3077,"QUES",13,"A1",14,0)
 (3) Movement of reports for historical cases into TIU (if selected)
"BLD",3077,"QUES",13,"A1",15,0)
  
"BLD",3077,"QUES",13,"B")

"BLD",3077,"QUES",13,"M")
I XPDQUES("POS01")=0!($G(XPDQUES("POS12"))=0) S XPDQUIT=2 K DIR
"BLD",3077,"QUES",13,"Q")
Press the ENTER key.
"BLD",3077,"QUES","B","POS01",1)

"BLD",3077,"QUES","B","POS02",2)

"BLD",3077,"QUES","B","POS03",3)

"BLD",3077,"QUES","B","POS04",4)

"BLD",3077,"QUES","B","POS05",5)

"BLD",3077,"QUES","B","POS06",6)

"BLD",3077,"QUES","B","POS07",7)

"BLD",3077,"QUES","B","POS08",8)

"BLD",3077,"QUES","B","POS09",9)

"BLD",3077,"QUES","B","POS10",10)

"BLD",3077,"QUES","B","POS11",11)

"BLD",3077,"QUES","B","POS12",12)

"BLD",3077,"QUES","B","POS13",13)

"BLD",3077,"REQB",0)
^9.611^10^9
"BLD",3077,"REQB",1,0)
SR*3.0*96^1
"BLD",3077,"REQB",2,0)
SR*3.0*99^1
"BLD",3077,"REQB",3,0)
SR*3.0*105^1
"BLD",3077,"REQB",4,0)
TIU*1.0*112^1
"BLD",3077,"REQB",6,0)
SR*3.0*115^1
"BLD",3077,"REQB",7,0)
SR*3.0*114^1
"BLD",3077,"REQB",8,0)
SR*3.0*121^1
"BLD",3077,"REQB",9,0)
SR*3.0*126^1
"BLD",3077,"REQB",10,0)
SR*3.0*112^1
"BLD",3077,"REQB","B","SR*3.0*105",3)

"BLD",3077,"REQB","B","SR*3.0*112",10)

"BLD",3077,"REQB","B","SR*3.0*114",7)

"BLD",3077,"REQB","B","SR*3.0*115",6)

"BLD",3077,"REQB","B","SR*3.0*121",8)

"BLD",3077,"REQB","B","SR*3.0*126",9)

"BLD",3077,"REQB","B","SR*3.0*96",1)

"BLD",3077,"REQB","B","SR*3.0*99",2)

"BLD",3077,"REQB","B","TIU*1.0*112",4)

"FIA",130)
SURGERY
"FIA",130,0)
^SRF(
"FIA",130,0,0)
130IP
"FIA",130,0,1)
y^n^p^^^^n
"FIA",130,0,10)

"FIA",130,0,11)

"FIA",130,0,"RLRO")

"FIA",130,0,"VR")
3.0^SR
"FIA",130,130)
1
"FIA",130,130,.09)

"FIA",130,130,.111)

"FIA",130,130,.14)

"FIA",130,130,.164)

"FIA",130,130,.21)

"FIA",130,130,.23)

"FIA",130,130,.232)

"FIA",130,130,.24)

"FIA",130,130,.31)

"FIA",130,130,.34)

"FIA",130,130,.48)

"FIA",130,130,1.19)

"FIA",130,130,1.2)

"FIA",130,130,15)

"FIA",130,130,122)

"FIA",130,130,123)

"FIA",130,130,124)

"FIA",130,130,129)

"FIA",130,130,130)

"FIA",130,130,131)

"FIA",130,130,1000)

"FIA",130,130,1001)

"FIA",130,130,1002)

"FIA",130,130,1003)

"FIA",130,130,1004)

"FIA",130,130,1005)

"FIA",130,130,1006)

"FIA",130,130.0129)
0
"FIA",130,130.013)
0
"FIA",130,130.0134)
0
"FIA",130,130.0135)
0
"FIA",130,130.02)
1
"FIA",130,130.02,.01)

"FIA",130,130.02,1)

"FIA",130,130.1)
0
"FIA",130,130.1295)
0
"FIA",130,130.28)
1
"FIA",130,130.28,.01)

"FIA",133)
SURGERY SITE PARAMETERS
"FIA",133,0)
^SRO(133,
"FIA",133,0,0)
133P
"FIA",133,0,1)
y^n^p^^^^n
"FIA",133,0,10)

"FIA",133,0,11)

"FIA",133,0,"RLRO")

"FIA",133,0,"VR")
3.0^SR
"FIA",133,133)
1
"FIA",133,133,6)

"FIA",133,133,38)

"FIA",133,133,39)

"FIA",133,133,40)

"FIA",133,133,42)

"INI")
PRE^SR100UTL
"INIT")
POST^SR100UTL
"IX",130,130,"AD",0)
130^AD^CoreFLS fields monitor flag.^MU^^R^IR^I^130^^^^^A
"IX",130,130,"AD",.1,0)
^^2^2^3020822^
"IX",130,130,"AD",.1,1,0)
This cross-reference will be checked before sending a notification to
"IX",130,130,"AD",.1,2,0)
the CoreFLS software after editing any of these fields.
"IX",130,130,"AD",1)
S ^TMP("CSLSUR1",$J)="" Q
"IX",130,130,"AD",1.4)
N I S (X,I)=0 F  S I=$O(X1(I)) Q:'I  I X1(I)'=X2(I) S X=1 Q
"IX",130,130,"AD",2)
S ^TMP("CSLSUR1",$J)="" Q
"IX",130,130,"AD",2.4)
N I S (X,I)=0 F  S I=$O(X1(I)) Q:'I  I X1(I)'=X2(I) S X=1 Q
"IX",130,130,"AD",2.5)
Q
"IX",130,130,"AD",11.1,0)
^.114IA^11^11
"IX",130,130,"AD",11.1,1,0)
1^F^130^.14^^^F
"IX",130,130,"AD",11.1,2,0)
2^F^130^27^^^F
"IX",130,130,"AD",11.1,3,0)
3^F^130^.02^^^F
"IX",130,130,"AD",11.1,4,0)
4^F^130^.04^^^F
"IX",130,130,"AD",11.1,5,0)
5^F^130^10^^^F
"IX",130,130,"AD",11.1,6,0)
6^F^130^11^^^F
"IX",130,130,"AD",11.1,7,0)
7^F^130^26^^^F
"IX",130,130,"AD",11.1,8,0)
8^F^130^.011^^^F
"IX",130,130,"AD",11.1,9,0)
9^F^130^.09^^^F
"IX",130,130,"AD",11.1,10,0)
10^F^130^35^^^F
"IX",130,130,"AD",11.1,11,0)
11^F^130^.164^^^F
"IX",130,130,"AES",0)
130^AES^Create/delete stub entries in TIU for nurse/operation reports.^MU^^F^^I^130^^^^^A
"IX",130,130,"AES",.1,0)
^^6^6^3010412^
"IX",130,130,"AES",.1,1,0)
This cross reference is responsible for creating stub entries in TIU for
"IX",130,130,"AES",.1,2,0)
the nurse intraoperative report and the operation report when the TIME PAT
"IX",130,130,"AES",.1,3,0)
OUT OR field (#.232) is entered.  It is also responsible for deleting the
"IX",130,130,"AES",.1,4,0)
stub entries in TIU for these same reports, if unsigned, when the TIME PAT
"IX",130,130,"AES",.1,5,0)
OUT OR field (#.232) is deleted.  No action occurs if the value in the
"IX",130,130,"AES",.1,6,0)
TIME PATOUT OR field (#.232) is modified.
"IX",130,130,"AES",1)
D AES^SROESX
"IX",130,130,"AES",1.4)
S X=X1(1)=""
"IX",130,130,"AES",2)
D KAES^SROESX
"IX",130,130,"AES",2.4)
S X=X2(1)=""
"IX",130,130,"AES",11.1,0)
^.114IA^1^1
"IX",130,130,"AES",11.1,1,0)
1^F^130^.232^^^F
"IX",130,130,"AES1",0)
130^AES1^Update TIU when surgeon is changed.^MU^^F^^I^130^^^^^A
"IX",130,130,"AES1",.1,0)
^^3^3^3020204^
"IX",130,130,"AES1",.1,1,0)
This cross reference is responsible for updating the AUTHOR/DICTATOR field
"IX",130,130,"AES1",.1,2,0)
(#1202) and the EXPECTED SIGNER field (#1204) in the TIU DOCUMENT file
"IX",130,130,"AES1",.1,3,0)
(#8925) for the Operation Report when the surgeon is edited.
"IX",130,130,"AES1",1)
D SET^SROESX0
"IX",130,130,"AES1",1.4)
S X=X1(1)'=X2(1)
"IX",130,130,"AES1",2)
Q
"IX",130,130,"AES1",2.4)
S X=0
"IX",130,130,"AES1",11.1,0)
^.114IA^1^1
"IX",130,130,"AES1",11.1,1,0)
1^F^130^.14^^^F
"IX",130,130,"AES2",0)
130^AES2^Update TIU when provider is changed.^MU^^F^^I^130^^^^^A
"IX",130,130,"AES2",.1,0)
^^3^3^3020204^
"IX",130,130,"AES2",.1,1,0)
This cross reference is responsible for updating the AUTHOR/DICTATOR field
"IX",130,130,"AES2",.1,2,0)
(#1202) and the EXPECTED SIGNER field (#1204) in the TIU DOCUMENT file
"IX",130,130,"AES2",.1,3,0)
(#8925) for the Procedure Report (Non-OR) when the provider is edited.
"IX",130,130,"AES2",1)
D SET^SROESX0
"IX",130,130,"AES2",1.4)
S X=X1(1)'=X2(1)
"IX",130,130,"AES2",2)
Q
"IX",130,130,"AES2",2.4)
S X=0
"IX",130,130,"AES2",11.1,0)
^.114IA^1^1
"IX",130,130,"AES2",11.1,1,0)
1^F^130^123^^^F
"IX",130,130,"AES3",0)
130^AES3^Update TIU when attending surgeon is changed.^MU^^F^^I^130^^^^^A
"IX",130,130,"AES3",.1,0)
^^4^4^3020205^
"IX",130,130,"AES3",.1,1,0)
This cross reference is responsible for updating the EXPECTED COSIGNER
"IX",130,130,"AES3",.1,2,0)
field (#1208) and the ATTENDING PHYSICIAN field (#1209) in the TIU
"IX",130,130,"AES3",.1,3,0)
DOCUMENT file (#8925) for the Operation Report when the attending surgeon
"IX",130,130,"AES3",.1,4,0)
is edited.
"IX",130,130,"AES3",1)
D SET1^SROESX0
"IX",130,130,"AES3",1.4)
S X=((X1(1)'=X2(1))&(X2(1)'=""))
"IX",130,130,"AES3",2)
D SET1^SROESX0
"IX",130,130,"AES3",2.4)
S X=X2(1)=""
"IX",130,130,"AES3",11.1,0)
^.114IA^1^1
"IX",130,130,"AES3",11.1,1,0)
1^F^130^.164^^^F
"IX",130,130,"AES4",0)
130^AES4^Update TIU when attending provider is changed.^MU^^F^^I^130^^^^^A
"IX",130,130,"AES4",.1,0)
^^4^4^3020205^^
"IX",130,130,"AES4",.1,1,0)
This cross reference is responsible for updating the EXPECTED COSIGNER
"IX",130,130,"AES4",.1,2,0)
field (#1208) and the ATTENDING PHYSICIAN field (#1209) in the TIU
"IX",130,130,"AES4",.1,3,0)
DOCUMENT file (#8925) for the Procedure Report (Non-OR) when the attending
"IX",130,130,"AES4",.1,4,0)
provider is edited.
"IX",130,130,"AES4",1)
D SET1^SROESX0
"IX",130,130,"AES4",1.4)
S X=((X1(1)'=X2(1))&(X2(1)'=""))
"IX",130,130,"AES4",2)
D SET1^SROESX0
"IX",130,130,"AES4",2.4)
S X=X2(1)=""
"IX",130,130,"AES4",11.1,0)
^.114IA^1^1
"IX",130,130,"AES4",11.1,1,0)
1^F^130^124^^^F
"IX",130,130,"AES5",0)
130^AES5^Update TIU when principal anesthetist is changed.^MU^^F^^I^130^^^^^A
"IX",130,130,"AES5",.1,0)
^^4^4^3020207^^
"IX",130,130,"AES5",.1,1,0)
This cross reference is responsible for updating the AUTHOR/DICTATOR field
"IX",130,130,"AES5",.1,2,0)
(#1202) and the EXPECTED SIGNER field (#1204) in the TIU DOCUMENT file
"IX",130,130,"AES5",.1,3,0)
(#8925) for the Anesthesia Report when the principal anesthetist is
"IX",130,130,"AES5",.1,4,0)
edited.
"IX",130,130,"AES5",1)
D SET2^SROESX0
"IX",130,130,"AES5",1.4)
S X=((X1(1)'=X2(1))&(X2(1)'=""))
"IX",130,130,"AES5",2)
D SET2^SROESX0
"IX",130,130,"AES5",2.4)
S X=X2(1)=""
"IX",130,130,"AES5",11.1,0)
^.114IA^1^1
"IX",130,130,"AES5",11.1,1,0)
1^F^130^.31^^^F
"IX",130,130,"AES6",0)
130^AES6^UPdate TIU when anesthesiologist supervisor is changed.^MU^^F^^I^130^^^^^A
"IX",130,130,"AES6",.1,0)
^^4^4^3020206^
"IX",130,130,"AES6",.1,1,0)
This cross reference is responsible for updating the EXPECTED COSIGNER
"IX",130,130,"AES6",.1,2,0)
field (#1208) and the ATTENDING PHYSICIAN field (#1209) in the TIU
"IX",130,130,"AES6",.1,3,0)
DOCUMENT file (#8925) for the Anesthesia Report when the anesthesiologist 
"IX",130,130,"AES6",.1,4,0)
supervisor is edited.
"IX",130,130,"AES6",1)
D SET3^SROESX0
"IX",130,130,"AES6",1.4)
S X=((X1(1)'=X2(1))&(X2(1)'=""))
"IX",130,130,"AES6",2)
D SET3^SROESX0
"IX",130,130,"AES6",2.4)
S X=X2(1)=""
"IX",130,130,"AES6",11.1,0)
^.114IA^1^1
"IX",130,130,"AES6",11.1,1,0)
1^F^130^.34^^^F
"IX",130,130,"AES8",0)
130^AES8^Update TIU when Date of Operation is changed.^MU^^F^IR^I^130^^^^^A
"IX",130,130,"AES8",.1,0)
^^3^3^3020729^^
"IX",130,130,"AES8",.1,1,0)
This cross-reference is responsible for updating the REFERENCE DATE field 
"IX",130,130,"AES8",.1,2,0)
(#1301) in the TIU DOCUMENT file (#8925) for all Reports when the 
"IX",130,130,"AES8",.1,3,0)
DATE OF OPERATION field (#9) in the SURGERY file (#130) is edited.
"IX",130,130,"AES8",1)
D AES8^SROESX0 Q
"IX",130,130,"AES8",1.4)
S X=((X1(1)'=X2(1))&(X2(1)'=""))
"IX",130,130,"AES8",2)
Q
"IX",130,130,"AES8",11.1,0)
^.114IA^1^1
"IX",130,130,"AES8",11.1,1,0)
1^F^130^.09^^^F
"IX",130,130,"AESA",0)
130^AESA^Create/delete stub entries in TIU for anesthesia report.^MU^^F^^I^130^^^^^A
"IX",130,130,"AESA",.1,0)
^^6^6^3010412^
"IX",130,130,"AESA",.1,1,0)
This cross reference is responsible for creating a stub entry in TIU for
"IX",130,130,"AESA",.1,2,0)
the anesthesia report when the ANES CARE END TIME field (#.24) is entered.
"IX",130,130,"AESA",.1,3,0)
It is also responsible for deleting the stub entry in TIU for this report,
"IX",130,130,"AESA",.1,4,0)
if unsigned, when the ANES CARE END TIME field (#.24) is deleted.  No
"IX",130,130,"AESA",.1,5,0)
action occurs if the value in the ANES CARE END TIME field (#.24) is
"IX",130,130,"AESA",.1,6,0)
modified.
"IX",130,130,"AESA",1)
D AESA^SROESXA
"IX",130,130,"AESA",1.4)
S X=X1(1)=""
"IX",130,130,"AESA",2)
D KAESA^SROESXA
"IX",130,130,"AESA",2.4)
S X=X2(1)=""
"IX",130,130,"AESA",11.1,0)
^.114IA^1^1
"IX",130,130,"AESA",11.1,1,0)
1^F^130^.24^^^F
"IX",130,130,"AESP",0)
130^AESP^Create/delete stub entries in TIU for procedure reports (non-OR).^MU^^R^^I^130^^^^^A
"IX",130,130,"AESP",.1,0)
^^8^8^3020226^
"IX",130,130,"AESP",.1,1,0)
This cross reference is responsible for creating a stub entry in TIU for
"IX",130,130,"AESP",.1,2,0)
the non-OR procedure report when the TIME PROCEDURE ENDED field (#122) is
"IX",130,130,"AESP",.1,3,0)
entered and the DICTATED SUMMARY EXPECTED field (#1004) is set to YES.  It
"IX",130,130,"AESP",.1,4,0)
is also responsible for deleting the stub entry in TIU for this report, if
"IX",130,130,"AESP",.1,5,0)
unsigned, when the TIME PROCEDURE ENDED field (#122) is deleted or if the
"IX",130,130,"AESP",.1,6,0)
DICTATED SUMMARY EXPECTED field (#1004) is deleted or  changed to NO.  No
"IX",130,130,"AESP",.1,7,0)
action occurs if the value in the TIME PROCEDURE ENDED field (#122) is
"IX",130,130,"AESP",.1,8,0)
modified.
"IX",130,130,"AESP",1)
D AESP^SROESXP
"IX",130,130,"AESP",1.4)
S X=$$SCOND^SROESXP(.X1,.X2)
"IX",130,130,"AESP",2)
D KAESP^SROESXP
"IX",130,130,"AESP",2.4)
S X=$$KCOND^SROESXP(.X1,.X2)
"IX",130,130,"AESP",11.1,0)
^.114IA^2^2
"IX",130,130,"AESP",11.1,1,0)
1^F^130^122^^^F
"IX",130,130,"AESP",11.1,2,0)
2^F^130^1004^^^F
"IX",130,130.28,"AES7",0)
130.28^AES7^Update TIU when the circulating support is changed.^MU^^F^^I^130.28^^^^^A
"IX",130,130.28,"AES7",.1,0)
^^4^4^3020207^
"IX",130,130.28,"AES7",.1,1,0)
This cross reference is responsible for updating the AUTHOR/DICTATOR field
"IX",130,130.28,"AES7",.1,2,0)
(#1202) and the EXPECTED SIGNER field (#1204) in the TIU DOCUMENT file
"IX",130,130.28,"AES7",.1,3,0)
(#8925) for the Nurse Intraoperative Report when the circulating support 
"IX",130,130.28,"AES7",.1,4,0)
is edited.
"IX",130,130.28,"AES7",1)
D SET4^SROESX0
"IX",130,130.28,"AES7",1.4)
S X=X1(1)'=X2(1)
"IX",130,130.28,"AES7",2)
D SET4^SROESX0
"IX",130,130.28,"AES7",2.4)
S X=X2(1)=""
"IX",130,130.28,"AES7",11.1,0)
^.114IA^1^1
"IX",130,130.28,"AES7",11.1,1,0)
1^F^130.28^.01^^^F
"KRN",.402,743,-1)
0^4
"KRN",.402,743,0)
SROMEN-OPER^3040217.1515^^130^^^3040217
"KRN",.402,743,"DIAB",1,0,130,0)
.203;T
"KRN",.402,743,"DIAB",1,1,130.01,0)
.01;T
"KRN",.402,743,"DIAB",1,1,130.0129,0)
.01;T
"KRN",.402,743,"DIAB",1,1,130.013,0)
.01;T
"KRN",.402,743,"DIAB",1,1,130.02,0)
.01;T
"KRN",.402,743,"DIAB",1,1,130.04,0)
.01;T
"KRN",.402,743,"DIAB",1,1,130.08,0)
.01;T
"KRN",.402,743,"DIAB",1,1,130.16,0)
.01;T
"KRN",.402,743,"DIAB",1,1,130.32,0)
.01;T
"KRN",.402,743,"DIAB",1,1,130.33,0)
.01;T
"KRN",.402,743,"DIAB",1,2,130.0134,0)
.01;T
"KRN",.402,743,"DIAB",1,2,130.34,0)
.01;T
"KRN",.402,743,"DIAB",1,2,130.39,0)
.01;T
"KRN",.402,743,"DIAB",2,0,130,0)
.205;T
"KRN",.402,743,"DIAB",2,1,130.01,0)
1;T
"KRN",.402,743,"DIAB",2,1,130.0129,0)
1;T
"KRN",.402,743,"DIAB",2,1,130.013,0)
1;T
"KRN",.402,743,"DIAB",2,1,130.02,0)
1;T
"KRN",.402,743,"DIAB",2,1,130.04,0)
1;T
"KRN",.402,743,"DIAB",2,1,130.08,0)
1;T
"KRN",.402,743,"DIAB",2,1,130.16,0)
3;T
"KRN",.402,743,"DIAB",2,1,130.32,0)
1;T
"KRN",.402,743,"DIAB",2,1,130.33,0)
1;T
"KRN",.402,743,"DIAB",2,2,130.0134,0)
1;T
"KRN",.402,743,"DIAB",2,2,130.34,0)
1;T
"KRN",.402,743,"DIAB",2,2,130.39,0)
1;T
"KRN",.402,743,"DIAB",3,0,130,0)
73;T
"KRN",.402,743,"DIAB",3,1,130.01,0)
2;T
"KRN",.402,743,"DIAB",3,1,130.0129,0)
2;T
"KRN",.402,743,"DIAB",3,1,130.013,0)
2;T
"KRN",.402,743,"DIAB",3,1,130.02,0)
2;T
"KRN",.402,743,"DIAB",3,1,130.04,0)
3;T
"KRN",.402,743,"DIAB",3,1,130.16,0)
1.5;T
"KRN",.402,743,"DIAB",3,1,130.32,0)
2;T
"KRN",.402,743,"DIAB",3,2,130.0134,0)
2;T
"KRN",.402,743,"DIAB",3,2,130.34,0)
2;T
"KRN",.402,743,"DIAB",3,2,130.39,0)
2;T
"KRN",.402,743,"DIAB",4,0,130,0)
72;T
"KRN",.402,743,"DIAB",4,1,130.01,0)
2.5;T
"KRN",.402,743,"DIAB",4,1,130.0129,0)
4;T
"KRN",.402,743,"DIAB",4,1,130.013,0)
3;T
"KRN",.402,743,"DIAB",4,1,130.02,0)
3;T
"KRN",.402,743,"DIAB",4,1,130.04,0)
4;T
"KRN",.402,743,"DIAB",4,1,130.32,0)
3;T
"KRN",.402,743,"DIAB",4,2,130.34,0)
3;T
"KRN",.402,743,"DIAB",5,0,130,0)
71;T
"KRN",.402,743,"DIAB",5,1,130.01,0)
5;T
"KRN",.402,743,"DIAB",5,1,130.0129,0)
3;T
"KRN",.402,743,"DIAB",5,1,130.013,0)
4;T
"KRN",.402,743,"DIAB",5,1,130.02,0)
4;T
"KRN",.402,743,"DIAB",5,1,130.04,0)
5;T
"KRN",.402,743,"DIAB",5,2,130.34,0)
4;T
"KRN",.402,743,"DIAB",6,0,130,0)
74;T
"KRN",.402,743,"DIAB",6,1,130.01,0)
6;T
"KRN",.402,743,"DIAB",6,1,130.0129,0)
5;T
"KRN",.402,743,"DIAB",6,2,130.34,0)
5;T
"KRN",.402,743,"DIAB",7,0,130,0)
.21;T
"KRN",.402,743,"DIAB",7,1,130.01,0)
7;T
"KRN",.402,743,"DIAB",8,0,130,0)
.22;T
"KRN",.402,743,"DIAB",9,0,130,0)
49;T
"KRN",.402,743,"DIAB",10,0,130,0)
64;T
"KRN",.402,743,"DIAB",11,0,130,0)
.757;T
"KRN",.402,743,"DIAB",12,0,130,0)
.75;T
"KRN",.402,743,"DIAB",13,0,130,0)
57;T
"KRN",.402,743,"DIAB",14,0,130,0)
58;T
"KRN",.402,743,"DIAB",15,0,130,0)
.48;T
"KRN",.402,743,"DIAB",16,0,130,0)
.47;T
"KRN",.402,743,"DIAB",17,0,130,0)
.27;T
"KRN",.402,743,"DIAB",18,0,130,0)
.39;T
"KRN",.402,743,"DIAB",19,0,130,0)
.375;T
"KRN",.402,743,"DIAB",20,0,130,0)
44;T
"KRN",.402,743,"DIAB",21,0,130,0)
45;T
"KRN",.402,743,"DIAB",22,0,130,0)
46;T
"KRN",.402,743,"DIAB",23,0,130,0)
47;T
"KRN",.402,743,"DIAB",24,0,130,0)
48;T
"KRN",.402,743,"DIAB",25,0,130,0)
127;T
"KRN",.402,743,"DIAB",26,0,130,0)
129;T
"KRN",.402,743,"DIAB",27,0,130,0)
130;T
"KRN",.402,743,"DIAB",28,0,130,0)
.29;T
"KRN",.402,743,"DIAB",29,0,130,0)
32;T
"KRN",.402,743,"DIAB",30,0,130,0)
66;T
"KRN",.402,743,"DIAB",31,0,130,0)
26;T
"KRN",.402,743,"DIAB",32,0,130,0)
27;T
"KRN",.402,743,"DIAB",33,0,130,0)
.42;T
"KRN",.402,743,"DIAB",34,0,130,0)
55;T
"KRN",.402,743,"DIAB",35,0,130,0)
60;T
"KRN",.402,743,"DR",1,130)
.203T~;.205T~;73T~;72T~;71T~;74T~;.21T~;.22T~;49T~;64T~;.757T~;.75T~;57T~;58T~;.48T~;.47T~;.27T~;.39T~;.375T~;44T~;45T~;46T~;47T~;48T~;127T~;129T~;130T~;.29T~;32T~;66T~;26T~;27T~;.42T~;55T~;60T~;
"KRN",.402,743,"DR",2,130.01)
.01T~;1T~;2T~;2.5T~;5T~;6T~;7T~;
"KRN",.402,743,"DR",2,130.0129)
.01T~;1T~;2T~;4T~;3T~;5T~;
"KRN",.402,743,"DR",2,130.013)
.01T~;1T~;2T~;3T~;4T~;
"KRN",.402,743,"DR",2,130.02)
.01T~;1T~;2T~;3T~;4T~;
"KRN",.402,743,"DR",2,130.04)
.01T~;1T~;3T~;4T~;5T~;
"KRN",.402,743,"DR",2,130.08)
.01T~;1T~;
"KRN",.402,743,"DR",2,130.16)
.01T~;3T~;1.5T~;
"KRN",.402,743,"DR",2,130.32)
.01T~;1T~;2T~;3T~;
"KRN",.402,743,"DR",2,130.33)
.01T~;1T~;
"KRN",.402,743,"DR",3,130.0134)
.01T~;1T~;2T~;
"KRN",.402,743,"DR",3,130.34)
.01T~;1T~;2T~;3T~;4T~;5T~;
"KRN",.402,743,"DR",3,130.39)
.01T~;1T~;2T~;
"KRN",.402,1403,-1)
0^1
"KRN",.402,1403,0)
SRNON-OR^3020516.1238^^130^^^3020516
"KRN",.402,1403,"DIAB",1,0,130,0)
120;T
"KRN",.402,1403,"DIAB",1,1,130.0126,0)
.01;T
"KRN",.402,1403,"DIAB",1,1,130.06,0)
.01;T
"KRN",.402,1403,"DIAB",1,1,130.16,0)
.01;T
"KRN",.402,1403,"DIAB",1,1,130.18,0)
.01;T
"KRN",.402,1403,"DIAB",1,2,130.47,0)
.01;T
"KRN",.402,1403,"DIAB",2,0,130,0)
26;T
"KRN",.402,1403,"DIAB",2,1,130.0126,0)
1;T
"KRN",.402,1403,"DIAB",2,1,130.06,0)
.05//YES;T
"KRN",.402,1403,"DIAB",2,1,130.16,0)
3;T
"KRN",.402,1403,"DIAB",2,1,130.18,0)
3;T
"KRN",.402,1403,"DIAB",2,2,130.47,0)
1;T
"KRN",.402,1403,"DIAB",3,0,130,0)
27;T
"KRN",.402,1403,"DIAB",3,1,130.0126,0)
2;T
"KRN",.402,1403,"DIAB",3,1,130.06,0)
24;T
"KRN",.402,1403,"DIAB",3,1,130.16,0)
1.5;T
"KRN",.402,1403,"DIAB",4,0,130,0)
125;T
"KRN",.402,1403,"DIAB",4,1,130.0126,0)
3;T
"KRN",.402,1403,"DIAB",5,0,130,0)
1004;T
"KRN",.402,1403,"DIAB",5,1,130.0126,0)
4;T
"KRN",.402,1403,"DIAB",6,0,130,0)
.011;T
"KRN",.402,1403,"DIAB",6,1,130.0126,0)
5;T
"KRN",.402,1403,"DIAB",7,0,130,0)
121;T
"KRN",.402,1403,"DIAB",8,0,130,0)
122;T
"KRN",.402,1403,"DIAB",9,0,130,0)
123;T
"KRN",.402,1403,"DIAB",10,0,130,0)
119;T
"KRN",.402,1403,"DIAB",11,0,130,0)
.021;T
"KRN",.402,1403,"DIAB",12,0,130,0)
33;T
"KRN",.402,1403,"DIAB",13,0,130,0)
66;T
"KRN",.402,1403,"DIAB",14,0,130,0)
55;T
"KRN",.402,1403,"DIAB",17,0,130,0)
124;T
"KRN",.402,1403,"DIAB",18,0,130,0)
.165;T
"KRN",.402,1403,"DIAB",19,0,130,0)
.31;T
"KRN",.402,1403,"DIAB",20,0,130,0)
.34;T
"KRN",.402,1403,"DIAB",21,0,130,0)
.21;T
"KRN",.402,1403,"DIAB",22,0,130,0)
.24;T
"KRN",.402,1403,"DIAB",23,0,130,0)
.37;T
"KRN",.402,1403,"DIAB",24,0,130,0)
.345;T
"KRN",.402,1403,"DIAB",25,0,130,0)
20;T
"KRN",.402,1403,"DIAB",26,0,130,0)
1.13;T
"KRN",.402,1403,"DIAB",27,0,130,0)
.42;T
"KRN",.402,1403,"DIAB",28,0,130,0)
.74;T
"KRN",.402,1403,"DIAB",29,0,130,0)
126;T
"KRN",.402,1403,"DIAB",31,0,130,0)
.28;T
"KRN",.402,1403,"DR",1,130)
120T~;26T~;27T~;125T~;1004T~;.011T~;121T~;122T~;123T~;119T~;.021T~;33T~;66T~;55T~;60;59;124T~;.165T~;.31T~;.34T~;.21T~;.24T~;.37T~;.345T~;20T~;1.13T~;.42T~;.74T~;126T~;49;.28T~;17;18;
"KRN",.402,1403,"DR",2,130.0126)
.01T~;1T~;2T~;3T~;4T~;5T~;
"KRN",.402,1403,"DR",2,130.06)
.01T~;.05T~//YES;24T~;
"KRN",.402,1403,"DR",2,130.16)
.01T~;3T~;1.5T~;
"KRN",.402,1403,"DR",2,130.18)
.01T~;3T~;
"KRN",.402,1403,"DR",3,130.47)
.01T~;1T~;
"KRN",.402,1404,-1)
0^7
"KRN",.402,1404,0)
SRPARAM^3040218.0613^^133^^^3040218
"KRN",.402,1404,"DIAB",1,0,133,0)
3;T
"KRN",.402,1404,"DIAB",1,1,133.027,0)
.01;T
"KRN",.402,1404,"DIAB",1,1,133.028,0)
.01;T
"KRN",.402,1404,"DIAB",2,0,133,0)
6;T
"KRN",.402,1404,"DIAB",2,1,133.028,0)
1;T
"KRN",.402,1404,"DIAB",3,0,133,0)
41;T
"KRN",.402,1404,"DIAB",4,0,133,0)
9;T
"KRN",.402,1404,"DIAB",5,0,133,0)
10;T
"KRN",.402,1404,"DIAB",6,0,133,0)
11;T
"KRN",.402,1404,"DIAB",7,0,133,0)
13;T
"KRN",.402,1404,"DIAB",8,0,133,0)
29;T
"KRN",.402,1404,"DIAB",9,0,133,0)
15;T
"KRN",.402,1404,"DIAB",10,0,133,0)
17;T
"KRN",.402,1404,"DIAB",11,0,133,0)
18;T
"KRN",.402,1404,"DIAB",12,0,133,0)
18.5;T
"KRN",.402,1404,"DIAB",13,0,133,0)
19;T
"KRN",.402,1404,"DIAB",14,0,133,0)
33;T
"KRN",.402,1404,"DIAB",16,0,133,0)
28;T
"KRN",.402,1404,"DIAB",17,0,133,0)
20;T
"KRN",.402,1404,"DIAB",18,0,133,0)
21;T
"KRN",.402,1404,"DIAB",19,0,133,0)
22;T
"KRN",.402,1404,"DIAB",20,0,133,0)
23;T
"KRN",.402,1404,"DIAB",21,0,133,0)
24;T
"KRN",.402,1404,"DIAB",22,0,133,0)
25;T
"KRN",.402,1404,"DIAB",23,0,133,0)
26;T
"KRN",.402,1404,"DIAB",24,0,133,0)
27;T
"KRN",.402,1404,"DIAB",25,0,133,0)
35;T
"KRN",.402,1404,"DIAB",26,0,133,0)
37;T
"KRN",.402,1404,"DIAB",27,0,133,0)
40;T
"KRN",.402,1404,"DIAB",28,0,133,0)
42;T
"KRN",.402,1404,"DR",1,133)
3T~;6T~;41T~;9T~;10T~;11T~;13T~;29T~;15T~;17T~;18T~;18.5T~;19T~;33T~;Q;28T~;20T~;21T~;22T~;23T~;24T~;25T~;26T~;27T~;35T~;37T~;40T~;42T~;
"KRN",.402,1404,"DR",2,133.027)
.01T~;
"KRN",.402,1404,"DR",2,133.028)
.01T~;1T~;
"KRN",.402,2097,-1)
0^5
"KRN",.402,2097,0)
SRONRPT^3040217.1252^^130^^^3040217
"KRN",.402,2097,"DIAB",1,0,130,0)
44;T
"KRN",.402,2097,"DIAB",1,0,130,1)
.175;T
"KRN",.402,2097,"DIAB",1,1,130.01,0)
.01;T
"KRN",.402,2097,"DIAB",1,1,130.0129,0)
.01;T
"KRN",.402,2097,"DIAB",1,1,130.013,0)
.01;T
"KRN",.402,2097,"DIAB",1,1,130.02,0)
.01;T
"KRN",.402,2097,"DIAB",1,1,130.04,0)
.01;T
"KRN",.402,2097,"DIAB",1,1,130.06,0)
.01;T
"KRN",.402,2097,"DIAB",1,1,130.065,0)
.01;T
"KRN",.402,2097,"DIAB",1,1,130.08,0)
.01;T
"KRN",.402,2097,"DIAB",1,1,130.16,0)
.01;T
"KRN",.402,2097,"DIAB",1,1,130.23,0)
.01;T
"KRN",.402,2097,"DIAB",1,1,130.24,0)
.01;T
"KRN",.402,2097,"DIAB",1,1,130.28,0)
.01;T
"KRN",.402,2097,"DIAB",1,1,130.31,0)
.01;T
"KRN",.402,2097,"DIAB",1,1,130.32,0)
.01;T
"KRN",.402,2097,"DIAB",1,1,130.33,0)
.01;T
"KRN",.402,2097,"DIAB",1,1,130.36,0)
.01;T
"KRN",.402,2097,"DIAB",1,2,130.0134,0)
.01;T
"KRN",.402,2097,"DIAB",1,2,130.39,0)
.01;T
"KRN",.402,2097,"DIAB",2,0,130,0)
45;T
"KRN",.402,2097,"DIAB",2,0,130,1)
8;T
"KRN",.402,2097,"DIAB",2,1,130.01,0)
1;T
"KRN",.402,2097,"DIAB",2,1,130.0129,0)
1;T
"KRN",.402,2097,"DIAB",2,1,130.013,0)
1;T
"KRN",.402,2097,"DIAB",2,1,130.02,0)
3;T
"KRN",.402,2097,"DIAB",2,1,130.04,0)
1;T
"KRN",.402,2097,"DIAB",2,1,130.065,0)
1;T
"KRN",.402,2097,"DIAB",2,1,130.08,0)
1;T
"KRN",.402,2097,"DIAB",2,1,130.23,0)
1;T
"KRN",.402,2097,"DIAB",2,1,130.24,0)
1;T
"KRN",.402,2097,"DIAB",2,1,130.28,0)
3;T
"KRN",.402,2097,"DIAB",2,1,130.31,0)
1;T
"KRN",.402,2097,"DIAB",2,1,130.32,0)
2;T
"KRN",.402,2097,"DIAB",2,1,130.36,0)
3;T
"KRN",.402,2097,"DIAB",2,2,130.0134,0)
1;T
"KRN",.402,2097,"DIAB",2,2,130.39,0)
1;T
"KRN",.402,2097,"DIAB",3,0,130,0)
46;T
"KRN",.402,2097,"DIAB",3,0,130,1)
.12;T
"KRN",.402,2097,"DIAB",3,1,130.01,0)
2;T
"KRN",.402,2097,"DIAB",3,1,130.0129,0)
2;T
"KRN",.402,2097,"DIAB",3,1,130.013,0)
2;T
"KRN",.402,2097,"DIAB",3,1,130.02,0)
1;T
"KRN",.402,2097,"DIAB",3,1,130.04,0)
3;T
"KRN",.402,2097,"DIAB",3,1,130.31,0)
2;T
"KRN",.402,2097,"DIAB",3,1,130.32,0)
1;T
"KRN",.402,2097,"DIAB",3,2,130.0134,0)
2;T
"KRN",.402,2097,"DIAB",3,2,130.39,0)
2;T
"KRN",.402,2097,"DIAB",4,0,130,0)
47;T
"KRN",.402,2097,"DIAB",4,0,130,1)
65;T
"KRN",.402,2097,"DIAB",4,1,130.01,0)
2.5;T
"KRN",.402,2097,"DIAB",4,1,130.0129,0)
4;T
"KRN",.402,2097,"DIAB",4,1,130.013,0)
3;T
"KRN",.402,2097,"DIAB",4,1,130.02,0)
4;T
"KRN",.402,2097,"DIAB",4,1,130.04,0)
4;T
"KRN",.402,2097,"DIAB",4,1,130.32,0)
3;T
"KRN",.402,2097,"DIAB",5,0,130,0)
48;T
"KRN",.402,2097,"DIAB",5,0,130,1)
.13;T
"KRN",.402,2097,"DIAB",5,1,130.01,0)
5;T
"KRN",.402,2097,"DIAB",5,1,130.0129,0)
3;T
"KRN",.402,2097,"DIAB",5,1,130.013,0)
4;T
"KRN",.402,2097,"DIAB",5,1,130.02,0)
2;T
"KRN",.402,2097,"DIAB",5,1,130.04,0)
5;T
"KRN",.402,2097,"DIAB",6,0,130,0)
.203;T
"KRN",.402,2097,"DIAB",6,0,130,1)
.75;T
"KRN",.402,2097,"DIAB",6,1,130.01,0)
6;T
"KRN",.402,2097,"DIAB",6,1,130.0129,0)
5;T
"KRN",.402,2097,"DIAB",6,1,130.013,0)
5;T
"KRN",.402,2097,"DIAB",7,0,130,0)
.205;T
"KRN",.402,2097,"DIAB",7,0,130,1)
57;T
"KRN",.402,2097,"DIAB",7,1,130.01,0)
7;T
"KRN",.402,2097,"DIAB",8,0,130,0)
73;T
"KRN",.402,2097,"DIAB",8,0,130,1)
58;T
"KRN",.402,2097,"DIAB",9,0,130,0)
72;T
"KRN",.402,2097,"DIAB",9,0,130,1)
.55;T
"KRN",.402,2097,"DIAB",10,0,130,0)
71;T
"KRN",.402,2097,"DIAB",10,0,130,1)
6;T
"KRN",.402,2097,"DIAB",11,0,130,0)
74;T
"KRN",.402,2097,"DIAB",11,0,130,1)
49;T
"KRN",.402,2097,"DIAB",12,0,130,0)
.22;T
"KRN",.402,2097,"DIAB",12,0,130,1)
64;T
"KRN",.402,2097,"DIAB",13,0,130,0)
.23;T
"KRN",.402,2097,"DIAB",13,0,130,1)
.37;T
"KRN",.402,2097,"DIAB",14,0,130,0)
.206;T
"KRN",.402,2097,"DIAB",14,0,130,1)
22;T
"KRN",.402,2097,"DIAB",15,0,130,0)
.232;T
"KRN",.402,2097,"DIAB",15,0,130,1)
.48;T
"KRN",.402,2097,"DIAB",16,0,130,0)
26;T
"KRN",.402,2097,"DIAB",16,0,130,1)
.757;T
"KRN",.402,2097,"DIAB",17,0,130,0)
.42;T
"KRN",.402,2097,"DIAB",17,0,130,1)
.47;T
"KRN",.402,2097,"DIAB",18,0,130,0)
1.09;T
"KRN",.402,2097,"DIAB",18,0,130,1)
.375;T
"KRN",.402,2097,"DIAB",19,0,130,0)
.46;T
"KRN",.402,2097,"DIAB",19,0,130,1)
.39;T
"KRN",.402,2097,"DIAB",20,0,130,0)
.03;T
"KRN",.402,2097,"DIAB",20,0,130,1)
.27;T
"KRN",.402,2097,"DIAB",21,0,130,0)
.02;T
"KRN",.402,2097,"DIAB",21,0,130,1)
41;T
"KRN",.402,2097,"DIAB",22,0,130,0)
.035;T
"KRN",.402,2097,"DIAB",22,0,130,1)
.875;T
"KRN",.402,2097,"DIAB",23,0,130,0)
.14;T
"KRN",.402,2097,"DIAB",23,0,130,1)
.25;T
"KRN",.402,2097,"DIAB",24,0,130,0)
.164;T
"KRN",.402,2097,"DIAB",24,0,130,1)
.255;T
"KRN",.402,2097,"DIAB",25,0,130,0)
.15;T
"KRN",.402,2097,"DIAB",25,0,130,1)
.81;T
"KRN",.402,2097,"DIAB",26,0,130,0)
.16;T
"KRN",.402,2097,"DIAB",26,0,130,1)
.821;T
"KRN",.402,2097,"DIAB",27,0,130,0)
.31;T
"KRN",.402,2097,"DIAB",27,0,130,1)
.76;T
"KRN",.402,2097,"DIAB",28,0,130,0)
.33;T
"KRN",.402,2097,"DIAB",28,0,130,1)
.77;T
"KRN",.402,2097,"DIAB",29,0,130,0)
30;T
"KRN",.402,2097,"DIAB",29,0,130,1)
129;T
"KRN",.402,2097,"DIAB",30,0,130,0)
.112;T
"KRN",.402,2097,"DIAB",30,0,130,1)
127;T
"KRN",.402,2097,"DIAB",31,0,130,0)
.111;T
"KRN",.402,2097,"DIAB",31,0,130,1)
25;T
"KRN",.402,2097,"DIAB",32,0,130,0)
31;T
"KRN",.402,2097,"DIAB",32,0,130,1)
130;T
"KRN",.402,2097,"DIAB",33,0,130,0)
.19;T
"KRN",.402,2097,"DIAB",33,0,130,1)
131;T
"KRN",.402,2097,"DIAB",34,0,130,0)
.196;T
"KRN",.402,2097,"DIAB",34,0,130,1)
.29;T
"KRN",.402,2097,"DIAB",35,0,130,0)
.07;T
"KRN",.402,2097,"DIAB",36,0,130,0)
.195;T
"KRN",.402,2097,"DIAB",37,0,130,0)
.69;T
"KRN",.402,2097,"DIAB",38,0,130,0)
.18;T
"KRN",.402,2097,"DIAB",39,0,130,0)
4;T
"KRN",.402,2097,"DR",1,130)
44T~;45T~;46T~;47T~;48T~;.203T~;.205T~;73T~;72T~;71T~;74T~;.22T~;.23T~;.206T~;.232T~;26T~;.42T~;1.09T~;.46T~;.03T~;.02T~;.035T~;.14T~;.164T~;.15T~;.16T~;.31T~;.33T~;30T~;.112T~;.111T~;31T~;.19T~;.196T~;.07T~;.195T~;.69T~;.18T~;4T~;
"KRN",.402,2097,"DR",1,130,1)
.175T~;8T~;.12T~;65T~;.13T~;.75T~;57T~;58T~;.55T~;6T~;49T~;64T~;.37T~;22T~;.48T~;.757T~;.47T~;.375T~;.39T~;.27T~;41T~;.875T~;.25T~;.255T~;.81T~;.821T~;.76T~;.77T~;129T~;127T~;25T~;130T~;131T~;.29T~;
"KRN",.402,2097,"DR",2,130.01)
.01T~;1T~;2T~;2.5T~;5T~;6T~;7T~;
"KRN",.402,2097,"DR",2,130.0129)
.01T~;1T~;2T~;4T~;3T~;5T~;
"KRN",.402,2097,"DR",2,130.013)
.01T~;1T~;2T~;3T~;4T~;5T~;
"KRN",.402,2097,"DR",2,130.02)
.01T~;3T~;1T~;4T~;2T~;
"KRN",.402,2097,"DR",2,130.04)
.01T~;1T~;3T~;4T~;5T~;
"KRN",.402,2097,"DR",2,130.06)
.01T~;
"KRN",.402,2097,"DR",2,130.065)
.01T~;1T~;
"KRN",.402,2097,"DR",2,130.08)
.01T~;1T~;
"KRN",.402,2097,"DR",2,130.16)
.01T~;
"KRN",.402,2097,"DR",2,130.23)
.01T~;1T~;
"KRN",.402,2097,"DR",2,130.24)
.01T~;1T~;
"KRN",.402,2097,"DR",2,130.28)
.01T~;3T~;
"KRN",.402,2097,"DR",2,130.31)
.01T~;1T~;2T~;
"KRN",.402,2097,"DR",2,130.32)
.01T~;2T~;1T~;3T~;
"KRN",.402,2097,"DR",2,130.33)
.01T~;
"KRN",.402,2097,"DR",2,130.36)
.01T~;3T~;
"KRN",.402,2097,"DR",3,130.0134)
.01T~;1T~;2T~;
"KRN",.402,2097,"DR",3,130.39)
.01T~;1T~;2T~;
"KRN",.402,2100,-1)
0^3
"KRN",.402,2100,0)
SROARPT^3040215.1347^^130^^^3040215
"KRN",.402,2100,"DIAB",1,0,130,0)
.02;T
"KRN",.402,2100,"DIAB",1,1,130.04,0)
.01;T
"KRN",.402,2100,"DIAB",1,1,130.06,0)
.01;T
"KRN",.402,2100,"DIAB",1,1,130.13,0)
.01;T
"KRN",.402,2100,"DIAB",1,1,130.16,0)
.01;T
"KRN",.402,2100,"DIAB",1,1,130.22,0)
.01;T
"KRN",.402,2100,"DIAB",1,1,130.33,0)
.01;T
"KRN",.402,2100,"DIAB",1,1,130.41,0)
.01;T
"KRN",.402,2100,"DIAB",1,2,130.34,0)
.01;T
"KRN",.402,2100,"DIAB",1,2,130.47,0)
.01;T
"KRN",.402,2100,"DIAB",1,2,130.49,0)
.01;T
"KRN",.402,2100,"DIAB",2,0,130,0)
.31;T
"KRN",.402,2100,"DIAB",2,1,130.04,0)
1;T
"KRN",.402,2100,"DIAB",2,1,130.06,0)
.05;T
"KRN",.402,2100,"DIAB",2,1,130.13,0)
3;T
"KRN",.402,2100,"DIAB",2,1,130.16,0)
2;T
"KRN",.402,2100,"DIAB",2,1,130.22,0)
5;T
"KRN",.402,2100,"DIAB",2,1,130.33,0)
1;T
"KRN",.402,2100,"DIAB",2,1,130.41,0)
3;T
"KRN",.402,2100,"DIAB",2,2,130.34,0)
4;T
"KRN",.402,2100,"DIAB",2,2,130.47,0)
1;T
"KRN",.402,2100,"DIAB",2,2,130.49,0)
1;T
"KRN",.402,2100,"DIAB",3,0,130,0)
.32;T
"KRN",.402,2100,"DIAB",3,1,130.04,0)
3;T
"KRN",.402,2100,"DIAB",3,1,130.06,0)
24;T
"KRN",.402,2100,"DIAB",3,1,130.41,0)
1;T
"KRN",.402,2100,"DIAB",3,2,130.34,0)
2;T
"KRN",.402,2100,"DIAB",3,2,130.49,0)
2;T
"KRN",.402,2100,"DIAB",4,0,130,0)
.34;T
"KRN",.402,2100,"DIAB",4,1,130.04,0)
4;T
"KRN",.402,2100,"DIAB",4,1,130.06,0)
41;T
"KRN",.402,2100,"DIAB",4,1,130.41,0)
2;T
"KRN",.402,2100,"DIAB",4,2,130.34,0)
3;T
"KRN",.402,2100,"DIAB",5,0,130,0)
.345;T
"KRN",.402,2100,"DIAB",5,1,130.06,0)
42;T
"KRN",.402,2100,"DIAB",5,2,130.34,0)
5;T
"KRN",.402,2100,"DIAB",6,0,130,0)
.33;T
"KRN",.402,2100,"DIAB",6,1,130.06,0)
3;T
"KRN",.402,2100,"DIAB",7,0,130,0)
.21;T
"KRN",.402,2100,"DIAB",7,1,130.06,0)
4;T
"KRN",.402,2100,"DIAB",8,0,130,0)
.24;T
"KRN",.402,2100,"DIAB",8,1,130.06,0)
5;T
"KRN",.402,2100,"DIAB",9,0,130,0)
1.13;T
"KRN",.402,2100,"DIAB",9,1,130.06,0)
6;T
"KRN",.402,2100,"DIAB",10,0,130,0)
.46;T
"KRN",.402,2100,"DIAB",10,1,130.06,0)
7;T
"KRN",.402,2100,"DIAB",11,0,130,0)
.37;T
"KRN",.402,2100,"DIAB",11,1,130.06,0)
8;T
"KRN",.402,2100,"DIAB",12,0,130,0)
26;T
"KRN",.402,2100,"DIAB",12,1,130.06,0)
9;T
"KRN",.402,2100,"DIAB",13,0,130,0)
.42;T
"KRN",.402,2100,"DIAB",13,1,130.06,0)
10;T
"KRN",.402,2100,"DIAB",14,0,130,0)
.375;T
"KRN",.402,2100,"DIAB",14,1,130.06,0)
11;T
"KRN",.402,2100,"DIAB",15,0,130,0)
.36;T
"KRN",.402,2100,"DIAB",15,1,130.06,0)
12;T
"KRN",.402,2100,"DIAB",16,0,130,0)
.293;T
"KRN",.402,2100,"DIAB",16,1,130.06,0)
21;T
"KRN",.402,2100,"DIAB",17,0,130,0)
.27;T
"KRN",.402,2100,"DIAB",17,1,130.06,0)
39;T
"KRN",.402,2100,"DIAB",18,0,130,0)
.25;T
"KRN",.402,2100,"DIAB",18,1,130.06,0)
22;T
"KRN",.402,2100,"DIAB",19,0,130,0)
.255;T
"KRN",.402,2100,"DIAB",19,1,130.06,0)
17;T
"KRN",.402,2100,"DIAB",20,0,130,0)
1.11;T
"KRN",.402,2100,"DIAB",20,1,130.06,0)
18;T
"KRN",.402,2100,"DIAB",21,0,130,0)
1.12;T
"KRN",.402,2100,"DIAB",21,1,130.06,0)
25;T
"KRN",.402,2100,"DIAB",22,0,130,0)
1.19;T
"KRN",.402,2100,"DIAB",22,1,130.06,0)
26;T
"KRN",.402,2100,"DIAB",23,0,130,0)
1.2;T
"KRN",.402,2100,"DIAB",23,1,130.06,0)
27;T
"KRN",.402,2100,"DIAB",24,0,130,0)
1.14;T
"KRN",.402,2100,"DIAB",24,1,130.06,0)
29;T
"KRN",.402,2100,"DIAB",25,0,130,0)
1.16;T
"KRN",.402,2100,"DIAB",25,1,130.06,0)
43;T
"KRN",.402,2100,"DIAB",26,0,130,0)
.28;T
"KRN",.402,2100,"DIAB",26,1,130.06,0)
34;T
"KRN",.402,2100,"DIAB",27,1,130.06,0)
35;T
"KRN",.402,2100,"DIAB",28,1,130.06,0)
44;T
"KRN",.402,2100,"DIAB",29,1,130.06,0)
38;T
"KRN",.402,2100,"DR",1,130)
.02T~;.31T~;.32T~;.34T~;.345T~;.33T~;.21T~;.24T~;1.13T~;.46T~;.37T~;26T~;.42T~;.375T~;.36T~;.293T~;.27T~;.25T~;.255T~;1.11T~;1.12T~;1.19T~;1.2T~;1.14T~;1.16T~;.28T~;
"KRN",.402,2100,"DR",2,130.04)
.01T~;1T~;3T~;4T~;
"KRN",.402,2100,"DR",2,130.06)
.01T~;.05T~;24T~;41T~;42T~;3T~;4T~;5T~;6T~;7T~;8T~;9T~;10T~;11T~;12T~;21T~;39T~;22T~;17T~;18T~;25T~;26T~;27T~;29T~;43T~;34T~;35T~;44T~;38T~;Q;
"KRN",.402,2100,"DR",2,130.13)
.01T~;3T~;
"KRN",.402,2100,"DR",2,130.16)
.01T~;2T~;
"KRN",.402,2100,"DR",2,130.22)
.01T~;5T~;
"KRN",.402,2100,"DR",2,130.33)
.01T~;1T~;
"KRN",.402,2100,"DR",2,130.41)
.01T~;3T~;1T~;2T~;
"KRN",.402,2100,"DR",3,130.34)
.01T~;4T~;2T~;3T~;5T~;
"KRN",.402,2100,"DR",3,130.47)
.01T~;1T~;
"KRN",.402,2100,"DR",3,130.49)
.01T~;1T~;2T~;
"KRN",19,3756,-1)
0^25
"KRN",19,3756,0)
SROMEN-STAFF^Surgical Staff^^R^^^^^^^^^^1^1
"KRN",19,3756,1,0)
^19.06^3^3^3010206^^^^
"KRN",19,3756,1,1,0)
This option is used to enter the staff (surgeons, nurses, anesthetists)
"KRN",19,3756,1,2,0)
for a given case.  It includes everyone in the operating room for this
"KRN",19,3756,1,3,0)
case.
"KRN",19,3756,15)
D EXIT^SROES,EXIT^SROVAR
"KRN",19,3756,20)
D ^SROVAR D:'$D(SRTN) ^SROPS S:'$D(SRTN) XQUIT="" Q:$D(XQUIT)  D ENTER^SROES
"KRN",19,3756,22)
Q
"KRN",19,3756,25)
STAFF^SROMENU
"KRN",19,3756,99)
53569,37796
"KRN",19,3756,"U")
SURGICAL STAFF
"KRN",19,3757,-1)
0^34
"KRN",19,3757,0)
SROMEN-ANES^Anesthesia Information  (Enter/Edit)^^R^^SROANES^^^^^^^^1^1
"KRN",19,3757,1,0)
^^2^2^2881221^^^
"KRN",19,3757,1,1,0)
This option is used to enter Anesthesia related information for a
"KRN",19,3757,1,2,0)
given case.
"KRN",19,3757,15)
D EXIT^SROES,EXIT^SROVAR
"KRN",19,3757,20)
D ^SROVAR D:'$D(SRTN) ^SROPS S:'$D(SRTN) XQUIT="" Q:$D(XQUIT)  D ENTER^SROES
"KRN",19,3757,22)
Q
"KRN",19,3757,25)
SROANIN
"KRN",19,3757,"U")
ANESTHESIA INFORMATION  (ENTER
"KRN",19,3758,-1)
0^26
"KRN",19,3758,0)
SROMEN-START^Operation Startup^^R^^^^^^^^^^1^1
"KRN",19,3758,1,0)
^^2^2^2930517^^
"KRN",19,3758,1,1,0)
This option is used to enter information prior to the actual start of
"KRN",19,3758,1,2,0)
the operation.
"KRN",19,3758,15)
D EXIT^SROES,EXIT^SROVAR
"KRN",19,3758,20)
D ^SROVAR D:'$D(SRTN) ^SROPS S:'$D(SRTN) XQUIT="" Q:$D(XQUIT)  D ENTER^SROES
"KRN",19,3758,22)
Q
"KRN",19,3758,25)
START^SROMENU
"KRN",19,3758,99)
53569,37814
"KRN",19,3758,"U")
OPERATION STARTUP
"KRN",19,3759,-1)
0^27
"KRN",19,3759,0)
SROMEN-OP^Operation^^R^^^^^^^^^^1^1
"KRN",19,3759,1,0)
^^2^2^2930517^^^
"KRN",19,3759,1,1,0)
This option is used to enter or edit information determined during
"KRN",19,3759,1,2,0)
the operative procedure.
"KRN",19,3759,15)
D EXIT^SROES,EXIT^SROVAR
"KRN",19,3759,20)
D ^SROVAR D:'$D(SRTN) ^SROPS S:'$D(SRTN) XQUIT="" Q:$D(XQUIT)  D ENTER^SROES
"KRN",19,3759,22)
Q
"KRN",19,3759,25)
OP^SROMENU
"KRN",19,3759,"U")
OPERATION
"KRN",19,3761,-1)
0^22
"KRN",19,3761,0)
SROSRPT^Operation Report^^R^^^^^^^^^^1^1
"KRN",19,3761,1,0)
^^3^3^3030908^
"KRN",19,3761,1,1,0)
This option generates the Operation Report. This report consists of the
"KRN",19,3761,1,2,0)
electronically signed operative summary (surgeon's dictation) stored in
"KRN",19,3761,1,3,0)
the Text Integration Utilities (TIU) software.
"KRN",19,3761,15)
D EXIT^SROVAR
"KRN",19,3761,20)
D ^SROVAR
"KRN",19,3761,22)
Q
"KRN",19,3761,25)
SROPRPT
"KRN",19,3761,99)
58854,48522
"KRN",19,3761,"U")
OPERATION REPORT
"KRN",19,3762,-1)
0^20
"KRN",19,3762,0)
SROARPT^Anesthesia Report^^R^^SROANES^^^^^^SURGERY^^1^1
"KRN",19,3762,1,0)
^^9^9^3010830^
"KRN",19,3762,1,1,0)
This option, locked by the SROANES security key, generates the Anesthesia
"KRN",19,3762,1,2,0)
Report containing anesthesia information for a surgical case.  Before the
"KRN",19,3762,1,3,0)
report is electronically signed, the option displays information directly
"KRN",19,3762,1,4,0)
from the SURGERY file (#130) with the choice to edit the information on
"KRN",19,3762,1,5,0)
the report, to print/view the report from the beginning, and to sign the
"KRN",19,3762,1,6,0)
report electronically if appropriate for the user.  After the report is
"KRN",19,3762,1,7,0)
electronically signed, this option allows the signed report to be edited
"KRN",19,3762,1,8,0)
by updating the information in the SURGERY file (#130) and by creating
"KRN",19,3762,1,9,0)
addenda and this option allows the report to be viewed or printed.
"KRN",19,3762,15)
K:'$D(SRTNK) SRTN K SRTNK D EXIT^SROVAR
"KRN",19,3762,20)
D ^SROVAR Q:$D(XQUIT)  S:$D(SRTN) SRTNK=SRTN
"KRN",19,3762,22)
Q
"KRN",19,3762,25)
SROARPT
"KRN",19,3762,99)
55656,29519
"KRN",19,3762,"U")
ANESTHESIA REPORT
"KRN",19,3763,-1)
0^21
"KRN",19,3763,0)
SRONRPT^Nurse Intraoperative Report^^R^^^^^^^^^^1^1
"KRN",19,3763,1,0)
^19.06^9^9^3010830^^
"KRN",19,3763,1,1,0)
This option generates the Nurse Intraoperative Report containing surgical
"KRN",19,3763,1,2,0)
case information documented by nursing staff.  Before the report is
"KRN",19,3763,1,3,0)
electronically signed, the option displays information directly from the
"KRN",19,3763,1,4,0)
SURGERY file (#130) with the choice to edit the information on the report,
"KRN",19,3763,1,5,0)
to print/view the report from the beginning, and to sign the report
"KRN",19,3763,1,6,0)
electronically if appropriate for the user.  After the report is
"KRN",19,3763,1,7,0)
electronically signed, this option allows the signed report to be edited
"KRN",19,3763,1,8,0)
by updating the information in the SURGERY file (#130) and by creating
"KRN",19,3763,1,9,0)
addenda and this option allows the signed report to be viewed or printed.
"KRN",19,3763,15)
D EXIT^SROVAR
"KRN",19,3763,20)
D ^SROVAR
"KRN",19,3763,22)
Q
"KRN",19,3763,25)
SRONIN
"KRN",19,3763,99)
55612,39567
"KRN",19,3763,"U")
NURSE INTRAOPERATIVE REPORT
"KRN",19,3765,-1)
0^30
"KRN",19,3765,0)
SROMEN-OUT^Operation (Short Screen)^^R^^^^^^^^^^1^1
"KRN",19,3765,1,0)
^19.06^2^2^3001208^^
"KRN",19,3765,1,1,0)
This screen is designed for surgical procedures performed on outpatient
"KRN",19,3765,1,2,0)
or ambulatory patients with local anesthesia.
"KRN",19,3765,15)
D EXIT^SROES,EXIT^SROVAR
"KRN",19,3765,20)
D ^SROVAR D:'$D(SRTN) ^SROPS S:'$D(SRTN) XQUIT="" Q:$D(XQUIT)  D ENTER^SROES
"KRN",19,3765,22)
Q
"KRN",19,3765,25)
SHORT^SROMENU
"KRN",19,3765,99.1)
59015,42616
"KRN",19,3765,"U")
OPERATION (SHORT SCREEN)
"KRN",19,3776,-1)
0^28
"KRN",19,3776,0)
SROMEN-POST^Post Operation^^R^^^^^^^^^^1^1
"KRN",19,3776,1,0)
^^2^2^2930517^^
"KRN",19,3776,1,1,0)
This option is used to enter or edit information obtained after the
"KRN",19,3776,1,2,0)
operation.
"KRN",19,3776,15)
D EXIT^SROES,EXIT^SROVAR
"KRN",19,3776,20)
D ^SROVAR D:'$D(SRTN) ^SROPS S:'$D(SRTN) XQUIT="" Q:$D(XQUIT)  D ENTER^SROES
"KRN",19,3776,22)
Q
"KRN",19,3776,25)
POST^SROMENU
"KRN",19,3776,"U")
POST OPERATION
"KRN",19,3779,-1)
0^35
"KRN",19,3779,0)
SROMEN-ANES TECH^Anesthesia Technique (Enter/Edit)^^R^^SROANES^^^^^^^^1^1
"KRN",19,3779,1,0)
^^3^3^2880513^^
"KRN",19,3779,1,1,0)
This option will be used to enter information for the anesthesia
"KRN",19,3779,1,2,0)
technique used.  Depending on what technique was used, a different
"KRN",19,3779,1,3,0)
set of fields may be entered.
"KRN",19,3779,15)
D EXIT^SROES,EXIT^SROVAR
"KRN",19,3779,20)
D ^SROVAR D:'$D(SRTN) ^SROPS S:'$D(SRTN) XQUIT="" Q:$D(XQUIT)  D ENTER^SROES
"KRN",19,3779,22)
Q
"KRN",19,3779,25)
TECH^SROMENU
"KRN",19,3779,30)

"KRN",19,3779,31)

"KRN",19,3779,50)

"KRN",19,3779,51)

"KRN",19,3779,"U")
ANESTHESIA TECHNIQUE (ENTER/ED
"KRN",19,3781,-1)
0^33
"KRN",19,3781,0)
SROANES MED^Medications (Enter/Edit)^^R^^^^^^^^^^1^1
"KRN",19,3781,1,0)
^^2^2^2930519^^^
"KRN",19,3781,1,1,0)
This option will be used to enter or edit medications given during
"KRN",19,3781,1,2,0)
the operative procedure.
"KRN",19,3781,15)
D EXIT^SROES,EXIT^SROVAR
"KRN",19,3781,20)
D ^SROVAR D:'$D(SRTN) ^SROPS S:'$D(SRTN) XQUIT="" Q:$D(XQUIT)  D ENTER^SROES
"KRN",19,3781,22)
Q
"KRN",19,3781,25)
SROMED
"KRN",19,3781,30)

"KRN",19,3781,31)

"KRN",19,3781,50)

"KRN",19,3781,51)

"KRN",19,3781,"U")
MEDICATIONS (ENTER/EDIT)
"KRN",19,3807,-1)
3^18
"KRN",19,3807,0)
SRO-CHIEF REPORTS^Management Reports^^M^^^^^^^^SURGERY^^1^1^^1
"KRN",19,3807,1,0)
^19.06^2^2^3030624^^^^
"KRN",19,3807,1,1,0)
This menu contains various management reports to be generated
"KRN",19,3807,1,2,0)
by the Chief of Surgery.
"KRN",19,3807,10,0)
^19.01PI^20^15
"KRN",19,3807,10,9,0)
3814^U^8
"KRN",19,3807,10,9,"^")
SRODCT1
"KRN",19,3807,15)
D EXIT^SROVAR W @IOF
"KRN",19,3807,20)
D ^SROVAR W @IOF
"KRN",19,3807,22)
Q
"KRN",19,3807,26)
D HDR^SROUTL
"KRN",19,3807,99)
59430,31043
"KRN",19,3807,"U")
MANAGEMENT REPORTS
"KRN",19,3820,-1)
0^31
"KRN",19,3820,0)
SROVER^Surgeon's Verification of Diagnosis & Procedures^^R^^SROEDIT^^^^^^^^1^1
"KRN",19,3820,1,0)
^19.06^3^3^3020614^^^^
"KRN",19,3820,1,1,0)
This option is used to verify that the procedure(s), diagnosis and
"KRN",19,3820,1,2,0)
complications are correct for the case.  It is intended for use
"KRN",19,3820,1,3,0)
by the Surgeon, not the OR nurses.
"KRN",19,3820,15)
D EXIT^SROES,EXIT^SROVAR
"KRN",19,3820,20)
D ^SROVAR D:'$D(SRTN) ^SROPS S:'$D(SRTN) XQUIT="" Q:$D(XQUIT)
"KRN",19,3820,22)
Q
"KRN",19,3820,25)
SROVER
"KRN",19,3820,99)
58969,38119
"KRN",19,3820,"U")
SURGEON'S VERIFICATION OF DIAG
"KRN",19,3821,-1)
0^29
"KRN",19,3821,0)
SROMEN-PACU^Enter PAC(U) Information^^R^^^^^^^^^^1^1
"KRN",19,3821,1,0)
^^1^1^2930517^^^
"KRN",19,3821,1,1,0)
This option is used to enter or edit recovery room scores and times.
"KRN",19,3821,15)
D EXIT^SROES,EXIT^SROVAR
"KRN",19,3821,20)
D ^SROVAR D:'$D(SRTN) ^SROPS S:'$D(SRTN) XQUIT="" Q:$D(XQUIT)  D ENTER^SROES
"KRN",19,3821,22)
Q
"KRN",19,3821,25)
PACU^SROMENU
"KRN",19,3821,"U")
ENTER PAC(U) INFORMATION
"KRN",19,3830,-1)
0^32
"KRN",19,3830,0)
SROMEN-REST^Enter Irrigations and Restraints^^R^^SROEDIT^^^^^^^^1^1
"KRN",19,3830,1,0)
^^2^2^2880816^
"KRN",19,3830,1,1,0)
This option is used to stuff in multiple restraints and positioning
"KRN",19,3830,1,2,0)
aids.
"KRN",19,3830,15)
D EXIT^SROES,EXIT^SROVAR
"KRN",19,3830,20)
D ^SROVAR D:'$D(SRTN) ^SROPS S:'$D(SRTN) XQUIT="" Q:$D(XQUIT)  D ENTER^SROES
"KRN",19,3830,22)
Q
"KRN",19,3830,25)
SROREST
"KRN",19,3830,"U")
ENTER IRRIGATIONS AND RESTRAIN
"KRN",19,7298,-1)
0^44
"KRN",19,7298,0)
SROA LAB^Laboratory Test Results (Enter/Edit)^^R^^^^^^^^^^1^1
"KRN",19,7298,1,0)
^^3^3^2910607^^^^
"KRN",19,7298,1,1,0)
This option is used to enter or edit laboratory information 
"KRN",19,7298,1,2,0)
for an individual risk assessment.
"KRN",19,7298,1,3,0)
 
"KRN",19,7298,15)
D EXIT^SROES,EXIT^SROVAR
"KRN",19,7298,20)
D ^SROVAR Q:$D(XQUIT)  D SRA^SROES
"KRN",19,7298,22)
Q
"KRN",19,7298,25)
SROALAB
"KRN",19,7298,"U")
LABORATORY TEST RESULTS (ENTER
"KRN",19,7301,-1)
0^42
"KRN",19,7301,0)
SROA COMPLETE ASSESSMENT^Update Assessment Status to 'COMPLETE'^^R^^^^^^^^SURGERY^^1^1
"KRN",19,7301,1,0)
^^4^4^2920430^^^^
"KRN",19,7301,1,1,0)
This option is used to update the status of a risk assessment entry
"KRN",19,7301,1,2,0)
from 'INCOMPLETE' to 'COMPLETE'.  Only completed assessments can be 
"KRN",19,7301,1,3,0)
transmitted.
"KRN",19,7301,1,4,0)
 
"KRN",19,7301,15)
D EXIT^SROES,EXIT^SROVAR
"KRN",19,7301,20)
D ^SROVAR Q:$D(XQUIT)  D SRA^SROES
"KRN",19,7301,22)
Q
"KRN",19,7301,25)
SROACOM
"KRN",19,7301,"U")
UPDATE ASSESSMENT STATUS TO 'C
"KRN",19,7302,-1)
0^46
"KRN",19,7302,0)
SROA PREOP DATA^Preoperative Information (Enter/Edit)^^R^^^^^^^^^^1^1
"KRN",19,7302,1,0)
^^2^2^2950308^
"KRN",19,7302,1,1,0)
This option is used by the nurse reviewer to enter or edit preoperative
"KRN",19,7302,1,2,0)
assessment information.
"KRN",19,7302,15)
D EXIT^SROES,EXIT^SROVAR
"KRN",19,7302,20)
D ^SROVAR Q:$D(XQUIT)  D SRA^SROES
"KRN",19,7302,22)
Q
"KRN",19,7302,25)
SROAPRE
"KRN",19,7302,"U")
PREOPERATIVE INFORMATION (ENTE
"KRN",19,7305,-1)
0^45
"KRN",19,7305,0)
SROA OPERATION DATA^Operation Information (Enter/Edit)^^R^^^^^^^^^^1^1
"KRN",19,7305,1,0)
^^3^3^2910624^
"KRN",19,7305,1,1,0)
This option is used to enter or edit information related to the
"KRN",19,7305,1,2,0)
operation.
"KRN",19,7305,1,3,0)
 
"KRN",19,7305,15)
D EXIT^SROES,EXIT^SROVAR
"KRN",19,7305,20)
D ^SROVAR Q:$D(XQUIT)  D SRA^SROES
"KRN",19,7305,22)
Q
"KRN",19,7305,25)
SROAOP
"KRN",19,7305,"U")
OPERATION INFORMATION (ENTER/E
"KRN",19,7307,-1)
0^41
"KRN",19,7307,0)
SROA CLINICAL INFORMATION^Clinical Information (Enter/Edit)^^R^^^^^^^^^^1^1
"KRN",19,7307,1,0)
^^3^3^2920430^^
"KRN",19,7307,1,1,0)
This option is used to enter the clinical information required for
"KRN",19,7307,1,2,0)
the cardiac surgery risk assessments.
"KRN",19,7307,1,3,0)
 
"KRN",19,7307,15)
D EXIT^SROES,EXIT^SROVAR
"KRN",19,7307,20)
D ^SROVAR Q:$D(XQUIT)  D SRA^SROES
"KRN",19,7307,22)
Q
"KRN",19,7307,25)
SROACLN
"KRN",19,7307,"U")
CLINICAL INFORMATION (ENTER/ED
"KRN",19,7308,-1)
0^40
"KRN",19,7308,0)
SROA CATHETERIZATION^Enter Cardiac Catheterization & Angiographic Data^^R^^^^^^^^^^1^1
"KRN",19,7308,1,0)
^^3^3^2920430^^
"KRN",19,7308,1,1,0)
This option is used to enter or edit cardiac catheterization and
"KRN",19,7308,1,2,0)
angiographic information for cardiac surgery risk assessments.
"KRN",19,7308,1,3,0)
 
"KRN",19,7308,15)
D EXIT^SROES,EXIT^SROVAR
"KRN",19,7308,20)
D ^SROVAR Q:$D(XQUIT)  D SRA^SROES
"KRN",19,7308,22)
Q
"KRN",19,7308,25)
SROACAT
"KRN",19,7308,"U")
ENTER CARDIAC CATHETERIZATION 
"KRN",19,7309,-1)
0^36
"KRN",19,7309,0)
SROA CARDIAC OPERATIVE RISK^Operative Risk Summary Data (Enter/Edit)^^R^^^^^^^^^^1^1
"KRN",19,7309,1,0)
^^3^3^2920701^^^
"KRN",19,7309,1,1,0)
This option is used to enter or edit operative risk summary data
"KRN",19,7309,1,2,0)
for the cardiac surgery risk assessments.
"KRN",19,7309,1,3,0)
 
"KRN",19,7309,15)
D EXIT^SROES,EXIT^SROVAR
"KRN",19,7309,20)
D ^SROVAR Q:$D(XQUIT)  D SRA^SROES
"KRN",19,7309,22)
Q
"KRN",19,7309,25)
SROACOP
"KRN",19,7309,"U")
OPERATIVE RISK SUMMARY DATA (E
"KRN",19,7310,-1)
0^38
"KRN",19,7310,0)
SROA CARDIAC PROCEDURES^Cardiac Procedures Requiring CPB (Enter/Edit)^^R^^^^^^^^^^1^1
"KRN",19,7310,1,0)
^^4^4^2920430^^
"KRN",19,7310,1,1,0)
This option is used to enter or edit information related to
"KRN",19,7310,1,2,0)
cardiac procedures requiring cardiopulmonary bypass for the
"KRN",19,7310,1,3,0)
cardiac surgery risk assessments.
"KRN",19,7310,1,4,0)
 
"KRN",19,7310,15)
D EXIT^SROES,EXIT^SROVAR
"KRN",19,7310,20)
D ^SROVAR Q:$D(XQUIT)  D SRA^SROES
"KRN",19,7310,22)
Q
"KRN",19,7310,25)
SROACAR
"KRN",19,7310,"U")
CARDIAC PROCEDURES REQUIRING C
"KRN",19,7314,-1)
3^6
"KRN",19,7314,0)
SRO PACKAGE MANAGEMENT^Surgery Package Management Menu^^M^^SRCOORD^^^^^^SURGERY^^1^1^^1
"KRN",19,7314,1,0)
^19.06^4^4^3010607^^^^
"KRN",19,7314,1,1,0)
This menu contains options used to manage the Surgery package.  It
"KRN",19,7314,1,2,0)
includes options to maintain site configurable information within the
"KRN",19,7314,1,3,0)
package.
"KRN",19,7314,1,4,0)
 
"KRN",19,7314,10,0)
^19.01IP^13^10
"KRN",19,7314,10,13,0)
11853^V
"KRN",19,7314,10,13,"^")
SR VIEW HISTORICAL REPORTS
"KRN",19,7314,15)
D EXIT^SROVAR
"KRN",19,7314,20)
D ^SROVAR W @IOF
"KRN",19,7314,22)
Q
"KRN",19,7314,26)
D HDR^SROUTL
"KRN",19,7314,99)
58597,43094
"KRN",19,7314,"U")
SURGERY PACKAGE MANAGEMENT MEN
"KRN",19,7324,-1)
0^23
"KRN",19,7324,0)
SRO INTRAOP COMP^Intraoperative Occurrences (Enter/Edit)^^R^^^^^^^^SURGERY^^1^1
"KRN",19,7324,1,0)
^^3^3^2950226^
"KRN",19,7324,1,1,0)
This option is used to enter or edit intraoperative occurrences. Every
"KRN",19,7324,1,2,0)
occurrence entered must have a corresponding perioperative occurrence
"KRN",19,7324,1,3,0)
category.
"KRN",19,7324,15)
D EXIT^SROES,EXIT^SROVAR
"KRN",19,7324,20)
D ^SROVAR D:'$D(SRTN) ^SROPS S:'$D(SRTN) XQUIT="" Q:$D(XQUIT)  D SRA^SROES
"KRN",19,7324,22)
Q
"KRN",19,7324,25)
INTRA^SROCMPS
"KRN",19,7324,"U")
INTRAOPERATIVE OCCURRENCES (EN
"KRN",19,7325,-1)
0^24
"KRN",19,7325,0)
SRO POSTOP COMP^Postoperative Occurrences (Enter/Edit)^^R^^^^^^^^SURGERY^^1^1
"KRN",19,7325,1,0)
^^2^2^2950226^
"KRN",19,7325,1,1,0)
This option is used to enter or edit information related to
"KRN",19,7325,1,2,0)
postoperative occurrences.
"KRN",19,7325,15)
D EXIT^SROVAR
"KRN",19,7325,20)
D ^SROVAR D:'$D(SRTN) ^SROPS S:'$D(SRTN) XQUIT="" Q:$D(XQUIT)
"KRN",19,7325,22)
Q
"KRN",19,7325,25)
POST^SROCMPS
"KRN",19,7325,"U")
POSTOPERATIVE OCCURRENCES (ENT
"KRN",19,7326,-1)
0^37
"KRN",19,7326,0)
SRO UPDATE RETURNS^Update Status of Returns Within 30 Days^^R^^^^^^^^SURGERY^^1^1
"KRN",19,7326,1,0)
^19.06^3^3^3020802^^
"KRN",19,7326,1,1,0)
This option is used to update the status of Returns to Surgery within
"KRN",19,7326,1,2,0)
30 days of a surgical case.
"KRN",19,7326,1,3,0)
 
"KRN",19,7326,15)
D EXIT^SROVAR
"KRN",19,7326,20)
D ^SROVAR Q:$D(XQUIT)
"KRN",19,7326,22)
Q
"KRN",19,7326,25)
SROARET
"KRN",19,7326,"U")
UPDATE STATUS OF RETURNS WITHI
"KRN",19,7335,-1)
0^19
"KRN",19,7335,0)
SR NON-OR REPORT^Procedure Report (Non-O.R.)^^R^^^^^^^^SURGERY^^1^1
"KRN",19,7335,1,0)
^^3^3^3030908^
"KRN",19,7335,1,1,0)
This option generates the Procedure Report (Non-O.R.). This report 
"KRN",19,7335,1,2,0)
consists of the electronically signed procedure summary (provider's 
"KRN",19,7335,1,3,0)
dictation) stored in the Text Integration Utilities (TIU) software.
"KRN",19,7335,15)
D EXIT^SROVAR
"KRN",19,7335,20)
D ^SROVAR Q:$D(XQUIT)
"KRN",19,7335,22)
Q
"KRN",19,7335,25)
SRONON
"KRN",19,7335,"U")
PROCEDURE REPORT (NON-O.R.)
"KRN",19,9655,-1)
0^43
"KRN",19,9655,0)
SROA DEMOGRAPHICS^Patient Demographics (Enter/Edit)^^R^^^^^^^^SURGERY^^1^1
"KRN",19,9655,1,0)
^^4^4^2960308^
"KRN",19,9655,1,1,0)
This option is used to enter, edit or review risk assessment patient
"KRN",19,9655,1,2,0)
demographic information such as patient movement dates, length of
"KRN",19,9655,1,3,0)
postoperative hospital stay, race, in/out-patient status and other
"KRN",19,9655,1,4,0)
information related to this surgical episode.
"KRN",19,9655,15)
D EXIT^SROES,EXIT^SROVAR
"KRN",19,9655,20)
D ^SROVAR Q:$D(XQUIT)  D SRA^SROES
"KRN",19,9655,22)
Q
"KRN",19,9655,25)
SROAPM
"KRN",19,9655,"U")
PATIENT DEMOGRAPHICS (ENTER/ED
"KRN",19,10605,-1)
0^39
"KRN",19,10605,0)
SROA CARDIAC RESOURCE^Resource Data^^R^^^^^^^^SURGERY^^1^1
"KRN",19,10605,1,0)
^^3^3^2970916^^^^
"KRN",19,10605,1,1,0)
This option is used to enter, edit or review risk assessment
"KRN",19,10605,1,2,0)
cardiac patient demographic information such as hospital admission and
"KRN",19,10605,1,3,0)
discharge dates and other information related to this surgical episode.
"KRN",19,10605,15)
D EXIT^SROES,EXIT^SROVAR
"KRN",19,10605,20)
D ^SROVAR Q:$D(XQUIT)  D SRA^SROES
"KRN",19,10605,22)
Q
"KRN",19,10605,25)
SROACPM
"KRN",19,10605,"U")
RESOURCE DATA
"KRN",19,11283,-1)
3^4
"KRN",19,11283,0)
SRCODING UPDATE/VERIFY MENU^CPT/ICD9 Update/Verify Menu^^M^^SR CODER^^^^^^SURGERY^y^1^1^^1
"KRN",19,11283,1,0)
^19.06^2^2^3010613^^^
"KRN",19,11283,1,1,0)
This menu contains options to be used by those responsible for entering
"KRN",19,11283,1,2,0)
CPT and ICD9 codes for operations and non-OR procedures.
"KRN",19,11283,10,0)
^19.01IP^4^3
"KRN",19,11283,10,1,0)
11284^UV^1
"KRN",19,11283,10,1,"^")
SRCODING EDIT
"KRN",19,11283,10,3,0)
11285^OR^2
"KRN",19,11283,10,3,"^")
SRCODING OP REPORT
"KRN",19,11283,10,4,0)
11286^NR^3
"KRN",19,11283,10,4,"^")
SRCODING NURSE REPORT
"KRN",19,11283,15)
D EXIT^SROVAR K SRTN
"KRN",19,11283,20)
K SRCASE D ^SROVAR Q:$D(XQUIT)  D:'$D(SRTN) ^SROPS1 W @IOF S:'$D(SRTN) XQUIT="" Q:$D(XQUIT)  D ^SRSKILL
"KRN",19,11283,22)
Q
"KRN",19,11283,26)
D HDR^SROUTL
"KRN",19,11283,99)
59037,53476
"KRN",19,11283,"U")
CPT/ICD9 UPDATE/VERIFY MENU
"KRN",19,11284,-1)
0^1
"KRN",19,11284,0)
SRCODING EDIT^Update/Verify Procedure/Diagnosis Codes^^R^^^^^^^^SURGERY^y^1^1
"KRN",19,11284,1,0)
^^2^2^2990827^^^
"KRN",19,11284,1,1,0)
This option is used to edit and/or verify the CPT and ICD9 codes for an
"KRN",19,11284,1,2,0)
operation or non-OR procedure.
"KRN",19,11284,15)
D EXIT^SROES K:'$D(SRTNK) SRTN K SRTNK D EXIT^SROVAR
"KRN",19,11284,20)
D ^SROVAR Q:$D(XQUIT)  S:$D(SRTN) SRTNK=SRTN D:'$D(SRTN) ^SROPS1 S:'$D(SRTN) XQUIT="" Q:$D(XQUIT)  D ENTER^SROES
"KRN",19,11284,22)
Q
"KRN",19,11284,25)
SROVER2
"KRN",19,11284,"U")
UPDATE/VERIFY PROCEDURE/DIAGNO
"KRN",19,11285,-1)
0^2
"KRN",19,11285,0)
SRCODING OP REPORT^Operation/Procedure Report^^R^^^^^^^^SURGERY^y^1^1
"KRN",19,11285,1,0)
^19.06^2^2^3020821^^
"KRN",19,11285,1,1,0)
This option is used by the coders to print the operation report on an
"KRN",19,11285,1,2,0)
operation or the non-OR procedure report on a non-OR procedure.
"KRN",19,11285,15)
D EXIT^SROVAR
"KRN",19,11285,20)
D ^SROVAR I '$G(SRTN) D ^SROPS1 S:'$D(SRTN) XQUIT="" Q:$D(XQUIT)
"KRN",19,11285,22)
Q
"KRN",19,11285,25)
ORPT^SROVER2
"KRN",19,11285,99)
57659,39976
"KRN",19,11285,"U")
OPERATION/PROCEDURE REPORT
"KRN",19,11286,-1)
0^3
"KRN",19,11286,0)
SRCODING NURSE REPORT^Nurse Intraoperative Report^^R^^^^^^^^SURGERY^y^1^1
"KRN",19,11286,1,0)
^19.06^11^11^3020821^^^
"KRN",19,11286,1,1,0)
This option is used by the coders to print the nurse intraoperative report
"KRN",19,11286,1,2,0)
for an operation.  If the report is not electronically signed, the option
"KRN",19,11286,1,3,0)
displays information directly from the SURGERY file (#130) with the choice
"KRN",19,11286,1,4,0)
to edit the information on the report, to print/view the report from the
"KRN",19,11286,1,5,0)
beginning, and to sign the report electronically if appropriate for the
"KRN",19,11286,1,6,0)
user.  After the report is electronically signed, this option allows the
"KRN",19,11286,1,7,0)
signed report to be edited by updating the information in the SURGERY file
"KRN",19,11286,1,8,0)
(#130) and by creating addenda and this option allows the signed report to
"KRN",19,11286,1,9,0)
be viewed or printed.
"KRN",19,11286,1,10,0)
 
"KRN",19,11286,1,11,0)
This report is not available for non-OR procedures.
"KRN",19,11286,15)
D EXIT^SROVAR
"KRN",19,11286,20)
D ^SROVAR I '$G(SRTN) D ^SROPS1 S:'$D(SRTN) XQUIT="" Q:$D(XQUIT)
"KRN",19,11286,22)
Q
"KRN",19,11286,25)
NRPT^SROVER2
"KRN",19,11286,"U")
NURSE INTRAOPERATIVE REPORT
"KRN",19,11853,-1)
0^5
"KRN",19,11853,0)
SR VIEW HISTORICAL REPORTS^Make Reports Viewable in CPRS^^R^^^^^^^^SURGERY^^1^1
"KRN",19,11853,1,0)
^^4^4^3030821^
"KRN",19,11853,1,1,0)
This option allows Operation Reports, Nurse Intraoperative Reports,
"KRN",19,11853,1,2,0)
Anesthesia Reports and Procedure Reports (Non-O.R.) for historical cases
"KRN",19,11853,1,3,0)
to be moved into TIU as "electronically unsigned" to make them viewable
"KRN",19,11853,1,4,0)
within the CPRS Surgery tab.
"KRN",19,11853,15)
D EXIT^SROVAR
"KRN",19,11853,20)
D ^SROVAR
"KRN",19,11853,22)
Q
"KRN",19,11853,25)
SROHIS
"KRN",19,11853,"U")
MAKE REPORTS VIEWABLE IN CPRS
"KRN",19,12460,-1)
1^7
"KRN",19,12460,0)
SROCHDD
"KRN",19,12461,-1)
1^8
"KRN",19,12461,0)
SRSDDEL
"KRN",19,12462,-1)
1^9
"KRN",19,12462,0)
SRODICT
"KRN",19,12463,-1)
1^10
"KRN",19,12463,0)
SR DICTATION
"KRN",19,12464,-1)
1^11
"KRN",19,12464,0)
SRODCT1
"KRN",19,12465,-1)
1^12
"KRN",19,12465,0)
SRSEND
"KRN",19,12466,-1)
1^13
"KRN",19,12466,0)
SRSTRAN
"KRN",19,12467,-1)
1^14
"KRN",19,12467,0)
SRSTRANS PRINT
"KRN",19,12468,-1)
1^15
"KRN",19,12468,0)
SRSTRANS PQ
"KRN",19,12469,-1)
1^16
"KRN",19,12469,0)
SRSTRANS ERROR
"KRN",19,12470,-1)
1^17
"KRN",19,12470,0)
SRSTRANS MENU
"KRN",19,12471,-1)
1^47
"KRN",19,12471,0)
SRTASK-BATCH OP REPORTS
"MBREQ")
0
"ORD",0,9.8)
9.8;;1;RTNF^XPDTA;RTNE^XPDTA
"ORD",0,9.8,0)
ROUTINE
"ORD",7,.402)
.402;7;;;EDEOUT^DIFROMSO(.402,DA,"",XPDA);FPRE^DIFROMSI(.402,"",XPDA);EPRE^DIFROMSI(.402,DA,$E("N",$G(XPDNEW)),XPDA,"",OLDA);;EPOST^DIFROMSI(.402,DA,"",XPDA);DEL^DIFROMSK(.402,"",%)
"ORD",7,.402,0)
INPUT TEMPLATE
"ORD",18,19)
19;18;;;OPT^XPDTA;OPTF1^XPDIA;OPTE1^XPDIA;OPTF2^XPDIA;;OPTDEL^XPDIA
"ORD",18,19,0)
OPTION
"PKG",167,-1)
1^1
"PKG",167,0)
SURGERY^SR^SURGICAL DATA COLLECTION AND OPERATIONS SCHEDULING
"PKG",167,20,0)
^9.402P^^
"PKG",167,22,0)
^9.49I^1^1
"PKG",167,22,1,0)
3.0^2930624^2930811
"PKG",167,22,1,"PAH",1,0)
100^3040303
"PKG",167,22,1,"PAH",1,1,0)
^^12^12^3040303
"PKG",167,22,1,"PAH",1,1,1,0)
This patch provides the ability to electronically sign operative reports 
"PKG",167,22,1,"PAH",1,1,2,0)
contained within the VISTA Surgery V. 3.0 application. These reports
"PKG",167,22,1,"PAH",1,1,3,0)
include the Operation Report, the Nurse Intraoperative Report, the
"PKG",167,22,1,"PAH",1,1,4,0)
Anesthesia Report and the Procedure Report (Non-O.R.). This patch provides
"PKG",167,22,1,"PAH",1,1,5,0)
the ability to view these signed reports through the Computerized Patient
"PKG",167,22,1,"PAH",1,1,6,0)
Record System (CPRS) by storing them in the Text Integration Utilities
"PKG",167,22,1,"PAH",1,1,7,0)
(TIU) V. 1.0 application. Tools provided by the TIU software will be used
"PKG",167,22,1,"PAH",1,1,8,0)
to sign and manage the electronic documents.
"PKG",167,22,1,"PAH",1,1,9,0)
 
"PKG",167,22,1,"PAH",1,1,10,0)
Features provided by this patch are described in the Surgery Electronic 
"PKG",167,22,1,"PAH",1,1,11,0)
Signature for Operative Reports Release Notes and in the Surgery 
"PKG",167,22,1,"PAH",1,1,12,0)
Electronic Signature for Operative Reports Implementation Guide.
"PRE")
SR100ENV
"QUES","POS01",0)
YA
"QUES","POS01","A")
Do you have the completed pre-installation worksheet? 
"QUES","POS01","B")
NO
"QUES","POS02",0)
YA
"QUES","POS02","?")
and to make it part of the report. 
"QUES","POS02","?",1)
Enter YES to require the principal CPT code prior to electronic signature
"QUES","POS02","A")
Display CPT Codes on Nurse Intraoperative Report? 
"QUES","POS02","A",1)
 
"QUES","POS02","A",2)
 >>> New Site Parameters <<<
"QUES","POS02","A",3)
 Answer the following questions to define the default site parameters that
"QUES","POS02","A",4)
 will be used to control the display of information related to options
"QUES","POS02","A",5)
 created by the Surgery Electronic Signature for Operative Reports patch
"QUES","POS02","A",6)
 SR*3*100.  These responses will be stored for each division defined in
"QUES","POS02","A",7)
 the SURGERY SITE PARAMETERS file (#133) and may be updated after this
"QUES","POS02","A",8)
 patch is installed.
"QUES","POS02","A",9)
   
"QUES","POS02","A",10)
   
"QUES","POS02","B")
NO
"QUES","POS02","M")
S:XPDQUES("POS01")=0 XPDQUIT=2 K DIR
"QUES","POS03",0)
YA
"QUES","POS03","?")
signature and to make it part of the report. 
"QUES","POS03","?",1)
Enter YES to require the principal diagnosis code prior to electronic
"QUES","POS03","A")
Display ICD-9 Codes on Nurse Intraoperative Report? 
"QUES","POS03","A",1)
   
"QUES","POS03","B")
NO
"QUES","POS03","M")
K DIR
"QUES","POS04",0)
YA
"QUES","POS04","?")
Enter YES if the electronically signed Anesthesia Report is used.
"QUES","POS04","A")
Does this facility use the Anesthesia Report? 
"QUES","POS04","A",1)
 
"QUES","POS04","A",2)
 >>> New Site Parameter <<<
"QUES","POS04","A",3)
 Answer the following question to define the default site parameter 
"QUES","POS04","A",4)
 related to the use of the Anesthesia Report at your facility. This 
"QUES","POS04","A",5)
 response will be stored for each division defined in the SURGERY SITE
"QUES","POS04","A",6)
 PARAMETERS file (#133) and may be updated after this patch is 
"QUES","POS04","A",7)
 installed.
"QUES","POS04","A",8)
  
"QUES","POS04","B")
NO
"QUES","POS04","M")
I XPDQUES("POS01")=0 K DIR
"QUES","POS05",0)
DA^:DT:EX
"QUES","POS05","?")

"QUES","POS05","A")
Enter starting date for reports to be signed electronically: 
"QUES","POS05","A",1)
  
"QUES","POS05","A",2)
 >>> Starting Date for Reports to be Signed Electronically <<<
"QUES","POS05","A",3)
 During the post-installation process, all reports for completed cases
"QUES","POS05","A",4)
 with an operation date on or after the date selected will be identified
"QUES","POS05","A",5)
 to be signed electronically and stub entries will be created in TIU.
"QUES","POS05","A",6)
  
"QUES","POS05","B")
TODAY
"QUES","POS05","M")
I XPDQUES("POS01")=0 K DIR
"QUES","POS06",0)
YA
"QUES","POS06","A")
Do you want to move reports during the patch installation? 
"QUES","POS06","A",1)
 
"QUES","POS06","A",2)
>>> Making Reports for Historical Cases Viewable through CPRS <<<
"QUES","POS06","A",3)
This patch includes a post-installation process that will move designated
"QUES","POS06","A",4)
reports for historical Surgery cases into TIU. By doing so, these reports,
"QUES","POS06","A",5)
while unsigned electronically, will be viewable within the CPRS Surgery
"QUES","POS06","A",6)
tab. These "electronically unsigned" reports will contain a disclaimer
"QUES","POS06","A",7)
stating; "This information is provided from historical files and cannot
"QUES","POS06","A",8)
be verified that the author has authenticated/approved this information.
"QUES","POS06","A",9)
The authenticated source document in the patient's medical record should
"QUES","POS06","A",10)
be reviewed to ensure that all information concerning this event has been
"QUES","POS06","A",11)
reviewed or noted." 
"QUES","POS06","A",12)
 
"QUES","POS06","A",13)
NOTE: The site parameters entered above will be applied in this process.
"QUES","POS06","A",14)
For multi-divisional facilities, if different parameter settings should be
"QUES","POS06","A",15)
applied for each division, or if for any reason the process to make
"QUES","POS06","A",16)
reports for historical surgery cases viewable in CPRS should not be run
"QUES","POS06","A",17)
during this patch installation, answer NO to this question. A new option
"QUES","POS06","A",18)
is provided to run this process later.
"QUES","POS06","A",19)
  
"QUES","POS06","B")
NO
"QUES","POS06","M")
I XPDQUES("POS01")=0 K DIR
"QUES","POS07",0)
DA^:DT:EXP
"QUES","POS07","A")
Enter the starting date for reports to be moved: 
"QUES","POS07","A",1)
   
"QUES","POS07","B")
TODAY
"QUES","POS07","M")
S DIR("B")=$G(XPDQUES("POS05","B")) I $G(XPDQUES("POS06"))=0!($G(XPDQUES("POS01"))=0) K DIR
"QUES","POS08",0)
YA
"QUES","POS08","A")
Do you want to move the Operation Reports? 
"QUES","POS08","A",1)
   
"QUES","POS08","B")
NO
"QUES","POS08","M")
I $G(XPDQUES("POS06"))=0!($G(XPDQUES("POS01"))=0) K DIR
"QUES","POS09",0)
YA
"QUES","POS09","A")
Do you want to move the Nurse Intraoperative Reports? 
"QUES","POS09","A",1)
   
"QUES","POS09","B")
NO
"QUES","POS09","M")
I $G(XPDQUES("POS06"))=0!($G(XPDQUES("POS01"))=0) K DIR
"QUES","POS10",0)
YA
"QUES","POS10","A")
Do you want to move the Anesthesia Reports? 
"QUES","POS10","A",1)
   
"QUES","POS10","B")
NO
"QUES","POS10","M")
I $G(XPDQUES("POS06"))=0!($G(XPDQUES("POS01"))=0)!($G(XPDQUES("POS04"))=0) K DIR
"QUES","POS11",0)
YA
"QUES","POS11","A")
Do you want to move the Procedure Reports (Non-O.R.)? 
"QUES","POS11","A",1)
   
"QUES","POS11","B")
NO
"QUES","POS11","M")
I $G(XPDQUES("POS06"))=0!($G(XPDQUES("POS01"))=0) K DIR
"QUES","POS12",0)
YA
"QUES","POS12","A")
Is this correct? 
"QUES","POS12","B")
NO
"QUES","POS12","M")
D POS12^SR100ENV
"QUES","POS13",0)
FOA
"QUES","POS13","?")
Press the ENTER key.
"QUES","POS13","A")
Press ENTER to continue 
"QUES","POS13","A",1)
 
"QUES","POS13","A",2)
If you need to move additional reports for a different date range, the
"QUES","POS13","A",3)
Make Reports Viewable in CPRS option contained on the Surgery Package
"QUES","POS13","A",4)
Management Menu can be used after this patch is installed.
"QUES","POS13","A",5)
 
"QUES","POS13","A",6)
The post-installation process will be tasked to run immediately at the end
"QUES","POS13","A",7)
of patch installation.  The following actions will occur in the following
"QUES","POS13","A",8)
order:
"QUES","POS13","A",9)
 (1) Conversion of cases with documents in TIU filed by the Boston
"QUES","POS13","A",10)
     Prototype (Class III) software
"QUES","POS13","A",11)
 (2) Creation of stub entries in TIU for reports for cases completed on or
"QUES","POS13","A",12)
     after the date selected above as the starting date for reports to be
"QUES","POS13","A",13)
     signed electronically
"QUES","POS13","A",14)
 (3) Movement of reports for historical cases into TIU (if selected)
"QUES","POS13","A",15)
  
"QUES","POS13","B")

"QUES","POS13","M")
I XPDQUES("POS01")=0!($G(XPDQUES("POS12"))=0) S XPDQUIT=2 K DIR
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
158
"RTN","SR100ENV")
0^^B2841062
"RTN","SR100ENV",1,0)
SR100ENV ;BIR/ADM - SR*3*100 ENVIRONMENT CHECK ; [ 02/26/02  2:39 PM ]
"RTN","SR100ENV",2,0)
 ;;3.0; Surgery ;**100**;24 Jun 93
"RTN","SR100ENV",3,0)
 Q
"RTN","SR100ENV",4,0)
POS12 ; M code for POS12 in build
"RTN","SR100ENV",5,0)
 N SRSDT,SREDT,SROR,SRNR,SRAR,SRPR,SRN
"RTN","SR100ENV",6,0)
 I $G(XPDQUES("POS06"))=0!($G(XPDQUES("POS01"))=0) K DIR Q
"RTN","SR100ENV",7,0)
 S SRSDT=$G(XPDQUES("POS07","B")),SROR=$G(XPDQUES("POS08")),SRNR=$G(XPDQUES("POS09")),SRAR=$G(XPDQUES("POS10")),SRPR=$G(XPDQUES("POS11"))
"RTN","SR100ENV",8,0)
 I 'SROR,'SRNR,'SRAR,'SRPR K DIR Q
"RTN","SR100ENV",9,0)
 S DIR("A",1)="",DIR("A",2)="During the post-installation process, the following reports will be moved",DIR("A",3)="beginning "_SRSDT_" to the present:"
"RTN","SR100ENV",10,0)
 S SRN=4
"RTN","SR100ENV",11,0)
 I SROR S DIR("A",SRN)="   Operation Report",SRN=SRN+1
"RTN","SR100ENV",12,0)
 I SRNR S DIR("A",SRN)="   Nurse Intraoperative Report",SRN=SRN+1
"RTN","SR100ENV",13,0)
 I SRAR S DIR("A",SRN)="   Anesthesia Report",SRN=SRN+1
"RTN","SR100ENV",14,0)
 I SRPR S DIR("A",SRN)="   Procedure Report (Non-O.R.)",SRN=SRN+1
"RTN","SR100ENV",15,0)
 S DIR("A",SRN)="",SRN=SRN+1
"RTN","SR100ENV",16,0)
 Q
"RTN","SR100UTL")
0^^B12625328
"RTN","SR100UTL",1,0)
SR100UTL ;BIR/ADM - SR*3*100 INSTALL UTILITY ; [ 02/18/04  10:19 AM ]
"RTN","SR100UTL",2,0)
 ;;3.0; Surgery ;**100**;24 Jun 93
"RTN","SR100UTL",3,0)
 ;
"RTN","SR100UTL",4,0)
 ; Reference to EXTRACT^TIULQ supported by DBIA #2693
"RTN","SR100UTL",5,0)
 ; Reference to FILE^TIUSRVP supported by DBIA #3540
"RTN","SR100UTL",6,0)
 ; Reference to $$WHATITLE^TIUPUTU supported by DBIA #3351
"RTN","SR100UTL",7,0)
 ; Reference to $$DOCCLASS^TIULC1 supported by DBIA #3548
"RTN","SR100UTL",8,0)
 ;
"RTN","SR100UTL",9,0)
 Q
"RTN","SR100UTL",10,0)
PRE ; pre-install entry
"RTN","SR100UTL",11,0)
 ; delete ADIC, AUD, AUD1 x-refs, delete x-ref nodes
"RTN","SR100UTL",12,0)
 K DIE,DR,DIK,DA S DIK="^DD(130,.23,1,",DA=3,DA(1)=.23,DA(2)=130 D ^DIK
"RTN","SR100UTL",13,0)
 K DIK,DA S DIK="^DD(130,.232,1,",DA=2,DA(1)=.232,DA(2)=130 D ^DIK
"RTN","SR100UTL",14,0)
 K DIK,DA S DIK="^DD(130,15,1,",DA=1,DA(1)=15,DA(2)=130 D ^DIK
"RTN","SR100UTL",15,0)
 K DIK,DA,^SRF("AUD"),^SRF("ADIC")
"RTN","SR100UTL",16,0)
 Q
"RTN","SR100UTL",17,0)
POST ; post-install entry
"RTN","SR100UTL",18,0)
 ; delete file 136
"RTN","SR100UTL",19,0)
 I $D(^SRT(0)) S DIU="^SRT(",DIU(0)="DT" D EN^DIU2 K DIU
"RTN","SR100UTL",20,0)
 N I,SRPOS
"RTN","SR100UTL",21,0)
 F I=1:1:13 S SRPOS(I)=$G(XPDQUES("POS"_$S(I<10:"0",1:"")_I))
"RTN","SR100UTL",22,0)
 Q:SRPOS(4)=""
"RTN","SR100UTL",23,0)
 D PARAM
"RTN","SR100UTL",24,0)
 D NOW^%DTC S (SRNOW,ZTDTH)=$E(%,1,12),ZTRTN="EN1^SR100UTL",ZTDESC="SR*3*100 - Post-Install Process",ZTIO="",ZTSAVE("SRPOS*")="" D ^%ZTLOAD
"RTN","SR100UTL",25,0)
 D MES^XPDUTL("  SR*3*100 post-install process queued...")
"RTN","SR100UTL",26,0)
 ; delete unused new routines associated with SR*3*100 at test sites
"RTN","SR100UTL",27,0)
DEL F X="SRONP0","SRONP1" X ^%ZOSF("TEST") I $T D
"RTN","SR100UTL",28,0)
 .D MES^XPDUTL(" Deleting routine "_X_"...")
"RTN","SR100UTL",29,0)
 .X ^%ZOSF("DEL")
"RTN","SR100UTL",30,0)
 Q
"RTN","SR100UTL",31,0)
EN1 ; queued entry point
"RTN","SR100UTL",32,0)
 D BOST
"RTN","SR100UTL",33,0)
 D STUBS
"RTN","SR100UTL",34,0)
 I SRPOS(6) D MOVE
"RTN","SR100UTL",35,0)
MSG ; send mail message notification that post-insatll process is completed
"RTN","SR100UTL",36,0)
 S XMY(DUZ)="",XMSUB="SR*3*100 Post-Install Is Completed"
"RTN","SR100UTL",37,0)
 S SRTXT(1)="The post-install process for patch SR*3*100 is completed."
"RTN","SR100UTL",38,0)
 S XMDUZ=.5,XMTEXT="SRTXT("
"RTN","SR100UTL",39,0)
 N I D ^XMD S ZTREQ="@"
"RTN","SR100UTL",40,0)
 Q
"RTN","SR100UTL",41,0)
STUBS ; identify and create stub entries in TIU for reports to be signed
"RTN","SR100UTL",42,0)
 N SRDT,SRTN Q:SRPOS(5)=""
"RTN","SR100UTL",43,0)
 S SRDT=SRPOS(5)-".0001"
"RTN","SR100UTL",44,0)
 F  S SRDT=$O(^SRF("AC",SRDT)) Q:'SRDT  S SRTN=0 F  S SRTN=$O(^SRF("AC",SRDT,SRTN)) Q:'SRTN  D
"RTN","SR100UTL",45,0)
 .I $P($G(^SRF(SRTN,"NON")),"^")="Y" D NONOR Q
"RTN","SR100UTL",46,0)
 .I $P($G(^SRF(SRTN,.2)),"^",12) D
"RTN","SR100UTL",47,0)
 ..I '$P($G(^SRF(SRTN,"TIU")),"^") D OR^SROESX
"RTN","SR100UTL",48,0)
 ..I '$P($G(^SRF(SRTN,"TIU")),"^",2) D NR^SROESX
"RTN","SR100UTL",49,0)
 ..I '$P($G(^SRF(SRTN,"TIU")),"^",4),$P($G(^SRF(SRTN,.2)),"^",4),$$INUSE^SROESXA(SRTN) D AR^SROESXA
"RTN","SR100UTL",50,0)
 Q
"RTN","SR100UTL",51,0)
PARAM ; set default site parameters
"RTN","SR100UTL",52,0)
 N DIV,J,SRP,Y,Z
"RTN","SR100UTL",53,0)
 S SRP="^0^0" S $P(SRP,"^",4)=SRPOS(4)
"RTN","SR100UTL",54,0)
 S DIV=0 F  S DIV=$O(^SRO(133,DIV)) Q:'DIV  S ^SRO(133,DIV,.1)=SRP
"RTN","SR100UTL",55,0)
SRTAB ; activate surgery tab system-wide
"RTN","SR100UTL",56,0)
 D PUT^XPAR("SYS","ORWOR SHOW SURGERY TAB",1,1,.SRERR)
"RTN","SR100UTL",57,0)
 Q
"RTN","SR100UTL",58,0)
BOST ; convert Boston prototype cases
"RTN","SR100UTL",59,0)
 N DA,DIC,DIQ,DR,SRBOST,SREQ,SRERR,SRPAR,SRTITL,SRTN,SRX,SRY
"RTN","SR100UTL",60,0)
 ; quit if Boston software is not installed
"RTN","SR100UTL",61,0)
 I $$GET1^DID(130,523011,"","LABEL")'["OP NOTE POINTER" Q
"RTN","SR100UTL",62,0)
 S SRX=$$WHATITLE^TIUPUTU("OPERATION REPORT"),SRTITL=$P(SRX,"^") Q:'SRTITL
"RTN","SR100UTL",63,0)
 S SRPAR=$$DOCCLASS^TIULC1(SRTITL) Q:'SRPAR
"RTN","SR100UTL",64,0)
 S SRTN=0 F  S SRTN=$O(^SRF(SRTN)) Q:'SRTN  S SRBOST=$P($G(^SRF(SRTN,523)),"^",4) I SRBOST,'$P($G(^SRF(SRTN,"TIU")),"^") D
"RTN","SR100UTL",65,0)
 .D EXTRACT^TIULQ(SRBOST,"SRY",.SRERR,"1701")
"RTN","SR100UTL",66,0)
 .I $G(SRY(SRBOST,1701,"E"))="Case #: "_SRTN D  K SRY
"RTN","SR100UTL",67,0)
 ..S $P(^SRF(SRTN,"TIU"),"^")=SRBOST
"RTN","SR100UTL",68,0)
 ..K SREQ S SREQ(.01)=SRTITL,SREQ(.04)=SRPAR,SREQ(1405)=SRTN_";SRF(" D FILE^TIUSRVP(.SRERR,SRBOST,.SREQ,1)
"RTN","SR100UTL",69,0)
 Q
"RTN","SR100UTL",70,0)
MOVE ; move reports for historical cases to TIU
"RTN","SR100UTL",71,0)
 N SRSD,SRRPT,SRINST,SRINSTP I SRPOS(7)="" S SRPOS(7)=SRPOS(5)
"RTN","SR100UTL",72,0)
 S SRSD=SRPOS(7),SRRPT(1)=SRPOS(8),SRRPT(2)=SRPOS(9),SRRPT(3)=SRPOS(10),SRRPT(4)=SRPOS(11),(SRINST,SRINSTP)="ALL DIVISIONS"
"RTN","SR100UTL",73,0)
 D MOVE^SROHIS
"RTN","SR100UTL",74,0)
 Q
"RTN","SR100UTL",75,0)
NONOR ; if dictated summary expected field is null, set to 0
"RTN","SR100UTL",76,0)
 I $P($G(^SRF(SRTN,"TIU")),"^",5)="" S $P(^SRF(SRTN,"TIU"),"^",5)=0
"RTN","SR100UTL",77,0)
 Q
"RTN","SRHLORU")
0^1^B12930727
"RTN","SRHLORU",1,0)
SRHLORU ;B'HAM ISC/DLR - Surgery Interface Receiver of ORU messages ; [ 02/06/01  9:27 AM ]
"RTN","SRHLORU",2,0)
 ;;3.0; Surgery ;**41,100**;24 Jun 93
"RTN","SRHLORU",3,0)
 ; Per VHA Directive 10-93-142, this routine SHOULD NOT be modified.
"RTN","SRHLORU",4,0)
REC N HLCOMP,HLREP,HLSUB,HLFS,HLECH,II,SG,SRERR,SRES,SRESCNT,SRESAR,SRESNR,SRI,SSN,TYPE,SROP,SRNON,SRHL,Z
"RTN","SRHLORU",5,0)
 K HLMID,PID,SRHL S SRHL("E")=+$G(SRHL("E")),(SRESCNT,SRESAR,SRESNR)=0
"RTN","SRHLORU",6,0)
 S Z=$G(^SRF(CASE,"TIU")) S:$P(Z,"^",2) SRESNR=1 S:$P(Z,"^",4) SRESAR=1
"RTN","SRHLORU",7,0)
 F I=1:1 X HLNEXT Q:HLQUIT'>0  S (MSG,X(I))=HLNODE,SG=$E(HLNODE,1,3),J=0 D  D PICK
"RTN","SRHLORU",8,0)
 .S J=0 F  S J=$O(HLNODE(J)) Q:'J  S X(I,J)=HLNODE(J)
"RTN","SRHLORU",9,0)
 D:SRHL("E")>0 DSCPANCY^SRHLU(.HL)
"RTN","SRHLORU",10,0)
GEN ;generate the message
"RTN","SRHLORU",11,0)
 D MSA^SRHLUO(1,$S($D(HLP("ERRTEXT")):"AE",1:"AA"))
"RTN","SRHLORU",12,0)
 ;HLEID - IEN of Server event protocol
"RTN","SRHLORU",13,0)
 ;HLMTIENS - IEN in 772
"RTN","SRHLORU",14,0)
 ;HLEIDS - IEN of Client event protocol
"RTN","SRHLORU",15,0)
 ;HLARYTYP - acknowledgement array (see V. 1.6 HL7 doc)
"RTN","SRHLORU",16,0)
 ;HLFORMAT - is HLMA is pre-formatted HL7 form
"RTN","SRHLORU",17,0)
 ;HLRESLTA - message ID and/or the error message (for output)
"RTN","SRHLORU",18,0)
 ;HLP("ERRTEXT") - Processing error message
"RTN","SRHLORU",19,0)
 ;HLP("CONTPTR") - continuation pointer field value (not used)
"RTN","SRHLORU",20,0)
 ;HLP("PRIORITY") - priority field value (not used)
"RTN","SRHLORU",21,0)
 ;HLP("SECURITY") - security information (not used)
"RTN","SRHLORU",22,0)
 S HLEID=HL("EID"),HLEIDS=HL("EIDS"),HLARYTYP="GM",HLFORMAT=1,HLRESLTA="",HLMTIENA="",HLP=""
"RTN","SRHLORU",23,0)
 D GENACK^HLMA1(HLEID,HLMTIENS,HLEIDS,HLARYTYP,HLFORMAT,.HLRESLTA,HLMTIENA,.HLP)
"RTN","SRHLORU",24,0)
EXIT ;
"RTN","SRHLORU",25,0)
 K ^TMP("HLA",$J),SRHL
"RTN","SRHLORU",26,0)
 Q
"RTN","SRHLORU",27,0)
PICK ;check routine for segment entry point
"RTN","SRHLORU",28,0)
 I $T(@SG)]"" D @SG
"RTN","SRHLORU",29,0)
 I $T(@SG)="" Q
"RTN","SRHLORU",30,0)
 Q
"RTN","SRHLORU",31,0)
MSH ;;MSH
"RTN","SRHLORU",32,0)
 ;process the MSH segment
"RTN","SRHLORU",33,0)
 S (HLFS,HL("FS"))=$E(MSG,4),(HLECH,HL("ECH"))=$E(MSG,5,8)
"RTN","SRHLORU",34,0)
 S HLCOMP=$E(HL("ECH"),1),HLREP=$E(HL("ECH"),2),HLSUB=$E(HL("ECH"),4)
"RTN","SRHLORU",35,0)
 S TYPE=$P(MSG,HL("FS"),9)
"RTN","SRHLORU",36,0)
 Q
"RTN","SRHLORU",37,0)
PID ;;PID
"RTN","SRHLORU",38,0)
 ;process PID segment
"RTN","SRHLORU",39,0)
 N I,PAT
"RTN","SRHLORU",40,0)
 S PID("SSN")=$P(MSG,HL("FS"),20),PAT=$$FMNAME^HLFNC($P(MSG,HL("FS"),6))
"RTN","SRHLORU",41,0)
 I $D(PAT) F I=0:0 S I=$O(^DPT("B",PAT,I)) Q:'I  I $P(^DPT(I,0),U,9)=PID("SSN") S PID("DFN")=I
"RTN","SRHLORU",42,0)
 Q
"RTN","SRHLORU",43,0)
OBX ;;OBX
"RTN","SRHLORU",44,0)
 ;null header for OBR segments sets that are set to ignore or send
"RTN","SRHLORU",45,0)
 Q:$G(OBR)=""
"RTN","SRHLORU",46,0)
 D:$G(OBR)'="" OBX^SRHLUI(MSG,OBR,CASE)
"RTN","SRHLORU",47,0)
 Q
"RTN","SRHLORU",48,0)
NTE ;;NTE
"RTN","SRHLORU",49,0)
 ;null header for OBR segments sets that are set to ignore or send
"RTN","SRHLORU",50,0)
 Q:$G(OBR)=""
"RTN","SRHLORU",51,0)
 D NTE^SRHLUI(MSG,OBR,CASE)
"RTN","SRHLORU",52,0)
 Q
"RTN","SRHLORU",53,0)
OBR ;;OBR
"RTN","SRHLORU",54,0)
 ;process OBR segment as well as underlying OBX's or NTE
"RTN","SRHLORU",55,0)
 N DFN,ID,IEN,SRII,SRNEXT
"RTN","SRHLORU",56,0)
 ;set-up the IDentifier and check the mapping file (#133.2) for a match
"RTN","SRHLORU",57,0)
 S CASE=$P(MSG,HL("FS"),4) I 'CASE S SRDISC="Unknown Surgery Case Number in "_$P(MSG,HL("FS"),1,2)_"." D SETDSC^SRHLU(.HL,SRDISC,.SRHL) Q
"RTN","SRHLORU",58,0)
 I '$D(^SRF(CASE,0)) S SRDISC="Unknown Surgery Case Number ("_$G(CASE)_") in "_$P(MSG,HL("FS"),1,2)_"." D SETDSC^SRHLU(.HL,SRDISC,.SRHL) Q
"RTN","SRHLORU",59,0)
 S ID=$P($P(MSG,HL("FS"),5),HLCOMP,2) I $G(ID)="" S SRDISC="Unknown OBR identifier ("_$G(ID)_") for case #"_$G(CASE)_"." D SETDSC^SRHLU(.HL,SRDISC,.SRHL) Q
"RTN","SRHLORU",60,0)
 S IEN=$O(^SRO(133.2,"AC",ID,0)) I $G(IEN)="" S SRDISC="Invalid OBR identifier ("_$G(ID)_") for case #"_$G(CASE)_"." D SETDSC^SRHLU(.HL,SRDISC,.SRHL) Q
"RTN","SRHLORU",61,0)
 I $D(^SRF(CASE,0)) S DFN=$P(^SRF(CASE,0),U) I $D(PID("SSN")),$P(^DPT(DFN,0),U,9)'=$G(PID("SSN")) D  Q
"RTN","SRHLORU",62,0)
 .S SRDISC="SSN mismatch for Surgery Case #"_$G(CASE)_".  Surgery Patient "_$$GET1^DIQ(2,+DFN_",",.01)_" ("_$$GET1^DIQ(2,+40_",",.09)_") is being sent with invalid ID ("_$G(PID("SSN"))_")."
"RTN","SRHLORU",63,0)
 .D SETDSC^SRHLU(.HL,SRDISC,.SRHL)
"RTN","SRHLORU",64,0)
 ;process the OBR identifier that is set to receive
"RTN","SRHLORU",65,0)
 I $$CHECK(IEN)=1 S OBR=$$OBR^SRHLUI(CASE,DFN,IEN,MSG)
"RTN","SRHLORU",66,0)
 Q
"RTN","SRHLORU",67,0)
CHECK(IEN) ;check for valid receivable segments in file 133.2 (Surgery Interface)
"RTN","SRHLORU",68,0)
 I $G(IEN)="" Q 0
"RTN","SRHLORU",69,0)
 Q $P($G(^SRO(133.2,IEN,0)),U,4)["R"
"RTN","SRHLUI")
0^2^B28751024
"RTN","SRHLUI",1,0)
SRHLUI ;B'ham ISC/DLR - Surgery Interface Utility to process incoming segments ; [ 02/06/01  9:53 PM ]
"RTN","SRHLUI",2,0)
 ;;3.0; Surgery ;**41,100**;24 Jun 93
"RTN","SRHLUI",3,0)
 ; Per VHA Directive 10-93-142, this routine SHOULD NOT be modified.
"RTN","SRHLUI",4,0)
 ;;This routine utilizes the Surgery Interface file (133.2).
"RTN","SRHLUI",5,0)
OBR(CASE,DFN,IEN,MSG) ;process Observation Request Segment (OBR) fields 3-4,7-8,27
"RTN","SRHLUI",6,0)
 ;variables set in the calling routine SRHLORU
"RTN","SRHLUI",7,0)
 ; CASE - IEN of the case # in Surgery Case file (#130)
"RTN","SRHLUI",8,0)
 ; DFN  - IEN of the patient
"RTN","SRHLUI",9,0)
 ; IEN  - The Observation ID's internal entry number in file 133.2
"RTN","SRHLUI",10,0)
 ; MSG  - (parameter) HL7 incoming segment
"RTN","SRHLUI",11,0)
 ;
"RTN","SRHLUI",12,0)
 K DA,DR,DIE
"RTN","SRHLUI",13,0)
 N LVL,OBR,SRNOCON,SRX
"RTN","SRHLUI",14,0)
 Q:$G(MSG)="" ""
"RTN","SRHLUI",15,0)
 ;set the surgery no concurrent case flag 
"RTN","SRHLUI",16,0)
 S SRNOCON=1
"RTN","SRHLUI",17,0)
 S OBR=MSG,DA=CASE,DIE=$P(^SRO(133.2,IEN,0),U,2) K DR,DO
"RTN","SRHLUI",18,0)
 ;if there is a VISTA Surgery field(s) associated with this entry process the DR strings
"RTN","SRHLUI",19,0)
 I $P(^SRO(133.2,IEN,0),U,3)!($D(^(1,0))) D
"RTN","SRHLUI",20,0)
 .S:$P(^SRO(133.2,IEN,0),U,3) DR=$P(^(0),U,3)_"///^S X="_$$VALUE(IEN) D:$D(^SRO(133.2,IEN,1,0))
"RTN","SRHLUI",21,0)
 ..;sets the DR string level (DR and DR(2,...)) for the standard DIE call
"RTN","SRHLUI",22,0)
 ..S SRX=0 F  S SRX=$O(^SRO(133.2,IEN,1,SRX)) Q:'SRX  S LVL=$P(^SRO(133.2,SRX,0),U,9) Q:"12"[$G(LVL)&($G(LVL)="")  I $$VALUE(SRX)'="" D:$$CHECK(SRX) DR(LVL,SRX)
"RTN","SRHLUI",23,0)
 .I $D(DR) N SRESQ D
"RTN","SRHLUI",24,0)
 ..D ^SROESHL Q:SRESQ
"RTN","SRHLUI",25,0)
 ..D DRCHK D ^DIE K DIE,DA,DR,DO I $D(Y) S SRDISC="Unknown OBR identifier ("_$G(ID)_")." D SETDSC^SRHLU(.HL,SRDISC,.SRHL)
"RTN","SRHLUI",26,0)
 Q OBR
"RTN","SRHLUI",27,0)
CHECK(IEN) ;check universal id or observation id sequence to the Surgery Interface file
"RTN","SRHLUI",28,0)
 I $G(IEN)="" Q 0
"RTN","SRHLUI",29,0)
 Q $P($G(^SRO(133.2,IEN,0)),U,4)["R"
"RTN","SRHLUI",30,0)
VALUE(XX) ;SET the value of the identified segment field in file 133.2
"RTN","SRHLUI",31,0)
 S ^TMP("SR7",XX)=^SRO(133.2,XX,0)
"RTN","SRHLUI",32,0)
 N VALUE
"RTN","SRHLUI",33,0)
 ;set the value of the identifiers based on the sequences identified in file 133.2
"RTN","SRHLUI",34,0)
 S:$P(^SRO(133.2,XX,0),U,6)'="CN" VALUE=$P($P(@$P(^SRO(133.2,XX,0),U,5),HL("FS"),$P($P(^(0),U,8),"-")+1),HLCOMP,$P($P(^(0),U,8),"-",2))
"RTN","SRHLUI",35,0)
 S:$P(^SRO(133.2,XX,0),U,6)="CN" VALUE=$P(@$P(^SRO(133.2,XX,0),U,5),HL("FS"),$P($P(^(0),U,8),"-")+1)
"RTN","SRHLUI",36,0)
 S:VALUE'="" VALUE=$S($P(^SRO(133.2,XX,0),U,6)="TS":$$FMDATE^HLFNC(VALUE),$P(^(0),U,6)="CE":""""_VALUE_"""",$P(^(0),U,6)="TX":""""_VALUE_"""",$P(^(0),U,6)="FT":""""_VALUE_"""",$P(^(0),U,6)="NM":+VALUE,1:VALUE)
"RTN","SRHLUI",37,0)
 I $P(^SRO(133.2,XX,0),U,6)="CN" S VALUE=$$DNAME^SRHLU(VALUE),VALUE=$S(VALUE="":"",1:""""_VALUE_"""")
"RTN","SRHLUI",38,0)
 Q VALUE
"RTN","SRHLUI",39,0)
DR(LVL,IEN) ;set DR or DR(... string for the FileMan DIE call
"RTN","SRHLUI",40,0)
 Q:$G(LVL)=""!$G(IEN)=""
"RTN","SRHLUI",41,0)
 ;set DR string but do not four slash stuff Time Stamped values for multiples
"RTN","SRHLUI",42,0)
 I LVL=1 S VALUE=$$VALUE(IEN) S:VALUE'="" DR=$G(DR)_$S($D(DR):";",1:"")_$P(^SRO(133.2,IEN,0),U,3)_$S($P(^(0),U,6)="TS"&($P(^(0),U,3)'=".01")&('$D(^(1,0))):"/",1:"")_"///"_VALUE
"RTN","SRHLUI",43,0)
 ;set DR string but do not four slash stuff Time Stamped values for multiples
"RTN","SRHLUI",44,0)
 I LVL'=1 S VALUE=$$VALUE(IEN) S:VALUE'="" DR(LVL,$P(^SRO(133.2,IEN,0),U,2))=$G(DR(LVL,$P(^(0),U,2)))_$S($D(DR(LVL,$P(^(0),U,2))):";",1:"")_$P(^(0),U,3)_$S($P(^(0),U,6)="TS"&($P(^(0),U,3)'=".01")&('$D(^(1,0))):"/",1:"")_"///"_VALUE
"RTN","SRHLUI",45,0)
 Q
"RTN","SRHLUI",46,0)
NTE(MSG,OBR,CASE) ;process Observation Segment (OBX) fields 3,5,14,16 and NTE-3
"RTN","SRHLUI",47,0)
 ;anesthesia comments
"RTN","SRHLUI",48,0)
 Q:MSG=""
"RTN","SRHLUI",49,0)
 N ID
"RTN","SRHLUI",50,0)
 S ID=$P($P(OBR,HL("FS"),5),HLCOMP,2) I $G(ID)="" S SRDISC="Unknown OBR identifier ("_$G(ID)_")." D SETDSC^SRHLU(.HL,SRDISC,.SRHL) Q
"RTN","SRHLUI",51,0)
 S IEN=$O(^SRO(133.2,"AC",ID,0)) I $G(IEN)="" S SRDISC="Unknown OBR identifier ("_$G(ID)_")." D SETDSC^SRHLU(.HL,SRDISC,.SRHL) Q
"RTN","SRHLUI",52,0)
 Q:$$CHECK(IEN)'=1
"RTN","SRHLUI",53,0)
 I ID="ANESTHESIA" D
"RTN","SRHLUI",54,0)
 .I $P(MSG,HL("FS"),2)>1,'$D(^SRF(CASE,6,1,7,0)) S SRDISC="Invalid sequence this NTE segment, '"_MSG_"'." D SETDSC^SRHLU(.HL,SRDISC,.SRHL) Q
"RTN","SRHLUI",55,0)
 .S:$P(MSG,HL("FS"),2)=1 ^SRF(CASE,6,1,7,0)="^^0^0^"_DT_"^^^^" S ^SRF(CASE,6,1,7,$P(^SRF(CASE,6,1,7,0),U,3)+1,0)=$P(MSG,HL("FS"),4),$P(^(0),U,3)=$P(^SRF(CASE,6,1,7,0),U,3)+1,$P(^(0),U,4)=$P(^(0),U,4)+1,$P(^(0),U,5)=DT
"RTN","SRHLUI",56,0)
 Q
"RTN","SRHLUI",57,0)
OBX(MSG,OBR,CASE) ;process Observation Segment (OBX) fields 3,5,14,16 and NTE-3
"RTN","SRHLUI",58,0)
 N ID,IEN,NM,OBX,SRESQ,TYPE
"RTN","SRHLUI",59,0)
 S DA=CASE,OBX=MSG
"RTN","SRHLUI",60,0)
 S ID=$P($P(OBR,HL("FS"),5),HLCOMP,2) I $G(ID)="" S SRDISC="Unknown OBR identifier ("_$G(ID)_")." D SETDSC^SRHLU(.HL,SRDISC,.SRHL) Q
"RTN","SRHLUI",61,0)
 S IEN=$O(^SRO(133.2,"AC",ID,0)) I $G(IEN)="" S SRDISC="Unknown OBX identifier ("_$G(ID)_")." D SETDSC^SRHLU(.HL,SRDISC,.SRHL) Q
"RTN","SRHLUI",62,0)
 Q:$$CHECK(IEN)'=1
"RTN","SRHLUI",63,0)
 I $P(^SRO(133.2,IEN,0),U,3) S NM=$$VALUE(IEN) I NM="" S SRDISC="Unknown OBX identifier ("_$G(ID)_")." D SETDSC^SRHLU(.HL,SRDISC,.SRHL) Q
"RTN","SRHLUI",64,0)
 K DIE,DR,DO S DIE=$P(^SRO(133.2,IEN,0),U,2) I DIE="" S SRDISC="Unknown OBX identifier ("_$G(ID)_")." D SETDSC^SRHLU(.HL,SRDISC,.SRHL) Q
"RTN","SRHLUI",65,0)
 I $P(^SRO(133.2,IEN,0),U,3) S DR=$P(^(0),U,3)_"///^S X="_NM D:$D(^SRO(133.2,IEN,1,0))
"RTN","SRHLUI",66,0)
 .S SRX=0 F  S SRX=$O(^SRO(133.2,IEN,1,SRX)) Q:'SRX  S LVL=$P(^SRO(133.2,SRX,0),U,9) Q:"12"[$G(LVL)&($G(LVL)="")  I $$VALUE(SRX)'="" D DR(LVL,SRX)
"RTN","SRHLUI",67,0)
 ;set the msg variable to the segment type for the VALUE subroutine
"RTN","SRHLUI",68,0)
 I $P(MSG,HL("FS"))="OBX" S ID=$P($P(MSG,HL("FS"),4),HLCOMP,2) I $G(ID)="" S SRDISC="Unknown OBX identifier ("_$G(ID)_")." D SETDSC^SRHLU(.HL,SRDISC,.SRHL) Q
"RTN","SRHLUI",69,0)
 S IEN=$O(^SRO(133.2,"AC",ID,0)) I $G(IEN)="" S SRDISC="Unknown OBX identifier ("_$G(ID)_")." D SETDSC^SRHLU(.HL,SRDISC,.SRHL) Q
"RTN","SRHLUI",70,0)
 S NM=$$VALUE(IEN) I NM="" Q
"RTN","SRHLUI",71,0)
 ;if field is set to receive, then set DR string for DIE call
"RTN","SRHLUI",72,0)
 I $$CHECK(IEN)=1 S LVL=$P(^SRO(133.2,IEN,0),U,9) D DR(LVL,IEN) D:$D(^SRO(133.2,IEN,1,0))  N SRESQ D ^SROESHL Q:SRESQ  D ^DIE K DIE,DA,DR,DO
"RTN","SRHLUI",73,0)
 .S SRX=0 F  S SRX=$O(^SRO(133.2,IEN,1,SRX)) Q:'SRX  S LVL=$P(^SRO(133.2,SRX,0),U,9) Q:"12"[$G(LVL)&($G(LVL)="")  I $$VALUE(SRX)'="" D DR(LVL,SRX)
"RTN","SRHLUI",74,0)
 Q
"RTN","SRHLUI",75,0)
DRCHK ;CHECK DR STRING (for debugging only)
"RTN","SRHLUI",76,0)
 ;Check DR string by removing the Quit and adding TMP( global to the loop
"RTN","SRHLUI",77,0)
 Q
"RTN","SRHLUI",78,0)
 S SRCNT=+$G(SRCNT)+1 S SRJ="" F  S SRJ=$O(DR(SRJ)) Q:'SRJ  S SRK="" F  S SRK=$O(DR(SRJ,SRK)) Q:'SRK  S SRCNT=SRCNT+1
"RTN","SRHLUI",79,0)
 Q
"RTN","SRO1L1")
0^3^B14683246
"RTN","SRO1L1",1,0)
SRO1L1 ;BIR/ADM - Update 1-liner case, continued ; [ 02/19/04  12:47 PM ]
"RTN","SRO1L1",2,0)
 ;;3.0; Surgery ;**86,88,100**;24 Jun 93
"RTN","SRO1L1",3,0)
 I '$D(SRTN) W !!,"A Surgery Risk Assessment must be selected prior to using this option.",!!,"Press <RET> to continue  " R X:DTIME Q
"RTN","SRO1L1",4,0)
 S SRSOUT=0 D ^SROAUTL
"RTN","SRO1L1",5,0)
 N SRLCK S SRLCK=$$LOCK^SROUTL(SRTN) I 'SRLCK Q
"RTN","SRO1L1",6,0)
 D SRA^SROES
"RTN","SRO1L1",7,0)
EDIT S SRA=$G(^SRF(SRTN,"RA")) I $P(SRA,"^",2)="N",$P(SRA,"^",6)="N",$P(SRA,"^",7)'="" D ^SROAEX,END Q
"RTN","SRO1L1",8,0)
 S SRR=0 D TSTAT,HDR^SROAUTL D TECH^SROPRIN
"RTN","SRO1L1",9,0)
 S X=$P(^SRF(SRTN,"OP"),"^",2) I X S Y=$P($$CPT^ICPTCOD(X),"^",2) D SSPRIN^SROCPT S SRCPT=Y
"RTN","SRO1L1",10,0)
 S SRQ=0,SRDR=".011;.03;.04;.035;.165;1.09;1.13"
"RTN","SRO1L1",11,0)
 S SRAO(1)="In/Out-Patient Status^.011",SRAO(2)="Major or Minor^.03",SRAO(3)="Surgical Specialty^.04",SRAO(4)="Surgical Priority^.035",SRAO(5)="Attending Code^.165"
"RTN","SRO1L1",12,0)
 S SRAO(6)="ASA Class^1.13",SRAO(7)="Wound Classification^1.09",SRAO(8)="Anesthesia Technique^.37",SRAO(9)="Principal Operation (CPT)^27",SRAO(10)="Other Procedures^.42"
"RTN","SRO1L1",13,0)
 K DA,DIC,DIQ,DR,SRY S DIC="^SRF(",DA=SRTN,DIQ="SRY",DIQ(0)="E",DR=SRDR D EN^DIQ1 K DA,DIC,DIQ,DR
"RTN","SRO1L1",14,0)
 S SRY(130,SRTN,.37,"E")=SRTECH,SRY(130,SRTN,.42,"E")=$S($O(^SRF(SRTN,13,0)):"***INFORMATION ENTERED***",1:"***NONE ENTERED***"),SRY(130,SRTN,27,"E")=SRCPT
"RTN","SRO1L1",15,0)
 F I=1:1:10 W !,$J(I,2)_". "_$P(SRAO(I),"^")_":",?32,SRY(130,SRTN,$P(SRAO(I),"^",2),"E")
"RTN","SRO1L1",16,0)
 W !! F I=1:1:80 W "-"
"RTN","SRO1L1",17,0)
 S SRX=10 D SEL
"RTN","SRO1L1",18,0)
 K DA,DIK S DIK="^SRF(",DIK(1)=".232^AQ",DA=SRTN D EN1^DIK K DA,DIK
"RTN","SRO1L1",19,0)
 G:SRR=1 EDIT
"RTN","SRO1L1",20,0)
END D EXIT^SROES D:$G(SRLCK) UNLOCK^SROUTL(SRTN)
"RTN","SRO1L1",21,0)
 Q
"RTN","SRO1L1",22,0)
SEL W !!,"Select number of item to edit: " R X:DTIME I '$T!(X["^") S SRSOUT=1 Q
"RTN","SRO1L1",23,0)
 Q:X=""  S:X="a" X="A" I '$D(SRAO(X)),(X'?.N1":".N),(X'="A") D HELP S SRR=1 Q
"RTN","SRO1L1",24,0)
 I X?1.2N1":"1.2N S Y=$P(X,":"),Z=$P(X,":",2) I Y<1!(Z>SRX)!(Y>Z) D HELP S SRR=1 Q
"RTN","SRO1L1",25,0)
 I X="A" S X="1:"_SRX
"RTN","SRO1L1",26,0)
 I X?1.2N1":"1.2N D RANGE S SRR=1 Q
"RTN","SRO1L1",27,0)
 I $D(SRAO(X)) S EMILY=X W !! D ONE S SRR=1
"RTN","SRO1L1",28,0)
 Q
"RTN","SRO1L1",29,0)
HELP W @IOF,!!!!,"Enter the number or range of numbers you want to edit.  Examples of proper",!,"responses are listed below."
"RTN","SRO1L1",30,0)
 W !!,"1. Enter 'A' to update all items.",!!,"2. Enter a number (1-"_SRX_") to update an individual item.  (For example,",!,"   enter '1' to update "_$P(SRAO(1),"^")_")"
"RTN","SRO1L1",31,0)
 W !!,"3. Enter a range of numbers (1-"_SRX_") separated by a ':' to enter a range",!,"   of items.  (For example, enter '1:4' to update items 1, 2, 3 and 4.)",!
"RTN","SRO1L1",32,0)
PRESS W ! K DIR S DIR("A")="Press the return key to continue or '^' to exit: ",DIR(0)="FOA" D ^DIR K DIR I $D(DTOUT)!$D(DUOUT) S SRSOUT=1
"RTN","SRO1L1",33,0)
 Q
"RTN","SRO1L1",34,0)
RANGE ; range of numbers
"RTN","SRO1L1",35,0)
 S SHEMP=$P(X,":"),CURLEY=$P(X,":",2) F EMILY=SHEMP:1:CURLEY Q:SRSOUT  D ONE
"RTN","SRO1L1",36,0)
 Q
"RTN","SRO1L1",37,0)
ONE ; edit one item
"RTN","SRO1L1",38,0)
 I EMILY=8 D UPANES Q
"RTN","SRO1L1",39,0)
 I EMILY=10 D ^SROTHER Q
"RTN","SRO1L1",40,0)
 K DR,DIE S DA=SRTN,DR=$P(SRAO(EMILY),"^",2)_"T",DIE=130 D ^DIE K DR I $D(Y) S SRSOUT=1
"RTN","SRO1L1",41,0)
 I EMILY=9 D ^SROAUTL
"RTN","SRO1L1",42,0)
 Q
"RTN","SRO1L1",43,0)
UPANES K DR,DIE,DA S DA=SRTN,DR=.37,DR(2,130.06)=".01T;.05T;42T",DIE=130 D ^DIE K DR
"RTN","SRO1L1",44,0)
 Q
"RTN","SRO1L1",45,0)
TSTAT ; transmission status
"RTN","SRO1L1",46,0)
 N DA,SR905,SRDT,SRTD S SR905=$P($G(^SRF(SRTN,.4)),"^",2)
"RTN","SRO1L1",47,0)
 S SRHDR(.5)="Transmission Status: "_$S(SR905="T":"TRANSMITTED",SR905="R":"QUEUED TO TRANSMIT",1:"NOT QUEUED")
"RTN","SRO1L1",48,0)
 Q
"RTN","SROACAR")
0^4^B12022127
"RTN","SROACAR",1,0)
SROACAR ;BIR/MAM - OPEATIVE DATA ; [ 01/23/01  9:40 AM ]
"RTN","SROACAR",2,0)
 ;;3.0; Surgery ;**38,71,93,95,100**;24 Jun 93
"RTN","SROACAR",3,0)
 I '$D(SRTN) W !!,"A Surgery Risk Assessment must be selected prior to using this option.",!!,"Press <RET> to continue  " R X:DTIME G END
"RTN","SROACAR",4,0)
 S SRACLR=0,SRSOUT=0 D ^SROAUTL
"RTN","SROACAR",5,0)
START D:SRACLR RET G:SRSOUT END S SRACLR=0 K SRA,SRAO D ^SROACR1
"RTN","SROACAR",6,0)
ASK W !,"Select Operative Information to Edit: " R X:DTIME I '$T!("^"[X) G END
"RTN","SROACAR",7,0)
 S:X="a" X="A" I '$D(SRAO(X)),(X'?.N1":".N),(X'="A") D HELP G:SRSOUT END G START
"RTN","SROACAR",8,0)
 I X="A" S X="1:20"
"RTN","SROACAR",9,0)
 I X?.N1":".N S Y=$E(X),Z=$P(X,":",2) I Y<1!(Z>20)!(Y>Z) D HELP G:SRSOUT END G START
"RTN","SROACAR",10,0)
 D HDR^SROAUTL
"RTN","SROACAR",11,0)
 I X?.N1":".N D RANGE G START
"RTN","SROACAR",12,0)
 I $D(SRAO(X)),+X=X S EMILY=X D  G START
"RTN","SROACAR",13,0)
 .I $$LOCK^SROUTL(SRTN) W ! D ONE,UNLOCK^SROUTL(SRTN)
"RTN","SROACAR",14,0)
 I $D(SRAO(X)) W ! S EMILY=X D  G START
"RTN","SROACAR",15,0)
 .I $$LOCK^SROUTL(SRTN) D ONE,UNLOCK^SROUTL(SRTN)
"RTN","SROACAR",16,0)
END W @IOF D ^SRSKILL
"RTN","SROACAR",17,0)
 Q
"RTN","SROACAR",18,0)
HELP W @IOF,!!!!,"Enter the number or range of numbers you want to edit.  Examples of proper",!,"responses are listed below."
"RTN","SROACAR",19,0)
 W !!,"1. Enter 'A' to update all information.",!!,"2. Enter a number (1-20) to update the information in that field.  (For",!,"   example, enter '9' to update Valve Repair.)"
"RTN","SROACAR",20,0)
 W !!,"3. Enter a range of numbers (1-20) separated by a ':' to enter a range of",!,"   information.  (For example, enter '6:8' to enter Aortic Valve",!,"   Replacement, Mitral Valve Replacement, and Tricuspid Valve Replacement.)"
"RTN","SROACAR",21,0)
 W !!,"4. Enter a number/letter combination to update any miscellaneous cardiac",!,"   procedures requiring CPB.  (For example, enter '16A' to update ASD",!,"   Repair.)"
"RTN","SROACAR",22,0)
 D RET
"RTN","SROACAR",23,0)
 Q
"RTN","SROACAR",24,0)
RANGE ; range of numbers
"RTN","SROACAR",25,0)
 I $$LOCK^SROUTL(SRTN) D  D UNLOCK^SROUTL(SRTN)
"RTN","SROACAR",26,0)
 .W ! S SHEMP=$P(X,":"),CURLEY=$P(X,":",2) F EMILY=SHEMP:1:CURLEY Q:SRSOUT  D ONE
"RTN","SROACAR",27,0)
 Q
"RTN","SROACAR",28,0)
ONE ; edit one item
"RTN","SROACAR",29,0)
 I EMILY=16 D MISC^SROACR1 Q
"RTN","SROACAR",30,0)
 K DR,DIE S DA=SRTN,DR=$P(SRAO(EMILY),"^",2)_"T",DIE=130 D ^DIE K DR I $D(Y) S SRSOUT=1
"RTN","SROACAR",31,0)
 I 'SRSOUT,EMILY=12!(EMILY=13) D OK
"RTN","SROACAR",32,0)
 I EMILY="16H" D
"RTN","SROACAR",33,0)
 .I $P($G(^SRF(SRTN,207)),"^",19)="Y" S DIE=130,DA=SRTN,DR="383.1T" D ^DIE K DR Q
"RTN","SROACAR",34,0)
 .K ^SRF(SRTN,207.1)
"RTN","SROACAR",35,0)
 Q
"RTN","SROACAR",36,0)
OK N SRISCH,SRCPB S X=$G(^SRF(SRTN,206)),SRISCH=$P(X,"^",36),SRCPB=$P(X,"^",37)
"RTN","SROACAR",37,0)
 I SRISCH,SRCPB,SRISCH>SRCPB W !!,"  ***  NOTE: Ischemic Time is greater than CPB Time!!  Please check.  ***",! D RET W !
"RTN","SROACAR",38,0)
 Q
"RTN","SROACAR",39,0)
RET Q:SRSOUT  W ! K DIR S DIR(0)="E" D ^DIR K DIR I $D(DTOUT)!$D(DUOUT) S SRSOUT=1
"RTN","SROACAR",40,0)
 Q
"RTN","SROACAT")
0^5^B8725623
"RTN","SROACAT",1,0)
SROACAT ;B'HAM ISC/MAM - CARDIAC CATH INFO ; [ 01/23/01  12:39 PM ]
"RTN","SROACAT",2,0)
 ;;3.0; Surgery ;**38,47,100**;24 Jun 93
"RTN","SROACAT",3,0)
 I '$D(SRTN) W !!,"A Surgery Risk Assessment must be selected prior to using this option.",!!,"Press <RET> to continue  " R X:DTIME G END
"RTN","SROACAT",4,0)
 S SRACLR=0,SRSOUT=0 D ^SROAUTL
"RTN","SROACAT",5,0)
START D:SRACLR RET G:SRSOUT END S SRACLR=0 D ^SROACTH
"RTN","SROACAT",6,0)
ASK W !!,"Select Cardiac Catheterization and Angiographic Information to Edit: " R X:DTIME I '$T!("^"[X) G END
"RTN","SROACAT",7,0)
 S:X="a" X="A" I '$D(SRAO(X)),(X'?.N1":".N),(X'="A") D HELP G:SRSOUT END G START
"RTN","SROACAT",8,0)
 I X="A" S X="1:10"
"RTN","SROACAT",9,0)
 I X?.N1":".N S Y=$E(X),Z=$P(X,":",2) I Y<1!(Z>10)!(Y>Z) D HELP G:SRSOUT END G START
"RTN","SROACAT",10,0)
 D HDR^SROAUTL
"RTN","SROACAT",11,0)
 I X?.N1":".N D RANGE G START
"RTN","SROACAT",12,0)
 I $D(SRAO(X)) S EMILY=X D  G START
"RTN","SROACAT",13,0)
 .I $$LOCK^SROUTL(SRTN) W !! D ONE,UNLOCK^SROUTL(SRTN)
"RTN","SROACAT",14,0)
END I '$D(SREQST) W @IOF D ^SRSKILL
"RTN","SROACAT",15,0)
 Q
"RTN","SROACAT",16,0)
HELP W @IOF,!!!!,"Enter the number or range of numbers you want to edit.  Examples of proper",!,"responses are listed below."
"RTN","SROACAT",17,0)
 W !!,"1. Enter 'A' to update all information.",!!,"2. Enter a number (1-10) to update the information in that field.  (For",!,"   example, enter '3' to update *PA Systolic Pressure)"
"RTN","SROACAT",18,0)
 W !!,"3. Enter a range of numbers (1-10) separated by a ':' to enter a range of",!,"   information.  (For example, enter '1:3' to update LVEDP, Aortic",!,"   Systolic Pressure, and *PA Systolic Pressure)"
"RTN","SROACAT",19,0)
 W !!,"Press <RET> to continue, or '^' to quit  " R X:DTIME I '$T!(X["^") S SRSOUT=1
"RTN","SROACAT",20,0)
 Q
"RTN","SROACAT",21,0)
RANGE ; range of numbers
"RTN","SROACAT",22,0)
 I $$LOCK^SROUTL(SRTN) D  D UNLOCK^SROUTL(SRTN)
"RTN","SROACAT",23,0)
 .W !! S SHEMP=$P(X,":"),CURLEY=$P(X,":",2) F EMILY=SHEMP:1:CURLEY Q:SRSOUT  D ONE
"RTN","SROACAT",24,0)
 Q
"RTN","SROACAT",25,0)
ONE ; edit one item
"RTN","SROACAT",26,0)
 K DR,DIE S DA=SRTN,DR=$P(SRAO(EMILY),"^",2)_"T",DIE=130 D ^DIE K DR I $D(Y)!$D(DTOUT) S SRSOUT=1
"RTN","SROACAT",27,0)
 Q
"RTN","SROACAT",28,0)
RET Q:SRSOUT  W !!,"Press <RET> to continue, or '^' to quit  " R X:DTIME I '$T!(X["^") S SRSOUT=1 Q
"RTN","SROACAT",29,0)
 Q
"RTN","SROACLN")
0^6^B8983747
"RTN","SROACLN",1,0)
SROACLN ;B'HAM ISC/MAM - CLINICAL DATA ; [ 01/23/01  12:46 PM ]
"RTN","SROACLN",2,0)
 ;;3.0; Surgery ;**38,47,71,95,100**;24 Jun 93
"RTN","SROACLN",3,0)
 I '$D(SRTN) W !!,"A Surgery Risk Assessment must be selected prior to using this option.",!!,"Press <RET> to continue  " R X:DTIME G END
"RTN","SROACLN",4,0)
 S SRACLR=0,SRSOUT=0 D ^SROAUTL
"RTN","SROACLN",5,0)
START D:SRACLR RET G:SRSOUT END S SRACLR=0 K SRA,SRAO D ^SROACL1
"RTN","SROACLN",6,0)
ASK W !!,"Select Clinical Information to Edit: " R X:DTIME I '$T!("^"[X) G END
"RTN","SROACLN",7,0)
 S:X="a" X="A" I '$D(SRAO(X)),(X'?.N1":".N),(X'="A") D HELP G:SRSOUT END G START
"RTN","SROACLN",8,0)
 I X="A" S X="1:26"
"RTN","SROACLN",9,0)
 I X?.N1":".N S Y=$E(X),Z=$P(X,":",2) I Y<1!(Z>26)!(Y>Z) D HELP G:SRSOUT END G START
"RTN","SROACLN",10,0)
 D HDR^SROAUTL
"RTN","SROACLN",11,0)
 I X?.N1":".N D RANGE G START
"RTN","SROACLN",12,0)
 I $D(SRAO(X)) S EMILY=X D  G START
"RTN","SROACLN",13,0)
 .I $$LOCK^SROUTL(SRTN) W !! D ONE,UNLOCK^SROUTL(SRTN)
"RTN","SROACLN",14,0)
END I '$D(SREQST) W @IOF D ^SRSKILL
"RTN","SROACLN",15,0)
 Q
"RTN","SROACLN",16,0)
HELP W @IOF,!!!!,"Enter the number or range of numbers you want to edit.  Examples of proper",!,"responses are listed below."
"RTN","SROACLN",17,0)
 W !!,"1. Enter 'A' to update all information.",!!,"2. Enter a specific number to update the information in that field.  (For",!,"   example, enter '8' to update Current Smoker)"
"RTN","SROACLN",18,0)
 W !!,"3. Enter a range of numbers separated by a ':' to enter a range of",!,"   information.  (For example, enter '7:9' to enter Pulmonary Rales,",!,"   Current Smoker, and Serum Creatinine)"
"RTN","SROACLN",19,0)
 W !!,"Press <RET> to continue, or '^' to quit  " R X:DTIME I '$T!(X["^") S SRSOUT=1
"RTN","SROACLN",20,0)
 Q
"RTN","SROACLN",21,0)
RANGE ; range of numbers
"RTN","SROACLN",22,0)
 I $$LOCK^SROUTL(SRTN) D  D UNLOCK^SROUTL(SRTN)
"RTN","SROACLN",23,0)
 .W !! S SHEMP=$P(X,":"),CURLEY=$P(X,":",2) F EMILY=SHEMP:1:CURLEY Q:SRSOUT  D ONE
"RTN","SROACLN",24,0)
 Q
"RTN","SROACLN",25,0)
ONE ; edit one item
"RTN","SROACLN",26,0)
 K DR,DIE S DA=SRTN,DR=$P(SRAO(EMILY),"^",2)_"T",DR=$S(EMILY=9:DR_";"_290_"T",EMILY=10:DR_";"_239_"T",EMILY=11:DR_";"_292_"T",1:DR),DIE=130 D ^DIE K DR I $D(Y) S SRSOUT=1
"RTN","SROACLN",27,0)
 Q
"RTN","SROACLN",28,0)
RET Q:SRSOUT  W !!,"Press <RET> to continue, or '^' to quit  " R X:DTIME I '$T!(X["^") S SRSOUT=1 Q
"RTN","SROACLN",29,0)
 Q
"RTN","SROACOM")
0^129^B17302130
"RTN","SROACOM",1,0)
SROACOM ;BIR/MAM - COMPLETE ASSESSMENT ; [ 05/08/01  1:36 PM ]
"RTN","SROACOM",2,0)
 ;;3.0; Surgery ;**38,55,63,65,88,93,95,102,100**;24 Jun 93
"RTN","SROACOM",3,0)
 I '$D(SRTN) Q
"RTN","SROACOM",4,0)
 S (SRSFLG,SRSOUT,SROVER)=0,SRA=$G(^SRF(SRTN,"RA")),Y=$P(SRA,"^") I Y'="I" W !!,"This assessment has a "_$S(Y="C":"'COMPLETE'",1:"'TRANSMITTED'")_" status.",!!,"No action taken." G END
"RTN","SROACOM",5,0)
 I $P(SRA,"^",2)="N",$P(SRA,"^",6)="Y" D CHK^SROAUTL
"RTN","SROACOM",6,0)
 I $P(SRA,"^",2)="N",$P(SRA,"^",6)="N" D CHK^SROAUTL3
"RTN","SROACOM",7,0)
 I $P(SRA,"^",2)="C" D CHK^SROAUTLC
"RTN","SROACOM",8,0)
 S SRFLD="" I $O(SRX(SRFLD))'="" D LIST
"RTN","SROACOM",9,0)
 I $P(SRA,"^",2)="C" D CHCK G:SRSOUT END
"RTN","SROACOM",10,0)
YEP W ! S SRFLD="" K DIR S DIR("A")="Are you sure you want to complete this assessment ? ",DIR("B")=$S($O(SRX(SRFLD)):"NO",1:"YES"),DIR(0)="YA"
"RTN","SROACOM",11,0)
 S DIR("?",1)="Enter YES to complete this assessment, or enter NO to leave the status",DIR("?")="unchanged." D ^DIR K DIR I $D(DTOUT)!$D(DUOUT) S SRSOUT=1 G END
"RTN","SROACOM",12,0)
 I 'Y W !!,"No action taken." G END
"RTN","SROACOM",13,0)
 I $$LOCK^SROUTL(SRTN) D COMPLT,UNLOCK^SROUTL(SRTN) Q
"RTN","SROACOM",14,0)
 E  W !!,"No action taken." G END
"RTN","SROACOM",15,0)
 Q
"RTN","SROACOM",16,0)
COMPLT W !!,"Updating the current status to 'COMPLETE'..." K DR,DIE S DA=SRTN,DIE=130,DR="235///C" D ^DIE K STATUS
"RTN","SROACOM",17,0)
 I $P(SRA,"^",5)="" K DR,DIE S DA=SRTN,DIE=130,DR="272///"_DT D ^DIE K STATUS
"RTN","SROACOM",18,0)
 I $P(SRA,"^",2)="C" K DA,DIE,DIK,DR S DIK="^SRF(",DIK(1)=".232^AQ",DA=SRTN D EN1^DIK K DA,DIK D ^SROCL1
"RTN","SROACOM",19,0)
PRINT W !!,"Do you want to print the completed assessment ?  YES//  " R SRYN:DTIME I '$T!(SRYN["^") S SRSOUT=1 Q
"RTN","SROACOM",20,0)
 S SRYN=$E(SRYN) S:SRYN="" SRYN="Y" I "Nn"[SRYN S SRSOUT=1 Q
"RTN","SROACOM",21,0)
 I "Yy"'[SRYN W !!,"Enter <RET> to print the completed assessment, or 'NO' to return to the menu." G PRINT
"RTN","SROACOM",22,0)
 W ! K %ZIS,IO("Q"),POP S %ZIS("A")="Print the Completed Assessment on which Device: ",%ZIS="Q" D ^%ZIS I POP S SRSOUT=1 Q
"RTN","SROACOM",23,0)
 I $D(IO("Q")) K IO("Q") S ZTDESC="Completed Surgery Risk Assessment",(ZTSAVE("SRSITE*"),ZTSAVE("SRTN"))="",ZTRTN="EN^SROACOM" D ^%ZTLOAD S SRSOUT=1 G END
"RTN","SROACOM",24,0)
EN U IO D ^SROAPAS Q
"RTN","SROACOM",25,0)
END I 'SRSOUT,$E(IOST)'="P" D RET
"RTN","SROACOM",26,0)
 W @IOF I $E(IOST)="P" D ^%ZISC W @IOF
"RTN","SROACOM",27,0)
 D ^SRSKILL K SRSFLG
"RTN","SROACOM",28,0)
 Q
"RTN","SROACOM",29,0)
LIST W @IOF,!,"This assessment is missing the following items:",! S SRZ="",SRCNT=1
"RTN","SROACOM",30,0)
 F  S SRZ=$O(SRX(SRZ)) Q:SRZ=""  D:$Y+5>IOSL RET Q:SRSOUT  W !,?5,$J(SRCNT,2)_". "_SRX(SRZ) S SRCNT=SRCNT+1
"RTN","SROACOM",31,0)
 S SRSOUT=0 W ! K DIR S DIR(0)="Y",DIR("A")="Do you want to enter the missing items at this time",DIR("B")="NO" D ^DIR I $D(DTOUT)!$D(DUOUT) S SRSOUT=1 Q
"RTN","SROACOM",32,0)
 Q:'Y  I $$LOCK^SROUTL(SRTN) D PRT,UNLOCK^SROUTL(SRTN)
"RTN","SROACOM",33,0)
 Q
"RTN","SROACOM",34,0)
PRT S SRSOUT=0,SRMD="",SRCNT=0 F  S SRMD=$O(SRX(SRMD)) Q:SRMD=""  D  Q:$G(SRSFLG)
"RTN","SROACOM",35,0)
 .I $E(SRMD,1,10)="ANESTHESIA" K DR,DIE,DA S DA=SRTN,DR=.37,DR(2,130.06)=".01T;.05T;42T",DIE=130 D ^DIE S:$D(Y) SRSFLG=1 K DR Q
"RTN","SROACOM",36,0)
 .I $E(SRMD,1,6)="POSTOP" D POST^SROCMPS Q
"RTN","SROACOM",37,0)
 .I $E(SRMD,1,24)="OTHER PROCEDURE CPT CODE" D ^SROTHER Q
"RTN","SROACOM",38,0)
 .K DR,DIE S DA=SRTN,DIE=130,DR=SRMD D ^DIE K DR I $D(Y) S SRSFLG=1
"RTN","SROACOM",39,0)
 S:'$G(SRSOUT) SRSOUT=0
"RTN","SROACOM",40,0)
 Q
"RTN","SROACOM",41,0)
CHCK ; cardiac checks added by SR*3*93
"RTN","SROACOM",42,0)
 N SRADM,SRDIS,SRISCH,SRCPB,SRRET S SRRET=0,X=$G(^SRF(SRTN,208)),SRADM=$P(X,"^",14),SRDIS=$P(X,"^",15),X=$G(^SRF(SRTN,206)),SRISCH=$P(X,"^",36),SRCPB=$P(X,"^",37)
"RTN","SROACOM",43,0)
 I SRADM,SRDIS,SRADM'<SRDIS W !!,"  ***  NOTE: Discharge Date precedes Admission Date!!  Please check.  ***" S SRRET=1,SRX(418)=""
"RTN","SROACOM",44,0)
 I SRISCH,SRCPB,SRISCH>SRCPB W !!,"  ***  NOTE: Ischemic Time is greater than CPB Time!!  Please check.  ***",! S SRRET=1,SRX(450)=""
"RTN","SROACOM",45,0)
 I SRRET W ! K DIR S DIR(0)="E" D ^DIR K DIR S:$D(DTOUT)!$D(DUOUT) SRSOUT=1 W !
"RTN","SROACOM",46,0)
 Q
"RTN","SROACOM",47,0)
RET W !! K DIR S DIR(0)="E" D ^DIR K DIR W @IOF I $D(DTOUT)!$D(DUOUT) S SRSOUT=1
"RTN","SROACOM",48,0)
 Q
"RTN","SROACOM",49,0)
PAGE I $E(IOST)'="P" D RET Q
"RTN","SROACOM",50,0)
 W @IOF,!!!
"RTN","SROACOM",51,0)
 Q
"RTN","SROACOP")
0^8^B22746926
"RTN","SROACOP",1,0)
SROACOP ;BIR/MAM - CARDIAC OPERATIVE RISK SUMMARY ; [ 01/23/01  1:31 PM ]
"RTN","SROACOP",2,0)
 ;;3.0; Surgery ;**38,47,71,88,95,107,100**;24 Jun 93
"RTN","SROACOP",3,0)
 I '$D(SRTN) W !!,"A Surgery Risk Assessment must be selected prior to using this option.",!!,"Press <RET> to continue  " R X:DTIME G END
"RTN","SROACOP",4,0)
 S SRACLR=0,SRSOUT=0 D ^SROAUTL
"RTN","SROACOP",5,0)
START D:SRACLR RET G:SRSOUT END S SRACLR=0 K SRA,SRAO
"RTN","SROACOP",6,0)
 F I=206,206.1,208 S SRA(I)=$G(^SRF(SRTN,I))
"RTN","SROACOP",7,0)
 I $P(SRA(206),"^",41)="" K DA,DIE,DR S DA=SRTN,DIE=130,DR="472////N" D ^DIE K DA,DIE,DR S SRA(206)=$G(^SRF(SRTN,206))
"RTN","SROACOP",8,0)
 S Y=$P($G(^SRF(SRTN,1.1)),"^",3),C=$P(^DD(130,1.13,0),"^",2) D:Y'="" Y^DIQ S SRAO(2)=Y_"^1.13"
"RTN","SROACOP",9,0)
 S SRAO(1)=$P(SRA(206),"^",31)_"^364",SRAO(3)=$P(SRA(208),"^",12)_"^414"
"RTN","SROACOP",10,0)
 S Y=$P(SRA(206),"^",32) D DT S SRAO("1A")=X_"^364.1"
"RTN","SROACOP",11,0)
 S X=$P(SRA(208),"^"),SRAO(4)=$S(X="Y":"YES",X="N":"NO",1:"")_"^384"
"RTN","SROACOP",12,0)
 S Y=$P(SRAO(3),"^") I Y'="" S C=$P(^DD(130,414,0),"^",2) D Y^DIQ S $P(SRAO(3),"^")=Y
"RTN","SROACOP",13,0)
 S Y=$P(SRA(208),"^",13) D DT S SRAO("3A")=X_"^414.1"
"RTN","SROACOP",14,0)
 S Y=$P($G(^SRF(SRTN,.2)),"^",2) D DT S SRAO(5)=X_"^.22"
"RTN","SROACOP",15,0)
 S Y=$P($G(^SRF(SRTN,.2)),"^",3) D DT S SRAO(6)=X_"^.23"
"RTN","SROACOP",16,0)
 S SRAO(8)="",SRAO(9)=SRA(206.1)_"^430"
"RTN","SROACOP",17,0)
 S NYUK=$P(SRA(206),"^",41) D YN S SRAO(10)=SHEMP_"^472"
"RTN","SROACOP",18,0)
 S SRPAGE="PAGE: 1" D HDR^SROAUTL
"RTN","SROACOP",19,0)
 S X=$P(SRAO(1),"^"),X=$S(X?1.3N:X_"%",1:X) W !," 1. Physician's Preoperative Estimate of Operative Mortality: "_X
"RTN","SROACOP",20,0)
 S X=$P(SRAO("1A"),"^") I X'="" W !,?3," A. Date/Time Collected:    "_X
"RTN","SROACOP",21,0)
 W !," 2. ASA Classification:",?31,$P(SRAO(2),"^"),!," 3. Surgical Priority:",?31,$P(SRAO(3),"^")
"RTN","SROACOP",22,0)
 S X=$P(SRAO("3A"),"^") I X'="" W !,?3," A. Date/Time Collected:    "_X
"RTN","SROACOP",23,0)
 S X=$P(^SRF(SRTN,"OP"),"^",2) I X S Y=$P($$CPT^ICPTCOD(X),"^",2) D SSPRIN^SROCPT S X=Y
"RTN","SROACOP",24,0)
 S SRAO(7)=X_"^27"
"RTN","SROACOP",25,0)
 W !," 4. Operative Death:",?31,$P(SRAO(4),"^"),!," 5. Date/Time Operation Began:",?31,$P(SRAO(5),"^"),!," 6. Date/Time Operation Ended:",?31,$P(SRAO(6),"^")
"RTN","SROACOP",26,0)
 W !," 7. Principal CPT Code: ",?31,$P(SRAO(7),"^"),!," 8. Other Procedures CPT Code:" W:$O(^SRF(SRTN,13,0)) ?31,"***INFORMATION ENTERED***"
"RTN","SROACOP",27,0)
 W !," 9. Preoperative Risk Factors: "
"RTN","SROACOP",28,0)
 I $P(SRAO(9),"^")'="" S SRQ=0 S X=$P(SRAO(9),"^") W:$L(X)<49 X,! I $L(X)>48 S Z=$L(X) D
"RTN","SROACOP",29,0)
 .I X'[" " W ?25,X Q
"RTN","SROACOP",30,0)
 .S I=0,LINE=1 F  S SRL=$S(LINE=1:48,1:80) D  Q:SRQ
"RTN","SROACOP",31,0)
 ..I $E(X,1,SRL)'[" " W X,! S SRQ=1 Q
"RTN","SROACOP",32,0)
 ..S J=SRL-I,Y=$E(X,J),I=I+1 I Y=" " W $E(X,1,J-1),! S X=$E(X,J+1,Z),Z=$L(X),I=0,LINE=LINE+1 I Z<SRL W X S SRQ=1 Q
"RTN","SROACOP",33,0)
 W !,"10. Cardiac Surgery to Non-VA Facility: ",?40,$P(SRAO(10),"^")
"RTN","SROACOP",34,0)
 W !! F MOE=1:1:80 W "-"
"RTN","SROACOP",35,0)
ASK W !,"Select Operative Risk Summary Information to Edit: " R X:DTIME I '$T!("^"[X) G END
"RTN","SROACOP",36,0)
 S:X="a" X="A" I '$D(SRAO(X)),(X'?.N1":".N),(X'="A") D HELP G:SRSOUT END G START
"RTN","SROACOP",37,0)
 I X="A" S X="1:10"
"RTN","SROACOP",38,0)
 I X?.N1":".N S Y=$E(X),Z=$P(X,":",2) I Y<1!(Z>10)!(Y>Z) D HELP G:SRSOUT END G START
"RTN","SROACOP",39,0)
 I X'=8 D HDR^SROAUTL
"RTN","SROACOP",40,0)
 I X?.N1":".N D RANGE S SROERR=SRTN D ^SROERR0 G START
"RTN","SROACOP",41,0)
 I $D(SRAO(X))!(X=9) S EMILY=X D  S SROERR=SRTN D ^SROERR0 G START
"RTN","SROACOP",42,0)
 .I $$LOCK^SROUTL(SRTN) W !! D ONE,UNLOCK^SROUTL(SRTN)
"RTN","SROACOP",43,0)
END I '$D(SREQST) W @IOF D ^SRSKILL
"RTN","SROACOP",44,0)
 Q
"RTN","SROACOP",45,0)
DT I 'Y S X="" Q
"RTN","SROACOP",46,0)
 X ^DD("DD") S X=$P(Y,"@")_" "_$P(Y,"@",2)
"RTN","SROACOP",47,0)
 Q
"RTN","SROACOP",48,0)
HELP W @IOF,!!!!,"Enter the number or range of numbers you want to edit.  Examples of proper",!,"responses are listed below."
"RTN","SROACOP",49,0)
 W !!,"1. Enter 'A' to update all information.",!!,"2. Enter the corresponding number to update the information in a particular",!,"   field.  (For example, enter '3' to update Surgical Priority)"
"RTN","SROACOP",50,0)
 W !!,"3. Enter two numbers separated by a ':' to enter a range of information.",!,"   (For example, enter '1:2' to update Physician's Preoperative Estimate of",!,"   Mortality and ASA Classification.)"
"RTN","SROACOP",51,0)
 W !!,"Press <RET> to continue, or '^' to quit  " R X:DTIME I '$T!(X["^") S SRSOUT=1
"RTN","SROACOP",52,0)
 Q
"RTN","SROACOP",53,0)
RANGE ; range of numbers
"RTN","SROACOP",54,0)
 I $$LOCK^SROUTL(SRTN) D  D UNLOCK^SROUTL(SRTN)
"RTN","SROACOP",55,0)
 .W !! S SHEMP=$P(X,":"),CURLEY=$P(X,":",2) F EMILY=SHEMP:1:CURLEY Q:SRSOUT  D ONE
"RTN","SROACOP",56,0)
 Q
"RTN","SROACOP",57,0)
ONE ; edit one item
"RTN","SROACOP",58,0)
 I EMILY=8 D ^SROTHER Q
"RTN","SROACOP",59,0)
 K DR,DIE S DA=SRTN,DIE=130,DR=$P(SRAO(EMILY),"^",2)
"RTN","SROACOP",60,0)
 I EMILY=10!(EMILY=11) S DR=DR_"T//^S X=""N""" D ^DIE K DR S:$D(Y) SRSOUT=1 Q
"RTN","SROACOP",61,0)
 S DR=DR_"T",DIE=130 S DR=DR_$S(EMILY=1:";364.1T",EMILY=3:";414.1T",1:"") D ^DIE K DR I $D(Y) S SRSOUT=1
"RTN","SROACOP",62,0)
 I EMILY=7 D ^SROAUTL
"RTN","SROACOP",63,0)
 Q
"RTN","SROACOP",64,0)
RET Q:SRSOUT  W !!,"Press <RET> to continue, or '^' to quit  " R X:DTIME I '$T!(X["^") S SRSOUT=1 Q
"RTN","SROACOP",65,0)
 Q
"RTN","SROACOP",66,0)
NOW ; update date/time of estimate of mortality
"RTN","SROACOP",67,0)
 N X D NOW^%DTC S $P(^SRF(DA,206),"^",32)=$E(%,1,12)
"RTN","SROACOP",68,0)
 Q
"RTN","SROACOP",69,0)
KNOW ; delete date/time of estimate of mortality
"RTN","SROACOP",70,0)
 S $P(^SRF(DA,206),"^",32)=""
"RTN","SROACOP",71,0)
 Q
"RTN","SROACOP",72,0)
YN ; store answer
"RTN","SROACOP",73,0)
 S SHEMP=$S(NYUK="NS":"Unknown",NYUK="N":"NO",NYUK="Y":"YES",1:"")
"RTN","SROACOP",74,0)
 Q
"RTN","SROACPM")
0^9^B39419828
"RTN","SROACPM",1,0)
SROACPM ;BIR/ADM - CARDIAC PATIENT DEMOGRAPHIC INFO ; [ 01/23/01  1:40 PM ]
"RTN","SROACPM",2,0)
 ;;3.0; Surgery ;**71,93,95,99,100**;24 Jun 93
"RTN","SROACPM",3,0)
 ;
"RTN","SROACPM",4,0)
 ; Reference to ^DGPM("APTT1" supported by DBIA #565
"RTN","SROACPM",5,0)
 ;
"RTN","SROACPM",6,0)
 I '$D(SRTN) W !!,"A Surgery Risk Assessment must be selected prior to using this option.",!!,"Press <RET> to continue  " R X:DTIME G END
"RTN","SROACPM",7,0)
 S SRSOUT=0 D ^SROAUTL
"RTN","SROACPM",8,0)
START G:SRSOUT END D HDR^SROAUTL
"RTN","SROACPM",9,0)
 S DIR("A",1)="Enter/Edit Patient Resource Data",DIR("A",2)=" ",DIR("A",3)="1. Capture Information from PIMS Records",DIR("A",4)="2. Enter, Edit, or Review Information",DIR("A",5)=" "
"RTN","SROACPM",10,0)
 S DIR("?",1)="Enter '1' if you want to capture patient information from PIMS",DIR("?",2)="records.  Enter '2' if you want to enter, edit, or review patient",DIR("?")="other information on this screen."
"RTN","SROACPM",11,0)
 S DIR("A")="Select Number",DIR(0)="NO^1:2" D ^DIR K DIR I $D(DTOUT)!$D(DUOUT)!'Y S SRSOUT=1 G END
"RTN","SROACPM",12,0)
 I Y=1 D PIMS G START
"RTN","SROACPM",13,0)
EDIT S SRR=0 D HDR^SROAUTL K DR S SRQ=0,(DR,SRDR)="418;419;440;.205;.232;470;471;442;431"
"RTN","SROACPM",14,0)
 K DA,DIC,DIQ,SRY S DIC="^SRF(",DA=SRTN,DIQ="SRY",DIQ(0)="IE",DR=SRDR D EN^DIQ1 K DA,DIC,DIQ,DR
"RTN","SROACPM",15,0)
 K SRX S SRX=0 F M=1:1 S I=$P(SRDR,";",M)  Q:'I  D
"RTN","SROACPM",16,0)
 .D TR,GET
"RTN","SROACPM",17,0)
 .S SRX=SRX+1,Y=$P(X,";;",2),SRFLD=$P(Y,"^"),(Z,SRX(SRX))=$P(Y,"^",2)_"^"_SRFLD,SREXT=SRY(130,SRTN,SRFLD,"E")
"RTN","SROACPM",18,0)
 .W !,SRX_". "_$P(Z,"^")_":" D EXT
"RTN","SROACPM",19,0)
 D CHCK W !! F K=1:1:80 W "-"
"RTN","SROACPM",20,0)
 D SEL G:SRR=1 EDIT
"RTN","SROACPM",21,0)
 G START
"RTN","SROACPM",22,0)
 Q
"RTN","SROACPM",23,0)
CHCK ; compare admission and discharge dates to each other
"RTN","SROACPM",24,0)
 N SRADM,SRDIS S SRADM=SRY(130,SRTN,418,"I"),SRDIS=SRY(130,SRTN,419,"I")
"RTN","SROACPM",25,0)
 I SRADM'="",SRDIS'="",SRADM'<SRDIS W !!,"  ***  NOTE: Discharge Date precedes Admission Date!!  Please check.  ***"
"RTN","SROACPM",26,0)
 Q
"RTN","SROACPM",27,0)
EXT I SRFLD=440&(SREXT="NS") S SREXT=SREXT_"-"_$S(SREXT="NS":"No Study",1:SREXT)
"RTN","SROACPM",28,0)
 I SRFLD=470,(SREXT="NS"!(SREXT="RI")) S SREXT=SREXT_"-"_$S(SREXT="NS":"Unable to determine",SREXT="RI":"Remains intubated at 30 days",1:SREXT)
"RTN","SROACPM",29,0)
 I SRFLD=471,(SREXT="NS"!(SREXT="RI")) S SREXT=SREXT_"-"_$S(SREXT="NS":"Unable to determine",SREXT="RI":"Remains in ICU at 30 days",1:SREXT)
"RTN","SROACPM",30,0)
 I $L(SREXT)<41 W ?39,SREXT W:SRFLD=247 $S(SREXT="":"",SREXT=1:" Day",SREXT=0:" Days",SREXT>1:" Days",1:"") Q
"RTN","SROACPM",31,0)
 N I,J,X,Y S X=SREXT F  D  W:$L(X) ! I $L(X)<41!(X'[" ") W ?39,X Q
"RTN","SROACPM",32,0)
 .F I=0:1:39 S J=40-I,Y=$E(X,J) I Y=" " W ?39,$E(X,1,J-1) S X=$E(X,J+1,$L(X)) Q
"RTN","SROACPM",33,0)
 Q
"RTN","SROACPM",34,0)
SEL S SRSOUT=0 W !!,"Select number of item to edit: " R X:DTIME I '$T!(X["^") S SRSOUT=1 Q
"RTN","SROACPM",35,0)
 Q:X=""  S:X="a" X="A" I '$D(SRFLG),'$D(SRX(X)),(X'?1.2N1":"1.2N),X'="A" D HELP S SRR=1 Q
"RTN","SROACPM",36,0)
 I X?1.2N1":"1.2N S Y=$P(X,":"),Z=$P(X,":",2) I Y<1!(Z>SRX)!(Y>Z) D HELP S SRR=1 Q
"RTN","SROACPM",37,0)
 I X="A" S X="1:"_SRX
"RTN","SROACPM",38,0)
 I X?1.2N1":"1.2N D RANGE S SRR=1 Q
"RTN","SROACPM",39,0)
 I $D(SRX(X)),+X=X S EMILY=X D  S SRR=1
"RTN","SROACPM",40,0)
 .I $$LOCK^SROUTL(SRTN) D ONE,UNLOCK^SROUTL(SRTN)
"RTN","SROACPM",41,0)
 Q
"RTN","SROACPM",42,0)
PIMS ; get update from PIMS records
"RTN","SROACPM",43,0)
 W ! K DIR S DIR("A")="Are you sure you want to retrieve information from PIMS records ? ",DIR("B")="YES",DIR(0)="YOA" D ^DIR K DIR I $D(DTOUT)!$D(DUOUT)!'Y Q
"RTN","SROACPM",44,0)
 W ! D WAIT^DICD D ^SROAPIMS
"RTN","SROACPM",45,0)
 Q
"RTN","SROACPM",46,0)
HELP W @IOF,!!!!,"Enter the number or range of numbers you want to edit.  Examples of proper",!,"responses are listed below."
"RTN","SROACPM",47,0)
 W !!,"1. Enter 'A' to update all items.",!!,"2. Enter a number (1-"_SRX_") to update an individual item.  (For example,",!,"   enter '1' to update "_$P(SRX(1),"^")_".)"
"RTN","SROACPM",48,0)
 W !!,"3. Enter a range of numbers (1-"_SRX_") separated by a ':' to enter a range",!,"   of items.  (For example, enter '1:4' to update items 1, 2, 3 and 4.)",!
"RTN","SROACPM",49,0)
 I $D(SRFLG) W !,"4. Enter 'N' or 'NO' to enter negative response for all items.",!!,"5. Enter '@' to delete information from all items.",!
"RTN","SROACPM",50,0)
PRESS W ! K DIR S DIR("A")="Press the return key to continue or '^' to exit: ",DIR(0)="FOA" D ^DIR K DIR I $D(DTOUT)!$D(DUOUT) S SRSOUT=1
"RTN","SROACPM",51,0)
 Q
"RTN","SROACPM",52,0)
RANGE ; range of numbers
"RTN","SROACPM",53,0)
 I $$LOCK^SROUTL(SRTN) D  D UNLOCK^SROUTL(SRTN)
"RTN","SROACPM",54,0)
 .S SHEMP=$P(X,":"),CURLEY=$P(X,":",2) F EMILY=SHEMP:1:CURLEY Q:SRSOUT  D ONE
"RTN","SROACPM",55,0)
 Q
"RTN","SROACPM",56,0)
ONE ; edit one item
"RTN","SROACPM",57,0)
 I EMILY=7 D LIST
"RTN","SROACPM",58,0)
 K DR,DA,DIE S DR=$P(SRX(EMILY),"^",2)_"T",DA=SRTN,DIE=130,SRDT=$P(SRX(EMILY),"^",3) S:SRDT DR=DR_";"_SRDT_"T" D ^DIE K DR,DA I $D(Y) S SRSOUT=1
"RTN","SROACPM",59,0)
 I 'SRSOUT,EMILY=1!(EMILY=2) D OK
"RTN","SROACPM",60,0)
 Q
"RTN","SROACPM",61,0)
OK ; compare admission date to discharge date
"RTN","SROACPM",62,0)
 N SRADM,SRDIS S X=$G(^SRF(SRTN,208)),SRADM=$P(X,"^",14),SRDIS=$P(X,"^",15)
"RTN","SROACPM",63,0)
 I SRADM,SRDIS,SRADM'<SRDIS W !!,"  ***  NOTE: Discharge Date precedes Admission Date!!  Please check.  ***",! D PRESS W !
"RTN","SROACPM",64,0)
 Q
"RTN","SROACPM",65,0)
LIST ; display list of patient movements
"RTN","SROACPM",66,0)
 N CNT,SRADM,SRLOC,SRMOVE,SRMVMT,SRT,SRTYPE,SRX,SRY,SRZ
"RTN","SROACPM",67,0)
 S DFN=$P(^SRF(SRTN,0),"^"),SRX=$P($G(^SRF(SRTN,.2)),"^",12)
"RTN","SROACPM",68,0)
 S SRADM=0 D ADM Q:'SRX
"RTN","SROACPM",69,0)
 S CNT=0 F  Q:'SRX  D MVMT
"RTN","SROACPM",70,0)
 Q:CNT=0
"RTN","SROACPM",71,0)
 W !!,?5,"To identify the date and time the patient was discharged from intensive",!,?5,"care following surgery, see the following list of patient movements"
"RTN","SROACPM",72,0)
 W !,?5,"that occurred during the inpatient stay associated with this surgery.",!
"RTN","SROACPM",73,0)
 S CNT=0 F  S CNT=$O(SRMVMT(CNT)) Q:'CNT  S X=SRMVMT(CNT),SRT=$P(X,"^",2) W !,?5,$P($P(X,"^"),":",1,2),?25,$P(X,"^",3),?37,$S(SRT=3:"From",1:"To")_": "_$P(X,"^",4)
"RTN","SROACPM",74,0)
 W !
"RTN","SROACPM",75,0)
 Q
"RTN","SROACPM",76,0)
MVMT S VAIP("D")=SRX D IN5^VADPT S SRY=$P(VAIP(3),"^")
"RTN","SROACPM",77,0)
 I SRY S CNT=CNT+1 D
"RTN","SROACPM",78,0)
 .S SRMOVE=$P(VAIP(3),"^",2),SRTYPE=$P(VAIP(2),"^",1,2),SRLOC=$P(VAIP(5),"^",2)
"RTN","SROACPM",79,0)
 .S SRMVMT(CNT)=SRMOVE_"^"_SRTYPE_"^"_SRLOC
"RTN","SROACPM",80,0)
 I 'SRY S SRX="" Q
"RTN","SROACPM",81,0)
 I VAIP(1)=VAIP(17) S SRX="" Q
"RTN","SROACPM",82,0)
 I VAIP(16),VAIP(16)=VAIP(17) S CNT=CNT+1,SRMOVE=$P(VAIP(16,1),"^",2),SRTYPE=$P(VAIP(16,2),"^",1,2),SRLOC=$P(VAIP(16,4),"^",2),SRMVMT(CNT)=SRMOVE_"^"_SRTYPE_"^"_SRLOC,SRX="" Q
"RTN","SROACPM",83,0)
 S SRX=$P(VAIP(16,1),"^")
"RTN","SROACPM",84,0)
 Q
"RTN","SROACPM",85,0)
ADM S VAIP("D")=SRX D IN5^VADPT
"RTN","SROACPM",86,0)
 I 'VAIP(13) S X1=SRX,X2=1 D C^%DTC S SR24=X,SRDT=$O(^DGPM("APTT1",DFN,SRX)) Q:'SRDT!(SRDT>SR24)  S VAIP("D")=SRDT D IN5^VADPT I 'VAIP(13) S SRX="" Q
"RTN","SROACPM",87,0)
 I VAIP(13) S SRX=$P(VAIP(13,1),"^")+.000001
"RTN","SROACPM",88,0)
 Q
"RTN","SROACPM",89,0)
TR S J=I,J=$TR(J,"1234567890.","ABCDEFGHIJP")
"RTN","SROACPM",90,0)
 Q
"RTN","SROACPM",91,0)
GET S X=$T(@J)
"RTN","SROACPM",92,0)
 Q
"RTN","SROACPM",93,0)
END W @IOF D ^SRSKILL
"RTN","SROACPM",94,0)
 Q
"RTN","SROACPM",95,0)
DAH ;;418^Hospital Admission Date
"RTN","SROACPM",96,0)
DAI ;;419^Hospital Discharge Date
"RTN","SROACPM",97,0)
DDJ ;;440^Cardiac Catheterization Date
"RTN","SROACPM",98,0)
PBJE ;;.205^Time Patient In OR
"RTN","SROACPM",99,0)
PBCB ;;.232^Time Patient Out OR
"RTN","SROACPM",100,0)
DGJ ;;470^Date/Time Patient Extubated
"RTN","SROACPM",101,0)
DGA ;;471^Date/Time Discharged from ICU
"RTN","SROACPM",102,0)
DDB ;;442^Employment Status Preoperatively
"RTN","SROACPM",103,0)
DCA ;;431^Resource Data Comments
"RTN","SROADEL")
0^10^B8400705
"RTN","SROADEL",1,0)
SROADEL ;B'HAM ISC/MAM - DELETE ASSESSMENT ; [ 01/23/01  1:52 PM ]
"RTN","SROADEL",2,0)
 ;;3.0; Surgery ;**38,83,100**;24 Jun 93
"RTN","SROADEL",3,0)
 S SRASTAT=$P($G(^SRF(SRTN,"RA")),"^")
"RTN","SROADEL",4,0)
 I SRASTAT="T" W !!,"This assessment has already been verified and transmitted.  It cannot be",!,"deleted.  If the assessment was transmitted in error, use the option 'Update",!,"an Assessment Transmitted in Error'." D RET Q
"RTN","SROADEL",5,0)
 I SRASTAT="V" W !!,"This assessment has already been verified.  It cannot be deleted.  If the",!,"assessment was verified in error, use the option 'Update an Assessment Verified",!,"in Error'." D RET Q
"RTN","SROADEL",6,0)
DEL W !!,"This assessment has a current status of "_$S(SRASTAT="I":"'Incomplete'",1:"'Complete/Unverified'"),!!,"Are you sure that you want to delete this assessment ? NO//  " R SRYN:DTIME I '$T!(SRYN["^") S SRSOUT=1 Q
"RTN","SROADEL",7,0)
 S SRYN=$E(SRYN) I "Nn"[SRYN S SRSOUT=1 Q
"RTN","SROADEL",8,0)
 I "Yy"'[SRYN W !!,"Enter <RET> if this assessment was selected in error and should not be deleted.",!,"If you want to delete this assessment, enter 'YES'." G DEL
"RTN","SROADEL",9,0)
 I $$LOCK^SROUTL(SRTN) D  D UNLOCK^SROUTL(SRTN)
"RTN","SROADEL",10,0)
 .K DR,DIE,DA S DA=SRTN,DIE=130,DR="235///@;284///@;393///@;260///@;272///@;323///@;102///@" D ^DIE W !!,"Deleting Assessment..."
"RTN","SROADEL",11,0)
 .K DA,DIK S DIK="^SRF(",DIK(1)=".232^AQ",DA=SRTN D EN1^DIK
"RTN","SROADEL",12,0)
 Q
"RTN","SROADEL",13,0)
RET W !!,"Press <RET> to continue  " R X:DTIME
"RTN","SROADEL",14,0)
 K SRTN
"RTN","SROADEL",15,0)
 Q
"RTN","SROAERR")
0^11^B5386275
"RTN","SROAERR",1,0)
SROAERR ;B'HAM ISC/MAM - UPDATE ASSESSMENTS ENTERED IN ERROR ; [ 01/23/01  2:09 PM ]
"RTN","SROAERR",2,0)
 ;;3.0; Surgery ;**38,65,100**;24 Jun 93
"RTN","SROAERR",3,0)
TRANS ; update assessments transmitted in error
"RTN","SROAERR",4,0)
 I '$D(SRSTAT) S SRSTAT="T"
"RTN","SROAERR",5,0)
 S SRSOUT=0 K SRNEW D ^SROASS I '$D(SRTN) S SRSOUT=1 G END
"RTN","SROAERR",6,0)
 S SRASTAT=$P($G(^SRF(SRTN,"RA")),"^") I SRSTAT'=SRASTAT D GOOF I GOOF G END
"RTN","SROAERR",7,0)
ASK W !!,"Are you sure that you want to change the status of this assessment"
"RTN","SROAERR",8,0)
 W !,"from "_$S(SRASTAT="C":"'COMPLETE'",1:"'TRANSMITTED'")_" to 'INCOMPLETE' ?  YES//  " R SRYN:DTIME I '$T!(SRYN["^") S SRSOUT=1 G END
"RTN","SROAERR",9,0)
 S SRYN=$E(SRYN) I "YyNn"'[SRYN D HELP G ASK
"RTN","SROAERR",10,0)
 S:SRYN="" SRYN="Y" I "Nn"[SRYN G END
"RTN","SROAERR",11,0)
 I $$LOCK^SROUTL(SRTN) D STAT Q
"RTN","SROAERR",12,0)
 E  W !!,"No action taken." G END
"RTN","SROAERR",13,0)
 Q
"RTN","SROAERR",14,0)
STAT K DR S DIE=130,DA=SRTN,DR="235////I;393////"_$S(SRASTAT="T":1,1:"") D ^DIE K DR
"RTN","SROAERR",15,0)
 I SRASTAT="C"&($P($G(^SRF(SRTN,"RA")),"^",3)'="1") K DR S DIE=130,DA=SRTN,DR="272////@" D ^DIE K DR
"RTN","SROAERR",16,0)
 W !!,"The Assessment Status has been changed to 'INCOMPLETE'."
"RTN","SROAERR",17,0)
 D UNLOCK^SROUTL(SRTN)
"RTN","SROAERR",18,0)
END I 'SRSOUT W !!,"Press <RET> to continue  " R X:DTIME
"RTN","SROAERR",19,0)
 D ^SRSKILL K SRTN W @IOF
"RTN","SROAERR",20,0)
 Q
"RTN","SROAERR",21,0)
GOOF S GOOF=0 I SRASTAT="I" W !!,"This assessment already has the status, 'INCOMPLETE'." S GOOF=1 Q
"RTN","SROAERR",22,0)
 Q
"RTN","SROAERR",23,0)
HELP W !!,"Enter RETURN if the assessment was "_$S(SRASTAT="C":"completed",1:"transmitted")_" in error and the status",!,"should be changed to 'INCOMPLETE' to allow editing.  Otherwise, enter 'NO'."
"RTN","SROAERR",24,0)
 Q
"RTN","SROAL1")
0^12^B21128005
"RTN","SROAL1",1,0)
SROAL1 ;BIR/ADM - LOAD PREOPERATIVE LAB DATA ; [ 01/23/01  2:34 PM ]
"RTN","SROAL1",2,0)
 ;;3.0; Surgery ;**18,38,47,54,65,71,81,88,100**;24 Jun 93
"RTN","SROAL1",3,0)
 ;
"RTN","SROAL1",4,0)
 ; Reference to ^LR( supported by DBIA #194
"RTN","SROAL1",5,0)
 ;
"RTN","SROAL1",6,0)
 Q:'$D(SRTN)  K SRAD,SRAT S SRSOUT=0
"RTN","SROAL1",7,0)
 W !!,"This selection loads the most recent lab data for tests performed",!,"within 90 days before the operation."
"RTN","SROAL1",8,0)
YEP W !!,"Do you want to automatically load preoperative lab data ?  YES//  " R SRYN:DTIME G:'$T!(SRYN["^") END
"RTN","SROAL1",9,0)
 S SRYN=$E(SRYN) I "YyNn"'[SRYN W !!,"Enter <RET> to automatically load preoperative lab data from the patient's lab record, or 'NO' to return to the menu." G YEP
"RTN","SROAL1",10,0)
 I "Yy"'[SRYN W !!,"Lab data NOT loaded." G END
"RTN","SROAL1",11,0)
START S SRALR=$S($D(^DPT($P(^SRF(SRTN,0),"^"),"LR")):$P(^("LR"),"^"),1:"")
"RTN","SROAL1",12,0)
 S SRAOP=$P($G(^SRF(SRTN,.2)),"^",2) I 'SRAOP W !!,"The 'Time the Operation Began' must be entered before continuing." D TMCHK G:SRSOUT END
"RTN","SROAL1",13,0)
 S SRST=9999999-SRAOP,X1=SRAOP,X2=-90 D C^%DTC S SREND=9999999-X
"RTN","SROAL1",14,0)
SRAT ; Get test and data name(s) for test from file 139.2.
"RTN","SROAL1",15,0)
 W !!,"..Searching lab record for latest preoperative test data...."
"RTN","SROAL1",16,0)
 K DIC S DIC=61,DIC(0)="",X="SERUM" D ^DIC S SRSER=+Y K DIC S DIC=61,DIC(0)="",X="PLASMA" D ^DIC K DIC S SRP=+Y
"RTN","SROAL1",17,0)
 F SRAT=1,4,7,8,11,13:1:20 D SP
"RTN","SROAL1",18,0)
 I $$LOCK^SROUTL(SRTN) D ^SROAL11 S SRCON=$P($G(^SRF(SRTN,"CON")),"^") D:SRCON CONCC D UNLOCK^SROUTL(SRTN)
"RTN","SROAL1",19,0)
END I 'SRSOUT W !!,"Press <RET> to continue  " R X:DTIME
"RTN","SROAL1",20,0)
 W @IOF
"RTN","SROAL1",21,0)
 Q
"RTN","SROAL1",22,0)
CONCC ; update concurrent case
"RTN","SROAL1",23,0)
 S SRTN1=SRTN,SRTN=SRCON D SRAT4^SROAL11 S SRTN=SRTN1
"RTN","SROAL1",24,0)
 Q
"RTN","SROAL1",25,0)
SP S SRASP=$P(^SRO(139.2,SRAT,2),"^") K SRADT F SRADN=0:0 S SRADN=$O(^SRO(139.2,SRAT,1,SRADN)) Q:SRADN'>0  S SRATN=$P(^(SRADN,0),"^") D LABCHK
"RTN","SROAL1",26,0)
 Q
"RTN","SROAL1",27,0)
LABCHK ; Get latest test values from patient's lab record.
"RTN","SROAL1",28,0)
 I SRALR F SRAIDT=SRST:0 S SRAIDT=$O(^LR(SRALR,"CH",SRAIDT)) Q:SRAIDT'>0!(SRAIDT>SREND)  I $D(^(SRAIDT,SRATN)) S SRSP=$P(^(0),"^",5) D
"RTN","SROAL1",29,0)
 .I SRAT>1&(SRAT<16),SRSP=SRSER!(SRSP=SRP) D COMP Q
"RTN","SROAL1",30,0)
 .I SRSP=SRASP D COMP Q
"RTN","SROAL1",31,0)
 I '$D(SRAT(SRAT)) S SRAT(SRAT)="NS",SRAD(SRAT)=""
"RTN","SROAL1",32,0)
 Q
"RTN","SROAL1",33,0)
COMP S SRX=$P(^LR(SRALR,"CH",SRAIDT,SRATN),"^") I $P(^LR(SRALR,"CH",SRAIDT,0),"^",3)'="","canccommentpending"'[SRX,SRX'["CANC" D DATA
"RTN","SROAL1",34,0)
 Q
"RTN","SROAL1",35,0)
DATA I $D(SRADT),SRAIDT>SRADT Q
"RTN","SROAL1",36,0)
 I +SRX'=SRX D
"RTN","SROAL1",37,0)
 .N X1,X2 S SRZ="" I "<>"[$E(SRX) S SRZ=$E(SRX),SRX=$E(SRX,2,99)
"RTN","SROAL1",38,0)
 .I SRX?.N0.1".".N D  Q
"RTN","SROAL1",39,0)
 ..S X1=$P(SRX,"."),X1=+X1 S:X1=0 X1=""
"RTN","SROAL1",40,0)
 ..S X2="."_$P(SRX,".",2),X2=+X2 S:X2=0 X2=""
"RTN","SROAL1",41,0)
 ..S SRX=X1_X2,SRX=+SRX,SRX=SRZ_SRX
"RTN","SROAL1",42,0)
 .S SRX="*"
"RTN","SROAL1",43,0)
 S SRAT(SRAT)=SRX D:SRAT(SRAT)["." DEC S SRAD(SRAT)=$E($P(^LR(SRALR,"CH",SRAIDT,0),"^"),1,7),SRADT=SRAIDT
"RTN","SROAL1",44,0)
 Q
"RTN","SROAL1",45,0)
TMCHK W !!,"Do you want to enter 'Time the Operation Began' at this time ?  YES//  " R SRYN:DTIME I '$T!(SRYN["^") S SRSOUT=1 Q
"RTN","SROAL1",46,0)
 S SRYN=$E(SRYN)
"RTN","SROAL1",47,0)
 I "YyNn"'[SRYN W !!,"The time that the operation began must be entered prior to capturing the",!,"preoperative lab data.  Enter 'YES' to input 'Time the Operation Began',",!,"or 'NO' to return to the menu." G TMCHK
"RTN","SROAL1",48,0)
 I "Yy"'[SRYN S SRSOUT=1 Q
"RTN","SROAL1",49,0)
 I $$LOCK^SROUTL(SRTN) D  D UNLOCK^SROUTL(SRTN)
"RTN","SROAL1",50,0)
 .W ! K DR S DR=".22T",DA=SRTN,DIE=130 D ^DIE K DR
"RTN","SROAL1",51,0)
 S SRAOP=$P($G(^SRF(SRTN,.2)),"^",2) I 'SRAOP S SRSOUT=1
"RTN","SROAL1",52,0)
 Q
"RTN","SROAL1",53,0)
DEC ; convert to proper decimal place
"RTN","SROAL1",54,0)
 I +SRAT(SRAT)=SRAT(SRAT)  S SRAT(SRAT)=SRAT(SRAT)+.05\.1*.1 Q
"RTN","SROAL1",55,0)
 S SR1=$E(SRAT(SRAT)),SR2=$E(SRAT(SRAT),2,99),SR2=SR2+.05\.1*.1,SRAT(SRAT)=SR1_SR2
"RTN","SROAL1",56,0)
 Q
"RTN","SROAL1",57,0)
CREAT ; from SROACL1 for creatinine
"RTN","SROAL1",58,0)
 N SRSER,SRP K DIC S DIC=61,DIC(0)="",X="SERUM" D ^DIC S SRSER=+Y K DIC S DIC=61,DIC(0)="",X="PLASMA" D ^DIC K DIC S SRP=+Y
"RTN","SROAL1",59,0)
 S SRLB=0 F SRLB=4,8,20 D
"RTN","SROAL1",60,0)
 .S VALUE=$P($G(^SRF(SRTN,201)),"^",SRLB),SRAOPDT=$P(^SRF(SRTN,0),"^",9) I DT>SRAOPDT,VALUE Q
"RTN","SROAL1",61,0)
 .S SRSOUT=0,SRALR=$S($D(^DPT($P(^SRF(SRTN,0),"^"),"LR")):$P(^("LR"),"^"),1:"")
"RTN","SROAL1",62,0)
 .S SRAOP=SRAOPDT,SRST=9999999-SRAOP,X1=SRAOP,X2=-30 D C^%DTC S SREND=9999999-X
"RTN","SROAL1",63,0)
 .S SRAT=$S(SRLB=4:7,SRLB=8:11,1:1),SRASP=$P(^SRO(139.2,SRAT,2),"^") K SRADT F SRADN=0:0 S SRADN=$O(^SRO(139.2,SRAT,1,SRADN)) Q:'SRADN  S SRATN=$P(^(SRADN,0),"^") D LABCHK
"RTN","SROAL1",64,0)
 .I $D(SRAT(SRAT)),$$LOCK^SROUTL(SRTN) S $P(^SRF(SRTN,201),"^",SRLB)=SRAT(SRAT),$P(^(202),"^",SRLB)=SRAD(SRAT) D UNLOCK^SROUTL(SRTN)
"RTN","SROAL1",65,0)
 K SRLB
"RTN","SROAL1",66,0)
 Q
"RTN","SROAL2")
0^13^B18808436
"RTN","SROAL2",1,0)
SROAL2 ;BIR/ADM - LOAD POSTOPERATIVE LAB DATA ; [ 01/23/01  3:00 PM ]
"RTN","SROAL2",2,0)
 ;;3.0; Surgery ;**18,38,47,54,65,71,88,100**;24 Jun 93
"RTN","SROAL2",3,0)
 ;
"RTN","SROAL2",4,0)
 ; Reference to ^LR( supported by DBIA #194
"RTN","SROAL2",5,0)
 ;
"RTN","SROAL2",6,0)
 Q:'$D(SRTN)  K SRAD,SRAT S SRSOUT=0
"RTN","SROAL2",7,0)
 W !!,"This selection loads highest or lowest lab data for tests performed within",!,"30 days after the operation."
"RTN","SROAL2",8,0)
YEP W !!,"Do you want to automatically load postoperative lab data ?  YES//  " R SRYN:DTIME G:'$T!(SRYN["^") END
"RTN","SROAL2",9,0)
 S SRYN=$E(SRYN) I "YyNn"'[SRYN W !!,"Enter <RET> to automatically load postoperative lab data from the patient's lab record, or 'NO' to return to the menu." G YEP
"RTN","SROAL2",10,0)
 I "Yy"'[SRYN W !!,"Lab data NOT loaded." G END
"RTN","SROAL2",11,0)
START S SRALR=$S($D(^DPT($P(^SRF(SRTN,0),"^"),"LR")):$P(^("LR"),"^"),1:"")
"RTN","SROAL2",12,0)
 S SRAOP=$P($G(^SRF(SRTN,.2)),"^",3) I 'SRAOP W !!,"'Time the Operation Ends' must be entered before continuing." D TMCHK G:SRSOUT END
"RTN","SROAL2",13,0)
 S SREND=9999999-SRAOP,X1=SRAOP,X2=30 D C^%DTC S SRST=9999999-X
"RTN","SROAL2",14,0)
SRAT ; Get test from file 139.2.
"RTN","SROAL2",15,0)
 W !!,"..Searching lab record for postoperative lab test data...."
"RTN","SROAL2",16,0)
 K DIC S DIC=61,DIC(0)="",X="SERUM" D ^DIC S SRSER=+Y K DIC S DIC=61,DIC(0)="",X="PLASMA" D ^DIC K DIC S SRP=+Y
"RTN","SROAL2",17,0)
 S SRFLG="H" F SRAT=2,3,4,5,7,9,10,14,16 S SRASP=$P(^SRO(139.2,SRAT,2),"^") D SRADN,NS
"RTN","SROAL2",18,0)
 S SRFLG="L" F SRAT=4,5,17 S SRASP=$P(^SRO(139.2,SRAT,2),"^") D SRADN,NS
"RTN","SROAL2",19,0)
 I $$LOCK^SROUTL(SRTN) D ^SROAL21,UNLOCK^SROUTL(SRTN)
"RTN","SROAL2",20,0)
END I 'SRSOUT W !!,"Press <RET> to continue  " R X:DTIME
"RTN","SROAL2",21,0)
 W @IOF
"RTN","SROAL2",22,0)
 Q
"RTN","SROAL2",23,0)
SRADN ; Get data name(s) for test, make call to check lab record.
"RTN","SROAL2",24,0)
 F SRADN=0:0 S SRADN=$O(^SRO(139.2,SRAT,1,SRADN)) Q:SRADN'>0  S SRATN=$P(^(SRADN,0),"^") D LABCHK
"RTN","SROAL2",25,0)
 Q
"RTN","SROAL2",26,0)
LABCHK ; Get test values from patient's lab record.
"RTN","SROAL2",27,0)
 S SRX="" I SRALR F SRAIDT=SRST:0 S SRAIDT=$O(^LR(SRALR,"CH",SRAIDT)) Q:SRAIDT'>0!(SRAIDT>SREND)  I $D(^(SRAIDT,SRATN)) S SRSP=$P(^(0),"^",5) D  Q:(SRFLG="H"&(SRX[">"))!(SRFLG="L"&(SRX["<"))  I SRX="*" D STAR
"RTN","SROAL2",28,0)
 .I SRAT>1&(SRAT<16),SRSP=SRSER!(SRSP=SRP) D COMP Q
"RTN","SROAL2",29,0)
 .I SRSP=SRASP D COMP Q
"RTN","SROAL2",30,0)
 Q
"RTN","SROAL2",31,0)
COMP S SRAVAL=$P(^LR(SRALR,"CH",SRAIDT,SRATN),"^") I $P(^LR(SRALR,"CH",SRAIDT,0),"^",3)'="","canccommentpending"'[SRAVAL,SRAVAL'["CANC" D DATA
"RTN","SROAL2",32,0)
 I $D(SRAT(SRFLG,SRAT)),SRAT(SRFLG,SRAT)["." D
"RTN","SROAL2",33,0)
 .I SRAT(SRFLG,SRAT)=+SRAT(SRFLG,SRAT) S SRAT(SRFLG,SRAT)=SRAT(SRFLG,SRAT)+.05\.1*.1 Q
"RTN","SROAL2",34,0)
 .S SR1=$E(SRAT(SRFLG,SRAT)),SR2=$E(SRAT(SRFLG,SRAT),2,99),SR2=SR2+.05\.1*.1,SRAT(SRFLG,SRAT)=SR1_SR2
"RTN","SROAL2",35,0)
 Q
"RTN","SROAL2",36,0)
NS ; check for no sample
"RTN","SROAL2",37,0)
 I '$D(SRAT(SRFLG,SRAT)) S SRAT(SRFLG,SRAT)="NS",SRAD(SRFLG,SRAT)=""
"RTN","SROAL2",38,0)
 Q
"RTN","SROAL2",39,0)
STAR ; questional result, require manual input
"RTN","SROAL2",40,0)
 S (SRAT(SRFLG,SRAT),SRAD(SRFLG,SRAT))=""
"RTN","SROAL2",41,0)
 Q
"RTN","SROAL2",42,0)
DATA ; Decide to save test result or not
"RTN","SROAL2",43,0)
 N SRSWAP,SRVAL S SRSWAP=0
"RTN","SROAL2",44,0)
 S (SRT,SRX)=SRAVAL I +SRAVAL'=SRAVAL D CONV Q:SRX="*"  S (SRT,SRAVAL)=SRZ_SRX
"RTN","SROAL2",45,0)
 I $D(SRAT(SRFLG,SRAT)) S SRT1=SRAT(SRFLG,SRAT) D  I SRSWAP S SRAT(SRFLG,SRAT)=SRAVAL,SRAD(SRFLG,SRAT)=$E($P(^LR(SRALR,"CH",SRAIDT,0),"^"),1,7) Q
"RTN","SROAL2",46,0)
 .I SRFLG="H" Q:SRT1[">"  D
"RTN","SROAL2",47,0)
 ..I SRT[">" S SRSWAP=1 Q
"RTN","SROAL2",48,0)
 ..S SRVAL=SRX,SRX=SRT1 D CONV I SRVAL>SRX S SRSWAP=1 Q
"RTN","SROAL2",49,0)
 .I SRFLG="L" Q:SRT1["<"  D
"RTN","SROAL2",50,0)
 ..I SRT["<" S SRSWAP=1 Q
"RTN","SROAL2",51,0)
 ..S SRVAL=SRX,SRX=SRT1 D CONV I SRVAL<SRX S SRSWAP=1 Q
"RTN","SROAL2",52,0)
 I '$D(SRAT(SRFLG,SRAT)) S SRAT(SRFLG,SRAT)=SRAVAL,SRAD(SRFLG,SRAT)=$E($P(^LR(SRALR,"CH",SRAIDT,0),"^"),1,7)
"RTN","SROAL2",53,0)
 Q
"RTN","SROAL2",54,0)
TMCHK W !!,"Do you want to enter the time that the operation was completed at ",!,"this time ?  YES//  " R SRYN:DTIME I '$T!(SRYN["^") S SRSOUT=1 Q
"RTN","SROAL2",55,0)
 S SRYN=$E(SRYN) I "YyNn"'[SRYN W !!,"Enter 'YES' to input 'Time the Operation Ends' or ",!,"'NO' to return to the menu." G TMCHK
"RTN","SROAL2",56,0)
 I "Yy"'[SRYN S SRSOUT=1 Q
"RTN","SROAL2",57,0)
 I $$LOCK^SROUTL(SRTN) D  D UNLOCK^SROUTL(SRTN)
"RTN","SROAL2",58,0)
 .W ! K DR S DR=".23T",DA=SRTN,DIE=130 D ^DIE K DR S SRAOP=$P($G(^SRF(SRTN,.2)),"^",3) I 'SRAOP S SRSOUT=1
"RTN","SROAL2",59,0)
 Q
"RTN","SROAL2",60,0)
CONV ; convert value to numeric for comparison
"RTN","SROAL2",61,0)
 N SRELSE,X1,X2 S SRZ="" I "<>"[$E(SRX) S SRZ=$E(SRX),SRX=$E(SRX,2,99)
"RTN","SROAL2",62,0)
 I SRX?.N0.1".".N D  Q
"RTN","SROAL2",63,0)
 .I SRX'["." S SRX=+SRX Q
"RTN","SROAL2",64,0)
 .S X1=$P(SRX,"."),X1=+X1 S:X1=0 X1=""
"RTN","SROAL2",65,0)
 .S X2="."_$P(SRX,".",2),X2=+X2 S:X2=0 X2=""
"RTN","SROAL2",66,0)
 .S SRX=X1_X2,SRX=+SRX
"RTN","SROAL2",67,0)
 S SRX="*"
"RTN","SROAL2",68,0)
 Q
"RTN","SROALEN")
0^14^B11768211
"RTN","SROALEN",1,0)
SROALEN ;B'HAM ISC/MAM - LAB INFO ; [ 01/29/01  7:55 AM ]
"RTN","SROALEN",2,0)
 ;;3.0; Surgery ;**38,100**;24 Jun 93
"RTN","SROALEN",3,0)
 I '$D(SRTN) W !!,"A Surgery Risk Assessment must be selected prior to using this option.",!!,"Press <RET> to continue  " R X:DTIME G END
"RTN","SROALEN",4,0)
 S SRSOUT=0 D ^SROAUTL
"RTN","SROALEN",5,0)
START G:SRSOUT END K SRA,SRAO D ^SROALN1,^SROALDP
"RTN","SROALEN",6,0)
ASK W !!,"Select Preoperative Laboratory Information to Edit: " R X:DTIME I '$T!(X["^") S SRSOUT=1 D CONCC G END
"RTN","SROALEN",7,0)
 I X="" D CONCC,^SROALN2 G END
"RTN","SROALEN",8,0)
 S:X="a" X="A" I '$D(SRAO(X)),(X'?.N1":".N),(X'="A") D HELP G:SRSOUT END G START
"RTN","SROALEN",9,0)
 I X="A" S X="1:12"
"RTN","SROALEN",10,0)
 I X?.N1":".N S Y=$E(X),Z=$P(X,":",2) I Y<1!(Z>12)!(Y>Z) D HELP G:SRSOUT END G START
"RTN","SROALEN",11,0)
 S SRPAGE="" D HDR^SROAUTL
"RTN","SROALEN",12,0)
 I X?.N1":".N D RANGE G START
"RTN","SROALEN",13,0)
 I $D(SRAO(X)) S EMILY=X D  G START
"RTN","SROALEN",14,0)
 .I $$LOCK^SROUTL(SRTN) D ONE,UNLOCK^SROUTL(SRTN)
"RTN","SROALEN",15,0)
END W @IOF
"RTN","SROALEN",16,0)
 Q
"RTN","SROALEN",17,0)
HELP W @IOF,!!!!,"Enter the number or range of numbers you want to edit.  Examples of proper",!,"responses are listed below."
"RTN","SROALEN",18,0)
 W !!,"1. Enter 'A' to update all information.",!!,"2. Enter a number (1-12) to update the information in that field.  (For",!,"   example, enter '2' to update Preoperative BUN)"
"RTN","SROALEN",19,0)
 W !!,"3. Enter a range of numbers (1-12) separated by a ':' to enter a range of",!,"   information.  (For example, enter '1:3' to update Serum Sodium,",!,"   BUN, and Serum Creatinine)"
"RTN","SROALEN",20,0)
 W !!,"Press <RET> to continue, or '^' to quit  " R X:DTIME I '$T!(X["^") S SRSOUT=1
"RTN","SROALEN",21,0)
 Q
"RTN","SROALEN",22,0)
RANGE ; range of numbers
"RTN","SROALEN",23,0)
 I $$LOCK^SROUTL(SRTN) D  D UNLOCK^SROUTL(SRTN)
"RTN","SROALEN",24,0)
 .S SRNOMORE=0,SHEMP=$P(X,":"),CURLEY=$P(X,":",2) F EMILY=SHEMP:1:CURLEY Q:SRNOMORE  D ONE
"RTN","SROALEN",25,0)
 Q
"RTN","SROALEN",26,0)
ONE ; edit one item
"RTN","SROALEN",27,0)
 I EMILY>12 K DR,DIE S DA=SRTN,DR=$P(SRAO(EMILY),"^",4)_"T;"_$P(SRAO(EMILY),"^",5)_"T;"_$P(SRAO(EMILY),"^",6)_"T",DIE=130 D ^DIE S:$D(Y) SRNOMORE=1 K DR Q
"RTN","SROALEN",28,0)
 K DR,DIE S DA=SRTN,DR=$P(SRAO(EMILY),"^",3)_"T;"_$P(SRAO(EMILY),"^",4)_"T",DIE=130 D ^DIE S:$D(Y) SRNOMORE=1 K DR
"RTN","SROALEN",29,0)
 Q
"RTN","SROALEN",30,0)
RET Q:SRSOUT  W !!,"Press <RET> to continue, or '^' to quit  " R X:DTIME I '$T!(X["^") S SRSOUT=1 Q
"RTN","SROALEN",31,0)
 Q
"RTN","SROALEN",32,0)
CONCC ; check for concurrent case and update if one exists
"RTN","SROALEN",33,0)
 Q:'$$LOCK^SROUTL(SRTN)
"RTN","SROALEN",34,0)
 S SRCON=$P($G(^SRF(SRTN,"CON")),"^") Q:'SRCON
"RTN","SROALEN",35,0)
 S SRI="" F  S SRI=$O(SRAO(SRI)) Q:SRI=""  S S1=$P(SRAO(SRI),"^",3),S2=$P(SRAO(SRI),"^",4) K DA,DIC,DIQ,DR,SRY D
"RTN","SROALEN",36,0)
 .S DA=SRTN,DR=S1_";"_S2,DIC="^SRF(",DIQ="SRY",DIQ(0)="I" D EN^DIQ1 S P1=SRY(130,SRTN,S1,"I") S:P1="" P1="@" S P2=SRY(130,SRTN,S2,"I") S:P2="" P2="@"
"RTN","SROALEN",37,0)
 .K DA,DIE,DR S DA=SRCON,DIE=130,DR=S1_"////"_P1_";"_S2_"////"_P2 D ^DIE K DR
"RTN","SROALEN",38,0)
 D UNLOCK^SROUTL(SRTN)
"RTN","SROALEN",39,0)
 Q
"RTN","SROALN2")
0^15^B9183649
"RTN","SROALN2",1,0)
SROALN2 ;BIR/MAM - LAB INFO ; [ 01/29/01  8:11 AM ]
"RTN","SROALN2",2,0)
 ;;3.0; Surgery ;**38,88,100**;24 Jun 93
"RTN","SROALN2",3,0)
 S SRSOUT=0 I '$D(SRTN) W !!,"A Surgery Risk Assessment must be selected prior to using this option.",!!,"Press <RET> to continue  " R X:DTIME G END
"RTN","SROALN2",4,0)
 D ^SROAUTL
"RTN","SROALN2",5,0)
START G:SRSOUT END K SRA,SRAO D ^SROALN3
"RTN","SROALN2",6,0)
ASK W !!,"Select Postoperative Laboratory Information to Edit: " R X:DTIME I '$T!(X["^") S SRSOUT=1 G END
"RTN","SROALN2",7,0)
 I X="" Q
"RTN","SROALN2",8,0)
 S:X="a" X="A" I '$D(SRAO(X)),(X'?.N1":".N),(X'="A") D HELP G:SRSOUT END G START
"RTN","SROALN2",9,0)
 I X="A" S X="1:12"
"RTN","SROALN2",10,0)
 I X?.N1":".N S Y=$E(X),Z=$P(X,":",2) I Y<1!(Z>12)!(Y>Z) D HELP G:SRSOUT END G START
"RTN","SROALN2",11,0)
 S SRPAGE="" D HDR^SROAUTL
"RTN","SROALN2",12,0)
 I X?.N1":".N D RANGE G START
"RTN","SROALN2",13,0)
 I $D(SRAO(X)) S EMILY=X D  G START
"RTN","SROALN2",14,0)
 .I $$LOCK^SROUTL(SRTN) D ONE,UNLOCK^SROUTL(SRTN)
"RTN","SROALN2",15,0)
END W @IOF
"RTN","SROALN2",16,0)
 Q
"RTN","SROALN2",17,0)
HELP W @IOF,!!!!,"Enter the number or range of numbers you want to edit.  Examples of proper",!,"responses are listed below."
"RTN","SROALN2",18,0)
 W !!,"1. Enter 'A' to update all information.",!!,"2. Enter a number (1-12) to update the information in that field.  (For",!,"   example, enter '5' to update Highest Serum Creatinine)"
"RTN","SROALN2",19,0)
 W !!,"3. Enter a range of numbers (1-12) separated by a ':' to enter a range of",!,"   information.  (For example, enter '1:3' to update Highest Serum Sodium,",!,"   Lowest Serum Sodium, and Highest Potassium)"
"RTN","SROALN2",20,0)
 W !!,"Press <RET> to continue, or '^' to quit  " R X:DTIME I '$T!(X["^") S SRSOUT=1
"RTN","SROALN2",21,0)
 Q
"RTN","SROALN2",22,0)
RANGE ; range of numbers
"RTN","SROALN2",23,0)
 I $$LOCK^SROUTL(SRTN) D  D UNLOCK^SROUTL(SRTN)
"RTN","SROALN2",24,0)
 .S SRNOMORE=0,SHEMP=$P(X,":"),CURLEY=$P(X,":",2) F EMILY=SHEMP:1:CURLEY Q:SRNOMORE  D ONE
"RTN","SROALN2",25,0)
 Q
"RTN","SROALN2",26,0)
ONE ; edit one item
"RTN","SROALN2",27,0)
 K DR,DIE S DA=SRTN,DR=$P(SRAO(EMILY),"^",3)_"T;"_$P(SRAO(EMILY),"^",4)_"T",DIE=130 D ^DIE S:$D(Y) SRNOMORE=1 K DR
"RTN","SROALN2",28,0)
 Q
"RTN","SROALN2",29,0)
RET Q:SRSOUT  W !!,"Press <RET> to continue, or '^' to quit  " R X:DTIME I '$T!(X["^") S SRSOUT=1 Q
"RTN","SROALN2",30,0)
 Q
"RTN","SROALSS")
0^16^B18472594
"RTN","SROALSS",1,0)
SROALSS ;B'HAM ISC/AM - ALL CASES BY SPECIALTY ; [ 04/02/01  8:33 AM ]
"RTN","SROALSS",2,0)
 ;;3.0; Surgery ;**38,47,50,100**;24 Jun 93
"RTN","SROALSS",3,0)
 I $E(IOST)="P" D ^SROALSSP Q
"RTN","SROALSS",4,0)
START S SRSOUT=0 K ^TMP("SRA",$J)
"RTN","SROALSS",5,0)
 F  S SRSD=$O(^SRF("AC",SRSD)) Q:'SRSD!(SRSD>SRED)!SRSOUT  S SRTN=0 F  S SRTN=$O(^SRF("AC",SRSD,SRTN)) Q:'SRTN!SRSOUT  I $D(^SRF(SRTN,0)),$$DIV^SROUTL0(SRTN) D UTL
"RTN","SROALSS",6,0)
 D PRINT Q
"RTN","SROALSS",7,0)
UTL ; write to ^TMP("SRA,$J)
"RTN","SROALSS",8,0)
 S SRA(0)=^SRF(SRTN,0)
"RTN","SROALSS",9,0)
 S CAN=$P($G(^SRF(SRTN,30)),"^") I CAN Q
"RTN","SROALSS",10,0)
 S CAN=$P($G(^SRF(SRTN,31)),"^",8) I CAN'="" Q
"RTN","SROALSS",11,0)
 S X=$P($G(^SRF(SRTN,.2)),"^",12) I 'X Q
"RTN","SROALSS",12,0)
 I SRFLG,$P(^SRF(SRTN,0),"^",4)'=SRASP Q
"RTN","SROALSS",13,0)
 S SRSS=$P(^SRF(SRTN,0),"^",4),SRSS=$S(SRSS:$P(^SRO(137.45,SRSS,0),"^"),1:"SPECIALTY NOT ENTERED")
"RTN","SROALSS",14,0)
 S ^TMP("SRA",$J,SRSS,SRTN)=""
"RTN","SROALSS",15,0)
 Q
"RTN","SROALSS",16,0)
SET ; set variables
"RTN","SROALSS",17,0)
 N SRCOMMA
"RTN","SROALSS",18,0)
 S SRA("RA")=$G(^SRF(SRTN,"RA")),X=$P(SRA("RA"),"^"),STATUS=$S(X="I":"INCOMPLETE",X="C":"COMPLETED",X="T":"TRANSMITTED",1:"EXCLUSION")
"RTN","SROALSS",19,0)
 S (SREXCL,Y)=$P(SRA("RA"),"^",7),C=$P(^DD(130,102,0),"^",2) D Y^DIQ S SREXCL=Y
"RTN","SROALSS",20,0)
 I SREXCL="",STATUS="EXCLUSION" S STATUS="NO ASSESSMENT"
"RTN","SROALSS",21,0)
 S SRA(0)=^SRF(SRTN,0),DFN=$P(SRA(0),"^") N I D DEM^VADPT S SRANM=VADM(1),SRASSN=VA("PID") K VADM
"RTN","SROALSS",22,0)
 I $L(SRANM)>19 S SRANM=$P(SRANM,",")_","_$E($P(SRANM,",",2))_"."
"RTN","SROALSS",23,0)
 S X=^SRF(SRTN,"OP"),SROPER=$P(X,"^"),Y=$P(X,"^",2),SRCPT=$S(Y:$P($$CPT^ICPTCOD(Y),"^",2),1:"NO CPT") I SRCPT,$O(^SRF(SRTN,"OPMOD",0)) D
"RTN","SROALSS",24,0)
 .S (SRCOMMA,SRI)=0,SRCMOD="",SRCPT=SRCPT_"-" F  S SRI=$O(^SRF(SRTN,"OPMOD",SRI)) Q:'SRI  D
"RTN","SROALSS",25,0)
 ..S SRM=$P(^SRF(SRTN,"OPMOD",SRI,0),"^"),SRCMOD=$P($$MOD^ICPTMOD(SRM,"I"),"^",2)
"RTN","SROALSS",26,0)
 ..S SRCPT=SRCPT_$S(SRCOMMA:",",1:"")_SRCMOD,SRCOMMA=1
"RTN","SROALSS",27,0)
 S SROPER=SROPER_" ("_SRCPT_")"
"RTN","SROALSS",28,0)
 I $O(^SRF(SRTN,13,0)) S SROTHER=0 F I=0:0 S SROTHER=$O(^SRF(SRTN,13,SROTHER)) Q:'SROTHER  D OTHER
"RTN","SROALSS",29,0)
 S X=$P($G(^SRF(SRTN,"RA")),"^",2) I X="C" S SROPER="* "_SROPER
"RTN","SROALSS",30,0)
 K SROPS,MM,MMM S:$L(SROPER)<34 SROPS(1)=SROPER I $L(SROPER)>33 S SROPER=SROPER_"  " F M=1:1 D LOOP Q:MMM=""
"RTN","SROALSS",31,0)
 S SRSS=$P(SRA(0),"^",4),SRSS=$S(SRSS:$P(^SRO(137.45,SRSS,0),"^"),1:"SPECIALTY NOT ENTERED")
"RTN","SROALSS",32,0)
 D TECH^SROPRIN
"RTN","SROALSS",33,0)
 S Y=$P(SRA(0),"^",9) D D^DIQ S SRDT=$P(Y,"@")
"RTN","SROALSS",34,0)
 S (SRDOC,Y)=$P($G(^SRF(SRTN,.1)),"^",4),C=$P(^DD(130,.14,0),"^",2) D:Y'="" Y^DIQ I $L(Y)>18 S Z=$P(Y,",")_","_$E($P(Y,",",2))_".",Y=Z
"RTN","SROALSS",35,0)
 S SRDOC=Y
"RTN","SROALSS",36,0)
 Q
"RTN","SROALSS",37,0)
PRINT ;
"RTN","SROALSS",38,0)
 U IO S SRSS="",SRTC=0 D HDR
"RTN","SROALSS",39,0)
 F  S SRSS=$O(^TMP("SRA",$J,SRSS)) Q:SRSS=""!SRSOUT  S SRC=0 D SS S SRTN=0 F  S SRTN=$O(^TMP("SRA",$J,SRSS,SRTN)) D:'SRTN SSCT Q:'SRTN!SRSOUT  D SET,CASE
"RTN","SROALSS",40,0)
 Q:SRSOUT!SRFLG  I $Y+5>IOSL D PAGE Q:SRSOUT  D HDR
"RTN","SROALSS",41,0)
 W !!,"TOTAL CASES FOR ALL SPECIALTIES: ",SRTC
"RTN","SROALSS",42,0)
 Q
"RTN","SROALSS",43,0)
CASE ; print a case
"RTN","SROALSS",44,0)
 S SRC=SRC+1,SRTC=SRTC+1
"RTN","SROALSS",45,0)
 I $Y+5>IOSL D PAGE Q:SRSOUT
"RTN","SROALSS",46,0)
 W !,SRTN,?20,SRANM_"  "_VA("PID"),?55,STATUS,!,SRDT,?20,SROPS(1),?55,SRTECH
"RTN","SROALSS",47,0)
 W !,SRDOC W:$D(SROPS(2)) ?20,SROPS(2) W ?55,SREXCL
"RTN","SROALSS",48,0)
 I $D(SROPS(3)) W !,?20,SROPS(3) I $D(SROPS(4)) W !,?20,SROPS(4)
"RTN","SROALSS",49,0)
 W ! Q
"RTN","SROALSS",50,0)
SS ; print surgical specialty
"RTN","SROALSS",51,0)
 I $Y+5>IOSL D PAGE Q:SRSOUT
"RTN","SROALSS",52,0)
 W !,"** SURGICAL SPECIALTY: ",SRSS," **",! Q
"RTN","SROALSS",53,0)
PAGE W !!,"Press <RET> to continue, or '^' to quit  " R X:DTIME I '$T!(X["^") S SRSOUT=1 Q
"RTN","SROALSS",54,0)
 I X["?" W !!,"If you want to continue listing assessments, enter <RET>.  Enter '^' to",!,"return to the menu." G PAGE
"RTN","SROALSS",55,0)
HDR ; print heading
"RTN","SROALSS",56,0)
 S SRHD="ALL SURGICAL CASES BY SURGICAL SPECIALTY"
"RTN","SROALSS",57,0)
 W @IOF,!,?(80-$L(SRHD)\2),SRHD,!,?(80-$L(SRFRTO)\2),SRFRTO
"RTN","SROALSS",58,0)
 W !!,"CASE #",?20,"PATIENT",?55,"ASSESSMENT STATUS",!,"OPERATION DATE",?20,"PRINCIPAL OPERATIVE PROCEDURE",?55,"ANESTHESIA TECHNIQUE",!,"SURGEON",?55,"EXCLUSION CRITERIA",! F L=1:1:80 W "="
"RTN","SROALSS",59,0)
 W ! Q
"RTN","SROALSS",60,0)
OTHER ; other operations
"RTN","SROALSS",61,0)
 S SRLONG=1 I $L(SROPER)+$L($P(^SRF(SRTN,13,SROTHER,0),"^"))>125 S SRLONG=0,OPER=999,SROPERS=" ..."
"RTN","SROALSS",62,0)
 I SRLONG S SROPERS=$P(^SRF(SRTN,13,SROTHER,0),"^")
"RTN","SROALSS",63,0)
 S SROPER=SROPER_$S(SROPERS'=" ...":", "_SROPERS,1:SROPERS)
"RTN","SROALSS",64,0)
 Q
"RTN","SROALSS",65,0)
LOOP ; break procedures
"RTN","SROALSS",66,0)
 S SROPS(M)="" F LOOP=1:1 S MM=$P(SROPER," "),MMM=$P(SROPER," ",2,200) Q:MMM=""  Q:$L(SROPS(M))+$L(MM)'<34  S SROPS(M)=SROPS(M)_MM_" ",SROPER=MMM
"RTN","SROALSS",67,0)
 Q
"RTN","SROALSS",68,0)
SSCT ; write specialty count
"RTN","SROALSS",69,0)
 I $Y+5>IOSL D PAGE Q:SRSOUT
"RTN","SROALSS",70,0)
 W !,"TOTAL ",SRSS,": ",SRC,! F L=1:1:80 W "-"
"RTN","SROALSS",71,0)
 Q
"RTN","SROALSSP")
0^17^B18279057
"RTN","SROALSSP",1,0)
SROALSSP ;B'HAM ISC/AM - ASSESSMENTS BY SPECIALTY (PRINTER) ; [ 04/02/01  8:33 AM ]
"RTN","SROALSSP",2,0)
 ;;3.0; Surgery ;**32,47,50,100**;24 Jun 93
"RTN","SROALSSP",3,0)
START S SRSOUT=0 K ^TMP("SRA",$J)
"RTN","SROALSSP",4,0)
 F  S SRSD=$O(^SRF("AC",SRSD)) Q:'SRSD!(SRSD>SRED)  S SRTN=0 F  S SRTN=$O(^SRF("AC",SRSD,SRTN)) Q:'SRTN  I $D(^SRF(SRTN,0)),$$DIV^SROUTL0(SRTN) D UTL
"RTN","SROALSSP",5,0)
 D PRINT Q
"RTN","SROALSSP",6,0)
UTL ; write to ^TMP("SRA,$J)
"RTN","SROALSSP",7,0)
 S SRA(0)=^SRF(SRTN,0)
"RTN","SROALSSP",8,0)
 S CAN=$P($G(^SRF(SRTN,30)),"^") I CAN Q
"RTN","SROALSSP",9,0)
 S CAN=$P($G(^SRF(SRTN,31)),"^",8) I CAN'="" Q
"RTN","SROALSSP",10,0)
 S X=$P($G(^SRF(SRTN,.2)),"^",12) I 'X Q
"RTN","SROALSSP",11,0)
 I SRFLG,$P(^SRF(SRTN,0),"^",4)'=SRASP Q
"RTN","SROALSSP",12,0)
 S SRSS=$P(^SRF(SRTN,0),"^",4),SRSS=$S(SRSS:$P(^SRO(137.45,SRSS,0),"^"),1:"SPECIALTY NOT ENTERED")
"RTN","SROALSSP",13,0)
 S TYPE=$P($G(^SRF(SRTN,"RA")),"^",2) I SRSS="SPECIALTY NOT ENTERED",TYPE="C" S SRSS="N/A"
"RTN","SROALSSP",14,0)
 S ^TMP("SRA",$J,SRSS,SRTN)=""
"RTN","SROALSSP",15,0)
 Q
"RTN","SROALSSP",16,0)
SET ; set variables
"RTN","SROALSSP",17,0)
 N SRCOMMA
"RTN","SROALSSP",18,0)
 S SRA("RA")=$G(^SRF(SRTN,"RA")),X=$P(SRA("RA"),"^"),STATUS=$S(X="I":"INCOMPLETE",X="C":"COMPLETED",X="T":"TRANSMITTED",1:"EXCLUSION")
"RTN","SROALSSP",19,0)
 S (SREXCL,Y)=$P(SRA("RA"),"^",7),C=$P(^DD(130,102,0),"^",2) D Y^DIQ S SREXCL=Y
"RTN","SROALSSP",20,0)
 I SREXCL="",STATUS="EXCLUSION" S STATUS="NO ASSESSMENT"
"RTN","SROALSSP",21,0)
 S SRA(0)=^SRF(SRTN,0),DFN=$P(SRA(0),"^") N I D DEM^VADPT S SRANM=VADM(1),SRASSN=VA("PID") K VADM
"RTN","SROALSSP",22,0)
 S X=^SRF(SRTN,"OP"),SROPER=$P(X,"^"),Y=$P(X,"^",2),SRCPT=$S(Y:$P($$CPT^ICPTCOD(Y),"^",2),1:"NO CPT") I SRCPT,$O(^SRF(SRTN,"OPMOD",0)) D
"RTN","SROALSSP",23,0)
 .S (SRCOMMA,SRI)=0,SRCMOD="",SRCPT=SRCPT_"-" F  S SRI=$O(^SRF(SRTN,"OPMOD",SRI)) Q:'SRI  D
"RTN","SROALSSP",24,0)
 ..S SRM=$P(^SRF(SRTN,"OPMOD",SRI,0),"^"),SRCMOD=$P($$MOD^ICPTMOD(SRM,"I"),"^",2)
"RTN","SROALSSP",25,0)
 ..S SRCPT=SRCPT_$S(SRCOMMA:",",1:"")_SRCMOD,SRCOMMA=1
"RTN","SROALSSP",26,0)
 S SROPER=SROPER_" ("_SRCPT_")"
"RTN","SROALSSP",27,0)
 I $O(^SRF(SRTN,13,0)) S SROTHER=0 F I=0:0 S SROTHER=$O(^SRF(SRTN,13,SROTHER)) Q:'SROTHER  D OTHER
"RTN","SROALSSP",28,0)
 S X=$P($G(^SRF(SRTN,"RA")),"^",2) I X="C" S SROPER="* "_SROPER
"RTN","SROALSSP",29,0)
 K SROPS,MM,MMM S:$L(SROPER)<34 SROPS(1)=SROPER I $L(SROPER)>33 S SROPER=SROPER_"  " F M=1:1 D LOOP Q:MMM=""
"RTN","SROALSSP",30,0)
 S SRSS=$P(SRA(0),"^",4),SRSS=$S(SRSS:$P(^SRO(137.45,SRSS,0),"^"),1:"SPECIALTY NOT ENTERED")
"RTN","SROALSSP",31,0)
 D TECH^SROPRIN
"RTN","SROALSSP",32,0)
 S Y=$P(SRA(0),"^",9) D D^DIQ S SRDT=$P(Y,"@")
"RTN","SROALSSP",33,0)
 S (SRDOC,Y)=$P($G(^SRF(SRTN,.1)),"^",4),C=$P(^DD(130,.14,0),"^",2) D:Y'="" Y^DIQ I $L(Y)>23 S Z=$P(Y,",")_","_$E($P(Y,",",2))_".",Y=Z
"RTN","SROALSSP",34,0)
 S SRDOC=Y
"RTN","SROALSSP",35,0)
 Q
"RTN","SROALSSP",36,0)
PRINT ;
"RTN","SROALSSP",37,0)
 U IO S SRSS="",(SRTC,SRPAGE)=0 D HDR Q:SRSOUT
"RTN","SROALSSP",38,0)
 F  S SRSS=$O(^TMP("SRA",$J,SRSS)) Q:SRSS=""!SRSOUT  S SRC=0 D SS S SRTN=0 F  S SRTN=$O(^TMP("SRA",$J,SRSS,SRTN)) D:'SRTN SSCT Q:'SRTN!SRSOUT  D SET,CASE
"RTN","SROALSSP",39,0)
 Q:SRFLG  I $Y+5>IOSL D HDR Q:SRSOUT
"RTN","SROALSSP",40,0)
 W !!,"TOTAL MAJOR CASES FOR ALL SPECIALTIES: ",SRTC
"RTN","SROALSSP",41,0)
 Q
"RTN","SROALSSP",42,0)
CASE ; print a case
"RTN","SROALSSP",43,0)
 S SRC=SRC+1,SRTC=SRTC+1
"RTN","SROALSSP",44,0)
 I $Y+5>IOSL D HDR Q:SRSOUT  W !!,"SURGICAL SPECIALTY: ",SRSS,!
"RTN","SROALSSP",45,0)
 W !,SRTN,?20,SRANM_"  "_VA("PID"),?67,STATUS,?107,SRTECH,!,SRDT,?20,SROPS(1),?67,SREXCL W ?107,SRDOC
"RTN","SROALSSP",46,0)
 I $D(SROPS(2)) W !,?20,SROPS(2) I $D(SROPS(3)) W !,?20,SROPS(3) I $D(SROPS(4)) W !,?20,SROPS(4)
"RTN","SROALSSP",47,0)
 W ! Q
"RTN","SROALSSP",48,0)
SS ; print surgical specialty
"RTN","SROALSSP",49,0)
 I $Y+5>IOSL D HDR Q:SRSOUT
"RTN","SROALSSP",50,0)
 W !!,"SURGICAL SPECIALTY: ",SRSS,! Q
"RTN","SROALSSP",51,0)
HDR ; print heading
"RTN","SROALSSP",52,0)
 I $D(ZTQUEUED) D ^SROSTOP I SRHALT S SRSOUT=1 Q
"RTN","SROALSSP",53,0)
 S SRHD="ALL SURGICAL CASES BY SURGICAL SPECIALTY",SRPAGE=SRPAGE+1
"RTN","SROALSSP",54,0)
 W:$Y @IOF W !,?(132-$L(SRHD)\2),SRHD,?120,"PAGE "_SRPAGE,!,?(132-$L(SRINST)\2),SRINST,!,?58,"SURGERY SERVICE",?100,"DATE REVIEWED:"
"RTN","SROALSSP",55,0)
 W !,?(132-$L(SRFRTO)\2),SRFRTO,?100,"REVIEWED BY:"
"RTN","SROALSSP",56,0)
 W !!,"CASE #",?20,"PATIENT",?67,"ASSESSMENT STATUS",?107,"ANESTHESIA TECHNIQUE",!,"OPERATION DATE",?20,"PRINCIPAL OPERATIVE PROCEDURE",?67,"EXCLUSION CRITERIA",?107,"SURGEON",! F L=1:1:132 W "="
"RTN","SROALSSP",57,0)
 Q
"RTN","SROALSSP",58,0)
OTHER ; other operations
"RTN","SROALSSP",59,0)
 S SRLONG=1 I $L(SROPER)+$L($P(^SRF(SRTN,13,SROTHER,0),"^"))>165 S SRLONG=0,OPER=999,SROPERS=" ..."
"RTN","SROALSSP",60,0)
 I SRLONG S SROPERS=$P(^SRF(SRTN,13,SROTHER,0),"^")
"RTN","SROALSSP",61,0)
 S SROPER=SROPER_$S(SROPERS'=" ...":", "_SROPERS,1:SROPERS)
"RTN","SROALSSP",62,0)
 Q
"RTN","SROALSSP",63,0)
LOOP ; break procedures
"RTN","SROALSSP",64,0)
 S SROPS(M)="" F LOOP=1:1 S MM=$P(SROPER," "),MMM=$P(SROPER," ",2,200) Q:MMM=""  Q:$L(SROPS(M))+$L(MM)'<44  S SROPS(M)=SROPS(M)_MM_" ",SROPER=MMM
"RTN","SROALSSP",65,0)
 Q
"RTN","SROALSSP",66,0)
SSCT ; write specialty count
"RTN","SROALSSP",67,0)
 I $Y+5>IOSL D HDR Q:SRSOUT
"RTN","SROALSSP",68,0)
 W !!,"TOTAL ",SRSS,": ",SRC,! F L=1:1:132 W "-"
"RTN","SROALSSP",69,0)
 Q
"RTN","SROALST")
0^18^B14176066
"RTN","SROALST",1,0)
SROALST ;B'HAM ISC/MAM - ALL ASSESSMENTS ; [ 04/02/01  8:33 AM ]
"RTN","SROALST",2,0)
 ;;3.0; Surgery ;**38,47,50,100**;24 Jun 93
"RTN","SROALST",3,0)
 I $E(IOST)="P" D ^SROALSTP Q
"RTN","SROALST",4,0)
 S SRSOUT=0 D HDR F  S SRSD=$O(^SRF("AC",SRSD)) Q:'SRSD!(SRSD>SRED)!SRSOUT  S SRTN=0 F  S SRTN=$O(^SRF("AC",SRSD,SRTN)) Q:'SRTN!SRSOUT  I $D(^SRF(SRTN,0)),$$DIV^SROUTL0(SRTN) D SET
"RTN","SROALST",5,0)
 Q
"RTN","SROALST",6,0)
SET ; print assessments
"RTN","SROALST",7,0)
 N SRCOMMA
"RTN","SROALST",8,0)
 I $Y+5>IOSL D PAGE I SRSOUT Q
"RTN","SROALST",9,0)
 S SRA(0)=^SRF(SRTN,0)
"RTN","SROALST",10,0)
 S CAN=$P($G(^SRF(SRTN,30)),"^") I CAN Q
"RTN","SROALST",11,0)
 S CAN=$P($G(^SRF(SRTN,31)),"^",8) I CAN'="" Q
"RTN","SROALST",12,0)
 S X=$P($G(^SRF(SRTN,.2)),"^",12) I 'X Q
"RTN","SROALST",13,0)
 S DFN=$P(SRA(0),"^") N I D DEM^VADPT S SRANM=VADM(1),SRASSN=VA("PID") K VADM
"RTN","SROALST",14,0)
 S SRA("RA")=$G(^SRF(SRTN,"RA")),X=$P(SRA("RA"),"^"),STATUS=$S(X="I":"INCOMPLETE",X="C":"COMPLETED",X="T":"TRANSMITTED",1:"EXCLUSION")
"RTN","SROALST",15,0)
 S (SREXCL,Y)=$P(SRA("RA"),"^",7),C=$P(^DD(130,102,0),"^",2) D Y^DIQ S SREXCL=Y
"RTN","SROALST",16,0)
 I SREXCL="",STATUS="EXCLUSION" S STATUS="NO ASSESSMENT"
"RTN","SROALST",17,0)
 S X=^SRF(SRTN,"OP"),SROPER=$P(X,"^"),Y=$P(X,"^",2),SRCPT=$S(Y:$P($$CPT^ICPTCOD(Y),"^",2),1:"NO CPT") I SRCPT,$O(^SRF(SRTN,"OPMOD",0)) D
"RTN","SROALST",18,0)
 .S (SRCOMMA,SRI)=0,SRCMOD="",SRCPT=SRCPT_"-" F  S SRI=$O(^SRF(SRTN,"OPMOD",SRI)) Q:'SRI  D
"RTN","SROALST",19,0)
 ..S SRM=$P(^SRF(SRTN,"OPMOD",SRI,0),"^"),SRCMOD=$P($$MOD^ICPTMOD(SRM,"I"),"^",2)
"RTN","SROALST",20,0)
 ..S SRCPT=SRCPT_$S(SRCOMMA:",",1:"")_SRCMOD,SRCOMMA=1
"RTN","SROALST",21,0)
 S SROPER=SROPER_" ("_SRCPT_")"
"RTN","SROALST",22,0)
 I $O(^SRF(SRTN,13,0)) S SROTHER=0 F I=0:0 S SROTHER=$O(^SRF(SRTN,13,SROTHER)) Q:'SROTHER  D OTHER
"RTN","SROALST",23,0)
 S X=$P($G(^SRF(SRTN,"RA")),"^",2) I X="C" S SROPER="* "_SROPER
"RTN","SROALST",24,0)
 K SROPS,MM,MMM S:$L(SROPER)<34 SROPS(1)=SROPER I $L(SROPER)>33 S SROPER=SROPER_"  " F M=1:1 D LOOP Q:MMM=""
"RTN","SROALST",25,0)
 S SRSS=$P(SRA(0),"^",4),SRSS=$S(SRSS:$P(^SRO(137.45,SRSS,0),"^"),1:"SPECIALTY NOT ENTERED")
"RTN","SROALST",26,0)
 D TECH^SROPRIN
"RTN","SROALST",27,0)
 S Y=$P(SRA(0),"^",9) D D^DIQ S SRDT=$P(Y,"@")
"RTN","SROALST",28,0)
 S (SRDOC,Y)=$P($G(^SRF(SRTN,.1)),"^",4),C=$P(^DD(130,.14,0),"^",2) D:Y'="" Y^DIQ I $L(Y)>18 S Z=$P(Y,",")_","_$E($P(Y,",",2))_".",Y=Z
"RTN","SROALST",29,0)
 S SRDOC=Y
"RTN","SROALST",30,0)
 W !,SRTN,?20,SRANM_" "_VA("PID"),?55,$P(SRSS,"("),!,SRDT,?20,SROPS(1),?55,SRTECH,!,STATUS W:$D(SROPS(2)) ?20,SROPS(2) W ?55,SREXCL
"RTN","SROALST",31,0)
 W !,SRDOC I $D(SROPS(3)) W ?20,SROPS(3) I $D(SROPS(4)) W !,?20,SROPS(4)
"RTN","SROALST",32,0)
 W ! F LINE=1:1:80 W "-"
"RTN","SROALST",33,0)
 Q
"RTN","SROALST",34,0)
OTHER ; other operations
"RTN","SROALST",35,0)
 S SRLONG=1 I $L(SROPER)+$L($P(^SRF(SRTN,13,SROTHER,0),"^"))>125 S SRLONG=0,SROTHER=999,SROPERS=" ..."
"RTN","SROALST",36,0)
 I SRLONG S SROPERS=$P(^SRF(SRTN,13,SROTHER,0),"^")
"RTN","SROALST",37,0)
 S SROPER=SROPER_$S(SROPERS'=" ...":", "_SROPERS,1:SROPERS)
"RTN","SROALST",38,0)
 Q
"RTN","SROALST",39,0)
LOOP ; break procedures
"RTN","SROALST",40,0)
 S SROPS(M)="" F LOOP=1:1 S MM=$P(SROPER," "),MMM=$P(SROPER," ",2,200) Q:MMM=""  Q:$L(SROPS(M))+$L(MM)'<34  S SROPS(M)=SROPS(M)_MM_" ",SROPER=MMM
"RTN","SROALST",41,0)
 Q
"RTN","SROALST",42,0)
PAGE W !!,"Press <RET> to continue, or '^' to quit  " R X:DTIME I '$T!(X["^") S SRSOUT=1 Q
"RTN","SROALST",43,0)
 I X["?" W !!,"If you want to continue listing incomplete assessments, enter <RET>.  Enter",!,"'^' to return to the menu." G PAGE
"RTN","SROALST",44,0)
HDR S SRHD="ALL SURGICAL CASES"
"RTN","SROALST",45,0)
 W @IOF,!,?(80-$L(SRHD)\2),SRHD,!,?(80-$L(SRFRTO)\2),SRFRTO
"RTN","SROALST",46,0)
 W !!,"CASE #",?20,"PATIENT",?55,"SURGICAL SPECIALTY",!,"OPERATION DATE",?20,"PRINCIPAL OPERATION",?55,"ANESTHESIA TECHNIQUE",!,"ASSESSMENT STATUS",?55,"EXCLUSION CRITERIA",!,"SURGEON",! F LINE=1:1:80 W "="
"RTN","SROALST",47,0)
 Q
"RTN","SROALSTP")
0^19^B13266033
"RTN","SROALSTP",1,0)
SROALSTP ;B'HAM ISC/MAM - ALL CASES ; [ 04/02/01  8:33 AM ]
"RTN","SROALSTP",2,0)
 ;;3.0; Surgery ;**32,47,50,100**;24 Jun 93
"RTN","SROALSTP",3,0)
 S SRPAGE=1,(SRSOUT,SRDFN)=0 D HDR Q:SRSOUT
"RTN","SROALSTP",4,0)
 F  S SRSD=$O(^SRF("AC",SRSD)) Q:'SRSD!(SRSD>SRED)!SRSOUT  S SRTN=0 F  S SRTN=$O(^SRF("AC",SRSD,SRTN)) Q:'SRTN!SRSOUT  I $D(^SRF(SRTN,0)),$$DIV^SROUTL0(SRTN) D SET
"RTN","SROALSTP",5,0)
 Q
"RTN","SROALSTP",6,0)
SET ; print assessments
"RTN","SROALSTP",7,0)
 N SRCOMMA
"RTN","SROALSTP",8,0)
 I $Y+5>IOSL S SRPAGE=SRPAGE+1 D HDR I SRSOUT Q
"RTN","SROALSTP",9,0)
 S SRA(0)=^SRF(SRTN,0),DFN=$P(SRA(0),"^") N I D DEM^VADPT S SRANM=VADM(1),SRASSN=VA("PID") K VADM
"RTN","SROALSTP",10,0)
 S CAN=$P($G(^SRF(SRTN,30)),"^") I CAN Q
"RTN","SROALSTP",11,0)
 S CAN=$P($G(^SRF(SRTN,31)),"^",8) I CAN'="" Q
"RTN","SROALSTP",12,0)
 S X=$P($G(^SRF(SRTN,.2)),"^",12) I 'X Q
"RTN","SROALSTP",13,0)
 S SRA("RA")=$G(^SRF(SRTN,"RA")),X=$P(SRA("RA"),"^"),STATUS=$S(X="I":"INCOMPLETE",X="C":"COMPLETED",X="T":"TRANSMITTED",1:"EXCLUSION")
"RTN","SROALSTP",14,0)
 S (SREXCL,Y)=$P(SRA("RA"),"^",7),C=$P(^DD(130,102,0),"^",2) D Y^DIQ S SREXCL=Y
"RTN","SROALSTP",15,0)
 I SREXCL="",STATUS="EXCLUSION" S STATUS="NO ASSESSMENT"
"RTN","SROALSTP",16,0)
 S X=^SRF(SRTN,"OP"),SROPER=$P(X,"^"),Y=$P(X,"^",2),SRCPT=$S(Y:$P($$CPT^ICPTCOD(Y),"^",2),1:"NO CPT") I SRCPT,$O(^SRF(SRTN,"OPMOD",0)) D
"RTN","SROALSTP",17,0)
 .S (SRCOMMA,SRI)=0,SRCMOD="",SRCPT=SRCPT_"-" F  S SRI=$O(^SRF(SRTN,"OPMOD",SRI)) Q:'SRI  D
"RTN","SROALSTP",18,0)
 ..S SRM=$P(^SRF(SRTN,"OPMOD",SRI,0),"^"),SRCMOD=$P($$MOD^ICPTMOD(SRM,"I"),"^",2)
"RTN","SROALSTP",19,0)
 ..S SRCPT=SRCPT_$S(SRCOMMA:",",1:"")_SRCMOD,SRCOMMA=1
"RTN","SROALSTP",20,0)
 S SROPER=SROPER_" ("_SRCPT_")"
"RTN","SROALSTP",21,0)
 I $O(^SRF(SRTN,13,0)) S SROTHER=0 F I=0:0 S SROTHER=$O(^SRF(SRTN,13,SROTHER)) Q:'SROTHER  D OTHER
"RTN","SROALSTP",22,0)
 S X=$P($G(^SRF(SRTN,"RA")),"^",2) I X="C" S SROPER="* "_SROPER
"RTN","SROALSTP",23,0)
 K SROPS,MM,MMM S:$L(SROPER)<34 SROPS(1)=SROPER I $L(SROPER)>33 S SROPER=SROPER_"  " F M=1:1 D LOOP Q:MMM=""
"RTN","SROALSTP",24,0)
 S SRSS=$P(SRA(0),"^",4),SRSS=$S(SRSS:$P(^SRO(137.45,SRSS,0),"^"),1:"SPECIALTY NOT ENTERED")
"RTN","SROALSTP",25,0)
 D TECH^SROPRIN
"RTN","SROALSTP",26,0)
 S Y=$P(SRA(0),"^",9) D D^DIQ S SRDT=$P(Y,"@")
"RTN","SROALSTP",27,0)
 S (SRDOC,Y)=$P($G(^SRF(SRTN,.1)),"^",4),C=$P(^DD(130,.14,0),"^",2) D:Y'="" Y^DIQ I $L(Y)>23 S Z=$P(Y,",")_","_$E($P(Y,",",2))_".",Y=Z
"RTN","SROALSTP",28,0)
 S SRDOC=Y
"RTN","SROALSTP",29,0)
 W !,SRTN,?20,SRANM_" "_VA("PID"),?67,$P(SRSS,"("),?107,SRTECH,!,SRDT,?20,SROPS(1),?67,STATUS,?107,SREXCL,!
"RTN","SROALSTP",30,0)
 W:$D(SROPS(2)) ?20,SROPS(2) W ?107,SRDOC
"RTN","SROALSTP",31,0)
 I $D(SROPS(3)) W !,?20,SROPS(3) I $D(SROPS(4)) W !,?20,SROPS(4)
"RTN","SROALSTP",32,0)
 W !
"RTN","SROALSTP",33,0)
 Q
"RTN","SROALSTP",34,0)
OTHER ; other operations
"RTN","SROALSTP",35,0)
 S SRLONG=1 I $L(SROPER)+$L($P(^SRF(SRTN,13,SROTHER,0),"^"))>165 S SRLONG=0,SROTHER=999,SROPERS=" ..."
"RTN","SROALSTP",36,0)
 I SRLONG S SROPERS=$P(^SRF(SRTN,13,SROTHER,0),"^")
"RTN","SROALSTP",37,0)
 S SROPER=SROPER_$S(SROPERS'=" ...":", "_SROPERS,1:SROPERS)
"RTN","SROALSTP",38,0)
 Q
"RTN","SROALSTP",39,0)
LOOP ; break procedures
"RTN","SROALSTP",40,0)
 S SROPS(M)="" F LOOP=1:1 S MM=$P(SROPER," "),MMM=$P(SROPER," ",2,200) Q:MMM=""  Q:$L(SROPS(M))+$L(MM)'<44  S SROPS(M)=SROPS(M)_MM_" ",SROPER=MMM
"RTN","SROALSTP",41,0)
 Q
"RTN","SROALSTP",42,0)
HDR ; print heading
"RTN","SROALSTP",43,0)
 I $D(ZTQUEUED) D ^SROSTOP I SRHALT S SRSOUT=1 Q
"RTN","SROALSTP",44,0)
 W:$Y @IOF W !,?56,"ALL SURGICAL CASES",?120,"PAGE "_SRPAGE,!,?(132-$L(SRINST)\2),SRINST,!,?58,"SURGERY SERVICE",?100,"DATE REVIEWED:"
"RTN","SROALSTP",45,0)
 W !,?(132-$L(SRFRTO)\2),SRFRTO,?100,"REVIEWED BY:"
"RTN","SROALSTP",46,0)
 W !!,"CASE #",?20,"PATIENT",?67,"SURGICAL SPECIALTY",?107,"ANESTHESIA TECHNIQUE",!,"OPERATION DATE",?20,"PRINCIPAL OPERATIVE PROCEDURE",?67,"ASSESSMENT STATUS",?107,"EXCLUSION CRITERIA",!,?107,"SURGEON",!
"RTN","SROALSTP",47,0)
 F LINE=1:1:132 W "="
"RTN","SROALSTP",48,0)
 Q
"RTN","SROANEW")
0^20^B18219189
"RTN","SROANEW",1,0)
SROANEW ;B'HAM ISC/MAM - CREATE NEW RISK ASSESSMENT ; [ 02/19/02  9:12 AM ]
"RTN","SROANEW",2,0)
 ;;3.0; Surgery ;**34,47,71,100**;24 Jun 93
"RTN","SROANEW",3,0)
 W @IOF,!,?1,VADM(1)_"  "_VA("PID")
"RTN","SROANEW",4,0)
 W !! S (SRDT,CNT)=0 F I=0:0 S SRDT=$O(^SRF("ADT",DFN,SRDT)) Q:'SRDT!(SRSOUT)  S SRASS=0 F I=0:0 S SRASS=$O(^SRF("ADT",DFN,SRDT,SRASS)) Q:'SRASS!($D(SRTN))!(SRSOUT)  D LIST I $D(SRTN) G ASK
"RTN","SROANEW",5,0)
 I 'CNT W "No operations exist for this patient.  Assessment cannot be entered.",!!,"Press RETURN to continue... " R X:DTIME G END
"RTN","SROANEW",6,0)
OPT W !!,"Select Operation: " R X:DTIME I '$T!("^"[X) S SRSOUT=1 G END
"RTN","SROANEW",7,0)
 I '$D(SRCASE(X)) W !!,"Enter the number of the desired operation" W $S('$D(SRNEWOP):".",1:", or '"_CNT_"' to enter a new case.") G OPT
"RTN","SROANEW",8,0)
 S SRTN=+SRCASE(X)
"RTN","SROANEW",9,0)
ASK I $P($G(^SRF(SRTN,"RA")),"^",6)="N"!($P($G(^SRF(SRTN,"RA")),"^",7)'="") W !!,"This case is currently flagged as meeting Risk Assessment exclusion criteria.",$C(7)
"RTN","SROANEW",10,0)
 W !!,"Are you sure that you want to create a Risk Assessment for this surgical",!,"case ?  YES// " R SRYN:DTIME I '$T!(SRYN["^") K SRTN S SRSOUT=1 Q
"RTN","SROANEW",11,0)
 S SRYN=$E(SRYN) I "YyNn"'[SRYN W !!,"Enter 'YES' to create an assessment for this surgical case, or 'NO' to quit",!,"this option." G ASK
"RTN","SROANEW",12,0)
 I "Yy"'[SRYN K SRTN S SRSOUT=1 Q
"RTN","SROANEW",13,0)
 I $$LOCK^SROUTL(SRTN) D  D UNLOCK^SROUTL(SRTN) Q
"RTN","SROANEW",14,0)
 .I $P($G(^SRF(SRTN,"RA")),"^",6)="N"!($P($G(^SRF(SRTN,"RA")),"^",7)'="") D DRDEL^SRONASS
"RTN","SROANEW",15,0)
 .K DIE,DR,DA S DA=SRTN,DIE=130,DR="284////"_SRATYPE_";Q;323////Y;235////I" D ^DIE K DR,DIE,DA
"RTN","SROANEW",16,0)
 E  K SRTN
"RTN","SROANEW",17,0)
 Q
"RTN","SROANEW",18,0)
LIST ; list assessments
"RTN","SROANEW",19,0)
 I $P($G(^SRF(SRASS,"NON")),"^")="Y" Q
"RTN","SROANEW",20,0)
 S SRSCAN=1 I $D(^SRF(SRASS,.2)),$P(^(.2),"^",12)'="" K SRSCAN
"RTN","SROANEW",21,0)
 I $D(SRSCAN),$P($G(^SRF(SRASS,30)),"^") Q
"RTN","SROANEW",22,0)
 I $D(SRSCAN),$P($G(^SRF(SRASS,31)),"^",8) Q
"RTN","SROANEW",23,0)
 I $D(^SRF(SRASS,37)),$P(^(37),"^") Q
"RTN","SROANEW",24,0)
 I $Y+5>IOSL S SRBACK=0 D SEL Q:$D(SRTN)!(SRSOUT)  I SRBACK S CNT=0,SRASS=SRCASE(1)-1,SRDT=$P(SRCASE(1),"^",2) W @IOF,!,?1,VADM(1)_"   "_VA("PID"),! Q
"RTN","SROANEW",25,0)
 S CNT=CNT+1,SRSDATE=$P(^SRF(SRASS,0),"^",9)
"RTN","SROANEW",26,0)
DISP S SROPER=$P(^SRF(SRASS,"OP"),"^") I $O(^SRF(SRASS,13,0)) S SROTHER=0 F I=0:0 S SROTHER=$O(^SRF(SRASS,13,SROTHER)) Q:'SROTHER  D OTHER
"RTN","SROANEW",27,0)
 S SR("RA")=$G(^SRF(SRASS,"RA")) I "N"'[$P(SR("RA"),"^",6) S CNT=CNT-1 Q
"RTN","SROANEW",28,0)
 S SROP=SRASS D ^SROP1
"RTN","SROANEW",29,0)
 K SROPS,MM,MMM S:$L(SROPER)<65 SROPS(1)=SROPER I $L(SROPER)>64 S SROPER=SROPER_"  " F M=1:1 D LOOP Q:MMM=""
"RTN","SROANEW",30,0)
 I '$D(SRTN) W CNT_". "
"RTN","SROANEW",31,0)
CASE W $E(SRSDATE,4,5)_"-"_$E(SRSDATE,6,7)_"-"_$E(SRSDATE,2,3),?14,SROPS(1) I $D(SROPS(2)) W !,?14,SROPS(2) I $D(SROPS(3)) W !,?14,SROPS(3)
"RTN","SROANEW",32,0)
 I $D(SROPS(4)) W !,?14,SROPS(4)
"RTN","SROANEW",33,0)
 I $D(SRTN) Q
"RTN","SROANEW",34,0)
 W !! S SRCASE(CNT)=SRASS_"^"_SRDT
"RTN","SROANEW",35,0)
 Q
"RTN","SROANEW",36,0)
OTHER ; other operations
"RTN","SROANEW",37,0)
 S SRLONG=1 I $L(SROPER)+$L($P(^SRF(SRASS,13,SROTHER,0),"^"))>235 S SRLONG=0,SROTHER=999,SROPERS=" ..."
"RTN","SROANEW",38,0)
 I SRLONG S SROPERS=$P(^SRF(SRASS,13,SROTHER,0),"^")
"RTN","SROANEW",39,0)
 S SROPER=SROPER_$S(SROPERS'=" ...":", "_SROPERS,1:SROPERS)
"RTN","SROANEW",40,0)
 Q
"RTN","SROANEW",41,0)
LOOP ; break procedures
"RTN","SROANEW",42,0)
 S SROPS(M)="" F LOOP=1:1 S MM=$P(SROPER," "),MMM=$P(SROPER," ",2,200) Q:MMM=""  Q:$L(SROPS(M))+$L(MM)'<65  S SROPS(M)=SROPS(M)_MM_" ",SROPER=MMM
"RTN","SROANEW",43,0)
 Q
"RTN","SROANEW",44,0)
SEL ; select case
"RTN","SROANEW",45,0)
 W !!!,"Select Operation, or enter <RET> to continue listing Procedures: " R X:DTIME I '$T!(X["^") S SRSOUT=1 Q
"RTN","SROANEW",46,0)
 I X="" W @IOF,!,?1,VADM(1)_"  "_VA("PID"),!! Q
"RTN","SROANEW",47,0)
 I '$D(SRCASE(X)) W !!,"Please enter the number corresponding to the Surgical Case you want to edit.",!,"If the case desired does not appear, enter <RET> to continue listing",!,"additional cases."
"RTN","SROANEW",48,0)
 I '$D(SRCASE(X)) W !!,"Press <RET> to continue  " R X:DTIME S:'$T SRSOUT=1 S SRBACK=1 Q
"RTN","SROANEW",49,0)
 S SRTN=+SRCASE(X)
"RTN","SROANEW",50,0)
 Q
"RTN","SROANEW",51,0)
TYPE K DR,DIE S DR="284////"_SRATYPE,DIE=139,DA=SRTN D ^DIE
"RTN","SROANEW",52,0)
 K DR,DA,DIE S DR="235////I",DIE=139,DA=SRTN D ^DIE K DR
"RTN","SROANEW",53,0)
END D ^SRSKILL W @IOF
"RTN","SROANEW",54,0)
 Q
"RTN","SROANIN")
0^21^B5016187
"RTN","SROANIN",1,0)
SROANIN ;B'HAM ISC/MAM - ENTER ANESTHESIA AMIS INFO; [ 01/29/01  9:15 PM ]
"RTN","SROANIN",2,0)
 ;;3.0; Surgery ;**38,52,67,100**;24 Jun 93
"RTN","SROANIN",3,0)
BEG W:'$D(SRTN) !!,"An operation must be selected !",! G:'$D(SRTN) END D ^SROLOCK G:SROLOCK END
"RTN","SROANIN",4,0)
 W @IOF,!!,"The following information is required for the Anesthesia AMIS and for Risk",!,"Assessment.",!
"RTN","SROANIN",5,0)
 I '$$LOCK^SROUTL(SRTN) G END
"RTN","SROANIN",6,0)
 K DR,SRODR S DR="[SROANES-AMIS]",DIE=130,DA=SRTN D ^DIE K DR S Y=$P($G(^SRF(SRTN,.3)),"^",9) I Y S C=$P(^DD(130,901,0),"^",2) D Y^DIQ W !,"Airway Index: "_Y
"RTN","SROANIN",7,0)
 I $D(SRODR) D ^SROCON1
"RTN","SROANIN",8,0)
MORE W !!,"Would you like to enter additional anesthesia related information ? NO// " R X:DTIME S:'$T X="^"
"RTN","SROANIN",9,0)
 S:X="" X="N" S X=$E(X) I X="^" G END
"RTN","SROANIN",10,0)
 I X["?"!("NnYy"'[X) W !!,"If you would like to enter anesthesia information in addition to what is",!,"required for the Anesthesia AMIS, enter 'YES'.  Enter RETURN to leave this",!,"option.",!! G MORE
"RTN","SROANIN",11,0)
 S:X="" X="N" S X=$E(X) I "Nn"[X W @IOF G END
"RTN","SROANIN",12,0)
 D RT K DR,DIC S DIE=130,DA=SRTN,DR="[SROMEN-ANES]",ST="ANESTHESIA INFO" D EN2^SROVAR,^SRCUSS I $D(SRODR) D ^SROCON1
"RTN","SROANIN",13,0)
 D UNLOCK^SROUTL(SRTN)
"RTN","SROANIN",14,0)
 S SROERR=SRTN D ^SROERR0
"RTN","SROANIN",15,0)
END D ^SRSKILL
"RTN","SROANIN",16,0)
 Q
"RTN","SROANIN",17,0)
RT ; start RT logging
"RTN","SROANIN",18,0)
 I $D(XRTL) S XRTN="SROANIN" D T0^%ZOSV
"RTN","SROANIN",19,0)
 Q
"RTN","SROANR")
0^22^B14108247
"RTN","SROANR",1,0)
SROANR ;BIR/ADM - ANESTHESIA REPORT ; [ 02/14/04  12:45 PM ]
"RTN","SROANR",2,0)
 ;;3.0; Surgery ;**100**;24 Jun 93
"RTN","SROANR",3,0)
 ;
"RTN","SROANR",4,0)
 ;** NOTICE: This routine is part of an implementation of a nationally
"RTN","SROANR",5,0)
 ;**         controlled procedure.  Local modifications to this routine
"RTN","SROANR",6,0)
 ;**         are prohibited.
"RTN","SROANR",7,0)
 ;
"RTN","SROANR",8,0)
 D:'$D(SRTN) ^SROPS Q:'$D(SRTN)
"RTN","SROANR",9,0)
 D RPT(SRTN)
"RTN","SROANR",10,0)
 Q
"RTN","SROANR",11,0)
RPT(SRTN) ; send text of anesthesia report to ^TMP
"RTN","SROANR",12,0)
 N ANE,C,DFN,J,JJ,SR,SRCASE,SRG,SRI,SRL,SRN,SROR,X,Y K ^TMP("SRANE",$J)
"RTN","SROANR",13,0)
 S SRCASE=SRTN,SRG="^TMP(""SRANE"",$J,SRCASE)",SRI=0
"RTN","SROANR",14,0)
 I $P($G(^SRF(SRTN,30)),"^")!$P($G(^SRF(SRTN,31)),"^",8) D LINE(1) S @SRG@(SRI)="  * * "_$S($P($G(^SRF(SRTN,"NON")),"^")="Y":"PROCEDURE",1:"OPERATION")_" ABORTED * *" D LINE(1)
"RTN","SROANR",15,0)
 F SRN=0:.1:1.1,"NON" S SR(SRN)=$G(^SRF(SRTN,SRN))
"RTN","SROANR",16,0)
 S SROR="NOT ENTERED" S X=$P(SR(0),"^",2) I X S X=$P(^SRS(X,0),"^"),X=$P(^SC(X,0),"^"),SROR=$E(X,1,24)
"RTN","SROANR",17,0)
 I $P(SR("NON"),"^")="Y" S X=$P(SR("NON"),"^",2) I X S X=$P(^SC(X,0),"^"),SROR=X
"RTN","SROANR",18,0)
 D LINE(1) S @SRG@(SRI)=$S($P(SR("NON"),"^")="Y":"Location: ",1:"Operating Room: ")_SROR
"RTN","SROANR",19,0)
 S Y=$P(SR(.3),"^"),C=$P(^DD(130,.31,0),"^",2) D:Y'="" Y^DIQ,N(25) S:Y="" Y="* NOT ENTERED *" D LINE(2) S @SRG@(SRI)="Anesthetist: "_Y
"RTN","SROANR",20,0)
 S Y=$P(SR(.3),"^",2),C=$P(^DD(130,.32,0),"^",2) D:Y'="" Y^DIQ,N(24) S @SRG@(SRI)=@SRG@(SRI)_$$SPACE(40)_"Relief Anesth: "_Y
"RTN","SROANR",21,0)
 S Y=$P(SR(.3),"^",4),C=$P(^DD(130,.34,0),"^",2) D:Y'="" Y^DIQ,N(20) D LINE(1) S @SRG@(SRI)="Anesthesiologist: "_Y
"RTN","SROANR",22,0)
 S Y=$P(SR(.3),"^",3),C=$P(^DD(130,.33,0),"^",2) D:Y'="" Y^DIQ,N(20) S @SRG@(SRI)=@SRG@(SRI)_$$SPACE(40)_"Assist Anesth: "_Y
"RTN","SROANR",23,0)
 S Y=$P(SR(.3),"^",6),C=$P(^DD(130,.345,0),"^",2) D:Y'="" Y^DIQ D LINE(1) S @SRG@(SRI)="Attending Code: "_Y
"RTN","SROANR",24,0)
 D TIMES
"RTN","SROANR",25,0)
 S Y=$P(SR(1.1),"^",3),C=$P(^DD(130,1.13,0),"^",2) D:Y'="" Y^DIQ S:Y="" Y="* NOT ENTERED *" D LINE(2) S @SRG@(SRI)="ASA Class: "_Y
"RTN","SROANR",26,0)
 S Y=$P(SR(.4),"^",6),C=$P(^DD(130,.46,0),"^",2) D:Y'="" Y^DIQ S:Y="" Y="* NOT ENTERED *" D LINE(2) S @SRG@(SRI)="Operation Disposition: "_Y
"RTN","SROANR",27,0)
 D TECH^SROANR0
"RTN","SROANR",28,0)
 D PRIN I $O(^SRF(SRTN,13,0)) D OTHER
"RTN","SROANR",29,0)
 I $O(^SRF(SRTN,22,0)) D LINE(2) S @SRG@(SRI)="Medications:" D MED^SROANR0
"RTN","SROANR",30,0)
 D ^SROANR1
"RTN","SROANR",31,0)
 Q
"RTN","SROANR",32,0)
N(SRL) N SRN I $L(Y)>SRL S SRN=$P(Y,",")_","_$E($P(Y,",",2))_".",Y=SRN
"RTN","SROANR",33,0)
 Q
"RTN","SROANR",34,0)
TIMES ; anesthesia start and end times
"RTN","SROANR",35,0)
 N AB,AE,OB,OE
"RTN","SROANR",36,0)
 S AB="* NOT ENTERED *",Y=$P(SR(.2),"^") I Y D D^DIQ S AB=$P(Y,"@")_"  "_$P(Y,"@",2)
"RTN","SROANR",37,0)
 S AE="* NOT ENTERED *",Y=$P(SR(.2),"^",4) I Y D D^DIQ S AE=$P(Y,"@")_"  "_$P(Y,"@",2)
"RTN","SROANR",38,0)
 D LINE(2) S @SRG@(SRI)="Anes Begin:  "_AB S @SRG@(SRI)=@SRG@(SRI)_$$SPACE(40)_"Anes End:  "_AE
"RTN","SROANR",39,0)
 Q
"RTN","SROANR",40,0)
PRIN ; principal procedure information
"RTN","SROANR",41,0)
 N CNT,I,LOOP,M,MM,MMM,SRJ,SROPER,SROPS,SRX,SRY,SRZ,X,Z
"RTN","SROANR",42,0)
 D LINE(2) S @SRG@(SRI)="Procedure(s) Performed:"
"RTN","SROANR",43,0)
PRIN2 S SROPER=$P(^SRF(SRTN,"OP"),"^")
"RTN","SROANR",44,0)
 S SROPER="Principal: "_SROPER
"RTN","SROANR",45,0)
 S:$L(SROPER)<74 SROPS(1)=SROPER I $L(SROPER)>73 S SROPER=SROPER_"  " F M=1:1 D LOOP Q:MMM=""
"RTN","SROANR",46,0)
 F I=1:1 Q:'$D(SROPS(I))  D LINE(1) S @SRG@(SRI)=$S(I=1:"",1:"  ")_SROPS(I)
"RTN","SROANR",47,0)
 Q
"RTN","SROANR",48,0)
LOOP ; break procedure if greater than 74 characters
"RTN","SROANR",49,0)
 S SROPS(M)="" F LOOP=1:1 S MM=$P(SROPER," "),MMM=$P(SROPER," ",2,200) Q:MMM=""  Q:$L(SROPS(M))+$L(MM)'<74  S SROPS(M)=SROPS(M)_MM_" ",SROPER=MMM
"RTN","SROANR",50,0)
 Q
"RTN","SROANR",51,0)
OTHER ; other procedures
"RTN","SROANR",52,0)
 N CNT,OTH,OTHER,SRJ,SRX,SRY,SRZ,Z
"RTN","SROANR",53,0)
 S (OTH,CNT)=0 F  S OTH=$O(^SRF(SRTN,13,OTH)) Q:'OTH  S CNT=CNT+1 D OTH
"RTN","SROANR",54,0)
 Q
"RTN","SROANR",55,0)
OTH S OTHER=$P(^SRF(SRTN,13,OTH,0),"^")
"RTN","SROANR",56,0)
 D LINE(1) S @SRG@(SRI)="Other: "_OTHER
"RTN","SROANR",57,0)
 Q
"RTN","SROANR",58,0)
SPACE(NUM) ; create spaces
"RTN","SROANR",59,0)
 ; pass in position returns number of needed spaces
"RTN","SROANR",60,0)
 I '$D(@SRG@(SRI)) S @SRG@(SRI)=""
"RTN","SROANR",61,0)
 Q $J("",NUM-$L(@SRG@(SRI)))
"RTN","SROANR",62,0)
LINE(NUM) ; create carriage returns
"RTN","SROANR",63,0)
 F J=1:1:NUM S SRI=SRI+1,@SRG@(SRI)=""
"RTN","SROANR",64,0)
 Q
"RTN","SROANR0")
0^23^B26261663
"RTN","SROANR0",1,0)
SROANR0 ;BIR/ADM - ANESTHESIA REPORT ; [ 09/09/03  12:45 PM ]
"RTN","SROANR0",2,0)
 ;;3.0; Surgery ;**100**;24 Jun 93
"RTN","SROANR0",3,0)
 ;
"RTN","SROANR0",4,0)
 ;** NOTICE: This routine is part of an implementation of a nationally
"RTN","SROANR0",5,0)
 ;**         controlled procedure.  Local modifications to this routine
"RTN","SROANR0",6,0)
 ;**         are prohibited.
"RTN","SROANR0",7,0)
 ;
"RTN","SROANR0",8,0)
TECH D LINE(2) S @SRG@(SRI)="Anesthesia Technique(s): " D
"RTN","SROANR0",9,0)
 .I '$O(^SRF(SRTN,6,0)) S @SRG@(SRI)=@SRG@(SRI)_"* NOT ENTERED *" Q
"RTN","SROANR0",10,0)
 .S ANE=0 F  S ANE=$O(^SRF(SRTN,6,ANE)) Q:'ANE  D ANE
"RTN","SROANR0",11,0)
 Q
"RTN","SROANR0",12,0)
ANE ; print anesthesia technique
"RTN","SROANR0",13,0)
 N A,AGNT,C,CNT
"RTN","SROANR0",14,0)
 S A=^SRF(SRTN,6,ANE,0),Y=$P(A,"^"),C=$P(^DD(130.06,.01,0),"^",2) D:Y'="" Y^DIQ D LINE(1) S Y=Y_$S($P(A,"^",3)="Y":"  (PRINCIPAL)",1:""),@SRG@(SRI)=Y D AGENT
"RTN","SROANR0",15,0)
 D INFO
"RTN","SROANR0",16,0)
 Q
"RTN","SROANR0",17,0)
AGENT ; print agents
"RTN","SROANR0",18,0)
 Q:$P(A,"^")="N"
"RTN","SROANR0",19,0)
 D LINE(1) S @SRG@(SRI)="  Agent: " I '$O(^SRF(SRTN,6,ANE,1,0)) S @SRG@(SRI)=@SRG@(SRI)_"NONE ENTERED" Q
"RTN","SROANR0",20,0)
 S (AGNT,CNT)=0 F  S AGNT=$O(^SRF(SRTN,6,ANE,1,AGNT)) Q:'AGNT  S CNT=CNT+1 D
"RTN","SROANR0",21,0)
 .S Y=$P(^SRF(SRTN,6,ANE,1,AGNT,0),"^"),C=$P(^DD(130.47,.01,0),"^",2) D Y^DIQ
"RTN","SROANR0",22,0)
 .D:CNT>1 LINE(1) S @SRG@(SRI)=@SRG@(SRI)_$$SPACE(13)_Y
"RTN","SROANR0",23,0)
 Q
"RTN","SROANR0",24,0)
INFO ; anesthesia technique information
"RTN","SROANR0",25,0)
 N C,SRFLG,I,S,X,Y F I=2,3,8 S S(I)=$G(^SRF(SRTN,6,ANE,I))
"RTN","SROANR0",26,0)
 I $P(S(8),"^")="Y" D LINE(1) S @SRG@(SRI)="  MONITORED ANESTHESIA CARE"
"RTN","SROANR0",27,0)
 I $P(S(8),"^",2)'="" D LINE(1) S @SRG@(SRI)="  Intubated: "_$S($P(S(8),"^",2)="Y":"YES",1:"NO")
"RTN","SROANR0",28,0)
 S S=^SRF(SRTN,6,ANE,0),(Y,SRFLG)=$P(S,"^",5),C=$P(^DD(130.06,3,0),"^",2) D:Y'="" Y^DIQ I Y'="" D LINE(1) S @SRG@(SRI)="  Approach: "_Y
"RTN","SROANR0",29,0)
 I $P(S,"^",6)'="" S Y=$P(S,"^",6),C=$P(^DD(130.06,4,0),"^",2) D:Y'="" Y^DIQ I Y'="" D:SRFLG="" LINE(1) S @SRG@(SRI)=@SRG@(SRI)_$$SPACE(40)_"Route: "_Y
"RTN","SROANR0",30,0)
 S Y=$P(S,"^",7),C=$P(^DD(130.06,5,0),"^",2) D:Y'="" Y^DIQ I Y'="" D LINE(1) S @SRG@(SRI)="  Laryngoscope Type: "_Y
"RTN","SROANR0",31,0)
 S Y=$P(S,"^",8),C=$P(^DD(130.06,6,0),"^",2) D:Y'="" Y^DIQ I Y'="" D LINE(1) S @SRG@(SRI)="  Laryngoscope Size: "_Y
"RTN","SROANR0",32,0)
 S (Y,SRFLG)=$P(S,"^",9),C=$P(^DD(130.06,7,0),"^",2) D:Y'="" Y^DIQ I Y'="" D LINE(1) S @SRG@(SRI)="  Stylet Used: "_Y
"RTN","SROANR0",33,0)
 S Y=$P(S,"^",10),C=$P(^DD(130.06,8,0),"^",2) D:Y'="" Y^DIQ I Y'="" D:SRFLG="" LINE(1) S @SRG@(SRI)=@SRG@(SRI)_$$SPACE(40)_"Lidocaine Topical: "_Y
"RTN","SROANR0",34,0)
 S Y=$P(S,"^",11),C=$P(^DD(130.06,9,0),"^",2) D:Y'="" Y^DIQ I Y'="" D LINE(1) S @SRG@(SRI)="  Lidocaine IV: "_Y
"RTN","SROANR0",35,0)
 S (Y,SRFLG)=$P(S,"^",12),C=$P(^DD(130.06,10,0),"^",2) D:Y'="" Y^DIQ I Y'="" D LINE(1) S @SRG@(SRI)="  Tube Type: "_Y
"RTN","SROANR0",36,0)
 I $P(S,"^",13) D:SRFLG="" LINE(1) S @SRG@(SRI)=@SRG@(SRI)_$$SPACE(40)_"Tube Size: "_$P(S,"^",13)
"RTN","SROANR0",37,0)
 S Y=$P(S,"^",14),C=$P(^DD(130.06,12,0),"^",2) D:Y'="" Y^DIQ I Y'="" D LINE(1) S @SRG@(SRI)="  Trauma: "_Y
"RTN","SROANR0",38,0)
 S (Y,SRFLG)=$P(S,"^",23),C=$P(^DD(130.06,21,0),"^",2) D:Y'="" Y^DIQ I Y'="" D LINE(1) S @SRG@(SRI)="  Extubated In: "_Y
"RTN","SROANR0",39,0)
 S Y=$P($G(^SRF(SRTN,6,ANE,6)),"^"),C=$P(^DD(130.06,39,0),"^",2) D:Y'="" Y^DIQ I Y'="" D:SRFLG="" LINE(1) S @SRG@(SRI)=@SRG@(SRI)_$$SPACE(40)_"Extubated By: "_$S($L(Y)>25:$P(Y,",")_","_$P(Y,",",2)_".",1:Y)
"RTN","SROANR0",40,0)
 I $P(S,"^",24)="Y" D LINE(1) S @SRG@(SRI)="  Reintubated within 8 Hours: YES"
"RTN","SROANR0",41,0)
 I $P(S,"^",19)="Y" D LINE(1) S @SRG@(SRI)="  Heat, Moisture Exchanger Used: YES"
"RTN","SROANR0",42,0)
 I $P(S,"^",20)="Y" D LINE(1) S @SRG@(SRI)="  Bacteria Filter in Circuit: YES"
"RTN","SROANR0",43,0)
 S (Y,SRFLG)=$P(S(2),"^") I Y'="" D LINE(1) S @SRG@(SRI)="  Continuous: "_$S(Y="Y":"YES",1:"NO")
"RTN","SROANR0",44,0)
 S Y=$P(S(2),"^",2) I Y'="" S Y=$S(Y=1:"HYPERBARIC",Y=2:"HYPOBARIC",1:"ISOBARIC") D:SRFLG="" LINE(1) S @SRG@(SRI)=@SRG@(SRI)_$$SPACE(40)_"Baricity: "_Y
"RTN","SROANR0",45,0)
 S (Y,SRFLG)=$P(S(2),"^",3),C=$P(^DD(130.06,27,0),"^",2) D:Y'="" Y^DIQ I Y'="" D LINE(1) S @SRG@(SRI)="  Puncture Site: "_Y
"RTN","SROANR0",46,0)
 S Y=$P(S(2),"^",5),C=$P(^DD(130.06,29,0),"^",2) D:Y'="" Y^DIQ I Y'="" D:SRFLG="" LINE(1) S @SRG@(SRI)=@SRG@(SRI)_$$SPACE(40)_"Needle Size: "_Y
"RTN","SROANR0",47,0)
 S (Y,SRFLG)=$P(S(8),"^",3),C=$P(^DD(130.06,43,0),"^",2) I Y'="" D Y^DIQ D LINE(1) S @SRG@(SRI)="  Level: "_Y
"RTN","SROANR0",48,0)
 Q
"RTN","SROANR0",49,0)
MED ; medications
"RTN","SROANR0",50,0)
 N ADBY,ADM,C,CNT,COMMENT,DOSE,MED,MM,ORBY,ROUTE,TIME,X,Y
"RTN","SROANR0",51,0)
 S (CNT,MED)=0 F  S MED=$O(^SRF(SRTN,22,MED)) Q:'MED  S CNT=CNT+1 D
"RTN","SROANR0",52,0)
 .S Y=$P(^SRF(SRTN,22,MED,0),"^"),C=$P(^DD(130.33,.01,0),"^",2) D Y^DIQ,LINE(1) S @SRG@(SRI)="  "_Y,ADM=0 F  S ADM=$O(^SRF(SRTN,22,MED,1,ADM)) Q:'ADM  D
"RTN","SROANR0",53,0)
 ..S MM=^SRF(SRTN,22,MED,1,ADM,0),Y=$P(MM,"^") D D^DIQ S TIME=$P(Y,"@")_"  "_$P(Y,"@",2)
"RTN","SROANR0",54,0)
 ..S DOSE=$P(MM,"^",2),X=$P(MM,"^",3) S:X="" ORBY="N/A" I X S Y=$P(^VA(200,X,0),"^") D N(20) S ORBY=Y
"RTN","SROANR0",55,0)
 ..S X=$P(MM,"^",4) S:X="" ADBY="N/A" I X S Y=$P(^VA(200,X,0),"^") D N(29) S ADBY=Y
"RTN","SROANR0",56,0)
 ..S Y=$P(MM,"^",5),C=$P(^DD(130.34,4,0),"^",2) D:Y'="" Y^DIQ S ROUTE=Y
"RTN","SROANR0",57,0)
 ..S COMMENT=$P(MM,"^",6) S:COMMENT="" COMMENT="N/A"
"RTN","SROANR0",58,0)
 ..D LINE(1) S @SRG@(SRI)="    Time Administered: "_TIME D LINE(1) S @SRG@(SRI)="      Route: "_ROUTE,@SRG@(SRI)=@SRG@(SRI)_$$SPACE(40)_"Dosage: "_DOSE
"RTN","SROANR0",59,0)
 ..D LINE(1) S @SRG@(SRI)="      Ordered By: "_ORBY S @SRG@(SRI)=@SRG@(SRI)_$$SPACE(40)_"Admin By: "_ADBY
"RTN","SROANR0",60,0)
 ..D LINE(1) S @SRG@(SRI)="      Comments: "_COMMENT
"RTN","SROANR0",61,0)
 Q
"RTN","SROANR0",62,0)
N(SRL) N SRN I $L(Y)>SRL S SRN=$P(Y,",")_","_$E($P(Y,",",2))_".",Y=SRN
"RTN","SROANR0",63,0)
 Q
"RTN","SROANR0",64,0)
SPACE(NUM) ;create spaces
"RTN","SROANR0",65,0)
 ;pass in position returns number of needed spaces
"RTN","SROANR0",66,0)
 I '$D(@SRG@(SRI)) S @SRG@(SRI)=""
"RTN","SROANR0",67,0)
 Q $J("",NUM-$L(@SRG@(SRI)))
"RTN","SROANR0",68,0)
LINE(NUM) ;create carriage returns
"RTN","SROANR0",69,0)
 F J=1:1:NUM S SRI=SRI+1,@SRG@(SRI)=""
"RTN","SROANR0",70,0)
 Q
"RTN","SROANR1")
0^24^B11861888
"RTN","SROANR1",1,0)
SROANR1 ;BIR/ADM - ANESTHESIA REPORT ; [ 09/09/03  12:45 PM ]
"RTN","SROANR1",2,0)
 ;;3.0; Surgery ;**100**;24 Jun 93
"RTN","SROANR1",3,0)
 ;
"RTN","SROANR1",4,0)
 ;** NOTICE: This routine is part of an implementation of a nationally
"RTN","SROANR1",5,0)
 ;**         controlled procedure.  Local modifications to this routine
"RTN","SROANR1",6,0)
 ;**         are prohibited.
"RTN","SROANR1",7,0)
 ;
"RTN","SROANR1",8,0)
 N C,SRLINE,SRT,X,Y
"RTN","SROANR1",9,0)
 S X=$P(SR(.3),"^",7) I X'="" D LINE(2) S @SRG@(SRI)="Min Intraoperative Temp: "_X
"RTN","SROANR1",10,0)
 I $O(^SRF(SRTN,27,0)) D LINE(2) S @SRG@(SRI)="Monitors:" D MON
"RTN","SROANR1",11,0)
 I $O(^SRF(SRTN,4,0)) D LINE(2) S @SRG@(SRI)="Blood Replacement Fluids:" D REP
"RTN","SROANR1",12,0)
 D LINE(2) S Y=$P(SR(.2),"^",5) S:Y'="" Y=Y_" ml" S @SRG@(SRI)="Intraoperative Blood Loss: "_Y
"RTN","SROANR1",13,0)
 S Y=$P(SR(.2),"^",16) S:Y'="" Y=Y_" ml" S @SRG@(SRI)=@SRG@(SRI)_$$SPACE(40)_"Urine Output: "_Y
"RTN","SROANR1",14,0)
 D LINE(1) S @SRG@(SRI)="PAC(U) Admit Score: "_$P(SR(1.1),"^"),@SRG@(SRI)=@SRG@(SRI)_$$SPACE(40)_"PAC(U) Discharge Score: "_$P(SR(1.1),"^",2)
"RTN","SROANR1",15,0)
 I $O(^SRF(SRTN,5,0)) D LINE(2) S @SRG@(SRI)="General Comments:" S SRLINE=0 D
"RTN","SROANR1",16,0)
 .F  S SRLINE=$O(^SRF(SRTN,5,SRLINE)) Q:'SRLINE  S X=^SRF(SRTN,5,SRLINE,0) D COMM(X,2)
"RTN","SROANR1",17,0)
NOTE S Y=$P(SR(1.1),"^",9) D:Y D^DIQ S SRT=$S(Y'="":$P(Y,"@")_"  "_$P(Y,"@",2),1:"") D LINE(2) S @SRG@(SRI)="Postop Anesthesia Note Date/Time: "_SRT
"RTN","SROANR1",18,0)
 I $O(^SRF(SRTN,48,0)) D LINE(1) S @SRG@(SRI)="Postop Anesthesia Note:" S SRLINE=0 D
"RTN","SROANR1",19,0)
 .F  S SRLINE=$O(^SRF(SRTN,48,SRLINE)) Q:'SRLINE  S X=^SRF(SRTN,48,SRLINE,0) D COMM(X,2)
"RTN","SROANR1",20,0)
 Q
"RTN","SROANR1",21,0)
N(SRL) N SRN I $L(Y)>SRL S SRN=$P(Y,",")_","_$E($P(Y,",",2))_".",Y=SRN
"RTN","SROANR1",22,0)
 Q
"RTN","SROANR1",23,0)
MON ; monitors
"RTN","SROANR1",24,0)
 N C,MON,SRM,SRT,Y
"RTN","SROANR1",25,0)
 S MON=0 F  S MON=$O(^SRF(SRTN,27,MON)) Q:'MON  S SRM=^SRF(SRTN,27,MON,0) D
"RTN","SROANR1",26,0)
 .S Y=$P(SRM,"^"),C=$P(^DD(130.41,.01,0),"^",2) D:Y'="" Y^DIQ D LINE(1) S @SRG@(SRI)="  "_Y
"RTN","SROANR1",27,0)
 .S Y=$P(SRM,"^",4),C=$P(^DD(130.41,3,0),"^",2) D:Y'="" Y^DIQ,N(27) S:Y="" Y="N/A" S @SRG@(SRI)=@SRG@(SRI)_$$SPACE(40)_"Applied By: "_Y
"RTN","SROANR1",28,0)
 .S Y=$P(SRM,"^",2) D:Y D^DIQ S SRT=$S(Y'="":$P(Y,"@")_"  "_$P(Y,"@",2),1:"N/A") D LINE(1) S @SRG@(SRI)="    Installed: "_SRT
"RTN","SROANR1",29,0)
 .S Y=$P(SRM,"^",3) D:Y D^DIQ S SRT=$S(Y'="":$P(Y,"@")_"  "_$P(Y,"@",2),1:"N/A") S @SRG@(SRI)=@SRG@(SRI)_$$SPACE(40)_"Removed: "_SRT
"RTN","SROANR1",30,0)
 Q
"RTN","SROANR1",31,0)
REP ; blood replacement fluids
"RTN","SROANR1",32,0)
 N C,REP,SRLINE,SRX,X,Y
"RTN","SROANR1",33,0)
 S REP=0 F  S REP=$O(^SRF(SRTN,4,REP)) Q:'REP  S SRX=^SRF(SRTN,4,REP,0) D
"RTN","SROANR1",34,0)
 .S Y=$P(SRX,"^"),C=$P(^DD(130.04,.01,0),"^",2) D:Y'="" Y^DIQ D LINE(1) S @SRG@(SRI)="  "_Y
"RTN","SROANR1",35,0)
 .S Y=$P(SRX,"^",2),Y=$S(Y="":"N/A",1:Y_" ml"),@SRG@(SRI)=@SRG@(SRI)_$$SPACE(40)_"Quantity: "_Y
"RTN","SROANR1",36,0)
 .S Y=$P(SRX,"^",4),Y=$S(Y="":"N/A",1:Y) D LINE(1) S @SRG@(SRI)="    Source ID: "_Y
"RTN","SROANR1",37,0)
 .S Y=$P(SRX,"^",5),Y=$S(Y="":"N/A",1:Y) D LINE(1) S @SRG@(SRI)="    VA ID: "_Y
"RTN","SROANR1",38,0)
 Q
"RTN","SROANR1",39,0)
COMM(X,NUM) ; output word-processing text
"RTN","SROANR1",40,0)
 ; X = line of text to be processed
"RTN","SROANR1",41,0)
 ; NUM = left margin
"RTN","SROANR1",42,0)
 N I,J,K,Y,SRL S SRL=80-NUM
"RTN","SROANR1",43,0)
 I $L(X)<(SRL+1)!($E(X,1,SRL)'[" ") D LINE(1) S @SRG@(SRI)=$$SPACE(NUM)_X Q
"RTN","SROANR1",44,0)
 S K=1 F  D  I $L(X)<SRL+1 S X(K)=X Q
"RTN","SROANR1",45,0)
 .F I=0:1:SRL-1 S J=SRL-I,Y=$E(X,J) I Y=" " S X(K)=$E(X,1,J-1),X=$E(X,J+1,$L(X)) S K=K+1 Q
"RTN","SROANR1",46,0)
 F I=1:1:K D LINE(1) S @SRG@(SRI)=$$SPACE(NUM)_X(I)
"RTN","SROANR1",47,0)
 Q
"RTN","SROANR1",48,0)
SPACE(NUM) ;create spaces
"RTN","SROANR1",49,0)
 ;pass in position returns number of needed spaces
"RTN","SROANR1",50,0)
 I '$D(@SRG@(SRI)) S @SRG@(SRI)=""
"RTN","SROANR1",51,0)
 Q $J("",NUM-$L(@SRG@(SRI)))
"RTN","SROANR1",52,0)
LINE(NUM) ;create carriage returns
"RTN","SROANR1",53,0)
 F J=1:1:NUM S SRI=SRI+1,@SRG@(SRI)=""
"RTN","SROANR1",54,0)
 Q
"RTN","SROANT")
0^25^B12088246
"RTN","SROANT",1,0)
SROANT ;B'HAM ISC/MAM - INCOMPLETE ASSESSMENTS ; [ 05/30/01  2:33 PM ]
"RTN","SROANT",2,0)
 ;;3.0; Surgery ;**38,50,100**;24 Jun 93
"RTN","SROANT",3,0)
 I $E(IOST)="P" D ^SROANTP Q
"RTN","SROANT",4,0)
 S SRSOUT=0 D HDR
"RTN","SROANT",5,0)
 F  S SRSD=$O(^SRF("AC",SRSD)) Q:'SRSD!(SRSD>SRED)!SRSOUT  S SRTN=0 F  S SRTN=$O(^SRF("AC",SRSD,SRTN)) Q:'SRTN!SRSOUT  S SR("RA")=$G(^SRF(SRTN,"RA")) I $P(SR("RA"),"^")="I",$D(^SRF(SRTN,0)),$$DIV^SROUTL0(SRTN) D SET
"RTN","SROANT",6,0)
 Q
"RTN","SROANT",7,0)
SET ; print assessments
"RTN","SROANT",8,0)
 I $P(SR("RA"),"^",6)="N" Q
"RTN","SROANT",9,0)
 I $Y+5>IOSL D PAGE I SRSOUT Q
"RTN","SROANT",10,0)
 N SRCOMMA
"RTN","SROANT",11,0)
 S SRA(0)=^SRF(SRTN,0),DFN=$P(SRA(0),"^") N I D DEM^VADPT S SRANM=VADM(1),SRASSN=VA("PID") K VADM
"RTN","SROANT",12,0)
 I $L(SRANM)>19 S SRANM=$P(SRANM,",")_","_$E($P(SRANM,",",2))_"."
"RTN","SROANT",13,0)
 S X=^SRF(SRTN,"OP"),SROPER=$P(X,"^"),Y=$P(X,"^",2),SRCPT=$S(Y:$P($$CPT^ICPTCOD(Y),"^",2),1:"NO CPT") I SRCPT,$O(^SRF(SRTN,"OPMOD",0)) D
"RTN","SROANT",14,0)
 .S (SRCOMMA,SRI)=0,SRCMOD="",SRCPT=SRCPT_"-" F  S SRI=$O(^SRF(SRTN,"OPMOD",SRI)) Q:'SRI  D
"RTN","SROANT",15,0)
 ..S SRM=$P(^SRF(SRTN,"OPMOD",SRI,0),"^"),SRCMOD=$P($$MOD^ICPTMOD(SRM,"I"),"^",2)
"RTN","SROANT",16,0)
 ..S SRCPT=SRCPT_$S(SRCOMMA:",",1:"")_SRCMOD,SRCOMMA=1
"RTN","SROANT",17,0)
 S SROPER=SROPER_" ("_SRCPT_")"
"RTN","SROANT",18,0)
 I $O(^SRF(SRTN,13,0)) S SROTHER=0 F  S SROTHER=$O(^SRF(SRTN,13,SROTHER)) Q:'SROTHER  D OTHER
"RTN","SROANT",19,0)
 S X=$P($G(^SRF(SRTN,"RA")),"^",2) I X="C" S SROPER="* "_SROPER
"RTN","SROANT",20,0)
 K SROPS,MM,MMM S:$L(SROPER)<34 SROPS(1)=SROPER I $L(SROPER)>33 S SROPER=SROPER_"  " F M=1:1 D LOOP Q:MMM=""
"RTN","SROANT",21,0)
 S SRSS=$P(SRA(0),"^",4),SRSS=$S(SRSS:$P(^SRO(137.45,SRSS,0),"^"),1:"SPECIALTY NOT ENTERED")
"RTN","SROANT",22,0)
 D TECH^SROPRIN
"RTN","SROANT",23,0)
 S Y=$P(SRA(0),"^",9) D D^DIQ S SRDT=$P(Y,"@")
"RTN","SROANT",24,0)
 S (SRDOC,Y)=$P($G(^SRF(SRTN,.1)),"^",4),C=$P(^DD(130,.14,0),"^",2) D:Y'="" Y^DIQ I $L(Y)>18 S Z=$P(Y,",")_","_$E($P(Y,",",2))_".",Y=Z
"RTN","SROANT",25,0)
 S SRDOC=Y
"RTN","SROANT",26,0)
 W !,SRTN,?20,SRANM_" "_VA("PID"),?55,$P(SRSS,"("),!,SRDT,?20,SROPS(1),?55,SRTECH,!,SRDOC I $D(SROPS(2)) W !,?20,SROPS(2) I $D(SROPS(3)) W !,?20,SROPS(3)
"RTN","SROANT",27,0)
 W ! F LINE=1:1:80 W "-"
"RTN","SROANT",28,0)
 Q
"RTN","SROANT",29,0)
OTHER ; other operations
"RTN","SROANT",30,0)
 S SRLONG=1 I $L(SROPER)+$L($P(^SRF(SRTN,13,SROTHER,0),"^"))>125 S SRLONG=0,SROTHER=999,SROPERS=" ..."
"RTN","SROANT",31,0)
 I SRLONG S SROPERS=$P(^SRF(SRTN,13,SROTHER,0),"^")
"RTN","SROANT",32,0)
 S SROPER=SROPER_$S(SROPERS'=" ...":", "_SROPERS,1:SROPERS)
"RTN","SROANT",33,0)
 Q
"RTN","SROANT",34,0)
LOOP ; break procedures
"RTN","SROANT",35,0)
 S SROPS(M)="" F LOOP=1:1 S MM=$P(SROPER," "),MMM=$P(SROPER," ",2,200) Q:MMM=""  Q:$L(SROPS(M))+$L(MM)'<34  S SROPS(M)=SROPS(M)_MM_" ",SROPER=MMM
"RTN","SROANT",36,0)
 Q
"RTN","SROANT",37,0)
PAGE W !!,"Press <RET> to continue, or '^' to quit  " R X:DTIME I '$T!(X["^") S SRSOUT=1 Q
"RTN","SROANT",38,0)
 I X["?" W !!,"If you want to continue listing incomplete assessments, enter <RET>.  Enter",!,"'^' to return to the menu." G PAGE
"RTN","SROANT",39,0)
HDR W @IOF,!,?26,"INCOMPLETE RISK ASSESSMENTS",!,?(80-$L(SRFRTO)\2),SRFRTO,!!,"ASSESSMENT #",?20,"PATIENT",?55,"SURGICAL SPECIALTY"
"RTN","SROANT",40,0)
 W !,"OPERATION DATE",?20,"PRINCIPAL OPERATION",?55,"ANESTHESIA TECHNIQUE",!,"SURGEON",! F LINE=1:1:80 W "="
"RTN","SROANT",41,0)
 Q
"RTN","SROANTP")
0^26^B12272179
"RTN","SROANTP",1,0)
SROANTP ;B'HAM ISC/MAM - INCOMPLETE ASSESSMENTS (PRINTER) ; [ 05/30/01  2:33 PM ]
"RTN","SROANTP",2,0)
 ;;3.0; Surgery ;**32,50,100**;24 Jun 93
"RTN","SROANTP",3,0)
 S SRPAGE=1,(SRSOUT,SRDFN)=0 D HDR Q:SRSOUT
"RTN","SROANTP",4,0)
 F  S SRSD=$O(^SRF("AC",SRSD)) Q:'SRSD!(SRSD>SRED)!SRSOUT  S SRTN=0 F  S SRTN=$O(^SRF("AC",SRSD,SRTN)) Q:'SRTN!SRSOUT  S SR("RA")=$G(^SRF(SRTN,"RA")) I $P(SR("RA"),"^")="I",$D(^SRF(SRTN,0)),$$DIV^SROUTL0(SRTN) D SET
"RTN","SROANTP",5,0)
 Q
"RTN","SROANTP",6,0)
SET ; print assessments
"RTN","SROANTP",7,0)
 N SRCOMMA
"RTN","SROANTP",8,0)
 I $P(SR("RA"),"^",6)="N" Q
"RTN","SROANTP",9,0)
 I $Y+5>IOSL S SRPAGE=SRPAGE+1 D HDR I SRSOUT Q
"RTN","SROANTP",10,0)
 S SRA(0)=^SRF(SRTN,0),DFN=$P(SRA(0),"^") N I D DEM^VADPT S SRANM=VADM(1),SRASSN=VA("PID") K VADM
"RTN","SROANTP",11,0)
 S X=^SRF(SRTN,"OP"),SROPER=$P(X,"^"),Y=$P(X,"^",2),SRCPT=$S(Y:$P($$CPT^ICPTCOD(Y),"^",2),1:"NO CPT") I SRCPT,$O(^SRF(SRTN,"OPMOD",0)) D
"RTN","SROANTP",12,0)
 .S (SRCOMMA,SRI)=0,SRCMOD="",SRCPT=SRCPT_"-" F  S SRI=$O(^SRF(SRTN,"OPMOD",SRI)) Q:'SRI  D
"RTN","SROANTP",13,0)
 ..S SRM=$P(^SRF(SRTN,"OPMOD",SRI,0),"^"),SRCMOD=$P($$MOD^ICPTMOD(SRM,"I"),"^",2)
"RTN","SROANTP",14,0)
 ..S SRCPT=SRCPT_$S(SRCOMMA:",",1:"")_SRCMOD,SRCOMMA=1
"RTN","SROANTP",15,0)
 S SROPER=SROPER_" ("_SRCPT_")"
"RTN","SROANTP",16,0)
 I $O(^SRF(SRTN,13,0)) S SROTHER=0 F  S SROTHER=$O(^SRF(SRTN,13,SROTHER)) Q:'SROTHER  D OTHER
"RTN","SROANTP",17,0)
 S X=$P($G(^SRF(SRTN,"RA")),"^",2) I X="C" S SROPER="* "_SROPER
"RTN","SROANTP",18,0)
 K SROPS,MM,MMM S:$L(SROPER)<81 SROPS(1)=SROPER I $L(SROPER)>80 S SROPER=SROPER_"  " F M=1:1 D LOOP Q:MMM=""
"RTN","SROANTP",19,0)
 S SRSS=$P(SRA(0),"^",4),SRSS=$S(SRSS:$P(^SRO(137.45,SRSS,0),"^"),1:"SPECIALTY NOT ENTERED")
"RTN","SROANTP",20,0)
 S TYPE=$P(SR("RA"),"^",2) I SRSS="SPECIALTY NOT ENTERED",TYPE="C" S SRSS="N/A"
"RTN","SROANTP",21,0)
 D TECH^SROPRIN
"RTN","SROANTP",22,0)
 S Y=$P(SRA(0),"^",9) D D^DIQ S SRDT=$P(Y,"@")
"RTN","SROANTP",23,0)
 S (SRDOC,Y)=$P($G(^SRF(SRTN,.1)),"^",4),C=$P(^DD(130,.14,0),"^",2) D:Y'="" Y^DIQ I $L(Y)>23 S Z=$P(Y,",")_","_$E($P(Y,",",2))_".",Y=Z
"RTN","SROANTP",24,0)
 S SRDOC=Y
"RTN","SROANTP",25,0)
 W !,SRTN,?20,SRANM_" "_VA("PID"),?67,$P(SRSS,"("),?107,SRTECH,!,SRDT,?20,SROPS(1),?107,SRDOC I $D(SROPS(2)) W !,?20,SROPS(2) I $D(SROPS(3)) W !,?20,SROPS(3) I $D(SROPS(4)) W !,?20,SROPS(4)
"RTN","SROANTP",26,0)
 W !
"RTN","SROANTP",27,0)
 Q
"RTN","SROANTP",28,0)
OTHER ; other operations
"RTN","SROANTP",29,0)
 S SRLONG=1 I $L(SROPER)+$L($P(^SRF(SRTN,13,SROTHER,0),"^"))>165 S SRLONG=0,SROTHER=999,SROPERS=" ..."
"RTN","SROANTP",30,0)
 I SRLONG S SROPERS=$P(^SRF(SRTN,13,SROTHER,0),"^")
"RTN","SROANTP",31,0)
 S SROPER=SROPER_$S(SROPERS'=" ...":", "_SROPERS,1:SROPERS)
"RTN","SROANTP",32,0)
 Q
"RTN","SROANTP",33,0)
LOOP ; break procedures
"RTN","SROANTP",34,0)
 S SROPS(M)="" F LOOP=1:1 S MM=$P(SROPER," "),MMM=$P(SROPER," ",2,200) Q:MMM=""  Q:$L(SROPS(M))+$L(MM)'<81  S SROPS(M)=SROPS(M)_MM_" ",SROPER=MMM
"RTN","SROANTP",35,0)
 Q
"RTN","SROANTP",36,0)
HDR ; print heading
"RTN","SROANTP",37,0)
 I $D(ZTQUEUED) D ^SROSTOP I SRHALT S SRSOUT=1 Q
"RTN","SROANTP",38,0)
 W:$Y @IOF W !,?53,"INCOMPLETE RISK ASSESSMENTS",?120,"PAGE "_SRPAGE,!,?(132-$L(SRINST)\2),SRINST,!,?58,"SURGERY SERVICE",?100,"DATE REVIEWED:"
"RTN","SROANTP",39,0)
 W !,?(132-$L(SRFRTO)\2),SRFRTO,?100,"REVIEWED BY:"
"RTN","SROANTP",40,0)
 W !!,"ASSESSMENT #",?20,"PATIENT",?67,"SURGICAL SPECIALTY",?107,"ANESTHESIA TECHNIQUE",!,"OPERATION DATE",?20,"PRINCIPAL OPERATIVE PROCEDURE",?107,"SURGEON",! F LINE=1:1:132 W "="
"RTN","SROANTP",41,0)
 Q
"RTN","SROANTS")
0^27^B14690682
"RTN","SROANTS",1,0)
SROANTS ;B'HAM ISC/MAM - INCOMPLETE ASSESSMENTS ; [ 05/30/01  2:33 PM ]
"RTN","SROANTS",2,0)
 ;;3.0; Surgery ;**38,50,100**;24 Jun 93
"RTN","SROANTS",3,0)
 I $E(IOST)="P" D ^SROANTSP Q
"RTN","SROANTS",4,0)
 K ^TMP("SRA",$J)
"RTN","SROANTS",5,0)
 S SRSOUT=0 D HDR
"RTN","SROANTS",6,0)
 F  S SRSD=$O(^SRF("AC",SRSD)) Q:'SRSD!(SRSD>SRED)!SRSOUT  S SRTN=0 F  S SRTN=$O(^SRF("AC",SRSD,SRTN)) Q:'SRTN!SRSOUT  S SR("RA")=$G(^SRF(SRTN,"RA")) I $P(SR("RA"),"^")="I",$D(^SRF(SRTN,0)),$$DIV^SROUTL0(SRTN) D UTL
"RTN","SROANTS",7,0)
 S SRSS="" F  S SRSS=$O(^TMP("SRA",$J,SRSS)) Q:SRSS=""!SRSOUT  D SS S SRTN=0 F  S SRTN=$O(^TMP("SRA",$J,SRSS,SRTN)) Q:'SRTN!SRSOUT  D SET
"RTN","SROANTS",8,0)
 I '$D(^TMP("SRA",$J)) W $$NODATA^SROUTL0()
"RTN","SROANTS",9,0)
 Q
"RTN","SROANTS",10,0)
UTL ; write to ^TMP("SRA",$J)
"RTN","SROANTS",11,0)
 I $P(SR("RA"),"^",6)="N" Q
"RTN","SROANTS",12,0)
 I SRFLG,$P(^SRF(SRTN,0),"^",4)'=SRASP Q
"RTN","SROANTS",13,0)
 S SRSS=$P(^SRF(SRTN,0),"^",4),SRSS=$S(SRSS:$P(^SRO(137.45,SRSS,0),"^"),1:"SPECIALTY NOT ENTERED")
"RTN","SROANTS",14,0)
 S ^TMP("SRA",$J,SRSS,SRTN)=""
"RTN","SROANTS",15,0)
 Q
"RTN","SROANTS",16,0)
SET ; print assessments
"RTN","SROANTS",17,0)
 N SRCOMMA
"RTN","SROANTS",18,0)
 I $Y+5>IOSL D PAGE I SRSOUT Q
"RTN","SROANTS",19,0)
 S SRA(0)=^SRF(SRTN,0),DFN=$P(SRA(0),"^") N I D DEM^VADPT S SRANM=VADM(1),SRASSN=VA("PID") K VADM
"RTN","SROANTS",20,0)
 I $L(SRANM)>19 S SRANM=$P(SRANM,",")_","_$E($P(SRANM,",",2))_"."
"RTN","SROANTS",21,0)
 S X=^SRF(SRTN,"OP"),SROPER=$P(X,"^"),Y=$P(X,"^",2),SRCPT=$S(Y:$P($$CPT^ICPTCOD(Y),"^",2),1:"NO CPT") I SRCPT,$O(^SRF(SRTN,"OPMOD",0)) D
"RTN","SROANTS",22,0)
 .S (SRCOMMA,SRI)=0,SRCMOD="",SRCPT=SRCPT_"-" F  S SRI=$O(^SRF(SRTN,"OPMOD",SRI)) Q:'SRI  D
"RTN","SROANTS",23,0)
 ..S SRM=$P(^SRF(SRTN,"OPMOD",SRI,0),"^"),SRCMOD=$P($$MOD^ICPTMOD(SRM,"I"),"^",2)
"RTN","SROANTS",24,0)
 ..S SRCPT=SRCPT_$S(SRCOMMA:",",1:"")_SRCMOD,SRCOMMA=1
"RTN","SROANTS",25,0)
 S SROPER=SROPER_" ("_SRCPT_")"
"RTN","SROANTS",26,0)
 I $O(^SRF(SRTN,13,0)) S SROTHER=0 F I=0:0 S SROTHER=$O(^SRF(SRTN,13,SROTHER)) Q:'SROTHER  D OTHER
"RTN","SROANTS",27,0)
 S X=$P($G(^SRF(SRTN,"RA")),"^",2) I X="C" S SROPER="* "_SROPER
"RTN","SROANTS",28,0)
 K SROPS,MM,MMM S:$L(SROPER)<34 SROPS(1)=SROPER I $L(SROPER)>33 S SROPER=SROPER_"  " F M=1:1 D LOOP Q:MMM=""
"RTN","SROANTS",29,0)
 D TECH^SROPRIN
"RTN","SROANTS",30,0)
 S Y=$P(SRA(0),"^",9) D D^DIQ S SRDT=$P(Y,"@")
"RTN","SROANTS",31,0)
 S (SRDOC,Y)=$P($G(^SRF(SRTN,.1)),"^",4),C=$P(^DD(130,.14,0),"^",2) D:Y'="" Y^DIQ I $L(Y)>23 S Z=$P(Y,",")_","_$E($P(Y,",",2))_".",Y=Z
"RTN","SROANTS",32,0)
 S SRDOC=Y
"RTN","SROANTS",33,0)
 W !,SRTN,?20,SRANM_" "_VA("PID"),?55,SRTECH,!,SRDT,?20,SROPS(1),?55,SRDOC S SRAO=1 F  S SRAO=$O(SROPS(SRAO)) Q:'SRAO  W !,?20,SROPS(SRAO)
"RTN","SROANTS",34,0)
 W ! F LINE=1:1:80 W "-"
"RTN","SROANTS",35,0)
 Q
"RTN","SROANTS",36,0)
OTHER ; other operations
"RTN","SROANTS",37,0)
 S SRLONG=1 I $L(SROPER)+$L($P(^SRF(SRTN,13,SROTHER,0),"^"))>125 S SRLONG=0,SROTHER=999,SROPERS=" ..."
"RTN","SROANTS",38,0)
 I SRLONG S SROPERS=$P(^SRF(SRTN,13,SROTHER,0),"^")
"RTN","SROANTS",39,0)
 S SROPER=SROPER_$S(SROPERS'=" ...":", "_SROPERS,1:SROPERS)
"RTN","SROANTS",40,0)
 Q
"RTN","SROANTS",41,0)
LOOP ; break procedures
"RTN","SROANTS",42,0)
 S SROPS(M)="" F LOOP=1:1 S MM=$P(SROPER," "),MMM=$P(SROPER," ",2,200) Q:MMM=""  Q:$L(SROPS(M))+$L(MM)'<34  S SROPS(M)=SROPS(M)_MM_" ",SROPER=MMM
"RTN","SROANTS",43,0)
 Q
"RTN","SROANTS",44,0)
PAGE W !!,"Press <RET> to continue, or '^' to quit  " R X:DTIME I '$T!(X["^") S SRSOUT=1 Q
"RTN","SROANTS",45,0)
 I X["?" W !!,"If you want to continue listing incomplete assessments, enter <RET>.  Enter",!,"'^' to return to the menu." G PAGE
"RTN","SROANTS",46,0)
HDR W @IOF,!!,?26,"INCOMPLETE RISK ASSESSMENTS",!,?(80-$L(SRFRTO)\2),SRFRTO,!!,"ASSESSMENT #",?20,"PATIENT",?55,"ANESTHESIA TECHNIQUE",!,"OPERATION DATE",?20,"PRINCIPAL OPERATION",?55,"SURGEON",! F LINE=1:1:80 W "="
"RTN","SROANTS",47,0)
 Q
"RTN","SROANTS",48,0)
SS ; print surgical specialty
"RTN","SROANTS",49,0)
 I $Y+8>IOSL D PAGE Q:SRSOUT
"RTN","SROANTS",50,0)
 W !!,"** SURGICAL SPECIALTY: ",SRSS," **",!
"RTN","SROANTS",51,0)
 Q
"RTN","SROANTSP")
0^28^B13524175
"RTN","SROANTSP",1,0)
SROANTSP ;B'HAM ISC/MAM - INCOMPLETE ASSESSMENTS (PRINTER) ; [ 05/30/01  2:33 PM ]
"RTN","SROANTSP",2,0)
 ;;3.0; Surgery ;**32,50,100**;24 Jun 93
"RTN","SROANTSP",3,0)
 K ^TMP("SRA",$J) S SRPAGE=0,(SRSOUT,SRDFN)=0 D HDR Q:SRSOUT
"RTN","SROANTSP",4,0)
 F  S SRSD=$O(^SRF("AC",SRSD)) Q:'SRSD!(SRSD>SRED)!SRSOUT  S SRTN=0 F  S SRTN=$O(^SRF("AC",SRSD,SRTN)) Q:'SRTN!SRSOUT  S SR("RA")=$G(^SRF(SRTN,"RA")) I $P(SR("RA"),"^")="I",$D(^SRF(SRTN,0)),$$DIV^SROUTL0(SRTN) D UTL
"RTN","SROANTSP",5,0)
 S SRSS="" F  S SRSS=$O(^TMP("SRA",$J,SRSS)) Q:SRSS=""!SRSOUT  D SS S SRTN=0 F  S SRTN=$O(^TMP("SRA",$J,SRSS,SRTN)) D:'SRTN LINE Q:'SRTN!SRSOUT  D SET
"RTN","SROANTSP",6,0)
 Q
"RTN","SROANTSP",7,0)
UTL ; write to ^TMP("SRA",$J)
"RTN","SROANTSP",8,0)
 I $P(SR("RA"),"^",6)="N" Q
"RTN","SROANTSP",9,0)
 I SRFLG,$P(^SRF(SRTN,0),"^",4)'=SRASP Q
"RTN","SROANTSP",10,0)
 S SRSS=$P(^SRF(SRTN,0),"^",4),SRSS=$S(SRSS:$P(^SRO(137.45,SRSS,0),"^"),1:"SRECIALTY NOT ENTERED")
"RTN","SROANTSP",11,0)
 S ^TMP("SRA",$J,SRSS,SRTN)=""
"RTN","SROANTSP",12,0)
 Q
"RTN","SROANTSP",13,0)
SET ; print assessments
"RTN","SROANTSP",14,0)
 N SRCOMMA
"RTN","SROANTSP",15,0)
 I $Y+5>IOSL D HDR I SRSOUT Q
"RTN","SROANTSP",16,0)
 S SRA(0)=^SRF(SRTN,0),DFN=$P(SRA(0),"^") N I D DEM^VADPT S SRANM=VADM(1),SRASSN=VA("PID") K VADM
"RTN","SROANTSP",17,0)
 S X=^SRF(SRTN,"OP"),SROPER=$P(X,"^"),Y=$P(X,"^",2),SRCPT=$S(Y:$P($$CPT^ICPTCOD(Y),"^",2),1:"NO CPT") I SRCPT,$O(^SRF(SRTN,"OPMOD",0)) D
"RTN","SROANTSP",18,0)
 .S (SRCOMMA,SRI)=0,SRCMOD="",SRCPT=SRCPT_"-" F  S SRI=$O(^SRF(SRTN,"OPMOD",SRI)) Q:'SRI  D
"RTN","SROANTSP",19,0)
 ..S SRM=$P(^SRF(SRTN,"OPMOD",SRI,0),"^"),SRCMOD=$P($$MOD^ICPTMOD(SRM,"I"),"^",2)
"RTN","SROANTSP",20,0)
 ..S SRCPT=SRCPT_$S(SRCOMMA:",",1:"")_SRCMOD,SRCOMMA=1
"RTN","SROANTSP",21,0)
 S SROPER=SROPER_" ("_SRCPT_")"
"RTN","SROANTSP",22,0)
 I $O(^SRF(SRTN,13,0)) S SROTHER=0 F I=0:0 S SROTHER=$O(^SRF(SRTN,13,SROTHER)) Q:'SROTHER  D OTHER
"RTN","SROANTSP",23,0)
 S X=$P($G(^SRF(SRTN,"RA")),"^",2) I X="C" S SROPER="* "_SROPER
"RTN","SROANTSP",24,0)
 K SROPS,MM,MMM S:$L(SROPER)<36 SROPS(1)=SROPER I $L(SROPER)>35 S SROPER=SROPER_"  " F M=1:1 D LOOP Q:MMM=""
"RTN","SROANTSP",25,0)
 D TECH^SROPRIN
"RTN","SROANTSP",26,0)
 S Y=$P(SRA(0),"^",9) D D^DIQ S SRDT=$P(Y,"@")
"RTN","SROANTSP",27,0)
 S (SRDOC,Y)=$P($G(^SRF(SRTN,.1)),"^",4),C=$P(^DD(130,.14,0),"^",2) D:Y'="" Y^DIQ I $L(Y)>23 S Z=$P(Y,",")_","_$E($P(Y,",",2))_".",Y=Z
"RTN","SROANTSP",28,0)
 S SRDOC=Y
"RTN","SROANTSP",29,0)
 W !,SRTN,?20,SRANM_" "_VA("PID"),?67,SROPS(1),?107,SRTECH,!,SRDT W:$D(SROPS(2)) ?67,SROPS(2) W ?107,SRDOC S SRAO=2 F  S SRAO=$O(SROPS(SRAO)) Q:'SRAO  W !,?67,SROPS(SRAO)
"RTN","SROANTSP",30,0)
 W ! Q
"RTN","SROANTSP",31,0)
OTHER ; other operations
"RTN","SROANTSP",32,0)
 S SRLONG=1 I $L(SROPER)+$L($P(^SRF(SRTN,13,SROTHER,0),"^"))>165 S SRLONG=0,SROTHER=999,SROPERS=" ..."
"RTN","SROANTSP",33,0)
 I SRLONG S SROPERS=$P(^SRF(SRTN,13,SROTHER,0),"^")
"RTN","SROANTSP",34,0)
 S SROPER=SROPER_$S(SROPERS'=" ...":", "_SROPERS,1:SROPERS)
"RTN","SROANTSP",35,0)
 Q
"RTN","SROANTSP",36,0)
LOOP ; break procedures
"RTN","SROANTSP",37,0)
 S SROPS(M)="" F LOOP=1:1 S MM=$P(SROPER," "),MMM=$P(SROPER," ",2,200) Q:MMM=""  Q:$L(SROPS(M))+$L(MM)'<35  S SROPS(M)=SROPS(M)_MM_" ",SROPER=MMM
"RTN","SROANTSP",38,0)
 Q
"RTN","SROANTSP",39,0)
HDR ; print heading
"RTN","SROANTSP",40,0)
 I $D(ZTQUEUED) D ^SROSTOP I SRHALT S SRSOUT=1 Q
"RTN","SROANTSP",41,0)
 S SRPAGE=SRPAGE+1 W:$Y @IOF W !,?53,"INCOMPLETE RISK ASSESSMENTS",?120,"PAGE "_SRPAGE,!,?(132-$L(SRINST)\2),SRINST,!,?58,"SURGERY SERVICE",?100,"DATE REVIEWED:"
"RTN","SROANTSP",42,0)
 W !,?(132-$L(SRFRTO)\2),SRFRTO,?100,"REVIEWED BY:"
"RTN","SROANTSP",43,0)
 W !!,"ASSESSMENT #",?20,"PATIENT",?67,"PRINCIPAL OPERATIVE PROCEDURE",?107,"ANESTHESIA TECHNIQUE",!,"OPERATION DATE",?107,"SURGEON",! F LINE=1:1:132 W "="
"RTN","SROANTSP",44,0)
 Q
"RTN","SROANTSP",45,0)
SS ; print surgical specialty
"RTN","SROANTSP",46,0)
 I $Y+5>IOSL D HDR
"RTN","SROANTSP",47,0)
 W !!,"** SURGICAL SPECIALTY: ",SRSS," **",!
"RTN","SROANTSP",48,0)
 Q
"RTN","SROANTSP",49,0)
LINE W ! F L=1:1:132 W "-"
"RTN","SROANTSP",50,0)
 Q
"RTN","SROAO")
0^29^B9259852
"RTN","SROAO",1,0)
SROAO ;B'HAM ISC/MAM - OUTCOMES ; [ 01/29/01  9:22 AM ]
"RTN","SROAO",2,0)
 ;;3.0; Surgery ;**100**;24 Jun 93
"RTN","SROAO",3,0)
 I '$D(SRTN) W !!,"A Surgery Risk Assessment must be selected prior to using this option.",!!,"Press <RET> to continue  " R X:DTIME G END
"RTN","SROAO",4,0)
 S SRSOUT=0,DFN=$P(^SRF(SRTN,0),"^") D DEM^VADPT S SRANAME=$P(VADM(1),"^")_"  ("_VA("PID")_")"
"RTN","SROAO",5,0)
START G:SRSOUT END D ^SROAOSET
"RTN","SROAO",6,0)
ASK W !!,"Select Postoperative Outcome: " R X:DTIME I '$T!(X["^") G END
"RTN","SROAO",7,0)
 I X="" G END
"RTN","SROAO",8,0)
 I '$D(SRAO(X)),(X'?1N1":"1N),(X'="A") D HELP G:SRSOUT END G START
"RTN","SROAO",9,0)
 I X?1N1":"1N S Y=$P(X,":"),Z=$P(X,":",2) I Y<1!(Z>3)!(Y>Z) D HELP G:SRSOUT END G START
"RTN","SROAO",10,0)
 W @IOF,!,SRANAME,! F MOE=1:1:80 W "-"
"RTN","SROAO",11,0)
 I X="A" S X="1:3"
"RTN","SROAO",12,0)
 I X?1N1":"1N W !! D RANGE G START
"RTN","SROAO",13,0)
 I $D(SRAO(X)),+X=X S EMILY=X D  G START
"RTN","SROAO",14,0)
 .I $$LOCK^SROUTL(SRTN) W:X<6 !! D ONE,UNLOCK^SROUTL(SRTN)
"RTN","SROAO",15,0)
END W @IOF D ^SRSKILL
"RTN","SROAO",16,0)
 Q
"RTN","SROAO",17,0)
HELP W @IOF,!!!!,"Enter the number, number/letter combination, or range of numbers you want to",!,"edit.  Examples of proper responses are listed below."
"RTN","SROAO",18,0)
 W !!,"1. Enter 'A' to update all outcome information.",!!,"2. Enter a number (1-3) to update an individual outcome element.  (For",!,"   example, enter '1' to update all postoperative diagnosis)"
"RTN","SROAO",19,0)
 W !!,"3. Enter a range of numbers (1-3) separated by a ':' to enter a range of",!,"   outcomes.  (For example, enter '1:3' to enter postoperative diagnosis,",!,"   length of postoperative stay, and 30 day postoperative status)"
"RTN","SROAO",20,0)
 W !!,"Press <RET> to continue, or '^' to quit  " R X:DTIME I '$T!(X["^") S SRSOUT=1
"RTN","SROAO",21,0)
 Q
"RTN","SROAO",22,0)
RANGE ; range of numbers
"RTN","SROAO",23,0)
 I $$LOCK^SROUTL(SRTN) D  D UNLOCK^SROUTL(SRTN)
"RTN","SROAO",24,0)
 .S SHEMP=$P(X,":"),CURLEY=$P(X,":",2) F EMILY=SHEMP:1:CURLEY Q:SRSOUT  D ONE
"RTN","SROAO",25,0)
 Q
"RTN","SROAO",26,0)
ONE ; edit one item
"RTN","SROAO",27,0)
 K DR,DA,DIE S DR=$P(SRAO(EMILY),"^",2)_"T",DA=SRTN,DIE=130 D ^DIE K DR,DA
"RTN","SROAO",28,0)
 Q
"RTN","SROAOP")
0^30^B17646898
"RTN","SROAOP",1,0)
SROAOP ;B'HAM ISC/MAM - ENTER OPERATION INFO ; [ 01/29/01  9:37 AM ]
"RTN","SROAOP",2,0)
 ;;3.0; Surgery ;**19,38,47,63,67,81,86,97,100**;24 Jun 93
"RTN","SROAOP",3,0)
 I '$D(SRTN) W !!,"A Surgery Risk Assessment must be selected prior to using this option.",!!,"Press <RET> to continue  " R X:DTIME G END
"RTN","SROAOP",4,0)
 S SRSOUT=0 D ^SROAUTL
"RTN","SROAOP",5,0)
START G:SRSOUT END K SRAOTH,SRACON D ^SROAOP1
"RTN","SROAOP",6,0)
ASK W !!,"Select Operative Information to Edit: " R SRASEL:DTIME I '$T!(SRASEL["^") S SRSOUT=1 G END
"RTN","SROAOP",7,0)
 I SRASEL="" G END
"RTN","SROAOP",8,0)
 S:SRASEL="a" SRASEL="A" I '$D(SRAO(SRASEL)),(SRASEL'?.N1":".N),(SRASEL'="A") D HELP G:SRSOUT END G START
"RTN","SROAOP",9,0)
 I SRASEL="A" S SRASEL="1:13"
"RTN","SROAOP",10,0)
 I SRASEL?.N1":".N S Y=$E(SRASEL),Z=$P(SRASEL,":",2) I Y<1!(Z>13)!(Y>Z) D HELP G:SRSOUT END G START
"RTN","SROAOP",11,0)
 S MM=$E(SRASEL) I MM'=4,(MM'=5) S SRHDR(.5)=SRDOC D HDR^SROAUTL
"RTN","SROAOP",12,0)
 I SRASEL?.N1":".N D RANGE G START
"RTN","SROAOP",13,0)
 Q:'$D(SRAO(SRASEL))
"RTN","SROAOP",14,0)
 S EMILY=SRASEL D  G START
"RTN","SROAOP",15,0)
 .I $$LOCK^SROUTL(SRTN) D ONE,UNLOCK^SROUTL(SRTN)
"RTN","SROAOP",16,0)
END I 'SRSOUT D ^SROAOP2
"RTN","SROAOP",17,0)
 I $D(SRTN) S SROERR=SRTN D ^SROERR0
"RTN","SROAOP",18,0)
 W @IOF D ^SRSKILL
"RTN","SROAOP",19,0)
 Q
"RTN","SROAOP",20,0)
HELP W @IOF,!!!!,"Enter the number or range of numbers you want to edit.  Examples of proper",!,"responses are listed below."
"RTN","SROAOP",21,0)
 W !!,"1. Enter 'A' to update all information.",!!,"2. Enter a number (1-13) to update the information in that field.  (For",!,"   example, enter '2' to update Principal Operation.)"
"RTN","SROAOP",22,0)
 W !!,"3. Enter a range of numbers (1-13) separated by a ':' to enter a range of",!,"   information.  (For example, enter '1:3' to update Surgical Specialty,",!,"   Principal Operation, and Principal CPT Code.)"
"RTN","SROAOP",23,0)
 W !!,"Press <RET> to continue, or '^' to quit  " R X:DTIME I '$T!(X["^") S SRSOUT=1
"RTN","SROAOP",24,0)
 Q
"RTN","SROAOP",25,0)
RANGE ; range of numbers
"RTN","SROAOP",26,0)
 I $$LOCK^SROUTL(SRTN) D  D UNLOCK^SROUTL(SRTN)
"RTN","SROAOP",27,0)
 .S SHEMP=$P(SRASEL,":"),CURLEY=$P(SRASEL,":",2) F EMILY=SHEMP:1:CURLEY Q:SRSOUT  D ONE
"RTN","SROAOP",28,0)
 Q
"RTN","SROAOP",29,0)
ONE ; edit one item
"RTN","SROAOP",30,0)
 I EMILY=10 D ANES Q
"RTN","SROAOP",31,0)
 I EMILY=4!(EMILY=5) D:EMILY=4 ^SROTHER D:EMILY=5 CONCUR Q
"RTN","SROAOP",32,0)
 I EMILY=6,SRASEL[":",($P(SRASEL,":")'=6) S SRPAGE="" S SRHDR(.5)=SRDOC D HDR^SROAUTL
"RTN","SROAOP",33,0)
 K DR,DIE S DA=SRTN,DR=$P(SRAO(EMILY),"^",2)_"T",DIE=130 D ^DIE K DR I $D(Y) S SRSOUT=1
"RTN","SROAOP",34,0)
 I EMILY=2!(EMILY=3) D ^SROAUTL
"RTN","SROAOP",35,0)
 Q
"RTN","SROAOP",36,0)
RET Q:SRSOUT  W !!,"Press <RET> to continue, or '^' to quit  " R X:DTIME I '$T!(X["^") S SRSOUT=1 Q
"RTN","SROAOP",37,0)
 Q
"RTN","SROAOP",38,0)
CONCUR ; concurrent case information
"RTN","SROAOP",39,0)
 S SRLINE="" F I=1:1:80 S SRLINE=SRLINE_"-"
"RTN","SROAOP",40,0)
 S CON=$P($G(^SRF(SRTN,"CON")),"^") I CON,($P($G(^SRF(CON,30)),"^")!($P($G(^SRF(CON,31)),"^",8))) S CON=""
"RTN","SROAOP",41,0)
 S SRPAGE="" D HDR^SROAUTL
"RTN","SROAOP",42,0)
 W !,"Concurrent case information cannot be updated using the Risk Assessment",!,"Module.  To update the CPT code of a concurrent case, please use an option",!,"contained within the Operation Menu."
"RTN","SROAOP",43,0)
 I CON D CC W !!,"Concurrent Procedure: ",?25,SROPS(1) I $D(SROPS(2)) W !,?25,SROPS(2) I $D(SROPS(3)) W !,?25,SROPS(3) I $D(SROPS(4)) W !,?25,SROPS(4)
"RTN","SROAOP",44,0)
 W !!,"Press RETURN to continue " R X:DTIME
"RTN","SROAOP",45,0)
 Q
"RTN","SROAOP",46,0)
CC ; list concurrent procedure
"RTN","SROAOP",47,0)
 S SROPER=$P(^SRF(CON,"OP"),"^") I $P(^("OP"),"^",2) S SROPER=SROPER_" ("_$P(^("OP"),"^",2)_")"
"RTN","SROAOP",48,0)
 K SROPS,MM,MMM S:$L(SROPER)<50 SROPS(1)=SROPER
"RTN","SROAOP",49,0)
 I $L(SROPER)>49 S SROPER=SROPER_"  " F M=1:1 D LOOP Q:MMM=""
"RTN","SROAOP",50,0)
 Q
"RTN","SROAOP",51,0)
LOOP ; break procedures
"RTN","SROAOP",52,0)
 S SROPS(M)="" F LOOP=1:1 S MM=$P(SROPER," "),MMM=$P(SROPER," ",2,200) Q:MMM=""  Q:$L(SROPS(M))+$L(MM)'<50  S SROPS(M)=SROPS(M)_MM_" ",SROPER=MMM
"RTN","SROAOP",53,0)
 Q
"RTN","SROAOP",54,0)
ANES K DR,DIE,DA S DA=SRTN,DR=.37,DR(2,130.06)=".01T;.05T;42T",DIE=130 D ^DIE K DR
"RTN","SROAOP",55,0)
 Q
"RTN","SROAOP2")
0^31^B11448606
"RTN","SROAOP2",1,0)
SROAOP2 ;BIR/ADM - OPERATION INFO, PAGE 2 ; [ 01/29/01  9:41 AM ]
"RTN","SROAOP2",2,0)
 ;;3.0; Surgery ;**81,88,100**;24 Jun 93
"RTN","SROAOP2",3,0)
 ; called from SROAOP
"RTN","SROAOP2",4,0)
EDIT Q:SRSOUT  S SRHDR(.5)=SRDOC,SRPAGE="PAGE: 2 OF 2" D HDR^SROAUTL
"RTN","SROAOP2",5,0)
 K DR S SRQ=0,(DR,SRDR)=".205;.22;.23;.232;.21;.24;1.18"
"RTN","SROAOP2",6,0)
 K DA,DIC,DIQ,SRY S DIC="^SRF(",DA=SRTN,DIQ="SRY",DIQ(0)="E",DR=SRDR D EN^DIQ1 K DA,DIC,DIQ,DR
"RTN","SROAOP2",7,0)
 K SRX S SRX=0 F M=1:1 S I=$P(SRDR,";",M)  Q:'I  D
"RTN","SROAOP2",8,0)
 .D TR,GET
"RTN","SROAOP2",9,0)
 .S SRX=SRX+1,Y=$P(X,";;",2),SRFLD=$P(Y,"^"),(Z,SRX(SRX))=$P(Y,"^",2)_"^"_SRFLD,SREXT=SRY(130,SRTN,SRFLD,"E")
"RTN","SROAOP2",10,0)
 .W !,SRX_". "_$P(Z,"^")_":" D EXT
"RTN","SROAOP2",11,0)
 W !! F K=1:1:80 W "-"
"RTN","SROAOP2",12,0)
 D SEL G EDIT
"RTN","SROAOP2",13,0)
 Q
"RTN","SROAOP2",14,0)
EXT I SREXT["@" S X=$P(SREXT,"@")_"  "_$P(SREXT,"@",2),SREXT=X
"RTN","SROAOP2",15,0)
 W ?39,SREXT
"RTN","SROAOP2",16,0)
 Q
"RTN","SROAOP2",17,0)
SEL W !!,"Select Operative Information to Edit: " R X:DTIME I '$T!(X["^")!(X="") S SRSOUT=1 Q
"RTN","SROAOP2",18,0)
 S:X="a" X="A" I '$D(SRFLG),'$D(SRX(X)),(X'?1.2N1":"1.2N),X'="A" D HELP Q
"RTN","SROAOP2",19,0)
 I X?1.2N1":"1.2N S Y=$P(X,":"),Z=$P(X,":",2) I Y<1!(Z>SRX)!(Y>Z) D HELP Q
"RTN","SROAOP2",20,0)
 I X="A" S X="1:"_SRX
"RTN","SROAOP2",21,0)
 I X?1.2N1":"1.2N D RANGE Q
"RTN","SROAOP2",22,0)
 I $D(SRX(X)),+X=X S EMILY=X D
"RTN","SROAOP2",23,0)
 .I $$LOCK^SROUTL(SRTN) D ONE,UNLOCK^SROUTL(SRTN)
"RTN","SROAOP2",24,0)
 Q
"RTN","SROAOP2",25,0)
HELP W @IOF,!!!!,"Enter the number or range of numbers you want to edit.  Examples of proper",!,"responses are listed below."
"RTN","SROAOP2",26,0)
 W !!,"1. Enter 'A' to update all items.",!!,"2. Enter a number (1-"_SRX_") to update an individual item.  (For example,",!,"   enter '1' to update "_$P(SRX(1),"^")_")"
"RTN","SROAOP2",27,0)
 W !!,"3. Enter a range of numbers (1-"_SRX_") separated by a ':' to enter a range",!,"   of items.  (For example, enter '1:4' to update items 1, 2, 3 and 4.)",!
"RTN","SROAOP2",28,0)
 I $D(SRFLG) W !,"4. Enter 'N' or 'NO' to enter negative response for all items.",!!,"5. Enter '@' to delete information from all items.",!
"RTN","SROAOP2",29,0)
PRESS W ! K DIR S DIR("A")="Press the return key to continue or '^' to exit: ",DIR(0)="FOA" D ^DIR K DIR I $D(DTOUT)!$D(DUOUT) S SRSOUT=1
"RTN","SROAOP2",30,0)
 Q
"RTN","SROAOP2",31,0)
RANGE ; range of numbers
"RTN","SROAOP2",32,0)
 I $$LOCK^SROUTL(SRTN) D  D UNLOCK^SROUTL(SRTN)
"RTN","SROAOP2",33,0)
 .S SHEMP=$P(X,":"),CURLEY=$P(X,":",2) F EMILY=SHEMP:1:CURLEY Q:SRSOUT  D ONE
"RTN","SROAOP2",34,0)
 Q
"RTN","SROAOP2",35,0)
ONE ; edit one item
"RTN","SROAOP2",36,0)
 K DR,DA,DIE S DR=$P(SRX(EMILY),"^",2)_"T",DA=SRTN,DIE=130,SRDT=$P(SRX(EMILY),"^",3) S:SRDT DR=DR_";"_SRDT_"T" D ^DIE K DR,DA I $D(Y) S SRSOUT=1
"RTN","SROAOP2",37,0)
 Q
"RTN","SROAOP2",38,0)
TR S J=I,J=$TR(J,"1234567890.","ABCDEFGHIJP")
"RTN","SROAOP2",39,0)
 Q
"RTN","SROAOP2",40,0)
GET S X=$T(@J)
"RTN","SROAOP2",41,0)
 Q
"RTN","SROAOP2",42,0)
PBJE ;;.205^Date/Time Patient In OR
"RTN","SROAOP2",43,0)
PBB ;;.22^Date/Time Operation Began
"RTN","SROAOP2",44,0)
PBC ;;.23^Date/Time Operation Ended
"RTN","SROAOP2",45,0)
PBCB ;;.232^Date/Time Patient Out OR
"RTN","SROAOP2",46,0)
PBA ;;.21^Anesthesia Care Start Date/Time
"RTN","SROAOP2",47,0)
PBD ;;.24^Anesthesia Care End Date/Time
"RTN","SROAOP2",48,0)
APAH ;;1.18^PAC(U) Discharge Date/Time
"RTN","SROAPAS")
0^124^B27269573
"RTN","SROAPAS",1,0)
SROAPAS ;BIR/MAM - PRINT A COMPLETE ASSESSMENT ; [ 05/26/99  12:54 PM ]
"RTN","SROAPAS",2,0)
 ;;3.0; Surgery ;**38,47,81,88,111,112,100**;24 Jun 93
"RTN","SROAPAS",3,0)
 S SRSOUT=0,SRPG=0,SR("RA")=$G(^SRF(SRTN,"RA")),SRATYPE=$P(SR("RA"),"^",2) F I=200:1:208 S SRA(I)=$G(^SRF(SRTN,I))
"RTN","SROAPAS",4,0)
 S SRA("OP")=^SRF(SRTN,"OP"),SRA("CON")=$G(^SRF(SRTN,"CON"))
"RTN","SROAPAS",5,0)
 S SR(0)=^SRF(SRTN,0),DFN=$P(SR(0),"^"),SRSDATE=$P(SR(0),"^",9) D DEM^VADPT S SRANM=VADM(1)_"  "_VA("PID"),Z=$P(VADM(3),"^"),Y=$E(SRSDATE,1,7),AGE=$E(Y,1,3)-$E(Z,1,3)-($E(Y,4,7)<$E(Z,4,7))
"RTN","SROAPAS",6,0)
 I $P(SR("RA"),"^",2)="C" D ^SROAPCA G END
"RTN","SROAPAS",7,0)
 W:$E(IOST)'="P" @IOF D HDR G:SRSOUT END
"RTN","SROAPAS",8,0)
 W !,"Medical Center: "_SRSITE("SITE")
"RTN","SROAPAS",9,0)
 W !,"Age: ",?16,AGE S Y=SRSDATE D D^DIQ W ?40,"Operation Date: ",?59,$P(Y,"@")
"RTN","SROAPAS",10,0)
 S Y=$P($G(^SRF(SRTN,208)),"^",10),C=$P(^DD(130,417,0),"^",2) D Y^DIQ S X=$S(Y'="":Y,1:"NOT ENTERED")
"RTN","SROAPAS",11,0)
 ;
"RTN","SROAPAS",12,0)
 D DEM^VADPT
"RTN","SROAPAS",13,0)
 ;Find patient's ethnicity
"RTN","SROAPAS",14,0)
 S SROETH=""
"RTN","SROAPAS",15,0)
 I $G(VADM(11)) S SROETH=$P(VADM(11,1),U,2)
"RTN","SROAPAS",16,0)
 I '$G(VADM(11)) S SROETH="UNANSWERED"
"RTN","SROAPAS",17,0)
 ;
"RTN","SROAPAS",18,0)
 ;Find all race entries and place into a string with commas inbetween
"RTN","SROAPAS",19,0)
 S SRORC=0,C=1,SRORACE="",SROLINE="",N=1,SROL=""
"RTN","SROAPAS",20,0)
 F  S SRORC=$O(VADM(12,SRORC)) Q:SRORC=""  Q:C=11  D
"RTN","SROAPAS",21,0)
 .I $G(VADM(12,SRORC)) S SRORACE(C)=$P(VADM(12,SRORC),U,2)
"RTN","SROAPAS",22,0)
 .I SROLINE'="" S SROLINE=SROLINE_", "_SRORACE(C)
"RTN","SROAPAS",23,0)
 .I SROLINE="" S SROLINE=SRORACE(C)
"RTN","SROAPAS",24,0)
 .S C=C+1
"RTN","SROAPAS",25,0)
 ;
"RTN","SROAPAS",26,0)
 ;Find total length of 'race' string and wrap the text if necessary
"RTN","SROAPAS",27,0)
 I $L(SROLINE)=29!$L(SROLINE)<29 S SROL(N)=SROLINE,SRNUM1=2
"RTN","SROAPAS",28,0)
 I $L(SROLINE)>29 D WRAP
"RTN","SROAPAS",29,0)
 ;
"RTN","SROAPAS",30,0)
 W !,"Sex: ",?16,$P(VADM(5),"^",2),?40,"Ethnicity:",?51,SROETH
"RTN","SROAPAS",31,0)
 W !,?40,"Race:"
"RTN","SROAPAS",32,0)
 I $G(VADM(12)) F D=1:1:SRNUM1-1 D
"RTN","SROAPAS",33,0)
 .W:D=1 ?51,SROL(D)
"RTN","SROAPAS",34,0)
 .W:D'=1 !,?51,SROL(D)
"RTN","SROAPAS",35,0)
 I '$G(VADM(12)) W ?51,"UNANSWERED"
"RTN","SROAPAS",36,0)
 ;
"RTN","SROAPAS",37,0)
 K SROL,SROLINE,SRORC,SRORACE,SROLN,SROLN1,SROWRAP,SRNUM1
"RTN","SROAPAS",38,0)
 ;
"RTN","SROAPAS",39,0)
 S Y=$P($G(^SRF(SRTN,208)),"^",11),C=$P(^DD(130,413,0),"^",2) D Y^DIQ S X=$S(Y'="":Y,1:"NOT ENTERED") W !,"Transfer Status: ",X
"RTN","SROAPAS",40,0)
 F J=1,2,3 S Y=$P($G(^SRF(SRTN,208.1)),"^",J) D
"RTN","SROAPAS",41,0)
 .I J'=3 X:Y ^DD("DD") S Z=$P(Y,"@")_"  "_$E($P(Y,"@",2),1,5)
"RTN","SROAPAS",42,0)
 .I J=3 S C=$P(^DD(130,454,0),"^",2) D Y^DIQ S Z=Y
"RTN","SROAPAS",43,0)
 .W !,"Observation "_$S(J=1:"Admission Date:",J=2:"Discharge Date:",1:"Treating Specialty:"),?47,Z
"RTN","SROAPAS",44,0)
 F J=14:1:17 S Y=$P($G(^SRF(SRTN,208)),"^",J) X ^DD("DD") S SRPTMODT(J)=Y
"RTN","SROAPAS",45,0)
 S (X,Z)=SRPTMODT(14) S:X'="" Z=$P(X,"@")_"  "_$E($P(X,"@",2),1,5) W !,"Hospital Admission Date:",?47,Z
"RTN","SROAPAS",46,0)
 S (X,Z)=SRPTMODT(15) S:X'="" Z=$P(X,"@")_"  "_$E($P(X,"@",2),1,5) W !,"Hospital Discharge Date:",?47,Z
"RTN","SROAPAS",47,0)
 S (X,Z)=SRPTMODT(16) S:X'="" Z=$P(X,"@")_"  "_$E($P(X,"@",2),1,5) W !,"Admitted/Transferred to Surgical Service:",?47,Z
"RTN","SROAPAS",48,0)
 S (X,Z)=SRPTMODT(17) S:X'="" Z=$P(X,"@")_"  "_$E($P(X,"@",2),1,5) W !,"Discharged/Transferred to Chronic Care:",?47,Z
"RTN","SROAPAS",49,0)
 W !,"In/Out-Patient Status:",?47,$S($P($G(^SRF(SRTN,0)),"^",12)="I":"INPATIENT",$P($G(^SRF(SRTN,0)),"^",12)="O":"OUTPATIENT",1:"")
"RTN","SROAPAS",50,0)
 I $E(IOST)="P" W ! F MOE=1:1:80 W "-"
"RTN","SROAPAS",51,0)
 I $E(IOST)'="P" D PAGE I SRSOUT G END
"RTN","SROAPAS",52,0)
 D ^SROAPRT1 G:SRSOUT END I $Y+20>IOSL D PAGE I SRSOUT G END
"RTN","SROAPAS",53,0)
 D ^SROAPRT2 G:SRSOUT END I $E(IOST)'="P" D PAGE I SRSOUT G END
"RTN","SROAPAS",54,0)
 D OPTIMES^SROAPRT3 D PAGE I SRSOUT G END
"RTN","SROAPAS",55,0)
 D ^SROAPRT3 G:SRSOUT END I $Y+24>IOSL D PAGE I SRSOUT G END
"RTN","SROAPAS",56,0)
 D ^SROAPRT4 G:SRSOUT END I $Y+20>IOSL D PAGE I SRSOUT G END
"RTN","SROAPAS",57,0)
 D ^SROAPRT5 G:SRSOUT END I $Y+20>IOSL D PAGE I SRSOUT G END
"RTN","SROAPAS",58,0)
 D ^SROAPRT6
"RTN","SROAPAS",59,0)
END Q:$D(SRABATCH)  I 'SRSOUT,$E(IOST)'="P" W !!,"Press <RET> to continue  " R X:DTIME
"RTN","SROAPAS",60,0)
 W:$E(IOST)="P" @IOF I $D(ZTQUEUED) Q:$G(ZTSTOP)  S ZTREQ="@" Q
"RTN","SROAPAS",61,0)
 D ^%ZISC W @IOF D ^SRSKILL
"RTN","SROAPAS",62,0)
 Q
"RTN","SROAPAS",63,0)
 ;
"RTN","SROAPAS",64,0)
WRAP ;Wrap multiple race entries so that wrapped line
"RTN","SROAPAS",65,0)
 ;does not break in the middle of a word
"RTN","SROAPAS",66,0)
 ;
"RTN","SROAPAS",67,0)
 S SROLNGTH=$L(SROLINE),E=29,SROWRAP="",SROLN="",SROLN1="",SROL=""
"RTN","SROAPAS",68,0)
 F I=1:29:SROLNGTH S SROLN(I)=SROWRAP_$E(SROLINE,I,E) D
"RTN","SROAPAS",69,0)
 .F K=29:-1:1 I $E(SROLN(I),K)[" " D  Q    ;Break lines at space
"RTN","SROAPAS",70,0)
 ..S SROLN1(I)=$E(SROLN(I),1,K-1)
"RTN","SROAPAS",71,0)
 ..S SROWRAP=$E(SROLN(I),K+1,E)
"RTN","SROAPAS",72,0)
 .S E=E+29
"RTN","SROAPAS",73,0)
 ;
"RTN","SROAPAS",74,0)
 S:'$D(SROLN1(I)) SROLN1(I)=SROLN(I),SROWRAP=""
"RTN","SROAPAS",75,0)
 I $L(SROLN1(I))+$L(SROWRAP)>28 S SROLN1(I+1)=SROWRAP   ;Last line
"RTN","SROAPAS",76,0)
 I $L(SROLN1(I))+$L(SROWRAP)'>28 S SROLN1(I)=SROLN1(I)_" "_SROWRAP
"RTN","SROAPAS",77,0)
 ;
"RTN","SROAPAS",78,0)
 ;Renumber the SROLN1 array to be in numeric order
"RTN","SROAPAS",79,0)
 S SRNUM=0,SRNUM1=1
"RTN","SROAPAS",80,0)
 F  S SRNUM=$O(SROLN1(SRNUM)) Q:SRNUM=""  D
"RTN","SROAPAS",81,0)
 .S SROL(SRNUM1)=SROLN1(SRNUM)
"RTN","SROAPAS",82,0)
 .S SRNUM1=SRNUM1+1
"RTN","SROAPAS",83,0)
 Q
"RTN","SROAPAS",84,0)
 ;
"RTN","SROAPAS",85,0)
LOOP ; break procedures
"RTN","SROAPAS",86,0)
 S SROPS(M)="" F LOOP=1:1 S MM=$P(SROPER," "),MMM=$P(SROPER," ",2,200) Q:MMM=""  Q:$L(SROPS(M))+$L(MM)'<55  S SROPS(M)=SROPS(M)_MM_" ",SROPER=MMM
"RTN","SROAPAS",87,0)
 Q
"RTN","SROAPAS",88,0)
PAGE I $E(IOST)'="P" W !!,"Press <RET> to continue, or '^' to quit  " R X:DTIME I '$T!(X["^") S SRSOUT=1 Q
"RTN","SROAPAS",89,0)
 I X["?" W !!,"Enter <RET> to continue printing the remaining pages of this assessment, or",!,"'^' to exit this option." G PAGE
"RTN","SROAPAS",90,0)
 W @IOF
"RTN","SROAPAS",91,0)
HDR ; print heading
"RTN","SROAPAS",92,0)
 I $D(ZTQUEUED) D ^SROSTOP I SRHALT S SRSOUT=1 Q
"RTN","SROAPAS",93,0)
 S SRPG=SRPG+1
"RTN","SROAPAS",94,0)
 I $Y'=0 W @IOF
"RTN","SROAPAS",95,0)
 I SRATYPE="C" W !,"VA CARDIAC RISK ASSESSMENT",?70,"PAGE "_SRPG
"RTN","SROAPAS",96,0)
 I SRATYPE="N" W !,"VA NON-CARDIAC RISK ASSESSMENT             Assessment: "_SRTN,?69,"PAGE "_SRPG
"RTN","SROAPAS",97,0)
 W !,"FOR "_SRANM S X=$P(SR("RA"),"^") W " ("_$S(X="I":"INCOMPLETE",X="C":"COMPLETED",X="T":"TRANSMITTED",1:"NO ASSESSMENT") I X="T" S Y=$P(SR("RA"),"^",4) W " "_$E(Y,4,5)_"/"_$E(Y,6,7)_"/"_$E(Y,2,3)
"RTN","SROAPAS",98,0)
 W ")",! F LINE=1:1:80 W "="
"RTN","SROAPAS",99,0)
 W !
"RTN","SROAPAS",100,0)
 Q
"RTN","SROAPAS",101,0)
CODE ; print CPT Code
"RTN","SROAPAS",102,0)
 S X=$P(^SRF(SRTN,13,SR,0),"^",2) I X W "  ("_$P($$CPT^ICPTCOD(X),"^",2)_")"
"RTN","SROAPAS",103,0)
 Q
"RTN","SROAPIMS")
0^153^B24379487
"RTN","SROAPIMS",1,0)
SROAPIMS ;BIR/ADM-PIMS Information Retrieval ; [ 08/13/03  8:43 AM ]
"RTN","SROAPIMS",2,0)
 ;;3.0; Surgery ;**38,46,47,57,71,81,86,100**;24 Jun 93
"RTN","SROAPIMS",3,0)
 ; 
"RTN","SROAPIMS",4,0)
 ; Reference to ^MCAR(690,"AC" supported by DBIA #1999
"RTN","SROAPIMS",5,0)
 ; Reference to ^DGPM("APTT1" supported by DBIA #565
"RTN","SROAPIMS",6,0)
 ;
"RTN","SROAPIMS",7,0)
 ; SRTN must be defined before calling this routine.
"RTN","SROAPIMS",8,0)
 ; This routine will return the following array
"RTN","SROAPIMS",9,0)
 ; SRVADPT(1)  = Name of the patient (e.g., SMITH,JOHN R.)
"RTN","SROAPIMS",10,0)
 ; SRVADPT(2)  = Patient ID (e.g., ***********)
"RTN","SROAPIMS",11,0)
 ; SRVADPT(3)  = Age of patient on date of operation (e.g., 36)
"RTN","SROAPIMS",12,0)
 ; SRVADPT(4)  = Sex of patient (e.g., M^MALE)
"RTN","SROAPIMS",13,0)
 ; SRVADPT(5)  = Race of patient (e.g., 6^WHITE, NOT OF HISPANIC ORIGIN)
"RTN","SROAPIMS",14,0)
 ; SRVADPT(6)  = Date of death
"RTN","SROAPIMS",15,0)
 ; SRVADPT(7)  = Hospital admission date
"RTN","SROAPIMS",16,0)
 ; SRVADPT(8)  = Hospital discharge date
"RTN","SROAPIMS",17,0)
 ; SRVADPT(9)  = Admission/transfer to surgical specialty
"RTN","SROAPIMS",18,0)
 ; SRVADPT(10) = Discharge/tranfer to chronic care
"RTN","SROAPIMS",19,0)
 ; SRVADPT(11) = Length of Post-Operative Hospital Stay (number of days)
"RTN","SROAPIMS",20,0)
 ; SRVADPT(12) = Admission to Observation
"RTN","SROAPIMS",21,0)
 ; SRVADPT(13) = Discharge from Observation
"RTN","SROAPIMS",22,0)
 ; SRVADPT(14) = Observation Specialty (PTF #)
"RTN","SROAPIMS",23,0)
 ;
"RTN","SROAPIMS",24,0)
 N SR,SRCC,SRDT,SRNON,SRSRV S SR(0)=^SRF(SRTN,0),DFN=$P(SR(0),"^") F I=1:1:14 S SRVADPT(I)=""
"RTN","SROAPIMS",25,0)
 D DEM^VADPT S SRVADPT(1)=VADM(1),SRVADPT(2)=VA("PID"),SRVADPT(4)=VADM(5),SRVADPT(6)=VADM(6) S Y=$E($P(SR(0),"^",9),1,7),Z=$P(VADM(3),"^") S SRVADPT(3)=$E(Y,1,3)-$E(Z,1,3)-($E(Y,4,7)<$E(Z,4,7))
"RTN","SROAPIMS",26,0)
 S SRX=$P(VADM(8),"^") I SRX K DA,DIC,DIQ,DR,SRY S DIC=10,DR=2,DA=SRX,DIQ="SRY",DIQ(0)="I" D EN^DIQ1 S SRVADPT(5)=SRY(10,SRX,2,"I")_"^"_$P(VADM(8),"^",2)
"RTN","SROAPIMS",27,0)
ADM ; find date(s) of admission and discharge
"RTN","SROAPIMS",28,0)
 N SRSOUT S SRSOUT=0,(VAIP("D"),SRSDATE)=$P(SR(0),"^",9) D IN5^VADPT
"RTN","SROAPIMS",29,0)
 ; if not admitted before surgery, look for admission within 24 hours of leaving OR
"RTN","SROAPIMS",30,0)
 I 'VAIP(13) S X1=$P($G(^SRF(SRTN,.2)),"^",12),X2=1 D C^%DTC S SR24=X,SRDT=$O(^DGPM("APTT1",DFN,SRSDATE)) G:'SRDT!(SRDT>SR24) END S VAIP("D")=SRDT D IN5^VADPT I 'VAIP(13) G END
"RTN","SROAPIMS",31,0)
 I VAIP(13) D ADM1 G:SRSOUT END
"RTN","SROAPIMS",32,0)
ADSS ; find date of admission/transfer to surgical service
"RTN","SROAPIMS",33,0)
 S SRSERV="" I VAIP(1) S SRX=$P(VAIP(8),"^") D SERV G:'SRSRV DISSS S:$P(VAIP(2),"^")=1 SRVADPT(9)=$E($P(VAIP(3),"^"),1,12) I $P(VAIP(2),"^")'=1 S SRSERV=$P(VAIP(3),"^")
"RTN","SROAPIMS",34,0)
 I VAIP(15) D PRIOR
"RTN","SROAPIMS",35,0)
DISSS ; find date of discharge/transfer to chronic care
"RTN","SROAPIMS",36,0)
 S SRNON=0,SRCC="",VAIP("D")=SRSAVE D IN5^VADPT
"RTN","SROAPIMS",37,0)
FOLLOW I VAIP(16) D  I 'SRNON S SRCC=VAIP(16,1),VAIP("D")=$P(SRCC,"^") D IN5^VADPT G FOLLOW
"RTN","SROAPIMS",38,0)
 .I $P(VAIP(16,2),"^")=3 S SRNON=1 Q
"RTN","SROAPIMS",39,0)
 .I "26"[$P(VAIP(16,2),"^") S SRX=$P(VAIP(16,6),"^") D NACUTE
"RTN","SROAPIMS",40,0)
 S SRVADPT(10)=SRVADPT(8) I SRNON S SRVADPT(10)=$E($P(VAIP(16,1),"^"),1,12)
"RTN","SROAPIMS",41,0)
STAY ; find length of post-operative hospital stay
"RTN","SROAPIMS",42,0)
 S X=$P($G(^SRF(SRTN,.2)),"^",3),X1=$P(SRVADPT(10),"^") I 'X!('X1)!(X>X1) G END
"RTN","SROAPIMS",43,0)
 S Y=$E(X1_"000",9,10)-$E(X_"000",9,10)*60+$E(X1_"00000",11,12)-$E(X_"00000",11,12),X2=X,X=$P(X,".",1)'=$P(X1,".",1) D ^%DTC:X S X=X*1440+Y,SRVADPT(11)=X\1440
"RTN","SROAPIMS",44,0)
END S $P(^SRF(SRTN,208),"^",10)=$P(SRVADPT(5),"^"),SRINOUT=$P(^SRF(SRTN,0),"^",12) I SRVADPT(7)'="",SRVADPT(9)="" S SRVADPT(9)=$P($G(^SRF(SRTN,.2)),"^",10)
"RTN","SROAPIMS",45,0)
 I SRVADPT(7)'="" S $P(^SRF(SRTN,205),"^")=SRVADPT(11),L=6 F J=14:1:17 S L=L+1,$P(^SRF(SRTN,208),"^",J)=$P(SRVADPT(L),"^")
"RTN","SROAPIMS",46,0)
 I SRVADPT(7)="" S $P(^SRF(SRTN,205),"^")=$S(SRINOUT="O":"NA",1:SRVADPT(11)) S L=6 F J=14:1:17 S L=L+1 S $P(^SRF(SRTN,208),"^",J)=$S(SRINOUT="O":"NA",1:$P(SRVADPT(L),"^"))
"RTN","SROAPIMS",47,0)
 I SRVADPT(12)="" F J=1:1:3 S $P(^SRF(SRTN,208.1),"^",J)="NA"
"RTN","SROAPIMS",48,0)
 D MCAR,EMPLOY
"RTN","SROAPIMS",49,0)
 D KVA^VADPT K DIE,DR,I,SR,SR24,SR48,SRCC,SRD,SRDD,SRDO,SRDT,SRF,SRINOUT,SRNON,SRSP,SRSRV,SRQ,SRX,SRY,X,X1,Y
"RTN","SROAPIMS",50,0)
 Q
"RTN","SROAPIMS",51,0)
PRIOR ; loop through previous movements
"RTN","SROAPIMS",52,0)
 S SRX=$P(VAIP(15,6),"^") D SERV D  I SRSRV,VAIP(15) G PRIOR
"RTN","SROAPIMS",53,0)
 .I SRSRV S SRSERV=VAIP(15,1),VAIP("D")=$P(SRSERV,"^") D IN5^VADPT Q
"RTN","SROAPIMS",54,0)
 S SRVADPT(9)=$E($P(SRSERV,"^"),1,12)
"RTN","SROAPIMS",55,0)
 Q
"RTN","SROAPIMS",56,0)
SERV ; find service associated with movement
"RTN","SROAPIMS",57,0)
 S SRSRV="" D SPEC S Y="50,51,52,53,54,55,56,57,58,59,60,61,62,63" S:Y[SRSP SRSRV=1
"RTN","SROAPIMS",58,0)
 Q
"RTN","SROAPIMS",59,0)
SPEC ; find specialty associated with movement
"RTN","SROAPIMS",60,0)
 K DA,DIC,DIQ,DR,SRY S DIC=45.7,DR=1,DA=SRX,DIQ="SRY",DIQ(0)="I" D EN^DIQ1 S SRSP=SRY(45.7,SRX,1,"I") I SRSP,$L(SRSP)=1 S SRSP="0"_SRSP
"RTN","SROAPIMS",61,0)
 Q
"RTN","SROAPIMS",62,0)
NACUTE ; determine if non-acute care transfer
"RTN","SROAPIMS",63,0)
 D SPEC S Y="05,20,21,22,25,26,27,28,29,32,33,34,35,40,70,71,72,73,74,75,76,77,79,80,81,83,84,85,86,87,88,89,90,91,92,93,98,99" S:Y[SRSP SRNON=1
"RTN","SROAPIMS",64,0)
 Q
"RTN","SROAPIMS",65,0)
MCAR S (SRD,SRF,SRQ)=0,DFN=$P(^SRF(SRTN,0),"^"),SRDO=$P(^SRF(SRTN,0),"^",9)
"RTN","SROAPIMS",66,0)
 F  S SRD=$O(^MCAR(690,"AC",DFN,SRD)) Q:SRD=""!(SRQ=9)  S SRF=0 F  S SRF=$O(^MCAR(690,"AC",DFN,SRD,SRF)) Q:SRF=""!(SRQ=9)  I SRF="MCAR(691.1" D
"RTN","SROAPIMS",67,0)
 .S SRDD=9999999.9999-SRD
"RTN","SROAPIMS",68,0)
 .I SRDD<SRDO S $P(^SRF(SRTN,207),"^",21)=SRDD,SRQ=9
"RTN","SROAPIMS",69,0)
 Q
"RTN","SROAPIMS",70,0)
EMPLOY ; employment status preoperatively
"RTN","SROAPIMS",71,0)
 S DFN=$P(^SRF(SRTN,0),"^") D OPD^VADPT S $P(^SRF(SRTN,208),"^",18)=$P(VAPD(7),"^")
"RTN","SROAPIMS",72,0)
 Q
"RTN","SROAPIMS",73,0)
ADM1 ; get information related to admission
"RTN","SROAPIMS",74,0)
 ; determine if admission was for observation
"RTN","SROAPIMS",75,0)
 ; quit if no specialty defined for admission
"RTN","SROAPIMS",76,0)
 S SRX=$P($G(VAIP(13,6)),"^") I SRX="" S SRSOUT=1 Q
"RTN","SROAPIMS",77,0)
 D SPEC S Y="18,23,24,36,41,65,94" I Y[SRSP D  Q:SRSOUT
"RTN","SROAPIMS",78,0)
 .S SRVADPT(14)=SRSP,SRVADPT(12)=$E($P(VAIP(13,1),"^"),1,12),SRVADPT(13)=$E($P(VAIP(17,1),"^"),1,12)
"RTN","SROAPIMS",79,0)
 .S I=1 F J=12:1:14 S $P(^SRF(SRTN,208.1),"^",I)=SRVADPT(J),I=I+1
"RTN","SROAPIMS",80,0)
 .; look for admission following discharge from observation
"RTN","SROAPIMS",81,0)
 .S X1=$P($G(^SRF(SRTN,.2)),"^",12),X2=2 D C^%DTC S SR48=X,SRDT=$O(^DGPM("APTT1",DFN,$P(VAIP(13,1),"^"))) I 'SRDT!(SRDT>SR48) S SRSOUT=1 Q
"RTN","SROAPIMS",82,0)
 .S VAIP("D")=SRDT D IN5^VADPT I 'VAIP(13) S SRSOUT=1
"RTN","SROAPIMS",83,0)
 S SRVADPT(7)=$E($P(VAIP(13,1),"^"),1,12),SRVADPT(8)=$E($P(VAIP(17,1),"^"),1,12),SRSAVE=$S(SRVADPT(7)<SRSDATE:SRSDATE,1:$P(VAIP(13,1),"^"))
"RTN","SROAPM")
0^32^B40056466
"RTN","SROAPM",1,0)
SROAPM ;B'HAM ISC/ADM - PATIENT DEMOGRAPHIC INFO ; [ 01/29/01  9:47 AM ]
"RTN","SROAPM",2,0)
 ;;3.0; Surgery ;**47,81,111,107,100**;24 Jun 93
"RTN","SROAPM",3,0)
 I '$D(SRTN) W !!,"A Surgery Risk Assessment must be selected prior to using this option.",!!,"Press <RET> to continue  " R X:DTIME G END
"RTN","SROAPM",4,0)
 S SRSOUT=0 D ^SROAUTL
"RTN","SROAPM",5,0)
START G:SRSOUT END D HDR^SROAUTL
"RTN","SROAPM",6,0)
 S DIR("A",1)="Enter/Edit Patient Demographic Information",DIR("A",2)=" ",DIR("A",3)="1. Capture Information from PIMS Records",DIR("A",4)="2. Enter, Edit, or Review Information",DIR("A",5)=" "
"RTN","SROAPM",7,0)
 S DIR("?",1)="Enter '1' if you want to capture patient movement information from PIMS",DIR("?",2)="records.  Enter '2' if you want to enter, edit, or review patient",DIR("?")="movement and other information on this screen."
"RTN","SROAPM",8,0)
 S DIR("A")="Select Number",DIR(0)="NO^1:2" D ^DIR K DIR I $D(DTOUT)!$D(DUOUT)!'Y S SRSOUT=1 G END
"RTN","SROAPM",9,0)
 I Y=1 D PIMS G START
"RTN","SROAPM",10,0)
EDIT S SRR=0 D HDR^SROAUTL K DR S SRQ=0,(DR,SRDR)="413;452;453;454;418;419;420;421;247;.011"
"RTN","SROAPM",11,0)
 K DA,DIC,DIQ,SRY S DIC="^SRF(",DA=SRTN,DIQ="SRY",DIQ(0)="E",DR=SRDR D EN^DIQ1 K DA,DIC,DIQ,DR
"RTN","SROAPM",12,0)
 K SRX S SRX=0 F M=1:1 S I=$P(SRDR,";",M)  Q:'I  D
"RTN","SROAPM",13,0)
 .D TR,GET
"RTN","SROAPM",14,0)
 .S SRX=SRX+1,Y=$P(X,";;",2),SRFLD=$P(Y,"^"),(Z,SRX(SRX))=$P(Y,"^",2)_"^"_SRFLD,SREXT=SRY(130,SRTN,SRFLD,"E")
"RTN","SROAPM",15,0)
 .W !,$S($L(SRX)<2:" "_SRX,1:SRX)_". "_$P(Z,"^")_":" D EXT
"RTN","SROAPM",16,0)
 ;
"RTN","SROAPM",17,0)
 D DEM^VADPT
"RTN","SROAPM",18,0)
 ;Find patient's ethnicity and list it on the display
"RTN","SROAPM",19,0)
 W !,"11. Patient's Ethnicity:" D
"RTN","SROAPM",20,0)
 .I $G(VADM(11)) W ?40,$P(VADM(11,1),U,2)
"RTN","SROAPM",21,0)
 .I '$G(VADM(11)) W ?40,"UNANSWERED"
"RTN","SROAPM",22,0)
 ;
"RTN","SROAPM",23,0)
 ;Find all race entries and place into a string with commas inbetween
"RTN","SROAPM",24,0)
 S SRORC=0,C=1,SRORACE="",SROLINE="",N=1,SROL=""
"RTN","SROAPM",25,0)
 F  S SRORC=$O(VADM(12,SRORC)) Q:SRORC=""  Q:C=11  D
"RTN","SROAPM",26,0)
 .I $G(VADM(12,SRORC)) S SRORACE(C)=$P(VADM(12,SRORC),U,2)
"RTN","SROAPM",27,0)
 .I SROLINE'="" S SROLINE=SROLINE_", "_SRORACE(C)
"RTN","SROAPM",28,0)
 .I SROLINE="" S SROLINE=SRORACE(C)
"RTN","SROAPM",29,0)
 .S C=C+1
"RTN","SROAPM",30,0)
 ;
"RTN","SROAPM",31,0)
 ;Find total length of 'race' string and wrap the text if necessary
"RTN","SROAPM",32,0)
 I $L(SROLINE)=40!$L(SROLINE)<40 S SROL(N)=SROLINE,SRNUM1=2
"RTN","SROAPM",33,0)
 I $L(SROLINE)>40 D WRAP
"RTN","SROAPM",34,0)
 ;
"RTN","SROAPM",35,0)
 W !,"12. Patient's Race:"
"RTN","SROAPM",36,0)
 I $G(VADM(12)) F D=1:1:SRNUM1-1 D
"RTN","SROAPM",37,0)
 .W:D=1 ?40,SROL(D)
"RTN","SROAPM",38,0)
 .W:D'=1 !,?40,SROL(D)
"RTN","SROAPM",39,0)
 ;
"RTN","SROAPM",40,0)
 I '$G(VADM(12)) W ?40,"UNANSWERED"
"RTN","SROAPM",41,0)
 ;
"RTN","SROAPM",42,0)
 K SROL,SROLINE,SRORC,SRORACE,SROLN,SROLN1,SROWRAP,SRNUM1
"RTN","SROAPM",43,0)
 ;
"RTN","SROAPM",44,0)
 W !! F K=1:1:80 W "-"
"RTN","SROAPM",45,0)
 D SEL G:SRR=1 EDIT
"RTN","SROAPM",46,0)
 S SROERR=SRTN D ^SROERR0
"RTN","SROAPM",47,0)
 G START
"RTN","SROAPM",48,0)
 Q
"RTN","SROAPM",49,0)
 ;
"RTN","SROAPM",50,0)
WRAP ;Wrap multiple race entries so that wrapped line
"RTN","SROAPM",51,0)
 ;does not break in the middle of a word
"RTN","SROAPM",52,0)
 ;
"RTN","SROAPM",53,0)
 S SROLNGTH=$L(SROLINE),E=40,SROWRAP="",SROLN="",SROLN1="",SROL=""
"RTN","SROAPM",54,0)
 F I=1:40:SROLNGTH S SROLN(I)=SROWRAP_$E(SROLINE,I,E) D
"RTN","SROAPM",55,0)
 .F K=40:-1:1 I $E(SROLN(I),K)[" " D  Q    ;Break lines at space
"RTN","SROAPM",56,0)
 ..S SROLN1(I)=$E(SROLN(I),1,K-1)
"RTN","SROAPM",57,0)
 ..S SROWRAP=$E(SROLN(I),K+1,E)
"RTN","SROAPM",58,0)
 .S E=E+40
"RTN","SROAPM",59,0)
 ;
"RTN","SROAPM",60,0)
 S:'$D(SROLN1(I)) SROLN1(I)=SROLN(I),SROWRAP=""
"RTN","SROAPM",61,0)
 I $L(SROLN1(I))+$L(SROWRAP)>39 S SROLN1(I+1)=SROWRAP   ;Last line 
"RTN","SROAPM",62,0)
 I $L(SROLN1(I))+$L(SROWRAP)'>39 S SROLN1(I)=SROLN1(I)_" "_SROWRAP
"RTN","SROAPM",63,0)
 ;
"RTN","SROAPM",64,0)
 ;Renumber the SROLN1 array to be in numeric order
"RTN","SROAPM",65,0)
 S SRNUM=0,SRNUM1=1
"RTN","SROAPM",66,0)
 F  S SRNUM=$O(SROLN1(SRNUM)) Q:SRNUM=""  D
"RTN","SROAPM",67,0)
 .S SROL(SRNUM1)=SROLN1(SRNUM)
"RTN","SROAPM",68,0)
 .S SRNUM1=SRNUM1+1
"RTN","SROAPM",69,0)
 Q
"RTN","SROAPM",70,0)
 ;
"RTN","SROAPM",71,0)
EXT I $L(SREXT)<40 W ?40,SREXT W:SRFLD=247 $S(SREXT="":"",SREXT=1:" Day",SREXT=0:" Days",SREXT>1:" Days",1:"") Q
"RTN","SROAPM",72,0)
 N I,J,X,Y S X=SREXT F  D  W:$L(X) ! I $L(X)<40!(X'[" ") W ?40,X Q
"RTN","SROAPM",73,0)
 .F I=0:1:38 S J=39-I,Y=$E(X,J) I Y=" " W ?40,$E(X,1,J-1) S X=$E(X,J+1,$L(X)) Q
"RTN","SROAPM",74,0)
 Q
"RTN","SROAPM",75,0)
SEL W !!,"Select number of item to edit: " R X:DTIME I '$T!(X["^") S SRSOUT=1 Q
"RTN","SROAPM",76,0)
 I (X=11)!(X=12) S SRR=1 W !!,"The Patient's Race and Ethnicity information cannot be updated through the" D  Q
"RTN","SROAPM",77,0)
 .W !,"Surgery package options."
"RTN","SROAPM",78,0)
 .W !!,"Press RETURN to continue " R X:DTIME
"RTN","SROAPM",79,0)
 Q:X=""  S:X="a" X="A" I '$D(SRFLG),'$D(SRX(X)),(X'?1.2N1":"1.2N),X'="A" D HELP S SRR=1 Q
"RTN","SROAPM",80,0)
 I X?1.2N1":"1.2N S Y=$P(X,":"),Z=$P(X,":",2) I Y<1!(Z>SRX)!(Y>Z) D HELP S SRR=1 Q
"RTN","SROAPM",81,0)
 I X="A" S X="1:"_SRX
"RTN","SROAPM",82,0)
 I X?1.2N1":"1.2N D RANGE S SRR=1 Q
"RTN","SROAPM",83,0)
 I $D(SRX(X)),+X=X S EMILY=X D  S SRR=1
"RTN","SROAPM",84,0)
 .I $$LOCK^SROUTL(SRTN) D ONE,UNLOCK^SROUTL(SRTN)
"RTN","SROAPM",85,0)
 Q
"RTN","SROAPM",86,0)
PIMS ; get update from PIMS records
"RTN","SROAPM",87,0)
 W ! K DIR S DIR("A")="Are you sure you want to retrieve information from PIMS records ? ",DIR("B")="YES",DIR(0)="YOA" D ^DIR K DIR I $D(DTOUT)!$D(DUOUT)!'Y Q
"RTN","SROAPM",88,0)
 I $$LOCK^SROUTL(SRTN) D  D UNLOCK^SROUTL(SRTN)
"RTN","SROAPM",89,0)
 .W ! D WAIT^DICD D ^SROAPIMS
"RTN","SROAPM",90,0)
 Q
"RTN","SROAPM",91,0)
HELP W @IOF,!!!!,"Enter the number or range of numbers you want to edit.  Examples of proper",!,"responses are listed below.",!!,"NOTE: Items 11 and 12 cannot be updated through the surgery package options."
"RTN","SROAPM",92,0)
 W !!,"1. Enter 'A' to update items 1 through 10.",!!,"2. Enter a number (1-"_SRX_") to update an individual item.  (For example,",!,"   enter '1' to update "_$P(SRX(1),"^")_")"
"RTN","SROAPM",93,0)
 W !!,"3. Enter a range of numbers (1-"_SRX_") separated by a ':' to enter a range",!,"   of items.  (For example, enter '1:4' to update items 1, 2, 3 and 4.)",!
"RTN","SROAPM",94,0)
 I $D(SRFLG) W !,"4. Enter 'N' or 'NO' to enter negative response for all items.",!!,"5. Enter '@' to delete information from all items.",!
"RTN","SROAPM",95,0)
PRESS W ! K DIR S DIR("A")="Press the return key to continue or '^' to exit: ",DIR(0)="FOA" D ^DIR K DIR I $D(DTOUT)!$D(DUOUT) S SRSOUT=1
"RTN","SROAPM",96,0)
 Q
"RTN","SROAPM",97,0)
RANGE ; range of numbers
"RTN","SROAPM",98,0)
 I $$LOCK^SROUTL(SRTN) D  D UNLOCK^SROUTL(SRTN)
"RTN","SROAPM",99,0)
 .S SHEMP=$P(X,":"),CURLEY=$P(X,":",2) F EMILY=SHEMP:1:CURLEY Q:SRSOUT  D ONE
"RTN","SROAPM",100,0)
 Q
"RTN","SROAPM",101,0)
ONE ; edit one item
"RTN","SROAPM",102,0)
 K DR,DA,DIE S DR=$P(SRX(EMILY),"^",2)_"T",DA=SRTN,DIE=130,SRDT=$P(SRX(EMILY),"^",3) S:SRDT DR=DR_";"_SRDT_"T" D ^DIE K DR,DA I $D(Y) S SRSOUT=1
"RTN","SROAPM",103,0)
 Q
"RTN","SROAPM",104,0)
TR S J=I,J=$TR(J,"1234567890.","ABCDEFGHIJP")
"RTN","SROAPM",105,0)
 Q
"RTN","SROAPM",106,0)
GET S X=$T(@J)
"RTN","SROAPM",107,0)
 Q
"RTN","SROAPM",108,0)
END W @IOF D ^SRSKILL
"RTN","SROAPM",109,0)
 Q
"RTN","SROAPM",110,0)
PJAA ;;.011^In/Out-Patient Status
"RTN","SROAPM",111,0)
BDG ;;247^Length of Postop Hospital Stay
"RTN","SROAPM",112,0)
DAC ;;413^Transfer Status
"RTN","SROAPM",113,0)
DAG ;;417^Patient's Race
"RTN","SROAPM",114,0)
DAH ;;418^Hospital Admission Date
"RTN","SROAPM",115,0)
DAI ;;419^Hospital Discharge Date
"RTN","SROAPM",116,0)
DBJ ;;420^Admit/Transfer to Surgical Svc.
"RTN","SROAPM",117,0)
DBA ;;421^Discharge/Transfer to Chronic Care
"RTN","SROAPM",118,0)
DEB ;;452^Observation Admission Date/Time
"RTN","SROAPM",119,0)
DEC ;;453^Observation Discharge Date/Time
"RTN","SROAPM",120,0)
DED ;;454^Observation Treating Specialty
"RTN","SROAPR2")
0^33^B8412750
"RTN","SROAPR2",1,0)
SROAPR2 ;B'HAM ISC/MAM - PAGE 2 PREOP SCREEN ; [ 01/29/01  12:38 PM ]
"RTN","SROAPR2",2,0)
 ;;3.0; Surgery ;**38,100**;24 Jun 93
"RTN","SROAPR2",3,0)
 K SRA,SRAO
"RTN","SROAPR2",4,0)
START Q:SRSOUT  D:SRACLR RET S SRACLR=0 K SRA,SRAO D ^SROAPS2
"RTN","SROAPR2",5,0)
ASK W !!,"Select Preoperative Information to Edit: " R X:DTIME I '$T!("^"[X) D CONCC^SROAPRE S SRSOUT=1 Q
"RTN","SROAPR2",6,0)
 S:X="a" X="A" I '$D(SRAO(X)),(X'?1N1":"1N),(X'="A") D HELP Q:SRSOUT  G START
"RTN","SROAPR2",7,0)
 I X="A" S X="1:2"
"RTN","SROAPR2",8,0)
 I X?1N1":"1N S Y=$E(X),Z=$P(X,":",2) I Y<1!(Z>2)!(Y>Z) D HELP Q:SRSOUT  G START
"RTN","SROAPR2",9,0)
 S SRPAGE="" D HDR^SROAUTL
"RTN","SROAPR2",10,0)
 I X?1N1":"1N D RANGE G START
"RTN","SROAPR2",11,0)
 I $D(SRAO(X)),+X=X S EMILY=X D  G START
"RTN","SROAPR2",12,0)
 .I $$LOCK^SROUTL(SRTN) D ^SROAPRE2,UNLOCK^SROUTL(SRTN)
"RTN","SROAPR2",13,0)
 I $D(SRAO(X)) D  G START
"RTN","SROAPR2",14,0)
 .I $$LOCK^SROUTL(SRTN) W !! S DA=SRTN,DIE=130,DR=$P(SRAO(X),"^",2)_"T" D ^DIE K DA,DIE,DR D UNLOCK^SROUTL(SRTN)
"RTN","SROAPR2",15,0)
 S SRSOUT=1 Q
"RTN","SROAPR2",16,0)
HELP W @IOF,!!!!,"Enter the number, number/letter combination, or range of numbers you want to",!,"edit.  Examples of proper responses are listed below."
"RTN","SROAPR2",17,0)
 W !!,"1. Enter 'A' to update all information.",!!,"2. Enter a number (1-2) to update the information in that group.  (For",!,"   example, enter '1' to update all Central Nervous System information)"
"RTN","SROAPR2",18,0)
 W !!,"3. Enter a number/letter combination to update a specific occurrence. (To ",!,"   update Impaired Sensorium, enter '1A')"
"RTN","SROAPR2",19,0)
 W !!,"4. Enter a range of numbers (1-2) separated by a ':' to enter all",!,"   Central Nervous System and Nutritional/Immune/Other information."
"RTN","SROAPR2",20,0)
 W !!,"Press <RET> to continue, or '^' to quit  " R X:DTIME I '$T!(X["^") S SRSOUT=1
"RTN","SROAPR2",21,0)
 Q
"RTN","SROAPR2",22,0)
RANGE ; range of numbers
"RTN","SROAPR2",23,0)
 I $$LOCK^SROUTL(SRTN) D  D UNLOCK^SROUTL(SRTN)
"RTN","SROAPR2",24,0)
 .F EMILY=1,2 D ^SROAPRE2 Q:SRSOUT
"RTN","SROAPR2",25,0)
 Q
"RTN","SROAPR2",26,0)
RET Q:SRSOUT  W !!,"Press <RET> to continue, or '^' to quit  " R X:DTIME I '$T!(X["^") S SRSOUT=1 Q
"RTN","SROAPR2",27,0)
 Q
"RTN","SROAPRE")
0^34^B13507284
"RTN","SROAPRE",1,0)
SROAPRE ;BIR/MAM - PREOPERATIVE INFO ; [ 01/29/01  9:59 AM ]
"RTN","SROAPRE",2,0)
 ;;3.0; Surgery ;**38,47,55,88,100**;24 Jun 93
"RTN","SROAPRE",3,0)
 I '$D(SRTN) W !!,"A Surgery Risk Assessment must be selected prior to using this option.",!!,"Press <RET> to continue  " R X:DTIME G END
"RTN","SROAPRE",4,0)
 S (SRSOUT,SRACLR)=0 D ^SROAUTL,DUP^SROAUTL G:SRSOUT END
"RTN","SROAPRE",5,0)
START D:SRACLR RET G:SRSOUT END S SRACLR=0 K SRA,SRAO D ^SROAPS1
"RTN","SROAPRE",6,0)
ASK W !!,"Select Preoperative Information to Edit: " R X:DTIME I '$T!(X["^") D CONCC G END
"RTN","SROAPRE",7,0)
 S:X="" X="+1" S:X="a" X="A" I '$D(SRAO(X)),(X'?.N1":".N),(X'="A"),(X'="+1") D HELP G:SRSOUT END G START
"RTN","SROAPRE",8,0)
 I X="+1" D CONCC,^SROAPR2 G START
"RTN","SROAPRE",9,0)
 I X="A" S X="1:5"
"RTN","SROAPRE",10,0)
 I X?.N1":".N S Y=$E(X),Z=$P(X,":",2) I Y<1!(Z>5)!(Y>Z) D HELP G:SRSOUT END G START
"RTN","SROAPRE",11,0)
 S SRPAGE="" D HDR^SROAUTL
"RTN","SROAPRE",12,0)
 I X?.N1":".N D RANGE G START
"RTN","SROAPRE",13,0)
 I $D(SRAO(X)),+X=X S EMILY=X D  G START
"RTN","SROAPRE",14,0)
 .I $$LOCK^SROUTL(SRTN) W ! D:EMILY<4 ^SROAPRE1 D:EMILY>3 ^SROAPR1A D UNLOCK^SROUTL(SRTN)
"RTN","SROAPRE",15,0)
 I $D(SRAO(X)),$$LOCK^SROUTL(SRTN) S SRX=X W ! K DR,DIE S DA=SRTN,DR=$P(SRAO(X),"^",2)_"T",DIE=130 D ^DIE K DR D UNLOCK^SROUTL(SRTN)
"RTN","SROAPRE",16,0)
 G START
"RTN","SROAPRE",17,0)
END I '$D(SREQST) W @IOF D ^SRSKILL
"RTN","SROAPRE",18,0)
 Q
"RTN","SROAPRE",19,0)
HELP W @IOF,!!!!,"Enter the number, number/letter combination, or range of numbers you want to",!,"edit.  Examples of proper responses are listed below."
"RTN","SROAPRE",20,0)
 W !!,"1. Enter 'A' to update all information.",!!,"2. Enter a number (1-5) to update the information in that group.  (For",!,"   example, enter '4' to update all cardiac information)"
"RTN","SROAPRE",21,0)
 W !!,"3. Enter a number/letter combination to update a specific occurrence. (To ",!,"   update Current Pneumonia, enter '2C'.)"
"RTN","SROAPRE",22,0)
 W !!,"4. Enter a range of numbers (1-5) separated by a ':' to enter a range of",!,"   occurrences.  (For example, enter '2:4' to enter all pulmonary,",!,"   hepatobiliary, and cardiac information)"
"RTN","SROAPRE",23,0)
 W !!,"5. Press <RET> to continue to page 2 of this option."
"RTN","SROAPRE",24,0)
 W !!,"Press <RET> to continue, or '^' to quit  " R X:DTIME I '$T!(X["^") S SRSOUT=1
"RTN","SROAPRE",25,0)
 Q
"RTN","SROAPRE",26,0)
RANGE ; range of numbers
"RTN","SROAPRE",27,0)
 I $$LOCK^SROUTL(SRTN) D  D UNLOCK^SROUTL(SRTN)
"RTN","SROAPRE",28,0)
 .S SHEMP=$P(X,":"),CURLEY=$P(X,":",2) W:SHEMP<9 ! F EMILY=SHEMP:1:CURLEY Q:SRSOUT  D:EMILY<4 ^SROAPRE1 D:EMILY>3 ^SROAPR1A
"RTN","SROAPRE",29,0)
 Q
"RTN","SROAPRE",30,0)
RET Q:SRSOUT  W !!,"Press <RET> to continue, or '^' to quit  " R X:DTIME I '$T!(X["^") S SRSOUT=1 Q
"RTN","SROAPRE",31,0)
 Q
"RTN","SROAPRE",32,0)
CONCC ; check for concurrent case and update if one exists
"RTN","SROAPRE",33,0)
 S SRCON=$P($G(^SRF(SRTN,"CON")),"^") Q:'SRCON
"RTN","SROAPRE",34,0)
 Q:$P($G(^SRF(SRCON,"RA")),"^",2)="C"
"RTN","SROAPRE",35,0)
 S SRI="" F  S SRI=$O(SRAO(SRI)) Q:SRI=""  S SRZ=$P(SRAO(SRI),"^",2) K DA,DIC,DIQ,DR,SRY D
"RTN","SROAPRE",36,0)
 .S DA=SRTN,DR=SRZ,DIC="^SRF(",DIQ="SRY",DIQ(0)="I" D EN^DIQ1 S SRX=SRY(130,SRTN,SRZ,"I") S:SRX="" SRX="@"
"RTN","SROAPRE",37,0)
 .I $$LOCK^SROUTL(SRTN) K DA,DIE,DR S DA=SRCON,DIE=130,DR=SRZ_"////"_SRX D ^DIE K DR D UNLOCK^SROUTL(SRTN)
"RTN","SROAPRE",38,0)
 Q
"RTN","SROARET")
0^128^B20117974
"RTN","SROARET",1,0)
SROARET ;BIR/MAM - UPDATE RETURNS ; [ 05/13/99  12:27 PM ]
"RTN","SROARET",2,0)
 ;;3.0; Surgery ;**16,19,38,46,88,100**;24 Jun 93
"RTN","SROARET",3,0)
 I '$D(SRTN) S SRTN1=1 D ^SROPS I '$D(SRTN) S SRSOUT=1 G END1
"RTN","SROARET",4,0)
 D ^SROAUTL S SRNAME=VADM(1),SRSOUT=0,SR(0)=^SRF(SRTN,0),SRLINE="" F I=1:1:79 S SRLINE=SRLINE_"-"
"RTN","SROARET",5,0)
 S SRT=$P($G(^SRF(SRTN,.2)),"^",10),(SRSDATE,X1)=$E($P(SR(0),"^",9),1,7),X2=30 D C^%DTC S SRENDT=X,END=SRENDT+.9999 K SRETURN
"RTN","SROARET",6,0)
 S SRCASE=0 F  S SRCASE=$O(^SRF(SRTN,29,SRCASE)) Q:'SRCASE  D
"RTN","SROARET",7,0)
 .S CASE=$P(^SRF(SRTN,29,SRCASE,0),"^"),SRCT=$P(^SRF(CASE,0),"^",9),SRT1=$P($G(^SRF(CASE,.2)),"^",10)
"RTN","SROARET",8,0)
 .I $E(SRCT,1,7)<SRSDATE!(SRCT=$P(SR(0),"^",9))!(SRCT>END)!$P($G(^SRF(CASE,30)),"^")!$P($G(^SRF(CASE,31)),"^",8)!$P($G(^SRF(CASE,37)),"^") D DEL Q
"RTN","SROARET",9,0)
 .I SRT,SRT1,SRT>SRT1 D DEL
"RTN","SROARET",10,0)
 S SRCASE=0 F  S SRCASE=$O(^SRF("B",DFN,SRCASE)) Q:'SRCASE  I SRCASE'=SRTN D CHECK
"RTN","SROARET",11,0)
 I '$O(^SRF(SRTN,29,0)) W !!,"There are no surgical cases entered for "_SRNAME_"",!,"within 30 days of this operation." G END
"RTN","SROARET",12,0)
RETURN S SRPAGE="RETURNS TO SURGERY" D HDR^SROAUTL
"RTN","SROARET",13,0)
 S (SRCASE,CNT)=0 F  S SRCASE=$O(^SRF(SRTN,29,SRCASE)) Q:'SRCASE  D
"RTN","SROARET",14,0)
 .S CNT=CNT+1,X=$P(^SRF(SRTN,29,SRCASE,0),"^",3) I X="" S X="U",$P(^SRF(SRTN,29,SRCASE,0),"^",3)=X
"RTN","SROARET",15,0)
 .S SRELATE=$S(X="U":"UNRELATED",1:"RELATED"),SRETURN(CNT)=SRCASE_"^"_SRELATE D LIST
"RTN","SROARET",16,0)
 I '$D(SRETURN(2)) S X=1 D RELATED G END
"RTN","SROARET",17,0)
 W !,SRLINE,!
"RTN","SROARET",18,0)
PICK W !!,"Select Number: " R X:DTIME I '$T!("^"[X) S SRSOUT=1 G END
"RTN","SROARET",19,0)
 I '$D(SRETURN(X)) W !!,"Select the number corresponding to the return which you want to update, or",!,"enter RETURN to quit this option.",!!,"Press RETURN to continue  " R X:DTIME G RETURN
"RTN","SROARET",20,0)
 D RELATED G RETURN
"RTN","SROARET",21,0)
DEL ; delete returns
"RTN","SROARET",22,0)
 S DA(1)=SRTN,DA=SRCASE,DIK="^SRF("_SRTN_",29," D ^DIK
"RTN","SROARET",23,0)
 Q
"RTN","SROARET",24,0)
CHECK ; add to RETURNS if necessary
"RTN","SROARET",25,0)
 Q:$P($G(^SRF(SRCASE,"NON")),"^")="Y"!$P($G(^SRF(SRCASE,37)),"^")  S CAN=$P($G(^SRF(SRCASE,30)),"^") I CAN Q
"RTN","SROARET",26,0)
 S CAN=$P($G(^SRF(SRCASE,31)),"^",8) I CAN'="" Q
"RTN","SROARET",27,0)
 S CON=$P($G(^SRF(SRTN,"CON")),"^") I CON=SRCASE Q
"RTN","SROARET",28,0)
 S DATE=$P(^SRF(SRCASE,0),"^",9),SRT1=$P($G(^SRF(SRCASE,.2)),"^",10) I $E(DATE,1,7)<SRSDATE!(DATE>END)!(DATE=$P(SR(0),"^",9)) Q
"RTN","SROARET",29,0)
 I SRT,SRT1,SRT>SRT1 Q
"RTN","SROARET",30,0)
 I $D(^SRF(SRTN,29,SRCASE,0)) Q
"RTN","SROARET",31,0)
 I '$D(^SRF(SRTN,29,0)) S ^SRF(SRTN,29,0)="^130.43PA^^"
"RTN","SROARET",32,0)
 K DA,DO,DD,DA,DINUM,DIC S DA(1)=SRTN,DIC="^SRF("_SRTN_",29,",X=SRCASE,DINUM=X,DIC(0)="L",DLAYGO=130.43 D FILE^DICN K DD,DO,DIC,DINUM,DLAYGO
"RTN","SROARET",33,0)
 S $P(^SRF(SRTN,29,SRCASE,0),"^",3)="U"
"RTN","SROARET",34,0)
 Q
"RTN","SROARET",35,0)
LIST ; list returns
"RTN","SROARET",36,0)
 S SROPER=$P(^SRF(SRCASE,"OP"),"^"),CPT=$P(^("OP"),"^",2),SRCPT=$S(CPT:$P($$CPT^ICPTCOD(CPT),"^",2),1:"CPT MISSING") I CPT D MOD
"RTN","SROARET",37,0)
 S SROPER=SROPER_" ("_SRCPT_") - "_SRELATE
"RTN","SROARET",38,0)
 S DATE=$P(^SRF(SRCASE,0),"^",9),DATE=$E(DATE,4,5)_"/"_$E(DATE,6,7)_"/"_$E(DATE,2,3)
"RTN","SROARET",39,0)
 K SROPS,MM,MMM S:$L(SROPER)<65 SROPS(1)=SROPER I $L(SROPER)>64 S SROPER=SROPER_"  " F M=1:1 D LOOP Q:MMM=""
"RTN","SROARET",40,0)
 W !,CNT_".",?3,DATE,?15,SROPS(1) I $D(SROPS(2)) W !,?15,SROPS(2) I $D(SROPS(3)) W !,?15,SROPS(3)
"RTN","SROARET",41,0)
 W ! Q
"RTN","SROARET",42,0)
LOOP ; break procedures
"RTN","SROARET",43,0)
 S SROPS(M)="" F LOOP=1:1 S MM=$P(SROPER," "),MMM=$P(SROPER," ",2,200) Q:MMM=""  Q:$L(SROPS(M))+$L(MM)'<65  S SROPS(M)=SROPS(M)_MM_" ",SROPER=MMM
"RTN","SROARET",44,0)
 Q
"RTN","SROARET",45,0)
MOD ; append CPT modifiers to CPT code
"RTN","SROARET",46,0)
 N SRTN S SRTN=SRCASE,Y=SRCPT D SSPRIN^SROCPT S SRCPT=Y
"RTN","SROARET",47,0)
 Q
"RTN","SROARET",48,0)
UPDATE ; update single return
"RTN","SROARET",49,0)
END I 'SRSOUT W !!,"Press RETURN to continue  " R X:DTIME
"RTN","SROARET",50,0)
 D EXIT^SROES
"RTN","SROARET",51,0)
END1 D ^SRSKILL W @IOF
"RTN","SROARET",52,0)
 Q
"RTN","SROARET",53,0)
RELATED ; update RELATED/UNRELATED status
"RTN","SROARET",54,0)
 S RETURN=$P(SRETURN(X),"^"),SRELATE=$P(SRETURN(X),"^",2),OPPOSITE=$S(SRELATE["U":"RELATED",1:"UNRELATED")
"RTN","SROARET",55,0)
 I $D(SRETURN(2)) S SRPAGE="RETURNS TO SURGERY" D HDR^SROAUTL W ! S SRCASE=$P(SRETURN(X),"^"),CNT=X D LIST W !,SRLINE,!
"RTN","SROARET",56,0)
CHANGE W !!,"This return to surgery is currently defined as "_SRELATE_" to the case selected.",!,"Do you want to change this status ? NO// " R SRYN:DTIME I '$T!(SRYN["^") S SRSOUT=1 Q
"RTN","SROARET",57,0)
 S SRYN=$E(SRYN) I "YyNn"'[SRYN W !!,"Enter 'YES' to change the status of this return from "_SRELATE_" to "_OPPOSITE_".",!,"Enter 'NO' to leave the information unchanged.",! G CHANGE
"RTN","SROARET",58,0)
 S:SRYN="" SRYN="N" I "Yy"'[SRYN Q
"RTN","SROARET",59,0)
 S $P(^SRF(SRTN,29,RETURN,0),"^",3)=$E(OPPOSITE)
"RTN","SROARET",60,0)
 Q
"RTN","SROARPT")
0^35^B46605300
"RTN","SROARPT",1,0)
SROARPT ;B'HAM ISC/MAM,ADM - ANESTHESIA REPORT ; [ 02/19/04  11:06 AM ]
"RTN","SROARPT",2,0)
 ;;3.0; Surgery ;**100**;24 Jun 93
"RTN","SROARPT",3,0)
 ;
"RTN","SROARPT",4,0)
 ;** NOTICE: This routine is part of an implementation of a nationally
"RTN","SROARPT",5,0)
 ;**         controlled procedure.  Local modifications to this routine
"RTN","SROARPT",6,0)
 ;**         are prohibited.
"RTN","SROARPT",7,0)
 ;
"RTN","SROARPT",8,0)
 ; Reference to UPDATE^TIUSRVP supported by DBIA #3535
"RTN","SROARPT",9,0)
 ; Reference to ES^TIUSROI supported by DBIA #3537
"RTN","SROARPT",10,0)
 ;
"RTN","SROARPT",11,0)
 I '$D(SRSITE) D ^SROVAR G:'$D(SRSITE) END S SRSITE("KILL")=1
"RTN","SROARPT",12,0)
 I '$D(SRTN) K SRNEWOP D ^SROPS G:'$D(SRTN) END S SRTN("KILL")=1
"RTN","SROARPT",13,0)
 N SRDIV,SRDO,SRFUNCT,SRHDR,SRINUSE,SRLEAVE,SRLOC,SRPARAM,SRPRINT,SRSEL,SRSINED,SRDTITL,SRTIU,SRXX
"RTN","SROARPT",14,0)
 S SRDTITL="Anesthesia Report"
"RTN","SROARPT",15,0)
 S (SRFUNCT,SRLEAVE,SRSINED)=0,SRTIU=$P($G(^SRF(SRTN,"TIU")),"^",4)
"RTN","SROARPT",16,0)
 I SRTIU,$$STATUS^SROESUTL(SRTIU)=7 S SRSINED=1
"RTN","SROARPT",17,0)
 D:SRSINED FUNCT D:'SRSINED EN
"RTN","SROARPT",18,0)
ENF I 'SRLEAVE,SRFUNCT S SRSEL="" D FUNCT
"RTN","SROARPT",19,0)
 D END
"RTN","SROARPT",20,0)
 Q
"RTN","SROARPT",21,0)
DISPLY I SRSINED S SRTIU=$P($G(^SRF(SRTN,"TIU")),"^",4) I SRTIU D PRNT^SROESPR(SRTN,SRTIU,SRDTITL) S SRLEAVE=1 Q
"RTN","SROARPT",22,0)
 K %ZIS,IO("Q") S %ZIS="Q" D ^%ZIS I POP S SRLEAVE=1 Q
"RTN","SROARPT",23,0)
 I $D(IO("Q")) K IO("Q") N ZTRTN,ZTDESC,ZTSAVE,ZTQUEUED S ZTRTN="PRNT^SROARPT",ZTDESC=SRDTITL,(ZTSAVE("SRTN"),ZTSAVE("SRSITE*"))="" D ^%ZTLOAD,^%ZISC Q
"RTN","SROARPT",24,0)
EN D RPT^SROANR(SRTN) S DFN=$P(^SRF(SRTN,0),"^"),VAINDT=$P(^SRF(SRTN,0),"^",9)
"RTN","SROARPT",25,0)
 S Y=$E(VAINDT,1,7) D D^DIQ S SRSDATE=Y D OERR^VADPT
"RTN","SROARPT",26,0)
 S SRHDR=" "_VADM(1)_" ("_VA("PID")_")   Case #"_SRTN_" - "_SRSDATE
"RTN","SROARPT",27,0)
 S Y=$E($$NOW^XLFDT,1,12) D DD^%DT S SRPRINT="Printed: "_Y
"RTN","SROARPT",28,0)
 S SRLOC=" Pt Loc: "_$P(VAIN(4),"^",2)_"  "_VAIN(5)
"RTN","SROARPT",29,0)
 S SRAGE="",Z=$P(VADM(3),"^") I Z S X=$E($P(^SRF(SRTN,0),"^",9),1,12),Y=$E(X,1,7),SRAGE=$E(Y,1,3)-$E(Z,1,3)-($E(Y,4,7)<$E(Z,4,7))
"RTN","SROARPT",30,0)
 S SRPARAM=$$SITE^SROUTL0(SRTN) I SRPARAM S X=$P(^SRO(133,SRPARAM,0),"^"),SRDIV=$$EXTERNAL^DILFD(133,.01,"",X)
"RTN","SROARPT",31,0)
 S SRDIV=$S(SRDIV'="":SRDIV,1:SRSITE("SITE"))
"RTN","SROARPT",32,0)
 S SRINUSE=$P($G(^SRO(133,SRPARAM,.1)),"^",4)
"RTN","SROARPT",33,0)
 U IO S (SRPAGE,SRSOUT)=0,$P(SRLINE,"-",80)="" D HDR
"RTN","SROARPT",34,0)
 S SRI=0 F  S SRI=$O(^TMP("SRANE",$J,SRTN,SRI)) Q:'SRI  D  Q:SRSOUT
"RTN","SROARPT",35,0)
 .I $E(IOST)="P",$Y+11>IOSL D FOOT Q:SRSOUT  D HDR
"RTN","SROARPT",36,0)
 .I $E(IOST)'="P",$Y+4>IOSL D FOOT Q:SRSOUT  D HDR
"RTN","SROARPT",37,0)
 .W !,^TMP("SRANE",$J,SRTN,SRI)
"RTN","SROARPT",38,0)
 I SRSOUT D ^%ZISC Q
"RTN","SROARPT",39,0)
 D FOOT D  D ^%ZISC
"RTN","SROARPT",40,0)
 .I $D(SRALRT) S SRFUNCT=1 Q
"RTN","SROARPT",41,0)
 .I '$G(SRFUNCT) S SRLEAVE=1
"RTN","SROARPT",42,0)
 Q
"RTN","SROARPT",43,0)
SRHDR S DFN=$P(^SRF(SRTN,0),"^") D DEM^VADPT
"RTN","SROARPT",44,0)
 S Y=$E($P(^SRF(SRTN,0),"^",9),1,7) D D^DIQ S SRSDATE=Y
"RTN","SROARPT",45,0)
 S SRHDR=" "_VADM(1)_" ("_VA("PID")_")   Case #"_SRTN_" - "_SRSDATE
"RTN","SROARPT",46,0)
 Q
"RTN","SROARPT",47,0)
PRNT N SRDIV,SRFUNCT,SRLEAVE D EN
"RTN","SROARPT",48,0)
END K ^TMP("SRANE",$J)
"RTN","SROARPT",49,0)
 W @IOF I $D(ZTQUEUED) Q:$G(ZTSTOP)  S ZTREQ="@" Q
"RTN","SROARPT",50,0)
 D ^SRSKILL K VAIN,VAINDT I $D(SRSITE("KILL")) K SRSITE
"RTN","SROARPT",51,0)
 I $D(SRTN("KILL")) K SRTN
"RTN","SROARPT",52,0)
 Q
"RTN","SROARPT",53,0)
PAGE I 'SRINUSE!'$D(^XUSEC("SROANES",DUZ)) D LAST Q
"RTN","SROARPT",54,0)
 S (SRFUNCT,SRSOUT)=0
"RTN","SROARPT",55,0)
 W ! K DIR S DIR(0)="FOA",DIR("A",1)=" Press <return> to continue, 'A' to access Anesthesia Report functions",DIR("A")=" or '^' to exit: " D ^DIR K DIR I $D(DTOUT)!$D(DUOUT) S (SRLEAVE,SRSOUT)=1 Q
"RTN","SROARPT",56,0)
 I X="A"!(X="a") S (SRFUNCT,SRSOUT)=1
"RTN","SROARPT",57,0)
 Q
"RTN","SROARPT",58,0)
LAST W ! K DIR S DIR(0)="E" D ^DIR K DIR I $D(DTOUT)!$D(DUOUT) S SRSOUT=1
"RTN","SROARPT",59,0)
 Q
"RTN","SROARPT",60,0)
FOOT ; print footer
"RTN","SROARPT",61,0)
 Q:SRSOUT  I $E(IOST)'="P" D PAGE Q
"RTN","SROARPT",62,0)
 I IOSL-9>$Y F X=$Y:1:(IOSL-10) W !
"RTN","SROARPT",63,0)
 W !,SRLINE,!,VADM(1),?50,SRPRINT,!,VA("PID")_"  Age: "_SRAGE,?50,SRLOC,!,SRDIV,?59,"Vice SF 509",!,SRLINE
"RTN","SROARPT",64,0)
 Q
"RTN","SROARPT",65,0)
HDR ; heading
"RTN","SROARPT",66,0)
 I $D(ZTQUEUED) D ^SROSTOP I SRHALT S SRSOUT=1 Q
"RTN","SROARPT",67,0)
 S SRPAGE=SRPAGE+1 I $Y'=0 W @IOF
"RTN","SROARPT",68,0)
 I $E(IOST)'="P",SRPAGE=1 S DFN=$P(^SRF(SRTN,0),"^") D DEM^VADPT S SRXX=VADM(1)_" ("_VA("PID")_")" W !,?(80-$L(SRXX)\2),SRXX
"RTN","SROARPT",69,0)
 W:$E(IOST)="P" !!!!,SRLINE W !,?4,"MEDICAL RECORD         ANESTHESIA REPORT - CASE #"_SRTN,?(79-$L("PAGE "_SRPAGE)),"PAGE "_SRPAGE,!
"RTN","SROARPT",70,0)
 W:$E(IOST)="P" SRLINE,!
"RTN","SROARPT",71,0)
 Q
"RTN","SROARPT",72,0)
FUNCT ; anethesia report functions
"RTN","SROARPT",73,0)
 D:'$D(SRHDR) SRHDR S SRSOUT=0,SRTIU=$P($G(^SRF(SRTN,"TIU")),"^",4)
"RTN","SROARPT",74,0)
 I 'SRSINED,SRTIU,$$STATUS^SROESUTL(SRTIU)=7 S SRSINED=1
"RTN","SROARPT",75,0)
 W:$Y>0 @IOF W !,SRHDR I SRSINED W !!," * * The Anesthesia Report has been electronically signed. * *"
"RTN","SROARPT",76,0)
 W !!," Anesthesia Report Functions:",!
"RTN","SROARPT",77,0)
 S DIR("A",1)="  1. Edit report information",DIR("A",2)="  2. Print/View report from beginning"
"RTN","SROARPT",78,0)
 S DIR("A",3)=$S('SRTIU:"",'SRSINED:"  3. Sign the report electronically",1:"") I SRTIU,'SRSINED S DIR("A",4)=""
"RTN","SROARPT",79,0)
 S DIR("A")="Select number: ",DIR("B")=2,DIR(0)="SAM^1:Edit report information;2:Print/View report from beginning"_$S(('SRSINED&SRTIU):";3:Sign the report electronically",1:"")
"RTN","SROARPT",80,0)
 D ^DIR K DIR I $D(DTOUT)!$D(DUOUT) S (SRLEAVE,SRSOUT)=1 D END Q
"RTN","SROARPT",81,0)
 S SRSEL=Y,SRDO=$S(SRSEL=1:"EDIT",SRSEL=3:"SIGN",1:"DISPLY")
"RTN","SROARPT",82,0)
 D @SRDO I $G(SRLCK) D UNLOCK^SROUTL(SRTN)
"RTN","SROARPT",83,0)
 S SRSOUT=0,SRFUNCT=1 D ENF
"RTN","SROARPT",84,0)
 Q
"RTN","SROARPT",85,0)
EDIT ; edit report data fields
"RTN","SROARPT",86,0)
 D CHECK^SROES I SRSOUT Q
"RTN","SROARPT",87,0)
 N SROLOCK,SRX,SRZ D ^SROLOCK I SROLOCK S Q3("VIEW")=""
"RTN","SROARPT",88,0)
 N SRLCK S SRLCK=$$LOCK^SROUTL(SRTN) I 'SRLCK Q
"RTN","SROARPT",89,0)
 K DA,DR,DIE S SRDTIME=DTIME,DTIME=3600,DIE=130,DA=SRTN,DR="[SROARPT]",ST="ANESTHESIA REPORT"_$S(SROLOCK:" **LOCKED",1:"") D EN2^SROVAR,^SRCUSS S DTIME=SRDTIME K Q3("VIEW")
"RTN","SROARPT",90,0)
 I '$P(^SRF(SRTN,0),"^",20) D ^SROPCE1
"RTN","SROARPT",91,0)
 I $D(SRODR) D ^SROCON1
"RTN","SROARPT",92,0)
 S SROERR=SRTN D ^SROERR0
"RTN","SROARPT",93,0)
 D EXIT^SROES
"RTN","SROARPT",94,0)
 Q
"RTN","SROARPT",95,0)
SIGN ; sign report if appropriate user
"RTN","SROARPT",96,0)
 N SRTIU S SRTIU=$P($G(^SRF(SRTN,"TIU")),"^",4) I SRTIU,$$STATUS^SROESUTL(SRTIU)=7 W !!,"This report is already signed." H 2 Q
"RTN","SROARPT",97,0)
 N SRLCK S SRLCK=$$LOCK^SROUTL(SRTN) I 'SRLCK Q
"RTN","SROARPT",98,0)
 N SRA,SRMISS,SROK,X,Y S SROK=0,X=$G(^SRF(SRTN,.3)) F Y=1,2,3,4 I $P(X,"^",Y)=DUZ S SROK=1 Q
"RTN","SROARPT",99,0)
 I 'SROK W !!,"Sorry, you are not authorized to sign this report." H 2 Q
"RTN","SROARPT",100,0)
 S SRMISS=0 D ALLIN Q:SRSOUT!SRMISS
"RTN","SROARPT",101,0)
ES D RPT^SROANR(SRTN)
"RTN","SROARPT",102,0)
 N SRAY,SRERR,SRI,SRP,SRSIG,X1
"RTN","SROARPT",103,0)
 S SRTIU=$P($G(^SRF(SRTN,"TIU")),"^",4)
"RTN","SROARPT",104,0)
 D SIG^XUSESIG I X1="" W !!,"Signature failed." H 2 Q
"RTN","SROARPT",105,0)
 F I=1:1 Q:'$D(^TMP("SRANE",$J,SRTN,I))  S SRAY("TEXT",I,0)=^TMP("SRANE",$J,SRTN,I)
"RTN","SROARPT",106,0)
 S SRAY(.05)=5 D UPDATE^TIUSRVP(.SRERR,SRTIU,.SRAY,1) K SRAY
"RTN","SROARPT",107,0)
 I +SRERR S SRSINED=1 D
"RTN","SROARPT",108,0)
 .D ES^TIUSROI(SRTIU,DUZ)
"RTN","SROARPT",109,0)
 .S XQAID="SRAR-"_SRTN,XQAKILL=0 D DELETEA^XQALERT
"RTN","SROARPT",110,0)
 W ! K DIR S DIR(0)="FOA",DIR("A")="Press RETURN to continue... " D ^DIR K DIR
"RTN","SROARPT",111,0)
 Q
"RTN","SROARPT",112,0)
ALLIN N SRFLD,SRI,SRP,SRX,SRY,SRZ
"RTN","SROARPT",113,0)
 K DA,DIC,DIQ,DR S (SREDIT,SRMISS,SRSOUT)=0
"RTN","SROARPT",114,0)
 S DIC="^SRF(",DA=SRTN,DIQ="SRY",DIQ(0)="I",DR=".21;.24;1.13;.46;.31" D EN^DIQ1 K DA,DIC,DIQ,DR D LIST
"RTN","SROARPT",115,0)
 K SRY,SRZ D TECH^SROPRIN I SRTECH="NOT ENTERED" D
"RTN","SROARPT",116,0)
 .I $O(^SRF(SRTN,6,0)) S SRX(.37)="PRINCIPAL ANESTHESIA TECHNIQUE NOT SELECTED" Q
"RTN","SROARPT",117,0)
 .S SRX(.37)="ANESTHESIA TECHNIQUE"
"RTN","SROARPT",118,0)
 S SRZ=0 F  S SRZ=$O(SRX(SRZ)) Q:'SRZ  S SRMISS=1 Q
"RTN","SROARPT",119,0)
 I SRMISS D MESS Q:SRSOUT  D:SREDIT EDIT
"RTN","SROARPT",120,0)
 Q
"RTN","SROARPT",121,0)
MESS ; display list of missing items
"RTN","SROARPT",122,0)
 W @IOF,!,"The following information is required before this report may be signed:",!
"RTN","SROARPT",123,0)
 S SRZ=0 F  S SRZ=$O(SRX(SRZ)) Q:'SRZ  W !,?5,SRX(SRZ)
"RTN","SROARPT",124,0)
 W ! K DIR S DIR("A")="Do you want to enter this information",DIR("B")="YES",DIR(0)="Y" D ^DIR K DIR,SRX I $D(DTOUT)!$D(DUOUT) S SRSOUT=1 Q
"RTN","SROARPT",125,0)
 I Y S SREDIT=1
"RTN","SROARPT",126,0)
 Q
"RTN","SROARPT",127,0)
LIST S SRZ=0 F  S SRZ=$O(SRY(130,SRTN,SRZ)) Q:'SRZ  I SRY(130,SRTN,SRZ,"I")="" D TR S X=$T(@SRP),SRFLD=$P(X,";;",2),SRX(SRZ)=$P(SRFLD,"^",2)
"RTN","SROARPT",128,0)
 Q
"RTN","SROARPT",129,0)
TR S SRP=SRZ,SRP=$TR(SRP,"1234567890.","ABCDEFGHIJP")
"RTN","SROARPT",130,0)
 Q
"RTN","SROARPT",131,0)
PBA ;;.21^ANES CARE START TIME
"RTN","SROARPT",132,0)
PBD ;;.24^ANES CARE END TIME
"RTN","SROARPT",133,0)
APAC ;;1.13^ASA CLASS
"RTN","SROARPT",134,0)
PDF ;;.46^OP DISPOSITION
"RTN","SROARPT",135,0)
PCA ;;.31^PRINC ANESTHETIST
"RTN","SROARPT0")
1^138
"RTN","SROARPT1")
1^139
"RTN","SROARPT2")
1^140
"RTN","SROASS")
0^36^B17264408
"RTN","SROASS",1,0)
SROASS ;B'HAM ISC/MAM - SELECT ASSESSMENT ; [ 12/08/03  10:10 AM ]
"RTN","SROASS",2,0)
 ;;3.0; Surgery ;**38,47,64,94,121,100**;24 Jun 93
"RTN","SROASS",3,0)
PST K:$D(DUZ("SAV")) SRNEW K SRTN W !! S SRSOUT=0
"RTN","SROASS",4,0)
 N SRSEL D ^SROPSEL G:'$D(DFN) END S SRANM=VADM(1)_"  "_VA("PID")
"RTN","SROASS",5,0)
START ; start display
"RTN","SROASS",6,0)
 G:SRSOUT END W:SRSEL=1 @IOF,!,?1,SRANM
"RTN","SROASS",7,0)
 I $D(^DPT(DFN,.35)),$P(^(.35),"^") S SRDT=$P(^(.35),"^") W "         * DIED "_$E(SRDT,4,5)_"/"_$E(SRDT,6,7)_"/"_$E(SRDT,2,3)_" *"
"RTN","SROASS",8,0)
 I SRSEL=2 S CNT=0 D ^SROASSN G:$D(SRTN) ENTER G PST
"RTN","SROASS",9,0)
 D ^SROASS1 I SRSOUT G END
"RTN","SROASS",10,0)
 I $D(SRTN) G ENTER
"RTN","SROASS",11,0)
 I $D(SRNEW) S CNT=CNT+1,SRCASE(CNT)="" W CNT,".   ----     CREATE NEW ASSESSMENT"
"RTN","SROASS",12,0)
 I '$D(SRCASE(1)) W !!,"There are no Surgery Risk Assessments entered for "_VADM(1)_".",!! K DIR S DIR(0)="FOA",DIR("A")="  Press RETURN to continue.  " D ^DIR Q
"RTN","SROASS",13,0)
OPT W !!!,"Select Surgical Case: " R X:DTIME I '$T!("^"[X) S SRSOUT=1 G END
"RTN","SROASS",14,0)
 I '$D(SRCASE(X)) W !!,"Enter the number of the desired assessment." W:$D(SRNEW) "  Select '"_CNT_"' to create an",!,"assessment for another surgical case." G OPT
"RTN","SROASS",15,0)
 I $D(SRNEW),X=CNT D ^SROANEW G END
"RTN","SROASS",16,0)
 I '$D(SRTN) S SRTN=+SRCASE(X)
"RTN","SROASS",17,0)
ENTER ; edit, complete, or delete
"RTN","SROASS",18,0)
 I $D(SRPRINT)!'($D(SRNEW)) Q
"RTN","SROASS",19,0)
 S SR("RA")=$G(^SRF(SRTN,"RA")) I $P(SR("RA"),"^")="T" D TRANS I 'SRYN K SRASS,SRTN S:SRSEL=2 SRSOUT=1 G START
"RTN","SROASS",20,0)
 I SRATYPE="N"&($P(SR("RA"),"^",2)="C") W !!,"You've selected a Cardiac assessment, using a Non-Cardiac Option," K DIR S DIR(0)="Y",DIR("A")="Do you wish to continue",DIR("B")="NO" D ^DIR S X=$E(X) I "Yy"'[X K SRTN S SRSOUT=1 G END
"RTN","SROASS",21,0)
 I SRATYPE="C"&($P(SR("RA"),"^",2)="N") W !!,"You've selected a Non-Cardiac assessment, using a Cardiac Option," K DIR S DIR(0)="Y",DIR("A")="Do you wish to continue",DIR("B")="NO" D ^DIR S X=$E(X) I "Yy"'[X K SRTN S SRSOUT=1 G END
"RTN","SROASS",22,0)
 W @IOF,!,?1,SRANM,!! S SRSDATE=$P(^SRF(SRTN,0),"^",9) S SRASS=SRTN D DISP^SROASS1
"RTN","SROASS",23,0)
 W !!,"1. Enter Risk Assessment Information",!,"2. Delete Risk Assessment Entry",!,"3. Update Assessment Status to 'COMPLETE'"
"RTN","SROASS",24,0)
 W !!,"Select Number:  1//  " R X:DTIME I '$T!(X["^") K SRTN,SRASS S SRSOUT=1 G END
"RTN","SROASS",25,0)
 S:X="" X=1 I X<1!(X>3)!(X'?.N) D HELP G ENTER
"RTN","SROASS",26,0)
 I X=2 D ^SROADEL W !!,"Press <RET> to continue  " R X:DTIME W @IOF K SRTN G END
"RTN","SROASS",27,0)
 I X=3 D ^SROACOM K SRTN G END
"RTN","SROASS",28,0)
 Q
"RTN","SROASS",29,0)
END S:'$D(SRSOUT) SRSOUT=1 W:SRSOUT @IOF D ^SRSKILL
"RTN","SROASS",30,0)
 Q
"RTN","SROASS",31,0)
HELP ;
"RTN","SROASS",32,0)
 W !!,"Enter <RET> or '1' to enter or edit information related to this Risk ",!,"Assessment entry.  If you want to delete the Assessment, enter '2'."
"RTN","SROASS",33,0)
 W !,"Enter '3' to update the status of this Assessment to 'COMPLETE'."
"RTN","SROASS",34,0)
 W !!,"Press <RET> to continue  " R X:DTIME
"RTN","SROASS",35,0)
 Q
"RTN","SROASS",36,0)
TRANS W @IOF,!,"This assessment has already been transmitted.  The information contained",!,"in it cannot be altered unless you first change the status to 'INCOMPLETE'."
"RTN","SROASS",37,0)
 S SRYN=0 K DIR S DIR("A")="Do you wish to change the status of this assessment to 'INCOMPLETE'",DIR("B")="NO",DIR(0)="Y" D ^DIR I $D(DTOUT)!$D(DUOUT) S SRSOUT=1 Q
"RTN","SROASS",38,0)
 S SRYN=Y I 'SRYN Q
"RTN","SROASS",39,0)
 I $$LOCK^SROUTL(SRTN) K DA,DIE,DR S DIE=130,DA=SRTN,DR="235////I;393////1" D ^DIE K DA,DIE,DR D UNLOCK^SROUTL(SRTN)
"RTN","SROASS",40,0)
 Q
"RTN","SROAUTL")
0^37^B30975490
"RTN","SROAUTL",1,0)
SROAUTL ;BIR/ADM - Risk Assessment Utility ; [ 01/29/01  10:05 AM ]
"RTN","SROAUTL",2,0)
 ;;3.0; Surgery ;**38,46,47,63,81,88,95,112,100**;24 Jun 93
"RTN","SROAUTL",3,0)
 N SRCMOD,SRCOMMA,X K SRHDR S DFN=$P(^SRF(SRTN,0),"^") D DEM^VADPT S SRHDR=VADM(1)_" ("_VA("PID")_")        Case #"_SRTN,Y=$E($P(^SRF(SRTN,0),"^",9),1,7) X ^DD("DD") S SRSDATE=Y
"RTN","SROAUTL",4,0)
 S X=^SRF(SRTN,"OP"),SROPER=$P(X,"^"),Y=$P(X,"^",2),SRCPT=$S(Y:$P($$CPT^ICPTCOD(Y),"^",2),1:"CPT MISSING") I SRCPT,$O(^SRF(SRTN,"OPMOD",0)) D
"RTN","SROAUTL",5,0)
 .S (SRCOMMA,SRI)=0,SRCMOD="",SRCPT=SRCPT_"-" F  S SRI=$O(^SRF(SRTN,"OPMOD",SRI)) Q:'SRI  D
"RTN","SROAUTL",6,0)
 ..S SRM=$P(^SRF(SRTN,"OPMOD",SRI,0),"^"),SRCMOD=$P($$MOD^ICPTMOD(SRM,"I"),"^",2)
"RTN","SROAUTL",7,0)
 ..S SRCPT=SRCPT_$S(SRCOMMA:",",1:"")_SRCMOD,SRCOMMA=1
"RTN","SROAUTL",8,0)
 S SRCPT="("_SRCPT_")",SROPER=SROPER_" "_SRCPT D LOOP S SRHDR(1)=SRSDATE_"   "_SRHDR(1)
"RTN","SROAUTL",9,0)
 Q
"RTN","SROAUTL",10,0)
LOOP I $L(SROPER)<68 S SRHDR(1)=SROPER Q
"RTN","SROAUTL",11,0)
 I $L(SROPER)>67 S X=SROPER,K=1 F  D  I $L(X)<68 S SRHDR(K)=X Q
"RTN","SROAUTL",12,0)
 .F I=0:1:66 S J=67-I,Y=$E(X,J) I Y=" " S SRHDR(K)=$E(X,1,J-1),X=$E(X,J+1,$L(X)) S K=K+1 Q
"RTN","SROAUTL",13,0)
 Q
"RTN","SROAUTL",14,0)
HDR ; print screen header
"RTN","SROAUTL",15,0)
 W @IOF,!,SRHDR W:$D(SRPAGE) ?(79-$L(SRPAGE)),SRPAGE
"RTN","SROAUTL",16,0)
 S I=0 F  S I=$O(SRHDR(I)) Q:'I  W ! W:I<2 SRHDR(I) W:I>1 ?14,SRHDR(I)
"RTN","SROAUTL",17,0)
 K SRHDR(.5),SRPAGE W ! F I=1:1:80 W "-"
"RTN","SROAUTL",18,0)
 W !
"RTN","SROAUTL",19,0)
 Q
"RTN","SROAUTL",20,0)
SMOKE() ; called by screen on current smoker field (#202)
"RTN","SROAUTL",21,0)
 N SRSCR,SRTYPE,SRX S SRSCR="I 0" D  Q SRSCR
"RTN","SROAUTL",22,0)
 .S SRX=$S($D(SRTN):SRTN,$D(DA):DA,1:"") Q:'SRX
"RTN","SROAUTL",23,0)
 .S SRTYPE=$P($G(^SRF(SRX,"RA")),"^",2)
"RTN","SROAUTL",24,0)
 .I SRTYPE="C" S SRSCR="I Y" Q
"RTN","SROAUTL",25,0)
 .S SRSCR="I 'Y"
"RTN","SROAUTL",26,0)
 Q
"RTN","SROAUTL",27,0)
INDX ; set airway index
"RTN","SROAUTL",28,0)
 S SRY=$S(SRI>4:5,SRI>3:4,SRI>2:3,SRI>0:2,1:1),$P(^SRF(DA,.3),"^",9)=SRY
"RTN","SROAUTL",29,0)
 K SRI,SRMS,SROP,SRY
"RTN","SROAUTL",30,0)
 Q
"RTN","SROAUTL",31,0)
OP ; set logic for AOP cross reference on Oral-Pharyngeal field (901.1)
"RTN","SROAUTL",32,0)
 N SRI,SRMS,SRY S SRMS=$P(^SRF(DA,.3),"^",12) I SRMS'="" S SRMS=SRMS*.1,SRI=2.5*X-SRMS D INDX
"RTN","SROAUTL",33,0)
 Q
"RTN","SROAUTL",34,0)
MS ; set logic for AMS cross reference on Mandibular Space field (901.2)
"RTN","SROAUTL",35,0)
 N SRI,SRY,SRMS,SROP S SROP=$P(^SRF(DA,.3),"^",11) I SROP'="" S SRMS=X*.1,SRI=2.5*SROP-SRMS D INDX
"RTN","SROAUTL",36,0)
 Q
"RTN","SROAUTL",37,0)
K901 ; kill logic for AOP and AMS cross references
"RTN","SROAUTL",38,0)
 S $P(^SRF(DA,.3),"^",9)=""
"RTN","SROAUTL",39,0)
 Q
"RTN","SROAUTL",40,0)
DUP ; duplicate preop information from prior operation within 60 days
"RTN","SROAUTL",41,0)
 S SR200=$G(^SRF(SRTN,200)) S NOGO="" F I=1,9,13,18,30,37,44 S X=$P(SR200,"^",I) I X'="" S NOGO=1 K SR200 Q
"RTN","SROAUTL",42,0)
 I NOGO K NOGO Q
"RTN","SROAUTL",43,0)
 K SRCASE S SR=^SRF(SRTN,0),DFN=$P(SR,"^"),(SRSDATE,X1)=$P(SR,"^",9),X2=-60 D C^%DTC S SRENDT=X,SRCASE=0 F  S SRCASE=$O(^SRF("B",DFN,SRCASE)) Q:'SRCASE  I SRCASE,SRCASE'=SRTN D
"RTN","SROAUTL",44,0)
 .S SRX=$P(^SRF(SRCASE,0),"^",9) I SRX>SRSDATE!(SRX<SRENDT) Q
"RTN","SROAUTL",45,0)
 .Q:$P($G(^SRF(SRCASE,"NON")),"^")="Y"!$P($G(^SRF(SRCASE,30)),"^")!$P($G(^SRF(SRCASE,31)),"^",8)!($P($G(^SRF(SRCASE,"CON")),"^")=SRTN)!'$P($G(^SRF(SRCASE,.2)),"^",12)
"RTN","SROAUTL",46,0)
 .S SRX=9999999-SRX,SRCASE(SRX,SRCASE)=""
"RTN","SROAUTL",47,0)
 K SRDT S (SRX,Y)=0 F  S SRX=$O(SRCASE(SRX)) Q:'SRX!$D(SRDT)  S SRCASE="" F  S SRCASE=$O(SRCASE(SRX,SRCASE)) Q:'SRCASE  S SR=$G(^SRF(SRCASE,"RA")) I $P(SR,"^",2)="N",$P(SR,"^",6)="Y" D  Q
"RTN","SROAUTL",48,0)
 .S Y=$P(^SRF(SRCASE,0),"^",9) X ^DD("DD") S SRDT=Y K DIR
"RTN","SROAUTL",49,0)
 .W !! S DIR("A",1)="This patient had a previous non-cardiac operation on "_SRDT_".",DIR("A",2)="",DIR("A",3)="Case #"_SRCASE_"  "_$P(^SRF(SRCASE,"OP"),"^")
"RTN","SROAUTL",50,0)
 .S DIR("A",4)="",DIR("A",5)="Do you want to duplicate the preoperative information from the earlier",DIR("A")="assessment in this assessment? "
"RTN","SROAUTL",51,0)
 .S DIR("B")="YES",DIR(0)="YA" D ^DIR K DIR I $D(DTOUT)!$D(DUOUT) S SRSOUT=1 Q
"RTN","SROAUTL",52,0)
 .D:Y STUFF
"RTN","SROAUTL",53,0)
 Q
"RTN","SROAUTL",54,0)
STUFF ; stuff preop information from previous case
"RTN","SROAUTL",55,0)
 I $$LOCK^SROUTL(SRCASE) D  D UNLOCK^SROUTL(SRCASE)
"RTN","SROAUTL",56,0)
 .K DA,DIC,DIQ,DR,SRY S DIC="^SRF(",DA=SRCASE,DIQ="SRY",DIQ(0)="I" D PREHD D EN^DIQ1 K DA,DIC,DIQ,DR
"RTN","SROAUTL",57,0)
 .S SRZ=0 F  S SRZ=$O(SRY(130,SRCASE,SRZ)) Q:'SRZ  S DIE=130,DA=SRTN,DR=SRZ_"////"_SRY(130,SRCASE,SRZ,"I") D ^DIE K DA,DIE,DR
"RTN","SROAUTL",58,0)
 Q
"RTN","SROAUTL",59,0)
CHK ; check for missing non-cardiac assessment data items
"RTN","SROAUTL",60,0)
 K SRX F SRC="PREOP","DEM" K DA,DIC,DIQ,DR,SRY S DIC="^SRF(",DA=SRTN,DIQ="SRY",DIQ(0)="I" D @SRC D EN^DIQ1 D ^SROAUTL1
"RTN","SROAUTL",61,0)
 F SRC="LAB","REM" K DA,DIC,DIQ,DR,SRY S DIC="^SRF(",DA=SRTN,DIQ="SRY",DIQ(0)="I" D @SRC D EN^DIQ1 D ^SROAUTL2
"RTN","SROAUTL",62,0)
OTH K DA,DIC,DIQ,DR,SRY,SRZ D TECH^SROPRIN I SRTECH="NOT ENTERED" S SRX("ANESTHESIA TECHNIQUE")="Anesthesia Technique"
"RTN","SROAUTL",63,0)
 I $O(^SRF(SRTN,13,0)) S SROTH=0 F  S SROTH=$O(^SRF(SRTN,13,SROTH)) Q:'SROTH  I '$P($G(^SRF(SRTN,13,SROTH,2)),"^") S SRX("OTHER PROCEDURE CPT CODE")="Other Procedure CPT Code" Q
"RTN","SROAUTL",64,0)
 D RELATE^SROAUTL2
"RTN","SROAUTL",65,0)
OCC D EN^SROCCAT S SRSDATE=$E($P(^SRF(SRTN,0),"^",9),1,7) K ^TMP("SROCC",$J),SRO
"RTN","SROAUTL",66,0)
 S SRPO=0 F  S SRPO=$O(^SRF(SRTN,10,SRPO)) Q:'SRPO  S ^TMP("SROCC",$J,$P(^SRF(SRTN,10,SRPO,0),"^",2),SRSDATE)=""
"RTN","SROAUTL",67,0)
 S SRPO=0 F  S SRPO=$O(^SRF(SRTN,16,SRPO)) Q:'SRPO  S SRDATE=$E($P(^SRF(SRTN,16,SRPO,0),"^",7),1,7) D
"RTN","SROAUTL",68,0)
 .I '$G(SRDATE) S SRDATE="NO DATE"
"RTN","SROAUTL",69,0)
 .S ^TMP("SROCC",$J,$P(^SRF(SRTN,16,SRPO,0),"^",2),SRDATE)=""
"RTN","SROAUTL",70,0)
 I '$D(^TMP("SROCC",$J)) D OCCEND Q
"RTN","SROAUTL",71,0)
 S SRPO=0 F  S SRPO=$O(^TMP("SROCC",$J,SRPO)) Q:'SRPO  S SRDATE="" F  S SRDATE=$O(^TMP("SROCC",$J,SRPO,SRDATE)) Q:SRDATE  S SRX("POSTOP OCCURRENCE DATE"_SRPO)="Date Noted on "_$P(^SRO(136.5,SRPO,0),"^")_" (Postop Occurrence)" Q
"RTN","SROAUTL",72,0)
OCCEND K ^TMP("SROCC",$J)
"RTN","SROAUTL",73,0)
 Q
"RTN","SROAUTL",74,0)
PREOP S DR="346;202;202.1;246;325;238;240;204;203;326;212;396;328;211;332;333;400;334;335;336;401;338;218;339;215;216;217;338.1;338.2;218.1"
"RTN","SROAUTL",75,0)
 Q
"RTN","SROAUTL",76,0)
DEM S DR="413;.011;247;418;419;420;421;452;453;454"
"RTN","SROAUTL",77,0)
 Q
"RTN","SROAUTL",78,0)
LAB S DR="270;304;224;291;223;290;225;292;228;295;227;294;229;296;230;297;234;301;231;298;233;300;232;299;274;305;405;407;275;306;406;408;277;308;278;309;279;310;280;311;281;312;283;314;455;455.1;456;456.1"
"RTN","SROAUTL",79,0)
 Q
"RTN","SROAUTL",80,0)
REM S DR=".03;27;214;.035;1.09;1.13;.22;.23;340;66;"
"RTN","SROAUTL",81,0)
 Q
"RTN","SROAUTL",82,0)
PREHD D PREOP S DR=DR_";402;241;244;242;243;210;245"
"RTN","SROAUTL",83,0)
 Q
"RTN","SROBTCH")
1^133
"RTN","SROCHDD")
1^106
"RTN","SROCOM")
0^38^B6818082
"RTN","SROCOM",1,0)
SROCOM ;B'HAM ISC/MAM - ENTER COMMENTS ; [ 01/30/01  10:02 AM ]
"RTN","SROCOM",2,0)
 ;;3.0; Surgery ;**100**;24 Jun 93
"RTN","SROCOM",3,0)
CASE ; get case number
"RTN","SROCOM",4,0)
 W @IOF K DIC S DIC=2,DIC(0)="AEQMZ",DIC("A")="Select Patient: " D ^DIC K DIC Q:Y<0  S DFN=+Y,SRNAME=Y(0,0)
"RTN","SROCOM",5,0)
LOOK W ! S (SRTN,CNT)=0 F I=0:0 S SRTN=$O(^SRF("B",DFN,SRTN)) Q:SRTN=""  S CNT=CNT+1,SROP1(CNT)=SRTN D LIST
"RTN","SROCOM",6,0)
 I '$D(SROP1(1)) W !!,"There are no cases entered for "_SRNAME_".",!! W !!,"Press RETURN to continue  " R X:DTIME G END
"RTN","SROCOM",7,0)
ASK R !!,"Select Number: ",SRNUM:DTIME I '$T!("^"[SRNUM) G END
"RTN","SROCOM",8,0)
 I SRNUM["?" W !!,"Enter the number which corresponds to the case that you want to enter comments." G ASK
"RTN","SROCOM",9,0)
 I '$D(SROP1(SRNUM)) W !!,"You have entered an invalid number, please select again. " G ASK
"RTN","SROCOM",10,0)
 W !! S SRTN=SROP1(SRNUM) I $$LOCK^SROUTL(SRTN) S DIE=130,DA=SRTN,DR=".28T" D ^DIE K DR D UNLOCK^SROUTL(SRTN)
"RTN","SROCOM",11,0)
END K SRTN D ^SRSKILL W @IOF
"RTN","SROCOM",12,0)
 Q
"RTN","SROCOM",13,0)
OTHER ; other operations
"RTN","SROCOM",14,0)
 S SRLONG=1 I $L(SROPER)+$L($P(^SRF(SRTN,13,OPER,0),"^"))>235 S SRLONG=0,OPER=999,SROPERS=" ..."
"RTN","SROCOM",15,0)
 I SRLONG S SROPERS=$P(^SRF(SRTN,13,OPER,0),"^")
"RTN","SROCOM",16,0)
 S SROPER=SROPER_$S(SROPERS=" ...":SROPERS,1:", "_SROPERS)
"RTN","SROCOM",17,0)
 Q
"RTN","SROCOM",18,0)
LIST ; list cases
"RTN","SROCOM",19,0)
 S SRSDATE=$P(^SRF(SRTN,0),"^",9),SRSDATE=$E(SRSDATE,4,5)_"/"_$E(SRSDATE,6,7)_"/"_$E(SRSDATE,2,3)
"RTN","SROCOM",20,0)
OPS S SROPER=$P(^SRF(SRTN,"OP"),"^"),OPER=0 F I=0:0 S OPER=$O(^SRF(SRTN,13,OPER)) Q:OPER=""  D OTHER
"RTN","SROCOM",21,0)
 S SROP=SRTN D ^SROP1 K SROPS,MM,MMM S:$L(SROPER)<60 SROPS(1)=SROPER I $L(SROPER)>59 S SROPER=SROPER_"  " F M=1:1 D LOOP Q:MMM=""
"RTN","SROCOM",22,0)
 W !,CNT_".  "_SRSDATE,?15,SROPS(1) I $D(SROPS(2)) W !,?15,SROPS(2) I $D(SROPS(3)) W !,?15,SROPS(3) I $D(SROPS(4)) W !,?15,SROPS(4)
"RTN","SROCOM",23,0)
 Q
"RTN","SROCOM",24,0)
LOOP ; break procedure if greater than 60 characters
"RTN","SROCOM",25,0)
 S SROPS(M)="" F LOOP=1:1 S MM=$P(SROPER," "),MMM=$P(SROPER," ",2,200) Q:MMM=""  Q:$L(SROPS(M))+$L(MM)'<60  S SROPS(M)=SROPS(M)_MM_" ",SROPER=MMM
"RTN","SROCOM",26,0)
 Q
"RTN","SRODCT1")
1^109
"RTN","SRODICT")
1^108
"RTN","SRODTH")
0^39^B14263110
"RTN","SRODTH",1,0)
SRODTH ;BIR/ADM - Update Case as Unrelated or Related to Death ; [ 01/30/01  10:06 AM ]
"RTN","SRODTH",2,0)
 ;;3.0; Surgery ;**47,88,100**;24 Jun 93
"RTN","SRODTH",3,0)
PAT W @IOF,!,?15,"Update Operations as Unrelated or Related to Death",!!
"RTN","SRODTH",4,0)
 S SRSOUT=0 K DIC S DIC("A")="Select Patient: ",DIC=2,DIC(0)="QEAM" D ^DIC K DIC I Y<0 G END
"RTN","SRODTH",5,0)
 S DFN=+Y D DEM^VADPT S SRDEATH=$P(VADM(6),"^") I 'SRDEATH G NODIE
"RTN","SRODTH",6,0)
 S X1=SRDEATH,X2=-90 D C^%DTC S SRDAY=X,(CNT,SRDT)=0
"RTN","SRODTH",7,0)
 K SRCASE F  S SRDT=$O(^SRF("ADT",DFN,SRDT)) Q:'SRDT  S SRCASE=0 F  S SRCASE=$O(^SRF("ADT",DFN,SRDT,SRCASE)) Q:'SRCASE  D SET
"RTN","SRODTH",8,0)
OUT D HDR I 'CNT W !!,"This patient had no operations in 90 days prior to death.",!! K DIR S DIR(0)="E" D ^DIR K DIR G:$D(DTOUT)!$D(DUOUT) END G PAT
"RTN","SRODTH",9,0)
 W !!,"Operations in 90 Days Prior to Death:",!
"RTN","SRODTH",10,0)
 F NUM=1:1 Q:'$D(SRCASE(NUM))  S SRCASE=SRCASE(NUM) D LIST W !
"RTN","SRODTH",11,0)
SEL ; select operation to update
"RTN","SRODTH",12,0)
 K DIR S DIR(0)="NO^1:"_CNT_":0",DIR("?",1)="Enter the number corresponding to the operation to be updated or",DIR("?")="press RETURN to quit this patient."
"RTN","SRODTH",13,0)
 S DIR("A")="Select Number of Operation to be Updated" D ^DIR K DIR I $D(DTOUT)!$D(DUOUT) G END
"RTN","SRODTH",14,0)
 I Y S NUM=Y D RELATED G OUT
"RTN","SRODTH",15,0)
 G PAT
"RTN","SRODTH",16,0)
 Q
"RTN","SRODTH",17,0)
RELATED ; update UNRELATED/RELATED status
"RTN","SRODTH",18,0)
 S SRCASE=SRCASE(NUM) I $$LOCK^SROUTL(SRCASE) D  D UNLOCK^SROUTL(SRCASE)
"RTN","SRODTH",19,0)
 .D HDR W ! D LIST W ! K DA,DIE,DR S DA=SRCASE,DR="903T;904T",DIE=130 D ^DIE K DA,DIE,DR
"RTN","SRODTH",20,0)
 Q
"RTN","SRODTH",21,0)
SET ; set up array of cases in 90 days prior to death
"RTN","SRODTH",22,0)
 S SRSDATE=$P(^SRF(SRCASE,0),"^",9) I SRSDATE<SRDAY!(SRSDATE>SRDEATH) Q
"RTN","SRODTH",23,0)
 I '$P($G(^SRF(SRCASE,.2)),"^",12)!$P($G(^SRF(SRCASE,30)),"^")!($P($G(^SRF(SRCASE,"NON")),"^")="Y")!$P($G(^SRF(SRCASE,37)),"^") Q
"RTN","SRODTH",24,0)
 S CNT=CNT+1,SRCASE(CNT)=SRCASE
"RTN","SRODTH",25,0)
 Q
"RTN","SRODTH",26,0)
LIST ; display list of operations
"RTN","SRODTH",27,0)
 S X=$P($G(^SRF(SRCASE,.4)),"^",7) I X="" S X="U",$P(^SRF(SRCASE,.4),"^",7)=X
"RTN","SRODTH",28,0)
 S SRELATE=$S(X="U":"UNRELATED",1:"RELATED")
"RTN","SRODTH",29,0)
 S SROPER=$P(^SRF(SRCASE,"OP"),"^"),CPT=$P(^("OP"),"^",2),SRCPT=$S(CPT:$P($$CPT^ICPTCOD(CPT),"^",2),1:"CPT MISSING") I CPT D MOD
"RTN","SRODTH",30,0)
 S SROPER=SROPER_" ("_SRCPT_") - "_SRELATE
"RTN","SRODTH",31,0)
 S X1=SRDEATH,(DATE,X2)=$P(^SRF(SRCASE,0),"^",9),DATE=$E(DATE,4,5)_"/"_$E(DATE,6,7)_"/"_$E(DATE,2,3) D ^%DTC S SRLENGTH=X
"RTN","SRODTH",32,0)
 K SROPS,MM,MMM S:$L(SROPER)<65 SROPS(1)=SROPER I $L(SROPER)>64 S SROPER=SROPER_"  " F M=1:1 D LOOP Q:MMM=""
"RTN","SRODTH",33,0)
 W !,NUM_".",?3,DATE,?15,SROPS(1) I $D(SROPS(2)) W !,?15,SROPS(2) I $D(SROPS(3)) W !,?15,SROPS(3)
"RTN","SRODTH",34,0)
 W !,?15," >>> Died "_SRLENGTH_" day"_$S(SRLENGTH>1:"s",1:"")_" postop. <<<"
"RTN","SRODTH",35,0)
 Q
"RTN","SRODTH",36,0)
MOD ; append CPT modifiers to CPT code
"RTN","SRODTH",37,0)
 N SRCMOD,SRCOMMA,X I $O(^SRF(SRCASE,"OPMOD",0)) D
"RTN","SRODTH",38,0)
 .S (SRCOMMA,SRI)=0,SRCMOD="",SRCPT=SRCPT_"-" F  S SRI=$O(^SRF(SRCASE,"OPMOD",SRI)) Q:'SRI  D
"RTN","SRODTH",39,0)
 ..S SRM=$P(^SRF(SRCASE,"OPMOD",SRI,0),"^"),SRCMOD=$P($$MOD^ICPTMOD(SRM,"I"),"^",2)
"RTN","SRODTH",40,0)
 ..S SRCPT=SRCPT_$S(SRCOMMA:",",1:"")_SRCMOD,SRCOMMA=1
"RTN","SRODTH",41,0)
 Q
"RTN","SRODTH",42,0)
LOOP ; break procedures
"RTN","SRODTH",43,0)
 S SROPS(M)="" F LOOP=1:1 S MM=$P(SROPER," "),MMM=$P(SROPER," ",2,200) Q:MMM=""  Q:$L(SROPS(M))+$L(MM)'<65  S SROPS(M)=SROPS(M)_MM_" ",SROPER=MMM
"RTN","SRODTH",44,0)
 Q
"RTN","SRODTH",45,0)
HDR ; print heading
"RTN","SRODTH",46,0)
 W @IOF,!,?15,"Update Operations as Unrelated or Related to Death",!!,VADM(1)_"   "_VA("PID") S X=$P($G(VADM(6)),"^") W:X "        * DIED "_$E(X,4,5)_"/"_$E(X,6,7)_"/"_$E(X,2,3)_" *"
"RTN","SRODTH",47,0)
 Q
"RTN","SRODTH",48,0)
NODIE D HDR W !!!,"No death is recorded for this patient.",!!! K DIR S DIR(0)="E" D ^DIR K DIR I $D(DTOUT)!$D(DUOUT) G END
"RTN","SRODTH",49,0)
 G PAT
"RTN","SRODTH",50,0)
END I SRSOUT K DIR S DIR(0)="E" D ^DIR
"RTN","SRODTH",51,0)
 D ^SRSKILL W @IOF
"RTN","SRODTH",52,0)
 Q
"RTN","SROES")
0^40^B26203884
"RTN","SROES",1,0)
SROES ;BIR/ADM - SURGERY E-SIG UTILITY ; [ 02/14/04  1:03 PM ]
"RTN","SROES",2,0)
 ;;3.0; Surgery ;**100**;24 Jun 93
"RTN","SROES",3,0)
 ;
"RTN","SROES",4,0)
 ;** NOTICE: This routine is part of an implementation of a nationally
"RTN","SROES",5,0)
 ;**         controlled procedure.  Local modifications to this routine
"RTN","SROES",6,0)
 ;**         are prohibited.
"RTN","SROES",7,0)
 ;
"RTN","SROES",8,0)
 ; Reference to EXTRACT^TIULQ supported by DBIA #2693
"RTN","SROES",9,0)
 ;
"RTN","SROES",10,0)
SRA N SRRISK S SRRISK=1
"RTN","SROES",11,0)
ENTER Q:'$G(SRTN)
"RTN","SROES",12,0)
 N SRSOUT D CHECK I $G(SRSOUT) K SRSOUT S XQUIT=""
"RTN","SROES",13,0)
 Q
"RTN","SROES",14,0)
CHECK ; pre-edit capture of nurse and anesthesia reports for addenda
"RTN","SROES",15,0)
 N I,SRA,SRAUDIT,SRCCASE,SRESAR,SRESNR,SRN,SROP,SRSIGN,SRTIU,SRX,SRY,X S (SRAUDIT,SRSOUT)=0
"RTN","SROES",16,0)
 S (SRA(SRTN),SRAUDIT(SRTN),SRN(SRTN))=0,SRTIU=$G(^SRF(SRTN,"TIU")),SRESNR=$P(SRTIU,"^",2),SRESAR=$P(SRTIU,"^",4),SROP=SRTN D DOCS
"RTN","SROES",17,0)
 S SRCCASE=$P($G(^SRF(SRTN,"CON")),"^") I SRCCASE S (SRA(SRCCASE),SRAUDIT(SRCCASE),SRN(SRCCASE))=0,SRTIU=$G(^SRF(SRCCASE,"TIU")),SRESNR=$P(SRTIU,"^",2),SRESAR=$P(SRTIU,"^",4),SROP=SRCCASE D DOCS
"RTN","SROES",18,0)
 S X=0 F  S X=$O(SRAUDIT(X)) Q:'X  I SRAUDIT(X) S SRAUDIT=1 Q
"RTN","SROES",19,0)
 Q:'SRAUDIT
"RTN","SROES",20,0)
 D:'$G(SRRISK) WARN I SRSOUT Q
"RTN","SROES",21,0)
 D KTMP
"RTN","SROES",22,0)
 N SRLCK S SRLCK=$$LOCK^SROUTL(SRTN) I 'SRLCK S XQUIT="",SRSOUT=1 Q
"RTN","SROES",23,0)
 S SROP=0 F  S SROP=$O(SRAUDIT(SROP)) Q:'SROP  D PRE
"RTN","SROES",24,0)
 Q
"RTN","SROES",25,0)
KTMP ; kill TMP globals
"RTN","SROES",26,0)
 F I="SRADDEND","SRAR","SRNR","SRASAVE","SRNSAVE" K ^TMP(I,$J)
"RTN","SROES",27,0)
 F I=1,2 F J="SRAD","SRADM","SRARAD","SRARMULT","SRNRAD","SRNRMULT" K ^TMP(J_I,$J)
"RTN","SROES",28,0)
 Q
"RTN","SROES",29,0)
DOCS ; determine if signed
"RTN","SROES",30,0)
 I SRESNR S SRX=SRESNR,SRSIGN=0 D SIGNED I SRSIGN S SRN(SROP)=1
"RTN","SROES",31,0)
 I SRESAR S SRX=SRESAR,SRSIGN=0 D SIGNED I SRSIGN S SRA(SROP)=1
"RTN","SROES",32,0)
 Q
"RTN","SROES",33,0)
SIGNED I SRX N SRERR D EXTRACT^TIULQ(SRX,"SRY",.SRERR,".05") I SRY(SRX,.05,"I")=7 S SRSIGN=1,SRAUDIT(SROP)=1
"RTN","SROES",34,0)
 K SRY
"RTN","SROES",35,0)
 Q
"RTN","SROES",36,0)
PRE ; save pr-edit copy of case data
"RTN","SROES",37,0)
 N SRTN S SRTN=SROP
"RTN","SROES",38,0)
 D:SRN(SRTN)=1 IN^SROESNR D:SRA(SRTN)=1 IN^SROESAR
"RTN","SROES",39,0)
 Q
"RTN","SROES",40,0)
WARN ; warning message that addendum may be required
"RTN","SROES",41,0)
 D HDR W !!!,?30,">>>  WARNING  <<<"
"RTN","SROES",42,0)
 W !!,"   Electronically signed reports are associated with this case.  Editing",!,"   of data that appear on electronically signed reports will require the",!,"   creation of addenda to the signed reports.",!!!
"RTN","SROES",43,0)
 K DIR S DIR(0)="E" D ^DIR K DIR I $D(DTOUT)!$D(DUOUT) S SRSOUT=1
"RTN","SROES",44,0)
 Q
"RTN","SROES",45,0)
HDR S DFN=$P(^SRF(SRTN,0),"^") D DEM^VADPT S Y=$E($P(^SRF(SRTN,0),"^",9),1,7) X ^DD("DD") S SRSDATE=Y
"RTN","SROES",46,0)
 W @IOF,!," "_VADM(1)_" ("_VA("PID")_")   Case #"_SRTN_" - "_SRSDATE
"RTN","SROES",47,0)
 Q
"RTN","SROES",48,0)
EXIT ; post-edit check to see if addenda to nurse/anes. reports are required
"RTN","SROES",49,0)
 D WAIT^DICD
"RTN","SROES",50,0)
 D:$D(^TMP("SRNRAD1",$J,SRTN)) EX^SROESNR
"RTN","SROES",51,0)
 D:$D(^TMP("SRARAD1",$J,SRTN)) EX^SROESAR
"RTN","SROES",52,0)
 I $D(^TMP("SRNRAD1",$J,SRTN))!$D(^TMP("SRARAD1",$J,SRTN))!$D(^TMP("SRNRAD2",$J,SRTN))!$D(^TMP("SRARAD2",$J,SRTN)) D ^SROESAD1
"RTN","SROES",53,0)
 N SRCCASE,SRTN1 S SRCCASE=$P($G(^SRF(SRTN,"CON")),"^") I SRCCASE S SRTN1=SRTN S SRTN=SRCCASE D
"RTN","SROES",54,0)
 .D:$D(^TMP("SRNRAD1",$J,SRTN)) EX^SROESNR
"RTN","SROES",55,0)
 .D:$D(^TMP("SRARAD1",$J,SRTN)) EX^SROESAR
"RTN","SROES",56,0)
 .I $D(^TMP("SRNRAD1",$J,SRTN))!$D(^TMP("SRARAD1",$J,SRTN)) D ^SROESAD1
"RTN","SROES",57,0)
 .S SRTN=SRTN1
"RTN","SROES",58,0)
DOC N SRADOC,SRDOC,SRNDOC S (SRADOC,SRDOC,SRNDOC)=0
"RTN","SROES",59,0)
 I $O(^TMP("SRNR",$J,SRTN,0)) S SRNDOC=SRNDOC+1,SRDOC=SRDOC+1,SRNDOC(SRTN)="Nurse Intraoperative Report - Case #"_SRTN
"RTN","SROES",60,0)
 I SRCCASE,$O(^TMP("SRNR",$J,SRCCASE,0)) S SRNDOC=SRNDOC+1,SRDOC=SRDOC+1,SRNDOC(SRCCASE)="Nurse Intraoperative Report - Concurrent Case #"_SRCCASE
"RTN","SROES",61,0)
 I $O(^TMP("SRAR",$J,SRTN,0)) S SRADOC=SRADOC+1,SRDOC=SRDOC+1,SRADOC(SRTN)="Anesthesia Report - Case #"_SRTN
"RTN","SROES",62,0)
 I SRCCASE,$O(^TMP("SRAR",$J,SRCCASE,0)) S SRADOC=SRADOC+1,SRDOC=SRDOC+1,SRADOC(SRCCASE)="Anesthesia Report - Concurrent Case #"_SRCCASE
"RTN","SROES",63,0)
 I 'SRDOC Q
"RTN","SROES",64,0)
 D HDR W !!,"An addendum to each of the following electronically signed document(s) is",!,"required:",!
"RTN","SROES",65,0)
 S X=0 F  S X=$O(SRNDOC(X)) Q:'X  W !,?10,SRNDOC(X)
"RTN","SROES",66,0)
 S X=0 F  S X=$O(SRADOC(X)) Q:'X  W !,?10,SRADOC(X)
"RTN","SROES",67,0)
 W !!,"If you choose not to create an addendum, the original data will be restored",!,"to the modified fields appearing on the signed reports.",!!
"RTN","SROES",68,0)
 N SRESNOT S SRESNOT=0 K DIR S DIR(0)="Y",DIR("A")="Create addendum",DIR("B")="YES" D ^DIR K DIR I $D(DTOUT)!$D(DUOUT)!'Y S SRESNOT=1 D ALLREV Q
"RTN","SROES",69,0)
 D ^SROESAD I SRESNOT D REVRS,PRESS
"RTN","SROES",70,0)
 I SRCCASE S SRTN1=SRTN,SRTN=SRCCASE,SRESNOT=0 D ^SROESAD D:SRESNOT REVRS,PRESS S SRTN=SRTN1
"RTN","SROES",71,0)
UNLOCK D UNLOCK^SROUTL(SRTN),KTMP
"RTN","SROES",72,0)
 Q
"RTN","SROES",73,0)
PRESS W ! K DIR S DIR(0)="FOA",DIR("A")="Press RETURN to continue... " D ^DIR K DIR
"RTN","SROES",74,0)
 Q
"RTN","SROES",75,0)
ALLREV ; restore modified fields for both concurrent cases
"RTN","SROES",76,0)
 W !!,"No addendum created.  Original data will be restored.",!!
"RTN","SROES",77,0)
 D REVRS S SRCCASE=$P($G(^SRF(SRTN,"CON")),"^") I SRCCASE S SRTN1=SRTN,SRTN=SRCCASE D REVRS S SRTN=SRTN1
"RTN","SROES",78,0)
 D UNLOCK,PRESS
"RTN","SROES",79,0)
 Q
"RTN","SROES",80,0)
REVRS ; restore modified fields on signed reports
"RTN","SROES",81,0)
 D REVRS^SROESNR0,REVRS^SROESAR0
"RTN","SROES",82,0)
 S SROERR=SRTN D ^SROERR0
"RTN","SROES",83,0)
 Q
"RTN","SROESAD")
0^41^B31263685
"RTN","SROESAD",1,0)
SROESAD ;BIR/ADM - SURGERY E-SIG UTILITY ; [ 09/04/03  1:03 PM ]
"RTN","SROESAD",2,0)
 ;;3.0; Surgery ;**100**;24 Jun 93
"RTN","SROESAD",3,0)
 ;
"RTN","SROESAD",4,0)
 ;** NOTICE: This routine is part of an implementation of a nationally
"RTN","SROESAD",5,0)
 ;**         controlled procedure.  Local modifications to this routine
"RTN","SROESAD",6,0)
 ;**         are prohibited.
"RTN","SROESAD",7,0)
 ;
"RTN","SROESAD",8,0)
 ; Reference to MAKEADD^TIUSRVP supported by DBIA #3535
"RTN","SROESAD",9,0)
 ; Reference to ES^TIUSROI supported by DBIA #3537
"RTN","SROESAD",10,0)
 ;
"RTN","SROESAD",11,0)
 Q:'$D(SRNDOC(SRTN))&'$D(SRADOC(SRTN))  D DISPLAY I SRESNOT D NOAD Q
"RTN","SROESAD",12,0)
ASK N SRSCOM W @IOF,! S DIR(0)="Y",DIR("A")="Do you want to add a comment for this case",DIR("B")="NO" D ^DIR K DIR S SRSCOM=Y I $D(DTOUT) D NOAD Q
"RTN","SROESAD",13,0)
 I $D(DUOUT) D SURE I 'SRESNOT G ASK
"RTN","SROESAD",14,0)
 I SRESNOT D NOAD Q
"RTN","SROESAD",15,0)
 I 'SRSCOM G SIG
"RTN","SROESAD",16,0)
 I SRSCOM W !! S DIR(0)="F^3:80",DIR("A")="Comment" D ^DIR K DIR I $D(DTOUT) S SRESNOT=1 Q
"RTN","SROESAD",17,0)
 I X=""!$D(DUOUT) G SIG
"RTN","SROESAD",18,0)
 D COM
"RTN","SROESAD",19,0)
REV2 ; display addendum with comment for 2nd review
"RTN","SROESAD",20,0)
 D DISPLAY I SRESNOT D NOAD Q
"RTN","SROESAD",21,0)
SIG ; enter e-sig
"RTN","SROESAD",22,0)
 N SRNOW,SRSBN,SRSIG
"RTN","SROESAD",23,0)
 D SIG^XUSESIG I X1="" D NOAD Q
"RTN","SROESAD",24,0)
 S SRSBN=X1,SRNOW=$$NOW^XLFDT
"RTN","SROESAD",25,0)
 I $D(SRNDOC(SRTN)) D POSTN(SRTN,SRSBN,SRNOW)
"RTN","SROESAD",26,0)
 I $D(SRADOC(SRTN)) D POSTA(SRTN,SRSBN,SRNOW)
"RTN","SROESAD",27,0)
 W ! K DIR S DIR(0)="FOA",DIR("A")="Press RETURN to continue... " D ^DIR K DIR
"RTN","SROESAD",28,0)
 Q
"RTN","SROESAD",29,0)
NOAD ; no addendum created
"RTN","SROESAD",30,0)
 W !!,"No addendum created for case #"_SRTN_".  Original data will be restored.",!! S SRESNOT=1
"RTN","SROESAD",31,0)
 Q
"RTN","SROESAD",32,0)
COM ; add comment to end of addendum
"RTN","SROESAD",33,0)
 N SRCOM S SRCOM=X I $D(SRNDOC(SRTN)) S SRLN=$O(^TMP("SRNR",$J,SRTN,""),-1) I SRLN D
"RTN","SROESAD",34,0)
 .I ^TMP("SRNR",$J,SRTN,SRLN)'="" S SRLN=SRLN+1,^TMP("SRNR",$J,SRTN,SRLN)=""
"RTN","SROESAD",35,0)
 .S SRLN=SRLN+1,^TMP("SRNR",$J,SRTN,SRLN)="Addendum Comment: "_$S($L(SRCOM)<63:SRCOM,1:"")
"RTN","SROESAD",36,0)
 .I $L(SRCOM)>62 S SRLN=SRLN+1,^TMP("SRNR",$J,SRTN,SRLN)=SRCOM
"RTN","SROESAD",37,0)
 I $D(SRADOC(SRTN)) S SRLN=$O(^TMP("SRAR",$J,SRTN,""),-1) I SRLN D
"RTN","SROESAD",38,0)
 .I ^TMP("SRAR",$J,SRTN,SRLN)'="" S SRLN=SRLN+1,^TMP("SRAR",$J,SRTN,SRLN)=""
"RTN","SROESAD",39,0)
 .S SRLN=SRLN+1,^TMP("SRAR",$J,SRTN,SRLN)="Addendum Comment: "_$S($L(SRCOM)<63:SRCOM,1:"")
"RTN","SROESAD",40,0)
 .I $L(SRCOM)>62 S SRLN=SRLN+1,^TMP("SRAR",$J,SRTN,SRLN)=SRCOM
"RTN","SROESAD",41,0)
 S SRLN=$O(^TMP("SRADDEND",$J,SRTN,""),-1) I SRLN D
"RTN","SROESAD",42,0)
 .I ^TMP("SRADDEND",$J,SRTN,SRLN)'="" S SRLN=SRLN+1,^TMP("SRADDEND",$J,SRTN,SRLN)=""
"RTN","SROESAD",43,0)
 .S SRLN=SRLN+1,^TMP("SRADDEND",$J,SRTN,SRLN)="Addendum Comment: "_$S($L(SRCOM)<63:SRCOM,1:"")
"RTN","SROESAD",44,0)
 .I $L(SRCOM)>62 S SRLN=SRLN+1,^TMP("SRADDEND",$J,SRTN,SRLN)=SRCOM
"RTN","SROESAD",45,0)
 Q
"RTN","SROESAD",46,0)
GET ; gather data for modified fields for addendum display before signing
"RTN","SROESAD",47,0)
 F SRS=1,2 F SRPRE="SRARAD","SRNRAD" S SRFLD="",SRSUB=SRPRE_SRS F  S SRFLD=$O(^TMP(SRSUB,$J,SRTN,130,SRFLD)) Q:SRFLD=""  D
"RTN","SROESAD",48,0)
 .I SRFLD[";W" S SRLN="" D  Q
"RTN","SROESAD",49,0)
 ..F  S SRLN=$O(^TMP(SRSUB,$J,SRTN,130,SRFLD,SRLN)) Q:SRLN=""  S ^TMP("SRAD"_SRS,$J,SRTN,130,SRFLD,SRLN)=^TMP(SRSUB,$J,SRTN,130,SRFLD,SRLN)
"RTN","SROESAD",50,0)
 .S ^TMP("SRAD"_SRS,$J,SRTN,130,SRFLD)=^TMP(SRSUB,$J,SRTN,130,SRFLD)
"RTN","SROESAD",51,0)
 F SRS=1,2 F SRPRE="SRARAD","SRNRAD" S SRMULT="A",SRSUB=SRPRE_SRS F  S SRMULT=$O(^TMP(SRSUB,$J,SRTN,SRMULT)) Q:SRMULT=""  S SRE="" D
"RTN","SROESAD",52,0)
 .F  S SRE=$O(^TMP(SRSUB,$J,SRTN,SRMULT,SRE)) Q:'SRE  S SRE1="" F  S SRE1=$O(^TMP(SRSUB,$J,SRTN,SRMULT,SRE,SRE1)) Q:SRE1=""  S SRFLD="" F  S SRFLD=$O(^TMP(SRSUB,$J,SRTN,SRMULT,SRE,SRE1,SRFLD)) Q:SRFLD=""  D
"RTN","SROESAD",53,0)
 ..I SRFLD[";W" S SRLN="" D  Q
"RTN","SROESAD",54,0)
 ...F  S SRLN=$O(^TMP(SRSUB,$J,SRTN,SRMULT,SRE,SRE1,SRFLD,SRLN)) Q:SRLN=""  S ^TMP("SRAD"_SRS,$J,SRTN,SRMULT,SRE,SRE1,SRFLD,SRLN)=^TMP(SRSUB,$J,SRTN,SRMULT,SRE,SRE1,SRFLD,SRLN)
"RTN","SROESAD",55,0)
 ..S ^TMP("SRAD"_SRS,$J,SRTN,SRMULT,SRE,SRE1,SRFLD)=^TMP(SRSUB,$J,SRTN,SRMULT,SRE,SRE1,SRFLD)
"RTN","SROESAD",56,0)
 F SRS=1,2 F SRPRE="SRARMULT","SRNRMULT" S SRMULT="A",SRSUB=SRPRE_SRS F  S SRMULT=$O(^TMP(SRSUB,$J,SRTN,SRMULT)) Q:SRMULT=""  S SRE="" D
"RTN","SROESAD",57,0)
 .F  S SRE=$O(^TMP(SRSUB,$J,SRTN,SRMULT,SRE)) Q:'SRE  S SRE1="" F  S SRE1=$O(^TMP(SRSUB,$J,SRTN,SRMULT,SRE,SRE1)) Q:SRE1=""  S SRFLD="" F  S SRFLD=$O(^TMP(SRSUB,$J,SRTN,SRMULT,SRE,SRE1,SRFLD)) Q:SRFLD=""  D
"RTN","SROESAD",58,0)
 ..I SRFLD[";W" S SRLN="" D  Q
"RTN","SROESAD",59,0)
 ...F  S SRLN=$O(^TMP(SRSUB,$J,SRTN,SRMULT,SRE,SRE1,SRFLD,SRLN)) Q:SRLN=""  S ^TMP("SRADM"_SRS,$J,SRTN,SRMULT,SRE,SRE1,SRFLD,SRLN)=^TMP(SRSUB,$J,SRTN,SRMULT,SRE,SRE1,SRFLD,SRLN)
"RTN","SROESAD",60,0)
 ..S ^TMP("SRADM"_SRS,$J,SRTN,SRMULT,SRE,SRE1,SRFLD)=^TMP(SRSUB,$J,SRTN,SRMULT,SRE,SRE1,SRFLD)
"RTN","SROESAD",61,0)
 Q
"RTN","SROESAD",62,0)
DISPLAY ; display addenda to nurse/anesthesia report(s)
"RTN","SROESAD",63,0)
 S SRLN=0
"RTN","SROESAD",64,0)
 D HDR F  S SRLN=$O(^TMP("SRADDEND",$J,SRTN,SRLN)) Q:'SRLN  D  Q:SRESNOT
"RTN","SROESAD",65,0)
 .I $Y+4>IOSL D PAGE Q:SRESNOT  D HDR
"RTN","SROESAD",66,0)
 .W !,^TMP("SRADDEND",$J,SRTN,SRLN)
"RTN","SROESAD",67,0)
 D:'SRESNOT PAGE
"RTN","SROESAD",68,0)
 Q
"RTN","SROESAD",69,0)
PAGE W ! K DIR S DIR(0)="E" D ^DIR K DIR I $D(DTOUT) S SRESNOT=1 Q
"RTN","SROESAD",70,0)
 I $D(DUOUT) D SURE
"RTN","SROESAD",71,0)
 Q
"RTN","SROESAD",72,0)
SURE W ! S DIR("A",1)="No addendum will be created and the original data will be restored.",DIR("A")="Are you sure you want to exit",DIR("B")="NO",DIR(0)="Y" D ^DIR K DIR I Y!$D(DTOUT)!$D(DUOUT) S SRESNOT=1
"RTN","SROESAD",73,0)
 Q
"RTN","SROESAD",74,0)
HDR ; header for addendum display
"RTN","SROESAD",75,0)
 W @IOF,!,"Addendum for Case #"_SRTN_" - "_SRSDATE,!,"Patient: "_VADM(1)_" ("_VA("PID")_")",!
"RTN","SROESAD",76,0)
 F I=1:1:80 W "-"
"RTN","SROESAD",77,0)
 Q
"RTN","SROESAD",78,0)
POSTA(SRTN,SRSBN,SRNOW) ;post signed addendum to anesthesia report
"RTN","SROESAD",79,0)
 N SRADD,SRAY,SRTIU
"RTN","SROESAD",80,0)
 S SRAY(1405)=SRTN_";SRF(",SRAY(1701)="Case #: "_SRTN
"RTN","SROESAD",81,0)
 F I=1:1 Q:'$D(^TMP("SRAR",$J,SRTN,I))  S SRAY("TEXT",I,0)=^TMP("SRAR",$J,SRTN,I)
"RTN","SROESAD",82,0)
 S SRTIU=$P($G(^SRF(SRTN,"TIU")),"^",4) Q:'SRTIU
"RTN","SROESAD",83,0)
 D MAKEADD^TIUSRVP(.SRADD,SRTIU,.SRAY,1) Q:'+SRADD
"RTN","SROESAD",84,0)
 S SRTIU=+SRADD K SRAY
"RTN","SROESAD",85,0)
 D ES^TIUSROI(SRTIU,DUZ)
"RTN","SROESAD",86,0)
 Q
"RTN","SROESAD",87,0)
POSTN(SRTN,SRSBN,SRNOW) ; post signed addendum
"RTN","SROESAD",88,0)
 N SRADD,SRAY,SRTIU
"RTN","SROESAD",89,0)
 S SRAY(1405)=SRTN_";SRF(",SRAY(1701)="Case #: "_SRTN
"RTN","SROESAD",90,0)
 F I=1:1 Q:'$D(^TMP("SRNR",$J,SRTN,I))  S SRAY("TEXT",I,0)=^TMP("SRNR",$J,SRTN,I)
"RTN","SROESAD",91,0)
 S SRTIU=$P($G(^SRF(SRTN,"TIU")),"^",2) Q:'SRTIU
"RTN","SROESAD",92,0)
 D MAKEADD^TIUSRVP(.SRADD,SRTIU,.SRAY,1) Q:'+SRADD
"RTN","SROESAD",93,0)
 S SRTIU=+SRADD K SRAY
"RTN","SROESAD",94,0)
 D ES^TIUSROI(SRTIU,DUZ)
"RTN","SROESAD",95,0)
 Q
"RTN","SROESAD1")
0^42^B34550126
"RTN","SROESAD1",1,0)
SROESAD1 ;BIR/ADM - SURGERY E-SIG UTILITY ; [ 04/16/01  1:03 PM ]
"RTN","SROESAD1",2,0)
 ;;3.0; Surgery ;**100**;24 Jun 93
"RTN","SROESAD1",3,0)
 ;
"RTN","SROESAD1",4,0)
 ;** NOTICE: This routine is part of an implementation of a nationally
"RTN","SROESAD1",5,0)
 ;**         controlled procedure.  Local modifications to this routine
"RTN","SROESAD1",6,0)
 ;**         are prohibited.
"RTN","SROESAD1",7,0)
 ;
"RTN","SROESAD1",8,0)
 N SRALN,SRE,SRE1,SRFILE,SRFLD,SRG,SRI,SRJ,SRLN,SRMULT,SRNM,SRNUM,SRPF,SRPRE,SRS,SRSUB,SRTITLE,SRVAL,SRVAL1,SRVAL2,SRX,SRY,X
"RTN","SROESAD1",9,0)
 F SRJ="SRADDEND","SRAD1","SRAD2","SRADM1","SRADM2" K ^TMP(SRJ,$J,SRTN)
"RTN","SROESAD1",10,0)
 S SRI=0,SRG=$NA(^TMP("SRADDEND",$J,SRTN)) K @SRG
"RTN","SROESAD1",11,0)
 D GET^SROESAD
"RTN","SROESAD1",12,0)
SING ; single fields
"RTN","SROESAD1",13,0)
 S SRFLD="" F  S SRFLD=$O(^TMP("SRAD1",$J,SRTN,130,SRFLD)) Q:SRFLD=""  D
"RTN","SROESAD1",14,0)
 .S SRTITLE=$P(SRFLD,"-"),X=$P(SRFLD,"-",2),SRFILE=$P(X,","),SRNUM=$P(X,",",2) I SRNUM[";W" D WPS Q
"RTN","SROESAD1",15,0)
 .S SRVAL1="<NOT ENTERED>",SRY=$G(^TMP("SRAD1",$J,SRTN,130,SRFLD)) I SRY'="" D EXT S SRVAL1=SRX
"RTN","SROESAD1",16,0)
 .S SRVAL2="<DELETED>",SRY=$G(^TMP("SRAD2",$J,SRTN,130,SRFLD)) I SRY'="" D EXT S SRVAL2=SRX
"RTN","SROESAD1",17,0)
 .D LINE(2) S @SRG@(SRI)="The "_SRTITLE_" field was changed" D LINE(1) S @SRG@(SRI)="  from "_SRVAL1 D LINE(1) S @SRG@(SRI)="    to "_SRVAL2
"RTN","SROESAD1",18,0)
MULT ; multiples
"RTN","SROESAD1",19,0)
 S SRMULT="" F  S SRMULT=$O(^TMP("SRADM1",$J,SRTN,SRMULT)) Q:SRMULT=""  D
"RTN","SROESAD1",20,0)
 .D LINE(2) S @SRG@(SRI)="The "_SRMULT_" subfile was changed as follows:"
"RTN","SROESAD1",21,0)
 .S SRE=0 F  S SRE=$O(^TMP("SRADM1",$J,SRTN,SRMULT,SRE)) Q:'SRE  D
"RTN","SROESAD1",22,0)
 ..S SRE1="",SRJ=2,SRPF=0 F  S SRE1=$O(^TMP("SRADM1",$J,SRTN,SRMULT,SRE,SRE1)) Q:SRE1=""  D  Q:SRE1=""
"RTN","SROESAD1",23,0)
 ...S SRFLD="" F  S SRFLD=$O(^TMP("SRADM1",$J,SRTN,SRMULT,SRE,SRE1,SRFLD)) Q:SRFLD=""  D PROC Q:SRFLD=""
"RTN","SROESAD1",24,0)
 Q
"RTN","SROESAD1",25,0)
WPS ; word-processing fields
"RTN","SROESAD1",26,0)
 D LINE(2) S @SRG@(SRI)="The "_SRTITLE_" field was changed" D LINE(1) S @SRG@(SRI)=" >> from original "_SRTITLE_" text:"
"RTN","SROESAD1",27,0)
 I '$O(^TMP("SRAD1",$J,SRTN,130,SRFLD,0)) S @SRG@(SRI)=@SRG@(SRI)_" <NO TEXT ENTERED>"
"RTN","SROESAD1",28,0)
 S SRLN=0 F  S SRLN=$O(^TMP("SRAD1",$J,SRTN,130,SRFLD,SRLN)) Q:'SRLN  S X=^TMP("SRAD1",$J,SRTN,130,SRFLD,SRLN) D LINE(1) S @SRG@(SRI)="    "_X
"RTN","SROESAD1",29,0)
WPS2 D LINE(1) S @SRG@(SRI)=" >> to updated "_SRTITLE_" text:" I '$O(^TMP("SRAD2",$J,SRTN,130,SRFLD,0)) S @SRG@(SRI)=@SRG@(SRI)_" <TEXT DELETED>"
"RTN","SROESAD1",30,0)
 S SRLN=0 F  S SRLN=$O(^TMP("SRAD2",$J,SRTN,130,SRFLD,SRLN)) Q:'SRLN  S X=^TMP("SRAD2",$J,SRTN,130,SRFLD,SRLN) D LINE(1) S @SRG@(SRI)="    "_X
"RTN","SROESAD1",31,0)
 Q
"RTN","SROESAD1",32,0)
EXT ; get external value
"RTN","SROESAD1",33,0)
 S SRX=$$EXTERNAL^DILFD(SRFILE,SRNUM,"",SRY)
"RTN","SROESAD1",34,0)
 I SRFILE=130 D  Q
"RTN","SROESAD1",35,0)
 .I SRNUM=27,SRX'="" S SRX=$E(SRX,1,5) D CPT Q
"RTN","SROESAD1",36,0)
 .I SRNUM=66 D DIAG
"RTN","SROESAD1",37,0)
 I SRFILE=130.16,SRNUM=3,SRX'="" S SRX=$E(SRX,1,5) D CPT Q
"RTN","SROESAD1",38,0)
 I SRFILE=130.18,SRNUM=3 D DIAG
"RTN","SROESAD1",39,0)
 Q
"RTN","SROESAD1",40,0)
DIAG K DA,DIC,DIQ,DR S DA=SRY,DIQ="SRY",DIQ(0)="E",DR="3",DIC="^ICD9(" D EN^DIQ1 K DA,DIC,DIQ,DR S SRX=SRX_"  "_$G(SRY(80,SRY,3,"E")) K SRY
"RTN","SROESAD1",41,0)
 Q
"RTN","SROESAD1",42,0)
CPT S X=$$CPT^ICPTCOD(SRX),SRX=SRX_"  "_$P(X,"^",3)
"RTN","SROESAD1",43,0)
 Q
"RTN","SROESAD1",44,0)
PROC S SRTITLE=$P(SRFLD,"-",2),X=$P(SRFLD,"-",3),SRFILE=$P(X,","),SRNUM=$P(X,",",2),SRJ=$P(SRFLD,"-",4) I SRNUM[";W" D WPM Q
"RTN","SROESAD1",45,0)
 S SRVAL1="",SRY=$G(^TMP("SRADM1",$J,SRTN,SRMULT,SRE,SRE1,SRFLD)) I SRY'="" D EXT S SRVAL1=SRX
"RTN","SROESAD1",46,0)
 S SRVAL2="",SRY=$G(^TMP("SRADM2",$J,SRTN,SRMULT,SRE,SRE1,SRFLD)) I SRY'="" D EXT S SRVAL2=SRX
"RTN","SROESAD1",47,0)
 I $P(SRFLD,"-")="01",SRVAL1=""!(SRVAL2="") D FP01 Q
"RTN","SROESAD1",48,0)
 I 'SRPF,$P(SRNUM,";")=.01,SRVAL1=""!(SRVAL2="") D FP01S Q
"RTN","SROESAD1",49,0)
 I SRPF D FPX Q
"RTN","SROESAD1",50,0)
 S:SRVAL1="" SRVAL1="<NOT ENTERED>" S:SRVAL2="" SRVAL2="<DELETED>"
"RTN","SROESAD1",51,0)
 I SRVAL2=SRVAL1 D:$P(SRFLD,"-")="01" LINE(1) D LINE(1) S @SRG@(SRI)=$$SPACE(SRJ)_"The "_SRTITLE_" entry "_SRVAL1_" was changed:" Q
"RTN","SROESAD1",52,0)
 D:$P(SRFLD,"-")="01" LINE(1) D LINE(1) S @SRG@(SRI)=$$SPACE(SRJ)_"The "_SRTITLE_" field was changed" D LINE(1) S @SRG@(SRI)=$$SPACE(SRJ)_"  from "_SRVAL1 D LINE(1) S @SRG@(SRI)=$$SPACE(SRJ)_"    to "_SRVAL2
"RTN","SROESAD1",53,0)
 Q
"RTN","SROESAD1",54,0)
FP01S ; add or delete subfile entry
"RTN","SROESAD1",55,0)
 I SRVAL1="" D LINE(1) S @SRG@(SRI)=$$SPACE(SRJ)_"The following "_SRTITLE_" was ADDED:" S SRNM=2
"RTN","SROESAD1",56,0)
 I SRVAL2="" D LINE(1) S @SRG@(SRI)=$$SPACE(SRJ)_"The following "_SRTITLE_" was DELETED:" S SRNM=1
"RTN","SROESAD1",57,0)
 S SRPF=1,SRVAL=$S(SRNM=1:SRVAL1,1:SRVAL2) D LINE(1) S @SRG@(SRI)=$$SPACE(SRJ+2)_SRTITLE_": "_SRVAL
"RTN","SROESAD1",58,0)
 Q
"RTN","SROESAD1",59,0)
FP01 ; add or delete
"RTN","SROESAD1",60,0)
 I SRVAL1="" D LINE(2) S @SRG@(SRI)=$$SPACE(SRJ)_"The following "_SRTITLE_" was ADDED:" S SRNM=2
"RTN","SROESAD1",61,0)
 I SRVAL2="" D LINE(2) S @SRG@(SRI)=$$SPACE(SRJ)_"The following "_SRTITLE_" was DELETED:" S SRNM=1
"RTN","SROESAD1",62,0)
 S SRPF=1,SRVAL=$S(SRNM=1:SRVAL1,1:SRVAL2) D LINE(1) S @SRG@(SRI)=$$SPACE(SRJ+2)_SRTITLE_": "_SRVAL
"RTN","SROESAD1",63,0)
 Q
"RTN","SROESAD1",64,0)
FPX S SRJ=SRJ+2 I SRNUM[";W" D WPM
"RTN","SROESAD1",65,0)
 S SRVAL="",SRY=$G(^TMP("SRADM"_SRNM,$J,SRTN,SRMULT,SRE,SRE1,SRFLD)) I SRY'="" D EXT S SRVAL=SRX
"RTN","SROESAD1",66,0)
 D LINE(1) S @SRG@(SRI)=$$SPACE(SRJ)_SRTITLE_": "_SRVAL
"RTN","SROESAD1",67,0)
 Q
"RTN","SROESAD1",68,0)
FWPM ; word-processing in multiples in added or deleted entries
"RTN","SROESAD1",69,0)
 I '$O(^TMP("SRAD1",$J,SRTN,SRMULT,SRE,SRE1,SRFLD,0)) S SRS=2
"RTN","SROESAD1",70,0)
 I '$O(^TMP("SRAD2",$J,SRTN,SRMULT,SRE,SRE1,SRFLD,0)) S SRS=1
"RTN","SROESAD1",71,0)
 D LINE(1) S @SRG@(SRI)=$$SPACE(SRJ)_SRTITLE_":" S SRLN=0
"RTN","SROESAD1",72,0)
 F  S SRLN=$O(^TMP("SRADM"_SRS,$J,SRTN,SRMULT,SRE,SRE1,SRFLD,SRLN)) Q:'SRLN  S X=^TMP("SRADM"_SRS,$J,SRTN,SRMULT,SRE,SRE1,SRFLD,SRLN) D LINE(1) S @SRG@(SRI)=$$SPACE(SRJ)_X
"RTN","SROESAD1",73,0)
 Q
"RTN","SROESAD1",74,0)
WPM ; word-processing in multiples
"RTN","SROESAD1",75,0)
 I SRPF S SRJ=SRJ+2 D FWPM Q
"RTN","SROESAD1",76,0)
 D LINE(1) S @SRG@(SRI)=$$SPACE(SRJ)_"The "_SRTITLE_" field was changed" D LINE(1) S @SRG@(SRI)=$$SPACE(SRJ+2)_">> from original "_SRTITLE_" text:"
"RTN","SROESAD1",77,0)
 I '$O(^TMP("SRAD1",$J,SRTN,SRMULT,SRE,SRE1,SRFLD,0)) S @SRG@(SRI)=@SRG@(SRI)_" <NO TEXT ENTERED>" D WPM2 Q
"RTN","SROESAD1",78,0)
 S SRLN=0 F  S SRLN=$O(^TMP("SRADM1",$J,SRTN,SRMULT,SRE,SRE1,SRFLD,SRLN)) Q:'SRLN  S X=^TMP("SRADM1",$J,SRTN,SRMULT,SRE,SRE1,SRFLD,SRLN) D LINE(1) S @SRG@(SRI)=$$SPACE(SRJ+2)_X
"RTN","SROESAD1",79,0)
WPM2 D LINE(1) S @SRG@(SRI)=$$SPACE(SRJ+2)_">> to updated "_SRTITLE_" text:" I '$O(^TMP("SRAD2",$J,SRTN,SRMULT,SRE,SRE1,SRFLD,0)) S @SRG@(SRI)=@SRG@(SRI)_" <TEXT DELETED>" Q
"RTN","SROESAD1",80,0)
 S SRLN=0 F  S SRLN=$O(^TMP("SRADM2",$J,SRTN,SRMULT,SRE,SRE1,SRFLD,SRLN)) Q:'SRLN  S X=^TMP("SRADM2",$J,SRTN,SRMULT,SRE,SRE1,SRFLD,SRLN) D LINE(1) S @SRG@(SRI)=$$SPACE(SRJ+2)_X
"RTN","SROESAD1",81,0)
 Q
"RTN","SROESAD1",82,0)
SPACE(NUM) ; create spaces
"RTN","SROESAD1",83,0)
 ; pass in position, returns number of needed spaces
"RTN","SROESAD1",84,0)
 I '$D(@SRG@(SRI)) S @SRG@(SRI)=""
"RTN","SROESAD1",85,0)
 Q $J("",NUM-$L(@SRG@(SRI)))
"RTN","SROESAD1",86,0)
 Q
"RTN","SROESAD1",87,0)
LINE(NUM) ; create carriage returns
"RTN","SROESAD1",88,0)
 F J=1:1:NUM S SRI=SRI+1,@SRG@(SRI)=""
"RTN","SROESAD1",89,0)
 Q
"RTN","SROESAR")
0^43^B30442459
"RTN","SROESAR",1,0)
SROESAR ;BIR/ADM - ANESTHESIA REPORT E-SIG UTILITY ; [ 02/20/02  6:57 AM ]
"RTN","SROESAR",2,0)
 ;;3.0; Surgery ;**100**;24 Jun 93
"RTN","SROESAR",3,0)
 ;
"RTN","SROESAR",4,0)
 ;** NOTICE: This routine is part of an implementation of a nationally
"RTN","SROESAR",5,0)
 ;**         controlled procedure.  Local modifications to this routine
"RTN","SROESAR",6,0)
 ;**         are prohibited.
"RTN","SROESAR",7,0)
 ;
"RTN","SROESAR",8,0)
 Q
"RTN","SROESAR",9,0)
IN N SRS S SRS=1 D GET
"RTN","SROESAR",10,0)
 Q
"RTN","SROESAR",11,0)
EX N SRS S SRS=2 D GET,COMP
"RTN","SROESAR",12,0)
 I $D(^TMP("SRARAD1",$J,SRTN))!$D(^TMP("SRARAD2",$J,SRTN)) D ^SROESAR2
"RTN","SROESAR",13,0)
 Q
"RTN","SROESAR",14,0)
GET K ^TMP("SRARAD"_SRS,$J,SRTN) D VIEW^SROESAR0,MULT
"RTN","SROESAR",15,0)
 Q
"RTN","SROESAR",16,0)
MULT ; get data from multiples
"RTN","SROESAR",17,0)
 N SRK F SRK=130.16,130.06,130.33,130.04,130.41 D MULT^SROESAR1
"RTN","SROESAR",18,0)
 Q
"RTN","SROESAR",19,0)
COMP ; compare before and after view
"RTN","SROESAR",20,0)
 N SRFLD,SRCHNG,SRE,SRE1,SRE2,SRS,SRS1,SROTH,SRLN,SRMULT,X
"RTN","SROESAR",21,0)
 S SRFLD="" F  S SRFLD=$O(^TMP("SRARAD1",$J,SRTN,130,SRFLD)) Q:SRFLD=""  S SRCHNG=0 D
"RTN","SROESAR",22,0)
 .I $P(SRFLD,"-",2)[";W" D  Q
"RTN","SROESAR",23,0)
 ..F SRS=1,2 Q:SRCHNG  S SRLN=0,SROTH=$S(SRS=1:2,1:1) F  S SRLN=$O(^TMP("SRARAD"_SRS,$J,SRTN,130,SRFLD,SRLN)) Q:'SRLN  D  Q:SRCHNG
"RTN","SROESAR",24,0)
 ...I ^TMP("SRARAD"_SRS,$J,SRTN,130,SRFLD,SRLN)'=$G(^TMP("SRARAD"_SROTH,$J,SRTN,130,SRFLD,SRLN)) S SRCHNG=1
"RTN","SROESAR",25,0)
 ..I 'SRCHNG F SRS=1,2 K ^TMP("SRARAD"_SRS,$J,SRTN,130,SRFLD)
"RTN","SROESAR",26,0)
 .I ^TMP("SRARAD1",$J,SRTN,130,SRFLD)'=$G(^TMP("SRARAD2",$J,SRTN,130,SRFLD)) S SRCHNG=1
"RTN","SROESAR",27,0)
 .I 'SRCHNG F SRS=1,2 K ^TMP("SRARAD"_SRS,$J,SRTN,130,SRFLD)
"RTN","SROESAR",28,0)
CMULT ; process multiples
"RTN","SROESAR",29,0)
 F SRS=1,2 K ^TMP("SRARMULT"_SRS,$J,SRTN)
"RTN","SROESAR",30,0)
 F SRS=1,2 S SRMULT="A" F  S SRMULT=$O(^TMP("SRARAD"_SRS,$J,SRTN,SRMULT)) Q:SRMULT=""  S SROTH=$S(SRS=1:2,1:1) D PASS1
"RTN","SROESAR",31,0)
 F SRS=1,2 S SRMULT="A" F  S SRMULT=$O(^TMP("SRARAD"_SRS,$J,SRTN,SRMULT)) Q:SRMULT=""  S SROTH=$S(SRS=1:2,1:1) D PASS2
"RTN","SROESAR",32,0)
 F SRS=1,2 S SRMULT="A" F  S SRMULT=$O(^TMP("SRARAD"_SRS,$J,SRTN,SRMULT)) Q:SRMULT=""  S SROTH=$S(SRS=1:2,1:1) D PASS3
"RTN","SROESAR",33,0)
 F SRS=1,2 S SRMULT="A" F  S SRMULT=$O(^TMP("SRARAD"_SRS,$J,SRTN,SRMULT)) Q:SRMULT=""  S SROTH=$S(SRS=1:2,1:1) D PASS4
"RTN","SROESAR",34,0)
 Q
"RTN","SROESAR",35,0)
PASS1 ; delete nodes for unchanged fields except for .01 fields
"RTN","SROESAR",36,0)
 S SRE=0 F  S SRE=$O(^TMP("SRARAD"_SRS,$J,SRTN,SRMULT,SRE)) Q:'SRE  S SRE1="" F  S SRE1=$O(^TMP("SRARAD"_SRS,$J,SRTN,SRMULT,SRE,SRE1)) Q:SRE1=""  D
"RTN","SROESAR",37,0)
 .S SRFLD="" F  S SRFLD=$O(^TMP("SRARAD"_SRS,$J,SRTN,SRMULT,SRE,SRE1,SRFLD)) Q:SRFLD=""  S SRCHNG=0 D
"RTN","SROESAR",38,0)
 ..S Y=$P(SRFLD,"-",3) I $P(Y,",",2)=.01 Q
"RTN","SROESAR",39,0)
 ..I $P(SRFLD,"-",3)[";W" D  Q
"RTN","SROESAR",40,0)
 ...F SRS1=1,2 Q:SRCHNG  S SRLN=0,SROTH=$S(SRS1=1:2,1:1) F  S SRLN=$O(^TMP("SRARAD"_SRS1,$J,SRTN,SRMULT,SRE,SRE1,SRFLD,SRLN)) Q:'SRLN  D
"RTN","SROESAR",41,0)
 ....I ^TMP("SRARAD"_SRS1,$J,SRTN,SRMULT,SRE,SRE1,SRFLD,SRLN)'=$G(^TMP("SRARAD"_SROTH,$J,SRTN,SRMULT,SRE,SRE1,SRFLD,SRLN)) S SRCHNG=1
"RTN","SROESAR",42,0)
 ...I 'SRCHNG F SRS1=1,2 K ^TMP("SRARAD"_SRS1,$J,SRTN,SRMULT,SRE,SRE1,SRFLD)
"RTN","SROESAR",43,0)
 ..S SROTH=$S(SRS=1:2,1:1) I ^TMP("SRARAD"_SRS,$J,SRTN,SRMULT,SRE,SRE1,SRFLD)'=$G(^TMP("SRARAD"_SROTH,$J,SRTN,SRMULT,SRE,SRE1,SRFLD)) S SRCHNG=1
"RTN","SROESAR",44,0)
 ..I 'SRCHNG F SRS1=1,2 K ^TMP("SRARAD"_SRS1,$J,SRTN,SRMULT,SRE,SRE1,SRFLD)
"RTN","SROESAR",45,0)
 Q
"RTN","SROESAR",46,0)
PASS2 ; delete .01 nodes of sub-multiples if no changes underneath - before or after
"RTN","SROESAR",47,0)
 N SRNXT1,SRNXT2,SRY1,SRY2
"RTN","SROESAR",48,0)
 S SRE=0 F  S SRE=$O(^TMP("SRARAD"_SRS,$J,SRTN,SRMULT,SRE)) Q:'SRE  S SRE1=0 F  S SRE1=$O(^TMP("SRARAD"_SRS,$J,SRTN,SRMULT,SRE,SRE1)) Q:SRE1=""  D
"RTN","SROESAR",49,0)
 .S SRFLD="" F  S SRFLD=$O(^TMP("SRARAD"_SRS,$J,SRTN,SRMULT,SRE,SRE1,SRFLD)) Q:SRFLD=""  D
"RTN","SROESAR",50,0)
 ..I ^TMP("SRARAD"_SRS,$J,SRTN,SRMULT,SRE,SRE1,SRFLD)'=$G(^TMP("SRARAD"_SROTH,$J,SRTN,SRMULT,SRE,SRE1,SRFLD)) Q
"RTN","SROESAR",51,0)
 ..S SRNXT1=$O(^TMP("SRARAD"_SRS,$J,SRTN,SRMULT,SRE,SRE1,SRFLD))
"RTN","SROESAR",52,0)
 ..S SRNXT2=$O(^TMP("SRARAD"_SROTH,$J,SRTN,SRMULT,SRE,SRE1,SRFLD))
"RTN","SROESAR",53,0)
 ..I SRNXT1="",SRNXT2="" K ^TMP("SRARAD"_SRS,$J,SRTN,SRMULT,SRE,SRE1,SRFLD),^TMP("SRARAD"_SROTH,$J,SRTN,SRMULT,SRE,SRE1,SRFLD) Q
"RTN","SROESAR",54,0)
 ..S SRY1=$P(SRNXT1,"-",3),SRY2=$P(SRNXT2,"-",3) I $P(SRY1,",",2)=.01,$P(SRY2,",",2)=.01 K ^TMP("SRARAD"_SRS,$J,SRTN,SRMULT,SRE,SRE1,SRFLD),^TMP("SRARAD"_SROTH,$J,SRTN,SRMULT,SRE,SRE1,SRFLD)
"RTN","SROESAR",55,0)
 Q
"RTN","SROESAR",56,0)
PASS3 ; delete .01 nodes for top level multiples if no changes underneath
"RTN","SROESAR",57,0)
 S SRE=0 F  S SRE=$O(^TMP("SRARAD"_SRS,$J,SRTN,SRMULT,SRE)) Q:'SRE  S SRFLD="" F  S SRFLD=$O(^TMP("SRARAD"_SRS,$J,SRTN,SRMULT,SRE,0,SRFLD)) Q:SRFLD=""  D
"RTN","SROESAR",58,0)
 .S Y=$P(SRFLD,"-",3) I $P(Y,",",2)'=.01 Q
"RTN","SROESAR",59,0)
 .I ^TMP("SRARAD"_SRS,$J,SRTN,SRMULT,SRE,0,SRFLD)'=$G(^TMP("SRARAD"_SROTH,$J,SRTN,SRMULT,SRE,0,SRFLD)) Q
"RTN","SROESAR",60,0)
 .I $O(^TMP("SRARAD"_SRS,$J,SRTN,SRMULT,SRE,0,SRFLD))="",$O(^TMP("SRARAD"_SROTH,$J,SRTN,SRMULT,SRE,0,SRFLD))="" D
"RTN","SROESAR",61,0)
 ..I $O(^TMP("SRARAD"_SRS,$J,SRTN,SRMULT,SRE,0))'="",$O(^TMP("SRARAD"_SROTH,$J,SRTN,SRMULT,SRE,0))'="" Q
"RTN","SROESAR",62,0)
 ..K ^TMP("SRARAD"_SRS,$J,SRTN,SRMULT,SRE,0,SRFLD),^TMP("SRARAD"_SROTH,$J,SRTN,SRMULT,SRE,0,SRFLD)
"RTN","SROESAR",63,0)
 Q
"RTN","SROESAR",64,0)
PASS4 ; set up list of changed fields for display in addendum
"RTN","SROESAR",65,0)
 S SRE="" F  S SRE=$O(^TMP("SRARAD"_SRS,$J,SRTN,SRMULT,SRE)) Q:'SRE  S SRE1="" F  S SRE1=$O(^TMP("SRARAD"_SRS,$J,SRTN,SRMULT,SRE,SRE1)) Q:SRE1=""  S SRFLD="" F  S SRFLD=$O(^TMP("SRARAD"_SRS,$J,SRTN,SRMULT,SRE,SRE1,SRFLD)) Q:SRFLD=""  D
"RTN","SROESAR",66,0)
 .I $P(SRFLD,"-",3)[";W" D  Q
"RTN","SROESAR",67,0)
 ..S SRLN=0 F  S SRLN=$O(^TMP("SRARAD"_SRS,$J,SRTN,SRMULT,SRE,SRE1,SRFLD,SRLN)) Q:'SRLN  D
"RTN","SROESAR",68,0)
 ...S ^TMP("SRARMULT"_SRS,$J,SRTN,SRMULT,SRE,SRE1,SRFLD,SRLN)=$G(^TMP("SRARAD"_SRS,$J,SRTN,SRMULT,SRE,SRE1,SRFLD,SRLN))
"RTN","SROESAR",69,0)
 ...S ^TMP("SRARMULT"_SROTH,$J,SRTN,SRMULT,SRE,SRE1,SRFLD,SRLN)=$G(^TMP("SRARAD"_SROTH,$J,SRTN,SRMULT,SRE,SRE1,SRFLD,SRLN))
"RTN","SROESAR",70,0)
 .S ^TMP("SRARMULT"_SRS,$J,SRTN,SRMULT,SRE,SRE1,SRFLD)=$G(^TMP("SRARAD"_SRS,$J,SRTN,SRMULT,SRE,SRE1,SRFLD))
"RTN","SROESAR",71,0)
 .S ^TMP("SRARMULT"_SROTH,$J,SRTN,SRMULT,SRE,SRE1,SRFLD)=$G(^TMP("SRARAD"_SROTH,$J,SRTN,SRMULT,SRE,SRE1,SRFLD))
"RTN","SROESAR",72,0)
 Q
"RTN","SROESAR0")
0^44^B11601591
"RTN","SROESAR0",1,0)
SROESAR0 ;BIR/ADM - ANESTHESIA REPORT E-SIG UTILITY ; [ 02/14/04  7:47 AM ]
"RTN","SROESAR0",2,0)
 ;;3.0; Surgery ;**100**;24 Jun 93
"RTN","SROESAR0",3,0)
 ;
"RTN","SROESAR0",4,0)
 ;** NOTICE: This routine is part of an implementation of a nationally
"RTN","SROESAR0",5,0)
 ;**         controlled procedure.  Local modifications to this routine
"RTN","SROESAR0",6,0)
 ;**         are prohibited.
"RTN","SROESAR0",7,0)
 ;
"RTN","SROESAR0",8,0)
VIEW N SRJ,SRCAT,SRFLD,SRFILE,SRLN,SRNP,SRN,SRP,SRSUB,SRW,X,Y
"RTN","SROESAR0",9,0)
 F SRJ=1:1 S SRFLD=$P($T(FIELD+SRJ),";;",2) Q:SRFLD=""  D
"RTN","SROESAR0",10,0)
 .S SRNP=$P(SRFLD,"^",3),SRN=$P(SRNP,";"),SRP=$P(SRNP,";",2)
"RTN","SROESAR0",11,0)
 .S (SRSUB,X)=$P(SRFLD,"^",2),Y=$P(X,"-",2),SRFILE=$P(Y,",")
"RTN","SROESAR0",12,0)
 .S SRCAT=$P(SRFLD,"^") S SRCAT=$S(SRCAT="":SRFILE,1:SRCAT)
"RTN","SROESAR0",13,0)
 .S SRW=$S($P(Y,";",2)["W":1,1:0) I SRW D  Q
"RTN","SROESAR0",14,0)
 ..S ^TMP("SRARAD"_SRS,$J,SRTN,SRCAT,SRSUB,0)=$G(^SRF(SRTN,SRN,0))
"RTN","SROESAR0",15,0)
 ..I SRS=1 S ^TMP("SRASAVE",$J,SRTN,SRCAT,SRSUB,0)=$G(^SRF(SRTN,SRN,0))
"RTN","SROESAR0",16,0)
 ..S SRLN=0 F  S SRLN=$O(^SRF(SRTN,SRN,SRLN)) Q:'SRLN  S ^TMP("SRARAD"_SRS,$J,SRTN,SRCAT,SRSUB,SRLN)=$G(^SRF(SRTN,SRN,SRLN,0)) I SRS=1 S ^TMP("SRASAVE",$J,SRTN,SRCAT,SRSUB,SRLN)=$G(^SRF(SRTN,SRN,SRLN,0))
"RTN","SROESAR0",17,0)
 .S ^TMP("SRARAD"_SRS,$J,SRTN,SRCAT,SRSUB)=$P($G(^SRF(SRTN,SRN)),"^",SRP)
"RTN","SROESAR0",18,0)
 .I SRS=1 S ^TMP("SRASAVE",$J,SRTN,SRCAT,SRSUB)=$P($G(^SRF(SRTN,SRN)),"^",SRP)
"RTN","SROESAR0",19,0)
 Q
"RTN","SROESAR0",20,0)
REVRS ; restore before-edit data
"RTN","SROESAR0",21,0)
 N SRJ,SRCAT,SRFIELD,SRFILE,SRFLD,SRLN,SRNP,SRN,SRP,SRSUB,SRVAL,SRW,X,Y
"RTN","SROESAR0",22,0)
 F SRJ=1:1 S SRFLD=$P($T(FIELD+SRJ),";;",2) Q:SRFLD=""  D
"RTN","SROESAR0",23,0)
 .S SRNP=$P(SRFLD,"^",3),SRN=$P(SRNP,";"),SRP=$P(SRNP,";",2)
"RTN","SROESAR0",24,0)
 .S (SRSUB,X)=$P(SRFLD,"^",2),Y=$P(X,"-",2),SRFILE=$P(Y,","),SRFIELD=$P(Y,",",2)
"RTN","SROESAR0",25,0)
 .S SRCAT=$P(SRFLD,"^") S SRCAT=$S(SRCAT="":SRFILE,1:SRCAT)
"RTN","SROESAR0",26,0)
 .Q:'$D(^TMP("SRARAD1",$J,SRTN,130,SRSUB))
"RTN","SROESAR0",27,0)
 .S SRW=$S($P(Y,";",2)["W":1,1:0) I SRW D  Q
"RTN","SROESAR0",28,0)
 ..K ^SRF(SRTN,SRN) S ^SRF(SRTN,SRN,0)=$G(^TMP("SRASAVE",$J,SRTN,130,SRSUB,0))
"RTN","SROESAR0",29,0)
 ..S SRLN=0 F  S SRLN=$O(^TMP("SRASAVE",$J,SRTN,130,SRSUB,SRLN)) Q:'SRLN  S ^SRF(SRTN,SRN,SRLN,0)=$G(^TMP("SRASAVE",$J,SRTN,130,SRSUB,SRLN,0))
"RTN","SROESAR0",30,0)
 .S SRVAL=$G(^TMP("SRASAVE",$J,SRTN,130,SRSUB))
"RTN","SROESAR0",31,0)
 .I SRVAL="" S SRVAL="@"
"RTN","SROESAR0",32,0)
 .K DA,DIE,DR S DA=SRTN,DIE=130,DR=SRFIELD_"////^S X=SRVAL" D ^DIE K DA,DIE,DR
"RTN","SROESAR0",33,0)
 D REVRS^SROESARA
"RTN","SROESAR0",34,0)
 Q
"RTN","SROESAR0",35,0)
TR S SRP=SRI,SRP=$TR(SRP,"1234567890.,","ABCDEFGHIJPK")
"RTN","SROESAR0",36,0)
 Q
"RTN","SROESAR0",37,0)
FIELD ; list of fields (^field name on report-file,field^node;piece)
"RTN","SROESAR0",38,0)
KPJB ;;^Operating Room-130,.02^0;2
"RTN","SROESAR0",39,0)
KPAC ;;^ASA Class-130,1.13^1.1;3
"RTN","SROESAR0",40,0)
KPCA ;;^Principal Anesthetist-130,.31^.3;1
"RTN","SROESAR0",41,0)
KPCB ;;^Relief Anesthetist-130,.32^.3;2
"RTN","SROESAR0",42,0)
KPCC ;;^Assistant Anesthetist-130,.33^.3;3
"RTN","SROESAR0",43,0)
KPCD ;;^Anesthesiologist Supervisor-130,.34^.3;4
"RTN","SROESAR0",44,0)
KPCDE ;;^Attending Code (Anes Supervise Code)-130,.345^.3;6
"RTN","SROESAR0",45,0)
KBF ;;^Principal Procedure-130,26^OP;1
"RTN","SROESAR0",46,0)
KPBE ;;^Intraoperative Blood Loss (ml)-130,.25^.2;5
"RTN","SROESAR0",47,0)
KPBEE ;;^Total Urine Output (ml)-130,.255^.2;16
"RTN","SROESAR0",48,0)
KPDF ;;^Postoperative Disposition-130,.46^.4;6
"RTN","SROESAR0",49,0)
KPAA ;;^PAC(U) Admission Score-130,1.11^1.1;1
"RTN","SROESAR0",50,0)
KPAB ;;^PAC(U) Discharge Score-130,1.12^1.1;2
"RTN","SROESAR0",51,0)
KPBA ;;^Anesthesia Care Start Time-130,.21^.2;1
"RTN","SROESAR0",52,0)
KPBD ;;^Anesthesia Care End Time-130,.24^.2;4
"RTN","SROESAR0",53,0)
KPCF ;;^Minimum Intraoperative Temperature-130,.36^.3;7
"RTN","SROESAR0",54,0)
KPAI ;;^Postop Anesthesia Note Date/Time-130,1.19^1.1;9
"RTN","SROESAR0",55,0)
KACAPA ;;^Postop Anesthesia Note-130,130.1;W^48;0
"RTN","SROESAR0",56,0)
KPBH ;;^General Comments-130,.28;W^5;0
"RTN","SROESAR1")
0^45^B31464875
"RTN","SROESAR1",1,0)
SROESAR1 ;BIR/ADM - ANESTHESIA REPORT E-SIG UTILITY ; [ 02/14/04  9:08 AM ]
"RTN","SROESAR1",2,0)
 ;;3.0; Surgery ;**100**;24 Jun 93
"RTN","SROESAR1",3,0)
 ;
"RTN","SROESAR1",4,0)
 ;** NOTICE: This routine is part of an implementation of a nationally
"RTN","SROESAR1",5,0)
 ;**         controlled procedure.  Local modifications to this routine
"RTN","SROESAR1",6,0)
 ;**         are prohibited.
"RTN","SROESAR1",7,0)
 ;
"RTN","SROESAR1",8,0)
MULT ; process multiples
"RTN","SROESAR1",9,0)
 N I,SRFF,SRI,SRK1,SRP,SRJ,SRFF,SRFLD,SRNP,SRN,SRCAT,SRP,SRSUB,SRL,SRE,SRE1,SRW,X,Y
"RTN","SROESAR1",10,0)
 S SRI="."_$P(SRK,".",2) D TR S SRK1=SRP
"RTN","SROESAR1",11,0)
 F SRJ=0:1 S SRFLD=$P($T(@SRK1+SRJ),";;",2) Q:SRFLD=""  D ^SROESARA
"RTN","SROESAR1",12,0)
 Q
"RTN","SROESAR1",13,0)
REV N SRP D TR S SRK1=SRP,SRFLD=$P($T(@SRK1+SRJ),";;",2)
"RTN","SROESAR1",14,0)
 Q
"RTN","SROESAR1",15,0)
TR S SRP=SRI,SRP=$TR(SRP,"1234567890.,","ABCDEFGHIJPK")
"RTN","SROESAR1",16,0)
 Q
"RTN","SROESAR1",17,0)
FIELD ; list of fields
"RTN","SROESAR1",18,0)
PAF ;;Other Procedures Performed^0;.42^13,0
"RTN","SROESAR1",19,0)
 ;;Other Procedures Performed^01-Other Procedure-130.16,.01-2^13,0;1
"RTN","SROESAR1",20,0)
 ;;Other Procedures Performed^02X-CPT Code-130.16,3-4^13,2;1
"RTN","SROESAR1",21,0)
PAFD ;;Other Procedures Performed^03X-CPT Modifier-130.164,.01-4^13,MOD,0;1
"RTN","SROESAR1",22,0)
 ;;Other Procedures Performed^04X-Completed-130.16,2-4^13,0;3
"RTN","SROESAR1",23,0)
 ;;Other Procedures Performed^05X-Procedure Code Comments-130.16,1.5;W-4^13,1,0;1
"RTN","SROESAR1",24,0)
 ;;
"RTN","SROESAR1",25,0)
PJF ;;Anesthesia Technique(s)^0;.37^6,0
"RTN","SROESAR1",26,0)
 ;;Anesthesia Technique(s)^01-Anesthesia Technique-130.06,.01-2^6,0;1
"RTN","SROESAR1",27,0)
 ;;Anesthesia Technique(s)^02-Principal Technique-130.06,.05-4^6,0;3
"RTN","SROESAR1",28,0)
PDG ;;Anesthesia Technique(s)^03-Anesthesia Agent-130.47,.01-4^6,1,0;1
"RTN","SROESAR1",29,0)
 ;;Anesthesia Technique(s)^04-Dose (mg)-130.47,1-6^6,1,0;2
"RTN","SROESAR1",30,0)
 ;;Anesthesia Technique(s)^05-Monitored Anesthesia Care ? (Y/N)-130.06,41-4^6,8;1
"RTN","SROESAR1",31,0)
 ;;Anesthesia Technique(s)^06-Intubated ? (Y/N)-130.06,42-4^6,8;2
"RTN","SROESAR1",32,0)
 ;;Anesthesia Technique(s)^07-Approach-130.06,3-4^6,0;5
"RTN","SROESAR1",33,0)
 ;;Anesthesia Technique(s)^08-Route-130.06,4-4^6,0;6
"RTN","SROESAR1",34,0)
 ;;Anesthesia Technique(s)^09-Laryngoscope Type-130.06,5-4^6,0;7
"RTN","SROESAR1",35,0)
 ;;Anesthesia Technique(s)^10-Laryngoscope Size-130.06,6-4^6,0;8
"RTN","SROESAR1",36,0)
 ;;Anesthesia Technique(s)^11-Stylet Used (Y/N)-130.06,7-4^6,0;9
"RTN","SROESAR1",37,0)
 ;;Anesthesia Technique(s)^12-Lidocaine Topical-130.06,8-4^6,0;10
"RTN","SROESAR1",38,0)
 ;;Anesthesia Technique(s)^13-Lidocaine IV-130.06,9-4^6,0;11
"RTN","SROESAR1",39,0)
 ;;Anesthesia Technique(s)^14-Tube Type-130.06,10-4^6,0;12
"RTN","SROESAR1",40,0)
 ;;Anesthesia Technique(s)^15-Tube Size-130.06,11-4^6,0;13
"RTN","SROESAR1",41,0)
 ;;Anesthesia Technique(s)^16-Trauma-130.06,12-4^6,0;14
"RTN","SROESAR1",42,0)
 ;;Anesthesia Technique(s)^17-Extubated In-130.06,21-4^6,0;23
"RTN","SROESAR1",43,0)
 ;;Anesthesia Technique(s)^18-Extubated By-130.06,39-4^6,6;1
"RTN","SROESAR1",44,0)
 ;;Anesthesia Technique(s)^19-Reintubated Within 8 Hours-130.06,22-4^6,0;24
"RTN","SROESAR1",45,0)
 ;;Anesthesia Technique(s)^20-Heat, Moisture Exchanger-130.06,17-4^6,0;19
"RTN","SROESAR1",46,0)
 ;;Anesthesia Technique(s)^21-Bacterial Filter in Circuit-130.06,18-4^6,0;20
"RTN","SROESAR1",47,0)
 ;;Anesthesia Technique(s)^22-Continuous Administration ? (Y/N)-130.06,25-4^6,2;1
"RTN","SROESAR1",48,0)
 ;;Anesthesia Technique(s)^23-Baricity-130.06,26-4^6,2;2
"RTN","SROESAR1",49,0)
 ;;Anesthesia Technique(s)^24-Puncture Site-130.06,27-4^6,2;3
"RTN","SROESAR1",50,0)
 ;;Anesthesia Technique(s)^25-Needle Size-130.06,29-4^6,2;5
"RTN","SROESAR1",51,0)
 ;;Anesthesia Technique(s)^26-Neurodermatone Anesthesia Sensory Level-130.06,43-4^6,8;3
"RTN","SROESAR1",52,0)
 ;;Anesthesia Technique(s)^27-Dural Puncture ? (Y/N)-130.06,34-4^6,3;4
"RTN","SROESAR1",53,0)
 ;;Anesthesia Technique(s)^28-Catheter Removed By-130.06,35-4^6,3;5
"RTN","SROESAR1",54,0)
 ;;Anesthesia Technique(s)^29-Date/Time Catheter Removed-130.06,44-4^6,8;4
"RTN","SROESAR1",55,0)
PDI ;;Anesthesia Technique(s)^30-Regional Block Site-130.49,.01-4^6,5,0;1
"RTN","SROESAR1",56,0)
 ;;Anesthesia Technique(s)^31-Needle Length (cm)-130.49,1-4^6,5,0;2
"RTN","SROESAR1",57,0)
 ;;Anesthesia Technique(s)^32-Needle Guage-130.49,2-4^6,5,0;3
"RTN","SROESAR1",58,0)
 ;;Anesthesia Technique(s)^33X-Patient Status-130.06,2-4^6,0;4
"RTN","SROESAR1",59,0)
 ;;Anesthesia Technique(s)^34X-Bite Block (Y/N)-130.06,13-4^6,0;15
"RTN","SROESAR1",60,0)
 ;;Anesthesia Technique(s)^35X-Tube Lubrication-130.06,14-4^6,0;16
"RTN","SROESAR1",61,0)
 ;;Anesthesia Technique(s)^36X-Taped at Length-130.06,15-4^6,0;17
"RTN","SROESAR1",62,0)
 ;;Anesthesia Technique(s)^37X-Breath Sounds OK Bilaterally-130.06,16-4^6,0;18
"RTN","SROESAR1",63,0)
 ;;Anesthesia Technique(s)^38X-Anesthesia Ventilator Tidal Volume-130.06,19-4^6,0;21
"RTN","SROESAR1",64,0)
 ;;Anesthesia Technique(s)^39X-Anesthesia Ventilator Rate-130.06,20-4^6,0;22
"RTN","SROESAR1",65,0)
 ;;Anesthesia Technique(s)^40X-Preoxygenation-130.06,23-4^6,0;25
"RTN","SROESAR1",66,0)
 ;;Anesthesia Technique(s)^41X-Spinal Approach-130.06,28-4^6,2;4
"RTN","SROESAR1",67,0)
 ;;Anesthesia Technique(s)^42X-Epidural Method-130.06,30-4^6,3;1
"RTN","SROESAR1",68,0)
 ;;Anesthesia Technique(s)^43X-Multiple Attempts-130.06,31-4^6,3;2
"RTN","SROESAR1",69,0)
PDH ;;Anesthesia Technique(s)^44X-Test Dose-130.48,.01-4^6,4,0;1
"RTN","SROESAR1",70,0)
 ;;Anesthesia Technique(s)^45X-Dose-130.48,1-4^6,4,0;2
"RTN","SROESAR1",71,0)
 ;;Anesthesia Technique(s)^46X-Test Dose Volume-130.06,33-4^6,3;3
"RTN","SROESAR1",72,0)
 ;;Anesthesia Technique(s)^47X-Method of Administration-130.06,36-4^6,3;6
"RTN","SROESAR1",73,0)
 ;;Anesthesia Technique(s)^48X-Purpose-130.06,37-4^6,3;7
"RTN","SROESAR1",74,0)
 ;;Anesthesia Technique(s)^49X-Anesthesia Comments-130.06,40;W-4^6,7,0;1
"RTN","SROESAR1",75,0)
 ;;
"RTN","SROESAR1",76,0)
PCC ;;Medications^0;.375^22,0
"RTN","SROESAR1",77,0)
 ;;Medications^01-Medication-130.33,.01-2^22,0;1
"RTN","SROESAR1",78,0)
PCD ;;Medications^02-Time Administered-130.34,.01-4^22,1,0;1
"RTN","SROESAR1",79,0)
 ;;Medications^03-Route-130.34,4-6^22,1,0;5
"RTN","SROESAR1",80,0)
 ;;Medications^04-Dose-130.34,1-6^22,1,0;2
"RTN","SROESAR1",81,0)
 ;;Medications^05-Ordered By-130.34,2-6^22,1,0;3
"RTN","SROESAR1",82,0)
 ;;Medications^06-Administered By-130.34,3-6^22,1,0;4
"RTN","SROESAR1",83,0)
 ;;Medications^07-Comments-130.34,5-6^22,1,0;6
"RTN","SROESAR1",84,0)
 ;;
"RTN","SROESAR1",85,0)
PJD ;;Blood Replacement Fluids^0;.27^4,0
"RTN","SROESAR1",86,0)
 ;;Blood Replacement Fluids^01-Replacement Fluid Type-130.04,.01-2^4,0;1
"RTN","SROESAR1",87,0)
 ;;Blood Replacement Fluids^02-Quantity (ml)-130.04,1-4^4,0;2
"RTN","SROESAR1",88,0)
 ;;Blood Replacement Fluids^03-Source Identification-130.04,3-4^4,0;4
"RTN","SROESAR1",89,0)
 ;;Blood Replacement Fluids^04-VA Identification-130.04,4-4^4,0;5
"RTN","SROESAR1",90,0)
 ;;Blood Replacement Fluids^05X-Comments-130.04,5;W-4^4,1,0;1
"RTN","SROESAR1",91,0)
 ;;
"RTN","SROESAR1",92,0)
PDA ;;Monitor(s)^0;.293^27,0
"RTN","SROESAR1",93,0)
 ;;Monitor(s)^01-Monitor-130.41,.01-2^27,0;1
"RTN","SROESAR1",94,0)
 ;;Monitor(s)^02-Time Applied-130.41,1-4^27,0;2
"RTN","SROESAR1",95,0)
 ;;Monitor(s)^03-Time Removed-130.41,2-4^27,0;3
"RTN","SROESAR1",96,0)
 ;;Monitor(s)^04-Applied By-130.41,3-4^27,0;4
"RTN","SROESAR1",97,0)
 ;;
"RTN","SROESAR2")
0^46^B30925923
"RTN","SROESAR2",1,0)
SROESAR2 ;BIR/ADM - ANESTHESIA REPORT E-SIG UTILITY ; [ 02/14/04  6:36 AM
"RTN","SROESAR2",2,0)
 ;;3.0; Surgery ;**100**;24 Jun 93
"RTN","SROESAR2",3,0)
 ;
"RTN","SROESAR2",4,0)
 ;** NOTICE: This routine is part of an implementation of a nationally
"RTN","SROESAR2",5,0)
 ;**         controlled procedure.  Local modifications to this routine
"RTN","SROESAR2",6,0)
 ;**         are prohibited.
"RTN","SROESAR2",7,0)
 ;
"RTN","SROESAR2",8,0)
 N SRALN,SRE,SRE1,SRFILE,SRFLD,SRG,SRI,SRJ,SRLN,SRMULT,SRNM,SRNUM,SRPF,SRS,SRTITLE,SRVAL,SRVAL1,SRVAL2,SRX,SRY,X
"RTN","SROESAR2",9,0)
 S SRI=0,SRG=$NA(^TMP("SRAR",$J,SRTN)) K @SRG
"RTN","SROESAR2",10,0)
SING ; single fields
"RTN","SROESAR2",11,0)
 S SRFLD="" F  S SRFLD=$O(^TMP("SRARAD1",$J,SRTN,130,SRFLD)) Q:SRFLD=""  D
"RTN","SROESAR2",12,0)
 .S SRTITLE=$P(SRFLD,"-"),X=$P(SRFLD,"-",2),SRFILE=$P(X,","),SRNUM=$P(X,",",2) I SRNUM[";W" D WPS Q
"RTN","SROESAR2",13,0)
 .S SRVAL1="<NOT ENTERED>",SRY=$G(^TMP("SRARAD1",$J,SRTN,130,SRFLD)) I SRY'="" D EXT S SRVAL1=SRX
"RTN","SROESAR2",14,0)
 .S SRVAL2="<DELETED>",SRY=$G(^TMP("SRARAD2",$J,SRTN,130,SRFLD)) I SRY'="" D EXT S SRVAL2=SRX
"RTN","SROESAR2",15,0)
 .D LINE(2) S @SRG@(SRI)="The "_SRTITLE_" field was changed" D LINE(1) S @SRG@(SRI)="  from "_SRVAL1 D LINE(1) S @SRG@(SRI)="    to "_SRVAL2
"RTN","SROESAR2",16,0)
MULT ; multiples
"RTN","SROESAR2",17,0)
 S SRMULT="" F  S SRMULT=$O(^TMP("SRARMULT1",$J,SRTN,SRMULT)) Q:SRMULT=""  D
"RTN","SROESAR2",18,0)
 .D LINE(2) S @SRG@(SRI)="The "_SRMULT_" subfile was changed as follows:"
"RTN","SROESAR2",19,0)
 .S SRE=0 F  S SRE=$O(^TMP("SRARMULT1",$J,SRTN,SRMULT,SRE)) Q:'SRE  D
"RTN","SROESAR2",20,0)
 ..S SRE1="",SRJ=2,SRPF=0 F  S SRE1=$O(^TMP("SRARMULT1",$J,SRTN,SRMULT,SRE,SRE1)) Q:SRE1=""  D  Q:SRE1=""
"RTN","SROESAR2",21,0)
 ...S SRFLD="" F  S SRFLD=$O(^TMP("SRARMULT1",$J,SRTN,SRMULT,SRE,SRE1,SRFLD)) Q:SRFLD=""  D PROC Q:SRFLD=""
"RTN","SROESAR2",22,0)
 Q
"RTN","SROESAR2",23,0)
WPS ; word-processing fields
"RTN","SROESAR2",24,0)
 D LINE(2) S @SRG@(SRI)="The "_SRTITLE_" field was changed" D LINE(1) S @SRG@(SRI)=" >> from original "_SRTITLE_" text:"
"RTN","SROESAR2",25,0)
 I '$O(^TMP("SRARAD1",$J,SRTN,130,SRFLD,0)) S @SRG@(SRI)=@SRG@(SRI)_" <NO TEXT ENTERED>"
"RTN","SROESAR2",26,0)
 S SRLN=0 F  S SRLN=$O(^TMP("SRARAD1",$J,SRTN,130,SRFLD,SRLN)) Q:'SRLN  S X=^TMP("SRARAD1",$J,SRTN,130,SRFLD,SRLN) D LINE(1) S @SRG@(SRI)="    "_X
"RTN","SROESAR2",27,0)
WPS2 D LINE(1) S @SRG@(SRI)=" >> to updated "_SRTITLE_" text:" I '$O(^TMP("SRARAD2",$J,SRTN,130,SRFLD,0)) S @SRG@(SRI)=@SRG@(SRI)_" <TEXT DELETED>"
"RTN","SROESAR2",28,0)
 S SRLN=0 F  S SRLN=$O(^TMP("SRARAD2",$J,SRTN,130,SRFLD,SRLN)) Q:'SRLN  S X=^TMP("SRARAD2",$J,SRTN,130,SRFLD,SRLN) D LINE(1) S @SRG@(SRI)="    "_X
"RTN","SROESAR2",29,0)
 Q
"RTN","SROESAR2",30,0)
EXT ; get external value
"RTN","SROESAR2",31,0)
 S SRX=$$EXTERNAL^DILFD(SRFILE,SRNUM,"",SRY)
"RTN","SROESAR2",32,0)
 Q
"RTN","SROESAR2",33,0)
PROC S SRTITLE=$P(SRFLD,"-",2),X=$P(SRFLD,"-",3),SRFILE=$P(X,","),SRNUM=$P(X,",",2),SRJ=$P(SRFLD,"-",4) I SRNUM[";W" D WPM Q
"RTN","SROESAR2",34,0)
 S SRVAL1="",SRY=$G(^TMP("SRARMULT1",$J,SRTN,SRMULT,SRE,SRE1,SRFLD)) I SRY'="" D EXT S SRVAL1=SRX
"RTN","SROESAR2",35,0)
 S SRVAL2="",SRY=$G(^TMP("SRARMULT2",$J,SRTN,SRMULT,SRE,SRE1,SRFLD)) I SRY'="" D EXT S SRVAL2=SRX
"RTN","SROESAR2",36,0)
 I $P(SRFLD,"-")="01",SRVAL1=""!(SRVAL2="") D FP01 Q
"RTN","SROESAR2",37,0)
 I 'SRPF,$P(SRNUM,";")=.01,SRVAL1=""!(SRVAL2="") D FP01S Q
"RTN","SROESAR2",38,0)
 I SRPF D FPX Q
"RTN","SROESAR2",39,0)
 S:SRVAL1="" SRVAL1="<NOT ENTERED>" S:SRVAL2="" SRVAL2="<DELETED>"
"RTN","SROESAR2",40,0)
 I SRVAL2=SRVAL1 D:$P(SRFLD,"-")="01" LINE(1) D LINE(1) S @SRG@(SRI)=$$SPACE(SRJ)_"The "_SRTITLE_" entry "_SRVAL1_" was changed:" Q
"RTN","SROESAR2",41,0)
 D:$P(SRFLD,"-")="01" LINE(1) D LINE(1) S @SRG@(SRI)=$$SPACE(SRJ)_"The "_SRTITLE_" field was changed" D LINE(1) S @SRG@(SRI)=$$SPACE(SRJ)_"  from "_SRVAL1 D LINE(1) S @SRG@(SRI)=$$SPACE(SRJ)_"    to "_SRVAL2
"RTN","SROESAR2",42,0)
 Q
"RTN","SROESAR2",43,0)
FP01S ; add or delete subfile entry
"RTN","SROESAR2",44,0)
 I SRVAL1="" D LINE(1) S @SRG@(SRI)=$$SPACE(SRJ)_"The following "_SRTITLE_" was ADDED:" S SRNM=2
"RTN","SROESAR2",45,0)
 I SRVAL2="" D LINE(1) S @SRG@(SRI)=$$SPACE(SRJ)_"The following "_SRTITLE_" was DELETED:" S SRNM=1
"RTN","SROESAR2",46,0)
 S SRPF=1,SRVAL=$S(SRNM=1:SRVAL1,1:SRVAL2) D LINE(1) S @SRG@(SRI)=$$SPACE(SRJ+2)_SRTITLE_": "_SRVAL
"RTN","SROESAR2",47,0)
 Q
"RTN","SROESAR2",48,0)
FP01 ; add or delete
"RTN","SROESAR2",49,0)
 I SRVAL1="" D LINE(2) S @SRG@(SRI)=$$SPACE(SRJ)_"The following "_SRTITLE_" was ADDED:" S SRNM=2
"RTN","SROESAR2",50,0)
 I SRVAL2="" D LINE(2) S @SRG@(SRI)=$$SPACE(SRJ)_"The following "_SRTITLE_" was DELETED:" S SRNM=1
"RTN","SROESAR2",51,0)
 S SRPF=1,SRVAL=$S(SRNM=1:SRVAL1,1:SRVAL2) D LINE(1) S @SRG@(SRI)=$$SPACE(SRJ+2)_SRTITLE_": "_SRVAL
"RTN","SROESAR2",52,0)
 Q
"RTN","SROESAR2",53,0)
FPX S SRJ=SRJ+2 I SRNUM[";W" D WPM
"RTN","SROESAR2",54,0)
 S SRVAL="",SRY=$G(^TMP("SRARMULT"_SRNM,$J,SRTN,SRMULT,SRE,SRE1,SRFLD)) I SRY'="" D EXT S SRVAL=SRX
"RTN","SROESAR2",55,0)
 D LINE(1) S @SRG@(SRI)=$$SPACE(SRJ)_SRTITLE_": "_SRVAL
"RTN","SROESAR2",56,0)
 Q
"RTN","SROESAR2",57,0)
FWPM ; word-processing in multiples in added or deleted entries
"RTN","SROESAR2",58,0)
 I '$O(^TMP("SRARAD1",$J,SRTN,SRMULT,SRE,SRE1,SRFLD,0)) S SRS=2
"RTN","SROESAR2",59,0)
 I '$O(^TMP("SRARAD2",$J,SRTN,SRMULT,SRE,SRE1,SRFLD,0)) S SRS=1
"RTN","SROESAR2",60,0)
 D LINE(1) S @SRG@(SRI)=$$SPACE(SRJ)_SRTITLE_":" S SRLN=0
"RTN","SROESAR2",61,0)
 F  S SRLN=$O(^TMP("SRARMULT"_SRS,$J,SRTN,SRMULT,SRE,SRE1,SRFLD,SRLN)) Q:'SRLN  S X=^TMP("SRARMULT"_SRS,$J,SRTN,SRMULT,SRE,SRE1,SRFLD,SRLN) D LINE(1) S @SRG@(SRI)=$$SPACE(SRJ)_X
"RTN","SROESAR2",62,0)
 Q
"RTN","SROESAR2",63,0)
WPM ; word-processing in multiples
"RTN","SROESAR2",64,0)
 I SRPF S SRJ=SRJ+2 D FWPM Q
"RTN","SROESAR2",65,0)
 D LINE(1) S @SRG@(SRI)=$$SPACE(SRJ)_"The "_SRTITLE_" field was changed" D LINE(1) S @SRG@(SRI)=$$SPACE(SRJ+2)_">> from original "_SRTITLE_" text:"
"RTN","SROESAR2",66,0)
 I '$O(^TMP("SRARAD1",$J,SRTN,SRMULT,SRE,SRE1,SRFLD,0)) S @SRG@(SRI)=@SRG@(SRI)_" <NO TEXT ENTERED>" D WPM2 Q
"RTN","SROESAR2",67,0)
 S SRLN=0 F  S SRLN=$O(^TMP("SRARMULT1",$J,SRTN,SRMULT,SRE,SRE1,SRFLD,SRLN)) Q:'SRLN  S X=^TMP("SRARMULT1",$J,SRTN,SRMULT,SRE,SRE1,SRFLD,SRLN) D LINE(1) S @SRG@(SRI)=$$SPACE(SRJ+2)_X
"RTN","SROESAR2",68,0)
WPM2 D LINE(1) S @SRG@(SRI)=$$SPACE(SRJ+2)_">> to updated "_SRTITLE_" text:" I '$O(^TMP("SRARAD2",$J,SRTN,SRMULT,SRE,SRE1,SRFLD,0)) S @SRG@(SRI)=@SRG@(SRI)_" <TEXT DELETED>" Q
"RTN","SROESAR2",69,0)
 S SRLN=0 F  S SRLN=$O(^TMP("SRARMULT2",$J,SRTN,SRMULT,SRE,SRE1,SRFLD,SRLN)) Q:'SRLN  S X=^TMP("SRARMULT2",$J,SRTN,SRMULT,SRE,SRE1,SRFLD,SRLN) D LINE(1) S @SRG@(SRI)=$$SPACE(SRJ+2)_X
"RTN","SROESAR2",70,0)
 Q
"RTN","SROESAR2",71,0)
SPACE(NUM) ; create spaces
"RTN","SROESAR2",72,0)
 ; pass in position, returns number of needed spaces
"RTN","SROESAR2",73,0)
 I '$D(@SRG@(SRI)) S @SRG@(SRI)=""
"RTN","SROESAR2",74,0)
 Q $J("",NUM-$L(@SRG@(SRI)))
"RTN","SROESAR2",75,0)
 Q
"RTN","SROESAR2",76,0)
LINE(NUM) ; create carriage returns
"RTN","SROESAR2",77,0)
 F J=1:1:NUM S SRI=SRI+1,@SRG@(SRI)=""
"RTN","SROESAR2",78,0)
 Q
"RTN","SROESARA")
0^47^B22261959
"RTN","SROESARA",1,0)
SROESARA ;BIR/ADM - ANESTHESIA REPORT E-SIG UTILITY ; [ 02/21/01  9:08 AM ]
"RTN","SROESARA",2,0)
 ;;3.0; Surgery ;**100**;24 Jun 93
"RTN","SROESARA",3,0)
 ;
"RTN","SROESARA",4,0)
 ;** NOTICE: This routine is part of an implementation of a nationally
"RTN","SROESARA",5,0)
 ;**         controlled procedure.  Local modifications to this routine
"RTN","SROESARA",6,0)
 ;**         are prohibited.
"RTN","SROESARA",7,0)
 ;
"RTN","SROESARA",8,0)
MULT ; process multiples
"RTN","SROESARA",9,0)
 S X=$P(SRFLD,"^",2),Y=$P(SRFLD,"^",3) I $P(X,";")=0 S:SRS=1 ^TMP("SRASAVE",$J,SRTN,$P(SRFLD,"^"),0)=$G(^SRF(SRTN,$P(Y,","),0)) Q
"RTN","SROESARA",10,0)
 S SRCAT=$P(SRFLD,"^"),SRSUB=$P(SRFLD,"^",2),SRFF=$P(SRSUB,"-",3)
"RTN","SROESARA",11,0)
 S SRNP=$P(SRFLD,"^",3),SRN=$P(SRNP,";"),SRP=$P(SRNP,";",2)
"RTN","SROESARA",12,0)
 K SRL F I=1:1 S Y=$P(SRN,",",I) Q:Y=""  S SRL(I)=Y,SRL=I
"RTN","SROESARA",13,0)
 S SRW=$S($P(SRFF,";",2)["W":1,1:0)
"RTN","SROESARA",14,0)
 S SRE=0 F  S SRE=$O(^SRF(SRTN,SRL(1),SRE)) Q:'SRE  D
"RTN","SROESARA",15,0)
 .I SRL=2 D
"RTN","SROESARA",16,0)
 ..I SRS=1 D
"RTN","SROESARA",17,0)
 ...I $P(SRFF,",",2)=.01 S ^TMP("SRASAVE",$J,SRTN,SRCAT,0)=$G(^SRF(SRTN,SRL(1),0))
"RTN","SROESARA",18,0)
 ...S ^TMP("SRASAVE",$J,SRTN,SRCAT,SRE,0,SRSUB)=$P($G(^SRF(SRTN,SRL(1),SRE,SRL(2))),"^",SRP)
"RTN","SROESARA",19,0)
 ..I $P(SRSUB,"-")'["X" S ^TMP("SRARAD"_SRS,$J,SRTN,SRCAT,SRE,0,SRSUB)=$P($G(^SRF(SRTN,SRL(1),SRE,SRL(2))),"^",SRP)
"RTN","SROESARA",20,0)
 .I SRL=3 S SRE1=0 F  S SRE1=$O(^SRF(SRTN,SRL(1),SRE,SRL(2),SRE1)) Q:'SRE1  D
"RTN","SROESARA",21,0)
 ..I SRW D  Q
"RTN","SROESARA",22,0)
 ...I SRS=1 D
"RTN","SROESARA",23,0)
 ....S ^TMP("SRASAVE",$J,SRTN,SRCAT,SRE,0,SRSUB,0)=$G(^SRF(SRTN,SRL(1),SRE,SRL(2),0))
"RTN","SROESARA",24,0)
 ....S ^TMP("SRASAVE",$J,SRTN,SRCAT,SRE,0,SRSUB,SRE1)=$P($G(^SRF(SRTN,SRL(1),SRE,SRL(2),SRE1,SRL(3))),"^",SRP)
"RTN","SROESARA",25,0)
 ...I $P(SRSUB,"-")'["X" S ^TMP("SRARAD"_SRS,$J,SRTN,SRCAT,SRE,0,SRSUB,SRE1)=$P($G(^SRF(SRTN,SRL(1),SRE,SRL(2),SRE1,SRL(3))),"^",SRP)
"RTN","SROESARA",26,0)
 ..I SRS=1 D
"RTN","SROESARA",27,0)
 ...I $P(SRFF,",",2)=.01 S ^TMP("SRASAVE",$J,SRTN,SRCAT,SRE,0,SRSUB)=$G(^SRF(SRTN,SRL(1),SRE,SRL(2),0))
"RTN","SROESARA",28,0)
 ...S ^TMP("SRASAVE",$J,SRTN,SRCAT,SRE,SRE1,SRSUB)=$P($G(^SRF(SRTN,SRL(1),SRE,SRL(2),SRE1,SRL(3))),"^",SRP)
"RTN","SROESARA",29,0)
 ..I $P(SRSUB,"-")'["X" S ^TMP("SRARAD"_SRS,$J,SRTN,SRCAT,SRE,SRE1,SRSUB)=$P($G(^SRF(SRTN,SRL(1),SRE,SRL(2),SRE1,SRL(3))),"^",SRP)
"RTN","SROESARA",30,0)
 Q
"RTN","SROESARA",31,0)
REVRS ; restore pre-edit data in multiples
"RTN","SROESARA",32,0)
 D REMOVE
"RTN","SROESARA",33,0)
 S SRCAT="" F  S SRCAT=$O(^TMP("SRARMULT1",$J,SRTN,SRCAT)) Q:SRCAT=""  D RESTORE
"RTN","SROESARA",34,0)
 Q
"RTN","SROESARA",35,0)
RESTORE ; enter multiple data saved in ^TMP("SRASAVE"
"RTN","SROESARA",36,0)
 S (SRCNT,SRE)=0 F  S SRE=$O(^TMP("SRASAVE",$J,SRTN,SRCAT,SRE)) Q:'SRE  S SRE1="" F  S SRE1=$O(^TMP("SRASAVE",$J,SRTN,SRCAT,SRE,SRE1)) Q:SRE1=""  D
"RTN","SROESARA",37,0)
 .S SRSUB="" F  S SRSUB=$O(^TMP("SRASAVE",$J,SRTN,SRCAT,SRE,SRE1,SRSUB)) Q:SRSUB=""  S SRCNT=SRCNT+1 D FIELD
"RTN","SROESARA",38,0)
 Q
"RTN","SROESARA",39,0)
FIELD ; restore individual field
"RTN","SROESARA",40,0)
 S X=$P(SRSUB,"-",3),SRFILE=$P(X,","),Y=$P(X,",",2),SRFIELD=$P(Y,";"),SRW=$S($P(Y,";",2)["W":1,1:0)
"RTN","SROESARA",41,0)
 S:SRCNT=1 SRI="."_$P(SRFILE,".",2) S X=$E($P(SRSUB,"-"),1,2),SRJ=+X D REV^SROESAR1
"RTN","SROESARA",42,0)
 S SRNP=$P(SRFLD,"^",3),SRN=$P(SRNP,";"),SRP=$P(SRNP,";",2)
"RTN","SROESARA",43,0)
 K SRL F I=1:1 S Y=$P(SRN,",",I) Q:Y=""  S SRL(I)=Y,SRL=I
"RTN","SROESARA",44,0)
 I 'SRW S SRVAL=^TMP("SRASAVE",$J,SRTN,SRCAT,SRE,SRE1,SRSUB)
"RTN","SROESARA",45,0)
 K DA,DIE,DR
"RTN","SROESARA",46,0)
 I SRL=2,SRVAL'="" D
"RTN","SROESARA",47,0)
 .I SRL(1)=13,SRL(2)=2 S ^SRF(SRTN,13,SRE,2)=SRVAL K DA,DIK S DA(1)=SRTN,DA=SRE,DIK="^SRF("_SRTN_",13,",DIK(1)="3" D EN^DIK K DA,DIK Q
"RTN","SROESARA",48,0)
 .I SRE1=0,SRFIELD=.01 S ^SRF(SRTN,SRL(1),0)=^TMP("SRASAVE",$J,SRTN,SRCAT,0)
"RTN","SROESARA",49,0)
 .S DA(1)=SRTN,DA=SRE,DIE="^SRF("_SRTN_","_$S(SRL(1):SRL(1),1:""""_SRL(1)_"""")_",",DR=SRFIELD_"////"_SRVAL D ^DIE K DA,DIE,DR
"RTN","SROESARA",50,0)
 I SRL=3 D
"RTN","SROESARA",51,0)
 .I SRE1=0,SRFIELD=.01,SRVAL'="" S ^SRF(SRTN,SRL(1),SRE,SRL(2),0)=SRVAL Q
"RTN","SROESARA",52,0)
 .I SRW D  Q
"RTN","SROESARA",53,0)
 ..S ^SRF(SRTN,SRL(1),SRE,SRL(2),0)=$G(^TMP("SRASAVE",$J,SRTN,SRCAT,SRE,SRE1,SRSUB,0))
"RTN","SROESARA",54,0)
 ..S SRLN=0 F  S SRLN=$O(^TMP("SRASAVE",$J,SRTN,SRCAT,SRE,SRE1,SRSUB,SRLN)) Q:'SRLN  S ^SRF(SRTN,SRL(1),SRE,SRL(2),SRLN,0)=$G(^TMP("SRASAVE",$J,SRTN,SRCAT,SRE,SRE1,SRSUB,SRLN))
"RTN","SROESARA",55,0)
 .I SRVAL'="" S DA(2)=SRTN,DA(1)=SRE,DA=SRE1,DIE="^SRF("_SRTN_","_$S(SRL(1):SRL(1),1:""""_SRL(1)_"""")_","_SRE_","_$S(SRL(2):SRL(2),1:""""_SRL(2)_"""")_",",DR=SRFIELD_"////"_SRVAL D ^DIE K DA,DIE,DR
"RTN","SROESARA",56,0)
 Q
"RTN","SROESARA",57,0)
REMOVE ; delete edited multiples
"RTN","SROESARA",58,0)
 S SRCAT="" F  S SRCAT=$O(^TMP("SRARMULT1",$J,SRTN,SRCAT)) Q:SRCAT=""  S SRE=$O(^TMP("SRARMULT1",$J,SRTN,SRCAT,0)) Q:'SRE  S SRE1="",SRE1=$O(^TMP("SRARMULT1",$J,SRTN,SRCAT,SRE,SRE1)) Q:SRE1=""  D
"RTN","SROESARA",59,0)
 .S SRSUB="",SRSUB=$O(^TMP("SRARMULT1",$J,SRTN,SRCAT,SRE,SRE1,SRSUB))
"RTN","SROESARA",60,0)
 .S SRFF=$P(SRSUB,"-",3),SRK=$P(SRFF,","),SRI="."_$P(SRK,".",2),SRJ=1 D REV^SROESAR1
"RTN","SROESARA",61,0)
 .S SRNP=$P(SRFLD,"^",3),SRN=$P(SRNP,";"),SRP=$P(SRNP,";",2)
"RTN","SROESARA",62,0)
 .K SRL F I=1:1 S Y=$P(SRN,",",I) Q:Y=""  S SRL(I)=Y,SRL=I
"RTN","SROESARA",63,0)
 .D DEL
"RTN","SROESARA",64,0)
 Q
"RTN","SROESARA",65,0)
DEL ; delete all entries from multiple
"RTN","SROESARA",66,0)
 K DA,DIK S SRIEN=0 F  S SRIEN=$O(^SRF(SRTN,SRL(1),SRIEN)) Q:'SRIEN  S DA(1)=SRTN,DA=SRIEN,DIK="^SRF("_DA(1)_","_$S(SRL(1):SRL(1),1:""""_SRL(1)_"""")_"," D ^DIK K DA,DIK
"RTN","SROESARA",67,0)
 K ^SRF(SRTN,SRL(1))
"RTN","SROESARA",68,0)
 Q
"RTN","SROESHL")
0^48^B7580303
"RTN","SROESHL",1,0)
SROESHL ;BIR/ADM - E-SIG HL7 UTILITY ; [ 02/06/01  9:28 AM ]
"RTN","SROESHL",2,0)
 ;;3.0; Surgery ;**100**;24 Jun 93
"RTN","SROESHL",3,0)
 ;
"RTN","SROESHL",4,0)
 ;** NOTICE: This routine is part of an implementation of a nationally
"RTN","SROESHL",5,0)
 ;**         controlled procedure.  Local modifications to this routine
"RTN","SROESHL",6,0)
 ;**         are prohibited.
"RTN","SROESHL",7,0)
 ;
"RTN","SROESHL",8,0)
 N SRESARF,SRESNRF S SRESQ=0 I $G(SRESAR) D  Q:SRESQ
"RTN","SROESHL",9,0)
 .S SRESARF="58,57,21,111,61,15,14,60,54,29,20,69,22,75,68,92,63,62,52,51,53,47,50,45,42,115,96,18,55,19,40,39,49,43,44,23,65,64"
"RTN","SROESHL",10,0)
 .I SRESARF[IEN D XTMP S SRESQ=1
"RTN","SROESHL",11,0)
 I $G(SRESNR) D
"RTN","SROESHL",12,0)
 .S SRESNRF="58,57,54,20,114,22,31,52,51,53,47,50,115,18,55,40,39,34,113,13,49,7,8,10,12,17,33,36,23,35,37"
"RTN","SROESHL",13,0)
 .I SRESNRF[IEN D XTMP S SRESQ=1
"RTN","SROESHL",14,0)
 Q
"RTN","SROESHL",15,0)
XTMP ; store info for alert in ^XTMP
"RTN","SROESHL",16,0)
 S SRESCNT=SRESCNT+1 I SRESCNT=1 S XQAID="SRESHL_"_CASE,XQAKILL=0 D DELETEA^XQALERT K ^XTMP("SRESHL_"_CASE)
"RTN","SROESHL",17,0)
 I '$D(^XTMP("SRESHL_"_CASE,0)) D
"RTN","SROESHL",18,0)
 .N X,X1,X2 S X1=DT,X2=14 D C^%DTC S ^XTMP("SRESHL_"_CASE,0)=X_"^"_DT_"^Surgery HL7 Transmission Alert"
"RTN","SROESHL",19,0)
 .S ^XTMP("SRESHL_"_CASE,1,1)="The following data elements are contained on an electronically signed report"
"RTN","SROESHL",20,0)
 .S ^XTMP("SRESHL_"_CASE,1,2)="and cannot be uploaded to the surgical record in VistA.  These data elements"
"RTN","SROESHL",21,0)
 .S ^XTMP("SRESHL_"_CASE,1,3)="must be entered manually and will require that an addendum be made to the"
"RTN","SROESHL",22,0)
 .S ^XTMP("SRESHL_"_CASE,1,4)="signed report.",^XTMP("SRESHL_"_CASE,1,5)=""
"RTN","SROESHL",23,0)
 .N DFN S DFN=$P(^SRF(CASE,0),"^") D DEM^VADPT
"RTN","SROESHL",24,0)
 .S ^XTMP("SRESHL_"_CASE,1,6)="Patient: "_VADM(1)_" ("_VA("PID")_") - Case #"_CASE,^XTMP("SRESHL_"_CASE,1,7)=""
"RTN","SROESHL",25,0)
 S SRESFLD=$P(^SRO(133.2,IEN,0),"^"),SRESVAL=$$VALUE^SRHLUI(IEN)
"RTN","SROESHL",26,0)
 S ^XTMP("SRESHL_"_CASE,2,IEN)=" "_SRESFLD_" : "_SRESVAL
"RTN","SROESHL",27,0)
ALERT ; send alert to prin. anesthetist and anes. supervisor
"RTN","SROESHL",28,0)
 Q:'$O(^XTMP("SRESHL_"_CASE,0))  N X,Y,Z
"RTN","SROESHL",29,0)
 S XQAID="SRESHL_"_CASE,XQAKILL=0 D DELETEA^XQALERT
"RTN","SROESHL",30,0)
 S Z=$G(^SRF(CASE,.3)),X=$P(Z,"^"),Y=$P(Z,"^",4) Q:X=""&(Y="")
"RTN","SROESHL",31,0)
 S:X XQA(X)="" S:Y XQA(Y)="" S XQAMSG="Cannot upload Surgery data on signed report."
"RTN","SROESHL",32,0)
 S XQAROU="ACTION^SROESHL",XQAID="SRESHL_"_CASE D SETUP^XQALERT
"RTN","SROESHL",33,0)
 Q
"RTN","SROESHL",34,0)
ACTION ; alert action
"RTN","SROESHL",35,0)
 N SRID S SRID=$P(XQAID,";") Q:'$O(^XTMP(SRID,0))
"RTN","SROESHL",36,0)
 W @IOF
"RTN","SROESHL",37,0)
 D EN^DDIOL("","^XTMP(SRID,1)")
"RTN","SROESHL",38,0)
 D EN^DDIOL("","^XTMP(SRID,2)")
"RTN","SROESHL",39,0)
 Q
"RTN","SROESL")
0^127^B2207605
"RTN","SROESL",1,0)
SROESL ;BIR/SJA - SURGERY E-SIG UTILITY ; [ 06/13/02  01:30 PM ]
"RTN","SROESL",2,0)
 ;;3.0; Surgery ;**100**;24 Jun 93
"RTN","SROESL",3,0)
 ;
"RTN","SROESL",4,0)
 ; Reference to EXTRACT^TIULQ supported by DBIA #2693
"RTN","SROESL",5,0)
 ;
"RTN","SROESL",6,0)
CASLIST(SDFN,SIDN) ;
"RTN","SROESL",7,0)
 N II,SDT,SRTN,STIU,STIUP,SRY K ^TMP("SROLST",$J)
"RTN","SROESL",8,0)
 ; SIDN: 1-OPERATION REPORT,
"RTN","SROESL",9,0)
 ;       2-NURSE INTRAOPERATIVE REPORT,
"RTN","SROESL",10,0)
 ;       3-PROCEDURE REPORT (NON-O.R.).
"RTN","SROESL",11,0)
 ;       4-ANESTHESIA REPORT, and
"RTN","SROESL",12,0)
 ;       5-The above item 1,2, and 4
"RTN","SROESL",13,0)
 ;
"RTN","SROESL",14,0)
 I SIDN<1!(SIDN>5) Q
"RTN","SROESL",15,0)
 I SIDN=5 S SIDN="1,2,4"
"RTN","SROESL",16,0)
 S SDT=0 F  S SDT=$O(^SRF("ADT",SDFN,SDT)) Q:'SDT  S SRTN=0 F  S SRTN=$O(^SRF("ADT",SDFN,SDT,SRTN)) Q:'SRTN  S STIU=$G(^SRF(SRTN,"TIU")) F II=1:1:$L(SIDN,",") S STIUP=$P(STIU,"^",$P(SIDN,",",II)) I STIUP>0 D
"RTN","SROESL",17,0)
 .D EXTRACT^TIULQ(STIUP,"SRY",.SRERR,".05") I +$G(SRY(STIUP,.05,"I"))<6 Q
"RTN","SROESL",18,0)
 .S ^TMP("SROLST",$J,SRTN,$P(SIDN,",",II))=SRY(STIUP,.05,"E")_"^"_STIUP
"RTN","SROESL",19,0)
 .K SRY
"RTN","SROESL",20,0)
 Q
"RTN","SROESNR")
0^49^B31682934
"RTN","SROESNR",1,0)
SROESNR ;BIR/ADM - NURSE INTRAOP REPORT E-SIG UTILITY ; [ 02/20/02  6:57 AM ]
"RTN","SROESNR",2,0)
 ;;3.0; Surgery ;**100**;24 Jun 93
"RTN","SROESNR",3,0)
 ;
"RTN","SROESNR",4,0)
 ;** NOTICE: This routine is part of an implementation of a nationally
"RTN","SROESNR",5,0)
 ;**         controlled procedure.  Local modifications to this routine
"RTN","SROESNR",6,0)
 ;**         are prohibited.
"RTN","SROESNR",7,0)
 ;
"RTN","SROESNR",8,0)
 Q
"RTN","SROESNR",9,0)
IN N SRS S SRS=1 D GET
"RTN","SROESNR",10,0)
 Q
"RTN","SROESNR",11,0)
EX N SRS S SRS=2 D GET,COMP
"RTN","SROESNR",12,0)
 I $D(^TMP("SRNRAD1",$J,SRTN))!$D(^TMP("SRNRAD2",$J,SRTN)) D ^SROESNR2
"RTN","SROESNR",13,0)
 Q
"RTN","SROESNR",14,0)
GET K ^TMP("SRNRAD"_SRS,$J,SRTN) D VIEW^SROESNR0,MULT
"RTN","SROESNR",15,0)
 Q
"RTN","SROESNR",16,0)
MULT ; get data from multiples
"RTN","SROESNR",17,0)
 N SRK
"RTN","SROESNR",18,0)
 F SRK=130.23,130.28,130.36,130.24,130.065,130.31,130.028,130.16,130.02,130.32,130.01,130.33,130.08,130.04,130.0129,130.013,130.18 D MULT^SROESNR1
"RTN","SROESNR",19,0)
 S SRK=130.06 D MULT^SROESNR3
"RTN","SROESNR",20,0)
 Q
"RTN","SROESNR",21,0)
COMP ; compare before and after view
"RTN","SROESNR",22,0)
 N SRFLD,SRCHNG,SRE,SRE1,SRE2,SRS,SRS1,SROTH,SRLN,SRMULT,X
"RTN","SROESNR",23,0)
 S SRFLD="" F  S SRFLD=$O(^TMP("SRNRAD1",$J,SRTN,130,SRFLD)) Q:SRFLD=""  S SRCHNG=0 D
"RTN","SROESNR",24,0)
 .I $P(SRFLD,"-",2)[";W" D  Q
"RTN","SROESNR",25,0)
 ..F SRS=1,2 Q:SRCHNG  S SRLN=0,SROTH=$S(SRS=1:2,1:1) F  S SRLN=$O(^TMP("SRNRAD"_SRS,$J,SRTN,130,SRFLD,SRLN)) Q:'SRLN  D  Q:SRCHNG
"RTN","SROESNR",26,0)
 ...I ^TMP("SRNRAD"_SRS,$J,SRTN,130,SRFLD,SRLN)'=$G(^TMP("SRNRAD"_SROTH,$J,SRTN,130,SRFLD,SRLN)) S SRCHNG=1
"RTN","SROESNR",27,0)
 ..I 'SRCHNG F SRS=1,2 K ^TMP("SRNRAD"_SRS,$J,SRTN,130,SRFLD)
"RTN","SROESNR",28,0)
 .I ^TMP("SRNRAD1",$J,SRTN,130,SRFLD)'=$G(^TMP("SRNRAD2",$J,SRTN,130,SRFLD)) S SRCHNG=1
"RTN","SROESNR",29,0)
 .I 'SRCHNG F SRS=1,2 K ^TMP("SRNRAD"_SRS,$J,SRTN,130,SRFLD)
"RTN","SROESNR",30,0)
CMULT ; process multiples
"RTN","SROESNR",31,0)
 F SRS=1,2 K ^TMP("SRNRMULT"_SRS,$J,SRTN)
"RTN","SROESNR",32,0)
 F SRS=1,2 S SRMULT="A" F  S SRMULT=$O(^TMP("SRNRAD"_SRS,$J,SRTN,SRMULT)) Q:SRMULT=""  S SROTH=$S(SRS=1:2,1:1) D PASS1
"RTN","SROESNR",33,0)
 F SRS=1,2 S SRMULT="A" F  S SRMULT=$O(^TMP("SRNRAD"_SRS,$J,SRTN,SRMULT)) Q:SRMULT=""  S SROTH=$S(SRS=1:2,1:1) D PASS2
"RTN","SROESNR",34,0)
 F SRS=1,2 S SRMULT="A" F  S SRMULT=$O(^TMP("SRNRAD"_SRS,$J,SRTN,SRMULT)) Q:SRMULT=""  S SROTH=$S(SRS=1:2,1:1) D PASS3
"RTN","SROESNR",35,0)
 F SRS=1,2 S SRMULT="A" F  S SRMULT=$O(^TMP("SRNRAD"_SRS,$J,SRTN,SRMULT)) Q:SRMULT=""  S SROTH=$S(SRS=1:2,1:1) D PASS4
"RTN","SROESNR",36,0)
 Q
"RTN","SROESNR",37,0)
PASS1 ; delete nodes for unchanged fields except for .01 fields
"RTN","SROESNR",38,0)
 S SRE=0 F  S SRE=$O(^TMP("SRNRAD"_SRS,$J,SRTN,SRMULT,SRE)) Q:'SRE  S SRE1="" F  S SRE1=$O(^TMP("SRNRAD"_SRS,$J,SRTN,SRMULT,SRE,SRE1)) Q:SRE1=""  D
"RTN","SROESNR",39,0)
 .S SRFLD="" F  S SRFLD=$O(^TMP("SRNRAD"_SRS,$J,SRTN,SRMULT,SRE,SRE1,SRFLD)) Q:SRFLD=""  S SRCHNG=0 D
"RTN","SROESNR",40,0)
 ..S Y=$P(SRFLD,"-",3) I $P(Y,",",2)=.01 Q
"RTN","SROESNR",41,0)
 ..I $P(SRFLD,"-",3)[";W" D  Q
"RTN","SROESNR",42,0)
 ...F SRS1=1,2 Q:SRCHNG  S SRLN=0,SROTH=$S(SRS1=1:2,1:1) F  S SRLN=$O(^TMP("SRNRAD"_SRS1,$J,SRTN,SRMULT,SRE,SRE1,SRFLD,SRLN)) Q:'SRLN  D
"RTN","SROESNR",43,0)
 ....I ^TMP("SRNRAD"_SRS1,$J,SRTN,SRMULT,SRE,SRE1,SRFLD,SRLN)'=$G(^TMP("SRNRAD"_SROTH,$J,SRTN,SRMULT,SRE,SRE1,SRFLD,SRLN)) S SRCHNG=1
"RTN","SROESNR",44,0)
 ...I 'SRCHNG F SRS1=1,2 K ^TMP("SRNRAD"_SRS1,$J,SRTN,SRMULT,SRE,SRE1,SRFLD)
"RTN","SROESNR",45,0)
 ..S SROTH=$S(SRS=1:2,1:1) I ^TMP("SRNRAD"_SRS,$J,SRTN,SRMULT,SRE,SRE1,SRFLD)'=$G(^TMP("SRNRAD"_SROTH,$J,SRTN,SRMULT,SRE,SRE1,SRFLD)) S SRCHNG=1
"RTN","SROESNR",46,0)
 ..I 'SRCHNG F SRS1=1,2 K ^TMP("SRNRAD"_SRS1,$J,SRTN,SRMULT,SRE,SRE1,SRFLD)
"RTN","SROESNR",47,0)
 Q
"RTN","SROESNR",48,0)
PASS2 ; delete .01 nodes of sub-multiples if no changes underneath - before or after
"RTN","SROESNR",49,0)
 N SRNXT1,SRNXT2,SRY1,SRY2
"RTN","SROESNR",50,0)
 S SRE=0 F  S SRE=$O(^TMP("SRNRAD"_SRS,$J,SRTN,SRMULT,SRE)) Q:'SRE  S SRE1=0 F  S SRE1=$O(^TMP("SRNRAD"_SRS,$J,SRTN,SRMULT,SRE,SRE1)) Q:SRE1=""  D
"RTN","SROESNR",51,0)
 .S SRFLD="" F  S SRFLD=$O(^TMP("SRNRAD"_SRS,$J,SRTN,SRMULT,SRE,SRE1,SRFLD)) Q:SRFLD=""  D
"RTN","SROESNR",52,0)
 ..I ^TMP("SRNRAD"_SRS,$J,SRTN,SRMULT,SRE,SRE1,SRFLD)'=$G(^TMP("SRNRAD"_SROTH,$J,SRTN,SRMULT,SRE,SRE1,SRFLD)) Q
"RTN","SROESNR",53,0)
 ..S SRNXT1=$O(^TMP("SRNRAD"_SRS,$J,SRTN,SRMULT,SRE,SRE1,SRFLD))
"RTN","SROESNR",54,0)
 ..S SRNXT2=$O(^TMP("SRNRAD"_SROTH,$J,SRTN,SRMULT,SRE,SRE1,SRFLD))
"RTN","SROESNR",55,0)
 ..I SRNXT1="",SRNXT2="" K ^TMP("SRNRAD"_SRS,$J,SRTN,SRMULT,SRE,SRE1,SRFLD),^TMP("SRNRAD"_SROTH,$J,SRTN,SRMULT,SRE,SRE1,SRFLD) Q
"RTN","SROESNR",56,0)
 ..S SRY1=$P(SRNXT1,"-",3),SRY2=$P(SRNXT2,"-",3) I $P(SRY1,",",2)=.01,$P(SRY2,",",2)=.01 K ^TMP("SRNRAD"_SRS,$J,SRTN,SRMULT,SRE,SRE1,SRFLD),^TMP("SRNRAD"_SROTH,$J,SRTN,SRMULT,SRE,SRE1,SRFLD)
"RTN","SROESNR",57,0)
 Q
"RTN","SROESNR",58,0)
PASS3 ; delete .01 nodes for top level multiples if no changes underneath
"RTN","SROESNR",59,0)
 S SRE=0 F  S SRE=$O(^TMP("SRNRAD"_SRS,$J,SRTN,SRMULT,SRE)) Q:'SRE  S SRFLD="" F  S SRFLD=$O(^TMP("SRNRAD"_SRS,$J,SRTN,SRMULT,SRE,0,SRFLD)) Q:SRFLD=""  D
"RTN","SROESNR",60,0)
 .S Y=$P(SRFLD,"-",3) I $P(Y,",",2)'=.01 Q
"RTN","SROESNR",61,0)
 .I ^TMP("SRNRAD"_SRS,$J,SRTN,SRMULT,SRE,0,SRFLD)'=$G(^TMP("SRNRAD"_SROTH,$J,SRTN,SRMULT,SRE,0,SRFLD)) Q
"RTN","SROESNR",62,0)
 .I $O(^TMP("SRNRAD"_SRS,$J,SRTN,SRMULT,SRE,0,SRFLD))="",$O(^TMP("SRNRAD"_SROTH,$J,SRTN,SRMULT,SRE,0,SRFLD))="" D
"RTN","SROESNR",63,0)
 ..I $O(^TMP("SRNRAD"_SRS,$J,SRTN,SRMULT,SRE,0))'="",$O(^TMP("SRNRAD"_SROTH,$J,SRTN,SRMULT,SRE,0))'="" Q
"RTN","SROESNR",64,0)
 ..K ^TMP("SRNRAD"_SRS,$J,SRTN,SRMULT,SRE,0,SRFLD),^TMP("SRNRAD"_SROTH,$J,SRTN,SRMULT,SRE,0,SRFLD)
"RTN","SROESNR",65,0)
 Q
"RTN","SROESNR",66,0)
PASS4 ; set up list of changed fields for display in addendum
"RTN","SROESNR",67,0)
 S SRE="" F  S SRE=$O(^TMP("SRNRAD"_SRS,$J,SRTN,SRMULT,SRE)) Q:'SRE  S SRE1="" F  S SRE1=$O(^TMP("SRNRAD"_SRS,$J,SRTN,SRMULT,SRE,SRE1)) Q:SRE1=""  S SRFLD="" F  S SRFLD=$O(^TMP("SRNRAD"_SRS,$J,SRTN,SRMULT,SRE,SRE1,SRFLD)) Q:SRFLD=""  D
"RTN","SROESNR",68,0)
 .I $P(SRFLD,"-",3)[";W" D  Q
"RTN","SROESNR",69,0)
 ..S SRLN=0 F  S SRLN=$O(^TMP("SRNRAD"_SRS,$J,SRTN,SRMULT,SRE,SRE1,SRFLD,SRLN)) Q:'SRLN  D
"RTN","SROESNR",70,0)
 ...S ^TMP("SRNRMULT"_SRS,$J,SRTN,SRMULT,SRE,SRE1,SRFLD,SRLN)=$G(^TMP("SRNRAD"_SRS,$J,SRTN,SRMULT,SRE,SRE1,SRFLD,SRLN))
"RTN","SROESNR",71,0)
 ...S ^TMP("SRNRMULT"_SROTH,$J,SRTN,SRMULT,SRE,SRE1,SRFLD,SRLN)=$G(^TMP("SRNRAD"_SROTH,$J,SRTN,SRMULT,SRE,SRE1,SRFLD,SRLN))
"RTN","SROESNR",72,0)
 .S ^TMP("SRNRMULT"_SRS,$J,SRTN,SRMULT,SRE,SRE1,SRFLD)=$G(^TMP("SRNRAD"_SRS,$J,SRTN,SRMULT,SRE,SRE1,SRFLD))
"RTN","SROESNR",73,0)
 .S ^TMP("SRNRMULT"_SROTH,$J,SRTN,SRMULT,SRE,SRE1,SRFLD)=$G(^TMP("SRNRAD"_SROTH,$J,SRTN,SRMULT,SRE,SRE1,SRFLD))
"RTN","SROESNR",74,0)
 Q
"RTN","SROESNR0")
0^50^B28553187
"RTN","SROESNR0",1,0)
SROESNR0 ;BIR/ADM - NURSE REPORT E-SIG UTILITY ; [ 02/27/04  7:45 AM ]
"RTN","SROESNR0",2,0)
 ;;3.0; Surgery ;**100**;24 Jun 93
"RTN","SROESNR0",3,0)
 ;
"RTN","SROESNR0",4,0)
 ;** NOTICE: This routine is part of an implementation of a nationally
"RTN","SROESNR0",5,0)
 ;**         controlled procedure.  Local modifications to this routine
"RTN","SROESNR0",6,0)
 ;**         are prohibited.
"RTN","SROESNR0",7,0)
 ;
"RTN","SROESNR0",8,0)
 ; Reference to ^TMP("CSLSUR1" supported by DBIA #3498
"RTN","SROESNR0",9,0)
 ;
"RTN","SROESNR0",10,0)
VIEW N SRJ,SRCAT,SRFIELD,SRFLD,SRFILE,SRLN,SRNP,SRN,SRP,SRSUB,SRW,X,Y
"RTN","SROESNR0",11,0)
 F SRJ=1:1 S SRFLD=$P($T(FIELD+SRJ),";;",2) Q:SRFLD=""  D
"RTN","SROESNR0",12,0)
 .S SRNP=$P(SRFLD,"^",3),SRN=$P(SRNP,";"),SRP=$P(SRNP,";",2)
"RTN","SROESNR0",13,0)
 .S (SRSUB,X)=$P(SRFLD,"^",2),Y=$P(X,"-",2),SRFILE=$P(Y,","),SRFIELD=$P(Y,",",2)
"RTN","SROESNR0",14,0)
 .I SRFIELD=27 Q:'$P($G(^SRF(SRTN,"TIU")),"^",6)
"RTN","SROESNR0",15,0)
 .I SRFIELD=66 Q:'$P($G(^SRF(SRTN,"TIU")),"^",7)
"RTN","SROESNR0",16,0)
 .S SRCAT=$P(SRFLD,"^") S SRCAT=$S(SRCAT="":SRFILE,1:SRCAT)
"RTN","SROESNR0",17,0)
 .S SRW=$S($P(Y,";",2)["W":1,1:0) I SRW D  Q
"RTN","SROESNR0",18,0)
 ..S ^TMP("SRNRAD"_SRS,$J,SRTN,SRCAT,SRSUB,0)=$G(^SRF(SRTN,SRN,0))
"RTN","SROESNR0",19,0)
 ..I SRS=1 S ^TMP("SRNSAVE",$J,SRTN,SRCAT,SRSUB,0)=$G(^SRF(SRTN,SRN,0))
"RTN","SROESNR0",20,0)
 ..S SRLN=0 F  S SRLN=$O(^SRF(SRTN,SRN,SRLN)) Q:'SRLN  S ^TMP("SRNRAD"_SRS,$J,SRTN,SRCAT,SRSUB,SRLN)=$G(^SRF(SRTN,SRN,SRLN,0)) I SRS=1 S ^TMP("SRNSAVE",$J,SRTN,SRCAT,SRSUB,SRLN)=$G(^SRF(SRTN,SRN,SRLN,0))
"RTN","SROESNR0",21,0)
 .S ^TMP("SRNRAD"_SRS,$J,SRTN,SRCAT,SRSUB)=$P($G(^SRF(SRTN,SRN)),"^",SRP)
"RTN","SROESNR0",22,0)
 .I SRS=1 S ^TMP("SRNSAVE",$J,SRTN,SRCAT,SRSUB)=$P($G(^SRF(SRTN,SRN)),"^",SRP)
"RTN","SROESNR0",23,0)
 Q
"RTN","SROESNR0",24,0)
REVRS ; restore before-edit data
"RTN","SROESNR0",25,0)
 N I,SRCAT,SRCNT,SRE,SRE1,SRFF,SRFIELD,SRFILE,SRFLD,SRI,SRIEN,SRJ,SRK,SRL,SRLN,SRN,SRNP,SRP,SRSUB,SRVAL,SRW,X,Y
"RTN","SROESNR0",26,0)
 F SRJ=1:1 S SRFLD=$P($T(FIELD+SRJ),";;",2) Q:SRFLD=""  D
"RTN","SROESNR0",27,0)
 .S SRNP=$P(SRFLD,"^",3),SRN=$P(SRNP,";"),SRP=$P(SRNP,";",2)
"RTN","SROESNR0",28,0)
 .S (SRSUB,X)=$P(SRFLD,"^",2),Y=$P(X,"-",2),SRFILE=$P(Y,","),SRFIELD=$P(Y,",",2)
"RTN","SROESNR0",29,0)
 .S SRCAT=$P(SRFLD,"^") S SRCAT=$S(SRCAT="":SRFILE,1:SRCAT)
"RTN","SROESNR0",30,0)
 .Q:'$D(^TMP("SRNRAD1",$J,SRTN,130,SRSUB))
"RTN","SROESNR0",31,0)
 .S SRW=$S($P(Y,";",2)["W":1,1:0) I SRW D  Q
"RTN","SROESNR0",32,0)
 ..K ^SRF(SRTN,SRN) S ^SRF(SRTN,SRN,0)=$G(^TMP("SRNSAVE",$J,SRTN,130,SRSUB,0))
"RTN","SROESNR0",33,0)
 ..S SRLN=0 F  S SRLN=$O(^TMP("SRNSAVE",$J,SRTN,130,SRSUB,SRLN)) Q:'SRLN  S ^SRF(SRTN,SRN,SRLN,0)=$G(^TMP("SRNSAVE",$J,SRTN,130,SRSUB,SRLN))
"RTN","SROESNR0",34,0)
 .S SRVAL=$G(^TMP("SRNSAVE",$J,SRTN,130,SRSUB)) I SRFIELD=27 D  Q
"RTN","SROESNR0",35,0)
 ..S $P(^SRF(SRTN,"OP"),"^",2)=SRVAL K DA,DIK S DA=SRTN,DIK="^SRF(",DIK(1)="27" D EN^DIK K DA,DIK
"RTN","SROESNR0",36,0)
 ..;Set ^TMP("CSLSUR1",$J) in order to send an update trans. via Surgery/CoreFLS interface
"RTN","SROESNR0",37,0)
 ..S ^TMP("CSLSUR1",$J)=""
"RTN","SROESNR0",38,0)
 .I SRVAL="" S SRVAL="@"
"RTN","SROESNR0",39,0)
 .K DA,DIE,DR S DA=SRTN,DIE=130,DR=SRFIELD_"////^S X=SRVAL" D ^DIE K DA,DIE,DR
"RTN","SROESNR0",40,0)
 D REVRS^SROESNRA
"RTN","SROESNR0",41,0)
 Q
"RTN","SROESNR0",42,0)
TR S SRP=SRI,SRP=$TR(SRP,"1234567890.,","ABCDEFGHIJPK")
"RTN","SROESNR0",43,0)
 Q
"RTN","SROESNR0",44,0)
FIELD ; list of fields (^field name on report-file,field^node;piece)
"RTN","SROESNR0",45,0)
KPJB ;;^Operating Room-130,.02^0;2
"RTN","SROESNR0",46,0)
KPJCE ;;^Surgical Priority-130,.035^0;10
"RTN","SROESNR0",47,0)
KPBJC ;;^Time Patient Arrived in Holding Area-130,.203^.2;15
"RTN","SROESNR0",48,0)
KPBJE ;;^Time Patient In the O.R.-130,.205^.2;10
"RTN","SROESNR0",49,0)
KPBB ;;^Time the Operation Began-130,.22^.2;2
"RTN","SROESNR0",50,0)
KPBC ;;^Time the Operation Ends-130,.23^.2;3
"RTN","SROESNR0",51,0)
KPBJF ;;^Surgeon Present Time-130,.206^.2;9
"RTN","SROESNR0",52,0)
KPBCB ;;^Time Patient Out of the O.R.-130,.232^.2;12
"RTN","SROESNR0",53,0)
KPAD ;;^Surgeon-130,.14^.1;4
"RTN","SROESNR0",54,0)
KPAE ;;^First Assistant-130,.15^.1;5
"RTN","SROESNR0",55,0)
KPAFD ;;^Attending Surgeon-130,.164^.1;13
"RTN","SROESNR0",56,0)
KPAF ;;^Second Assistant-130,.16^.1;6
"RTN","SROESNR0",57,0)
KPCA ;;^Principal Anesthetist-130,.31^.3;1
"RTN","SROESNR0",58,0)
KPCC ;;^Assistant Anesthetist-130,.33^.3;3
"RTN","SROESNR0",59,0)
KPAI ;;^Preoperative Mood-130,.19^.1;9
"RTN","SROESNR0",60,0)
KPAIF ;;^Preoperative Consciousness-130,.196^.1;15
"RTN","SROESNR0",61,0)
KPJG ;;^Preoperative Skin Integrity-130,.07^0;7
"RTN","SROESNR0",62,0)
KPAIE ;;^Preoperative Conversation-130,.195^.1;14
"RTN","SROESNR0",63,0)
KPFI ;;^Person Confirming ID Band and Valid Consent-130,.69^.6;9
"RTN","SROESNR0",64,0)
KGA ;;^Time Out Verification Completed (Y/N)-130,71^VER;3
"RTN","SROESNR0",65,0)
KGB ;;^Preoperative Imaging Confirmed-130,72^VER;4
"RTN","SROESNR0",66,0)
KGC ;;^Mark on Surgical Site Confirmed-130,73^VER;5
"RTN","SROESNR0",67,0)
KGD ;;^Correct Surgery Comments-130,74;W^74;0
"RTN","SROESNR0",68,0)
KPAH ;;^Skin Prepped By-130,.18^.1;8
"RTN","SROESNR0",69,0)
KPAGE ;;^Skin Preparation Agent-130,.175^.1;7
"RTN","SROESNR0",70,0)
KD ;;^Skin Prepped By (2)-130,4^.1;12
"RTN","SROESNR0",71,0)
KH ;;^Second Skin Preparation Agent-130,8^31;2
"RTN","SROESNR0",72,0)
KPAB ;;^Preoperative Shave By-130,.12^.1;2
"RTN","SROESNR0",73,0)
KPGE ;;^Electrocautery Unit-130,.75^.7;5
"RTN","SROESNR0",74,0)
KPEE ;;^Electroground Placement-130,.55^.5;4
"RTN","SROESNR0",75,0)
KF ;;^Electroground Position (2)-130,6^.5;13
"RTN","SROESNR0",76,0)
KEG ;;^ESU Coagulation Range-130,57^.7;1
"RTN","SROESNR0",77,0)
KEGC ;;^ESU Cutting Range-130,58^.7;2
"RTN","SROESNR0",78,0)
KPJC ;;^Major or Minor-130,.03^0;3
"RTN","SROESNR0",79,0)
KBF ;;^Principal Procedure-130,26^OP;1
"RTN","SROESNR0",80,0)
KBG ;;^Principal CPT Code-130,27^OP;2
"RTN","SROESNR0",81,0)
KFF ;;^Principal Diagnosis Code-130,66^34;2
"RTN","SROESNR0",82,0)
KBB ;;^Tubes and Drains-130,22^3;1
"RTN","SROESNR0",83,0)
KDD ;;^Final Sponge Count Correct (Y/N)-130,44^25;1
"RTN","SROESNR0",84,0)
KDE ;;^Final Sharps Count Correct (Y/N)-130,45^25;2
"RTN","SROESNR0",85,0)
KDF ;;^Final Instrument Count Correct (Y/N)-130,46^25;3
"RTN","SROESNR0",86,0)
KDG ;;^Person Responsible for Final Counts-130,47^25;4
"RTN","SROESNR0",87,0)
KDH ;;^Count Verifier-130,48^25;5
"RTN","SROESNR0",88,0)
KDA ;;^Dressing(s)-130,41^35;1
"RTN","SROESNR0",89,0)
KPHGE ;;^Packing Type-130,.875^.8;11
"RTN","SROESNR0",90,0)
KPBE ;;^Intraoperative Blood Loss (ml)-130,.25^.2;5
"RTN","SROESNR0",91,0)
KPBEE ;;^Total Urine Output (ml)-130,.255^.2;16
"RTN","SROESNR0",92,0)
KPHA ;;^Postoperative Mood-130,.81^.8;1
"RTN","SROESNR0",93,0)
KPHBA ;;^Postoperative Consciousness-130,.821^.8;10
"RTN","SROESNR0",94,0)
KPGF ;;^Postoperative Skin Integrity-130,.76^.7;6
"RTN","SROESNR0",95,0)
KPGG ;;^Postoperative Skin Color-130,.77^.7;7
"RTN","SROESNR0",96,0)
KABH ;;^Type of Laser-130,128^.7;8
"RTN","SROESNR0",97,0)
KABG ;;^Sequential Compression Device (Y/N)-130,127^.7;3
"RTN","SROESNR0",98,0)
KAPJI ;;^Wound Classification-130,1.09^1.0;8
"RTN","SROESNR0",99,0)
KPDF ;;^Postoperative Disposition-130,.46^.4;6
"RTN","SROESNR0",100,0)
KBE ;;^Patient Discharged Via-130,25^.7;4
"RTN","SROESNR0",101,0)
KACA ;;^Device(s)-130,131^46;1
"RTN","SROESNR0",102,0)
KDI ;;^Specimens-130,49;W^9;0
"RTN","SROESNR0",103,0)
KFD ;;^Cultures-130,64;W^41;0
"RTN","SROESNR0",104,0)
KPBI ;;^Nursing Care Comments-130,.29;W^7;0
"RTN","SROESNR1")
0^51^B36449721
"RTN","SROESNR1",1,0)
SROESNR1 ;BIR/ADM - NURSE REPORT E-SIG UTILITY ; [ 02/20/02  2:35 PM ]
"RTN","SROESNR1",2,0)
 ;;3.0; Surgery ;**100**;24 Jun 93
"RTN","SROESNR1",3,0)
 ;
"RTN","SROESNR1",4,0)
 ;** NOTICE: This routine is part of an implementation of a nationally
"RTN","SROESNR1",5,0)
 ;**         controlled procedure.  Local modifications to this routine
"RTN","SROESNR1",6,0)
 ;**         are prohibited.
"RTN","SROESNR1",7,0)
 ;
"RTN","SROESNR1",8,0)
MULT ; process multiples
"RTN","SROESNR1",9,0)
 N I,SRFF,SRI,SRK1,SRP,SRJ,SRFLD,SRNP,SRN,SRCAT,SRP,SRSUB,SRL,SRE,SRE1,SRW,X,Y
"RTN","SROESNR1",10,0)
 S SRI="."_$P(SRK,".",2) D TR S SRK1=SRP
"RTN","SROESNR1",11,0)
 F SRJ=0:1 S SRFLD=$P($T(@SRK1+SRJ),";;",2) Q:SRFLD=""  D ^SROESNRA
"RTN","SROESNR1",12,0)
 Q
"RTN","SROESNR1",13,0)
REV N SRP D TR S SRK1=SRP D
"RTN","SROESNR1",14,0)
 .I SRCAT="Anesthesia Technique(s)" D REV^SROESNR3 Q
"RTN","SROESNR1",15,0)
 .S SRFLD=$P($T(@SRK1+SRJ),";;",2)
"RTN","SROESNR1",16,0)
 Q
"RTN","SROESNR1",17,0)
TR S SRP=SRI,SRP=$TR(SRP,"1234567890.,","ABCDEFGHIJPK")
"RTN","SROESNR1",18,0)
 Q
"RTN","SROESNR1",19,0)
 ;;
"RTN","SROESNR1",20,0)
PBC ;;Other Scrubbed Assistant(s)^0;30^28,0
"RTN","SROESNR1",21,0)
 ;;Other Scrubbed Assistant(s)^01-Other Scrubbed Assistant-130.23,.01-2^28,0;1
"RTN","SROESNR1",22,0)
 ;;Other Scrubbed Assistant(s)^02-Comments-130.23,1;W-4^28,1,0;1
"RTN","SROESNR1",23,0)
 ;;
"RTN","SROESNR1",24,0)
PBH ;;O.R. Circulating Nurse(s)^0;.111^19,0
"RTN","SROESNR1",25,0)
 ;;O.R. Circulating Nurse(s)^01-O.R. Circulating Nurse-130.28,.01-2^19,0;1
"RTN","SROESNR1",26,0)
 ;;O.R. Circulating Nurse(s)^02-Educational Status-130.28,3-4^19,0;3
"RTN","SROESNR1",27,0)
PBI ;;O.R. Circulating Nurse(s)^03X-Time On-130.29,.01-4^19,1,0;1
"RTN","SROESNR1",28,0)
 ;;O.R. Circulating Nurse(s)^04X-Time Off-130.29,1-6^19,1,0;2
"RTN","SROESNR1",29,0)
 ;;O.R. Circulating Nurse(s)^05X-Reason for Relief-130.29,2-6^19,1,0;3
"RTN","SROESNR1",30,0)
 ;;O.R. Circulating Nurse(s)^06X-Comment-130.29,3;W-6^19,1,1,0;1
"RTN","SROESNR1",31,0)
 ;;
"RTN","SROESNR1",32,0)
PCF ;;O.R. Scrub Nurse(s)^0;.112^23,0
"RTN","SROESNR1",33,0)
 ;;O.R. Scrub Nurse(s)^01-O.R. Scrub Nurse-130.36,.01-2^23,0;1
"RTN","SROESNR1",34,0)
 ;;O.R. Scrub Nurse(s)^02-Educational Status-130.36,3-4^23,0;3
"RTN","SROESNR1",35,0)
 ;;O.R. Scrub Nurse(s)^03X-Time On-130.36,.01-4^19,1,0;1
"RTN","SROESNR1",36,0)
 ;;O.R. Scrub Nurse(s)^04X-Time Off-130.36,1-6^19,1,0;2
"RTN","SROESNR1",37,0)
 ;;O.R. Scrub Nurse(s)^05X-Reason for Relief-130.36,2-6^19,1,0;3
"RTN","SROESNR1",38,0)
 ;;O.R. Scrub Nurse(s)^06X-Comment-130.36,3;W-6^19,1,1,0;1
"RTN","SROESNR1",39,0)
 ;;
"RTN","SROESNR1",40,0)
PBD ;;Other Persons in O.R.^0;31^32,0
"RTN","SROESNR1",41,0)
 ;;Other Persons in O.R.^01-Other Person in O.R.-130.24,.01-2^32,0;1
"RTN","SROESNR1",42,0)
 ;;Other Persons in O.R.^02-Title/Organization-130.24,1-4^32,0;2
"RTN","SROESNR1",43,0)
 ;;
"RTN","SROESNR1",44,0)
PJFE ;;Surgery Position(s)^0;65^42,0
"RTN","SROESNR1",45,0)
 ;;Surgery Position(s)^01-Position-130.065,.01-2^42,0;1
"RTN","SROESNR1",46,0)
 ;;Surgery Position(s)^02-Placed-130.065,1-4^42,0;2
"RTN","SROESNR1",47,0)
 ;;
"RTN","SROESNR1",48,0)
PCA ;;Restraints and Position Aids^0;.13^20,0
"RTN","SROESNR1",49,0)
 ;;Restraints and Position Aids^01-Restraint/Position Aid-130.31,.01-2^20,0;1
"RTN","SROESNR1",50,0)
 ;;Restraints and Position Aids^02-Applied By-130.31,1-4^20,0;2
"RTN","SROESNR1",51,0)
 ;;Restraints and Position Aids^03-Comments-130.31,2-4^20,0;3
"RTN","SROESNR1",52,0)
 ;;
"RTN","SROESNR1",53,0)
PJBH ;;Principal CPT Modifier^0;28^OPMOD,0
"RTN","SROESNR1",54,0)
 ;;Principal CPT Modifier^01-CPT Modifier-130.028,.01-2^OPMOD,0;1
"RTN","SROESNR1",55,0)
 ;;
"RTN","SROESNR1",56,0)
PAF ;;Other Procedures Performed^0;.42^13,0
"RTN","SROESNR1",57,0)
 ;;Other Procedures Performed^01-Other Procedure-130.16,.01-2^13,0;1
"RTN","SROESNR1",58,0)
 ;;Other Procedures Performed^02-CPT Code-130.16,3-4^13,2;1
"RTN","SROESNR1",59,0)
PAFD ;;Other Procedures Performed^03-CPT Modifier-130.164,.01-4^13,MOD,0;1
"RTN","SROESNR1",60,0)
 ;;Other Procedures Performed^04X-Completed-130.16,2-4^13,0;3
"RTN","SROESNR1",61,0)
 ;;Other Procedures Performed^05X-Procedure Code Comments-130.16,1.5;W-4^13,1,0;1
"RTN","SROESNR1",62,0)
 ;;
"RTN","SROESNR1",63,0)
PJB ;;Tourniquet^0;.48^2,0
"RTN","SROESNR1",64,0)
 ;;Tourniquet^01-Time Applied-130.02,.01-2^2,0;1
"RTN","SROESNR1",65,0)
 ;;Tourniquet^02-Time Released-130.02,3-4^2,0;4
"RTN","SROESNR1",66,0)
 ;;Tourniquet^03-Site Applied-130.02,1-4^2,0;2
"RTN","SROESNR1",67,0)
 ;;Tourniquet^04-Pressure Applied (in TORR)-130.02,4-4^2,0;5
"RTN","SROESNR1",68,0)
 ;;Tourniquet^05-Applied By-130.02,2-4^2,0;3
"RTN","SROESNR1",69,0)
 ;;
"RTN","SROESNR1",70,0)
PCB ;;Thermal Unit^0;.757^21,0
"RTN","SROESNR1",71,0)
 ;;Thermal Unit^01-Thermal Unit-130.32,.01-2^21,0;1
"RTN","SROESNR1",72,0)
 ;;Thermal Unit^02-Temperature-130.32,2-4^21,0;3
"RTN","SROESNR1",73,0)
 ;;Thermal Unit^03-Time On-130.32,1-4^21,0;2
"RTN","SROESNR1",74,0)
 ;;Thermal Unit^04-Time Off-130.32,3-4^21,0;4
"RTN","SROESNR1",75,0)
 ;;
"RTN","SROESNR1",76,0)
PJA ;;Prosthesis Installed^0;.47^1,0
"RTN","SROESNR1",77,0)
 ;;Prosthesis Installed^01-Item-130.01,.01-2^1,0;1
"RTN","SROESNR1",78,0)
 ;;Prosthesis Installed^02-Vendor-130.01,1-4^1,0;2
"RTN","SROESNR1",79,0)
 ;;Prosthesis Installed^03-Model-130.01,2-4^1,0;3
"RTN","SROESNR1",80,0)
 ;;Prosthesis Installed^04-Lot/Serial Number-130.01,2.5-4^1,0;5
"RTN","SROESNR1",81,0)
 ;;Prosthesis Installed^05-Sterile Resp-130.01,5-4^1,0;7
"RTN","SROESNR1",82,0)
 ;;Prosthesis Installed^06-Size-130.01,6-4^1,1;1
"RTN","SROESNR1",83,0)
 ;;Prosthesis Installed^07-Quantity-130.01,7-4^1,1;2
"RTN","SROESNR1",84,0)
 ;;
"RTN","SROESNR1",85,0)
PCC ;;Medications^0;.375^22,0
"RTN","SROESNR1",86,0)
 ;;Medications^01-Medication-130.33,.01-2^22,0;1
"RTN","SROESNR1",87,0)
PCD ;*;Medications^02-Time Administered-130.34,.01-4^22,1,0;1
"RTN","SROESNR1",88,0)
 ;*;Medications^03-Route-130.34,4-6^22,1,0;5
"RTN","SROESNR1",89,0)
 ;*;Medications^04-Dose-130.34,1-6^22,1,0;2
"RTN","SROESNR1",90,0)
 ;*;Medications^05-Ordered By-130.34,2-6^22,1,0;3
"RTN","SROESNR1",91,0)
 ;*;Medications^06-Administered By-130.34,3-6^22,1,0;4
"RTN","SROESNR1",92,0)
 ;*;Medications^07-Comments-130.34,5-6^22,1,0;6
"RTN","SROESNR1",93,0)
 ;;
"RTN","SROESNR1",94,0)
PJH ;;Irrigation Solution(s)^0;.39^26,0
"RTN","SROESNR1",95,0)
 ;;Irrigation Solution(s)^01-Irrigation Solution-130.08,.01-2^26,0;1
"RTN","SROESNR1",96,0)
PCI ;;Irrigation Solution(s)^02-Time Utilized-130.39,.01-4^26,1,0;1
"RTN","SROESNR1",97,0)
 ;;Irrigation Solution(s)^03-Amount-130.39,1-6^26,1,0;2
"RTN","SROESNR1",98,0)
 ;;Irrigation Solution(s)^04-Provider-130.39,2-6^26,1,0;3
"RTN","SROESNR1",99,0)
 ;;
"RTN","SROESNR1",100,0)
PJD ;;Blood Replacement Fluids^0;.27^4,0
"RTN","SROESNR1",101,0)
 ;;Blood Replacement Fluids^01-Replacement Fluid Type-130.04,.01-2^4,0;1
"RTN","SROESNR1",102,0)
 ;;Blood Replacement Fluids^02-Quantity (ml)-130.04,1-4^4,0;2
"RTN","SROESNR1",103,0)
 ;;Blood Replacement Fluids^03-Source Identification-130.04,3-4^4,0;4
"RTN","SROESNR1",104,0)
 ;;Blood Replacement Fluids^04-VA Identification-130.04,4-4^4,0;5
"RTN","SROESNR1",105,0)
 ;;Blood Replacement Fluids^05-Comments-130.04,5;W-4^4,1,0;1
"RTN","SROESNR1",106,0)
 ;;
"RTN","SROESNR1",107,0)
PJABI ;;Laser Unit(s)^0;129^44,0
"RTN","SROESNR1",108,0)
 ;;Laser Unit(s)^01-Laser Unit/ID-130.0129,.01-2^44,0;1
"RTN","SROESNR1",109,0)
 ;;Laser Unit(s)^02-Duration-130.0129,1-4^44,0;2
"RTN","SROESNR1",110,0)
 ;;Laser Unit(s)^03-Wattage-130.0129,2-4^44,0;3
"RTN","SROESNR1",111,0)
 ;;Laser Unit(s)^04-Operator-130.0129,3-4^44,0;4
"RTN","SROESNR1",112,0)
 ;;Laser Unit(s)^05-Plume Evacuator-130.0129,4-4^44,0;5
"RTN","SROESNR1",113,0)
 ;;Laser Unit(s)^06-Comments-130.0129,5;W-4^44,1,0;1
"RTN","SROESNR1",114,0)
 ;;
"RTN","SROESNR1",115,0)
PJAC ;;Cell Saver(s)^0;130^45,0
"RTN","SROESNR1",116,0)
 ;;Cell Saver(s)^01-Cell Saver ID-130.013,.01-2^45,0;1
"RTN","SROESNR1",117,0)
 ;;Cell Saver(s)^02-Operator-130.013,1-4^45,0;2
"RTN","SROESNR1",118,0)
 ;;Cell Saver(s)^03-Amount Salvaged (ml)-130.013,2-4^45,0;3
"RTN","SROESNR1",119,0)
 ;;Cell Saver(s)^04-Amount Reinfused (ml)-130.013,3-4^45,0;4
"RTN","SROESNR1",120,0)
 ;;Cell Saver(s)^05-Comments-130.013,5;W-4^45,2,0;1
"RTN","SROESNR1",121,0)
PJACD ;;Cell Saver(s)^06-Disposables Name-130.0134,.01-4^45,1,0;1
"RTN","SROESNR1",122,0)
 ;;Cell Saver(s)^07-Lot Number-130.0134,1-6^45,1,0;2
"RTN","SROESNR1",123,0)
 ;;Cell Saver(s)^08-Quantity-130.0134,2-6^45,1,0;3
"RTN","SROESNR1",124,0)
 ;;
"RTN","SROESNR1",125,0)
PAH ;;Other Diagnosis^0;.74^15,0
"RTN","SROESNR1",126,0)
 ;;Other Diagnosis^01X-Other Diagnosis-130.18,.01-2^15,0;1
"RTN","SROESNR1",127,0)
 ;;Other Diagnosis^02-ICD Diagnosis Code-130.18,3-2^15,0;3
"RTN","SROESNR1",128,0)
 ;;Other Diagnosis^03X-Diagnosis Comments-130.18,2;W-4^15,1,0;1
"RTN","SROESNR2")
0^52^B34419782
"RTN","SROESNR2",1,0)
SROESNR2 ;BIR/ADM - NURSE REPORT E-SIG UTILITY ; [ 03/21/01  6:36 AM
"RTN","SROESNR2",2,0)
 ;;3.0; Surgery ;**100**;24 Jun 93
"RTN","SROESNR2",3,0)
 ;
"RTN","SROESNR2",4,0)
 ;** NOTICE: This routine is part of an implementation of a nationally
"RTN","SROESNR2",5,0)
 ;**         controlled procedure.  Local modifications to this routine
"RTN","SROESNR2",6,0)
 ;**         are prohibited.
"RTN","SROESNR2",7,0)
 ;
"RTN","SROESNR2",8,0)
 N SRALN,SRE,SRE1,SRFILE,SRFLD,SRG,SRI,SRJ,SRLN,SRMULT,SRNM,SRNUM,SRPF,SRS,SRTITLE,SRVAL,SRVAL1,SRVAL2,SRX,SRY,X
"RTN","SROESNR2",9,0)
 S SRI=0,SRG=$NA(^TMP("SRNR",$J,SRTN)) K @SRG
"RTN","SROESNR2",10,0)
SING ; single fields
"RTN","SROESNR2",11,0)
 S SRFLD="" F  S SRFLD=$O(^TMP("SRNRAD1",$J,SRTN,130,SRFLD)) Q:SRFLD=""  D
"RTN","SROESNR2",12,0)
 .S SRTITLE=$P(SRFLD,"-"),X=$P(SRFLD,"-",2),SRFILE=$P(X,","),SRNUM=$P(X,",",2) I SRNUM[";W" D WPS Q
"RTN","SROESNR2",13,0)
 .S SRVAL1="<NOT ENTERED>",SRY=$G(^TMP("SRNRAD1",$J,SRTN,130,SRFLD)) I SRY'="" D EXT S SRVAL1=SRX
"RTN","SROESNR2",14,0)
 .S SRVAL2="<DELETED>",SRY=$G(^TMP("SRNRAD2",$J,SRTN,130,SRFLD)) I SRY'="" D EXT S SRVAL2=SRX
"RTN","SROESNR2",15,0)
 .D LINE(2) S @SRG@(SRI)="The "_SRTITLE_" field was changed" D LINE(1) S @SRG@(SRI)="  from "_SRVAL1 D LINE(1) S @SRG@(SRI)="    to "_SRVAL2
"RTN","SROESNR2",16,0)
MULT ; multiples
"RTN","SROESNR2",17,0)
 S SRMULT="" F  S SRMULT=$O(^TMP("SRNRMULT1",$J,SRTN,SRMULT)) Q:SRMULT=""  D
"RTN","SROESNR2",18,0)
 .D LINE(2) S @SRG@(SRI)="The "_SRMULT_" subfile was changed as follows:"
"RTN","SROESNR2",19,0)
 .S SRE=0 F  S SRE=$O(^TMP("SRNRMULT1",$J,SRTN,SRMULT,SRE)) Q:'SRE  D
"RTN","SROESNR2",20,0)
 ..S SRE1="",SRJ=2,SRPF=0 F  S SRE1=$O(^TMP("SRNRMULT1",$J,SRTN,SRMULT,SRE,SRE1)) Q:SRE1=""  D  Q:SRE1=""
"RTN","SROESNR2",21,0)
 ...S SRFLD="" F  S SRFLD=$O(^TMP("SRNRMULT1",$J,SRTN,SRMULT,SRE,SRE1,SRFLD)) Q:SRFLD=""  D PROC Q:SRFLD=""
"RTN","SROESNR2",22,0)
 Q
"RTN","SROESNR2",23,0)
WPS ; word-processing fields
"RTN","SROESNR2",24,0)
 D LINE(2) S @SRG@(SRI)="The "_SRTITLE_" field was changed" D LINE(1) S @SRG@(SRI)=" >> from original "_SRTITLE_" text:"
"RTN","SROESNR2",25,0)
 I '$O(^TMP("SRNRAD1",$J,SRTN,130,SRFLD,0)) S @SRG@(SRI)=@SRG@(SRI)_" <NO TEXT ENTERED>"
"RTN","SROESNR2",26,0)
 S SRLN=0 F  S SRLN=$O(^TMP("SRNRAD1",$J,SRTN,130,SRFLD,SRLN)) Q:'SRLN  S X=^TMP("SRNRAD1",$J,SRTN,130,SRFLD,SRLN) D LINE(1) S @SRG@(SRI)="    "_X
"RTN","SROESNR2",27,0)
WPS2 D LINE(1) S @SRG@(SRI)=" >> to updated "_SRTITLE_" text:" I '$O(^TMP("SRNRAD2",$J,SRTN,130,SRFLD,0)) S @SRG@(SRI)=@SRG@(SRI)_" <TEXT DELETED>"
"RTN","SROESNR2",28,0)
 S SRLN=0 F  S SRLN=$O(^TMP("SRNRAD2",$J,SRTN,130,SRFLD,SRLN)) Q:'SRLN  S X=^TMP("SRNRAD2",$J,SRTN,130,SRFLD,SRLN) D LINE(1) S @SRG@(SRI)="    "_X
"RTN","SROESNR2",29,0)
 Q
"RTN","SROESNR2",30,0)
EXT ; get external value
"RTN","SROESNR2",31,0)
 S SRX=$$EXTERNAL^DILFD(SRFILE,SRNUM,"",SRY)
"RTN","SROESNR2",32,0)
 I SRFILE=130 D  Q
"RTN","SROESNR2",33,0)
 .I SRNUM=27,SRX'="" S SRX=$E(SRX,1,5) D CPT Q
"RTN","SROESNR2",34,0)
 .I SRNUM=66 D DIAG
"RTN","SROESNR2",35,0)
 I SRFILE=130.16,SRNUM=3,SRX'="" S SRX=$E(SRX,1,5) D CPT Q
"RTN","SROESNR2",36,0)
 I SRFILE=130.18,SRNUM=3 D DIAG
"RTN","SROESNR2",37,0)
 Q
"RTN","SROESNR2",38,0)
DIAG K DA,DIC,DIQ,DR S DA=SRY,DIQ="SRY",DIQ(0)="E",DR="3",DIC="^ICD9(" D EN^DIQ1 K DA,DIC,DIQ,DR S SRX=SRX_"  "_$G(SRY(80,SRY,3,"E")) K SRY
"RTN","SROESNR2",39,0)
 Q
"RTN","SROESNR2",40,0)
CPT S X=$$CPT^ICPTCOD(SRX),SRX=SRX_"  "_$P(X,"^",3)
"RTN","SROESNR2",41,0)
 Q
"RTN","SROESNR2",42,0)
PROC S SRTITLE=$P(SRFLD,"-",2),X=$P(SRFLD,"-",3),SRFILE=$P(X,","),SRNUM=$P(X,",",2),SRJ=$P(SRFLD,"-",4) I SRNUM[";W" D WPM Q
"RTN","SROESNR2",43,0)
 S SRVAL1="",SRY=$G(^TMP("SRNRMULT1",$J,SRTN,SRMULT,SRE,SRE1,SRFLD)) I SRY'="" D EXT S SRVAL1=SRX
"RTN","SROESNR2",44,0)
 S SRVAL2="",SRY=$G(^TMP("SRNRMULT2",$J,SRTN,SRMULT,SRE,SRE1,SRFLD)) I SRY'="" D EXT S SRVAL2=SRX
"RTN","SROESNR2",45,0)
 I $P(SRFLD,"-")="01",SRVAL1=""!(SRVAL2="") D FP01 Q
"RTN","SROESNR2",46,0)
 I 'SRPF,$P(SRNUM,";")=.01,SRVAL1=""!(SRVAL2="") D FP01S Q
"RTN","SROESNR2",47,0)
 I SRPF D FPX Q
"RTN","SROESNR2",48,0)
 S:SRVAL1="" SRVAL1="<NOT ENTERED>" S:SRVAL2="" SRVAL2="<DELETED>"
"RTN","SROESNR2",49,0)
 I SRVAL2=SRVAL1 D:$P(SRFLD,"-")="01" LINE(1) D LINE(1) S @SRG@(SRI)=$$SPACE(SRJ)_"The "_SRTITLE_" entry "_SRVAL1_" was changed:" Q
"RTN","SROESNR2",50,0)
 D:$P(SRFLD,"-")="01" LINE(1) D LINE(1) S @SRG@(SRI)=$$SPACE(SRJ)_"The "_SRTITLE_" field was changed" D LINE(1) S @SRG@(SRI)=$$SPACE(SRJ)_"  from "_SRVAL1 D LINE(1) S @SRG@(SRI)=$$SPACE(SRJ)_"    to "_SRVAL2
"RTN","SROESNR2",51,0)
 Q
"RTN","SROESNR2",52,0)
FP01S ; add or delete subfile entry
"RTN","SROESNR2",53,0)
 I SRVAL1="" D LINE(1) S @SRG@(SRI)=$$SPACE(SRJ)_"The following "_SRTITLE_" was ADDED:" S SRNM=2
"RTN","SROESNR2",54,0)
 I SRVAL2="" D LINE(1) S @SRG@(SRI)=$$SPACE(SRJ)_"The following "_SRTITLE_" was DELETED:" S SRNM=1
"RTN","SROESNR2",55,0)
 S SRPF=1,SRVAL=$S(SRNM=1:SRVAL1,1:SRVAL2) D LINE(1) S @SRG@(SRI)=$$SPACE(SRJ+2)_SRTITLE_": "_SRVAL
"RTN","SROESNR2",56,0)
 Q
"RTN","SROESNR2",57,0)
FP01 ; add or delete
"RTN","SROESNR2",58,0)
 I SRVAL1="" D LINE(2) S @SRG@(SRI)=$$SPACE(SRJ)_"The following "_SRTITLE_" was ADDED:" S SRNM=2
"RTN","SROESNR2",59,0)
 I SRVAL2="" D LINE(2) S @SRG@(SRI)=$$SPACE(SRJ)_"The following "_SRTITLE_" was DELETED:" S SRNM=1
"RTN","SROESNR2",60,0)
 S SRPF=1,SRVAL=$S(SRNM=1:SRVAL1,1:SRVAL2) D LINE(1) S @SRG@(SRI)=$$SPACE(SRJ+2)_SRTITLE_": "_SRVAL
"RTN","SROESNR2",61,0)
 Q
"RTN","SROESNR2",62,0)
FPX S SRJ=SRJ+2 I SRNUM[";W" D WPM
"RTN","SROESNR2",63,0)
 S SRVAL="",SRY=$G(^TMP("SRNRMULT"_SRNM,$J,SRTN,SRMULT,SRE,SRE1,SRFLD)) I SRY'="" D EXT S SRVAL=SRX
"RTN","SROESNR2",64,0)
 D LINE(1) S @SRG@(SRI)=$$SPACE(SRJ)_SRTITLE_": "_SRVAL
"RTN","SROESNR2",65,0)
 Q
"RTN","SROESNR2",66,0)
FWPM ; word-processing in multiples in added or deleted entries
"RTN","SROESNR2",67,0)
 I '$O(^TMP("SRNRAD1",$J,SRTN,SRMULT,SRE,SRE1,SRFLD,0)) S SRS=2
"RTN","SROESNR2",68,0)
 I '$O(^TMP("SRNRAD2",$J,SRTN,SRMULT,SRE,SRE1,SRFLD,0)) S SRS=1
"RTN","SROESNR2",69,0)
 D LINE(1) S @SRG@(SRI)=$$SPACE(SRJ)_SRTITLE_":" S SRLN=0
"RTN","SROESNR2",70,0)
 F  S SRLN=$O(^TMP("SRNRMULT"_SRS,$J,SRTN,SRMULT,SRE,SRE1,SRFLD,SRLN)) Q:'SRLN  S X=^TMP("SRNRMULT"_SRS,$J,SRTN,SRMULT,SRE,SRE1,SRFLD,SRLN) D LINE(1) S @SRG@(SRI)=$$SPACE(SRJ)_X
"RTN","SROESNR2",71,0)
 Q
"RTN","SROESNR2",72,0)
WPM ; word-processing in multiples
"RTN","SROESNR2",73,0)
 I SRPF S SRJ=SRJ+2 D FWPM Q
"RTN","SROESNR2",74,0)
 D LINE(1) S @SRG@(SRI)=$$SPACE(SRJ)_"The "_SRTITLE_" field was changed" D LINE(1) S @SRG@(SRI)=$$SPACE(SRJ+2)_">> from original "_SRTITLE_" text:"
"RTN","SROESNR2",75,0)
 I '$O(^TMP("SRNRAD1",$J,SRTN,SRMULT,SRE,SRE1,SRFLD,0)) S @SRG@(SRI)=@SRG@(SRI)_" <NO TEXT ENTERED>" D WPM2 Q
"RTN","SROESNR2",76,0)
 S SRLN=0 F  S SRLN=$O(^TMP("SRNRMULT1",$J,SRTN,SRMULT,SRE,SRE1,SRFLD,SRLN)) Q:'SRLN  S X=^TMP("SRNRMULT1",$J,SRTN,SRMULT,SRE,SRE1,SRFLD,SRLN) D LINE(1) S @SRG@(SRI)=$$SPACE(SRJ+2)_X
"RTN","SROESNR2",77,0)
WPM2 D LINE(1) S @SRG@(SRI)=$$SPACE(SRJ+2)_">> to updated "_SRTITLE_" text:" I '$O(^TMP("SRNRAD2",$J,SRTN,SRMULT,SRE,SRE1,SRFLD,0)) S @SRG@(SRI)=@SRG@(SRI)_" <TEXT DELETED>" Q
"RTN","SROESNR2",78,0)
 S SRLN=0 F  S SRLN=$O(^TMP("SRNRMULT2",$J,SRTN,SRMULT,SRE,SRE1,SRFLD,SRLN)) Q:'SRLN  S X=^TMP("SRNRMULT2",$J,SRTN,SRMULT,SRE,SRE1,SRFLD,SRLN) D LINE(1) S @SRG@(SRI)=$$SPACE(SRJ+2)_X
"RTN","SROESNR2",79,0)
 Q
"RTN","SROESNR2",80,0)
SPACE(NUM) ; create spaces
"RTN","SROESNR2",81,0)
 ; pass in position, returns number of needed spaces
"RTN","SROESNR2",82,0)
 I '$D(@SRG@(SRI)) S @SRG@(SRI)=""
"RTN","SROESNR2",83,0)
 Q $J("",NUM-$L(@SRG@(SRI)))
"RTN","SROESNR2",84,0)
 Q
"RTN","SROESNR2",85,0)
LINE(NUM) ; create carriage returns
"RTN","SROESNR2",86,0)
 F J=1:1:NUM S SRI=SRI+1,@SRG@(SRI)=""
"RTN","SROESNR2",87,0)
 Q
"RTN","SROESNR3")
0^121^B1183519
"RTN","SROESNR3",1,0)
SROESNR3 ;BIR/ADM - NURSE REPORT E-SIG UTILITY ; [ 02/20/02  2:35 PM ]
"RTN","SROESNR3",2,0)
 ;;3.0; Surgery ;**100**;24 Jun 93
"RTN","SROESNR3",3,0)
 ;
"RTN","SROESNR3",4,0)
 ;** NOTICE: This routine is part of an implementation of a nationally
"RTN","SROESNR3",5,0)
 ;**         controlled procedure.  Local modifications to this routine
"RTN","SROESNR3",6,0)
 ;**         are prohibited.
"RTN","SROESNR3",7,0)
 ;
"RTN","SROESNR3",8,0)
MULT ; process multiples
"RTN","SROESNR3",9,0)
 N I,SRFF,SRI,SRK1,SRP,SRJ,SRFLD,SRNP,SRN,SRCAT,SRP,SRSUB,SRL,SRE,SRE1,SRW,X,Y
"RTN","SROESNR3",10,0)
 S SRI="."_$P(SRK,".",2) D TR S SRK1=SRP
"RTN","SROESNR3",11,0)
 F SRJ=0:1 S SRFLD=$P($T(@SRK1+SRJ),";;",2) Q:SRFLD=""  D ^SROESNRA
"RTN","SROESNR3",12,0)
 Q
"RTN","SROESNR3",13,0)
REV S SRFLD=$P($T(@SRK1+SRJ),";;",2)
"RTN","SROESNR3",14,0)
 Q
"RTN","SROESNR3",15,0)
TR S SRP=SRI,SRP=$TR(SRP,"1234567890.,","ABCDEFGHIJPK")
"RTN","SROESNR3",16,0)
 Q
"RTN","SROESNR3",17,0)
 ;;
"RTN","SROESNR3",18,0)
PJF ;;Anesthesia Technique(s)^0;.37^6,0
"RTN","SROESNR3",19,0)
 ;;Anesthesia Technique(s)^01-Anesthesia Technique-130.06,.01-2^6,0;1
"RTN","SROESNR3",20,0)
 ;*;Anesthesia Technique(s)^02-Principal Technique-130.06,.05-4^6,0;3
"RTN","SROESNR3",21,0)
PDG ;*;Anesthesia Technique(s)^03-Anesthesia Agent-130.47,.01-4^6,1,0;1
"RTN","SROESNR3",22,0)
 ;*;Anesthesia Technique(s)^04-Dose (mg)-130.47,1-6^6,1,0;2
"RTN","SROESNR3",23,0)
 ;*;Anesthesia Technique(s)^05X-Monitored Anesthesia Care ? (Y/N)-130.06,41-4^6,8;1
"RTN","SROESNR3",24,0)
 ;*;Anesthesia Technique(s)^06X-Intubated ? (Y/N)-130.06,42-4^6,8;2
"RTN","SROESNR3",25,0)
 ;*;Anesthesia Technique(s)^07X-Approach-130.06,3-4^6,0;5
"RTN","SROESNR3",26,0)
 ;*;Anesthesia Technique(s)^08X-Route-130.06,4-4^6,0;6
"RTN","SROESNR3",27,0)
 ;*;Anesthesia Technique(s)^09X-Laryngoscope Type-130.06,5-4^6,0;7
"RTN","SROESNR3",28,0)
 ;*;Anesthesia Technique(s)^10X-Laryngoscope Size-130.06,6-4^6,0;8
"RTN","SROESNR3",29,0)
 ;*;Anesthesia Technique(s)^11X-Stylet Used (Y/N)-130.06,7-4^6,0;9
"RTN","SROESNR3",30,0)
 ;*;Anesthesia Technique(s)^12X-Lidocaine Topical-130.06,8-4^6,0;10
"RTN","SROESNR3",31,0)
 ;*;Anesthesia Technique(s)^13X-Lidocaine IV-130.06,9-4^6,0;11
"RTN","SROESNR3",32,0)
 ;*;Anesthesia Technique(s)^14X-Tube Type-130.06,10-4^6,0;12
"RTN","SROESNR3",33,0)
 ;*;Anesthesia Technique(s)^15X-Tube Size-130.06,11-4^6,0;13
"RTN","SROESNR3",34,0)
 ;*;Anesthesia Technique(s)^16X-Trauma-130.06,12-4^6,0;14
"RTN","SROESNR3",35,0)
 ;*;Anesthesia Technique(s)^17X-Extubated In-130.06,21-4^6,0;23
"RTN","SROESNR3",36,0)
 ;*;Anesthesia Technique(s)^18X-Extubated By-130.06,39-4^6,6;1
"RTN","SROESNR3",37,0)
 ;*;Anesthesia Technique(s)^19X-Reintubated Within 8 Hours-130.06,22-4^6,0;24
"RTN","SROESNR3",38,0)
 ;*;Anesthesia Technique(s)^20X-Heat, Moisture Exchanger-130.06,17-4^6,0;19
"RTN","SROESNR3",39,0)
 ;*;Anesthesia Technique(s)^21X-Bacterial Filter in Circuit-130.06,18-4^6,0;20
"RTN","SROESNR3",40,0)
 ;*;Anesthesia Technique(s)^22X-Continuous Administration ? (Y/N)-130.06,25-4^6,2;1
"RTN","SROESNR3",41,0)
 ;*;Anesthesia Technique(s)^23X-Baricity-130.06,26-4^6,2;2
"RTN","SROESNR3",42,0)
 ;*;Anesthesia Technique(s)^24X-Puncture Site-130.06,27-4^6,2;3
"RTN","SROESNR3",43,0)
 ;*;Anesthesia Technique(s)^25X-Needle Size-130.06,29-4^6,2;5
"RTN","SROESNR3",44,0)
 ;*;Anesthesia Technique(s)^26X-Neurodermatone Anesthesia Sensory Level-130.06,43-4^6,8;3
"RTN","SROESNR3",45,0)
 ;*;Anesthesia Technique(s)^27X-Dural Puncture ? (Y/N)-130.06,34-4^6,3;4
"RTN","SROESNR3",46,0)
 ;*;Anesthesia Technique(s)^28X-Catheter Removed By-130.06,35-4^6,3;5
"RTN","SROESNR3",47,0)
 ;*;Anesthesia Technique(s)^29X-Date/Time Catheter Removed-130.06,44-4^6,8;4
"RTN","SROESNR3",48,0)
PDI ;*;Anesthesia Technique(s)^30X-Regional Block Site-130.49,.01-4^6,5,0;1
"RTN","SROESNR3",49,0)
 ;*;Anesthesia Technique(s)^31X-Needle Length (cm)-130.49,1-4^6,5,0;2
"RTN","SROESNR3",50,0)
 ;*;Anesthesia Technique(s)^32X-Needle Guage-130.49,2-4^6,5,0;3
"RTN","SROESNR3",51,0)
 ;*;Anesthesia Technique(s)^33X-Patient Status-130.06,2-4^6,0;4
"RTN","SROESNR3",52,0)
 ;*;Anesthesia Technique(s)^34X-Bite Block (Y/N)-130.06,13-4^6,0;15
"RTN","SROESNR3",53,0)
 ;*;Anesthesia Technique(s)^35X-Tube Lubrication-130.06,14-4^6,0;16
"RTN","SROESNR3",54,0)
 ;*;Anesthesia Technique(s)^36X-Taped at Length-130.06,15-4^6,0;17
"RTN","SROESNR3",55,0)
 ;*;Anesthesia Technique(s)^37X-Breath Sounds OK Bilaterally-130.06,16-4^6,0;18
"RTN","SROESNR3",56,0)
 ;*;Anesthesia Technique(s)^38X-Anesthesia Ventilator Tidal Volume-130.06,19-4^6,0;21
"RTN","SROESNR3",57,0)
 ;*;Anesthesia Technique(s)^39X-Anesthesia Ventilator Rate-130.06,20-4^6,0;22
"RTN","SROESNR3",58,0)
 ;*;Anesthesia Technique(s)^40X-Preoxygenation-130.06,23-4^6,0;25
"RTN","SROESNR3",59,0)
 ;*;Anesthesia Technique(s)^41X-Spinal Approach-130.06,28-4^6,2;4
"RTN","SROESNR3",60,0)
 ;*;Anesthesia Technique(s)^42X-Epidural Method-130.06,30-4^6,3;1
"RTN","SROESNR3",61,0)
 ;*;Anesthesia Technique(s)^43X-Multiple Attempts-130.06,31-4^6,3;2
"RTN","SROESNR3",62,0)
PDH ;*;Anesthesia Technique(s)^44X-Test Dose-130.48,.01-4^6,4,0;1
"RTN","SROESNR3",63,0)
 ;*;Anesthesia Technique(s)^45X-Dose-130.48,1-4^6,4,0;2
"RTN","SROESNR3",64,0)
 ;*;Anesthesia Technique(s)^46X-Test Dose Volume-130.06,33-4^6,3;3
"RTN","SROESNR3",65,0)
 ;*;Anesthesia Technique(s)^47X-Method of Administration-130.06,36-4^6,3;6
"RTN","SROESNR3",66,0)
 ;*;Anesthesia Technique(s)^48X-Purpose-130.06,37-4^6,3;7
"RTN","SROESNR3",67,0)
 ;*;Anesthesia Technique(s)^49X-Anesthesia Comments-130.06,40;W-4^6,7,0;1
"RTN","SROESNRA")
0^53^B23152586
"RTN","SROESNRA",1,0)
SROESNRA ;BIR/ADM - NURSE REPORT E-SIG UTILITY ; [ 02/20/02  2:35 PM ]
"RTN","SROESNRA",2,0)
 ;;3.0; Surgery ;**100**;24 Jun 93
"RTN","SROESNRA",3,0)
 ;
"RTN","SROESNRA",4,0)
 ;** NOTICE: This routine is part of an implementation of a nationally
"RTN","SROESNRA",5,0)
 ;**         controlled procedure.  Local modifications to this routine
"RTN","SROESNRA",6,0)
 ;**         are prohibited.
"RTN","SROESNRA",7,0)
 ;
"RTN","SROESNRA",8,0)
MULT ; process multiples
"RTN","SROESNRA",9,0)
 S X=$P(SRFLD,"^",2),Y=$P(SRFLD,"^",3) I $P(X,";")=0 S:SRS=1 ^TMP("SRNSAVE",$J,SRTN,$P(SRFLD,"^"),0)=$G(^SRF(SRTN,$P(Y,","),0)) Q
"RTN","SROESNRA",10,0)
 S SRCAT=$P(SRFLD,"^"),SRSUB=$P(SRFLD,"^",2),SRFF=$P(SRSUB,"-",3)
"RTN","SROESNRA",11,0)
 I SRFF="130.16,3"!(SRFF="130.028,.01")!(SRFF="130.164,.01") Q:'$P($G(^SRF(SRTN,"TIU")),"^",6)
"RTN","SROESNRA",12,0)
 I SRFF["130.18" Q:'$P($G(^SRF(SRTN,"TIU")),"^",7)
"RTN","SROESNRA",13,0)
 S SRNP=$P(SRFLD,"^",3),SRN=$P(SRNP,";"),SRP=$P(SRNP,";",2)
"RTN","SROESNRA",14,0)
 K SRL F I=1:1 S Y=$P(SRN,",",I) Q:Y=""  S SRL(I)=Y,SRL=I
"RTN","SROESNRA",15,0)
 S SRW=$S($P(SRFF,";",2)["W":1,1:0)
"RTN","SROESNRA",16,0)
 S SRE=0 F  S SRE=$O(^SRF(SRTN,SRL(1),SRE)) Q:'SRE  D
"RTN","SROESNRA",17,0)
 .I SRL=2 D
"RTN","SROESNRA",18,0)
 ..I SRS=1 D
"RTN","SROESNRA",19,0)
 ...I $P(SRFF,",",2)=.01 S ^TMP("SRNSAVE",$J,SRTN,SRCAT,0)=$G(^SRF(SRTN,SRL(1),0))
"RTN","SROESNRA",20,0)
 ...S ^TMP("SRNSAVE",$J,SRTN,SRCAT,SRE,0,SRSUB)=$P($G(^SRF(SRTN,SRL(1),SRE,SRL(2))),"^",SRP)
"RTN","SROESNRA",21,0)
 ..I $P(SRSUB,"-")'["X" S ^TMP("SRNRAD"_SRS,$J,SRTN,SRCAT,SRE,0,SRSUB)=$P($G(^SRF(SRTN,SRL(1),SRE,SRL(2))),"^",SRP)
"RTN","SROESNRA",22,0)
 .I SRL=3 S SRE1=0 F  S SRE1=$O(^SRF(SRTN,SRL(1),SRE,SRL(2),SRE1)) Q:'SRE1  D
"RTN","SROESNRA",23,0)
 ..I SRW D  Q
"RTN","SROESNRA",24,0)
 ...I SRS=1 D
"RTN","SROESNRA",25,0)
 ....S ^TMP("SRNSAVE",$J,SRTN,SRCAT,SRE,0,SRSUB,0)=$G(^SRF(SRTN,SRL(1),SRE,SRL(2),0))
"RTN","SROESNRA",26,0)
 ....S ^TMP("SRNSAVE",$J,SRTN,SRCAT,SRE,0,SRSUB,SRE1)=$P($G(^SRF(SRTN,SRL(1),SRE,SRL(2),SRE1,SRL(3))),"^",SRP)
"RTN","SROESNRA",27,0)
 ...I $P(SRSUB,"-")'["X" S ^TMP("SRNRAD"_SRS,$J,SRTN,SRCAT,SRE,0,SRSUB,SRE1)=$P($G(^SRF(SRTN,SRL(1),SRE,SRL(2),SRE1,SRL(3))),"^",SRP)
"RTN","SROESNRA",28,0)
 ..I SRS=1 D
"RTN","SROESNRA",29,0)
 ...I $P(SRFF,",",2)=.01 S ^TMP("SRNSAVE",$J,SRTN,SRCAT,SRE,0,SRSUB)=$G(^SRF(SRTN,SRL(1),SRE,SRL(2),0))
"RTN","SROESNRA",30,0)
 ...S ^TMP("SRNSAVE",$J,SRTN,SRCAT,SRE,SRE1,SRSUB)=$P($G(^SRF(SRTN,SRL(1),SRE,SRL(2),SRE1,SRL(3))),"^",SRP)
"RTN","SROESNRA",31,0)
 ..I $P(SRSUB,"-")'["X" S ^TMP("SRNRAD"_SRS,$J,SRTN,SRCAT,SRE,SRE1,SRSUB)=$P($G(^SRF(SRTN,SRL(1),SRE,SRL(2),SRE1,SRL(3))),"^",SRP)
"RTN","SROESNRA",32,0)
 Q
"RTN","SROESNRA",33,0)
REVRS ; restore pre-edit data in multiples
"RTN","SROESNRA",34,0)
 D REMOVE
"RTN","SROESNRA",35,0)
 S SRCAT="" F  S SRCAT=$O(^TMP("SRNRMULT1",$J,SRTN,SRCAT)) Q:SRCAT=""  D RESTORE
"RTN","SROESNRA",36,0)
 Q
"RTN","SROESNRA",37,0)
RESTORE ; enter multiple data saved in ^TMP("SRNSAVE"
"RTN","SROESNRA",38,0)
 S (SRCNT,SRE)=0 F  S SRE=$O(^TMP("SRNSAVE",$J,SRTN,SRCAT,SRE)) Q:'SRE  S SRE1="" F  S SRE1=$O(^TMP("SRNSAVE",$J,SRTN,SRCAT,SRE,SRE1)) Q:SRE1=""  D
"RTN","SROESNRA",39,0)
 .S SRSUB="" F  S SRSUB=$O(^TMP("SRNSAVE",$J,SRTN,SRCAT,SRE,SRE1,SRSUB)) Q:SRSUB=""  S SRCNT=SRCNT+1 D FIELD
"RTN","SROESNRA",40,0)
 Q
"RTN","SROESNRA",41,0)
FIELD ; restore individual field
"RTN","SROESNRA",42,0)
 S X=$P(SRSUB,"-",3),SRFILE=$P(X,","),Y=$P(X,",",2),SRFIELD=$P(Y,";"),SRW=$S($P(Y,";",2)["W":1,1:0)
"RTN","SROESNRA",43,0)
 S:SRCNT=1 SRI="."_$P(SRFILE,".",2) S X=$E($P(SRSUB,"-"),1,2),SRJ=+X D REV^SROESNR1
"RTN","SROESNRA",44,0)
 S SRNP=$P(SRFLD,"^",3),SRN=$P(SRNP,";"),SRP=$P(SRNP,";",2)
"RTN","SROESNRA",45,0)
 K SRL F I=1:1 S Y=$P(SRN,",",I) Q:Y=""  S SRL(I)=Y,SRL=I
"RTN","SROESNRA",46,0)
 I 'SRW S SRVAL=^TMP("SRNSAVE",$J,SRTN,SRCAT,SRE,SRE1,SRSUB)
"RTN","SROESNRA",47,0)
 K DA,DIE,DR
"RTN","SROESNRA",48,0)
 I SRL=2,SRVAL'="" D
"RTN","SROESNRA",49,0)
 .I SRL(1)=13,SRL(2)=2 S ^SRF(SRTN,13,SRE,2)=SRVAL K DA,DIK S DA(1)=SRTN,DA=SRE,DIK="^SRF("_SRTN_",13,",DIK(1)="3" D EN^DIK K DA,DIK Q
"RTN","SROESNRA",50,0)
 .I SRE1=0,SRFIELD=.01 S ^SRF(SRTN,SRL(1),0)=^TMP("SRNSAVE",$J,SRTN,SRCAT,0)
"RTN","SROESNRA",51,0)
 .S DA(1)=SRTN,DA=SRE,DIE="^SRF("_SRTN_","_$S(SRL(1):SRL(1),1:""""_SRL(1)_"""")_",",DR=SRFIELD_"////"_SRVAL D ^DIE K DA,DIE,DR
"RTN","SROESNRA",52,0)
 I SRL=3 D
"RTN","SROESNRA",53,0)
 .I SRE1=0,SRFIELD=.01,SRVAL'="" S ^SRF(SRTN,SRL(1),SRE,SRL(2),0)=SRVAL Q
"RTN","SROESNRA",54,0)
 .I SRW D  Q
"RTN","SROESNRA",55,0)
 ..S ^SRF(SRTN,SRL(1),SRE,SRL(2),0)=$G(^TMP("SRNSAVE",$J,SRTN,SRCAT,SRE,SRE1,SRSUB,0))
"RTN","SROESNRA",56,0)
 ..S SRLN=0 F  S SRLN=$O(^TMP("SRNSAVE",$J,SRTN,SRCAT,SRE,SRE1,SRSUB,SRLN)) Q:'SRLN  S ^SRF(SRTN,SRL(1),SRE,SRL(2),SRLN,0)=$G(^TMP("SRNSAVE",$J,SRTN,SRCAT,SRE,SRE1,SRSUB,SRLN))
"RTN","SROESNRA",57,0)
 .I SRVAL'="" S DA(2)=SRTN,DA(1)=SRE,DA=SRE1,DIE="^SRF("_SRTN_","_$S(SRL(1):SRL(1),1:""""_SRL(1)_"""")_","_SRE_","_$S(SRL(2):SRL(2),1:""""_SRL(2)_"""")_",",DR=SRFIELD_"////"_SRVAL D ^DIE K DA,DIE,DR
"RTN","SROESNRA",58,0)
 Q
"RTN","SROESNRA",59,0)
REMOVE ; delete edited multiples
"RTN","SROESNRA",60,0)
 S SRCAT="" F  S SRCAT=$O(^TMP("SRNRMULT1",$J,SRTN,SRCAT)) Q:SRCAT=""  S SRE=$O(^TMP("SRNRMULT1",$J,SRTN,SRCAT,0)) Q:'SRE  S SRE1="",SRE1=$O(^TMP("SRNRMULT1",$J,SRTN,SRCAT,SRE,SRE1)) Q:SRE1=""  D
"RTN","SROESNRA",61,0)
 .S SRSUB="",SRSUB=$O(^TMP("SRNRMULT1",$J,SRTN,SRCAT,SRE,SRE1,SRSUB))
"RTN","SROESNRA",62,0)
 .S SRFF=$P(SRSUB,"-",3),SRK=$P(SRFF,","),SRI="."_$P(SRK,".",2),SRJ=1 D REV^SROESNR1
"RTN","SROESNRA",63,0)
 .S SRNP=$P(SRFLD,"^",3),SRN=$P(SRNP,";"),SRP=$P(SRNP,";",2)
"RTN","SROESNRA",64,0)
 .K SRL F I=1:1 S Y=$P(SRN,",",I) Q:Y=""  S SRL(I)=Y,SRL=I
"RTN","SROESNRA",65,0)
 .D DEL
"RTN","SROESNRA",66,0)
 Q
"RTN","SROESNRA",67,0)
DEL ; delete all entries from multiple
"RTN","SROESNRA",68,0)
 K DA,DIK S SRIEN=0 F  S SRIEN=$O(^SRF(SRTN,SRL(1),SRIEN)) Q:'SRIEN  S DA(1)=SRTN,DA=SRIEN,DIK="^SRF("_DA(1)_","_$S(SRL(1):SRL(1),1:""""_SRL(1)_"""")_"," D ^DIK K DA,DIK
"RTN","SROESNRA",69,0)
 K ^SRF(SRTN,SRL(1))
"RTN","SROESNRA",70,0)
 Q
"RTN","SROESPR")
0^54^B26316431
"RTN","SROESPR",1,0)
SROESPR ;BIR/ADM - SURGERY E-SIG UTILITY ; [ 03/03/04  9:38 AM ]
"RTN","SROESPR",2,0)
 ;;3.0; Surgery ;**100**;24 Jun 93
"RTN","SROESPR",3,0)
 ;
"RTN","SROESPR",4,0)
 ;** NOTICE: This routine is part of an implementation of a nationally
"RTN","SROESPR",5,0)
 ;**         controlled procedure.  Local modifications to this routine
"RTN","SROESPR",6,0)
 ;**         are prohibited.
"RTN","SROESPR",7,0)
 ;
"RTN","SROESPR",8,0)
 ; Reference to $$PRNTGRP^TIULG supported by DBIA #3003
"RTN","SROESPR",9,0)
 ; Reference to $$PRNTMTHD^TIULG supported by DBIA #3003
"RTN","SROESPR",10,0)
 ; Reference to $$PRNTNBR^TIULG supported by DBIA #3003
"RTN","SROESPR",11,0)
 ; Reference to EXTRACT^TIULQ supported by DBIA #2693
"RTN","SROESPR",12,0)
 ; Reference to ^TMP("TIUPR",$J) supported by DBIA #4377
"RTN","SROESPR",13,0)
 ;
"RTN","SROESPR",14,0)
ENTRY ; Entry point to print reports
"RTN","SROESPR",15,0)
 N SRFLAG,SRI,SRJ,SRK,SRL,SRM,SRN,SRO,SRPGRP,SRPFHDR,SRSPG
"RTN","SROESPR",16,0)
 I $G(TIUFLAG) S SRFLAG=TIUFLAG
"RTN","SROESPR",17,0)
 I '$O(^TMP("SRPR",$J,0)) M ^TMP("SRPR",$J)=^TMP("TIUPR",$J)
"RTN","SROESPR",18,0)
 S SRI="" F  S SRI=$O(^TMP("SRPR",$J,SRI)) Q:SRI=""  S SRJ="" F  S SRJ=$O(^TMP("SRPR",$J,SRI,SRJ)) Q:SRJ=""  S SRK="" F  S SRK=$O(^TMP("SRPR",$J,SRI,SRJ,SRK)) Q:SRK=""  D
"RTN","SROESPR",19,0)
 .S SRPGRP=$P(SRI,"$"),SRL=$P(SRI,"$",2),SRM=$P(SRL,";"),SRN=$P(SRL,";",2)
"RTN","SROESPR",20,0)
 .S SRPFHDR=$$TITLE^SROESPR(SRK)
"RTN","SROESPR",21,0)
 .S SRO("SRPR",$J,SRPGRP_"$"_SRPFHDR_";"_SRN,SRJ,SRK)=^TMP("SRPR",$J,SRI,SRJ,SRK)
"RTN","SROESPR",22,0)
 .K ^TMP("SRPR",$J,SRI,SRJ,SRK)
"RTN","SROESPR",23,0)
 M ^TMP("SRPR",$J)=SRO("SRPR",$J)
"RTN","SROESPR",24,0)
 U IO
"RTN","SROESPR",25,0)
ENTRY1 ; Entry point from above
"RTN","SROESPR",26,0)
 N SRERR,D0,DN,Y,DTOUT,DUOUT,DIRUT,DIROUT
"RTN","SROESPR",27,0)
 I $E(IOST)="C" S (SRSPG,SRFLAG)=1
"RTN","SROESPR",28,0)
 I '+$G(SRFLAG) S SRSPG=1
"RTN","SROESPR",29,0)
 K ^TMP("SRLQ",$J)
"RTN","SROESPR",30,0)
 I $D(ZTQUEUED) S ZTREQ="@" ; Tell TaskMan to delete Task log entry
"RTN","SROESPR",31,0)
 D PRINT^SROESPR1($G(SRFLAG),$G(SRSPG))
"RTN","SROESPR",32,0)
EXIT K ^TMP("SRLQ",$J),^TMP("SRPR",$J)
"RTN","SROESPR",33,0)
 Q
"RTN","SROESPR",34,0)
PRNT(SRTN,SRTIU,SRDTITL) ; print report from TIU
"RTN","SROESPR",35,0)
 N DFN,SRDARR,SRFLAG,SRPFHDR,SRPFNBR,SRPGRP,SRPMTHD,SRSPG,SRTYP
"RTN","SROESPR",36,0)
 K ^TMP("SRPR",$J) S SRFLAG=$$FLAG Q:SRFLAG=""  I $G(SRDTITL)="" S SRDTITL="Surgery Print TIU Document"
"RTN","SROESPR",37,0)
 S DFN=$P(^SRF(SRTN,0),"^"),SRTYP=$$TYPE(SRTIU) Q:'+SRTYP
"RTN","SROESPR",38,0)
 S SRPMTHD=$$PRNTMTHD^TIULG(+SRTYP)
"RTN","SROESPR",39,0)
 S SRPGRP=$$PRNTGRP^TIULG(+SRTYP)
"RTN","SROESPR",40,0)
 S SRPFHDR=$$TITLE(SRTIU)
"RTN","SROESPR",41,0)
 S SRPFNBR=$$PRNTNBR^TIULG(+SRTYP)
"RTN","SROESPR",42,0)
 I $G(SRPMTHD)]"",+$G(SRPGRP),($G(SRPFHDR)]""),($G(SRPFNBR)]"") S SRDARR(SRPMTHD,$G(SRPGRP)_"$"_SRPFHDR_";"_DFN,1,SRTIU)=SRPFNBR
"RTN","SROESPR",43,0)
 E  S SRDARR(SRPMTHD,DFN,1,SRTIU)=""
"RTN","SROESPR",44,0)
 I $G(SRPMTHD)']"" W !,$C(7),"No Print Method Defined" H 2 Q
"RTN","SROESPR",45,0)
 M ^TMP("SRPR",$J)=SRDARR(SRPMTHD)
"RTN","SROESPR",46,0)
DEVICE I IOST'["P-" W ! K IOP S %ZIS="Q" D ^%ZIS I POP K POP G EXIT
"RTN","SROESPR",47,0)
 S SRFLAG=+$G(SRFLAG),SRSPG=+$G(SRSPG)
"RTN","SROESPR",48,0)
 I $D(IO("Q")) K IO("Q") D  G EXIT
"RTN","SROESPR",49,0)
 .S ZTRTN="ENTRY1^SROESPR",ZTSAVE("^TMP(""SRPR"",$J,")=""
"RTN","SROESPR",50,0)
 .S ZTSAVE("SRFLAG")="",ZTSAVE("SRSPG")="",ZTDESC=SRDTITL
"RTN","SROESPR",51,0)
 .D ^%ZTLOAD W !,$S($D(ZTSK):"Request Queued!",1:"Request Canceled!")
"RTN","SROESPR",52,0)
 .K ZTSK,ZTDESC,ZTDTH,ZTIO,ZTRTN,ZTSAVE,SRFLAG,SRSPG
"RTN","SROESPR",53,0)
 .D HOME^%ZIS
"RTN","SROESPR",54,0)
 U IO D ENTRY1,^%ZISC
"RTN","SROESPR",55,0)
 Q
"RTN","SROESPR",56,0)
TYPE(SRTIU) ; get document type
"RTN","SROESPR",57,0)
 N SRY,SRERR D EXTRACT^TIULQ(SRTIU,"SRY",.SRERR,".01")
"RTN","SROESPR",58,0)
 Q SRY(SRTIU,.01,"I")
"RTN","SROESPR",59,0)
TITLE(SRTIU) ; get report title
"RTN","SROESPR",60,0)
 N SRY,SRERR D EXTRACT^TIULQ(SRTIU,"SRY",.SRERR,".01")
"RTN","SROESPR",61,0)
 Q SRY(SRTIU,.01,"E")
"RTN","SROESPR",62,0)
FLAG() ; chart vs work copies
"RTN","SROESPR",63,0)
 ; returns SRFLAG=1 if chart copy, SRFLAG=0 if work copy, null if '^'
"RTN","SROESPR",64,0)
 I IOST["P-" S SRFLAG=0 Q SRFLAG
"RTN","SROESPR",65,0)
 S SRFLAG="" W ! K DIR S DIR("A")="Do you want WORK copies or CHART copies? ",DIR("B")="WORK",DIR(0)="SA^C:CHART;W:WORK"
"RTN","SROESPR",66,0)
 S DIR("?",1)="     The FOOTERs of WORK/CHART copies vary significantly.  The WORK",DIR("?",2)="     FOOTER has the patient's phone number and is clearly marked:"
"RTN","SROESPR",67,0)
 S DIR("?",3)="     'NOT FOR MEDICAL RECORD'.  Unless you really intend to file the",DIR("?")="     note(s) in the chart- print a WORK copy."
"RTN","SROESPR",68,0)
 D ^DIR K DIR I $D(DTOUT)!$D(DUOUT) Q SRFLAG
"RTN","SROESPR",69,0)
 S SRFLAG=$S(Y="C":1,1:0)
"RTN","SROESPR",70,0)
 Q SRFLAG
"RTN","SROESPR",71,0)
PAT(SRY,DFN) ; get minimum demographics for print
"RTN","SROESPR",72,0)
 N VADM,VAIP,VAIN,VAPA,VA D OERR^VADPT,ADD^VADPT
"RTN","SROESPR",73,0)
 S SRY("PNMP")=$E($G(VADM(1)),1,30),SRY("SSN")=$G(VA("PID"))
"RTN","SROESPR",74,0)
 S SRY("DOB")="DOB:"_$$DATE(+$G(VADM(3)),"MM/DD/CCYY")
"RTN","SROESPR",75,0)
 S SRY("PH#")="Ph:"_$S($G(VAPA(8))'="":VAPA(8),1:"**UNKNOWN**")
"RTN","SROESPR",76,0)
 S SRY("INTNM")=$$NAME^VASITE ;Integration Name
"RTN","SROESPR",77,0)
 S SRY("SITE")=$P($$SITE^VASITE,U,2)
"RTN","SROESPR",78,0)
 S SRY("LOCP")="Pt Loc: "_$S(VAIN(4)]"":$P(VAIN(4),U,2)_"  "_VAIN(5),1:"OUTPATIENT")
"RTN","SROESPR",79,0)
 Q
"RTN","SROESPR",80,0)
TIME(X,FMT) ; receives X as 2910419.01 and FMT=Return Format of time (HH:MM:SS).
"RTN","SROESPR",81,0)
 N HR,MIN,SEC,SRI I $S('$D(FMT):1,'$L(FMT):1,1:0) S FMT="HR:MIN"
"RTN","SROESPR",82,0)
 S X=$P(X,".",2),HR=$E(X,1,2)_$E("00",0,2-$L($E(X,1,2))),MIN=$E(X,3,4)_$E("00",0,2-$L($E(X,3,4))),SEC=$E(X,5,6)_$E("00",0,2-$L($E(X,5,6)))
"RTN","SROESPR",83,0)
 F SRI="HR","MIN","SEC" S:FMT[SRI FMT=$P(FMT,SRI)_@SRI_$P(FMT,SRI,2)
"RTN","SROESPR",84,0)
 Q FMT
"RTN","SROESPR",85,0)
DATE(X,FMT) ; call with X=2910419.01 and FMT=Return Format of date ("MM/DD")
"RTN","SROESPR",86,0)
 N AMTH,MM,CC,DD,YY,SRI,SRTMP
"RTN","SROESPR",87,0)
 I +X'>0 S $P(SRTMP," ",$L($G(FMT))+1)="",FMT=SRTMP G QDATE
"RTN","SROESPR",88,0)
 I $S('$D(FMT):1,'$L(FMT):1,1:0) S FMT="MM/DD/YY"
"RTN","SROESPR",89,0)
 S MM=$E(X,4,5),DD=$E(X,6,7),YY=$E(X,2,3),CC=17+$E(X)
"RTN","SROESPR",90,0)
 S:FMT["AMTH" AMTH=$P("JAN^FEB^MAR^APR^MAY^JUN^JUL^AUG^SEP^OCT^NOV^DEC","^",+MM)
"RTN","SROESPR",91,0)
 F SRI="AMTH","MM","DD","CC","YY" S:FMT[SRI FMT=$P(FMT,SRI)_@SRI_$P(FMT,SRI,2)
"RTN","SROESPR",92,0)
 I FMT["HR" S FMT=$$TIME(X,FMT)
"RTN","SROESPR",93,0)
QDATE Q FMT
"RTN","SROESPR",94,0)
BEEP(SRPER) ; get beeper #'s
"RTN","SROESPR",95,0)
 N SRDP,SRVP,SRY S (SRDP,SRVP)="" K DA,DIC,DR,DIQ
"RTN","SROESPR",96,0)
 S DIC=200,DA=+SRPER,DR=".137;.138",DIQ="SRY",DIQ(0)="I" D EN^DIQ1 K DA,DIC,DR,DIQ
"RTN","SROESPR",97,0)
 S SRVP=SRY(200,+SRPER,.137,"I"),SRDP=SRY(200,+SRPER,.138,"I")
"RTN","SROESPR",98,0)
 Q SRVP_"^"_SRDP
"RTN","SROESPR",99,0)
SIGNAME(SRPER) ; get signature block printed name
"RTN","SROESPR",100,0)
 N SRY K DA,DIC,DR,DIQ
"RTN","SROESPR",101,0)
 S DIC=200,DA=+SRPER,DR="20.2",DIQ="SRY",DIQ(0)="I" D EN^DIQ1 K DA,DIC,DR,DIQ
"RTN","SROESPR",102,0)
 Q SRY(200,+SRPER,20.2,"I")
"RTN","SROESPR",103,0)
SIGTITL(SRPER) ; get signature block title
"RTN","SROESPR",104,0)
 N SRY K DA,DIC,DR,DIQ
"RTN","SROESPR",105,0)
 S DIC=200,DA=+SRPER,DR="20.3",DIQ="SRY",DIQ(0)="I" D EN^DIQ1 K DA,DIC,DR,DIQ
"RTN","SROESPR",106,0)
 Q SRY(200,+SRPER,20.3,"I")
"RTN","SROESPR1")
0^55^B64342513
"RTN","SROESPR1",1,0)
SROESPR1 ;BIR/ADM - SURGERY E-SIG UTILITY ; [ 03/02/04  12:08 PM ]
"RTN","SROESPR1",2,0)
 ;;3.0; Surgery ;**100**;24 Jun 93
"RTN","SROESPR1",3,0)
 ;
"RTN","SROESPR1",4,0)
 ;** NOTICE: This routine is part of an implementation of a nationally
"RTN","SROESPR1",5,0)
 ;**         controlled procedure.  Local modifications to this routine
"RTN","SROESPR1",6,0)
 ;**         are prohibited.
"RTN","SROESPR1",7,0)
 ;
"RTN","SROESPR1",8,0)
 ; Reference to EXTRACT^TIULQ supported by DBIA #2693
"RTN","SROESPR1",9,0)
 ;
"RTN","SROESPR1",10,0)
 ; This routine was cloned in part or in whole from TIUPRPN1.
"RTN","SROESPR1",11,0)
PRINT(SRFLAG,SRSPG) ; Print Summary
"RTN","SROESPR1",12,0)
 ; ^TMP("SRPR",$J) is array of records passed by reference
"RTN","SROESPR1",13,0)
 ; SRFLAG=1 --> Chart Copy     SRSPG=1 --> Contiguous
"RTN","SROESPR1",14,0)
 ; SRFLAG=0 --> Work Copy      SRSPG=0 --> Fresh Page- each note
"RTN","SROESPR1",15,0)
 N SRI,SRJ,SRPAGE,SRFOOT,SRK,SRDA,SRCONT,SRPGRP,SRTYP
"RTN","SROESPR1",16,0)
 N SRPFHDR,SRPFNBR,SROPAGE
"RTN","SROESPR1",17,0)
 S SRFLAG=+$G(SRFLAG),SRSPG=+$G(SRSPG)
"RTN","SROESPR1",18,0)
 S SRI=0 F  S SRI=$O(^TMP("SRPR",$J,SRI)) Q:SRI=""  D  Q:'SRCONT
"RTN","SROESPR1",19,0)
 . N DFN,SR,SRERR
"RTN","SROESPR1",20,0)
 . I SRI["$" S SRPGRP=$P(SRI,"$"),SRPFHDR=$P($P(SRI,";"),"$",2)
"RTN","SROESPR1",21,0)
 . E  S SRPFHDR="Surgery Reports"
"RTN","SROESPR1",22,0)
 . I $G(SRPGRP)'=2 S SRSPG=0
"RTN","SROESPR1",23,0)
 . S DFN=$P(SRI,";",2)
"RTN","SROESPR1",24,0)
 . D PAT^SROESPR(.SRFOOT,DFN)
"RTN","SROESPR1",25,0)
 . I +$G(SRSPG) D HEADER^SROESPR2(.SRFOOT,SRFLAG,.SRPFHDR)
"RTN","SROESPR1",26,0)
 . S SRJ=0 F  S SRJ=$O(^TMP("SRPR",$J,SRI,SRJ)) Q:'SRJ  D  Q:'SRCONT
"RTN","SROESPR1",27,0)
 . . S SRK=0 F  S SRK=$O(^TMP("SRPR",$J,SRI,SRJ,SRK)) Q:'SRK  D  Q:'+$G(SRCONT)
"RTN","SROESPR1",28,0)
 . . . N SRERR1,SRW K SRCONT1 S SRPFNBR=^(SRK)
"RTN","SROESPR1",29,0)
 . . . ; If the document has been deleted, QUIT
"RTN","SROESPR1",30,0)
 . . . D EXTRACT^TIULQ(SRK,"SRW",.SRERR1,".01") I $P($G(SRERR1),"^")=1 S SRCONT=1 Q
"RTN","SROESPR1",31,0)
 . . . I '+$G(SRSPG) D HEADER^SROESPR2(.SRFOOT,SRFLAG,.SRPFHDR)
"RTN","SROESPR1",32,0)
 . . . S SRDA=SRK
"RTN","SROESPR1",33,0)
 . . . D REPORT(SRDA) Q:'+$G(SRCONT)
"RTN","SROESPR1",34,0)
 . . . I '+$G(SRSPG) K SRCONT1 D SETCONT(1)
"RTN","SROESPR1",35,0)
 . . . I $E(IOST)="C",'$O(^TMP("SRPR",$J,SRI,SRJ,SRK)) S SRCONT=0
"RTN","SROESPR1",36,0)
 . Q:'SRCONT  I $E(IOST)="C" S SRCONT=$$STOP^SROESPR2() Q:'SRCONT
"RTN","SROESPR1",37,0)
 . I +$G(SRSPG),$E(IOST)'="C" K SRCONT1 D SETCONT(1)
"RTN","SROESPR1",38,0)
 Q
"RTN","SROESPR1",39,0)
REPORT(SRDA) ; Report Text
"RTN","SROESPR1",40,0)
 N DIW,DIWF,DIWL,DIWR,DIWT,SRERR,SR,SRI,SRLINE,X,Z,SRY,LOC
"RTN","SROESPR1",41,0)
 K ^TMP("SRLQ",$J)
"RTN","SROESPR1",42,0)
 S SRLINE=0
"RTN","SROESPR1",43,0)
 D EXTRACT^TIULQ(+SRDA,"^TMP(""SRLQ"",$J)",.SRERR,"",SRLINE,1)
"RTN","SROESPR1",44,0)
 I +$G(SRERR) W !,$P(SRERR,U,2) Q
"RTN","SROESPR1",45,0)
 Q:'$D(^TMP("SRLQ",$J))
"RTN","SROESPR1",46,0)
 S SRY=4,SRCONT=1
"RTN","SROESPR1",47,0)
 D SETCONT() Q:'SRCONT
"RTN","SROESPR1",48,0)
 W "NOTE DATED: "
"RTN","SROESPR1",49,0)
 W $$DATE^SROESPR(^TMP("SRLQ",$J,SRDA,1301,"I"),"MM/DD/CCYY HR:MIN")
"RTN","SROESPR1",50,0)
 W ?30,$$UP^XLFSTR(^TMP("SRLQ",$J,SRDA,.01,"E")),!
"RTN","SROESPR1",51,0)
 I +$G(^TMP("SRLQ",$J,SRDA,1205,"I")) D
"RTN","SROESPR1",52,0)
 .S LOC=$G(^TMP("SRLQ",$J,SRDA,1205,"I")) Q:'$D(^SC(LOC,0))
"RTN","SROESPR1",53,0)
 .W $S($P(^SC(LOC,0),U,3)="W":"ADMITTED: ",1:"VISIT: ")
"RTN","SROESPR1",54,0)
 .W $$DATE^SROESPR(^TMP("SRLQ",$J,SRDA,.07,"I"),"MM/DD/CCYY HR:MIN")
"RTN","SROESPR1",55,0)
 .W " ",$G(^TMP("SRLQ",$J,SRDA,1205,"E"))
"RTN","SROESPR1",56,0)
 I ^TMP("SRLQ",$J,SRDA,1701,"E")]"" W !,"SUBJECT: ",^("E"),!
"RTN","SROESPR1",57,0)
 S SRCONT1=1
"RTN","SROESPR1",58,0)
 I $D(^TMP("SRLQ",$J,SRDA,"PROBLEM")) D  Q:'SRCONT
"RTN","SROESPR1",59,0)
 .D SETCONT() Q:'SRCONT
"RTN","SROESPR1",60,0)
 .W !,"ASSOCIATED PROBLEMS:"
"RTN","SROESPR1",61,0)
 .N SRI S SRI=0
"RTN","SROESPR1",62,0)
 .F  S SRI=$O(^TMP("SRLQ",$J,SRDA,"PROBLEM",SRI)) Q:'SRI  D  Q:'SRCONT
"RTN","SROESPR1",63,0)
 ..W !,^(SRI,0)
"RTN","SROESPR1",64,0)
 ..D SETCONT() Q:'SRCONT
"RTN","SROESPR1",65,0)
 W !
"RTN","SROESPR1",66,0)
 ;
"RTN","SROESPR1",67,0)
 S SRI=0,DIWF="WN",DIWL=1,DIWR=79 K ^UTILITY($J,"W")
"RTN","SROESPR1",68,0)
 F  S SRI=$O(^TMP("SRLQ",$J,SRDA,"TEXT",SRI)) Q:SRI'>0  D  Q:'SRCONT  ; D ^DIWW
"RTN","SROESPR1",69,0)
 . D SETCONT() Q:'SRCONT
"RTN","SROESPR1",70,0)
 . S X=^TMP("SRLQ",$J,SRDA,"TEXT",SRI,0) S:X="" X=" " D ^DIWP
"RTN","SROESPR1",71,0)
 D ^DIWW K ^UTILITY($J,"W")
"RTN","SROESPR1",72,0)
 Q:'SRCONT
"RTN","SROESPR1",73,0)
RPTSIG ; Signature should be on bottom of form, Addenda on Subsequent pages
"RTN","SROESPR1",74,0)
 N AUTHOR,EXPSIGNR,EXPCOSNR,SIGNDATE,SIGNEDBY,SIGNNAME,SIGTITL,SIGNMODE
"RTN","SROESPR1",75,0)
 N COSGDATE,COSGEDBY,COSGNAME,COSGTITL,COSGMODE,SIGCHRT,COSCHRT,SRLINE
"RTN","SROESPR1",76,0)
 S $P(SRLINE,"-",81)=""
"RTN","SROESPR1",77,0)
 S AUTHOR=$G(^TMP("SRLQ",$J,SRDA,1202,"I"))_";"_$G(^("E"))
"RTN","SROESPR1",78,0)
 S EXPSIGNR=$G(^TMP("SRLQ",$J,SRDA,1204,"I"))_";"_$G(^("E"))
"RTN","SROESPR1",79,0)
 S EXPCOSNR=$G(^TMP("SRLQ",$J,SRDA,1208,"I"))_";"_$G(^("E"))
"RTN","SROESPR1",80,0)
 S SIGNDATE=$G(^TMP("SRLQ",$J,SRDA,1501,"I"))
"RTN","SROESPR1",81,0)
 S SIGNEDBY=$G(^TMP("SRLQ",$J,SRDA,1502,"I"))_";"_$G(^("E"))
"RTN","SROESPR1",82,0)
 S SIGNNAME=$G(^TMP("SRLQ",$J,SRDA,1503,"E"))
"RTN","SROESPR1",83,0)
 S SIGTITL=$G(^TMP("SRLQ",$J,SRDA,1504,"E"))
"RTN","SROESPR1",84,0)
 S SIGNMODE=$G(^TMP("SRLQ",$J,SRDA,1505,"I"))_";"_$G(^("E"))
"RTN","SROESPR1",85,0)
 S COSGDATE=$G(^TMP("SRLQ",$J,SRDA,1507,"I"))
"RTN","SROESPR1",86,0)
 S COSGEDBY=$G(^TMP("SRLQ",$J,SRDA,1508,"I"))_";"_$G(^("E"))
"RTN","SROESPR1",87,0)
 S COSGNAME=$G(^TMP("SRLQ",$J,SRDA,1509,"E"))
"RTN","SROESPR1",88,0)
 S COSGTITL=$G(^TMP("SRLQ",$J,SRDA,1510,"E"))
"RTN","SROESPR1",89,0)
 S COSGMODE=$G(^TMP("SRLQ",$J,SRDA,1511,"I"))_";"_$G(^("E"))
"RTN","SROESPR1",90,0)
 S SIGCHRT=$G(^TMP("SRLQ",$J,SRDA,1512,"I"))_";"_$G(^("E"))
"RTN","SROESPR1",91,0)
 S COSCHRT=$G(^TMP("SRLQ",$J,SRDA,1513,"I"))_";"_$G(^("E"))
"RTN","SROESPR1",92,0)
 D SETCONT() Q:'SRCONT  W !
"RTN","SROESPR1",93,0)
 D SIGBLK Q:'SRCONT
"RTN","SROESPR1",94,0)
ADDENDA ; Surgery Reports Addenda
"RTN","SROESPR1",95,0)
 N DIW,DIWF,DIWL,DIWR,DIWT,X,Z,SRI,SRADD
"RTN","SROESPR1",96,0)
 S SRADD=0,DIWF="WN",DIWL=1,DIWR=79 K ^UTILITY($J,"W")
"RTN","SROESPR1",97,0)
 F  S SRADD=$O(^TMP("SRLQ",$J,SRDA,"ZADD",SRADD)) Q:SRADD'>0  D  Q:'SRCONT
"RTN","SROESPR1",98,0)
 . S SRY=4 D SETCONT() Q:'SRCONT
"RTN","SROESPR1",99,0)
 . W !!,$$DATE^SROESPR(^TMP("SRLQ",$J,SRDA,"ZADD",SRADD,1301,"I"),"MM/DD/CCYY HR:MIN"),?21,"ADDENDUM"
"RTN","SROESPR1",100,0)
 . S SRI=0
"RTN","SROESPR1",101,0)
 . F  S SRI=$O(^TMP("SRLQ",$J,SRDA,"ZADD",SRADD,"TEXT",SRI)) Q:SRI'>0  D  Q:'SRCONT
"RTN","SROESPR1",102,0)
 . . D SETCONT() Q:'SRCONT
"RTN","SROESPR1",103,0)
 . . S X=^TMP("SRLQ",$J,SRDA,"ZADD",SRADD,"TEXT",SRI,0) S:X="" X=" " D ^DIWP
"RTN","SROESPR1",104,0)
 . D ^DIWW
"RTN","SROESPR1",105,0)
 . D:SRCONT ADDENSIG
"RTN","SROESPR1",106,0)
 K ^UTILITY($J,"W")
"RTN","SROESPR1",107,0)
 ; Write 2 linefeeds between records
"RTN","SROESPR1",108,0)
 Q:'SRCONT  W !!
"RTN","SROESPR1",109,0)
 Q
"RTN","SROESPR1",110,0)
ADDENSIG ;
"RTN","SROESPR1",111,0)
 N AUTHOR,EXPSIGNR,ATTNDING,SIGNDATE,SIGNEDBY,SIGNNAME,SIGNMODE
"RTN","SROESPR1",112,0)
 N COSGDATE,COSGEDBY,COSGNAME,COSGMODE,SRLINE S $P(SRLINE,"-",80)=""
"RTN","SROESPR1",113,0)
 S AUTHOR=$G(^TMP("SRLQ",$J,SRDA,"ZADD",SRADD,1202,"I"))_";"_$G(^("E"))
"RTN","SROESPR1",114,0)
 S EXPSIGNR=$G(^TMP("SRLQ",$J,SRDA,"ZADD",SRADD,1204,"I"))_";"_$G(^("E"))
"RTN","SROESPR1",115,0)
 S ATTNDING=$G(^TMP("SRLQ",$J,SRDA,"ZADD",SRADD,1209,"I"))_";"_$G(^("E"))
"RTN","SROESPR1",116,0)
 S SIGNDATE=$G(^TMP("SRLQ",$J,SRDA,"ZADD",SRADD,1501,"I"))
"RTN","SROESPR1",117,0)
 S SIGNEDBY=$G(^TMP("SRLQ",$J,SRDA,"ZADD",SRADD,1502,"I"))_";"_$G(^("E"))
"RTN","SROESPR1",118,0)
 S SIGNNAME=$G(^TMP("SRLQ",$J,SRDA,"ZADD",SRADD,1503,"E"))
"RTN","SROESPR1",119,0)
 S SIGTITL=$G(^TMP("SRLQ",$J,SRDA,"ZADD",SRADD,1504,"E"))
"RTN","SROESPR1",120,0)
 S SIGNMODE=$G(^TMP("SRLQ",$J,SRDA,"ZADD",SRADD,1505,"I"))_";"_$G(^("E"))
"RTN","SROESPR1",121,0)
 S COSGDATE=$G(^TMP("SRLQ",$J,SRDA,"ZADD",SRADD,1507,"I"))
"RTN","SROESPR1",122,0)
 S COSGEDBY=$G(^TMP("SRLQ",$J,SRDA,"ZADD",SRADD,1508,"I"))_";"_$G(^("E"))
"RTN","SROESPR1",123,0)
 S COSGNAME=$G(^TMP("SRLQ",$J,SRDA,"ZADD",SRADD,1509,"E"))
"RTN","SROESPR1",124,0)
 S COSGTITL=$G(^TMP("SRLQ",$J,SRDA,"ZADD",SRADD,1510,"E"))
"RTN","SROESPR1",125,0)
 S COSGMODE=$G(^TMP("SRLQ",$J,SRDA,"ZADD",SRADD,1511,"I"))_";"_$G(^("E"))
"RTN","SROESPR1",126,0)
 S SRY=11
"RTN","SROESPR1",127,0)
SIGBLK N SRGROOT S SRGROOT=$NA(^TMP("SRLQ",$J,SRDA))
"RTN","SROESPR1",128,0)
 I '+SIGNDATE W !,"**DRAFT COPY - DRAFT COPY -- ABOVE NOTE IS UNSIGNED--"
"RTN","SROESPR1",129,0)
 I  W " DRAFT COPY - DRAFT COPY**",! D SETCONT() Q:'SRCONT
"RTN","SROESPR1",130,0)
 I SIGNEDBY]"",(+SIGNEDBY'=+AUTHOR)  D
"RTN","SROESPR1",131,0)
 . W ?21,"Author:      ",$P(AUTHOR,";",2),!
"RTN","SROESPR1",132,0)
 I +SIGNDATE D SETCONT() Q:'SRCONT  D
"RTN","SROESPR1",133,0)
 . W ?18,"Signed by:",$S($P(SIGNMODE,";")="C":" /s/  ",1:" /es/ "),?34,$S(SIGNNAME]"":SIGNNAME,1:$P(SIGNEDBY,";",2))
"RTN","SROESPR1",134,0)
 . W !?34,SIGTITL
"RTN","SROESPR1",135,0)
 . I $L(SIGTITL)>30 W !?34
"RTN","SROESPR1",136,0)
 . E  W " "
"RTN","SROESPR1",137,0)
 . W $$DATE^SROESPR(+SIGNDATE,"MM/DD/CCYY HR:MIN")
"RTN","SROESPR1",138,0)
 . I '+$G(SRFLAG)!($E(IOST)="C") D
"RTN","SROESPR1",139,0)
 . . I $P($$BEEP^SROESPR(+SIGNEDBY),U) W !?34,"Analog Pager:  ",$P($$BEEP^SROESPR(+SIGNEDBY),U)
"RTN","SROESPR1",140,0)
 . . I $P($$BEEP^SROESPR(+SIGNEDBY),U,2) W !?34,"Digital Pager: ",$P($$BEEP^SROESPR(+SIGNEDBY),U,2)
"RTN","SROESPR1",141,0)
 I $G(^TMP("SRLQ",$J,SRDA,.05,"E"))="UNCOSIGNED" D
"RTN","SROESPR1",142,0)
 . W !?34,"**REQUIRES COSIGNATURE**",!
"RTN","SROESPR1",143,0)
 I +SIGCHRT,$P(SIGNMODE,";")="C" D SETCONT() Q:'SRCONT  D
"RTN","SROESPR1",144,0)
 . W !?2,"Marked signed on chart by:",?34,$P(SIGCHRT,";",2)
"RTN","SROESPR1",145,0)
 I +$G(SRADD) S SRGROOT=$NA(^TMP("SRLQ",$J,SRDA,"ZADD",SRADD))
"RTN","SROESPR1",146,0)
 I +$D(@SRGROOT@("EXTRASGNR")) D
"RTN","SROESPR1",147,0)
 . N SRI S SRI=0
"RTN","SROESPR1",148,0)
 . D SETCONT() Q:'SRCONT  W !?4,"Receipt Acknowledged By:"
"RTN","SROESPR1",149,0)
 . F  S SRI=$O(@SRGROOT@("EXTRASGNR",SRI)) Q:'SRI  D
"RTN","SROESPR1",150,0)
 . . I +$G(@SRGROOT@("EXTRASGNR",SRI,"DATE"))'>0 Q
"RTN","SROESPR1",151,0)
 . . I SRI>1 D SETCONT() Q:'SRCONT  W !
"RTN","SROESPR1",152,0)
 . . W ?29,"/es/ ",$G(@SRGROOT@("EXTRASGNR",SRI,"NAME"))
"RTN","SROESPR1",153,0)
 . . W !?34,$G(@SRGROOT@("EXTRASGNR",SRI,"TITLE"))
"RTN","SROESPR1",154,0)
 . . I $L($G(@SRGROOT@("EXTRASGNR",SRI,"TITLE")))>30 W !?34
"RTN","SROESPR1",155,0)
 . . E  W " "
"RTN","SROESPR1",156,0)
 . . W $$DATE^SROESPR($G(@SRGROOT@("EXTRASGNR",SRI,"DATE")),"MM/DD/CCYY HR:MIN")
"RTN","SROESPR1",157,0)
 . . I '+$G(SRFLAG)!($E(IOST)="C") D
"RTN","SROESPR1",158,0)
 . . . N BEEP
"RTN","SROESPR1",159,0)
 . . . S BEEP=$$BEEP^SROESPR(+$G(@SRGROOT@("EXTRASGNR",SRI,"EXTRA")))
"RTN","SROESPR1",160,0)
 . . . I +BEEP W !?34,"Analog Pager:  ",$P(BEEP,U)
"RTN","SROESPR1",161,0)
 . . . I +$P(BEEP,U,2) W !?34,"Digital Pager: ",$P(BEEP,U,2)
"RTN","SROESPR1",162,0)
 . K @SRGROOT@("EXTRASGNR")
"RTN","SROESPR1",163,0)
 I +COSGDATE,(+COSGEDBY'=+SIGNEDBY) D SETCONT() Q:'SRCONT  D
"RTN","SROESPR1",164,0)
 . W !?16,"Cosigned by:",$S($P(COSGMODE,";")="C":" /s/  ",1:" /es/ "),?34,$S(COSGNAME]"":COSGNAME,1:$P(COSGEDBY,";",2))
"RTN","SROESPR1",165,0)
 . W !?34,COSGTITL," "
"RTN","SROESPR1",166,0)
 . W $$DATE^SROESPR(+COSGDATE,"MM/DD/CCYY HR:MIN")
"RTN","SROESPR1",167,0)
 . I '+$G(SRFLAG)!($E(IOST)="C") D
"RTN","SROESPR1",168,0)
 . . I $P($$BEEP^SROESPR(+COSGEDBY),U) W !?34,"Analog Pager: ",$P($$BEEP^SROESPR(+COSGEDBY),U)
"RTN","SROESPR1",169,0)
 . . I $P($$BEEP^SROESPR(+COSGEDBY),U,2) W !?34,"Digital Pager:",$P($$BEEP^SROESPR(+COSGEDBY),U,2)
"RTN","SROESPR1",170,0)
 I +COSCHRT,$P(COSGMODE,";")="C" D SETCONT() Q:'SRCONT  D
"RTN","SROESPR1",171,0)
 . W !,"Marked cosigned on chart by:",?34,$P(COSCHRT,";",2)
"RTN","SROESPR1",172,0)
 W !
"RTN","SROESPR1",173,0)
 K SRCONT1
"RTN","SROESPR1",174,0)
AMEND ; signature blocks of amender
"RTN","SROESPR1",175,0)
 S SRY=4 D SETCONT() Q:'SRCONT
"RTN","SROESPR1",176,0)
 I +$G(@SRGROOT@(1601,"I")) D
"RTN","SROESPR1",177,0)
 . W !!?12,"Amendment Filed:",?34,$$DATE^SROESPR(@SRGROOT@(1601,"I"),"MM/DD/CCYY HR:MIN")
"RTN","SROESPR1",178,0)
 . I $G(@SRGROOT@(1603,"E"))']"" D
"RTN","SROESPR1",179,0)
 . . W !!?29 F SRI=1:1:40 W "_"
"RTN","SROESPR1",180,0)
 . . W !?29,$$SIGNAME^SROESPR(@SRGROOT@(1602,"I"))
"RTN","SROESPR1",181,0)
 . . W !?29,$$SIGTITL^SROESPR(@SRGROOT@(1602,"I"))
"RTN","SROESPR1",182,0)
 . I $G(@SRGROOT@(1604,"E"))]"" D
"RTN","SROESPR1",183,0)
 . . W !?29,"/es/",?34,@SRGROOT@(1604,"E")
"RTN","SROESPR1",184,0)
 . . W !?34,@SRGROOT@(1605,"E")
"RTN","SROESPR1",185,0)
 Q
"RTN","SROESPR1",186,0)
SETCONT(SRHEAD) ;Does footer and sets SRCONT
"RTN","SROESPR1",187,0)
 S SRCONT=$$FOOTER^SROESPR2(.SRFOOT,SRFLAG,SRPFNBR,$G(SRHEAD),$G(SRCONT1),SRDA)
"RTN","SROESPR1",188,0)
 Q
"RTN","SROESPR2")
0^56^B10042548
"RTN","SROESPR2",1,0)
SROESPR2 ;BIR/ADM - SURGERY E-SIG UTILITY ; [ 06/25/02  04:09 PM ]
"RTN","SROESPR2",2,0)
 ;;3.0; Surgery ;**100**;24 Jun 93
"RTN","SROESPR2",3,0)
 ;
"RTN","SROESPR2",4,0)
 ;** NOTICE: This routine is part of an implementation of a nationally
"RTN","SROESPR2",5,0)
 ;**         controlled procedure.  Local modifications to this routine
"RTN","SROESPR2",6,0)
 ;**         are prohibited.
"RTN","SROESPR2",7,0)
 ;
"RTN","SROESPR2",8,0)
 ; This routine was cloned in part or in whole from TIUPRPN2.
"RTN","SROESPR2",9,0)
FOOTER(SRFOOT,SRFLAG,SRPFNBR,SRHDR,SRCONT1,SRDA) ; Control Pagination
"RTN","SROESPR2",10,0)
 ; position, write footer when appropriate
"RTN","SROESPR2",11,0)
 ; IF SRHDR=1, HEADER WILL NOT BE PRINTED
"RTN","SROESPR2",12,0)
 S SRCONT=1
"RTN","SROESPR2",13,0)
 I $E(IOST)="C" G FOOTX:$Y+3<IOSL S SRCONT=$$STOP G FOOTW
"RTN","SROESPR2",14,0)
 G FTR:+$G(SRHDR)
"RTN","SROESPR2",15,0)
 G:$Y+7<IOSL FOOTX
"RTN","SROESPR2",16,0)
FTR I (IOT'="HFS")!(IOSL<250) F  Q:$Y+6'<IOSL  W ! ;moves ftr to pg bottom
"RTN","SROESPR2",17,0)
 N SRFNUM,SRLINE,LOC,DIV,SRDIV,SRDIVI,SRPRTDT,SRPRTNM,SRNOW,SRCASE
"RTN","SROESPR2",18,0)
 S $P(SRLINE,"-",81)=""
"RTN","SROESPR2",19,0)
 W ?21,$S(+$G(SRCONT1):"** THIS NOTE CONTINUED ON NEXT PAGE **",1:""),!
"RTN","SROESPR2",20,0)
 I '+$G(SRFLAG) W "WORK COPY ========== UNOFFICIAL "
"RTN","SROESPR2",21,0)
 I  W "- NOT FOR MEDICAL RECORD =========== DO NOT FILE"
"RTN","SROESPR2",22,0)
 E  W SRLINE
"RTN","SROESPR2",23,0)
 W !,SRFOOT("PNMP")
"RTN","SROESPR2",24,0)
 S SRDIVI="",SRCASE=$P($G(^TMP("SRLQ",$J,SRDA,1405,"I")),";") S:SRCASE DIV=$$SITE^SROUTL0(SRCASE) I DIV S SRDIV=$P(^SRO(133,DIV,0),"^"),SRDIVI=$$EXTERNAL^DILFD(133,.01,"",SRDIV)
"RTN","SROESPR2",25,0)
 I SRDIVI="",$G(^TMP("SRLQ",$J,SRDA,1205,"I")) S LOC=+^("I") D
"RTN","SROESPR2",26,0)
 .S SRDIV=+$P($G(^SC(LOC,0)),U,4) I SRDIV S SRDIVI=$$GET1^DIQ(4,SRDIV,.01)
"RTN","SROESPR2",27,0)
 S SRPRTNM=$S($G(SRDIVI)]"":SRDIVI,$G(SRFOOT("INTNM"))]"":SRFOOT("INTNM"),1:SRFOOT("SITE"))
"RTN","SROESPR2",28,0)
 S SRNOW=$$NOW^XLFDT,SRPRTDT="Printed:"_$$DATE^SROESPR(SRNOW,"MM/DD/CCYY HR:MIN")
"RTN","SROESPR2",29,0)
 I $L(SRPRTNM)<36 D
"RTN","SROESPR2",30,0)
 . W ?(80-$L(SRPRTNM)\2),SRPRTNM,?56,SRPRTDT
"RTN","SROESPR2",31,0)
 ELSE  D
"RTN","SROESPR2",32,0)
 . W ?58,SRPRTDT,!?(80-$L(SRPRTNM)\2),SRPRTNM
"RTN","SROESPR2",33,0)
 W !,SRFOOT("SSN")," ",SRFOOT("DOB"),?(80-$L(SRFOOT("LOCP"))\2),SRFOOT("LOCP")
"RTN","SROESPR2",34,0)
 I +$G(SRFLAG) W ?(80-$L(SRPFNBR)),SRPFNBR
"RTN","SROESPR2",35,0)
 I '+$G(SRFLAG) W ?(80-$L(SRFOOT("PH#"))),SRFOOT("PH#")
"RTN","SROESPR2",36,0)
 I +$G(SRFLAG) W !,SRLINE
"RTN","SROESPR2",37,0)
 E  W !,"=========================== CONFIDENTIAL INFORMATION ==========================="
"RTN","SROESPR2",38,0)
 W @IOF
"RTN","SROESPR2",39,0)
FOOTW I '+$G(SRHDR),+$G(SRCONT) D HEADER(.SRFOOT,SRFLAG,.SRPFHDR,.SRCONT1)
"RTN","SROESPR2",40,0)
FOOTX ;
"RTN","SROESPR2",41,0)
 Q SRCONT
"RTN","SROESPR2",42,0)
HEADER(SRFOOT,SRFLAG,SRPFHDR,SRCONT1) ; Header
"RTN","SROESPR2",43,0)
 N SRLINE S $P(SRLINE,"-",81)="",SROPAGE=+$G(SROPAGE)+1
"RTN","SROESPR2",44,0)
 I $E(IOST)="C" D
"RTN","SROESPR2",45,0)
 .W @IOF,!,?71,"Page: ",$J(SROPAGE,2)
"RTN","SROESPR2",46,0)
 .W !,SRLINE,!,SRFOOT("PNMP")_"  "_SRFOOT("SSN")
"RTN","SROESPR2",47,0)
 .W ?(78-$L(SRPFHDR)),SRPFHDR,!,SRLINE,!
"RTN","SROESPR2",48,0)
 .I +$G(SRCONT1) W $$DATE^SROESPR(^TMP("SRLQ",$J,SRDA,1301,"I"),"MM/DD/CCYY HR:MIN"),?21,"** CONTINUED FROM PREVIOUS SCREEN **",!
"RTN","SROESPR2",49,0)
 E  D
"RTN","SROESPR2",50,0)
 .W !?71,"Page: ",$J(SROPAGE,2)
"RTN","SROESPR2",51,0)
 .W !,SRLINE,!,$S('+$G(SRFLAG):"** WORK COPY - NOT FOR ",1:"")
"RTN","SROESPR2",52,0)
 .W "MEDICAL RECORD" W:'+$G(SRFLAG) " **" W ?(80-$L(SRPFHDR)),SRPFHDR
"RTN","SROESPR2",53,0)
 .W !,SRLINE,!
"RTN","SROESPR2",54,0)
 .I +$G(SRCONT1) W $$DATE^SROESPR(^TMP("SRLQ",$J,SRDA,1301,"I"),"MM/DD/CCYY HR:MIN"),?21,"** CONTINUED FROM PREVIOUS PAGE **",!!
"RTN","SROESPR2",55,0)
 K SRCONT1
"RTN","SROESPR2",56,0)
 Q
"RTN","SROESPR2",57,0)
STOP() ;on screen paging check
"RTN","SROESPR2",58,0)
 ; quits SRCONT=1 if cont. ELSE quits SRCONT=0
"RTN","SROESPR2",59,0)
 N DIR,Y
"RTN","SROESPR2",60,0)
 S DIR(0)="E" D ^DIR
"RTN","SROESPR2",61,0)
 S SRCONT=Y
"RTN","SROESPR2",62,0)
 Q SRCONT
"RTN","SROESTV")
0^57^B12480052
"RTN","SROESTV",1,0)
SROESTV ;BIR/ADM - SURGERY E-SIG UTILITY ; [ 03/02/04  8:03 AM ]
"RTN","SROESTV",2,0)
 ;;3.0; Surgery ;**100**;24 Jun 93
"RTN","SROESTV",3,0)
 ;
"RTN","SROESTV",4,0)
 ;** NOTICE: This routine is part of an implementation of a nationally
"RTN","SROESTV",5,0)
 ;**         controlled procedure.  Local modifications to this routine
"RTN","SROESTV",6,0)
 ;**         are prohibited.
"RTN","SROESTV",7,0)
 ;
"RTN","SROESTV",8,0)
 ; Reference to GETDOCS^TIUSRVLR supported by DBIA #3536
"RTN","SROESTV",9,0)
 ;
"RTN","SROESTV",10,0)
 Q
"RTN","SROESTV",11,0)
LIST(SRG,SRDFN,SRSDT,SREDT,SRMAX,SRLDOC) ; return list of completed cases between start and end dates in reverse chronological order
"RTN","SROESTV",12,0)
 ;
"RTN","SROESTV",13,0)
 ; SRG    - return array
"RTN","SROESTV",14,0)
 ; SRDFN  - pointer to patient file (DFN)
"RTN","SROESTV",15,0)
 ; SRSDT  - (optional) start date (earlier date)
"RTN","SROESTV",16,0)
 ; SREDT  - (optional) end date (later date)
"RTN","SROESTV",17,0)
 ; SRMAX  - (optional) maximum number of case to return
"RTN","SROESTV",18,0)
 ; SRLDOC - (optional) flag to list documents (1) or not (0) (default is 1, list documents)
"RTN","SROESTV",19,0)
 ;
"RTN","SROESTV",20,0)
 N SRCNT,SRDATE,SREXT,SRFLG,SROP,SRPROV,SRSTOP,SRSDATE,SRQ
"RTN","SROESTV",21,0)
 S:'$L($G(SRG)) SRG="^TMP(""SRLIST"",$J)" K @SRG
"RTN","SROESTV",22,0)
 S:'$L($G(SRSDT)) SRSDT=0 S:'$L($G(SREDT)) SREDT=DT S:'$L($G(SRMAX)) SRMAX=""
"RTN","SROESTV",23,0)
 S (SRCNT,SRQ)=0,X=SREDT+.9999,SRDATE=9999999.9999-X,X=SRSDT-.0001,SRSTOP=9999999.9999-X
"RTN","SROESTV",24,0)
 S:$G(SRLDOC)'=0 SRLDOC=1
"RTN","SROESTV",25,0)
 F  S SRDATE=$O(^SRF("ADT",SRDFN,SRDATE)) Q:'SRDATE!(SRDATE'<SRSTOP)!SRQ  D
"RTN","SROESTV",26,0)
 .S SROP=0 F  S SROP=$O(^SRF("ADT",SRDFN,SRDATE,SROP)) Q:'SROP!SRQ  D
"RTN","SROESTV",27,0)
 ..I SRMAX,SRCNT'<SRMAX S SRQ=1 Q
"RTN","SROESTV",28,0)
 ..S SRFLG=1 D CASE
"RTN","SROESTV",29,0)
 Q
"RTN","SROESTV",30,0)
ONE(SRG,SROP) ; return documents associated with a single case
"RTN","SROESTV",31,0)
 ;
"RTN","SROESTV",32,0)
 ; SRG  - return array
"RTN","SROESTV",33,0)
 ; SROP - case number in file 130
"RTN","SROESTV",34,0)
 ;
"RTN","SROESTV",35,0)
 N SRCNT,SRMAX,SRFLG
"RTN","SROESTV",36,0)
 S:'$L($G(SRG)) SRG="SRTIU" K @SRG
"RTN","SROESTV",37,0)
 S SRCNT=SROP,SRMAX="",SRFLG=0
"RTN","SROESTV",38,0)
 D CASE,DOCS
"RTN","SROESTV",39,0)
 Q
"RTN","SROESTV",40,0)
CASE ; list case info
"RTN","SROESTV",41,0)
 N SRDOC,SRNON,SRSOUT,SROPER,SRN2
"RTN","SROESTV",42,0)
 S (SRNON,SRSOUT)=0,SRN2=$G(^SRF(SROP,.2))
"RTN","SROESTV",43,0)
 I $P($G(^SRF(SROP,"NON")),"^")="Y" S SRNON=1
"RTN","SROESTV",44,0)
 I SRNON,$P($G(^SRF(SROP,"NON")),"^",5)="" Q
"RTN","SROESTV",45,0)
 I 'SRNON,'$P(SRN2,"^",12)!$P($G(^SRF(SROP,37)),"^")&'($P(SRN2,"^",4)&$P($G(^SRF(SROP,"TIU")),"^",4)) Q
"RTN","SROESTV",46,0)
 S SROPER=$P(^SRF(SROP,"OP"),"^") I SRNON S SROPER=SROPER_" (Non-OR)"
"RTN","SROESTV",47,0)
 I $P($G(^SRF(SROP,30)),"^") S SROPER="* Aborted * "_SROPER
"RTN","SROESTV",48,0)
 S X=$G(^SRF(SROP,"TIU")),SRDOC="" F I=1:1:4 S SRDOC(I)=$P(X,"^",I) I SRDOC(I) S SRDOC="+"
"RTN","SROESTV",49,0)
 S SRSDATE=$P($G(^SRF(SROP,0)),"^",9)
"RTN","SROESTV",50,0)
 I SRNON S SRPROV=$P(^SRF(SROP,"NON"),"^",6),SREXT=$$EXTERNAL^DILFD(130,123,"",SRPROV)
"RTN","SROESTV",51,0)
 I 'SRNON S SRPROV=$P($G(^SRF(SROP,.1)),"^",4),SREXT=$$EXTERNAL^DILFD(130,.14,"",SRPROV)
"RTN","SROESTV",52,0)
 S SRPROV=SRPROV_";"_SREXT S:SRFLG SRCNT=SRCNT+1
"RTN","SROESTV",53,0)
 S @SRG@(SRCNT)=SROP_"^"_SROPER_"^"_SRSDATE_"^"_SRPROV_"^"_SRDOC
"RTN","SROESTV",54,0)
 I SRFLG,SRLDOC D DOCS
"RTN","SROESTV",55,0)
 Q
"RTN","SROESTV",56,0)
DOCS ; fetch documents associated with surgical case
"RTN","SROESTV",57,0)
 N SRLB,SRNUM,SRNUMX,SRTITLE,SRTIUY,SROVP K ^TMP("SRTMP",$J)
"RTN","SROESTV",58,0)
 S SRTIUY="",SROVP=SROP_";SRF(" D GETDOCS^TIUSRVLR(SRTIUY,SROVP)
"RTN","SROESTV",59,0)
 S SRNUM=0 F  S SRNUM=$O(^TMP("TIULIST",$J,SRNUM)) Q:'SRNUM  D
"RTN","SROESTV",60,0)
 .S SRTITLE=$P(^TMP("TIULIST",$J,SRNUM),"^",2)
"RTN","SROESTV",61,0)
 .I SRTITLE["OPERATION REPORT"!(SRTITLE["PROCEDURE REPORT") S ^TMP("SRTMP",$J,1,SRNUM)=^TMP("TIULIST",$J,SRNUM) Q
"RTN","SROESTV",62,0)
 .I SRTITLE["NURSE INTRAOPERATIVE REPORT" S ^TMP("SRTMP",$J,2,SRNUM)=^TMP("TIULIST",$J,SRNUM) Q
"RTN","SROESTV",63,0)
 .I SRTITLE["ANESTHESIA REPORT" S ^TMP("SRTMP",$J,3,SRNUM)=^TMP("TIULIST",$J,SRNUM)
"RTN","SROESTV",64,0)
 S SRNUMX=1 F SRLB=1,2,3 S SRNUM=0 F  S SRNUM=$O(^TMP("SRTMP",$J,SRLB,SRNUM)) Q:'SRNUM  S @SRG@(SRCNT,SRNUMX)=^TMP("SRTMP",$J,SRLB,SRNUM),SRNUMX=SRNUMX+1
"RTN","SROESTV",65,0)
 K ^TMP("SRTMP",$J)
"RTN","SROESTV",66,0)
 Q
"RTN","SROESTV",67,0)
NON(SROP) ; determine if case is non-OR procedure
"RTN","SROESTV",68,0)
 ; returns 1 if case is non-OR procedure
"RTN","SROESTV",69,0)
 ; returns 0 if case is not non-OR procedure
"RTN","SROESTV",70,0)
 N SRNON S SRNON=0 I $P($G(^SRF(SROP,"NON")),"^")="Y" S SRNON=1
"RTN","SROESTV",71,0)
 Q SRNON
"RTN","SROESTV",72,0)
OPTOP(SROP) ; return parameter value for showing OpTop on signature
"RTN","SROESTV",73,0)
 ; 0 - never display Op Top
"RTN","SROESTV",74,0)
 N SROPTOP S SROPTOP=0
"RTN","SROESTV",75,0)
 Q SROPTOP
"RTN","SROESUTL")
0^114^B4829743
"RTN","SROESUTL",1,0)
SROESUTL ;BIR/ADM - SURGERY E-SIG UTILITY ; [ 08/17/01  2:11 PM ]
"RTN","SROESUTL",2,0)
 ;;3.0; Surgery ;**100**;24 Jun 93
"RTN","SROESUTL",3,0)
 ;
"RTN","SROESUTL",4,0)
 ;** NOTICE: This routine is part of an implementation of a nationally
"RTN","SROESUTL",5,0)
 ;**         controlled procedure.  Local modifications to this routine
"RTN","SROESUTL",6,0)
 ;**         are prohibited.
"RTN","SROESUTL",7,0)
 ;
"RTN","SROESUTL",8,0)
 ; Reference to EXTRACT^TIULQ supported by DBIA #2693
"RTN","SROESUTL",9,0)
 ;
"RTN","SROESUTL",10,0)
TIU ; get document specifics from TIU
"RTN","SROESUTL",11,0)
 D EXTRACT^TIULQ(SRTIU,"SRT",.SRERR)
"RTN","SROESUTL",12,0)
 S SRDOC=SRT(SRTIU,.01,"E"),SRCASE=$P(SRT(SRTIU,1405,"I"),";")
"RTN","SROESUTL",13,0)
 Q
"RTN","SROESUTL",14,0)
DELETE(SRTIU) ; delete action
"RTN","SROESUTL",15,0)
 N SR,SRCASE,SRDOC,SRERR,SRFLD,SRT D TIU
"RTN","SROESUTL",16,0)
 S SRFLD=$S(SRDOC["OPERATION":1000,SRDOC["NURSE INTRAOP":1001,SRDOC["PROCEDURE":1002,1:1003) D
"RTN","SROESUTL",17,0)
 .S SR=$G(^SRF(SRCASE,"TIU"))
"RTN","SROESUTL",18,0)
 .I SRFLD=1000,$P(SR,"^")=SRTIU D AT Q
"RTN","SROESUTL",19,0)
 .I SRFLD=1001,$P(SR,"^",2)=SRTIU D AT Q
"RTN","SROESUTL",20,0)
 .I SRFLD=1002,$P(SR,"^",3)=SRTIU D AT Q
"RTN","SROESUTL",21,0)
 .I SRFLD=1003,$P(SR,"^",4)=SRTIU D AT
"RTN","SROESUTL",22,0)
 Q
"RTN","SROESUTL",23,0)
AT N SRY S SRY(130,SROP_",",SRFLD)="@" D FILE^DIE("","SRY")
"RTN","SROESUTL",24,0)
 Q
"RTN","SROESUTL",25,0)
RETRACT(SRTIU) ; retraction action
"RTN","SROESUTL",26,0)
 D DELETE(SRTIU),ALERT(SRTIU)
"RTN","SROESUTL",27,0)
 Q
"RTN","SROESUTL",28,0)
ALERT(SRTIU) ; issue alert to author of document
"RTN","SROESUTL",29,0)
 N SRAUTHOR,SRDOC,SRCASE,SRERR,SRT
"RTN","SROESUTL",30,0)
 D TIU S SRAUTHOR=SRT(SRTIU,1202,"I") Q:'SRAUTHOR
"RTN","SROESUTL",31,0)
 S XQAMSG=SRDOC_" retracted on case #"_SRCASE_"."
"RTN","SROESUTL",32,0)
 S XQA(SRAUTHOR)="",XQADATA=SRCASE_"^"_SRDOC,XQAROU="ACTION^SROESUTL"
"RTN","SROESUTL",33,0)
 D SETUP^XQALERT
"RTN","SROESUTL",34,0)
 Q
"RTN","SROESUTL",35,0)
ACTION ; alert action
"RTN","SROESUTL",36,0)
 Q:'$D(XQADATA)  N DFN,SR,SRSDT,SRTN,SRDOC,SRY,VA,VADM,Y
"RTN","SROESUTL",37,0)
 S SRTN=$P(XQADATA,"^"),SRDOC=$P(XQADATA,"^",2) Q:'SRTN!(SRDOC="")
"RTN","SROESUTL",38,0)
 S SR=$G(^SRF(SRTN,0)) Q:SR=""
"RTN","SROESUTL",39,0)
 S DFN=$P(SR,"^") D DEM^VADPT S Y=$P(SR,"^",9) D DD^%DT S SRSDT=Y
"RTN","SROESUTL",40,0)
 S SRY(1)=SRDOC_" retracted on case #"_SRTN,SRY(1,"F")="!!!"
"RTN","SROESUTL",41,0)
 S SRY(2)=VADM(1)_" ("_VA("PID")_")   Op Date: "_SRSDT
"RTN","SROESUTL",42,0)
 S SRY(3)="Principal Procedure: "_$P(^SRF(SRTN,"OP"),"^"),SRY(4)=" " D EN^DDIOL(.SRY)
"RTN","SROESUTL",43,0)
 Q
"RTN","SROESUTL",44,0)
STATUS(SRTIU) ; get signature status
"RTN","SROESUTL",45,0)
 N SRT,STATUS
"RTN","SROESUTL",46,0)
 D EXTRACT^TIULQ(SRTIU,"SRT",.SRERR,".05") S STATUS=SRT(SRTIU,.05,"I")
"RTN","SROESUTL",47,0)
 Q STATUS
"RTN","SROESX")
0^58^B27478146
"RTN","SROESX",1,0)
SROESX ;BIR/ADM - SURGERY E-SIG UTILITY ; [ 02/25/04  09:21 AM ]
"RTN","SROESX",2,0)
 ;;3.0; Surgery ;**100**;24 Jun 93
"RTN","SROESX",3,0)
 ;
"RTN","SROESX",4,0)
 ;** NOTICE: This routine is part of an implementation of a nationally
"RTN","SROESX",5,0)
 ;**         controlled procedure.  Local modifications to this routine
"RTN","SROESX",6,0)
 ;**         are prohibited.
"RTN","SROESX",7,0)
 ;
"RTN","SROESX",8,0)
 ; Reference to $$WHATITLE^TIUPUTU supported by DBIA #3351
"RTN","SROESX",9,0)
 ; Reference to DELETE^TIUSRVP supported by DBIA #3535
"RTN","SROESX",10,0)
 ; Reference to MAKE^TIUSRVP supported by DBIA #3535
"RTN","SROESX",11,0)
 ; Reference to UPDATE^TIUSRVP supported by DBIA #3535
"RTN","SROESX",12,0)
 ; Reference to $$CANDEL^TIUSRVP1 supported by DBIA #4175
"RTN","SROESX",13,0)
 ;
"RTN","SROESX",14,0)
 Q
"RTN","SROESX",15,0)
AES ; set logic for AES cross-reference
"RTN","SROESX",16,0)
 N SRTN,ZTDESC,ZTRTN,ZTIO,ZTDTH,ZTSAVE,ZTSK
"RTN","SROESX",17,0)
 S SRTN=DA I $P($G(^SRF(SRTN,"NON")),"^")="Y" Q
"RTN","SROESX",18,0)
 S ZTDESC="Surgery Nurse Intraop Report Stub",ZTRTN="NR^SROESX",ZTIO="",ZTDTH=$H,ZTSAVE("SRTN")="" D ^%ZTLOAD
"RTN","SROESX",19,0)
 S ZTDESC="Surgery Operation Report Stub",ZTRTN="OR^SROESX",ZTIO="",ZTDTH=$H,ZTSAVE("SRTN")="" D ^%ZTLOAD
"RTN","SROESX",20,0)
 Q
"RTN","SROESX",21,0)
NR ; create stub entry in TIU for nurse intraop report
"RTN","SROESX",22,0)
 N DFN,DIC,SR0,SRAY,SRCIRC,SRD,SRDOC,SRLOC,SRRN,SRTIU,SRV,SRX,TITLE,VDT,VLOC,VSIT,VSTR,X,Y
"RTN","SROESX",23,0)
 I '$P($G(^SRF(SRTN,.2)),"^",12) D END Q
"RTN","SROESX",24,0)
 S SRD=$P($G(^SRF(SRTN,"TIU")),"^",2) I SRD D END Q
"RTN","SROESX",25,0)
 S SRX=$$WHATITLE^TIUPUTU("NURSE INTRAOPERATIVE REPORT"),TITLE=$P(SRX,"^") I 'TITLE Q
"RTN","SROESX",26,0)
 S SRDIV=$$SITE^SROUTL0(SRTN),SR0=^SRF(SRTN,0),DFN=$P(SR0,"^") D LOC
"RTN","SROESX",27,0)
 S SRAY(.02)=DFN,SRAY(.05)=1,SRAY(1205)=SRLOC,SRAY(1301)=$P(SR0,"^",9),SRAY(1405)=SRTN_";SRF(",SRAY(1701)="Case #: "_SRTN
"RTN","SROESX",28,0)
 S X=$G(^SRF(SRTN,.2)),SRAY(.07)=$P(X,"^",10),SRAY(.08)=$P(X,"^",12)
"RTN","SROESX",29,0)
 S VDT=$P(SR0,"^",9),VSIT=$P(SR0,"^",15),VLOC=""
"RTN","SROESX",30,0)
 I 'VSIT S VLOC=SRLOC
"RTN","SROESX",31,0)
 I VLOC S SRAY(1211)=VLOC,VSTR=VLOC_";"_VDT_";"_$S(+$D(^DPT(DFN,.1)):"I",1:"E")
"RTN","SROESX",32,0)
 S SRCIRC="",SRRN=$O(^SRF(SRTN,19,0)) S:SRRN SRCIRC=$P($G(^SRF(SRTN,19,SRRN,0)),"^") S (SRAY(1202),SRAY(1204))=SRCIRC
"RTN","SROESX",33,0)
 D MAKE^TIUSRVP(.SRTIU,DFN,TITLE,VDT,VLOC,VSIT,.SRAY,$G(VSTR),1,1) I SRTIU D
"RTN","SROESX",34,0)
 .F  L +^SRF("TIU"_SRTN):5 I $T S $P(^SRF(SRTN,"TIU"),"^",2)=SRTIU L -^SRF("TIU"_SRTN) Q
"RTN","SROESX",35,0)
 .D ALERT
"RTN","SROESX",36,0)
END I $D(ZTQUEUED) S ZTREQ="@"
"RTN","SROESX",37,0)
 Q
"RTN","SROESX",38,0)
LOC ; get patient location
"RTN","SROESX",39,0)
 N SRDEF,SROR,SRT,SRWARD,VAIP,X,Y
"RTN","SROESX",40,0)
 S VAIP("D")=$P(SR0,"^",9) D IN5^VADPT
"RTN","SROESX",41,0)
 S (SRDEF,SRLOC)="",SRWARD=$P(VAIP(5),"^"),SROR=$P(SR0,"^",2) I SROR S SROR=$P(^SRS(SROR,0),"^")
"RTN","SROESX",42,0)
 I SRWARD K DA,DIC,DIQ,DR S DA=SRWARD,DIC=42,DR="44",DIQ="SRT",DIQ(0)="I" D EN^DIQ1 K DA,DIC,DIQ,DR S SRLOC=$G(SRT(42,SRWARD,44,"I"))
"RTN","SROESX",43,0)
 S SRDEF=$P($G(^SRO(133,SRDIV,0)),"^",23)
"RTN","SROESX",44,0)
 I SRDEF="" S X="SURGERY OP REPORT NON-COUNT",DIC(0)="M",DIC="^SC(" D ^DIC K DIC I +Y>0 S SRDEF=+Y
"RTN","SROESX",45,0)
 S SRLOC=$S(SRLOC:SRLOC,SRDEF:SRDEF,SROR:SROR,1:"")
"RTN","SROESX",46,0)
 Q
"RTN","SROESX",47,0)
ALERT ; issue alert to circulating nurse(s)
"RTN","SROESX",48,0)
 S XQAID="SRNIR-"_SRTN,XQAKILL=0 D DELETEA^XQALERT K XQAID,XQAKILL
"RTN","SROESX",49,0)
 N DFN,SRNM,SRRN,SRX S SRRN=0 F  S SRRN=$O(^SRF(SRTN,19,SRRN)) Q:'SRRN  S SRX=$P($G(^SRF(SRTN,19,SRRN,0)),"^") I SRX S XQA(SRX)=""
"RTN","SROESX",50,0)
 I '$D(XQA) S XQA(DUZ)=""
"RTN","SROESX",51,0)
 S DFN=$P(^SRF(SRTN,0),"^") D DEM^VADPT S SRNM=$E($P(VADM(1),"^"),1,15)_" ("_$E($P(VADM(1),"^"))_VA("BID")_"): "
"RTN","SROESX",52,0)
 S SRLAB=SRNM_$E($P(^SRF(SRTN,"OP"),"^"),1,25)_" (NIR ready to complete)"
"RTN","SROESX",53,0)
 S XQAMSG=SRLAB,XQAROU="ACTION^SROESX",XQAID="SRNIR-"_SRTN,XQADATA=SRTN D SETUP^XQALERT
"RTN","SROESX",54,0)
 Q
"RTN","SROESX",55,0)
STATUS(SRSTAT) ; update status
"RTN","SROESX",56,0)
 K SRAY S SRAY(.05)=SRSTAT D UPDATE^TIUSRVP(.SRDOC,SRTIU,.SRAY,1)
"RTN","SROESX",57,0)
 Q
"RTN","SROESX",58,0)
OR ; create stub entry in TIU for Operation Report
"RTN","SROESX",59,0)
 N DFN,DIC,SR0,SRACODE,SRATT,SRAY,SRD,SRDIV,SRDOC,SRLOC,SRSURG,SRTIU,SRV,SRX,TITLE,VDT,VLOC,VSIT,VSTR,X,Y
"RTN","SROESX",60,0)
 I '$P($G(^SRF(SRTN,.2)),"^",12) D END Q
"RTN","SROESX",61,0)
 S SRD=$P($G(^SRF(SRTN,"TIU")),"^") I SRD D END Q
"RTN","SROESX",62,0)
 S SRX=$$WHATITLE^TIUPUTU("OPERATION REPORT"),TITLE=$P(SRX,"^") I 'TITLE Q
"RTN","SROESX",63,0)
 S SRDIV=$$SITE^SROUTL0(SRTN),SR0=^SRF(SRTN,0),DFN=$P(SR0,"^") D LOC
"RTN","SROESX",64,0)
 S X=$G(^SRF(SRTN,.1)),SRATT=$P(X,"^",13),SRSURG=$P(X,"^",4),SRACODE=$P(X,"^",16)
"RTN","SROESX",65,0)
 I 'SRATT D
"RTN","SROESX",66,0)
 .I SRACODE=0 S SRATT=SRSURG Q
"RTN","SROESX",67,0)
 .I SRDIV,'$P(^SRO(133,SRDIV,0),"^",19) S SRATT=SRSURG
"RTN","SROESX",68,0)
 S SRAY(.02)=DFN,SRAY(.05)=1,(SRAY(1202),SRAY(1204))=SRSURG,SRAY(1205)=SRLOC,(SRAY(1208),SRAY(1209))=SRATT,SRAY(1301)=$P(SR0,"^",9),SRAY(1405)=SRTN_";SRF(",SRAY(1701)="Case #: "_SRTN
"RTN","SROESX",69,0)
 S X=$G(^SRF(SRTN,.2)),SRAY(.07)=$P(X,"^",10),SRAY(.08)=$P(X,"^",12)
"RTN","SROESX",70,0)
 S VDT=$P(SR0,"^",9),VSIT=$P(SR0,"^",15),VLOC=""
"RTN","SROESX",71,0)
 I 'VSIT S VLOC=SRLOC
"RTN","SROESX",72,0)
 I VLOC S SRAY(1211)=VLOC,VSTR=VLOC_";"_VDT_";"_$S(+$D(^DPT(DFN,.1)):"I",1:"E")
"RTN","SROESX",73,0)
 D MAKE^TIUSRVP(.SRTIU,DFN,TITLE,VDT,VLOC,VSIT,.SRAY,$G(VSTR),1,1) I SRTIU D
"RTN","SROESX",74,0)
 .F  L +^SRF("TIU"_SRTN):5 I $T S $P(^SRF(SRTN,"TIU"),"^")=SRTIU L -^SRF("TIU"_SRTN) Q
"RTN","SROESX",75,0)
 D END
"RTN","SROESX",76,0)
 Q
"RTN","SROESX",77,0)
KAES ; kill logic for the AES cross-reference
"RTN","SROESX",78,0)
 N SRTN,ZTDESC,ZTRTN,ZTIO,ZTDTH,ZTSAVE,ZTSK S SRTN=DA
"RTN","SROESX",79,0)
 F SRI=1,2 S ZTDESC="Surgery "_$S(SRI=2:"Nurse Intraop",1:"Op")_" Report Delete Stub",ZTRTN="KSTUB^SROESX",ZTIO="",ZTDTH=$H,(ZTSAVE("SRTN"),ZTSAVE("SRI"))="" D ^%ZTLOAD
"RTN","SROESX",80,0)
 Q
"RTN","SROESX",81,0)
KSTUB ; delete stubs in TIU for unsigned nurse intraop & op reports
"RTN","SROESX",82,0)
 N SRERR,SRODA,SRTIU
"RTN","SROESX",83,0)
 S SRODA=SRTN,SRTIU=$P($G(^SRF(SRTN,"TIU")),"^",SRI) I SRTIU D
"RTN","SROESX",84,0)
 .D STATUS(5)
"RTN","SROESX",85,0)
 .D DELETE^TIUSRVP(.SRERR,SRTIU,,1) I 'SRERR D
"RTN","SROESX",86,0)
 ..F  L +^SRF("TIU"_SRTN):5 I $T S $P(^SRF(SRTN,"TIU"),"^",SRI)="" L -^SRF("TIU"_SRTN) Q
"RTN","SROESX",87,0)
 D DELRT,END
"RTN","SROESX",88,0)
 Q
"RTN","SROESX",89,0)
ACTION ; alert action
"RTN","SROESX",90,0)
 N SRALRT,SRTN K XQAKILL S SRTN=XQADATA,SRALRT=1 D ^SRONIN
"RTN","SROESX",91,0)
 S SRTIU=$P($G(^SRF(SRTN,"TIU")),"^",2) I SRTIU,$$STATUS^SROESUTL(SRTIU)=7 D DELRT
"RTN","SROESX",92,0)
 Q
"RTN","SROESX",93,0)
DELRT N XQAID,XQAKILL S XQAID="SRNIR-"_SRTN,XQAKILL=0 D DELETEA^XQALERT
"RTN","SROESX",94,0)
 Q
"RTN","SROESX",95,0)
DEL(SRTN,SP) ; check document status to determine if OK to delete/edit field
"RTN","SROESX",96,0)
 ; SRTN - surgery case ien
"RTN","SROESX",97,0)
 ; SP   - piece number in ^SRF(SRTN,"TIU"), comma delimited if multiple pieces
"RTN","SROESX",98,0)
 ;
"RTN","SROESX",99,0)
 N FLG,II,SRTIU,PCE S FLG=0
"RTN","SROESX",100,0)
 S SRTIU=$G(^SRF(SRTN,"TIU")) F II=1:1:$L(SP,",") S PCE=$P(SP,",",II) I $P(SRTIU,"^",PCE) I $$CANDEL^TIUSRVP1($P(SRTIU,"^",PCE))=0 S FLG=1
"RTN","SROESX",101,0)
 Q FLG
"RTN","SROESX0")
0^120^B12202497
"RTN","SROESX0",1,0)
SROESX0 ;BIR/ADM - SURGERY E-SIG UTILITY ; [ 02/13/02  12:03 PM ]
"RTN","SROESX0",2,0)
 ;;3.0; Surgery ;**100**;24 Jun 93
"RTN","SROESX0",3,0)
 ;
"RTN","SROESX0",4,0)
 ;** NOTICE: This routine is part of an implementation of a nationally
"RTN","SROESX0",5,0)
 ;**         controlled procedure.  Local modifications to this routine
"RTN","SROESX0",6,0)
 ;**         are prohibited.
"RTN","SROESX0",7,0)
 ;
"RTN","SROESX0",8,0)
 ; Reference to UPDATE^TIUSRVP supported by DBIA #3535
"RTN","SROESX0",9,0)
 ; Reference to EXTRACT^TIULQ supported by DBIA #2693
"RTN","SROESX0",10,0)
 ; Reference to FILE^TIUSRVP supported by DBIA #3540
"RTN","SROESX0",11,0)
 ;
"RTN","SROESX0",12,0)
 Q
"RTN","SROESX0",13,0)
SET ; set logic for AES1 and AES2 x-refs
"RTN","SROESX0",14,0)
 N SRPHY,SRSTAT,SRTN,SRTIU,SRX,ZTDESC,ZTRTN,ZTIO,ZTDTH,ZTSAVE,ZTSK
"RTN","SROESX0",15,0)
 S SRPHY=X2 D NEXT Q:'SRTIU
"RTN","SROESX0",16,0)
TASK ; task call to TIU
"RTN","SROESX0",17,0)
 S ZTDESC="Update Signer in TIU",ZTRTN="SIGNER^SROESX0",ZTIO="",ZTDTH=$H,(ZTSAVE("SRTIU"),ZTSAVE("SRPHY"))="" D ^%ZTLOAD
"RTN","SROESX0",18,0)
 Q
"RTN","SROESX0",19,0)
SIGNER ; make call to TIU to update author and expected signer
"RTN","SROESX0",20,0)
 D STATUS S SRAY(.05)=$S(SRSTAT:SRSTAT,1:1),(SRAY(1202),SRAY(1204))=SRPHY
"RTN","SROESX0",21,0)
 D UPDATE^TIUSRVP(.SRDOC,SRTIU,.SRAY,1)
"RTN","SROESX0",22,0)
END I $D(ZTQUEUED) S ZTREQ="@"
"RTN","SROESX0",23,0)
 Q
"RTN","SROESX0",24,0)
NEXT S SRTN=DA,SRX=$G(^SRF(SRTN,"TIU"))
"RTN","SROESX0",25,0)
 S SRTIU=$S($P($G(^SRF(SRTN,"NON")),"^")="Y":$P(SRX,"^",3),1:$P(SRX,"^"))
"RTN","SROESX0",26,0)
 Q
"RTN","SROESX0",27,0)
STATUS ; get TIU document status
"RTN","SROESX0",28,0)
 D EXTRACT^TIULQ(SRTIU,"SRY",.SRERR,".05",1) S SRSTAT=$G(SRY(SRTIU,.05,"I"))
"RTN","SROESX0",29,0)
 Q
"RTN","SROESX0",30,0)
SET1 ; set logic for AES3 and AES4 and x-refs
"RTN","SROESX0",31,0)
 N SRPHY,SRSTAT,SRTN,SRTIU,SRX,ZTDESC,ZTRTN,ZTIO,ZTDTH,ZTSAVE,ZTSK
"RTN","SROESX0",32,0)
 S SRPHY=X2 D NEXT Q:'SRTIU
"RTN","SROESX0",33,0)
TASK1 ; task call to TIU
"RTN","SROESX0",34,0)
 S ZTDESC="Update Cosigner in TIU",ZTRTN="COSIG^SROESX0",ZTIO="",ZTDTH=$H,(ZTSAVE("SRTIU"),ZTSAVE("SRPHY"))="" D ^%ZTLOAD
"RTN","SROESX0",35,0)
 Q
"RTN","SROESX0",36,0)
COSIG ; make call to TIU to update attending and expected cosigner
"RTN","SROESX0",37,0)
 D STATUS S SRAY(.05)=$S(SRSTAT:SRSTAT,1:1),(SRAY(1208),SRAY(1209))=SRPHY
"RTN","SROESX0",38,0)
 D UPDATE^TIUSRVP(.SRDOC,SRTIU,.SRAY,1) D END
"RTN","SROESX0",39,0)
 Q
"RTN","SROESX0",40,0)
SET2 ; set logic for AES5 x-ref
"RTN","SROESX0",41,0)
 N SRPHY,SRSTAT,SRTN,SRTIU,SRX,ZTDESC,ZTRTN,ZTIO,ZTDTH,ZTSAVE,ZTSK
"RTN","SROESX0",42,0)
 S SRPHY=X2,SRTN=DA,SRX=$G(^SRF(SRTN,"TIU")),SRTIU=$P(SRX,"^",4) Q:'SRTIU
"RTN","SROESX0",43,0)
 D TASK,ALTSK
"RTN","SROESX0",44,0)
 Q
"RTN","SROESX0",45,0)
SET3 ; set logic for AES6 x-ref
"RTN","SROESX0",46,0)
 N SRPHY,SRSTAT,SRTN,SRTIU,SRX,ZTDESC,ZTRTN,ZTIO,ZTDTH,ZTSAVE,ZTSK
"RTN","SROESX0",47,0)
 S SRPHY=X2,SRTN=DA,SRX=$G(^SRF(SRTN,"TIU")),SRTIU=$P(SRX,"^",4) Q:'SRTIU
"RTN","SROESX0",48,0)
 D TASK1
"RTN","SROESX0",49,0)
ALTSK S ZTDESC="Task Alerts to Anesthesia",ZTRTN="ANLRT^SROESX0",ZTIO="",ZTDTH=$H,(ZTSAVE("SRTIU"),ZTSAVE("SRTN"))="" D ^%ZTLOAD
"RTN","SROESX0",50,0)
 Q
"RTN","SROESX0",51,0)
ANLRT ; for anesthesia report, delete and re-issue alert
"RTN","SROESX0",52,0)
 N SRSTAT D STATUS I SRSTAT=1 D ALERT^SROESXA,END
"RTN","SROESX0",53,0)
 Q
"RTN","SROESX0",54,0)
SET4 ; set logic for AES7 x-ref
"RTN","SROESX0",55,0)
 N SRTN,SRTIU,SRX,ZTDESC,ZTRTN,ZTIO,ZTDTH,ZTSAVE,ZTSK
"RTN","SROESX0",56,0)
 S SRTN=DA(1),SRX=$G(^SRF(SRTN,"TIU")),SRTIU=$P(SRX,"^",2) Q:'SRTIU
"RTN","SROESX0",57,0)
 S ZTDESC="Update Nurse Report Signer in TIU",ZTRTN="RNSIG^SROESX0",ZTIO="",ZTDTH=$H,(ZTSAVE("SRTIU"),ZTSAVE("SRTN"))="" D ^%ZTLOAD
"RTN","SROESX0",58,0)
 S ZTDESC="Task Alerts to Circulating Nurses",ZTRTN="RNLRT^SROESX0",ZTIO="",ZTDTH=$H,(ZTSAVE("SRTIU"),ZTSAVE("SRTN"))="" D ^%ZTLOAD
"RTN","SROESX0",59,0)
 Q
"RTN","SROESX0",60,0)
RNSIG ; update signer/author of nurse report
"RTN","SROESX0",61,0)
 ; get first circulating nurse as author and expected signer
"RTN","SROESX0",62,0)
 S SRPHY="",SRRN=$O(^SRF(SRTN,19,0)) S:SRRN SRPHY=$P($G(^SRF(SRTN,19,SRRN,0)),"^")
"RTN","SROESX0",63,0)
 D SIGNER
"RTN","SROESX0",64,0)
 Q
"RTN","SROESX0",65,0)
RNLRT ; for nurse report, delete and re-issue alert
"RTN","SROESX0",66,0)
 N SRSTAT D STATUS I SRSTAT=1 D ALERT^SROESX,END
"RTN","SROESX0",67,0)
 Q
"RTN","SROESX0",68,0)
AES8 ; set logic for AES7 cross-reference
"RTN","SROESX0",69,0)
 N II,SR0,SRAY,SRTDA,SRTN,SRTIU
"RTN","SROESX0",70,0)
 S SRTN=$S($D(SRTN):SRTN,1:DA)
"RTN","SROESX0",71,0)
 S SR0=^SRF(SRTN,0),SRTIU=$G(^SRF(SRTN,"TIU")),SRAY(1301)=$P(SR0,"^",9)
"RTN","SROESX0",72,0)
 F II=1,2,3,4 I $P(SRTIU,"^",II) S SRTDA=$P(SRTIU,"^",II) D
"RTN","SROESX0",73,0)
 .D FILE^TIUSRVP(.SRERR,SRTDA,.SRAY,1)
"RTN","SROESX0",74,0)
 Q
"RTN","SROESXA")
0^59^B16202604
"RTN","SROESXA",1,0)
SROESXA ;BIR/ADM - SURGERY E-SIG UTILITY ; [ 03/02/04  09:23 AM ]
"RTN","SROESXA",2,0)
 ;;3.0; Surgery ;**100**;24 Jun 93
"RTN","SROESXA",3,0)
 ;
"RTN","SROESXA",4,0)
 ;** NOTICE: This routine is part of an implementation of a nationally
"RTN","SROESXA",5,0)
 ;**         controlled procedure.  Local modifications to this routine
"RTN","SROESXA",6,0)
 ;**         are prohibited.
"RTN","SROESXA",7,0)
 ;
"RTN","SROESXA",8,0)
 ; Reference to $$WHATITLE^TIUPUTU supported by DBIA #3351
"RTN","SROESXA",9,0)
 ; Reference to DELETE^TIUSRVP supported by DBIA #3535
"RTN","SROESXA",10,0)
 ; Reference to MAKE^TIUSRVP supported by DBIA #3535
"RTN","SROESXA",11,0)
 ; Reference to UPDATE^TIUSRVP supported by DBIA #3535
"RTN","SROESXA",12,0)
 ;
"RTN","SROESXA",13,0)
 Q
"RTN","SROESXA",14,0)
AESA ; set logic for AESA cross-reference
"RTN","SROESXA",15,0)
 N SRDIV,SRINUSE,SRTN,ZTDESC,ZTRTN,ZTIO,ZTDTH,ZTSAVE,ZTSK
"RTN","SROESXA",16,0)
 S SRTN=DA I $P($G(^SRF(SRTN,"NON")),"^")="Y" Q
"RTN","SROESXA",17,0)
 Q:'$$INUSE(SRTN)
"RTN","SROESXA",18,0)
 S ZTDESC="Surgery Anesthesia Report Stub",ZTRTN="AR^SROESXA",ZTIO="",ZTDTH=$H,ZTSAVE("SRTN")="" D ^%ZTLOAD
"RTN","SROESXA",19,0)
 Q
"RTN","SROESXA",20,0)
INUSE(SRTN) ; is anesthesia report in use at this division?
"RTN","SROESXA",21,0)
 N SRDIV,SRINUSE
"RTN","SROESXA",22,0)
 S SRINUSE=0,SRDIV=$$SITE^SROUTL0(SRTN) S:SRDIV SRINUSE=$P($G(^SRO(133,SRDIV,.1)),"^",4)
"RTN","SROESXA",23,0)
 Q SRINUSE
"RTN","SROESXA",24,0)
AR ; create stub entry in TIU for anesthesia report
"RTN","SROESXA",25,0)
 N DFN,DIC,SR0,SRATT,SRAY,SRD,SRDOC,SRLOC,SRPRIN,SRTIU,SRV,SRX,TITLE,VDT,VLOC,VSTR,VSIT,X,Y
"RTN","SROESXA",26,0)
 I '$P($G(^SRF(SRTN,.2)),"^",4) D END Q
"RTN","SROESXA",27,0)
 S SRD=$P($G(^SRF(SRTN,"TIU")),"^",4) I SRD D END Q
"RTN","SROESXA",28,0)
 S SRX=$$WHATITLE^TIUPUTU("ANESTHESIA REPORT"),TITLE=$P(SRX,"^") I 'TITLE Q
"RTN","SROESXA",29,0)
 S SRDIV=$$SITE^SROUTL0(SRTN),SR0=^SRF(SRTN,0),DFN=$P(SR0,"^") D LOC
"RTN","SROESXA",30,0)
 S X=$G(^SRF(SRTN,.3)),SRPRIN=$P(X,"^"),SRATT=$P(X,"^",4)
"RTN","SROESXA",31,0)
 S SRAY(.02)=DFN,SRAY(.05)=1,SRAY(1205)=SRLOC,SRAY(1301)=$P(SR0,"^",9),SRAY(1405)=SRTN_";SRF(",SRAY(1701)="Case #: "_SRTN
"RTN","SROESXA",32,0)
 S:SRPRIN (SRAY(1202),SRAY(1204))=SRPRIN S:SRATT (SRAY(1208),SRAY(1209))=SRATT
"RTN","SROESXA",33,0)
 S X=$G(^SRF(SRTN,.2)),SRAY(.07)=$P(X,"^",10),SRAY(.08)=$P(X,"^",12)
"RTN","SROESXA",34,0)
 S VDT=$P(SR0,"^",9),VSIT=$P(SR0,"^",15),VLOC=""
"RTN","SROESXA",35,0)
 I 'VSIT S VLOC=SRLOC
"RTN","SROESXA",36,0)
 I VLOC S SRAY(1211)=VLOC,VSTR=VLOC_";"_VDT_";"_$S(+$D(^DPT(DFN,.1)):"I",1:"E")
"RTN","SROESXA",37,0)
 D MAKE^TIUSRVP(.SRTIU,DFN,TITLE,VDT,VLOC,VSIT,.SRAY,$G(VSTR),1,1) I SRTIU D
"RTN","SROESXA",38,0)
 .F  L +^SRF("TIU"_SRTN):5 I $T S $P(^SRF(SRTN,"TIU"),"^",4)=SRTIU L -^SRF("TIU"_SRTN) Q
"RTN","SROESXA",39,0)
 .D ALERT
"RTN","SROESXA",40,0)
END S ZTREQ="@"
"RTN","SROESXA",41,0)
 Q
"RTN","SROESXA",42,0)
LOC ; get patient location
"RTN","SROESXA",43,0)
 N SRDEF,SROR,SRT,SRWARD,VAIP,X,Y
"RTN","SROESXA",44,0)
 S VAIP("D")=$P(SR0,"^",9) D IN5^VADPT
"RTN","SROESXA",45,0)
 S SRWARD=$P(VAIP(5),"^"),(SRDEF,SRLOC)="",SROR=$P(SR0,"^",2) I SROR S SROR=$P(^SRS(SROR,0),"^")
"RTN","SROESXA",46,0)
 I SRWARD K DA,DIC,DIQ,DR S DA=SRWARD,DIC=42,DR="44",DIQ="SRT",DIQ(0)="I" D EN^DIQ1 K DA,DIC,DIQ,DR S SRLOC=$G(SRT(42,SRWARD,44,"I"))
"RTN","SROESXA",47,0)
 S SRDEF=$P($G(^SRO(133,SRDIV,0)),"^",23)
"RTN","SROESXA",48,0)
 I SRDEF="" S X="SURGERY OP REPORT NON-COUNT",DIC(0)="M",DIC="^SC(" D ^DIC K DIC I +Y>0 S SRDEF=+Y
"RTN","SROESXA",49,0)
 S SRLOC=$S(SRLOC:SRLOC,SRDEF:SRDEF,SROR:SROR,1:"")
"RTN","SROESXA",50,0)
 Q
"RTN","SROESXA",51,0)
ALERT ; issue alert to anesthesia personnel
"RTN","SROESXA",52,0)
 S XQAID="SRAR-"_SRTN,XQAKILL=0 D DELETEA^XQALERT K XQAID,XQAKILL
"RTN","SROESXA",53,0)
 N X,Y,Z S X=$G(^SRF(SRTN,.3)) F Y=1,4 S Z=$P(X,"^",Y) I Z S XQA(Z)=""
"RTN","SROESXA",54,0)
 S DFN=$P(^SRF(SRTN,0),"^") D DEM^VADPT S SRNM=$E($P(VADM(1),"^"),1,15)_" ("_$E($P(VADM(1),"^"))_VA("BID")_"): "
"RTN","SROESXA",55,0)
 S SRLAB=SRNM_$E($P(^SRF(SRTN,"OP"),"^"),1,25)_" (ANES REPORT ready to complete)"
"RTN","SROESXA",56,0)
 S XQAMSG=SRLAB,XQAROU="ACTION^SROESXA",XQAID="SRAR-"_SRTN,XQADATA=SRTN D SETUP^XQALERT
"RTN","SROESXA",57,0)
 Q
"RTN","SROESXA",58,0)
STATUS(SRSTAT) ; update status
"RTN","SROESXA",59,0)
 K SRAY S SRAY(.05)=SRSTAT D UPDATE^TIUSRVP(.SRDOC,SRTIU,.SRAY,1)
"RTN","SROESXA",60,0)
 Q
"RTN","SROESXA",61,0)
KAESA ; kill logic for the AESA cross-reference
"RTN","SROESXA",62,0)
 N SRTN,ZTDESC,ZTRTN,ZTIO,ZTDTH,ZTSAVE,ZTSK S SRTN=DA
"RTN","SROESXA",63,0)
 S ZTDESC="Surgery Anesthesia Report Delete Stub",ZTRTN="KSTUB^SROESXA",ZTIO="",ZTDTH=$H,ZTSAVE("SRTN")="" D ^%ZTLOAD
"RTN","SROESXA",64,0)
 Q
"RTN","SROESXA",65,0)
KSTUB ; delete stubs in TIU for unsigned anesthesia report
"RTN","SROESXA",66,0)
 N SRERR,SRODA,SRTIU
"RTN","SROESXA",67,0)
 S SRODA=SRTN,SRTIU=$P($G(^SRF(SRTN,"TIU")),"^",4) I SRTIU D
"RTN","SROESXA",68,0)
 .D STATUS(5)
"RTN","SROESXA",69,0)
 .D DELETE^TIUSRVP(.SRERR,SRTIU,,1) I 'SRERR D
"RTN","SROESXA",70,0)
 ..F  L +^SRF("TIU"_SRTN):5 I $T S $P(^SRF(SRTN,"TIU"),"^",4)="" L -^SRF("TIU"_SRTN) Q
"RTN","SROESXA",71,0)
 D DELRT,END
"RTN","SROESXA",72,0)
 Q
"RTN","SROESXA",73,0)
ACTION ; action alert
"RTN","SROESXA",74,0)
 N SRTN,SRALRT K XQAKILL S SRTN=XQADATA,SRALRT=1 D ^SROARPT
"RTN","SROESXA",75,0)
 S SRTIU=$P($G(^SRF(SRTN,"TIU")),"^",4) I SRTIU,$$STATUS^SROESUTL(SRTIU)=7 D DELRT
"RTN","SROESXA",76,0)
 Q
"RTN","SROESXA",77,0)
DELRT N XQAID,XQAKILL S XQAID="SRAR-"_SRTN,XQAKILL=0 D DELETEA^XQALERT
"RTN","SROESXA",78,0)
 Q
"RTN","SROESXP")
0^60^B15293863
"RTN","SROESXP",1,0)
SROESXP ;BIR/ADM - SURGERY E-SIG UTILITY ; [ 02/12/04  09:30 AM ]
"RTN","SROESXP",2,0)
 ;;3.0; Surgery ;**100**;24 Jun 93
"RTN","SROESXP",3,0)
 ;
"RTN","SROESXP",4,0)
 ;** NOTICE: This routine is part of an implementation of a nationally
"RTN","SROESXP",5,0)
 ;**         controlled procedure.  Local modifications to this routine
"RTN","SROESXP",6,0)
 ;**         are prohibited.
"RTN","SROESXP",7,0)
 ;
"RTN","SROESXP",8,0)
 ; Reference to $$WHATITLE^TIUPUTU supported by DBIA #3351
"RTN","SROESXP",9,0)
 ; Reference to DELETE^TIUSRVP supported by DBIA #3535
"RTN","SROESXP",10,0)
 ; Reference to MAKE^TIUSRVP supported by DBIA #3535
"RTN","SROESXP",11,0)
 ; Reference to UPDATE^TIUSRVP supported by DBIA #3535
"RTN","SROESXP",12,0)
 ;
"RTN","SROESXP",13,0)
 Q
"RTN","SROESXP",14,0)
SCOND(X1,X2) ; set condition for AESP x-ref
"RTN","SROESXP",15,0)
 N SRADD,SRI,X1NULL,X2NULL S (X1NULL,X2NULL)=0
"RTN","SROESXP",16,0)
 F SRI=1,2 S:X1(SRI)="" X1NULL=1 S:X2(SRI)="" X2NULL=1
"RTN","SROESXP",17,0)
 I X1NULL&'X2NULL S SRADD=1
"RTN","SROESXP",18,0)
 E  S SRADD=0
"RTN","SROESXP",19,0)
 I SRADD,'X(2) S SRADD=0
"RTN","SROESXP",20,0)
 I X1(1)=X2(1),'X1(2),X2(2) S SRADD=1
"RTN","SROESXP",21,0)
 Q SRADD
"RTN","SROESXP",22,0)
KCOND(X1,X2) ; kill condition for AESP x-ref
"RTN","SROESXP",23,0)
 N SRDEL,SRI,X1NULL,X2NULL S (X1NULL,X2NULL)=0
"RTN","SROESXP",24,0)
 F SRI=1,2 S:X1(SRI)="" X1NULL=1 S:X2(SRI)="" X2NULL=1
"RTN","SROESXP",25,0)
 I X2NULL&'X1NULL S SRDEL=1
"RTN","SROESXP",26,0)
 E  S SRDEL=0
"RTN","SROESXP",27,0)
 I SRDEL,'X(2) S SRDEL=0
"RTN","SROESXP",28,0)
 I X1(1)=X2(1),'X2(2),X1(2) S SRDEL=1
"RTN","SROESXP",29,0)
 Q SRDEL
"RTN","SROESXP",30,0)
AESP ; set logic for AESP cross-reference
"RTN","SROESXP",31,0)
 N SRTN,ZTDESC,ZTRTN,ZTIO,ZTDTH,ZTSAVE,ZTSK
"RTN","SROESXP",32,0)
 S SRTN=DA I '$P($G(^SRF(SRTN,"NON")),"^",5)!'$P($G(^SRF(SRTN,"TIU")),"^",5) Q
"RTN","SROESXP",33,0)
 S ZTDESC="Surgery Non-OR Procedure Report Stub",ZTRTN="PR^SROESXP",ZTIO="",ZTDTH=$H,ZTSAVE("SRTN")="" D ^%ZTLOAD
"RTN","SROESXP",34,0)
 Q
"RTN","SROESXP",35,0)
PR ; create stub entry in TIU for non-OR procedure report
"RTN","SROESXP",36,0)
 N DFN,DIC,SR0,SRACODE,SRATT,SRAY,SRD,SRDIV,SRDOC,SRLOC,SRPROV,SRTIU,SRV,SRX,TITLE,VDT,VLOC,VSIT,VSTR,X,Y
"RTN","SROESXP",37,0)
 I '$P($G(^SRF(SRTN,"NON")),"^",5)!'$P($G(^SRF(SRTN,"TIU")),"^",5) D END Q
"RTN","SROESXP",38,0)
 S SRD=$P($G(^SRF(SRTN,"TIU")),"^",3) I SRD D END Q
"RTN","SROESXP",39,0)
 S SRX=$$WHATITLE^TIUPUTU("PROCEDURE REPORT"),TITLE=$P(SRX,"^") I 'TITLE Q
"RTN","SROESXP",40,0)
 S SRDIV=$$SITE^SROUTL0(SRTN),SR0=^SRF(SRTN,0),DFN=$P(SR0,"^") D LOC
"RTN","SROESXP",41,0)
 S X=$G(^SRF(SRTN,"NON")),SRATT=$P(X,"^",7),SRPROV=$P(X,"^",6)
"RTN","SROESXP",42,0)
 S SRACODE=$P($G(^SRF(SRTN,.1)),"^",16)
"RTN","SROESXP",43,0)
 I 'SRATT D
"RTN","SROESXP",44,0)
 .I SRACODE=0 S SRATT=SRPROV Q
"RTN","SROESXP",45,0)
 .I SRDIV,'$P(^SRO(133,SRDIV,0),"^",19) S SRATT=SRPROV
"RTN","SROESXP",46,0)
 S SRAY(.02)=DFN,SRAY(.05)=1,(SRAY(1202),SRAY(1204))=SRPROV,SRAY(1205)=SRLOC,(SRAY(1208),SRAY(1209))=SRATT,SRAY(1301)=$P(SR0,"^",9),SRAY(1405)=SRTN_";SRF(",SRAY(1701)="Case #: "_SRTN
"RTN","SROESXP",47,0)
 S (VDT,VLOC,VSIT)=""
"RTN","SROESXP",48,0)
 S (SRAY(1301),VDT)=$P($G(^SRF(SRTN,"NON")),"^",4),VSIT=$P(SR0,"^",15)
"RTN","SROESXP",49,0)
 I 'VSIT S VLOC=SRLOC
"RTN","SROESXP",50,0)
 I VLOC S SRAY(1211)=VLOC,VSTR=VLOC_";"_VDT_";"_$S(+$D(^DPT(DFN,.1)):"I",1:"E")
"RTN","SROESXP",51,0)
 D MAKE^TIUSRVP(.SRTIU,DFN,TITLE,VDT,VLOC,VSIT,.SRAY,$G(VSTR),1,1) I SRTIU D
"RTN","SROESXP",52,0)
 .F  L +^SRF("TIU"_SRTN):5 I $T S $P(^SRF(SRTN,"TIU"),"^",3)=SRTIU L -^SRF("TIU"_SRTN) Q
"RTN","SROESXP",53,0)
END S ZTREQ="@"
"RTN","SROESXP",54,0)
 Q
"RTN","SROESXP",55,0)
LOC ; get patient location
"RTN","SROESXP",56,0)
 N SRDEF,SROR,SRT,SRWARD,VAIP S VAIP("D")=$P($G(^SRF(SRTN,"NON")),"^",4) D IN5^VADPT
"RTN","SROESXP",57,0)
 S SRWARD=$P(VAIP(5),"^"),(SRDEF,SRLOC)="",SROR=$P($G(^SRF(SRTN,"NON")),"^",2)
"RTN","SROESXP",58,0)
 I SRWARD K DA,DIC,DIQ,DR S DA=SRWARD,DIC=42,DR="44",DIQ="SRT",DIQ(0)="I" D EN^DIQ1 K DA,DIC,DIQ,DR S SRLOC=$G(SRT(42,SRWARD,44,"I"))
"RTN","SROESXP",59,0)
 S SRDEF=$P($G(^SRO(133,SRDIV,0)),"^",23)
"RTN","SROESXP",60,0)
 I SRDEF="" S X="SURGERY OP REPORT NON-COUNT",DIC(0)="M",DIC="^SC(" D ^DIC K DIC I +Y>0 S SRDEF=+Y
"RTN","SROESXP",61,0)
 S SRLOC=$S(SRLOC:SRLOC,SRDEF:SRDEF,SROR:SROR,1:"")
"RTN","SROESXP",62,0)
 Q
"RTN","SROESXP",63,0)
STATUS(SRSTAT) ; update status
"RTN","SROESXP",64,0)
 K SRAY S SRAY(.05)=SRSTAT D UPDATE^TIUSRVP(.SRDOC,SRTIU,.SRAY,1)
"RTN","SROESXP",65,0)
 Q
"RTN","SROESXP",66,0)
KAESP ; kill logic for the AESP cross-reference
"RTN","SROESXP",67,0)
 N SRTN,ZTDESC,ZTRTN,ZTIO,ZTDTH,ZTSAVE,ZTSK S SRTN=DA
"RTN","SROESXP",68,0)
 S ZTDESC="Surgery Non-OR Procedure Report Delete Stub",ZTRTN="KSTUB^SROESXP",ZTIO="",ZTDTH=$H,ZTSAVE("SRTN")="" D ^%ZTLOAD
"RTN","SROESXP",69,0)
 Q
"RTN","SROESXP",70,0)
KSTUB ; delete stub in TIU for unsigned procedure report (non-OR)
"RTN","SROESXP",71,0)
 N SRERR,SRTIU
"RTN","SROESXP",72,0)
 S SRTIU=$P($G(^SRF(SRTN,"TIU")),"^",3) I SRTIU D DELETE^TIUSRVP(.SRERR,SRTIU,,1) I 'SRERR D
"RTN","SROESXP",73,0)
 .F  L +^SRF("TIU"_SRTN):5 I $T S $P(^SRF(SRTN,"TIU"),"^",3)="" L -^SRF("TIU"_SRTN) Q
"RTN","SROESXP",74,0)
 D END
"RTN","SROESXP",75,0)
 Q
"RTN","SROFILE")
0^165^B17713424
"RTN","SROFILE",1,0)
SROFILE ;B'HAM ISC/MAM - EDIT SITE CONFIGURABLE FILES ; [ 10/29/03  9:56 AM ]
"RTN","SROFILE",2,0)
 ;;3.0; Surgery ;**48,41,88,100**;24 Jun 93
"RTN","SROFILE",3,0)
START S SRO(1)="Surgery Transportation Devices^131.01",SRO(2)="Prosthesis^131.9",SRO(3)="Surgery Position^132",SRO(4)="Restraints and Positioning Aids^132.05",SRO(5)="Surgical Delay^132.4"
"RTN","SROFILE",4,0)
 S SRO(6)="Monitors^133.4",SRO(7)="Irrigations^133.6",SRO(8)="Surgery Replacement Fluids^133.7",SRO(9)="Surgery Cancellation Reason^135",SRO(10)="Skin Prep Agents^135.1"
"RTN","SROFILE",5,0)
 S SRO(11)="Skin Integrity^135.2",SRO(12)="Patient Mood^135.3",SRO(13)="Patient Consciousness^135.4",SRO(14)="Local Surgical Specialty^137.45",SRO(15)="Electroground Positions^138",SRO(16)="Surgery Disposition^131.6"
"RTN","SROFILE",6,0)
 S SRLINE="" F I=1:1:80 S SRLINE=SRLINE_"="
"RTN","SROFILE",7,0)
DISPLAY W @IOF,!,SRLINE,!,?20,"Update Site Configurable Surgery Files",!,SRLINE
"RTN","SROFILE",8,0)
 W !,"1.  Surgery Transportation Devices",!,"2.  Prosthesis",!,"3.  Surgery Positions",!,"4.  Restraints and Positional Aids"
"RTN","SROFILE",9,0)
 W !,"5.  Surgical Delay",!,"6.  Monitors",!,"7.  Irrigations",!,"8.  Surgery Replacement Fluids",!,"9.  Surgery Cancellation Reasons",!,"10. Skin Prep Agents",!,"11. Skin Integrity",!,"12. Patient Mood"
"RTN","SROFILE",10,0)
 W !,"13. Patient Consciousness",!,"14. Local Surgical Specialty",!,"15. Electroground Positions",!,"16. Surgery Dispositions",!,SRLINE
"RTN","SROFILE",11,0)
ASK W !!,"Update Information for which File ?  " R SRFILE:DTIME I '$T!("^"[SRFILE) S SRSOUT=1 G END
"RTN","SROFILE",12,0)
 I SRFILE["?" D HELP G DISPLAY
"RTN","SROFILE",13,0)
 I '$D(SRO(SRFILE)) W !!,"Enter the number corresponding to the file you want to edit.",!!,"Press RETURN to continue  " R X:DTIME G DISPLAY
"RTN","SROFILE",14,0)
 S SRFNM=$P(SRO(SRFILE),"^"),SRFNUM=$P(SRO(SRFILE),"^",2) K SRO
"RTN","SROFILE",15,0)
 W @IOF,!,"Update Information in the "_SRFNM_" file.",!,SRLINE
"RTN","SROFILE",16,0)
ENTRY W !! K DIC S (DLAYGO,DIC)=SRFNUM,DIC(0)="QEAMZL",SRF=SRFNUM
"RTN","SROFILE",17,0)
 S SRP=3 I SRF=132!(SRF=135) S SRP=4
"RTN","SROFILE",18,0)
 I SRF=132.05!(SRF=132.4)!(SRF=133.4)!(SRF=133.7) S SRP=2
"RTN","SROFILE",19,0)
 I SRF=131.9 S SRP=6
"RTN","SROFILE",20,0)
 S DIC("W")="I $P(^(0),""^"",SRP) W ""         ** INACTIVE **"""
"RTN","SROFILE",21,0)
 D ^DIC N SRHL,SRHLAD,SRHLIEN S:Y>0&((SRFILE=6)!(SRFILE=8)) SRHLIEN=+Y,SRHL=^SRO(SRF,SRHLIEN,0),SRHLAD=$P(Y,U,3) K DLAYGO I Y<0 G START
"RTN","SROFILE",22,0)
 K DR S DIE=SRFNUM,DA=+Y,DR=".01:9999" D ^DIE D:(SRFILE=6)!(SRFILE=8) SRHL K DR,DIE,DA G ENTRY
"RTN","SROFILE",23,0)
 G START
"RTN","SROFILE",24,0)
END W @IOF D ^SRSKILL
"RTN","SROFILE",25,0)
 Q
"RTN","SROFILE",26,0)
HELP W !!,"Enter the number corresponding to the file that you want to update.  For",!,"example, enter ""8"" to enter, edit, or delete information contained in",!,"the Surgery Replacement Fluids file."
"RTN","SROFILE",27,0)
 W !!,"NOTE:  File entries you do not want to use should be made inactive and",!,?7,"should NOT be deleted."
"RTN","SROFILE",28,0)
 W !!,"Press RETURN to continue  " R X:DTIME
"RTN","SROFILE",29,0)
 Q
"RTN","SROFILE",30,0)
SRHL ;HL7 master file update
"RTN","SROFILE",31,0)
 N SRENT,SRHLST,SRTBL,FEC,REC
"RTN","SROFILE",32,0)
 S FEC="UPD",SRTBL=$S(SRFILE=6:"MONITOR",SRFILE=8:"REPLACEMENT FLUID")_U_SRF_U_".01"
"RTN","SROFILE",33,0)
 S SRENT=SRHLIEN_U_^SRO(SRF,SRHLIEN,0),SRHLST=$S(SRHLAD=1:"Addition",SRHL'=SRENT:"Updating",1:"") I $G(SRHLST)'="" D
"RTN","SROFILE",34,0)
 .I $P(SRHL,U,2)="",'$P(SRHL,U,3),$P(SRENT,U,3)=1 S REC="MDC"
"RTN","SROFILE",35,0)
 .I $P(SRHL,U,2)=1,'$P(SRHL,U,3),$P(SRENT,U,3)="" S REC="MAC"
"RTN","SROFILE",36,0)
 .I $G(SRHLAD)=1 S REC="MAD"
"RTN","SROFILE",37,0)
 .D:$D(REC) MSG^SRHLMFN(SRTBL,FEC,REC,SRENT)
"RTN","SROFILE",38,0)
 .I $G(SRHLAD)=1,$P(SRENT,U,2)=1 S REC="MDC" D MSG^SRHLMFN(SRTBL,FEC,REC,SRENT)
"RTN","SROFILE",39,0)
 K SRHLIEN,SRHL,SRHLAD
"RTN","SROFILE",40,0)
 Q
"RTN","SROGMTS")
0^61^B48622963
"RTN","SROGMTS",1,0)
SROGMTS ;BIR/ADM - SURGERY HEALTH SUMMARY ; [ 08/08/01  7:12 AM ]
"RTN","SROGMTS",2,0)
 ;;3.0; Surgery ;**100**;24 Jun 93
"RTN","SROGMTS",3,0)
 ;
"RTN","SROGMTS",4,0)
 ;** NOTICE: This routine is part of an implementation of a nationally
"RTN","SROGMTS",5,0)
 ;**         controlled procedure.  Local modifications to this routine
"RTN","SROGMTS",6,0)
 ;**         are prohibited.
"RTN","SROGMTS",7,0)
 ;
"RTN","SROGMTS",8,0)
 ; Reference to $$MOD^ICPTMOD supported by DBIA #1996
"RTN","SROGMTS",9,0)
 ; Reference to $$CPT^ICPTCOD supported by DBIA #1995
"RTN","SROGMTS",10,0)
 ;
"RTN","SROGMTS",11,0)
 Q
"RTN","SROGMTS",12,0)
HS(X) ; return case information for a surical or non-OR case
"RTN","SROGMTS",13,0)
 ; X - case number (IEN) in file 130
"RTN","SROGMTS",14,0)
 K REC N SRCPTM,SRSG,DA,DR,DIC,DIQ,IEN,IENS,FILE,FLD,FLDS,FLDI
"RTN","SROGMTS",15,0)
 N FLDA,FLDB,FLDR,FLDRT,IEN,SRI,SRRT,SRT,SRS,SRC,SRCS
"RTN","SROGMTS",16,0)
 S SRCPTM=1
"RTN","SROGMTS",17,0)
 Q:'$D(^SRF(X,0))  S (IENS,IEN,X)=+($G(X)),U="^"
"RTN","SROGMTS",18,0)
 S:'$D(DT) DT=$$HTFM^XLFDT($H,1) S:'$D(DTIME) DTIME=300
"RTN","SROGMTS",19,0)
 S (FILE,DIC)=130,DA=+($G(X)),DIQ="REC(",DIQ(0)="IE"
"RTN","SROGMTS",20,0)
 S SRSG=$$SG(IEN),REC(130,IEN,118,"E")=$S(SRSG=0:"YES",1:""),REC(130,IEN,118,"I")=$S(SRSG=0:"Y",1:"")
"RTN","SROGMTS",21,0)
 S:+SRSG DR=".09;.04;.14;.164;.205;.22;.23;.31;10;15;17;26;27;32;34;36;39;43;49;50"
"RTN","SROGMTS",22,0)
 S:'SRSG DR=".09;.31;26;27;33;50;55;59;66;121;122;123;124;125"
"RTN","SROGMTS",23,0)
 D EN^DIQ1 S REC(130,IEN,"STATUS")=$$OS(IEN) S:+SRSG REC(130,IEN,"VERIFIED")=$S($G(REC(130,IEN,43,"I"))'="Y":"(Unverified)",1:"")
"RTN","SROGMTS",24,0)
 S SRM=$G(REC(130,IEN,27,"I")) I SRM>0 D
"RTN","SROGMTS",25,0)
 . S SRC=$$CPT^ICPTCOD(SRM),(SRCS,SRS)=$$EN2^SROGMTS0($P(SRC,"^",3))
"RTN","SROGMTS",26,0)
 . S REC(130,IEN,27,"X")=$P(SRC,"^",2)_"^"_$P(SRC,"^",3)
"RTN","SROGMTS",27,0)
 . S SRC=$P(SRC,"^",2),SRT=$$EN2^SROGMTS0($G(REC(130,IEN,26,"E")))
"RTN","SROGMTS",28,0)
 . S:$L(SRS)&(SRS'=SRT) SRT=SRT_" - "_SRS
"RTN","SROGMTS",29,0)
 . S:$L(SRC)=5 SRT=SRT_" (CPT "_SRC_")",SRCS=SRCS_" (CPT "_SRC_")"
"RTN","SROGMTS",30,0)
 . S REC(130,IEN,27,"N")=SRS
"RTN","SROGMTS",31,0)
 . S (REC(130,IEN,26,"S"),REC(130,IEN,27,"S"))=SRT
"RTN","SROGMTS",32,0)
 . S REC(130,IEN,27,"S")=SRCS
"RTN","SROGMTS",33,0)
 D DICT^SROGMTS0,SUB
"RTN","SROGMTS",34,0)
 S:$D(REC(130,IEN,32)) REC(130,IEN,32,"S")=$$EN2^SROGMTS0($G(REC(130,IEN,32,"E")))
"RTN","SROGMTS",35,0)
 S:$D(REC(130,IEN,33)) REC(130,IEN,33,"S")=$$EN2^SROGMTS0($G(REC(130,IEN,33,"E")))
"RTN","SROGMTS",36,0)
 S:$D(REC(130,IEN,34)) REC(130,IEN,34,"S")=$$EN2^SROGMTS0($G(REC(130,IEN,34,"E")))
"RTN","SROGMTS",37,0)
 S:$D(REC(130,IEN,.04)) REC(130,IEN,.04,"S")=$$EN2^SROGMTS0($G(REC(130,IEN,.04,"E")))
"RTN","SROGMTS",38,0)
 S:$D(REC(130,IEN,125)) REC(130,IEN,125,"S")=$$EN2^SROGMTS0($G(REC(130,IEN,125,"E")))
"RTN","SROGMTS",39,0)
 I $L($G(REC(130,IEN,33,"S"))) D
"RTN","SROGMTS",40,0)
 . S:'$L($G(REC(130,IEN,66,"E"))) REC(130,IEN,33,"S")=$G(REC(130,IEN,33,"S"))_" (Unknown)"
"RTN","SROGMTS",41,0)
 . S:$L($G(REC(130,IEN,66,"E"))) REC(130,IEN,33,"S")=$G(REC(130,IEN,33,"S"))_" (ICD "_$G(REC(130,IEN,66,"E"))_")"
"RTN","SROGMTS",42,0)
 S:+($G(REC(130,IEN,.09,"I")))>0 REC(130,IEN,.09,"S")=$$ED^SROGMTS0($G(REC(130,IEN,.09,"I")))
"RTN","SROGMTS",43,0)
 S:+($G(REC(130,IEN,15,"I")))>0 REC(130,IEN,15,"S")=$$EDT^SROGMTS0($G(REC(130,IEN,15,"I")))
"RTN","SROGMTS",44,0)
 S:+($G(REC(130,IEN,39,"I"))) REC(130,IEN,39,"S")=$$EDT^SROGMTS0($G(REC(130,IEN,39,"I")))
"RTN","SROGMTS",45,0)
 S:+SRSG REC(130,IEN,"LAB")=$S($O(REC(130,IEN,49,0))>0:"Yes",1:"")
"RTN","SROGMTS",46,0)
 I 'SRSG D:+($O(REC(130,IEN,55,0)))>0 WP(IEN,55,58) D:+($O(REC(130,IEN,59,0)))>0 WP(IEN,59,58)
"RTN","SROGMTS",47,0)
 Q
"RTN","SROGMTS",48,0)
ED(X) ; external date
"RTN","SROGMTS",49,0)
 S X=$G(X) Q:'$L(X) ""
"RTN","SROGMTS",50,0)
 S X=$TR($$FMTE^XLFDT(X,"5DZ"),"@"," ")
"RTN","SROGMTS",51,0)
 Q X
"RTN","SROGMTS",52,0)
EDT(X) ; external date and time
"RTN","SROGMTS",53,0)
 S X=$G(X) Q:'$L(X) ""
"RTN","SROGMTS",54,0)
 S X=$TR($$FMTE^XLFDT(X,"2ZM"),"@"," ")
"RTN","SROGMTS",55,0)
 Q X
"RTN","SROGMTS",56,0)
WP(X,Y,Z) ;
"RTN","SROGMTS",57,0)
 N SRI,SRF,SRW,SRGI,DIWF,DIWL,DIWR
"RTN","SROGMTS",58,0)
 S SRI=+($G(X)) Q:SRI=0!('$D(REC(130,SRI)))
"RTN","SROGMTS",59,0)
 S SRF=+($G(Y)) Q:SRF=0!('$D(REC(130,SRI,SRF)))
"RTN","SROGMTS",60,0)
 S SRW=+($G(Z)) Q:SRW'>0!(SRW>79)
"RTN","SROGMTS",61,0)
 Q:+($O(REC(130,SRI,SRF,0)))'>0
"RTN","SROGMTS",62,0)
 K ^UTILITY($J,"W") S DIWF="C"_SRW,DIWL=0,DIWR=0,SRGI=0
"RTN","SROGMTS",63,0)
 F  S SRGI=$O(REC(130,SRI,SRF,SRGI)) Q:+SRGI=0  D
"RTN","SROGMTS",64,0)
 . S X=$G(REC(130,SRI,SRF,SRGI))
"RTN","SROGMTS",65,0)
 . D ^DIWP
"RTN","SROGMTS",66,0)
 S SRGI=0 F  S SRGI=$O(^UTILITY($J,"W",0,SRGI)) Q:+SRGI=0  D
"RTN","SROGMTS",67,0)
 . S REC(130,SRI,SRF,"S",SRGI)=$G(^UTILITY($J,"W",0,SRGI,0))
"RTN","SROGMTS",68,0)
 . S REC(130,SRI,SRF,"S",0)=$G(REC(130,SRI,SRF,"S",0))+1
"RTN","SROGMTS",69,0)
 K ^UTILITY($J,"W")
"RTN","SROGMTS",70,0)
 Q
"RTN","SROGMTS",71,0)
OS(X) ; Obtains status for OR procedures
"RTN","SROGMTS",72,0)
 N SRN S SRN=+($G(X)) S X="" I $G(REC(130,SRN,118,"I"))="Y" D  Q X
"RTN","SROGMTS",73,0)
 . S:+($G(REC(130,SRN,122,"I")))>0 X="(Completed)"
"RTN","SROGMTS",74,0)
 . S:+($G(REC(130,SRN,121,"I")))>0&(+($G(REC(130,SRN,122,"I")))'>0) X="Incomplete"
"RTN","SROGMTS",75,0)
 . S:X="" X="Unknown"
"RTN","SROGMTS",76,0)
 I +($G(REC(130,SRN,17,"I")))>0 D  Q X
"RTN","SROGMTS",77,0)
 . S X=$S(+($G(REC(130,SRN,.205,"I")))>0:"(Aborted)",1:"Cancelled")
"RTN","SROGMTS",78,0)
 I +($G(REC(130,SRN,.23,"I")))>0 S X="(Completed)" Q X
"RTN","SROGMTS",79,0)
 I +($G(REC(130,SRN,.22,"I")))>0 S X="Incomplete" Q X
"RTN","SROGMTS",80,0)
 I +($G(REC(130,SRN,10,"I")))>0 S X="Scheduled" Q X
"RTN","SROGMTS",81,0)
 I +($G(REC(130,SRN,36,"I")))>0,+($G(REC(130,SRN,.22,"I")))'>0 S X="Requested" Q X
"RTN","SROGMTS",82,0)
 S X="Unknown"
"RTN","SROGMTS",83,0)
 Q X
"RTN","SROGMTS",84,0)
SUB ;
"RTN","SROGMTS",85,0)
 N DA,DR,DIC,DIQ,IENS,FILE,FLD,FLDS,FLDI,FLDA,FLDB,FLDR,FLDRT,SRM,SRC,SRI,SRJ,STXT,SNAM,SCOD,SUB
"RTN","SROGMTS",86,0)
 I +SRSG D
"RTN","SROGMTS",87,0)
 . ;
"RTN","SROGMTS",88,0)
 . ; ^SRF(DO,14,I)                .72  Other Preop Diag    14;0  130.17
"RTN","SROGMTS",89,0)
 . ; $P(^SRF(DO,14,I,0),U)        .01  Other Preop Diag     0;1  Text
"RTN","SROGMTS",90,0)
 . ;
"RTN","SROGMTS",91,0)
 . S DA=IEN,(FILE,DIC)=130,SUB=130.17,DR=.72,DR(SUB)=".01",DIQ="REC(130,"_IEN_",",DIQ(0)="IE"
"RTN","SROGMTS",92,0)
 . K REC(SUB) S SRI=0 F  S SRI=$O(^SRF(+($G(IEN)),14,SRI)) Q:+SRI=0  D
"RTN","SROGMTS",93,0)
 . . S DA(SUB)=SRI
"RTN","SROGMTS",94,0)
 . . D EN^DIQ1
"RTN","SROGMTS",95,0)
 . . S REC(130,IEN,130.17,SRI,.01,"S")=$$EN2^SROGMTS0($G(REC(130,IEN,130.17,SRI,.01,"E")))
"RTN","SROGMTS",96,0)
 . ;
"RTN","SROGMTS",97,0)
 . ; ^SRF(DO,15,I)                .74  Other Postop Diags  15;0  130.18
"RTN","SROGMTS",98,0)
 . ; $P(^SRF(DO,15,I,0),U)        .01  Other Postop Diags   0;1  Text
"RTN","SROGMTS",99,0)
 . ;
"RTN","SROGMTS",100,0)
 . S DA=IEN,(FILE,DIC)=130,SUB=130.18,DR=.74,DR(SUB)=".01",DIQ="REC(130,"_IEN_",",DIQ(0)="IE"
"RTN","SROGMTS",101,0)
 . K REC(SUB) S SRI=0 F  S SRI=$O(^SRF(+($G(IEN)),15,SRI)) Q:+SRI=0  D
"RTN","SROGMTS",102,0)
 . . S DA(SUB)=SRI
"RTN","SROGMTS",103,0)
 . . D EN^DIQ1
"RTN","SROGMTS",104,0)
 . . S REC(130,IEN,130.18,SRI,.01,"S")=$$EN2^SROGMTS0($G(REC(130,IEN,130.18,SRI,.01,"E")))
"RTN","SROGMTS",105,0)
 ;
"RTN","SROGMTS",106,0)
 ; ^SRF(SRN,"OPMOD",I)           28  Pri Pro CPT Mod  OPMOD;0  130.028
"RTN","SROGMTS",107,0)
 ; $P(^SRF(SRN,"OPMOD",I,0),U)  .01  Pri Pro CPT Mod      0;1  Ptr 81.3
"RTN","SROGMTS",108,0)
 ;
"RTN","SROGMTS",109,0)
 I SRCPTM D
"RTN","SROGMTS",110,0)
 . S DA=IEN,(FILE,DIC)=130,SUB=130.028,DR=28,DR(SUB)=".01",DIQ="REC(130,"_IEN_",",DIQ(0)="IE"
"RTN","SROGMTS",111,0)
 . K REC(SUB) S SRI=0 F  S SRI=$O(^SRF(+($G(IEN)),"OPMOD",SRI)) Q:+SRI=0  D
"RTN","SROGMTS",112,0)
 . . S DA(SUB)=SRI
"RTN","SROGMTS",113,0)
 . . D EN^DIQ1
"RTN","SROGMTS",114,0)
 . . S SRM=+($G(REC(130,+($G(IEN)),SUB,+($G(SRI)),.01,"I")))
"RTN","SROGMTS",115,0)
 . . I SRM>0 N SRMOD D
"RTN","SROGMTS",116,0)
 . . . S SRMOD=$$MOD^ICPTMOD(+SRM,"I")
"RTN","SROGMTS",117,0)
 . . . S SRC=$P(SRMOD,"^",2)
"RTN","SROGMTS",118,0)
 . . . S SRS=$P(SRMOD,"^",3)
"RTN","SROGMTS",119,0)
 . . . S REC(130,IEN,SUB,SRI,.01,"MID")=SRC
"RTN","SROGMTS",120,0)
 . . . S REC(130,IEN,SUB,SRI,.01,"MOD")=SRS
"RTN","SROGMTS",121,0)
 . . . S SRT=$$EN2^SROGMTS0(SRS)
"RTN","SROGMTS",122,0)
 . . . S:$L(SRC) SRT=SRT_" (CPT Mod "_SRC_")"
"RTN","SROGMTS",123,0)
 . . . S REC(130,IEN,SUB,SRI,.01,"S")=SRT
"RTN","SROGMTS",124,0)
 ;
"RTN","SROGMTS",125,0)
 ; ^SRF(DO,13,I)                .42  Other Proc          13;0  130.16
"RTN","SROGMTS",126,0)
 ; $P(^SRF(DO,13,I,0),U)        .01  Other Proc           0;1  Text      
"RTN","SROGMTS",127,0)
 ; $P(^SRF(DO,13,I,2),U)          3  Other Proc CPT Code  2;1  Ptr 81
"RTN","SROGMTS",128,0)
 ;
"RTN","SROGMTS",129,0)
 S DA=IEN,(FILE,DIC)=130,SUB=130.16,DR=.42,DR(SUB)=".01;3",DIQ="REC(130,"_IEN_",",DIQ(0)="IE"
"RTN","SROGMTS",130,0)
 K REC(SUB) S SRI=0 F  S SRI=$O(^SRF(+($G(IEN)),13,SRI)) Q:+SRI=0  D
"RTN","SROGMTS",131,0)
 . S DA(SUB)=SRI
"RTN","SROGMTS",132,0)
 . D EN^DIQ1 S SRM=+($G(REC(130,IEN,130.16,SRI,3,"I")))
"RTN","SROGMTS",133,0)
 . S:SRM>0 REC(130,IEN,130.16,SRI,3,"N")=$P($$CPT^ICPTCOD(+SRM),"^",3)
"RTN","SROGMTS",134,0)
 . N SRT,SRS,SRC S SRM=$G(REC(130,IEN,130.16,SRI,3,"I")) I SRM>0 D
"RTN","SROGMTS",135,0)
 . . S SRC=$$CPT^ICPTCOD(SRM),(SRCS,SRS)=$$EN2^SROGMTS0($P(SRC,"^",3))
"RTN","SROGMTS",136,0)
 . . S REC(130,IEN,130.16,SRI,3,"X")=$P(SRC,"^",2)_"^"_$P(SRC,"^",3)
"RTN","SROGMTS",137,0)
 . . S SRC=$P(SRC,"^",2)
"RTN","SROGMTS",138,0)
 . . S SRT=$$EN2^SROGMTS0($G(REC(130,IEN,130.16,SRI,.01,"E")))
"RTN","SROGMTS",139,0)
 . . S:$L(SRS)&(SRS'=SRT) SRT=SRT_" - "_$$EN2^SROGMTS0(SRS)
"RTN","SROGMTS",140,0)
 . . S:$L(SRC)=5 SRT=SRT_" (CPT "_SRC_")",SRCS=SRCS_" (CPT "_SRC_")"
"RTN","SROGMTS",141,0)
 . . S REC(130,IEN,130.16,SRI,3,"N")=SRS
"RTN","SROGMTS",142,0)
 . . S REC(130,IEN,130.16,SRI,.01,"S")=SRT
"RTN","SROGMTS",143,0)
 . . S REC(130,IEN,130.16,SRI,3,"S")=SRCS
"RTN","SROGMTS",144,0)
 . ;
"RTN","SROGMTS",145,0)
 . ;     ^SRF(8,13,2,"MOD",0)       4  Oth Proc CPT Mod   MOD;0  130.164
"RTN","SROGMTS",146,0)
 . ;     ^SRF(8,13,2,"MOD",1,0)   .01  Oth Proc CPT Mod     0;1  Ptr 81.3
"RTN","SROGMTS",147,0)
 . ;
"RTN","SROGMTS",148,0)
 . I SRCPTM D
"RTN","SROGMTS",149,0)
 . . N SRJ S SRJ=0 F  S SRJ=$O(^SRF(+($G(IEN)),13,SRI,"MOD",SRJ)) Q:+SRJ=0  D
"RTN","SROGMTS",150,0)
 . . . N DA,FILE,DIC,SUB,DR,DIQ S DA=IEN,DR=.42,FILE=130,SUB=130.16,DR(SUB)="4",DA(SUB)=SRI,SUB=130.164,DR(SUB)=".01",DA(SUB)=SRJ,DIC=130,DIQ="REC(130,"_IEN_",130.16,"_SRI_",",DIQ(0)="IE"
"RTN","SROGMTS",151,0)
 . . . D EN^DIQ1
"RTN","SROGMTS",152,0)
 . . . S SRM=+($G(REC(130,IEN,130.16,SRI,130.164,SRJ,.01,"I")))
"RTN","SROGMTS",153,0)
 . . . I SRM>0 N SRMOD1 D
"RTN","SROGMTS",154,0)
 . . . . S SRMOD1=$$MOD^ICPTMOD(+SRM,"I")
"RTN","SROGMTS",155,0)
 . . . . S SRC=$P(SRMOD1,"^",2)
"RTN","SROGMTS",156,0)
 . . . . S SRS=$P(SRMOD1,"^",3)
"RTN","SROGMTS",157,0)
 . . . . S REC(130,IEN,130.16,SRI,SUB,SRJ,.01,"MID")=SRC
"RTN","SROGMTS",158,0)
 . . . . S REC(130,IEN,130.16,SRI,SUB,SRJ,.01,"MOD")=SRS
"RTN","SROGMTS",159,0)
 . . . . S REC(130,IEN,130.16,SRI,SUB,SRJ,.01,"X")=SRC_"^"_SRS
"RTN","SROGMTS",160,0)
 . . . . S SRT=$$EN2^SROGMTS0(SRS) S:$L(SRC) SRT=SRT_" (CPT Mod "_SRC_")"
"RTN","SROGMTS",161,0)
 . . . . S REC(130,IEN,130.16,SRI,SUB,SRJ,.01,"S")=SRT
"RTN","SROGMTS",162,0)
 . . . K REC(130,IEN,130.16,SRI,130)
"RTN","SROGMTS",163,0)
 Q
"RTN","SROGMTS",164,0)
SG(X) ; Surgical (Operative) Record
"RTN","SROGMTS",165,0)
 S X=$$GET1^DIQ(130,+($G(X)),118,"I") S X=$S(X["Y":0,1:1) Q X
"RTN","SROGMTS0")
0^115^B26721960
"RTN","SROGMTS0",1,0)
SROGMTS0 ;BIR/ADM - SURGERY HEALTH SUMMARY ; [ 02/18/04  7:12 AM ]
"RTN","SROGMTS0",2,0)
 ;;3.0; Surgery ;**100**;24 Jun 93
"RTN","SROGMTS0",3,0)
 ;
"RTN","SROGMTS0",4,0)
 ;** NOTICE: This routine is part of an implementation of a nationally
"RTN","SROGMTS0",5,0)
 ;**         controlled procedure.  Local modifications to this routine
"RTN","SROGMTS0",6,0)
 ;**         are prohibited.
"RTN","SROGMTS0",7,0)
 ;
"RTN","SROGMTS0",8,0)
 ; Reference to TGET^TIUSRVR1 supported by DBIA #2944
"RTN","SROGMTS0",9,0)
 ;
"RTN","SROGMTS0",10,0)
 Q
"RTN","SROGMTS0",11,0)
ED(X) ; external date
"RTN","SROGMTS0",12,0)
 S X=$G(X) Q:'$L(X) ""
"RTN","SROGMTS0",13,0)
 S X=$TR($$FMTE^XLFDT(X,"5DZ"),"@"," ")
"RTN","SROGMTS0",14,0)
 Q X
"RTN","SROGMTS0",15,0)
EDT(X) ; external date and time
"RTN","SROGMTS0",16,0)
 S X=$G(X) Q:'$L(X) ""
"RTN","SROGMTS0",17,0)
 S X=$TR($$FMTE^XLFDT(X,"2ZM"),"@"," ")
"RTN","SROGMTS0",18,0)
 Q X
"RTN","SROGMTS0",19,0)
EN(X) ; Convert Case
"RTN","SROGMTS0",20,0)
 N Y,SROK,SROC,SRWORD,SRPC,SRLEAD,SRTLR,SRTR,SRCTR,SRPRE
"RTN","SROGMTS0",21,0)
 S (SRTR,SRWORD,SRPC)="",X=$$UP(X)
"RTN","SROGMTS0",22,0)
 ; Parse by Spaces
"RTN","SROGMTS0",23,0)
 F SRCTR=1:1:$L(X," ") D
"RTN","SROGMTS0",24,0)
 . S SRWORD=$P(X," ",SRCTR)
"RTN","SROGMTS0",25,0)
 . S (SRPC,SRLEAD,SRTLR)=""
"RTN","SROGMTS0",26,0)
 . I $E(SRWORD,1)="(" S SRWORD=$E(SRWORD,2,$L(SRWORD)),SRLEAD="("
"RTN","SROGMTS0",27,0)
 . I $E(SRWORD,$L(SRWORD))=")" S SRWORD=$E(SRWORD,1,($L(SRWORD)-1)),SRTLR=")"
"RTN","SROGMTS0",28,0)
 . ; String contains special characters
"RTN","SROGMTS0",29,0)
 . S SROK=1 F SROC="(",")","-","*","+","{","&","}","[","]","/","\","|",",","'" S:SRWORD[SROC SROK=0 Q:'SROK
"RTN","SROGMTS0",30,0)
 . I 'SROK D SP
"RTN","SROGMTS0",31,0)
 . I SROK D SRWORD
"RTN","SROGMTS0",32,0)
 . S:SRLEAD'="" SRWORD=SRLEAD_SRWORD
"RTN","SROGMTS0",33,0)
 . S:SRTLR'="" SRWORD=SRWORD_SRTLR
"RTN","SROGMTS0",34,0)
 . S SRTR=SRTR_" "_SRWORD
"RTN","SROGMTS0",35,0)
 S X=$$TRIM(SRTR) Q X
"RTN","SROGMTS0",36,0)
EN2(X) ; Convert Case 2
"RTN","SROGMTS0",37,0)
 S X=$$CK($$EN($G(X))) Q X
"RTN","SROGMTS0",38,0)
SP ; Special Characters
"RTN","SROGMTS0",39,0)
 ; Special Cases of Special Characters
"RTN","SROGMTS0",40,0)
 I $$UP(SRWORD)="W/&W/O" S SRWORD="w/&w/o" Q
"RTN","SROGMTS0",41,0)
 I $$UP(SRWORD)="W&W/O" S SRWORD="w&w/o" Q
"RTN","SROGMTS0",42,0)
 I $$UP(SRWORD)="&/OR" S SRWORD="&/or" Q
"RTN","SROGMTS0",43,0)
 I SRWORD="W/O" S SRWORD="w/o" Q
"RTN","SROGMTS0",44,0)
 N SROK,SRWD1,SRWD2,SRW,SRWCTR,SRCHR
"RTN","SROGMTS0",45,0)
 S SRWD1=SRWORD,SRWD2="",SRW=""
"RTN","SROGMTS0",46,0)
 F SRWCTR=1:1:$L(SRWD1) D
"RTN","SROGMTS0",47,0)
 . S SRCHR=$E(SRWD1,SRWCTR) I "()-*+{}'&[]/\|,"[SRCHR,$L(SRW) D  Q
"RTN","SROGMTS0",48,0)
 . . S SRPRE=""
"RTN","SROGMTS0",49,0)
 . . S:$E(SRW,1,2)="ZZ"&($L(SRW)>2) SRPRE="ZZ",SRW=$E(SRW,3,$L(SRW))
"RTN","SROGMTS0",50,0)
 . . S SRW=SRPRE_$$CASE(SRW,SRCHR)
"RTN","SROGMTS0",51,0)
 . . S SRWD2=SRWD2_SRW_SRCHR,SRW=""
"RTN","SROGMTS0",52,0)
 . S SRW=SRW_SRCHR
"RTN","SROGMTS0",53,0)
 I $L(SRW) D
"RTN","SROGMTS0",54,0)
 . N SRPSN F SRPSN=1:1:$L(SRW) Q:"()-*+{}'&[]/\|,"'[$E(SRW,SRPSN)
"RTN","SROGMTS0",55,0)
 . N SROW,SRLW S SRLW=$E(SRW,0,(SRPSN-1))
"RTN","SROGMTS0",56,0)
 . S SROW=$E(SRW,SRPSN,$L(SRW))
"RTN","SROGMTS0",57,0)
 . S SRPRE="" S:$E(SROW,1,2)="ZZ"&($L(SROW)>2) SRPRE="ZZ",SROW=$E(SROW,3,$L(SROW))
"RTN","SROGMTS0",58,0)
 . S SROW=SRPRE_$$CASE(SROW,$E($G(SRWD2),$L($G(SRWD2))))
"RTN","SROGMTS0",59,0)
 . S SRW=SRLW_SROW
"RTN","SROGMTS0",60,0)
 . S SRWD2=SRWD2_SRW
"RTN","SROGMTS0",61,0)
 S SRWORD=SRWD2 S:SRCTR=1 SRWORD=$$LD(SRWORD)
"RTN","SROGMTS0",62,0)
 K SRWD1,SRWD2
"RTN","SROGMTS0",63,0)
 Q
"RTN","SROGMTS0",64,0)
SRWORD ; Convert word
"RTN","SROGMTS0",65,0)
 S SRPRE="" S:$E(SRWORD,1,2)="ZZ"&($L(SRWORD)>2) SRPRE="ZZ",SRWORD=$E(SRWORD,3,$L(SRWORD))
"RTN","SROGMTS0",66,0)
 S SRWORD=SRPRE_$$CASE(SRWORD,"")
"RTN","SROGMTS0",67,0)
 Q
"RTN","SROGMTS0",68,0)
CASE(X,J) ; Set to Mixed/lower/UPPER case
"RTN","SROGMTS0",69,0)
 N SRTAG,SRRTN,Y S X=$$UP($G(X)),Y="",SRTAG=$L(X),SRRTN="SROGMTS1"
"RTN","SROGMTS0",70,0)
 S:+SRTAG>4 SRRTN="SROGMTS2" S:+SRTAG>9 SRTAG="M"
"RTN","SROGMTS0",71,0)
 Q:+SRTAG=0&(SRTAG'="M") X
"RTN","SROGMTS0",72,0)
 S SRRTN=SRTAG_"^"_SRRTN D @SRRTN
"RTN","SROGMTS0",73,0)
 I $L(Y) S X=Y Q X
"RTN","SROGMTS0",74,0)
 S X=$$MX(X)
"RTN","SROGMTS0",75,0)
 Q X
"RTN","SROGMTS0",76,0)
LO(X) Q $TR(X,"ABCDEFGHIJKLMNOPQRSTUVWXYZ","abcdefghijklmnopqrstuvwxyz")
"RTN","SROGMTS0",77,0)
UP(X) Q $TR(X,"abcdefghijklmnopqrstuvwxyz","ABCDEFGHIJKLMNOPQRSTUVWXYZ")
"RTN","SROGMTS0",78,0)
MX(X) Q $TR($E(X,1),"abcdefghijklmnopqrstuvwxyz","ABCDEFGHIJKLMNOPQRSTUVWXYZ")_$TR($E(X,2,$L(X)),"ABCDEFGHIJKLMNOPQRSTUVWXYZ","abcdefghijklmnopqrstuvwxyz")
"RTN","SROGMTS0",79,0)
LD(X) Q $TR($E(X,1),"abcdefghijklmnopqrstuvwxyz","ABCDEFGHIJKLMNOPQRSTUVWXYZ")_$E(X,2,$L(X))
"RTN","SROGMTS0",80,0)
TRIM(X) S X=$G(X) F  Q:$E(X,1)'=" "  S X=$E(X,2,$L(X))
"RTN","SROGMTS0",81,0)
 F  Q:$E(X,$L(X))'=" "  S X=$E(X,1,($L(X)-1))
"RTN","SROGMTS0",82,0)
 Q X
"RTN","SROGMTS0",83,0)
CK(X) ;
"RTN","SROGMTS0",84,0)
 S X=$G(X)
"RTN","SROGMTS0",85,0)
 F  Q:X'["(S)"  S X=$P(X,"(S)",1)_"(s)"_$P(X,"(S)",2,299)
"RTN","SROGMTS0",86,0)
 F  Q:X'[" A "  S X=$P(X," A ",1)_" a "_$P(X," A ",2,229)
"RTN","SROGMTS0",87,0)
 I X["Class a" F  Q:X'["Class a"  S X=$P(X,"Class a",1)_"Class A"_$P(X,"Class a",2,229)
"RTN","SROGMTS0",88,0)
 I X["Type a" F  Q:X'["Type a"  S X=$P(X,"Type a",1)_"Type A"_$P(X,"Type a",2,229)
"RTN","SROGMTS0",89,0)
 F  Q:X'["'S"  S X=$P(X,"'S",1)_"'s"_$P(X,"'S",2,229)
"RTN","SROGMTS0",90,0)
 I X["mg Diet" F  Q:X'["mg Diet"  S X=$P(X,"mg Diet",1)_"MG Diet"_$P(X,"mg Diet",2,229)
"RTN","SROGMTS0",91,0)
 I X["LO-Fat" F  Q:X'["LO-Fat"  S X=$P(X,"LO-Fat",1)_"Lo-Fat"_$P(X,"LO-Fat",2,229)
"RTN","SROGMTS0",92,0)
 I $E(X,1)="'" S X="'"_$$LD($E(X,2,$L(X)))
"RTN","SROGMTS0",93,0)
 S X=$TR($E(X,1),"abcdefghijklmnopqrstuvwxyz","ABCDEFGHIJKLMNOPQRSTUVWXYZ")_$E(X,2,$L(X))
"RTN","SROGMTS0",94,0)
 Q X
"RTN","SROGMTS0",95,0)
DICT ; get dictation from TIU completed
"RTN","SROGMTS0",96,0)
 N SRCT,SRL,SRNON,SRSTAT,SRSUM,SRTIU,SRTN,SROY,SRT
"RTN","SROGMTS0",97,0)
 S SRTN=IEN,SRNON=$S($P($G(^SRF(SRTN,"NON")),"^")="Y":1,1:0)
"RTN","SROGMTS0",98,0)
 S (SRSTAT,SRSUM)="" D STATUS I SRSTAT=7 K ^TMP("SRLQ",$J) D
"RTN","SROGMTS0",99,0)
 . S REC(130,SRTN,1.15,1)=SRSUM,REC(130,SRTN,1.15,2)="",SRCT=3
"RTN","SROGMTS0",100,0)
 . D TGET^TIUSRVR1(.SROY,SRTIU,"VIEW")
"RTN","SROGMTS0",101,0)
 . S SRT=0 F  S SRT=$O(@SROY@(SRT)) Q:SRT=""  D
"RTN","SROGMTS0",102,0)
 . . I $D(@SROY@(SRT))=10 S REC(130,SRTN,1.15,SRCT)=@SROY@(SRT,0)
"RTN","SROGMTS0",103,0)
 . . E  S REC(130,SRTN,1.15,SRCT)=@SROY@(SRT)
"RTN","SROGMTS0",104,0)
 . . S SRCT=SRCT+1
"RTN","SROGMTS0",105,0)
 . K @SROY
"RTN","SROGMTS0",106,0)
 Q
"RTN","SROGMTS0",107,0)
STATUS ; get status of summary in TIU
"RTN","SROGMTS0",108,0)
 I 'SRNON D  Q
"RTN","SROGMTS0",109,0)
 .S SRTIU=$P($G(^SRF(SRTN,"TIU")),"^") I SRTIU S SRSTAT=$$STATUS^SROESUTL(SRTIU) D
"RTN","SROGMTS0",110,0)
 ..I SRSTAT=7 S SRSUM=" * * The Operation Report has been electronically signed. * *"
"RTN","SROGMTS0",111,0)
 I SRNON D
"RTN","SROGMTS0",112,0)
 .S SRTIU=$P($G(^SRF(SRTN,"TIU")),"^",3) I SRTIU S SRSTAT=$$STATUS^SROESUTL(SRTIU) D
"RTN","SROGMTS0",113,0)
 ..I SRSTAT=7 S SRSUM=" * * The Procedure Report (Non-OR) has been electronically signed. * *" Q
"RTN","SROGMTS0",114,0)
 Q
"RTN","SROGMTS1")
0^116^B73229807
"RTN","SROGMTS1",1,0)
SROGMTS1 ;BIR/ADM - SURGERY HEALTH SUMMARY ; [ 08/08/01  7:12 AM ]
"RTN","SROGMTS1",2,0)
 ;;3.0; Surgery ;**100**;24 Jun 93
"RTN","SROGMTS1",3,0)
 ;
"RTN","SROGMTS1",4,0)
 ;** NOTICE: This routine is part of an implementation of a nationally
"RTN","SROGMTS1",5,0)
 ;**         controlled procedure.  Local modifications to this routine
"RTN","SROGMTS1",6,0)
 ;**         are prohibited.
"RTN","SROGMTS1",7,0)
 ;         
"RTN","SROGMTS1",8,0)
1 I "^B^C^D^E^F^G^H^I^J^K^M^N^O^P^Q^S^T^U^V^X^Y^Z^"[X S Y=$$UP(X) Q
"RTN","SROGMTS1",9,0)
 I "^W^L^R^"[X S Y=$$LO(X) Q
"RTN","SROGMTS1",10,0)
 I "^MM^CM^IN^FT^CM^CC^"[X S Y=$$LO(X) Q
"RTN","SROGMTS1",11,0)
 Q
"RTN","SROGMTS1",12,0)
2 ; 2 Characters
"RTN","SROGMTS1",13,0)
 S J=$G(J)
"RTN","SROGMTS1",14,0)
 I J'="",J'=" ","^OR^"[X S Y=$$UP(X) Q
"RTN","SROGMTS1",15,0)
 S:X="DA" Y="dA" S:X="DC" Y="dC" S:X="DG" Y="dG" S:X="DT" Y="dT" S:X="DU" Y="dU" S:X="GB" Y="gB" S:X="GC" Y="gC" S:X="GH" Y="gH" S:X="KB" Y="kB" Q:$L($G(Y))
"RTN","SROGMTS1",16,0)
 S:X="KD" Y="kD" S:X="PH" Y="pH" S:X="PX" Y="pX" Q:$L($G(Y))
"RTN","SROGMTS1",17,0)
 I "^WO^W/^IN^IS^IT^AT^OR^TO^OF^ON^BE^BY^"[X S Y=$$LO(X) Q
"RTN","SROGMTS1",18,0)
 I "^ST^"[X S Y=$$MX(X) Q
"RTN","SROGMTS1",19,0)
 I "^DG^DI^DS^EC^EN^ES^FB^ID^FH^HL^IB^LA^LR^MD^MC^NS^OR^PX^RA^RG^RT^SD^SR^SW^VA^WV^XH^XM^XT^XU^YS^"[X S Y=$$UP(X) Q
"RTN","SROGMTS1",20,0)
 I "^BA^BT^CD^CH^CM^CN^CP^CR^CY^BW^7S^OL^CA^MC^EP^II^RO^ZP^ZY^SH^ES^MF^GP^"[X S Y=$$UP(X) Q
"RTN","SROGMTS1",21,0)
 I "^CW^DD^DI^DS^EM^HF^IM^LH^LO^OD^OE^PN^RI^RP^RS^SP^SR^ST^SW^TP^TR^TS^VS^"[X S Y=$$UP(X) Q
"RTN","SROGMTS1",22,0)
 I "^EP^AA^AB^AC^AD^AF^AG^AH^AP^AR^AV^BA^BB^BC^BE^BG^BH^BK^BL^BM^BP^BR^BS^BW^CA^CB^CD^CE^CF^CG^CH^CI^CK^CL^CO^CP^CR^CS^CT^CV^DB^DD^DL^DM^DN^DP^DQ^DR^EA^EB^EC^EF^EM^EO^EP^ET^FA^FD^FK^FR^FU^GA^GI^GL^GP^GR^GS^GT^HA^HB^HC^"[X S Y=$$UP(X) Q
"RTN","SROGMTS1",23,0)
 I "^HC^HL^HO^HP^HR^HS^HT^HU^HX^IA^IB^IE^IF^II^IL^IP^IV^IX^KO^KS^LA^LD^LE^LF^LH^LL^LR^LY^MA^MB^MC^ME^MF^MI^MK^MP^MR^MS^MT^NA^NB^NF^NG^NH^NK^NL^NP^NS^NT^OC^OD^OH^OP^OT^OX^PA^PC^PD^PE^PF^PG^PI^PK^PL^PM^PP^PR^PS^PT^PZ^RA^"[X S Y=$$UP(X) Q
"RTN","SROGMTS1",24,0)
 I "^RA^RC^RF^RH^RI^RP^RR^RS^RX^SA^SB^SC^SD^SE^SF^SG^SH^SI^SK^SL^SM^SP^SR^SS^SV^TA^TB^TC^TF^TH^TI^TK^TL^TP^TT^UK^UD^UV^VA^VC^VH^VI^VO^VP^VZ^WB^WS^XI^YM^YY^"[X S Y=$$UP(X) Q
"RTN","SROGMTS1",25,0)
 I "^AN^AS^AT^BY^CM^DE^IN^MG^NO^OF^ON^OR^SQ^TO^UP^YL^"[X S Y=$$LO(X) Q
"RTN","SROGMTS1",26,0)
 Q
"RTN","SROGMTS1",27,0)
3 ; 3 Characters
"RTN","SROGMTS1",28,0)
 S:X="BRZ" Y="BrZ" S:X="COA" Y="CoA" S:X="COM" Y="CoM" S:X="EIF" Y="eIF" S:X="HGH" Y="hGH" S:X="HPR" Y="HPr" S:X="IGA" Y="IgA" S:X="IGD" Y="IgD" S:X="IGE" Y="IgE" Q:$L($G(Y))
"RTN","SROGMTS1",29,0)
 S:X="IGG" Y="IgG" S:X="IGM" Y="IgM" S:X="IIB" Y="IIb" S:X="KDA" Y="kDa" S:X="MEC" Y="MeC" S:X="MEO" Y="MeO" S:X="NAC" Y="NAc" S:X="NIA" Y="NIa" S:X="OET" Y="OEt" Q:$L($G(Y))
"RTN","SROGMTS1",30,0)
 S:X="OME" Y="OMe" S:X="PNA" Y="pNA" S:X="PRP" Y="PrP" S:X="SMB" Y="SmB" S:X="VPG" Y="VPg" Q:$L($G(Y))
"RTN","SROGMTS1",31,0)
 I "^DIR^MED^APR^AUG^BAY^FEB^HOT^JAN^JCT^JUL^JUN^LAS^LOS^MAR^FAC^MAY^MTN^NEW^NOV^OCT^OUT^SAN^SEP^SKY^"[X S Y=$$MX(X) Q
"RTN","SROGMTS1",32,0)
 I "^ALL^AND^ARE^BUT^SET^NOW^ANY^HAD^DUE^MED^TOO^FAR^OWN^MIN^ITS^HIM^OUR^HIS^HER^NEW^LOW^ITS^MAY^HOW^OUT^WAS^W/O^FOR^NOT^THE^CAN^PUT^"[X S Y=$$LO(X) Q
"RTN","SROGMTS1",33,0)
 I "^ADC^ADR^ADT^BDS^BLO^BPN^BSR^CRS^OER^OEX^CVF^CVP^DCS^DEM^EDL^"[X S Y=$$UP(X) Q
"RTN","SROGMTS1",34,0)
 I "^MIC^NSR^NTM^OPC^ORC^PLA^PLI^PLL^PRC^SCD^SHF^SLT^SPN^SRI^SRO^"[X S Y=$$UP(X) Q
"RTN","SROGMTS1",35,0)
 I "^CWT^IOL^SVS^VSO^EES^EPO^DVC^ASC^"[X S Y=$$UP(X) Q
"RTN","SROGMTS1",36,0)
 I "^ICU^NOS^NEC^SLC^ISC^A3A^A3F^A7R^DPT^DVB^ECT^ECX^EDR^EEO^GEC^IBD^IBJ^CPT^ICD^IMR^IVM^LA7^LEX^LRS^LRX^MC2^MPR^NUR^PCE^ORA^"[X S Y=$$UP(X) Q
"RTN","SROGMTS1",37,0)
 I "^NLM^DIC^DIR^DIK^XMB^ORB^PRC^PRS^PSA^PSD^PSG^PSJ^PSN^PSO^PSS^PSU^PSX^QAC^QAM^QAN^QAO^QAP^QAQ^QAR^QIE^QIP^RTY^SPN^TIU^USR^VAQ^VON^XPD^XUC^XWB^YSA^ZDG^"[X S Y=$$UP(X) Q
"RTN","SROGMTS1",38,0)
 I "^ABA^ABC^ABO^ABP^ACE^ACP^ADA^ADH^ADV^ADP^AFO^AII^ALS^AMC^AMP^ANF^ANP^ASA^ATF^ATP^ATX^AVP^AVT^AZT^BAM^BCG^BCP^BDB^BDS^BIM^BLS^BMP^BNP^BOC^BPV^BRL^BSA^BSP^CAD^CAF^CAM^CAP^CAT^CAZ^CBC^CBZ^CCK^CDP^CDR^CEA^CEF^CFA^CGP^CGS^"[X S Y=$$UP(X) Q
"RTN","SROGMTS1",39,0)
 I "^CGS^CHO^CMC^CMF^CMP^CMV^CNP^CNS^CPE^CPK^CRF^CRH^CSF^CTP^CYT^DAB^DAP^DAT^DBP^DDE^DDT^DFA^DHP^DIP^DJD^DME^DNA^DNP^DTP^EAP^EBP^EBV^ECE^ECG^EEE^EEG^EGF^EHV^EIA^EKG^EMD^EMG^EMS^ENA^ENK^FAD^FAP^FDA^FDP^FGF^FMN^FSH^"[X S Y=$$UP(X) Q
"RTN","SROGMTS1",40,0)
 I "^FSH^FSP^FTC^GAP^GDP^GLP^GMP^GPC^GPD^GRF^GRP^GSH^GTH^GTP^GVP^HBP^HCG^HCL^HCO^HCT^HCV^HDL^HFO^HHV^HIB^HIV^HLA^HLH^HMG^HNF^HNP^HOE^HPA^HPC^HPV^HRP^HSA^HSV^IAA^ICI^ICP^IDA^IFN^IGF^IIA^III^IMP^ITF^IUD^JMV^KAP^KLH^LAI^"[X S Y=$$UP(X) Q
"RTN","SROGMTS1",41,0)
 I "^LAI^LAP^LAV^LDH^LDL^LPH^LSD^LSO^MAA^MAM^MAP^MBP^MCA^MCP^MDL^MDP^MDV^MEA^MEN^MEP^MHC^MIF^MIP^MPA^MPS^MRA^MRC^MRI^MRP^MSA^MSH^MTP^NAD^NAG^NAP^NBD^NCA^NCS^NEC^NGF^NHE^NKA^NMN^NOS^NPY^NSC^NYU^OMP^OMT^ORF^OTF^PAF^PAL^"[X S Y=$$UP(X) Q
"RTN","SROGMTS1",42,0)
 I "^PAL^PAP^PAS^PBP^PCA^PCP^PEG^PEP^PET^PHA^PIP^PIV^PKI^PLP^POC^PPD^PPP^PRV^PSA^PSP^PTB^PTC^PTH^PTT^PTX^RAB^RAG^RAP^RBC^RBP^RGD^RII^RMI^RNA^RNP^RSV^SAA^SAM^SAP^SCP^SDZ^SEO^SER^SFV^SHV^SIV^SKF^SKN^SMP^SOD^SOS^SPM^SRV^"[X S Y=$$UP(X) Q
"RTN","SROGMTS1",43,0)
 I "^RAS^SRV^STP^TAG^TAP^TCF^TCP^TDP^TEF^TEM^TFA^TGF^TMV^TNF^TNP^TPA^TPN^TRH^TRP^TSA^TSH^TTP^TTR^UDP^UMP^URO^USF^UTP^VII^VIP^VLA^VSG^VZV^WBC^WGA^WHO^XII^"[X S Y=$$UP(X) Q
"RTN","SROGMTS1",44,0)
 I "^MAA^MPP^NEC^NOS^ZTA^CPD^R/O^MDA^3MC^ACP^SFN^URR^SNF^SLC^ISC^III^ATP^CMP^AAF^APV^LSD^PCP^HTP^RNA^DNA^ISC^NLM^IMP^"[X S Y=$$UP(X) Q
"RTN","SROGMTS1",45,0)
 I "^ONE^TWO^SIX^TEN^AND^ANY^BIS^BUT^CIS^DES^DUE^FOR^LPM^NON^NOT^OXO^PER^PRE^PRO^PSI^THE^USE^"[X S Y=$$LO(X) Q
"RTN","SROGMTS1",46,0)
 Q
"RTN","SROGMTS1",47,0)
4 ; 4 Characters
"RTN","SROGMTS1",48,0)
 S:X="APOA" Y="ApoA" S:X="BBVI" Y="BbvI" S:X="BPTH" Y="bPTH" S:X="BSUE" Y="BsuE" S:X="CAMP" Y="cAMP" S:X="CGMP" Y="cGMP" S:X="COTE" Y="CotE" S:X="DATP" Y="dATP" Q:$L($G(Y))
"RTN","SROGMTS1",49,0)
 S:X="DCMP" Y="dCMP" S:X="DCTP" Y="dCTP" S:X="DGMP" Y="dGMP" S:X="DGTP" Y="dGTP" S:X="DSBA" Y="dsbA" S:X="DTDP" Y="dTDP" S:X="DTTP" Y="dTTP" S:X="DUMP" Y="dUMP" Q:$L($G(Y))
"RTN","SROGMTS1",50,0)
 S:X="DURD" Y="dUrd" S:X="DUTP" Y="dUTP" S:X="ECAI" Y="EcaI" S:X="ECOK" Y="EcoK" S:X="ERBB" Y="erbB" S:X="FELV" Y="FeLV" S:X="FMET" Y="fMet" S:X="GNRH" Y="GnRH" Q:$L($G(Y))
"RTN","SROGMTS1",51,0)
 S:X="GPII" Y="gpII" S:X="HARG" Y="hArg" S:X="HELA" Y="HeLa" S:X="HGRF" Y="hGRF" S:X="HHAI" Y="HhaI" S:X="HPAI" Y="HpaI" S:X="HPTH" Y="hPTH" S:X="IIIA" Y="IIIa" Q:$L($G(Y))
"RTN","SROGMTS1",52,0)
 S:X="KPNI" Y="KpnI" S:X="MCRB" Y="McrB" S:X="MESH" Y="MeSH" S:X="MRNA" Y="mRNA" S:X="NHET" Y="NHEt" S:X="NHME" Y="NHMe" S:X="OBZL" Y="OBzl" S:X="OTBU" Y="OtBu" Q:$L($G(Y))
"RTN","SROGMTS1",53,0)
 S:X="PGLU" Y="pGlu" S:X="PSTI" Y="PstI" S:X="REGA" Y="regA" S:X="RRNA" Y="rRNA" S:X="SCEI" Y="SceI" S:X="TAQI" Y="TaqI" S:X="TRFA" Y="TrfA" S:X="TRKA" Y="trkA" Q:$L($G(Y))
"RTN","SROGMTS1",54,0)
 S:X="TRKB" Y="trkB" S:X="TRNA" Y="tRNA" Q:$L($G(Y))
"RTN","SROGMTS1",55,0)
 I "^BATH^CITH^CITY^EAST^ERIE^FORT^HOME^IOWA^IRON^JUAN^JULY^JUNE^LAKE^LOMA^LONG^LYON^PALM^PALO^PARK^RENO^ROCK^SALT^SIDE^WACO^WEST^YORK^"[X S Y=$$MX(X) Q
"RTN","SROGMTS1",56,0)
 I "^BADR^BDEM^BMIC^EADT^MAGI^MEDA^MEDB^MEDC^MEDF^MHPE^RXIV^RXOP^"[X S Y=$$UP(X) Q
"RTN","SROGMTS1",57,0)
 I "^RXUD^SCL1^SCL2^HISA^HPSA^CRNA^HCFA^"[X S Y=$$UP(X) Q
"RTN","SROGMTS1",58,0)
 ;I "^^"[X S Y=$$UP(X) Q
"RTN","SROGMTS1",59,0)
 I "^A1B5^A1BG^A4A7^A4A8^A6K7^ABSV^ACKQ^DENT^DGHI^DGPW^DGY1^DGY3^DGYA^DGYB^DGYC^DGYD^DGYF^DGYG^DGYJ^DGYK^DGYL^DGYN^DGYO^DGYP^DGYQ^DGYR^DGYS^"[X S Y=$$UP(X) Q
"RTN","SROGMTS1",60,0)
 I "^DGYU^DGYV^DGYW^DGYX^DGYZ^DIPK^DVBA^DVBC^DVBQ^DVBT^DVBU^DVBW^DVBX^DVBY^EEOA^EEOP^ENXE^ENXF^ENXG^ENXI^"[X S Y=$$UP(X) Q
"RTN","SROGMTS1",61,0)
 I "^ENXJ^ENXK^FBAA^GECD^GECP^GECS^GMAA^GMD1^GMN1^GMN2^GMN3^GMN4^GMN5^GMPL^GMPT^GMRA^GMRC^GMRD^GMRE^GMRG"[X S Y=$$UP(X) Q
"RTN","SROGMTS1",62,0)
 I "^GMRP^GMRQ^GMRR^GMRS^GMRV^GMRY^GMTS^HBHC^IBDE^IBDP^IBQL^IBQY^IBY3^IBY4^IBY5^IBY6^IBY7^IBY8^IBY9^IBYA^"[X S Y=$$UP(X) Q
"RTN","SROGMTS1",63,0)
 I "^IBYB^IBYC^IBYD^IBYE^IBYF^IBYG^IBYH^IBYK^IBYL^IBYN^ICPT^LBRN^LBRT^LBRY^LR00^LR01^LR03^LRAR^LRLS^MCXX^"[X S Y=$$UP(X) Q
"RTN","SROGMTS1",64,0)
 I "^NURA^NURC^NURE^NURQ^NURX^ONCO^PRCA^PRCP^PRMQ^PRPF^PRSX^PRX0^PRX1^PRX8^PRXB^PRXC^PRXE^PRXF^PRXG^PRXI^PRXJ^"[X S Y=$$UP(X) Q
"RTN","SROGMTS1",65,0)
 I "^PRXK^PRXP^PRYA^PRYB^PRYC^PRYD^PRYF^PRYH^PRYJ^PRYL^PRYN^PRYP^PSA1^PSD1^PSGW^PSIV^PSJ1^PSJ4^PSOA^PSOB^PSOC^PSOD^PSOE^PSOG^PSOH^PSOJ^PSOL^"[X S Y=$$UP(X) Q
"RTN","SROGMTS1",66,0)
 I "^PSOY^PSW1^PSXC^QAN1^QAR1^QAR2^QARF^QARY^RAAA^RAAB^RAAC^RAAE^RAAF^RMPC^RMPF^RMPJ^RMPR^RMPT^RTYB^RTYC^RTYD^SDYA^SDYM^SDYN^SDYP^"[X S Y=$$UP(X) Q
"RTN","SROGMTS1",67,0)
 I "^SOWA^SOWC^SOWK^SROA^SRRS^SRRT^TIUJ^TIUW^TIUX^VALM^VEEM^VSIT^XQOR^XUFI^YS01^"[X S Y=$$UP(X) Q
"RTN","SROGMTS1",68,0)
 I "^AIDS^ANCA^ARPP^ATLV^BPDE^BUSI^CENP^CGRP^COOH^CPAP^CPEP^DHEA^DMBA^DSIP^DTPA^EBNA^EDTA^ERCC^ERCP^ESRD^FANA^FITC^FKBP^GABA^GATA^GHRH^GLUT^GYKI^HCMV^HIDA^HMSN^HSAN^HTLV^IDDM^INTP^IPPB^KAFO^LATS^LHRH^MAGE^MLVP^MPTP^"[X S Y=$$UP(X) Q
"RTN","SROGMTS1",69,0)
 I "^ANIT^CAMP^DOPS^MPTP^HETE^OERR^GMPT^GMPL^MTLU^UMLS^BPDE^DMBA^PABA^"[X S Y=$$UP(X) Q
"RTN","SROGMTS1",70,0)
 I "^MPTP^NADH^NADP^NAPS^NETT^NGFI^NRDC^NSCL^PAPS^POMC^PSAP^RTEM^SACH^SGOT^SNAP^SRIF^SRIH^TAPA^TATA^TCDD^TENS^TIMP^TLSO^UDPG^VIII^VLDL^WHFO^XIII^"[X S Y=$$UP(X) Q
"RTN","SROGMTS1",71,0)
 I "^USED^EACH^DTMN,FOUR^FIVE^NINE^HOUR^INTO^LESS^LIKE^MORE^ONLY^OPEN^OVER^PART^SITE^THAN^TYPE^WITH^"[X S Y=$$LO(X) Q
"RTN","SROGMTS1",72,0)
 I "^BEST^IT'S^LATE^SITE^FROM^SOME^WITH^UPON^THEY^THEN^INTO^MORE^THAN^THAT^THIS^THUS^HAVE^BEEN^NOTE^DONE^MUST^MERE^SURE^KIND^WHEN^WHAT^"[X S Y=$$LO(X) Q
"RTN","SROGMTS1",73,0)
 I "^LOST^LIKE^OURS^ALSO^EACH^ONLY^HERE^SUCH^SEEN^SAME^LESS^AREA^MANY^EVEN^LEFT^MOST^"[X S Y=$$LO(X) Q
"RTN","SROGMTS1",74,0)
 Q
"RTN","SROGMTS1",75,0)
 ;          
"RTN","SROGMTS1",76,0)
LO(X) Q $TR(X,"ABCDEFGHIJKLMNOPQRSTUVWXYZ","abcdefghijklmnopqrstuvwxyz")
"RTN","SROGMTS1",77,0)
UP(X) Q $TR(X,"abcdefghijklmnopqrstuvwxyz","ABCDEFGHIJKLMNOPQRSTUVWXYZ")
"RTN","SROGMTS1",78,0)
MX(X) Q $TR($E(X,1),"abcdefghijklmnopqrstuvwxyz","ABCDEFGHIJKLMNOPQRSTUVWXYZ")_$TR($E(X,2,$L(X)),"ABCDEFGHIJKLMNOPQRSTUVWXYZ","abcdefghijklmnopqrstuvwxyz")
"RTN","SROGMTS2")
0^117^B29817223
"RTN","SROGMTS2",1,0)
SROGMTS2 ;BIR/ADM - SURGERY HEALTH SUMMARY ; [ 08/08/01  7:12 AM ]
"RTN","SROGMTS2",2,0)
 ;;3.0; Surgery ;**100**;24 Jun 93
"RTN","SROGMTS2",3,0)
 ;              
"RTN","SROGMTS2",4,0)
5 ; 5 Characters
"RTN","SROGMTS2",5,0)
 S:X="CAMPS" Y="cAMPS" S:X="CVIBI" Y="CviBI" S:X="DNASE" Y="DNase" S:X="ECORI" Y="EcoRI" S:X="GROEL" Y="GroEL" S:X="HAEII" Y="HaeII" S:X="HBSAG" Y="HBsAg" Q:$L($G(Y))
"RTN","SROGMTS2",6,0)
 S:X="HINFI" Y="HinfI" S:X="HNRNP" Y="hnRNP" S:X="HPAII" Y="HpaII" S:X="HPGRF" Y="hpGRF" S:X="MBOII" Y="MboII" S:X="MELEU" Y="MeLeu" S:X="MEPHE" Y="MePhe" Q:$L($G(Y))
"RTN","SROGMTS2",7,0)
 S:X="MEPRO" Y="MePro" S:X="NEUAC" Y="NeuAc" S:X="PTHRP" Y="PTHrP" S:X="RNASE" Y="RNase" S:X="SALGI" Y="SalGI" S:X="SNRNP" Y="snRNP" Q:$L($G(Y))
"RTN","SROGMTS2",8,0)
 I "^APRIL^ARBOR^BARRE^BEACH^BLACK^BLUFF^BRONX^CLOUD^CREEK^DIEGO^DRIVE^FALLS^FARGO^GOISE^GRAND^HAVEN^HILLS^HINES^JUNCT^LINDA^LOUIS^LYONS^MARCH^MEADE^MIAMI^MILES^NORTH^OMAHA^PASSO^PERRY^PINES^PITTS^POINT^PUGET^RIVER^"[$$UP(X) S Y=$$MX(X) Q
"RTN","SROGMTS2",9,0)
 I "^RIVER^SAINT^SALEM^SIOUX^SOUND^SOUTH^TAMPA^TEXAS^TOGUS^TOMAH^VEGAS^WALLA^WAYNE^WHITE^"[$$UP(X) S Y=$$MX(X) Q
"RTN","SROGMTS2",10,0)
 I "^CALLA^CCAAT^CTLSO^DPDPE^HKAFO^IGFBP^NADPH^NIDDM^PACAP^SAIDS^SPECT^"[X S Y=$$UP(X) Q
"RTN","SROGMTS2",11,0)
 I "^DOPAC^ZPACK^EPSDT^"[X S Y=$$UP(X) Q
"RTN","SROGMTS2",12,0)
 I "^BELOW^FIRST^FOUND^HOURS^SIXTH^FIFTH^LOWER^MAJOR^OTHER^SITES^STATE^THIRD^THREE^UPPER^"[$$UP(X) S Y=$$LO(X) Q
"RTN","SROGMTS2",13,0)
 I "^GIVEN^FORTH^THESE^WHERE^OFTEN^AFTER^RIGHT^WOULD^COULD^OUTER^"[X S Y=$$LO(X) Q
"RTN","SROGMTS2",14,0)
 Q
"RTN","SROGMTS2",15,0)
6 ; 6 Characters
"RTN","SROGMTS2",16,0)
 S:X="DESGLY" Y="desGly" S:X="ECORII" Y="EcoRII" S:X="GALNAC" Y="GalNAc" S:X="GLCNAC" Y="GlcNAc" S:X="GTPASE" Y="GTPase" S:X="LEFORT" Y="LeFort" S:X="MURNAC" Y="MurNAc" Q:$L($G(Y))
"RTN","SROGMTS2",17,0)
 S:X="PTDINS" Y="PtdIns" S:X="STYLTI" Y="StyLTI" S:X="UVRABC" Y="uvrABC" Q:$L($G(Y))
"RTN","SROGMTS2",18,0)
 I "^RETURN^ANGLES^AUGUST^BATTLE^BILOXI^BONHAM^BOSTON^BUTLER^CASTLE^CLINIC^DALLAS^DAYTON^DENVER^DUBLIN^DURHAM^FRESNO^HEALTH^HGHLND^HOWARD^HUDSON^ISLAND^JERSEY^KANSAS^LESSER^LITTLE^MANILA^MARION^MARLIN^MOINES^ORANGE^POPLAR^"[$$UP(X) S Y=$$MX(X) Q
"RTN","SROGMTS2",19,0)
 I "^POPLAR^SPRING^TACOMA^TEMPLE^TOPEKA^TUCSON^VALLEY^WILKES^"[$$UP(X) S Y=$$MX(X) Q
"RTN","SROGMTS2",20,0)
 I "^DMEPOS^PEPPTS^"[$$UP(X) S Y=$$UP(X) Q
"RTN","SROGMTS2",21,0)
 I "^INSIDE^FILING^FOURTH^CLOSED^CYCLIC^DEGREE^DEVICE^DURING^EFFECT^EXCEPT^FACTOR^LENGTH^"[$$UP(X) S Y=$$LO(X) Q
"RTN","SROGMTS2",22,0)
 I "^MOLDED^BEFORE^ITSELF^WITHIN^REGION^RETURN^SECOND^SINGLE^"[$$UP(X) S Y=$$LO(X) Q
"RTN","SROGMTS2",23,0)
 Q
"RTN","SROGMTS2",24,0)
7 ; 7 Characters
"RTN","SROGMTS2",25,0)
 I "^ALTOONA^ANTONIO^ATLANTA^AUGUSTA^BATAVIA^BECKLEY^BEDFORD^BUFFALO^CENTRAL^CHICAGO^EASTERN^FLORIDA^GEORGIA^GREATER^HAMPTON^HOUSTON^JACKSON^JANUARY^LEBANON^LINCOLN^MADISON^MEMPHIS^OCTOBER^ORLEANS^PATIENT^PHOENIX^"[$$UP(X) S Y=$$MX(X) Q
"RTN","SROGMTS2",26,0)
 I "^PHOENIX^SAGINAW^SEATTLE^SPOKANE^SPRINGS^WESTERN^WICHITA^"[$$UP(X) S Y=$$MX(X) Q
"RTN","SROGMTS2",27,0)
 I "^APHAKIC^"[$$UP(X) S Y=$$UP(X) Q
"RTN","SROGMTS2",28,0)
 I "^EFFECTS^BETWEEN^ONESELF^HERSELF^HIMSELF^"[X S Y=$$LO(X) Q
"RTN","SROGMTS2",29,0)
 I "^OUTSIDE^ANOTHER^THEREBY^WITHOUT^MENTION^"[X S Y=$$LO(X) Q
"RTN","SROGMTS2",30,0)
 Q
"RTN","SROGMTS2",31,0)
8 ; 8 Characters
"RTN","SROGMTS2",32,0)
 I "^BROCKTON^BROOKLYN^CHEYENNE^COLUMBIA^COLUMBUS^DANVILLE^DECEMBER^FAYETTVL^FEBRUARY^HARRISON^HIGHLAND^HONOLULU^JUNCTION^MARTINEZ^MARYLAND^MONTROSE^MOUNTAIN^MOUNTIAN^MUSKOGEE^NEBRASKA^NORTHERN^OKLAHOMA^PORTLAND^"[$$UP(X) S Y=$$MX(X) Q
"RTN","SROGMTS2",33,0)
 I "^PORTLAND^PRESCOTT^RICHMOND^ROSEBURG^SHERIDAN^SOUTHERN^SYRACUSE^TUSKEGEE^VETERANS^"[$$UP(X) S Y=$$MX(X) Q
"RTN","SROGMTS2",34,0)
 I "^ALTHOUGH^INJURING^INCLUDES^EXCLUDES^"[X S Y=$$LO(X) Q
"RTN","SROGMTS2",35,0)
 Q
"RTN","SROGMTS2",36,0)
9 ; 9 Characters
"RTN","SROGMTS2",37,0)
 I "^ASHEVILLE^BALTIMORE^CLEVELAND^FRANCISCO^KERRVILLE^KNOXVILLE^LEXINGTON^LIVERMORE^MILWAUKEE^NASHVILLE^NEWINGTON^NORTHPORT^SALISBURY^SEPTEMBER^SEPULVEDA^"[$$UP(X) S Y=$$MX(X) Q
"RTN","SROGMTS2",38,0)
 I "^OTHERWISE^SPECIFIED^INCLUDING^EXCLUDING^"[X S Y=$$LO(X) Q
"RTN","SROGMTS2",39,0)
 Q
"RTN","SROGMTS2",40,0)
M ; 10 or more Characters
"RTN","SROGMTS2",41,0)
10 S:X="GDPMANNOSE" Y="GDPmannose" S:X="UDPGLUCOSE" Y="UDPglucose" Q:$L($G(Y))
"RTN","SROGMTS2",42,0)
 I "^BIRMINGHAM^CALIFORNIA^CHARLESTON^CINCINNATI^CLARKSBURG^HEALTHCARE^HUNTINGTON^LOUISVILLE^MANCHESTER^MONTGOMERY^PITTSBURGH^PROVIDENCE^SHREVEPORT^TUSCALOOSA^UNIVERSITY^WASHINGTON^WILMINGTON^"[$$UP(X) S Y=$$MX(X) Q
"RTN","SROGMTS2",43,0)
11 I "^CANANDAIGUA^CHILLICOTHE^COATESVILLE^CONNECTICUT^GAINESVILLE^LEAVENWORTH^MARTINSBURG^MINNEAPOLIS^NORTHAMPTON^"[$$UP(X) S Y=$$MX(X) Q
"RTN","SROGMTS2",44,0)
 I "^UNSPECIFIED^"[X S Y=$$LO(X) Q
"RTN","SROGMTS2",45,0)
12 I "^INDIANAPOLIS^MURFREESBORO^PHILADELPHIA^"[$$UP(X) S Y=$$MX(X) Q
"RTN","SROGMTS2",46,0)
 Q
"RTN","SROGMTS2",47,0)
 Q
"RTN","SROGMTS2",48,0)
 ;          
"RTN","SROGMTS2",49,0)
LO(X) Q $TR(X,"ABCDEFGHIJKLMNOPQRSTUVWXYZ","abcdefghijklmnopqrstuvwxyz")
"RTN","SROGMTS2",50,0)
UP(X) Q $TR(X,"abcdefghijklmnopqrstuvwxyz","ABCDEFGHIJKLMNOPQRSTUVWXYZ")
"RTN","SROGMTS2",51,0)
MX(X) Q $TR($E(X,1),"abcdefghijklmnopqrstuvwxyz","ABCDEFGHIJKLMNOPQRSTUVWXYZ")_$TR($E(X,2,$L(X)),"ABCDEFGHIJKLMNOPQRSTUVWXYZ","abcdefghijklmnopqrstuvwxyz")
"RTN","SROGMTS2",52,0)
LD(X) Q $TR($E(X,1),"abcdefghijklmnopqrstuvwxyz","ABCDEFGHIJKLMNOPQRSTUVWXYZ")_$E(X,2,$L(X))
"RTN","SROGMTS2",53,0)
TRIM(X) S X=$G(X) F  Q:$E(X,1)'=" "  S X=$E(X,2,$L(X))
"RTN","SROGMTS2",54,0)
 F  Q:$E(X,$L(X))'=" "  S X=$E(X,1,($L(X)-1))
"RTN","SROGMTS2",55,0)
 Q X
"RTN","SROHIS")
0^62^B65784676
"RTN","SROHIS",1,0)
SROHIS ;BIR/ADM - MOVE REPORTS FOR HISTORICAL CASES TO TIU ; [ 01/22/04  11:19 AM ]
"RTN","SROHIS",2,0)
 ;;3.0; Surgery ;**100**;24 Jun 93
"RTN","SROHIS",3,0)
 ;
"RTN","SROHIS",4,0)
 ;** NOTICE: This routine is part of an implementation of a nationally
"RTN","SROHIS",5,0)
 ;**         controlled procedure.  Local modifications to this routine
"RTN","SROHIS",6,0)
 ;**         are prohibited.
"RTN","SROHIS",7,0)
 ;
"RTN","SROHIS",8,0)
 ; Reference to $$WHATITLE^TIUPUTU supported by DBIA #3351
"RTN","SROHIS",9,0)
 ; Reference to MAKE^TIUSRVP supported by DBIA #3535
"RTN","SROHIS",10,0)
 ; Reference to UPDATE^TIUSRVP supported by DBIA #3535
"RTN","SROHIS",11,0)
 ; Reference to ZTSAVE("DUZ")=.5 supported by SACC exemption
"RTN","SROHIS",12,0)
 ;
"RTN","SROHIS",13,0)
 N SRINST,SRINSTP,SRN,SRRPT,SRPOS,SRSD,SRSDT,SRSOUT,X,Y
"RTN","SROHIS",14,0)
EN S SRSOUT=0 W @IOF,!,"Make Reports Viewable in CPRS",!!
"RTN","SROHIS",15,0)
 W ?3,"This option allows Operation Reports, Nurse Intraoperative Reports,",!,?3,"Anesthesia Reports and Procedure Reports (Non-O.R.) for historical cases"
"RTN","SROHIS",16,0)
 W !,?3,"to be moved into TIU as ""electronically unsigned"" to make them viewable",!,?3,"within the CPRS Surgery tab. Historical cases are cases performed before"
"RTN","SROHIS",17,0)
 W !,?3,"the Surgery Electronic Signature for Operative Reports feature was",!,?3,"implemented.",!
"RTN","SROHIS",18,0)
 W !,?3,"These ""electronically unsigned"" reports will contain a disclaimer",!,?3,"stating: ""This information is provided from historical files and cannot"
"RTN","SROHIS",19,0)
 W !,?3,"be verified that the author has authenticated/approved this information.",!,?3,"The authenticated source document in the patient's medical record should"
"RTN","SROHIS",20,0)
 W !,?3,"be reviewed to ensure that all information concerning this event has been",!,?3,"reviewed or noted.""",!
"RTN","SROHIS",21,0)
 W !,?3,"CAUTION!! This is a system intensive process that creates new documents",!,?3,"in TIU. Please ensure adequate disk space availability before running"
"RTN","SROHIS",22,0)
 W !,?3,"this process. Also, late activity messages may be suppressed by disabling",!,?3,"the mail group defined as the ""Late Activity Mail Group"" while this"
"RTN","SROHIS",23,0)
 W !,?3,"process runs. Upon completion, this mail group must be reestablished.",!
"RTN","SROHIS",24,0)
DATE K DIR S DIR("A")="Enter starting date for reports to be moved",DIR(0)="DO^:DT:AEPX",DIR("?")="Reports for all cases performed on this date to the present will be moved."
"RTN","SROHIS",25,0)
 D ^DIR K DIR I $D(DTOUT)!$D(DUOUT)!'Y G END
"RTN","SROHIS",26,0)
 S SRSD=Y
"RTN","SROHIS",27,0)
 S SRINST=$$INST() G:SRINST="^" END S SRINSTP=$P(SRINST,U),SRINST=$S(SRINST["ALL DIVISIONS":SRINST,1:$P(SRINST,U,2))
"RTN","SROHIS",28,0)
 W ! K DIR S DIR("A")="Do you want to move the Operation Reports (Y/N)? " D ASK G:SRSOUT END S SRRPT(1)=Y
"RTN","SROHIS",29,0)
 W ! K DIR S DIR("A")="Do you want to move the Nurse Intraoperative Reports (Y/N)? " D ASK G:SRSOUT END S SRRPT(2)=Y
"RTN","SROHIS",30,0)
 W ! K DIR S DIR("A")="Do you want to move the Anesthesia Reports (if used) (Y/N)? " D ASK G:SRSOUT END S SRRPT(3)=Y
"RTN","SROHIS",31,0)
 W ! K DIR S DIR("A")="Do you want to move the Procedure Reports (Non-O.R.) (Y/N)? " D ASK G:SRSOUT END S SRRPT(4)=Y W !
"RTN","SROHIS",32,0)
 I 'SRRPT(1),'SRRPT(2),'SRRPT(3),'SRRPT(4) W !,"No reports selected." D PRESS,END Q
"RTN","SROHIS",33,0)
 S Y=SRSD D DD^%DT S SRSDT=Y
"RTN","SROHIS",34,0)
 S DIR("A",1)="The following reports for cases performed "_SRSDT_" to the present",DIR("A",2)="for "_SRINST_" will be moved.",SRN=3
"RTN","SROHIS",35,0)
 I SRRPT(1) S DIR("A",SRN)="   Operation Report",SRN=SRN+1
"RTN","SROHIS",36,0)
 I SRRPT(2) S DIR("A",SRN)="   Nurse Intraoperative Report",SRN=SRN+1
"RTN","SROHIS",37,0)
 I SRRPT(3) S DIR("A",SRN)="   Anesthesia Report",SRN=SRN+1
"RTN","SROHIS",38,0)
 I SRRPT(4) S DIR("A",SRN)="   Procedure Report (Non-O.R.)",SRN=SRN+1
"RTN","SROHIS",39,0)
 S DIR("A",SRN)="",DIR("A")="Is this correct (Y/N)? " D ASK G:SRSOUT END G:'Y EN
"RTN","SROHIS",40,0)
 W ! S ZTRTN="MOVE^SROHIS",ZTDESC="Surgery - Make Reports Viewable in CPRS",ZTIO="",(ZTSAVE("SRSD"),ZTSAVE("SRRPT*"),ZTSAVE("SRINST"),ZTSAVE("SRINSTP"))="",ZTSAVE("DUZ")=.5 D ^%ZTLOAD
"RTN","SROHIS",41,0)
 I $D(ZTSK) W !!,"Queued as task #"_ZTSK
"RTN","SROHIS",42,0)
PRESS W !! S DIR(0)="FOA",DIR("A")="Press RETURN to continue. " D ^DIR
"RTN","SROHIS",43,0)
END W @IOF D ^SRSKILL
"RTN","SROHIS",44,0)
 Q
"RTN","SROHIS",45,0)
INST() ; determine division used by process
"RTN","SROHIS",46,0)
 N SR,SRCNT,SRINST,X S (SRCNT,X)=0 F  S X=$O(^SRO(133,X)) Q:'X  I '$P($G(^SRO(133,X,0)),"^",21) S SRCNT=SRCNT+1
"RTN","SROHIS",47,0)
 I SRCNT=1 S SRINST=$P($$SITE^SROVAR,"^",1,2) Q SRINST
"RTN","SROHIS",48,0)
 W ! K DIR,Y S DIR(0)="YO",DIR("?")="Enter 'Yes' to include all divisions, or 'No' to pick one division",DIR("A")="Move reports for all divisions",DIR("B")="YES" D ^DIR S SRINST=$S($G(Y(0))'="":Y(0),1:"^")
"RTN","SROHIS",49,0)
 I SRINST="YES" S SRINST=$P($$SITE^SROVAR,U,2)_" - ALL DIVISIONS"
"RTN","SROHIS",50,0)
 I SRINST="NO" D LIST^DIC(133,"",".01","B","*","","","","","","SR") W ! D
"RTN","SROHIS",51,0)
 .S X=0 F  S X=$O(SR("DILIST",1,X)) Q:'X  W !,X,". ",SR("DILIST",1,X)
"RTN","SROHIS",52,0)
 .K DIR W ! S DIR(0)="NO^1:"_$P(SR("DILIST",0),U),DIR("A")="Select Number",DIR("?")="Enter the corresponding number of the division for which you want to move reports" D ^DIR K DIR
"RTN","SROHIS",53,0)
 .S:+Y<1 SRINST="^" S:+Y>0 SRINST=SR("DILIST",2,+Y)
"RTN","SROHIS",54,0)
 Q $S(SRINST["ALL DIVISIONS":SRINST,SRINST=U:SRINST,1:$P(^SRO(133,SRINST,0),U)_U_SR("DILIST",1,+Y))
"RTN","SROHIS",55,0)
MOVE ; entry point when queued
"RTN","SROHIS",56,0)
 N DFN,SR0,SRDIV,SRED1,SRLOC,SRSD1,SRTIU,SRTN
"RTN","SROHIS",57,0)
 S SRED1=DT+.9999,SRSD1=SRSD-.0001
"RTN","SROHIS",58,0)
 F  S SRSD1=$O(^SRF("AC",SRSD1)) Q:SRSD1>SRED1!'SRSD1  S SRTN=0 F  S SRTN=$O(^SRF("AC",SRSD1,SRTN)) Q:'SRTN  I $$MANDIV^SROUTL0(SRINSTP,SRTN) D
"RTN","SROHIS",59,0)
 .S SR0=^SRF(SRTN,0),DFN=$P(SR0,"^"),SRDIV=$$SITE^SROUTL0(SRTN)
"RTN","SROHIS",60,0)
 .I $P($G(^SRF(SRTN,"NON")),"^")'="Y" D  Q
"RTN","SROHIS",61,0)
 ..I $P($G(^SRF(SRTN,.2)),"^",12) D
"RTN","SROHIS",62,0)
 ...D LOC^SROESX
"RTN","SROHIS",63,0)
 ...I SRRPT(1),'$P($G(^SRF(SRTN,"TIU")),"^"),$O(^SRF(SRTN,12,0)) D OR
"RTN","SROHIS",64,0)
 ...I SRRPT(2),'$P($G(^SRF(SRTN,"TIU")),"^",2) D NR
"RTN","SROHIS",65,0)
 ...I SRRPT(3),$P($G(^SRF(SRTN,.2)),"^",4),$$INUSE^SROESXA(SRTN),'$P($G(^SRF(SRTN,"TIU")),"^",4) D AR
"RTN","SROHIS",66,0)
 .I SRRPT(4),$P($G(^SRF(SRTN,"NON")),"^",5),'$P($G(^SRF(SRTN,"TIU")),"^",3),$P($G(^SRF(SRTN,"TIU")),"^",5)="",$O(^SRF(SRTN,12,0)) D NONOR
"RTN","SROHIS",67,0)
 I $D(ZTQUEUED) S ZTREQ="@" Q
"RTN","SROHIS",68,0)
 D END
"RTN","SROHIS",69,0)
 Q
"RTN","SROHIS",70,0)
ASK S DIR(0)="YA",DIR("B")="NO" D ^DIR K DIR I $D(DTOUT)!$D(DUOUT) S SRSOUT=1 Q
"RTN","SROHIS",71,0)
 Q
"RTN","SROHIS",72,0)
OR ; create entry in TIU for operation report
"RTN","SROHIS",73,0)
 N SRAY,SRTIU,SRV,SRX,TITLE,VDT,VLOC,VSIT,X
"RTN","SROHIS",74,0)
 S SRX=$$WHATITLE^TIUPUTU("OPERATION REPORT"),TITLE=$P(SRX,"^") I 'TITLE Q
"RTN","SROHIS",75,0)
 S SRAY(.02)=DFN,SRAY(.05)=1,SRAY(1301)=$P(SR0,"^",9),SRAY(1302)=.5,SRAY(1303)="C",SRAY(1405)=SRTN_";SRF(",SRAY(1701)="Case #: "_SRTN
"RTN","SROHIS",76,0)
 D DISCLAIM,DICT
"RTN","SROHIS",77,0)
 S VDT=$P(SR0,"^",9),VLOC=SRLOC,VSIT=""
"RTN","SROHIS",78,0)
 I VLOC S SRAY(1211)=VLOC,VSTR=VLOC_";"_VDT_";E"
"RTN","SROHIS",79,0)
 D MAKE^TIUSRVP(.SRTIU,DFN,TITLE,VDT,VLOC,VSIT,.SRAY,$G(VSTR),1,1) I SRTIU S $P(^SRF(SRTN,"TIU"),"^")=SRTIU D STATUS(7)
"RTN","SROHIS",80,0)
 Q
"RTN","SROHIS",81,0)
NONOR ; create entry in TIU for non-or procedures
"RTN","SROHIS",82,0)
 N SRAY,SRTIU,SRV,SRX,TITLE,VDT,VLOC,VSIT,X
"RTN","SROHIS",83,0)
 D LOC^SROESXP
"RTN","SROHIS",84,0)
 S SRX=$$WHATITLE^TIUPUTU("PROCEDURE REPORT"),TITLE=$P(SRX,"^") I 'TITLE Q
"RTN","SROHIS",85,0)
 S SRAY(.02)=DFN,SRAY(.05)=1,SRAY(1301)=$P(SR0,"^",9),SRAY(1303)="C",SRAY(1405)=SRTN_";SRF(",SRAY(1701)="Case #: "_SRTN
"RTN","SROHIS",86,0)
 D DISCLAIM,DICT
"RTN","SROHIS",87,0)
 S SRV=$P(^SRF(SRTN,"NON"),"^",4),VDT=$S(SRV:SRV,1:$P(SR0,"^",9)),VLOC=SRLOC,VSIT=""
"RTN","SROHIS",88,0)
 I VLOC S SRAY(1211)=VLOC,VSTR=VLOC_";"_VDT_";E"
"RTN","SROHIS",89,0)
 D MAKE^TIUSRVP(.SRTIU,DFN,TITLE,VDT,VLOC,VSIT,.SRAY,$G(VSTR),1,1) I SRTIU S $P(^SRF(SRTN,"TIU"),"^",3)=SRTIU D STATUS(7)
"RTN","SROHIS",90,0)
 Q
"RTN","SROHIS",91,0)
NR ; create entry in TIU for nurse intraoperative report
"RTN","SROHIS",92,0)
 N SRAY,SRTIU,SRTXT,SRV,SRX,TITLE,VDT,VLOC,VSIT,X
"RTN","SROHIS",93,0)
 S SRX=$$WHATITLE^TIUPUTU("NURSE INTRAOPERATIVE REPORT"),TITLE=$P(SRX,"^") I 'TITLE Q
"RTN","SROHIS",94,0)
 S SRAY(.02)=DFN,SRAY(.05)=1,SRAY(1301)=$P(SR0,"^",9),SRAY(1303)="C",SRAY(1405)=SRTN_";SRF(",SRAY(1701)="Case #: "_SRTN
"RTN","SROHIS",95,0)
 D RPT^SRONRPT(SRTN),DISCLAIM
"RTN","SROHIS",96,0)
 S SRL=0,SRTXT=10 F  S SRL=$O(^TMP("SRNIR",$J,SRTN,SRL)) Q:'SRL  S SRAY("TEXT",SRTXT,0)=^TMP("SRNIR",$J,SRTN,SRL),SRTXT=SRTXT+1
"RTN","SROHIS",97,0)
 S VDT=$P(SR0,"^",9),VLOC=SRLOC,VSIT=""
"RTN","SROHIS",98,0)
 I VLOC S SRAY(1211)=VLOC,VSTR=VLOC_";"_VDT_";E"
"RTN","SROHIS",99,0)
 D MAKE^TIUSRVP(.SRTIU,DFN,TITLE,VDT,VLOC,VSIT,.SRAY,$G(VSTR),1,1) I SRTIU S $P(^SRF(SRTN,"TIU"),"^",2)=SRTIU D STATUS(7)
"RTN","SROHIS",100,0)
 K ^TMP("SRNIR",$J,SRTN)
"RTN","SROHIS",101,0)
 Q
"RTN","SROHIS",102,0)
AR ; create entry in TIU for anesthesia report
"RTN","SROHIS",103,0)
 N SRAY,SRTIU,SRTXT,SRV,SRX,TITLE,VDT,VLOC,VSIT,X
"RTN","SROHIS",104,0)
 S SRX=$$WHATITLE^TIUPUTU("ANESTHESIA REPORT"),TITLE=$P(SRX,"^") I 'TITLE Q
"RTN","SROHIS",105,0)
 S SRAY(.02)=DFN,SRAY(.05)=1,SRAY(1301)=$P(SR0,"^",9),SRAY(1303)="C",SRAY(1405)=SRTN_";SRF(",SRAY(1701)="Case #: "_SRTN
"RTN","SROHIS",106,0)
 D RPT^SROANR(SRTN),DISCLAIM
"RTN","SROHIS",107,0)
 S SRL=0,SRTXT=10 F  S SRL=$O(^TMP("SRANE",$J,SRTN,SRL)) Q:'SRL  S SRAY("TEXT",SRTXT,0)=^TMP("SRANE",$J,SRTN,SRL),SRTXT=SRTXT+1
"RTN","SROHIS",108,0)
 S VDT=$P(SR0,"^",9),VLOC=SRLOC,VSIT=""
"RTN","SROHIS",109,0)
 I VLOC S SRAY(1211)=VLOC,VSTR=VLOC_";"_VDT_";E"
"RTN","SROHIS",110,0)
 D MAKE^TIUSRVP(.SRTIU,DFN,TITLE,VDT,VLOC,VSIT,.SRAY,$G(VSTR),1,1) I SRTIU S $P(^SRF(SRTN,"TIU"),"^",4)=SRTIU D STATUS(7)
"RTN","SROHIS",111,0)
 K ^TMP("SRANE",$J,SRTN)
"RTN","SROHIS",112,0)
 Q
"RTN","SROHIS",113,0)
STATUS(SRSTAT) ; update status
"RTN","SROHIS",114,0)
 K SRAY S SRAY(.05)=SRSTAT,(SRAY(1202),SRAY(1204),SRAY(1208),SRAY(1209))="" D UPDATE^TIUSRVP(.SRDOC,SRTIU,.SRAY,1)
"RTN","SROHIS",115,0)
 Q
"RTN","SROHIS",116,0)
DICT ; get summary from surgeon's dictation field in file 130
"RTN","SROHIS",117,0)
 N SRL,SRTXT S SRL=0,SRTXT=10
"RTN","SROHIS",118,0)
 F  S SRL=$O(^SRF(SRTN,12,SRL)) Q:'SRL  S SRAY("TEXT",SRTXT,0)=^SRF(SRTN,12,SRL,0) S SRTXT=SRTXT+1
"RTN","SROHIS",119,0)
 Q
"RTN","SROHIS",120,0)
DISCLAIM ; disclaimer statement
"RTN","SROHIS",121,0)
 S SRAY("TEXT",1,0)=""
"RTN","SROHIS",122,0)
 S SRAY("TEXT",2,0)=" ************************************************************************"
"RTN","SROHIS",123,0)
 S SRAY("TEXT",3,0)=" *  DISCLAIMER: This information is provided from historical files and  *"
"RTN","SROHIS",124,0)
 S SRAY("TEXT",4,0)=" *  cannot be verified that the author has authenticated/approved this  *"
"RTN","SROHIS",125,0)
 S SRAY("TEXT",5,0)=" *  information.  The authenticated source document in the patient's    *"
"RTN","SROHIS",126,0)
 S SRAY("TEXT",6,0)=" *  medical record should be reviewed to ensure that all information    *"
"RTN","SROHIS",127,0)
 S SRAY("TEXT",7,0)=" *  concerning this event has been reviewed or noted.                   *"
"RTN","SROHIS",128,0)
 S SRAY("TEXT",8,0)=SRAY("TEXT",2,0),SRAY("TEXT",9,0)=""
"RTN","SROHIS",129,0)
 Q
"RTN","SROIRR")
0^63^B8545925
"RTN","SROIRR",1,0)
SROIRR ;B'HAM ISC/MAM - ENTER IRRIGATIONS; [ 01/30/01  11:13 AM ]
"RTN","SROIRR",2,0)
 ;;3.0; Surgery ;**94,100**;24 Jun 93
"RTN","SROIRR",3,0)
 S (CNT,SRIRR)=0 F  S SRIRR=$O(^SRO(133.6,SRIRR)) Q:'SRIRR  S INACT=$P(^SRO(133.6,SRIRR,0),"^",3) I 'INACT S CNT=CNT+1,SRIRRG(CNT)=SRIRR_"^"_$P(^SRO(133.6,SRIRR,0),"^")
"RTN","SROIRR",4,0)
 N SRD,SRI,SRFIRST,SRJ,SRLAST,SRP,SRP1,SRQ,SRTOT S SRD=36,SRTOT=CNT,SRP1=CNT/SRD,SRP=$P(SRP1,".") I SRP1>SRP S SRP=SRP+1
"RTN","SROIRR",5,0)
 S (CNT,SRLAST)=0 F SRPAGE=1:1:SRP S SRNUM=$S(SRTOT>SRD:"Page "_SRPAGE_" of "_SRP,1:""),SRFIRST=SRLAST+1,SRLAST=$S(SRLAST+SRD<SRTOT:SRLAST+SRD,1:SRTOT) D PAGE Q:SRSOUT
"RTN","SROIRR",6,0)
END D ^SRSKILL,UNLOCK^SROUTL(SRTN) W @IOF
"RTN","SROIRR",7,0)
 Q
"RTN","SROIRR",8,0)
PAGE Q:SRSOUT  W @IOF,!,?25,"Irrigation Solutions",?(79-$L(SRNUM)),SRNUM,! F I=1:1:80 W "="
"RTN","SROIRR",9,0)
 F CNT=SRFIRST:1:SRLAST S S=SRIRRG(CNT) W:CNT#2 !,$J(CNT,2)_". "_$P(SRIRRG(CNT),"^",2) W:'(CNT#2) ?40,$J(CNT,2)_". "_$P(SRIRRG(CNT),"^",2)
"RTN","SROIRR",10,0)
 W ! F LINE=1:1:80 W "-"
"RTN","SROIRR",11,0)
SEL W ! K DIR S DIR("?",1)=" Enter the numbers corresponding to your choices, separated by a comma (,).",DIR("?")=" For example, if selecting items 1, 4 and 7, you would enter '1,4,7'."
"RTN","SROIRR",12,0)
 S DIR("A")="Select the number(s) corresponding to your choice: ",DIR(0)="FAO" D ^DIR K DIR I $D(DTOUT)!$D(DUOUT) S SRSOUT=1 Q
"RTN","SROIRR",13,0)
 S SRX=Y I Y="" Q
"RTN","SROIRR",14,0)
 S:'$D(^SRF(SRTN,26,0)) ^SRF(SRTN,26,0)="^130.08PA^0^0"
"RTN","SROIRR",15,0)
 S SRQ=0 F SRCNT=1:1 S SRI=$P(SRX,",",SRCNT) Q:SRI=""!SRQ  I '$D(SRIRRG(SRI)) W !!,SRI_" is an invalid entry.  Please try again." S SRQ=1
"RTN","SROIRR",16,0)
 I SRQ D RET S:$D(DTOUT)!$D(DUOUT) SRSOUT=1 G PAGE
"RTN","SROIRR",17,0)
 F SRCNT=1:1 S SRI=$P(SRX,",",SRCNT) Q:SRI=""  D STUFF
"RTN","SROIRR",18,0)
 D RET I $D(DTOUT)!$D(DUOUT) S SRSOUT=1
"RTN","SROIRR",19,0)
 Q
"RTN","SROIRR",20,0)
STUFF ; stuff restraints in Surgery file
"RTN","SROIRR",21,0)
 I $D(SRIRRG(SRI)) S SRIRR=+SRIRRG(SRI),SRIRR1=$P(SRIRRG(SRI),"^",2) W !!,"Entering "_SRIRR1_" ..." K DR S DIE=130,DA=SRTN,DR=".39///"_SRIRR1,DR(2,130.08)=.01 D ^DIE K DR
"RTN","SROIRR",22,0)
 Q
"RTN","SROIRR",23,0)
RET W ! K DIR S DIR(0)="FOA",DIR("A")="Press RETURN to continue  " D ^DIR
"RTN","SROIRR",24,0)
 Q
"RTN","SROKRET")
0^160^B1039924
"RTN","SROKRET",1,0)
SROKRET ;B'HAM ISC/MAM - KILL RETURNS, 'AL' X-REF ; [ 09/09/03  7:30 AM ]
"RTN","SROKRET",2,0)
 ;;3.0; Surgery ;**100**;24 Jun 93
"RTN","SROKRET",3,0)
 S SRET=0,DFN=$P(^SRF(DA,0),"^") F I=0:0 S SRET=$O(^SRF("B",DFN,SRET)) Q:'SRET  I $D(^SRF(SRET,29,DA,0)) K ^SRF(SRET,29,DA,0) D UPDATE
"RTN","SROKRET",4,0)
 K ^SRF("AL",DA)
"RTN","SROKRET",5,0)
 Q
"RTN","SROKRET",6,0)
UPDATE I '$O(^SRF(SRET,29,0)) K ^SRF(SRET,29) Q
"RTN","SROKRET",7,0)
 S CNT=0 F I=0:0 S CNT=$O(^SRF(SRET,29,CNT)) Q:'CNT  S SRET1=CNT
"RTN","SROKRET",8,0)
 S $P(^SRF(SRET,29,0),"^",3)=SRET1,$P(^SRF(SRET,29,0),"^",4)=$P(^(0),"^",4)-1
"RTN","SROKRET",9,0)
 Q
"RTN","SROMED")
0^64^B18994467
"RTN","SROMED",1,0)
SROMED ;B'HAM ISC/MAM - ENTER/EDIT MEDICATIONS ; [ 01/30/01  12:22 AM ]
"RTN","SROMED",2,0)
 ;;3.0; Surgery ;**21,44,79,100**;24 Jun 93
"RTN","SROMED",3,0)
 ;
"RTN","SROMED",4,0)
 ; Reference to ^PSDRUG supported by DBIA #221
"RTN","SROMED",5,0)
 ;
"RTN","SROMED",6,0)
 I '$D(^XUSEC("SROEDIT",DUZ))&'$D(^XUSEC("SROANES",DUZ)) W !!!,$C(7),"You must hold the SROEDIT key or the SROANES key to use this option !",! Q
"RTN","SROMED",7,0)
 D ^SROLOCK G:SROLOCK END Q:'$D(SRTN)
"RTN","SROMED",8,0)
 N SRLCK S SRLCK=$$LOCK^SROUTL(SRTN) I 'SRLCK G END
"RTN","SROMED",9,0)
START S SRQ=0,SRSMED=1 G:SRTN<1 END W @IOF S SRF=0 R !!,"ENTER MEDICATION/DOSE(MG)/ROUTE/TIME: ",M:DTIME S:'$T M="^" G:M=""!(M="^") END S SRM=$P(M,"/",1),SRD=$P(M,"/",2),SRR=$P(M,"/",3),SRT=$P(M,"/",4) W !!
"RTN","SROMED",10,0)
 I M="?" W !!,"Enter the medication, dose, route and time, separated by slashes (/).",!,"The Medication and time MUST be included, however the route and dose",!,"can be omitted.  i.e. 'MEDICATION/DOSE//TIME' will omit the route."
"RTN","SROMED",11,0)
 I M="?" W !!,"Enter '??' to get a list of available drugs.",! D RET G:SRQ END G START
"RTN","SROMED",12,0)
 I M?.E1C.E W !!,"Your answer has a control character in it, please re-type it.",! D RET G:SRQ END G START
"RTN","SROMED",13,0)
 S (X,SRMM)=SRM,DIC="^PSDRUG(",DIC(0)="QEZM",DIC("S")="I $S('$G(^PSDRUG(Y,""I"")):1,DT'>^(""I""):1,1:0)" D ^DIC K DIC S SRM=$S(Y<0:"",1:$P(Y,"^",2))
"RTN","SROMED",14,0)
 I SRM="",SRMM'["?" W !!,"The Drug '",SRMM,"' does not exist in your Drug file.  Please re-enter. " D RET G:SRQ END G START
"RTN","SROMED",15,0)
 I SRMM="??" D RET G:SRQ END G START
"RTN","SROMED",16,0)
 D TIME G:'$D(SRT) FLAG S X=SRT D FIELD^DID(130,.204,"","INPUT TRANSFORM","SRX") S SRX=SRX("INPUT TRANSFORM") X:SRT'="" SRX S SRT=$S(X="":SRT,1:X) D ROUTE G:'$D(SRR) FLAG D DOSE G:'$D(SRD) FLAG
"RTN","SROMED",17,0)
FLAG S SRF=$S('$D(SRT)!('$D(SRD))!('$D(SRR)):0,1:1) I 'SRF W !!!,"NO ACTION TAKEN",! H 2 G END
"RTN","SROMED",18,0)
DIE S DA=SRTN,DIE=130,DR=".375///"_SRM,DR(2,130.33)="1///"_SRT,DR(3,130.34)="1///"_SRD_";4///"_SRR D ^DIE W !!!,"MEDICATION ENTERED ...." K DR H 2
"RTN","SROMED",19,0)
 G START
"RTN","SROMED",20,0)
END W @IOF D ^SRSKILL D:$G(SRLCK) UNLOCK^SROUTL(SRTN)
"RTN","SROMED",21,0)
 Q
"RTN","SROMED",22,0)
RET R !!,"Press RETURN to Continue.   ",Z:DTIME S:'$T Z="^" S:Z="^" SRQ=1 Q
"RTN","SROMED",23,0)
 Q
"RTN","SROMED",24,0)
ROUTE ; check for route of administration
"RTN","SROMED",25,0)
 Q:SRR=""  N SRHELP,SRVALUE D CHK^DIE(130.34,4,"E",SRR,.SRVALUE) I SRVALUE'="^" S SRR=SRVALUE Q
"RTN","SROMED",26,0)
 D HELP^DIE(130.34,"",4,"S","SRHELP(1)")
"RTN","SROMED",27,0)
 W !!,"Route entered is not one of the available choices.",!,"Please enter medication route again.",!!
"RTN","SROMED",28,0)
 I $G(SRHELP(1,"DIHELP")) F I=1:1:SRHELP(1,"DIHELP") W SRHELP(1,"DIHELP",I),!
"RTN","SROMED",29,0)
 S DIR("A")="Enter ROUTE",DIR(0)="130.34,4O" D ^DIR K DIR I $D(DTOUT)!$D(DUOUT) S SRR="" Q
"RTN","SROMED",30,0)
 S SRR=$P(Y,"^")
"RTN","SROMED",31,0)
 Q
"RTN","SROMED",32,0)
TIME ; check for time
"RTN","SROMED",33,0)
 K %DT S X=SRT,%DT="R" D ^%DT I Y>0 Q
"RTN","SROMED",34,0)
  W:SRT="" !!,"A time MUST be entered !"
"RTN","SROMED",35,0)
 I '(SRT?1N!(SRT?2N&(SRT<13))!(SRT?4N)!(SRT?3N)!(SRT?2N1":"2N)!(SRT?1N1":"2N))!(+SRT>2400)!(SRT="") S SRF=1
"RTN","SROMED",36,0)
 I SRF W !!,?5,"Enter the time in one of the following formats:",!,?9,"7:45, 0745, 745, 07:45, Date@Time, or NOW",!!,?5,"Time is required."
"RTN","SROMED",37,0)
T1 S:SRT="" SRF=1 Q:SRF=0  R !!,"Enter Time: ",SRT:DTIME S:'$T!(SRT="") SRT="^" G:SRT["^" END W:SRT["?" !!,"Enter a time in the format above, or RETURN to bypass.  An '^' will exit this option." G:SRT["?" T1 S SRF=0 G TIME
"RTN","SROMED",38,0)
 Q
"RTN","SROMED",39,0)
DOSE ; check dosage
"RTN","SROMED",40,0)
 Q:SRD=""  I $L(SRD)>15!($L(SRD)<1) W !!,"Dosage entered incorrectly." S SRF=1
"RTN","SROMED",41,0)
 I SRD="?" W !!,"Dosage must be 1 to 15 characters in length, i.e. 15 mg." S SRF=1
"RTN","SROMED",42,0)
D1 I SRF=1 R !!,"ENTER DOSE: ",SRD1:DTIME S:'$T SRD1="^" K:SRD1["^" SRD Q:SRD1["^"  W:SRD1["?" !!,"Dosage must be 1 to 15 characters in length" G:SRD1["?" D1 S SRD=SRD1,SRF=0 G DOSE
"RTN","SROMED",43,0)
 Q
"RTN","SROMENU")
0^65^B18725484
"RTN","SROMENU",1,0)
SROMENU ;B'HAM ISC/MAM - OPERATION MENU OPTIONS ; [ 10/31/01  11:29 AM ]
"RTN","SROMENU",2,0)
 ;;3.0; Surgery ;**52,67,69,104,107,100**;24 Jun 93
"RTN","SROMENU",3,0)
TECH ; sromen-anes tech
"RTN","SROMENU",4,0)
 G:'$G(SRTN) NO D ^SROLOCK G:SROLOCK END
"RTN","SROMENU",5,0)
 N SRLCK S SRLCK=$$LOCK^SROUTL(SRTN) I 'SRLCK G END
"RTN","SROMENU",6,0)
 K DR,SRODR S DR="[SROMEN-ANES TECH]",DIE=130,DA=SRTN D ^DIE I $D(SRODR) D ^SROCON1
"RTN","SROMENU",7,0)
 G END
"RTN","SROMENU",8,0)
OP ; sromen-op
"RTN","SROMENU",9,0)
 D RT K SRODR
"RTN","SROMENU",10,0)
 G:'$G(SRTN) NO D ^SROLOCK I SROLOCK S Q3("VIEW")=""
"RTN","SROMENU",11,0)
 N SRLCK S SRLCK=$$LOCK^SROUTL(SRTN) I 'SRLCK S Q3("VIEW")=""
"RTN","SROMENU",12,0)
 K DR S SRDTIME=DTIME,DTIME=3600,DIE=130,DR="[SROMEN-OPER]",DA=SRTN,ST="OPERATION"_$S(SROLOCK:" **LOCKED",1:"") D EN2^SROVAR,^SRCUSS S DTIME=SRDTIME I $D(Q3("VIEW")) K Q3("VIEW") G END
"RTN","SROMENU",13,0)
 I '$P(^SRF(SRTN,0),"^",20) D ^SROPCE1
"RTN","SROMENU",14,0)
 I $D(SRODR) D ^SROCON1
"RTN","SROMENU",15,0)
 S SROERR=SRTN G END
"RTN","SROMENU",16,0)
COMP ; sromen-comp
"RTN","SROMENU",17,0)
 K SRODR
"RTN","SROMENU",18,0)
 G:'$G(SRTN) NO D ^SROLOCK G:SROLOCK END
"RTN","SROMENU",19,0)
 N SRLCK S SRLCK=$$LOCK^SROUTL(SRTN) I 'SRLCK G END
"RTN","SROMENU",20,0)
 K DR W @IOF,! S DIE=130,DA=SRTN,DR="[SROMEN-COMP]" D ^DIE
"RTN","SROMENU",21,0)
 I $D(SRODR) D ^SROCON1
"RTN","SROMENU",22,0)
 G END
"RTN","SROMENU",23,0)
SHORT ; sromen-out
"RTN","SROMENU",24,0)
 D RT K SRODR
"RTN","SROMENU",25,0)
 G:'$G(SRTN) NO D ^SROLOCK I SROLOCK S Q3("VIEW")=""
"RTN","SROMENU",26,0)
 N SRLCK S SRLCK=$$LOCK^SROUTL(SRTN) I 'SRLCK S Q3("VIEW")=""
"RTN","SROMENU",27,0)
 K DR S SRDTIME=DTIME,DTIME=3600,DIE=130,DA=SRTN,DR="[SROMEN-OUT]",ST="SHORT SCREEN"_$S(SROLOCK:" **LOCKED",1:"") D EN2^SROVAR,^SRCUSS S DTIME=SRDTIME I $D(Q3("VIEW")) K Q3("VIEW") G END
"RTN","SROMENU",28,0)
 I '$P(^SRF(SRTN,0),"^",20) D ^SROPCE1
"RTN","SROMENU",29,0)
 I $D(SRODR) D ^SROCON1
"RTN","SROMENU",30,0)
 S SROERR=SRTN G END
"RTN","SROMENU",31,0)
PACU ; sromen-pacu
"RTN","SROMENU",32,0)
 D RT K SRODR
"RTN","SROMENU",33,0)
 G:'$G(SRTN) NO D ^SROLOCK I SROLOCK S Q3("VIEW")=""
"RTN","SROMENU",34,0)
 N SRLCK S SRLCK=$$LOCK^SROUTL(SRTN) I 'SRLCK S Q3("VIEW")=""
"RTN","SROMENU",35,0)
 K DR S DIE=130,DA=SRTN,ST="PACU"_$S(SROLOCK:" **LOCKED",1:""),DR="[SROMEN-PACU]" D EN2^SROVAR,^SRCUSS I $D(Q3("VIEW")) K Q3("VIEW") G END
"RTN","SROMENU",36,0)
 I $D(SRODR) D ^SROCON1
"RTN","SROMENU",37,0)
 S SROERR=SRTN D ^SROERR0
"RTN","SROMENU",38,0)
 G END
"RTN","SROMENU",39,0)
POST ; sromen-post
"RTN","SROMENU",40,0)
 D RT K SRODR
"RTN","SROMENU",41,0)
 G:'$G(SRTN) NO D ^SROLOCK I SROLOCK S Q3("VIEW")=""
"RTN","SROMENU",42,0)
 N SRLCK S SRLCK=$$LOCK^SROUTL(SRTN) I 'SRLCK S Q3("VIEW")=""
"RTN","SROMENU",43,0)
 K DR S SRDTIME=DTIME,DTIME=3600,DIE=130,DA=SRTN,ST="POST OPERATION"_$S(SROLOCK:" **LOCKED",1:""),DR="[SROMEN-POST]" D EN2^SROVAR,^SRCUSS S DTIME=SRDTIME I $D(Q3("VIEW")) K Q3("VIEW") G END
"RTN","SROMENU",44,0)
 I '$P(^SRF(SRTN,0),"^",20) D ^SROPCE1
"RTN","SROMENU",45,0)
 I $D(SRODR) D ^SROCON1
"RTN","SROMENU",46,0)
 S SROERR=SRTN G END
"RTN","SROMENU",47,0)
REF ; sromen-refer
"RTN","SROMENU",48,0)
 K SRODR
"RTN","SROMENU",49,0)
 G:'$G(SRTN) NO D ^SROLOCK G:SROLOCK END
"RTN","SROMENU",50,0)
 N SRLCK S SRLCK=$$LOCK^SROUTL(SRTN) I 'SRLCK G END
"RTN","SROMENU",51,0)
 W @IOF K DR S DIE=130,DA=SRTN,DR="[SROMEN-REFER]" W !! D ^DIE
"RTN","SROMENU",52,0)
 I $D(SRODR) D ^SROCON1
"RTN","SROMENU",53,0)
 G END
"RTN","SROMENU",54,0)
STAFF ; sromen-staff
"RTN","SROMENU",55,0)
 D RT K SRODR
"RTN","SROMENU",56,0)
 G:'$G(SRTN) NO D ^SROLOCK I SROLOCK S Q3("VIEW")=""
"RTN","SROMENU",57,0)
 N SRLCK S SRLCK=$$LOCK^SROUTL(SRTN) I 'SRLCK S Q3("VIEW")=""
"RTN","SROMENU",58,0)
 K DR S SRDTIME=DTIME,DTIME=3600,DIE=130,DA=SRTN,ST="SURGICAL STAFF"_$S(SROLOCK:" **LOCKED",1:""),DR="[SROMEN-STAFF]" D EN2^SROVAR,^SRCUSS S DTIME=SRDTIME I $D(Q3("VIEW")) K Q3("VIEW") G END
"RTN","SROMENU",59,0)
 I '$P(^SRF(SRTN,0),"^",20) D ^SROPCE1
"RTN","SROMENU",60,0)
 I $D(SRODR) D ^SROCON1
"RTN","SROMENU",61,0)
 S SROERR=SRTN G END
"RTN","SROMENU",62,0)
START ; sromen-start
"RTN","SROMENU",63,0)
 D RT K SRODR
"RTN","SROMENU",64,0)
 G:'$G(SRTN) NO D ^SROLOCK I SROLOCK S Q3("VIEW")=""
"RTN","SROMENU",65,0)
 N SRLCK S SRLCK=$$LOCK^SROUTL(SRTN) I 'SRLCK S Q3("VIEW")=""
"RTN","SROMENU",66,0)
 K DR S SRDTIME=DTIME,DTIME=3600,DIE=130,DA=SRTN,ST="STARTUP"_$S(SROLOCK:" **LOCKED",1:""),DR="[SROMEN-START]" D EN2^SROVAR,^SRCUSS S DTIME=SRDTIME I $D(Q3("VIEW")) K Q3("VIEW") G END
"RTN","SROMENU",67,0)
 I '$P(^SRF(SRTN,0),"^",20) D ^SROPCE1
"RTN","SROMENU",68,0)
 I $D(SRODR) D ^SROCON1
"RTN","SROMENU",69,0)
 S SROERR=SRTN G END
"RTN","SROMENU",70,0)
REV ; review request information (request menu)
"RTN","SROMENU",71,0)
 K SRNEWOP D ^SROPS D RT G:'$G(SRTN) END
"RTN","SROMENU",72,0)
 K Y,DR S Q3("VIEW")="",ST="REVIEW REQUEST",DIC=130,DA=SRTN,DR="[SRSREQV]" D EN2^SROVAR,^SRCUSS K DR,SRTN
"RTN","SROMENU",73,0)
 G END
"RTN","SROMENU",74,0)
NO ;
"RTN","SROMENU",75,0)
 W !!,"An operative procedure must be selected to use this option.",!
"RTN","SROMENU",76,0)
 W !!,"Press RETURN to continue  " R X:DTIME
"RTN","SROMENU",77,0)
END ;
"RTN","SROMENU",78,0)
 I $D(SROERR) D ^SROERR0
"RTN","SROMENU",79,0)
 I $G(SRLCK) D UNLOCK^SROUTL(SRTN)
"RTN","SROMENU",80,0)
 K SRDTIME D ^SRSKILL W @IOF
"RTN","SROMENU",81,0)
 Q
"RTN","SROMENU",82,0)
RT ; start RT logging
"RTN","SROMENU",83,0)
 I $G(SRTN),$D(XRTL) S XRTN="SROMENU" D T0^%ZOSV
"RTN","SROMENU",84,0)
 Q
"RTN","SROMOD")
0^66^B34361425
"RTN","SROMOD",1,0)
SROMOD ;BIR/ADM - CPT Modifier Input ; [ 02/27/01  6:32 AM ]
"RTN","SROMOD",2,0)
 ;;3.0; Surgery ;**88,100**;24 Jun 93
"RTN","SROMOD",3,0)
 Q
"RTN","SROMOD",4,0)
DISPLAY ; display name with modifier
"RTN","SROMOD",5,0)
 N SRY S SRY=$$MOD^ICPTMOD(Y,"I") Q:$P(SRY,"^")=-1
"RTN","SROMOD",6,0)
 S Y=$P(SRY,"^",2)_"  "_$P(SRY,"^",3)
"RTN","SROMOD",7,0)
 Q
"RTN","SROMOD",8,0)
SCR27() ; screen for acceptable CPT code/modifier pair for principal procedure
"RTN","SROMOD",9,0)
 N SRCODE,SRDA,SRCMOD,SROK,SRSDATE,SRZ D PCHK K SRM
"RTN","SROMOD",10,0)
 Q SROK
"RTN","SROMOD",11,0)
PCHK ; return value of modifier if acceptable for principal procedure
"RTN","SROMOD",12,0)
 S SROK=0,SRCODE="",SRDA=$S($G(SRTN):SRTN,$D(DA(1)):DA(1),$D(DA):DA,1:""),SRM=$S($D(SRM):SRM,1:+Y)
"RTN","SROMOD",13,0)
 I SRDA S SRSDATE=$P(^SRF(SRDA,0),"^",9),SRCODE=$P($G(^SRF(SRDA,"OP")),"^",2)
"RTN","SROMOD",14,0)
 I 'SRCODE Q
"RTN","SROMOD",15,0)
 S SRZ=$P($$MODP^ICPTMOD(SRCODE,SRM,"I",SRSDATE),"^") I SRZ>0 S SROK=SRZ
"RTN","SROMOD",16,0)
 Q
"RTN","SROMOD",17,0)
OTH() ; screen for acceptable CPT code/modifier pair for other procedure
"RTN","SROMOD",18,0)
 N SRCODE,SRDA,SRCMOD,SROK,SROTH,SRSDATE,SRZ D OCHK K SRM
"RTN","SROMOD",19,0)
 Q SROK
"RTN","SROMOD",20,0)
OCHK ; return value of modifier if acceptable for other procedure
"RTN","SROMOD",21,0)
 S SROK=0,SRCODE="",SRDA=$S($G(SRTN):SRTN,$D(DA(2)):DA(2),$D(DA(1)):DA(1),$D(D0):D0,1:""),SROTH=$S($D(DA):DA,$D(D1):D1,1:""),SRM=$S($D(SRM):SRM,1:+Y)
"RTN","SROMOD",22,0)
 I SRDA&SROTH S SRSDATE=$P(^SRF(SRDA,0),"^",9),SRCODE=$P($G(^SRF(SRDA,13,SROTH,2)),"^")
"RTN","SROMOD",23,0)
 I 'SRCODE Q
"RTN","SROMOD",24,0)
 S SRZ=$P($$MODP^ICPTMOD(SRCODE,SRM,"I",SRSDATE),"^") I SRZ>0 S SROK=SRZ
"RTN","SROMOD",25,0)
 Q
"RTN","SROMOD",26,0)
SPRIN ; set logic for ACPT x-ref
"RTN","SROMOD",27,0)
 Q:$E($G(IOST))'="C"!($G(DIK)'="")
"RTN","SROMOD",28,0)
 N SRCODE,SRDA,SRDEF,SRIEN,SRJ,SRQ,SRSDATE,SRSEL,SRSOUT,SRX,SRY,Z S (SRQ,SRSOUT)=0,SRCODE=X N X I $D(SRCMOD) D HYPH27
"RTN","SROMOD",29,0)
 S SRDA=DA,SRIEN=$O(^SRF(SRDA,"OPMOD","AAA"),-1) I SRIEN S SRX=$P(^SRF(SRDA,"OPMOD",SRIEN,0),"^"),SRCMOD=$P($$MOD^ICPTMOD(SRX,"I"),"^",2)
"RTN","SROMOD",30,0)
 K DIR F  D  K SRM,SRCMOD Q:SRSOUT  S SRQ=0
"RTN","SROMOD",31,0)
 .S DIR("A")=" Modifier: ",DIR(0)="130.028,.01AO" S:$G(SRCMOD)'="" DIR("B")=SRCMOD D:$O(^SRF(SRDA,"OPMOD",0)) QUES
"RTN","SROMOD",32,0)
 .D ^DIR K DIR S DA=SRDA I $D(DTOUT)!$D(DUOUT)!(X="") S SRSOUT=1 Q
"RTN","SROMOD",33,0)
 .I +Y S SRJ=0 F  S SRJ=$O(^SRF(SRDA,"OPMOD",SRJ)) Q:'SRJ  I $P(^SRF(SRDA,"OPMOD",SRJ,0),"^")=+Y N DIR D  Q
"RTN","SROMOD",34,0)
 ..S SRSEL=Y(0),DIR(0)="130.028,.01AO",DIR("A")="   Modifier: ",DIR("B")=$P(Y(0),"^")
"RTN","SROMOD",35,0)
 ..D ^DIR S DA=SRDA I $D(DTOUT)!$D(DUOUT)!(X="") S SRSOUT=1 Q
"RTN","SROMOD",36,0)
 ..I +Y S SRK=0 F  S SRK=$O(^SRF(SRDA,"OPMOD",SRK)) Q:'SRK  I $P(^SRF(SRDA,"OPMOD",SRK,0),"^")=+Y S SRQ=1 Q
"RTN","SROMOD",37,0)
 ..Q:SRQ  I +Y S $P(^SRF(SRDA,"OPMOD",SRJ,0),"^")=+Y,SRQ=1 Q
"RTN","SROMOD",38,0)
 ..I X="@" S SRY(130.028,SRJ_","_SRDA_",",.01)="@" D FILE^DIE("","SRY"),EN^DDIOL(" ... Modifier deleted","","?20") S SRQ=1
"RTN","SROMOD",39,0)
 .Q:SRQ!SRSOUT
"RTN","SROMOD",40,0)
 .I +Y S SRY(130.028,"+1,"_DA_",",.01)=+Y D UPDATE^DIE("","SRY") Q
"RTN","SROMOD",41,0)
 .I X="@",$D(SRCMOD) S SRY(130.028,SRIEN_","_SRDA_",",.01)="@" D FILE^DIE("","SRY"),EN^DDIOL(" ... Modifier deleted","","?20")
"RTN","SROMOD",42,0)
 Q
"RTN","SROMOD",43,0)
KPRIN ; kill logic for ACPT x-ref
"RTN","SROMOD",44,0)
 Q:$E($G(IOST))'="C"!($G(DIK)'="")  K ^SRF(DA,"OPMOD")
"RTN","SROMOD",45,0)
 Q
"RTN","SROMOD",46,0)
SOTH ; set logic for ACPT1 x-ref
"RTN","SROMOD",47,0)
 Q:$E($G(IOST))'="C"!($G(DIK)'="")
"RTN","SROMOD",48,0)
 N SRCODE,SRDA,SRDEF,SRIEN,SRJ,SRQ,SRSDATE,SRSEL,SRSOUT,SRX,SRY,Z S (SRQ,SRSOUT)=0,SRCODE=X N X I $D(SRCMOD) D HYPHOTH
"RTN","SROMOD",49,0)
 S SRDA=DA,SRDA(1)=DA(1),SRIEN=$O(^SRF(SRDA(1),13,SRDA,"MOD","A"),-1) I SRIEN S SRX=$P(^SRF(SRDA(1),13,SRDA,"MOD",SRIEN,0),"^"),SRCMOD=$P($$MOD^ICPTMOD(SRX,"I"),"^",2)
"RTN","SROMOD",50,0)
 K DIR F  D  K SRM,SRCMOD Q:SRSOUT  S SRQ=0
"RTN","SROMOD",51,0)
 .S DIR("A")=" Modifier: ",DIR(0)="130.164,.01AO" S:$G(SRCMOD)'="" DIR("B")=SRCMOD D:$O(^SRF(SRDA(1),13,SRDA,"MOD",0)) QUES1
"RTN","SROMOD",52,0)
 .D ^DIR K DIR S DA=SRDA,DA(1)=SRDA(1) I $D(DTOUT)!$D(DUOUT)!(X="") S SRSOUT=1 Q
"RTN","SROMOD",53,0)
 .I +Y S SRJ=0 F  S SRJ=$O(^SRF(SRDA(1),13,SRDA,"MOD",SRJ)) Q:'SRJ  I $P(^SRF(SRDA(1),13,SRDA,"MOD",SRJ,0),"^")=+Y N DIR D  Q
"RTN","SROMOD",54,0)
 ..S SRSEL=Y(0),DIR(0)="130.164,.01AO",DIR("A")="   Modifier: ",DIR("B")=$P(Y(0),"^")
"RTN","SROMOD",55,0)
 ..D ^DIR S DA=SRDA I $D(DTOUT)!$D(DUOUT)!(X="") S SRSOUT=1 Q
"RTN","SROMOD",56,0)
 ..I +Y S SRK=0 F  S SRK=$O(^SRF(SRDA(1),13,SRDA,"MOD",SRK)) Q:'SRK  I $P(^SRF(SRDA(1),13,SRDA,"MOD",SRK,0),"^")=+Y S Y="" Q
"RTN","SROMOD",57,0)
 ..I X="@" S SRY(130.164,SRJ_","_SRDA_","_SRDA(1)_",",.01)="@" D FILE^DIE("","SRY"),EN^DDIOL(" ... Modifier deleted","","?20") S SRQ=1
"RTN","SROMOD",58,0)
 .Q:SRQ!SRSOUT
"RTN","SROMOD",59,0)
 .I +Y S SRY(130.164,"+1,"_DA_","_DA(1)_",",.01)=+Y D UPDATE^DIE("","SRY") Q
"RTN","SROMOD",60,0)
 .I X="@",$D(SRCMOD) S SRY(130.164,SRIEN_","_SRDA_",",SRDA(1)_",",.01)="@" D FILE^DIE("","SRY"),EN^DDIOL(" ... Modifier deleted","","?20")
"RTN","SROMOD",61,0)
 Q
"RTN","SROMOD",62,0)
KOTH ; kill logic for ACPT1 x-ref
"RTN","SROMOD",63,0)
 Q:$E($G(IOST))'="C"!($G(DIK)'="")  K ^SRF(DA(1),13,DA,"MOD")
"RTN","SROMOD",64,0)
 Q
"RTN","SROMOD",65,0)
HYPH27 ; input CPT hyphenated modifier for principal procedure
"RTN","SROMOD",66,0)
 N SRCODE,SRDA,SRDUP,SRLIST,SRN,SROK,SRY S SRLIST=SRCMOD
"RTN","SROMOD",67,0)
 F SRN=1:1 S SRCMOD=$P(SRLIST,",",SRN) Q:SRCMOD=""  D
"RTN","SROMOD",68,0)
 .S (SRDUP,SROK)=0
"RTN","SROMOD",69,0)
 .S SRM=$P($$MOD^ICPTMOD(SRCMOD),"^") K:SRM<0 SRM I $D(SRM) D PCHK K SRM
"RTN","SROMOD",70,0)
 .I 'SROK D EN^DDIOL("CPT Modifier '"_SRCMOD_"' is not acceptable with this CPT code.","","!") K SRCMOD Q
"RTN","SROMOD",71,0)
 .S SRJ=0 F  S SRJ=$O(^SRF(SRDA,"OPMOD",SRJ)) Q:'SRJ  I $P(^SRF(SRDA,"OPMOD",SRJ,0),"^")=SROK S SRDUP=1 Q
"RTN","SROMOD",72,0)
 .I 'SRDUP S SRY(130.028,"+1,"_DA_",",.01)=SROK D UPDATE^DIE("","SRY")
"RTN","SROMOD",73,0)
 Q
"RTN","SROMOD",74,0)
HYPHOTH ; input CPT hyphenated modifier for other procedure
"RTN","SROMOD",75,0)
 N SRCODE,SRDA,SRDUP,SRLIST,SRN,SROK,SROTH,SRY S SRLIST=SRCMOD
"RTN","SROMOD",76,0)
 F SRN=1:1 S SRCMOD=$P(SRLIST,",",SRN) Q:SRCMOD=""  D
"RTN","SROMOD",77,0)
 .S (SRDUP,SROK)=0
"RTN","SROMOD",78,0)
 .S SRM=$P($$MOD^ICPTMOD(SRCMOD),"^") K:SRM<0 SRM I $D(SRM) D OCHK K SRM
"RTN","SROMOD",79,0)
 .I 'SROK D EN^DDIOL("CPT Modifier '"_SRCMOD_"' is not acceptable with this CPT code.","","!") K SRCMOD Q
"RTN","SROMOD",80,0)
 .S SRJ=0 F  S SRJ=$O(^SRF(SRDA,13,SROTH,"MOD",SRJ)) Q:'SRJ  I $P(^SRF(SRDA,13,SROTH,"MOD",SRJ,0),"^")=SROK S SRDUP=1 Q
"RTN","SROMOD",81,0)
 .I 'SRDUP S SRY(130.164,"+1,"_DA_","_DA(1)_",",.01)=SROK D UPDATE^DIE("","SRY")
"RTN","SROMOD",82,0)
 Q
"RTN","SROMOD",83,0)
QUES N SRI,SRMD,SRX,SRY,SRZ S DIR("?",1)=" Answer with PRIN. PROCEDURE CPT MODIFIER",DIR("?",2)="Choose from:"
"RTN","SROMOD",84,0)
 S SRI=0,SRCT=3 F  S SRI=$O(^SRF(SRDA,"OPMOD",SRI)) Q:'SRI  S SRMD=$P(^SRF(SRDA,"OPMOD",SRI,0),"^") D
"RTN","SROMOD",85,0)
 .S SRX=$$MOD^ICPTMOD(SRMD,"I"),SRY=$P(SRX,"^",2),SRZ=$P(SRX,"^",3)
"RTN","SROMOD",86,0)
 .S DIR("?",SRCT)="   "_SRY_"   "_SRZ,SRCT=SRCT+1
"RTN","SROMOD",87,0)
 S DIR("?",SRCT)="",DIR("?")="     You may enter a new PRIN. PROCEDURE CPT MODIFIER, if you wish."
"RTN","SROMOD",88,0)
 Q
"RTN","SROMOD",89,0)
QUES1 N SRI,SRMD,SRX,SRY,SRZ S DIR("?",1)=" Answer with OTHER PROCEDURE CPT MODIFIER",DIR("?",2)="Choose from:"
"RTN","SROMOD",90,0)
 S SRI=0,SRCT=3 F  S SRI=$O(^SRF(SRDA(1),13,SRDA,"MOD",SRI)) Q:'SRI  S SRMD=$P(^SRF(SRDA(1),13,SRDA,"MOD",SRI,0),"^") D
"RTN","SROMOD",91,0)
 .S SRX=$$MOD^ICPTMOD(SRMD,"I"),SRY=$P(SRX,"^",2),SRZ=$P(SRX,"^",3)
"RTN","SROMOD",92,0)
 .S DIR("?",SRCT)="   "_SRY_"   "_SRZ,SRCT=SRCT+1
"RTN","SROMOD",93,0)
 S DIR("?",SRCT)="",DIR("?")="     You may enter a new OTHER PROCEDURE CPT MODIFIER, if you wish."
"RTN","SROMOD",94,0)
 Q
"RTN","SROMOD",95,0)
  
"RTN","SRONASS")
0^67^B17514802
"RTN","SRONASS",1,0)
SRONASS ;B'HAM ISC/MAM - NO ASSESSMENT REASON ; [ 02/19/04  10:10 AM ]
"RTN","SRONASS",2,0)
 ;;3.0; Surgery ;**38,47,83,107,121,100**;24 Jun 93
"RTN","SRONASS",3,0)
 K SRTN N SRSEL D ^SROPSEL I '$D(DFN) S SROUT=1 G END
"RTN","SRONASS",4,0)
 D @$S(SRSEL=2:"^SROPSN",1:"STL^SROPS") I '$D(SRTN)  S SRSOUT=1 G END
"RTN","SRONASS",5,0)
 S X=$P($G(^SRF(SRTN,"RA")),"^",6) I X="Y" D ASS I 'OK G END
"RTN","SRONASS",6,0)
 N SRLCK S SRLCK=$$LOCK^SROUTL(SRTN) I 'SRLCK G END
"RTN","SRONASS",7,0)
 D SRA^SROES
"RTN","SRONASS",8,0)
 W ! K DIR S X=$P($G(^SRF(SRTN,"RA")),"^",7) I X'="" D SET S DIR("B")=X
"RTN","SRONASS",9,0)
 S DIR(0)="130,102",DIR("A")="Reason an Assessment was not Created" D ^DIR K DIR I $D(DTOUT)!$D(DUOUT)!(Y=""&(X'="@")) S SRSOUT=1 G END
"RTN","SRONASS",10,0)
 I X="@" D DELETE G END1
"RTN","SRONASS",11,0)
 I X'="" K DR,DA,DIE S DIE=130,DR="102///"_X_";323////N;284////N;Q;235////C",DA=SRTN D ^DIE K DR,DIE,DA
"RTN","SRONASS",12,0)
 D ^SROAEX S SROERR=SRTN D ^SROERR0
"RTN","SRONASS",13,0)
END1 K DA,DIK S DIK="^SRF(",DIK(1)=".232^AQ",DA=SRTN D EN1^DIK
"RTN","SRONASS",14,0)
 D EXIT^SROES
"RTN","SRONASS",15,0)
END I $G(SRLCK) D UNLOCK^SROUTL(SRTN)
"RTN","SRONASS",16,0)
 K SRTN D ^SRSKILL W @IOF
"RTN","SRONASS",17,0)
 Q
"RTN","SRONASS",18,0)
LOOP ; break procedure
"RTN","SRONASS",19,0)
 S SROPS(M)="" F LOOP=1:1 S MM=$P(SROPER," "),MMM=$P(SROPER," ",2,200) Q:MMM=""  Q:$L(SROPS(M))+$L(MM)'<60  S SROPS(M)=SROPS(M)_MM_" ",SROPER=MMM
"RTN","SRONASS",20,0)
 Q
"RTN","SRONASS",21,0)
OTHER ; other operations
"RTN","SRONASS",22,0)
 S SRLONG=1 I $L(SROPER)+$L($P(^SRF(SRTN,13,SROTHER,0),"^"))>235 S SRLONG=0,SROTHER=999,SROPERS=" ..."
"RTN","SRONASS",23,0)
 I SRLONG S SROPERS=$P(^SRF(SRTN,13,SROTHER,0),"^")
"RTN","SRONASS",24,0)
 S SROPER=SROPER_$S(SROPERS=" ...":SROPERS,1:", "_SROPERS)
"RTN","SRONASS",25,0)
 Q
"RTN","SRONASS",26,0)
SET ; expand reason for no assessment code
"RTN","SRONASS",27,0)
 S Y=X,C=$P(^DD(130,102,0),"^",2) D Y^DIQ S X=Y
"RTN","SRONASS",28,0)
 Q
"RTN","SRONASS",29,0)
ASS ; assessment already exists
"RTN","SRONASS",30,0)
 S OK=0 W !!,"According to your records, an assessment should be created for this surgical",!,"case."
"RTN","SRONASS",31,0)
ASK W !!,"Do you want to update this information and not create a surgery risk ",!,"assessment for this case ?  NO// " R SRYN:DTIME I '$T!(SRYN["^") S OK="" Q
"RTN","SRONASS",32,0)
 S SRYN=$E(SRYN) S:SRYN="" SRYN="N" I "YyNn"'[SRYN S SRYN="?"
"RTN","SRONASS",33,0)
 I SRYN="?" W !!,"If this case will not be used for the risk assessment study, Enter 'YES' to ",!,"change the status.  You will then be prompted for the reason that no assessment",!,"was done.  Enter 'NO' to leave this case unchanged."
"RTN","SRONASS",34,0)
 I SRYN="?" G ASK
"RTN","SRONASS",35,0)
 I "Yy"[SRYN S OK=1
"RTN","SRONASS",36,0)
 I "Nn"[SRYN W !!,"No action taken.",!!,"Press RETURN to continue  " R X:DTIME
"RTN","SRONASS",37,0)
 Q
"RTN","SRONASS",38,0)
DELETE ; delete no assessment reason
"RTN","SRONASS",39,0)
 W !!,"If you delete the reason why no assessment was created for this case, the",!,"computer will automatically update your records to make this a non-assessed",!,"case."
"RTN","SRONASS",40,0)
 W !!,"Are you sure that you want to delete the reason ?  NO// " R SRYN:DTIME I '$T!(SRYN["^") S SRSOUT=1 Q
"RTN","SRONASS",41,0)
 S SRYN=$E(SRYN) S:SRYN="" SRYN="N" I "YyNn"'[SRYN S SRYN="?"
"RTN","SRONASS",42,0)
 I SRYN="?" W !!,"By entering an '@', you have told the computer that you want to remove the ",!,"reason why no assessment was created for this case.  If this reason should be",!,"deleted, enter 'YES'." G DELETE
"RTN","SRONASS",43,0)
 I "Nn"[SRYN S SRSOUT=1 W !!,"No action taken.",!!,"Press RETURN to continue  " R X:DTIME Q
"RTN","SRONASS",44,0)
 W !!,"Updating to non-assessed status..." D DRDEL W !!,"Press RETURN to continue  " R X:DTIME
"RTN","SRONASS",45,0)
 Q
"RTN","SRONASS",46,0)
DRDEL K DR,DIE,DA S DIE=130,DA=SRTN,DR="235///@;284///@;393///@;260///@;272///@;323///@;102///@;260.1///@" D ^DIE K DR,DIE,DA
"RTN","SRONASS",47,0)
 Q
"RTN","SRONEW")
0^68^B19521613
"RTN","SRONEW",1,0)
SRONEW ;B'HAM ISC/MAM - ENTER A NEW CASE   ; [ 01/29/01  1:09 PM ]
"RTN","SRONEW",2,0)
 ;;3.0; Surgery ;**3,23,26,30,47,58,48,67,107,100**;24 Jun 93
"RTN","SRONEW",3,0)
 ;
"RTN","SRONEW",4,0)
 ; Reference to ^TMP("CSLSUR1" supported by DBIA #3498
"RTN","SRONEW",5,0)
 ;
"RTN","SRONEW",6,0)
DEAD S SRSOUT=0,X=$P($G(VADM(6)),"^") I X D  I SRSOUT D ^SRSKILL G ^SROP
"RTN","SRONEW",7,0)
 .S SRDEATH=$E(X,4,5)_"/"_$E(X,6,7)_"/"_$E(X,2,3) W @IOF,!,?1,VADM(1)_"   "_VA("PID")_"        * Died "_SRDEATH_" *"
"RTN","SRONEW",8,0)
 .W !!,$C(7) K DIR S DIR("A",1)=">>> The patient you have selected died on "_SRDEATH_"."
"RTN","SRONEW",9,0)
 .S DIR("A")="    Are you sure this is the correct patient ? ",DIR("B")="NO",DIR(0)="YA" D ^DIR K DIR
"RTN","SRONEW",10,0)
 .W @IOF I 'Y!$D(DTOUT)!$D(DUOUT) S SRSOUT=1 Q
"RTN","SRONEW",11,0)
 .W !,"Entering a new surgical case for "_VADM(1)_".",!!
"RTN","SRONEW",12,0)
DATE K %DT W ! S %DT("A")="Select the Date of Operation: ",%DT="AEX" D ^%DT I Y<0 W !!,"When entering a new surgery case, a date MUST be entered.  If you do not",!,"know the date of operation, enter this patient on the Waiting List."
"RTN","SRONEW",13,0)
 I Y<0 D CONT G:"Yy"'[SRYN END G DATE
"RTN","SRONEW",14,0)
 G:Y'>0 END S SRSDATE=Y
"RTN","SRONEW",15,0)
 S SRSC1=1 K SRCTN S SRSDPT=DFN,SRSCC="" D CON G:SRSCC="^" END
"RTN","SRONEW",16,0)
OP D ^SROPROC I SRSOUT G END
"RTN","SRONEW",17,0)
 S SRPRIN=SRSOP
"RTN","SRONEW",18,0)
DOC W ! S DIC("A")="Select Surgeon: ",DIC=200,DIC(0)="QEAM",SRSDOC="" D ^DIC K DIC("A") G:Y<0 END S (DA,SRSDOC)=+Y
"RTN","SRONEW",19,0)
 S RESTRICT="130,.14",Y=SRSDOC K SROK D KEY^SROXPR I '$D(SROK) W !!,"The person you selected does not have the appropriate keys necessary to be",!,"entered as a surgeon.  Please make another selection.",! K SRSDOC,DA,DIC G DOC
"RTN","SRONEW",20,0)
 W ! K DIC S DIC=137.45,DIC(0)="QEAMZ",DIC("A")="Select Surgical Specialty: ",DIC("S")="I '$P(^(0),""^"",3)" D ^DIC I Y<0 S SRSOUT=1 G END
"RTN","SRONEW",21,0)
 S SRSS=+Y
"RTN","SRONEW",22,0)
 K DA,DIC,DD,DO,DINUM,SRTN S X=DFN,DIC="^SRF(",DIC(0)="L",DLAYGO=130 D FILE^DICN K DIC,DLAYGO S SRTN=+Y G:'$$LOCK^SROUTL(SRTN) END
"RTN","SRONEW",23,0)
 K DIE,DR S DA=SRTN,DIE=130,DR=".09////"_SRSDATE_";26////"_SRPRIN_";68////"_SRPRIN_";.04////"_SRSS_";.14////"_SRSDOC D ^DIE K DR
"RTN","SRONEW",24,0)
IND W ! S DIE=130,DA=SRTN,DR="55" D ^DIE
"RTN","SRONEW",25,0)
 I '$O(^SRF(SRTN,40,0)) D ^SRSIND G:'$D(SRTN) END G IND
"RTN","SRONEW",26,0)
 K DR S DR="60T",DA=SRTN,DIE=130 W ! D ^DIE
"RTN","SRONEW",27,0)
 K DR,DA S DR="[SRO-NOCOMP]",DA=SRTN,DIE=130 D ^DIE K DR
"RTN","SRONEW",28,0)
 S ^SRF(SRTN,8)=SRSITE("DIV") D ^SROXRET
"RTN","SRONEW",29,0)
DIE D ^SROBLOD K DR,DIE,DA S DR="38////"_BLOOD_";40////"_CROSSM,DA=SRTN,DIE=130 D ^DIE K DR,DA,DIE
"RTN","SRONEW",30,0)
 S DR="[SRSRES1]",DIE=130,DA=SRTN D ^DIE,RT S ST="NEW SURGERY" D EN2^SROVAR
"RTN","SRONEW",31,0)
 S SPD=$$CHKS^SRSCOR(SRTN)
"RTN","SRONEW",32,0)
 K DR S DR="[SRSRES-ENTRY]",DIE=130,DA=SRTN D ^SRCUSS,RISK^SROAUTL3,^SROPCE1
"RTN","SRONEW",33,0)
 I SPD'=$$CHKS^SRSCOR(SRTN) S ^TMP("CSLSUR1",$J)=""
"RTN","SRONEW",34,0)
 I $D(SRCTN) D
"RTN","SRONEW",35,0)
 .S SRCTN(.02)=$P(^SRF(SRCTN,0),"^",2),SRCTN(10)=$P($G(^SRF(SRCTN,31)),"^",4),SRCTN(11)=$P($G(^SRF(SRCTN,31)),"^",5)
"RTN","SRONEW",36,0)
 .S DIE=130,DR=".02////"_SRCTN(.02)_";10////"_SRCTN(10)_";11////"_SRCTN(11)_";35////"_SRCTN,DA=SRTN D ^DIE
"RTN","SRONEW",37,0)
 .S DR="35////"_SRTN,DA=SRCTN,DIE=130 D ^DIE
"RTN","SRONEW",38,0)
 D UNLOCK^SROUTL(SRTN),^SROERR
"RTN","SRONEW",39,0)
 Q
"RTN","SRONEW",40,0)
END K SRTN D ^SRSKILL
"RTN","SRONEW",41,0)
 Q
"RTN","SRONEW",42,0)
CONT ; continue new entry ?
"RTN","SRONEW",43,0)
 W !!,"Do you want to continue  ?  YES//  " R SRYN:DTIME I '$T S SRYN="N" Q
"RTN","SRONEW",44,0)
 S SRYN=$E(SRYN) S:SRYN="" SRYN="Y" I "YyNn"'[SRYN W !!,"Enter RETURN if you want to re-enter a date and continue creating a new",!,"case, or 'NO' to leave this option." G CONT
"RTN","SRONEW",45,0)
 Q
"RTN","SRONEW",46,0)
RT ;start RT logging
"RTN","SRONEW",47,0)
 I $D(XRTL) S XRTN="SRONEW" D T0^%ZOSV
"RTN","SRONEW",48,0)
 Q
"RTN","SRONEW",49,0)
CON ; check for concurrent case
"RTN","SRONEW",50,0)
 S SRSCON=0,SRDT=SRSDATE-.0001 F  S SRDT=$O(^SRF("AC",SRDT)) Q:'SRDT!($E(SRDT,1,7)'=SRSDATE)!(SRSCON)  S (SRSCC,SRSCON)=0 F  S SRSCC=$O(^SRF("AC",SRDT,SRSCC)) Q:'SRSCC  D  Q:SRSCON
"RTN","SRONEW",51,0)
 .I ^(SRSCC)=SRSDPT,'$P($G(^SRF(SRSCC,"CON")),"^"),$P($G(^SRF(SRSCC,"NON")),"^")'="Y",'$P($G(^SRF(SRSCC,30)),"^"),'$P($G(^SRF(SRSCC,.2)),"^",12),'$P($G(^SRF(SRSCC,"LOCK")),"^") S SRSCON=1
"RTN","SRONEW",52,0)
 .I SRSCON D CC^SRSREQ I '$D(SRCTN) S SRSCON=0
"RTN","SRONEW",53,0)
 Q
"RTN","SRONIN")
0^69^B55479643
"RTN","SRONIN",1,0)
SRONIN ;B'HAM ISC/MAM,ADM - NURSE INTRAOPERATIVE REPORT ; [ 02/19/04  9:06 AM ]
"RTN","SRONIN",2,0)
 ;;3.0; Surgery ;**68,50,100**;24 Jun 93
"RTN","SRONIN",3,0)
 ;
"RTN","SRONIN",4,0)
 ;** NOTICE: This routine is part of an implementation of a nationally
"RTN","SRONIN",5,0)
 ;**         controlled procedure.  Local modifications to this routine
"RTN","SRONIN",6,0)
 ;**         are prohibited.
"RTN","SRONIN",7,0)
 ;
"RTN","SRONIN",8,0)
 ; Reference to UPDATE^TIUSRVP supported by DBIA #3535
"RTN","SRONIN",9,0)
 ; Reference to ES^TIUSROI supported by DBIA #3537
"RTN","SRONIN",10,0)
 ; Reference to EXTRACT^TIULQ supported by DBIA #2693
"RTN","SRONIN",11,0)
 ;
"RTN","SRONIN",12,0)
 I '$D(SRSITE) D ^SROVAR G:'$D(SRSITE) END S SRSITE("KILL")=1
"RTN","SRONIN",13,0)
 I '$D(SRTN) K SRNEWOP D ^SROPS G:'$D(SRTN) END S SRTN("KILL")=1
"RTN","SRONIN",14,0)
 N SRAGE,SRDIV,SRDIVNM,SRDO,SRFUNCT,SRHDR,SRINUSE,SRLEAVE,SRLOC,SRPARAM,SRPRINT,SRSEL,SRSINED,SRDTITL,SRTIU,SRSTAT,SRXX
"RTN","SRONIN",15,0)
 S SRDTITL="Nurse Intraoperative Report"
"RTN","SRONIN",16,0)
 S (SRFUNCT,SRLEAVE,SRSINED)=0,SRTIU=$P($G(^SRF(SRTN,"TIU")),"^",2)
"RTN","SRONIN",17,0)
 I SRTIU,$$STATUS^SROESUTL(SRTIU)=7 S SRSINED=1
"RTN","SRONIN",18,0)
 D:SRSINED FUNCT D:'SRSINED EN
"RTN","SRONIN",19,0)
ENF I 'SRLEAVE,SRFUNCT S SRSEL="" D FUNCT
"RTN","SRONIN",20,0)
 D END
"RTN","SRONIN",21,0)
 Q
"RTN","SRONIN",22,0)
DISPLY I SRSINED S SRTIU=$P($G(^SRF(SRTN,"TIU")),"^",2) I SRTIU D PRNT^SROESPR(SRTN,SRTIU,SRDTITL) S SRLEAVE=1 Q
"RTN","SRONIN",23,0)
 K %ZIS,IO("Q") S %ZIS="Q" D ^%ZIS I POP S SRLEAVE=1 Q
"RTN","SRONIN",24,0)
 I $D(IO("Q")) K IO("Q") N ZTRTN,ZTDESC,ZTSAVE,ZTQUEUED S ZTRTN="PRNT^SRONIN",ZTDESC=SRDTITL,(ZTSAVE("SRTN"),ZTSAVE("SRSITE*"))="" D ^%ZTLOAD,^%ZISC Q
"RTN","SRONIN",25,0)
EN D RPT^SRONRPT(SRTN) S DFN=$P(^SRF(SRTN,0),"^"),VAINDT=$P(^SRF(SRTN,0),"^",9)
"RTN","SRONIN",26,0)
 S Y=$E(VAINDT,1,7) D D^DIQ S SRSDATE=Y D OERR^VADPT
"RTN","SRONIN",27,0)
 S SRHDR=" "_VADM(1)_" ("_VA("PID")_")   Case #"_SRTN_" - "_SRSDATE
"RTN","SRONIN",28,0)
 S Y=$E($$NOW^XLFDT,1,12) D DD^%DT S SRPRINT="Printed: "_Y
"RTN","SRONIN",29,0)
 S SRLOC=" Pt Loc: "_$P(VAIN(4),"^",2)_"  "_VAIN(5)
"RTN","SRONIN",30,0)
 S SRAGE="",Z=$P(VADM(3),"^") I Z S X=$E($P(^SRF(SRTN,0),"^",9),1,12),Y=$E(X,1,7),SRAGE=$E(Y,1,3)-$E(Z,1,3)-($E(Y,4,7)<$E(Z,4,7))
"RTN","SRONIN",31,0)
 S SRDIV=$$SITE^SROUTL0(SRTN),SRDIVNM="" I SRDIV S X=$P(^SRO(133,SRDIV,0),"^"),SRDIVNM=$$EXTERNAL^DILFD(133,.01,"",X)
"RTN","SRONIN",32,0)
 S SRDIVNM=$S(SRDIVNM'="":SRDIVNM,1:SRSITE("SITE"))
"RTN","SRONIN",33,0)
 U IO S (SRPAGE,SRSOUT)=0,$P(SRLINE,"-",80)="" D HDR
"RTN","SRONIN",34,0)
 S SRI=0 F  S SRI=$O(^TMP("SRNIR",$J,SRTN,SRI)) Q:'SRI  D  Q:SRSOUT
"RTN","SRONIN",35,0)
 .I $E(IOST)="P",$Y+11>IOSL D FOOT Q:SRSOUT  D HDR
"RTN","SRONIN",36,0)
 .I $E(IOST)'="P",$Y+4>IOSL D FOOT Q:SRSOUT  D HDR
"RTN","SRONIN",37,0)
 .W !,^TMP("SRNIR",$J,SRTN,SRI)
"RTN","SRONIN",38,0)
 I SRSOUT D ^%ZISC Q 
"RTN","SRONIN",39,0)
 D FOOT D  D ^%ZISC
"RTN","SRONIN",40,0)
 .I $D(SRALRT) S SRFUNCT=1 Q
"RTN","SRONIN",41,0)
 .I '$G(SRFUNCT) S SRLEAVE=1
"RTN","SRONIN",42,0)
 Q
"RTN","SRONIN",43,0)
SRHDR S DFN=$P(^SRF(SRTN,0),"^") D DEM^VADPT
"RTN","SRONIN",44,0)
 S Y=$E($P(^SRF(SRTN,0),"^",9),1,7) D D^DIQ S SRSDATE=Y
"RTN","SRONIN",45,0)
 S SRHDR=" "_VADM(1)_" ("_VA("PID")_")   Case #"_SRTN_" - "_SRSDATE
"RTN","SRONIN",46,0)
 Q
"RTN","SRONIN",47,0)
PRNT N SRDIV,SRFUNCT,SRLEAVE D EN
"RTN","SRONIN",48,0)
END K ^TMP("SRNIR",$J)
"RTN","SRONIN",49,0)
 W @IOF I $D(ZTQUEUED) Q:$G(ZTSTOP)  S ZTREQ="@" Q
"RTN","SRONIN",50,0)
 D ^SRSKILL K VAIN,VAINDT I $D(SRSITE("KILL")) K SRSITE
"RTN","SRONIN",51,0)
 I $D(SRTN("KILL")) K SRTN
"RTN","SRONIN",52,0)
 Q
"RTN","SRONIN",53,0)
PAGE I $D(SRNOEDIT) D LAST Q
"RTN","SRONIN",54,0)
 S (SRFUNCT,SRSOUT)=0
"RTN","SRONIN",55,0)
 W ! K DIR S DIR(0)="FOA",DIR("A",1)=" Press <return> to continue, 'A' to access Nurse Intraoperative Report",DIR("A")=" functions, or '^' to exit: " D ^DIR K DIR I $D(DTOUT)!$D(DUOUT) S (SRLEAVE,SRSOUT)=1 Q
"RTN","SRONIN",56,0)
 I X="A"!(X="a") S (SRFUNCT,SRSOUT)=1
"RTN","SRONIN",57,0)
 Q
"RTN","SRONIN",58,0)
LAST W ! K DIR S DIR(0)="E" D ^DIR K DIR I $D(DTOUT)!$D(DUOUT) S SRSOUT=1
"RTN","SRONIN",59,0)
 Q
"RTN","SRONIN",60,0)
FOOT ; print footer
"RTN","SRONIN",61,0)
 Q:SRSOUT  I $E(IOST)'="P" D PAGE Q
"RTN","SRONIN",62,0)
 I IOSL-9>$Y F X=$Y:1:(IOSL-10) W !
"RTN","SRONIN",63,0)
 W !,SRLINE,!,VADM(1),?50,SRPRINT,!,VA("PID")_"  Age: "_SRAGE,?50,SRLOC,!,SRDIVNM,?59,"Vice SF 509",!,SRLINE
"RTN","SRONIN",64,0)
 Q
"RTN","SRONIN",65,0)
HDR ; heading
"RTN","SRONIN",66,0)
 I $D(ZTQUEUED) D ^SROSTOP I SRHALT S SRSOUT=1 Q
"RTN","SRONIN",67,0)
 S SRPAGE=SRPAGE+1 I $Y'=0 W @IOF
"RTN","SRONIN",68,0)
 I $E(IOST)'="P",SRPAGE=1 S DFN=$P(^SRF(SRTN,0),"^") D DEM^VADPT S SRXX=VADM(1)_" ("_VA("PID")_")" W !,?(80-$L(SRXX)\2),SRXX
"RTN","SRONIN",69,0)
 W:$E(IOST)="P" !!!!,SRLINE W !,?3,"MEDICAL RECORD       NURSE INTRAOPERATIVE REPORT - CASE #"_SRTN,?(79-$L("PAGE "_SRPAGE)),"PAGE "_SRPAGE,!
"RTN","SRONIN",70,0)
 W:$E(IOST)="P" SRLINE,!
"RTN","SRONIN",71,0)
 Q
"RTN","SRONIN",72,0)
FUNCT ; nurse intraop report functions
"RTN","SRONIN",73,0)
 K SRALRT
"RTN","SRONIN",74,0)
 D:'$D(SRHDR) SRHDR S SRSOUT=0,SRTIU=$P($G(^SRF(SRTN,"TIU")),"^",2)
"RTN","SRONIN",75,0)
 I 'SRSINED,SRTIU,$$STATUS^SROESUTL(SRTIU)=7 S SRSINED=1
"RTN","SRONIN",76,0)
 W @IOF,!,SRHDR I SRSINED W !!," * * The Nurse Intraoperative Report has been electronically signed. * *"
"RTN","SRONIN",77,0)
 W !!," Nurse Intraoperative Report Functions:",!
"RTN","SRONIN",78,0)
 S DIR("A",1)="  1. Edit report information",DIR("A",2)="  2. Print/View report from beginning"
"RTN","SRONIN",79,0)
 S DIR("A",3)=$S('SRTIU:"",'SRSINED:"  3. Sign the report electronically",1:"") I SRTIU,'SRSINED S DIR("A",4)=""
"RTN","SRONIN",80,0)
 S DIR("A")="Select number: ",DIR("B")=2,DIR(0)="SAM^1:Edit report information;2:Print/View report from beginning"_$S(('SRSINED&SRTIU):";3:Sign the report electronically",1:"")
"RTN","SRONIN",81,0)
 D ^DIR K DIR I $D(DTOUT)!$D(DUOUT) S (SRLEAVE,SRSOUT)=1 D END Q
"RTN","SRONIN",82,0)
 S SRSEL=Y,SRDO=$S(SRSEL=1:"EDIT",SRSEL=3:"SIGN",1:"DISPLY")
"RTN","SRONIN",83,0)
 D @SRDO I $G(SRLCK) D UNLOCK^SROUTL(SRTN)
"RTN","SRONIN",84,0)
 S SRSOUT=0,SRFUNCT=1 D ENF
"RTN","SRONIN",85,0)
 Q
"RTN","SRONIN",86,0)
EDIT ; edit report data fields
"RTN","SRONIN",87,0)
 D CHECK^SROES I SRSOUT Q
"RTN","SRONIN",88,0)
 N SROLOCK,SRX,SRZ D ^SROLOCK I SROLOCK S Q3("VIEW")=""
"RTN","SRONIN",89,0)
 N SRLCK S SRLCK=$$LOCK^SROUTL(SRTN) I 'SRLCK Q
"RTN","SRONIN",90,0)
 K DA,DR,DIE S SRDTIME=DTIME,DTIME=3600,DIE=130,DA=SRTN,DR="[SRONRPT]",ST="NURSE INTRAOP"_$S(SROLOCK:" **LOCKED",1:"") D EN2^SROVAR,^SRCUSS S DTIME=SRDTIME K Q3("VIEW")
"RTN","SRONIN",91,0)
 I '$P(^SRF(SRTN,0),"^",20) D ^SROPCE1
"RTN","SRONIN",92,0)
 I $D(SRODR) D ^SROCON1
"RTN","SRONIN",93,0)
 S SROERR=SRTN D ^SROERR0
"RTN","SRONIN",94,0)
 D EXIT^SROES
"RTN","SRONIN",95,0)
 Q
"RTN","SRONIN",96,0)
SIGN ; sign report if appropriate user
"RTN","SRONIN",97,0)
 N SRLCK S SRLCK=$$LOCK^SROUTL(SRTN) I 'SRLCK Q
"RTN","SRONIN",98,0)
 N SRMISS,SRNUR,SROK,SRA,SRII,SRJ,Y S SRII=$P($G(^SRF(SRTN,"TIU")),"^",2)
"RTN","SRONIN",99,0)
 S (SROK,SRNUR,SRJ)=0 F  S SRNUR=$O(^SRF(SRTN,19,SRNUR)) Q:'SRNUR  S SRJ=1 I $P(^SRF(SRTN,19,SRNUR,0),"^")=DUZ S SROK=1 Q
"RTN","SRONIN",100,0)
 I $D(^XUSEC("SROCHIEF",DUZ)) S SROK=1
"RTN","SRONIN",101,0)
 I 'SROK,'SRJ,SRII D EXTRACT^TIULQ(SRII,"SRA",.SRERR,"1302") I +$G(SRA(SRII,1302,"I"))=DUZ S SROK=1
"RTN","SRONIN",102,0)
 I 'SROK W !!,"Sorry, you are not authorized to sign this report." H 2 Q
"RTN","SRONIN",103,0)
 S SRMISS=0 D ALLIN Q:SRSOUT!SRMISS
"RTN","SRONIN",104,0)
ES D RPT^SRONRPT(SRTN) N SRAY,SRERR,SRI,SRP,SRSIG,SRTIU,X1
"RTN","SRONIN",105,0)
 S SRTIU=$P($G(^SRF(SRTN,"TIU")),"^",2)
"RTN","SRONIN",106,0)
 D SIG^XUSESIG I X1="" W !!,"Signature failed." H 2 Q
"RTN","SRONIN",107,0)
 F I=1:1 Q:'$D(^TMP("SRNIR",$J,SRTN,I))  S SRAY("TEXT",I,0)=^TMP("SRNIR",$J,SRTN,I)
"RTN","SRONIN",108,0)
 S SRAY(.05)=5 D UPDATE^TIUSRVP(.SRERR,SRTIU,.SRAY,1) K SRAY
"RTN","SRONIN",109,0)
 I +SRERR S SRSINED=1 D
"RTN","SRONIN",110,0)
 .D ES^TIUSROI(SRTIU,DUZ)
"RTN","SRONIN",111,0)
 .S XQAID="SRNIR-"_SRTN,XQAKILL=0 D DELETEA^XQALERT
"RTN","SRONIN",112,0)
 W ! K DIR S DIR(0)="FOA",DIR("A")="Press RETURN to continue... " D ^DIR K DIR
"RTN","SRONIN",113,0)
 Q
"RTN","SRONIN",114,0)
ALLIN N SRFLD,SRI,SRMISS1,SRMISS2,SRP,SRX,SRY,SRZ
"RTN","SRONIN",115,0)
 K DA,DIC,DIQ,DR S (SREDIT,SRMISS,SRMISS1,SRMISS2,SRMISS3,SRSOUT)=0
"RTN","SRONIN",116,0)
 S DIC="^SRF(",DA=SRTN,DIQ="SRY",DIQ(0)="I",DR=".205;.232;48;44;45;46;47;71;72;73" D EN^DIQ1 K DA,DIC,DIQ,DR D LIST
"RTN","SRONIN",117,0)
 I $G(SRX(.205))'=""!($G(SRX(.232))'="")!($G(SRX(71))'="")!($G(SRX(72))'="")!($G(SRX(73))'="") S SRMISS1=1
"RTN","SRONIN",118,0)
 I $G(SRX(48))="" F SRZ=44,45,46,47 I $G(SRX(SRZ))'="" S SRMISS2=1 Q
"RTN","SRONIN",119,0)
 I SRMISS1!SRMISS2 S SRMISS=1 D MESS Q:SRSOUT  I SREDIT D EDIT Q
"RTN","SRONIN",120,0)
 Q
"RTN","SRONIN",121,0)
MESS ; display list of missing items
"RTN","SRONIN",122,0)
 W @IOF,!,"The following information is required before this report may be signed:",!
"RTN","SRONIN",123,0)
 I SRMISS1 F SRZ=.205,.232,71,72,73 I $G(SRX(SRZ))'="" W !,?5,SRX(SRZ)
"RTN","SRONIN",124,0)
 I SRMISS2 F SRZ=44:1:47 I $G(SRX(SRZ))'="" W !,?5,SRX(SRZ)
"RTN","SRONIN",125,0)
 W ! K DIR S DIR("A")="Do you want to enter this information",DIR("B")="YES",DIR(0)="Y" D ^DIR K DIR,SRX I $D(DTOUT)!$D(DUOUT) S SRSOUT=1 Q
"RTN","SRONIN",126,0)
 I Y S SREDIT=1
"RTN","SRONIN",127,0)
 Q
"RTN","SRONIN",128,0)
CODE ; entry point from coding menu
"RTN","SRONIN",129,0)
 N SRAGE,SRDIV,SRDIVNM,SRDO,SRFUNCT,SRHDR,SRINUSE,SRLEAVE,SRLOC,SRNOEDIT,SRPARAM,SRPRINT,SRSEL,SRSINED,SRDTITL,SRTIU,SRSTAT,SRXX
"RTN","SRONIN",130,0)
 S SRNOEDIT=1,SRDTITL="Nurse Intraoperative Report"
"RTN","SRONIN",131,0)
 S (SRFUNCT,SRLEAVE,SRSINED)=0,SRTIU=$P($G(^SRF(SRTN,"TIU")),"^",2)
"RTN","SRONIN",132,0)
 I SRTIU,$$STATUS^SROESUTL(SRTIU)=7 S SRSINED=1
"RTN","SRONIN",133,0)
 D DISPLY,END
"RTN","SRONIN",134,0)
 Q
"RTN","SRONIN",135,0)
LIST S SRZ=0 F  S SRZ=$O(SRY(130,SRTN,SRZ)) Q:'SRZ  I SRY(130,SRTN,SRZ,"I")="" D TR S X=$T(@SRP),SRFLD=$P(X,";;",2),SRX(SRZ)=$P(SRFLD,"^",2)
"RTN","SRONIN",136,0)
 Q
"RTN","SRONIN",137,0)
TR S SRP=SRZ,SRP=$TR(SRP,"1234567890.","ABCDEFGHIJP")
"RTN","SRONIN",138,0)
 Q
"RTN","SRONIN",139,0)
PBJE ;;.205^TIME PAT IN OR
"RTN","SRONIN",140,0)
PBCB ;;.232^TIME PAT OUT OR
"RTN","SRONIN",141,0)
DD ;;44^SPONGE COUNT CORRECT (Y/N)
"RTN","SRONIN",142,0)
DE ;;45^SHARPS COUNT CORRECT (Y/N)
"RTN","SRONIN",143,0)
DF ;;46^INSTRUMENT COUNT CORRECT (Y/N)
"RTN","SRONIN",144,0)
DG ;;47^SPONGE, SHARPS, & INST COUNTER
"RTN","SRONIN",145,0)
DH ;;48^COUNT VERIFIER
"RTN","SRONIN",146,0)
GA ;;71^TIME OUT VERIFIED
"RTN","SRONIN",147,0)
GB ;;72^IMAGING CONFIRMED
"RTN","SRONIN",148,0)
GC ;;73^MARKED SITE CONFIRMED
"RTN","SRONIN1")
1^141
"RTN","SRONIN2")
1^142
"RTN","SRONIN3")
1^143
"RTN","SRONIN4")
1^144
"RTN","SRONIN5")
1^145
"RTN","SRONIN6")
1^146
"RTN","SRONON")
0^70^B11378996
"RTN","SRONON",1,0)
SRONON ;B'HAM ISC/ADM - NON-O.R. PROCEDURE REPORT ; [ 02/18/04  9:55 AM ]
"RTN","SRONON",2,0)
 ;;3.0; Surgery ;**48,77,100**;24 Jun 93
"RTN","SRONON",3,0)
 ;
"RTN","SRONON",4,0)
 ;** NOTICE: This routine is part of an implementation of a nationally
"RTN","SRONON",5,0)
 ;**         controlled procedure.  Local modifications to this routine
"RTN","SRONON",6,0)
 ;**         are prohibited.
"RTN","SRONON",7,0)
 ;
"RTN","SRONON",8,0)
 I '$D(SRSITE) D ^SROVAR G:'$D(SRSITE) END S SRSITE("KILL")=1
"RTN","SRONON",9,0)
 I '$D(SRTN) D NON G:'$D(SRTN) END S SRTN("KILL")=1
"RTN","SRONON",10,0)
 N SREXP,SRSINED,SRDTITL,SRSTAT,SRTIU
"RTN","SRONON",11,0)
 S SRDTITL="Procedure Report"
"RTN","SRONON",12,0)
 S SRSINED=0,SRTIU=$P($G(^SRF(SRTN,"TIU")),"^",3)
"RTN","SRONON",13,0)
 I SRTIU S SRSTAT=$$STATUS^SROESUTL(SRTIU) S:SRSTAT=7 SRSINED=1
"RTN","SRONON",14,0)
 D DISPLY,END
"RTN","SRONON",15,0)
 Q
"RTN","SRONON",16,0)
DISPLY I SRSINED S SRTIU=$P($G(^SRF(SRTN,"TIU")),"^",3) I SRTIU D PRNT^SROESPR(SRTN,SRTIU,SRDTITL) Q
"RTN","SRONON",17,0)
 I 'SRSINED S SREXP=$P($G(^SRF(SRTN,"TIU")),"^",5) D  D LAST
"RTN","SRONON",18,0)
 .I 'SREXP W !!," * * A Procedure Report (Non-OR) will not be created for this procedure. * *" Q
"RTN","SRONON",19,0)
 .W !!," * * A Procedure Report (Non-OR) is not available. * *"
"RTN","SRONON",20,0)
 Q
"RTN","SRONON",21,0)
END W @IOF I $D(ZTQUEUED) Q:$G(ZTSTOP)  S ZTREQ="@" Q
"RTN","SRONON",22,0)
 D ^SRSKILL K VAIN,VAINDT I $D(SRSITE("KILL")) K SRSITE
"RTN","SRONON",23,0)
 I $D(SRTN("KILL")) K SRTN
"RTN","SRONON",24,0)
 Q
"RTN","SRONON",25,0)
NON K DIC S DIC("A")="Select Patient: ",DIC=2,DIC(0)="QEAMZ" D ^DIC I Y<0 S SRSOUT=1 G END
"RTN","SRONON",26,0)
 S DFN=+Y D DEM^VADPT S SRNM=VADM(1)
"RTN","SRONON",27,0)
 W @IOF,!,"Non-O.R. Procedures for "_SRNM_" ("_VA("PID")_")" I $D(^DPT(DFN,.35)) S Y=$P(^(.35),"^") I Y D D^DIQ S Y=$P(Y,"@")_" "_$P(Y,"@",2) W !,"  (DIED ON "_Y_")"
"RTN","SRONON",28,0)
 W !! S (SROP,CNT)=0 F I=0:0 S SROP=$O(^SRF("ANOR",DFN,SROP)) Q:'SROP  D LIST
"RTN","SRONON",29,0)
SEL W !!!,"Select Procedure: " R X:DTIME I '$T!("^"[X) G END
"RTN","SRONON",30,0)
 I '$D(SRCASE(X)) W !!,"Enter the number corresponding to the procedure for which you want to print",!,"a report." G SEL
"RTN","SRONON",31,0)
 S SRTN=+SRCASE(X)
"RTN","SRONON",32,0)
 Q
"RTN","SRONON",33,0)
LIST ; list case
"RTN","SRONON",34,0)
 I $Y+5>IOSL S SRBACK=0 D SEL^SROPER Q:$D(SRTN)!(SRSOUT)  W @IOF,!,?1,"NON-O.R. PROCEDURES FOR "_VADM(1)_" ("_VA("PID")_")",! I SRBACK S CNT=0,SROP=SRCASE(1)-1,SRDT=$P(SRCASE(1),"^",2)
"RTN","SRONON",35,0)
 S CNT=CNT+1,SRSDATE=$P(^SRF(SROP,0),"^",9),SROPER=$P(^SRF(SROP,"OP"),"^"),SRCASE(CNT)=SROP
"RTN","SRONON",36,0)
 K SROPS,MM,MMM S:$L(SROPER)<55 SROPS(1)=SROPER I $L(SROPER)>54 S SROPER=SROPER_"  " F M=1:1 D LOOP Q:MMM=""
"RTN","SRONON",37,0)
 S Y=SRSDATE D D^DIQ S SRSDATE=$P(Y,"@")_" "_$P(Y,"@",2)
"RTN","SRONON",38,0)
 W !,CNT_".",?4,SRSDATE,?25,SROPS(1) I $D(SROPS(2)) W !,?25,SROPS(2) I $D(SROPS(3)) W !,?25,SROPS(3) I $D(SROPS(4)) W !,?25,SROPS(4)
"RTN","SRONON",39,0)
 W !
"RTN","SRONON",40,0)
 Q
"RTN","SRONON",41,0)
LOOP ; break procedure if greater than 55 characters
"RTN","SRONON",42,0)
 S SROPS(M)="" F LOOP=1:1 S MM=$P(SROPER," "),MMM=$P(SROPER," ",2,200) Q:MMM=""  Q:$L(SROPS(M))+$L(MM)'<55  S SROPS(M)=SROPS(M)_MM_" ",SROPER=MMM
"RTN","SRONON",43,0)
 Q
"RTN","SRONON",44,0)
LAST W ! K DIR S DIR(0)="E" D ^DIR K DIR
"RTN","SRONON",45,0)
 Q
"RTN","SRONON",46,0)
CODE ; entry point from coding menu
"RTN","SRONON",47,0)
 N SREXP,SRSINED,SRDTITL,SRSTAT,SRTIU
"RTN","SRONON",48,0)
 S SRDTITL="Procedure Report"
"RTN","SRONON",49,0)
 S SRSINED=0,SRTIU=$P($G(^SRF(SRTN,"TIU")),"^",3)
"RTN","SRONON",50,0)
 I SRTIU S SRSTAT=$$STATUS^SROESUTL(SRTIU) S:SRSTAT=7 SRSINED=1
"RTN","SRONON",51,0)
 D DISPLY,END
"RTN","SRONON",52,0)
 Q
"RTN","SRONON0")
1^154
"RTN","SRONON1")
1^155
"RTN","SRONOP")
0^71^B25370271
"RTN","SRONOP",1,0)
SRONOP ;B;HAM ISC/MAM - NON-O.R. PROCEDURES ; [ 01/30/01  1:07 PM ]
"RTN","SRONOP",2,0)
 ;;3.0; Surgery ;**44,58,64,67,70,100**;24 Jun 93
"RTN","SRONOP",3,0)
 K SROEDIT S:$D(^XUSEC("SROEDIT",DUZ))&'$D(DUZ("SAV")) SROEDIT=1 S (SRNEWOP,SRSOUT)=0 W @IOF,!
"RTN","SRONOP",4,0)
 K DIC S DIC("A")="Select Patient: ",DIC=2,DIC(0)="QEAMZ" D ^DIC K DIC I Y<0 S SRSOUT=1 G END
"RTN","SRONOP",5,0)
 S DFN=+Y D DEM^VADPT S SRNM=VADM(1) D HDR
"RTN","SRONOP",6,0)
ADT S (SRBACK,SRDT,CNT)=0 F  S SRDT=$O(^SRF("ADT",DFN,SRDT)) Q:'SRDT!SRSOUT!SRNEWOP!$D(SRTN)!SRBACK  S SROP=0 F  S SROP=$O(^SRF("ADT",DFN,SRDT,SROP)) Q:'SROP!$D(SRTN)!SRSOUT!SRNEWOP!SRBACK  D LIST
"RTN","SRONOP",7,0)
 G:SRBACK ADT G:$D(SRTN) ASK G:SRNEWOP ^SRONOP1 G:SRSOUT END
"RTN","SRONOP",8,0)
 I $D(SROEDIT) S CNT=CNT+1,SRCASE(CNT)="" W !,CNT_".",?4,"NEW PROCEDURE"
"RTN","SRONOP",9,0)
SEL W !!,"Select Procedure: " R X:DTIME I '$T!("^"[X) S SRSOUT=1 G END
"RTN","SRONOP",10,0)
 I $D(SROEDIT),X="NEW"!(X="new")!(X=CNT) G ^SRONOP1
"RTN","SRONOP",11,0)
 I '$D(SRCASE(X)) W !!,"Enter the number corresponding to the procedure you want to edit." W:$D(SROEDIT) !,"Enter '"_CNT_"' or 'NEW' to create a new procedure" G SEL
"RTN","SRONOP",12,0)
 S SRTN=SRCASE(X)
"RTN","SRONOP",13,0)
ASK S SROP=SRTN,SRSDATE=$P(^SRF(SRTN,0),"^",9) I $E(SRSDATE,1,7)>DT D FUTURE G:SRSOUT END I '$D(SRTN) D HDR G ADT
"RTN","SRONOP",14,0)
 Q:'$D(SROEDIT)  D HDR W !,?1 D CASE W !!,"Do you want to edit or delete this procedure ? "
"RTN","SRONOP",15,0)
 W !!,"1. Edit",!,"2. Delete",!!,"Select Number:  1// " R X:DTIME I '$T!(X["^") S SRSOUT=1 G END
"RTN","SRONOP",16,0)
 S:X="" X=1 I X<1!(X>2) W !!,"Enter '1' to edit information related to this procedure, or '2' to delete",!,"this procedure from your records.",!!,"Press RETURN to continue  " R X:DTIME G ASK
"RTN","SRONOP",17,0)
 I X=1 K SROEDIT Q
"RTN","SRONOP",18,0)
 D DEL^SRONOP1
"RTN","SRONOP",19,0)
END I 'SRSOUT W !!,"Press RETURN to continue  " R X:DTIME
"RTN","SRONOP",20,0)
 D ^SRSKILL K SROEDIT,SRTN W @IOF
"RTN","SRONOP",21,0)
 Q
"RTN","SRONOP",22,0)
EDIT ; edit procedure
"RTN","SRONOP",23,0)
 Q:'$D(SRTN)  I '$D(SRNM),$D(VADM(1)) S SRNM=VADM(1)
"RTN","SRONOP",24,0)
 I '$D(SRNM) S DFN=$P(^SRF(SRTN,0),"^") D DEM^VADPT S SRNM=VADM(1)
"RTN","SRONOP",25,0)
 D ^SROLOCK I SROLOCK S Q3("VIEW")=""
"RTN","SRONOP",26,0)
 N SRLCK S SRLCK=$$LOCK^SROUTL(SRTN) I 'SRLCK S Q3("VIEW")=""
"RTN","SRONOP",27,0)
 D RT K DR S SRDTIME=DTIME,DTIME=3600,SRSOUT=1,ST="NON-O.R. PROCEDURE"_$S(SROLOCK:" **LOCKED",1:""),DIE=130,DR="[SRNON-OR]",DA=SRTN D EN2^SROVAR,^SRCUSS S DTIME=SRDTIME I 'SROLOCK D ^SROPCE1
"RTN","SRONOP",28,0)
 S SROERR=SRTN D ^SROERR0
"RTN","SRONOP",29,0)
 I $G(SRLCK) D UNLOCK^SROUTL(SRTN)
"RTN","SRONOP",30,0)
 D ^SRSKILL
"RTN","SRONOP",31,0)
 Q
"RTN","SRONOP",32,0)
LIST ; list case
"RTN","SRONOP",33,0)
 Q:$P($G(^SRF(SROP,"NON")),"^")'="Y"
"RTN","SRONOP",34,0)
 I $Y+5>IOSL S SRBACK=0 D CONT Q:$D(SRTN)!SRSOUT!SRNEWOP  D HDR Q:SRBACK
"RTN","SRONOP",35,0)
 S CNT=CNT+1,SRSDATE=$P(^SRF(SROP,0),"^",9) W !,CNT_". "
"RTN","SRONOP",36,0)
CASE S SROPER=$P(^SRF(SROP,"OP"),"^"),SRCASE(CNT)=SROP D LOCK
"RTN","SRONOP",37,0)
 K SROPS,MM,MMM S:$L(SROPER)<60 SROPS(1)=SROPER I $L(SROPER)>59 S SROPER=SROPER_"  " F M=1:1 D LOOP Q:MMM=""
"RTN","SRONOP",38,0)
 S Y=SRSDATE D D^DIQ S SRSDATE=$P(Y,"@")_" "_$P(Y,"@",2)
"RTN","SRONOP",39,0)
 W SRSDATE,?20,SROPS(1) I $D(SROPS(2)) W !,?20,SROPS(2) I $D(SROPS(3)) W !,?20,SROPS(3) I $D(SROPS(4)) W !,?20,SROPS(4)
"RTN","SRONOP",40,0)
 W !
"RTN","SRONOP",41,0)
 Q
"RTN","SRONOP",42,0)
LOCK ; case locked?
"RTN","SRONOP",43,0)
 I $D(SRTN),$P($G(^SRF(SRTN,"LOCK")),"^") S SROPER=SROPER_" **LOCKED**"
"RTN","SRONOP",44,0)
 Q
"RTN","SRONOP",45,0)
LOOP ; break procedure if greater than 60 characters
"RTN","SRONOP",46,0)
 S SROPS(M)="" F LOOP=1:1 S MM=$P(SROPER," "),MMM=$P(SROPER," ",2,200) Q:MMM=""  Q:$L(SROPS(M))+$L(MM)'<60  S SROPS(M)=SROPS(M)_MM_" ",SROPER=MMM
"RTN","SRONOP",47,0)
 Q
"RTN","SRONOP",48,0)
RT ; start RT logging
"RTN","SRONOP",49,0)
 I $D(XRTL) S XRTN="SRONOP" D T0^%ZOSV
"RTN","SRONOP",50,0)
 Q
"RTN","SRONOP",51,0)
CONT W ! K DIR S DIR("A")="Select procedure or press RETURN to continue listing procedures: ",DIR(0)="FOA"
"RTN","SRONOP",52,0)
 S DIR("?",1)="Enter the number corresponding to the desired procedures"_$S($D(SROEDIT):", enter 'NEW' to",1:"")
"RTN","SRONOP",53,0)
 S DIR("?")=$S($D(SROEDIT):"create a new procedure, ",1:"")_"or press RETURN to continue listing procedures." D ^DIR Q:Y=""  I $D(DTOUT)!$D(DUOUT) S SRSOUT=1 Q
"RTN","SRONOP",54,0)
 I $D(SROEDIT),Y="NEW"!(Y="new") S SRNEWOP=1 Q
"RTN","SRONOP",55,0)
 I Y'?.N!'$D(SRCASE(+Y)) S SRBACK=1 D
"RTN","SRONOP",56,0)
 .W !!,"Enter the number corresponding to the procedure you want to edit.",!,"If the desired procedure does not appear, press RETURN to continue",!,"listing additional procedures"
"RTN","SRONOP",57,0)
 .W:$D(SROEDIT) ", or enter 'NEW' to create a new procedure" W ".",!
"RTN","SRONOP",58,0)
 I SRBACK K DIR S DIR("A")="  Press RETURN to continue. ",DIR("0")="FOA" D ^DIR I $D(DTOUT)!$D(DUOUT) S SRSOUT=1
"RTN","SRONOP",59,0)
 I 'SRBACK S SRTN=+SRCASE(Y)
"RTN","SRONOP",60,0)
 Q
"RTN","SRONOP",61,0)
FUTURE  D HDR W !,?1 D CASE W !,$C(7) K DIR
"RTN","SRONOP",62,0)
 S DIR("A",1)=">>> The procedure you have selected has a future date.",DIR("A")="    Are you sure you have selected the correct procedure ? ",DIR("B")="NO",DIR(0)="YA" D ^DIR K DIR I $D(DTOUT)!$D(DUOUT) S SRSOUT=1 Q
"RTN","SRONOP",63,0)
 I 'Y K SRTN
"RTN","SRONOP",64,0)
 Q
"RTN","SRONOP",65,0)
HDR ; print heading
"RTN","SRONOP",66,0)
 W @IOF,!,?1,VADM(1)_"   "_VA("PID") S X=$P($G(VADM(6)),"^") W:X "        * Died "_$E(X,4,5)_"/"_$E(X,6,7)_"/"_$E(X,2,3)_" *" W !
"RTN","SRONOP",67,0)
 Q
"RTN","SRONOP1")
0^72^B15550721
"RTN","SRONOP1",1,0)
SRONOP1 ;BIR/MAM - NON-O.R. PROCEDURES ; [ 03/01/04  8:01 AM ]
"RTN","SRONOP1",2,0)
 ;;3.0; Surgery ;**44,56,58,48,67,70,88,100**;24 Jun 93
"RTN","SRONOP1",3,0)
 S X=$P($G(VADM(6)),"^") I X D  I SRSOUT D ^SRSKILL G ^SRONOP
"RTN","SRONOP1",4,0)
 .S SRDEATH=$E(X,4,5)_"/"_$E(X,6,7)_"/"_$E(X,2,3) W @IOF,!,?1,VADM(1)_"   "_VA("PID")_"        * Died "_SRDEATH_" *"
"RTN","SRONOP1",5,0)
 .W !!,$C(7) K DIR S DIR("A",1)=">>> The patient you have selected died on "_SRDEATH_"."
"RTN","SRONOP1",6,0)
 .S DIR("A")="    Are you sure this is the correct patient ? ",DIR("B")="NO",DIR(0)="YA" D ^DIR K DIR
"RTN","SRONOP1",7,0)
 .I 'Y!$D(DTOUT)!$D(DUOUT) S SRSOUT=1
"RTN","SRONOP1",8,0)
 W @IOF,!,"Entering a new non-O.R. procedure for "_SRNM_".",!!
"RTN","SRONOP1",9,0)
OP ; principal procedure
"RTN","SRONOP1",10,0)
 W ! K DIR S DIR(0)="130,26A",DIR("A")="Enter the Procedure: " D ^DIR K DIR I $D(DTOUT)!(X="^") S SRSOUT=1 G END
"RTN","SRONOP1",11,0)
 S SROPER=Y
"RTN","SRONOP1",12,0)
DATE W ! K %DT S %DT="AEX",%DT("A")="Select the Date of the Procedure: " D ^%DT I X="" W !!,"The Date of the Procedure MUST be entered." G DATE
"RTN","SRONOP1",13,0)
 I Y<0!$D(DTOUT) S SRSOUT=1 G END
"RTN","SRONOP1",14,0)
 S SRSDATE=+Y
"RTN","SRONOP1",15,0)
DOC W ! K DIR S DIR("A")="Provider",DIR(0)="130,123" D ^DIR I $D(DTOUT)!$D(DUOUT) S SRSOUT=1 G END
"RTN","SRONOP1",16,0)
 S SRSDOC=+Y
"RTN","SRONOP1",17,0)
SPEC W ! K DIR S DIR("A")="Medical Specialty",DIR(0)="130,125" D ^DIR I $D(DTOUT)!$D(DUOUT) S SRSOUT=1 G END
"RTN","SRONOP1",18,0)
 S SRSPEC=+Y
"RTN","SRONOP1",19,0)
SUMM ; dictated summary expected?
"RTN","SRONOP1",20,0)
 N SREXPT W ! K DIR S DIR("A")="Will a summary of this procedure be dictated? (Y/N)"
"RTN","SRONOP1",21,0)
 S DIR("?",1)="This field indicates if the provider will dictate a summary of this",DIR("?",2)="procedure to be electronically signed. Enter YES if a dictated summary"
"RTN","SRONOP1",22,0)
 S DIR("?")="is expected. Enter NO or leave blank if no summary is expected.",DIR(0)="Y" D ^DIR K DIR
"RTN","SRONOP1",23,0)
 I $D(DTOUT)!$D(DUOUT) S SRSOUT=1 G END
"RTN","SRONOP1",24,0)
 S SREXPT=Y
"RTN","SRONOP1",25,0)
 K DIC,DO,DA,DD,DINUM,SRTN S X=DFN,DIC="^SRF(",DIC(0)="L",DLAYGO=130 D FILE^DICN K DD,DO,DIC,DLAYGO S SRTN=+Y
"RTN","SRONOP1",26,0)
 N SRLCK S SRLCK=$$LOCK^SROUTL(SRTN) I 'SRLCK S Q3("VIEW")=""
"RTN","SRONOP1",27,0)
 K DR S DIE=130,DR="120///"_SRSDATE_";26///"_SROPER_";118///Y;123////"_SRSDOC_";125////"_SRSPEC_";1004////"_SREXPT,DA=SRTN D ^DIE K DR,DA,DIE S ^SRF(SRTN,8)=SRSITE("DIV")
"RTN","SRONOP1",28,0)
 D RT S SRSOUT=1,SRN=$E(SRNM,1,20),Q3(1)="** NON-O.R. PROCEDURE **  CASE #"_SRTN_"  "_SRN_" "
"RTN","SRONOP1",29,0)
 S SRDTIME=DTIME,DTIME=3600,ST="NON-O.R. PROCEDURE",DIE=130,DR="[SRNON-OR]",DA=SRTN D ^SRCUSS S DTIME=SRDTIME D ^SROPCE1 S SRSOUT=0
"RTN","SRONOP1",30,0)
 S SRSOP=SROPER,SRL=$P(^SRF(SRTN,"NON"),"^",2) S ORL=$S(SRL:SRL_";SC(",1:"") D ^SROERR
"RTN","SRONOP1",31,0)
 D ^SRSKILL I $G(SRLCK) D UNLOCK^SROUTL(SRTN)
"RTN","SRONOP1",32,0)
 Q
"RTN","SRONOP1",33,0)
END I SRSOUT W !!,"No action taken.",!!,"Press RETURN to continue  " R X:DTIME
"RTN","SRONOP1",34,0)
 D ^SRSKILL K SRTN W @IOF
"RTN","SRONOP1",35,0)
 Q
"RTN","SRONOP1",36,0)
RT ; start RT logging
"RTN","SRONOP1",37,0)
 I $D(XRTL) S ZRTN="SRONOP1" D T0^%ZOSV
"RTN","SRONOP1",38,0)
 Q
"RTN","SRONOP1",39,0)
DEL ; delete procedure
"RTN","SRONOP1",40,0)
 W !!,"Are you sure that you want to remove this procedure from your ",!,"records ?  NO// " R X:DTIME I '$T!(X="^") W !!,"No action taken..." Q
"RTN","SRONOP1",41,0)
 S X=$E(X) S:X="" X="N" I "YyNn"'[X W !!,"Enter RETURN or 'NO' if this procedure should remain on file.  Enter 'YES'",!,"to delete this procedure."
"RTN","SRONOP1",42,0)
 I "Nn"[X W !!,"No action taken." Q
"RTN","SRONOP1",43,0)
 I $P($G(^SRF(SRTN,"TIU")),"^",3) D EN^DDIOL("This case can't be deleted, there is a Procedure Report (Non-O.R.) associated with it.",,"!!,?2,$C(7)") Q
"RTN","SRONOP1",44,0)
 W !!,"Deleting procedure..." D DEL^SROERR S DA=SRTN,DIK="^SRF(" D ^DIK
"RTN","SRONOP1",45,0)
 Q
"RTN","SRONP")
0^156^B5944291
"RTN","SRONP",1,0)
SRONP ;BIR/ADM - PROCEDURE REPORT (NON-OR) ; [ 10/06/03  10:45 AM ]
"RTN","SRONP",2,0)
 ;;3.0; Surgery ;**100**;24 Jun 93
"RTN","SRONP",3,0)
 ;
"RTN","SRONP",4,0)
 ;** NOTICE: This routine is part of an implementation of a nationally
"RTN","SRONP",5,0)
 ;**         controlled procedure.  Local modifications to this routine
"RTN","SRONP",6,0)
 ;**         are prohibited.
"RTN","SRONP",7,0)
 ;
"RTN","SRONP",8,0)
 ; Reference to EXTRACT^TIULQ supported by DBIA #2693
"RTN","SRONP",9,0)
 ;
"RTN","SRONP",10,0)
OPTOP(SRTN,SRLAST,SRG) ; send op-top to ^TMP
"RTN","SRONP",11,0)
 ; SRTN   - case number in file 130
"RTN","SRONP",12,0)
 ; SRLAST - (optional)
"RTN","SRONP",13,0)
 ;          0 or null : include summary status at end
"RTN","SRONP",14,0)
 ;          1 : omit summary status at end
"RTN","SRONP",15,0)
 ;          2 : include summary status at end plus summary in TIU
"RTN","SRONP",16,0)
 ; SRG    - (optional) return array
"RTN","SRONP",17,0)
 ;
"RTN","SRONP",18,0)
 Q:'$D(SROVP)
"RTN","SRONP",19,0)
 N J,LOOP,SR,SRALL,SRCASE,SRERR,SRI,SRLF,SRSTAT,SRT,SRTIU
"RTN","SRONP",20,0)
 S SRTIU=$P($G(^SRF(SRTN,"TIU")),"^",3) Q:'SRTIU
"RTN","SRONP",21,0)
 D STATUS Q:SRSTAT>1
"RTN","SRONP",22,0)
 S SRCASE=SRTN S:'$L($G(SRG)) SRG=$NA(^TMP("SRNOR",$J,SRCASE)) K @SRG
"RTN","SRONP",23,0)
 S SRI=0,SRLAST=$S($G(SRLAST):SRLAST,1:1),@SRG@(SRI)=3
"RTN","SRONP",24,0)
 I $P($G(^SRF(SRTN,30)),"^")!$P($G(^SRF(SRTN,31)),"^",8) D LINE(1) S @SRG@(SRI)="  * * PROCEDURE ABORTED * *" D LINE(1)
"RTN","SRONP",25,0)
 S SR(0)=^SRF(SRTN,0)
"RTN","SRONP",26,0)
 D PRIN I $O(^SRF(SRTN,13,0)) D OTHER
"RTN","SRONP",27,0)
 Q
"RTN","SRONP",28,0)
STATUS ; check status of TIU document
"RTN","SRONP",29,0)
 D EXTRACT^TIULQ(SRTIU,"SRT",.SRERR,".05") S SRSTAT=SRT(SRTIU,.05,"I")
"RTN","SRONP",30,0)
 Q
"RTN","SRONP",31,0)
PRIN ; print principal procedure information
"RTN","SRONP",32,0)
 N I,M,MM,MMM,SRJ,SROPER,SROPS
"RTN","SRONP",33,0)
 D LINE(1) S @SRG@(SRI)="Non-O.R. Procedure(s) Performed:"
"RTN","SRONP",34,0)
PRIN2 S SROPER=$P(^SRF(SRTN,"OP"),"^")
"RTN","SRONP",35,0)
 I $P($G(^SRF(SRTN,30)),"^") S SROPER="** ABORTED ** "_SROPER
"RTN","SRONP",36,0)
 K SROPS,MM,MMM S:$L(SROPER)<70 SROPS(1)=SROPER I $L(SROPER)>69 S SROPER=SROPER_"  " F M=1:1 D LOOP Q:MMM=""
"RTN","SRONP",37,0)
 F I=1:1 Q:'$D(SROPS(I))  D LINE(1) S @SRG@(SRI)=$S(I=1:" Principal: ",1:"         ")_SROPS(I)
"RTN","SRONP",38,0)
 Q
"RTN","SRONP",39,0)
OTHER ; other procedures
"RTN","SRONP",40,0)
 N CNT,OTH,OTHER
"RTN","SRONP",41,0)
 S (OTH,CNT)=0 F  S OTH=$O(^SRF(SRTN,13,OTH)) Q:'OTH  S CNT=CNT+1 D OTH
"RTN","SRONP",42,0)
 Q
"RTN","SRONP",43,0)
OTH S OTHER=$P(^SRF(SRTN,13,OTH,0),"^")
"RTN","SRONP",44,0)
 D LINE(1) S @SRG@(SRI)="     Other: "_OTHER
"RTN","SRONP",45,0)
 Q
"RTN","SRONP",46,0)
LOOP ; break procedure if greater than 70 characters
"RTN","SRONP",47,0)
 S SROPS(M)="" F LOOP=1:1 S MM=$P(SROPER," "),MMM=$P(SROPER," ",2,200) Q:MMM=""  Q:$L(SROPS(M))+$L(MM)'<70  S SROPS(M)=SROPS(M)_MM_" ",SROPER=MMM
"RTN","SRONP",48,0)
 Q
"RTN","SRONP",49,0)
LINE(NUM) ;create carriage returns
"RTN","SRONP",50,0)
 I $G(SRLF) S NUM=NUM+1,SRLF=0
"RTN","SRONP",51,0)
 F J=1:1:NUM S SRI=SRI+1,@SRG@(SRI)=" "
"RTN","SRONP",52,0)
 Q
"RTN","SRONRN1")
1^147
"RTN","SRONRN2")
1^148
"RTN","SRONRN3")
1^149
"RTN","SRONRN4")
1^150
"RTN","SRONRN5")
1^151
"RTN","SRONRNF")
1^152
"RTN","SRONRPT")
0^76^B27501274
"RTN","SRONRPT",1,0)
SRONRPT ;BIR/ADM - NURSE INTRAOP REPORT ; [ 02/14/04  10:12 AM ]
"RTN","SRONRPT",2,0)
 ;;3.0; Surgery ;**100**;24 Jun 93
"RTN","SRONRPT",3,0)
 ;
"RTN","SRONRPT",4,0)
 ;** NOTICE: This routine is part of an implementation of a nationally
"RTN","SRONRPT",5,0)
 ;**         controlled procedure.  Local modifications to this routine
"RTN","SRONRPT",6,0)
 ;**         are prohibited.
"RTN","SRONRPT",7,0)
 ;
"RTN","SRONRPT",8,0)
 D:'$D(SRTN) ^SROPS Q:'$D(SRTN)
"RTN","SRONRPT",9,0)
 D RPT^SRONRPT(SRTN)
"RTN","SRONRPT",10,0)
 Q
"RTN","SRONRPT",11,0)
RPT(SRTN) ; send text of nurse intraoperative report to ^TMP
"RTN","SRONRPT",12,0)
 N ANE,C,CNT,I,J,K,SR,SRAGNT,SRALL,SRANES,SRANESA,SRC,SRCT,SRCASE,SRCONS,SRCONV,SRDISP,SRDIV,SRDT,SREL,SRELP,SRELP2,SRG,SRI,SRL,SRLF,SRLINE,SRMOOD,SROP,SROPER,SROPS,SROR,SRSCAN,SRSKIN,SRTIME,SRTYPE,SRUSER,SRX,SRZ,VIA,X,Y,Z
"RTN","SRONRPT",13,0)
 N SROIM,SROUT
"RTN","SRONRPT",14,0)
 S SRCASE=SRTN,SRG=$NA(^TMP("SRNIR",$J,SRCASE)),SRI=0 K @SRG
"RTN","SRONRPT",15,0)
 S SRDIV=$$SITE^SROUTL0(SRTN),SRALL=$S(SRDIV:$P(^SRO(133,SRDIV,0),"^",6),1:1)
"RTN","SRONRPT",16,0)
 I $P($G(^SRF(SRTN,30)),"^")!$P($G(^SRF(SRTN,31)),"^",8) D LINE(1) S @SRG@(SRI)="  * * OPERATION ABORTED * *" D LINE(1)
"RTN","SRONRPT",17,0)
 F X=0:.1:1.1,31,"1.0","VER" S SR(X)=$G(^SRF(SRTN,X))
"RTN","SRONRPT",18,0)
 S SROR=$P(SR(0),"^",2) I SROR S SROR=$P(^SRS(SROR,0),"^"),SROR=$P(^SC(SROR,0),"^")
"RTN","SRONRPT",19,0)
 I SROR="" S SROR="NOT ENTERED"
"RTN","SRONRPT",20,0)
 S Y=$P(SR(0),"^",10),C=$P(^DD(130,.035,0),"^",2) D:Y'="" Y^DIQ S SRTYPE=$S(Y="":"NOT ENTERED",1:Y)
"RTN","SRONRPT",21,0)
 D LINE(1) S @SRG@(SRI)="Operating Room:  "_SROR S @SRG@(SRI)=@SRG@(SRI)_$$SPACE(40)_"Surgical Priority: "_SRTYPE
"RTN","SRONRPT",22,0)
 S Y=$P(SR(.2),"^",15) I Y D D^DIQ S SRTIME=$P(Y,"@")_"  "_$P(Y,"@",2)
"RTN","SRONRPT",23,0)
 S:Y="" SRTIME="NOT ENTERED" D LINE(2) S @SRG@(SRI)="Patient in Hold: "_SRTIME
"RTN","SRONRPT",24,0)
 S Y=$P(SR(.2),"^",10) I Y D D^DIQ S SRTIME=$P(Y,"@")_"  "_$P(Y,"@",2)
"RTN","SRONRPT",25,0)
 S:Y="" SRTIME="* NOT ENTERED *" S @SRG@(SRI)=@SRG@(SRI)_$$SPACE(40)_"Patient in OR:  "_SRTIME
"RTN","SRONRPT",26,0)
 S Y=$P(SR(.2),"^",2) I Y D D^DIQ S SRTIME=$P(Y,"@")_"  "_$P(Y,"@",2)
"RTN","SRONRPT",27,0)
 S:Y="" SRTIME="NOT ENTERED" D LINE(1) S @SRG@(SRI)="Operation Begin: "_SRTIME
"RTN","SRONRPT",28,0)
 S Y=$P(SR(.2),"^",3) I Y D D^DIQ S SRTIME=$P(Y,"@")_"  "_$P(Y,"@",2)
"RTN","SRONRPT",29,0)
 S:Y="" SRTIME="NOT ENTERED" S @SRG@(SRI)=@SRG@(SRI)_$$SPACE(40)_"Operation End:  "_SRTIME
"RTN","SRONRPT",30,0)
 S Y=$P(SR(.2),"^",9) I Y D D^DIQ S SRTIME=$P(Y,"@")_"  "_$P(Y,"@",2)
"RTN","SRONRPT",31,0)
 S:Y="" SRTIME="NOT ENTERED" D LINE(1) S @SRG@(SRI)="Surgeon in OR:   "_SRTIME
"RTN","SRONRPT",32,0)
 S Y=$P(SR(.2),"^",12) I Y D D^DIQ S SRTIME=$P(Y,"@")_"  "_$P(Y,"@",2)
"RTN","SRONRPT",33,0)
 S:Y="" SRTIME="* NOT ENTERED *" S @SRG@(SRI)=@SRG@(SRI)_$$SPACE(40)_"Patient Out OR: "_SRTIME
"RTN","SRONRPT",34,0)
 D PROC I $O(^SRF(SRTN,13,0)) D OTHER
"RTN","SRONRPT",35,0)
 S Y=$P(SR("1.0"),"^",8),C=$P(^DD(130,1.09,0),"^",2) D:Y'="" Y^DIQ D LINE(2) S @SRG@(SRI)="Wound Classification: "_$S(Y'="":Y,1:"NOT ENTERED")
"RTN","SRONRPT",36,0)
 S Y=$P(SR(.4),"^",6),C=$P(^DD(130,.46,0),"^",2) D:Y'="" Y^DIQ S SRDISP=$S(Y'="":Y,1:"N/A")
"RTN","SRONRPT",37,0)
 I (SRDISP="N/A"&SRALL)!(SRDISP'="N/A") D LINE(1) S @SRG@(SRI)="Operation Disposition: "_SRDISP
"RTN","SRONRPT",38,0)
 S Y=$P(SR(.7),"^",4),C=$P(^DD(130,25,0),"^",2) D:Y'="" Y^DIQ S VIA=$S(Y'="":Y,1:"N/A")
"RTN","SRONRPT",39,0)
 I (VIA="N/A"&SRALL)!(VIA'="N/A") D LINE(1) S @SRG@(SRI)="Discharged Via: "_VIA
"RTN","SRONRPT",40,0)
 S Y=$P(SR(.1),"^",4),C=$P(^DD(130,.14,0),"^",2) D:Y'="" Y^DIQ,N(30) S:Y="" Y="NOT ENTERED" D LINE(2) S @SRG@(SRI)="Surgeon: "_Y
"RTN","SRONRPT",41,0)
 S Y=$P(SR(.1),"^",5),C=$P(^DD(130,.15,0),"^",2) D:Y'="" Y^DIQ,N(25) S:Y="" Y="N/A" S @SRG@(SRI)=@SRG@(SRI)_$$SPACE(40)_"First Assist: "_Y
"RTN","SRONRPT",42,0)
 S Y=$P(SR(.1),"^",13),C=$P(^DD(130,.164,0),"^",2) D:Y'="" Y^DIQ,N(26) S:Y="" Y="N/A" D LINE(1) S @SRG@(SRI)="Attend Surg: "_Y
"RTN","SRONRPT",43,0)
 S Y=$P(SR(.1),"^",6),C=$P(^DD(130,.16,0),"^",2) D:Y'="" Y^DIQ,N(24) S:Y="" Y="N/A" S @SRG@(SRI)=@SRG@(SRI)_$$SPACE(40)_"Second Assist: "_Y
"RTN","SRONRPT",44,0)
 S Y=$P(SR(.3),"^"),C=$P(^DD(130,.31,0),"^",2) D:Y'="" Y^DIQ,N(26) S SRANES=$S(Y="":"NOT ENTERED",1:Y)
"RTN","SRONRPT",45,0)
 S Y=$P(SR(.3),"^",3),C=$P(^DD(130,.33,0),"^",2) D:Y'="" Y^DIQ,N(21) S SRANESA=$S(Y="":"N/A",1:Y)
"RTN","SRONRPT",46,0)
 I 'SRALL,SRANES="NOT ENTERED",SRANESA="N/A" G OSA
"RTN","SRONRPT",47,0)
 D LINE(1) S @SRG@(SRI)="Anesthetist: "_SRANES,@SRG@(SRI)=@SRG@(SRI)_$$SPACE(40)_"Assistant Anesth: "_SRANESA
"RTN","SRONRPT",48,0)
OSA S SRLINE="Other Scrubbed Assistants: "
"RTN","SRONRPT",49,0)
 I '$O(^SRF(SRTN,28,0)),SRALL D LINE(2) S @SRG@(SRI)=SRLINE_"N/A"
"RTN","SRONRPT",50,0)
 I $O(^SRF(SRTN,28,0)) D LINE(2) S @SRG@(SRI)=SRLINE,OTH=0 F  S OTH=$O(^SRF(SRTN,28,OTH)) Q:'OTH  D
"RTN","SRONRPT",51,0)
 .S Y=$P(^SRF(SRTN,28,OTH,0),"^"),C=$P(^DD(130.23,.01,0),"^",2) D:Y'="" Y^DIQ D LINE(1) S @SRG@(SRI)="  "_Y
"RTN","SRONRPT",52,0)
 .I $O(^SRF(SRTN,28,OTH,1,0)) D
"RTN","SRONRPT",53,0)
 ..S SRLINE=0,SRL=4 D LINE(1) S @SRG@(SRI)="    Comments:"
"RTN","SRONRPT",54,0)
 ..F  S SRLINE=$O(^SRF(SRTN,28,OTH,1,SRLINE)) Q:'SRLINE  S X=^SRF(SRTN,28,OTH,1,SRLINE,0) D COMM^SRONRPT3(X,SRL)
"RTN","SRONRPT",55,0)
 D ^SRONRPT0
"RTN","SRONRPT",56,0)
 Q
"RTN","SRONRPT",57,0)
PROC ; print procedure informatiom
"RTN","SRONRPT",58,0)
 N I,M,MM,SRJ,SRMAJ,SROPER,SROPS,SRX,SRY,X,Z
"RTN","SRONRPT",59,0)
 S SRMAJ=$P(SR(0),"^",3),SRMAJ=$S(SRMAJ="J":"Major",SRMAJ="N":"Minor",1:"Major")
"RTN","SRONRPT",60,0)
 D LINE(2) S @SRG@(SRI)=SRMAJ_" Operations Performed:"
"RTN","SRONRPT",61,0)
 S SROPER=$P(^SRF(SRTN,"OP"),"^")
"RTN","SRONRPT",62,0)
 I $P($G(^SRF(SRTN,30)),"^")&$P($G(^SRF(SRTN,.2)),"^",10) S SROPER="** ABORTED ** "_SROPER
"RTN","SRONRPT",63,0)
 K SROPS,MM,MMM S:$L(SROPER)<70 SROPS(1)=SROPER I $L(SROPER)>69 S SROPER=SROPER_"  " F M=1:1 D LOOP Q:MMM=""
"RTN","SRONRPT",64,0)
 F I=1:1 Q:'$D(SROPS(I))  D LINE(1) S @SRG@(SRI)=$S(I=1:"Primary: ",1:"         ")_SROPS(I)
"RTN","SRONRPT",65,0)
 Q
"RTN","SRONRPT",66,0)
OTHER ; other procedures
"RTN","SRONRPT",67,0)
 N CNT,OTH,OTHER,SRJ,SRX,SRY
"RTN","SRONRPT",68,0)
 S (OTH,CNT)=0 F  S OTH=$O(^SRF(SRTN,13,OTH)) Q:'OTH  S CNT=CNT+1 D OTH
"RTN","SRONRPT",69,0)
 Q
"RTN","SRONRPT",70,0)
OTH S OTHER=$P(^SRF(SRTN,13,OTH,0),"^")
"RTN","SRONRPT",71,0)
 D LINE(1) S @SRG@(SRI)="Other:   "_OTHER
"RTN","SRONRPT",72,0)
 Q
"RTN","SRONRPT",73,0)
LOOP ; break procedure if greater than 70 characters
"RTN","SRONRPT",74,0)
 S SROPS(M)="" F LOOP=1:1 S MM=$P(SROPER," "),MMM=$P(SROPER," ",2,200) Q:MMM=""  Q:$L(SROPS(M))+$L(MM)'<70  S SROPS(M)=SROPS(M)_MM_" ",SROPER=MMM
"RTN","SRONRPT",75,0)
 Q
"RTN","SRONRPT",76,0)
N(SRL) N SRN I $L(Y)>SRL S SRN=$P(Y,",")_","_$E($P(Y,",",2))_".",Y=SRN
"RTN","SRONRPT",77,0)
 Q
"RTN","SRONRPT",78,0)
SPACE(NUM) ; create spaces
"RTN","SRONRPT",79,0)
 ; pass in position returns number of needed spaces
"RTN","SRONRPT",80,0)
 I '$D(@SRG@(SRI)) S @SRG@(SRI)=""
"RTN","SRONRPT",81,0)
 Q $J("",NUM-$L(@SRG@(SRI)))
"RTN","SRONRPT",82,0)
LINE(NUM) ; create carriage returns
"RTN","SRONRPT",83,0)
 F J=1:1:NUM S SRI=SRI+1,@SRG@(SRI)=""
"RTN","SRONRPT",84,0)
 Q
"RTN","SRONRPT0")
0^77^B46385929
"RTN","SRONRPT0",1,0)
SRONRPT0 ;BIR/ADM - NURSE INTRAOP REPORT ; [ 02/27/04 10:12 AM ]
"RTN","SRONRPT0",2,0)
 ;;3.0; Surgery ;**100**;24 Jun 93
"RTN","SRONRPT0",3,0)
 ;
"RTN","SRONRPT0",4,0)
 ;** NOTICE: This routine is part of an implementation of a nationally
"RTN","SRONRPT0",5,0)
 ;**         controlled procedure.  Local modifications to this routine
"RTN","SRONRPT0",6,0)
 ;**         are prohibited.
"RTN","SRONRPT0",7,0)
 ;
"RTN","SRONRPT0",8,0)
 D LINE(2) S @SRG@(SRI)="OR Support Personnel:" D LINE(1) S @SRG@(SRI)="  Scrubbed",@SRG@(SRI)=@SRG@(SRI)_$$SPACE(40)_"Circulating" D NURSE
"RTN","SRONRPT0",9,0)
 S SRLF=1,SRLINE="Other Persons in OR: " I '$O(^SRF(SRTN,32,0)),SRALL D LINE(1) S @SRG@(SRI)=SRLINE_"N/A"
"RTN","SRONRPT0",10,0)
 I $O(^SRF(SRTN,32,0)) D LINE(1) S @SRG@(SRI)=SRLINE D
"RTN","SRONRPT0",11,0)
 .S OTH=0 F  S OTH=$O(^SRF(SRTN,32,OTH)) Q:'OTH  D
"RTN","SRONRPT0",12,0)
 ..S X=^SRF(SRTN,32,OTH,0),SRLINE="  "_$P(X,"^")
"RTN","SRONRPT0",13,0)
 ..S Y=$P(X,"^",2) S:Y'="" SRLINE=SRLINE_" ("_Y_")"
"RTN","SRONRPT0",14,0)
 ..D LINE(1) S @SRG@(SRI)=SRLINE
"RTN","SRONRPT0",15,0)
 S SRLF=1
"RTN","SRONRPT0",16,0)
 S X=$P(SR(.1),"^",9),SRMOOD=$S(X:$E($P(^SRO(135.3,X,0),"^"),1,20),1:"N/A")
"RTN","SRONRPT0",17,0)
 S X=$P(SR(.1),"^",15),SRCONS=$S(X:$E($P(^SRO(135.4,X,0),"^"),1,24),1:"N/A")
"RTN","SRONRPT0",18,0)
 S X=$P(SR(0),"^",7),SRSKIN=$S(X:$E($P(^SRO(135.2,X,0),"^"),1,20),1:"N/A")
"RTN","SRONRPT0",19,0)
 S Y=$P(SR(.1),"^",14),C=$P(^DD(130,.195,0),"^",2) D:Y'="" Y^DIQ S SRCONV=$S(Y'="":Y,1:"N/A")
"RTN","SRONRPT0",20,0)
 I 'SRALL,SRMOOD="N/A",SRCONS="N/A" G SKIN
"RTN","SRONRPT0",21,0)
 D LINE(1) S @SRG@(SRI)="Preop Mood:",@SRG@(SRI)=@SRG@(SRI)_$$SPACE(18)_SRMOOD,@SRG@(SRI)=@SRG@(SRI)_$$SPACE(40)_"Preop Consc:",@SRG@(SRI)=@SRG@(SRI)_$$SPACE(56)_SRCONS
"RTN","SRONRPT0",22,0)
SKIN I 'SRALL,SRSKIN="N/A",SRCONV="N/A" G VAL
"RTN","SRONRPT0",23,0)
 D LINE(1) S @SRG@(SRI)="Preop Skin Integ: "_SRSKIN,@SRG@(SRI)=@SRG@(SRI)_$$SPACE(40)_"Preop Converse: "_SRCONV
"RTN","SRONRPT0",24,0)
VAL S SRLF=1,Y=$P(SR(.6),"^",9),C=$P(^DD(130,.69,0),"^",2) D:Y'="" Y^DIQ S SRUSER=$S(Y="":"N/A",1:Y)
"RTN","SRONRPT0",25,0)
 I 'SRALL,SRUSER="N/A" G VER
"RTN","SRONRPT0",26,0)
 D LINE(1) S @SRG@(SRI)="Valid Consent/ID Band Confirmed By: "_SRUSER
"RTN","SRONRPT0",27,0)
 ;
"RTN","SRONRPT0",28,0)
VER N SRSJ,SROIM,SROUT,SROIN
"RTN","SRONRPT0",29,0)
 S Y=$P(SR("VER"),"^",5),SROIN=$S(Y="Y":"YES",Y="M":"MARKING NOT REQUIRED FOR THIS PROCEDURE",Y="N":"NO - MARKING REQUIRED BUT NOT DONE (see CORRECT SURGERY COMMENTS)",1:"* NOT ENTERED *")
"RTN","SRONRPT0",30,0)
 D LINE(1) S @SRG@(SRI)="Mark on Surgical Site Confirmed: "_$S($L(SROIN)>43:"",1:SROIN)
"RTN","SRONRPT0",31,0)
 I $L(SROIN)>43 D LINE(1) S @SRG@(SRI)=$$SPACE(2)_SROIN
"RTN","SRONRPT0",32,0)
 S Y=$P(SR("VER"),"^",4),SROIM=$S(Y="Y":"YES",Y="I":"IMAGING NOT REQUIRED FOR THIS PROCEDURE",Y="N":"IMAGING REQUIRED BUT NOT VIEWED (see CORRECT SURGERY COMMENTS)",1:"* NOT ENTERED *")
"RTN","SRONRPT0",33,0)
 D LINE(1) S @SRG@(SRI)="Preoperative Imaging Confirmed:  "_$S($L(SROIM)>43:"",1:SROIM)
"RTN","SRONRPT0",34,0)
 I $L(SROIM)>43 D LINE(1) S @SRG@(SRI)=$$SPACE(2)_SROIM
"RTN","SRONRPT0",35,0)
 S Y=$P(SR("VER"),"^",3),SROUT=$S(Y="Y":"YES",Y="N":"NO (see SEE CORRECT SURGERY COMMENTS)",1:"* NOT ENTERED *")
"RTN","SRONRPT0",36,0)
 D LINE(1) S @SRG@(SRI)="Time Out Verification Completed: "_$S($L(SROUT)>43:"",1:SROUT)
"RTN","SRONRPT0",37,0)
 I $L(SROUT)>43 D LINE(1) S @SRG@(SRI)=$$SPACE(2)_SROUT
"RTN","SRONRPT0",38,0)
 D LINE(2) S @SRG@(SRI)="Correct Surgery Comments: " D
"RTN","SRONRPT0",39,0)
 .I '$O(^SRF(SRTN,74,0)) S @SRG@(SRI)=@SRG@(SRI)_"NO COMMENTS ENTERED" Q
"RTN","SRONRPT0",40,0)
 .S SRSJ=0 F  S SRSJ=$O(^SRF(SRTN,74,SRSJ)) Q:'SRSJ  D LINE(1) S @SRG@(SRI)=$$SPACE(2)_^SRF(SRTN,74,SRSJ,0)
"RTN","SRONRPT0",41,0)
 S SRLF=1
"RTN","SRONRPT0",42,0)
 ;
"RTN","SRONRPT0",43,0)
PREP S Y=$P(SR(.1),"^",8),C=$P(^DD(130,.18,0),"^",2) D:Y'="" Y^DIQ,N(25) S SRUSER=$S(Y="":"N/A",1:Y)
"RTN","SRONRPT0",44,0)
 S Y=$P(SR(.1),"^",7),C=$P(^DD(130,.175,0),"^",2) D:Y'="" Y^DIQ S SRAGNT=$S(Y="":"N/A",1:$E(Y,1,22))
"RTN","SRONRPT0",45,0)
 I 'SRALL,SRUSER="N/A",SRAGNT="N/A" G PREP2
"RTN","SRONRPT0",46,0)
 D LINE(1) S @SRG@(SRI)="Skin Prep By: "_SRUSER,@SRG@(SRI)=@SRG@(SRI)_$$SPACE(40)_"Skin Prep Agent: "_SRAGNT
"RTN","SRONRPT0",47,0)
PREP2 S Y=$P(SR(.1),"^",12),C=$P(^DD(130,4,0),"^",2) D:Y'="" Y^DIQ,N(21) S SRUSER=$S(Y="":"N/A",1:Y)
"RTN","SRONRPT0",48,0)
 S Y=$P(SR(31),"^",2),C=$P(^DD(130,8,0),"^",2) D:Y'="" Y^DIQ S SRAGNT=$S(Y="":"N/A",1:$E(Y,1,18))
"RTN","SRONRPT0",49,0)
 I 'SRALL,SRUSER="N/A",SRAGNT="N/A" G PREOP
"RTN","SRONRPT0",50,0)
 D LINE(1) S @SRG@(SRI)="Skin Prep By (2): "_SRUSER,@SRG@(SRI)=@SRG@(SRI)_$$SPACE(40)_"2nd Skin Prep Agent: "_SRAGNT
"RTN","SRONRPT0",51,0)
PREOP S Y=$P(SR(.1),"^",2),C=$P(^DD(130,.12,0),"^",2) D:Y'="" Y^DIQ S SRUSER=$S(Y="":"N/A",1:Y) I 'SRALL,SRUSER="N/A" G POS
"RTN","SRONRPT0",52,0)
 D LINE(1) S @SRG@(SRI)="Preop Shave By: "_SRUSER
"RTN","SRONRPT0",53,0)
POS S SRLF=1,SRLINE="Surgery Position(s): " I '$O(^SRF(SRTN,42,0)),SRALL D LINE(1) S @SRG@(SRI)=SRLINE_"N/A"
"RTN","SRONRPT0",54,0)
 I $O(^SRF(SRTN,42,0)) D LINE(1) S @SRG@(SRI)=SRLINE D
"RTN","SRONRPT0",55,0)
 .S SRP=0 F  S SRP=$O(^SRF(SRTN,42,SRP)) Q:'SRP  S X=^SRF(SRTN,42,SRP,0),Z=$P(X,"^"),Y=$P(X,"^",2) D
"RTN","SRONRPT0",56,0)
 ..S SRPOS=$P(^SRO(132,Z,0),"^") D:Y D^DIQ S SRTIME=$S(Y'="":$P(Y,"@")_"  "_$P(Y,"@",2),1:"N/A")
"RTN","SRONRPT0",57,0)
 ..D LINE(1) S @SRG@(SRI)="  "_SRPOS,@SRG@(SRI)=@SRG@(SRI)_$$SPACE(40)_"Placed: "_SRTIME
"RTN","SRONRPT0",58,0)
 S SRLF=1,SRLINE="Restraints and Position Aids: "
"RTN","SRONRPT0",59,0)
 I '$O(^SRF(SRTN,20,0)),SRALL D LINE(1) S @SRG@(SRI)=SRLINE_"N/A"
"RTN","SRONRPT0",60,0)
 I $O(^SRF(SRTN,20,0)) N SRRP D LINE(1) S @SRG@(SRI)=SRLINE,(SRRP,CNT)=0 F  S SRRP=$O(^SRF(SRTN,20,SRRP)) Q:'SRRP  S CNT=CNT+1,X=^SRF(SRTN,20,SRRP,0),Z=$P(X,"^"),Y=$P(X,"^",2),W=$P(X,"^",3) D
"RTN","SRONRPT0",61,0)
 .S SREST=$P(^SRO(132.05,Z,0),"^"),C=$P(^DD(130.31,1,0),"^",2) D:Y'="" Y^DIQ,N(31) S:Y="" Y="N/A"
"RTN","SRONRPT0",62,0)
 .D LINE(1) S @SRG@(SRI)="  "_SREST,@SRG@(SRI)=@SRG@(SRI)_$$SPACE(36)_"Applied By: "_Y
"RTN","SRONRPT0",63,0)
 .I W'="" D LINE(1) S @SRG@(SRI)="      Comments: "_W
"RTN","SRONRPT0",64,0)
 S SRLF=1,X=$P(SR(.7),"^",5),SREL=$S(X'="":X,1:"N/A")
"RTN","SRONRPT0",65,0)
 S X=$P(SR(.5),"^",4),SRELP=$S(X:$P(^SRO(138,X,0),"^"),1:"N/A")
"RTN","SRONRPT0",66,0)
 S X=$P(SR(.5),"^",13),SRELP2=$S(X:$P(^SRO(138,X,0),"^"),1:"")
"RTN","SRONRPT0",67,0)
 S X=$P(SR(.7),"^"),SRC=$S(X'="":X,1:"N/A"),X=$P(SR(.7),"^",2),SRCT=$S(X'="":X,1:"N/A")
"RTN","SRONRPT0",68,0)
 I 'SRALL,SREL="N/A",SRELP="N/A",SRELP2="" G LAB
"RTN","SRONRPT0",69,0)
 D LINE(1) S @SRG@(SRI)="Electrocautery Unit:       "_SREL
"RTN","SRONRPT0",70,0)
 D LINE(1) S @SRG@(SRI)="ESU Coagulation Range:     "_SRC
"RTN","SRONRPT0",71,0)
 D LINE(1) S @SRG@(SRI)="ESU Cutting Range:         "_SRCT
"RTN","SRONRPT0",72,0)
 D LINE(1) S @SRG@(SRI)="Electroground Position(s): "_SRELP
"RTN","SRONRPT0",73,0)
 I SRELP2'="" D LINE(1) S @SRG@(SRI)=$$SPACE(27)_SRELP2
"RTN","SRONRPT0",74,0)
LAB S SRLF=1 I $O(^SRF(SRTN,9,0))!SRALL D LAB1
"RTN","SRONRPT0",75,0)
 S SRLF=1 I $O(^SRF(SRTN,6,0)) D LINE(1) S @SRG@(SRI)="Anesthesia Technique(s):" S ANE=0 F  S ANE=$O(^SRF(SRTN,6,ANE)) Q:'ANE  D ANE
"RTN","SRONRPT0",76,0)
 I '$O(^SRF(SRTN,6,0)),SRALL D LINE(1) S @SRG@(SRI)="Anesthesia Technique(s): N/A"
"RTN","SRONRPT0",77,0)
 D ^SRONRPT1
"RTN","SRONRPT0",78,0)
 Q
"RTN","SRONRPT0",79,0)
NURSE ; nurse info
"RTN","SRONRPT0",80,0)
 N CNT,CIRC,I,NURSE,SCRU,X,Y,Z
"RTN","SRONRPT0",81,0)
 S (CNT,CIRC)=0 F  S CIRC=$O(^SRF(SRTN,19,CIRC)) Q:'CIRC  S CNT=CNT+1 D
"RTN","SRONRPT0",82,0)
 .S Z=^SRF(SRTN,19,CIRC,0),Y=$P(Z,"^"),C=$P(^DD(130.28,.01,0),"^",2) D Y^DIQ,N(21) S SRX=Y
"RTN","SRONRPT0",83,0)
 .S Y=$P(Z,"^",3),C=$P(^DD(130.28,3,0),"^",2) D:Y'="" Y^DIQ S CIRC(CNT)=SRX_" ("_Y_")"
"RTN","SRONRPT0",84,0)
 S (CNT,SCRU)=0 F  S SCRU=$O(^SRF(SRTN,23,SCRU)) Q:'SCRU  S CNT=CNT+1 D
"RTN","SRONRPT0",85,0)
 .S Z=^SRF(SRTN,23,SCRU,0),Y=$P(Z,"^"),C=$P(^DD(130.36,.01,0),"^",2) D Y^DIQ,N(21) S SRX=Y
"RTN","SRONRPT0",86,0)
 .S Y=$P(Z,"^",3),C=$P(^DD(130.36,3,0),"^",2) D:Y'="" Y^DIQ S SCRU(CNT)=SRX_" ("_Y_")"
"RTN","SRONRPT0",87,0)
 S:'$D(SCRU(1)) SCRU(1)="N/A" S:'$D(CIRC(1)) CIRC(1)="N/A"
"RTN","SRONRPT0",88,0)
 F I=1:1 Q:('$D(SCRU(I))&'$D(CIRC(I)))  S NURSE(I)=$S($D(SCRU(I)):SCRU(I),1:"")_"^"_$S($D(CIRC(I)):CIRC(I),1:"")
"RTN","SRONRPT0",89,0)
 S I=0 F  S I=$O(NURSE(I)) Q:'I  D LINE(1) S @SRG@(SRI)=$$SPACE(2)_$P(NURSE(I),"^") S @SRG@(SRI)=@SRG@(SRI)_$$SPACE(40)_$P(NURSE(I),"^",2)
"RTN","SRONRPT0",90,0)
 Q
"RTN","SRONRPT0",91,0)
LAB1 N SRSP S SRLF=1 D LINE(1) S @SRG@(SRI)="Material Sent to Laboratory for Analysis: "
"RTN","SRONRPT0",92,0)
 I 'SRALL,'$O(^SRF(SRTN,9,0)),'$O(^SRF(SRTN,41,0)) S @SRG@(SRI)=@SRG@(SRI)_"N/A" Q
"RTN","SRONRPT0",93,0)
 D LINE(1) S @SRG@(SRI)="Specimens: " D
"RTN","SRONRPT0",94,0)
 .I '$O(^SRF(SRTN,9,0)) S @SRG@(SRI)=@SRG@(SRI)_"N/A" Q
"RTN","SRONRPT0",95,0)
 .S SRSP=0 F  S SRSP=$O(^SRF(SRTN,9,SRSP)) Q:'SRSP  D LINE(1) S @SRG@(SRI)=$$SPACE(2)_^SRF(SRTN,9,SRSP,0)
"RTN","SRONRPT0",96,0)
 D LINE(1) S @SRG@(SRI)="Cultures:  " D
"RTN","SRONRPT0",97,0)
 .I '$O(^SRF(SRTN,41,0)) S @SRG@(SRI)=@SRG@(SRI)_"N/A" Q
"RTN","SRONRPT0",98,0)
 .S SRSP=0 F  S SRSP=$O(^SRF(SRTN,41,SRSP)) Q:'SRSP  D LINE(1) S @SRG@(SRI)=$$SPACE(2)_^SRF(SRTN,41,SRSP,0)
"RTN","SRONRPT0",99,0)
 Q
"RTN","SRONRPT0",100,0)
N(SRL) N SRN I $L(Y)>SRL S SRN=$P(Y,",")_","_$E($P(Y,",",2))_".",Y=SRN
"RTN","SRONRPT0",101,0)
 Q
"RTN","SRONRPT0",102,0)
SPACE(NUM) ; create spaces
"RTN","SRONRPT0",103,0)
 ;pass in position returns number of needed spaces
"RTN","SRONRPT0",104,0)
 I '$D(@SRG@(SRI)) S @SRG@(SRI)=""
"RTN","SRONRPT0",105,0)
 Q $J("",NUM-$L(@SRG@(SRI)))
"RTN","SRONRPT0",106,0)
LINE(NUM) ; create carriage returns
"RTN","SRONRPT0",107,0)
 I $G(SRLF) S NUM=NUM+1,SRLF=0
"RTN","SRONRPT0",108,0)
 F J=1:1:NUM S SRI=SRI+1,@SRG@(SRI)=""
"RTN","SRONRPT0",109,0)
 Q
"RTN","SRONRPT0",110,0)
ANE ; print anesthesia technique
"RTN","SRONRPT0",111,0)
 N A,AGNT,C,CNT,DRUG
"RTN","SRONRPT0",112,0)
 S A=^SRF(SRTN,6,ANE,0),Y=$P(A,"^"),C=$P(^DD(130.06,.01,0),"^",2) D:Y'="" Y^DIQ D LINE(1) S Y=Y_$S($P(A,"^",3)="Y":"  (PRINCIPAL)",1:""),@SRG@(SRI)=$$SPACE(2)_Y
"RTN","SRONRPT0",113,0)
 Q
"RTN","SRONRPT1")
0^78^B17672119
"RTN","SRONRPT1",1,0)
SRONRPT1 ;BIR/ADM - NURSE INTRAOP REPORT ; [ 11/28/00  9:47 AM ]
"RTN","SRONRPT1",2,0)
 ;;3.0; Surgery ;**100**;24 Jun 93
"RTN","SRONRPT1",3,0)
 ;
"RTN","SRONRPT1",4,0)
 ;** NOTICE: This routine is part of an implementation of a nationally
"RTN","SRONRPT1",5,0)
 ;**         controlled procedure.  Local modifications to this routine
"RTN","SRONRPT1",6,0)
 ;**         are prohibited.
"RTN","SRONRPT1",7,0)
 ;
"RTN","SRONRPT1",8,0)
 S SRLF=1 N SRTD S SRTD=$P($G(^SRF(SRTN,3)),"^") I SRTD="",SRALL D LINE(1) S @SRG@(SRI)="Tubes and Drains: N/A"
"RTN","SRONRPT1",9,0)
 I SRTD'="" D LINE(1) S @SRG@(SRI)="Tubes and Drains: " D LINE(1) S @SRG@(SRI)="  "_SRTD
"RTN","SRONRPT1",10,0)
 S SRLF=1 I '$O(^SRF(SRTN,2,0)),SRALL D LINE(1) S @SRG@(SRI)="Tourniquet: N/A"
"RTN","SRONRPT1",11,0)
 I $O(^SRF(SRTN,2,0)) D LINE(1) S @SRG@(SRI)="Tourniquet:" D TOUR
"RTN","SRONRPT1",12,0)
 S SRLF=1,SRLINE="Thermal Unit: " I '$O(^SRF(SRTN,21,0)),SRALL D LINE(1) S @SRG@(SRI)=SRLINE_"N/A"
"RTN","SRONRPT1",13,0)
 I $O(^SRF(SRTN,21,0)) D LINE(1) S @SRG@(SRI)=SRLINE D THERM
"RTN","SRONRPT1",14,0)
 S SRLF=1,SRLINE="Prosthesis Installed: " I '$O(^SRF(SRTN,1,0)),SRALL D LINE(1) S @SRG@(SRI)=SRLINE_"N/A"
"RTN","SRONRPT1",15,0)
 I $O(^SRF(SRTN,1,0)) D LINE(1) S @SRG@(SRI)=SRLINE D PRO
"RTN","SRONRPT1",16,0)
 S SRLF=1,SRLINE="Medications: " I '$O(^SRF(SRTN,22,0)),SRALL D LINE(1) S @SRG@(SRI)=SRLINE_"N/A"
"RTN","SRONRPT1",17,0)
 I $O(^SRF(SRTN,22,0)) D LINE(1) S @SRG@(SRI)=SRLINE D MED
"RTN","SRONRPT1",18,0)
 D ^SRONRPT2
"RTN","SRONRPT1",19,0)
 Q
"RTN","SRONRPT1",20,0)
MED ; medications
"RTN","SRONRPT1",21,0)
 N ADBY,ADM,COMMENT,DOSE,DRUG,MED,MM,ORBY,ROUTE,TIME
"RTN","SRONRPT1",22,0)
 S MED=0 F  S MED=$O(^SRF(SRTN,22,MED)) Q:'MED  D
"RTN","SRONRPT1",23,0)
 .S Y=$P(^SRF(SRTN,22,MED,0),"^"),C=$P(^DD(130.33,.01,0),"^",2) D Y^DIQ,LINE(1) S @SRG@(SRI)="  "_Y,ADM=0
"RTN","SRONRPT1",24,0)
 Q
"RTN","SRONRPT1",25,0)
N(SRL) N SRN I $L(Y)>SRL S SRN=$P(Y,",")_","_$E($P(Y,",",2))_".",Y=SRN
"RTN","SRONRPT1",26,0)
 Q
"RTN","SRONRPT1",27,0)
PRO ; prosthesis
"RTN","SRONRPT1",28,0)
 N C,ITEM,MODEL,PRO,QTY,SERIAL,SIZE,STERILE,VENDOR
"RTN","SRONRPT1",29,0)
 S PRO=0 F  S PRO=$O(^SRF(SRTN,1,PRO)) Q:'PRO  D
"RTN","SRONRPT1",30,0)
 .S X=^SRF(SRTN,1,PRO,0),ITEM=$P(X,"^"),VENDOR=$P(X,"^",2),MODEL=$P(X,"^",3),SERIAL=$P(X,"^",5),Y=$P(X,"^",7),C=$P(^DD(130.01,5,0),"^",2) D:Y'="" Y^DIQ S STERILE=$S(Y'="":Y,1:"N/A")
"RTN","SRONRPT1",31,0)
 .S X=$G(^SRF(SRTN,1,PRO,1)),SIZE=$P(X,"^"),QTY=$P(X,"^",2)
"RTN","SRONRPT1",32,0)
 .D LINE(1) S @SRG@(SRI)="  Item: "_$P(^SRO(131.9,ITEM,0),"^") D LINE(1) S @SRG@(SRI)="    Vendor: "_$S(VENDOR'="":VENDOR,1:"N/A")
"RTN","SRONRPT1",33,0)
 .D LINE(1) S @SRG@(SRI)="    Model: "_$S(MODEL'="":MODEL,1:"N/A")
"RTN","SRONRPT1",34,0)
 .D LINE(1) S @SRG@(SRI)="    Lot/Serial Number: "_$S(SERIAL'="":SERIAL,1:"N/A"),@SRG@(SRI)=@SRG@(SRI)_$$SPACE(53)_"Sterile Resp: "_STERILE
"RTN","SRONRPT1",35,0)
 .D LINE(1) S @SRG@(SRI)="    Size: "_$S(SIZE'="":SIZE,1:"N/A"),@SRG@(SRI)=@SRG@(SRI)_$$SPACE(53)_"Quantity: "_$S(QTY'="":QTY,1:"N/A")
"RTN","SRONRPT1",36,0)
 Q
"RTN","SRONRPT1",37,0)
THERM ; thermal unit
"RTN","SRONRPT1",38,0)
 N OFF,ON,TEMP,TH,UNIT S TH=0 F  S TH=$O(^SRF(SRTN,21,TH)) Q:'TH  D
"RTN","SRONRPT1",39,0)
 .S UNIT=^SRF(SRTN,21,TH,0),TEMP=$P(UNIT,"^",3),TEMP=$S(TEMP'="":TEMP,1:"N/A"),ON=$P(UNIT,"^",2),OFF=$P(UNIT,"^",4)
"RTN","SRONRPT1",40,0)
 .D LINE(1) S @SRG@(SRI)="  "_$P(UNIT,"^"),@SRG@(SRI)=@SRG@(SRI)_$$SPACE(40)_"Temperature: "_TEMP
"RTN","SRONRPT1",41,0)
 .S Y=ON D:Y D^DIQ S ON=$S(Y="":"N/A",1:$P(Y,"@")_"  "_$P(Y,"@",2)),Y=OFF D:Y D^DIQ S OFF=$S(Y="":"N/A",1:$P(Y,"@")_"  "_$P(Y,"@",2))
"RTN","SRONRPT1",42,0)
 .D LINE(1) S @SRG@(SRI)="    Time On: "_ON,@SRG@(SRI)=@SRG@(SRI)_$$SPACE(40)_"Time Off: "_OFF
"RTN","SRONRPT1",43,0)
 Q
"RTN","SRONRPT1",44,0)
TOUR ; tourniquet info
"RTN","SRONRPT1",45,0)
 N APBY,C,M,PRESS,SITE,TIME,TIME2,TOUR
"RTN","SRONRPT1",46,0)
 S TOUR=0 F  S TOUR=$O(^SRF(SRTN,2,TOUR)) Q:'TOUR  D
"RTN","SRONRPT1",47,0)
 .S M=^SRF(SRTN,2,TOUR,0),Y=$P(M,"^") D D^DIQ S TIME=$P(Y,"@")_"  "_$P(Y,"@",2),Y=$P(M,"^",4) S TIME2="NOT ENTERED" I Y D D^DIQ S TIME2=$P(Y,"@")_"  "_$P(Y,"@",2)
"RTN","SRONRPT1",48,0)
 .D LINE(1) S @SRG@(SRI)="  Time Applied: "_TIME S @SRG@(SRI)=@SRG@(SRI)_$$SPACE(40)_"Time Released: "_TIME2
"RTN","SRONRPT1",49,0)
 .S Y=$P(M,"^",2),C=$P(^DD(130.02,1,0),"^",2) D:Y'="" Y^DIQ S SITE=$S(Y="":"NOT ENTERED",1:Y),X=$P(M,"^",5),PRESS=$S(X="":"N/A",1:X)
"RTN","SRONRPT1",50,0)
 .D LINE(1) S @SRG@(SRI)="    Site Applied: "_SITE,@SRG@(SRI)=@SRG@(SRI)_$$SPACE(40)_"Pressure Applied (in TORR): "_PRESS
"RTN","SRONRPT1",51,0)
 .S Y=$P(M,"^",3),C=$P(^DD(130.02,2,0),"^",2) D:Y'="" Y^DIQ S APBY=$S(Y="":"N/A",1:Y) D LINE(1) S @SRG@(SRI)="    Applied By: "_APBY
"RTN","SRONRPT1",52,0)
 Q
"RTN","SRONRPT1",53,0)
SPACE(NUM) ; create spaces
"RTN","SRONRPT1",54,0)
 ;pass in position returns number of needed spaces
"RTN","SRONRPT1",55,0)
 I '$D(@SRG@(SRI)) S @SRG@(SRI)=""
"RTN","SRONRPT1",56,0)
 Q $J("",NUM-$L(@SRG@(SRI)))
"RTN","SRONRPT1",57,0)
LINE(NUM) ; create carriage returns
"RTN","SRONRPT1",58,0)
 I $G(SRLF) S NUM=NUM+1,SRLF=0
"RTN","SRONRPT1",59,0)
 F J=1:1:NUM S SRI=SRI+1,@SRG@(SRI)=""
"RTN","SRONRPT1",60,0)
 Q
"RTN","SRONRPT2")
0^79^B19811275
"RTN","SRONRPT2",1,0)
SRONRPT2 ;BIR/ADM - NURSE INTRAOP REPORT ; [ 09/08/03  2:47 PM ]
"RTN","SRONRPT2",2,0)
 ;;3.0; Surgery ;**100**;24 Jun 93
"RTN","SRONRPT2",3,0)
 ;
"RTN","SRONRPT2",4,0)
 ;** NOTICE: This routine is part of an implementation of a nationally
"RTN","SRONRPT2",5,0)
 ;**         controlled procedure.  Local modifications to this routine
"RTN","SRONRPT2",6,0)
 ;**         are prohibited.
"RTN","SRONRPT2",7,0)
 ;
"RTN","SRONRPT2",8,0)
 N BLOOD,COLOR,CONS,COUNTER,DRESS,INSTR,INTEG,MOOD,PACK,SHARP,SPONGE,URINE,VERIFY
"RTN","SRONRPT2",9,0)
 S SRLF=1,SRLINE="Irrigation Solution(s): " I '$O(^SRF(SRTN,26,0)),SRALL D LINE(1) S @SRG@(SRI)=SRLINE_"N/A"
"RTN","SRONRPT2",10,0)
 I $O(^SRF(SRTN,26,0)) D LINE(1) S @SRG@(SRI)=SRLINE D IRR
"RTN","SRONRPT2",11,0)
 S SRLF=1,SRLINE="Blood Replacement Fluids: " I '$O(^SRF(SRTN,4,0)),SRALL D LINE(1) S @SRG@(SRI)=SRLINE_"N/A"
"RTN","SRONRPT2",12,0)
 I $O(^SRF(SRTN,4,0)) D LINE(1) S @SRG@(SRI)=SRLINE D REP
"RTN","SRONRPT2",13,0)
 S SRLF=1,SR(25)=$G(^SRF(SRTN,25)),SPONGE=$P(SR(25),"^"),SHARP=$P(SR(25),"^",2),INSTR=$P(SR(25),"^",3)
"RTN","SRONRPT2",14,0)
 S Y=$P(SR(25),"^",5),C=$P(^DD(130,48,0),"^",2) D:Y'="" Y^DIQ S:Y="" Y="N/A" S VERIFY=Y
"RTN","SRONRPT2",15,0)
 S Y=SPONGE,C=$P(^DD(130,44,0),"^",2) D:Y'="" Y^DIQ S SPONGE=$S(Y'="":Y,VERIFY'="N/A":"* NOT ENTERED *",1:"N/A")
"RTN","SRONRPT2",16,0)
 S Y=SHARP,C=$P(^DD(130,45,0),"^",2) D:Y'="" Y^DIQ S SHARP=$S(Y'="":Y,VERIFY'="N/A":"* NOT ENTERED *",1:"N/A")
"RTN","SRONRPT2",17,0)
 S Y=INSTR,C=$P(^DD(130,46,0),"^",2) D:Y'="" Y^DIQ S INSTR=$S(Y'="":Y,VERIFY'="N/A":"* NOT ENTERED *",1:"N/A")
"RTN","SRONRPT2",18,0)
 S Y=$P(SR(25),"^",4),C=$P(^DD(130,47,0),"^",2) D:Y'="" Y^DIQ S COUNTER=$S(Y'="":Y,VERIFY'="N/A":"* NOT ENTERED *",1:"N/A")
"RTN","SRONRPT2",19,0)
 I 'SRALL,SPONGE="N/A" G SHARP
"RTN","SRONRPT2",20,0)
 D LINE(1) S @SRG@(SRI)="Sponge Count Correct:",@SRG@(SRI)=@SRG@(SRI)_$$SPACE(26)_SPONGE
"RTN","SRONRPT2",21,0)
SHARP I 'SRALL,SHARP="N/A" G INSTR
"RTN","SRONRPT2",22,0)
 D LINE(1) S @SRG@(SRI)="Sharps Count Correct:",@SRG@(SRI)=@SRG@(SRI)_$$SPACE(26)_SHARP
"RTN","SRONRPT2",23,0)
INSTR I 'SRALL,INSTR="N/A" G COUNT
"RTN","SRONRPT2",24,0)
 D LINE(1) S @SRG@(SRI)="Instrument Count Correct: "_INSTR
"RTN","SRONRPT2",25,0)
COUNT I 'SRALL,COUNTER="N/A" G CNTV
"RTN","SRONRPT2",26,0)
 D LINE(1) S @SRG@(SRI)="Counter:",@SRG@(SRI)=@SRG@(SRI)_$$SPACE(26)_COUNTER
"RTN","SRONRPT2",27,0)
CNTV I 'SRALL,VERIFY="N/A" G DRESS
"RTN","SRONRPT2",28,0)
 D LINE(1) S @SRG@(SRI)="Counts Verified By: ",@SRG@(SRI)=@SRG@(SRI)_$$SPACE(26)_VERIFY
"RTN","SRONRPT2",29,0)
DRESS S SRLF=1,SR(35)=$G(^SRF(SRTN,35)),DRESS=$P(SR(35),"^"),Y=$P(SR(.8),"^",11),C=$P(^DD(130,.875,0),"^",2) D:Y'="" Y^DIQ S PACK=$S(Y'="":Y,1:"N/A")
"RTN","SRONRPT2",30,0)
 S DRESS=$S(DRESS'="":DRESS,1:"N/A") I 'SRALL,DRESS="N/A" G PACK
"RTN","SRONRPT2",31,0)
 D LINE(1) S @SRG@(SRI)="Dressing: "_DRESS
"RTN","SRONRPT2",32,0)
PACK I 'SRALL,PACK="N/A" G LOSS
"RTN","SRONRPT2",33,0)
 D LINE(1) S @SRG@(SRI)="Packing:  "_PACK
"RTN","SRONRPT2",34,0)
LOSS S SRLF=1,BLOOD=$P(SR(.2),"^",5),URINE=$P(SR(.2),"^",16) I 'SRALL,BLOOD="",URINE="" G NEXT
"RTN","SRONRPT2",35,0)
 S BLOOD=$S(BLOOD="":"",1:BLOOD_" ml"),URINE=$S(URINE="":"",1:URINE_" ml") D LINE(1) S @SRG@(SRI)="Blood Loss: "_BLOOD,@SRG@(SRI)=@SRG@(SRI)_$$SPACE(40)_"Urine Output: "_URINE
"RTN","SRONRPT2",36,0)
NEXT D ^SRONRPT3
"RTN","SRONRPT2",37,0)
 Q
"RTN","SRONRPT2",38,0)
REP ; replacement fluids
"RTN","SRONRPT2",39,0)
 N FLUID,QTY,REP,SRCE,VID,SRCT
"RTN","SRONRPT2",40,0)
 S REP=0 F  S REP=$O(^SRF(SRTN,4,REP)) Q:'REP  D
"RTN","SRONRPT2",41,0)
 .S X=^SRF(SRTN,4,REP,0),FLUID=$P(^SRO(133.7,$P(X,"^"),0),"^"),QTY=$P(X,"^",2),SRCE=$P(X,"^",4),VID=$P(X,"^",5)
"RTN","SRONRPT2",42,0)
 .S:QTY="" QTY="N/A" S:SRCE="" SRCE="N/A" S:VID="" VID="N/A"
"RTN","SRONRPT2",43,0)
 .D LINE(1) S @SRG@(SRI)="  "_FLUID,@SRG@(SRI)=@SRG@(SRI)_$$SPACE(40)_"Quantity: "_QTY_" ml"
"RTN","SRONRPT2",44,0)
 .D LINE(1) S @SRG@(SRI)="    Source Identification: "_SRCE
"RTN","SRONRPT2",45,0)
 .D LINE(1) S @SRG@(SRI)="    VA Identification: "_VID
"RTN","SRONRPT2",46,0)
 .S (SRCT,SRLINE)=0 F  S SRLINE=$O(^SRF(SRTN,4,REP,1,SRLINE)) Q:'SRLINE  S SRCT=SRCT+1
"RTN","SRONRPT2",47,0)
 .Q:'SRCT  D LINE(1) S SRLINE=0,SRL=4,SRLINE=$O(^SRF(SRTN,4,REP,1,SRLINE)),X=^SRF(SRTN,4,REP,1,SRLINE,0)
"RTN","SRONRPT2",48,0)
 .I SRCT=1,$L(X)<67 S @SRG@(SRI)="    Comments: "_X Q
"RTN","SRONRPT2",49,0)
 .S @SRG@(SRI)="    Comments:" D COMM^SRONRPT3(X,SRL)
"RTN","SRONRPT2",50,0)
 .F  S SRLINE=$O(^SRF(SRTN,4,REP,1,SRLINE)) Q:'SRLINE  S X=^SRF(SRTN,4,REP,1,SRLINE,0) D COMM^SRONRPT3(X,SRL)
"RTN","SRONRPT2",51,0)
 Q
"RTN","SRONRPT2",52,0)
IRR ; irrigations
"RTN","SRONRPT2",53,0)
 N AMT,DOC,IRR,MM,SOLU,TIME,USED
"RTN","SRONRPT2",54,0)
 S IRR=0 F  S IRR=$O(^SRF(SRTN,26,IRR)) Q:'IRR  D
"RTN","SRONRPT2",55,0)
 .S X=^SRF(SRTN,26,IRR,0),SOLU=$P(^SRO(133.6,X,0),"^") D LINE(1) S @SRG@(SRI)="  "_SOLU
"RTN","SRONRPT2",56,0)
 .S USED=0 F  S USED=$O(^SRF(SRTN,26,IRR,1,USED)) Q:'USED  S MM=^SRF(SRTN,26,IRR,1,USED,0),Y=$P(MM,"^") D D^DIQ S TIME=$P(Y,"@")_"  "_$P(Y,"@",2) D
"RTN","SRONRPT2",57,0)
 ..D LINE(1) S @SRG@(SRI)="    Time Used: "_TIME S AMT=$P(MM,"^",2) S:AMT="" AMT="N/A"
"RTN","SRONRPT2",58,0)
 ..S Y=$P(MM,"^",3),C=$P(^DD(130.39,2,0),"^",2) D:Y'="" Y^DIQ,N(29) S:Y="" Y="N/A" S DOC=Y
"RTN","SRONRPT2",59,0)
 ..D LINE(1) S @SRG@(SRI)="      Amount: "_AMT,@SRG@(SRI)=@SRG@(SRI)_$$SPACE(40)_"Provider: "_DOC
"RTN","SRONRPT2",60,0)
 Q
"RTN","SRONRPT2",61,0)
N(SRL) N SRN I $L(Y)>SRL S SRN=$P(Y,",")_","_$E($P(Y,",",2))_".",Y=SRN
"RTN","SRONRPT2",62,0)
 Q
"RTN","SRONRPT2",63,0)
SPACE(NUM) ; create spaces
"RTN","SRONRPT2",64,0)
 ;pass in position returns number of needed spaces
"RTN","SRONRPT2",65,0)
 I '$D(@SRG@(SRI)) S @SRG@(SRI)=""
"RTN","SRONRPT2",66,0)
 Q $J("",NUM-$L(@SRG@(SRI)))
"RTN","SRONRPT2",67,0)
LINE(NUM) ; create carriage returns
"RTN","SRONRPT2",68,0)
 I $G(SRLF) S NUM=NUM+1,SRLF=0
"RTN","SRONRPT2",69,0)
 F J=1:1:NUM S SRI=SRI+1,@SRG@(SRI)=""
"RTN","SRONRPT2",70,0)
 Q
"RTN","SRONRPT3")
0^80^B22358940
"RTN","SRONRPT3",1,0)
SRONRPT3 ;BIR/ADM - NURSE INTRAOP REPORT ; [ 02/21/02  2:47 PM ]
"RTN","SRONRPT3",2,0)
 ;;3.0; Surgery ;**100**;24 Jun 93
"RTN","SRONRPT3",3,0)
 ;
"RTN","SRONRPT3",4,0)
 ;** NOTICE: This routine is part of an implementation of a nationally
"RTN","SRONRPT3",5,0)
 ;**         controlled procedure.  Local modifications to this routine
"RTN","SRONRPT3",6,0)
 ;**         are prohibited.
"RTN","SRONRPT3",7,0)
 ;
"RTN","SRONRPT3",8,0)
 S SRLF=1,MOOD=$P(SR(.8),"^"),CONS=$P(SR(.8),"^",10),INTEG=$P(SR(.7),"^",6),COLOR=$P(SR(.7),"^",7)
"RTN","SRONRPT3",9,0)
 S MOOD=$S(MOOD:$P(^SRO(135.3,MOOD,0),"^"),1:"N/A"),CONS=$S(CONS:$P(^SRO(135.4,CONS,0),"^"),1:"N/A"),INTEG=$S(INTEG:$P(^SRO(135.2,INTEG,0),"^"),1:"N/A")
"RTN","SRONRPT3",10,0)
 S Y=COLOR,C=$P(^DD(130,.77,0),"^",2) D:Y'="" Y^DIQ S COLOR=$S(Y="":"N/A",1:Y)
"RTN","SRONRPT3",11,0)
 I 'SRALL,MOOD="N/A" G CONS
"RTN","SRONRPT3",12,0)
 D LINE(1) S @SRG@(SRI)="Postoperative Mood:",@SRG@(SRI)=@SRG@(SRI)_$$SPACE(30)_MOOD
"RTN","SRONRPT3",13,0)
CONS I 'SRALL,CONS="N/A" G INTEG
"RTN","SRONRPT3",14,0)
 D LINE(1) S @SRG@(SRI)="Postoperative Consciousness:  "_CONS
"RTN","SRONRPT3",15,0)
INTEG I 'SRALL,INTEG="N/A" G COLOR
"RTN","SRONRPT3",16,0)
 D LINE(1) S @SRG@(SRI)="Postoperative Skin Integrity: "_INTEG
"RTN","SRONRPT3",17,0)
COLOR I 'SRALL,COLOR="N/A" G NEXT
"RTN","SRONRPT3",18,0)
 D LINE(1) S @SRG@(SRI)="Postoperative Skin Color:     "_COLOR
"RTN","SRONRPT3",19,0)
NEXT S SRLF=1,SRLINE="Laser Unit(s): " I '$O(^SRF(SRTN,44,0)),SRALL D LINE(1) S @SRG@(SRI)=SRLINE_"N/A"
"RTN","SRONRPT3",20,0)
 I $O(^SRF(SRTN,44,0)) D LINE(1) S @SRG@(SRI)=SRLINE D LASER
"RTN","SRONRPT3",21,0)
 S Y=$P(SR(.7),"^",3) I 'SRALL,Y="" G CS
"RTN","SRONRPT3",22,0)
 S Y=$S(Y="Y":"YES",Y="N":"NO",1:"N/A") D LINE(2) S @SRG@(SRI)="Sequential Compression Device: "_Y
"RTN","SRONRPT3",23,0)
CS S SRLF=1,SRLINE="Cell Saver(s): " I '$O(^SRF(SRTN,45,0)),SRALL D LINE(1) S @SRG@(SRI)=SRLINE_"N/A"
"RTN","SRONRPT3",24,0)
 I $O(^SRF(SRTN,45,0)) D LINE(1) S @SRG@(SRI)=SRLINE D SAVE
"RTN","SRONRPT3",25,0)
 S X=$P($G(^SRF(SRTN,46)),"^") S:X="" X="N/A" I 'SRALL,X="N/A" S SRLF=0 G NCC
"RTN","SRONRPT3",26,0)
 D LINE(2) S @SRG@(SRI)="Devices: "_X
"RTN","SRONRPT3",27,0)
NCC S SRLINE="Nursing Care Comments: " D LINE(2) S @SRG@(SRI)=SRLINE D
"RTN","SRONRPT3",28,0)
 .I '$O(^SRF(SRTN,7,0)) S @SRG@(SRI)=@SRG@(SRI)_"NO COMMENTS ENTERED" Q
"RTN","SRONRPT3",29,0)
 .S SRLINE=0 F  S SRLINE=$O(^SRF(SRTN,7,SRLINE)) Q:'SRLINE  S X=^SRF(SRTN,7,SRLINE,0) D COMM(X,2)
"RTN","SRONRPT3",30,0)
 Q
"RTN","SRONRPT3",31,0)
LASER ; laser units
"RTN","SRONRPT3",32,0)
 N C,DUR,ID,LAS,OP,PE,SRCT,WAT,X,Y
"RTN","SRONRPT3",33,0)
 S LAS=0 F  S LAS=$O(^SRF(SRTN,44,LAS)) Q:'LAS  D
"RTN","SRONRPT3",34,0)
 .S X=^SRF(SRTN,44,LAS,0),ID=$P(X,"^"),DUR=$P(X,"^",2),WAT=$P(X,"^",3),OP=$P(X,"^",4),PE=$P(X,"^",5)
"RTN","SRONRPT3",35,0)
 .D LINE(1) S @SRG@(SRI)="  "_ID,@SRG@(SRI)=@SRG@(SRI)_$$SPACE(40)_"Duration: "_$S(DUR'="":DUR_" min.",1:"N/A")
"RTN","SRONRPT3",36,0)
 .D LINE(1) S @SRG@(SRI)="    Wattage: "_$S(WAT'="":WAT,1:"N/A"),@SRG@(SRI)=@SRG@(SRI)_$$SPACE(40)_"Plume Evacuator: "_$S(PE="Y":"YES",PE="N":"NO",1:"N/A")
"RTN","SRONRPT3",37,0)
 .S Y=OP,C=$P(^DD(130.0129,3,0),"^",2) D:Y Y^DIQ S:Y="" Y="N/A" D LINE(1) S @SRG@(SRI)="    Operator: "_Y
"RTN","SRONRPT3",38,0)
 .S (SRCT,SRLINE)=0 F  S SRLINE=$O(^SRF(SRTN,44,LAS,1,SRLINE)) Q:'SRLINE  S SRCT=SRCT+1
"RTN","SRONRPT3",39,0)
 .Q:'SRCT  D LINE(1) S SRLINE=0,SRL=4,SRLINE=$O(^SRF(SRTN,44,LAS,1,SRLINE)),X=^SRF(SRTN,44,LAS,1,SRLINE,0)
"RTN","SRONRPT3",40,0)
 .I SRCT=1,$L(X)<67 S @SRG@(SRI)="    Comments: "_X Q
"RTN","SRONRPT3",41,0)
 .S @SRG@(SRI)="    Comments:" D COMM(X,SRL)
"RTN","SRONRPT3",42,0)
 .F  S SRLINE=$O(^SRF(SRTN,44,LAS,1,SRLINE)) Q:'SRLINE  S X=^SRF(SRTN,44,LAS,1,SRLINE,0) D COMM(X,SRL)
"RTN","SRONRPT3",43,0)
 Q
"RTN","SRONRPT3",44,0)
SAVE ; cell saver(s)
"RTN","SRONRPT3",45,0)
 N C,DISP,DNM,ID,INF,LOT,OP,SAL,SAV,SRCT,QTY,X,Y
"RTN","SRONRPT3",46,0)
 S SAV=0 F  S SAV=$O(^SRF(SRTN,45,SAV)) Q:'SAV  D
"RTN","SRONRPT3",47,0)
 .S X=^SRF(SRTN,45,SAV,0),ID=$P(X,"^"),SAL=$P(X,"^",3),INF=$P(X,"^",4),Y=$P(X,"^",2),C=$P(^DD(130.013,1,0),"^",2) D:Y Y^DIQ S OP=$S(Y'="":Y,1:"N/A")
"RTN","SRONRPT3",48,0)
 .D LINE(1) S @SRG@(SRI)="  "_ID,@SRG@(SRI)=@SRG@(SRI)_$$SPACE(40)_"Amount Salvaged:  "_$S(SAL:SAL_" ml",1:"N/A")
"RTN","SRONRPT3",49,0)
 .D LINE(1) S @SRG@(SRI)="    Operator:"_OP,@SRG@(SRI)=@SRG@(SRI)_$$SPACE(40)_"Amount Reinfused: "_$S(INF:INF_" ml",1:"N/A")
"RTN","SRONRPT3",50,0)
 .I $O(^SRF(SRTN,45,SAV,1,0)) D LINE(1) S @SRG@(SRI)="    Disposables:",DISP=0 F  S DISP=$O(^SRF(SRTN,45,SAV,1,DISP)) Q:'DISP  D
"RTN","SRONRPT3",51,0)
 ..S X=^SRF(SRTN,45,SAV,1,DISP,0),DNM=$P(X,"^"),LOT=$P(X,"^",2),QTY=$P(X,"^",3) D LINE(1) S @SRG@(SRI)="      "_DNM
"RTN","SRONRPT3",52,0)
 ..D LINE(1) S @SRG@(SRI)=$$SPACE(8)_"Lot: "_LOT,@SRG@(SRI)=@SRG@(SRI)_$$SPACE(40)_"Quantity: "_QTY
"RTN","SRONRPT3",53,0)
 .S (SRCT,SRLINE)=0 F  S SRLINE=$O(^SRF(SRTN,45,SAV,2,SRLINE)) Q:'SRLINE  S SRCT=SRCT+1
"RTN","SRONRPT3",54,0)
 .Q:'SRCT  D LINE(1) S SRLINE=0,SRL=4,SRLINE=$O(^SRF(SRTN,45,SAV,2,SRLINE)),X=^SRF(SRTN,45,SAV,2,SRLINE,0)
"RTN","SRONRPT3",55,0)
 .I SRCT=1,$L(X)<67 S @SRG@(SRI)="    Comments: "_X Q
"RTN","SRONRPT3",56,0)
 .S @SRG@(SRI)="    Comments:" D COMM(X,SRL)
"RTN","SRONRPT3",57,0)
 .F  S SRLINE=$O(^SRF(SRTN,45,SAV,2,SRLINE)) Q:'SRLINE  S X=^SRF(SRTN,45,SAV,2,SRLINE,0) D COMM(X,SRL)
"RTN","SRONRPT3",58,0)
 Q
"RTN","SRONRPT3",59,0)
N(SRL) N SRN I $L(Y)>SRL S SRN=$P(Y,",")_","_$E($P(Y,",",2))_".",Y=SRN
"RTN","SRONRPT3",60,0)
 Q
"RTN","SRONRPT3",61,0)
COMM(X,NUM) ; output text
"RTN","SRONRPT3",62,0)
 ; X = line of text to be processed
"RTN","SRONRPT3",63,0)
 ; NUM = left margin
"RTN","SRONRPT3",64,0)
 N I,J,K,Y,SRL S SRL=80-NUM
"RTN","SRONRPT3",65,0)
 I $L(X)<(SRL+1)!($E(X,1,SRL)'[" ") D LINE(1) S @SRG@(SRI)=$$SPACE(NUM)_X Q
"RTN","SRONRPT3",66,0)
 S K=1 F  D  I $L(X)<SRL+1 S X(K)=X Q
"RTN","SRONRPT3",67,0)
 .F I=0:1:SRL-1 S J=SRL-I,Y=$E(X,J) I Y=" " S X(K)=$E(X,1,J-1),X=$E(X,J+1,$L(X)) S K=K+1 Q
"RTN","SRONRPT3",68,0)
 F I=1:1:K D LINE(1) S @SRG@(SRI)=$$SPACE(NUM)_X(I)
"RTN","SRONRPT3",69,0)
 Q
"RTN","SRONRPT3",70,0)
SPACE(NUM) ; create spaces
"RTN","SRONRPT3",71,0)
 ;pass in position returns number of needed spaces
"RTN","SRONRPT3",72,0)
 I '$D(@SRG@(SRI)) S @SRG@(SRI)=""
"RTN","SRONRPT3",73,0)
 Q $J("",NUM-$L(@SRG@(SRI)))
"RTN","SRONRPT3",74,0)
LINE(NUM) ; create carriage returns
"RTN","SRONRPT3",75,0)
 I $G(SRLF) S NUM=NUM+1,SRLF=0
"RTN","SRONRPT3",76,0)
 F J=1:1:NUM S SRI=SRI+1,@SRG@(SRI)=""
"RTN","SRONRPT3",77,0)
 Q
"RTN","SROPDEL")
0^81^B13352187
"RTN","SROPDEL",1,0)
SROPDEL ;B'HAM ISC/MAM - DELETE CASE ; [ 02/11/04  8:42 AM ]
"RTN","SROPDEL",2,0)
 ;;3.0; Surgery ;**67,100**;24 Jun 93
"RTN","SROPDEL",3,0)
DEL W !!,"Are you sure that you want to delete this case ?  NO//  " R SRYN:DTIME I '$T!(SRYN["^") S SRSOUT=1 Q
"RTN","SROPDEL",4,0)
 S:SRYN="" SRYN="N" S SRYN=$E(SRYN)
"RTN","SROPDEL",5,0)
 I "YyNn"'[SRYN W !!,"Enter 'YES' to delete this surgical case from your records.  If you have",!,"selected this option inadvertantly and do not want to remove this case,",!,"enter RETURN or 'NO'." G DEL
"RTN","SROPDEL",6,0)
 I "Yy"'[SRYN S SRSOUT=1 Q
"RTN","SROPDEL",7,0)
 S SRCC="",SROPCOM="Operation..."
"RTN","SROPDEL",8,0)
 I $P($G(^SRF(SRTN,.2)),"^",12)'="" W !!,"This case has been completed and must remain in the file for your records." D RET Q
"RTN","SROPDEL",9,0)
 I $D(^SRF(SRTN,"LOCK")),^("LOCK")=1 W !!,"This case has been verified and locked.  It cannot be deleted unless unlocked",!,"by your Chief of Surgery, or someone appointed by him." D RET Q
"RTN","SROPDEL",10,0)
 I $P($G(^SRF(SRTN,30)),"^") S SROPCAN=1
"RTN","SROPDEL",11,0)
 I $P($G(^SRF(SRTN,31)),"^",8)'="" S SROPCAN=1
"RTN","SROPDEL",12,0)
 I $D(SROPCAN) W !!,"This case has been cancelled and must remain in the file for your records." D RET Q
"RTN","SROPDEL",13,0)
 I $P($G(^SRF(SRTN,31)),"^",4) W !!,"You cannot delete a procedure that has already been scheduled.  If you",!,"would like to cancel this procedure, use the option 'Cancel Scheduled ",!,"Operation'." D RET Q
"RTN","SROPDEL",14,0)
 S Y=$G(^SRF(SRTN,"TIU")) I $P(Y,"^")!$P(Y,"^",2)!$P(Y,"^",4) W !!,"You cannot delete a procedure that has one or more operative documents." D RET Q
"RTN","SROPDEL",15,0)
KILL ; delete entry
"RTN","SROPDEL",16,0)
 Q:'$$LOCK^SROUTL(SRTN)
"RTN","SROPDEL",17,0)
 S SRCONC=$P($G(^SRF(SRTN,"CON")),"^") I SRCONC K ^SRF(SRCONC,"CON")
"RTN","SROPDEL",18,0)
 D DEL^SROERR
"RTN","SROPDEL",19,0)
 W !!,"  Deleting "_SRCC_SROPCOM I $P($G(^SRF(SRTN,.2)),"^",10) S DIE=130,DA=SRTN,DR=".205///@" D ^DIE K DA
"RTN","SROPDEL",20,0)
 S (DA,SRTN1)=SRTN,DIK="^SRF(" D ^DIK,UNLOCK^SROUTL(SRTN) K SRTN
"RTN","SROPDEL",21,0)
 I SRCONC D UNLOCK^SROUTL(SRCONC),CON I SRCONC D KILL
"RTN","SROPDEL",22,0)
 Q
"RTN","SROPDEL",23,0)
CON ; delete concurrent case ?
"RTN","SROPDEL",24,0)
 S SRTN=SRCONC W !!,"There is a concurrent procedure associated with this case.  Do you want to",!,"delete it also ?  YES//  " R SRYN:DTIME I '$T!(SRYN["^") S SRCONC=0 Q
"RTN","SROPDEL",25,0)
 S SRYN=$E(SRYN) S:SRYN="" SRYN="Y"
"RTN","SROPDEL",26,0)
 I "YyNn"'[SRYN W !!,"Enter RETURN to delete this concurrent case.  If you are not sure whether to",!,"delete the other case, enter 'NO'.  It can be removed later if necessary." G CON
"RTN","SROPDEL",27,0)
 I "Nn"[SRYN S SRCONC=0
"RTN","SROPDEL",28,0)
 Q
"RTN","SROPDEL",29,0)
RET W !!,"Press RETURN to continue  " R X:DTIME K SRTN
"RTN","SROPDEL",30,0)
 Q
"RTN","SROPER")
0^82^B12586025
"RTN","SROPER",1,0)
SROPER ;B'HAM ISC/MAM - SELECT OPERATION ; [ 01/30/01  1:26 PM ]
"RTN","SROPER",2,0)
 ;;3.0; Surgery ;**37,107,100**;24 Jun 93
"RTN","SROPER",3,0)
 ;
"RTN","SROPER",4,0)
 ; Reference to ^TMP("CSLSUR1" supported by DBIA #3498
"RTN","SROPER",5,0)
 ;
"RTN","SROPER",6,0)
NEW ; enter a new surgery
"RTN","SROPER",7,0)
 S %DT("A")="Select the Date of Operation: ",%DT="AEX" D ^%DT I Y<0 W !!,"When entering a new surgery case, a date MUST be entered.  If you do not",!,"know the date of operation, enter this patient on the Waiting List." W !!!
"RTN","SROPER",8,0)
 I Y<0 D CONT G:"Yy"'[SRYN END G NEW
"RTN","SROPER",9,0)
 G:Y'>0 END S SRSDATE=Y
"RTN","SROPER",10,0)
 S SRSC1=1 K SRCTN S SRSDPT=DFN,SRSCC="" D CONCUR^SRSREQ G:SRSCC="^" END
"RTN","SROPER",11,0)
OPER D ^SROPROC I SRSOUT G END
"RTN","SROPER",12,0)
 S SRPRIN=SRSOP K SRSOP
"RTN","SROPER",13,0)
 G:Y'>0 END S SRSDATE=Y
"RTN","SROPER",14,0)
 K DA,DIC,DO,DD,DINUM,SRTN S X=DFN,DIC="^SRF(",DIC(0)="L",DLAYGO=130 D FILE^DICN K DIC,DLAYGO S SRTN=+Y
"RTN","SROPER",15,0)
 N SRLCK S SRLCK=$$LOCK^SROUTL(SRTN) I 'SRLCK Q
"RTN","SROPER",16,0)
 K DIE,DR S DA=SRTN,DIE=130,DR=".09///"_SRSDATE_";26///"_SRPRIN_";68///"_SRPRIN D ^DIE K DR
"RTN","SROPER",17,0)
 K DR,DA S DR="[SRO-NOCOMP]",DA=SRTN,DIE=130 D ^DIE K DR
"RTN","SROPER",18,0)
 S ^SRF(SRTN,8)=SRSITE("DIV") D ^SROXRET
"RTN","SROPER",19,0)
 D ^SROBLOD K DR,DIE,DA S DR="38////"_BLOOD_";40////"_CROSSM,DA=SRTN,DIE=130 D ^DIE K DR,DA,DIE
"RTN","SROPER",20,0)
 S DR="[SRSRES1]",DIE=130,DA=SRTN D ^DIE D RT S SPD=$$CHKS^SRSCOR(SRTN),ST="" D EN2^SROVAR K DR S DR="[SRSRES-ENTRY]",DIE=130,DA=SRTN D ^SRCUSS I SPD'=$$CHKS^SRSCOR(SRTN) S ^TMP("CSLSUR1",$J)=""
"RTN","SROPER",21,0)
 I $D(SRCTN) S DIE=130,DR="35////"_SRCTN,DA=SRTN D ^DIE S SROERR=SRTN D ^SROERR0 S DR="35////"_SRTN,DA=SRCTN,DIE=130 D ^DIE S SROERR=SRCTN D ^SROERR0
"RTN","SROPER",22,0)
 D UNLOCK^SROUTL(SRTN)
"RTN","SROPER",23,0)
 Q
"RTN","SROPER",24,0)
END D ^SRSKILL
"RTN","SROPER",25,0)
 Q
"RTN","SROPER",26,0)
SEL ; select case
"RTN","SROPER",27,0)
 W !!!,"Select Operation, or enter RETURN to continue listing Procedures: " R X:DTIME W @IOF I '$T!(X["^") S SRSOUT=1 Q
"RTN","SROPER",28,0)
 I X="" Q
"RTN","SROPER",29,0)
 I '$D(SRCASE(X)) W !!,"Please enter the number corresponding to the Surgical Case you want to edit.",!,"If the case desired does not appear, enter RETURN to continue listing",!,"additional cases."
"RTN","SROPER",30,0)
 I '$D(SRCASE(X)) W !!,"Press RETURN to continue  " R X:DTIME S:'$T SRSOUT=1 S SRBACK=1 Q
"RTN","SROPER",31,0)
 S SRTN=+SRCASE(X)
"RTN","SROPER",32,0)
 Q
"RTN","SROPER",33,0)
CONT ; continue new entry ?
"RTN","SROPER",34,0)
 W !!,"Do you want to continue  ?  YES//  " R SRYN:DTIME I '$T S SRYN="N" Q
"RTN","SROPER",35,0)
 S SRYN=$E(SRYN) S:SRYN="" SRYN="Y" I "YyNn"'[SRYN W !!,"Enter RETURN if you want to re-enter a date and continue creating a new",!,"case, or 'NO' to leave this option." G CONT
"RTN","SROPER",36,0)
 Q
"RTN","SROPER",37,0)
RT ; start RT logging
"RTN","SROPER",38,0)
 I $D(XRTL) S XRTN="SROPER" D T0^%ZOSV
"RTN","SROPER",39,0)
 Q
"RTN","SROPR01")
1^130
"RTN","SROPR02")
1^131
"RTN","SROPR03")
1^132
"RTN","SROPRPT")
0^83^B3517379
"RTN","SROPRPT",1,0)
SROPRPT ;B'HAM ISC/MAM,ADM - OPERATION REPORT ; [ 02/18/04  1:40 PM ]
"RTN","SROPRPT",2,0)
 ;;3.0; Surgery ;**63,66,96,100**;24 Jun 93
"RTN","SROPRPT",3,0)
 ;
"RTN","SROPRPT",4,0)
 ;** NOTICE: This routine is part of an implementation of a nationally
"RTN","SROPRPT",5,0)
 ;**         controlled procedure.  Local modifications to this routine
"RTN","SROPRPT",6,0)
 ;**         are prohibited.
"RTN","SROPRPT",7,0)
 ;
"RTN","SROPRPT",8,0)
 I '$D(SRSITE) D ^SROVAR G:'$D(SRSITE) END S SRSITE("KILL")=1
"RTN","SROPRPT",9,0)
 I '$D(SRTN) D ^SROPS G:'$D(SRTN) END S SRTN("KILL")=1
"RTN","SROPRPT",10,0)
 ;Variable MAGTMPR2 is being set by routine MAGGTRPT (IMAGING Package).
"RTN","SROPRPT",11,0)
 I '$D(MAGTMPR2) D HOME^%ZIS
"RTN","SROPRPT",12,0)
IM N SRSINED,SRSTAT,SRDTITL,SRTIU
"RTN","SROPRPT",13,0)
 S SRDTITL="Operation Report"
"RTN","SROPRPT",14,0)
 S SRSINED=0,SRSTAT="",SRTIU=$P($G(^SRF(SRTN,"TIU")),"^")
"RTN","SROPRPT",15,0)
 I SRTIU S SRSTAT=$$STATUS^SROESUTL(SRTIU) S:SRSTAT=7 SRSINED=1
"RTN","SROPRPT",16,0)
 ;Code for Imaging ; SRR 5/22/94
"RTN","SROPRPT",17,0)
 I IOST["C-IMPC",$D(^SRF(SRTN,2005)) S SRIMAGE=1
"RTN","SROPRPT",18,0)
 I IOST["P-" D DISPLY,END Q  ; WISC/GEK - DELPHI APP
"RTN","SROPRPT",19,0)
 ;End Code for Imaging.
"RTN","SROPRPT",20,0)
 D DISPLY,END
"RTN","SROPRPT",21,0)
 Q
"RTN","SROPRPT",22,0)
DISPLY I SRSINED S SRTIU=$P($G(^SRF(SRTN,"TIU")),"^") I SRTIU D PRNT^SROESPR(SRTN,SRTIU,SRDTITL) Q
"RTN","SROPRPT",23,0)
 I 'SRSINED W !!," * * The Operation Report for this case is not yet available. * *" D LAST
"RTN","SROPRPT",24,0)
 Q
"RTN","SROPRPT",25,0)
END K ^TMP("SROP",$J)
"RTN","SROPRPT",26,0)
 W @IOF I $D(ZTQUEUED) Q:$G(ZTSTOP)  S ZTREQ="@" Q
"RTN","SROPRPT",27,0)
 D ^SRSKILL K VAIN,VAINDT I $D(SRSITE("KILL")) K SRSITE
"RTN","SROPRPT",28,0)
 I $D(SRTN("KILL")) K SRTN
"RTN","SROPRPT",29,0)
 Q
"RTN","SROPRPT",30,0)
LAST W ! K DIR S DIR(0)="E" D ^DIR K DIR
"RTN","SROPRPT",31,0)
 Q
"RTN","SROPRPT",32,0)
CODE ; entry point from coding menu
"RTN","SROPRPT",33,0)
 N SRSINED,SRSTAT,SRDTITL,SRTIU
"RTN","SROPRPT",34,0)
 S SRDTITL="Operation Report"
"RTN","SROPRPT",35,0)
 S SRSINED=0,SRSTAT="",SRTIU=$P($G(^SRF(SRTN,"TIU")),"^")
"RTN","SROPRPT",36,0)
 I SRTIU S SRSTAT=$$STATUS^SROESUTL(SRTIU) S:SRSTAT=7 SRSINED=1
"RTN","SROPRPT",37,0)
 D DISPLY,END
"RTN","SROPRPT",38,0)
 Q
"RTN","SROPRPT1")
1^134
"RTN","SROPRPT2")
1^135
"RTN","SROPRPT3")
1^136
"RTN","SROPRPT4")
1^137
"RTN","SROPS1")
0^118^B14216513
"RTN","SROPS1",1,0)
SROPS1 ;BIR/ADM - SELECT CASE (INCLUDING NON-OR) ; [ 06/13/01  3:07 PM ]
"RTN","SROPS1",2,0)
 ;;3.0; Surgery ;**100**;24 Jun 93
"RTN","SROPS1",3,0)
 ;
"RTN","SROPS1",4,0)
 ;** NOTICE: This routine is part of an implementation of a nationally
"RTN","SROPS1",5,0)
 ;**         controlled procedure.  Local modifications to this routine
"RTN","SROPS1",6,0)
 ;**         are prohibited.
"RTN","SROPS1",7,0)
 ;
"RTN","SROPS1",8,0)
 W ! S SRSOUT=0 K DIC S DIC("A")="Select Patient: ",DIC=2,DIC(0)="QEAM" D ^DIC K DIC I Y<0 S SRSOUT=1 G END
"RTN","SROPS1",9,0)
 S DFN=+Y D DEM^VADPT D HDR
"RTN","SROPS1",10,0)
ADT S (SRDT,CNT,SRBACK)=0 F  S SRDT=$O(^SRF("ADT",DFN,SRDT)) Q:'SRDT!SRSOUT!$D(SRTN)!SRBACK  S SROP=0 F  S SROP=$O(^SRF("ADT",DFN,SRDT,SROP)) Q:'SROP!$D(SRTN)!SRSOUT!SRBACK  D LIST
"RTN","SROPS1",11,0)
 G:SRBACK ADT Q:$D(SRTN)
"RTN","SROPS1",12,0)
 I '$D(SRCASE(1)) W !!,"There are no cases entered for "_VADM(1)_".",!!,"Press RETURN to continue  " R X:DTIME G END
"RTN","SROPS1",13,0)
OPT S SRSOUT=0 W !!,"Select Case: " R X:DTIME I '$T!("^"[X) S SRSOUT=1 G END
"RTN","SROPS1",14,0)
 I '$D(SRCASE(X)) W !!,"Enter the number of the desired operation." G OPT
"RTN","SROPS1",15,0)
 S SRTN=+SRCASE(X)
"RTN","SROPS1",16,0)
 Q
"RTN","SROPS1",17,0)
END D ^SRSKILL K SRTN W @IOF
"RTN","SROPS1",18,0)
 Q
"RTN","SROPS1",19,0)
LIST ; list cases
"RTN","SROPS1",20,0)
 S SRNON=0 I $P($G(^SRF(SROP,"NON")),"^")="Y" S SRNON=1
"RTN","SROPS1",21,0)
 I 'SRNON,'$P($G(^SRF(SROP,.2)),"^",10) Q
"RTN","SROPS1",22,0)
 I $D(^SRF(SROP,37)),$P(^(37),"^") Q
"RTN","SROPS1",23,0)
 I $Y+5>IOSL S SRBACK=0 D SEL Q:$D(SRTN)!(SRSOUT)  D HDR Q:SRBACK
"RTN","SROPS1",24,0)
 S CNT=CNT+1,SRSDATE=$P(^SRF(SROP,0),"^",9) W !,CNT_". "
"RTN","SROPS1",25,0)
CASE W $E(SRSDATE,4,5)_"-"_$E(SRSDATE,6,7)_"-"_$E(SRSDATE,2,3)
"RTN","SROPS1",26,0)
 S SROPER=$P(^SRF(SROP,"OP"),"^") I $O(^SRF(SROP,13,0)) S SROTHER=0 F I=0:0 S SROTHER=$O(^SRF(SROP,13,SROTHER)) Q:'SROTHER  D OTHER
"RTN","SROPS1",27,0)
 I SRNON S SROPER=SROPER_" (NON-OR PROCEDURE)"
"RTN","SROPS1",28,0)
 D:'SRNON ^SROP1 D LOCK K SROPS,MM,MMM S:$L(SROPER)<65 SROPS(1)=SROPER I $L(SROPER)>64 S SROPER=SROPER_"  " F M=1:1 D LOOP Q:MMM=""
"RTN","SROPS1",29,0)
 W ?14,SROPS(1) I $D(SROPS(2)) W !,?14,SROPS(2) I $D(SROPS(3)) W !,?14,SROPS(3) W:$D(SROPS(4)) !,?14,SROPS(4)
"RTN","SROPS1",30,0)
 W ! S SRCASE(CNT)=SROP_"^"_SRDT
"RTN","SROPS1",31,0)
 Q
"RTN","SROPS1",32,0)
SEL ; select case
"RTN","SROPS1",33,0)
 W ! K DIR S DIR("A")="Select case or enter RETURN to continue listing cases: ",DIR(0)="FOA" D ^DIR K DIR I $D(DTOUT)!$D(DUOUT) S SRSOUT=1 Q
"RTN","SROPS1",34,0)
 I X="" Q
"RTN","SROPS1",35,0)
 I '$D(SRCASE(X)) W ! S DIR("A",1)="Please enter the number corresponding to the case you want to edit.",DIR("A",2)="If the case desired does not appear, enter RETURN to continue listing",DIR("A",3)="additional cases."
"RTN","SROPS1",36,0)
 I '$D(SRCASE(X)) S DIR("A",4)="",DIR("A")="Press RETURN to continue  " D ^DIR K DIR S:$D(DTOUT)!$D(DUOUT) SRSOUT=1 S SRBACK=1 Q
"RTN","SROPS1",37,0)
 S SRTN=+SRCASE(X)
"RTN","SROPS1",38,0)
 Q
"RTN","SROPS1",39,0)
LOCK ; case locked?
"RTN","SROPS1",40,0)
 I $D(SRTN),$P($G(^SRF(SRTN,"LOCK")),"^") S SROPER=SROPER_" **LOCKED**"
"RTN","SROPS1",41,0)
 Q
"RTN","SROPS1",42,0)
OTHER ; other operations
"RTN","SROPS1",43,0)
 S SRLONG=1 I $L(SROPER)+$L($P(^SRF(SROP,13,SROTHER,0),"^"))>235 S SRLONG=0,SROTHER=999,SROPERS=" ..."
"RTN","SROPS1",44,0)
 I SRLONG S SROPERS=$P(^SRF(SROP,13,SROTHER,0),"^")
"RTN","SROPS1",45,0)
 S SROPER=SROPER_$S(SROPERS=" ...":SROPERS,1:", "_SROPERS)
"RTN","SROPS1",46,0)
 Q
"RTN","SROPS1",47,0)
LOOP ; break procedure
"RTN","SROPS1",48,0)
 S SROPS(M)="" F LOOP=1:1 S MM=$P(SROPER," "),MMM=$P(SROPER," ",2,200) Q:MMM=""  Q:$L(SROPS(M))+$L(MM)'<65  S SROPS(M)=SROPS(M)_MM_" ",SROPER=MMM
"RTN","SROPS1",49,0)
 Q
"RTN","SROPS1",50,0)
HDR ; print heading
"RTN","SROPS1",51,0)
 W @IOF,!,?1,VADM(1)_"   "_VA("PID") S X=$P($G(VADM(6)),"^") W:X "        * DIED "_$E(X,4,5)_"/"_$E(X,6,7)_"/"_$E(X,2,3)_" *" W !
"RTN","SROPS1",52,0)
 Q
"RTN","SROREST")
0^84^B12673663
"RTN","SROREST",1,0)
SROREST ;B'HAM ISC/MAM - STUFF RESTRAINTS; [ 01/30/01  1:13 AM ]
"RTN","SROREST",2,0)
 ;;3.0; Surgery ;**94,100**;24 Jun 93
"RTN","SROREST",3,0)
 N SRLCK S SRSOUT=0 I '$D(SRTN) W !!,"A surgical case has not been entered.  " G END
"RTN","SROREST",4,0)
 D ^SROLOCK I SROLOCK S SRSOUT=1 G END
"RTN","SROREST",5,0)
ASK W @IOF,!,"Enter/Edit Irrigations or Restraints and Positioning Aids:",!!,"1. Irrigations",!,"2. Restraints and Positioning Aids",!!,"Select Number: " R X:DTIME I '$T!("^^"[X) S SRSOUT=1 G END
"RTN","SROREST",6,0)
 I X'=1&(X'=2) S X="?"
"RTN","SROREST",7,0)
 I X["?" W !!,"Type '1' to enter irrigation solutions, or '2' to enter restraints",!,"or positioning aids.",!!,"Press RETURN to continue  " R X:DTIME G ASK
"RTN","SROREST",8,0)
 S SRLCK=$$LOCK^SROUTL(SRTN) I '$G(SRLCK) G ASK
"RTN","SROREST",9,0)
 I X=1 G ^SROIRR
"RTN","SROREST",10,0)
LIST ;
"RTN","SROREST",11,0)
 K SREST S (CNT,SREST)=0 F  S SREST=$O(^SRO(132.05,SREST)) Q:'SREST  S INACT=$P(^SRO(132.05,SREST,0),"^",2) I 'INACT S CNT=CNT+1,SREST(CNT)=SREST_"^"_$P(^SRO(132.05,SREST,0),"^")
"RTN","SROREST",12,0)
 N SRD,SRI,SRFIRST,SRJ,SRLAST,SRP,SRP1,SRQ,SRTOT S SRD=36,SRTOT=CNT,SRP1=CNT/SRD,SRP=$P(SRP1,".") I SRP1>SRP S SRP=SRP+1
"RTN","SROREST",13,0)
 S (CNT,SRLAST)=0 F SRPAGE=1:1:SRP S SRNUM=$S(SRTOT>SRD:"Page "_SRPAGE_" of "_SRP,1:""),SRFIRST=SRLAST+1,SRLAST=$S(SRLAST+SRD<SRTOT:SRLAST+SRD,1:SRTOT) D PAGE Q:SRSOUT
"RTN","SROREST",14,0)
END D ^SRSKILL D:$G(SRLCK) UNLOCK^SROUTL(SRTN) W @IOF
"RTN","SROREST",15,0)
 Q
"RTN","SROREST",16,0)
PAGE Q:SRSOUT  W @IOF,!,?20,"Restraints and Positioning Aids",?(79-$L(SRNUM)),SRNUM,! F I=1:1:80 W "="
"RTN","SROREST",17,0)
 F CNT=SRFIRST:1:SRLAST S S=SREST(CNT) W:CNT#2 !,$J(CNT,2)_". "_$P(SREST(CNT),"^",2) W:'(CNT#2) ?40,$J(CNT,2)_". "_$P(SREST(CNT),"^",2)
"RTN","SROREST",18,0)
 W ! F LINE=1:1:80 W "-"
"RTN","SROREST",19,0)
SEL W ! K DIR S DIR("?",1)=" Enter the numbers corresponding to your choices, separated by a comma (,).",DIR("?")=" For example, if selecting items 1, 4 and 7, you would enter '1,4,7'."
"RTN","SROREST",20,0)
 S DIR("A")="Select the number(s) corresponding to your choice: ",DIR(0)="FAO" D ^DIR K DIR I $D(DTOUT)!$D(DUOUT) S SRSOUT=1 Q
"RTN","SROREST",21,0)
 S SRX=Y I Y="" Q
"RTN","SROREST",22,0)
 S:'$D(^SRF(SRTN,20,0)) ^SRF(SRTN,20,0)="^130.31PA^0^0"
"RTN","SROREST",23,0)
 S SRQ=0 F SRCNT=1:1 S SRI=$P(SRX,",",SRCNT) Q:SRI=""!SRQ  I '$D(SREST(SRI)) W !!,SRI_" is an invalid entry.  Please try again." S SRQ=1
"RTN","SROREST",24,0)
 I SRQ D RET S:$D(DTOUT)!$D(DUOUT) SRSOUT=1 G PAGE
"RTN","SROREST",25,0)
 F SRCNT=1:1 S SRI=$P(SRX,",",SRCNT) Q:SRI=""  D STUFF
"RTN","SROREST",26,0)
 D RET I $D(DTOUT)!$D(DUOUT) S SRSOUT=1
"RTN","SROREST",27,0)
 Q
"RTN","SROREST",28,0)
STUFF ; stuff restraints in Surgery file
"RTN","SROREST",29,0)
 I $D(SREST(SRI)) S SREST=+SREST(SRI),SREST1=$P(SREST(SRI),"^",2) W !!,"Entering "_SREST1_" ..." K DR S DIE=130,DA=SRTN,DR=".13///"_SREST1,DR(2,130.31)=.01 D ^DIE K DR
"RTN","SROREST",30,0)
 Q
"RTN","SROREST",31,0)
RET W ! K DIR S DIR(0)="FOA",DIR("A")="Press RETURN to continue  " D ^DIR
"RTN","SROREST",32,0)
 Q
"RTN","SROSRPT")
0^85^B6149981
"RTN","SROSRPT",1,0)
SROSRPT ;BIR/ADM - OPERATION REPORT ; [ 10/06/03  2:45 PM ]
"RTN","SROSRPT",2,0)
 ;;3.0; Surgery ;**100**;24 Jun 93
"RTN","SROSRPT",3,0)
 ;
"RTN","SROSRPT",4,0)
 ;** NOTICE: This routine is part of an implementation of a nationally
"RTN","SROSRPT",5,0)
 ;**         controlled procedure.  Local modifications to this routine
"RTN","SROSRPT",6,0)
 ;**         are prohibited.
"RTN","SROSRPT",7,0)
 ;
"RTN","SROSRPT",8,0)
 ; Reference to EXTRACT^TIULQ supported by DBIA #2693
"RTN","SROSRPT",9,0)
 ;
"RTN","SROSRPT",10,0)
 Q
"RTN","SROSRPT",11,0)
OPTOP(SRTN,SRLAST,SRG) ; send op-top to ^TMP
"RTN","SROSRPT",12,0)
 ; SRTN   - case number in file 130
"RTN","SROSRPT",13,0)
 ; SRLAST - (optional)
"RTN","SROSRPT",14,0)
 ;          0 or null : include summary status at end
"RTN","SROSRPT",15,0)
 ;          1 : omit summary status at end
"RTN","SROSRPT",16,0)
 ;          2 : include summary status at end plus summary in TIU
"RTN","SROSRPT",17,0)
 ; SRG    - (optional) return array
"RTN","SROSRPT",18,0)
 ;
"RTN","SROSRPT",19,0)
 Q:'$D(SROVP)
"RTN","SROSRPT",20,0)
 N J,LOOP,SR,SRALL,SRCASE,SRERR,SRI,SRLF,SRSTAT,SRT,SRTIU
"RTN","SROSRPT",21,0)
 S SRTIU=$P($G(^SRF(SRTN,"TIU")),"^") Q:'SRTIU
"RTN","SROSRPT",22,0)
 D STATUS Q:SRSTAT>1
"RTN","SROSRPT",23,0)
 S SRCASE=SRTN S:'$L($G(SRG)) SRG=$NA(^TMP("SROP",$J,SRCASE)) K @SRG
"RTN","SROSRPT",24,0)
 S SRI=0,SRLAST=$S($G(SRLAST):SRLAST,1:1),@SRG@(SRI)=3
"RTN","SROSRPT",25,0)
 I $P($G(^SRF(SRTN,30)),"^")!$P($G(^SRF(SRTN,31)),"^",8) D LINE(1) S @SRG@(SRI)="  * * OPERATION ABORTED * *" D LINE(1)
"RTN","SROSRPT",26,0)
 S SR(0)=^SRF(SRTN,0)
"RTN","SROSRPT",27,0)
 D PRIN I $O(^SRF(SRTN,13,0)) D OTHER
"RTN","SROSRPT",28,0)
 Q
"RTN","SROSRPT",29,0)
STATUS ; check status of TIU document
"RTN","SROSRPT",30,0)
 D EXTRACT^TIULQ(SRTIU,"SRT",.SRERR,".05") S SRSTAT=SRT(SRTIU,.05,"I")
"RTN","SROSRPT",31,0)
 Q
"RTN","SROSRPT",32,0)
PRIN ; print principal procedure information
"RTN","SROSRPT",33,0)
 N I,M,MM,MMM,SRJ,SROPER,SROPS
"RTN","SROSRPT",34,0)
 D LINE(1) S @SRG@(SRI)="Procedure(s) Performed:"
"RTN","SROSRPT",35,0)
PRIN2 S SROPER=$P(^SRF(SRTN,"OP"),"^")
"RTN","SROSRPT",36,0)
 I $P($G(^SRF(SRTN,30)),"^")&$P($G(^SRF(SRTN,.2)),"^",10) S SROPER="** ABORTED ** "_SROPER
"RTN","SROSRPT",37,0)
 K SROPS,MM,MMM S:$L(SROPER)<70 SROPS(1)=SROPER I $L(SROPER)>69 S SROPER=SROPER_"  " F M=1:1 D LOOP Q:MMM=""
"RTN","SROSRPT",38,0)
 F I=1:1 Q:'$D(SROPS(I))  D LINE(1) S @SRG@(SRI)=$S(I=1:" Principal: ",1:"         ")_SROPS(I)
"RTN","SROSRPT",39,0)
 Q
"RTN","SROSRPT",40,0)
OTHER ; other procedures
"RTN","SROSRPT",41,0)
 N CNT,OTH,OTHER
"RTN","SROSRPT",42,0)
 S (OTH,CNT)=0 F  S OTH=$O(^SRF(SRTN,13,OTH)) Q:'OTH  S CNT=CNT+1 D OTH
"RTN","SROSRPT",43,0)
 Q
"RTN","SROSRPT",44,0)
OTH S OTHER=$P(^SRF(SRTN,13,OTH,0),"^")
"RTN","SROSRPT",45,0)
 D LINE(1) S @SRG@(SRI)="     Other: "_OTHER
"RTN","SROSRPT",46,0)
 Q
"RTN","SROSRPT",47,0)
LOOP ; break procedure if greater than 70 characters
"RTN","SROSRPT",48,0)
 S SROPS(M)="" F LOOP=1:1 S MM=$P(SROPER," "),MMM=$P(SROPER," ",2,200) Q:MMM=""  Q:$L(SROPS(M))+$L(MM)'<70  S SROPS(M)=SROPS(M)_MM_" ",SROPER=MMM
"RTN","SROSRPT",49,0)
 Q
"RTN","SROSRPT",50,0)
LINE(NUM) ;create carriage returns
"RTN","SROSRPT",51,0)
 I $G(SRLF) S NUM=NUM+1,SRLF=0
"RTN","SROSRPT",52,0)
 F J=1:1:NUM S SRI=SRI+1,@SRG@(SRI)=" "
"RTN","SROSRPT",53,0)
 Q
"RTN","SROSRPT0")
1^86
"RTN","SROSRPT1")
1^119
"RTN","SROSRPT2")
1^122
"RTN","SROTIUD")
0^123^B4241608
"RTN","SROTIUD",1,0)
SROTIUD ;BIR/SJA - SURGERY E-SIG UTILITY ; [ 12/19/03  09:27 AM ]
"RTN","SROTIUD",2,0)
 ;;3.0; Surgery ;**100**;24 Jun 93
"RTN","SROTIUD",3,0)
 ;
"RTN","SROTIUD",4,0)
OS(SRTN) ; Delete the TIU OPERATIVE SUMMARY pointer and call TIU to re-establish a new stub entry.
"RTN","SROTIUD",5,0)
 ; SRTN   - case number in file 130
"RTN","SROTIUD",6,0)
 ;
"RTN","SROTIUD",7,0)
 N ZTDESC,ZTRTN,ZTIO,ZTDTH,ZTSAVE,ZTSK
"RTN","SROTIUD",8,0)
 I $P($G(^SRF(SRTN,"NON")),"^")="Y" Q
"RTN","SROTIUD",9,0)
 S ZTDESC="Surgery Operation Report Stub",ZTRTN="OR^SROTIUD",ZTIO="",ZTDTH=$H,ZTSAVE("SRTN")="" D ^%ZTLOAD
"RTN","SROTIUD",10,0)
 Q
"RTN","SROTIUD",11,0)
OR K DR S DA=SRTN,DR="1000///@",DIE=130 D ^DIE K DR
"RTN","SROTIUD",12,0)
 D OR^SROESX
"RTN","SROTIUD",13,0)
 Q
"RTN","SROTIUD",14,0)
NON(SRTN) ; Delete the TIU PROCEDURE REPORT (NON-OR) pointer and call TIU to re-establish a new stub entry.
"RTN","SROTIUD",15,0)
 ; SRTN   - case number in file 130
"RTN","SROTIUD",16,0)
 ;
"RTN","SROTIUD",17,0)
 N ZTDESC,ZTRTN,ZTIO,ZTDTH,ZTSAVE,ZTSK
"RTN","SROTIUD",18,0)
 I '$P($G(^SRF(SRTN,"NON")),"^",5)!'$P($G(^SRF(SRTN,"TIU")),"^",5) Q
"RTN","SROTIUD",19,0)
 S ZTDESC="Surgery Non-OR Procedure Report Stub",ZTRTN="NOR^SROTIUD",ZTIO="",ZTDTH=$H,ZTSAVE("SRTN")="" D ^%ZTLOAD
"RTN","SROTIUD",20,0)
 Q
"RTN","SROTIUD",21,0)
NOR K DR S DA=SRTN,DR="1002///@",DIE=130 D ^DIE K DR
"RTN","SROTIUD",22,0)
 D PR^SROESXP
"RTN","SROTIUD",23,0)
 Q
"RTN","SROTIUD",24,0)
ANES(SRTN) ; Delete the TIU ANESTHESIA REPORT pointer and call TIU to re-establish a new stub entry.
"RTN","SROTIUD",25,0)
 ; SRTN   - case number in file 130
"RTN","SROTIUD",26,0)
 ;
"RTN","SROTIUD",27,0)
 N ZTDESC,ZTRTN,ZTIO,ZTDTH,ZTSAVE,ZTSK
"RTN","SROTIUD",28,0)
 I '$P($G(^SRF(SRTN,"TIU")),"^",4) Q
"RTN","SROTIUD",29,0)
 S ZTDESC="Surgery Anesthesia Report Stub",ZTRTN="ANS^SROTIUD",ZTIO="",ZTDTH=$H,ZTSAVE("SRTN")="" D ^%ZTLOAD
"RTN","SROTIUD",30,0)
 Q
"RTN","SROTIUD",31,0)
ANS K DR S DA=SRTN,DR="1003///@",DIE=130 D ^DIE K DR
"RTN","SROTIUD",32,0)
 D AR^SROESXA
"RTN","SROTIUD",33,0)
 Q
"RTN","SROTIUD",34,0)
NURS(SRTN) ; Delete the TIU NURSE INTRAOP REPORT pointer and call TIU to re-establisha new stub entry.
"RTN","SROTIUD",35,0)
 ; SRTN   - case number in file 130
"RTN","SROTIUD",36,0)
 N ZTDESC,ZTRTN,ZTIO,ZTDTH,ZTSAVE,ZTSK
"RTN","SROTIUD",37,0)
 I '$P($G(^SRF(SRTN,"TIU")),"^",2) Q
"RTN","SROTIUD",38,0)
 S ZTDESC="Surgery Nurse Interaop Report",ZTRTN="NUR^SROTIUD",ZTIO="",ZTDTH=$H,ZTSAVE("SRTN")="" D ^%ZTLOAD
"RTN","SROTIUD",39,0)
 Q
"RTN","SROTIUD",40,0)
NUR K DR S DA=SRTN,DR="1001///@",DIE=130 D ^DIE K DR
"RTN","SROTIUD",41,0)
 D NR^SROESX
"RTN","SROTIUD",42,0)
 Q
"RTN","SROUTL")
0^88^B28029566
"RTN","SROUTL",1,0)
SROUTL ;BIR/ADM - Utility Routine ; [ 01/21/04  8:32 AM ]
"RTN","SROUTL",2,0)
 ;;3.0; Surgery ;**58,62,69,77,50,88,94,100**;24 Jun 93
"RTN","SROUTL",3,0)
 ;
"RTN","SROUTL",4,0)
 ; Reference to $P(^SC(SRLOC,0),"^",17) supported by DBIA #964
"RTN","SROUTL",5,0)
 ;
"RTN","SROUTL",6,0)
 Q
"RTN","SROUTL",7,0)
HDR ; display menu header
"RTN","SROUTL",8,0)
 Q:'$D(SRSITE)
"RTN","SROUTL",9,0)
 N DFN,SRCNT,SRNUM,SRSDATE,SRX,Y S (SRCNT,SRX)=0 F  S SRX=$O(^SRO(133,SRX)) Q:'SRX  I '$P($G(^SRO(133,SRX,0)),"^",21) S SRCNT=SRCNT+1
"RTN","SROUTL",10,0)
 I SRCNT>1 S SRNUM=$$GET1^DIQ(4,SRSITE("DIV"),99) S Y="Division: "_SRSITE("SITE")_"  ("_SRNUM_")" W @IOF,!,?(80-$L(Y)\2),Y
"RTN","SROUTL",11,0)
 I $G(SRTN) D
"RTN","SROUTL",12,0)
 .S DFN=$P(^SRF(SRTN,0),"^") D DEM^VADPT S Y=$E($P(^SRF(SRTN,0),"^",9),1,7) X ^DD("DD") S SRSDATE=Y
"RTN","SROUTL",13,0)
 .W:SRCNT'>1 @IOF W:SRCNT>1 !! W " "_VADM(1)_" ("_VA("PID")_")   Case #"_SRTN_" - "_SRSDATE
"RTN","SROUTL",14,0)
 Q
"RTN","SROUTL",15,0)
CLINIC(SRLOC,SRCASE)         ; active count clinic screen for cases
"RTN","SROUTL",16,0)
 N SRCLIN,SRX,SRY,SRZ S SRZ=$S(SRCASE:$P(^SRF(SRCASE,0),U,9),1:DT) D SC I 'SRCLIN Q 0
"RTN","SROUTL",17,0)
 Q 1
"RTN","SROUTL",18,0)
ACTCLIN(SRLOC)     ; active count clinic screen
"RTN","SROUTL",19,0)
 N SRCLIN,SRX,SRY,SRZ S SRZ=DT D SC I 'SRCLIN Q 0
"RTN","SROUTL",20,0)
 Q 1
"RTN","SROUTL",21,0)
SC N SRKL S SRCLIN=1 S SRKL=$$GET1^DIQ(44,SRLOC,2.1) I SRKL'="CLINIC"!($P(^SC(SRLOC,0),"^",17)="Y") S SRCLIN=0 Q
"RTN","SROUTL",22,0)
 S SRX=$P($G(^SC(SRLOC,"I")),"^") I 'SRX Q
"RTN","SROUTL",23,0)
 S SRY=$P($G(^SC(SRLOC,"I")),U,2) I SRZ'<SRX,((SRY="")!(SRZ<SRY)) S SRCLIN=0
"RTN","SROUTL",24,0)
 Q
"RTN","SROUTL",25,0)
INOUT ; select in/out-patient status choice for report
"RTN","SROUTL",26,0)
 K DIR S DIR("A",1)="Print "_$S($D(SRRPT):SRRPT,1:"report")_" for",DIR("A",2)="",DIR("A",5)="  I - Inpatient cases only",DIR("A",4)="  O - Outpatient cases only",DIR("A",3)="  A - All cases"
"RTN","SROUTL",27,0)
 S DIR("A",6)="",DIR("A")="Select Letter (I, O or A): ",DIR("B")=$S($D(SRB):SRB,1:"A")
"RTN","SROUTL",28,0)
 S DIR(0)="SAM^A:All Cases;O:Outpatient Cases Only;I:Inpatient Cases Only" D ^DIR K DIR I $D(DTOUT)!$D(DUOUT) S SRSOUT=1 Q
"RTN","SROUTL",29,0)
 S SRIO=Y
"RTN","SROUTL",30,0)
 Q
"RTN","SROUTL",31,0)
DATE(SRSD,SRED,SRQ)  ; starting and ending date utility (pass by reference)
"RTN","SROUTL",32,0)
 ; The following variables are returned
"RTN","SROUTL",33,0)
 ;  SRSD - starting date
"RTN","SROUTL",34,0)
 ;  SRED - ending date
"RTN","SROUTL",35,0)
 ;  SRQ  - user interrupt
"RTN","SROUTL",36,0)
 S (SRSD,SRED,SRQ)=0 W ! F  D  Q:SRED'<SRSD!SRQ
"RTN","SROUTL",37,0)
 .K %DT S %DT="AEPX",%DT("A")="Start with Date: " D ^%DT I Y<1 S SRQ=1 Q
"RTN","SROUTL",38,0)
 .S SRSD=Y
"RTN","SROUTL",39,0)
 .K %DT S %DT="AEPX",%DT("A")="End with Date: " D ^%DT I Y<1 S SRQ=1 Q
"RTN","SROUTL",40,0)
 .I Y<SRSD W !!,"The ending date must be later than the starting date.",!
"RTN","SROUTL",41,0)
 .S SRED=Y
"RTN","SROUTL",42,0)
 Q
"RTN","SROUTL",43,0)
SPEC ; select surgical specialty
"RTN","SROUTL",44,0)
 W @IOF,! S DIR("?",1)="Enter YES if you would like the report printed for all Surgical Specialties",DIR("?")="or enter NO to select a specific specialty."
"RTN","SROUTL",45,0)
 S DIR("A")="Do you want the report for all Surgical Specialties ? ",DIR("B")="YES",DIR(0)="YA" D ^DIR K DIR I $D(DTOUT)!$D(DUOUT) S SRSOUT=1 Q
"RTN","SROUTL",46,0)
 I 'Y W ! K DIC S DIC=137.45,DIC(0)="QEAMZ",DIC("A")="Select Surgical Specialty: ",DIC("S")="I '$P(^(0),""^"",3)" D ^DIC K DIC S:Y<0 SRSOUT=1 Q:Y<0  S SRSPEC=+Y,SRSPECN=$P(Y(0),"^")
"RTN","SROUTL",47,0)
 Q
"RTN","SROUTL",48,0)
PROC ; put procedures and CPT code in array for display
"RTN","SROUTL",49,0)
 N SRDA,X,Y K SRPROC S K=1,Y=$P(^SRF(SRTN,"OP"),"^",2),Y=$S(Y:$P($$CPT^ICPTCOD(Y),"^",2),1:"???") I Y'="???" D SSPRIN^SROCPT
"RTN","SROUTL",50,0)
 S X=$P(^SRF(SRTN,"OP"),"^")_" (CPT Code: "_Y_")" I $L(X)<(SRL+1) S SRPROC(K)=X,K=K+1 G OTH
"RTN","SROUTL",51,0)
 D FORMAT
"RTN","SROUTL",52,0)
OTH S SRDA=0 F  S SRDA=$O(^SRF(SRTN,13,SRDA)) Q:'SRDA  D
"RTN","SROUTL",53,0)
 .S Y=$P($G(^SRF(SRTN,13,SRDA,2)),"^"),Y=$S(Y:$P($$CPT^ICPTCOD(Y),"^",2),1:"???")
"RTN","SROUTL",54,0)
 .I Y'="???" D SSOTH^SROCPT
"RTN","SROUTL",55,0)
 .S X=$P(^SRF(SRTN,13,SRDA,0),"^")_" (CPT Code: "_Y_")"
"RTN","SROUTL",56,0)
 .I $L(X)<(SRL+1) S SRPROC(K)=X,K=K+1 Q
"RTN","SROUTL",57,0)
 .D FORMAT
"RTN","SROUTL",58,0)
 Q
"RTN","SROUTL",59,0)
FORMAT I $L(X)>SRL F  D  I $L(X)<(SRL+1) S SRPROC(K)=X,K=K+1 Q
"RTN","SROUTL",60,0)
 .F I=0:1:(SRL-1) S J=SRL-I,Y=$E(X,J) I Y=" " S SRPROC(K)=$E(X,1,J-1),X=$E(X,J+1,$L(X)) S K=K+1 Q
"RTN","SROUTL",61,0)
 Q
"RTN","SROUTL",62,0)
DIAG ; check diagnosis input for required space in every 31 characters
"RTN","SROUTL",63,0)
 Q:$L(X)<31  N SRC,SRBL,SRDIAG,SRFLG
"RTN","SROUTL",64,0)
 S SRDIAG=X,SRFLG=0 F  D  Q:SRFLG!($L(SRDIAG)'>30)
"RTN","SROUTL",65,0)
 .S SRBL=$F(SRDIAG," ") I SRBL>32!('SRBL) S SRFLG=1 K X Q
"RTN","SROUTL",66,0)
 .S SRDIAG=$E(SRDIAG,SRBL,$L(SRDIAG))
"RTN","SROUTL",67,0)
 I '$D(X) D
"RTN","SROUTL",68,0)
 .S SRC(1)="Answer must contain at least one space in every 31 characters of length.",SRC(1,"F")="!!?5",SRC(2)="If you are using a comma (,) to separate information, leave a space after",SRC(2,"F")="!?5"
"RTN","SROUTL",69,0)
 .S SRC(3)="it.  Please re-enter the diagnosis.",SRC(3,"F")="!?5" D EN^DDIOL(.SRC)
"RTN","SROUTL",70,0)
 Q
"RTN","SROUTL",71,0)
PRE94 ; pre-install process for patch SR*3*94
"RTN","SROUTL",72,0)
 K DA,DIK S DIK="^DD(130.17,",DA=.01,DA(1)=130.17 D ^DIK K DA,DIK
"RTN","SROUTL",73,0)
 S DIK="^DD(130.18,",DA=.01,DA(1)=130.18 D ^DIK K DA,DIK
"RTN","SROUTL",74,0)
 Q
"RTN","SROUTL",75,0)
LOCK(SRCASE) ; apply incremental lock to case in file 130 before editing
"RTN","SROUTL",76,0)
 N SRCONCC,SRLCK
"RTN","SROUTL",77,0)
 S SRLCK=1 L +^SRF(SRCASE):1
"RTN","SROUTL",78,0)
 E  D EN^DDIOL("     Another user is editing this case.  Please try later.","","!,$C(7)") S SRLCK=0 H 2 Q SRLCK
"RTN","SROUTL",79,0)
 S SRCONCC=$P($G(^SRF(SRCASE,"CON")),"^") I SRCONCC D
"RTN","SROUTL",80,0)
 .L +^SRF(SRCONCC):1
"RTN","SROUTL",81,0)
 .E  D EN^DDIOL("     Another user is editing the concurrent case.  Please try later.","","!,$C(7)") L -^SRF(SRCASE) S SRLCK=0 H 2
"RTN","SROUTL",82,0)
 Q SRLCK
"RTN","SROUTL",83,0)
UNLOCK(SRCASE) ; apply decremental lock to case in file 130 after editing
"RTN","SROUTL",84,0)
 N SRCONCC
"RTN","SROUTL",85,0)
 L -^SRF(SRCASE)
"RTN","SROUTL",86,0)
 S SRCONCC=$P($G(^SRF(SRCASE,"CON")),"^") I SRCONCC L -^SRF(SRCONCC)
"RTN","SROUTL",87,0)
 Q
"RTN","SROUTL",88,0)
NOCNT(SRDA) ; screen for active, non-count clinic for this division
"RTN","SROUTL",89,0)
 N SRDIV,SRKL,SRLOC,SRX,SRY,SRZ
"RTN","SROUTL",90,0)
 S SRDIV=$P($G(^SRO(133,SRDA,0)),"^"),SRLOC=Y,SRZ=DT
"RTN","SROUTL",91,0)
 I SRDIV'=$P($G(^SC(SRLOC,0)),"^",4) Q 0
"RTN","SROUTL",92,0)
 S SRKL=$$GET1^DIQ(44,SRLOC,2.1) I SRKL'="CLINIC" Q 0
"RTN","SROUTL",93,0)
 I $P(^SC(SRLOC,0),"^",17)'="Y" Q 0
"RTN","SROUTL",94,0)
 S SRX=$P($G(^SC(SRLOC,"I")),"^") I 'SRX Q 1
"RTN","SROUTL",95,0)
 S SRY=$P($G(^SC(SRLOC,"I")),U,2) I SRZ'<SRX,((SRY="")!(SRZ<SRY)) Q 0
"RTN","SROUTL",96,0)
 Q 1
"RTN","SROUTL0")
0^105^B20639462
"RTN","SROUTL0",1,0)
SROUTL0 ;BIR/DLR,ADM - UTILITY ROUTINE ; [ 06/20/01  2:33 PM ]
"RTN","SROUTL0",2,0)
 ;;3.0; Surgery ;**50,100**;24 Jun 93
"RTN","SROUTL0",3,0)
 ;
"RTN","SROUTL0",4,0)
 ; Reference to ^SC( supported by DBIA #964
"RTN","SROUTL0",5,0)
 ;
"RTN","SROUTL0",6,0)
NODATA() ;;utility to write no data
"RTN","SROUTL0",7,0)
 W !!
"RTN","SROUTL0",8,0)
 Q "No data for selected date range."
"RTN","SROUTL0",9,0)
DIV(CASE) ;define the division of this case
"RTN","SROUTL0",10,0)
 ; CASE - File 130 ien
"RTN","SROUTL0",11,0)
 ; returns 0 - non-divisional match; 1 - divisonal match
"RTN","SROUTL0",12,0)
 N SRDIV,SROR I '$D(^SRF(CASE,0)) Q 0
"RTN","SROUTL0",13,0)
 I '$O(^SRO(133,1)) Q 1
"RTN","SROUTL0",14,0)
 I '$D(^SRF(CASE,"NON")) S SRDIV="",SROR=$P(^SRF(CASE,0),U,2) I SROR'="" S SROR=$P(^SRS(SROR,0),U) I SROR'="" S SRDIV=$P(^SC(SROR,0),U,4)
"RTN","SROUTL0",15,0)
 I $D(^SRF(CASE,"NON")) S SRDIV="",SROR=$P(^SRF(CASE,"NON"),U,2) I SROR'="" S SRDIV=$P(^SC(SROR,0),U,4)
"RTN","SROUTL0",16,0)
 I SRDIV="" S SRDIV=$P($G(^SRF(CASE,8)),U)
"RTN","SROUTL0",17,0)
 Q SRDIV=$G(SRSITE("DIV"))
"RTN","SROUTL0",18,0)
ORDIV(OR,SRINST) ;define the division of this OR
"RTN","SROUTL0",19,0)
 ; OR - .01 of Operating Room in file 131.7
"RTN","SROUTL0",20,0)
 ; returns 0 - non-divisional match; 1 - divisonal match
"RTN","SROUTL0",21,0)
 N SRDIV
"RTN","SROUTL0",22,0)
 I '$O(^SRO(133,1)) Q 1
"RTN","SROUTL0",23,0)
 I SRINST="" Q 1
"RTN","SROUTL0",24,0)
 I SRINST["ALL" Q 1
"RTN","SROUTL0",25,0)
 I $G(OR)'="" S OR=$P(^SRS(OR,0),U),SRDIV=$P($G(^SC(OR,0)),U,4) I SRDIV'="" S SRDIV=$P(^(0),U,4)
"RTN","SROUTL0",26,0)
 Q SRDIV=SRINST
"RTN","SROUTL0",27,0)
NONORDIV(CASE,NONOR) ;define nonor divisional locations (File #130,119 input transform)
"RTN","SROUTL0",28,0)
 ; CASE - File 130 ien
"RTN","SROUTL0",29,0)
 ; NONOR - File 44 ien
"RTN","SROUTL0",30,0)
 ; returns 0 - non-divisional match; 1 - divisonal match
"RTN","SROUTL0",31,0)
 N CD,IORD,RORD,SRDIV
"RTN","SROUTL0",32,0)
 ; CD - case date
"RTN","SROUTL0",33,0)
 ; SRDIV - boolean (case division MATCH)
"RTN","SROUTL0",34,0)
 ; IORD - Location file inactive date
"RTN","SROUTL0",35,0)
 ; RORD - Location file inactive date
"RTN","SROUTL0",36,0)
 ; 
"RTN","SROUTL0",37,0)
 S SRDIV=1
"RTN","SROUTL0",38,0)
 I '$D(^SC(NONOR,0))!$G(NONOR)=""!$G(CASE)="" Q SRDIV
"RTN","SROUTL0",39,0)
 I '$D(^SRF(CASE,"NON")) Q 0
"RTN","SROUTL0",40,0)
 ;if there is no institution set for this non-or location quit
"RTN","SROUTL0",41,0)
 I $P(^SC(NONOR,0),U,4)="" Q 0
"RTN","SROUTL0",42,0)
 I $D(SRSITE("DIV")) I $P(^SC(NONOR,0),U,4)'=$G(SRSITE("DIV")) Q 0
"RTN","SROUTL0",43,0)
 I $D(^SC(NONOR,"I")) S CD=$P(^SRF(CASE,"NON"),U,3),IORD=$P(^SC(NONOR,"I"),U),RORD=$P(^SC(NONOR,"I"),U,2) D:IORD'=""
"RTN","SROUTL0",44,0)
 .I CD'<IORD,((RORD="")!(CD<RORD)) S SRDIV=0 Q
"RTN","SROUTL0",45,0)
 Q SRDIV
"RTN","SROUTL0",46,0)
MANDIV(SRINST,CASE) ;a boolean divisional call for managerial reports
"RTN","SROUTL0",47,0)
 I '$D(^SRF(CASE,0)) Q 0
"RTN","SROUTL0",48,0)
 I '$O(^SRO(133,1)) Q 1
"RTN","SROUTL0",49,0)
 I SRINST["ALL" Q 1
"RTN","SROUTL0",50,0)
 I +SRINST'>0 Q 0
"RTN","SROUTL0",51,0)
 N SRDIV,SROR
"RTN","SROUTL0",52,0)
 I '$D(^SRF(CASE,"NON")) S SRDIV="",SROR=$P(^SRF(CASE,0),U,2) I SROR'="" S SROR=$P(^SRS(SROR,0),U) I SROR'="" S SRDIV=$P(^SC(SROR,0),U,4)
"RTN","SROUTL0",53,0)
 I $D(^SRF(CASE,"NON")) S SRDIV="",SROR=$P(^SRF(CASE,"NON"),U,2) I SROR'="" S SRDIV=$P(^SC(SROR,0),U,4)
"RTN","SROUTL0",54,0)
 I SRDIV="" S SRDIV=$P($G(^SRF(CASE,8)),U)
"RTN","SROUTL0",55,0)
 Q SRDIV=SRINST
"RTN","SROUTL0",56,0)
INST() ;extrinsic call used by the management reports to determine division
"RTN","SROUTL0",57,0)
 ; Returns:
"RTN","SROUTL0",58,0)
 ;   inst#^inst name - for one division
"RTN","SROUTL0",59,0)
 ;   "ALL DIVISIONS" - all divisions
"RTN","SROUTL0",60,0)
 ;   "^"             - no division
"RTN","SROUTL0",61,0)
 N SR,SRCNT,SRINST,X S (SRCNT,X)=0 F  S X=$O(^SRO(133,X)) Q:'X  I '$P($G(^SRO(133,X,0)),"^",21) S SRCNT=SRCNT+1
"RTN","SROUTL0",62,0)
 I SRCNT=1 S SRINST=$P($$SITE^SROVAR,"^",1,2) Q SRINST
"RTN","SROUTL0",63,0)
 W ! K DIR,Y S DIR(0)="YO",DIR("?")="Enter 'Yes' to include all divisions, or 'No' to pick one division",DIR("A")="Do you want to print all divisions",DIR("B")="YES" D ^DIR S SRINST=$S($G(Y(0))'="":Y(0),1:"^")
"RTN","SROUTL0",64,0)
 I SRINST="YES" S SRINST=$P($$SITE^SROVAR,U,2)_" - ALL DIVISIONS"
"RTN","SROUTL0",65,0)
 I SRINST="NO" D LIST^DIC(133,"",".01","B","*","","","","","","SR") W ! D
"RTN","SROUTL0",66,0)
 .S X=0 F  S X=$O(SR("DILIST",1,X)) Q:'X  W !,X,". ",SR("DILIST",1,X)
"RTN","SROUTL0",67,0)
 .K DIR W ! S DIR(0)="NO^1:"_$P(SR("DILIST",0),U),DIR("A")="Select Number" D ^DIR S:+Y<1 SRINST="^" S:+Y>0 SRINST=SR("DILIST",2,+Y),DIR("?")="Enter the corresponding number of the hospital for which you want the report to run"
"RTN","SROUTL0",68,0)
 Q $S(SRINST["ALL DIVISIONS":SRINST,SRINST=U:SRINST,1:$P(^SRO(133,SRINST,0),U)_U_SR("DILIST",1,+Y))
"RTN","SROUTL0",69,0)
SITE(CASE) ; returns pointer to file 133 indicating where case was performed
"RTN","SROUTL0",70,0)
 ; CASE - ien in File 130
"RTN","SROUTL0",71,0)
 N SRDIV,SROR S SRDIV="" I '$D(^SRF(CASE,"NON")) S SROR=$P($G(^SRF(CASE,0)),"^",2) I SROR'="" S SROR=$P(^SRS(SROR,0),"^") I SROR'="" S SRDIV=$P(^SC(SROR,0),"^",4)
"RTN","SROUTL0",72,0)
 I $P($G(^SRF(CASE,"NON")),"^")="Y" S SROR=$P(^SRF(CASE,"NON"),"^",2) I SROR'="" S SRDIV=$P(^SC(SROR,0),"^",4)
"RTN","SROUTL0",73,0)
 I SRDIV="" S SRDIV=$P($G(^SRF(CASE,8)),"^")
"RTN","SROUTL0",74,0)
 S:SRDIV'="" SRDIV=$O(^SRO(133,"B",SRDIV,0))
"RTN","SROUTL0",75,0)
 S:SRDIV="" SRDIV=$O(^SRO(133,0))
"RTN","SROUTL0",76,0)
 Q SRDIV
"RTN","SROUTL0",77,0)
WARD(SRW,SRINST,DGPMOS) ;a boolean divisional call for active ward location
"RTN","SROUTL0",78,0)
 ; SRW - IEN in File 42
"RTN","SROUTL0",79,0)
 ; SRINST - user division
"RTN","SROUTL0",80,0)
 ; DGPMOS - date to check for active ward
"RTN","SROUTL0",81,0)
 ; returns 0 - non-divisional match; 1 - divisional match
"RTN","SROUTL0",82,0)
 N SRLOC,D0,X
"RTN","SROUTL0",83,0)
 S D0=SRW D WIN^DGPMDDCF I X=1 Q 0
"RTN","SROUTL0",84,0)
 I '$O(^SRO(133,1))!(SRINST="")!(SRINST["ALL") Q 1
"RTN","SROUTL0",85,0)
 S SRLOC=$P($G(^DIC(42,SRW,44)),"^") I SRLOC="" Q 1
"RTN","SROUTL0",86,0)
 S SRDIV=$P($G(^SC(SRLOC,0)),"^",4) I SRDIV="" Q 1
"RTN","SROUTL0",87,0)
 Q SRDIV=SRINST
"RTN","SROUTL0",88,0)
HL(SRLOC,SRINST) ; define division of this hospital location
"RTN","SROUTL0",89,0)
 ; SRLOC - File 44 IEN
"RTN","SROUTL0",90,0)
 ; SRINST - user division
"RTN","SROUTL0",91,0)
 ; returns 0 - non-divisional match; 1 - divisional match
"RTN","SROUTL0",92,0)
 N SRDIV I SRINST="" Q 1
"RTN","SROUTL0",93,0)
 S SRDIV=0
"RTN","SROUTL0",94,0)
 I $G(SRLOC)'="" S SRDIV=$P($G(^SC(SRLOC,0)),"^",4) I SRDIV="" Q 1
"RTN","SROUTL0",95,0)
 Q SRDIV=SRINST
"RTN","SROUTR1")
1^107
"RTN","SROUTRN")
1^161
"RTN","SROVAR")
0^159^B28808178
"RTN","SROVAR",1,0)
SROVAR ;BIR/MAM,ADM - SITE PARAMETERS; [ 08/29/03  10:46 AM ]
"RTN","SROVAR",2,0)
 ;;3.0; Surgery ;**17,38,48,67,77,50,87,88,102,107,100**;24 Jun 93
"RTN","SROVAR",3,0)
 ;
"RTN","SROVAR",4,0)
 ; Reference to ^TMP("CSLSUR1" supported by DBIA #3498
"RTN","SROVAR",5,0)
 ;
"RTN","SROVAR",6,0)
 K ^TMP("CSLSUR1",$J)
"RTN","SROVAR",7,0)
 I $D(SRSITE) Q
"RTN","SROVAR",8,0)
 D CPT
"RTN","SROVAR",9,0)
 K SRL S (SRCNT,X)=0 F  S X=$O(^SRO(133,X)) Q:'X  I '$P($G(^SRO(133,X,0)),"^",21) S SRCNT=SRCNT+1,SRL(SRCNT)=X
"RTN","SROVAR",10,0)
 I SRCNT=1 S SRSITE=SRL(1) G SET
"RTN","SROVAR",11,0)
 K XQUIT,DIR W ! I SRCNT>1 S DIR("?",1)="  Because there is more than one division in the SURGERY SITE PARAMETERS",DIR("?")="  file, a division must be selected."
"RTN","SROVAR",12,0)
 S DIR(0)="P^133:EM",DIR("A")="Select Division",DIR("S")="I '$P(^SRO(133,+Y,0),U,21)" D ^DIR K DIR I $D(DTOUT)!$D(DUOUT) D ^SRSKILL S XQUIT="" Q
"RTN","SROVAR",13,0)
 S SRSITE=+Y
"RTN","SROVAR",14,0)
SET ; set site parameters
"RTN","SROVAR",15,0)
 S S(0)=^SRO(133,SRSITE,0),SRSITE("AML")=$P(S(0),"^",4),SRSITE("REQ")=$P(S(0),"^",2) K:SRSITE("REQ")="" SRSITE("REQ")
"RTN","SROVAR",16,0)
 S SRSITE("IV")=$P(S(0),"^",7) K:SRSITE("IV")="" SRSITE("IV")
"RTN","SROVAR",17,0)
 S SRSITE("DIV")=$P(S(0),"^"),SRSITE("SITE")=$$GET1^DIQ(4,SRSITE("DIV"),.01)
"RTN","SROVAR",18,0)
 S SRSITE("NRPT")=$P(S(0),"^",6) I SRSITE("NRPT")="" S SRSITE("NRPT")=1
"RTN","SROVAR",19,0)
 I '$D(SRSITE("OPTION")),$D(XQY) S SRSITE("OPTION")=XQY
"RTN","SROVAR",20,0)
 K S
"RTN","SROVAR",21,0)
 Q
"RTN","SROVAR",22,0)
CPT ; display CPT copyright notice
"RTN","SROVAR",23,0)
 N SRCPT,SRDIV S (SRCPT,SRDIV)=0 F  S SRDIV=$O(^SRO(133,SRDIV)) Q:'SRDIV  I $D(^SRO(133,SRDIV,6,DT,1,DUZ)) S SRCPT=1 Q
"RTN","SROVAR",24,0)
 Q:SRCPT  D COPY^ICPTAPIU I $G(IOST)'["P-" W ! K DIR S DIR("A")="Press the 'Return' key to continue",DIR(0)="FOA" D ^DIR K DIR
"RTN","SROVAR",25,0)
 K DD,DO,DA,DIC S SRDIV=$O(^SRO(133,0))
"RTN","SROVAR",26,0)
 I '$D(^SRO(133,SRDIV,6,DT,0)) S X=DT,DA(1)=SRDIV,DIC="^SRO(133,SRDIV,6,",DIC("P")=$P(^DD(133,36,0),"^",2),DIC(0)="L",DINUM=X D FILE^DICN K DD,DO,DA,DIC I Y=-1 Q
"RTN","SROVAR",27,0)
 S X=DUZ,DA(2)=SRDIV,DA(1)=DT,DIC="^SRO(133,SRDIV,6,DT,1,",DIC("P")=$P(^DD(133.036,1,0),"^",2),DIC(0)="L",DINUM=X D FILE^DICN K DA,DD,DIC,DO
"RTN","SROVAR",28,0)
 Q
"RTN","SROVAR",29,0)
EN2 ; set view only and titles for screens
"RTN","SROVAR",30,0)
 I '$D(^XUSEC("SROEDIT",DUZ)) S Q3("VIEW")=""
"RTN","SROVAR",31,0)
 Q:'$D(SRTN)  Q:SRTN<1  S:'$D(ST) ST="SCHEDULING" S DFN=$P(^SRF(SRTN,0),"^") D DEM^VADPT S SRN=$E(VADM(1),1,20),Q3(1)="** "_ST_" **   CASE #"_SRTN_"  "_SRN_" "
"RTN","SROVAR",32,0)
 Q
"RTN","SROVAR",33,0)
DEV S SRION=$S($D(ION):ION,1:"HOME") K %ZIS S %ZIS="QN",IOP=X D ^%ZIS I POP S IOP=SRION D ^%ZIS K %ZIS,IOP,SRION,X Q
"RTN","SROVAR",34,0)
 W $S(X=$E(ION,1,$L(X)):$E(ION,$L(X)+1,$L(ION)),1:"  "_ION) S X=ION D ^%ZISC K %ZIS,SRION,IOP Q
"RTN","SROVAR",35,0)
 Q
"RTN","SROVAR",36,0)
TIME ; transform time to date of operation at that time
"RTN","SROVAR",37,0)
 I $D(SRSMED) S DA=SRTN
"RTN","SROVAR",38,0)
 S:$D(SRTN) SRTDA=DA,DA=SRTN S X=$S(X?1.4N.A!(X?1.2N1":"2N.A):Z_"@"_X,1:X)
"RTN","SROVAR",39,0)
 S %DT="EPTXR" D ^%DT S X=Y G:'$D(^SRF(DA,.2)) RESET I X>0 S SRSTART=$P(^SRF($S($D(SRTN):SRTN,1:DA),.2),"^",15) I SRSTART'="" D BEFORE
"RTN","SROVAR",40,0)
 S:$D(SRTDA) DA=SRTDA Q
"RTN","SROVAR",41,0)
BEFORE W:X<SRSTART !!,"The time entered is before the 'TIME PAT IN HOLD AREA'.  Please check the",!,"DATE/TIME entered for this field." H 2
"RTN","SROVAR",42,0)
 Q
"RTN","SROVAR",43,0)
RESET S:$D(SRTDA) DA=SRTDA Q
"RTN","SROVAR",44,0)
INPUT ; input transfor for ASA CLASS
"RTN","SROVAR",45,0)
 S:'$D(DA) DA=SRTN S SRFLD=1.13 I $D(^SRF(DA,"CON")),$P(^("CON"),"^") D ^SROCON Q
"RTN","SROVAR",46,0)
 Q
"RTN","SROVAR",47,0)
PARAM ; enter/edit site parameters
"RTN","SROVAR",48,0)
 W @IOF K DIC,DINUM S DIC=133,DIC(0)="QEAMZL",DLAYGO=133,DIC("A")="Edit Parameters for which Surgery Site: " D ^DIC K DIC I Y<0 W @IOF Q
"RTN","SROVAR",49,0)
 N SRDIV,SRN,SRNAME,SRNUM S SRDIV=+Y,SRN=+Y(0),SRNAME=Y(0,0),SRNUM=$$GET1^DIQ(4,SRN,99),Q3(1)=" "_SRNAME_"  ("_SRNUM_") "
"RTN","SROVAR",50,0)
 K DIE,DR,DA,Y S DA=SRDIV,DR="[SRPARAM]",DIE=133 D ^SRCUSS K DR,DIE,DA,ST W @IOF I $D(SRSITE) D SET
"RTN","SROVAR",51,0)
 Q
"RTN","SROVAR",52,0)
EXIT ; exit action for all Surgery options
"RTN","SROVAR",53,0)
 I $G(SRTN),'$P($G(^SRF(SRTN,0)),"^",15),'$D(^SRF("APCE",SRTN)) D APCE^SROPCEX
"RTN","SROVAR",54,0)
 I $D(XQY),$G(SRSITE("OPTION"))=XQY K SRSITE,SRTN,^TMP("SRCUSS",$J)
"RTN","SROVAR",55,0)
 Q
"RTN","SROVAR",56,0)
SITE() ; extrinsic call to output Institution file pointer (from Default Institution field in file 4.3)^Institution name^Station number
"RTN","SROVAR",57,0)
 N SITE,SRI,SRX,SRY
"RTN","SROVAR",58,0)
 S SITE=$$KSP^XUPARAM("INST") I 'SITE Q SITE
"RTN","SROVAR",59,0)
 S SRX=SITE F SRI=.01,99 S SRY=$$GET1^DIQ(4,SRX,SRI),SITE=SITE_"^"_SRY
"RTN","SROVAR",60,0)
 Q SITE
"RTN","SROVAR",61,0)
OFF1 ; compare time off with time on
"RTN","SROVAR",62,0)
 S Z=$E($P(^SRF($S($D(SRTN):SRTN,1:DA(1)),0),"^",9),1,7),X=$S(X?1.4N.A!(X?1.2N1":"2N.A):Z_"@"_X,1:X) K %DT,Z S %DT="PTXR" D ^%DT S X=Y I Y<1 D OUT Q
"RTN","SROVAR",63,0)
 S SRSTART=$P(^SRF(DA(1),SRSUB,DA,0),"^",SRP) D COMP
"RTN","SROVAR",64,0)
 Q
"RTN","SROVAR",65,0)
OFF2 ; compare time off with time on
"RTN","SROVAR",66,0)
 S Z=$E($P(^SRF($S($D(SRTN):SRTN,1:DA(2)),0),"^",9),1,7),X=$S(X?1.4N.A!(X?1.2N1":"2N.A):Z_"@"_X,1:X) K %DT,Z S %DT="PTXR" D ^%DT S X=Y I Y<1 D OUT Q
"RTN","SROVAR",67,0)
 S SRSTART=$P(^SRF(DA(2),SRSUB,DA(1),1,DA,0),"^",SRP)
"RTN","SROVAR",68,0)
COMP I X<SRSTART W !!,"Time Off should be later than Time On.",! S X=-1
"RTN","SROVAR",69,0)
OUT K %DT,SR130,SRN,SRP,SRSTART,SRSUB
"RTN","SROVAR",70,0)
 Q
"RTN","SROVAR",71,0)
TERM ; compare stop time with start time
"RTN","SROVAR",72,0)
 N SRINOR,SRSTART,SRV,SRY,T,Z
"RTN","SROVAR",73,0)
 I $D(DA) S SRINOR=$S($P($G(^SRF(DA,"NON")),"^")="Y":$P($G(^SRF(DA,"NON")),"^",4),1:$P($G(^SRF(DA,.2)),"^",10)) I 'SRINOR D  K X D OUT Q
"RTN","SROVAR",74,0)
 .D EN^DDIOL(">>> Please enter 'TIME "_$S($P($G(^SRF(DA,"NON")),"^")="Y":"PROCEDURE BEGAN",1:"PAT IN OR")_"' first !! <<<","","!!?5")
"RTN","SROVAR",75,0)
 .D EN^DDIOL("","","!")
"RTN","SROVAR",76,0)
 S Z=$E(SRINOR,1,7),X=$S(X?1.4N.A!(X?1.2N1":"2N.A):Z_"@"_X,1:X)
"RTN","SROVAR",77,0)
 K %DT,Z S %DT="PTXR" D ^%DT S X=Y I Y<1 D OUT Q
"RTN","SROVAR",78,0)
 I $D(DA) S Z=$P($G(^SRF(DA,SRN)),"^",SRP),SRSTART=$S(Z:Z,1:SRINOR),SRNULL=$S(Z:0,1:1) I X<SRSTART S Z=$P(SRINOR,"."),T=$P(X,".",2),X1=Z_"."_T,X2=1 D C^%DTC D PLUS24 I '$D(X) D OUT Q
"RTN","SROVAR",79,0)
 K %DT S %DT="EPTXR" D ^%DT S X=Y D OUT
"RTN","SROVAR",80,0)
 Q
"RTN","SROVAR",81,0)
PLUS24 S:SRNULL SR130="TIME PAT IN OR" S (SRV,Y)=X X ^DD("DD") S SRY=Y
"RTN","SROVAR",82,0)
 K DIR S DIR("A",1)="",DIR("A",2)="The time you have entered is earlier than "_SR130_".",DIR("A")="Do you mean "_SRY_" (Y/N) ? ",DIR(0)="YA" D ^DIR K DIR I 'Y!$D(DTOUT)!$D(DUOUT) K X Q
"RTN","SROVAR",83,0)
 S X=SRV
"RTN","SROVAR",84,0)
 Q
"RTN","SROVER")
0^89^B22114615
"RTN","SROVER",1,0)
SROVER ;BIR/MAM - VERIFY CASE ; [ 01/30/01  1:52 PM ]
"RTN","SROVER",2,0)
 ;;3.0; Surgery ;**7,34,38,86,88,100**;24 Jun 93
"RTN","SROVER",3,0)
BEG S (SRSOUT,SRS,SR2)=0 I $D(^SRF(SRTN,.2)),$P(^(.2),"^",3) S SRS=1
"RTN","SROVER",4,0)
DONE K X I $D(^SRF(SRTN,"VER")),$P(^("VER"),"^")="Y" W !!,"The procedure has already been verified.  Do you wish to continue ?  YES// " R X:DTIME I '$T!(X["^") G END
"RTN","SROVER",5,0)
 S:'$D(X) X="Y"
"RTN","SROVER",6,0)
 S:X="" X="Y" S X=$E(X) I X["?"!("YyNn"'[X) W !!,"Enter RETURN if you would like to reverify this case, or 'N' to exit",!,"this option." G DONE
"RTN","SROVER",7,0)
 G:"Yy"'[X END
"RTN","SROVER",8,0)
 S S(0)=^SRF(SRTN,0),Y=$E($P(S(0),"^",9),1,7) X ^DD("DD") S SRSDATE=Y,DFN=$P(S(0),"^") D DEM^VADPT S SRNM=VADM(1)_" ("_VA("PID")_")"
"RTN","SROVER",9,0)
 N ANS,SRLCK S ANS="NO"
"RTN","SROVER",10,0)
STRT D PRINT
"RTN","SROVER",11,0)
 I $P($G(^SRF(SRTN,"LOCK")),"^") W !!,"This case has been locked.  If you wish to update it, please contact",!,"your Chief of Surgery, or package coordinator." G END
"RTN","SROVER",12,0)
UP W ! G:SR2 VER W !,"Do you need to update the information above ?  NO// " R X:DTIME S:'$T X="^"
"RTN","SROVER",13,0)
 I X["^" W !!,"Verification of this case has not been made." G END
"RTN","SROVER",14,0)
 S (X,ANS)=$E(X)
"RTN","SROVER",15,0)
 I X?.E1C.E W !!,"Your answer has a control character in it, please re-type it.",! G UP
"RTN","SROVER",16,0)
 I "YyNn"'[X W !!,"If the information above is not correct, enter 'YES'.  You may then update",!,"any of the fields displayed.  Enter RETURN to proceed with verification",!,"of this case." G UP
"RTN","SROVER",17,0)
 S:X="" (X,ANS)="N" I "Yy"[X D CHECK^SROES I SRSOUT S SRLCK=0 K XQUIT G END
"RTN","SROVER",18,0)
 I "Yy"[ANS S SRLCK=1 D PRINT,RT,^SROVER1 G:SRSOUT END G STRT
"RTN","SROVER",19,0)
VER W !,"Will you verify that the information on your screen is correct ? YES// " R X:DTIME S:'$T X="^" I X["^" W !!,"No action has been taken. " G END
"RTN","SROVER",20,0)
 S X=$E(X)
"RTN","SROVER",21,0)
 I "YyNn"'[X W !,"Enter 'YES' if the procedures, diagnosis, and occurrences are correct",!,"for this case.  If you enter 'NO', the case will be left unverified." G VER
"RTN","SROVER",22,0)
 S:X="" X="Y" I "Yy"[X S $P(^SRF(SRTN,"VER"),"^")="Y"
"RTN","SROVER",23,0)
END S SROERR=SRTN D ^SROERR0
"RTN","SROVER",24,0)
 I $G(SRLCK) D UNLOCK^SROUTL(SRTN)
"RTN","SROVER",25,0)
 W !!,"Press RETURN to continue  " R X:DTIME D ^SRSKILL W @IOF
"RTN","SROVER",26,0)
 Q
"RTN","SROVER",27,0)
LOOP ; break procedure if greater than 45 characters
"RTN","SROVER",28,0)
 S SROPS(M)="" F LOOP=1:1 S MM=$P(SROPER," "),MMM=$P(SROPER," ",2,200) Q:MMM=""  Q:$L(SROPS(M))+$L(MM)'<45  S SROPS(M)=SROPS(M)_MM_" ",SROPER=MMM
"RTN","SROVER",29,0)
 Q
"RTN","SROVER",30,0)
RT ; start RT logging
"RTN","SROVER",31,0)
 I $D(XRTL) S XRTN="SROVER" D T0^%ZOSV
"RTN","SROVER",32,0)
 Q
"RTN","SROVER",33,0)
OTHER I '$O(^SRF(SRTN,13,0)) Q
"RTN","SROVER",34,0)
 S OTH=0 F  S OTH=$O(^SRF(SRTN,13,OTH)) Q:'OTH!(SRSOUT)  D
"RTN","SROVER",35,0)
 .S OTHER=$P(^SRF(SRTN,13,OTH,0),"^"),CPT=$P($G(^SRF(SRTN,13,OTH,2)),"^"),X=$S(CPT:$P($$CPT^ICPTCOD(CPT),"^",2),1:"NOT ENTERED")
"RTN","SROVER",36,0)
 .W !,?3,OTHER_"  CPT Code: ",X
"RTN","SROVER",37,0)
 .I CPT,$O(^SRF(SRTN,13,OTH,"MOD",0)) D  W !,?10,SRX
"RTN","SROVER",38,0)
 ..S (SRCOMMA,SRI)=0,SRCMOD="",SRX="Modifiers:  -" F  S SRI=$O(^SRF(SRTN,13,OTH,"MOD",SRI)) Q:'SRI  D
"RTN","SROVER",39,0)
 ...S SRM=$P(^SRF(SRTN,13,OTH,"MOD",SRI,0),"^"),SRCMOD=$P($$MOD^ICPTMOD(SRM,"I"),"^",2)
"RTN","SROVER",40,0)
 ...S SRX=SRX_$S(SRCOMMA:",",1:"")_SRCMOD,SRCOMMA=1
"RTN","SROVER",41,0)
 Q
"RTN","SROVER",42,0)
PRINT ; print information
"RTN","SROVER",43,0)
 W @IOF,!,SRNM,?52,"Operation Date: "_SRSDATE,! F I=1:1:80 W "-"
"RTN","SROVER",44,0)
 K ^UTILITY($J,"W") W !,"1. Indications for Operation:" S SRIND=0 F I=0:0 S SRIND=$O(^SRF(SRTN,40,SRIND)) Q:'SRIND  S X=^SRF(SRTN,40,SRIND,0),DIWL=3,DIWR=76,DIWF="N" D ^DIWP
"RTN","SROVER",45,0)
 I $D(^UTILITY($J,"W")) F V=1:1:^UTILITY($J,"W",3) W !,?3,^UTILITY($J,"W",3,V,0)
"RTN","SROVER",46,0)
 S S("OP")=^SRF(SRTN,"OP"),CPT=$P(S("OP"),"^",2) S SROPER=$P(S("OP"),"^")
"RTN","SROVER",47,0)
 K SROPS,MM,MMM S:$L(SROPER)<45 SROPS(1)=SROPER I $L(SROPER)>44 S SROPER=SROPER_"  " F M=1:1 D LOOP Q:MMM=""
"RTN","SROVER",48,0)
 S X=$S(CPT:$P($$CPT^ICPTCOD(CPT),"^",2),1:"NOT ENTERED")
"RTN","SROVER",49,0)
 W !,"2. Principal CPT Code:  ",X
"RTN","SROVER",50,0)
 I CPT,$O(^SRF(SRTN,"OPMOD",0)) D  W !,?10,SRX
"RTN","SROVER",51,0)
 .S (SRCOMMA,SRI)=0,SRCMOD="",SRX="Modifiers:  -" F  S SRI=$O(^SRF(SRTN,"OPMOD",SRI)) Q:'SRI  D
"RTN","SROVER",52,0)
 ..S SRM=$P(^SRF(SRTN,"OPMOD",SRI,0),"^"),SRCMOD=$P($$MOD^ICPTMOD(SRM,"I"),"^",2)
"RTN","SROVER",53,0)
 ..S SRX=SRX_$S(SRCOMMA:",",1:"")_SRCMOD,SRCOMMA=1
"RTN","SROVER",54,0)
 W !,"3. Principal Procedure: ",?24,SROPS(1) I $D(SROPS(2)) W !,?24,SROPS(2) I $D(SROPS(3)) W !,?24,SROPS(3)
"RTN","SROVER",55,0)
 W !!,"4. Other Procedures: ",?24 D OTHER
"RTN","SROVER",56,0)
 W !!,"5. Postoperative Diagnosis: " I $D(^SRF(SRTN,34)) W ?30,$P(^(34),"^")
"RTN","SROVER",57,0)
 W !!,"6. Intraoperative Occurrences: "_$S($O(^SRF(SRTN,10,0)):"** INFORMATION ENTERED **",1:"NO OCCURRENCES HAVE BEEN ENTERED")
"RTN","SROVER",58,0)
 W ! F LINE=1:1:80 W "-"
"RTN","SROVER",59,0)
 Q
"RTN","SROVER2")
0^90^B23436827
"RTN","SROVER2",1,0)
SROVER2 ;BIR/ADM - Case Coding and Verification ; [ 03/13/02  1:58 PM ]
"RTN","SROVER2",2,0)
 ;;3.0; Surgery ;**86,88,100**;24 Jun 93
"RTN","SROVER2",3,0)
 I '$D(SRSITE) D ^SROVAR I '$D(SRSITE) S XQUIT="" Q
"RTN","SROVER2",4,0)
 I '$G(SRTN) D ^SROPS1 I '$D(SRTN) S XQUIT="" Q
"RTN","SROVER2",5,0)
BEG N SRDES,SRDX,SREDIT,SRMOD,SRNON,SRSEL,SRTXT S (SREDIT,SRMOD,SRSOUT,SRS,SR2)=0 K ^TMP("SRV1",$J),^TMP("SRV2",$J) I $D(^SRF(SRTN,.2)),$P(^(.2),"^",3) S SRS=1
"RTN","SROVER2",6,0)
 S S(0)=^SRF(SRTN,0),Y=$P(S(0),"^",9) D D^DIQ S SRSDATE=Y,DFN=$P(S(0),"^") D DEM^VADPT S SRNM=VADM(1)_"  ("_VA("PID")_")"
"RTN","SROVER2",7,0)
 S SRNON=$S($P($G(^SRF(SRTN,"NON")),"^")="Y":1,1:0)
"RTN","SROVER2",8,0)
PRINT ; print information
"RTN","SROVER2",9,0)
 D HDR S S("OP")=^SRF(SRTN,"OP"),CPT=$P(S("OP"),"^",2),SROPER=$P(S("OP"),"^")
"RTN","SROVER2",10,0)
 S SRJ=0,Y="" F  S SRJ=$O(^SRF(SRTN,"OPMOD",SRJ)) Q:'SRJ  S Y=Y_$S($L(Y):",",1:"")_^SRF(SRTN,"OPMOD",SRJ,0)
"RTN","SROVER2",11,0)
 S ^TMP("SRV1",$J,"OP")=SROPER_"^"_CPT_"^"_Y
"RTN","SROVER2",12,0)
 S SRCPT="" I CPT S Y=$$CPT^ICPTCOD(CPT),SRCPT=$P(Y,"^",2)_"  "_$P(Y,"^",3)
"RTN","SROVER2",13,0)
 K SROPS,MM,MMM S:$L(SROPER)<45 SROPS(1)=SROPER I $L(SROPER)>44 S SROPER=SROPER_"  " F M=1:1 D LOOP Q:MMM=""
"RTN","SROVER2",14,0)
 W !,"1. Principal Procedure: ",?24,SROPS(1) I $D(SROPS(2)) W !,?24,SROPS(2) I $D(SROPS(3)) W !,?24,SROPS(3)
"RTN","SROVER2",15,0)
 W !,"2. Principal CPT Code: ",?24,$S(CPT:SRCPT,1:"NOT ENTERED")
"RTN","SROVER2",16,0)
 I CPT K SRDES S X=$$CPTD^ICPTCOD(CPT,"SRDES") I $O(SRDES(0)) F I=1:1:X W !,?6,SRDES(I)
"RTN","SROVER2",17,0)
 I CPT,$O(^SRF(SRTN,"OPMOD",0)) D  W !,?10,SRX
"RTN","SROVER2",18,0)
 .S (SRCOMMA,SRI)=0,SRCMOD="",SRX="Modifiers:  -" F  S SRI=$O(^SRF(SRTN,"OPMOD",SRI)) Q:'SRI  D
"RTN","SROVER2",19,0)
 ..S SRM=$P(^SRF(SRTN,"OPMOD",SRI,0),"^"),SRCMOD=$P($$MOD^ICPTMOD(SRM,"I"),"^",2) K SRM
"RTN","SROVER2",20,0)
 ..S SRX=SRX_$S(SRCOMMA:",",1:"")_SRCMOD,SRCOMMA=1
"RTN","SROVER2",21,0)
 W !!,"3. Other Procedures: "_$S($O(^SRF(SRTN,13,0)):"** INFORMATION ENTERED **",1:"NO OTHER PROCEDURES HAVE BEEN ENTERED")
"RTN","SROVER2",22,0)
 S X=0 F  S X=$O(^SRF(SRTN,13,X)) Q:'X  D  S ^TMP("SRV1",$J,13,X)=$P($G(^SRF(SRTN,13,X,0)),"^")_"^"_$P($G(^SRF(SRTN,13,X,2)),"^")_"^"_Y
"RTN","SROVER2",23,0)
 .S SRJ=0,Y="" F  S SRJ=$O(^SRF(SRTN,13,X,"MOD",SRJ)) Q:'SRJ  S Y=Y_$S($L(Y):",",1:"")_^SRF(SRTN,13,X,"MOD",SRJ,0)
"RTN","SROVER2",24,0)
 I SRNON S SRTXT=$P($G(^SRF(SRTN,33)),"^",2) W !!,"4. Principal Diagnosis: "_SRTXT
"RTN","SROVER2",25,0)
 I 'SRNON S SRTXT=$P($G(^SRF(SRTN,34)),"^") W !!,"4. Postoperative Diagnosis: "_SRTXT
"RTN","SROVER2",26,0)
 S SRDIAG="NOT ENTERED",SRDX=$P($G(^SRF(SRTN,34)),"^",2) I SRDX S Y=^ICD9(SRDX,0),SRDIAG=$P(Y,"^")_"  "_$P(Y,"^",3)
"RTN","SROVER2",27,0)
 W !,"5. Principal Diagnosis Code: "_SRDIAG S ^TMP("SRV1",$J,34)=SRTXT_"^"_SRDX
"RTN","SROVER2",28,0)
 W !!,"6. Other Postop Diagnosis: "_$S($O(^SRF(SRTN,15,0)):"** INFORMATION ENTERED **",1:"NO OTHER POSTOP DIAGNOSIS HAS BEEN ENTERED")
"RTN","SROVER2",29,0)
 S X=0 F  S X=$O(^SRF(SRTN,15,X)) Q:'X  S Y=$G(^SRF(SRTN,15,X,0)),^TMP("SRV1",$J,15,X)=$P(Y,"^")_"^"_$P(Y,"^",3)
"RTN","SROVER2",30,0)
 W ! F LINE=1:1:80 W "-"
"RTN","SROVER2",31,0)
 N SRLCK S SRLCK=$$LOCK^SROUTL(SRTN) I 'SRLCK G END
"RTN","SROVER2",32,0)
 D ^SROVER3,MOD G:SRSOUT END G:'SREDIT PRINT
"RTN","SROVER2",33,0)
END K ^TMP("SRV1",$J),^TMP("SRV2",$J) S SROERR=SRTN D ^SROERR0,^SRSKILL W @IOF
"RTN","SROVER2",34,0)
 I $G(SRLCK) D UNLOCK^SROUTL(SRTN)
"RTN","SROVER2",35,0)
 Q
"RTN","SROVER2",36,0)
HDR W @IOF,!,SRNM,!,"Operation Date: "_SRSDATE,?40,"Case #",SRTN,! F I=1:1:80 W "-"
"RTN","SROVER2",37,0)
 Q
"RTN","SROVER2",38,0)
LOOP ; break procedure if greater than 45 characters
"RTN","SROVER2",39,0)
 S SROPS(M)="" F LOOP=1:1 S MM=$P(SROPER," "),MMM=$P(SROPER," ",2,200) Q:MMM=""  Q:$L(SROPS(M))+$L(MM)'<45  S SROPS(M)=SROPS(M)_MM_" ",SROPER=MMM
"RTN","SROVER2",40,0)
 Q
"RTN","SROVER2",41,0)
ORPT ; print operation/procedure report
"RTN","SROVER2",42,0)
 N SRNON S SRNON=$S($P($G(^SRF(SRTN,"NON")),"^")="Y":1,1:0) I SRNON D CODE^SRONON Q
"RTN","SROVER2",43,0)
 D CODE^SROPRPT
"RTN","SROVER2",44,0)
 Q
"RTN","SROVER2",45,0)
NRPT ; print nurse intraoperative report
"RTN","SROVER2",46,0)
 N SRNON S SRNON=$S($P($G(^SRF(SRTN,"NON")),"^")="Y":1,1:0) I SRNON W !!,?5,"Nurse Intraoperative Report NOT available on Non-OR Procedure",! D PRESS^SROVER3 W @IOF Q
"RTN","SROVER2",47,0)
 D CODE^SRONIN
"RTN","SROVER2",48,0)
 Q
"RTN","SROVER2",49,0)
MOD ; if data changed set coder verification field
"RTN","SROVER2",50,0)
 D CHECK I SRMOD S $P(^SRF(SRTN,"VER"),"^",2)=DUZ
"RTN","SROVER2",51,0)
 Q
"RTN","SROVER2",52,0)
CHECK ; check for changes to data
"RTN","SROVER2",53,0)
 S X=$P(^SRF(SRTN,"OP"),"^",1,2) D  I X'=^TMP("SRV1",$J,"OP") S SRMOD=1 Q
"RTN","SROVER2",54,0)
 .S SRJ=0,Y="" F  S SRJ=$O(^SRF(SRTN,"OPMOD",SRJ)) Q:'SRJ  S Y=Y_$S($L(Y):",",1:"")_^SRF(SRTN,"OPMOD",SRJ,0)
"RTN","SROVER2",55,0)
 .S X=X_"^"_Y
"RTN","SROVER2",56,0)
 S X=0 F  S X=$O(^SRF(SRTN,13,X)) Q:'X!SRMOD  D  S ^TMP("SRV2",$J,13,X)=$P($G(^SRF(SRTN,13,X,0)),"^")_"^"_$P($G(^SRF(SRTN,13,X,2)),"^")_"^"_Y I ^TMP("SRV2",$J,13,X)'=$G(^TMP("SRV1",$J,13,X)) S SRMOD=1 Q
"RTN","SROVER2",57,0)
 .S SRJ=0,Y="" F  S SRJ=$O(^SRF(SRTN,13,X,"MOD",SRJ)) Q:'SRJ  S Y=Y_$S($L(Y):",",1:"")_^SRF(SRTN,13,X,"MOD",SRJ,0)
"RTN","SROVER2",58,0)
 Q:SRMOD  S X=0 F  S X=$O(^TMP("SRV1",$J,13,X)) Q:'X!SRMOD  I ^TMP("SRV1",$J,13,X)'=$G(^TMP("SRV2",$J,13,X)) S SRMOD=1 Q
"RTN","SROVER2",59,0)
 Q:SRMOD  I SRNON S X=$P($G(^SRF(SRTN,33)),"^",2)_"^"_$P($G(^SRF(SRTN,34)),"^",2) I X'=^TMP("SRV1",$J,34) S SRMOD=1 Q
"RTN","SROVER2",60,0)
 I 'SRNON S X=$P($G(^SRF(SRTN,34)),"^",1,2) I X'=^TMP("SRV1",$J,34) S SRMOD=1 Q
"RTN","SROVER2",61,0)
 S X=0 F  S X=$O(^SRF(SRTN,15,X)) Q:'X!SRMOD  S Y=$G(^SRF(SRTN,15,X,0)),^TMP("SRV2",$J,15,X)=$P(Y,"^")_"^"_$P(Y,"^",3) I ^TMP("SRV2",$J,15,X)'=$G(^TMP("SRV1",$J,15,X)) S SRMOD=1 Q
"RTN","SROVER2",62,0)
 Q:SRMOD  S X=0 F  S X=$O(^TMP("SRV1",$J,15,X)) Q:'X!SRMOD  I ^TMP("SRV1",$J,15,X)'=$G(^TMP("SRV2",$J,15,X)) S SRMOD=1 Q
"RTN","SROVER2",63,0)
 Q
"RTN","SROXR1")
0^163^B10317927
"RTN","SROXR1",1,0)
SROXR1 ;B'HAM ISC/MAM - CROSS REFERENCES (CONT) ; [ 09/10/03  2:08 PM ]
"RTN","SROXR1",2,0)
 ;;3.0; Surgery ;**34,72,79,100**;24 Jun 93
"RTN","SROXR1",3,0)
AR ; 'AR' x-ref on the 'DATE OF OPERATION'
"RTN","SROXR1",4,0)
 ; field in the SURGERY file (130)
"RTN","SROXR1",5,0)
 Q:'$D(^SRF(DA,"REQ"))  I $P(^SRF(DA,"REQ"),"^")'=1 Q
"RTN","SROXR1",6,0)
 I $D(^SRF(DA,31)),$P(^(31),"^",4) Q
"RTN","SROXR1",7,0)
 S:$E(X,1,7)'<DT DFN=$P(^SRF(DA,0),"^"),^SRF("AR",$E(X,1,7),DFN,DA)=""
"RTN","SROXR1",8,0)
 Q
"RTN","SROXR1",9,0)
KAR ; 'KILL' logic of the 'AR' x-ref on the 'DATE OF
"RTN","SROXR1",10,0)
 ; OPERATION' field in the SURGERY file (130)
"RTN","SROXR1",11,0)
 S DFN=$P(^SRF(DA,0),"^") K ^SRF("AR",$E(X,1,7),DFN,DA)
"RTN","SROXR1",12,0)
 Q
"RTN","SROXR1",13,0)
SP ; set 'ASP' and 'AOR' x-refs when date is changed
"RTN","SROXR1",14,0)
 I $P(^SRF(DA,0),"^",4) S ^SRF("ASP",$P(^(0),"^",4),$E(X,1,7),DA)=DA
"RTN","SROXR1",15,0)
OR I $P(^SRF(DA,0),"^",2) S ^SRF("AOR",$P(^(0),"^",2),$E(X,1,7),DA)=""
"RTN","SROXR1",16,0)
 Q
"RTN","SROXR1",17,0)
KSP ; kill 'ASP' and 'AOR' x-refs when date is changed
"RTN","SROXR1",18,0)
 I $P(^SRF(DA,0),"^",4) K ^SRF("ASP",$P(^(0),"^",4),$E(X,1,7),DA)
"RTN","SROXR1",19,0)
KOR S DFN=$P(^SRF(DA,0),"^") I $P(^SRF(DA,0),"^",2) K ^SRF("AOR",$P(^(0),"^",2),$E(X,1,7),DA)
"RTN","SROXR1",20,0)
 Q
"RTN","SROXR1",21,0)
IV ; delete IV orders
"RTN","SROXR1",22,0)
 S SRT("X")=X D NOW^%DTC S X=SRT("X"),X1=$E(%,1,12) D MINS^SRSUTL2
"RTN","SROXR1",23,0)
 I X>1440 D OUT Q
"RTN","SROXR1",24,0)
 I X>60 D
"RTN","SROXR1",25,0)
 .D EN^DDIOL("A considerable amount of time has passed since the "_$S($P($G(^SRF(SRTN,"NON")),"^")="Y":"procedure",1:"operation")_" start",,"!!,?2")
"RTN","SROXR1",26,0)
 .D EN^DDIOL("time and the present time.",,"!,?2")
"RTN","SROXR1",27,0)
 D IV1
"RTN","SROXR1",28,0)
OUT S X=SRT("X") K SRT,X1,Y
"RTN","SROXR1",29,0)
 Q
"RTN","SROXR1",30,0)
IV1 K DIR W ! S DIR("?",1)="Enter 'YES' to cancel current IV orders. Enter 'NO' or '^' to continue",DIR("?")="without cancelling the patient's current IV orders.",DIR("B")=$S($P($G(^SRF(SRTN,"NON")),"^")="Y":"NO",1:"YES")
"RTN","SROXR1",31,0)
 S DIR("A")="Do you want to cancel all current IV orders for this patient (Y/N)",DIR(0)="Y" D ^DIR I $D(DTOUT)!(Y=0)!$D(DUOUT) Q
"RTN","SROXR1",32,0)
 S X="PSIVACT" X ^%ZOSF("TEST") Q:'$T
"RTN","SROXR1",33,0)
 S ZTDESC="Cancel IV Orders from Surgery",ZTDTH=$H,ZTIO="",ZTRTN="DCOR^SROXR1",ZTSAVE("PSIVRES")="SURGERY PACKAGE",ZTSAVE("DFN")=DFN N X,Y D ^%ZTLOAD
"RTN","SROXR1",34,0)
 Q
"RTN","SROXR1",35,0)
DCOR ; entry for tasked job to cancel IVs
"RTN","SROXR1",36,0)
 D DCOR^PSIVACT S ZTREQ="@"
"RTN","SROXR1",37,0)
 Q
"RTN","SROXR1",38,0)
END K DFN,I,S,SRSC1,SRSDAT,SRSOR
"RTN","SROXR1",39,0)
 Q
"RTN","SROXR1",40,0)
STAFF ; update STAFF/RESIDENT field
"RTN","SROXR1",41,0)
 S STAFF="R" I $D(^XUSEC("SR STAFF SURGEON",X)) S STAFF="S"
"RTN","SROXR1",42,0)
 S $P(^SRF(DA,.1),"^",3)=STAFF
"RTN","SROXR1",43,0)
 Q
"RTN","SROXR1",44,0)
KSTAFF ; update STAFF/RESIDENT when deleted
"RTN","SROXR1",45,0)
 S $P(^SRF(DA,.1),"^",3)=""
"RTN","SROXR1",46,0)
 Q
"RTN","SROXR1",47,0)
ANES ; update ANESTHETIST CATEGORY field
"RTN","SROXR1",48,0)
 N SRASITE,SRAML,SRACAT S SRASITE=$O(^SRO(133,0)) I SRASITE S SRAML=$P(^SRO(133,SRASITE,0),"^",4)
"RTN","SROXR1",49,0)
 S SRACAT=$S($D(^XUSEC("SR ANESTHESIOLOGIST",X)):"A",$D(^XUSEC("SR SURGEON",X)):"A",$D(^XUSEC("SR NURSE ANESTHETIST",X)):"N",1:"O")
"RTN","SROXR1",50,0)
 I SRACAT="A",SRAML'=$P($G(^VA(200,X,5)),"^",2) S SRACAT="O"
"RTN","SROXR1",51,0)
 S $P(^SRF(DA,.3),"^",8)=SRACAT K SRASITE,SRAML,SRACAT
"RTN","SROXR1",52,0)
 Q
"RTN","SROXR1",53,0)
KANES ; update ANESTHETIST CATEGORY when deleted
"RTN","SROXR1",54,0)
 S $P(^SRF(DA,.3),"^",8)=""
"RTN","SROXR1",55,0)
 Q
"RTN","SROXR4")
0^162^B6069696
"RTN","SROXR4",1,0)
SROXR4 ;B'HAM ISC/MAM - CROSS REFERENCES ; [ 09/09/03  6:49 AM ]
"RTN","SROXR4",2,0)
 ;;3.0; Surgery ;**62,83,100**;24 Jun 93
"RTN","SROXR4",3,0)
 Q
"RTN","SROXR4",4,0)
PRO ; stuff default prosthesis info
"RTN","SROXR4",5,0)
 I '$D(SRTN) Q
"RTN","SROXR4",6,0)
 S ^SRF(SRTN,1,DA,0)=^SRF(SRTN,1,DA,0)_"^"_$P(^SRO(131.9,X,0),"^",2,99)
"RTN","SROXR4",7,0)
 I $D(^SRO(131.9,X,1)) S ^SRF(SRTN,1,DA,1)=^(1)
"RTN","SROXR4",8,0)
 Q
"RTN","SROXR4",9,0)
CAN ; 'SET' logic of the 'ACAN' x-ref on the 'CANCEL REASON'
"RTN","SROXR4",10,0)
 ; field in the SURGERY file (130)
"RTN","SROXR4",11,0)
 S $P(^SRF(DA,30),"^",2)=$P(^SRO(135,X,0),"^",3) I $P(^SRO(135,X,0),"^",3)="" S $P(^SRF(DA,30),"^",2)="Y"
"RTN","SROXR4",12,0)
 I $P(^SRF(DA,30),"^",3)="" S $P(^SRF(DA,30),"^",3)=DUZ
"RTN","SROXR4",13,0)
 S SHEMP=$P($G(^SRF(DA,.2)),"^",10) I SHEMP,$D(^SRF(DA,"RA")) S ZTDESC="Clean up Risk Assessment Information, Canceled Case",ZTRTN="RISK^SROXR4",ZTDTH=$H,ZTSAVE("DA")="" D ^%ZTLOAD
"RTN","SROXR4",14,0)
 Q
"RTN","SROXR4",15,0)
KCAN ; 'KILL' logic of the 'ACAN' x-ref on the 'CANCEL REASON'
"RTN","SROXR4",16,0)
 ; field in the SURGERY file (130)
"RTN","SROXR4",17,0)
 S $P(^SRF(DA,30),"^",2)="" I '$P($G(^SRF(DA,30)),"^") S $P(^SRF(DA,30),"^",3)=""
"RTN","SROXR4",18,0)
 Q
"RTN","SROXR4",19,0)
AS ; 'SET' logic of the 'AS' x-ref on the SCHEDULED START TIME
"RTN","SROXR4",20,0)
 ; field in the SURGERY file (130)
"RTN","SROXR4",21,0)
 S OR=$P(^SRF(DA,0),"^",2) I 'OR Q
"RTN","SROXR4",22,0)
 S ^SRF("AS",OR,X,DA)=""
"RTN","SROXR4",23,0)
 Q
"RTN","SROXR4",24,0)
KAS ; 'KILL' logic of the 'AS' x-ref on the SCHEDULED FINISH TIME
"RTN","SROXR4",25,0)
 ; field in the SURGERY file (130)
"RTN","SROXR4",26,0)
 S OR=$P(^SRF(DA,0),"^",2) I 'OR Q
"RTN","SROXR4",27,0)
 K ^SRF("AS",OR,X,DA)
"RTN","SROXR4",28,0)
 Q
"RTN","SROXR4",29,0)
SCH ; 'SET' logic of the 'AC' x-ref of the REQUIRED FIELDS FOR SCHEDULING
"RTN","SROXR4",30,0)
 ; field in the SURGERY SITE PARAMETERS file (133)
"RTN","SROXR4",31,0)
 S MM=$O(^DD(130,"B",X,0)),$P(^SRO(133,DA(1),4,DA,0),"^",2)=MM K MM
"RTN","SROXR4",32,0)
 Q
"RTN","SROXR4",33,0)
KSCH ; 'KILL' logic of the 'AC' x-ref of the REQUIRED FIELDS FOR SCHEDULING
"RTN","SROXR4",34,0)
 ; field in the SURGERY SITE PARAMETERS file (133)
"RTN","SROXR4",35,0)
 S $P(^SRO(133,DA(1),4,DA,0),"^",2)=""
"RTN","SROXR4",36,0)
 Q
"RTN","SROXR4",37,0)
RISK ; clean up risk data for canceled cases
"RTN","SROXR4",38,0)
 S DIE=130,DR="102///@;235///@;284///@;323///@" D ^DIE K DR,DA S ZTREQ="@"
"RTN","SROXR4",39,0)
 Q
"RTN","SROXR4",40,0)
AQ ; set logic for AQ x-ref
"RTN","SROXR4",41,0)
 N SRTD D AQDT I SRTD'<2970214 S $P(^SRF(DA,.4),"^",2)="R",^SRF("AQ",SRTD,DA)=""
"RTN","SROXR4",42,0)
 Q
"RTN","SROXR4",43,0)
KAQ ; kill logic for AQ x-ref
"RTN","SROXR4",44,0)
 N SRTD D AQDT S $P(^SRF(DA,.4),"^",2)="" K ^SRF("AQ",SRTD,DA)
"RTN","SROXR4",45,0)
 Q
"RTN","SROXR4",46,0)
AQDT ; get quarterly transmission date
"RTN","SROXR4",47,0)
 N SRDAY,SRSDATE,SRQTR,SRYR S SRSDATE=$E($P(^SRF(DA,0),"^",9),1,7)
"RTN","SROXR4",48,0)
 S SRYR=$E(SRSDATE,1,3),SRDAY=$E(SRSDATE,4,7),SRQTR=$S(SRDAY<401:2,SRDAY<701:3,SRDAY<1001:4,1:1) I SRQTR=1 S SRYR=SRYR+1
"RTN","SROXR4",49,0)
 S SRTD=SRYR_$S(SRQTR=1:"0214",SRQTR=2:"0515",SRQTR=3:"0814",1:"1114")
"RTN","SROXR4",50,0)
 Q
"RTN","SROXR4",51,0)
AQ1 ; set logic for AQ1 x-ref
"RTN","SROXR4",52,0)
 I X="R" N SRTD D AQDT I SRTD'<2970214 S ^SRF("AQ",SRTD,DA)=""
"RTN","SROXR4",53,0)
 Q
"RTN","SROXR4",54,0)
KAQ1 ; kill logic for AQ1 x-ref
"RTN","SROXR4",55,0)
 N SRTD D AQDT K ^SRF("AQ",SRTD,DA)
"RTN","SROXR4",56,0)
 Q
"RTN","SRSBTCH")
1^111
"RTN","SRSCAN")
0^91^B10909174
"RTN","SRSCAN",1,0)
SRSCAN ;B'HAM ISC/MAM - CANCEL SCHEDULED OPERATION ; [ 01/30/01  2:16 PM ]
"RTN","SRSCAN",2,0)
 ;;3.0; Surgery ;**100**;24 Jun 93
"RTN","SRSCAN",3,0)
 S SRSOUT=0 W ! K DIC S DIC=2,DIC(0)="AEQM",DIC("A")="Cancel a Scheduled Procedure for which Patient: " D ^DIC K DIC I Y<0 S SRSOUT=1 G END
"RTN","SRSCAN",4,0)
 S DFN=+Y D DEM^VADPT S SRNAME=VADM(1)_" ("_VA("PID")_")" W @IOF,!,SRNAME,!
"RTN","SRSCAN",5,0)
LOOK W ! S (SRTN,CNT)=0 F I=0:0 S SRTN=$O(^SRF("B",DFN,SRTN)) Q:SRTN=""  S CNT=CNT+1,SROP1(CNT)=SRTN D LIST
"RTN","SRSCAN",6,0)
 I '$D(SROP1(1)) D DEM^VADPT W !!,"There are no procedures scheduled for "_VADM(1)_".",!! W !!,"Press RETURN to continue  " R X:DTIME G END
"RTN","SRSCAN",7,0)
ASK R !!,"Select Number: ",SRNUM:DTIME I '$T!("^"[SRNUM) G END
"RTN","SRSCAN",8,0)
 I SRNUM["?" W !!,"Enter the number which corresponds to the case that you want to cancel." G ASK
"RTN","SRSCAN",9,0)
 I '$D(SROP1(SRNUM)) W !!,"You have entered an invalid number, please select again. " G ASK
"RTN","SRSCAN",10,0)
 S (SRTN,SRTOLD)=SROP1(SRNUM)
"RTN","SRSCAN",11,0)
 I $D(^SRF(SRTN,.2)),$P(^(.2),"^",2)'="" W !!,$C(7),"This operation already has a start time and cannot be cancelled.",!!,"Press RETURN to continue  " R X:DTIME G END
"RTN","SRSCAN",12,0)
 I $P(^SRF(SRTN,31),"^",4)="" W !!,"This operation is not scheduled." H 1 G END
"RTN","SRSCAN",13,0)
 D ^SRSCAN1
"RTN","SRSCAN",14,0)
OK R !!,"Is this the correct operation ?  YES//  ",SRYN:DTIME I '$T!(SRYN["^") G END
"RTN","SRSCAN",15,0)
 S SRYN=$E(SRYN) I "YyNn"'[SRYN W !!,"Enter RETURN if this is the scheduled procedure that you want",!,"to cancel, or 'NO' to quit this option." G OK
"RTN","SRSCAN",16,0)
 I "Yy"'[SRYN G END
"RTN","SRSCAN",17,0)
 I $$LOCK^SROUTL(SRTN) D ^SRSCAN0
"RTN","SRSCAN",18,0)
END D ^SRSKILL K SRTN W @IOF
"RTN","SRSCAN",19,0)
 Q
"RTN","SRSCAN",20,0)
OTHER ; other operations
"RTN","SRSCAN",21,0)
 S SRLONG=1 I $L(SROPER)+$L($P(^SRF(SRTN,13,OPER,0),"^"))>235 S SRLONG=0,OPER=999,SROPERS=" ..."
"RTN","SRSCAN",22,0)
 I SRLONG S SROPERS=$P(^SRF(SRTN,13,OPER,0),"^")
"RTN","SRSCAN",23,0)
 S SROPER=SROPER_$S(SROPERS=" ...":SROPERS,1:", "_SROPERS)
"RTN","SRSCAN",24,0)
 Q
"RTN","SRSCAN",25,0)
LOOP ; break procedure if greater than 60 characters
"RTN","SRSCAN",26,0)
 S SROPS(M)="" F LOOP=1:1 S MM=$P(SROPER," "),MMM=$P(SROPER," ",2,200) Q:MMM=""  Q:$L(SROPS(M))+$L(MM)'<60  S SROPS(M)=SROPS(M)_MM_" ",SROPER=MMM
"RTN","SRSCAN",27,0)
 Q
"RTN","SRSCAN",28,0)
LIST ; list cases
"RTN","SRSCAN",29,0)
 S SRSDATE=$P(^SRF(SRTN,0),"^",9),SRSDATE=$E(SRSDATE,4,5)_"/"_$E(SRSDATE,6,7)_"/"_$E(SRSDATE,2,3)
"RTN","SRSCAN",30,0)
OPS S SROPER=$P(^SRF(SRTN,"OP"),"^"),OPER=0 F I=0:0 S OPER=$O(^SRF(SRTN,13,OPER)) Q:OPER=""  D OTHER
"RTN","SRSCAN",31,0)
 S SROP=SRTN D ^SROP1
"RTN","SRSCAN",32,0)
 I SROPER'["SCHEDULED" K SROP1(CNT) S CNT=CNT-1 Q
"RTN","SRSCAN",33,0)
 K SROPS,MM,MMM S:$L(SROPER)<60 SROPS(1)=SROPER I $L(SROPER)>59 S SROPER=SROPER_"  " F M=1:1 D LOOP Q:MMM=""
"RTN","SRSCAN",34,0)
 W !,CNT_".  "_SRSDATE,?15,SROPS(1) I $D(SROPS(2)) W !,?15,SROPS(2) I $D(SROPS(3)) W !,?15,SROPS(3) I $D(SROPS(4)) W !,?15,SROPS(4) I $D(SROPS(5)) W !,?15,SROPS(5)
"RTN","SRSCAN0")
0^92^B15413492
"RTN","SRSCAN0",1,0)
SRSCAN0 ;B'HAM ISC/MAM - CANCEL SCHEDULED OPERATIONS (CONT) ; [ 03/21/02  10:24 PM ]
"RTN","SRSCAN0",2,0)
 ;;3.0; Surgery ;**34,42,67,103,107,114,100**;24 Jun 93
"RTN","SRSCAN0",3,0)
 ;
"RTN","SRSCAN0",4,0)
 ; Reference to ^TMP("CSLSUR1" supported by DBIA #3498
"RTN","SRSCAN0",5,0)
 ;
"RTN","SRSCAN0",6,0)
CUT S X1=SRSDATE,X2=-1 D C^%DTC S SRSDT=X,X=$P($G(^SRO(133,SRSITE,0)),"^",12) S SRTIME=SRSDT_"."_$S(X'="":X,1:1500)
"RTN","SRSCAN0",7,0)
 S SRTYPE=$P(^SRF(SRTN,0),"^",10) I SRTYPE="S" W !!,"Case schedule type is STANDBY. "
"RTN","SRSCAN0",8,0)
 D NOW^%DTC S SRN=+$E(%,1,12) I SRTYPE'="S",SRN'<SRTIME G SWAP
"RTN","SRSCAN0",9,0)
 S SRBOTH=0 I $P($G(^SRF(SRTN,"CON")),"^") S SRBOTH=1
"RTN","SRSCAN0",10,0)
REQ I 'SRBOTH D ^SRSCG
"RTN","SRSCAN0",11,0)
 S SRSCHST=$P($G(^SRF(SRTN,31)),"^",4) K:SRSCHST&SRSOR ^SRF("AMM",SRSOR,SRSCHST,SRTN)
"RTN","SRSCAN0",12,0)
 S $P(^SRF(SRTN,31),"^",4)="",$P(^SRF(SRTN,31),"^",5)="",^SRF(SRTN,"REQ")=1,^SRF("AR",SRSDATE,DFN,SRTN)=""
"RTN","SRSCAN0",13,0)
 K DR S DA=SRTN,DR=".02///@",DIE=130 D ^DIE K DR D OERR
"RTN","SRSCAN0",14,0)
 I '$P($G(^SRF(SRTN,"1.0")),"^",11) D
"RTN","SRSCAN0",15,0)
 .N SREQ
"RTN","SRSCAN0",16,0)
 .S SREQ(130,SRTN_",",1.098)=+SRN,SREQ(130,SRTN_",",1.099)=DUZ
"RTN","SRSCAN0",17,0)
 .D FILE^DIE("","SREQ","^TMP(""SR"",$J)")
"RTN","SRSCAN0",18,0)
 W !!,"Case #"_SRTN_" has been removed from the schedule and changed to a request."
"RTN","SRSCAN0",19,0)
 I SRBOTH G ASK
"RTN","SRSCAN0",20,0)
PRESS W ! K DIR S DIR(0)="E" D ^DIR
"RTN","SRSCAN0",21,0)
 Q
"RTN","SRSCAN0",22,0)
ASK S SRBOTH=0 W !!,"There is a concurrent case associated with this operation.  Do you want to",!,"remove it from the schedule also ? YES// " R SRYN:DTIME I '$T!(SRYN["^") S SRYN="N"
"RTN","SRSCAN0",23,0)
 S SRYN=$E(SRYN) S:SRYN="" SRYN="Y"
"RTN","SRSCAN0",24,0)
 I "YyNn"'[SRYN W !!,"If you want to remove both cases from the schedule, enter 'YES'.  If you",!,"answer 'NO', the cases will no longer be associated with each other." G ASK
"RTN","SRSCAN0",25,0)
 I "Yy"[SRYN S SRTN=$P(^SRF(SRTN,"CON"),"^") G REQ
"RTN","SRSCAN0",26,0)
NOCC ; no longer concurrent cases
"RTN","SRSCAN0",27,0)
 S DA=$P(^SRF(SRTN,"CON"),"^"),DIE=130,DR="35///@" D ^DIE S SROERR=DA D ^SROERR0 S DA=SRTN D ^DIE,OERR,UNLOCK^SROUTL(DA)
"RTN","SRSCAN0",28,0)
 Q
"RTN","SRSCAN0",29,0)
SWAP ; move data into a new entry and set up the cancel date in the old
"RTN","SRSCAN0",30,0)
 W ! K DIR S DIR(0)="130,18",DIR("A")="Cancellation Reason" D ^DIR S SRSCAN=$P(Y,"^") I $D(DIRUT) W !!,"Case NOT cancelled." D PRESS G END
"RTN","SRSCAN0",31,0)
 K DR S SRCON=0,DA=SRTN,DR=".02///@;102///@;235///@;284///@;323///@;18////"_SRSCAN_";67T;70////"_DUZ,DIE=130 D ^DIE S:$D(DTOUT)!$D(DUOUT) SRSOUT=1
"RTN","SRSCAN0",32,0)
 S SRSCHST=$P($G(^SRF(SRTN,31)),"^",4),AVOID=$P(^(30),"^",2)
"RTN","SRSCAN0",33,0)
 I '$P($G(^SRF(SRTN,"CON")),"^") D ^SRSCG
"RTN","SRSCAN0",34,0)
 S SRSDPT=$P(^SRF(SRTN,0),"^"),SRSOP=$P(^SRF(SRTN,"OP"),"^")
"RTN","SRSCAN0",35,0)
 S SRSSET=$P(^SRF(SRTN,31),"^",5),$P(^SRF(SRTN,31),"^",4)="",$P(^SRF(SRTN,31),"^",5)=""
"RTN","SRSCAN0",36,0)
SWAP2 K:SRSCHST&SRSOR ^SRF("AMM",SRSOR,SRSCHST,SRTN) D NOW^%DTC S $P(^SRF(SRTN,30),"^")=$E(%,1,12)
"RTN","SRSCAN0",37,0)
 I '$P($G(^SRF(SRTN,"CON")),"^") D OERR
"RTN","SRSCAN0",38,0)
 I SRSCAN'="" G:$P(^SRO(135,SRSCAN,0),"^",2)="D" CON
"RTN","SRSCAN0",39,0)
 D:'SRSOUT ^SRSCAN2
"RTN","SRSCAN0",40,0)
CON I '$D(SRSCC),$D(^SRF(SRTN,"CON")),$P(^("CON"),"^")'="" D CANCC^SRSUTL2 Q:SRBOTH="^"!SRSOUT  I SRBOTH=1 G CON1
"RTN","SRSCAN0",41,0)
 I SRCON'=0,SRTNEW'=SRCON K DR S DA=SRTNEW,DIE=130,DR="35////"_SRCON D ^DIE S DA=SRCON,DR="35////"_SRTNEW D ^DIE K DR S SROERR=SRCON D ^SROERR0
"RTN","SRSCAN0",42,0)
 I $G(SRDEAD)=0,$G(SRBOTH)=1,$G(SRSCC)=1 S SROERR=$P(^SRF(SRTN,"CON"),"^") D ^SROERR0 S SROERR=SRTN,^TMP("CSLSUR1",$J)="" D ^SROERR0
"RTN","SRSCAN0",43,0)
END D UNLOCK^SROUTL(SRTN),^SRSKILL K SRTN W @IOF
"RTN","SRSCAN0",44,0)
 Q
"RTN","SRSCAN0",45,0)
CON1 I SRDEAD=0 G SWAP2
"RTN","SRSCAN0",46,0)
 K DR S DA=SRTN,DR=".02///@;102///@;235///@;284///@;323///@;18///"_$P(^SRO(135,SRSCAN,0),"^")_";67///"_AVOID_";70////"_DUZ,DIE=130 D ^DIE
"RTN","SRSCAN0",47,0)
 D NOW^%DTC S $P(^SRF(SRTN,30),"^")=$E(%,1,12),$P(^SRF(SRTN,31),"^",4)="",$P(^SRF(SRTN,31),"^",5)=""
"RTN","SRSCAN0",48,0)
OERR ; update ORDER file (100)
"RTN","SRSCAN0",49,0)
 S SROERR=SRTN K SRTX D ^SROERR0
"RTN","SRSCAN0",50,0)
 Q
"RTN","SRSCHCA")
0^93^B8640617
"RTN","SRSCHCA",1,0)
SRSCHCA ;B'HAM ISC/ADM - ADD CONCURRENT CASE TO ALREADY SCHEDULED CASE ; 26 MAY 1992  4:20 PM
"RTN","SRSCHCA",2,0)
 ;;3.0; Surgery ;**114,100**;24 Jun 93
"RTN","SRSCHCA",3,0)
 D ^SRSTCH I SRSOUT W !!,"No concurrent case has been added.",! S SRSOUT=0 G END
"RTN","SRSCHCA",4,0)
 S SRSCON=2,SRCC=1,SRSDATE=$P(^SRF(SRTN,0),"^",9),SRSOR=$P(^SRF(SRTN,0),"^",2),SRSDT1=$P(^(31),"^",4),SRSDT2=$P(^(31),"^",5)
"RTN","SRSCHCA",5,0)
 S Y=SRSDATE D D^DIQ S (SREQDT,SRSDT)=$E(Y,1,12)
"RTN","SRSCHCA",6,0)
 S SRSCON(1)=SRTN,SRSCON(1,"OP")=$P(^SRF(SRTN,"OP"),"^"),SRSCON(1,"DOC")=$P(^VA(200,$P(^SRF(SRTN,.1),"^",4),0),"^"),SRSCON(1,"SS")=$P(^SRO(137.45,$P(^SRF(SRTN,0),"^",4),0),"^")
"RTN","SRSCHCA",7,0)
 D CON^SRSCHUN I SRSOUT  W !!,"No concurrent case has been added.",! S SRSOUT=0 G END
"RTN","SRSCHCA",8,0)
 I $$LOCK^SROUTL(SRTN) D ^SRSCHUN1,UNLOCK^SROUTL(SRTN)
"RTN","SRSCHCA",9,0)
DISP W @IOF,!,"The following cases have been entered."
"RTN","SRSCHCA",10,0)
 S CON=0 F  S CON=$O(SRSCON(CON)) Q:'CON  D LIST
"RTN","SRSCHCA",11,0)
 W !!!!,"1. Enter Information for Case #"_SRSCON(1),!,"2. Enter Information for Case #"_SRSCON(2),!
"RTN","SRSCHCA",12,0)
REQ K DIR S DIR("?")=" ",DIR("?",1)="Select the number corresponding to the case for which you want",DIR("?",2)="to enter information.  Enter '^' or RETURN to exit."
"RTN","SRSCHCA",13,0)
 S DIR(0)="NO^1:2",DIR("A")="Select Number" D ^DIR I Y=""!$D(DUOUT) S SRSOUT=1 G END
"RTN","SRSCHCA",14,0)
 S SRSCON=Y,(DA,SRTN)=SRSCON(SRSCON) I $$LOCK^SROUTL(SRTN) D SS^SRSCHUN1,UNLOCK^SROUTL(SRTN)
"RTN","SRSCHCA",15,0)
 G DISP
"RTN","SRSCHCA",16,0)
END I 'SRSOUT K DIR S DIR(0)="FOA",DIR("A")=" Press RETURN to continue. " D ^DIR
"RTN","SRSCHCA",17,0)
 K SRTN D ^SRSKILL W @IOF
"RTN","SRSCHCA",18,0)
 Q
"RTN","SRSCHCA",19,0)
LIST ; list stub info
"RTN","SRSCHCA",20,0)
 S SROPER=$P(^SRF(SRSCON(CON),"OP"),"^") K SROPS,MM,MMM S:$L(SROPER)<60 SROPS(1)=SROPER I $L(SROPER)>59 S SROPER=SROPER_"  " F M=1:1 D LOOP Q:MMM=""
"RTN","SRSCHCA",21,0)
 W !!,CON_". ",?4,"Case # "_SRSCON(CON),?40,SRSDT,!,?4,"Surgeon: "_SRSCON(CON,"DOC"),?40,SRSCON(CON,"SS"),!,?4,"Procedure: ",?16,SROPS(1) I $D(SROPS(2)) W !,?16,SROPS(2) I $D(SROPS(3)) W !,?16,SROPS(3)
"RTN","SRSCHCA",22,0)
 Q
"RTN","SRSCHCA",23,0)
LOOP ; break procedure if greater than 60 characters
"RTN","SRSCHCA",24,0)
 S SROPS(M)="" F LOOP=1:1 S MM=$P(SROPER," "),MMM=$P(SROPER," ",2,200) Q:MMM=""  Q:$L(SROPS(M))+$L(MM)'<60  S SROPS(M)=SROPS(M)_MM_" ",SROPER=MMM
"RTN","SRSCHCA",25,0)
 Q
"RTN","SRSCHD")
0^94^B8354843
"RTN","SRSCHD",1,0)
SRSCHD ;B'HAM ISC/MAM - SCHEDULING UNREQUESTED CASES ; [ 02/25/02  7:27 AM ]
"RTN","SRSCHD",2,0)
 ;;3.0; Surgery ;**77,100**;24 Jun 93
"RTN","SRSCHD",3,0)
BEG W @IOF S SRSOUT=0
"RTN","SRSCHD",4,0)
 K SRSDATE W ! S (SRNOREQ,SRSCHD,SRSC1)=1,ST="SCHEDULING"
"RTN","SRSCHD",5,0)
 K %DT S %DT="AEFX",%DT("A")="Schedule a Procedure for which Date ?  " D ^%DT I Y<0 W !!,"The schedule cannot be updated without a date.",!! G END
"RTN","SRSCHD",6,0)
 S SRSDATE=+Y I SRSDATE<DT W !!,"Reservations cannot be made for dates in the past.  Please select another date.",!!,"Press RETURN to continue  " R X:DTIME G BEG
"RTN","SRSCHD",7,0)
 S X=SRSDATE D H^%DTC S SRDAY=%Y+1 S SRDL=$P($G(^SRO(133,SRSITE,2)),"^",SRDAY) S:SRDL="" SRDL=1
"RTN","SRSCHD",8,0)
 I 'SRDL W !!,"Scheduling not allowed for "_$S(SRDAY=1:"SUNDAY",SRDAY=2:"MONDAY",SRDAY=3:"TUESDAY",SRDAY=4:"WEDNESDAY",SRDAY=5:"THURSDAY",SRDAY=6:"FRIDAY",1:"SATURDAY")_" !!",!!!,"Press RETURN to continue  " R X:DTIME G BEG
"RTN","SRSCHD",9,0)
 K SRY S DIC=40.5,DR=".01;2",DA=SRSDATE,DIQ="SRY",DIQ(0)="E" D EN^DIQ1
"RTN","SRSCHD",10,0)
 I $D(SRY(40.5,SRSDATE,.01,"E")),'$D(^SRO(133,SRSITE,3,SRSDATE,0)) W !!,"Scheduling not allowed for "_$G(SRY(40.5,SRSDATE,2,"E"))_" !!",!!!,"Press RETURN to continue  " R X:DTIME G BEG
"RTN","SRSCHD",11,0)
 S Y=SRSDATE D D^DIQ S SREQDT=Y
"RTN","SRSCHD",12,0)
 W ! S DIC=2,DIC("A")="Select Patient: ",DIC(0)="QEAMZ" D ^DIC K DIC G:Y<0 END S (DFN,SRSDPT)=+Y D DEM^VADPT S SRNM=VADM(1),SRSSN=VA("PID")
"RTN","SRSCHD",13,0)
 I $D(^DPT(SRSDPT,.35)),$P(^(.35),"^")'="" S Y=$E($P(^(.35),"^"),1,7) D D^DIQ W !!,"The records show that "_SRNM_" died on "_Y_".",! G END
"RTN","SRSCHD",14,0)
OR D ^SRSCHOR I SRSOUT W !!,"No surgical case has been scheduled.",! S SRSOUT=0 G END
"RTN","SRSCHD",15,0)
 D ^SRSCHUN I SRSOUT S SRSOUT=0 G END
"RTN","SRSCHD",16,0)
 I $$LOCK^SROUTL(SRTN) D ^SRSCHUN1,UNLOCK^SROUTL(SRTN)
"RTN","SRSCHD",17,0)
END ;
"RTN","SRSCHD",18,0)
 I 'SRSOUT K DIR S DIR(0)="FOA",DIR("A")=" Press RETURN to continue. " D ^DIR
"RTN","SRSCHD",19,0)
 D ^SRSKILL K SRTN,SRLCK W @IOF
"RTN","SRSCHD",20,0)
 Q
"RTN","SRSCHD1")
0^95^B8338471
"RTN","SRSCHD1",1,0)
SRSCHD1 ;B'HAM ISC/MAM - SCHEDULE REQUESTED OPERATIONS (CONT) ; [ 01/31/01  7:52 AM ]
"RTN","SRSCHD1",2,0)
 ;;3.0; Surgery ;**37,100**;24 Jun 93
"RTN","SRSCHD1",3,0)
REQ ; select request
"RTN","SRSCHD1",4,0)
 K SRCASE,SRTN W ! S SRSCHED=1 D ASK^SRSUPRQ G:'$D(SRTN) END
"RTN","SRSCHD1",5,0)
 I $D(^DPT(SRDFN,.35)),$P(^(.35),"^")'="" S Y=$E($P(^(.35),"^"),1,7) D D^DIQ W !!,"The records show that "_SRNM_" died on "_Y_".",!!,"Press RETURN to continue  " R X:DTIME G END
"RTN","SRSCHD1",6,0)
UN S DFN=SRDFN,SRSOP=$P(^SRF(SRTN,"OP"),"^")
"RTN","SRSCHD1",7,0)
 S SRSDOC=$P($G(^SRF(SRTN,.1)),"^",4)
"RTN","SRSCHD1",8,0)
 S SROPER=SRSOP K SROPS,MM,MMM S:$L(SROPER)<75 SROPS(1)=SROPER I $L(SROPER)>74 S SROPER=SROPER_"  " F M=1:1 D LOOP Q:MMM=""
"RTN","SRSCHD1",9,0)
 W !!!,"Case Information: ",!,SROPS(1) I $D(SROPS(2)) W !,SROPS(2) I $D(SROPS(3)) W !,SROPS(3)
"RTN","SRSCHD1",10,0)
 W !,"By " S USER=$S(SRSDOC:$P(^VA(200,SRSDOC,0),"^"),1:"NOT ENTERED") W USER D DEM^VADPT W ?40,"On "_VADM(1),!,"Case # "_SRTN
"RTN","SRSCHD1",11,0)
 S HOURS=$P($G(^SRF(SRTN,.4)),"^") I HOURS W ?40,"For "_HOURS_" Hours"
"RTN","SRSCHD1",12,0)
 S Z=$P(^SRF(SRTN,0),"^",10) I Z'="" S SRSTYP=$S(Z="EL":"ELECTIVE",Z="EM":"EMERGENCY",Z="A":"ADD ON TODAY (NONEMERGENT)",Z="S":"STANDBY",Z="U":"URGENT ADD ON TODAY",1:"")
"RTN","SRSCHD1",13,0)
 W !,$S($D(SRSTYP):SRSTYP,1:""),?40,$P(^SRF(SRTN,0),"^",11)
"RTN","SRSCHD1",14,0)
 W !!,"Comments:" S COMMENT=0 F  S COMMENT=$O(^SRF(SRTN,5,COMMENT)) Q:'COMMENT  W !,^SRF(SRTN,5,COMMENT,0)
"RTN","SRSCHD1",15,0)
 I $D(^SRF(SRTN,"CON")),$P(^("CON"),"^") S SRCON=$P(^("CON"),"^") W !!,"  * Concurrent Case # "_SRCON_"  "_$P(^SRF(SRCON,"OP"),"^")
"RTN","SRSCHD1",16,0)
SEL W !!,"Is this the correct operation ?  YES//  " R SRYN:DTIME S:'$T SRYN="^" G:SRYN["^" END S SRYN=$E(SRYN) S:SRYN="" SRYN="Y"
"RTN","SRSCHD1",17,0)
 I "NnYn"'[SRYN W !!,"Enter 'NO' if you have selected the wrong request, or RETURN to continue",!,"scheduling this request. ",! G SEL
"RTN","SRSCHD1",18,0)
 I "Yy"'[SRYN G END
"RTN","SRSCHD1",19,0)
 K NOWAY D ^SRSCHK I $D(NOWAY) G END
"RTN","SRSCHD1",20,0)
 I $$LOCK^SROUTL(SRTN) D ^SRSCHD2,UNLOCK^SROUTL(SRTN)
"RTN","SRSCHD1",21,0)
 G REQ
"RTN","SRSCHD1",22,0)
END ;
"RTN","SRSCHD1",23,0)
 K SRTN D ^SRSKILL W @IOF
"RTN","SRSCHD1",24,0)
 Q
"RTN","SRSCHD1",25,0)
LOOP ; break procedure if greater than 75 characters
"RTN","SRSCHD1",26,0)
 S SROPS(M)="" F LOOP=1:1 S MM=$P(SROPER," "),MMM=$P(SROPER," ",2,200) Q:MMM=""  Q:$L(SROPS(M))+$L(MM)'<75  S SROPS(M)=SROPS(M)_MM_" ",SROPER=MMM
"RTN","SRSCHD1",27,0)
 Q
"RTN","SRSCHDA")
0^96^B15325707
"RTN","SRSCHDA",1,0)
SRSCHDA ;B'HAM ISC/MAM - SCHEDULE ANESTHESIA PERSONNEL ; [ 01/31/01  7:58 AM ]
"RTN","SRSCHDA",2,0)
 ;;3.0; Surgery ;**77,50,100**;24 Jun 93
"RTN","SRSCHDA",3,0)
 I $D(SRTN) S SRCASE=SRTN
"RTN","SRSCHDA",4,0)
DATE W ! K %DT S %DT="AEFX",%DT("A")="Schedule Anesthesia Personnel for which Date ?  " D ^%DT G:Y<0 END S SRSDATE=+Y K %DT
"RTN","SRSCHDA",5,0)
 S X1=SRSDATE,X2="+1" D C^%DTC S SRSD1=X
"RTN","SRSCHDA",6,0)
OR W ! K DIC S SRZ=0,DIC("S")="I $$ORDIV^SROUTL0(+Y,$G(SRSITE(""DIV""))),'$P(^(0),""^"",6)",DIC=131.7,DIC(0)="QEAMZ",DIC("A")="Schedule Anesthesia Personnel for which Operating Room ?  " D ^DIC G:Y<0 END S SROR=+Y,SROR("N")=Y(0,0)
"RTN","SRSCHDA",7,0)
 I '$O(^SRF("AMM",SROR,SRSDATE-.0001))!($O(^SRF("AMM",SROR,SRSDATE-.0001))>SRSD1) W !!,"There are no cases scheduled for this operating room. ",!!,"Press RETURN to continue  " R X:DTIME
"RTN","SRSCHDA",8,0)
 S (SRANES(1),SRANES(2))=""
"RTN","SRSCHDA",9,0)
 S SRSD=SRSDATE-.0001 F  S SRSD=$O(^SRF("AMM",SROR,SRSD)) Q:'SRSD!(SRSD>SRSD1)  S SRTN=0 F  S SRTN=$O(^SRF("AMM",SROR,SRSD,SRTN)) Q:'SRTN  D LIST
"RTN","SRSCHDA",10,0)
 W @IOF
"RTN","SRSCHDA",11,0)
AGAIN W !!,"Would you like to continue with another operating room ?  YES// " R X:DTIME S:'$T X="^" I X["?" W !!,"Enter RETURN if you would like to schedule anesthesia personnel in another",!,"room, or 'NO' to quit." G AGAIN
"RTN","SRSCHDA",12,0)
 I X["^" G END
"RTN","SRSCHDA",13,0)
 S X=$E(X) I "YyNn"'[X W !!,"Please answer 'YES' or 'NO'." G AGAIN
"RTN","SRSCHDA",14,0)
 I "Yy"[X G OR
"RTN","SRSCHDA",15,0)
END K SRTN I $D(SRCASE) S SRTN=SRCASE
"RTN","SRSCHDA",16,0)
 D ^SRSKILL W @IOF
"RTN","SRSCHDA",17,0)
 Q
"RTN","SRSCHDA",18,0)
LIST ; set variables and list case
"RTN","SRSCHDA",19,0)
 Q:SRZ  K SROPS,MM,MMM S DFN=$P(^SRF(SRTN,0),"^") D DEM^VADPT S SRNM=VADM(1),SROPER=$P(^SRF(SRTN,"OP"),"^") S:$L(SROPER)<70 SROPS(1)=SROPER I $L(SROPER)>69 S SROPER=SROPER_"  " F M=1:1 D LOOP Q:MMM=""
"RTN","SRSCHDA",20,0)
 S SRST=$P(^SRF(SRTN,31),"^",4),SRET=$P(^(31),"^",5),SRST=$P(SRST,".",2)_"0000",SRST=$E(SRST,1,2)_":"_$E(SRST,3,4),SRET=$P(SRET,".",2)_"0000",SRET=$E(SRET,1,2)_":"_$E(SRET,3,4)
"RTN","SRSCHDA",21,0)
 W @IOF,!!,"Scheduled Operations for "_SROR("N"),! F LINE=1:1:80 W "-"
"RTN","SRSCHDA",22,0)
 W !!,"Case # "_SRTN_"   Patient: "_SRNM,!,"From: "_SRST_"  To: "_SRET,!,SROPS(1) I $D(SROPS(2)) W !,?5,SROPS(2) I $D(SROPS(3)) W !,?5,SROPS(3)
"RTN","SRSCHDA",23,0)
 K DR,SRODR
"RTN","SRSCHDA",24,0)
 I '$$LOCK^SROUTL(SRTN) G MORE
"RTN","SRSCHDA",25,0)
 W !! S DA=SRTN,DIE=130,DR="1.01T;.31T//"_SRANES(1)_";S SRANES(1)=$S(X:$P(^VA(200,X,0),""^""),1:X);.34T//"_SRANES(2)_";S SRANES(2)=$S(X:$P(^VA(200,X,0),""^""),1:X)" D ^DIE K DR
"RTN","SRSCHDA",26,0)
 I $D(SRODR) S SRNOCON=1 D ^SROCON1 K SRNOCON
"RTN","SRSCHDA",27,0)
 D UNLOCK^SROUTL(SRTN)
"RTN","SRSCHDA",28,0)
MORE W !!!,"Press RETURN to continue, or '^' to quit:  " R X:DTIME S:'$T X="^" I X["?" W !!,"Enter RETURN to continue scheduling other cases, or '^' to leave this option.",!! G MORE
"RTN","SRSCHDA",29,0)
 I X["^" S SRZ=1
"RTN","SRSCHDA",30,0)
 Q
"RTN","SRSCHDA",31,0)
LOOP ; break procedure if greater than 70 characters
"RTN","SRSCHDA",32,0)
 S SROPS(M)="" F LOOP=1:1 S MM=$P(SROPER," "),MMM=$P(SROPER," ",2,200) Q:MMM=""  Q:$L(SROPS(M))+$L(MM)'<70  S SROPS(M)=SROPS(M)_MM_" ",SROPER=MMM
"RTN","SRSCHDA",33,0)
 Q
"RTN","SRSCHDC")
0^97^B20574310
"RTN","SRSCHDC",1,0)
SRSCHDC ;B'HAM ISC/MAM - SCHEDULE CONCURRENT CASES ; [ 02/25/02  7:47 AM ]
"RTN","SRSCHDC",2,0)
 ;;3.0; Surgery ;**67,77,100**;24 Jun 93
"RTN","SRSCHDC",3,0)
 W @IOF,! S SRCC=1,SRSOUT=0 K DIC S DIC=2,DIC(0)="QEAMZ",DIC("A")="Schedule Concurrent Cases for which Patient ?  " D ^DIC K DIC I Y<0 S SRSOUT=1 G END
"RTN","SRSCHDC",4,0)
 S (DFN,SRSDPT)=+Y D DEM^VADPT S SRNM=VADM(1),SRSSN=VA("PID")
"RTN","SRSCHDC",5,0)
DEAD I $D(^DPT(SRSDPT,.35)),$P(^(.35),"^")'="" S Y=$E($P(^(.35),"^"),1,7) D D^DIQ W !!,"The records show that "_SRNM_" died on "_Y_".",!! G END
"RTN","SRSCHDC",6,0)
DATE W ! K SRDUOUT,%DT,SRSDATE S %DT="AEFX",%DT("A")="Schedule Concurrent Procedures for which Date ?  " D ^%DT I Y<0 S SRSOUT=1 G END
"RTN","SRSCHDC",7,0)
 I Y<DT W !!,"Cases cannot be scheduled for past dates.  Please enter a different date.",! G DATE
"RTN","SRSCHDC",8,0)
 S (SRSDATE,X)=+Y D H^%DTC S SRDAY=%Y+1 S SRDL=$P($G(^SRO(133,SRSITE,2)),"^",SRDAY) S:SRDL="" SRDL=1
"RTN","SRSCHDC",9,0)
 I 'SRDL W !!,"Scheduling not allowed for "_$S(SRDAY=1:"SUNDAY",SRDAY=2:"MONDAY",SRDAY=3:"TUESDAY",SRDAY=4:"WEDNESDAY",SRDAY=5:"THURSDAY",SRDAY=6:"FRIDAY",1:"SATURDAY")_" !!",!! G DATE
"RTN","SRSCHDC",10,0)
 K SRY S DIC=40.5,DR=".01;2",DA=SRSDATE,DIQ="SRY",DIQ(0)="E" D EN^DIQ1
"RTN","SRSCHDC",11,0)
 I $D(SRY(40.5,SRSDATE,.01,"E")),'$D(^SRO(133,SRSITE,3,SRSDATE,0)) W !!,"Scheduling not allowed for "_$G(SRY(40.5,SRSDATE,2,"E"))_" !!",!! G DATE
"RTN","SRSCHDC",12,0)
 S Y=SRSDATE D D^DIQ S (SREQDT,SRSDT)=Y,ST="SCHEDULING"
"RTN","SRSCHDC",13,0)
OR D ^SRSCHOR I SRSOUT W !!,"No surgical case has been scheduled.",! S SRSOUT=0 G END
"RTN","SRSCHDC",14,0)
 K SRTN F SRSCON=1,2 D CON^SRSCHUN I SRSOUT,SRSCON=1 Q
"RTN","SRSCHDC",15,0)
 I SRSOUT,SRSCON=1 W !!,"No surgical case has been scheduled.",! S SRTN("OR")=SRSOR,SRTN("START")=SRSDT1,SRTN("END")=SRSDT2,SRSEDT=$E(SRSDT2,1,7) D ^SRSCG S SRSOUT=0 G END
"RTN","SRSCHDC",16,0)
 I SRSOUT,SRSCON=2 K SRSCON(2) D DEL I SRSOUT G END
"RTN","SRSCHDC",17,0)
DISP W @IOF,!,"The following cases have been entered."
"RTN","SRSCHDC",18,0)
 S CON=0 F I=0:0 S CON=$O(SRSCON(CON)) Q:'CON  D LIST
"RTN","SRSCHDC",19,0)
 I '$D(SRSCON(2)) S SRSCON=1,SRTN=SRSCON(1) N SRLCK S SRLCK=$$LOCK^SROUTL(SRTN) D ^SRSCHUN1 D:$G(SRLOCK) UNLOCK^SROUTL(SRTN) G END
"RTN","SRSCHDC",20,0)
 W !!!!,"1. Enter Information for Case #"_SRSCON(1),!,"2. Enter Information for Case #"_SRSCON(2),!
"RTN","SRSCHDC",21,0)
REQ K DIR S DIR("?")=" ",DIR("?",1)="Select the number corresponding to the case for which you want",DIR("?",2)="to enter information.  Enter '^' or RETURN to exit."
"RTN","SRSCHDC",22,0)
 S DIR(0)="NO^1:2",DIR("A")="Select Number" D ^DIR I Y=""!$D(DUOUT) S SRSOUT=1 G END
"RTN","SRSCHDC",23,0)
 N SRLCK S SRSCON=Y S (DA,SRTN)=SRSCON(SRSCON),SRLCK=$$LOCK^SROUTL(SRTN) D ^SRSCHUN1 D:$G(SRLCK) UNLOCK^SROUTL(SRTN) G DISP
"RTN","SRSCHDC",24,0)
END I 'SRSOUT W ! K DIR S DIR(0)="FOA",DIR("A")=" Press RETURN to continue. " D ^DIR
"RTN","SRSCHDC",25,0)
 K SRTN D ^SRSKILL W @IOF
"RTN","SRSCHDC",26,0)
 Q
"RTN","SRSCHDC",27,0)
LIST ; list stub info
"RTN","SRSCHDC",28,0)
 S SROPER=SRSCON(CON,"OP") K SROPS,MM,MMM S:$L(SROPER)<60 SROPS(1)=SROPER I $L(SROPER)>59 S SROPER=SROPER_"  " F M=1:1 D LOOP Q:MMM=""
"RTN","SRSCHDC",29,0)
 W !!,CON_". ",?4,"Case # "_SRSCON(CON),?40,SRSDT,!,?4,"Surgeon: "_SRSCON(CON,"DOC"),?40,SRSCON(CON,"SS"),!,?4,"Procedure: ",?16,SROPS(1) I $D(SROPS(2)) W !,?16,SROPS(2) I $D(SROPS(3)) W !,?16,SROPS(3)
"RTN","SRSCHDC",30,0)
 Q
"RTN","SRSCHDC",31,0)
LOOP ; break procedure if greater than 60 characters
"RTN","SRSCHDC",32,0)
 S SROPS(M)="" F LOOP=1:1 S MM=$P(SROPER," "),MMM=$P(SROPER," ",2,200) Q:MMM=""  Q:$L(SROPS(M))+$L(MM)'<60  S SROPS(M)=SROPS(M)_MM_" ",SROPER=MMM
"RTN","SRSCHDC",33,0)
 Q
"RTN","SRSCHDC",34,0)
DEL ; delete first request ?
"RTN","SRSCHDC",35,0)
 W !!,"Since you were unable to complete the information for the concurrent case, you",!,"may want to delete the first case and re-enter both at another time."
"RTN","SRSCHDC",36,0)
ASK W !!,"Do you want to delete the entry for Case "_SRSCON(1)_" also ?  YES //  " R SRYN:DTIME I '$T!(SRYN["^") S SRYN="Y"
"RTN","SRSCHDC",37,0)
 S SRYN=$E(SRYN) S:SRYN="" SRYN="Y"
"RTN","SRSCHDC",38,0)
 I "YyNn"'[SRYN S SRTN=1 W !!,"Enter RETURN to delete Case "_SRSCON(1)_", or 'NO' to continue entering information",!,"for this case." G ASK
"RTN","SRSCHDC",39,0)
 I "Yy"'[SRYN S SRSOUT=0 Q
"RTN","SRSCHDC",40,0)
 S SRTN=SRSCON(1),SRTN("OR")=SRSOR,SRTN("START")=SRSDT1,SRTN("END")=SRSDT2,SRSEDT=$E(SRSDT2,1,7) D ^SRSCG
"RTN","SRSCHDC",41,0)
 D OERR
"RTN","SRSCHDC",42,0)
 W !!,"  Deleting Case "_SRSCON(1)_" ..." S DA=SRSCON(1),DIK="^SRF(" D ^DIK K SRTN
"RTN","SRSCHDC",43,0)
 Q
"RTN","SRSCHDC",44,0)
OERR ; delete from ORDER file (100)
"RTN","SRSCHDC",45,0)
 N SRTN S SRTN=SRSCON(1) D DEL^SROERR
"RTN","SRSCHDC",46,0)
 Q
"RTN","SRSCHUN")
0^98^B18782437
"RTN","SRSCHUN",1,0)
SRSCHUN ;BIR/ADM - MAKE UNREQUESTED OPERATION; [ 11/01/01  7:31 AM ]
"RTN","SRSCHUN",2,0)
 ;;3.0; Surgery ;**3,67,68,88,103,100**;24 Jun 93
"RTN","SRSCHUN",3,0)
MUST S SRLINE="" F I=1:1:80 S SRLINE=SRLINE_"="
"RTN","SRSCHUN",4,0)
 W @IOF W:$D(SRCC) !,?29,$S(SRSCON=1:"FIRST",1:"SECOND")_" CONCURRENT CASE" W !,?14,"SCHEDULE UNREQUESTED OPERATION: REQUIRED INFORMATION",!!,SRNM_" ("_$G(SRSSN)_")",?65,SREQDT,!,SRLINE,!
"RTN","SRSCHUN",5,0)
SURG ; surgeon
"RTN","SRSCHUN",6,0)
 K DIR S DIR(0)="130,.14",DIR("A")="Surgeon" D ^DIR K DIR I $D(DTOUT)!(X="^") S SRSOUT=1 G END
"RTN","SRSCHUN",7,0)
 I Y=""!(X["^") W !!,"To create a surgical case, a surgeon MUST be selected.  Enter '^' to exit.",! G SURG
"RTN","SRSCHUN",8,0)
 S SRSDOC=+Y
"RTN","SRSCHUN",9,0)
SPEC ; surgical specialty
"RTN","SRSCHUN",10,0)
 K DIR S DIR(0)="130,.04",DIR("A")="Surgical Specialty" D ^DIR K DIR I $D(DTOUT)!(X="^") S SRSOUT=1 G END
"RTN","SRSCHUN",11,0)
 I Y=""!(X["^") W !!,"To create a surgical case, a surgical specialty MUST be selected.  Enter '^'",!,"to exit.",! G SPEC
"RTN","SRSCHUN",12,0)
 S SRSS=+Y
"RTN","SRSCHUN",13,0)
OP ; principal operative procedure
"RTN","SRSCHUN",14,0)
 K DIR S DIR(0)="130,26",DIR("A")="Principal Operative Procedure" D ^DIR K DIR I $D(DTOUT)!(X="^") S SRSOUT=1 G END
"RTN","SRSCHUN",15,0)
 I X["^" W !!,"Principal procedure must not contain an up-arrow (^).",! G OP
"RTN","SRSCHUN",16,0)
 S SRSOP=Y
"RTN","SRSCHUN",17,0)
CASE ; create case in SURGERY file
"RTN","SRSCHUN",18,0)
 K DA,DIC,DD,DO,DINUM,SRTN S X=SRSDPT,DIC="^SRF(",DIC(0)="L",DLAYGO=130 D FILE^DICN K DD,DO,DIC,DLAYGO S SRTN=+Y,SRLCK=$$LOCK^SROUTL(SRTN)
"RTN","SRSCHUN",19,0)
 D NOW^%DTC S SREQDAY=+$E(%,1,12),SRNOCON=1 K DR,DIE
"RTN","SRSCHUN",20,0)
 S DA=SRTN,DIE=130,DR="26////"_SRSOP_";68////"_SRSOP_";36////0;Q;.09////"_SRSDATE_";.14////"_SRSDOC_";1.098////"_+SREQDAY_";1.099////"_DUZ_";Q;.02////"_SRSOR_";10////"_SRSDT1_";11////"_SRSDT2_";Q;.04////"_SRSS D ^DIE
"RTN","SRSCHUN",21,0)
 K DR,DA S DR="[SRO-NOCOMP]",DA=SRTN,DIE=130 D ^DIE K DR
"RTN","SRSCHUN",22,0)
 S ^SRF(SRTN,8)=SRSITE("DIV") D ^SROXRET K SRNOCON
"RTN","SRSCHUN",23,0)
OTHER ; other required fields
"RTN","SRSCHUN",24,0)
 S SRFLD=0 F  S SRFLD=$O(^SRO(133,SRSITE,4,SRFLD)) Q:'SRFLD!(SRSOUT)  D OTHDIR Q:SRSOUT
"RTN","SRSCHUN",25,0)
 I SRSOUT S DA=SRTN,DIK="^SRF(" D ^DIK G END
"RTN","SRSCHUN",26,0)
IND K DR S DIE=130,DA=SRTN,DR="55T" D ^DIE I $D(DTOUT) S SRDUOUT=1
"RTN","SRSCHUN",27,0)
 I $D(SRDUOUT),'$O(^SRF(SRTN,40,0)) S SRSOUT=1
"RTN","SRSCHUN",28,0)
 I '$D(SRDUOUT),'$O(^SRF(SRTN,40,0)) W !!,"A brief description of the indications for this operation MUST be entered",!,"before proceeding with this option.",! D ASK G:'SRSOUT IND
"RTN","SRSCHUN",29,0)
 I SRSOUT S DA=SRTN,DIK="^SRF(" D ^DIK G END
"RTN","SRSCHUN",30,0)
 I $D(SRCC),SRSCON=2 S DIE=130,DR="35////"_SRSCON(1),DA=SRTN D ^DIE K DR S DR="35////"_SRTN,DA=SRSCON(1),DIE=130 D ^DIE K DR,DA S SROERR=SRSCON(1) D ^SROERR0
"RTN","SRSCHUN",31,0)
 D:$G(SRLCK) UNLOCK^SROUTL(SRTN)
"RTN","SRSCHUN",32,0)
 S SROERR=SRTN D ^SROERR I $D(SRDUOUT) S SRSOUT=1
"RTN","SRSCHUN",33,0)
 Q
"RTN","SRSCHUN",34,0)
CON ; request concurrent case
"RTN","SRSCHUN",35,0)
 D MUST Q:SRSOUT  S SRSCON(SRSCON,"DOC")=$P(^VA(200,SRSDOC,0),"^"),SRSCON(SRSCON,"SS")=$P(^SRO(137.45,SRSS,0),"^"),SRSCON(SRSCON,"OP")=$P(^SRF(SRTN,"OP"),"^"),SRSCON(SRSCON)=SRTN K DA
"RTN","SRSCHUN",36,0)
 Q
"RTN","SRSCHUN",37,0)
OTHDIR ; call to reader for site specific required fields
"RTN","SRSCHUN",38,0)
 K DIR,SREQ,SRY S FLD=$P(^SRO(133,SRSITE,4,SRFLD,0),"^") D FIELD^DID(130,FLD,"","TITLE","SRY") S DIR(0)="130,"_FLD,DIR("A")=SRY("TITLE") D ^DIR I $D(DTOUT)!(X="^") S SRSOUT=1 Q
"RTN","SRSCHUN",39,0)
 I Y=""!(X["^") W !!,"It is mandatory that you provide this information before proceeding with this",!,"option.",! D ASK Q:SRSOUT  G OTHDIR
"RTN","SRSCHUN",40,0)
 S SREQ(130,SRTN_",",FLD)=$P(Y,"^") D FILE^DIE("","SREQ","^TMP(""SR"",$J)")
"RTN","SRSCHUN",41,0)
 Q
"RTN","SRSCHUN",42,0)
ASK K DIR S DIR(0)="Y",DIR("A")="Do you want to continue with this option ",DIR("B")="YES"
"RTN","SRSCHUN",43,0)
 S DIR("?")="Enter RETURN to continue with this option, or 'NO' to discontinue this option." D ^DIR S:'Y SRSOUT=1
"RTN","SRSCHUN",44,0)
 Q
"RTN","SRSCHUN",45,0)
END D:$G(SRLCK) UNLOCK^SROUTL(SRTN)
"RTN","SRSCHUN",46,0)
 I '$D(SRCC),SRSOUT W !!,"No surgical case has been scheduled.",! S SRTN("OR")=SRSOR,SRTN("START")=SRSDT1,SRTN("END")=SRSDT2,SRSEDT=$E(SRSDT2,1,7) D ^SRSCG
"RTN","SRSCHUN",47,0)
 Q
"RTN","SRSCONR")
0^99^B16632460
"RTN","SRSCONR",1,0)
SRSCONR ;B'HAM ISC/MAM - REQUEST CONCURRENT CASES ; [ 01/30/01  9:54 AM ]
"RTN","SRSCONR",2,0)
 ;;3.0; Surgery ;**67,68,77,100**;24 Jun 93
"RTN","SRSCONR",3,0)
 S SRCC=1,(SRSOUT,SRWL)=0 I $D(ORVP) S (DFN,SRSDPT)=+ORVP G DEAD
"RTN","SRSCONR",4,0)
 W @IOF,! K DIC S DIC=2,DIC(0)="QEAMZ",DIC("A")="Request Concurrent Cases for which Patient ?  " D ^DIC K DIC I Y<0 S SRSOUT=1 G END
"RTN","SRSCONR",5,0)
 S (DFN,SRSDPT)=+Y
"RTN","SRSCONR",6,0)
DEAD D DEM^VADPT S SRNM=VADM(1),SRSSN=VA("PID")
"RTN","SRSCONR",7,0)
 I $D(^DPT(SRSDPT,.35)),$P(^(.35),"^")'="" S Y=$E($P(^(.35),"^"),1,7) D D^DIQ W !!,"The records show that "_SRNM_" died on "_Y_".",!! G END
"RTN","SRSCONR",8,0)
 S SRSOTH=0 D LFTOVR^SRSREQUT I SRSOTH=1 S SRSOUT=1 G END
"RTN","SRSCONR",9,0)
DATE W ! K SRDUOUT,%DT S (OPT,SRSCON)=0,%DT="AEFX",%DT("A")="Make a Request for Concurrent Cases on which Date ?  " D ^%DT I Y<0 S SRSOUT=1 G END
"RTN","SRSCONR",10,0)
 I Y<DT W !!,"Requests cannot be made for past dates.  Please enter a different date.",! G DATE
"RTN","SRSCONR",11,0)
 S SRSDATE=Y D D^DIQ S (SREQDT,SRSDT)=Y,ST="REQUESTS",(SRSOP,SRSDAY)="",SRSST=0
"RTN","SRSCONR",12,0)
 K SRLATE D LATE^SRSREQ I $D(SRLATE) G DATE
"RTN","SRSCONR",13,0)
 K SRTN F SRSCON=1,2 D CON^SRSRQST I SRSOUT,SRSCON=1 Q
"RTN","SRSCONR",14,0)
 I SRSOUT,SRSCON=1 S SRSOUT=0 G END
"RTN","SRSCONR",15,0)
R2 I SRSOUT,SRSCON=2 K SRSCON(2) D DEL I 'SRSOUT G END
"RTN","SRSCONR",16,0)
DISP K POP W @IOF,!,"The following requests have been entered."
"RTN","SRSCONR",17,0)
 S SRSCON=0 F I=0:0 S SRSCON=$O(SRSCON(SRSCON)) Q:'SRSCON  D LIST
"RTN","SRSCONR",18,0)
 I '$D(SRSCON(2)) S SRSCON=1,SRTN=SRSCON(1) D  G END
"RTN","SRSCONR",19,0)
 .I $$LOCK^SROUTL(SRTN) D ^SRSRQST1,UNLOCK^SROUTL(SRTN)
"RTN","SRSCONR",20,0)
 W !!!!,"1. Enter Request Information for Case #"_SRSCON(1),!,"2. Enter Request Information for Case #"_SRSCON(2),!
"RTN","SRSCONR",21,0)
REQ K DIR S DIR("?")=" ",DIR("?",1)="Select the number corresponding to the case for which you want",DIR("?",2)="to enter request information.  Enter '^' or RETURN to exit."
"RTN","SRSCONR",22,0)
 S DIR(0)="NO^1:2",DIR("A")="Select Number" D ^DIR I Y=""!$D(DUOUT) S SRSOUT=1 G END
"RTN","SRSCONR",23,0)
 S SRSCON=Y S (DA,SRTN)=SRSCON(SRSCON) D  G DISP
"RTN","SRSCONR",24,0)
 .I $$LOCK^SROUTL(SRTN) D ^SRSRQST1,UNLOCK^SROUTL(SRTN)
"RTN","SRSCONR",25,0)
END I 'SRSOUT W ! K DIR S DIR(0)="FOA",DIR("A")=" Press RETURN to continue.  " D ^DIR
"RTN","SRSCONR",26,0)
 K SRTN D ^SRSKILL W @IOF
"RTN","SRSCONR",27,0)
 Q
"RTN","SRSCONR",28,0)
LIST ; list stub info
"RTN","SRSCONR",29,0)
 S SROPER=SRSCON(SRSCON,"OP") K SROPS,MM,MMM S:$L(SROPER)<60 SROPS(1)=SROPER I $L(SROPER)>59 S SROPER=SROPER_"  " F M=1:1 D LOOP Q:MMM=""
"RTN","SRSCONR",30,0)
 W !!,SRSCON_". ",?4,"Case # "_SRSCON(SRSCON),?40,SRSDT,!,?4,"Surgeon: "_SRSCON(SRSCON,"DOC"),?40,SRSCON(SRSCON,"SS"),!,?4,"Procedure: ",?16,SROPS(1) I $D(SROPS(2)) W !,?16,SROPS(2) I $D(SROPS(3)) W !,?16,SROPS(3)
"RTN","SRSCONR",31,0)
 Q
"RTN","SRSCONR",32,0)
LOOP ; break procedure if greater than 60 characters
"RTN","SRSCONR",33,0)
 S SROPS(M)="" F LOOP=1:1 S MM=$P(SROPER," "),MMM=$P(SROPER," ",2,200) Q:MMM=""  Q:$L(SROPS(M))+$L(MM)'<60  S SROPS(M)=SROPS(M)_MM_" ",SROPER=MMM
"RTN","SRSCONR",34,0)
 Q
"RTN","SRSCONR",35,0)
DEL ; delete first request ?
"RTN","SRSCONR",36,0)
 W !!,"Since you were unable to complete the information for the concurrent case, you",!,"may want to delete the first request and re-enter both at another time."
"RTN","SRSCONR",37,0)
ASK W !!,"Do you want to delete the request for Case "_SRSCON(1)_" also ?  YES //  " R SRYN:DTIME I '$T!(SRYN["^") S SRYN="N"
"RTN","SRSCONR",38,0)
 S SRYN=$E(SRYN) S:SRYN="" SRYN="Y"
"RTN","SRSCONR",39,0)
 I "YyNn"'[SRYN S SRTN=1 W !!,"Enter RETURN to delete Case "_SRSCON(1)_", or 'NO' to continue entering information",!,"for this request." G ASK
"RTN","SRSCONR",40,0)
 I "Yy"'[SRYN S SRSOUT=0 Q
"RTN","SRSCONR",41,0)
 D OERR
"RTN","SRSCONR",42,0)
 W !!,"  Deleting Case "_SRSCON(1)_" ..." S (DA,SRTN)=SRSCON(1),DIK="^SRF(" D ^DIK K SRTN S SRSOUT=0
"RTN","SRSCONR",43,0)
 Q
"RTN","SRSCONR",44,0)
OERR ; delete from ORDER file (100)
"RTN","SRSCONR",45,0)
 N SRTN S SRTN=SRSCON(1) D DEL^SROERR
"RTN","SRSCONR",46,0)
 Q
"RTN","SRSDIS1")
0^164^B9696115
"RTN","SRSDIS1",1,0)
SRSDIS1 ;B'HAM ISC/MAM - DISPLAY ONE ROOM ; [ 09/29/03  10:23 AM ]
"RTN","SRSDIS1",2,0)
 ;;3.0; Surgery ;**100**;24 Jun 93
"RTN","SRSDIS1",3,0)
PICK W @IOF,!!,"Display of Available Operating Room Time",!!,"1. Display Availability (12:00 AM - 12:00 PM)",!,"2. Display Availability (06:00 AM - 08:00 PM)",!,"3. Display Availability (12:00 PM - 12:00 AM)"
"RTN","SRSDIS1",4,0)
 W !!,"Select Number: 2//  " R X:DTIME I '$T!(X["^") S SRSOUT=1 Q
"RTN","SRSDIS1",5,0)
 S:X="" X=2 I X<1!(X>3) D HELP G PICK
"RTN","SRSDIS1",6,0)
 S SRDTYPE=X D HDR
"RTN","SRSDIS1",7,0)
 S SRDT=SRSDATE F SRDAZE=0:1:14 S X1=SRDT,X2=SRDAZE D C^%DTC S SRSDATE=X,SRDATE=$E(X,4,5)_"-"_$E(X,6,7)_"-"_$E(X,2,3)_" " D LINE
"RTN","SRSDIS1",8,0)
 Q
"RTN","SRSDIS1",9,0)
HDR W @IOF,!!,"Operating Room: "_SROOM,?25,$S(SRDTYPE=2:"     (6:00 AM - 8:00 PM)",SRDTYPE=1:" (12:00 AM - 12:00 PM)",1:" (12:00 PM - 12:00 AM)"),!!,"DATE "
"RTN","SRSDIS1",10,0)
 I SRDTYPE=2 W "    6    7    8    9   10   11   12   13   14   15   16   17   18   19   20" Q
"RTN","SRSDIS1",11,0)
 I SRDTYPE=1 W "    12   1    2    3    4    5    6    7    8    9   10   11   12" Q
"RTN","SRSDIS1",12,0)
 W "    12   13   14   15   16   17  18   19   20   21   22   23   24"
"RTN","SRSDIS1",13,0)
 Q
"RTN","SRSDIS1",14,0)
LINE ; display graph for each room
"RTN","SRSDIS1",15,0)
 I '$D(^SRS(SROR,"S",SRSDATE,1)) D GRAPH
"RTN","SRSDIS1",16,0)
 S START=$S(SRDTYPE=2:41,SRDTYPE=1:11,1:71),END=$S(SRDTYPE=2:111,SRDTYPE=1:71,1:500)
"RTN","SRSDIS1",17,0)
 W !,SRDATE,$E(^SRS(SROR,"S",SRSDATE,1),START,END)
"RTN","SRSDIS1",18,0)
 Q
"RTN","SRSDIS1",19,0)
GRAPH ; set graph in ^SRS
"RTN","SRSDIS1",20,0)
 S ^SRS(SROR,"S",SRSDATE,0)=SRSDATE,^SRS(SROR,"SS",SRSDATE,0)=SRSDATE
"RTN","SRSDIS1",21,0)
 S X=$E(SRSDATE,4,5)_"-"_$E(SRSDATE,6,7)_"-"_$E(SRSDATE,2,3)
"RTN","SRSDIS1",22,0)
 S ^SRS(SROR,"S",SRSDATE,1)=X_"  |____|____|____|____|____|____|____|____|____|____|____|____|____|____|____|____|____|____|____|____|____|____|____|____|",^SRS(SROR,"SS",SRSDATE,1)=^SRS(SROR,"S",SRSDATE,1)
"RTN","SRSDIS1",23,0)
 D ^SRSBLOK
"RTN","SRSDIS1",24,0)
 Q
"RTN","SRSDIS1",25,0)
HELP W !!,"Enter the number corresponding to portion of the display graph of available",!,"operating room time that you want to view.  If you want to view the room"
"RTN","SRSDIS1",26,0)
 W !,"between the hours of 6:00 AM and 8:00 PM, enter '2'.  A display of available",!,"operating room time will then appear on your screen."
"RTN","SRSDIS1",27,0)
 W !!,"Press <RET> to continue  " R X:DTIME
"RTN","SRSDIS1",28,0)
 Q
"RTN","SRSDT")
0^100^B8368565
"RTN","SRSDT",1,0)
SRSDT ;B'HAM ISC/MAM - CHANGE DATE OF OPERATION REQUEST; [ 06/14/01  9:54 AM ]
"RTN","SRSDT",2,0)
 ;;3.0; Surgery ;**3,16,34,67,77,103,114,100**;24 Jun 93
"RTN","SRSDT",3,0)
CHANGE ; change date of request
"RTN","SRSDT",4,0)
 N SRLCK S SRLCK=$$LOCK^SROUTL(SRTN) Q:'SRLCK
"RTN","SRSDT",5,0)
 D ^SRSTCH I SRSOUT Q
"RTN","SRSDT",6,0)
 W !! S CON=0,SRDT=SRSDATE,%DT="AEFX",%DT("A")="Change to which Date ? " D ^%DT K %DT Q:Y<1  S SRSDATE=+Y
"RTN","SRSDT",7,0)
 I SRSDATE<DT W !!,"Requests cannot be made for past dates.  Please select another date." K Y S SRSDATE=SRDT G CHANGE
"RTN","SRSDT",8,0)
 K SRLATE S SRDTCH=1 D LATE^SRSREQ I $D(SRLATE) G CHANGE
"RTN","SRSDT",9,0)
NEWDT I SRSDATE=SRDT Q
"RTN","SRSDT",10,0)
 K ^SRF("AC",SRDT,SRTN)
"RTN","SRSDT",11,0)
 K DR,DIE,DA S DIE=130,DA=SRTN,DR=".09////"_SRSDATE D ^DIE K DR
"RTN","SRSDT",12,0)
 K DR,X S SRSREQ=1,SRSATT=$S($D(^SRF(SRTN,.1)):$P(^(.1),"^",13),1:""),SRTS=$P(^SRF(SRTN,0),"^",4),DIE=130,DA=SRTN,DR=".04////"_SRTS_";.164////"_SRSATT D ^DIE K DR D ^SROXRET
"RTN","SRSDT",13,0)
 S SRINVDT=9999999.999999-SRDT K ^SRF("ADT",DFN,SRINVDT,SRTN),SRINVDT
"RTN","SRSDT",14,0)
 N SREQ D NOW^%DTC S SREQ(130,SRTN_",",1.098)=+$E(%,1,12),SREQ(130,SRTN_",",1.099)=DUZ D FILE^DIE("","SREQ","^TMP(""SR"",$J)")
"RTN","SRSDT",15,0)
 I SRTS K ^SRF("ASP",SRTS,SRDT,SRTN)
"RTN","SRSDT",16,0)
 S SROERR=SRTN K SRTX D ^SROERR0
"RTN","SRSDT",17,0)
 I CON=0,$D(^SRF(SRTN,"CON")),$P(^("CON"),"^")'="" D CC I SRBOTH=1 S SRTN=$P(^SRF(SRTN,"CON"),"^") Q:SRTN=""  S CON=1 G NEWDT
"RTN","SRSDT",18,0)
 S Y=SRSDATE D D^DIQ S SRSDATE=Y W !!,"The request for "_SRNM_" has been changed to "_SRSDATE_"."
"RTN","SRSDT",19,0)
 D UNLOCK^SROUTL(SRTN)
"RTN","SRSDT",20,0)
 Q
"RTN","SRSDT",21,0)
CC ; concurrent case check
"RTN","SRSDT",22,0)
 W !!,"There is a concurrent case associated with this operation.  Do you want to",!,"change the date of it also ?  YES//  " R SRBOTH:DTIME I '$T S SRBOTH="Y"
"RTN","SRSDT",23,0)
 I SRBOTH="^" W !!,"Please answer 'YES' or 'NO'.  A '^' is not allowed. " G CC
"RTN","SRSDT",24,0)
 S:SRBOTH="" SRBOTH="Y" S SRBOTH=$E(SRBOTH) I "YyNn"'[SRBOTH W !!,"Enter RETURN if these cases will remain concurrent, or 'NO' if they will no",!,"longer be associated together." G CC
"RTN","SRSDT",25,0)
 I SRBOTH["Y" S SRBOTH=1 Q
"RTN","SRSDT",26,0)
 S DIE=130,DA=$P(^SRF(SRTN,"CON"),"^"),DR="35///@" D ^DIE,UNLOCK^SROUTL(DA)
"RTN","SRSDT",27,0)
 S DA=SRTN D ^DIE
"RTN","SRSDT",28,0)
 Q
"RTN","SRSEND")
1^110
"RTN","SRSRQST")
0^101^B18734684
"RTN","SRSRQST",1,0)
SRSRQST ;BIR/MAM,ADM - MAKE OPERATION REQUESTS; [ 11/01/01  9:40 AM ]
"RTN","SRSRQST",2,0)
 ;;3.0; Surgery ;**3,58,67,88,103,105,100**;24 Jun 93
"RTN","SRSRQST",3,0)
MUST S SRLINE="" F I=1:1:80 S SRLINE=SRLINE_"="
"RTN","SRSRQST",4,0)
 W @IOF W:$D(SRCC) !,?29,$S(SRSCON=1:"FIRST",1:"SECOND")_" CONCURRENT CASE" W !,?20,"OPERATION REQUEST: REQUIRED INFORMATION",!!,SRNM_" ("_SRSSN_")",?65,SREQDT,!,SRLINE,!
"RTN","SRSRQST",5,0)
SURG ; surgeon
"RTN","SRSRQST",6,0)
 K DIR S DIR(0)="130,.14",DIR("A")="Surgeon" D ^DIR K DIR I $D(DTOUT)!(X="^") S SRSOUT=1 G END
"RTN","SRSRQST",7,0)
 I Y=""!(X["^") W !!,"To make an operation request, a surgeon MUST be selected.  Enter '^' to exit.",! G SURG
"RTN","SRSRQST",8,0)
 S SRSDOC=+Y
"RTN","SRSRQST",9,0)
SPEC ; surgical specialty
"RTN","SRSRQST",10,0)
 I SRWL W !,"Surgical Specialty: "_$P(^SRO(137.45,SRSS,0),"^") G OP
"RTN","SRSRQST",11,0)
 K DIR S DIR(0)="130,.04",DIR("A")="Surgical Specialty" D ^DIR K DIR I $D(DTOUT)!(X="^") S SRSOUT=1 G END
"RTN","SRSRQST",12,0)
 I Y=""!(X["^") W !!,"To make an operation request, a surgical specialty MUST be selected.  Enter '^'",!,"to exit.",! G SPEC
"RTN","SRSRQST",13,0)
 S SRSS=+Y
"RTN","SRSRQST",14,0)
OP ; principal operative procedure
"RTN","SRSRQST",15,0)
 I SRWL W !,"Principal Operative Procedure: "_SRSOP G CASE
"RTN","SRSRQST",16,0)
 K DIR S DIR(0)="130,26",DIR("A")="Principal Operative Procedure" D ^DIR K DIR I $D(DTOUT)!(X="^") S SRSOUT=1 G END
"RTN","SRSRQST",17,0)
 I X["^" W !!,"Principal procedure must not contain an up-arrow (^).",! G OP
"RTN","SRSRQST",18,0)
 S SRSOP=Y
"RTN","SRSRQST",19,0)
CASE K DA,DIC,DD,DO,DINUM,SRTN S X=SRSDPT,DIC="^SRF(",DIC(0)="L",DLAYGO=130 D FILE^DICN K DD,DO,DIC,DLAYGO S SRTN=+Y
"RTN","SRSRQST",20,0)
 N SRLCK S SRLCK=$$LOCK^SROUTL(SRTN)
"RTN","SRSRQST",21,0)
 D NOW^%DTC S SREQDAY=+$E(%,1,12),SRNOCON=1 K DR,DIE
"RTN","SRSRQST",22,0)
 S DA=SRTN,DIE=130,DR="26////"_SRSOP_";68////"_SRSOP_";36////1;Q;.09////"_SRSDATE_";.14////"_SRSDOC_";1.098////"_+SREQDAY_";1.099////"_DUZ_";Q;.04////"_SRSS D ^DIE
"RTN","SRSRQST",23,0)
 I SRWL K DA,DIE,DR S DA=SRTN,DIE=130,DR=".016////"_SRCL(16)_";.017////"_SRCL(17)_";.018////"_SRCL(18)_";.019////"_SRCL(19)_";.0155////"_SRCL(20)_";.022////"_SRCL(21)_";.023////"_SRCL(22) D ^DIE
"RTN","SRSRQST",24,0)
 K DR,DA S DR="[SRO-NOCOMP]",DA=SRTN,DIE=130 D ^DIE K DR
"RTN","SRSRQST",25,0)
 S ^SRF(SRTN,8)=SRSITE("DIV") D ^SROXRET K SRNOCON
"RTN","SRSRQST",26,0)
OTHER ; other required fields
"RTN","SRSRQST",27,0)
 S SRFLD=0 F  S SRFLD=$O(^SRO(133,SRSITE,4,SRFLD)) Q:'SRFLD!(SRSOUT)  D OTHDIR Q:SRSOUT
"RTN","SRSRQST",28,0)
 I SRSOUT S DA=SRTN,DIK="^SRF(" D ^DIK G END
"RTN","SRSRQST",29,0)
IND K DR S DIE=130,DA=SRTN,DR="55T" D ^DIE I $D(DTOUT) S SRDUOUT=1
"RTN","SRSRQST",30,0)
 I $D(SRDUOUT),'$O(^SRF(SRTN,40,0)) S SRSOUT=1
"RTN","SRSRQST",31,0)
 I '$D(SRDUOUT),'$O(^SRF(SRTN,40,0)) W !!,"A brief description of the indications for this operation MUST be entered",!,"before proceeding with this request.",! D ASK G:'SRSOUT IND
"RTN","SRSRQST",32,0)
 I SRSOUT S DA=SRTN,DIK="^SRF(" D ^DIK G END
"RTN","SRSRQST",33,0)
 I $D(SRCC),SRSCON=2 S DIE=130,DR="35////"_SRSCON(1),DA=SRTN D ^DIE K DR S DR="35////"_SRTN,DA=SRSCON(1),DIE=130 D ^DIE K DR,DA
"RTN","SRSRQST",34,0)
 D ^SROERR I $D(SRDUOUT) S SRSOUT=1 Q
"RTN","SRSRQST",35,0)
 I '$D(SRCC) D ^SRSRQST1
"RTN","SRSRQST",36,0)
 D:$G(SRLCK) UNLOCK^SROUTL(SRTN)
"RTN","SRSRQST",37,0)
 Q
"RTN","SRSRQST",38,0)
END D:$G(SRLCK) UNLOCK^SROUTL(SRTN)
"RTN","SRSRQST",39,0)
 I SRSOUT W !!,"No request has been entered.",! S:'$D(SRCC) SRSOUT=0
"RTN","SRSRQST",40,0)
 Q
"RTN","SRSRQST",41,0)
CON ; request concurrent case
"RTN","SRSRQST",42,0)
 D MUST Q:SRSOUT  S SRSCON(SRSCON,"DOC")=$P(^VA(200,SRSDOC,0),"^"),SRSCON(SRSCON,"SS")=$P(^SRO(137.45,SRSS,0),"^"),SRSCON(SRSCON,"OP")=SRSOP,SRSCON(SRSCON)=SRTN K DA
"RTN","SRSRQST",43,0)
 Q
"RTN","SRSRQST",44,0)
OTHDIR ; call to reader for site specific required fields
"RTN","SRSRQST",45,0)
 K DIR,SREQ,SRY S FLD=$P(^SRO(133,SRSITE,4,SRFLD,0),"^") D FIELD^DID(130,FLD,"","TITLE","SRY") S DIR(0)="130,"_FLD,DIR("A")=SRY("TITLE") D ^DIR I $D(DTOUT)!(X="^") S SRSOUT=1 Q
"RTN","SRSRQST",46,0)
 I Y=""!(X["^") W !!,"It is mandatory that you provide this information before proceeding with this",!,"request.",! D ASK Q:SRSOUT  G OTHDIR
"RTN","SRSRQST",47,0)
 S SREQ(130,SRTN_",",FLD)=$P(Y,"^") D FILE^DIE("","SREQ","^TMP(""SR"",$J)")
"RTN","SRSRQST",48,0)
 Q
"RTN","SRSRQST",49,0)
ASK K DIR S DIR(0)="Y",DIR("A")="Do you want to continue with this request ",DIR("B")="YES"
"RTN","SRSRQST",50,0)
 S DIR("?")="Enter RETURN to continue with this request, or 'NO' to discontinue this request." D ^DIR S:'Y SRSOUT=1
"RTN","SRSRQST",51,0)
 Q
"RTN","SRSTR")
1^112
"RTN","SRSTRAN")
1^113
"RTN","SRSUP1")
0^102^B26000444
"RTN","SRSUP1",1,0)
SRSUP1 ;BIR/MAM - UPDATE SCHEDULED OPERATION ; [ 01/29/01  2:13 PM ]
"RTN","SRSUP1",2,0)
 ;;3.0; Surgery ;**7,16,19,47,58,67,77,50,93,107,114,100**;24 Jun 93
"RTN","SRSUP1",3,0)
 ;
"RTN","SRSUP1",4,0)
 ; Reference to ^TMP("CSLSUR1" supported by DBIA #3498
"RTN","SRSUP1",5,0)
 ;
"RTN","SRSUP1",6,0)
 I $P($G(^SRF(SRTN,"CON")),"^") G CHANGE
"RTN","SRSUP1",7,0)
CON W !!,"Do you want to add a concurrent case ?  NO// " R SRYN:DTIME I '$T!(SRYN["^") G END
"RTN","SRSUP1",8,0)
 S SRYN=$E(SRYN) S:SRYN="" SRYN="N"
"RTN","SRSUP1",9,0)
 I "YyNn"'[SRYN W !!,"Enter 'YES' if you need to add a case to be performed concurrently with this",!,"case.  Press RETURN to update other information related to this case." G CON
"RTN","SRSUP1",10,0)
 I "Nn"'[SRYN G ^SRSCHCA
"RTN","SRSUP1",11,0)
CHANGE S SRC=1,SRI=$P($G(^SRF(SRTN,8)),"^"),SRS=$O(^SRO(133,"B",SRI,0)),SRTIME=$P(^SRO(133,SRS,0),"^",12) S:SRTIME="" SRTIME=1500
"RTN","SRSUP1",12,0)
 S X1=$E($P(^SRF(SRTN,0),"^",9),1,7),X2=-1,SRYN="N" G:X1<DT EDIT D C^%DTC S SRTIME=X_"."_SRTIME D NOW^%DTC I %>SRTIME S SRC=0
"RTN","SRSUP1",13,0)
 K SRSCC S SRSUPDT=1 W !!,"Do you want to change the ",$S(SRC:"date/",1:""),"time or operating room for which this",!,"case is scheduled ? NO// " R SRYN:DTIME I '$T!(SRYN["^") G END
"RTN","SRSUP1",14,0)
 S SRYN=$E(SRYN) S:SRYN="" SRYN="N"
"RTN","SRSUP1",15,0)
 I "YyNn"'[SRYN W !!,"Enter 'YES' if you need to change the ",$S(SRC:"date, ",1:""),"time or operating room for this",!,"case.  Enter RETURN to update other information related to this case." G CHANGE
"RTN","SRSUP1",16,0)
EDIT G:'$$LOCK^SROUTL(SRTN) END
"RTN","SRSUP1",17,0)
 I "Yy"'[SRYN D RT K ST,DR,DIE,DA S SPD=$$CHKS^SRSCOR(SRTN),DR="[SRSRES-SCHED]",DIE=130,DA=SRTN D EN2^SROVAR K Q3("VIEW") D ^SRCUSS D SRDYN D:$D(SRODR) ^SROCON1 D RISK^SROAUTL3,^SROPCE1,OERR G END
"RTN","SRSUP1",18,0)
 D ^SRSTCH I SRSOUT G END
"RTN","SRSUP1",19,0)
 D ^SRORESV S SRTN("OR")=SRSOR,SRTN("START")=SRSDT1,SRTN("END")=SRSDT2,SRSEDT=$E(SRSDT2,1,7) D ^SRSCG
"RTN","SRSUP1",20,0)
 S SRTN("SRT")=SRT,SRSTIME1=SRTN("START")_"^"_SRTN("END")_"^"_SRSDT1_"^"_SRSDT2
"RTN","SRSUP1",21,0)
DATE W !! K NODATE S OLDATE=$E(SRTN("START"),1,7) I 'SRC S SRSDATE=OLDATE W !!,"Press RETURN to continue... " R X:DTIME G DIS
"RTN","SRSUP1",22,0)
 S %DT="AEFX",%DT("A")="Reschedule this Procedure for which Date ?  " D ^%DT K %DT S SRSDATE=$S(Y>0:Y,1:OLDATE) I Y<0 S NODATE=1
"RTN","SRSUP1",23,0)
 I '$D(NODATE) D CHECK I SRNOK G DATE
"RTN","SRSUP1",24,0)
 I $D(NODATE) D NODATE I SRSOUT G SCHED
"RTN","SRSUP1",25,0)
DIS D ^SRSDISP I SRSOUT G SCHED
"RTN","SRSUP1",26,0)
 W ! K DIC S DIC="^SRS(",DIC(0)="QEAMZ",DIC("S")="I $$ORDIV^SROUTL0(+Y,$G(SRSITE(""DIV""))),('$P(^SRS(+Y,0),U,6))",DIC("A")="Schedule this case for which Operating Room: " D ^DIC K DIC I Y<0 S SRSOUT=1 G SCHED
"RTN","SRSUP1",27,0)
 S SRSOR=+Y,X1=SRSDATE,X2=2830103 D ^%DTC S SRSDAY=$P("MO^TU^WE^TH^FR^SA^SU","^",X#7+1)
"RTN","SRSUP1",28,0)
 D ^SRSTIME I SRSOUT G SCHED
"RTN","SRSUP1",29,0)
 S SRNOREQ=1 K DIE,DR,DA S DR="36///1;Q;.09///"_$S(SRSDATE=OLDATE:OLDATE,1:SRSDATE),DA=SRTN,DIE=130 D ^DIE K DR,DA,DIE
"RTN","SRSUP1",30,0)
SCHED S S(0)=^SRF(SRTN,0),SRSERV=$P(S(0),"^",4) S DA=SRTN,DIE=130,DR=".04////"_SRSERV D ^DIE K DR,DA,DIE
"RTN","SRSUP1",31,0)
 I SRSOUT S SRSDATE=OLDATE,SRSOR=SRTN("OR"),SRSTIME=SRTN("SRT"),SRSDT1=$P(SRSTIME1,"^",3),SRSDT2=$P(SRSTIME1,"^",4),SRSET1=$P(SRSTIME,"^",2)
"RTN","SRSUP1",32,0)
 K SRGRPH,SRSDT3 S COUNT=1,MM=$E(SRSDT2,1,7),XX=$E(SRSDT1,1,7) I MM>XX S SRSDT3=MM,$P(SRSTIME,"^",2)="24:00"
"RTN","SRSUP1",33,0)
 K X0,X1 D EN2^SRSCHD2 I $D(SRSLAP) S SRSOUT=1 K SRSLAP G SCHED
"RTN","SRSUP1",34,0)
 D:SRSDATE'=OLDATE ^SROXRET D OERR
"RTN","SRSUP1",35,0)
 D UNLOCK^SROUTL(SRTN)
"RTN","SRSUP1",36,0)
END ;
"RTN","SRSUP1",37,0)
 W @IOF D ^SRSKILL K SRTN
"RTN","SRSUP1",38,0)
 Q
"RTN","SRSUP1",39,0)
NODATE ; new date not entered
"RTN","SRSUP1",40,0)
 W !!,"Since no date has been entered, I must assume that you want to re-schedule",!,"this case for the same date.  If you have made a mistake and want to",!,"leave this case scheduled for the same operating room at the same times,"
"RTN","SRSUP1",41,0)
 W !,"enter RETURN when prompted to select an operating room."
"RTN","SRSUP1",42,0)
 R !!,"Press RETURN to continue  ",X:DTIME I '$T!(X["^") S SRSOUT=1
"RTN","SRSUP1",43,0)
 Q
"RTN","SRSUP1",44,0)
DIE K ST,DR,DIE,DA S DR="[SRSRES-SCHED]",DIE=130,DA=SRTN D EN2^SROVAR K Q3("VIEW") D ^SRCUSS K DR D SRDYN
"RTN","SRSUP1",45,0)
 Q
"RTN","SRSUP1",46,0)
RT ; start RT logging
"RTN","SRSUP1",47,0)
 I $D(XRTL) S XRTN="SRSUP1" D T0^%ZOSV
"RTN","SRSUP1",48,0)
 Q
"RTN","SRSUP1",49,0)
CHECK N SRHOL S SRHOL="",SRNOK=0,X=SRSDATE D H^%DTC S SRDAY=%Y+1 S SRDL=$P($G(^SRO(133,SRSITE,2)),"^",SRDAY) S:SRDL="" SRDL=1
"RTN","SRSUP1",50,0)
 I 'SRDL W !!,"Scheduling not allowed for "_$S(SRDAY=1:"SUNDAY",SRDAY=2:"MONDAY",SRDAY=3:"TUESDAY",SRDAY=4:"WEDNESDAY",SRDAY=5:"THURSDAY",SRDAY=6:"FRIDAY",1:"SATURDAY")_" !!",! S SRNOK=1 Q
"RTN","SRSUP1",51,0)
 K DIC S DIC=40.5,DIC(0)="XM",X=SRSDATE D ^DIC K DIC S SRHOL=$P(Y,"^") I SRHOL>0,'$D(^SRO(133,SRSITE,3,SRSDATE,0)) D  S SRNOK=1
"RTN","SRSUP1",52,0)
 .S DIC=40.5,DR="2",DA=SRHOL,DIQ="SRY",DIQ(0)="E" D EN^DIQ1
"RTN","SRSUP1",53,0)
 .W !!,"Scheduling not allowed for "_SRY(40.5,SRHOL,2,"E")_" !!",!
"RTN","SRSUP1",54,0)
 Q
"RTN","SRSUP1",55,0)
OERR ; update status in ORDER file (100)
"RTN","SRSUP1",56,0)
 S SROERR=SRTN D ^SROERR0
"RTN","SRSUP1",57,0)
 Q
"RTN","SRSUP1",58,0)
SRDYN I SPD'=$$CHKS^SRSCOR(SRTN) S ^TMP("CSLSUR1",$J)=""
"RTN","SRSUP1",59,0)
 Q
"RTN","SRSUPC")
0^103^B7743262
"RTN","SRSUPC",1,0)
SRSUPC ;B'HAM ISC/MAM - UPDATE CANCEL REASON & DATE; [ 01/31/01  8:59 AM ]
"RTN","SRSUPC",2,0)
 ;;3.0; Surgery ;**100**;24 Jun 93
"RTN","SRSUPC",3,0)
PAT ;
"RTN","SRSUPC",4,0)
 W @IOF S DIC=2,DIC(0)="QEAMZ",DIC("A")="Update Cancellation Information for which Patient: " D ^DIC K DIC G:Y'>0 END S DFN=+Y
"RTN","SRSUPC",5,0)
 D DEM^VADPT S SRNAME=VADM(1)
"RTN","SRSUPC",6,0)
 W ! S (SROP,CNT)=0 F  S SROP=$O(^SRF("B",DFN,SROP)) Q:'SROP  S SRSDATE=$P(^SRF(SROP,0),"^",9) D LIST
"RTN","SRSUPC",7,0)
 I '$D(SRCASE(1)) W !!,"There are no cancelled cases for "_SRNAME_"." G END
"RTN","SRSUPC",8,0)
OPT R !!!,"Select Operation:  ",OPT:DTIME I '$T!("^"[OPT) K SRTN G END
"RTN","SRSUPC",9,0)
 I OPT["?"!('$D(SRCASE(OPT))) W !!,"Enter the number of the desired operation" G OPT
"RTN","SRSUPC",10,0)
 S SROP=SRCASE(OPT),SRSDATE=$P(^SRF(SROP,0),"^",9),SRSDATE=$E(SRSDATE,4,5)_"-"_$E(SRSDATE,6,7)_"-"_$E(SRSDATE,2,3)
"RTN","SRSUPC",11,0)
 W @IOF,!,VADM(1),?32,VA("PID"),?50,"Case # ",SROP,!!,SRSDATE D CASE W !!
"RTN","SRSUPC",12,0)
 I $$LOCK^SROUTL(SROP) S DIE=130,DA=SRCASE(OPT),DR="17T;18T;67T" D ^DIE,UNLOCK^SROUTL(SROP)
"RTN","SRSUPC",13,0)
END W !!,"Press RETURN to continue  " R X:DTIME
"RTN","SRSUPC",14,0)
 W @IOF K SROP D ^SRSKILL
"RTN","SRSUPC",15,0)
 Q
"RTN","SRSUPC",16,0)
LOOP ; break operation name if longer than 65 characters
"RTN","SRSUPC",17,0)
 S SROPS(M)="" F LOOP=1:1 S MM=$P(SROPER," "),MMM=$P(SROPER," ",2,200) Q:MMM=""  Q:$L(SROPS(M))+$L(MM)'<65  S SROPS(M)=SROPS(M)_MM_" ",SROPER=MMM
"RTN","SRSUPC",18,0)
 Q
"RTN","SRSUPC",19,0)
OTHER ; other operations
"RTN","SRSUPC",20,0)
 S SRLONG=1 I $L(SROPER)+$L($P(^SRF(SROP,13,SROTHER,0),"^"))>235 S SRLONG=0,SROTHER=999,SROPERS=" ..."
"RTN","SRSUPC",21,0)
 I SRLONG S SROPERS=$P(^SRF(SROP,13,SROTHER,0),"^")
"RTN","SRSUPC",22,0)
 S SROPER=SROPER_$S(SROPERS=" ...":SROPERS,1:", "_SROPERS)
"RTN","SRSUPC",23,0)
 Q
"RTN","SRSUPC",24,0)
LIST ;
"RTN","SRSUPC",25,0)
 S SRCAN=0
"RTN","SRSUPC",26,0)
 I $D(^SRF(SROP,30)),$P(^(30),"^")'="" S SRCAN=1
"RTN","SRSUPC",27,0)
 I $D(^SRF(SROP,31)),$P(^(31),"^",8)'="" S SRCAN=1
"RTN","SRSUPC",28,0)
 I 'SRCAN Q
"RTN","SRSUPC",29,0)
 S CNT=CNT+1,SRCASE(CNT)=SROP
"RTN","SRSUPC",30,0)
 W !,CNT_". "_$E(SRSDATE,4,5)_"-"_$E(SRSDATE,6,7)_"-"_$E(SRSDATE,2,3)
"RTN","SRSUPC",31,0)
CASE S SROPER=$P(^SRF(SROP,"OP"),"^") I $O(^SRF(SROP,13,0)) S SROTHER=0 F I=0:0 S SROTHER=$O(^SRF(SROP,13,SROTHER)) Q:'SROTHER  D OTHER
"RTN","SRSUPC",32,0)
 D ^SROP1 K SROPS,MM,MMM S:$L(SROPER)<65 SROPS(1)=SROPER I $L(SROPER)>64 S SROPER=SROPER_"  " F M=1:1 D LOOP Q:MMM=""
"RTN","SRSUPC",33,0)
 W ?14,SROPS(1) I $D(SROPS(2)) W !,?14,SROPS(2) I $D(SROPS(3)) W !,?14,SROPS(3) W:$D(SROPS(4)) !,?14,SROPS(4) W:$D(SROPS(5)) !,?14,SROPS(5)
"RTN","SRSUPRQ")
0^104^B27812570
"RTN","SRSUPRQ",1,0)
SRSUPRQ ;B'HAM ISC/MAM - UPDATE REQUESTED OPERATIONS; [ 08/29/01  9:04 AM ]
"RTN","SRSUPRQ",2,0)
 ;;3.0; Surgery ;**7,47,58,67,107,114,100**;24 Jun 93
"RTN","SRSUPRQ",3,0)
 ;
"RTN","SRSUPRQ",4,0)
 ; Reference to ^TMP("CSLSUR1" supported by DBIA #3498
"RTN","SRSUPRQ",5,0)
 ;
"RTN","SRSUPRQ",6,0)
 K SRSCHED
"RTN","SRSUPRQ",7,0)
ASK K DIC,SRCASE S SRSOUT=0,DIC=2,DIC(0)="QEAMZ",DIC("A")="Select Patient: " D ^DIC K DIC Q:Y<0  S SRDFN=+Y,SRNM=$P(Y(0),"^")
"RTN","SRSUPRQ",8,0)
 S (CNT,SRSDATE,SRTN)=0 F  S SRSDATE=$O(^SRF("AR",SRSDATE)) Q:'SRSDATE  F  S SRTN=$O(^SRF("AR",SRSDATE,SRDFN,SRTN)) Q:'SRTN  D SETUP
"RTN","SRSUPRQ",9,0)
 I '$D(SRCASE(1)) W !!,"There are no requested cases for "_SRNM_"." G END
"RTN","SRSUPRQ",10,0)
 S GRAMMER=$S($D(SRCASE(2)):"cases are",1:"case is") W @IOF,!,"The following "_GRAMMER_" requested for "_SRNM_":",!
"RTN","SRSUPRQ",11,0)
 S CNT=0 F  S CNT=$O(SRCASE(CNT)) Q:'CNT  D OPS W !,$P(SRCASE(CNT),"^",2),?15,SROPS(1) I $D(SROPS(2)) W !,?15,SROPS(2) I $D(SROPS(3)) W !,?15,SROPS(3)
"RTN","SRSUPRQ",12,0)
OPT S SREQ=1 I $D(SRCASE(2)) D MANY
"RTN","SRSUPRQ",13,0)
 G:"^"[SREQ END S:'$D(SRCASE(2)) SRTN=$P(SRCASE(1),"^") S SRSDATE=$E($P(^SRF(SRTN,0),"^",9),1,7) I $P(^SRF(SRTN,0),"^",4)="" D SS^SRSCHUP I SRSOUT K SRTN
"RTN","SRSUPRQ",14,0)
 Q:$D(SRSCHED)  G:'$D(SRTN) END W !!,"1. Delete",!,"2. Update Request Information",!,"3. Change the Request Date"
"RTN","SRSUPRQ",15,0)
SEL W !!,"Select Number: " R Z:DTIME S:'$T!("^"[Z) SRSOUT=1 G:SRSOUT END S:Z["?" Z=4
"RTN","SRSUPRQ",16,0)
 I Z<1!(Z>3)!(+Z\1'=Z) W !!,"If you want to delete this request, enter '1'.  Enter '2' if you only want",!,"to update the general information about this case, or '3' to change the date",!,"that this case is requested for." G SEL
"RTN","SRSUPRQ",17,0)
 I Z=1 D DEL G END
"RTN","SRSUPRQ",18,0)
 I Z=2 D UPDATE S SRSOUT=1 G END
"RTN","SRSUPRQ",19,0)
 I Z=3 D CHANGE^SRSDT
"RTN","SRSUPRQ",20,0)
END I '$D(SRLATE) S SRLATE=0
"RTN","SRSUPRQ",21,0)
 I 'SRLATE,'SRSOUT W !!,"Press RETURN to continue  " R X:DTIME
"RTN","SRSUPRQ",22,0)
 W @IOF D ^SRSKILL K SRTN,SRTN1,SRTNX
"RTN","SRSUPRQ",23,0)
 Q
"RTN","SRSUPRQ",24,0)
OPS S SROPER=$P(SRCASE(CNT),"^",3) K SROPS,MM,MMM S:$L(SROPER)<60 SROPS(1)=SROPER I $L(SROPER)>59 S SROPER=SROPER_"  " F M=1:1 D LOOP Q:MMM=""
"RTN","SRSUPRQ",25,0)
 Q
"RTN","SRSUPRQ",26,0)
LOOP ; break procedure if greater than 60 characters
"RTN","SRSUPRQ",27,0)
 S SROPS(M)="" F LOOP=1:1 S MM=$P(SROPER," "),MMM=$P(SROPER," ",2,200) Q:MMM=""  Q:$L(SROPS(M))+$L(MM)'<60  S SROPS(M)=SROPS(M)_MM_" ",SROPER=MMM
"RTN","SRSUPRQ",28,0)
 Q
"RTN","SRSUPRQ",29,0)
MANY ; select requested case if more than one
"RTN","SRSUPRQ",30,0)
 W !!,"Select Operation Request: " R SREQ:DTIME S:'$T SREQ="^" Q:"^"[SREQ  I SREQ["?"!'$D(SRCASE(SREQ)) W !!,"Enter the number corresponding to the request that will be updated or deleted. " G MANY
"RTN","SRSUPRQ",31,0)
 S SRTN=$P(SRCASE(SREQ),"^")
"RTN","SRSUPRQ",32,0)
 Q
"RTN","SRSUPRQ",33,0)
SETUP ; set SRCASE array to list requested cases for this patient
"RTN","SRSUPRQ",34,0)
 S CNT=CNT+1,SRSDT=$P(^SRF(SRTN,0),"^",9),SRSDT=$E(SRSDT,4,5)_"-"_$E(SRSDT,6,7)_"-"_$E(SRSDT,2,3),SRCASE(CNT)=SRTN_"^"_CNT_".  "_SRSDT_"^"_$P(^SRF(SRTN,"OP"),"^")
"RTN","SRSUPRQ",35,0)
 Q
"RTN","SRSUPRQ",36,0)
DEL ; delete request
"RTN","SRSUPRQ",37,0)
 S SRBOTH=0 W !!,"Are you sure that you want to delete this request ?  YES// " R X:DTIME S:'$T X="N" S:X="" X="Y" I X["?" W !!,"Enter RETURN if this request is to be deleted, or NO to quit. " G DEL
"RTN","SRSUPRQ",38,0)
 S X=$E(X) Q:"Yy"'[X  I '$$LOCK^SROUTL(SRTN) Q
"RTN","SRSUPRQ",39,0)
 K DIE,DR,DA S DA=SRTN,DIE=130,DR="36///0;Q;.09///"_SRSDATE D ^DIE K DR,DA,DIE S SRSDOC=$P(^SRF(SRTN,.1),"^",4)
"RTN","SRSUPRQ",40,0)
 S SRCON=$P($G(^SRF(SRTN,"CON")),"^") I SRCON D CON I SRBOTH="^" G END
"RTN","SRSUPRQ",41,0)
OPALSO ; delete from file 130
"RTN","SRSUPRQ",42,0)
 S SROPCOM="Operation ..."
"RTN","SRSUPRQ",43,0)
 S DFN=SRDFN,SRCC="",SRTNX=SRTN D KILL^SROPDEL,UNLOCK^SROUTL(SRTNX) S SRTN=SRTN1 I $D(SRCON) S SRC="" G:"^"[SRBOTH END I SRBOTH=1 S SRTN=SRCON,SRCC="Concurrent " D KILL^SROPDEL,UNLOCK^SROUTL(SRCON)
"RTN","SRSUPRQ",44,0)
 Q
"RTN","SRSUPRQ",45,0)
CON S SRCON=^SRF(SRTN,"CON"),SRC="the request for" D CC Q:SRBOTH="^"  I SRBOTH=1 K DIE,DR,DA S DA=SRCON,DIE=130,DR="36///0;Q;.09///"_SRSDATE D ^DIE K DR,DIE,DA S SRSDOCC=$P(^SRF(SRCON,.1),"^",4)
"RTN","SRSUPRQ",46,0)
 Q
"RTN","SRSUPRQ",47,0)
CC ; check to see if concurrent case should be deleted
"RTN","SRSUPRQ",48,0)
 W !!,"A concurrent case has been requested for this operation.  Do you want to",!,"delete "_SRC_" it also ?  YES// " R SRBOTH:DTIME S:'$T SRBOTH="^" I SRBOTH["?" W !!,"Enter 'Y' if you want to delete "_SRC_" concurrent case." G CC
"RTN","SRSUPRQ",49,0)
 S:SRBOTH="" SRBOTH="Y" S SRBOTH=$E(SRBOTH) I "YyNn"'[SRBOTH W !!,"Enter RETURN if you want these case to remain concurrent." G CC
"RTN","SRSUPRQ",50,0)
 I SRBOTH["Y" S SRBOTH=1
"RTN","SRSUPRQ",51,0)
 S DA=SRCON,DR="35///@",DIE=130 D ^DIE S SROERR=SRCON D ^SROERR0 S DA=SRTN,DR="35///@",DIE=130 D ^DIE
"RTN","SRSUPRQ",52,0)
 I SRBOTH'=1 K SRCON
"RTN","SRSUPRQ",53,0)
 Q
"RTN","SRSUPRQ",54,0)
UPDATE ; update requested operation
"RTN","SRSUPRQ",55,0)
 N SRLCK S SRLCK=$$LOCK^SROUTL(SRTN) Q:'SRLCK
"RTN","SRSUPRQ",56,0)
 D AVG^SRSREQ D RT K SRLNTH,SRLNTH1,DR,X
"RTN","SRSUPRQ",57,0)
 S ST="UPDATE REQUEST",DA=SRTN,DIE=130,DR="[SRSRES-ENTRY]" D EN2^SROVAR K Q3("VIEW"),Y S SPD=$$CHKS^SRSCOR(SRTN) D ^SRCUSS I SPD'=$$CHKS^SRSCOR(SRTN) S ^TMP("CSLSUR1",$J)=""
"RTN","SRSUPRQ",58,0)
 K DR D:$D(SRODR) ^SROCON1 D RISK^SROAUTL3,^SROPCE1
"RTN","SRSUPRQ",59,0)
 S SROERR=SRTN K SRTX D ^SROERR0
"RTN","SRSUPRQ",60,0)
 I $G(SRLCK) D UNLOCK^SROUTL(SRTN)
"RTN","SRSUPRQ",61,0)
 Q
"RTN","SRSUPRQ",62,0)
RT ; start RT logging
"RTN","SRSUPRQ",63,0)
 I $D(XRTL) S XRTN="SRSUPRQ" D T0^%ZOSV
"RTN","SRSUPRQ",64,0)
 Q
"UP",130,130.0129,-1)
130^44
"UP",130,130.0129,0)
130.0129
"UP",130,130.013,-1)
130^45
"UP",130,130.013,0)
130.013
"UP",130,130.0134,-2)
130^45
"UP",130,130.0134,-1)
130.013^1
"UP",130,130.0134,0)
130.0134
"UP",130,130.0135,-2)
130^45
"UP",130,130.0135,-1)
130.013^2
"UP",130,130.0135,0)
130.0135
"UP",130,130.02,-1)
130^2
"UP",130,130.02,0)
130.02
"UP",130,130.1,-1)
130^48
"UP",130,130.1,0)
130.1
"UP",130,130.1295,-2)
130^44
"UP",130,130.1295,-1)
130.0129^1
"UP",130,130.1295,0)
130.1295
"UP",130,130.28,-1)
130^19
"UP",130,130.28,0)
130.28
"VER")
8.0^22.0
"^DD",130,130,.09,0)
DATE OF OPERATION^RDX^^0;9^S %DT="ETX" D ^%DT S X=Y K:Y<1 X I $D(X) D SCH^SRODATE
"^DD",130,130,.09,.1)
Date of Operation
"^DD",130,130,.09,1,0)
^.1
"^DD",130,130,.09,1,1,0)
130^AC^MUMPS
"^DD",130,130,.09,1,1,1)
S ^SRF("AC",X,DA)=$P(^SRF(DA,0),"^")
"^DD",130,130,.09,1,1,2)
K ^SRF("AC",X,DA)
"^DD",130,130,.09,1,1,"%D",0)
^^2^2^2930128^
"^DD",130,130,.09,1,1,"%D",1,0)
The AC cross reference on the DATE OF OPERATION field is used to sort
"^DD",130,130,.09,1,1,"%D",2,0)
entries by date of operation for reports.
"^DD",130,130,.09,1,2,0)
130^ADT^MUMPS
"^DD",130,130,.09,1,2,1)
D ADT^SROXR2
"^DD",130,130,.09,1,2,2)
D KADT^SROXR2
"^DD",130,130,.09,1,2,"%D",0)
^^3^3^2930128^^^
"^DD",130,130,.09,1,2,"%D",1,0)
The ADT cross reference on the DATE OF OPERATION field uses the 'inverse'
"^DD",130,130,.09,1,2,"%D",2,0)
date/time format to sort and to display cases by inverse chronological
"^DD",130,130,.09,1,2,"%D",3,0)
order.
"^DD",130,130,.09,1,3,0)
130^ASP1^MUMPS
"^DD",130,130,.09,1,3,1)
D SP^SROXR1
"^DD",130,130,.09,1,3,2)
D KSP^SROXR1
"^DD",130,130,.09,1,3,"%D",0)
^^2^2^2930128^^
"^DD",130,130,.09,1,3,"%D",1,0)
The ASP1 cross reference on the DATE OF OPERATION field updates the
"^DD",130,130,.09,1,3,"%D",2,0)
ASP and the AOR cross references when the date of operation is changed.
"^DD",130,130,.09,1,4,0)
130^AR^MUMPS
"^DD",130,130,.09,1,4,1)
D AR^SROXR1
"^DD",130,130,.09,1,4,2)
D KAR^SROXR1
"^DD",130,130,.09,1,4,"%D",0)
^^4^4^2930128^^^
"^DD",130,130,.09,1,4,"%D",1,0)
The AR cross reference on the DATE OF OPERATION field is used to sort
"^DD",130,130,.09,1,4,"%D",2,0)
and display requested cases.  This cross reference is created when a
"^DD",130,130,.09,1,4,"%D",3,0)
case is requested or when the request date is changed.  Upon scheduling
"^DD",130,130,.09,1,4,"%D",4,0)
the request, the AR cross reference for the case is deleted.
"^DD",130,130,.09,1,4,"DT")
2911002
"^DD",130,130,.09,3)
Enter the date that the principal operation was performed.  The patient may have more than principal operation (and operative record) on the same day.
"^DD",130,130,.09,5,1,0)
130^.205^1
"^DD",130,130,.09,5,2,0)
130^120^1
"^DD",130,130,.09,21,0)
^^2^2^2900104^
"^DD",130,130,.09,21,1,0)
This is the date that the case was performed.  The date of operation
"^DD",130,130,.09,21,2,0)
must be entered for all cases.
"^DD",130,130,.09,"DT")
3021122
"^DD",130,130,.111,0)
OR CIRC SUPPORT^130.28PA^^19;0
"^DD",130,130,.111,.1)
O.R. Circulating Nurse
"^DD",130,130,.111,21,0)
^^3^3^2921026^^
"^DD",130,130,.111,21,1,0)
This is information about the nurses with circulating role 
"^DD",130,130,.111,21,2,0)
responsibilities.
"^DD",130,130,.111,21,3,0)
 
"^DD",130,130,.14,0)
SURGEON^R*P200'^VA(200,^.1;4^S DIC("S")="S RESTRICT=""130,.14"" D KEY^SROXPR I $D(SROK)" D ^DIC K DIC S DIC=DIE,X=+Y K:Y<0 X
"^DD",130,130,.14,.1)
Surgeon
"^DD",130,130,.14,1,0)
^.1
"^DD",130,130,.14,1,1,0)
130^ASR^MUMPS
"^DD",130,130,.14,1,1,1)
D STAFF^SROXR1
"^DD",130,130,.14,1,1,2)
D KSTAFF^SROXR1
"^DD",130,130,.14,1,1,"%D",0)
^^2^2^2930128^^
"^DD",130,130,.14,1,1,"%D",1,0)
The ASR cross reference on the SURGEON field is used to update the
"^DD",130,130,.14,1,1,"%D",2,0)
STAFF/RESIDENT field when a surgeon is entered.
"^DD",130,130,.14,1,1,"DT")
2920415
"^DD",130,130,.14,1,2,0)
130^APCE1^MUMPS
"^DD",130,130,.14,1,2,1)
D APCE^SROPCEX
"^DD",130,130,.14,1,2,2)
S SRFLD=.14 D KAPCE^SROPCEX
"^DD",130,130,.14,1,2,"%D",0)
^^2^2^2960906^^^^
"^DD",130,130,.14,1,2,"%D",1,0)
This MUMPS cross reference maintains the APCE cross reference nodes
"^DD",130,130,.14,1,2,"%D",2,0)
used in updating PCE.
"^DD",130,130,.14,1,2,"DT")
2960906
"^DD",130,130,.14,3)
Enter the name of the privileged person who performs the major portion of the principal operation.
"^DD",130,130,.14,12)
Entries into this field may be restricted based on locally selected keys.
"^DD",130,130,.14,12.1)
S DIC("S")="S RESTRICT=""130,.14"" D KEY^SROXPR I $D(SROK)"
"^DD",130,130,.14,21,0)
^^7^7^2921026^^^^
"^DD",130,130,.14,21,1,0)
This is the name of the person performing the major portion of
"^DD",130,130,.14,21,2,0)
the principal operative procedure.  This field is required as
"^DD",130,130,.14,21,3,0)
part of the Operation Report.
"^DD",130,130,.14,21,4,0)
 
"^DD",130,130,.14,21,5,0)
This field may be restricted by locally determined keys so that only
"^DD",130,130,.14,21,6,0)
people with the appropriate keys can be entered.
"^DD",130,130,.14,21,7,0)
 
"^DD",130,130,.14,22)

"^DD",130,130,.14,"DT")
3021122
"^DD",130,130,.164,0)
ATTEND SURG^*P200'^VA(200,^.1;13^S DIC("S")="S RESTRICT=""130,.164"" D KEY^SROXPR I $D(SROK)" D ^DIC K DIC S DIC=DIE,X=+Y K:Y<0 X
"^DD",130,130,.164,.1)
Attending Surgeon
"^DD",130,130,.164,1,0)
^.1
"^DD",130,130,.164,1,1,0)
130^APCE4^MUMPS
"^DD",130,130,.164,1,1,1)
D APCE^SROPCEX
"^DD",130,130,.164,1,1,2)
S SRFLD=.164 D KAPCE^SROPCEX
"^DD",130,130,.164,1,1,"%D",0)
^^2^2^2960906^^^^
"^DD",130,130,.164,1,1,"%D",1,0)
This MUMPS cross reference maintains the APCE cross reference nodes
"^DD",130,130,.164,1,1,"%D",2,0)
used in updating PCE.
"^DD",130,130,.164,1,1,"DT")
2960906
"^DD",130,130,.164,3)
Enter the name of the attending staff surgeon.  This is required when the surgeon is in training status.
"^DD",130,130,.164,12)
Entries in this field may be restricted based on locally selected keys.
"^DD",130,130,.164,12.1)
S DIC("S")="S RESTRICT=""130,.164"" D KEY^SROXPR I $D(SROK)"
"^DD",130,130,.164,21,0)
5^^4^4^2920221^^^
"^DD",130,130,.164,21,1,0)
This is the name of the attending staff surgeon responsible for
"^DD",130,130,.164,21,2,0)
this case.  This information appears on the Operation Report, Nurse
"^DD",130,130,.164,21,3,0)
Intraoperative Report, and Attending Surgeon Report.
"^DD",130,130,.164,21,4,0)
 
"^DD",130,130,.164,"DT")
3030110
"^DD",130,130,.21,0)
ANES CARE START TIME^DX^^.2;1^S Z=$E($P(^SRF(D0,0),U,9),1,7) D TIME^SROVAR S %DT="ETX" D ^%DT S X=Y K:Y<1!(X'[".") X I $D(X),$D(^SRF(DA,"CON")),$P(^("CON"),"^") S SRFLD=.21 D ^SROCON Q
"^DD",130,130,.21,.1)
Anesthesia Care Start Time
"^DD",130,130,.21,1,0)
^.1^^-1
"^DD",130,130,.21,1,1,0)
130^AF^MUMPS
"^DD",130,130,.21,1,1,1)
Q:'$D(SRTN)!('$D(SRSITE("IV")))!('$D(DT))  I SRSITE("IV") D IV^SROXR1
"^DD",130,130,.21,1,1,2)
Q
"^DD",130,130,.21,1,1,"%D",0)
^^12^12^3030910^
"^DD",130,130,.21,1,1,"%D",1,0)
The AF MUMPS cross reference on this field is responsible for canceling
"^DD",130,130,.21,1,1,"%D",2,0)
current IV orders for a patient undergoing a surgical or non-OR procedure
"^DD",130,130,.21,1,1,"%D",3,0)
if the site parameter is set to allow cancellation of IV orders. 
"^DD",130,130,.21,1,1,"%D",4,0)
 
"^DD",130,130,.21,1,1,"%D",5,0)
This cross reference compares the time entered in the ANES CARE START TIME
"^DD",130,130,.21,1,1,"%D",6,0)
field with the current time. If the difference is more than 24 hours,
"^DD",130,130,.21,1,1,"%D",7,0)
order cancellation is not allowed. If the difference is more than 1 hour,
"^DD",130,130,.21,1,1,"%D",8,0)
but not more than 24 hours, the user is warned that a considerable amount
"^DD",130,130,.21,1,1,"%D",9,0)
of time has passed since the start of the operation or procedure. Finally,
"^DD",130,130,.21,1,1,"%D",10,0)
if order cancellation is allowed, the user is prompted to cancel current
"^DD",130,130,.21,1,1,"%D",11,0)
IV orders or not. If the user chooses to cancel IV orders, the Surgery
"^DD",130,130,.21,1,1,"%D",12,0)
software calls DCOR^PSIVACT.
"^DD",130,130,.21,1,1,"DT")
2970915
"^DD",130,130,.21,3)
Enter the time a member of the Anesthesia staff begins preparing the patient for surgery in the O.R. suite.
"^DD",130,130,.21,21,0)
^.001^4^4^3030910^^^^
"^DD",130,130,.21,21,1,0)
This is the date and time that the anesthesia care began.  It is required
"^DD",130,130,.21,21,2,0)
as part of the anesthesia report.  The definition of what constitutes the
"^DD",130,130,.21,21,3,0)
time anesthesia care begins may vary depending on local anesthesia policy.
"^DD",130,130,.21,21,4,0)
 
"^DD",130,130,.21,"DT")
2970915
"^DD",130,130,.23,0)
TIME OPERATION ENDS^DX^^.2;3^S SRN=.2,SRP=2,SR130="TIME OPERATION BEGAN" D TERM^SROVAR K:Y<1 X
"^DD",130,130,.23,.1)
Time the Operation Ends
"^DD",130,130,.23,1,0)
^.1^^0
"^DD",130,130,.23,3)
Enter the time wherein all surgical procedures related to this operation are complete.
"^DD",130,130,.23,21,0)
^.001^5^5^3020930^^^^
"^DD",130,130,.23,21,1,0)
This is the date and time that all operative procedures for this case
"^DD",130,130,.23,21,2,0)
are complete.  This time is usually the 'dressing complete' time, but
"^DD",130,130,.23,21,3,0)
it may vary according to local Surgery service protocol.  The patient
"^DD",130,130,.23,21,4,0)
record will be incomplete until this information is entered.
"^DD",130,130,.23,21,5,0)
 
"^DD",130,130,.23,"DT")
2980109
"^DD",130,130,.232,0)
TIME PAT OUT OR^DX^^.2;12^S SRN=.2,SRP=10,SR130="TIME PAT IN OR" D TERM^SROVAR K:Y<1 X I $D(DA),$D(X),$D(^SRF(DA,"CON")),$P(^("CON"),"^") S SRFLD=.232 D ^SROCON Q
"^DD",130,130,.232,.1)
Time Patient Out of the O.R.
"^DD",130,130,.232,1,0)
^.1^^-1
"^DD",130,130,.232,1,1,0)
130^AH^MUMPS
"^DD",130,130,.232,1,1,1)
I $D(^SRF(DA,14)),'$D(^(15)) S %X="^SRF(DA,14,",%Y="^SRF(DA,15," D %XY^%RCR S ^(0)="^130.18A"_U_$P(^SRF(DA,15,0),U,3,4) K %X,%Y
"^DD",130,130,.232,1,1,2)
Q
"^DD",130,130,.232,1,1,"%D",0)
^^3^3^2930128^^
"^DD",130,130,.232,1,1,"%D",1,0)
The AH cross reference on the TIME PAT OUT OR field moves the OTHER PREOP
"^DD",130,130,.232,1,1,"%D",2,0)
DIAGNOSIS information into the OTHER POSTOP DIAGS subfile when the TIME
"^DD",130,130,.232,1,1,"%D",3,0)
PAT OUT OR is entered.
"^DD",130,130,.232,1,3,0)
130^AM1^MUMPS
"^DD",130,130,.232,1,3,1)
D AM1^SROXR2
"^DD",130,130,.232,1,3,2)
Q
"^DD",130,130,.232,1,3,"%D",0)
^^4^4^2930301^^^
"^DD",130,130,.232,1,3,"%D",1,0)
The AM1 cross reference on the TIME PAT OUT OR field is responsible for
"^DD",130,130,.232,1,3,"%D",2,0)
removing the AMM cross reference for the case and for updating the
"^DD",130,130,.232,1,3,"%D",3,0)
scheduling display graph.  In addition, if the case is a reqested case,
"^DD",130,130,.232,1,3,"%D",4,0)
the AR cross reference is removed if it still exists.
"^DD",130,130,.232,1,4,0)
130^APCE7^MUMPS
"^DD",130,130,.232,1,4,1)
D APCE^SROPCEX
"^DD",130,130,.232,1,4,2)
S SRFLD=.232 D KAPCE^SROPCEX
"^DD",130,130,.232,1,4,"%D",0)
^^2^2^2960906^^^^
"^DD",130,130,.232,1,4,"%D",1,0)
This MUMPS cross reference maintains the APCE cross reference nodes
"^DD",130,130,.232,1,4,"%D",2,0)
used in updating PCE.
"^DD",130,130,.232,1,4,"DT")
2960906
"^DD",130,130,.232,1,5,0)
130^AQ^MUMPS
"^DD",130,130,.232,1,5,1)
D AQ^SROXR4
"^DD",130,130,.232,1,5,2)
D KAQ^SROXR4
"^DD",130,130,.232,1,5,"%D",0)
^^2^2^2970123^
"^DD",130,130,.232,1,5,"%D",1,0)
This MUMPS cross reference is used by the transmission process to the
"^DD",130,130,.232,1,5,"%D",2,0)
national database.
"^DD",130,130,.232,1,5,"DT")
2970123
"^DD",130,130,.232,1,6,0)
130^AOE^MUMPS
"^DD",130,130,.232,1,6,1)
I $L($T(OR1^ORMEVNT1)) D OR1^ORMEVNT1(DA,X)
"^DD",130,130,.232,1,6,2)
I $L($T(OR2^ORMEVNT1)) D OR2^ORMEVNT1(DA)
"^DD",130,130,.232,1,6,"%D",0)
^.101^1^1^3030115^^^^
"^DD",130,130,.232,1,6,"%D",1,0)
This MUMPS cross reference allows the CPRS to automatic discontinue or release orders when the patient leaves the OR.
"^DD",130,130,.232,1,6,"DT")
3020816
"^DD",130,130,.232,3)
Enter the time that the patient is taken from the operating room, i.e. 7:45, 0745, 745, T@7:45, JAN 1@745 ...
"^DD",130,130,.232,21,0)
^^5^5^2900621^^^^
"^DD",130,130,.232,21,1,0)
This is the date and time that the patient is taken from the operating
"^DD",130,130,.232,21,2,0)
room.  Times entered without a date will be converted to the date of
"^DD",130,130,.232,21,3,0)
operation at that time.  This information is very significant for
"^DD",130,130,.232,21,4,0)
operating room management studies.
"^DD",130,130,.232,21,5,0)
 
"^DD",130,130,.232,"DEL",1,0)
I $$DEL^SROESX(DA,"1,2") D EN^DDIOL("The TIME PAT OUT OR can't be deleted. This case has one or more operative",,"!!,?2") D EN^DDIOL("reports associated with it.",,"!,?2")
"^DD",130,130,.232,"DT")
3020816
"^DD",130,130,.24,0)
ANES CARE END TIME^DX^^.2;4^S SRN=.2,SRP=1,SR130="ANES CARE START TIME" D TERM^SROVAR K:Y<1 X I $D(DA),$D(X),$D(^SRF(DA,"CON")),$P(^("CON"),"^") S SRFLD=.24 D ^SROCON Q
"^DD",130,130,.24,.1)
Anesthesia Care End Time
"^DD",130,130,.24,3)
Enter the time that the anesthesia staff transfers care to other care providers.
"^DD",130,130,.24,21,0)
^.001^4^4^3040225^^^^
"^DD",130,130,.24,21,1,0)
This is the date and time that anesthesia care ends.  Its definition
"^DD",130,130,.24,21,2,0)
may vary according to local anesthesia policy.  Acceptable time formats
"^DD",130,130,.24,21,3,0)
include 7:45, 745, T@7:45 and JAN 1@7:45.  Times entered without a date
"^DD",130,130,.24,21,4,0)
will be converted to the date of the operation at that time.
"^DD",130,130,.24,"DEL",1,0)
I $$DEL^SROESX(DA,"4") D EN^DDIOL("The ANES CARE END TIME field cannot be deleted. This case has an",,"!!,?2") D EN^DDIOL("Anesthesia Report associated with it.",,"!,?2")
"^DD",130,130,.24,"DT")
3010405
"^DD",130,130,.31,0)
PRINC ANESTHETIST^*P200'^VA(200,^.3;1^S DIC("S")="S RESTRICT=""130,.31"" D KEY^SROXPR I $D(SROK)" D ^DIC K DIC S DIC=DIE,X=+Y K:Y<0 X
"^DD",130,130,.31,.1)
Principal Anesthetist
"^DD",130,130,.31,1,0)
^.1
"^DD",130,130,.31,1,1,0)
130^ANES^MUMPS
"^DD",130,130,.31,1,1,1)
D ANES^SROXR1
"^DD",130,130,.31,1,1,2)
D KANES^SROXR1
"^DD",130,130,.31,1,1,"%D",0)
^^2^2^2930129^^
"^DD",130,130,.31,1,1,"%D",1,0)
The ANES cross reference on the PRINC ANESTHETIST field updates the
"^DD",130,130,.31,1,1,"%D",2,0)
ANESTHETIST CATEGORY field when a principal anesthetist is entered.
"^DD",130,130,.31,1,1,"DT")
2921105
"^DD",130,130,.31,3)
This may be the anesthesiologist or CRNA (or surgeon, if local)
"^DD",130,130,.31,12)
Entries in this field may be restricted based on locally selected keys.
"^DD",130,130,.31,12.1)
S DIC("S")="S RESTRICT=""130,.31"" D KEY^SROXPR I $D(SROK)"
"^DD",130,130,.31,21,0)
^^4^4^2921106^^^^
"^DD",130,130,.31,21,1,0)
This is the name of the principal anesthesiologist or CRNA (or surgeon,
"^DD",130,130,.31,21,2,0)
if local anesthesia).  This information is extremely important for the
"^DD",130,130,.31,21,3,0)
Anesthesia Report.
"^DD",130,130,.31,21,4,0)
 
"^DD",130,130,.31,"DT")
3020207
"^DD",130,130,.34,0)
ANESTHESIOLOGIST SUPVR^*P200'^VA(200,^.3;4^S DIC("S")="S RESTRICT=""130,.34"" D KEY^SROXPR I $D(SROK)" D ^DIC K DIC S DIC=DIE,X=+Y K:Y<0 X
"^DD",130,130,.34,.1)
Anesthesiologist Supervisor
"^DD",130,130,.34,3)
Enter the name of the anesthesiology staff supervisor.
"^DD",130,130,.34,12)
Entries in this field may be restricted based on locally selected keys.
"^DD",130,130,.34,12.1)
S DIC("S")="S RESTRICT=""130,.34"" D KEY^SROXPR I $D(SROK)"
"^DD",130,130,.34,21,0)
^^5^5^2900105^^^
"^DD",130,130,.34,21,1,0)
This is the name of anesthesia supervisor.  He or she may be the same
"^DD",130,130,.34,21,2,0)
person entered in the 'PRINC ANESTHETIST' or 'ASST ANESTHETIST' fields.
"^DD",130,130,.34,21,3,0)
This information is required if the principal anesthetist is in a
"^DD",130,130,.34,21,4,0)
training status, or CRNA.
"^DD",130,130,.34,21,5,0)
 
"^DD",130,130,.34,"DT")
3020207
"^DD",130,130,.48,0)
TIME TOURNIQUET APPLIED^130.02DA^^2;0
"^DD",130,130,.48,.1)
Date/Time Tourniquet Applied
"^DD",130,130,.48,21,0)
^^2^2^2930111^^
"^DD",130,130,.48,21,1,0)
This is information related to the application of a tourniquet.
"^DD",130,130,.48,21,2,0)
 
"^DD",130,130,.48,"DT")
2930111
"^DD",130,130,1.19,0)
POSTOP ANES NOTE DATE^DX^^1.1;9^S SRN=.2,SRP=3,SR130="TIME OPERATION ENDS" D TERM^SROVAR K:Y<1 X I $D(DA),$D(X),$D(^SRF(DA,"CON")),$P(^("CON"),"^") S SRFLD=1.19 D ^SROCON Q
"^DD",130,130,1.19,.1)
Date/Time Postoperative Note Entered
"^DD",130,130,1.19,3)

"^DD",130,130,1.19,21,0)
^.001^4^4^3001023^^^^
"^DD",130,130,1.19,21,1,0)
This is the date and time that the postoperative note is written 
"^DD",130,130,1.19,21,2,0)
in the patient's chart.  Times entered without a date will be 
"^DD",130,130,1.19,21,3,0)
converted to the date of operation at that time.
"^DD",130,130,1.19,21,4,0)
 
"^DD",130,130,1.19,"DT")
3001023
"^DD",130,130,1.2,0)
POSTOP ANES NOTE^130.1^^48;0
"^DD",130,130,1.2,.1)
Postoperative Anesthesia Note
"^DD",130,130,1.2,21,0)
^^1^1^3010914^
"^DD",130,130,1.2,21,1,0)
This is the postoperative anesthesia note for this patient.
"^DD",130,130,15,0)
DATE/TIME OF DICTATION^DX^^31;6^S %DT="ET" D ^%DT S X=Y K:Y<1 X
"^DD",130,130,15,.1)
Date/Time of Dictation
"^DD",130,130,15,1,0)
^.1^^0
"^DD",130,130,15,21,0)
^^3^3^2900111^
"^DD",130,130,15,21,1,0)
This is the date and time that dictation of the operative summary
"^DD",130,130,15,21,2,0)
was completed.
"^DD",130,130,15,21,3,0)
 
"^DD",130,130,15,"DT")
2931213
"^DD",130,130,122,0)
TIME PROCEDURE ENDED^DX^^NON;5^S SRN="NON",SRP=4,SR130="TIME PROCEDURE BEGAN" D TERM^SROVAR K:Y<1 X
"^DD",130,130,122,.1)
Time Procedure Ended
"^DD",130,130,122,1,0)
^.1
"^DD",130,130,122,1,1,0)
130^AND^MUMPS
"^DD",130,130,122,1,1,1)
D AND^SRONXR
"^DD",130,130,122,1,1,2)
D KILLAND^SRONXR
"^DD",130,130,122,1,1,"%D",0)
^^3^3^2930129^^^^
"^DD",130,130,122,1,1,"%D",1,0)
The AND cross reference on the TIME PROCEDURE ENDED field updates the
"^DD",130,130,122,1,1,"%D",2,0)
ANES CARE END TIME if the non-O.R. procedure is assigned to the
"^DD",130,130,122,1,1,"%D",3,0)
Anesthesiology Medical Specialty.
"^DD",130,130,122,1,1,"DT")
2920117
"^DD",130,130,122,1,2,0)
130^APCE11^MUMPS
"^DD",130,130,122,1,2,1)
D APCE^SROPCEX
"^DD",130,130,122,1,2,2)
S SRFLD=122 D KAPCE^SROPCEX
"^DD",130,130,122,1,2,"%D",0)
^^2^2^2960907^^^^
"^DD",130,130,122,1,2,"%D",1,0)
This MUMPS cross reference maintains the APCE cross reference nodes
"^DD",130,130,122,1,2,"%D",2,0)
used in updating PCE.
"^DD",130,130,122,1,2,"DT")
2960907
"^DD",130,130,122,3)
Enter the time that the non-OR procedure was completed.
"^DD",130,130,122,21,0)
^^2^2^2911205^
"^DD",130,130,122,21,1,0)
This is the date and time that all the procedures for this non-OR case are
"^DD",130,130,122,21,2,0)
complete.
"^DD",130,130,122,"DEL",1,0)
I $$DEL^SROESX(DA,"3") D EN^DDIOL("The TIME PROCEDURE ENDED field can't be deleted. This case has a Procedure Report associated with it.",,"!,?2")
"^DD",130,130,122,"DT")
3010412
"^DD",130,130,123,0)
PROVIDER^R*P200'^VA(200,^NON;6^S DIC("S")="S RESTRICT=""130,123"" D KEY^SROXPR I $D(SROK)" D ^DIC K DIC S DIC=DIE,X=+Y K:Y<0 X
"^DD",130,130,123,.1)
Provider
"^DD",130,130,123,1,0)
^.1
"^DD",130,130,123,1,1,0)
130^APCE12^MUMPS
"^DD",130,130,123,1,1,1)
D APCE^SROPCEX
"^DD",130,130,123,1,1,2)
S SRFLD=123 D KAPCE^SROPCEX
"^DD",130,130,123,1,1,"%D",0)
^^2^2^2960906^^^^
"^DD",130,130,123,1,1,"%D",1,0)
This MUMPS cross reference maintains the APCE cross reference nodes
"^DD",130,130,123,1,1,"%D",2,0)
used in updating PCE.
"^DD",130,130,123,1,1,"DT")
2960906
"^DD",130,130,123,3)
Enter the name of the privileged person who performs the major portion of the principle procedure.
"^DD",130,130,123,12)
Entries in this field may be restricted based on locally selected keys.
"^DD",130,130,123,12.1)
S DIC("S")="S RESTRICT=""130,123"" D KEY^SROXPR I $D(SROK)"
"^DD",130,130,123,21,0)
^^2^2^2921026^^^
"^DD",130,130,123,21,1,0)
This is the person who performs the major portion of the principal non-OR
"^DD",130,130,123,21,2,0)
procedure.  This field is required for several reports.
"^DD",130,130,123,"DT")
3020205
"^DD",130,130,124,0)
ATTEND PROVIDER^*P200'X^VA(200,^NON;7^S DIC("S")="S RESTRICT=""130,124"" D KEY^SROXPR I $D(SROK)" D ^DIC K DIC S DIC=DIE,X=+Y K:Y<0 X
"^DD",130,130,124,.1)
Attending Provider
"^DD",130,130,124,1,0)
^.1
"^DD",130,130,124,1,1,0)
130^APCE13^MUMPS
"^DD",130,130,124,1,1,1)
D APCE^SROPCEX
"^DD",130,130,124,1,1,2)
S SRFLD=124 D KAPCE^SROPCEX
"^DD",130,130,124,1,1,"%D",0)
^^2^2^2960906^^^^
"^DD",130,130,124,1,1,"%D",1,0)
This MUMPS cross reference maintains the APCE cross reference nodes
"^DD",130,130,124,1,1,"%D",2,0)
used in updating PCE.
"^DD",130,130,124,1,1,"DT")
2960906
"^DD",130,130,124,3)
Enter the name of the attending staff provider.  This is required when the provider is in training status.
"^DD",130,130,124,12)
This field contains a screen which may be used to restrict entries based on locally defined keys.
"^DD",130,130,124,12.1)
S DIC("S")="S RESTRICT=""130,124"" D KEY^SROXPR I $D(SROK)"
"^DD",130,130,124,21,0)
^^2^2^2911206^
"^DD",130,130,124,21,1,0)
This is the name of the attending staff provider responsible for this case.
"^DD",130,130,124,21,2,0)
This information appears on several reports.
"^DD",130,130,124,"DT")
3020205
"^DD",130,130,129,0)
LASER UNIT^130.0129A^^44;0
"^DD",130,130,129,21,0)
^.001^1^1^3001010^^^^
"^DD",130,130,129,21,1,0)
These are the laser units, if any, used during this procedure.
"^DD",130,130,130,0)
CELL SAVER^130.013A^^45;0
"^DD",130,130,130,21,0)
^.001^1^1^3020226^^^^
"^DD",130,130,130,21,1,0)
These are the cell savers, if any, used during this procedure.
"^DD",130,130,131,0)
DEVICE(S)^F^^46;1^K:$L(X)>70!($L(X)<1) X
"^DD",130,130,131,.1)
Device(s)
"^DD",130,130,131,3)
Answer must be 1-70 characters in length.
"^DD",130,130,131,21,0)
^^2^2^3020226^
"^DD",130,130,131,21,1,0)
This field documents devices used in this procedure that are not
"^DD",130,130,131,21,2,0)
documented elsewhere.
"^DD",130,130,131,"DT")
3000905
"^DD",130,130,1000,0)
TIU OPERATIVE SUMMARY^P8925'^TIU(8925,^TIU;1^Q
"^DD",130,130,1000,.1)
TIU Operative Summary
"^DD",130,130,1000,3)
Enter the TIU document that holds the operative summary for this case.
"^DD",130,130,1000,21,0)
^.001^1^1^3020226^^
"^DD",130,130,1000,21,1,0)
This is the operative summary for this case stored in TIU.
"^DD",130,130,1000,"DT")
3000828
"^DD",130,130,1001,0)
TIU NURSE INTRAOP REPORT^P8925'^TIU(8925,^TIU;2^Q
"^DD",130,130,1001,.1)
TIU Nurse Intraoperative Report
"^DD",130,130,1001,3)
Enter the TIU document that holds the Nurse Intraoperative Report for this case.
"^DD",130,130,1001,21,0)
^.001^1^1^3020524^^^
"^DD",130,130,1001,21,1,0)
This is the Nurse Intraoperative Report for this case stored in TIU.
"^DD",130,130,1001,"DT")
3020524
"^DD",130,130,1002,0)
TIU PROCEDURE REPORT (NON-OR)^P8925'^TIU(8925,^TIU;3^Q
"^DD",130,130,1002,.1)
TIU Procedure Report (Non-OR)
"^DD",130,130,1002,3)
Enter the TIU document that holds the procedure summary for this non-OR procedure.
"^DD",130,130,1002,21,0)
^.001^1^1^3020226^^
"^DD",130,130,1002,21,1,0)
This is the Procedure Report (Non-OR) for this non-OR procedure.
"^DD",130,130,1002,"DT")
3001019
"^DD",130,130,1003,0)
TIU ANESTHESIA REPORT^P8925'^TIU(8925,^TIU;4^Q
"^DD",130,130,1003,.1)
TIU Anesthesia Report
"^DD",130,130,1003,3)
Enter the TIU document that holds the Anesthesia Report for this case.
"^DD",130,130,1003,21,0)
^^1^1^3000828^
"^DD",130,130,1003,21,1,0)
This is the Anesthesia Report for this case.
"^DD",130,130,1003,"DT")
3001019
"^DD",130,130,1004,0)
DICTATED SUMMARY EXPECTED^*S^1:YES;0:NO;^TIU;5^Q
"^DD",130,130,1004,.1)
Dictated Summary Expected
"^DD",130,130,1004,3)
Enter YES if a summary of this procedure will be dictated.
"^DD",130,130,1004,12)
Screen prevents change if a Procedure Report is associated with the case.
"^DD",130,130,1004,12.1)
S DIC("S")="I '$$DEL^SROESX(DA,""3"")"
"^DD",130,130,1004,21,0)
^.001^3^3^3040225^^
"^DD",130,130,1004,21,1,0)
This field indicates if the provider will dictate a summary of this
"^DD",130,130,1004,21,2,0)
procedure to be electronically signed. Enter YES if a dictated summary
"^DD",130,130,1004,21,3,0)
is expected. Enter NO or leave blank if no summary is expected.
"^DD",130,130,1004,"DEL",1,0)
I $$DEL^SROESX(DA,"3") D EN^DDIOL("The DICTATED SUMMARY EXPECTED field cannot be deleted. This case has a",,"!!,?2") D EN^DDIOL("Procedure Report associated with it.",,"!,?2")
"^DD",130,130,1004,"DT")
3040225
"^DD",130,130,1005,0)
CPT ON NURSE REPORT^S^1:YES;0:NO;^TIU;6^Q
"^DD",130,130,1005,.1)
CPT on Nurse Intraoperative Report
"^DD",130,130,1005,3)
Enter YES if the CPT ON NURSE INTRAOP site parameter is set to YES, INCLUDE CPT at the time the nurse intraoperative report is signed.
"^DD",130,130,1005,21,0)
^^5^5^3001025^
"^DD",130,130,1005,21,1,0)
This field reflects the content of the CPT ON NURSE INTRAOP site
"^DD",130,130,1005,21,2,0)
parameter in SURGERY SITE PARAMETERS file (#133).  This field will be set
"^DD",130,130,1005,21,3,0)
at the time the Nurse Intraoperative Report is signed and will be checked
"^DD",130,130,1005,21,4,0)
any time an automatic addendum is made to the report to determine whether
"^DD",130,130,1005,21,5,0)
the CPT codes should appear on the report.
"^DD",130,130,1005,"DT")
3001025
"^DD",130,130,1006,0)
ICD-9 ON NURSE REPORT^S^1:YES;0:NO;^TIU;7^Q
"^DD",130,130,1006,3)
Enter YES if the ICD-9 ON NURSE INTRAOP site parameter is set to YES, INCLUDE ICD-9 at the time the nurse intraoperative report is signed.
"^DD",130,130,1006,21,0)
^^5^5^3001025^
"^DD",130,130,1006,21,1,0)
This field reflects the content of the ICD-9 ON NURSE INTRAOP site
"^DD",130,130,1006,21,2,0)
parameter in SURGERY SITE PARAMETERS file (#133).  This field will be set
"^DD",130,130,1006,21,3,0)
at the time the Nurse Intraoperative Report is signed and will be checked
"^DD",130,130,1006,21,4,0)
any time an automatic addendum is made to the report to determine whether
"^DD",130,130,1006,21,5,0)
the ICD-9 codes should appear on the report.
"^DD",130,130,1006,"DT")
3001025
"^DD",130,130.0129,0)
LASER UNIT SUB-FIELD^^5^6
"^DD",130,130.0129,0,"DT")
3010111
"^DD",130,130.0129,0,"IX","B",130.0129,.01)

"^DD",130,130.0129,0,"NM","LASER UNIT")

"^DD",130,130.0129,0,"UP")
130
"^DD",130,130.0129,.01,0)
LASER UNIT/ID^MF^^0;1^K:$L(X)>30!($L(X)<1) X
"^DD",130,130.0129,.01,.1)
Laser Unit/ID
"^DD",130,130.0129,.01,1,0)
^.1
"^DD",130,130.0129,.01,1,1,0)
130.0129^B
"^DD",130,130.0129,.01,1,1,1)
S ^SRF(DA(1),44,"B",$E(X,1,30),DA)=""
"^DD",130,130.0129,.01,1,1,2)
K ^SRF(DA(1),44,"B",$E(X,1,30),DA)
"^DD",130,130.0129,.01,3)
Answer must be 1-30 characters in length.
"^DD",130,130.0129,.01,21,0)
^.001^1^1^3001010^^^
"^DD",130,130.0129,.01,21,1,0)
This is the name or ID of the laser unit used during this procedure,
"^DD",130,130.0129,.01,"DT")
3000830
"^DD",130,130.0129,1,0)
LASER DURATION^NJ6,2^^0;2^K:+X'=X!(X>100)!(X<0)!(X?.E1"."3N.N) X
"^DD",130,130.0129,1,.1)
Laser Duration
"^DD",130,130.0129,1,3)
Enter the time in minutes that the laser was used.
"^DD",130,130.0129,1,21,0)
^^1^1^3010111^
"^DD",130,130.0129,1,21,1,0)
This is the duration in minutes that the laser unit was applied.
"^DD",130,130.0129,1,"DT")
3010111
"^DD",130,130.0129,2,0)
WATTAGE^NJ8,2^^0;3^K:+X'=X!(X>10000)!(X<0)!(X?.E1"."3N.N) X
"^DD",130,130.0129,2,.1)
Wattage
"^DD",130,130.0129,2,3)
Enter the watts (joules/second) used by the laser.
"^DD",130,130.0129,2,21,0)
^^2^2^3010111^
"^DD",130,130.0129,2,21,1,0)
This is the number of watts (joules/sec) used by the laser during the
"^DD",130,130.0129,2,21,2,0)
procedure.
"^DD",130,130.0129,2,"DT")
3010111
"^DD",130,130.0129,3,0)
LASER OPERATOR^P200'^VA(200,^0;4^Q
"^DD",130,130.0129,3,.1)
Laser Operator
"^DD",130,130.0129,3,3)
Enter the name of the authorized laser operator.
"^DD",130,130.0129,3,21,0)
^^3^3^3010111^
"^DD",130,130.0129,3,21,1,0)
This is the authorized laser operator who operated this laser unit during
"^DD",130,130.0129,3,21,2,0)
this procedure. If the person cannot be entered in this field, enter the
"^DD",130,130.0129,3,21,3,0)
name in the LASER COMMENTS field (#5) for this laser unit.
"^DD",130,130.0129,3,"DT")
3010111
"^DD",130,130.0129,4,0)
PLUME EVACUATOR^S^Y:YES;N:NO;^0;5^Q
"^DD",130,130.0129,4,.1)
Plume Evacuator
"^DD",130,130.0129,4,3)
Enter YES if smoke plume reduction measures were implemented.
"^DD",130,130.0129,4,21,0)
^^1^1^3010111^
"^DD",130,130.0129,4,21,1,0)
This field determines if a plume evacuator was used with this laser unit.
"^DD",130,130.0129,4,"DT")
3010111
"^DD",130,130.0129,5,0)
LASER COMMENTS^130.1295^^1;0
"^DD",130,130.0129,5,.1)
Laser Comments
"^DD",130,130.0129,5,21,0)
^^2^2^3010914^
"^DD",130,130.0129,5,21,1,0)
This word-processing field contains comments about the use of this laser
"^DD",130,130.0129,5,21,2,0)
unit during this procedure.
"^DD",130,130.013,0)
CELL SAVER SUB-FIELD^^5^6
"^DD",130,130.013,0,"DT")
3001010
"^DD",130,130.013,0,"IX","B",130.013,.01)

"^DD",130,130.013,0,"NM","CELL SAVER")

"^DD",130,130.013,0,"UP")
130
"^DD",130,130.013,.01,0)
CELL SAVER ID^MF^^0;1^K:$L(X)>30!($L(X)<1) X
"^DD",130,130.013,.01,.1)
Cell Saver ID
"^DD",130,130.013,.01,1,0)
^.1
"^DD",130,130.013,.01,1,1,0)
130.013^B
"^DD",130,130.013,.01,1,1,1)
S ^SRF(DA(1),45,"B",$E(X,1,30),DA)=""
"^DD",130,130.013,.01,1,1,2)
K ^SRF(DA(1),45,"B",$E(X,1,30),DA)
"^DD",130,130.013,.01,3)
Enter machine identification name and/or number.
"^DD",130,130.013,.01,21,0)
^.001^1^1^3001010^^^
"^DD",130,130.013,.01,21,1,0)
This field identifies the cell saver that was used during this procedure.
"^DD",130,130.013,.01,"DT")
3000901
"^DD",130,130.013,1,0)
CELL SAVER OPERATOR^P200'^VA(200,^0;2^Q
"^DD",130,130.013,1,.1)
Cell Saver Operator
"^DD",130,130.013,1,3)
Enter the name of the authorized cell saver operator.
"^DD",130,130.013,1,21,0)
^^3^3^3020705^
"^DD",130,130.013,1,21,1,0)
This is the authorized cell saver operator during this procedure.  If
"^DD",130,130.013,1,21,2,0)
the person cannot be entered in this field, enter the name in the CELL
"^DD",130,130.013,1,21,3,0)
SAVER COMMENTS field (#5) for this cell saver.
"^DD",130,130.013,1,"DT")
3020705
"^DD",130,130.013,2,0)
AMT SALVAGED (ML)^NJ6,0^^0;3^K:+X'=X!(X>999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",130,130.013,2,.1)
Amount Salvaged (ml)
"^DD",130,130.013,2,3)
Enter the total amount in milliliters of fluid collected.
"^DD",130,130.013,2,21,0)
^^1^1^3001010^
"^DD",130,130.013,2,21,1,0)
This is the amount of fluid in milliliters collected during the procedure.
"^DD",130,130.013,2,"DT")
3001010
"^DD",130,130.013,3,0)
AMT REINFUSED (ML)^NJ6,0^^0;4^K:+X'=X!(X>999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",130,130.013,3,.1)
Amount Reinfused (ml)
"^DD",130,130.013,3,3)
Enter the total amount in milliliters of fluid reinfused.
"^DD",130,130.013,3,21,0)
^^2^2^3001010^
"^DD",130,130.013,3,21,1,0)
This is the amount of fluid in milliliters that was reinfused into the
"^DD",130,130.013,3,21,2,0)
patient during this procedure.
"^DD",130,130.013,3,"DT")
3001010
"^DD",130,130.013,4,0)
DISPOSABLES USED^130.0134A^^1;0
"^DD",130,130.013,4,21,0)
^.001^2^2^3001010^^
"^DD",130,130.013,4,21,1,0)
These are the disposable items used with this cell saver during this
"^DD",130,130.013,4,21,2,0)
procedure.
"^DD",130,130.013,5,0)
CELL SAVER COMMENTS^130.0135^^2;0
"^DD",130,130.013,5,.1)
Cell Saver Comments
"^DD",130,130.013,5,21,0)
^^2^2^3020226^
"^DD",130,130.013,5,21,1,0)
These comments contain additional information related to the use of this
"^DD",130,130.013,5,21,2,0)
cell saver during this procedure.
"^DD",130,130.0134,0)
DISPOSABLES USED SUB-FIELD^^2^3
"^DD",130,130.0134,0,"DT")
3001010
"^DD",130,130.0134,0,"IX","B",130.0134,.01)

"^DD",130,130.0134,0,"NM","DISPOSABLES USED")

"^DD",130,130.0134,0,"UP")
130.013
"^DD",130,130.0134,.01,0)
DISPOSABLES NAME^MF^^0;1^K:$L(X)>30!($L(X)<1) X
"^DD",130,130.0134,.01,.1)
Disposables Name
"^DD",130,130.0134,.01,1,0)
^.1
"^DD",130,130.0134,.01,1,1,0)
130.0134^B
"^DD",130,130.0134,.01,1,1,1)
S ^SRF(DA(2),45,DA(1),1,"B",$E(X,1,30),DA)=""
"^DD",130,130.0134,.01,1,1,2)
K ^SRF(DA(2),45,DA(1),1,"B",$E(X,1,30),DA)
"^DD",130,130.0134,.01,3)
Enter the name of the disposable product used with this cell saver.
"^DD",130,130.0134,.01,21,0)
^^2^2^3001010^
"^DD",130,130.0134,.01,21,1,0)
This is the name of the disposable product used with this cell saver
"^DD",130,130.0134,.01,21,2,0)
during this procedure.
"^DD",130,130.0134,.01,"DT")
3000901
"^DD",130,130.0134,1,0)
LOT NUMBER^F^^0;2^K:$L(X)>30!($L(X)<1) X
"^DD",130,130.0134,1,.1)
Lot Number
"^DD",130,130.0134,1,3)
Enter the product lot number for this disposable product.
"^DD",130,130.0134,1,21,0)
^.001^1^1^3001010^^^
"^DD",130,130.0134,1,21,1,0)
This is the lot number for this disposable used with the cell saver.
"^DD",130,130.0134,1,"DT")
3000901
"^DD",130,130.0134,2,0)
QUANTITY^NJ3,0^^0;3^K:+X'=X!(X>100)!(X<0)!(X?.E1"."1N.N) X
"^DD",130,130.0134,2,.1)
Quantity
"^DD",130,130.0134,2,3)
Enter the number of products with the same name and lot number used.
"^DD",130,130.0134,2,21,0)
^^2^2^3001010^
"^DD",130,130.0134,2,21,1,0)
This is the quantity of disposable products with the same name and lot
"^DD",130,130.0134,2,21,2,0)
number used with this cell saver during this procedure.
"^DD",130,130.0134,2,"DT")
3001010
"^DD",130,130.0135,0)
CELL SAVER COMMENTS SUB-FIELD^^.01^1
"^DD",130,130.0135,0,"DT")
3000905
"^DD",130,130.0135,0,"NM","CELL SAVER COMMENTS")

"^DD",130,130.0135,0,"UP")
130.013
"^DD",130,130.0135,.01,0)
CELL SAVER COMMENTS^W^^0;1^Q
"^DD",130,130.0135,.01,.1)
Cell Saver Comments
"^DD",130,130.0135,.01,3)
Enter additional information about the use of this cell saver.
"^DD",130,130.0135,.01,21,0)
^.001^2^2^3010914^^
"^DD",130,130.0135,.01,21,1,0)
These comments contain additional information related to the use of this
"^DD",130,130.0135,.01,21,2,0)
cell saver used during this procedure.
"^DD",130,130.0135,.01,"DT")
3010914
"^DD",130,130.02,0)
TIME TOURNIQUET APPLIED SUB-FIELD^NL^4^5
"^DD",130,130.02,0,"NM","TIME TOURNIQUET APPLIED")

"^DD",130,130.02,.01,0)
TIME TOURNIQUET APPLIED^DX^^0;1^S Z=$E($P(^SRF($S($D(SRTN):SRTN,1:DA(1)),0),"^",9),1,7),X=$S(X?1.4N.A!(X?1.2N1":"2N.A):Z_"@"_X,1:X) K %DT,Z S %DT="ERTX" D ^%DT S X=Y K:Y<1 X
"^DD",130,130.02,.01,.1)
Date/Time Tourniquet Applied
"^DD",130,130.02,.01,3)
Enter the date/time that the tourniquet was applied.
"^DD",130,130.02,.01,7.5)
S Z=$E($P(^SRF($S($D(SRTN):SRTN,1:DA(1)),0),"^",9),1,7),X=$S(X?1.4N.A!(X?1.2N1":"2N.A):Z_"@"_X,1:X) K %DT,Z S %DT="RTX" D ^%DT S X=Y K:Y<1 X
"^DD",130,130.02,.01,21,0)
^^3^3^2921106^^^^
"^DD",130,130.02,.01,21,1,0)
This is the date and time that the tourniquet was applied.  If entered,
"^DD",130,130.02,.01,21,2,0)
this information will appear on the Nurse Intraoperative Report.
"^DD",130,130.02,.01,21,3,0)
 
"^DD",130,130.02,.01,22)

"^DD",130,130.02,.01,"DEL",.01,0)
I $D(^SRF(DA(1),"CON")),$P(^("CON"),"^") D ^SROCOND I 0
"^DD",130,130.02,.01,"DT")
2931208
"^DD",130,130.02,1,0)
SITE APPLIED^S^RL:RIGHT UPPER LEG;RA:RIGHT UPPER ARM;LG:LEFT UPPER LEG;LA:LEFT UPPER ARM;AR:RIGHT ANKLE;AL:LEFT ANKLE;RW:RIGHT LOWER ARM;LW:LEFT LOWER ARM;O:OTHER;^0;2^Q
"^DD",130,130.02,1,.1)
Site Applied
"^DD",130,130.02,1,3)
Enter the code corresponding to the site wherein the tourniquet is applied.
"^DD",130,130.02,1,21,0)
^^3^3^2900709^^
"^DD",130,130.02,1,21,1,0)
This is the code corresponding to the location on the body where
"^DD",130,130.02,1,21,2,0)
the tourniquet is applied.
"^DD",130,130.02,1,21,3,0)
 
"^DD",130,130.02,1,"DT")
3020621
"^DD",130,130.1,0)
POSTOP ANES NOTE SUB-FIELD^^.01^1
"^DD",130,130.1,0,"DT")
3001023
"^DD",130,130.1,0,"NM","POSTOP ANES NOTE")

"^DD",130,130.1,0,"UP")
130
"^DD",130,130.1,.01,0)
POSTOP ANES NOTE^W^^0;1^Q
"^DD",130,130.1,.01,.1)
Postop Anesthesia Note
"^DD",130,130.1,.01,3)
Enter the postop anesthesia note for this patient.
"^DD",130,130.1,.01,21,0)
^.001^1^1^3010914^^^^
"^DD",130,130.1,.01,21,1,0)
This is the postop anesthesia note for this patient.
"^DD",130,130.1,.01,"DT")
3001023
"^DD",130,130.1295,0)
LASER COMMENTS SUB-FIELD^^.01^1
"^DD",130,130.1295,0,"DT")
3010111
"^DD",130,130.1295,0,"NM","LASER COMMENTS")

"^DD",130,130.1295,0,"UP")
130.0129
"^DD",130,130.1295,.01,0)
LASER COMMENTS^W^^0;1^Q
"^DD",130,130.1295,.01,.1)
Laser Comments
"^DD",130,130.1295,.01,3)
Enter any comments related to the use of this laser unit.
"^DD",130,130.1295,.01,21,0)
^.001^2^2^3010914^^
"^DD",130,130.1295,.01,21,1,0)
This word-processing field contains comments about the use of this laser
"^DD",130,130.1295,.01,21,2,0)
unit during this procedure.
"^DD",130,130.1295,.01,"DT")
3010111
"^DD",130,130.28,0)
OR CIRC SUPPORT SUB-FIELD^NL^3^3
"^DD",130,130.28,0,"NM","OR CIRC SUPPORT")

"^DD",130,130.28,.01,0)
OR CIRC SUPPORT^*P200'^VA(200,^0;1^S DIC("S")="S RESTRICT=""130.28,.01"" D KEY^SROXPR I $D(SROK)" D ^DIC K DIC S DIC=DIE,X=+Y K:Y<0 X
"^DD",130,130.28,.01,.1)
O.R. Circulating Nurse
"^DD",130,130.28,.01,1,0)
^.1^^0
"^DD",130,130.28,.01,3)

"^DD",130,130.28,.01,12)
Entries in this field may be restricted based on locally selected keys.
"^DD",130,130.28,.01,12.1)
S DIC("S")="S RESTRICT=""130.28,.01"" D KEY^SROXPR I $D(SROK)"
"^DD",130,130.28,.01,21,0)
^^3^3^2921026^^
"^DD",130,130.28,.01,21,1,0)
This is the person with the circulating role responsibilities.  This
"^DD",130,130.28,.01,21,2,0)
information will appear on the Nurse Intraoperative Report.
"^DD",130,130.28,.01,21,3,0)
 
"^DD",130,130.28,.01,"DT")
3020207
"^DD",133,133,6,0)
CANCEL IVS^S^0:NOT CANCEL;1:CANCEL;^0;7^Q
"^DD",133,133,6,.1)
Cancel IV Orders upon Entry into the Operating Room ?
"^DD",133,133,6,3)
Enter '1' to cancel IVs when the operation begins.
"^DD",133,133,6,21,0)
^.001^7^7^3040301^^
"^DD",133,133,6,21,1,0)
This field indicates the site's preference to allow or not allow current
"^DD",133,133,6,21,2,0)
IV orders for a patient to be cancelled when a surgical or non-OR
"^DD",133,133,6,21,3,0)
procedure begins. If this field is set to NOT CANCEL, IV orders will not
"^DD",133,133,6,21,4,0)
be cancelled. If this field is set to CANCEL, upon entering the anesthesia
"^DD",133,133,6,21,5,0)
care start time for a case, the user will be prompted to cancel or not 
"^DD",133,133,6,21,6,0)
cancel current IV orders if not more than 24 hours have passed since the
"^DD",133,133,6,21,7,0)
start of the operation or procedure.
"^DD",133,133,6,"DT")
2930210
"^DD",133,133,38,0)
CPT ON NURSE INTRAOP^S^0:NO, DO NOT INCLUDE CPT;1:YES, INCLUDE CPT;^.1;2^Q
"^DD",133,133,38,.1)
CPT on Nurse Intraop Report
"^DD",133,133,38,3)
Enter YES to require the principal CPT code prior to electronic signature and to make it part of the report.
"^DD",133,133,38,21,0)
^^6^6^3030902^
"^DD",133,133,38,21,1,0)
If this field is set to YES, INCLUDE CPT, the principal CPT code 
"^DD",133,133,38,21,2,0)
will be required before electronic signature can be applied and the
"^DD",133,133,38,21,3,0)
CPT code will be part of the report. If the field is null or set to
"^DD",133,133,38,21,4,0)
NO, DO NOT INCLUDE CPT, the principal CPT code will not be required
"^DD",133,133,38,21,5,0)
before electronic signature can be applied and the CPT code will not
"^DD",133,133,38,21,6,0)
be part of the report.
"^DD",133,133,38,"DT")
3010914
"^DD",133,133,39,0)
ICD-9 ON NURSE INTRAOP^S^0:NO, DO NOT INCLUDE ICD-9;1:YES, INCLUDE ICD-9;^.1;3^Q
"^DD",133,133,39,.1)
ICD-9 on Nurse Intraop Report
"^DD",133,133,39,3)
Enter YES to require the principal diagnosis code prior to electronic signature and to make it part of the report.
"^DD",133,133,39,21,0)
^^5^5^3030902^
"^DD",133,133,39,21,1,0)
If this field is set to YES, INCLUDE ICD-9, the principal diagnosis 
"^DD",133,133,39,21,2,0)
code will be required before electronic signature can be applied and
"^DD",133,133,39,21,3,0)
the ICD-9 code will be part of the report.  If the field is null or
"^DD",133,133,39,21,4,0)
set to NO, DO NOT INCLUDE ICD-9, the principal diagnosis code will 
"^DD",133,133,39,21,5,0)
not be required before electronic signature can be applied.
"^DD",133,133,39,"DT")
3010914
"^DD",133,133,40,0)
ANESTHESIA REPORT IN USE^S^1:YES;0:NO;^.1;4^Q
"^DD",133,133,40,.1)
Anesthesia Report In Use
"^DD",133,133,40,3)
Enter YES if the electronically signed Anesthesia Report is used.
"^DD",133,133,40,21,0)
^^4^4^3030902^
"^DD",133,133,40,21,1,0)
This YES/NO field determines if the Anesthesia Report should be 
"^DD",133,133,40,21,2,0)
created and electronically signed.  Only if this field is marked YES
"^DD",133,133,40,21,3,0)
will the functionality be invoked to create the Anesthesia Report 
"^DD",133,133,40,21,4,0)
for a case in TIU.
"^DD",133,133,40,"DT")
3010118
"^DD",133,133,42,0)
DEFAULT CLINIC FOR DOCUMENTS^*P44'^SC(^0;23^S DIC("S")="I $$NOCNT^SROUTL(DA)" D ^DIC K DIC S DIC=DIE,X=+Y K:Y<0 X
"^DD",133,133,42,.1)
Default Non-Count Clinic for TIU Documents
"^DD",133,133,42,3)
Enter a non-count clinic that will be the default clinic associated with TIU documents.
"^DD",133,133,42,12)
Screen requires selection of non-count clinic.
"^DD",133,133,42,12.1)
S DIC("S")="I $$NOCNT^SROUTL(DA)"
"^DD",133,133,42,21,0)
^^3^3^3040124^
"^DD",133,133,42,21,1,0)
This non-count clinic is the default clinic for this division. It will
"^DD",133,133,42,21,2,0)
be the location passed to TIU when Surgery documents are created if no
"^DD",133,133,42,21,3,0)
other location can be identified.
"^DD",133,133,42,"DT")
3040121
**END**
**END**
