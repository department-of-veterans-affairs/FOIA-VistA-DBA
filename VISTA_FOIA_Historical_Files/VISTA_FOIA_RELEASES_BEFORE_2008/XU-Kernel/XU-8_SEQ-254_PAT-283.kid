Released XU*8*283 SEQ #254
Extracted from mail message
**KIDS**:XU*8.0*283^

**INSTALL NAME**
XU*8.0*283
"BLD",657,0)
XU*8.0*283^KERNEL^0^3030505^y
"BLD",657,1,0)
^^2^2^3030204^
"BLD",657,1,1,0)
Please refer to the Description in FORUM Patch Module for details.
"BLD",657,1,2,0)
XU*8*283  DEA/PKI pilot.
"BLD",657,4,0)
^9.64PA^8980.22^3
"BLD",657,4,8980.2,0)
8980.2
"BLD",657,4,8980.2,222)
y^y^f^^^^n
"BLD",657,4,8980.22,0)
8980.22
"BLD",657,4,8980.22,222)
y^y^f^^^^n
"BLD",657,4,8989.3,0)
8989.3
"BLD",657,4,8989.3,2,0)
^9.641^8989.3^1
"BLD",657,4,8989.3,2,8989.3,0)
KERNEL SYSTEM PARAMETERS  (File-top level)
"BLD",657,4,8989.3,2,8989.3,1,0)
^9.6411^53.1^1
"BLD",657,4,8989.3,2,8989.3,1,53.1,0)
PKI Server
"BLD",657,4,8989.3,222)
y^y^p^^^^n
"BLD",657,4,"APDD",8989.3,8989.3)

"BLD",657,4,"APDD",8989.3,8989.3,53.1)

"BLD",657,4,"B",8980.2,8980.2)

"BLD",657,4,"B",8980.22,8980.22)

"BLD",657,4,"B",8989.3,8989.3)

"BLD",657,"KRN",0)
^9.67PA^8989.52^19
"BLD",657,"KRN",.4,0)
.4
"BLD",657,"KRN",.401,0)
.401
"BLD",657,"KRN",.402,0)
.402
"BLD",657,"KRN",.403,0)
.403
"BLD",657,"KRN",.403,"NM",0)
^9.68A^1^1
"BLD",657,"KRN",.403,"NM",1,0)
XUSSPKI    FILE #8989.3^8989.3^0
"BLD",657,"KRN",.403,"NM","B","XUSSPKI    FILE #8989.3",1)

"BLD",657,"KRN",.5,0)
.5
"BLD",657,"KRN",.84,0)
.84
"BLD",657,"KRN",.84,"NM",0)
^9.68A^20^18
"BLD",657,"KRN",.84,"NM",1,0)
89802000^^0
"BLD",657,"KRN",.84,"NM",2,0)
89802001^^0
"BLD",657,"KRN",.84,"NM",3,0)
89802002^^0
"BLD",657,"KRN",.84,"NM",4,0)
89802003^^0
"BLD",657,"KRN",.84,"NM",5,0)
89802004^^0
"BLD",657,"KRN",.84,"NM",6,0)
89802010^^0
"BLD",657,"KRN",.84,"NM",7,0)
89802015^^0
"BLD",657,"KRN",.84,"NM",8,0)
89802016^^0
"BLD",657,"KRN",.84,"NM",9,0)
89802017^^0
"BLD",657,"KRN",.84,"NM",10,0)
89802018^^0
"BLD",657,"KRN",.84,"NM",11,0)
89802019^^0
"BLD",657,"KRN",.84,"NM",12,0)
89802020^^0
"BLD",657,"KRN",.84,"NM",15,0)
89802005^^0
"BLD",657,"KRN",.84,"NM",16,0)
89802006^^0
"BLD",657,"KRN",.84,"NM",17,0)
89802007^^0
"BLD",657,"KRN",.84,"NM",18,0)
89802008^^0
"BLD",657,"KRN",.84,"NM",19,0)
89802009^^0
"BLD",657,"KRN",.84,"NM",20,0)
89802011^^0
"BLD",657,"KRN",.84,"NM","B",89802000,1)

"BLD",657,"KRN",.84,"NM","B",89802001,2)

"BLD",657,"KRN",.84,"NM","B",89802002,3)

"BLD",657,"KRN",.84,"NM","B",89802003,4)

"BLD",657,"KRN",.84,"NM","B",89802004,5)

"BLD",657,"KRN",.84,"NM","B",89802005,15)

"BLD",657,"KRN",.84,"NM","B",89802006,16)

"BLD",657,"KRN",.84,"NM","B",89802007,17)

"BLD",657,"KRN",.84,"NM","B",89802008,18)

"BLD",657,"KRN",.84,"NM","B",89802009,19)

"BLD",657,"KRN",.84,"NM","B",89802010,6)

"BLD",657,"KRN",.84,"NM","B",89802011,20)

"BLD",657,"KRN",.84,"NM","B",89802015,7)

"BLD",657,"KRN",.84,"NM","B",89802016,8)

"BLD",657,"KRN",.84,"NM","B",89802017,9)

"BLD",657,"KRN",.84,"NM","B",89802018,10)

"BLD",657,"KRN",.84,"NM","B",89802019,11)

"BLD",657,"KRN",.84,"NM","B",89802020,12)

"BLD",657,"KRN",3.6,0)
3.6
"BLD",657,"KRN",3.6,"NM",0)
^9.68A^1^1
"BLD",657,"KRN",3.6,"NM",1,0)
XUSSPKI CRL SERVER^^0
"BLD",657,"KRN",3.6,"NM","B","XUSSPKI CRL SERVER",1)

"BLD",657,"KRN",3.8,0)
3.8
"BLD",657,"KRN",3.8,"NM",0)
^9.68A^1^1
"BLD",657,"KRN",3.8,"NM",1,0)
XUSSPKI CRL SERVER^^0
"BLD",657,"KRN",3.8,"NM","B","XUSSPKI CRL SERVER",1)

"BLD",657,"KRN",9.2,0)
9.2
"BLD",657,"KRN",9.8,0)
9.8
"BLD",657,"KRN",9.8,"NM",0)
^9.68A^7^5
"BLD",657,"KRN",9.8,"NM",1,0)
XUSSPKI^^0^B12359565
"BLD",657,"KRN",9.8,"NM",3,0)
XUSC1^^0^B6439792
"BLD",657,"KRN",9.8,"NM",4,0)
XUSC1C^^0^B8238333
"BLD",657,"KRN",9.8,"NM",6,0)
XUSC1S^^0^B13011221
"BLD",657,"KRN",9.8,"NM",7,0)
XUSC1S1^^0^B2399695
"BLD",657,"KRN",9.8,"NM","B","XUSC1",3)

"BLD",657,"KRN",9.8,"NM","B","XUSC1C",4)

"BLD",657,"KRN",9.8,"NM","B","XUSC1S",6)

"BLD",657,"KRN",9.8,"NM","B","XUSC1S1",7)

"BLD",657,"KRN",9.8,"NM","B","XUSSPKI",1)

"BLD",657,"KRN",19,0)
19
"BLD",657,"KRN",19,"NM",0)
^9.68A^4^3
"BLD",657,"KRN",19,"NM",2,0)
XUSSPKI CRL UPLOAD^^0
"BLD",657,"KRN",19,"NM",3,0)
XUSSPKI EDIT^^0
"BLD",657,"KRN",19,"NM",4,0)
XUKERNEL^^2
"BLD",657,"KRN",19,"NM","B","XUKERNEL",4)

"BLD",657,"KRN",19,"NM","B","XUSSPKI CRL UPLOAD",2)

"BLD",657,"KRN",19,"NM","B","XUSSPKI EDIT",3)

"BLD",657,"KRN",19.1,0)
19.1
"BLD",657,"KRN",101,0)
101
"BLD",657,"KRN",409.61,0)
409.61
"BLD",657,"KRN",771,0)
771
"BLD",657,"KRN",870,0)
870
"BLD",657,"KRN",8989.51,0)
8989.51
"BLD",657,"KRN",8989.51,"NM",0)
^9.68A^1^1
"BLD",657,"KRN",8989.51,"NM",1,0)
XUSC1 DEBUG^^0
"BLD",657,"KRN",8989.51,"NM","B","XUSC1 DEBUG",1)

"BLD",657,"KRN",8989.52,0)
8989.52
"BLD",657,"KRN",8994,0)
8994
"BLD",657,"KRN",8994,"NM",0)
^9.68A^^0
"BLD",657,"KRN","B",.4,.4)

"BLD",657,"KRN","B",.401,.401)

"BLD",657,"KRN","B",.402,.402)

"BLD",657,"KRN","B",.403,.403)

"BLD",657,"KRN","B",.5,.5)

"BLD",657,"KRN","B",.84,.84)

"BLD",657,"KRN","B",3.6,3.6)

"BLD",657,"KRN","B",3.8,3.8)

"BLD",657,"KRN","B",9.2,9.2)

"BLD",657,"KRN","B",9.8,9.8)

"BLD",657,"KRN","B",19,19)

"BLD",657,"KRN","B",19.1,19.1)

"BLD",657,"KRN","B",101,101)

"BLD",657,"KRN","B",409.61,409.61)

"BLD",657,"KRN","B",771,771)

"BLD",657,"KRN","B",870,870)

"BLD",657,"KRN","B",8989.51,8989.51)

"BLD",657,"KRN","B",8989.52,8989.52)

"BLD",657,"KRN","B",8994,8994)

"BLD",657,"QUES",0)
^9.62^^
"BLD",657,"REQB",0)
^9.611^^
"FIA",8980.2)
PKI Digital Signatures
"FIA",8980.2,0)
^XUSSPKI(8980.2,
"FIA",8980.2,0,0)
8980.2
"FIA",8980.2,0,1)
y^y^f^^^^n
"FIA",8980.2,0,10)

"FIA",8980.2,0,11)

"FIA",8980.2,0,"RLRO")

"FIA",8980.2,0,"VR")
8.0^XU
"FIA",8980.2,8980.2)
0
"FIA",8980.2,8980.21)
0
"FIA",8980.22)
PKI CRL URLS
"FIA",8980.22,0)
^XUSSPKI(8980.22,
"FIA",8980.22,0,0)
8980.22
"FIA",8980.22,0,1)
y^y^f^^^^n
"FIA",8980.22,0,10)

"FIA",8980.22,0,11)

"FIA",8980.22,0,"RLRO")

"FIA",8980.22,0,"VR")
8.0^XU
"FIA",8980.22,8980.22)
0
"FIA",8989.3)
KERNEL SYSTEM PARAMETERS
"FIA",8989.3,0)
^XTV(8989.3,
"FIA",8989.3,0,0)
8989.3P
"FIA",8989.3,0,1)
y^y^p^^^^n
"FIA",8989.3,0,10)

"FIA",8989.3,0,11)

"FIA",8989.3,0,"RLRO")

"FIA",8989.3,0,"VR")
8.0^XU
"FIA",8989.3,8989.3)
1
"FIA",8989.3,8989.3,53.1)

"KRN",.403,40,-1)
0^1
"KRN",.403,40,0)
XUSSPKI^@^@^^3030505.1022^^^8989.3^0^0^1
"KRN",.403,40,40,0)
^.4031I^1^1
"KRN",.403,40,40,1,0)
1^^1,1
"KRN",.403,40,40,1,1)
Page 1
"KRN",.403,40,40,1,40,0)
^.4032IP^186^1
"KRN",.403,40,40,1,40,186,0)
XUSSPKI 1^1^1,1^e
"KRN",.404,186,0)
XUSSPKI 1^8989.3
"KRN",.404,186,40,0)
^.4044I^3^3
"KRN",.404,186,40,1,0)
1^Kernel PKI edit^1
"KRN",.404,186,40,1,2)
^^1,28
"KRN",.404,186,40,2,0)
2^DOMAIN^3
"KRN",.404,186,40,2,1)
.01
"KRN",.404,186,40,2,2)
2,16^52^2,8
"KRN",.404,186,40,2,4)
^^^1
"KRN",.404,186,40,3,0)
3^PKI Server^3
"KRN",.404,186,40,3,1)
53.1
"KRN",.404,186,40,3,2)
4,20^46^4,8
"KRN",.84,89802000,-1)
0^1
"KRN",.84,89802000,0)
89802000^1^^KERNEL^The Data buffer for signing is empty.
"KRN",.84,89802000,1,0)
^.842^1^1^3020409^^^^
"KRN",.84,89802000,1,1,0)
The Data buffer for signing is empty.
"KRN",.84,89802000,2,0)
^.844^1^1^3020409^^
"KRN",.84,89802000,2,1,0)
Order text to be signed is empty.
"KRN",.84,89802001,-1)
0^2
"KRN",.84,89802001,0)
89802001^1^^KERNEL^The users DEA number is missing.
"KRN",.84,89802001,1,0)
^.842^1^1^3020409^^^^
"KRN",.84,89802001,1,1,0)
The users DEA number is blank.
"KRN",.84,89802001,2,0)
^.844^1^1^3020409^^^
"KRN",.84,89802001,2,1,0)
User's DEA # is missing.
"KRN",.84,89802002,-1)
0^3
"KRN",.84,89802002,0)
89802002^1^^KERNEL^The Drug schedule is missing.
"KRN",.84,89802002,1,0)
^.842^1^1^3020409^^^^
"KRN",.84,89802002,1,1,0)
The DEA drug schedule was not set before calling the signing procedure.
"KRN",.84,89802002,2,0)
^.844^1^1^3020409^^^
"KRN",.84,89802002,2,1,0)
Drug Schedule is missing.
"KRN",.84,89802003,-1)
0^4
"KRN",.84,89802003,0)
89802003^1^^KERNEL^No Cert with a valid date found.
"KRN",.84,89802003,2,0)
^.844^1^1^3021030^^^
"KRN",.84,89802003,2,1,0)
No Cert with a valid date found.
"KRN",.84,89802004,-1)
0^5
"KRN",.84,89802004,0)
89802004^1^^KERNEL^Could not find a Valid Cert.
"KRN",.84,89802004,1,0)
^.842^1^1^3020409^^^^
"KRN",.84,89802004,1,1,0)
Could not find a Valid Cert.
"KRN",.84,89802004,2,0)
^.844^1^1^3020409^^^
"KRN",.84,89802004,2,1,0)
Valid Certificate was not found.
"KRN",.84,89802005,-1)
0^15
"KRN",.84,89802005,0)
89802005^1^^KERNEL^Couldn't load CSP
"KRN",.84,89802005,1,0)
^.842^2^2^3020409^^^
"KRN",.84,89802005,1,1,0)
This error results from the CSP software not being installed in the
"KRN",.84,89802005,1,2,0)
workstation or it not the CSP we are looking for.
"KRN",.84,89802005,2,0)
^.844^1^1^3020409^^^
"KRN",.84,89802005,2,1,0)
Couldn't load CSP.
"KRN",.84,89802006,-1)
0^16
"KRN",.84,89802006,0)
89802006^1^^KERNEL^No SmartCard Reader
"KRN",.84,89802006,1,0)
^.842^2^2^3020409^^^
"KRN",.84,89802006,1,1,0)
This error results when the driver for a SmartCard could not be found.
"KRN",.84,89802006,1,2,0)
This is a workstation setup problem.
"KRN",.84,89802006,2,0)
^.844^1^1^3020409^^^
"KRN",.84,89802006,2,1,0)
Smart Card Reader not found.
"KRN",.84,89802007,-1)
0^17
"KRN",.84,89802007,0)
89802007^1^^KERNEL^Cert with DEA # not found.
"KRN",.84,89802007,2,0)
^.844^1^1^3020409^^^
"KRN",.84,89802007,2,1,0)
Cert with DEA # not found.
"KRN",.84,89802008,-1)
0^18
"KRN",.84,89802008,0)
89802008^1^^KERNEL^Cert not Valid for Schedule.
"KRN",.84,89802008,2,0)
^.844^1^1^3020409^^^
"KRN",.84,89802008,2,1,0)
The Cert was not valid for the Drug Schedule.
"KRN",.84,89802009,-1)
0^19
"KRN",.84,89802009,0)
89802009^1^^KERNEL^Signature Check failed (Invalid Signature)
"KRN",.84,89802009,2,0)
^^1^1^3021029^
"KRN",.84,89802009,2,1,0)
Signature Check failed (Invalid Signature)
"KRN",.84,89802010,-1)
0^6
"KRN",.84,89802010,0)
89802010^1^^KERNEL^General Crypto Error.
"KRN",.84,89802010,1,0)
^.842^9^9^3021029^^
"KRN",.84,89802010,1,1,0)
There was a error reported by the Crypto API.  (Contact IRM)
"KRN",.84,89802010,1,2,0)
This is a general error that is a catch all for several problems.
"KRN",.84,89802010,1,3,0)
Things that IRM should look at if user reporting getting this error.
"KRN",.84,89802010,1,4,0)
1. See that the PKIserver.exe routine is installed on the server in the
"KRN",.84,89802010,1,5,0)
   WINNT\system32 directory.
"KRN",.84,89802010,1,6,0)
2. See that the PKIserver.exe routine has been registered with windows.
"KRN",.84,89802010,1,7,0)
   This is done Start>Run C:\WINNT\System32\PKIserver /Install
"KRN",.84,89802010,1,8,0)
3. See that in Administrator tools>services that PKI_Verify_Service has a
"KRN",.84,89802010,1,9,0)
   status of STARTED and its Startup Type is Automatic.
"KRN",.84,89802010,2,0)
^.844^9^9^3020409^
"KRN",.84,89802010,2,1,0)
Error reported by the Crypto API.
"KRN",.84,89802010,2,2,0)
This is a general error that is a catch all for several problems.
"KRN",.84,89802010,2,3,0)
Things that IRM should look at if user reporting getting this error.
"KRN",.84,89802010,2,4,0)
1. See that the PKIserver.exe routine is installed on the server in the
"KRN",.84,89802010,2,5,0)
   WINNT\system32 directory.
"KRN",.84,89802010,2,6,0)
2. See that the PKIserver.exe routine has been registered with windows.
"KRN",.84,89802010,2,7,0)
   This is done Start>Run C:\WINNT\System32\PKIserver /Install
"KRN",.84,89802010,2,8,0)
3. See that in Administrator tools>services that PKI_Verify_Service has a
"KRN",.84,89802010,2,9,0)
   status of STARTED and its Startup Type is Automatic.
"KRN",.84,89802011,-1)
0^20
"KRN",.84,89802011,0)
89802011^1^^KERNEL^Certificate Chain not valid.
"KRN",.84,89802011,1,0)
^^1^1^3030408^
"KRN",.84,89802011,1,1,0)
Certificate Chain not valid.
"KRN",.84,89802011,2,0)
^^1^1^3030408^
"KRN",.84,89802011,2,1,0)
Certificate Chain not valid.
"KRN",.84,89802015,-1)
0^7
"KRN",.84,89802015,0)
89802015^1^^KERNEL^Digital Signature Corrupted
"KRN",.84,89802015,1,0)
^.842^1^1^3020409^^^^
"KRN",.84,89802015,1,1,0)
The decode of the Digital Signature failed, Signature corrupted.
"KRN",.84,89802015,2,0)
^^1^1^3020409^
"KRN",.84,89802015,2,1,0)
Corrupted (Decode failure).
"KRN",.84,89802016,-1)
0^8
"KRN",.84,89802016,0)
89802016^1^^KERNEL^The two hash values do not match.
"KRN",.84,89802016,1,0)
^.842^1^1^3020409^^^^
"KRN",.84,89802016,1,1,0)
The two hash values do not match.
"KRN",.84,89802016,2,0)
^^1^1^3020409^
"KRN",.84,89802016,2,1,0)
Corrupted (Hash mismatch).
"KRN",.84,89802017,-1)
0^9
"KRN",.84,89802017,0)
89802017^1^^KERNEL^The Cert is on a CRL.
"KRN",.84,89802017,1,0)
^.842^1^1^3020409^^
"KRN",.84,89802017,1,1,0)
The certificate is on a CRL.
"KRN",.84,89802017,2,0)
^.844^1^1^3020409^^^
"KRN",.84,89802017,2,1,0)
Certificate revoked.
"KRN",.84,89802018,-1)
0^10
"KRN",.84,89802018,0)
89802018^1^^KERNEL^Verification Failed.
"KRN",.84,89802018,2,0)
^.844^1^1^3020409^^
"KRN",.84,89802018,2,1,0)
Digital signature verification failed.
"KRN",.84,89802019,-1)
0^11
"KRN",.84,89802019,0)
89802019^1^^KERNEL^Before the certificate effective date.
"KRN",.84,89802019,2,0)
^.844^1^1^3020409^^
"KRN",.84,89802019,2,1,0)
Before the certificate effective date.
"KRN",.84,89802020,-1)
0^12
"KRN",.84,89802020,0)
89802020^1^^KERNEL^Certificate expired
"KRN",.84,89802020,2,0)
^.844^1^1^3020409^^^^
"KRN",.84,89802020,2,1,0)
Certificate expired.
"KRN",3.6,45,-1)
0^1
"KRN",3.6,45,0)
XUSSPKI CRL SERVER^CRL UPLOAD MESSAGE
"KRN",3.6,45,1,0)
^^5^5^3020411^
"KRN",3.6,45,1,1,0)
At |2| The CRL Upload task reported the following problem.
"KRN",3.6,45,1,2,0)
  "|1|"
"KRN",3.6,45,1,3,0)
 
"KRN",3.6,45,1,4,0)
Be sure that the "CRLService" is running on the server.  Try stopping and
"KRN",3.6,45,1,5,0)
restarting the service. It should be listening on port 10270.
"KRN",3.6,45,3,0)
^3.63^1^1^3020411^^^^
"KRN",3.6,45,3,1,0)
This bulletin is sent when the CRL UPLOAD TASK has a problem.
"KRN",3.6,45,4,0)
^3.64A^2^2
"KRN",3.6,45,4,1,0)
1
"KRN",3.6,45,4,1,1,0)
^3.65^1^1^3020409^^
"KRN",3.6,45,4,1,1,1,0)
The error message.
"KRN",3.6,45,4,2,0)
2
"KRN",3.6,45,4,2,1,0)
^^1^1^3020411^
"KRN",3.6,45,4,2,1,1,0)
The date time of the message.
"KRN",3.8,14,-1)
0^1
"KRN",3.8,14,0)
XUSSPKI CRL SERVER^PU^y^^^^
"KRN",3.8,14,2,0)
^3.801^2^2^3020409^^^
"KRN",3.8,14,2,1,0)
This mail group gets messages about problems with the communicating with
"KRN",3.8,14,2,2,0)
the CRL server.
"KRN",3.8,14,6,0)
^3.812^1^1
"KRN",3.8,14,6,1,0)
wally.fort@MED.VA.GOV
"KRN",3.8,14,6,"B","wally.fort@MED.VA.GOV",1)

"KRN",19,149,-1)
2^4
"KRN",19,149,0)
XUKERNEL^Kernel Management Menu^^M^.5^^^^^^^^y
"KRN",19,149,10,0)
^19.01IP^7^7
"KRN",19,149,10,7,0)
910
"KRN",19,149,10,7,"^")
XUSSPKI EDIT
"KRN",19,149,"U")
KERNEL MANAGEMENT MENU
"KRN",19,844,-1)
0^2
"KRN",19,844,0)
XUSSPKI CRL UPLOAD^PKI CRL Upload^^R^^^^^^^^KERNEL^n
"KRN",19,844,1,0)
^^2^2^3020130^
"KRN",19,844,1,1,0)
This option is to be scheduled to run every hour to send any new 
"KRN",19,844,1,2,0)
URL for the CRL's to be collected by the PKI verification server.
"KRN",19,844,25)
CRLUP^XUSSPKI
"KRN",19,844,200.9)
y
"KRN",19,844,"U")
PKI CRL UPLOAD
"KRN",19,910,-1)
0^3
"KRN",19,910,0)
XUSSPKI EDIT^Kernel PKI Parameter Edit^^A^^^^^^^^KERNEL^n^1
"KRN",19,910,1,0)
^^1^1^3030505^
"KRN",19,910,1,1,0)
This option runs the form XUSSPKI to edit the PKI server IP address.
"KRN",19,910,20)
N DA,DR,DDSFILE S DA=1,DR="[XUSSPKI]",DDSFILE=8989.3 D ^DDS
"KRN",19,910,"U")
KERNEL PKI PARAMETER EDIT
"KRN",8989.51,214,-1)
0^1
"KRN",8989.51,214,0)
XUSC1 DEBUG^Set Debug mode for XUSC1^0
"KRN",8989.51,214,1)
S^0:Disabled;1:Enabled
"KRN",8989.51,214,4,0)
^8989.514^1^1
"KRN",8989.51,214,4,1,0)
DEVELOPER
"KRN",8989.51,214,4,"B","DEVELOPER",1)

"KRN",8989.51,214,20,0)
^8989.512^2^2^3011226^^
"KRN",8989.51,214,20,1,0)
This parameter controls if the XUSC1 client code records debug info into
"KRN",8989.51,214,20,2,0)
the ^TMP global.
"KRN",8989.51,214,30,0)
^8989.513I^1^1
"KRN",8989.51,214,30,1,0)
1^4.2
"MBREQ")
0
"ORD",2,3.6)
3.6;2;1;;BUL^XPDTA1;;BULE1^XPDIA1;;;BULDEL^XPDIA1
"ORD",2,3.6,0)
BULLETIN
"ORD",8,.403)
.403;8;;;EDEOUT^DIFROMSO(.403,DA,"",XPDA);FPRE^DIFROMSI(.403,"",XPDA);EPRE^DIFROMSI(.403,DA,$E("N",$G(XPDNEW)),XPDA,"",OLDA);;EPOST^DIFROMSI(.403,DA,"",XPDA);DEL^DIFROMSK(.403,"",%)
"ORD",8,.403,0)
FORM
"ORD",9,.84)
.84;9;;;EDEOUT^DIFROMSO(.84,DA,"",XPDA);FPRE^DIFROMSI(.84,"",XPDA);EPRE^DIFROMSI(.84,DA,"",XPDA,"",OLDA);;EPOST^DIFROMSI(.84,DA,"",XPDA);DEL^DIFROMSK(.84,"",%)
"ORD",9,.84,0)
DIALOG
"ORD",11,3.8)
3.8;11;;;MAILG^XPDTA1;MAILGF1^XPDIA1;MAILGE1^XPDIA1;MAILGF2^XPDIA1;;MAILGDEL^XPDIA1(%)
"ORD",11,3.8,0)
MAIL GROUP
"ORD",18,19)
19;18;;;OPT^XPDTA;OPTF1^XPDIA;OPTE1^XPDIA;OPTF2^XPDIA;;OPTDEL^XPDIA
"ORD",18,19,0)
OPTION
"ORD",20,8989.51)
8989.51;20;;;PAR1E1^XPDTA2;PAR1F1^XPDIA3;PAR1E1^XPDIA3;PAR1F2^XPDIA3;;PAR1DEL^XPDIA3(%)
"ORD",20,8989.51,0)
PARAMETER DEFINITION
"PKG",3,-1)
1^1
"PKG",3,0)
KERNEL^XU^SIGN-ON, SECURITY, MENU DRIVER, DEVICES, TASKMAN^
"PKG",3,20,0)
^9.402P^^0
"PKG",3,22,0)
^9.49I^1^1
"PKG",3,22,1,0)
8.0^2950703^2970507^.5
"PKG",3,22,1,"PAH",1,0)
283^3030505
"PKG",3,22,1,"PAH",1,1,0)
^^2^2^3030505
"PKG",3,22,1,"PAH",1,1,1,0)
Please refer to the Description in FORUM Patch Module for details.
"PKG",3,22,1,"PAH",1,1,2,0)
XU*8*283  DEA/PKI pilot.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
5
"RTN","XUSC1")
0^3^B6439792
"RTN","XUSC1",1,0)
XUSC1 ;SFISC/RWF - Interface to Server services. ;10/09/2002  16:53
"RTN","XUSC1",2,0)
 ;;8.0;KERNEL;**283**;Jul 10, 1995
"RTN","XUSC1",3,0)
 ;XUSC("STAT") is used to pass subroutine status around.
"RTN","XUSC1",4,0)
 ;The entry points EN, OPEN, DATA, CLOSE are supported ref.
"RTN","XUSC1",5,0)
 ;Calls a server service on a port depending on service.
"RTN","XUSC1",6,0)
 ;Service:port; "ECHO":10250, "CRC32":10255, "SHA1":10260, "DSIG":10265,1:23)
"RTN","XUSC1",7,0)
 ;Return 0 = OK, else -1^msg
"RTN","XUSC1",8,0)
EN(XUSC3,XUSC1,XUSC2) ;
"RTN","XUSC1",9,0)
 ;XUSC3 is the service we want.
"RTN","XUSC1",10,0)
 ;XUSC1 input data array
"RTN","XUSC1",11,0)
 ;XUSC2 return data array.
"RTN","XUSC1",12,0)
 N %,R,XUSC ;XUSC holds data not passed as a parameter.
"RTN","XUSC1",13,0)
 I "DSIG/ECHO/SHA1/DES/CRC32/CRL /"'[XUSC3 S R="-1^Bad service" G EXIT
"RTN","XUSC1",14,0)
 D SAVDEV^%ZISUTL("XUSC-HOME"),IP
"RTN","XUSC1",15,0)
 I $G(XUSC("IP"))="" S R="-1^Server not defined" G EXIT
"RTN","XUSC1",16,0)
 S R=$$EN^XUSC1C(XUSC1,XUSC2,$G(XUSC3,"MPI"))
"RTN","XUSC1",17,0)
EXIT D USE^%ZISUTL("XUSC-HOME"),RMDEV^%ZISUTL("XUSC-HOME")
"RTN","XUSC1",18,0)
 Q R
"RTN","XUSC1",19,0)
 ;
"RTN","XUSC1",20,0)
OPEN(XUSCITE) ;Open Connection, Setup
"RTN","XUSC1",21,0)
 K XUSC N R
"RTN","XUSC1",22,0)
 D IP(XUSCITE),SAVDEV^%ZISUTL("XUSC-HOME")
"RTN","XUSC1",23,0)
 I $G(XUSC("IP"))="" Q "-1^Bad site"
"RTN","XUSC1",24,0)
 D SETUP^XUSC1C S XUSC("HOME")=IO
"RTN","XUSC1",25,0)
 N $ESTACK,$ETRAP S $ETRAP="D ERROR^XUSC1C"
"RTN","XUSC1",26,0)
 D OPEN^XUSC1C I 'XUSC("STAT") D SAVDEV^%ZISUTL("XUSC-IP") U IO D HELO^XUSC1C
"RTN","XUSC1",27,0)
 D USE^%ZISUTL("XUSC-HOME")
"RTN","XUSC1",28,0)
 Q $S('XUSC("STAT"):0,1:XUSC("STAT"))
"RTN","XUSC1",29,0)
 ;
"RTN","XUSC1",30,0)
DATA(INPUT,OUTPUT,TYPE) ;Pass Data, Get Responce
"RTN","XUSC1",31,0)
 S XUSC("STAT")=0 D USE^%ZISUTL("XUSC-IP")
"RTN","XUSC1",32,0)
 D DATA^XUSC1C G:XUSC("STAT") ERR
"RTN","XUSC1",33,0)
 D TURN^XUSC1C G:XUSC("STAT") ERR
"RTN","XUSC1",34,0)
 D GET^XUSC1C G:XUSC("STAT") ERR
"RTN","XUSC1",35,0)
 D USE^%ZISUTL("XUSC-HOME")
"RTN","XUSC1",36,0)
 Q 0
"RTN","XUSC1",37,0)
 ;
"RTN","XUSC1",38,0)
CLOSE() ;Close connection
"RTN","XUSC1",39,0)
 D USE^%ZISUTL("XUSC-IP"),QUIT^XUSC1C,USE^%ZISUTL("XUSC-HOME")
"RTN","XUSC1",40,0)
 D RMDEV^%ZISUTL("XUSC-IP"),RMDEV^%ZISUTL("XUSC-HOME")
"RTN","XUSC1",41,0)
 K XUSC Q 0
"RTN","XUSC1",42,0)
 ;
"RTN","XUSC1",43,0)
ERR ;Report an error
"RTN","XUSC1",44,0)
 D TRACE^XUSC1C("ERROR "_XUSC("STAT"))
"RTN","XUSC1",45,0)
 D QUIT^XUSC1C,USE^%ZISUTL("XUSC-HOME")
"RTN","XUSC1",46,0)
 Q XUSC("STAT")
"RTN","XUSC1",47,0)
 ;
"RTN","XUSC1",48,0)
IP ;Lookup name pass back parameters in XUSC
"RTN","XUSC1",49,0)
 N %,XUSCY,XUSCE
"RTN","XUSC1",50,0)
 S %=$P(XUSC3," ") D
"RTN","XUSC1",51,0)
 . I $L($T(@%)) D @% Q
"RTN","XUSC1",52,0)
 . D ASK Q
"RTN","XUSC1",53,0)
 Q
"RTN","XUSC1",54,0)
 ;
"RTN","XUSC1",55,0)
DSIG S XUSC("IP")=$P($G(^XTV(8989.3,1,"IP1")),"^",1)
"RTN","XUSC1",56,0)
 S XUSC("SOCK")=10265
"RTN","XUSC1",57,0)
 Q
"RTN","XUSC1",58,0)
CRL S XUSC("IP")=$P($G(^XTV(8989.3,1,"IP1")),"^",1)
"RTN","XUSC1",59,0)
 S XUSC("SOCK")=10270
"RTN","XUSC1",60,0)
 Q
"RTN","XUSC1",61,0)
SHA1 S XUSC("IP")=$P($G(^XTV(8989.3,1,"IP1")),"^",1)
"RTN","XUSC1",62,0)
 S XUSC("SOCK")=10260
"RTN","XUSC1",63,0)
 Q
"RTN","XUSC1",64,0)
ASK ; ASK USER FOR IP AND PORT
"RTN","XUSC1",65,0)
 S XUSC("IP")="",XUSC("SOCK")=""
"RTN","XUSC1",66,0)
 R !,"IP Address to use: ",%:DTIME Q:"^"[%  S XUSC("IP")=%
"RTN","XUSC1",67,0)
 R !,"      Port TO use: ",%:DTIME Q:"^"[%  S XUSC("SOCK")=%
"RTN","XUSC1",68,0)
 Q
"RTN","XUSC1",69,0)
 ;
"RTN","XUSC1",70,0)
NOOP() ;
"RTN","XUSC1",71,0)
 S XUSC("STAT")=0 D USE^%ZISUTL("XUSC-IP")
"RTN","XUSC1",72,0)
 S XUSC("OK")=$$POST^XUSC1C("NOOP")
"RTN","XUSC1",73,0)
 D USE^%ZISUTL("XUSC-HOME")
"RTN","XUSC1",74,0)
 Q XUSC("OK")
"RTN","XUSC1C")
0^4^B8238333
"RTN","XUSC1C",1,0)
XUSC1C ;ISCSF/RWF - Client Interface to Server services. ;10/09/2002  17:03
"RTN","XUSC1C",2,0)
 ;;8.0;KERNEL;**283**;Jul 10, 1995
"RTN","XUSC1C",3,0)
 ;Return 0 = OK, else -1^msg
"RTN","XUSC1C",4,0)
EN(INPUT,OUTPUT,TYPE) ;Call to connect to Server
"RTN","XUSC1C",5,0)
 N X,Y,XUSCCMD,XUSCDAT,XUSCER,XUSCTIME,XUSCTRC,XUSCEXIT
"RTN","XUSC1C",6,0)
 D SETUP
"RTN","XUSC1C",7,0)
 D TRACE("IP:"_XUSC("IP")_" Port: "_XUSC("SOCK"))
"RTN","XUSC1C",8,0)
 N $ESTACK,$ETRAP S $ETRAP="D ERROR^XUSC1C"
"RTN","XUSC1C",9,0)
 D OPEN G:XUSC("STAT") ERR
"RTN","XUSC1C",10,0)
 D HELO G:XUSC("STAT") ERR
"RTN","XUSC1C",11,0)
 ;D SERV G:XUSC("STAT") ERR
"RTN","XUSC1C",12,0)
 D DATA G:XUSC("STAT") ERR
"RTN","XUSC1C",13,0)
 D TURN G:XUSC("STAT") ERR
"RTN","XUSC1C",14,0)
 D GET G:XUSC("STAT") ERR
"RTN","XUSC1C",15,0)
 D QUIT
"RTN","XUSC1C",16,0)
 Q 0
"RTN","XUSC1C",17,0)
ERR ;Report back an error
"RTN","XUSC1C",18,0)
 D TRACE("ERROR "_XUSC("STAT"))
"RTN","XUSC1C",19,0)
 D:'POP QUIT
"RTN","XUSC1C",20,0)
 Q XUSC("STAT")
"RTN","XUSC1C",21,0)
 ;
"RTN","XUSC1C",22,0)
ERROR ;Trap an error
"RTN","XUSC1C",23,0)
 S XUSC("STAT")="-1^M error: "_$ECODE
"RTN","XUSC1C",24,0)
 D ^%ZTER G UNWIND^%ZTER
"RTN","XUSC1C",25,0)
 ;
"RTN","XUSC1C",26,0)
OPEN ;Open connection
"RTN","XUSC1C",27,0)
 N IPCNT,IPA
"RTN","XUSC1C",28,0)
 D TRACE("Make Connection")
"RTN","XUSC1C",29,0)
 F IPCNT=1:1 S IPA=$P(XUSC("IP"),",",IPCNT) Q:IPA=""  D
"RTN","XUSC1C",30,0)
 . I IPA'?1.3N1P1.3N1P1.3N1P1.3N S IPA=$P($$ADDRESS^XLFNSLK(IPA),",")
"RTN","XUSC1C",31,0)
 . I IPA'?1.3N1P1.3N1P1.3N1P1.3N Q
"RTN","XUSC1C",32,0)
 . D TRACE("Call IP "_IPA)
"RTN","XUSC1C",33,0)
 . F XUSCCNT=0:1:5 D  Q:'POP
"RTN","XUSC1C",34,0)
 . . D CALL^%ZISTCP(IPA,XUSC("SOCK"),1)
"RTN","XUSC1C",35,0)
 I POP S XUSC("STAT")="-1^Inital Connection Failed" Q
"RTN","XUSC1C",36,0)
 D TRACE("Got Connection")
"RTN","XUSC1C",37,0)
 U IO
"RTN","XUSC1C",38,0)
 Q
"RTN","XUSC1C",39,0)
HELO ;start conversation
"RTN","XUSC1C",40,0)
 S X=$$POST("HELO "_$$KSP^XUPARAM("WHERE"))
"RTN","XUSC1C",41,0)
 I $E(X,1)'=2 S XUSC("STAT")="-1^Initial HELO Failed",XUSC("REC")=X
"RTN","XUSC1C",42,0)
 I $E(X,1,3)="421" S XUSC("STAT")="-1^Busy"
"RTN","XUSC1C",43,0)
 F  Q:$E(XUSCCMD,1,3)=220  D CREAD^XUSC1S
"RTN","XUSC1C",44,0)
 Q
"RTN","XUSC1C",45,0)
SERV ;Requested Service
"RTN","XUSC1C",46,0)
 D TRACE("Service Request: "_TYPE)
"RTN","XUSC1C",47,0)
 S X=$$POST("SERV "_TYPE)
"RTN","XUSC1C",48,0)
 I $E(X,1)'=2 S XUSC("STAT")="-1^"_X,XUSC("REC")=X
"RTN","XUSC1C",49,0)
 Q
"RTN","XUSC1C",50,0)
DATA ;Send data
"RTN","XUSC1C",51,0)
 D TRACE("Send Data")
"RTN","XUSC1C",52,0)
 D SDATA^XUSC1S1(INPUT,$G(TYPE,"MPI")),CREAD^XUSC1S
"RTN","XUSC1C",53,0)
 I $E(XUSCCMD,1)'=2 S XUSC("STAT")="-1^No 220 after send "_XUSCDAT Q
"RTN","XUSC1C",54,0)
 Q
"RTN","XUSC1C",55,0)
 ;
"RTN","XUSC1C",56,0)
TURN ;Turn channel
"RTN","XUSC1C",57,0)
 S X=$$POST("TURN ") I $E(X,1)'=2 S XUSC("STAT")="-1^No 220 after Turn"
"RTN","XUSC1C",58,0)
 Q
"RTN","XUSC1C",59,0)
GET ;Get responce
"RTN","XUSC1C",60,0)
 D CREAD^XUSC1S I XUSCCMD[220 G GET
"RTN","XUSC1C",61,0)
 I XUSCCMD'["DATA" S XUSC("STAT")="-1^No DATA cmd "_XUSCCMD Q
"RTN","XUSC1C",62,0)
 D DATA^XUSC1S1(OUTPUT)
"RTN","XUSC1C",63,0)
 Q
"RTN","XUSC1C",64,0)
QUIT ;Shut down
"RTN","XUSC1C",65,0)
 D SEND^XUSC1S("QUIT ")
"RTN","XUSC1C",66,0)
 D CLOSE^%ZISTCP
"RTN","XUSC1C",67,0)
 Q
"RTN","XUSC1C",68,0)
POST(MSG) ;Send a command and get responce
"RTN","XUSC1C",69,0)
 D SEND^XUSC1S(MSG)
"RTN","XUSC1C",70,0)
 D CREAD^XUSC1S
"RTN","XUSC1C",71,0)
 Q XUSCCMD
"RTN","XUSC1C",72,0)
 ;
"RTN","XUSC1C",73,0)
TRACE(S1) ;
"RTN","XUSC1C",74,0)
 N %,H
"RTN","XUSC1C",75,0)
 I S1=-1 K ^TMP("XUSC1",$J) Q
"RTN","XUSC1C",76,0)
 Q:'$G(XUSCDBUG)
"RTN","XUSC1C",77,0)
 S H=$P($H,",",2),H=(H\3600)_":"_(H#3600\60)_":"_(H#60)_" "
"RTN","XUSC1C",78,0)
 L +^TMP("XUSC1",$J)
"RTN","XUSC1C",79,0)
 S %=$G(^TMP("XUSC1",$J,0))+1,^(0)=%,^(%)=H_XUSCTRC_S1
"RTN","XUSC1C",80,0)
 L -^TMP("XUSC1",$J)
"RTN","XUSC1C",81,0)
 Q
"RTN","XUSC1C",82,0)
SETUP ;
"RTN","XUSC1C",83,0)
 S (XUSC("STAT"),XUSCEXIT)=0,XUSCTIME=30,XUSCTRC="C: "
"RTN","XUSC1C",84,0)
 S XUSCDBUG=$$GET^XPAR("SYS","XUSC1 DEBUG",,"Q")
"RTN","XUSC1C",85,0)
 D TRACE(-1),TRACE("Client Setup")
"RTN","XUSC1C",86,0)
 Q
"RTN","XUSC1S")
0^6^B13011221
"RTN","XUSC1S",1,0)
XUSC1S ;ISCSF/RWF - Interface to Server services. ;10/09/2002  16:59
"RTN","XUSC1S",2,0)
 ;;8.0;KERNEL;**283**;Jul 10, 1995
"RTN","XUSC1S",3,0)
 Q
"RTN","XUSC1S",4,0)
 ;XUSC is used to pass data around.
"RTN","XUSC1S",5,0)
 ; 5224 is the standard VA port for the Services Server.
"RTN","XUSC1S",6,0)
LISTEN ;only for OpenM
"RTN","XUSC1S",7,0)
 S $ETRAP="D ^%ZTER H"
"RTN","XUSC1S",8,0)
 D LISTEN^%ZISTCPS(5500,"ONT^XUSC1S")
"RTN","XUSC1S",9,0)
 Q
"RTN","XUSC1S",10,0)
DSM ;Test listener
"RTN","XUSC1S",11,0)
 S IO=% O IO:(SHARE) U IO ;Setup TCP port
"RTN","XUSC1S",12,0)
 S IO(0)="_NLA0:" O IO(0) ;Setup null device
"RTN","XUSC1S",13,0)
 D SVR
"RTN","XUSC1S",14,0)
 Q
"RTN","XUSC1S",15,0)
MSM ;Entry point from MSERVER
"RTN","XUSC1S",16,0)
 S IO=56,IO(0)=46 O 46 ;Null device
"RTN","XUSC1S",17,0)
 D SVR C IO
"RTN","XUSC1S",18,0)
 Q
"RTN","XUSC1S",19,0)
ONT ;Cache/OpenM
"RTN","XUSC1S",20,0)
 S IO=$I,IO(0)="//./nul" O IO(0)
"RTN","XUSC1S",21,0)
 D SVR
"RTN","XUSC1S",22,0)
 Q
"RTN","XUSC1S",23,0)
 ;
"RTN","XUSC1S",24,0)
SVR ;Entry point when we have a connect
"RTN","XUSC1S",25,0)
 ;See that IO=TCP device, and IO(0) is Null device and Open.
"RTN","XUSC1S",26,0)
 N XUSC11,XUSCER,XUSCEXIT,XUSCCMD,XUSCDAT,ZTQUEUED D SETUP
"RTN","XUSC1S",27,0)
 N $ESTACK,$ETRAP S $ETRAP="D ^%ZTER H"
"RTN","XUSC1S",28,0)
 K ^XUTL("XQ",$J) S ^XUTL("XQ",$J,0)=$$NOW^XLFDT
"RTN","XUSC1S",29,0)
 F  D CREAD Q:XUSCEXIT  D  Q:XUSCEXIT
"RTN","XUSC1S",30,0)
 . I XUSCCMD="" S XUSC11("TCNT")=$G(XUSC11("TCNT"))+1 S:$$STOP!(XUSC11("TCNT")>10) XUSCEXIT=1 Q
"RTN","XUSC1S",31,0)
 . I XUSCCMD'?4A D SEND("500 Bad CMD: "_$E(XUSCCMD,1,20)) Q
"RTN","XUSC1S",32,0)
 . I $T(@XUSCCMD)="" D SEND("500 ") Q
"RTN","XUSC1S",33,0)
 . S XUSC11("TCNT")=0
"RTN","XUSC1S",34,0)
 . D @XUSCCMD I $G(XUSCER) D TRACE("ERROR: "_XUSCER)
"RTN","XUSC1S",35,0)
 . Q
"RTN","XUSC1S",36,0)
 S:XUSCEXIT IO("C")=1
"RTN","XUSC1S",37,0)
 I '$G(XUSCDBUG) K ^TMP("XUSCI",$J),^TMP("XUSCO",$J) ;Clean up
"RTN","XUSC1S",38,0)
 D TRACE("Exit")
"RTN","XUSC1S",39,0)
 Q
"RTN","XUSC1S",40,0)
HELO ;Process HELO
"RTN","XUSC1S",41,0)
 S XUSC11("SITE")=$P(XUSCDAT," ")
"RTN","XUSC1S",42,0)
 ;Do any check on who is sending
"RTN","XUSC1S",43,0)
 D SEND("220 "_$$KSP^XUPARAM("WHERE")_" Ready for "_XUSCDAT)
"RTN","XUSC1S",44,0)
 Q
"RTN","XUSC1S",45,0)
 ;
"RTN","XUSC1S",46,0)
NOOP ;
"RTN","XUSC1S",47,0)
 D SEND("250 OK")
"RTN","XUSC1S",48,0)
 Q
"RTN","XUSC1S",49,0)
 ;
"RTN","XUSC1S",50,0)
DATA ;Process DATA
"RTN","XUSC1S",51,0)
 ; The DATA cmd can pass some parameters as well, this could be passed
"RTN","XUSC1S",52,0)
 ; to the processing routine also.
"RTN","XUSC1S",53,0)
 N XUSCRTN,P,I,DUZ S DUZ=0,DUZ(0)="@"
"RTN","XUSC1S",54,0)
 D TRACE("Get Data")
"RTN","XUSC1S",55,0)
 S (XUSCRTN,XUSC11("DATA"))=XUSCDAT K @XUSCIN,@XUSCOUT
"RTN","XUSC1S",56,0)
 D DATA^XUSC1S1(XUSCIN,.XUSC11)
"RTN","XUSC1S",57,0)
 S P="" F I=1:1 Q:'$D(XUSC11("P"_I))  S P=P_"P"_I_"="_XUSC11("P"_I)_", "
"RTN","XUSC1S",58,0)
 D TRACE("PARAM "_P)
"RTN","XUSC1S",59,0)
 ;Use the Null Device
"RTN","XUSC1S",60,0)
 U IO(0)
"RTN","XUSC1S",61,0)
 ;Now call soneone to process the data
"RTN","XUSC1S",62,0)
 ;I XUSC11("P1")="SERVER" D SERVER^XUSC1S2
"RTN","XUSC1S",63,0)
 I XUSC11("P1")="PING" M @XUSCOUT=@XUSCIN
"RTN","XUSC1S",64,0)
 U IO ;Back to the TCP device
"RTN","XUSC1S",65,0)
 Q
"RTN","XUSC1S",66,0)
TURN ;Turn and send responce
"RTN","XUSC1S",67,0)
 D SEND("220 OK")
"RTN","XUSC1S",68,0)
 D SDATA^XUSC1S1(XUSCOUT,XUSC11("P1"))
"RTN","XUSC1S",69,0)
 D CREAD,TRACE("Data Sent ") ;Look for 220 ok
"RTN","XUSC1S",70,0)
 Q
"RTN","XUSC1S",71,0)
QUIT ;Process QUIT
"RTN","XUSC1S",72,0)
 D TRACE("QUIT")
"RTN","XUSC1S",73,0)
 S XUSCMSG="",XUSCEXIT=1
"RTN","XUSC1S",74,0)
 Q
"RTN","XUSC1S",75,0)
 ;
"RTN","XUSC1S",76,0)
CREAD ;Read a string
"RTN","XUSC1S",77,0)
 N $ETRAP S $ETRAP="S $EC="""" G CREX"
"RTN","XUSC1S",78,0)
 N I S (Y,XUSCDAT,XUSCCMD)="",XUSCER=0
"RTN","XUSC1S",79,0)
 F I=0:1:255 R X#1:XUSCTIME S:'$T XUSCER=1 D TRACE("Char "_$A(X)) Q:X=$C(10)!XUSCER  S Y=Y_X
"RTN","XUSC1S",80,0)
 S Y=$TR(Y,$C(13,10)),XUSCCMD=$P(Y," "),XUSCDAT=$P(Y," ",2,99)
"RTN","XUSC1S",81,0)
 D TRACE("Cmd Read "_Y)
"RTN","XUSC1S",82,0)
 Q
"RTN","XUSC1S",83,0)
CREX S XUSCEXIT=1,XUSCER="1 Error"
"RTN","XUSC1S",84,0)
 D TRACE("CREAD error: "_$$EC^%ZOSV_" Y="_Y)
"RTN","XUSC1S",85,0)
 Q
"RTN","XUSC1S",86,0)
 ;
"RTN","XUSC1S",87,0)
SEND(MSG) ;Send a cmd MSG
"RTN","XUSC1S",88,0)
 N $ETRAP S $ETRAP="S $EC="""" D CREX"
"RTN","XUSC1S",89,0)
 D TRACE("Cmd Send "_MSG)
"RTN","XUSC1S",90,0)
 W MSG,$C(13,10),!
"RTN","XUSC1S",91,0)
 Q
"RTN","XUSC1S",92,0)
 ;
"RTN","XUSC1S",93,0)
SETUP ;Setup needed variables
"RTN","XUSC1S",94,0)
 K IO("C") S (XUSCER,XUSCEXIT)=0,XUSCTIME=345,ZTQUEUED=.5 ;**** CHANGE BACK
"RTN","XUSC1S",95,0)
 S XUSCTRC="S: ",XUSC11("P1")="TEXT"
"RTN","XUSC1S",96,0)
 S XUSCIN=$NA(^TMP("XUSCI",$J)),XUSCOUT=$NA(^TMP("XUSCO",$J))
"RTN","XUSC1S",97,0)
 S XUSCDBUG=$$GET^XPAR("SYS","XUSC1 DEBUG",,"Q")
"RTN","XUSC1S",98,0)
 D TRACE(-1),TRACE("Server Setup")
"RTN","XUSC1S",99,0)
 Q
"RTN","XUSC1S",100,0)
STOP(%) ;Should the server stop.
"RTN","XUSC1S",101,0)
 I $G(%)=1 S ^TMP("XUSC1","STOP")=1 Q
"RTN","XUSC1S",102,0)
 I $G(%)=-1 K ^TMP("XUSC1","STOP") Q
"RTN","XUSC1S",103,0)
 I $D(^TMP("XUSC1","STOP")) Q 1
"RTN","XUSC1S",104,0)
 Q 0
"RTN","XUSC1S",105,0)
 ;
"RTN","XUSC1S",106,0)
TRACE(S1) ;
"RTN","XUSC1S",107,0)
 N H,%
"RTN","XUSC1S",108,0)
 I S1=-1 K ^TMP("XUSC1",$J) Q
"RTN","XUSC1S",109,0)
 Q:'$G(XUSCDBUG)
"RTN","XUSC1S",110,0)
 S H=$P($H,",",2),H=(H\3600)_":"_(H#3600\60)_":"_(H#60)_" "
"RTN","XUSC1S",111,0)
 L +^TMP("XUSC1",$J)
"RTN","XUSC1S",112,0)
 S %=$G(^TMP("XUSC1",$J,0))+1,^(0)=%,^(%)=H_$G(XUSCTRC)_S1
"RTN","XUSC1S",113,0)
 L -^TMP("XUSC1",$J)
"RTN","XUSC1S",114,0)
 Q
"RTN","XUSC1S",115,0)
 ;
"RTN","XUSC1S1")
0^7^B2399695
"RTN","XUSC1S1",1,0)
XUSC1S1 ;ISCSF/RWF - Read data ;04/01/2002  17:13
"RTN","XUSC1S1",2,0)
 ;;8.0;KERNEL;**283**;Jul 10, 1995
"RTN","XUSC1S1",3,0)
 Q
"RTN","XUSC1S1",4,0)
DATA(ROOT,STAT) ;get Data
"RTN","XUSC1S1",5,0)
 N I,M
"RTN","XUSC1S1",6,0)
 D DCODE(XUSCDAT),TRACE^XUSC1S("DECODE "_XUSCDAT)
"RTN","XUSC1S1",7,0)
 ;Check if data type is OK
"RTN","XUSC1S1",8,0)
 ;I ...
"RTN","XUSC1S1",9,0)
 F I=1:1 S M=$$DREAD() Q:XUSCER!M  S @ROOT@(I)=XUSCDAT
"RTN","XUSC1S1",10,0)
 ;If we got it all
"RTN","XUSC1S1",11,0)
 D SEND^XUSC1S($S(XUSCER:"500 Data error",1:"220 OK"))
"RTN","XUSC1S1",12,0)
 Q
"RTN","XUSC1S1",13,0)
 ;
"RTN","XUSC1S1",14,0)
SDATA(ROOT,TYPE) ;Send data from a source
"RTN","XUSC1S1",15,0)
 N X,Y,L,D
"RTN","XUSC1S1",16,0)
 S ROOT=$NA(@ROOT),X=ROOT,Y=$E(ROOT,1,$L(ROOT)-1),XUSCER=0
"RTN","XUSC1S1",17,0)
 D SEND^XUSC1S("DATA PARAM="_TYPE)
"RTN","XUSC1S1",18,0)
 S X=ROOT
"RTN","XUSC1S1",19,0)
 F  S X=$Q(@X) Q:$E(X,1,$L(Y))'=Y  D DSEND(@X)
"RTN","XUSC1S1",20,0)
 D ESEND ;Tell other end we'r done
"RTN","XUSC1S1",21,0)
 Q
"RTN","XUSC1S1",22,0)
DCODE(D) ;Decode a DATA string
"RTN","XUSC1S1",23,0)
 S D=$$UP^XLFSTR(D),D=$P(D,"PARAM=",2,99)
"RTN","XUSC1S1",24,0)
 F I=1:1 S STAT("P"_I)=$P(D,",",I) Q:$P(D,",",I+1)=""
"RTN","XUSC1S1",25,0)
 Q
"RTN","XUSC1S1",26,0)
DREAD() ;Data read
"RTN","XUSC1S1",27,0)
 N L,D,R S (D,XUSCDAT)="",XUSCER=0
"RTN","XUSC1S1",28,0)
 S L=$$LREAD(3) Q:XUSCER 1
"RTN","XUSC1S1",29,0)
 I L<0 S XUSCDAT="" Q 1
"RTN","XUSC1S1",30,0)
 I L'?3N S XUSCER="1 Out of sync: "_L Q 1
"RTN","XUSC1S1",31,0)
 I L>0 S XUSCDAT=$$LREAD(L)
"RTN","XUSC1S1",32,0)
 Q 0
"RTN","XUSC1S1",33,0)
DSEND(D) ;Data send
"RTN","XUSC1S1",34,0)
 N L
"RTN","XUSC1S1",35,0)
 S L=$L(D),L=$E(1000+L,2,4)
"RTN","XUSC1S1",36,0)
 W L,D,! ;Flush buffer
"RTN","XUSC1S1",37,0)
 Q
"RTN","XUSC1S1",38,0)
ESEND ;Send end of data message
"RTN","XUSC1S1",39,0)
 W "-10",!
"RTN","XUSC1S1",40,0)
 Q
"RTN","XUSC1S1",41,0)
LREAD(N) ;Read N char
"RTN","XUSC1S1",42,0)
 N D,C,P S D="",C=N,XUSCER=0
"RTN","XUSC1S1",43,0)
 F  D  Q:'C!XUSCER
"RTN","XUSC1S1",44,0)
 . R P#C:XUSCTIME E  S XUSCER=1 Q
"RTN","XUSC1S1",45,0)
 . D TRACE^XUSC1S("LREAD "_$A(P)) ;*rwf
"RTN","XUSC1S1",46,0)
 . S D=D_P,C=N-$L(D)
"RTN","XUSC1S1",47,0)
 . Q
"RTN","XUSC1S1",48,0)
 Q D
"RTN","XUSSPKI")
0^1^B12359565
"RTN","XUSSPKI",1,0)
XUSSPKI ;ISF/RWF - Kernel Security Services PKI ;02/04/2003  13:19
"RTN","XUSSPKI",2,0)
 ;;8.0;KERNEL;**283**;Jul 10, 1995
"RTN","XUSSPKI",3,0)
 ;;
"RTN","XUSSPKI",4,0)
 Q  ;No entry from top
"RTN","XUSSPKI",5,0)
 ;Supported by IA # 3539
"RTN","XUSSPKI",6,0)
 ;This is a M api to store the Digital Signature in file 8980.2
"RTN","XUSSPKI",7,0)
STORESIG(XU1,XU2,XU3,XU4,XU5) ;Store the signature.
"RTN","XUSSPKI",8,0)
 ;XU1 is the hash
"RTN","XUSSPKI",9,0)
 ;XU2 is the string length
"RTN","XUSSPKI",10,0)
 ;XU3 is an array for the sig
"RTN","XUSSPKI",11,0)
 ;XU4 is the DUZ of the signer
"RTN","XUSSPKI",12,0)
 ;XU5 is the file that holds the data.
"RTN","XUSSPKI",13,0)
 ;Returns 1 if filed OK, "-1^message" if an error.
"RTN","XUSSPKI",14,0)
 N FDA,IEN,CNT,ROOT
"RTN","XUSSPKI",15,0)
 I $$FIND1^DIC(8980.2,,"X",XU1)>0 Q "-1^Dup Hash"
"RTN","XUSSPKI",16,0)
 I $G(XU4)<.5 Q "-1^No DUZ"
"RTN","XUSSPKI",17,0)
 I $G(XU5)="" Q "-1^No File Number"
"RTN","XUSSPKI",18,0)
 S CNT=0,ROOT="XU3"
"RTN","XUSSPKI",19,0)
 F  S ROOT=$Q(@ROOT) Q:ROOT=""  S CNT=CNT+$L(@ROOT)
"RTN","XUSSPKI",20,0)
 I CNT'=XU2 Q "-1^BAD SIG LENGTH"
"RTN","XUSSPKI",21,0)
 S FDA(8980.2,"+1,",.01)=XU1
"RTN","XUSSPKI",22,0)
 S FDA(8980.2,"+1,",.02)=XU2
"RTN","XUSSPKI",23,0)
 S FDA(8980.2,"+1,",.03)=XU4
"RTN","XUSSPKI",24,0)
 S FDA(8980.2,"+1,",.04)=XU5
"RTN","XUSSPKI",25,0)
 S FDA(8980.2,"+1,",1)="XU3"
"RTN","XUSSPKI",26,0)
 D UPDATE^DIE("S","FDA","IEN")
"RTN","XUSSPKI",27,0)
 I $D(^TMP("DIERR",$J)) Q "-1^DBS Error"
"RTN","XUSSPKI",28,0)
 Q 1
"RTN","XUSSPKI",29,0)
 ;
"RTN","XUSSPKI",30,0)
 ;Supported by IA # 3539
"RTN","XUSSPKI",31,0)
CRLURL(XU1) ;Store the URL for the CRL
"RTN","XUSSPKI",32,0)
 ;Store each URL as a separte record
"RTN","XUSSPKI",33,0)
 N FDA,IEN,CNT,NOW,X,Y,ERR
"RTN","XUSSPKI",34,0)
 S ERR=0,NOW=$$NOW^XLFDT
"RTN","XUSSPKI",35,0)
 F CNT=1:1 S X=$P(XU1,$C(9),CNT) Q:X=""  D
"RTN","XUSSPKI",36,0)
 . S Y=$$LOW^XLFSTR($E(X,1,4))
"RTN","XUSSPKI",37,0)
 . I '((Y="http")!(Y="ldap")) Q
"RTN","XUSSPKI",38,0)
 . S FDA(8980.22,"?+"_CNT_",",.01)=X
"RTN","XUSSPKI",39,0)
 . S FDA(8980.22,"?+"_CNT_",",1)=NOW
"RTN","XUSSPKI",40,0)
 . D UPDATE^DIE("S","FDA","IEN")
"RTN","XUSSPKI",41,0)
 . I $D(^TMP("DIERR",$J)) S ERR=1
"RTN","XUSSPKI",42,0)
 . Q
"RTN","XUSSPKI",43,0)
 Q $S('ERR:1,1:"-1^DBS Error")
"RTN","XUSSPKI",44,0)
 ;
"RTN","XUSSPKI",45,0)
 ;Supported by IA # 3539
"RTN","XUSSPKI",46,0)
VERIFY(XU1,XU2,XU3) ;Veryify the data
"RTN","XUSSPKI",47,0)
 ;The HASH is in XU1
"RTN","XUSSPKI",48,0)
 ;The data root is in XU2
"RTN","XUSSPKI",49,0)
 ;(optional) Date to check against
"RTN","XUSSPKI",50,0)
 N CNT,IEN,SD,DR,R,V,ZX K ^TMP("PKI",$J),^TMP("pki",$J)
"RTN","XUSSPKI",51,0)
 S IEN=$$FIND1^DIC(8980.2,,"X",XU1)
"RTN","XUSSPKI",52,0)
 I IEN'>0 Q "-1^FAIL TO FIND HASH"
"RTN","XUSSPKI",53,0)
 S CNT=0,SD=$NA(^TMP("PKI",$J)),DR=$E(XU2,1,$L(XU2)-1)
"RTN","XUSSPKI",54,0)
 ;Load the data into the buffer
"RTN","XUSSPKI",55,0)
 F  S XU2=$Q(@XU2) Q:XU2'[DR  S V=@XU2 I $L(V) D ADD(V)
"RTN","XUSSPKI",56,0)
 D ADD("") ;Blank line between
"RTN","XUSSPKI",57,0)
 ;Load the Digital Signature into the buffer
"RTN","XUSSPKI",58,0)
 F I=1:1 Q:'$D(^XUSSPKI(8980.2,IEN,1,I,0))  S V=^(0) I $L(V) D ADD(V)
"RTN","XUSSPKI",59,0)
 ;Then a Blank line and the Date.
"RTN","XUSSPKI",60,0)
 D ADD(""),ADD($G(XU3))
"RTN","XUSSPKI",61,0)
 ;Send the buffer
"RTN","XUSSPKI",62,0)
 S S=$$EN^XUSC1("DSIG",SD,$NA(ZX))
"RTN","XUSSPKI",63,0)
 S R=$S(S<0:S,1:ZX(1))
"RTN","XUSSPKI",64,0)
 Q R
"RTN","XUSSPKI",65,0)
ADD(V) ;Add to the send array
"RTN","XUSSPKI",66,0)
 S CNT=CNT+1,@SD@(CNT)=V
"RTN","XUSSPKI",67,0)
 Q
"RTN","XUSSPKI",68,0)
 ;
"RTN","XUSSPKI",69,0)
CRLUP ;Send any unsent CRL URL's to the server
"RTN","XUSSPKI",70,0)
 ;Server port is 10270
"RTN","XUSSPKI",71,0)
 L ^XUSSPKI(8980.22,"AC"):1 I '$T Q  ;Busy
"RTN","XUSSPKI",72,0)
 N CNT,SD,FDA,IEN,LIM,NOW,X1,X2,X3 K ^TMP("PKI",$J),^TMP("XUSSPKI",$J)
"RTN","XUSSPKI",73,0)
 ;Only send for 300 days past last seen date
"RTN","XUSSPKI",74,0)
 S X1=0,LIM=$$HTFM^XLFDT($H-300),CNT=0,NOW=$$NOW^XLFDT
"RTN","XUSSPKI",75,0)
 S SD=$NA(^TMP("PKI",$J)),FDA=$NA(^TMP("XUSSPKI",$J))
"RTN","XUSSPKI",76,0)
 F  S X1=$O(^XUSSPKI(8980.22,X1)) Q:X1=""  D
"RTN","XUSSPKI",77,0)
 . S X2=$G(^XUSSPKI(8980.22,X1,0)),X2(1)=$P(X2,U,1),X2(2)=$P(X2,U,2),X2(3)=$P(X2,U,3) Q:'$L(X2(1))
"RTN","XUSSPKI",78,0)
 . ;Only send http for now
"RTN","XUSSPKI",79,0)
 . I "http:"'=$$LOW^XLFSTR($E(X2,1,5)) Q
"RTN","XUSSPKI",80,0)
 . ;Check last seen, Last sent more than 3 hours ago.
"RTN","XUSSPKI",81,0)
 . I (X2(2)<LIM)!($$FMDIFF^XLFDT(NOW,X2(3),2)<10800) Q
"RTN","XUSSPKI",82,0)
 . D ADD(X2(1)) S @FDA@("8980.22",X1_",",2)=NOW
"RTN","XUSSPKI",83,0)
 . Q
"RTN","XUSSPKI",84,0)
 S S=-1 ;Init var, CNT update in ADD
"RTN","XUSSPKI",85,0)
 ;Send the buffer of CRL URL's
"RTN","XUSSPKI",86,0)
 I CNT D
"RTN","XUSSPKI",87,0)
 . S S=$$EN^XUSC1("CRL ",SD,$NA(X3))
"RTN","XUSSPKI",88,0)
 . S @SD@("Result")=S_"^"_$G(X3(1))
"RTN","XUSSPKI",89,0)
 . S S=$S(S<0:S,$G(X3(1))'="OK":"-3^"_$G(X3(1)),1:S)
"RTN","XUSSPKI",90,0)
 I CNT,(S<0) D
"RTN","XUSSPKI",91,0)
 . N XMB,XMY,XMTEXT,XMDUZ S XMB(1)=S,XMB(2)=$$FMTE^XLFDT(NOW),XMDUZ="CRL Upload Task"
"RTN","XUSSPKI",92,0)
 . S XMB="XUSSPKI CRL SERVER" D ^XMB
"RTN","XUSSPKI",93,0)
 . Q
"RTN","XUSSPKI",94,0)
 I S'<0 D
"RTN","XUSSPKI",95,0)
 . D FILE^DIE("K",FDA)
"RTN","XUSSPKI",96,0)
 Q
"RTN","XUSSPKI",97,0)
TESTCRL ;TEST CRLUP
"RTN","XUSSPKI",98,0)
 N FDA,LUD
"RTN","XUSSPKI",99,0)
 S DA=0,RT=$NA(^XUSSPKI(8980.22)),LUD=$$HTFM^XLFDT(+$H_",120")
"RTN","XUSSPKI",100,0)
 F  S DA=$O(@RT@(DA)) Q:DA'>0  S FDA(8980.22,DA_",",2)=LUD
"RTN","XUSSPKI",101,0)
 D FILE^DIE("K","FDA")
"RTN","XUSSPKI",102,0)
 D CRLUP
"RTN","XUSSPKI",103,0)
 W "Result: ",$G(^TMP("PKI",$J,"Result"))
"RTN","XUSSPKI",104,0)
 Q
"SEC","^DIC",8980.22,8980.22,0,"AUDIT")
#
"SEC","^DIC",8980.22,8980.22,0,"DD")
#
"SEC","^DIC",8980.22,8980.22,0,"DEL")
#
"SEC","^DIC",8980.22,8980.22,0,"LAYGO")
#
"SEC","^DIC",8980.22,8980.22,0,"RD")
#
"SEC","^DIC",8980.22,8980.22,0,"WR")
#
"VER")
8.0^22.0
"^DD",8980.2,8980.2,0)
FIELD^^.05^6
"^DD",8980.2,8980.2,0,"DT")
3011220
"^DD",8980.2,8980.2,0,"IX","B",8980.2,.01)

"^DD",8980.2,8980.2,0,"NM","PKI Digital Signatures")

"^DD",8980.2,8980.2,.01,0)
NAME^RF^^0;1^K:$L(X)>50!($L(X)<3)!'(X'?1P.E) X
"^DD",8980.2,8980.2,.01,1,0)
^.1
"^DD",8980.2,8980.2,.01,1,1,0)
8980.2^B
"^DD",8980.2,8980.2,.01,1,1,1)
S ^XUSSPKI(8980.2,"B",$E(X,1,30),DA)=""
"^DD",8980.2,8980.2,.01,1,1,2)
K ^XUSSPKI(8980.2,"B",$E(X,1,30),DA)
"^DD",8980.2,8980.2,.01,1,2,0)
^^TRIGGER^8980.2^.05
"^DD",8980.2,8980.2,.01,1,2,1)
X ^DD(8980.2,.01,1,2,1.3) I X S X=DIV S Y(1)=$S($D(^XUSSPKI(8980.2,D0,0)):^(0),1:"") S X=$P(Y(1),U,5),X=X S DIU=X K Y S X=DIV S %=$P($H,",",2),X=DT_(%\60#60/100+(%\3600)+(%#60/10000)/100) X ^DD(8980.2,.01,1,2,1.4)
"^DD",8980.2,8980.2,.01,1,2,1.3)
K DIV S DIV=X,D0=DA,DIV(0)=D0 S Y(0)=X S Y(1)=$S($D(^XUSSPKI(8980.2,D0,0)):^(0),1:"") S X=$P(Y(1),U,5)=""
"^DD",8980.2,8980.2,.01,1,2,1.4)
S DIH=$G(^XUSSPKI(8980.2,DIV(0),0)),DIV=X S $P(^(0),U,5)=DIV,DIH=8980.2,DIG=.05 D ^DICR
"^DD",8980.2,8980.2,.01,1,2,2)
Q
"^DD",8980.2,8980.2,.01,1,2,3)
FILEDATE
"^DD",8980.2,8980.2,.01,1,2,"%D",0)
^^1^1^3020819^
"^DD",8980.2,8980.2,.01,1,2,"%D",1,0)
This X-ref set the FILEDATE FIELD with todays date/time.
"^DD",8980.2,8980.2,.01,1,2,"CREATE CONDITION")
FILEDATE=""
"^DD",8980.2,8980.2,.01,1,2,"CREATE VALUE")
NOW
"^DD",8980.2,8980.2,.01,1,2,"DELETE VALUE")
NO EFFECT
"^DD",8980.2,8980.2,.01,1,2,"DT")
3020819
"^DD",8980.2,8980.2,.01,1,2,"FIELD")
FILE
"^DD",8980.2,8980.2,.01,3)
Answer must be 3-50 characters in length.
"^DD",8980.2,8980.2,.01,"DT")
3020819
"^DD",8980.2,8980.2,.02,0)
SIZE OF SIG.^NJ5,0^^0;2^K:+X'=X!(X>99999)!(X<0)!(X?.E1"."1N.N) X
"^DD",8980.2,8980.2,.02,3)
Type a Number between 0 and 99999, 0 Decimal Digits
"^DD",8980.2,8980.2,.02,"DT")
3011015
"^DD",8980.2,8980.2,.03,0)
USER^RP200'^VA(200,^0;3^Q
"^DD",8980.2,8980.2,.03,3)

"^DD",8980.2,8980.2,.03,21,0)
^.001^2^2^3011220^^
"^DD",8980.2,8980.2,.03,21,1,0)
This field holds a pointer to the New Person file so we know who's
"^DD",8980.2,8980.2,.03,21,2,0)
Certificate did the signature.
"^DD",8980.2,8980.2,.03,"DT")
3011220
"^DD",8980.2,8980.2,.04,0)
DATA FILE^RP1'^DIC(^0;4^Q
"^DD",8980.2,8980.2,.04,3)

"^DD",8980.2,8980.2,.04,21,0)
^^2^2^3011220^
"^DD",8980.2,8980.2,.04,21,1,0)
This field is a pointer to the file of files. it is to tell us what file
"^DD",8980.2,8980.2,.04,21,2,0)
has the data that this signature contains.
"^DD",8980.2,8980.2,.04,"DT")
3011220
"^DD",8980.2,8980.2,.05,0)
FILEDATE^RD^^0;5^S %DT="E" D ^%DT S X=Y K:Y<1 X
"^DD",8980.2,8980.2,.05,5,1,0)
8980.2^.01^2
"^DD",8980.2,8980.2,.05,9)
^
"^DD",8980.2,8980.2,.05,21,0)
^^1^1^3011220^
"^DD",8980.2,8980.2,.05,21,1,0)
This field holds the Date that the Signature was added to this file.
"^DD",8980.2,8980.2,.05,"DT")
3011220
"^DD",8980.2,8980.2,1,0)
SIGNATURE^8980.21^^1;0
"^DD",8980.2,8980.21,0)
SIGNATURE SUB-FIELD^^.01^1
"^DD",8980.2,8980.21,0,"DT")
3011015
"^DD",8980.2,8980.21,0,"NM","SIGNATURE")

"^DD",8980.2,8980.21,0,"UP")
8980.2
"^DD",8980.2,8980.21,.01,0)
SIGNATURE^WL^^0;1^Q
"^DD",8980.2,8980.21,.01,"DT")
3011015
"^DD",8980.22,8980.22,0)
FIELD^^2^3
"^DD",8980.22,8980.22,0,"DDA")
N
"^DD",8980.22,8980.22,0,"DT")
3020130
"^DD",8980.22,8980.22,0,"IX","B",8980.22,.01)

"^DD",8980.22,8980.22,0,"NM","PKI CRL URLS")

"^DD",8980.22,8980.22,.01,0)
NAME^RF^^0;1^K:$L(X)>200!($L(X)<3)!'(X'?1P.E) X
"^DD",8980.22,8980.22,.01,.1)
URL
"^DD",8980.22,8980.22,.01,1,0)
^.1^^-1
"^DD",8980.22,8980.22,.01,1,1,0)
8980.22^B
"^DD",8980.22,8980.22,.01,1,1,1)
S ^XUSSPKI(8980.22,"B",$E(X,1,30),DA)=""
"^DD",8980.22,8980.22,.01,1,1,2)
K ^XUSSPKI(8980.22,"B",$E(X,1,30),DA)
"^DD",8980.22,8980.22,.01,3)
Answer must be 3-200 characters in length
"^DD",8980.22,8980.22,.01,21,0)
^^1^1^3020117^
"^DD",8980.22,8980.22,.01,21,1,0)
This field holds the URL for the CRL distribution point.
"^DD",8980.22,8980.22,.01,"DT")
3020130
"^DD",8980.22,8980.22,1,0)
SEEN BY CLIENT^D^^0;2^S %DT="ETXR" D ^%DT S X=Y K:X<1 X
"^DD",8980.22,8980.22,1,.1)
Seen By Client
"^DD",8980.22,8980.22,1,1,0)
^.1^^0
"^DD",8980.22,8980.22,1,3)
(No range limit on date)
"^DD",8980.22,8980.22,1,21,0)
^^2^2^3020130^
"^DD",8980.22,8980.22,1,21,1,0)
This field is updated every time the URL is sent down from the client.
"^DD",8980.22,8980.22,1,21,2,0)
It will be used to purge the file.
"^DD",8980.22,8980.22,1,"DT")
3020131
"^DD",8980.22,8980.22,2,0)
DT LAST SENT TO SERVER^D^^0;3^S %DT="ETXR" D ^%DT S X=Y K:Y<1 X
"^DD",8980.22,8980.22,2,21,0)
^^2^2^3020131^
"^DD",8980.22,8980.22,2,21,1,0)
This field records the time that this URL was sent to the CRL server.
"^DD",8980.22,8980.22,2,21,2,0)
It is used to keep the CRL up to date.
"^DD",8980.22,8980.22,2,"DT")
3020131
"^DD",8989.3,8989.3,53.1,0)
PKI Server^F^^IP1;1^K:$L(X)>46!($L(X)<7) X
"^DD",8989.3,8989.3,53.1,3)
Answer must be 7-46 characters in length
"^DD",8989.3,8989.3,53.1,21,0)
^^3^3^3011115^
"^DD",8989.3,8989.3,53.1,21,1,0)
This field holds one to three IP addresses for the PKI servers for this
"^DD",8989.3,8989.3,53.1,21,2,0)
site.  Each IP address is separated by comas.
"^DD",8989.3,8989.3,53.1,21,3,0)
Example: 10.6.21.12,PKI.fo-oakland.med.va.gov
"^DD",8989.3,8989.3,53.1,"DT")
3011115
"^DIC",8980.2,8980.2,0)
PKI Digital Signatures^8980.2
"^DIC",8980.2,8980.2,0,"GL")
^XUSSPKI(8980.2,
"^DIC",8980.2,"B","PKI Digital Signatures",8980.2)

"^DIC",8980.22,8980.22,0)
PKI CRL URLS^8980.22
"^DIC",8980.22,8980.22,0,"GL")
^XUSSPKI(8980.22,
"^DIC",8980.22,8980.22,"%",0)
^1.005^^
"^DIC",8980.22,8980.22,"%D",0)
^^5^5^3020131^
"^DIC",8980.22,8980.22,"%D",1,0)
This file holds the Universal Resource Locator's (URL) for the Certificate
"^DIC",8980.22,8980.22,"%D",2,0)
Revocation List's (CRL) from the Certificate Distribution Points (CDP) in
"^DIC",8980.22,8980.22,"%D",3,0)
the users Public Key Infrastructure (PKI) Certificate.
"^DIC",8980.22,8980.22,"%D",4,0)
These URL's are sent up to a Windows server to keep a database of
"^DIC",8980.22,8980.22,"%D",5,0)
Certificate Revocation's up to date.
"^DIC",8980.22,"B","PKI CRL URLS",8980.22)

**END**
**END**
