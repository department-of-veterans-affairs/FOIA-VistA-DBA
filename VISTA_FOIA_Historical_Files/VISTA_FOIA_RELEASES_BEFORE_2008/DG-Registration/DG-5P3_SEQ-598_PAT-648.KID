Released DG*5.3*648 SEQ #598
Extracted from mail message
**KIDS**:DG*5.3*648^

**INSTALL NAME**
DG*5.3*648
"BLD",2176,0)
DG*5.3*648^REGISTRATION^0^3051214^y
"BLD",2176,1,0)
^^3^3^3051214^
"BLD",2176,1,1,0)
NEW TRIGGER AND PID SEGMENT FIX
"BLD",2176,1,2,0)
Refer to patch DG*5.3*648 in the FORUM Patch Module for a complete
"BLD",2176,1,3,0)
description.
"BLD",2176,4,0)
^9.64PA^^
"BLD",2176,"ABNS",0)
^9.66A^^
"BLD",2176,"ABPKG")
n^n^
"BLD",2176,"INID")
^n
"BLD",2176,"INIT")
DG648PST
"BLD",2176,"KRN",0)
^9.67PA^8989.52^19
"BLD",2176,"KRN",.4,0)
.4
"BLD",2176,"KRN",.401,0)
.401
"BLD",2176,"KRN",.402,0)
.402
"BLD",2176,"KRN",.403,0)
.403
"BLD",2176,"KRN",.5,0)
.5
"BLD",2176,"KRN",.84,0)
.84
"BLD",2176,"KRN",3.6,0)
3.6
"BLD",2176,"KRN",3.8,0)
3.8
"BLD",2176,"KRN",9.2,0)
9.2
"BLD",2176,"KRN",9.8,0)
9.8
"BLD",2176,"KRN",9.8,"NM",0)
^9.68A^2^2
"BLD",2176,"KRN",9.8,"NM",1,0)
VAFCTR^^0^B1393250
"BLD",2176,"KRN",9.8,"NM",2,0)
VAFCQRY1^^0^B60711121
"BLD",2176,"KRN",9.8,"NM","B","VAFCQRY1",2)

"BLD",2176,"KRN",9.8,"NM","B","VAFCTR",1)

"BLD",2176,"KRN",19,0)
19
"BLD",2176,"KRN",19.1,0)
19.1
"BLD",2176,"KRN",101,0)
101
"BLD",2176,"KRN",409.61,0)
409.61
"BLD",2176,"KRN",771,0)
771
"BLD",2176,"KRN",870,0)
870
"BLD",2176,"KRN",8989.51,0)
8989.51
"BLD",2176,"KRN",8989.52,0)
8989.52
"BLD",2176,"KRN",8994,0)
8994
"BLD",2176,"KRN","B",.4,.4)

"BLD",2176,"KRN","B",.401,.401)

"BLD",2176,"KRN","B",.402,.402)

"BLD",2176,"KRN","B",.403,.403)

"BLD",2176,"KRN","B",.5,.5)

"BLD",2176,"KRN","B",.84,.84)

"BLD",2176,"KRN","B",3.6,3.6)

"BLD",2176,"KRN","B",3.8,3.8)

"BLD",2176,"KRN","B",9.2,9.2)

"BLD",2176,"KRN","B",9.8,9.8)

"BLD",2176,"KRN","B",19,19)

"BLD",2176,"KRN","B",19.1,19.1)

"BLD",2176,"KRN","B",101,101)

"BLD",2176,"KRN","B",409.61,409.61)

"BLD",2176,"KRN","B",771,771)

"BLD",2176,"KRN","B",870,870)

"BLD",2176,"KRN","B",8989.51,8989.51)

"BLD",2176,"KRN","B",8989.52,8989.52)

"BLD",2176,"KRN","B",8994,8994)

"BLD",2176,"QUES",0)
^9.62^^
"BLD",2176,"REQB",0)
^9.611^2^2
"BLD",2176,"REQB",1,0)
DG*5.3*575^1
"BLD",2176,"REQB",2,0)
DG*5.3*627^1
"BLD",2176,"REQB","B","DG*5.3*575",1)

"BLD",2176,"REQB","B","DG*5.3*627",2)

"INIT")
DG648PST
"MBREQ")
0
"PKG",5,-1)
1^1
"PKG",5,0)
REGISTRATION^DG^PATIENT REGISTRATION, ADMISSION, DISCHARGE, EMBOSSER 
"PKG",5,20,0)
^9.402P^^
"PKG",5,22,0)
^9.49I^1^1
"PKG",5,22,1,0)
5.3^2930813^2970721^12541
"PKG",5,22,1,"PAH",1,0)
648^3051214
"PKG",5,22,1,"PAH",1,1,0)
^^3^3^3051214
"PKG",5,22,1,"PAH",1,1,1,0)
NEW TRIGGER AND PID SEGMENT FIX
"PKG",5,22,1,"PAH",1,1,2,0)
Refer to patch DG*5.3*648 in the FORUM Patch Module for a complete
"PKG",5,22,1,"PAH",1,1,3,0)
description.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
3
"RTN","DG648PST")
0^^B50293043
"RTN","DG648PST",1,0)
DG648PST ;BIR/CMC-PATCH DG*5.3*648 POST INSTALLATION ROUTINE ;2/11/05
"RTN","DG648PST",2,0)
 ;;5.3;Registration;**648**;Aug 13, 1993
"RTN","DG648PST",3,0)
 ;
"RTN","DG648PST",4,0)
POST ;Post init
"RTN","DG648PST",5,0)
 N DGFLD,DGMFLD,DGOUT,DGFILE
"RTN","DG648PST",6,0)
 ;File cross references
"RTN","DG648PST",7,0)
 D XR(2,.525) ;POW STATUS INDICATED?
"RTN","DG648PST",8,0)
 ;;D XR(2.0361,.01) ;PATIENT ELIGIBILITIES MULTIPLE ELIGIBILITY FIELD -- MOVED TO DG*5.3*691
"RTN","DG648PST",9,0)
 D TEMPL
"RTN","DG648PST",10,0)
 ;fix missing leading zeros for ICN Checksums DD issue was corrected in MPIF*1.0*9
"RTN","DG648PST",11,0)
 D MES^XPDUTL("  >>> Checking ICN Checksums for missing leading zeros. Job being tasked off.")
"RTN","DG648PST",12,0)
 S ZTRTN="CHKSUM^DG648PST",ZTDESC="Correct missing leading zeros in ICN Checksum - DG*5.3*648"
"RTN","DG648PST",13,0)
 S ZTIO="",ZTDTH=$$FMADD^XLFDT($$NOW^XLFDT,0,0,1,0)
"RTN","DG648PST",14,0)
 I $D(DUZ) S ZTSAVE("DUZ")=DUZ
"RTN","DG648PST",15,0)
 D ^%ZTLOAD
"RTN","DG648PST",16,0)
 K ZTDESC,ZTDTH,ZTIO,ZTQUEUED,ZTREQ,ZTRTN,ZTSAVE,ZTSK,%
"RTN","DG648PST",17,0)
 Q
"RTN","DG648PST",18,0)
 ;
"RTN","DG648PST",19,0)
CHKSUM ;fix missing leading zeros for ICN Checksums
"RTN","DG648PST",20,0)
 K ^XTMP("DG648","MISSING CHECKSUM"),^XTMP("DG648","CHECKSUM UPDATE"),^XTMP("DG648","CHECKSUM UPDATE FAIL")
"RTN","DG648PST",21,0)
 N DFN,ICN,CHECK,DIE,DA,DR,X,Y,CNT,CNT2,CNT3,LEN
"RTN","DG648PST",22,0)
 S (CNT2,CNT3,CNT,ICN)=0
"RTN","DG648PST",23,0)
 F  S ICN=$O(^DPT("AICN",ICN)) Q:ICN=""  D
"RTN","DG648PST",24,0)
 .Q:$E(ICN,1,3)=$P($$SITE^VASITE,"^",3)
"RTN","DG648PST",25,0)
 .S DFN=$O(^DPT("AICN",ICN,""))
"RTN","DG648PST",26,0)
 .I ICN'=$P($G(^DPT(DFN,"MPI")),"^") Q
"RTN","DG648PST",27,0)
 .; ^ ONLY UPDATING PRIMARY ICN
"RTN","DG648PST",28,0)
 .S CHECK=$P($G(^DPT(DFN,"MPI")),"^",2)
"RTN","DG648PST",29,0)
 .I CHECK="" S CNT2=CNT2+1,^XTMP("DG648","MISSING CHECKSUM",CNT2)="DFN= "_DFN_"^"_"ICN= "_ICN Q
"RTN","DG648PST",30,0)
 .S LEN=$L(CHECK)
"RTN","DG648PST",31,0)
 .Q:LEN=6
"RTN","DG648PST",32,0)
 .I LEN<6 S CHECK=$E(1000000+CHECK,2,7) ;adding missing leading zeros
"RTN","DG648PST",33,0)
 .K X,Y,DIE,DA,DR
"RTN","DG648PST",34,0)
 .S DA=DFN
"RTN","DG648PST",35,0)
 .D LOCK(DA) ;LOCK DPT NODE "MPI"
"RTN","DG648PST",36,0)
 .S DIE="^DPT(",DR="991.02///^S X=CHECK" D ^DIE
"RTN","DG648PST",37,0)
 .L -^DPT(DA,"MPI")
"RTN","DG648PST",38,0)
 .I +$G(Y)=-1 S CNT3=CNT3+1,^XTMP("DG648","CHECKSUM UPDATE FAIL",CNT3)="DFN= "_DFN_"^ICN= "_ICN_"^CHECKSUM= "_CHECK Q
"RTN","DG648PST",39,0)
 .S CNT=CNT+1,^XTMP("DG648","CHECKSUM UPDATE",CNT)="DFN= "_DFN_"^ICN= "_ICN_"^CHECKSUM= "_CHECK
"RTN","DG648PST",40,0)
 S ^XTMP("DG648","CHECKSUM UPDATE",CNT+2)="TOTAL: "_CNT,^XTMP("DG648","MISSING CHECKSUM",CNT2+2)="TOTAL: "_CNT2
"RTN","DG648PST",41,0)
 S ^XTMP("DG648","CHECKSUM UPDATE FILE",CNT3+2)="TOTAL: "_CNT3
"RTN","DG648PST",42,0)
 I CNT>0 D
"RTN","DG648PST",43,0)
 .N DIFROM,XMSUB,XMTEXT,XMY
"RTN","DG648PST",44,0)
 .S XMSUB="Updated Checksums post-init DG648 from "_$P($$SITE^VASITE,"^",3),XMY(DUZ)=""
"RTN","DG648PST",45,0)
 .S XMTEXT="^XTMP(""DG648"",""CHECKSUM UPDATE"",",XMY("CHESNEY.CHRISTINE_M@FORUM.VA.GOV")=""
"RTN","DG648PST",46,0)
 .D ^XMD
"RTN","DG648PST",47,0)
 I CNT2>0 D
"RTN","DG648PST",48,0)
 .N DIFROM,XMSUB,XMTEXT,XMY
"RTN","DG648PST",49,0)
 .S XMSUB="Missing Checksums post-init DG648 from "_$P($$SITE^VASITE,"^",3),XMY(DUZ)=""
"RTN","DG648PST",50,0)
 .S XMTEXT="^XTMP(""DG648"",""MISSING CHECKSUM"",",XMY("CHESNEY.CHRISTINE_M@FORUM.VA.GOV")=""
"RTN","DG648PST",51,0)
 .D ^XMD
"RTN","DG648PST",52,0)
 I CNT3>0 D
"RTN","DG648PST",53,0)
 .N DIFROM,XMSUB,XMTEXT,XMY
"RTN","DG648PST",54,0)
 .S XMSUB="Checksum updates failed in post-init DG648 from "_$P($$SITE^VASITE,"^",3),XMY(DUZ)=""
"RTN","DG648PST",55,0)
 .S XMTEXT="^XTMP(""DG648"",""CHECKSUM UPDATE FAIL"",",XMY("CHESNEY.CHRISTINE_M@FORUM.VA.GOV")=""
"RTN","DG648PST",56,0)
 .D ^XMD
"RTN","DG648PST",57,0)
 I CNT=0,CNT2=0,CNT3=0 D
"RTN","DG648PST",58,0)
 .N DIFROM,XMSUB,XMTEXT,XMY,ARR
"RTN","DG648PST",59,0)
 .S ARR(1)="No issues with Checksums at this site"
"RTN","DG648PST",60,0)
 .S XMSUB="Checksum updates failed in post-init DG648 from "_$P($$SITE^VASITE,"^",3),XMY(DUZ)=""
"RTN","DG648PST",61,0)
 .S XMTEXT="ARR(",XMY("CHESNEY.CHRISTINE_M@FORUM.VA.GOV")=""
"RTN","DG648PST",62,0)
 .D ^XMD
"RTN","DG648PST",63,0)
 K ^XTMP("DG648","MISSING CHECKSUM"),^XTMP("DG648","CHECKSUM UPDATE"),^XTMP("DG648","CHECKSUM UPDATE FAIL")
"RTN","DG648PST",64,0)
 Q
"RTN","DG648PST",65,0)
 ;
"RTN","DG648PST",66,0)
LOCK(IEN) ;
"RTN","DG648PST",67,0)
 F  L +^DPT(IEN,"MPI"):10 Q:$T
"RTN","DG648PST",68,0)
 Q
"RTN","DG648PST",69,0)
XR(DGFILE,DGFLD) ;File index type cross references
"RTN","DG648PST",70,0)
 ;
"RTN","DG648PST",71,0)
 N DGFDA,DGIEN,DGWP,DGERR,DGXR,DGVAL,DGOUT,DIERR
"RTN","DG648PST",72,0)
 ;Set up x-refs. Any value that has a ".", will have the period
"RTN","DG648PST",73,0)
 ;replaved with a "D" to prevent x-ref's such as .11 and 11 having
"RTN","DG648PST",74,0)
 ;identical xref names
"RTN","DG648PST",75,0)
 ;I DGFILE=2.0361 S DGXR="AVAFC20361" ;ELIGIBILITY -- MOVED TO DG*5.3*691
"RTN","DG648PST",76,0)
 I '$D(DGXR) S DGXR=$S(DGFLD[".":"AVAFC"_$P(DGFLD,".",2),1:"AVAFC"_DGFLD)
"RTN","DG648PST",77,0)
 ;Check for existing x-ref
"RTN","DG648PST",78,0)
 S DGVAL(1)=DGFILE,DGVAL(2)=DGXR
"RTN","DG648PST",79,0)
 D FIND^DIC(.11,"","@;IXIE","KP",.DGVAL,"","","","","DGOUT")
"RTN","DG648PST",80,0)
 I $D(DGOUT("DILIST",1)) D  Q
"RTN","DG648PST",81,0)
 .D MES^XPDUTL("     >>> Cross reference "_DGXR_" already exists, nothing filed.")
"RTN","DG648PST",82,0)
 .Q
"RTN","DG648PST",83,0)
 ;Create filer array
"RTN","DG648PST",84,0)
 S DGFDA(.11,"+1,",.01)=DGFILE                      ;FILE
"RTN","DG648PST",85,0)
 S DGFDA(.11,"+1,",.02)=DGXR                        ;NAME
"RTN","DG648PST",86,0)
 S DGFDA(.11,"+1,",.11)="This x-ref calls the DG FIELD MONITOR event point."     ;SHORT DESCRIPTION
"RTN","DG648PST",87,0)
 S DGFDA(.11,"+1,",.2)="MU"                         ;TYPE
"RTN","DG648PST",88,0)
 S DGFDA(.11,"+1,",.4)="F"                          ;EXECUTION
"RTN","DG648PST",89,0)
 S DGFDA(.11,"+1,",.41)="I"                         ;ACTIVITY
"RTN","DG648PST",90,0)
 S DGFDA(.11,"+1,",.5)="I"                          ;ROOT TYPE
"RTN","DG648PST",91,0)
 S DGFDA(.11,"+1,",.51)=DGFILE                      ;ROOT FILE
"RTN","DG648PST",92,0)
 S DGFDA(.11,"+1,",.42)="A"                         ;USE
"RTN","DG648PST",93,0)
 S DGFDA(.11,"+1,",1.1)="D FC^DGFCPROT(.DA,"_DGFILE_","_DGFLD_",""SET"",$H,$G(DUZ),.X,.X1,.X2,$G(XQY0)) Q"     ;SET LOGIC
"RTN","DG648PST",94,0)
 S DGFDA(.11,"+1,",2.1)="D FC^DGFCPROT(.DA,"_DGFILE_","_DGFLD_",""KILL"",$H,$G(DUZ),.X,.X1,.X2,$G(XQY0)) Q"     ;KILL LOGIC
"RTN","DG648PST",95,0)
 ;CROSS REFERENCE VALUES
"RTN","DG648PST",96,0)
 S DGFDA(.114,"+2,+1,",.01)=1                       ;ORDER NUMBER
"RTN","DG648PST",97,0)
 S DGFDA(.114,"+2,+1,",1)="F"                       ;TYPE OF VALUE
"RTN","DG648PST",98,0)
 S DGFDA(.114,"+2,+1,",2)=DGFILE                    ;FILE NUMBER
"RTN","DG648PST",99,0)
 S DGFDA(.114,"+2,+1,",3)=DGFLD                     ;FIELD NUMBER
"RTN","DG648PST",100,0)
 S DGFDA(.114,"+2,+1,",7)="F"                       ;COLLATION
"RTN","DG648PST",101,0)
 ;DESCRIPTION
"RTN","DG648PST",102,0)
 S DGWP(1)="This cross reference activates the DG FIELD MONITOR event point."
"RTN","DG648PST",103,0)
 S DGWP(2)="Applications that wish to monitor edit activity related to this field may"
"RTN","DG648PST",104,0)
 S DGWP(3)="subscribe to that event point and take action as indicated by the changes"
"RTN","DG648PST",105,0)
 S DGWP(4)="that occur.  Refer to the DG FIELD MONITOR protocol for a description of"
"RTN","DG648PST",106,0)
 S DGWP(5)="the information available at the time of the event."
"RTN","DG648PST",107,0)
 ;File INDEX record
"RTN","DG648PST",108,0)
 D UPDATE^DIE("","DGFDA","DGIEN","DGERR")
"RTN","DG648PST",109,0)
 I $D(DIERR) D  Q
"RTN","DG648PST",110,0)
 .N DGI S DGI=""
"RTN","DG648PST",111,0)
 .D MES^XPDUTL("     >>> A problem has occurred during the filing of x-ref. "_DGXR_"!")
"RTN","DG648PST",112,0)
 .D MES^XPDUTL("         Please contact Customer Support.")
"RTN","DG648PST",113,0)
 .F  S DGI=$O(DGERR("DIERR",1,"TEXT",DGI)) Q:DGI=""  D
"RTN","DG648PST",114,0)
 ..D MES^XPDUTL(DGERR("DIERR",1,"TEXT",DGI))
"RTN","DG648PST",115,0)
 ..Q
"RTN","DG648PST",116,0)
 .Q
"RTN","DG648PST",117,0)
 S DGFLD(DGFILE,DGFLD)=""  ;Create list to recompile templates
"RTN","DG648PST",118,0)
 D MES^XPDUTL("     >>> "_DGXR_" cross reference filed.")
"RTN","DG648PST",119,0)
 ;File DESCRIPTION field
"RTN","DG648PST",120,0)
 D WP^DIE(.11,DGIEN(1)_",",.1,"","DGWP")
"RTN","DG648PST",121,0)
 Q
"RTN","DG648PST",122,0)
TEMPL N GLOBAL,FIELD,NFIELD,FILE,CNT
"RTN","DG648PST",123,0)
 D BMES^XPDUTL("Beginning to compile templates on the PATIENT (#2) file.")
"RTN","DG648PST",124,0)
 ;
"RTN","DG648PST",125,0)
 S NFIELD=".525",FILE=2,FIELD="",CNT=1
"RTN","DG648PST",126,0)
 F  S FIELD=$P(NFIELD,",",CNT) Q:FIELD=""  D LOOP(FIELD,FILE) S CNT=CNT+1
"RTN","DG648PST",127,0)
 ;S NFIELD=.01,FILE=2.0361 D LOOP(NFIELD,FILE) -- MOVED TO DG*5.3*691
"RTN","DG648PST",128,0)
 W !!
"RTN","DG648PST",129,0)
 S (X,Y)=""
"RTN","DG648PST",130,0)
 D BMES^XPDUTL("The following routine namespace was compiled:")
"RTN","DG648PST",131,0)
 F  S X=$O(CFIELD(X)) Q:X=""  S Y=$G(Y)+1 S PRINT(Y)=" "_X_"*"
"RTN","DG648PST",132,0)
 ;
"RTN","DG648PST",133,0)
 D MES^XPDUTL(.PRINT)
"RTN","DG648PST",134,0)
 K X,Y,PRINT,CFIELD
"RTN","DG648PST",135,0)
 Q
"RTN","DG648PST",136,0)
 ;
"RTN","DG648PST",137,0)
LOOP(FIELD,FILE) ;
"RTN","DG648PST",138,0)
 N GLOBAL,TEMPLATP,TEMPLATN,X,Y,DMAX
"RTN","DG648PST",139,0)
 F GLOBAL="^DIE","^DIPT" DO
"RTN","DG648PST",140,0)
 .I $D(@GLOBAL@("AF",FILE,FIELD)) D
"RTN","DG648PST",141,0)
 ..S TEMPLATP=0
"RTN","DG648PST",142,0)
 ..F  S TEMPLATP=$O(@GLOBAL@("AF",FILE,FIELD,TEMPLATP)) Q:'TEMPLATP  DO
"RTN","DG648PST",143,0)
 ...S TEMPLATN=$P($G(@GLOBAL@(TEMPLATP,0)),"^",1)
"RTN","DG648PST",144,0)
 ...I TEMPLATN="" D BMES^XPDUTL("Could not compile template "_TEMPLATN_$C(13,10)_"Please review!") Q
"RTN","DG648PST",145,0)
 ...S X=$P($G(@GLOBAL@(TEMPLATP,"ROUOLD")),"^")
"RTN","DG648PST",146,0)
 ...I X=""&($D(@GLOBAL@(TEMPLATP,"ROU"))'=0) D BMES^XPDUTL("Could not find routine for template "_TEMPLATN_$C(13,10)_"Please review!") Q
"RTN","DG648PST",147,0)
 ...I X=""&($D(@GLOBAL@(TEMPLATP,"ROU"))=0) Q
"RTN","DG648PST",148,0)
 ...I $D(CFIELD(X)) Q  ;already compiled
"RTN","DG648PST",149,0)
 ...S CFIELD(X)="" ;                remember the template was compiled
"RTN","DG648PST",150,0)
 ...S Y=TEMPLATP ;                 set up the call for fman
"RTN","DG648PST",151,0)
 ...S DMAX=$$ROUSIZE^DILF
"RTN","DG648PST",152,0)
 ...I GLOBAL="^DIE" D BMES^XPDUTL(" "),BMES^XPDUTL("   Compiling Input Templates") D EN^DIEZ Q
"RTN","DG648PST",153,0)
 ...I GLOBAL="^DIPT" D BMES^XPDUTL(" "),BMES^XPDUTL("   Compiling Print Templates") D EN^DIPZ Q
"RTN","DG648PST",154,0)
 Q
"RTN","VAFCQRY1")
0^2^B60711121
"RTN","VAFCQRY1",1,0)
VAFCQRY1 ;BIR/DLR-Query for patient demographics ;10/30/02  13:58
"RTN","VAFCQRY1",2,0)
 ;;5.3;Registration;**428,474,477,575,627,648**;Aug 13, 1993
"RTN","VAFCQRY1",3,0)
 ;
"RTN","VAFCQRY1",4,0)
 ;Reference to $$GETDFNS^MPIF002 supported by IA #3634.
"RTN","VAFCQRY1",5,0)
 ;
"RTN","VAFCQRY1",6,0)
BLDPID(DFN,CNT,SEQ,PID,HL,ERR)  ;build PID from File #2
"RTN","VAFCQRY1",7,0)
 ; Variable list
"RTN","VAFCQRY1",8,0)
 ;  DFN - internal PATIENT (#2) number
"RTN","VAFCQRY1",9,0)
 ;  CNT - value to be place in PID seq#1 (SET ID)
"RTN","VAFCQRY1",10,0)
 ;  SEQ - variable consisting of sequence numbers delimited by commas
"RTN","VAFCQRY1",11,0)
 ;        that will be used to build the message (default is ALL)
"RTN","VAFCQRY1",12,0)
 ;  PID (passed by reference) - array location to place PID segment
"RTN","VAFCQRY1",13,0)
 ;        result, the array can have existing values when passed.
"RTN","VAFCQRY1",14,0)
 ;   HL - array that contains the necessary HL variables (init^hlsub)
"RTN","VAFCQRY1",15,0)
 ;  ERR - array that is used to return an error
"RTN","VAFCQRY1",16,0)
 ;
"RTN","VAFCQRY1",17,0)
 N VAFCMN,VAFCMMN,SITE,VAFCZN,SSN,SITE,APID,HIST,HISTDT,VAFCHMN,NXT,NXTC,COMP,REP,SUBCOMP,STATE,CITY,CLAIM,HLECH,HLFS,HLQ,STATEIEN,SARY,LVL,LNGTH,X
"RTN","VAFCQRY1",18,0)
 I '$D(SEQ) S SEQ="ALL"
"RTN","VAFCQRY1",19,0)
 I SEQ="" S SEQ="ALL"
"RTN","VAFCQRY1",20,0)
 I SEQ'="ALL" D
"RTN","VAFCQRY1",21,0)
 .; setting up temp array to hold fields to be included in message
"RTN","VAFCQRY1",22,0)
 .N POS,EN S POS=1 F  S EN=$P(SEQ,",",POS) Q:EN=""  S SARY(EN)="",POS=POS+1
"RTN","VAFCQRY1",23,0)
 S HLECH=HL("ECH"),HLFS=HL("FS"),HLQ=HL("Q"),COMP=$E(HL("ECH"),1)
"RTN","VAFCQRY1",24,0)
 S SUBCOMP=$E(HL("ECH"),4),REP=$E(HL("ECH"),2),VABSLSH=$E(HL("ECH"),3)
"RTN","VAFCQRY1",25,0)
 ;get Patient File MPI node
"RTN","VAFCQRY1",26,0)
 S VAFCMN=$$MPINODE^MPIFAPI(DFN)
"RTN","VAFCQRY1",27,0)
 I +VAFCMN<0 S VAFCMN=""
"RTN","VAFCQRY1",28,0)
 S VAFCZN=^DPT(DFN,0),SSN=$P(^DPT(DFN,0),"^",9)
"RTN","VAFCQRY1",29,0)
 S SITE=$$SITE^VASITE
"RTN","VAFCQRY1",30,0)
 N TMP F TMP=1:1:31 S APID(TMP)=""
"RTN","VAFCQRY1",31,0)
 S APID(2)=CNT
"RTN","VAFCQRY1",32,0)
 ;repeat patient ID list including ICN (NI),SSN (SS),CLAIM# (PN) AND DFN (PI)
"RTN","VAFCQRY1",33,0)
 I $D(SARY(3))!(SEQ="ALL") D
"RTN","VAFCQRY1",34,0)
 .S APID(4)=""
"RTN","VAFCQRY1",35,0)
 .;National Identifier (ICN)
"RTN","VAFCQRY1",36,0)
 .I VAFCMN'="" I +VAFCMN>0 S APID(4)=$P(VAFCMN,"^")_"V"_$P(VAFCMN,"^",2)_COMP_COMP_COMP_"USVHA"_SUBCOMP_SUBCOMP_"0363"_COMP_"NI"_COMP_"VA FACILITY ID"_SUBCOMP_$$STA^XUAF4(+SITE)_SUBCOMP_"L" D
"RTN","VAFCQRY1",37,0)
 ..;Assumption that if this is a local ICN at this point send the message with an expiration date of today, so that it will be treated as a deprecated ID and stored on the MPI as such
"RTN","VAFCQRY1",38,0)
 ..I $E($P(VAFCMN,"^"),1,3)=$P($$SITE^VASITE,"^",3) S APID(4)=APID(4)_COMP_COMP_$$HLDATE^HLFNC(DT)
"RTN","VAFCQRY1",39,0)
 .I $G(SSN)'="" S APID(4)=APID(4)_$S(APID(4)'="":REP,1:"")_SSN_COMP_COMP_COMP_"USSSA"_SUBCOMP_SUBCOMP_"0363"_COMP_"SS"_COMP_"VA FACILITY ID"_SUBCOMP_$$STA^XUAF4(+SITE)_SUBCOMP_"L"
"RTN","VAFCQRY1",40,0)
 .I $G(DFN)'="" S APID(4)=APID(4)_$S(APID(4)'="":REP,1:"")_DFN_COMP_COMP_COMP_"USVHA"_SUBCOMP_SUBCOMP_"0363"_COMP_"PI"_COMP_"VA FACILITY ID"_SUBCOMP_$$STA^XUAF4(+SITE)_SUBCOMP_"L" D
"RTN","VAFCQRY1",41,0)
 ..;CLAIM#
"RTN","VAFCQRY1",42,0)
 ..I $D(^DPT(DFN,.31)) S CLAIM=$P(^DPT(DFN,.31),"^",3) I +CLAIM>0 S APID(4)=APID(4)_REP_CLAIM_COMP_COMP_COMP_"USVBA"_SUBCOMP_SUBCOMP_"0363"_COMP_"PN"_COMP_"VA FACILITY ID"_SUBCOMP_$$STA^XUAF4(+SITE)_SUBCOMP_"L"
"RTN","VAFCQRY1",43,0)
 .I $D(^DPT(DFN,"MPIFHIS")) N HIST S NXTC=0,LVL=0,HIST=0  F  S HIST=$O(^DPT(DFN,"MPIFHIS",HIST)) Q:'HIST  S VAFCHMN=^DPT(DFN,"MPIFHIS",HIST,0) S HISTDT=$P(VAFCHMN,"^",4) D
"RTN","VAFCQRY1",44,0)
 ..;**477 due to a timing issue if checksum and D/T of deprication of ICN is not present hang two seconds and try again if still not able to get ICN set D/T to DT
"RTN","VAFCQRY1",45,0)
 ..I $G(HISTDT)="" H 2 S VAFCHMN=^DPT(DFN,"MPIFHIS",HIST,0) S HISTDT=$P(VAFCHMN,"^",4) I HISTDT="" S HISTDT=DT
"RTN","VAFCQRY1",46,0)
 ..I APID(4)'="" D
"RTN","VAFCQRY1",47,0)
 ...S NXT=$P(VAFCHMN,"^")_"V"_$P(VAFCHMN,"^",2)_COMP_COMP_COMP_"USVHA"_SUBCOMP_SUBCOMP_"0363"_COMP_"NI"_COMP_"VA FACILITY ID"_SUBCOMP_$$STA^XUAF4(+SITE)_SUBCOMP_"L"_COMP_COMP_$$HLDATE^HLFNC(HISTDT,"DT") ;**648 only send date not time
"RTN","VAFCQRY1",48,0)
 ...I LVL=0 D
"RTN","VAFCQRY1",49,0)
 ....I $L(APID(4)_NXT)'>244 S APID(4)=APID(4)_REP_NXT Q
"RTN","VAFCQRY1",50,0)
 ....I $L(APID(4)_NXT)>244 S LVL=1 S LNGTH=244-$L(APID(4)),APID(4)=APID(4)_REP_$E(NXT,1,LNGTH) S LNGTH=LNGTH+1,NXT=$E(NXT,LNGTH,$L(NXT)),NXTC=1
"RTN","VAFCQRY1",51,0)
 ...I LVL>0 D
"RTN","VAFCQRY1",52,0)
 ....I $L($G(APID(4,LVL))_NXT)'>245 S APID(4,LVL)=$G(APID(4,LVL))_$S(NXTC=0:REP,1:"")_NXT Q
"RTN","VAFCQRY1",53,0)
 ....I $L($G(APID(4,LVL))_NXT)>245 S LNGTH=244-$L(APID(4,LVL)),APID(4,LVL)=APID(4,LVL)_REP_$E(NXT,1,LNGTH) S LNGTH=LNGTH+1,NXT=$E(NXT,LNGTH,$L(NXT)) S LVL=LVL+1 S APID(4,LVL)=NXT
"RTN","VAFCQRY1",54,0)
 ..I NXTC=1 S NXTC=0
"RTN","VAFCQRY1",55,0)
 ..I APID(4)="" S APID(4)=$P(VAFCHMN,"^")_COMP_COMP_COMP_"USVHA"_SUBCOMP_SUBCOMP_"0363"_COMP_"NI"_COMP_"VA FACILITY ID"_SUBCOMP_$$STA^XUAF4(+SITE)_SUBCOMP_"L"_COMP_COMP_$$HLDATE^HLFNC(HISTDT)
"RTN","VAFCQRY1",56,0)
NAMEPID ;patient name (last^first^middle^suffix^prefix^^"L" for legal)
"RTN","VAFCQRY1",57,0)
 I $D(SARY(5))!(SEQ="ALL") D
"RTN","VAFCQRY1",58,0)
 .S APID(6)=$$HLNAME^XLFNAME($P(VAFCZN,"^"),"",$E(HL("ECH"),1)),$P(APID(6),$E(HL("ECH"),1),7)="L"_REP
"RTN","VAFCQRY1",59,0)
 .;patient alias (last^first^middle^suffice^prefix^^"A" for alias - can be multiple)
"RTN","VAFCQRY1",60,0)
 .N ALIAS,ALIEN,VAFCA,LVL6 D GETS^DIQ(2,DFN_",","1*","E","VAFCA")
"RTN","VAFCQRY1",61,0)
 .S LVL6=0
"RTN","VAFCQRY1",62,0)
 .I $O(VAFCA(2.01,0))'="" S ALIEN=0 F  S ALIEN=$O(VAFCA(2.01,ALIEN)) Q:'ALIEN  D
"RTN","VAFCQRY1",63,0)
 ..S ALIAS=$G(VAFCA(2.01,ALIEN,.01,"E"))
"RTN","VAFCQRY1",64,0)
 ..S ALIAS=$$HLNAME^XLFNAME(ALIAS,"",$E(HL("ECH"),1))
"RTN","VAFCQRY1",65,0)
 ..Q:ALIAS=""
"RTN","VAFCQRY1",66,0)
 ..S $P(ALIAS,$E(HL("ECH"),1),7)="A"
"RTN","VAFCQRY1",67,0)
 .. I LVL6=0 D
"RTN","VAFCQRY1",68,0)
 ... I $L(APID(6)_ALIAS)'>244 S APID(6)=APID(6)_ALIAS_REP Q
"RTN","VAFCQRY1",69,0)
MOTHER ... I $L(APID(6)_ALIAS)>244 S LVL6=1
"RTN","VAFCQRY1",70,0)
 .. I LVL6>0 D
"RTN","VAFCQRY1",71,0)
 ... I $L($G(APID(6,LVL6))_ALIAS)'>245 S APID(6,LVL6)=$G(APID(6,LVL6))_ALIAS_REP Q
"RTN","VAFCQRY1",72,0)
 ... I $L($G(APID(6,LVL6))_ALIAS)>245 S LVL6=LVL6+1,APID(6,LVL6)=ALIAS_REP
"RTN","VAFCQRY1",73,0)
 . I APID(6)="" S APID(6)=HL("Q")
"RTN","VAFCQRY1",74,0)
 ;mother's maiden name  (last^first^middle^suffix^prefix^^"M" for maiden name)
"RTN","VAFCQRY1",75,0)
 I $D(SARY(6))!(SEQ="ALL") D
"RTN","VAFCQRY1",76,0)
 .S APID(7)=HL("Q")
"RTN","VAFCQRY1",77,0)
 .I $D(^DPT(DFN,.24)) S VAFCMMN=$P(^DPT(DFN,.24),"^",3) D
"RTN","VAFCQRY1",78,0)
 ..S APID(7)=$$HLNAME^XLFNAME(VAFCMMN,"",$E(HL("ECH"),1)) I APID(7)="" S APID(7)=HL("Q")
"RTN","VAFCQRY1",79,0)
 ..I $P(APID(7),$E(HL("ECH"),1),7)'="M" S $P(APID(7),$E(HL("ECH"),1),7)="M"
"RTN","VAFCQRY1",80,0)
 .I APID(7)="" S APID(7)=HL("Q")
"RTN","VAFCQRY1",81,0)
 I $D(SARY(7))!(SEQ="ALL") S APID(8)=$$HLDATE^HLFNC($P(VAFCZN,"^",3)) I APID(8)="" S APID(8)=HL("Q") ;date/time of birth
"RTN","VAFCQRY1",82,0)
 I $D(SARY(8))!(SEQ="ALL") S APID(9)=$P(VAFCZN,"^",2) I APID(9)="" S APID(9)=HL("Q") ;sex
"RTN","VAFCQRY1",83,0)
 ;place of birth city and state
"RTN","VAFCQRY1",84,0)
ADDR ;
"RTN","VAFCQRY1",85,0)
 I $D(SARY(11))!(SEQ="ALL") S APID(12)="" D
"RTN","VAFCQRY1",86,0)
 .I $D(^DPT(DFN,0)) D
"RTN","VAFCQRY1",87,0)
 ..;address info
"RTN","VAFCQRY1",88,0)
 ..S HL7STRG=$$GET1^DIQ(2,DFN_",",.111) I $G(VADEFSW)="HL7" D HL7TXT
"RTN","VAFCQRY1",89,0)
 ..S $P(APID(12),COMP)=HL7STRG I $P(APID(12),COMP)="" S $P(APID(12),COMP)=HL("Q")
"RTN","VAFCQRY1",90,0)
 ..N LINE2 S LINE2=$$GET1^DIQ(2,DFN_",",.112) N LINE3 S LINE3=$$GET1^DIQ(2,DFN_",",.113)
"RTN","VAFCQRY1",91,0)
 ..S $P(APID(12),COMP,2)=LINE2 I $P(APID(12),COMP,2)="" S $P(APID(12),COMP,2)=HL("Q")
"RTN","VAFCQRY1",92,0)
 ..S $P(APID(12),COMP,8)=LINE3 I $P(APID(12),COMP,8)="" S $P(APID(12),COMP,8)=HL("Q")
"RTN","VAFCQRY1",93,0)
 ..S $P(APID(12),COMP,3)=$$GET1^DIQ(2,DFN_",",.114) I $P(APID(12),COMP,3)="" S $P(APID(12),COMP,3)=HL("Q")
"RTN","VAFCQRY1",94,0)
 ..S STATEIEN=$$GET1^DIQ(2,DFN_",",.115,"I") S STATE=$$GET1^DIQ(5,+STATEIEN_",",1) S $P(APID(12),COMP,4)=$G(STATE) I $P(APID(12),COMP,4)="" S $P(APID(12),COMP,4)=HL("Q")
"RTN","VAFCQRY1",95,0)
 ..S $P(APID(12),COMP,5)=$$GET1^DIQ(2,DFN_",",.1112) I $P(APID(12),COMP,5)="" S $P(APID(12),COMP,5)=HL("Q")
"RTN","VAFCQRY1",96,0)
 ..S $P(APID(12),COMP,7)="P"
"RTN","VAFCQRY1",97,0)
 ..; **648 add COUNTY Code to PID-11, retained in PID-12 also
"RTN","VAFCQRY1",98,0)
 ..N COUNTY S COUNTY=$$GET1^DIQ(2,DFN_",",.117) I COUNTY="" S COUNTY=HL("Q")
"RTN","VAFCQRY1",99,0)
 ..S $P(APID(12),COMP,9)=COUNTY ;county code
"RTN","VAFCQRY1",100,0)
 ..;place of birth information
"RTN","VAFCQRY1",101,0)
 ..S CITY=$$GET1^DIQ(2,DFN_",",.092) D
"RTN","VAFCQRY1",102,0)
 ...I $G(CITY)'="" S $P(X,COMP,3)=CITY
"RTN","VAFCQRY1",103,0)
 ...I $G(CITY)="" S $P(X,COMP,3)=HL("Q")
"RTN","VAFCQRY1",104,0)
 ...S STATEIEN=$$GET1^DIQ(2,DFN_",",.093,"I") S STATE=$$GET1^DIQ(5,+STATEIEN_",",1) D
"RTN","VAFCQRY1",105,0)
 ....I $G(STATE)'="" S $P(X,COMP,4)=STATE
"RTN","VAFCQRY1",106,0)
 ....I $G(STATE)="" S $P(X,COMP,4)=HL("Q")
"RTN","VAFCQRY1",107,0)
 ... S $P(X,COMP,7)="N",APID(12)=$G(APID(12))_REP_X
"RTN","VAFCQRY1",108,0)
 I $D(SARY(12))!(SEQ="ALL") S APID(13)=$$GET1^DIQ(2,DFN_",",.117) I APID(13)="" S APID(13)=HL("Q")  ;county code **648 backwards compatibility only
"RTN","VAFCQRY1",109,0)
 I $D(SARY(13))!($D(SARY(14)))!(SEQ="ALL") N PHONEN,HNUM,WNUM S PHONEN=$G(^DPT(DFN,.13)) S HNUM=$P(PHONEN,"^",1),WNUM=$P(PHONEN,"^",2)
"RTN","VAFCQRY1",110,0)
 I $D(SARY(13))!(SEQ="ALL") S APID(14)=$$HLPHONE^HLFNC(HNUM) I APID(14)="" S APID(14)=HL("Q")
"RTN","VAFCQRY1",111,0)
 I $D(SARY(14))!(SEQ="ALL") S APID(15)=$$HLPHONE^HLFNC(WNUM) I APID(15)="" S APID(15)=HL("Q")
"RTN","VAFCQRY1",112,0)
 I $D(SARY(19))!(SEQ="ALL") S APID(20)=SSN  ;ssn passed in PID-3
"RTN","VAFCQRY1",113,0)
 I $D(SARY(23))!(SEQ="ALL") D
"RTN","VAFCQRY1",114,0)
 .S CITY=$$GET1^DIQ(2,DFN_",",.092)
"RTN","VAFCQRY1",115,0)
 .S STATEIEN=$$GET1^DIQ(2,DFN_",",.093,"I") S STATE=$$GET1^DIQ(5,+STATEIEN_",",1) D
"RTN","VAFCQRY1",116,0)
 .I CITY'=""&(STATE'="") S APID(24)=CITY_" "_STATE  ;place of birth (not used) use PID-11 with an 'N' instead
"RTN","VAFCQRY1",117,0)
 .I CITY=""&(STATE="") S APID(24)=HL("Q")
"RTN","VAFCQRY1",118,0)
 ;list of fields used for backwards compatibility with HDR
"RTN","VAFCQRY1",119,0)
 I $D(SARY(2))!(SEQ="ALL") S APID(3)=$P(VAFCMN,"^")_"V"_$P(VAFCMN,"^",2)  ;Patient ID
"RTN","VAFCQRY1",120,0)
 D CONT^VAFCQRY3(DFN,.APID,.PID,.HL,.SARY,SEQ,.ERR,REP,COMP)
"RTN","VAFCQRY1",121,0)
 D KVA^VADPT
"RTN","VAFCQRY1",122,0)
 Q
"RTN","VAFCQRY1",123,0)
HL7TXT ; Replace occurrences of embedded HL7 delimiters with
"RTN","VAFCQRY1",124,0)
 ; HL7 escape sequence
"RTN","VAFCQRY1",125,0)
 ;
"RTN","VAFCQRY1",126,0)
 ; Inputs: HL7STRG - Data string to be checked
"RTN","VAFCQRY1",127,0)
 ;         HL("ECH") - HL7 delimiter string
"RTN","VAFCQRY1",128,0)
 ;             Delimiters MUST be in the following order,
"RTN","VAFCQRY1",129,0)
 ;               Escape, Field, Component, Repeat, Subcomponent
"RTN","VAFCQRY1",130,0)
 ;               Example: \^~|&
"RTN","VAFCQRY1",131,0)
 ;
"RTN","VAFCQRY1",132,0)
 ; Output: HL7XTRG - Data string with escape sequence added (if needed)
"RTN","VAFCQRY1",133,0)
 ;
"RTN","VAFCQRY1",134,0)
 N OCHR,RCHR,RCHRI,TYPE,I,HLES
"RTN","VAFCQRY1",135,0)
 ;
"RTN","VAFCQRY1",136,0)
 ; Set HL7 escape char
"RTN","VAFCQRY1",137,0)
 S HLES2=VABSLSH_HLFS_COMP_REP_SUBCOMP
"RTN","VAFCQRY1",138,0)
 S HLES=VABSLSH
"RTN","VAFCQRY1",139,0)
 ;
"RTN","VAFCQRY1",140,0)
 ; Search for occurrence of each delimiter and replace it with "\<type>\"
"RTN","VAFCQRY1",141,0)
 F TYPE="E","F","C","R","S" D
"RTN","VAFCQRY1",142,0)
 . S RCHRI=$S(TYPE="E":1,TYPE="F":2,TYPE="C":3,TYPE="R":4,TYPE="S":5)
"RTN","VAFCQRY1",143,0)
 . ;
"RTN","VAFCQRY1",144,0)
 . ; OCHR=original char, RCHR=replacement char
"RTN","VAFCQRY1",145,0)
 . S OCHR=$E(HLES2,RCHRI),RCHR=$E("EFSRT",RCHRI) Q:'$F(HL7STRG,OCHR)
"RTN","VAFCQRY1",146,0)
 . F I=1:1 Q:$E(HL7STRG,I)=""  I $E(HL7STRG,I)=OCHR S HL7STRG=$E(HL7STRG,1,I-1)_HLES_RCHR_HLES_$E(HL7STRG,I+1,999),I=I+2
"RTN","VAFCQRY1",147,0)
 Q 
"RTN","VAFCTR")
0^1^B1393250
"RTN","VAFCTR",1,0)
VAFCTR ;BIR/CMC-Monitoring fields for MPI/PD via DG field monitoring ;9/25/2003
"RTN","VAFCTR",2,0)
 ;;5.3;Registration;**575,648**;Aug 13, 1993
"RTN","VAFCTR",3,0)
 Q  ; quit if called from the top
"RTN","VAFCTR",4,0)
 ;
"RTN","VAFCTR",5,0)
MPIPD ; protocol entry point for monitoring fields via DG field monitoring
"RTN","VAFCTR",6,0)
 ; Currently monitoring for fields:
"RTN","VAFCTR",7,0)
 ; 1 ALIAS - .01 of the multiple
"RTN","VAFCTR",8,0)
 ; 2 RACE INFORMATION - .01 of the multiple
"RTN","VAFCTR",9,0)
 ; 6 ETHNICITY INFORMATION - .01 of the multiple
"RTN","VAFCTR",10,0)
 ; 994 MULTIPLE BIRTH INDICATOR
"RTN","VAFCTR",11,0)
 ; 361 PATIENT ELIGIBILITIES - .01 of the multiple - MOVED TO 691
"RTN","VAFCTR",12,0)
 ; .525 POW STAUTS INDICATED?
"RTN","VAFCTR",13,0)
 ;
"RTN","VAFCTR",14,0)
 I $G(DGFILE)'=2&($G(DGFILE)'=2.01)&($G(DGFILE)'=2.02)&($G(DGFILE)'=2.06)&($G(DGFILE)'=2.0361) Q
"RTN","VAFCTR",15,0)
 S DGFIELD=$G(DGFIELD)
"RTN","VAFCTR",16,0)
 I DGFIELD'=.01&(DGFIELD'=994)&(DGFIELD'=.525) Q
"RTN","VAFCTR",17,0)
 I $T(AVAFC^VAFCDD01)="" Q
"RTN","VAFCTR",18,0)
 I (DGFIELD=994)!(DGFIELD=.525) S VAFCF=DGFIELD_";" D AVAFC^VAFCDD01(DGDA)
"RTN","VAFCTR",19,0)
 ; ^ MULTIPLE BIRTH INDICATOR
"RTN","VAFCTR",20,0)
 I DGFILE=2.01 S VAFCF="1;" D AVAFC^VAFCDD01(DGDA(1)) ;ALIAS
"RTN","VAFCTR",21,0)
 I DGFILE=2.02 S VAFCF="2.02,.01;" D AVAFC^VAFCDD01(DGDA(1))
"RTN","VAFCTR",22,0)
 ; ^ RACE INFORMATION
"RTN","VAFCTR",23,0)
 I DGFILE=2.06 S VAFCF="2.06,.01;" D AVAFC^VAFCDD01(DGDA(1))
"RTN","VAFCTR",24,0)
 ; ^ ETHNICITY INFORMATION
"RTN","VAFCTR",25,0)
 ; MOVED TO DG*5.3*691
"RTN","VAFCTR",26,0)
 ;I DGFILE=2.0361 S VAFCF="2.0361,.01;" D AVAFC^VAFCDD01(DGDA(1))
"RTN","VAFCTR",27,0)
 ; ^ PATIENT ELIGIBILITIES
"RTN","VAFCTR",28,0)
 Q
"VER")
8.0^22.0
"BLD",2176,6)
^598
**END**
**END**
