Released OOPS*2*2 SEQ #2
Extracted from mail message
**KIDS**:OOPS*2.0*2^

**INSTALL NAME**
OOPS*2.0*2
"BLD",4807,0)
OOPS*2.0*2^ASISTS^0^3030930^y
"BLD",4807,1,0)
^^1^1^3030609^^
"BLD",4807,1,1,0)
INSTITUTION FILE AND ACCUMAX CONTENTION FIXES
"BLD",4807,4,0)
^9.64PA^^0
"BLD",4807,"INI")

"BLD",4807,"INID")
^^n
"BLD",4807,"KRN",0)
^9.67PA^8989.52^19
"BLD",4807,"KRN",.4,0)
.4
"BLD",4807,"KRN",.401,0)
.401
"BLD",4807,"KRN",.402,0)
.402
"BLD",4807,"KRN",.403,0)
.403
"BLD",4807,"KRN",.403,"NM",0)
^9.68A^^
"BLD",4807,"KRN",.5,0)
.5
"BLD",4807,"KRN",.84,0)
.84
"BLD",4807,"KRN",.84,"NM",0)
^9.68A^^
"BLD",4807,"KRN",3.6,0)
3.6
"BLD",4807,"KRN",3.6,"NM",0)
^9.68A^1^1
"BLD",4807,"KRN",3.6,"NM",1,0)
OOPS SENSITIVE DATA^^0
"BLD",4807,"KRN",3.6,"NM","B","OOPS SENSITIVE DATA",1)

"BLD",4807,"KRN",3.8,0)
3.8
"BLD",4807,"KRN",3.8,"NM",0)
^9.68A^1^1
"BLD",4807,"KRN",3.8,"NM",1,0)
OOPS ISO NOTIFICATION^^0
"BLD",4807,"KRN",3.8,"NM","B","OOPS ISO NOTIFICATION",1)

"BLD",4807,"KRN",9.2,0)
9.2
"BLD",4807,"KRN",9.8,0)
9.8
"BLD",4807,"KRN",9.8,"NM",0)
^9.68A^5^5
"BLD",4807,"KRN",9.8,"NM",1,0)
OOPSGUI0^^0^B40820418
"BLD",4807,"KRN",9.8,"NM",2,0)
OOPSGUI2^^0^B47647742
"BLD",4807,"KRN",9.8,"NM",3,0)
OOPSGUI5^^0^B60121235
"BLD",4807,"KRN",9.8,"NM",4,0)
OOPSGUI7^^0^B31875168
"BLD",4807,"KRN",9.8,"NM",5,0)
OOPSMBUL^^0^B17635026
"BLD",4807,"KRN",9.8,"NM","B","OOPSGUI0",1)

"BLD",4807,"KRN",9.8,"NM","B","OOPSGUI2",2)

"BLD",4807,"KRN",9.8,"NM","B","OOPSGUI5",3)

"BLD",4807,"KRN",9.8,"NM","B","OOPSGUI7",4)

"BLD",4807,"KRN",9.8,"NM","B","OOPSMBUL",5)

"BLD",4807,"KRN",19,0)
19
"BLD",4807,"KRN",19,"NM",0)
^9.68A^1^1
"BLD",4807,"KRN",19,"NM",1,0)
OOPS GUI EMPLOYEE^^0
"BLD",4807,"KRN",19,"NM","B","OOPS GUI EMPLOYEE",1)

"BLD",4807,"KRN",19.1,0)
19.1
"BLD",4807,"KRN",101,0)
101
"BLD",4807,"KRN",409.61,0)
409.61
"BLD",4807,"KRN",771,0)
771
"BLD",4807,"KRN",870,0)
870
"BLD",4807,"KRN",8989.51,0)
8989.51
"BLD",4807,"KRN",8989.52,0)
8989.52
"BLD",4807,"KRN",8994,0)
8994
"BLD",4807,"KRN",8994,"NM",0)
^9.68A^3^3
"BLD",4807,"KRN",8994,"NM",1,0)
OOPS GET INSTITUTIONS^^0
"BLD",4807,"KRN",8994,"NM",2,0)
OOPS GET CASE NUMBERS^^0
"BLD",4807,"KRN",8994,"NM",3,0)
OOPS SENSITIVE DATA^^0
"BLD",4807,"KRN",8994,"NM","B","OOPS GET CASE NUMBERS",2)

"BLD",4807,"KRN",8994,"NM","B","OOPS GET INSTITUTIONS",1)

"BLD",4807,"KRN",8994,"NM","B","OOPS SENSITIVE DATA",3)

"BLD",4807,"KRN","B",.4,.4)

"BLD",4807,"KRN","B",.401,.401)

"BLD",4807,"KRN","B",.402,.402)

"BLD",4807,"KRN","B",.403,.403)

"BLD",4807,"KRN","B",.5,.5)

"BLD",4807,"KRN","B",.84,.84)

"BLD",4807,"KRN","B",3.6,3.6)

"BLD",4807,"KRN","B",3.8,3.8)

"BLD",4807,"KRN","B",9.2,9.2)

"BLD",4807,"KRN","B",9.8,9.8)

"BLD",4807,"KRN","B",19,19)

"BLD",4807,"KRN","B",19.1,19.1)

"BLD",4807,"KRN","B",101,101)

"BLD",4807,"KRN","B",409.61,409.61)

"BLD",4807,"KRN","B",771,771)

"BLD",4807,"KRN","B",870,870)

"BLD",4807,"KRN","B",8989.51,8989.51)

"BLD",4807,"KRN","B",8989.52,8989.52)

"BLD",4807,"KRN","B",8994,8994)

"BLD",4807,"PRE")

"BLD",4807,"QUES",0)
^9.62^^
"BLD",4807,"REQB",0)
^9.611^1^1
"BLD",4807,"REQB",1,0)
OOPS*2.0*1^1
"BLD",4807,"REQB","B","OOPS*2.0*1",1)

"KRN",3.6,258,-1)
0^1
"KRN",3.6,258,0)
OOPS SENSITIVE DATA^ASISTS Employee Sensitive data .
"KRN",3.6,258,1,0)
^3.61A^11^11^3030603^^^^
"KRN",3.6,258,1,1,0)
This is a notification that the following supervisor 
"KRN",3.6,258,1,2,0)

"KRN",3.6,258,1,3,0)
|1|
"KRN",3.6,258,1,4,0)

"KRN",3.6,258,1,5,0)
used the ASISTS software to View sensitive data for the following employee:
"KRN",3.6,258,1,6,0)

"KRN",3.6,258,1,7,0)
|2|  on |3|.
"KRN",3.6,258,1,8,0)

"KRN",3.6,258,1,9,0)
without creating an Illness or Injury case. 
"KRN",3.6,258,1,10,0)

"KRN",3.6,258,1,11,0)

"KRN",3.6,258,3,0)
^3.63^2^2^3030603^^^^
"KRN",3.6,258,3,1,0)
Bulletin is sent when a supervisor views Employee sensitive data but does not
"KRN",3.6,258,3,2,0)
create an ASISTS case. 
"KRN",3.6,258,4,0)
^3.64A^3^3
"KRN",3.6,258,4,1,0)
1
"KRN",3.6,258,4,1,1,0)
^^2^2^3030602^
"KRN",3.6,258,4,1,1,1,0)
This is the name of the Supervisor that accessed Employee Data, but did not
"KRN",3.6,258,4,1,1,2,0)
create a case in the ASISTS package. 
"KRN",3.6,258,4,2,0)
2
"KRN",3.6,258,4,2,1,0)
^^1^1^3030602^
"KRN",3.6,258,4,2,1,1,0)
This is the name of the Employee that sensitive data was retrieved for. 
"KRN",3.6,258,4,3,0)
3
"KRN",3.6,258,4,3,1,0)
^3.65^1^1^3030603^^^^
"KRN",3.6,258,4,3,1,1,0)
This is the date that the Employee's sensitive data was viewed.
"KRN",3.8,6122,-1)
0^1
"KRN",3.8,6122,0)
OOPS ISO NOTIFICATION^PU^^^^^
"KRN",3.8,6122,2,0)
^^2^2^3030827^
"KRN",3.8,6122,2,1,0)
Popupulate this mail group with the ISO staff who should receive notification
"KRN",3.8,6122,2,2,0)
when a supervisor accesses Employee data but does not create a claim.
"KRN",3.8,6122,3)

"KRN",19,11205,-1)
0^1
"KRN",19,11205,0)
OOPS GUI EMPLOYEE^ASISTS GUI Employee Menu (Context)^^B^^^^^^^^ASISTS
"KRN",19,11205,1,0)
^19.06^6^6^3030811^^^^
"KRN",19,11205,1,1,0)
This Option is the required menu option for any Employee to be able to 
"KRN",19,11205,1,2,0)
access their menu using ASISTS GUI.
"KRN",19,11205,1,3,0)
 
"KRN",19,11205,1,4,0)
Additionally, this option is used to provide access to the majority of RPC
"KRN",19,11205,1,5,0)
Broker Calls as every user of the ASISTS GUI package should have this menu
"KRN",19,11205,1,6,0)
option assigned to them.
"KRN",19,11205,99.1)
58994,3905
"KRN",19,11205,"RPC",0)
^19.05P^53^53
"KRN",19,11205,"RPC",1,0)
OOPS GET BODY PART
"KRN",19,11205,"RPC",2,0)
OOPS GET POINTED TO
"KRN",19,11205,"RPC",3,0)
OOPS REMOTE GET USER OPTIONS
"KRN",19,11205,"RPC",4,0)
OOPS GET CASE NUMBERS
"KRN",19,11205,"RPC",5,0)
OOPS LOAD OOPS
"KRN",19,11205,"RPC",6,0)
OOPS GET DUPLICATES
"KRN",19,11205,"RPC",7,0)
OOPS NEW PERSON DATA
"KRN",19,11205,"RPC",8,0)
OOPS EMPLOYEE DATA
"KRN",19,11205,"RPC",9,0)
OOPS REPLACE DATE/TIME
"KRN",19,11205,"RPC",10,0)
OOPS GET CKRANGE
"KRN",19,11205,"RPC",11,0)
OOPS GET 2260 DATA
"KRN",19,11205,"RPC",12,0)
OOPS GET WITNESSES
"KRN",19,11205,"RPC",13,0)
OOPS REPLACE WP
"KRN",19,11205,"RPC",14,0)
OOPS DELETE WITNESS
"KRN",19,11205,"RPC",15,0)
OOPS WITNESS CREATE
"KRN",19,11205,"RPC",16,0)
OOPS WITNESS DELETE
"KRN",19,11205,"RPC",17,0)
OOPS WITNESS EDIT
"KRN",19,11205,"RPC",18,0)
OOPS APPROVE SIGN FOR EMPLOYEE
"KRN",19,11205,"RPC",19,0)
OOPS CHANGE CASE STATUS
"KRN",19,11205,"RPC",20,0)
OOPS CREATE AMENDMENT
"KRN",19,11205,"RPC",21,0)
OOPS DELETE SITEP STATION
"KRN",19,11205,"RPC",22,0)
OOPS DELETE SITEPAR STATION
"KRN",19,11205,"RPC",23,0)
OOPS DELETE UNION
"KRN",19,11205,"RPC",24,0)
OOPS EDIT 2260
"KRN",19,11205,"RPC",25,0)
OOPS EDIT SITE PARAMETER
"KRN",19,11205,"RPC",26,0)
OOPS EDIT SITEPAR STATION
"KRN",19,11205,"RPC",27,0)
OOPS GET DATA
"KRN",19,11205,"RPC",28,0)
OOPS GET DEFAULT MD
"KRN",19,11205,"RPC",29,0)
OOPS GET SITE PARAMETER
"KRN",19,11205,"RPC",30,0)
OOPS GET STATION INFORMATION
"KRN",19,11205,"RPC",31,0)
OOPS GET SUPERVISOR
"KRN",19,11205,"RPC",32,0)
OOPS GET UNION
"KRN",19,11205,"RPC",33,0)
OOPS INCIDENT REPORT
"KRN",19,11205,"RPC",34,0)
OOPS MANUAL XMIT DATA
"KRN",19,11205,"RPC",35,0)
OOPS PUT UNION
"KRN",19,11205,"RPC",36,0)
OOPS REPLACE MULTIPLE
"KRN",19,11205,"RPC",37,0)
OOPS SET FIELD
"KRN",19,11205,"RPC",38,0)
OOPS UNION CONSENT
"KRN",19,11205,"RPC",39,0)
OOPS VALIDATE AND SIGN
"KRN",19,11205,"RPC",40,0)
OOPS VALIDATE TIME
"KRN",19,11205,"RPC",41,0)
OOPS WCEDIT
"KRN",19,11205,"RPC",42,0)
OOPS CLEAR SIGNATURE
"KRN",19,11205,"RPC",43,0)
OOPS GET OSHA DATA
"KRN",19,11205,"RPC",44,0)
OOPS GET PRT ACC STATUS RPT
"KRN",19,11205,"RPC",45,0)
OOPS NEEDLESTICK LOG
"KRN",19,11205,"RPC",46,0)
OOPS GET NOI CODE
"KRN",19,11205,"RPC",47,0)
OOPS GET ASISTS CASE
"KRN",19,11205,"RPC",48,0)
OOPS CHECK PAID EMP DATA
"KRN",19,11205,"RPC",49,0)
OOPS RELEASE RECORD LOCK
"KRN",19,11205,"RPC",50,0)
OOPS SET RECORD LOCK
"KRN",19,11205,"RPC",51,0)
OOPS GET SINGLE FIELD
"KRN",19,11205,"RPC",52,0)
OOPS GET INSTITUTIONS
"KRN",19,11205,"RPC",53,0)
OOPS SENSITIVE DATA
"KRN",19,11205,"U")
ASISTS GUI EMPLOYEE MENU (CONT
"KRN",8994,987,-1)
0^2
"KRN",8994,987,0)
OOPS GET CASE NUMBERS^GETCASE^OOPSGUI0^4
"KRN",8994,987,1,0)
^8994.01^2^2^3030604^^^^
"KRN",8994,987,1,1,0)
This call returns a list of cases that match the search criteria and are 
"KRN",8994,987,1,2,0)
eligible for editing.
"KRN",8994,987,2,0)
^8994.02A^5^5
"KRN",8994,987,2,1,0)
PERSON^1^^^1
"KRN",8994,987,2,1,1,0)
^8994.021^8^8^3020109^^^
"KRN",8994,987,2,1,1,1,0)
The value passed in PERSON determines which cases are included in the
"KRN",8994,987,2,1,1,2,0)
lookup.  A single Person can be returned or a listing of all cases for a
"KRN",8994,987,2,1,1,3,0)
particular Supervisor or Secondary Supervisor.  If a listing by Supervisor is
"KRN",8994,987,2,1,1,4,0)
desired the Supervisor's DUZ must be passed in.  The format is:
"KRN",8994,987,2,1,1,5,0)
  PERSON = 0^  (all cases included)
"KRN",8994,987,2,1,1,6,0)
           1^PERSON INVOLVED name
"KRN",8994,987,2,1,1,7,0)
           2^SUP / SEC SUP DUZ
"KRN",8994,987,2,1,1,8,0)

"KRN",8994,987,2,2,0)
CSTAT^1^^^2
"KRN",8994,987,2,2,1,0)
^8994.021^10^10^3020108^^
"KRN",8994,987,2,2,1,1,0)
This parameter passes in the Case Status's of the claims to be included in the
"KRN",8994,987,2,2,1,2,0)
lookup criteria.  This parameter must be set programatically as there is not a
"KRN",8994,987,2,2,1,3,0)
mechanism for user input.  Typically, this would be set to only allow Open
"KRN",8994,987,2,2,1,4,0)
cases to be included, with few exceptions.  The expected format is:
"KRN",8994,987,2,2,1,5,0)
  CSTAT = #^#^#^#^   where each number is defined below
"KRN",8994,987,2,2,1,6,0)
          99^        all case status should be included
"KRN",8994,987,2,2,1,7,0)
           0^        open cases
"KRN",8994,987,2,2,1,8,0)
           1^        closed cases
"KRN",8994,987,2,2,1,9,0)
           2^        deleted cases
"KRN",8994,987,2,2,1,10,0)
           3^        replaced by amendment
"KRN",8994,987,2,3,0)
PSTAT^1^^^3
"KRN",8994,987,2,3,1,0)
^8994.021^16^16^3020109^^^
"KRN",8994,987,2,3,1,1,0)
This parameter determines which PERSONNEL STATUS's should be included in the
"KRN",8994,987,2,3,1,2,0)
lookup criteria.  This parameter is determined by the user and the format is
"KRN",8994,987,2,3,1,3,0)
as follows:
"KRN",8994,987,2,3,1,4,0)
  PSTAT = #^#^#^#^#^    for every Personnel Status
"KRN",8994,987,2,3,1,5,0)
          0^            all personnel status's should be included
"KRN",8994,987,2,3,1,6,0)
          1^            employee
"KRN",8994,987,2,3,1,7,0)
          2^            volunteer
"KRN",8994,987,2,3,1,8,0)
          3^            contractor
"KRN",8994,987,2,3,1,9,0)
          4^            visitor
"KRN",8994,987,2,3,1,10,0)
          5^            other
"KRN",8994,987,2,3,1,11,0)
          6^            non-paid employee
"KRN",8994,987,2,3,1,12,0)
          7^            medical student
"KRN",8994,987,2,3,1,13,0)
          8^            nursing student
"KRN",8994,987,2,3,1,14,0)
          9^            other student
"KRN",8994,987,2,3,1,15,0)
         10^            resident physician
"KRN",8994,987,2,3,1,16,0)

"KRN",8994,987,2,4,0)
CALL^1^^^4
"KRN",8994,987,2,4,1,0)
^^7^7^3011002^
"KRN",8994,987,2,4,1,1,0)
This parameter passes in the menu that the broker call was made from.
"KRN",8994,987,2,4,1,2,0)
  CALL = E  employee menu
"KRN",8994,987,2,4,1,3,0)
         S  supervisor menu
"KRN",8994,987,2,4,1,4,0)
         H  employee health menu
"KRN",8994,987,2,4,1,5,0)
         O  safety officer menu
"KRN",8994,987,2,4,1,6,0)
         W  workers comp menu
"KRN",8994,987,2,4,1,7,0)
         U  union menu
"KRN",8994,987,2,5,0)
OPT^1^^^5
"KRN",8994,987,2,5,1,0)
^8994.021^3^3^3030604^^^^
"KRN",8994,987,2,5,1,1,0)
This parameter passes in the option that the broker call was made from, if
"KRN",8994,987,2,5,1,2,0)
needed.  It is required to determine which fields should be availble for 
"KRN",8994,987,2,5,1,3,0)
editing in the CA1, CA2, and 2162 forms.
"KRN",8994,987,2,"B","CALL",4)

"KRN",8994,987,2,"B","CSTAT",2)

"KRN",8994,987,2,"B","OPT",5)

"KRN",8994,987,2,"B","PERSON",1)

"KRN",8994,987,2,"B","PSTAT",3)

"KRN",8994,987,2,"PARAMSEQ",1,1)

"KRN",8994,987,2,"PARAMSEQ",2,2)

"KRN",8994,987,2,"PARAMSEQ",3,3)

"KRN",8994,987,2,"PARAMSEQ",4,4)

"KRN",8994,987,2,"PARAMSEQ",5,5)

"KRN",8994,987,3,0)
^8994.03^6^6^3030604^^^^
"KRN",8994,987,3,1,0)
An array is passed back which contains the case number, date/time of occurrence,
"KRN",8994,987,3,2,0)
the person involved, and the ASISTS IEN.
"KRN",8994,987,3,3,0)

"KRN",8994,987,3,4,0)
Data will be returned in the following format:
"KRN",8994,987,3,5,0)
       2002-00021^JAN 08, 2002@11:19^TURNIP,JANE^193^100-00-0038
"KRN",8994,987,3,6,0)

"KRN",8994,1446,-1)
0^1
"KRN",8994,1446,0)
OOPS GET INSTITUTIONS^GETINST^OOPSGUI7^4^P
"KRN",8994,1446,1,0)
^8994.01^2^2^3030630^^
"KRN",8994,1446,1,1,0)
This broker call will retrieve all the stations from the INSTITUTION
"KRN",8994,1446,1,2,0)
(#4) file.
"KRN",8994,1446,3,0)
^8994.03^2^2^3030630^^
"KRN",8994,1446,3,1,0)
The return parameter is a global array ^TMP("OOPSINST",DUZ) in the format of:
"KRN",8994,1446,3,2,0)
IEN:STATION NAME = STATION NUMBER
"KRN",8994,1447,-1)
0^3
"KRN",8994,1447,0)
OOPS SENSITIVE DATA^SENSDATA^OOPSGUI7^1^P
"KRN",8994,1447,1,0)
^8994.01^2^2^3030602^^
"KRN",8994,1447,1,1,0)
This Broker call is used to pass data to the bulletin routine for supervisors
"KRN",8994,1447,1,2,0)
accessing sensitive data and not creating an ASISTS case. 
"KRN",8994,1447,2,0)
^8994.02A^2^2
"KRN",8994,1447,2,1,0)
SDUZ^1^^1
"KRN",8994,1447,2,1,1,0)
^^1^1^3030602^
"KRN",8994,1447,2,1,1,1,0)
This is the DUZ of the supervisor accessing the Employee's data.
"KRN",8994,1447,2,2,0)
EMP^1^^1
"KRN",8994,1447,2,2,1,0)
^8994.021^1^1^3030602^^
"KRN",8994,1447,2,2,1,1,0)
This is the Employee's name for which the sensitive date has been viewed.
"KRN",8994,1447,2,"B","EMP",2)

"KRN",8994,1447,2,"B","SDUZ",1)

"MBREQ")
0
"ORD",2,3.6)
3.6;2;1;;BUL^XPDTA1;;BULE1^XPDIA1;;;BULDEL^XPDIA1
"ORD",2,3.6,0)
BULLETIN
"ORD",11,3.8)
3.8;11;;;MAILG^XPDTA1;MAILGF1^XPDIA1;MAILGE1^XPDIA1;MAILGF2^XPDIA1;;MAILGDEL^XPDIA1(%)
"ORD",11,3.8,0)
MAIL GROUP
"ORD",16,8994)
8994;16;1;;;;;;;RPCDEL^XPDIA1
"ORD",16,8994,0)
REMOTE PROCEDURE
"ORD",18,19)
19;18;;;OPT^XPDTA;OPTF1^XPDIA;OPTE1^XPDIA;OPTF2^XPDIA;;OPTDEL^XPDIA
"ORD",18,19,0)
OPTION
"PKG",472,-1)
1^1
"PKG",472,0)
ASISTS^OOPS^Automated Safety Incident Surveillance Tracking System
"PKG",472,20,0)
^9.402P^^
"PKG",472,22,0)
^9.49I^1^1
"PKG",472,22,1,0)
2.0^3020709^3030401^66481
"PKG",472,22,1,"PAH",1,0)
2^3030930
"PKG",472,22,1,"PAH",1,1,0)
^^1^1^3030930
"PKG",472,22,1,"PAH",1,1,1,0)
INSTITUTION FILE AND ACCUMAX CONTENTION FIXES
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
5
"RTN","OOPSGUI0")
0^1^B40820418
"RTN","OOPSGUI0",1,0)
OOPSGUI0 ;WIOFO/LLH-RPC routines ;01/02/02
"RTN","OOPSGUI0",2,0)
 ;;2.0;ASISTS;**2**;Jun 03, 2002
"RTN","OOPSGUI0",3,0)
 ;
"RTN","OOPSGUI0",4,0)
GETCASE(RESULTS,PERSON,CSTAT,PSTAT,CALL,OPT) ; Subroutine for Case Selection
"RTN","OOPSGUI0",5,0)
 ; Returns a list of cases that can be displayed for selection
"RTN","OOPSGUI0",6,0)
 ; RESULTS = return array containing, CASE#^IEN^NAME^DATE TIME OCCUR
"RTN","OOPSGUI0",7,0)
 ; PERSON  = 0^ if no person selected
"RTN","OOPSGUI0",8,0)
 ;           1^PERSON INVOLVED NAME
"RTN","OOPSGUI0",9,0)
 ;           2^SUPERVISOR DUZ
"RTN","OOPSGUI0",10,0)
 ;           3^USER SSN
"RTN","OOPSGUI0",11,0)
 ;           4^CASE NUMBER
"RTN","OOPSGUI0",12,0)
 ; CSTAT   = #^#^#^#  0^1^2^3 0=open, 1=closed, 2=deleted, 3=replaced
"RTN","OOPSGUI0",13,0)
 ;           99^ if all Case Status should be included
"RTN","OOPSGUI0",14,0)
 ;           CSTAT is only set programatically
"RTN","OOPSGUI0",15,0)
 ; PSTAT   = 0^  if all personnel status types should be included
"RTN","OOPSGUI0",16,0)
 ;           #^#^#^ for each personnel status selected
"RTN","OOPSGUI0",17,0)
 ; CALL    = Calling menu, used to assure proper access
"RTN","OOPSGUI0",18,0)
 ; OPT     = Option called from, used to assure proper access
"RTN","OOPSGUI0",19,0)
 ; 
"RTN","OOPSGUI0",20,0)
 K ^TMP("OOPSCASE",DUZ)
"RTN","OOPSGUI0",21,0)
 N ARR,CNUM,OOPSDA,PER,STA,SUP,VIEWSUP,VIEWEMP,VALSSN
"RTN","OOPSGUI0",22,0)
 I $G(PERSON)="" Q
"RTN","OOPSGUI0",23,0)
 I +PERSON=1 D GETPER,SORT G EXIT
"RTN","OOPSGUI0",24,0)
 I +PERSON=4 D  G EXIT
"RTN","OOPSGUI0",25,0)
 . S CNUM=$P($G(PERSON),U,2) I '$G(CNUM) Q
"RTN","OOPSGUI0",26,0)
 . S OOPSDA=$O(^OOPS(2260,"B",CNUM,"")) I '$G(OOPSDA) D  Q
"RTN","OOPSGUI0",27,0)
 .. S ^TMP("OOPSCASE",DUZ,1)="No Cases Selectable"
"RTN","OOPSGUI0",28,0)
 .. S RESULTS=$NA(^TMP("OOPSCASE",DUZ))
"RTN","OOPSGUI0",29,0)
 ..; S RESULTS(0)="No Cases Selectable"
"RTN","OOPSGUI0",30,0)
 . S STA=$$GET1^DIQ(2260,OOPSDA,51,"I")
"RTN","OOPSGUI0",31,0)
 . I +CSTAT'=99,(CSTAT'[STA_"^") Q  ;allow only selected case status
"RTN","OOPSGUI0",32,0)
 . I $$CALLER() S ARR(CNUM)=OOPSDA
"RTN","OOPSGUI0",33,0)
 . D SORT
"RTN","OOPSGUI0",34,0)
 S CNUM=0
"RTN","OOPSGUI0",35,0)
 F  S CNUM=$O(^OOPS(2260,"B",CNUM)) Q:CNUM=""  D
"RTN","OOPSGUI0",36,0)
 . S OOPSDA=""
"RTN","OOPSGUI0",37,0)
 . F  S OOPSDA=$O(^OOPS(2260,"B",CNUM,OOPSDA)) Q:OOPSDA=""  D
"RTN","OOPSGUI0",38,0)
 .. I +PERSON=3 D  Q:'VIEWEMP
"RTN","OOPSGUI0",39,0)
 ... S VIEWEMP=1,VALSSN=$P($G(PERSON),U,2)
"RTN","OOPSGUI0",40,0)
 ... I $$GET1^DIQ(2260,OOPSDA,5,"I")'=VALSSN  D
"RTN","OOPSGUI0",41,0)
 .... S VIEWEMP=0
"RTN","OOPSGUI0",42,0)
 .... S ^TMP("OOPSCASE",DUZ,1)="No Cases Selectable"
"RTN","OOPSGUI0",43,0)
 .... S RESULTS=$NA(^TMP("OOPSCASE",DUZ))
"RTN","OOPSGUI0",44,0)
 .. S STA=$$GET1^DIQ(2260,OOPSDA,51,"I")
"RTN","OOPSGUI0",45,0)
 .. I +CSTAT'=99,(CSTAT'[STA_"^") Q  ;allow only selected case status
"RTN","OOPSGUI0",46,0)
 .. S PER=$$GET1^DIQ(2260,OOPSDA,2,"I")
"RTN","OOPSGUI0",47,0)
 .. I (+PSTAT)&(PSTAT'[(PER_"^")) Q      ;allow only selected per status
"RTN","OOPSGUI0",48,0)
 .. I +PERSON=2 D  Q:'VIEWSUP
"RTN","OOPSGUI0",49,0)
 ... S VIEWSUP=1,SUP=$P(PERSON,U,2)
"RTN","OOPSGUI0",50,0)
 ... I $$GET1^DIQ(2260,OOPSDA,53,"I")'=SUP,($$GET1^DIQ(2260,OOPSDA,53.1,"I")'=SUP) D  Q
"RTN","OOPSGUI0",51,0)
 ....; S RESULTS(0)="No Cases Selectable",VIEWSUP=0
"RTN","OOPSGUI0",52,0)
 .... S ^TMP("OOPSCASE",DUZ,1)="No Cases Selectable",VIEWSUP=0
"RTN","OOPSGUI0",53,0)
 .... S RESULTS=$NA(^TMP("OOPSCASE",DUZ))
"RTN","OOPSGUI0",54,0)
 .. I $$CALLER() S CNUM=$$GET1^DIQ(2260,OOPSDA,.01),ARR(CNUM)=OOPSDA
"RTN","OOPSGUI0",55,0)
 D SORT
"RTN","OOPSGUI0",56,0)
EXIT ; quit the routine
"RTN","OOPSGUI0",57,0)
 Q
"RTN","OOPSGUI0",58,0)
GETPER ; Person Name passed in, match
"RTN","OOPSGUI0",59,0)
 ; See above for documentation
"RTN","OOPSGUI0",60,0)
 N NM
"RTN","OOPSGUI0",61,0)
 S OOPSDA="",NM=$P(PERSON,U,2)
"RTN","OOPSGUI0",62,0)
 F  S OOPSDA=$O(^OOPS(2260,"C",NM,OOPSDA)) Q:OOPSDA=""  D
"RTN","OOPSGUI0",63,0)
 . S STA=$$GET1^DIQ(2260,OOPSDA,51,"I")
"RTN","OOPSGUI0",64,0)
 . I +CSTAT'=99,(CSTAT'[STA_"^") Q  ;allow only selected case status
"RTN","OOPSGUI0",65,0)
 . S PER=$$GET1^DIQ(2260,OOPSDA,2,"I")
"RTN","OOPSGUI0",66,0)
 . I (+PSTAT)&(PSTAT'[(PER_"^")) Q      ;allow only selected per status
"RTN","OOPSGUI0",67,0)
 . I $$CALLER() S CNUM=$$GET1^DIQ(2260,OOPSDA,.01),ARR(CNUM)=OOPSDA
"RTN","OOPSGUI0",68,0)
 Q
"RTN","OOPSGUI0",69,0)
CALLER() ; Check to make sure case should be included
"RTN","OOPSGUI0",70,0)
 N EES,ESTAT,FLD,INC,SIG,SSN,VIEWC
"RTN","OOPSGUI0",71,0)
 S VIEWC=1
"RTN","OOPSGUI0",72,0)
 S INC=$$GET1^DIQ(2260,OOPSDA,52,"I")
"RTN","OOPSGUI0",73,0)
 ; get users SSN 
"RTN","OOPSGUI0",74,0)
 S SSN=$$GET1^DIQ(200,DUZ,9)
"RTN","OOPSGUI0",75,0)
 ; make sure user cannot access claim from any menu but Employee
"RTN","OOPSGUI0",76,0)
 I CALL'="E",($$GET1^DIQ(2260,OOPSDA,5,"I")=SSN) S VIEWC=0 Q VIEWC
"RTN","OOPSGUI0",77,0)
 ; Claim already sent to DOL, can't edit, Caller / Option doesnt matter
"RTN","OOPSGUI0",78,0)
 ; unless the Option = "CHGCASE"
"RTN","OOPSGUI0",79,0)
 I ($$GET1^DIQ(2260,OOPSDA,66)'=""),(OPT'="CHGCASE"),(OPT'="PRINTCA"),(OPT'=2162) S VIEWC=0 Q VIEWC
"RTN","OOPSGUI0",80,0)
 ; for any option from the supervisor menu
"RTN","OOPSGUI0",81,0)
 I CALL="S" D  I 'VIEWC Q VIEWC
"RTN","OOPSGUI0",82,0)
 . I $$GET1^DIQ(2260,OOPSDA,53,"I")'=DUZ,($$GET1^DIQ(2260,OOPSDA,53.1,"I")'=DUZ) S VIEWC=0 Q
"RTN","OOPSGUI0",83,0)
 ; if opt = 2162
"RTN","OOPSGUI0",84,0)
 I OPT=2162 D  Q VIEWC
"RTN","OOPSGUI0",85,0)
 . I $$GET1^DIQ(2260,OOPSDA,51,"I")=1 S VIEWC=0  ; closed, can't edit
"RTN","OOPSGUI0",86,0)
 . ; signed SO, coming from Supervisor menu, cant access
"RTN","OOPSGUI0",87,0)
 . I (CALL="S"),+$$EDSTA^OOPSUTL1(OOPSDA,"O") S VIEWC=0
"RTN","OOPSGUI0",88,0)
 . I CALL="H" D
"RTN","OOPSGUI0",89,0)
 .. I $P($$EDSTA^OOPSUTL1(OOPSDA,"S"),U,3)!(+$$EDSTA^OOPSUTL1(OOPSDA,"O")) S VIEWC=0
"RTN","OOPSGUI0",90,0)
 . I CALL="W" D
"RTN","OOPSGUI0",91,0)
 .. I +$$EDSTA^OOPSUTL1(OOPSDA,"O") S VIEWC=0   ;safety signed cant see
"RTN","OOPSGUI0",92,0)
 ; if opt = CA1 only return/allow CA1's, caller doesnt matter
"RTN","OOPSGUI0",93,0)
 I OPT="CA1",INC'=1 S VIEWC=0 Q VIEWC
"RTN","OOPSGUI0",94,0)
 ; if opt = CA2 only return/allow CA2's, caller doesnt matter
"RTN","OOPSGUI0",95,0)
 I OPT="CA2",INC'=2 S VIEWC=0 Q VIEWC
"RTN","OOPSGUI0",96,0)
 I CALL="E" D  Q VIEWC
"RTN","OOPSGUI0",97,0)
 . I '$$ISEMP^OOPSUTL4(OOPSDA) S VIEWC=0 Q
"RTN","OOPSGUI0",98,0)
 . I '$G(SSN) S VIEWC=0 Q
"RTN","OOPSGUI0",99,0)
 . I $D(^OOPS(2260,"SSN",SSN))<1 S VIEWC=0 Q
"RTN","OOPSGUI0",100,0)
 . ; user SSN must = case IEN from Employee menu
"RTN","OOPSGUI0",101,0)
 . I $$GET1^DIQ(2260,OOPSDA,5,"I")'=SSN S VIEWC=0 Q
"RTN","OOPSGUI0",102,0)
 . S SIG=$$EDSTA^OOPSUTL1(OOPSDA,"S")
"RTN","OOPSGUI0",103,0)
 . I (OPT'="PRINTCA"),$P(SIG,U,INC) S VIEWC=0 Q
"RTN","OOPSGUI0",104,0)
 I CALL="S" D  Q VIEWC
"RTN","OOPSGUI0",105,0)
 . ; not Super or Sec Super, can't access form, regardless of form type
"RTN","OOPSGUI0",106,0)
 . I $$GET1^DIQ(2260,OOPSDA,53,"I")'=DUZ&($$GET1^DIQ(2260,OOPSDA,53.1,"I")'=DUZ) S VIEWC=0 Q
"RTN","OOPSGUI0",107,0)
 . ; Supervisor cannot complete their own form.
"RTN","OOPSGUI0",108,0)
 . I $$GET1^DIQ(2260,OOPSDA,5,"I")=SSN S VIEWC=0 Q
"RTN","OOPSGUI0",109,0)
 . I OPT="CA1"!(OPT="CA2") D  Q
"RTN","OOPSGUI0",110,0)
 .. ; if form CA, must be employee to complete
"RTN","OOPSGUI0",111,0)
 .. I '$$ISEMP^OOPSUTL4(OOPSDA) S VIEWC=0 Q
"RTN","OOPSGUI0",112,0)
 .. ; commented out next 2 lines, ? whether wanted by TAG 11/1/01 llh
"RTN","OOPSGUI0",113,0)
 .. ; Employee hasn't signed, super can't get to
"RTN","OOPSGUI0",114,0)
 .. ; I '$P($$EDSTA^OOPSUTL1(OOPSDA,"E"),U,INC) S VIEWC=0 Q
"RTN","OOPSGUI0",115,0)
 .. ; Supervisor has signed, can't re-edit
"RTN","OOPSGUI0",116,0)
 .. I $P($$EDSTA^OOPSUTL1(OOPSDA,"S"),U,INC) S VIEWC=0 Q
"RTN","OOPSGUI0",117,0)
 I CALL="O"!(CALL="W")!(CALL="H") D  Q VIEWC
"RTN","OOPSGUI0",118,0)
 . I OPT="CA1"!(OPT="CA2") D  Q
"RTN","OOPSGUI0",119,0)
 .. I '$$ISEMP^OOPSUTL4(OOPSDA) S VIEWC=0 Q
"RTN","OOPSGUI0",120,0)
 . I OPT="WCSIGN" D  Q
"RTN","OOPSGUI0",121,0)
 .. S ESTAT=$$EDSTA^OOPSUTL1(OOPSDA,"E")
"RTN","OOPSGUI0",122,0)
 .. I '$$ISEMP^OOPSUTL4(OOPSDA) S VIEWC=0 Q
"RTN","OOPSGUI0",123,0)
 .. I CALL'="W",$P(ESTAT,U,INC) S VIEWC=0 Q
"RTN","OOPSGUI0",124,0)
 .. I CALL="W" D
"RTN","OOPSGUI0",125,0)
 ... S FLD=$S(INC=1:119,INC=2:221,1:"") I 'FLD S VIEWC=0 Q
"RTN","OOPSGUI0",126,0)
 ... S EES=$$GET1^DIQ(2260,OOPSDA,FLD,"I")
"RTN","OOPSGUI0",127,0)
 ... ; employee hasn't signed, ok for WC to sign
"RTN","OOPSGUI0",128,0)
 ... I 'EES Q
"RTN","OOPSGUI0",129,0)
 ... ; employee signed, not signed by person accessing claim, no access
"RTN","OOPSGUI0",130,0)
 ... I EES'=DUZ S VIEWC=0 Q
"RTN","OOPSGUI0",131,0)
 ... I $P($$EDSTA^OOPSUTL1(OOPSDA,"S"),U,INC) S VIEWC=0 ;Sup Sign, no acc
"RTN","OOPSGUI0",132,0)
 . I OPT="WCEMPSIGN" D  Q
"RTN","OOPSGUI0",133,0)
 .. N CALLER,SVIEW
"RTN","OOPSGUI0",134,0)
 .. S CALLER=CALL
"RTN","OOPSGUI0",135,0)
 .. I $$GET1^DIQ(2260,OOPSDA,51,"I") S VIEWC=0 Q    ; claim must be open
"RTN","OOPSGUI0",136,0)
 .. I $$GET1^DIQ(2260,OOPSDA,77)="" S VIEWC=0 Q
"RTN","OOPSGUI0",137,0)
 .. I $$GET1^DIQ(2260,OOPSDA,80)="" S VIEWC=0 Q
"RTN","OOPSGUI0",138,0)
 .. S SVIEW=$$SCR^OOPSWCSE(OOPSDA) I 'SVIEW S VIEWC=0 Q
"RTN","OOPSGUI0",139,0)
 I CALL="U" D  Q VIEWC
"RTN","OOPSGUI0",140,0)
 . I '+$$EDSTA^OOPSUTL1(OOPSDA,"O") S VIEWC=0 Q
"RTN","OOPSGUI0",141,0)
 . I '$P($$EDSTA^OOPSUTL1(OOPSDA,"S"),U,3) S VIEWC=0 Q
"RTN","OOPSGUI0",142,0)
 Q VIEWC
"RTN","OOPSGUI0",143,0)
SORT ; put cases in reverse number order
"RTN","OOPSGUI0",144,0)
 N CN,CNUM,OOPSDA,SSN,DOI
"RTN","OOPSGUI0",145,0)
 S ^TMP("OOPSCASE",DUZ,0)="",CNUM="",CN=1
"RTN","OOPSGUI0",146,0)
 I '$D(ARR) S RESULTS(0)="No Cases Selectable"  D
"RTN","OOPSGUI0",147,0)
 . S ^TMP("OOPSCASE",DUZ,1)="No Cases Selectable",VIEWSUP=0
"RTN","OOPSGUI0",148,0)
 . S RESULTS=$NA(^TMP("OOPSCASE",DUZ))
"RTN","OOPSGUI0",149,0)
 F  S CNUM=$O(ARR(CNUM),-1) Q:CNUM=""  D
"RTN","OOPSGUI0",150,0)
 . S OOPSDA=ARR(CNUM)
"RTN","OOPSGUI0",151,0)
 . S NM=$$GET1^DIQ(2260,OOPSDA,1)
"RTN","OOPSGUI0",152,0)
 . S DOI=$$GET1^DIQ(2260,OOPSDA,4)
"RTN","OOPSGUI0",153,0)
 . S SSN=$$GET1^DIQ(2260,OOPSDA,5)
"RTN","OOPSGUI0",154,0)
 . I CALL="U" S (NM,DOI,SSN)=""
"RTN","OOPSGUI0",155,0)
 . S ^TMP("OOPSCASE",DUZ,CN)=CNUM_U_DOI_U_NM_U_OOPSDA_U_SSN_$C(10),CN=CN+1
"RTN","OOPSGUI0",156,0)
 S RESULTS=$NA(^TMP("OOPSCASE",DUZ))
"RTN","OOPSGUI0",157,0)
 Q
"RTN","OOPSGUI2")
0^2^B47647742
"RTN","OOPSGUI2",1,0)
OOPSGUI2 ;WIOFO/CVW-RPC routines ;9/19/01
"RTN","OOPSGUI2",2,0)
 ;;2.0;ASISTS;**2**;Jun 03, 2002
"RTN","OOPSGUI2",3,0)
 ;
"RTN","OOPSGUI2",4,0)
GET(RESULTS,INPUT) ; Get Case data from 2260
"RTN","OOPSGUI2",5,0)
 ;  Input:    INPUT - IEN^FORM where IEN = ASISTS IEN and 
"RTN","OOPSGUI2",6,0)
 ;                    FORM = Either "CA1","CA2" or "2162"
"RTN","OOPSGUI2",7,0)
 ; Output:  RESULTS - Array of data from 2260, each element in the
"RTN","OOPSGUI2",8,0)
 ;                    is based on the field number in 2260.
"RTN","OOPSGUI2",9,0)
 N NODE,PIECE,FNUM,IEN,VAR,FORM,FLDCNT,INVFLDS
"RTN","OOPSGUI2",10,0)
 ;Define fields that should never be returned
"RTN","OOPSGUI2",11,0)
 S INVFLDS="^19^20^21^22^23^24^25^122^224^"
"RTN","OOPSGUI2",12,0)
 S IEN=+$G(INPUT),FORM=$P($G(INPUT),U,2),FLDCNT=0
"RTN","OOPSGUI2",13,0)
 I '$G(IEN) Q
"RTN","OOPSGUI2",14,0)
 I '$D(^OOPS(2260,$G(IEN),0)) D  Q
"RTN","OOPSGUI2",15,0)
 . S (RESULTS,RESULTS(1))="-1^IEN:"_IEN_" not found in file 2260"
"RTN","OOPSGUI2",16,0)
 I "CA1^CA2^2162"'[FORM!(FORM="") D  Q
"RTN","OOPSGUI2",17,0)
 . S (RESULTS,RESULTS(1))="-2^FORM:"_FORM_" not valid, must be CA1,CA2, or 2162"
"RTN","OOPSGUI2",18,0)
 S NODE="" F  S NODE=$O(^DD(2260,"GL",NODE)) Q:NODE=""  D
"RTN","OOPSGUI2",19,0)
 .S PIECE=0 F  S PIECE=$O(^DD(2260,"GL",NODE,PIECE)) Q:PIECE=""  D
"RTN","OOPSGUI2",20,0)
 ..S FNUM=0 F  S FNUM=$O(^DD(2260,"GL",NODE,PIECE,FNUM)) Q:FNUM=""  D
"RTN","OOPSGUI2",21,0)
 ...I INVFLDS[("^"_FNUM_"^") Q
"RTN","OOPSGUI2",22,0)
 ...I ($E(NODE,1,$L(FORM))'=FORM),(NODE'=0),(NODE'="CA"),(NODE'["WC") Q
"RTN","OOPSGUI2",23,0)
 ...S RESULTS(FNUM)=$$GET1^DIQ(2260,IEN,FNUM)
"RTN","OOPSGUI2",24,0)
 ...I FNUM=13 S RESULTS(FNUM)=RESULTS(FNUM)_" = "_$$GET1^DIQ(2260,IEN,FNUM_":99")
"RTN","OOPSGUI2",25,0)
 ...I FNUM=53!(FNUM=53.1) S RESULTS(FNUM)=RESULTS(FNUM)_"^"_$$GET1^DIQ(2260,IEN,FNUM,"I")
"RTN","OOPSGUI2",26,0)
 ...I FNUM=76!(FNUM=79) S RESULTS(FNUM)=$$GET1^DIQ(2260,IEN,FNUM,"I")
"RTN","OOPSGUI2",27,0)
 ...S FLDCNT=FLDCNT+1
"RTN","OOPSGUI2",28,0)
 Q
"RTN","OOPSGUI2",29,0)
WITR(RESULTS,IEN)     ;Return entries from the witness multiple
"RTN","OOPSGUI2",30,0)
 ;  Input:     IEN - The ASISTS IEN used to pull info from file 2260.
"RTN","OOPSGUI2",31,0)
 ; Output: RESULTS - array with Witness data and associated comment
"RTN","OOPSGUI2",32,0)
 ;
"RTN","OOPSGUI2",33,0)
 N SUBN,COUNT,STATE,WDT
"RTN","OOPSGUI2",34,0)
 S (SUBN,COUNT)=0,(STATE,WDT)=""
"RTN","OOPSGUI2",35,0)
 F  S SUBN=$O(^OOPS(2260,IEN,"CA1W",SUBN)) Q:'SUBN  D
"RTN","OOPSGUI2",36,0)
 . S RESULTS(COUNT)=$G(^OOPS(2260,IEN,"CA1W",SUBN,0))
"RTN","OOPSGUI2",37,0)
 . S STATE=$$EXTERNAL^DILFD(2260.0125,3,"",$P(RESULTS(COUNT),U,4))
"RTN","OOPSGUI2",38,0)
 . S WDT=$$EXTERNAL^DILFD(2260.0125,5,"",$P(RESULTS(COUNT),U,6))
"RTN","OOPSGUI2",39,0)
 . S $P(RESULTS(COUNT),U,4)=STATE,$P(RESULTS(COUNT),U,6)=WDT
"RTN","OOPSGUI2",40,0)
 . S $P(RESULTS(COUNT),U,7)=SUBN
"RTN","OOPSGUI2",41,0)
 . S COUNT=COUNT+1
"RTN","OOPSGUI2",42,0)
 . S RESULTS(COUNT)=$G(^OOPS(2260,IEN,"CA1W",SUBN,1))
"RTN","OOPSGUI2",43,0)
 . S COUNT=COUNT+1
"RTN","OOPSGUI2",44,0)
 Q
"RTN","OOPSGUI2",45,0)
DEFMD(RESULTS,IEN)      ;
"RTN","OOPSGUI2",46,0)
 ;Send in the Case IEN, return an array of 
"RTN","OOPSGUI2",47,0)
 ;(0)="1^Valid Results" or "0^No Valid Results"
"RTN","OOPSGUI2",48,0)
 ;(1)=PROVIDER NAME
"RTN","OOPSGUI2",49,0)
 ;(2)=PROVIDER ADDRESS
"RTN","OOPSGUI2",50,0)
 ;(3)=PROVIDER CITY
"RTN","OOPSGUI2",51,0)
 ;(4)=PROVIDER STATE
"RTN","OOPSGUI2",52,0)
 ;(5)=PROVIDER ZIP CODE
"RTN","OOPSGUI2",53,0)
 ;(6)=PROVIDER TITLE
"RTN","OOPSGUI2",54,0)
 N STA,PSTA,PIEN
"RTN","OOPSGUI2",55,0)
 S (STA,PSTA,PIEN)=""
"RTN","OOPSGUI2",56,0)
 S RESULTS(0)="0^No Valid Results"
"RTN","OOPSGUI2",57,0)
 Q:+IEN'>0
"RTN","OOPSGUI2",58,0)
 S STA=$P($G(^OOPS(2260,IEN,"2162A")),U,9)
"RTN","OOPSGUI2",59,0)
 Q:+STA'>0
"RTN","OOPSGUI2",60,0)
 S PIEN=$O(^OOPS(2262,1,1,"B",STA,PIEN))
"RTN","OOPSGUI2",61,0)
 Q:+PIEN'>0
"RTN","OOPSGUI2",62,0)
 I $P($G(^OOPS(2262,1,1,PIEN,0)),U,2)'="" D
"RTN","OOPSGUI2",63,0)
 .S RESULTS(0)="1^Valid Results"
"RTN","OOPSGUI2",64,0)
 .S RESULTS(1)=$P($G(^OOPS(2262,1,1,PIEN,0)),U,2)
"RTN","OOPSGUI2",65,0)
 .S RESULTS(2)=$P($G(^OOPS(2262,1,1,PIEN,0)),U,3)
"RTN","OOPSGUI2",66,0)
 .S RESULTS(3)=$P($G(^OOPS(2262,1,1,PIEN,0)),U,4)
"RTN","OOPSGUI2",67,0)
 .S PSTA=$$FIND1^DIC(2262.03,",1,","Q",STA)
"RTN","OOPSGUI2",68,0)
 .I PSTA S PSTA=PSTA_",1," S RESULTS(4)=$$GET1^DIQ(2262.03,PSTA,"4:.01")
"RTN","OOPSGUI2",69,0)
 .S RESULTS(5)=$P($G(^OOPS(2262,1,1,PIEN,0)),U,6)
"RTN","OOPSGUI2",70,0)
 .S RESULTS(6)=$P($G(^OOPS(2262,1,1,PIEN,0)),U,7)
"RTN","OOPSGUI2",71,0)
 .S RESULTS(6)=$$EXTERNAL^DILFD(2262.03,6,"",RESULTS(6))
"RTN","OOPSGUI2",72,0)
 Q
"RTN","OOPSGUI2",73,0)
REPLWP(RESULTS,INPUT,DATA) ;
"RTN","OOPSGUI2",74,0)
 ;Replace Word Processing Fields
"RTN","OOPSGUI2",75,0)
 ;  Input:   INPUT - The file, field and IEN of record to WP field to
"RTN","OOPSGUI2",76,0)
 ;                   be changed in the format FILE^FIELD^IEN
"RTN","OOPSGUI2",77,0)
 ;  Input     DATA - List or pointer for data that is to replace the
"RTN","OOPSGUI2",78,0)
 ;                   existing WP data. 
"RTN","OOPSGUI2",79,0)
 ; Output: RESULTS - array with results or messages.
"RTN","OOPSGUI2",80,0)
 ; Retrieve file and field information.
"RTN","OOPSGUI2",81,0)
 N FILE,FIELD,IEN,ROOT,NODE,LINE,CNT,NEWTXT
"RTN","OOPSGUI2",82,0)
 S FILE=$P($G(INPUT),U),FIELD=$P($G(INPUT),U,2),IEN=$P($G(INPUT),U,3)
"RTN","OOPSGUI2",83,0)
 S ROOT=$$ROOT^DILFD(FILE,0,"GL")
"RTN","OOPSGUI2",84,0)
 S NODE=$$GET1^DID(FILE,FIELD,"","GLOBAL SUBSCRIPT LOCATION")
"RTN","OOPSGUI2",85,0)
 S NODE=$P(NODE,";",1)
"RTN","OOPSGUI2",86,0)
 ; Kill the existing WP data/node
"RTN","OOPSGUI2",87,0)
 K @(ROOT_"IEN,NODE)")
"RTN","OOPSGUI2",88,0)
 ; Insert the new data
"RTN","OOPSGUI2",89,0)
 S (LINE,CNT)=0
"RTN","OOPSGUI2",90,0)
 K NEWTXT
"RTN","OOPSGUI2",91,0)
 F  D  Q:+LINE'>0
"RTN","OOPSGUI2",92,0)
 .S LINE=$O(DATA(LINE)) Q:+LINE'>0  S CNT=LINE
"RTN","OOPSGUI2",93,0)
 .S NEWTXT=$G(DATA(LINE))
"RTN","OOPSGUI2",94,0)
 .S @(ROOT_"IEN,NODE,LINE,0)")=NEWTXT
"RTN","OOPSGUI2",95,0)
 S @(ROOT_"IEN,NODE,0)")="^^"_CNT_"^"_CNT_"^"_DT_"^^"
"RTN","OOPSGUI2",96,0)
 Q
"RTN","OOPSGUI2",97,0)
DTVALID(RESULTS,IDT,PDT,FLAG) ;Compare Date(s)/Time(s)
"RTN","OOPSGUI2",98,0)
 ;  Input IDT - This is the base date/time in external form
"RTN","OOPSGUI2",99,0)
 ;        PDT - This is the compare date/time in external form
"RTN","OOPSGUI2",100,0)
 ;       FLAG - -2 means PDT must be <  IDT (The DAY only)
"RTN","OOPSGUI2",101,0)
 ;       FLAG - -1 means PDT must be <  IDT (The DAY&TIME)
"RTN","OOPSGUI2",102,0)
 ;       FLAG -  1 means PDT must be >  IDT (The DAY&TIME)
"RTN","OOPSGUI2",103,0)
 ;       FLAG -  2 means PDT must be > IDT (The DAY only)
"RTN","OOPSGUI2",104,0)
 ;Output RESULTS - "VALID DATE" for valid, "DATE ERROR" for invalid
"RTN","OOPSGUI2",105,0)
 S FLAG=+$G(FLAG)
"RTN","OOPSGUI2",106,0)
 I FLAG="" S RESULTS(0)="FLAG ERROR" Q
"RTN","OOPSGUI2",107,0)
 I IDT="" S RESULTS(0)="DATE ERROR" Q
"RTN","OOPSGUI2",108,0)
 I PDT="" S RESULTS(0)="DATE ERROR" Q
"RTN","OOPSGUI2",109,0)
 S IDT=$$DTI^OOPSGUI2(IDT)
"RTN","OOPSGUI2",110,0)
 S PDT=$$DTI^OOPSGUI2(PDT)
"RTN","OOPSGUI2",111,0)
 I FLAG=-2 D
"RTN","OOPSGUI2",112,0)
 .S IDT=$P(IDT,"."),PDT=$P(PDT,".")
"RTN","OOPSGUI2",113,0)
 .I (PDT<IDT)!(PDT=IDT) S RESULTS(0)="VALID DATE" Q
"RTN","OOPSGUI2",114,0)
 .I PDT>IDT S RESULTS(0)="DATE ERROR" Q
"RTN","OOPSGUI2",115,0)
 I FLAG=-1 D
"RTN","OOPSGUI2",116,0)
 .I PDT<IDT S RESULTS(0)="VALID DATE" Q
"RTN","OOPSGUI2",117,0)
 .I (PDT>IDT)!(PDT=IDT) S RESULTS(0)="DATE ERROR" Q
"RTN","OOPSGUI2",118,0)
 I FLAG=0 D
"RTN","OOPSGUI2",119,0)
 .I PDT=IDT S RESULTS(0)="VALID DATE" Q
"RTN","OOPSGUI2",120,0)
 .I (PDT<IDT)!(PDT>IDT) S RESULTS(0)="DATE ERROR" Q
"RTN","OOPSGUI2",121,0)
 I FLAG=1 D
"RTN","OOPSGUI2",122,0)
 .I PDT>IDT S RESULTS(0)="VALID DATE" Q
"RTN","OOPSGUI2",123,0)
 .I (PDT<IDT)!(PDT=IDT) S RESULTS(0)="DATE ERROR" Q
"RTN","OOPSGUI2",124,0)
 I FLAG=2 D
"RTN","OOPSGUI2",125,0)
 .S IDT=$P(IDT,"."),PDT=$P(PDT,".")
"RTN","OOPSGUI2",126,0)
 .I (PDT>IDT)!(PDT=IDT) S RESULTS(0)="VALID DATE" Q
"RTN","OOPSGUI2",127,0)
 .I PDT<IDT S RESULTS(0)="DATE ERROR" Q
"RTN","OOPSGUI2",128,0)
 Q
"RTN","OOPSGUI2",129,0)
DTI(X) ;Convert and External date to an internal one
"RTN","OOPSGUI2",130,0)
 N Y,%DT
"RTN","OOPSGUI2",131,0)
 S %DT="T" D ^%DT
"RTN","OOPSGUI2",132,0)
 Q Y
"RTN","OOPSGUI2",133,0)
SETFIELD(RESULTS,INPUT,VALUE) ;Set a single field in file 2260
"RTN","OOPSGUI2",134,0)
 ;Input  - INPUT Contains the IEN of the record and the field number to
"RTN","OOPSGUI2",135,0)
 ;               be modified in the format IEN^FIELD
"RTN","OOPSGUI2",136,0)
 ;         VALUE This required parm is the external value to be used.
"RTN","OOPSGUI2",137,0)
 ;Output - RESULTS - status message of the file/set. 
"RTN","OOPSGUI2",138,0)
 N DA,DIE,DR,IEN,FLDNUM
"RTN","OOPSGUI2",139,0)
 S DR=""
"RTN","OOPSGUI2",140,0)
 S RESULTS(0)="UPDATE FAILED"
"RTN","OOPSGUI2",141,0)
 S IEN=$P($G(INPUT),U)
"RTN","OOPSGUI2",142,0)
 I '$G(IEN) Q
"RTN","OOPSGUI2",143,0)
 S FLDNUM=$P($G(INPUT),U,2)
"RTN","OOPSGUI2",144,0)
 I '$D(^OOPS(2260,IEN,0))!(FLDNUM="") Q
"RTN","OOPSGUI2",145,0)
 S DIE="^OOPS(2260,",DA=IEN
"RTN","OOPSGUI2",146,0)
 S DR(1,2260,1)=FLDNUM_"///^S X=VALUE"
"RTN","OOPSGUI2",147,0)
 D ^DIE
"RTN","OOPSGUI2",148,0)
 I $G(Y)="" D
"RTN","OOPSGUI2",149,0)
 . S RESULTS(0)="UPDATE COMPLETE"
"RTN","OOPSGUI2",150,0)
 . ; if setting field 71, need to send bulletin
"RTN","OOPSGUI2",151,0)
 . I FLDNUM=71,($$GET1^DIQ(2260,IEN,71,"I")'="Y") D WCPBOR^OOPSMBUL(IEN)
"RTN","OOPSGUI2",152,0)
 Q 
"RTN","OOPSGUI2",153,0)
ADDWITN(RESULTS,IEN,INFO,COMMENT) ;Add Witness info for IEN in 2260
"RTN","OOPSGUI2",154,0)
 ;  Input - IEN - IEN of case that needs witness info created. 
"RTN","OOPSGUI2",155,0)
 ;         INFO - Name, Street, City, State, Zip, Date of Witness in
"RTN","OOPSGUI2",156,0)
 ;                format, NAME^STREET^CITY^STATE^ZIP
"RTN","OOPSGUI2",157,0)
 ;      COMMENT - Witness Comment Text
"RTN","OOPSGUI2",158,0)
 ; Output - RESULTS Text indicating status of insert
"RTN","OOPSGUI2",159,0)
 N DR,DIE,DA,DIC,DD,DO,DLAYGO,INPUT,NAME,STREET,CITY,STATE,ZIP,WITDATE
"RTN","OOPSGUI2",160,0)
 S RESULTS(0)="WITNESS CREATION FAILED"
"RTN","OOPSGUI2",161,0)
 I '$G(IEN) Q
"RTN","OOPSGUI2",162,0)
 I '$D(^OOPS(2260,IEN,0)) Q
"RTN","OOPSGUI2",163,0)
 S DA(1)=IEN
"RTN","OOPSGUI2",164,0)
 S DLAYGO=2260,DIC="^OOPS(2260,"_DA(1)_",""CA1W"","
"RTN","OOPSGUI2",165,0)
 S DIC(0)="L"
"RTN","OOPSGUI2",166,0)
 S X=$P(INFO,U)
"RTN","OOPSGUI2",167,0)
 D FILE^DICN
"RTN","OOPSGUI2",168,0)
 S DA=+Y
"RTN","OOPSGUI2",169,0)
 S DIE="^OOPS(2260,"_DA(1)_",""CA1W"",",DR=""
"RTN","OOPSGUI2",170,0)
 I DA=-1 Q
"RTN","OOPSGUI2",171,0)
 S NAME=$P($G(INFO),U)
"RTN","OOPSGUI2",172,0)
 S STREET=$P($G(INFO),U,2)
"RTN","OOPSGUI2",173,0)
 S CITY=$P($G(INFO),U,3)
"RTN","OOPSGUI2",174,0)
 S STATE=$P($G(INFO),U,4)
"RTN","OOPSGUI2",175,0)
 S ZIP=$P($G(INFO),U,5)
"RTN","OOPSGUI2",176,0)
 S WITDATE=$P($G(INFO),U,6)
"RTN","OOPSGUI2",177,0)
 S DR(1,2260.0125,1)=".01///^S X=NAME"
"RTN","OOPSGUI2",178,0)
 S DR(1,2260.0125,2)="1///^S X=STREET"
"RTN","OOPSGUI2",179,0)
 S DR(1,2260.0125,3)="2///^S X=CITY"
"RTN","OOPSGUI2",180,0)
 S DR(1,2260.0125,4)="3///^S X=STATE"
"RTN","OOPSGUI2",181,0)
 S DR(1,2260.0125,5)="4///^S X=ZIP"
"RTN","OOPSGUI2",182,0)
 S DR(1,2260.0125,6)="5///^S X=WITDATE"
"RTN","OOPSGUI2",183,0)
 D ^DIE
"RTN","OOPSGUI2",184,0)
 S DR="6///^S X=COMMENT"
"RTN","OOPSGUI2",185,0)
 D ^DIE
"RTN","OOPSGUI2",186,0)
 S RESULTS(0)="WITNESS CREATION SUCCESSFUL"
"RTN","OOPSGUI2",187,0)
 Q
"RTN","OOPSGUI2",188,0)
DELWITN(RESULTS,INPUT) ;Deletes the Witness information for a claim
"RTN","OOPSGUI2",189,0)
 ;  Input - INPUT, this is the IEN for the case and the witness number 
"RTN","OOPSGUI2",190,0)
 ;          format IEN^witness number for the selected witness
"RTN","OOPSGUI2",191,0)
 ; Output - RESULTS - String indicating the status of the delete
"RTN","OOPSGUI2",192,0)
 N DA,DIK,IEN,WITNO
"RTN","OOPSGUI2",193,0)
 S RESULTS(0)="DELETION FAILED"
"RTN","OOPSGUI2",194,0)
 I INPUT="" Q
"RTN","OOPSGUI2",195,0)
 S IEN=$P($G(INPUT),U)
"RTN","OOPSGUI2",196,0)
 I '$G(IEN) Q
"RTN","OOPSGUI2",197,0)
 S WITNO=$P($G(INPUT),U,2)
"RTN","OOPSGUI2",198,0)
 I '$G(WITNO) Q
"RTN","OOPSGUI2",199,0)
 I '$D(^OOPS(2260,IEN,"CA1W",WITNO,0)) Q
"RTN","OOPSGUI2",200,0)
 S DA(1)=IEN
"RTN","OOPSGUI2",201,0)
 S DA=WITNO
"RTN","OOPSGUI2",202,0)
 S DIK="^OOPS(2260,"_DA(1)_",""CA1W"","
"RTN","OOPSGUI2",203,0)
 D ^DIK
"RTN","OOPSGUI2",204,0)
 I $G(Y)'="" D  Q 
"RTN","OOPSGUI2",205,0)
 .S RESULTS(0)="SUCCESSFULLY DELETED"
"RTN","OOPSGUI2",206,0)
 Q
"RTN","OOPSGUI2",207,0)
EDTWITN(RESULTS,INPUT,INFO,COMMENT) ;Update Witness Info for 2260 rec
"RTN","OOPSGUI2",208,0)
 ;  Input:INPUT - IEN and Witness Number in format IEN^WIT
"RTN","OOPSGUI2",209,0)
 ;        INFO  - Name, Street, City, State, Zip, Date of Witness in 
"RTN","OOPSGUI2",210,0)
 ;                format, NAME^STREET^CITY^STATE^ZIP
"RTN","OOPSGUI2",211,0)
 ;        COMMENT - Text of Witness comment
"RTN","OOPSGUI2",212,0)
 ; Output:RESULTS - String listing result of update. 
"RTN","OOPSGUI2",213,0)
 N DA,DIE,DR,NAME,STREET,CITY,STATE,ZIP,WITDATE,IEN,WITNO
"RTN","OOPSGUI2",214,0)
 S RESULTS(0)="EDIT FAILED"
"RTN","OOPSGUI2",215,0)
 S IEN=$P($G(INPUT),U)
"RTN","OOPSGUI2",216,0)
 S WITNO=$P($G(INPUT),U,2)
"RTN","OOPSGUI2",217,0)
 I '$D(^OOPS(2260,IEN,"CA1W",WITNO,0)) Q
"RTN","OOPSGUI2",218,0)
 S DA(1)=IEN,DR=""
"RTN","OOPSGUI2",219,0)
 S DA=WITNO
"RTN","OOPSGUI2",220,0)
 S DIE="^OOPS(2260,"_DA(1)_",""CA1W"","
"RTN","OOPSGUI2",221,0)
 S NAME=$P($G(INFO),U)
"RTN","OOPSGUI2",222,0)
 S STREET=$P($G(INFO),U,2)
"RTN","OOPSGUI2",223,0)
 S CITY=$P($G(INFO),U,3)
"RTN","OOPSGUI2",224,0)
 S STATE=$P($G(INFO),U,4)
"RTN","OOPSGUI2",225,0)
 S ZIP=$P($G(INFO),U,5)
"RTN","OOPSGUI2",226,0)
 S WITDATE=$P($G(INFO),U,6)
"RTN","OOPSGUI2",227,0)
 S DR(1,2260.0125,1)=".01///^S X=NAME"
"RTN","OOPSGUI2",228,0)
 S DR(1,2260.0125,2)="1///^S X=STREET"
"RTN","OOPSGUI2",229,0)
 S DR(1,2260.0125,3)="2///^S X=CITY"
"RTN","OOPSGUI2",230,0)
 S DR(1,2260.0125,4)="3///^S X=STATE"
"RTN","OOPSGUI2",231,0)
 S DR(1,2260.0125,5)="4///^S X=ZIP"
"RTN","OOPSGUI2",232,0)
 S DR(1,2260.0125,6)="5///^S X=WITDATE"
"RTN","OOPSGUI2",233,0)
 D ^DIE
"RTN","OOPSGUI2",234,0)
 S DR="6///^S X=COMMENT"
"RTN","OOPSGUI2",235,0)
 D ^DIE
"RTN","OOPSGUI2",236,0)
 S RESULTS(0)="EDIT SUCCESSFULL"
"RTN","OOPSGUI2",237,0)
 Q
"RTN","OOPSGUI5")
0^3^B60121235
"RTN","OOPSGUI5",1,0)
OOPSGUI5 ;WIOFO/CVW-RPC routines ;10/11/01
"RTN","OOPSGUI5",2,0)
 ;;2.0;ASISTS;**2**;Jun 03, 2002
"RTN","OOPSGUI5",3,0)
 ;
"RTN","OOPSGUI5",4,0)
EDIT(RESULTS,INPUT,ARR) ;
"RTN","OOPSGUI5",5,0)
 ; 
"RTN","OOPSGUI5",6,0)
 ;  Input:    INPUT - IEN^FORM where IEN = ASISTS IEN and 
"RTN","OOPSGUI5",7,0)
 ;                    FORM = Either "CA1","CA2" or "2162"
"RTN","OOPSGUI5",8,0)
 ;         SENDPARM - Array containing the data from Delphi that will
"RTN","OOPSGUI5",9,0)
 ;                    saved into Asists File 2260. 
"RTN","OOPSGUI5",10,0)
 ; Output:  RESULTS - Array containing the results of the store/save.
"RTN","OOPSGUI5",11,0)
 N IEN,FORM,DIE,DA,DR
"RTN","OOPSGUI5",12,0)
 S IEN=+$G(INPUT),FORM=$P($G(INPUT),U,2)
"RTN","OOPSGUI5",13,0)
 I '$D(^OOPS(2260,$G(IEN),0)) D  Q
"RTN","OOPSGUI5",14,0)
 . S (RESULTS,RESULTS(1))="-1^IEN:"_IEN_" not found in file 2260"
"RTN","OOPSGUI5",15,0)
 I "CA1^CA2^2162"'[FORM!(FORM="") D  Q
"RTN","OOPSGUI5",16,0)
 . S (RESULTS,RESULTS(1))="-2^FORM:"_FORM_" not valid, must be CA1,CA2, or 2162"
"RTN","OOPSGUI5",17,0)
 S RESULTS(1)="UPDATE FAILED"
"RTN","OOPSGUI5",18,0)
 I FORM="CA1" D SAVECA1
"RTN","OOPSGUI5",19,0)
 I FORM="CA2" D SAVECA2
"RTN","OOPSGUI5",20,0)
 I FORM="2162" D SAVE2162
"RTN","OOPSGUI5",21,0)
 Q
"RTN","OOPSGUI5",22,0)
SAVECA1 ;
"RTN","OOPSGUI5",23,0)
 K DR S DIE="^OOPS(2260,",DA=IEN,DR=""
"RTN","OOPSGUI5",24,0)
 S DR(1,2260,1)="53////^S X=ARR(7)"   ;sending ptr, avoid ambiguity
"RTN","OOPSGUI5",25,0)
 S DR(1,2260,2)="53.1////^S X=ARR(8)" ;sending ptr, avoid ambiguity
"RTN","OOPSGUI5",26,0)
 S DR(1,2260,3)="60///^S X=ARR(14)"
"RTN","OOPSGUI5",27,0)
 S DR(1,2260,4)="61///^S X=ARR(15)"
"RTN","OOPSGUI5",28,0)
 S DR(1,2260,5)="62////^S X=ARR(16)"   ; sending ptr, avoid ambiguity
"RTN","OOPSGUI5",29,0)
 S DR(1,2260,6)="70///^S X=ARR(22)"
"RTN","OOPSGUI5",30,0)
 S DR(1,2260,7)="73///^S X=ARR(25)"
"RTN","OOPSGUI5",31,0)
 S DR(1,2260,8)="12///^S X=ARR(36)"
"RTN","OOPSGUI5",32,0)
 S DR(1,2260,11)="8///^S X=ARR(39)"
"RTN","OOPSGUI5",33,0)
 S DR(1,2260,12)="9///^S X=ARR(40)"
"RTN","OOPSGUI5",34,0)
 S DR(1,2260,13)="10///^S X=ARR(41)"
"RTN","OOPSGUI5",35,0)
 S DR(1,2260,14)="11///^S X=ARR(42)"
"RTN","OOPSGUI5",36,0)
 S DR(1,2260,15)="107///^S X=ARR(43)"
"RTN","OOPSGUI5",37,0)
 S DR(1,2260,16)="108///^S X=ARR(44)"
"RTN","OOPSGUI5",38,0)
 S DR(1,2260,17)="109///^S X=ARR(45)"
"RTN","OOPSGUI5",39,0)
 S DR(1,2260,18)="110///^S X=ARR(46)"
"RTN","OOPSGUI5",40,0)
 S DR(1,2260,19)="111///^S X=ARR(47)"
"RTN","OOPSGUI5",41,0)
 S DR(1,2260,20)="112///^S X=ARR(48)"
"RTN","OOPSGUI5",42,0)
 S DR(1,2260,21)="113///^S X=ARR(49)"
"RTN","OOPSGUI5",43,0)
 S DR(1,2260,22)="114///^S X=ARR(50)"
"RTN","OOPSGUI5",44,0)
 S DR(1,2260,24)="123///^S X=ARR(60)"
"RTN","OOPSGUI5",45,0)
 S DR(1,2260,25)="124///^S X=ARR(61)"
"RTN","OOPSGUI5",46,0)
 S DR(1,2260,26)="126///^S X=ARR(62)"
"RTN","OOPSGUI5",47,0)
 S DR(1,2260,27)="130///^S X=ARR(63)"
"RTN","OOPSGUI5",48,0)
 S DR(1,2260,28)="131///^S X=ARR(64)"
"RTN","OOPSGUI5",49,0)
 S DR(1,2260,29)="132///^S X=ARR(65)"
"RTN","OOPSGUI5",50,0)
 S DR(1,2260,30)="133///^S X=ARR(66)"
"RTN","OOPSGUI5",51,0)
 S DR(1,2260,31)="134///^S X=ARR(67)"
"RTN","OOPSGUI5",52,0)
 S DR(1,2260,32)="138///^S X=ARR(70)"
"RTN","OOPSGUI5",53,0)
 S DR(1,2260,33)="139///^S X=ARR(71)"
"RTN","OOPSGUI5",54,0)
 S DR(1,2260,34)="140///^S X=ARR(72)"
"RTN","OOPSGUI5",55,0)
 S DR(1,2260,35)="141///^S X=ARR(73)"
"RTN","OOPSGUI5",56,0)
 S DR(1,2260,36)="142///^S X=ARR(74)"
"RTN","OOPSGUI5",57,0)
 D ^DIE
"RTN","OOPSGUI5",58,0)
 I '($D(Y)=0) Q
"RTN","OOPSGUI5",59,0)
 K DR S DIE="^OOPS(2260,",DA=IEN,DR=""
"RTN","OOPSGUI5",60,0)
 S DR(1,2260,37)="143///^S X=ARR(75)"
"RTN","OOPSGUI5",61,0)
 S DR(1,2260,38)="144///^S X=ARR(76)"
"RTN","OOPSGUI5",62,0)
 S DR(1,2260,39)="145///^S X=ARR(77)"
"RTN","OOPSGUI5",63,0)
 S DR(1,2260,40)="146///^S X=ARR(78)"
"RTN","OOPSGUI5",64,0)
 S DR(1,2260,41)="147///^S X=ARR(79)"
"RTN","OOPSGUI5",65,0)
 S DR(1,2260,42)="148///^S X=ARR(80)"
"RTN","OOPSGUI5",66,0)
 S DR(1,2260,43)="149///^S X=ARR(81)"
"RTN","OOPSGUI5",67,0)
 S DR(1,2260,44)="150///^S X=ARR(82)"
"RTN","OOPSGUI5",68,0)
 S DR(1,2260,45)="151///^S X=ARR(83)"
"RTN","OOPSGUI5",69,0)
 S DR(1,2260,46)="152///^S X=ARR(84)"
"RTN","OOPSGUI5",70,0)
 S DR(1,2260,47)="153///^S X=ARR(85)"
"RTN","OOPSGUI5",71,0)
 S DR(1,2260,48)="154///^S X=ARR(86)"
"RTN","OOPSGUI5",72,0)
 S DR(1,2260,49)="155///^S X=ARR(87)"
"RTN","OOPSGUI5",73,0)
 S DR(1,2260,50)="156///^S X=ARR(88)"
"RTN","OOPSGUI5",74,0)
 S DR(1,2260,51)="157///^S X=ARR(89)"
"RTN","OOPSGUI5",75,0)
 S DR(1,2260,52)="158///^S X=ARR(90)"
"RTN","OOPSGUI5",76,0)
 S DR(1,2260,53)="159///^S X=ARR(91)"
"RTN","OOPSGUI5",77,0)
 S DR(1,2260,54)="160///^S X=ARR(92)"
"RTN","OOPSGUI5",78,0)
 S DR(1,2260,55)="161///^S X=ARR(93)"
"RTN","OOPSGUI5",79,0)
 S DR(1,2260,56)="162///^S X=ARR(94)"
"RTN","OOPSGUI5",80,0)
 S DR(1,2260,57)="163///^S X=ARR(95)"
"RTN","OOPSGUI5",81,0)
 S DR(1,2260,58)="165.1///^S X=ARR(96)"
"RTN","OOPSGUI5",82,0)
 S DR(1,2260,59)="165.2///^S X=ARR(97)"
"RTN","OOPSGUI5",83,0)
 S DR(1,2260,60)="166///^S X=ARR(98)"
"RTN","OOPSGUI5",84,0)
 S DR(1,2260,61)="167///^S X=ARR(99)"
"RTN","OOPSGUI5",85,0)
 S DR(1,2260,62)="168///^S X=ARR(100)"
"RTN","OOPSGUI5",86,0)
 S DR(1,2260,63)="172///^S X=ARR(104)"
"RTN","OOPSGUI5",87,0)
 S DR(1,2260,64)="173///^S X=ARR(105)"
"RTN","OOPSGUI5",88,0)
 S DR(1,2260,65)="173.1///^S X=ARR(106)"
"RTN","OOPSGUI5",89,0)
 S DR(1,2260,66)="174///^S X=ARR(107)"
"RTN","OOPSGUI5",90,0)
 S DR(1,2260,67)="175///^S X=ARR(108)"
"RTN","OOPSGUI5",91,0)
 S DR(1,2260,68)="176///^S X=ARR(109)"
"RTN","OOPSGUI5",92,0)
 S DR(1,2260,69)="177///^S X=ARR(110)"
"RTN","OOPSGUI5",93,0)
 S DR(1,2260,70)="178///^S X=ARR(111)"
"RTN","OOPSGUI5",94,0)
 S DR(1,2260,71)="179///^S X=ARR(112)"
"RTN","OOPSGUI5",95,0)
 S DR(1,2260,72)="180///^S X=ARR(113)"
"RTN","OOPSGUI5",96,0)
 S DR(1,2260,73)="181///^S X=ARR(114)"
"RTN","OOPSGUI5",97,0)
 S DR(1,2260,74)="182///^S X=ARR(115)"
"RTN","OOPSGUI5",98,0)
 S DR(1,2260,75)="183///^S X=ARR(116)"
"RTN","OOPSGUI5",99,0)
 S DR(1,2260,76)="184///^S X=ARR(117)"
"RTN","OOPSGUI5",100,0)
 S DR(1,2260,77)="185///^S X=ARR(118)"
"RTN","OOPSGUI5",101,0)
 D ^DIE
"RTN","OOPSGUI5",102,0)
 ;Check the return of ^DIE
"RTN","OOPSGUI5",103,0)
 I $D(Y)=0 S RESULTS(1)="UPDATE COMPLETED"
"RTN","OOPSGUI5",104,0)
 Q
"RTN","OOPSGUI5",105,0)
SAVECA2 ;
"RTN","OOPSGUI5",106,0)
 K DR S DIE="^OOPS(2260,",DA=IEN,DR=""
"RTN","OOPSGUI5",107,0)
 S DR(1,2260,1)="60///^S X=ARR(14)"
"RTN","OOPSGUI5",108,0)
 S DR(1,2260,5)="61///^S X=ARR(15)"
"RTN","OOPSGUI5",109,0)
 S DR(1,2260,7)="62////^S X=ARR(16)"   ; sending ptr, avoid ambiguity
"RTN","OOPSGUI5",110,0)
 S DR(1,2260,10)="70///^S X=ARR(22)"
"RTN","OOPSGUI5",111,0)
 S DR(1,2260,15)="73///^S X=ARR(25)"
"RTN","OOPSGUI5",112,0)
 S DR(1,2260,20)="12///^S X=ARR(38)"
"RTN","OOPSGUI5",113,0)
 S DR(1,2260,25)="8///^S X=ARR(41)"
"RTN","OOPSGUI5",114,0)
 S DR(1,2260,30)="9///^S X=ARR(42)"
"RTN","OOPSGUI5",115,0)
 S DR(1,2260,35)="10///^S X=ARR(43)"
"RTN","OOPSGUI5",116,0)
 S DR(1,2260,40)="11///^S X=ARR(44)"
"RTN","OOPSGUI5",117,0)
 S DR(1,2260,41)="126///^S X=ARR(36)"
"RTN","OOPSGUI5",118,0)
 S DR(1,2260,45)="207///^S X=ARR(45)"
"RTN","OOPSGUI5",119,0)
 S DR(1,2260,50)="208///^S X=ARR(46)"
"RTN","OOPSGUI5",120,0)
 S DR(1,2260,55)="209///^S X=ARR(47)"
"RTN","OOPSGUI5",121,0)
 S DR(1,2260,60)="210///^S X=ARR(48)"
"RTN","OOPSGUI5",122,0)
 S DR(1,2260,65)="211///^S X=ARR(49)"
"RTN","OOPSGUI5",123,0)
 S DR(1,2260,70)="212///^S X=ARR(50)"
"RTN","OOPSGUI5",124,0)
 S DR(1,2260,75)="213///^S X=ARR(51)"
"RTN","OOPSGUI5",125,0)
 S DR(1,2260,80)="214///^S X=ARR(52)"
"RTN","OOPSGUI5",126,0)
 D ^DIE
"RTN","OOPSGUI5",127,0)
 I '($D(Y)=0) Q
"RTN","OOPSGUI5",128,0)
 K DR S DIE="^OOPS(2260,",DA=IEN,DR=""
"RTN","OOPSGUI5",129,0)
 S DR(1,2260,85)="215///^S X=ARR(53)"
"RTN","OOPSGUI5",130,0)
 S DR(1,2260,90)="225///^S X=ARR(57)"
"RTN","OOPSGUI5",131,0)
 S DR(1,2260,95)="226///^S X=ARR(58)"
"RTN","OOPSGUI5",132,0)
 S DR(1,2260,100)="227///^S X=ARR(59)"
"RTN","OOPSGUI5",133,0)
 S DR(1,2260,105)="230///^S X=ARR(60)"
"RTN","OOPSGUI5",134,0)
 S DR(1,2260,110)="231///^S X=ARR(61)"
"RTN","OOPSGUI5",135,0)
 S DR(1,2260,115)="232///^S X=ARR(62)"
"RTN","OOPSGUI5",136,0)
 S DR(1,2260,120)="233///^S X=ARR(63)"
"RTN","OOPSGUI5",137,0)
 S DR(1,2260,125)="234///^S X=ARR(64)"
"RTN","OOPSGUI5",138,0)
 S DR(1,2260,130)="237///^S X=ARR(67)"
"RTN","OOPSGUI5",139,0)
 S DR(1,2260,135)="238///^S X=ARR(68)"
"RTN","OOPSGUI5",140,0)
 S DR(1,2260,140)="239///^S X=ARR(69)"
"RTN","OOPSGUI5",141,0)
 S DR(1,2260,145)="240///^S X=ARR(70)"
"RTN","OOPSGUI5",142,0)
 S DR(1,2260,150)="241///^S X=ARR(71)"
"RTN","OOPSGUI5",143,0)
 S DR(1,2260,155)="242///^S X=ARR(72)"
"RTN","OOPSGUI5",144,0)
 S DR(1,2260,160)="243///^S X=ARR(73)"
"RTN","OOPSGUI5",145,0)
 S DR(1,2260,165)="244///^S X=ARR(74)"
"RTN","OOPSGUI5",146,0)
 S DR(1,2260,170)="245///^S X=ARR(75)"
"RTN","OOPSGUI5",147,0)
 S DR(1,2260,175)="246///^S X=ARR(76)"
"RTN","OOPSGUI5",148,0)
 S DR(1,2260,180)="247///^S X=ARR(77)"
"RTN","OOPSGUI5",149,0)
 S DR(1,2260,185)="248///^S X=ARR(78)"
"RTN","OOPSGUI5",150,0)
 S DR(1,2260,190)="249///^S X=ARR(79)"
"RTN","OOPSGUI5",151,0)
 S DR(1,2260,192)="250///^S X=ARR(80)"
"RTN","OOPSGUI5",152,0)
 S DR(1,2260,195)="251///^S X=ARR(81)"
"RTN","OOPSGUI5",153,0)
 S DR(1,2260,200)="252///^S X=ARR(82)"
"RTN","OOPSGUI5",154,0)
 S DR(1,2260,205)="253///^S X=ARR(83)"
"RTN","OOPSGUI5",155,0)
 D ^DIE
"RTN","OOPSGUI5",156,0)
 I '($D(Y)=0) Q
"RTN","OOPSGUI5",157,0)
 K DR S DIE="^OOPS(2260,",DA=IEN,DR=""
"RTN","OOPSGUI5",158,0)
 S DR(1,2260,210)="254///^S X=ARR(84)"
"RTN","OOPSGUI5",159,0)
 S DR(1,2260,215)="255///^S X=ARR(85)"
"RTN","OOPSGUI5",160,0)
 S DR(1,2260,220)="256///^S X=ARR(86)"
"RTN","OOPSGUI5",161,0)
 S DR(1,2260,225)="258///^S X=ARR(87)"
"RTN","OOPSGUI5",162,0)
 S DR(1,2260,230)="259///^S X=ARR(88)"
"RTN","OOPSGUI5",163,0)
 S DR(1,2260,235)="260///^S X=ARR(89)"
"RTN","OOPSGUI5",164,0)
 S DR(1,2260,240)="261///^S X=ARR(90)"
"RTN","OOPSGUI5",165,0)
 S DR(1,2260,245)="262///^S X=ARR(91)"
"RTN","OOPSGUI5",166,0)
 S DR(1,2260,250)="263///^S X=ARR(92)"
"RTN","OOPSGUI5",167,0)
 S DR(1,2260,255)="264///^S X=ARR(93)"
"RTN","OOPSGUI5",168,0)
 S DR(1,2260,260)="268///^S X=ARR(97)"
"RTN","OOPSGUI5",169,0)
 S DR(1,2260,265)="269///^S X=ARR(98)"
"RTN","OOPSGUI5",170,0)
 S DR(1,2260,270)="269.1///^S X=ARR(99)"
"RTN","OOPSGUI5",171,0)
 S DR(1,2260,275)="270///^S X=ARR(100)"
"RTN","OOPSGUI5",172,0)
 D ^DIE
"RTN","OOPSGUI5",173,0)
 ;Check the return of ^DIE
"RTN","OOPSGUI5",174,0)
 I $D(Y)=0 S RESULTS(1)="UPDATE COMPLETED"
"RTN","OOPSGUI5",175,0)
 Q
"RTN","OOPSGUI5",176,0)
SAVE2162 ;
"RTN","OOPSGUI5",177,0)
 K DR S DIE="^OOPS(2260,",DA=IEN,DR=""
"RTN","OOPSGUI5",178,0)
 S DR(1,2260,1)="3///^S X=ARR(3)"
"RTN","OOPSGUI5",179,0)
 S DR(1,2260,2)="5///^S X=ARR(5)"
"RTN","OOPSGUI5",180,0)
 S DR(1,2260,3)="6///^S X=ARR(6)"
"RTN","OOPSGUI5",181,0)
 S DR(1,2260,4)="7///^S X=ARR(7)"
"RTN","OOPSGUI5",182,0)
 S DR(1,2260,5)="8///^S X=ARR(8)"
"RTN","OOPSGUI5",183,0)
 S DR(1,2260,7)="9///^S X=ARR(9)"
"RTN","OOPSGUI5",184,0)
 S DR(1,2260,9)="10///^S X=ARR(10)"
"RTN","OOPSGUI5",185,0)
 S DR(1,2260,12)="11///^S X=ARR(11)"
"RTN","OOPSGUI5",186,0)
 S DR(1,2260,15)="12///^S X=ARR(12)"
"RTN","OOPSGUI5",187,0)
 S DR(1,2260,18)="13////^S X=ARR(13)"     ; sending pointer
"RTN","OOPSGUI5",188,0)
 S DR(1,2260,21)="14///^S X=ARR(14)"
"RTN","OOPSGUI5",189,0)
 S DR(1,2260,24)="15///^S X=ARR(15)"
"RTN","OOPSGUI5",190,0)
 S DR(1,2260,27)="16///^S X=ARR(16)"
"RTN","OOPSGUI5",191,0)
 S DR(1,2260,30)="17///^S X=ARR(17)"
"RTN","OOPSGUI5",192,0)
 S DR(1,2260,33)="18///^S X=ARR(18)"
"RTN","OOPSGUI5",193,0)
 S DR(1,2260,36)="26///^S X=ARR(19)"
"RTN","OOPSGUI5",194,0)
 ; need to avoid filter in data dic, so sending ptr, 4 / stuff - llh
"RTN","OOPSGUI5",195,0)
 S DR(1,2260,39)="27////^S X=ARR(20)"
"RTN","OOPSGUI5",196,0)
 S DR(1,2260,42)="29///^S X=ARR(21)"
"RTN","OOPSGUI5",197,0)
 S DR(1,2260,45)="29.5///^S X=ARR(22)"
"RTN","OOPSGUI5",198,0)
 S DR(1,2260,48)="30///^S X=ARR(23)"
"RTN","OOPSGUI5",199,0)
 S DR(1,2260,51)="30.1///^S X=ARR(24)"
"RTN","OOPSGUI5",200,0)
 S DR(1,2260,54)="31///^S X=ARR(25)"
"RTN","OOPSGUI5",201,0)
 S DR(1,2260,57)="32///^S X=ARR(26)"
"RTN","OOPSGUI5",202,0)
 S DR(1,2260,60)="33///^S X=ARR(27)"
"RTN","OOPSGUI5",203,0)
 S DR(1,2260,63)="34///^S X=ARR(28)"
"RTN","OOPSGUI5",204,0)
 S DR(1,2260,66)="35///^S X=ARR(29)"
"RTN","OOPSGUI5",205,0)
 S DR(1,2260,69)="36///^S X=ARR(30)"
"RTN","OOPSGUI5",206,0)
 S DR(1,2260,72)="37///^S X=ARR(31)"
"RTN","OOPSGUI5",207,0)
 S DR(1,2260,75)="38///^S X=ARR(32)"
"RTN","OOPSGUI5",208,0)
 S DR(1,2260,78)="41///^S X=ARR(33)"
"RTN","OOPSGUI5",209,0)
 S DR(1,2260,81)="42///^S X=ARR(34)"
"RTN","OOPSGUI5",210,0)
 S DR(1,2260,84)="42.5///^S X=ARR(35)"
"RTN","OOPSGUI5",211,0)
 S DR(1,2260,87)="43///^S X=ARR(36)"
"RTN","OOPSGUI5",212,0)
 S DR(1,2260,90)="53////^S X=ARR(45)"
"RTN","OOPSGUI5",213,0)
 S DR(1,2260,93)="53.1////^S X=ARR(46)"
"RTN","OOPSGUI5",214,0)
 S DR(1,2260,96)="60///^S X=ARR(52)"
"RTN","OOPSGUI5",215,0)
 S DR(1,2260,99)="61///^S X=ARR(53)"
"RTN","OOPSGUI5",216,0)
 S DR(1,2260,102)="62///^S X=ARR(54)"
"RTN","OOPSGUI5",217,0)
 S DR(1,2260,105)="63///^S X=ARR(55)"
"RTN","OOPSGUI5",218,0)
 S DR(1,2260,108)="70///^S X=ARR(60)"
"RTN","OOPSGUI5",219,0)
 S DR(1,2260,111)="73///^S X=ARR(63)"
"RTN","OOPSGUI5",220,0)
 S DR(1,2260,114)="82///^S X=ARR(72)"
"RTN","OOPSGUI5",221,0)
 S DR(1,2260,117)="83////^S X=ARR(73)"      ; sending ptr, 4/ stuff
"RTN","OOPSGUI5",222,0)
 S DR(1,2260,120)="84///^S X=ARR(74)"
"RTN","OOPSGUI5",223,0)
 S DR(1,2260,123)="85///^S X=ARR(75)"
"RTN","OOPSGUI5",224,0)
 S DR(1,2260,126)="86///^S X=ARR(76)"
"RTN","OOPSGUI5",225,0)
 S DR(1,2260,129)="87///^S X=ARR(77)"
"RTN","OOPSGUI5",226,0)
 S DR(1,2260,132)="88///^S X=ARR(78)"
"RTN","OOPSGUI5",227,0)
 S DR(1,2260,135)="89///^S X=ARR(79)"
"RTN","OOPSGUI5",228,0)
 D ^DIE
"RTN","OOPSGUI5",229,0)
 ;Check the return of ^DIE
"RTN","OOPSGUI5",230,0)
 I $D(Y)=0 S RESULTS(1)="UPDATE COMPLETED"
"RTN","OOPSGUI5",231,0)
 Q
"RTN","OOPSGUI7")
0^4^B31875168
"RTN","OOPSGUI7",1,0)
OOPSGUI7 ;WIOFO/LLH-RPC routines ;10/30/01
"RTN","OOPSGUI7",2,0)
 ;;2.0;ASISTS;**2**;Jun 03, 2002
"RTN","OOPSGUI7",3,0)
 ;
"RTN","OOPSGUI7",4,0)
ENT(RESULTS,INPUT) ; Non-interactive GUI Entry Point for transmitting data
"RTN","OOPSGUI7",5,0)
 ;                 to DOL or NDB
"RTN","OOPSGUI7",6,0)
 ;  Input:   INPUT  - Contains the date for the claims to be
"RTN","OOPSGUI7",7,0)
 ;                    retransmited, the queue date and time for the
"RTN","OOPSGUI7",8,0)
 ;                    retransmission date to run and either DOL or NDB
"RTN","OOPSGUI7",9,0)
 ;                    to indicate which manual transmisssion should run.
"RTN","OOPSGUI7",10,0)
 ;                    The format is TRANSDT^QUEUEDT@TIME^DOL (or NDB)
"RTN","OOPSGUI7",11,0)
 ; Output: RESULTS -  is the return array to the client with status
"RTN","OOPSGUI7",12,0)
 ;                    message
"RTN","OOPSGUI7",13,0)
 N ARR,COMMA,ERR1,ERR2,FIELD,FL,MAILG,CURR,QDATE,QUE,RDATE,RTN,X,Y
"RTN","OOPSGUI7",14,0)
 N MAN,WOK,ZTDESC,ZTREQ,ZTRTN
"RTN","OOPSGUI7",15,0)
 S RTN=$P($G(INPUT),U,3)
"RTN","OOPSGUI7",16,0)
 S MAN=1                       ; force manual xmit flag
"RTN","OOPSGUI7",17,0)
 I RTN="DOL" D
"RTN","OOPSGUI7",18,0)
 . S MAILG="OOPS DOL XMIT DATA"
"RTN","OOPSGUI7",19,0)
 . S QUE="Q-AST.MED.VA.GOV"
"RTN","OOPSGUI7",20,0)
 I RTN="NDB" D
"RTN","OOPSGUI7",21,0)
 . S MAILG="OOPS XMIT 2162 DATA"
"RTN","OOPSGUI7",22,0)
 . S QUE="Q-ASI.MED.VA.GOV"
"RTN","OOPSGUI7",23,0)
 ;Check for security keys
"RTN","OOPSGUI7",24,0)
 I '$D(^XUSEC(MAILG,DUZ)) D  Q
"RTN","OOPSGUI7",25,0)
 .S RESULTS(0)="ERROR"
"RTN","OOPSGUI7",26,0)
 .S RESULTS(1)="You do not have the required Security Key."
"RTN","OOPSGUI7",27,0)
 ;Assure the Queue has been defined
"RTN","OOPSGUI7",28,0)
 S FIELD=.01,FL="X"
"RTN","OOPSGUI7",29,0)
 D FIND^DIC(4.2,"",FIELD,FL,QUE,"","","","","ARR")
"RTN","OOPSGUI7",30,0)
 I '$D(ARR("DILIST",1)) D  Q
"RTN","OOPSGUI7",31,0)
 .S RESULTS(0)="ERROR"
"RTN","OOPSGUI7",32,0)
 .S RESULTS(1)="Domain not found in the DOMAIN File,"
"RTN","OOPSGUI7",33,0)
 ; Get Retransmit Date from First Piece of Input & Translate into FM
"RTN","OOPSGUI7",34,0)
 S X=$P($G(INPUT),U) D ^%DT
"RTN","OOPSGUI7",35,0)
 S RDATE=Y
"RTN","OOPSGUI7",36,0)
 I RDATE=-1 S ERR1=1
"RTN","OOPSGUI7",37,0)
 S %DT="R",X=$P($G(INPUT),U,2) D ^%DT K %DT
"RTN","OOPSGUI7",38,0)
 S QDATE=Y
"RTN","OOPSGUI7",39,0)
 I QDATE=-1 S ERR2=2
"RTN","OOPSGUI7",40,0)
 I $G(ERR1)!($G(ERR2)) D  Q
"RTN","OOPSGUI7",41,0)
 . S RESULTS(0)="ERROR",RESULTS(1)="",COMMA=""
"RTN","OOPSGUI7",42,0)
 . S:$G(ERR1) RESULTS(1)="Invalid Transmission Date",COMMA=", "
"RTN","OOPSGUI7",43,0)
 . S:$G(ERR2) RESULTS(1)=RESULTS(1)_COMMA_"Invalid Queue Date."
"RTN","OOPSGUI7",44,0)
 ;
"RTN","OOPSGUI7",45,0)
 I RTN="DOL" D
"RTN","OOPSGUI7",46,0)
 . S ZTRTN="EN^OOPSDOL",WOK=1,ZTDESC="TRANSMIT DOL CA1/CA2 DATA"
"RTN","OOPSGUI7",47,0)
 I RTN="NDB" D
"RTN","OOPSGUI7",48,0)
 . S ZTRTN="EN^OOPSNDB",ZTDESC="TRANSMIT NATIONAL DATABASE 2162 DATA"
"RTN","OOPSGUI7",49,0)
 ; Make sure Queue date/time is not after current time
"RTN","OOPSGUI7",50,0)
 S CURR=$$HTFM^XLFDT(""_$H_"")
"RTN","OOPSGUI7",51,0)
 I $$FMDIFF^XLFDT(QDATE,CURR,2)<0 S QDATE=$H
"RTN","OOPSGUI7",52,0)
 ; Report will always be Queued from the GUI
"RTN","OOPSGUI7",53,0)
 K IO("Q"),ZTUCI,ZTDTH,ZTIO,ZTSAVE
"RTN","OOPSGUI7",54,0)
 S ZTDTH=QDATE,ZTIO="",ZTREQ="@",ZTSAVE("ZTREQ")=""
"RTN","OOPSGUI7",55,0)
 S ZTSAVE("RDATE")="",ZTSAVE("MAN")=""
"RTN","OOPSGUI7",56,0)
 D ^%ZTLOAD
"RTN","OOPSGUI7",57,0)
 K ZTSK
"RTN","OOPSGUI7",58,0)
 S RESULTS(0)="SUCCESSFULLY QUEUED"
"RTN","OOPSGUI7",59,0)
 Q
"RTN","OOPSGUI7",60,0)
OWCPCLR(RESULTS,IEN,CALLER,FORM) ; Entry point for clearing supervisor
"RTN","OOPSGUI7",61,0)
 ;   fields if OWPC worker has edited them
"RTN","OOPSGUI7",62,0)
 ;  Input:     IEN - ien of case to have the fields cleared
"RTN","OOPSGUI7",63,0)
 ;          CALLER - menu being called from
"RTN","OOPSGUI7",64,0)
 ;            FORM - whether a CA1 or CA2
"RTN","OOPSGUI7",65,0)
 ; Output: RESULTS - required results parameter, no data returned
"RTN","OOPSGUI7",66,0)
 ;                   from this call
"RTN","OOPSGUI7",67,0)
 I $G(IEN)=""!($G(CALLER)="")!($G(FORM)="") Q
"RTN","OOPSGUI7",68,0)
 D CLRFLDS^OOPSWCE
"RTN","OOPSGUI7",69,0)
SUPFLDS ; Clear Supervisor fields for the CA1, since fields have been changed
"RTN","OOPSGUI7",70,0)
 I FORM'="CA1" Q
"RTN","OOPSGUI7",71,0)
 N SUP
"RTN","OOPSGUI7",72,0)
 S SUP=$$GET1^DIQ(200,DUZ,.01)
"RTN","OOPSGUI7",73,0)
 S RESULTS=SUP
"RTN","OOPSGUI7",74,0)
 S $P(^OOPS(2260,IEN,"CA1L"),U,3)=""     ;Clear EXCEPTION 
"RTN","OOPSGUI7",75,0)
 S $P(^OOPS(2260,IEN,"CA1L"),U,4)=""     ;Clear SUP TITLE
"RTN","OOPSGUI7",76,0)
 S $P(^OOPS(2260,IEN,"CA1L"),U,5)=""     ;Clear SUP PHONE
"RTN","OOPSGUI7",77,0)
 Q
"RTN","OOPSGUI7",78,0)
CONSENT(RESULTS,IEN,UNIREP)     ; Employee consented to union notification,
"RTN","OOPSGUI7",79,0)
 ;                 send msg to union
"RTN","OOPSGUI7",80,0)
 ; Input
"RTN","OOPSGUI7",81,0)
 ;    IEN - Internal record number
"RTN","OOPSGUI7",82,0)
 ; UNIREP - IEN from file 200 of the Union Rep - used to send bulletin
"RTN","OOPSGUI7",83,0)
 ; Output - RESULTS - String indicating bulletin status.
"RTN","OOPSGUI7",84,0)
 D CONSENT^OOPSMBUL(IEN,UNIREP)
"RTN","OOPSGUI7",85,0)
 Q
"RTN","OOPSGUI7",86,0)
GETFLD(RESULTS,IEN,FLD) ; Send in IEN and Field number to retrieve a single 
"RTN","OOPSGUI7",87,0)
 ; data field from the ASISTS Accident Reporting File (#2260)
"RTN","OOPSGUI7",88,0)
 ;
"RTN","OOPSGUI7",89,0)
 ;  Input:   IEN - Internal record number
"RTN","OOPSGUI7",90,0)
 ; Output:   FLD - the file and field number of the data element to be
"RTN","OOPSGUI7",91,0)
 ;                 retrieved.  EX. 2260^120
"RTN","OOPSGUI7",92,0)
 N FILE,FIELD,DATA
"RTN","OOPSGUI7",93,0)
 S RESULTS="No data."
"RTN","OOPSGUI7",94,0)
 I '$G(IEN) S RESULTS="No data.  Missing Record Identifier." Q
"RTN","OOPSGUI7",95,0)
 S FILE=$P(FLD,U),FIELD=$P(FLD,U,2)
"RTN","OOPSGUI7",96,0)
 I $G(FILE)=""!($G(FIELD)="") D  Q
"RTN","OOPSGUI7",97,0)
 . S RESULTS="No data.  Missing File or Field information."
"RTN","OOPSGUI7",98,0)
 S DATA=$$GET1^DIQ(FILE,IEN,FIELD)
"RTN","OOPSGUI7",99,0)
 I $G(DATA)'="" S RESULTS=DATA
"RTN","OOPSGUI7",100,0)
 Q
"RTN","OOPSGUI7",101,0)
GETINST(RESULTS)        ; RPC Call - Get Institutions from File 4
"RTN","OOPSGUI7",102,0)
 ; Output:  RESULTS - global array
"RTN","OOPSGUI7",103,0)
 ;
"RTN","OOPSGUI7",104,0)
 N ADDED,ITEM,MULT,ROOT,X,XREF,SFLD,VAL,PTR,PCE,VALID,FIELD
"RTN","OOPSGUI7",105,0)
 K ^TMP("OOPSINST",DUZ)
"RTN","OOPSGUI7",106,0)
 S XREF="B",X=0,FIELD=13
"RTN","OOPSGUI7",107,0)
 S ROOT="^"_$$GET1^DID(2260,FIELD,"","POINTER")
"RTN","OOPSGUI7",108,0)
 S MULT=$$GET1^DID(2260,FIELD,"","SPECIFIER")
"RTN","OOPSGUI7",109,0)
 I MULT["A" D
"RTN","OOPSGUI7",110,0)
 . S ROOT="^"_$$GET1^DID(+MULT,.01,"","POINTER")
"RTN","OOPSGUI7",111,0)
 S ITEM="" F  S ITEM=$O(@(ROOT_"XREF,ITEM)")) Q:$G(ITEM)']""  D
"RTN","OOPSGUI7",112,0)
 .S PTR=0 F  S PTR=$O(@(ROOT_"XREF,ITEM,PTR)")) Q:PTR=""  D
"RTN","OOPSGUI7",113,0)
 ..I PTR'?1N.N Q
"RTN","OOPSGUI7",114,0)
 ..S VAL=$P(@(ROOT_PTR_",0)"),U)
"RTN","OOPSGUI7",115,0)
 ..;Need to get Station Number with Name to uniquely identify for user
"RTN","OOPSGUI7",116,0)
 ..I FIELD=13 D  I '$G(VALID) Q
"RTN","OOPSGUI7",117,0)
 ...S VALID=1,SFLD=ROOT_PTR_",99)"
"RTN","OOPSGUI7",118,0)
 ...I $P($G(@SFLD),U,4)=1 S VALID=0
"RTN","OOPSGUI7",119,0)
 ...I $P($G(@SFLD),U)'="" S VAL=VAL_" = "_$P($G(@SFLD),U)
"RTN","OOPSGUI7",120,0)
 ...I $P(VAL," = ")="" S VALID=0
"RTN","OOPSGUI7",121,0)
 ..I FIELD=30!(FIELD=62)!(FIELD=70)!(FIELD=123)!(FIELD=124)!(FIELD=126) D
"RTN","OOPSGUI7",122,0)
 ... S SFLD=ROOT_PTR_",0)"
"RTN","OOPSGUI7",123,0)
 ... I $P($G(@SFLD),U,2)'="" S VAL=VAL_" - "_$P($G(@SFLD),U,2)
"RTN","OOPSGUI7",124,0)
 ..S X=X+1,^TMP("OOPSINST",DUZ,X)=PTR_":"_VAL_$C(10)
"RTN","OOPSGUI7",125,0)
 ..I $P($G(FLD),U,3)]"" D
"RTN","OOPSGUI7",126,0)
 ...S PCE=$P($G(FLD),U,3)
"RTN","OOPSGUI7",127,0)
 ...S ^TMP("OOPSINST",DUZ,X)=^TMP("OOPSINST",DUZ,X)_":"_$P(@(ROOT_"PTR,0)"),U,PCE)
"RTN","OOPSGUI7",128,0)
 S RESULTS=$NA(^TMP("OOPSINST",DUZ))
"RTN","OOPSGUI7",129,0)
 Q
"RTN","OOPSGUI7",130,0)
SENSDATA(RES,SDUZ,EMP) ;Supervisor accessed sensitive data, case not created
"RTN","OOPSGUI7",131,0)
 ; Input  EMP String which is the name of the employee accessed.
"RTN","OOPSGUI7",132,0)
 ;        DUZ DUZ of the Supervisor accessing the data. 
"RTN","OOPSGUI7",133,0)
 N MGRP,MEMS,MSG
"RTN","OOPSGUI7",134,0)
 ;Make sure mail group exists
"RTN","OOPSGUI7",135,0)
 S MGRP=$$FIND1^DIC(3.8,"","X","OOPS ISO NOTIFICATION")
"RTN","OOPSGUI7",136,0)
 I 'MGRP D  G BULL
"RTN","OOPSGUI7",137,0)
 .S XMY("G.OOPS WC MESSAGE")=""
"RTN","OOPSGUI7",138,0)
 .S XMDUZ="ASISTS Package"
"RTN","OOPSGUI7",139,0)
 .S GRP="OOPS WC MESSAGE"
"RTN","OOPSGUI7",140,0)
 .S XMSUB="ASISTS ISO NOTIFICATION Mail Group Error"
"RTN","OOPSGUI7",141,0)
 .S MSG(1)="The OOPS ISO NOTIFICATION Mail Group does not exist."
"RTN","OOPSGUI7",142,0)
 .S XMTEXT="MSG("
"RTN","OOPSGUI7",143,0)
 .D ^XMD
"RTN","OOPSGUI7",144,0)
 ;Make sure there is someone defined in the mail group
"RTN","OOPSGUI7",145,0)
 D LIST^DIC(3.81,","_MGRP_",","","",1,"","","","","","MEMS")
"RTN","OOPSGUI7",146,0)
 I '$P(MEMS("DILIST",0),U) D  G BULL
"RTN","OOPSGUI7",147,0)
 .S XMY("G.OOPS WC MESSAGE")=""
"RTN","OOPSGUI7",148,0)
 .S XMDUZ="ASISTS Package"        
"RTN","OOPSGUI7",149,0)
 .S GRP="OOPS WC MESSAGE"       
"RTN","OOPSGUI7",150,0)
 .S XMSUB="ASISTS ISO NOTIFICATION Mail Group Error"
"RTN","OOPSGUI7",151,0)
 .S MSG(1)="There are no members in mail group OOPS ISO NOTIFICATION."
"RTN","OOPSGUI7",152,0)
 .S XMTEXT="MSG("
"RTN","OOPSGUI7",153,0)
 .D ^XMD
"RTN","OOPSGUI7",154,0)
 S XMY("G.OOPS ISO NOTIFICATION")=""
"RTN","OOPSGUI7",155,0)
BULL S (NAME,XMB)="OOPS SENSITIVE DATA"
"RTN","OOPSGUI7",156,0)
 S XMB(1)=$$GET1^DIQ(200,SDUZ,.01)
"RTN","OOPSGUI7",157,0)
 S XMB(2)=EMP
"RTN","OOPSGUI7",158,0)
 S XMB(3)=$$FMTE^XLFDT($$NOW^XLFDT,1)
"RTN","OOPSGUI7",159,0)
 S XMBODY="",XMINSTR("FLAGS")="X"
"RTN","OOPSGUI7",160,0)
 D TASKBULL^XMXAPI(DUZ,NAME,.XMB,XMBODY,.XMY,.XMINSTR)
"RTN","OOPSGUI7",161,0)
 K NAME,XMB,XMBODY,XMY,XMINSTR
"RTN","OOPSGUI7",162,0)
 S RES="BULLETIN SENT"
"RTN","OOPSGUI7",163,0)
 Q
"RTN","OOPSMBUL")
0^5^B17635026
"RTN","OOPSMBUL",1,0)
OOPSMBUL ;HIRMFO/REL-Bulletin ;3/30/98
"RTN","OOPSMBUL",2,0)
 ;;2.0;ASISTS;**2**;Jun 03, 2002
"RTN","OOPSMBUL",3,0)
 Q
"RTN","OOPSMBUL",4,0)
MFAC ;
"RTN","OOPSMBUL",5,0)
 N NIEN,NGRP,TEST
"RTN","OOPSMBUL",6,0)
 S NIEN=$$GET1^DIQ(2260,IEN,13,"I")
"RTN","OOPSMBUL",7,0)
 S NGRP=GRP_" - "_$$GET1^DIQ(4,NIEN,99,"E")
"RTN","OOPSMBUL",8,0)
 S TEST=$$FIND1^DIC(3.8,"","AMX",NGRP)
"RTN","OOPSMBUL",9,0)
 I TEST S GRP=NGRP
"RTN","OOPSMBUL",10,0)
 D GRP
"RTN","OOPSMBUL",11,0)
 Q
"RTN","OOPSMBUL",12,0)
CASE(IEN) ;
"RTN","OOPSMBUL",13,0)
 N CN,SUP,SUP2,Y,GRP
"RTN","OOPSMBUL",14,0)
 S XMB="OOPS CASE",X0=$G(^OOPS(2260,IEN,0)) K XMY
"RTN","OOPSMBUL",15,0)
 S CN=$P(X0,U,1),SUP=$P(X0,U,8),XMY(SUP)=""
"RTN","OOPSMBUL",16,0)
 S SUP2=$P(X0,U,9) I SUP2>0 S XMY(SUP2)=""
"RTN","OOPSMBUL",17,0)
 S XMB(3)=CN
"RTN","OOPSMBUL",18,0)
 ; V2 - 05/09/02 LLH - add whether inj or illness
"RTN","OOPSMBUL",19,0)
 S XMB(6)=$$GET1^DIQ(2260,IEN,52)
"RTN","OOPSMBUL",20,0)
 ; Patch 8 - added display of supervisors name to bulletin
"RTN","OOPSMBUL",21,0)
 S XMB(4)=$$GET1^DIQ(200,SUP,.01,"E")
"RTN","OOPSMBUL",22,0)
 I SUP2>0 S XMB(5)=$$GET1^DIQ(200,SUP2,.01,"E")
"RTN","OOPSMBUL",23,0)
 S Y=$P(X0,U,5) D DD^%DT S XMB(2)=Y
"RTN","OOPSMBUL",24,0)
 S Y=$P(X0,U,3)
"RTN","OOPSMBUL",25,0)
 S GRP="OOPS INJURY"
"RTN","OOPSMBUL",26,0)
 D MFAC
"RTN","OOPSMBUL",27,0)
 S GRP="OOPS UNION"
"RTN","OOPSMBUL",28,0)
 D MFAC
"RTN","OOPSMBUL",29,0)
 I $P(X0,U,4)>10 S GRP="OOPS EH" D MFAC
"RTN","OOPSMBUL",30,0)
 ; next 2 lines restrict access to delivered message - 060303 LLH
"RTN","OOPSMBUL",31,0)
 S XMBODY="",XMINSTR("FLAGS")="IX"
"RTN","OOPSMBUL",32,0)
 D TASKBULL^XMXAPI(DUZ,"OOPS CASE",.XMB,XMBODY,.XMY,.XMINSTR)
"RTN","OOPSMBUL",33,0)
 Q
"RTN","OOPSMBUL",34,0)
SAFETY(IEN) ; Safety Officer Bulletin
"RTN","OOPSMBUL",35,0)
 N GRP
"RTN","OOPSMBUL",36,0)
 S XMB="OOPS SAFETY",X0=$G(^OOPS(2260,IEN,0)) K XMY
"RTN","OOPSMBUL",37,0)
 S XMB(1)=$P(X0,U,2)
"RTN","OOPSMBUL",38,0)
 S XMB(3)=$P(X0,U,1)
"RTN","OOPSMBUL",39,0)
 S Y=$P(X0,U,5) D DD^%DT S XMB(2)=Y
"RTN","OOPSMBUL",40,0)
 S GRP="OOPS SAFETY"
"RTN","OOPSMBUL",41,0)
 D MFAC
"RTN","OOPSMBUL",42,0)
 D ^XMB K XMB,XMY,XMM,XMDT
"RTN","OOPSMBUL",43,0)
 Q
"RTN","OOPSMBUL",44,0)
WCPBOR(IEN) ; Employee does not understand bill of rights, sent msg to wcp
"RTN","OOPSMBUL",45,0)
 ; Input
"RTN","OOPSMBUL",46,0)
 ;   IEN - Internal record number
"RTN","OOPSMBUL",47,0)
 ;
"RTN","OOPSMBUL",48,0)
 N GRP,X0
"RTN","OOPSMBUL",49,0)
 S X0=$G(^OOPS(2260,IEN,0)) K XMY
"RTN","OOPSMBUL",50,0)
 S XMB(1)=$P(X0,U,2)
"RTN","OOPSMBUL",51,0)
 S XMB="OOPS WCPBOR"
"RTN","OOPSMBUL",52,0)
 S GRP="OOPS WCP"
"RTN","OOPSMBUL",53,0)
 D MFAC
"RTN","OOPSMBUL",54,0)
 D ^XMB K XMB,XMY,XMM,XMDT
"RTN","OOPSMBUL",55,0)
 Q
"RTN","OOPSMBUL",56,0)
CONSENT(IEN,UNIREP) ; Employee consented to union notification, 
"RTN","OOPSMBUL",57,0)
 ;                 send msg to union
"RTN","OOPSMBUL",58,0)
 ; Input
"RTN","OOPSMBUL",59,0)
 ;    IEN - Internal record number
"RTN","OOPSMBUL",60,0)
 ; UNIREP - IEN from file 200 of the Union Rep - used to send bulletin
"RTN","OOPSMBUL",61,0)
 ;
"RTN","OOPSMBUL",62,0)
 N GRP,X0,XA
"RTN","OOPSMBUL",63,0)
 S X0=$G(^OOPS(2260,IEN,0))
"RTN","OOPSMBUL",64,0)
 S XA=$G(^OOPS(2260,IEN,"2162A")) K XMY
"RTN","OOPSMBUL",65,0)
 S XMY(UNIREP)=""
"RTN","OOPSMBUL",66,0)
 S XMB(1)=$P(X0,U),Y=$P(X0,U,5) D DD^%DT S XMB(2)=Y
"RTN","OOPSMBUL",67,0)
 S XMB(3)=$$GET1^DIQ(2260,IEN,52)
"RTN","OOPSMBUL",68,0)
 S XMB(4)=$$GET1^DIQ(2260,IEN,2)
"RTN","OOPSMBUL",69,0)
 S XMB(5)=$$GET1^DIQ(2260,IEN,7)
"RTN","OOPSMBUL",70,0)
 S XMB(6)=$$GET1^DIQ(2260,IEN,13,"I")
"RTN","OOPSMBUL",71,0)
 S XMB(7)=$E($$GET1^DIQ(2260,IEN,18),1,28)
"RTN","OOPSMBUL",72,0)
 S XMB(8)=$$GET1^DIQ(2260,IEN,14)
"RTN","OOPSMBUL",73,0)
 S XMB(9)=$P(XA,U,12)_"/"_$P(XA,U,13)
"RTN","OOPSMBUL",74,0)
 S XMB(10)=$E($$GET1^DIQ(2260,IEN,53),1,23)
"RTN","OOPSMBUL",75,0)
 S XMB(11)=$E($$GET1^DIQ(2260,IEN,53.1),1,28)
"RTN","OOPSMBUL",76,0)
 S XMB(12)=$E($$GET1^DIQ(2260,IEN,3),1,23)
"RTN","OOPSMBUL",77,0)
 S XMDUZ=.5
"RTN","OOPSMBUL",78,0)
 S XMB="OOPS CONSENT"
"RTN","OOPSMBUL",79,0)
 D ^XMB K XMB,XMY,XMM,XMDT,XMDUZ
"RTN","OOPSMBUL",80,0)
 Q
"RTN","OOPSMBUL",81,0)
WCP(IEN,ACT) ; Bulletin to Super when WC edits or WX signs CA1/CA2
"RTN","OOPSMBUL",82,0)
 ; Input
"RTN","OOPSMBUL",83,0)
 ;   IEN - Internal record number
"RTN","OOPSMBUL",84,0)
 ;   ACT -
"RTN","OOPSMBUL",85,0)
 ;    "E" = Edited by the WC personnel
"RTN","OOPSMBUL",86,0)
 ;    "S" = Signed by the WC personnel
"RTN","OOPSMBUL",87,0)
 ;
"RTN","OOPSMBUL",88,0)
 N SUP,SUP2,Y
"RTN","OOPSMBUL",89,0)
 S XMB=$S(ACT="E":"OOPS WC EDITED",ACT="S":"OOPS WC SIGNED",1:"")
"RTN","OOPSMBUL",90,0)
 I $G(XMB)="" Q
"RTN","OOPSMBUL",91,0)
 S X0=$G(^OOPS(2260,IEN,0)) K XMY
"RTN","OOPSMBUL",92,0)
 S SUP=$P(X0,U,8),XMY(SUP)=""
"RTN","OOPSMBUL",93,0)
 S SUP2=$P(X0,U,9) I $G(SUP2) S XMY(SUP2)=""
"RTN","OOPSMBUL",94,0)
 S XMB(1)=$P(X0,U,2)
"RTN","OOPSMBUL",95,0)
 S XMB(2)=$P(X0,U,1)
"RTN","OOPSMBUL",96,0)
 S Y=$P(X0,U,5) D DD^%DT S XMB(3)=Y
"RTN","OOPSMBUL",97,0)
 S XMDUZ=.5
"RTN","OOPSMBUL",98,0)
 D ^XMB K XMB,XMY,XMM,XMDT,X0,XMDUZ
"RTN","OOPSMBUL",99,0)
 Q
"RTN","OOPSMBUL",100,0)
SUPS(IEN) ; Bulletin to WC when Supervisor signs CA1/CA2
"RTN","OOPSMBUL",101,0)
 ; Patch 8
"RTN","OOPSMBUL",102,0)
 N SUP,SUP2,FORM,GRP,Y
"RTN","OOPSMBUL",103,0)
 S XMB="OOPS WORKERS COMP",X0=$G(^OOPS(2260,IEN,0)) K XMY
"RTN","OOPSMBUL",104,0)
 S SUP=$P(X0,U,8),XMY(SUP)=""
"RTN","OOPSMBUL",105,0)
 S SUP2=$P(X0,U,9) I $G(SUP2) S XMY(SUP2)=""
"RTN","OOPSMBUL",106,0)
 S XMB(1)=$P(X0,U,2)
"RTN","OOPSMBUL",107,0)
 S XMB(2)=$P(X0,U,1)
"RTN","OOPSMBUL",108,0)
 S Y=$P(X0,U,5) D DD^%DT S XMB(3)=Y
"RTN","OOPSMBUL",109,0)
 S FORM=$P(X0,U,7)
"RTN","OOPSMBUL",110,0)
 S FORM=$S(FORM=1:"CA1ES",FORM=2:"CA2ES",1:"")
"RTN","OOPSMBUL",111,0)
 I FORM="" Q
"RTN","OOPSMBUL",112,0)
 S Y=$P(^OOPS(2260,IEN,FORM),U,6) D DD^%DT S XMB(4)=Y
"RTN","OOPSMBUL",113,0)
 S GRP="OOPS WCP"
"RTN","OOPSMBUL",114,0)
 D MFAC
"RTN","OOPSMBUL",115,0)
 D ^XMB K XMB,XMY,XMM,XMDT,X0
"RTN","OOPSMBUL",116,0)
 Q
"RTN","OOPSMBUL",117,0)
UNION(IEN) ; Union  Bulletin
"RTN","OOPSMBUL",118,0)
 N GRP,Y
"RTN","OOPSMBUL",119,0)
 S XMB="OOPS SUPERVISOR",X0=$G(^OOPS(2260,IEN,0)) K XMY
"RTN","OOPSMBUL",120,0)
 S XMB(3)=$P(X0,U,1)
"RTN","OOPSMBUL",121,0)
 S Y=$P(X0,U,5) D DD^%DT S XMB(2)=Y
"RTN","OOPSMBUL",122,0)
 S GRP="OOPS UNION"
"RTN","OOPSMBUL",123,0)
 D MFAC
"RTN","OOPSMBUL",124,0)
 D ^XMB K XMB,XMY,XMM,XMDT
"RTN","OOPSMBUL",125,0)
 Q
"RTN","OOPSMBUL",126,0)
EMP(IEN) ; Employee notification to supervisor
"RTN","OOPSMBUL",127,0)
 N GRP,SUP,SUP2
"RTN","OOPSMBUL",128,0)
 S XMB="OOPS EMPLOYEE",X0=$G(^OOPS(2260,IEN,0)) K XMY
"RTN","OOPSMBUL",129,0)
 S XMB(3)=$P(X0,U,1)
"RTN","OOPSMBUL",130,0)
 S Y=$P(X0,U,5) D DD^%DT S XMB(2)=Y
"RTN","OOPSMBUL",131,0)
 S SUP=$P(X0,U,8),XMY(SUP)=""
"RTN","OOPSMBUL",132,0)
 S SUP2=$P(X0,U,9) I SUP2>0 S XMY(SUP2)=""
"RTN","OOPSMBUL",133,0)
 S GRP="OOPS INJURY"
"RTN","OOPSMBUL",134,0)
 D MFAC
"RTN","OOPSMBUL",135,0)
 D ^XMB K XMY,XMM,XMDT
"RTN","OOPSMBUL",136,0)
 S GRP="OOPS UNION"
"RTN","OOPSMBUL",137,0)
 D MFAC
"RTN","OOPSMBUL",138,0)
 S XMDUZ=.5
"RTN","OOPSMBUL",139,0)
 D ^XMB K XMB,XMY,XMM,XMDT,XMDUZ
"RTN","OOPSMBUL",140,0)
 Q
"RTN","OOPSMBUL",141,0)
BOR(IEN) ; Employee Bill of Rights
"RTN","OOPSMBUL",142,0)
 N EMP
"RTN","OOPSMBUL",143,0)
 S XMB="OOPS BILL OF RIGHTS" K XMY
"RTN","OOPSMBUL",144,0)
 S EMP=$O(^VA(200,"SSN",SSN,0)),XMY(EMP)=""
"RTN","OOPSMBUL",145,0)
 D ^XMB K XMB,XMY,XMM,XMDT
"RTN","OOPSMBUL",146,0)
 Q
"RTN","OOPSMBUL",147,0)
GRP ; Get Mail group Members for GRP
"RTN","OOPSMBUL",148,0)
 I GRP="" Q
"RTN","OOPSMBUL",149,0)
 S XMY("I:G."_GRP)=""
"RTN","OOPSMBUL",150,0)
 Q
"VER")
8.0^22
**END**
**END**
