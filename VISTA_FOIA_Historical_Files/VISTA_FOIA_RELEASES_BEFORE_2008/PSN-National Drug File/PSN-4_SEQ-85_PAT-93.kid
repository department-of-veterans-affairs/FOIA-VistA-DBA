Released PSN*4*93 SEQ #85
Extracted from mail message
**KIDS**:PSN*4.0*93^

**INSTALL NAME**
PSN*4.0*93
"BLD",5017,0)
PSN*4.0*93^NATIONAL DRUG FILE^0^3041019^y
"BLD",5017,1,0)
^^2^2^3041019^
"BLD",5017,1,1,0)
This patch fixes the undefined error reported in NOIS ISH-1004-41307 when
"BLD",5017,1,2,0)
using the Rematch / Match Single Drugs [PSNDRUG] option.
"BLD",5017,4,0)
^9.64PA^^
"BLD",5017,"KRN",0)
^9.67PA^8989.52^19
"BLD",5017,"KRN",.4,0)
.4
"BLD",5017,"KRN",.401,0)
.401
"BLD",5017,"KRN",.402,0)
.402
"BLD",5017,"KRN",.403,0)
.403
"BLD",5017,"KRN",.5,0)
.5
"BLD",5017,"KRN",.84,0)
.84
"BLD",5017,"KRN",3.6,0)
3.6
"BLD",5017,"KRN",3.8,0)
3.8
"BLD",5017,"KRN",9.2,0)
9.2
"BLD",5017,"KRN",9.8,0)
9.8
"BLD",5017,"KRN",9.8,"NM",0)
^9.68A^1^1
"BLD",5017,"KRN",9.8,"NM",1,0)
PSNHELP^^0^B30869158
"BLD",5017,"KRN",9.8,"NM","B","PSNHELP",1)

"BLD",5017,"KRN",19,0)
19
"BLD",5017,"KRN",19.1,0)
19.1
"BLD",5017,"KRN",101,0)
101
"BLD",5017,"KRN",409.61,0)
409.61
"BLD",5017,"KRN",771,0)
771
"BLD",5017,"KRN",870,0)
870
"BLD",5017,"KRN",8989.51,0)
8989.51
"BLD",5017,"KRN",8989.52,0)
8989.52
"BLD",5017,"KRN",8994,0)
8994
"BLD",5017,"KRN","B",.4,.4)

"BLD",5017,"KRN","B",.401,.401)

"BLD",5017,"KRN","B",.402,.402)

"BLD",5017,"KRN","B",.403,.403)

"BLD",5017,"KRN","B",.5,.5)

"BLD",5017,"KRN","B",.84,.84)

"BLD",5017,"KRN","B",3.6,3.6)

"BLD",5017,"KRN","B",3.8,3.8)

"BLD",5017,"KRN","B",9.2,9.2)

"BLD",5017,"KRN","B",9.8,9.8)

"BLD",5017,"KRN","B",19,19)

"BLD",5017,"KRN","B",19.1,19.1)

"BLD",5017,"KRN","B",101,101)

"BLD",5017,"KRN","B",409.61,409.61)

"BLD",5017,"KRN","B",771,771)

"BLD",5017,"KRN","B",870,870)

"BLD",5017,"KRN","B",8989.51,8989.51)

"BLD",5017,"KRN","B",8989.52,8989.52)

"BLD",5017,"KRN","B",8994,8994)

"BLD",5017,"QUES",0)
^9.62^^
"BLD",5017,"REQB",0)
^9.611^1^1
"BLD",5017,"REQB",1,0)
PSN*4.0*84^1
"BLD",5017,"REQB","B","PSN*4.0*84",1)

"MBREQ")
0
"PKG",136,-1)
1^1
"PKG",136,0)
NATIONAL DRUG FILE^PSN^This is the National Drug File Package V 3.14
"PKG",136,20,0)
^9.402P^^
"PKG",136,22,0)
^9.49I^1^1
"PKG",136,22,1,0)
4.0^2981030^2981223^11595
"PKG",136,22,1,"PAH",1,0)
93^3041019
"PKG",136,22,1,"PAH",1,1,0)
^^2^2^3041019
"PKG",136,22,1,"PAH",1,1,1,0)
This patch fixes the undefined error reported in NOIS ISH-1004-41307 when
"PKG",136,22,1,"PAH",1,1,2,0)
using the Rematch / Match Single Drugs [PSNDRUG] option.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
1
"RTN","PSNHELP")
0^1^B30869158
"RTN","PSNHELP",1,0)
PSNHELP ;BIR/CCH&WRT-Help text routine ;08/21/98 14:25
"RTN","PSNHELP",2,0)
 ;;4.0; NATIONAL DRUG FILE;**60,84,93**; 30 Oct 98
"RTN","PSNHELP",3,0)
 ;IA 2352 - ^PSDRUG(
"RTN","PSNHELP",4,0)
 ;IA 2613 - ^PS(59.7
"RTN","PSNHELP",5,0)
 ;IA 3621 - DRG^PSSHUIDG(DA)
"RTN","PSNHELP",6,0)
 ;IA 4394 - DRG^PSSDGUPD(DA)  V.2.4 dispensing machines
"RTN","PSNHELP",7,0)
 ;IA 1976 - ^PS(59
"RTN","PSNHELP",8,0)
TRD1 ; TRADE NAME 
"RTN","PSNHELP",9,0)
 W !!,"Enter number of one of the trade names displayed"
"RTN","PSNHELP",10,0)
 W !,"Or press return to view more" D UPAR Q
"RTN","PSNHELP",11,0)
TR2 ; TRADE NAME 
"RTN","PSNHELP",12,0)
 W !!,"Enter number of one of the trade names displayed",!,"If none of them match, press return to proceed"
"RTN","PSNHELP",13,0)
 W !,"to next step in matching process" D UPAR K ANS Q
"RTN","PSNHELP",14,0)
UPAR W !,"or enter ""^"" to exit",! Q
"RTN","PSNHELP",15,0)
NDC1 ; NDC CODE 
"RTN","PSNHELP",16,0)
 W !!,"Enter NDC Code for drug from your drug file",!,"Format should be MANUFACTURER'S CODE""-""PRODUCT CODE""-""PACKAGE CODE",!,"(i.e. 9999-999-99)" D UPAR K ANS Q
"RTN","PSNHELP",17,0)
NDC2 ; NDC CODE 
"RTN","PSNHELP",18,0)
 W !!,"Enter number of one of the drugs displayed or press",!,"return to view more.",!,"You may enter ""^NDC"" to skip this step and go directly to the",!,"""enter NDC Code <WITH DASHES>:"" prompt" D UPAR K ANS Q
"RTN","PSNHELP",19,0)
NDC3 ; NDC CODE 
"RTN","PSNHELP",20,0)
 W !!,"Enter number of one of the drugs displayed",!,"If none of them match, press return to proceed"
"RTN","PSNHELP",21,0)
 W !,"to next step in matching process" D UPAR Q
"RTN","PSNHELP",22,0)
HIT1 ;  FOR MATCH PROMPT
"RTN","PSNHELP",23,0)
 W !!,"The drugs displayed are ""matches"" found in the National",!,"Drug File" D NDC2 Q
"RTN","PSNHELP",24,0)
RES1 ;  FOR RESP PROMPT
"RTN","PSNHELP",25,0)
 W !!,"If the drug from the National Drug File matches the drug ",!," from your drug file enter ""Y""",!,"If an incorrect response was entered, respond ""N"""
"RTN","PSNHELP",26,0)
 W !," or press return to proceed to next step in matching process" D UPAR Q
"RTN","PSNHELP",27,0)
TYP1 ;  FOR PKG TYPE
"RTN","PSNHELP",28,0)
 W !!,"Enter Package Type which matches the Package Type of the drug",!,"in your drug file" D UPAR Q
"RTN","PSNHELP",29,0)
SZ1 ;  FOR PKG SIZE
"RTN","PSNHELP",30,0)
 W !!,"Enter Package Size matches the Package Size",!,"of the drug in your drug file",!,"If none of them match, enter ""NONE""" D UPAR Q
"RTN","PSNHELP",31,0)
MRG1 ;  FOR MERGE OPTION
"RTN","PSNHELP",32,0)
 ; W !!,"This routine will merge the following data from the National Drug File",!,"into your local drug file:  ",!,"(1) PTR TO NDF",!,"(2) VA PRODUCT NAME FROM NDF",!,"(3) PTR TO NDF VA PRODUCT NAME"
"RTN","PSNHELP",33,0)
 ; W !,"(4) PTR TO PACKAGE SIZE IN NDF",!,"(5) PTR TO PACKAGE TYPE IN NDF AND",!,"(6) NEW VA DRUG CLASSIFICATION." K ANS G RESP^PSNMRG Q
"RTN","PSNHELP",34,0)
ASK1 ;  FOR MATCH PROMPT
"RTN","PSNHELP",35,0)
 W !!,"If drugs match, enter ""Y"" for YES",!,"If you would like to rematch drug, enter ""N"" for NO",!,"If no match is possible, press return and the drug will remain unmatched"
"RTN","PSNHELP",36,0)
 W:'$D(Z9) !,"and next drug in your drug file will be displayed" D UPAR Q
"RTN","PSNHELP",37,0)
REMTCH ; REMATCH PROMPT
"RTN","PSNHELP",38,0)
 W:$P(^PSDRUG(+Y,"ND"),"^",2)]"" !!,"This drug has already been matched and classified with the",!,"National Drug File."
"RTN","PSNHELP",39,0)
 I $D(^PSDRUG(+Y,3)) W:$P(^PSDRUG(+Y,3),"^",1)=1 !,"This drug has also been marked to transmit to CMOP.",!,"If you choose to rematch it, the drug will be marked NOT TO TRANSMIT to CMOP.",!
"RTN","PSNHELP",40,0)
 W:$P(^PSDRUG(+Y,"ND"),"^",2)']"" !!,"This drug has been manually classed but not matched (merged with NDF)."
"RTN","PSNHELP",41,0)
 R !,"Do you wish to match/rematch it? N// ",ANS:DTIME S:'$T ANS="^" S:ANS']"" ANS="N" I ANS="^" S PSNFL=1 Q
"RTN","PSNHELP",42,0)
 I ANS?.E1C.E G REMTCH
"RTN","PSNHELP",43,0)
 I "?"[$E(ANS) W !!,"Answer ""Yy"" to rematch this drug.",!,"Answer ""Nn"" or ""^"" or press <RET> to quit." K ANS G REMTCH
"RTN","PSNHELP",44,0)
 I "NnYy"'[$E(ANS)!(ANS="") W !,"ANSWER MUST BE YES OR NO" K ANS G REMTCH
"RTN","PSNHELP",45,0)
 I "Yy"'[$E(ANS) K ANS G START^PSNDRUG
"RTN","PSNHELP",46,0)
 K ANS S:$D(^PSDRUG(+Y,"ND")) PSNID=$P(^PSDRUG(+Y,"ND"),"^",10) D SETNULL^PSNHELP1  S:$D(^PSDRUG(+Y,3)) $P(^PSDRUG(+Y,3),"^",1)=0 K:$D(^PSDRUG("AQ",+Y)) ^PSDRUG("AQ",+Y) K:PSNID]"" ^PSDRUG("AQ1",PSNID,+Y) S DA=+Y K PSNID
"RTN","PSNHELP",47,0)
 I $$PATCH^XPDUTL("PSS*1.0*57") D DRG^PSSHUIDG(DA)
"RTN","PSNHELP",48,0)
 N XX,DNSNAM,DNSPORT,DVER,DMFU S XX=""
"RTN","PSNHELP",49,0)
 F XX=0:0 S XX=$O(^PS(59,XX)) Q:'XX  D
"RTN","PSNHELP",50,0)
 .S DVER=$$GET1^DIQ(59,XX_",",105,"I"),DMFU=$$GET1^DIQ(59,XX_",",105.2)
"RTN","PSNHELP",51,0)
 .I DVER="2.4" S DNSNAM=$$GET1^DIQ(59,XX_",",2006),DNSPORT=$$GET1^DIQ(59,XX_",",2007) I DNSNAM'=""&(DMFU="YES") D DRG^PSSDGUPD(DA,"",DNSNAM,DNSPORT)
"RTN","PSNHELP",52,0)
 S X="PSXREF" X ^%ZOSF("TEST") D:$T ^PSXREF K DA G MATCH^PSNDRUG Q
"RTN","PSNHELP",53,0)
BLD1 ; WHERE TO BEGIN MATCHING
"RTN","PSNHELP",54,0)
 W !!,"If you wish to begin matching process from beginning of your local drug file,",!,"enter ""B"". This will allow you to match drugs which may have been re-activated."
"RTN","PSNHELP",55,0)
 W !,"Press return to continue with next drug following the one last matched" D UPAR K ANS Q
"RTN","PSNHELP",56,0)
ING ; INGREDIENTS
"RTN","PSNHELP",57,0)
 R !!,"Display ingredients for this NDF drug? N//",ANS:DTIME S:'$T ANS="^" I ANS["^" S PSNFL=1 Q
"RTN","PSNHELP",58,0)
 I ANS?.E1C.E G ING
"RTN","PSNHELP",59,0)
 I ANS["?" D ING1 G ING
"RTN","PSNHELP",60,0)
 I ANS']""!"nN"[ANS S ANS="N" Q
"RTN","PSNHELP",61,0)
 ; S D0=PSNNDF,Y=$P(^PSNDF(D0,5,PSNFNM,1),"^",1)
"RTN","PSNHELP",62,0)
 D INGRED^PSNOUT
"RTN","PSNHELP",63,0)
 ; I $D(^PSNDF(D0,5,PSNFNM,3)) S Y=$P(^PSNDF(D0,5,PSNFNM,3),"^",1) D INGRED^PSNOUT
"RTN","PSNHELP",64,0)
 ; I $D(^PSNDF(D0,5,PSNFNM,4)) S Y=$P(^PSNDF(D0,5,PSNFNM,4),"^",1) D INGRED^PSNOUT
"RTN","PSNHELP",65,0)
 Q
"RTN","PSNHELP",66,0)
ING1 W !!,"Displays ingredients (including strengths and units)" D UPAR K ANS Q
"RTN","PSNHELP",67,0)
RES2 ; MATCH PROMPT
"RTN","PSNHELP",68,0)
 W !!,"If the drug from the National Drug File matches the drug",!," from your local file, respond ""Y""",!,"If it is not a match, respond ""N"""
"RTN","PSNHELP",69,0)
 W:'$D(Z9) !,"If you want to pass to next drug and leave this drug unverified, press return" D UPAR K ANS Q
"RTN","PSNHELP",70,0)
CR ; FORCES CONVERSION REMATCH OPTION
"RTN","PSNHELP",71,0)
 I $P(^PS(59.7,1,10),"^",3)=0 W !!,"You must use the Conversion Rematch option first before using this option.",! Q
"VER")
8.0^22.0
**END**
**END**
