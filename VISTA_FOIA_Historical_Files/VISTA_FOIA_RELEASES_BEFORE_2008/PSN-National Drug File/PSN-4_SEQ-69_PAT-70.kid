Released PSN*4*70 SEQ #69
Extracted from mail message
**KIDS**:PSN*4.0*70^

**INSTALL NAME**
PSN*4.0*70
"BLD",4291,0)
PSN*4.0*70^NATIONAL DRUG FILE^0^3030728^y
"BLD",4291,1,0)
^^5^5^3030728^^^^
"BLD",4291,1,1,0)
This Build builds on the foundation to identify VA Products from the VA
"BLD",4291,1,2,0)
PRODUCT file (#50.68) as EXCLUDE from drug-drug interaction checking.
"BLD",4291,1,3,0)
Two new menu options are included to print marked VA Products. Two existing
"BLD",4291,1,4,0)
options have been enhanced to display the new field to the user. A enhanced
"BLD",4291,1,5,0)
API routine PSNAPIS is also included.
"BLD",4291,4,0)
^9.64PA^^0
"BLD",4291,"ABPKG")
n
"BLD",4291,"KRN",0)
^9.67PA^8989.52^19
"BLD",4291,"KRN",.4,0)
.4
"BLD",4291,"KRN",.4,"NM",0)
^9.68A^6^3
"BLD",4291,"KRN",.4,"NM",1,0)
PSNODDI1    FILE #50^50^0
"BLD",4291,"KRN",.4,"NM",2,0)
PSNEXMP1    FILE #50.68^50.68^0
"BLD",4291,"KRN",.4,"NM",6,0)
PSNODDI2    FILE #50^50^0
"BLD",4291,"KRN",.4,"NM","B","PSNEXMP1    FILE #50.68",2)

"BLD",4291,"KRN",.4,"NM","B","PSNODDI1    FILE #50",1)

"BLD",4291,"KRN",.4,"NM","B","PSNODDI2    FILE #50",6)

"BLD",4291,"KRN",.401,0)
.401
"BLD",4291,"KRN",.401,"NM",0)
^9.68A^^0
"BLD",4291,"KRN",.402,0)
.402
"BLD",4291,"KRN",.403,0)
.403
"BLD",4291,"KRN",.5,0)
.5
"BLD",4291,"KRN",.84,0)
.84
"BLD",4291,"KRN",3.6,0)
3.6
"BLD",4291,"KRN",3.8,0)
3.8
"BLD",4291,"KRN",9.2,0)
9.2
"BLD",4291,"KRN",9.8,0)
9.8
"BLD",4291,"KRN",9.8,"NM",0)
^9.68A^7^7
"BLD",4291,"KRN",9.8,"NM",1,0)
PSNODDI^^0^B2298840
"BLD",4291,"KRN",9.8,"NM",2,0)
PSNODDI1^^0^B1987221
"BLD",4291,"KRN",9.8,"NM",3,0)
PSNEXMP1^^0^B645714
"BLD",4291,"KRN",9.8,"NM",4,0)
PSNEXMPT^^0^B2326652
"BLD",4291,"KRN",9.8,"NM",5,0)
PSNACT^^0^B76089353
"BLD",4291,"KRN",9.8,"NM",6,0)
PSNLOOK^^0^B27535737
"BLD",4291,"KRN",9.8,"NM",7,0)
PSNAPIS^^0^B44635288
"BLD",4291,"KRN",9.8,"NM","B","PSNACT",5)

"BLD",4291,"KRN",9.8,"NM","B","PSNAPIS",7)

"BLD",4291,"KRN",9.8,"NM","B","PSNEXMP1",3)

"BLD",4291,"KRN",9.8,"NM","B","PSNEXMPT",4)

"BLD",4291,"KRN",9.8,"NM","B","PSNLOOK",6)

"BLD",4291,"KRN",9.8,"NM","B","PSNODDI",1)

"BLD",4291,"KRN",9.8,"NM","B","PSNODDI1",2)

"BLD",4291,"KRN",19,0)
19
"BLD",4291,"KRN",19,"NM",0)
^9.68A^19^19
"BLD",4291,"KRN",19,"NM",1,0)
PSNSUBM^^0
"BLD",4291,"KRN",19,"NM",2,0)
PSNODDI^^0
"BLD",4291,"KRN",19,"NM",3,0)
PSNEXMPT^^0
"BLD",4291,"KRN",19,"NM",4,0)
PSNLDG^^0
"BLD",4291,"KRN",19,"NM",5,0)
PSNPFN^^0
"BLD",4291,"KRN",19,"NM",6,0)
PSNCLS^^0
"BLD",4291,"KRN",19,"NM",7,0)
PSNOCLS^^0
"BLD",4291,"KRN",19,"NM",8,0)
PSNRPT^^0
"BLD",4291,"KRN",19,"NM",9,0)
PSNSUPLY^^0
"BLD",4291,"KRN",19,"NM",10,0)
PSNFRMLY^^0
"BLD",4291,"KRN",19,"NM",11,0)
PSNMCLS^^0
"BLD",4291,"KRN",19,"NM",12,0)
PSNVAGN^^0
"BLD",4291,"KRN",19,"NM",13,0)
PSNONDF^^0
"BLD",4291,"KRN",19,"NM",14,0)
PSNNFL^^0
"BLD",4291,"KRN",19,"NM",15,0)
PSNTER^^0
"BLD",4291,"KRN",19,"NM",16,0)
PSNCMOP^^0
"BLD",4291,"KRN",19,"NM",17,0)
PSNCLPR^^0
"BLD",4291,"KRN",19,"NM",18,0)
PSNVAPRINT^^0
"BLD",4291,"KRN",19,"NM",19,0)
PSNEXC^^0
"BLD",4291,"KRN",19,"NM","B","PSNCLPR",17)

"BLD",4291,"KRN",19,"NM","B","PSNCLS",6)

"BLD",4291,"KRN",19,"NM","B","PSNCMOP",16)

"BLD",4291,"KRN",19,"NM","B","PSNEXC",19)

"BLD",4291,"KRN",19,"NM","B","PSNEXMPT",3)

"BLD",4291,"KRN",19,"NM","B","PSNFRMLY",10)

"BLD",4291,"KRN",19,"NM","B","PSNLDG",4)

"BLD",4291,"KRN",19,"NM","B","PSNMCLS",11)

"BLD",4291,"KRN",19,"NM","B","PSNNFL",14)

"BLD",4291,"KRN",19,"NM","B","PSNOCLS",7)

"BLD",4291,"KRN",19,"NM","B","PSNODDI",2)

"BLD",4291,"KRN",19,"NM","B","PSNONDF",13)

"BLD",4291,"KRN",19,"NM","B","PSNPFN",5)

"BLD",4291,"KRN",19,"NM","B","PSNRPT",8)

"BLD",4291,"KRN",19,"NM","B","PSNSUBM",1)

"BLD",4291,"KRN",19,"NM","B","PSNSUPLY",9)

"BLD",4291,"KRN",19,"NM","B","PSNTER",15)

"BLD",4291,"KRN",19,"NM","B","PSNVAGN",12)

"BLD",4291,"KRN",19,"NM","B","PSNVAPRINT",18)

"BLD",4291,"KRN",19.1,0)
19.1
"BLD",4291,"KRN",19.1,"NM",0)
^9.68A^^
"BLD",4291,"KRN",101,0)
101
"BLD",4291,"KRN",101,"NM",0)
^9.68A^^
"BLD",4291,"KRN",409.61,0)
409.61
"BLD",4291,"KRN",409.61,"NM",0)
^9.68A^^
"BLD",4291,"KRN",771,0)
771
"BLD",4291,"KRN",771,"NM",0)
^9.68A^^
"BLD",4291,"KRN",870,0)
870
"BLD",4291,"KRN",870,"NM",0)
^9.68A^^
"BLD",4291,"KRN",8989.51,0)
8989.51
"BLD",4291,"KRN",8989.51,"NM",0)
^9.68A^^
"BLD",4291,"KRN",8989.52,0)
8989.52
"BLD",4291,"KRN",8989.52,"NM",0)
^9.68A^^
"BLD",4291,"KRN",8994,0)
8994
"BLD",4291,"KRN",8994,"NM",0)
^9.68A^^
"BLD",4291,"KRN","B",.4,.4)

"BLD",4291,"KRN","B",.401,.401)

"BLD",4291,"KRN","B",.402,.402)

"BLD",4291,"KRN","B",.403,.403)

"BLD",4291,"KRN","B",.5,.5)

"BLD",4291,"KRN","B",.84,.84)

"BLD",4291,"KRN","B",3.6,3.6)

"BLD",4291,"KRN","B",3.8,3.8)

"BLD",4291,"KRN","B",9.2,9.2)

"BLD",4291,"KRN","B",9.8,9.8)

"BLD",4291,"KRN","B",19,19)

"BLD",4291,"KRN","B",19.1,19.1)

"BLD",4291,"KRN","B",101,101)

"BLD",4291,"KRN","B",409.61,409.61)

"BLD",4291,"KRN","B",771,771)

"BLD",4291,"KRN","B",870,870)

"BLD",4291,"KRN","B",8989.51,8989.51)

"BLD",4291,"KRN","B",8989.52,8989.52)

"BLD",4291,"KRN","B",8994,8994)

"BLD",4291,"QUES",0)
^9.62^^
"BLD",4291,"REQB",0)
^9.611^6^3
"BLD",4291,"REQB",3,0)
PSN*4.0*62^1
"BLD",4291,"REQB",5,0)
PSN*4.0*65^1
"BLD",4291,"REQB",6,0)
PSN*4.0*73^1
"BLD",4291,"REQB","B","PSN*4.0*62",3)

"BLD",4291,"REQB","B","PSN*4.0*65",5)

"BLD",4291,"REQB","B","PSN*4.0*73",6)

"KRN",.4,2308,-1)
0^2
"KRN",.4,2308,0)
PSNEXMP1^3030507.1526^@^50.68^^@^3030723
"KRN",.4,2308,"F",2)
D ^PSNEXMP1;"";Z;"D ^PSNEXMP1"~
"KRN",.4,2308,"H")
VA PRODUCT LIST
"KRN",.4,2309,-1)
0^1
"KRN",.4,2309,0)
PSNODDI1^3030512.1522^@^50^^@^3030723
"KRN",.4,2309,"F",2)
D ^PSNODDI1;"";Z;"D ^PSNODDI1"~
"KRN",.4,2309,"H")
DRUG LIST
"KRN",.4,2310,-1)
0^6
"KRN",.4,2310,0)
PSNODDI2^3030513.1243^@^50^^@^3030723
"KRN",.4,2310,"F",1)
"DISPENSE DRUGS MATCHED TO VA PRODUCTS EXCLUDED FROM DRG-DRG INTERACTION CHECKING";C1~"GENERIC NAME";S2;C1~"VA DRUG CLASS";C50~"DOSE FORM";C66~
"KRN",.4,2310,"F",2)
"VA PRODUCT NAME";C1~
"KRN",.4,2310,"H")
DRUG LIST
"KRN",19,2238,-1)
0^19
"KRN",19,2238,0)
PSNEXC^Report of Attempted Match Drugs^^R^^^^^^^^
"KRN",19,2238,1,0)
^^9^9^2980922^^^^
"KRN",19,2238,1,1,0)
Report of drugs from local file which were not matched successfully using
"KRN",19,2238,1,2,0)
the option "Rematch / Match Single Drugs ". Even though these
"KRN",19,2238,1,3,0)
drugs were not matched, an entry was still made in National Drug
"KRN",19,2238,1,4,0)
Translation File. This report should be printed after the option "Verify
"KRN",19,2238,1,5,0)
Matches" has been executed and before the option "Merge National Drug File
"KRN",19,2238,1,6,0)
Data Into Local File" has been executed. This is a cumulative report and will
"KRN",19,2238,1,7,0)
include all entries since the entire matching process was initiated until
"KRN",19,2238,1,8,0)
the time when these entries are manually classed.
"KRN",19,2238,1,9,0)
This report requires 80 columns.
"KRN",19,2238,25)
PSNEXC
"KRN",19,2238,"U")
REPORT OF ATTEMPTED MATCH DRUG
"KRN",19,2239,-1)
0^5
"KRN",19,2239,0)
PSNPFN^VA Product Names Matched Report^^R^^^^^^^^
"KRN",19,2239,1,0)
^^7^7^2980922^^^^
"KRN",19,2239,1,1,0)
This option generates a report of all drugs that have been matched. It
"KRN",19,2239,1,2,0)
lists the name from the Local file, name from the National file, package
"KRN",19,2239,1,3,0)
size, package type and user's name. This option should be printed before
"KRN",19,2239,1,4,0)
the option "Merge National Drug File Data Into Local File". This report is
"KRN",19,2239,1,5,0)
also useful after running the automatic match by NDC process to review what
"KRN",19,2239,1,6,0)
has been matched. The data for this report is stored in the National Drug
"KRN",19,2239,1,7,0)
Translation File. This report requires 80 columns.
"KRN",19,2239,25)
PSNPFN
"KRN",19,2239,"U")
VA PRODUCT NAMES MATCHED REPOR
"KRN",19,2242,-1)
0^6
"KRN",19,2242,0)
PSNCLS^VA Drug Classification^^R^^^^^^^^
"KRN",19,2242,1,0)
^^5^5^2980922^^^^
"KRN",19,2242,1,1,0)
This option generates a report that lists all of the VA Drug Classification
"KRN",19,2242,1,2,0)
Codes and Classes. You are given the option of having the classification
"KRN",19,2242,1,3,0)
descriptions printed in the report. You can choose to print all of the drug
"KRN",19,2242,1,4,0)
classifications or a range of classifications. This report requires 80
"KRN",19,2242,1,5,0)
columns.
"KRN",19,2242,25)
PSNCLS
"KRN",19,2242,"U")
VA DRUG CLASSIFICATION
"KRN",19,2243,-1)
0^8
"KRN",19,2243,0)
PSNRPT^NDF Info From Your Local Drug File^^R^^^^^^^^
"KRN",19,2243,1,0)
^^6^6^2980922^^^^
"KRN",19,2243,1,1,0)
This option generates a report that contains information either for a
"KRN",19,2243,1,2,0)
specific range of drugs or for all drugs that have been merged. This option
"KRN",19,2243,1,3,0)
should be executed after the option "Merge National Drug File Data Into
"KRN",19,2243,1,4,0)
Local File" has been completed. Any drugs that contain no NDF information,
"KRN",19,2243,1,5,0)
(i.e., the drug has not been matched, verified, and merged), will be
"KRN",19,2243,1,6,0)
ignored. This report requires 132 columns.
"KRN",19,2243,25)
PSNRPT
"KRN",19,2243,99)
55070,54671
"KRN",19,2243,"U")
NDF INFO FROM YOUR LOCAL DRUG 
"KRN",19,2244,-1)
0^4
"KRN",19,2244,0)
PSNLDG^Local Drug File Report^^R^^^^^^^^
"KRN",19,2244,1,0)
^^6^6^2980922^^^^
"KRN",19,2244,1,1,0)
This option generates a report that contains selected information about
"KRN",19,2244,1,2,0)
the drugs in your local drug file. The report prints the local drug name,
"KRN",19,2244,1,3,0)
inactive date, NDC, and the DEA (Drug Enforcement Agency) value. This
"KRN",19,2244,1,4,0)
report can be used to determine which drugs have an NDC already assigned
"KRN",19,2244,1,5,0)
to them. It is recommended that this option be run first. This report
"KRN",19,2244,1,6,0)
will require 132 columns.
"KRN",19,2244,25)
PSNLDG
"KRN",19,2244,"U")
LOCAL DRUG FILE REPORT
"KRN",19,5926,-1)
0^7
"KRN",19,5926,0)
PSNOCLS^Local Drugs With No VA Drug Class Report^^R^^^^^^^^
"KRN",19,5926,1,0)
^^4^4^2980922^^^^
"KRN",19,5926,1,1,0)
This option produces a report showing all drugs from your local drug
"KRN",19,5926,1,2,0)
file which have no VA Drug Classification. This report should only be
"KRN",19,5926,1,3,0)
run after using the "Merge National Drug File Data Into Local File" and
"KRN",19,5926,1,4,0)
"Allow Unmatched Drugs To Be Classed" options.
"KRN",19,5926,25)
PSNOCLS
"KRN",19,5926,"U")
LOCAL DRUGS WITH NO VA DRUG CL
"KRN",19,5928,-1)
0^9
"KRN",19,5928,0)
PSNSUPLY^Supply (XA000) VA Class Report^^R^^^^^^^^
"KRN",19,5928,1,0)
^^7^7^2980922^^^
"KRN",19,5928,1,1,0)
This report should be run if you have already classed your
"KRN",19,5928,1,2,0)
local items using Version 1.0 of NDF. After the installation
"KRN",19,5928,1,3,0)
of Version 2.0 of NDF and the VA DRUG CLASS file is re-installed,
"KRN",19,5928,1,4,0)
you may wish to re-class your local items with a "XA" classification
"KRN",19,5928,1,5,0)
using the newly expanded "XA000" classification. It gives you a hard
"KRN",19,5928,1,6,0)
copy of the items from your local drug file which are "active" and
"KRN",19,5928,1,7,0)
have an "XA" VA Drug Classification.
"KRN",19,5928,25)
PSNSUPLY
"KRN",19,5928,"U")
SUPPLY (XA000) VA CLASS REPORT
"KRN",19,5929,-1)
0^10
"KRN",19,5929,0)
PSNFRMLY^Local Formulary Report^^R^^PSNMGR^^^^^^
"KRN",19,5929,1,0)
^^4^4^2980922^^^^
"KRN",19,5929,1,1,0)
This option produces a report of drugs marked as formulary in your local
"KRN",19,5929,1,2,0)
drug file. It will ask you if you want to include supply items.
"KRN",19,5929,1,3,0)
You are asked to either sort by Generic/Tradename or to pick a
"KRN",19,5929,1,4,0)
range of VA Drug Class codes. Only active drugs will print.
"KRN",19,5929,25)
PSNFRMLY
"KRN",19,5929,99)
55070,56065
"KRN",19,5929,"U")
LOCAL FORMULARY REPORT
"KRN",19,5931,-1)
0^11
"KRN",19,5931,0)
PSNMCLS^Manually Classed Drugs Report^^R^^^^^^^^
"KRN",19,5931,1,0)
^^5^5^2980922^^^
"KRN",19,5931,1,1,0)
This report will give you an alphabetic listing, by local generic name,
"KRN",19,5931,1,2,0)
of the drugs from your local drug file which are "active" and have been
"KRN",19,5931,1,3,0)
assigned a VA Drug Classification through the option "Allow Unmatched
"KRN",19,5931,1,4,0)
Drugs To Be Classed". This report will exclude your supply items that
"KRN",19,5931,1,5,0)
have been assigned an "XA" class.
"KRN",19,5931,25)
PSNMCLS
"KRN",19,5931,"U")
MANUALLY CLASSED DRUGS REPORT
"KRN",19,5934,-1)
0^12
"KRN",19,5934,0)
PSNVAGN^Report of VA Generic Names From National Drug^^R^^^^^^^^
"KRN",19,5934,1,0)
^^6^6^2980922^^^^
"KRN",19,5934,1,1,0)
This option provides a report of VA Generic Names from the National Drug
"KRN",19,5934,1,2,0)
File. You may print all or you may specify a range. This report may be
"KRN",19,5934,1,3,0)
useful when using the option "Rematch / Match Single Drugs". If
"KRN",19,5934,1,4,0)
you cannot find a match, you are asked to type in a VA Generic Name to 
"KRN",19,5934,1,5,0)
attempt to match to. You may type in one of the entries contained in this
"KRN",19,5934,1,6,0)
report to assist you in matching. This report requires 80 columns.
"KRN",19,5934,25)
PSNVAGN
"KRN",19,5934,"U")
REPORT OF VA GENERIC NAMES FRO
"KRN",19,8574,-1)
0^13
"KRN",19,8574,0)
PSNONDF^Local Drugs With NO Match to NDF Report^^R^^^^^^^^
"KRN",19,8574,1,0)
^19.06^3^3^3010117^^^
"KRN",19,8574,1,1,0)
This option generates a report that contains entries in your local drug
"KRN",19,8574,1,2,0)
file with no match to National Drug File. You have the option to print
"KRN",19,8574,1,3,0)
all drugs or only those marked for Outpatient Pharmacy use.
"KRN",19,8574,25)
PSNONDF
"KRN",19,8574,"U")
LOCAL DRUGS WITH NO MATCH TO N
"KRN",19,11202,-1)
0^17
"KRN",19,11202,0)
PSNCLPR^VA Product Names By Class Report^^R^^^^^^^^
"KRN",19,11202,1,0)
^^3^3^2980922^^
"KRN",19,11202,1,1,0)
This option generates a report of all VA Product Names sorted by VA Drug
"KRN",19,11202,1,2,0)
Class. You may sort by Primary, Secondary, or Both Classes. This
"KRN",19,11202,1,3,0)
information comes from the VA Products file.
"KRN",19,11202,25)
PSNCLPR
"KRN",19,11202,"U")
VA PRODUCT NAMES BY CLASS REPO
"KRN",19,11203,-1)
0^16
"KRN",19,11203,0)
PSNCMOP^VA Products Marked for CMOP Transmission^^R^^^^^^^^
"KRN",19,11203,1,0)
^^3^3^2980922^^
"KRN",19,11203,1,1,0)
This option generates a report of all VA Product Names marked for CMOP
"KRN",19,11203,1,2,0)
transmission. You may sort by VA Product Name or by VA Identifier. This
"KRN",19,11203,1,3,0)
information comes from the VA Product file.
"KRN",19,11203,25)
PSNCMOP
"KRN",19,11203,"U")
VA PRODUCTS MARKED FOR CMOP TR
"KRN",19,11204,-1)
0^14
"KRN",19,11204,0)
PSNNFL^National Formulary Report^^R^^^^^^^^
"KRN",19,11204,1,0)
^^2^2^2980922^^^
"KRN",19,11204,1,1,0)
This option generates a report of National Formulary Names marked as
"KRN",19,11204,1,2,0)
National Formulary. This information comes from the VA Product file.
"KRN",19,11204,25)
PSNNFL
"KRN",19,11204,"U")
NATIONAL FORMULARY REPORT
"KRN",19,11206,-1)
0^15
"KRN",19,11206,0)
PSNTER^Drug-Drug Interaction Report^^R^^^^^^^^
"KRN",19,11206,1,0)
^^3^3^2980922^^
"KRN",19,11206,1,1,0)
This option generates a report of all drug-drug interactions
"KRN",19,11206,1,2,0)
(both critical and significant) contained in the Drug Interactions
"KRN",19,11206,1,3,0)
file.
"KRN",19,11206,25)
PSNTER
"KRN",19,11206,"U")
DRUG-DRUG INTERACTION REPORT
"KRN",19,11823,-1)
0^18
"KRN",19,11823,0)
PSNVAPRINT^Local Drug/VA Print Name Report^^R^^^^^^^^NATIONAL DRUG FILE
"KRN",19,11823,1,0)
^^1^1^3010117^
"KRN",19,11823,1,1,0)
This report generates a report that contains active entries in the local drug file where the GENERIC NAME does not match the VA PRINT NAME.
"KRN",19,11823,25)
PSNGPN
"KRN",19,11823,"U")
LOCAL DRUG/VA PRINT NAME REPOR
"KRN",19,12298,-1)
0^2
"KRN",19,12298,0)
PSNODDI^Local Drugs Excluded from Drug-Drug Interactions^^R^^^^^^^^
"KRN",19,12298,1,0)
^^3^3^3030528^
"KRN",19,12298,1,1,0)
This report gives you a printed copy of local dispense drugs which are
"KRN",19,12298,1,2,0)
matched to VA Products that are marked as EXCLUDE from drug-drug
"KRN",19,12298,1,3,0)
interaction checking.
"KRN",19,12298,25)
PSNODDI
"KRN",19,12298,"U")
LOCAL DRUGS EXCLUDED FROM DRUG
"KRN",19,12299,-1)
0^3
"KRN",19,12299,0)
PSNEXMPT^VA Products Excluded from Drug-Drug Interactions^^R^^^^^^^^
"KRN",19,12299,1,0)
^19.06^2^2^3030616^^
"KRN",19,12299,1,1,0)
This report gives you a printed copy of active VA Products marked as
"KRN",19,12299,1,2,0)
EXCLUDE from drug-drug interaction checking.
"KRN",19,12299,25)
PSNEXMPT
"KRN",19,12299,"U")
VA PRODUCTS EXCLUDED FROM DRUG
"KRN",19,12300,-1)
0^1
"KRN",19,12300,0)
PSNSUBM^National Drug File Reports Menu^^M^^^^^^^^
"KRN",19,12300,1,0)
^^2^2^3030616^
"KRN",19,12300,1,1,0)
This option is a Sub-menu which contains all the report options
"KRN",19,12300,1,2,0)
in the National Drug File package.
"KRN",19,12300,10,0)
^19.01IP^18^18
"KRN",19,12300,10,1,0)
2244^LDF^1
"KRN",19,12300,10,1,"^")
PSNLDG
"KRN",19,12300,10,2,0)
2238^ATMP^3
"KRN",19,12300,10,2,"^")
PSNEXC
"KRN",19,12300,10,3,0)
2239^PROD^4
"KRN",19,12300,10,3,"^")
PSNPFN
"KRN",19,12300,10,4,0)
5926^NOCL^5
"KRN",19,12300,10,4,"^")
PSNOCLS
"KRN",19,12300,10,5,0)
2242^CLVA^6
"KRN",19,12300,10,5,"^")
PSNCLS
"KRN",19,12300,10,6,0)
2243^DFL^7
"KRN",19,12300,10,6,"^")
PSNRPT
"KRN",19,12300,10,7,0)
5928^SUPL^8
"KRN",19,12300,10,7,"^")
PSNSUPLY
"KRN",19,12300,10,8,0)
5929^LOCF^11
"KRN",19,12300,10,8,"^")
PSNFRMLY
"KRN",19,12300,10,9,0)
5931^MANC^9
"KRN",19,12300,10,9,"^")
PSNMCLS
"KRN",19,12300,10,10,0)
5934^VAGN^2
"KRN",19,12300,10,10,"^")
PSNVAGN
"KRN",19,12300,10,11,0)
8574^NMAT^10
"KRN",19,12300,10,11,"^")
PSNONDF
"KRN",19,12300,10,12,0)
11204^NATF^12
"KRN",19,12300,10,12,"^")
PSNNFL
"KRN",19,12300,10,13,0)
11206^DDIN^13
"KRN",19,12300,10,13,"^")
PSNTER
"KRN",19,12300,10,14,0)
11203^CMOP^14
"KRN",19,12300,10,14,"^")
PSNCMOP
"KRN",19,12300,10,15,0)
11202^PNCL^15
"KRN",19,12300,10,15,"^")
PSNCLPR
"KRN",19,12300,10,16,0)
11823^LDPN^16
"KRN",19,12300,10,16,"^")
PSNVAPRINT
"KRN",19,12300,10,17,0)
12298^LDRG^17
"KRN",19,12300,10,17,"^")
PSNODDI
"KRN",19,12300,10,18,0)
12299^VDRG^18
"KRN",19,12300,10,18,"^")
PSNEXMPT
"KRN",19,12300,99)
59338,36421
"KRN",19,12300,"U")
NATIONAL DRUG FILE REPORTS MEN
"MBREQ")
0
"ORD",5,.4)
.4;5;;;EDEOUT^DIFROMSO(.4,DA,"",XPDA);FPRE^DIFROMSI(.4,"",XPDA);EPRE^DIFROMSI(.4,DA,$E("N",$G(XPDNEW)),XPDA,"",OLDA);;EPOST^DIFROMSI(.4,DA,"",XPDA);DEL^DIFROMSK(.4,"",%)
"ORD",5,.4,0)
PRINT TEMPLATE
"ORD",18,19)
19;18;;;OPT^XPDTA;OPTF1^XPDIA;OPTE1^XPDIA;OPTF2^XPDIA;;OPTDEL^XPDIA
"ORD",18,19,0)
OPTION
"PKG",136,-1)
1^1
"PKG",136,0)
NATIONAL DRUG FILE^PSN^This is the National Drug File Package V 3.14
"PKG",136,20,0)
^9.402P^^
"PKG",136,22,0)
^9.49I^1^1
"PKG",136,22,1,0)
4.0^2981030^2981223^11595
"PKG",136,22,1,"PAH",1,0)
70^3030728^11849
"PKG",136,22,1,"PAH",1,1,0)
^^5^5^3030728
"PKG",136,22,1,"PAH",1,1,1,0)
This Build builds on the foundation to identify VA Products from the VA
"PKG",136,22,1,"PAH",1,1,2,0)
PRODUCT file (#50.68) as EXCLUDE from drug-drug interaction checking.
"PKG",136,22,1,"PAH",1,1,3,0)
Two new menu options are included to print marked VA Products. Two existing
"PKG",136,22,1,"PAH",1,1,4,0)
options have been enhanced to display the new field to the user. A enhanced
"PKG",136,22,1,"PAH",1,1,5,0)
API routine PSNAPIS is also included.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
7
"RTN","PSNACT")
0^5^B76089353
"RTN","PSNACT",1,0)
PSNACT ;BIR/DMA&WRT-inquiries by VAPN, CMOP ID, or NDC ; 07/02/03 14:01
"RTN","PSNACT",2,0)
 ;;4.0; NATIONAL DRUG FILE;**22,35,47,62,65,70**; 30 Oct 98
"RTN","PSNACT",3,0)
 ;
"RTN","PSNACT",4,0)
 ;Reference to ^PS(50.606 supported by DBIA #2174
"RTN","PSNACT",5,0)
 ;
"RTN","PSNACT",6,0)
 I '$D(IORVON) S X="IORVON;IORVOFF" D ENDR^%ZISS
"RTN","PSNACT",7,0)
 K DIC,DIR F ZXX=0:0 W ! D TEXT,ASKIT Q:$D(DIRUT)
"RTN","PSNACT",8,0)
 K QUIT,DIR,DIC,OLDDA,PROMPT,J,I,IEN,PPP,Y,Y1,Y3,Y5,Y6,Y7,Z0,Z1,Z3,Z5,Z6,Z7,ZA,ZXX,ASK,NDX,SIE,PSN,PSN1,MORE,SIE1,PMIS,QQQ,ENG,MAP
"RTN","PSNACT",9,0)
 Q
"RTN","PSNACT",10,0)
TEXT W !,"This option allows you to lookup NDF file information three ways (VA Product",!,"Name, NDC, or CMOP ID number).",!
"RTN","PSNACT",11,0)
 Q
"RTN","PSNACT",12,0)
ASKIT S DIR(0)="SA^VA:VA PRODUCT;N:NDC;C:CMOP ID",DIR("A")="LOOKUP BY (VA) PRODUCT, (N)DC, OR (C)MOP ID ? " D ^DIR G END:$D(DIRUT) S ASK=Y(0)
"RTN","PSNACT",13,0)
 I ASK="NDC" D NDC
"RTN","PSNACT",14,0)
 I ASK="VA PRODUCT"  D LISTNDC
"RTN","PSNACT",15,0)
 I ASK="CMOP ID" D CMOP
"RTN","PSNACT",16,0)
 Q
"RTN","PSNACT",17,0)
ENTER K QQQ S DA=+Y,Y1=^PSNDF(50.68,DA,1),Y3=^(3),Y7=$G(^(7)),Y5=$G(^(5)),Y6=$G(^PSNDF(50.68,DA,6,1,0)),QQQ=$P(Y1,"^",5) D GCN D
"RTN","PSNACT",18,0)
 .W @IOF,!,"VA Product Name: ",$P(Y(0),"^"),$$DT($P(Y7,"^",3))
"RTN","PSNACT",19,0)
 .W !,"VA Generic Name: ",$P(^PSNDF(50.6,+$P(Y(0),"^",2),0),"^"),!,"Dose Form: ",$P(^PS(50.606,+$P(Y(0),"^",3),0),"^"),"   Strength: ",$P(Y(0),"^",4)," Units: ",$P($G(^PS(50.607,+$P(Y(0),"^",5),0)),"^")
"RTN","PSNACT",20,0)
 .W !,"National Formulary Name: ",$P(Y(0),"^",6),!,"VA Print Name: ",$P(Y1,"^"),!,"VA Product Identifier: ",$P(Y1,"^",2)," Transmit to CMOP: ",$S($P(Y1,"^",3):"Yes",1:"No")
"RTN","PSNACT",21,0)
 .W " VA Dispense Unit: ",$P($G(^PSNDF(50.64,+$P(Y1,"^",4),0)),"^")
"RTN","PSNACT",22,0)
 .W !,"PMIS: ",PMIS,!,"Active Ingredients: " S K=0 F  S K=$O(^PSNDF(50.68,DA,2,K)) Q:'K!($G(QUIT))  S X=^(K,0),ING=^PS(50.416,K,0) S:$P(ING,"^",2) ING=^PS(50.416,$P(ING,"^",2),0) D
"RTN","PSNACT",23,0)
 ..D:($Y+5)>IOSL&('$G(QUIT)) HANG Q:$G(QUIT)  W ?23,$P(ING,"^"),"  Strength: ",$P(X,"^",2)," Units :",$P($G(^PS(50.607,+$P(X,"^",3),0)),"^"),!
"RTN","PSNACT",24,0)
 .Q:$G(QUIT)  W !,"Primary VA Drug Class: ",$P($G(^PS(50.605,+Y3,0),"Unknown"),"^"),!,"Secondary VA Drug Class: " S K=0 F  S K=$O(^PSNDF(50.68,DA,4,K)) Q:'K  W ?26,$P($G(^PS(50.605,+K,0),"Unknown"),"^"),!
"RTN","PSNACT",25,0)
 .W !,"CS Federal Schedule: "_$S($P($G(^PSNDF(50.68,DA,7)),"^")]"":$P(^PSNDF(50.68,DA,7),"^"),1:"")
"RTN","PSNACT",26,0)
 .W !,"National Formulary Indicator: " W:$P(Y5,"^")=1 "Yes" W:$P(Y5,"^")=0 "No"
"RTN","PSNACT",27,0)
 .W !,"National Formulary Restriction: ",!,$P(Y6,"^")
"RTN","PSNACT",28,0)
 .I $G(^PSNDF(50.68,DA,8)) W !,"Exclude Drg-Drg Interaction Ck: Yes (No check for Drug-Drug Interactions)"
"RTN","PSNACT",29,0)
 Q
"RTN","PSNACT",30,0)
 K DA,DIE,DIE,DIRUT,DR,ING,K,OLDDA,X,Y,Y1,Y3,Y7 Q
"RTN","PSNACT",31,0)
 ;
"RTN","PSNACT",32,0)
NDC ;OR UPN
"RTN","PSNACT",33,0)
 K PROMPT S DIR(0)="SA^N:NDC;U:UPN",DIR("A")="NDC (N) or UPN (U) ? " D ^DIR G END:$D(DIRUT) S PROMPT=Y(0)
"RTN","PSNACT",34,0)
 I PROMPT="NDC" S DIR(0)="F",DIR("A")="Enter NDC with or without Dashes (-)" D ^DIR G END:$D(DIRUT) D:X["-" PAD S DIC=50.67,DIC(0)="EQZN",D=PROMPT D IX^DIC Q:Y<0  S DA=+Y,NDF=Y(0) D LKNDC
"RTN","PSNACT",35,0)
 I PROMPT="UPN" S DIC=50.67,DIC(0)="AEQZN",DIC("A")="Select "_PROMPT_":"_" ",D=PROMPT D IX^DIC Q:Y<0  S DA=+Y,NDF=Y(0) D LKNDC
"RTN","PSNACT",36,0)
 Q
"RTN","PSNACT",37,0)
LKNDC W @IOF,!,"NDC: ",$P(NDF,"^",2),$$DT($P(NDF,"^",7)),"  UPN: ",$P(NDF,"^",3),!,"VA Product Name: ",$P(^PSNDF(50.68,$P(NDF,"^",6),0),"^"),!,"Manufacturer: ",$P($G(^PS(55.95,+$P(NDF,"^",4),0)),"^"),"  Trade Name: ",$P(NDF,"^",5),!,"Route: "
"RTN","PSNACT",38,0)
 S K=0 F  S K=$O(^PSNDF(50.67,DA,1,K)) Q:'K  W $P(^(K,0),"^")," "
"RTN","PSNACT",39,0)
 W !,"Package Size: ",$P(^PS(50.609,$P(NDF,"^",8),0),"^"),"  Package Type: ",$P(^PS(50.608,$P(NDF,"^",9),0),"^")
"RTN","PSNACT",40,0)
 S ZA=$P(NDF,"^",6) D ENTER1
"RTN","PSNACT",41,0)
 Q
"RTN","PSNACT",42,0)
END K DA,DA,DIC,DIE,DIR,DR,IN,ING,J,K,L,NEW,NDF,OLD,OLDDA,PROMPT,X,Y,Y1,Y3,Y7,^TMP($J) Q
"RTN","PSNACT",43,0)
 Q
"RTN","PSNACT",44,0)
 ;
"RTN","PSNACT",45,0)
PRODI ;INQUIRE INTO 50.68
"RTN","PSNACT",46,0)
 F  S DIC="^PSNDF(50.68,",DIC(0)="AEQM" D ^DIC Q:Y<0  S DA=+Y D EN^DIQ
"RTN","PSNACT",47,0)
 K DA,DIC,X,Y Q
"RTN","PSNACT",48,0)
 ;
"RTN","PSNACT",49,0)
NDCI ;INQUIRE INTO 50.67
"RTN","PSNACT",50,0)
 S DIR(0)="SA^N:NDC;U:UPN;T:TRADE;P:PRODUCT",DIR("A")="NDC (N), UPN (U), Trade name (T), or Product (P) " D ^DIR G END:$D(DIRUT) S PROMPT=Y(0) G LISTNDC:PROMPT["PRO",LISTNDC1:PROMPT="NDC" I PROMPT["T" S PROMPT="T"
"RTN","PSNACT",51,0)
 F  S DIC="^PSNDF(50.67,",DIC(0)="AEQZS",DIC("A")="Select "_PROMPT S:PROMPT="T" DIC("A")=DIC("A")_"rade name" S DIC("A")=DIC("A")_" ",D=PROMPT D IX^DIC Q:Y<0  S DA=+Y D EN^DIQ
"RTN","PSNACT",52,0)
 K DA,DIC,DIR,PROMPT,X,Y Q
"RTN","PSNACT",53,0)
 ;
"RTN","PSNACT",54,0)
LINK ;LINK NDCS OR UPNS
"RTN","PSNACT",55,0)
 S DIR(0)="SA^N:NDC;U:UPN",DIR("A")="NDC (N) or UPN (U) ",DIR("B")="NDC" D ^DIR G END:$D(DIRUT) S PROMPT=Y(0)
"RTN","PSNACT",56,0)
 F  Q:$D(DIRUT)!(Y<0)  S DIC=50.67,DIC(0)="AEQZ",DIC("A")="Enter Current "_PROMPT_" ",D=PROMPT D IX^DIC Q:Y<0  S DA=+Y,OLD=$P(Y(0),"^",$S(PROMPT="NDC":2,1:3)) D
"RTN","PSNACT",57,0)
 .K DIR S DIR(0)="F^"_$S(PROMPT="NDC":"12:12",1:"1:40")_"^W:$D(^PSNDF(50.67,PROMPT,X)) !!,""That "_PROMPT_" already exists"",! K:$D(^PSNDF(50.67,PROMPT,X)) X",DIR("A")="Enter a new "_PROMPT_" " D ^DIR K DIR Q:$D(DIRUT)  S NEW=Y
"RTN","PSNACT",58,0)
 .I PROMPT="NDC" D
"RTN","PSNACT",59,0)
 ..S IN=$O(^PSNDF(50.67,DA,2,"B",NEW,0)) I IN S DIR(0)="Y" W !,"Those NDCs are already linked" S DIR("A")="Do you want to unlink them " D ^DIR Q:$D(DIRUT)  Q:'Y
"RTN","PSNACT",60,0)
 ..I IN S DA(1)=DA,DA=IN,DIE="^PSNDF(50.67,"_DA(1)_",2,",DR=".01///@;" D ^DIE W !,"Unlinked",! Q
"RTN","PSNACT",61,0)
 ..I 'IN S DIE="^PSNDF(50.67,",DR="1////"_NEW D ^DIE K DD,DO S DA(1)=DA,DIC="^PSNDF(50.67,"_DA(1)_",2,",DIC(0)="L",DLAYGO=50.67,DIC("P")=$P(^DD(50.67,11,0),"^",2),X=OLD D ^DIC W !,"Linked",! Q
"RTN","PSNACT",62,0)
 .I PROMPT="UPN" D
"RTN","PSNACT",63,0)
 ..S IN=$O(^PSNDF(50.67,DA,3,"B",NEW,0)) I IN S DIR(0)="Y" W !,"Those UPNs are already linked" S DIR("A")="Do you want to unlink them " D ^DIR Q:$D(DIRUT)  Q:'Y
"RTN","PSNACT",64,0)
  ..S DA(1)=DA,DA=IN,DIE="^PSNDF(50.67,"_DA(1)_",3,",DR=".01///@;" D ^DIE W !,"Unlinked",! Q
"RTN","PSNACT",65,0)
 ..I 'IN S DIE="^PSNDF(50.67,",DR="1////"_NEW D ^DIE K DD,DO S DA(1)=DA,DIC="^PSNDF(50.67,"_DA(1)_",3,",DIC(0)="L",DLAYGO=50.67,DIC("P")=$P(^DD(50.67,12,0),"^",2),X=OLD D ^DIC W !,"Linked",! Q
"RTN","PSNACT",66,0)
 G LINK
"RTN","PSNACT",67,0)
 ;
"RTN","PSNACT",68,0)
LISTNDC ;LOOK UP NDCS BY PRODUCT
"RTN","PSNACT",69,0)
 K L,DA,^TMP($J),DIC
"RTN","PSNACT",70,0)
 S DIC=50.68,DIC(0)="AQEMZ" D ^DIC G END:Y<0 S IEN=+Y D ENTER F SIE=0:0 S SIE=$O(^PSNDF(50.68,"ANDC",IEN,SIE)) Q:'SIE!($G(QUIT))  D PRNT ; S ^TMP($J,"A"_$P(^PSNDF(50.67,SIE,0),"^",2)_"^"_SIE)=""
"RTN","PSNACT",71,0)
 Q
"RTN","PSNACT",72,0)
PRT D:($Y+5)>IOSL&('$G(QUIT)) HANG Q:$G(QUIT)  S DA=SIE,DIC="^PSNDF(50.67," W ! D EN^DIQ
"RTN","PSNACT",73,0)
 Q
"RTN","PSNACT",74,0)
 ;
"RTN","PSNACT",75,0)
LISTNDC1 ;LOOK UP PARTIAL NDC
"RTN","PSNACT",76,0)
 ;
"RTN","PSNACT",77,0)
 F  K ^TMP($J) S QUIT=0,DIR(0)="F^1:12",DIR("A")="Select NDC " D ^DIR Q:$D(DIRUT)  S PSN1=Y,PSN=Y D
"RTN","PSNACT",78,0)
 .I $D(^PSNDF(50.67,"NDC",PSN1)) S DA=0 F  S DA=$O(^PSNDF(50.67,"NDC",PSN1,DA)) S:'DA QUIT=1 Q:QUIT  S DIC="^PSNDF(50.67," W ! D EN^DIQ
"RTN","PSNACT",79,0)
 .Q:QUIT
"RTN","PSNACT",80,0)
 .I PSN1?."0".E S PSN1=PSN1_"/"
"RTN","PSNACT",81,0)
 .I PSN1?.N,PSN1=+PSN1 S PSN1=$$LJ^XLFSTR(PSN1,12,0)-1
"RTN","PSNACT",82,0)
 .S ZCT=0 F  Q:QUIT  S PSN1=$O(^PSNDF(50.67,"NDC",PSN1)),DA=0 Q:$E(PSN1,1,$L(PSN))'=PSN  F  Q:QUIT  S DA=$O(^PSNDF(50.67,"NDC",PSN1,DA)) Q:'DA  S ZCT=ZCT+1,^TMP($J,ZCT)=DA W !,$J(ZCT,5),"  ",PSN1 D
"RTN","PSNACT",83,0)
 ..S MORE=$E($O(^PSNDF(50.67,"NDC",PSN1)),1,$L(PSN))=PSN!$O(^(PSN1,DA)) I ZCT#5&MORE Q
"RTN","PSNACT",84,0)
 ..S DIR(0)="NOA^1:"_ZCT,DIR("A")="Choose 1 - "_ZCT_" or ^ to quit " S:MORE DIR("A")=DIR("A")_"or return to see more "
"RTN","PSNACT",85,0)
 ..D ^DIR I $D(DUOUT)!$D(DTOUT) S QUIT=1 Q
"RTN","PSNACT",86,0)
 ..I Y="" Q
"RTN","PSNACT",87,0)
 ..S DA=^TMP($J,Y),QUIT=1,DIC="^PSNDF(50.67," W !! D EN^DIQ Q
"RTN","PSNACT",88,0)
 G END
"RTN","PSNACT",89,0)
ENTER1 K QQQ S Z0=^PSNDF(50.68,ZA,0),Z1=^PSNDF(50.68,ZA,1),Z3=^PSNDF(50.68,ZA,3),Z7=$G(^PSNDF(50.68,ZA,7)),Z5=$G(^PSNDF(50.68,ZA,5)),Z6=$G(^PSNDF(50.68,ZA,6,1,0)),QQQ=$P(Z1,"^",5) D GCN D
"RTN","PSNACT",90,0)
 .W !,"VA Product Name: ",$P(Z0,"^"),!,"VA Generic Name: ",$P(^PSNDF(50.6,+$P(Z0,"^",2),0),"^"),!,"Dose Form: ",$P(^PS(50.606,+$P(Z0,"^",3),0),"^"),"   Strength: ",$P(Z0,"^",4)," Units: ",$P($G(^PS(50.607,+$P(Z0,"^",5),0)),"^")
"RTN","PSNACT",91,0)
 .W !,"National Formulary Name: ",$P(Z0,"^",6),!,"VA Print Name: ",$P(Z1,"^"),!,"VA Product Identifier: ",$P(Z1,"^",2)," Transmit to CMOP: ",$S($P(Z1,"^",3):"Yes",1:"No")
"RTN","PSNACT",92,0)
 .W " VA Dispense Unit: ",$P($G(^PSNDF(50.64,+$P(Z1,"^",4),0)),"^")
"RTN","PSNACT",93,0)
 .W !,"PMIS: ",PMIS,!,"Active Ingredients: " S K=0 F  S K=$O(^PSNDF(50.68,ZA,2,K)) Q:'K!($G(QUIT))  S X=^(K,0),ING=^PS(50.416,K,0) S:$P(ING,"^",2) ING=^PS(50.416,$P(ING,"^",2),0) D
"RTN","PSNACT",94,0)
 ..D:($Y+5)>IOSL&('$G(QUIT)) HANG Q:$G(QUIT)  W ?23,$P(ING,"^"),"  Strength: ",$P(X,"^",2)," Units :",$P($G(^PS(50.607,+$P(X,"^",3),0)),"^"),!
"RTN","PSNACT",95,0)
 .Q:$G(QUIT)  W !,"Primary VA Drug Class: ",$P($G(^PS(50.605,+Z3,0),"Unknown"),"^"),!,"Secondary VA Drug Class: " S K=0 F  S K=$O(^PSNDF(50.68,ZA,4,K)) Q:'K  W ?26,$P($G(^PS(50.605,+K,0),"Unknown"),"^"),!
"RTN","PSNACT",96,0)
 .W !,"CS Federal Schedule: "_$S($P(Z7,"^")]"":$P(Z7,"^"),1:"")
"RTN","PSNACT",97,0)
 .W !,"National Formulary Indicator: " W:$P(Z5,"^")=1 "Yes" W:$P(Z5,"^")=0 "No"
"RTN","PSNACT",98,0)
 .W !,"National Formulary Restriction: ",!,$P(Z6,"^")
"RTN","PSNACT",99,0)
 .I $G(^PSNDF(50.68,DA,8)) W !,"Exclude Drg-Drg Interaction Ck: Yes (No check for Drug-Drug Interactions)"
"RTN","PSNACT",100,0)
 Q
"RTN","PSNACT",101,0)
CMOP K DIC S DIC="^PSNDF(50.68,",DIC(0)="QEAZ",D="C",DIC("A")="CMOP ID: " D MIX^DIC1 Q:Y<0  S IEN=+Y D ENTER F SIE=0:0 S SIE=$O(^PSNDF(50.68,"ANDC",IEN,SIE)) Q:'SIE  D PRNT
"RTN","PSNACT",102,0)
 Q
"RTN","PSNACT",103,0)
HANG K DIR S DIR(0)="E",DIR("A")="Press return to continue or '^' to exit" D ^DIR W @IOF S $X=0 S:Y'=1 QUIT=1
"RTN","PSNACT",104,0)
 Q
"RTN","PSNACT",105,0)
PRNT D:($Y+5)>IOSL&('$G(QUIT)) HANG Q:$G(QUIT)
"RTN","PSNACT",106,0)
 S NDX=^PSNDF(50.67,SIE,0)
"RTN","PSNACT",107,0)
 W !!,"NDC: ",$P(NDX,"^",2),"  UPN: ",$P(NDX,"^",3),!,"VA Product Name: ",$P(^PSNDF(50.68,$P(NDX,"^",6),0),"^"),!,"Manufacturer: ",$P($G(^PS(55.95,+$P(NDX,"^",4),0)),"^"),"  Trade Name: ",$P(NDX,"^",5),!,"Route: "
"RTN","PSNACT",108,0)
 S SIE1=0 F  S SIE1=$O(^PSNDF(50.67,SIE,1,SIE1)) Q:'SIE1  W $P(^(SIE1,0),"^")
"RTN","PSNACT",109,0)
 W !,"Package Size: ",$P(^PS(50.609,$P(NDX,"^",8),0),"^"),"  Package Type: ",$P(^PS(50.608,$P(NDX,"^",9),0),"^")
"RTN","PSNACT",110,0)
 Q
"RTN","PSNACT",111,0)
PAD S ANS=Y F VV=1:1:3 S VV1=$S(VV=1:6,VV=2:4,VV=3:2) D PAD1
"RTN","PSNACT",112,0)
 S ANS=$P(ANS,"-",1)_$P(ANS,"-",2)_$P(ANS,"-",3) K VV,VV1
"RTN","PSNACT",113,0)
 S ANS=$TR(ANS,"-"),X=ANS
"RTN","PSNACT",114,0)
 Q
"RTN","PSNACT",115,0)
PAD1 I $L($P(ANS,"-",VV))<VV1 S $P(ANS,"-",VV)=$E("0000000",1,VV1-$L($P(ANS,"-",VV)))_$P(ANS,"-",VV)
"RTN","PSNACT",116,0)
 Q
"RTN","PSNACT",117,0)
DT(Y) ;Inactivation Date display
"RTN","PSNACT",118,0)
 X:Y ^DD("DD") Q $S(Y]"":IORVON_" ***INACTIVE: "_Y_" ***"_IORVOFF,1:"")
"RTN","PSNACT",119,0)
 Q
"RTN","PSNACT",120,0)
GCN I QQQ']"" S PMIS="None"
"RTN","PSNACT",121,0)
 I QQQ]"",'$D(^PS(50.623,"B",QQQ)) S PMIS="None"
"RTN","PSNACT",122,0)
 I QQQ]"",$D(^PS(50.623,"B",QQQ)) S MAP=$O(^PS(50.623,"B",QQQ,0)),ENG=$P(^PS(50.623,MAP,0),"^",2),PMIS=$P(^PS(50.621,+ENG,0),"^")
"RTN","PSNACT",123,0)
 Q
"RTN","PSNACT",124,0)
 I QQQ]"",$D(^PS(50.623,"B",QQQ)) S MAP=$O(^PS(50.623,"B",QQQ,0)),ENG=$P(^PS(50.623,MAP,0),"^",2),PMIS=$P(^PS(50.621,+ENG,0),"^")
"RTN","PSNACT",125,0)
 Q
"RTN","PSNAPIS")
0^7^B44635288
"RTN","PSNAPIS",1,0)
PSNAPIS ;BIR/DMA-APIs for NDF ; 07/02/03 14:07
"RTN","PSNAPIS",2,0)
 ;;4.0; NATIONAL DRUG FILE;**2,3,47,70**; 30 Oct 98
"RTN","PSNAPIS",3,0)
 ;
"RTN","PSNAPIS",4,0)
 ;Reference to ^PSDRUG supported by DBIA #2192
"RTN","PSNAPIS",5,0)
 ;Reference to ^PS(50.606 supported by DBIA #2174
"RTN","PSNAPIS",6,0)
 ;
"RTN","PSNAPIS",7,0)
PSA(NDC,LIST) ;ENTRY FOR DRUG ACCOUNTABILITY
"RTN","PSNAPIS",8,0)
 N Y,PN,PN1,P50,J
"RTN","PSNAPIS",9,0)
 S Y=$Q(^PSNDF(50.67,"NDC",NDC)) I $QS(Y,3)'=NDC Q 0
"RTN","PSNAPIS",10,0)
 S Y=^PSNDF(50.67,$QS(Y,4),0),Y=$P(Y,"^",6),PN=$P(^PSNDF(50.68,Y,0),"^"),PN1=$E(PN,1,30)
"RTN","PSNAPIS",11,0)
 S P50=0,J=0 F  S P50=$O(^PSDRUG("VAPN",PN1,P50)) Q:'P50  I $P(^PSDRUG(P50,"ND"),"^",2)=PN S LIST(P50)=$P(^PSDRUG(P50,0),"^"),J=J+1
"RTN","PSNAPIS",12,0)
 Q J
"RTN","PSNAPIS",13,0)
 ;
"RTN","PSNAPIS",14,0)
PSJING(DA1,K,LIST) ;ENTRY FOR INGREDIENTS
"RTN","PSNAPIS",15,0)
 N X,CT
"RTN","PSNAPIS",16,0)
 ;DA1 IS SUPERFLUOUS, BUT WE LEAVE IN FOR COMPATABILITY
"RTN","PSNAPIS",17,0)
 I 'K!('$D(^PSNDF(50.68,+K))) Q 0
"RTN","PSNAPIS",18,0)
 S DA=0 F CT=0:1 S DA=$O(^PSNDF(50.68,K,2,DA)) Q:'DA  S X=^(DA,0),LIST(+X)=+X_"^"_$P(^PS(50.416,+X,0),"^")_"^"_$P(X,"^",2)_"^" S:$P(X,"^",3)]"" LIST(+X)=LIST(+X)_$P($G(^PS(50.607,$P(X,"^",3),0)),"^")
"RTN","PSNAPIS",19,0)
 Q CT
"RTN","PSNAPIS",20,0)
 ;
"RTN","PSNAPIS",21,0)
PSJDF(DA,K) ;GET DOSE FORM
"RTN","PSNAPIS",22,0)
 N X,DF
"RTN","PSNAPIS",23,0)
 ;AGAIN DA IS SUPERFLUOUS
"RTN","PSNAPIS",24,0)
 I 'K!('$D(^PSNDF(50.68,+K))) Q 0
"RTN","PSNAPIS",25,0)
 S X=$P(^PSNDF(50.68,K,0),"^",3),DF=$P($G(^PS(50.606,X,0)),"^")
"RTN","PSNAPIS",26,0)
 Q X_"^"_DF
"RTN","PSNAPIS",27,0)
 ;
"RTN","PSNAPIS",28,0)
PSJST(DA,K) ;ENTRY FOR STRENGTH
"RTN","PSNAPIS",29,0)
 I 'K!('$D(^PSNDF(50.68,K))) Q 0
"RTN","PSNAPIS",30,0)
 Q 1_"^"_$P(^PSNDF(50.68,K,0),"^",4)
"RTN","PSNAPIS",31,0)
 ;
"RTN","PSNAPIS",32,0)
CLASS(CL) ;ENTRY FOR OE/RR TO GET CLASS $D
"RTN","PSNAPIS",33,0)
 I CL']"" Q 0
"RTN","PSNAPIS",34,0)
 Q $D(^PS(50.605,"C",CL))>0
"RTN","PSNAPIS",35,0)
 ;
"RTN","PSNAPIS",36,0)
DRUG(DA) ;ENTRY FOR OE/RR TO GET DRUG $D
"RTN","PSNAPIS",37,0)
 I DA']"" Q 0
"RTN","PSNAPIS",38,0)
 Q $D(^PSNDF(50.6,"B",DA))!$D(^PSNDF(50.67,"T",DA))
"RTN","PSNAPIS",39,0)
 ;
"RTN","PSNAPIS",40,0)
PROD0(P1,P2) ;GET INFO IN THE FORM OF THE OLD 0 PRODUCT NODE
"RTN","PSNAPIS",41,0)
 N A,B
"RTN","PSNAPIS",42,0)
 ;P1 IS SUPERFLUOUS
"RTN","PSNAPIS",43,0)
 I P2']"" Q ""
"RTN","PSNAPIS",44,0)
 S A=$G(^PSNDF(50.68,P2,0)),B=$G(^(1))
"RTN","PSNAPIS",45,0)
 Q $P(A,"^")_"^"_$P(A,"^",3,5)_"^^^"_$P(B,"^",5,6)
"RTN","PSNAPIS",46,0)
 ;
"RTN","PSNAPIS",47,0)
PROD2(P1,P2) ;GET OLD 2 NODE
"RTN","PSNAPIS",48,0)
 ;P1 STILL SUPERFLUOUS
"RTN","PSNAPIS",49,0)
 I P2']"" Q ""
"RTN","PSNAPIS",50,0)
 Q $P($G(^PSNDF(50.68,P2,1)),"^",1,3)_"^"_$P($G(^PSNDF(50.64,+$P(^PSNDF(50.68,P2,1),"^",4),0)),"^")
"RTN","PSNAPIS",51,0)
 ;
"RTN","PSNAPIS",52,0)
DCLASS(DA,K) ;GET CLASS FOR PRODUCT
"RTN","PSNAPIS",53,0)
 I K']"" Q ""
"RTN","PSNAPIS",54,0)
 S X=+$P($G(^PSNDF(50.68,+K,3)),"^"),Y=$P($G(^PS(50.605,X,0)),"^",2)
"RTN","PSNAPIS",55,0)
 Q X_"^"_Y
"RTN","PSNAPIS",56,0)
 ;
"RTN","PSNAPIS",57,0)
DCLCODE(DA,K) ;RETURN VA CLASS CODE
"RTN","PSNAPIS",58,0)
 I K']"" Q ""
"RTN","PSNAPIS",59,0)
 S X=+$P($G(^PSNDF(50.68,+K,3)),"^"),X=$P($G(^PS(50.605,X,0)),"^")
"RTN","PSNAPIS",60,0)
 Q X
"RTN","PSNAPIS",61,0)
 ;
"RTN","PSNAPIS",62,0)
 ;DA IS SUPERFLUOUS
"RTN","PSNAPIS",63,0)
VAGN(DA) ;GET VA GENERIC NAME
"RTN","PSNAPIS",64,0)
 I 'DA!'$D(^PSNDF(50.6,+DA,0)) Q 0
"RTN","PSNAPIS",65,0)
 Q $P(^PSNDF(50.6,+DA,0),"^")
"RTN","PSNAPIS",66,0)
 ;
"RTN","PSNAPIS",67,0)
FORMI(DA,K) ;GET FORMULARY INDICATOR FOR VA PRODUCT
"RTN","PSNAPIS",68,0)
 ;DA IS SUPERFLUOUS
"RTN","PSNAPIS",69,0)
 ;1 if yes, 0 if no, null if not entered
"RTN","PSNAPIS",70,0)
 Q $P($G(^PSNDF(50.68,+K,5)),"^")
"RTN","PSNAPIS",71,0)
 ;
"RTN","PSNAPIS",72,0)
FORMR(DA,K) ;GET EXISTENCE OF FORMULARY RESTRICTIONS
"RTN","PSNAPIS",73,0)
 ;DA IS SUPERFLUOUS
"RTN","PSNAPIS",74,0)
 Q $O(^PSNDF(50.68,+K,6,0))]""
"RTN","PSNAPIS",75,0)
 ;
"RTN","PSNAPIS",76,0)
DFSU(DA,K) ;RETURN DOSE FORM, STRENGTH, AND UNITS FOR PDM AND CPRS
"RTN","PSNAPIS",77,0)
 N U1,UN
"RTN","PSNAPIS",78,0)
 I 'K!('$D(^PSNDF(50.68,+K,0))) Q 0
"RTN","PSNAPIS",79,0)
 S U1=+$P(^PSNDF(50.68,+K,0),"^",5),UN=$P($G(^PS(50.607,U1,0)),"^")
"RTN","PSNAPIS",80,0)
 Q $$PSJDF(DA,K)_"^"_$$PSJST(DA,K)_"^"_U1_"^"_UN
"RTN","PSNAPIS",81,0)
 ;
"RTN","PSNAPIS",82,0)
VAP(DA,LIST) ;GIVEN GENERIC RETURN ARRAY LIST(IEN)=IEN^PRODUCT^DF PTR^DOSE FOMR
"RTN","PSNAPIS",83,0)
 N PR,J,X
"RTN","PSNAPIS",84,0)
 I 'DA!'$D(^PSNDF(50.6,+DA)) Q 0
"RTN","PSNAPIS",85,0)
 S PR=0,J=0 F  S PR=$O(^PSNDF(50.6,"APRO",DA,PR)) Q:'PR  S X=^PSNDF(50.68,PR,0),DAT=$P($G(^(7)),"^",3) D
"RTN","PSNAPIS",86,0)
 .S LIST(PR)=PR_"^"_$P(X,"^")_"^"_$P(X,"^",3)_"^"_$P($G(^PS(50.606,+$P(X,"^",3),0)),"^")_"^"_$P(^PSNDF(50.68,PR,3),"^")_"^"_$P($G(^PS(50.605,+$P(^PSNDF(50.68,PR,3),"^"),0)),"^"),J=J+1 I DAT,(DAT<DT) S LIST(PR)=LIST(PR)_"^I"
"RTN","PSNAPIS",87,0)
 Q J
"RTN","PSNAPIS",88,0)
 ;
"RTN","PSNAPIS",89,0)
PSPT(DA,K,LIST) ;GIVEN PRODUCT K RETURN LIST(INE1^IEN2)=IEN1^PSIZE^IEN1^PTYPE
"RTN","PSNAPIS",90,0)
 N NDC,J,PT,PS
"RTN","PSNAPIS",91,0)
 ;DA SUPERFLUOUS
"RTN","PSNAPIS",92,0)
 I 'K!'$D(^PSNDF(50.68,+K)) Q 0
"RTN","PSNAPIS",93,0)
 S NDC=0 F J=0:1 S NDC=$O(^PSNDF(50.68,"ANDC",K,NDC)) Q:'NDC  S X=^PSNDF(50.67,NDC,0),PS=$P(X,"^",8),PT=$P(X,"^",9),LIST(PS_"^"_PT)=PS_"^"_$P($G(^PS(50.609,PS,0)),"^")_"^"_PT_"^"_$P($G(^PS(50.608,PT,0)),"^")
"RTN","PSNAPIS",94,0)
 Q J
"RTN","PSNAPIS",95,0)
 ;
"RTN","PSNAPIS",96,0)
DSS(DA,K,DATE) ;RETURN DSS FEEDER KEY
"RTN","PSNAPIS",97,0)
 ;NEW STYLE IF DATE IS MISSING OR NOT LESS THAN 199810
"RTN","PSNAPIS",98,0)
 ;OLD STYLE OTHERWISE
"RTN","PSNAPIS",99,0)
 S DATE=$G(DATE,999999)
"RTN","PSNAPIS",100,0)
 I DATE'<199810 Q $S($D(^PSNDF(50.68,+K)):$$RJ^XLFSTR(K,5,0),1:"00000")
"RTN","PSNAPIS",101,0)
 I $D(^PSNDF(50.6,+DA)),$D(^PSNDF(50.68,+K,7)) Q $$RJ^XLFSTR(DA,4,0)_$$RJ^XLFSTR($P(^PSNDF(50.68,+K,7),"^",9),3,0)
"RTN","PSNAPIS",102,0)
 Q "0000000"
"RTN","PSNAPIS",103,0)
 ;
"RTN","PSNAPIS",104,0)
CPRS(DA,K) ;CALL FOR CPRS
"RTN","PSNAPIS",105,0)
 N CL,X,DF,ST,UN
"RTN","PSNAPIS",106,0)
 ;RETURNS X=DOSE FORM^CLASS^STRENGTH^UNITS
"RTN","PSNAPIS",107,0)
 I '$D(^PSNDF(50.68,+K)) Q 0
"RTN","PSNAPIS",108,0)
 S CL=$P($G(^PS(50.605,+$P(^PSNDF(50.68,K,3),"^"),0)),"^")
"RTN","PSNAPIS",109,0)
 S X=^PSNDF(50.68,K,0),DF=+$P(X,"^",3),ST=$P(X,"^",4),UN=+$P(X,"^",5)
"RTN","PSNAPIS",110,0)
 Q $P($G(^PS(50.606,DF,0)),"^")_"^"_CL_"^"_ST_"^"_$P($G(^PS(50.607,UN,0)),"^")
"RTN","PSNAPIS",111,0)
 ;
"RTN","PSNAPIS",112,0)
CIRN(NDC,LIST) ;CALL FOR CIRN
"RTN","PSNAPIS",113,0)
 N DA,X,A
"RTN","PSNAPIS",114,0)
 I NDC["-" S NDC=$$RJ^XLFSTR($P(NDC,"-"),6,0)_$$RJ^XLFSTR($P(NDC,"-",2),4,0)_$$RJ^XLFSTR($P(NDC,"-",3),2,0)
"RTN","PSNAPIS",115,0)
 K LIST S LIST="000000000000" F J=1:1:7 S LIST(J)=""
"RTN","PSNAPIS",116,0)
 S DA=$O(^PSNDF(50.67,"NDC",NDC,0)) Q:'DA  S X=^PSNDF(50.67,DA,0),LIST(7)=$P(X,"^",2)_"^"_$P(X,"^",4,6)_"^",A=0 F  S A=$O(^PSNDF(50.67,DA,1,A)) Q:'A  S LIST(7)=LIST(7)_^(A,0)_" "
"RTN","PSNAPIS",117,0)
 S LIST(6)=$P(X,"^",9),LIST(5)=$P(X,"^",8),A=$P(X,"^",6),X=^PSNDF(50.68,A,0)
"RTN","PSNAPIS",118,0)
  S LIST(2)=$P(X,"^",3)_"^^"_$P(^PSNDF(50.68,A,3),"^"),LIST(3)=$P(X,"^",4),LIST(4)=$P(X,"^",5)
"RTN","PSNAPIS",119,0)
 S LIST(0)=$P(X,"^",2),LIST(1)=^PSNDF(50.6,$P(X,"^",2),0),LIST=NDC
"RTN","PSNAPIS",120,0)
 F J=1:1:7 I LIST(J)="NO DATA" S LIST(J)=""
"RTN","PSNAPIS",121,0)
 Q
"RTN","PSNAPIS",122,0)
 ;
"RTN","PSNAPIS",123,0)
B() ;RETURNS THE GLOBAL ROOT OF THE "B" CROSSREFERENCE IN NDF
"RTN","PSNAPIS",124,0)
 Q "^PSNDF(50.6,""B"")"
"RTN","PSNAPIS",125,0)
 ;
"RTN","PSNAPIS",126,0)
T() ;RETURNS THE GLOBAL ROOT OF THE "T" CROSSREFERENCE IN NDF
"RTN","PSNAPIS",127,0)
 Q "^PSNDF(50.67,""T"")"
"RTN","PSNAPIS",128,0)
 ;
"RTN","PSNAPIS",129,0)
TTOG(TRADE,LIST) ;RETURNS LIST(IEN)=IEN_"^"GENERIC FOR EVERY ENTRY IN 50.6 WHICH MATCHES THE TRADE NAME
"RTN","PSNAPIS",130,0)
 I TRADE="" Q 0
"RTN","PSNAPIS",131,0)
 N X,CT
"RTN","PSNAPIS",132,0)
 I '$O(^PSNDF(50.67,"T",TRADE,0)) Q 0
"RTN","PSNAPIS",133,0)
 S (X,CT)=0 F  S X=$O(^PSNDF(50.67,"T",TRADE,X)) Q:'X  S Y=$P(^PSNDF(50.67,X,0),"^",6),Y=$P(^PSNDF(50.68,Y,0),"^",2) I '$D(LIST(Y)) S LIST(Y)=Y_"^"_$P(^PSNDF(50.6,Y,0),"^"),CT=CT+1
"RTN","PSNAPIS",134,0)
 Q CT
"RTN","PSNAPIS",135,0)
 ;
"RTN","PSNAPIS",136,0)
CLIST(DA,LIST) ;RETURNS LIST(IEN)=IEN IN 50.605^CLASS CODE
"RTN","PSNAPIS",137,0)
 ;FOR EVERY CLASS IN PSNDF(50.6,DA)
"RTN","PSNAPIS",138,0)
 I 'DA Q 0
"RTN","PSNAPIS",139,0)
 I '$D(^PSNDF(50.6,+DA)) Q 0
"RTN","PSNAPIS",140,0)
 N K,CT S (K,CT)=0 F  S K=$O(^PSNDF(50.6,"APRO",DA,K)) Q:'K  S IEN=$P(^PSNDF(50.68,K,3),"^") I '$D(LIST(IEN)) S LIST(IEN)=IEN_"^"_$P(^PS(50.605,IEN,0),"^"),CT=CT+1
"RTN","PSNAPIS",141,0)
 Q CT
"RTN","PSNAPIS",142,0)
 ;
"RTN","PSNAPIS",143,0)
TGTOG(NAME) ;GIVEN NAME TRY TO FIND IT IN T OR B CROSS REFERENCE AND RETURN IEN
"RTN","PSNAPIS",144,0)
 N X
"RTN","PSNAPIS",145,0)
 I NAME="" Q 0
"RTN","PSNAPIS",146,0)
 S X=$O(^PSNDF(50.6,"B",NAME,0)) I X Q X
"RTN","PSNAPIS",147,0)
 I '$O(^PSNDF(50.67,"T",NAME,0)) Q 0
"RTN","PSNAPIS",148,0)
 S X=$O(^PSNDF(50.67,"T",NAME,0)),X=$P(^PSNDF(50.67,X,0),"^",6),X=$P(^PSNDF(50.68,X,0),"^",2) Q X
"RTN","PSNAPIS",149,0)
 ;
"RTN","PSNAPIS",150,0)
TGTOG2(NAME,LIST) ;PARTIAL LOOKUP ON T OR B
"RTN","PSNAPIS",151,0)
 I NAME="" Q
"RTN","PSNAPIS",152,0)
 N NAM,X,Y,CT
"RTN","PSNAPIS",153,0)
 S CT=0
"RTN","PSNAPIS",154,0)
 S NAM=$E(NAME,1,$L(NAME)-1)_$C($A($E(NAME,$L(NAME)))-1)_"z" F  S NAM=$O(^PSNDF(50.6,"B",NAM)),X=0 Q:NAM'[NAME  F  S X=$O(^PSNDF(50.6,"B",NAM,X)) Q:'X  S LIST(X)=X_"^"_$P(^PSNDF(50.6,X,0),"^"),CT=CT+1
"RTN","PSNAPIS",155,0)
 S NAM=$E(NAME,1,$L(NAME)-1)_$C($A($E(NAME,$L(NAME)))-1)_"z" F  S NAM=$O(^PSNDF(50.67,"T",NAM)),X=0 Q:NAM'[NAME  F  S X=$O(^PSNDF(50.67,"T",NAM,X)) Q:'X  S Y=$P(^PSNDF(50.67,X,0),"^",6),Y=$P(^PSNDF(50.68,Y,0),"^",2) D
"RTN","PSNAPIS",156,0)
 .I '$D(LIST(Y)) S LIST(Y)=Y_"^"_$P(^PSNDF(50.6,Y,0),"^"),CT=CT+1
"RTN","PSNAPIS",157,0)
 Q CT
"RTN","PSNAPIS",158,0)
 ;
"RTN","PSNAPIS",159,0)
CIRN2(P1,P3,LIST) ;RETURN LIST OF NDCS FOR A PRODUCT
"RTN","PSNAPIS",160,0)
 I 'P3 Q 0
"RTN","PSNAPIS",161,0)
 I '$D(^PSNDF(50.68,+P3)) Q 0
"RTN","PSNAPIS",162,0)
 N D,N,J
"RTN","PSNAPIS",163,0)
 S N=0
"RTN","PSNAPIS",164,0)
 F J=0:1 S N=$O(^PSNDF(50.68,"ANDC",P3,N)) Q:'N  S LIST(J)=$P(^PSNDF(50.67,N,0),"^",2)
"RTN","PSNAPIS",165,0)
 Q J
"RTN","PSNAPIS",166,0)
 ;
"RTN","PSNAPIS",167,0)
CLASS2(IEN) ;RETURNS FIRST 2 PIECES OF ZERO NODE OF 50.605
"RTN","PSNAPIS",168,0)
 Q $P($G(^PS(50.605,+IEN,0)),"^",1,2)
"RTN","PSNAPIS",169,0)
 ;
"RTN","PSNAPIS",170,0)
CMOP(CODE) ;CODE = 5 CHARACTER CMOP CODE RETURNS PRODUCT NAME
"RTN","PSNAPIS",171,0)
 I CODE="" Q ""
"RTN","PSNAPIS",172,0)
 I '$O(^PSNDF(50.68,"C",CODE,0)) Q ""
"RTN","PSNAPIS",173,0)
 Q $P(^PSNDF(50.68,+$O(^PSNDF(50.68,"C",CODE,0)),0),"^")
"RTN","PSNAPIS",174,0)
 ;
"RTN","PSNAPIS",175,0)
FORMRX(DA,K,LIST) ;RETURN X=1 FOR RESTRICTIONS, 0 FOR NO
"RTN","PSNAPIS",176,0)
 ;RETURNS LIST=WORD PROCESSING FIELD FOR RESTRICTIONS
"RTN","PSNAPIS",177,0)
 ;
"RTN","PSNAPIS",178,0)
 I '$O(^PSNDF(50.68,+K,6,0)) Q 0
"RTN","PSNAPIS",179,0)
 M LIST=^PSNDF(50.68,+K,6) Q 1
"RTN","PSNAPIS",180,0)
 ;
"RTN","PSNAPIS",181,0)
DDIEX(DA,K) ;RETURN X=1 FOR EXCLUDE DDI CHECK, 0 FOR CONTINUE DDI CHECK
"RTN","PSNAPIS",182,0)
 ;
"RTN","PSNAPIS",183,0)
 I '$G(^PSNDF(50.68,+K,8)) Q 0
"RTN","PSNAPIS",184,0)
 I $G(^PSNDF(50.68,+K,8)) Q 1
"RTN","PSNAPIS",185,0)
 ;
"RTN","PSNEXMP1")
0^3^B645714
"RTN","PSNEXMP1",1,0)
PSNEXMP1 ;BIR/WRT-REPORT TO DISPLAY EXEMPTIONS FOR DDI INTERACTIONS CHECKING IN VA PRODUCT FILE ; 07/14/03 10:19
"RTN","PSNEXMP1",2,0)
 ;;4.0; NATIONAL DRUG FILE;**70**; 30 Oct 98
"RTN","PSNEXMP1",3,0)
BRANCH ;
"RTN","PSNEXMP1",4,0)
 I '$D(^PSNDF(50.68,D0,7)),$G(^PSNDF(50.68,D0,8)) S NODE=^PSNDF(50.68,D0,0) D WRIT
"RTN","PSNEXMP1",5,0)
 I $D(^PSNDF(50.68,D0,7)) S ACT=$P(^PSNDF(50.68,D0,7),"^",3) I 'ACT!(ACT>DT) I $G(^PSNDF(50.68,D0,8)) D WRIT
"RTN","PSNEXMP1",6,0)
 Q
"RTN","PSNEXMP1",7,0)
WRIT W $P(^PSNDF(50.68,D0,0),"^")
"RTN","PSNEXMP1",8,0)
 Q
"RTN","PSNEXMP1",9,0)
GETDF ; S DF=$P(^PS(50.606,DFORM,0),"^")
"RTN","PSNEXMP1",10,0)
 Q
"RTN","PSNEXMPT")
0^4^B2326652
"RTN","PSNEXMPT",1,0)
PSNEXMPT ;BIR/WRT-REPORT TO DISPLAY EXEMPTIONS FOR DDI CHECKING IN VA PRODUCT FILE ; 06/12/03 10:20
"RTN","PSNEXMPT",2,0)
 ;;4.0; NATIONAL DRUG FILE;**70**; 30 Oct 98
"RTN","PSNEXMPT",3,0)
 D RPT K ACT,NODE
"RTN","PSNEXMPT",4,0)
 Q
"RTN","PSNEXMPT",5,0)
RPT W !!,"This report gives you a printed copy of active VA Products marked as",!,"EXCLUDE from Drug-Drug Interaction checking.",!,"You may queue the report to print, if you wish.",!
"RTN","PSNEXMPT",6,0)
 S DIC="^PSNDF(50.68,",L=0,FLDS="[PSNEXMP1]",BY="@.01",DHD="VA Products Marked As Exclude From Drg-Drg Interaction Checking" D EN1^DIP
"RTN","PSNEXMPT",7,0)
 Q
"RTN","PSNLOOK")
0^6^B27535737
"RTN","PSNLOOK",1,0)
PSNLOOK ;BIR/WRT-Look up into drug file ; 06/19/03 15:00
"RTN","PSNLOOK",2,0)
 ;;4.0; NATIONAL DRUG FILE;**2,3,5,11,22,27,62,70**; 30 Oct 98
"RTN","PSNLOOK",3,0)
 ;
"RTN","PSNLOOK",4,0)
 ; Reference to ^PSDRUG supported by DBIA# 2192
"RTN","PSNLOOK",5,0)
 ; Reference to ^PS(50.606 supported by DBIA# 2174
"RTN","PSNLOOK",6,0)
 ;
"RTN","PSNLOOK",7,0)
BEGIN D ASK F ZZ=0:0 W ! D LOOK Q:Y<0
"RTN","PSNLOOK",8,0)
KILL K CL,NODE,ZZ,IFN,BB,BILL,DA,DIR,CSFS,FRM,FS,GR,ID,INDT,IST,IUN,IUT,K,MIDD,MISD,MXCD,MXDD,MXSD,NFN,NOD,PMIS,PR,QQ,SEV,SP,STR,TR,UN,UNT,VADU,VPN,DUDA,CC,DF,NUM,SCL,X,Y,RE,WRT,MAP,ENG Q
"RTN","PSNLOOK",9,0)
ASK W !,"This option will allow you to look up entries in your local DRUG file. It will",!,"display National Drug File software match information.",!! S PR=" (Primary) "
"RTN","PSNLOOK",10,0)
 Q
"RTN","PSNLOOK",11,0)
LOOK S DIC="^PSDRUG(",DIC(0)="EM",DIC("S")="I $S('$D(^PSDRUG(+Y,""I"")):1,'^(""I""):1,DT'>^(""I""):1,1:0)" R !!,"Select DRUG GENERIC NAME :  ",BILL:DTIME S:'$T BILL="^" S X=BILL D ^DIC K DIC G:$E(BILL)["?" LOOK I Y>0 S IFN=+Y D DSPLY Q
"RTN","PSNLOOK",12,0)
 Q
"RTN","PSNLOOK",13,0)
DSPLY W @IOF W !?14,"DRUG Generic Name:  ",$P(^PSDRUG(IFN,0),"^") I $D(^PSDRUG(IFN,"ND")) S CL=$P(^("ND"),"^",6) I $D(^PS(50.605,CL)) ; W $P(^PS(50.605,CL,0),"^",1),"    ",$P(^PS(50.605,CL,0),"^",2)
"RTN","PSNLOOK",14,0)
 I $D(^PSDRUG(IFN,"ND")),$P(^PSDRUG(IFN,"ND"),"^",2)]"" S NODE=^PSDRUG(IFN,"ND") S (CSFS,MXSD,MISD,MXDD,MIDD,MXCD,SP,INDT)="" D DSPLY1,DSPLY2,PRODF,DSP,ING,SV,DSP1,RESTN
"RTN","PSNLOOK",15,0)
 I $D(^PSDRUG(IFN,"ND")),$P(^PSDRUG(IFN,"ND"),"^",2)']"" W !?8,"*** NO NATIONAL DRUG FILE INFORMATION ***",!
"RTN","PSNLOOK",16,0)
 Q
"RTN","PSNLOOK",17,0)
DSPLY1 W !?5,"VA Product Name: ",$P(NODE,"^",2)
"RTN","PSNLOOK",18,0)
 W !?5,"VA Generic Name: ",$P(^PSNDF(50.6,$P(NODE,"^",1),0),"^",1)
"RTN","PSNLOOK",19,0)
 Q
"RTN","PSNLOOK",20,0)
DSPLY2 S VPN="",ID="",VADU="",TR="",DA=$P(NODE,"^"),K=$P(NODE,"^",3),X=$$PROD2^PSNAPIS(DA,K) I X]"",$P(X,"^")]"" S VPN=$P(X,"^"),ID=$P(X,"^",2),TR=$P(X,"^",3),VADU=$P(X,"^",4)
"RTN","PSNLOOK",21,0)
 K PMIS I X]"" S QQ=$P(^PSNDF(50.68,K,1),"^",5) D GCN I QQ]"" D GCN1
"RTN","PSNLOOK",22,0)
 Q
"RTN","PSNLOOK",23,0)
GCN I QQ']"" S PMIS="None" Q
"RTN","PSNLOOK",24,0)
GCN1 I $D(^PS(50.623,"B",QQ)) S MAP=$O(^PS(50.623,"B",QQ,0)),ENG=$P(^PS(50.623,MAP,0),"^",2),PMIS=$P(^PS(50.621,+ENG,0),"^")
"RTN","PSNLOOK",25,0)
 I '$D(^PS(50.623,"B",QQ)) S PMIS="None"
"RTN","PSNLOOK",26,0)
 Q
"RTN","PSNLOOK",27,0)
DSPLY3 W ?50,"Transmit To CMOP: "
"RTN","PSNLOOK",28,0)
 I TR=1 W "YES"
"RTN","PSNLOOK",29,0)
 I TR=0 W "NO"
"RTN","PSNLOOK",30,0)
 Q
"RTN","PSNLOOK",31,0)
PRODF S X=$$PROD0^PSNAPIS(DA,K),DF=$P(X,"^",2),STR=$P(X,"^",3),UN=+$P(X,"^",4),FRM=$P(^PS(50.606,DF,0),"^"),UNT=$P($G(^PS(50.607,UN,0)),"^"),NFN=$P(^PSNDF(50.68,K,0),"^",6)
"RTN","PSNLOOK",32,0)
 Q
"RTN","PSNLOOK",33,0)
ING I $D(^PSNDF(50.68,K,2,0)) F BB=0:0 S BB=$O(^PSNDF(50.68,K,2,BB)) Q:'BB  S NOD=^PSNDF(50.68,K,2,BB,0),GR=$P(^PS(50.416,$P(NOD,"^",1),0),"^"),IST=$P(NOD,"^",2),IUT=$P(NOD,"^",3) D ING1,IN2
"RTN","PSNLOOK",34,0)
 Q
"RTN","PSNLOOK",35,0)
IN2 W ?3,GR,?50,"Str: ",STR W:IUT]"" ?65,"Unt: ",IUN W !
"RTN","PSNLOOK",36,0)
 Q
"RTN","PSNLOOK",37,0)
ING1 S:$P(^PS(50.416,$P(NOD,"^"),0),"^",2)="" GR=GR_PR I IUT]"" S IUN=$P(^PS(50.607,IUT,0),"^")
"RTN","PSNLOOK",38,0)
 Q
"RTN","PSNLOOK",39,0)
SC I $D(^PSNDF(50.68,K,4,0)) W !,"Secondary Class(es): ",! S NUM=$P(^PSNDF(50.68,K,4,0),"^",4) F CC=0:0 S CC=$O(^PSNDF(50.68,K,4,CC)) Q:'CC  S SCL=$P(^PS(50.605,$P(^PSNDF(50.68,K,4,CC,0),"^"),0),"^") D SC1
"RTN","PSNLOOK",40,0)
 Q
"RTN","PSNLOOK",41,0)
SC1 W "   ",SCL
"RTN","PSNLOOK",42,0)
 Q
"RTN","PSNLOOK",43,0)
SV S SEV=$G(^PSNDF(50.68,K,7)) I SEV]"" S CSFS=$P(SEV,"^"),MXSD=$P(SEV,"^",4),MISD=$P(SEV,"^",5),MXDD=$P(SEV,"^",6),MIDD=$P(SEV,"^",7),MXCD=$P(SEV,"^",8),SP=$P(SEV,"^",2) S:SP="M" SP="Multi" S:SP="S" SP="Single" D SV1
"RTN","PSNLOOK",44,0)
 Q
"RTN","PSNLOOK",45,0)
SV1 S FS=$S(CSFS=0:"Unscheduled",CSFS=1:"Schedule I",CSFS=2:"Schedule II",CSFS=3:"Schedule III",CSFS=4:"Schedule IV",CSFS=5:"Schedule V",1:"None"),INDT=$P(^PSNDF(50.68,K,7),"^",3)
"RTN","PSNLOOK",46,0)
 Q
"RTN","PSNLOOK",47,0)
DSP W !,"Dosage Form: ",FRM,?30,"Strength: ",STR W:$G(UNT) ?50,"Units: ",UNT W !,"National Formulary Name: ",NFN,!,"VA Print Name: ",VPN,!,"VA Product Identifier: ",ID D DSPLY3 W !,"VA Dispense Unit: ",VADU I $D(PMIS) W !,"PMIS: ",PMIS
"RTN","PSNLOOK",48,0)
 W !,"Active Ingredients: ",!
"RTN","PSNLOOK",49,0)
 Q
"RTN","PSNLOOK",50,0)
DSP1 D HG W "Primary Drug Class: ",$P(^PS(50.605,CL,0),"^") D SC W !,"CS Federal Schedule: ",CSFS,?45,"Single/Multi Source Product: ",SP
"RTN","PSNLOOK",51,0)
 I INDT]"" W !,"Inactivation Date: " S Y=INDT D DD^%DT W Y
"RTN","PSNLOOK",52,0)
 W !,"Max Single Dose: ",MXSD,?45,"Min Single Dose: ",MISD
"RTN","PSNLOOK",53,0)
 W !,"Max Daily Dose: ",MXDD,?45,"Min Daily Dose: ",MIDD,!,"Max Cumulative Dose: ",MXCD
"RTN","PSNLOOK",54,0)
 W !,"National Formulary Indicator: " I $D(^PSNDF(50.68,K,5)) W:$P(^PSNDF(50.68,K,5),"^")=0 "No" W:$P(^PSNDF(50.68,K,5),"^")=1 "Yes"
"RTN","PSNLOOK",55,0)
 I $G(^PSNDF(50.68,K,8)) W !!,"Exclude Drg-Drg Interaction Ck: Yes (No check for Drug-Drug Interactions)"
"RTN","PSNLOOK",56,0)
 W !
"RTN","PSNLOOK",57,0)
 Q
"RTN","PSNLOOK",58,0)
RESTN I $D(^PSNDF(50.68,K,6,0)) W !,"Restriction: " F RE=0:0 S RE=$O(^PSNDF(50.68,K,6,RE)) Q:'RE  S WRT=^PSNDF(50.68,K,6,RE,0) W !,WRT
"RTN","PSNLOOK",59,0)
 Q
"RTN","PSNLOOK",60,0)
HG K DIR S DIR(0)="E",DIR("A")="Press <Return> to Continue" D ^DIR
"RTN","PSNLOOK",61,0)
 W @IOF
"RTN","PSNLOOK",62,0)
 Q
"RTN","PSNODDI")
0^1^B2298840
"RTN","PSNODDI",1,0)
PSNODDI ;BIR/WRT-REPORT TO DISPLAY EXEMPTIONS FOR DDI CHECKING IN VA PRODUCT FILE ; 07/02/03 14:36
"RTN","PSNODDI",2,0)
 ;;4.0; NATIONAL DRUG FILE;**70**; 30 Oct 98
"RTN","PSNODDI",3,0)
 ;Reference to ^PSDRUG supported by DBIA #2192
"RTN","PSNODDI",4,0)
 ;
"RTN","PSNODDI",5,0)
 D TXT,RPT K CLCODE,CLPTR,DFRM,FORM,NDF,PROD,PSNDRG,VAPN
"RTN","PSNODDI",6,0)
 Q
"RTN","PSNODDI",7,0)
TXT W !!,"This report gives you a printed copy of Dispense Drugs from your",!,"local file which are matched to VA Products that are marked as ",!,"EXCLUDE from Drug-Drug Interaction checking."
"RTN","PSNODDI",8,0)
 W !,"You may queue the report to print, if you wish.",!
"RTN","PSNODDI",9,0)
 Q
"RTN","PSNODDI",10,0)
RPT S DIC="^PSDRUG(",L=0,FLDS="[PSNODDI1]",BY="@.01",DHD="[PSNODDI2]" D EN1^DIP
"RTN","PSNODDI",11,0)
 Q
"RTN","PSNODDI1")
0^2^B1987221
"RTN","PSNODDI1",1,0)
PSNODDI1 ;BIR/WRT-REPORT TO DISPLAY DRUG FILE 50 MATCHES TO NDF THAT ARE MARKED AS EXEMPTIONS FOR DDI INTERACTIONS CHECKING IN VA PRODUCT FILE ; 07/02/03 14:37
"RTN","PSNODDI1",2,0)
 ;;4.0; NATIONAL DRUG FILE;**70**; 30 Oct 98
"RTN","PSNODDI1",3,0)
 ;Reference to ^PSDRUG supported by DBIA #2192
"RTN","PSNODDI1",4,0)
 ;
"RTN","PSNODDI1",5,0)
INFO ;
"RTN","PSNODDI1",6,0)
 S PSNDRG=$P(^PSDRUG(D0,0),"^"),NDF=$G(^PSDRUG(D0,"ND")) I NDF S VAPN=$P($G(NDF),"^",3),PROD=$P(^PSNDF(50.68,VAPN,0),"^") I $G(^PSNDF(50.68,VAPN,8)) S DFRM=$P(^PSNDF(50.68,VAPN,0),"^",3),FORM=$P(^PS(50.606,DFRM,0),"^") D INFO1
"RTN","PSNODDI1",7,0)
 Q
"RTN","PSNODDI1",8,0)
INFO1 S CLPTR=$P($G(^PSNDF(50.68,VAPN,3)),"^"),CLCODE=$P(^PS(50.605,CLPTR,0),"^") D FORMAT
"RTN","PSNODDI1",9,0)
 Q
"RTN","PSNODDI1",10,0)
FORMAT W !,PSNDRG,?50,CLCODE,?66,FORM,!,PROD
"RTN","PSNODDI1",11,0)
 Q
"VER")
8.0^22.0
**END**
**END**
