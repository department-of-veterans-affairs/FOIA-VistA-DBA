Released MC*2.3*24 SEQ #28
Extracted from mail message
**KIDS**:MC*2.3*24^

**INSTALL NAME**
MC*2.3*24
"BLD",1875,0)
MC*2.3*24^MEDICINE^0^3001221^y
"BLD",1875,1,0)
^^1^1^3001218^^
"BLD",1875,1,1,0)
Refer to Patch Description.
"BLD",1875,4,0)
^9.64PA^690.7^1
"BLD",1875,4,690.7,0)
690.7
"BLD",1875,4,690.7,222)
y^y^f^^n^^y^o^n
"BLD",1875,4,"B",690.7,690.7)

"BLD",1875,"ABNS",0)
^9.66A^^
"BLD",1875,"ABPKG")
n^n
"BLD",1875,"INID")
^y
"BLD",1875,"INIT")
MC24POST
"BLD",1875,"KRN",0)
^9.67PA^19^18
"BLD",1875,"KRN",.4,0)
.4
"BLD",1875,"KRN",.4,"NM",0)
^9.68A^^
"BLD",1875,"KRN",.401,0)
.401
"BLD",1875,"KRN",.401,"NM",0)
^9.68A^^
"BLD",1875,"KRN",.402,0)
.402
"BLD",1875,"KRN",.402,"NM",0)
^9.68A^^
"BLD",1875,"KRN",.403,0)
.403
"BLD",1875,"KRN",.403,"NM",0)
^9.68A^^
"BLD",1875,"KRN",.5,0)
.5
"BLD",1875,"KRN",.5,"NM",0)
^9.68A^^
"BLD",1875,"KRN",.84,0)
.84
"BLD",1875,"KRN",.84,"NM",0)
^9.68A^^
"BLD",1875,"KRN",3.6,0)
3.6
"BLD",1875,"KRN",3.6,"NM",0)
^9.68A^1^1
"BLD",1875,"KRN",3.6,"NM",1,0)
MCAR7A^^1^
"BLD",1875,"KRN",3.6,"NM","B","MCAR7A",1)

"BLD",1875,"KRN",3.8,0)
3.8
"BLD",1875,"KRN",3.8,"NM",0)
^9.68A^^
"BLD",1875,"KRN",9.2,0)
9.2
"BLD",1875,"KRN",9.2,"NM",0)
^9.68A^^
"BLD",1875,"KRN",9.8,0)
9.8
"BLD",1875,"KRN",9.8,"NM",0)
^9.68A^12^8
"BLD",1875,"KRN",9.8,"NM",1,0)
MCAR7A^^0^B12488102
"BLD",1875,"KRN",9.8,"NM",2,0)
MCAR7E^^0^B4988285
"BLD",1875,"KRN",9.8,"NM",3,0)
MCAR7H^^0^B1039659
"BLD",1875,"KRN",9.8,"NM",5,0)
MCAR7P1^^0^B7940873
"BLD",1875,"KRN",9.8,"NM",7,0)
MCAR7P2^^0^B5973879
"BLD",1875,"KRN",9.8,"NM",8,0)
MCAR7X^^0^B1926126
"BLD",1875,"KRN",9.8,"NM",11,0)
MCAR7M1^^0^B5115104
"BLD",1875,"KRN",9.8,"NM",12,0)
MC24POST^^0^B544000
"BLD",1875,"KRN",9.8,"NM","B","MC24POST",12)

"BLD",1875,"KRN",9.8,"NM","B","MCAR7A",1)

"BLD",1875,"KRN",9.8,"NM","B","MCAR7E",2)

"BLD",1875,"KRN",9.8,"NM","B","MCAR7H",3)

"BLD",1875,"KRN",9.8,"NM","B","MCAR7M1",11)

"BLD",1875,"KRN",9.8,"NM","B","MCAR7P1",5)

"BLD",1875,"KRN",9.8,"NM","B","MCAR7P2",7)

"BLD",1875,"KRN",9.8,"NM","B","MCAR7X",8)

"BLD",1875,"KRN",19,0)
19
"BLD",1875,"KRN",19,"NM",0)
^9.68A^^
"BLD",1875,"KRN",19.1,0)
19.1
"BLD",1875,"KRN",19.1,"NM",0)
^9.68A^^
"BLD",1875,"KRN",101,0)
101
"BLD",1875,"KRN",101,"NM",0)
^9.68A^2^2
"BLD",1875,"KRN",101,"NM",1,0)
MCAR Device Client^^0
"BLD",1875,"KRN",101,"NM",2,0)
MCAR Device Server^^0
"BLD",1875,"KRN",101,"NM","B","MCAR Device Client",1)

"BLD",1875,"KRN",101,"NM","B","MCAR Device Server",2)

"BLD",1875,"KRN",409.61,0)
409.61
"BLD",1875,"KRN",409.61,"NM",0)
^9.68A^^
"BLD",1875,"KRN",771,0)
771
"BLD",1875,"KRN",771,"NM",0)
^9.68A^2^2
"BLD",1875,"KRN",771,"NM",1,0)
MCAR-INST^^0
"BLD",1875,"KRN",771,"NM",2,0)
INST-MCAR^^0
"BLD",1875,"KRN",771,"NM","B","INST-MCAR",2)

"BLD",1875,"KRN",771,"NM","B","MCAR-INST",1)

"BLD",1875,"KRN",869.2,0)
869.2
"BLD",1875,"KRN",869.2,"NM",0)
^9.68A^^0
"BLD",1875,"KRN",870,0)
870
"BLD",1875,"KRN",870,"NM",0)
^9.68A^1^1
"BLD",1875,"KRN",870,"NM",1,0)
MCAR INST^^0
"BLD",1875,"KRN",870,"NM","B","MCAR INST",1)

"BLD",1875,"KRN",8994,0)
8994
"BLD",1875,"KRN",8994,"NM",0)
^9.68A^^
"BLD",1875,"KRN","B",.4,.4)

"BLD",1875,"KRN","B",.401,.401)

"BLD",1875,"KRN","B",.402,.402)

"BLD",1875,"KRN","B",.403,.403)

"BLD",1875,"KRN","B",.5,.5)

"BLD",1875,"KRN","B",.84,.84)

"BLD",1875,"KRN","B",3.6,3.6)

"BLD",1875,"KRN","B",3.8,3.8)

"BLD",1875,"KRN","B",9.2,9.2)

"BLD",1875,"KRN","B",9.8,9.8)

"BLD",1875,"KRN","B",19,19)

"BLD",1875,"KRN","B",19.1,19.1)

"BLD",1875,"KRN","B",101,101)

"BLD",1875,"KRN","B",409.61,409.61)

"BLD",1875,"KRN","B",771,771)

"BLD",1875,"KRN","B",869.2,869.2)

"BLD",1875,"KRN","B",870,870)

"BLD",1875,"KRN","B",8994,8994)

"BLD",1875,"QUES",0)
^9.62^^
"BLD",1875,"REQB",0)
^9.611^1^1
"BLD",1875,"REQB",1,0)
XU*8.0*146^2
"BLD",1875,"REQB","B","XU*8.0*146",1)

"DATA",690.7,1,0)
SMC^179
"DATA",690.7,1,1)
MCAR7P1
"DATA",690.7,2,0)
OLYMPUS^179
"DATA",690.7,2,1)
MCAR7E
"DATA",690.7,3,0)
CMore^179
"DATA",690.7,3,1)
MCAR7E
"DATA",690.7,4,0)
CCF^179
"DATA",690.7,4,1)
MCAR7H
"DATA",690.7,6,0)
MedGraphics^179
"DATA",690.7,6,1)
MCAR7P2
"DATA",690.7,9,0)
Muse EKG
"DATA",690.7,9,1)
MCAR7M1
"DATA",690.7,10,0)
PENTAX^179
"DATA",690.7,10,1)
MCAR7E
"FIA",690.7)
Instrument HL7 Coding
"FIA",690.7,0)
^MCAR(690.7,
"FIA",690.7,0,0)
690.7
"FIA",690.7,0,1)
y^y^f^^n^^y^o^n
"FIA",690.7,0,10)

"FIA",690.7,0,11)

"FIA",690.7,0,"RLRO")

"FIA",690.7,0,"VR")
2.3^MC
"FIA",690.7,690.7)
0
"INIT")
MC24POST
"KRN",3.6,174,-1)
1^1
"KRN",3.6,174,0)
MCAR7A
"KRN",101,4340,-1)
0^2
"KRN",101,4340,0)
MCAR Device Server^Instrument HL7 Event Driver^^E^^^^^^^^MEDICINE
"KRN",101,4340,1,0)
^101.06^2^2^3000925^^^^
"KRN",101,4340,1,1,0)
This protocol is used by the HL7 package to send results to
"KRN",101,4340,1,2,0)
Vista from various clinical instrumentation.
"KRN",101,4340,99)
57631,55707
"KRN",101,4340,770)
INST-MCAR^^ORU^R01^^P^^^^2.3^
"KRN",101,4340,772)

"KRN",101,4340,773)
0^0
"KRN",101,4340,775,0)
^101.0775PA^1^1
"KRN",101,4340,775,1,0)
4341
"KRN",101,4340,775,1,"^")
MCAR Device Client
"KRN",101,4341,-1)
0^1
"KRN",101,4341,0)
MCAR Device Client^Instrument Device Client^^S^^^^^^^^MEDICINE
"KRN",101,4341,1,0)
^101.06^2^2^3001018^^^^
"KRN",101,4341,1,1,0)
Subscriber protocol for sending data to Vista from
"KRN",101,4341,1,2,0)
clinical instruments.
"KRN",101,4341,15)

"KRN",101,4341,20)

"KRN",101,4341,99)
57540,31165
"KRN",101,4341,770)
^MCAR-INST^ORU^R01^^P^MCAR INST^^^2.3^ACK
"KRN",101,4341,771)
D ^MCAR7A
"KRN",101,4341,773)
0^0^^
"KRN",771,29,-1)
0^1
"KRN",771,29,0)
MCAR-INST^a^VISTA^POSTMASTER^^^US
"KRN",771,29,"EC")
^~\&
"KRN",771,29,"FS")
|
"KRN",771,29,"SEG",0)
^771.05P
"KRN",771,32,-1)
0^2
"KRN",771,32,0)
INST-MCAR^a^^^^^US
"KRN",771,32,"EC")
^~\&
"KRN",771,32,"FS")
|
"KRN",870,15,-1)
0^1
"KRN",870,15,0)
MCAR INST^^TCP^^^^^^^^^^^^^^^^^^100
"KRN",870,15,200)
^3^^^60^^^^^I
"KRN",870,15,400)
^1026^S^N^^
"MBREQ")
0
"ORD",2,3.6)
3.6;2;1;;BUL^XPDTA1;;BULE1^XPDIA1;;;BULDEL^XPDIA1
"ORD",2,3.6,0)
BULLETIN
"ORD",13,870)
870;13;1;;HLLL^XPDTA1;;HLLLE^XPDIA1;;;
"ORD",13,870,0)
HL LOGICAL LINK
"ORD",14,771)
771;14;;;HLAP^XPDTA1;HLAPF1^XPDIA1;HLAPE1^XPDIA1;HLAPF2^XPDIA1;;
"ORD",14,771,0)
HL7 APPLICATION PARAMETER
"ORD",15,101)
101;15;;;PRO^XPDTA;PROF1^XPDIA;PROE1^XPDIA;PROF2^XPDIA;;PRODEL^XPDIA
"ORD",15,101,0)
PROTOCOL
"PKG",31,-1)
1^1
"PKG",31,0)
MEDICINE^MC^MEDICINE PACKAGE INCLUDES ALL AREAS OF MEDICINE
"PKG",31,20,0)
^9.402P^^
"PKG",31,22,0)
^9.49I^1^1
"PKG",31,22,1,0)
2.3^2960913^2980615^4558
"PKG",31,22,1,"PAH",1,0)
24^3001221
"PKG",31,22,1,"PAH",1,1,0)
^^1^1^3001221
"PKG",31,22,1,"PAH",1,1,1,0)
Refer to Patch Description.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
8
"RTN","MC24POST")
0^12^B544000
"RTN","MC24POST",1,0)
MC24POST ; HIRMFO/WAA-Post Installation routine ;9/18/00  14:43
"RTN","MC24POST",2,0)
 ;;2.3;Medicine;**24**;09/13/1996
"RTN","MC24POST",3,0)
EN ; Post Installation entry point
"RTN","MC24POST",4,0)
 ; This Post Init will check to see if MCAR7Z is in the account
"RTN","MC24POST",5,0)
 ; and delete it. 
"RTN","MC24POST",6,0)
 N X
"RTN","MC24POST",7,0)
 S X="MCAR7Z" ; Routine to delete.
"RTN","MC24POST",8,0)
 X ^%ZOSF("TEST") ; Check to see if this routine is in the account.
"RTN","MC24POST",9,0)
 I '$T Q  ; Quit if the routine doesn't exist.
"RTN","MC24POST",10,0)
 X ^%ZOSF("DEL") ; Delete the routine.
"RTN","MC24POST",11,0)
 Q
"RTN","MCAR7A")
0^1^B12488102
"RTN","MCAR7A",1,0)
MCAR7A ; HIRMFO/REL-Main Routine to Decode HL7 ;5/26/00  09:43
"RTN","MCAR7A",2,0)
 ;;2.3;Medicine;**24**;09/13/1996
"RTN","MCAR7A",3,0)
EN ; Entry Point for Message Array in MSG
"RTN","MCAR7A",4,0)
 ; Reference DBIA #10035 for DPT calls.
"RTN","MCAR7A",5,0)
 K MSG,ERRTX
"RTN","MCAR7A",6,0)
 F I=1:1 X HLNEXT Q:HLQUIT'>0  S MSG(I)=HLNODE,J=0 F  S J=$O(HLNODE(J)) Q:'J  S MSG(I,J)=HLNODE(J)
"RTN","MCAR7A",7,0)
 S NUM=1
"RTN","MCAR7A",8,0)
MSH ; Decode MSH
"RTN","MCAR7A",9,0)
 K SEG
"RTN","MCAR7A",10,0)
 I '$D(MSG(NUM)) G KIL
"RTN","MCAR7A",11,0)
 S X=$G(MSG(NUM)),SEG("MSH")=X,MCAPP=""
"RTN","MCAR7A",12,0)
 I $E(X,1,3)'="MSH" S ERRTX="MSH not first record" D ^MCAR7X G KIL
"RTN","MCAR7A",13,0)
 S MCAPP=$P(MSG(NUM),"|",4) I MCAPP="" G KIL
"RTN","MCAR7A",14,0)
 S NUM=NUM+1
"RTN","MCAR7A",15,0)
PID ; Check PID
"RTN","MCAR7A",16,0)
 S X=$G(MSG(NUM)) I $E(X,1,3)'="PID" S ERRTX="PID not second record" D ^MCAR7X G KIL
"RTN","MCAR7A",17,0)
 S SEG("PID")=X
"RTN","MCAR7A",18,0)
 S NAM=$P(X,"|",6),SSN=$P(X,"|",20) I $L(SSN)<9 S SSN=$P(X,"|",4)
"RTN","MCAR7A",19,0)
 S SSN=$P(SSN,"^",1) I SSN'?9N S SSN=$TR(SSN,"- ","")
"RTN","MCAR7A",20,0)
 S:SSN'?9N SSN=" " S DFN=$O(^DPT("SSN",SSN,0))
"RTN","MCAR7A",21,0)
 I 'DFN S ERRTX="SSN not found" D ^MCAR7X G KIL
"RTN","MCAR7A",22,0)
 S Z1=$P($G(^DPT(DFN,0)),",",1),Z2=$P(NAM,"^",1)
"RTN","MCAR7A",23,0)
 S Z1=$TR(Z1,"abcdefghijklmnopqrstuvwxyz- '","ABCDEFGHIJKLMNOPQRSTUVWXYZ")
"RTN","MCAR7A",24,0)
 S Z2=$TR(Z2,"abcdefghijklmnopqrstuvwxyz- '","ABCDEFGHIJKLMNOPQRSTUVWXYZ")
"RTN","MCAR7A",25,0)
 I $E(Z1,1,3)'=$E(Z2,1,3) S ERRTX="Last Name MisMatch" D ^MCAR7X G KIL
"RTN","MCAR7A",26,0)
 D PID^VADPT6 S PID=$G(VA("PID")),BID=$G(VA("BID")) K VA
"RTN","MCAR7A",27,0)
 ; If DFN not a medical patient, add DFN to medical patient file
"RTN","MCAR7A",28,0)
 I '$D(^MCAR(690,DFN)) S ^MCAR(690,DFN,0)=DFN,^MCAR(690,"B",DFN,DFN)="",$P(^MCAR(690,0),U,4)=$P(^MCAR(690,0),U,4)+1 S:$P(^MCAR(690,0),U,3)<DFN $P(^MCAR(690,0),U,3)=DFN
"RTN","MCAR7A",29,0)
 S NUM=NUM+1
"RTN","MCAR7A",30,0)
 ; Skip PV1, ORC if necessary
"RTN","MCAR7A",31,0)
 I $E(MSG(NUM),1,3)="PV1" S NUM=NUM+1
"RTN","MCAR7A",32,0)
 I $E(MSG(NUM),1,3)="ORC" S NUM=NUM+1
"RTN","MCAR7A",33,0)
OBR ; Check OBR
"RTN","MCAR7A",34,0)
 S X=$G(MSG(NUM)) I $E(X,1,3)'="OBR" S ERRTX="OBR not found when expected" D ^MCAR7X G KIL
"RTN","MCAR7A",35,0)
 S SEG("OBR")=X
"RTN","MCAR7A",36,0)
 S ORIFN=$P(X,"|",3),INST=$P(X,"|",25) I MCAPP="Instrument Manager",INST'="" S MCAPP=INST
"RTN","MCAR7A",37,0)
 S ORIFN=$P(X,"|",3),(EXAM,%)=$P(X,"|",5) I EXAM'="" S EXAM=$P(%,"^",2),EXAM2=$P(%,"^",1) I EXAM="" S EXAM=EXAM2
"RTN","MCAR7A",38,0)
 S CPT=$P(X,"|",5) I $P(CPT,"^",3)["CPT" S CPT=$P(CPT,"^",1)
"RTN","MCAR7A",39,0)
 S DTO="",DATE=$P(X,"|",8) I DATE'="" S DTO=$$FMDATE^HLFNC(DATE)
"RTN","MCAR7A",40,0)
 I DTO="" S ERRTX="Missing required Date/Time of Procedure in OBR" D ^MCAR7X G KIL
"RTN","MCAR7A",41,0)
 K SET S SET=DTO_"^"_DFN,NUM=NUM+1,ICNT=0 K IMP
"RTN","MCAR7A",42,0)
 ; Go to Application
"RTN","MCAR7A",43,0)
 S INST=$O(^MCAR(690.7,"B",MCAPP,0)) I 'INST S X=MCAPP,ERRTX="Invalid Application Code" D ^MCAR7X G KIL
"RTN","MCAR7A",44,0)
 S MCRTN=$G(^MCAR(690.7,INST,1)) S:MCRTN'["^" MCRTN="^"_MCRTN
"RTN","MCAR7A",45,0)
 ; test for existence
"RTN","MCAR7A",46,0)
 S X=MCRTN S:X["^" X=$P(X,"^",2) X ^%ZOSF("TEST") I '$T S ERRTX="Processing routine not found" D ^MCAR7X G KIL
"RTN","MCAR7A",47,0)
 D @MCRTN G KIL
"RTN","MCAR7A",48,0)
PROC ; Create Procedure entry in appropriate file (FIL)
"RTN","MCAR7A",49,0)
 I $P(SET,"^",1)=""!($P(SET,"^",2)="") Q
"RTN","MCAR7A",50,0)
 S DA=0 F  S DA=$O(^MCAR(FIL,"B",$P(SET,"^",1),DA)) Q:'DA  I $P($G(^MCAR(FIL,DA,0)),"^",1,2)=SET Q
"RTN","MCAR7A",51,0)
 Q:DA
"RTN","MCAR7A",52,0)
P1 L +^MCAR(FIL,0):3 G:'$T P1 S DA=$P(^MCAR(FIL,0),"^",3)+1,$P(^MCAR(FIL,0),"^",3,4)=DA_"^"_DA L -^MCAR(FIL,0)
"RTN","MCAR7A",53,0)
 I $D(^MCAR(FIL,DA)) G P1
"RTN","MCAR7A",54,0)
 S ^MCAR(FIL,DA,0)=SET S DIK="^MCAR("_FIL_"," D IX1^DIK Q
"RTN","MCAR7A",55,0)
KIL ; Kill Variables
"RTN","MCAR7A",56,0)
 K %,BID,CODE,CPT,DA,DATE,DFN,DIK,DLCO,DTO,ERRTX,EXAM,EXAM2,EXE,FIL
"RTN","MCAR7A",57,0)
 K I,ICNT,ID,IMP,J,K,LBL,LINE,LN,MCAPP,MCRTN,MG,MSG,N,NAM,NEXT,NUM
"RTN","MCAR7A",58,0)
 K ORIFN,P,PID,PIEN,S,SEG,SEP,SET,SSN,STR,STYP,SUB,TCNT,TXT
"RTN","MCAR7A",59,0)
 K UNITS,VA,VAL,X,XMBODY,XMDUZ,XMSUBJ,XMTO,Z1,Z2 Q
"RTN","MCAR7E")
0^2^B4988285
"RTN","MCAR7E",1,0)
MCAR7E ; HIRMFO/REL-Olympus/CMore Endoscopy ;7/24/00  11:16
"RTN","MCAR7E",2,0)
 ;;2.3;Medicine;**24**;09/13/1996
"RTN","MCAR7E",3,0)
OBX ; Process OBX
"RTN","MCAR7E",4,0)
 S X=$G(MSG(NUM)) I $E(X,1,3)'="OBX" S ERRTX="OBX not found when expected" G ^MCAR7X
"RTN","MCAR7E",5,0)
 S SEG("OBX")=X
"RTN","MCAR7E",6,0)
UPDATE ; Update File
"RTN","MCAR7E",7,0)
 S FIL=699 D PROC^MCAR7A ; Set Procedure entry
"RTN","MCAR7E",8,0)
 ; Process Note
"RTN","MCAR7E",9,0)
 S LN=0,J=0,^MCAR(699,DA,33,0)="^^0^0^"_DT_"^"
"RTN","MCAR7E",10,0)
 I MCAPP="OLYMPUS" S SEP="^" G OLY
"RTN","MCAR7E",11,0)
 I MCAPP="PENTAX" S SEP="^" G PEN
"RTN","MCAR7E",12,0)
 I MCAPP="CMore"  S SEP="~"
"RTN","MCAR7E",13,0)
CMO ; Process CMore
"RTN","MCAR7E",14,0)
 S LINE=$P(MSG(NUM),"|",6)
"RTN","MCAR7E",15,0)
U1 I LINE[SEP D C1 G U1
"RTN","MCAR7E",16,0)
 S J=J+1 I $G(MSG(NUM,J))="" D:LINE'="" C1 G U2
"RTN","MCAR7E",17,0)
 S LINE=LINE_MSG(NUM,J) S:LINE["|" LINE=$P(LINE,"|",1) G U1
"RTN","MCAR7E",18,0)
C1 S LN=LN+1,%=$P(LINE,SEP,1),LINE=$P(LINE,SEP,2,999)
"RTN","MCAR7E",19,0)
 S:%="" %=" " S ^MCAR(699,DA,33,LN,0)=% Q
"RTN","MCAR7E",20,0)
OLY ; Process Olympus
"RTN","MCAR7E",21,0)
 F  S LINE=$P($G(MSG(NUM)),"|",6) Q:LINE=""  D U3 S NUM=NUM+1
"RTN","MCAR7E",22,0)
 G U2
"RTN","MCAR7E",23,0)
PEN ; Process Pentax data
"RTN","MCAR7E",24,0)
 N LN
"RTN","MCAR7E",25,0)
 S LN=0
"RTN","MCAR7E",26,0)
 F  S LINE=$P($G(MSG(NUM)),"|",6) Q:'$D(MSG(NUM))  D  S NUM=NUM+1
"RTN","MCAR7E",27,0)
 .S LN=LN+1
"RTN","MCAR7E",28,0)
 .S ^MCAR(699,DA,33,LN,0)=LINE
"RTN","MCAR7E",29,0)
 .Q
"RTN","MCAR7E",30,0)
 G U2
"RTN","MCAR7E",31,0)
U2 S $P(^MCAR(699,DA,33,0),"^",3,4)=(LN_"^"_LN)
"RTN","MCAR7E",32,0)
 S:EXAM="" EXAM="Endoscopy" S PIEN=$O(^MCAR(697.2,"B",EXAM,0))
"RTN","MCAR7E",33,0)
 I PIEN="" S:EXAM2'="" PIEN=$O(^MCAR(697.2,"B",EXAM2,0))
"RTN","MCAR7E",34,0)
 I PIEN="" D
"RTN","MCAR7E",35,0)
 .K DIC S (DIC,DLAYGO)=697.2,DIC(0)="L",X=$C(34)_EXAM_$C(34)
"RTN","MCAR7E",36,0)
 .S DIC("DR")="1///MCAR(699;1.1///.02;3///G;4///ENDO;5///MCARGP;6///GI;7///"_EXAM_";11///1;12///MCKEYGI;13///1;15///1;1001///P"
"RTN","MCAR7E",37,0)
 .D ^DIC S PIEN=+Y K DIC,DLAYGO Q
"RTN","MCAR7E",38,0)
 S $P(^MCAR(699,DA,0),"^",12)=PIEN
"RTN","MCAR7E",39,0)
 ; Re-index record
"RTN","MCAR7E",40,0)
 S DIK="^MCAR(699," D IX1^DIK
"RTN","MCAR7E",41,0)
 D GENACK^MCAR7X
"RTN","MCAR7E",42,0)
 Q
"RTN","MCAR7E",43,0)
U3 ; Add a line
"RTN","MCAR7E",44,0)
 S J=0 D NJ
"RTN","MCAR7E",45,0)
U4 S %=$L(LINE)+1 I %<80 G:NEXT="" ST D  G U4
"RTN","MCAR7E",46,0)
 .S LINE=LINE_$E(NEXT,1,125),NEXT=$E(NEXT,126,999) D:NEXT="" NJ
"RTN","MCAR7E",47,0)
 .Q
"RTN","MCAR7E",48,0)
 F %=79:-1:1 Q:$E(LINE,%)=" "
"RTN","MCAR7E",49,0)
 D ST G U4
"RTN","MCAR7E",50,0)
NJ S J=J+1,NEXT=$P($G(MSG(NUM,J)),"|",1) Q
"RTN","MCAR7E",51,0)
ST S LN=LN+1,^MCAR(699,DA,33,LN,0)=$E(LINE,1,%-1),LINE=$E(LINE,%+1,999) Q
"RTN","MCAR7H")
0^3^B1039659
"RTN","MCAR7H",1,0)
MCAR7H ; HIRMFO/REL-DelMar Holter ;3/3/00  09:56
"RTN","MCAR7H",2,0)
 ;;2.3;Medicine;**24**;09/13/1996
"RTN","MCAR7H",3,0)
OBX ; Process OBX
"RTN","MCAR7H",4,0)
 S X=$G(MSG(NUM)) I $E(X,1,3)'="OBX" S ERRTX="OBX not found when expected" G ^MCAR7X
"RTN","MCAR7H",5,0)
 S SEG("OBX")=X
"RTN","MCAR7H",6,0)
 S FIL=691.6 D PROC^MCAR7A ; Set Procedure entry
"RTN","MCAR7H",7,0)
 S LN=0,^MCAR(691.6,DA,7,0)="^^0^0^"_DT_"^"
"RTN","MCAR7H",8,0)
NEXT S X=$P(MSG(NUM),"|",6),X=$P(X,"^",1) I X'="" S LN=LN+1,^MCAR(691.6,DA,7,LN,0)=" "_X
"RTN","MCAR7H",9,0)
 S NUM=NUM+1 I $E($G(MSG(NUM)),1,3)="OBX" G NEXT
"RTN","MCAR7H",10,0)
 S $P(^MCAR(691.6,DA,7,0),"^",3,4)=(LN_"^"_LN)
"RTN","MCAR7H",11,0)
 ; Re-index record
"RTN","MCAR7H",12,0)
 S DIK="^MCAR(691.6," D IX1^DIK
"RTN","MCAR7H",13,0)
 D GENACK^MCAR7X
"RTN","MCAR7H",14,0)
 Q
"RTN","MCAR7M1")
0^11^B5115104
"RTN","MCAR7M1",1,0)
MCAR7M1 ; HIRMFO/REL-Muse EKG ;6/7/00  10:11
"RTN","MCAR7M1",2,0)
 ;;2.3;Medicine;**24**;09/13/1996
"RTN","MCAR7M1",3,0)
 S EXAM=$P($P(SEG("OBR"),"|",5),"^",1) S:EXAM="" EXAM=99999
"RTN","MCAR7M1",4,0)
 S X=$T(@EXAM),FIL=$P(X,";",4),SUB=$P(X,";",5) I FIL=""!(SUB="") S ERRTX="Unknown Exam Type" G ^MCAR7X
"RTN","MCAR7M1",5,0)
 F P=1:1 S VAL=$T(VARS+P) Q:VAL=""  S SET($P(VAL,";",3))=$P(VAL,";",4,5)
"RTN","MCAR7M1",6,0)
 S X=$P($P(SEG("OBR"),"|",33),"^",1)
"RTN","MCAR7M1",7,0)
 I +X,$$GET1^DIQ(200,X,.01,"I")'="" S $P(SET("Interpreter"),";",3)=X
"RTN","MCAR7M1",8,0)
OBX ; Process OBX
"RTN","MCAR7M1",9,0)
 S X=$G(MSG(NUM)) G:X="" UPDATE I $E(X,1,3)'="OBX" S ERRTX="OBX not found when expected" G ^MCAR7X
"RTN","MCAR7M1",10,0)
 S SEG("OBX")=X
"RTN","MCAR7M1",11,0)
 S STYP=$P(X,"|",3) I STYP'="ST" G IMP
"RTN","MCAR7M1",12,0)
 S CODE=$P(X,"|",4),VAL=$P(X,"|",6),UNITS=$P(X,"|",7) I CODE["^" S CODE=$P(CODE,"^",2)
"RTN","MCAR7M1",13,0)
 I CODE=""!(VAL="") G NEXT
"RTN","MCAR7M1",14,0)
 I $D(SET(CODE)) S $P(SET(CODE),";",3)=VAL
"RTN","MCAR7M1",15,0)
NEXT S NUM=NUM+1 G OBX
"RTN","MCAR7M1",16,0)
IMP ; Get Impression
"RTN","MCAR7M1",17,0)
 S NUM=NUM+1,VAL=$P(X,"|",6) I STYP="CE" S VAL=$P(VAL,"^",2)
"RTN","MCAR7M1",18,0)
 S ICNT=ICNT+1,IMP(ICNT)=VAL G OBX
"RTN","MCAR7M1",19,0)
UPDATE ; Update File
"RTN","MCAR7M1",20,0)
 D PROC^MCAR7A ; Set Procedure Entry
"RTN","MCAR7M1",21,0)
 I EXAM=93000 S ID="" F  S ID=$O(SET(ID)) Q:ID=""  S P=$P(SET(ID),";",1) I P'="" S K=$P(SET(ID),";",2) I K'="" S VAL=$P(SET(ID),";",3) S:VAL'="" $P(^MCAR(FIL,DA,P),"^",K)=VAL
"RTN","MCAR7M1",22,0)
 I $D(IMP) F P=1:1:ICNT S ^MCAR(FIL,DA,SUB,P,0)=IMP(P)
"RTN","MCAR7M1",23,0)
 I  S ^MCAR(FIL,DA,SUB,0)="^^"_ICNT_"^"_ICNT_"^"_DT
"RTN","MCAR7M1",24,0)
 S DIK="^MCAR("_FIL_"," D IX1^DIK
"RTN","MCAR7M1",25,0)
 D GENACK^MCAR7X
"RTN","MCAR7M1",26,0)
 Q
"RTN","MCAR7M1",27,0)
93000 ;;EKG;691.5;9
"RTN","MCAR7M1",28,0)
93040 ;;Pacemaker;698.3;10
"RTN","MCAR7M1",29,0)
93015 ;;Exercise;691.7;6
"RTN","MCAR7M1",30,0)
93266 ;;Holter;691.6;7
"RTN","MCAR7M1",31,0)
93529 ;;Cath;691.1;43
"RTN","MCAR7M1",32,0)
93307 ;;Echo;691;3
"RTN","MCAR7M1",33,0)
93619 ;;Electrophysiology;691.8;12
"RTN","MCAR7M1",34,0)
VARS ;;
"RTN","MCAR7M1",35,0)
 ;;Interpreter;0;13
"RTN","MCAR7M1",36,0)
 ;;Systolic Blood Pressure;4;2
"RTN","MCAR7M1",37,0)
 ;;Diastolic Blood Pressure;4;1
"RTN","MCAR7M1",38,0)
 ;;Ventricular Rate;0;4
"RTN","MCAR7M1",39,0)
 ;;Atrial Rate;
"RTN","MCAR7M1",40,0)
 ;;P-R Interval;0;5
"RTN","MCAR7M1",41,0)
 ;;QRS Duration;0;6
"RTN","MCAR7M1",42,0)
 ;;QT;0;7
"RTN","MCAR7M1",43,0)
 ;;QTc;0;8
"RTN","MCAR7M1",44,0)
 ;;P Axis;0;9
"RTN","MCAR7M1",45,0)
 ;;QRS Axis;
"RTN","MCAR7M1",46,0)
 ;;T Axis;0;11
"RTN","MCAR7P1")
0^5^B7940873
"RTN","MCAR7P1",1,0)
MCAR7P1 ; HIRMFO/REL-Sensormedics Pulmonary ;3/3/00  09:55
"RTN","MCAR7P1",2,0)
 ;;2.3;Medicine;**24**;09/13/1996
"RTN","MCAR7P1",3,0)
 S TCNT=0
"RTN","MCAR7P1",4,0)
OBX ; Process OBX
"RTN","MCAR7P1",5,0)
 S X=$G(MSG(NUM)) G:X="" UPDATE I $E(X,1,3)'="OBX" S ERRTX="OBX not found when expected" G ^MCAR7X
"RTN","MCAR7P1",6,0)
 S SEG("OBX")=X
"RTN","MCAR7P1",7,0)
 S STYP=$P(X,"|",3) I STYP="TX" G IMP
"RTN","MCAR7P1",8,0)
 S ID=$P(X,"|",5),CODE=$P(X,"|",4),VAL=$P(X,"|",6),UNITS=$P(X,"|",7) I CODE["^" S CODE=$P(CODE,"^",1)
"RTN","MCAR7P1",9,0)
 I CODE=""!(VAL="") G NEXT
"RTN","MCAR7P1",10,0)
 S CODE=$$UP^XLFSTR(CODE)
"RTN","MCAR7P1",11,0)
 I $E(CODE,1,3)'?2.3U G NEXT
"RTN","MCAR7P1",12,0)
 S STR=$P($T(@$E(CODE,1,3)),";;",2) I STR="" G NEXT
"RTN","MCAR7P1",13,0)
 S S=$P(STR,"^",2),P=$P(STR,"^",3),EXE=$P(STR,"^",4) I EXE'="" X EXE I VAL="" G NEXT
"RTN","MCAR7P1",14,0)
 I S="P" S $P(SET(S,+P),"^",$P(P,";",2))=VAL G NEXT
"RTN","MCAR7P1",15,0)
 I ID<4 S $P(SET(S,ID-1),"^",$P(P,";",2))=VAL I S="V",$P(CODE," ",1)="FRC" S VAL=$P($P(X,"|",4)," ",2) I VAL'="" S $P(SET(S,ID-1),"^",1)=$S(VAL["Dil":"N",1:"B")
"RTN","MCAR7P1",16,0)
NEXT S NUM=NUM+1 G OBX
"RTN","MCAR7P1",17,0)
IMP ; Get Impression
"RTN","MCAR7P1",18,0)
 S NUM=NUM+1,CODE=$P(X,"|",4)
"RTN","MCAR7P1",19,0)
 I CODE["Interp" S ICNT=ICNT+1,IMP("I",ICNT)=$P(X,"|",6) G OBX
"RTN","MCAR7P1",20,0)
 I CODE["Tech" S TCNT=TCNT+1,IMP("T",TCNT)=$P(X,"|",6) G OBX
"RTN","MCAR7P1",21,0)
 G OBX
"RTN","MCAR7P1",22,0)
UPDATE ; Update File
"RTN","MCAR7P1",23,0)
 S FIL=700 D PROC^MCAR7A ; Set Procedure Entry
"RTN","MCAR7P1",24,0)
 S P="" F  S P=$O(SET("P",P)) Q:P=""  F K=1:1:$L(SET("P",P),"^") S VAL=$P(SET("P",P),"^",K) I VAL'="" S $P(^MCAR(700,DA,P),"^",K)=VAL
"RTN","MCAR7P1",25,0)
 F ID="F","V" I $D(SET(ID)) D U1
"RTN","MCAR7P1",26,0)
 I ICNT F P=1:1:ICNT S ^MCAR(700,DA,25,P,0)=IMP("I",P)
"RTN","MCAR7P1",27,0)
 I ICNT S ^MCAR(700,DA,25,0)="^^"_ICNT_"^"_ICNT_"^"_DT
"RTN","MCAR7P1",28,0)
 I TCNT F P=1:1:TCNT S ^MCAR(700,DA,16,P,0)=IMP("T",P)
"RTN","MCAR7P1",29,0)
 I TCNT S ^MCAR(700,DA,16,0)="^^"_TCNT_"^"_TCNT_"^"_DT
"RTN","MCAR7P1",30,0)
 S DIK="^MCAR(700," D IX1^DIK
"RTN","MCAR7P1",31,0)
 D GENACK^MCAR7X
"RTN","MCAR7P1",32,0)
 Q
"RTN","MCAR7P1",33,0)
U1 ; Set Study values
"RTN","MCAR7P1",34,0)
 S S=$S(ID="F":4,ID="V":3,1:"") Q:'S
"RTN","MCAR7P1",35,0)
 I ID="F" F P=1,2 I $D(SET(ID,P)) S $P(SET(ID,P),"^",1)=$S(P=1:"S",1:"B")
"RTN","MCAR7P1",36,0)
 I ID="V" F P=1,2 I $D(SET(ID,P)) I $P(SET(ID,P),"^",1)="" S $P(SET(ID,P),"^",1)="B"
"RTN","MCAR7P1",37,0)
 I '$D(^MCAR(700,DA,S,0)) S ^MCAR(700,DA,S,0)="^"_$S(S=3:"700.017SA",1:"700.018SA")_"^0^0"
"RTN","MCAR7P1",38,0)
 S P=0 F  S P=$O(SET(ID,P)) Q:P=""  F K=1:1:$L(SET(ID,P),"^") S VAL=$P(SET(ID,P),"^",K) I VAL'="" S $P(^MCAR(700,DA,S,P,0),"^",K)=VAL
"RTN","MCAR7P1",39,0)
 S P=$O(SET(ID,""),-1),$P(^MCAR(700,DA,S,0),"^",3,4)=(P_"^"_P)
"RTN","MCAR7P1",40,0)
 Q
"RTN","MCAR7P1",41,0)
VARS ;;
"RTN","MCAR7P1",42,0)
FVC ;;FVC^F^0;2
"RTN","MCAR7P1",43,0)
FEV ;;FEV1^F^0;3
"RTN","MCAR7P1",44,0)
FEF ;;FEF25-75%^F^0;5
"RTN","MCAR7P1",45,0)
PEF ;;PEF^F^0;4
"RTN","MCAR7P1",46,0)
MVV ;;MVV^F^0;7
"RTN","MCAR7P1",47,0)
TLC ;;TLC^V^0;2
"RTN","MCAR7P1",48,0)
RV ;;RV^V^0;5
"RTN","MCAR7P1",49,0)
FRC ;;FRC^V^0;4
"RTN","MCAR7P1",50,0)
DLC ;;DLCO^P^5;1^I ID'=2 S VAL=""
"RTN","MCAR7P1",51,0)
HEI ;;HEIGHT^P^0;4
"RTN","MCAR7P1",52,0)
WEI ;;WEIGHT^P^0;5
"RTN","MCAR7P1",53,0)
SMO ;;SMOKER^P^0;8^S VAL=$E($G(VAL),1)
"RTN","MCAR7P1",54,0)
TEM ;;TEMP^P^0;12
"RTN","MCAR7P1",55,0)
PBA ;;PBAR^P^0;7
"RTN","MCAR7P1",56,0)
VC ;;VC^V^0;3
"RTN","MCAR7P2")
0^7^B5973879
"RTN","MCAR7P2",1,0)
MCAR7P2 ; HIRMFO/REL-MedGraphics Pulmonary ;3/3/00  09:57
"RTN","MCAR7P2",2,0)
 ;;2.3;Medicine;**24**;09/13/1996
"RTN","MCAR7P2",3,0)
OBX ; Process OBX
"RTN","MCAR7P2",4,0)
 S X=$G(MSG(NUM)) G:X="" UPDATE I $E(X,1,3)'="OBX" S ERRTX="OBX not found when expected" G ^MCAR7X
"RTN","MCAR7P2",5,0)
 S SEG("OBX")=X
"RTN","MCAR7P2",6,0)
 S STYP=$P(X,"|",3) I STYP="TX" G IMP
"RTN","MCAR7P2",7,0)
 S ID=$P(X,"|",5),CODE=$P(X,"|",4),VAL=$P(X,"|",6),UNITS=$P(X,"|",7) I CODE["^" S CODE=$P(CODE,"^",1)
"RTN","MCAR7P2",8,0)
 I CODE=""!(VAL="") G NEXT
"RTN","MCAR7P2",9,0)
 I $E(CODE,1,3)'?2.3U G NEXT
"RTN","MCAR7P2",10,0)
 S STR=$P($T(@$E(CODE,1,3)),";;",2) I STR="" G NEXT
"RTN","MCAR7P2",11,0)
 S S=$P(STR,"^",2),P=$P(STR,"^",3),EXE=$P(STR,"^",4) I EXE'="" X EXE
"RTN","MCAR7P2",12,0)
 I S="P" S $P(SET(S,+P),"^",$P(P,";",2))=VAL G NEXT
"RTN","MCAR7P2",13,0)
 I ID>1 S $P(SET(S,ID-1),"^",$P(P,";",2))=VAL
"RTN","MCAR7P2",14,0)
NEXT S NUM=NUM+1 G OBX
"RTN","MCAR7P2",15,0)
IMP ; Get Impression
"RTN","MCAR7P2",16,0)
 S NUM=NUM+1 S:$P(X,"|",4)[("&IMP") ICNT=ICNT+1,IMP(ICNT)=$P(X,"|",6) G OBX
"RTN","MCAR7P2",17,0)
 Q
"RTN","MCAR7P2",18,0)
UPDATE ; Update File
"RTN","MCAR7P2",19,0)
 S FIL=700 D PROC^MCAR7A ; Set Procedure Entry
"RTN","MCAR7P2",20,0)
 S P="" F  S P=$O(SET("P",P)) Q:P=""  F K=1:1:$L(SET("P",P),"^") S VAL=$P(SET("P",P),"^",K) I VAL'="" S $P(^MCAR(700,DA,P),"^",K)=VAL
"RTN","MCAR7P2",21,0)
 F ID="F","V" I $D(SET(ID)) D U1
"RTN","MCAR7P2",22,0)
 I $D(IMP) F P=1:1:ICNT S ^MCAR(700,DA,25,P,0)=IMP(P)
"RTN","MCAR7P2",23,0)
 I  S ^MCAR(700,DA,25,0)="^^"_ICNT_"^"_ICNT_"^"_DT
"RTN","MCAR7P2",24,0)
 S DIK="^MCAR(700," D IX1^DIK
"RTN","MCAR7P2",25,0)
 D GENACK^MCAR7X
"RTN","MCAR7P2",26,0)
 Q
"RTN","MCAR7P2",27,0)
U1 ; Set Study values
"RTN","MCAR7P2",28,0)
 S S=$S(ID="F":4,ID="V":3,1:"") Q:'S
"RTN","MCAR7P2",29,0)
 I ID="F" F P=1,2 I $D(SET(ID,P)) S $P(SET(ID,P),"^",1)=$S(P=1:"S",1:"B")
"RTN","MCAR7P2",30,0)
 I ID="V" F P=1,2 I $D(SET(ID,P)) I $P(SET(ID,P),"^",1)="" S $P(SET(ID,P),"^",1)="B"
"RTN","MCAR7P2",31,0)
 I '$D(^MCAR(700,DA,S,0)) S ^MCAR(700,DA,S,0)="^"_$S(S=3:"700.017SA",1:"700.018SA")_"^0^0"
"RTN","MCAR7P2",32,0)
 S P=0 F  S P=$O(SET(ID,P)) Q:P=""  F K=1:1:$L(SET(ID,P),"^") S VAL=$P(SET(ID,P),"^",K) I VAL'="" S $P(^MCAR(700,DA,S,P,0),"^",K)=VAL
"RTN","MCAR7P2",33,0)
 S P=$O(SET(ID,""),-1),$P(^MCAR(700,DA,S,0),"^",3,4)=(P_"^"_P)
"RTN","MCAR7P2",34,0)
 Q
"RTN","MCAR7P2",35,0)
VARS ;;
"RTN","MCAR7P2",36,0)
FVC ;;FVC^F^0;2
"RTN","MCAR7P2",37,0)
FEV ;;FEV1^F^0;3
"RTN","MCAR7P2",38,0)
FEF ;;FEF25-75%^F^0;5
"RTN","MCAR7P2",39,0)
PEF ;;PEF^F^0;4
"RTN","MCAR7P2",40,0)
MVV ;;MVV^F^0;7
"RTN","MCAR7P2",41,0)
TLC ;;TLC^V^0;2
"RTN","MCAR7P2",42,0)
RV ;;RV^V^0;5
"RTN","MCAR7P2",43,0)
FRC ;;FRC^V^0;4
"RTN","MCAR7P2",44,0)
DLC ;;DLCO^P^5;1
"RTN","MCAR7P2",45,0)
HEI ;;HEIGHT^P^0;4
"RTN","MCAR7P2",46,0)
WEI ;;WEIGHT^P^0;5
"RTN","MCAR7P2",47,0)
SMO ;;SMOKER^P^0;8^S VAL=$E($G(VAL),1)
"RTN","MCAR7P2",48,0)
TEM ;;TEMP^P^0;12
"RTN","MCAR7P2",49,0)
PBA ;;PBAR^P^0;7
"RTN","MCAR7P2",50,0)
SVC ;;VC^V^0;3
"RTN","MCAR7X")
0^8^B1926126
"RTN","MCAR7X",1,0)
MCAR7X ; HIRMFO/REL-Generate HL7 Error Message ;3/31/00  09:10
"RTN","MCAR7X",2,0)
 ;;2.3;Medicine;**24**;09/13/1996
"RTN","MCAR7X",3,0)
 D BULL,GENACK Q
"RTN","MCAR7X",4,0)
BULL ; Generate error message
"RTN","MCAR7X",5,0)
 S INST=$O(^MCAR(690.7,"B",MCAPP,0)) Q:'INST
"RTN","MCAR7X",6,0)
 S MG=$P($G(^MCAR(690.7,INST,0)),"^",2) Q:'MG
"RTN","MCAR7X",7,0)
 S MG=$P($G(^XMB(3.8,+MG,0)),"^",1) Q:MG=""
"RTN","MCAR7X",8,0)
 S XMTO="G."_MG_"@"_^XMB("NETNAME"),XMDUZ=.5
"RTN","MCAR7X",9,0)
 S TXT(1)=ERRTX,TXT(2)=X,TXT(3)=" "
"RTN","MCAR7X",10,0)
 S N=3 F X="MSH","PID","OBR","OBX" I $D(SEG(X)) S N=N+1,TXT(N)=SEG(X)
"RTN","MCAR7X",11,0)
 S XMSUBJ="A Clinical Instrument HL7 Error has occurred."
"RTN","MCAR7X",12,0)
 S XMBODY="TXT"
"RTN","MCAR7X",13,0)
 D SENDMSG^XMXAPI(XMDUZ,XMSUBJ,XMBODY,XMTO)
"RTN","MCAR7X",14,0)
 K TXT Q
"RTN","MCAR7X",15,0)
GENACK ; Generate an HL7 ACK message
"RTN","MCAR7X",16,0)
 S HLA("HLA",1)="MSA"_HL("FS")_$S($D(ERRTX):"AR",1:"AA")_HL("FS")_HL("MID")_$S($D(ERRTX):HL("FS")_ERRTX,1:"")
"RTN","MCAR7X",17,0)
 S HLEID=HL("EID"),HLEIDS=HL("EIDS"),HLARYTYP="LM",HLFORMAT=1,HLRESLTA=HL("MID")
"RTN","MCAR7X",18,0)
 D GENACK^HLMA1(HLEID,HLMTIENS,HLEIDS,HLARYTYP,HLFORMAT,.HLRESTLA)
"RTN","MCAR7X",19,0)
 K ERRTX Q
"SEC","^DD",690.7,690.7,.02,8)

"SEC","^DD",690.7,690.7,.02,8.5)

"SEC","^DD",690.7,690.7,.02,9)

"SEC","^DIC",690.7,690.7,0,"AUDIT")
@
"SEC","^DIC",690.7,690.7,0,"DD")
@
"SEC","^DIC",690.7,690.7,0,"DEL")
@
"SEC","^DIC",690.7,690.7,0,"LAYGO")
@
"SEC","^DIC",690.7,690.7,0,"RD")
@
"SEC","^DIC",690.7,690.7,0,"WR")
@
"VER")
8.0^22
"^DD",690.7,690.7,0)
FIELD^^.03^3
"^DD",690.7,690.7,0,"DDA")
N
"^DD",690.7,690.7,0,"DT")
2980821
"^DD",690.7,690.7,0,"IX","B",690.7,.01)

"^DD",690.7,690.7,0,"NM","Instrument HL7 Coding")

"^DD",690.7,690.7,.01,0)
NAME^RF^^0;1^K:$L(X)>30!($L(X)<2)!'(X'?1P.E) X
"^DD",690.7,690.7,.01,1,0)
^.1
"^DD",690.7,690.7,.01,1,1,0)
690.7^B
"^DD",690.7,690.7,.01,1,1,1)
S ^MCAR(690.7,"B",$E(X,1,30),DA)=""
"^DD",690.7,690.7,.01,1,1,2)
K ^MCAR(690.7,"B",$E(X,1,30),DA)
"^DD",690.7,690.7,.01,3)
Answer must be 2-30 characters in length.
"^DD",690.7,690.7,.01,21,0)
^^2^2^3001002^
"^DD",690.7,690.7,.01,21,1,0)
This is the name of the clinical instrument or system.  It will be used to
"^DD",690.7,690.7,.01,21,2,0)
match against the 4th piece of the MSH record.
"^DD",690.7,690.7,.01,"DT")
3001002
"^DD",690.7,690.7,.02,0)
PROCESSING ROUTINE^RF^^1;1^K:$L(X)>13!($L(X)<3) X
"^DD",690.7,690.7,.02,3)
Answer must be 3-13 characters in length.
"^DD",690.7,690.7,.02,21,0)
^^2^2^3000218^^^
"^DD",690.7,690.7,.02,21,1,0)
This field will contain the name of the routine used to process
"^DD",690.7,690.7,.02,21,2,0)
this instrument.
"^DD",690.7,690.7,.02,"DT")
3001004
"^DD",690.7,690.7,.03,0)
MAIL GROUP FOR ERRORS^P3.8^XMB(3.8,^0;2^Q
"^DD",690.7,690.7,.03,21,0)
^^2^2^3001018^
"^DD",690.7,690.7,.03,21,1,0)
This field will contain the Mail Group to be notified in the event of an
"^DD",690.7,690.7,.03,21,2,0)
error from the device.
"^DD",690.7,690.7,.03,"DT")
3001018
"^DIC",690.7,690.7,0)
Instrument HL7 Coding^690.7
"^DIC",690.7,690.7,0,"GL")
^MCAR(690.7,
"^DIC",690.7,690.7,"%",0)
^1.005^^
"^DIC",690.7,690.7,"%D",0)
^^4^4^3001004^
"^DIC",690.7,690.7,"%D",1,0)
This file is used by the Medicine device clinical interface to
"^DIC",690.7,690.7,"%D",2,0)
determine which clinical instrument routine is to process the data passed
"^DIC",690.7,690.7,"%D",3,0)
from HL7. In the event of an error this file will contain the
"^DIC",690.7,690.7,"%D",4,0)
corresponding Mail Group that will be notified.
"^DIC",690.7,"B","Instrument HL7 Coding",690.7)

**END**
**END**
