Released WV*1*17 SEQ #16
Extracted from mail message
**KIDS**:WV*1.0*17^

**INSTALL NAME**
WV*1.0*17
"BLD",4192,0)
WV*1.0*17^WOMEN'S HEALTH^0^3030403^y
"BLD",4192,1,0)
^^2^2^3030110^
"BLD",4192,1,1,0)
Please read the WV*1*17 patch description on FORUM for an explanation of
"BLD",4192,1,2,0)
what this patch does.
"BLD",4192,4,0)
^9.64PA^^
"BLD",4192,"ABNS",0)
^9.66A^^
"BLD",4192,"ABPKG")
n^n
"BLD",4192,"KRN",0)
^9.67PA^8989.52^19
"BLD",4192,"KRN",.4,0)
.4
"BLD",4192,"KRN",.4,"NM",0)
^9.68A^^
"BLD",4192,"KRN",.401,0)
.401
"BLD",4192,"KRN",.402,0)
.402
"BLD",4192,"KRN",.403,0)
.403
"BLD",4192,"KRN",.5,0)
.5
"BLD",4192,"KRN",.84,0)
.84
"BLD",4192,"KRN",3.6,0)
3.6
"BLD",4192,"KRN",3.8,0)
3.8
"BLD",4192,"KRN",9.2,0)
9.2
"BLD",4192,"KRN",9.8,0)
9.8
"BLD",4192,"KRN",9.8,"NM",0)
^9.68A^1^1
"BLD",4192,"KRN",9.8,"NM",1,0)
WVUTL9^^0^B27695709
"BLD",4192,"KRN",9.8,"NM","B","WVUTL9",1)

"BLD",4192,"KRN",19,0)
19
"BLD",4192,"KRN",19,"NM",0)
^9.68A^^
"BLD",4192,"KRN",19.1,0)
19.1
"BLD",4192,"KRN",101,0)
101
"BLD",4192,"KRN",409.61,0)
409.61
"BLD",4192,"KRN",771,0)
771
"BLD",4192,"KRN",870,0)
870
"BLD",4192,"KRN",8989.51,0)
8989.51
"BLD",4192,"KRN",8989.52,0)
8989.52
"BLD",4192,"KRN",8994,0)
8994
"BLD",4192,"KRN","B",.4,.4)

"BLD",4192,"KRN","B",.401,.401)

"BLD",4192,"KRN","B",.402,.402)

"BLD",4192,"KRN","B",.403,.403)

"BLD",4192,"KRN","B",.5,.5)

"BLD",4192,"KRN","B",.84,.84)

"BLD",4192,"KRN","B",3.6,3.6)

"BLD",4192,"KRN","B",3.8,3.8)

"BLD",4192,"KRN","B",9.2,9.2)

"BLD",4192,"KRN","B",9.8,9.8)

"BLD",4192,"KRN","B",19,19)

"BLD",4192,"KRN","B",19.1,19.1)

"BLD",4192,"KRN","B",101,101)

"BLD",4192,"KRN","B",409.61,409.61)

"BLD",4192,"KRN","B",771,771)

"BLD",4192,"KRN","B",870,870)

"BLD",4192,"KRN","B",8989.51,8989.51)

"BLD",4192,"KRN","B",8989.52,8989.52)

"BLD",4192,"KRN","B",8994,8994)

"BLD",4192,"QUES",0)
^9.62^^
"BLD",4192,"REQB",0)
^9.611^1^1
"BLD",4192,"REQB",1,0)
WV*1.0*10^2
"BLD",4192,"REQB","B","WV*1.0*10",1)

"MBREQ")
0
"PKG",364,-1)
1^1
"PKG",364,0)
WOMEN'S HEALTH^WV^Tracks health issues specific to female patients.
"PKG",364,20,0)
^9.402P^^
"PKG",364,22,0)
^9.49I^1^1
"PKG",364,22,1,0)
1.0^2980925^2980508^547
"PKG",364,22,1,"PAH",1,0)
17^3030403
"PKG",364,22,1,"PAH",1,1,0)
^^2^2^3030403
"PKG",364,22,1,"PAH",1,1,1,0)
Please read the WV*1*17 patch description on FORUM for an explanation of
"PKG",364,22,1,"PAH",1,1,2,0)
what this patch does.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
1
"RTN","WVUTL9")
0^1^B27695709
"RTN","WVUTL9",1,0)
WVUTL9 ;HCIOFO/FT-Women's Health Utility Routine; ;3/18/03  15:44
"RTN","WVUTL9",2,0)
 ;;1.0;WOMEN'S HEALTH;**3,7,9,10,17**;Sep 30, 1998
"RTN","WVUTL9",3,0)
 ;
"RTN","WVUTL9",4,0)
 ; This routine uses the following IAs:
"RTN","WVUTL9",5,0)
 ; #10035 - ^DPT references        (supported)
"RTN","WVUTL9",6,0)
 ; #10056 - ^DIC(5 references      (supported)
"RTN","WVUTL9",7,0)
 ; #10061 - ^VADPT calls           (supported)
"RTN","WVUTL9",8,0)
 ; #10103 - ^XLFDT calls           (supported)
"RTN","WVUTL9",9,0)
 ;
"RTN","WVUTL9",10,0)
DCM(SITE) ; Default case manager check
"RTN","WVUTL9",11,0)
 ; If there is a default case manager return 1 else 0.
"RTN","WVUTL9",12,0)
 I 'SITE Q 0
"RTN","WVUTL9",13,0)
 I $P($G(^WV(790.02,SITE,0)),U,2) Q 1
"RTN","WVUTL9",14,0)
 Q 0
"RTN","WVUTL9",15,0)
 ;
"RTN","WVUTL9",16,0)
NODCM ; No Default Case Manager message
"RTN","WVUTL9",17,0)
 W !,"Sorry, but a DEFAULT CASE MANAGER must be assigned for your facility"
"RTN","WVUTL9",18,0)
 W !,"before a patient can be entered into the Women's Health database.",!
"RTN","WVUTL9",19,0)
 W !,"Please use the EDIT SITE PARAMETERS option on the FILE MAINTENANCE"
"RTN","WVUTL9",20,0)
 W !,"menu to designate a DEFAULT CASE MANAGER.",!
"RTN","WVUTL9",21,0)
 D DIRZ^WVUTL3
"RTN","WVUTL9",22,0)
 Q
"RTN","WVUTL9",23,0)
 ;
"RTN","WVUTL9",24,0)
AGE(DFN) ;EP
"RTN","WVUTL9",25,0)
 ;---> YIELD PATIENT'S AGE IN YEARS.
"RTN","WVUTL9",26,0)
 ;---> REQUIRED VARIABLE: DFN=IEN PATIENT FILE
"RTN","WVUTL9",27,0)
 ; Different from AGE^WVUTL1. This EP returns age at date of death.
"RTN","WVUTL9",28,0)
 N X,X1,X2
"RTN","WVUTL9",29,0)
 Q:'$G(DFN) "NO PATIENT"
"RTN","WVUTL9",30,0)
 S X2=$$DOB^WVUTL1(DFN)
"RTN","WVUTL9",31,0)
 Q:'+X2 "UNKNOWN"
"RTN","WVUTL9",32,0)
 S X1=DT
"RTN","WVUTL9",33,0)
 I $$DECEASED^WVUTL1(DFN) S X1=+^DPT(DFN,.35)
"RTN","WVUTL9",34,0)
 D ^%DTC
"RTN","WVUTL9",35,0)
 Q $P(X/365.25,".")_"y/o"
"RTN","WVUTL9",36,0)
 ;
"RTN","WVUTL9",37,0)
GAPPT(DFN) ; Get future appointments from SDA^VADPT
"RTN","WVUTL9",38,0)
 ; Returns ^UTILITY("VASD",$J,#,"I") <-internal values
"RTN","WVUTL9",39,0)
 ;         ^UTILITY("VASD",$J,#,"E") <-external vlaues
"RTN","WVUTL9",40,0)
 ; piece 1: appointment date/time
"RTN","WVUTL9",41,0)
 ;       2: clinic
"RTN","WVUTL9",42,0)
 ;       3: status
"RTN","WVUTL9",43,0)
 ;       4: type
"RTN","WVUTL9",44,0)
 Q:'$G(DFN)
"RTN","WVUTL9",45,0)
 N VASD,VAERR
"RTN","WVUTL9",46,0)
 S VASD("F")=$$NOW^XLFDT,VASD("W")=1 ;get active/kept appts 
"RTN","WVUTL9",47,0)
 D SDA^VADPT
"RTN","WVUTL9",48,0)
 Q
"RTN","WVUTL9",49,0)
KAPPT(DFN) ; Kill APPOINTMENTS multiple
"RTN","WVUTL9",50,0)
 Q:'$G(DFN)
"RTN","WVUTL9",51,0)
 N DA,DIK
"RTN","WVUTL9",52,0)
 S DA=0,DA(1)=DFN
"RTN","WVUTL9",53,0)
 F  S DA=$O(^WV(790,DFN,2,DA)) Q:'DA  D
"RTN","WVUTL9",54,0)
 .S DIK="^WV(790,"_DFN_",2,"
"RTN","WVUTL9",55,0)
 .D ^DIK
"RTN","WVUTL9",56,0)
 .Q
"RTN","WVUTL9",57,0)
 Q
"RTN","WVUTL9",58,0)
SAPPT(DFN) ; Set APPOINTMENTS multiple
"RTN","WVUTL9",59,0)
 Q:'$G(DFN)
"RTN","WVUTL9",60,0)
 Q:'$D(^WV(790,DFN))
"RTN","WVUTL9",61,0)
 N DA,DIC,DLAYGO,LOOP,X
"RTN","WVUTL9",62,0)
 S LOOP=0,DIC="^WV(790,"_DFN_",2,",DIC(0)="L",DA(1)=DFN,DLAYGO=790
"RTN","WVUTL9",63,0)
 I '$D(^UTILITY("VASD",$J))  D  Q  ;no appts passed from SDA^VADPT
"RTN","WVUTL9",64,0)
 .S X="No Future Appointments"
"RTN","WVUTL9",65,0)
 .D ^DIC
"RTN","WVUTL9",66,0)
 .Q
"RTN","WVUTL9",67,0)
 F  S LOOP=$O(^UTILITY("VASD",$J,LOOP)) Q:'LOOP  D
"RTN","WVUTL9",68,0)
 .S X=$G(^UTILITY("VASD",$J,LOOP,"E"))
"RTN","WVUTL9",69,0)
 .Q:X=""
"RTN","WVUTL9",70,0)
 .S X=$P(X,U,1)_"   Clinic: "_$P(X,U,2)
"RTN","WVUTL9",71,0)
 .D ^DIC
"RTN","WVUTL9",72,0)
 .Q
"RTN","WVUTL9",73,0)
 Q
"RTN","WVUTL9",74,0)
KILLUG ; Kill Utility Global created by SDA^VADPT call
"RTN","WVUTL9",75,0)
 K ^UTILITY("VASD",$J)
"RTN","WVUTL9",76,0)
 Q
"RTN","WVUTL9",77,0)
IEN(WVFILE,WVALUE) ; Return ien of entry
"RTN","WVUTL9",78,0)
 ; input: WVFILE - File number
"RTN","WVUTL9",79,0)
 ;        WVALUE - value of the .01 field
"RTN","WVUTL9",80,0)
 I 'WVFILE!(WVALUE="") Q 0
"RTN","WVUTL9",81,0)
 Q +$O(^WV(WVFILE,"B",WVALUE,0))
"RTN","WVUTL9",82,0)
 ;
"RTN","WVUTL9",83,0)
GADD(DFN) ; Get COMPLETE ADDRESS with ADD^VADPT
"RTN","WVUTL9",84,0)
 ; Returns VAPA array
"RTN","WVUTL9",85,0)
 Q:'$G(DFN)
"RTN","WVUTL9",86,0)
 D ADD^VADPT
"RTN","WVUTL9",87,0)
 Q
"RTN","WVUTL9",88,0)
KADD(DFN) ; Kill COMPLETE ADDRESS multiple
"RTN","WVUTL9",89,0)
 Q:'$G(DFN)
"RTN","WVUTL9",90,0)
 N DA,DIK
"RTN","WVUTL9",91,0)
 S DA=0,DA(1)=DFN
"RTN","WVUTL9",92,0)
 F  S DA=$O(^WV(790,DFN,3,DA)) Q:'DA  D
"RTN","WVUTL9",93,0)
 .S DIK="^WV(790,"_DFN_",3,"
"RTN","WVUTL9",94,0)
 .D ^DIK
"RTN","WVUTL9",95,0)
 .Q
"RTN","WVUTL9",96,0)
 Q
"RTN","WVUTL9",97,0)
SADD(DFN) ; Set COMPLETE ADDRESS multiple
"RTN","WVUTL9",98,0)
 Q:'$G(DFN)
"RTN","WVUTL9",99,0)
 Q:'$D(^WV(790,DFN))
"RTN","WVUTL9",100,0)
 N DA,DIC,DLAYGO,LOOP,WVERR,WVSTATE,X
"RTN","WVUTL9",101,0)
 S LOOP=0,DIC="^WV(790,"_DFN_",3,",DIC(0)="L",DA(1)=DFN,DLAYGO=790
"RTN","WVUTL9",102,0)
 I '$D(VAPA)  D  Q  ;no address passed from ADD^VADPT
"RTN","WVUTL9",103,0)
 .S X="No Address on file"
"RTN","WVUTL9",104,0)
 .D ^DIC
"RTN","WVUTL9",105,0)
 .Q
"RTN","WVUTL9",106,0)
 ; look for confidential address
"RTN","WVUTL9",107,0)
 I $G(VAPA(12))'=1 D RA Q  ;no confidential address, use regular address
"RTN","WVUTL9",108,0)
 I $P($G(VAPA(22,2)),U,3)="Y" D CC Q  ;category 2 - appointments
"RTN","WVUTL9",109,0)
 I $P($G(VAPA(22,4)),U,3)="Y" D CC Q  ;category 4 - medical records
"RTN","WVUTL9",110,0)
 D RA
"RTN","WVUTL9",111,0)
 Q
"RTN","WVUTL9",112,0)
RA ; get regular address
"RTN","WVUTL9",113,0)
 F LOOP=1,2,3 D
"RTN","WVUTL9",114,0)
 .S X=$G(VAPA(LOOP))
"RTN","WVUTL9",115,0)
 .Q:X=""
"RTN","WVUTL9",116,0)
 .S:$E(X)'?1N X=" "_X
"RTN","WVUTL9",117,0)
 .D ^DIC
"RTN","WVUTL9",118,0)
 .Q
"RTN","WVUTL9",119,0)
 S WVSTATE=""
"RTN","WVUTL9",120,0)
 I $P(VAPA(5),U,1) D
"RTN","WVUTL9",121,0)
 .S WVSTATE=$$GET1^DIQ(5,$P(VAPA(5),U,1),1,"E","","WVERR")
"RTN","WVUTL9",122,0)
 .Q
"RTN","WVUTL9",123,0)
 S X=VAPA(4)_", "_WVSTATE_"  "_VAPA(6)
"RTN","WVUTL9",124,0)
 Q:X=",   "
"RTN","WVUTL9",125,0)
 D ^DIC
"RTN","WVUTL9",126,0)
 Q
"RTN","WVUTL9",127,0)
CC ; get Confidential Communication address
"RTN","WVUTL9",128,0)
 F LOOP=13,14,15 D
"RTN","WVUTL9",129,0)
 .S X=$G(VAPA(LOOP))
"RTN","WVUTL9",130,0)
 .Q:X=""
"RTN","WVUTL9",131,0)
 .S:$E(X)'?1N X=" "_X
"RTN","WVUTL9",132,0)
 .D ^DIC
"RTN","WVUTL9",133,0)
 .Q
"RTN","WVUTL9",134,0)
 S WVSTATE=""
"RTN","WVUTL9",135,0)
 I $P(VAPA(17),U,1) D
"RTN","WVUTL9",136,0)
 .S WVSTATE=$$GET1^DIQ(5,$P(VAPA(17),U,1),1,"E","","WVERR")
"RTN","WVUTL9",137,0)
 .Q
"RTN","WVUTL9",138,0)
 S X=$P(VAPA(16),U,1)_", "_WVSTATE_"  "_$P(VAPA(18),U,1)
"RTN","WVUTL9",139,0)
 Q:X=",   "
"RTN","WVUTL9",140,0)
 D ^DIC
"RTN","WVUTL9",141,0)
 Q
"RTN","WVUTL9",142,0)
KVAR ; Kill off VADPT variables used
"RTN","WVUTL9",143,0)
 D KVAR^VADPT
"RTN","WVUTL9",144,0)
 Q
"RTN","WVUTL9",145,0)
ELIG(WVDFN) ; Get patient's eligibilty code.
"RTN","WVUTL9",146,0)
 ;  Input: patient DFN
"RTN","WVUTL9",147,0)
 ; Output: internal^external values
"RTN","WVUTL9",148,0)
 N DFN,I,VAEL,VAERR,X,Y
"RTN","WVUTL9",149,0)
 S DFN=WVDFN
"RTN","WVUTL9",150,0)
 D ELIG^VADPT ;get elibility code
"RTN","WVUTL9",151,0)
 Q $G(VAEL(1)) ;VAEL(1)=internal^external
"RTN","WVUTL9",152,0)
 ;
"RTN","WVUTL9",153,0)
HELP(WVDA,WVA,WVB) ; Display message for eligiblity codes
"RTN","WVUTL9",154,0)
 ; WVDA - the FILE 790.02 ien
"RTN","WVUTL9",155,0)
 ; WVA  - the node number where the eligibilty codes are stored
"RTN","WVUTL9",156,0)
 ; WVB  - the package name associated with those eligibility codes
"RTN","WVUTL9",157,0)
 Q:'$O(^WV(790.02,WVDA,WVA,0))  ;no eligibility codes for lab data
"RTN","WVUTL9",158,0)
 N WVMSG
"RTN","WVUTL9",159,0)
 S WVMSG(1)="The ELIGIBILITY CODE(S) defined for "_WVB_" will be deleted when you"
"RTN","WVUTL9",160,0)
 S WVMSG(2)="exit and save your changes."
"RTN","WVUTL9",161,0)
 D HLP^DDSUTL(.WVMSG)
"RTN","WVUTL9",162,0)
 Q
"RTN","WVUTL9",163,0)
DELETE(WVDA) ; Delete eligibility codes, if necessary
"RTN","WVUTL9",164,0)
 ; task as a background job?
"RTN","WVUTL9",165,0)
 Q:'WVDA
"RTN","WVUTL9",166,0)
 N WVLAV,WVLSP,WVNODE,WVRAV,WVRSP,X,Y
"RTN","WVUTL9",167,0)
 S WVNODE=$G(^WV(790.02,WVDA,0))
"RTN","WVUTL9",168,0)
 Q:WVNODE=""
"RTN","WVUTL9",169,0)
 S WVRSP=$P(WVNODE,U,10) ;import mams from radiology
"RTN","WVUTL9",170,0)
 S WVRAV=$P(WVNODE,U,25) ;include all non-veterans (rad)
"RTN","WVUTL9",171,0)
 S WVLSP=$P(WVNODE,U,24) ;import tests from lab
"RTN","WVUTL9",172,0)
 S WVLAV=$P(WVNODE,U,26) ;include all non-veterans (lab)
"RTN","WVUTL9",173,0)
 ; Delete eligibility codes related to radiology if 
"RTN","WVUTL9",174,0)
 ; 1)     import mams from radiology = YES, or
"RTN","WVUTL9",175,0)
 ; 2) include all non-veterans (rad) = YES, or
"RTN","WVUTL9",176,0)
 ; 3) include all non-veterans (rad) = null
"RTN","WVUTL9",177,0)
 I WVRSP'=1!(WVRAV=1)!(WVRAV="") D
"RTN","WVUTL9",178,0)
 .N DA,DIK
"RTN","WVUTL9",179,0)
 .S DA(1)=WVDA,DA=0,DIK="^WV(790.02,DA(1),5,"
"RTN","WVUTL9",180,0)
 .F  S DA=$O(^WV(790.02,DA(1),5,DA)) Q:'DA  D ^DIK
"RTN","WVUTL9",181,0)
 .Q
"RTN","WVUTL9",182,0)
 ; Delete eligibility codes related to laboratory if 
"RTN","WVUTL9",183,0)
 ; 1)          import tests from lab = YES, or
"RTN","WVUTL9",184,0)
 ; 2) include all non-veterans (lab) = YES, or
"RTN","WVUTL9",185,0)
 ; 3) include all non-veterans (lab) = null
"RTN","WVUTL9",186,0)
 I WVLSP'=1!(WVLAV=1)!(WVLAV="") D
"RTN","WVUTL9",187,0)
 .N DA,DIK
"RTN","WVUTL9",188,0)
 .S DA(1)=WVDA,DA=0,DIK="^WV(790.02,DA(1),6,"
"RTN","WVUTL9",189,0)
 .F  S DA=$O(^WV(790.02,DA(1),6,DA)) Q:'DA  D ^DIK
"RTN","WVUTL9",190,0)
 .Q
"RTN","WVUTL9",191,0)
 Q
"VER")
8.0^22
**END**
**END**
