Released EAS*1*24 SEQ #20
Extracted from mail message
**KIDS**:EAS*1.0*24^

**INSTALL NAME**
EAS*1.0*24
"BLD",4195,0)
EAS*1.0*24^ENROLLMENT APPLICATION SYSTEM^0^3030115^y
"BLD",4195,4,0)
^9.64PA^^
"BLD",4195,"INID")
n^n^n
"BLD",4195,"INIT")
POST^EAS1P24
"BLD",4195,"KRN",0)
^9.67PA^8989.52^19
"BLD",4195,"KRN",.4,0)
.4
"BLD",4195,"KRN",.401,0)
.401
"BLD",4195,"KRN",.402,0)
.402
"BLD",4195,"KRN",.403,0)
.403
"BLD",4195,"KRN",.5,0)
.5
"BLD",4195,"KRN",.84,0)
.84
"BLD",4195,"KRN",3.6,0)
3.6
"BLD",4195,"KRN",3.8,0)
3.8
"BLD",4195,"KRN",9.2,0)
9.2
"BLD",4195,"KRN",9.8,0)
9.8
"BLD",4195,"KRN",9.8,"NM",0)
^9.68A^3^3
"BLD",4195,"KRN",9.8,"NM",1,0)
EASECPC^^0^B86951727
"BLD",4195,"KRN",9.8,"NM",2,0)
EAS1P24^^0^B808643
"BLD",4195,"KRN",9.8,"NM",3,0)
EASECPC1^^0^B4037691
"BLD",4195,"KRN",9.8,"NM","B","EAS1P24",2)

"BLD",4195,"KRN",9.8,"NM","B","EASECPC",1)

"BLD",4195,"KRN",9.8,"NM","B","EASECPC1",3)

"BLD",4195,"KRN",19,0)
19
"BLD",4195,"KRN",19.1,0)
19.1
"BLD",4195,"KRN",101,0)
101
"BLD",4195,"KRN",409.61,0)
409.61
"BLD",4195,"KRN",771,0)
771
"BLD",4195,"KRN",870,0)
870
"BLD",4195,"KRN",8989.51,0)
8989.51
"BLD",4195,"KRN",8989.52,0)
8989.52
"BLD",4195,"KRN",8994,0)
8994
"BLD",4195,"KRN","B",.4,.4)

"BLD",4195,"KRN","B",.401,.401)

"BLD",4195,"KRN","B",.402,.402)

"BLD",4195,"KRN","B",.403,.403)

"BLD",4195,"KRN","B",.5,.5)

"BLD",4195,"KRN","B",.84,.84)

"BLD",4195,"KRN","B",3.6,3.6)

"BLD",4195,"KRN","B",3.8,3.8)

"BLD",4195,"KRN","B",9.2,9.2)

"BLD",4195,"KRN","B",9.8,9.8)

"BLD",4195,"KRN","B",19,19)

"BLD",4195,"KRN","B",19.1,19.1)

"BLD",4195,"KRN","B",101,101)

"BLD",4195,"KRN","B",409.61,409.61)

"BLD",4195,"KRN","B",771,771)

"BLD",4195,"KRN","B",870,870)

"BLD",4195,"KRN","B",8989.51,8989.51)

"BLD",4195,"KRN","B",8989.52,8989.52)

"BLD",4195,"KRN","B",8994,8994)

"BLD",4195,"QUES",0)
^9.62^^
"BLD",4195,"REQB",0)
^9.611^2^2
"BLD",4195,"REQB",1,0)
EAS*1.0*19^2
"BLD",4195,"REQB",2,0)
EAS*1.0*7^2
"BLD",4195,"REQB","B","EAS*1.0*19",1)

"BLD",4195,"REQB","B","EAS*1.0*7",2)

"INIT")
POST^EAS1P24
"MBREQ")
0
"PKG",551,-1)
1^1
"PKG",551,0)
ENROLLMENT APPLICATION SYSTEM^EAS^ENROLLMENT
"PKG",551,20,0)
^9.402P^1^1
"PKG",551,20,1,0)
2^^EASXDR
"PKG",551,20,1,1)
 
"PKG",551,20,"B",2,1)

"PKG",551,22,0)
^9.49I^1^1
"PKG",551,22,1,0)
1.0^3010315^3010523^66481
"PKG",551,22,1,"PAH",1,0)
24^3030115
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
3
"RTN","EAS1P24")
0^2^B808643
"RTN","EAS1P24",1,0)
EAS1P24 ;ALB/TCK - Post Init for EAS*1.0*24 ;18 DEC 2002
"RTN","EAS1P24",2,0)
 ;;1.0;ENROLLMENT APPLICATION SYSTEM;**24**;MAR 15, 2001
"RTN","EAS1P24",3,0)
 ;
"RTN","EAS1P24",4,0)
POST ; Entry point for post init
"RTN","EAS1P24",5,0)
 ;
"RTN","EAS1P24",6,0)
 ; Update LTC COPAY EXEMPTION file (#714.1)
"RTN","EAS1P24",7,0)
 D MES^XPDUTL("*** Updating LTC COPAY EXEMPTION (File #714.1) ***")
"RTN","EAS1P24",8,0)
 N DIC,DA,DIE,X,Y,FILE,DR
"RTN","EAS1P24",9,0)
 ; Modify entry #11
"RTN","EAS1P24",10,0)
 D MES^XPDUTL("  - Modifying entry #11")
"RTN","EAS1P24",11,0)
 S FILE="^EAS(714.1,"
"RTN","EAS1P24",12,0)
 S DIC=FILE,X=11 D ^DIC
"RTN","EAS1P24",13,0)
 I Y<0 D MES^XPDUTL("    ERROR: Entry #11 not updated") Q
"RTN","EAS1P24",14,0)
 S DIE=FILE,DA=11,DR=".01///LTC RELATED TO HOSPICE CARE"
"RTN","EAS1P24",15,0)
 D ^DIE,MES^XPDUTL("  - Entry #11 Modified")
"RTN","EAS1P24",16,0)
 Q
"RTN","EAS1P24",17,0)
 ;
"RTN","EASECPC")
0^1^B86951727
"RTN","EASECPC",1,0)
EASECPC ;ALB/PHH,LBD,CKN - LTC Co-Payment Report; 29-AUG-2001
"RTN","EASECPC",2,0)
 ;;1.0;ENROLLMENT APPLICATION SYSTEM;**5,7,19,24**;Mar 15, 2001
"RTN","EASECPC",3,0)
 ;
"RTN","EASECPC",4,0)
 ; This routine produces a calculated LTC Co-Payment for a veteran.
"RTN","EASECPC",5,0)
 ;
"RTN","EASECPC",6,0)
EN N PAGE,DFN,DGMTI,DGMTDT,DGSTA,MODE,MARIT,MAXRT
"RTN","EASECPC",7,0)
 N DGDC,DGERR,DGINI,DGINTF,DGIRI,DGMTPAR,DGNC,DGND,DGSP,DGVIR0
"RTN","EASECPC",8,0)
 S DTIME=$G(DTIME,300),PAGE=0,(DFN,DGMTI,DGMTDT,DGSTA,MARIT)="",MODE=1
"RTN","EASECPC",9,0)
 Q:$$GETDFN
"RTN","EASECPC",10,0)
 Q:$$GETSDATE
"RTN","EASECPC",11,0)
 Q:$$EXEMPT
"RTN","EASECPC",12,0)
 S MARIT=$$MARIT
"RTN","EASECPC",13,0)
 ; Get the maximum daily copay rate for outpatient and inpatient LTC
"RTN","EASECPC",14,0)
 ; DBIA #3717
"RTN","EASECPC",15,0)
 S MAXRT=$$MAXRATE^IBAECU(DGMTDT)
"RTN","EASECPC",16,0)
 I '$P(MAXRT,U)!('$P(MAXRT,U,2)) W !!,"Copayment rates for LTC are not available at this time.",!! Q
"RTN","EASECPC",17,0)
 D QUEUE
"RTN","EASECPC",18,0)
 Q
"RTN","EASECPC",19,0)
GETDFN() ; Get the veteran's DFN
"RTN","EASECPC",20,0)
 N DIC,DTOUT,DUOUT,X,Y
"RTN","EASECPC",21,0)
 W !
"RTN","EASECPC",22,0)
 S DIC="^DPT(",DIC(0)="AEMZQ",DIC("S")="I $D(^DGMT(408.31,""AID"",3,+Y))"
"RTN","EASECPC",23,0)
 D ^DIC
"RTN","EASECPC",24,0)
 Q:$D(DTOUT)!($D(DUOUT)) 1
"RTN","EASECPC",25,0)
 Q:Y<0 1
"RTN","EASECPC",26,0)
 S DFN=+Y
"RTN","EASECPC",27,0)
 Q 0
"RTN","EASECPC",28,0)
GETSDATE() ; Get the Start Date
"RTN","EASECPC",29,0)
 N LST,DIC,DTOUT,DUOUT,X,Y
"RTN","EASECPC",30,0)
 W !
"RTN","EASECPC",31,0)
 S LST=$$LST^EASECU(DFN,"",3)
"RTN","EASECPC",32,0)
 S DIC("A")="Select DATE OF TEST: "
"RTN","EASECPC",33,0)
 I $D(^DGMT(408.31,+LST,0)) S DIC("B")=$P(^DGMT(408.31,+LST,0),"^")
"RTN","EASECPC",34,0)
 S DIC("S")="I $P(^(0),U,2)=DFN,$P(^(0),U,19)=3"
"RTN","EASECPC",35,0)
 S DIC="^DGMT(408.31,",DIC(0)="EQZ"
"RTN","EASECPC",36,0)
 D EN^DGMTLK
"RTN","EASECPC",37,0)
 Q:$D(DTOUT)!($D(DUOUT)) 1
"RTN","EASECPC",38,0)
 Q:Y<0 1
"RTN","EASECPC",39,0)
 S DGMTI=+Y,DGMTDT=$P(Y,U,2)
"RTN","EASECPC",40,0)
 S DGSTA=$$MTS^EASECU(DFN,$P(^DGMT(408.31,DGMTI,0),U,3))
"RTN","EASECPC",41,0)
 S DGSTA=$P(DGSTA,"^")
"RTN","EASECPC",42,0)
 Q 0
"RTN","EASECPC",43,0)
EXEMPT() ; Check for Test Status
"RTN","EASECPC",44,0)
 N LTCTS,ESTAT
"RTN","EASECPC",45,0)
 S LTCTS=$P($G(^DGMT(408.31,DGMTI,0)),U,3)
"RTN","EASECPC",46,0)
 I LTCTS="" D  Q 1
"RTN","EASECPC",47,0)
 .W !!,"This LTC Copayment Test has not yet been completed for this veteran!"
"RTN","EASECPC",48,0)
 S ESTAT=$P($G(^DG(408.32,LTCTS,0)),U)
"RTN","EASECPC",49,0)
 I ESTAT="EXEMPT" D  Q 1
"RTN","EASECPC",50,0)
 .W !!,"This veteran is ",ESTAT," from LTC Copayments!"
"RTN","EASECPC",51,0)
 I ESTAT'="NON-EXEMPT" D  Q 1
"RTN","EASECPC",52,0)
 .W !!,"This LTC Copay Test record contains an invalid test status!"
"RTN","EASECPC",53,0)
 .W !,"DFN: ",DGMTI,!,"Test Status: ",LTCTS
"RTN","EASECPC",54,0)
 Q 0
"RTN","EASECPC",55,0)
MARIT() ; Define Marital Status
"RTN","EASECPC",56,0)
 N DGPRI,DGVIRI,SRIC
"RTN","EASECPC",57,0)
 S DGPRI=$O(^DGPR(408.12,"C",DFN_";DPT(",0))
"RTN","EASECPC",58,0)
 D GETIENS^EASECU2(DFN,DGPRI,DGMTDT)
"RTN","EASECPC",59,0)
 S DGVIRI=DGIRI
"RTN","EASECPC",60,0)
 D DEP^EASECSU3
"RTN","EASECPC",61,0)
 S SRIC=$P(DGVIR0,U,16)
"RTN","EASECPC",62,0)
 Q DGSP_"^"_SRIC
"RTN","EASECPC",63,0)
QUEUE ; Get report device. Queue report if requested.
"RTN","EASECPC",64,0)
 N MSG
"RTN","EASECPC",65,0)
 S MSG(1)=""
"RTN","EASECPC",66,0)
 S MSG(2)="This report may take a long time to generate.  It is recommended that the report"
"RTN","EASECPC",67,0)
 S MSG(3)="be queued to print."
"RTN","EASECPC",68,0)
 S MSG(4)=""
"RTN","EASECPC",69,0)
 D BMES^XPDUTL(.MSG)
"RTN","EASECPC",70,0)
 K IOP,%ZIS
"RTN","EASECPC",71,0)
 S %ZIS="MQ"
"RTN","EASECPC",72,0)
 D ^%ZIS I POP W !!,"Report Cancelled!" Q
"RTN","EASECPC",73,0)
 I $D(IO("Q")) D  Q
"RTN","EASECPC",74,0)
 .S ZTRTN="START^EASECPC"
"RTN","EASECPC",75,0)
 .S ZTDESC="LTC Copay Calculation Report"
"RTN","EASECPC",76,0)
 .S (ZTSAVE("DFN"),ZTSAVE("DGMTI"),ZTSAVE("DGMTDT"),ZTSAVE("DGSTA"))=""
"RTN","EASECPC",77,0)
 .S (ZTSAVE("MODE"),ZTSAVE("PAGE"),ZTSAVE("MARIT"),ZTSAVE("MAXRT"))=""
"RTN","EASECPC",78,0)
 .D ^%ZTLOAD
"RTN","EASECPC",79,0)
 .W !!,"Report "_$S($D(ZTSK):"Queued!",1:"Cancelled!")
"RTN","EASECPC",80,0)
 .D HOME^%ZIS
"RTN","EASECPC",81,0)
 D START,^%ZISC
"RTN","EASECPC",82,0)
 Q
"RTN","EASECPC",83,0)
INITHDR ; Initialize the Report Header
"RTN","EASECPC",84,0)
 N %,%H,%I,X,CDATE
"RTN","EASECPC",85,0)
 D NOW^%DTC
"RTN","EASECPC",86,0)
 S CDATE=X
"RTN","EASECPC",87,0)
 S HDR(1)=$$FMTE^XLFDT(CDATE)
"RTN","EASECPC",88,0)
 S HDR(2)=""
"RTN","EASECPC",89,0)
 I MODE S HDR(3)="        LONG TERM CARE ESTIMATED COPAYMENTS FOR INSTITUTIONAL SERVICES"
"RTN","EASECPC",90,0)
 I 'MODE S HDR(3)="      LONG TERM CARE ESTIMATED COPAYMENTS FOR NON-INSTITUTIONAL SERVICES"
"RTN","EASECPC",91,0)
 S HDR(4)=""
"RTN","EASECPC",92,0)
 S HDR(5)=""
"RTN","EASECPC",93,0)
 Q
"RTN","EASECPC",94,0)
HEADER ; Print the header
"RTN","EASECPC",95,0)
 N LTCIDX,PGHDR
"RTN","EASECPC",96,0)
 S PAGE=$G(PAGE,0),PAGE=PAGE+1,PGHDR="Page: "_$J(PAGE,3)
"RTN","EASECPC",97,0)
 W #
"RTN","EASECPC",98,0)
 S LTCIDX="",LTCIDX=$O(HDR(LTCIDX))
"RTN","EASECPC",99,0)
 W HDR(LTCIDX),?71,PGHDR
"RTN","EASECPC",100,0)
 F  S LTCIDX=$O(HDR(LTCIDX)) Q:LTCIDX=""  D
"RTN","EASECPC",101,0)
 .W !,HDR(LTCIDX)
"RTN","EASECPC",102,0)
 Q
"RTN","EASECPC",103,0)
START ; Generate Report
"RTN","EASECPC",104,0)
 N CRT,HDR
"RTN","EASECPC",105,0)
 S CRT=$S($E(IOST,1,2)="C-":1,1:0)
"RTN","EASECPC",106,0)
 S MODE=1 U IO W ! D PRINT W !     ; Institutional
"RTN","EASECPC",107,0)
 I CRT Q:$$PAUSE(0)
"RTN","EASECPC",108,0)
 D:'CRT NOTETXT
"RTN","EASECPC",109,0)
 S MODE=0 U IO W ! D PRINT W !     ; Non-institutional
"RTN","EASECPC",110,0)
 I CRT Q:$$PAUSE(0)
"RTN","EASECPC",111,0)
 D:'CRT NOTETXT
"RTN","EASECPC",112,0)
 I CRT D  Q:$$PAUSE(0)
"RTN","EASECPC",113,0)
 .K HDR(3),HDR(4),HDR(5)
"RTN","EASECPC",114,0)
 .D HEADER,NOTETXT
"RTN","EASECPC",115,0)
 D EN^EASECPC1
"RTN","EASECPC",116,0)
 U 0
"RTN","EASECPC",117,0)
 I $G(ZTSK) S ZTREQ="@"
"RTN","EASECPC",118,0)
 Q
"RTN","EASECPC",119,0)
PRINT ; Print the Report
"RTN","EASECPC",120,0)
 N PAT0,NAME,SSN,DOB,ARRY,HDTEXT,IDX,SIDX,EIDX,MNTH,CPYFLG
"RTN","EASECPC",121,0)
 D INITHDR
"RTN","EASECPC",122,0)
 S PAT0=$G(^DPT(DFN,0)),NAME=$P(PAT0,"^"),SSN=$P(PAT0,"^",9),DOB=$P(PAT0,"^",3)
"RTN","EASECPC",123,0)
 ;
"RTN","EASECPC",124,0)
 D BLDTBL(DGMTDT,.ARRY)
"RTN","EASECPC",125,0)
 D DETFIG(.ARRY)
"RTN","EASECPC",126,0)
 S HDTEXT="TOTAL INCOME - TOTAL EXPENSES - TOTAL ALLOWANCE"
"RTN","EASECPC",127,0)
 D HEADER
"RTN","EASECPC",128,0)
 W NAME,?35,SSN,?62,"DOB: ",$$FMTE^XLFDT(DOB)
"RTN","EASECPC",129,0)
 W !,$S(+MARIT:"MARRIED",1:"SINGLE")
"RTN","EASECPC",130,0)
 I +MARIT,$P(MARIT,"^",2) W ?15,"SPOUSE RESIDING IN THE COMMUNITY"
"RTN","EASECPC",131,0)
 I CPYFLG W !,"** DECLINED TO PROVIDE INCOME INFORMATION **"
"RTN","EASECPC",132,0)
 W !,"LTC COPAY REPORT START DATE: ",$$FMTE^XLFDT(DGMTDT)
"RTN","EASECPC",133,0)
 W !!!,"LTC COPAYMENTS FOR DAYS 1-180",!,"COPAY CALC: ",HDTEXT
"RTN","EASECPC",134,0)
 S SIDX=1,EIDX=6
"RTN","EASECPC",135,0)
 W ! D PRINTROW("TOT INCOME    ",SIDX,EIDX,3)
"RTN","EASECPC",136,0)
 D PRINTROW("TOT EXPENSES  ",SIDX,EIDX,4)
"RTN","EASECPC",137,0)
 D PRINTROW("TOT ALLOWANCE ",SIDX,EIDX,5)
"RTN","EASECPC",138,0)
 W ! D PRINTROW("CALC COPAY    ",SIDX,EIDX,6)
"RTN","EASECPC",139,0)
 D PRINTROW("MAX COPAY     ",SIDX,EIDX,7)
"RTN","EASECPC",140,0)
 D PRINTROW("VET MAX COPAY ",SIDX,EIDX,8)
"RTN","EASECPC",141,0)
 W !,"              "
"RTN","EASECPC",142,0)
 F MNTH=1:1:6 W $J($P(ARRY(MNTH),"^"),11)
"RTN","EASECPC",143,0)
 ;
"RTN","EASECPC",144,0)
 I MODE,'+MARIT S HDTEXT="(TOTAL ASSETS + TOTAL INCOME) - TOTAL ALLOWANCE"
"RTN","EASECPC",145,0)
 I MODE,+MARIT S HDTEXT="(TOTAL ASSETS + TOTAL INCOME) - TOTAL EXPENSES - TOTAL ALLOWANCE"
"RTN","EASECPC",146,0)
 W !!,"LTC COPAYMENTS FOR DAYS 181+"
"RTN","EASECPC",147,0)
 W !,"COPAY CALC: ",HDTEXT,!
"RTN","EASECPC",148,0)
 S SIDX=7,EIDX=12
"RTN","EASECPC",149,0)
 I MODE D PRINTROW("TOT ASSETS    ",SIDX,EIDX,9)
"RTN","EASECPC",150,0)
 D PRINTROW("TOT INCOME    ",SIDX,EIDX,3)
"RTN","EASECPC",151,0)
 I 'MODE!MARIT D PRINTROW("TOT EXPENSES  ",SIDX,EIDX,4)
"RTN","EASECPC",152,0)
 D PRINTROW("TOT ALLOWANCE ",SIDX,EIDX,5)
"RTN","EASECPC",153,0)
 W ! D PRINTROW("CALC COPAY    ",SIDX,EIDX,6)
"RTN","EASECPC",154,0)
 D PRINTROW("MAX COPAY     ",SIDX,EIDX,7)
"RTN","EASECPC",155,0)
 D PRINTROW("VET MAX COPAY ",SIDX,EIDX,8)
"RTN","EASECPC",156,0)
 W !,"              "
"RTN","EASECPC",157,0)
 F MNTH=7:1:12 W $J($P(ARRY(MNTH),"^"),11)
"RTN","EASECPC",158,0)
 Q
"RTN","EASECPC",159,0)
PRINTROW(TEXT,SIDX,EIDX,NODE) ; Print the Rows
"RTN","EASECPC",160,0)
 N MNTH
"RTN","EASECPC",161,0)
 W !,TEXT
"RTN","EASECPC",162,0)
 F MNTH=SIDX:1:EIDX W $J($S($P(ARRY(MNTH),"^",NODE)[".":$P($P(ARRY(MNTH),"^",NODE),"."),1:$P(ARRY(MNTH),"^",NODE)),11)
"RTN","EASECPC",163,0)
 Q
"RTN","EASECPC",164,0)
PAUSE(RESP) ; Prompt user for next page or quit
"RTN","EASECPC",165,0)
 N DIR,DIRUT,DUOUT,DTOUT,U,X,Y
"RTN","EASECPC",166,0)
 S DIR(0)="E"
"RTN","EASECPC",167,0)
 D ^DIR
"RTN","EASECPC",168,0)
 I 'Y S RESP=1
"RTN","EASECPC",169,0)
 Q RESP
"RTN","EASECPC",170,0)
BLDTBL(DATE,ARRY) ; Build the Month/Year Table
"RTN","EASECPC",171,0)
 N IDX,FMNYR
"RTN","EASECPC",172,0)
 K ARRY
"RTN","EASECPC",173,0)
 S DATE=$$FMTHL7^XLFDT(DGMTDT)
"RTN","EASECPC",174,0)
 S FMNYR=$E(DATE,1,6)_"00"
"RTN","EASECPC",175,0)
 F IDX=1:1:12 D
"RTN","EASECPC",176,0)
 .S ARRY(IDX)=$$UP^XLFSTR($$FMTE^XLFDT($$HL7TFM^XLFDT(FMNYR)))
"RTN","EASECPC",177,0)
 .S ARRY(IDX)=$P(ARRY(IDX)," ")_"'"_$E($P(ARRY(IDX)," ",2),3,4)
"RTN","EASECPC",178,0)
 .S $P(ARRY(IDX),"^",2)=$E(FMNYR,5,6)
"RTN","EASECPC",179,0)
 .S FMNYR=$E(FMNYR,1,4)_$E(FMNYR,5,6)+1_"00"
"RTN","EASECPC",180,0)
 .S:$E(FMNYR,5,6)=13 FMNYR=$E(FMNYR,1,4)+1_"0100"
"RTN","EASECPC",181,0)
 Q
"RTN","EASECPC",182,0)
DETFIG(ARRY) ; Determine Figures
"RTN","EASECPC",183,0)
 ; Variables:  Marit:     0 = Single         1 = Married
"RTN","EASECPC",184,0)
 ;             Mode:      0 = Out-Patient    1 = In-Patient
"RTN","EASECPC",185,0)
 ;             FLAG180:   0 = 180 or Less    1 = 181+
"RTN","EASECPC",186,0)
 ;             SRIC:      0 = Not in Com.    1 = Reside in Com.
"RTN","EASECPC",187,0)
 ;             LWP:       0 = Not live w/    1 = Living w/ Pat.
"RTN","EASECPC",188,0)
 ;
"RTN","EASECPC",189,0)
 N DGDC,DGDEP,DGERR,DGFL,DGIN0,DGIN1,DGIN2,DGDET,DGINT,DGNWT
"RTN","EASECPC",190,0)
 N DGMTSC,DGNC,DGND,DGNWTF,DGSP,DGVINI,DGVIR0,DGVIRI,DGVPRI
"RTN","EASECPC",191,0)
 N IDX,INC,FLAG180,FXAST,LQAST,EXP,TAST,TINC,TEXP,DECINF,AGRPAY
"RTN","EASECPC",192,0)
 N ALLOW,CALCCPY,DAYS,LWP,MAXCPY,SRIC,VETMAX,IPDR,OPDR
"RTN","EASECPC",193,0)
 ;
"RTN","EASECPC",194,0)
 D SETUP^EASECSCU,DEP^EASECSU3,INC^EASECSU3
"RTN","EASECPC",195,0)
 S CPYFLG=0
"RTN","EASECPC",196,0)
 S DECINF=$P($G(^DGMT(408.31,DGMTI,0)),"^",14)
"RTN","EASECPC",197,0)
 S AGRPAY=$P($G(^DGMT(408.31,DGMTI,0)),"^",11)
"RTN","EASECPC",198,0)
 I DECINF,AGRPAY S CPYFLG=1
"RTN","EASECPC",199,0)
 S SRIC=$P(MARIT,U,2)
"RTN","EASECPC",200,0)
 S LWP=+$P(DGVIR0,U,15)
"RTN","EASECPC",201,0)
 S INC=DGINT,EXP=DGDET
"RTN","EASECPC",202,0)
 S OPDR=$P(MAXRT,U),IPDR=$P(MAXRT,U,2)
"RTN","EASECPC",203,0)
 ;
"RTN","EASECPC",204,0)
 F FLAG180=0,1 D
"RTN","EASECPC",205,0)
 .I 'MODE S TAST=0
"RTN","EASECPC",206,0)
 .I MODE D
"RTN","EASECPC",207,0)
 ..S TAST=$S(FLAG180:DGNWT,1:0)
"RTN","EASECPC",208,0)
 ..I 'MARIT,FLAG180 S EXP=0
"RTN","EASECPC",209,0)
 .S TINC=INC/12,TEXP=EXP/12
"RTN","EASECPC",210,0)
 .;
"RTN","EASECPC",211,0)
 .; Build both tables: 1-180 days and 181+ days
"RTN","EASECPC",212,0)
 .F IDX=$S(FLAG180:7,1:1):1:$S(FLAG180:12,1:6) D
"RTN","EASECPC",213,0)
 ..S DAYS=$$DOM($P(ARRY(IDX),"^",2))
"RTN","EASECPC",214,0)
 ..S ALLOW=20*DAYS*(1+SRIC) S:CPYFLG ALLOW=0
"RTN","EASECPC",215,0)
 ..S CALCCPY=$$CALCCPY
"RTN","EASECPC",216,0)
 ..S MAXCPY=$$CALCMAX(DAYS)
"RTN","EASECPC",217,0)
 ..S VETMAX=$$VETMAX(CALCCPY,MAXCPY)
"RTN","EASECPC",218,0)
 ..S $P(ARRY(IDX),"^",3)=TINC
"RTN","EASECPC",219,0)
 ..S $P(ARRY(IDX),"^",4)=TEXP
"RTN","EASECPC",220,0)
 ..S $P(ARRY(IDX),"^",5)=ALLOW
"RTN","EASECPC",221,0)
 ..S $P(ARRY(IDX),"^",6)=CALCCPY
"RTN","EASECPC",222,0)
 ..S $P(ARRY(IDX),"^",7)=MAXCPY
"RTN","EASECPC",223,0)
 ..S $P(ARRY(IDX),"^",8)=VETMAX
"RTN","EASECPC",224,0)
 ..S:FLAG180 $P(ARRY(IDX),"^",9)=TAST
"RTN","EASECPC",225,0)
 ..I FLAG180,MODE S TAST=$$ASTSPD
"RTN","EASECPC",226,0)
 Q
"RTN","EASECPC",227,0)
 ;
"RTN","EASECPC",228,0)
ASTSPD() ;Asset Spend down for 180+ days
"RTN","EASECPC",229,0)
 Q:CPYFLG TAST
"RTN","EASECPC",230,0)
 I (TINC-TEXP-ALLOW)'>VETMAX D
"RTN","EASECPC",231,0)
 . I MARIT S TAST=TAST-(VETMAX-(TINC-TEXP-ALLOW))
"RTN","EASECPC",232,0)
 . I 'MARIT S TAST=TAST-(VETMAX-(TINC-ALLOW))
"RTN","EASECPC",233,0)
 . S:TAST<0 TAST=0
"RTN","EASECPC",234,0)
 Q TAST
"RTN","EASECPC",235,0)
 ;
"RTN","EASECPC",236,0)
CALCCPY() ; Calculate the Co-Pay Amount
"RTN","EASECPC",237,0)
 ;
"RTN","EASECPC",238,0)
 Q:CPYFLG 0
"RTN","EASECPC",239,0)
 Q TAST+TINC-ALLOW-TEXP
"RTN","EASECPC",240,0)
DOM(MNTH) ; Days in Month
"RTN","EASECPC",241,0)
 ; Returns: number of days in a month
"RTN","EASECPC",242,0)
 N DAYS,HL7DATE
"RTN","EASECPC",243,0)
 I "04060911"[MNTH S DAYS=30 Q DAYS
"RTN","EASECPC",244,0)
 I MNTH="02" D  Q DAYS
"RTN","EASECPC",245,0)
 .S DAYS=28
"RTN","EASECPC",246,0)
 .S HL7DATE=$$FMTHL7^XLFDT(DGMTDT)
"RTN","EASECPC",247,0)
 .S:$E(HL7DATE,1,4)#4=0 DAYS=29
"RTN","EASECPC",248,0)
 S DAYS=31
"RTN","EASECPC",249,0)
 Q DAYS
"RTN","EASECPC",250,0)
CALCMAX(DAYS) ; Calculate the Maximum Co-Pay Amount
"RTN","EASECPC",251,0)
 ;
"RTN","EASECPC",252,0)
 Q $S(MODE:IPDR,1:OPDR)*DAYS
"RTN","EASECPC",253,0)
VETMAX(CALCCPY,MAXCPY) ; Calculate the Veteran Maximum Co-Pay Amount
"RTN","EASECPC",254,0)
 ;
"RTN","EASECPC",255,0)
 Q:CPYFLG MAXCPY
"RTN","EASECPC",256,0)
 Q:CALCCPY<0 0
"RTN","EASECPC",257,0)
 Q:CALCCPY<MAXCPY CALCCPY
"RTN","EASECPC",258,0)
 Q MAXCPY
"RTN","EASECPC",259,0)
NOTETXT ; Write the Note message
"RTN","EASECPC",260,0)
 W !!,"IMPORTANT NOTICE: The copayment amounts shown in this report are"
"RTN","EASECPC",261,0)
 W " estimates",!,"based on calculations of the copayment amount for "
"RTN","EASECPC",262,0)
 W "an entire month. The",!,"copayment amounts will be adjusted to "
"RTN","EASECPC",263,0)
 W "reflect the actual start date of LTC",!,"services and the "
"RTN","EASECPC",264,0)
 W "copayment exemption for the first 21 days of service. The VET",!
"RTN","EASECPC",265,0)
 W "MAX COPAY amount is based on the assumption that the veteran "
"RTN","EASECPC",266,0)
 W "will be",!,"responsible to pay the lesser of EITHER the calculated"
"RTN","EASECPC",267,0)
 W " copayment (CALC COPAY) OR",!,"the maximum copayment (MAX COPAY).  "
"RTN","EASECPC",268,0)
 W "In the event that the calculated copayment",!,"(CALC COPAY) is a "
"RTN","EASECPC",269,0)
 W "negative figure, the veteran maximum copayment (VET MAX COPAY)",!
"RTN","EASECPC",270,0)
 W "will be adjusted to zero (0). If the veteran declined to provide"
"RTN","EASECPC",271,0)
 W " income",!,"information, the veteran will be obligated to pay the"
"RTN","EASECPC",272,0)
 W " maximum copayment."
"RTN","EASECPC",273,0)
 Q
"RTN","EASECPC1")
0^3^B4037691
"RTN","EASECPC1",1,0)
EASECPC1 ;ALB/LBD,CKN - LTC Co-Payment Report continuation ; 6-FEB-2002
"RTN","EASECPC1",2,0)
 ;;1.0;ENROLLMENT APPLICATION SYSTEM;**7,24**;Mar 15, 2001
"RTN","EASECPC1",3,0)
 ;
"RTN","EASECPC1",4,0)
 ; This routine produces a calculated LTC Co-Payment for a veteran.
"RTN","EASECPC1",5,0)
 ;
"RTN","EASECPC1",6,0)
EN ;
"RTN","EASECPC1",7,0)
 ; Print explanation of spend down page
"RTN","EASECPC1",8,0)
 D HEADER^EASECPC,SPNDDWN
"RTN","EASECPC1",9,0)
 Q
"RTN","EASECPC1",10,0)
SPNDDWN ; Text of message to explain the asset spend down
"RTN","EASECPC1",11,0)
 W !!,"EXPLANATION OF ASSET SPEND DOWN CALCULATION:"
"RTN","EASECPC1",12,0)
 W !,"============================================"
"RTN","EASECPC1",13,0)
 W !,"The veteran's assets are included in the calculation of copayments"
"RTN","EASECPC1",14,0)
 W !,"after 180 days of institutional LTC services.  The assets then may"
"RTN","EASECPC1",15,0)
 W !,"be reduced each month according to the following formula:"
"RTN","EASECPC1",16,0)
 W !
"RTN","EASECPC1",17,0)
 W !,"Single Veteran:"
"RTN","EASECPC1",18,0)
 W !
"RTN","EASECPC1",19,0)
 W !,"  TOTAL ASSETS-(MAX COPAY-(INCOME-ALLOWANCE))"
"RTN","EASECPC1",20,0)
 W !
"RTN","EASECPC1",21,0)
 W !,"Married Veteran (spouse residing in the community):"
"RTN","EASECPC1",22,0)
 W !
"RTN","EASECPC1",23,0)
 W !,"  TOTAL ASSETS-(MAX COPAY-(INCOME-EXPENSES-ALLOWANCE))"
"RTN","EASECPC1",24,0)
 W !
"RTN","EASECPC1",25,0)
 W !,"In other words, the assets will be reduced by the amount of the"
"RTN","EASECPC1",26,0)
 W !,"maximum copayment that is not covered by the veteran's income "
"RTN","EASECPC1",27,0)
 W !,"after all expenses and allowances are subtracted.  If the amount"
"RTN","EASECPC1",28,0)
 W !,"of the veteran's income after all expenses and allowances are"
"RTN","EASECPC1",29,0)
 W !,"subtracted is greater than the maximum copayment then the assets"
"RTN","EASECPC1",30,0)
 W !,"will not be reduced."
"RTN","EASECPC1",31,0)
 W !
"RTN","EASECPC1",32,0)
 Q
"VER")
8.0^22
**END**
**END**
