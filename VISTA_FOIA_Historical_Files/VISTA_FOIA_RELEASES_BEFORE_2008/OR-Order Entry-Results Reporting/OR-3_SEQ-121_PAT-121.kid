Released OR*3*121 SEQ #121
Extracted from mail message
**KIDS**:OR*3.0*121^

**INSTALL NAME**
OR*3.0*121
"BLD",3029,0)
OR*3.0*121^ORDER ENTRY/RESULTS REPORTING^0^3011115^y
"BLD",3029,1,0)
^^1^1^2981009^^^^
"BLD",3029,1,1,0)
Refer to the patch description on the patch message.
"BLD",3029,4,0)
^9.64PA^^0
"BLD",3029,"ABNS",0)
^9.66A^^
"BLD",3029,"ABPKG")
n^y^G.LABTEST@ISC-SLC.VA.GOV
"BLD",3029,"INIT")

"BLD",3029,"KRN",0)
^9.67PA^19^18
"BLD",3029,"KRN",.4,0)
.4
"BLD",3029,"KRN",.401,0)
.401
"BLD",3029,"KRN",.402,0)
.402
"BLD",3029,"KRN",.403,0)
.403
"BLD",3029,"KRN",.5,0)
.5
"BLD",3029,"KRN",.84,0)
.84
"BLD",3029,"KRN",3.6,0)
3.6
"BLD",3029,"KRN",3.8,0)
3.8
"BLD",3029,"KRN",9.2,0)
9.2
"BLD",3029,"KRN",9.8,0)
9.8
"BLD",3029,"KRN",9.8,"NM",0)
^9.68A^3^3
"BLD",3029,"KRN",9.8,"NM",1,0)
ORPRS04^^0^B42854284
"BLD",3029,"KRN",9.8,"NM",2,0)
ORPRS02^^0^B8808769
"BLD",3029,"KRN",9.8,"NM",3,0)
ORPRS10^^0^B9521535
"BLD",3029,"KRN",9.8,"NM","B","ORPRS02",2)

"BLD",3029,"KRN",9.8,"NM","B","ORPRS04",1)

"BLD",3029,"KRN",9.8,"NM","B","ORPRS10",3)

"BLD",3029,"KRN",19,0)
19
"BLD",3029,"KRN",19,"NM",0)
^9.68A^^
"BLD",3029,"KRN",19.1,0)
19.1
"BLD",3029,"KRN",19.1,"NM",0)
^9.68A^^
"BLD",3029,"KRN",101,0)
101
"BLD",3029,"KRN",101,"NM",0)
^9.68A^^0
"BLD",3029,"KRN",409.61,0)
409.61
"BLD",3029,"KRN",409.61,"NM",0)
^9.68A^^
"BLD",3029,"KRN",771,0)
771
"BLD",3029,"KRN",869.2,0)
869.2
"BLD",3029,"KRN",870,0)
870
"BLD",3029,"KRN",8994,0)
8994
"BLD",3029,"KRN","B",.4,.4)

"BLD",3029,"KRN","B",.401,.401)

"BLD",3029,"KRN","B",.402,.402)

"BLD",3029,"KRN","B",.403,.403)

"BLD",3029,"KRN","B",.5,.5)

"BLD",3029,"KRN","B",.84,.84)

"BLD",3029,"KRN","B",3.6,3.6)

"BLD",3029,"KRN","B",3.8,3.8)

"BLD",3029,"KRN","B",9.2,9.2)

"BLD",3029,"KRN","B",9.8,9.8)

"BLD",3029,"KRN","B",19,19)

"BLD",3029,"KRN","B",19.1,19.1)

"BLD",3029,"KRN","B",101,101)

"BLD",3029,"KRN","B",409.61,409.61)

"BLD",3029,"KRN","B",771,771)

"BLD",3029,"KRN","B",869.2,869.2)

"BLD",3029,"KRN","B",870,870)

"BLD",3029,"KRN","B",8994,8994)

"BLD",3029,"QUES",0)
^9.62^^
"BLD",3029,"REQB",0)
^9.611^3^3
"BLD",3029,"REQB",1,0)
OR*3.0*92^2
"BLD",3029,"REQB",2,0)
OR*3.0*99^2
"BLD",3029,"REQB",3,0)
OR*3.0*69^2
"BLD",3029,"REQB","B","OR*3.0*69",3)

"BLD",3029,"REQB","B","OR*3.0*92",1)

"BLD",3029,"REQB","B","OR*3.0*99",2)

"MBREQ")
0
"PKG",110,-1)
1^1
"PKG",110,0)
ORDER ENTRY/RESULTS REPORTING^OR^Order Entry/Results Reporting
"PKG",110,20,0)
^9.402P^^
"PKG",110,22,0)
^9.49I^1^1
"PKG",110,22,1,0)
3.0^2971217
"PKG",110,22,1,"PAH",1,0)
121^3011115
"PKG",110,22,1,"PAH",1,1,0)
^^1^1^3011115
"PKG",110,22,1,"PAH",1,1,1,0)
Refer to the patch description on the patch message.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
3
"RTN","ORPRS02")
0^2^B8808769
"RTN","ORPRS02",1,0)
ORPRS02 ; slc/dcm - Jurasic Prints ;11/18/96  20:20
"RTN","ORPRS02",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**11,69,99,121**;Dec 17, 1997
"RTN","ORPRS02",3,0)
DAY ; Process 24-hr Order Summary
"RTN","ORPRS02",4,0)
 N I,ORATTEND,ORTIT,ORPRES,ORSHORT,ORDG,ORGRP,ORSEL,ORSEQ
"RTN","ORPRS02",5,0)
 S OREND=0,ORTIT="DAILY ORDER SUMMARY",ORPRES=1,ORSHORT=$$SHORT
"RTN","ORPRS02",6,0)
 S ORDG=1,ORGRP("NAM")="ALL",ORGRP("ROOT")=1
"RTN","ORPRS02",7,0)
 D WRT
"RTN","ORPRS02",8,0)
 Q
"RTN","ORPRS02",9,0)
RANGE ; Order Summary for Date/time Range
"RTN","ORPRS02",10,0)
 N I,ORATTEND,ORTIT,ORPRES,ORSHORT,ORDG,ORGRP,ORSEL,ORSEQ
"RTN","ORPRS02",11,0)
 S OREND=0,ORTIT="ORDER SUMMARY",ORPRES=1,ORSHORT=$$SHORT
"RTN","ORPRS02",12,0)
 S ORDG=1,ORGRP("NAM")="ALL",ORGRP("ROOT")=1
"RTN","ORPRS02",13,0)
 D WRT
"RTN","ORPRS02",14,0)
 Q
"RTN","ORPRS02",15,0)
CUSTOM ; Customized Order Summary
"RTN","ORPRS02",16,0)
 N I,ORATTEND,ORTIT,ORSHORT,ORGRP,ORSEL,ORSEQ
"RTN","ORPRS02",17,0)
 S OREND=0,ORSHORT=$$SHORT
"RTN","ORPRS02",18,0)
 S ORGRP("NAM")=^ORD(100.98,ORDG,0),ORGRP("ROOT")=ORBUF,ORGRP("NAM")=$S($L($P(ORGRP("NAM"),"^",3)):$P(ORGRP("NAM"),"^",3),1:$E($P(ORGRP("NAM"),"^"),1,5))
"RTN","ORPRS02",19,0)
 S ORTIT=$P(ORPRES,";",2)_" for "_ORGRP("NAM")_" SERVICES"
"RTN","ORPRS02",20,0)
 D WRT
"RTN","ORPRS02",21,0)
 Q
"RTN","ORPRS02",22,0)
CHART ; Set up call to print chart copy for patient
"RTN","ORPRS02",23,0)
 N OREND,OREARLY,ORLATE,DFN
"RTN","ORPRS02",24,0)
 S OREARLY=+$G(ORSSTRT),ORLATE=+$G(ORSSTOP)
"RTN","ORPRS02",25,0)
 S DFN=+ORVP D PATIENT^ORPRS06(DFN,OREARLY,ORLATE,IO,21,+$G(ORL))
"RTN","ORPRS02",26,0)
 Q
"RTN","ORPRS02",27,0)
WORK ;Set up call for Work Copy patient summary
"RTN","ORPRS02",28,0)
 N OREND,OREARLY,ORLATE,DFN
"RTN","ORPRS02",29,0)
 S OREARLY=+$G(ORSSTRT),ORLATE=+$G(ORSSTOP)
"RTN","ORPRS02",30,0)
 S DFN=+ORVP D WORK^ORPRS06(DFN,OREARLY,ORLATE,IO)
"RTN","ORPRS02",31,0)
 Q
"RTN","ORPRS02",32,0)
CONT ; Print Report
"RTN","ORPRS02",33,0)
 N ZTRTN,ZTDESC
"RTN","ORPRS02",34,0)
 S ZTRTN="WRT^ORPRS02",ZTDESC=ORTIT
"RTN","ORPRS02",35,0)
 D @ZTRTN
"RTN","ORPRS02",36,0)
 Q
"RTN","ORPRS02",37,0)
WRT ;Entry point for Batch Processing 
"RTN","ORPRS02",38,0)
 ;Setup display group list, patient list, and process reports  
"RTN","ORPRS02",39,0)
 N %,%H,%I,DFN,DX,DY,I,II,J,K,ODATE,ORAGE,ORDAD,ORDOB,ORFLAG,ORI,ORIFN
"RTN","ORPRS02",40,0)
 N ORL,ORLIST,ORLST,ORMD,ORNP,ORODT,ORPD,ORPNM,ORPV,ORREQ,ORSEX
"RTN","ORPRS02",41,0)
 N ORSSN,ORSTOP,ORSTRT,ORSTS,ORASTS,ORTERM,ORTM,ORTS,ORTX,ORUSER,ORWARD
"RTN","ORPRS02",42,0)
 N ORSLTR,ORAW,VA,VAROOT,X,X0,X1,X3,Y,Z
"RTN","ORPRS02",43,0)
 S ORAW=$S(+$$GET^XPAR("SYS","OR ORDER SUMMARY CONTEXT",1,"I"):"AW",1:"")
"RTN","ORPRS02",44,0)
 U IO
"RTN","ORPRS02",45,0)
 D EN^ORQ1(ORVP,ORDG,+ORPRES,0,+ORSSTRT,+ORSSTOP,0,1,ORAW)
"RTN","ORPRS02",46,0)
 N ORPI,ORPA,ORPN,X,ORPIFN
"RTN","ORPRS02",47,0)
 S ORPI=0 F  S ORPI=$O(^TMP("ORR",$J,ORLIST,ORPI)) Q:'ORPI  D
"RTN","ORPRS02",48,0)
 . S ORPIFN=+^TMP("ORR",$J,ORLIST,ORPI),ORPA=$P(^(ORPI),";",2)
"RTN","ORPRS02",49,0)
 . I $D(^OR(100,ORPIFN,8,ORPA,0)) S X=^(0),ORPN=$P(X,"^",12)
"RTN","ORPRS02",50,0)
 . I $G(ORPN),$D(^ORD(100.02,ORPN,1)),'$P(^(1),"^",3) K ^TMP("ORR",$J,ORLIST,ORPI)
"RTN","ORPRS02",51,0)
 I $$GET^XPAR("ALL","ORPF SUMMARY SORT FORWARD",1,"I") D SORT
"RTN","ORPRS02",52,0)
 D @$S(ORSHORT:"EN^ORPRS04",1:"EN^ORPRS03")
"RTN","ORPRS02",53,0)
 K ^TMP("ORR",$J,ORLIST)
"RTN","ORPRS02",54,0)
 I $D(ZTQUEUED) S ZTREQ="@"
"RTN","ORPRS02",55,0)
 Q
"RTN","ORPRS02",56,0)
SHORT() ; Check whether user prefers condensed or expanded printout
"RTN","ORPRS02",57,0)
 Q +$$GET^XPAR("ALL","ORPF CONDENSED ORDER SUMMARY",1,"I")
"RTN","ORPRS02",58,0)
 ;
"RTN","ORPRS02",59,0)
SORT ;Re sort ^TMP("ORR",$J in inverse order
"RTN","ORPRS02",60,0)
 Q:'$D(^TMP("ORR",$J,ORLIST))
"RTN","ORPRS02",61,0)
 K ^TMP("ORRF",$J)
"RTN","ORPRS02",62,0)
 N I,C
"RTN","ORPRS02",63,0)
 S C=0,I=9999999
"RTN","ORPRS02",64,0)
 F  S I=$O(^TMP("ORR",$J,ORLIST,I),-1) Q:I<1  S C=C+1,^TMP("ORRF",$J,C)=^(I)
"RTN","ORPRS02",65,0)
 K ^TMP("ORR",$J,ORLIST)
"RTN","ORPRS02",66,0)
 M ^TMP("ORR",$J,ORLIST)=^TMP("ORRF",$J)
"RTN","ORPRS02",67,0)
 K ^TMP("ORRF",$J)
"RTN","ORPRS02",68,0)
 Q
"RTN","ORPRS04")
0^1^B42854284
"RTN","ORPRS04",1,0)
ORPRS04 ; slc/dcm - Print Order summaries (SHRIVELED) ;11/28/00  15:39
"RTN","ORPRS04",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**11,69,92,121**;Dec 17, 1997
"RTN","ORPRS04",3,0)
EN ;Print orders
"RTN","ORPRS04",4,0)
 I $$S^%ZTLOAD S (ZTSTOP,DIROUT,OREND)=1 W !!,"TASKED Report stopped by WHILE RUNNING." Q
"RTN","ORPRS04",5,0)
 N DIRUT,DUOUT,ORCONT,ORLINE,ORLSTO,ORDAD,ORLST,OREND,YENKO,SHELBY
"RTN","ORPRS04",6,0)
 K ORSPG
"RTN","ORPRS04",7,0)
 S YENKO=$$GET^XPAR("ALL","OR PRINT NO ORDERS ON SUM",1,"I"),SHELBY=$O(^TMP("ORR",$J,ORLIST,0))
"RTN","ORPRS04",8,0)
 ;YENKO=0 or "", if you don't want to print a page when no orders are present
"RTN","ORPRS04",9,0)
 ;      1 to print the page with "NO ORDERS" on it.
"RTN","ORPRS04",10,0)
 I 'YENKO,'SHELBY Q
"RTN","ORPRS04",11,0)
 S $P(ORLINE,"-",IOM+1)="",ORBOT=$S(IOSL<254:IOSL,1:254),Y=+ORVP,ORDAD="",OREND=0
"RTN","ORPRS04",12,0)
 D END^ORUDPA
"RTN","ORPRS04",13,0)
 S ORREQ("O")=""
"RTN","ORPRS04",14,0)
 I $Y+11>IOSL,$E(IOST)="P" W @IOF
"RTN","ORPRS04",15,0)
 I '$G(ORSPG) S ORSPG=1 D
"RTN","ORPRS04",16,0)
 . I $E(IOST)="C" D CTOP^ORPRS05(ORSPG,$G(ORSEND),$G(ORSPG("EOP")),ORTIT,ORSHORT,ORL(0),ORL(1),ORWARD,ORPNM,ORSSN,ORDOB,ORAGE,$G(ORPD)) Q
"RTN","ORPRS04",17,0)
 . D PTOP^ORPRS05(ORSPG,ORTIT,ORSHORT,ORSSTRT,ORSSTOP)
"RTN","ORPRS04",18,0)
 D PTHDR
"RTN","ORPRS04",19,0)
 I '$O(^TMP("ORR",$J,ORLIST,0)) W !!?3,"No orders.",!,ORLINE D  Q
"RTN","ORPRS04",20,0)
 . S ORSPG("EOP")=1
"RTN","ORPRS04",21,0)
 . I $E(IOST)="C" D  Q
"RTN","ORPRS04",22,0)
 .. K Y F  Q:$G(Y)["^"!($G(Y)=-1)  K DIR S DIR(0)="FO^1;2",DIR("A")="Press RETURN to continue or '^' to exit" D ^DIR S:Y="" Y=-1 K DIR Q:Y<0  D
"RTN","ORPRS04",23,0)
 ... I Y'["^" W $C(7),!!,"Enter '^' to stop listing for current patient"
"RTN","ORPRS04",24,0)
 . D PBOT^ORPRS05(1,ORBOT,ORPNM,ORSSN,ORDOB,ORAGE,$G(ORPD),ORL(0),ORL(1),$G(ORSHORT))
"RTN","ORPRS04",25,0)
 . I '$G(ORSEND) Q
"RTN","ORPRS04",26,0)
 . W !!!!!?(IOM-44)\2,"*****    E N D    O F    R E P O R T    ****",!
"RTN","ORPRS04",27,0)
 . K ORSEND,ORSPG,ORCONT
"RTN","ORPRS04",28,0)
 S ORCONT=1,ORLSTO=0,ORLST=0
"RTN","ORPRS04",29,0)
 F  S ORLST=$O(^TMP("ORR",$J,ORLIST,ORLST)) Q:'ORLST!$D(DUOUT)  D PRT Q:OREND
"RTN","ORPRS04",30,0)
 Q:OREND!$D(DUOUT)!$D(DTOUT)!$G(ORSPG("LAST"))
"RTN","ORPRS04",31,0)
 S ORLSTO=1
"RTN","ORPRS04",32,0)
 D PGCHK()
"RTN","ORPRS04",33,0)
 Q
"RTN","ORPRS04",34,0)
PRT ;Print order line
"RTN","ORPRS04",35,0)
 N ORXPND,OACTION,ORIFN,ORASTS,ORSTS,ORTX,ORODT,ORSTOP,ORUSER,ORSTRT,ORMD,OREL,ORFLAG,ORNAT
"RTN","ORPRS04",36,0)
 S ORIFN=+^TMP("ORR",$J,ORLIST,ORLST),OACTION=$P(^(ORLST),";",2)
"RTN","ORPRS04",37,0)
 I ORSHORT,$G(ORSPG("EOP")) S ORREQ("O")="" D PTOP^ORPRS05(ORSPG,ORTIT,ORSHORT,ORSSTRT,ORSSTOP),PTHDR S ORSPG("EOP")=0
"RTN","ORPRS04",38,0)
 I 'ORSHORT,$G(ORSPG("EOP")) D:$E(IOST)="C" CTOP^ORPRS05(ORSPG,$G(ORSEND),$G(ORSPG("EOP")),ORTIT,ORSHORT,ORL(0),ORL(1),ORWARD,ORPNM,ORSSN,ORDOB,ORAGE,$G(ORPD)) S ORSPG("EOP")=ORSPG
"RTN","ORPRS04",39,0)
 I $G(ORSPG(0))'=ORSPG S (ORREQ("O"),ORREQ("TIT",0))="",ORSPG(0)=ORSPG
"RTN","ORPRS04",40,0)
 Q:'$D(^OR(100,ORIFN,0))  S X=^(0),X3=$S($D(^(3)):^(3),1:""),ORDAD=$O(^(2,0))
"RTN","ORPRS04",41,0)
 S ORREQ=$P(X,"^",4),ORODT=$P(X,"^",7),ORSTOP=$P(X,"^",9),ORUSER=$P(X,"^",6),ORSTS=$P(X3,"^",3),ORSTRT=$P(X,"^",8),ORMD=$P(X3,"^",13),OREL=$S(ORSTS=11:1,1:"")
"RTN","ORPRS04",42,0)
 I $D(^OR(100,ORIFN,8,OACTION,0)) S X=^(0),ORODT=+X,ORREQ=$P(X,"^",3),ORMD=$P(X,"^",4),ORNAT=$P(X,"^",12),ORUSER=$P(X,"^",13),ORASTS=$P(X,"^",15),OREL=$S(ORASTS=11:1,1:"")
"RTN","ORPRS04",43,0)
 S ORREQ=$S(ORREQ:$S($D(^VA(200,ORREQ,0)):$P(^(0),"^"),1:"UNKNOWN"),1:"UNKNOWN"),ORREQ("TIT")=" " I ORREQ'="UNKNOWN" S X=$P(^(0),U,9),ORREQ("TIT")=$P($G(^DIC(3.1,+X,0)),U) I ORREQ("TIT")']"" S ORREQ("TIT")=" "
"RTN","ORPRS04",44,0)
 D TEXT^ORQ12(.ORTX,$S($G(OACTION):ORIFN_";"_OACTION,1:ORIFN),40)
"RTN","ORPRS04",45,0)
 S X=$P(ORREQ,",",2),ORREQ=$E($P(ORREQ,","),1,8)_","_$S($E(X)=" ":$E(X,$F(X,"")),1:$E(X))
"RTN","ORPRS04",46,0)
 S:ORREQ'=ORREQ("O") ORREQ("O")=ORREQ,ORREQ("F")=1,ORREQ("TIT",0)=""
"RTN","ORPRS04",47,0)
 S:'ORREQ("F")&(ORREQ=ORREQ("O")) ORREQ="    """
"RTN","ORPRS04",48,0)
 S ORREQ("F")=0
"RTN","ORPRS04",49,0)
 S:ORREQ("TIT")'=$G(ORREQ("TIT",0)) ORREQ("TIT",0)=ORREQ("TIT"),ORREQ("F")=1
"RTN","ORPRS04",50,0)
 S:'ORREQ("F")&(ORREQ("TIT")=ORREQ("TIT",0)) ORREQ("TIT")="    """
"RTN","ORPRS04",51,0)
 S ORREQ("F")=0
"RTN","ORPRS04",52,0)
STS ;
"RTN","ORPRS04",53,0)
 S ORSTS=$S($G(ORASTS)!(ORSTS):" "_$P(^ORD(100.01,$S($G(ORASTS):ORASTS,1:ORSTS),.1),"^"),1:" ")
"RTN","ORPRS04",54,0)
 D:'$D(ORTERM(5)) TERM^ORPRS01(IOST)
"RTN","ORPRS04",55,0)
 S ORFLAG=$$FLAG^ORPRS03(ORIFN,ORTERM(5))
"RTN","ORPRS04",56,0)
 S ORXPND=$O(ORTX(""),-1)
"RTN","ORPRS04",57,0)
 D PGCHK(ORXPND+1)
"RTN","ORPRS04",58,0)
 Q:OREND
"RTN","ORPRS04",59,0)
 W !!
"RTN","ORPRS04",60,0)
 S X=$P(ORTERM(7),"^")
"RTN","ORPRS04",61,0)
 S:OREL X=$$INV^ORU
"RTN","ORPRS04",62,0)
 W:$L(ORODT) $E(ORODT,4,5)_"/"_$E(ORODT,6,7)_"/"_$E(ORODT,2,3)
"RTN","ORPRS04",63,0)
 W ?8,ORSTS,?12,$S(ORDAD:"+",1:" ")
"RTN","ORPRS04",64,0)
 W:$O(ORTX(0)) ORTX($O(ORTX(0)))
"RTN","ORPRS04",65,0)
 W ?54,ORREQ W:$L(ORSTRT) ?65,$E(ORSTRT,4,5)_"/"_$E(ORSTRT,6,7)_"/"_$E(ORSTRT,2,3)
"RTN","ORPRS04",66,0)
 W:$L(ORSTOP) ?75,$E(ORSTOP,4,5)_"/"_$E(ORSTOP,6,7)
"RTN","ORPRS04",67,0)
 W !?3,$$MTIM(ORODT),?13
"RTN","ORPRS04",68,0)
 S X=$O(ORTX(0))
"RTN","ORPRS04",69,0)
 I X W:$O(ORTX(X)) ORTX($O(ORTX(X)))
"RTN","ORPRS04",70,0)
 W ?54,$E(ORREQ("TIT"),1,10),?68,$$MTIM(ORSTRT),?75,$$MTIM(ORSTOP)
"RTN","ORPRS04",71,0)
 S X=0 F I=1:1 S X=$O(ORTX(X)) Q:'X  I I>2 W !?13,ORTX(X) D:($Y>(IOSL-5)) PGCHK(ORXPND-I) Q:OREND
"RTN","ORPRS04",72,0)
 Q:OREND
"RTN","ORPRS04",73,0)
 W !
"RTN","ORPRS04",74,0)
 I $$GET^XPAR("ALL","ORPF INITIALS ON SUMMARY",1,"I"),ORUSER W ?1,$P($G(^VA(200,ORUSER,0)),"^",2)
"RTN","ORPRS04",75,0)
 I $D(^OR(100,ORIFN,8,OACTION,0)) S X=^(0) D
"RTN","ORPRS04",76,0)
 . N NATURE,SIGSTS,NURSE,REVIEW
"RTN","ORPRS04",77,0)
 . S SIGSTS=$P(X,"^",4),NATURE=$P(X,"^",12),NURSE=$P(X,"^",8),REVIEW=$P(X,"^",18)
"RTN","ORPRS04",78,0)
 . I $L(SIGSTS) S SIGSTS=$$SET(100.008,4,SIGSTS)
"RTN","ORPRS04",79,0)
 . I NATURE S NATURE=$P(^ORD(100.02,NATURE,0),"^")
"RTN","ORPRS04",80,0)
 . I NURSE S NURSE=$P($G(^VA(200,NURSE,0)),"^",2)
"RTN","ORPRS04",81,0)
 . I REVIEW S REVIEW=$P($G(^VA(200,REVIEW,0)),"^",2)
"RTN","ORPRS04",82,0)
 . W:$L(NURSE) ?9,"Nrs:"_NURSE
"RTN","ORPRS04",83,0)
 . W:$L(REVIEW) ?19,"Chrt:"_REVIEW
"RTN","ORPRS04",84,0)
 . W:$L(NATURE) ?30,"Typ:"_$E(NATURE,1,18)
"RTN","ORPRS04",85,0)
 . W:$L(SIGSTS) ?54,"Sgn:"_$E(SIGSTS,1,25)
"RTN","ORPRS04",86,0)
 I $D(^OR(100,ORIFN,5,0)) S J=0 F  S J=$O(^OR(100,ORIFN,5,J)) Q:'J  W !?13,^(J,0)
"RTN","ORPRS04",87,0)
 I ORDAD D  Q:OREND
"RTN","ORPRS04",88,0)
 . N I,ORSEQ
"RTN","ORPRS04",89,0)
 . S I=0,ORSEQ=0,ORTIT(0)=ORTIT
"RTN","ORPRS04",90,0)
 . D KIDS(ORIFN)
"RTN","ORPRS04",91,0)
 . S ORTIT=ORTIT(0)
"RTN","ORPRS04",92,0)
 I OREL W !?66,"*UNRELEASED*" S X=$P(ORTERM(7),U,3),X=$$INV^ORU
"RTN","ORPRS04",93,0)
 S ORSPG("LAST")='$O(^TMP("ORR",$J,ORLIST,ORLST)),ORCONT='ORSPG("LAST")
"RTN","ORPRS04",94,0)
 D PGCHK()
"RTN","ORPRS04",95,0)
 Q
"RTN","ORPRS04",96,0)
PGCHK(CNT) ;
"RTN","ORPRS04",97,0)
 N DIR,X,I
"RTN","ORPRS04",98,0)
 S:'$D(CNT) CNT=0
"RTN","ORPRS04",99,0)
 I $G(ORSPG("LAST")) W !!,?32,"* END OF ORDERS *" W:'$G(ORSHORT) !,ORLINE D
"RTN","ORPRS04",100,0)
 . I $E(IOST)="P" D PBOT^ORPRS05(ORSPG,IOSL,ORPNM,ORSSN,ORDOB,ORAGE,$G(ORPD),ORL(0),ORL(1),$G(ORSHORT)) I '$G(ORSHORT)!($Y+15>IOSL) W @IOF
"RTN","ORPRS04",101,0)
 . I $E(IOST)="C" W ! S DIR(0)="FO^1;2",DIR("A")="Press RETURN to continue, '^' to exit" D ^DIR I $D(DUOUT) S OREND=1 Q
"RTN","ORPRS04",102,0)
 I $G(ORSEND),$G(ORLSTO) D  K ORSEND,ORCONT Q
"RTN","ORPRS04",103,0)
 . W !?(IOM-44)\2,"*****    E N D    O F    R E P O R T    ****",!
"RTN","ORPRS04",104,0)
 . I $E(IOST)="C" W ! S DIR(0)="FO^1;2",DIR("A")="Press RETURN to continue, '^' to exit" D ^DIR I $D(DUOUT) S OREND=1 Q
"RTN","ORPRS04",105,0)
 I $G(ORSPG("LAST")) Q
"RTN","ORPRS04",106,0)
 I $E(IOST)="C" D  Q
"RTN","ORPRS04",107,0)
 . I ((IOSL-$Y)>(4+CNT))!(CNT+4>(IOSL-3)) Q
"RTN","ORPRS04",108,0)
 . S ORSPG=$G(ORSPG)+1
"RTN","ORPRS04",109,0)
 . W !
"RTN","ORPRS04",110,0)
 . S DIR(0)="FO^1;2",DIR("A")="Press RETURN to continue or '^' to exit"
"RTN","ORPRS04",111,0)
 . D ^DIR
"RTN","ORPRS04",112,0)
 . I $D(DUOUT) K ORSEND,ORCONT S OREND=1 Q
"RTN","ORPRS04",113,0)
 . D CTOP^ORPRS05(ORSPG,$G(ORSEND),$G(ORSPG("EOP")),ORTIT,ORSHORT,ORL(0),ORL(1),ORWARD,ORPNM,ORSSN,ORDOB,ORAGE,$G(ORPD))
"RTN","ORPRS04",114,0)
 . S ORSPG=0
"RTN","ORPRS04",115,0)
 . I $G(ORCONT) D PTHDR
"RTN","ORPRS04",116,0)
 I ((IOSL-$Y)>(6+CNT))!(CNT+6>(IOSL-5)) Q
"RTN","ORPRS04",117,0)
 D PBOT^ORPRS05(ORSPG,IOSL,ORPNM,ORSSN,ORDOB,ORAGE,$G(ORPD),ORL(0),ORL(1),$G(ORSHORT))
"RTN","ORPRS04",118,0)
 S ORSPG=ORSPG+1
"RTN","ORPRS04",119,0)
 W @IOF
"RTN","ORPRS04",120,0)
 D PTOP^ORPRS05(ORSPG,ORTIT,ORSHORT,ORSSTRT,ORSSTOP)
"RTN","ORPRS04",121,0)
 I $G(ORCONT) D PTHDR
"RTN","ORPRS04",122,0)
 Q
"RTN","ORPRS04",123,0)
PTHDR ;
"RTN","ORPRS04",124,0)
 W !,ORPNM_"   "_$G(ORSSN)_" "_$S($G(ORCONT):"(cont.)",1:"")_" "
"RTN","ORPRS04",125,0)
 S X=$P(ORWARD,"^",2)_"  "_ORL(1)
"RTN","ORPRS04",126,0)
 W ?(80-$L(X))\2,X
"RTN","ORPRS04",127,0)
 Q
"RTN","ORPRS04",128,0)
KIDS(ORIFN,LENGTH) ;Print child orders
"RTN","ORPRS04",129,0)
 N ORCHLD,OROIFN
"RTN","ORPRS04",130,0)
 S OROIFN=ORIFN,ORCHLD=0
"RTN","ORPRS04",131,0)
 F I=0:0 S ORCHLD=$O(^OR(100,OROIFN,2,ORCHLD)) Q:ORCHLD<1  D PGCHK() Q:OREND  S ORIFN=ORCHLD D ONE^ORPRS03(ORCHLD,"         ",$G(LENGTH))
"RTN","ORPRS04",132,0)
 Q
"RTN","ORPRS04",133,0)
MTIM(X) ;Format time from Fileman date in X
"RTN","ORPRS04",134,0)
 I '$G(X) Q ""
"RTN","ORPRS04",135,0)
 S X=$P(X,".",2)
"RTN","ORPRS04",136,0)
 Q:'$L(X) ""
"RTN","ORPRS04",137,0)
 S X=$E(X,1,2)_$E("00",0,2-$L($E(X,1,2)))_":"_$E(X,3,4)_$E("00",0,2-$L($E(X,3,4)))
"RTN","ORPRS04",138,0)
 Q X
"RTN","ORPRS04",139,0)
SET(FILE,FIELD,RESULT) ;Interpret set of codes
"RTN","ORPRS04",140,0)
 S X=$P(^DD(FILE,FIELD,0),"^",3),X=$P($P(";"_X,";"_RESULT_":",2),";")
"RTN","ORPRS04",141,0)
 Q X
"RTN","ORPRS10")
0^3^B9521535
"RTN","ORPRS10",1,0)
ORPRS10 ; slc/dcm - Summary time, when the livin is easy... ;10/19/98  13:50
"RTN","ORPRS10",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**23,37,11,69,121**;Dec 17, 1997
"RTN","ORPRS10",3,0)
DAY ;PROCESS 24-HR ORDER SUMMARY
"RTN","ORPRS10",4,0)
 S OREND=0,ORTIT="DAILY ORDER SUMMARY",ORPRES=1
"RTN","ORPRS10",5,0)
 D:$D(ORSCPAT)'>9 P^ORPRS01
"RTN","ORPRS10",6,0)
 G:OREND END
"RTN","ORPRS10",7,0)
 D DAY^ORPRS01()
"RTN","ORPRS10",8,0)
 G:OREND END
"RTN","ORPRS10",9,0)
 D CONT(ORTIT)
"RTN","ORPRS10",10,0)
 Q
"RTN","ORPRS10",11,0)
RANGE ;PROCESS START THRU STOP DATE/TIME RANGE
"RTN","ORPRS10",12,0)
 S OREND=0,ORTIT="ORDER SUMMARY",ORPRES=1
"RTN","ORPRS10",13,0)
 D:$D(ORSCPAT)'>9 P^ORPRS01
"RTN","ORPRS10",14,0)
 G:OREND END
"RTN","ORPRS10",15,0)
 D RANGE^ORPRS01()
"RTN","ORPRS10",16,0)
 G:OREND END
"RTN","ORPRS10",17,0)
 D CONT("Order summary for date range")
"RTN","ORPRS10",18,0)
 Q
"RTN","ORPRS10",19,0)
GENERIC ;PROCESS WITH PROMPTS FOR ALL REPORT VARIABLES
"RTN","ORPRS10",20,0)
 S OREND=0
"RTN","ORPRS10",21,0)
 D:$D(ORSCPAT)'>9 P^ORPRS01
"RTN","ORPRS10",22,0)
 G:OREND!'$D(ORSCPAT) END
"RTN","ORPRS10",23,0)
 D PRES^ORPRS09
"RTN","ORPRS10",24,0)
 G:OREND END
"RTN","ORPRS10",25,0)
 D SERV^ORPRS09
"RTN","ORPRS10",26,0)
 G:OREND END
"RTN","ORPRS10",27,0)
 D RANGE^ORPRS01()
"RTN","ORPRS10",28,0)
 G:OREND END
"RTN","ORPRS10",29,0)
 S ORTIT=$P(ORPRES,";",2)_" for "_ORGRP("NAM")_" SERVICES"
"RTN","ORPRS10",30,0)
 D CONT(ORTIT)
"RTN","ORPRS10",31,0)
 Q
"RTN","ORPRS10",32,0)
CONT(DESC) ;
"RTN","ORPRS10",33,0)
 D QUE^ORUTL1("EN1^ORPRS10",$G(DESC))
"RTN","ORPRS10",34,0)
 Q
"RTN","ORPRS10",35,0)
EN1 ;Entry point for Batch Processing
"RTN","ORPRS10",36,0)
 ;Setup display group list, patient list, and process reports
"RTN","ORPRS10",37,0)
 N ORDG,ORGRP,ORSEL,ORSEQ,ORLIST,ORAW
"RTN","ORPRS10",38,0)
 U IO
"RTN","ORPRS10",39,0)
 S ORDG=1,ORGRP("NAM")="ALL",ORGRP("ROOT")=1,ORSEL="BILD",ORSEQ=0,ORPRES=1
"RTN","ORPRS10",40,0)
 S ORAW=$S(+$$GET^XPAR("SYS","OR ORDER SUMMARY CONTEXT",1,"I"):"AW",1:"")
"RTN","ORPRS10",41,0)
 I $E(IOST)'="C",$L($G(ORSWDN)) S ORSLTR=$E(ORSWDN,1,(IOM\15)) D ^ORSLTR
"RTN","ORPRS10",42,0)
 I ORSHORT D PTOP^ORPRS05(0,ORTIT,ORSHORT,ORSSTRT,ORSSTOP)
"RTN","ORPRS10",43,0)
 S (NEXTP,OREND)=0
"RTN","ORPRS10",44,0)
 F  S NEXTP=$O(ORSCPAT(NEXTP)) Q:NEXTP=""!(OREND=1)  D
"RTN","ORPRS10",45,0)
 . S ORVP=+ORSCPAT(NEXTP)_";DPT("
"RTN","ORPRS10",46,0)
 . D EN^ORQ1(ORVP,ORDG,+ORPRES,0,+ORSSTRT,+ORSSTOP,0,1,ORAW)
"RTN","ORPRS10",47,0)
 . N ORPI,ORPA,ORPN,X,ORPIFN
"RTN","ORPRS10",48,0)
 . S ORPI=0 F  S ORPI=$O(^TMP("ORR",$J,ORLIST,ORPI)) Q:'ORPI  D
"RTN","ORPRS10",49,0)
 .. S ORPIFN=+^TMP("ORR",$J,ORLIST,ORPI),ORPA=$P(^(ORPI),";",2)
"RTN","ORPRS10",50,0)
 .. I $D(^OR(100,ORPIFN,8,ORPA,0)) S X=^(0),ORPN=$P(X,"^",12)
"RTN","ORPRS10",51,0)
 .. I $G(ORPN),$D(^ORD(100.02,ORPN,1)),'$P(^(1),"^",3) K ^TMP("ORR",$J,ORLIST,ORPI)
"RTN","ORPRS10",52,0)
 . I $$GET^XPAR("ALL","ORPF SUMMARY SORT FORWARD",1,"I") D SORT^ORPRS02
"RTN","ORPRS10",53,0)
 . D @$S(ORSHORT:"EN^ORPRS04",1:"EN^ORPRS03")
"RTN","ORPRS10",54,0)
 . K ^TMP("ORR",$J,ORLIST)
"RTN","ORPRS10",55,0)
 I ORSHORT W !
"RTN","ORPRS10",56,0)
END ; Clean up variables
"RTN","ORPRS10",57,0)
 K I,II,J,K,NEXTP,NB,ND,NS,ORSLTR,ORES,ODATE,ORAGE,ORDCFC,ORMD,ORDG,ORDIC,ORDOB,OREND,ORFT,ORGRP,ORH,ORH2,ORHI,ORIO,ORL,ORLST,ORODT,ORNP,ORPD,ORPFG,ORPNM,ORPRES,ORUSER,ORPV,ORREQ
"RTN","ORPRS10",58,0)
 K ORSEL,ORSEQ,ORSEX,ORSP,ORSPAT,ORSPL,ORSSN,ORSSTOP,ORSSTRT,ORSTRT,ORSTOP,ORSTS,ORASTS,ORTIT,ORTM,ORTS,ORTX,ORVP,ORWARD,ORX,X,X1,Y,%,%DT,%IS,ORSWD,ORSWDN,ORRPG,ORIFN
"RTN","ORPRS10",59,0)
 I $D(ZTQUEUED) S ZTREQ="@"
"RTN","ORPRS10",60,0)
 Q
"VER")
8.0^22.0
**END**
**END**
