Released DVBA*2.7*102 SEQ #89
Extracted from mail message
**KIDS**:DVBA*2.7*102^

**INSTALL NAME**
DVBA*2.7*102
"BLD",6411,0)
DVBA*2.7*102^AUTOMATED MED INFO EXCHANGE^0^3051007^y
"BLD",6411,1,0)
^^1^1^3051007^
"BLD",6411,1,1,0)
Undefined variable error.
"BLD",6411,4,0)
^9.64PA^^
"BLD",6411,"ABPKG")
n
"BLD",6411,"KRN",0)
^9.67PA^8989.52^19
"BLD",6411,"KRN",.4,0)
.4
"BLD",6411,"KRN",.401,0)
.401
"BLD",6411,"KRN",.402,0)
.402
"BLD",6411,"KRN",.403,0)
.403
"BLD",6411,"KRN",.5,0)
.5
"BLD",6411,"KRN",.84,0)
.84
"BLD",6411,"KRN",3.6,0)
3.6
"BLD",6411,"KRN",3.8,0)
3.8
"BLD",6411,"KRN",9.2,0)
9.2
"BLD",6411,"KRN",9.8,0)
9.8
"BLD",6411,"KRN",9.8,"NM",0)
^9.68A^1^1
"BLD",6411,"KRN",9.8,"NM",1,0)
DVBCCNCL^^0^B25585288
"BLD",6411,"KRN",9.8,"NM","B","DVBCCNCL",1)

"BLD",6411,"KRN",19,0)
19
"BLD",6411,"KRN",19.1,0)
19.1
"BLD",6411,"KRN",101,0)
101
"BLD",6411,"KRN",409.61,0)
409.61
"BLD",6411,"KRN",771,0)
771
"BLD",6411,"KRN",870,0)
870
"BLD",6411,"KRN",8989.51,0)
8989.51
"BLD",6411,"KRN",8989.52,0)
8989.52
"BLD",6411,"KRN",8994,0)
8994
"BLD",6411,"KRN","B",.4,.4)

"BLD",6411,"KRN","B",.401,.401)

"BLD",6411,"KRN","B",.402,.402)

"BLD",6411,"KRN","B",.403,.403)

"BLD",6411,"KRN","B",.5,.5)

"BLD",6411,"KRN","B",.84,.84)

"BLD",6411,"KRN","B",3.6,3.6)

"BLD",6411,"KRN","B",3.8,3.8)

"BLD",6411,"KRN","B",9.2,9.2)

"BLD",6411,"KRN","B",9.8,9.8)

"BLD",6411,"KRN","B",19,19)

"BLD",6411,"KRN","B",19.1,19.1)

"BLD",6411,"KRN","B",101,101)

"BLD",6411,"KRN","B",409.61,409.61)

"BLD",6411,"KRN","B",771,771)

"BLD",6411,"KRN","B",870,870)

"BLD",6411,"KRN","B",8989.51,8989.51)

"BLD",6411,"KRN","B",8989.52,8989.52)

"BLD",6411,"KRN","B",8994,8994)

"BLD",6411,"QUES",0)
^9.62^^
"BLD",6411,"REQB",0)
^9.611^^
"MBREQ")
0
"PKG",223,-1)
1^1
"PKG",223,0)
AUTOMATED MED INFO EXCHANGE^DVBA^The entire AMIE package 7131/2507.
"PKG",223,20,0)
^9.402P^^
"PKG",223,22,0)
^9.49I^1^1
"PKG",223,22,1,0)
2.7^2950410^2950508
"PKG",223,22,1,"PAH",1,0)
102^3051007
"PKG",223,22,1,"PAH",1,1,0)
^^1^1^3051007
"PKG",223,22,1,"PAH",1,1,1,0)
Undefined variable error.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
1
"RTN","DVBCCNCL")
0^1^B25585288
"RTN","DVBCCNCL",1,0)
DVBCCNCL ;ALB/GTS-557/THM-2507 CANCEL REQUESTS ,EXAMS ; 9/23/91  9:25 AM
"RTN","DVBCCNCL",2,0)
 ;;2.7;AMIE;**102**;Apr 10, 1995
"RTN","DVBCCNCL",3,0)
 ;
"RTN","DVBCCNCL",4,0)
 G EN
"RTN","DVBCCNCL",5,0)
LOOK1 S EXAM=$S($D(^DVB(396.6,$P(^DVB(396.4,JZ,0),U,3),0)):$P(^(0),U,1),1:"Unknown")
"RTN","DVBCCNCL",6,0)
 S STAT=$P(^DVB(396.4,JZ,0),U,4)
"RTN","DVBCCNCL",7,0)
 S $P(^TMP($J,EXAM),U,1)=STAT_U_JZ S:STAT="C" TCNCL=1 S:STAT="T" TCNCL=2
"RTN","DVBCCNCL",8,0)
 Q
"RTN","DVBCCNCL",9,0)
 ;
"RTN","DVBCCNCL",10,0)
EN ;
"RTN","DVBCCNCL",11,0)
 D HOME^%ZIS S FF=IOF,HD="2507 Exam Veteran Selection",HD2="2507 Test Cancellation"
"RTN","DVBCCNCL",12,0)
 ;
"RTN","DVBCCNCL",13,0)
LOOK D KILL W @FF,!?(IOM-$L(HD)\2),HD,!?(IOM-$L(HD2)\2),HD2,!! S DIC("W")="D DICW^DVBCUTIL" S DIC="^DVB(396.3,",DIC(0)="AEQM",DIC("A")="Select VETERAN: " D ^DIC G:X=""!(X=U) EXIT I +Y<0 W *7,"  ???" G LOOK
"RTN","DVBCCNCL",14,0)
 S DA(1)=+Y,DFN=$P(Y,U,2),STAT=$P(^DVB(396.3,DA(1),0),U,18) D STATCHK G:$D(NCN) LOOK S REQDT=$P(^DVB(396.3,DA(1),0),U,2)
"RTN","DVBCCNCL",15,0)
 I '$D(^DPT(DFN,0)) W *7,!!,"Zeroth node for ^DPT record missing!",!! H 3 G LOOK
"RTN","DVBCCNCL",16,0)
 S PNAM=$P(^DPT(DFN,0),U,1),SSN=$P(^(0),U,9),CNUM=$S($D(^DPT(DFN,.31)):$P(^(.31),U,3),1:"Unknown") K DICW
"RTN","DVBCCNCL",17,0)
 S REQRO=$P(^DVB(396.3,DA(1),0),U,3),REQSTR=$P(^(0),U,4) ;used to screen bulletins
"RTN","DVBCCNCL",18,0)
 K TCNCL F JZ=0:0 S JZ=$O(^DVB(396.4,"C",DA(1),JZ)) Q:JZ=""  D LOOK1
"RTN","DVBCCNCL",19,0)
 ;
"RTN","DVBCCNCL",20,0)
ASK I $D(TCNCL) W *7,!!,"This request cannot be cancelled entirely because",!," one or more exams have ",$S(TCNCL=2:"been transferred.",1:"been completed.")
"RTN","DVBCCNCL",21,0)
 I  W !!,"However, you may cancel other individual exams.",!!,"Press RETURN " R ANS:60 G:'$T!(ANS="^") EXIT G DATA
"RTN","DVBCCNCL",22,0)
 W !!,"Do you want to cancel the entire exam" S %=2 D YN^DICN G:$D(DTOUT)!(%<0) EXIT G:%=1 ^DVBCCNC1
"RTN","DVBCCNCL",23,0)
 I $D(%Y),%Y["?" W !!,"Enter Y to cancel the ENTIRE exam or N to cancel ONLY selected exams",!! G ASK
"RTN","DVBCCNCL",24,0)
 ;
"RTN","DVBCCNCL",25,0)
DATA K EXMPTR,NCN
"RTN","DVBCCNCL",26,0)
 D HDR^DVBCUTIL
"RTN","DVBCCNCL",27,0)
EXMSEL S REQDA=DA(1),Y=$$EXSRH^DVBCUTL4("Select EXAM TO CANCEL: ","I $D(^DVB(396.4,""ARQ""_REQDA,+Y))") ;*Exam lookup function call
"RTN","DVBCCNCL",28,0)
 K DIC("S"),REQDA
"RTN","DVBCCNCL",29,0)
 G:$D(DTOUT) EXIT I X=""!(X=U)&($D(CANC)) D BULL^DVBCCNC1 G LOOK
"RTN","DVBCCNCL",30,0)
 I $D(X),X=""!(X=U)&('$D(CANC)) G LOOK
"RTN","DVBCCNCL",31,0)
 I Y=-1 W *7,"  ??" G EXMSEL  ;DVBA*2.7*102
"RTN","DVBCCNCL",32,0)
 I ($P(^DVB(396.4,+Y,0),U,4)["X")!($P(^DVB(396.4,+Y,0),U,4)="T") W *7," ??" G EXMSEL
"RTN","DVBCCNCL",33,0)
 S EXMPTR=+Y,EXMNM=$P(^DVB(396.4,+Y,0),U,3)
"RTN","DVBCCNCL",34,0)
 S EXMNM=$S($D(^DVB(396.6,EXMNM,0)):$P(^(0),U,1),1:"Unknown exam")
"RTN","DVBCCNCL",35,0)
 S STAT=$P(^TMP($J,EXMNM),U,1) D STATCHK G:$D(NCN) DATA
"RTN","DVBCCNCL",36,0)
 D CNCLCHK G:NOFND=0 DATA G:$D(OUT) EXIT
"RTN","DVBCCNCL",37,0)
 ;
"RTN","DVBCCNCL",38,0)
 ;  ** If selected an exam, enter Cancellation Reason.
"RTN","DVBCCNCL",39,0)
 S DVBCMSG=" for this "_EXMNM_" exam:",EXMCNC="" D CODE G:$D(OUT) EXIT
"RTN","DVBCCNCL",40,0)
 S DR="52R;.04////"_CCODE_";51////^S X=DUZ;50///NOW",DIE="^DVB(396.4,"
"RTN","DVBCCNCL",41,0)
 S DA=EXMPTR D ^DIE K DR,DIE G:($D(Y))!($D(DTOUT)) EXIT
"RTN","DVBCCNCL",42,0)
 S STAT=$P(^DVB(396.4,DA,0),U,4),REASON=+$P(^DVB(396.4,DA,"CAN"),U,3)
"RTN","DVBCCNCL",43,0)
 G:REASON=0 LOOK S $P(^TMP($J,EXMNM),U,1)=STAT
"RTN","DVBCCNCL",44,0)
 S ^TMP("DVBA",$J,9999999-$P(^DVB(396.4,EXMPTR,"CAN"),U,1))=CCODE
"RTN","DVBCCNCL",45,0)
 S CANC(EXMNM)=STAT_U_REASON D CNCLCHK I $D(OUT) G EXIT
"RTN","DVBCCNCL",46,0)
 K %DT G DATA
"RTN","DVBCCNCL",47,0)
 ;
"RTN","DVBCCNCL",48,0)
EXIT D KILL K CCODE,DVBCMSG,TCNCL,^TMP($J),EXMPTR,J G KILL^DVBCUTIL
"RTN","DVBCCNCL",49,0)
 ;
"RTN","DVBCCNCL",50,0)
KILL K TCNCL,DIC,DA,D0,D1,DFN,X,Y,OLDEXAM,JDR,REQDT,DR,EXMNM,NCN,STAT,%,NOFND,CANC,^TMP($J),%Y,Z,JY,JZ,DA,DIC,DIE,ALLCANC
"RTN","DVBCCNCL",51,0)
 Q
"RTN","DVBCCNCL",52,0)
 ;
"RTN","DVBCCNCL",53,0)
CNCLCHK S NOFND=0,Z=$P(^DVB(396.3,DA(1),0),U,18) Q:Z="X"!(Z="RX")  K Z S I="" F J=0:0 S I=$O(^TMP($J,I)) Q:I=""  I $P(^TMP($J,I),U,1)'="X"&($P(^(I),U,1)'="RX") S NOFND=1
"RTN","DVBCCNCL",54,0)
 Q:NOFND=1  W *7,!!,"Since all exams have been cancelled",!,"the entire request will be CANCELLED.",!! H 3
"RTN","DVBCCNCL",55,0)
 S DVBCMSG=" for this request:" D CODE
"RTN","DVBCCNCL",56,0)
 S DR="17////"_CCODE_";19///NOW;20////^S X=DUZ"
"RTN","DVBCCNCL",57,0)
 S DA=DA(1),DIE="^DVB(396.3," D ^DIE S DA=DA(1) D NOTIFY^DVBCCNC1
"RTN","DVBCCNCL",58,0)
 Q
"RTN","DVBCCNCL",59,0)
 ;
"RTN","DVBCCNCL",60,0)
STATCHK Q:STAT="P"!(STAT="N")!(STAT="NT")!(STAT="S")!(STAT="O")
"RTN","DVBCCNCL",61,0)
 W !!,*7,"This exam or request has been ",$S(STAT="RX":"cancelled by the RO",STAT="X":"cancelled by MAS",STAT="T":"transcribed",STAT="R":"released",STAT="C":"completed",STAT="CT":"completed, transferred out",1:"given an incorrect status"),".",!!
"RTN","DVBCCNCL",62,0)
 S NCN=1 H 2 Q
"RTN","DVBCCNCL",63,0)
 ;NCN=no can do
"RTN","DVBCCNCL",64,0)
 Q
"RTN","DVBCCNCL",65,0)
 ;
"RTN","DVBCCNCL",66,0)
CODE S:'$D(DVBCMSG) DVBCMSG=":" W @IOF,!,"Please enter cancellation code"_DVBCMSG,! K OUT,%
"RTN","DVBCCNCL",67,0)
 S DIR("A")="CANCELLED BY"
"RTN","DVBCCNCL",68,0)
 S:'$D(EXMCNC) DIR(0)="SO^X:MAS CANCELLATION;RX:REGIONAL OFFICE CANCELLATION"
"RTN","DVBCCNCL",69,0)
 S:$D(EXMCNC) DIR(0)="S^X:MAS CANCELLATION;RX:REGIONAL OFFICE CANCELLATION"
"RTN","DVBCCNCL",70,0)
 D ^DIR S CCODE=Y
"RTN","DVBCCNCL",71,0)
 I CCODE=U&('$D(EXMCNC)) W !!,*7,"NO '^' ALLOWED AT THIS PROMPT" D CONTMES^DVBCUTL4 G CODE
"RTN","DVBCCNCL",72,0)
 I $D(DTOUT) D RQCODE^DVBCUTL2 S OUT=1 Q
"RTN","DVBCCNCL",73,0)
 I (X=""&('$D(EXMCNC))) W !,*7,"This is a required response." D CONTMES^DVBCUTL4 G CODE
"RTN","DVBCCNCL",74,0)
CNCBY W !!,*7,"CANCELLED BY ",$S(CCODE="X":"MAS",CCODE="RX":"RO",1:"???"),", OK" S %=2 D YN^DICN I %=2 G CODE
"RTN","DVBCCNCL",75,0)
 I %=-1&('$D(EXMCNC)&('$D(DTOUT))) W !!,*7,"NO '^' ALLOWED AT THIS PROMPT" D CONTMES^DVBCUTL4 G CNCBY
"RTN","DVBCCNCL",76,0)
 K EXMCNC
"RTN","DVBCCNCL",77,0)
 I $D(DTOUT) D BULL^DVBCCNC1 S OUT=1 Q
"RTN","DVBCCNCL",78,0)
 Q
"VER")
8.0^22.0
"BLD",6411,6)
^89
**END**
**END**
